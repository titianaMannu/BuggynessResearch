{"sha":"4156c28809dccb5566e38ff6dd3b77f81f8acf79","node_id":"MDQ6QmxvYjIwNjM2NDo0MTU2YzI4ODA5ZGNjYjU1NjZlMzhmZjZkZDNiNzdmODFmOGFjZjc5","size":15276,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/4156c28809dccb5566e38ff6dd3b77f81f8acf79","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2U7CgppbXBv\ncnQgamF2YS5pby5GaWxlOwppbXBvcnQgamF2YS5pby5JT0V4Y2VwdGlvbjsK\naW1wb3J0IGphdmEubmV0LlVSTDsKaW1wb3J0IGphdmEudXRpbC5BcnJheXM7\nCmltcG9ydCBqYXZhLnV0aWwuQ29sbGVjdGlvbjsKaW1wb3J0IGphdmEudXRp\nbC5Db2xsZWN0aW9uczsKaW1wb3J0IGphdmEudXRpbC5IYXNoTWFwOwppbXBv\ncnQgamF2YS51dGlsLkhhc2hTZXQ7CmltcG9ydCBqYXZhLnV0aWwuTWFwOwpp\nbXBvcnQgamF2YS51dGlsLlNldDsKaW1wb3J0IGphdmF4LnBlcnNpc3RlbmNl\nLkVtYmVkZGFibGU7CmltcG9ydCBqYXZheC5wZXJzaXN0ZW5jZS5FbnRpdHk7\nCmltcG9ydCBqYXZheC5wZXJzaXN0ZW5jZS5NYXBwZWRTdXBlcmNsYXNzOwpp\nbXBvcnQgamF2YXgucGVyc2lzdGVuY2UuTmFtZWRRdWVyaWVzOwppbXBvcnQg\namF2YXgucGVyc2lzdGVuY2UuTmFtZWRRdWVyeTsKaW1wb3J0IGphdmF4LnBl\ncnNpc3RlbmNlLk5hbWVkTmF0aXZlUXVlcmllczsKaW1wb3J0IGphdmF4LnBl\ncnNpc3RlbmNlLk5hbWVkTmF0aXZlUXVlcnk7CmltcG9ydCBqYXZheC5wZXJz\naXN0ZW5jZS5TcWxSZXN1bHRTZXRNYXBwaW5nOwppbXBvcnQgamF2YXgucGVy\nc2lzdGVuY2UuU3FsUmVzdWx0U2V0TWFwcGluZ3M7CgppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLmxpYi5jb25mLkNvbmZpZ3VyYWJsZTsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5saWIuY29uZi5Db25maWd1cmF0aW9uOwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi5jb25mLkdlbmVyaWNDb25maWd1\ncmFibGU7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLm1ldGEuQ2xh\nc3NBbm5vdGF0aW9uTWV0YURhdGFGaWx0ZXI7CmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEubGliLm1ldGEuQ2xhc3NBcmdQYXJzZXI7CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEubGliLm1ldGEuTWV0YURhdGFGaWx0ZXI7CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLm1ldGEuTWV0YURhdGFQYXJzZXI7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuTG9jYWxpemVy\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51dGlsLk9wdGlvbnM7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YS5BYnN0cmFjdENGTWV0\nYURhdGFGYWN0b3J5OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEu\nQ2xhc3NNZXRhRGF0YTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRh\nLkZpZWxkTWV0YURhdGE7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0\nYS5NZXRhRGF0YURlZmF1bHRzOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLm1ldGEuTWV0YURhdGFGYWN0b3J5OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLm1ldGEuUXVlcnlNZXRhRGF0YTsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5tZXRhLlNlcXVlbmNlTWV0YURhdGE7CmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEudXRpbC5HZW5lcmFsRXhjZXB0aW9uOwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLnV0aWwuTWV0YURhdGFFeGNlcHRpb247CgovKioKICog\ne0BsaW5rIE1ldGFEYXRhRmFjdG9yeX0gZm9yIEpQQSBtZXRhZGF0YS4KICoK\nICogQGF1dGhvciBTdGV2ZSBLaW0KICogQHNpbmNlIDAuNC4wCiAqLwpwdWJs\naWMgY2xhc3MgUGVyc2lzdGVuY2VNZXRhRGF0YUZhY3RvcnkKICAgIGV4dGVu\nZHMgQWJzdHJhY3RDRk1ldGFEYXRhRmFjdG9yeQogICAgaW1wbGVtZW50cyBD\nb25maWd1cmFibGUsIEdlbmVyaWNDb25maWd1cmFibGUgewoKICAgIHByaXZh\ndGUgc3RhdGljIGZpbmFsIExvY2FsaXplciBfbG9jID0gTG9jYWxpemVyLmZv\nclBhY2thZ2UKICAgICAgICAoUGVyc2lzdGVuY2VNZXRhRGF0YUZhY3Rvcnku\nY2xhc3MpOwoKICAgIHByaXZhdGUgZmluYWwgUGVyc2lzdGVuY2VNZXRhRGF0\nYURlZmF1bHRzIF9kZWYgPSAKICAgICAgICBuZXcgUGVyc2lzdGVuY2VNZXRh\nRGF0YURlZmF1bHRzKCk7CiAgICBwcml2YXRlIEFubm90YXRpb25QZXJzaXN0\nZW5jZU1ldGFEYXRhUGFyc2VyIF9hbm5vUGFyc2VyID0gbnVsbDsKICAgIHBy\naXZhdGUgWE1MUGVyc2lzdGVuY2VNZXRhRGF0YVBhcnNlciBfeG1sUGFyc2Vy\nID0gbnVsbDsKICAgIHByaXZhdGUgTWFwPFVSTCwgU2V0PiBfeG1sID0gbnVs\nbDsgLy8geG1sIHJzcmMgLT4gY2xhc3MgbmFtZXMKICAgIHByaXZhdGUgU2V0\nPFVSTD4gX3VucGFyc2VkID0gbnVsbDsgLy8geG1sIHJzcmMKICAgIHByaXZh\ndGUgYm9vbGVhbiBfZmllbGRPdmVycmlkZSA9IHRydWU7CgogICAgLyoqCiAg\nICAgKiBXaGV0aGVyIHRvIHVzZSBmaWVsZC1sZXZlbCBvdmVycmlkZSBvciBj\nbGFzcy1sZXZlbCBvdmVycmlkZS4KICAgICAqIERlZmF1bHRzIHRvIHRydWUu\nCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldEZpZWxkT3ZlcnJpZGUoYm9v\nbGVhbiBmaWVsZCkgewogICAgICAgIF9maWVsZE92ZXJyaWRlID0gZmllbGQ7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBXaGV0aGVyIHRvIHVzZSBmaWVsZC1s\nZXZlbCBvdmVycmlkZSBvciBjbGFzcy1sZXZlbCBvdmVycmlkZS4KICAgICAq\nIERlZmF1bHRzIHRvIHRydWUuCiAgICAgKi8KICAgIHB1YmxpYyBib29sZWFu\nIGdldEZpZWxkT3ZlcnJpZGUoKSB7CiAgICAgICAgcmV0dXJuIF9maWVsZE92\nZXJyaWRlOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIG1ldGFkYXRh\nIHBhcnNlciwgY3JlYXRpbmcgaXQgaWYgaXQgZG9lcyBub3QgYWxyZWFkeSBl\neGlzdC4KICAgICAqLwogICAgcHVibGljIEFubm90YXRpb25QZXJzaXN0ZW5j\nZU1ldGFEYXRhUGFyc2VyIGdldEFubm90YXRpb25QYXJzZXIoKSB7CiAgICAg\nICAgaWYgKF9hbm5vUGFyc2VyID09IG51bGwpIHsKICAgICAgICAgICAgX2Fu\nbm9QYXJzZXIgPSBuZXdBbm5vdGF0aW9uUGFyc2VyKCk7CiAgICAgICAgICAg\nIF9hbm5vUGFyc2VyLnNldFJlcG9zaXRvcnkocmVwb3MpOwogICAgICAgIH0K\nICAgICAgICByZXR1cm4gX2Fubm9QYXJzZXI7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBTZXQgdGhlIG1ldGFkYXRhIHBhcnNlci4KICAgICAqLwogICAgcHVi\nbGljIHZvaWQgc2V0QW5ub3RhdGlvblBhcnNlcigKICAgICAgICBBbm5vdGF0\naW9uUGVyc2lzdGVuY2VNZXRhRGF0YVBhcnNlciBwYXJzZXIpIHsKICAgICAg\nICBpZiAoX2Fubm9QYXJzZXIgIT0gbnVsbCkKICAgICAgICAgICAgX2Fubm9Q\nYXJzZXIuc2V0UmVwb3NpdG9yeShudWxsKTsKICAgICAgICBpZiAocGFyc2Vy\nICE9IG51bGwpCiAgICAgICAgICAgIHBhcnNlci5zZXRSZXBvc2l0b3J5KHJl\ncG9zKTsKICAgICAgICBfYW5ub1BhcnNlciA9IHBhcnNlcjsKICAgIH0KCiAg\nICAvKioKICAgICAqIENyZWF0ZSBhIG5ldyBtZXRhZGF0YSBwYXJzZXIuCiAg\nICAgKi8KICAgIHByb3RlY3RlZCBBbm5vdGF0aW9uUGVyc2lzdGVuY2VNZXRh\nRGF0YVBhcnNlciBuZXdBbm5vdGF0aW9uUGFyc2VyKCkgewogICAgICAgIHJl\ndHVybiBuZXcgQW5ub3RhdGlvblBlcnNpc3RlbmNlTWV0YURhdGFQYXJzZXIK\nICAgICAgICAgICAgKHJlcG9zLmdldENvbmZpZ3VyYXRpb24oKSk7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBSZXR1cm4gWE1MIG1ldGFkYXRhIHBhcnNlciwg\nY3JlYXRpbmcgaXQgaWYgaXQgZG9lcyBub3QgYWxyZWFkeSBleGlzdC4KICAg\nICAqLwogICAgcHVibGljIFhNTFBlcnNpc3RlbmNlTWV0YURhdGFQYXJzZXIg\nZ2V0WE1MUGFyc2VyKCkgewogICAgICAgIGlmIChfeG1sUGFyc2VyID09IG51\nbGwpIHsKICAgICAgICAgICAgX3htbFBhcnNlciA9IG5ld1hNTFBhcnNlcih0\ncnVlKTsKICAgICAgICAgICAgX3htbFBhcnNlci5zZXRSZXBvc2l0b3J5KHJl\ncG9zKTsKICAgICAgICAgICAgaWYgKF9maWVsZE92ZXJyaWRlKQogICAgICAg\nICAgICAgICAgX3htbFBhcnNlci5zZXRBbm5vdGF0aW9uUGFyc2VyKGdldEFu\nbm90YXRpb25QYXJzZXIoKSk7CiAgICAgICAgfQogICAgICAgIHJldHVybiBf\neG1sUGFyc2VyOwogICAgfQoKICAgIC8qKgogICAgICogU2V0IHRoZSBtZXRh\nZGF0YSBwYXJzZXIuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldFhNTFBh\ncnNlcihYTUxQZXJzaXN0ZW5jZU1ldGFEYXRhUGFyc2VyIHBhcnNlcikgewog\nICAgICAgIGlmIChfeG1sUGFyc2VyICE9IG51bGwpCiAgICAgICAgICAgIF94\nbWxQYXJzZXIuc2V0UmVwb3NpdG9yeShudWxsKTsKICAgICAgICBpZiAocGFy\nc2VyICE9IG51bGwpCiAgICAgICAgICAgIHBhcnNlci5zZXRSZXBvc2l0b3J5\nKHJlcG9zKTsKICAgICAgICBfeG1sUGFyc2VyID0gcGFyc2VyOwogICAgfQoK\nICAgIC8qKgogICAgICogQ3JlYXRlIGEgbmV3IG1ldGFkYXRhIHBhcnNlci4K\nICAgICAqLwogICAgcHJvdGVjdGVkIFhNTFBlcnNpc3RlbmNlTWV0YURhdGFQ\nYXJzZXIgbmV3WE1MUGFyc2VyKGJvb2xlYW4gbG9hZGluZykgewogICAgICAg\nIHJldHVybiBuZXcgWE1MUGVyc2lzdGVuY2VNZXRhRGF0YVBhcnNlcihyZXBv\ncy5nZXRDb25maWd1cmF0aW9uKCkpOwogICAgfQoKICAgIC8qKgogICAgICog\nQ3JlYXRlIGEgbmV3IHNlcmlhbGl6ZXIKICAgICAqLwogICAgcHJvdGVjdGVk\nIFhNTFBlcnNpc3RlbmNlTWV0YURhdGFTZXJpYWxpemVyIG5ld1hNTFNlcmlh\nbGl6ZXIoKSB7CiAgICAgICAgcmV0dXJuIG5ldyBYTUxQZXJzaXN0ZW5jZU1l\ndGFEYXRhU2VyaWFsaXplcihyZXBvcy5nZXRDb25maWd1cmF0aW9uKCkpOwog\nICAgfQoKICAgIHB1YmxpYyB2b2lkIGxvYWQoQ2xhc3MgY2xzLCBpbnQgbW9k\nZSwgQ2xhc3NMb2FkZXIgZW52TG9hZGVyKSB7CiAgICAgICAgaWYgKG1vZGUg\nPT0gTU9ERV9OT05FKQogICAgICAgICAgICByZXR1cm47CiAgICAgICAgaWYg\nKCFzdHJpY3QgJiYgKG1vZGUgJiBNT0RFX01FVEEpICE9IDApCiAgICAgICAg\nICAgIG1vZGUgfD0gTU9ERV9NQVBQSU5HOwoKICAgICAgICAvLyBnZXR0aW5n\nIHRoZSBsaXN0IG9mIHBlcnNpc3RlbnQgdHlwZXMgcnVucyBjYWxsYmFja3Mg\ndG8KICAgICAgICAvLyBtYXBQZXJzaXN0ZW50VHlwZU5hbWVzIGlmIGl0IGhh\nc24ndCBiZWVuIGNhbGxlZCBhbHJlYWR5LCB3aGljaAogICAgICAgIC8vIGNh\nY2hlcyBYTUwgcmVzb3VyY2VzCiAgICAgICAgZ2V0UGVyc2lzdGVudFR5cGVO\nYW1lcyhmYWxzZSwgZW52TG9hZGVyKTsKICAgICAgICBVUkwgeG1sID0gZmlu\nZFhNTChjbHMpOwoKICAgICAgICAvLyB3ZSBoYXZlIHRvIHBhcnNlIG1ldGFk\nYXRhIHVwLWZyb250IHRvIHJlZ2lzdGVyIHBlcnNpc3RlbmNlIHVuaXQKICAg\nICAgICAvLyBkZWZhdWx0cyBhbmQgc3lzdGVtIGNhbGxiYWNrcwogICAgICAg\nIENsYXNzTWV0YURhdGEgbWV0YTsKICAgICAgICBib29sZWFuIHBhcnNlZFhN\nTCA9IGZhbHNlOwogICAgICAgIGlmIChfdW5wYXJzZWQgIT0gbnVsbCAmJiAh\nX3VucGFyc2VkLmlzRW1wdHkoKQogICAgICAgICAgICAmJiAobW9kZSAmIE1P\nREVfTUVUQSkgIT0gMCkgewogICAgICAgICAgICBmb3IgKFVSTCB1cmwgOiBf\ndW5wYXJzZWQpCiAgICAgICAgICAgICAgICBwYXJzZVhNTCh1cmwsIGNscywg\nbW9kZSwgZW52TG9hZGVyKTsKICAgICAgICAgICAgcGFyc2VkWE1MID0gX3Vu\ncGFyc2VkLmNvbnRhaW5zKHhtbCk7CiAgICAgICAgICAgIF91bnBhcnNlZC5j\nbGVhcigpOwoKICAgICAgICAgICAgLy8gWE1MIHByb2Nlc3MgY2hlY2sKICAg\nICAgICAgICAgbWV0YSA9IHJlcG9zLmdldENhY2hlZE1ldGFEYXRhKGNscyk7\nCiAgICAgICAgICAgIGlmIChtZXRhICE9IG51bGwgJiYgKG1ldGEuZ2V0U291\ncmNlTW9kZSgpICYgbW9kZSkgPT0gbW9kZSkgewogICAgICAgICAgICAgICAg\ndmFsaWRhdGVTdHJhdGVnaWVzKG1ldGEpOwogICAgICAgICAgICAgICAgcmV0\ndXJuOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAvLyBtaWdo\ndCBoYXZlIGJlZW4gbG9va2luZyBmb3Igc3lzdGVtLWxldmVsIHF1ZXJ5CiAg\nICAgICAgaWYgKGNscyA9PSBudWxsKQogICAgICAgICAgICByZXR1cm47Cgog\nICAgICAgIC8vIHdlIG1heSBzdGlsbCBuZWVkIHRvIHBhcnNlIFhNTCBpZiB0\naGlzIGlzIGEgcmVkZXBsb3kgb2YgYSBjbGFzcywgb3IKICAgICAgICAvLyBp\nZiB3ZSdyZSBpbiBzdHJpY3QgcXVlcnktb25seSBtb2RlCiAgICAgICAgaWYg\nKCFwYXJzZWRYTUwgJiYgeG1sICE9IG51bGwpIHsKICAgICAgICAgICAgcGFy\nc2VYTUwoeG1sLCBjbHMsIG1vZGUsIGVudkxvYWRlcik7CiAgICAgICAgICAg\nIC8vIFhNTCBwcm9jZXNzIGNoZWNrCiAgICAgICAgICAgIG1ldGEgPSByZXBv\ncy5nZXRDYWNoZWRNZXRhRGF0YShjbHMpOwogICAgICAgICAgICBpZiAobWV0\nYSAhPSBudWxsICYmIChtZXRhLmdldFNvdXJjZU1vZGUoKSAmIG1vZGUpID09\nIG1vZGUpIHsKICAgICAgICAgICAgICAgIHZhbGlkYXRlU3RyYXRlZ2llcyht\nZXRhKTsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQog\nICAgICAgIH0KCiAgICAgICAgQW5ub3RhdGlvblBlcnNpc3RlbmNlTWV0YURh\ndGFQYXJzZXIgcGFyc2VyID0gZ2V0QW5ub3RhdGlvblBhcnNlcigpOwogICAg\nICAgIHBhcnNlci5zZXRFbnZDbGFzc0xvYWRlcihlbnZMb2FkZXIpOwogICAg\nICAgIHBhcnNlci5zZXRNb2RlKG1vZGUpOwogICAgICAgIHBhcnNlci5wYXJz\nZShjbHMpOwoKICAgICAgICBtZXRhID0gcmVwb3MuZ2V0Q2FjaGVkTWV0YURh\ndGEoY2xzKTsKICAgICAgICBpZiAobWV0YSAhPSBudWxsICYmIChtZXRhLmdl\ndFNvdXJjZU1vZGUoKSAmIG1vZGUpID09IG1vZGUpCiAgICAgICAgICAgIHZh\nbGlkYXRlU3RyYXRlZ2llcyhtZXRhKTsKICAgIH0KCiAgICAvKioKICAgICAq\nIFBhcnNlIHRoZSBnaXZlbiBYTUwgcmVzb3VyY2UuCiAgICAgKi8KICAgIHBy\naXZhdGUgdm9pZCBwYXJzZVhNTChVUkwgeG1sLCBDbGFzcyBjbHMsIGludCBt\nb2RlLCBDbGFzc0xvYWRlciBlbnZMb2FkZXIpIHsKICAgICAgICBDbGFzc0xv\nYWRlciBsb2FkZXIgPSByZXBvcy5nZXRDb25maWd1cmF0aW9uKCkuCiAgICAg\nICAgICAgIGdldENsYXNzUmVzb2x2ZXJJbnN0YW5jZSgpLmdldENsYXNzTG9h\nZGVyKGNscywgZW52TG9hZGVyKTsKICAgICAgICBYTUxQZXJzaXN0ZW5jZU1l\ndGFEYXRhUGFyc2VyIHhtbFBhcnNlciA9IGdldFhNTFBhcnNlcigpOwogICAg\nICAgIHhtbFBhcnNlci5zZXRDbGFzc0xvYWRlcihlbnZMb2FkZXIgIT0gbnVs\nbCA/IGVudkxvYWRlciA6IGxvYWRlcik7CiAgICAgICAgeG1sUGFyc2VyLnNl\ndEVudkNsYXNzTG9hZGVyKGVudkxvYWRlcik7CiAgICAgICAgeG1sUGFyc2Vy\nLnNldE1vZGUobW9kZSk7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgeG1s\nUGFyc2VyLnBhcnNlKHhtbCk7CiAgICAgICAgfSBjYXRjaCAoSU9FeGNlcHRp\nb24gaW9lKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBHZW5lcmFsRXhjZXB0\naW9uKGlvZSk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogTG9j\nYXRlIHRoZSBYTUwgcmVzb3VyY2UgZm9yIHRoZSBnaXZlbiBjbGFzcy4KICAg\nICAqLwogICAgcHJpdmF0ZSBVUkwgZmluZFhNTChDbGFzcyBjbHMpIHsKICAg\nICAgICBpZiAoX3htbCAhPSBudWxsICYmIGNscyAhPSBudWxsKQogICAgICAg\nICAgICBmb3IgKE1hcC5FbnRyeTxVUkwsIFNldD4gZW50cnkgOiBfeG1sLmVu\ndHJ5U2V0KCkpCiAgICAgICAgICAgICAgICBpZiAoZW50cnkuZ2V0VmFsdWUo\nKS5jb250YWlucyhjbHMuZ2V0TmFtZSgpKSkKICAgICAgICAgICAgICAgICAg\nICByZXR1cm4gZW50cnkuZ2V0S2V5KCk7CiAgICAgICAgcmV0dXJuIG51bGw7\nCiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwcm90ZWN0ZWQgdm9pZCBtYXBQ\nZXJzaXN0ZW50VHlwZU5hbWVzKE9iamVjdCByc3JjLCBTdHJpbmdbXSBuYW1l\ncykgewogICAgICAgIGlmIChyc3JjLnRvU3RyaW5nKCkuZW5kc1dpdGgoIi5j\nbGFzcyIpKSB7CiAgICAgICAgICAgIGlmIChsb2cuaXNUcmFjZUVuYWJsZWQo\nKSkKICAgICAgICAgICAgICAgIGxvZy50cmFjZSgKICAgICAgICAgICAgICAg\nICAgICBfbG9jLmdldCgibWFwLXBlcnNpc3RlbnQtdHlwZXMtc2tpcHBpbmct\nY2xhc3MiLCByc3JjKSk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9\nIGVsc2UgaWYgKCEocnNyYyBpbnN0YW5jZW9mIFVSTCkpIHsKICAgICAgICAg\nICAgaWYgKGxvZy5pc1RyYWNlRW5hYmxlZCgpKQogICAgICAgICAgICAgICAg\nbG9nLnRyYWNlKAogICAgICAgICAgICAgICAgICAgIF9sb2MuZ2V0KCJtYXAt\ncGVyc2lzdGVudC10eXBlcy1za2lwcGluZy1ub24tdXJsIiwgcnNyYykpOwog\nICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBpZiAobG9n\nLmlzVHJhY2VFbmFibGVkKCkpCiAgICAgICAgICAgIGxvZy50cmFjZShfbG9j\nLmdldCgKICAgICAgICAgICAgICAgICJtYXAtcGVyc2lzdGVudC10eXBlLW5h\nbWVzIiwgcnNyYywgQXJyYXlzLmFzTGlzdChuYW1lcykpKTsKICAgICAgICAK\nICAgICAgICBpZiAoX3htbCA9PSBudWxsKQogICAgICAgICAgICBfeG1sID0g\nbmV3IEhhc2hNYXA8VVJMLCBTZXQ+KCk7CiAgICAgICAgX3htbC5wdXQoKFVS\nTCkgcnNyYywgbmV3IEhhc2hTZXQoQXJyYXlzLmFzTGlzdChuYW1lcykpKTsK\nICAgICAgICBpZiAoX3VucGFyc2VkID09IG51bGwpCiAgICAgICAgICAgIF91\nbnBhcnNlZCA9IG5ldyBIYXNoU2V0PFVSTD4oKTsKICAgICAgICBfdW5wYXJz\nZWQuYWRkKChVUkwpIHJzcmMpOwogICAgfQoKICAgIEBPdmVycmlkZQogICAg\ncHVibGljIENsYXNzIGdldFF1ZXJ5U2NvcGUoU3RyaW5nIHF1ZXJ5TmFtZSwg\nQ2xhc3NMb2FkZXIgbG9hZGVyKSB7CiAgICAgICAgaWYgKHF1ZXJ5TmFtZSA9\nPSBudWxsKQogICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICBDb2xs\nZWN0aW9uIGNsYXNzZXMgPSByZXBvcy5sb2FkUGVyc2lzdGVudFR5cGVzKGZh\nbHNlLCBsb2FkZXIpOwogICAgICAgIGZvciAoQ2xhc3MgY2xzIDogKENvbGxl\nY3Rpb248Q2xhc3M+KSBjbGFzc2VzKSB7CiAgICAgICAgICAgIGlmIChjbHMu\naXNBbm5vdGF0aW9uUHJlc2VudChOYW1lZFF1ZXJ5LmNsYXNzKSAmJiBoYXNO\nYW1lZFF1ZXJ5CiAgICAgICAgICAgICAgICAocXVlcnlOYW1lLCAoTmFtZWRR\ndWVyeSkgY2xzLmdldEFubm90YXRpb24oTmFtZWRRdWVyeS5jbGFzcykpKQog\nICAgICAgICAgICAgICAgcmV0dXJuIGNsczsKICAgICAgICAgICAgaWYgKGNs\ncy5pc0Fubm90YXRpb25QcmVzZW50KE5hbWVkUXVlcmllcy5jbGFzcykgJiYK\nICAgICAgICAgICAgICAgIGhhc05hbWVkUXVlcnkocXVlcnlOYW1lLCAoKE5h\nbWVkUXVlcmllcykgY2xzLgogICAgICAgICAgICAgICAgICAgIGdldEFubm90\nYXRpb24oTmFtZWRRdWVyaWVzLmNsYXNzKSkudmFsdWUoKSkpCiAgICAgICAg\nICAgICAgICByZXR1cm4gY2xzOwogICAgICAgICAgICBpZiAoY2xzLmlzQW5u\nb3RhdGlvblByZXNlbnQoTmFtZWROYXRpdmVRdWVyeS5jbGFzcykgJiYKICAg\nICAgICAgICAgICAgIGhhc05hbWVkTmF0aXZlUXVlcnkocXVlcnlOYW1lLCAo\nTmFtZWROYXRpdmVRdWVyeSkgY2xzLgogICAgICAgICAgICAgICAgICAgIGdl\ndEFubm90YXRpb24oTmFtZWROYXRpdmVRdWVyeS5jbGFzcykpKQogICAgICAg\nICAgICAgICAgcmV0dXJuIGNsczsKICAgICAgICAgICAgaWYgKGNscy5pc0Fu\nbm90YXRpb25QcmVzZW50KE5hbWVkTmF0aXZlUXVlcmllcy5jbGFzcykgJiYK\nICAgICAgICAgICAgICAgIGhhc05hbWVkTmF0aXZlUXVlcnkocXVlcnlOYW1l\nLCAoKE5hbWVkTmF0aXZlUXVlcmllcykgY2xzLgogICAgICAgICAgICAgICAg\nICAgIGdldEFubm90YXRpb24oTmFtZWROYXRpdmVRdWVyaWVzLmNsYXNzKSku\ndmFsdWUoKSkpCiAgICAgICAgICAgICAgICByZXR1cm4gY2xzOwogICAgICAg\nIH0KICAgICAgICByZXR1cm4gbnVsbDsKICAgIH0KCiAgICBAT3ZlcnJpZGUK\nICAgIHB1YmxpYyBDbGFzcyBnZXRSZXN1bHRTZXRNYXBwaW5nU2NvcGUoU3Ry\naW5nIHJzTWFwcGluZ05hbWUsCiAgICAgICAgQ2xhc3NMb2FkZXIgbG9hZGVy\nKSB7CiAgICAgICAgaWYgKHJzTWFwcGluZ05hbWUgPT0gbnVsbCkKICAgICAg\nICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgCiAgICAgICAgQ29sbGVjdGlv\nbiBjbGFzc2VzID0gcmVwb3MubG9hZFBlcnNpc3RlbnRUeXBlcyhmYWxzZSwg\nbG9hZGVyKTsKICAgICAgICBmb3IgKENsYXNzIGNscyA6IChDb2xsZWN0aW9u\nPENsYXNzPikgY2xhc3NlcykgewogICAgICAgICAgICAKICAgICAgICAgICAg\naWYgKGNscy5pc0Fubm90YXRpb25QcmVzZW50KFNxbFJlc3VsdFNldE1hcHBp\nbmcuY2xhc3MpICYmIAogICAgICAgICAgICAgICAgaGFzUlNNYXBwaW5nKHJz\nTWFwcGluZ05hbWUsIChTcWxSZXN1bHRTZXRNYXBwaW5nKSBjbHMuCiAgICAg\nICAgICAgICAgICBnZXRBbm5vdGF0aW9uKFNxbFJlc3VsdFNldE1hcHBpbmcu\nY2xhc3MpKSkKICAgICAgICAgICAgICAgIHJldHVybiBjbHM7CiAgICAgICAg\nICAgIAogICAgICAgICAgICBpZiAoY2xzLmlzQW5ub3RhdGlvblByZXNlbnQo\nU3FsUmVzdWx0U2V0TWFwcGluZ3MuY2xhc3MpICYmIAogICAgICAgICAgICAg\nICAgaGFzUlNNYXBwaW5nKHJzTWFwcGluZ05hbWUsICgoU3FsUmVzdWx0U2V0\nTWFwcGluZ3MpIGNscy4KICAgICAgICAgICAgICAgIGdldEFubm90YXRpb24o\nU3FsUmVzdWx0U2V0TWFwcGluZ3MuY2xhc3MpKS52YWx1ZSgpKSkKICAgICAg\nICAgICAgICAgIHJldHVybiBjbHM7CiAgICAgICAgfQogICAgICAgIHJldHVy\nbiBudWxsOwogICAgfQoKICAgIHByaXZhdGUgYm9vbGVhbiBoYXNOYW1lZFF1\nZXJ5KFN0cmluZyBxdWVyeSwgTmFtZWRRdWVyeS4uLiBxdWVyaWVzKSB7CiAg\nICAgICAgZm9yIChOYW1lZFF1ZXJ5IHEgOiBxdWVyaWVzKSB7CiAgICAgICAg\nICAgIGlmIChxdWVyeS5lcXVhbHMocS5uYW1lKCkpKQogICAgICAgICAgICAg\nICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQogICAgICAgIHJldHVybiBmYWxz\nZTsKICAgIH0KCiAgICBwcml2YXRlIGJvb2xlYW4gaGFzUlNNYXBwaW5nKFN0\ncmluZyByc01hcHBpbmcsCiAgICAgICAgU3FsUmVzdWx0U2V0TWFwcGluZy4u\nLiBtYXBwaW5ncykgewogICAgICAgIGZvciAoU3FsUmVzdWx0U2V0TWFwcGlu\nZyBtIDogbWFwcGluZ3MpIHsKICAgICAgICAgICAgaWYgKHJzTWFwcGluZy5l\ncXVhbHMobS5uYW1lKCkpKQogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7\nCiAgICAgICAgfQogICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICBw\ncml2YXRlIGJvb2xlYW4gaGFzTmFtZWROYXRpdmVRdWVyeShTdHJpbmcgcXVl\ncnksCiAgICAgICAgTmFtZWROYXRpdmVRdWVyeS4uLiBxdWVyaWVzKSB7CiAg\nICAgICAgZm9yIChOYW1lZE5hdGl2ZVF1ZXJ5IHEgOiBxdWVyaWVzKSB7CiAg\nICAgICAgICAgIGlmIChxdWVyeS5lcXVhbHMocS5uYW1lKCkpKQogICAgICAg\nICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQogICAgICAgIHJldHVy\nbiBmYWxzZTsKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHByb3RlY3RlZCBN\nZXRhRGF0YUZpbHRlciBuZXdNZXRhRGF0YUZpbHRlcigpIHsKICAgICAgICBy\nZXR1cm4gbmV3IENsYXNzQW5ub3RhdGlvbk1ldGFEYXRhRmlsdGVyKG5ldyBD\nbGFzc1tdewogICAgICAgICAgICBFbnRpdHkuY2xhc3MsIEVtYmVkZGFibGUu\nY2xhc3MsIE1hcHBlZFN1cGVyY2xhc3MuY2xhc3MgfSk7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBFbnN1cmUgYWxsIGZpZWxkcyBoYXZlIGRlY2xhcmVkIGEg\nc3RyYXRlZ3kuCiAgICAgKi8KICAgIHByaXZhdGUgdm9pZCB2YWxpZGF0ZVN0\ncmF0ZWdpZXMoQ2xhc3NNZXRhRGF0YSBtZXRhKSB7CiAgICAgICAgU3RyaW5n\nQnVmZmVyIGJ1ZiA9IG51bGw7CiAgICAgICAgZm9yIChGaWVsZE1ldGFEYXRh\nIGZtZCA6IG1ldGEuZ2V0RGVjbGFyZWRGaWVsZHMoKSkgewogICAgICAgICAg\nICBpZiAoIWZtZC5pc0V4cGxpY2l0KCkpIHsKICAgICAgICAgICAgICAgIGlm\nIChidWYgPT0gbnVsbCkKICAgICAgICAgICAgICAgICAgICBidWYgPSBuZXcg\nU3RyaW5nQnVmZmVyKCk7CiAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAg\nICAgICAgICAgICAgYnVmLmFwcGVuZCgiLCAiKTsKICAgICAgICAgICAgICAg\nIGJ1Zi5hcHBlbmQoZm1kKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAg\nICAgICBpZiAoYnVmICE9IG51bGwpCiAgICAgICAgICAgIHRocm93IG5ldyBN\nZXRhRGF0YUV4Y2VwdGlvbihfbG9jLmdldCgibm8tcGVycy1zdHJhdCIsIGJ1\nZikpOwogICAgfQoKICAgIHB1YmxpYyBNZXRhRGF0YURlZmF1bHRzIGdldERl\nZmF1bHRzKCkgewogICAgICAgIHJldHVybiBfZGVmOwogICAgfQoKICAgIEBP\ndmVycmlkZQogICAgcHVibGljIENsYXNzQXJnUGFyc2VyIG5ld0NsYXNzQXJn\nUGFyc2VyKCkgewogICAgICAgIENsYXNzQXJnUGFyc2VyIHBhcnNlciA9IG5l\ndyBDbGFzc0FyZ1BhcnNlcigpOwogICAgICAgIHBhcnNlci5zZXRNZXRhRGF0\nYVN0cnVjdHVyZSgicGFja2FnZSIsIG51bGwsIG5ldyBTdHJpbmdbXXsKICAg\nICAgICAgICAgImVudGl0eSIsICJlbWJlZGRhYmxlIiwgIm1hcHBlZC1zdXBl\ncmNsYXNzIiB9LCAiY2xhc3MiKTsKICAgICAgICByZXR1cm4gcGFyc2VyOwog\nICAgfQoKICAgIEBPdmVycmlkZQogICAgcHVibGljIHZvaWQgY2xlYXIoKSB7\nCiAgICAgICAgc3VwZXIuY2xlYXIoKTsKICAgICAgICBpZiAoX2Fubm9QYXJz\nZXIgIT0gbnVsbCkKICAgICAgICAgICAgX2Fubm9QYXJzZXIuY2xlYXIoKTsK\nICAgICAgICBpZiAoX3htbFBhcnNlciAhPSBudWxsKQogICAgICAgICAgICBf\neG1sUGFyc2VyLmNsZWFyKCk7CiAgICAgICAgaWYgKF94bWwgIT0gbnVsbCkK\nICAgICAgICAgICAgX3htbC5jbGVhcigpOwogICAgfQoKICAgIHByb3RlY3Rl\nZCBQYXJzZXIgbmV3UGFyc2VyKGJvb2xlYW4gbG9hZGluZykgewogICAgICAg\nIHJldHVybiBuZXdYTUxQYXJzZXIobG9hZGluZyk7CiAgICB9CgogICAgcHJv\ndGVjdGVkIFNlcmlhbGl6ZXIgbmV3U2VyaWFsaXplcigpIHsKICAgICAgICBy\nZXR1cm4gbmV3WE1MU2VyaWFsaXplcigpOwogICAgfQoKICAgIEBPdmVycmlk\nZQogICAgcHJvdGVjdGVkIHZvaWQgcGFyc2UoTWV0YURhdGFQYXJzZXIgcGFy\nc2VyLCBDbGFzc1tdIGNscykgewogICAgICAgIHBhcnNlKHBhcnNlciwgQ29s\nbGVjdGlvbnMuc2luZ2xldG9uKGRlZmF1bHRYTUxGaWxlKCkpKTsKICAgIH0K\nCiAgICBwcm90ZWN0ZWQgRmlsZSBkZWZhdWx0U291cmNlRmlsZShDbGFzc01l\ndGFEYXRhIG1ldGEpIHsKICAgICAgICByZXR1cm4gZGVmYXVsdFhNTEZpbGUo\nKTsKICAgIH0KCiAgICBwcm90ZWN0ZWQgRmlsZSBkZWZhdWx0U291cmNlRmls\nZShRdWVyeU1ldGFEYXRhIHF1ZXJ5LCBNYXAgY2xzTmFtZXMpIHsKICAgICAg\nICBDbGFzc01ldGFEYXRhIG1ldGEgPSBnZXREZWZpbmluZ01ldGFEYXRhKHF1\nZXJ5LCBjbHNOYW1lcyk7CiAgICAgICAgRmlsZSBmaWxlID0gKG1ldGEgPT0g\nbnVsbCkgPyBudWxsIDogbWV0YS5nZXRTb3VyY2VGaWxlKCk7CiAgICAgICAg\naWYgKGZpbGUgIT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIGZpbGU7CiAg\nICAgICAgcmV0dXJuIGRlZmF1bHRYTUxGaWxlKCk7CiAgICB9CgogICAgcHJv\ndGVjdGVkIEZpbGUgZGVmYXVsdFNvdXJjZUZpbGUoU2VxdWVuY2VNZXRhRGF0\nYSBzZXEsIE1hcCBjbHNOYW1lcykgewogICAgICAgIHJldHVybiBkZWZhdWx0\nWE1MRmlsZSgpOwogICAgfQoKICAgIC8qKgogICAgICogTG9vayBmb3IgTUVU\nQS1JTkYvb3JtLnhtbCwgYW5kIGlmIGl0IGRvZXNuJ3QgZXhpc3QsIGNob29z\nZSBhIGRlZmF1bHQuCiAgICAgKi8KICAgIHByaXZhdGUgRmlsZSBkZWZhdWx0\nWE1MRmlsZSgpIHsKICAgICAgICBDbGFzc0xvYWRlciBsb2FkZXIgPSByZXBv\ncy5nZXRDb25maWd1cmF0aW9uKCkuCiAgICAgICAgICAgIGdldENsYXNzUmVz\nb2x2ZXJJbnN0YW5jZSgpLmdldENsYXNzTG9hZGVyKGdldENsYXNzKCksIG51\nbGwpOwogICAgICAgIFVSTCByc3JjID0gbG9hZGVyLmdldFJlc291cmNlKCJN\nRVRBLUlORi9vcm0ueG1sIik7CiAgICAgICAgaWYgKHJzcmMgIT0gbnVsbCkg\newogICAgICAgICAgICBGaWxlIGZpbGUgPSBuZXcgRmlsZShyc3JjLmdldEZp\nbGUoKSk7CiAgICAgICAgICAgIGlmIChmaWxlLmV4aXN0cygpKQogICAgICAg\nICAgICAgICAgcmV0dXJuIGZpbGU7CiAgICAgICAgfQogICAgICAgIHJldHVy\nbiBuZXcgRmlsZSgib3JtLnhtbCIpOwogICAgfQoKICAgIHB1YmxpYyB2b2lk\nIHNldENvbmZpZ3VyYXRpb24oQ29uZmlndXJhdGlvbiBjb25mKSB7CiAgICB9\nCgogICAgcHVibGljIHZvaWQgc3RhcnRDb25maWd1cmF0aW9uKCkgewogICAg\nfQoKICAgIHB1YmxpYyB2b2lkIGVuZENvbmZpZ3VyYXRpb24oKSB7CiAgICAg\nICAgaWYgKHJzcmNzID09IG51bGwpCiAgICAgICAgICAgIHJzcmNzID0gQ29s\nbGVjdGlvbnMuc2luZ2xldG9uKCJNRVRBLUlORi9vcm0ueG1sIik7CiAgICAg\nICAgZWxzZQoJCQlyc3Jjcy5hZGQoIk1FVEEtSU5GL29ybS54bWwiKTsKCX0K\nCiAgICBwdWJsaWMgdm9pZCBzZXRJbnRvKE9wdGlvbnMgb3B0cykgewogICAg\nICAgIG9wdHMua2V5U2V0KCkucmV0YWluQWxsKG9wdHMuc2V0SW50byhfZGVm\nKS5rZXlTZXQoKSk7CiAgICB9Cn0K\n","encoding":"base64"}

