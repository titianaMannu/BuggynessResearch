{"sha":"525fea2309203a73e8b204b193aaa0bd886d1e20","node_id":"MDQ6QmxvYjIwNjM2NDo1MjVmZWEyMzA5MjAzYTczZThiMjA0YjE5M2FhYTBiZDg4NmQxZTIw","size":19577,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/525fea2309203a73e8b204b193aaa0bd886d1e20","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2U7CgppbXBv\ncnQgamF2YS5pby5GaWxlOwppbXBvcnQgamF2YS5pby5JT0V4Y2VwdGlvbjsK\naW1wb3J0IGphdmEubmV0LlVSTDsKaW1wb3J0IGphdmEudXRpbC5BcnJheUxp\nc3Q7CmltcG9ydCBqYXZhLnV0aWwuQ29sbGVjdGlvbnM7CmltcG9ydCBqYXZh\nLnV0aWwuRW51bWVyYXRpb247CmltcG9ydCBqYXZhLnV0aWwuTGlzdDsKaW1w\nb3J0IGphdmEudXRpbC5NYXA7CmltcG9ydCBqYXZhLnV0aWwuTWlzc2luZ1Jl\nc291cmNlRXhjZXB0aW9uOwppbXBvcnQgamF2YXgucGVyc2lzdGVuY2Uuc3Bp\nLlBlcnNpc3RlbmNlVW5pdEluZm87CmltcG9ydCBqYXZheC5wZXJzaXN0ZW5j\nZS5zcGkuUGVyc2lzdGVuY2VVbml0VHJhbnNhY3Rpb25UeXBlOwoKaW1wb3J0\nIG9yZy5hcGFjaGUuY29tbW9ucy5sYW5nLlN0cmluZ1V0aWxzOwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLmNvbmYuT3BlbkpQQUNvbmZpZ3VyYXRpb247\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuY29uZi5PcGVuSlBBQ29uZmln\ndXJhdGlvbkltcGw7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuY29uZi5P\ncGVuSlBBUHJvZHVjdERlcml2YXRpb247CmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEubGliLmNvbmYuQWJzdHJhY3RQcm9kdWN0RGVyaXZhdGlvbjsKaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIuY29uZi5Db25maWd1cmF0aW9u\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi5jb25mLkNvbmZpZ3Vy\nYXRpb25Qcm92aWRlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIu\nY29uZi5Db25maWd1cmF0aW9uczsKaW1wb3J0IG9yZy5hcGFjaGUub3Blbmpw\nYS5saWIuY29uZi5NYXBDb25maWd1cmF0aW9uUHJvdmlkZXI7CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEubGliLmNvbmYuUHJvZHVjdERlcml2YXRpb25z\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi5sb2cuTG9nOwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi5tZXRhLlhNTE1ldGFEYXRhUGFy\nc2VyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51dGlsLkxvY2Fs\naXplcjsKaW1wb3J0IG9yZy54bWwuc2F4LkF0dHJpYnV0ZXM7CmltcG9ydCBv\ncmcueG1sLnNheC5TQVhFeGNlcHRpb247CgovKioKICogU2V0cyBKUEEgc3Bl\nY2lmaWNhdGlvbiBkZWZhdWx0cyBhbmQgcGFyc2VzIEpQQSBzcGVjaWZpY2F0\naW9uIFhNTCBmaWxlcy4KICogCiAqIEZvciBnbG9iYWxzLCBsb29rcyBpbiA8\nY29kZT5vcGVuanBhLnByb3BlcnRpZXM8L2NvZGU+IHN5c3RlbSBwcm9wZXJ0\neSBmb3IKICogdGhlIGxvY2F0aW9uIG9mIGEgZmlsZSB0byBwYXJzZS4gSWYg\nbm8gc3lzdGVtIHByb3BlcnR5IGlzIGRlZmluZWQsIHRoZQogKiBkZWZhdWx0\nIHJlc291cmNlIGxvY2F0aW9uIG9mIDxjb2RlPk1FVEEtSU5GL29wZW5qcGEu\neG1sPC9jb2RlPiBpcyB1c2VkLgogKgogKiBGb3IgZGVmYXVsdHMsIGxvb2tz\nIGZvciA8Y29kZT5NRVRBLUlORi9wZXJzaXN0ZW5jZS54bWw8L2NvZGU+Lgog\nKiBXaXRoaW4gPGNvZGU+cGVyc2lzdGVuY2UueG1sPC9jb2RlPiwgbG9vayBm\nb3IgdGhlIG5hbWVkIHBlcnNpc3RlbmNlIHVuaXQsIG9yCiAqIGlmIG5vIG5h\nbWUgZ2l2ZW4sIGFuIE9wZW5KUEEgdW5pdCAocHJlZmVycmluZyBhbiB1bm5h\nbWVkIE9wZW5KUEEgdW5pdCB0byAKICogYSBuYW1lZCBvbmUpLgogKgogKiBA\nYXV0aG9yIEFiZSBXaGl0ZQogKiBAbm9qYXZhZG9jCiAqLwpwdWJsaWMgY2xh\nc3MgUGVyc2lzdGVuY2VQcm9kdWN0RGVyaXZhdGlvbiAKICAgIGV4dGVuZHMg\nQWJzdHJhY3RQcm9kdWN0RGVyaXZhdGlvbgogICAgaW1wbGVtZW50cyBPcGVu\nSlBBUHJvZHVjdERlcml2YXRpb24gewoKICAgIHB1YmxpYyBzdGF0aWMgZmlu\nYWwgU3RyaW5nIFNQRUNfSlBBID0gImpwYSI7CiAgICBwdWJsaWMgc3RhdGlj\nIGZpbmFsIFN0cmluZyBBTElBU19FSkIgPSAiZWpiIjsKICAgIHB1YmxpYyBz\ndGF0aWMgZmluYWwgU3RyaW5nIFJTUkNfR0xPQkFMID0gIk1FVEEtSU5GL29w\nZW5qcGEueG1sIjsKICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgU3RyaW5nIFJT\nUkNfREVGQVVMVCA9ICJNRVRBLUlORi9wZXJzaXN0ZW5jZS54bWwiOwoKICAg\nIHByaXZhdGUgc3RhdGljIGZpbmFsIExvY2FsaXplciBfbG9jID0gTG9jYWxp\nemVyLmZvclBhY2thZ2UKICAgICAgICAoUGVyc2lzdGVuY2VQcm9kdWN0RGVy\naXZhdGlvbi5jbGFzcyk7CgogICAgcHVibGljIHZvaWQgcHV0QnJva2VyRmFj\ndG9yeUFsaWFzZXMoTWFwIG0pIHsKICAgIH0KCiAgICBwdWJsaWMgaW50IGdl\ndFR5cGUoKSB7CiAgICAgICAgcmV0dXJuIFRZUEVfU1BFQzsKICAgIH0KCiAg\nICBAT3ZlcnJpZGUKICAgIHB1YmxpYyB2b2lkIHZhbGlkYXRlKCkKICAgICAg\nICB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICAvLyBtYWtlIHN1cmUgSlBB\nIGlzIGF2YWlsYWJsZQogICAgICAgIGphdmF4LnBlcnNpc3RlbmNlLkVudGl0\neU1hbmFnZXJGYWN0b3J5LmNsYXNzLmdldENsYXNzTG9hZGVyKCk7CiAgICB9\nCiAgICAKICAgIEBPdmVycmlkZQogICAgcHVibGljIGJvb2xlYW4gYmVmb3Jl\nQ29uZmlndXJhdGlvbkxvYWQoQ29uZmlndXJhdGlvbiBjKSB7CiAgICAgICAg\naWYgKCEoYyBpbnN0YW5jZW9mIE9wZW5KUEFDb25maWd1cmF0aW9uSW1wbCkp\nCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAKICAgICAgICBP\ncGVuSlBBQ29uZmlndXJhdGlvbkltcGwgY29uZiA9IChPcGVuSlBBQ29uZmln\ndXJhdGlvbkltcGwpIGM7CiAgICAgICAgY29uZi5tZXRhRmFjdG9yeVBsdWdp\nbi5zZXRBbGlhcyhBTElBU19FSkIsCiAgICAgICAgICAgIFBlcnNpc3RlbmNl\nTWV0YURhdGFGYWN0b3J5LmNsYXNzLmdldE5hbWUoKSk7CiAgICAgICAgY29u\nZi5tZXRhRmFjdG9yeVBsdWdpbi5zZXRBbGlhcyhTUEVDX0pQQSwKICAgICAg\nICAgICAgUGVyc2lzdGVuY2VNZXRhRGF0YUZhY3RvcnkuY2xhc3MuZ2V0TmFt\nZSgpKTsKICAgICAgICAKICAgICAgICBjb25mLmFkZFZhbHVlKG5ldyBFbnRp\ndHlNYW5hZ2VyRmFjdG9yeVZhbHVlKCkpOwogICAgICAgIHJldHVybiB0cnVl\nOwogICAgfQoKICAgIEBPdmVycmlkZQogICAgcHVibGljIGJvb2xlYW4gYWZ0\nZXJTcGVjaWZpY2F0aW9uU2V0KENvbmZpZ3VyYXRpb24gYykgewogICAgICBp\nZiAoIShjIGluc3RhbmNlb2YgT3BlbkpQQUNvbmZpZ3VyYXRpb25JbXBsKQog\nICAgICAgICB8fCAhU1BFQ19KUEEuZXF1YWxzKCgoT3BlbkpQQUNvbmZpZ3Vy\nYXRpb24pYykuZ2V0U3BlY2lmaWNhdGlvbigpKSkKICAgICAgICAgIHJldHVy\nbiBmYWxzZTsKIAogICAgICAgIE9wZW5KUEFDb25maWd1cmF0aW9uSW1wbCBj\nb25mID0gKE9wZW5KUEFDb25maWd1cmF0aW9uSW1wbCkgYzsKICAgICAgICBj\nb25mLm1ldGFGYWN0b3J5UGx1Z2luLnNldERlZmF1bHQoU1BFQ19KUEEpOwog\nICAgICAgIGNvbmYubWV0YUZhY3RvcnlQbHVnaW4uc2V0U3RyaW5nKFNQRUNf\nSlBBKTsKICAgICAgICBjb25mLmxvY2tNYW5hZ2VyUGx1Z2luLnNldERlZmF1\nbHQoInZlcnNpb24iKTsKICAgICAgICBjb25mLmxvY2tNYW5hZ2VyUGx1Z2lu\nLnNldFN0cmluZygidmVyc2lvbiIpOwogICAgICAgIGNvbmYubm9udHJhbnNh\nY3Rpb25hbFdyaXRlLnNldERlZmF1bHQoInRydWUiKTsKICAgICAgICBjb25m\nLm5vbnRyYW5zYWN0aW9uYWxXcml0ZS5zZXQodHJ1ZSk7CiAgICAgICAgcmV0\ndXJuIHRydWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBMb2FkIGNvbmZpZ3Vy\nYXRpb24gZnJvbSB0aGUgZ2l2ZW4gcGVyc2lzdGVuY2UgdW5pdCB3aXRoIHRo\nZSBzcGVjaWZpZWQKICAgICAqIHVzZXIgcHJvcGVydGllcy4KICAgICAqLwog\nICAgcHVibGljIENvbmZpZ3VyYXRpb25Qcm92aWRlciBsb2FkKFBlcnNpc3Rl\nbmNlVW5pdEluZm8gcGluZm8sIE1hcCBtKQogICAgICAgIHRocm93cyBJT0V4\nY2VwdGlvbiB7CiAgICAgICAgaWYgKHBpbmZvID09IG51bGwpCiAgICAgICAg\nICAgIHJldHVybiBudWxsOwogICAgICAgIGlmICghaXNPcGVuSlBBUGVyc2lz\ndGVuY2VQcm92aWRlcihwaW5mbywgbnVsbCkpIHsKICAgICAgICAgICAgd2Fy\nblVua25vd25Qcm92aWRlcihwaW5mbyk7CiAgICAgICAgICAgIHJldHVybiBu\ndWxsOwogICAgICAgIH0KCiAgICAgICAgQ29uZmlndXJhdGlvblByb3ZpZGVy\nSW1wbCBjcCA9IG5ldyBDb25maWd1cmF0aW9uUHJvdmlkZXJJbXBsKCk7CiAg\nICAgICAgY3AuYWRkUHJvcGVydGllcyhQZXJzaXN0ZW5jZVVuaXRJbmZvSW1w\nbC50b09wZW5KUEFQcm9wZXJ0aWVzKHBpbmZvKSk7CiAgICAgICAgY3AuYWRk\nUHJvcGVydGllcyhtKTsKICAgICAgICBpZiAocGluZm8gaW5zdGFuY2VvZiBQ\nZXJzaXN0ZW5jZVVuaXRJbmZvSW1wbCkgewogICAgICAgICAgICBQZXJzaXN0\nZW5jZVVuaXRJbmZvSW1wbCBpbXBsID0gKFBlcnNpc3RlbmNlVW5pdEluZm9J\nbXBsKSBwaW5mbzsKICAgICAgICAgICAgaWYgKGltcGwuZ2V0UGVyc2lzdGVu\nY2VYbWxGaWxlVXJsKCkgIT0gbnVsbCkKICAgICAgICAgICAgICAgIGNwLnNl\ndFNvdXJjZShpbXBsLmdldFBlcnNpc3RlbmNlWG1sRmlsZVVybCgpLnRvU3Ry\naW5nKCkpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gY3A7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBMb2FkIGNvbmZpZ3VyYXRpb24gZnJvbSB0aGUgZ2l2\nZW4gcmVzb3VyY2UgYW5kIHVuaXQgbmFtZXMsIHdoaWNoIG1heQogICAgICog\nYmUgbnVsbC4KICAgICAqLwogICAgcHVibGljIENvbmZpZ3VyYXRpb25Qcm92\naWRlciBsb2FkKFN0cmluZyByc3JjLCBTdHJpbmcgbmFtZSwgTWFwIG0pCiAg\nICAgICAgdGhyb3dzIElPRXhjZXB0aW9uIHsKICAgICAgICBib29sZWFuIGV4\ncGxpY2l0ID0gIVN0cmluZ1V0aWxzLmlzRW1wdHkocnNyYyk7CiAgICAgICAg\naWYgKCFleHBsaWNpdCkKICAgICAgICAgICAgcnNyYyA9IFJTUkNfREVGQVVM\nVDsKICAgICAgICAKICAgICAgICBDb25maWd1cmF0aW9uUHJvdmlkZXJJbXBs\nIGNwID0gbmV3IENvbmZpZ3VyYXRpb25Qcm92aWRlckltcGwoKTsKICAgICAg\nICBCb29sZWFuIHJldCA9IGxvYWQoY3AsIHJzcmMsIG5hbWUsIG0sIG51bGws\nIGV4cGxpY2l0KTsKICAgICAgICBpZiAocmV0ICE9IG51bGwpCiAgICAgICAg\nICAgIHJldHVybiAocmV0LmJvb2xlYW5WYWx1ZSgpKSA/IGNwIDogbnVsbDsK\nICAgICAgICBpZiAoZXhwbGljaXQpCiAgICAgICAgICAgIHJldHVybiBudWxs\nOwoKICAgICAgICAvLyBwZXJzaXN0ZW5jZS54bWwgZG9lcyBub3QgZXhpc3Q7\nIGp1c3QgbG9hZCBtYXAKICAgICAgICBQZXJzaXN0ZW5jZVVuaXRJbmZvSW1w\nbCBwaW5mbyA9IG5ldyBQZXJzaXN0ZW5jZVVuaXRJbmZvSW1wbCgpOwogICAg\nICAgIHBpbmZvLmZyb21Vc2VyUHJvcGVydGllcyhtKTsKICAgICAgICBpZiAo\nIWlzT3BlbkpQQVBlcnNpc3RlbmNlUHJvdmlkZXIocGluZm8sIG51bGwpKSB7\nCiAgICAgICAgICAgIHdhcm5Vbmtub3duUHJvdmlkZXIocGluZm8pOwogICAg\nICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICB9CiAgICAgICAgY3AuYWRk\nUHJvcGVydGllcyhwaW5mby50b09wZW5KUEFQcm9wZXJ0aWVzKCkpOwogICAg\nICAgIHJldHVybiBjcDsKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHB1Ymxp\nYyBDb25maWd1cmF0aW9uUHJvdmlkZXIgbG9hZChTdHJpbmcgcnNyYywgU3Ry\naW5nIGFuY2hvciwgCiAgICAgICAgQ2xhc3NMb2FkZXIgbG9hZGVyKQogICAg\nICAgIHRocm93cyBJT0V4Y2VwdGlvbiB7CiAgICAgICAgaWYgKHJzcmMgIT0g\nbnVsbCAmJiAhcnNyYy5lbmRzV2l0aCgiLnhtbCIpKQogICAgICAgICAgICBy\nZXR1cm4gbnVsbDsKICAgICAgICBDb25maWd1cmF0aW9uUHJvdmlkZXJJbXBs\nIGNwID0gbmV3IENvbmZpZ3VyYXRpb25Qcm92aWRlckltcGwoKTsKICAgICAg\nICBpZiAobG9hZChjcCwgcnNyYywgYW5jaG9yLCBudWxsLCBsb2FkZXIsIHRy\ndWUpID09IEJvb2xlYW4uVFJVRSkKICAgICAgICAgICAgcmV0dXJuIGNwOwog\nICAgICAgIHJldHVybiBudWxsOwogICAgfQoKICAgIEBPdmVycmlkZQogICAg\ncHVibGljIENvbmZpZ3VyYXRpb25Qcm92aWRlciBsb2FkKEZpbGUgZmlsZSwg\nU3RyaW5nIGFuY2hvcikgCiAgICAgICAgdGhyb3dzIElPRXhjZXB0aW9uIHsK\nICAgICAgICBpZiAoIWZpbGUuZ2V0TmFtZSgpLmVuZHNXaXRoKCIueG1sIikp\nCiAgICAgICAgICAgIHJldHVybiBudWxsOwoKICAgICAgICBDb25maWd1cmF0\naW9uUGFyc2VyIHBhcnNlciA9IG5ldyBDb25maWd1cmF0aW9uUGFyc2VyKG51\nbGwpOwogICAgICAgIHBhcnNlci5wYXJzZShmaWxlKTsKICAgICAgICByZXR1\ncm4gbG9hZChmaW5kVW5pdCgoTGlzdDxQZXJzaXN0ZW5jZVVuaXRJbmZvSW1w\nbD4pIAogICAgICAgICAgICBwYXJzZXIuZ2V0UmVzdWx0cygpLCBhbmNob3Is\nIG51bGwpLCBudWxsKTsKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHB1Ymxp\nYyBDb25maWd1cmF0aW9uUHJvdmlkZXIgbG9hZEdsb2JhbHMoQ2xhc3NMb2Fk\nZXIgbG9hZGVyKQogICAgICAgIHRocm93cyBJT0V4Y2VwdGlvbiB7CiAgICAg\nICAgU3RyaW5nW10gcHJlZml4ZXMgPSBQcm9kdWN0RGVyaXZhdGlvbnMuZ2V0\nQ29uZmlndXJhdGlvblByZWZpeGVzKCk7CiAgICAgICAgU3RyaW5nIHJzcmMg\nPSBudWxsOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgcHJlZml4ZXMu\nbGVuZ3RoICYmIFN0cmluZ1V0aWxzLmlzRW1wdHkocnNyYyk7IGkrKykKICAg\nICAgICAgICByc3JjID0gU3lzdGVtLmdldFByb3BlcnR5KHByZWZpeGVzW2ld\nICsgIi5wcm9wZXJ0aWVzIik7IAogICAgICAgIGJvb2xlYW4gZXhwbGljaXQg\nPSAhU3RyaW5nVXRpbHMuaXNFbXB0eShyc3JjKTsKICAgICAgICBTdHJpbmcg\nYW5jaG9yID0gbnVsbDsKICAgICAgICBpbnQgaWR4ID0gKCFleHBsaWNpdCkg\nPyAtMSA6IHJzcmMubGFzdEluZGV4T2YoJyMnKTsKICAgICAgICBpZiAoaWR4\nICE9IC0xKSB7CiAgICAgICAgICAgIC8vIHNlcGFyYXRlIG5hbWUgZnJvbSA8\ncmVzcm91Y2U+IzxuYW1lPiBzdHJpbmcKICAgICAgICAgICAgaWYgKGlkeCA8\nIHJzcmMubGVuZ3RoKCkgLSAxKQogICAgICAgICAgICAgICAgYW5jaG9yID0g\ncnNyYy5zdWJzdHJpbmcoaWR4ICsgMSk7CiAgICAgICAgICAgIHJzcmMgPSBy\nc3JjLnN1YnN0cmluZygwLCBpZHgpOwogICAgICAgIH0KICAgICAgICBpZiAo\nU3RyaW5nVXRpbHMuaXNFbXB0eShyc3JjKSkKICAgICAgICAgICAgcnNyYyA9\nIFJTUkNfR0xPQkFMOwogICAgICAgIGVsc2UgaWYgKCFyc3JjLmVuZHNXaXRo\nKCIueG1sIikpCiAgICAgICAgICAgIHJldHVybiBudWxsOwoKICAgICAgICBD\nb25maWd1cmF0aW9uUHJvdmlkZXJJbXBsIGNwID0gbmV3IENvbmZpZ3VyYXRp\nb25Qcm92aWRlckltcGwoKTsKICAgICAgICBpZiAobG9hZChjcCwgcnNyYywg\nYW5jaG9yLCBudWxsLCBsb2FkZXIsIGV4cGxpY2l0KSA9PSBCb29sZWFuLlRS\nVUUpCiAgICAgICAgICAgIHJldHVybiBjcDsKICAgICAgICByZXR1cm4gbnVs\nbDsKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyBDb25maWd1cmF0\naW9uUHJvdmlkZXIgbG9hZERlZmF1bHRzKENsYXNzTG9hZGVyIGxvYWRlcikK\nICAgICAgICB0aHJvd3MgSU9FeGNlcHRpb24gewogICAgICAgIENvbmZpZ3Vy\nYXRpb25Qcm92aWRlckltcGwgY3AgPSBuZXcgQ29uZmlndXJhdGlvblByb3Zp\nZGVySW1wbCgpOwogICAgICAgIGlmIChsb2FkKGNwLCBSU1JDX0RFRkFVTFQs\nIG51bGwsIG51bGwsIGxvYWRlciwgZmFsc2UpID09IEJvb2xlYW4uVFJVRSkK\nICAgICAgICAgICAgcmV0dXJuIGNwOwogICAgICAgIHJldHVybiBudWxsOwog\nICAgfQoKICAgIC8qKgogICAgICogTG9va3MgdGhyb3VnaCB0aGUgcmVzb3Vy\nY2VzIGF0IDxjb2RlPnJzcmM8L2NvZGU+IGZvciBhIGNvbmZpZ3VyYXRpb24K\nICAgICAqIGZpbGUgdGhhdCBtYXRjaGVzIDxjb2RlPm5hbWU8L2NvZGU+IChv\nciBhbiB1bm5hbWVkIG9uZSBpZgogICAgICogPGNvZGU+bmFtZTwvY29kZT4g\naXMgPGNvZGU+bnVsbDwvY29kZT4pLCBhbmQgbG9hZHMgdGhlIFhNTCBpbiB0\naGUKICAgICAqIHJlc291cmNlIGludG8gYSBuZXcge0BsaW5rIFBlcnNpc3Rl\nbmNlVW5pdEluZm99LiBUaGVuLCBhcHBsaWVzIHRoZQogICAgICogb3ZlcnJp\nZGVzIGluIDxjb2RlPm08L2NvZGU+LgogICAgICoKICAgICAqIEByZXR1cm4g\ne0BsaW5rIEJvb2xlYW4jVFJVRX0gaWYgdGhlIHJlc291cmNlIHdhcyBsb2Fk\nZWQsIG51bGwgaWYgaXQKICAgICAqIGRvZXMgbm90IGV4aXN0LCBvciB7QGxp\nbmsgQm9vbGVhbiNGQUxTRX0gaWYgaXQgaXMgbm90IGZvciBPcGVuSlBBCiAg\nICAgKi8KICAgIHByaXZhdGUgQm9vbGVhbiBsb2FkKENvbmZpZ3VyYXRpb25Q\ncm92aWRlckltcGwgY3AsIFN0cmluZyByc3JjLCAKICAgICAgICBTdHJpbmcg\nbmFtZSwgTWFwIG0sIENsYXNzTG9hZGVyIGxvYWRlciwgYm9vbGVhbiBleHBs\naWNpdCkKICAgICAgICB0aHJvd3MgSU9FeGNlcHRpb24gewogICAgICAgIGlm\nIChsb2FkZXIgPT0gbnVsbCkKICAgICAgICAgICAgbG9hZGVyID0gVGhyZWFk\nLmN1cnJlbnRUaHJlYWQoKS5nZXRDb250ZXh0Q2xhc3NMb2FkZXIoKTsKCiAg\nICAgICAgRW51bWVyYXRpb248VVJMPiB1cmxzID0gbG9hZGVyLmdldFJlc291\ncmNlcyhyc3JjKTsKICAgICAgICBpZiAoIXVybHMuaGFzTW9yZUVsZW1lbnRz\nKCkpIHsKICAgICAgICAgICAgaWYgKCFyc3JjLnN0YXJ0c1dpdGgoIk1FVEEt\nSU5GIikpCiAgICAgICAgICAgICAgICB1cmxzID0gbG9hZGVyLmdldFJlc291\ncmNlcygiTUVUQS1JTkYvIiArIHJzcmMpOwogICAgICAgICAgICBpZiAoIXVy\nbHMuaGFzTW9yZUVsZW1lbnRzKCkpCiAgICAgICAgICAgICAgICByZXR1cm4g\nbnVsbDsKICAgICAgICB9CgogICAgICAgIENvbmZpZ3VyYXRpb25QYXJzZXIg\ncGFyc2VyID0gbmV3IENvbmZpZ3VyYXRpb25QYXJzZXIobSk7CiAgICAgICAg\nUGVyc2lzdGVuY2VVbml0SW5mb0ltcGwgcGluZm8gPSBwYXJzZVJlc291cmNl\ncyhwYXJzZXIsIHVybHMsIG5hbWUsIAogICAgICAgICAgICBsb2FkZXIpOwog\nICAgICAgIGlmIChwaW5mbyA9PSBudWxsKSB7CiAgICAgICAgICAgIGlmICgh\nZXhwbGljaXQpCiAgICAgICAgICAgICAgICByZXR1cm4gQm9vbGVhbi5GQUxT\nRTsKICAgICAgICAgICAgdGhyb3cgbmV3IE1pc3NpbmdSZXNvdXJjZUV4Y2Vw\ndGlvbihfbG9jLmdldCgibWlzc2luZy14bWwtY29uZmlnIiwgCiAgICAgICAg\nICAgICAgICByc3JjLCBTdHJpbmcudmFsdWVPZihuYW1lKSkuZ2V0TWVzc2Fn\nZSgpLCBnZXRDbGFzcygpLmdldE5hbWUoKSwgCiAgICAgICAgICAgICAgICBy\nc3JjKTsKICAgICAgICB9IGVsc2UgaWYgKCFpc09wZW5KUEFQZXJzaXN0ZW5j\nZVByb3ZpZGVyKHBpbmZvLCBsb2FkZXIpKSB7CiAgICAgICAgICAgIGlmICgh\nZXhwbGljaXQpIHsKICAgICAgICAgICAgICAgIHdhcm5Vbmtub3duUHJvdmlk\nZXIocGluZm8pOwogICAgICAgICAgICAgICAgcmV0dXJuIEJvb2xlYW4uRkFM\nU0U7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgdGhyb3cgbmV3IE1pc3Np\nbmdSZXNvdXJjZUV4Y2VwdGlvbihfbG9jLmdldCgidW5rbm93bi1wcm92aWRl\nciIsIAogICAgICAgICAgICAgICAgcnNyYywgbmFtZSwgcGluZm8uZ2V0UGVy\nc2lzdGVuY2VQcm92aWRlckNsYXNzTmFtZSgpKS4KICAgICAgICAgICAgICAg\nIGdldE1lc3NhZ2UoKSwgZ2V0Q2xhc3MoKS5nZXROYW1lKCksIHJzcmMpOwog\nICAgICAgIH0KICAgICAgICBjcC5hZGRQcm9wZXJ0aWVzKHBpbmZvLnRvT3Bl\nbkpQQVByb3BlcnRpZXMoKSk7CiAgICAgICAgY3Auc2V0U291cmNlKHBpbmZv\nLmdldFBlcnNpc3RlbmNlWG1sRmlsZVVybCgpLnRvU3RyaW5nKCkpOwogICAg\nICAgIHJldHVybiBCb29sZWFuLlRSVUU7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBQYXJzZSByZXNvdXJjZXMgYXQgdGhlIGdpdmVuIGxvY2F0aW9uLiBTZWFy\nY2hlcyBmb3IgYQogICAgICogUGVyc2lzdGVuY2VVbml0SW5mbyB3aXRoIHRo\nZSByZXF1ZXN0ZWQgbmFtZSwgb3IgYW4gT3BlbkpQQSB1bml0IGlmCiAgICAg\nKiBubyBuYW1lIGdpdmVuIChwcmVmZXJyaW5nIGFuIHVubmFtZWQgT3BlbkpQ\nQSB1bml0IHRvIGEgbmFtZWQgb25lKS4KICAgICAqLwogICAgcHJpdmF0ZSBQ\nZXJzaXN0ZW5jZVVuaXRJbmZvSW1wbCBwYXJzZVJlc291cmNlcyhDb25maWd1\ncmF0aW9uUGFyc2VyIHBhcnNlciwKICAgICAgICBFbnVtZXJhdGlvbjxVUkw+\nIHVybHMsIFN0cmluZyBuYW1lLCBDbGFzc0xvYWRlciBsb2FkZXIpCiAgICAg\nICAgdGhyb3dzIElPRXhjZXB0aW9uIHsKICAgICAgICBMaXN0PFBlcnNpc3Rl\nbmNlVW5pdEluZm9JbXBsPiBwaW5mb3MgPSAKICAgICAgICAgICAgbmV3IEFy\ncmF5TGlzdDxQZXJzaXN0ZW5jZVVuaXRJbmZvSW1wbD4oKTsKICAgICAgICBm\nb3IgKFVSTCB1cmwgOiBDb2xsZWN0aW9ucy5saXN0KHVybHMpKSB7CiAgICAg\nICAgICAgIHBhcnNlci5wYXJzZSh1cmwpOwogICAgICAgICAgICBwaW5mb3Mu\nYWRkQWxsKChMaXN0PFBlcnNpc3RlbmNlVW5pdEluZm9JbXBsPikgcGFyc2Vy\nLmdldFJlc3VsdHMoKSk7CiAgICAgICAgfQogICAgICAgIHJldHVybiBmaW5k\nVW5pdChwaW5mb3MsIG5hbWUsIGxvYWRlcik7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBGaW5kIHRoZSB1bml0IHdpdGggdGhlIGdpdmVuIG5hbWUsIG9yIGFu\nIE9wZW5KUEEgdW5pdCBpZiBubyBuYW1lIGlzCiAgICAgKiBnaXZlbiAocHJl\nZmVycmluZyBhbiB1bm5hbWVkIE9wZW5KUEEgdW5pdCB0byBhIG5hbWVkIG9u\nZSkuCiAgICAgKi8KICAgIHByaXZhdGUgUGVyc2lzdGVuY2VVbml0SW5mb0lt\ncGwgZmluZFVuaXQoTGlzdDxQZXJzaXN0ZW5jZVVuaXRJbmZvSW1wbD4gCiAg\nICAgICAgcGluZm9zLCBTdHJpbmcgbmFtZSwgQ2xhc3NMb2FkZXIgbG9hZGVy\nKSB7CiAgICAgICAgUGVyc2lzdGVuY2VVbml0SW5mb0ltcGwgb2pwYSA9IG51\nbGw7CiAgICAgICAgZm9yIChQZXJzaXN0ZW5jZVVuaXRJbmZvSW1wbCBwaW5m\nbyA6IHBpbmZvcykgewogICAgICAgICAgICAvLyBmb3VuZCBuYW1lZCB1bml0\nPwogICAgICAgICAgICBpZiAobmFtZSAhPSBudWxsKSB7CiAgICAgICAgICAg\nICAgICBpZiAobmFtZS5lcXVhbHMocGluZm8uZ2V0UGVyc2lzdGVuY2VVbml0\nTmFtZSgpKSkKICAgICAgICAgICAgICAgICAgICByZXR1cm4gcGluZm87CiAg\nICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgfQoKICAgICAg\nICAgICAgaWYgKGlzT3BlbkpQQVBlcnNpc3RlbmNlUHJvdmlkZXIocGluZm8s\nIGxvYWRlcikpIHsKICAgICAgICAgICAgICAgIC8vIGlmIG5vIG5hbWUgZ2l2\nZW4gYW5kIGZvdW5kIHVubmFtZWQgdW5pdCwgcmV0dXJuIGl0LiAgCiAgICAg\nICAgICAgICAgICAvLyBvdGhlcndpc2UgcmVjb3JkIGFzIGRlZmF1bHQgdW5p\ndCB1bmxlc3Mgd2UgZmluZCBhIAogICAgICAgICAgICAgICAgLy8gYmV0dGVy\nIG1hdGNoIGxhdGVyCiAgICAgICAgICAgICAgICBpZiAoU3RyaW5nVXRpbHMu\naXNFbXB0eShwaW5mby5nZXRQZXJzaXN0ZW5jZVVuaXROYW1lKCkpKQogICAg\nICAgICAgICAgICAgICAgIHJldHVybiBwaW5mbzsKICAgICAgICAgICAgICAg\nIGlmIChvanBhID09IG51bGwpCiAgICAgICAgICAgICAgICAgICAgb2pwYSA9\nIHBpbmZvOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVy\nbiBvanBhOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHdoZXRoZXIg\ndGhlIGdpdmVuIHBlcnNpc3RlbmNlIHVuaXQgdXNlcyBhbiBPcGVuSlBBIHBy\nb3ZpZGVyLgogICAgICovCiAgICBwcml2YXRlIHN0YXRpYyBib29sZWFuIGlz\nT3BlbkpQQVBlcnNpc3RlbmNlUHJvdmlkZXIKICAgICAgICAoUGVyc2lzdGVu\nY2VVbml0SW5mbyBwaW5mbywgQ2xhc3NMb2FkZXIgbG9hZGVyKSB7CiAgICAg\nICAgU3RyaW5nIHByb3ZpZGVyID0gcGluZm8uZ2V0UGVyc2lzdGVuY2VQcm92\naWRlckNsYXNzTmFtZSgpOwogICAgICAgIGlmIChTdHJpbmdVdGlscy5pc0Vt\ncHR5KHByb3ZpZGVyKSAKICAgICAgICAgICAgfHwgUGVyc2lzdGVuY2VQcm92\naWRlckltcGwuY2xhc3MuZ2V0TmFtZSgpLmVxdWFscyhwcm92aWRlcikpCiAg\nICAgICAgICAgIHJldHVybiB0cnVlOwoKICAgICAgICBpZiAobG9hZGVyID09\nIG51bGwpCiAgICAgICAgICAgIGxvYWRlciA9IFRocmVhZC5jdXJyZW50VGhy\nZWFkKCkuZ2V0Q29udGV4dENsYXNzTG9hZGVyKCk7CiAgICAgICAgdHJ5IHsK\nICAgICAgICAgICAgaWYgKFBlcnNpc3RlbmNlUHJvdmlkZXJJbXBsLmNsYXNz\nLmlzQXNzaWduYWJsZUZyb20KICAgICAgICAgICAgICAgIChDbGFzcy5mb3JO\nYW1lKHByb3ZpZGVyLCBmYWxzZSwgbG9hZGVyKSkpCiAgICAgICAgICAgICAg\nICByZXR1cm4gdHJ1ZTsKICAgICAgICB9IGNhdGNoIChUaHJvd2FibGUgdCkg\newogICAgICAgICAgICBsb2coX2xvYy5nZXQoInVubG9hZGFibGUtcHJvdmlk\nZXIiLCBwcm92aWRlciwgdCkuZ2V0TWVzc2FnZSgpKTsKICAgICAgICAgICAg\ncmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAgICAgICByZXR1cm4gZmFsc2U7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBXYXJuIHRoZSB1c2VyIHRoYXQgd2Ug\nY291bGQgb25seSBmaW5kIGFuIHVucmVjb2duaXplZCBwZXJzaXN0ZW5jZSAK\nICAgICAqIHByb3ZpZGVyLgogICAgICovCiAgICBwcml2YXRlIHN0YXRpYyB2\nb2lkIHdhcm5Vbmtub3duUHJvdmlkZXIoUGVyc2lzdGVuY2VVbml0SW5mbyBw\naW5mbykgewogICAgICAgIGxvZyhfbG9jLmdldCgidW5yZWNvZ25pemVkLXBy\nb3ZpZGVyIiwgCiAgICAgICAgICAgIHBpbmZvLmdldFBlcnNpc3RlbmNlUHJv\ndmlkZXJDbGFzc05hbWUoKSkuZ2V0TWVzc2FnZSgpKTsKICAgIH0KICAgIAog\nICAgLyoqCiAgICAgKiBMb2cgYSBtZXNzYWdlLiAgIAogICAgICovCiAgICBw\ncml2YXRlIHN0YXRpYyB2b2lkIGxvZyhTdHJpbmcgbXNnKSB7CiAgICAgICAg\nLy8gYXQgdGhpcyBwb2ludCBsb2dnaW5nIGlzbid0IGNvbmZpZ3VyZWQgeWV0\nCiAgICAgICAgU3lzdGVtLmVyci5wcmludGxuKG1zZyk7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBDdXN0b20gY29uZmlndXJhdGlvbiBwcm92aWRlci4gICAK\nICAgICAqLwogICAgcHVibGljIHN0YXRpYyBjbGFzcyBDb25maWd1cmF0aW9u\nUHJvdmlkZXJJbXBsCiAgICAgICAgZXh0ZW5kcyBNYXBDb25maWd1cmF0aW9u\nUHJvdmlkZXIgewoKICAgICAgICBwcml2YXRlIFN0cmluZyBfc291cmNlOwoK\nICAgICAgICBwdWJsaWMgQ29uZmlndXJhdGlvblByb3ZpZGVySW1wbCgpIHsK\nICAgICAgICB9CgogICAgICAgIHB1YmxpYyBDb25maWd1cmF0aW9uUHJvdmlk\nZXJJbXBsKE1hcCBwcm9wcykgewogICAgICAgICAgICBzdXBlcihwcm9wcyk7\nCiAgICAgICAgfQoKICAgICAgICAvKioKICAgICAgICAgKiBTZXQgdGhlIHNv\ndXJjZSBvZiBpbmZvcm1hdGlvbiBpbiB0aGlzIHByb3ZpZGVyLgogICAgICAg\nICAqLwogICAgICAgIHB1YmxpYyB2b2lkIHNldFNvdXJjZShTdHJpbmcgc291\ncmNlKSB7CiAgICAgICAgICAgIF9zb3VyY2UgPSBzb3VyY2U7CiAgICAgICAg\nfQoKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBwdWJsaWMgdm9pZCBzZXRJ\nbnRvKENvbmZpZ3VyYXRpb24gY29uZikgewogICAgICAgICAgICBpZiAoY29u\nZiBpbnN0YW5jZW9mIE9wZW5KUEFDb25maWd1cmF0aW9uKSB7CiAgICAgICAg\nICAgICAgICBPcGVuSlBBQ29uZmlndXJhdGlvbiBvY29uZiA9IChPcGVuSlBB\nQ29uZmlndXJhdGlvbikgY29uZjsKICAgICAgICAgICAgICAgIG9jb25mLnNl\ndFNwZWNpZmljYXRpb24oU1BFQ19KUEEpOwoKICAgICAgICAgICAgICAgIC8v\nIHdlIG1lcmdlIHNldmVyYWwgcGVyc2lzdGVuY2UueG1sIGVsZW1lbnRzIGlu\ndG8gdGhlIAogICAgICAgICAgICAgICAgLy8gTWV0YURhdGFGYWN0b3J5IHBy\nb3BlcnR5IGltcGxpY2l0bHkuICBpZiB0aGUgdXNlciBoYXMgYQogICAgICAg\nICAgICAgICAgLy8gZ2xvYmFsIG9wZW5qcGEueG1sIHdpdGggdGhpcyBwcm9w\nZXJ0eSBzZXQsIGl0cyB2YWx1ZSB3aWxsCiAgICAgICAgICAgICAgICAvLyBn\nZXQgb3ZlcndyaXR0ZW4gYnkgb3VyIGltcGxpY2l0IHNldHRpbmcuICBzbyBp\nbnN0ZWFkLCBjb21iaW5lCiAgICAgICAgICAgICAgICAvLyB0aGUgZ2xvYmFs\nIHZhbHVlIHdpdGggb3VyIHNldHRpbmdzCiAgICAgICAgICAgICAgICBTdHJp\nbmcgb3JpZyA9IG9jb25mLmdldE1ldGFEYXRhRmFjdG9yeSgpOwogICAgICAg\nICAgICAgICAgaWYgKCFTdHJpbmdVdGlscy5pc0VtcHR5KG9yaWcpKSB7CiAg\nICAgICAgICAgICAgICAgICAgU3RyaW5nIGtleSA9IFByb2R1Y3REZXJpdmF0\naW9ucy5nZXRDb25maWd1cmF0aW9uS2V5CiAgICAgICAgICAgICAgICAgICAg\nICAgICgiTWV0YURhdGFGYWN0b3J5IiwgZ2V0UHJvcGVydGllcygpKTsKICAg\nICAgICAgICAgICAgICAgICBPYmplY3Qgb3ZlcnJpZGUgPSBnZXRQcm9wZXJ0\naWVzKCkuZ2V0KGtleSk7CiAgICAgICAgICAgICAgICAgICAgaWYgKG92ZXJy\naWRlIGluc3RhbmNlb2YgU3RyaW5nKQogICAgICAgICAgICAgICAgICAgICAg\nICBhZGRQcm9wZXJ0eShrZXksIENvbmZpZ3VyYXRpb25zLmNvbWJpbmVQbHVn\naW5zKG9yaWcsIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgKFN0cmlu\nZykgb3ZlcnJpZGUpKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAg\nfQoKICAgICAgICAgICAgc3VwZXIuc2V0SW50byhjb25mLCBudWxsKTsKICAg\nICAgICAgICAgTG9nIGxvZyA9IGNvbmYuZ2V0Q29uZmlndXJhdGlvbkxvZygp\nOwogICAgICAgICAgICBpZiAobG9nLmlzVHJhY2VFbmFibGVkKCkpIHsKICAg\nICAgICAgICAgICAgIFN0cmluZyBzcmMgPSAoX3NvdXJjZSA9PSBudWxsKSA/\nICI/IiA6IF9zb3VyY2U7CiAgICAgICAgICAgICAgICBsb2cudHJhY2UoX2xv\nYy5nZXQoImNvbmYtbG9hZCIsIHNyYywgZ2V0UHJvcGVydGllcygpKSk7CiAg\nICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBT\nQVggaGFuZGxlciBjYXBhYmxlIG9mIHBhcnNpbmcgYW4gSlBBIHBlcnNpc3Rl\nbmNlLnhtbCBmaWxlLgogICAgICogUGFja2FnZS1wcm90ZWN0ZWQgZm9yIHRl\nc3RpbmcuCiAgICAgKi8KICAgIHN0YXRpYyBjbGFzcyBDb25maWd1cmF0aW9u\nUGFyc2VyCiAgICAgICAgZXh0ZW5kcyBYTUxNZXRhRGF0YVBhcnNlciB7Cgog\nICAgICAgIHByaXZhdGUgZmluYWwgTWFwIF9tYXA7CiAgICAgICAgcHJpdmF0\nZSBQZXJzaXN0ZW5jZVVuaXRJbmZvSW1wbCBfaW5mbyA9IG51bGw7CiAgICAg\nICAgcHJpdmF0ZSBVUkwgX3NvdXJjZSA9IG51bGw7CgogICAgICAgIHB1Ymxp\nYyBDb25maWd1cmF0aW9uUGFyc2VyKE1hcCBtYXApIHsKICAgICAgICAgICAg\nX21hcCA9IG1hcDsKICAgICAgICAgICAgc2V0Q2FjaGluZyhmYWxzZSk7CiAg\nICAgICAgICAgIHNldFZhbGlkYXRpbmcodHJ1ZSk7CiAgICAgICAgICAgIHNl\ndFBhcnNlVGV4dCh0cnVlKTsKICAgICAgICB9CgogICAgICAgIEBPdmVycmlk\nZQogICAgICAgIHB1YmxpYyB2b2lkIHBhcnNlKFVSTCB1cmwpCiAgICAgICAg\nICAgIHRocm93cyBJT0V4Y2VwdGlvbiB7CiAgICAgICAgICAgIF9zb3VyY2Ug\nPSB1cmw7CiAgICAgICAgICAgIHN1cGVyLnBhcnNlKHVybCk7CiAgICAgICAg\nfQoKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBwdWJsaWMgdm9pZCBwYXJz\nZShGaWxlIGZpbGUpCiAgICAgICAgICAgIHRocm93cyBJT0V4Y2VwdGlvbiB7\nCiAgICAgICAgICAgIF9zb3VyY2UgPSBmaWxlLnRvVVJMKCk7CiAgICAgICAg\nICAgIHN1cGVyLnBhcnNlKGZpbGUpOwogICAgICAgIH0KCiAgICAgICAgQE92\nZXJyaWRlCiAgICAgICAgcHJvdGVjdGVkIE9iamVjdCBnZXRTY2hlbWFTb3Vy\nY2UoKSB7CiAgICAgICAgICAgIHJldHVybiBnZXRDbGFzcygpLmdldFJlc291\ncmNlQXNTdHJlYW0oInBlcnNpc3RlbmNlLXhzZC5yc3JjIik7CiAgICAgICAg\nfQoKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBwcm90ZWN0ZWQgdm9pZCBy\nZXNldCgpIHsKICAgICAgICAgICAgc3VwZXIucmVzZXQoKTsKICAgICAgICAg\nICAgX2luZm8gPSBudWxsOwogICAgICAgICAgICBfc291cmNlID0gbnVsbDsK\nICAgICAgICB9CgogICAgICAgIHByb3RlY3RlZCBib29sZWFuIHN0YXJ0RWxl\nbWVudChTdHJpbmcgbmFtZSwgQXR0cmlidXRlcyBhdHRycykKICAgICAgICAg\nICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgICAgIGlmIChjdXJy\nZW50RGVwdGgoKSA9PSAxKQogICAgICAgICAgICAgICAgc3RhcnRQZXJzaXN0\nZW5jZVVuaXQoYXR0cnMpOwogICAgICAgICAgICBlbHNlIGlmIChjdXJyZW50\nRGVwdGgoKSA9PSAzICYmICJwcm9wZXJ0eSIuZXF1YWxzKG5hbWUpKQogICAg\nICAgICAgICAgICAgX2luZm8uc2V0UHJvcGVydHkoYXR0cnMuZ2V0VmFsdWUo\nIm5hbWUiKSwKICAgICAgICAgICAgICAgICAgICBhdHRycy5nZXRWYWx1ZSgi\ndmFsdWUiKSk7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0K\nCiAgICAgICAgcHJvdGVjdGVkIHZvaWQgZW5kRWxlbWVudChTdHJpbmcgbmFt\nZSkKICAgICAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAg\nICAgIGlmIChjdXJyZW50RGVwdGgoKSA9PSAxKSB7CiAgICAgICAgICAgICAg\nICBfaW5mby5mcm9tVXNlclByb3BlcnRpZXMoX21hcCk7CiAgICAgICAgICAg\nICAgICBhZGRSZXN1bHQoX2luZm8pOwogICAgICAgICAgICB9CiAgICAgICAg\nICAgIGlmIChjdXJyZW50RGVwdGgoKSAhPSAyKQogICAgICAgICAgICAgICAg\ncmV0dXJuOwoKICAgICAgICAgICAgc3dpdGNoIChuYW1lLmNoYXJBdCgwKSkg\newogICAgICAgICAgICAgICAgY2FzZSAnYyc6IC8vIGNsYXNzCiAgICAgICAg\nICAgICAgICAgICAgX2luZm8uYWRkTWFuYWdlZENsYXNzTmFtZShjdXJyZW50\nVGV4dCgpKTsKICAgICAgICAgICAgICAgIGNhc2UgJ2UnOiAvLyBleGNsdWRl\nLXVubGlzdGVkLWNsYXNzZXMKICAgICAgICAgICAgICAgICAgICBfaW5mby5z\nZXRFeGNsdWRlVW5saXN0ZWRDbGFzc2VzKCJ0cnVlIi5lcXVhbHNJZ25vcmVD\nYXNlCiAgICAgICAgICAgICAgICAgICAgICAgIChjdXJyZW50VGV4dCgpKSk7\nCiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBj\nYXNlICdqJzoKICAgICAgICAgICAgICAgICAgICBpZiAoImp0YS1kYXRhLXNv\ndXJjZSIuZXF1YWxzKG5hbWUpKQogICAgICAgICAgICAgICAgICAgICAgICBf\naW5mby5zZXRKdGFEYXRhU291cmNlTmFtZShjdXJyZW50VGV4dCgpKTsKICAg\nICAgICAgICAgICAgICAgICBlbHNlIC8vIGphci1maWxlCiAgICAgICAgICAg\nICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICB0cnkgewogICAg\nICAgICAgICAgICAgICAgICAgICAgICAgX2luZm8uYWRkSmFyRmlsZU5hbWUo\nY3VycmVudFRleHQoKSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0\nY2ggKElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiBpYWUpIHsKICAgICAgICAg\nICAgICAgICAgICAgICAgICAgIHRocm93IGdldEV4Y2VwdGlvbihpYWUuZ2V0\nTWVzc2FnZSgpKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAg\nICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBicmVhazsKICAg\nICAgICAgICAgICAgIGNhc2UgJ20nOiAvLyBtYXBwaW5nLWZpbGUKICAgICAg\nICAgICAgICAgICAgICBfaW5mby5hZGRNYXBwaW5nRmlsZU5hbWUoY3VycmVu\ndFRleHQoKSk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAg\nICAgICAgICBjYXNlICduJzogLy8gbm9uLWp0YS1kYXRhLXNvdXJjZQogICAg\nICAgICAgICAgICAgICAgIF9pbmZvLnNldE5vbkp0YURhdGFTb3VyY2VOYW1l\nKGN1cnJlbnRUZXh0KCkpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwog\nICAgICAgICAgICAgICAgY2FzZSAncCc6CiAgICAgICAgICAgICAgICAgICAg\naWYgKCJwcm92aWRlciIuZXF1YWxzKG5hbWUpKQogICAgICAgICAgICAgICAg\nICAgICAgICBfaW5mby5zZXRQZXJzaXN0ZW5jZVByb3ZpZGVyQ2xhc3NOYW1l\nKGN1cnJlbnRUZXh0KCkpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwog\nICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAvKioKICAgICAgICAg\nKiBQYXJzZSBwZXJzaXN0ZW5jZS11bml0IGVsZW1lbnQuCiAgICAgICAgICov\nCiAgICAgICAgcHJpdmF0ZSB2b2lkIHN0YXJ0UGVyc2lzdGVuY2VVbml0KEF0\ndHJpYnV0ZXMgYXR0cnMpCiAgICAgICAgICAgIHRocm93cyBTQVhFeGNlcHRp\nb24gewogICAgICAgICAgICBfaW5mbyA9IG5ldyBQZXJzaXN0ZW5jZVVuaXRJ\nbmZvSW1wbCgpOwogICAgICAgICAgICBfaW5mby5zZXRQZXJzaXN0ZW5jZVVu\naXROYW1lKGF0dHJzLmdldFZhbHVlKCJuYW1lIikpOwoKICAgICAgICAgICAg\nLy8gd2Ugb25seSBwYXJzZSB0aGlzIG91cnNlbHZlcyBvdXRzaWRlIGEgY29u\ndGFpbmVyLCBzbyBkZWZhdWx0CiAgICAgICAgICAgIC8vIHRyYW5zYWN0aW9u\nIHR5cGUgdG8gbG9jYWwKICAgICAgICAgICAgU3RyaW5nIHZhbCA9IGF0dHJz\nLmdldFZhbHVlKCJ0cmFuc2FjdGlvbi10eXBlIik7CiAgICAgICAgICAgIGlm\nICh2YWwgPT0gbnVsbCkKICAgICAgICAgICAgICAgIF9pbmZvLnNldFRyYW5z\nYWN0aW9uVHlwZQogICAgICAgICAgICAgICAgICAgIChQZXJzaXN0ZW5jZVVu\naXRUcmFuc2FjdGlvblR5cGUuUkVTT1VSQ0VfTE9DQUwpOwogICAgICAgICAg\nICBlbHNlCiAgICAgICAgICAgICAgICBfaW5mby5zZXRUcmFuc2FjdGlvblR5\ncGUoRW51bS52YWx1ZU9mCiAgICAgICAgICAgICAgICAgICAgKFBlcnNpc3Rl\nbmNlVW5pdFRyYW5zYWN0aW9uVHlwZS5jbGFzcywgdmFsKSk7CgogICAgICAg\nICAgICBpZiAoX3NvdXJjZSAhPSBudWxsKQogICAgICAgICAgICAgICAgX2lu\nZm8uc2V0UGVyc2lzdGVuY2VYbWxGaWxlVXJsKF9zb3VyY2UpOwoJCX0KCX0K\nfQo=\n","encoding":"base64"}

