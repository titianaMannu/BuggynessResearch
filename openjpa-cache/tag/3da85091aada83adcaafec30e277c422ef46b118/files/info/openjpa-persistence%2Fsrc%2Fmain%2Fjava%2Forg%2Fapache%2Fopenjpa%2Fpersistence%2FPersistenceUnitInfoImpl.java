{"sha":"eca6f032271cc7579987cdc0039326f7d27a9639","node_id":"MDQ6QmxvYjIwNjM2NDplY2E2ZjAzMjI3MWNjNzU3OTk4N2NkYzAwMzkzMjZmN2QyN2E5NjM5","size":15789,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/eca6f032271cc7579987cdc0039326f7d27a9639","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2U7CgppbXBv\ncnQgamF2YS5pby5GaWxlOwppbXBvcnQgamF2YS5uZXQuTWFsZm9ybWVkVVJM\nRXhjZXB0aW9uOwppbXBvcnQgamF2YS5uZXQuVVJJU3ludGF4RXhjZXB0aW9u\nOwppbXBvcnQgamF2YS5uZXQuVVJMOwppbXBvcnQgamF2YS5uZXQuVVJMRGVj\nb2RlcjsKaW1wb3J0IGphdmEudXRpbC5BcnJheUxpc3Q7CmltcG9ydCBqYXZh\nLnV0aWwuQ29sbGVjdGlvbnM7CmltcG9ydCBqYXZhLnV0aWwuSGFzaE1hcDsK\naW1wb3J0IGphdmEudXRpbC5MaXN0OwppbXBvcnQgamF2YS51dGlsLk1hcDsK\naW1wb3J0IGphdmEudXRpbC5Qcm9wZXJ0aWVzOwppbXBvcnQgamF2YXgucGVy\nc2lzdGVuY2Uuc3BpLkNsYXNzVHJhbnNmb3JtZXI7CmltcG9ydCBqYXZheC5w\nZXJzaXN0ZW5jZS5zcGkuUGVyc2lzdGVuY2VVbml0SW5mbzsKaW1wb3J0IGph\ndmF4LnBlcnNpc3RlbmNlLnNwaS5QZXJzaXN0ZW5jZVVuaXRUcmFuc2FjdGlv\nblR5cGU7CmltcG9ydCBqYXZheC5zcWwuRGF0YVNvdXJjZTsKCmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEubGliLmNvbmYuQ29uZmlndXJhdGlvbjsKaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIuY29uZi5Db25maWd1cmF0aW9u\nczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIuY29uZi5Qcm9kdWN0\nRGVyaXZhdGlvbnM7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLm1l\ndGEuU291cmNlVHJhY2tlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5s\naWIudXRpbC5Mb2NhbGl6ZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\nbGliLnV0aWwuTXVsdGlDbGFzc0xvYWRlcjsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS5saWIudXRpbC5UZW1wb3JhcnlDbGFzc0xvYWRlcjsKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLkNsYXNzUmVzb2x2ZXI7CgovKioK\nICogSW1wbGVtZW50YXRpb24gb2YgdGhlIHtAbGluayBQZXJzaXN0ZW5jZVVu\naXRJbmZvfSBpbnRlcmZhY2UgdXNlZCBieSBPcGVuSlBBIAogKiB3aGVuIHBh\ncnNpbmcgcGVyc2lzdGVuY2UgY29uZmlndXJhdGlvbiBpbmZvcm1hdGlvbi4K\nICoKICogQG5vamF2YWRvYwogKi8KcHVibGljIGNsYXNzIFBlcnNpc3RlbmNl\nVW5pdEluZm9JbXBsCiAgICBpbXBsZW1lbnRzIFBlcnNpc3RlbmNlVW5pdElu\nZm8sIFNvdXJjZVRyYWNrZXIgewoKICAgIHB1YmxpYyBzdGF0aWMgZmluYWwg\nU3RyaW5nIEtFWV9QUk9WSURFUiA9ICJqYXZheC5wZXJzaXN0ZW5jZS5wcm92\naWRlciI7CgogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgTG9jYWxpemVyIHNf\nbG9jID0gTG9jYWxpemVyLmZvclBhY2thZ2UKICAgICAgICAoUGVyc2lzdGVu\nY2VVbml0SW5mb0ltcGwuY2xhc3MpOwoKICAgIHByaXZhdGUgU3RyaW5nIF9u\nYW1lOwogICAgcHJpdmF0ZSBmaW5hbCBQcm9wZXJ0aWVzIF9wcm9wcyA9IG5l\ndyBQcm9wZXJ0aWVzKCk7CiAgICBwcml2YXRlIFBlcnNpc3RlbmNlVW5pdFRy\nYW5zYWN0aW9uVHlwZSBfdHJhbnNUeXBlID0KICAgICAgICBQZXJzaXN0ZW5j\nZVVuaXRUcmFuc2FjdGlvblR5cGUuUkVTT1VSQ0VfTE9DQUw7CgogICAgcHJp\ndmF0ZSBTdHJpbmcgX3Byb3ZpZGVyQ2xhc3NOYW1lOwogICAgcHJpdmF0ZSBM\naXN0PFN0cmluZz4gX21hcHBpbmdGaWxlTmFtZXM7CiAgICBwcml2YXRlIExp\nc3Q8U3RyaW5nPiBfZW50aXR5Q2xhc3NOYW1lczsKICAgIHByaXZhdGUgTGlz\ndDxVUkw+IF9qYXJGaWxlczsKICAgIHByaXZhdGUgU3RyaW5nIF9qdGFEYXRh\nU291cmNlTmFtZTsKICAgIHByaXZhdGUgRGF0YVNvdXJjZSBfanRhRGF0YVNv\ndXJjZTsKICAgIHByaXZhdGUgU3RyaW5nIF9ub25KdGFEYXRhU291cmNlTmFt\nZTsKICAgIHByaXZhdGUgRGF0YVNvdXJjZSBfbm9uSnRhRGF0YVNvdXJjZTsK\nICAgIHByaXZhdGUgYm9vbGVhbiBfZXhjbHVkZVVubGlzdGVkOwogICAgcHJp\ndmF0ZSBVUkwgX3BlcnNpc3RlbmNlWG1sRmlsZTsKCiAgICAvLyBBIHBlcnNp\nc3RlbmNlIHVuaXQgaXMgZGVmaW5lZCBieSBhIHBlcnNpc3RlbmNlLnhtbCBm\naWxlLiBUaGUgamFyCiAgICAvLyBmaWxlIG9yIGRpcmVjdG9yeSB3aG9zZSBN\nRVRBLUlORiBkaXJlY3RvcnkgY29udGFpbnMgdGhlCiAgICAvLyBwZXJzaXN0\nZW5jZS54bWwgZmlsZSBpcyB0ZXJtZWQgdGhlIHJvb3Qgb2YgdGhlIHBlcnNp\nc3RlbmNlIHVuaXQuCiAgICAvLwogICAgLy8gSW4gSmF2YSBFRSwgdGhlIHJv\nb3Qgb2YgYSBwZXJzaXN0ZW5jZSB1bml0IG1heSBiZSBvbmUgb2YgdGhlIGZv\nbGxvd2luZzoKICAgIC8vIC0gYW4gRUpCLUpBUiBmaWxlCiAgICAvLyAtIHRo\nZSBXRUItSU5GL2NsYXNzZXMgZGlyZWN0b3J5IG9mIGEgV0FSIGZpbGVbMzhd\nCiAgICAvLyAtIGEgamFyIGZpbGUgaW4gdGhlIFdFQi1JTkYvbGliIGRpcmVj\ndG9yeSBvZiBhIFdBUiBmaWxlCiAgICAvLyAtIGEgamFyIGZpbGUgaW4gdGhl\nIHJvb3Qgb2YgdGhlIEVBUgogICAgLy8gLSBhIGphciBmaWxlIGluIHRoZSBF\nQVIgbGlicmFyeSBkaXJlY3RvcnkKICAgIC8vIC0gYW4gYXBwbGljYXRpb24g\nY2xpZW50IGphciBmaWxlCiAgICBwcml2YXRlIFVSTCBfcm9vdDsKCiAgICBw\ndWJsaWMgQ2xhc3NMb2FkZXIgZ2V0Q2xhc3NMb2FkZXIoKSB7CiAgICAgICAg\ncmV0dXJuIG51bGw7CiAgICB9CgogICAgcHVibGljIENsYXNzTG9hZGVyIGdl\ndE5ld1RlbXBDbGFzc0xvYWRlcigpIHsKICAgICAgICByZXR1cm4gbmV3IFRl\nbXBvcmFyeUNsYXNzTG9hZGVyKFRocmVhZC5jdXJyZW50VGhyZWFkKCkuCiAg\nICAgICAgICAgIGdldENvbnRleHRDbGFzc0xvYWRlcigpKTsKICAgIH0KCiAg\nICBwdWJsaWMgU3RyaW5nIGdldFBlcnNpc3RlbmNlVW5pdE5hbWUoKSB7CiAg\nICAgICAgcmV0dXJuIF9uYW1lOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNl\ndFBlcnNpc3RlbmNlVW5pdE5hbWUoU3RyaW5nIGVtTmFtZSkgewogICAgICAg\nIF9uYW1lID0gZW1OYW1lOwogICAgfQoKICAgIHB1YmxpYyBTdHJpbmcgZ2V0\nUGVyc2lzdGVuY2VQcm92aWRlckNsYXNzTmFtZSgpIHsKICAgICAgICByZXR1\ncm4gX3Byb3ZpZGVyQ2xhc3NOYW1lOwogICAgfQoKICAgIHB1YmxpYyB2b2lk\nIHNldFBlcnNpc3RlbmNlUHJvdmlkZXJDbGFzc05hbWUoU3RyaW5nIHByb3Zp\nZGVyQ2xhc3NOYW1lKSB7CiAgICAgICAgX3Byb3ZpZGVyQ2xhc3NOYW1lID0g\ncHJvdmlkZXJDbGFzc05hbWU7CiAgICB9CgogICAgcHVibGljIFBlcnNpc3Rl\nbmNlVW5pdFRyYW5zYWN0aW9uVHlwZSBnZXRUcmFuc2FjdGlvblR5cGUoKSB7\nCiAgICAgICAgcmV0dXJuIF90cmFuc1R5cGU7CiAgICB9CgogICAgcHVibGlj\nIHZvaWQgc2V0VHJhbnNhY3Rpb25UeXBlKFBlcnNpc3RlbmNlVW5pdFRyYW5z\nYWN0aW9uVHlwZSB0cmFuc1R5cGUpIHsKICAgICAgICBfdHJhbnNUeXBlID0g\ndHJhbnNUeXBlOwogICAgfQoKICAgIHB1YmxpYyBTdHJpbmcgZ2V0SnRhRGF0\nYVNvdXJjZU5hbWUoKSB7CiAgICAgICAgcmV0dXJuIF9qdGFEYXRhU291cmNl\nTmFtZTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRKdGFEYXRhU291cmNl\nTmFtZShTdHJpbmcganRhKSB7CiAgICAgICAgX2p0YURhdGFTb3VyY2VOYW1l\nID0ganRhOwogICAgICAgIGlmIChqdGEgIT0gbnVsbCkKICAgICAgICAgICAg\nX2p0YURhdGFTb3VyY2UgPSBudWxsOwogICAgfQoKICAgIHB1YmxpYyBEYXRh\nU291cmNlIGdldEp0YURhdGFTb3VyY2UoKSB7CiAgICAgICAgcmV0dXJuIF9q\ndGFEYXRhU291cmNlOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldEp0YURh\ndGFTb3VyY2UoRGF0YVNvdXJjZSBkcykgewogICAgICAgIF9qdGFEYXRhU291\ncmNlID0gZHM7CiAgICAgICAgaWYgKGRzICE9IG51bGwpCiAgICAgICAgICAg\nIF9qdGFEYXRhU291cmNlTmFtZSA9IG51bGw7CiAgICB9CgogICAgcHVibGlj\nIFN0cmluZyBnZXROb25KdGFEYXRhU291cmNlTmFtZSgpIHsKICAgICAgICBy\nZXR1cm4gX25vbkp0YURhdGFTb3VyY2VOYW1lOwogICAgfQoKICAgIHB1Ymxp\nYyB2b2lkIHNldE5vbkp0YURhdGFTb3VyY2VOYW1lKFN0cmluZyBub25KdGEp\nIHsKICAgICAgICBfbm9uSnRhRGF0YVNvdXJjZU5hbWUgPSBub25KdGE7CiAg\nICAgICAgaWYgKG5vbkp0YSAhPSBudWxsKQogICAgICAgICAgICBfbm9uSnRh\nRGF0YVNvdXJjZSA9IG51bGw7CiAgICB9CgogICAgcHVibGljIERhdGFTb3Vy\nY2UgZ2V0Tm9uSnRhRGF0YVNvdXJjZSgpIHsKICAgICAgICByZXR1cm4gX25v\nbkp0YURhdGFTb3VyY2U7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0Tm9u\nSnRhRGF0YVNvdXJjZShEYXRhU291cmNlIGRzKSB7CiAgICAgICAgX25vbkp0\nYURhdGFTb3VyY2UgPSBkczsKICAgICAgICBpZiAoZHMgIT0gbnVsbCkKICAg\nICAgICAgICAgX25vbkp0YURhdGFTb3VyY2VOYW1lID0gbnVsbDsKICAgIH0K\nCiAgICBwdWJsaWMgVVJMIGdldFBlcnNpc3RlbmNlVW5pdFJvb3RVcmwoKSB7\nCiAgICAgICAgcmV0dXJuIF9yb290OwogICAgfQoKICAgIHB1YmxpYyB2b2lk\nIHNldFBlcnNpc3RlbmNlVW5pdFJvb3RVcmwoVVJMIHJvb3QpIHsKICAgICAg\nICBfcm9vdCA9IHJvb3Q7CiAgICB9CgogICAgcHVibGljIGJvb2xlYW4gZXhj\nbHVkZVVubGlzdGVkQ2xhc3NlcygpIHsKICAgICAgICByZXR1cm4gX2V4Y2x1\nZGVVbmxpc3RlZDsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRFeGNsdWRl\nVW5saXN0ZWRDbGFzc2VzKGJvb2xlYW4gZXhjbHVkZVVubGlzdGVkKSB7CiAg\nICAgICAgX2V4Y2x1ZGVVbmxpc3RlZCA9IGV4Y2x1ZGVVbmxpc3RlZDsKICAg\nIH0KCiAgICBwdWJsaWMgTGlzdDxTdHJpbmc+IGdldE1hcHBpbmdGaWxlTmFt\nZXMoKSB7CiAgICAgICAgcmV0dXJuIChfbWFwcGluZ0ZpbGVOYW1lcyA9PSBu\ndWxsKQogICAgICAgICAgICA/IChMaXN0PFN0cmluZz4pIENvbGxlY3Rpb25z\nLkVNUFRZX0xJU1QgOiBfbWFwcGluZ0ZpbGVOYW1lczsKICAgIH0KCiAgICBw\ndWJsaWMgdm9pZCBhZGRNYXBwaW5nRmlsZU5hbWUoU3RyaW5nIG5hbWUpIHsK\nICAgICAgICBpZiAoX21hcHBpbmdGaWxlTmFtZXMgPT0gbnVsbCkKICAgICAg\nICAgICAgX21hcHBpbmdGaWxlTmFtZXMgPSBuZXcgQXJyYXlMaXN0PFN0cmlu\nZz4oKTsKICAgICAgICBfbWFwcGluZ0ZpbGVOYW1lcy5hZGQobmFtZSk7CiAg\nICB9CgogICAgcHVibGljIExpc3Q8VVJMPiBnZXRKYXJGaWxlVXJscygpIHsK\nICAgICAgICByZXR1cm4gKF9qYXJGaWxlcyA9PSBudWxsKSA/IChMaXN0PFVS\nTD4pIENvbGxlY3Rpb25zLkVNUFRZX0xJU1QgCiAgICAgICAgICAgIDogX2ph\nckZpbGVzOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIGFkZEphckZpbGUoVVJM\nIGphcikgewogICAgICAgIGlmIChfamFyRmlsZXMgPT0gbnVsbCkKICAgICAg\nICAgICAgX2phckZpbGVzID0gbmV3IEFycmF5TGlzdDxVUkw+KCk7CiAgICAg\nICAgX2phckZpbGVzLmFkZChqYXIpOwogICAgfQoKICAgIHB1YmxpYyB2b2lk\nIGFkZEphckZpbGVOYW1lKFN0cmluZyBuYW1lKSB7CiAgICAgICAgTXVsdGlD\nbGFzc0xvYWRlciBsb2FkZXIgPSBuZXcgTXVsdGlDbGFzc0xvYWRlcigpOwog\nICAgICAgIGxvYWRlci5hZGRDbGFzc0xvYWRlcihnZXRDbGFzcygpLmdldENs\nYXNzTG9hZGVyKCkpOwogICAgICAgIGxvYWRlci5hZGRDbGFzc0xvYWRlcihN\ndWx0aUNsYXNzTG9hZGVyLlRIUkVBRF9MT0FERVIpOwogICAgICAgIFVSTCB1\ncmwgPSBsb2FkZXIuZ2V0UmVzb3VyY2UobmFtZSk7CiAgICAgICAgaWYgKHVy\nbCAhPSBudWxsKSB7CiAgICAgICAgICAgIGFkZEphckZpbGUodXJsKTsKICAg\nICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgLy8gamFyIGZp\nbGUgaXMgbm90IGEgcmVzb3VyY2U7IGNoZWNrIGNsYXNzcGF0aAogICAgICAg\nIFN0cmluZ1tdIGNwID0gU3lzdGVtLmdldFByb3BlcnR5KCJqYXZhLmNsYXNz\nLnBhdGgiKS4KICAgICAgICAgICAgc3BsaXQoU3lzdGVtLmdldFByb3BlcnR5\nKCJwYXRoLnNlcGFyYXRvciIpKTsKICAgICAgICBmb3IgKGludCBpID0gMDsg\naSA8IGNwLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGlmIChjcFtpXS5l\ncXVhbHMobmFtZSkKICAgICAgICAgICAgICAgIHx8IGNwW2ldLmVuZHNXaXRo\nKEZpbGUuc2VwYXJhdG9yQ2hhciArIG5hbWUpKSB7CiAgICAgICAgICAgICAg\nICB0cnkgewogICAgICAgICAgICAgICAgICAgIGFkZEphckZpbGUobmV3IEZp\nbGUoY3BbaV0pLnRvVVJMKCkpOwogICAgICAgICAgICAgICAgICAgIHJldHVy\nbjsKICAgICAgICAgICAgICAgIH0gY2F0Y2ggKE1hbGZvcm1lZFVSTEV4Y2Vw\ndGlvbiBtdWUpIHsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAg\nICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICB0\naHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uKHNfbG9jLmdldCgi\nYmFkLWphci1uYW1lIiwgbmFtZSkuCiAgICAgICAgICAgIGdldE1lc3NhZ2Uo\nKSk7CiAgICB9CgogICAgcHVibGljIExpc3Q8U3RyaW5nPiBnZXRNYW5hZ2Vk\nQ2xhc3NOYW1lcygpIHsKICAgICAgICByZXR1cm4gKF9lbnRpdHlDbGFzc05h\nbWVzID09IG51bGwpCiAgICAgICAgICAgID8gKExpc3Q8U3RyaW5nPikgQ29s\nbGVjdGlvbnMuRU1QVFlfTElTVCA6IF9lbnRpdHlDbGFzc05hbWVzOwogICAg\nfQoKICAgIHB1YmxpYyB2b2lkIGFkZE1hbmFnZWRDbGFzc05hbWUoU3RyaW5n\nIG5hbWUpIHsKICAgICAgICBpZiAoX2VudGl0eUNsYXNzTmFtZXMgPT0gbnVs\nbCkKICAgICAgICAgICAgX2VudGl0eUNsYXNzTmFtZXMgPSBuZXcgQXJyYXlM\naXN0PFN0cmluZz4oKTsKICAgICAgICBfZW50aXR5Q2xhc3NOYW1lcy5hZGQo\nbmFtZSk7CiAgICB9CgogICAgcHVibGljIFByb3BlcnRpZXMgZ2V0UHJvcGVy\ndGllcygpIHsKICAgICAgICByZXR1cm4gX3Byb3BzOwogICAgfQoKICAgIHB1\nYmxpYyB2b2lkIHNldFByb3BlcnR5KFN0cmluZyBrZXksIFN0cmluZyB2YWx1\nZSkgewogICAgICAgIF9wcm9wcy5zZXRQcm9wZXJ0eShrZXksIHZhbHVlKTsK\nICAgIH0KCiAgICBwdWJsaWMgdm9pZCBhZGRUcmFuc2Zvcm1lcihDbGFzc1Ry\nYW5zZm9ybWVyIHRyYW5zZm9ybWVyKSB7CiAgICAgICAgdGhyb3cgbmV3IFVu\nc3VwcG9ydGVkT3BlcmF0aW9uRXhjZXB0aW9uKCk7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBUaGUgbG9jYXRpb24gb2YgdGhlIHBlcnNpc3RlbmNlLnhtbCBy\nZXNvdXJjZS4gTWF5IGJlIG51bGwuCiAgICAgKi8KICAgIHB1YmxpYyBVUkwg\nZ2V0UGVyc2lzdGVuY2VYbWxGaWxlVXJsKCkgewogICAgICAgIHJldHVybiBf\ncGVyc2lzdGVuY2VYbWxGaWxlOwogICAgfQoKICAgIC8qKgogICAgICogVGhl\nIGxvY2F0aW9uIG9mIHRoZSBwZXJzaXN0ZW5jZS54bWwgcmVzb3VyY2UuIE1h\neSBiZSBudWxsLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRQZXJzaXN0\nZW5jZVhtbEZpbGVVcmwoVVJMIHVybCkgewogICAgICAgIF9wZXJzaXN0ZW5j\nZVhtbEZpbGUgPSB1cmw7CiAgICB9CgogICAgLyoqCiAgICAgKiBMb2FkIHRo\nZSBnaXZlbiB1c2VyLXN1cHBsaWVkIG1hcCBvZiBwcm9wZXJ0aWVzIGludG8g\ndGhpcyBwZXJzaXN0ZW5jZQogICAgICogdW5pdC4KICAgICAqLwogICAgcHVi\nbGljIHZvaWQgZnJvbVVzZXJQcm9wZXJ0aWVzKE1hcCBtYXApIHsKICAgICAg\nICBpZiAobWFwID09IG51bGwpCiAgICAgICAgICAgIHJldHVybjsKCiAgICAg\nICAgT2JqZWN0IGtleTsKICAgICAgICBPYmplY3QgdmFsOwogICAgICAgIGZv\nciAoT2JqZWN0IG8gOiBtYXAuZW50cnlTZXQoKSkgewogICAgICAgICAgICBr\nZXkgPSAoKE1hcC5FbnRyeSkgbykuZ2V0S2V5KCk7CiAgICAgICAgICAgIHZh\nbCA9ICgoTWFwLkVudHJ5KSBvKS5nZXRWYWx1ZSgpOwogICAgICAgICAgICBp\nZiAoS0VZX1BST1ZJREVSLmVxdWFscyhrZXkpKQogICAgICAgICAgICAgICAg\nc2V0UGVyc2lzdGVuY2VQcm92aWRlckNsYXNzTmFtZSgoU3RyaW5nKSB2YWwp\nOwogICAgICAgICAgICBlbHNlIGlmICgiamF2YXgucGVyc2lzdGVuY2UudHJh\nbnNhY3Rpb25UeXBlIi5lcXVhbHMoa2V5KSkgewogICAgICAgICAgICAgICAg\nUGVyc2lzdGVuY2VVbml0VHJhbnNhY3Rpb25UeXBlIHR0eXBlOwogICAgICAg\nICAgICAgICAgaWYgKHZhbCBpbnN0YW5jZW9mIFN0cmluZykKICAgICAgICAg\nICAgICAgICAgICB0dHlwZSA9IEVudW0udmFsdWVPZihQZXJzaXN0ZW5jZVVu\naXRUcmFuc2FjdGlvblR5cGUuY2xhc3MsIAogICAgICAgICAgICAgICAgICAg\nICAgICAoU3RyaW5nKSB2YWwpOwogICAgICAgICAgICAgICAgZWxzZQogICAg\nICAgICAgICAgICAgICAgIHR0eXBlID0gKFBlcnNpc3RlbmNlVW5pdFRyYW5z\nYWN0aW9uVHlwZSkgdmFsOwogICAgICAgICAgICAgICAgc2V0VHJhbnNhY3Rp\nb25UeXBlKHR0eXBlKTsKICAgICAgICAgICAgfSBlbHNlIGlmICgiamF2YXgu\ncGVyc2lzdGVuY2UuanRhRGF0YVNvdXJjZSIuZXF1YWxzKGtleSkpIHsKICAg\nICAgICAgICAgICAgIGlmICh2YWwgaW5zdGFuY2VvZiBTdHJpbmcpCiAgICAg\nICAgICAgICAgICAgICAgc2V0SnRhRGF0YVNvdXJjZU5hbWUoKFN0cmluZykg\ndmFsKTsKICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAg\nICBzZXRKdGFEYXRhU291cmNlKChEYXRhU291cmNlKSB2YWwpOwogICAgICAg\nICAgICB9IGVsc2UgaWYgKCJqYXZheC5wZXJzaXN0ZW5jZS5ub25KdGFEYXRh\nU291cmNlIi5lcXVhbHMoa2V5KSkgewogICAgICAgICAgICAgICAgaWYgKHZh\nbCBpbnN0YW5jZW9mIFN0cmluZykKICAgICAgICAgICAgICAgICAgICBzZXRO\nb25KdGFEYXRhU291cmNlTmFtZSgoU3RyaW5nKSB2YWwpOwogICAgICAgICAg\nICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgIHNldE5vbkp0YURhdGFT\nb3VyY2UoKERhdGFTb3VyY2UpIHZhbCk7CiAgICAgICAgICAgIH0gZWxzZQog\nICAgICAgICAgICAgICAgX3Byb3BzLnB1dChrZXksIHZhbCk7CiAgICAgICAg\nfQogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIGEge0BsaW5rIE1hcH0g\nY29udGFpbmluZyB0aGUgcHJvcGVydGllcyBuZWNlc3NhcnkgdG8gY3JlYXRl\nCiAgICAgKiBhIHtAbGluayBDb25maWd1cmF0aW9ufSB0aGF0IHJlZmxlY3Rz\nIHRoZSBpbmZvcm1hdGlvbiBpbiB0aGlzCiAgICAgKiBwZXJzaXN0ZW5jZSB1\nbml0IGluZm8uCiAgICAgKi8KICAgIHB1YmxpYyBNYXAgdG9PcGVuSlBBUHJv\ncGVydGllcygpIHsKICAgICAgICByZXR1cm4gdG9PcGVuSlBBUHJvcGVydGll\ncyh0aGlzKTsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiBhIHtAbGlu\nayBNYXB9IGNvbnRhaW5pbmcgdGhlIHByb3BlcnRpZXMgbmVjZXNzYXJ5IHRv\nIGNyZWF0ZQogICAgICogYSB7QGxpbmsgQ29uZmlndXJhdGlvbn0gdGhhdCBy\nZWZsZWN0cyB0aGUgaW5mb3JtYXRpb24gaW4gdGhlIGdpdmVuCiAgICAgKiBw\nZXJzaXN0ZW5jZSB1bml0IGluZm8uCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0\naWMgTWFwIHRvT3BlbkpQQVByb3BlcnRpZXMoUGVyc2lzdGVuY2VVbml0SW5m\nbyBpbmZvKSB7CiAgICAgICAgTWFwIG1hcCA9IG5ldyBIYXNoTWFwKCk7CiAg\nICAgICAgaWYgKGluZm8uZ2V0VHJhbnNhY3Rpb25UeXBlKCkgPT0gUGVyc2lz\ndGVuY2VVbml0VHJhbnNhY3Rpb25UeXBlLkpUQSkKICAgICAgICAgICAgbWFw\nLnB1dCgib3BlbmpwYS5UcmFuc2FjdGlvbk1vZGUiLCAibWFuYWdlZCIpOwoK\nICAgICAgICBib29sZWFuIGhhc0p0YSA9IGZhbHNlOwogICAgICAgIERhdGFT\nb3VyY2UgZHMgPSBpbmZvLmdldEp0YURhdGFTb3VyY2UoKTsKICAgICAgICBp\nZiAoZHMgIT0gbnVsbCkgewogICAgICAgICAgICBtYXAucHV0KCJvcGVuanBh\nLkNvbm5lY3Rpb25GYWN0b3J5IiwgZHMpOwogICAgICAgICAgICBtYXAucHV0\nKCJvcGVuanBhLkNvbm5lY3Rpb25GYWN0b3J5TW9kZSIsICJtYW5hZ2VkIik7\nCiAgICAgICAgICAgIGhhc0p0YSA9IHRydWU7CiAgICAgICAgfSBlbHNlIGlm\nIChpbmZvIGluc3RhbmNlb2YgUGVyc2lzdGVuY2VVbml0SW5mb0ltcGwKICAg\nICAgICAgICAgJiYgKChQZXJzaXN0ZW5jZVVuaXRJbmZvSW1wbCkgaW5mbyku\nZ2V0SnRhRGF0YVNvdXJjZU5hbWUoKSAhPSBudWxsKXsKICAgICAgICAgICAg\nbWFwLnB1dCgib3BlbmpwYS5Db25uZWN0aW9uRmFjdG9yeU5hbWUiLCAoKFBl\ncnNpc3RlbmNlVW5pdEluZm9JbXBsKQogICAgICAgICAgICAgICAgaW5mbyku\nZ2V0SnRhRGF0YVNvdXJjZU5hbWUoKSk7CiAgICAgICAgICAgIG1hcC5wdXQo\nIm9wZW5qcGEuQ29ubmVjdGlvbkZhY3RvcnlNb2RlIiwgIm1hbmFnZWQiKTsK\nICAgICAgICAgICAgaGFzSnRhID0gdHJ1ZTsKICAgICAgICB9CgogICAgICAg\nIGRzID0gaW5mby5nZXROb25KdGFEYXRhU291cmNlKCk7CiAgICAgICAgaWYg\nKGRzICE9IG51bGwpIHsKICAgICAgICAgICAgaWYgKCFoYXNKdGEpCiAgICAg\nICAgICAgICAgICBtYXAucHV0KCJvcGVuanBhLkNvbm5lY3Rpb25GYWN0b3J5\nIiwgZHMpOwogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICBtYXAu\ncHV0KCJvcGVuanBhLkNvbm5lY3Rpb25GYWN0b3J5MiIsIGRzKTsKICAgICAg\nICB9IGVsc2UgaWYgKGluZm8gaW5zdGFuY2VvZiBQZXJzaXN0ZW5jZVVuaXRJ\nbmZvSW1wbAogICAgICAgICAgICAmJiAoKFBlcnNpc3RlbmNlVW5pdEluZm9J\nbXBsKSBpbmZvKS5nZXROb25KdGFEYXRhU291cmNlTmFtZSgpCiAgICAgICAg\nICAgICE9IG51bGwpIHsKICAgICAgICAgICAgU3RyaW5nIG5vbkp0YU5hbWUg\nPSAoKFBlcnNpc3RlbmNlVW5pdEluZm9JbXBsKSBpbmZvKS4KICAgICAgICAg\nICAgICAgIGdldE5vbkp0YURhdGFTb3VyY2VOYW1lKCk7CiAgICAgICAgICAg\nIGlmICghaGFzSnRhKQogICAgICAgICAgICAgICAgbWFwLnB1dCgib3Blbmpw\nYS5Db25uZWN0aW9uRmFjdG9yeU5hbWUiLCBub25KdGFOYW1lKTsKICAgICAg\nICAgICAgZWxzZQogICAgICAgICAgICAgICAgbWFwLnB1dCgib3BlbmpwYS5D\nb25uZWN0aW9uRmFjdG9yeTJOYW1lIiwgbm9uSnRhTmFtZSk7CiAgICAgICAg\nfQoKICAgICAgICBpZiAoaW5mby5nZXRDbGFzc0xvYWRlcigpICE9IG51bGwp\nCiAgICAgICAgICAgIG1hcC5wdXQoIm9wZW5qcGEuQ2xhc3NSZXNvbHZlciIs\nIG5ldyBDbGFzc1Jlc29sdmVySW1wbAogICAgICAgICAgICAgICAgKGluZm8u\nZ2V0Q2xhc3NMb2FkZXIoKSkpOwoKICAgICAgICBQcm9wZXJ0aWVzIHByb3Bz\nID0gaW5mby5nZXRQcm9wZXJ0aWVzKCk7CiAgICAgICAgaWYgKHByb3BzICE9\nIG51bGwpIHsKICAgICAgICAgICAgbWFwLnB1dEFsbChwcm9wcyk7CiAgICAg\nICAgICAgIC8vIHRoaXMgaXNuJ3QgYSByZWFsIGNvbmZpZyBwcm9wZXJ0eTsg\ncmVtb3ZlIGl0CiAgICAgICAgICAgIG1hcC5yZW1vdmUoUGVyc2lzdGVuY2VQ\ncm92aWRlckltcGwuQ0xBU1NfVFJBTlNGT1JNRVJfT1BUSU9OUyk7CiAgICAg\nICAgfQoKICAgICAgICBpZiAoIW1hcC5jb250YWluc0tleSgib3BlbmpwYS5J\nZCIpKQogICAgICAgICAgICBtYXAucHV0KCJvcGVuanBhLklkIiwgaW5mby5n\nZXRQZXJzaXN0ZW5jZVVuaXROYW1lKCkpOwogICAgICAgIAogICAgICAgIFBy\nb3BlcnRpZXMgbWV0YUZhY3RvcnlQcm9wcyA9IG5ldyBQcm9wZXJ0aWVzKCk7\nCiAgICAgICAgaWYgKGluZm8uZ2V0TWFuYWdlZENsYXNzTmFtZXMoKSAhPSBu\ndWxsIAogICAgICAgICAgICAmJiAhaW5mby5nZXRNYW5hZ2VkQ2xhc3NOYW1l\ncygpLmlzRW1wdHkoKSkgewogICAgICAgICAgICBTdHJpbmdCdWZmZXIgdHlw\nZXMgPSBuZXcgU3RyaW5nQnVmZmVyKCk7CiAgICAgICAgICAgIGZvciAoU3Ry\naW5nIHR5cGUgOiBpbmZvLmdldE1hbmFnZWRDbGFzc05hbWVzKCkpIHsKICAg\nICAgICAgICAgICAgIGlmICh0eXBlcy5sZW5ndGgoKSA+IDApCiAgICAgICAg\nICAgICAgICAgICAgdHlwZXMuYXBwZW5kKCc7Jyk7CiAgICAgICAgICAgICAg\nICB0eXBlcy5hcHBlbmQodHlwZSk7CiAgICAgICAgICAgIH0KICAgICAgICAg\nICAgbWV0YUZhY3RvcnlQcm9wcy5wdXQoIlR5cGVzIiwgdHlwZXMudG9TdHJp\nbmcoKSk7CiAgICAgICAgfQogICAgICAgIGlmIChpbmZvLmdldEphckZpbGVV\ncmxzKCkgIT0gbnVsbCAmJiAhaW5mby5nZXRKYXJGaWxlVXJscygpLmlzRW1w\ndHkoKQogICAgICAgICAgICB8fCAoIWluZm8uZXhjbHVkZVVubGlzdGVkQ2xh\nc3NlcygpCiAgICAgICAgICAgICYmIGluZm8uZ2V0UGVyc2lzdGVuY2VVbml0\nUm9vdFVybCgpICE9IG51bGwpKSB7CiAgICAgICAgICAgIFN0cmluZ0J1ZmZl\nciBqYXJzID0gbmV3IFN0cmluZ0J1ZmZlcigpOwogICAgICAgICAgICBTdHJp\nbmcgZmlsZSA9IG51bGw7CiAgICAgICAgICAgIGlmICghaW5mby5leGNsdWRl\nVW5saXN0ZWRDbGFzc2VzKCkKICAgICAgICAgICAgICAgICYmIGluZm8uZ2V0\nUGVyc2lzdGVuY2VVbml0Um9vdFVybCgpICE9IG51bGwpIHsKICAgICAgICAg\nICAgICAgIFVSTCB1cmwgPSBpbmZvLmdldFBlcnNpc3RlbmNlVW5pdFJvb3RV\ncmwoKTsKICAgICAgICAgICAgICAgIGlmICgiZmlsZSIuZXF1YWxzKHVybC5n\nZXRQcm90b2NvbCgpKSkgLy8gZXhwbG9kZWQgamFyPwogICAgICAgICAgICAg\nICAgICAgIGZpbGUgPSBVUkxEZWNvZGVyLmRlY29kZSh1cmwuZ2V0UGF0aCgp\nKTsKICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICBq\nYXJzLmFwcGVuZCh1cmwpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZv\nciAoVVJMIGphciA6IGluZm8uZ2V0SmFyRmlsZVVybHMoKSkgewogICAgICAg\nICAgICAgICAgaWYgKGphcnMubGVuZ3RoKCkgPiAwKQogICAgICAgICAgICAg\nICAgICAgIGphcnMuYXBwZW5kKCc7Jyk7CiAgICAgICAgICAgICAgICBqYXJz\nLmFwcGVuZChqYXIpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmIChm\naWxlICE9IG51bGwpCiAgICAgICAgICAgICAgICBtZXRhRmFjdG9yeVByb3Bz\nLnB1dCgiRmlsZXMiLCBmaWxlKTsKICAgICAgICAgICAgaWYgKGphcnMubGVu\nZ3RoKCkgIT0gMCkKICAgICAgICAgICAgICAgIG1ldGFGYWN0b3J5UHJvcHMu\ncHV0KCJVUkxzIiwgamFycy50b1N0cmluZygpKTsKICAgICAgICB9CiAgICAg\nICAgaWYgKGluZm8uZ2V0TWFwcGluZ0ZpbGVOYW1lcygpICE9IG51bGwKICAg\nICAgICAgICAgJiYgIWluZm8uZ2V0TWFwcGluZ0ZpbGVOYW1lcygpLmlzRW1w\ndHkoKSkgewogICAgICAgICAgICBTdHJpbmdCdWZmZXIgcnNyY3MgPSBuZXcg\nU3RyaW5nQnVmZmVyKCk7CiAgICAgICAgICAgIGZvciAoU3RyaW5nIHJzcmMg\nOiBpbmZvLmdldE1hcHBpbmdGaWxlTmFtZXMoKSkgewogICAgICAgICAgICAg\nICAgaWYgKHJzcmNzLmxlbmd0aCgpID4gMCkKICAgICAgICAgICAgICAgICAg\nICByc3Jjcy5hcHBlbmQoJzsnKTsKICAgICAgICAgICAgICAgIHJzcmNzLmFw\ncGVuZChyc3JjKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBtZXRhRmFj\ndG9yeVByb3BzLnB1dCgiUmVzb3VyY2VzIiwgcnNyY3MudG9TdHJpbmcoKSk7\nCiAgICAgICAgfQoKICAgICAgICAvLyBzZXQgcGVyc2lzdGVudCBjbGFzcyBs\nb2NhdGlvbnMgYXMgcHJvcGVydGllcyBvZiBtZXRhZGF0YSBmYWN0b3J5LAog\nICAgICAgIC8vIGNvbWJpbmluZyB0aGVtIHdpdGggYW55IGV4aXN0aW5nIG1l\ndGFkYXRhIGZhY3RvcnkgcHJvcHMKICAgICAgICBpZiAoIW1ldGFGYWN0b3J5\nUHJvcHMuaXNFbXB0eSgpKSB7CiAgICAgICAgICAgIFN0cmluZyBrZXkgPSBQ\ncm9kdWN0RGVyaXZhdGlvbnMuZ2V0Q29uZmlndXJhdGlvbktleQogICAgICAg\nICAgICAgICAgKCJNZXRhRGF0YUZhY3RvcnkiLCBtYXApOwogICAgICAgICAg\nICBtYXAucHV0KGtleSwgQ29uZmlndXJhdGlvbnMuY29tYmluZVBsdWdpbnMo\nKFN0cmluZykgbWFwLmdldChrZXkpLAogICAgICAgICAgICAgICAgQ29uZmln\ndXJhdGlvbnMuc2VyaWFsaXplUHJvcGVydGllcyhtZXRhRmFjdG9yeVByb3Bz\nKSkpOwogICAgICAgIH0KICAgICAgICAKICAgICAgICAvLyBhbHdheXMgcmVj\nb3JkIHByb3ZpZGVyIG5hbWUgZm9yIHByb2R1Y3QgZGVyaXZhdGlvbnMgdG8g\nYWNjZXNzCiAgICAgICAgaWYgKGluZm8uZ2V0UGVyc2lzdGVuY2VQcm92aWRl\nckNsYXNzTmFtZSgpICE9IG51bGwpCiAgICAgICAgICAgIG1hcC5wdXQoS0VZ\nX1BST1ZJREVSLCBpbmZvLmdldFBlcnNpc3RlbmNlUHJvdmlkZXJDbGFzc05h\nbWUoKSk7CiAgICAgICAgcmV0dXJuIG1hcDsKICAgIH0KCiAgICAvLyAtLS0t\nLS0tLS0tLS0tLS0tLS0tLQoKICAgIHB1YmxpYyBGaWxlIGdldFNvdXJjZUZp\nbGUoKSB7CiAgICAgICAgaWYgKF9wZXJzaXN0ZW5jZVhtbEZpbGUgPT0gbnVs\nbCkKICAgICAgICAgICAgcmV0dXJuIG51bGw7CgogICAgICAgIHRyeSB7CiAg\nICAgICAgICAgIHJldHVybiBuZXcgRmlsZShfcGVyc2lzdGVuY2VYbWxGaWxl\nLnRvVVJJKCkpOwogICAgICAgIH0gY2F0Y2ggKFVSSVN5bnRheEV4Y2VwdGlv\nbiBlKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsU3RhdGVFeGNl\ncHRpb24oZSk7CiAgICAgICAgfQogICAgfQoKICAgIHB1YmxpYyBPYmplY3Qg\nZ2V0U291cmNlU2NvcGUoKSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICB9\nCgogICAgcHVibGljIGludCBnZXRTb3VyY2VUeXBlKCkgewogICAgICAgIHJl\ndHVybiBTUkNfWE1MOwogICAgfQoKICAgIHB1YmxpYyBTdHJpbmcgZ2V0UmVz\nb3VyY2VOYW1lKCkgewogICAgICAgIHJldHVybiAiUGVyc2lzdGVuY2VVbml0\nSW5mbzoiICsgX25hbWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBTaW1wbGUg\nY2xhc3MgcmVzb2x2ZXIgYnVpbHQgYXJvdW5kIHRoZSBwZXJzaXN0ZW5jZSB1\nbml0IGxvYWRlci4KICAgICAqLwogICAgcHJpdmF0ZSBzdGF0aWMgY2xhc3Mg\nQ2xhc3NSZXNvbHZlckltcGwKICAgICAgICBpbXBsZW1lbnRzIENsYXNzUmVz\nb2x2ZXIgewoKICAgICAgICBwcml2YXRlIGZpbmFsIENsYXNzTG9hZGVyIF9s\nb2FkZXI7CgogICAgICAgIHB1YmxpYyBDbGFzc1Jlc29sdmVySW1wbChDbGFz\nc0xvYWRlciBsb2FkZXIpIHsKICAgICAgICAgICAgX2xvYWRlciA9IGxvYWRl\ncjsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBDbGFzc0xvYWRlciBnZXRD\nbGFzc0xvYWRlcihDbGFzcyBjdHgsIENsYXNzTG9hZGVyIGVudikgewogICAg\nICAgICAgICByZXR1cm4gX2xvYWRlcjsKICAgICAgICB9Cgl9Cn0K\n","encoding":"base64"}

