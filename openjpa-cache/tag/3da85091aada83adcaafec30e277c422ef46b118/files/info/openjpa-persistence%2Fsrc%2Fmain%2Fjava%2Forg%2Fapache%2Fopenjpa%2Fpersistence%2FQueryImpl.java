{"sha":"f59120be4901cb2eaa9f6228a89d824a838e2689","node_id":"MDQ6QmxvYjIwNjM2NDpmNTkxMjBiZTQ5MDFjYjJlYWE5ZjYyMjhhODlkODI0YTgzOGUyNjg5","size":18349,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/f59120be4901cb2eaa9f6228a89d824a838e2689","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2U7CgppbXBv\ncnQgamF2YS5pby5TZXJpYWxpemFibGU7CmltcG9ydCBqYXZhLnV0aWwuQXJy\nYXlMaXN0OwppbXBvcnQgamF2YS51dGlsLkNhbGVuZGFyOwppbXBvcnQgamF2\nYS51dGlsLkNvbGxlY3Rpb247CmltcG9ydCBqYXZhLnV0aWwuQ29sbGVjdGlv\nbnM7CmltcG9ydCBqYXZhLnV0aWwuRGF0ZTsKaW1wb3J0IGphdmEudXRpbC5I\nYXNoTWFwOwppbXBvcnQgamF2YS51dGlsLkl0ZXJhdG9yOwppbXBvcnQgamF2\nYS51dGlsLkxpc3Q7CmltcG9ydCBqYXZhLnV0aWwuTWFwOwppbXBvcnQgamF2\nYS51dGlsLlNldDsKaW1wb3J0IGphdmEubGFuZy5yZWZsZWN0Lk1ldGhvZDsK\naW1wb3J0IGphdmF4LnBlcnNpc3RlbmNlLkZsdXNoTW9kZVR5cGU7CmltcG9y\ndCBqYXZheC5wZXJzaXN0ZW5jZS5RdWVyeTsKaW1wb3J0IGphdmF4LnBlcnNp\nc3RlbmNlLlRlbXBvcmFsVHlwZTsKCmltcG9ydCBvcmcuYXBhY2hlLmNvbW1v\nbnMuY29sbGVjdGlvbnMubWFwLkxpbmtlZE1hcDsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5rZXJuZWwuRGVsZWdhdGluZ1F1ZXJ5OwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5EZWxlZ2F0aW5nUmVzdWx0TGlzdDsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuRmlsdGVyczsKaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuZXhwcy5BZ2dyZWdhdGVM\naXN0ZW5lcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuZXhw\ncy5GaWx0ZXJMaXN0ZW5lcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5s\naWIucm9wLlJlc3VsdExpc3Q7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\nbGliLnV0aWwuTG9jYWxpemVyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLmVuaGFuY2UuUmVmbGVjdGlvbjsKCi8qKgogKiBJbXBsZW1lbnRhdGlvbiBv\nZiB7QGxpbmsgUXVlcnl9IGludGVyZmFjZS4KICoKICogQGF1dGhvciBNYXJj\nIFBydWQnaG9tbWVhdXgKICogQGF1dGhvciBBYmUgV2hpdGUKICogQG5vamF2\nYWRvYwogKi8KcHVibGljIGNsYXNzIFF1ZXJ5SW1wbAogICAgaW1wbGVtZW50\ncyBPcGVuSlBBUXVlcnksIFNlcmlhbGl6YWJsZSB7CgogICAgcHJpdmF0ZSBz\ndGF0aWMgZmluYWwgT2JqZWN0W10gRU1QVFlfQVJSQVkgPSBuZXcgT2JqZWN0\nWzBdOwoKICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIExvY2FsaXplciBfbG9j\nID0gTG9jYWxpemVyLmZvclBhY2thZ2UKICAgICAgICAoUXVlcnlJbXBsLmNs\nYXNzKTsKCiAgICBwcml2YXRlIGZpbmFsIERlbGVnYXRpbmdRdWVyeSBfcXVl\ncnk7CiAgICBwcml2YXRlIHRyYW5zaWVudCBFbnRpdHlNYW5hZ2VySW1wbCBf\nZW07CiAgICBwcml2YXRlIHRyYW5zaWVudCBGZXRjaFBsYW4gX2ZldGNoOwoK\nICAgIHByaXZhdGUgTWFwIF9uYW1lZDsKICAgIHByaXZhdGUgTGlzdCBfcG9z\naXRpb25hbDsKCiAgICAvKioKICAgICAqIENvbnN0cnVjdG9yOyBzdXBwbHkg\nZmFjdG9yeSBhbmQgZGVsZWdhdGUuCiAgICAgKi8KICAgIHB1YmxpYyBRdWVy\neUltcGwoRW50aXR5TWFuYWdlckltcGwgZW0sCiAgICAgICAgb3JnLmFwYWNo\nZS5vcGVuanBhLmtlcm5lbC5RdWVyeSBxdWVyeSkgewogICAgICAgIF9lbSA9\nIGVtOwogICAgICAgIF9xdWVyeSA9IG5ldyBEZWxlZ2F0aW5nUXVlcnkocXVl\ncnksCiAgICAgICAgICAgIFBlcnNpc3RlbmNlRXhjZXB0aW9ucy5nZXRSb2xs\nYmFja1RyYW5zbGF0b3IoZW0pKTsKICAgIH0KCiAgICAvKioKICAgICAqIERl\nbGVnYXRlLgogICAgICovCiAgICBwdWJsaWMgb3JnLmFwYWNoZS5vcGVuanBh\nLmtlcm5lbC5RdWVyeSBnZXREZWxlZ2F0ZSgpIHsKICAgICAgICByZXR1cm4g\nX3F1ZXJ5LmdldERlbGVnYXRlKCk7CiAgICB9CgogICAgcHVibGljIE9wZW5K\nUEFFbnRpdHlNYW5hZ2VyIGdldEVudGl0eU1hbmFnZXIoKSB7CiAgICAgICAg\ncmV0dXJuIF9lbTsKICAgIH0KCiAgICBwdWJsaWMgU3RyaW5nIGdldExhbmd1\nYWdlKCkgewogICAgICAgIHJldHVybiBfcXVlcnkuZ2V0TGFuZ3VhZ2UoKTsK\nICAgIH0KCiAgICBwdWJsaWMgaW50IGdldE9wZXJhdGlvbigpIHsKICAgICAg\nICByZXR1cm4gX3F1ZXJ5LmdldE9wZXJhdGlvbigpOwogICAgfQoKICAgIHB1\nYmxpYyBGZXRjaFBsYW4gZ2V0RmV0Y2hQbGFuKCkgewogICAgICAgIF9lbS5h\nc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICBfcXVlcnkuYXNzZXJ0\nTm90U2VyaWFsaXplZCgpOwogICAgICAgIF9xdWVyeS5sb2NrKCk7CiAgICAg\nICAgdHJ5IHsKICAgICAgICAgICAgaWYgKF9mZXRjaCA9PSBudWxsKQogICAg\nICAgICAgICAgICAgX2ZldGNoID0gKChFbnRpdHlNYW5hZ2VyRmFjdG9yeUlt\ncGwpIF9lbS4KICAgICAgICAgICAgICAgICAgICBnZXRFbnRpdHlNYW5hZ2Vy\nRmFjdG9yeSgpKS50b0ZldGNoUGxhbihfcXVlcnkuZ2V0QnJva2VyKCksCiAg\nICAgICAgICAgICAgICAgICAgX3F1ZXJ5LmdldEZldGNoQ29uZmlndXJhdGlv\nbigpKTsKICAgICAgICAgICAgcmV0dXJuIF9mZXRjaDsKICAgICAgICB9IGZp\nbmFsbHkgewogICAgICAgICAgICBfcXVlcnkudW5sb2NrKCk7CiAgICAgICAg\nfQogICAgfQoKICAgIHB1YmxpYyBTdHJpbmcgZ2V0UXVlcnlTdHJpbmcoKSB7\nCiAgICAgICAgcmV0dXJuIF9xdWVyeS5nZXRRdWVyeVN0cmluZygpOwogICAg\nfQoKICAgIHB1YmxpYyBib29sZWFuIGdldElnbm9yZUNoYW5nZXMoKSB7CiAg\nICAgICAgcmV0dXJuIF9xdWVyeS5nZXRJZ25vcmVDaGFuZ2VzKCk7CiAgICB9\nCgogICAgcHVibGljIE9wZW5KUEFRdWVyeSBzZXRJZ25vcmVDaGFuZ2VzKGJv\nb2xlYW4gaWdub3JlKSB7CiAgICAgICAgX2VtLmFzc2VydE5vdENsb3NlSW52\nb2tlZCgpOwogICAgICAgIF9xdWVyeS5zZXRJZ25vcmVDaGFuZ2VzKGlnbm9y\nZSk7CiAgICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CgogICAgcHVibGljIE9w\nZW5KUEFRdWVyeSBhZGRGaWx0ZXJMaXN0ZW5lcihGaWx0ZXJMaXN0ZW5lciBs\naXN0ZW5lcikgewogICAgICAgIF9lbS5hc3NlcnROb3RDbG9zZUludm9rZWQo\nKTsKICAgICAgICBfcXVlcnkuYWRkRmlsdGVyTGlzdGVuZXIobGlzdGVuZXIp\nOwogICAgICAgIHJldHVybiB0aGlzOwogICAgfQoKICAgIHB1YmxpYyBPcGVu\nSlBBUXVlcnkgcmVtb3ZlRmlsdGVyTGlzdGVuZXIoRmlsdGVyTGlzdGVuZXIg\nbGlzdGVuZXIpIHsKICAgICAgICBfZW0uYXNzZXJ0Tm90Q2xvc2VJbnZva2Vk\nKCk7CiAgICAgICAgX3F1ZXJ5LnJlbW92ZUZpbHRlckxpc3RlbmVyKGxpc3Rl\nbmVyKTsKICAgICAgICByZXR1cm4gdGhpczsKICAgIH0KCiAgICBwdWJsaWMg\nT3BlbkpQQVF1ZXJ5IGFkZEFnZ3JlZ2F0ZUxpc3RlbmVyKEFnZ3JlZ2F0ZUxp\nc3RlbmVyIGxpc3RlbmVyKSB7CiAgICAgICAgX2VtLmFzc2VydE5vdENsb3Nl\nSW52b2tlZCgpOwogICAgICAgIF9xdWVyeS5hZGRBZ2dyZWdhdGVMaXN0ZW5l\ncihsaXN0ZW5lcik7CiAgICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CgogICAg\ncHVibGljIE9wZW5KUEFRdWVyeSByZW1vdmVBZ2dyZWdhdGVMaXN0ZW5lcihB\nZ2dyZWdhdGVMaXN0ZW5lciBsaXN0ZW5lcikgewogICAgICAgIF9lbS5hc3Nl\ncnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICBfcXVlcnkucmVtb3ZlQWdn\ncmVnYXRlTGlzdGVuZXIobGlzdGVuZXIpOwogICAgICAgIHJldHVybiB0aGlz\nOwogICAgfQoKICAgIHB1YmxpYyBDb2xsZWN0aW9uIGdldENhbmRpZGF0ZUNv\nbGxlY3Rpb24oKSB7CiAgICAgICAgcmV0dXJuIF9xdWVyeS5nZXRDYW5kaWRh\ndGVDb2xsZWN0aW9uKCk7CiAgICB9CgogICAgcHVibGljIE9wZW5KUEFRdWVy\neSBzZXRDYW5kaWRhdGVDb2xsZWN0aW9uKENvbGxlY3Rpb24gY29sbCkgewog\nICAgICAgIF9lbS5hc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICBf\ncXVlcnkuc2V0Q2FuZGlkYXRlQ29sbGVjdGlvbihjb2xsKTsKICAgICAgICBy\nZXR1cm4gdGhpczsKICAgIH0KCiAgICBwdWJsaWMgQ2xhc3MgZ2V0UmVzdWx0\nQ2xhc3MoKSB7CiAgICAgICAgQ2xhc3MgcmVzID0gX3F1ZXJ5LmdldFJlc3Vs\ndFR5cGUoKTsKICAgICAgICBpZiAocmVzICE9IG51bGwpCiAgICAgICAgICAg\nIHJldHVybiByZXM7CiAgICAgICAgcmV0dXJuIF9xdWVyeS5nZXRDYW5kaWRh\ndGVUeXBlKCk7CiAgICB9CgogICAgcHVibGljIE9wZW5KUEFRdWVyeSBzZXRS\nZXN1bHRDbGFzcyhDbGFzcyBjbHMpIHsKICAgICAgICBfZW0uYXNzZXJ0Tm90\nQ2xvc2VJbnZva2VkKCk7CiAgICAgICAgaWYgKE9wZW5KUEFQZXJzaXN0ZW5j\nZS5pc01hbmFnZWRUeXBlKF9lbSwgY2xzKSkKICAgICAgICAgICAgX3F1ZXJ5\nLnNldENhbmRpZGF0ZVR5cGUoY2xzLCB0cnVlKTsKICAgICAgICBlbHNlCiAg\nICAgICAgICAgIF9xdWVyeS5zZXRSZXN1bHRUeXBlKGNscyk7CiAgICAgICAg\ncmV0dXJuIHRoaXM7CiAgICB9CgogICAgcHVibGljIGJvb2xlYW4gaGFzU3Vi\nY2xhc3NlcygpIHsKICAgICAgICByZXR1cm4gX3F1ZXJ5Lmhhc1N1YmNsYXNz\nZXMoKTsKICAgIH0KCiAgICBwdWJsaWMgT3BlbkpQQVF1ZXJ5IHNldFN1YmNs\nYXNzZXMoYm9vbGVhbiBzdWJzKSB7CiAgICAgICAgX2VtLmFzc2VydE5vdENs\nb3NlSW52b2tlZCgpOwogICAgICAgIENsYXNzIGNscyA9IF9xdWVyeS5nZXRD\nYW5kaWRhdGVUeXBlKCk7CiAgICAgICAgX3F1ZXJ5LnNldENhbmRpZGF0ZUV4\ndGVudChfcXVlcnkuZ2V0QnJva2VyKCkubmV3RXh0ZW50KGNscywgc3Vicykp\nOwogICAgICAgIHJldHVybiB0aGlzOwogICAgfQoKICAgIHB1YmxpYyBpbnQg\nZ2V0Rmlyc3RSZXN1bHQoKSB7CiAgICAgICAgcmV0dXJuIGFzSW50KF9xdWVy\neS5nZXRTdGFydFJhbmdlKCkpOwogICAgfQoKICAgIHB1YmxpYyBPcGVuSlBB\nUXVlcnkgc2V0Rmlyc3RSZXN1bHQoaW50IHN0YXJ0UG9zaXRpb24pIHsKICAg\nICAgICBfZW0uYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAgX3F1\nZXJ5LnNldFJhbmdlKHN0YXJ0UG9zaXRpb24sIF9xdWVyeS5nZXRFbmRSYW5n\nZSgpKTsKICAgICAgICByZXR1cm4gdGhpczsKICAgIH0KCiAgICBwdWJsaWMg\naW50IGdldE1heFJlc3VsdHMoKSB7CiAgICAgICAgcmV0dXJuIGFzSW50KF9x\ndWVyeS5nZXRFbmRSYW5nZSgpIC0gX3F1ZXJ5LmdldFN0YXJ0UmFuZ2UoKSk7\nCiAgICB9CgogICAgcHVibGljIE9wZW5KUEFRdWVyeSBzZXRNYXhSZXN1bHRz\nKGludCBtYXgpIHsKICAgICAgICBfZW0uYXNzZXJ0Tm90Q2xvc2VJbnZva2Vk\nKCk7CiAgICAgICAgbG9uZyBzdGFydCA9IF9xdWVyeS5nZXRTdGFydFJhbmdl\nKCk7CiAgICAgICAgaWYgKG1heCA9PSBJbnRlZ2VyLk1BWF9WQUxVRSkKICAg\nICAgICAgICAgX3F1ZXJ5LnNldFJhbmdlKHN0YXJ0LCBMb25nLk1BWF9WQUxV\nRSk7CiAgICAgICAgZWxzZQogICAgICAgICAgICBfcXVlcnkuc2V0UmFuZ2Uo\nc3RhcnQsIHN0YXJ0ICsgbWF4KTsKICAgICAgICByZXR1cm4gdGhpczsKICAg\nIH0KCiAgICBwdWJsaWMgT3BlbkpQQVF1ZXJ5IGNvbXBpbGUoKSB7CiAgICAg\nICAgX2VtLmFzc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIF9xdWVy\neS5jb21waWxlKCk7CiAgICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CgogICAg\ncHJpdmF0ZSBPYmplY3QgZXhlY3V0ZSgpIHsKICAgICAgICBpZiAoX3F1ZXJ5\nLmdldE9wZXJhdGlvbigpICE9IE9QX1NFTEVDVCkKICAgICAgICAgICAgdGhy\nb3cgbmV3IEludmFsaWRTdGF0ZUV4Y2VwdGlvbihfbG9jLmdldCgibm90LXNl\nbGVjdC1xdWVyeSIsCiAgICAgICAgICAgICAgICBfcXVlcnkuZ2V0UXVlcnlT\ndHJpbmcoKSksIG51bGwsIG51bGwsIGZhbHNlKTsKCiAgICAgICAgdmFsaWRh\ndGVQYXJhbWV0ZXJzKCk7CgogICAgICAgIC8vIGhhbmRsZSB3aGljaCB0eXBl\ncyBvZiBwYXJhbWV0ZXJzIHdlIGFyZSB1c2luZywgaWYgYW55CiAgICAgICAg\naWYgKF9wb3NpdGlvbmFsICE9IG51bGwpCiAgICAgICAgICAgIHJldHVybiBf\ncXVlcnkuZXhlY3V0ZShfcG9zaXRpb25hbC50b0FycmF5KCkpOwogICAgICAg\nIGlmIChfbmFtZWQgIT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIF9xdWVy\neS5leGVjdXRlKF9uYW1lZCk7CiAgICAgICAgcmV0dXJuIF9xdWVyeS5leGVj\ndXRlKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBWYWxpZGF0ZSB0aGF0IHRo\nZSB0eXBlcyBvZiB0aGUgcGFyYW1ldGVycyBhcmUgY29ycmVjdC4KICAgICAq\nLwogICAgcHJpdmF0ZSB2b2lkIHZhbGlkYXRlUGFyYW1ldGVycygpIHsKICAg\nICAgICBpZiAoX3Bvc2l0aW9uYWwgIT0gbnVsbCkgewogICAgICAgICAgICBM\naW5rZWRNYXAgdHlwZXMgPSBfcXVlcnkuZ2V0UGFyYW1ldGVyVHlwZXMoKTsK\nICAgICAgICAgICAgZm9yIChpbnQgaSA9IDAsCiAgICAgICAgICAgICAgICBz\naXplID0gTWF0aC5taW4oX3Bvc2l0aW9uYWwuc2l6ZSgpLCB0eXBlcy5zaXpl\nKCkpOwogICAgICAgICAgICAgICAgaSA8IHNpemU7IGkrKykKICAgICAgICAg\nICAgICAgIHZhbGlkYXRlUGFyYW1ldGVyKFN0cmluZy52YWx1ZU9mKGkpLAog\nICAgICAgICAgICAgICAgICAgIChDbGFzcykgdHlwZXMuZ2V0VmFsdWUoaSks\nIF9wb3NpdGlvbmFsLmdldChpKSk7CiAgICAgICAgfSBlbHNlIGlmIChfbmFt\nZWQgIT0gbnVsbCkgewogICAgICAgICAgICBNYXAgdHlwZXMgPSBfcXVlcnku\nZ2V0UGFyYW1ldGVyVHlwZXMoKTsKICAgICAgICAgICAgZm9yIChJdGVyYXRv\nciBpID0gX25hbWVkLmVudHJ5U2V0KCkuaXRlcmF0b3IoKTsgaS5oYXNOZXh0\nKCk7KSB7CiAgICAgICAgICAgICAgICBNYXAuRW50cnkgZW50cnkgPSAoTWFw\nLkVudHJ5KSBpLm5leHQoKTsKICAgICAgICAgICAgICAgIFN0cmluZyBuYW1l\nID0gKFN0cmluZykgZW50cnkuZ2V0S2V5KCk7CiAgICAgICAgICAgICAgICB2\nYWxpZGF0ZVBhcmFtZXRlcihuYW1lLCAoQ2xhc3MpIHR5cGVzLmdldChuYW1l\nKSwKICAgICAgICAgICAgICAgICAgICBlbnRyeS5nZXRWYWx1ZSgpKTsKICAg\nICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICBwcml2YXRlIHZvaWQg\ndmFsaWRhdGVQYXJhbWV0ZXIoU3RyaW5nIHBhcmFtRGVzYywgQ2xhc3MgdHlw\nZSwgT2JqZWN0IHBhcmFtKSB7CiAgICAgICAgLy8gbnVsbCBwYXJhbWV0ZXJz\nIGFyZSBhbGxvd2VkLCBzbyBhcmUgbm90IHZhbGlkYXRlZAogICAgICAgIGlm\nIChwYXJhbSA9PSBudWxsIHx8IHR5cGUgPT0gbnVsbCkKICAgICAgICAgICAg\ncmV0dXJuOwoKICAgICAgICAvLyBjaGVjayB0aGUgcGFyYW1ldGVyIGFnYWlu\nc3QgdGhlIHdyYXBwZWQgdHlwZQogICAgICAgIGlmICghRmlsdGVycy53cmFw\nKHR5cGUpLmlzSW5zdGFuY2UocGFyYW0pKQogICAgICAgICAgICB0aHJvdyBu\nZXcgQXJndW1lbnRFeGNlcHRpb24oX2xvYy5nZXQoImJhZC1wYXJhbS10eXBl\nIiwKICAgICAgICAgICAgICAgIHBhcmFtRGVzYywgcGFyYW0uZ2V0Q2xhc3Mo\nKS5nZXROYW1lKCksIHR5cGUuZ2V0TmFtZSgpKSwKICAgICAgICAgICAgICAg\nIG51bGwsIG51bGwsIGZhbHNlKTsKICAgIH0KCiAgICBwdWJsaWMgTGlzdCBn\nZXRSZXN1bHRMaXN0KCkgewogICAgICAgIF9lbS5hc3NlcnROb3RDbG9zZUlu\ndm9rZWQoKTsKICAgICAgICBPYmplY3Qgb2IgPSBleGVjdXRlKCk7CiAgICAg\nICAgaWYgKG9iIGluc3RhbmNlb2YgTGlzdCkgewogICAgICAgICAgICBMaXN0\nIHJldCA9IChMaXN0KSBvYjsKICAgICAgICAgICAgaWYgKHJldCBpbnN0YW5j\nZW9mIFJlc3VsdExpc3QpCiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IERl\nbGVnYXRpbmdSZXN1bHRMaXN0KChSZXN1bHRMaXN0KSByZXQsCiAgICAgICAg\nICAgICAgICAgICAgUGVyc2lzdGVuY2VFeGNlcHRpb25zLmdldFJvbGxiYWNr\nVHJhbnNsYXRvcihfZW0pKTsKICAgICAgICAgICAgZWxzZQogICAgICAgICAg\nICAgICAgcmV0dXJuIHJldDsKICAgICAgICB9CgogICAgICAgIHJldHVybiBD\nb2xsZWN0aW9ucy5zaW5nbGV0b25MaXN0KG9iKTsKICAgIH0KCiAgICAvKioK\nICAgICAqIEV4ZWN1dGUgYSBxdWVyeSB0aGF0IHJldHVybnMgYSBzaW5nbGUg\ncmVzdWx0LgogICAgICovCiAgICBwdWJsaWMgT2JqZWN0IGdldFNpbmdsZVJl\nc3VsdCgpIHsKICAgICAgICBfZW0uYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7\nCiAgICAgICAgLy8gdGVtcG9yYXJpbHkgc2V0IHF1ZXJ5IHRvIHVuaXF1ZSBz\nbyB0aGF0IGEgc2luZ2xlIHJlc3VsdCBpcyB2YWxpZGF0ZWQKICAgICAgICAv\nLyBhbmQgcmV0dXJuZWQ7IHVuc2V0IGFnYWluIGluIGNhc2UgdGhlIHVzZXIg\nZXhlY3V0ZXMgcXVlcnkgYWdhaW4KICAgICAgICAvLyB2aWEgZ2V0UmVzdWx0\nTGlzdAogICAgICAgIF9xdWVyeS5zZXRVbmlxdWUodHJ1ZSk7CiAgICAgICAg\ndHJ5IHsKICAgICAgICAgICAgcmV0dXJuIGV4ZWN1dGUoKTsKICAgICAgICB9\nIGZpbmFsbHkgewogICAgICAgICAgICBfcXVlcnkuc2V0VW5pcXVlKGZhbHNl\nKTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGljIGludCBleGVjdXRlVXBk\nYXRlKCkgewogICAgICAgIF9lbS5hc3NlcnROb3RDbG9zZUludm9rZWQoKTsK\nICAgICAgICBpZiAoX3F1ZXJ5LmdldE9wZXJhdGlvbigpID09IE9QX0RFTEVU\nRSkgewogICAgICAgICAgICAvLyBoYW5kbGUgd2hpY2ggdHlwZXMgb2YgcGFy\nYW1ldGVycyB3ZSBhcmUgdXNpbmcsIGlmIGFueQogICAgICAgICAgICBpZiAo\nX3Bvc2l0aW9uYWwgIT0gbnVsbCkKICAgICAgICAgICAgICAgIHJldHVybiBh\nc0ludChfcXVlcnkuZGVsZXRlQWxsKF9wb3NpdGlvbmFsLnRvQXJyYXkoKSkp\nOwogICAgICAgICAgICBpZiAoX25hbWVkICE9IG51bGwpCiAgICAgICAgICAg\nICAgICByZXR1cm4gYXNJbnQoX3F1ZXJ5LmRlbGV0ZUFsbChfbmFtZWQpKTsK\nICAgICAgICAgICAgcmV0dXJuIGFzSW50KF9xdWVyeS5kZWxldGVBbGwoKSk7\nCiAgICAgICAgfQogICAgICAgIGlmIChfcXVlcnkuZ2V0T3BlcmF0aW9uKCkg\nPT0gT1BfVVBEQVRFKSB7CiAgICAgICAgICAgIC8vIGhhbmRsZSB3aGljaCB0\neXBlcyBvZiBwYXJhbWV0ZXJzIHdlIGFyZSB1c2luZywgaWYgYW55CiAgICAg\nICAgICAgIGlmIChfcG9zaXRpb25hbCAhPSBudWxsKQogICAgICAgICAgICAg\nICAgcmV0dXJuIGFzSW50KF9xdWVyeS51cGRhdGVBbGwoX3Bvc2l0aW9uYWwu\ndG9BcnJheSgpKSk7CiAgICAgICAgICAgIGlmIChfbmFtZWQgIT0gbnVsbCkK\nICAgICAgICAgICAgICAgIHJldHVybiBhc0ludChfcXVlcnkudXBkYXRlQWxs\nKF9uYW1lZCkpOwogICAgICAgICAgICByZXR1cm4gYXNJbnQoX3F1ZXJ5LnVw\nZGF0ZUFsbCgpKTsKICAgICAgICB9CiAgICAgICAgdGhyb3cgbmV3IEludmFs\naWRTdGF0ZUV4Y2VwdGlvbihfbG9jLmdldCgibm90LXVwZGF0ZS1kZWxldGUt\ncXVlcnkiLAogICAgICAgICAgICBfcXVlcnkuZ2V0UXVlcnlTdHJpbmcoKSks\nIG51bGwsIG51bGwsIGZhbHNlKTsKICAgIH0KCiAgICAvKioKICAgICAqIENh\nc3QgdGhlIHNwZWNpZmllZCBsb25nIGRvd24gdG8gYW4gaW50LCBmaXJzdCBj\naGVja2luZyBmb3Igb3ZlcmZsb3cuCiAgICAgKi8KICAgIHByaXZhdGUgc3Rh\ndGljIGludCBhc0ludChsb25nIGwpIHsKICAgICAgICBpZiAobCA+IEludGVn\nZXIuTUFYX1ZBTFVFKQogICAgICAgICAgICByZXR1cm4gSW50ZWdlci5NQVhf\nVkFMVUU7CiAgICAgICAgaWYgKGwgPCBJbnRlZ2VyLk1JTl9WQUxVRSkgLy8g\ndW5saWtlbHksIGJ1dCB3ZSBtaWdodCBhcyB3ZWxsIGNoZWNrCiAgICAgICAg\nICAgIHJldHVybiBJbnRlZ2VyLk1JTl9WQUxVRTsKICAgICAgICByZXR1cm4g\nKGludCkgbDsKICAgIH0KCiAgICBwdWJsaWMgRmx1c2hNb2RlVHlwZSBnZXRG\nbHVzaE1vZGUoKSB7CiAgICAgICAgcmV0dXJuIEVudGl0eU1hbmFnZXJJbXBs\nLmZyb21GbHVzaEJlZm9yZVF1ZXJpZXMoX3F1ZXJ5LgogICAgICAgICAgICBn\nZXRGZXRjaENvbmZpZ3VyYXRpb24oKS5nZXRGbHVzaEJlZm9yZVF1ZXJpZXMo\nKSk7CiAgICB9CgogICAgcHVibGljIE9wZW5KUEFRdWVyeSBzZXRGbHVzaE1v\nZGUoRmx1c2hNb2RlVHlwZSBmbHVzaE1vZGUpIHsKICAgICAgICBfZW0uYXNz\nZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAgX3F1ZXJ5LmdldEZldGNo\nQ29uZmlndXJhdGlvbigpLnNldEZsdXNoQmVmb3JlUXVlcmllcwogICAgICAg\nICAgICAoRW50aXR5TWFuYWdlckltcGwudG9GbHVzaEJlZm9yZVF1ZXJpZXMo\nZmx1c2hNb2RlKSk7CiAgICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CgogICAg\ncHVibGljIE9wZW5KUEFRdWVyeSBzZXRIaW50KFN0cmluZyBrZXksIE9iamVj\ndCB2YWx1ZSkgewogICAgICAgIF9lbS5hc3NlcnROb3RDbG9zZUludm9rZWQo\nKTsKICAgICAgICBpZiAoa2V5ID09IG51bGwgfHwgIWtleS5zdGFydHNXaXRo\nKCJvcGVuanBhLiIpKQogICAgICAgICAgICByZXR1cm4gdGhpczsKICAgICAg\nICBTdHJpbmcgayA9IGtleS5zdWJzdHJpbmcoIm9wZW5qcGEuIi5sZW5ndGgo\nKSk7CgogICAgICAgIHRyeSB7CiAgICAgICAgICAgIGlmICgiU3ViY2xhc3Nl\ncyIuZXF1YWxzKGspKSB7CiAgICAgICAgICAgICAgICBpZiAodmFsdWUgaW5z\ndGFuY2VvZiBTdHJpbmcpCiAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBC\nb29sZWFuLnZhbHVlT2YoKFN0cmluZykgdmFsdWUpOwogICAgICAgICAgICAg\nICAgc2V0U3ViY2xhc3NlcygoKEJvb2xlYW4pIHZhbHVlKS5ib29sZWFuVmFs\ndWUoKSk7CiAgICAgICAgICAgIH0gZWxzZSBpZiAoIkZpbHRlckxpc3RlbmVy\nIi5lcXVhbHMoaykpCiAgICAgICAgICAgICAgICBhZGRGaWx0ZXJMaXN0ZW5l\ncihGaWx0ZXJzLmhpbnRUb0ZpbHRlckxpc3RlbmVyKHZhbHVlLAogICAgICAg\nICAgICAgICAgICAgIF9xdWVyeS5nZXRCcm9rZXIoKS5nZXRDbGFzc0xvYWRl\ncigpKSk7CiAgICAgICAgICAgIGVsc2UgaWYgKCJGaWx0ZXJMaXN0ZW5lcnMi\nLmVxdWFscyhrKSkgewogICAgICAgICAgICAgICAgRmlsdGVyTGlzdGVuZXJb\nXSBhcnIgPSBGaWx0ZXJzLmhpbnRUb0ZpbHRlckxpc3RlbmVycyh2YWx1ZSwK\nICAgICAgICAgICAgICAgICAgICBfcXVlcnkuZ2V0QnJva2VyKCkuZ2V0Q2xh\nc3NMb2FkZXIoKSk7CiAgICAgICAgICAgICAgICBmb3IgKGludCBpID0gMDsg\naSA8IGFyci5sZW5ndGg7IGkrKykKICAgICAgICAgICAgICAgICAgICBhZGRG\naWx0ZXJMaXN0ZW5lcihhcnJbaV0pOwogICAgICAgICAgICB9IGVsc2UgaWYg\nKCJBZ2dyZWdhdGVMaXN0ZW5lciIuZXF1YWxzKGspKQogICAgICAgICAgICAg\nICAgYWRkQWdncmVnYXRlTGlzdGVuZXIoRmlsdGVycy5oaW50VG9BZ2dyZWdh\ndGVMaXN0ZW5lcih2YWx1ZSwKICAgICAgICAgICAgICAgICAgICBfcXVlcnku\nZ2V0QnJva2VyKCkuZ2V0Q2xhc3NMb2FkZXIoKSkpOwogICAgICAgICAgICBl\nbHNlIGlmICgiRmlsdGVyTGlzdGVuZXJzIi5lcXVhbHMoaykpIHsKICAgICAg\nICAgICAgICAgIEFnZ3JlZ2F0ZUxpc3RlbmVyW10gYXJyID0gRmlsdGVycy5o\naW50VG9BZ2dyZWdhdGVMaXN0ZW5lcnMKICAgICAgICAgICAgICAgICAgICAo\ndmFsdWUsIF9xdWVyeS5nZXRCcm9rZXIoKS5nZXRDbGFzc0xvYWRlcigpKTsK\nICAgICAgICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgYXJyLmxlbmd0\naDsgaSsrKQogICAgICAgICAgICAgICAgICAgIGFkZEFnZ3JlZ2F0ZUxpc3Rl\nbmVyKGFycltpXSk7CiAgICAgICAgICAgIH0gZWxzZSBpZiAoay5zdGFydHNX\naXRoKCJGZXRjaFBsYW4uIikpIHsKICAgICAgICAgICAgICAgIGsgPSBrLnN1\nYnN0cmluZygiRmV0Y2hQbGFuLiIubGVuZ3RoKCkpOwogICAgICAgICAgICAg\nICAgaGludFRvU2V0dGVyKGdldEZldGNoUGxhbigpLCBrLCB2YWx1ZSk7CiAg\nICAgICAgICAgIH0gZWxzZSBpZiAoay5zdGFydHNXaXRoKCJoaW50LiIpKSB7\nCiAgICAgICAgICAgICAgICBpZiAoImhpbnQuT3B0aW1pemVSZXN1bHRDb3Vu\ndCIuZXF1YWxzKGspKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKHZhbHVl\nIGluc3RhbmNlb2YgU3RyaW5nKSB7CiAgICAgICAgICAgICAgICAgICAgICAg\nIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IG5l\ndyBJbnRlZ2VyKChTdHJpbmcpIHZhbHVlKTsKICAgICAgICAgICAgICAgICAg\nICAgICAgfSBjYXRjaCAoTnVtYmVyRm9ybWF0RXhjZXB0aW9uIG5mZSkgewog\nICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAg\nfQogICAgICAgICAgICAgICAgICAgIGlmICghKHZhbHVlIGluc3RhbmNlb2Yg\nTnVtYmVyKSAKICAgICAgICAgICAgICAgICAgICAgICAgfHwgKChOdW1iZXIp\nIHZhbHVlKS5pbnRWYWx1ZSgpIDwgMCkKICAgICAgICAgICAgICAgICAgICAg\nICAgdGhyb3cgbmV3IEFyZ3VtZW50RXhjZXB0aW9uKF9sb2MuZ2V0CiAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAoImJhZC1xdWVyeS1oaW50LXZhbHVl\nIiwga2V5LCB2YWx1ZSksIG51bGwsIG51bGwsIAogICAgICAgICAgICAgICAg\nICAgICAgICAgICAgZmFsc2UpOwogICAgICAgICAgICAgICAgfQogICAgICAg\nICAgICAgICAgX3F1ZXJ5LmdldEZldGNoQ29uZmlndXJhdGlvbigpLnNldEhp\nbnQoa2V5LCB2YWx1ZSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxz\nZQogICAgICAgICAgICAgICAgdGhyb3cgbmV3IEFyZ3VtZW50RXhjZXB0aW9u\nKF9sb2MuZ2V0KCJiYWQtcXVlcnktaGludCIsIGtleSksCiAgICAgICAgICAg\nICAgICAgICAgbnVsbCwgbnVsbCwgZmFsc2UpOwogICAgICAgICAgICByZXR1\ncm4gdGhpczsKICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkgewogICAg\nICAgICAgICB0aHJvdyBQZXJzaXN0ZW5jZUV4Y2VwdGlvbnMudG9QZXJzaXN0\nZW5jZUV4Y2VwdGlvbihlKTsKICAgICAgICB9CiAgICB9CgogICAgcHJpdmF0\nZSB2b2lkIGhpbnRUb1NldHRlcihGZXRjaFBsYW4gZmV0Y2hQbGFuLCBTdHJp\nbmcgaywgT2JqZWN0IHZhbHVlKSB7CiAgICAgICAgaWYgKGZldGNoUGxhbiA9\nPSBudWxsIHx8IGsgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuOwoKICAg\nICAgICBNZXRob2Qgc2V0dGVyID0gUmVmbGVjdGlvbi5maW5kU2V0dGVyKGZl\ndGNoUGxhbi5nZXRDbGFzcygpLCBrLCB0cnVlKTsKICAgICAgICBDbGFzcyBw\nYXJhbVR5cGUgPSBzZXR0ZXIuZ2V0UGFyYW1ldGVyVHlwZXMoKVswXTsKICAg\nICAgICBpZiAoRW51bS5jbGFzcy5pc0Fzc2lnbmFibGVGcm9tKHBhcmFtVHlw\nZSkgJiYgdmFsdWUgaW5zdGFuY2VvZiBTdHJpbmcpCiAgICAgICAgICAgIHZh\nbHVlID0gRW51bS52YWx1ZU9mKHBhcmFtVHlwZSwgKFN0cmluZykgdmFsdWUp\nOwogICAgICAgIAogICAgICAgIEZpbHRlcnMuaGludFRvU2V0dGVyKGZldGNo\nUGxhbiwgaywgdmFsdWUpOwogICAgfQoKICAgIHB1YmxpYyBPcGVuSlBBUXVl\ncnkgc2V0UGFyYW1ldGVyKGludCBwb3NpdGlvbiwgQ2FsZW5kYXIgdmFsdWUs\nCiAgICAgICAgVGVtcG9yYWxUeXBlIHQpIHsKICAgICAgICByZXR1cm4gc2V0\nUGFyYW1ldGVyKHBvc2l0aW9uLCAoT2JqZWN0KSB2YWx1ZSk7CiAgICB9Cgog\nICAgcHVibGljIE9wZW5KUEFRdWVyeSBzZXRQYXJhbWV0ZXIoaW50IHBvc2l0\naW9uLCBEYXRlIHZhbHVlLAogICAgICAgIFRlbXBvcmFsVHlwZSB0eXBlKSB7\nCiAgICAgICAgcmV0dXJuIHNldFBhcmFtZXRlcihwb3NpdGlvbiwgKE9iamVj\ndCkgdmFsdWUpOwogICAgfQoKICAgIHB1YmxpYyBPcGVuSlBBUXVlcnkgc2V0\nUGFyYW1ldGVyKGludCBwb3NpdGlvbiwgT2JqZWN0IHZhbHVlKSB7CiAgICAg\nICAgX3F1ZXJ5LmFzc2VydE9wZW4oKTsKICAgICAgICBfZW0uYXNzZXJ0Tm90\nQ2xvc2VJbnZva2VkKCk7CiAgICAgICAgX3F1ZXJ5LmxvY2soKTsKICAgICAg\nICB0cnkgewogICAgICAgICAgICAvLyBub3QgYWxsb3dlZCB0byBtaXggcG9z\naXRpb25hbCBhbmQgbmFtZWQgcGFyYW1ldGVycyAoRURSMiAzLjYuNCkKICAg\nICAgICAgICAgaWYgKF9uYW1lZCAhPSBudWxsKQogICAgICAgICAgICAgICAg\ndGhyb3cgbmV3IEludmFsaWRTdGF0ZUV4Y2VwdGlvbihfbG9jLmdldAogICAg\nICAgICAgICAgICAgICAgICgibm8tcG9zLW5hbWVkLXBhcmFtcy1taXgiLCBf\ncXVlcnkuZ2V0UXVlcnlTdHJpbmcoKSksCiAgICAgICAgICAgICAgICAgICAg\nbnVsbCwgbnVsbCwgZmFsc2UpOwoKICAgICAgICAgICAgaWYgKHBvc2l0aW9u\nIDwgMSkKICAgICAgICAgICAgICAgIHRocm93IG5ldyBJbnZhbGlkU3RhdGVF\neGNlcHRpb24oX2xvYy5nZXQKICAgICAgICAgICAgICAgICAgICAoImlsbGVn\nYWwtaW5kZXgiLCBwb3NpdGlvbiksIG51bGwsIG51bGwsIGZhbHNlKTsKCiAg\nICAgICAgICAgIGlmIChfcG9zaXRpb25hbCA9PSBudWxsKQogICAgICAgICAg\nICAgICAgX3Bvc2l0aW9uYWwgPSBuZXcgQXJyYXlMaXN0KCk7CgogICAgICAg\nICAgICAvLyBtYWtlIHN1cmUgaXQgaXMgYXQgbGVhc3QgdGhlIHJlcXVlc3Rl\nZCBzaXplCiAgICAgICAgICAgIHdoaWxlIChfcG9zaXRpb25hbC5zaXplKCkg\nPCBwb3NpdGlvbikKICAgICAgICAgICAgICAgIF9wb3NpdGlvbmFsLmFkZChu\ndWxsKTsKCiAgICAgICAgICAgIC8vIG5vdGUgdGhhdCB3ZSBhZGQgaXQgdG8g\ncG9zaXRpb24gLSAxLCBzaW5jZSBzZXRQb3NpdGlvbgogICAgICAgICAgICAv\nLyBzdGFydHMgYXQgMSwgd2hpbGUgTGlzdCBzdGFydHMgYXQgMAogICAgICAg\nICAgICBfcG9zaXRpb25hbC5zZXQocG9zaXRpb24gLSAxLCB2YWx1ZSk7CiAg\nICAgICAgICAgIHJldHVybiB0aGlzOwogICAgICAgIH0gZmluYWxseSB7CiAg\nICAgICAgICAgIF9xdWVyeS51bmxvY2soKTsKICAgICAgICB9CiAgICB9Cgog\nICAgcHVibGljIE9wZW5KUEFRdWVyeSBzZXRQYXJhbWV0ZXIoU3RyaW5nIG5h\nbWUsIENhbGVuZGFyIHZhbHVlLAogICAgICAgIFRlbXBvcmFsVHlwZSB0KSB7\nCiAgICAgICAgcmV0dXJuIHNldFBhcmFtZXRlcihuYW1lLCAoT2JqZWN0KSB2\nYWx1ZSk7CiAgICB9CgogICAgcHVibGljIE9wZW5KUEFRdWVyeSBzZXRQYXJh\nbWV0ZXIoU3RyaW5nIG5hbWUsIERhdGUgdmFsdWUsCiAgICAgICAgVGVtcG9y\nYWxUeXBlIHR5cGUpIHsKICAgICAgICByZXR1cm4gc2V0UGFyYW1ldGVyKG5h\nbWUsIChPYmplY3QpIHZhbHVlKTsKICAgIH0KCiAgICBwdWJsaWMgT3BlbkpQ\nQVF1ZXJ5IHNldFBhcmFtZXRlcihTdHJpbmcgbmFtZSwgT2JqZWN0IHZhbHVl\nKSB7CiAgICAgICAgX3F1ZXJ5LmFzc2VydE9wZW4oKTsKICAgICAgICBfZW0u\nYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAgX3F1ZXJ5LmxvY2so\nKTsKICAgICAgICB0cnkgewogICAgICAgICAgICAvLyBub3QgYWxsb3dlZCB0\nbyBtaXggcG9zaXRpb25hbCBhbmQgbmFtZWQgcGFyYW1ldGVycyAoRURSMiAz\nLjYuNCkKICAgICAgICAgICAgaWYgKF9wb3NpdGlvbmFsICE9IG51bGwpCiAg\nICAgICAgICAgICAgICB0aHJvdyBuZXcgSW52YWxpZFN0YXRlRXhjZXB0aW9u\nKF9sb2MuZ2V0CiAgICAgICAgICAgICAgICAgICAgKCJuby1wb3MtbmFtZWQt\ncGFyYW1zLW1peCIsIF9xdWVyeS5nZXRRdWVyeVN0cmluZygpKSwKICAgICAg\nICAgICAgICAgICAgICBudWxsLCBudWxsLCBmYWxzZSk7CgogICAgICAgICAg\nICBpZiAoX25hbWVkID09IG51bGwpCiAgICAgICAgICAgICAgICBfbmFtZWQg\nPSBuZXcgSGFzaE1hcCgpOwogICAgICAgICAgICBfbmFtZWQucHV0KG5hbWUs\nIHZhbHVlKTsKICAgICAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgICAgfSBm\naW5hbGx5IHsKICAgICAgICAgICAgX3F1ZXJ5LnVubG9jaygpOwogICAgICAg\nIH0KICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBoYXNQb3NpdGlvbmFsUGFy\nYW1ldGVycygpIHsKICAgICAgICByZXR1cm4gX3Bvc2l0aW9uYWwgIT0gbnVs\nbDsKICAgIH0KCiAgICBwdWJsaWMgT2JqZWN0W10gZ2V0UG9zaXRpb25hbFBh\ncmFtZXRlcnMoKSB7CiAgICAgICAgX3F1ZXJ5LmxvY2soKTsKICAgICAgICB0\ncnkgewogICAgICAgICAgICByZXR1cm4gKF9wb3NpdGlvbmFsID09IG51bGwp\nID8gRU1QVFlfQVJSQVkgOiBfcG9zaXRpb25hbC50b0FycmF5KCk7CiAgICAg\nICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgX3F1ZXJ5LnVubG9jaygpOwog\nICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMgT3BlbkpQQVF1ZXJ5IHNldFBh\ncmFtZXRlcnMoT2JqZWN0Li4uIHBhcmFtcykgewogICAgICAgIF9xdWVyeS5h\nc3NlcnRPcGVuKCk7CiAgICAgICAgX2VtLmFzc2VydE5vdENsb3NlSW52b2tl\nZCgpOwogICAgICAgIF9xdWVyeS5sb2NrKCk7CiAgICAgICAgdHJ5IHsKICAg\nICAgICAgICAgX3Bvc2l0aW9uYWwgPSBudWxsOwogICAgICAgICAgICBfbmFt\nZWQgPSBudWxsOwogICAgICAgICAgICBpZiAocGFyYW1zICE9IG51bGwpCiAg\nICAgICAgICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IHBhcmFtcy5sZW5n\ndGg7IGkrKykKICAgICAgICAgICAgICAgICAgICBzZXRQYXJhbWV0ZXIoaSAr\nIDEsIHBhcmFtc1tpXSk7CiAgICAgICAgICAgIHJldHVybiB0aGlzOwogICAg\nICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgIF9xdWVyeS51bmxvY2soKTsK\nICAgICAgICB9CiAgICB9CgogICAgcHVibGljIE1hcCBnZXROYW1lZFBhcmFt\nZXRlcnMoKSB7CiAgICAgICAgX3F1ZXJ5LmxvY2soKTsKICAgICAgICB0cnkg\newogICAgICAgICAgICByZXR1cm4gKF9uYW1lZCA9PSBudWxsKSA/IENvbGxl\nY3Rpb25zLkVNUFRZX01BUAogICAgICAgICAgICAgICAgOiBDb2xsZWN0aW9u\ncy51bm1vZGlmaWFibGVNYXAoX25hbWVkKTsKICAgICAgICB9IGZpbmFsbHkg\newogICAgICAgICAgICBfcXVlcnkudW5sb2NrKCk7CiAgICAgICAgfQogICAg\nfQoKICAgIHB1YmxpYyBPcGVuSlBBUXVlcnkgc2V0UGFyYW1ldGVycyhNYXAg\ncGFyYW1zKSB7CiAgICAgICAgX3F1ZXJ5LmFzc2VydE9wZW4oKTsKICAgICAg\nICBfZW0uYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAgX3F1ZXJ5\nLmxvY2soKTsKICAgICAgICB0cnkgewogICAgICAgICAgICBfcG9zaXRpb25h\nbCA9IG51bGw7CiAgICAgICAgICAgIF9uYW1lZCA9IG51bGw7CiAgICAgICAg\nICAgIGlmIChwYXJhbXMgIT0gbnVsbCkKICAgICAgICAgICAgICAgIGZvciAo\nTWFwLkVudHJ5IGUgOiAoU2V0PE1hcC5FbnRyeT4pIHBhcmFtcy5lbnRyeVNl\ndCgpKQogICAgICAgICAgICAgICAgICAgIHNldFBhcmFtZXRlcigoU3RyaW5n\nKSBlLmdldEtleSgpLCBlLmdldFZhbHVlKCkpOwogICAgICAgICAgICByZXR1\ncm4gdGhpczsKICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICBfcXVl\ncnkudW5sb2NrKCk7CiAgICAgICAgfQogICAgfQoKICAgIHB1YmxpYyBPcGVu\nSlBBUXVlcnkgY2xvc2VBbGwoKSB7CiAgICAgICAgX3F1ZXJ5LmNsb3NlQWxs\nKCk7CiAgICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CgogICAgcHVibGljIFN0\ncmluZ1tdIGdldERhdGFTdG9yZUFjdGlvbnMoTWFwIHBhcmFtcykgewogICAg\nICAgIHJldHVybiBfcXVlcnkuZ2V0RGF0YVN0b3JlQWN0aW9ucyhwYXJhbXMp\nOwogICAgfQoKICAgIHB1YmxpYyBpbnQgaGFzaENvZGUoKSB7CiAgICAgICAg\ncmV0dXJuIF9xdWVyeS5oYXNoQ29kZSgpOwogICAgfQoKICAgIHB1YmxpYyBi\nb29sZWFuIGVxdWFscyhPYmplY3Qgb3RoZXIpIHsKICAgICAgICBpZiAob3Ro\nZXIgPT0gdGhpcykKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAg\naWYgKCEob3RoZXIgaW5zdGFuY2VvZiBRdWVyeUltcGwpKQogICAgICAgICAg\nICByZXR1cm4gZmFsc2U7CiAgICAgICAgcmV0dXJuIF9xdWVyeS5lcXVhbHMo\nKChRdWVyeUltcGwpIG90aGVyKS5fcXVlcnkpOwoJfQp9Cg==\n","encoding":"base64"}

