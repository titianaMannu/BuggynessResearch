{"sha":"50862510b6706e655197e6b8cb933f48538ca3a4","node_id":"MDQ6QmxvYjIwNjM2NDo1MDg2MjUxMGI2NzA2ZTY1NTE5N2U2YjhjYjkzM2Y0ODUzOGNhM2E0","size":55350,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/50862510b6706e655197e6b8cb933f48538ca3a4","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2U7CgppbXBv\ncnQgamF2YS5sYW5nLnJlZmxlY3QuRmllbGQ7CmltcG9ydCBqYXZhLmxhbmcu\ncmVmbGVjdC5NZW1iZXI7CmltcG9ydCBqYXZhLmxhbmcucmVmbGVjdC5NZXRo\nb2Q7CmltcG9ydCBqYXZhLnV0aWwuQXJyYXlMaXN0OwppbXBvcnQgamF2YS51\ndGlsLkNvbGxlY3Rpb247CmltcG9ydCBqYXZhLnV0aWwuRW51bVNldDsKaW1w\nb3J0IGphdmEudXRpbC5IYXNoTWFwOwppbXBvcnQgamF2YS51dGlsLk1hcDsK\naW1wb3J0IGphdmEudXRpbC5TZXQ7CmltcG9ydCBqYXZhLnV0aWwuU3RhY2s7\nCmltcG9ydCBqYXZheC5wZXJzaXN0ZW5jZS5DYXNjYWRlVHlwZTsKaW1wb3J0\nIHN0YXRpYyBqYXZheC5wZXJzaXN0ZW5jZS5DYXNjYWRlVHlwZS4qOwoKaW1w\nb3J0IG9yZy5hcGFjaGUuY29tbW9ucy5sYW5nLlN0cmluZ1V0aWxzOwppbXBv\ncnQgb3JnLnhtbC5zYXguQXR0cmlidXRlczsKaW1wb3J0IG9yZy54bWwuc2F4\nLlNBWEV4Y2VwdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5jb25m\nLk9wZW5KUEFDb25maWd1cmF0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLmVuaGFuY2UuUGVyc2lzdGVuY2VDYXBhYmxlOwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLmV2ZW50LkJlYW5MaWZlY3ljbGVDYWxsYmFja3M7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuZXZlbnQuTGlmZWN5Y2xlQ2FsbGJh\nY2tzOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmV2ZW50LkxpZmVjeWNs\nZUV2ZW50OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmV2ZW50Lk1ldGhv\nZExpZmVjeWNsZUNhbGxiYWNrczsKaW1wb3J0IG9yZy5hcGFjaGUub3Blbmpw\nYS5rZXJuZWwuUXVlcnlMYW5ndWFnZXM7CmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEua2VybmVsLmpwcWwuSlBRTFBhcnNlcjsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5saWIuY29uZi5Db25maWd1cmF0aW9uczsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5saWIubG9nLkxvZzsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5saWIubWV0YS5DRk1ldGFEYXRhUGFyc2VyOwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51dGlsLkxvY2FsaXplcjsKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5tZXRhLkNsYXNzTWV0YURhdGE7CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YS5EZWxlZ2F0aW5nTWV0YURhdGFG\nYWN0b3J5OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuRmllbGRN\nZXRhRGF0YTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRhLkphdmFU\neXBlczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRhLkxpZmVjeWNs\nZU1ldGFEYXRhOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuTWV0\nYURhdGFEZWZhdWx0czsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRh\nLk1ldGFEYXRhRmFjdG9yeTsKaW1wb3J0IHN0YXRpYyBvcmcuYXBhY2hlLm9w\nZW5qcGEubWV0YS5NZXRhRGF0YU1vZGVzLio7CmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEubWV0YS5NZXRhRGF0YVJlcG9zaXRvcnk7CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEubWV0YS5PcmRlcjsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS5tZXRhLlF1ZXJ5TWV0YURhdGE7CmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEubWV0YS5TZXF1ZW5jZU1ldGFEYXRhOwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLm1ldGEuVmFsdWVNZXRhRGF0YTsKaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS5tZXRhLlZhbHVlU3RyYXRlZ2llczsKaW1wb3J0IHN0\nYXRpYyBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuTWV0YURhdGFU\nYWcuKjsKaW1wb3J0IHN0YXRpYyBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lz\ndGVuY2UuUGVyc2lzdGVuY2VTdHJhdGVneS4qOwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLnV0aWwuSW1wbEhlbHBlcjsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS51dGlsLlVuc3VwcG9ydGVkRXhjZXB0aW9uOwppbXBvcnQgc2Vy\ncC51dGlsLlN0cmluZ3M7CgovKioKICogQ3VzdG9tIFNBWCBwYXJzZXIgdXNl\nZCBieSB0aGUgc3lzdGVtIHRvIHF1aWNrbHkgcGFyc2UgcGVyc2lzdGVuY2Ug\naQogKiBtZXRhZGF0YSBmaWxlcy4KICoKICogQGF1dGhvciBTdGV2ZSBLaW0K\nICogQG5vamF2YWRvYwogKi8KcHVibGljIGNsYXNzIFhNTFBlcnNpc3RlbmNl\nTWV0YURhdGFQYXJzZXIKICAgIGV4dGVuZHMgQ0ZNZXRhRGF0YVBhcnNlcgog\nICAgaW1wbGVtZW50cyBQZXJzaXN0ZW5jZU1ldGFEYXRhRmFjdG9yeS5QYXJz\nZXIgewoKICAgIC8vIHBhcnNlIGNvbnN0YW50cwogICAgcHJvdGVjdGVkIHN0\nYXRpYyBmaW5hbCBTdHJpbmcgRUxFTV9QS0cgPSAicGFja2FnZSI7CiAgICBw\ncm90ZWN0ZWQgc3RhdGljIGZpbmFsIFN0cmluZyBFTEVNX0FDQ0VTUyA9ICJh\nY2Nlc3MiOwogICAgcHJvdGVjdGVkIHN0YXRpYyBmaW5hbCBTdHJpbmcgRUxF\nTV9BVFRSUyA9ICJhdHRyaWJ1dGVzIjsKICAgIHByb3RlY3RlZCBzdGF0aWMg\nZmluYWwgU3RyaW5nIEVMRU1fTElTVEVORVIgPSAiZW50aXR5LWxpc3RlbmVy\nIjsKICAgIHByb3RlY3RlZCBzdGF0aWMgZmluYWwgU3RyaW5nIEVMRU1fQ0FT\nQ0FERSA9ICJjYXNjYWRlIjsKICAgIHByb3RlY3RlZCBzdGF0aWMgZmluYWwg\nU3RyaW5nIEVMRU1fQ0FTQ0FERV9BTEwgPSAiY2FzY2FkZS1hbGwiOwogICAg\ncHJvdGVjdGVkIHN0YXRpYyBmaW5hbCBTdHJpbmcgRUxFTV9DQVNDQURFX1BF\nUiA9ICJjYXNjYWRlLXBlcnNpc3QiOwogICAgcHJvdGVjdGVkIHN0YXRpYyBm\naW5hbCBTdHJpbmcgRUxFTV9DQVNDQURFX01FUiA9ICJjYXNjYWRlLW1lcmdl\nIjsKICAgIHByb3RlY3RlZCBzdGF0aWMgZmluYWwgU3RyaW5nIEVMRU1fQ0FT\nQ0FERV9SRU0gPSAiY2FzY2FkZS1yZW1vdmUiOwogICAgcHJvdGVjdGVkIHN0\nYXRpYyBmaW5hbCBTdHJpbmcgRUxFTV9DQVNDQURFX1JFRiA9ICJjYXNjYWRl\nLXJlZnJlc2giOwogICAgcHJvdGVjdGVkIHN0YXRpYyBmaW5hbCBTdHJpbmcg\nRUxFTV9QVV9NRVRBID0gInBlcnNpc3RlbmNlLXVuaXQtbWV0YWRhdGEiOwog\nICAgcHJvdGVjdGVkIHN0YXRpYyBmaW5hbCBTdHJpbmcgRUxFTV9QVV9ERUYg\nPSAicGVyc2lzdGVuY2UtdW5pdC1kZWZhdWx0cyI7CiAgICBwcm90ZWN0ZWQg\nc3RhdGljIGZpbmFsIFN0cmluZyBFTEVNX1hNTF9NQVBfTUVUQV9DT01QTEVU\nRSA9CiAgICAgICAgInhtbC1tYXBwaW5nLW1ldGFkYXRhLWNvbXBsZXRlIjsK\nCiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBNYXA8U3RyaW5nLCBPYmplY3Q+\nIF9lbGVtcyA9CiAgICAgICAgbmV3IEhhc2hNYXA8U3RyaW5nLCBPYmplY3Q+\nKCk7CgogICAgc3RhdGljIHsKICAgICAgICBfZWxlbXMucHV0KEVMRU1fUEtH\nLCBFTEVNX1BLRyk7CiAgICAgICAgX2VsZW1zLnB1dChFTEVNX0FDQ0VTUywg\nRUxFTV9BQ0NFU1MpOwogICAgICAgIF9lbGVtcy5wdXQoRUxFTV9BVFRSUywg\nRUxFTV9BVFRSUyk7CiAgICAgICAgX2VsZW1zLnB1dChFTEVNX0xJU1RFTkVS\nLCBFTEVNX0xJU1RFTkVSKTsKICAgICAgICBfZWxlbXMucHV0KEVMRU1fQ0FT\nQ0FERSwgRUxFTV9DQVNDQURFKTsKICAgICAgICBfZWxlbXMucHV0KEVMRU1f\nQ0FTQ0FERV9BTEwsIEVMRU1fQ0FTQ0FERV9BTEwpOwogICAgICAgIF9lbGVt\ncy5wdXQoRUxFTV9DQVNDQURFX1BFUiwgRUxFTV9DQVNDQURFX1BFUik7CiAg\nICAgICAgX2VsZW1zLnB1dChFTEVNX0NBU0NBREVfUkVNLCBFTEVNX0NBU0NB\nREVfUkVNKTsKICAgICAgICBfZWxlbXMucHV0KEVMRU1fQ0FTQ0FERV9NRVIs\nIEVMRU1fQ0FTQ0FERV9NRVIpOwogICAgICAgIF9lbGVtcy5wdXQoRUxFTV9D\nQVNDQURFX1JFRiwgRUxFTV9DQVNDQURFX1JFRik7CiAgICAgICAgX2VsZW1z\nLnB1dChFTEVNX1BVX01FVEEsIEVMRU1fUFVfTUVUQSk7CiAgICAgICAgX2Vs\nZW1zLnB1dChFTEVNX1BVX0RFRiwgRUxFTV9QVV9ERUYpOwogICAgICAgIF9l\nbGVtcy5wdXQoRUxFTV9YTUxfTUFQX01FVEFfQ09NUExFVEUsIEVMRU1fWE1M\nX01BUF9NRVRBX0NPTVBMRVRFKTsKCiAgICAgICAgX2VsZW1zLnB1dCgiZW50\naXR5LWxpc3RlbmVycyIsIEVOVElUWV9MSVNURU5FUlMpOwogICAgICAgIF9l\nbGVtcy5wdXQoInByZS1wZXJzaXN0IiwgUFJFX1BFUlNJU1QpOwogICAgICAg\nIF9lbGVtcy5wdXQoInBvc3QtcGVyc2lzdCIsIFBPU1RfUEVSU0lTVCk7CiAg\nICAgICAgX2VsZW1zLnB1dCgicHJlLXJlbW92ZSIsIFBSRV9SRU1PVkUpOwog\nICAgICAgIF9lbGVtcy5wdXQoInBvc3QtcmVtb3ZlIiwgUE9TVF9SRU1PVkUp\nOwogICAgICAgIF9lbGVtcy5wdXQoInByZS11cGRhdGUiLCBQUkVfVVBEQVRF\nKTsKICAgICAgICBfZWxlbXMucHV0KCJwb3N0LXVwZGF0ZSIsIFBPU1RfVVBE\nQVRFKTsKICAgICAgICBfZWxlbXMucHV0KCJwb3N0LWxvYWQiLCBQT1NUX0xP\nQUQpOwogICAgICAgIF9lbGVtcy5wdXQoImV4Y2x1ZGUtZGVmYXVsdC1saXN0\nZW5lcnMiLCBFWENMVURFX0RFRkFVTFRfTElTVEVORVJTKTsKICAgICAgICBf\nZWxlbXMucHV0KCJleGNsdWRlLXN1cGVyY2xhc3MtbGlzdGVuZXJzIiwKICAg\nICAgICAgICAgRVhDTFVERV9TVVBFUkNMQVNTX0xJU1RFTkVSUyk7CgogICAg\nICAgIF9lbGVtcy5wdXQoIm5hbWVkLXF1ZXJ5IiwgUVVFUlkpOwogICAgICAg\nIF9lbGVtcy5wdXQoIm5hbWVkLW5hdGl2ZS1xdWVyeSIsIE5BVElWRV9RVUVS\nWSk7CiAgICAgICAgX2VsZW1zLnB1dCgicXVlcnktaGludCIsIFFVRVJZX0hJ\nTlQpOwogICAgICAgIF9lbGVtcy5wdXQoInF1ZXJ5IiwgUVVFUllfU1RSSU5H\nKTsKCiAgICAgICAgX2VsZW1zLnB1dCgiZmx1c2gtbW9kZSIsIEZMVVNIX01P\nREUpOwogICAgICAgIF9lbGVtcy5wdXQoInNlcXVlbmNlLWdlbmVyYXRvciIs\nIFNFUV9HRU5FUkFUT1IpOwoKICAgICAgICBfZWxlbXMucHV0KCJpZCIsIElE\nKTsKICAgICAgICBfZWxlbXMucHV0KCJpZC1jbGFzcyIsIElEX0NMQVNTKTsK\nICAgICAgICBfZWxlbXMucHV0KCJlbWJlZGRlZC1pZCIsIEVNQkVEREVEX0lE\nKTsKICAgICAgICBfZWxlbXMucHV0KCJ2ZXJzaW9uIiwgVkVSU0lPTik7CiAg\nICAgICAgX2VsZW1zLnB1dCgiZ2VuZXJhdGVkLXZhbHVlIiwgR0VORVJBVEVE\nX1ZBTFVFKTsKICAgICAgICBfZWxlbXMucHV0KCJtYXAta2V5IiwgTUFQX0tF\nWSk7CiAgICAgICAgX2VsZW1zLnB1dCgib3JkZXItYnkiLCBPUkRFUl9CWSk7\nCiAgICAgICAgX2VsZW1zLnB1dCgibG9iIiwgTE9CKTsKCiAgICAgICAgX2Vs\nZW1zLnB1dCgiYmFzaWMiLCBCQVNJQyk7CiAgICAgICAgX2VsZW1zLnB1dCgi\nbWFueS10by1vbmUiLCBNQU5ZX09ORSk7CiAgICAgICAgX2VsZW1zLnB1dCgi\nb25lLXRvLW9uZSIsIE9ORV9PTkUpOwogICAgICAgIF9lbGVtcy5wdXQoImVt\nYmVkZGVkIiwgRU1CRURERUQpOwogICAgICAgIF9lbGVtcy5wdXQoIm9uZS10\nby1tYW55IiwgT05FX01BTlkpOwogICAgICAgIF9lbGVtcy5wdXQoIm1hbnkt\ndG8tbWFueSIsIE1BTllfTUFOWSk7CiAgICAgICAgX2VsZW1zLnB1dCgidHJh\nbnNpZW50IiwgVFJBTlNJRU5UKTsKICAgIH0KCiAgICBwcml2YXRlIHN0YXRp\nYyBmaW5hbCBMb2NhbGl6ZXIgX2xvYyA9IExvY2FsaXplci5mb3JQYWNrYWdl\nCiAgICAgICAgKFhNTFBlcnNpc3RlbmNlTWV0YURhdGFQYXJzZXIuY2xhc3Mp\nOwoKICAgIHByaXZhdGUgZmluYWwgT3BlbkpQQUNvbmZpZ3VyYXRpb24gX2Nv\nbmY7CiAgICBwcml2YXRlIE1ldGFEYXRhUmVwb3NpdG9yeSBfcmVwb3MgPSBu\ndWxsOwogICAgcHJpdmF0ZSBBbm5vdGF0aW9uUGVyc2lzdGVuY2VNZXRhRGF0\nYVBhcnNlciBfcGFyc2VyID0gbnVsbDsKICAgIHByaXZhdGUgQ2xhc3NMb2Fk\nZXIgX2VudkxvYWRlciA9IG51bGw7CiAgICBwcml2YXRlIGludCBfbW9kZSA9\nIE1PREVfTk9ORTsKICAgIHByaXZhdGUgYm9vbGVhbiBfb3ZlcnJpZGUgPSBm\nYWxzZTsKCiAgICBwcml2YXRlIGZpbmFsIFN0YWNrIF9lbGVtZW50cyA9IG5l\ndyBTdGFjaygpOwogICAgcHJpdmF0ZSBmaW5hbCBTdGFjayBfcGFyZW50cyA9\nIG5ldyBTdGFjaygpOwoKICAgIHByaXZhdGUgQ2xhc3MgX2NscyA9IG51bGw7\nCiAgICBwcml2YXRlIGludCBfZmllbGRQb3MgPSAwOwogICAgcHJpdmF0ZSBp\nbnQgX2Nsc1BvcyA9IDA7CiAgICBwcml2YXRlIGludCBfYWNjZXNzID0gQ2xh\nc3NNZXRhRGF0YS5BQ0NFU1NfVU5LTk9XTjsKICAgIHByaXZhdGUgUGVyc2lz\ndGVuY2VTdHJhdGVneSBfc3RyYXRlZ3kgPSBudWxsOwogICAgcHJpdmF0ZSBT\nZXQ8Q2FzY2FkZVR5cGU+IF9jYXNjYWRlcyA9IG51bGw7CiAgICBwcml2YXRl\nIFNldDxDYXNjYWRlVHlwZT4gX3BrZ0Nhc2NhZGVzID0gbnVsbDsKCiAgICBw\ncml2YXRlIENsYXNzIF9saXN0ZW5lciA9IG51bGw7CiAgICBwcml2YXRlIENv\nbGxlY3Rpb248TGlmZWN5Y2xlQ2FsbGJhY2tzPltdIF9jYWxsYmFja3MgPSBu\ndWxsOwogICAgcHJpdmF0ZSBpbnRbXSBfaGlnaHMgPSBudWxsOwoKICAgIC8q\nKgogICAgICogQ29uc3RydWN0b3I7IHN1cHBseSBjb25maWd1cmF0aW9uLgog\nICAgICovCiAgICBwdWJsaWMgWE1MUGVyc2lzdGVuY2VNZXRhRGF0YVBhcnNl\ncihPcGVuSlBBQ29uZmlndXJhdGlvbiBjb25mKSB7CiAgICAgICAgX2NvbmYg\nPSBjb25mOwogICAgICAgIHNldFZhbGlkYXRpbmcodHJ1ZSk7CiAgICAgICAg\nc2V0TG9nKGNvbmYuZ2V0TG9nKE9wZW5KUEFDb25maWd1cmF0aW9uLkxPR19N\nRVRBREFUQSkpOwogICAgICAgIHNldFBhcnNlQ29tbWVudHModHJ1ZSk7CiAg\nICAgICAgc2V0TW9kZShNT0RFX01FVEEgfCBNT0RFX01BUFBJTkcgfCBNT0RF\nX1FVRVJZKTsKICAgICAgICBzZXRQYXJzZVRleHQodHJ1ZSk7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBDb25maWd1cmF0aW9uIHN1cHBsaWVkIG9uIGNvbnN0\ncnVjdGlvbi4KICAgICAqLwogICAgcHVibGljIE9wZW5KUEFDb25maWd1cmF0\naW9uIGdldENvbmZpZ3VyYXRpb24oKSB7CiAgICAgICAgcmV0dXJuIF9jb25m\nOwogICAgfQoKICAgIC8qKgogICAgICogVGhlIGFubm90YXRpb24gcGFyc2Vy\nLiBXaGVuIGNsYXNzIGlzIGRpc2NvdmVyZWQgaW4gYW4gWE1MIGZpbGUsCiAg\nICAgKiB3ZSBmaXJzdCBwYXJzZSBhbnkgYW5ub3RhdGlvbnMgcHJlc2VudCwg\ndGhlbiBvdmVycmlkZSB3aXRoIHRoZSBYTUwuCiAgICAgKi8KICAgIHB1Ymxp\nYyBBbm5vdGF0aW9uUGVyc2lzdGVuY2VNZXRhRGF0YVBhcnNlciBnZXRBbm5v\ndGF0aW9uUGFyc2VyKCkgewogICAgICAgIHJldHVybiBfcGFyc2VyOwogICAg\nfQoKICAgIC8qKgogICAgICogVGhlIGFubm90YXRpb24gcGFyc2VyLiBXaGVu\nIGNsYXNzIGlzIGRpc2NvdmVyZWQgaW4gYW4gWE1MIGZpbGUsCiAgICAgKiB3\nZSBmaXJzdCBwYXJzZSBhbnkgYW5ub3RhdGlvbnMgcHJlc2VudCwgdGhlbiBv\ndmVycmlkZSB3aXRoIHRoZSBYTUwuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lk\nIHNldEFubm90YXRpb25QYXJzZXIoQW5ub3RhdGlvblBlcnNpc3RlbmNlTWV0\nYURhdGFQYXJzZXIgcGFyc2VyKXsKICAgICAgICBfcGFyc2VyID0gcGFyc2Vy\nOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJucyB0aGUgcmVwb3NpdG9y\neSBmb3IgdGhpcyBwYXJzZXIuIElmIG5vbmUgaGFzIGJlZW4gc2V0LCBjcmVh\ndGVzCiAgICAgKiBhIG5ldyByZXBvc2l0b3J5IGFuZCBzZXRzIGl0LgogICAg\nICovCiAgICBwdWJsaWMgTWV0YURhdGFSZXBvc2l0b3J5IGdldFJlcG9zaXRv\ncnkoKSB7CiAgICAgICAgaWYgKF9yZXBvcyA9PSBudWxsKSB7CiAgICAgICAg\nICAgIE1ldGFEYXRhUmVwb3NpdG9yeSByZXBvcyA9IF9jb25mLm5ld01ldGFE\nYXRhUmVwb3NpdG9yeUluc3RhbmNlKCk7CiAgICAgICAgICAgIE1ldGFEYXRh\nRmFjdG9yeSBtZGYgPSByZXBvcy5nZXRNZXRhRGF0YUZhY3RvcnkoKTsKICAg\nICAgICAgICAgaWYgKG1kZiBpbnN0YW5jZW9mIERlbGVnYXRpbmdNZXRhRGF0\nYUZhY3RvcnkpCiAgICAgICAgICAgICAgICBtZGYgPSAoKERlbGVnYXRpbmdN\nZXRhRGF0YUZhY3RvcnkpIG1kZikuZ2V0SW5uZXJtb3N0RGVsZWdhdGUoKTsK\nICAgICAgICAgICAgaWYgKG1kZiBpbnN0YW5jZW9mIFBlcnNpc3RlbmNlTWV0\nYURhdGFGYWN0b3J5KQogICAgICAgICAgICAgICAgKChQZXJzaXN0ZW5jZU1l\ndGFEYXRhRmFjdG9yeSkgbWRmKS5zZXRYTUxQYXJzZXIodGhpcyk7CiAgICAg\nICAgICAgIF9yZXBvcyA9IHJlcG9zOwogICAgICAgIH0KICAgICAgICByZXR1\ncm4gX3JlcG9zOwogICAgfQoKICAgIC8qKgogICAgICogU2V0IHRoZSBtZXRh\nZGF0YSByZXBvc2l0b3J5IGZvciB0aGlzIHBhcnNlci4KICAgICAqLwogICAg\ncHVibGljIHZvaWQgc2V0UmVwb3NpdG9yeShNZXRhRGF0YVJlcG9zaXRvcnkg\ncmVwb3MpIHsKICAgICAgICBfcmVwb3MgPSByZXBvczsKICAgICAgICBpZiAo\ncmVwb3MgIT0gbnVsbAogICAgICAgICAgICAmJiAocmVwb3MuZ2V0VmFsaWRh\ndGUoKSAmIHJlcG9zLlZBTElEQVRFX1JVTlRJTUUpICE9IDApCiAgICAgICAg\nICAgIHNldFBhcnNlQ29tbWVudHMoZmFsc2UpOwogICAgfQoKICAgIC8qKgog\nICAgICogUmV0dXJuIHRoZSBlbnZpcm9ubWVudGFsIGNsYXNzIGxvYWRlciB0\nbyBwYXNzIG9uIHRvIHBhcnNlZAogICAgICogbWV0YWRhdGEgaW5zdGFuY2Vz\nLgogICAgICovCiAgICBwdWJsaWMgQ2xhc3NMb2FkZXIgZ2V0RW52Q2xhc3NM\nb2FkZXIoKSB7CiAgICAgICAgcmV0dXJuIF9lbnZMb2FkZXI7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBTZXQgdGhlIGVudmlyb25tZW50YWwgY2xhc3MgbG9h\nZGVyIHRvIHBhc3Mgb24gdG8gcGFyc2VkCiAgICAgKiBtZXRhZGF0YSBpbnN0\nYW5jZXMuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldEVudkNsYXNzTG9h\nZGVyKENsYXNzTG9hZGVyIGxvYWRlcikgewogICAgICAgIF9lbnZMb2FkZXIg\nPSBsb2FkZXI7CiAgICB9CgogICAgLyoqCiAgICAgKiBXaGV0aGVyIHRvIGFs\nbG93IGxhdGVyIHBhcnNlcyBvZiBtYXBwaW5nIGluZm9ybWF0aW9uIHRvIG92\nZXJyaWRlCiAgICAgKiBlYXJsaWVyIGluZm9ybWF0aW9uIGZvciB0aGUgc2Ft\nZSBjbGFzcy4gRGVmYXVsdHMgdG8gZmFsc2UuIFVzZWZ1bAogICAgICogd2hl\nbiBhIHRvb2wgaXMgbWFwcGluZyBhIGNsYXNzLCBzbyB0aGF0IC5qZG8gZmls\nZSBwYXJ0aWFsIG1hcHBpbmcKICAgICAqIGluZm9ybWF0aW9uIGNhbiBiZSB1\nc2VkIGV2ZW4gd2hlbiBtYXBwaW5ncyBhcmUgc3RvcmVkIGluIC5vcm0gZmls\nZXMKICAgICAqIG9yIG90aGVyIGxvY2F0aW9ucy4KICAgICAqLwogICAgcHVi\nbGljIGJvb2xlYW4gZ2V0TWFwcGluZ092ZXJyaWRlKCkgewogICAgICAgIHJl\ndHVybiBfb3ZlcnJpZGU7CiAgICB9CgogICAgLyoqCiAgICAgKiBXaGV0aGVy\nIHRvIGFsbG93IGxhdGVyIHBhcnNlcyBvZiBtYXBwaW5nIGluZm9ybWF0aW9u\nIHRvIG92ZXJyaWRlCiAgICAgKiBlYXJsaWVyIGluZm9ybWF0aW9uIGZvciB0\naGUgc2FtZSBjbGFzcy4gRGVmYXVsdHMgdG8gZmFsc2UuIFVzZWZ1bAogICAg\nICogd2hlbiBhIHRvb2wgaXMgbWFwcGluZyBhIGNsYXNzLCBzbyB0aGF0IC5q\nZG8gZmlsZSBwYXJ0aWFsIG1hcHBpbmcKICAgICAqIGluZm9ybWF0aW9uIGNh\nbiBiZSB1c2VkIGV2ZW4gd2hlbiBtYXBwaW5ncyBhcmUgc3RvcmVkIGluIC5v\ncm0gZmlsZXMKICAgICAqIG9yIG90aGVyIGxvY2F0aW9ucy4KICAgICAqLwog\nICAgcHVibGljIHZvaWQgc2V0TWFwcGluZ092ZXJyaWRlKGJvb2xlYW4gb3Zl\ncnJpZGUpIHsKICAgICAgICBfb3ZlcnJpZGUgPSBvdmVycmlkZTsKICAgIH0K\nCiAgICAvKioKICAgICAqIFRoZSBwYXJzZSBtb2RlIGFjY29yZGluZyB0byB0\naGUgZXhwZWN0ZWQgZG9jdW1lbnQgdHlwZS4gVGhlCiAgICAgKiBtb2RlIGNv\nbnN0YW50cyBhY3QgYXMgYml0IGZsYWdzLCBhbmQgdGhlcmVmb3JlIGNhbiBi\nZSBjb21iaW5lZC4KICAgICAqLwogICAgcHVibGljIGludCBnZXRNb2RlKCkg\newogICAgICAgIHJldHVybiBfbW9kZTsKICAgIH0KCiAgICAvKioKICAgICAq\nIFRoZSBwYXJzZSBtb2RlIGFjY29yZGluZyB0byB0aGUgZXhwZWN0ZWQgZG9j\ndW1lbnQgdHlwZS4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0TW9kZShp\nbnQgbW9kZSwgYm9vbGVhbiBvbikgewogICAgICAgIGlmIChtb2RlID09IE1P\nREVfTk9ORSkKICAgICAgICAgICAgc2V0TW9kZShNT0RFX05PTkUpOwogICAg\nICAgIGVsc2UgaWYgKG9uKQogICAgICAgICAgICBzZXRNb2RlKF9tb2RlIHwg\nbW9kZSk7CiAgICAgICAgZWxzZQogICAgICAgICAgICBzZXRNb2RlKF9tb2Rl\nICYgfm1vZGUpOwogICAgfQoKICAgIC8qKgogICAgICogVGhlIHBhcnNlIG1v\nZGUgYWNjb3JkaW5nIHRvIHRoZSBleHBlY3RlZCBkb2N1bWVudCB0eXBlLgog\nICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRNb2RlKGludCBtb2RlKSB7CiAg\nICAgICAgX21vZGUgPSBtb2RlOwogICAgICAgIGlmIChfcGFyc2VyICE9IG51\nbGwpCiAgICAgICAgICAgIF9wYXJzZXIuc2V0TW9kZShtb2RlKTsKICAgIH0K\nCiAgICAvKioKICAgICAqIENvbnZlbmllbmNlIG1ldGhvZCBmb3IgaW50ZXJw\ncmV0aW5nIHtAbGluayAjZ2V0TW9kZX0uCiAgICAgKi8KICAgIHByb3RlY3Rl\nZCBib29sZWFuIGlzTWV0YURhdGFNb2RlKCkgewogICAgICAgIHJldHVybiAo\nX21vZGUgJiBNT0RFX01FVEEpICE9IDA7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBDb252ZW5pZW5jZSBtZXRob2QgZm9yIGludGVycHJldGluZyB7QGxpbmsg\nI2dldE1vZGV9LgogICAgICovCiAgICBwcm90ZWN0ZWQgYm9vbGVhbiBpc1F1\nZXJ5TW9kZSgpIHsKICAgICAgICByZXR1cm4gKF9tb2RlICYgTU9ERV9RVUVS\nWSkgIT0gMDsKICAgIH0KCiAgICAvKioKICAgICAqIENvbnZlbmllbmNlIG1l\ndGhvZCBmb3IgaW50ZXJwcmV0aW5nIHtAbGluayAjZ2V0TW9kZX0uCiAgICAg\nKi8KICAgIHByb3RlY3RlZCBib29sZWFuIGlzTWFwcGluZ01vZGUoKSB7CiAg\nICAgICAgcmV0dXJuIChfbW9kZSAmIE1PREVfTUFQUElORykgIT0gMDsKICAg\nIH0KCiAgICAvKioKICAgICAqIFJldHVybnMgdHJ1ZSBpZiB3ZSdyZSBpbiBt\nYXBwaW5nIG1vZGUgb3IgaW4gbWV0YWRhdGEgbW9kZSB3aXRoCiAgICAgKiBt\nYXBwaW5nIG92ZXJyaWRlIGVuYWJsZWQuCiAgICAgKi8KICAgIHByb3RlY3Rl\nZCBib29sZWFuIGlzTWFwcGluZ092ZXJyaWRlTW9kZSgpIHsKICAgICAgICBy\nZXR1cm4gaXNNYXBwaW5nTW9kZSgpIHx8IChfb3ZlcnJpZGUgJiYgaXNNZXRh\nRGF0YU1vZGUoKSk7CiAgICB9CgogICAgLy8vLy8vLy8vLy8vLy8vCiAgICAv\nLyBYTUwgcGFyc2luZwogICAgLy8vLy8vLy8vLy8vLy8vCgogICAgLyoqCiAg\nICAgKiBQdXNoIGEgcGFyc2UgZWxlbWVudCBvbnRvIHRoZSBzdGFjay4KICAg\nICAqLwogICAgcHJvdGVjdGVkIHZvaWQgcHVzaEVsZW1lbnQoT2JqZWN0IGVs\nZW0pIHsKICAgICAgICBfZWxlbWVudHMucHVzaChlbGVtKTsKICAgIH0KCiAg\nICAvKioKICAgICAqIFBvcCBhIHBhcnNlIGVsZW1lbnQgZnJvbSB0aGUgc3Rh\nY2suCiAgICAgKi8KICAgIHByb3RlY3RlZCBPYmplY3QgcG9wRWxlbWVudCgp\nIHsKICAgICAgICByZXR1cm4gX2VsZW1lbnRzLnBvcCgpOwogICAgfQoKICAg\nIC8qKgogICAgICogUmV0dXJuIHRoZSBjdXJyZW50IGVsZW1lbnQgYmVpbmcg\ncGFyc2VkLiBNYXkgYmUgYSBjbGFzcyBtZXRhZGF0YSwKICAgICAqIGZpZWxk\nIG1ldGFkYXRhLCBxdWVyeSBtZXRhZGF0YSwgZXRjLgogICAgICovCiAgICBw\ncm90ZWN0ZWQgT2JqZWN0IGN1cnJlbnRFbGVtZW50KCkgewogICAgICAgIGlm\nIChfZWxlbWVudHMuaXNFbXB0eSgpKQogICAgICAgICAgICByZXR1cm4gbnVs\nbDsKICAgICAgICByZXR1cm4gX2VsZW1lbnRzLnBlZWsoKTsKICAgIH0KCiAg\nICAvKioKICAgICAqIFJldHVybiB0aGUgY3VycmVudCB7QGxpbmsgUGVyc2lz\ndGVuY2VTdHJhdGVneX0gaWYgYW55LgogICAgICovCiAgICBwcm90ZWN0ZWQg\nUGVyc2lzdGVuY2VTdHJhdGVneSBjdXJyZW50U3RyYXRlZ3koKSB7CiAgICAg\nICAgcmV0dXJuIF9zdHJhdGVneTsKICAgIH0KCiAgICAvKioKICAgICAqIFJl\ndHVybiB0aGUgdGFnIG9mIHRoZSBjdXJyZW50IHBhcmVudCBlbGVtZW50Lgog\nICAgICovCiAgICBwcm90ZWN0ZWQgT2JqZWN0IGN1cnJlbnRQYXJlbnQoKSB7\nCiAgICAgICAgaWYgKF9wYXJlbnRzLmlzRW1wdHkoKSkKICAgICAgICAgICAg\ncmV0dXJuIG51bGw7CiAgICAgICAgcmV0dXJuIF9wYXJlbnRzLnBlZWsoKTsK\nICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB3aGV0aGVyIHdlJ3JlIHJ1\nbm5pbmcgdGhlIHBhcnNlciBhdCBydW50aW1lLgogICAgICovCiAgICBwcm90\nZWN0ZWQgYm9vbGVhbiBpc1J1bnRpbWUoKSB7CiAgICAgICAgcmV0dXJuIChn\nZXRSZXBvc2l0b3J5KCkuZ2V0VmFsaWRhdGUoKQogICAgICAgICAgICAmIE1l\ndGFEYXRhUmVwb3NpdG9yeS5WQUxJREFURV9SVU5USU1FKSAhPSAwOwogICAg\nfQoKICAgIEBPdmVycmlkZQogICAgcHJvdGVjdGVkIE9iamVjdCBnZXRTY2hl\nbWFTb3VyY2UoKSB7CiAgICAgICAgcmV0dXJuIFhNTFBlcnNpc3RlbmNlTWV0\nYURhdGFQYXJzZXIuY2xhc3MuZ2V0UmVzb3VyY2VBc1N0cmVhbQogICAgICAg\nICAgICAoIm9ybS14c2QucnNyYyIpOwogICAgfQoKICAgIEBPdmVycmlkZQog\nICAgcHJvdGVjdGVkIFN0cmluZyBnZXRQYWNrYWdlQXR0cmlidXRlTmFtZSgp\nIHsKICAgICAgICByZXR1cm4gbnVsbDsKICAgIH0KCiAgICBAT3ZlcnJpZGUK\nICAgIHByb3RlY3RlZCBTdHJpbmcgZ2V0Q2xhc3NBdHRyaWJ1dGVOYW1lKCkg\newogICAgICAgIHJldHVybiAiY2xhc3MiOwogICAgfQoKICAgIEBPdmVycmlk\nZQogICAgcHJvdGVjdGVkIGludCBnZXRDbGFzc0VsZW1lbnREZXB0aCgpIHsK\nICAgICAgICByZXR1cm4gMTsKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHBy\nb3RlY3RlZCBib29sZWFuIGlzQ2xhc3NFbGVtZW50TmFtZShTdHJpbmcgbmFt\nZSkgewogICAgICAgIHJldHVybiAiZW50aXR5Ii5lcXVhbHMobmFtZSkKICAg\nICAgICAgICAgfHwgImVtYmVkZGFibGUiLmVxdWFscyhuYW1lKQogICAgICAg\nICAgICB8fCAibWFwcGVkLXN1cGVyY2xhc3MiLmVxdWFscyhuYW1lKTsKICAg\nIH0KCiAgICBAT3ZlcnJpZGUKICAgIHByb3RlY3RlZCB2b2lkIHJlc2V0KCkg\newogICAgICAgIHN1cGVyLnJlc2V0KCk7CiAgICAgICAgX2VsZW1lbnRzLmNs\nZWFyKCk7CiAgICAgICAgX3BhcmVudHMuY2xlYXIoKTsKICAgICAgICBfY2xz\nID0gbnVsbDsKICAgICAgICBfZmllbGRQb3MgPSAwOwogICAgICAgIF9jbHNQ\nb3MgPSAwOwoKICAgICAgICBfYWNjZXNzID0gQ2xhc3NNZXRhRGF0YS5BQ0NF\nU1NfVU5LTk9XTjsKICAgICAgICBfc3RyYXRlZ3kgPSBudWxsOwogICAgICAg\nIF9saXN0ZW5lciA9IG51bGw7CiAgICAgICAgX2NhbGxiYWNrcyA9IG51bGw7\nCiAgICAgICAgX2hpZ2hzID0gbnVsbDsKICAgICAgICBfY2FzY2FkZXMgPSBu\ndWxsOwogICAgICAgIF9wa2dDYXNjYWRlcyA9IG51bGw7CiAgICB9CgogICAg\nQE92ZXJyaWRlCiAgICBwcm90ZWN0ZWQgYm9vbGVhbiBzdGFydFN5c3RlbUVs\nZW1lbnQoU3RyaW5nIG5hbWUsIEF0dHJpYnV0ZXMgYXR0cnMpCiAgICAgICAg\ndGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgT2JqZWN0IHRhZyA9IChP\nYmplY3QpIF9lbGVtcy5nZXQobmFtZSk7CiAgICAgICAgYm9vbGVhbiByZXQg\nPSBmYWxzZTsKICAgICAgICBpZiAodGFnID09IG51bGwpIHsKICAgICAgICAg\nICAgaWYgKGlzTWFwcGluZ092ZXJyaWRlTW9kZSgpKQogICAgICAgICAgICAg\nICAgdGFnID0gc3RhcnRTeXN0ZW1NYXBwaW5nRWxlbWVudChuYW1lLCBhdHRy\ncyk7CiAgICAgICAgICAgIHJldCA9IHRhZyAhPSBudWxsOwogICAgICAgIH0g\nZWxzZSBpZiAodGFnIGluc3RhbmNlb2YgTWV0YURhdGFUYWcpIHsKICAgICAg\nICAgICAgc3dpdGNoICgoTWV0YURhdGFUYWcpIHRhZykgewogICAgICAgICAg\nICAgICAgY2FzZSBRVUVSWToKICAgICAgICAgICAgICAgICAgICByZXQgPSBz\ndGFydE5hbWVkUXVlcnkoYXR0cnMpOwogICAgICAgICAgICAgICAgICAgIGJy\nZWFrOwogICAgICAgICAgICAgICAgY2FzZSBRVUVSWV9ISU5UOgogICAgICAg\nICAgICAgICAgICAgIHJldCA9IHN0YXJ0UXVlcnlIaW50KGF0dHJzKTsKICAg\nICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2Ug\nTkFUSVZFX1FVRVJZOgogICAgICAgICAgICAgICAgICAgIHJldCA9IHN0YXJ0\nTmFtZWROYXRpdmVRdWVyeShhdHRycyk7CiAgICAgICAgICAgICAgICAgICAg\nYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIFFVRVJZX1NUUklORzoKICAg\nICAgICAgICAgICAgICAgICByZXQgPSBzdGFydFF1ZXJ5U3RyaW5nKGF0dHJz\nKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAg\nIGNhc2UgU0VRX0dFTkVSQVRPUjoKICAgICAgICAgICAgICAgICAgICByZXQg\nPSBzdGFydFNlcXVlbmNlR2VuZXJhdG9yKGF0dHJzKTsKICAgICAgICAgICAg\nICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgRkxVU0hfTU9E\nRToKICAgICAgICAgICAgICAgICAgICByZXQgPSBzdGFydEZsdXNoTW9kZShh\ndHRycyk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAg\nICAgICBjYXNlIEVOVElUWV9MSVNURU5FUlM6CiAgICAgICAgICAgICAgICAg\nICAgcmV0ID0gc3RhcnRFbnRpdHlMaXN0ZW5lcnMoYXR0cnMpOwogICAgICAg\nICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSBQUkVf\nUEVSU0lTVDoKICAgICAgICAgICAgICAgIGNhc2UgUE9TVF9QRVJTSVNUOgog\nICAgICAgICAgICAgICAgY2FzZSBQUkVfUkVNT1ZFOgogICAgICAgICAgICAg\nICAgY2FzZSBQT1NUX1JFTU9WRToKICAgICAgICAgICAgICAgIGNhc2UgUFJF\nX1VQREFURToKICAgICAgICAgICAgICAgIGNhc2UgUE9TVF9VUERBVEU6CiAg\nICAgICAgICAgICAgICBjYXNlIFBPU1RfTE9BRDoKICAgICAgICAgICAgICAg\nICAgICByZXQgPSBzdGFydENhbGxiYWNrKChNZXRhRGF0YVRhZykgdGFnLCBh\ndHRycyk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAg\nICAgICBkZWZhdWx0OgogICAgICAgICAgICAgICAgICAgIHdhcm5VbnN1cHBv\ncnRlZFRhZyhuYW1lKTsKICAgICAgICAgICAgfQogICAgICAgIH0gZWxzZSBp\nZiAodGFnID09IEVMRU1fUFVfTUVUQSB8fCB0YWcgPT0gRUxFTV9QVV9ERUYp\nCiAgICAgICAgICAgIHJldCA9IGlzTWV0YURhdGFNb2RlKCk7CiAgICAgICAg\nZWxzZSBpZiAodGFnID09IEVMRU1fWE1MX01BUF9NRVRBX0NPTVBMRVRFKQog\nICAgICAgICAgICBzZXRBbm5vdGF0aW9uUGFyc2VyKG51bGwpOwogICAgICAg\nIGVsc2UgaWYgKHRhZyA9PSBFTEVNX0FDQ0VTUykKICAgICAgICAgICAgcmV0\nID0gX21vZGUgIT0gTU9ERV9RVUVSWTsKICAgICAgICBlbHNlIGlmICh0YWcg\nPT0gRUxFTV9MSVNURU5FUikKICAgICAgICAgICAgcmV0ID0gc3RhcnRFbnRp\ndHlMaXN0ZW5lcihhdHRycyk7CiAgICAgICAgZWxzZSBpZiAodGFnID09IEVM\nRU1fQ0FTQ0FERSkKICAgICAgICAgICAgcmV0ID0gaXNNZXRhRGF0YU1vZGUo\nKTsKICAgICAgICBlbHNlIGlmICh0YWcgPT0gRUxFTV9DQVNDQURFX0FMTCB8\nfCB0YWcgPT0gRUxFTV9DQVNDQURFX1BFUgogICAgICAgICAgICB8fCB0YWcg\nPT0gRUxFTV9DQVNDQURFX01FUiB8fCB0YWcgPT0gRUxFTV9DQVNDQURFX1JF\nTQogICAgICAgICAgICB8fCB0YWcgPT0gRUxFTV9DQVNDQURFX1JFRikKICAg\nICAgICAgICAgcmV0ID0gc3RhcnRDYXNjYWRlKHRhZywgYXR0cnMpOwoKICAg\nICAgICBpZiAocmV0KQogICAgICAgICAgICBfcGFyZW50cy5wdXNoKHRhZyk7\nCiAgICAgICAgcmV0dXJuIHJldDsKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAg\nIHByb3RlY3RlZCB2b2lkIGVuZFN5c3RlbUVsZW1lbnQoU3RyaW5nIG5hbWUp\nCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgT2JqZWN0\nIHRhZyA9IF9lbGVtcy5nZXQobmFtZSk7CiAgICAgICAgaWYgKHRhZyA9PSBu\ndWxsICYmIGlzTWFwcGluZ092ZXJyaWRlTW9kZSgpKQogICAgICAgICAgICBl\nbmRTeXN0ZW1NYXBwaW5nRWxlbWVudChuYW1lKTsKICAgICAgICBlbHNlIGlm\nICh0YWcgaW5zdGFuY2VvZiBNZXRhRGF0YVRhZykgewogICAgICAgICAgICBz\nd2l0Y2ggKChNZXRhRGF0YVRhZykgdGFnKSB7CiAgICAgICAgICAgICAgICBj\nYXNlIFFVRVJZOgogICAgICAgICAgICAgICAgICAgIGVuZE5hbWVkUXVlcnko\nKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAg\nIGNhc2UgUVVFUllfSElOVDoKICAgICAgICAgICAgICAgICAgICBlbmRRdWVy\neUhpbnQoKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAg\nICAgICAgIGNhc2UgTkFUSVZFX1FVRVJZOgogICAgICAgICAgICAgICAgICAg\nIGVuZE5hbWVkTmF0aXZlUXVlcnkoKTsKICAgICAgICAgICAgICAgICAgICBi\ncmVhazsKICAgICAgICAgICAgICAgIGNhc2UgUVVFUllfU1RSSU5HOgogICAg\nICAgICAgICAgICAgICAgIGVuZFF1ZXJ5U3RyaW5nKCk7CiAgICAgICAgICAg\nICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIFNFUV9HRU5F\nUkFUT1I6CiAgICAgICAgICAgICAgICAgICAgZW5kU2VxdWVuY2VHZW5lcmF0\nb3IoKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAg\nfQogICAgICAgIH0gZWxzZSBpZiAodGFnID09IEVMRU1fQUNDRVNTKQogICAg\nICAgICAgICBlbmRBY2Nlc3MoKTsKICAgICAgICBlbHNlIGlmICh0YWcgPT0g\nRUxFTV9MSVNURU5FUikKICAgICAgICAgICAgZW5kRW50aXR5TGlzdGVuZXIo\nKTsKCiAgICAgICAgX3BhcmVudHMucG9wKCk7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBJbXBsZW1lbnQgdG8gcGFyc2UgYSBtYXBwaW5nIGVsZW1lbnQgb3V0\nc2lkZSBvZiBhbnkgY2xhc3MuCiAgICAgKgogICAgICogQHJldHVybiB0aGUg\ndGFnIGZvciB0aGUgZ2l2ZW4gZWxlbWVudCwgb3IgbnVsbCB0byBza2lwIHRo\nZSBlbGVtZW50CiAgICAgKi8KICAgIHByb3RlY3RlZCBPYmplY3Qgc3RhcnRT\neXN0ZW1NYXBwaW5nRWxlbWVudChTdHJpbmcgbmFtZSwgQXR0cmlidXRlcyBh\ndHRycykKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICBy\nZXR1cm4gbnVsbDsKICAgIH0KCiAgICAvKioKICAgICAqIEltcGxlbWVudCB0\nbyBwYXJzZSBhIG1hcHBpbmcgZWxlbWVudCBvdXRzaWRlIG9mIGFueSBjbGFz\ncy4KICAgICAqLwogICAgcHJvdGVjdGVkIHZvaWQgZW5kU3lzdGVtTWFwcGlu\nZ0VsZW1lbnQoU3RyaW5nIG5hbWUpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2Vw\ndGlvbiB7CiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwcm90ZWN0ZWQgYm9v\nbGVhbiBzdGFydENsYXNzRWxlbWVudChTdHJpbmcgbmFtZSwgQXR0cmlidXRl\ncyBhdHRycykKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAg\nICBPYmplY3QgdGFnID0gKE9iamVjdCkgX2VsZW1zLmdldChuYW1lKTsKICAg\nICAgICBib29sZWFuIHJldCA9IGZhbHNlOwogICAgICAgIGlmICh0YWcgPT0g\nbnVsbCkgewogICAgICAgICAgICBpZiAoaXNNYXBwaW5nT3ZlcnJpZGVNb2Rl\nKCkpCiAgICAgICAgICAgICAgICB0YWcgPSBzdGFydENsYXNzTWFwcGluZ0Vs\nZW1lbnQobmFtZSwgYXR0cnMpOwogICAgICAgICAgICByZXQgPSB0YWcgIT0g\nbnVsbDsKICAgICAgICB9IGVsc2UgaWYgKHRhZyBpbnN0YW5jZW9mIE1ldGFE\nYXRhVGFnKSB7CiAgICAgICAgICAgIHN3aXRjaCAoKE1ldGFEYXRhVGFnKSB0\nYWcpIHsKICAgICAgICAgICAgICAgIGNhc2UgR0VORVJBVEVEX1ZBTFVFOgog\nICAgICAgICAgICAgICAgICAgIHJldCA9IHN0YXJ0R2VuZXJhdGVkVmFsdWUo\nYXR0cnMpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAg\nICAgICAgY2FzZSBJRDoKICAgICAgICAgICAgICAgICAgICByZXQgPSBzdGFy\ndElkKGF0dHJzKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAg\nICAgICAgICAgIGNhc2UgRU1CRURERURfSUQ6CiAgICAgICAgICAgICAgICAg\nICAgcmV0ID0gc3RhcnRFbWJlZGRlZElkKGF0dHJzKTsKICAgICAgICAgICAg\nICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgSURfQ0xBU1M6\nCiAgICAgICAgICAgICAgICAgICAgcmV0ID0gc3RhcnRJZENsYXNzKGF0dHJz\nKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAg\nIGNhc2UgTE9COgogICAgICAgICAgICAgICAgICAgIHJldCA9IHN0YXJ0TG9i\nKGF0dHJzKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAg\nICAgICAgIGNhc2UgUVVFUlk6CiAgICAgICAgICAgICAgICAgICAgcmV0ID0g\nc3RhcnROYW1lZFF1ZXJ5KGF0dHJzKTsKICAgICAgICAgICAgICAgICAgICBi\ncmVhazsKICAgICAgICAgICAgICAgIGNhc2UgUVVFUllfSElOVDoKICAgICAg\nICAgICAgICAgICAgICByZXQgPSBzdGFydFF1ZXJ5SGludChhdHRycyk7CiAg\nICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNl\nIE5BVElWRV9RVUVSWToKICAgICAgICAgICAgICAgICAgICByZXQgPSBzdGFy\ndE5hbWVkTmF0aXZlUXVlcnkoYXR0cnMpOwogICAgICAgICAgICAgICAgICAg\nIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSBRVUVSWV9TVFJJTkc6CiAg\nICAgICAgICAgICAgICAgICAgcmV0ID0gc3RhcnRRdWVyeVN0cmluZyhhdHRy\ncyk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAg\nICBjYXNlIFNFUV9HRU5FUkFUT1I6CiAgICAgICAgICAgICAgICAgICAgcmV0\nID0gc3RhcnRTZXF1ZW5jZUdlbmVyYXRvcihhdHRycyk7CiAgICAgICAgICAg\nICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIFZFUlNJT046\nCiAgICAgICAgICAgICAgICAgICAgcmV0ID0gc3RhcnRWZXJzaW9uKGF0dHJz\nKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAg\nIGNhc2UgTUFQX0tFWToKICAgICAgICAgICAgICAgICAgICByZXQgPSBzdGFy\ndE1hcEtleShhdHRycyk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAg\nICAgICAgICAgICAgICBjYXNlIEZMVVNIX01PREU6CiAgICAgICAgICAgICAg\nICAgICAgcmV0ID0gc3RhcnRGbHVzaE1vZGUoYXR0cnMpOwogICAgICAgICAg\nICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSBPUkRFUl9C\nWToKICAgICAgICAgICAgICAgIGNhc2UgRU5USVRZX0xJU1RFTkVSUzoKICAg\nICAgICAgICAgICAgICAgICByZXQgPSBpc01ldGFEYXRhTW9kZSgpOwogICAg\nICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSBF\nWENMVURFX0RFRkFVTFRfTElTVEVORVJTOgogICAgICAgICAgICAgICAgICAg\nIHJldCA9IHN0YXJ0RXhjbHVkZURlZmF1bHRMaXN0ZW5lcnMoYXR0cnMpOwog\nICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2Fz\nZSBFWENMVURFX1NVUEVSQ0xBU1NfTElTVEVORVJTOgogICAgICAgICAgICAg\nICAgICAgIHJldCA9IHN0YXJ0RXhjbHVkZVN1cGVyY2xhc3NMaXN0ZW5lcnMo\nYXR0cnMpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAg\nICAgICAgY2FzZSBQUkVfUEVSU0lTVDoKICAgICAgICAgICAgICAgIGNhc2Ug\nUE9TVF9QRVJTSVNUOgogICAgICAgICAgICAgICAgY2FzZSBQUkVfUkVNT1ZF\nOgogICAgICAgICAgICAgICAgY2FzZSBQT1NUX1JFTU9WRToKICAgICAgICAg\nICAgICAgIGNhc2UgUFJFX1VQREFURToKICAgICAgICAgICAgICAgIGNhc2Ug\nUE9TVF9VUERBVEU6CiAgICAgICAgICAgICAgICBjYXNlIFBPU1RfTE9BRDoK\nICAgICAgICAgICAgICAgICAgICByZXQgPSBzdGFydENhbGxiYWNrKChNZXRh\nRGF0YVRhZykgdGFnLCBhdHRycyk7CiAgICAgICAgICAgICAgICAgICAgYnJl\nYWs7CiAgICAgICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgICAg\nICAgIHdhcm5VbnN1cHBvcnRlZFRhZyhuYW1lKTsKICAgICAgICAgICAgfQog\nICAgICAgIH0gZWxzZSBpZiAodGFnIGluc3RhbmNlb2YgUGVyc2lzdGVuY2VT\ndHJhdGVneSkgewogICAgICAgICAgICBQZXJzaXN0ZW5jZVN0cmF0ZWd5IHBz\nID0gKFBlcnNpc3RlbmNlU3RyYXRlZ3kpIHRhZzsKICAgICAgICAgICAgcmV0\nID0gc3RhcnRTdHJhdGVneShwcywgYXR0cnMpOwogICAgICAgICAgICBpZiAo\ncmV0KQogICAgICAgICAgICAgICAgX3N0cmF0ZWd5ID0gcHM7CiAgICAgICAg\nfSBlbHNlIGlmICh0YWcgPT0gRUxFTV9MSVNURU5FUikKICAgICAgICAgICAg\ncmV0ID0gc3RhcnRFbnRpdHlMaXN0ZW5lcihhdHRycyk7CiAgICAgICAgZWxz\nZSBpZiAodGFnID09IEVMRU1fQVRUUlMpCiAgICAgICAgICAgIHJldCA9IF9t\nb2RlICE9IE1PREVfUVVFUlk7CiAgICAgICAgZWxzZSBpZiAodGFnID09IEVM\nRU1fQ0FTQ0FERSkKICAgICAgICAgICAgcmV0ID0gaXNNZXRhRGF0YU1vZGUo\nKTsKICAgICAgICBlbHNlIGlmICh0YWcgPT0gRUxFTV9DQVNDQURFX0FMTCB8\nfCB0YWcgPT0gRUxFTV9DQVNDQURFX1BFUgogICAgICAgICAgICB8fCB0YWcg\nPT0gRUxFTV9DQVNDQURFX01FUiB8fCB0YWcgPT0gRUxFTV9DQVNDQURFX1JF\nTQogICAgICAgICAgICB8fCB0YWcgPT0gRUxFTV9DQVNDQURFX1JFRikKICAg\nICAgICAgICAgcmV0ID0gc3RhcnRDYXNjYWRlKHRhZywgYXR0cnMpOwoKICAg\nICAgICBpZiAocmV0KQogICAgICAgICAgICBfcGFyZW50cy5wdXNoKHRhZyk7\nCiAgICAgICAgcmV0dXJuIHJldDsKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAg\nIHByb3RlY3RlZCB2b2lkIGVuZENsYXNzRWxlbWVudChTdHJpbmcgbmFtZSkK\nICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICBPYmplY3Qg\ndGFnID0gX2VsZW1zLmdldChuYW1lKTsKICAgICAgICBpZiAodGFnID09IG51\nbGwgJiYgaXNNYXBwaW5nT3ZlcnJpZGVNb2RlKCkpCiAgICAgICAgICAgIGVu\nZENsYXNzTWFwcGluZ0VsZW1lbnQobmFtZSk7CiAgICAgICAgZWxzZSBpZiAo\ndGFnIGluc3RhbmNlb2YgTWV0YURhdGFUYWcpIHsKICAgICAgICAgICAgc3dp\ndGNoICgoTWV0YURhdGFUYWcpIHRhZykgewogICAgICAgICAgICAgICAgY2Fz\nZSBHRU5FUkFURURfVkFMVUU6CiAgICAgICAgICAgICAgICAgICAgZW5kR2Vu\nZXJhdGVkVmFsdWUoKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAg\nICAgICAgICAgICAgIGNhc2UgSUQ6CiAgICAgICAgICAgICAgICAgICAgZW5k\nSWQoKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAg\nICAgIGNhc2UgRU1CRURERURfSUQ6CiAgICAgICAgICAgICAgICAgICAgZW5k\nRW1iZWRkZWRJZCgpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAg\nICAgICAgICAgICAgY2FzZSBJRF9DTEFTUzoKICAgICAgICAgICAgICAgICAg\nICBlbmRJZENsYXNzKCk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAg\nICAgICAgICAgICAgICBjYXNlIExPQjoKICAgICAgICAgICAgICAgICAgICBl\nbmRMb2IoKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAg\nICAgICAgIGNhc2UgUVVFUlk6CiAgICAgICAgICAgICAgICAgICAgZW5kTmFt\nZWRRdWVyeSgpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAg\nICAgICAgICAgY2FzZSBRVUVSWV9ISU5UOgogICAgICAgICAgICAgICAgICAg\nIGVuZFF1ZXJ5SGludCgpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwog\nICAgICAgICAgICAgICAgY2FzZSBOQVRJVkVfUVVFUlk6CiAgICAgICAgICAg\nICAgICAgICAgZW5kTmFtZWROYXRpdmVRdWVyeSgpOwogICAgICAgICAgICAg\nICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSBRVUVSWV9TVFJJ\nTkc6CiAgICAgICAgICAgICAgICAgICAgZW5kUXVlcnlTdHJpbmcoKTsKICAg\nICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2Ug\nU0VRX0dFTkVSQVRPUjoKICAgICAgICAgICAgICAgICAgICBlbmRTZXF1ZW5j\nZUdlbmVyYXRvcigpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAg\nICAgICAgICAgICAgY2FzZSBWRVJTSU9OOgogICAgICAgICAgICAgICAgICAg\nIGVuZFZlcnNpb24oKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAg\nICAgICAgICAgICAgIGNhc2UgT1JERVJfQlk6CiAgICAgICAgICAgICAgICAg\nICAgZW5kT3JkZXJCeSgpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwog\nICAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIGlmICh0YWcgaW5zdGFuY2Vv\nZiBQZXJzaXN0ZW5jZVN0cmF0ZWd5KQogICAgICAgICAgICBlbmRTdHJhdGVn\neSgoUGVyc2lzdGVuY2VTdHJhdGVneSkgdGFnKTsKICAgICAgICBlbHNlIGlm\nICh0YWcgPT0gRUxFTV9BQ0NFU1MpCiAgICAgICAgICAgIGVuZEFjY2Vzcygp\nOwogICAgICAgIGVsc2UgaWYgKHRhZyA9PSBFTEVNX0xJU1RFTkVSKQogICAg\nICAgICAgICBlbmRFbnRpdHlMaXN0ZW5lcigpOwoKICAgICAgICBfcGFyZW50\ncy5wb3AoKTsKICAgIH0KCiAgICAvKioKICAgICAqIExvZyB3YXJuaW5nIGFi\nb3V0IGFuIHVuc3VwcG9ydGVkIHRhZy4KICAgICAqLwogICAgcHJpdmF0ZSB2\nb2lkIHdhcm5VbnN1cHBvcnRlZFRhZyhTdHJpbmcgbmFtZSkgewogICAgICAg\nIExvZyBsb2cgPSBnZXRMb2coKTsKICAgICAgICBpZiAobG9nLmlzSW5mb0Vu\nYWJsZWQoKSkKICAgICAgICAgICAgbG9nLnRyYWNlKF9sb2MuZ2V0KCJ1bnN1\ncHBvcnRlZC10YWciLCBuYW1lKSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBJ\nbXBsZW1lbnQgdG8gcGFyc2UgYSBtYXBwaW5nIGVsZW1lbnQgd2l0aGluIGEg\nY2xhc3MuCiAgICAgKgogICAgICogQHJldHVybiB0aGUgdGFnIGZvciB0aGUg\nZ2l2ZW4gZWxlbWVudCwgb3IgbnVsbCB0byBza2lwIGVsZW1lbnQKICAgICAq\nLwogICAgcHJvdGVjdGVkIE9iamVjdCBzdGFydENsYXNzTWFwcGluZ0VsZW1l\nbnQoU3RyaW5nIG5hbWUsIEF0dHJpYnV0ZXMgYXR0cnMpCiAgICAgICAgdGhy\nb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBJbXBsZW1lbnQgdG8gcGFyc2UgYSBtYXBwaW5n\nIGVsZW1lbnQgd2l0aGluIGEgY2xhc3MuCiAgICAgKi8KICAgIHByb3RlY3Rl\nZCB2b2lkIGVuZENsYXNzTWFwcGluZ0VsZW1lbnQoU3RyaW5nIG5hbWUpCiAg\nICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICB9CgogICAgQE92ZXJy\naWRlCiAgICBwcm90ZWN0ZWQgYm9vbGVhbiBzdGFydENsYXNzKFN0cmluZyBl\nbGVtLCBBdHRyaWJ1dGVzIGF0dHJzKQogICAgICAgIHRocm93cyBTQVhFeGNl\ncHRpb24gewogICAgICAgIHN1cGVyLnN0YXJ0Q2xhc3MoZWxlbSwgYXR0cnMp\nOwoKICAgICAgICAvLyBxdWVyeSBtb2RlIG9ubHk/CiAgICAgICAgX2NscyA9\nIGNsYXNzRm9yTmFtZShjdXJyZW50Q2xhc3NOYW1lKCkpOwogICAgICAgIGlm\nIChfbW9kZSA9PSBNT0RFX1FVRVJZKSB7CiAgICAgICAgICAgIGlmIChfcGFy\nc2VyICE9IG51bGwgJiYKICAgICAgICAgICAgICAgICEidHJ1ZSIuZXF1YWxz\nKGF0dHJzLmdldFZhbHVlKCJtZXRhZGF0YS1jb21wbGV0ZSIpKSkKICAgICAg\nICAgICAgICAgIF9wYXJzZXIucGFyc2UoX2Nscyk7CiAgICAgICAgICAgIHJl\ndHVybiB0cnVlOwogICAgICAgIH0KCiAgICAgICAgTG9nIGxvZyA9IGdldExv\nZygpOwogICAgICAgIGlmIChsb2cuaXNUcmFjZUVuYWJsZWQoKSkKICAgICAg\nICAgICAgbG9nLnRyYWNlKF9sb2MuZ2V0KCJwYXJzZS1jbGFzcyIsIF9jbHMu\nZ2V0TmFtZSgpKSk7CgogICAgICAgIE1ldGFEYXRhUmVwb3NpdG9yeSByZXBv\ncyA9IGdldFJlcG9zaXRvcnkoKTsKICAgICAgICBDbGFzc01ldGFEYXRhIG1l\ndGEgPSByZXBvcy5nZXRDYWNoZWRNZXRhRGF0YShfY2xzKTsKICAgICAgICBp\nZiAobWV0YSAhPSBudWxsCiAgICAgICAgICAgICYmICgoaXNNZXRhRGF0YU1v\nZGUoKSAmJiAobWV0YS5nZXRTb3VyY2VNb2RlKCkgJiBNT0RFX01FVEEpICE9\nIDApCiAgICAgICAgICAgIHx8IChpc01hcHBpbmdNb2RlKCkgJiYgKG1ldGEu\nZ2V0U291cmNlTW9kZSgpICYgTU9ERV9NQVBQSU5HKSAhPSAwKSkpCiAgICAg\nICAgewogICAgICAgICAgICBpZiAobG9nLmlzV2FybkVuYWJsZWQoKSkKICAg\nICAgICAgICAgICAgIGxvZy53YXJuKF9sb2MuZ2V0KCJkdXAtbWV0YWRhdGEi\nLCBfY2xzLCBnZXRTb3VyY2VOYW1lKCkpKTsKICAgICAgICAgICAgX2NscyA9\nIG51bGw7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9Cgog\nICAgICAgIC8vIGlmIHdlIGRvbid0IGtub3cgdGhlIGFjY2VzcyB0eXBlLCBj\naGVjayB0byBzZWUgaWYgYSBzdXBlcmNsYXNzCiAgICAgICAgLy8gaGFzIGFs\ncmVhZHkgZGVmaW5lZCB0aGUgYWNjZXNzIHR5cGUKICAgICAgICBpbnQgZGVm\nYXVsdEFjY2VzcyA9IF9hY2Nlc3M7CiAgICAgICAgaWYgKGRlZmF1bHRBY2Nl\nc3MgPT0gQ2xhc3NNZXRhRGF0YS5BQ0NFU1NfVU5LTk9XTikgewogICAgICAg\nICAgICBDbGFzc01ldGFEYXRhIHN1cCA9IHJlcG9zLmdldENhY2hlZE1ldGFE\nYXRhKF9jbHMuZ2V0U3VwZXJjbGFzcygpKTsKICAgICAgICAgICAgaWYgKHN1\ncCAhPSBudWxsKQogICAgICAgICAgICAgICAgZGVmYXVsdEFjY2VzcyA9IHN1\ncC5nZXRBY2Nlc3NUeXBlKCk7CiAgICAgICAgfQoKICAgICAgICBpZiAobWV0\nYSA9PSBudWxsKSB7CiAgICAgICAgICAgIC8vIGFkZCBtZXRhZGF0YSBmb3Ig\ndGhpcyB0eXBlCiAgICAgICAgICAgIGludCBhY2Nlc3MgPSB0b0FjY2Vzc1R5\ncGUoYXR0cnMuZ2V0VmFsdWUoImFjY2VzcyIpLCBkZWZhdWx0QWNjZXNzKTsK\nICAgICAgICAgICAgbWV0YSA9IHJlcG9zLmFkZE1ldGFEYXRhKF9jbHMsIGFj\nY2Vzcyk7CiAgICAgICAgICAgIG1ldGEuc2V0RW52Q2xhc3NMb2FkZXIoX2Vu\ndkxvYWRlcik7CiAgICAgICAgICAgIG1ldGEuc2V0U291cmNlTW9kZShNT0RF\nX05PTkUpOwoKICAgICAgICAgICAgLy8gcGFyc2UgYW5ub3RhdGlvbnMgZmly\nc3Qgc28gWE1MIG92ZXJyaWRlcyB0aGVtCiAgICAgICAgICAgIGlmIChfcGFy\nc2VyICE9IG51bGwgJiYKICAgICAgICAgICAgICAgICEidHJ1ZSIuZXF1YWxz\nKGF0dHJzLmdldFZhbHVlKCJtZXRhZGF0YS1jb21wbGV0ZSIpKSkKICAgICAg\nICAgICAgICAgIF9wYXJzZXIucGFyc2UoX2Nscyk7CiAgICAgICAgfQoKICAg\nICAgICBib29sZWFuIG1hcHBlZFN1cGVyID0gIm1hcHBlZC1zdXBlcmNsYXNz\nIi5lcXVhbHMoZWxlbSk7CiAgICAgICAgaWYgKGlzTWV0YURhdGFNb2RlKCkp\nIHsKICAgICAgICAgICAgbWV0YS5zZXRTb3VyY2UoZ2V0U291cmNlRmlsZSgp\nLCBtZXRhLlNSQ19YTUwpOwogICAgICAgICAgICBtZXRhLnNldFNvdXJjZU1v\nZGUoTU9ERV9NRVRBLCB0cnVlKTsKICAgICAgICAgICAgbWV0YS5zZXRMaXN0\naW5nSW5kZXgoX2Nsc1Bvcyk7CiAgICAgICAgICAgIFN0cmluZyBuYW1lID0g\nYXR0cnMuZ2V0VmFsdWUoIm5hbWUiKTsKICAgICAgICAgICAgaWYgKCFTdHJp\nbmdVdGlscy5pc0VtcHR5KG5hbWUpKQogICAgICAgICAgICAgICAgbWV0YS5z\nZXRUeXBlQWxpYXMobmFtZSk7CiAgICAgICAgICAgIG1ldGEuc2V0RW1iZWRk\nZWRPbmx5KG1hcHBlZFN1cGVyIHx8ICJlbWJlZGRhYmxlIi5lcXVhbHMoZWxl\nbSkpOwogICAgICAgICAgICBpZiAobWFwcGVkU3VwZXIpCiAgICAgICAgICAg\nICAgICBtZXRhLnNldElkZW50aXR5VHlwZShtZXRhLklEX1VOS05PV04pOwog\nICAgICAgIH0KICAgICAgICBpZiAoaXNNYXBwaW5nTW9kZSgpKQogICAgICAg\nICAgICBtZXRhLnNldFNvdXJjZU1vZGUoTU9ERV9NQVBQSU5HLCB0cnVlKTsK\nICAgICAgICBpZiAoaXNNYXBwaW5nT3ZlcnJpZGVNb2RlKCkpCiAgICAgICAg\nICAgIHN0YXJ0Q2xhc3NNYXBwaW5nKG1ldGEsIG1hcHBlZFN1cGVyLCBhdHRy\ncyk7CiAgICAgICAgaWYgKGlzUXVlcnlNb2RlKCkpCiAgICAgICAgICAgIG1l\ndGEuc2V0U291cmNlTW9kZShNT0RFX1FVRVJZLCB0cnVlKTsKCiAgICAgICAg\nX2Nsc1BvcysrOwogICAgICAgIF9maWVsZFBvcyA9IDA7CiAgICAgICAgYWRk\nQ29tbWVudHMobWV0YSk7CiAgICAgICAgcHVzaEVsZW1lbnQobWV0YSk7CiAg\nICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBw\ncm90ZWN0ZWQgdm9pZCBlbmRDbGFzcyhTdHJpbmcgZWxlbSkKICAgICAgICB0\naHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICBpZiAoX21vZGUgIT0gTU9E\nRV9RVUVSWSkgewogICAgICAgICAgICBDbGFzc01ldGFEYXRhIG1ldGEgPSAo\nQ2xhc3NNZXRhRGF0YSkgcG9wRWxlbWVudCgpOwogICAgICAgICAgICBzdG9y\nZUNhbGxiYWNrcyhtZXRhKTsKICAgICAgICAgICAgaWYgKGlzTWFwcGluZ092\nZXJyaWRlTW9kZSgpKQogICAgICAgICAgICAgICAgZW5kQ2xhc3NNYXBwaW5n\nKG1ldGEpOwogICAgICAgIH0KICAgICAgICBfY2xzID0gbnVsbDsKICAgICAg\nICBzdXBlci5lbmRDbGFzcyhlbGVtKTsKICAgIH0KCiAgICAvKioKICAgICAq\nIEltcGxlbWVudCB0byBhZGQgbWFwcGluZyBhdHRyaWJ1dGVzIHRvIGNsYXNz\nLgogICAgICovCiAgICBwcm90ZWN0ZWQgdm9pZCBzdGFydENsYXNzTWFwcGlu\nZyhDbGFzc01ldGFEYXRhIG1hcHBpbmcsCiAgICAgICAgYm9vbGVhbiBtYXBw\nZWRTdXBlciwgQXR0cmlidXRlcyBhdHRycykKICAgICAgICB0aHJvd3MgU0FY\nRXhjZXB0aW9uIHsKICAgIH0KCiAgICAvKioKICAgICAqIEltcGxlbWVudCB0\nbyBmaW5hbGl6ZSBjbGFzcyBtYXBwaW5nLgogICAgICovCiAgICBwcm90ZWN0\nZWQgdm9pZCBlbmRDbGFzc01hcHBpbmcoQ2xhc3NNZXRhRGF0YSBtYXBwaW5n\nKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24gewogICAgfQoKICAgIC8q\nKgogICAgICogRGVmYXVsdCBhY2Nlc3MgZWxlbWVudC4KICAgICAqLwogICAg\ncHJpdmF0ZSB2b2lkIGVuZEFjY2VzcygpIHsKICAgICAgICBfYWNjZXNzID0g\ndG9BY2Nlc3NUeXBlKGN1cnJlbnRUZXh0KCksIENsYXNzTWV0YURhdGEuQUND\nRVNTX1VOS05PV04pOwogICAgfQoKICAgIC8qKgogICAgICogUGFyc2UgdGhl\nIGdpdmVuIHN0cmluZyBhcyBhbiBlbnRpdHkgYWNjZXNzIHR5cGUsIGRlZmF1\nbHRpbmcgdG8gZ2l2ZW4KICAgICAqIGRlZmF1bHQgaWYgc3RyaW5nIGlzIGVt\ncHR5LgogICAgICovCiAgICBwcml2YXRlIGludCB0b0FjY2Vzc1R5cGUoU3Ry\naW5nIHN0ciwgaW50IGRlZikgewogICAgICAgIGlmIChTdHJpbmdVdGlscy5p\nc0VtcHR5KHN0cikpCiAgICAgICAgICAgIHJldHVybiBkZWY7CiAgICAgICAg\naWYgKCJQUk9QRVJUWSIuZXF1YWxzKHN0cikpCiAgICAgICAgICAgIHJldHVy\nbiBDbGFzc01ldGFEYXRhLkFDQ0VTU19QUk9QRVJUWTsKICAgICAgICByZXR1\ncm4gQ2xhc3NNZXRhRGF0YS5BQ0NFU1NfRklFTEQ7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBQYXJzZSBmbHVzaC1tb2RlIGVsZW1lbnQuCiAgICAgKi8KICAg\nIHByaXZhdGUgYm9vbGVhbiBzdGFydEZsdXNoTW9kZShBdHRyaWJ1dGVzIGF0\ndHJzKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24gewogICAgICAgIExv\nZyBsb2cgPSBnZXRMb2coKTsKICAgICAgICBpZiAobG9nLmlzV2FybkVuYWJs\nZWQoKSkKICAgICAgICAgICAgbG9nLndhcm4oX2xvYy5nZXQoInVuc3VwcG9y\ndGVkIiwgImZsdXNoLW1vZGUiLCBnZXRTb3VyY2VOYW1lKCkpKTsKICAgICAg\nICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgLyoqCiAgICAgKiBQYXJzZSBz\nZXF1ZW5jZS1nZW5lcmF0b3IuCiAgICAgKi8KICAgIHByb3RlY3RlZCBib29s\nZWFuIHN0YXJ0U2VxdWVuY2VHZW5lcmF0b3IoQXR0cmlidXRlcyBhdHRycykg\newogICAgICAgIGlmICghaXNNYXBwaW5nT3ZlcnJpZGVNb2RlKCkpCiAgICAg\nICAgICAgIHJldHVybiBmYWxzZTsKCiAgICAgICAgU3RyaW5nIG5hbWUgPSBh\ndHRycy5nZXRWYWx1ZSgibmFtZSIpOwogICAgICAgIExvZyBsb2cgPSBnZXRM\nb2coKTsKICAgICAgICBpZiAobG9nLmlzVHJhY2VFbmFibGVkKCkpCiAgICAg\nICAgICAgIGxvZy50cmFjZShfbG9jLmdldCgicGFyc2Utc2VxdWVuY2UiLCBu\nYW1lKSk7CgogICAgICAgIFNlcXVlbmNlTWV0YURhdGEgbWV0YSA9IGdldFJl\ncG9zaXRvcnkoKS5nZXRDYWNoZWRTZXF1ZW5jZU1ldGFEYXRhKG5hbWUpOwog\nICAgICAgIGlmIChtZXRhICE9IG51bGwgJiYgbG9nLmlzV2FybkVuYWJsZWQo\nKSkKICAgICAgICAgICAgbG9nLndhcm4oX2xvYy5nZXQoIm92ZXJyaWRlLXNl\ncXVlbmNlIiwgbmFtZSkpOwoKICAgICAgICBtZXRhID0gZ2V0UmVwb3NpdG9y\neSgpLmFkZFNlcXVlbmNlTWV0YURhdGEobmFtZSk7CiAgICAgICAgU3RyaW5n\nIHNlcSA9IGF0dHJzLmdldFZhbHVlKCJzZXF1ZW5jZS1uYW1lIik7CiAgICAg\nICAgU3RyaW5nIHZhbCA9IGF0dHJzLmdldFZhbHVlKCJpbml0aWFsLXZhbHVl\nIik7CiAgICAgICAgaW50IGluaXRpYWwgPSB2YWwgPT0gbnVsbCA/IDEgOiBJ\nbnRlZ2VyLnBhcnNlSW50KHZhbCk7CiAgICAgICAgdmFsID0gYXR0cnMuZ2V0\nVmFsdWUoImFsbG9jYXRpb24tc2l6ZSIpOwogICAgICAgIGludCBhbGxvY2F0\nZSA9IHZhbCA9PSBudWxsID8gNTAgOiBJbnRlZ2VyLnBhcnNlSW50KHZhbCk7\nCgogICAgICAgIFN0cmluZyBjbHNOYW1lLCBwcm9wczsKICAgICAgICBpZiAo\nc2VxID09IG51bGwgfHwgc2VxLmluZGV4T2YoJygnKSA9PSAtMSkgewogICAg\nICAgICAgICBjbHNOYW1lID0gU2VxdWVuY2VNZXRhRGF0YS5JTVBMX05BVElW\nRTsKICAgICAgICAgICAgcHJvcHMgPSBudWxsOwogICAgICAgIH0gZWxzZSB7\nIC8vIHBsdWdpbgogICAgICAgICAgICBjbHNOYW1lID0gQ29uZmlndXJhdGlv\nbnMuZ2V0Q2xhc3NOYW1lKHNlcSk7CiAgICAgICAgICAgIHByb3BzID0gQ29u\nZmlndXJhdGlvbnMuZ2V0UHJvcGVydGllcyhzZXEpOwogICAgICAgICAgICBz\nZXEgPSBudWxsOwogICAgICAgIH0KCiAgICAgICAgbWV0YS5zZXRTZXF1ZW5j\nZVBsdWdpbihDb25maWd1cmF0aW9ucy5nZXRQbHVnaW4oY2xzTmFtZSwgcHJv\ncHMpKTsKICAgICAgICBtZXRhLnNldFNlcXVlbmNlKHNlcSk7CiAgICAgICAg\nbWV0YS5zZXRJbml0aWFsVmFsdWUoaW5pdGlhbCk7CiAgICAgICAgbWV0YS5z\nZXRBbGxvY2F0ZShhbGxvY2F0ZSk7CgogICAgICAgIE9iamVjdCBjdXIgPSBj\ndXJyZW50RWxlbWVudCgpOwogICAgICAgIE9iamVjdCBzY29wZSA9IChjdXIg\naW5zdGFuY2VvZiBDbGFzc01ldGFEYXRhKQogICAgICAgICAgICA/ICgoQ2xh\nc3NNZXRhRGF0YSkgY3VyKS5nZXREZXNjcmliZWRUeXBlKCkgOiBudWxsOwog\nICAgICAgIG1ldGEuc2V0U291cmNlKGdldFNvdXJjZUZpbGUoKSwgc2NvcGUs\nIG1ldGEuU1JDX1hNTCk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9Cgog\nICAgcHJvdGVjdGVkIHZvaWQgZW5kU2VxdWVuY2VHZW5lcmF0b3IoKSB7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBQYXJzZSBpZC4KICAgICAqLwogICAgcHJv\ndGVjdGVkIGJvb2xlYW4gc3RhcnRJZChBdHRyaWJ1dGVzIGF0dHJzKQogICAg\nICAgIHRocm93cyBTQVhFeGNlcHRpb24gewogICAgICAgIEZpZWxkTWV0YURh\ndGEgZm1kID0gcGFyc2VGaWVsZChhdHRycyk7CiAgICAgICAgZm1kLnNldEV4\ncGxpY2l0KHRydWUpOwogICAgICAgIGZtZC5zZXRQcmltYXJ5S2V5KHRydWUp\nOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIHByb3RlY3RlZCB2\nb2lkIGVuZElkKCkKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAg\nICAgICBmaW5pc2hGaWVsZCgpOwogICAgfQoKICAgIC8qKgogICAgICogUGFy\nc2UgZW1iZWRkZWQtaWQuCiAgICAgKi8KICAgIHByb3RlY3RlZCBib29sZWFu\nIHN0YXJ0RW1iZWRkZWRJZChBdHRyaWJ1dGVzIGF0dHJzKQogICAgICAgIHRo\ncm93cyBTQVhFeGNlcHRpb24gewogICAgICAgIEZpZWxkTWV0YURhdGEgZm1k\nID0gcGFyc2VGaWVsZChhdHRycyk7CiAgICAgICAgZm1kLnNldEV4cGxpY2l0\nKHRydWUpOwogICAgICAgIGZtZC5zZXRQcmltYXJ5S2V5KHRydWUpOwogICAg\nICAgIGZtZC5zZXRFbWJlZGRlZCh0cnVlKTsKICAgICAgICBpZiAoZm1kLmdl\ndEVtYmVkZGVkTWV0YURhdGEoKSA9PSBudWxsKQogICAgICAgICAgICBmbWQu\nYWRkRW1iZWRkZWRNZXRhRGF0YSgpOwogICAgICAgIHJldHVybiB0cnVlOwog\nICAgfQoKICAgIHByb3RlY3RlZCB2b2lkIGVuZEVtYmVkZGVkSWQoKQogICAg\nICAgIHRocm93cyBTQVhFeGNlcHRpb24gewogICAgICAgIGZpbmlzaEZpZWxk\nKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBQYXJzZSBpZC1jbGFzcy4KICAg\nICAqLwogICAgcHJvdGVjdGVkIGJvb2xlYW4gc3RhcnRJZENsYXNzKEF0dHJp\nYnV0ZXMgYXR0cnMpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAg\nICAgICAgaWYgKCFpc01ldGFEYXRhTW9kZSgpKQogICAgICAgICAgICByZXR1\ncm4gZmFsc2U7CgogICAgICAgIENsYXNzTWV0YURhdGEgbWV0YSA9IChDbGFz\nc01ldGFEYXRhKSBjdXJyZW50RWxlbWVudCgpOwogICAgICAgIFN0cmluZyBj\nbHMgPSBhdHRycy5nZXRWYWx1ZSgiY2xhc3MiKTsKICAgICAgICBDbGFzcyBp\nZENscyA9IG51bGw7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgaWRDbHMg\nPSBjbGFzc0Zvck5hbWUoY2xzKTsKICAgICAgICB9IGNhdGNoIChUaHJvd2Fi\nbGUgdCkgewogICAgICAgICAgICB0aHJvdyBnZXRFeGNlcHRpb24oX2xvYy5n\nZXQoImludmFsaWQtaWQtY2xhc3MiLCBtZXRhLCBjbHMpLCB0KTsKICAgICAg\nICB9CiAgICAgICAgbWV0YS5zZXRPYmplY3RJZFR5cGUoaWRDbHMsIHRydWUp\nOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIHByb3RlY3RlZCB2\nb2lkIGVuZElkQ2xhc3MoKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24g\newogICAgfQoKICAgIC8qKgogICAgICogUGFyc2UgbG9iLgogICAgICovCiAg\nICBwcm90ZWN0ZWQgYm9vbGVhbiBzdGFydExvYihBdHRyaWJ1dGVzIGF0dHJz\nKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24gewogICAgICAgIEZpZWxk\nTWV0YURhdGEgZm1kID0gKEZpZWxkTWV0YURhdGEpIGN1cnJlbnRFbGVtZW50\nKCk7CiAgICAgICAgaWYgKGZtZC5nZXREZWNsYXJlZFR5cGVDb2RlKCkgIT0g\nSmF2YVR5cGVzLlNUUklORwogICAgICAgICAgICAmJiBmbWQuZ2V0RGVjbGFy\nZWRUeXBlKCkgIT0gY2hhcltdLmNsYXNzCiAgICAgICAgICAgICYmIGZtZC5n\nZXREZWNsYXJlZFR5cGUoKSAhPSBDaGFyYWN0ZXJbXS5jbGFzcwogICAgICAg\nICAgICAmJiBmbWQuZ2V0RGVjbGFyZWRUeXBlKCkgIT0gYnl0ZVtdLmNsYXNz\nCiAgICAgICAgICAgICYmIGZtZC5nZXREZWNsYXJlZFR5cGUoKSAhPSBCeXRl\nW10uY2xhc3MpCiAgICAgICAgICAgIGZtZC5zZXRTZXJpYWxpemVkKHRydWUp\nOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIHByb3RlY3RlZCB2\nb2lkIGVuZExvYigpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBQYXJzZSBnZW5lcmF0ZWQtdmFsdWUuCiAg\nICAgKi8KICAgIHByb3RlY3RlZCBib29sZWFuIHN0YXJ0R2VuZXJhdGVkVmFs\ndWUoQXR0cmlidXRlcyBhdHRycykKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0\naW9uIHsKICAgICAgICBpZiAoIWlzTWFwcGluZ092ZXJyaWRlTW9kZSgpKQog\nICAgICAgICAgICByZXR1cm4gZmFsc2U7CgogICAgICAgIFN0cmluZyBzdHJh\ndGVneSA9IGF0dHJzLmdldFZhbHVlKCJzdHJhdGVneSIpOwogICAgICAgIFN0\ncmluZyBnZW5lcmF0b3IgPSBhdHRycy5nZXRWYWx1ZSgiZ2VuZXJhdG9yIik7\nCgogICAgICAgIC8vIFRPRE8gVVVJRF9IRVggLyBVVUlEX1NUUklORwogICAg\nICAgIEZpZWxkTWV0YURhdGEgZm1kID0gKEZpZWxkTWV0YURhdGEpIGN1cnJl\nbnRFbGVtZW50KCk7CiAgICAgICAgaWYgKFN0cmluZ1V0aWxzLmlzRW1wdHko\nc3RyYXRlZ3kpIHx8ICJBVVRPIi5lcXVhbHMoc3RyYXRlZ3kpKQogICAgICAg\nICAgICBmbWQuc2V0VmFsdWVTZXF1ZW5jZU5hbWUoU2VxdWVuY2VNZXRhRGF0\nYS5OQU1FX1NZU1RFTSk7CiAgICAgICAgZWxzZSBpZiAoIlRBQkxFIi5lcXVh\nbHMoc3RyYXRlZ3kpIHx8ICJTRVFVRU5DRSIuZXF1YWxzKHN0cmF0ZWd5KSkg\newogICAgICAgICAgICBpZiAoU3RyaW5nVXRpbHMuaXNFbXB0eShnZW5lcmF0\nb3IpKQogICAgICAgICAgICAgICAgZm1kLnNldFZhbHVlU2VxdWVuY2VOYW1l\nKFNlcXVlbmNlTWV0YURhdGEuTkFNRV9TWVNURU0pOwogICAgICAgICAgICBl\nbHNlCiAgICAgICAgICAgICAgICBmbWQuc2V0VmFsdWVTZXF1ZW5jZU5hbWUo\nZ2VuZXJhdG9yKTsKICAgICAgICB9IGVsc2UgaWYgKCJJREVOVElUWSIuZXF1\nYWxzKHN0cmF0ZWd5KSkKICAgICAgICAgICAgZm1kLnNldFZhbHVlU3RyYXRl\nZ3koVmFsdWVTdHJhdGVnaWVzLkFVVE9BU1NJR04pOwogICAgICAgIGVsc2UK\nICAgICAgICAgICAgdGhyb3cgbmV3IFVuc3VwcG9ydGVkRXhjZXB0aW9uKHN0\ncmF0ZWd5KTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBwcm90\nZWN0ZWQgdm9pZCBlbmRHZW5lcmF0ZWRWYWx1ZSgpCiAgICAgICAgdGhyb3dz\nIFNBWEV4Y2VwdGlvbiB7CiAgICB9CgogICAgLyoqCiAgICAgKiBMYXppbHkg\ncGFyc2UgY2FzY2FkZXMuCiAgICAgKi8KICAgIHByb3RlY3RlZCBib29sZWFu\nIHN0YXJ0Q2FzY2FkZShPYmplY3QgdGFnLCBBdHRyaWJ1dGVzIGF0dHJzKQog\nICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24gewogICAgICAgIGlmICghaXNN\nZXRhRGF0YU1vZGUoKSkKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoKICAg\nICAgICBTZXQ8Q2FzY2FkZVR5cGU+IGNhc2NhZGVzID0gbnVsbDsKICAgICAg\nICBpZiAoY3VycmVudEVsZW1lbnQoKSBpbnN0YW5jZW9mIEZpZWxkTWV0YURh\ndGEpIHsKICAgICAgICAgICAgaWYgKF9jYXNjYWRlcyA9PSBudWxsKQogICAg\nICAgICAgICAgICAgX2Nhc2NhZGVzID0gRW51bVNldC5ub25lT2YoQ2FzY2Fk\nZVR5cGUuY2xhc3MpOwogICAgICAgICAgICBjYXNjYWRlcyA9IF9jYXNjYWRl\nczsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBpZiAoX3BrZ0Nhc2Nh\nZGVzID09IG51bGwpCiAgICAgICAgICAgICAgICBfcGtnQ2FzY2FkZXMgPSBF\nbnVtU2V0Lm5vbmVPZihDYXNjYWRlVHlwZS5jbGFzcyk7CiAgICAgICAgICAg\nIGNhc2NhZGVzID0gX3BrZ0Nhc2NhZGVzOwogICAgICAgIH0KICAgICAgICBi\nb29sZWFuIGFsbCA9IEVMRU1fQ0FTQ0FERV9BTEwgPT0gdGFnOwogICAgICAg\nIGlmIChhbGwgfHwgRUxFTV9DQVNDQURFX1BFUiA9PSB0YWcpCiAgICAgICAg\nICAgIGNhc2NhZGVzLmFkZChQRVJTSVNUKTsKICAgICAgICBpZiAoYWxsIHx8\nIEVMRU1fQ0FTQ0FERV9SRU0gPT0gdGFnKQogICAgICAgICAgICBjYXNjYWRl\ncy5hZGQoUkVNT1ZFKTsKICAgICAgICBpZiAoYWxsIHx8IEVMRU1fQ0FTQ0FE\nRV9NRVIgPT0gdGFnKQogICAgICAgICAgICBjYXNjYWRlcy5hZGQoTUVSR0Up\nOwogICAgICAgIGlmIChhbGwgfHwgRUxFTV9DQVNDQURFX1JFRiA9PSB0YWcp\nCiAgICAgICAgICAgIGNhc2NhZGVzLmFkZChSRUZSRVNIKTsKICAgICAgICBy\nZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvKioKICAgICAqIFNldCB0aGUgY2Fj\naGVkIGNhc2NhZGVzIGludG8gdGhlIGZpZWxkLgogICAgICovCiAgICBwcm90\nZWN0ZWQgdm9pZCBzZXRDYXNjYWRlcyhGaWVsZE1ldGFEYXRhIGZtZCkgewog\nICAgICAgIFNldDxDYXNjYWRlVHlwZT4gY2FzY2FkZXMgPSBfY2FzY2FkZXM7\nCiAgICAgICAgaWYgKF9jYXNjYWRlcyA9PSBudWxsKQogICAgICAgICAgICBj\nYXNjYWRlcyA9IF9wa2dDYXNjYWRlczsKICAgICAgICBpZiAoY2FzY2FkZXMg\nPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuOwoKICAgICAgICBWYWx1ZU1l\ndGFEYXRhIHZtZCA9IGZtZDsKICAgICAgICBzd2l0Y2ggKF9zdHJhdGVneSkg\newogICAgICAgICAgICBjYXNlIE9ORV9NQU5ZOgogICAgICAgICAgICBjYXNl\nIE1BTllfTUFOWToKICAgICAgICAgICAgICAgIHZtZCA9IGZtZC5nZXRFbGVt\nZW50KCk7CiAgICAgICAgfQogICAgICAgIGZvciAoQ2FzY2FkZVR5cGUgY2Fz\nY2FkZSA6IGNhc2NhZGVzKSB7CiAgICAgICAgICAgIHN3aXRjaCAoY2FzY2Fk\nZSkgewogICAgICAgICAgICAgICAgY2FzZSBQRVJTSVNUOgogICAgICAgICAg\nICAgICAgICAgIHZtZC5zZXRDYXNjYWRlUGVyc2lzdChWYWx1ZU1ldGFEYXRh\nLkNBU0NBREVfSU1NRURJQVRFKTsKICAgICAgICAgICAgICAgICAgICBicmVh\nazsKICAgICAgICAgICAgICAgIGNhc2UgTUVSR0U6CiAgICAgICAgICAgICAg\nICAgICAgdm1kLnNldENhc2NhZGVBdHRhY2goVmFsdWVNZXRhRGF0YS5DQVND\nQURFX0lNTUVESUFURSk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAg\nICAgICAgICAgICAgICBjYXNlIFJFTU9WRToKICAgICAgICAgICAgICAgICAg\nICB2bWQuc2V0Q2FzY2FkZURlbGV0ZShWYWx1ZU1ldGFEYXRhLkNBU0NBREVf\nSU1NRURJQVRFKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAg\nICAgICAgICAgIGNhc2UgUkVGUkVTSDoKICAgICAgICAgICAgICAgICAgICB2\nbWQuc2V0Q2FzY2FkZVJlZnJlc2goVmFsdWVNZXRhRGF0YS5DQVNDQURFX0lN\nTUVESUFURSk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAg\nICAgIH0KICAgICAgICB9CiAgICAgICAgX2Nhc2NhZGVzID0gbnVsbDsKICAg\nIH0KCiAgICAvKioKICAgICAqIFBhcnNlIGNvbW1vbiBmaWVsZCBhdHRyaWJ1\ndGVzLgogICAgICovCiAgICBwcml2YXRlIEZpZWxkTWV0YURhdGEgcGFyc2VG\naWVsZChBdHRyaWJ1dGVzIGF0dHJzKQogICAgICAgIHRocm93cyBTQVhFeGNl\ncHRpb24gewogICAgICAgIENsYXNzTWV0YURhdGEgbWV0YSA9IChDbGFzc01l\ndGFEYXRhKSBjdXJyZW50RWxlbWVudCgpOwogICAgICAgIFN0cmluZyBuYW1l\nID0gYXR0cnMuZ2V0VmFsdWUoIm5hbWUiKTsKICAgICAgICBGaWVsZE1ldGFE\nYXRhIGZpZWxkID0gbWV0YS5nZXREZWNsYXJlZEZpZWxkKG5hbWUpOwogICAg\nICAgIGlmICgoZmllbGQgPT0gbnVsbCB8fCBmaWVsZC5nZXREZWNsYXJlZFR5\ncGUoKSA9PSBPYmplY3QuY2xhc3MpCiAgICAgICAgICAgICYmIG1ldGEuZ2V0\nRGVzY3JpYmVkVHlwZSgpICE9IE9iamVjdC5jbGFzcykgewogICAgICAgICAg\nICBNZW1iZXIgbWVtYmVyID0gbnVsbDsKICAgICAgICAgICAgQ2xhc3MgdHlw\nZSA9IG51bGw7CiAgICAgICAgICAgIGludCBkZWYgPSBfcmVwb3MuZ2V0TWV0\nYURhdGFGYWN0b3J5KCkuZ2V0RGVmYXVsdHMoKS4KICAgICAgICAgICAgICAg\nIGdldERlZmF1bHRBY2Nlc3NUeXBlKCk7CiAgICAgICAgICAgIHRyeSB7CiAg\nICAgICAgICAgICAgICBpZiAobWV0YS5nZXRBY2Nlc3NUeXBlKCkgPT0gQ2xh\nc3NNZXRhRGF0YS5BQ0NFU1NfUFJPUEVSVFkKICAgICAgICAgICAgICAgICAg\nICB8fCAobWV0YS5nZXRBY2Nlc3NUeXBlKCkgPT0gQ2xhc3NNZXRhRGF0YS5B\nQ0NFU1NfVU5LTk9XTgogICAgICAgICAgICAgICAgICAgICYmIGRlZiA9PSBD\nbGFzc01ldGFEYXRhLkFDQ0VTU19QUk9QRVJUWSkpIHsKICAgICAgICAgICAg\nICAgICAgICBTdHJpbmcgY2FwID0gU3RyaW5nVXRpbHMuY2FwaXRhbGl6ZShu\nYW1lKTsKICAgICAgICAgICAgICAgICAgICB0eXBlID0gbWV0YS5nZXREZXNj\ncmliZWRUeXBlKCk7CiAgICAgICAgICAgICAgICAgICAgdHJ5IHsKICAgICAg\nICAgICAgICAgICAgICAgICAgbWVtYmVyID0gdHlwZS5nZXREZWNsYXJlZE1l\ndGhvZCgiZ2V0IiArIGNhcCwKICAgICAgICAgICAgICAgICAgICAgICAgICAg\nIChDbGFzc1tdKSBudWxsKTsgLy8gdmFyYXJncyBkaXNhbWJpZ3VhdGUKICAg\nICAgICAgICAgICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZXhjZXApIHsK\nICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAg\nICAgICAgICAgICAgIG1lbWJlciA9IHR5cGUuZ2V0RGVjbGFyZWRNZXRob2Qo\nImlzIiArIGNhcCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAo\nQ2xhc3NbXSkgbnVsbCk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0\nY2ggKEV4Y2VwdGlvbiBleGNlcDIpIHsKICAgICAgICAgICAgICAgICAgICAg\nICAgICAgIHRocm93IGV4Y2VwOwogICAgICAgICAgICAgICAgICAgICAgICB9\nCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHR5\ncGUgPSAoKE1ldGhvZCkgbWVtYmVyKS5nZXRSZXR1cm5UeXBlKCk7CiAgICAg\nICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIG1lbWJl\nciA9IG1ldGEuZ2V0RGVzY3JpYmVkVHlwZSgpLmdldERlY2xhcmVkRmllbGQo\nbmFtZSk7CiAgICAgICAgICAgICAgICAgICAgdHlwZSA9ICgoRmllbGQpIG1l\nbWJlcikuZ2V0VHlwZSgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAg\nICB9IGNhdGNoIChFeGNlcHRpb24gZSkgewogICAgICAgICAgICAgICAgdGhy\nb3cgZ2V0RXhjZXB0aW9uKF9sb2MuZ2V0KCJpbnZhbGlkLWF0dHIiLCBuYW1l\nLCBtZXRhKSwgZSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmIChm\naWVsZCA9PSBudWxsKSB7CiAgICAgICAgICAgICAgICBmaWVsZCA9IG1ldGEu\nYWRkRGVjbGFyZWRGaWVsZChuYW1lLCB0eXBlKTsKICAgICAgICAgICAgICAg\nIFBlcnNpc3RlbmNlTWV0YURhdGFEZWZhdWx0cy5zZXRDYXNjYWRlTm9uZShm\naWVsZCk7CiAgICAgICAgICAgICAgICBQZXJzaXN0ZW5jZU1ldGFEYXRhRGVm\nYXVsdHMuc2V0Q2FzY2FkZU5vbmUoZmllbGQuZ2V0S2V5KCkpOwogICAgICAg\nICAgICAgICAgUGVyc2lzdGVuY2VNZXRhRGF0YURlZmF1bHRzLnNldENhc2Nh\nZGVOb25lKGZpZWxkLmdldEVsZW1lbnQoKSk7CiAgICAgICAgICAgIH0KICAg\nICAgICAgICAgZmllbGQuYmFja2luZ01lbWJlcihtZW1iZXIpOwogICAgICAg\nIH0gZWxzZSBpZiAoZmllbGQgPT0gbnVsbCkgewogICAgICAgICAgICBmaWVs\nZCA9IG1ldGEuYWRkRGVjbGFyZWRGaWVsZChuYW1lLCBPYmplY3QuY2xhc3Mp\nOwogICAgICAgICAgICBQZXJzaXN0ZW5jZU1ldGFEYXRhRGVmYXVsdHMuc2V0\nQ2FzY2FkZU5vbmUoZmllbGQpOwogICAgICAgICAgICBQZXJzaXN0ZW5jZU1l\ndGFEYXRhRGVmYXVsdHMuc2V0Q2FzY2FkZU5vbmUoZmllbGQuZ2V0S2V5KCkp\nOwogICAgICAgICAgICBQZXJzaXN0ZW5jZU1ldGFEYXRhRGVmYXVsdHMuc2V0\nQ2FzY2FkZU5vbmUoZmllbGQuZ2V0RWxlbWVudCgpKTsKICAgICAgICB9Cgog\nICAgICAgIGlmIChpc01ldGFEYXRhTW9kZSgpKQogICAgICAgICAgICBmaWVs\nZC5zZXRMaXN0aW5nSW5kZXgoX2ZpZWxkUG9zKTsKCiAgICAgICAgX2ZpZWxk\nUG9zKys7CiAgICAgICAgcHVzaEVsZW1lbnQoZmllbGQpOwogICAgICAgIGFk\nZENvbW1lbnRzKGZpZWxkKTsKCiAgICAgICAgaWYgKGlzTWFwcGluZ092ZXJy\naWRlTW9kZSgpKQogICAgICAgICAgICBzdGFydEZpZWxkTWFwcGluZyhmaWVs\nZCwgYXR0cnMpOwogICAgICAgIHJldHVybiBmaWVsZDsKICAgIH0KCiAgICAv\nKioKICAgICAqIFBvcHMgZmllbGQgZWxlbWVudC4KICAgICAqLwogICAgcHJp\ndmF0ZSB2b2lkIGZpbmlzaEZpZWxkKCkKICAgICAgICB0aHJvd3MgU0FYRXhj\nZXB0aW9uIHsKICAgICAgICBGaWVsZE1ldGFEYXRhIGZpZWxkID0gKEZpZWxk\nTWV0YURhdGEpIHBvcEVsZW1lbnQoKTsKICAgICAgICBzZXRDYXNjYWRlcyhm\naWVsZCk7CiAgICAgICAgaWYgKGlzTWFwcGluZ092ZXJyaWRlTW9kZSgpKQog\nICAgICAgICAgICBlbmRGaWVsZE1hcHBpbmcoZmllbGQpOwogICAgICAgIF9z\ndHJhdGVneSA9IG51bGw7CiAgICB9CgogICAgLyoqCiAgICAgKiBJbXBsZW1l\nbnQgdG8gYWRkIGZpZWxkIG1hcHBpbmcgZGF0YS4gRG9lcyBub3RoaW5nIGJ5\nIGRlZmF1bHQuCiAgICAgKi8KICAgIHByb3RlY3RlZCB2b2lkIHN0YXJ0Rmll\nbGRNYXBwaW5nKEZpZWxkTWV0YURhdGEgZmllbGQsIEF0dHJpYnV0ZXMgYXR0\ncnMpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBJbXBsZW1lbnQgdG8gZmluYWxpemUgZmllbGQgbWFwcGlu\nZy4gRG9lcyBub3RoaW5nIGJ5IGRlZmF1bHQuCiAgICAgKi8KICAgIHByb3Rl\nY3RlZCB2b2lkIGVuZEZpZWxkTWFwcGluZyhGaWVsZE1ldGFEYXRhIGZpZWxk\nKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24gewogICAgfQoKICAgIC8q\nKgogICAgICogUGFyc2UgdmVyc2lvbi4KICAgICAqLwogICAgcHJvdGVjdGVk\nIGJvb2xlYW4gc3RhcnRWZXJzaW9uKEF0dHJpYnV0ZXMgYXR0cnMpCiAgICAg\nICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgRmllbGRNZXRhRGF0\nYSBmbWQgPSBwYXJzZUZpZWxkKGF0dHJzKTsKICAgICAgICBmbWQuc2V0RXhw\nbGljaXQodHJ1ZSk7CiAgICAgICAgZm1kLnNldFZlcnNpb24odHJ1ZSk7CiAg\nICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgcHJvdGVjdGVkIHZvaWQg\nZW5kVmVyc2lvbigpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAg\nICAgICAgZmluaXNoRmllbGQoKTsKICAgIH0KCiAgICAvKioKICAgICAqIFBh\ncnNlIHN0cmF0ZWd5IGVsZW1lbnQuCiAgICAgKi8KICAgIHByaXZhdGUgYm9v\nbGVhbiBzdGFydFN0cmF0ZWd5KFBlcnNpc3RlbmNlU3RyYXRlZ3kgc3RyYXRl\nZ3ksCiAgICAgICAgQXR0cmlidXRlcyBhdHRycykKICAgICAgICB0aHJvd3Mg\nU0FYRXhjZXB0aW9uIHsKICAgICAgICBGaWVsZE1ldGFEYXRhIGZtZCA9IHBh\ncnNlRmllbGQoYXR0cnMpOwogICAgICAgIGZtZC5zZXRFeHBsaWNpdCh0cnVl\nKTsKICAgICAgICBmbWQuc2V0TWFuYWdlbWVudChGaWVsZE1ldGFEYXRhLk1B\nTkFHRV9QRVJTSVNURU5UKTsKCiAgICAgICAgU3RyaW5nIHZhbCA9IGF0dHJz\nLmdldFZhbHVlKCJmZXRjaCIpOwogICAgICAgIGlmICh2YWwgIT0gbnVsbCkK\nICAgICAgICAgICAgZm1kLnNldEluRGVmYXVsdEZldGNoR3JvdXAoIkVBR0VS\nIi5lcXVhbHModmFsKSk7CiAgICAgICAgdmFsID0gYXR0cnMuZ2V0VmFsdWUo\nIm9wdGlvbmFsIik7CiAgICAgICAgaWYgKCJmYWxzZSIuZXF1YWxzKHZhbCkp\nCiAgICAgICAgICAgIGZtZC5zZXROdWxsVmFsdWUoRmllbGRNZXRhRGF0YS5O\nVUxMX0VYQ0VQVElPTik7CiAgICAgICAgZWxzZSBpZiAoInRydWUiLmVxdWFs\ncyh2YWwpCiAgICAgICAgICAgICAgICAmJiBmbWQuZ2V0TnVsbFZhbHVlKCkg\nPT0gRmllbGRNZXRhRGF0YS5OVUxMX0VYQ0VQVElPTikgewogICAgICAgICAg\nICAvLyBSZXNldCB2YWx1ZSBpZiB0aGUgZmllbGQgd2FzIGFubm90YXRlZCB3\naXRoIG9wdGlvbmFsPWZhbHNlLiAKICAgICAgICAgICAgLy8gT3RoZXJ3aXNl\nIGxlYXZlIGl0IGFsb25lLgogICAgICAgICAgICBmbWQuc2V0TnVsbFZhbHVl\nKEZpZWxkTWV0YURhdGEuTlVMTF9VTlNFVCk7CiAgICAgICAgfQogICAgICAg\nIGlmIChpc01hcHBpbmdPdmVycmlkZU1vZGUoKSkgewogICAgICAgICAgICB2\nYWwgPSBhdHRycy5nZXRWYWx1ZSgibWFwcGVkLWJ5Iik7CiAgICAgICAgICAg\nIGlmICh2YWwgIT0gbnVsbCkKICAgICAgICAgICAgICAgIGZtZC5zZXRNYXBw\nZWRCeSh2YWwpOwogICAgICAgIH0KICAgICAgICBwYXJzZVN0cmF0ZWd5KGZt\nZCwgc3RyYXRlZ3ksIGF0dHJzKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAg\nIH0KCiAgICBwcml2YXRlIHZvaWQgZW5kU3RyYXRlZ3koUGVyc2lzdGVuY2VT\ndHJhdGVneSBzdHJhdGVneSkKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9u\nIHsKICAgICAgICBmaW5pc2hGaWVsZCgpOwogICAgfQoKICAgIC8qKgogICAg\nICogUGFyc2Ugc3RyYXRlZ3kgc3BlY2lmaWMgYXR0cmlidXRlcy4KICAgICAq\nLwogICAgcHJpdmF0ZSB2b2lkIHBhcnNlU3RyYXRlZ3koRmllbGRNZXRhRGF0\nYSBmbWQsCiAgICAgICAgUGVyc2lzdGVuY2VTdHJhdGVneSBzdHJhdGVneSwg\nQXR0cmlidXRlcyBhdHRycykKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9u\nIHsKICAgICAgICBzd2l0Y2ggKHN0cmF0ZWd5KSB7CiAgICAgICAgICAgIGNh\nc2UgQkFTSUM6CiAgICAgICAgICAgICAgICBwYXJzZUJhc2ljKGZtZCwgYXR0\ncnMpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2Ug\nRU1CRURERUQ6CiAgICAgICAgICAgICAgICBwYXJzZUVtYmVkZGVkKGZtZCwg\nYXR0cnMpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNh\nc2UgT05FX09ORToKICAgICAgICAgICAgICAgIHBhcnNlT25lVG9PbmUoZm1k\nLCBhdHRycyk7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAg\nY2FzZSBNQU5ZX09ORToKICAgICAgICAgICAgICAgIHBhcnNlTWFueVRvT25l\nKGZtZCwgYXR0cnMpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAg\nICAgIGNhc2UgTUFOWV9NQU5ZOgogICAgICAgICAgICAgICAgcGFyc2VNYW55\nVG9NYW55KGZtZCwgYXR0cnMpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAg\nICAgICAgICAgIGNhc2UgT05FX01BTlk6CiAgICAgICAgICAgICAgICBwYXJz\nZU9uZVRvTWFueShmbWQsIGF0dHJzKTsKICAgICAgICAgICAgICAgIGJyZWFr\nOwogICAgICAgICAgICBjYXNlIFRSQU5TSUVOVDoKICAgICAgICAgICAgICAg\nIGZtZC5zZXRNYW5hZ2VtZW50KEZpZWxkTWV0YURhdGEuTUFOQUdFX05PTkUp\nOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgfQoKICAg\nIC8qKgogICAgICogUGFyc2UgYmFzaWMuCiAgICAgKi8KICAgIHByb3RlY3Rl\nZCB2b2lkIHBhcnNlQmFzaWMoRmllbGRNZXRhRGF0YSBmbWQsIEF0dHJpYnV0\nZXMgYXR0cnMpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBQYXJzZSBlbWJlZGRlZC4KICAgICAqLwogICAg\ncHJvdGVjdGVkIHZvaWQgcGFyc2VFbWJlZGRlZChGaWVsZE1ldGFEYXRhIGZt\nZCwgQXR0cmlidXRlcyBhdHRycykKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0\naW9uIHsKICAgICAgICBhc3NlcnRQQyhmbWQsICJFbWJlZGRlZCIpOwogICAg\nICAgIGZtZC5zZXRFbWJlZGRlZCh0cnVlKTsKICAgICAgICBmbWQuc2V0U2Vy\naWFsaXplZChmYWxzZSk7IC8vIG92ZXJyaWRlIGFueSBMb2IgYW5ub3RhdGlv\nbgogICAgICAgIGlmIChmbWQuZ2V0RW1iZWRkZWRNZXRhRGF0YSgpID09IG51\nbGwpCiAgICAgICAgICAgIGZtZC5hZGRFbWJlZGRlZE1ldGFEYXRhKCk7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBUaHJvdyBwcm9wZXIgZXhjZXB0aW9uIGlm\nIGdpdmVuIHZhbHVlIGlzIG5vdCBwb3NzaWJseSBwZXJzaXN0ZW5jZQogICAg\nICogY2FwYWJsZS4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIGFzc2VydFBD\nKEZpZWxkTWV0YURhdGEgZm1kLCBTdHJpbmcgYXR0cikKICAgICAgICB0aHJv\nd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICBpZiAoIUphdmFUeXBlcy5tYXli\nZVBDKGZtZCkpCiAgICAgICAgICAgIHRocm93IGdldEV4Y2VwdGlvbihfbG9j\nLmdldCgiYmFkLW1ldGEtYW5ubyIsIGZtZCwgYXR0cikpOwogICAgfQoKICAg\nIC8qKgogICAgICogUGFyc2Ugb25lLXRvLW9uZS4KICAgICAqLwogICAgcHJv\ndGVjdGVkIHZvaWQgcGFyc2VPbmVUb09uZShGaWVsZE1ldGFEYXRhIGZtZCwg\nQXR0cmlidXRlcyBhdHRycykKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9u\nIHsKICAgICAgICBTdHJpbmcgdmFsID0gYXR0cnMuZ2V0VmFsdWUoInRhcmdl\ndC1lbnRpdHkiKTsKICAgICAgICBpZiAodmFsICE9IG51bGwpCiAgICAgICAg\nICAgIGZtZC5zZXRUeXBlT3ZlcnJpZGUoY2xhc3NGb3JOYW1lKHZhbCkpOwog\nICAgICAgIGFzc2VydFBDKGZtZCwgIk9uZVRvT25lIik7CiAgICAgICAgZm1k\nLnNldFNlcmlhbGl6ZWQoZmFsc2UpOyAvLyBvdmVycmlkZSBhbnkgTG9iIGFu\nbm90YXRpb24KICAgICAgICBpZiAoIWZtZC5pc0RlZmF1bHRGZXRjaEdyb3Vw\nRXhwbGljaXQoKSkKICAgICAgICAgICAgZm1kLnNldEluRGVmYXVsdEZldGNo\nR3JvdXAodHJ1ZSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBQYXJzZSBtYW55\nLXRvLW9uZS4KICAgICAqLwogICAgcHJvdGVjdGVkIHZvaWQgcGFyc2VNYW55\nVG9PbmUoRmllbGRNZXRhRGF0YSBmbWQsIEF0dHJpYnV0ZXMgYXR0cnMpCiAg\nICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgU3RyaW5nIHZh\nbCA9IGF0dHJzLmdldFZhbHVlKCJ0YXJnZXQtZW50aXR5Iik7CiAgICAgICAg\naWYgKHZhbCAhPSBudWxsKQogICAgICAgICAgICBmbWQuc2V0VHlwZU92ZXJy\naWRlKGNsYXNzRm9yTmFtZSh2YWwpKTsKICAgICAgICBhc3NlcnRQQyhmbWQs\nICJNYW55VG9PbmUiKTsKICAgICAgICBmbWQuc2V0U2VyaWFsaXplZChmYWxz\nZSk7IC8vIG92ZXJyaWRlIGFueSBMb2IgYW5ub3RhdGlvbgogICAgICAgIGlm\nICghZm1kLmlzRGVmYXVsdEZldGNoR3JvdXBFeHBsaWNpdCgpKQogICAgICAg\nICAgICBmbWQuc2V0SW5EZWZhdWx0RmV0Y2hHcm91cCh0cnVlKTsKICAgIH0K\nCiAgICAvKioKICAgICAqIFBhcnNlIG1hbnktdG8tbWFueS4KICAgICAqLwog\nICAgcHJvdGVjdGVkIHZvaWQgcGFyc2VNYW55VG9NYW55KEZpZWxkTWV0YURh\ndGEgZm1kLCBBdHRyaWJ1dGVzIGF0dHJzKQogICAgICAgIHRocm93cyBTQVhF\neGNlcHRpb24gewogICAgICAgIFN0cmluZyB2YWwgPSBhdHRycy5nZXRWYWx1\nZSgidGFyZ2V0LWVudGl0eSIpOwogICAgICAgIGlmICh2YWwgIT0gbnVsbCkK\nICAgICAgICAgICAgZm1kLmdldEVsZW1lbnQoKS5zZXREZWNsYXJlZFR5cGUo\nY2xhc3NGb3JOYW1lKHZhbCkpOwogICAgICAgIGFzc2VydFBDQ29sbGVjdGlv\nbihmbWQsICJNYW55VG9NYW55Iik7CiAgICAgICAgZm1kLnNldFNlcmlhbGl6\nZWQoZmFsc2UpOyAvLyBvdmVycmlkZSBMb2IgaW4gYW5ub3RhdGlvbgogICAg\nfQoKICAgIC8qKgogICAgICogVGhyb3cgZXhjZXB0aW9uIGlmIGdpdmVuIGZp\nZWxkIG5vdCBhIGNvbGxlY3Rpb24gb2YgcG9zc2libGUgcGVyc2lzdGVuY2UK\nICAgICAqIGNhcGFibGVzLgogICAgICovCiAgICBwcml2YXRlIHZvaWQgYXNz\nZXJ0UENDb2xsZWN0aW9uKEZpZWxkTWV0YURhdGEgZm1kLCBTdHJpbmcgYXR0\ncikKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICBzd2l0\nY2ggKGZtZC5nZXREZWNsYXJlZFR5cGVDb2RlKCkpIHsKICAgICAgICAgICAg\nY2FzZSBKYXZhVHlwZXMuQVJSQVk6CiAgICAgICAgICAgIGNhc2UgSmF2YVR5\ncGVzLkNPTExFQ1RJT046CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLk1B\nUDoKICAgICAgICAgICAgICAgIGlmIChKYXZhVHlwZXMubWF5YmVQQyhmbWQu\nZ2V0RWxlbWVudCgpKSkKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAg\nICAgICAgICAgICAgIC8vIG5vIGJyZWFrCiAgICAgICAgICAgIGRlZmF1bHQ6\nCiAgICAgICAgICAgICAgICB0aHJvdyBnZXRFeGNlcHRpb24oX2xvYy5nZXQo\nImJhZC1tZXRhLWFubm8iLCBmbWQsIGF0dHIpKTsKICAgICAgICB9CiAgICB9\nCgogICAgLyoqCiAgICAgKiBQYXJzZSBvbmUtdG8tbWFueS4KICAgICAqLwog\nICAgcHJvdGVjdGVkIHZvaWQgcGFyc2VPbmVUb01hbnkoRmllbGRNZXRhRGF0\nYSBmbWQsIEF0dHJpYnV0ZXMgYXR0cnMpCiAgICAgICAgdGhyb3dzIFNBWEV4\nY2VwdGlvbiB7CiAgICAgICAgU3RyaW5nIHZhbCA9IGF0dHJzLmdldFZhbHVl\nKCJ0YXJnZXQtZW50aXR5Iik7CiAgICAgICAgaWYgKHZhbCAhPSBudWxsKQog\nICAgICAgICAgICBmbWQuZ2V0RWxlbWVudCgpLnNldERlY2xhcmVkVHlwZShj\nbGFzc0Zvck5hbWUodmFsKSk7CiAgICAgICAgYXNzZXJ0UENDb2xsZWN0aW9u\nKGZtZCwgIk9uZVRvTWFueSIpOwogICAgICAgIGZtZC5zZXRTZXJpYWxpemVk\nKGZhbHNlKTsgLy8gb3ZlcnJpZGUgYW55IExvYiBhbm5vdGF0aW9uCiAgICB9\nCgogICAgLyoqCiAgICAgKiBQYXJzZSBtYXAta2V5LgogICAgICovCiAgICBw\ncml2YXRlIGJvb2xlYW4gc3RhcnRNYXBLZXkoQXR0cmlidXRlcyBhdHRycykK\nICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICBpZiAoIWlz\nTWFwcGluZ092ZXJyaWRlTW9kZSgpKQogICAgICAgICAgICByZXR1cm4gZmFs\nc2U7CgogICAgICAgIEZpZWxkTWV0YURhdGEgZm1kID0gKEZpZWxkTWV0YURh\ndGEpIGN1cnJlbnRFbGVtZW50KCk7CiAgICAgICAgU3RyaW5nIG1hcEtleSA9\nIGF0dHJzLmdldFZhbHVlKCJuYW1lIik7CiAgICAgICAgaWYgKG1hcEtleSA9\nPSBudWxsKQogICAgICAgICAgICBmbWQuZ2V0S2V5KCkuc2V0VmFsdWVNYXBw\nZWRCeShWYWx1ZU1ldGFEYXRhLk1BUFBFRF9CWV9QSyk7CiAgICAgICAgZWxz\nZQogICAgICAgICAgICBmbWQuZ2V0S2V5KCkuc2V0VmFsdWVNYXBwZWRCeSht\nYXBLZXkpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qKgog\nICAgICogUGFyc2Ugb3JkZXItYnkuCiAgICAgKi8KICAgIHByaXZhdGUgdm9p\nZCBlbmRPcmRlckJ5KCkKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsK\nICAgICAgICBGaWVsZE1ldGFEYXRhIGZtZCA9IChGaWVsZE1ldGFEYXRhKSBj\ndXJyZW50RWxlbWVudCgpOwogICAgICAgIFN0cmluZyBkZWMgPSBjdXJyZW50\nVGV4dCgpOwogICAgICAgIGlmIChTdHJpbmdVdGlscy5pc0VtcHR5KGRlYykp\nCiAgICAgICAgICAgIGRlYyA9IE9yZGVyLkVMRU1FTlQgKyAiIGFzYyI7CiAg\nICAgICAgZm1kLnNldE9yZGVyRGVjbGFyYXRpb24oZGVjKTsKICAgIH0KCiAg\nICAvKioKICAgICAqIFBhcnNlIG5hbWVkLXF1ZXJ5LgogICAgICovCiAgICBw\ncm90ZWN0ZWQgYm9vbGVhbiBzdGFydE5hbWVkUXVlcnkoQXR0cmlidXRlcyBh\ndHRycykKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICBp\nZiAoIWlzUXVlcnlNb2RlKCkpCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsK\nCiAgICAgICAgU3RyaW5nIG5hbWUgPSBhdHRycy5nZXRWYWx1ZSgibmFtZSIp\nOwogICAgICAgIExvZyBsb2cgPSBnZXRMb2coKTsKICAgICAgICBpZiAobG9n\nLmlzVHJhY2VFbmFibGVkKCkpCiAgICAgICAgICAgIGxvZy50cmFjZShfbG9j\nLmdldCgicGFyc2UtcXVlcnkiLCBuYW1lKSk7CgogICAgICAgIFF1ZXJ5TWV0\nYURhdGEgbWV0YSA9IGdldFJlcG9zaXRvcnkoKS5nZXRDYWNoZWRRdWVyeU1l\ndGFEYXRhKG51bGwsIG5hbWUpOwogICAgICAgIGlmIChtZXRhICE9IG51bGwg\nJiYgbG9nLmlzV2FybkVuYWJsZWQoKSkKICAgICAgICAgICAgbG9nLndhcm4o\nX2xvYy5nZXQoIm92ZXJyaWRlLXF1ZXJ5IiwgbmFtZSwgY3VycmVudExvY2F0\naW9uKCkpKTsKCiAgICAgICAgbWV0YSA9IGdldFJlcG9zaXRvcnkoKS5hZGRR\ndWVyeU1ldGFEYXRhKG51bGwsIG5hbWUpOwogICAgICAgIG1ldGEuc2V0RGVm\naW5pbmdUeXBlKF9jbHMpOwogICAgICAgIG1ldGEuc2V0UXVlcnlTdHJpbmco\nYXR0cnMuZ2V0VmFsdWUoInF1ZXJ5IikpOwogICAgICAgIG1ldGEuc2V0TGFu\nZ3VhZ2UoSlBRTFBhcnNlci5MQU5HX0pQUUwpOwoKICAgICAgICBPYmplY3Qg\nY3VyID0gY3VycmVudEVsZW1lbnQoKTsKICAgICAgICBPYmplY3Qgc2NvcGUg\nPSAoY3VyIGluc3RhbmNlb2YgQ2xhc3NNZXRhRGF0YSkKICAgICAgICAgICAg\nPyAoKENsYXNzTWV0YURhdGEpIGN1cikuZ2V0RGVzY3JpYmVkVHlwZSgpIDog\nbnVsbDsKICAgICAgICBtZXRhLnNldFNvdXJjZShnZXRTb3VyY2VGaWxlKCks\nIHNjb3BlLCBtZXRhLlNSQ19YTUwpOwogICAgICAgIGlmIChpc01ldGFEYXRh\nTW9kZSgpKQogICAgICAgICAgICBtZXRhLnNldFNvdXJjZU1vZGUoTU9ERV9N\nRVRBKTsKICAgICAgICBlbHNlIGlmIChpc01hcHBpbmdNb2RlKCkpCiAgICAg\nICAgICAgIG1ldGEuc2V0U291cmNlTW9kZShNT0RFX01BUFBJTkcpOwogICAg\nICAgIGVsc2UKICAgICAgICAgICAgbWV0YS5zZXRTb3VyY2VNb2RlKE1PREVf\nUVVFUlkpOwogICAgICAgIHB1c2hFbGVtZW50KG1ldGEpOwogICAgICAgIHJl\ndHVybiB0cnVlOwogICAgfQoKICAgIHByb3RlY3RlZCB2b2lkIGVuZE5hbWVk\nUXVlcnkoKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24gewogICAgICAg\nIHBvcEVsZW1lbnQoKTsKICAgIH0KCiAgICBwcm90ZWN0ZWQgYm9vbGVhbiBz\ndGFydFF1ZXJ5U3RyaW5nKEF0dHJpYnV0ZXMgYXR0cnMpCiAgICAgICAgdGhy\nb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9\nCgogICAgcHJvdGVjdGVkIHZvaWQgZW5kUXVlcnlTdHJpbmcoKQogICAgICAg\nIHRocm93cyBTQVhFeGNlcHRpb24gewogICAgICAgIFF1ZXJ5TWV0YURhdGEg\nbWV0YSA9IChRdWVyeU1ldGFEYXRhKSBjdXJyZW50RWxlbWVudCgpOwogICAg\nICAgIG1ldGEuc2V0UXVlcnlTdHJpbmcoY3VycmVudFRleHQoKSk7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBQYXJzZSBxdWVyeS1oaW50LgogICAgICovCiAg\nICBwcm90ZWN0ZWQgYm9vbGVhbiBzdGFydFF1ZXJ5SGludChBdHRyaWJ1dGVz\nIGF0dHJzKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24gewogICAgICAg\nIFF1ZXJ5TWV0YURhdGEgbWV0YSA9IChRdWVyeU1ldGFEYXRhKSBjdXJyZW50\nRWxlbWVudCgpOwogICAgICAgIG1ldGEuYWRkSGludChhdHRycy5nZXRWYWx1\nZSgibmFtZSIpLCBhdHRycy5nZXRWYWx1ZSgidmFsdWUiKSk7CiAgICAgICAg\ncmV0dXJuIHRydWU7CiAgICB9CgogICAgcHJvdGVjdGVkIHZvaWQgZW5kUXVl\ncnlIaW50KCkKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgIH0K\nCiAgICAvKioKICAgICAqIFBhcnNlIG5hdGl2ZS1uYW1lZC1xdWVyeS4KICAg\nICAqLwogICAgcHJvdGVjdGVkIGJvb2xlYW4gc3RhcnROYW1lZE5hdGl2ZVF1\nZXJ5KEF0dHJpYnV0ZXMgYXR0cnMpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2Vw\ndGlvbiB7CiAgICAgICAgaWYgKCFpc1F1ZXJ5TW9kZSgpKQogICAgICAgICAg\nICByZXR1cm4gZmFsc2U7CgogICAgICAgIFN0cmluZyBuYW1lID0gYXR0cnMu\nZ2V0VmFsdWUoIm5hbWUiKTsKICAgICAgICBMb2cgbG9nID0gZ2V0TG9nKCk7\nCiAgICAgICAgaWYgKGxvZy5pc1RyYWNlRW5hYmxlZCgpKQogICAgICAgICAg\nICBsb2cudHJhY2UoX2xvYy5nZXQoInBhcnNlLW5hdGl2ZS1xdWVyeSIsIG5h\nbWUpKTsKCiAgICAgICAgUXVlcnlNZXRhRGF0YSBtZXRhID0gZ2V0UmVwb3Np\ndG9yeSgpLmdldENhY2hlZFF1ZXJ5TWV0YURhdGEobnVsbCwgbmFtZSk7CiAg\nICAgICAgaWYgKG1ldGEgIT0gbnVsbCAmJiBsb2cuaXNXYXJuRW5hYmxlZCgp\nKQogICAgICAgICAgICBsb2cud2FybihfbG9jLmdldCgib3ZlcnJpZGUtcXVl\ncnkiLCBuYW1lLCBjdXJyZW50TG9jYXRpb24oKSkpOwoKICAgICAgICBtZXRh\nID0gZ2V0UmVwb3NpdG9yeSgpLmFkZFF1ZXJ5TWV0YURhdGEobnVsbCwgbmFt\nZSk7CiAgICAgICAgbWV0YS5zZXREZWZpbmluZ1R5cGUoX2Nscyk7CiAgICAg\nICAgbWV0YS5zZXRRdWVyeVN0cmluZyhhdHRycy5nZXRWYWx1ZSgicXVlcnki\nKSk7CiAgICAgICAgbWV0YS5zZXRMYW5ndWFnZShRdWVyeUxhbmd1YWdlcy5M\nQU5HX1NRTCk7CiAgICAgICAgU3RyaW5nIHZhbCA9IGF0dHJzLmdldFZhbHVl\nKCJyZXN1bHQtY2xhc3MiKTsKICAgICAgICBpZiAodmFsICE9IG51bGwpIHsK\nICAgICAgICAgICAgQ2xhc3MgdHlwZSA9IGNsYXNzRm9yTmFtZSh2YWwpOwog\nICAgICAgICAgICBpZiAoSW1wbEhlbHBlci5pc01hbmFnZWRUeXBlKHR5cGUp\nKQogICAgICAgICAgICAgICAgbWV0YS5zZXRDYW5kaWRhdGVUeXBlKHR5cGUp\nOwogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICBtZXRhLnNldFJl\nc3VsdFR5cGUodHlwZSk7CiAgICAgICAgfQoKICAgICAgICB2YWwgPSBhdHRy\ncy5nZXRWYWx1ZSgicmVzdWx0LXNldC1tYXBwaW5nIik7CiAgICAgICAgaWYg\nKHZhbCAhPSBudWxsKQogICAgICAgICAgICBtZXRhLnNldFJlc3VsdFNldE1h\ncHBpbmdOYW1lKHZhbCk7CgogICAgICAgIE9iamVjdCBjdXIgPSBjdXJyZW50\nRWxlbWVudCgpOwogICAgICAgIE9iamVjdCBzY29wZSA9IChjdXIgaW5zdGFu\nY2VvZiBDbGFzc01ldGFEYXRhKQogICAgICAgICAgICA/ICgoQ2xhc3NNZXRh\nRGF0YSkgY3VyKS5nZXREZXNjcmliZWRUeXBlKCkgOiBudWxsOwogICAgICAg\nIG1ldGEuc2V0U291cmNlKGdldFNvdXJjZUZpbGUoKSwgc2NvcGUsIG1ldGEu\nU1JDX1hNTCk7CiAgICAgICAgaWYgKGlzTWV0YURhdGFNb2RlKCkpCiAgICAg\nICAgICAgIG1ldGEuc2V0U291cmNlTW9kZShNT0RFX01FVEEpOwogICAgICAg\nIGVsc2UgaWYgKGlzTWFwcGluZ01vZGUoKSkKICAgICAgICAgICAgbWV0YS5z\nZXRTb3VyY2VNb2RlKE1PREVfTUFQUElORyk7CiAgICAgICAgZWxzZQogICAg\nICAgICAgICBtZXRhLnNldFNvdXJjZU1vZGUoTU9ERV9RVUVSWSk7CiAgICAg\nICAgcHVzaEVsZW1lbnQobWV0YSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAg\nICB9CgogICAgcHJvdGVjdGVkIHZvaWQgZW5kTmFtZWROYXRpdmVRdWVyeSgp\nCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgcG9wRWxl\nbWVudCgpOwogICAgfQoKICAgIC8qKgogICAgICogU3RhcnQgZW50aXR5LWxp\nc3RlbmVycwogICAgICovCiAgICBwcml2YXRlIGJvb2xlYW4gc3RhcnRFbnRp\ndHlMaXN0ZW5lcnMoQXR0cmlidXRlcyBhdHRycykKICAgICAgICB0aHJvd3Mg\nU0FYRXhjZXB0aW9uIHsKICAgICAgICBpZiAoIWlzTWV0YURhdGFNb2RlKCkp\nCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICBpZiAoY3VycmVu\ndEVsZW1lbnQoKSA9PSBudWxsKQogICAgICAgICAgICByZXR1cm4gdHJ1ZTsK\nCiAgICAgICAgLy8gcmVzZXQgbGlzdGVuZXJzIGRlY2xhcmVkIGluIGFubm90\nYXRpb25zLgogICAgICAgIExpZmVjeWNsZU1ldGFEYXRhIG1ldGEgPSAoKENs\nYXNzTWV0YURhdGEpIGN1cnJlbnRFbGVtZW50KCkpLgogICAgICAgICAgICBn\nZXRMaWZlY3ljbGVNZXRhRGF0YSgpOwogICAgICAgIGZvciAoaW50IGkgPSAw\nOyBpIDwgTGlmZWN5Y2xlRXZlbnQuQUxMX0VWRU5UUy5sZW5ndGg7IGkrKykK\nICAgICAgICAgICAgbWV0YS5zZXREZWNsYXJlZENhbGxiYWNrcyhpLCBudWxs\nLCAwKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvKioKICAg\nICAqIFBhcnNlIGV4Y2x1ZGUtZGVmYXVsdC1saXN0ZW5lcnMuCiAgICAgKi8K\nICAgIHByaXZhdGUgYm9vbGVhbiBzdGFydEV4Y2x1ZGVEZWZhdWx0TGlzdGVu\nZXJzKEF0dHJpYnV0ZXMgYXR0cnMpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2Vw\ndGlvbiB7CiAgICAgICAgaWYgKCFpc01ldGFEYXRhTW9kZSgpKQogICAgICAg\nICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgQ2xhc3NNZXRhRGF0YSBtZXRh\nID0gKENsYXNzTWV0YURhdGEpIGN1cnJlbnRFbGVtZW50KCk7CiAgICAgICAg\nbWV0YS5nZXRMaWZlY3ljbGVNZXRhRGF0YSgpLnNldElnbm9yZVN5c3RlbUxp\nc3RlbmVycyh0cnVlKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAg\nICAvKioKICAgICAqIFBhcnNlIGV4Y2x1ZGUtc3VwZXJjbGFzcy1saXN0ZW5l\ncnMuCiAgICAgKi8KICAgIHByaXZhdGUgYm9vbGVhbiBzdGFydEV4Y2x1ZGVT\ndXBlcmNsYXNzTGlzdGVuZXJzKEF0dHJpYnV0ZXMgYXR0cnMpCiAgICAgICAg\ndGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgaWYgKCFpc01ldGFEYXRh\nTW9kZSgpKQogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgQ2xh\nc3NNZXRhRGF0YSBtZXRhID0gKENsYXNzTWV0YURhdGEpIGN1cnJlbnRFbGVt\nZW50KCk7CiAgICAgICAgbWV0YS5nZXRMaWZlY3ljbGVNZXRhRGF0YSgpLnNl\ndElnbm9yZVN1cGVyY2xhc3NDYWxsYmFja3MKICAgICAgICAgICAgKExpZmVj\neWNsZU1ldGFEYXRhLklHTk9SRV9ISUdIKTsKICAgICAgICByZXR1cm4gdHJ1\nZTsKICAgIH0KCiAgICAvKioKICAgICAqIFBhcnNlIGVudGl0eS1saXN0ZW5l\nci4KICAgICAqLwogICAgcHJpdmF0ZSBib29sZWFuIHN0YXJ0RW50aXR5TGlz\ndGVuZXIoQXR0cmlidXRlcyBhdHRycykKICAgICAgICB0aHJvd3MgU0FYRXhj\nZXB0aW9uIHsKICAgICAgICBfbGlzdGVuZXIgPSBjbGFzc0Zvck5hbWUoYXR0\ncnMuZ2V0VmFsdWUoImNsYXNzIikpOwogICAgICAgIGJvb2xlYW4gc3lzdGVt\nID0gY3VycmVudEVsZW1lbnQoKSA9PSBudWxsOwogICAgICAgIENvbGxlY3Rp\nb248TGlmZWN5Y2xlQ2FsbGJhY2tzPltdIHBhcnNlZCA9CiAgICAgICAgICAg\nIEFubm90YXRpb25QZXJzaXN0ZW5jZU1ldGFEYXRhUGFyc2VyLnBhcnNlQ2Fs\nbGJhY2tNZXRob2RzKF9saXN0ZW5lciwKICAgICAgICAgICAgICAgIG51bGws\nIHRydWUsIHRydWUsIF9yZXBvcyk7CiAgICAgICAgaWYgKHBhcnNlZCA9PSBu\ndWxsKQogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKCiAgICAgICAgaWYgKF9j\nYWxsYmFja3MgPT0gbnVsbCkgewogICAgICAgICAgICBfY2FsbGJhY2tzID0g\nKENvbGxlY3Rpb248TGlmZWN5Y2xlQ2FsbGJhY2tzPltdKQogICAgICAgICAg\nICAgICAgbmV3IENvbGxlY3Rpb25bTGlmZWN5Y2xlRXZlbnQuQUxMX0VWRU5U\nUy5sZW5ndGhdOwogICAgICAgICAgICBpZiAoIXN5c3RlbSkKICAgICAgICAg\nICAgICAgIF9oaWdocyA9IG5ldyBpbnRbTGlmZWN5Y2xlRXZlbnQuQUxMX0VW\nRU5UUy5sZW5ndGhdOwogICAgICAgIH0KICAgICAgICBmb3IgKGludCBpID0g\nMDsgaSA8IHBhcnNlZC5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBpZiAo\ncGFyc2VkW2ldID09IG51bGwpCiAgICAgICAgICAgICAgICBjb250aW51ZTsK\nICAgICAgICAgICAgaWYgKF9jYWxsYmFja3NbaV0gPT0gbnVsbCkKICAgICAg\nICAgICAgICAgIF9jYWxsYmFja3NbaV0gPSBwYXJzZWRbaV07CiAgICAgICAg\nICAgIGVsc2UKICAgICAgICAgICAgICAgIF9jYWxsYmFja3NbaV0uYWRkQWxs\nKHBhcnNlZFtpXSk7CiAgICAgICAgICAgIGlmICghc3lzdGVtKQogICAgICAg\nICAgICAgICAgX2hpZ2hzW2ldICs9IHBhcnNlZFtpXS5zaXplKCk7CiAgICAg\nICAgfQogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIHByaXZhdGUg\ndm9pZCBlbmRFbnRpdHlMaXN0ZW5lcigpCiAgICAgICAgdGhyb3dzIFNBWEV4\nY2VwdGlvbiB7CiAgICAgICAgLy8gc2hvdWxkIGJlIGluIGVuZEVudGl0eUxp\nc3RlbmVycyBJIHRoaW5rIHRvIG1lcmdlIGNhbGxiYWNrcwogICAgICAgIC8v\nIGludG8gYSBzaW5nbGUgbGlzdGVuZXIuICBCdXQgdGhlbiB0aGUgdXNlciBj\nYW5ub3QgcmVtb3ZlLgogICAgICAgIGlmIChjdXJyZW50RWxlbWVudCgpID09\nIG51bGwgJiYgX2NhbGxiYWNrcyAhPSBudWxsKSB7CiAgICAgICAgICAgIF9y\nZXBvcy5hZGRTeXN0ZW1MaXN0ZW5lcihuZXcgUGVyc2lzdGVuY2VMaXN0ZW5l\nckFkYXB0ZXIKICAgICAgICAgICAgICAgIChfY2FsbGJhY2tzKSk7CiAgICAg\nICAgICAgIF9jYWxsYmFja3MgPSBudWxsOwogICAgICAgIH0KICAgICAgICBf\nbGlzdGVuZXIgPSBudWxsOwogICAgfQoKICAgIHByaXZhdGUgYm9vbGVhbiBz\ndGFydENhbGxiYWNrKE1ldGFEYXRhVGFnIGNhbGxiYWNrLCBBdHRyaWJ1dGVz\nIGF0dHJzKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24gewogICAgICAg\nIGlmICghaXNNZXRhRGF0YU1vZGUoKSkKICAgICAgICAgICAgcmV0dXJuIGZh\nbHNlOwogICAgICAgIGludFtdIGV2ZW50cyA9IE1ldGFEYXRhUGFyc2Vycy5n\nZXRFdmVudFR5cGVzKGNhbGxiYWNrKTsKICAgICAgICBpZiAoZXZlbnRzID09\nIG51bGwpCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCiAgICAgICAgYm9v\nbGVhbiBzeXN0ZW0gPSBjdXJyZW50RWxlbWVudCgpID09IG51bGw7CiAgICAg\nICAgQ2xhc3MgdHlwZSA9IGN1cnJlbnRFbGVtZW50KCkgPT0gbnVsbCA/IG51\nbGwgOgogICAgICAgICAgICAoKENsYXNzTWV0YURhdGEpIGN1cnJlbnRFbGVt\nZW50KCkpLmdldERlc2NyaWJlZFR5cGUoKTsKICAgICAgICBpZiAodHlwZSA9\nPSBudWxsKQogICAgICAgICAgICB0eXBlID0gT2JqZWN0LmNsYXNzOwoKICAg\nICAgICBpZiAoX2NhbGxiYWNrcyA9PSBudWxsKSB7CiAgICAgICAgICAgIF9j\nYWxsYmFja3MgPSAoQ29sbGVjdGlvbjxMaWZlY3ljbGVDYWxsYmFja3M+W10p\nCiAgICAgICAgICAgICAgICBuZXcgQ29sbGVjdGlvbltMaWZlY3ljbGVFdmVu\ndC5BTExfRVZFTlRTLmxlbmd0aF07CiAgICAgICAgICAgIGlmICghc3lzdGVt\nKQogICAgICAgICAgICAgICAgX2hpZ2hzID0gbmV3IGludFtMaWZlY3ljbGVF\ndmVudC5BTExfRVZFTlRTLmxlbmd0aF07CiAgICAgICAgfQoKICAgICAgICBN\nZXRhRGF0YURlZmF1bHRzIGRlZiA9IF9yZXBvcy5nZXRNZXRhRGF0YUZhY3Rv\ncnkoKS5nZXREZWZhdWx0cygpOwogICAgICAgIExpZmVjeWNsZUNhbGxiYWNr\ncyBhZGFwdGVyOwogICAgICAgIGlmIChfbGlzdGVuZXIgIT0gbnVsbCkKICAg\nICAgICAgICAgYWRhcHRlciA9IG5ldyBCZWFuTGlmZWN5Y2xlQ2FsbGJhY2tz\nKF9saXN0ZW5lciwKICAgICAgICAgICAgICAgIGF0dHJzLmdldFZhbHVlKCJt\nZXRob2QtbmFtZSIpLCBmYWxzZSwgdHlwZSk7CiAgICAgICAgZWxzZQogICAg\nICAgICAgICBhZGFwdGVyID0gbmV3IE1ldGhvZExpZmVjeWNsZUNhbGxiYWNr\ncyhfY2xzLAogICAgICAgICAgICAgICAgYXR0cnMuZ2V0VmFsdWUoIm1ldGhv\nZC1uYW1lIiksIGZhbHNlKTsKCiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkg\nPCBldmVudHMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgaW50IGV2ZW50\nID0gZXZlbnRzW2ldOwogICAgICAgICAgICBpZiAoX2xpc3RlbmVyICE9IG51\nbGwpIHsKICAgICAgICAgICAgICAgIE1ldGFEYXRhUGFyc2Vycy52YWxpZGF0\nZU1ldGhvZHNGb3JTYW1lQ2FsbGJhY2soX2xpc3RlbmVyLAogICAgICAgICAg\nICAgICAgICAgIF9jYWxsYmFja3NbZXZlbnRdLCAoKEJlYW5MaWZlY3ljbGVD\nYWxsYmFja3MpIGFkYXB0ZXIpLgogICAgICAgICAgICAgICAgICAgIGdldENh\nbGxiYWNrTWV0aG9kKCksIGNhbGxiYWNrLCBkZWYsIGdldExvZygpKTsKICAg\nICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIE1ldGFEYXRhUGFy\nc2Vycy52YWxpZGF0ZU1ldGhvZHNGb3JTYW1lQ2FsbGJhY2soX2NscywKICAg\nICAgICAgICAgICAgICAgICBfY2FsbGJhY2tzW2V2ZW50XSwgKChNZXRob2RM\naWZlY3ljbGVDYWxsYmFja3MpIGFkYXB0ZXIpLgogICAgICAgICAgICAgICAg\nICAgIGdldENhbGxiYWNrTWV0aG9kKCksIGNhbGxiYWNrLCBkZWYsIGdldExv\nZygpKTsKCiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKF9jYWxsYmFj\na3NbZXZlbnRdID09IG51bGwpCiAgICAgICAgICAgICAgICBfY2FsbGJhY2tz\nW2V2ZW50XSA9IG5ldyBBcnJheUxpc3Q8TGlmZWN5Y2xlQ2FsbGJhY2tzPigz\nKTsKICAgICAgICAgICAgX2NhbGxiYWNrc1tldmVudF0uYWRkKGFkYXB0ZXIp\nOwogICAgICAgICAgICBpZiAoIXN5c3RlbSAmJiBfbGlzdGVuZXIgIT0gbnVs\nbCkKICAgICAgICAgICAgICAgIF9oaWdoc1tldmVudF0rKzsKICAgICAgICB9\nCiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBT\ndG9yZSBsaWZlY3ljbGUgbWV0YWRhdGEuCiAgICAgKi8KICAgIHByaXZhdGUg\ndm9pZCBzdG9yZUNhbGxiYWNrcyhDbGFzc01ldGFEYXRhIGNscykgewogICAg\nICAgIExpZmVjeWNsZU1ldGFEYXRhIG1ldGEgPSBjbHMuZ2V0TGlmZWN5Y2xl\nTWV0YURhdGEoKTsKICAgICAgICBDbGFzcyBzdXBDbHMgPSBjbHMuZ2V0RGVz\nY3JpYmVkVHlwZSgpLmdldFN1cGVyY2xhc3MoKTsKICAgICAgICBDb2xsZWN0\naW9uPExpZmVjeWNsZUNhbGxiYWNrcz5bXSBzdXBDYWxscyA9IG51bGw7CiAg\nICAgICAgaWYgKCFPYmplY3QuY2xhc3MuZXF1YWxzKHN1cENscykpIHsKICAg\nICAgICAgICAgc3VwQ2FsbHMgPSBBbm5vdGF0aW9uUGVyc2lzdGVuY2VNZXRh\nRGF0YVBhcnNlci5wYXJzZUNhbGxiYWNrTWV0aG9kcwogICAgICAgICAgICAg\nICAgKHN1cENscywgbnVsbCwgdHJ1ZSwgZmFsc2UsIF9yZXBvcyk7CiAgICAg\nICAgfQogICAgICAgIGlmIChzdXBDYWxscyAhPSBudWxsKSB7CiAgICAgICAg\nICAgIGZvciAoaW50IGV2ZW50IDogTGlmZWN5Y2xlRXZlbnQuQUxMX0VWRU5U\nUykgewogICAgICAgICAgICAgICAgaWYgKHN1cENhbGxzW2V2ZW50XSA9PSBu\ndWxsKQogICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAg\nICAgICAgbWV0YS5zZXROb25QQ1N1cGVyY2xhc3NDYWxsYmFja3MoZXZlbnQs\nIHN1cENhbGxzW2V2ZW50XS50b0FycmF5CiAgICAgICAgICAgICAgICAgICAg\nKG5ldyBMaWZlY3ljbGVDYWxsYmFja3Nbc3VwQ2FsbHNbZXZlbnRdLnNpemUo\nKV0pLCAwKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBpZiAo\nX2NhbGxiYWNrcyA9PSBudWxsKQogICAgICAgICAgICByZXR1cm47CgogICAg\nICAgIGZvciAoaW50IGV2ZW50IDogTGlmZWN5Y2xlRXZlbnQuQUxMX0VWRU5U\nUykgewogICAgICAgICAgICBpZiAoX2NhbGxiYWNrc1tldmVudF0gPT0gbnVs\nbCkKICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICBtZXRh\nLnNldERlY2xhcmVkQ2FsbGJhY2tzKGV2ZW50LCAoTGlmZWN5Y2xlQ2FsbGJh\nY2tzW10pCiAgICAgICAgICAgICAgICBfY2FsbGJhY2tzW2V2ZW50XS50b0Fy\ncmF5CiAgICAgICAgICAgICAgICAgICAgKG5ldyBMaWZlY3ljbGVDYWxsYmFj\na3NbX2NhbGxiYWNrc1tldmVudF0uc2l6ZSgpXSksCiAgICAgICAgICAgICAg\nICBfaGlnaHNbZXZlbnRdKTsKICAgICAgICB9CiAgICAgICAgX2NhbGxiYWNr\ncyA9IG51bGw7CiAgICAgICAgX2hpZ2hzID0gbnVsbDsKICAgIH0KCiAgICAv\nKioKICAgICAqIEluc3RhbnRpYXRlIHRoZSBnaXZlbiBjbGFzcywgdGFraW5n\nIGludG8gYWNjb3VudCB0aGUgZGVmYXVsdCBwYWNrYWdlLgoJICovCglwcm90\nZWN0ZWQgQ2xhc3MgY2xhc3NGb3JOYW1lKFN0cmluZyBuYW1lKQoJCXRocm93\ncyBTQVhFeGNlcHRpb24gewoJCWlmICgiRW50aXR5Ii5lcXVhbHMobmFtZSkp\nCgkJCXJldHVybiBQZXJzaXN0ZW5jZUNhcGFibGUuY2xhc3M7CgkJcmV0dXJu\nIHN1cGVyLmNsYXNzRm9yTmFtZShuYW1lLCBpc1J1bnRpbWUoKSk7Cgl9Cn0K\n","encoding":"base64"}

