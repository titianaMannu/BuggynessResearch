{"sha":"9725c162499e0e8ffad47816291e4f3095c8d7ed","node_id":"MDQ6QmxvYjIwNjM2NDo5NzI1YzE2MjQ5OWUwZThmZmFkNDc4MTYyOTFlNGYzMDk1YzhkN2Vk","size":30018,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/9725c162499e0e8ffad47816291e4f3095c8d7ed","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuamRiYzsK\nCmltcG9ydCBqYXZhLnNxbC5UeXBlczsKaW1wb3J0IGphdmEudXRpbC5BcnJh\neUxpc3Q7CmltcG9ydCBqYXZhLnV0aWwuQXJyYXlzOwppbXBvcnQgamF2YS51\ndGlsLkVudW1TZXQ7CmltcG9ydCBqYXZhLnV0aWwuSGFzaE1hcDsKaW1wb3J0\nIGphdmEudXRpbC5MaXN0OwppbXBvcnQgamF2YS51dGlsLk1hcDsKaW1wb3J0\nIGphdmF4LnBlcnNpc3RlbmNlLkRpc2NyaW1pbmF0b3JUeXBlOwppbXBvcnQg\namF2YXgucGVyc2lzdGVuY2UuRW51bVR5cGU7CmltcG9ydCBqYXZheC5wZXJz\naXN0ZW5jZS5Jbmhlcml0YW5jZVR5cGU7CmltcG9ydCBqYXZheC5wZXJzaXN0\nZW5jZS5UZW1wb3JhbFR5cGU7CgppbXBvcnQgb3JnLmFwYWNoZS5jb21tb25z\nLmxhbmcuU3RyaW5nVXRpbHM7CmltcG9ydCBvcmcueG1sLnNheC5BdHRyaWJ1\ndGVzOwppbXBvcnQgb3JnLnhtbC5zYXguU0FYRXhjZXB0aW9uOwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuY29uZi5KREJDQ29uZmlndXJhdGlv\nbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLm1ldGEuQ2xhc3NN\nYXBwaW5nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0YS5D\nbGFzc01hcHBpbmdJbmZvOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpk\nYmMubWV0YS5EaXNjcmltaW5hdG9yTWFwcGluZ0luZm87CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhLkZpZWxkTWFwcGluZzsKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLm1ldGEuTWFwcGluZ1JlcG9zaXRv\ncnk7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhLlF1ZXJ5\nUmVzdWx0TWFwcGluZzsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJj\nLm1ldGEuU2VxdWVuY2VNYXBwaW5nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLmpkYmMubWV0YS5zdHJhdHMuRW51bVZhbHVlSGFuZGxlcjsKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLm1ldGEuc3RyYXRzLkZsYXRDbGFz\nc1N0cmF0ZWd5OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0\nYS5zdHJhdHMuRnVsbENsYXNzU3RyYXRlZ3k7CmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEuamRiYy5tZXRhLnN0cmF0cy5Ob25lQ2xhc3NTdHJhdGVneTsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLm1ldGEuc3RyYXRzLlZl\ncnRpY2FsQ2xhc3NTdHJhdGVneTsKaW1wb3J0IG9yZy5hcGFjaGUub3Blbmpw\nYS5qZGJjLnNjaGVtYS5Db2x1bW47CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEuamRiYy5zY2hlbWEuVW5pcXVlOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLmxpYi5sb2cuTG9nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxp\nYi51dGlsLkxvY2FsaXplcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5t\nZXRhLkNsYXNzTWV0YURhdGE7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\nbWV0YS5GaWVsZE1ldGFEYXRhOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLm1ldGEuSmF2YVR5cGVzOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1l\ndGEuTWV0YURhdGFSZXBvc2l0b3J5OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLnBlcnNpc3RlbmNlLlhNTFBlcnNpc3RlbmNlTWV0YURhdGFQYXJzZXI7\nCmltcG9ydCBzdGF0aWMgb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNl\nLmpkYmMuTWFwcGluZ1RhZy4qOwoKLyoqCiAqIEN1c3RvbSBTQVggcGFyc2Vy\nIHVzZWQgYnkgdGhlIHN5c3RlbSB0byBwYXJzZSBwZXJzaXN0ZW5jZSBtYXBw\naW5nIGZpbGVzLgogKgogKiBAYXV0aG9yIFN0ZXZlIEtpbQogKiBAbm9qYXZh\nZG9jCiAqLwpwdWJsaWMgY2xhc3MgWE1MUGVyc2lzdGVuY2VNYXBwaW5nUGFy\nc2VyCiAgICBleHRlbmRzIFhNTFBlcnNpc3RlbmNlTWV0YURhdGFQYXJzZXIg\newoKICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIE1hcDxTdHJpbmcsIE1hcHBp\nbmdUYWc+IF9lbGVtcyA9CiAgICAgICAgbmV3IEhhc2hNYXA8U3RyaW5nLCBN\nYXBwaW5nVGFnPigpOwoKICAgIHN0YXRpYyB7CiAgICAgICAgX2VsZW1zLnB1\ndCgiYXNzb2NpYXRpb24tb3ZlcnJpZGUiLCBBU1NPQ19PVkVSUklERSk7CiAg\nICAgICAgX2VsZW1zLnB1dCgiYXR0cmlidXRlLW92ZXJyaWRlIiwgQVRUUl9P\nVkVSUklERSk7CiAgICAgICAgX2VsZW1zLnB1dCgiY29sdW1uIiwgQ09MKTsK\nICAgICAgICBfZWxlbXMucHV0KCJjb2x1bW4tbmFtZSIsIENPTFVNTl9OQU1F\nKTsKICAgICAgICBfZWxlbXMucHV0KCJjb2x1bW4tcmVzdWx0IiwgQ09MVU1O\nX1JFU1VMVCk7CiAgICAgICAgX2VsZW1zLnB1dCgiZGlzY3JpbWluYXRvci1j\nb2x1bW4iLCBESVNDUklNX0NPTCk7CiAgICAgICAgX2VsZW1zLnB1dCgiZGlz\nY3JpbWluYXRvci12YWx1ZSIsIERJU0NSSU1fVkFMKTsKICAgICAgICBfZWxl\nbXMucHV0KCJlbnRpdHktcmVzdWx0IiwgRU5USVRZX1JFU1VMVCk7CiAgICAg\nICAgX2VsZW1zLnB1dCgiZW51bWVyYXRlZCIsIEVOVU1FUkFURUQpOwogICAg\nICAgIF9lbGVtcy5wdXQoImZpZWxkLXJlc3VsdCIsIEZJRUxEX1JFU1VMVCk7\nCiAgICAgICAgX2VsZW1zLnB1dCgiaW5oZXJpdGFuY2UiLCBJTkhFUklUQU5D\nRSk7CiAgICAgICAgX2VsZW1zLnB1dCgiam9pbi1jb2x1bW4iLCBKT0lOX0NP\nTCk7CiAgICAgICAgX2VsZW1zLnB1dCgiaW52ZXJzZS1qb2luLWNvbHVtbiIs\nIENPTCk7CiAgICAgICAgX2VsZW1zLnB1dCgiam9pbi10YWJsZSIsIEpPSU5f\nVEFCTEUpOwogICAgICAgIF9lbGVtcy5wdXQoInByaW1hcnkta2V5LWpvaW4t\nY29sdW1uIiwgUEtfSk9JTl9DT0wpOwogICAgICAgIF9lbGVtcy5wdXQoInNl\nY29uZGFyeS10YWJsZSIsIFNFQ09OREFSWV9UQUJMRSk7CiAgICAgICAgX2Vs\nZW1zLnB1dCgic3FsLXJlc3VsdC1zZXQtbWFwcGluZyIsIFNRTF9SRVNVTFRf\nU0VUX01BUFBJTkcpOwogICAgICAgIF9lbGVtcy5wdXQoInRhYmxlIiwgVEFC\nTEUpOwogICAgICAgIF9lbGVtcy5wdXQoInRhYmxlLWdlbmVyYXRvciIsIFRB\nQkxFX0dFTik7CiAgICAgICAgX2VsZW1zLnB1dCgidGVtcG9yYWwiLCBURU1Q\nT1JBTCk7CiAgICAgICAgX2VsZW1zLnB1dCgidW5pcXVlLWNvbnN0cmFpbnQi\nLCBVTklRVUUpOwogICAgfQoKICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIExv\nY2FsaXplciBfbG9jID0gTG9jYWxpemVyLmZvclBhY2thZ2UKICAgICAgICAo\nWE1MUGVyc2lzdGVuY2VNYXBwaW5nUGFyc2VyLmNsYXNzKTsKCiAgICBwcml2\nYXRlIFN0cmluZyBfb3ZlcnJpZGUgPSBudWxsOwogICAgcHJpdmF0ZSBTdHJp\nbmcgX3NjaGVtYSA9IG51bGw7CiAgICBwcml2YXRlIFN0cmluZyBfY29sVGFi\nbGUgPSBudWxsOwogICAgcHJpdmF0ZSBTdHJpbmcgX3NlY29uZGFyeVRhYmxl\nID0gbnVsbDsKICAgIHByaXZhdGUgTGlzdDxDb2x1bW4+IF9jb2xzID0gbnVs\nbDsKICAgIHByaXZhdGUgTGlzdDxDb2x1bW4+IF9qb2luQ29scyA9IG51bGw7\nCiAgICBwcml2YXRlIExpc3Q8Q29sdW1uPiBfc3VwSm9pbkNvbHMgPSBudWxs\nOwogICAgcHJpdmF0ZSBib29sZWFuIF9sb2IgPSBmYWxzZTsKICAgIHByaXZh\ndGUgVGVtcG9yYWxUeXBlIF90ZW1wb3JhbCA9IG51bGw7CiAgICBwcml2YXRl\nIEVudW1TZXQ8VW5pcXVlRmxhZz4gX3VuaXF1ZSA9IEVudW1TZXQubm9uZU9m\nKFVuaXF1ZUZsYWcuY2xhc3MpOwogICAgcHJpdmF0ZSBEaXNjcmltaW5hdG9y\nVHlwZSBfZGlzY1R5cGU7CiAgICBwcml2YXRlIENvbHVtbiBfZGlzY0NvbDsK\nICAgIHByaXZhdGUgaW50IF9yZXN1bHRJZHggPSAwOwoKICAgIC8qKgogICAg\nICogQ29uc3RydWN0b3I7IHN1cHBseSBjb25maWd1cmF0aW9uLgogICAgICov\nCiAgICBwdWJsaWMgWE1MUGVyc2lzdGVuY2VNYXBwaW5nUGFyc2VyKEpEQkND\nb25maWd1cmF0aW9uIGNvbmYpIHsKICAgICAgICBzdXBlcihjb25mKTsKICAg\nIH0KCiAgICBAT3ZlcnJpZGUKICAgIHByb3RlY3RlZCB2b2lkIHJlc2V0KCkg\newogICAgICAgIHN1cGVyLnJlc2V0KCk7CiAgICAgICAgY2xlYXJDb2x1bW5J\nbmZvKCk7CiAgICAgICAgY2xlYXJDbGFzc0luZm8oKTsKICAgICAgICBjbGVh\nclNlY29uZGFyeVRhYmxlSW5mbygpOwogICAgICAgIF9vdmVycmlkZSA9IG51\nbGw7CiAgICAgICAgX3NjaGVtYSA9IG51bGw7CiAgICAgICAgX3Jlc3VsdElk\neCA9IDA7CiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwcm90ZWN0ZWQgT2Jq\nZWN0IHN0YXJ0U3lzdGVtTWFwcGluZ0VsZW1lbnQoU3RyaW5nIG5hbWUsIEF0\ndHJpYnV0ZXMgYXR0cnMpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7\nCiAgICAgICAgTWFwcGluZ1RhZyB0YWcgPSBfZWxlbXMuZ2V0KG5hbWUpOwog\nICAgICAgIGlmICh0YWcgPT0gbnVsbCkgewogICAgICAgICAgICBpZiAoInNj\naGVtYSIuZXF1YWxzKG5hbWUpKQogICAgICAgICAgICAgICAgcmV0dXJuIG5h\nbWU7CiAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgIH0KCiAgICAg\nICAgYm9vbGVhbiByZXQ7CiAgICAgICAgc3dpdGNoICh0YWcpIHsKICAgICAg\nICAgICAgY2FzZSBUQUJMRV9HRU46CiAgICAgICAgICAgICAgICByZXQgPSBz\ndGFydFRhYmxlR2VuZXJhdG9yKGF0dHJzKTsKICAgICAgICAgICAgICAgIGJy\nZWFrOwogICAgICAgICAgICBjYXNlIFNRTF9SRVNVTFRfU0VUX01BUFBJTkc6\nCiAgICAgICAgICAgICAgICByZXQgPSBzdGFydFNRTFJlc3VsdFNldE1hcHBp\nbmcoYXR0cnMpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAg\nIGNhc2UgRU5USVRZX1JFU1VMVDoKICAgICAgICAgICAgICAgIHJldCA9IHN0\nYXJ0RW50aXR5UmVzdWx0KGF0dHJzKTsKICAgICAgICAgICAgICAgIGJyZWFr\nOwogICAgICAgICAgICBjYXNlIEZJRUxEX1JFU1VMVDoKICAgICAgICAgICAg\nICAgIHJldCA9IHN0YXJ0RmllbGRSZXN1bHQoYXR0cnMpOwogICAgICAgICAg\nICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgQ09MVU1OX1JFU1VMVDoK\nICAgICAgICAgICAgICAgIHJldCA9IHN0YXJ0Q29sdW1uUmVzdWx0KGF0dHJz\nKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBkZWZhdWx0\nOgogICAgICAgICAgICAgICAgcmV0ID0gZmFsc2U7CiAgICAgICAgfQogICAg\nICAgIHJldHVybiAocmV0KSA/IHRhZyA6IG51bGw7CiAgICB9CgogICAgQE92\nZXJyaWRlCiAgICBwcm90ZWN0ZWQgdm9pZCBlbmRTeXN0ZW1NYXBwaW5nRWxl\nbWVudChTdHJpbmcgbmFtZSkKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9u\nIHsKICAgICAgICBNYXBwaW5nVGFnIHRhZyA9IF9lbGVtcy5nZXQobmFtZSk7\nCiAgICAgICAgaWYgKHRhZyA9PSBudWxsKSB7CiAgICAgICAgICAgIGlmICgi\nc2NoZW1hIi5lcXVhbHMobmFtZSkpCiAgICAgICAgICAgICAgICBfc2NoZW1h\nID0gY3VycmVudFRleHQoKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAg\nIH0KCiAgICAgICAgc3dpdGNoICh0YWcpIHsKICAgICAgICAgICAgY2FzZSBT\nUUxfUkVTVUxUX1NFVF9NQVBQSU5HOgogICAgICAgICAgICAgICAgZW5kU1FM\nUmVzdWx0U2V0TWFwcGluZygpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAg\nICAgICAgICAgIGNhc2UgRU5USVRZX1JFU1VMVDoKICAgICAgICAgICAgICAg\nIGVuZEVudGl0eVJlc3VsdCgpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAg\nICAgICAgfQogICAgfQoKICAgIEBPdmVycmlkZQogICAgcHJvdGVjdGVkIE9i\namVjdCBzdGFydENsYXNzTWFwcGluZ0VsZW1lbnQoU3RyaW5nIG5hbWUsIEF0\ndHJpYnV0ZXMgYXR0cnMpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7\nCiAgICAgICAgTWFwcGluZ1RhZyB0YWcgPSBfZWxlbXMuZ2V0KG5hbWUpOwog\nICAgICAgIGlmICh0YWcgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIG51\nbGw7CgogICAgICAgIGJvb2xlYW4gcmV0OwogICAgICAgIHN3aXRjaCAodGFn\nKSB7CiAgICAgICAgICAgIGNhc2UgVEFCTEU6CiAgICAgICAgICAgICAgICBy\nZXQgPSBzdGFydFRhYmxlKGF0dHJzKTsKICAgICAgICAgICAgICAgIGJyZWFr\nOwogICAgICAgICAgICBjYXNlIFNFQ09OREFSWV9UQUJMRToKICAgICAgICAg\nICAgICAgIHJldCA9IHN0YXJ0U2Vjb25kYXJ5VGFibGUoYXR0cnMpOwogICAg\nICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgRElTQ1JJTV9D\nT0w6CiAgICAgICAgICAgICAgICBfZGlzY0NvbCA9IHBhcnNlQ29sdW1uKGF0\ndHJzKTsKICAgICAgICAgICAgICAgIHJldCA9IHRydWU7CiAgICAgICAgICAg\nICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSBESVNDUklNX1ZBTDoKICAg\nICAgICAgICAgICAgIHJldCA9IHRydWU7CiAgICAgICAgICAgICAgICBicmVh\nazsKICAgICAgICAgICAgY2FzZSBJTkhFUklUQU5DRToKICAgICAgICAgICAg\nICAgIHJldCA9IHN0YXJ0SW5oZXJpdGFuY2UoYXR0cnMpOwogICAgICAgICAg\nICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgQVNTT0NfT1ZFUlJJREU6\nCiAgICAgICAgICAgIGNhc2UgQVRUUl9PVkVSUklERToKICAgICAgICAgICAg\nICAgIHJldCA9IHN0YXJ0QXR0cmlidXRlT3ZlcnJpZGUoYXR0cnMpOwogICAg\nICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgUEtfSk9JTl9D\nT0w6CiAgICAgICAgICAgICAgICByZXQgPSBzdGFydFByaW1hcnlLZXlKb2lu\nQ29sdW1uKGF0dHJzKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAg\nICAgICBjYXNlIENPTDoKICAgICAgICAgICAgICAgIHJldCA9IHN0YXJ0Q29s\ndW1uKGF0dHJzKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAg\nICBjYXNlIEpPSU5fQ09MOgogICAgICAgICAgICAgICAgcmV0ID0gc3RhcnRK\nb2luQ29sdW1uKGF0dHJzKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAg\nICAgICAgICBjYXNlIEpPSU5fVEFCTEU6CiAgICAgICAgICAgICAgICByZXQg\nPSBzdGFydEpvaW5UYWJsZShhdHRycyk7CiAgICAgICAgICAgICAgICBicmVh\nazsKICAgICAgICAgICAgY2FzZSBUQUJMRV9HRU46CiAgICAgICAgICAgICAg\nICByZXQgPSBzdGFydFRhYmxlR2VuZXJhdG9yKGF0dHJzKTsKICAgICAgICAg\nICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIFVOSVFVRToKICAgICAg\nICAgICAgICAgIHJldCA9IHN0YXJ0VW5pcXVlQ29uc3RyYWludChhdHRycyk7\nCiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSBURU1Q\nT1JBTDoKICAgICAgICAgICAgY2FzZSBFTlVNRVJBVEVEOgogICAgICAgICAg\nICAgICAgcmV0ID0gdHJ1ZTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAg\nICAgICAgICBjYXNlIFNRTF9SRVNVTFRfU0VUX01BUFBJTkc6CiAgICAgICAg\nICAgICAgICByZXQgPSBzdGFydFNRTFJlc3VsdFNldE1hcHBpbmcoYXR0cnMp\nOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgRU5U\nSVRZX1JFU1VMVDoKICAgICAgICAgICAgICAgIHJldCA9IHN0YXJ0RW50aXR5\nUmVzdWx0KGF0dHJzKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAg\nICAgICBjYXNlIEZJRUxEX1JFU1VMVDoKICAgICAgICAgICAgICAgIHJldCA9\nIHN0YXJ0RmllbGRSZXN1bHQoYXR0cnMpOwogICAgICAgICAgICAgICAgYnJl\nYWs7CiAgICAgICAgICAgIGNhc2UgQ09MVU1OX1JFU1VMVDoKICAgICAgICAg\nICAgICAgIHJldCA9IHN0YXJ0Q29sdW1uUmVzdWx0KGF0dHJzKTsKICAgICAg\nICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIENPTFVNTl9OQU1F\nOgogICAgICAgICAgICAgICAgcmV0ID0gdHJ1ZTsKICAgICAgICAgICAgICAg\nIGJyZWFrOwogICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgICAg\ncmV0ID0gZmFsc2U7CiAgICAgICAgfQogICAgICAgIHJldHVybiAocmV0KSA/\nIHRhZyA6IG51bGw7CiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwcm90ZWN0\nZWQgdm9pZCBlbmRDbGFzc01hcHBpbmdFbGVtZW50KFN0cmluZyBuYW1lKQog\nICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24gewogICAgICAgIE1hcHBpbmdU\nYWcgdGFnID0gX2VsZW1zLmdldChuYW1lKTsKICAgICAgICBpZiAodGFnID09\nIG51bGwpCiAgICAgICAgICAgIHJldHVybjsKCiAgICAgICAgc3dpdGNoICh0\nYWcpIHsKICAgICAgICAgICAgY2FzZSBTRUNPTkRBUllfVEFCTEU6CiAgICAg\nICAgICAgICAgICBlbmRTZWNvbmRhcnlUYWJsZSgpOwogICAgICAgICAgICAg\nICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgRElTQ1JJTV9WQUw6CiAgICAg\nICAgICAgICAgICBlbmREaXNjcmltaW5hdG9yVmFsdWUoKTsKICAgICAgICAg\nICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIEFUVFJfT1ZFUlJJREU6\nCiAgICAgICAgICAgICAgICBlbmRBdHRyaWJ1dGVPdmVycmlkZSgpOwogICAg\nICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgSk9JTl9UQUJM\nRToKICAgICAgICAgICAgICAgIGVuZEpvaW5UYWJsZSgpOwogICAgICAgICAg\nICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgVEVNUE9SQUw6CiAgICAg\nICAgICAgICAgICBlbmRUZW1wb3JhbCgpOwogICAgICAgICAgICAgICAgYnJl\nYWs7CiAgICAgICAgICAgIGNhc2UgRU5VTUVSQVRFRDoKICAgICAgICAgICAg\nICAgIGVuZEVudW1lcmF0ZWQoKTsKICAgICAgICAgICAgICAgIGJyZWFrOwog\nICAgICAgICAgICBjYXNlIFNRTF9SRVNVTFRfU0VUX01BUFBJTkc6CiAgICAg\nICAgICAgICAgICBlbmRTUUxSZXN1bHRTZXRNYXBwaW5nKCk7CiAgICAgICAg\nICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSBFTlRJVFlfUkVTVUxU\nOgogICAgICAgICAgICAgICAgZW5kRW50aXR5UmVzdWx0KCk7CiAgICAgICAg\nICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSBVTklRVUU6CiAgICAg\nICAgICAgICAgICBlbmRVbmlxdWVDb25zdHJhaW50KCk7CiAgICAgICAgICAg\nICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSBDT0xVTU5fTkFNRToKICAg\nICAgICAgICAgICAgIGVuZENvbHVtbk5hbWUoKTsKICAgICAgICAgICAgICAg\nIGJyZWFrOwogICAgICAgIH0KICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHBy\nb3RlY3RlZCB2b2lkIHN0YXJ0Q2xhc3NNYXBwaW5nKENsYXNzTWV0YURhdGEg\nbWV0YSwgYm9vbGVhbiBtYXBwZWRTdXBlciwKICAgICAgICBBdHRyaWJ1dGVz\nIGF0dHJzKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24gewogICAgICAg\nIGlmIChtYXBwZWRTdXBlcikKICAgICAgICAgICAgKChDbGFzc01hcHBpbmcp\nIG1ldGEpLmdldE1hcHBpbmdJbmZvKCkuc2V0U3RyYXRlZ3kKICAgICAgICAg\nICAgICAgIChOb25lQ2xhc3NTdHJhdGVneS5BTElBUyk7CiAgICB9CgogICAg\nQE92ZXJyaWRlCiAgICBwcm90ZWN0ZWQgdm9pZCBlbmRDbGFzc01hcHBpbmco\nQ2xhc3NNZXRhRGF0YSBtZXRhKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRp\nb24gewogICAgICAgIENsYXNzTWFwcGluZyBjbSA9IChDbGFzc01hcHBpbmcp\nIG1ldGE7CiAgICAgICAgaWYgKF9zY2hlbWEgIT0gbnVsbCkKICAgICAgICAg\nICAgY20uZ2V0TWFwcGluZ0luZm8oKS5zZXRTY2hlbWFOYW1lKF9zY2hlbWEp\nOwoKICAgICAgICBpZiAoX3N1cEpvaW5Db2xzICE9IG51bGwpCiAgICAgICAg\nICAgIGNtLmdldE1hcHBpbmdJbmZvKCkuc2V0Q29sdW1ucyhfc3VwSm9pbkNv\nbHMpOwoKICAgICAgICBpZiAoX2Rpc2NDb2wgIT0gbnVsbCkgewogICAgICAg\nICAgICBEaXNjcmltaW5hdG9yTWFwcGluZ0luZm8gZGluZm8gPSBjbS5nZXRE\naXNjcmltaW5hdG9yKCkuCiAgICAgICAgICAgICAgICBnZXRNYXBwaW5nSW5m\nbygpOwogICAgICAgICAgICBpZiAoX2Rpc2NUeXBlICE9IG51bGwpIHsKICAg\nICAgICAgICAgICAgIHN3aXRjaCAoX2Rpc2NUeXBlKSB7CiAgICAgICAgICAg\nICAgICAgICAgY2FzZSBDSEFSOgogICAgICAgICAgICAgICAgICAgICAgICBf\nZGlzY0NvbC5zZXRKYXZhVHlwZShKYXZhVHlwZXMuQ0hBUik7CiAgICAgICAg\nICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIGNh\nc2UgSU5URUdFUjoKICAgICAgICAgICAgICAgICAgICAgICAgX2Rpc2NDb2wu\nc2V0SmF2YVR5cGUoSmF2YVR5cGVzLklOVCk7CiAgICAgICAgICAgICAgICAg\nICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6CiAg\nICAgICAgICAgICAgICAgICAgICAgIF9kaXNjQ29sLnNldEphdmFUeXBlKEph\ndmFUeXBlcy5TVFJJTkcpOwogICAgICAgICAgICAgICAgICAgICAgICBicmVh\nazsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAg\nICBkaW5mby5zZXRDb2x1bW5zKEFycmF5cy5hc0xpc3QobmV3IENvbHVtbltd\neyBfZGlzY0NvbCB9KSk7CiAgICAgICAgfQogICAgICAgIGNsZWFyQ2xhc3NJ\nbmZvKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBDbGVhciBjYWNoZWQgY2xh\nc3MgbWFwcGluZyBpbmZvLgogICAgICovCiAgICBwcml2YXRlIHZvaWQgY2xl\nYXJDbGFzc0luZm8oKSB7CiAgICAgICAgX3N1cEpvaW5Db2xzID0gbnVsbDsK\nICAgICAgICBfZGlzY0NvbCA9IG51bGw7CiAgICAgICAgX2Rpc2NUeXBlID0g\nbnVsbDsKICAgIH0KCiAgICAvKioKICAgICAqIFN0YXJ0IHRyYWNraW5nIHNl\nY29uZGFyeSB0YWJsZSBpbmZvcm1hdGlvbiBhbmQgY29sdW1ucwogICAgICov\nCiAgICBwcml2YXRlIGJvb2xlYW4gc3RhcnRTZWNvbmRhcnlUYWJsZShBdHRy\naWJ1dGVzIGF0dHJzKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24gewog\nICAgICAgIF9zZWNvbmRhcnlUYWJsZSA9IHRvVGFibGVOYW1lKGF0dHJzLmdl\ndFZhbHVlKCJzY2hlbWEiKSwKICAgICAgICAgICAgYXR0cnMuZ2V0VmFsdWUo\nIm5hbWUiKSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBTZXQgdGhlIHNlY29uZGFyeSB0YWJsZSBpbmZvcm1hdGlvbiBi\nYWNrIHRvIHRoZSBvd25pbmcgY2xhc3MgbWFwcGluZy4KICAgICAqLwogICAg\ncHJpdmF0ZSB2b2lkIGVuZFNlY29uZGFyeVRhYmxlKCkgewogICAgICAgIENs\nYXNzTWFwcGluZyBjbSA9IChDbGFzc01hcHBpbmcpIGN1cnJlbnRFbGVtZW50\nKCk7CiAgICAgICAgQ2xhc3NNYXBwaW5nSW5mbyBpbmZvID0gY20uZ2V0TWFw\ncGluZ0luZm8oKTsKICAgICAgICBpbmZvLnNldFNlY29uZGFyeVRhYmxlSm9p\nbkNvbHVtbnMoX3NlY29uZGFyeVRhYmxlLCBfam9pbkNvbHMpOwogICAgICAg\nIGNsZWFyU2Vjb25kYXJ5VGFibGVJbmZvKCk7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBDbGVhciBjYWNoZWQgc2Vjb25kYXJ5IHRhYmxlIGluZm8uCiAgICAg\nKi8KICAgIHByaXZhdGUgdm9pZCBjbGVhclNlY29uZGFyeVRhYmxlSW5mbygp\nIHsKICAgICAgICBfam9pbkNvbHMgPSBudWxsOwogICAgICAgIF9zZWNvbmRh\ncnlUYWJsZSA9IG51bGw7CiAgICB9CgogICAgLyoqCiAgICAgKiBQYXJzZSB0\nYWJsZS1nZW5lcmF0b3IuCiAgICAgKi8KICAgIHByaXZhdGUgYm9vbGVhbiBz\ndGFydFRhYmxlR2VuZXJhdG9yKEF0dHJpYnV0ZXMgYXR0cnMpIHsKICAgICAg\nICBTdHJpbmcgbmFtZSA9IGF0dHJzLmdldFZhbHVlKCJuYW1lIik7CiAgICAg\nICAgTG9nIGxvZyA9IGdldExvZygpOwogICAgICAgIGlmIChsb2cuaXNUcmFj\nZUVuYWJsZWQoKSkKICAgICAgICAgICAgbG9nLnRyYWNlKF9sb2MuZ2V0KCJw\nYXJzZS1nZW4iLCBuYW1lKSk7CiAgICAgICAgaWYgKGdldFJlcG9zaXRvcnko\nKS5nZXRDYWNoZWRTZXF1ZW5jZU1ldGFEYXRhKG5hbWUpICE9IG51bGwKICAg\nICAgICAgICAgJiYgbG9nLmlzV2FybkVuYWJsZWQoKSkKICAgICAgICAgICAg\nbG9nLndhcm4oX2xvYy5nZXQoIm92ZXJyaWRlLWdlbiIsIG5hbWUpKTsKCiAg\nICAgICAgU2VxdWVuY2VNYXBwaW5nIHNlcSA9IChTZXF1ZW5jZU1hcHBpbmcp\nIGdldFJlcG9zaXRvcnkoKS4KICAgICAgICAgICAgYWRkU2VxdWVuY2VNZXRh\nRGF0YShuYW1lKTsKICAgICAgICBzZXEuc2V0U2VxdWVuY2VQbHVnaW4oU2Vx\ndWVuY2VNYXBwaW5nLklNUExfVkFMVUVfVEFCTEUpOwogICAgICAgIHNlcS5z\nZXRUYWJsZSh0b1RhYmxlTmFtZShhdHRycy5nZXRWYWx1ZSgic2NoZW1hIiks\nCiAgICAgICAgICAgIGF0dHJzLmdldFZhbHVlKCJ0YWJsZSIpKSk7CiAgICAg\nICAgc2VxLnNldFByaW1hcnlLZXlDb2x1bW4oYXR0cnMuZ2V0VmFsdWUoInBr\nLWNvbHVtbi1uYW1lIikpOwogICAgICAgIHNlcS5zZXRTZXF1ZW5jZUNvbHVt\nbihhdHRycy5nZXRWYWx1ZSgidmFsdWUtY29sdW1uLW5hbWUiKSk7CiAgICAg\nICAgc2VxLnNldFByaW1hcnlLZXlWYWx1ZShhdHRycy5nZXRWYWx1ZSgicGst\nY29sdW1uLXZhbHVlIikpOwogICAgICAgIFN0cmluZyB2YWwgPSBhdHRycy5n\nZXRWYWx1ZSgiaW5pdGlhbC12YWx1ZSIpOwogICAgICAgIGlmICh2YWwgIT0g\nbnVsbCkKICAgICAgICAgICAgc2VxLnNldEluaXRpYWxWYWx1ZShJbnRlZ2Vy\nLnBhcnNlSW50KHZhbCkpOwogICAgICAgIHZhbCA9IGF0dHJzLmdldFZhbHVl\nKCJhbGxvY2F0aW9uLXNpemUiKTsKICAgICAgICBpZiAodmFsICE9IG51bGwp\nCiAgICAgICAgICAgIHNlcS5zZXRBbGxvY2F0ZShJbnRlZ2VyLnBhcnNlSW50\nKHZhbCkpOwoKICAgICAgICBPYmplY3QgY3VyID0gY3VycmVudEVsZW1lbnQo\nKTsKICAgICAgICBPYmplY3Qgc2NvcGUgPSAoY3VyIGluc3RhbmNlb2YgQ2xh\nc3NNZXRhRGF0YSkKICAgICAgICAgICAgPyAoKENsYXNzTWV0YURhdGEpIGN1\ncikuZ2V0RGVzY3JpYmVkVHlwZSgpIDogbnVsbDsKICAgICAgICBzZXEuc2V0\nU291cmNlKGdldFNvdXJjZUZpbGUoKSwgc2NvcGUsIHNlcS5TUkNfWE1MKTsK\nICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvKioKICAgICAqIFBh\ncnNlIGluaGVyaXRhbmNlLgogICAgICovCiAgICBwcml2YXRlIGJvb2xlYW4g\nc3RhcnRJbmhlcml0YW5jZShBdHRyaWJ1dGVzIGF0dHJzKSB7CiAgICAgICAg\nU3RyaW5nIHZhbCA9IGF0dHJzLmdldFZhbHVlKCJzdHJhdGVneSIpOwogICAg\nICAgIGlmICh2YWwgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIHRydWU7\nCgogICAgICAgIENsYXNzTWFwcGluZyBjbSA9IChDbGFzc01hcHBpbmcpIGN1\ncnJlbnRFbGVtZW50KCk7CiAgICAgICAgQ2xhc3NNYXBwaW5nSW5mbyBpbmZv\nID0gY20uZ2V0TWFwcGluZ0luZm8oKTsKICAgICAgICBzd2l0Y2ggKEVudW0u\ndmFsdWVPZihJbmhlcml0YW5jZVR5cGUuY2xhc3MsIHZhbCkpIHsKICAgICAg\nICAgICAgY2FzZSBTSU5HTEVfVEFCTEU6CiAgICAgICAgICAgICAgICBpbmZv\nLnNldEhpZXJhcmNoeVN0cmF0ZWd5KEZsYXRDbGFzc1N0cmF0ZWd5LkFMSUFT\nKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIEpP\nSU5FRDoKICAgICAgICAgICAgICAgIGluZm8uc2V0SGllcmFyY2h5U3RyYXRl\nZ3koVmVydGljYWxDbGFzc1N0cmF0ZWd5LkFMSUFTKTsKICAgICAgICAgICAg\nICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIFRBQkxFX1BFUl9DTEFTUzoK\nICAgICAgICAgICAgICAgIGluZm8uc2V0SGllcmFyY2h5U3RyYXRlZ3koRnVs\nbENsYXNzU3RyYXRlZ3kuQUxJQVMpOwogICAgICAgICAgICAgICAgYnJlYWs7\nCiAgICAgICAgfQogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8q\nKgogICAgICogUGFyc2UgZGlzY3JpbWluYXRvci12YWx1ZS4KICAgICAqLwog\nICAgcHJpdmF0ZSB2b2lkIGVuZERpc2NyaW1pbmF0b3JWYWx1ZSgpIHsKICAg\nICAgICBTdHJpbmcgdmFsID0gY3VycmVudFRleHQoKTsKICAgICAgICBpZiAo\nU3RyaW5nVXRpbHMuaXNFbXB0eSh2YWwpKQogICAgICAgICAgICByZXR1cm47\nCgogICAgICAgIENsYXNzTWFwcGluZyBjbSA9IChDbGFzc01hcHBpbmcpIGN1\ncnJlbnRFbGVtZW50KCk7CiAgICAgICAgY20uZ2V0RGlzY3JpbWluYXRvcigp\nLmdldE1hcHBpbmdJbmZvKCkuc2V0VmFsdWUodmFsKTsKICAgIH0KCiAgICAv\nKioKICAgICAqIFBhcnNlIHRlbXBvcmFsLgogICAgICovCiAgICBwcml2YXRl\nIHZvaWQgZW5kVGVtcG9yYWwoKSB7CiAgICAgICAgU3RyaW5nIHRlbXAgPSBj\ndXJyZW50VGV4dCgpOwogICAgICAgIGlmICghU3RyaW5nVXRpbHMuaXNFbXB0\neSh0ZW1wKSkKICAgICAgICAgICAgX3RlbXBvcmFsID0gRW51bS52YWx1ZU9m\nKFRlbXBvcmFsVHlwZS5jbGFzcywgdGVtcCk7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBQYXJzZSBlbnVtZXJhdGVkLgogICAgICovCiAgICBwcml2YXRlIHZv\naWQgZW5kRW51bWVyYXRlZCgpIHsKICAgICAgICBTdHJpbmcgdGV4dCA9IGN1\ncnJlbnRUZXh0KCk7CiAgICAgICAgaWYgKFN0cmluZ1V0aWxzLmlzRW1wdHko\ndGV4dCkpCiAgICAgICAgICAgIHJldHVybjsKICAgICAgICBFbnVtVHlwZSB0\neXBlID0gRW51bS52YWx1ZU9mKEVudW1UeXBlLmNsYXNzLCB0ZXh0KTsKCiAg\nICAgICAgRmllbGRNYXBwaW5nIGZtID0gKEZpZWxkTWFwcGluZykgY3VycmVu\ndEVsZW1lbnQoKTsKICAgICAgICBTdHJpbmcgc3RyYXQgPSBFbnVtVmFsdWVI\nYW5kbGVyLmNsYXNzLmdldE5hbWUoKSArICIoU3RvcmVPcmRpbmFsPSIKICAg\nICAgICAgICAgKyBTdHJpbmcudmFsdWVPZih0eXBlID09IEVudW1UeXBlLk9S\nRElOQUwpICsgIikiOwogICAgICAgIGZtLmdldFZhbHVlSW5mbygpLnNldFN0\ncmF0ZWd5KHN0cmF0KTsKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHByb3Rl\nY3RlZCBib29sZWFuIHN0YXJ0TG9iKEF0dHJpYnV0ZXMgYXR0cnMpCiAgICAg\nICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgaWYgKHN1cGVyLnN0\nYXJ0TG9iKGF0dHJzKSkgewogICAgICAgICAgICBfbG9iID0gdHJ1ZTsKICAg\nICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQogICAgICAgIHJldHVy\nbiBmYWxzZTsKICAgIH0KCiAgICAvKioKICAgICAqIEV4dGVuZCB0byBjbGVh\nciBhbm5vdGF0aW9uIG1hcHBpbmcgaW5mby4KICAgICAqLwogICAgQE92ZXJy\naWRlCiAgICBwcm90ZWN0ZWQgdm9pZCBzdGFydEZpZWxkTWFwcGluZyhGaWVs\nZE1ldGFEYXRhIGZpZWxkLCBBdHRyaWJ1dGVzIGF0dHJzKQogICAgICAgIHRo\ncm93cyBTQVhFeGNlcHRpb24gewogICAgICAgIHN1cGVyLnN0YXJ0RmllbGRN\nYXBwaW5nKGZpZWxkLCBhdHRycyk7CiAgICAgICAgaWYgKGdldEFubm90YXRp\nb25QYXJzZXIoKSAhPSBudWxsKSB7CiAgICAgICAgICAgIEZpZWxkTWFwcGlu\nZyBmbSA9IChGaWVsZE1hcHBpbmcpIGZpZWxkOwogICAgICAgICAgICBmbS5n\nZXRNYXBwaW5nSW5mbygpLmNsZWFyKCk7CiAgICAgICAgICAgIGZtLmdldFZh\nbHVlSW5mbygpLmNsZWFyKCk7CiAgICAgICAgICAgIGZtLmdldEVsZW1lbnRN\nYXBwaW5nKCkuZ2V0VmFsdWVJbmZvKCkuY2xlYXIoKTsKICAgICAgICAgICAg\nZm0uZ2V0S2V5TWFwcGluZygpLmdldFZhbHVlSW5mbygpLmNsZWFyKCk7CiAg\nICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogRXh0ZW5kIHRvIHNldCB0\naGUgY29sdW1ucy4KICAgICAqLwogICAgQE92ZXJyaWRlCiAgICBwcm90ZWN0\nZWQgdm9pZCBlbmRGaWVsZE1hcHBpbmcoRmllbGRNZXRhRGF0YSBmaWVsZCkK\nICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICAvLyBzZXR1\ncCBjb2x1bW5zIHdpdGggY2FjaGVkIGxvYiBhbmQgdGVtcG9yYWwgaW5mbwog\nICAgICAgIEZpZWxkTWFwcGluZyBmbSA9IChGaWVsZE1hcHBpbmcpIGZpZWxk\nOwogICAgICAgIGlmIChfbG9iIHx8IF90ZW1wb3JhbCAhPSBudWxsKSB7CiAg\nICAgICAgICAgIGlmIChfY29scyA9PSBudWxsKSB7CiAgICAgICAgICAgICAg\nICBfY29scyA9IG5ldyBBcnJheUxpc3Q8Q29sdW1uPigxKTsKICAgICAgICAg\nICAgICAgIF9jb2xzLmFkZChuZXcgQ29sdW1uKCkpOwogICAgICAgICAgICB9\nCiAgICAgICAgICAgIGZvciAoQ29sdW1uIGNvbCA6IF9jb2xzKSB7CiAgICAg\nICAgICAgICAgICBpZiAoX2xvYiAmJiAoZm0uZ2V0RGVjbGFyZWRUeXBlQ29k\nZSgpID09IEphdmFUeXBlcy5TVFJJTkcKICAgICAgICAgICAgICAgICAgICB8\nfCBmbS5nZXREZWNsYXJlZFR5cGUoKSA9PSBjaGFyW10uY2xhc3MKICAgICAg\nICAgICAgICAgICAgICB8fCBmbS5nZXREZWNsYXJlZFR5cGUoKSA9PSBDaGFy\nYWN0ZXJbXS5jbGFzcykpIHsKICAgICAgICAgICAgICAgICAgICBjb2wuc2V0\nU2l6ZSgtMSk7CiAgICAgICAgICAgICAgICAgICAgY29sLnNldFR5cGUoVHlw\nZXMuQ0xPQik7CiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKF9sb2IpCiAg\nICAgICAgICAgICAgICAgICAgY29sLnNldFR5cGUoVHlwZXMuQkxPQik7CiAg\nICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBzd2l0\nY2ggKF90ZW1wb3JhbCkgewogICAgICAgICAgICAgICAgICAgICAgICBjYXNl\nIERBVEU6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2wuc2V0VHlw\nZShUeXBlcy5EQVRFKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJy\nZWFrOwogICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFRJTUU6CiAgICAg\nICAgICAgICAgICAgICAgICAgICAgICBjb2wuc2V0VHlwZShUeXBlcy5USU1F\nKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAg\nICAgICAgICAgICAgICAgICBjYXNlIFRJTUVTVEFNUDoKICAgICAgICAgICAg\nICAgICAgICAgICAgICAgIGNvbC5zZXRUeXBlKFR5cGVzLlRJTUVTVEFNUCk7\nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAg\nICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0K\nICAgICAgICB9CgogICAgICAgIGlmIChfY29scyAhPSBudWxsKSB7CiAgICAg\nICAgICAgIHN3aXRjaCAoZm0uZ2V0RGVjbGFyZWRUeXBlQ29kZSgpKSB7CiAg\nICAgICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5BUlJBWToKICAgICAgICAg\nICAgICAgICAgICBpZiAoZm0uZ2V0RGVjbGFyZWRUeXBlKCkgPT0gYnl0ZVtd\nLmNsYXNzCiAgICAgICAgICAgICAgICAgICAgICAgIHx8IGZtLmdldERlY2xh\ncmVkVHlwZSgpID09IGNoYXJbXS5jbGFzcwogICAgICAgICAgICAgICAgICAg\nICAgICB8fCBmbS5nZXREZWNsYXJlZFR5cGUoKSA9PSBDaGFyYWN0ZXJbXS5j\nbGFzcykgewogICAgICAgICAgICAgICAgICAgICAgICBmbS5nZXRWYWx1ZUlu\nZm8oKS5zZXRDb2x1bW5zKF9jb2xzKTsKICAgICAgICAgICAgICAgICAgICAg\nICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAg\nICAgICAgIC8vIGVsc2Ugbm8gYnJlYWsKICAgICAgICAgICAgICAgIGNhc2Ug\nSmF2YVR5cGVzLkNPTExFQ1RJT046CiAgICAgICAgICAgICAgICBjYXNlIEph\ndmFUeXBlcy5NQVA6CiAgICAgICAgICAgICAgICAgICAgZm0uZ2V0RWxlbWVu\ndE1hcHBpbmcoKS5nZXRWYWx1ZUluZm8oKS5zZXRDb2x1bW5zKF9jb2xzKTsK\nICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGRl\nZmF1bHQ6CiAgICAgICAgICAgICAgICAgICAgZm0uZ2V0VmFsdWVJbmZvKCku\nc2V0Q29sdW1ucyhfY29scyk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAg\naWYgKF9jb2xUYWJsZSAhPSBudWxsKQogICAgICAgICAgICAgICAgZm0uZ2V0\nTWFwcGluZ0luZm8oKS5zZXRUYWJsZU5hbWUoX2NvbFRhYmxlKTsKICAgICAg\nICAgICAgc2V0VW5pcXVlKGZtKTsKICAgICAgICB9CiAgICAgICAgY2xlYXJD\nb2x1bW5JbmZvKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBTZXQgdW5pcXVl\nIGZvciBmaWVsZC4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIHNldFVuaXF1\nZShGaWVsZE1hcHBpbmcgZm0pIHsKICAgICAgICBpZiAoX3VuaXF1ZS5zaXpl\nKCkgPT0gMikgLy8gaS5lLiBUUlVFICYgRkFMU0UKICAgICAgICAgICAgZ2V0\nTG9nKCkud2FybihfbG9jLmdldCgiaW5jb25zaXN0LWNvbC1hdHRycyIsIGZt\nKSk7CiAgICAgICAgZWxzZSBpZiAoX3VuaXF1ZS5jb250YWlucyhVbmlxdWVG\nbGFnLlRSVUUpKQogICAgICAgICAgICBmbS5nZXRWYWx1ZUluZm8oKS5zZXRV\nbmlxdWUobmV3IFVuaXF1ZSgpKTsKICAgIH0KCiAgICAvKioKICAgICAqIENs\nZWFyIGZpZWxkIGxldmVsIGNvbHVtbiBpbmZvcm1hdGlvbi4KICAgICAqLwog\nICAgcHJpdmF0ZSB2b2lkIGNsZWFyQ29sdW1uSW5mbygpIHsKICAgICAgICBf\nY29scyA9IG51bGw7CiAgICAgICAgX2pvaW5Db2xzID0gbnVsbDsKICAgICAg\nICBfY29sVGFibGUgPSBudWxsOwogICAgICAgIF9sb2IgPSBmYWxzZTsKICAg\nICAgICBfdGVtcG9yYWwgPSBudWxsOwogICAgICAgIF91bmlxdWUuY2xlYXIo\nKTsKICAgIH0KCiAgICAvKioKICAgICAqIFBhcnNlIGF0dHJpYnV0ZS1vdmVy\ncmlkZS4KICAgICAqLwogICAgcHJpdmF0ZSBib29sZWFuIHN0YXJ0QXR0cmli\ndXRlT3ZlcnJpZGUoQXR0cmlidXRlcyBhdHRyKSB7CiAgICAgICAgX292ZXJy\naWRlID0gYXR0ci5nZXRWYWx1ZSgibmFtZSIpOwogICAgICAgIHJldHVybiB0\ncnVlOwogICAgfQoKICAgIC8qKgogICAgICogU2V0IGF0dHJpYnV0ZSBvdmVy\ncmlkZSBpbnRvIHByb3BlciBtYXBwaW5nLgogICAgICovCiAgICBwcml2YXRl\nIHZvaWQgZW5kQXR0cmlidXRlT3ZlcnJpZGUoKQogICAgICAgIHRocm93cyBT\nQVhFeGNlcHRpb24gewogICAgICAgIE9iamVjdCBlbGVtID0gY3VycmVudEVs\nZW1lbnQoKTsKICAgICAgICBGaWVsZE1hcHBpbmcgZm07CiAgICAgICAgaWYg\nKGVsZW0gaW5zdGFuY2VvZiBDbGFzc01hcHBpbmcpCiAgICAgICAgICAgIGZt\nID0gZ2V0QXR0cmlidXRlT3ZlcnJpZGUoKENsYXNzTWFwcGluZykgZWxlbSk7\nCiAgICAgICAgZWxzZQogICAgICAgICAgICBmbSA9IGdldEF0dHJpYnV0ZU92\nZXJyaWRlKChGaWVsZE1hcHBpbmcpIGVsZW0pOwogICAgICAgIGlmIChfY29s\ncyAhPSBudWxsKSB7CiAgICAgICAgICAgIGZtLmdldFZhbHVlSW5mbygpLnNl\ndENvbHVtbnMoX2NvbHMpOwogICAgICAgICAgICBpZiAoX2NvbFRhYmxlICE9\nIG51bGwpCiAgICAgICAgICAgICAgICBmbS5nZXRNYXBwaW5nSW5mbygpLnNl\ndFRhYmxlTmFtZShfY29sVGFibGUpOwogICAgICAgICAgICBzZXRVbmlxdWUo\nZm0pOwogICAgICAgIH0KICAgICAgICBjbGVhckNvbHVtbkluZm8oKTsKICAg\nICAgICBfb3ZlcnJpZGUgPSBudWxsOwogICAgfQoKICAgIC8qKgogICAgICog\nUmV0dXJuIHRoZSBwcm9wZXIgb3ZlcnJpZGUuCiAgICAgKi8KICAgIHByaXZh\ndGUgRmllbGRNYXBwaW5nIGdldEF0dHJpYnV0ZU92ZXJyaWRlKENsYXNzTWFw\ncGluZyBjbSkgewogICAgICAgIEZpZWxkTWFwcGluZyBzdXAgPSAoRmllbGRN\nYXBwaW5nKSBjbS5nZXREZWZpbmVkU3VwZXJjbGFzc0ZpZWxkCiAgICAgICAg\nICAgIChfb3ZlcnJpZGUpOwogICAgICAgIGlmIChzdXAgPT0gbnVsbCkKICAg\nICAgICAgICAgc3VwID0gKEZpZWxkTWFwcGluZykgY20uYWRkRGVmaW5lZFN1\ncGVyY2xhc3NGaWVsZChfb3ZlcnJpZGUsCiAgICAgICAgICAgICAgICBPYmpl\nY3QuY2xhc3MsIE9iamVjdC5jbGFzcyk7CiAgICAgICAgcmV0dXJuIHN1cDsK\nICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgcHJvcGVyIG92ZXJy\naWRlLgogICAgICovCiAgICBwcml2YXRlIEZpZWxkTWFwcGluZyBnZXRBdHRy\naWJ1dGVPdmVycmlkZShGaWVsZE1hcHBpbmcgZm0pCiAgICAgICAgdGhyb3dz\nIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgQ2xhc3NNYXBwaW5nIGVtYmVkID0g\nZm0uZ2V0RW1iZWRkZWRNYXBwaW5nKCk7CiAgICAgICAgaWYgKGVtYmVkID09\nIG51bGwpCiAgICAgICAgICAgIHRocm93IGdldEV4Y2VwdGlvbihfbG9jLmdl\ndCgibm90LWVtYmVkZGVkIiwgZm0pKTsKCiAgICAgICAgRmllbGRNYXBwaW5n\nIGVmbSA9IGVtYmVkLmdldEZpZWxkTWFwcGluZyhfb3ZlcnJpZGUpOwogICAg\nICAgIGlmIChlZm0gPT0gbnVsbCkKICAgICAgICAgICAgdGhyb3cgZ2V0RXhj\nZXB0aW9uKF9sb2MuZ2V0KCJlbWJlZC1vdmVycmlkZS1uYW1lIiwKICAgICAg\nICAgICAgICAgIGZtLCBfb3ZlcnJpZGUpKTsKICAgICAgICByZXR1cm4gZWZt\nOwogICAgfQoKICAgIC8qKgogICAgICogUGFyc2UgdGFibGUuCiAgICAgKi8K\nICAgIHByaXZhdGUgYm9vbGVhbiBzdGFydFRhYmxlKEF0dHJpYnV0ZXMgYXR0\ncnMpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgU3Ry\naW5nIHRhYmxlID0gdG9UYWJsZU5hbWUoYXR0cnMuZ2V0VmFsdWUoInNjaGVt\nYSIpLAogICAgICAgICAgICBhdHRycy5nZXRWYWx1ZSgibmFtZSIpKTsKICAg\nICAgICBpZiAodGFibGUgIT0gbnVsbCkKICAgICAgICAgICAgKChDbGFzc01h\ncHBpbmcpIGN1cnJlbnRFbGVtZW50KCkpLmdldE1hcHBpbmdJbmZvKCkuc2V0\nVGFibGVOYW1lCiAgICAgICAgICAgICAgICAodGFibGUpOwogICAgICAgIHJl\ndHVybiB0cnVlOwogICAgfQoKICAgIC8qKgogICAgICogUGFyc2Ugam9pbi10\nYWJsZS4KICAgICAqLwogICAgcHJpdmF0ZSBib29sZWFuIHN0YXJ0Sm9pblRh\nYmxlKEF0dHJpYnV0ZXMgYXR0cnMpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2Vw\ndGlvbiB7CiAgICAgICAgU3RyaW5nIHRhYmxlID0gdG9UYWJsZU5hbWUoYXR0\ncnMuZ2V0VmFsdWUoInNjaGVtYSIpLAogICAgICAgICAgICBhdHRycy5nZXRW\nYWx1ZSgibmFtZSIpKTsKICAgICAgICBpZiAodGFibGUgIT0gbnVsbCkKICAg\nICAgICAgICAgKChGaWVsZE1hcHBpbmcpIGN1cnJlbnRFbGVtZW50KCkpLmdl\ndE1hcHBpbmdJbmZvKCkuc2V0VGFibGVOYW1lCiAgICAgICAgICAgICAgICAo\ndGFibGUpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qKgog\nICAgICogU2V0IHRoZSBqb2luIHRhYmxlIGluZm9ybWF0aW9uIGJhY2suCiAg\nICAgKi8KICAgIHByaXZhdGUgdm9pZCBlbmRKb2luVGFibGUoKSB7CiAgICAg\nICAgRmllbGRNYXBwaW5nIGZtID0gKEZpZWxkTWFwcGluZykgY3VycmVudEVs\nZW1lbnQoKTsKICAgICAgICBpZiAoX2pvaW5Db2xzICE9IG51bGwpCiAgICAg\nICAgICAgIGZtLmdldE1hcHBpbmdJbmZvKCkuc2V0Q29sdW1ucyhfam9pbkNv\nbHMpOwogICAgICAgIGlmIChfY29scyAhPSBudWxsKQogICAgICAgICAgICBm\nbS5nZXRFbGVtZW50TWFwcGluZygpLmdldFZhbHVlSW5mbygpLnNldENvbHVt\nbnMoX2NvbHMpOwogICAgICAgIGNsZWFyQ29sdW1uSW5mbygpOwogICAgfQoK\nICAgIC8qKgogICAgICogUGFyc2UgcHJpbWFyeS1rZXktam9pbi1jb2x1bW4u\nCiAgICAgKi8KICAgIHByaXZhdGUgYm9vbGVhbiBzdGFydFByaW1hcnlLZXlK\nb2luQ29sdW1uKEF0dHJpYnV0ZXMgYXR0cnMpCiAgICAgICAgdGhyb3dzIFNB\nWEV4Y2VwdGlvbiB7CiAgICAgICAgQ29sdW1uIGNvbCA9IHBhcnNlQ29sdW1u\nKGF0dHJzKTsKICAgICAgICBjb2wuc2V0RmxhZyhDb2x1bW4uRkxBR19QS19K\nT0lOLCB0cnVlKTsKICAgICAgICAvLyBwayBqb2luIGNvbHVtbnMgb24gZmll\nbGRzIGFjdCBhcyBmaWVsZCBjb2xzCiAgICAgICAgaWYgKGN1cnJlbnRFbGVt\nZW50KCkgaW5zdGFuY2VvZiBGaWVsZE1hcHBpbmcpIHsKICAgICAgICAgICAg\naWYgKF9jb2xzID09IG51bGwpCiAgICAgICAgICAgICAgICBfY29scyA9IG5l\ndyBBcnJheUxpc3Q8Q29sdW1uPigzKTsKICAgICAgICAgICAgX2NvbHMuYWRk\nKGNvbCk7CiAgICAgICAgfSBlbHNlIGlmIChjdXJyZW50UGFyZW50KCkgPT0g\nU0VDT05EQVJZX1RBQkxFKSB7CiAgICAgICAgICAgIC8vIHBrIGpvaW4gY29s\ndW1ucyBpbiBzZWNvbmRhcnkgdGFibGUgYWN0cyBhcyBqb2luIGNvbHMKICAg\nICAgICAgICAgaWYgKF9qb2luQ29scyA9PSBudWxsKQogICAgICAgICAgICAg\nICAgX2pvaW5Db2xzID0gbmV3IEFycmF5TGlzdDxDb2x1bW4+KDMpOwogICAg\nICAgICAgICBfam9pbkNvbHMuYWRkKGNvbCk7CiAgICAgICAgfSBlbHNlIHsK\nICAgICAgICAgICAgLy8gbXVzdCBiZSBwayBqb2luIGNvbHMgZnJvbSB0aGlz\nIGNsYXNzIHRvIHN1cGVyY2xhc3MKICAgICAgICAgICAgaWYgKF9zdXBKb2lu\nQ29scyA9PSBudWxsKQogICAgICAgICAgICAgICAgX3N1cEpvaW5Db2xzID0g\nbmV3IEFycmF5TGlzdDxDb2x1bW4+KDMpOwogICAgICAgICAgICBfc3VwSm9p\nbkNvbHMuYWRkKGNvbCk7CiAgICAgICAgfQogICAgICAgIHJldHVybiB0cnVl\nOwogICAgfQoKICAgIC8qKgogICAgICogUGFyc2Ugam9pbi1jb2x1bW4uCiAg\nICAgKi8KICAgIHByaXZhdGUgYm9vbGVhbiBzdGFydEpvaW5Db2x1bW4oQXR0\ncmlidXRlcyBhdHRycykKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsK\nICAgICAgICAvLyBvbmx5IGpvaW4gY29scyBpbiBhIGpvaW4gdGFibGUgam9p\nbiBmaWVsZCB0YWJsZSB0byBjbGFzcyB0YWJsZTsKICAgICAgICAvLyBvdGhl\ncnMgYWN0IGFzIGRhdGEgZmsgY29scwogICAgICAgIGlmIChjdXJyZW50UGFy\nZW50KCkgIT0gSk9JTl9UQUJMRSkKICAgICAgICAgICAgcmV0dXJuIHN0YXJ0\nQ29sdW1uKGF0dHJzKTsKCiAgICAgICAgaWYgKF9qb2luQ29scyA9PSBudWxs\nKQogICAgICAgICAgICBfam9pbkNvbHMgPSBuZXcgQXJyYXlMaXN0PENvbHVt\nbj4oMyk7CiAgICAgICAgX2pvaW5Db2xzLmFkZChwYXJzZUNvbHVtbihhdHRy\ncykpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qKgogICAg\nICogUGFyc2UgY29sdW1uLgogICAgICovCiAgICBwcml2YXRlIGJvb2xlYW4g\nc3RhcnRDb2x1bW4oQXR0cmlidXRlcyBhdHRycykKICAgICAgICB0aHJvd3Mg\nU0FYRXhjZXB0aW9uIHsKICAgICAgICBpZiAoX2NvbHMgPT0gbnVsbCkKICAg\nICAgICAgICAgX2NvbHMgPSBuZXcgQXJyYXlMaXN0PENvbHVtbj4oMyk7CiAg\nICAgICAgX2NvbHMuYWRkKHBhcnNlQ29sdW1uKGF0dHJzKSk7CiAgICAgICAg\ncmV0dXJuIHRydWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBDcmVhdGUgYSBj\nb2x1bW4gd2l0aCB0aGUgZ2l2ZW4gYXR0cmlidXRlcy4KICAgICAqLwogICAg\ncHJpdmF0ZSBDb2x1bW4gcGFyc2VDb2x1bW4oQXR0cmlidXRlcyBhdHRycykK\nICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICBDb2x1bW4g\nY29sID0gbmV3IENvbHVtbigpOwogICAgICAgIFN0cmluZyB2YWwgPSBhdHRy\ncy5nZXRWYWx1ZSgibmFtZSIpOwogICAgICAgIGlmICh2YWwgIT0gbnVsbCkK\nICAgICAgICAgICAgY29sLnNldE5hbWUodmFsKTsKICAgICAgICB2YWwgPSBh\ndHRycy5nZXRWYWx1ZSgicmVmZXJlbmNlZC1jb2x1bW4tbmFtZSIpOwogICAg\nICAgIGlmICh2YWwgIT0gbnVsbCkKICAgICAgICAgICAgY29sLnNldFRhcmdl\ndCh2YWwpOwogICAgICAgIHZhbCA9IGF0dHJzLmdldFZhbHVlKCJjb2x1bW4t\nZGVmaW5pdGlvbiIpOwogICAgICAgIGlmICh2YWwgIT0gbnVsbCkKICAgICAg\nICAgICAgY29sLnNldFR5cGVOYW1lKHZhbCk7CiAgICAgICAgdmFsID0gYXR0\ncnMuZ2V0VmFsdWUoInByZWNpc2lvbiIpOwogICAgICAgIGlmICh2YWwgIT0g\nbnVsbCkKICAgICAgICAgICAgY29sLnNldFNpemUoSW50ZWdlci5wYXJzZUlu\ndCh2YWwpKTsKICAgICAgICB2YWwgPSBhdHRycy5nZXRWYWx1ZSgibGVuZ3Ro\nIik7CiAgICAgICAgaWYgKHZhbCAhPSBudWxsKQogICAgICAgICAgICBjb2wu\nc2V0U2l6ZShJbnRlZ2VyLnBhcnNlSW50KHZhbCkpOwogICAgICAgIHZhbCA9\nIGF0dHJzLmdldFZhbHVlKCJzY2FsZSIpOwogICAgICAgIGlmICh2YWwgIT0g\nbnVsbCkKICAgICAgICAgICAgY29sLnNldERlY2ltYWxEaWdpdHMoSW50ZWdl\nci5wYXJzZUludCh2YWwpKTsKICAgICAgICB2YWwgPSBhdHRycy5nZXRWYWx1\nZSgibnVsbGFibGUiKTsKICAgICAgICBpZiAodmFsICE9IG51bGwpCiAgICAg\nICAgICAgIGNvbC5zZXROb3ROdWxsKCJmYWxzZSIuZXF1YWxzKHZhbCkpOwog\nICAgICAgIHZhbCA9IGF0dHJzLmdldFZhbHVlKCJpbnNlcnRhYmxlIik7CiAg\nICAgICAgaWYgKHZhbCAhPSBudWxsKQogICAgICAgICAgICBjb2wuc2V0Rmxh\nZyhDb2x1bW4uRkxBR19VTklOU0VSVEFCTEUsICJmYWxzZSIuZXF1YWxzKHZh\nbCkpOwogICAgICAgIHZhbCA9IGF0dHJzLmdldFZhbHVlKCJ1cGRhdGFibGUi\nKTsKICAgICAgICBpZiAodmFsICE9IG51bGwpCiAgICAgICAgICAgIGNvbC5z\nZXRGbGFnKENvbHVtbi5GTEFHX1VOVVBEQVRBQkxFLCAiZmFsc2UiLmVxdWFs\ncyh2YWwpKTsKCiAgICAgICAgdmFsID0gYXR0cnMuZ2V0VmFsdWUoInVuaXF1\nZSIpOwogICAgICAgIGlmICh2YWwgIT0gbnVsbCkKICAgICAgICAgICAgX3Vu\naXF1ZS5hZGQoRW51bS52YWx1ZU9mKFVuaXF1ZUZsYWcuY2xhc3MsIHZhbC50\nb1VwcGVyQ2FzZSgpKSk7CiAgICAgICAgdmFsID0gYXR0cnMuZ2V0VmFsdWUo\nInRhYmxlIik7CiAgICAgICAgaWYgKHZhbCAhPSBudWxsKSB7CiAgICAgICAg\nICAgIGlmIChfY29sVGFibGUgIT0gbnVsbCAmJiAhX2NvbFRhYmxlLmVxdWFs\ncyh2YWwpKQogICAgICAgICAgICAgICAgdGhyb3cgZ2V0RXhjZXB0aW9uKF9s\nb2MuZ2V0KCJzZWNvbmQtaW5jb25zaXN0IiwKICAgICAgICAgICAgICAgICAg\nICBjdXJyZW50RWxlbWVudCgpKSk7CiAgICAgICAgICAgIF9jb2xUYWJsZSA9\nIHZhbDsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGNvbDsKICAgIH0KCiAg\nICAvKioKICAgICAqIFJldHVybiBhIHRhYmxlIG5hbWUgZm9yIHRoZSBnaXZl\nbiBhdHRyaWJ1dGVzLgogICAgICovCiAgICBwcml2YXRlIFN0cmluZyB0b1Rh\nYmxlTmFtZShTdHJpbmcgc2NoZW1hLCBTdHJpbmcgdGFibGUpIHsKICAgICAg\nICBpZiAoU3RyaW5nVXRpbHMuaXNFbXB0eSh0YWJsZSkpCiAgICAgICAgICAg\nIHJldHVybiBudWxsOwogICAgICAgIGlmIChTdHJpbmdVdGlscy5pc0VtcHR5\nKHNjaGVtYSkpCiAgICAgICAgICAgIHNjaGVtYSA9IF9zY2hlbWE7CiAgICAg\nICAgcmV0dXJuIChTdHJpbmdVdGlscy5pc0VtcHR5KHNjaGVtYSkpID8gdGFi\nbGUgOiBzY2hlbWEgKyAiLiIgKyB0YWJsZTsKICAgIH0KCiAgICAvKioKICAg\nICAqIFN0YXJ0IHByb2Nlc3NpbmcgPGNvZGU+c3FsLXJlc3VsdC1zZXQtbWFw\ncGluZzwvY29kZT4gbm9kZS4KICAgICAqIFB1c2hlcyB0aGUge0BsaW5rIFF1\nZXJ5UmVzdWx0TWFwcGluZ30gb250byB0aGUgc3RhY2sgYXMgY3VycmVudCBl\nbGVtZW50LgogICAgICovCiAgICBwcml2YXRlIGJvb2xlYW4gc3RhcnRTUUxS\nZXN1bHRTZXRNYXBwaW5nKEF0dHJpYnV0ZXMgYXR0cnMpIHsKICAgICAgICBT\ndHJpbmcgbmFtZSA9IGF0dHJzLmdldFZhbHVlKCJuYW1lIik7CiAgICAgICAg\nTG9nIGxvZyA9IGdldExvZygpOwogICAgICAgIGlmIChsb2cuaXNUcmFjZUVu\nYWJsZWQoKSkKICAgICAgICAgICAgbG9nLnRyYWNlKF9sb2MuZ2V0KCJwYXJz\nZS1zcWxyc21hcHBpbmciLCBuYW1lKSk7CgogICAgICAgIE1hcHBpbmdSZXBv\nc2l0b3J5IHJlcG9zID0gKE1hcHBpbmdSZXBvc2l0b3J5KSBnZXRSZXBvc2l0\nb3J5KCk7CiAgICAgICAgUXVlcnlSZXN1bHRNYXBwaW5nIHJlc3VsdCA9IHJl\ncG9zLmdldENhY2hlZFF1ZXJ5UmVzdWx0TWFwcGluZwogICAgICAgICAgICAo\nbnVsbCwgbmFtZSk7CiAgICAgICAgaWYgKHJlc3VsdCAhPSBudWxsICYmIGxv\nZy5pc1dhcm5FbmFibGVkKCkpCiAgICAgICAgICAgIGxvZy53YXJuKF9sb2Mu\nZ2V0KCJvdmVycmlkZS1zcWxyc21hcHBpbmciLCBuYW1lLAogICAgICAgICAg\nICAgICAgY3VycmVudExvY2F0aW9uKCkpKTsKCiAgICAgICAgcmVzdWx0ID0g\ncmVwb3MuYWRkUXVlcnlSZXN1bHRNYXBwaW5nKG51bGwsIG5hbWUpOwogICAg\nICAgIHJlc3VsdC5zZXRMaXN0aW5nSW5kZXgoX3Jlc3VsdElkeCsrKTsKICAg\nICAgICBhZGRDb21tZW50cyhyZXN1bHQpOwoKICAgICAgICBPYmplY3QgY3Vy\nID0gY3VycmVudEVsZW1lbnQoKTsKICAgICAgICBPYmplY3Qgc2NvcGUgPSAo\nY3VyIGluc3RhbmNlb2YgQ2xhc3NNZXRhRGF0YSkKICAgICAgICAgICAgPyAo\nKENsYXNzTWV0YURhdGEpIGN1cikuZ2V0RGVzY3JpYmVkVHlwZSgpIDogbnVs\nbDsKICAgICAgICByZXN1bHQuc2V0U291cmNlKGdldFNvdXJjZUZpbGUoKSwg\nc2NvcGUsIHJlc3VsdC5TUkNfWE1MKTsKCiAgICAgICAgcHVzaEVsZW1lbnQo\ncmVzdWx0KTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBwcml2\nYXRlIHZvaWQgZW5kU1FMUmVzdWx0U2V0TWFwcGluZygpCiAgICAgICAgdGhy\nb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgcG9wRWxlbWVudCgpOwogICAg\nfQoKICAgIC8qKgogICAgICogU3RhcnQgcHJvY2Vzc2luZyA8Y29kZT5lbnRp\ndHktcmVzdWx0PC9jb2RlPiBub2RlLgogICAgICogUHVzaGVzIHRoZSB7QGxp\nbmsgUXVlcnlSZXN1bHRNYXBwaW5nLlBDUmVzdWx0fQogICAgICogb250byB0\naGUgc3RhY2sgYXMgY3VycmVudCBlbGVtZW50LgogICAgICovCiAgICBwcml2\nYXRlIGJvb2xlYW4gc3RhcnRFbnRpdHlSZXN1bHQoQXR0cmlidXRlcyBhdHRy\ncykKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICBDbGFz\ncyBlbnRpdHlDbGFzcyA9IGNsYXNzRm9yTmFtZShhdHRycy5nZXRWYWx1ZSgi\nZW50aXR5LWNsYXNzIikpOwogICAgICAgIFN0cmluZyBkaXNjcmltaW5hdG9y\nID0gYXR0cnMuZ2V0VmFsdWUoImRpc2NyaW1pbmF0b3ItY29sdW1uIik7Cgog\nICAgICAgIFF1ZXJ5UmVzdWx0TWFwcGluZyBwYXJlbnQgPSAoUXVlcnlSZXN1\nbHRNYXBwaW5nKSBjdXJyZW50RWxlbWVudCgpOwogICAgICAgIFF1ZXJ5UmVz\ndWx0TWFwcGluZy5QQ1Jlc3VsdCByZXN1bHQgPSBwYXJlbnQuYWRkUENSZXN1\nbHQoZW50aXR5Q2xhc3MpOwogICAgICAgIGlmICghU3RyaW5nVXRpbHMuaXNF\nbXB0eShkaXNjcmltaW5hdG9yKSkKICAgICAgICAgICAgcmVzdWx0LmFkZE1h\ncHBpbmcocmVzdWx0LkRJU0NSSU1JTkFUT1IsIGRpc2NyaW1pbmF0b3IpOwog\nICAgICAgIHB1c2hFbGVtZW50KHJlc3VsdCk7CiAgICAgICAgcmV0dXJuIHRy\ndWU7CiAgICB9CgogICAgcHJpdmF0ZSB2b2lkIGVuZEVudGl0eVJlc3VsdCgp\nCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgcG9wRWxl\nbWVudCgpOwogICAgfQoKICAgIC8qKgogICAgICogUHJvY2VzcyBhIDxjb2Rl\nPmZpZWxkLXJlc3VsdDwvY29kZT4gbm9kZS4KICAgICAqLwogICAgcHJpdmF0\nZSBib29sZWFuIHN0YXJ0RmllbGRSZXN1bHQoQXR0cmlidXRlcyBhdHRycykK\nICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICBTdHJpbmcg\nZmllbGROYW1lID0gYXR0cnMuZ2V0VmFsdWUoIm5hbWUiKTsKICAgICAgICBT\ndHJpbmcgY29sdW1uTmFtZSA9IGF0dHJzLmdldFZhbHVlKCJjb2x1bW4iKTsK\nCiAgICAgICAgUXVlcnlSZXN1bHRNYXBwaW5nLlBDUmVzdWx0IHBhcmVudCA9\nIChRdWVyeVJlc3VsdE1hcHBpbmcuUENSZXN1bHQpCiAgICAgICAgICAgIGN1\ncnJlbnRFbGVtZW50KCk7CiAgICAgICAgcGFyZW50LmFkZE1hcHBpbmcoZmll\nbGROYW1lLCBjb2x1bW5OYW1lKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAg\nIH0KCiAgICAvKioKICAgICAqIFByb2Nlc3MgYSA8Y29kZT5jb2x1bW4tcmVz\ndWx0PC9jb2RlPiBub2RlLgogICAgICovCiAgICBwcml2YXRlIGJvb2xlYW4g\nc3RhcnRDb2x1bW5SZXN1bHQoQXR0cmlidXRlcyBhdHRycykKICAgICAgICB0\naHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICBRdWVyeVJlc3VsdE1hcHBp\nbmcgcGFyZW50ID0gKFF1ZXJ5UmVzdWx0TWFwcGluZykgY3VycmVudEVsZW1l\nbnQoKTsKICAgICAgICBwYXJlbnQuYWRkQ29sdW1uUmVzdWx0KGF0dHJzLmdl\ndFZhbHVlKCJuYW1lIikpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoK\nICAgIC8qKiAKICAgICAqIFN0YXJ0cyBwcm9jZXNzaW5nICZsdDt1bmlxdWUt\nY29uc3RyYWludCZndDsgcHJvdmlkZWQgdGhlIHRhZyBvY2N1cnMKICAgICAq\nIHdpdGhpbiBhIENsYXNzTWFwcGluZyBlbGVtZW50IGFuZCA8ZW0+bm90PC9l\nbT4gd2l0aGluIGEgc2Vjb25kYXJ5CiAgICAgKiB0YWJsZS4gCiAgICAgKiBQ\ndXNoZXMgdGhlIFVuaXF1ZSBlbGVtZW50IGluIHRoZSBzdGFjay4KICAgICAq\nLwogICAgcHJpdmF0ZSBib29sZWFuIHN0YXJ0VW5pcXVlQ29uc3RyYWludChB\ndHRyaWJ1dGVzIGF0dHJzKSAKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9u\nIHsKICAgICAgICBPYmplY3QgY3VycmVudCA9IGN1cnJlbnRFbGVtZW50KCk7\nCiAgICAgICAgaWYgKGN1cnJlbnQgaW5zdGFuY2VvZiBDbGFzc01hcHBpbmcg\nJiYgX3NlY29uZGFyeVRhYmxlID09IG51bGwpIHsKICAgICAgICAgICAgVW5p\ncXVlIHVuaXF1ZSA9IG5ldyBVbmlxdWUoKTsKICAgICAgICAgICAgcHVzaEVs\nZW1lbnQodW5pcXVlKTsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAg\nICAgfSAKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgICAKICAgIC8q\nKgogICAgICogRW5kcyBwcm9jZXNzaW5nICZsdDt1bmlxdWUtY29uc3RyYWlu\ndCZndDsgcHJvdmlkZWQgdGhlIHRhZyBvY2N1cnMKICAgICAqIHdpdGhpbiBh\nIENsYXNzTWFwcGluZyBlbGVtZW50IGFuZCA8ZW0+bm90PC9lbT4gd2l0aGlu\nIGEgc2Vjb25kYXJ5CiAgICAgKiB0YWJsZS4gVGhlIHN0YWNrIGlzIHBvcHBl\nZCBhbmQgdGhlIFVuaXF1ZSBlbGVtZW50IGlzIGFkZGVkIHRvIHRoZQogICAg\nICogQ2xhc3NNYXBwaW5nSW5mby4gCiAgICAgKi8KICAgIHByaXZhdGUgdm9p\nZCBlbmRVbmlxdWVDb25zdHJhaW50KCkgewogICAgICAgIFVuaXF1ZSB1bmlx\ndWUgPSAoVW5pcXVlKXBvcEVsZW1lbnQoKTsKICAgICAgICBPYmplY3QgY3Vy\ncmVudCA9IGN1cnJlbnRFbGVtZW50KCk7CiAgICAgICAgaWYgKGN1cnJlbnQg\naW5zdGFuY2VvZiBDbGFzc01hcHBpbmcgJiYgX3NlY29uZGFyeVRhYmxlID09\nIG51bGwpCiAgICAgICAgICAgICgoQ2xhc3NNYXBwaW5nKWN1cnJlbnQpLmdl\ndE1hcHBpbmdJbmZvKCkuYWRkVW5pcXVlKHVuaXF1ZSk7CiAgICB9CiAgICAK\nICAgIC8qKgogICAgICogRW5kcyBwcm9jZXNzaW5nICZsdDtjb2x1bW4tbmFt\nZSZndDsgdGFnIGJ5IGFkZGluZyB0aGUgY29sdW1uIG5hbWUgaW4KICAgICAq\nIHRoZSBjdXJyZW50IFVuaXF1ZSBlbGVtZW50IHRoYXQgcmVzaWRlcyBpbiB0\naGUgdG9wIG9mIHRoZSBzdGFjay4KICAgICAqLwogICAgcHJpdmF0ZSBib29s\nZWFuIGVuZENvbHVtbk5hbWUoKSB7CiAgICAgICAgT2JqZWN0IGN1cnJlbnQg\nPSBjdXJyZW50RWxlbWVudCgpOwogICAgICAgIGlmIChjdXJyZW50IGluc3Rh\nbmNlb2YgVW5pcXVlKSB7CiAgICAgICAgICAgIFVuaXF1ZSB1bmlxdWUgPSAo\nVW5pcXVlKWN1cnJlbnQ7CiAgICAgICAgICAgIENvbHVtbiBjb2x1bW4gPSBu\nZXcgQ29sdW1uKCk7CiAgICAgICAgICAgIGNvbHVtbi5zZXROYW1lKHRoaXMu\nY3VycmVudFRleHQoKSk7CiAgICAgICAgICAgIHVuaXF1ZS5hZGRDb2x1bW4o\nY29sdW1uKTsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQog\nICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KICAgIAogICAgLyoqCiAgICAg\nKiBUcmFjayB1bmlxdWUgY29sdW1uIHNldHRpbmdzLgoJICovCglwcml2YXRl\nIHN0YXRpYyBlbnVtIFVuaXF1ZUZsYWcKCXsKCQlUUlVFLAoJCUZBTFNFCgl9\nCn0K\n","encoding":"base64"}

