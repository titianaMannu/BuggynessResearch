{"sha":"eb0b8787bc5076828273e7fefb9b10830e886111","node_id":"MDQ6QmxvYjIwNjM2NDplYjBiODc4N2JjNTA3NjgyODI3M2U3ZmVmYjliMTA4MzBlODg2MTEx","size":5873,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/eb0b8787bc5076828273e7fefb9b10830e886111","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UudGVzdDsK\nCmltcG9ydCBqYXZhLmxhbmcucmVmbGVjdC5Nb2RpZmllcjsKaW1wb3J0IGph\ndmEudXRpbC5BcnJheUxpc3Q7CmltcG9ydCBqYXZhLnV0aWwuSXRlcmF0b3I7\nCmltcG9ydCBqYXZhLnV0aWwuTGlzdDsKaW1wb3J0IGphdmEudXRpbC5NYXA7\nCmltcG9ydCBqYXZhLnV0aWwuSGFzaE1hcDsKaW1wb3J0IGphdmF4LnBlcnNp\nc3RlbmNlLkVudGl0eU1hbmFnZXI7CmltcG9ydCBqYXZheC5wZXJzaXN0ZW5j\nZS5FbnRpdHlNYW5hZ2VyRmFjdG9yeTsKaW1wb3J0IGphdmF4LnBlcnNpc3Rl\nbmNlLlBlcnNpc3RlbmNlOwoKaW1wb3J0IGp1bml0LmZyYW1ld29yay5UZXN0\nQ2FzZTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuQWJzdHJh\nY3RCcm9rZXJGYWN0b3J5OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmtl\ncm5lbC5Ccm9rZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YS5D\nbGFzc01ldGFEYXRhOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNp\nc3RlbmNlLk9wZW5KUEFFbnRpdHlNYW5hZ2VyRmFjdG9yeTsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5PcGVuSlBBUGVyc2lzdGVu\nY2U7CgovKioKICogQmFzZSB0ZXN0IGNsYXNzIHByb3ZpZGluZyBwZXJzaXN0\nZW5jZSB1dGlsaXRpZXMuCiAqLwpwdWJsaWMgYWJzdHJhY3QgY2xhc3MgUGVy\nc2lzdGVuY2VUZXN0Q2FzZQogICAgZXh0ZW5kcyBUZXN0Q2FzZSB7CgogICAg\nLyoqCiAgICAgKiBNYXJrZXIgb2JqZWN0IHlvdSBhbiBwYXNzIHRvIHtAbGlu\nayAjc2V0VXB9IHRvIGluZGljYXRlIHRoYXQgdGhlCiAgICAgKiBkYXRhYmFz\nZSB0YWJsZXMgc2hvdWxkIGJlIGNsZWFyZWQuCiAgICAgKi8KICAgIHByb3Rl\nY3RlZCBzdGF0aWMgZmluYWwgT2JqZWN0IENMRUFSX1RBQkxFUyA9IG5ldyBP\nYmplY3QoKTsKCiAgICAvKioKICAgICAqIENyZWF0ZSBhbiBlbnRpdHkgbWFu\nYWdlciBmYWN0b3J5LgogICAgICoKICAgICAqIEBwYXJhbSBwcm9wcyBsaXN0\nIG9mIHBlcnNpc3RlbnQgdHlwZXMgdXNlZCBpbiB0ZXN0aW5nIGFuZC9vciAK\nICAgICAqIGNvbmZpZ3VyYXRpb24gdmFsdWVzIGluIHRoZSBmb3JtIGtleSx2\nYWx1ZSxrZXksdmFsdWUuLi4KICAgICAqLwogICAgcHJvdGVjdGVkIE9wZW5K\nUEFFbnRpdHlNYW5hZ2VyRmFjdG9yeSBjcmVhdGVFTUYoT2JqZWN0Li4uIHBy\nb3BzKSB7CiAgICAgICAgTWFwIG1hcCA9IG5ldyBIYXNoTWFwKFN5c3RlbS5n\nZXRQcm9wZXJ0aWVzKCkpOwogICAgICAgIExpc3Q8Q2xhc3M+IHR5cGVzID0g\nbmV3IEFycmF5TGlzdDxDbGFzcz4oKTsKICAgICAgICBib29sZWFuIHByb3Ag\nPSBmYWxzZTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IHByb3BzLmxl\nbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGlmIChwcm9wKSB7CiAgICAgICAg\nICAgICAgICBtYXAucHV0KHByb3BzW2kgLSAxXSwgcHJvcHNbaV0pOwogICAg\nICAgICAgICAgICAgcHJvcCA9IGZhbHNlOwogICAgICAgICAgICB9IGVsc2Ug\naWYgKHByb3BzW2ldID09IENMRUFSX1RBQkxFUykgewogICAgICAgICAgICAg\nICAgbWFwLnB1dCgib3BlbmpwYS5qZGJjLlN5bmNocm9uaXplTWFwcGluZ3Mi\nLAogICAgICAgICAgICAgICAgICAgICJidWlsZFNjaGVtYShGb3JlaWduS2V5\ncz10cnVlLCIgCiAgICAgICAgICAgICAgICAgICAgKyAiU2NoZW1hQWN0aW9u\nPSdhZGQsZGVsZXRlVGFibGVDb250ZW50cycpIik7CiAgICAgICAgICAgIH0g\nZWxzZSBpZiAocHJvcHNbaV0gaW5zdGFuY2VvZiBDbGFzcykKICAgICAgICAg\nICAgICAgIHR5cGVzLmFkZCgoQ2xhc3MpIHByb3BzW2ldKTsKICAgICAgICAg\nICAgZWxzZQogICAgICAgICAgICAgICAgcHJvcCA9IHRydWU7CiAgICAgICAg\nfQoKICAgICAgICBpZiAoIXR5cGVzLmlzRW1wdHkoKSkgewogICAgICAgICAg\nICBTdHJpbmdCdWZmZXIgYnVmID0gbmV3IFN0cmluZ0J1ZmZlcigpOwogICAg\nICAgICAgICBmb3IgKENsYXNzIGMgOiB0eXBlcykgewogICAgICAgICAgICAg\nICAgaWYgKGJ1Zi5sZW5ndGgoKSA+IDApCiAgICAgICAgICAgICAgICAgICAg\nYnVmLmFwcGVuZCgiOyIpOwogICAgICAgICAgICAgICAgYnVmLmFwcGVuZChj\nLmdldE5hbWUoKSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgbWFwLnB1\ndCgib3BlbmpwYS5NZXRhRGF0YUZhY3RvcnkiLAogICAgICAgICAgICAgICAg\nImpwYShUeXBlcz0iICsgYnVmLnRvU3RyaW5nKCkgKyAiKSIpOwogICAgICAg\nIH0KCiAgICAgICAgcmV0dXJuIChPcGVuSlBBRW50aXR5TWFuYWdlckZhY3Rv\ncnkpIFBlcnNpc3RlbmNlLgogICAgICAgICAgICBjcmVhdGVFbnRpdHlNYW5h\nZ2VyRmFjdG9yeSgidGVzdCIsIG1hcCk7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBTYWZlbHkgY2xvc2UgdGhlIGdpdmVuIGZhY3RvcnkuCiAgICAgKi8KICAg\nIHByb3RlY3RlZCBib29sZWFuIGNsb3NlRU1GKEVudGl0eU1hbmFnZXJGYWN0\nb3J5IGVtZikgewogICAgICAgIGlmIChlbWYgPT0gbnVsbCkKICAgICAgICAg\nICAgcmV0dXJuIGZhbHNlOwogICAgICAgIGlmICghZW1mLmlzT3BlbigpKQog\nICAgICAgICAgICByZXR1cm4gZmFsc2U7CgogICAgICAgIGZvciAoSXRlcmF0\nb3IgaXRlciA9ICgoQWJzdHJhY3RCcm9rZXJGYWN0b3J5KSBPcGVuSlBBUGVy\nc2lzdGVuY2UKICAgICAgICAgICAgLnRvQnJva2VyRmFjdG9yeShlbWYpKS5n\nZXRPcGVuQnJva2VycygpLml0ZXJhdG9yKCk7CiAgICAgICAgICAgIGl0ZXIu\naGFzTmV4dCgpOyApIHsKICAgICAgICAgICAgQnJva2VyIGIgPSAoQnJva2Vy\nKSBpdGVyLm5leHQoKTsKICAgICAgICAgICAgaWYgKGIgIT0gbnVsbCAmJiAh\nYi5pc0Nsb3NlZCgpKSB7CiAgICAgICAgICAgICAgICBFbnRpdHlNYW5hZ2Vy\nIGVtID0gT3BlbkpQQVBlcnNpc3RlbmNlLnRvRW50aXR5TWFuYWdlcihiKTsK\nICAgICAgICAgICAgICAgIGlmIChlbS5nZXRUcmFuc2FjdGlvbigpLmlzQWN0\naXZlKCkpCiAgICAgICAgICAgICAgICAgICAgZW0uZ2V0VHJhbnNhY3Rpb24o\nKS5yb2xsYmFjaygpOwogICAgICAgICAgICAgICAgZW0uY2xvc2UoKTsKICAg\nICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgZW1mLmNsb3NlKCk7CiAg\nICAgICAgcmV0dXJuICFlbWYuaXNPcGVuKCk7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBEZWxldGUgYWxsIGluc3RhbmNlcyBvZiB0aGUgZ2l2ZW4gdHlwZXMg\ndXNpbmcgYnVsayBkZWxldGUgcXVlcmllcy4KICAgICAqLwogICAgcHJvdGVj\ndGVkIHZvaWQgY2xlYXIoRW50aXR5TWFuYWdlckZhY3RvcnkgZW1mLCBDbGFz\ncy4uLiB0eXBlcykgewogICAgICAgIGlmIChlbWYgPT0gbnVsbCB8fCB0eXBl\ncy5sZW5ndGggPT0gMCkKICAgICAgICAgICAgcmV0dXJuOwoKICAgICAgICBM\naXN0PENsYXNzTWV0YURhdGE+IG1ldGFzID0gbmV3IEFycmF5TGlzdDxDbGFz\nc01ldGFEYXRhPih0eXBlcy5sZW5ndGgpOwogICAgICAgIGZvciAoQ2xhc3Mg\nYyA6IHR5cGVzKSB7CiAgICAgICAgICAgIENsYXNzTWV0YURhdGEgbWV0YSA9\nIE9wZW5KUEFQZXJzaXN0ZW5jZS5nZXRNZXRhRGF0YShlbWYsIGMpOwogICAg\nICAgICAgICBpZiAobWV0YSAhPSBudWxsKQogICAgICAgICAgICAgICAgbWV0\nYXMuYWRkKG1ldGEpOwogICAgICAgIH0KICAgICAgICBjbGVhcihlbWYsIG1l\ndGFzLnRvQXJyYXkobmV3IENsYXNzTWV0YURhdGFbbWV0YXMuc2l6ZSgpXSkp\nOwogICAgfQoKICAgIC8qKgogICAgICogRGVsZXRlIGFsbCBpbnN0YW5jZXMg\nb2YgdGhlIHBlcnNpc3RlbnQgdHlwZXMgcmVnaXN0ZXJlZCB3aXRoIHRoZSBn\naXZlbgogICAgICogZmFjdG9yeSB1c2luZyBidWxrIGRlbGV0ZSBxdWVyaWVz\nLgogICAgICovCiAgICBwcm90ZWN0ZWQgdm9pZCBjbGVhcihFbnRpdHlNYW5h\nZ2VyRmFjdG9yeSBlbWYpIHsKICAgICAgICBpZiAoZW1mID09IG51bGwpCiAg\nICAgICAgICAgIHJldHVybjsKICAgICAgICBjbGVhcihlbWYsICgoT3BlbkpQ\nQUVudGl0eU1hbmFnZXJGYWN0b3J5KSBlbWYpLmdldENvbmZpZ3VyYXRpb24o\nKS4KICAgICAgICAgICAgZ2V0TWV0YURhdGFSZXBvc2l0b3J5SW5zdGFuY2Uo\nKS5nZXRNZXRhRGF0YXMoKSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBEZWxl\ndGUgYWxsIGluc3RhbmNlcyBvZiB0aGUgZ2l2ZW4gdHlwZXMgdXNpbmcgYnVs\nayBkZWxldGUgcXVlcmllcy4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIGNs\nZWFyKEVudGl0eU1hbmFnZXJGYWN0b3J5IGVtZiwgQ2xhc3NNZXRhRGF0YS4u\nLiB0eXBlcykgewogICAgICAgIGlmIChlbWYgPT0gbnVsbCB8fCB0eXBlcy5s\nZW5ndGggPT0gMCkKICAgICAgICAgICAgcmV0dXJuOwoKICAgICAgICBFbnRp\ndHlNYW5hZ2VyIGVtID0gZW1mLmNyZWF0ZUVudGl0eU1hbmFnZXIoKTsKICAg\nICAgICBlbS5nZXRUcmFuc2FjdGlvbigpLmJlZ2luKCk7CiAgICAgICAgZm9y\nIChDbGFzc01ldGFEYXRhIG1ldGEgOiB0eXBlcykgewogICAgICAgICAgICBp\nZiAoIW1ldGEuaXNNYXBwZWQoKSB8fCBtZXRhLmlzRW1iZWRkZWRPbmx5KCkg\nCiAgICAgICAgICAgICAgICB8fCBNb2RpZmllci5pc0Fic3RyYWN0KG1ldGEu\nZ2V0RGVzY3JpYmVkVHlwZSgpLmdldE1vZGlmaWVycygpKSkKICAgICAgICAg\nICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICBlbS5jcmVhdGVRdWVyeSgi\nREVMRVRFIEZST00gIiArIG1ldGEuZ2V0VHlwZUFsaWFzKCkgKyAiIG8iKS4K\nICAgICAgICAgICAgICAgIGV4ZWN1dGVVcGRhdGUoKTsKICAgICAgICB9CiAg\nICAgICAgZW0uZ2V0VHJhbnNhY3Rpb24oKS5jb21taXQoKTsKICAgICAgICBl\nbS5jbG9zZSgpOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRoZSBl\nbnRpdHkgbmFtZSBmb3IgdGhlIGdpdmVuIHR5cGUuICAgCiAgICAgKi8KICAg\nIHByb3RlY3RlZCBTdHJpbmcgZW50aXR5TmFtZShFbnRpdHlNYW5hZ2VyRmFj\ndG9yeSBlbWYsIENsYXNzIGMpIHsKICAgICAgICBDbGFzc01ldGFEYXRhIG1l\ndGEgPSBPcGVuSlBBUGVyc2lzdGVuY2UuZ2V0TWV0YURhdGEoZW1mLCBjKTsK\nICAgICAgICByZXR1cm4gKG1ldGEgPT0gbnVsbCkgPyBudWxsIDogbWV0YS5n\nZXRUeXBlQWxpYXMoKTsKICAgIH0KfQo=\n","encoding":"base64"}

