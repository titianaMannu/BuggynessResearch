{"sha":"1b561423069950dfbe21ab58e5b6ce66a1cd75a8","node_id":"MDQ6QmxvYjIwNjM2NDoxYjU2MTQyMzA2OTk1MGRmYmUyMWFiNThlNWI2Y2U2NmExY2Q3NWE4","size":13829,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/1b561423069950dfbe21ab58e5b6ce66a1cd75a8","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5rZXJuZWw7CgppbXBv\ncnQgamF2YS5zcWwuQ29ubmVjdGlvbjsKaW1wb3J0IGphdmEuc3FsLlNRTEV4\nY2VwdGlvbjsKaW1wb3J0IGphdmEudXRpbC5CaXRTZXQ7CmltcG9ydCBqYXZh\nLnV0aWwuQ29sbGVjdGlvbjsKaW1wb3J0IGphdmEudXRpbC5JdGVyYXRvcjsK\naW1wb3J0IGphdmEudXRpbC5MaW5rZWRMaXN0OwoKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5qZGJjLmNvbmYuSkRCQ0NvbmZpZ3VyYXRpb247CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhLkNsYXNzTWFwcGluZzsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLm1ldGEuRGlzY3JpbWlu\nYXRvcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLm1ldGEuRmll\nbGRNYXBwaW5nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0\nYS5TdHJhdGVneTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLm1l\ndGEuVmVyc2lvbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNx\nbC5EQkRpY3Rpb25hcnk7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRi\nYy5zcWwuUm93TWFuYWdlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5q\nZGJjLnNxbC5TUUxFeGNlcHRpb25zOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLmtlcm5lbC5PcGVuSlBBU3RhdGVNYW5hZ2VyOwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLmtlcm5lbC5QQ1N0YXRlOwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLmxpYi5jb25mLkNvbmZpZ3VyYWJsZTsKaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS5saWIuY29uZi5Db25maWd1cmF0aW9uOwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuSW1wbEhlbHBlcjsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS51dGlsLk9wZW5KUEFFeGNlcHRpb247CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5PcHRpbWlzdGljRXhjZXB0aW9u\nOwoKLyoqCiAqIEJhc2UgdXBkYXRlIG1hbmFnZXIgd2l0aCBjb21tb24gZnVu\nY3Rpb25hbGl0eS4KICoKICogQGF1dGhvciBBYmUgV2hpdGUKICovCnB1Ymxp\nYyBhYnN0cmFjdCBjbGFzcyBBYnN0cmFjdFVwZGF0ZU1hbmFnZXIKICAgIGlt\ncGxlbWVudHMgVXBkYXRlTWFuYWdlciwgQ29uZmlndXJhYmxlIHsKCiAgICBw\ncm90ZWN0ZWQgSkRCQ0NvbmZpZ3VyYXRpb24gY29uZiA9IG51bGw7CiAgICBw\ncm90ZWN0ZWQgREJEaWN0aW9uYXJ5IGRpY3QgPSBudWxsOwoKICAgIHB1Ymxp\nYyB2b2lkIHNldENvbmZpZ3VyYXRpb24oQ29uZmlndXJhdGlvbiBjb25mKSB7\nCiAgICAgICAgdGhpcy5jb25mID0gKEpEQkNDb25maWd1cmF0aW9uKSBjb25m\nOwogICAgICAgIGRpY3QgPSB0aGlzLmNvbmYuZ2V0REJEaWN0aW9uYXJ5SW5z\ndGFuY2UoKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzdGFydENvbmZpZ3Vy\nYXRpb24oKSB7CiAgICB9CgogICAgcHVibGljIHZvaWQgZW5kQ29uZmlndXJh\ndGlvbigpIHsKICAgIH0KCiAgICBwdWJsaWMgQ29sbGVjdGlvbiBmbHVzaChD\nb2xsZWN0aW9uIHN0YXRlcywgSkRCQ1N0b3JlIHN0b3JlKSB7CiAgICAgICAg\nQ29ubmVjdGlvbiBjb25uID0gc3RvcmUuZ2V0Q29ubmVjdGlvbigpOwogICAg\nICAgIHRyeSB7CiAgICAgICAgICAgIFByZXBhcmVkU3RhdGVtZW50TWFuYWdl\nciBwc01nciA9IG5ld1ByZXBhcmVkU3RhdGVtZW50TWFuYWdlcihzdG9yZSwK\nICAgICAgICAgICAgICAgIGNvbm4pOwogICAgICAgICAgICByZXR1cm4gZmx1\nc2goc3RhdGVzLCBzdG9yZSwgcHNNZ3IpOwogICAgICAgIH0gZmluYWxseSB7\nCiAgICAgICAgICAgIHRyeSB7IGNvbm4uY2xvc2UoKTsgfSBjYXRjaCAoU1FM\nRXhjZXB0aW9uIHNlKSB7fQogICAgICAgIH0KICAgIH0KCiAgICBwcml2YXRl\nIENvbGxlY3Rpb24gZmx1c2goQ29sbGVjdGlvbiBzdGF0ZXMsIEpEQkNTdG9y\nZSBzdG9yZSwKICAgICAgICBQcmVwYXJlZFN0YXRlbWVudE1hbmFnZXIgcHNN\nZ3IpIHsKICAgICAgICAvLyBydW4gdGhyb3VnaCBhbGwgdGhlIHN0YXRlcyBh\nbmQgdXBkYXRlIHRoZW0gYXMgbmVjZXNzYXJ5CiAgICAgICAgUm93TWFuYWdl\nciByb3dNZ3IgPSBuZXdSb3dNYW5hZ2VyKCk7CiAgICAgICAgQ29sbGVjdGlv\nbiBjdXN0b21zID0gbmV3IExpbmtlZExpc3QoKTsKICAgICAgICBDb2xsZWN0\naW9uIGV4Y2VwcyA9IG51bGw7CiAgICAgICAgZm9yIChJdGVyYXRvciBpdHIg\nPSBzdGF0ZXMuaXRlcmF0b3IoKTsgaXRyLmhhc05leHQoKTspCiAgICAgICAg\nICAgIGV4Y2VwcyA9IHBvcHVsYXRlUm93TWFuYWdlcigoT3BlbkpQQVN0YXRl\nTWFuYWdlcikgaXRyLm5leHQoKSwKICAgICAgICAgICAgICAgIHJvd01nciwg\nc3RvcmUsIGV4Y2VwcywgY3VzdG9tcyk7CgogICAgICAgIC8vIGZsdXNoIHJv\nd3MKICAgICAgICBleGNlcHMgPSBmbHVzaChyb3dNZ3IsIHBzTWdyLCBleGNl\ncHMpOwoKICAgICAgICAvLyBub3cgZG8gYW55IGN1c3RvbSBtYXBwaW5ncwog\nICAgICAgIGZvciAoSXRlcmF0b3IgaXRyID0gY3VzdG9tcy5pdGVyYXRvcigp\nOyBpdHIuaGFzTmV4dCgpOykgewogICAgICAgICAgICB0cnkgewogICAgICAg\nICAgICAgICAgKChDdXN0b21NYXBwaW5nKSBpdHIubmV4dCgpKS5leGVjdXRl\nKHN0b3JlKTsKICAgICAgICAgICAgfSBjYXRjaCAoU1FMRXhjZXB0aW9uIHNl\nKSB7CiAgICAgICAgICAgICAgICBleGNlcHMgPSBhZGRFeGNlcHRpb24oZXhj\nZXBzLCBTUUxFeGNlcHRpb25zLmdldFN0b3JlKHNlLCBkaWN0KSk7CiAgICAg\nICAgICAgIH0gY2F0Y2ggKE9wZW5KUEFFeGNlcHRpb24ga2UpIHsKICAgICAg\nICAgICAgICAgIGV4Y2VwcyA9IGFkZEV4Y2VwdGlvbihleGNlcHMsIGtlKTsK\nICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgLy8gcmV0dXJuIGFs\nbCBleGNlcHRpb25zCiAgICAgICAgQ29sbGVjdGlvbiBwc0V4Y2VwcyA9IHBz\nTWdyLmdldEV4Y2VwdGlvbnMoKTsKICAgICAgICBpZiAoZXhjZXBzID09IG51\nbGwpCiAgICAgICAgICAgIHJldHVybiBwc0V4Y2VwczsKICAgICAgICBpZiAo\ncHNFeGNlcHMgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIGV4Y2VwczsK\nICAgICAgICBleGNlcHMuYWRkQWxsKHBzRXhjZXBzKTsKICAgICAgICByZXR1\ncm4gZXhjZXBzOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIGEgbmV3\nIHtAbGluayBSb3dNYW5hZ2VyfS4KICAgICAqLwogICAgcHJvdGVjdGVkIGFi\nc3RyYWN0IFJvd01hbmFnZXIgbmV3Um93TWFuYWdlcigpOwoKICAgIC8qKgog\nICAgICogUmV0dXJuIGEgbmV3IHtAbGluayBQcmVwYXJlZFN0YXRlbWVudE1h\nbmFnZXJ9LgogICAgICovCiAgICBwcm90ZWN0ZWQgYWJzdHJhY3QgUHJlcGFy\nZWRTdGF0ZW1lbnRNYW5hZ2VyIG5ld1ByZXBhcmVkU3RhdGVtZW50TWFuYWdl\ncigKICAgICAgICBKREJDU3RvcmUgc3RvcmUsIENvbm5lY3Rpb24gY29ubik7\nCgogICAgLyoqCiAgICAgKiBGbHVzaCBhbGwgcm93cyBvZiB0aGUgZ2l2ZW4g\ncm93IG1hbmFnZXIuIEFkZCBleGNlcHRpb25zIHRvCiAgICAgKiA8Y29kZT5l\neGNlcHM8L2NvZGU+ICh3aGljaCBtYXkgc3RhcnQgYXMgbnVsbCkgdXNpbmcK\nICAgICAqIHtAbGluayAjYWRkRXhjZXB0aW9ufS4gUmV0dXJuIDxjb2RlPmV4\nY2VwczwvY29kZT4uCiAgICAgKi8KICAgIHByb3RlY3RlZCBhYnN0cmFjdCBD\nb2xsZWN0aW9uIGZsdXNoKFJvd01hbmFnZXIgcm93TWdyLAogICAgICAgIFBy\nZXBhcmVkU3RhdGVtZW50TWFuYWdlciBwc01nciwgQ29sbGVjdGlvbiBleGNl\ncHMpOwoKICAgIC8qKgogICAgICogUG9wdWxhdGUgdGhlIHJvdyBtYW5hZ2Vy\nIHdpdGggcm93cyB0byBiZSBmbHVzaGVkIGZvciB0aGUgZ2l2ZW4gc3RhdGUu\nCiAgICAgKgogICAgICogQHBhcmFtIGV4Y2VwcyBleGNlcHRpb25zIGVuY291\nbnRlcmVkIHdoZW4gZmx1c2hpbmcgd2lsbCBiZSBhZGRlZCB0bwogICAgICog\ndGhpcyBsaXN0IGFuZCByZXR1cm5lZDsgdGhlIGxpc3QgbWF5IGJlIG51bGwg\naW5pdGlhbGx5CiAgICAgKiBAcGFyYW0gY3VzdG9tcyBidWZmZXIgY3VzdG9t\nIG1hcHBpbmdzCiAgICAgKiBAcmV0dXJuIHRoZSBleGNlcHRpb25zIGxpc3QK\nICAgICAqLwogICAgcHJvdGVjdGVkIENvbGxlY3Rpb24gcG9wdWxhdGVSb3dN\nYW5hZ2VyKE9wZW5KUEFTdGF0ZU1hbmFnZXIgc20sCiAgICAgICAgUm93TWFu\nYWdlciByb3dNZ3IsIEpEQkNTdG9yZSBzdG9yZSwgQ29sbGVjdGlvbiBleGNl\ncHMsCiAgICAgICAgQ29sbGVjdGlvbiBjdXN0b21zKSB7CiAgICAgICAgdHJ5\nIHsKICAgICAgICAgICAgQml0U2V0IGRpcnR5OwogICAgICAgICAgICBpZiAo\nc20uZ2V0UENTdGF0ZSgpID09IFBDU3RhdGUuUE5FVyAmJiAhc20uaXNGbHVz\naGVkKCkpIHsKICAgICAgICAgICAgICAgIGluc2VydChzbSwgKENsYXNzTWFw\ncGluZykgc20uZ2V0TWV0YURhdGEoKSwgcm93TWdyLCBzdG9yZSwKICAgICAg\nICAgICAgICAgICAgICBjdXN0b21zKTsKICAgICAgICAgICAgfSBlbHNlIGlm\nIChzbS5nZXRQQ1N0YXRlKCkgPT0gUENTdGF0ZS5QTkVXRkxVU0hFRERFTEVU\nRUQKICAgICAgICAgICAgICAgIHx8IHNtLmdldFBDU3RhdGUoKSA9PSBQQ1N0\nYXRlLlBERUxFVEVEKSB7CiAgICAgICAgICAgICAgICBkZWxldGUoc20sIChD\nbGFzc01hcHBpbmcpIHNtLmdldE1ldGFEYXRhKCksIHJvd01nciwgc3RvcmUs\nCiAgICAgICAgICAgICAgICAgICAgY3VzdG9tcyk7CiAgICAgICAgICAgIH0g\nZWxzZSBpZiAoKGRpcnR5ID0gSW1wbEhlbHBlci5nZXRVcGRhdGVGaWVsZHMo\nc20pKSAhPSBudWxsKSB7CiAgICAgICAgICAgICAgICB1cGRhdGUoc20sIGRp\ncnR5LCAoQ2xhc3NNYXBwaW5nKSBzbS5nZXRNZXRhRGF0YSgpLCByb3dNZ3Is\nCiAgICAgICAgICAgICAgICAgICAgc3RvcmUsIGN1c3RvbXMpOwogICAgICAg\nICAgICB9IGVsc2UgaWYgKHNtLmlzVmVyc2lvblVwZGF0ZVJlcXVpcmVkKCkp\nIHsKICAgICAgICAgICAgICAgIHVwZGF0ZUluZGljYXRvcnMoc20sIChDbGFz\nc01hcHBpbmcpIHNtLmdldE1ldGFEYXRhKCksIHJvd01nciwKICAgICAgICAg\nICAgICAgICAgICBzdG9yZSwgY3VzdG9tcywgdHJ1ZSk7CiAgICAgICAgICAg\nIH0gZWxzZSBpZiAoc20uaXNWZXJzaW9uQ2hlY2tSZXF1aXJlZCgpKSB7CiAg\nICAgICAgICAgICAgICBpZiAoISgoQ2xhc3NNYXBwaW5nKSBzbS5nZXRNZXRh\nRGF0YSgpKS5nZXRWZXJzaW9uKCkuCiAgICAgICAgICAgICAgICAgICAgY2hl\nY2tWZXJzaW9uKHNtLCBzdG9yZSwgZmFsc2UpKQogICAgICAgICAgICAgICAg\nICAgIGV4Y2VwcyA9IGFkZEV4Y2VwdGlvbihleGNlcHMsIG5ldyBPcHRpbWlz\ndGljRXhjZXB0aW9uKHNtLgogICAgICAgICAgICAgICAgICAgICAgICBnZXRN\nYW5hZ2VkSW5zdGFuY2UoKSkpOwogICAgICAgICAgICB9CiAgICAgICAgfSBj\nYXRjaCAoU1FMRXhjZXB0aW9uIHNlKSB7CiAgICAgICAgICAgIGV4Y2VwcyA9\nIGFkZEV4Y2VwdGlvbihleGNlcHMsIFNRTEV4Y2VwdGlvbnMuZ2V0U3RvcmUo\nc2UsIGRpY3QpKTsKICAgICAgICB9IGNhdGNoIChPcGVuSlBBRXhjZXB0aW9u\nIGtlKSB7CiAgICAgICAgICAgIGV4Y2VwcyA9IGFkZEV4Y2VwdGlvbihleGNl\ncHMsIGtlKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGV4Y2VwczsKICAg\nIH0KCiAgICAvKioKICAgICAqIEFkZCB0aGUgZ2l2ZW4gZXhjZXB0aW9uIHRv\nIHRoZSBnaXZlbiBsaXN0LCB3aGljaCBtYXkgc3RhcnQgb3V0IGFzIG51bGwu\nCiAgICAgKi8KICAgIHByb3RlY3RlZCBDb2xsZWN0aW9uIGFkZEV4Y2VwdGlv\nbihDb2xsZWN0aW9uIGV4Y2VwcywgRXhjZXB0aW9uIGVycikgewogICAgICAg\nIGlmIChleGNlcHMgPT0gbnVsbCkKICAgICAgICAgICAgZXhjZXBzID0gbmV3\nIExpbmtlZExpc3QoKTsKICAgICAgICBleGNlcHMuYWRkKGVycik7CiAgICAg\nICAgcmV0dXJuIGV4Y2VwczsKICAgIH0KCiAgICAvKioKICAgICAqIFJlY3Vy\nc2l2ZSBtZXRob2QgdG8gaW5zZXJ0IHRoZSBnaXZlbiBpbnN0YW5jZSwgYmFz\nZSBjbGFzcyBmaXJzdC4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIGluc2Vy\ndChPcGVuSlBBU3RhdGVNYW5hZ2VyIHNtLCBDbGFzc01hcHBpbmcgbWFwcGlu\nZywKICAgICAgICBSb3dNYW5hZ2VyIHJvd01nciwgSkRCQ1N0b3JlIHN0b3Jl\nLCBDb2xsZWN0aW9uIGN1c3RvbXMpCiAgICAgICAgdGhyb3dzIFNRTEV4Y2Vw\ndGlvbiB7CiAgICAgICAgQm9vbGVhbiBjdXN0b20gPSBtYXBwaW5nLmlzQ3Vz\ndG9tSW5zZXJ0KHNtLCBzdG9yZSk7CiAgICAgICAgaWYgKCFCb29sZWFuLkZB\nTFNFLmVxdWFscyhjdXN0b20pKQogICAgICAgICAgICBtYXBwaW5nLmN1c3Rv\nbUluc2VydChzbSwgc3RvcmUpOwogICAgICAgIGlmIChjdXN0b20uZXF1YWxz\nKEJvb2xlYW4uVFJVRSkpCiAgICAgICAgICAgIHJldHVybjsKCiAgICAgICAg\nQ2xhc3NNYXBwaW5nIHN1cCA9IG1hcHBpbmcuZ2V0Sm9pbmFibGVQQ1N1cGVy\nY2xhc3NNYXBwaW5nKCk7CiAgICAgICAgaWYgKHN1cCAhPSBudWxsKQogICAg\nICAgICAgICBpbnNlcnQoc20sIHN1cCwgcm93TWdyLCBzdG9yZSwgY3VzdG9t\ncyk7CgogICAgICAgIG1hcHBpbmcuaW5zZXJ0KHNtLCBzdG9yZSwgcm93TWdy\nKTsKICAgICAgICBGaWVsZE1hcHBpbmdbXSBmaWVsZHMgPSBtYXBwaW5nLmdl\ndERlZmluZWRGaWVsZE1hcHBpbmdzKCk7CiAgICAgICAgQml0U2V0IGRpcnR5\nID0gc20uZ2V0RGlydHkoKTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8\nIGZpZWxkcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBpZiAoZGlydHku\nZ2V0KGZpZWxkc1tpXS5nZXRJbmRleCgpKQogICAgICAgICAgICAgICAgJiYg\nIWJ1ZmZlckN1c3RvbUluc2VydChmaWVsZHNbaV0sIHNtLCBzdG9yZSwgY3Vz\ndG9tcykpCiAgICAgICAgICAgICAgICBmaWVsZHNbaV0uaW5zZXJ0KHNtLCBz\ndG9yZSwgcm93TWdyKTsKICAgICAgICB9CiAgICAgICAgaWYgKHN1cCA9PSBu\ndWxsKSB7CiAgICAgICAgICAgIFZlcnNpb24gdmVycyA9IG1hcHBpbmcuZ2V0\nVmVyc2lvbigpOwogICAgICAgICAgICBpZiAoIWJ1ZmZlckN1c3RvbUluc2Vy\ndCh2ZXJzLCBzbSwgc3RvcmUsIGN1c3RvbXMpKQogICAgICAgICAgICAgICAg\ndmVycy5pbnNlcnQoc20sIHN0b3JlLCByb3dNZ3IpOwogICAgICAgICAgICBE\naXNjcmltaW5hdG9yIGRzYyA9IG1hcHBpbmcuZ2V0RGlzY3JpbWluYXRvcigp\nOwogICAgICAgICAgICBpZiAoIWJ1ZmZlckN1c3RvbUluc2VydChkc2MsIHNt\nLCBzdG9yZSwgY3VzdG9tcykpCiAgICAgICAgICAgICAgICBkc2MuaW5zZXJ0\nKHNtLCBzdG9yZSwgcm93TWdyKTsKICAgICAgICB9CiAgICB9CgogICAgLyoq\nCiAgICAgKiBJZiB0aGUgZ2l2ZW4gbWFwcGluZyB1c2VzIGEgY3VzdG9tIGlu\nc2VydCwgcGxhY2VzIGEKICAgICAqIHtAbGluayBDdXN0b21NYXBwaW5nfSBz\ndHJ1Y3QgZm9yIGl0IGluIHRoZSBnaXZlbiBjb2xsZWN0aW9uIGFuZAogICAg\nICogcmV0dXJucyB0cnVlLCBlbHNlIHJldHVybnMgZmFsc2UuCiAgICAgKi8K\nICAgIHByaXZhdGUgYm9vbGVhbiBidWZmZXJDdXN0b21JbnNlcnQoU3RyYXRl\nZ3kgc3RyYXQsIE9wZW5KUEFTdGF0ZU1hbmFnZXIgc20sCiAgICAgICAgSkRC\nQ1N0b3JlIHN0b3JlLCBDb2xsZWN0aW9uIGN1c3RvbXMpIHsKICAgICAgICBC\nb29sZWFuIGN1c3RvbSA9IHN0cmF0LmlzQ3VzdG9tSW5zZXJ0KHNtLCBzdG9y\nZSk7CiAgICAgICAgaWYgKCFCb29sZWFuLkZBTFNFLmVxdWFscyhjdXN0b20p\nKQogICAgICAgICAgICBjdXN0b21zLmFkZChuZXcgQ3VzdG9tTWFwcGluZyhD\ndXN0b21NYXBwaW5nLklOU0VSVCwgc20sIHN0cmF0KSk7CiAgICAgICAgcmV0\ndXJuIEJvb2xlYW4uVFJVRS5lcXVhbHMoY3VzdG9tKTsKICAgIH0KCiAgICAv\nKioKICAgICAqIFJlY3Vyc2l2ZSBtZXRob2QgdG8gZGVsZXRlIHRoZSBnaXZl\nbiBpbnN0YW5jZSwgYmFzZSBjbGFzcyBsYXN0LgogICAgICovCiAgICBwcml2\nYXRlIHZvaWQgZGVsZXRlKE9wZW5KUEFTdGF0ZU1hbmFnZXIgc20sIENsYXNz\nTWFwcGluZyBtYXBwaW5nLAogICAgICAgIFJvd01hbmFnZXIgcm93TWdyLCBK\nREJDU3RvcmUgc3RvcmUsIENvbGxlY3Rpb24gY3VzdG9tcykKICAgICAgICB0\naHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBCb29sZWFuIGN1c3RvbSA9\nIG1hcHBpbmcuaXNDdXN0b21EZWxldGUoc20sIHN0b3JlKTsKICAgICAgICBp\nZiAoIUJvb2xlYW4uRkFMU0UuZXF1YWxzKGN1c3RvbSkpCiAgICAgICAgICAg\nIG1hcHBpbmcuY3VzdG9tRGVsZXRlKHNtLCBzdG9yZSk7CiAgICAgICAgaWYg\nKEJvb2xlYW4uVFJVRS5lcXVhbHMoY3VzdG9tKSkKICAgICAgICAgICAgcmV0\ndXJuOwoKICAgICAgICBGaWVsZE1hcHBpbmdbXSBmaWVsZHMgPSBtYXBwaW5n\nLmdldERlZmluZWRGaWVsZE1hcHBpbmdzKCk7CiAgICAgICAgZm9yIChpbnQg\naSA9IDA7IGkgPCBmaWVsZHMubGVuZ3RoOyBpKyspCiAgICAgICAgICAgIGlm\nICghYnVmZmVyQ3VzdG9tRGVsZXRlKGZpZWxkc1tpXSwgc20sIHN0b3JlLCBj\ndXN0b21zKSkKICAgICAgICAgICAgICAgIGZpZWxkc1tpXS5kZWxldGUoc20s\nIHN0b3JlLCByb3dNZ3IpOwoKICAgICAgICBDbGFzc01hcHBpbmcgc3VwID0g\nbWFwcGluZy5nZXRKb2luYWJsZVBDU3VwZXJjbGFzc01hcHBpbmcoKTsKICAg\nICAgICBpZiAoc3VwID09IG51bGwpIHsKICAgICAgICAgICAgVmVyc2lvbiB2\nZXJzID0gbWFwcGluZy5nZXRWZXJzaW9uKCk7CiAgICAgICAgICAgIGlmICgh\nYnVmZmVyQ3VzdG9tRGVsZXRlKHZlcnMsIHNtLCBzdG9yZSwgY3VzdG9tcykp\nCiAgICAgICAgICAgICAgICB2ZXJzLmRlbGV0ZShzbSwgc3RvcmUsIHJvd01n\ncik7CiAgICAgICAgICAgIERpc2NyaW1pbmF0b3IgZHNjID0gbWFwcGluZy5n\nZXREaXNjcmltaW5hdG9yKCk7CiAgICAgICAgICAgIGlmICghYnVmZmVyQ3Vz\ndG9tRGVsZXRlKGRzYywgc20sIHN0b3JlLCBjdXN0b21zKSkKICAgICAgICAg\nICAgICAgIGRzYy5kZWxldGUoc20sIHN0b3JlLCByb3dNZ3IpOwogICAgICAg\nIH0KICAgICAgICBtYXBwaW5nLmRlbGV0ZShzbSwgc3RvcmUsIHJvd01ncik7\nCgogICAgICAgIGlmIChzdXAgIT0gbnVsbCkKICAgICAgICAgICAgZGVsZXRl\nKHNtLCBzdXAsIHJvd01nciwgc3RvcmUsIGN1c3RvbXMpOwogICAgfQoKICAg\nIC8qKgogICAgICogQHNlZSAjYnVmZmVyQ3VzdG9tSW5zZXJ0CiAgICAgKi8K\nICAgIHByaXZhdGUgYm9vbGVhbiBidWZmZXJDdXN0b21EZWxldGUoU3RyYXRl\nZ3kgc3RyYXQsIE9wZW5KUEFTdGF0ZU1hbmFnZXIgc20sCiAgICAgICAgSkRC\nQ1N0b3JlIHN0b3JlLCBDb2xsZWN0aW9uIGN1c3RvbXMpIHsKICAgICAgICBC\nb29sZWFuIGN1c3RvbSA9IHN0cmF0LmlzQ3VzdG9tRGVsZXRlKHNtLCBzdG9y\nZSk7CiAgICAgICAgaWYgKCFCb29sZWFuLkZBTFNFLmVxdWFscyhjdXN0b20p\nKQogICAgICAgICAgICBjdXN0b21zLmFkZChuZXcgQ3VzdG9tTWFwcGluZyhD\ndXN0b21NYXBwaW5nLkRFTEVURSwgc20sIHN0cmF0KSk7CiAgICAgICAgcmV0\ndXJuIEJvb2xlYW4uVFJVRS5lcXVhbHMoY3VzdG9tKTsKICAgIH0KCiAgICAv\nKioKICAgICAqIFJlY3Vyc2l2ZSBtZXRob2QgdG8gdXBkYXRlIHRoZSBnaXZl\nbiBpbnN0YW5jZS4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIHVwZGF0ZShP\ncGVuSlBBU3RhdGVNYW5hZ2VyIHNtLCBCaXRTZXQgZGlydHksCiAgICAgICAg\nQ2xhc3NNYXBwaW5nIG1hcHBpbmcsIFJvd01hbmFnZXIgcm93TWdyLCBKREJD\nU3RvcmUgc3RvcmUsCiAgICAgICAgQ29sbGVjdGlvbiBjdXN0b21zKSB0aHJv\nd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBCb29sZWFuIGN1c3RvbSA9IG1h\ncHBpbmcuaXNDdXN0b21VcGRhdGUoc20sIHN0b3JlKTsKICAgICAgICBpZiAo\nIUJvb2xlYW4uRkFMU0UuZXF1YWxzKGN1c3RvbSkpCiAgICAgICAgICAgIG1h\ncHBpbmcuY3VzdG9tVXBkYXRlKHNtLCBzdG9yZSk7CiAgICAgICAgaWYgKEJv\nb2xlYW4uVFJVRS5lcXVhbHMoY3VzdG9tKSkKICAgICAgICAgICAgcmV0dXJu\nOwoKICAgICAgICAvLyB1cGRhdGUgYWxsIGZpZWxkcyBiZWZvcmUgYWxsIG1h\ncHBpbmdzIHNvIHRoYXQgdGhlIG1hcHBpbmdzIGNhbgogICAgICAgIC8vIGRl\ndGVjdCB3aGV0aGVyIGFueSBmaWVsZHMgaW4gdGhlaXIgcm93cyBoYXZlIGJl\nZW4gbW9kaWZpZWQKICAgICAgICBGaWVsZE1hcHBpbmdbXSBmaWVsZHMgPSBt\nYXBwaW5nLmdldERlZmluZWRGaWVsZE1hcHBpbmdzKCk7CiAgICAgICAgZm9y\nIChpbnQgaSA9IDA7IGkgPCBmaWVsZHMubGVuZ3RoOyBpKyspIHsKICAgICAg\nICAgICAgaWYgKGRpcnR5LmdldChmaWVsZHNbaV0uZ2V0SW5kZXgoKSkKICAg\nICAgICAgICAgICAgICYmICFidWZmZXJDdXN0b21VcGRhdGUoZmllbGRzW2ld\nLCBzbSwgc3RvcmUsIGN1c3RvbXMpKQogICAgICAgICAgICAgICAgZmllbGRz\nW2ldLnVwZGF0ZShzbSwgc3RvcmUsIHJvd01ncik7CiAgICAgICAgfQoKICAg\nICAgICBDbGFzc01hcHBpbmcgc3VwID0gbWFwcGluZy5nZXRKb2luYWJsZVBD\nU3VwZXJjbGFzc01hcHBpbmcoKTsKICAgICAgICBpZiAoc3VwID09IG51bGwp\nCiAgICAgICAgICAgIHVwZGF0ZUluZGljYXRvcnMoc20sIG1hcHBpbmcsIHJv\nd01nciwgc3RvcmUsIGN1c3RvbXMsIGZhbHNlKTsKICAgICAgICBlbHNlCiAg\nICAgICAgICAgIHVwZGF0ZShzbSwgZGlydHksIHN1cCwgcm93TWdyLCBzdG9y\nZSwgY3VzdG9tcyk7CiAgICAgICAgbWFwcGluZy51cGRhdGUoc20sIHN0b3Jl\nLCByb3dNZ3IpOwogICAgfQoKICAgIC8qKgogICAgICogVXBkYXRlIHZlcnNp\nb24gYW5kIGRpc2NyaW1pbmF0b3IgaW5kaWNhdG9ycy4KICAgICAqLwogICAg\ncHJpdmF0ZSB2b2lkIHVwZGF0ZUluZGljYXRvcnMoT3BlbkpQQVN0YXRlTWFu\nYWdlciBzbSwgQ2xhc3NNYXBwaW5nIG1hcHBpbmcsCiAgICAgICAgUm93TWFu\nYWdlciByb3dNZ3IsIEpEQkNTdG9yZSBzdG9yZSwgQ29sbGVjdGlvbiBjdXN0\nb21zLAogICAgICAgIGJvb2xlYW4gdmVyc2lvblVwZGF0ZU9ubHkpIHRocm93\ncyBTUUxFeGNlcHRpb24gewogICAgICAgIHdoaWxlIChtYXBwaW5nLmdldEpv\naW5hYmxlUENTdXBlcmNsYXNzTWFwcGluZygpICE9IG51bGwpCiAgICAgICAg\nICAgIG1hcHBpbmcgPSBtYXBwaW5nLmdldEpvaW5hYmxlUENTdXBlcmNsYXNz\nTWFwcGluZygpOwoKICAgICAgICBWZXJzaW9uIHZlcnMgPSBtYXBwaW5nLmdl\ndFZlcnNpb24oKTsKICAgICAgICBpZiAoIWJ1ZmZlckN1c3RvbVVwZGF0ZSh2\nZXJzLCBzbSwgc3RvcmUsIGN1c3RvbXMpKQogICAgICAgICAgICB2ZXJzLnVw\nZGF0ZShzbSwgc3RvcmUsIHJvd01ncik7CgogICAgICAgIGlmICh2ZXJzaW9u\nVXBkYXRlT25seSkgewogICAgICAgICAgICAvLyBpZiB3ZSBhcmUgb25seSB1\ncGRhdGluZyB0aGUgdmVyc2lvbiBjb2x1bW4sIHdlIG5lZWQgdG8gYWRkCiAg\nICAgICAgICAgIC8vIGluIHRoZSBwcmltYXJ5IGtleSBzZWxlY3QKICAgICAg\nICAgICAgbWFwcGluZy51cGRhdGUoc20sIHN0b3JlLCByb3dNZ3IpOwogICAg\nICAgIH0gZWxzZSB7CiAgICAgICAgICAgIC8vIG90aGVyd2lzZSB3ZSBuZWVk\nIHRvIG1ha2Ugc3VyZSB3ZSB1cGRhdGUgdGhlIGRpc2NyaW1pbmF0b3IgdG9v\nCiAgICAgICAgICAgIERpc2NyaW1pbmF0b3IgZHNjID0gbWFwcGluZy5nZXRE\naXNjcmltaW5hdG9yKCk7CiAgICAgICAgICAgIGlmICghYnVmZmVyQ3VzdG9t\nVXBkYXRlKGRzYywgc20sIHN0b3JlLCBjdXN0b21zKSkKICAgICAgICAgICAg\nICAgIGRzYy51cGRhdGUoc20sIHN0b3JlLCByb3dNZ3IpOwogICAgICAgIH0K\nICAgIH0KCiAgICAvKioKICAgICAqIEBzZWUgI2J1ZmZlckN1c3RvbUluc2Vy\ndAogICAgICovCiAgICBwcml2YXRlIGJvb2xlYW4gYnVmZmVyQ3VzdG9tVXBk\nYXRlKFN0cmF0ZWd5IHN0cmF0LCBPcGVuSlBBU3RhdGVNYW5hZ2VyIHNtLAog\nICAgICAgIEpEQkNTdG9yZSBzdG9yZSwgQ29sbGVjdGlvbiBjdXN0b21zKSB7\nCiAgICAgICAgQm9vbGVhbiBjdXN0b20gPSBzdHJhdC5pc0N1c3RvbVVwZGF0\nZShzbSwgc3RvcmUpOwogICAgICAgIGlmICghQm9vbGVhbi5GQUxTRS5lcXVh\nbHMoY3VzdG9tKSkKICAgICAgICAgICAgY3VzdG9tcy5hZGQobmV3IEN1c3Rv\nbU1hcHBpbmcoQ3VzdG9tTWFwcGluZy5VUERBVEUsIHNtLCBzdHJhdCkpOwog\nICAgICAgIHJldHVybiBCb29sZWFuLlRSVUUuZXF1YWxzKGN1c3RvbSk7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBFeGVjdXRlcyBjdXN0b21pemVkIG1hcHBp\nbmcgdXBkYXRlcy4KICAgICAqLwogICAgcHJvdGVjdGVkIHN0YXRpYyBjbGFz\ncyBDdXN0b21NYXBwaW5nIHsKCiAgICAgICAgcHVibGljIHN0YXRpYyBmaW5h\nbCBpbnQgSU5TRVJUID0gMDsKICAgICAgICBwdWJsaWMgc3RhdGljIGZpbmFs\nIGludCBVUERBVEUgPSAxOwogICAgICAgIHB1YmxpYyBzdGF0aWMgZmluYWwg\naW50IERFTEVURSA9IDM7CgogICAgICAgIHByaXZhdGUgZmluYWwgaW50IF9h\nY3Rpb247CiAgICAgICAgcHJpdmF0ZSBmaW5hbCBPcGVuSlBBU3RhdGVNYW5h\nZ2VyIF9zbTsKICAgICAgICBwcml2YXRlIGZpbmFsIFN0cmF0ZWd5IF9zdHJh\ndDsKCiAgICAgICAgcHVibGljIEN1c3RvbU1hcHBpbmcoaW50IGFjdGlvbiwg\nT3BlbkpQQVN0YXRlTWFuYWdlciBzbSwgU3RyYXRlZ3kgc3RyYXQpIHsKICAg\nICAgICAgICAgX2FjdGlvbiA9IGFjdGlvbjsKICAgICAgICAgICAgX3NtID0g\nc207CiAgICAgICAgICAgIF9zdHJhdCA9IHN0cmF0OwogICAgICAgIH0KCiAg\nICAgICAgcHVibGljIHZvaWQgZXhlY3V0ZShKREJDU3RvcmUgc3RvcmUpIHRo\ncm93cyBTUUxFeGNlcHRpb24gewogICAgICAgICAgICBzd2l0Y2ggKF9hY3Rp\nb24pIHsKICAgICAgICAgICAgY2FzZSBJTlNFUlQ6CiAgICAgICAgICAgICAg\nICBfc3RyYXQuY3VzdG9tSW5zZXJ0KF9zbSwgc3RvcmUpOwogICAgICAgICAg\nICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgVVBEQVRFOgogICAgICAg\nICAgICAgICAgX3N0cmF0LmN1c3RvbVVwZGF0ZShfc20sIHN0b3JlKTsKICAg\nICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIERFTEVURToK\nICAgICAgICAgICAgICAgIF9zdHJhdC5jdXN0b21EZWxldGUoX3NtLCBzdG9y\nZSk7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAg\nICAgIH0KICAgIH0KfQo=\n","encoding":"base64"}

