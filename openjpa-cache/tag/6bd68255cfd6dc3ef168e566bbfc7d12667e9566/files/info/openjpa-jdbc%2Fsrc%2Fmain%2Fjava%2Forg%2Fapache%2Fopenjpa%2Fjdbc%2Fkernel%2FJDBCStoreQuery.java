{"sha":"b21290ff40ffd2a50db051b65b8b915c4f280c05","node_id":"MDQ6QmxvYjIwNjM2NDpiMjEyOTBmZjQwZmZkMmE1MGRiMDUxYjY1YjhiOTE1YzRmMjgwYzA1","size":26879,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/b21290ff40ffd2a50db051b65b8b915c4f280c05","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5rZXJuZWw7CgppbXBv\ncnQgamF2YS5zcWwuQ29ubmVjdGlvbjsKaW1wb3J0IGphdmEuc3FsLlByZXBh\ncmVkU3RhdGVtZW50OwppbXBvcnQgamF2YS5zcWwuU1FMRXhjZXB0aW9uOwpp\nbXBvcnQgamF2YS51dGlsLkFycmF5TGlzdDsKaW1wb3J0IGphdmEudXRpbC5B\ncnJheXM7CmltcG9ydCBqYXZhLnV0aWwuQml0U2V0OwppbXBvcnQgamF2YS51\ndGlsLkNvbGxlY3Rpb247CmltcG9ydCBqYXZhLnV0aWwuSGFzaE1hcDsKaW1w\nb3J0IGphdmEudXRpbC5MaXN0OwppbXBvcnQgamF2YS51dGlsLk1hcDsKaW1w\nb3J0IGphdmEudXRpbC5JdGVyYXRvcjsKCmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEuZXZlbnQuTGlmZWN5Y2xlRXZlbnRNYW5hZ2VyOwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLmpkYmMua2VybmVsLmV4cHMuRXhwQ29udGV4dDsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLmtlcm5lbC5leHBzLkdl\ndENvbHVtbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLmtlcm5l\nbC5leHBzLkpEQkNFeHByZXNzaW9uRmFjdG9yeTsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5qZGJjLmtlcm5lbC5leHBzLkpEQkNTdHJpbmdDb250YWlu\nczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLmtlcm5lbC5leHBz\nLkpEQkNXaWxkY2FyZE1hdGNoOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLmpkYmMua2VybmVsLmV4cHMuUXVlcnlFeHByZXNzaW9uc1N0YXRlOwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMua2VybmVsLmV4cHMuU1FMRW1i\nZWQ7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5rZXJuZWwuZXhw\ncy5TUUxFeHByZXNzaW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpk\nYmMua2VybmVsLmV4cHMuU1FMVmFsdWU7CmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEuamRiYy5tZXRhLkNsYXNzTWFwcGluZzsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5qZGJjLm1ldGEuRmllbGRNYXBwaW5nOwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0YS5zdHJhdHMuVmVydGljYWxDbGFz\nc1N0cmF0ZWd5OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2No\nZW1hLkNvbHVtbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNj\naGVtYS5UYWJsZTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNx\nbC5EQkRpY3Rpb25hcnk7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRi\nYy5zcWwuU1FMQnVmZmVyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpk\nYmMuc3FsLlNRTEV4Y2VwdGlvbnM7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEuamRiYy5zcWwuU2VsZWN0OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLmpkYmMuc3FsLlVuaW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmtl\ncm5lbC5FeHByZXNzaW9uU3RvcmVRdWVyeTsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS5rZXJuZWwuT3JkZXJpbmdNZXJnZWRSZXN1bHRPYmplY3RQcm92\naWRlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuUXVlcnlI\naW50czsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuZXhwcy5F\neHByZXNzaW9uRmFjdG9yeTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5r\nZXJuZWwuZXhwcy5FeHByZXNzaW9uUGFyc2VyOwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLmtlcm5lbC5leHBzLkZpbHRlckxpc3RlbmVyOwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5leHBzLlF1ZXJ5RXhwcmVzc2lv\nbnM7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnJvcC5NZXJnZWRS\nZXN1bHRPYmplY3RQcm92aWRlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3Blbmpw\nYS5saWIucm9wLlJhbmdlUmVzdWx0T2JqZWN0UHJvdmlkZXI7CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEubGliLnJvcC5SZXN1bHRPYmplY3RQcm92aWRl\ncjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIudXRpbC5Mb2NhbGl6\nZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YS5DbGFzc01ldGFE\nYXRhOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuVmFsdWVNZXRh\nRGF0YTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRhLkZpZWxkTWV0\nYURhdGE7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5Vc2VyRXhj\nZXB0aW9uOwppbXBvcnQgc2VycC51dGlsLk51bWJlcnM7CgovKioKICogSkRC\nQyBxdWVyeSBpbXBsZW1lbnRhdGlvbi4KICoKICogQGF1dGhvciBBYmUgV2hp\ndGUKICogQG5vamF2YWRvYwogKi8KcHVibGljIGNsYXNzIEpEQkNTdG9yZVF1\nZXJ5IAogICAgZXh0ZW5kcyBFeHByZXNzaW9uU3RvcmVRdWVyeSB7CgogICAg\ncHJpdmF0ZSBzdGF0aWMgZmluYWwgVGFibGUgSU5WQUxJRCA9IG5ldyBUYWJs\nZSgpOwoKICAgIC8vIGFkZCBhbGwgc3RhbmRhcmQgZmlsdGVyIGFuZCBhZ2dy\nZWdhdGUgbGlzdGVuZXJzIHRvIHRoZXNlIG1hcHMKICAgIHByaXZhdGUgc3Rh\ndGljIGZpbmFsIE1hcCBfbGlzdGVuZXJzID0gbmV3IEhhc2hNYXAoKTsKCiAg\nICBzdGF0aWMgewogICAgICAgIC8vIGRlcHJlY2F0ZWQgZXh0ZW5zaW9ucwog\nICAgICAgIF9saXN0ZW5lcnMucHV0KEpEQkNTdHJpbmdDb250YWlucy5UQUcs\nIG5ldyBKREJDU3RyaW5nQ29udGFpbnMoKSk7CiAgICAgICAgX2xpc3RlbmVy\ncy5wdXQoSkRCQ1dpbGRjYXJkTWF0Y2guVEFHLCBuZXcgSkRCQ1dpbGRjYXJk\nTWF0Y2goKSk7CiAgICAgICAgX2xpc3RlbmVycy5wdXQoU1FMRXhwcmVzc2lv\nbi5UQUcsIG5ldyBTUUxFeHByZXNzaW9uKCkpOwogICAgICAgIF9saXN0ZW5l\ncnMucHV0KFNRTFZhbHVlLlRBRywgbmV3IFNRTFZhbHVlKCkpOwoKICAgICAg\nICAvLyBqZGJjLXNwZWNpZmljIGV4dGVuc2lvbnMKICAgICAgICBfbGlzdGVu\nZXJzLnB1dChHZXRDb2x1bW4uVEFHLCBuZXcgR2V0Q29sdW1uKCkpOwogICAg\nICAgIF9saXN0ZW5lcnMucHV0KFNRTEVtYmVkLlRBRywgbmV3IFNRTEVtYmVk\nKCkpOwogICAgfQoKICAgIHByaXZhdGUgZmluYWwgdHJhbnNpZW50IEpEQkNT\ndG9yZSBfc3RvcmU7CgogICAgLyoqCiAgICAgKiBDb25zdHJ1Y3Rvci4gU3Vw\ncGx5IHN0b3JlIG1hbmFnZXIuCiAgICAgKi8KICAgIHB1YmxpYyBKREJDU3Rv\ncmVRdWVyeShKREJDU3RvcmUgc3RvcmUsIEV4cHJlc3Npb25QYXJzZXIgcGFy\nc2VyKSB7CiAgICAgICAgc3VwZXIocGFyc2VyKTsKICAgICAgICBfc3RvcmUg\nPSBzdG9yZTsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgc3Rv\ncmUuCiAgICAgKi8KICAgIHB1YmxpYyBKREJDU3RvcmUgZ2V0U3RvcmUoKSB7\nCiAgICAgICAgcmV0dXJuIF9zdG9yZTsKICAgIH0KCiAgICBwdWJsaWMgRmls\ndGVyTGlzdGVuZXIgZ2V0RmlsdGVyTGlzdGVuZXIoU3RyaW5nIHRhZykgewog\nICAgICAgIHJldHVybiAoRmlsdGVyTGlzdGVuZXIpIF9saXN0ZW5lcnMuZ2V0\nKHRhZyk7CiAgICB9CgogICAgcHVibGljIE9iamVjdCBuZXdDb21waWxhdGlv\nbktleSgpIHsKICAgICAgICBKREJDRmV0Y2hDb25maWd1cmF0aW9uIGZldGNo\nID0gKEpEQkNGZXRjaENvbmZpZ3VyYXRpb24pIGN0eAogICAgICAgICAgICAu\nZ2V0RmV0Y2hDb25maWd1cmF0aW9uKCk7CiAgICAgICAgcmV0dXJuIE51bWJl\ncnMudmFsdWVPZihmZXRjaC5nZXRKb2luU3ludGF4KCkpOwogICAgfQoKICAg\nIHB1YmxpYyBib29sZWFuIHN1cHBvcnRzRGF0YVN0b3JlRXhlY3V0aW9uKCkg\newogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIHByb3RlY3RlZCBD\nbGFzc01ldGFEYXRhW10gZ2V0SW5kZXBlbmRlbnRFeHByZXNzaW9uQ2FuZGlk\nYXRlcygKICAgICAgICBDbGFzc01ldGFEYXRhIG1ldGEsIGJvb2xlYW4gc3Vi\nY2xhc3NlcykgewogICAgICAgIGlmICghc3ViY2xhc3NlcykKICAgICAgICAg\nICAgcmV0dXJuIG5ldyBDbGFzc01hcHBpbmdbXSB7IChDbGFzc01hcHBpbmcp\nIG1ldGEgfTsKICAgICAgICByZXR1cm4gKChDbGFzc01hcHBpbmcpIG1ldGEp\nLmdldEluZGVwZW5kZW50QXNzaWduYWJsZU1hcHBpbmdzKCk7CiAgICB9Cgog\nICAgcHJvdGVjdGVkIEV4cHJlc3Npb25GYWN0b3J5IGdldEV4cHJlc3Npb25G\nYWN0b3J5KENsYXNzTWV0YURhdGEgbWV0YSkgewogICAgICAgIHJldHVybiBu\nZXcgSkRCQ0V4cHJlc3Npb25GYWN0b3J5KChDbGFzc01hcHBpbmcpIG1ldGEp\nOwogICAgfQoKICAgIHByb3RlY3RlZCBSZXN1bHRPYmplY3RQcm92aWRlciBl\neGVjdXRlUXVlcnkoRXhlY3V0b3IgZXgsCiAgICAgICAgQ2xhc3NNZXRhRGF0\nYSBiYXNlLCBDbGFzc01ldGFEYXRhW10gbWV0YXMsIGJvb2xlYW4gc3ViY2xh\nc3NlcywKICAgICAgICBFeHByZXNzaW9uRmFjdG9yeVtdIGZhY3RzLCBRdWVy\neUV4cHJlc3Npb25zW10gZXhwcywgT2JqZWN0W10gcGFyYW1zLAogICAgICAg\nIFJhbmdlIHJhbmdlKSB7CiAgICAgICAgaWYgKG1ldGFzLmxlbmd0aCA+IDEg\nJiYgZXhwc1swXS5pc0FnZ3JlZ2F0ZSgpKQogICAgICAgICAgICB0aHJvdyBu\nZXcgVXNlckV4Y2VwdGlvbihMb2NhbGl6ZXIuZm9yUGFja2FnZShKREJDU3Rv\ncmVRdWVyeS5jbGFzcykuCiAgICAgICAgICAgICAgICBnZXQoIm11bHQtbWFw\ncGluZy1hZ2dyZWdhdGUiLCBBcnJheXMuYXNMaXN0KG1ldGFzKSkpOwoKICAg\nICAgICBDbGFzc01hcHBpbmdbXSBtYXBwaW5ncyA9IChDbGFzc01hcHBpbmdb\nXSkgbWV0YXM7CiAgICAgICAgSkRCQ0ZldGNoQ29uZmlndXJhdGlvbiBmZXRj\naCA9IChKREJDRmV0Y2hDb25maWd1cmF0aW9uKSAKICAgICAgICAgICAgY3R4\nLmdldEZldGNoQ29uZmlndXJhdGlvbigpOwogICAgICAgIGlmIChleHBzWzBd\nLmZldGNoUGF0aHMgIT0gbnVsbCkgewogICAgICAgICAgICBmZXRjaC5hZGRG\naWVsZHMoQXJyYXlzLmFzTGlzdChleHBzWzBdLmZldGNoUGF0aHMpKTsKICAg\nICAgICAgICAgZmV0Y2guYWRkSm9pbnMoQXJyYXlzLmFzTGlzdChleHBzWzBd\nLmZldGNoUGF0aHMpKTsKICAgICAgICB9CgogICAgICAgIGludCBlYWdlciA9\nIGNhbGN1bGF0ZUVhZ2VyTW9kZShleHBzWzBdLCByYW5nZS5zdGFydCwgcmFu\nZ2UuZW5kKTsKICAgICAgICBpbnQgc3ViY2xhc3NNb2RlID0gZmV0Y2guZ2V0\nU3ViY2xhc3NGZXRjaE1vZGUoKENsYXNzTWFwcGluZykgYmFzZSk7CiAgICAg\nICAgREJEaWN0aW9uYXJ5IGRpY3QgPSBfc3RvcmUuZ2V0REJEaWN0aW9uYXJ5\nKCk7CiAgICAgICAgbG9uZyBzdGFydCA9IChtYXBwaW5ncy5sZW5ndGggPT0g\nMSAmJiBkaWN0LnN1cHBvcnRzU2VsZWN0U3RhcnRJbmRleCkgCiAgICAgICAg\nICAgID8gcmFuZ2Uuc3RhcnQgOiAwTDsKICAgICAgICBsb25nIGVuZCA9IChk\naWN0LnN1cHBvcnRzU2VsZWN0RW5kSW5kZXgpID8gcmFuZ2UuZW5kIDogTG9u\nZy5NQVhfVkFMVUU7CgogICAgICAgIFF1ZXJ5RXhwcmVzc2lvbnNTdGF0ZVtd\nIHN0YXRlcyA9IG5ldyBRdWVyeUV4cHJlc3Npb25zU3RhdGVbZXhwcy5sZW5n\ndGhdOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgc3RhdGVzLmxlbmd0\naDsgaSsrKQogICAgICAgICAgICBzdGF0ZXNbaV0gPSBuZXcgUXVlcnlFeHBy\nZXNzaW9uc1N0YXRlKCk7CiAgICAgICAgRXhwQ29udGV4dCBjdHggPSBuZXcg\nRXhwQ29udGV4dChfc3RvcmUsIHBhcmFtcywgZmV0Y2gpOwoKICAgICAgICAv\nLyBhZGQgc2VsZWN0cyB3aXRoIHBvcHVsYXRlIFdIRVJFIGNvbmRpdGlvbnMg\ndG8gbGlzdAogICAgICAgIExpc3Qgc2VscyA9IG5ldyBBcnJheUxpc3QobWFw\ncGluZ3MubGVuZ3RoKTsKICAgICAgICBMaXN0IHNlbE1hcHBpbmdzID0gbmV3\nIEFycmF5TGlzdChtYXBwaW5ncy5sZW5ndGgpOwogICAgICAgIEJpdFNldCBz\ndWJjbGFzc0JpdHMgPSBuZXcgQml0U2V0KCk7CiAgICAgICAgQml0U2V0IG5l\neHRCaXRzID0gbmV3IEJpdFNldCgpOwogICAgICAgIGJvb2xlYW4gdW5pb25h\nYmxlID0gY3JlYXRlV2hlcmVTZWxlY3RzKHNlbHMsIG1hcHBpbmdzLCBzZWxN\nYXBwaW5ncywKICAgICAgICAgICAgc3ViY2xhc3Nlcywgc3ViY2xhc3NCaXRz\nLCBuZXh0Qml0cywgZmFjdHMsIGV4cHMsIHN0YXRlcywgY3R4LAogICAgICAg\nICAgICBzdWJjbGFzc01vZGUpCiAgICAgICAgICAgICYmIHN1YmNsYXNzTW9k\nZSA9PSBKREJDRmV0Y2hDb25maWd1cmF0aW9uLkVBR0VSX0pPSU4KICAgICAg\nICAgICAgJiYgc3RhcnQgPT0gMAogICAgICAgICAgICAmJiBlbmQgPT0gTG9u\nZy5NQVhfVkFMVUU7CgogICAgICAgIC8vIHdlIG1pZ2h0IHdhbnQgdG8gdXNl\nIGxycyBzZXR0aW5ncyBpZiB3ZSBjYW4ndCB1c2UgdGhlIHJhbmdlCiAgICAg\nICAgaWYgKHNlbHMuc2l6ZSgpID4gMSkKICAgICAgICAgICAgc3RhcnQgPSAw\nTDsKICAgICAgICBib29sZWFuIGxycyA9IHJhbmdlLmxycyB8fCAoZmV0Y2gu\nZ2V0RmV0Y2hCYXRjaFNpemUoKSA+PSAwIAogICAgICAgICAgICAmJiAoc3Rh\ncnQgIT0gcmFuZ2Uuc3RhcnQgfHwgZW5kICE9IHJhbmdlLmVuZCkpOwoKICAg\nICAgICBSZXN1bHRPYmplY3RQcm92aWRlcltdIHJvcHMgPSBudWxsOwogICAg\nICAgIFJlc3VsdE9iamVjdFByb3ZpZGVyIHJvcCA9IG51bGw7CiAgICAgICAg\naWYgKHVuaW9uYWJsZSkgewogICAgICAgICAgICBVbmlvbiB1bmlvbiA9IF9z\ndG9yZS5nZXRTUUxGYWN0b3J5KCkubmV3VW5pb24oCiAgICAgICAgICAgICAg\nICAoU2VsZWN0W10pIHNlbHMudG9BcnJheShuZXcgU2VsZWN0W3NlbHMuc2l6\nZSgpXSkpOwogICAgICAgICAgICBCaXRTZXRbXSBwYWdlZCA9IHBvcHVsYXRl\nVW5pb24odW5pb24sIG1hcHBpbmdzLCBzdWJjbGFzc2VzLCBmYWN0cywKICAg\nICAgICAgICAgICAgIGV4cHMsIHN0YXRlcywgY3R4LCBscnMsIGVhZ2VyLCBz\ndGFydCwgZW5kKTsKICAgICAgICAgICAgdW5pb24uc2V0TFJTKGxycyk7CiAg\nICAgICAgICAgIHJvcCA9IGV4ZWN1dGVVbmlvbih1bmlvbiwgbWFwcGluZ3Ms\nIGV4cHMsIHN0YXRlcywgY3R4LCBwYWdlZCk7CiAgICAgICAgfSBlbHNlIHsK\nICAgICAgICAgICAgaWYgKHNlbHMuc2l6ZSgpID4gMSkKICAgICAgICAgICAg\nICAgIHJvcHMgPSBuZXcgUmVzdWx0T2JqZWN0UHJvdmlkZXJbc2Vscy5zaXpl\nKCldOwoKICAgICAgICAgICAgU2VsZWN0IHNlbDsKICAgICAgICAgICAgQml0\nU2V0IHBhZ2VkOwogICAgICAgICAgICBmb3IgKGludCBpID0gMCwgaWR4ID0g\nMDsgaSA8IHNlbHMuc2l6ZSgpOyBpKyspIHsKICAgICAgICAgICAgICAgIHNl\nbCA9IChTZWxlY3QpIHNlbHMuZ2V0KGkpOwogICAgICAgICAgICAgICAgcGFn\nZWQgPSBwb3B1bGF0ZVNlbGVjdChzZWwsIChDbGFzc01hcHBpbmcpIHNlbE1h\ncHBpbmdzLmdldChpKSwKICAgICAgICAgICAgICAgICAgICBzdWJjbGFzc0Jp\ndHMuZ2V0KGkpLCAoSkRCQ0V4cHJlc3Npb25GYWN0b3J5KSBmYWN0c1tpZHhd\nLAogICAgICAgICAgICAgICAgICAgIGV4cHNbaWR4XSwgc3RhdGVzW2lkeF0s\nIGN0eCwgbHJzLCBlYWdlciwgc3RhcnQsIGVuZCk7CgogICAgICAgICAgICAg\nICAgcm9wID0gZXhlY3V0ZVNlbGVjdChzZWwsIChDbGFzc01hcHBpbmcpIHNl\nbE1hcHBpbmdzLmdldChpKSwKICAgICAgICAgICAgICAgICAgICBleHBzW2lk\neF0sIHN0YXRlc1tpZHhdLCBjdHgsIHBhZ2VkLCBzdGFydCwgZW5kKTsKICAg\nICAgICAgICAgICAgIGlmIChyb3BzICE9IG51bGwpCiAgICAgICAgICAgICAg\nICAgICAgcm9wc1tpXSA9IHJvcDsKCiAgICAgICAgICAgICAgICBpZiAobmV4\ndEJpdHMuZ2V0KGkpKQogICAgICAgICAgICAgICAgICAgIGlkeCsrOwogICAg\nICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAocm9wcyAhPSBudWxs\nKSB7CiAgICAgICAgICAgIGlmIChleHBzWzBdLmFzY2VuZGluZy5sZW5ndGgg\nPT0gMCkKICAgICAgICAgICAgICAgIHJvcCA9IG5ldyBNZXJnZWRSZXN1bHRP\nYmplY3RQcm92aWRlcihyb3BzKTsKICAgICAgICAgICAgZWxzZSB7CiAgICAg\nICAgICAgICAgICByb3AgPSBuZXcgT3JkZXJpbmdNZXJnZWRSZXN1bHRPYmpl\nY3RQcm92aWRlcihyb3BzLAogICAgICAgICAgICAgICAgICAgIGV4cHNbMF0u\nYXNjZW5kaW5nLCBleCwgdGhpcywgcGFyYW1zKTsKICAgICAgICAgICAgfQog\nICAgICAgIH0KCiAgICAgICAgLy8gbmVlZCB0byBmYWtlIHJlc3VsdCByYW5n\nZT8KICAgICAgICBpZiAoKHJvcHMgIT0gbnVsbCAmJiByYW5nZS5lbmQgIT0g\nTG9uZy5NQVhfVkFMVUUpIAogICAgICAgICAgICB8fCBzdGFydCAhPSByYW5n\nZS5zdGFydCB8fCBlbmQgIT0gcmFuZ2UuZW5kKQogICAgICAgICAgICByb3Ag\nPSBuZXcgUmFuZ2VSZXN1bHRPYmplY3RQcm92aWRlcihyb3AsIHJhbmdlLnN0\nYXJ0LCByYW5nZS5lbmQpOwogICAgICAgIHJldHVybiByb3A7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBTZWxlY3QgZGF0YSBmb3IgdGhlIGdpdmVuIHVuaW9u\nLCByZXR1cm5pbmcgcGFnZWQgZmllbGRzLgogICAgICovCiAgICBwcml2YXRl\nIEJpdFNldFtdIHBvcHVsYXRlVW5pb24oVW5pb24gdW5pb24sIGZpbmFsIENs\nYXNzTWFwcGluZ1tdIG1hcHBpbmdzLAogICAgICAgIGZpbmFsIGJvb2xlYW4g\nc3ViY2xhc3NlcywgZmluYWwgRXhwcmVzc2lvbkZhY3RvcnlbXSBmYWN0cywK\nICAgICAgICBmaW5hbCBRdWVyeUV4cHJlc3Npb25zW10gZXhwcywgZmluYWwg\nUXVlcnlFeHByZXNzaW9uc1N0YXRlW10gc3RhdGVzLAogICAgICAgIGZpbmFs\nIEV4cENvbnRleHQgY3R4LCBmaW5hbCBib29sZWFuIGxycywgZmluYWwgaW50\nIGVhZ2VyLAogICAgICAgIGZpbmFsIGxvbmcgc3RhcnQsIGZpbmFsIGxvbmcg\nZW5kKSB7CiAgICAgICAgZmluYWwgQml0U2V0W10gcGFnZWQgPSAoZXhwc1sw\nXS5wcm9qZWN0aW9ucy5sZW5ndGggPiAwKSA/IG51bGwKICAgICAgICAgICAg\nOiBuZXcgQml0U2V0W21hcHBpbmdzLmxlbmd0aF07CiAgICAgICAgdW5pb24u\nc2VsZWN0KG5ldyBVbmlvbi5TZWxlY3RvcigpIHsKICAgICAgICAgICAgcHVi\nbGljIHZvaWQgc2VsZWN0KFNlbGVjdCBzZWwsIGludCBpZHgpIHsKICAgICAg\nICAgICAgICAgIEJpdFNldCBiaXRzID0gcG9wdWxhdGVTZWxlY3Qoc2VsLCBt\nYXBwaW5nc1tpZHhdLCBzdWJjbGFzc2VzLAogICAgICAgICAgICAgICAgICAg\nIChKREJDRXhwcmVzc2lvbkZhY3RvcnkpIGZhY3RzW2lkeF0sIGV4cHNbaWR4\nXSwgc3RhdGVzW2lkeF0sCiAgICAgICAgICAgICAgICAgICAgY3R4LCAgbHJz\nLCBlYWdlciwgc3RhcnQsIGVuZCk7CiAgICAgICAgICAgICAgICBpZiAocGFn\nZWQgIT0gbnVsbCkKICAgICAgICAgICAgICAgICAgICBwYWdlZFtpZHhdID0g\nYml0czsKICAgICAgICAgICAgfQogICAgICAgIH0pOwogICAgICAgIHJldHVy\nbiBwYWdlZDsKICAgIH0KCiAgICAvKioKICAgICAqIFNlbGVjdCBkYXRhIGZv\nciB0aGUgZ2l2ZW4gc2VsZWN0LCByZXR1cm5pbmcgcGFnZWQgZmllbGRzLgog\nICAgICovCiAgICBwcml2YXRlIEJpdFNldCBwb3B1bGF0ZVNlbGVjdChTZWxl\nY3Qgc2VsLCBDbGFzc01hcHBpbmcgbWFwcGluZywKICAgICAgICBib29sZWFu\nIHN1YmNsYXNzZXMsIEpEQkNFeHByZXNzaW9uRmFjdG9yeSBmYWN0LCBRdWVy\neUV4cHJlc3Npb25zIGV4cHMsCiAgICAgICAgUXVlcnlFeHByZXNzaW9uc1N0\nYXRlIHN0YXRlLCBFeHBDb250ZXh0IGN0eCwgYm9vbGVhbiBscnMsIGludCBl\nYWdlciwKICAgICAgICBsb25nIHN0YXJ0LCBsb25nIGVuZCkgewogICAgICAg\nIHNlbC5zZXRMUlMobHJzKTsKICAgICAgICBzZWwuc2V0UmFuZ2Uoc3RhcnQs\nIGVuZCk7CgogICAgICAgIEJpdFNldCBwYWdlZCA9IG51bGw7CiAgICAgICAg\naWYgKGV4cHMucHJvamVjdGlvbnMubGVuZ3RoID09IDApIHsKICAgICAgICAg\nICAgcGFnZWQgPSBQYWdpbmdSZXN1bHRPYmplY3RQcm92aWRlci5nZXRQYWdl\nZEZpZWxkcyhzZWwsIG1hcHBpbmcsCiAgICAgICAgICAgICAgICBfc3RvcmUs\nIGN0eC5mZXRjaCwgZWFnZXIsIGVuZCAtIHN0YXJ0KTsKICAgICAgICAgICAg\naWYgKHBhZ2VkICE9IG51bGwpCiAgICAgICAgICAgICAgICBlYWdlciA9IEpE\nQkNGZXRjaENvbmZpZ3VyYXRpb24uRUFHRVJfSk9JTjsKICAgICAgICB9Cgog\nICAgICAgIGZhY3QuZ2V0U2VsZWN0Q29uc3RydWN0b3IoKS5zZWxlY3Qoc2Vs\nLCBjdHgsIG1hcHBpbmcsIHN1YmNsYXNzZXMsIGV4cHMsCiAgICAgICAgICAg\nIHN0YXRlLCBlYWdlcik7CiAgICAgICAgcmV0dXJuIHBhZ2VkOwogICAgfQoK\nICAgIC8qKgogICAgICogRXhlY3V0ZSB0aGUgZ2l2ZW4gdW5pb24uCiAgICAg\nKi8KICAgIHByaXZhdGUgUmVzdWx0T2JqZWN0UHJvdmlkZXIgZXhlY3V0ZVVu\naW9uKFVuaW9uIHVuaW9uLAogICAgICAgIENsYXNzTWFwcGluZ1tdIG1hcHBp\nbmdzLCBRdWVyeUV4cHJlc3Npb25zW10gZXhwcywgCiAgICAgICAgUXVlcnlF\neHByZXNzaW9uc1N0YXRlW10gc3RhdGVzLCBFeHBDb250ZXh0IGN0eCwgQml0\nU2V0W10gcGFnZWQpIHsKICAgICAgICBpZiAoZXhwc1swXS5wcm9qZWN0aW9u\ncy5sZW5ndGggPiAwKQogICAgICAgICAgICByZXR1cm4gbmV3IFByb2plY3Rp\nb25SZXN1bHRPYmplY3RQcm92aWRlcih1bmlvbiwgZXhwcywgc3RhdGVzLCBj\ndHgpOwoKICAgICAgICBpZiAocGFnZWQgIT0gbnVsbCkKICAgICAgICAgICAg\nZm9yIChpbnQgaSA9IDA7IGkgPCBwYWdlZC5sZW5ndGg7IGkrKykKICAgICAg\nICAgICAgICAgIGlmIChwYWdlZFtpXSAhPSBudWxsKQogICAgICAgICAgICAg\nICAgICAgIHJldHVybiBuZXcgUGFnaW5nUmVzdWx0T2JqZWN0UHJvdmlkZXIo\ndW5pb24sIG1hcHBpbmdzLAogICAgICAgICAgICAgICAgICAgICAgICBfc3Rv\ncmUsIGN0eC5mZXRjaCwgcGFnZWQsIExvbmcuTUFYX1ZBTFVFKTsKCiAgICAg\nICAgcmV0dXJuIG5ldyBJbnN0YW5jZVJlc3VsdE9iamVjdFByb3ZpZGVyKHVu\naW9uLCBtYXBwaW5nc1swXSwgX3N0b3JlLAogICAgICAgICAgICBjdHguZmV0\nY2gpOwogICAgfQoKICAgIC8qKgogICAgICogRXhlY3V0ZSB0aGUgZ2l2ZW4g\nc2VsZWN0LgogICAgICovCiAgICBwcml2YXRlIFJlc3VsdE9iamVjdFByb3Zp\nZGVyIGV4ZWN1dGVTZWxlY3QoU2VsZWN0IHNlbCwgQ2xhc3NNYXBwaW5nIG1h\ncHBpbmcsCiAgICAgICAgUXVlcnlFeHByZXNzaW9ucyBleHBzLCBRdWVyeUV4\ncHJlc3Npb25zU3RhdGUgc3RhdGUsIEV4cENvbnRleHQgY3R4LCAKICAgICAg\nICBCaXRTZXQgcGFnZWQsIGxvbmcgc3RhcnQsIGxvbmcgZW5kKSB7CiAgICAg\nICAgaWYgKGV4cHMucHJvamVjdGlvbnMubGVuZ3RoID4gMCkKICAgICAgICAg\nICAgcmV0dXJuIG5ldyBQcm9qZWN0aW9uUmVzdWx0T2JqZWN0UHJvdmlkZXIo\nc2VsLCBleHBzLCBzdGF0ZSwgY3R4KTsKICAgICAgICBpZiAocGFnZWQgIT0g\nbnVsbCkKICAgICAgICAgICAgcmV0dXJuIG5ldyBQYWdpbmdSZXN1bHRPYmpl\nY3RQcm92aWRlcihzZWwsIG1hcHBpbmcsIF9zdG9yZSwgCiAgICAgICAgICAg\nICAgICBjdHguZmV0Y2gsIHBhZ2VkLCBlbmQgLSBzdGFydCk7CiAgICAgICAg\ncmV0dXJuIG5ldyBJbnN0YW5jZVJlc3VsdE9iamVjdFByb3ZpZGVyKHNlbCwg\nbWFwcGluZywgX3N0b3JlLCAKICAgICAgICAgICAgY3R4LmZldGNoKTsKICAg\nIH0KCiAgICAvKioKICAgICAqIEdlbmVyYXRlIHRoZSBzZWxlY3RzIHdpdGgg\nV0hFUkUgY29uZGl0aW9ucyBuZWVkZWQgdG8gZXhlY3V0ZSB0aGUgcXVlcnkK\nICAgICAqIGZvciB0aGUgZ2l2ZW4gbWFwcGluZ3MuCiAgICAgKi8KICAgIHBy\naXZhdGUgYm9vbGVhbiBjcmVhdGVXaGVyZVNlbGVjdHMoTGlzdCBzZWxzLCBD\nbGFzc01hcHBpbmdbXSBtYXBwaW5ncywKICAgICAgICBMaXN0IHNlbE1hcHBp\nbmdzLCBib29sZWFuIHN1YmNsYXNzZXMsIEJpdFNldCBzdWJjbGFzc0JpdHMs\nCiAgICAgICAgQml0U2V0IG5leHRCaXRzLCBFeHByZXNzaW9uRmFjdG9yeVtd\nIGZhY3RzLCBRdWVyeUV4cHJlc3Npb25zW10gZXhwcywKICAgICAgICBRdWVy\neUV4cHJlc3Npb25zU3RhdGVbXSBzdGF0ZXMsIEV4cENvbnRleHQgY3R4LCBp\nbnQgc3ViY2xhc3NNb2RlKSB7CiAgICAgICAgTnVtYmVyIG9wdEhpbnQgPSAo\nTnVtYmVyKSBjdHguZmV0Y2guZ2V0SGludAogICAgICAgICAgICAoUXVlcnlI\naW50cy5ISU5UX1JFU1VMVF9DT1VOVCk7CiAgICAgICAgQ2xhc3NNYXBwaW5n\nW10gdmVydHM7CiAgICAgICAgYm9vbGVhbiB1bmlvbmFibGUgPSB0cnVlOwog\nICAgICAgIFNlbGVjdCBzZWw7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkg\nPCBtYXBwaW5ncy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAvLyBkZXRl\ncm1pbmUgdmVydGljYWwgbWFwcGluZ3MgdG8gc2VsZWN0IHNlcGFyYXRlbHkK\nICAgICAgICAgICAgdmVydHMgPSBnZXRWZXJ0aWNhbE1hcHBpbmdzKG1hcHBp\nbmdzW2ldLCBzdWJjbGFzc2VzLCBleHBzW2ldLAogICAgICAgICAgICAgICAg\nc3ViY2xhc3NNb2RlKTsKICAgICAgICAgICAgaWYgKHZlcnRzLmxlbmd0aCA9\nPSAxICYmIHN1YmNsYXNzZXMpCiAgICAgICAgICAgICAgICBzdWJjbGFzc0Jp\ndHMuc2V0KHNlbHMuc2l6ZSgpKTsKCiAgICAgICAgICAgIC8vIGNyZWF0ZSBj\ncml0ZXJpYSBzZWxlY3QgYW5kIGNsb25lIGZvciBlYWNoIHZlcnQgbWFwcGlu\nZwogICAgICAgICAgICBzZWwgPSAoKEpEQkNFeHByZXNzaW9uRmFjdG9yeSkg\nZmFjdHNbaV0pLmdldFNlbGVjdENvbnN0cnVjdG9yKCkuCiAgICAgICAgICAg\nICAgICBldmFsdWF0ZShjdHgsIG51bGwsIG51bGwsIGV4cHNbaV0sIHN0YXRl\nc1tpXSk7CiAgICAgICAgICAgIGlmIChvcHRIaW50ICE9IG51bGwpCiAgICAg\nICAgICAgICAgIHNlbC5zZXRFeHBlY3RlZFJlc3VsdENvdW50KG9wdEhpbnQu\naW50VmFsdWUoKSwgdHJ1ZSk7CiAgICAgICAgICAgIGVsc2UgaWYgKHRoaXMu\nY3R4LmlzVW5pcXVlKCkpCiAgICAgICAgICAgICAgICBzZWwuc2V0RXhwZWN0\nZWRSZXN1bHRDb3VudCgxLCBmYWxzZSk7CiAgICAgICAgICAgIGZvciAoaW50\nIGogPSAwOyBqIDwgdmVydHMubGVuZ3RoOyBqKyspIHsKICAgICAgICAgICAg\nICAgIHNlbE1hcHBpbmdzLmFkZCh2ZXJ0c1tqXSk7CiAgICAgICAgICAgICAg\nICBpZiAoaiA9PSB2ZXJ0cy5sZW5ndGggLSAxKSB7CiAgICAgICAgICAgICAg\nICAgICAgbmV4dEJpdHMuc2V0KHNlbHMuc2l6ZSgpKTsKICAgICAgICAgICAg\nICAgICAgICBzZWxzLmFkZChzZWwpOwogICAgICAgICAgICAgICAgfSBlbHNl\nCiAgICAgICAgICAgICAgICAgICAgc2Vscy5hZGQoc2VsLmZ1bGxDbG9uZSgx\nKSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIHR1cm4gb2ZmIHVu\naW9uaW5nIGlmIGEgZ2l2ZW4gaW5kZXBlbmRlbnQgbWFwcGluZyByZXF1aXJl\ncwogICAgICAgICAgICAvLyBtdWx0aXBsZSBzZWxlY3RzLCBvciBpZiB3ZSdy\nZSB1c2luZyBGUk9NIHNlbGVjdHMKICAgICAgICAgICAgaWYgKHZlcnRzLmxl\nbmd0aCA+IDEgfHwgc2VsLmdldEZyb21TZWxlY3QoKSAhPSBudWxsKQogICAg\nICAgICAgICAgICAgdW5pb25hYmxlID0gZmFsc2U7CiAgICAgICAgfQogICAg\nICAgIHJldHVybiB1bmlvbmFibGU7CiAgICB9CgogICAgLyoqCiAgICAgKiBS\nZXR1cm4gYWxsIHRoZSB2ZXJ0aWNhbCBtYXBwaW5ncyB0byBzZWxlY3Qgc2Vw\nYXJhdGVseS4gRGVwZW5kcyBvbgogICAgICogc3ViY2xhc3MgZmV0Y2ggbW9k\nZSBhbmQgdGhlIHR5cGUgb2YgcXVlcnkuCiAgICAgKi8KICAgIHByaXZhdGUg\nQ2xhc3NNYXBwaW5nW10gZ2V0VmVydGljYWxNYXBwaW5ncyhDbGFzc01hcHBp\nbmcgbWFwcGluZywKICAgICAgICBib29sZWFuIHN1YmNsYXNzZXMsIFF1ZXJ5\nRXhwcmVzc2lvbnMgZXhwcywgaW50IHN1YmNsYXNzTW9kZSkgewogICAgICAg\nIGlmICghc3ViY2xhc3NlcyB8fCBleHBzLnByb2plY3Rpb25zLmxlbmd0aCA+\nIDApCiAgICAgICAgICAgIHJldHVybiBuZXcgQ2xhc3NNYXBwaW5nW10geyBt\nYXBwaW5nIH07CgogICAgICAgIGlmIChzdWJjbGFzc01vZGUgIT0gSkRCQ0Zl\ndGNoQ29uZmlndXJhdGlvbi5FQUdFUl9QQVJBTExFTAogICAgICAgICAgICB8\nfCAhaGFzVmVydGljYWxTdWJjbGFzc2VzKG1hcHBpbmcpKQogICAgICAgICAg\nICByZXR1cm4gbmV3IENsYXNzTWFwcGluZ1tdIHsgbWFwcGluZyB9OwoKICAg\nICAgICBMaXN0IHN1YnMgPSBuZXcgQXJyYXlMaXN0KDQpOwogICAgICAgIGFk\nZFN1YmNsYXNzZXMobWFwcGluZywgc3Vicyk7CiAgICAgICAgcmV0dXJuIChD\nbGFzc01hcHBpbmdbXSkgc3Vicy50b0FycmF5KG5ldyBDbGFzc01hcHBpbmdb\nc3Vicy5zaXplKCldKTsKICAgIH0KCiAgICAvKioKICAgICAqIFJlY3Vyc2l2\nZSBoZWxwZXIgdG8gYWRkIG1hcHBpbmdzIGZvciBzdWJjbGFzc2VzIHRvIHRo\nZSBnaXZlbiBsaXN0LgogICAgICovCiAgICBwcml2YXRlIHZvaWQgYWRkU3Vi\nY2xhc3NlcyhDbGFzc01hcHBpbmcgbWFwcGluZywgQ29sbGVjdGlvbiBzdWJz\nKSB7CiAgICAgICAgLy8gcG9zc2libGUgZnV0dXJlIG9wdGltaXphdGlvbnM6\nCiAgICAgICAgLy8gLSBpZiBubyBmaWVsZHMgaW4gbWV0YSBvciBpdHMgc3Vi\nY2xhc3NlcyAoYW5kIG5vdCBpbiBhbgogICAgICAgIC8vICAgYWxyZWFkeS1z\nZWxlY3RlZCB0YWJsZSkgYXJlIGluIHRoZSBjdXJyZW50IGZldGNoCiAgICAg\nICAgLy8gICBjb25maWd1cmF0aW9uLCBzdG9wIGNyZWF0aW5nIG5ldyBleGVj\ndXRvcnMKICAgICAgICAvLyAtIGFsbG93IGFuIGV4ZWN1dG9yIHRvIHNlbGVj\ndCBhIHJhbmdlIG9mIHN1YmNsYXNzZXMsIHJhdGhlcgogICAgICAgIC8vICAg\ndGhhbiBqdXN0IGFsbCBzdWJjbGFzc2VzIC8gbm8gc3ViY2xhc3NlczsgdGhp\ncyB3b3VsZAogICAgICAgIC8vICAgYWxsb3cgdXMgdG8gZG8ganVzdCBvbmUg\ncXVlcnkgcGVyIGFjdHVhbCB2ZXJ0aWNhbGx5LW1hcHBlZAogICAgICAgIC8v\nICAgc3ViY2xhc3MsIHJhdGhlciB0aGFuIG9uZSBwZXIgbWFwcGVkIHN1YmNs\nYXNzLCBhcyBpcyBoYXBwZW5pbmcgbm93CgogICAgICAgIHN1YnMuYWRkKG1h\ncHBpbmcpOwogICAgICAgIGlmICghaGFzVmVydGljYWxTdWJjbGFzc2VzKG1h\ncHBpbmcpKQogICAgICAgICAgICByZXR1cm47CgogICAgICAgIC8vIHJlY3Vy\nc2Ugb24gaW1tZWRpYXRlIHN1YmNsYXNzZXMKICAgICAgICBDbGFzc01hcHBp\nbmdbXSBzdWJNYXBwaW5ncyA9IG1hcHBpbmcuZ2V0Sm9pbmFibGVQQ1N1YmNs\nYXNzTWFwcGluZ3MoKTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IHN1\nYk1hcHBpbmdzLmxlbmd0aDsgaSsrKQogICAgICAgICAgICBpZiAoc3ViTWFw\ncGluZ3NbaV0uZ2V0Sm9pbmFibGVQQ1N1cGVyY2xhc3NNYXBwaW5nKCkgPT0g\nbWFwcGluZykKICAgICAgICAgICAgICAgIGFkZFN1YmNsYXNzZXMoc3ViTWFw\ncGluZ3NbaV0sIHN1YnMpOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJu\nIHdoZXRoZXIgdGhlIGdpdmVuIGNsYXNzIGhhcyBhbnkgdmVydGljYWwgc3Vi\nY2xhc3Nlcy4KICAgICAqLwogICAgcHJpdmF0ZSBzdGF0aWMgYm9vbGVhbiBo\nYXNWZXJ0aWNhbFN1YmNsYXNzZXMoQ2xhc3NNYXBwaW5nIG1hcHBpbmcpIHsK\nICAgICAgICBDbGFzc01hcHBpbmdbXSBzdWJzID0gbWFwcGluZy5nZXRKb2lu\nYWJsZVBDU3ViY2xhc3NNYXBwaW5ncygpOwogICAgICAgIGZvciAoaW50IGkg\nPSAwOyBpIDwgc3Vicy5sZW5ndGg7IGkrKykKICAgICAgICAgICAgaWYgKHN1\nYnNbaV0uZ2V0U3RyYXRlZ3koKSBpbnN0YW5jZW9mIFZlcnRpY2FsQ2xhc3NT\ndHJhdGVneSkKICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAg\nIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICAvKioKICAgICAqIFRoZSBlYWdl\nciBtb2RlIGRlcGVuZHMgb24gdGhlIHVuaXF1ZSBzZXR0aW5nIGFuZCByYW5n\nZS4gSWYgdGhlIHJhbmdlCiAgICAgKiBwcm9kdWNlcyAwIHJlc3VsdHMsIHVz\nZSBlYWdlciBzZXR0aW5nIG9mIG5vbmUuIElmIGl0IHByb2R1Y2VzIDEgcmVz\ndWx0CiAgICAgKiBvciB0aGUgcXVlcnkgaXMgdW5pcXVlLCB1c2UgYW4gZWFn\nZXIgc2V0dGluZyBvZiBzaW5nbGUuIE90aGVyd2lzZSB1c2UKICAgICAqIGFu\nIGVhZ2VyIG1vZGUgb2YgbXVsdGlwbGUuCiAgICAgKi8KICAgIHByaXZhdGUg\naW50IGNhbGN1bGF0ZUVhZ2VyTW9kZShRdWVyeUV4cHJlc3Npb25zIGV4cHMs\nIGxvbmcgc3RhcnQsCiAgICAgICAgbG9uZyBlbmQpIHsKICAgICAgICBpZiAo\nZXhwcy5wcm9qZWN0aW9ucy5sZW5ndGggPiAwIHx8IHN0YXJ0ID49IGVuZCkK\nICAgICAgICAgICAgcmV0dXJuIEVhZ2VyRmV0Y2hNb2Rlcy5FQUdFUl9OT05F\nOwogICAgICAgIGlmIChlbmQgLSBzdGFydCA9PSAxIHx8IGN0eC5pc1VuaXF1\nZSgpKQogICAgICAgICAgICByZXR1cm4gRWFnZXJGZXRjaE1vZGVzLkVBR0VS\nX0pPSU47CiAgICAgICAgcmV0dXJuIEVhZ2VyRmV0Y2hNb2Rlcy5FQUdFUl9Q\nQVJBTExFTDsKICAgIH0KCiAgICBwcm90ZWN0ZWQgTnVtYmVyIGV4ZWN1dGVE\nZWxldGUoRXhlY3V0b3IgZXgsIENsYXNzTWV0YURhdGEgYmFzZSwKICAgICAg\nICBDbGFzc01ldGFEYXRhW10gbWV0YXMsIGJvb2xlYW4gc3ViY2xhc3Nlcywg\nRXhwcmVzc2lvbkZhY3RvcnlbXSBmYWN0cywKICAgICAgICBRdWVyeUV4cHJl\nc3Npb25zW10gZXhwcywgT2JqZWN0W10gcGFyYW1zKSB7CiAgICAgICAgcmV0\ndXJuIGV4ZWN1dGVCdWxrT3BlcmF0aW9uKGV4LCBiYXNlLCBtZXRhcywgc3Vi\nY2xhc3NlcywgZmFjdHMsIGV4cHMsCiAgICAgICAgICAgIHBhcmFtcywgbnVs\nbCk7CiAgICB9CgogICAgcHJvdGVjdGVkIE51bWJlciBleGVjdXRlVXBkYXRl\nKEV4ZWN1dG9yIGV4LCBDbGFzc01ldGFEYXRhIGJhc2UsCiAgICAgICAgQ2xh\nc3NNZXRhRGF0YVtdIG1ldGFzLCBib29sZWFuIHN1YmNsYXNzZXMsIEV4cHJl\nc3Npb25GYWN0b3J5W10gZmFjdHMsCiAgICAgICAgUXVlcnlFeHByZXNzaW9u\nc1tdIGV4cHMsIE9iamVjdFtdIHBhcmFtcykgewogICAgICAgIHJldHVybiBl\neGVjdXRlQnVsa09wZXJhdGlvbihleCwgYmFzZSwgbWV0YXMsIHN1YmNsYXNz\nZXMsIGZhY3RzLCBleHBzLAogICAgICAgICAgICBwYXJhbXMsIGV4cHNbMF0u\ndXBkYXRlcyk7CiAgICB9CgogICAgcHJpdmF0ZSBOdW1iZXIgZXhlY3V0ZUJ1\nbGtPcGVyYXRpb24oRXhlY3V0b3IgZXgsIENsYXNzTWV0YURhdGEgYmFzZSwK\nICAgICAgICBDbGFzc01ldGFEYXRhW10gbWV0YXMsIGJvb2xlYW4gc3ViY2xh\nc3NlcywgRXhwcmVzc2lvbkZhY3RvcnlbXSBmYWN0cywKICAgICAgICBRdWVy\neUV4cHJlc3Npb25zW10gZXhwcywgT2JqZWN0W10gcGFyYW1zLCBNYXAgdXBk\nYXRlcykgewogICAgICAgIC8vIHdlIGNhbm5vdCBleGVjdXRlIGEgYnVsayBk\nZWxldGUgc3RhdGVtZW50IHdoZW4gaGF2ZSBtYXBwaW5ncyBpbgogICAgICAg\nIC8vIG11bHRpcGxlIHRhYmxlcywgc28gaW5kaWNhdGUgd2Ugd2FudCB0byB1\nc2UgaW4tbWVtb3J5IHdpdGggbnVsbAogICAgICAgIENsYXNzTWFwcGluZ1td\nIG1hcHBpbmdzID0gKENsYXNzTWFwcGluZ1tdKSBtZXRhczsKCiAgICAgICAg\nLy8gc3BlY2lmaWNhdGlvbiBvZiB0aGUgInVwZGF0ZXMiIG1hcCBpbmRpY2F0\nZXMgdGhhdCB0aGlzIGlzCiAgICAgICAgLy8gYW4gdXBkYXRlIHF1ZXJ5OyBv\ndGhlcndpc2UsIHRoaXMgaXMgYSBkZWxldGUgc3RhdGVtZW50CiAgICAgICAg\nYm9vbGVhbiBpc1VwZGF0ZSA9IHVwZGF0ZXMgIT0gbnVsbCAmJiB1cGRhdGVz\nLnNpemUoKSA+IDA7CgogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgbWFw\ncGluZ3MubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgaWYgKCFpc1Npbmds\nZVRhYmxlTWFwcGluZyhtYXBwaW5nc1tpXSwgc3ViY2xhc3NlcykgJiYgIWlz\nVXBkYXRlKQogICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7CgogICAgICAg\nICAgICBpZiAoIWlzVXBkYXRlKSB7CiAgICAgICAgICAgICAgICAvLyBpZiB0\naGVyZSBhcmUgYW55IGRlbGV0ZSBjYWxsYmFja3MsIHdlIG5lZWQgdG8KICAg\nICAgICAgICAgICAgIC8vIGV4ZWN1dGUgaW4tbWVtb3J5IHNvIHRoZSBjYWxs\nYmFja3MgYXJlIGludm9rZWQKICAgICAgICAgICAgICAgIExpZmVjeWNsZUV2\nZW50TWFuYWdlciBtZ3IgPSBjdHguZ2V0U3RvcmVDb250ZXh0KCkuZ2V0QnJv\na2VyKCkKICAgICAgICAgICAgICAgICAgICAuZ2V0TGlmZWN5Y2xlRXZlbnRN\nYW5hZ2VyKCk7CiAgICAgICAgICAgICAgICBpZiAobWdyLmhhc0RlbGV0ZUxp\nc3RlbmVycyhudWxsLCBtYXBwaW5nc1tpXSkpCiAgICAgICAgICAgICAgICAg\nICAgcmV0dXJuIG51bGw7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAg\nICAgIEpEQkNGZXRjaENvbmZpZ3VyYXRpb24gZmV0Y2ggPSAoSkRCQ0ZldGNo\nQ29uZmlndXJhdGlvbikgCiAgICAgICAgICAgIGN0eC5nZXRGZXRjaENvbmZp\nZ3VyYXRpb24oKTsKICAgICAgICBFeHBDb250ZXh0IGN0eCA9IG5ldyBFeHBD\nb250ZXh0KF9zdG9yZSwgcGFyYW1zLCBmZXRjaCk7CiAgICAgICAgREJEaWN0\naW9uYXJ5IGRpY3QgPSBfc3RvcmUuZ2V0REJEaWN0aW9uYXJ5KCk7CiAgICAg\nICAgUXVlcnlFeHByZXNzaW9uc1N0YXRlW10gc3RhdGUgPSBuZXcgUXVlcnlF\neHByZXNzaW9uc1N0YXRlW2V4cHMubGVuZ3RoXTsKICAgICAgICBmb3IgKGlu\ndCBpID0gMDsgaSA8IHN0YXRlLmxlbmd0aDsgaSsrKQogICAgICAgICAgICBz\ndGF0ZVtpXSA9IG5ldyBRdWVyeUV4cHJlc3Npb25zU3RhdGUoKTsKCiAgICAg\nICAgU1FMQnVmZmVyW10gc3FsID0gbmV3IFNRTEJ1ZmZlclttYXBwaW5ncy5s\nZW5ndGhdOwogICAgICAgIEpEQkNFeHByZXNzaW9uRmFjdG9yeSBqZGJjRmFj\ndG9yeTsKICAgICAgICBTZWxlY3Qgc2VsOwogICAgICAgIGZvciAoaW50IGkg\nPSAwOyBpIDwgbWFwcGluZ3MubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAg\namRiY0ZhY3RvcnkgPSAoSkRCQ0V4cHJlc3Npb25GYWN0b3J5KSBmYWN0c1tp\nXTsKICAgICAgICAgICAgc2VsID0gamRiY0ZhY3RvcnkuZ2V0U2VsZWN0Q29u\nc3RydWN0b3IoKS5ldmFsdWF0ZShjdHgsIG51bGwsIG51bGwsCiAgICAgICAg\nICAgICAgICBleHBzW2ldLCBzdGF0ZVtpXSk7CiAgICAgICAgICAgIGpkYmNG\nYWN0b3J5LmdldFNlbGVjdENvbnN0cnVjdG9yKCkuc2VsZWN0KHNlbCwgY3R4\nLCBtYXBwaW5nc1tpXSwgCiAgICAgICAgICAgICAgICBzdWJjbGFzc2VzLCBl\neHBzW2ldLCBzdGF0ZVtpXSwgCiAgICAgICAgICAgICAgICBKREJDRmV0Y2hD\nb25maWd1cmF0aW9uLkVBR0VSX05PTkUpOwoKICAgICAgICAgICAgLy8gVGhl\nIGJ1bGsgb3BlcmF0aW9uIHdpbGwgcmV0dXJuIG51bGwgdG8gaW5kaWNhdGUg\ndGhhdCB0aGUgZGF0YWJhc2UKICAgICAgICAgICAgLy8gZG9lcyBub3Qgc3Vw\ncG9ydCB0aGUgcmVxdWVzdCBidWxrIGRlbGV0ZSBvcGVyYXRpb247IGluCiAg\nICAgICAgICAgIC8vIHRoaXMgY2FzZSwgd2UgbmVlZCB0byBwZXJmb3JtIHRo\nZSBxdWVyeSBpbi1tZW1vcnkgYW5kCiAgICAgICAgICAgIC8vIG1hbnVhbGx5\nIGRlbGV0ZSB0aGUgaW5zdGFuY2VzCiAgICAgICAgICAgIGlmICghaXNVcGRh\ndGUpCiAgICAgICAgICAgICAgICBzcWxbaV0gPSBkaWN0LnRvRGVsZXRlKG1h\ncHBpbmdzW2ldLCBzZWwsIHBhcmFtcyk7CiAgICAgICAgICAgIGVsc2UKICAg\nICAgICAgICAgICAgIHNxbFtpXSA9IGRpY3QudG9VcGRhdGUobWFwcGluZ3Nb\naV0sIHNlbCwgX3N0b3JlLCBwYXJhbXMsCiAgICAgICAgICAgICAgICAgICAg\ndXBkYXRlcyk7CgogICAgICAgICAgICBpZiAoc3FsW2ldID09IG51bGwpCiAg\nICAgICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICB9CgogICAgICAg\nIC8vIHdlIG5lZWQgdG8gbWFrZSBzdXJlIHdlIGhhdmUgYW4gYWN0aXZlIHN0\nb3JlIGNvbm5lY3Rpb24KICAgICAgICBfc3RvcmUuZ2V0Q29udGV4dCgpLmJl\nZ2luU3RvcmUoKTsKCiAgICAgICAgQ29ubmVjdGlvbiBjb25uID0gX3N0b3Jl\nLmdldENvbm5lY3Rpb24oKTsKICAgICAgICBsb25nIGNvdW50ID0gMDsKICAg\nICAgICB0cnkgewogICAgICAgICAgICBQcmVwYXJlZFN0YXRlbWVudCBzdG1u\ndDsKICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBzcWwubGVuZ3Ro\nOyBpKyspIHsKICAgICAgICAgICAgICAgIHN0bW50ID0gbnVsbDsKICAgICAg\nICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgc3RtbnQgPSBz\ncWxbaV0ucHJlcGFyZVN0YXRlbWVudChjb25uKTsKICAgICAgICAgICAgICAg\nICAgICBjb3VudCArPSBzdG1udC5leGVjdXRlVXBkYXRlKCk7CiAgICAgICAg\nICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICAgICAgICAgIGlmIChz\ndG1udCAhPSBudWxsKQogICAgICAgICAgICAgICAgICAgICAgICB0cnkgeyBz\ndG1udC5jbG9zZSgpOyB9IGNhdGNoIChTUUxFeGNlcHRpb24gc2UpIHt9CiAg\nICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9IGNhdGNo\nIChTUUxFeGNlcHRpb24gc2UpIHsKICAgICAgICAgICAgdGhyb3cgU1FMRXhj\nZXB0aW9ucy5nZXRTdG9yZShzZSwgY3R4LCBfc3RvcmUuZ2V0REJEaWN0aW9u\nYXJ5KCkpOwogICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgIHRyeSB7\nIGNvbm4uY2xvc2UoKTsgfSBjYXRjaCAoU1FMRXhjZXB0aW9uIHNlKSB7fQog\nICAgICAgIH0KICAgICAgICByZXR1cm4gTnVtYmVycy52YWx1ZU9mKGNvdW50\nKTsKICAgIH0KCiAgICAvKioKICAgICAqIFdoZXRoZXIgdGhlIGdpdmVuIG1h\ncHBpbmcgb2NjdXBpZXMgb25seSBvbmUgdGFibGUuCiAgICAgKi8KICAgIHBy\naXZhdGUgYm9vbGVhbiBpc1NpbmdsZVRhYmxlTWFwcGluZyhDbGFzc01hcHBp\nbmcgbWFwcGluZywKICAgICAgICBib29sZWFuIHN1YmNsYXNzZXMpIHsKICAg\nICAgICBDbGFzc01hcHBpbmcgcm9vdCA9IG1hcHBpbmc7CiAgICAgICAgd2hp\nbGUgKHJvb3QuZ2V0Sm9pbmFibGVQQ1N1cGVyY2xhc3NNYXBwaW5nKCkgIT0g\nbnVsbCkKICAgICAgICAgICAgcm9vdCA9IHJvb3QuZ2V0Sm9pbmFibGVQQ1N1\ncGVyY2xhc3NNYXBwaW5nKCk7CiAgICAgICAgaWYgKGhhc1ZlcnRpY2FsU3Vi\nY2xhc3Nlcyhyb290KSkKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoKICAg\nICAgICAvLyB3ZSBjYW5ub3QgZXhlY3V0ZSBhIGJ1bGsgZGVsZXRlIGlmIGFu\neSBvZiB0aGUKICAgICAgICAvLyBmaWVsZCBtYXBwaW5ncyBmb3IgdGhlIGNh\nbmRpZGF0ZXMgaGF2ZSBjb2x1bW5zCiAgICAgICAgLy8gaW4gYW55IG90aGVy\nIHRhYmxlLCBzaW5jZSBidWxrIGRlbGV0aW5nIGp1c3QgZnJvbSB0aGUKICAg\nICAgICAvLyBjbGFzcyB3aWxsIGxlYXZlIGRhbmdsaW5nIHJlbGF0aW9uczsg\nd2UgbWlnaHQgYmUgYWJsZQogICAgICAgIC8vIHRvIGlzc3VlIGJ1bGsgZGVs\nZXRlcyBzZXBhcmF0ZWx5IGZvciB0aGUgam9pbnMgKHBvc3NpYmx5CiAgICAg\nICAgLy8gdXNpbmcgYSB0ZW1wb3JhcnkgdGFibGUgdG8gc2VsZWN0IHRoZSBw\ncmltYXJ5IGtleXMgZm9yCiAgICAgICAgLy8gYWxsIHRoZSByZWxhdGVkIHRh\nYmxlcyBhbmQgdGhlbiBpc3NpbmcgYSBkZWxldGUgYWdhaW5zdCB0aG9zZQog\nICAgICAgIC8vIGtleXMpLCBidXQgdGhhdCBsb2dpYyBpcyBub3QgY3VycmVu\ndGx5IGltcGxlbWVudGVkCiAgICAgICAgVGFibGUgdGFibGUgPSBnZXRUYWJs\nZShtYXBwaW5nLmdldEZpZWxkTWFwcGluZ3MoKSwgbnVsbCk7CiAgICAgICAg\naWYgKHRhYmxlID09IElOVkFMSUQpCiAgICAgICAgICAgIHJldHVybiBmYWxz\nZTsKCiAgICAgICAgaWYgKHN1YmNsYXNzZXMpIHsKICAgICAgICAgICAgLy8g\naWYgd2UgYXJlIGluY2x1ZGluZyBzdWJjbGFzc2VzLCB3ZSBhbHNvIG5lZWQg\ndG8gZ2F0aGVyCiAgICAgICAgICAgIC8vIGFsbCB0aGUgbWFwcGluZ3MgZm9y\nIGFsbCBrbm93biBzdWJjbGFzc2VzCiAgICAgICAgICAgIENsYXNzTWFwcGlu\nZ1tdIHN1YnMgPSBtYXBwaW5nLmdldEpvaW5hYmxlUENTdWJjbGFzc01hcHBp\nbmdzKCk7CiAgICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBzdWJzICE9IG51\nbGwgJiYgaSA8IHN1YnMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICAg\nIHRhYmxlID0gZ2V0VGFibGUoc3Vic1tpXS5nZXREZWZpbmVkRmllbGRNYXBw\naW5ncygpLCB0YWJsZSk7CiAgICAgICAgICAgICAgICBpZiAodGFibGUgPT0g\nSU5WQUxJRCkKICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAg\nICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIHRydWU7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIHNpbmdsZSB0YWJsZSBm\nb3IgdGhlIGdpdmVuIGZpZWxkcywgb3IgSU5WQUxJRCBpZiB0aGV5CiAgICAg\nKiB1c2UgbXVsdGlwbGUgdGFibGVzLgogICAgICovCiAgICBwcml2YXRlIFRh\nYmxlIGdldFRhYmxlKEZpZWxkTWFwcGluZ1tdIGZpZWxkcywgVGFibGUgdGFi\nbGUpIHsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGZpZWxkcy5sZW5n\ndGg7IGkrKykgewogICAgICAgICAgICB0YWJsZSA9IGdldFRhYmxlKGZpZWxk\nc1tpXSwgdGFibGUpOwogICAgICAgICAgICBpZiAodGFibGUgPT0gSU5WQUxJ\nRCkKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgICBy\nZXR1cm4gdGFibGU7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhl\nIHRhYmxlIGZvciB0aGUgZmllbGQgaWYgdGhlIGdpdmVuIHRhYmxlIGhhc24n\ndCBiZWVuIHNldAogICAgICogeWV0LCBvciBpZiB0aGUgdGFibGVzIG1hdGNo\nLiBJZiB0aGUgZmllbGQgdXNlcyBhIGRpZmZlcmVudCB0YWJsZSwKICAgICAq\nIHJldHVybnMgSU5WQUxJRC4gQWxzbyByZXR1cm5zIElOVkFMSUQgaWYgZmll\nbGQgaXMgZGVwZW5kZW50LgogICAgICovCiAgICBwcml2YXRlIFRhYmxlIGdl\ndFRhYmxlKEZpZWxkTWFwcGluZyBmbSwgVGFibGUgdGFibGUpIHsKICAgICAg\nICBpZiAoZm0uZ2V0Q2FzY2FkZURlbGV0ZSgpICE9IFZhbHVlTWV0YURhdGEu\nQ0FTQ0FERV9OT05FKQogICAgICAgICAgICByZXR1cm4gSU5WQUxJRDsKCiAg\nICAgICAgQ29sdW1uW10gY29sdW1ucyA9IGZtLmdldENvbHVtbnMoKTsKICAg\nICAgICBmb3IgKGludCBpID0gMDsgY29sdW1ucyAhPSBudWxsICYmIGkgPCBj\nb2x1bW5zLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGlmICh0YWJsZSA9\nPSBudWxsKQogICAgICAgICAgICAgICAgdGFibGUgPSBjb2x1bW5zW2ldLmdl\ndFRhYmxlKCk7CiAgICAgICAgICAgIGVsc2UgaWYgKHRhYmxlICE9IGNvbHVt\nbnNbaV0uZ2V0VGFibGUoKSkKICAgICAgICAgICAgICAgIHJldHVybiBJTlZB\nTElEOwogICAgICAgIH0KICAgICAgICByZXR1cm4gdGFibGU7CiAgICB9Cgog\nICAgcHJvdGVjdGVkIE51bWJlciBleGVjdXRlVXBkYXRlKENsYXNzTWV0YURh\ndGEgYmFzZSwgQ2xhc3NNZXRhRGF0YVtdIG1ldGFzLAogICAgICAgIGJvb2xl\nYW4gc3ViY2xhc3NlcywgRXhwcmVzc2lvbkZhY3RvcnlbXSBmYWN0cywKICAg\nICAgICBRdWVyeUV4cHJlc3Npb25zW10gcGFyc2VkLCBPYmplY3RbXSBwYXJh\nbXMpIHsKICAgICAgICByZXR1cm4gbnVsbDsKICAgIH0KCiAgICBwcm90ZWN0\nZWQgU3RyaW5nW10gZ2V0RGF0YVN0b3JlQWN0aW9ucyhDbGFzc01ldGFEYXRh\nIGJhc2UsCiAgICAgICAgQ2xhc3NNZXRhRGF0YVtdIG1ldGFzLCBib29sZWFu\nIHN1YmNsYXNzZXMsIEV4cHJlc3Npb25GYWN0b3J5W10gZmFjdHMsCiAgICAg\nICAgUXVlcnlFeHByZXNzaW9uc1tdIGV4cHMsIE9iamVjdFtdIHBhcmFtcywg\nUmFuZ2UgcmFuZ2UpIHsKICAgICAgICBDbGFzc01hcHBpbmdbXSBtYXBwaW5n\ncyA9IChDbGFzc01hcHBpbmdbXSkgbWV0YXM7CiAgICAgICAgSkRCQ0ZldGNo\nQ29uZmlndXJhdGlvbiBmZXRjaCA9IChKREJDRmV0Y2hDb25maWd1cmF0aW9u\nKSBjdHguCiAgICAgICAgICAgIGdldEZldGNoQ29uZmlndXJhdGlvbigpOwog\nICAgICAgIGlmIChleHBzWzBdLmZldGNoUGF0aHMgIT0gbnVsbCkgewogICAg\nICAgICAgICBmZXRjaC5hZGRGaWVsZHMoQXJyYXlzLmFzTGlzdChleHBzWzBd\nLmZldGNoUGF0aHMpKTsKICAgICAgICAgICAgZmV0Y2guYWRkSm9pbnMoQXJy\nYXlzLmFzTGlzdChleHBzWzBdLmZldGNoUGF0aHMpKTsKICAgICAgICB9Cgog\nICAgICAgIGludCBlYWdlciA9IGNhbGN1bGF0ZUVhZ2VyTW9kZShleHBzWzBd\nLCByYW5nZS5zdGFydCwgcmFuZ2UuZW5kKTsKICAgICAgICBlYWdlciA9IE1h\ndGgubWluKGVhZ2VyLCBKREJDRmV0Y2hDb25maWd1cmF0aW9uLkVBR0VSX0pP\nSU4pOwogICAgICAgIGludCBzdWJjbGFzc01vZGUgPSBmZXRjaC5nZXRTdWJj\nbGFzc0ZldGNoTW9kZSgoQ2xhc3NNYXBwaW5nKSBiYXNlKTsKICAgICAgICBE\nQkRpY3Rpb25hcnkgZGljdCA9IF9zdG9yZS5nZXREQkRpY3Rpb25hcnkoKTsK\nICAgICAgICBsb25nIHN0YXJ0ID0gKG1hcHBpbmdzLmxlbmd0aCA9PSAxICYm\nIGRpY3Quc3VwcG9ydHNTZWxlY3RTdGFydEluZGV4KSAKICAgICAgICAgICAg\nPyByYW5nZS5zdGFydCA6IDBMOwogICAgICAgIGxvbmcgZW5kID0gKGRpY3Qu\nc3VwcG9ydHNTZWxlY3RFbmRJbmRleCkgPyByYW5nZS5lbmQgOiBMb25nLk1B\nWF9WQUxVRTsKCiAgICAgICAgUXVlcnlFeHByZXNzaW9uc1N0YXRlW10gc3Rh\ndGVzID0gbmV3IFF1ZXJ5RXhwcmVzc2lvbnNTdGF0ZVtleHBzLmxlbmd0aF07\nCiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBzdGF0ZXMubGVuZ3RoOyBp\nKyspCiAgICAgICAgICAgIHN0YXRlc1tpXSA9IG5ldyBRdWVyeUV4cHJlc3Np\nb25zU3RhdGUoKTsKICAgICAgICBFeHBDb250ZXh0IGN0eCA9IG5ldyBFeHBD\nb250ZXh0KF9zdG9yZSwgcGFyYW1zLCBmZXRjaCk7CgogICAgICAgIC8vIGFk\nZCBzZWxlY3RzIHdpdGggcG9wdWxhdGUgV0hFUkUgY29uZGl0aW9ucyB0byBs\naXN0CiAgICAgICAgTGlzdCBzZWxzID0gbmV3IEFycmF5TGlzdChtYXBwaW5n\ncy5sZW5ndGgpOwogICAgICAgIExpc3Qgc2VsTWFwcGluZ3MgPSBuZXcgQXJy\nYXlMaXN0KG1hcHBpbmdzLmxlbmd0aCk7CiAgICAgICAgQml0U2V0IHN1YmNs\nYXNzQml0cyA9IG5ldyBCaXRTZXQoKTsKICAgICAgICBCaXRTZXQgbmV4dEJp\ndHMgPSBuZXcgQml0U2V0KCk7CiAgICAgICAgYm9vbGVhbiB1bmlvbmFibGUg\nPSBjcmVhdGVXaGVyZVNlbGVjdHMoc2VscywgbWFwcGluZ3MsIHNlbE1hcHBp\nbmdzLAogICAgICAgICAgICBzdWJjbGFzc2VzLCBzdWJjbGFzc0JpdHMsIG5l\neHRCaXRzLCBmYWN0cywgZXhwcywgc3RhdGVzLCBjdHgsIAogICAgICAgICAg\nICBzdWJjbGFzc01vZGUpICYmIHN1YmNsYXNzTW9kZSA9PSBKREJDRmV0Y2hD\nb25maWd1cmF0aW9uLkVBR0VSX0pPSU47CiAgICAgICAgaWYgKHNlbHMuc2l6\nZSgpID4gMSkKICAgICAgICAgICAgc3RhcnQgPSAwTDsKCiAgICAgICAgaWYg\nKHVuaW9uYWJsZSkgewogICAgICAgICAgICBVbmlvbiB1bmlvbiA9IF9zdG9y\nZS5nZXRTUUxGYWN0b3J5KCkubmV3VW5pb24oCiAgICAgICAgICAgICAgICAo\nU2VsZWN0W10pIHNlbHMudG9BcnJheShuZXcgU2VsZWN0W3NlbHMuc2l6ZSgp\nXSkpOwogICAgICAgICAgICBwb3B1bGF0ZVVuaW9uKHVuaW9uLCBtYXBwaW5n\ncywgc3ViY2xhc3NlcywgZmFjdHMsIGV4cHMsIHN0YXRlcywgY3R4LAogICAg\nICAgICAgICAgICAgZmFsc2UsIGVhZ2VyLCBzdGFydCwgZW5kKTsKICAgICAg\nICAgICAgaWYgKHVuaW9uLmlzVW5pb24oKSkKICAgICAgICAgICAgICAgIHJl\ndHVybiBuZXcgU3RyaW5nW10ge3VuaW9uLnRvU2VsZWN0KGZhbHNlLCBmZXRj\naCkuZ2V0U1FMKHRydWUpfTsKICAgICAgICAgICAgc2VscyA9IEFycmF5cy5h\nc0xpc3QodW5pb24uZ2V0U2VsZWN0cygpKTsKICAgICAgICB9IGVsc2Ugewog\nICAgICAgICAgICBTZWxlY3Qgc2VsOwogICAgICAgICAgICBmb3IgKGludCBp\nID0gMCwgaWR4ID0gMDsgaSA8IHNlbHMuc2l6ZSgpOyBpKyspIHsKICAgICAg\nICAgICAgICAgIHNlbCA9IChTZWxlY3QpIHNlbHMuZ2V0KGkpOwogICAgICAg\nICAgICAgICAgcG9wdWxhdGVTZWxlY3Qoc2VsLCAoQ2xhc3NNYXBwaW5nKSBz\nZWxNYXBwaW5ncy5nZXQoaSksCiAgICAgICAgICAgICAgICAgICAgc3ViY2xh\nc3NCaXRzLmdldChpKSwgKEpEQkNFeHByZXNzaW9uRmFjdG9yeSkgZmFjdHNb\naWR4XSwKICAgICAgICAgICAgICAgICAgICBleHBzW2lkeF0sIHN0YXRlc1tp\nZHhdLCBjdHgsIGZhbHNlLCBlYWdlciwgc3RhcnQsIGVuZCk7CiAgICAgICAg\nICAgICAgICBpZiAobmV4dEJpdHMuZ2V0KGkpKQogICAgICAgICAgICAgICAg\nICAgIGlkeCsrOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBT\ndHJpbmdbXSBzcWwgPSBuZXcgU3RyaW5nW3NlbHMuc2l6ZSgpXTsKICAgICAg\nICBmb3IgKGludCBpID0gMDsgaSA8IHNlbHMuc2l6ZSgpOyBpKyspCiAgICAg\nICAgICAgIHNxbFtpXSA9ICgoU2VsZWN0KSBzZWxzLmdldChpKSkudG9TZWxl\nY3QoZmFsc2UsIGZldGNoKS5nZXRTUUwodHJ1ZSk7CiAgICAgICAgcmV0dXJu\nIHNxbDsKICAgIH0KfQo=\n","encoding":"base64"}

