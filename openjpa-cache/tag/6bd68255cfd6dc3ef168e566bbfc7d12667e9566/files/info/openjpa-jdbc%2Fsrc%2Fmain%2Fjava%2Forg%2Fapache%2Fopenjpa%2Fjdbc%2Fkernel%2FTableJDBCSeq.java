{"sha":"1974aeea2e3d49899f099712baa9fa1559f43f01","node_id":"MDQ6QmxvYjIwNjM2NDoxOTc0YWVlYTJlM2Q0OTg5OWYwOTk3MTJiYWE5ZmExNTU5ZjQzZjAx","size":22592,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/1974aeea2e3d49899f099712baa9fa1559f43f01","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5rZXJuZWw7CgppbXBv\ncnQgamF2YS5pby5TZXJpYWxpemFibGU7CmltcG9ydCBqYXZhLnNxbC5Db25u\nZWN0aW9uOwppbXBvcnQgamF2YS5zcWwuUHJlcGFyZWRTdGF0ZW1lbnQ7Cmlt\ncG9ydCBqYXZhLnNxbC5SZXN1bHRTZXQ7CmltcG9ydCBqYXZhLnNxbC5TUUxF\neGNlcHRpb247CmltcG9ydCBqYXZhLnNxbC5UeXBlczsKCmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEuamRiYy5jb25mLkpEQkNDb25maWd1cmF0aW9uOwpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuY29uZi5KREJDQ29uZmln\ndXJhdGlvbkltcGw7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5t\nZXRhLkNsYXNzTWFwcGluZzsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5q\nZGJjLnNjaGVtYS5Db2x1bW47CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\namRiYy5zY2hlbWEuUHJpbWFyeUtleTsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5qZGJjLnNjaGVtYS5TY2hlbWE7CmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEuamRiYy5zY2hlbWEuU2NoZW1hR3JvdXA7CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEuamRiYy5zY2hlbWEuU2NoZW1hVG9vbDsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNjaGVtYS5TY2hlbWFzOwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1hLlRhYmxlOwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc3FsLkRCRGljdGlvbmFyeTsKaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNxbC5TUUxCdWZmZXI7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zcWwuU1FMRXhjZXB0aW9u\nczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIuY29uZi5Db25maWd1\ncmFibGU7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLmNvbmYuQ29u\nZmlndXJhdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIuY29u\nZi5Db25maWd1cmF0aW9uczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5s\naWIubG9nLkxvZzsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIudXRp\nbC5Mb2NhbGl6ZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0\naWwuT3B0aW9uczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRhLkph\ndmFUeXBlczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLkludmFs\naWRTdGF0ZUV4Y2VwdGlvbjsKaW1wb3J0IHNlcnAudXRpbC5OdW1iZXJzOwpp\nbXBvcnQgc2VycC51dGlsLlN0cmluZ3M7CgovLy8vLy8vLy8vLy8vLy8vLy8v\nLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KLy8g\nTk9URTogRG8gbm90IGNoYW5nZSBwcm9wZXJ0eSBuYW1lczsgc2VlIFNlcXVl\nbmNlTWV0YURhdGEKLy8gYW5kIFNlcXVlbmNlTWFwcGluZyBmb3Igc3RhbmRh\ncmQgcHJvcGVydHkgbmFtZXMuCi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v\nLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwoKLyoqCiAqIHtA\nbGluayBKREJDU2VxfSBpbXBsZW1lbnRhdGlvbiB0aGF0IHVzZXMgYSBkYXRh\nYmFzZSB0YWJsZQogKiBmb3Igc2VxdWVuY2UgbnVtYmVyIGdlbmVyYXRpb24u\nIFRoaXMgYmFzZSBpbXBsZW1lbnRhdGlvbiB1c2VzIGEgc2luZ2xlCiAqIHJv\ndyBmb3IgYSBnbG9iYWwgc2VxdWVuY2UgbnVtYmVyLgogKgogKiBAYXV0aG9y\nIEFiZSBXaGl0ZQogKi8KcHVibGljIGNsYXNzIFRhYmxlSkRCQ1NlcQogICAg\nZXh0ZW5kcyBBYnN0cmFjdEpEQkNTZXEKICAgIGltcGxlbWVudHMgQ29uZmln\ndXJhYmxlIHsKCiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIFN0cmluZyBBQ1RJ\nT05fRFJPUCA9ICJkcm9wIjsKICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgU3Ry\naW5nIEFDVElPTl9BREQgPSAiYWRkIjsKICAgIHB1YmxpYyBzdGF0aWMgZmlu\nYWwgU3RyaW5nIEFDVElPTl9HRVQgPSAiZ2V0IjsKICAgIHB1YmxpYyBzdGF0\naWMgZmluYWwgU3RyaW5nIEFDVElPTl9TRVQgPSAic2V0IjsKCiAgICBwcml2\nYXRlIHN0YXRpYyBmaW5hbCBMb2NhbGl6ZXIgX2xvYyA9IExvY2FsaXplci5m\nb3JQYWNrYWdlCiAgICAgICAgKFRhYmxlSkRCQ1NlcS5jbGFzcyk7CgogICAg\ncHJpdmF0ZSB0cmFuc2llbnQgSkRCQ0NvbmZpZ3VyYXRpb24gX2NvbmYgPSBu\ndWxsOwogICAgcHJpdmF0ZSB0cmFuc2llbnQgTG9nIF9sb2cgPSBudWxsOwog\nICAgcHJpdmF0ZSBpbnQgX2FsbG9jID0gNTA7CiAgICBwcml2YXRlIGludCBf\naW50VmFsdWUgPSAxOwogICAgcHJpdmF0ZSBmaW5hbCBTdGF0dXMgX3N0YXQg\nPSBuZXcgU3RhdHVzKCk7CgogICAgcHJpdmF0ZSBTdHJpbmcgX3RhYmxlID0g\nIk9QRU5KUEFfU0VRVUVOQ0VfVEFCTEUiOwogICAgcHJpdmF0ZSBTdHJpbmcg\nX3NlcUNvbHVtbk5hbWUgPSAiU0VRVUVOQ0VfVkFMVUUiOwogICAgcHJpdmF0\nZSBTdHJpbmcgX3BrQ29sdW1uTmFtZSA9ICJJRCI7CgogICAgcHJpdmF0ZSBD\nb2x1bW4gX3NlcUNvbHVtbiA9IG51bGw7CiAgICBwcml2YXRlIENvbHVtbiBf\ncGtDb2x1bW4gPSBudWxsOwoKICAgIC8qKgogICAgICogVGhlIHNlcXVlbmNl\nIHRhYmxlIG5hbWUuIERlZmF1bHRzIHRvIDxjb2RlPk9QRU5KUEFfU0VRVUVO\nQ0VfVEFCTEU8L2NvZGU+LgogICAgICogQnkgZGVmYXVsdCwgdGhlIHRhYmxl\nIHdpbGwgYmUgcGxhY2VkIGluIHRoZSBmaXJzdCBzY2hlbWEgbGlzdGVkIGlu\nIHlvdXIKICAgICAqIDxjb2RlPm9wZW5qcGEuamRiYy5TY2hlbWFzPC9jb2Rl\nPiBwcm9wZXJ0eSwgb3IgaW4gdGhlIGRlZmF1bHQgc2NoZW1hIGlmCiAgICAg\nKiB0aGUgcHJvcGVydHkgaXMgbm90IGdpdmVuLiBJZiB5b3Ugc3BlY2lmeSBh\nIHRhYmxlIG5hbWUgaW4gdGhlIGZvcm0KICAgICAqIDxjb2RlPiZsdDtzY2hl\nbWEmZ3Q7LiZsdDt0YWJsZSZndDs8L2NvZGU+LCB0aGVuIHRoZSBnaXZlbiBz\nY2hlbWEKICAgICAqIHdpbGwgYmUgdXNlZC4KICAgICAqLwogICAgcHVibGlj\nIFN0cmluZyBnZXRUYWJsZSgpIHsKICAgICAgICByZXR1cm4gX3RhYmxlOwog\nICAgfQoKICAgIC8qKgogICAgICogVGhlIHNlcXVlbmNlIHRhYmxlIG5hbWUu\nIERlZmF1bHRzIHRvIDxjb2RlPk9QRU5KUEFfU0VRVUVOQ0VfVEFCTEU8L2Nv\nZGU+LgogICAgICogQnkgZGVmYXVsdCwgdGhlIHRhYmxlIHdpbGwgYmUgcGxh\nY2VkIGluIHRoZSBmaXJzdCBzY2hlbWEgbGlzdGVkIGluIHlvdXIKICAgICAq\nIDxjb2RlPm9wZW5qcGEuamRiYy5TY2hlbWFzPC9jb2RlPiBwcm9wZXJ0eSwg\nb3IgaW4gdGhlIGRlZmF1bHQgc2NoZW1hIGlmCiAgICAgKiB0aGUgcHJvcGVy\ndHkgaXMgbm90IGdpdmVuLiBJZiB5b3Ugc3BlY2lmeSBhIHRhYmxlIG5hbWUg\naW4gdGhlIGZvcm0KICAgICAqIDxjb2RlPiZsdDtzY2hlbWEmZ3Q7LiZsdDt0\nYWJsZSZndDs8L2NvZGU+LCB0aGVuIHRoZSBnaXZlbiBzY2hlbWEKICAgICAq\nIHdpbGwgYmUgdXNlZC4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0VGFi\nbGUoU3RyaW5nIG5hbWUpIHsKICAgICAgICBfdGFibGUgPSBuYW1lOwogICAg\nfQoKICAgIC8qKgogICAgICogQGRlcHJlY2F0ZWQgVXNlIHtAbGluayAjc2V0\nVGFibGV9LiBSZXRhaW5lZCBmb3IKICAgICAqIGJhY2t3YXJkcy1jb21wYXRp\nYmlsaXR5CXdpdGggYXV0by1jb25maWd1cmF0aW9uLgogICAgICovCiAgICBw\ndWJsaWMgdm9pZCBzZXRUYWJsZU5hbWUoU3RyaW5nIG5hbWUpIHsKICAgICAg\nICBzZXRUYWJsZShuYW1lKTsKICAgIH0KCiAgICAvKioKICAgICAqIFRoZSBu\nYW1lIG9mIHRoZSBjb2x1bW4gdGhhdCBob2xkcyB0aGUgc2VxdWVuY2UgdmFs\ndWUuIERlZmF1bHRzCiAgICAgKiB0byA8Y29kZT5TRVFVRU5DRV9WQUxVRTwv\nY29kZT4uCiAgICAgKi8KICAgIHB1YmxpYyBTdHJpbmcgZ2V0U2VxdWVuY2VD\nb2x1bW4oKSB7CiAgICAgICAgcmV0dXJuIF9zZXFDb2x1bW5OYW1lOwogICAg\nfQoKICAgIC8qKgogICAgICogVGhlIG5hbWUgb2YgdGhlIGNvbHVtbiB0aGF0\nIGhvbGRzIHRoZSBzZXF1ZW5jZSB2YWx1ZS4gRGVmYXVsdHMKICAgICAqIHRv\nIDxjb2RlPlNFUVVFTkNFX1ZBTFVFPC9jb2RlPi4KICAgICAqLwogICAgcHVi\nbGljIHZvaWQgc2V0U2VxdWVuY2VDb2x1bW4oU3RyaW5nIHNlcXVlbmNlQ29s\ndW1uKSB7CiAgICAgICAgX3NlcUNvbHVtbk5hbWUgPSBzZXF1ZW5jZUNvbHVt\nbjsKICAgIH0KCiAgICAvKioKICAgICAqIFRoZSBuYW1lIG9mIHRoZSB0YWJs\nZSdzIHByaW1hcnkga2V5IGNvbHVtbi4gRGVmYXVsdHMgdG8KICAgICAqIDxj\nb2RlPklEPC9jb2RlPi4KICAgICAqLwogICAgcHVibGljIFN0cmluZyBnZXRQ\ncmltYXJ5S2V5Q29sdW1uKCkgewogICAgICAgIHJldHVybiBfcGtDb2x1bW5O\nYW1lOwogICAgfQoKICAgIC8qKgogICAgICogVGhlIG5hbWUgb2YgdGhlIHRh\nYmxlJ3MgcHJpbWFyeSBrZXkgY29sdW1uLiBEZWZhdWx0cyB0bwogICAgICog\nPGNvZGU+SUQ8L2NvZGU+LgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRQ\ncmltYXJ5S2V5Q29sdW1uKFN0cmluZyBwcmltYXJ5S2V5Q29sdW1uKSB7CiAg\nICAgICAgX3BrQ29sdW1uTmFtZSA9IHByaW1hcnlLZXlDb2x1bW47CiAgICB9\nCgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIG51bWJlciBvZiBzZXF1ZW5j\nZXMgdG8gYWxsb2NhdGUgZm9yIGVhY2ggdXBkYXRlIG9mIHRoZQogICAgICog\nc2VxdWVuY2UgdGFibGUuIFNlcXVlbmNlIG51bWJlcnMgd2lsbCBiZSBncmFi\nYmVkIGluIGJsb2NrcyBvZiB0aGlzCiAgICAgKiB2YWx1ZSB0byByZWR1Y2Ug\ndGhlIG51bWJlciBvZiB0cmFuc2FjdGlvbnMgdGhhdCBtdXN0IGJlIHBlcmZv\ncm1lZCBvbgogICAgICogdGhlIHNlcXVlbmNlIHRhYmxlLgogICAgICovCiAg\nICBwdWJsaWMgaW50IGdldEFsbG9jYXRlKCkgewogICAgICAgIHJldHVybiBf\nYWxsb2M7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIG51bWJl\nciBvZiBzZXF1ZW5jZXMgdG8gYWxsb2NhdGUgZm9yIGVhY2ggdXBkYXRlIG9m\nIHRoZQogICAgICogc2VxdWVuY2UgdGFibGUuIFNlcXVlbmNlIG51bWJlcnMg\nd2lsbCBiZSBncmFiYmVkIGluIGJsb2NrcyBvZiB0aGlzCiAgICAgKiB2YWx1\nZSB0byByZWR1Y2UgdGhlIG51bWJlciBvZiB0cmFuc2FjdGlvbnMgdGhhdCBt\ndXN0IGJlIHBlcmZvcm1lZCBvbgogICAgICogdGhlIHNlcXVlbmNlIHRhYmxl\nLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRBbGxvY2F0ZShpbnQgYWxs\nb2MpIHsKICAgICAgICBfYWxsb2MgPSBhbGxvYzsKICAgIH0KICAgIAogICAg\nLyoqCiAgICAgKiBSZXR1cm4gdGhlIG51bWJlciBhcyB0aGUgaW5pdGlhbCBu\ndW1iZXIgZm9yIHRoZSAKICAgICAqIEdlbmVyYXRlZFZhbHVlLlRBQkxFIHN0\ncmF0ZWd5IHRvIHN0YXJ0IHdpdGguIAogICAgICogQHJldHVybiBhbiBpbml0\naWFsIG51bWJlcgogICAgICovCiAgICBwdWJsaWMgaW50IGdldEluaXRpYWxW\nYWx1ZSgpIHsgICAgICAgIAogICAgICAgIHJldHVybiBfaW50VmFsdWU7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBTZXQgdGhlIGluaXRpYWwgbnVtYmVyIGlu\nIHRoZSB0YWJsZSBmb3IgdGhlIEdlbmVyYXRlZFZhbHVlLlRBQkxFCiAgICAg\nKiBzdHJhdGVneSB0byB1c2UgYXMgaW5pdGlhbCBudW1iZXIuIAogICAgICog\nQHBhcmFtIGludFZhbHVlLiBUaGUgaW5pdGlhbCBudW1iZXIKICAgICAqLwog\nICAgcHVibGljIHZvaWQgc2V0SW5pdGlhbFZhbHVlKGludCBpbnRWYWx1ZSkg\newogICAgICAgIF9pbnRWYWx1ZSA9IGludFZhbHVlOwogICAgfQoKICAgIC8q\nKgogICAgICogQGRlcHJlY2F0ZWQgVXNlIHtAbGluayAjc2V0QWxsb2NhdGV9\nLiBSZXRhaW5lZCBmb3IgYmFja3dhcmRzCiAgICAgKiBjb21wYXRpYmlsaXR5\nIG9mIGF1dG8tY29uZmlndXJhdGlvbi4KICAgICAqLwogICAgcHVibGljIHZv\naWQgc2V0SW5jcmVtZW50KGludCBpbmMpIHsKICAgICAgICBzZXRBbGxvY2F0\nZShpbmMpOwogICAgfQoKICAgIHB1YmxpYyBKREJDQ29uZmlndXJhdGlvbiBn\nZXRDb25maWd1cmF0aW9uKCkgewogICAgICAgIHJldHVybiBfY29uZjsKICAg\nIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRDb25maWd1cmF0aW9uKENvbmZpZ3Vy\nYXRpb24gY29uZikgewogICAgICAgIF9jb25mID0gKEpEQkNDb25maWd1cmF0\naW9uKSBjb25mOwogICAgICAgIF9sb2cgPSBfY29uZi5nZXRMb2coSkRCQ0Nv\nbmZpZ3VyYXRpb24uTE9HX1JVTlRJTUUpOwogICAgfQoKICAgIHB1YmxpYyB2\nb2lkIHN0YXJ0Q29uZmlndXJhdGlvbigpIHsKICAgIH0KCiAgICBwdWJsaWMg\ndm9pZCBlbmRDb25maWd1cmF0aW9uKCkgewogICAgICAgIGJ1aWxkVGFibGUo\nKTsKICAgIH0KICAgIAogICAgcHVibGljIHZvaWQgYWRkU2NoZW1hKENsYXNz\nTWFwcGluZyBtYXBwaW5nLCBTY2hlbWFHcm91cCBncm91cCkgewogICAgICAg\nIC8vIHRhYmxlIGFscmVhZHkgZXhpc3RzPwogICAgICAgIGlmIChncm91cC5p\nc0tub3duVGFibGUoX3RhYmxlKSkKICAgICAgICAgICAgcmV0dXJuOwoKICAg\nICAgICBTdHJpbmcgc2NoZW1hTmFtZSA9IFN0cmluZ3MuZ2V0UGFja2FnZU5h\nbWUoX3RhYmxlKTsKICAgICAgICBpZiAoc2NoZW1hTmFtZS5sZW5ndGgoKSA9\nPSAwKQogICAgICAgICAgICBzY2hlbWFOYW1lID0gU2NoZW1hcy5nZXROZXdU\nYWJsZVNjaGVtYShfY29uZik7CgogICAgICAgIC8vIGNyZWF0ZSB0YWJsZSBp\nbiB0aGlzIGdyb3VwCiAgICAgICAgU2NoZW1hIHNjaGVtYSA9IGdyb3VwLmdl\ndFNjaGVtYShzY2hlbWFOYW1lKTsKICAgICAgICBpZiAoc2NoZW1hID09IG51\nbGwpCiAgICAgICAgICAgIHNjaGVtYSA9IGdyb3VwLmFkZFNjaGVtYShzY2hl\nbWFOYW1lKTsKICAgICAgICBzY2hlbWEuaW1wb3J0VGFibGUoX3BrQ29sdW1u\nLmdldFRhYmxlKCkpOwogICAgfQoKICAgIHByb3RlY3RlZCBPYmplY3QgbmV4\ndEludGVybmFsKEpEQkNTdG9yZSBzdG9yZSwgQ2xhc3NNYXBwaW5nIG1hcHBp\nbmcpCiAgICAgICAgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgLy8gaWYg\nbmVlZGVkLCBncmFiIHRoZSBuZXh0IGhhbmRmdWwgb2YgaWRzCiAgICAgICAg\nU3RhdHVzIHN0YXQgPSBnZXRTdGF0dXMobWFwcGluZyk7CiAgICAgICAgaWYg\nKHN0YXQgPT0gbnVsbCkKICAgICAgICAgICAgdGhyb3cgbmV3IEludmFsaWRT\ndGF0ZUV4Y2VwdGlvbihfbG9jLmdldCgiYmFkLXNlcS10eXBlIiwKICAgICAg\nICAgICAgICAgIGdldENsYXNzKCksIG1hcHBpbmcpKTsKCiAgICAgICAgd2hp\nbGUgKHRydWUpIHsKICAgICAgICAgICAgc3luY2hyb25pemVkIChzdGF0KSB7\nCiAgICAgICAgICAgICAgICAvLyBtYWtlIHN1cmUgc2VxIGlzIGF0IGxlYXN0\nIDEsIHNpbmNlIGF1dG9hc3NpZ25lZCBpZHMgb2YgMCBjYW4KICAgICAgICAg\nICAgICAgIC8vIGNvbmZsaWN0IHdpdGggdW5pbml0aWFsaXplZCB2YWx1ZXMK\nICAgICAgICAgICAgICAgIHN0YXQuc2VxID0gTWF0aC5tYXgoc3RhdC5zZXEs\nIDEpOwogICAgICAgICAgICAgICAgaWYgKHN0YXQuc2VxIDwgc3RhdC5tYXgp\nCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIE51bWJlcnMudmFsdWVPZihz\ndGF0LnNlcSsrKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBhbGxvY2F0\nZVNlcXVlbmNlKHN0b3JlLCBtYXBwaW5nLCBzdGF0LCBfYWxsb2MsIHRydWUp\nOwogICAgICAgIH0KICAgIH0KCiAgICBwcm90ZWN0ZWQgT2JqZWN0IGN1cnJl\nbnRJbnRlcm5hbChKREJDU3RvcmUgc3RvcmUsIENsYXNzTWFwcGluZyBtYXBw\naW5nKQogICAgICAgIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIGlmIChj\ndXJyZW50ID09IG51bGwpIHsKICAgICAgICAgICAgQ29ubmVjdGlvbiBjb25u\nID0gZ2V0Q29ubmVjdGlvbihzdG9yZSk7CiAgICAgICAgICAgIHRyeSB7CiAg\nICAgICAgICAgICAgICBsb25nIGN1ciA9IGdldFNlcXVlbmNlKG1hcHBpbmcs\nIGNvbm4pOwogICAgICAgICAgICAgICAgaWYgKGN1ciAhPSAtMSkKICAgICAg\nICAgICAgICAgICAgICBjdXJyZW50ID0gTnVtYmVycy52YWx1ZU9mKGN1cik7\nCiAgICAgICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgICAgICBjbG9z\nZUNvbm5lY3Rpb24oY29ubik7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAg\nICAgICAgcmV0dXJuIHN1cGVyLmN1cnJlbnRJbnRlcm5hbChzdG9yZSwgbWFw\ncGluZyk7CiAgICB9CgogICAgcHJvdGVjdGVkIHZvaWQgYWxsb2NhdGVJbnRl\ncm5hbChpbnQgY291bnQsIEpEQkNTdG9yZSBzdG9yZSwKICAgICAgICBDbGFz\nc01hcHBpbmcgbWFwcGluZykKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9u\nIHsKICAgICAgICBTdGF0dXMgc3RhdCA9IGdldFN0YXR1cyhtYXBwaW5nKTsK\nICAgICAgICBpZiAoc3RhdCA9PSBudWxsKQogICAgICAgICAgICByZXR1cm47\nCgogICAgICAgIHdoaWxlICh0cnVlKSB7CiAgICAgICAgICAgIGludCBhdmFp\nbGFibGU7CiAgICAgICAgICAgIHN5bmNocm9uaXplZCAoc3RhdCkgewogICAg\nICAgICAgICAgICAgYXZhaWxhYmxlID0gKGludCkgKHN0YXQubWF4IC0gc3Rh\ndC5zZXEpOwogICAgICAgICAgICAgICAgaWYgKGF2YWlsYWJsZSA+PSBjb3Vu\ndCkKICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0K\nICAgICAgICAgICAgYWxsb2NhdGVTZXF1ZW5jZShzdG9yZSwgbWFwcGluZywg\nc3RhdCwgY291bnQgLSBhdmFpbGFibGUsIGZhbHNlKTsKICAgICAgICB9CiAg\nICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIGFwcHJvcHJpYXRlIHN0\nYXR1cyBvYmplY3QgZm9yIHRoZSBnaXZlbiBjbGFzcywgb3IgbnVsbAogICAg\nICogaWYgY2Fubm90IGhhbmRsZSB0aGUgZ2l2ZW4gY2xhc3MuIFRoZSBtYXBw\naW5nIG1heSBiZSBudWxsLgogICAgICovCiAgICBwcm90ZWN0ZWQgU3RhdHVz\nIGdldFN0YXR1cyhDbGFzc01hcHBpbmcgbWFwcGluZykgewogICAgICAgIHJl\ndHVybiBfc3RhdDsKICAgIH0KCiAgICAvKioKICAgICAqIEFkZCB0aGUgcHJp\nbWFyeSBrZXkgY29sdW1uIHRvIHRoZSBnaXZlbiB0YWJsZSBhbmQgcmV0dXJu\nIGl0LgogICAgICovCiAgICBwcm90ZWN0ZWQgQ29sdW1uIGFkZFByaW1hcnlL\nZXlDb2x1bW4oVGFibGUgdGFibGUpIHsKICAgICAgICBEQkRpY3Rpb25hcnkg\nZGljdCA9IF9jb25mLmdldERCRGljdGlvbmFyeUluc3RhbmNlKCk7CiAgICAg\nICAgQ29sdW1uIHBrQ29sdW1uID0gdGFibGUuYWRkQ29sdW1uKGRpY3QuZ2V0\nVmFsaWRDb2x1bW5OYW1lCiAgICAgICAgICAgIChnZXRQcmltYXJ5S2V5Q29s\ndW1uKCksIHRhYmxlKSk7CiAgICAgICAgcGtDb2x1bW4uc2V0VHlwZShkaWN0\nLmdldFByZWZlcnJlZFR5cGUoVHlwZXMuVElOWUlOVCkpOwogICAgICAgIHBr\nQ29sdW1uLnNldEphdmFUeXBlKEphdmFUeXBlcy5JTlQpOwogICAgICAgIHJl\ndHVybiBwa0NvbHVtbjsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0\naGUgcHJpbWFyeSBrZXkgdmFsdWUgZm9yIHRoZSBnaXZlbiBjbGFzcy4KICAg\nICAqLwogICAgcHJvdGVjdGVkIE9iamVjdCBnZXRQcmltYXJ5S2V5KENsYXNz\nTWFwcGluZyBtYXBwaW5nKSB7CiAgICAgICAgcmV0dXJuIE51bWJlcnMudmFs\ndWVPZigwKTsKICAgIH0KCiAgICAvKioKICAgICAqIENyZWF0ZXMgdGhlIG9i\namVjdC1sZXZlbCByZXByZXNlbnRhdGlvbiBvZiB0aGUgc2VxdWVuY2UgdGFi\nbGUuCiAgICAgKi8KICAgIHByaXZhdGUgdm9pZCBidWlsZFRhYmxlKCkgewog\nICAgICAgIFN0cmluZyB0YWJsZU5hbWUgPSBTdHJpbmdzLmdldENsYXNzTmFt\nZShfdGFibGUpOwogICAgICAgIFN0cmluZyBzY2hlbWFOYW1lID0gU3RyaW5n\ncy5nZXRQYWNrYWdlTmFtZShfdGFibGUpOwogICAgICAgIGlmIChzY2hlbWFO\nYW1lLmxlbmd0aCgpID09IDApCiAgICAgICAgICAgIHNjaGVtYU5hbWUgPSBT\nY2hlbWFzLmdldE5ld1RhYmxlU2NoZW1hKF9jb25mKTsKCiAgICAgICAgU2No\nZW1hR3JvdXAgZ3JvdXAgPSBuZXcgU2NoZW1hR3JvdXAoKTsKICAgICAgICBT\nY2hlbWEgc2NoZW1hID0gZ3JvdXAuYWRkU2NoZW1hKHNjaGVtYU5hbWUpOwoK\nICAgICAgICBUYWJsZSB0YWJsZSA9IHNjaGVtYS5hZGRUYWJsZSh0YWJsZU5h\nbWUpOwogICAgICAgIF9wa0NvbHVtbiA9IGFkZFByaW1hcnlLZXlDb2x1bW4o\ndGFibGUpOwogICAgICAgIFByaW1hcnlLZXkgcGsgPSB0YWJsZS5hZGRQcmlt\nYXJ5S2V5KCk7CiAgICAgICAgcGsuYWRkQ29sdW1uKF9wa0NvbHVtbik7Cgog\nICAgICAgIERCRGljdGlvbmFyeSBkaWN0ID0gX2NvbmYuZ2V0REJEaWN0aW9u\nYXJ5SW5zdGFuY2UoKTsKICAgICAgICBfc2VxQ29sdW1uID0gdGFibGUuYWRk\nQ29sdW1uKGRpY3QuZ2V0VmFsaWRDb2x1bW5OYW1lCiAgICAgICAgICAgIChf\nc2VxQ29sdW1uTmFtZSwgdGFibGUpKTsKICAgICAgICBfc2VxQ29sdW1uLnNl\ndFR5cGUoZGljdC5nZXRQcmVmZXJyZWRUeXBlKFR5cGVzLkJJR0lOVCkpOwog\nICAgICAgIF9zZXFDb2x1bW4uc2V0SmF2YVR5cGUoSmF2YVR5cGVzLkxPTkcp\nOwogICAgfQoKICAgIC8qKgogICAgICogVXBkYXRlcyB0aGUgbWF4IGF2YWls\nYWJsZSBzZXF1ZW5jZSB2YWx1ZS4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lk\nIGFsbG9jYXRlU2VxdWVuY2UoSkRCQ1N0b3JlIHN0b3JlLCBDbGFzc01hcHBp\nbmcgbWFwcGluZywKICAgICAgICBTdGF0dXMgc3RhdCwgaW50IGFsbG9jLCBi\nb29sZWFuIHVwZGF0ZVN0YXRTZXEpIAogICAgICAgIHRocm93cyBTUUxFeGNl\ncHRpb24gewogICAgICAgIENvbm5lY3Rpb24gY29ubiA9IGdldENvbm5lY3Rp\nb24oc3RvcmUpOwogICAgICAgIHRyeSB7IAogICAgICAgICAgICBpZiAoc2V0\nU2VxdWVuY2UobWFwcGluZywgc3RhdCwgYWxsb2MsIHVwZGF0ZVN0YXRTZXEs\nIGNvbm4pKQogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0gY2F0\nY2ggKFNRTEV4Y2VwdGlvbiBzZSkgewogICAgICAgICAgICB0aHJvdyBTUUxF\neGNlcHRpb25zLmdldFN0b3JlKF9sb2MuZ2V0KCJiYWQtc2VxLXVwIiwgX3Rh\nYmxlKSwKICAgICAgICAgICAgICAgIHNlLCBfY29uZi5nZXREQkRpY3Rpb25h\ncnlJbnN0YW5jZSgpKTsKICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAg\nICBjbG9zZUNvbm5lY3Rpb24oY29ubik7CiAgICAgICAgfQogICAgICAgIAog\nICAgICAgIHRyeSB7CiAgICAgICAgICAgIC8vIHBvc3NpYmxlIHRoYXQgd2Ug\nbWlnaHQgZ2V0IGVycm9ycyB3aGVuIGluc2VydGluZyBpZgogICAgICAgICAg\nICAvLyBhbm90aGVyIHRocmVhZC9wcm9jZXNzIGlzIGluc2VydGluZyBzYW1l\nIHBrIGF0IHNhbWUgdGltZQogICAgICAgICAgICBTUUxFeGNlcHRpb24gZXJy\nID0gbnVsbDsgCiAgICAgICAgICAgIC8vICMjIyB3aHkgZG9lcyB0aGlzIG5v\ndCBjYWxsIGdldENvbm5lY3Rpb24oKSAvIGNsb3NlQ29ubmVjdGlvbigpPwog\nICAgICAgICAgICBjb25uID0gX2NvbmYuZ2V0RGF0YVNvdXJjZTIoc3RvcmUu\nZ2V0Q29udGV4dCgpKS5nZXRDb25uZWN0aW9uKCk7CiAgICAgICAgICAgIHRy\neSB7CiAgICAgICAgICAgICAgICBpbnNlcnRTZXF1ZW5jZShtYXBwaW5nLCBj\nb25uKTsKICAgICAgICAgICAgfSBjYXRjaCAoU1FMRXhjZXB0aW9uIHNlKSB7\nCiAgICAgICAgICAgICAgICBlcnIgPSBzZTsKICAgICAgICAgICAgfSBmaW5h\nbGx5IHsKICAgICAgICAgICAgICAgIHRyeSB7IGNvbm4uY2xvc2UoKTsgfSBj\nYXRjaCAoU1FMRXhjZXB0aW9uIHNlKSB7fQogICAgICAgICAgICB9CgogICAg\nICAgICAgICAvLyBub3cgd2Ugc2hvdWxkIGJlIGFibGUgdG8gdXBkYXRlLi4u\nCiAgICAgICAgICAgIGNvbm4gPSBnZXRDb25uZWN0aW9uKHN0b3JlKTsKICAg\nICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIGlmICghc2V0U2VxdWVu\nY2UobWFwcGluZywgc3RhdCwgYWxsb2MsIHVwZGF0ZVN0YXRTZXEsIGNvbm4p\nKQogICAgICAgICAgICAgICAgICAgIHRocm93IChlcnIgIT0gbnVsbCkgPyBl\ncnIgOiBuZXcgU1FMRXhjZXB0aW9uKF9sb2MuZ2V0CiAgICAgICAgICAgICAg\nICAgICAgICAgICgibm8tc2VxLXJvdyIsIG1hcHBpbmcsIF90YWJsZSkuZ2V0\nTWVzc2FnZSgpKTsKICAgICAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAg\nICAgICAgIGNsb3NlQ29ubmVjdGlvbihjb25uKTsKICAgICAgICAgICAgfQog\nICAgICAgIH0gY2F0Y2ggKFNRTEV4Y2VwdGlvbiBzZTIpIHsKICAgICAgICAg\nICAgdGhyb3cgU1FMRXhjZXB0aW9ucy5nZXRTdG9yZShfbG9jLmdldCgiYmFk\nLXNlcS11cCIsIF90YWJsZSksCiAgICAgICAgICAgICAgICBzZTIsIF9jb25m\nLmdldERCRGljdGlvbmFyeUluc3RhbmNlKCkpOwogICAgICAgIH0gCiAgICB9\nCgogICAgLyoqCiAgICAgKiBJbnNlcnRzIHRoZSBpbml0aWFsIHNlcXVlbmNl\nIGluZm9ybWF0aW9uIGludG8gdGhlIGRhdGFiYXNlLCBpZiBhbnkuCiAgICAg\nKi8KICAgIHByaXZhdGUgdm9pZCBpbnNlcnRTZXF1ZW5jZShDbGFzc01hcHBp\nbmcgbWFwcGluZywgQ29ubmVjdGlvbiBjb25uKQogICAgICAgIHRocm93cyBT\nUUxFeGNlcHRpb24gewogICAgICAgIGlmIChfbG9nLmlzVHJhY2VFbmFibGVk\nKCkpCiAgICAgICAgICAgIF9sb2cudHJhY2UoX2xvYy5nZXQoImluc2VydC1z\nZXEiKSk7CgogICAgICAgIE9iamVjdCBwayA9IGdldFByaW1hcnlLZXkobWFw\ncGluZyk7CiAgICAgICAgaWYgKHBrID09IG51bGwpCiAgICAgICAgICAgIHRo\ncm93IG5ldyBJbnZhbGlkU3RhdGVFeGNlcHRpb24oX2xvYy5nZXQoImJhZC1z\nZXEtdHlwZSIsCiAgICAgICAgICAgICAgICBnZXRDbGFzcygpLCBtYXBwaW5n\nKSk7CgogICAgICAgIERCRGljdGlvbmFyeSBkaWN0ID0gX2NvbmYuZ2V0REJE\naWN0aW9uYXJ5SW5zdGFuY2UoKTsKICAgICAgICBTUUxCdWZmZXIgaW5zZXJ0\nID0gbmV3IFNRTEJ1ZmZlcihkaWN0KS5hcHBlbmQoIklOU0VSVCBJTlRPICIp\nLgogICAgICAgICAgICBhcHBlbmQoX3BrQ29sdW1uLmdldFRhYmxlKCkpLmFw\ncGVuZCgiICgiKS4KICAgICAgICAgICAgYXBwZW5kKF9wa0NvbHVtbikuYXBw\nZW5kKCIsICIpLmFwcGVuZChfc2VxQ29sdW1uKS4KICAgICAgICAgICAgYXBw\nZW5kKCIpIFZBTFVFUyAoIikuCiAgICAgICAgICAgIGFwcGVuZFZhbHVlKHBr\nLCBfcGtDb2x1bW4pLmFwcGVuZCgiLCAiKS4KICAgICAgICAgICAgYXBwZW5k\nVmFsdWUoX2ludFZhbHVlLCBfc2VxQ29sdW1uKS5hcHBlbmQoIikiKTsKICAg\nICAgICAKICAgICAgICBib29sZWFuIHdhc0F1dG8gPSBjb25uLmdldEF1dG9D\nb21taXQoKTsKICAgICAgICBpZiAoIXdhc0F1dG8gJiYgIXN1c3BlbmRJbkpU\nQSgpKQogICAgICAgICAgICBjb25uLnNldEF1dG9Db21taXQodHJ1ZSk7Cgog\nICAgICAgIFByZXBhcmVkU3RhdGVtZW50IHN0bW50ID0gbnVsbDsKICAgICAg\nICB0cnkgewogICAgICAgICAgICBzdG1udCA9IGluc2VydC5wcmVwYXJlU3Rh\ndGVtZW50KGNvbm4pOwogICAgICAgICAgICBzdG1udC5leGVjdXRlVXBkYXRl\nKCk7CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgaWYgKHN0bW50\nICE9IG51bGwpCiAgICAgICAgICAgICAgICB0cnkgeyBzdG1udC5jbG9zZSgp\nOyB9IGNhdGNoIChTUUxFeGNlcHRpb24gc2UpIHt9CiAgICAgICAgICAgIGlm\nICghd2FzQXV0byAmJiAhc3VzcGVuZEluSlRBKCkpCiAgICAgICAgICAgICAg\nICBjb25uLnNldEF1dG9Db21taXQoZmFsc2UpOwogICAgICAgIH0KICAgIH0K\nCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgY3VycmVudCBzZXF1ZW5jZSB2\nYWx1ZSwgb3IgLTEgaWYgdW5hdHRhaW5hYmxlLgogICAgICovCiAgICBwcm90\nZWN0ZWQgbG9uZyBnZXRTZXF1ZW5jZShDbGFzc01hcHBpbmcgbWFwcGluZywg\nQ29ubmVjdGlvbiBjb25uKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24g\newogICAgICAgIGlmIChfbG9nLmlzVHJhY2VFbmFibGVkKCkpCiAgICAgICAg\nICAgIF9sb2cudHJhY2UoX2xvYy5nZXQoImdldC1zZXEiKSk7CgogICAgICAg\nIE9iamVjdCBwayA9IGdldFByaW1hcnlLZXkobWFwcGluZyk7CiAgICAgICAg\naWYgKHBrID09IG51bGwpCiAgICAgICAgICAgIHJldHVybiAtMTsKCiAgICAg\nICAgREJEaWN0aW9uYXJ5IGRpY3QgPSBfY29uZi5nZXREQkRpY3Rpb25hcnlJ\nbnN0YW5jZSgpOwogICAgICAgIFNRTEJ1ZmZlciBzZWwgPSBuZXcgU1FMQnVm\nZmVyKGRpY3QpLmFwcGVuZChfc2VxQ29sdW1uKTsKICAgICAgICBTUUxCdWZm\nZXIgd2hlcmUgPSBuZXcgU1FMQnVmZmVyKGRpY3QpLmFwcGVuZChfcGtDb2x1\nbW4pLmFwcGVuZCgiID0gIikuCiAgICAgICAgICAgIGFwcGVuZFZhbHVlKHBr\nLCBfcGtDb2x1bW4pOwogICAgICAgIFNRTEJ1ZmZlciB0YWJsZXMgPSBuZXcg\nU1FMQnVmZmVyKGRpY3QpLmFwcGVuZChfc2VxQ29sdW1uLmdldFRhYmxlKCkp\nOwoKICAgICAgICBTUUxCdWZmZXIgc2VsZWN0ID0gZGljdC50b1NlbGVjdChz\nZWwsIG51bGwsIHRhYmxlcywgd2hlcmUsIG51bGwsCiAgICAgICAgICAgIG51\nbGwsIG51bGwsIGZhbHNlLCBkaWN0LnN1cHBvcnRzU2VsZWN0Rm9yVXBkYXRl\nLCAwLCBMb25nLk1BWF9WQUxVRSk7CgogICAgICAgIFByZXBhcmVkU3RhdGVt\nZW50IHN0bW50ID0gc2VsZWN0LnByZXBhcmVTdGF0ZW1lbnQoY29ubik7CiAg\nICAgICAgUmVzdWx0U2V0IHJzID0gbnVsbDsKICAgICAgICB0cnkgewogICAg\nICAgICAgICBycyA9IHN0bW50LmV4ZWN1dGVRdWVyeSgpOwogICAgICAgICAg\nICBpZiAoIXJzLm5leHQoKSkKICAgICAgICAgICAgICAgIHJldHVybiAtMTsK\nICAgICAgICAgICAgcmV0dXJuIGRpY3QuZ2V0TG9uZyhycywgMSk7CiAgICAg\nICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgaWYgKHJzICE9IG51bGwpCiAg\nICAgICAgICAgICAgICB0cnkgeyBycy5jbG9zZSgpOyB9IGNhdGNoIChTUUxF\neGNlcHRpb24gc2UpIHt9CiAgICAgICAgICAgIHRyeSB7IHN0bW50LmNsb3Nl\nKCk7IH0gY2F0Y2ggKFNRTEV4Y2VwdGlvbiBzZSkge30KICAgICAgICB9CiAg\nICB9CgogICAgLyoqCiAgICAgKiBHcmFicyB0aGUgbmV4dCBoYW5kZnVsIG9m\nIHNlcXVlbmNlIG51bWJlcnMuCiAgICAgKgogICAgICogQHJldHVybiB0cnVl\nIGlmIHRoZSBzZXF1ZW5jZSB3YXMgdXBkYXRlZCwgZmFsc2UgaWYgbm8gc2Vx\ndWVuY2UKICAgICAqIHJvdyBleGlzdGVkIGZvciB0aGlzIG1hcHBpbmcKICAg\nICAqLwogICAgcHJvdGVjdGVkIGJvb2xlYW4gc2V0U2VxdWVuY2UoQ2xhc3NN\nYXBwaW5nIG1hcHBpbmcsIFN0YXR1cyBzdGF0LCBpbnQgaW5jLAogICAgICAg\nIGJvb2xlYW4gdXBkYXRlU3RhdFNlcSwgQ29ubmVjdGlvbiBjb25uKQogICAg\nICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIGlmIChfbG9nLmlz\nVHJhY2VFbmFibGVkKCkpCiAgICAgICAgICAgIF9sb2cudHJhY2UoX2xvYy5n\nZXQoInVwZGF0ZS1zZXEiKSk7CgogICAgICAgIE9iamVjdCBwayA9IGdldFBy\naW1hcnlLZXkobWFwcGluZyk7CiAgICAgICAgaWYgKHBrID09IG51bGwpCiAg\nICAgICAgICAgIHRocm93IG5ldyBJbnZhbGlkU3RhdGVFeGNlcHRpb24oX2xv\nYy5nZXQoImJhZC1zZXEtdHlwZSIsCiAgICAgICAgICAgICAgICBnZXRDbGFz\ncygpLCBtYXBwaW5nKSk7CgogICAgICAgIERCRGljdGlvbmFyeSBkaWN0ID0g\nX2NvbmYuZ2V0REJEaWN0aW9uYXJ5SW5zdGFuY2UoKTsKICAgICAgICBTUUxC\ndWZmZXIgd2hlcmUgPSBuZXcgU1FMQnVmZmVyKGRpY3QpLmFwcGVuZChfcGtD\nb2x1bW4pLmFwcGVuZCgiID0gIikuCiAgICAgICAgICAgIGFwcGVuZFZhbHVl\nKHBrLCBfcGtDb2x1bW4pOwoKICAgICAgICAvLyBsb29wIHVudGlsIHdlIGhh\ndmUgYSBzdWNjZXNzZnVsIGF0b21pYyBzZWxlY3QvdXBkYXRlIHNlcXVlbmNl\nCiAgICAgICAgbG9uZyBjdXIgPSAwOwogICAgICAgIFByZXBhcmVkU3RhdGVt\nZW50IHN0bW50OwogICAgICAgIFJlc3VsdFNldCByczsKICAgICAgICBTUUxC\ndWZmZXIgdXBkOwogICAgICAgIGZvciAoaW50IHVwZGF0ZXMgPSAwOyB1cGRh\ndGVzID09IDA7KSB7CiAgICAgICAgICAgIHN0bW50ID0gbnVsbDsKICAgICAg\nICAgICAgcnMgPSBudWxsOwogICAgICAgICAgICB0cnkgewogICAgICAgICAg\nICAgICAgY3VyID0gZ2V0U2VxdWVuY2UobWFwcGluZywgY29ubik7CiAgICAg\nICAgICAgICAgICBpZiAoY3VyID09IC0xKQogICAgICAgICAgICAgICAgICAg\nIHJldHVybiBmYWxzZTsKCiAgICAgICAgICAgICAgICAvLyB1cGRhdGUgdGhl\nIHZhbHVlCiAgICAgICAgICAgICAgICB1cGQgPSBuZXcgU1FMQnVmZmVyKGRp\nY3QpOwogICAgICAgICAgICAgICAgdXBkLmFwcGVuZCgiVVBEQVRFICIpLmFw\ncGVuZChfc2VxQ29sdW1uLmdldFRhYmxlKCkpLgogICAgICAgICAgICAgICAg\nICAgIGFwcGVuZCgiIFNFVCAiKS5hcHBlbmQoX3NlcUNvbHVtbikuYXBwZW5k\nKCIgPSAiKS4KICAgICAgICAgICAgICAgICAgICBhcHBlbmRWYWx1ZShOdW1i\nZXJzLnZhbHVlT2YoY3VyICsgaW5jKSwgX3NlcUNvbHVtbikuCiAgICAgICAg\nICAgICAgICAgICAgYXBwZW5kKCIgV0hFUkUgIikuYXBwZW5kKHdoZXJlKS5h\ncHBlbmQoIiBBTkQgIikuCiAgICAgICAgICAgICAgICAgICAgYXBwZW5kKF9z\nZXFDb2x1bW4pLmFwcGVuZCgiID0gIikuCiAgICAgICAgICAgICAgICAgICAg\nYXBwZW5kVmFsdWUoTnVtYmVycy52YWx1ZU9mKGN1ciksIF9zZXFDb2x1bW4p\nOwoKICAgICAgICAgICAgICAgIHN0bW50ID0gdXBkLnByZXBhcmVTdGF0ZW1l\nbnQoY29ubik7CiAgICAgICAgICAgICAgICB1cGRhdGVzID0gc3RtbnQuZXhl\nY3V0ZVVwZGF0ZSgpOwogICAgICAgICAgICB9IGZpbmFsbHkgewogICAgICAg\nICAgICAgICAgaWYgKHJzICE9IG51bGwpIAogICAgICAgICAgICAgICAgICAg\nIHRyeSB7IHJzLmNsb3NlKCk7IH0gY2F0Y2ggKFNRTEV4Y2VwdGlvbiBzZSkg\ne30KICAgICAgICAgICAgICAgIGlmIChzdG1udCAhPSBudWxsKQogICAgICAg\nICAgICAgICAgICAgIHRyeSB7IHN0bW50LmNsb3NlKCk7IH0gY2F0Y2ggKFNR\nTEV4Y2VwdGlvbiBzZSkge30KICAgICAgICAgICAgfQogICAgICAgIH0KCiAg\nICAgICAgLy8gc2V0dXAgbmV3IHNlcXVlbmNlIHJhbmdlCiAgICAgICAgc3lu\nY2hyb25pemVkIChzdGF0KSB7CiAgICAgICAgICAgIGlmICh1cGRhdGVTdGF0\nU2VxICYmIHN0YXQuc2VxIDwgY3VyKQogICAgICAgICAgICAgICAgc3RhdC5z\nZXEgPSBjdXI7CiAgICAgICAgICAgIGlmIChzdGF0Lm1heCA8IGN1ciArIGlu\nYykKICAgICAgICAgICAgICAgIHN0YXQubWF4ID0gY3VyICsgaW5jOwogICAg\nICAgIH0KICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvKioKICAg\nICAqIENyZWF0ZXMgdGhlIHNlcXVlbmNlIHRhYmxlIGluIHRoZSBEQi4KICAg\nICAqLwogICAgcHVibGljIHZvaWQgcmVmcmVzaFRhYmxlKCkKICAgICAgICB0\naHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBpZiAoX2xvZy5pc0luZm9F\nbmFibGVkKCkpCiAgICAgICAgICAgIF9sb2cuaW5mbyhfbG9jLmdldCgibWFr\nZS1zZXEtdGFibGUiKSk7CgogICAgICAgIC8vIGNyZWF0ZSB0aGUgdGFibGUK\nICAgICAgICBTY2hlbWFUb29sIHRvb2wgPSBuZXcgU2NoZW1hVG9vbChfY29u\nZik7CiAgICAgICAgdG9vbC5zZXRJZ25vcmVFcnJvcnModHJ1ZSk7CiAgICAg\nICAgdG9vbC5jcmVhdGVUYWJsZShfcGtDb2x1bW4uZ2V0VGFibGUoKSk7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBEcm9wcyB0aGUgc2VxdWVuY2UgdGFibGUg\naW4gdGhlIERCLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBkcm9wVGFibGUo\nKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIGlmIChf\nbG9nLmlzSW5mb0VuYWJsZWQoKSkKICAgICAgICAgICAgX2xvZy5pbmZvKF9s\nb2MuZ2V0KCJkcm9wLXNlcS10YWJsZSIpKTsKCiAgICAgICAgLy8gZHJvcCB0\naGUgdGFibGUKICAgICAgICBTY2hlbWFUb29sIHRvb2wgPSBuZXcgU2NoZW1h\nVG9vbChfY29uZik7CiAgICAgICAgdG9vbC5zZXRJZ25vcmVFcnJvcnModHJ1\nZSk7CiAgICAgICAgdG9vbC5kcm9wVGFibGUoX3BrQ29sdW1uLmdldFRhYmxl\nKCkpOwogICAgfQoKICAgIC8vLy8vLy8vLwogICAgLy8gTWFpbgogICAgLy8v\nLy8vLy8vCgogICAgLyoqCiAgICAgKiBVc2FnZTogamF2YSBvcmcuYXBhY2hl\nLm9wZW5qcGEuamRiYy5zY2hlbWEuVGFibGVKREJDU2VxdWVuY2UgW29wdGlv\nbl0qCiAgICAgKiAtYWN0aW9uLy1hICZsdDthZGQgfCBkcm9wIHwgZ2V0IHwg\nc2V0Jmd0OyBbdmFsdWVdCiAgICAgKiAgV2hlcmUgdGhlIGZvbGxvd2luZyBv\ncHRpb25zIGFyZSByZWNvZ25pemVkLgogICAgICogPHVsPgogICAgICogPGxp\nPjxpPi1wcm9wZXJ0aWVzLy1wICZsdDtwcm9wZXJ0aWVzIGZpbGUgb3IgcmVz\nb3VyY2UmZ3Q7PC9pPjogVGhlCiAgICAgKiBwYXRoIG9yIHJlc291cmNlIG5h\nbWUgb2YgYSBPcGVuSlBBIHByb3BlcnRpZXMgZmlsZSBjb250YWluaW5nCiAg\nICAgKiBpbmZvcm1hdGlvbiBzdWNoIGFzIHRoZSBsaWNlbnNlIGtleQlhbmQg\nY29ubmVjdGlvbiBkYXRhIGFzCiAgICAgKiBvdXRsaW5lZCBpbiB7QGxpbmsg\nSkRCQ0NvbmZpZ3VyYXRpb259LiBPcHRpb25hbC48L2xpPgogICAgICogPGxp\nPjxpPi0mbHQ7cHJvcGVydHkgbmFtZSZndDsgJmx0O3Byb3BlcnR5IHZhbHVl\nJmd0OzwvaT46IEFsbCBiZWFuCiAgICAgKiBwcm9wZXJ0aWVzIG9mIHRoZSBP\ncGVuSlBBIHtAbGluayBKREJDQ29uZmlndXJhdGlvbn0gY2FuIGJlIHNldCBi\neQogICAgICogdXNpbmcgdGhlaXIJbmFtZXMgYW5kIHN1cHBseWluZyBhIHZh\nbHVlLiBGb3IgZXhhbXBsZToKICAgICAqIDxjb2RlPi1saWNlbnNlS2V5IGFk\nc2xmamE4M3IzbGthZGY8L2NvZGU+PC9saT4KICAgICAqIDwvdWw+CiAgICAg\nKiAgVGhlIHZhcmlvdXMgYWN0aW9ucyBhcmUgYXMgZm9sbG93cy4KICAgICAq\nIDx1bD4KICAgICAqIDxsaT48aT5hZGQ8L2k+OiBDcmVhdGUgdGhlIHNlcXVl\nbmNlIHRhYmxlLjwvbGk+CiAgICAgKiA8bGk+PGk+ZHJvcDwvaT46IERyb3Ag\ndGhlIHNlcXVlbmNlIHRhYmxlLjwvbGk+CiAgICAgKiA8bGk+PGk+Z2V0PC9p\nPjogUHJpbnQgdGhlIGN1cnJlbnQgc2VxdWVuY2UgdmFsdWUuPC9saT4KICAg\nICAqIDxsaT48aT5zZXQ8L2k+OiBTZXQgdGhlIHNlcXVlbmNlIHZhbHVlLjwv\nbGk+CiAgICAgKiA8L3VsPgogICAgICovCiAgICBwdWJsaWMgc3RhdGljIHZv\naWQgbWFpbihTdHJpbmdbXSBhcmdzKQogICAgICAgIHRocm93cyBFeGNlcHRp\nb24gewogICAgICAgIE9wdGlvbnMgb3B0cyA9IG5ldyBPcHRpb25zKCk7CiAg\nICAgICAgYXJncyA9IG9wdHMuc2V0RnJvbUNtZExpbmUoYXJncyk7CiAgICAg\nICAgSkRCQ0NvbmZpZ3VyYXRpb24gY29uZiA9IG5ldyBKREJDQ29uZmlndXJh\ndGlvbkltcGwoKTsKICAgICAgICB0cnkgewogICAgICAgICAgICBpZiAoIXJ1\nbihjb25mLCBhcmdzLCBvcHRzKSkKICAgICAgICAgICAgICAgIFN5c3RlbS5v\ndXQucHJpbnRsbihfbG9jLmdldCgic2VxLXVzYWdlIikpOwogICAgICAgIH0g\nZmluYWxseSB7CiAgICAgICAgICAgIGNvbmYuY2xvc2UoKTsKICAgICAgICB9\nCiAgICB9CgogICAgLyoqCiAgICAgKiBSdW4gdGhlIHRvb2wuIFJldHVybnMg\nZmFsc2UgaWYgaW52YWxpZCBvcHRpb25zIHdlcmUgZ2l2ZW4uCiAgICAgKi8K\nICAgIHB1YmxpYyBzdGF0aWMgYm9vbGVhbiBydW4oSkRCQ0NvbmZpZ3VyYXRp\nb24gY29uZiwgU3RyaW5nW10gYXJncywKICAgICAgICBPcHRpb25zIG9wdHMp\nCiAgICAgICAgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgaWYgKG9wdHMu\nY29udGFpbnNLZXkoImhlbHAiKSB8fCBvcHRzLmNvbnRhaW5zS2V5KCItaGVs\ncCIpKQogICAgICAgICAgICByZXR1cm4gZmFsc2U7CgogICAgICAgIFN0cmlu\nZyBhY3Rpb24gPSBvcHRzLnJlbW92ZVByb3BlcnR5KCJhY3Rpb24iLCAiYSIs\nIG51bGwpOwogICAgICAgIENvbmZpZ3VyYXRpb25zLnBvcHVsYXRlQ29uZmln\ndXJhdGlvbihjb25mLCBvcHRzKTsKICAgICAgICByZXR1cm4gcnVuKGNvbmYs\nIGFyZ3MsIGFjdGlvbik7CiAgICB9CgogICAgLyoqCiAgICAgKiBSdW4gdGhl\nIHRvb2wuIFJldHVybiBmYWxzZSBpZiBhbiBpbnZhbGlkIG9wdGlvbiB3YXMg\nZ2l2ZW4uCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0aWMgYm9vbGVhbiBydW4o\nSkRCQ0NvbmZpZ3VyYXRpb24gY29uZiwgU3RyaW5nW10gYXJncywKICAgICAg\nICBTdHJpbmcgYWN0aW9uKQogICAgICAgIHRocm93cyBFeGNlcHRpb24gewog\nICAgICAgIGlmIChhcmdzLmxlbmd0aCA+IDEgfHwgKGFyZ3MubGVuZ3RoICE9\nIDAKICAgICAgICAgICAgJiYgIUFDVElPTl9TRVQuZXF1YWxzKGFjdGlvbikp\nKQogICAgICAgICAgICByZXR1cm4gZmFsc2U7CgogICAgICAgIFRhYmxlSkRC\nQ1NlcSBzZXEgPSBuZXcgVGFibGVKREJDU2VxKCk7CiAgICAgICAgU3RyaW5n\nIHByb3BzID0gQ29uZmlndXJhdGlvbnMuZ2V0UHJvcGVydGllcyhjb25mLmdl\ndFNlcXVlbmNlKCkpOwogICAgICAgIENvbmZpZ3VyYXRpb25zLmNvbmZpZ3Vy\nZUluc3RhbmNlKHNlcSwgY29uZiwgcHJvcHMpOwoKICAgICAgICBpZiAoQUNU\nSU9OX0RST1AuZXF1YWxzKGFjdGlvbikpCiAgICAgICAgICAgIHNlcS5kcm9w\nVGFibGUoKTsKICAgICAgICBlbHNlIGlmIChBQ1RJT05fQURELmVxdWFscyhh\nY3Rpb24pKQogICAgICAgICAgICBzZXEucmVmcmVzaFRhYmxlKCk7CiAgICAg\nICAgZWxzZSBpZiAoQUNUSU9OX0dFVC5lcXVhbHMoYWN0aW9uKSB8fCBBQ1RJ\nT05fU0VULmVxdWFscyhhY3Rpb24pKSB7CiAgICAgICAgICAgIENvbm5lY3Rp\nb24gY29ubiA9IGNvbmYuZ2V0RGF0YVNvdXJjZTIobnVsbCkuZ2V0Q29ubmVj\ndGlvbigpOwogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgbG9u\nZyBjdXIgPSBzZXEuZ2V0U2VxdWVuY2UobnVsbCwgY29ubik7CiAgICAgICAg\nICAgICAgICBpZiAoQUNUSU9OX0dFVC5lcXVhbHMoYWN0aW9uKSkKICAgICAg\nICAgICAgICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oY3VyKTsKICAgICAg\nICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgIGxvbmcgc2V0\nOwogICAgICAgICAgICAgICAgICAgIGlmIChhcmdzLmxlbmd0aCA+IDApCiAg\nICAgICAgICAgICAgICAgICAgICAgIHNldCA9IExvbmcucGFyc2VMb25nKGFy\nZ3NbMF0pOwogICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAg\nICAgICAgICAgICAgc2V0ID0gY3VyICsgc2VxLmdldEFsbG9jYXRlKCk7CiAg\nICAgICAgICAgICAgICAgICAgaWYgKHNldCA8IGN1cikKICAgICAgICAgICAg\nICAgICAgICAgICAgc2V0ID0gY3VyOwogICAgICAgICAgICAgICAgICAgIGVs\nc2UgewogICAgICAgICAgICAgICAgICAgICAgICBTdGF0dXMgc3RhdCA9IHNl\ncS5nZXRTdGF0dXMobnVsbCk7CiAgICAgICAgICAgICAgICAgICAgICAgIHNl\ncS5zZXRTZXF1ZW5jZShudWxsLCBzdGF0LCAoaW50KSAoc2V0IC0gY3VyKSwg\ndHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbm4pOwogICAg\nICAgICAgICAgICAgICAgICAgICBzZXQgPSBzdGF0LnNlcTsKICAgICAgICAg\nICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgU3lzdGVtLmVyci5w\ncmludGxuKHNldCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0K\nICAgICAgICAgICAgY2F0Y2ggKE51bWJlckZvcm1hdEV4Y2VwdGlvbiBuZmUp\nIHsKICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAg\nfSBmaW5hbGx5IHsKICAgICAgICAgICAgICAgIHRyeSB7IGNvbm4uY2xvc2Uo\nKTsgfSBjYXRjaCAoU1FMRXhjZXB0aW9uIHNlKSB7fQogICAgICAgICAgICB9\nCiAgICAgICAgfSBlbHNlCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAg\nICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvKioKICAgICAqIEhlbHBl\nciBzdHJ1Y3QgdG8gaG9sZCBzdGF0dXMgaW5mb3JtYXRpb24uCiAgICAgKi8K\nICAgIHByb3RlY3RlZCBzdGF0aWMgY2xhc3MgU3RhdHVzCiAgICAgICAgaW1w\nbGVtZW50cyBTZXJpYWxpemFibGUgewoKICAgICAgICBwdWJsaWMgbG9uZyBz\nZXEgPSAxTDsKICAgICAgICBwdWJsaWMgbG9uZyBtYXggPSAwTDsKICAgIH0K\nfQo=\n","encoding":"base64"}

