{"sha":"96049edd0b2facfe808002c52544c519196fb771","node_id":"MDQ6QmxvYjIwNjM2NDo5NjA0OWVkZDBiMmZhY2ZlODA4MDAyYzUyNTQ0YzUxOTE5NmZiNzcx","size":7230,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/96049edd0b2facfe808002c52544c519196fb771","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5rZXJuZWwuZXhwczsK\nCmltcG9ydCBqYXZhLnV0aWwuSXRlcmF0b3I7CmltcG9ydCBqYXZhLnV0aWwu\nTGlua2VkTGlzdDsKaW1wb3J0IGphdmEudXRpbC5MaXN0SXRlcmF0b3I7Cgpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc3FsLlNRTEJ1ZmZlcjsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNxbC5TZWxlY3Q7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLkJyb2tlcjsKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuRmlsdGVyczsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuT3BlbkpQQVN0YXRlTWFuYWdlcjsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuZXhwcy5FeHByZXNz\naW9uVmlzaXRvcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRhLkNs\nYXNzTWV0YURhdGE7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YS5G\naWVsZE1ldGFEYXRhOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEu\nWE1MTWV0YURhdGE7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5J\nbnRlcm5hbEV4Y2VwdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51\ndGlsLkltcGxIZWxwZXI7CgovKioKICogQSBmaWVsZCB0cmF2ZXJzYWwgc3Rh\ncnRpbmcgd2l0aCBhIGNvbnN0YW50IGZpbHRlciBwYXJhbWV0ZXIuCiAqCiAq\nIEBhdXRob3IgQWJlIFdoaXRlCiAqLwpjbGFzcyBDb25zdFBhdGgKICAgIGV4\ndGVuZHMgQ29uc3QKICAgIGltcGxlbWVudHMgSkRCQ1BhdGggewoKICAgIHBy\naXZhdGUgZmluYWwgQ29uc3QgX2NvbnN0YW50OwogICAgcHJpdmF0ZSBmaW5h\nbCBMaW5rZWRMaXN0IF9hY3Rpb25zID0gbmV3IExpbmtlZExpc3QoKTsKCiAg\nICAvKioKICAgICAqIENvbnN0cnVjdG9yLiBTdXBwbHkgY29uc3RhbnQgdG8g\ndHJhdmVyc2UuCiAgICAgKi8KICAgIHB1YmxpYyBDb25zdFBhdGgoQ29uc3Qg\nY29uc3RhbnQpIHsKICAgICAgICBfY29uc3RhbnQgPSBjb25zdGFudDsKICAg\nIH0KCiAgICBwdWJsaWMgQ2xhc3MgZ2V0VHlwZSgpIHsKICAgICAgICBpZiAo\nX2FjdGlvbnMuaXNFbXB0eSgpKSB7CiAgICAgICAgICAgIENsYXNzTWV0YURh\ndGEgbWV0YSA9IGdldE1ldGFEYXRhKCk7CiAgICAgICAgICAgIGlmIChtZXRh\nID09IG51bGwpCiAgICAgICAgICAgICAgICByZXR1cm4gT2JqZWN0LmNsYXNz\nOwogICAgICAgICAgICByZXR1cm4gbWV0YS5nZXREZXNjcmliZWRUeXBlKCk7\nCiAgICAgICAgfQoKICAgICAgICBPYmplY3QgbGFzdCA9IF9hY3Rpb25zLmdl\ndExhc3QoKTsKICAgICAgICBpZiAobGFzdCBpbnN0YW5jZW9mIENsYXNzKQog\nICAgICAgICAgICByZXR1cm4gKENsYXNzKSBsYXN0OwogICAgICAgIEZpZWxk\nTWV0YURhdGEgZm1kID0gKEZpZWxkTWV0YURhdGEpIGxhc3Q7CiAgICAgICAg\ncmV0dXJuIGZtZC5nZXREZWNsYXJlZFR5cGUoKTsKICAgIH0KCiAgICBwdWJs\naWMgdm9pZCBzZXRJbXBsaWNpdFR5cGUoQ2xhc3MgdHlwZSkgewogICAgICAg\nIF9hY3Rpb25zLmFkZCh0eXBlKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBn\nZXQoRmllbGRNZXRhRGF0YSBmaWVsZCwgYm9vbGVhbiBudWxsVHJhdmVyc2Fs\nKSB7CiAgICAgICAgX2FjdGlvbnMuYWRkKGZpZWxkKTsKICAgIH0KCiAgICBw\ndWJsaWMgdm9pZCBnZXRLZXkoKSB7CiAgICB9CgogICAgcHVibGljIEZpZWxk\nTWV0YURhdGEgbGFzdCgpIHsKICAgICAgICBMaXN0SXRlcmF0b3IgaXRyID0g\nX2FjdGlvbnMubGlzdEl0ZXJhdG9yKF9hY3Rpb25zLnNpemUoKSk7CiAgICAg\nICAgT2JqZWN0IHByZXY7CiAgICAgICAgd2hpbGUgKGl0ci5oYXNQcmV2aW91\ncygpKSB7CiAgICAgICAgICAgIHByZXYgPSBpdHIucHJldmlvdXMoKTsKICAg\nICAgICAgICAgaWYgKHByZXYgaW5zdGFuY2VvZiBGaWVsZE1ldGFEYXRhKQog\nICAgICAgICAgICAgICAgcmV0dXJuIChGaWVsZE1ldGFEYXRhKSBwcmV2Owog\nICAgICAgIH0KICAgICAgICByZXR1cm4gbnVsbDsKICAgIH0KCiAgICBwdWJs\naWMgT2JqZWN0IGdldFZhbHVlKE9iamVjdFtdIHBhcmFtcykgewogICAgICAg\nIHRocm93IG5ldyBJbnRlcm5hbEV4Y2VwdGlvbigpOwogICAgfQoKICAgIHB1\nYmxpYyBPYmplY3QgZ2V0VmFsdWUoRXhwQ29udGV4dCBjdHgsIEV4cFN0YXRl\nIHN0YXRlKSB7CiAgICAgICAgcmV0dXJuICgoQ29uc3RQYXRoRXhwU3RhdGUp\nIHN0YXRlKS52YWx1ZTsKICAgIH0KCiAgICBwdWJsaWMgT2JqZWN0IGdldFNR\nTFZhbHVlKFNlbGVjdCBzZWwsIEV4cENvbnRleHQgY3R4LCBFeHBTdGF0ZSBz\ndGF0ZSkgewogICAgICAgIHJldHVybiAoKENvbnN0UGF0aEV4cFN0YXRlKSBz\ndGF0ZSkuc3FsVmFsdWU7CiAgICB9CgogICAgcHVibGljIEV4cFN0YXRlIGlu\naXRpYWxpemUoU2VsZWN0IHNlbCwgRXhwQ29udGV4dCBjdHgsIGludCBmbGFn\ncykgewogICAgICAgIHJldHVybiBuZXcgQ29uc3RQYXRoRXhwU3RhdGUoX2Nv\nbnN0YW50LmluaXRpYWxpemUoc2VsLCBjdHgsIDApKTsKICAgIH0KCiAgICBw\ndWJsaWMgdm9pZCBjYWxjdWxhdGVWYWx1ZShTZWxlY3Qgc2VsLCBFeHBDb250\nZXh0IGN0eCwgRXhwU3RhdGUgc3RhdGUsIAogICAgICAgIFZhbCBvdGhlciwg\nRXhwU3RhdGUgb3RoZXJTdGF0ZSkgewogICAgICAgIHN1cGVyLmNhbGN1bGF0\nZVZhbHVlKHNlbCwgY3R4LCBzdGF0ZSwgb3RoZXIsIG90aGVyU3RhdGUpOwog\nICAgICAgIENvbnN0UGF0aEV4cFN0YXRlIGNzdGF0ZSA9IChDb25zdFBhdGhF\neHBTdGF0ZSkgc3RhdGU7CiAgICAgICAgX2NvbnN0YW50LmNhbGN1bGF0ZVZh\nbHVlKHNlbCwgY3R4LCBjc3RhdGUuY29uc3RhbnRTdGF0ZSwgbnVsbCwgbnVs\nbCk7CiAgICAgICAgY3N0YXRlLnZhbHVlID0gX2NvbnN0YW50LmdldFZhbHVl\nKGN0eCwgY3N0YXRlLmNvbnN0YW50U3RhdGUpOwogICAgICAgIGJvb2xlYW4g\nZmFpbGVkID0gZmFsc2U7CgogICAgICAgIC8vIGNvcGllZCBmcm9tIG9yZy5h\ncGFjaGUub3BlbmpwYS5xdWVyeS5Jbk1lbW9yeVBhdGgKICAgICAgICBPYmpl\nY3QgYWN0aW9uOwogICAgICAgIE9wZW5KUEFTdGF0ZU1hbmFnZXIgc207CiAg\nICAgICAgQnJva2VyIHRtcEJyb2tlciA9IG51bGw7CiAgICAgICAgZm9yIChJ\ndGVyYXRvciBpdHIgPSBfYWN0aW9ucy5pdGVyYXRvcigpOyBpdHIuaGFzTmV4\ndCgpOykgewogICAgICAgICAgICAvLyBmYWlsIG9uIG51bGwgdmFsdWUKICAg\nICAgICAgICAgaWYgKGNzdGF0ZS52YWx1ZSA9PSBudWxsKSB7CiAgICAgICAg\nICAgICAgICBmYWlsZWQgPSB0cnVlOwogICAgICAgICAgICAgICAgYnJlYWs7\nCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGFjdGlvbiA9IGl0ci5uZXh0\nKCk7CiAgICAgICAgICAgIGlmIChhY3Rpb24gaW5zdGFuY2VvZiBDbGFzcykg\newogICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICBj\nc3RhdGUudmFsdWUgPSBGaWx0ZXJzLmNvbnZlcnQoY3N0YXRlLnZhbHVlLAog\nICAgICAgICAgICAgICAgICAgICAgICAoQ2xhc3MpIGFjdGlvbik7CiAgICAg\nICAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgICAgICB9IGNh\ndGNoIChDbGFzc0Nhc3RFeGNlcHRpb24gY2NlKSB7CiAgICAgICAgICAgICAg\nICAgICAgZmFpbGVkID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICBicmVh\nazsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAg\nICAgLy8gbWFrZSBzdXJlIHdlIGNhbiBhY2Nlc3MgdGhlIGluc3RhbmNlOyBl\ndmVuIG5vbi1wYyB2YWxzIG1pZ2h0CiAgICAgICAgICAgIC8vIGJlIHByb3h5\nYWJsZQogICAgICAgICAgICBzbSA9IG51bGw7CiAgICAgICAgICAgIHRtcEJy\nb2tlciA9IG51bGw7CiAgICAgICAgICAgIGlmIChJbXBsSGVscGVyLmlzTWFu\nYWdlYWJsZShjc3RhdGUudmFsdWUpKQogICAgICAgICAgICAgICAgc20gPSAo\nT3BlbkpQQVN0YXRlTWFuYWdlcikgKEltcGxIZWxwZXIudG9QZXJzaXN0ZW5j\nZUNhcGFibGUoCiAgICAgICAgICAgICAgICAgICAgY3N0YXRlLnZhbHVlLAog\nICAgICAgICAgICAgICAgICAgIHRoaXMuZ2V0TWV0YURhdGEoKS5nZXRSZXBv\nc2l0b3J5KCkuZ2V0Q29uZmlndXJhdGlvbigpKSkuCiAgICAgICAgICAgICAg\nICAgICAgcGNHZXRTdGF0ZU1hbmFnZXIoKTsKICAgICAgICAgICAgaWYgKHNt\nID09IG51bGwpIHsKICAgICAgICAgICAgICAgIHRtcEJyb2tlciA9IGN0eC5z\ndG9yZS5nZXRDb250ZXh0KCkuZ2V0QnJva2VyKCk7CiAgICAgICAgICAgICAg\nICB0bXBCcm9rZXIudHJhbnNhY3Rpb25hbChjc3RhdGUudmFsdWUsIGZhbHNl\nLCBudWxsKTsKICAgICAgICAgICAgICAgIHNtID0gdG1wQnJva2VyLmdldFN0\nYXRlTWFuYWdlcihjc3RhdGUudmFsdWUpOwogICAgICAgICAgICB9CgogICAg\nICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgLy8gZ2V0IHRoZSBzcGVj\naWZpZWQgZmllbGQgdmFsdWUgYW5kIHN3aXRjaCBjYW5kaWRhdGUKICAgICAg\nICAgICAgICAgIGNzdGF0ZS52YWx1ZSA9IHNtLmZldGNoRmllbGQoKChGaWVs\nZE1ldGFEYXRhKSBhY3Rpb24pLgogICAgICAgICAgICAgICAgICAgIGdldElu\nZGV4KCksIHRydWUpOwogICAgICAgICAgICB9IGZpbmFsbHkgewogICAgICAg\nICAgICAgICAgLy8gc2V0VHJhbnNhY3Rpb25hbCBkb2VzIG5vdCBjbGVhciB0\naGUgc3RhdGUsIHdoaWNoIGlzCiAgICAgICAgICAgICAgICAvLyBpbXBvcnRh\nbnQgc2luY2UgdG1wVmFsIG1pZ2h0IGJlIGFsc28gbWFuYWdlZCBieQogICAg\nICAgICAgICAgICAgLy8gYW5vdGhlciBicm9rZXIgaWYgaXQncyBhIHByb3hp\nZWQgbm9uLXBjIGluc3RhbmNlCiAgICAgICAgICAgICAgICBpZiAodG1wQnJv\na2VyICE9IG51bGwpCiAgICAgICAgICAgICAgICAgICAgdG1wQnJva2VyLm5v\nbnRyYW5zYWN0aW9uYWwoc20uZ2V0TWFuYWdlZEluc3RhbmNlKCksIG51bGwp\nOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAoZmFpbGVk\nKQogICAgICAgICAgICBjc3RhdGUudmFsdWUgPSBudWxsOwoKICAgICAgICBp\nZiAob3RoZXIgIT0gbnVsbCkgewogICAgICAgICAgICBjc3RhdGUuc3FsVmFs\ndWUgPSBvdGhlci50b0RhdGFTdG9yZVZhbHVlKHNlbCwgY3R4LCBvdGhlclN0\nYXRlLCAKICAgICAgICAgICAgICAgIGNzdGF0ZS52YWx1ZSk7CiAgICAgICAg\nICAgIGNzdGF0ZS5vdGhlckxlbmd0aCA9IG90aGVyLmxlbmd0aChzZWwsIGN0\neCwgb3RoZXJTdGF0ZSk7CiAgICAgICAgfSBlbHNlCiAgICAgICAgICAgIGNz\ndGF0ZS5zcWxWYWx1ZSA9IGNzdGF0ZS52YWx1ZTsKICAgIH0KCiAgICBwdWJs\naWMgdm9pZCBhcHBlbmRUbyhTZWxlY3Qgc2VsLCBFeHBDb250ZXh0IGN0eCwg\nRXhwU3RhdGUgc3RhdGUsIAogICAgICAgIFNRTEJ1ZmZlciBzcWwsIGludCBp\nbmRleCkgewogICAgICAgIENvbnN0UGF0aEV4cFN0YXRlIGNzdGF0ZSA9IChD\nb25zdFBhdGhFeHBTdGF0ZSkgc3RhdGU7CiAgICAgICAgaWYgKGNzdGF0ZS5v\ndGhlckxlbmd0aCA+IDEpCiAgICAgICAgICAgIHNxbC5hcHBlbmRWYWx1ZSgo\nKE9iamVjdFtdKSBjc3RhdGUuc3FsVmFsdWUpW2luZGV4XSwgCiAgICAgICAg\nICAgICAgICBjc3RhdGUuZ2V0Q29sdW1uKGluZGV4KSk7CiAgICAgICAgZWxz\nZQogICAgICAgICAgICBzcWwuYXBwZW5kVmFsdWUoY3N0YXRlLnNxbFZhbHVl\nLCBjc3RhdGUuZ2V0Q29sdW1uKGluZGV4KSk7CiAgICB9CgogICAgcHVibGlj\nIHZvaWQgYWNjZXB0VmlzaXQoRXhwcmVzc2lvblZpc2l0b3IgdmlzaXRvcikg\newogICAgICAgIHZpc2l0b3IuZW50ZXIodGhpcyk7CiAgICAgICAgX2NvbnN0\nYW50LmFjY2VwdFZpc2l0KHZpc2l0b3IpOwogICAgICAgIHZpc2l0b3IuZXhp\ndCh0aGlzKTsKICAgIH0KCiAgICAvKioKICAgICAqIEV4cHJlc3Npb24gc3Rh\ndGUuCiAgICAgKi8KICAgIHByaXZhdGUgc3RhdGljIGNsYXNzIENvbnN0UGF0\naEV4cFN0YXRlIAogICAgICAgIGV4dGVuZHMgQ29uc3RFeHBTdGF0ZSB7Cgog\nICAgICAgIHB1YmxpYyBmaW5hbCBFeHBTdGF0ZSBjb25zdGFudFN0YXRlOwog\nICAgICAgIHB1YmxpYyBPYmplY3QgdmFsdWUgPSBudWxsOwogICAgICAgIHB1\nYmxpYyBPYmplY3Qgc3FsVmFsdWUgPSBudWxsOwogICAgICAgIHB1YmxpYyBp\nbnQgb3RoZXJMZW5ndGggPSAwOwoKICAgICAgICBwdWJsaWMgQ29uc3RQYXRo\nRXhwU3RhdGUoRXhwU3RhdGUgY29uc3RhbnRTdGF0ZSkgewogICAgICAgICAg\nICB0aGlzLmNvbnN0YW50U3RhdGUgPSBjb25zdGFudFN0YXRlOwogICAgICAg\nIH0KICAgIH0KICAgIAogICAgcHVibGljIHZvaWQgZ2V0KEZpZWxkTWV0YURh\ndGEgZm1kLCBYTUxNZXRhRGF0YSBtZXRhKSB7CiAgICB9CgogICAgcHVibGlj\nIHZvaWQgZ2V0KFhNTE1ldGFEYXRhIG1ldGEsIFN0cmluZyBuYW1lKSB7CiAg\nICB9CgogICAgcHVibGljIFhNTE1ldGFEYXRhIGdldFhtbE1hcHBpbmcoKSB7\nCiAgICAgICAgcmV0dXJuIG51bGw7CiAgICB9Cn0K\n","encoding":"base64"}

