{"sha":"3719ef7533b95c022d36024e73730956ca4fde84","node_id":"MDQ6QmxvYjIwNjM2NDozNzE5ZWY3NTMzYjk1YzAyMmQzNjAyNGU3MzczMDk1NmNhNGZkZTg0","size":6888,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/3719ef7533b95c022d36024e73730956ca4fde84","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5rZXJuZWwuZXhwczsK\nCmltcG9ydCBqYXZhLmxhbmcuTWF0aDsKaW1wb3J0IGphdmEuc3FsLlNRTEV4\nY2VwdGlvbjsKCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRh\nLkphdmFTUUxUeXBlczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJj\nLnNxbC5EQkRpY3Rpb25hcnk7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\namRiYy5zcWwuSm9pbnM7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRi\nYy5zcWwuUmVzdWx0OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMu\nc3FsLlNRTEJ1ZmZlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJj\nLnNxbC5TZWxlY3Q7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVs\nLkZpbHRlcnM7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLmV4\ncHMuRXhwcmVzc2lvblZpc2l0b3I7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEubWV0YS5DbGFzc01ldGFEYXRhOwoKLyoqCiAqIFJldHVybnMgdGhlIG51\nbWJlciBvZiBjaGFyYWN0ZXJzIGluIGEgc3RyaW5nLgogKgogKiBAYXV0aG9y\nIE1hcmMgUHJ1ZCdob21tZWF1eAogKi8KY2xhc3MgVHJpbQogICAgZXh0ZW5k\ncyBBYnN0cmFjdFZhbCB7CgogICAgcHJpdmF0ZSBmaW5hbCBWYWwgX3ZhbDsK\nICAgIHByaXZhdGUgZmluYWwgVmFsIF90cmltQ2hhcjsKICAgIHByaXZhdGUg\nZmluYWwgQm9vbGVhbiBfd2hlcmU7CiAgICBwcml2YXRlIENsYXNzTWV0YURh\ndGEgX21ldGEgPSBudWxsOwoKICAgIC8qKgogICAgICogQ29uc3RydWN0b3Iu\nIFByb3ZpZGUgdGhlIHN0cmluZyB0byBvcGVyYXRlIG9uLgogICAgICovCiAg\nICBwdWJsaWMgVHJpbShWYWwgdmFsLCBWYWwgdHJpbUNoYXIsIEJvb2xlYW4g\nd2hlcmUpIHsKICAgICAgICBfdmFsID0gdmFsOwogICAgICAgIF90cmltQ2hh\nciA9IHRyaW1DaGFyOwogICAgICAgIF93aGVyZSA9IHdoZXJlOwogICAgfQoK\nICAgIHB1YmxpYyBDbGFzc01ldGFEYXRhIGdldE1ldGFEYXRhKCkgewogICAg\nICAgIHJldHVybiBfbWV0YTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRN\nZXRhRGF0YShDbGFzc01ldGFEYXRhIG1ldGEpIHsKICAgICAgICBfbWV0YSA9\nIG1ldGE7CiAgICB9CgogICAgcHVibGljIENsYXNzIGdldFR5cGUoKSB7CiAg\nICAgICAgcmV0dXJuIFN0cmluZy5jbGFzczsKICAgIH0KCiAgICBwdWJsaWMg\ndm9pZCBzZXRJbXBsaWNpdFR5cGUoQ2xhc3MgdHlwZSkgewogICAgfQoKICAg\nIHB1YmxpYyBFeHBTdGF0ZSBpbml0aWFsaXplKFNlbGVjdCBzZWwsIEV4cENv\nbnRleHQgY3R4LCBpbnQgZmxhZ3MpIHsKICAgICAgICBFeHBTdGF0ZSB2YWx1\nZVN0YXRlID0gIF92YWwuaW5pdGlhbGl6ZShzZWwsIGN0eCwgMCk7CiAgICAg\nICAgRXhwU3RhdGUgY2hhclN0YXRlID0gX3RyaW1DaGFyLmluaXRpYWxpemUo\nc2VsLCBjdHgsIDApOwogICAgICAgIHJldHVybiBuZXcgVHJpbUV4cFN0YXRl\nKHNlbC5hbmQodmFsdWVTdGF0ZS5qb2lucywgY2hhclN0YXRlLmpvaW5zKSwg\nCiAgICAgICAgICAgIHZhbHVlU3RhdGUsIGNoYXJTdGF0ZSk7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBFeHByZXNzaW9uIHN0YXRlLgogICAgICovCiAgICBw\ncml2YXRlIHN0YXRpYyBjbGFzcyBUcmltRXhwU3RhdGUKICAgICAgICBleHRl\nbmRzIEV4cFN0YXRlIHsKCiAgICAgICAgcHVibGljIGZpbmFsIEV4cFN0YXRl\nIHZhbHVlU3RhdGU7CiAgICAgICAgcHVibGljIGZpbmFsIEV4cFN0YXRlIGNo\nYXJTdGF0ZTsKCiAgICAgICAgcHVibGljIFRyaW1FeHBTdGF0ZShKb2lucyBq\nb2lucywgRXhwU3RhdGUgdmFsdWVTdGF0ZSwgCiAgICAgICAgICAgIEV4cFN0\nYXRlIGNoYXJTdGF0ZSkgewogICAgICAgICAgICBzdXBlcihqb2lucyk7CiAg\nICAgICAgICAgIHRoaXMudmFsdWVTdGF0ZSA9IHZhbHVlU3RhdGU7CiAgICAg\nICAgICAgIHRoaXMuY2hhclN0YXRlID0gY2hhclN0YXRlOwogICAgICAgIH0K\nICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZWxlY3QoU2VsZWN0IHNlbCwgRXhw\nQ29udGV4dCBjdHgsIEV4cFN0YXRlIHN0YXRlLCAKICAgICAgICBib29sZWFu\nIHBrcykgewogICAgICAgIHNlbC5zZWxlY3QobmV3U1FMQnVmZmVyKHNlbCwg\nY3R4LCBzdGF0ZSksIHRoaXMpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNl\nbGVjdENvbHVtbnMoU2VsZWN0IHNlbCwgRXhwQ29udGV4dCBjdHgsIEV4cFN0\nYXRlIHN0YXRlLCAKICAgICAgICBib29sZWFuIHBrcykgewogICAgICAgIFRy\naW1FeHBTdGF0ZSB0c3RhdGUgPSAoVHJpbUV4cFN0YXRlKSBzdGF0ZTsKICAg\nICAgICBfdmFsLnNlbGVjdENvbHVtbnMoc2VsLCBjdHgsIHRzdGF0ZS52YWx1\nZVN0YXRlLCB0cnVlKTsKICAgICAgICBfdHJpbUNoYXIuc2VsZWN0Q29sdW1u\ncyhzZWwsIGN0eCwgdHN0YXRlLmNoYXJTdGF0ZSwgdHJ1ZSk7CiAgICB9Cgog\nICAgcHVibGljIHZvaWQgZ3JvdXBCeShTZWxlY3Qgc2VsLCBFeHBDb250ZXh0\nIGN0eCwgRXhwU3RhdGUgc3RhdGUpIHsKICAgICAgICBzZWwuZ3JvdXBCeShu\nZXdTUUxCdWZmZXIoc2VsLCBjdHgsIHN0YXRlKSk7CiAgICB9CgogICAgcHVi\nbGljIHZvaWQgb3JkZXJCeShTZWxlY3Qgc2VsLCBFeHBDb250ZXh0IGN0eCwg\nRXhwU3RhdGUgc3RhdGUsIAogICAgICAgIGJvb2xlYW4gYXNjKSB7CiAgICAg\nICAgc2VsLm9yZGVyQnkobmV3U1FMQnVmZmVyKHNlbCwgY3R4LCBzdGF0ZSks\nIGFzYywgZmFsc2UpOwogICAgfQoKICAgIHByaXZhdGUgU1FMQnVmZmVyIG5l\nd1NRTEJ1ZmZlcihTZWxlY3Qgc2VsLCBFeHBDb250ZXh0IGN0eCwgRXhwU3Rh\ndGUgc3RhdGUpIHsKICAgICAgICBjYWxjdWxhdGVWYWx1ZShzZWwsIGN0eCwg\nc3RhdGUsIG51bGwsIG51bGwpOwogICAgICAgIFNRTEJ1ZmZlciBidWYgPSBu\nZXcgU1FMQnVmZmVyKGN0eC5zdG9yZS5nZXREQkRpY3Rpb25hcnkoKSk7CiAg\nICAgICAgYXBwZW5kVG8oc2VsLCBjdHgsIHN0YXRlLCBidWYsIDApOwogICAg\nICAgIHJldHVybiBidWY7CiAgICB9CgogICAgcHVibGljIE9iamVjdCBsb2Fk\nKEV4cENvbnRleHQgY3R4LCBFeHBTdGF0ZSBzdGF0ZSwgUmVzdWx0IHJlcykK\nICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICByZXR1cm4g\nRmlsdGVycy5jb252ZXJ0KHJlcy5nZXRPYmplY3QodGhpcywKICAgICAgICAg\nICAgSmF2YVNRTFR5cGVzLkpEQkNfREVGQVVMVCwgbnVsbCksIGdldFR5cGUo\nKSk7CiAgICB9CgogICAgcHVibGljIHZvaWQgY2FsY3VsYXRlVmFsdWUoU2Vs\nZWN0IHNlbCwgRXhwQ29udGV4dCBjdHgsIEV4cFN0YXRlIHN0YXRlLCAKICAg\nICAgICBWYWwgb3RoZXIsIEV4cFN0YXRlIG90aGVyU3RhdGUpIHsKICAgICAg\nICBUcmltRXhwU3RhdGUgdHN0YXRlID0gKFRyaW1FeHBTdGF0ZSkgc3RhdGU7\nCiAgICAgICAgX3ZhbC5jYWxjdWxhdGVWYWx1ZShzZWwsIGN0eCwgdHN0YXRl\nLnZhbHVlU3RhdGUsIG51bGwsIG51bGwpOwogICAgICAgIF90cmltQ2hhci5j\nYWxjdWxhdGVWYWx1ZShzZWwsIGN0eCwgdHN0YXRlLmNoYXJTdGF0ZSwgbnVs\nbCwgbnVsbCk7CiAgICB9CgogICAgcHVibGljIGludCBsZW5ndGgoU2VsZWN0\nIHNlbCwgRXhwQ29udGV4dCBjdHgsIEV4cFN0YXRlIHN0YXRlKSB7CiAgICAg\nICAgcmV0dXJuIDE7CiAgICB9CgogICAgcHVibGljIHZvaWQgYXBwZW5kVG8o\nU2VsZWN0IHNlbCwgRXhwQ29udGV4dCBjdHgsIEV4cFN0YXRlIHN0YXRlLCAK\nICAgICAgICBTUUxCdWZmZXIgc3FsLCBpbnQgaW5kZXgpIHsKICAgICAgICBE\nQkRpY3Rpb25hcnkgZGljdCA9IGN0eC5zdG9yZS5nZXREQkRpY3Rpb25hcnko\nKTsKICAgICAgICBTdHJpbmcgZnVuYzsKICAgICAgICBpZiAoX3doZXJlID09\nIG51bGwpIHsKICAgICAgICAgICAgZnVuYyA9IGRpY3QudHJpbUJvdGhGdW5j\ndGlvbjsKICAgICAgICAgICAgZGljdC5hc3NlcnRTdXBwb3J0KGZ1bmMgIT0g\nbnVsbCwgIlRyaW1Cb3RoRnVuY3Rpb24iKTsKICAgICAgICB9IGVsc2UgaWYg\nKF93aGVyZS5ib29sZWFuVmFsdWUoKSkgewogICAgICAgICAgICBmdW5jID0g\nZGljdC50cmltTGVhZGluZ0Z1bmN0aW9uOwogICAgICAgICAgICBkaWN0LmFz\nc2VydFN1cHBvcnQoZnVuYyAhPSBudWxsLCAiVHJpbUxlYWRpbmdGdW5jdGlv\nbiIpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGZ1bmMgPSBkaWN0\nLnRyaW1UcmFpbGluZ0Z1bmN0aW9uOwogICAgICAgICAgICBkaWN0LmFzc2Vy\ndFN1cHBvcnQoZnVuYyAhPSBudWxsLCAiVHJpbVRyYWlsaW5nRnVuY3Rpb24i\nKTsKICAgICAgICB9ICAgICAgICAKICAgICAgICBmdW5jID0gZGljdC5nZXRD\nYXN0RnVuY3Rpb24oX3ZhbCwgZnVuYyk7CiAgICAgICAgCiAgICAgICAgaW50\nIGZyb21QYXJ0ID0gZnVuYy5pbmRleE9mKCJ7MH0iKTsKICAgICAgICBpbnQg\nY2hhclBhcnQgPSBmdW5jLmluZGV4T2YoInsxfSIpOwogICAgICAgIGlmIChj\naGFyUGFydCA9PSAtMSkKICAgICAgICAgICAgY2hhclBhcnQgPSBmdW5jLmxl\nbmd0aCgpOwogICAgICAgIFN0cmluZyBwYXJ0MSA9IGZ1bmMuc3Vic3RyaW5n\nKDAsIE1hdGgubWluKGZyb21QYXJ0LCBjaGFyUGFydCkpOwogICAgICAgIFN0\ncmluZyBwYXJ0MiA9IGZ1bmMuc3Vic3RyaW5nKE1hdGgubWluKGZyb21QYXJ0\nLCBjaGFyUGFydCkgKyAzLAogICAgICAgICAgICBNYXRoLm1heChmcm9tUGFy\ndCwgY2hhclBhcnQpKTsKICAgICAgICBTdHJpbmcgcGFydDMgPSBudWxsOwog\nICAgICAgIGlmIChjaGFyUGFydCAhPSBmdW5jLmxlbmd0aCgpKQogICAgICAg\nICAgICBwYXJ0MyA9IGZ1bmMuc3Vic3RyaW5nKE1hdGgubWF4KGZyb21QYXJ0\nLCBjaGFyUGFydCkgKyAzKTsKCiAgICAgICAgVHJpbUV4cFN0YXRlIHRzdGF0\nZSA9IChUcmltRXhwU3RhdGUpIHN0YXRlOwogICAgICAgIHNxbC5hcHBlbmQo\ncGFydDEpOwogICAgICAgIGlmIChmcm9tUGFydCA8IGNoYXJQYXJ0KQogICAg\nICAgICAgICBfdmFsLmFwcGVuZFRvKHNlbCwgY3R4LCB0c3RhdGUudmFsdWVT\ndGF0ZSwgc3FsLCAwKTsKICAgICAgICBlbHNlIAogICAgICAgICAgICBfdHJp\nbUNoYXIuYXBwZW5kVG8oc2VsLCBjdHgsIHRzdGF0ZS5jaGFyU3RhdGUsIHNx\nbCwgMCk7CiAgICAgICAgc3FsLmFwcGVuZChwYXJ0Mik7CgogICAgICAgIGlm\nIChjaGFyUGFydCAhPSBmdW5jLmxlbmd0aCgpKSB7CiAgICAgICAgICAgIGlm\nIChmcm9tUGFydCA+IGNoYXJQYXJ0KQogICAgICAgICAgICAgICAgX3ZhbC5h\ncHBlbmRUbyhzZWwsIGN0eCwgdHN0YXRlLnZhbHVlU3RhdGUsIHNxbCwgMCk7\nCiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIF90cmltQ2hhci5h\ncHBlbmRUbyhzZWwsIGN0eCwgdHN0YXRlLmNoYXJTdGF0ZSwgc3FsLCAwKTsK\nICAgICAgICAgICAgc3FsLmFwcGVuZChwYXJ0Myk7CiAgICAgICAgfSBlbHNl\nIHsKICAgICAgICAgICAgLy8gc2luY2UgdGhlIHRyaW0gc3RhdGVtZW50IGRp\nZCBub3Qgc3BlY2lmeSB0aGUgdG9rZW4gZm9yCiAgICAgICAgICAgIC8vIHdo\nZXJlIHRvIHNwZWNpZnkgdGhlIHRyaW0gY2hhciAoZGVub3RlZCBieSAiezF9\nIiksCiAgICAgICAgICAgIC8vIHdlIGRvIG5vdCBoYXZlIHRoZSBhYmlsaXR5\nIHRvIHRyaW0gb2ZmIG5vbi13aGl0ZXNwYWNlCiAgICAgICAgICAgIC8vIGNo\nYXJhY3RlcnM7IHRocm93IGFuIGV4Y2VwdGlvbiB3aGVuIHdlIGF0dGVtcHQg\ndG8gZG8gc28KICAgICAgICAgICAgaWYgKCEoX3RyaW1DaGFyIGluc3RhbmNl\nb2YgQ29uc3QpIHx8IFN0cmluZy52YWx1ZU9mKCgoQ29uc3QpIAogICAgICAg\nICAgICAgICAgX3RyaW1DaGFyKS5nZXRWYWx1ZShjdHgsdHN0YXRlLmNoYXJT\ndGF0ZSkpLnRyaW0oKS5sZW5ndGgoKSAhPSAwKQogICAgICAgICAgICAgICAg\nZGljdC5hc3NlcnRTdXBwb3J0KGZhbHNlLCAiVHJpbU5vbldoaXRlc3BhY2VD\naGFyYWN0ZXJzIik7CiAgICAgICAgfQogICAgfQoKICAgIHB1YmxpYyB2b2lk\nIGFjY2VwdFZpc2l0KEV4cHJlc3Npb25WaXNpdG9yIHZpc2l0b3IpIHsKICAg\nICAgICB2aXNpdG9yLmVudGVyKHRoaXMpOwogICAgICAgIF92YWwuYWNjZXB0\nVmlzaXQodmlzaXRvcik7CiAgICAgICAgX3RyaW1DaGFyLmFjY2VwdFZpc2l0\nKHZpc2l0b3IpOwogICAgICAgIHZpc2l0b3IuZXhpdCh0aGlzKTsKICAgIH0K\nfQoK\n","encoding":"base64"}

