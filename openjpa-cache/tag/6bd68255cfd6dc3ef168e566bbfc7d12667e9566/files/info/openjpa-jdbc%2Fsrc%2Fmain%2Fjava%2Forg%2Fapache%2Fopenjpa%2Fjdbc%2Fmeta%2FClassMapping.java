{"sha":"38de37923fa1df122e2b2201a1569935858d2460","node_id":"MDQ6QmxvYjIwNjM2NDozOGRlMzc5MjNmYTFkZjEyMmUyYjIyMDFhMTU2OTkzNTg1OGQyNDYw","size":33521,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/38de37923fa1df122e2b2201a1569935858d2460","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhOwoKaW1wb3J0\nIGphdmEuc3FsLlNRTEV4Y2VwdGlvbjsKaW1wb3J0IGphdmEudXRpbC5BcnJh\neUxpc3Q7CmltcG9ydCBqYXZhLnV0aWwuQXJyYXlzOwppbXBvcnQgamF2YS51\ndGlsLkNvbGxlY3Rpb247CmltcG9ydCBqYXZhLnV0aWwuQ29sbGVjdGlvbnM7\nCmltcG9ydCBqYXZhLnV0aWwuSGFzaE1hcDsKaW1wb3J0IGphdmEudXRpbC5J\ndGVyYXRvcjsKaW1wb3J0IGphdmEudXRpbC5MaW5rZWRIYXNoU2V0OwppbXBv\ncnQgamF2YS51dGlsLkxpc3Q7CmltcG9ydCBqYXZhLnV0aWwuTWFwOwppbXBv\ncnQgamF2YS51dGlsLlNldDsKCmltcG9ydCBvcmcuYXBhY2hlLmNvbW1vbnMu\nbGFuZy5TdHJpbmdVdGlsczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5q\nZGJjLmtlcm5lbC5KREJDRmV0Y2hDb25maWd1cmF0aW9uOwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLmpkYmMua2VybmVsLkpEQkNTdG9yZTsKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLm1ldGEuc3RyYXRzLk5vbmVDbGFz\nc1N0cmF0ZWd5OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2No\nZW1hLkNvbHVtbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNj\naGVtYS5Db2x1bW5JTzsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJj\nLnNjaGVtYS5Gb3JlaWduS2V5OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLmpkYmMuc2NoZW1hLlNjaGVtYXM7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEuamRiYy5zY2hlbWEuVGFibGU7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEuamRiYy5zcWwuSm9pbnM7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\namRiYy5zcWwuUmVzdWx0OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpk\nYmMuc3FsLlJvd01hbmFnZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\namRiYy5zcWwuU2VsZWN0OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmtl\ncm5lbC5GZXRjaENvbmZpZ3VyYXRpb247CmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEua2VybmVsLk9wZW5KUEFTdGF0ZU1hbmFnZXI7CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEua2VybmVsLlBDU3RhdGU7CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEubGliLmxvZy5Mb2c7CmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEubGliLnJvcC5SZXN1bHRPYmplY3RQcm92aWRlcjsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5saWIudXRpbC5Mb2NhbGl6ZXI7CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEubWV0YS5DbGFzc01ldGFEYXRhOwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuVmFsdWVNZXRhRGF0YTsKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLkFwcGxpY2F0aW9uSWRzOwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuSW50ZXJuYWxFeGNlcHRpb247\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5NZXRhRGF0YUV4Y2Vw\ndGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLk9wZW5KUEFJ\nZDsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLkltcGxIZWxwZXI7\nCgovKioKICogU3BlY2lhbGl6YXRpb24gb2YgbWV0YWRhdGEgZm9yIHJlbGF0\naW9uYWwgZGF0YWJhc2VzLgogKgogKiBAYXV0aG9yIEFiZSBXaGl0ZQogKi8K\ncHVibGljIGNsYXNzIENsYXNzTWFwcGluZwogICAgZXh0ZW5kcyBDbGFzc01l\ndGFEYXRhCiAgICBpbXBsZW1lbnRzIENsYXNzU3RyYXRlZ3kgewoKICAgIHB1\nYmxpYyBzdGF0aWMgZmluYWwgQ2xhc3NNYXBwaW5nW10gRU1QVFlfTUFQUElO\nR1MgPSBuZXcgQ2xhc3NNYXBwaW5nWzBdOwoKICAgIHByaXZhdGUgc3RhdGlj\nIGZpbmFsIExvY2FsaXplciBfbG9jID0gTG9jYWxpemVyLmZvclBhY2thZ2UK\nICAgICAgICAoQ2xhc3NNYXBwaW5nLmNsYXNzKTsKCiAgICBwcml2YXRlIGZp\nbmFsIENsYXNzTWFwcGluZ0luZm8gX2luZm87CiAgICBwcml2YXRlIGZpbmFs\nIERpc2NyaW1pbmF0b3IgX2Rpc2NyaW07CiAgICBwcml2YXRlIGZpbmFsIFZl\ncnNpb24gX3ZlcnNpb247CiAgICBwcml2YXRlIENsYXNzU3RyYXRlZ3kgX3N0\ncmF0ZWd5ID0gbnVsbDsKCiAgICBwcml2YXRlIFRhYmxlIF90YWJsZSA9IG51\nbGw7CiAgICBwcml2YXRlIENvbHVtbklPIF9pbyA9IG51bGw7CiAgICBwcml2\nYXRlIENvbHVtbltdIF9jb2xzID0gU2NoZW1hcy5FTVBUWV9DT0xVTU5TOwog\nICAgcHJpdmF0ZSBGb3JlaWduS2V5IF9mayA9IG51bGw7CiAgICBwcml2YXRl\nIGludCBfc3ViY2xhc3NNb2RlID0gSW50ZWdlci5NQVhfVkFMVUU7CgogICAg\ncHJpdmF0ZSBDbGFzc01hcHBpbmdbXSBfam9pblN1Yk1hcHMgPSBudWxsOwog\nICAgcHJpdmF0ZSBDbGFzc01hcHBpbmdbXSBfYXNzaWduTWFwcyA9IG51bGw7\nCgogICAgLy8gbWFwcyBjb2x1bW5zIHRvIGpvaW5hYmxlcwogICAgcHJpdmF0\nZSBmaW5hbCBNYXAgX2pvaW5hYmxlcyA9IENvbGxlY3Rpb25zLnN5bmNocm9u\naXplZE1hcChuZXcgSGFzaE1hcCgpKTsKCiAgICAvKioKICAgICAqIENvbnN0\ncnVjdG9yLiBTdXBwbHkgZGVzY3JpYmVkIHR5cGUgYW5kIG93bmluZyByZXBv\nc2l0b3J5LgogICAgICovCiAgICBwcm90ZWN0ZWQgQ2xhc3NNYXBwaW5nKENs\nYXNzIHR5cGUsIE1hcHBpbmdSZXBvc2l0b3J5IHJlcG9zKSB7CiAgICAgICAg\nc3VwZXIodHlwZSwgcmVwb3MpOwogICAgICAgIF9kaXNjcmltID0gcmVwb3Mu\nbmV3RGlzY3JpbWluYXRvcih0aGlzKTsKICAgICAgICBfdmVyc2lvbiA9IHJl\ncG9zLm5ld1ZlcnNpb24odGhpcyk7CiAgICAgICAgX2luZm8gPSByZXBvcy5u\nZXdNYXBwaW5nSW5mbyh0aGlzKTsKICAgIH0KCiAgICAvKioKICAgICAqIEVt\nYmVkZGVkIGNvbnN0cnVjdG9yLiBTdXBwbHkgZW1iZWRkaW5nIHZhbHVlIGFu\nZCBvd25pbmcgcmVwb3NpdG9yeS4KICAgICAqLwogICAgcHJvdGVjdGVkIENs\nYXNzTWFwcGluZyhWYWx1ZU1ldGFEYXRhIHZtZCkgewogICAgICAgIHN1cGVy\nKHZtZCk7CiAgICAgICAgX2Rpc2NyaW0gPSBnZXRNYXBwaW5nUmVwb3NpdG9y\neSgpLm5ld0Rpc2NyaW1pbmF0b3IodGhpcyk7CiAgICAgICAgX3ZlcnNpb24g\nPSBnZXRNYXBwaW5nUmVwb3NpdG9yeSgpLm5ld1ZlcnNpb24odGhpcyk7CiAg\nICAgICAgX2luZm8gPSBnZXRNYXBwaW5nUmVwb3NpdG9yeSgpLm5ld01hcHBp\nbmdJbmZvKHRoaXMpOwogICAgfQoKICAgIC8qKgogICAgICogVGhlIGNsYXNz\nIGRpc2NyaW1pbmF0b3IuCiAgICAgKi8KICAgIHB1YmxpYyBEaXNjcmltaW5h\ndG9yIGdldERpc2NyaW1pbmF0b3IoKSB7CiAgICAgICAgcmV0dXJuIF9kaXNj\ncmltOwogICAgfQoKICAgIC8qKgogICAgICogVGhlIHZlcnNpb24gaW5kaWNh\ndG9yLgogICAgICovCiAgICBwdWJsaWMgVmVyc2lvbiBnZXRWZXJzaW9uKCkg\newogICAgICAgIHJldHVybiBfdmVyc2lvbjsKICAgIH0KCiAgICAvLy8vLy8v\nLy8vLwogICAgLy8gUnVudGltZQogICAgLy8vLy8vLy8vLy8KCiAgICAvKioK\nICAgICAqIFJldHVybiB0aGUgb2lkIHZhbHVlIHN0b3JlZCBpbiB0aGUgcmVz\ndWx0LiBUaGlzIGltcGxlbWVudGF0aW9uIHdpbGwKICAgICAqIHJlY3Vyc2Ug\ndW50aWwgaXQgZmluZHMgYW4gYW5jZXN0b3IgY2xhc3Mgd2hvIHVzZXMgb2lk\nIHZhbHVlcyBmb3IgaXRzCiAgICAgKiBwcmltYXJ5IGtleS4KICAgICAqCiAg\nICAgKiBAcGFyYW0gZmsgaWYgbm9uLW51bGwsIHVzZSB0aGUgbG9jYWwgY29s\ndW1ucyBvZiB0aGUgZ2l2ZW4gZm9yZWlnbgogICAgICoga2V5IGluIHBsYWNl\nIG9mIHRoaXMgY2xhc3MnIHByaW1hcnkga2V5IGNvbHVtbnMKICAgICAqIEBz\nZWUgI2lzUHJpbWFyeUtleU9iamVjdElkCiAgICAgKi8KICAgIHB1YmxpYyBP\nYmplY3QgZ2V0T2JqZWN0SWQoSkRCQ1N0b3JlIHN0b3JlLCBSZXN1bHQgcmVz\nLCBGb3JlaWduS2V5IGZrLAogICAgICAgIGJvb2xlYW4gc3VicywgSm9pbnMg\nam9pbnMpCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAg\nVmFsdWVNYXBwaW5nIGVtYmVkID0gZ2V0RW1iZWRkaW5nTWFwcGluZygpOwog\nICAgICAgIGlmIChlbWJlZCAhPSBudWxsKQogICAgICAgICAgICByZXR1cm4g\nZW1iZWQuZ2V0RmllbGRNYXBwaW5nKCkuZ2V0RGVmaW5pbmdNYXBwaW5nKCku\nCiAgICAgICAgICAgICAgICBnZXRPYmplY3RJZChzdG9yZSwgcmVzLCBmaywg\nc3Vicywgam9pbnMpOwoKICAgICAgICByZXR1cm4gZ2V0T2JqZWN0SWQodGhp\ncywgc3RvcmUsIHJlcywgZmssIHN1YnMsIGpvaW5zKTsKICAgIH0KCiAgICAv\nKioKICAgICAqIFJlY3Vyc2l2ZSBoZWxwZXIgZm9yIHB1YmxpYyA8Y29kZT5n\nZXRPYmplY3RJZDwvY29kZT4gbWV0aG9kLgogICAgICovCiAgICBwcml2YXRl\nIE9iamVjdCBnZXRPYmplY3RJZChDbGFzc01hcHBpbmcgY2xzLCBKREJDU3Rv\ncmUgc3RvcmUsIFJlc3VsdCByZXMsCiAgICAgICAgRm9yZWlnbktleSBmaywg\nYm9vbGVhbiBzdWJzLCBKb2lucyBqb2lucykKICAgICAgICB0aHJvd3MgU1FM\nRXhjZXB0aW9uIHsKICAgICAgICBpZiAoIWlzUHJpbWFyeUtleU9iamVjdElk\nKHRydWUpKQogICAgICAgICAgICByZXR1cm4gZ2V0UENTdXBlcmNsYXNzTWFw\ncGluZygpLmdldE9iamVjdElkKGNscywgc3RvcmUsIHJlcywgZmssCiAgICAg\nICAgICAgICAgICBzdWJzLCBqb2lucyk7CiAgICAgICAgaWYgKGdldElkZW50\naXR5VHlwZSgpID09IElEX1VOS05PV04pCiAgICAgICAgICAgIHRocm93IG5l\ndyBJbnRlcm5hbEV4Y2VwdGlvbigpOwoKICAgICAgICBDb2x1bW5bXSBwa3Mg\nPSBnZXRQcmltYXJ5S2V5Q29sdW1ucygpOwogICAgICAgIGlmIChnZXRJZGVu\ndGl0eVR5cGUoKSA9PSBJRF9EQVRBU1RPUkUpIHsKICAgICAgICAgICAgQ29s\ndW1uIGNvbCA9IChmayA9PSBudWxsKSA/IHBrc1swXSA6IGZrLmdldENvbHVt\nbihwa3NbMF0pOwogICAgICAgICAgICBsb25nIGlkID0gcmVzLmdldExvbmco\nY29sLCBqb2lucyk7CiAgICAgICAgICAgIHJldHVybiAoaWQgPT0gMCAmJiBy\nZXMud2FzTnVsbCgpKSA/IG51bGwKICAgICAgICAgICAgICAgIDogc3RvcmUu\nbmV3RGF0YVN0b3JlSWQoaWQsIGNscywgc3Vicyk7CiAgICAgICAgfQoKICAg\nICAgICAvLyBhcHBsaWNhdGlvbiBpZGVudGl0eQogICAgICAgIE9iamVjdFtd\nIHZhbHMgPSBuZXcgT2JqZWN0W2dldFByaW1hcnlLZXlGaWVsZHMoKS5sZW5n\ndGhdOwogICAgICAgIEZpZWxkTWFwcGluZyBmbTsKICAgICAgICBKb2luYWJs\nZSBqb2luOwogICAgICAgIGludCBwa0lkeDsKICAgICAgICBmb3IgKGludCBp\nID0gMDsgaSA8IHBrcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAvLyB3\nZSBrbm93IHRoYXQgYWxsIHBrIGNvbHVtbiBqb2luIG1hcHBpbmdzIHVzZSBw\ncmltYXJ5IGtleSBmaWVsZHMsCiAgICAgICAgICAgIC8vIGNhdXNlIHRoaXMg\nbWFwcGluZyB1c2VzIHRoZSBvaWQgYXMgaXRzIHByaW1hcnkga2V5ICh3ZSBy\nZWN1cnNlZAogICAgICAgICAgICAvLyBhdCB0aGUgYmVnaW5uaW5nIG9mIHRo\nZSBtZXRob2QgdG8gZW5zdXJlIHRoaXMpCiAgICAgICAgICAgIGpvaW4gPSBh\nc3NlcnRKb2luYWJsZShwa3NbaV0pOwogICAgICAgICAgICBmbSA9IGdldEZp\nZWxkTWFwcGluZyhqb2luLmdldEZpZWxkSW5kZXgoKSk7CiAgICAgICAgICAg\nIHBrSWR4ID0gZm0uZ2V0UHJpbWFyeUtleUluZGV4KCk7CgogICAgICAgICAg\nICAvLyBjb3VsZCBoYXZlIGFscmVhZHkgc2V0IHZhbHVlIHdpdGggcHJldmlv\ndXMgbXVsdGktY29sdW1uIGpvaW5hYmxlCiAgICAgICAgICAgIGlmICh2YWxz\nW3BrSWR4XSA9PSBudWxsKSB7CiAgICAgICAgICAgICAgICByZXMuc3RhcnRE\nYXRhUmVxdWVzdChmbSk7CiAgICAgICAgICAgICAgICB2YWxzW3BrSWR4XSA9\nIGpvaW4uZ2V0UHJpbWFyeUtleVZhbHVlKHJlcywgam9pbi5nZXRDb2x1bW5z\nKCksCiAgICAgICAgICAgICAgICAgICAgZmssIHN0b3JlLCBqb2lucyk7CiAg\nICAgICAgICAgICAgICByZXMuZW5kRGF0YVJlcXVlc3QoKTsKICAgICAgICAg\nICAgICAgIGlmICh2YWxzW3BrSWR4XSA9PSBudWxsKQogICAgICAgICAgICAg\nICAgICAgIHJldHVybiBudWxsOwogICAgICAgICAgICB9CiAgICAgICAgfQog\nICAgICAgIE9iamVjdCBvaWQgPSBBcHBsaWNhdGlvbklkcy5mcm9tUEtWYWx1\nZXModmFscywgY2xzKTsKICAgICAgICAKICAgICAgICAvKioKICAgICAgICAg\nKiBGb3IgcG9seW1vcnBoaWMgcmVsYXRpb25zLAogICAgICAgICAqIHRoZSB0\neXBlIGZpZWxkIGluIHRoZSBvaWQgaXMgaW5pdGlhbGx5IHNldCB0byBiYXNl\nIHR5cGUuCiAgICAgICAgICogSWYgdGhlIGRpc2NyaW1pbmF0b3IgdmFsdWUg\naXMgcHJlc2V0IGluIHRoZSBjdXJyZW50IHJlc3VsdCwKICAgICAgICAgKiB0\naGVuIHRoZSB0eXBlIGZpZWxkIG5lZWRzIHJlc2V0IGJhc2VkIG9uIHRoZSBk\naXNjcmltaW5hdG9yIHZhbHVlLgogICAgICAgICAqIElmIHRoZSBkaXNjcmlt\naW5hdG9yIHZhbHVlIGlzIG5vdCBwcmVzZW50IG9yIGludmFsaWQsCiAgICAg\nICAgICogaWdub3JlIGFueSBleGNlcHRpb25zIGJlaW5nIHRocm93bi4KICAg\nICAgICAgKi8gICAgICAgIAogICAgICAgIGlmIChvaWQgaW5zdGFuY2VvZiBP\ncGVuSlBBSWQpIHsKICAgICAgICAgICAgQ2xhc3MgdHlwZSA9IGNscy5nZXRE\nZXNjcmliZWRUeXBlKCk7CiAgICAgICAgICAgIGlmICghc3VicykKICAgICAg\nICAgICAgICAgIC8vIG5vbi1wb2x5bW9ycGhpYyByZWxhdGlvbnMKICAgICAg\nICAgICAgICAgICgoT3BlbkpQQUlkKSBvaWQpLnNldE1hbmFnZWRJbnN0YW5j\nZVR5cGUodHlwZSk7CiAgICAgICAgICAgIGVsc2UgaWYgKGNscy5nZXREaXNj\ncmltaW5hdG9yKCkgIT0gbnVsbAogICAgICAgICAgICAgICAgJiYgIVN0cmlu\nZ1V0aWxzLmVxdWFscygibm9uZSIsCiAgICAgICAgICAgICAgICAgICAgY2xz\nLmdldERpc2NyaW1pbmF0b3IoKS5nZXRTdHJhdGVneSgpLmdldEFsaWFzKCkp\nKSB7CiAgICAgICAgICAgICAgICAvLyBwb2x5bW9ycGhpYyByZWxhdGlvbnMK\nICAgICAgICAgICAgICAgIHJlcy5zdGFydERhdGFSZXF1ZXN0KGNscy5nZXRE\naXNjcmltaW5hdG9yKCkpOwogICAgICAgICAgICAgICAgdHJ5IHsKICAgICAg\nICAgICAgICAgICAgICB0eXBlID0gY2xzLmdldERpc2NyaW1pbmF0b3IoKS5n\nZXRDbGFzcyhzdG9yZSwgY2xzLCByZXMpOwogICAgICAgICAgICAgICAgICAg\nICgoT3BlbkpQQUlkKSBvaWQpLnNldE1hbmFnZWRJbnN0YW5jZVR5cGUodHlw\nZSwgdHJ1ZSk7CiAgICAgICAgICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24g\nZSkgewogICAgICAgICAgICAgICAgICAgIC8vIGludGVudGlvbmFsbHkgaWdu\nb3JlZAogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmVzLmVu\nZERhdGFSZXF1ZXN0KCk7ICAKICAgICAgICAgICAgfSAKICAgICAgICB9CiAg\nICAgICAgcmV0dXJuIG9pZDsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVy\nbiB0aGUgZ2l2ZW4gY29sdW1uIHZhbHVlKHMpIGZvciB0aGUgZ2l2ZW4gb2Jq\nZWN0LiBUaGUgZ2l2ZW4KICAgICAqIGNvbHVtbnMgd2lsbCBiZSBwcmltYXJ5\nIGtleSBjb2x1bW5zIG9mIHRoaXMgbWFwcGluZywgYnV0IG1heSBiZSBpbgog\nICAgICogYW55IG9yZGVyLiBJZiB0aGVyZSBpcyBvbmx5IG9uZSBjb2x1bW4s\nIHJldHVybiBpdHMgdmFsdWUuIElmIHRoZXJlCiAgICAgKiBhcmUgbXVsdGlw\nbGUgY29sdW1ucywgcmV0dXJuIGFuIG9iamVjdCBhcnJheSBvZiB0aGVpciB2\nYWx1ZXMsIGluIHRoZQogICAgICogc2FtZSBvcmRlciB0aGUgY29sdW1ucyBh\ncmUgZ2l2ZW4uCiAgICAgKi8KICAgIHB1YmxpYyBPYmplY3QgdG9EYXRhU3Rv\ncmVWYWx1ZShPYmplY3Qgb2JqLCBDb2x1bW5bXSBjb2xzLCBKREJDU3RvcmUg\nc3RvcmUpIHsKICAgICAgICBPYmplY3QgcmV0ID0gKGNvbHMubGVuZ3RoID09\nIDEpID8gbnVsbCA6IG5ldyBPYmplY3RbY29scy5sZW5ndGhdOwoKICAgICAg\nICAvLyBpbiB0aGUgcGFzdCB3ZSd2ZSBiZWVuIGxlbmllbnQgYWJvdXQgYmVp\nbmcgYWJsZSB0byB0cmFuc2xhdGUgb2JqZWN0cwogICAgICAgIC8vIGZyb20g\nb3RoZXIgcGVyc2lzdGVuY2UgY29udGV4dHMsIHNvIHRyeSB0byBnZXQgc20g\nZGlyZWN0bHkgZnJvbQogICAgICAgIC8vIGluc3RhbmNlIGJlZm9yZSBhc2tp\nbmcgb3VyIGNvbnRleHQKICAgICAgICBPcGVuSlBBU3RhdGVNYW5hZ2VyIHNt\nOwogICAgICAgIGlmIChJbXBsSGVscGVyLmlzTWFuYWdlYWJsZShvYmopKQog\nICAgICAgICAgICBzbSA9IChPcGVuSlBBU3RhdGVNYW5hZ2VyKSAoSW1wbEhl\nbHBlci50b1BlcnNpc3RlbmNlQ2FwYWJsZShvYmosCiAgICAgICAgICAgICAg\nICBnZXRSZXBvc2l0b3J5KCkuZ2V0Q29uZmlndXJhdGlvbigpKSkKICAgICAg\nICAgICAgICAgIC5wY0dldFN0YXRlTWFuYWdlcigpOwogICAgICAgIGVsc2UK\nICAgICAgICAgICAgc20gPSBzdG9yZS5nZXRDb250ZXh0KCkuZ2V0U3RhdGVN\nYW5hZ2VyKG9iaik7CiAgICAgICAgaWYgKHNtID09IG51bGwpCiAgICAgICAg\nICAgIHJldHVybiByZXQ7CgogICAgICAgIE9iamVjdCB2YWw7CiAgICAgICAg\nZm9yIChpbnQgaSA9IDA7IGkgPCBjb2xzLmxlbmd0aDsgaSsrKSB7CiAgICAg\nICAgICAgIHZhbCA9IGFzc2VydEpvaW5hYmxlKGNvbHNbaV0pLmdldEpvaW5W\nYWx1ZShzbSwgY29sc1tpXSwgc3RvcmUpOwogICAgICAgICAgICBpZiAoY29s\ncy5sZW5ndGggPT0gMSkKICAgICAgICAgICAgICAgIHJldCA9IHZhbDsKICAg\nICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgKChPYmplY3RbXSkgcmV0\nKVtpXSA9IHZhbDsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHJldDsKICAg\nIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgam9pbmFibGUgZm9yIHRo\nZSBnaXZlbiBjb2x1bW4sIG9yIHRocm93IGFuIGV4Y2VwdGlvbiBpZgogICAg\nICogbm9uZSBpcyBhdmFpbGFibGUuCiAgICAgKi8KICAgIHB1YmxpYyBKb2lu\nYWJsZSBhc3NlcnRKb2luYWJsZShDb2x1bW4gY29sKSB7CiAgICAgICAgSm9p\nbmFibGUgam9pbiA9IGdldEpvaW5hYmxlKGNvbCk7CiAgICAgICAgaWYgKGpv\naW4gPT0gbnVsbCkKICAgICAgICAgICAgdGhyb3cgbmV3IE1ldGFEYXRhRXhj\nZXB0aW9uKF9sb2MuZ2V0KCJuby1qb2luYWJsZSIsCiAgICAgICAgICAgICAg\nICBjb2wuZ2V0RnVsbE5hbWUoKSkpOwogICAgICAgIHJldHVybiBqb2luOwog\nICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRoZSB7QGxpbmsgSm9pbmFi\nbGV9IGZvciB0aGUgZ2l2ZW4gY29sdW1uLiBBbnkgY29sdW1uIHRoYXQKICAg\nICAqIGFub3RoZXIgbWFwcGluZyBqb2lucyB0byBtdXN0IGJlIGNvbnRyb2xs\nZWQgYnkgYSBqb2luYWJsZS4KICAgICAqLwogICAgcHVibGljIEpvaW5hYmxl\nIGdldEpvaW5hYmxlKENvbHVtbiBjb2wpIHsKICAgICAgICBKb2luYWJsZSBq\nb2luOwogICAgICAgIGlmIChnZXRFbWJlZGRpbmdNZXRhRGF0YSgpICE9IG51\nbGwpIHsKICAgICAgICAgICAgam9pbiA9IGdldEVtYmVkZGluZ01hcHBpbmco\nKS5nZXRGaWVsZE1hcHBpbmcoKS4KICAgICAgICAgICAgICAgIGdldERlZmlu\naW5nTWFwcGluZygpLmdldEpvaW5hYmxlKGNvbCk7CiAgICAgICAgICAgIGlm\nIChqb2luICE9IG51bGwpCiAgICAgICAgICAgICAgICByZXR1cm4gam9pbjsK\nICAgICAgICB9CiAgICAgICAgQ2xhc3NNYXBwaW5nIHN1cCA9IGdldEpvaW5h\nYmxlUENTdXBlcmNsYXNzTWFwcGluZygpOwogICAgICAgIGlmIChzdXAgIT0g\nbnVsbCkgewogICAgICAgICAgICBqb2luID0gc3VwLmdldEpvaW5hYmxlKGNv\nbCk7CiAgICAgICAgICAgIGlmIChqb2luICE9IG51bGwpCiAgICAgICAgICAg\nICAgICByZXR1cm4gam9pbjsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIChK\nb2luYWJsZSkgX2pvaW5hYmxlcy5nZXQoY29sKTsKICAgIH0KCiAgICAvKioK\nICAgICAqIEFkZCB0aGUgZ2l2ZW4gY29sdW1uLXRvLWpvaW5hYmxlIG1hcHBp\nbmcuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldEpvaW5hYmxlKENvbHVt\nbiBjb2wsIEpvaW5hYmxlIGpvaW5hYmxlKSB7CiAgICAgICAgLy8gZG9uJ3Qg\nbGV0IG5vbi1wayBvdmVycmlkZSBwawogICAgICAgIEpvaW5hYmxlIGpvaW4g\nPSAoSm9pbmFibGUpIF9qb2luYWJsZXMuZ2V0KGNvbCk7CiAgICAgICAgaWYg\nKGpvaW4gPT0gbnVsbCB8fCAoam9pbi5nZXRGaWVsZEluZGV4KCkgIT0gLTEK\nICAgICAgICAgICAgJiYgZ2V0RmllbGQoam9pbi5nZXRGaWVsZEluZGV4KCkp\nLmdldFByaW1hcnlLZXlJbmRleCgpID09IC0xKSkKICAgICAgICAgICAgX2pv\naW5hYmxlcy5wdXQoY29sLCBqb2luYWJsZSk7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBSZXR1cm4gd2hldGhlciB0aGUgY29sdW1ucyBvZiB0aGUgZ2l2ZW4g\nZm9yZWlnbiBrZXkgdG8gdGhpcyBtYXBwaW5nCiAgICAgKiBjYW4gYmUgdXNl\nZCB0byBjb25zdHJ1Y3QgYW4gb2JqZWN0IGlkIGZvciB0aGlzIHR5cGUuIFRo\naXMgaXMgYQogICAgICogcmVsYXRpdmVseSBleHBlbnNpdmUgb3BlcmF0aW9u\nOyBpdHMgcmVzdWx0cyBzaG91bGQgYmUgY2FjaGVkLgogICAgICoKICAgICAq\nIEByZXR1cm4ge0BsaW5rIEJvb2xlYW4jVFJVRX0gaWYgdGhlIGZvcmVpZ24g\na2V5IGNvbnRhaW5zIGFsbCBvaWQKICAgICAqIGNvbHVtbnMsIDxjb2RlPm51\nbGw8L2NvZGU+IGlmIGl0IGNvbnRhaW5zIG9ubHkgc29tZSBjb2x1bW5zLAog\nICAgICogb3Ige0BsaW5rIEJvb2xlYW4jRkFMU0V9IGlmIGl0IGNvbnRhaW5z\nIG5vbi1vaWQgY29sdW1ucwogICAgICovCiAgICBwdWJsaWMgQm9vbGVhbiBp\nc0ZvcmVpZ25LZXlPYmplY3RJZChGb3JlaWduS2V5IGZrKSB7CiAgICAgICAg\nLy8gaWYgdGhpcyBtYXBwaW5nJ3MgcHJpbWFyeSBrZXkgY2FuJ3QgY29uc3Ry\ndWN0IGFuIG9pZCwgdGhlbiBubyB3YXkKICAgICAgICAvLyBmb3JlaWduIGtl\neSBjYW4KICAgICAgICBpZiAoZ2V0SWRlbnRpdHlUeXBlKCkgPT0gSURfVU5L\nTk9XTiB8fCAhaXNQcmltYXJ5S2V5T2JqZWN0SWQoZmFsc2UpKQogICAgICAg\nICAgICByZXR1cm4gQm9vbGVhbi5GQUxTRTsKCiAgICAgICAgLy8gd2l0aCBk\nYXRhc3RvcmUgaWRlbnRpdHksIGl0J3MgYWxsIG9yIG5vdGhpbmcKICAgICAg\nICBDb2x1bW5bXSBjb2xzID0gZmsuZ2V0UHJpbWFyeUtleUNvbHVtbnMoKTsK\nICAgICAgICBpZiAoZ2V0SWRlbnRpdHlUeXBlKCkgPT0gSURfREFUQVNUT1JF\nKSB7CiAgICAgICAgICAgIGlmIChjb2xzLmxlbmd0aCAhPSAxIHx8IGNvbHNb\nMF0gIT0gZ2V0UHJpbWFyeUtleUNvbHVtbnMoKVswXSkKICAgICAgICAgICAg\nICAgIHJldHVybiBCb29sZWFuLkZBTFNFOwogICAgICAgICAgICByZXR1cm4g\nQm9vbGVhbi5UUlVFOwogICAgICAgIH0KCiAgICAgICAgLy8gY2hlY2sgdGhl\nIGpvaW4gbWFwcGluZyBmb3IgZWFjaCBwayBjb2x1bW4gdG8gc2VlIGlmIGl0\nIGxpbmtzIHVwIHRvCiAgICAgICAgLy8gYSBwcmltYXJ5IGtleSBmaWVsZAog\nICAgICAgIEpvaW5hYmxlIGpvaW47CiAgICAgICAgZm9yIChpbnQgaSA9IDA7\nIGkgPCBjb2xzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGpvaW4gPSBh\nc3NlcnRKb2luYWJsZShjb2xzW2ldKTsKICAgICAgICAgICAgaWYgKGpvaW4u\nZ2V0RmllbGRJbmRleCgpICE9IC0xCiAgICAgICAgICAgICAgICAmJiBnZXRG\naWVsZChqb2luLmdldEZpZWxkSW5kZXgoKSkuZ2V0UHJpbWFyeUtleUluZGV4\nKCkgPT0gLTEpCiAgICAgICAgICAgICAgICByZXR1cm4gQm9vbGVhbi5GQUxT\nRTsKICAgICAgICB9CgogICAgICAgIC8vIGlmIGFsbCBwcmltYXJ5IGtleSBs\naW5rcywgc2VlIHdoZXRoZXIgd2Ugam9pbiB0byBhbGwgcGtzCiAgICAgICAg\naWYgKGlzUHJpbWFyeUtleU9iamVjdElkKHRydWUpCiAgICAgICAgICAgICYm\nIGNvbHMubGVuZ3RoID09IGdldFByaW1hcnlLZXlDb2x1bW5zKCkubGVuZ3Ro\nKQogICAgICAgICAgICByZXR1cm4gQm9vbGVhbi5UUlVFOwogICAgICAgIHJl\ndHVybiBudWxsOwogICAgfQoKICAgIC8vLy8vLy8KICAgIC8vIE9STQogICAg\nLy8vLy8vLwoKICAgIC8qKgogICAgICogUmF3IG1hcHBpbmcgZGF0YS4KICAg\nICAqLwogICAgcHVibGljIENsYXNzTWFwcGluZ0luZm8gZ2V0TWFwcGluZ0lu\nZm8oKSB7CiAgICAgICAgcmV0dXJuIF9pbmZvOwogICAgfQoKICAgIC8qKgog\nICAgICogVGhlIHN0cmF0ZWd5IHVzZWQgdG8gbWFwIHRoaXMgbWFwcGluZy4K\nICAgICAqLwogICAgcHVibGljIENsYXNzU3RyYXRlZ3kgZ2V0U3RyYXRlZ3ko\nKSB7CiAgICAgICAgcmV0dXJuIF9zdHJhdGVneTsKICAgIH0KCiAgICAvKioK\nICAgICAqIFRoZSBzdHJhdGVneSB1c2VkIHRvIG1hcCB0aGlzIG1hcHBpbmcu\nIFRoZSA8Y29kZT5hZGFwdDwvY29kZT4KICAgICAqIHBhcmFtZXRlciBkZXRl\ncm1pbmVzIHdoZXRoZXIgdG8gYWRhcHQgd2hlbiBtYXBwaW5nIHRoZSBzdHJh\ndGVneTsKICAgICAqIHVzZSBudWxsIGlmIHRoZSBzdHJhdGVneSBzaG91bGQg\nbm90IGJlIG1hcHBlZC4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0U3Ry\nYXRlZ3koQ2xhc3NTdHJhdGVneSBzdHJhdGVneSwgQm9vbGVhbiBhZGFwdCkg\newogICAgICAgIC8vIHNldCBzdHJhdGVneSBmaXJzdCBzbyB3ZSBjYW4gYWNj\nZXNzIGl0IGR1cmluZyBtYXBwaW5nCiAgICAgICAgQ2xhc3NTdHJhdGVneSBv\ncmlnID0gX3N0cmF0ZWd5OwogICAgICAgIF9zdHJhdGVneSA9IHN0cmF0ZWd5\nOwogICAgICAgIGlmIChzdHJhdGVneSAhPSBudWxsKSB7CiAgICAgICAgICAg\nIHRyeSB7CiAgICAgICAgICAgICAgICBzdHJhdGVneS5zZXRDbGFzc01hcHBp\nbmcodGhpcyk7CiAgICAgICAgICAgICAgICBpZiAoYWRhcHQgIT0gbnVsbCkK\nICAgICAgICAgICAgICAgICAgICBzdHJhdGVneS5tYXAoYWRhcHQuYm9vbGVh\nblZhbHVlKCkpOwogICAgICAgICAgICB9IGNhdGNoIChSdW50aW1lRXhjZXB0\naW9uIHJlKSB7CiAgICAgICAgICAgICAgICAvLyByZXNldCBzdHJhdGVneQog\nICAgICAgICAgICAgICAgX3N0cmF0ZWd5ID0gb3JpZzsKICAgICAgICAgICAg\nICAgIHRocm93IHJlOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQoK\nICAgIC8qKgogICAgICogVGhlIG1hcHBpbmcncyBwcmltYXJ5IHRhYmxlLgog\nICAgICovCiAgICBwdWJsaWMgVGFibGUgZ2V0VGFibGUoKSB7CiAgICAgICAg\ncmV0dXJuIF90YWJsZTsKICAgIH0KCiAgICAvKioKICAgICAqIFRoZSBtYXBw\naW5nJ3MgcHJpbWFyeSB0YWJsZS4KICAgICAqLwogICAgcHVibGljIHZvaWQg\nc2V0VGFibGUoVGFibGUgdGFibGUpIHsKICAgICAgICBfdGFibGUgPSB0YWJs\nZTsKICAgIH0KCiAgICAvKioKICAgICAqIFRoZSBjb2x1bW5zIHRoaXMgbWFw\ncGluZyB1c2VzIHRvIHVuaXF1ZWx5IGlkZW50aWZ5IGFuIG9iamVjdC4KICAg\nICAqIFRoZXNlIHdpbGwgdHlwaWNhbGx5IGJlIHRoZSBwcmltYXJ5IGtleSBj\nb2x1bW5zIG9yIHRoZSBjb2x1bW5zIHRoaXMKICAgICAqIGNsYXNzIHVzZXMg\ndG8gbGluayB0byBpdHMgc3VwZXJjbGFzcyB0YWJsZS4KICAgICAqLwogICAg\ncHVibGljIENvbHVtbltdIGdldFByaW1hcnlLZXlDb2x1bW5zKCkgewogICAg\nICAgIGlmIChfY29scy5sZW5ndGggPT0gMCAmJiBnZXRJZGVudGl0eVR5cGUo\nKSA9PSBJRF9BUFBMSUNBVElPTgogICAgICAgICAgICAmJiBpc01hcHBlZCgp\nKSB7CiAgICAgICAgICAgIEZpZWxkTWFwcGluZ1tdIHBrcyA9IGdldFByaW1h\ncnlLZXlGaWVsZE1hcHBpbmdzKCk7CiAgICAgICAgICAgIENvbGxlY3Rpb24g\nY29scyA9IG5ldyBBcnJheUxpc3QocGtzLmxlbmd0aCk7CiAgICAgICAgICAg\nIENvbHVtbltdIGZpZWxkQ29sczsKICAgICAgICAgICAgZm9yIChpbnQgaSA9\nIDA7IGkgPCBwa3MubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICAgIGZp\nZWxkQ29scyA9IHBrc1tpXS5nZXRDb2x1bW5zKCk7CiAgICAgICAgICAgICAg\nICBmb3IgKGludCBqID0gMDsgaiA8IGZpZWxkQ29scy5sZW5ndGg7IGorKykK\nICAgICAgICAgICAgICAgICAgICBjb2xzLmFkZChmaWVsZENvbHNbal0pOwog\nICAgICAgICAgICB9CiAgICAgICAgICAgIF9jb2xzID0gKENvbHVtbltdKSBj\nb2xzLnRvQXJyYXkobmV3IENvbHVtbltjb2xzLnNpemUoKV0pOwogICAgICAg\nIH0KICAgICAgICByZXR1cm4gX2NvbHM7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBUaGUgY29sdW1ucyB0aGlzIG1hcHBpbmcgdXNlcyB0byB1bmlxdWVseSBp\nZGVudGlmeSBhbiBvYmplY3QuCiAgICAgKiBUaGVzZSB3aWxsIHR5cGljYWxs\neSBiZSB0aGUgcHJpbWFyeSBrZXkgY29sdW1ucyBvciB0aGUgY29sdW1ucyB0\naGlzCiAgICAgKiBjbGFzcyB1c2VzIHRvIGxpbmsgdG8gaXRzIHN1cGVyY2xh\nc3MgdGFibGUuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldFByaW1hcnlL\nZXlDb2x1bW5zKENvbHVtbltdIGNvbHMpIHsKICAgICAgICBpZiAoY29scyA9\nPSBudWxsKQogICAgICAgICAgICBjb2xzID0gU2NoZW1hcy5FTVBUWV9DT0xV\nTU5TOwogICAgICAgIF9jb2xzID0gY29sczsKICAgIH0KCiAgICAvKioKICAg\nICAqIEkvTyBpbmZvcm1hdGlvbiBvbiB0aGUga2V5IGNvbHVtbnMgLyBqb2lu\nIGtleS4KICAgICAqLwogICAgcHVibGljIENvbHVtbklPIGdldENvbHVtbklP\nKCkgewogICAgICAgIHJldHVybiAoX2lvID09IG51bGwpID8gQ29sdW1uSU8u\nVU5SRVNUUklDVEVEIDogX2lvOwogICAgfQoKICAgIC8qKgogICAgICogSS9P\nIGluZm9ybWF0aW9uIG9uIHRoZSBrZXkgY29sdW1ucyAvIGpvaW4ga2V5Lgog\nICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRDb2x1bW5JTyhDb2x1bW5JTyBp\nbykgewogICAgICAgIF9pbyA9IGlvOwogICAgfQoKICAgIC8qKgogICAgICog\nRm9yZWlnbiBrZXkgbGlua2luZyB0aGUgcHJpbWFyeSBrZXkgY29sdW1ucyB0\nbyB0aGUgc3VwZXJjbGFzcyB0YWJsZSwKICAgICAqIG9yIG51bGwgaWYgbm9u\nZS4KICAgICAqLwogICAgcHVibGljIEZvcmVpZ25LZXkgZ2V0Sm9pbkZvcmVp\nZ25LZXkoKSB7CiAgICAgICAgcmV0dXJuIF9mazsKICAgIH0KCiAgICAvKioK\nICAgICAqIEZvcmVpZ24ga2V5IGxpbmtpbmcgdGhlIHByaW1hcnkga2V5IGNv\nbHVtbnMgdG8gdGhlIHN1cGVyY2xhc3MgdGFibGUsCiAgICAgKiBvciBudWxs\nIGlmIG5vbmUuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldEpvaW5Gb3Jl\naWduS2V5KEZvcmVpZ25LZXkgZmspIHsKICAgICAgICBfZmsgPSBmazsKICAg\nIH0KCiAgICBwdWJsaWMgdm9pZCByZWZTY2hlbWFDb21wb25lbnRzKCkgewog\nICAgICAgIGlmIChnZXRFbWJlZGRpbmdNZXRhRGF0YSgpID09IG51bGwpIHsK\nICAgICAgICAgICAgaWYgKF90YWJsZSAhPSBudWxsICYmIF90YWJsZS5nZXRQ\ncmltYXJ5S2V5KCkgIT0gbnVsbCkKICAgICAgICAgICAgICAgIF90YWJsZS5n\nZXRQcmltYXJ5S2V5KCkucmVmKCk7CiAgICAgICAgICAgIGlmIChfZmsgIT0g\nbnVsbCkKICAgICAgICAgICAgICAgIF9may5yZWYoKTsKICAgICAgICAgICAg\nQ29sdW1uW10gcGtzID0gZ2V0UHJpbWFyeUtleUNvbHVtbnMoKTsKICAgICAg\nICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBwa3MubGVuZ3RoOyBpKyspCiAg\nICAgICAgICAgICAgICBwa3NbaV0ucmVmKCk7CiAgICAgICAgfSBlbHNlIHsK\nICAgICAgICAgICAgRmllbGRNYXBwaW5nW10gZmllbGRzID0gZ2V0RmllbGRN\nYXBwaW5ncygpOwogICAgICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGZp\nZWxkcy5sZW5ndGg7IGkrKykKICAgICAgICAgICAgICAgIGZpZWxkc1tpXS5y\nZWZTY2hlbWFDb21wb25lbnRzKCk7CiAgICAgICAgfQogICAgfQoKICAgIC8q\nKgogICAgICogQ2xlYXIgbWFwcGluZyBpbmZvcm1hdGlvbiwgaW5jbHVkaW5n\nIHN0cmF0ZWd5LgogICAgICovCiAgICBwdWJsaWMgdm9pZCBjbGVhck1hcHBp\nbmcoKSB7CiAgICAgICAgX3N0cmF0ZWd5ID0gbnVsbDsKICAgICAgICBfY29s\ncyA9IFNjaGVtYXMuRU1QVFlfQ09MVU1OUzsKICAgICAgICBfZmsgPSBudWxs\nOwogICAgICAgIF90YWJsZSA9IG51bGw7CiAgICAgICAgX2luZm8uY2xlYXIo\nKTsKICAgICAgICBzZXRSZXNvbHZlKE1PREVfTUFQUElORyB8IE1PREVfTUFQ\nUElOR19JTklULCBmYWxzZSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBVcGRh\ndGUge0BsaW5rIE1hcHBpbmdJbmZvfSB3aXRoIG91ciBjdXJyZW50IG1hcHBp\nbmcgaW5mb3JtYXRpb24uCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHN5bmNN\nYXBwaW5nSW5mbygpIHsKICAgICAgICBpZiAoZ2V0RW1iZWRkaW5nTWV0YURh\ndGEoKSA9PSBudWxsKQogICAgICAgICAgICBfaW5mby5zeW5jV2l0aCh0aGlz\nKTsKICAgICAgICBlbHNlIHsKICAgICAgICAgICAgX2luZm8uY2xlYXIoKTsK\nICAgICAgICAgICAgRmllbGRNYXBwaW5nW10gZmllbGRzID0gZ2V0RmllbGRN\nYXBwaW5ncygpOwogICAgICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGZp\nZWxkcy5sZW5ndGg7IGkrKykKICAgICAgICAgICAgICAgIGZpZWxkc1tpXS5z\neW5jTWFwcGluZ0luZm8oKTsKICAgICAgICB9CiAgICB9CgogICAgLy8vLy8v\nLy8vLy8vLy8vLy8vLy8vLwogICAgLy8gTWV0YURhdGEgaW50ZXJmYWNlCiAg\nICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vCgogICAgcHJvdGVjdGVkIHZvaWQg\nc2V0RGVzY3JpYmVkVHlwZShDbGFzcyB0eXBlKSB7CiAgICAgICAgc3VwZXIu\nc2V0RGVzY3JpYmVkVHlwZSh0eXBlKTsKICAgICAgICAvLyB0aGlzIG1ldGhv\nZCBjYWxsZWQgZnJvbSBzdXBlcmNsYXNzIGNvbnN0cnVjdG9yLCBzbyBfaW5m\nbyBub3QgeWV0CiAgICAgICAgLy8gaW5pdGlhbGl6ZWQKICAgICAgICBpZiAo\nX2luZm8gIT0gbnVsbCkKICAgICAgICAgICAgX2luZm8uc2V0Q2xhc3NOYW1l\nKHR5cGUuZ2V0TmFtZSgpKTsKICAgIH0KCiAgICAvKioKICAgICAqIFRoZSBz\ndWJjbGFzcyBmZXRjaCBtb2RlLCBhcyBvbmUgb2YgdGhlIGVhZ2VyIGNvbnN0\nYW50cyBpbgogICAgICoge0BsaW5rIEpEQkNGZXRjaENvbmZpZ3VyYXRpb259\nLgogICAgICovCiAgICBwdWJsaWMgaW50IGdldFN1YmNsYXNzRmV0Y2hNb2Rl\nKCkgewogICAgICAgIGlmIChfc3ViY2xhc3NNb2RlID09IEludGVnZXIuTUFY\nX1ZBTFVFKSB7CiAgICAgICAgICAgIGlmIChnZXRQQ1N1cGVyY2xhc3MoKSAh\nPSBudWxsKQogICAgICAgICAgICAgICAgX3N1YmNsYXNzTW9kZSA9IGdldFBD\nU3VwZXJjbGFzc01hcHBpbmcoKS4KICAgICAgICAgICAgICAgICAgICBnZXRT\ndWJjbGFzc0ZldGNoTW9kZSgpOwogICAgICAgICAgICBlbHNlCiAgICAgICAg\nICAgICAgICBfc3ViY2xhc3NNb2RlID0gRmV0Y2hDb25maWd1cmF0aW9uLkRF\nRkFVTFQ7CiAgICAgICAgfQogICAgICAgIHJldHVybiBfc3ViY2xhc3NNb2Rl\nOwogICAgfQoKICAgIC8qKgogICAgICogVGhlIHN1YmNsYXNzIGZldGNoIG1v\nZGUsIGFzIG9uZSBvZiB0aGUgZWFnZXIgY29uc3RhbnRzIGluCiAgICAgKiB7\nQGxpbmsgSkRCQ0ZldGNoQ29uZmlndXJhdGlvbn0uCiAgICAgKi8KICAgIHB1\nYmxpYyB2b2lkIHNldFN1YmNsYXNzRmV0Y2hNb2RlKGludCBtb2RlKSB7CiAg\nICAgICAgX3N1YmNsYXNzTW9kZSA9IG1vZGU7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBDb252ZW5pZW5jZSBtZXRob2QgdG8gcGVyZm9ybSBjYXN0IGZyb20K\nICAgICAqIHtAbGluayBDbGFzc01ldGFEYXRhI2dldFJlcG9zaXRvcnl9Lgog\nICAgICovCiAgICBwdWJsaWMgTWFwcGluZ1JlcG9zaXRvcnkgZ2V0TWFwcGlu\nZ1JlcG9zaXRvcnkoKSB7CiAgICAgICAgcmV0dXJuIChNYXBwaW5nUmVwb3Np\ndG9yeSkgZ2V0UmVwb3NpdG9yeSgpOwogICAgfQoKICAgIC8qKgogICAgICog\nQ29udmVuaWVuY2UgbWV0aG9kIHRvIHBlcmZvcm0gY2FzdCBmcm9tCiAgICAg\nKiB7QGxpbmsgQ2xhc3NNZXRhRGF0YSNnZXRFbWJlZGRpbmdNZXRhRGF0YX0K\nICAgICAqLwogICAgcHVibGljIFZhbHVlTWFwcGluZyBnZXRFbWJlZGRpbmdN\nYXBwaW5nKCkgewogICAgICAgIHJldHVybiAoVmFsdWVNYXBwaW5nKSBnZXRF\nbWJlZGRpbmdNZXRhRGF0YSgpOwogICAgfQoKICAgIC8qKgogICAgICogUmV0\ndXJucyB0cnVlIGlmIHRoaXMgY2xhc3MgZG9lcyBub3QgdXNlIHRoZSAibm9u\nZSIgc3RyYXRlZ3kgKGluY2x1ZGluZwogICAgICogaWYgaXQgaGFzIGEgbnVs\nbCBzdHJhdGVneSwgYW5kIHRoZXJlZm9yZSBpcyBwcm9iYWJseSBpbiB0aGUg\ncHJvY2VzcyBvZgogICAgICogYmVpbmcgbWFwcGVkKS4KICAgICAqLwogICAg\ncHVibGljIGJvb2xlYW4gaXNNYXBwZWQoKSB7CiAgICAgICAgaWYgKCFzdXBl\nci5pc01hcHBlZCgpKQogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAg\nICAgaWYgKF9zdHJhdGVneSAhPSBudWxsKQogICAgICAgICAgICByZXR1cm4g\nX3N0cmF0ZWd5ICE9IE5vbmVDbGFzc1N0cmF0ZWd5LmdldEluc3RhbmNlKCk7\nCiAgICAgICAgcmV0dXJuICFOb25lQ2xhc3NTdHJhdGVneS5BTElBUy5lcXVh\nbHMoX2luZm8uZ2V0U3RyYXRlZ3koKSk7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBDb252ZW5pZW5jZSBtZXRob2QgdG8gcGVyZm9ybSBjYXN0IGZyb20KICAg\nICAqIHtAbGluayBDbGFzc01ldGFEYXRhI2dldFBDU3VwZXJjbGFzc01ldGFE\nYXRhfS4KICAgICAqLwogICAgcHVibGljIENsYXNzTWFwcGluZyBnZXRQQ1N1\ncGVyY2xhc3NNYXBwaW5nKCkgewogICAgICAgIHJldHVybiAoQ2xhc3NNYXBw\naW5nKSBnZXRQQ1N1cGVyY2xhc3NNZXRhRGF0YSgpOwogICAgfQoKICAgIC8q\nKgogICAgICogQ29udmVuaWVuY2UgbWV0aG9kIHRvIHBlcmZvcm0gY2FzdCBm\ncm9tCiAgICAgKiB7QGxpbmsgQ2xhc3NNZXRhRGF0YSNnZXRNYXBwZWRQQ1N1\ncGVyY2xhc3NNZXRhRGF0YX0uCiAgICAgKi8KICAgIHB1YmxpYyBDbGFzc01h\ncHBpbmcgZ2V0TWFwcGVkUENTdXBlcmNsYXNzTWFwcGluZygpIHsKICAgICAg\nICByZXR1cm4gKENsYXNzTWFwcGluZykgZ2V0TWFwcGVkUENTdXBlcmNsYXNz\nTWV0YURhdGEoKTsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0aGUg\nbmVhcmVzdCBtYXBwZWQgc3VwZXJjbGFzcyB0aGF0IGNhbiBqb2luIHRvIHRo\naXMgY2xhc3MuCiAgICAgKi8KICAgIHB1YmxpYyBDbGFzc01hcHBpbmcgZ2V0\nSm9pbmFibGVQQ1N1cGVyY2xhc3NNYXBwaW5nKCkgewogICAgICAgIENsYXNz\nTWFwcGluZyBzdXAgPSBnZXRNYXBwZWRQQ1N1cGVyY2xhc3NNYXBwaW5nKCk7\nCiAgICAgICAgaWYgKHN1cCA9PSBudWxsKQogICAgICAgICAgICByZXR1cm4g\nbnVsbDsKICAgICAgICBpZiAoX2ZrICE9IG51bGwgfHwgX3RhYmxlID09IG51\nbGwgfHwgX3RhYmxlLmVxdWFscyhzdXAuZ2V0VGFibGUoKSkpCiAgICAgICAg\nICAgIHJldHVybiBzdXA7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBDb252ZW5pZW5jZSBtZXRob2QgdG8gcGVyZm9ybSBj\nYXN0IGZyb20KICAgICAqIHtAbGluayBDbGFzc01ldGFEYXRhI2dldFBDU3Vi\nY2xhc3NNZXRhRGF0YXN9LgogICAgICovCiAgICBwdWJsaWMgQ2xhc3NNYXBw\naW5nW10gZ2V0UENTdWJjbGFzc01hcHBpbmdzKCkgewogICAgICAgIHJldHVy\nbiAoQ2xhc3NNYXBwaW5nW10pIGdldFBDU3ViY2xhc3NNZXRhRGF0YXMoKTsK\nICAgIH0KCiAgICAvKioKICAgICAqIENvbnZlbmllbmNlIG1ldGhvZCB0byBw\nZXJmb3JtIGNhc3QgZnJvbQogICAgICoge0BsaW5rIENsYXNzTWV0YURhdGEj\nZ2V0TWFwcGVkUENTdWJjbGFzc01ldGFEYXRhc30uCiAgICAgKi8KICAgIHB1\nYmxpYyBDbGFzc01hcHBpbmdbXSBnZXRNYXBwZWRQQ1N1YmNsYXNzTWFwcGlu\nZ3MoKSB7CiAgICAgICAgcmV0dXJuIChDbGFzc01hcHBpbmdbXSkgZ2V0TWFw\ncGVkUENTdWJjbGFzc01ldGFEYXRhcygpOwogICAgfQoKICAgIC8qKgogICAg\nICogUmV0dXJuIG1hcHBlZCBzdWJjbGFzc2VzIHRoYXQgYXJlIHJlYWNoYWJs\nZSB2aWEgam9pbnMuCiAgICAgKi8KICAgIHB1YmxpYyBDbGFzc01hcHBpbmdb\nXSBnZXRKb2luYWJsZVBDU3ViY2xhc3NNYXBwaW5ncygpIHsKICAgICAgICBD\nbGFzc01hcHBpbmdbXSBzdWJzID0gZ2V0TWFwcGVkUENTdWJjbGFzc01hcHBp\nbmdzKCk7IC8vIGNoZWNrcyBmb3IgbmV3CiAgICAgICAgaWYgKF9qb2luU3Vi\nTWFwcyA9PSBudWxsKSB7CiAgICAgICAgICAgIGlmIChzdWJzLmxlbmd0aCA9\nPSAwKQogICAgICAgICAgICAgICAgX2pvaW5TdWJNYXBzID0gc3ViczsKICAg\nICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICBMaXN0IGpvaW5hYmxl\nID0gbmV3IEFycmF5TGlzdChzdWJzLmxlbmd0aCk7CiAgICAgICAgICAgICAg\nICBmb3IgKGludCBpID0gMDsgaSA8IHN1YnMubGVuZ3RoOyBpKyspCiAgICAg\nICAgICAgICAgICAgICAgaWYgKGlzU3ViSm9pbmFibGUoc3Vic1tpXSkpCiAg\nICAgICAgICAgICAgICAgICAgICAgIGpvaW5hYmxlLmFkZChzdWJzW2ldKTsK\nICAgICAgICAgICAgICAgIF9qb2luU3ViTWFwcyA9IChDbGFzc01hcHBpbmdb\nXSkgam9pbmFibGUudG9BcnJheQogICAgICAgICAgICAgICAgICAgIChuZXcg\nQ2xhc3NNYXBwaW5nW2pvaW5hYmxlLnNpemUoKV0pOwogICAgICAgICAgICB9\nCiAgICAgICAgfQogICAgICAgIHJldHVybiBfam9pblN1Yk1hcHM7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBSZXR1cm4gd2hldGhlciB3ZSBjYW4gcmVhY2gg\ndGhlIGdpdmVuIHN1YmNsYXNzIHZpYSBqb2lucy4KICAgICAqLwogICAgcHJp\ndmF0ZSBib29sZWFuIGlzU3ViSm9pbmFibGUoQ2xhc3NNYXBwaW5nIHN1Yikg\newogICAgICAgIGlmIChzdWIgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJu\nIGZhbHNlOwogICAgICAgIGlmIChzdWIgPT0gdGhpcykKICAgICAgICAgICAg\ncmV0dXJuIHRydWU7CiAgICAgICAgcmV0dXJuIGlzU3ViSm9pbmFibGUoc3Vi\nLmdldEpvaW5hYmxlUENTdXBlcmNsYXNzTWFwcGluZygpKTsKICAgIH0KCiAg\nICAvKioKICAgICAqIFJldHVybnMgdGhlIGNsb3Nlc3QtZGVyaXZlZCBsaXN0\nIG9mIG5vbi1pbnRlci1qb2luYWJsZSBtYXBwZWQgdHlwZXMKICAgICAqIGFz\nc2lnbmFibGUgdG8gdGhpcyB0eXBlLiBNYXkgcmV0dXJuIHRoaXMgbWFwcGlu\nZy4KICAgICAqLwogICAgcHVibGljIENsYXNzTWFwcGluZ1tdIGdldEluZGVw\nZW5kZW50QXNzaWduYWJsZU1hcHBpbmdzKCkgewogICAgICAgIENsYXNzTWFw\ncGluZ1tdIHN1YnMgPSBnZXRNYXBwZWRQQ1N1YmNsYXNzTWFwcGluZ3MoKTsg\nLy8gY2hlY2tzIGZvciBuZXcKICAgICAgICBpZiAoX2Fzc2lnbk1hcHMgPT0g\nbnVsbCkgewogICAgICAgICAgICAvLyByZW1vdmUgdW5tYXBwZWQgc3Vicwog\nICAgICAgICAgICBpZiAoc3Vicy5sZW5ndGggPT0gMCkgewogICAgICAgICAg\nICAgICAgaWYgKGlzTWFwcGVkKCkpCiAgICAgICAgICAgICAgICAgICAgX2Fz\nc2lnbk1hcHMgPSBuZXcgQ2xhc3NNYXBwaW5nW117IHRoaXMgfTsKICAgICAg\nICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICBfYXNzaWduTWFw\ncyA9IHN1YnM7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAg\nICBpbnQgc2l6ZSA9IChpbnQpIChzdWJzLmxlbmd0aCAqIDEuMzMgKyAyKTsK\nICAgICAgICAgICAgICAgIFNldCBpbmRlcGVuZGVudCA9IG5ldyBMaW5rZWRI\nYXNoU2V0KHNpemUpOwogICAgICAgICAgICAgICAgaWYgKGlzTWFwcGVkKCkp\nCiAgICAgICAgICAgICAgICAgICAgaW5kZXBlbmRlbnQuYWRkKHRoaXMpOwog\nICAgICAgICAgICAgICAgaW5kZXBlbmRlbnQuYWRkQWxsKEFycmF5cy5hc0xp\nc3Qoc3VicykpOwoKICAgICAgICAgICAgICAgIC8vIHJlbW92ZSBhbGwgbWFw\ncGluZ3MgdGhhdCBoYXZlIGEgc3VwZXJjbGFzcyBtYXBwaW5nIGluIHRoZSBz\nZXQKICAgICAgICAgICAgICAgIENsYXNzTWFwcGluZyBtYXAsIHN1cDsKICAg\nICAgICAgICAgICAgIExpc3QgY2xlYXIgPSBudWxsOwogICAgICAgICAgICAg\nICAgZm9yIChJdGVyYXRvciBpdHIgPSBpbmRlcGVuZGVudC5pdGVyYXRvcigp\nOyBpdHIuaGFzTmV4dCgpOykgewogICAgICAgICAgICAgICAgICAgIG1hcCA9\nIChDbGFzc01hcHBpbmcpIGl0ci5uZXh0KCk7CiAgICAgICAgICAgICAgICAg\nICAgc3VwID0gbWFwLmdldEpvaW5hYmxlUENTdXBlcmNsYXNzTWFwcGluZygp\nOwogICAgICAgICAgICAgICAgICAgIGlmIChzdXAgIT0gbnVsbCAmJiBpbmRl\ncGVuZGVudC5jb250YWlucyhzdXApKSB7CiAgICAgICAgICAgICAgICAgICAg\nICAgIGlmIChjbGVhciA9PSBudWxsKQogICAgICAgICAgICAgICAgICAgICAg\nICAgICAgY2xlYXIgPSBuZXcgQXJyYXlMaXN0KGluZGVwZW5kZW50LnNpemUo\nKSAtIDEpOwogICAgICAgICAgICAgICAgICAgICAgICBjbGVhci5hZGQobWFw\nKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAg\nICAgICAgICAgICAgICBpZiAoY2xlYXIgIT0gbnVsbCkKICAgICAgICAgICAg\nICAgICAgICBpbmRlcGVuZGVudC5yZW1vdmVBbGwoY2xlYXIpOwoKICAgICAg\nICAgICAgICAgIF9hc3NpZ25NYXBzID0gKENsYXNzTWFwcGluZ1tdKSBpbmRl\ncGVuZGVudC50b0FycmF5CiAgICAgICAgICAgICAgICAgICAgKG5ldyBDbGFz\nc01hcHBpbmdbaW5kZXBlbmRlbnQuc2l6ZSgpXSk7CiAgICAgICAgICAgIH0K\nICAgICAgICB9CiAgICAgICAgcmV0dXJuIF9hc3NpZ25NYXBzOwogICAgfQoK\nICAgIC8qKgogICAgICogQ29udmVuaWVuY2UgbWV0aG9kIHRvIHBlcmZvcm0g\nY2FzdCBmcm9tIHtAbGluayBDbGFzc01ldGFEYXRhI2dldEZpZWxkc30uCiAg\nICAgKi8KICAgIHB1YmxpYyBGaWVsZE1hcHBpbmdbXSBnZXRGaWVsZE1hcHBp\nbmdzKCkgewogICAgICAgIHJldHVybiAoRmllbGRNYXBwaW5nW10pIGdldEZp\nZWxkcygpOwogICAgfQoKICAgIC8qKgogICAgICogQ29udmVuaWVuY2UgbWV0\naG9kIHRvIHBlcmZvcm0gY2FzdCBmcm9tCiAgICAgKiB7QGxpbmsgQ2xhc3NN\nZXRhRGF0YSNnZXREZWNsYXJlZEZpZWxkc30uCiAgICAgKi8KICAgIHB1Ymxp\nYyBGaWVsZE1hcHBpbmdbXSBnZXREZWNsYXJlZEZpZWxkTWFwcGluZ3MoKSB7\nCiAgICAgICAgcmV0dXJuIChGaWVsZE1hcHBpbmdbXSkgZ2V0RGVjbGFyZWRG\naWVsZHMoKTsKICAgIH0KCiAgICAvKioKICAgICAqIENvbnZlbmllbmNlIG1l\ndGhvZCB0byBwZXJmb3JtIGNhc3QgZnJvbQogICAgICoge0BsaW5rIENsYXNz\nTWV0YURhdGEjZ2V0UHJpbWFyeUtleUZpZWxkc30uCiAgICAgKi8KICAgIHB1\nYmxpYyBGaWVsZE1hcHBpbmdbXSBnZXRQcmltYXJ5S2V5RmllbGRNYXBwaW5n\ncygpIHsKICAgICAgICByZXR1cm4gKEZpZWxkTWFwcGluZ1tdKSBnZXRQcmlt\nYXJ5S2V5RmllbGRzKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBDb252ZW5p\nZW5jZSBtZXRob2QgdG8gcGVyZm9ybSBjYXN0IGZyb20KICAgICAqIHtAbGlu\nayBDbGFzc01ldGFEYXRhI2dldFZlcnNpb25GaWVsZH0uCiAgICAgKi8KICAg\nIHB1YmxpYyBGaWVsZE1hcHBpbmcgZ2V0VmVyc2lvbkZpZWxkTWFwcGluZygp\nIHsKICAgICAgICByZXR1cm4gKEZpZWxkTWFwcGluZykgZ2V0VmVyc2lvbkZp\nZWxkKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBDb252ZW5pZW5jZSBtZXRo\nb2QgdG8gcGVyZm9ybSBjYXN0IGZyb20KICAgICAqIHtAbGluayBDbGFzc01l\ndGFEYXRhI2dldERlZmF1bHRGZXRjaEdyb3VwRmllbGRzfS4KICAgICAqLwog\nICAgcHVibGljIEZpZWxkTWFwcGluZ1tdIGdldERlZmF1bHRGZXRjaEdyb3Vw\nRmllbGRNYXBwaW5ncygpIHsKICAgICAgICByZXR1cm4gKEZpZWxkTWFwcGlu\nZ1tdKSBnZXREZWZhdWx0RmV0Y2hHcm91cEZpZWxkcygpOwogICAgfQoKICAg\nIC8qKgogICAgICogQ29udmVuaWVuY2UgbWV0aG9kIHRvIHBlcmZvcm0gY2Fz\ndCBmcm9tCiAgICAgKiB7QGxpbmsgQ2xhc3NNZXRhRGF0YSNnZXREZWZpbmVk\nRmllbGRzfS4KICAgICAqLwogICAgcHVibGljIEZpZWxkTWFwcGluZ1tdIGdl\ndERlZmluZWRGaWVsZE1hcHBpbmdzKCkgewogICAgICAgIHJldHVybiAoRmll\nbGRNYXBwaW5nW10pIGdldERlZmluZWRGaWVsZHMoKTsKICAgIH0KCiAgICAv\nKioKICAgICAqIENvbnZlbmllbmNlIG1ldGhvZCB0byBwZXJmb3JtIGNhc3Qg\nZnJvbQogICAgICoge0BsaW5rIENsYXNzTWV0YURhdGEjZ2V0RmllbGRzSW5M\naXN0aW5nT3JkZXJ9LgogICAgICovCiAgICBwdWJsaWMgRmllbGRNYXBwaW5n\nW10gZ2V0RmllbGRNYXBwaW5nc0luTGlzdGluZ09yZGVyKCkgewogICAgICAg\nIHJldHVybiAoRmllbGRNYXBwaW5nW10pIGdldEZpZWxkc0luTGlzdGluZ09y\nZGVyKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBDb252ZW5pZW5jZSBtZXRo\nb2QgdG8gcGVyZm9ybSBjYXN0IGZyb20KICAgICAqIHtAbGluayBDbGFzc01l\ndGFEYXRhI2dldERlZmluZWRGaWVsZHNJbkxpc3RpbmdPcmRlcn0uCiAgICAg\nKi8KICAgIHB1YmxpYyBGaWVsZE1hcHBpbmdbXSBnZXREZWZpbmVkRmllbGRN\nYXBwaW5nc0luTGlzdGluZ09yZGVyKCkgewogICAgICAgIHJldHVybiAoRmll\nbGRNYXBwaW5nW10pIGdldERlZmluZWRGaWVsZHNJbkxpc3RpbmdPcmRlcigp\nOwogICAgfQoKICAgIC8qKgogICAgICogQ29udmVuaWVuY2UgbWV0aG9kIHRv\nIHBlcmZvcm0gY2FzdCBmcm9tIHtAbGluayBDbGFzc01ldGFEYXRhI2dldEZp\nZWxkfS4KICAgICAqLwogICAgcHVibGljIEZpZWxkTWFwcGluZyBnZXRGaWVs\nZE1hcHBpbmcoaW50IGluZGV4KSB7CiAgICAgICAgcmV0dXJuIChGaWVsZE1h\ncHBpbmcpIGdldEZpZWxkKGluZGV4KTsKICAgIH0KCiAgICAvKioKICAgICAq\nIENvbnZlbmllbmNlIG1ldGhvZCB0byBwZXJmb3JtIGNhc3QgZnJvbQogICAg\nICoge0BsaW5rIENsYXNzTWV0YURhdGEjZ2V0RGVjbGFyZWRGaWVsZH0uCiAg\nICAgKi8KICAgIHB1YmxpYyBGaWVsZE1hcHBpbmcgZ2V0RGVjbGFyZWRGaWVs\nZE1hcHBpbmcoaW50IGluZGV4KSB7CiAgICAgICAgcmV0dXJuIChGaWVsZE1h\ncHBpbmcpIGdldERlY2xhcmVkRmllbGQoaW5kZXgpOwogICAgfQoKICAgIC8q\nKgogICAgICogQ29udmVuaWVuY2UgbWV0aG9kIHRvIHBlcmZvcm0gY2FzdCBm\ncm9tIHtAbGluayBDbGFzc01ldGFEYXRhI2dldEZpZWxkfS4KICAgICAqLwog\nICAgcHVibGljIEZpZWxkTWFwcGluZyBnZXRGaWVsZE1hcHBpbmcoU3RyaW5n\nIG5hbWUpIHsKICAgICAgICByZXR1cm4gKEZpZWxkTWFwcGluZykgZ2V0Rmll\nbGQobmFtZSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBDb252ZW5pZW5jZSBt\nZXRob2QgdG8gcGVyZm9ybSBjYXN0IGZyb20KICAgICAqIHtAbGluayBDbGFz\nc01ldGFEYXRhI2dldERlY2xhcmVkRmllbGR9LgogICAgICovCiAgICBwdWJs\naWMgRmllbGRNYXBwaW5nIGdldERlY2xhcmVkRmllbGRNYXBwaW5nKFN0cmlu\nZyBuYW1lKSB7CiAgICAgICAgcmV0dXJuIChGaWVsZE1hcHBpbmcpIGdldERl\nY2xhcmVkRmllbGQobmFtZSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBDb252\nZW5pZW5jZSBtZXRob2QgdG8gcGVyZm9ybSBjYXN0IGZyb20KICAgICAqIHtA\nbGluayBDbGFzc01ldGFEYXRhI2dldERlY2xhcmVkVW5tYW5hZ2VkRmllbGRz\nfS4KICAgICAqLwogICAgcHVibGljIEZpZWxkTWFwcGluZ1tdIGdldERlY2xh\ncmVkVW5tYW5hZ2VkRmllbGRNYXBwaW5ncygpIHsKICAgICAgICByZXR1cm4g\nKEZpZWxkTWFwcGluZ1tdKSBnZXREZWNsYXJlZFVubWFuYWdlZEZpZWxkcygp\nOwogICAgfQoKICAgIC8qKgogICAgICogQ29udmVuaWVuY2UgbWV0aG9kIHRv\nIHBlcmZvcm0gY2FzdCBmcm9tCiAgICAgKiB7QGxpbmsgQ2xhc3NNZXRhRGF0\nYSNhZGREZWNsYXJlZEZpZWxkfS4KICAgICAqLwogICAgcHVibGljIEZpZWxk\nTWFwcGluZyBhZGREZWNsYXJlZEZpZWxkTWFwcGluZyhTdHJpbmcgbmFtZSwg\nQ2xhc3MgdHlwZSkgewogICAgICAgIHJldHVybiAoRmllbGRNYXBwaW5nKSBh\nZGREZWNsYXJlZEZpZWxkKG5hbWUsIHR5cGUpOwogICAgfQoKICAgIHByb3Rl\nY3RlZCB2b2lkIHJlc29sdmVNYXBwaW5nKGJvb2xlYW4gcnVudGltZSkgewog\nICAgICAgIHN1cGVyLnJlc29sdmVNYXBwaW5nKHJ1bnRpbWUpOwoKICAgICAg\nICAvLyBtYXAgY2xhc3Mgc3RyYXRlZ3k7IGl0IG1heSBhbHJlYWR5IGJlIG1h\ncHBlZCBieSB0aGUgcmVwb3NpdG9yeSBiZWZvcmUKICAgICAgICAvLyB0aGUg\ncmVzb2x2ZSBwcm9jZXNzIGJlZ2lucwogICAgICAgIE1hcHBpbmdSZXBvc2l0\nb3J5IHJlcG9zID0gZ2V0TWFwcGluZ1JlcG9zaXRvcnkoKTsKICAgICAgICBp\nZiAoX3N0cmF0ZWd5ID09IG51bGwpCiAgICAgICAgICAgIHJlcG9zLmdldFN0\ncmF0ZWd5SW5zdGFsbGVyKCkuaW5zdGFsbFN0cmF0ZWd5KHRoaXMpOwogICAg\nICAgIExvZyBsb2cgPSBnZXRSZXBvc2l0b3J5KCkuZ2V0TG9nKCk7CiAgICAg\nICAgaWYgKGxvZy5pc1RyYWNlRW5hYmxlZCgpKQogICAgICAgICAgICBsb2cu\ndHJhY2UoX2xvYy5nZXQoInN0cmF0ZWd5IiwgdGhpcywgX3N0cmF0ZWd5Lmdl\ndEFsaWFzKCkpKTsKCiAgICAgICAgLy8gbWFrZSBzdXJlIHVubWFwcGVkIHN1\ncGVyY2xhc3MgZmllbGRzIGFyZSBkZWZpbmVkIGlmIHdlJ3JlIG1hcHBlZDsK\nICAgICAgICAvLyBhbHNvIG1heSBoYXZlIGJlZW4gZG9uZSBieSByZXBvc2l0\nb3J5IGFscmVhZHkKICAgICAgICBkZWZpbmVTdXBlcmNsYXNzRmllbGRzKGdl\ndEpvaW5hYmxlUENTdXBlcmNsYXNzTWFwcGluZygpID09IG51bGwpOwoKICAg\nICAgICAvLyByZXNvbHZlIGV2ZXJ5dGhpbmcgdGhhdCBkb2Vzbid0IHJlbHkg\nb24gYW55IHJlbGF0aW9ucyB0byBhdm9pZAogICAgICAgIC8vIHJlY3Vyc2lv\nbiwgdGhlbiByZXNvbHZlIGFsbCBmaWVsZHMKICAgICAgICByZXNvbHZlTm9u\nUmVsYXRpb25NYXBwaW5ncygpOwogICAgICAgIEZpZWxkTWFwcGluZ1tdIGZt\ncyA9IGdldEZpZWxkTWFwcGluZ3MoKTsKICAgICAgICBmb3IgKGludCBpID0g\nMDsgaSA8IGZtcy5sZW5ndGg7IGkrKykKICAgICAgICAgICAgaWYgKGZtc1tp\nXS5nZXREZWZpbmluZ01ldGFEYXRhKCkgPT0gdGhpcykKICAgICAgICAgICAg\nICAgIGZtc1tpXS5yZXNvbHZlKE1PREVfTUFQUElORyk7CiAgICAgICAgZm1z\nID0gZ2V0RGVjbGFyZWRVbm1hbmFnZWRGaWVsZE1hcHBpbmdzKCk7CiAgICAg\nICAgZm9yIChpbnQgaSA9IDA7IGkgPCBmbXMubGVuZ3RoOyBpKyspCiAgICAg\nICAgICAgIGZtc1tpXS5yZXNvbHZlKE1PREVfTUFQUElORyk7CgogICAgICAg\nIC8vIG1hcmsgbWFwcGVkIGNvbHVtbnMKICAgICAgICBpZiAoX2NvbHMgIT0g\nbnVsbCkgewogICAgICAgICAgICBDb2x1bW5JTyBpbyA9IGdldENvbHVtbklP\nKCk7CiAgICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgX2NvbHMubGVu\nZ3RoOyBpKyspIHsKICAgICAgICAgICAgICAgIGlmIChpby5pc0luc2VydGFi\nbGUoaSwgZmFsc2UpKQogICAgICAgICAgICAgICAgICAgIF9jb2xzW2ldLnNl\ndEZsYWcoQ29sdW1uLkZMQUdfRElSRUNUX0lOU0VSVCwgdHJ1ZSk7CiAgICAg\nICAgICAgICAgICBpZiAoaW8uaXNVcGRhdGFibGUoaSwgZmFsc2UpKQogICAg\nICAgICAgICAgICAgICAgIF9jb2xzW2ldLnNldEZsYWcoQ29sdW1uLkZMQUdf\nRElSRUNUX1VQREFURSwgdHJ1ZSk7CiAgICAgICAgICAgIH0KICAgICAgICB9\nCiAgICAgICAgLy8gb25jZSBjb2x1bW5zIGFyZSByZXNvbHZlZCwgcmVzb2x2\nZSB1bmlxdWUgY29uc3RyYWludHMgYXMgdGhleSBuZWVkCiAgICAgICAgLy8g\ndGhlIGNvbHVtbnMgYmUgcmVzb2x2ZWQgCiAgICAgICAgX2luZm8uZ2V0VW5p\ncXVlcyh0aGlzLCB0cnVlKTsKICAgIH0KICAgIAogICAgLyoqCiAgICAgKiBS\nZXNvbHZlIG5vbi1yZWxhdGlvbiBmaWVsZCBtYXBwaW5ncyBzbyB0aGF0IHdo\nZW4gd2UgZG8gcmVsYXRpb24KICAgICAqIG1hcHBpbmdzIHRoZXkgY2FuIHJl\nbHkgb24gdGhlbSBmb3Igam9pbnMuCiAgICAgKi8KICAgIHZvaWQgcmVzb2x2\nZU5vblJlbGF0aW9uTWFwcGluZ3MoKSB7CiAgICAgICAgLy8gbWFrZSBzdXJl\nIHByaW1hcnkga2V5IGZpZWxkcyBhcmUgcmVzb2x2ZWQgZmlyc3QgYmVjYXVz\nZSBvdGhlcgogICAgICAgIC8vIGZpZWxkcyBtaWdodCByZWx5IG9uIHRoZW0K\nICAgICAgICBGaWVsZE1hcHBpbmdbXSBmbXMgPSBnZXRQcmltYXJ5S2V5Rmll\nbGRNYXBwaW5ncygpOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgZm1z\nLmxlbmd0aDsgaSsrKQogICAgICAgICAgICBmbXNbaV0ucmVzb2x2ZShNT0RF\nX01BUFBJTkcpOwoKICAgICAgICAvLyByZXNvbHZlIGRlZmluZWQgZmllbGRz\nIHRoYXQgYXJlIHNhZmU7IHRoYXQgZG9uJ3QgcmVseSBvbiBvdGhlciB0eXBl\ncwogICAgICAgIC8vIGFsc28gYmVpbmcgcmVzb2x2ZWQuICBkb24ndCB1c2Ug\nZ2V0RGVmaW5lZEZpZWxkcyBiL2MgaXQgcmVsaWVzIG9uCiAgICAgICAgLy8g\nd2hldGhlciBmaWVsZHMgYXJlIG1hcHBlZCwgd2hpY2ggaXNuJ3Qga25vd24g\neWV0CiAgICAgICAgZm1zID0gZ2V0RmllbGRNYXBwaW5ncygpOwogICAgICAg\nIGZvciAoaW50IGkgPSAwOyBpIDwgZm1zLmxlbmd0aDsgaSsrKQogICAgICAg\nICAgICBpZiAoZm1zW2ldLmdldERlZmluaW5nTWV0YURhdGEoKSA9PSB0aGlz\nCiAgICAgICAgICAgICAgICAmJiAhZm1zW2ldLmlzVHlwZVBDKCkgJiYgIWZt\nc1tpXS5nZXRLZXkoKS5pc1R5cGVQQygpCiAgICAgICAgICAgICAgICAmJiAh\nZm1zW2ldLmdldEVsZW1lbnQoKS5pc1R5cGVQQygpKQogICAgICAgICAgICAg\nICAgZm1zW2ldLnJlc29sdmUoTU9ERV9NQVBQSU5HKTsKCiAgICAgICAgX2Rp\nc2NyaW0ucmVzb2x2ZShNT0RFX01BUFBJTkcpOwogICAgICAgIF92ZXJzaW9u\nLnJlc29sdmUoTU9ERV9NQVBQSU5HKTsgICAgICAgIAogICAgfQoKICAgIHBy\nb3RlY3RlZCB2b2lkIGluaXRpYWxpemVNYXBwaW5nKCkgewogICAgICAgIHN1\ncGVyLmluaXRpYWxpemVNYXBwaW5nKCk7CgogICAgICAgIEZpZWxkTWFwcGlu\nZ1tdIGZpZWxkcyA9IGdldERlZmluZWRGaWVsZE1hcHBpbmdzKCk7CiAgICAg\nICAgZm9yIChpbnQgaSA9IDA7IGkgPCBmaWVsZHMubGVuZ3RoOyBpKyspCiAg\nICAgICAgICAgIGZpZWxkc1tpXS5yZXNvbHZlKE1PREVfTUFQUElOR19JTklU\nKTsKICAgICAgICBfZGlzY3JpbS5yZXNvbHZlKE1PREVfTUFQUElOR19JTklU\nKTsKICAgICAgICBfdmVyc2lvbi5yZXNvbHZlKE1PREVfTUFQUElOR19JTklU\nKTsKICAgICAgICBfc3RyYXRlZ3kuaW5pdGlhbGl6ZSgpOwogICAgfQoKICAg\nIHByb3RlY3RlZCB2b2lkIGNsZWFyRGVmaW5lZEZpZWxkQ2FjaGUoKSB7CiAg\nICAgICAgLy8ganVzdCBtYWtlIHRoaXMgbWV0aG9kIGF2YWlsYWJsZSB0byBv\ndGhlciBjbGFzc2VzIGluIHRoaXMgcGFja2FnZQogICAgICAgIHN1cGVyLmNs\nZWFyRGVmaW5lZEZpZWxkQ2FjaGUoKTsKICAgIH0KCiAgICBwcm90ZWN0ZWQg\ndm9pZCBjbGVhclN1YmNsYXNzQ2FjaGUoKSB7CiAgICAgICAgc3VwZXIuY2xl\nYXJTdWJjbGFzc0NhY2hlKCk7CiAgICAgICAgX2pvaW5TdWJNYXBzID0gbnVs\nbDsKICAgICAgICBfYXNzaWduTWFwcyA9IG51bGw7CiAgICB9CgogICAgcHVi\nbGljIHZvaWQgY29weShDbGFzc01ldGFEYXRhIGNscykgewogICAgICAgIHN1\ncGVyLmNvcHkoY2xzKTsKICAgICAgICBpZiAoX3N1YmNsYXNzTW9kZSA9PSBJ\nbnRlZ2VyLk1BWF9WQUxVRSkKICAgICAgICAgICAgX3N1YmNsYXNzTW9kZSA9\nICgoQ2xhc3NNYXBwaW5nKSBjbHMpLmdldFN1YmNsYXNzRmV0Y2hNb2RlKCk7\nCiAgICB9CgogICAgcHJvdGVjdGVkIGJvb2xlYW4gdmFsaWRhdGVEYXRhU3Rv\ncmVFeHRlbnNpb25QcmVmaXgoU3RyaW5nIHByZWZpeCkgewogICAgICAgIHJl\ndHVybiAiamRiYy0iLmVxdWFscyhwcmVmaXgpOwogICAgfQoKICAgIC8vLy8v\nLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgICAvLyBDbGFzc1N0cmF0\nZWd5IGltcGxlbWVudGF0aW9uCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8v\nLy8vLy8vLy8vLwoKICAgIHB1YmxpYyBTdHJpbmcgZ2V0QWxpYXMoKSB7CiAg\nICAgICAgcmV0dXJuIGFzc2VydFN0cmF0ZWd5KCkuZ2V0QWxpYXMoKTsKICAg\nIH0KCiAgICBwdWJsaWMgdm9pZCBtYXAoYm9vbGVhbiBhZGFwdCkgewogICAg\nICAgIGFzc2VydFN0cmF0ZWd5KCkubWFwKGFkYXB0KTsKICAgIH0KCiAgICBw\ndWJsaWMgdm9pZCBpbml0aWFsaXplKCkgewogICAgICAgIGFzc2VydFN0cmF0\nZWd5KCkuaW5pdGlhbGl6ZSgpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIGlu\nc2VydChPcGVuSlBBU3RhdGVNYW5hZ2VyIHNtLCBKREJDU3RvcmUgc3RvcmUs\nIFJvd01hbmFnZXIgcm0pCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7\nCiAgICAgICAgYXNzZXJ0U3RyYXRlZ3koKS5pbnNlcnQoc20sIHN0b3JlLCBy\nbSk7CiAgICB9CgogICAgcHVibGljIHZvaWQgdXBkYXRlKE9wZW5KUEFTdGF0\nZU1hbmFnZXIgc20sIEpEQkNTdG9yZSBzdG9yZSwgUm93TWFuYWdlciBybSkK\nICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBhc3NlcnRT\ndHJhdGVneSgpLnVwZGF0ZShzbSwgc3RvcmUsIHJtKTsKICAgIH0KCiAgICBw\ndWJsaWMgdm9pZCBkZWxldGUoT3BlbkpQQVN0YXRlTWFuYWdlciBzbSwgSkRC\nQ1N0b3JlIHN0b3JlLCBSb3dNYW5hZ2VyIHJtKQogICAgICAgIHRocm93cyBT\nUUxFeGNlcHRpb24gewogICAgICAgIGFzc2VydFN0cmF0ZWd5KCkuZGVsZXRl\nKHNtLCBzdG9yZSwgcm0pOwogICAgfQoKICAgIHB1YmxpYyBCb29sZWFuIGlz\nQ3VzdG9tSW5zZXJ0KE9wZW5KUEFTdGF0ZU1hbmFnZXIgc20sIEpEQkNTdG9y\nZSBzdG9yZSkgewogICAgICAgIHJldHVybiBhc3NlcnRTdHJhdGVneSgpLmlz\nQ3VzdG9tSW5zZXJ0KHNtLCBzdG9yZSk7CiAgICB9CgogICAgcHVibGljIEJv\nb2xlYW4gaXNDdXN0b21VcGRhdGUoT3BlbkpQQVN0YXRlTWFuYWdlciBzbSwg\nSkRCQ1N0b3JlIHN0b3JlKSB7CiAgICAgICAgcmV0dXJuIGFzc2VydFN0cmF0\nZWd5KCkuaXNDdXN0b21VcGRhdGUoc20sIHN0b3JlKTsKICAgIH0KCiAgICBw\ndWJsaWMgQm9vbGVhbiBpc0N1c3RvbURlbGV0ZShPcGVuSlBBU3RhdGVNYW5h\nZ2VyIHNtLCBKREJDU3RvcmUgc3RvcmUpIHsKICAgICAgICByZXR1cm4gYXNz\nZXJ0U3RyYXRlZ3koKS5pc0N1c3RvbURlbGV0ZShzbSwgc3RvcmUpOwogICAg\nfQoKICAgIHB1YmxpYyB2b2lkIGN1c3RvbUluc2VydChPcGVuSlBBU3RhdGVN\nYW5hZ2VyIHNtLCBKREJDU3RvcmUgc3RvcmUpCiAgICAgICAgdGhyb3dzIFNR\nTEV4Y2VwdGlvbiB7CiAgICAgICAgYXNzZXJ0U3RyYXRlZ3koKS5jdXN0b21J\nbnNlcnQoc20sIHN0b3JlKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBjdXN0\nb21VcGRhdGUoT3BlbkpQQVN0YXRlTWFuYWdlciBzbSwgSkRCQ1N0b3JlIHN0\nb3JlKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIGFz\nc2VydFN0cmF0ZWd5KCkuY3VzdG9tVXBkYXRlKHNtLCBzdG9yZSk7CiAgICB9\nCgogICAgcHVibGljIHZvaWQgY3VzdG9tRGVsZXRlKE9wZW5KUEFTdGF0ZU1h\nbmFnZXIgc20sIEpEQkNTdG9yZSBzdG9yZSkKICAgICAgICB0aHJvd3MgU1FM\nRXhjZXB0aW9uIHsKICAgICAgICBhc3NlcnRTdHJhdGVneSgpLmN1c3RvbURl\nbGV0ZShzbSwgc3RvcmUpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldENs\nYXNzTWFwcGluZyhDbGFzc01hcHBpbmcgb3duZXIpIHsKICAgICAgICBhc3Nl\ncnRTdHJhdGVneSgpLnNldENsYXNzTWFwcGluZyhvd25lcik7CiAgICB9Cgog\nICAgcHVibGljIGJvb2xlYW4gaXNQcmltYXJ5S2V5T2JqZWN0SWQoYm9vbGVh\nbiBoYXNBbGwpIHsKICAgICAgICByZXR1cm4gYXNzZXJ0U3RyYXRlZ3koKS5p\nc1ByaW1hcnlLZXlPYmplY3RJZChoYXNBbGwpOwogICAgfQoKICAgIHB1Ymxp\nYyBKb2lucyBqb2luU3VwZXJjbGFzcyhKb2lucyBqb2lucywgYm9vbGVhbiB0\nb1RoaXMpIHsKICAgICAgICByZXR1cm4gYXNzZXJ0U3RyYXRlZ3koKS5qb2lu\nU3VwZXJjbGFzcyhqb2lucywgdG9UaGlzKTsKICAgIH0KCiAgICBwdWJsaWMg\nYm9vbGVhbiBzdXBwb3J0c0VhZ2VyU2VsZWN0KFNlbGVjdCBzZWwsIE9wZW5K\nUEFTdGF0ZU1hbmFnZXIgc20sCiAgICAgICAgSkRCQ1N0b3JlIHN0b3JlLCBD\nbGFzc01hcHBpbmcgYmFzZSwgSkRCQ0ZldGNoQ29uZmlndXJhdGlvbiBmZXRj\naCkgewogICAgICAgIHJldHVybiBhc3NlcnRTdHJhdGVneSgpLnN1cHBvcnRz\nRWFnZXJTZWxlY3Qoc2VsLCBzbSwgc3RvcmUsIGJhc2UsCiAgICAgICAgICAg\nIGZldGNoKTsKICAgIH0KCiAgICBwdWJsaWMgUmVzdWx0T2JqZWN0UHJvdmlk\nZXIgY3VzdG9tTG9hZChKREJDU3RvcmUgc3RvcmUsIGJvb2xlYW4gc3ViY2xh\nc3NlcywKICAgICAgICBKREJDRmV0Y2hDb25maWd1cmF0aW9uIGZldGNoLCBs\nb25nIHN0YXJ0SWR4LCBsb25nIGVuZElkeCkKICAgICAgICB0aHJvd3MgU1FM\nRXhjZXB0aW9uIHsKICAgICAgICByZXR1cm4gYXNzZXJ0U3RyYXRlZ3koKS5j\ndXN0b21Mb2FkKHN0b3JlLCBzdWJjbGFzc2VzLCBmZXRjaCwKICAgICAgICAg\nICAgc3RhcnRJZHgsIGVuZElkeCk7CiAgICB9CgogICAgcHVibGljIGJvb2xl\nYW4gY3VzdG9tTG9hZChPcGVuSlBBU3RhdGVNYW5hZ2VyIHNtLCBKREJDU3Rv\ncmUgc3RvcmUsCiAgICAgICAgUENTdGF0ZSBzdGF0ZSwgSkRCQ0ZldGNoQ29u\nZmlndXJhdGlvbiBmZXRjaCkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9u\nLCBDbGFzc05vdEZvdW5kRXhjZXB0aW9uIHsKICAgICAgICByZXR1cm4gYXNz\nZXJ0U3RyYXRlZ3koKS5jdXN0b21Mb2FkKHNtLCBzdG9yZSwgc3RhdGUsIGZl\ndGNoKTsKICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBjdXN0b21Mb2FkKE9w\nZW5KUEFTdGF0ZU1hbmFnZXIgc20sIEpEQkNTdG9yZSBzdG9yZSwKICAgICAg\nICBKREJDRmV0Y2hDb25maWd1cmF0aW9uIGZldGNoLCBSZXN1bHQgcmVzdWx0\nKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIHJldHVy\nbiBhc3NlcnRTdHJhdGVneSgpLmN1c3RvbUxvYWQoc20sIHN0b3JlLCBmZXRj\naCwgcmVzdWx0KTsKICAgIH0KICAgIAogICAgcHJpdmF0ZSBDbGFzc1N0cmF0\nZWd5IGFzc2VydFN0cmF0ZWd5KCkgewogICAgICAgIGlmIChfc3RyYXRlZ3kg\nPT0gbnVsbCkKICAgICAgICAgICAgdGhyb3cgbmV3IEludGVybmFsRXhjZXB0\naW9uKCk7CiAgICAgICAgcmV0dXJuIF9zdHJhdGVneTsKICAgIH0KfQo=\n","encoding":"base64"}

