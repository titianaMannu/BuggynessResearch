{"sha":"2eb4fdf482e38710cdb33dc28ba1009cc82abe30","node_id":"MDQ6QmxvYjIwNjM2NDoyZWI0ZmRmNDgyZTM4NzEwY2RiMzNkYzI4YmExMDA5Y2M4MmFiZTMw","size":13848,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/2eb4fdf482e38710cdb33dc28ba1009cc82abe30","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhOwoKaW1wb3J0\nIGphdmEuaW8uRmlsZTsKaW1wb3J0IGphdmEudXRpbC5Db2xsZWN0aW9uczsK\naW1wb3J0IGphdmEudXRpbC5IYXNoTWFwOwppbXBvcnQgamF2YS51dGlsLkl0\nZXJhdG9yOwppbXBvcnQgamF2YS51dGlsLkxpc3Q7CmltcG9ydCBqYXZhLnV0\naWwuTWFwOwppbXBvcnQgamF2YS51dGlsLkNvbGxlY3Rpb247CmltcG9ydCBq\nYXZhLnV0aWwuQXJyYXlMaXN0OwoKaW1wb3J0IG9yZy5hcGFjaGUuY29tbW9u\ncy5sYW5nLlN0cmluZ1V0aWxzOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLmpkYmMubWV0YS5zdHJhdHMuRnVsbENsYXNzU3RyYXRlZ3k7CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hlbWEuQ29sdW1uOwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1hLkZvcmVpZ25LZXk7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hlbWEuU2NoZW1hOwpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1hLlNjaGVtYUdy\nb3VwOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1hLlRh\nYmxlOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1hLlVu\naXF1ZTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIubWV0YS5Tb3Vy\nY2VUcmFja2VyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51dGls\nLkxvY2FsaXplcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIueG1s\nLkNvbW1lbnRhYmxlOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwu\nVXNlckV4Y2VwdGlvbjsKCi8qKgogKiBJbmZvcm1hdGlvbiBhYm91dCB0aGUg\nbWFwcGluZyBmcm9tIGEgY2xhc3MgdG8gdGhlIHNjaGVtYSwgaW4gcmF3IGZv\ncm0uCiAqIFRoZSBjb2x1bW5zIGFuZCB0YWJsZXMgdXNlZCBpbiBtYXBwaW5n\nIGluZm8gd2lsbCBub3QgYmUgcGFydCBvZiB0aGUKICoge0BsaW5rIFNjaGVt\nYUdyb3VwfSB1c2VkIGF0IHJ1bnRpbWUuIFJhdGhlciwgdGhleSB3aWxsIGJl\nIHN0cnVjdHMKICogd2l0aCB0aGUgcmVsZXZhbnQgcGllY2VzIG9mIGluZm9y\nbWF0aW9uIGZpbGxlZCBpbi4KICoKICogQGF1dGhvciBBYmUgV2hpdGUKICov\nCnB1YmxpYyBjbGFzcyBDbGFzc01hcHBpbmdJbmZvCiAgICBleHRlbmRzIE1h\ncHBpbmdJbmZvCiAgICBpbXBsZW1lbnRzIFNvdXJjZVRyYWNrZXIsIENvbW1l\nbnRhYmxlIHsKCiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBMb2NhbGl6ZXIg\nX2xvYyA9IExvY2FsaXplci5mb3JQYWNrYWdlCiAgICAgICAgKENsYXNzTWFw\ncGluZ0luZm8uY2xhc3MpOwoKICAgIHByaXZhdGUgU3RyaW5nIF9jbGFzc05h\nbWUgPSBPYmplY3QuY2xhc3MuZ2V0TmFtZSgpOwogICAgcHJpdmF0ZSBTdHJp\nbmcgX3RhYmxlTmFtZSA9IG51bGw7CiAgICBwcml2YXRlIFN0cmluZyBfc2No\nZW1hTmFtZSA9IG51bGw7CiAgICBwcml2YXRlIGJvb2xlYW4gX2pvaW5lZCA9\nIGZhbHNlOwogICAgcHJpdmF0ZSBNYXAgX3NlY29uZHMgPSBudWxsOwogICAg\ncHJpdmF0ZSBTdHJpbmcgX3N1YlN0cmF0ID0gbnVsbDsKICAgIHByaXZhdGUg\nRmlsZSBfZmlsZSA9IG51bGw7CiAgICBwcml2YXRlIGludCBfc3JjVHlwZSA9\nIFNSQ19PVEhFUjsKICAgIHByaXZhdGUgU3RyaW5nW10gX2NvbW1lbnRzID0g\nbnVsbDsKICAgIHByaXZhdGUgQ29sbGVjdGlvbiBfdW5pcXVlcyA9IG51bGw7\nLy9VbmlxdWUKCiAgICAvKioKICAgICAqIFRoZSBkZXNjcmliZWQgY2xhc3Mg\nbmFtZS4KICAgICAqLwogICAgcHVibGljIFN0cmluZyBnZXRDbGFzc05hbWUo\nKSB7CiAgICAgICAgcmV0dXJuIF9jbGFzc05hbWU7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBUaGUgZGVzY3JpYmVkIGNsYXNzIG5hbWUuCiAgICAgKi8KICAg\nIHB1YmxpYyB2b2lkIHNldENsYXNzTmFtZShTdHJpbmcgbmFtZSkgewogICAg\nICAgIF9jbGFzc05hbWUgPSBuYW1lOwogICAgfQoKICAgIC8qKgogICAgICog\nVGhlIGRlZmF1bHQgc3RyYXRlZ3kgZm9yIHN1YmNsYXNzZXMgaW4gdGhpcyBo\naWVyYXJjaHkuCiAgICAgKi8KICAgIHB1YmxpYyBTdHJpbmcgZ2V0SGllcmFy\nY2h5U3RyYXRlZ3koKSB7CiAgICAgICAgcmV0dXJuIF9zdWJTdHJhdDsKICAg\nIH0KCiAgICAvKioKICAgICAqIFRoZSBkZWZhdWx0IHN0cmF0ZWd5IGZvciBz\ndWJjbGFzc2VzIGluIHRoaXMgaGllcmFyY2h5LgogICAgICovCiAgICBwdWJs\naWMgdm9pZCBzZXRIaWVyYXJjaHlTdHJhdGVneShTdHJpbmcgc3RyYXRlZ3kp\nIHsKICAgICAgICBfc3ViU3RyYXQgPSBzdHJhdGVneTsKICAgIH0KCiAgICAv\nKioKICAgICAqIFRoZSBnaXZlbiB0YWJsZSBuYW1lLgogICAgICovCiAgICBw\ndWJsaWMgU3RyaW5nIGdldFRhYmxlTmFtZSgpIHsKICAgICAgICByZXR1cm4g\nX3RhYmxlTmFtZTsKICAgIH0KCiAgICAvKioKICAgICAqIFRoZSBnaXZlbiB0\nYWJsZSBuYW1lLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRUYWJsZU5h\nbWUoU3RyaW5nIHRhYmxlKSB7CiAgICAgICAgX3RhYmxlTmFtZSA9IHRhYmxl\nOwogICAgfQoKICAgIC8qKgogICAgICogVGhlIGRlZmF1bHQgc2NoZW1hIG5h\nbWUgZm9yIHVucXVhbGlmaWVkIHRhYmxlcy4KICAgICAqLwogICAgcHVibGlj\nIFN0cmluZyBnZXRTY2hlbWFOYW1lKCkgewogICAgICAgIHJldHVybiBfc2No\nZW1hTmFtZTsKICAgIH0KCiAgICAvKioKICAgICAqIFRoZSBkZWZhdWx0IHNj\naGVtYSBuYW1lIGZvciB1bnF1YWxpZmllZCB0YWJsZXMuCiAgICAgKi8KICAg\nIHB1YmxpYyB2b2lkIHNldFNjaGVtYU5hbWUoU3RyaW5nIHNjaGVtYSkgewog\nICAgICAgIF9zY2hlbWFOYW1lID0gc2NoZW1hOwogICAgfQoKICAgIC8qKgog\nICAgICogV2hldGhlciB0aGVyZSBpcyBhIGpvaW4gdG8gdGhlIHN1cGVyY2xh\nc3MgdGFibGUuCiAgICAgKi8KICAgIHB1YmxpYyBib29sZWFuIGlzSm9pbmVk\nU3ViY2xhc3MoKSB7CiAgICAgICAgcmV0dXJuIF9qb2luZWQ7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBXaGV0aGVyIHRoZXJlIGlzIGEgam9pbiB0byB0aGUg\nc3VwZXJjbGFzcyB0YWJsZS4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0\nSm9pbmVkU3ViY2xhc3MoYm9vbGVhbiBqb2luZWQpIHsKICAgICAgICBfam9p\nbmVkID0gam9pbmVkOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRo\nZSBjbGFzcy1sZXZlbCBqb2luZWQgdGFibGVzLgogICAgICovCiAgICBwdWJs\naWMgU3RyaW5nW10gZ2V0U2Vjb25kYXJ5VGFibGVOYW1lcygpIHsKICAgICAg\nICBpZiAoX3NlY29uZHMgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIG5l\ndyBTdHJpbmdbMF07CiAgICAgICAgcmV0dXJuIChTdHJpbmdbXSkgX3NlY29u\nZHMua2V5U2V0KCkudG9BcnJheShuZXcgU3RyaW5nW117IH0pOwogICAgfQoK\nICAgIC8qKgogICAgICogV2UgYWxsb3cgZmllbGRzIHRvIHJlZmVyZW5jZSBj\nbGFzcy1sZXZlbCBqb2lucyB1c2luZyBqdXN0IHRoZSB0YWJsZQogICAgICog\nbmFtZSwgd2hlcmVhcyB0aGUgY2xhc3Mgam9pbiBtaWdodCBoYXZlIHNjaGVt\nYSwgZXRjIGluZm9ybWF0aW9uLgogICAgICogVGhpcyBtZXRob2QgcmV0dXJu\ncyB0aGUgbmFtZSBvZiB0aGUgZ2l2ZW4gdGFibGUgYXMgbGlzdGVkIGluIGEK\nICAgICAqIGNsYXNzLWxldmVsIGpvaW4sIG9yIHRoZSBnaXZlbiBuYW1lIGlm\nIG5vIGpvaW4gZXhpc3RzLgogICAgICovCiAgICBwdWJsaWMgU3RyaW5nIGdl\ndFNlY29uZGFyeVRhYmxlTmFtZShTdHJpbmcgdGFibGVOYW1lKSB7CiAgICAg\nICAgLy8gaWYgbm8gc2Vjb25kYXJ5IHRhYmxlIGpvaW5zLCBiYWQgdGFibGUg\nbmFtZSwgZXhhY3QgbWF0Y2gsCiAgICAgICAgLy8gb3IgYW4gYWxyZWFkeS1x\ndWFsaWZpZWQgdGFibGUgbmFtZSwgbm90aGluZyB0byBkbwogICAgICAgIGlm\nIChfc2Vjb25kcyA9PSBudWxsIHx8IHRhYmxlTmFtZSA9PSBudWxsCiAgICAg\nICAgICAgIHx8IF9zZWNvbmRzLmNvbnRhaW5zS2V5KHRhYmxlTmFtZSkKICAg\nICAgICAgICAgfHwgdGFibGVOYW1lLmluZGV4T2YoJy4nKSAhPSAtMSkKICAg\nICAgICAgICAgcmV0dXJuIHRhYmxlTmFtZTsKCiAgICAgICAgLy8gZGVjaWRl\nIHdoaWNoIGNsYXNzLWxldmVsIGpvaW4gdGFibGUgaXMgYmVzdCBtYXRjaAog\nICAgICAgIFN0cmluZyBiZXN0ID0gdGFibGVOYW1lOwogICAgICAgIGludCBw\ndHMgPSAwOwogICAgICAgIFN0cmluZyBmdWxsSm9pbjsKICAgICAgICBTdHJp\nbmcgam9pbjsKICAgICAgICBpbnQgaWR4OwogICAgICAgIGZvciAoSXRlcmF0\nb3IgaXRyID0gX3NlY29uZHMua2V5U2V0KCkuaXRlcmF0b3IoKTsgaXRyLmhh\nc05leHQoKTspIHsKICAgICAgICAgICAgLy8gYXdhcmQgYSBjYXNlbGVzcyBt\nYXRjaCB3aXRob3V0IHNjaGVtYSAyIHBvaW50cwogICAgICAgICAgICBmdWxs\nSm9pbiA9IChTdHJpbmcpIGl0ci5uZXh0KCk7CiAgICAgICAgICAgIGlkeCA9\nIGZ1bGxKb2luLmxhc3RJbmRleE9mKCcuJyk7CiAgICAgICAgICAgIGlmIChp\nZHggPT0gLTEgJiYgcHRzIDwgMiAmJiBmdWxsSm9pbi5lcXVhbHNJZ25vcmVD\nYXNlKHRhYmxlTmFtZSkpIHsKICAgICAgICAgICAgICAgIGJlc3QgPSBmdWxs\nSm9pbjsKICAgICAgICAgICAgICAgIHB0cyA9IDI7CiAgICAgICAgICAgIH0g\nZWxzZSBpZiAoaWR4ID09IC0xKQogICAgICAgICAgICAgICAgY29udGludWU7\nCgogICAgICAgICAgICAvLyBpbW1lZGlhdGVseSByZXR1cm4gYW4gZXhhY3Qg\nbWF0Y2ggd2l0aCBzY2hlbWEKICAgICAgICAgICAgam9pbiA9IGZ1bGxKb2lu\nLnN1YnN0cmluZyhpZHggKyAxKTsKICAgICAgICAgICAgaWYgKGpvaW4uZXF1\nYWxzKHRhYmxlTmFtZSkpCiAgICAgICAgICAgICAgICByZXR1cm4gZnVsbEpv\naW47CgogICAgICAgICAgICAvLyBjYXNlbGVzcyBtYXRjaCB3aXRoIHNjaGVt\nYSB3b3J0aCAxIHBvaW50CiAgICAgICAgICAgIGlmIChwdHMgPCAxICYmIGpv\naW4uZXF1YWxzSWdub3JlQ2FzZSh0YWJsZU5hbWUpKSB7CiAgICAgICAgICAg\nICAgICBiZXN0ID0gZnVsbEpvaW47CiAgICAgICAgICAgICAgICBwdHMgPSAx\nOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiBiZXN0\nOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIGFueSBjb2x1bW5zIGRl\nZmluZWQgZm9yIHRoZSBnaXZlbiBjbGFzcyBsZXZlbCBqb2luLCBvciBlbXB0\neQogICAgICogbGlzdCBpZiBub25lLgogICAgICovCiAgICBwdWJsaWMgTGlz\ndCBnZXRTZWNvbmRhcnlUYWJsZUpvaW5Db2x1bW5zKFN0cmluZyB0YWJsZU5h\nbWUpIHsKICAgICAgICBpZiAoX3NlY29uZHMgPT0gbnVsbCB8fCB0YWJsZU5h\nbWUgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIENvbGxlY3Rpb25zLkVN\nUFRZX0xJU1Q7CgogICAgICAgIC8vIGdldCB0aGUgY29sdW1ucyBmb3IgdGhl\nIGpvaW4gd2l0aCB0aGUgYmVzdCBtYXRjaCBmb3IgdGFibGUgbmFtZQogICAg\nICAgIExpc3QgY29scyA9IChMaXN0KSBfc2Vjb25kcy5nZXQoZ2V0U2Vjb25k\nYXJ5VGFibGVOYW1lKHRhYmxlTmFtZSkpOwogICAgICAgIGlmIChjb2xzID09\nIG51bGwpIHsKICAgICAgICAgICAgLy8gcG9zc2libGUgdGhhdCBnaXZlbiB0\nYWJsZSBoYXMgZXh0cmEgaW5mbyB0aGUgam9pbiB0YWJsZQogICAgICAgICAg\nICAvLyBkb2Vzbid0IGhhdmU7IHN0cmlwIGl0CiAgICAgICAgICAgIGludCBp\nZHggPSB0YWJsZU5hbWUubGFzdEluZGV4T2YoJy4nKTsKICAgICAgICAgICAg\naWYgKGlkeCAhPSAtMSkgewogICAgICAgICAgICAgICAgdGFibGVOYW1lID0g\ndGFibGVOYW1lLnN1YnN0cmluZyhpZHggKyAxKTsKICAgICAgICAgICAgICAg\nIGNvbHMgPSAoTGlzdCkgX3NlY29uZHMuZ2V0KGdldFNlY29uZGFyeVRhYmxl\nTmFtZSh0YWJsZU5hbWUpKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAg\nICAgICByZXR1cm4gKGNvbHMgPT0gbnVsbCkgPyBDb2xsZWN0aW9ucy5FTVBU\nWV9MSVNUIDogY29sczsKICAgIH0KCiAgICAvKioKICAgICAqIERlY2xhcmUg\ndGhlIGdpdmVuIGNsYXNzLWxldmVsIGpvaW4uCiAgICAgKi8KICAgIHB1Ymxp\nYyB2b2lkIHNldFNlY29uZGFyeVRhYmxlSm9pbkNvbHVtbnMoU3RyaW5nIHRh\nYmxlTmFtZSwgTGlzdCBjb2xzKSB7CiAgICAgICAgaWYgKGNvbHMgPT0gbnVs\nbCkKICAgICAgICAgICAgY29scyA9IENvbGxlY3Rpb25zLkVNUFRZX0xJU1Q7\nCiAgICAgICAgaWYgKF9zZWNvbmRzID09IG51bGwpCiAgICAgICAgICAgIF9z\nZWNvbmRzID0gbmV3IEhhc2hNYXAoKTsKICAgICAgICBfc2Vjb25kcy5wdXQo\ndGFibGVOYW1lLCBjb2xzKTsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVy\nbiB0aGUgdGFibGUgZm9yIHRoZSBnaXZlbiBjbGFzcy4KICAgICAqLwogICAg\ncHVibGljIFRhYmxlIGdldFRhYmxlKGZpbmFsIENsYXNzTWFwcGluZyBjbHMs\nIGJvb2xlYW4gYWRhcHQpIHsKICAgICAgICByZXR1cm4gY3JlYXRlVGFibGUo\nY2xzLCBuZXcgVGFibGVEZWZhdWx0cygpIHsKICAgICAgICAgICAgcHVibGlj\nIFN0cmluZyBnZXQoU2NoZW1hIHNjaGVtYSkgewogICAgICAgICAgICAgICAg\nLy8gZGVsYXkgdGhpcyBzbyB0aGF0IHdlIGRvbid0IGRvIHNjaGVtYSByZWZs\nZWN0aW9uIGZvciB1bmlxdWUKICAgICAgICAgICAgICAgIC8vIHRhYmxlIG5h\nbWUgdW5sZXNzIG5lY2Vzc2FyeQogICAgICAgICAgICAgICAgcmV0dXJuIGNs\ncy5nZXRNYXBwaW5nUmVwb3NpdG9yeSgpLmdldE1hcHBpbmdEZWZhdWx0cygp\nLgogICAgICAgICAgICAgICAgICAgIGdldFRhYmxlTmFtZShjbHMsIHNjaGVt\nYSk7CiAgICAgICAgICAgIH0KICAgICAgICB9LCBfc2NoZW1hTmFtZSwgX3Rh\nYmxlTmFtZSwgYWRhcHQpOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJu\nIHRoZSBkYXRhc3RvcmUgaWRlbnRpdHkgY29sdW1ucyBmb3IgdGhlIGdpdmVu\nIGNsYXNzLCBiYXNlZCBvbiB0aGUKICAgICAqIGdpdmVuIHRlbXBsYXRlcy4K\nICAgICAqLwogICAgcHVibGljIENvbHVtbltdIGdldERhdGFTdG9yZUlkQ29s\ndW1ucyhDbGFzc01hcHBpbmcgY2xzLCBDb2x1bW5bXSB0bXBsYXRlcywKICAg\nICAgICBUYWJsZSB0YWJsZSwgYm9vbGVhbiBhZGFwdCkgewogICAgICAgIGNs\ncy5nZXRNYXBwaW5nUmVwb3NpdG9yeSgpLmdldE1hcHBpbmdEZWZhdWx0cygp\nLgogICAgICAgICAgICBwb3B1bGF0ZURhdGFTdG9yZUlkQ29sdW1ucyhjbHMs\nIHRhYmxlLCB0bXBsYXRlcyk7CiAgICAgICAgcmV0dXJuIGNyZWF0ZUNvbHVt\nbnMoY2xzLCAiZGF0YXN0b3JlaWQiLCB0bXBsYXRlcywgdGFibGUsIGFkYXB0\nKTsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgam9pbiBmcm9t\nIHRoaXMgY2xhc3MgdG8gaXRzIHN1cGVyY2xhc3MuIFRoZSB0YWJsZSBmb3IK\nICAgICAqIHRoaXMgY2xhc3MgbXVzdCBiZSBzZXQuCiAgICAgKi8KICAgIHB1\nYmxpYyBGb3JlaWduS2V5IGdldFN1cGVyY2xhc3NKb2luKGZpbmFsIENsYXNz\nTWFwcGluZyBjbHMsIFRhYmxlIHRhYmxlLAogICAgICAgIGJvb2xlYW4gYWRh\ncHQpIHsKICAgICAgICBDbGFzc01hcHBpbmcgc3VwID0gY2xzLmdldEpvaW5h\nYmxlUENTdXBlcmNsYXNzTWFwcGluZygpOwogICAgICAgIGlmIChzdXAgPT0g\nbnVsbCkKICAgICAgICAgICAgcmV0dXJuIG51bGw7CgogICAgICAgIEZvcmVp\nZ25LZXlEZWZhdWx0cyBkZWYgPSBuZXcgRm9yZWlnbktleURlZmF1bHRzKCkg\newogICAgICAgICAgICBwdWJsaWMgRm9yZWlnbktleSBnZXQoVGFibGUgbG9j\nYWwsIFRhYmxlIGZvcmVpZ24sIGJvb2xlYW4gaW52ZXJzZSkgewogICAgICAg\nICAgICAgICAgcmV0dXJuIGNscy5nZXRNYXBwaW5nUmVwb3NpdG9yeSgpLmdl\ndE1hcHBpbmdEZWZhdWx0cygpLgogICAgICAgICAgICAgICAgICAgIGdldEpv\naW5Gb3JlaWduS2V5KGNscywgbG9jYWwsIGZvcmVpZ24pOwogICAgICAgICAg\nICB9CgogICAgICAgICAgICBwdWJsaWMgdm9pZCBwb3B1bGF0ZShUYWJsZSBs\nb2NhbCwgVGFibGUgZm9yZWlnbiwgQ29sdW1uIGNvbCwKICAgICAgICAgICAg\nICAgIE9iamVjdCB0YXJnZXQsIGJvb2xlYW4gaW52ZXJzZSwgaW50IHBvcywg\naW50IGNvbHMpIHsKICAgICAgICAgICAgICAgIGNscy5nZXRNYXBwaW5nUmVw\nb3NpdG9yeSgpLmdldE1hcHBpbmdEZWZhdWx0cygpLgogICAgICAgICAgICAg\nICAgICAgIHBvcHVsYXRlSm9pbkNvbHVtbihjbHMsIGxvY2FsLCBmb3JlaWdu\nLCBjb2wsIHRhcmdldCwKICAgICAgICAgICAgICAgICAgICAgICAgcG9zLCBj\nb2xzKTsKICAgICAgICAgICAgfQogICAgICAgIH07CiAgICAgICAgcmV0dXJu\nIGNyZWF0ZUZvcmVpZ25LZXkoY2xzLCAic3VwZXJjbGFzcyIsIGdldENvbHVt\nbnMoKSwgZGVmLCB0YWJsZSwKICAgICAgICAgICAgY2xzLCBzdXAsIGZhbHNl\nLCBhZGFwdCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBTeW5jaHJvbml6ZSBp\nbnRlcm5hbCBpbmZvcm1hdGlvbiB3aXRoIHRoZSBtYXBwaW5nIGRhdGEgZm9y\nIHRoZSBnaXZlbgogICAgICogY2xhc3MuCiAgICAgKi8KICAgIHB1YmxpYyB2\nb2lkIHN5bmNXaXRoKENsYXNzTWFwcGluZyBjbHMpIHsKICAgICAgICBjbGVh\ncihmYWxzZSk7CgogICAgICAgIENsYXNzTWFwcGluZyBzdXAgPSBjbHMuZ2V0\nTWFwcGVkUENTdXBlcmNsYXNzTWFwcGluZygpOwogICAgICAgIGlmIChjbHMu\nZ2V0VGFibGUoKSAhPSBudWxsICYmIChzdXAgPT0gbnVsbAogICAgICAgICAg\nICB8fCBzdXAuZ2V0VGFibGUoKSAhPSBjbHMuZ2V0VGFibGUoKSkpCiAgICAg\nICAgICAgIF90YWJsZU5hbWUgPSBjbHMuZ2V0TWFwcGluZ1JlcG9zaXRvcnko\nKS5nZXREQkRpY3Rpb25hcnkoKS4KICAgICAgICAgICAgICAgIGdldEZ1bGxO\nYW1lKGNscy5nZXRUYWJsZSgpLCB0cnVlKTsKCiAgICAgICAgLy8gc2V0IGlv\nIGJlZm9yZSBzeW5jaW5nIGNvbHMKICAgICAgICBzZXRDb2x1bW5JTyhjbHMu\nZ2V0Q29sdW1uSU8oKSk7CiAgICAgICAgaWYgKGNscy5nZXRKb2luRm9yZWln\nbktleSgpICE9IG51bGwgJiYgc3VwICE9IG51bGwKICAgICAgICAgICAgJiYg\nc3VwLmdldFRhYmxlKCkgIT0gbnVsbCkKICAgICAgICAgICAgc3luY0ZvcmVp\nZ25LZXkoY2xzLCBjbHMuZ2V0Sm9pbkZvcmVpZ25LZXkoKSwgY2xzLmdldFRh\nYmxlKCksCiAgICAgICAgICAgICAgICBzdXAuZ2V0VGFibGUoKSk7CiAgICAg\nICAgZWxzZSBpZiAoY2xzLmdldElkZW50aXR5VHlwZSgpID09IENsYXNzTWFw\ncGluZy5JRF9EQVRBU1RPUkUpCiAgICAgICAgICAgIHN5bmNDb2x1bW5zKGNs\ncywgY2xzLmdldFByaW1hcnlLZXlDb2x1bW5zKCksIGZhbHNlKTsKCiAgICAg\nICAgLy8gcmVjb3JkIGluaGVyaXRhbmNlIHN0cmF0ZWd5IGlmIGNsYXNzIGRv\nZXMgbm90IHVzZSBkZWZhdWx0IHN0cmF0ZWd5CiAgICAgICAgLy8gZm9yIGJh\nc2UgY2xhc3NlcywgYW5kIGZvciBhbGwgc3ViY2xhc3NlcyBzbyB3ZSBjYW4g\nYmUgc3VyZSBzdWJzZXF1ZW50CiAgICAgICAgLy8gbWFwcGluZyBydW5zIGRv\nbid0IHRoaW5rIHN1YmNsYXNzIGlzIHVubWFwcGVkCiAgICAgICAgU3RyaW5n\nIHN0cmF0ID0gKGNscy5nZXRTdHJhdGVneSgpID09IG51bGwpID8gbnVsbAog\nICAgICAgICAgICA6IGNscy5nZXRTdHJhdGVneSgpLmdldEFsaWFzKCk7CiAg\nICAgICAgaWYgKHN0cmF0ICE9IG51bGwgJiYgKGNscy5nZXRQQ1N1cGVyY2xh\nc3MoKSAhPSBudWxsCiAgICAgICAgICAgIHx8ICFGdWxsQ2xhc3NTdHJhdGVn\neS5BTElBUy5lcXVhbHMoc3RyYXQpKSkKICAgICAgICAgICAgc2V0U3RyYXRl\nZ3koc3RyYXQpOyAgICAgICAgCiAgICB9CgogICAgcHVibGljIGJvb2xlYW4g\naGFzU2NoZW1hQ29tcG9uZW50cygpIHsKICAgICAgICByZXR1cm4gc3VwZXIu\naGFzU2NoZW1hQ29tcG9uZW50cygpIHx8IF90YWJsZU5hbWUgIT0gbnVsbDsK\nICAgIH0KCiAgICBwcm90ZWN0ZWQgdm9pZCBjbGVhcihib29sZWFuIGNhbkZs\nYWdzKSB7CiAgICAgICAgc3VwZXIuY2xlYXIoY2FuRmxhZ3MpOwogICAgICAg\nIF90YWJsZU5hbWUgPSBudWxsOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIGNv\ncHkoTWFwcGluZ0luZm8gaW5mbykgewogICAgICAgIHN1cGVyLmNvcHkoaW5m\nbyk7CiAgICAgICAgaWYgKCEoaW5mbyBpbnN0YW5jZW9mIENsYXNzTWFwcGlu\nZ0luZm8pKQogICAgICAgICAgICByZXR1cm47CgogICAgICAgIENsYXNzTWFw\ncGluZ0luZm8gY2luZm8gPSAoQ2xhc3NNYXBwaW5nSW5mbykgaW5mbzsKICAg\nICAgICBpZiAoX3RhYmxlTmFtZSA9PSBudWxsKQogICAgICAgICAgICBfdGFi\nbGVOYW1lID0gY2luZm8uZ2V0VGFibGVOYW1lKCk7CiAgICAgICAgaWYgKF9z\ndWJTdHJhdCA9PSBudWxsKQogICAgICAgICAgICBfc3ViU3RyYXQgPSBjaW5m\nby5nZXRIaWVyYXJjaHlTdHJhdGVneSgpOwogICAgICAgIGlmIChjaW5mby5f\nc2Vjb25kcyAhPSBudWxsKSB7CiAgICAgICAgICAgIGlmIChfc2Vjb25kcyA9\nPSBudWxsKQogICAgICAgICAgICAgICAgX3NlY29uZHMgPSBuZXcgSGFzaE1h\ncCgpOwogICAgICAgICAgICBPYmplY3Qga2V5OwogICAgICAgICAgICBmb3Ig\nKEl0ZXJhdG9yIGl0ciA9IGNpbmZvLl9zZWNvbmRzLmtleVNldCgpLml0ZXJh\ndG9yKCk7CiAgICAgICAgICAgICAgICBpdHIuaGFzTmV4dCgpOykgewogICAg\nICAgICAgICAgICAga2V5ID0gaXRyLm5leHQoKTsKICAgICAgICAgICAgICAg\nIGlmICghX3NlY29uZHMuY29udGFpbnNLZXkoa2V5KSkKICAgICAgICAgICAg\nICAgICAgICBfc2Vjb25kcy5wdXQoa2V5LCBjaW5mby5fc2Vjb25kcy5nZXQo\na2V5KSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgaWYgKGNp\nbmZvLl91bmlxdWVzICE9IG51bGwpIAogICAgICAgICAgIF91bmlxdWVzID0g\nbmV3IEFycmF5TGlzdChjaW5mby5fdW5pcXVlcyk7CiAgICB9CgogICAgcHVi\nbGljIHZvaWQgYWRkVW5pcXVlKFVuaXF1ZSB1bmlxdWUpIHsKICAgICAgICBp\nZiAodW5pcXVlID09IG51bGwpCiAgICAgICAgICAgIHJldHVybjsKICAgICAg\nICBpZiAoX3VuaXF1ZXMgPT0gbnVsbCkKICAgICAgICAgICAgX3VuaXF1ZXMg\nPSBuZXcgQXJyYXlMaXN0KCk7CiAgICAgICAgX3VuaXF1ZXMuYWRkKHVuaXF1\nZSk7CiAgICB9CiAgICAKICAgIHB1YmxpYyBVbmlxdWVbXSBnZXRVbmlxdWVz\nKCkgewogICAgICAgIHJldHVybiAoX3VuaXF1ZXMgPT0gbnVsbCkgPyBuZXcg\nVW5pcXVlWzBdIDoKICAgICAgICAgICAgKFVuaXF1ZVtdKV91bmlxdWVzLnRv\nQXJyYXkobmV3IFVuaXF1ZVtfdW5pcXVlcy5zaXplKCldKTsKICAgIH0KICAg\nIAogICAgcHVibGljIFVuaXF1ZVtdIGdldFVuaXF1ZXMoQ2xhc3NNYXBwaW5n\nIGNtLCBib29sZWFuIGFkYXB0KSB7CiAgICAgICAgaWYgKF91bmlxdWVzID09\nIG51bGwgfHwgX3VuaXF1ZXMuaXNFbXB0eSgpKQogICAgICAgICAgICByZXR1\ncm4gbmV3IFVuaXF1ZVswXTsKICAgICAgICAKICAgICAgICBJdGVyYXRvciB1\nbmlxdWVDb25zdHJhaW50cyA9IF91bmlxdWVzLml0ZXJhdG9yKCk7CiAgICAg\nICAgVGFibGUgdGFibGUgPSBjbS5nZXRUYWJsZSgpOwogICAgICAgIENvbGxl\nY3Rpb24gcmVzdWx0ID0gbmV3IEFycmF5TGlzdCgpOwogICAgICAgIHdoaWxl\nICh1bmlxdWVDb25zdHJhaW50cy5oYXNOZXh0KCkpIHsKICAgICAgICAgICAg\nVW5pcXVlIHRlbXBsYXRlID0gKFVuaXF1ZSkgdW5pcXVlQ29uc3RyYWludHMu\nbmV4dCgpOwogICAgICAgICAgICBDb2x1bW5bXSB0ZW1wbGF0ZUNvbHVtbnMg\nPSB0ZW1wbGF0ZS5nZXRDb2x1bW5zKCk7CiAgICAgICAgICAgIENvbHVtbltd\nIHVuaXF1ZUNvbHVtbnMgPSBuZXcgQ29sdW1uW3RlbXBsYXRlQ29sdW1ucy5s\nZW5ndGhdOwogICAgICAgICAgICBib29sZWFuIG1pc3NpbmdDb2x1bW4gPSB0\ncnVlOwogICAgICAgICAgICBmb3IgKGludCBpPTA7IGk8dW5pcXVlQ29sdW1u\ncy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgU3RyaW5nIGNvbHVt\nbk5hbWUgPSB0ZW1wbGF0ZUNvbHVtbnNbaV0uZ2V0TmFtZSgpOwogICAgICAg\nICAgICAgICAgQ29sdW1uIHVuaXF1ZUNvbHVtbiA9IHRhYmxlLmdldENvbHVt\nbihjb2x1bW5OYW1lKTsKICAgICAgICAgICAgICAgIG1pc3NpbmdDb2x1bW4g\nPSAodW5pcXVlQ29sdW1uID09IG51bGwpOwogICAgICAgICAgICAgICAgaWYg\nKG1pc3NpbmdDb2x1bW4pIHsKICAgICAgICAgICAgICAgICAgICB0aHJvdyBu\nZXcgVXNlckV4Y2VwdGlvbihfbG9jLmdldCgibWlzc2luZy11bmlxdWUtY29s\ndW1uIiwgCiAgICAgICAgICAgICAgICAgICAgICAgIGNtLCB0YWJsZSwgY29s\ndW1uTmFtZSkpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAg\ndW5pcXVlQ29sdW1uc1tpXSA9IHVuaXF1ZUNvbHVtbjsKICAgICAgICAgICAg\nfQogICAgICAgICAgICBVbmlxdWUgdW5pcXVlID0gc3VwZXIuY3JlYXRlVW5p\ncXVlKGNtLCAidW5pcXVlIiwgdGVtcGxhdGUsIAogICAgICAgICAgICAgICAg\ndW5pcXVlQ29sdW1ucywgYWRhcHQpOwogICAgICAgICAgICBpZiAodW5pcXVl\nICE9IG51bGwpCiAgICAgICAgICAgICAgICByZXN1bHQuYWRkKHVuaXF1ZSk7\nCiAgICAgICAgfQogICAgICAgIHJldHVybiAoVW5pcXVlW10pIHJlc3VsdC50\nb0FycmF5KG5ldyBVbmlxdWVbcmVzdWx0LnNpemUoKV0pOwogICAgfSAgIAog\nICAgCiAgICBwdWJsaWMgRmlsZSBnZXRTb3VyY2VGaWxlKCkgewogICAgICAg\nIHJldHVybiBfZmlsZTsKICAgIH0KCiAgICBwdWJsaWMgT2JqZWN0IGdldFNv\ndXJjZVNjb3BlKCkgewogICAgICAgIHJldHVybiBudWxsOwogICAgfQoKICAg\nIHB1YmxpYyBpbnQgZ2V0U291cmNlVHlwZSgpIHsKICAgICAgICByZXR1cm4g\nX3NyY1R5cGU7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0U291cmNlKEZp\nbGUgZmlsZSwgaW50IHNyY1R5cGUpIHsKICAgICAgICBfZmlsZSA9IGZpbGU7\nCiAgICAgICAgX3NyY1R5cGUgPSBzcmNUeXBlOwogICAgfQoKICAgIHB1Ymxp\nYyBTdHJpbmcgZ2V0UmVzb3VyY2VOYW1lKCkgewogICAgICAgIHJldHVybiBf\nY2xhc3NOYW1lOwogICAgfQoKICAgIHB1YmxpYyBTdHJpbmdbXSBnZXRDb21t\nZW50cygpIHsKICAgICAgICByZXR1cm4gKF9jb21tZW50cyA9PSBudWxsKSA/\nIEVNUFRZX0NPTU1FTlRTIDogX2NvbW1lbnRzOwogICAgfQoKICAgIHB1Ymxp\nYyB2b2lkIHNldENvbW1lbnRzKFN0cmluZ1tdIGNvbW1lbnRzKSB7CiAgICAg\nICAgX2NvbW1lbnRzID0gY29tbWVudHM7CiAgICB9Cn0K\n","encoding":"base64"}

