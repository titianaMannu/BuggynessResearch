{"sha":"84af12c020fea0f7a9cea36162a3850748a585ae","node_id":"MDQ6QmxvYjIwNjM2NDo4NGFmMTJjMDIwZmVhMGY3YTljZWEzNjE2MmEzODUwNzQ4YTU4NWFl","size":42528,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/84af12c020fea0f7a9cea36162a3850748a585ae","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhOwoKaW1wb3J0\nIGphdmEuaW8uRmlsZTsKaW1wb3J0IGphdmEuaW8uSU9FeGNlcHRpb247Cmlt\ncG9ydCBqYXZhLmlvLlByaW50V3JpdGVyOwppbXBvcnQgamF2YS5pby5Xcml0\nZXI7CmltcG9ydCBqYXZhLnNlY3VyaXR5LkFjY2Vzc0NvbnRyb2xsZXI7Cmlt\ncG9ydCBqYXZhLnNlY3VyaXR5LlByaXZpbGVnZWRBY3Rpb25FeGNlcHRpb247\nCmltcG9ydCBqYXZhLnNxbC5TUUxFeGNlcHRpb247CmltcG9ydCBqYXZhLnV0\naWwuQXJyYXlzOwppbXBvcnQgamF2YS51dGlsLkNvbGxlY3Rpb247CmltcG9y\ndCBqYXZhLnV0aWwuSGFzaE1hcDsKaW1wb3J0IGphdmEudXRpbC5IYXNoU2V0\nOwppbXBvcnQgamF2YS51dGlsLkl0ZXJhdG9yOwppbXBvcnQgamF2YS51dGls\nLk1hcDsKaW1wb3J0IGphdmEudXRpbC5TZXQ7CgppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLmNvbmYuT3BlbkpQQUNvbmZpZ3VyYXRpb247CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEuamRiYy5jb25mLkpEQkNDb25maWd1cmF0aW9u\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuY29uZi5KREJDQ29u\nZmlndXJhdGlvbkltcGw7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRi\nYy5rZXJuZWwuSkRCQ1NlcTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5q\nZGJjLnNjaGVtYS5Db2x1bW47CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\namRiYy5zY2hlbWEuRHluYW1pY1NjaGVtYUZhY3Rvcnk7CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hlbWEuTGF6eVNjaGVtYUZhY3Rvcnk7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hlbWEuU2NoZW1h\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1hLlNjaGVt\nYUdlbmVyYXRvcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNj\naGVtYS5TY2hlbWFHcm91cDsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5q\nZGJjLnNjaGVtYS5TY2hlbWFTZXJpYWxpemVyOwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLmpkYmMuc2NoZW1hLlNjaGVtYVRvb2w7CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hlbWEuVGFibGU7CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hlbWEuWE1MU2NoZW1hU2VyaWFsaXpl\ncjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNxbC5EQkRpY3Rp\nb25hcnk7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLlNlcTsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIuY29uZi5Db25maWd1cmF0\naW9uczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIubG9nLkxvZzsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIubWV0YS5DbGFzc0FyZ1Bh\ncnNlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIudXRpbC5GaWxl\nczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIudXRpbC5KMkRvUHJp\ndkhlbHBlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIudXRpbC5M\nb2NhbGl6ZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwu\nT3B0aW9uczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIudXRpbC5T\nZXJ2aWNlczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRhLkNsYXNz\nTWV0YURhdGE7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YS5GaWVs\nZE1ldGFEYXRhOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuSmF2\nYVR5cGVzOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuTWV0YURh\ndGFGYWN0b3J5OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuTWV0\nYURhdGFNb2RlczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRhLlF1\nZXJ5TWV0YURhdGE7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YS5T\nZXF1ZW5jZU1ldGFEYXRhOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1l\ndGEuVmFsdWVTdHJhdGVnaWVzOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLnV0aWwuR2VuZXJhbEV4Y2VwdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS51dGlsLkludGVybmFsRXhjZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLnV0aWwuTWV0YURhdGFFeGNlcHRpb247CgovKioKICogVG9v\nbCBmb3IgbWFuaXB1bGF0aW5nIGNsYXNzIG1hcHBpbmdzIGFuZCBhc3NvY2lh\ndGVkIHNjaGVtYS4KICoKICogQGF1dGhvciBBYmUgV2hpdGUKICovCnB1Ymxp\nYyBjbGFzcyBNYXBwaW5nVG9vbAogICAgaW1wbGVtZW50cyBNZXRhRGF0YU1v\nZGVzIHsKCiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIFN0cmluZyBTQ0hFTUFf\nQUNUSU9OX05PTkUgPSAibm9uZSI7CgogICAgcHVibGljIHN0YXRpYyBmaW5h\nbCBTdHJpbmcgQUNUSU9OX0FERCA9ICJhZGQiOwogICAgcHVibGljIHN0YXRp\nYyBmaW5hbCBTdHJpbmcgQUNUSU9OX1JFRlJFU0ggPSAicmVmcmVzaCI7CiAg\nICBwdWJsaWMgc3RhdGljIGZpbmFsIFN0cmluZyBBQ1RJT05fQlVJTERfU0NI\nRU1BID0gImJ1aWxkU2NoZW1hIjsKICAgIHB1YmxpYyBzdGF0aWMgZmluYWwg\nU3RyaW5nIEFDVElPTl9EUk9QID0gImRyb3AiOwogICAgcHVibGljIHN0YXRp\nYyBmaW5hbCBTdHJpbmcgQUNUSU9OX1ZBTElEQVRFID0gInZhbGlkYXRlIjsK\nICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgU3RyaW5nIEFDVElPTl9FWFBPUlQg\nPSAiZXhwb3J0IjsKICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgU3RyaW5nIEFD\nVElPTl9JTVBPUlQgPSAiaW1wb3J0IjsKCiAgICBwdWJsaWMgc3RhdGljIGZp\nbmFsIFN0cmluZ1tdIEFDVElPTlMgPSBuZXcgU3RyaW5nW117CiAgICAgICAg\nQUNUSU9OX0FERCwKICAgICAgICBBQ1RJT05fUkVGUkVTSCwKICAgICAgICBB\nQ1RJT05fQlVJTERfU0NIRU1BLAogICAgICAgIEFDVElPTl9EUk9QLAogICAg\nICAgIEFDVElPTl9WQUxJREFURSwKICAgICAgICBBQ1RJT05fRVhQT1JULAog\nICAgICAgIEFDVElPTl9JTVBPUlQsCiAgICB9OwoKICAgIHByaXZhdGUgc3Rh\ndGljIExvY2FsaXplciBfbG9jID0gTG9jYWxpemVyLmZvclBhY2thZ2UoTWFw\ncGluZ1Rvb2wuY2xhc3MpOwoKICAgIHByaXZhdGUgZmluYWwgSkRCQ0NvbmZp\nZ3VyYXRpb24gX2NvbmY7CiAgICBwcml2YXRlIGZpbmFsIExvZyBfbG9nOwog\nICAgcHJpdmF0ZSBmaW5hbCBTdHJpbmcgX2FjdGlvbjsKICAgIHByaXZhdGUg\nZmluYWwgYm9vbGVhbiBfbWV0YTsKICAgIHByaXZhdGUgZmluYWwgaW50IF9t\nb2RlOwoKICAgIHByaXZhdGUgTWFwcGluZ1JlcG9zaXRvcnkgX3JlcG9zID0g\nbnVsbDsKICAgIHByaXZhdGUgU2NoZW1hR3JvdXAgX3NjaGVtYSA9IG51bGw7\nCiAgICBwcml2YXRlIFNjaGVtYVRvb2wgX3NjaGVtYVRvb2wgPSBudWxsOwog\nICAgcHJpdmF0ZSBTdHJpbmcgX3NjaGVtYUFjdGlvbnMgPSBTY2hlbWFUb29s\nLkFDVElPTl9BREQ7CiAgICBwcml2YXRlIGJvb2xlYW4gX3JlYWRTY2hlbWEg\nPSBmYWxzZTsKICAgIHByaXZhdGUgYm9vbGVhbiBfcGtzID0gZmFsc2U7CiAg\nICBwcml2YXRlIGJvb2xlYW4gX2ZrcyA9IGZhbHNlOwogICAgcHJpdmF0ZSBi\nb29sZWFuIF9pbmRleGVzID0gZmFsc2U7CiAgICBwcml2YXRlIGJvb2xlYW4g\nX3NlcXMgPSB0cnVlOwogICAgcHJpdmF0ZSBib29sZWFuIF9kcm9wVW51c2Vk\nID0gdHJ1ZTsKICAgIHByaXZhdGUgYm9vbGVhbiBfaWdub3JlRXJyb3JzID0g\nZmFsc2U7CiAgICBwcml2YXRlIEZpbGUgX2ZpbGUgPSBudWxsOwogICAgcHJp\ndmF0ZSBXcml0ZXIgX21hcHBpbmdXcml0ZXIgPSBudWxsOwogICAgcHJpdmF0\nZSBXcml0ZXIgX3NjaGVtYVdyaXRlciA9IG51bGw7CgogICAgLy8gYnVmZmVy\nIG1ldGFkYXRhcyB0byBiZSBkcm9wcGVkCiAgICBwcml2YXRlIFNldCBfZHJv\ncENscyA9IG51bGw7CiAgICBwcml2YXRlIFNldCBfZHJvcE1hcCA9IG51bGw7\nCiAgICBwcml2YXRlIGJvb2xlYW4gX2ZsdXNoID0gZmFsc2U7CiAgICBwcml2\nYXRlIGJvb2xlYW4gX2ZsdXNoU2NoZW1hID0gZmFsc2U7CgogICAgLyoqCiAg\nICAgKiBDb25zdHJ1Y3Rvci4gU3VwcGx5IGNvbmZpZ3VyYXRpb24gYW5kIGFj\ndGlvbi4KICAgICAqLwogICAgcHVibGljIE1hcHBpbmdUb29sKEpEQkNDb25m\naWd1cmF0aW9uIGNvbmYsIFN0cmluZyBhY3Rpb24sIGJvb2xlYW4gbWV0YSkg\newogICAgICAgIF9jb25mID0gY29uZjsKICAgICAgICBfbG9nID0gY29uZi5n\nZXRMb2coSkRCQ0NvbmZpZ3VyYXRpb24uTE9HX01FVEFEQVRBKTsKICAgICAg\nICBfbWV0YSA9IG1ldGE7CgogICAgICAgIGlmIChhY3Rpb24gPT0gbnVsbCkK\nICAgICAgICAgICAgX2FjdGlvbiA9IEFDVElPTl9SRUZSRVNIOwogICAgICAg\nIGVsc2UgaWYgKCFBcnJheXMuYXNMaXN0KEFDVElPTlMpLmNvbnRhaW5zKGFj\ndGlvbikpCiAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRF\neGNlcHRpb24oImFjdGlvbiA9PSAiICsgYWN0aW9uKTsKICAgICAgICBlbHNl\nCiAgICAgICAgICAgIF9hY3Rpb24gPSBhY3Rpb247CgogICAgICAgIGlmICht\nZXRhICYmIEFDVElPTl9BREQuZXF1YWxzKF9hY3Rpb24pKQogICAgICAgICAg\nICBfbW9kZSA9IE1PREVfTUVUQTsKICAgICAgICBlbHNlIGlmIChtZXRhICYm\nIEFDVElPTl9EUk9QLmVxdWFscyhfYWN0aW9uKSkKICAgICAgICAgICAgX21v\nZGUgPSBNT0RFX01FVEEgfCBNT0RFX01BUFBJTkcgfCBNT0RFX1FVRVJZOwog\nICAgICAgIGVsc2UKICAgICAgICAgICAgX21vZGUgPSBNT0RFX01BUFBJTkc7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBUaGUgYWN0aW9uIHN1cHBsaWVkIG9u\nIGNvbnN0cnVjdGlvbi4KICAgICAqLwogICAgcHVibGljIFN0cmluZyBnZXRB\nY3Rpb24oKSB7CiAgICAgICAgcmV0dXJuIF9hY3Rpb247CiAgICB9CgogICAg\nLyoqCiAgICAgKiBXaGV0aGVyIHRoZSBhY3Rpb24gd29ya3Mgb24gbWV0YWRh\ndGEgYXMgd2VsbCBhcyBtYXBwaW5ncy4KICAgICAqLwogICAgcHVibGljIGJv\nb2xlYW4gaXNNZXRhRGF0YUFjdGlvbigpIHsKICAgICAgICByZXR1cm4gX21l\ndGE7CiAgICB9CgogICAgLyoqCiAgICAgKiBUaGUgc2NoZW1hIG1vZGlmaWNh\ndGlvbiBwb2xpY3ksIG9yIDxjb2RlPm5vbmU8L2NvZGU+LiBTZWUgdGhlCiAg\nICAgKiBBQ1RJT04gY29uc3RhbnRzIGluIHtAbGluayBTY2hlbWFUb29sfS4g\nTWF5IGJlIGEgY29tbWEtc2VwYXJhdGVkCiAgICAgKiBsaXN0IG9mIHZhbHVl\ncy4gRGVmYXVsdHMgdG8ge0BsaW5rIFNjaGVtYVRvb2wjQUNUSU9OX0FERH0u\nCiAgICAgKi8KICAgIHB1YmxpYyBTdHJpbmcgZ2V0U2NoZW1hQWN0aW9uKCkg\newogICAgICAgIHJldHVybiBfc2NoZW1hQWN0aW9uczsKICAgIH0KCiAgICAv\nKioKICAgICAqIFRoZSBzY2hlbWEgbW9kaWZpY2F0aW9uIHBvbGljeSwgb3Ig\nPGNvZGU+bm9uZTwvY29kZT4uIFNlZSB0aGUKICAgICAqIEFDVElPTiBjb25z\ndGFudHMgaW4ge0BsaW5rIFNjaGVtYVRvb2x9LiBNYXkgYmUgYSBjb21tYS1z\nZXBhcmF0ZWQKICAgICAqIGxpc3Qgb2YgdmFsdWVzLiBEZWZhdWx0cyB0byB7\nQGxpbmsgU2NoZW1hVG9vbCNBQ1RJT05fQUREfS4KICAgICAqLwogICAgcHVi\nbGljIHZvaWQgc2V0U2NoZW1hQWN0aW9uKFN0cmluZyBzY2hlbWFBY3Rpb24p\nIHsKICAgICAgICBfc2NoZW1hQWN0aW9ucyA9IHNjaGVtYUFjdGlvbjsKICAg\nIH0KCiAgICAvKioKICAgICAqIFNldCB0byB0cnVlIHRvIHJlYWQgdGhlIGVu\ndGlyZSBzY2hlbWEgYmVmb3JlIG1hcHBpbmcuCiAgICAgKiBMZWF2aW5nIHRo\naXMgb3B0aW9uIGZhbHNlIHNhdmVzIHRpbWUsIGJ1dCBpcyBkYW5nZXJvdXMg\nd2hlbiBhZGRpbmcKICAgICAqIG5ldyBtYXBwaW5ncywgYmVjYXVzZSB3aXRo\nb3V0IGZ1bGwga25vd2xlZGdlIG9mIHRoZSBleGlzdGluZyBzY2hlbWEgdGhl\nCiAgICAgKiBtYXBwaW5nIHRvb2wgbWlnaHQgY3JlYXRlIHRhYmxlcyBvciBp\nbmRleGVzIHRoYXQgY29uZmxpY3Qgd2l0aAogICAgICogZXhpc3RpbmcgY29t\ncG9uZW50cy4KICAgICAqLwogICAgcHVibGljIGJvb2xlYW4gZ2V0UmVhZFNj\naGVtYSgpIHsKICAgICAgICByZXR1cm4gX3JlYWRTY2hlbWE7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBTZXQgdG8gdHJ1ZSB0byByZWFkIHRoZSBlbnRpcmUg\nc2NoZW1hIGJlZm9yZSBtYXBwaW5nLgogICAgICogTGVhdmluZyB0aGlzIG9w\ndGlvbiBmYWxzZSBzYXZlcyB0aW1lLCBidXQgaXMgZGFuZ2Vyb3VzIHdoZW4g\nYWRkaW5nCiAgICAgKiBuZXcgbWFwcGluZ3MsIGJlY2F1c2Ugd2l0aG91dCBm\ndWxsIGtub3dsZWRnZSBvZiB0aGUgZXhpc3Rpbmcgc2NoZW1hIHRoZQogICAg\nICogbWFwcGluZyB0b29sIG1pZ2h0IGNyZWF0ZSB0YWJsZXMgb3IgaW5kZXhl\ncyB0aGF0IGNvbmZsaWN0IHdpdGgKICAgICAqIGV4aXN0aW5nIGNvbXBvbmVu\ndHMuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldFJlYWRTY2hlbWEoYm9v\nbGVhbiByZWFkU2NoZW1hKSB7CiAgICAgICAgX3JlYWRTY2hlbWEgPSByZWFk\nU2NoZW1hOwogICAgfQoKICAgIC8qKgogICAgICogV2hldGhlciB0byBtYW5p\ncHVsYXRlIHNlcXVlbmNlcy4gRGVmYXVsdHMgdG8gdHJ1ZS4KICAgICAqLwog\nICAgcHVibGljIGJvb2xlYW4gZ2V0U2VxdWVuY2VzKCkgewogICAgICAgIHJl\ndHVybiBfc2VxczsKICAgIH0KCiAgICAvKioKICAgICAqIFdoZXRoZXIgdG8g\nbWFuaXB1bGF0ZSBzZXF1ZW5jZXMuIERlZmF1bHRzIHRvIHRydWUuCiAgICAg\nKi8KICAgIHB1YmxpYyB2b2lkIHNldFNlcXVlbmNlcyhib29sZWFuIHNlcXMp\nIHsKICAgICAgICBfc2VxcyA9IHNlcXM7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBXaGV0aGVyIGluZGV4ZXMgb24gZXhpc3RpbmcgdGFibGVzIHNob3VsZCBi\nZSBtYW5pcHVsYXRlZC4KICAgICAqIERlZmF1bHRzIHRvIGZhbHNlLgogICAg\nICovCiAgICBwdWJsaWMgYm9vbGVhbiBnZXRJbmRleGVzKCkgewogICAgICAg\nIHJldHVybiBfaW5kZXhlczsKICAgIH0KCiAgICAvKioKICAgICAqIFdoZXRo\nZXIgaW5kZXhlcyBvbiBleGlzdGluZyB0YWJsZXMgc2hvdWxkIGJlIG1hbmlw\ndWxhdGVkLgogICAgICogRGVmYXVsdHMgdG8gZmFsc2UuCiAgICAgKi8KICAg\nIHB1YmxpYyB2b2lkIHNldEluZGV4ZXMoYm9vbGVhbiBpbmRleGVzKSB7CiAg\nICAgICAgX2luZGV4ZXMgPSBpbmRleGVzOwogICAgfQoKICAgIC8qKgogICAg\nICogV2hldGhlciBmb3JlaWduIGtleXMgb24gZXhpc3RpbmcgdGFibGVzIHNo\nb3VsZCBiZSBtYW5pcHVsYXRlZC4KICAgICAqIERlZmF1bHRzIHRvIGZhbHNl\nLgogICAgICovCiAgICBwdWJsaWMgYm9vbGVhbiBnZXRGb3JlaWduS2V5cygp\nIHsKICAgICAgICByZXR1cm4gX2ZrczsKICAgIH0KCiAgICAvKioKICAgICAq\nIFdoZXRoZXIgZm9yZWlnbiBrZXlzIG9uIGV4aXN0aW5nIHRhYmxlcyBzaG91\nbGQgYmUgbWFuaXB1bGF0ZWQuCiAgICAgKiBEZWZhdWx0cyB0byBmYWxzZS4K\nICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0Rm9yZWlnbktleXMoYm9vbGVh\nbiBma3MpIHsKICAgICAgICBfZmtzID0gZmtzOwogICAgfQoKICAgIC8qKgog\nICAgICogV2hldGhlciBwcmltYXJ5IGtleXMgb24gZXhpc3RpbmcgdGFibGVz\nIHNob3VsZCBiZSBtYW5pcHVsYXRlZC4KICAgICAqIERlZmF1bHRzIHRvIGZh\nbHNlLgogICAgICovCiAgICBwdWJsaWMgYm9vbGVhbiBnZXRQcmltYXJ5S2V5\ncygpIHsKICAgICAgICByZXR1cm4gX3BrczsKICAgIH0KCiAgICAvKioKICAg\nICAqIFdoZXRoZXIgcHJpbWFyeSBrZXlzIG9uIGV4aXN0aW5nIHRhYmxlcyBz\naG91bGQgYmUgbWFuaXB1bGF0ZWQuCiAgICAgKiBEZWZhdWx0cyB0byBmYWxz\nZS4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0UHJpbWFyeUtleXMoYm9v\nbGVhbiBwa3MpIHsKICAgICAgICBfcGtzID0gcGtzOwogICAgfQoKICAgIC8q\nKgogICAgICogV2hldGhlciBzY2hlbWEgY29tcG9uZW50cyB0aGF0IGFyZSB1\nbnVzZWQgYnkgYW55IG1hcHBpbmcgd2lsbCBiZQogICAgICogZHJvcHBlZCBm\ncm9tIHRoaXMgdG9vbCdzIHtAbGluayBTY2hlbWFHcm91cH0sIGFuZCwgZGVw\nZW5kaW5nIG9uCiAgICAgKiB0aGUgc2NoZW1hIGFjdGlvbiwgZnJvbSB0aGUg\nZGF0YWJhc2UuIERlZmF1bHRzIHRvIHRydWUuCiAgICAgKi8KICAgIHB1Ymxp\nYyBib29sZWFuIGdldERyb3BVbnVzZWRDb21wb25lbnRzKCkgewogICAgICAg\nIHJldHVybiBfZHJvcFVudXNlZDsKICAgIH0KCiAgICAvKioKICAgICAqIFdo\nZXRoZXIgc2NoZW1hIGNvbXBvbmVudHMgdGhhdCBhcmUgdW51c2VkIGJ5IGFu\neSBtYXBwaW5nIHdpbGwgYmUKICAgICAqIGRyb3BwZWQgZnJvbSB0aGlzIHRv\nb2wncyB7QGxpbmsgU2NoZW1hR3JvdXB9LCBhbmQsIGRlcGVuZGluZyBvbgog\nICAgICogdGhlIHNjaGVtYSBhY3Rpb24sIGZyb20gdGhlIGRhdGFiYXNlLiBE\nZWZhdWx0cyB0byB0cnVlLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRE\ncm9wVW51c2VkQ29tcG9uZW50cyhib29sZWFuIGRyb3BVbnVzZWQpIHsKICAg\nICAgICBfZHJvcFVudXNlZCA9IGRyb3BVbnVzZWQ7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBXaGV0aGVyIGFuZCBTUUwgZXJyb3JzIHNob3VsZCBjYXVzZSBh\nIGZhaWx1cmUgb3IganVzdCBpc3N1ZSBhIHdhcm5pbmcuCiAgICAgKi8KICAg\nIHB1YmxpYyB2b2lkIHNldElnbm9yZUVycm9ycyhib29sZWFuIGlnbm9yZUVy\ncm9ycykgewogICAgICAgIF9pZ25vcmVFcnJvcnMgPSBpZ25vcmVFcnJvcnM7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBXaGV0aGVyIGFuZCBTUUwgZXJyb3Jz\nIHNob3VsZCBjYXVzZSBhIGZhaWx1cmUgb3IganVzdCBpc3N1ZSBhIHdhcm5p\nbmcuCiAgICAgKi8KICAgIHB1YmxpYyBib29sZWFuIGdldElnbm9yZUVycm9y\ncygpIHsKICAgICAgICByZXR1cm4gX2lnbm9yZUVycm9yczsKICAgIH0KCiAg\nICAvKioKICAgICAqIFJldHVybiB0aGUgc2NoZW1hIHRvb2wgdG8gdXNlIGZv\nciBzY2hlbWEgbW9kaWZpY2F0aW9uLgogICAgICovCiAgICBwcml2YXRlIFNj\naGVtYVRvb2wgbmV3U2NoZW1hVG9vbChTdHJpbmcgYWN0aW9uKSB7CiAgICAg\nICAgaWYgKFNDSEVNQV9BQ1RJT05fTk9ORS5lcXVhbHMoYWN0aW9uKSkKICAg\nICAgICAgICAgYWN0aW9uID0gbnVsbDsKICAgICAgICBTY2hlbWFUb29sIHRv\nb2wgPSBuZXcgU2NoZW1hVG9vbChfY29uZiwgYWN0aW9uKTsKICAgICAgICB0\nb29sLnNldElnbm9yZUVycm9ycyhnZXRJZ25vcmVFcnJvcnMoKSk7CiAgICAg\nICAgdG9vbC5zZXRQcmltYXJ5S2V5cyhnZXRQcmltYXJ5S2V5cygpKTsKICAg\nICAgICB0b29sLnNldEZvcmVpZ25LZXlzKGdldEZvcmVpZ25LZXlzKCkpOwog\nICAgICAgIHRvb2wuc2V0SW5kZXhlcyhnZXRJbmRleGVzKCkpOwogICAgICAg\nIHRvb2wuc2V0U2VxdWVuY2VzKGdldFNlcXVlbmNlcygpKTsKICAgICAgICBy\nZXR1cm4gdG9vbDsKICAgIH0KCiAgICAvKioKICAgICAqIFNldCB0aGUgc2No\nZW1hIHRvb2wgdG8gdXNlIGZvciBzY2hlbWEgbW9kaWZpY2F0aW9uLgogICAg\nICovCiAgICBwdWJsaWMgdm9pZCBzZXRTY2hlbWFUb29sKFNjaGVtYVRvb2wg\ndG9vbCkgewogICAgICAgIF9zY2hlbWFUb29sID0gdG9vbDsKICAgIH0KCiAg\nICAvKioKICAgICAqIFRoZSBzdHJlYW0gdG8gZXhwb3J0IHRoZSBwbGFubmVk\nIHNjaGVtYSB0byBhcyBhbiBYTUwgZG9jdW1lbnQuCiAgICAgKiBJZiBub24t\nbnVsbCwgdGhlbiB0aGUgZGF0YWJhc2Ugc2NoZW1hIHdpbGwgbm90IGJlIGFs\ndGVyZWQuCiAgICAgKi8KICAgIHB1YmxpYyBXcml0ZXIgZ2V0U2NoZW1hV3Jp\ndGVyKCkgewogICAgICAgIHJldHVybiBfc2NoZW1hV3JpdGVyOwogICAgfQoK\nICAgIC8qKgogICAgICogVGhlIHN0cmVhbSB0byBleHBvcnQgdGhlIHBsYW5u\nZWQgc2NoZW1hIHRvIGFzIGFuIFhNTCBkb2N1bWVudC4KICAgICAqIElmIG5v\nbi1udWxsLCB0aGVuIHRoZSBkYXRhYmFzZSBzY2hlbWEgd2lsbCBub3QgYmUg\nYWx0ZXJlZC4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0U2NoZW1hV3Jp\ndGVyKFdyaXRlciBzY2hlbWFXcml0ZXIpIHsKICAgICAgICBfc2NoZW1hV3Jp\ndGVyID0gc2NoZW1hV3JpdGVyOwogICAgfQoKICAgIC8qKgogICAgICogVGhl\nIHN0cmVhbSB0byBleHBvcnQgdGhlIHBsYW5uZWQgbWFwcGluZ3MgdG8gYXMg\nYW4gWE1MIGRvY3VtZW50LgogICAgICogSWYgbm9uLW51bGwsIHRoZW4gdGhl\nIG1hcHBpbmcgcmVwb3NpdG9yeSB3aWxsIG5vdCBiZSBhbHRlcmVkLgogICAg\nICovCiAgICBwdWJsaWMgV3JpdGVyIGdldE1hcHBpbmdXcml0ZXIoKSB7CiAg\nICAgICAgcmV0dXJuIF9tYXBwaW5nV3JpdGVyOwogICAgfQoKICAgIC8qKgog\nICAgICogVGhlIHN0cmVhbSB0byBleHBvcnQgdGhlIHBsYW5uZWQgbWFwcGlu\nZ3MgdG8gYXMgYW4gWE1MIGRvY3VtZW50LgogICAgICogSWYgbm9uLW51bGws\nIHRoZW4gdGhlIG1hcHBpbmcgcmVwb3NpdG9yeSB3aWxsIG5vdCBiZSBhbHRl\ncmVkLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRNYXBwaW5nV3JpdGVy\nKFdyaXRlciBtYXBwaW5nV3JpdGVyKSB7CiAgICAgICAgX21hcHBpbmdXcml0\nZXIgPSBtYXBwaW5nV3JpdGVyOwogICAgfQoKICAgIC8qKgogICAgICogSWYg\nYWRkaW5nIG1ldGFkYXRhLCB0aGUgbWV0YWRhdGEgZmlsZSB0byBhZGQgdG8u\nCiAgICAgKi8KICAgIHB1YmxpYyBGaWxlIGdldE1ldGFEYXRhRmlsZSgpIHsK\nICAgICAgICByZXR1cm4gX2ZpbGU7CiAgICB9CgogICAgLyoqCiAgICAgKiBJ\nZiBhZGRpbmcgbWV0YWRhdGEsIHRoZSBtZXRhZGF0YSBmaWxlIHRvIGFkZCB0\nby4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0TWV0YURhdGFGaWxlKEZp\nbGUgZmlsZSkgewogICAgICAgIF9maWxlID0gZmlsZTsKICAgIH0KCiAgICAv\nKioKICAgICAqIFJldHVybiB0aGUgcmVwb3NpdG9yeSB0byB1c2UgdG8gYWNj\nZXNzIG1hcHBpbmcgaW5mb3JtYXRpb24uCiAgICAgKiBEZWZhdWx0cyB0byBh\nIG5ldyB7QGxpbmsgTWFwcGluZ1JlcG9zaXRvcnl9LgogICAgICovCiAgICBw\ndWJsaWMgTWFwcGluZ1JlcG9zaXRvcnkgZ2V0UmVwb3NpdG9yeSgpIHsKICAg\nICAgICBpZiAoX3JlcG9zID09IG51bGwpIHsKICAgICAgICAgICAgX3JlcG9z\nID0gX2NvbmYubmV3TWFwcGluZ1JlcG9zaXRvcnlJbnN0YW5jZSgpOwogICAg\nICAgICAgICBfcmVwb3Muc2V0U2NoZW1hR3JvdXAoZ2V0U2NoZW1hR3JvdXAo\nKSk7CiAgICAgICAgICAgIF9yZXBvcy5zZXRWYWxpZGF0ZShfcmVwb3MuVkFM\nSURBVEVfVU5FTkhBTkNFRCwgZmFsc2UpOwogICAgICAgIH0KICAgICAgICBy\nZXR1cm4gX3JlcG9zOwogICAgfQoKICAgIC8qKgogICAgICogU2V0IHRoZSBy\nZXBvc2l0b3J5IHRvIHVzZSB0byBhY2Nlc3MgbWFwcGluZyBpbmZvcm1hdGlv\nbi4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0UmVwb3NpdG9yeShNYXBw\naW5nUmVwb3NpdG9yeSByZXBvcykgewogICAgICAgIF9yZXBvcyA9IHJlcG9z\nOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRoZSBzY2hlbWEgZ3Jv\ndXAgdG8gdXNlIGluIG1hcHBpbmcuIElmIG5vbmUgaGFzIGJlZW4gc2V0LCB0\naGUKICAgICAqIHNjaGVtYSB3aWxsIGJlIGdlbmVyYXRlZCBmcm9tIHRoZSBk\nYXRhYmFzZS4KICAgICAqLwogICAgcHVibGljIFNjaGVtYUdyb3VwIGdldFNj\naGVtYUdyb3VwKCkgewogICAgICAgIGlmIChfc2NoZW1hID09IG51bGwpIHsK\nICAgICAgICAgICAgaWYgKF9hY3Rpb24uaW5kZXhPZihBQ1RJT05fQlVJTERf\nU0NIRU1BKSAhPSAtMSkgewogICAgICAgICAgICAgICAgRHluYW1pY1NjaGVt\nYUZhY3RvcnkgZmFjdG9yeSA9IG5ldyBEeW5hbWljU2NoZW1hRmFjdG9yeSgp\nOwogICAgICAgICAgICAgICAgZmFjdG9yeS5zZXRDb25maWd1cmF0aW9uKF9j\nb25mKTsKICAgICAgICAgICAgICAgIF9zY2hlbWEgPSBmYWN0b3J5OwogICAg\nICAgICAgICB9IGVsc2UgaWYgKF9yZWFkU2NoZW1hIAogICAgICAgICAgICAg\nICAgfHwgY29udGFpbnMoX3NjaGVtYUFjdGlvbnMsU2NoZW1hVG9vbC5BQ1RJ\nT05fUkVUQUlOKQogICAgICAgICAgICAgICAgfHwgY29udGFpbnMoX3NjaGVt\nYUFjdGlvbnMsU2NoZW1hVG9vbC5BQ1RJT05fUkVGUkVTSCkpIHsKICAgICAg\nICAgICAgICAgIF9zY2hlbWEgPSAoU2NoZW1hR3JvdXApIG5ld1NjaGVtYVRv\nb2wobnVsbCkuZ2V0REJTY2hlbWFHcm91cCgpLgogICAgICAgICAgICAgICAg\nICAgIGNsb25lKCk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAg\nICAgICAvLyB3aXRoIHRoaXMgd2UnbGwganVzdCByZWFkIHRhYmxlcyBhcyBk\naWZmZXJlbnQgbWFwcGluZ3MKICAgICAgICAgICAgICAgIC8vIGxvb2sgZm9y\nIHRoZW0KICAgICAgICAgICAgICAgIExhenlTY2hlbWFGYWN0b3J5IGZhY3Rv\ncnkgPSBuZXcgTGF6eVNjaGVtYUZhY3RvcnkoKTsKICAgICAgICAgICAgICAg\nIGZhY3Rvcnkuc2V0Q29uZmlndXJhdGlvbihfY29uZik7CiAgICAgICAgICAg\nICAgICBmYWN0b3J5LnNldFByaW1hcnlLZXlzKGdldFByaW1hcnlLZXlzKCkp\nOwogICAgICAgICAgICAgICAgZmFjdG9yeS5zZXRGb3JlaWduS2V5cyhnZXRG\nb3JlaWduS2V5cygpKTsKICAgICAgICAgICAgICAgIGZhY3Rvcnkuc2V0SW5k\nZXhlcyhnZXRJbmRleGVzKCkpOwogICAgICAgICAgICAgICAgX3NjaGVtYSA9\nIGZhY3Rvcnk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmIChfc2No\nZW1hLmdldFNjaGVtYXMoKS5sZW5ndGggPT0gMCkKICAgICAgICAgICAgICAg\nIF9zY2hlbWEuYWRkU2NoZW1hKCk7CiAgICAgICAgfQogICAgICAgIHJldHVy\nbiBfc2NoZW1hOwogICAgfQoKICAgIC8qKgogICAgICogU2V0IHRoZSBzY2hl\nbWEgdG8gdXNlIGluIG1hcHBpbmcuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lk\nIHNldFNjaGVtYUdyb3VwKFNjaGVtYUdyb3VwIHNjaGVtYSkgewogICAgICAg\nIF9zY2hlbWEgPSBzY2hlbWE7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXNl\ndCB0aGUgaW50ZXJuYWwgcmVwb3NpdG9yeS4gVGhpcyBpcyBjYWxsZWQgYXV0\nb21hdGljYWxseSBhZnRlcgogICAgICogZXZlcnkge0BsaW5rICNyZWNvcmR9\nLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBjbGVhcigpIHsKICAgICAgICBf\ncmVwb3MgPSBudWxsOwogICAgICAgIF9zY2hlbWEgPSBudWxsOwogICAgICAg\nIF9zY2hlbWFUb29sID0gbnVsbDsKICAgICAgICBfZmx1c2ggPSBmYWxzZTsK\nICAgICAgICBfZmx1c2hTY2hlbWEgPSBmYWxzZTsKICAgICAgICBpZiAoX2Ry\nb3BDbHMgIT0gbnVsbCkKICAgICAgICAgICAgX2Ryb3BDbHMuY2xlYXIoKTsK\nICAgICAgICBpZiAoX2Ryb3BNYXAgIT0gbnVsbCkKICAgICAgICAgICAgX2Ry\nb3BNYXAuY2xlYXIoKTsKICAgIH0KCiAgICAvKioKICAgICAqIFJlY29yZHMg\ndGhlIGNoYW5nZXMgdGhhdCBoYXZlIGJlZW4gbWFkZSB0byBib3RoIHRoZSBt\nYXBwaW5ncyBhbmQgdGhlCiAgICAgKiBhc3NvY2lhdGVkIHNjaGVtYSwgYW5k\nIGNsZWFycyB0aGUgdG9vbCBmb3IgZnVydGhlciB1c2UuIFRoaXMgYWxzbwog\nICAgICogaW52b2x2ZXMgY2xlYXJpbmcgdGhlIGludGVybmFsIG1hcHBpbmcg\ncmVwb3NpdG9yeS4KICAgICAqLwogICAgcHVibGljIHZvaWQgcmVjb3JkKCkg\newogICAgICAgIHJlY29yZChudWxsKTsKICAgIH0KICAgIAogICAgcHJpdmF0\nZSB2b2lkIHJlY29yZChNYXBwaW5nVG9vbC5GbGFncyBmbGFncykgewogICAg\nICAgIE1hcHBpbmdSZXBvc2l0b3J5IHJlcG9zID0gZ2V0UmVwb3NpdG9yeSgp\nOwogICAgICAgIE1ldGFEYXRhRmFjdG9yeSBpbyA9IHJlcG9zLmdldE1ldGFE\nYXRhRmFjdG9yeSgpOwogICAgICAgIENsYXNzTWFwcGluZ1tdIG1hcHBpbmdz\nOwogICAgICAgIGlmICghQUNUSU9OX0RST1AuZXF1YWxzKF9hY3Rpb24pKQog\nICAgICAgICAgICBtYXBwaW5ncyA9IHJlcG9zLmdldE1hcHBpbmdzKCk7CiAg\nICAgICAgZWxzZSBpZiAoX2Ryb3BNYXAgIT0gbnVsbCkKICAgICAgICAgICAg\nbWFwcGluZ3MgPSAoQ2xhc3NNYXBwaW5nW10pIF9kcm9wTWFwLnRvQXJyYXkK\nICAgICAgICAgICAgICAgIChuZXcgQ2xhc3NNYXBwaW5nW19kcm9wTWFwLnNp\nemUoKV0pOwogICAgICAgIGVsc2UKICAgICAgICAgICAgbWFwcGluZ3MgPSBu\nZXcgQ2xhc3NNYXBwaW5nWzBdOwoKICAgICAgICB0cnkgewogICAgICAgICAg\nICBpZiAoX2Ryb3BDbHMgIT0gbnVsbCAmJiAhX2Ryb3BDbHMuaXNFbXB0eSgp\nKSB7CiAgICAgICAgICAgICAgICBDbGFzc1tdIGNscyA9IChDbGFzc1tdKSBf\nZHJvcENscy50b0FycmF5CiAgICAgICAgICAgICAgICAgICAgKG5ldyBDbGFz\nc1tfZHJvcENscy5zaXplKCldKTsKICAgICAgICAgICAgICAgIGlmICghaW8u\nZHJvcChjbHMsIF9tb2RlLCBudWxsKSkKICAgICAgICAgICAgICAgICAgICBf\nbG9nLndhcm4oX2xvYy5nZXQoImJhZC1kcm9wIiwgX2Ryb3BDbHMpKTsKICAg\nICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKF9mbHVzaFNjaGVtYSkgewog\nICAgICAgICAgICAgICAgLy8gZHJvcCBwb3J0aW9ucyBvZiB0aGUga25vd24g\nc2NoZW1hIHRoYXQgbm8gbWFwcGluZyB1c2VzLCBhbmQKICAgICAgICAgICAg\nICAgIC8vIGFkZCBzZXF1ZW5jZXMgdXNlZCBmb3IgdmFsdWUgZ2VuZXJhdGlv\nbgogICAgICAgICAgICAgICAgaWYgKF9kcm9wVW51c2VkKQogICAgICAgICAg\nICAgICAgICAgIGRyb3BVbnVzZWRTY2hlbWFDb21wb25lbnRzKG1hcHBpbmdz\nKTsKICAgICAgICAgICAgICAgIGFkZFNlcXVlbmNlQ29tcG9uZW50cyhtYXBw\naW5ncyk7CgogICAgICAgICAgICAgICAgLy8gbm93IHJ1biB0aGUgc2NoZW1h\ndG9vbCBhcyBsb25nIGFzIHdlJ3JlIGRvaW5nIHNvbWUgc2NoZW1hCiAgICAg\nICAgICAgICAgICAvLyBhY3Rpb24gYW5kIHRoZSB1c2VyIGRvZXNuJ3QganVz\ndCB3YW50IGFuIHhtbCBvdXRwdXQKICAgICAgICAgICAgICAgIFN0cmluZ1td\nIHNjaGVtYUFjdGlvbnMgPSBfc2NoZW1hQWN0aW9ucy5zcGxpdCgiLCIpOwog\nICAgICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBzY2hlbWFBY3Rp\nb25zLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKCFT\nQ0hFTUFfQUNUSU9OX05PTkUuZXF1YWxzKHNjaGVtYUFjdGlvbnNbaV0pCiAg\nICAgICAgICAgICAgICAgICAgICAgICYmIChfc2NoZW1hV3JpdGVyID09IG51\nbGwgfHwgKF9zY2hlbWFUb29sICE9IG51bGwKICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICYmIF9zY2hlbWFUb29sLmdldFdyaXRlcigpICE9IG51bGwp\nKSkgewogICAgICAgICAgICAgICAgICAgICAgICBTY2hlbWFUb29sIHRvb2wg\nPSBuZXdTY2hlbWFUb29sKHNjaGVtYUFjdGlvbnNbaV0pOwoKICAgICAgICAg\nICAgICAgICAgICAgICAgLy8gY29uZmlndXJlIHRoZSB0b29sIHdpdGggYWRk\naXRpb25hbCBzZXR0aW5ncwogICAgICAgICAgICAgICAgICAgICAgICBpZiAo\nZmxhZ3MgIT0gbnVsbCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAg\ndG9vbC5zZXREcm9wVGFibGVzKGZsYWdzLmRyb3BUYWJsZXMpOwogICAgICAg\nICAgICAgICAgICAgICAgICAgICAgdG9vbC5zZXREcm9wU2VxdWVuY2VzKGZs\nYWdzLmRyb3BTZXF1ZW5jZXMpOwogICAgICAgICAgICAgICAgICAgICAgICAg\nICAgdG9vbC5zZXRXcml0ZXIoZmxhZ3Muc3FsV3JpdGVyKTsKICAgICAgICAg\nICAgICAgICAgICAgICAgICAgIHRvb2wuc2V0T3BlbkpQQVRhYmxlcyhmbGFn\ncy5vcGVuanBhVGFibGVzKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQoK\nICAgICAgICAgICAgICAgICAgICAgICAgdG9vbC5zZXRTY2hlbWFHcm91cChn\nZXRTY2hlbWFHcm91cCgpKTsKICAgICAgICAgICAgICAgICAgICAgICAgdG9v\nbC5ydW4oKTsKICAgICAgICAgICAgICAgICAgICAgICAgdG9vbC5yZWNvcmQo\nKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9Cgog\nICAgICAgICAgICAgICAgLy8geG1sIG91dHB1dCBvZiBzY2hlbWE/CiAgICAg\nICAgICAgICAgICBpZiAoX3NjaGVtYVdyaXRlciAhPSBudWxsKSB7CiAgICAg\nICAgICAgICAgICAgICAgLy8gc2VyaWFsaXplIHRoZSBwbGFubmVkIHNjaGVt\nYSB0byB0aGUgc3RyZWFtCiAgICAgICAgICAgICAgICAgICAgU2NoZW1hU2Vy\naWFsaXplciBzZXIgPSBuZXcgWE1MU2NoZW1hU2VyaWFsaXplcihfY29uZik7\nCiAgICAgICAgICAgICAgICAgICAgc2VyLmFkZEFsbChnZXRTY2hlbWFHcm91\ncCgpKTsKICAgICAgICAgICAgICAgICAgICBzZXIuc2VyaWFsaXplKF9zY2hl\nbWFXcml0ZXIsIHNlci5QUkVUVFkpOwogICAgICAgICAgICAgICAgICAgIF9z\nY2hlbWFXcml0ZXIuZmx1c2goKTsKICAgICAgICAgICAgICAgIH0KICAgICAg\nICAgICAgfQogICAgICAgICAgICBpZiAoIV9mbHVzaCkKICAgICAgICAgICAg\nICAgIHJldHVybjsKCiAgICAgICAgICAgIFF1ZXJ5TWV0YURhdGFbXSBxdWVy\naWVzID0gcmVwb3MuZ2V0UXVlcnlNZXRhRGF0YXMoKTsKICAgICAgICAgICAg\nU2VxdWVuY2VNZXRhRGF0YVtdIHNlcXMgPSByZXBvcy5nZXRTZXF1ZW5jZU1l\ndGFEYXRhcygpOwogICAgICAgICAgICBNYXAgb3V0cHV0ID0gbnVsbDsKCiAg\nICAgICAgICAgIC8vIGlmIHdlJ3JlIG91dHB1dHRpbmcgdG8gc3RyZWFtLCBz\nZXQgYWxsIG1ldGFzIHRvIHNhbWUgZmlsZSBzbwogICAgICAgICAgICAvLyB0\naGV5IGdldCBwbGFjZWQgaW4gc2luZ2xlIHN0cmluZwogICAgICAgICAgICBp\nZiAoX21hcHBpbmdXcml0ZXIgIT0gbnVsbCkgewogICAgICAgICAgICAgICAg\nb3V0cHV0ID0gbmV3IEhhc2hNYXAoKTsKICAgICAgICAgICAgICAgIEZpbGUg\ndG1wID0gbmV3IEZpbGUoIm9wZW5qcGF0bXAiKTsKICAgICAgICAgICAgICAg\nIGZvciAoaW50IGkgPSAwOyBpIDwgbWFwcGluZ3MubGVuZ3RoOyBpKyspCiAg\nICAgICAgICAgICAgICAgICAgbWFwcGluZ3NbaV0uc2V0U291cmNlKHRtcCwg\nbWFwcGluZ3NbaV0uU1JDX09USEVSKTsKICAgICAgICAgICAgICAgIGZvciAo\naW50IGkgPSAwOyBpIDwgcXVlcmllcy5sZW5ndGg7IGkrKykKICAgICAgICAg\nICAgICAgICAgICBxdWVyaWVzW2ldLnNldFNvdXJjZSh0bXAsIHF1ZXJpZXNb\naV0uZ2V0U291cmNlU2NvcGUoKSwKICAgICAgICAgICAgICAgICAgICAgICAg\ncXVlcmllc1tpXS5TUkNfT1RIRVIpOwogICAgICAgICAgICAgICAgZm9yIChp\nbnQgaSA9IDA7IGkgPCBzZXFzLmxlbmd0aDsgaSsrKQogICAgICAgICAgICAg\nICAgICAgIHNlcXNbaV0uc2V0U291cmNlKHRtcCwgc2Vxc1tpXS5nZXRTb3Vy\nY2VTY29wZSgpLAogICAgICAgICAgICAgICAgICAgICAgICBzZXFzW2ldLlNS\nQ19PVEhFUik7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIHN0b3Jl\nCiAgICAgICAgICAgIGlmICghaW8uc3RvcmUobWFwcGluZ3MsIHF1ZXJpZXMs\nIHNlcXMsIF9tb2RlLCBvdXRwdXQpKQogICAgICAgICAgICAgICAgdGhyb3cg\nbmV3IE1ldGFEYXRhRXhjZXB0aW9uKF9sb2MuZ2V0KCJiYWQtc3RvcmUiKSk7\nCgogICAgICAgICAgICAvLyB3cml0ZSB0byBzdHJlYW0KICAgICAgICAgICAg\naWYgKF9tYXBwaW5nV3JpdGVyICE9IG51bGwpIHsKICAgICAgICAgICAgICAg\nIFByaW50V3JpdGVyIG91dCA9IG5ldyBQcmludFdyaXRlcihfbWFwcGluZ1dy\naXRlcik7CiAgICAgICAgICAgICAgICBmb3IgKEl0ZXJhdG9yIGl0ciA9IG91\ndHB1dC52YWx1ZXMoKS5pdGVyYXRvcigpOwogICAgICAgICAgICAgICAgICAg\nIGl0ci5oYXNOZXh0KCk7KQogICAgICAgICAgICAgICAgICAgIG91dC5wcmlu\ndGxuKChTdHJpbmcpIGl0ci5uZXh0KCkpOwogICAgICAgICAgICAgICAgb3V0\nLmZsdXNoKCk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgY2F0\nY2ggKFJ1bnRpbWVFeGNlcHRpb24gcmUpIHsKICAgICAgICAgICAgdGhyb3cg\ncmU7CiAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICAg\nICAgdGhyb3cgbmV3IEdlbmVyYWxFeGNlcHRpb24oZSk7CiAgICAgICAgfSBm\naW5hbGx5IHsKICAgICAgICAgICAgY2xlYXIoKTsKICAgICAgICB9CiAgICB9\nCgogICAgLyoqCiAgICAgKiBEcm9wcyBzY2hlbWEgY29tcG9uZW50cyB0aGF0\nIGFwcGVhciB0byBiZSB1bnVzZWQgZnJvbSB0aGUgbG9jYWwKICAgICAqIGNv\ncHkgb2YgdGhlIHNjaGVtYSBncm91cC4KICAgICAqLwogICAgcHJpdmF0ZSB2\nb2lkIGRyb3BVbnVzZWRTY2hlbWFDb21wb25lbnRzKENsYXNzTWFwcGluZ1td\nIG1hcHBpbmdzKSB7CiAgICAgICAgRmllbGRNYXBwaW5nW10gZmllbGRzOwog\nICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgbWFwcGluZ3MubGVuZ3RoOyBp\nKyspIHsKICAgICAgICAgICAgbWFwcGluZ3NbaV0ucmVmU2NoZW1hQ29tcG9u\nZW50cygpOwogICAgICAgICAgICBtYXBwaW5nc1tpXS5nZXREaXNjcmltaW5h\ndG9yKCkucmVmU2NoZW1hQ29tcG9uZW50cygpOwogICAgICAgICAgICBtYXBw\naW5nc1tpXS5nZXRWZXJzaW9uKCkucmVmU2NoZW1hQ29tcG9uZW50cygpOwog\nICAgICAgICAgICBmaWVsZHMgPSBtYXBwaW5nc1tpXS5nZXREZWZpbmVkRmll\nbGRNYXBwaW5ncygpOwogICAgICAgICAgICBmb3IgKGludCBqID0gMDsgaiA8\nIGZpZWxkcy5sZW5ndGg7IGorKykKICAgICAgICAgICAgICAgIGZpZWxkc1tq\nXS5yZWZTY2hlbWFDb21wb25lbnRzKCk7CiAgICAgICAgfQoKICAgICAgICAv\nLyBhbHNvIGFsbG93IHRoZSBkYmRpY3Rpb25hcnkgdG8gcmVmIGFueSBzY2hl\nbWEgY29tcG9uZW50cyB0aGF0CiAgICAgICAgLy8gaXQgYWRkcyBhcGFydCBm\ncm9tIG1hcHBpbmdzCiAgICAgICAgU2NoZW1hR3JvdXAgZ3JvdXAgPSBnZXRT\nY2hlbWFHcm91cCgpOwogICAgICAgIFNjaGVtYVtdIHNjaGVtYXMgPSBncm91\ncC5nZXRTY2hlbWFzKCk7CiAgICAgICAgVGFibGVbXSB0YWJsZXM7CiAgICAg\nICAgREJEaWN0aW9uYXJ5IGRpY3QgPSBfY29uZi5nZXREQkRpY3Rpb25hcnlJ\nbnN0YW5jZSgpOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgc2NoZW1h\ncy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICB0YWJsZXMgPSBzY2hlbWFz\nW2ldLmdldFRhYmxlcygpOwogICAgICAgICAgICBmb3IgKGludCBqID0gMDsg\naiA8IHRhYmxlcy5sZW5ndGg7IGorKykKICAgICAgICAgICAgICAgIGRpY3Qu\ncmVmU2NoZW1hQ29tcG9uZW50cyh0YWJsZXNbal0pOwogICAgICAgIH0KCiAg\nICAgICAgZ3JvdXAucmVtb3ZlVW51c2VkQ29tcG9uZW50cygpOwogICAgfQoK\nICAgIC8qKgogICAgICogQWRkIHRhYmxlcyB1c2VkIGJ5IHNlcXVlbmNlcyB0\nbyB0aGUgZ2l2ZW4gc2NoZW1hLgogICAgICovCiAgICBwcml2YXRlIHZvaWQg\nYWRkU2VxdWVuY2VDb21wb25lbnRzKENsYXNzTWFwcGluZ1tdIG1hcHBpbmdz\nKSB7CiAgICAgICAgU2NoZW1hR3JvdXAgZ3JvdXAgPSBnZXRTY2hlbWFHcm91\ncCgpOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgbWFwcGluZ3MubGVu\nZ3RoOyBpKyspCiAgICAgICAgICAgIGFkZFNlcXVlbmNlQ29tcG9uZW50cyht\nYXBwaW5nc1tpXSwgZ3JvdXApOwogICAgfQoKICAgIC8qKgogICAgICogQWRk\nIHRhYmxlcyB1c2VkIGJ5IHNlcXVlbmNlcyB0byB0aGUgZ2l2ZW4gc2NoZW1h\nLgogICAgICovCiAgICBwcml2YXRlIHZvaWQgYWRkU2VxdWVuY2VDb21wb25l\nbnRzKENsYXNzTWFwcGluZyBtYXBwaW5nLAogICAgICAgIFNjaGVtYUdyb3Vw\nIGdyb3VwKSB7CiAgICAgICAgU2VxdWVuY2VNZXRhRGF0YSBzbWQgPSBtYXBw\naW5nLmdldElkZW50aXR5U2VxdWVuY2VNZXRhRGF0YSgpOwogICAgICAgIFNl\ncSBzZXEgPSBudWxsOwogICAgICAgIGlmIChzbWQgIT0gbnVsbCkKICAgICAg\nICAgICAgc2VxID0gc21kLmdldEluc3RhbmNlKG51bGwpOwogICAgICAgIGVs\nc2UgaWYgKG1hcHBpbmcuZ2V0SWRlbnRpdHlTdHJhdGVneSgpID09IFZhbHVl\nU3RyYXRlZ2llcy5OQVRJVkUKICAgICAgICAgICAgfHwgKG1hcHBpbmcuZ2V0\nSWRlbnRpdHlTdHJhdGVneSgpID09IFZhbHVlU3RyYXRlZ2llcy5OT05FCiAg\nICAgICAgICAgICYmIG1hcHBpbmcuZ2V0SWRlbnRpdHlUeXBlKCkgPT0gQ2xh\nc3NNYXBwaW5nLklEX0RBVEFTVE9SRSkpCiAgICAgICAgICAgIHNlcSA9IF9j\nb25mLmdldFNlcXVlbmNlSW5zdGFuY2UoKTsKCiAgICAgICAgaWYgKHNlcSBp\nbnN0YW5jZW9mIEpEQkNTZXEpCiAgICAgICAgICAgICgoSkRCQ1NlcSkgc2Vx\nKS5hZGRTY2hlbWEobWFwcGluZywgZ3JvdXApOwoKICAgICAgICBGaWVsZE1h\ncHBpbmdbXSBmbWRzOwogICAgICAgIGlmIChtYXBwaW5nLmdldEVtYmVkZGlu\nZ01ldGFEYXRhKCkgPT0gbnVsbCkKICAgICAgICAgICAgZm1kcyA9IG1hcHBp\nbmcuZ2V0RGVmaW5lZEZpZWxkTWFwcGluZ3MoKTsKICAgICAgICBlbHNlCiAg\nICAgICAgICAgIGZtZHMgPSBtYXBwaW5nLmdldEZpZWxkTWFwcGluZ3MoKTsK\nICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGZtZHMubGVuZ3RoOyBpKysp\nIHsKICAgICAgICAgICAgc21kID0gZm1kc1tpXS5nZXRWYWx1ZVNlcXVlbmNl\nTWV0YURhdGEoKTsKICAgICAgICAgICAgaWYgKHNtZCAhPSBudWxsKSB7CiAg\nICAgICAgICAgICAgICBzZXEgPSBzbWQuZ2V0SW5zdGFuY2UobnVsbCk7CiAg\nICAgICAgICAgICAgICBpZiAoc2VxIGluc3RhbmNlb2YgSkRCQ1NlcSkKICAg\nICAgICAgICAgICAgICAgICAoKEpEQkNTZXEpIHNlcSkuYWRkU2NoZW1hKG1h\ncHBpbmcsIGdyb3VwKTsKICAgICAgICAgICAgfSBlbHNlIGlmIChmbWRzW2ld\nLmdldEVtYmVkZGVkTWFwcGluZygpICE9IG51bGwpCiAgICAgICAgICAgICAg\nICBhZGRTZXF1ZW5jZUNvbXBvbmVudHMoZm1kc1tpXS5nZXRFbWJlZGRlZE1h\ncHBpbmcoKSwgZ3JvdXApOwogICAgICAgIH0KICAgIH0KCiAgICAvLy8vLy8v\nLy8vLwogICAgLy8gQWN0aW9ucwogICAgLy8vLy8vLy8vLy8KCiAgICAvKioK\nICAgICAqIFJ1biB0aGUgY29uZmlndXJlZCBhY3Rpb24gb24gdGhlIGdpdmVu\nIGluc3RhbmNlLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBydW4oQ2xhc3Mg\nY2xzKSB7CiAgICAgICAgaWYgKEFDVElPTl9BREQuZXF1YWxzKF9hY3Rpb24p\nKSB7CiAgICAgICAgICAgIGlmIChfbWV0YSkKICAgICAgICAgICAgICAgIGFk\nZE1ldGEoY2xzKTsKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAg\nYWRkKGNscyk7CiAgICAgICAgfSBlbHNlIGlmIChBQ1RJT05fUkVGUkVTSC5l\ncXVhbHMoX2FjdGlvbikpCiAgICAgICAgICAgIHJlZnJlc2goY2xzKTsKICAg\nICAgICBlbHNlIGlmIChBQ1RJT05fQlVJTERfU0NIRU1BLmVxdWFscyhfYWN0\naW9uKSkKICAgICAgICAgICAgYnVpbGRTY2hlbWEoY2xzKTsKICAgICAgICBl\nbHNlIGlmIChBQ1RJT05fRFJPUC5lcXVhbHMoX2FjdGlvbikpCiAgICAgICAg\nICAgIGRyb3AoY2xzKTsKICAgICAgICBlbHNlIGlmIChBQ1RJT05fVkFMSURB\nVEUuZXF1YWxzKF9hY3Rpb24pKQogICAgICAgICAgICB2YWxpZGF0ZShjbHMp\nOwogICAgfQoKICAgIC8qKgogICAgICogQWRkIHRoZSBtYXBwaW5nIGZvciB0\naGUgZ2l2ZW4gaW5zdGFuY2UuCiAgICAgKi8KICAgIHByaXZhdGUgdm9pZCBh\nZGQoQ2xhc3MgY2xzKSB7CiAgICAgICAgaWYgKGNscyA9PSBudWxsKQogICAg\nICAgICAgICByZXR1cm47CgogICAgICAgIE1hcHBpbmdSZXBvc2l0b3J5IHJl\ncG9zID0gZ2V0UmVwb3NpdG9yeSgpOwogICAgICAgIHJlcG9zLnNldFN0cmF0\nZWd5SW5zdGFsbGVyKG5ldyBNYXBwaW5nU3RyYXRlZ3lJbnN0YWxsZXIocmVw\nb3MpKTsKICAgICAgICBpZiAoZ2V0TWFwcGluZyhyZXBvcywgY2xzLCB0cnVl\nKSAhPSBudWxsKSB7CiAgICAgICAgICAgIF9mbHVzaCA9IHRydWU7CiAgICAg\nICAgICAgIF9mbHVzaFNjaGVtYSA9IHRydWU7CiAgICAgICAgfQogICAgfQoK\nICAgIC8qKgogICAgICogUmV0dXJuIHRoZSBtYXBwaW5nIGZvciB0aGUgZ2l2\nZW4gdHlwZSwgb3IgbnVsbCBpZiB0aGUgdHlwZSBpcwogICAgICogcGVyc2lz\ndGVuY2UtYXdhcmUuCiAgICAgKi8KICAgIHByaXZhdGUgc3RhdGljIENsYXNz\nTWFwcGluZyBnZXRNYXBwaW5nKE1hcHBpbmdSZXBvc2l0b3J5IHJlcG9zLCBD\nbGFzcyBjbHMsCiAgICAgICAgYm9vbGVhbiB2YWxpZGF0ZSkgewogICAgICAg\nIC8vIHRoaXMgd2lsbCBwYXJzZSBhbGwgcG9zc2libGUgbWV0YWRhdGEgcnNy\nY3MgbG9va2luZyBmb3IgY2xzLCBzbwogICAgICAgIC8vIHdpbGwgZGV0ZWN0\nIGlmIHAtYXdhcmUKICAgICAgICBDbGFzc01hcHBpbmcgbWFwcGluZyA9IHJl\ncG9zLmdldE1hcHBpbmcoY2xzLCBudWxsLCBmYWxzZSk7CiAgICAgICAgaWYg\nKG1hcHBpbmcgIT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIG1hcHBpbmc7\nCiAgICAgICAgaWYgKCF2YWxpZGF0ZSB8fCBjbHMuaXNJbnRlcmZhY2UoKSAK\nICAgICAgICAgICAgfHwgcmVwb3MuZ2V0UGVyc2lzdGVuY2VBd2FyZShjbHMp\nICE9IG51bGwpCiAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgIHRo\ncm93IG5ldyBNZXRhRGF0YUV4Y2VwdGlvbihfbG9jLmdldCgibm8tbWV0YSIs\nIGNscykpOwogICAgfQoKICAgIC8qKgogICAgICogQ3JlYXRlIGEgbWV0YWRh\ndGEgZm9yIHRoZSBnaXZlbiBpbnN0YW5jZS4KICAgICAqLwogICAgcHJpdmF0\nZSB2b2lkIGFkZE1ldGEoQ2xhc3MgY2xzKSB7CiAgICAgICAgaWYgKGNscyA9\nPSBudWxsKQogICAgICAgICAgICByZXR1cm47CgogICAgICAgIF9mbHVzaCA9\nIHRydWU7CiAgICAgICAgTWFwcGluZ1JlcG9zaXRvcnkgcmVwb3MgPSBnZXRS\nZXBvc2l0b3J5KCk7CiAgICAgICAgcmVwb3Muc2V0UmVzb2x2ZShNT0RFX01B\nUFBJTkcsIGZhbHNlKTsKICAgICAgICBNZXRhRGF0YUZhY3RvcnkgZmFjdG9y\neSA9IHJlcG9zLmdldE1ldGFEYXRhRmFjdG9yeSgpOwogICAgICAgIGZhY3Rv\ncnkuZ2V0RGVmYXVsdHMoKS5zZXRJZ25vcmVOb25QZXJzaXN0ZW50KGZhbHNl\nKTsKICAgICAgICBmYWN0b3J5LnNldFN0b3JlTW9kZShNZXRhRGF0YUZhY3Rv\ncnkuU1RPUkVfVkVSQk9TRSk7CgogICAgICAgIENsYXNzTWV0YURhdGEgbWV0\nYSA9IHJlcG9zLmFkZE1ldGFEYXRhKGNscyk7CiAgICAgICAgRmllbGRNZXRh\nRGF0YVtdIGZtZHMgPSBtZXRhLmdldERlY2xhcmVkRmllbGRzKCk7CiAgICAg\nICAgZm9yIChpbnQgaSA9IDA7IGkgPCBmbWRzLmxlbmd0aDsgaSsrKSB7CiAg\nICAgICAgICAgIGlmIChmbWRzW2ldLmdldERlY2xhcmVkVHlwZUNvZGUoKSA9\nPSBKYXZhVHlwZXMuT0JKRUNUCiAgICAgICAgICAgICAgICAmJiBmbWRzW2ld\nLmdldERlY2xhcmVkVHlwZSgpICE9IE9iamVjdC5jbGFzcykKICAgICAgICAg\nICAgICAgIGZtZHNbaV0uc2V0RGVjbGFyZWRUeXBlQ29kZShKYXZhVHlwZXMu\nUEMpOwogICAgICAgIH0KICAgICAgICBtZXRhLnNldFNvdXJjZShfZmlsZSwg\nbWV0YS5nZXRTb3VyY2VUeXBlKCkpOwogICAgICAgIG1ldGEuc2V0UmVzb2x2\nZShNT0RFX01FVEEsIHRydWUpOwogICAgfQoKICAgIC8qKgogICAgICogUmVm\ncmVzaCBvciBhZGQgdGhlIG1hcHBpbmcgZm9yIHRoZSBnaXZlbiBpbnN0YW5j\nZS4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIHJlZnJlc2goQ2xhc3MgY2xz\nKSB7CiAgICAgICAgaWYgKGNscyA9PSBudWxsKQogICAgICAgICAgICByZXR1\ncm47CgogICAgICAgIE1hcHBpbmdSZXBvc2l0b3J5IHJlcG9zID0gZ2V0UmVw\nb3NpdG9yeSgpOwogICAgICAgIHJlcG9zLnNldFN0cmF0ZWd5SW5zdGFsbGVy\nKG5ldyBSZWZyZXNoU3RyYXRlZ3lJbnN0YWxsZXIocmVwb3MpKTsKICAgICAg\nICBpZiAoZ2V0TWFwcGluZyhyZXBvcywgY2xzLCB0cnVlKSAhPSBudWxsKSB7\nCiAgICAgICAgICAgIF9mbHVzaCA9IHRydWU7CiAgICAgICAgICAgIF9mbHVz\naFNjaGVtYSA9IHRydWU7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAg\nICogVmFsaWRhdGUgdGhlIG1hcHBpbmdzIGZvciB0aGUgZ2l2ZW4gY2xhc3Mg\nYW5kIGl0cyBmaWVsZHMuCiAgICAgKi8KICAgIHByaXZhdGUgdm9pZCB2YWxp\nZGF0ZShDbGFzcyBjbHMpIHsKICAgICAgICBpZiAoY2xzID09IG51bGwpCiAg\nICAgICAgICAgIHJldHVybjsKCiAgICAgICAgTWFwcGluZ1JlcG9zaXRvcnkg\ncmVwb3MgPSBnZXRSZXBvc2l0b3J5KCk7CiAgICAgICAgcmVwb3Muc2V0U3Ry\nYXRlZ3lJbnN0YWxsZXIobmV3IFJ1bnRpbWVTdHJhdGVneUluc3RhbGxlcihy\nZXBvcykpOwogICAgICAgIGlmIChnZXRNYXBwaW5nKHJlcG9zLCBjbHMsIHRy\ndWUpICE9IG51bGwpCiAgICAgICAgICAgIF9mbHVzaFNjaGVtYSA9ICFjb250\nYWlucyhfc2NoZW1hQWN0aW9ucyxTQ0hFTUFfQUNUSU9OX05PTkUpCiAgICAg\nICAgICAgICAgICAmJiAhY29udGFpbnMoX3NjaGVtYUFjdGlvbnMsU2NoZW1h\nVG9vbC5BQ1RJT05fQUREKTsKICAgIH0KCiAgICAvKioKICAgICAqIENyZWF0\nZSB0aGUgc2NoZW1hIHVzaW5nIHRoZSBtYXBwaW5nIGZvciB0aGUgZ2l2ZW4g\naW5zdGFuY2UuCiAgICAgKi8KICAgIHByaXZhdGUgdm9pZCBidWlsZFNjaGVt\nYShDbGFzcyBjbHMpIHsKICAgICAgICBpZiAoY2xzID09IG51bGwpCiAgICAg\nICAgICAgIHJldHVybjsKCiAgICAgICAgTWFwcGluZ1JlcG9zaXRvcnkgcmVw\nb3MgPSBnZXRSZXBvc2l0b3J5KCk7CiAgICAgICAgcmVwb3Muc2V0U3RyYXRl\nZ3lJbnN0YWxsZXIobmV3IFJ1bnRpbWVTdHJhdGVneUluc3RhbGxlcihyZXBv\ncykpOwogICAgICAgIGlmIChnZXRNYXBwaW5nKHJlcG9zLCBjbHMsIHRydWUp\nID09IG51bGwpCiAgICAgICAgICAgIHJldHVybjsKCiAgICAgICAgLy8gc2V0\nIGFueSBsb2dpY2FsIHBrcyB0byBub24tbG9naWNhbCBzbyB0aGV5IGdldCBm\nbHVzaGVkCiAgICAgICAgX2ZsdXNoU2NoZW1hID0gdHJ1ZTsKICAgICAgICBT\nY2hlbWFbXSBzY2hlbWFzID0gX3NjaGVtYS5nZXRTY2hlbWFzKCk7CiAgICAg\nICAgVGFibGVbXSB0YWJsZXM7CiAgICAgICAgQ29sdW1uW10gY29sczsKICAg\nICAgICBmb3IgKGludCBpID0gMDsgaSA8IHNjaGVtYXMubGVuZ3RoOyBpKysp\nIHsKICAgICAgICAgICAgdGFibGVzID0gc2NoZW1hc1tpXS5nZXRUYWJsZXMo\nKTsKICAgICAgICAgICAgZm9yIChpbnQgaiA9IDA7IGogPCB0YWJsZXMubGVu\nZ3RoOyBqKyspIHsKICAgICAgICAgICAgICAgIGlmICh0YWJsZXNbal0uZ2V0\nUHJpbWFyeUtleSgpID09IG51bGwpCiAgICAgICAgICAgICAgICAgICAgY29u\ndGludWU7CgogICAgICAgICAgICAgICAgdGFibGVzW2pdLmdldFByaW1hcnlL\nZXkoKS5zZXRMb2dpY2FsKGZhbHNlKTsKICAgICAgICAgICAgICAgIGNvbHMg\nPSB0YWJsZXNbal0uZ2V0UHJpbWFyeUtleSgpLmdldENvbHVtbnMoKTsKICAg\nICAgICAgICAgICAgIGZvciAoaW50IGsgPSAwOyBrIDwgY29scy5sZW5ndGg7\nIGsrKykKICAgICAgICAgICAgICAgICAgICBjb2xzW2tdLnNldE5vdE51bGwo\ndHJ1ZSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgLyoq\nCiAgICAgKiBEcm9wIG1hcHBpbmcgZm9yIGdpdmVuIGNsYXNzLgogICAgICov\nCiAgICBwcml2YXRlIHZvaWQgZHJvcChDbGFzcyBjbHMpIHsKICAgICAgICBp\nZiAoY2xzID09IG51bGwpCiAgICAgICAgICAgIHJldHVybjsKCiAgICAgICAg\naWYgKF9kcm9wQ2xzID09IG51bGwpCiAgICAgICAgICAgIF9kcm9wQ2xzID0g\nbmV3IEhhc2hTZXQoKTsKICAgICAgICBfZHJvcENscy5hZGQoY2xzKTsKICAg\nICAgICBpZiAoIWNvbnRhaW5zKF9zY2hlbWFBY3Rpb25zLFNjaGVtYVRvb2wu\nQUNUSU9OX0RST1ApKQogICAgICAgICAgICByZXR1cm47CgogICAgICAgIE1h\ncHBpbmdSZXBvc2l0b3J5IHJlcG9zID0gZ2V0UmVwb3NpdG9yeSgpOwogICAg\nICAgIHJlcG9zLnNldFN0cmF0ZWd5SW5zdGFsbGVyKG5ldyBSdW50aW1lU3Ry\nYXRlZ3lJbnN0YWxsZXIocmVwb3MpKTsKICAgICAgICBDbGFzc01hcHBpbmcg\nbWFwcGluZyA9IG51bGw7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgbWFw\ncGluZyA9IHJlcG9zLmdldE1hcHBpbmcoY2xzLCBudWxsLCBmYWxzZSk7CiAg\nICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICB9CgogICAg\nICAgIGlmIChtYXBwaW5nICE9IG51bGwpIHsKICAgICAgICAgICAgX2ZsdXNo\nU2NoZW1hID0gdHJ1ZTsKICAgICAgICAgICAgaWYgKF9kcm9wTWFwID09IG51\nbGwpCiAgICAgICAgICAgICAgICBfZHJvcE1hcCA9IG5ldyBIYXNoU2V0KCk7\nCiAgICAgICAgICAgIF9kcm9wTWFwLmFkZChtYXBwaW5nKTsKICAgICAgICB9\nIGVsc2UKICAgICAgICAgICAgX2xvZy53YXJuKF9sb2MuZ2V0KCJuby1kcm9w\nLW1ldGEiLCBjbHMpKTsKICAgIH0KCiAgICAvLy8vLy8vLwogICAgLy8gTWFp\nbgogICAgLy8vLy8vLy8KCiAgICAvKioKICAgICAqIFVzYWdlOiBqYXZhIG9y\nZy5hcGFjaGUub3BlbmpwYS5qZGJjLm1ldGEuTWFwcGluZ1Rvb2wgW29wdGlv\nbl0qIAogICAgICogWy1hY3Rpb24vLWEgJmx0O3JlZnJlc2ggfCBhZGQgfCBi\ndWlsZFNjaGVtYSB8IGRyb3AgfCB2YWxpZGF0ZSB8IGltcG9ydCAKICAgICAq\nIHwgZXhwb3J0Jmd0O10gJmx0O2NsYXNzIG5hbWUgfCAuamF2YSBmaWxlIHwg\nLmNsYXNzIGZpbGUgfCAuamRvIGZpbGUmZ3Q7KgogICAgICogV2hlcmUgdGhl\nIGZvbGxvd2luZyBvcHRpb25zIGFyZSByZWNvZ25pemVkLgogICAgICogPHVs\nPgogICAgICogPGxpPjxpPi1wcm9wZXJ0aWVzLy1wICZsdDtwcm9wZXJ0aWVz\nIGZpbGUgb3IgcmVzb3VyY2UmZ3Q7PC9pPjogVGhlCiAgICAgKiBwYXRoIG9y\nIHJlc291cmNlIG5hbWUgb2YgYSBPcGVuSlBBIHByb3BlcnRpZXMgZmlsZSBj\nb250YWluaW5nCiAgICAgKiBpbmZvcm1hdGlvbiBhcyBvdXRsaW5lZCBpbiB7\nQGxpbmsgT3BlbkpQQUNvbmZpZ3VyYXRpb259LiBPcHRpb25hbC48L2xpPgog\nICAgICogPGxpPjxpPi0mbHQ7cHJvcGVydHkgbmFtZSZndDsgJmx0O3Byb3Bl\ncnR5IHZhbHVlJmd0OzwvaT46IEFsbCBiZWFuCiAgICAgKiBwcm9wZXJ0aWVz\nIG9mIHRoZSBPcGVuSlBBIHtAbGluayBKREJDQ29uZmlndXJhdGlvbn0gY2Fu\nIGJlIHNldCBieQogICAgICogdXNpbmcgdGhlaXIJbmFtZXMgYW5kIHN1cHBs\neWluZyBhIHZhbHVlLiBGb3IgZXhhbXBsZToKICAgICAqIDxjb2RlPi1saWNl\nbnNlS2V5IGFkc2xmamE4M3IzbGthZGY8L2NvZGU+PC9saT4KICAgICAqIDxs\naT48aT4tZmlsZS8tZiAmbHQ7c3Rkb3V0IHwgb3V0cHV0IGZpbGUgb3IgcmVz\nb3VyY2UmZ3Q7PC9pPjogVXNlCiAgICAgKiB0aGlzIG9wdGlvbiB0byB3cml0\nZSB0aGUgcGxhbm5lZCBtYXBwaW5ncyB0byBhbiBYTUwgZG9jdW1lbnQgcmF0\naGVyCiAgICAgKiB0aGFuIHN0b3JlIHRoZW0gaW4gdGhlIHJlcG9zaXRvcnku\nIFRoaXMgb3B0aW9uIGFsc28gc3BlY2lmaWVzIHRoZQogICAgICogbWV0YWRh\ndGEgZmlsZSB0byB3cml0ZSB0byBpZiB1c2luZyB0aGUgPGNvZGU+YWRkPC9j\nb2RlPiBhY3Rpb24gd2l0aAogICAgICogdGhlIDxjb2RlPi1tZXRhIHRydWU8\nL2NvZGU+IGZsYWcsIG9yIHRoZSBmaWxlIHRvIGR1bXAgdG8gaWYgdXNpbmcK\nICAgICAqIHRoZSA8Y29kZT5leHBvcnQ8L2NvZGU+IGFjdGlvbi48L2xpPgog\nICAgICogPGxpPjxpPi1zY2hlbWFBY3Rpb24vLXNhICZsdDtzY2hlbWEgYWN0\naW9uIHwgbm9uZSZndDs8L2k+OiBUaGUKICAgICAqIHtAbGluayBTY2hlbWFU\nb29sfSBkZWZpbmVzIHRoZSBhY3Rpb25zIHBvc3NpYmxlLiBUaGUgYWN0aW9u\ncyB3aWxsCiAgICAgKiBhcHBseSB0byBhbGwgc2NoZW1hIGNvbXBvbmVudHMg\ndXNlZCBieSB0aGUgbWFwcGluZ3MgaW52b2x2ZWQuCiAgICAgKiBVbmxlc3Mg\neW91IGFyZSBydW5uaW5nIHRoZSBtYXBwaW5nIHRvb2wgb24gYWxsIG9mIHlv\ndXIgcGVyc2lzdGVudAogICAgICogdHlwZXMgYXQgb25jZSwgYmUgY2FyZWZ1\nbCBydW5uaW5nIHNjaGVtYSBhY3Rpb25zIHRoYXQgY2FuIGRyb3AgZGF0YS4K\nICAgICAqIEl0IGlzIHBvc3NpYmxlIHRvIGFjY2lkZW50YWxseSBkcm9wIHNj\naGVtYSBjb21wb25lbnRzIHRoYXQgYXJlCiAgICAgKiB1c2VkIGJ5IGNsYXNz\nZXMgeW91IGFyZW4ndCBjdXJyZW50bHkgcnVubmluZyB0aGUgdG9vbCBvdmVy\nLiBUaGUKICAgICAqIGFjdGlvbiBkZWZhdWx0cyB0byA8Y29kZT5hZGQ8L2Nv\nZGU+LjwvbGk+CiAgICAgKiA8bGk+PGk+LXNjaGVtYUZpbGUvLXNmICZsdDtz\ndGRvdXQgfCBvdXRwdXQgZmlsZSBvciByZXNvdXJjZSZndDs8L2k+OiBVc2UK\nICAgICAqIHRoaXMgb3B0aW9uIHRvIHdyaXRlIHRoZSBwbGFubmVkIHNjaGVt\nYSB0byBhbiBYTUwgZG9jdW1lbnQgcmF0aGVyCiAgICAgKiB0aGFuIG1vZGlm\neSB0aGUgZGF0YSBzdG9yZS48L2xpPgogICAgICogPGxpPjxpPi1zcWxGaWxl\nLy1zcWwgJmx0O3N0ZG91dCB8IG91dHB1dCBmaWxlIG9yIHJlc291cmNlJmd0\nOzwvaT46IFVzZQogICAgICogdGhpcyBvcHRpb24gdG8gd3JpdGUgdGhlIHBs\nYW5uZWQgc2NoZW1hIGNoYW5nZXMgYXMgYSBTUUwKICAgICAqIHNjcmlwdCBy\nYXRoZXIgdGhhbiBtb2RpZnlpbmcgdGhlIGRhdGEgc3RvcmUuPC9saT4KICAg\nICAqIDxsaT48aT4tZHJvcFRhYmxlcy8tZHQgJmx0O3RydWUvdCB8IGZhbHNl\nL2YmZ3Q7PC9pPjogQ29ycmVzcG9uZHMgdG8gdGhlCiAgICAgKiBzYW1lLW5h\nbWVkIG9wdGlvbiBpbiB0aGUge0BsaW5rIFNjaGVtYVRvb2x9LjwvbGk+CiAg\nICAgKiA8bGk+PGk+LWRyb3BTZXF1ZW5jZXMvLWRzcSAmbHQ7dHJ1ZS90IHwg\nZmFsc2UvZiZndDs8L2k+OiBDb3JyZXNwb25kcwogICAgICogdG8gdGhlIHNh\nbWUtbmFtZWQgb3B0aW9uIGluIHRoZSB7QGxpbmsgU2NoZW1hVG9vbH0uPC9s\naT4KICAgICAqIDxsaT48aT4tb3BlbmpwYVRhYmxlcy8ta3QgJmx0O3RydWUv\ndCB8IGZhbHNlL2YmZ3Q7PC9pPjogQ29ycmVzcG9uZHMgdG8KICAgICAqIHRo\nZSBzYW1lLW5hbWVkIG9wdGlvbiBpbiB0aGUge0BsaW5rIFNjaGVtYVRvb2x9\nLjwvbGk+CiAgICAgKiA8bGk+PGk+LWlnbm9yZUVycm9ycy8taSAmbHQ7dHJ1\nZS90IHwgZmFsc2UvZiZndDs8L2k+OiBDb3JyZXNwb25kcyB0byB0aGUKICAg\nICAqIHNhbWUtbmFtZWQgb3B0aW9uIGluIHRoZSB7QGxpbmsgU2NoZW1hVG9v\nbH0uPC9saT4KICAgICAqIDxsaT48aT4tcmVhZFNjaGVtYS8tcnMgJmx0O3Ry\ndWUvdCB8IGZhbHNlL2YmZ3Q7PC9pPjogU2V0IHRoaXMgdG8gdHJ1ZQogICAg\nICogdG8gcmVhZCB0aGUgZW50aXJlIGV4aXN0aW5nIHNjaGVtYSAoZXZlbiB3\naGVuIGZhbHNlIHRoZSBwYXJ0cyBvZgogICAgICogdGhlIHNjaGVtYSB1c2Vk\nIGJ5IGNsYXNzZXMgdGhlIHRvb2wgaXMgcnVuIG9uIHdpbGwgc3RpbGwgYmUg\ncmVhZCkuCiAgICAgKiBUdXJuaW5nIG9uIHNjaGVtYSByZWFkaW5nIGNhbiBl\nbnN1cmUgdGhhdCBubyBuYW1pbmcgY29uZmxpY3RzIHdpbGwKICAgICAqIG9j\nY3VyLCBidXQgaXQgY2FuIHRha2UgYSBsb25nIHRpbWUuPC9saT4KICAgICAq\nIDxsaT48aT4tcHJpbWFyeUtleXMvLXBrICZsdDt0cnVlL3QgfCBmYWxzZS9m\nJmd0OzwvaT46IFdoZXRoZXIgcHJpbWFyeQogICAgICoga2V5cyBvbiBleGlz\ndGluZyB0YWJsZXMgYXJlIG1hbmlwdWxhdGVkLiBEZWZhdWx0cyB0byBmYWxz\nZS48L2xpPgogICAgICogPGxpPjxpPi1mb3JlaWduS2V5cy8tZmsgJmx0O3Ry\ndWUvdCB8IGZhbHNlL2YmZ3Q7PC9pPjogV2hldGhlciBmb3JlaWduCiAgICAg\nKiBrZXlzIG9uIGV4aXN0aW5nIHRhYmxlcyBhcmUgbWFuaXB1bGF0ZWQuIERl\nZmF1bHRzIHRvIGZhbHNlLjwvbGk+CiAgICAgKiA8bGk+PGk+LWluZGV4ZXMv\nLWl4ICZsdDt0cnVlL3QgfCBmYWxzZS9mJmd0OzwvaT46IFdoZXRoZXIgaW5k\nZXhlcyBvbgogICAgICogZXhpc3RpbmcgdGFibGVzIGFyZSBtYW5pcHVsYXRl\nZC4gRGVmYXVsdHMgdG8gZmFsc2UuPC9saT4KICAgICAqIDxsaT48aT4tc2Vx\ndWVuY2VzLy1zcSAmbHQ7dHJ1ZS90IHwgZmFsc2UvZiZndDs8L2k+OiBXaGV0\naGVyIHNlcXVlbmNlcwogICAgICogYXJlIG1hbmlwdWxhdGVkLiBEZWZhdWx0\ncyB0byB0cnVlLjwvbGk+CiAgICAgKiA8bGk+PGk+LXNjaGVtYXMvLXMgJmx0\nO3NjaGVtYSBhbmQgdGFibGUgbmFtZXMmZ3Q7PC9pPjogQSBsaXN0IG9mIHNj\naGVtYXMKICAgICAqIGFuZC9vciB0YWJsZXMgdG8gcmVhZC4gQ29ycmVzcG9u\nZHMgdG8gdGhlCiAgICAgKiBzYW1lLW5hbWVkIG9wdGlvbiBpbiB0aGUge0Bs\naW5rIFNjaGVtYUdlbmVyYXRvcn0uIFRoaXMgb3B0aW9uCiAgICAgKiBpcyBp\nZ25vcmVkIGlmIDxjb2RlPnJlYWRTY2hlbWE8L2NvZGU+IGlzIGZhbHNlLjwv\nbGk+CiAgICAgKiA8bGk+PGk+LW1ldGEvLW0gJmx0O3RydWUvdCB8IGZhbHNl\nL2YmZ3Q7PC9pPjogV2hldGhlciB0aGUgZ2l2ZW4gYWN0aW9uCiAgICAgKiBh\ncHBsaWVzIHRvIG1ldGFkYXRhIGFzIHdlbGwgYXMgbWFwcGluZ3MuPC9saT4K\nICAgICAqIDwvdWw+CiAgICAgKiAgVGhlIHZhcmlvdXMgYWN0aW9ucyBhcmUg\nYXMgZm9sbG93cy4KICAgICAqIDx1bD4KICAgICAqIDxsaT48aT5yZWZyZXNo\nPC9pPjogQnJpbmcgdGhlIG1hcHBpbmcgaW5mb3JtYXRpb24gdXAtdG8tZGF0\nZQogICAgICogd2l0aCB0aGUgY2xhc3MgZGVmaW5pdGlvbnMuIE9wZW5KUEEg\nd2lsbCBhdHRlbXB0IHRvIHVzZSBhbnkgcHJvdmlkZWQKICAgICAqIG1hcHBp\nbmcgaW5mb3JtYXRpb24sIGFuZCBmaWxsIGluIG1pc3NpbmcgaW5mb3JtYXRp\nb24uIElmIHRoZQogICAgICogcHJvdmlkZWQgaW5mb3JtYXRpb24gY29uZmxp\nY3RzIHdpdGggdGhlIGNsYXNzIGRlZmluaXRpb24sIHRoZQogICAgICogY29u\nZmxpY3RpbmcgaW5mb3JtYXRpb24gd2lsbCBiZSBkaXNjYXJkZWQgYW5kIHRo\nZSBjbGFzcy9maWVsZCB3aWxsCiAgICAgKiBiZSByZS1tYXBwZWQgdG8gbmV3\nIGNvbHVtbnMvdGFibGVzLiBUaGlzIGlzIHRoZSBkZWZhdWx0IGFjdGlvbi48\nL2xpPgogICAgICogPGxpPjxpPmFkZDwvaT46IElmIHVzZWQgd2l0aCB0aGUg\nPGNvZGU+LW1ldGE8L2NvZGU+IG9wdGlvbiwgYWRkcyBuZXcKICAgICAqIGRl\nZmF1bHQgbWV0YWRhdGEgZm9yIHRoZSBnaXZlbiBjbGFzcyhlcykuIE90aGVy\nd2lzZSwgYnJpbmdzIHRoZQogICAgICogbWFwcGluZyBpbmZvcm1hdGlvbiB1\ncC10by1kYXRlIHdpdGggdGhlIGNsYXNzCiAgICAgKiBkZWZpbml0aW9ucy4g\nT3BlbkpQQSB3aWxsIGF0dGVtcHQgdG8gdXNlIGFueSBwcm92aWRlZCBtYXBw\naW5nCiAgICAgKiBpbmZvcm1hdGlvbiwgYW5kIGZpbGwgaW4gbWlzc2luZyBp\nbmZvcm1hdGlvbi4gT3BlbkpQQSB3aWxsIGZhaWwgaWYKICAgICAqIHRoZSBw\ncm92aWRlZCBpbmZvcm1hdGlvbiBjb25mbGljdHMgd2l0aCB0aGUgY2xhc3Mg\nZGVmaW5pdGlvbi48L2xpPgogICAgICogPGxpPjxpPmJ1aWxkU2NoZW1hPC9p\nPjogQ3JlYXRlIHRoZSBzY2hlbWEgbWF0Y2hpbmcgdGhlIGV4aXN0aW5nCiAg\nICAgKiBtYXBwaW5ncyBmb3IgdGhlIGdpdmVuIGNsYXNzKGVzKS4gQW55IGlu\ndmFsaWQgbWFwcGluZyBpbmZvcm1hdGlvbgogICAgICogd2lsbCBjYXVzZSBh\nbiBleGNlcHRpb24uPC9saT4KICAgICAqIDxsaT48aT5kcm9wPC9pPjogRGVs\nZXRlIG1hcHBpbmdzIGZvciB0aGUgZ2l2ZW4gY2xhc3Nlcy4gSWYgdXNlZCB3\naXRoCiAgICAgKiB0aGUgPGNvZGU+LW1ldGE8L2NvZGU+IG9wdGlvbiwgYWxz\nbyBkZWxldGVzIG1ldGFkYXRhLjwvbGk+CiAgICAgKiA8bGk+PGk+dmFsaWRh\ndGU8L2k+OiBWYWxpZGF0ZSB0aGUgZ2l2ZW4gbWFwcGluZ3MuIFRoZSBtYXBw\naW5nCiAgICAgKiByZXBvc2l0b3J5IGFuZCBzY2hlbWEgd2lsbCBub3QgYmUg\nYWZmZWN0ZWQuPC9saT4KICAgICAqIDxsaT48aT5pbXBvcnQ8L2k+OiBJbXBv\ncnQgbWFwcGluZ3MgZnJvbSBhbiBYTUwgZG9jdW1lbnQgYW5kIHN0b3JlCiAg\nICAgKiB0aGVtIGFzIHRoZSBjdXJyZW50IHN5c3RlbSBtYXBwaW5ncy48L2xp\nPgogICAgICogPGxpPjxpPmV4cG9ydDwvaT46IER1bXAgdGhlIGN1cnJlbnQg\nbWFwcGluZ3MgZm9yIHRoZSBnaXZlbiBjbGFzc2VzIHRvCiAgICAgKiBhbiBY\nTUwgZG9jdW1lbnQgc3BlY2lmaWVkIGJ5IHRoZSA8Y29kZT5maWxlPC9jb2Rl\nPiBvcHRpb24uPC9saT4KICAgICAqIElmIHVzZWQgd2l0aCB0aGUgPGNvZGU+\nLW1ldGE8L2NvZGU+IG9wdGlvbiwgdGhlIG1ldGFkYXRhIHdpbGwgYmUKICAg\nICAqIGluY2x1ZGVkIGluIHRoZSBleHBvcnQuCiAgICAgKiA8L3VsPgogICAg\nICogIEVhY2ggY2xhc3Mgc3VwcGxpZWQgYXMgYW4gYXJndW1lbnQgbXVzdCBo\nYXZlIHZhbGlkIG1ldGFkYXRhLiBJZgogICAgICogbm8gY2xhc3MgYXJndW1l\nbnRzIGFyZSBnaXZlbiwgdGhlIHRvb2wgcnVucyBvbiBhbGwgbWV0YWRhdGEg\nZmlsZXMgaW4KICAgICAqIHRoZSBDTEFTU1BBVEguCiAgICAgKiAgRXhhbXBs\nZXM6CiAgICAgKiA8dWw+CiAgICAgKiA8bGk+UmVmcmVzaCB0aGUgbWFwcGlu\nZ3MgZm9yIGdpdmVuIHBhY2thZ2UsIHdpdGhvdXQgZHJvcHBpbmcgYW55CiAg\nICAgKiBzY2hlbWEgY29tcG9uZW50czo8YnIgLz4KICAgICAqIDxjb2RlPmph\ndmEgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0YS5NYXBwaW5nVG9vbCAK\nICAgICAqICAgICAgbXlwYWNrYWdlLmpkbzwvY29kZT48L2xpPgogICAgICog\nPGxpPlJlZnJlc2ggdGhlIG1hcHBpbmdzIGZvciBhbGwgcGVyc2lzdGVudCBj\nbGFzc2VzIGluIHRoZSBjbGFzc3BhdGgsCiAgICAgKiBkcm9wcGluZyBhbnkg\ndW51c2VkIGNvbHVtbnMgYW5kIGV2ZW4gdGFibGVzOjxiciAvPgogICAgICog\nPGNvZGU+amF2YSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhLk1hcHBp\nbmdUb29sIC1zYSByZWZyZXNoCiAgICAgKiAtZHQgdHJ1ZTwvY29kZT48L2xp\nPgogICAgICogPGxpPk1ha2Ugc3VyZSB0aGUgbWFwcGluZ3MgeW91J3ZlIGNy\nZWF0ZWQgYnkgaGFuZCBtYXRjaCB0aGUgb2JqZWN0CiAgICAgKiBtb2RlbCBh\nbmQgc2NoZW1hOjxiciAvPgogICAgICogPGNvZGU+amF2YSBvcmcuYXBhY2hl\nLm9wZW5qcGEuamJkYy5tZXRhLk1hcHBpbmdUb29sCiAgICAgKiAtYSB2YWxp\nZGF0ZSBQZXJzb24uamF2YTwvY29kZT48L2xpPgogICAgICogPGxpPlJlbW92\nZSB0aGUgcmVjb3JkZWQgbWFwcGluZyBmb3IgYSBnaXZlbiBjbGFzczo8YnIg\nLz4KICAgICAqIDxjb2RlPmphdmEgb3JnLmFwYWNoZS5vcGVuanBhLmpiZGMu\nbWV0YS5NYXBwaW5nVG9vbAogICAgICogLWEgZHJvcCBQZXJzb24uamF2YTwv\nY29kZT48L2xpPgogICAgICogPGxpPlJlY29yZCB0aGUgY3VycmVudCBtYXBw\naW5ncyBpbiBhbiBYTUwgZmlsZTo8YnIgLz4KICAgICAqIDxjb2RlPmphdmEg\nb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0YS5NYXBwaW5nVG9vbAogICAg\nICogLWYgbXlwYWNrYWdlLm9ybSAtYSBleHBvcnQgbXlwYWNrYWdlLmpkbzwv\nY29kZT48L2xpPgogICAgICogPC91bD4KICAgICAqLwogICAgcHVibGljIHN0\nYXRpYyB2b2lkIG1haW4oU3RyaW5nW10gYXJncykKICAgICAgICB0aHJvd3Mg\nSU9FeGNlcHRpb24sIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgT3B0aW9ucyBv\ncHRzID0gbmV3IE9wdGlvbnMoKTsKICAgICAgICBhcmdzID0gb3B0cy5zZXRG\ncm9tQ21kTGluZShhcmdzKTsKICAgICAgICBKREJDQ29uZmlndXJhdGlvbiBj\nb25mID0gbmV3IEpEQkNDb25maWd1cmF0aW9uSW1wbCgpOwogICAgICAgIHRy\neSB7CiAgICAgICAgICAgIGlmICghcnVuKGNvbmYsIGFyZ3MsIG9wdHMpKQog\nICAgICAgICAgICAgICAgU3lzdGVtLmVyci5wcmludGxuKF9sb2MuZ2V0KCJ0\nb29sLXVzYWdlIikpOwogICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAg\nIGNvbmYuY2xvc2UoKTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAg\nKiBSdW4gdGhlIHRvb2wuIFJldHVybnMgZmFsc2UgaWYgaW52YWxpZCBvcHRp\nb25zIGFyZSBnaXZlbi4KICAgICAqCiAgICAgKiBAc2VlICNtYWluCiAgICAg\nKi8KICAgIHB1YmxpYyBzdGF0aWMgYm9vbGVhbiBydW4oSkRCQ0NvbmZpZ3Vy\nYXRpb24gY29uZiwgU3RyaW5nW10gYXJncywKICAgICAgICBPcHRpb25zIG9w\ndHMpCiAgICAgICAgdGhyb3dzIElPRXhjZXB0aW9uLCBTUUxFeGNlcHRpb24g\newogICAgICAgIGlmIChvcHRzLmNvbnRhaW5zS2V5KCJoZWxwIikgfHwgb3B0\ncy5jb250YWluc0tleSgiLWhlbHAiKSkKICAgICAgICAgICAgcmV0dXJuIGZh\nbHNlOwoKICAgICAgICAvLyBmbGFncwogICAgICAgIEZsYWdzIGZsYWdzID0g\nbmV3IEZsYWdzKCk7CiAgICAgICAgZmxhZ3MuYWN0aW9uID0gb3B0cy5yZW1v\ndmVQcm9wZXJ0eSgiYWN0aW9uIiwgImEiLCBmbGFncy5hY3Rpb24pOwogICAg\nICAgIGZsYWdzLnNjaGVtYUFjdGlvbiA9IG9wdHMucmVtb3ZlUHJvcGVydHko\nInNjaGVtYUFjdGlvbiIsICJzYSIsCiAgICAgICAgICAgIGZsYWdzLnNjaGVt\nYUFjdGlvbik7CiAgICAgICAgZmxhZ3MuZHJvcFRhYmxlcyA9IG9wdHMucmVt\nb3ZlQm9vbGVhblByb3BlcnR5CiAgICAgICAgICAgICgiZHJvcFRhYmxlcyIs\nICJkdCIsIGZsYWdzLmRyb3BUYWJsZXMpOwogICAgICAgIGZsYWdzLm9wZW5q\ncGFUYWJsZXMgPSBvcHRzLnJlbW92ZUJvb2xlYW5Qcm9wZXJ0eQogICAgICAg\nICAgICAoIm9wZW5qcGFUYWJsZXMiLCAib3QiLCBmbGFncy5vcGVuanBhVGFi\nbGVzKTsKICAgICAgICBmbGFncy5kcm9wU2VxdWVuY2VzID0gb3B0cy5yZW1v\ndmVCb29sZWFuUHJvcGVydHkKICAgICAgICAgICAgKCJkcm9wU2VxdWVuY2Vz\nIiwgImRzcSIsIGZsYWdzLmRyb3BTZXF1ZW5jZXMpOwogICAgICAgIGZsYWdz\nLnJlYWRTY2hlbWEgPSBvcHRzLnJlbW92ZUJvb2xlYW5Qcm9wZXJ0eQogICAg\nICAgICAgICAoInJlYWRTY2hlbWEiLCAicnMiLCBmbGFncy5yZWFkU2NoZW1h\nKTsKICAgICAgICBmbGFncy5wcmltYXJ5S2V5cyA9IG9wdHMucmVtb3ZlQm9v\nbGVhblByb3BlcnR5CiAgICAgICAgICAgICgicHJpbWFyeUtleXMiLCAicGsi\nLCBmbGFncy5wcmltYXJ5S2V5cyk7CiAgICAgICAgZmxhZ3MuaW5kZXhlcyA9\nIG9wdHMucmVtb3ZlQm9vbGVhblByb3BlcnR5KCJpbmRleGVzIiwgIml4IiwK\nICAgICAgICAgICAgZmxhZ3MuaW5kZXhlcyk7CiAgICAgICAgZmxhZ3MuZm9y\nZWlnbktleXMgPSBvcHRzLnJlbW92ZUJvb2xlYW5Qcm9wZXJ0eSgiZm9yZWln\nbktleXMiLCAiZmsiLAogICAgICAgICAgICBmbGFncy5mb3JlaWduS2V5cyk7\nCiAgICAgICAgZmxhZ3Muc2VxdWVuY2VzID0gb3B0cy5yZW1vdmVCb29sZWFu\nUHJvcGVydHkoInNlcXVlbmNlcyIsICJzcSIsCiAgICAgICAgICAgIGZsYWdz\nLnNlcXVlbmNlcyk7CiAgICAgICAgZmxhZ3MuaWdub3JlRXJyb3JzID0gb3B0\ncy5yZW1vdmVCb29sZWFuUHJvcGVydHkKICAgICAgICAgICAgKCJpZ25vcmVF\ncnJvcnMiLCAiaSIsIGZsYWdzLmlnbm9yZUVycm9ycyk7CiAgICAgICAgZmxh\nZ3MubWV0YSA9IG9wdHMucmVtb3ZlQm9vbGVhblByb3BlcnR5KCJtZXRhIiwg\nIm0iLCBmbGFncy5tZXRhKTsKICAgICAgICBTdHJpbmcgZmlsZU5hbWUgPSBv\ncHRzLnJlbW92ZVByb3BlcnR5KCJmaWxlIiwgImYiLCBudWxsKTsKICAgICAg\nICBTdHJpbmcgc2NoZW1hRmlsZU5hbWUgPSBvcHRzLnJlbW92ZVByb3BlcnR5\nKCJzY2hlbWFGaWxlIiwgInNmIiwgbnVsbCk7CiAgICAgICAgU3RyaW5nIHNx\nbEZpbGVOYW1lID0gb3B0cy5yZW1vdmVQcm9wZXJ0eSgic3FsRmlsZSIsICJz\ncWwiLCBudWxsKTsKICAgICAgICBTdHJpbmcgc2NoZW1hcyA9IG9wdHMucmVt\nb3ZlUHJvcGVydHkoInMiKTsKICAgICAgICBpZiAoc2NoZW1hcyAhPSBudWxs\nKQogICAgICAgICAgICBvcHRzLnNldFByb3BlcnR5KCJzY2hlbWFzIiwgc2No\nZW1hcyk7CgogICAgICAgIENvbmZpZ3VyYXRpb25zLnBvcHVsYXRlQ29uZmln\ndXJhdGlvbihjb25mLCBvcHRzKTsKICAgICAgICBDbGFzc0xvYWRlciBsb2Fk\nZXIgPSBjb25mLmdldENsYXNzUmVzb2x2ZXJJbnN0YW5jZSgpLgogICAgICAg\nICAgICBnZXRDbGFzc0xvYWRlcihNYXBwaW5nVG9vbC5jbGFzcywgbnVsbCk7\nCiAgICAgICAgaWYgKGZsYWdzLm1ldGEgJiYgQUNUSU9OX0FERC5lcXVhbHMo\nZmxhZ3MuYWN0aW9uKSkKICAgICAgICAgICAgZmxhZ3MubWV0YURhdGFGaWxl\nID0gRmlsZXMuZ2V0RmlsZShmaWxlTmFtZSwgbG9hZGVyKTsKICAgICAgICBl\nbHNlCiAgICAgICAgICAgIGZsYWdzLm1hcHBpbmdXcml0ZXIgPSBGaWxlcy5n\nZXRXcml0ZXIoZmlsZU5hbWUsIGxvYWRlcik7CiAgICAgICAgZmxhZ3Muc2No\nZW1hV3JpdGVyID0gRmlsZXMuZ2V0V3JpdGVyKHNjaGVtYUZpbGVOYW1lLCBs\nb2FkZXIpOwogICAgICAgIGZsYWdzLnNxbFdyaXRlciA9IEZpbGVzLmdldFdy\naXRlcihzcWxGaWxlTmFtZSwgbG9hZGVyKTsKCiAgICAgICAgcmV0dXJuIHJ1\nbihjb25mLCBhcmdzLCBmbGFncywgbG9hZGVyKTsKICAgIH0KCiAgICAvKioK\nICAgICAqIFJ1biB0aGUgdG9vbC4gUmV0dXJuIGZhbHNlIGlmIGFuIGludmFs\naWQgb3B0aW9uIHdhcyBnaXZlbi4KICAgICAqLwogICAgcHVibGljIHN0YXRp\nYyBib29sZWFuIHJ1bihKREJDQ29uZmlndXJhdGlvbiBjb25mLCBTdHJpbmdb\nXSBhcmdzLAogICAgICAgIEZsYWdzIGZsYWdzLCBDbGFzc0xvYWRlciBsb2Fk\nZXIpCiAgICAgICAgdGhyb3dzIElPRXhjZXB0aW9uLCBTUUxFeGNlcHRpb24g\newogICAgICAgIC8vIGRlZmF1bHQgYWN0aW9uIGJhc2VkIG9uIHdoZXRoZXIg\ndGhlIG1hcHBpbmcgZGVmYXVsdHMgZmlsbHMgaW4KICAgICAgICAvLyBtaXNz\naW5nIGluZm8KICAgICAgICBpZiAoZmxhZ3MuYWN0aW9uID09IG51bGwpIHsK\nICAgICAgICAgICAgaWYgKGNvbmYuZ2V0TWFwcGluZ0RlZmF1bHRzSW5zdGFu\nY2UoKS5kZWZhdWx0TWlzc2luZ0luZm8oKSkKICAgICAgICAgICAgICAgIGZs\nYWdzLmFjdGlvbiA9IEFDVElPTl9CVUlMRF9TQ0hFTUE7CiAgICAgICAgICAg\nIGVsc2UKICAgICAgICAgICAgICAgIGZsYWdzLmFjdGlvbiA9IEFDVElPTl9S\nRUZSRVNIOwogICAgICAgIH0KCiAgICAgICAgLy8gY29sbGVjdCB0aGUgY2xh\nc3NlcyB0byBhY3Qgb24KICAgICAgICBMb2cgbG9nID0gY29uZi5nZXRMb2co\nT3BlbkpQQUNvbmZpZ3VyYXRpb24uTE9HX1RPT0wpOwogICAgICAgIENvbGxl\nY3Rpb24gY2xhc3NlcyA9IG51bGw7CiAgICAgICAgaWYgKGFyZ3MubGVuZ3Ro\nID09IDApIHsKICAgICAgICAgICAgaWYgKEFDVElPTl9JTVBPUlQuZXF1YWxz\nKGZsYWdzLmFjdGlvbikpCiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7\nCiAgICAgICAgICAgIGxvZy5pbmZvKF9sb2MuZ2V0KCJydW5uaW5nLWFsbC1j\nbGFzc2VzIikpOwogICAgICAgICAgICBjbGFzc2VzID0gY29uZi5nZXRNYXBw\naW5nUmVwb3NpdG9yeUluc3RhbmNlKCkuCiAgICAgICAgICAgICAgICBsb2Fk\nUGVyc2lzdGVudFR5cGVzKHRydWUsIGxvYWRlcik7CiAgICAgICAgfSBlbHNl\nIHsKICAgICAgICAgICAgY2xhc3NlcyA9IG5ldyBIYXNoU2V0KCk7CiAgICAg\nICAgICAgIENsYXNzQXJnUGFyc2VyIGNsYXNzUGFyc2VyID0gY29uZi5nZXRN\nZXRhRGF0YVJlcG9zaXRvcnlJbnN0YW5jZSgpLgogICAgICAgICAgICAgICAg\nZ2V0TWV0YURhdGFGYWN0b3J5KCkubmV3Q2xhc3NBcmdQYXJzZXIoKTsKICAg\nICAgICAgICAgY2xhc3NQYXJzZXIuc2V0Q2xhc3NMb2FkZXIobG9hZGVyKTsK\nICAgICAgICAgICAgQ2xhc3NbXSBwYXJzZWQ7CiAgICAgICAgICAgIGZvciAo\naW50IGkgPSAwOyBhcmdzICE9IG51bGwgJiYgaSA8IGFyZ3MubGVuZ3RoOyBp\nKyspIHsKICAgICAgICAgICAgICAgIHBhcnNlZCA9IGNsYXNzUGFyc2VyLnBh\ncnNlVHlwZXMoYXJnc1tpXSk7CiAgICAgICAgICAgICAgICBjbGFzc2VzLmFk\nZEFsbChBcnJheXMuYXNMaXN0KHBhcnNlZCkpOwogICAgICAgICAgICB9CiAg\nICAgICAgfQoKICAgICAgICBDbGFzc1tdIGFjdCA9IChDbGFzc1tdKSBjbGFz\nc2VzLnRvQXJyYXkobmV3IENsYXNzW2NsYXNzZXMuc2l6ZSgpXSk7CiAgICAg\nICAgaWYgKEFDVElPTl9FWFBPUlQuZXF1YWxzKGZsYWdzLmFjdGlvbikpIHsK\nICAgICAgICAgICAgLy8gcnVuIGV4cG9ydHMgdW50aWwgdGhlIGZpcnN0IGV4\ncG9ydCBzdWNjZWVkcwogICAgICAgICAgICBJbXBvcnRFeHBvcnRbXSBpbnN0\nYW5jZXMgPSBuZXdJbXBvcnRFeHBvcnRzKCk7CiAgICAgICAgICAgIGZvciAo\naW50IGkgPSAwOyBpIDwgaW5zdGFuY2VzLmxlbmd0aDsgaSsrKSB7CiAgICAg\nICAgICAgICAgICBpZiAoaW5zdGFuY2VzW2ldLmV4cG9ydE1hcHBpbmdzKGNv\nbmYsIGFjdCwgZmxhZ3MubWV0YSwgbG9nLAogICAgICAgICAgICAgICAgICAg\nIGZsYWdzLm1hcHBpbmdXcml0ZXIpKQogICAgICAgICAgICAgICAgICAgIHJl\ndHVybiB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiBm\nYWxzZTsKICAgICAgICB9CiAgICAgICAgaWYgKEFDVElPTl9JTVBPUlQuZXF1\nYWxzKGZsYWdzLmFjdGlvbikpIHsKICAgICAgICAgICAgLy8gcnVuIGV4cG9y\ndHMgdW50aWwgdGhlIGZpcnN0IGV4cG9ydCBzdWNjZWVkcwogICAgICAgICAg\nICBJbXBvcnRFeHBvcnRbXSBpbnN0YW5jZXMgPSBuZXdJbXBvcnRFeHBvcnRz\nKCk7CiAgICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgaW5zdGFuY2Vz\nLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgICBpZiAoaW5zdGFuY2Vz\nW2ldLmltcG9ydE1hcHBpbmdzKGNvbmYsIGFjdCwgYXJncywgZmxhZ3MubWV0\nYSwKICAgICAgICAgICAgICAgICAgICBsb2csIGxvYWRlcikpCiAgICAgICAg\nICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgIH0KICAgICAg\nICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KCiAgICAgICAgTWFwcGlu\nZ1Rvb2wgdG9vbDsKICAgICAgICB0cnkgewogICAgICAgICAgICB0b29sID0g\nbmV3IE1hcHBpbmdUb29sKGNvbmYsIGZsYWdzLmFjdGlvbiwgZmxhZ3MubWV0\nYSk7CiAgICAgICAgfSBjYXRjaCAoSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9u\nIGlhZSkgewogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQoK\nICAgICAgICAvLyBzZXR1cCB0aGUgdG9vbAogICAgICAgIHRvb2wuc2V0SWdu\nb3JlRXJyb3JzKGZsYWdzLmlnbm9yZUVycm9ycyk7CiAgICAgICAgdG9vbC5z\nZXRNZXRhRGF0YUZpbGUoZmxhZ3MubWV0YURhdGFGaWxlKTsKICAgICAgICB0\nb29sLnNldE1hcHBpbmdXcml0ZXIoZmxhZ3MubWFwcGluZ1dyaXRlcik7CiAg\nICAgICAgdG9vbC5zZXRTY2hlbWFBY3Rpb24oZmxhZ3Muc2NoZW1hQWN0aW9u\nKTsKICAgICAgICB0b29sLnNldFNjaGVtYVdyaXRlcihmbGFncy5zY2hlbWFX\ncml0ZXIpOwogICAgICAgIHRvb2wuc2V0UmVhZFNjaGVtYShmbGFncy5yZWFk\nU2NoZW1hCiAgICAgICAgICAgICYmICFBQ1RJT05fVkFMSURBVEUuZXF1YWxz\nKGZsYWdzLmFjdGlvbikpOwogICAgICAgIHRvb2wuc2V0UHJpbWFyeUtleXMo\nZmxhZ3MucHJpbWFyeUtleXMpOwogICAgICAgIHRvb2wuc2V0Rm9yZWlnbktl\neXMoZmxhZ3MuZm9yZWlnbktleXMpOwogICAgICAgIHRvb2wuc2V0SW5kZXhl\ncyhmbGFncy5pbmRleGVzKTsKICAgICAgICB0b29sLnNldFNlcXVlbmNlcyhm\nbGFncy5zZXF1ZW5jZXMgfHwgZmxhZ3MuZHJvcFNlcXVlbmNlcyk7CgogICAg\nICAgIC8vIGFuZCBydW4gdGhlIGFjdGlvbgogICAgICAgIGZvciAoaW50IGkg\nPSAwOyBpIDwgYWN0Lmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGxvZy5p\nbmZvKF9sb2MuZ2V0KCJ0b29sLXJ1bm5pbmciLCBhY3RbaV0sIGZsYWdzLmFj\ndGlvbikpOwogICAgICAgICAgICBpZiAoaSA9PSAwICYmIGZsYWdzLnJlYWRT\nY2hlbWEpCiAgICAgICAgICAgICAgICBsb2cuaW5mbyhfbG9jLmdldCgidG9v\nbC10aW1lIikpOwogICAgICAgICAgICB0b29sLnJ1bihhY3RbaV0pOwogICAg\nICAgIH0KICAgICAgICBsb2cuaW5mbyhfbG9jLmdldCgidG9vbC1yZWNvcmQi\nKSk7CiAgICAgICAgdG9vbC5yZWNvcmQoZmxhZ3MpOwogICAgICAgIHJldHVy\nbiB0cnVlOwogICAgfQoKICAgIC8qKgogICAgICogQ3JlYXRlIGFuIHtAbGlu\nayBJbXBvcnRFeHBvcnR9IGluc3RhbmNlLgogICAgICovCiAgICBwcml2YXRl\nIHN0YXRpYyBJbXBvcnRFeHBvcnRbXSBuZXdJbXBvcnRFeHBvcnRzKCkgewog\nICAgICAgIHRyeSB7CiAgICAgICAgICAgIENsYXNzW10gdHlwZXMgPSBTZXJ2\naWNlcy5nZXRJbXBsZW1lbnRvckNsYXNzZXMoSW1wb3J0RXhwb3J0LmNsYXNz\nKTsKICAgICAgICAgICAgSW1wb3J0RXhwb3J0W10gaW5zdGFuY2VzID0gbmV3\nIEltcG9ydEV4cG9ydFt0eXBlcy5sZW5ndGhdOwogICAgICAgICAgICBmb3Ig\nKGludCBpID0gMDsgaSA8IHR5cGVzLmxlbmd0aDsgaSsrKQogICAgICAgICAg\nICAgICAgaW5zdGFuY2VzW2ldID0gKEltcG9ydEV4cG9ydCkgQWNjZXNzQ29u\ndHJvbGxlci5kb1ByaXZpbGVnZWQoCiAgICAgICAgICAgICAgICAgICAgSjJE\nb1ByaXZIZWxwZXIubmV3SW5zdGFuY2VBY3Rpb24odHlwZXNbaV0pKTsKICAg\nICAgICAgICAgcmV0dXJuIGluc3RhbmNlczsKICAgICAgICB9IGNhdGNoIChU\naHJvd2FibGUgdCkgewogICAgICAgICAgICBpZiAodCBpbnN0YW5jZW9mIFBy\naXZpbGVnZWRBY3Rpb25FeGNlcHRpb24pCiAgICAgICAgICAgICAgICB0ID0g\nKChQcml2aWxlZ2VkQWN0aW9uRXhjZXB0aW9uKSB0KS5nZXRFeGNlcHRpb24o\nKTsKICAgICAgICAgICAgdGhyb3cgbmV3IEludGVybmFsRXhjZXB0aW9uKF9s\nb2MuZ2V0KCJpbXBvcnRleHBvcnQtaW5zdGFudGlhdGUiKSx0KTsKICAgICAg\nICB9CiAgICB9CiAgICAKICAgIHByaXZhdGUgc3RhdGljIGJvb2xlYW4gY29u\ndGFpbnMoU3RyaW5nIGxpc3QsIFN0cmluZyBrZXkpIHsKICAgIAlyZXR1cm4g\nKGxpc3QgPT0gbnVsbCkgPyBmYWxzZSA6IGxpc3QuaW5kZXhPZihrZXkpICE9\nIC0xOwogICAgfQoKICAgIC8qKgogICAgICogUnVuIGZsYWdzLgogICAgICov\nCiAgICBwdWJsaWMgc3RhdGljIGNsYXNzIEZsYWdzIHsKCiAgICAgICAgcHVi\nbGljIFN0cmluZyBhY3Rpb24gPSBudWxsOwogICAgICAgIHB1YmxpYyBib29s\nZWFuIG1ldGEgPSBmYWxzZTsKICAgICAgICBwdWJsaWMgU3RyaW5nIHNjaGVt\nYUFjdGlvbiA9IFNjaGVtYVRvb2wuQUNUSU9OX0FERDsKICAgICAgICBwdWJs\naWMgRmlsZSBtZXRhRGF0YUZpbGUgPSBudWxsOwogICAgICAgIHB1YmxpYyBX\ncml0ZXIgbWFwcGluZ1dyaXRlciA9IG51bGw7CiAgICAgICAgcHVibGljIFdy\naXRlciBzY2hlbWFXcml0ZXIgPSBudWxsOwogICAgICAgIHB1YmxpYyBXcml0\nZXIgc3FsV3JpdGVyID0gbnVsbDsKICAgICAgICBwdWJsaWMgYm9vbGVhbiBp\nZ25vcmVFcnJvcnMgPSBmYWxzZTsKICAgICAgICBwdWJsaWMgYm9vbGVhbiBy\nZWFkU2NoZW1hID0gZmFsc2U7CiAgICAgICAgcHVibGljIGJvb2xlYW4gZHJv\ncFRhYmxlcyA9IGZhbHNlOwogICAgICAgIHB1YmxpYyBib29sZWFuIG9wZW5q\ncGFUYWJsZXMgPSBmYWxzZTsKICAgICAgICBwdWJsaWMgYm9vbGVhbiBkcm9w\nU2VxdWVuY2VzID0gZmFsc2U7CiAgICAgICAgcHVibGljIGJvb2xlYW4gc2Vx\ndWVuY2VzID0gdHJ1ZTsKICAgICAgICBwdWJsaWMgYm9vbGVhbiBwcmltYXJ5\nS2V5cyA9IGZhbHNlOwogICAgICAgIHB1YmxpYyBib29sZWFuIGZvcmVpZ25L\nZXlzID0gZmFsc2U7CiAgICAgICAgcHVibGljIGJvb2xlYW4gaW5kZXhlcyA9\nIGZhbHNlOwogICAgfQoKICAgIC8qKgogICAgICogSGVscGVyIHVzZWQgdG8g\naW1wb3J0IGFuZCBleHBvcnQgbWFwcGluZyBkYXRhLgogICAgICovCiAgICBw\ndWJsaWMgc3RhdGljIGludGVyZmFjZSBJbXBvcnRFeHBvcnQgewoKICAgICAg\nICAvKioKICAgICAgICAgKiBJbXBvcnQgbWFwcGluZ3MgZm9yIHRoZSBnaXZl\nbiBjbGFzc2VzIGJhc2VkIG9uIHRoZSBnaXZlbiBhcmd1bWVudHMuCiAgICAg\nICAgICovCiAgICAgICAgcHVibGljIGJvb2xlYW4gaW1wb3J0TWFwcGluZ3Mo\nSkRCQ0NvbmZpZ3VyYXRpb24gY29uZiwgQ2xhc3NbXSBhY3QsCiAgICAgICAg\nICAgIFN0cmluZ1tdIGFyZ3MsIGJvb2xlYW4gbWV0YSwgTG9nIGxvZywgQ2xh\nc3NMb2FkZXIgbG9hZGVyKQogICAgICAgICAgICB0aHJvd3MgSU9FeGNlcHRp\nb247CgogICAgICAgIC8qKgogICAgICAgICAqIEV4cG9ydCBtYXBwaW5ncyBm\nb3IgdGhlIGdpdmVuIGNsYXNzZXMgYmFzZWQgb24gdGhlIGdpdmVuIGFyZ3Vt\nZW50cy4KICAgICAgICAgKi8KICAgICAgICBwdWJsaWMgYm9vbGVhbiBleHBv\ncnRNYXBwaW5ncyhKREJDQ29uZmlndXJhdGlvbiBjb25mLCBDbGFzc1tdIGFj\ndCwKICAgICAgICAgICAgYm9vbGVhbiBtZXRhLCBMb2cgbG9nLCBXcml0ZXIg\nd3JpdGVyKQogICAgICAgICAgICB0aHJvd3MgSU9FeGNlcHRpb247CiAgICB9\nCn0K\n","encoding":"base64"}

