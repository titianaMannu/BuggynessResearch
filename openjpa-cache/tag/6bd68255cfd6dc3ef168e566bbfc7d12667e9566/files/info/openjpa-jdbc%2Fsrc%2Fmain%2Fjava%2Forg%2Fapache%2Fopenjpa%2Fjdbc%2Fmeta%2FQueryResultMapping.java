{"sha":"3c07fc2fb88ca91d59f0e21103d11e897cf79dd4","node_id":"MDQ6QmxvYjIwNjM2NDozYzA3ZmMyZmI4OGNhOTFkNTlmMGUyMTEwM2QxMWU4OTdjZjc5ZGQ0","size":19098,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/3c07fc2fb88ca91d59f0e21103d11e897cf79dd4","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhOwoKaW1wb3J0\nIGphdmEuaW8uRmlsZTsKaW1wb3J0IGphdmEudXRpbC5BcnJheUxpc3Q7Cmlt\ncG9ydCBqYXZhLnV0aWwuQXJyYXlzOwppbXBvcnQgamF2YS51dGlsLkJpdFNl\ndDsKaW1wb3J0IGphdmEudXRpbC5Db2xsZWN0aW9uOwppbXBvcnQgamF2YS51\ndGlsLkhhc2hNYXA7CmltcG9ydCBqYXZhLnV0aWwuSXRlcmF0b3I7CmltcG9y\ndCBqYXZhLnV0aWwuTGlzdDsKaW1wb3J0IGphdmEudXRpbC5NYXA7CgppbXBv\ncnQgb3JnLmFwYWNoZS5jb21tb25zLmxhbmcuU3RyaW5nVXRpbHM7CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hlbWEuQ29sdW1uOwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc3FsLkpvaW5zOwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLmxpYi5tZXRhLlNvdXJjZVRyYWNrZXI7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuTG9jYWxpemVyOwpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi54bWwuQ29tbWVudGFibGU7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YS5KYXZhVHlwZXM7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YS5NZXRhRGF0YU1vZGVzOwpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuTWV0YURhdGFFeGNlcHRp\nb247CmltcG9ydCBzZXJwLnV0aWwuU3RyaW5nczsKCi8qKgogKiBNYXBwaW5n\nIG9mIGEgcXVlcnkgcmVzdWx0IHNldCB0byBzY2FsYXIgYW5kL29yIHBlcnNp\nc3RlbmNlLWNhcGFibGUKICogb2JqZWN0LWxldmVsIHZhbHVlcy4KICoKICog\nQGF1dGhvciBQaW5ha2kgUG9kZGFyCiAqIEBhdXRob3IgQWJlIFdoaXRlCiAq\nLwpwdWJsaWMgY2xhc3MgUXVlcnlSZXN1bHRNYXBwaW5nCiAgICBpbXBsZW1l\nbnRzIE1ldGFEYXRhTW9kZXMsIFNvdXJjZVRyYWNrZXIsIENvbW1lbnRhYmxl\nIHsKCiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBMb2NhbGl6ZXIgX2xvYyA9\nIExvY2FsaXplci5mb3JQYWNrYWdlCiAgICAgICAgKFF1ZXJ5UmVzdWx0TWFw\ncGluZy5jbGFzcyk7CgogICAgcHJpdmF0ZSBmaW5hbCBTdHJpbmcgX25hbWU7\nCiAgICBwcml2YXRlIGZpbmFsIE1hcHBpbmdSZXBvc2l0b3J5IF9yZXBvczsK\nICAgIHByaXZhdGUgRmlsZSBfZmlsZSA9IG51bGw7CiAgICBwcml2YXRlIE9i\namVjdCBfc2NvcGUgPSBudWxsOwogICAgcHJpdmF0ZSBpbnQgX3NyY1R5cGUg\nPSBTUkNfT1RIRVI7CiAgICBwcml2YXRlIGludCBfbW9kZSA9IE1PREVfUVVF\nUlk7CiAgICBwcml2YXRlIENsYXNzIF9jbGFzcyA9IG51bGw7CiAgICBwcml2\nYXRlIGludCBfaWR4ID0gMDsKICAgIHByaXZhdGUgU3RyaW5nW10gX2NvbW1l\nbnRzID0gbnVsbDsKICAgIHByaXZhdGUgTGlzdCBfY29sTGlzdCA9IG51bGw7\nCiAgICBwcml2YXRlIExpc3QgX3BjTGlzdCA9IG51bGw7CgogICAgcHJpdmF0\nZSBQQ1Jlc3VsdFtdIF9wY3MgPSBudWxsOwogICAgcHJpdmF0ZSBPYmplY3Rb\nXSBfY29scyA9IG51bGw7CgogICAgLyoqCiAgICAgKiBDb25zdHJ1Y3Qgd2l0\naCB0aGUgZ2l2ZW4gbmFtZS4KICAgICAqLwogICAgUXVlcnlSZXN1bHRNYXBw\naW5nKFN0cmluZyBuYW1lLCBNYXBwaW5nUmVwb3NpdG9yeSByZXBvcykgewog\nICAgICAgIF9uYW1lID0gbmFtZTsKICAgICAgICBfcmVwb3MgPSByZXBvczsK\nICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgbmFtZSBmb3IgdGhp\ncyBxdWVyeSByZXN1bHQuCiAgICAgKi8KICAgIHB1YmxpYyBTdHJpbmcgZ2V0\nTmFtZSgpIHsKICAgICAgICByZXR1cm4gX25hbWU7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBUaGUgY2xhc3MgdGhhdCBkZWZpbmVzIHRoaXMgcXVlcnkgcmVz\ndWx0LCBvciBudWxsIGlmIG5vbmUuCiAgICAgKi8KICAgIHB1YmxpYyBDbGFz\ncyBnZXREZWZpbmluZ1R5cGUoKSB7CiAgICAgICAgcmV0dXJuIF9jbGFzczsK\nICAgIH0KCiAgICAvKioKICAgICAqIFRoZSBjbGFzcyB0aGF0IGRlZmluZXMg\ndGhpcyBxdWVyeSByZXN1bHQsIG9yIG51bGwgaWYgbm9uZS4KICAgICAqLwog\nICAgcHVibGljIHZvaWQgc2V0RGVmaW5pbmdUeXBlKENsYXNzIGNscykgewog\nICAgICAgIF9jbGFzcyA9IGNsczsKICAgIH0KCiAgICAvKioKICAgICAqIElk\ncyBvZiBtYXBwZWQgc2NhbGFyIGNvbHVtbnMgaW4gdGhlIHJlc3VsdC4gVGhl\nc2Ugd2lsbCB0eXBpY2FsbHkgYmUKICAgICAqIGNvbHVtbiBuYW1lcy4KICAg\nICAqCiAgICAgKiBAc2VlIG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNxbC5S\nZXN1bHQKICAgICAqLwogICAgcHVibGljIE9iamVjdFtdIGdldENvbHVtblJl\nc3VsdHMoKSB7CiAgICAgICAgaWYgKF9jb2xzID09IG51bGwpIHsKICAgICAg\nICAgICAgT2JqZWN0W10gY29sczsKICAgICAgICAgICAgaWYgKF9jb2xMaXN0\nID09IG51bGwpCiAgICAgICAgICAgICAgICBjb2xzID0gbmV3IE9iamVjdFsw\nXTsKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgY29scyA9IF9j\nb2xMaXN0LnRvQXJyYXkoKTsKICAgICAgICAgICAgX2NvbHMgPSBjb2xzOwog\nICAgICAgIH0KICAgICAgICByZXR1cm4gX2NvbHM7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBBZGQgdGhlIGlkIG9mIGEgbWFwcGVkIGNvbHVtbiBpbiB0aGUg\ncXVlcnkgcmVzdWx0LiBUaGlzIHdpbGwgdHlwaWNhbGx5CiAgICAgKiBiZSBh\nIGNvbHVtbiBuYW1lLgogICAgICoKICAgICAqIEBzZWUgb3JnLmFwYWNoZS5v\ncGVuanBhLmpkYmMuc3FsLlJlc3VsdAogICAgICovCiAgICBwdWJsaWMgdm9p\nZCBhZGRDb2x1bW5SZXN1bHQoT2JqZWN0IGlkKSB7CiAgICAgICAgX2NvbHMg\nPSBudWxsOwogICAgICAgIGlmIChfY29sTGlzdCA9PSBudWxsKQogICAgICAg\nICAgICBfY29sTGlzdCA9IG5ldyBBcnJheUxpc3QoKTsKICAgICAgICBfY29s\nTGlzdC5hZGQoaWQpOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRo\nZSBtYXBwZWQgcGVyc2lzdGVuY2UtY2FwYWJsZSB0eXBlcyBpbiB0aGUgcXVl\ncnkgcmVzdWx0LgogICAgICovCiAgICBwdWJsaWMgUENSZXN1bHRbXSBnZXRQ\nQ1Jlc3VsdHMoKSB7CiAgICAgICAgaWYgKF9wY3MgPT0gbnVsbCkgewogICAg\nICAgICAgICBQQ1Jlc3VsdFtdIHBjczsKICAgICAgICAgICAgaWYgKF9wY0xp\nc3QgPT0gbnVsbCkKICAgICAgICAgICAgICAgIHBjcyA9IG5ldyBQQ1Jlc3Vs\ndFswXTsKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgcGNzID0g\nKFBDUmVzdWx0W10pIF9wY0xpc3QudG9BcnJheQogICAgICAgICAgICAgICAg\nICAgIChuZXcgUENSZXN1bHRbX3BjTGlzdC5zaXplKCldKTsKICAgICAgICAg\nICAgX3BjcyA9IHBjczsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIF9wY3M7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBBZGQgYSBtYXBwZWQgcGVyc2lzdGVu\nY2UtY2FwYWJsZSByZXN1bHQgd2l0aCB0aGUgZ2l2ZW4gY2FuZGlkYXRlIHR5\ncGUuCiAgICAgKi8KICAgIHB1YmxpYyBQQ1Jlc3VsdCBhZGRQQ1Jlc3VsdChD\nbGFzcyBjYW5kaWRhdGUpIHsKICAgICAgICBfcGNzID0gbnVsbDsKICAgICAg\nICBQQ1Jlc3VsdCBwYyA9IG5ldyBQQ1Jlc3VsdChjYW5kaWRhdGUpOwogICAg\nICAgIGlmIChfcGNMaXN0ID09IG51bGwpCiAgICAgICAgICAgIF9wY0xpc3Qg\nPSBuZXcgQXJyYXlMaXN0KCk7CiAgICAgICAgX3BjTGlzdC5hZGQocGMpOwog\nICAgICAgIHJldHVybiBwYzsKICAgIH0KCiAgICAvKioKICAgICAqIFRoZSBz\nb3VyY2UgbW9kZSBvZiB0aGlzIHF1ZXJ5IHJlc3VsdC4KICAgICAqLwogICAg\ncHVibGljIGludCBnZXRTb3VyY2VNb2RlKCkgewogICAgICAgIHJldHVybiBf\nbW9kZTsKICAgIH0KCiAgICAvKioKICAgICAqIFRoZSBzb3VyY2UgbW9kZSBv\nZiB0aGlzIHF1ZXJ5IHJlc3VsdC4KICAgICAqLwogICAgcHVibGljIHZvaWQg\nc2V0U291cmNlTW9kZShpbnQgbW9kZSkgewogICAgICAgIF9tb2RlID0gbW9k\nZTsKICAgIH0KCiAgICAvKioKICAgICAqIFJlbGF0aXZlIG9yZGVyIG9mIHJl\nc3VsdCBtYXBwaW5nIGluIG1ldGFkYXRhLgogICAgICovCiAgICBwdWJsaWMg\naW50IGdldExpc3RpbmdJbmRleCgpIHsKICAgICAgICByZXR1cm4gX2lkeDsK\nICAgIH0KCiAgICAvKioKICAgICAqIFJlbGF0aXZlIG9yZGVyIG9mIHJlc3Vs\ndCBtYXBwaW5nIGluIG1ldGFkYXRhLgogICAgICovCiAgICBwdWJsaWMgdm9p\nZCBzZXRMaXN0aW5nSW5kZXgoaW50IGlkeCkgewogICAgICAgIF9pZHggPSBp\nZHg7CiAgICB9CgogICAgcHVibGljIFN0cmluZyB0b1N0cmluZygpIHsKICAg\nICAgICByZXR1cm4gX25hbWU7CiAgICB9CgogICAgLy8vLy8vLy8vLy8vLy8v\nCiAgICAvLyBDb21tZW50YWJsZQogICAgLy8vLy8vLy8vLy8vLy8vCgogICAg\ncHVibGljIFN0cmluZ1tdIGdldENvbW1lbnRzKCkgewogICAgICAgIHJldHVy\nbiAoX2NvbW1lbnRzID09IG51bGwpID8gRU1QVFlfQ09NTUVOVFMgOiBfY29t\nbWVudHM7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0Q29tbWVudHMoU3Ry\naW5nW10gY29tbWVudHMpIHsKICAgICAgICBfY29tbWVudHMgPSBjb21tZW50\nczsKICAgIH0KCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v\nLwogICAgLy8gU291cmNlVHJhY2tlciBpbXBsZW1lbnRhdGlvbgogICAgLy8v\nLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KCiAgICBwdWJsaWMgRmls\nZSBnZXRTb3VyY2VGaWxlKCkgewogICAgICAgIHJldHVybiBfZmlsZTsKICAg\nIH0KCiAgICBwdWJsaWMgT2JqZWN0IGdldFNvdXJjZVNjb3BlKCkgewogICAg\nICAgIHJldHVybiBfc2NvcGU7CiAgICB9CgogICAgcHVibGljIGludCBnZXRT\nb3VyY2VUeXBlKCkgewogICAgICAgIHJldHVybiBfc3JjVHlwZTsKICAgIH0K\nCiAgICBwdWJsaWMgdm9pZCBzZXRTb3VyY2UoRmlsZSBmaWxlLCBPYmplY3Qg\nc2NvcGUsIGludCBzcmNUeXBlKSB7CiAgICAgICAgX2ZpbGUgPSBmaWxlOwog\nICAgICAgIF9zY29wZSA9IHNjb3BlOwogICAgICAgIF9zcmNUeXBlID0gc3Jj\nVHlwZTsKICAgIH0KCiAgICBwdWJsaWMgU3RyaW5nIGdldFJlc291cmNlTmFt\nZSgpIHsKICAgICAgICByZXR1cm4gKF9jbGFzcyA9PSBudWxsKSA/IF9uYW1l\nIDogX2NsYXNzLmdldE5hbWUoKSArICI6IiArIF9uYW1lOwogICAgfQoKICAg\nIC8qKgogICAgICogQSBwZXJzaXN0ZW5jZS1jYXBhYmxlIHJlc3VsdC4KICAg\nICAqLwogICAgcHVibGljIGNsYXNzIFBDUmVzdWx0IHsKCiAgICAgICAgLyoq\nCiAgICAgICAgICogUGF0aCB0b2tlbiB0byByZXByZXNlbnQgYSBkaXNjcmlt\naW5hdG9yLgogICAgICAgICAqLwogICAgICAgIHB1YmxpYyBzdGF0aWMgZmlu\nYWwgU3RyaW5nIERJU0NSSU1JTkFUT1IgPSAiPGRpc2NyaW1pbmF0b3I+IjsK\nCiAgICAgICAgcHJpdmF0ZSBmaW5hbCBDbGFzcyBfY2FuZGlkYXRlOwogICAg\nICAgIHByaXZhdGUgQ2xhc3NNYXBwaW5nIF9jYW5kaWRhdGVNYXAgPSBudWxs\nOwogICAgICAgIHByaXZhdGUgTWFwIF9yYXdNYXBwaW5ncyA9IG51bGw7IC8v\nIHN0cmluZy0+b2JqZWN0CiAgICAgICAgcHJpdmF0ZSBNYXAgX21hcHBpbmdz\nID0gbnVsbDsgLy8gbGlzdC0+Y29sdW1ubWFwCiAgICAgICAgcHJpdmF0ZSBN\nYXAgX2VhZ2VyID0gbnVsbDsgLy8gbGlzdC0+ZmV0Y2hpbmZvCiAgICAgICAg\ncHJpdmF0ZSBGZXRjaEluZm8gX2ZldGNoSW5mbyA9IG51bGw7IC8vIGZvciB0\nb3AtbGV2ZWwKCiAgICAgICAgLyoqCiAgICAgICAgICogU3VwcGx5IGNhbmRp\nZGF0ZSB0eXBlIG9uIGNvbnN0cnVjdGlvbi4KICAgICAgICAgKi8KICAgICAg\nICBwcml2YXRlIFBDUmVzdWx0KENsYXNzIGNhbmRpZGF0ZSkgewogICAgICAg\nICAgICBfY2FuZGlkYXRlID0gY2FuZGlkYXRlOwogICAgICAgIH0KCiAgICAg\nICAgLyoqCiAgICAgICAgICogVGhlIHJlc3VsdCBjYW5kaWRhdGUgY2xhc3Mu\nCiAgICAgICAgICovCiAgICAgICAgcHVibGljIENsYXNzIGdldENhbmRpZGF0\nZVR5cGUoKSB7CiAgICAgICAgICAgIHJldHVybiBfY2FuZGlkYXRlOwogICAg\nICAgIH0KCiAgICAgICAgLyoqCiAgICAgICAgICogQ2FuZGlkYXRlIG1hcHBp\nbmcuCiAgICAgICAgICovCiAgICAgICAgcHVibGljIENsYXNzTWFwcGluZyBn\nZXRDYW5kaWRhdGVUeXBlTWFwcGluZygpIHsKICAgICAgICAgICAgaWYgKF9j\nYW5kaWRhdGVNYXAgPT0gbnVsbCkKICAgICAgICAgICAgICAgIF9jYW5kaWRh\ndGVNYXAgPSBfcmVwb3MuZ2V0TWFwcGluZyhfY2FuZGlkYXRlLCBudWxsLCB0\ncnVlKTsKICAgICAgICAgICAgcmV0dXJuIF9jYW5kaWRhdGVNYXA7CiAgICAg\nICAgfQoKICAgICAgICAvKioKICAgICAgICAgKiBSZXR1cm4gdGhlIHJhdyBt\nYXBwaW5nIHBhdGhzIHN1cHBsaWVkIHdpdGgge0BsaW5rICNhZGRNYXBwaW5n\nfSwgb3IKICAgICAgICAgKiBlbXB0eSBhcnJheSBpZiBub25lLgogICAgICAg\nICAqLwogICAgICAgIHB1YmxpYyBTdHJpbmdbXSBnZXRNYXBwaW5nUGF0aHMo\nKSB7CiAgICAgICAgICAgIGlmIChfcmF3TWFwcGluZ3MgPT0gbnVsbCkKICAg\nICAgICAgICAgICAgIHJldHVybiBuZXcgU3RyaW5nWzBdOwogICAgICAgICAg\nICBDb2xsZWN0aW9uIGtleXMgPSBfcmF3TWFwcGluZ3Mua2V5U2V0KCk7CiAg\nICAgICAgICAgIHJldHVybiAoU3RyaW5nW10pIGtleXMudG9BcnJheShuZXcg\nU3RyaW5nW2tleXMuc2l6ZSgpXSk7CiAgICAgICAgfQoKICAgICAgICAvKioK\nICAgICAgICAgKiBSZXR1cm4gdGhlIG1hcHBpbmcgaWQgZm9yIHRoZSBnaXZl\nbiBwYXRoIHN1cHBsaWVkIHdpdGgKICAgICAgICAgKiB7QGxpbmsgI2FkZE1h\ncHBpbmd9LCBvciBudWxsIGlmIG5vbmUuCiAgICAgICAgICovCiAgICAgICAg\ncHVibGljIE9iamVjdCBnZXRNYXBwaW5nKFN0cmluZyBwYXRoKSB7CiAgICAg\nICAgICAgIHJldHVybiAoX3Jhd01hcHBpbmdzID09IG51bGwpID8gbnVsbCA6\nIF9yYXdNYXBwaW5ncy5nZXQocGF0aCk7CiAgICAgICAgfQoKICAgICAgICAv\nKioKICAgICAgICAgKiBNYXAgdGhlIGdpdmVuIHBhdGggdG8gdGhlIGdpdmVu\nIHJlc3VsdCBpZC4KICAgICAgICAgKi8KICAgICAgICBwdWJsaWMgdm9pZCBh\nZGRNYXBwaW5nKFN0cmluZyBwYXRoLCBPYmplY3QgaWQpIHsKICAgICAgICAg\nICAgaWYgKFN0cmluZ1V0aWxzLmlzRW1wdHkocGF0aCkpCiAgICAgICAgICAg\nICAgICB0aHJvdyBuZXcgTWV0YURhdGFFeGNlcHRpb24oX2xvYy5nZXQoIm51\nbGwtcGF0aCIsCiAgICAgICAgICAgICAgICAgICAgUXVlcnlSZXN1bHRNYXBw\naW5nLnRoaXMsIF9jYW5kaWRhdGUpKTsKCiAgICAgICAgICAgIF9tYXBwaW5n\ncyA9IG51bGw7CiAgICAgICAgICAgIF9lYWdlciA9IG51bGw7CiAgICAgICAg\nICAgIF9mZXRjaEluZm8gPSBudWxsOwogICAgICAgICAgICBpZiAoX3Jhd01h\ncHBpbmdzID09IG51bGwpCiAgICAgICAgICAgICAgICBfcmF3TWFwcGluZ3Mg\nPSBuZXcgSGFzaE1hcCgpOwogICAgICAgICAgICBfcmF3TWFwcGluZ3MucHV0\nKHBhdGgsIGlkKTsKICAgICAgICB9CgogICAgICAgIC8qKgogICAgICAgICAq\nIE1hcCB0aGUgZ2l2ZW4gcmVxdWVzdCBvbnRvIGEgcmVzdWx0IGlkLgogICAg\nICAgICAqCiAgICAgICAgICogQHBhcmFtIHBhdGggc3RhY2sgb2YgZGF0YSBy\nZXF1ZXN0cyAoc2VlCiAgICAgICAgICoge0BsaW5rIG9yZy5hcGFjaGUub3Bl\nbmpwYS5qZGJjLnNxbC5SZXN1bHQjc3RhcnREYXRhUmVxdWVzdH0pCiAgICAg\nICAgICogQHBhcmFtIGlkIHJlcXVlc3RlZCBpZCBvciBjb2x1bW4gKHNlZQog\nICAgICAgICAqIHtAbGluayBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zcWwu\nUmVzdWx0fSBBUElzKQogICAgICAgICAqIEBwYXJhbSBqb2lucyByZXF1ZXN0\nZWQgam9pbnMsIG9yIG51bGwKICAgICAgICAgKiBAcmV0dXJuIHRoZSBpZCBv\nciBjb2x1bW4gdG8gZmV0Y2ggZnJvbSB0aGUgcmVzdWx0CiAgICAgICAgICog\nKHR5cGljYWxseSBhIGNvbHVtbiBuYW1lKQogICAgICAgICAqLwogICAgICAg\nIHB1YmxpYyBPYmplY3QgbWFwKExpc3QgcGF0aCwgT2JqZWN0IGlkLCBKb2lu\ncyBqb2lucykgewogICAgICAgICAgICBpZiAoX3Jhd01hcHBpbmdzID09IG51\nbGwgfHwgIShpZCBpbnN0YW5jZW9mIENvbHVtbikpCiAgICAgICAgICAgICAg\nICByZXR1cm4gaWQ7CgogICAgICAgICAgICByZXNvbHZlKCk7CiAgICAgICAg\nICAgIENvbHVtbk1hcCBjbSA9IChDb2x1bW5NYXApIF9tYXBwaW5ncy5nZXQo\ncGF0aCk7CiAgICAgICAgICAgIHJldHVybiAoY20gPT0gbnVsbCkgPyBpZCA6\nIGNtLm1hcCgoQ29sdW1uKSBpZCk7CiAgICAgICAgfQoKICAgICAgICAvKioK\nICAgICAgICAgKiBSZXR1cm4gdHJ1ZSBpZiB0aGUgbWFwcGVkIHJlc3VsdCBj\nb250YWlucyBlYWdlciBkYXRhIGZvciB0aGUgZ2l2ZW4KICAgICAgICAgKiBm\naWVsZCBhdCB0aGUgZ2l2ZW4gcGF0aC4KICAgICAgICAgKgogICAgICAgICAq\nIEBwYXJhbSBwYXRoIHN0YWNrIG9mIGRhdGEgcmVxdWVzdHMgKHNlZQogICAg\nICAgICAqIHtAbGluayBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zcWwuUmVz\ndWx0I3N0YXJ0RGF0YVJlcXVlc3R9KQogICAgICAgICAqLwogICAgICAgIHB1\nYmxpYyBib29sZWFuIGhhc0VhZ2VyKExpc3QgcGF0aCwgRmllbGRNYXBwaW5n\nIGZpZWxkKSB7CiAgICAgICAgICAgIGlmIChfcmF3TWFwcGluZ3MgPT0gbnVs\nbCkKICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCiAgICAgICAgICAg\nIHJlc29sdmUoKTsKICAgICAgICAgICAgaWYgKHBhdGguaXNFbXB0eSgpKQog\nICAgICAgICAgICAgICAgcmV0dXJuIF9mZXRjaEluZm8uZWFnZXIuZ2V0KGZp\nZWxkLmdldEluZGV4KCkpOwogICAgICAgICAgICBpZiAoX2VhZ2VyID09IG51\nbGwpCiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICAg\nIEZldGNoSW5mbyBpbmZvID0gKEZldGNoSW5mbykgX2VhZ2VyLmdldChwYXRo\nKTsKICAgICAgICAgICAgcmV0dXJuIGluZm8gIT0gbnVsbCAmJiBpbmZvLmVh\nZ2VyLmdldChmaWVsZC5nZXRJbmRleCgpKTsKICAgICAgICB9CgogICAgICAg\nIC8qKgogICAgICAgICAqIFJldHVybiB0aGUgZmllbGQgaW5kZXhlcyB0byBl\neGNsdWRlIHdoZW4gbG9hZGluZyBkYXRhIGZvciB0aGUKICAgICAgICAgKiBn\naXZlbiBwYXRoLgogICAgICAgICAqLwogICAgICAgIHB1YmxpYyBCaXRTZXQg\nZ2V0RXhjbHVkZXMoTGlzdCBwYXRoKSB7CiAgICAgICAgICAgIGlmIChfcmF3\nTWFwcGluZ3MgPT0gbnVsbCkKICAgICAgICAgICAgICAgIHJldHVybiBudWxs\nOwoKICAgICAgICAgICAgcmVzb2x2ZSgpOwogICAgICAgICAgICBpZiAocGF0\naC5pc0VtcHR5KCkpCiAgICAgICAgICAgICAgICByZXR1cm4gX2ZldGNoSW5m\nby5leGNsdWRlczsKICAgICAgICAgICAgaWYgKF9lYWdlciA9PSBudWxsKQog\nICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgICAgIEZldGNo\nSW5mbyBpbmZvID0gKEZldGNoSW5mbykgX2VhZ2VyLmdldChwYXRoKTsKICAg\nICAgICAgICAgcmV0dXJuIChpbmZvID09IG51bGwpID8gbnVsbCA6IGluZm8u\nZXhjbHVkZXM7CiAgICAgICAgfQoKICAgICAgICAvKioKICAgICAgICAgKiBS\nZXNvbHZlIGludGVybmFsIGRhdGFzdHJ1Y3R1cmVzIGZyb20gcmF3IG1hcHBp\nbmdzLgogICAgICAgICAqLwogICAgICAgIHByaXZhdGUgc3luY2hyb25pemVk\nIHZvaWQgcmVzb2x2ZSgpIHsKICAgICAgICAgICAgaWYgKF9yYXdNYXBwaW5n\ncyA9PSBudWxsIHx8IF9tYXBwaW5ncyAhPSBudWxsKQogICAgICAgICAgICAg\nICAgcmV0dXJuOwoKICAgICAgICAgICAgX21hcHBpbmdzID0gbmV3IEhhc2hN\nYXAoKTsKICAgICAgICAgICAgX2ZldGNoSW5mbyA9IG5ldyBGZXRjaEluZm8o\nZ2V0Q2FuZGlkYXRlVHlwZU1hcHBpbmcoKSk7CgogICAgICAgICAgICBNYXAu\nRW50cnkgZW50cnk7CiAgICAgICAgICAgIGZvciAoSXRlcmF0b3IgaXRyID0g\nX3Jhd01hcHBpbmdzLmVudHJ5U2V0KCkuaXRlcmF0b3IoKTsKICAgICAgICAg\nICAgICAgIGl0ci5oYXNOZXh0KCk7KSB7CiAgICAgICAgICAgICAgICBlbnRy\neSA9IChNYXAuRW50cnkpIGl0ci5uZXh0KCk7CiAgICAgICAgICAgICAgICBy\nZXNvbHZlTWFwcGluZygoU3RyaW5nKSBlbnRyeS5nZXRLZXkoKSwgZW50cnku\nZ2V0VmFsdWUoKSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAg\nIC8qKgogICAgICAgICAqIFJlc29sdmUgdGhlIGdpdmVuIG1hcHBpbmcgcGF0\naC4KICAgICAgICAgKi8KICAgICAgICBwcml2YXRlIHZvaWQgcmVzb2x2ZU1h\ncHBpbmcoU3RyaW5nIHBhdGgsIE9iamVjdCBpZCkgewogICAgICAgICAgICAv\nLyBidWlsZCB1cCBwYXRoIHRvIHNlY29uZC10by1sYXN0IHRva2VuCiAgICAg\nICAgICAgIFN0cmluZ1tdIHRva2VucyA9IFN0cmluZ3Muc3BsaXQocGF0aCwg\nIi4iLCAwKTsKICAgICAgICAgICAgTGlzdCBycGF0aCA9IG5ldyBBcnJheUxp\nc3QodG9rZW5zLmxlbmd0aCk7CiAgICAgICAgICAgIENsYXNzTWFwcGluZyBj\nYW5kaWRhdGUgPSBnZXRDYW5kaWRhdGVUeXBlTWFwcGluZygpOwogICAgICAg\nICAgICBGaWVsZE1hcHBpbmcgZm0gPSBudWxsOwogICAgICAgICAgICBmb3Ig\nKGludCBpID0gMDsgaSA8IHRva2Vucy5sZW5ndGggLSAxOyBpKyspIHsKICAg\nICAgICAgICAgICAgIGZtID0gY2FuZGlkYXRlLmdldEZpZWxkTWFwcGluZyh0\nb2tlbnNbaV0pOwogICAgICAgICAgICAgICAgaWYgKGZtID09IG51bGwpCiAg\nICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IE1ldGFEYXRhRXhjZXB0aW9u\nKF9sb2MuZ2V0KCJiYWQtcGF0aCIsCiAgICAgICAgICAgICAgICAgICAgICAg\nIFF1ZXJ5UmVzdWx0TWFwcGluZy50aGlzLCBfY2FuZGlkYXRlLCBwYXRoKSk7\nCgogICAgICAgICAgICAgICAgaWYgKGZtLmdldEVtYmVkZGVkTWFwcGluZygp\nICE9IG51bGwpIHsKICAgICAgICAgICAgICAgICAgICByZWNvcmRJbmNsdWRl\nZChjYW5kaWRhdGUsIHJwYXRoLCBmbSk7CiAgICAgICAgICAgICAgICAgICAg\nY2FuZGlkYXRlID0gZm0uZ2V0RW1iZWRkZWRNYXBwaW5nKCk7CiAgICAgICAg\nICAgICAgICB9IGVsc2UKICAgICAgICAgICAgICAgICAgICBjYW5kaWRhdGUg\nPSBmbS5nZXRUeXBlTWFwcGluZygpOwogICAgICAgICAgICAgICAgaWYgKGNh\nbmRpZGF0ZSA9PSBudWxsKQogICAgICAgICAgICAgICAgICAgIHRocm93IG5l\ndyBNZXRhRGF0YUV4Y2VwdGlvbihfbG9jLmdldCgidW50cmF2ZXJzYWJsZS1w\nYXRoIiwKICAgICAgICAgICAgICAgICAgICAgICAgUXVlcnlSZXN1bHRNYXBw\naW5nLnRoaXMsIF9jYW5kaWRhdGUsIHBhdGgpKTsKICAgICAgICAgICAgICAg\nIHJwYXRoLmFkZChmbSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIFN0\ncmluZyBsYXN0VG9rZW4gPSB0b2tlbnNbdG9rZW5zLmxlbmd0aCAtIDFdOwog\nICAgICAgICAgICBpZiAoRElTQ1JJTUlOQVRPUi5lcXVhbHMobGFzdFRva2Vu\nKSkgewogICAgICAgICAgICAgICAgRGlzY3JpbWluYXRvciBkaXNjcmltID0g\nY2FuZGlkYXRlLmdldERpc2NyaW1pbmF0b3IoKTsKICAgICAgICAgICAgICAg\nIHJwYXRoLmFkZChkaXNjcmltKTsKICAgICAgICAgICAgICAgIGFzc2VydFNp\nbmdsZUNvbHVtbihkaXNjcmltLmdldENvbHVtbnMoKSwgcGF0aCk7CiAgICAg\nICAgICAgICAgICBfbWFwcGluZ3MucHV0KHJwYXRoLCBuZXcgU2luZ2xlQ29s\ndW1uTWFwKGlkKSk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAg\nICAgICBGaWVsZE1hcHBpbmcgbGFzdCA9IGNhbmRpZGF0ZS5nZXRGaWVsZE1h\ncHBpbmcobGFzdFRva2VuKTsKICAgICAgICAgICAgICAgIGlmIChsYXN0ID09\nIG51bGwpCiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IE1ldGFEYXRh\nRXhjZXB0aW9uKF9sb2MuZ2V0KCJ1bnRyYXZlcnNhYmxlLXBhdGgiLAogICAg\nICAgICAgICAgICAgICAgICAgICBRdWVyeVJlc3VsdE1hcHBpbmcudGhpcywg\nX2NhbmRpZGF0ZSwgcGF0aCkpOwogICAgICAgICAgICAgICAgQ29sdW1uW10g\nY29scyA9IGxhc3QuZ2V0Q29sdW1ucygpOwogICAgICAgICAgICAgICAgYXNz\nZXJ0U2luZ2xlQ29sdW1uKGNvbHMsIHBhdGgpOwogICAgICAgICAgICAgICAg\nQ29sdW1uIGNvbCA9IGNvbHNbMF07CiAgICAgICAgICAgICAgICAKICAgICAg\nICAgICAgICAgIC8vIHNwZWNpYWwtY2FzZSBvaWQgZmllbGRzLCBzaW5jZSBw\nYXRoIGxpc3RzIHN1cHBsaWVkIGZvcgogICAgICAgICAgICAgICAgLy8gdGhl\nbSBhdCBydW50aW1lIGRvbid0IGluY2x1ZGUgdGhlIGVtYmVkZGVkIGZpZWxk\ncwogICAgICAgICAgICAgICAgaWYgKGZtICE9IG51bGwgJiYgZm0uZ2V0RGVj\nbGFyZWRUeXBlQ29kZSgpID09IEphdmFUeXBlcy5PSUQpIHsKICAgICAgICAg\nICAgICAgICAgICBhZGRDb21wbGV4Q29sdW1uTWFwcGluZyhmbSwgcnBhdGgs\nIGNvbCwgaWQpOwogICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAg\nICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBpZiAoZm0gIT0gbnVsbCAm\nJiBmbS5nZXRGb3JlaWduS2V5KCkgIT0gbnVsbCkgewogICAgICAgICAgICAg\nICAgICAgIC8vIGlmIHRoZSBsYXN0IGZpZWxkIGlzIG9uZSBvZiB0aGUgam9p\nbmFibGVzIHVzZWQgaW4gdGhlCiAgICAgICAgICAgICAgICAgICAgLy8gcmVs\nYXRpb24ncyBmb3JlaWduIGtleSwgbWFwIHRvIHJlbGF0aW9uIGZpZWxkIHBh\ndGguCiAgICAgICAgICAgICAgICAgICAgLy8gb3RoZXJ3aXNlLCByZWNvcmQg\ndGhhdCB3ZSBoYXZlIGFuIGVhZ2VyIHJlc3VsdAogICAgICAgICAgICAgICAg\nICAgIENvbHVtbiBma0NvbCA9IGZtLmdldEZvcmVpZ25LZXkoKS5nZXRDb2x1\nbW4oY29sKTsKICAgICAgICAgICAgICAgICAgICBpZiAoZmtDb2wgIT0gbnVs\nbCkKICAgICAgICAgICAgICAgICAgICAgICAgYWRkQ29tcGxleENvbHVtbk1h\ncHBpbmcoZm0sIG5ldyBBcnJheUxpc3QocnBhdGgpLAogICAgICAgICAgICAg\nICAgICAgICAgICAgICAgZmtDb2wsIGlkKTsKICAgICAgICAgICAgICAgICAg\nICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmVjb3JkRWFnZXIo\nY2FuZGlkYXRlLCBycGF0aCwgZm0pOwogICAgICAgICAgICAgICAgICAgICAg\nICByZWNvcmRJbmNsdWRlZChjYW5kaWRhdGUsIHJwYXRoLCBsYXN0KTsKICAg\nICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9IGVsc2UKICAg\nICAgICAgICAgICAgICAgICByZWNvcmRJbmNsdWRlZChjYW5kaWRhdGUsIHJw\nYXRoLCBsYXN0KTsKCiAgICAgICAgICAgICAgICAvLyBtYXAgdG8gcmVsYXRl\nZCBmaWVsZCBwYXRoLiBiZWNhdXNlIHRoZSBTaW5nbGVDb2x1bW5NYXAKICAg\nICAgICAgICAgICAgIC8vIGRvZXNuJ3QgdGVzdCB0aGUgcmVxdWVzdGVkIGNv\nbHVtbiwgaXQgd2lsbCBhY2NlcHQKICAgICAgICAgICAgICAgIC8vIHJlcXVl\nc3RzIGZvciBib3RoIHRoZSBmayBjb2wgb3IgdGhlIHJlbGF0ZWQgZmllbGQg\nY29sCiAgICAgICAgICAgICAgICBycGF0aC5hZGQobGFzdCk7CiAgICAgICAg\nICAgICAgICBfbWFwcGluZ3MucHV0KHJwYXRoLCBuZXcgU2luZ2xlQ29sdW1u\nTWFwKGlkKSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIC8q\nKgogICAgICAgICAqIENyZWF0ZSBhbiBhcHByb3ByaWF0ZSBjb2x1bW4gbWFw\ncGluZyBmb3IgdGhlIGdpdmVuIGZpZWxkLgogICAgICAgICAqLwogICAgICAg\nIHByaXZhdGUgdm9pZCBhZGRDb21wbGV4Q29sdW1uTWFwcGluZyhGaWVsZE1h\ncHBpbmcgZm0sIExpc3QgcnBhdGgsCiAgICAgICAgICAgIENvbHVtbiBjb2ws\nIE9iamVjdCBpZCkgewogICAgICAgICAgICBpZiAoZm0uZ2V0Q29sdW1ucygp\nLmxlbmd0aCA9PSAxKQogICAgICAgICAgICAgICAgX21hcHBpbmdzLnB1dChy\ncGF0aCwgbmV3IFNpbmdsZUNvbHVtbk1hcChpZCkpOwogICAgICAgICAgICBl\nbHNlIHsKICAgICAgICAgICAgICAgIE11bHRpQ29sdW1uTWFwIG1jbSA9IChN\ndWx0aUNvbHVtbk1hcCkgX21hcHBpbmdzLmdldChycGF0aCk7CiAgICAgICAg\nICAgICAgICBpZiAobWNtID09IG51bGwpIHsKICAgICAgICAgICAgICAgICAg\nICBtY20gPSBuZXcgTXVsdGlDb2x1bW5NYXAoZm0uZ2V0Q29sdW1ucygpKTsK\nICAgICAgICAgICAgICAgICAgICBfbWFwcGluZ3MucHV0KHJwYXRoLCBtY20p\nOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgbWNtLnNldChj\nb2wsIGlkKTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgLyoq\nCiAgICAgICAgICogRm9yIG5vdywgd2Ugb25seSBhbGxvdyBtYXBwaW5ncyB3\naXRoIGEgc2luZ2xlIGNvbHVtbi4gSW4gdGhlCiAgICAgICAgICogZnV0dXJl\nIHdlIG1pZ2h0IGludHJvZHVjZSBhIHN5bnRheCB0byBtYXAgbXVsdGlwbGUg\nY29sdW1ucy4KICAgICAgICAgKi8KICAgICAgICBwcml2YXRlIHZvaWQgYXNz\nZXJ0U2luZ2xlQ29sdW1uKENvbHVtbltdIGNvbHMsIFN0cmluZyBwYXRoKSB7\nCiAgICAgICAgICAgIGlmIChjb2xzLmxlbmd0aCAhPSAxKQogICAgICAgICAg\nICAgICAgdGhyb3cgbmV3IE1ldGFEYXRhRXhjZXB0aW9uKF9sb2MuZ2V0KCJu\ndW0tY29scy1wYXRoIiwKICAgICAgICAgICAgICAgICAgICBRdWVyeVJlc3Vs\ndE1hcHBpbmcudGhpcywgX2NhbmRpZGF0ZSwgcGF0aCkpOwogICAgICAgIH0K\nCiAgICAgICAgLyoqCiAgICAgICAgICogUmVjb3JkIHRoYXQgdGhlcmUgbWF5\nIGJlIGVhZ2VyIGRhdGEgZm9yIHRoZSBnaXZlbiBmaWVsZCBhdCB0aGUgZ2l2\nZW4KICAgICAgICAgKiBwYXRoLgogICAgICAgICAqLwogICAgICAgIHByaXZh\ndGUgdm9pZCByZWNvcmRFYWdlcihDbGFzc01hcHBpbmcgY2FuZGlkYXRlLCBM\naXN0IHBhdGgsCiAgICAgICAgICAgIEZpZWxkTWFwcGluZyBmbSkgewogICAg\nICAgICAgICBpZiAocGF0aC5zaXplKCkgPT0gMSkgewogICAgICAgICAgICAg\nICAgX2ZldGNoSW5mby5lYWdlci5zZXQoZm0uZ2V0SW5kZXgoKSk7CiAgICAg\nICAgICAgICAgICBfZmV0Y2hJbmZvLmV4Y2x1ZGVzLmNsZWFyKGZtLmdldElu\nZGV4KCkpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAg\nLy8gcmVjb3JkIGF0IHByZXZpb3VzIHBhdGgKICAgICAgICAgICAgICAgIExp\nc3QgY29weSA9IG5ldyBBcnJheUxpc3QocGF0aC5zaXplKCkgLSAxKTsKICAg\nICAgICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgY29weS5zaXplKCk7\nIGkrKykKICAgICAgICAgICAgICAgICAgICBjb3B5LmFkZChwYXRoLmdldChp\nKSk7CgogICAgICAgICAgICAgICAgaWYgKF9lYWdlciA9PSBudWxsKQogICAg\nICAgICAgICAgICAgICAgIF9lYWdlciA9IG5ldyBIYXNoTWFwKCk7CiAgICAg\nICAgICAgICAgICBGZXRjaEluZm8gaW5mbyA9IChGZXRjaEluZm8pIF9lYWdl\nci5nZXQoY29weSk7CiAgICAgICAgICAgICAgICBpZiAoaW5mbyA9PSBudWxs\nKSB7CiAgICAgICAgICAgICAgICAgICAgaW5mbyA9IG5ldyBGZXRjaEluZm8o\nY2FuZGlkYXRlKTsKICAgICAgICAgICAgICAgICAgICBfZWFnZXIucHV0KGNv\ncHksIGluZm8pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAg\naW5mby5lYWdlci5zZXQoZm0uZ2V0SW5kZXgoKSk7CiAgICAgICAgICAgICAg\nICBpbmZvLmV4Y2x1ZGVzLmNsZWFyKGZtLmdldEluZGV4KCkpOwogICAgICAg\nICAgICB9CiAgICAgICAgfQoKICAgICAgICAvKioKICAgICAgICAgKiBSZWNv\ncmQgdGhhdCB0aGUgZmllbGQgYXQgdGhlIGdpdmVuIHBhdGggaXMgaW5jbHVk\nZWQgaW4gdGhlIHJlc3VsdHMuCiAgICAgICAgICovCiAgICAgICAgcHJpdmF0\nZSB2b2lkIHJlY29yZEluY2x1ZGVkKENsYXNzTWFwcGluZyBjYW5kaWRhdGUs\nIExpc3QgcGF0aCwKICAgICAgICAgICAgRmllbGRNYXBwaW5nIGZtKSB7CiAg\nICAgICAgICAgIGlmIChwYXRoLmlzRW1wdHkoKSkKICAgICAgICAgICAgICAg\nIF9mZXRjaEluZm8uZXhjbHVkZXMuY2xlYXIoZm0uZ2V0SW5kZXgoKSk7CiAg\nICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgaWYgKF9lYWdlciA9\nPSBudWxsKQogICAgICAgICAgICAgICAgICAgIF9lYWdlciA9IG5ldyBIYXNo\nTWFwKCk7CiAgICAgICAgICAgICAgICBGZXRjaEluZm8gaW5mbyA9IChGZXRj\naEluZm8pIF9lYWdlci5nZXQocGF0aCk7CiAgICAgICAgICAgICAgICBpZiAo\naW5mbyA9PSBudWxsKSB7CiAgICAgICAgICAgICAgICAgICAgaW5mbyA9IG5l\ndyBGZXRjaEluZm8oY2FuZGlkYXRlKTsKICAgICAgICAgICAgICAgICAgICBf\nZWFnZXIucHV0KG5ldyBBcnJheUxpc3QocGF0aCksIGluZm8pOwogICAgICAg\nICAgICAgICAgfQogICAgICAgICAgICAgICAgaW5mby5leGNsdWRlcy5jbGVh\ncihmbS5nZXRJbmRleCgpKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAg\nIH0KCiAgICAvKioKICAgICAqIEZldGNoIGluZm9ybWF0aW9uLgogICAgICov\nCiAgICBwcml2YXRlIHN0YXRpYyBjbGFzcyBGZXRjaEluZm8gewoKICAgICAg\nICAvKioKICAgICAgICAgKiBJbmRleGVzIG9mIGZpZWxkcyB0byBleGNsdWRl\nIGZyb20gbG9hZGluZy4KICAgICAgICAgKi8KICAgICAgICBwdWJsaWMgZmlu\nYWwgQml0U2V0IGV4Y2x1ZGVzOwoKICAgICAgICAvKioKICAgICAgICAgKiBJ\nbmRleGVzIG9mIGVhZ2VyIGZpZWxkcy4KICAgICAgICAgKi8KICAgICAgICBw\ndWJsaWMgZmluYWwgQml0U2V0IGVhZ2VyOwoKICAgICAgICBwdWJsaWMgRmV0\nY2hJbmZvKENsYXNzTWFwcGluZyB0eXBlKSB7CiAgICAgICAgICAgIEZpZWxk\nTWFwcGluZ1tdIGZtcyA9IHR5cGUuZ2V0RmllbGRNYXBwaW5ncygpOwogICAg\nICAgICAgICBlYWdlciA9IG5ldyBCaXRTZXQoZm1zLmxlbmd0aCk7CiAgICAg\nICAgICAgIGV4Y2x1ZGVzID0gbmV3IEJpdFNldChmbXMubGVuZ3RoKTsKICAg\nICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBmbXMubGVuZ3RoOyBpKysp\nCiAgICAgICAgICAgICAgICBpZiAoIWZtc1tpXS5pc1ByaW1hcnlLZXkoKSkK\nICAgICAgICAgICAgICAgICAgICBleGNsdWRlcy5zZXQoaSk7CiAgICAgICAg\nfQogICAgfQoKICAgIC8qKgogICAgICogTWFwcGluZyBvZiBjb2x1bW5zIHRv\nIHJlc3VsdCBpZHMuCiAgICAgKi8KICAgIHByaXZhdGUgc3RhdGljIGludGVy\nZmFjZSBDb2x1bW5NYXAgewoKICAgICAgICAvKioKICAgICAgICAgKiBSZXR1\ncm4gdGhlIHJlc3VsdCBpZCBmb3IgdGhlIGdpdmVuIGNvbHVtbiwgb3IgdGhl\nIGdpdmVuIGNvbHVtCiAgICAgICAgICogaWYgbm9uZS4KICAgICAgICAgKi8K\nICAgICAgICBwdWJsaWMgT2JqZWN0IG1hcChDb2x1bW4gY29sKTsKICAgIH0K\nCiAgICAvKioKICAgICAqIHtAbGluayBDb2x1bW5NYXB9IHNwZWNpYWxpemVk\nIGZvciBhIHNpbmdsZSBjb2x1bW4uCiAgICAgKi8KICAgIHByaXZhdGUgc3Rh\ndGljIGNsYXNzIFNpbmdsZUNvbHVtbk1hcAogICAgICAgIGltcGxlbWVudHMg\nQ29sdW1uTWFwIHsKCiAgICAgICAgcHJpdmF0ZSBmaW5hbCBPYmplY3QgX2lk\nOwoKICAgICAgICBwdWJsaWMgU2luZ2xlQ29sdW1uTWFwKE9iamVjdCBpZCkg\newogICAgICAgICAgICBfaWQgPSBpZDsKICAgICAgICB9CgogICAgICAgIHB1\nYmxpYyBPYmplY3QgbWFwKENvbHVtbiBjb2wpIHsKICAgICAgICAgICAgcmV0\ndXJuIF9pZDsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBTdHJpbmcgdG9T\ndHJpbmcoKSB7CiAgICAgICAgICAgIHJldHVybiBfaWQudG9TdHJpbmcoKTsK\nICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiB7QGxpbmsgQ29sdW1u\nTWFwfSBzcGVjaWFsaXplZCBmb3IgYSBtdWx0aXBsZSBjb2x1bW5zLgogICAg\nICogTWFwcyBjb2x1bW5zIGluIGxpbmVhciB0aW1lLgogICAgICovCiAgICBw\ncml2YXRlIHN0YXRpYyBjbGFzcyBNdWx0aUNvbHVtbk1hcAogICAgICAgIGlt\ncGxlbWVudHMgQ29sdW1uTWFwIHsKCiAgICAgICAgcHJpdmF0ZSBmaW5hbCBM\naXN0IF9jb2xzOwogICAgICAgIHByaXZhdGUgZmluYWwgT2JqZWN0W10gX2lk\nczsKCiAgICAgICAgcHVibGljIE11bHRpQ29sdW1uTWFwKENvbHVtbltdIGNv\nbHMpIHsKICAgICAgICAgICAgX2NvbHMgPSBBcnJheXMuYXNMaXN0KGNvbHMp\nOwogICAgICAgICAgICBfaWRzID0gbmV3IE9iamVjdFtjb2xzLmxlbmd0aF07\nCiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgT2JqZWN0IG1hcChDb2x1bW4g\nY29sKSB7CiAgICAgICAgICAgIGludCBpZHggPSBfY29scy5pbmRleE9mKGNv\nbCk7CiAgICAgICAgICAgIHJldHVybiAoaWR4ID09IC0xKSA/IGNvbCA6IF9p\nZHNbaWR4XTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyB2b2lkIHNldChD\nb2x1bW4gY29sLCBPYmplY3QgaWQpIHsKICAgICAgICAgICAgaW50IGlkeCA9\nIF9jb2xzLmluZGV4T2YoY29sKTsKICAgICAgICAgICAgaWYgKGlkeCAhPSAt\nMSkKICAgICAgICAgICAgICAgIF9pZHNbaWR4XSA9IGlkOwogICAgICAgIH0K\nCiAgICAgICAgcHVibGljIFN0cmluZyB0b1N0cmluZygpIHsKICAgICAgICAg\nICAgcmV0dXJuIF9jb2xzICsgIj0iICsgQXJyYXlzLmFzTGlzdChfaWRzKTsK\nICAgICAgICB9CiAgICB9Cn0K\n","encoding":"base64"}

