{"sha":"d3a088d93a1be84c40f5b88978442a2b1c185ef0","node_id":"MDQ6QmxvYjIwNjM2NDpkM2EwODhkOTNhMWJlODRjNDBmNWI4ODk3ODQ0MmEyYjFjMTg1ZWYw","size":27958,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/d3a088d93a1be84c40f5b88978442a2b1c185ef0","content":"LyoNCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUNCiAqIG9yIG1vcmUgY29udHJpYnV0b3Ig\nbGljZW5zZSBhZ3JlZW1lbnRzLiAgU2VlIHRoZSBOT1RJQ0UgZmlsZQ0KICog\nZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5m\nb3JtYXRpb24NCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAg\nVGhlIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUNCiAqIHRvIHlvdSB1bmRlciB0\naGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUNCiAqICJMaWNl\nbnNlIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNv\nbXBsaWFuY2UNCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFp\nbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQNCiAqDQogKiBodHRwOi8vd3d3\nLmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjANCiAqDQogKiBVbmxl\nc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGlu\nIHdyaXRpbmcsDQogKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUg\nTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbg0KICogIkFTIElTIiBCQVNJ\nUywgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZDQog\nKiBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBM\naWNlbnNlIGZvciB0aGUNCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmlu\nZyBwZXJtaXNzaW9ucyBhbmQgbGltaXRhdGlvbnMNCiAqIHVuZGVyIHRoZSBM\naWNlbnNlLiAgICANCiAqLw0KcGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEu\namRiYy5zcWw7DQoNCmltcG9ydCBqYXZhLmxhbmcucmVmbGVjdC5NZXRob2Q7\nDQppbXBvcnQgamF2YS5zcWwuQ29ubmVjdGlvbjsNCmltcG9ydCBqYXZhLnNx\nbC5EYXRhYmFzZU1ldGFEYXRhOw0KaW1wb3J0IGphdmEuc3FsLlNRTEV4Y2Vw\ndGlvbjsNCmltcG9ydCBqYXZhLnNxbC5UeXBlczsNCmltcG9ydCBqYXZhLnV0\naWwuQXJyYXlzOw0KaW1wb3J0IGphdmEudXRpbC5TdHJpbmdUb2tlbml6ZXI7\nDQoNCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5rZXJuZWwuSkRC\nQ0ZldGNoQ29uZmlndXJhdGlvbjsNCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEuamRiYy5rZXJuZWwuZXhwcy5GaWx0ZXJWYWx1ZTsNCmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEuamRiYy5rZXJuZWwuZXhwcy5MaXQ7DQppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMua2VybmVsLmV4cHMuUGFyYW07DQpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMua2VybmVsLmV4cHMuVmFs\nOw0KaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNjaGVtYS5TZXF1\nZW5jZTsNCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLkZpbHRl\ncnM7DQppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51dGlsLkxvY2Fs\naXplcjsNCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YS5KYXZhVHlw\nZXM7DQppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuT3BlbkpQQUV4\nY2VwdGlvbjsNCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5VbnN1\ncHBvcnRlZEV4Y2VwdGlvbjsNCmltcG9ydCBzZXJwLnV0aWwuU3RyaW5nczsN\nCg0KLyoqDQogKiBEaWN0aW9uYXJ5IGZvciBJQk0gREIyIGRhdGFiYXNlLg0K\nICovDQpwdWJsaWMgY2xhc3MgREIyRGljdGlvbmFyeQ0KICAgIGV4dGVuZHMg\nQWJzdHJhY3REQjJEaWN0aW9uYXJ5IHsNCiAgICBwcml2YXRlIHN0YXRpYyBm\naW5hbCBMb2NhbGl6ZXIgX2xvYyA9IExvY2FsaXplci5mb3JQYWNrYWdlDQog\nICAgICAgIChEQjJEaWN0aW9uYXJ5LmNsYXNzKTsNCg0KICAgIHB1YmxpYyBT\ndHJpbmcgb3B0aW1pemVDbGF1c2UgPSAib3B0aW1pemUgZm9yIjsNCiAgICBw\ndWJsaWMgU3RyaW5nIHJvd0NsYXVzZSA9ICJyb3ciOw0KICAgIHByb3RlY3Rl\nZCBpbnQgZGIyU2VydmVyVHlwZSA9IDA7DQogICAgcHJvdGVjdGVkIHN0YXRp\nYyBmaW5hbCBpbnQgZGIySVNlcmllc1Y1UjNPckVhcmxpZXIgPSAxOw0KICAg\nIHByb3RlY3RlZCBzdGF0aWMgZmluYWwgaW50IGRiMlVEQlY4MU9yRWFybGll\nciA9IDI7DQogICAgcHJvdGVjdGVkIHN0YXRpYyBmaW5hbCBpbnQgZGIyWk9T\nVjh4T3JMYXRlciA9IDM7DQogICAgcHJvdGVjdGVkIHN0YXRpYyBmaW5hbCBp\nbnQgZGIyVURCVjgyT3JMYXRlciA9IDQ7DQogICAgcHJvdGVjdGVkIHN0YXRp\nYyBmaW5hbCBpbnQgZGIySVNlcmllc1Y1UjRPckxhdGVyID0gNTsNCglwcml2\nYXRlIHN0YXRpYyBmaW5hbCBTdHJpbmcgZm9yVXBkYXRlT2ZDbGF1c2UgPSAi\nRk9SIFVQREFURSBPRiI7DQogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgU3Ry\naW5nIHdpdGhSU0NsYXVzZSA9ICJXSVRIIFJTIjsNCiAgICBwcml2YXRlIHN0\nYXRpYyBmaW5hbCBTdHJpbmcgd2l0aFJSQ2xhdXNlID0gIldJVEggUlIiOw0K\nICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIFN0cmluZyB1c2VLZWVwVXBkYXRl\nTG9ja0NsYXVzZQ0KICAgICAgICA9ICJVU0UgQU5EIEtFRVAgVVBEQVRFIExP\nQ0tTIjsNCiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBTdHJpbmcgdXNlS2Vl\ncEV4Y2x1c2l2ZUxvY2tDbGF1c2UNCiAgICAgICAgPSAiVVNFIEFORCBLRUVQ\nIEVYQ0xVU0lWRSBMT0NLUyI7DQogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwg\nU3RyaW5nIGZvclJlYWRPbmx5Q2xhdXNlID0gIkZPUiBSRUFEIE9OTFkiOw0K\nICAgIHByb3RlY3RlZCBTdHJpbmcgZGF0YWJhc2VQcm9kdWN0TmFtZSA9IG51\nbGw7DQogICAgcHJvdGVjdGVkIFN0cmluZyBkYXRhYmFzZVByb2R1Y3RWZXJz\naW9uID0gbnVsbDsNCiAgICBwcm90ZWN0ZWQgaW50IG1haiA9IDA7DQogICAg\ncHJvdGVjdGVkIGludCBtaW4gPSAwOw0KDQogICAgcHVibGljIERCMkRpY3Rp\nb25hcnkoKSB7DQogICAgICAgIHBsYXRmb3JtID0gIkRCMiI7DQogICAgICAg\nIHZhbGlkYXRpb25TUUwgPSAiU0VMRUNUIERJU1RJTkNUKENVUlJFTlQgVElN\nRVNUQU1QKSBGUk9NICINCiAgICAgICAgICAgICsgIlNZU0lCTS5TWVNUQUJM\nRVMiOw0KICAgICAgICBzdXBwb3J0c1NlbGVjdEVuZEluZGV4ID0gdHJ1ZTsN\nCg0KICAgICAgICBuZXh0U2VxdWVuY2VRdWVyeSA9ICJWQUxVRVMgTkVYVFZB\nTCBGT1IgezB9IjsNCg0KICAgICAgICBzZXF1ZW5jZVNRTCA9ICJTRUxFQ1Qg\nU0VRU0NIRU1BIEFTIFNFUVVFTkNFX1NDSEVNQSwgIg0KICAgICAgICAgICAg\nKyAiU0VRTkFNRSBBUyBTRVFVRU5DRV9OQU1FIEZST00gU1lTQ0FULlNFUVVF\nTkNFUyI7DQogICAgICAgIHNlcXVlbmNlU2NoZW1hU1FMID0gIlNFUVNDSEVN\nQSA9ID8iOw0KICAgICAgICBzZXF1ZW5jZU5hbWVTUUwgPSAiU0VRTkFNRSA9\nID8iOw0KICAgICAgICBjaGFyYWN0ZXJDb2x1bW5TaXplID0gMjU0Ow0KDQog\nICAgICAgIGJpbmFyeVR5cGVOYW1lID0gIkJMT0IoMU0pIjsNCiAgICAgICAg\nbG9uZ1ZhcmJpbmFyeVR5cGVOYW1lID0gIkJMT0IoMU0pIjsNCiAgICAgICAg\ndmFyYmluYXJ5VHlwZU5hbWUgPSAiQkxPQigxTSkiOw0KICAgICAgICBjbG9i\nVHlwZU5hbWUgPSAiQ0xPQigxTSkiOw0KICAgICAgICBsb25nVmFyY2hhclR5\ncGVOYW1lID0gIkxPTkcgVkFSQ0hBUiI7DQogICAgICAgIGRhdGVQcmVjaXNp\nb24gPSBNSUNSTzsNCiAgICAgICAgc3RvcmVDaGFyc0FzTnVtYmVycyA9IGZh\nbHNlOw0KDQogICAgICAgIGZpeGVkU2l6ZVR5cGVOYW1lU2V0LmFkZEFsbChB\ncnJheXMuYXNMaXN0KG5ldyBTdHJpbmdbXXsNCiAgICAgICAgICAgICJMT05H\nIFZBUkNIQVIgRk9SIEJJVCBEQVRBIiwgIkxPTkcgVkFSQ0hBUiIsICJMT05H\nIFZBUkdSQVBISUMiLA0KICAgICAgICB9KSk7DQogICAgICAgIHN5c3RlbVNj\naGVtYXMgPSBuZXcgU3RyaW5nKA0KICAgICAgICAgICAgICAgICJTWVNDQVQs\nIFNZU0lCTSwgU1lTU1RBVCwgU1lTSUJNQURNLCBTWVNUT09MUyIpOw0KICAg\nICAgICBtYXhDb25zdHJhaW50TmFtZUxlbmd0aCA9IDE4Ow0KICAgICAgICBt\nYXhJbmRleE5hbWVMZW5ndGggPSAxODsNCiAgICAgICAgbWF4Q29sdW1uTmFt\nZUxlbmd0aCA9IDMwOw0KICAgICAgICBzdXBwb3J0c0RlZmVycmVkQ29uc3Ry\nYWludHMgPSBmYWxzZTsNCiAgICAgICAgc3VwcG9ydHNEZWZhdWx0RGVsZXRl\nQWN0aW9uID0gZmFsc2U7DQogICAgICAgIHN1cHBvcnRzQWx0ZXJUYWJsZVdp\ndGhEcm9wQ29sdW1uID0gZmFsc2U7DQoNCiAgICAgICAgc3VwcG9ydHNOdWxs\nVGFibGVGb3JHZXRDb2x1bW5zID0gZmFsc2U7DQogICAgICAgIHJlcXVpcmVz\nQ2FzdEZvck1hdGhGdW5jdGlvbnMgPSB0cnVlOw0KICAgICAgICByZXF1aXJl\nc0Nhc3RGb3JDb21wYXJpc29ucyA9IHRydWU7DQoNCiAgICAgICAgcmVzZXJ2\nZWRXb3JkU2V0LmFkZEFsbChBcnJheXMuYXNMaXN0KG5ldyBTdHJpbmdbXXsN\nCiAgICAgICAgICAgICJBRlRFUiIsICJBTElBUyIsICJBTExPVyIsICJBUFBM\nSUNBVElPTiIsICJBU1NPQ0lBVEUiLCAiQVNVVElNRSIsDQogICAgICAgICAg\nICAiQVVESVQiLCAiQVVYIiwgIkFVWElMSUFSWSIsICJCRUZPUkUiLCAiQklO\nQVJZIiwgIkJVRkZFUlBPT0wiLA0KICAgICAgICAgICAgIkNBQ0hFIiwgIkNB\nTEwiLCAiQ0FMTEVEIiwgIkNBUFRVUkUiLCAiQ0FSRElOQUxJVFkiLCAiQ0NT\nSUQiLA0KICAgICAgICAgICAgIkNMVVNURVIiLCAiQ09MTEVDVElPTiIsICJD\nT0xMSUQiLCAiQ09NTUVOVCIsICJDT05DQVQiLA0KICAgICAgICAgICAgIkNP\nTkRJVElPTiIsICJDT05UQUlOUyIsICJDT1VOVF9CSUciLCAiQ1VSUkVOVF9M\nQ19DVFlQRSIsDQogICAgICAgICAgICAiQ1VSUkVOVF9QQVRIIiwgIkNVUlJF\nTlRfU0VSVkVSIiwgIkNVUlJFTlRfVElNRVpPTkUiLCAiQ1lDTEUiLA0KICAg\nICAgICAgICAgIkRBVEEiLCAiREFUQUJBU0UiLCAiREFZUyIsICJEQjJHRU5F\nUkFMIiwgIkRCMkdFTlJMIiwgIkRCMlNRTCIsDQogICAgICAgICAgICAiREJJ\nTkZPIiwgIkRFRkFVTFRTIiwgIkRFRklOSVRJT04iLCAiREVURVJNSU5JU1RJ\nQyIsICJESVNBTExPVyIsDQogICAgICAgICAgICAiRE8iLCAiRFNOSEFUVFIi\nLCAiRFNTSVpFIiwgIkRZTkFNSUMiLCAiRUFDSCIsICJFRElUUFJPQyIsICJF\nTFNFSUYiLA0KICAgICAgICAgICAgIkVOQ09ESU5HIiwgIkVORC1FWEVDMSIs\nICJFUkFTRSIsICJFWENMVURJTkciLCAiRVhJVCIsICJGRU5DRUQiLA0KICAg\nICAgICAgICAgIkZJRUxEUFJPQyIsICJGSUxFIiwgIkZJTkFMIiwgIkZSRUUi\nLCAiRlVOQ1RJT04iLCAiR0VORVJBTCIsDQogICAgICAgICAgICAiR0VORVJB\nVEVEIiwgIkdSQVBISUMiLCAiSEFORExFUiIsICJIT0xEIiwgIkhPVVJTIiwg\nIklGIiwNCiAgICAgICAgICAgICJJTkNMVURJTkciLCAiSU5DUkVNRU5UIiwg\nIklOREVYIiwgIklOSEVSSVQiLCAiSU5PVVQiLCAiSU5URUdSSVRZIiwNCiAg\nICAgICAgICAgICJJU09CSUQiLCAiSVRFUkFURSIsICJKQVIiLCAiSkFWQSIs\nICJMQUJFTCIsICJMQ19DVFlQRSIsICJMRUFWRSIsDQogICAgICAgICAgICAi\nTElOS1RZUEUiLCAiTE9DQUxFIiwgIkxPQ0FUT1IiLCAiTE9DQVRPUlMiLCAi\nTE9DSyIsICJMT0NLTUFYIiwNCiAgICAgICAgICAgICJMT0NLU0laRSIsICJM\nT05HIiwgIkxPT1AiLCAiTUFYVkFMVUUiLCAiTUlDUk9TRUNPTkQiLA0KICAg\nICAgICAgICAgIk1JQ1JPU0VDT05EUyIsICJNSU5VVEVTIiwgIk1JTlZBTFVF\nIiwgIk1PREUiLCAiTU9ESUZJRVMiLCAiTU9OVEhTIiwNCiAgICAgICAgICAg\nICJORVciLCAiTkVXX1RBQkxFIiwgIk5PQ0FDSEUiLCAiTk9DWUNMRSIsICJO\nT0RFTkFNRSIsICJOT0RFTlVNQkVSIiwNCiAgICAgICAgICAgICJOT01BWFZB\nTFVFIiwgIk5PTUlOVkFMVUUiLCAiTk9PUkRFUiIsICJOVUxMUyIsICJOVU1Q\nQVJUUyIsICJPQklEIiwNCiAgICAgICAgICAgICJPTEQiLCAiT0xEX1RBQkxF\nIiwgIk9QVElNSVpBVElPTiIsICJPUFRJTUlaRSIsICJPVVQiLCAiT1ZFUlJJ\nRElORyIsDQogICAgICAgICAgICAiUEFDS0FHRSIsICJQQVJBTUVURVIiLCAi\nUEFSVCIsICJQQVJUSVRJT04iLCAiUEFUSCIsICJQSUVDRVNJWkUiLA0KICAg\nICAgICAgICAgIlBMQU4iLCAiUFJJUVRZIiwgIlBST0dSQU0iLCAiUFNJRCIs\nICJRVUVSWU5PIiwgIlJFQURTIiwgIlJFQ09WRVJZIiwNCiAgICAgICAgICAg\nICJSRUZFUkVOQ0lORyIsICJSRUxFQVNFIiwgIlJFTkFNRSIsICJSRVBFQVQi\nLCAiUkVTRVQiLCAiUkVTSUdOQUwiLA0KICAgICAgICAgICAgIlJFU1RBUlQi\nLCAiUkVTVUxUIiwgIlJFU1VMVF9TRVRfTE9DQVRPUiIsICJSRVRVUk4iLCAi\nUkVUVVJOUyIsDQogICAgICAgICAgICAiUk9VVElORSIsICJST1ciLCAiUlJO\nIiwgIlJVTiIsICJTQVZFUE9JTlQiLCAiU0NSQVRDSFBBRCIsDQogICAgICAg\nICAgICAiU0VDT05EUyIsICJTRUNRVFkiLCAiU0VDVVJJVFkiLCAiU0VOU0lU\nSVZFIiwgIlNJR05BTCIsICJTSU1QTEUiLA0KICAgICAgICAgICAgIlNPVVJD\nRSIsICJTUEVDSUZJQyIsICJTUUxJRCIsICJTVEFOREFSRCIsICJTVEFSVCIs\nICJTVEFUSUMiLA0KICAgICAgICAgICAgIlNUQVkiLCAiU1RPR1JPVVAiLCAi\nU1RPUkVTIiwgIlNUWUxFIiwgIlNVQlBBR0VTIiwgIlNZTk9OWU0iLA0KICAg\nICAgICAgICAgIlNZU0ZVTiIsICJTWVNJQk0iLCAiU1lTUFJPQyIsICJTWVNU\nRU0iLCAiVEFCTEVTUEFDRSIsICJUUklHR0VSIiwNCiAgICAgICAgICAgICJU\nWVBFIiwgIlVORE8iLCAiVU5USUwiLCAiVkFMSURQUk9DIiwgIlZBUklBQkxF\nIiwgIlZBUklBTlQiLCAiVkNBVCIsDQogICAgICAgICAgICAiVk9MVU1FUyIs\nICJXSElMRSIsICJXTE0iLCAiWUVBUlMiLA0KICAgICAgICB9KSk7DQogICAg\nfQ0KDQogICAgcHVibGljIGJvb2xlYW4gc3VwcG9ydHNSYW5kb21BY2Nlc3NS\nZXN1bHRTZXQoU2VsZWN0IHNlbCwNCiAgICAgICAgYm9vbGVhbiBmb3JVcGRh\ndGUpIHsNCiAgICAgICAgcmV0dXJuICFmb3JVcGRhdGUNCiAgICAgICAgICAg\nICYmIHN1cGVyLnN1cHBvcnRzUmFuZG9tQWNjZXNzUmVzdWx0U2V0KHNlbCwg\nZm9yVXBkYXRlKTsNCiAgICB9DQoNCiAgICBwcm90ZWN0ZWQgdm9pZCBhcHBl\nbmRTZWxlY3RSYW5nZShTUUxCdWZmZXIgYnVmLCBsb25nIHN0YXJ0LCBsb25n\nIGVuZCkgew0KICAgICAgICAvLyBhcHBlbmRzIHRoZSBsaXRlcmFsIHJhbmdl\nIHN0cmluZywgc2luY2UgREIyIGlzIHVuYWJsZSB0byBoYW5kbGUNCiAgICAg\nICAgLy8gYSBib3VuZCBwYXJhbWV0ZXIgZm9yIGl0DQogICAgICAgIGJ1Zi5h\ncHBlbmQoIiBGRVRDSCBGSVJTVCAiKS5hcHBlbmQoTG9uZy50b1N0cmluZyhl\nbmQpKS4NCiAgICAgICAgICAgIGFwcGVuZCgiIFJPV1MgT05MWSIpOw0KICAg\nIH0NCg0KICAgIHB1YmxpYyBTdHJpbmdbXSBnZXRDcmVhdGVTZXF1ZW5jZVNR\nTChTZXF1ZW5jZSBzZXEpIHsNCiAgICAgICAgU3RyaW5nW10gc3FsID0gc3Vw\nZXIuZ2V0Q3JlYXRlU2VxdWVuY2VTUUwoc2VxKTsNCiAgICAgICAgaWYgKHNl\ncS5nZXRBbGxvY2F0ZSgpID4gMSkNCiAgICAgICAgICAgIHNxbFswXSArPSAi\nIENBQ0hFICIgKyBzZXEuZ2V0QWxsb2NhdGUoKTsNCiAgICAgICAgcmV0dXJu\nIHNxbDsNCiAgICB9DQoNCiAgICBwcm90ZWN0ZWQgU3RyaW5nIGdldFNlcXVl\nbmNlc1NRTChTdHJpbmcgc2NoZW1hTmFtZSwgU3RyaW5nIHNlcXVlbmNlTmFt\nZSkgew0KICAgICAgICBTdHJpbmdCdWZmZXIgYnVmID0gbmV3IFN0cmluZ0J1\nZmZlcigpOw0KICAgICAgICBidWYuYXBwZW5kKHNlcXVlbmNlU1FMKTsNCiAg\nICAgICAgaWYgKHNjaGVtYU5hbWUgIT0gbnVsbCB8fCBzZXF1ZW5jZU5hbWUg\nIT0gbnVsbCkNCiAgICAgICAgICAgIGJ1Zi5hcHBlbmQoIiBXSEVSRSAiKTsN\nCiAgICAgICAgaWYgKHNjaGVtYU5hbWUgIT0gbnVsbCkgew0KICAgICAgICAg\nICAgYnVmLmFwcGVuZChzZXF1ZW5jZVNjaGVtYVNRTCk7DQogICAgICAgICAg\nICBpZiAoc2VxdWVuY2VOYW1lICE9IG51bGwpDQogICAgICAgICAgICAgICAg\nYnVmLmFwcGVuZCgiIEFORCAiKTsNCiAgICAgICAgfQ0KICAgICAgICBpZiAo\nc2VxdWVuY2VOYW1lICE9IG51bGwpDQogICAgICAgICAgICBidWYuYXBwZW5k\nKHNlcXVlbmNlTmFtZVNRTCk7DQogICAgICAgIHJldHVybiBidWYudG9TdHJp\nbmcoKTsNCiAgICB9DQoNCiAgICBwdWJsaWMgQ29ubmVjdGlvbiBkZWNvcmF0\nZShDb25uZWN0aW9uIGNvbm4pDQogICAgICAgIHRocm93cyBTUUxFeGNlcHRp\nb24gew0KICAgICAgICAvLyBzb21lIHZlcnNpb25zIG9mIHRoZSBEQjIgZHJp\ndmVyIHNlZW0gdG8gZGVmYXVsdCB0bw0KICAgICAgICAvLyBSRUFEX1VOQ09N\nTUlUVEVELCB3aGljaCB3aWxsIHByZXZlbnQgbG9ja2luZyBmcm9tIHdvcmtp\nbmcNCiAgICAgICAgLy8gKG11bHRpcGxlIFNFTEVDVCAuLi4gRk9SIFVQREFU\nRSBzdGF0ZW1lbnRzIGFyZSBhbGxvd2VkIG9uDQogICAgICAgIC8vIHRoZSBz\nYW1lIGluc3RhbmNlKTsgaWYgd2UgaGF2ZSBub3Qgb3ZlcnJpZGRlbiB0aGUN\nCiAgICAgICAgLy8gdHJhbnNhY3Rpb24gaXNvbGF0aW9uIGluIHRoZSBjb25m\naWd1cmF0aW9uLCBkZWZhdWx0IHRvDQogICAgICAgIC8vIFRSQU5TQUNUSU9O\nX1JFQURfQ09NTUlUVEVEDQogICAgICAgIGNvbm4gPSBzdXBlci5kZWNvcmF0\nZShjb25uKTsNCg0KICAgICAgICBpZiAoY29uZi5nZXRUcmFuc2FjdGlvbklz\nb2xhdGlvbkNvbnN0YW50KCkgPT0gLTENCiAgICAgICAgICAgICYmIGNvbm4u\nZ2V0VHJhbnNhY3Rpb25Jc29sYXRpb24oKSA8IGNvbm4uVFJBTlNBQ1RJT05f\nUkVBRF9DT01NSVRURUQpDQogICAgICAgICAgICBjb25uLnNldFRyYW5zYWN0\naW9uSXNvbGF0aW9uKGNvbm4uVFJBTlNBQ1RJT05fUkVBRF9DT01NSVRURUQp\nOw0KDQogICAgICAgIHJldHVybiBjb25uOw0KICAgIH0NCg0KICAgIHByaXZh\ndGUgYm9vbGVhbiBpc0pEQkMzKERhdGFiYXNlTWV0YURhdGEgbWV0YSkgew0K\nICAgICAgICB0cnkgew0KICAgICAgICAgICAgLy8gSkRCQzMtb25seSBtZXRo\nb2QsIHNvIGl0IG1pZ2h0IHRocm93IGEgQWJzdHJhY3RNZXRob2RFcnJvcg0K\nICAgICAgICAgICAgcmV0dXJuIG1ldGEuZ2V0SkRCQ01ham9yVmVyc2lvbigp\nID49IDM7DQogICAgICAgIH0gY2F0Y2ggKFRocm93YWJsZSB0KSB7DQogICAg\nICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgIH0NCiAgICB9DQoNCiAg\nICBwdWJsaWMgdm9pZCBjb25uZWN0ZWRDb25maWd1cmF0aW9uKENvbm5lY3Rp\nb24gY29ubikgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7DQogICAgCXN1cGVyLmNv\nbm5lY3RlZENvbmZpZ3VyYXRpb24oY29ubik7DQoNCiAgICAJRGF0YWJhc2VN\nZXRhRGF0YSBtZXRhRGF0YSA9IGNvbm4uZ2V0TWV0YURhdGEoKTsNCiAgICAg\nICAgZGF0YWJhc2VQcm9kdWN0TmFtZSA9IG1ldGFEYXRhLmdldERhdGFiYXNl\nUHJvZHVjdE5hbWUoKTsNCiAgICAgICAgZGF0YWJhc2VQcm9kdWN0VmVyc2lv\nbiA9IG1ldGFEYXRhLmdldERhdGFiYXNlUHJvZHVjdFZlcnNpb24oKTsNCiAg\nICAgICAgDQogICAgICAgIC8vIERldGVybWluZSB0aGUgdHlwZSBvZiBEQjIg\nZGF0YWJhc2UNCiAgICAgICAgLy8gRmlyc3QgY2hlY2sgZm9yIEFTLzQwMA0K\nICAgICAgICBnZXRQcm9kdWN0VmVyc2lvbk1ham9yTWlub3JGb3JJU2VyaWVz\nKCk7DQoNCiAgICAgICAgaWYgKG1haiA+IDApIHsNCiAgICAgICAgICAgIGlm\nIChpc0RCMklTZXJpZXNWNVIzT3JFYXJsaWVyKCkpDQogICAgICAgICAgICAg\nICAgZGIyU2VydmVyVHlwZSA9IGRiMklTZXJpZXNWNVIzT3JFYXJsaWVyOw0K\nICAgICAgICAgICAgZWxzZSBpZiAoaXNEQjJJU2VyaWVzVjVSNE9yTGF0ZXIo\nKSkNCiAgICAgICAgICAgICAgICBkYjJTZXJ2ZXJUeXBlID0gZGIySVNlcmll\nc1Y1UjRPckxhdGVyOw0KICAgICAgICB9DQogICAgICAgIA0KICAgIAlpZiAo\nZGIyU2VydmVyVHlwZSA9PSAwKSB7DQogICAgCSAgICBpZiAoaXNKREJDMyht\nZXRhRGF0YSkpIHsNCiAgICAJICAgICAgICBtYWogPSBtZXRhRGF0YS5nZXRE\nYXRhYmFzZU1ham9yVmVyc2lvbigpOw0KICAgIAkgICAgICAgIG1pbiA9IG1l\ndGFEYXRhLmdldERhdGFiYXNlTWlub3JWZXJzaW9uKCk7DQogICAgCSAgICB9\nDQogICAgCSAgICBlbHNlDQogICAgCSAgICAgICAgZ2V0UHJvZHVjdFZlcnNp\nb25NYWpvck1pbm9yKCk7DQoNCiAgICAJICAgIC8vIERldGVybWluZSB0aGUg\ndHlwZSBvZiBEQjIgZGF0YWJhc2UgZm9yIFpPUyAmIFVEQg0KICAgIAkgICAg\naWYgKGlzREIyVURCVjgxT3JFYXJsaWVyKCkpDQogICAgCSAgICAgICAgZGIy\nU2VydmVyVHlwZSA9IGRiMlVEQlY4MU9yRWFybGllcjsNCiAgICAJICAgIGVs\nc2UgaWYgKGlzREIyWk9TVjh4T3JMYXRlcigpKQ0KICAgIAkgICAgICAgIGRi\nMlNlcnZlclR5cGUgPSBkYjJaT1NWOHhPckxhdGVyOw0KICAgIAkgICAgZWxz\nZSBpZiAoaXNEQjJVREJWODJPckxhdGVyKCkpDQogICAgCSAgICAgICAgZGIy\nU2VydmVyVHlwZSA9IGRiMlVEQlY4Mk9yTGF0ZXI7DQogICAgICAgIH0NCg0K\nICAgICAgICAvLyB2ZXJpZnkgdGhhdCBkYXRhYmFlIHByb2R1Y3QgaXMgc3Vw\ncG9ydGVkDQogICAgICAgIGlmIChkYjJTZXJ2ZXJUeXBlID09IDAgfHwgbWFq\nID09IDApDQogICAgICAgICAgICB0aHJvdyBuZXcgVW5zdXBwb3J0ZWRFeGNl\ncHRpb24oX2xvYy5nZXQoImRiLW5vdC1zdXBwb3J0ZWQiLA0KICAgICAgICAg\nICAgICAgIG5ldyBPYmplY3RbXSB7ZGF0YWJhc2VQcm9kdWN0TmFtZSwgZGF0\nYWJhc2VQcm9kdWN0VmVyc2lvbiB9KSk7ICAgICAgICAgICAgICAgICAgICAN\nCg0KICAgIAlpZiAobWFqID49IDkgfHwgKG1haiA9PSA4ICYmIG1pbiA+PSAy\nKSkgew0KICAgIAkgICAgc3VwcG9ydHNMb2NraW5nV2l0aE11bHRpcGxlVGFi\nbGVzID0gdHJ1ZTsNCiAgICAJICAgIHN1cHBvcnRzTG9ja2luZ1dpdGhJbm5l\nckpvaW4gPSB0cnVlOw0KICAgIAkgICAgc3VwcG9ydHNMb2NraW5nV2l0aE91\ndGVySm9pbiA9IHRydWU7DQogICAgCSAgICBmb3JVcGRhdGVDbGF1c2UgPSAi\nV0lUSCBSUiBVU0UgQU5EIEtFRVAgVVBEQVRFIExPQ0tTIjsNCiAgICAJICAg\nIGlmIChtYWogPj05KQ0KICAgIAkgICAgICAgIHN1cHBvcnRzWE1MQ29sdW1u\nID0gdHJ1ZTsNCiAgICAJfQ0KDQogICAgICAgIC8vIHBsYXRmb3JtIHNwZWNp\nZmljIHNldHRpbmdzDQogICAgICAgIHN3aXRjaCAoZGIyU2VydmVyVHlwZSkg\new0KICAgICAgICBjYXNlICBkYjJaT1NWOHhPckxhdGVyOg0KICAgICAgICAg\nICAgLy8gREIyIFovT1MgDQogICAgICAgICAgICBjaGFyYWN0ZXJDb2x1bW5T\naXplID0gMjU1Ow0KICAgICAgICAgICAgbGFzdEdlbmVyYXRlZEtleVF1ZXJ5\nID0gIlNFTEVDVCBJREVOVElUWV9WQUxfTE9DQUwoKSBGUk9NICINCiAgICAg\nICAgICAgICAgICArICJTWVNJQk0uU1lTRFVNTVkxIjsNCiAgICAgICAgICAg\nIG5leHRTZXF1ZW5jZVF1ZXJ5ID0gIlNFTEVDVCBORVhUVkFMIEZPUiB7MH0g\nRlJPTSAiDQogICAgICAgICAgICAgICAgKyAiU1lTSUJNLlNZU0RVTU1ZMSI7\nDQogICAgICAgICAgICBzZXF1ZW5jZVNRTCA9ICJTRUxFQ1QgU0NIRU1BIEFT\nIFNFUVVFTkNFX1NDSEVNQSwgIg0KICAgICAgICAgICAgICAgICsgIk5BTUUg\nQVMgU0VRVUVOQ0VfTkFNRSBGUk9NIFNZU0lCTS5TWVNTRVFVRU5DRVMiOw0K\nICAgICAgICAgICAgc2VxdWVuY2VTY2hlbWFTUUwgPSAiU0NIRU1BID0gPyI7\nDQogICAgICAgICAgICBzZXF1ZW5jZU5hbWVTUUwgPSAiTkFNRSA9ID8iOw0K\nICAgICAgICAgICAgaWYgKG1haiA9PSA4KQ0KICAgICAgICAgICAgICAgIC8v\nIERCMiBaL09TIFZlcnNpb24gODogbm8gYmlnaW50IHN1cHBvcnQsIGhlbmNl\nIG1hcCBKYXZhDQogICAgICAgICAgICAgICAgLy8gbG9uZyB0byBkZWNpbWFs\nDQogICAgICAgICAgICAgICAgYmlnaW50VHlwZU5hbWUgPSAiREVDSU1BTCgz\nMSwwKSI7DQogICAgICAgICAgICBicmVhazsNCiAgICAgICAgY2FzZSBkYjJJ\nU2VyaWVzVjVSM09yRWFybGllcjoNCiAgICAgICAgY2FzZSBkYjJJU2VyaWVz\nVjVSNE9yTGF0ZXI6DQogICAgICAgICAgICB2YWxpZGF0aW9uU1FMID0gIlNF\nTEVDVCBESVNUSU5DVChDVVJSRU5UIFRJTUVTVEFNUCkgRlJPTSAiDQogICAg\nICAgICAgICAgICAgKyAiUVNZUzIuU1lTVEFCTEVTIjsNCiAgICAgICAgICAg\nIHNlcXVlbmNlU1FMID0gIlNFTEVDVCBTRVFVRU5DRV9TQ0hFTUEsICINCiAg\nICAgICAgICAgICAgICArICJTRVFVRU5DRV9OQU1FIEZST00gUVNZUzIuU1lT\nU0VRVUVOQ0VTIjsNCiAgICAgICAgICAgIHNlcXVlbmNlU2NoZW1hU1FMID0g\nIlNFUVVFTkNFX1NDSEVNQSA9ID8iOw0KICAgICAgICAgICAgc2VxdWVuY2VO\nYW1lU1FMID0gIlNFUVVFTkNFX05BTUUgPSA/IjsNCiAgICAgICAgICAgIGJy\nZWFrOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgLyoqDQogICAgICogR2V0\nIHRoZSB1cGRhdGUgY2xhdXNlIGZvciB0aGUgcXVlcnkgYmFzZWQgb24gdGhl\nDQogICAgICogdXBkYXRlQ2xhdXNlIGFuZCBpc29sYXRpb25MZXZlbCBoaW50\ncw0KICAgICAqLw0KICAgIHByb3RlY3RlZCBTdHJpbmcgZ2V0Rm9yVXBkYXRl\nQ2xhdXNlKEpEQkNGZXRjaENvbmZpZ3VyYXRpb24gZmV0Y2gsDQogICAgICAg\nIGJvb2xlYW4gZm9yVXBkYXRlKSB7DQogICAgICAgIGludCBpc29sYXRpb25M\nZXZlbDsNCiAgICAgICAgU3RyaW5nQnVmZmVyIGZvclVwZGF0ZVN0cmluZyA9\nIG5ldyBTdHJpbmdCdWZmZXIoKTsNCiAgICAgICAgdHJ5IHsNCiAgICAgICAg\nICAgIC8vIERldGVybWluZSB0aGUgaXNvbGF0aW9uTGV2ZWw7IHRoZSBmZXRj\naA0KICAgICAgICAgICAgLy8gY29uZmlndXJhdGlvbiBkYXRhIG92ZXJyaWRl\ncyB0aGUgcGVyc2lzdGVuY2UueG1sIHZhbHVlDQogICAgICAgICAgICBpZiAo\nZmV0Y2ggIT0gbnVsbCAmJiBmZXRjaC5nZXRJc29sYXRpb24oKSAhPSAtMSkN\nCiAgICAgICAgICAgICAgICBpc29sYXRpb25MZXZlbCA9IGZldGNoLmdldElz\nb2xhdGlvbigpOw0KICAgICAgICAgICAgZWxzZQ0KICAgICAgICAgICAgICAg\nIGlzb2xhdGlvbkxldmVsID0gY29uZi5nZXRUcmFuc2FjdGlvbklzb2xhdGlv\nbkNvbnN0YW50KCk7DQoNCiAgICAgICAgICAgIGlmIChmb3JVcGRhdGUpIHsN\nCiAgICAgICAgICAgICAgICBzd2l0Y2goZGIyU2VydmVyVHlwZSkgew0KICAg\nICAgICAgICAgICAgIGNhc2UgZGIySVNlcmllc1Y1UjNPckVhcmxpZXI6DQog\nICAgICAgICAgICAgICAgY2FzZSBkYjJVREJWODFPckVhcmxpZXI6DQogICAg\nICAgICAgICAgICAgICAgIGlmIChpc29sYXRpb25MZXZlbCA9PQ0KICAgICAg\nICAgICAgICAgICAgICAgICAgQ29ubmVjdGlvbi5UUkFOU0FDVElPTl9SRUFE\nX1VOQ09NTUlUVEVEKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3JV\ncGRhdGVTdHJpbmcuYXBwZW5kKCIgIikuYXBwZW5kKHdpdGhSU0NsYXVzZSkN\nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKCIgIikuYXBw\nZW5kKGZvclVwZGF0ZU9mQ2xhdXNlKTsNCiAgICAgICAgICAgICAgICAgICAg\nfSBlbHNlDQogICAgICAgICAgICAgICAgICAgICAgICBmb3JVcGRhdGVTdHJp\nbmcuYXBwZW5kKCIgIikuYXBwZW5kKGZvclVwZGF0ZU9mQ2xhdXNlKTsNCiAg\nICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgY2Fz\nZSBkYjJaT1NWOHhPckxhdGVyOg0KICAgICAgICAgICAgICAgIGNhc2UgZGIy\nVURCVjgyT3JMYXRlcjoNCiAgICAgICAgICAgICAgICAgICAgaWYgKGlzb2xh\ndGlvbkxldmVsID09IENvbm5lY3Rpb24uVFJBTlNBQ1RJT05fU0VSSUFMSVpB\nQkxFKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3JVcGRhdGVTdHJp\nbmcuYXBwZW5kKCIgIikuYXBwZW5kKGZvclJlYWRPbmx5Q2xhdXNlKQ0KICAg\nICAgICAgICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoIiAiKS5hcHBlbmQo\nd2l0aFJSQ2xhdXNlKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5h\ncHBlbmQoIiAiKS5hcHBlbmQodXNlS2VlcFVwZGF0ZUxvY2tDbGF1c2UpOyAg\nIA0KICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAg\nICAgICAgICAgICAgZm9yVXBkYXRlU3RyaW5nLmFwcGVuZCgiICIpLmFwcGVu\nZChmb3JSZWFkT25seUNsYXVzZSkNCiAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAuYXBwZW5kKCIgIikuYXBwZW5kKHdpdGhSU0NsYXVzZSkNCiAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKCIgIikuYXBwZW5kKHVz\nZUtlZXBVcGRhdGVMb2NrQ2xhdXNlKTsgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgDQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAg\nICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgY2FzZSBkYjJJU2VyaWVz\nVjVSNE9yTGF0ZXI6DQogICAgICAgICAgICAgICAgICAgIGlmIChpc29sYXRp\nb25MZXZlbCA9PSBDb25uZWN0aW9uLlRSQU5TQUNUSU9OX1NFUklBTElaQUJM\nRSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yVXBkYXRlU3RyaW5n\nLmFwcGVuZCgiICIpLmFwcGVuZChmb3JSZWFkT25seUNsYXVzZSkNCiAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKCIgIikuYXBwZW5kKHdp\ndGhSUkNsYXVzZSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXBw\nZW5kKCIgIikuYXBwZW5kKHVzZUtlZXBFeGNsdXNpdmVMb2NrQ2xhdXNlKTsg\nICAgICAgDQogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAg\nICAgICAgICAgICAgICAgICBmb3JVcGRhdGVTdHJpbmcuYXBwZW5kKCIgIiku\nYXBwZW5kKGZvclJlYWRPbmx5Q2xhdXNlKQ0KICAgICAgICAgICAgICAgICAg\nICAgICAgICAgIC5hcHBlbmQoIiAiKS5hcHBlbmQod2l0aFJTQ2xhdXNlKQ0K\nICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoIiAiKS5hcHBl\nbmQodXNlS2VlcEV4Y2x1c2l2ZUxvY2tDbGF1c2UpOw0KICAgICAgICAgICAg\nICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAg\nICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAg\nICBjYXRjaCAoRXhjZXB0aW9uIGUpIHsNCiAgICAgICAgICAgIGlmIChsb2cu\naXNUcmFjZUVuYWJsZWQoKSkNCiAgICAgICAgICAgICAgICBsb2cuZXJyb3Io\nZS50b1N0cmluZygpLGUpOw0KICAgICAgICB9DQogICAgICAgIHJldHVybiBm\nb3JVcGRhdGVTdHJpbmcudG9TdHJpbmcoKTsNCiAgICB9DQoNCiAgICBwdWJs\naWMgYm9vbGVhbiBpc0RCMlVEQlY4Mk9yTGF0ZXIoKSB0aHJvd3MgU1FMRXhj\nZXB0aW9uIHsNCiAgICAgICAgYm9vbGVhbiBtYXRjaCA9IGZhbHNlOw0KICAg\nICAgICBpZiAoKGRhdGFiYXNlUHJvZHVjdFZlcnNpb24uaW5kZXhPZigiU1FM\nIikgIT0gLTENCiAgICAgICAgICAgIHx8IGRhdGFiYXNlUHJvZHVjdE5hbWUu\naW5kZXhPZigiREIyLyIpICE9IC0xKQ0KICAgICAgICAgICAgJiYgKChtYWog\nPT0gOCAmJiBtaW4gPj0gMikgfHwgKG1haiA+PSA5KSkpDQogICAgICAgICAg\nICBtYXRjaCA9IHRydWU7DQogICAgICAgIHJldHVybiBtYXRjaDsNCiAgICB9\nDQoNCiAgICBwdWJsaWMgYm9vbGVhbiBpc0RCMlpPU1Y4eE9yTGF0ZXIoKQ0K\nICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gew0KICAgICAgIGJvb2xlYW4g\nbWF0Y2ggPSBmYWxzZTsNCiAgICAgICBpZiAoKGRhdGFiYXNlUHJvZHVjdFZl\ncnNpb24uaW5kZXhPZigiRFNOIikgIT0gLTENCiAgICAgICAgICAgfHwgZGF0\nYWJhc2VQcm9kdWN0TmFtZS5pbmRleE9mKCJEQjIvIikgPT0gLTEpDQogICAg\nICAgICAgICYmIG1haiA+PSA4KQ0KICAgICAgICAgICBtYXRjaCA9IHRydWU7\nDQogICAgICAgIHJldHVybiBtYXRjaDsNCiAgICB9DQoNCiAgICBwdWJsaWMg\nYm9vbGVhbiBpc0RCMklTZXJpZXNWNVIzT3JFYXJsaWVyKCkNCiAgICAgICB0\naHJvd3MgU1FMRXhjZXB0aW9uIHsNCiAgICAgICBib29sZWFuIG1hdGNoID0g\nZmFsc2U7DQogICAgICAgaWYgKGRhdGFiYXNlUHJvZHVjdE5hbWUuaW5kZXhP\nZigiQVMiKSAhPSAtMQ0KICAgICAgICAgICAmJiAoKG1haiA9PSA1ICYmIG1p\nbiA8PTMpIHx8IG1haiA8IDUpKQ0KICAgICAgICAgICBtYXRjaCA9IHRydWU7\nDQogICAgICAgcmV0dXJuIG1hdGNoOw0KICAgIH0NCg0KICAgIHB1YmxpYyBi\nb29sZWFuIGlzREIySVNlcmllc1Y1UjRPckxhdGVyKCkNCiAgICAgICB0aHJv\nd3MgU1FMRXhjZXB0aW9uIHsNCiAgICAgICBib29sZWFuIG1hdGNoID0gZmFs\nc2U7DQogICAgICAgaWYgKGRhdGFiYXNlUHJvZHVjdE5hbWUuaW5kZXhPZigi\nQVMiKSAhPSAtMQ0KICAgICAgICAgICAmJiAobWFqID49NiB8fCAobWFqID09\nIDUgJiYgbWluID49NCkpKQ0KICAgICAgICAgICBtYXRjaCA9IHRydWU7DQog\nICAgICByZXR1cm4gbWF0Y2g7DQogICAgfQ0KDQogICAgcHVibGljIGJvb2xl\nYW4gaXNEQjJVREJWODFPckVhcmxpZXIoKSB0aHJvd3MgU1FMRXhjZXB0aW9u\nIHsNCiAgICAgICAgYm9vbGVhbiBtYXRjaCA9IGZhbHNlOw0KICAgICAgICBp\nZiAoKGRhdGFiYXNlUHJvZHVjdFZlcnNpb24uaW5kZXhPZigiU1FMIikgIT0g\nLTEgDQogICAgICAgICAgIHx8IGRhdGFiYXNlUHJvZHVjdE5hbWUuaW5kZXhP\nZigiREIyLyIpICE9IC0xKSAmJg0KICAgICAgICAgICAoKG1haiA9PSA4ICYm\nIG1pbiA8PSAxKSB8fCBtYWogPCA4KSkNCiAgICAgICAgICAgIG1hdGNoID0g\ndHJ1ZTsNCiAgICAgICAgcmV0dXJuIG1hdGNoOw0KICAgIH0NCg0KICAgIC8q\nKiBHZXQgdGhlIHZlcnNpb24gTWFqb3IvTWlub3IgZm9yIHRoZSBJU2VyaWVz\nDQogICAgICovDQogICAgcHJpdmF0ZSB2b2lkIGdldFByb2R1Y3RWZXJzaW9u\nTWFqb3JNaW5vckZvcklTZXJpZXMoKSB7DQogICAgICAgIC8vIElTZXJpZXMg\nICAgREJQcm9kTmFtZSAgICAgICAgICAgICAgICAgREIyIFVEQiBmb3IgQVMv\nNDAwDQogICAgICAgIC8vICAgKFRvb2xib3gpREJQcm9kVmVyc2lvbiAgICAg\nICAgICAgICAgMDUuMDQuMDAwMCBWNVI0bTANCiAgICAgICAgLy8gSVNlcmll\ncyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBEQjIgVURCIGZvciBB\nUy80MDANCiAgICAgICAgLy8gICAoTmF0aXZlKSAgICAgICAgICAgICAgICAg\nICAgICAgICAgICBWNVI0TTANCiAgICAgICAgaWYgKGRhdGFiYXNlUHJvZHVj\ndE5hbWUuaW5kZXhPZigiQVMiKSAhPSAtMSkgew0KICAgICAgICAgICAgU3Ry\naW5nIHMgPSBkYXRhYmFzZVByb2R1Y3RWZXJzaW9uLnN1YnN0cmluZyhkYXRh\nYmFzZVByb2R1Y3RWZXJzaW9uDQogICAgICAgICAgICAgICAgLmluZGV4T2Yo\nJ1YnKSk7DQogICAgICAgICAgICBzID0gcy50b1VwcGVyQ2FzZSgpOw0KDQog\nICAgICAgICAgICBTdHJpbmdUb2tlbml6ZXIgc3RyaW5ndG9rZW5pemVyID0g\nbmV3IFN0cmluZ1Rva2VuaXplcihzLCAiVlJNIg0KICAgICAgICAgICAgICAg\nICwgZmFsc2UpOw0KICAgICAgICAgICAgaWYgKHN0cmluZ3Rva2VuaXplci5j\nb3VudFRva2VucygpID09IDMpIHsNCiAgICAgICAgICAgICAgICBTdHJpbmcg\nczEgPSBzdHJpbmd0b2tlbml6ZXIubmV4dFRva2VuKCk7DQogICAgICAgICAg\nICAgICAgbWFqID0gSW50ZWdlci5wYXJzZUludChzMSk7DQogICAgICAgICAg\nICAgICAgU3RyaW5nIHMyID0gIHN0cmluZ3Rva2VuaXplci5uZXh0VG9rZW4o\nKTsNCiAgICAgICAgICAgICAgICBtaW4gPSBJbnRlZ2VyLnBhcnNlSW50KHMy\nKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0NCiAgICANCiAg\nICBwcml2YXRlIHZvaWQgZ2V0UHJvZHVjdFZlcnNpb25NYWpvck1pbm9yKCkg\new0KICAgICAgICAvLyBJbmNhc2UgSkRCQyBkcml2ZXIgdmVyc2lvbiBpcyBs\nb3dlciB0aGFuIDMNCiAgICAgICAgLy8gdXNlIGZvbGxvd2luZyBpbmZvIHRv\nIGRldGVybWluZSBNYWpvciBhbmQgTWlub3IgDQogICAgICAgIC8vICAgICAg\nICAgICAgICAgICAgICAgICAgQ0xJICAgIHZzICAgICAgSkNDDQogICAgICAg\nIC8vIFpEQlY4IERCUHJvZE5hbWUgICAgICAgREIyICAgICAgICAgICAgREIy\nDQogICAgICAgIC8vICAgICAgIERCUHJvZFZlcnNpb24gICAgMDguMDEuMDAw\nNSAgICAgRFNOMDgwMTUNCiAgICAgICAgLy8gWkRCVjkgICAgICAgICAgICAg\nICAgICBEQjIgICAgICAgICAgICBEQjINCiAgICAgICAgLy8gICAgICAgICAg\nICAgICAgICAgICAgICAwOS4wMS4wMDA1ICAgICBEU04wOTAxNQ0KICAgICAg\nICAvLyBXaW5WOSAgICAgICAgICAgICAgICAgIERCMi9OVCAgICAgICAgIERC\nMi9OVA0KICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgIDA5LjAx\nLjAwMDAgICAgIFNRTDA5MDEwDQogICAgICAgIC8vIFNvbGFyaXNWOSAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgREIyL1NVTjY0DQogICAgICAgIC8v\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU1FMMDkw\nMQ0KICAgICAgICAvLyBMaW51eCAgICAgICAgICAgICAgICAgIERCMi9MSU5V\nWCAgICAgIERCMi9MSU5VWA0KICAgICAgICAvLyAgICAgICAgICAgICAgICAg\nICAgICAgIDA5LjAxLjAwMDAgICAgIFNRTDA5MDENCiAgICAgICAgaWYgKGRh\ndGFiYXNlUHJvZHVjdFZlcnNpb24uaW5kZXhPZigiMDkiKSAhPSAtMSkgew0K\nICAgICAgICAgICAgbWFqID0gOTsNCiAgICAgICAgICAgIGlmIChkYXRhYmFz\nZVByb2R1Y3RWZXJzaW9uLmluZGV4T2YoIjAxIikgIT0gLTEpIHsNCiAgICAg\nICAgICAgICAgICBtaW4gPSAxOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9\nIGVsc2UgaWYgKGRhdGFiYXNlUHJvZHVjdFZlcnNpb24uaW5kZXhPZigiMDgi\nKSAhPSAtMSkgew0KICAgICAgICAgICAgbWFqID0gODsNCiAgICAgICAgICAg\nIG1pbiA9IDI7DQogICAgICAgICAgICBpZiAoZGF0YWJhc2VQcm9kdWN0VmVy\nc2lvbi5pbmRleE9mKCIwMSIpICE9IC0xKSB7DQogICAgICAgICAgICAgICAg\nbWluID0gMTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0NCg0K\nICAgIHB1YmxpYyBTUUxCdWZmZXIgdG9TZWxlY3QoU2VsZWN0IHNlbCwgYm9v\nbGVhbiBmb3JVcGRhdGUsDQogICAgICAgIEpEQkNGZXRjaENvbmZpZ3VyYXRp\nb24gZmV0Y2gpIHsNCiAgICAgICAgU1FMQnVmZmVyIGJ1ZiA9IHN1cGVyLnRv\nU2VsZWN0KHNlbCwgZm9yVXBkYXRlLCBmZXRjaCk7DQoNCiAgICAgICAgaWYg\nKHNlbC5nZXRFeHBlY3RlZFJlc3VsdENvdW50KCkgPiAwKSB7DQogICAgICAg\nICAgICBidWYuYXBwZW5kKCIgIikuYXBwZW5kKG9wdGltaXplQ2xhdXNlKS5h\ncHBlbmQoIiAiKQ0KICAgICAgICAgICAgICAgIC5hcHBlbmQoU3RyaW5nLnZh\nbHVlT2Yoc2VsLmdldEV4cGVjdGVkUmVzdWx0Q291bnQoKSkpDQogICAgICAg\nICAgICAgICAgLmFwcGVuZCgiICIpLmFwcGVuZChyb3dDbGF1c2UpOw0KICAg\nICAgICB9DQoNCiAgICAgICAgcmV0dXJuIGJ1ZjsNCiAgICB9DQoNCiAgICBw\ndWJsaWMgT3BlbkpQQUV4Y2VwdGlvbiBuZXdTdG9yZUV4Y2VwdGlvbihTdHJp\nbmcgbXNnLCBTUUxFeGNlcHRpb25bXSBjYXVzZXMsDQogICAgICAgIE9iamVj\ndCBmYWlsZWQpIHsNCiAgICAgICAgaWYgKGNhdXNlcyAhPSBudWxsICYmIGNh\ndXNlcy5sZW5ndGggPiAwKQ0KICAgICAgICAgICAgbXNnID0gYXBwZW5kRXh0\nZW5kZWRFeGNlcHRpb25Nc2cobXNnLCBjYXVzZXNbMF0pOw0KICAgICAgICBy\nZXR1cm4gc3VwZXIubmV3U3RvcmVFeGNlcHRpb24obXNnLCBjYXVzZXMsIGZh\naWxlZCk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICogIEFwcGVuZCBleGNl\ncHRpb24gaW5mb3JtYXRpb24gZnJvbSBTUUxDQSB0byB0aGUgZXhzaXN0aW5n\nDQogICAgICogIGV4Y2VwdGlvbiBtZWFzc2FnZQ0KICAgICAqLw0KICAgIHBy\naXZhdGUgU3RyaW5nIGFwcGVuZEV4dGVuZGVkRXhjZXB0aW9uTXNnKFN0cmlu\nZyBtc2csIFNRTEV4Y2VwdGlvbiBzcWxlKXsNCiAgICAgICBmaW5hbCBTdHJp\nbmcgR0VUU1FMQ0EgPSJnZXRTcWxjYSI7DQogICAgICAgU3RyaW5nIGV4Y2Vw\ndGlvbk1zZyA9IG5ldyBTdHJpbmcoKTsNCiAgICAgICB0cnkgew0KICAgICAg\nICAgICAgTWV0aG9kIHNxbGNhTTIgPSBzcWxlLmdldE5leHRFeGNlcHRpb24o\nKS5nZXRDbGFzcygpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5n\nZXRNZXRob2QoR0VUU1FMQ0EsbnVsbCk7DQogICAgICAgICAgICBPYmplY3Qg\nc3FsY2EgPSBzcWxjYU0yLmludm9rZShzcWxlLmdldE5leHRFeGNlcHRpb24o\nKSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nIG5ldyBPYmplY3RbXSB7fSk7DQogICAgICAgICAgICBNZXRob2QgIGdldFNx\nbEVycnBNZXRoZCA9IHNxbGNhLmdldENsYXNzKCkuDQogICAgICAgICAgICBn\nZXRNZXRob2QoImdldFNxbEVycnAiLCBudWxsKTsNCiAgICAgICAgICAgIE1l\ndGhvZCAgZ2V0U3FsV2Fybk1ldGhkID0gc3FsY2EuZ2V0Q2xhc3MoKS4NCiAg\nICAgICAgICAgIGdldE1ldGhvZCgiZ2V0U3FsV2FybiIsIG51bGwpOw0KICAg\nICAgICAgICAgTWV0aG9kICBnZXRTcWxFcnJkTWV0aGQgPSBzcWxjYS5nZXRD\nbGFzcygpLg0KICAgICAgICAgICAgZ2V0TWV0aG9kKCJnZXRTcWxFcnJkIiwg\nbnVsbCk7DQogICAgICAgICAgICBTdHJpbmdCdWZmZXIgZXJyZFN0ciA9IG5l\ndyBTdHJpbmdCdWZmZXIoKTsNCg0KICAgICAgICAgICAgaW50W10gZXJyZHMg\nPSAoaW50W10pIGdldFNxbEVycmRNZXRoZC5pbnZva2Uoc3FsY2EsIG5ldyBP\nYmplY3RbXXt9KTsNCiAgICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwg\nZXJyZHMubGVuZ3RoOyBpKyspDQogICAgICAgICAgICAgICAgZXJyZFN0ci5h\ncHBlbmQoZXJyZFN0ci5sZW5ndGgoKSA+IDAgPyAiLCAiIDogIiIpLg0KICAg\nICAgICAgICAgICAgICAgICBhcHBlbmQoZXJyZHNbaV0pOw0KICAgICAgICAg\nICAgZXhjZXB0aW9uTXNnID0gZXhjZXB0aW9uTXNnLmNvbmNhdCggIlNRTENB\nIE9VVFBVVCIgKw0KICAgICAgICAgICAgICAgICAgICAiW0VycnA9IiArIGdl\ndFNxbEVycnBNZXRoZC5pbnZva2Uoc3FsY2EsIG5ldyBPYmplY3RbXXt9KQ0K\nICAgICAgICAgICAgICAgICAgICArICIsIEVycmQ9IiArIGVycmRTdHIpOw0K\nDQogICAgICAgICAgICBTdHJpbmcgV2FybiA9IG5ldyBTdHJpbmcoKGNoYXJb\nXSkgZ2V0U3FsV2Fybk1ldGhkLg0KICAgICAgICAgICAgICAgICAgICBpbnZv\na2Uoc3FsY2EsIG5ldyBPYmplY3RbXXt9KSk7DQogICAgICAgICAgICBpZihX\nYXJuLnRyaW0oKS5sZW5ndGgoKSAhPSAwKQ0KICAgICAgICAgICAgICAgIGV4\nY2VwdGlvbk1zZyA9IGV4Y2VwdGlvbk1zZy5jb25jYXQoIiwgV2Fybj0iICtX\nYXJuICsgIl0iICk7DQogICAgICAgICAgICBlbHNlDQogICAgICAgICAgICAg\nICAgZXhjZXB0aW9uTXNnID0gZXhjZXB0aW9uTXNnLmNvbmNhdCggIl0iICk7\nDQogICAgICAgICAgICBtc2cgPSBtc2cuY29uY2F0KGV4Y2VwdGlvbk1zZyk7\nDQogICAgICAgICAgICByZXR1cm4gbXNnOw0KICAgICAgICB9IGNhdGNoIChU\naHJvd2FibGUgdCkgew0KICAgICAgICAgICAgcmV0dXJuIHNxbGUuZ2V0TWVz\nc2FnZSgpOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgcHVibGljIGludCBn\nZXREYjJTZXJ2ZXJUeXBlKCkgew0KICAgICAgICByZXR1cm4gZGIyU2VydmVy\nVHlwZTsNCiAgICB9DQogICAgDQogICAgcHJvdGVjdGVkIHZvaWQgYXBwZW5k\nTGVuZ3RoKFNRTEJ1ZmZlciBidWYsIGludCB0eXBlKSB7DQogICAgICAgIGlm\nICh0eXBlID09IFR5cGVzLlZBUkNIQVIpDQogICAgICAgICAgICBidWYuYXBw\nZW5kKCIoIikuYXBwZW5kKEludGVnZXIudG9TdHJpbmcoY2hhcmFjdGVyQ29s\ndW1uU2l6ZSkpLg0KICAgICAgICAgICAgICAgIGFwcGVuZCgiKSIpOw0KICAg\nIH0NCg0KICAgIC8qKg0KICAgICAqIElmIHRoaXMgZGljdGlvbmFyeSBzdXBw\nb3J0cyBYTUwgdHlwZSwNCiAgICAgKiB1c2UgdGhpcyBtZXRob2QgdG8gYXBw\nZW5kIHhtbCBwcmVkaWNhdGUuDQogICAgICogDQogICAgICogQHBhcmFtIGJ1\nZiB0aGUgU1FMIGJ1ZmZlciB0byB3cml0ZSB0aGUgY29tcGFyaXNvbg0KICAg\nICAqIEBwYXJhbSBvcCB0aGUgY29tcGFyaXNvbiBvcGVyYXRpb24gdG8gcGVy\nZm9ybQ0KICAgICAqIEBwYXJhbSBsaHMgdGhlIGxlZnQgaGFuZCBzaWRlIG9m\nIHRoZSBjb21wYXJpc29uDQogICAgICogQHBhcmFtIHJocyB0aGUgcmlnaHQg\naGFuZCBzaWRlIG9mIHRoZSBjb21wYXJpc29uDQogICAgICogQHBhcmFtIGxo\nc3htbCBpbmRpY2F0ZXMgd2hldGhlciB0aGUgbGVmdCBvcGVyYW5kIG1hcHMg\ndG8geG1sDQogICAgICogQHBhcmFtIHJoc3htbCBpbmRpY2F0ZXMgd2hldGhl\nciB0aGUgcmlnaHQgb3BlcmFuZCBtYXBzIHRvIHhtbA0KICAgICAqLw0KICAg\nIHB1YmxpYyB2b2lkIGFwcGVuZFhtbENvbXBhcmlzb24oU1FMQnVmZmVyIGJ1\nZiwgU3RyaW5nIG9wLCBGaWx0ZXJWYWx1ZSBsaHMsDQogICAgICAgIEZpbHRl\nclZhbHVlIHJocywgYm9vbGVhbiBsaHN4bWwsIGJvb2xlYW4gcmhzeG1sKSB7\nDQogICAgICAgIHN1cGVyLmFwcGVuZFhtbENvbXBhcmlzb24oYnVmLCBvcCwg\nbGhzLCByaHMsIGxoc3htbCwgcmhzeG1sKTsNCiAgICAgICAgaWYgKGxoc3ht\nbCAmJiByaHN4bWwpDQogICAgICAgICAgICBhcHBlbmRYbWxDb21wYXJpc29u\nMihidWYsIG9wLCBsaHMsIHJocyk7DQogICAgICAgIGVsc2UgaWYgKGxoc3ht\nbCkNCiAgICAgICAgICAgIGFwcGVuZFhtbENvbXBhcmlzb24xKGJ1Ziwgb3As\nIGxocywgcmhzKTsNCiAgICAgICAgZWxzZSANCiAgICAgICAgICAgIGFwcGVu\nZFhtbENvbXBhcmlzb24xKGJ1Ziwgb3AsIHJocywgbGhzKTsNCiAgICB9DQoN\nCiAgICAvKioNCiAgICAgKiBBcHBlbmQgYW4geG1sIGNvbXBhcmlzb24gcHJl\nZGljYXRlLg0KICAgICAqDQogICAgICogQHBhcmFtIGJ1ZiB0aGUgU1FMIGJ1\nZmZlciB0byB3cml0ZSB0aGUgY29tcGFyaXNvbg0KICAgICAqIEBwYXJhbSBv\ncCB0aGUgY29tcGFyaXNvbiBvcGVyYXRpb24gdG8gcGVyZm9ybQ0KICAgICAq\nIEBwYXJhbSBsaHMgdGhlIGxlZnQgaGFuZCBzaWRlIG9mIHRoZSBjb21wYXJp\nc29uIChtYXBzIHRvIHhtbCBjb2x1bW4pDQogICAgICogQHBhcmFtIHJocyB0\naGUgcmlnaHQgaGFuZCBzaWRlIG9mIHRoZSBjb21wYXJpc29uDQogICAgICov\nDQogICAgcHJpdmF0ZSB2b2lkIGFwcGVuZFhtbENvbXBhcmlzb24xKFNRTEJ1\nZmZlciBidWYsIFN0cmluZyBvcCwgDQogICAgICAgICAgICBGaWx0ZXJWYWx1\nZSBsaHMsIEZpbHRlclZhbHVlIHJocykgew0KICAgICAgICBib29sZWFuIGNh\nc3RyaHMgPSBmYWxzZTsNCiAgICAgICAgQ2xhc3MgcmMgPSBGaWx0ZXJzLndy\nYXAocmhzLmdldFR5cGUoKSk7DQogICAgICAgIGludCB0eXBlID0gMDsNCiAg\nICAgICAgaWYgKHJocy5pc0NvbnN0YW50KCkpIHsNCiAgICAgICAgICAgIHR5\ncGUgPSBnZXRKREJDVHlwZShKYXZhVHlwZXMuZ2V0VHlwZUNvZGUocmMpLCBm\nYWxzZSk7DQogICAgICAgICAgICBjYXN0cmhzID0gdHJ1ZTsNCiAgICAgICAg\nfQ0KICAgICAgICANCiAgICAgICAgYXBwZW5kWG1sRXhpc3RzKGJ1ZiwgbGhz\nKTsNCg0KICAgICAgICBidWYuYXBwZW5kKCIgIikuYXBwZW5kKG9wKS5hcHBl\nbmQoIiAiKTsNCiAgICAgICAgDQogICAgICAgIGJ1Zi5hcHBlbmQoIiQiKTsN\nCiAgICAgICAgaWYgKGNhc3RyaHMpDQogICAgICAgICAgICBidWYuYXBwZW5k\nKCJQYXJtIik7DQogICAgICAgIGVsc2UNCiAgICAgICAgICAgIHJocy5hcHBl\nbmRUbyhidWYpOw0KICAgICAgICANCiAgICAgICAgYnVmLmFwcGVuZCgiXScg\nUEFTU0lORyAiKTsNCiAgICAgICAgYXBwZW5kWG1sVmFyKGJ1ZiwgbGhzKTsN\nCiAgICAgICAgYnVmLmFwcGVuZCgiLCAiKTsNCiAgICAgICAgDQogICAgICAg\nIGlmIChjYXN0cmhzKQ0KICAgICAgICAgICAgYXBwZW5kQ2FzdChidWYsIHJo\ncywgdHlwZSk7DQogICAgICAgIGVsc2UNCiAgICAgICAgICAgIHJocy5hcHBl\nbmRUbyhidWYpOw0KICAgICAgICANCiAgICAgICAgYnVmLmFwcGVuZCgiIEFT\nIFwiIik7DQogICAgICAgIGlmIChjYXN0cmhzKQ0KICAgICAgICAgICAgYnVm\nLmFwcGVuZCgiUGFybSIpOw0KICAgICAgICBlbHNlDQogICAgICAgICAgICBy\naHMuYXBwZW5kVG8oYnVmKTsNCiAgICAgICAgYnVmLmFwcGVuZCgiXCIpIik7\nDQogICAgfQ0KICAgIA0KICAgIC8qKg0KICAgICAqIEFwcGVuZCBhbiB4bWwg\nY29tcGFyaXNvbiBwcmVkaWNhdGUuIChib3RoIG9wZXJhbmRzIG1hcCB0byB4\nbWwgY29sdW1uKQ0KICAgICAqDQogICAgICogQHBhcmFtIGJ1ZiB0aGUgU1FM\nIGJ1ZmZlciB0byB3cml0ZSB0aGUgY29tcGFyaXNvbg0KICAgICAqIEBwYXJh\nbSBvcCB0aGUgY29tcGFyaXNvbiBvcGVyYXRpb24gdG8gcGVyZm9ybQ0KICAg\nICAqIEBwYXJhbSBsaHMgdGhlIGxlZnQgaGFuZCBzaWRlIG9mIHRoZSBjb21w\nYXJpc29uIChtYXBzIHRvIHhtbCBjb2x1bW4pDQogICAgICogQHBhcmFtIHJo\ncyB0aGUgcmlnaHQgaGFuZCBzaWRlIG9mIHRoZSBjb21wYXJpc29uIChtYXBz\nIHRvIHhtbCBjb2x1bW4pDQogICAgICovDQogICAgcHJpdmF0ZSB2b2lkIGFw\ncGVuZFhtbENvbXBhcmlzb24yKFNRTEJ1ZmZlciBidWYsIFN0cmluZyBvcCwg\nDQogICAgICAgICAgICBGaWx0ZXJWYWx1ZSBsaHMsIEZpbHRlclZhbHVlIHJo\ncykgew0KICAgICAgICBhcHBlbmRYbWxFeGlzdHMoYnVmLCBsaHMpOw0KICAg\nICAgICANCiAgICAgICAgYnVmLmFwcGVuZCgiICIpLmFwcGVuZChvcCkuYXBw\nZW5kKCIgIik7DQogICAgICAgIA0KICAgICAgICBidWYuYXBwZW5kKCIkIiku\nYXBwZW5kKHJocy5nZXRDb2x1bW5BbGlhcygNCiAgICAgICAgICAgIHJocy5n\nZXRGaWVsZE1hcHBpbmcoKS5nZXRDb2x1bW5zKClbMF0pKS4NCiAgICAgICAg\nICAgIGFwcGVuZCgiLyovIik7DQogICAgICAgIHJocy5hcHBlbmRUbyhidWYp\nOw0KICAgICAgICANCiAgICAgICAgYnVmLmFwcGVuZCgiXScgUEFTU0lORyAi\nKTsNCiAgICAgICAgYXBwZW5kWG1sVmFyKGJ1ZiwgbGhzKTsNCiAgICAgICAg\nYnVmLmFwcGVuZCgiLCAiKTsNCiAgICAgICAgYXBwZW5kWG1sVmFyKGJ1Ziwg\ncmhzKTsNCiAgICAgICAgYnVmLmFwcGVuZCgiKSIpOw0KICAgIH0NCiAgICAN\nCiAgICBwcml2YXRlIHZvaWQgYXBwZW5kWG1sVmFyKFNRTEJ1ZmZlciBidWYs\nIEZpbHRlclZhbHVlIHZhbCkgew0KICAgICAgICBidWYuYXBwZW5kKHZhbC5n\nZXRDb2x1bW5BbGlhcygNCiAgICAgICAgICAgIHZhbC5nZXRGaWVsZE1hcHBp\nbmcoKS5nZXRDb2x1bW5zKClbMF0pKS4NCiAgICAgICAgICAgIGFwcGVuZCgi\nIEFTICIpLg0KICAgICAgICAgICAgYXBwZW5kKCJcIiIpLmFwcGVuZCh2YWwu\nZ2V0Q29sdW1uQWxpYXMoDQogICAgICAgICAgICB2YWwuZ2V0RmllbGRNYXBw\naW5nKCkuZ2V0Q29sdW1ucygpWzBdKSkuDQogICAgICAgICAgICBhcHBlbmQo\nIlwiIik7ICAgICAgICANCiAgICB9DQogICAgDQogICAgcHJpdmF0ZSB2b2lk\nIGFwcGVuZFhtbEV4aXN0cyhTUUxCdWZmZXIgYnVmLCBGaWx0ZXJWYWx1ZSB2\nYWwpIHsNCiAgICAgICAgYnVmLmFwcGVuZCgiWE1MRVhJU1RTKCciKTsNCiAg\nICAgICAgYnVmLmFwcGVuZCgiJCIpLmFwcGVuZCh2YWwuZ2V0Q29sdW1uQWxp\nYXMoDQogICAgICAgICAgICB2YWwuZ2V0RmllbGRNYXBwaW5nKCkuZ2V0Q29s\ndW1ucygpWzBdKSkuDQogICAgICAgICAgICBhcHBlbmQoIi8qWyIpOw0KICAg\nICAgICB2YWwuYXBwZW5kVG8oYnVmKTsgICAgICAgIA0KICAgIH0NCiAgICAN\nCiAgICAvKioNCiAgICAgKiBhZGQgQ0FTVCBmb3IgYSBzY2FsYXIgZnVuY3Rp\nb24gd2hlcmUgb3BlcmFuZCBpcyBhIHBhcmFtDQogICAgICogDQogICAgICog\nQHBhcmFtIGZ1bmMgb3JpZ2luYWwgc3RyaW5nDQogICAgICogQHBhcmFtIHRh\ncmdldCBzdWJzdHJpbmcgdG8gbG9vayBmb3INCiAgICAgKiBAcGFyYW0gYXNT\ndHJpbmcgDQogICAgICogQHJldHVybiB1cGRhdGVkIHN0cmluZyAoZnVuYykN\nCiAgICAgKi8NCiAgICBwcml2YXRlIFN0cmluZyBhZGRDYXN0QXNTdHJpbmco\nU3RyaW5nIGZ1bmMsIFN0cmluZyB0YXJnZXQsIA0KICAgICAgICAgICAgU3Ry\naW5nIGFzU3RyaW5nKSB7DQogICAgICAgIFN0cmluZyBmc3RyaW5nID0gZnVu\nYzsNCiAgICAgICAgaWYgKGZ1bmMuaW5kZXhPZih0YXJnZXQpICE9IC0xKQ0K\nICAgICAgICAgICAgZnN0cmluZyA9IFN0cmluZ3MucmVwbGFjZSgNCiAgICAg\nICAgICAgICAgICBmdW5jLCB0YXJnZXQsICJDQVNUKCIgKyB0YXJnZXQgKyBh\nc1N0cmluZyArICIpIik7DQogICAgICAgIHJldHVybiBmc3RyaW5nOw0KICAg\nIH0NCg0KICAgIC8qKg0KICAgICAqIGFkZCBDQVNUIGZvciBhIGZ1bmN0aW9u\nIG9wZXJhdG9yIHdoZXJlIG9wZXJhbmQgaXMgYSBwYXJhbQ0KICAgICAqIA0K\nICAgICAqIEBwYXJhbSBmdW5jIGZ1bmN0aW9uIG5hbWUNCiAgICAgKiBAcGFy\nYW0gdmFsIHR5cGUNCiAgICAgKiBAcmV0dXJuIHVwZGF0ZWQgc3RyaW5nIChm\ndW5jKQ0KICAgICAqLw0KICAgIHB1YmxpYyBTdHJpbmcgYWRkQ2FzdEFzVHlw\nZShTdHJpbmcgZnVuYywgVmFsIHZhbCkgew0KICAgICAgICBTdHJpbmcgZnN0\ncmluZyA9IG51bGw7DQogICAgICAgIFN0cmluZyB0eXBlID0gZ2V0VHlwZU5h\nbWUoZ2V0SkRCQ1R5cGUoSmF2YVR5cGVzLmdldFR5cGVDb2RlKHZhbA0KICAg\nICAgICAgICAgICAgIC5nZXRUeXBlKCkpLCBmYWxzZSkpOw0KICAgICAgICBm\nc3RyaW5nID0gIkNBU1QoPyBBUyAiICsgdHlwZSArICIpIjsNCiAgICAgICAg\ncmV0dXJuIGZzdHJpbmc7DQogICAgfQ0KDQogICAgLyoqDQogICAgICogUmV0\ndXJuIHRoZSBjb3JyZWN0IENBU1QgZnVuY3Rpb24gc3ludGF4DQogICAgICog\nDQogICAgICogQHBhcmFtIHZhbCBvcGVyYW5kIG9mIGNhc3QNCiAgICAgKiBA\ncGFyYW0gZnVuYyBvcmlnaW5hbCBzdHJpbmcNCiAgICAgKiBAcmV0dXJuIGEg\nU3RyaW5nIHdpdGggdGhlIGNvcnJlY3QgQ0FTVCBmdW5jdGlvbiBzeW50YXgN\nCiAgICAgKi8NCiAgICBwdWJsaWMgU3RyaW5nIGdldENhc3RGdW5jdGlvbihW\nYWwgdmFsLCBTdHJpbmcgZnVuYykgew0KICAgICAgICBpZiAodmFsIGluc3Rh\nbmNlb2YgTGl0IHx8IHZhbCBpbnN0YW5jZW9mIFBhcmFtKQ0KICAgICAgICAg\nICAgaWYgKGZ1bmMuaW5kZXhPZigiVkFSQ0hBUiIpID09IC0xKQ0KICAgICAg\nICAgICAgICAgIGZ1bmMgPSBhZGRDYXN0QXNTdHJpbmcoZnVuYywgInswfSIs\nICIgQVMgVkFSQ0hBUigxMDAwKSIpOw0KICAgICAgICByZXR1cm4gZnVuYzsN\nCiAgICB9DQoNCiAgICBwdWJsaWMgdm9pZCBpbmRleE9mKFNRTEJ1ZmZlciBi\ndWYsIEZpbHRlclZhbHVlIHN0ciwgRmlsdGVyVmFsdWUgZmluZCwNCiAgICAg\nICAgICAgIEZpbHRlclZhbHVlIHN0YXJ0KSB7DQogICAgICAgIGlmIChmaW5k\nLmdldFZhbHVlKCkgIT0gbnVsbCkgeyAvLyBub24gY29uc3RhbnRzDQogICAg\nICAgICAgICBidWYuYXBwZW5kKCIoTE9DQVRFKENBU1QoKCIpOw0KICAgICAg\nICAgICAgZmluZC5hcHBlbmRUbyhidWYpOw0KICAgICAgICAgICAgYnVmLmFw\ncGVuZCgiKSBBUyBWQVJDSEFSKDEwMDApKSwgIik7DQogICAgICAgIH0gZWxz\nZSB7DQogICAgICAgICAgICAvLyB0aGlzIGlzIGEgY29uc3RhbnQNCiAgICAg\nICAgICAgIGJ1Zi5hcHBlbmQoIihMT0NBVEUoIik7DQogICAgICAgICAgICBm\naW5kLmFwcGVuZFRvKGJ1Zik7DQogICAgICAgICAgICBidWYuYXBwZW5kKCIs\nICIpOw0KICAgICAgICB9DQogICAgICAgIGlmIChzdHIuZ2V0VmFsdWUoKSAh\nPSBudWxsKSB7DQogICAgICAgICAgICBidWYuYXBwZW5kKCJDQVNUKCgiKTsN\nCiAgICAgICAgICAgIHN0ci5hcHBlbmRUbyhidWYpOw0KICAgICAgICAgICAg\nYnVmLmFwcGVuZCgiKSBBUyBWQVJDSEFSKDEwMDApKSIpOw0KICAgICAgICB9\nIGVsc2Ugew0KICAgICAgICAgICAgc3RyLmFwcGVuZFRvKGJ1Zik7DQogICAg\nICAgIH0NCiAgICAgICAgaWYgKHN0YXJ0ICE9IG51bGwpIHsNCiAgICAgICAg\nICAgIGlmIChzdGFydC5nZXRWYWx1ZSgpID09IG51bGwpIHsNCiAgICAgICAg\nICAgICAgICBidWYuYXBwZW5kKCIsIENBU1QoKCIpOw0KICAgICAgICAgICAg\nICAgIHN0YXJ0LmFwcGVuZFRvKGJ1Zik7DQogICAgICAgICAgICAgICAgYnVm\nLmFwcGVuZCgiKSBBUyBJTlRFR0VSKSArIDEiKTsNCiAgICAgICAgICAgIH0g\nZWxzZSB7DQogICAgICAgICAgICAgICAgYnVmLmFwcGVuZCgiLCAiKTsNCiAg\nICAgICAgICAgICAgICBzdGFydC5hcHBlbmRUbyhidWYpOw0KICAgICAgICAg\nICAgfQ0KICAgICAgICB9DQogICAgICAgIGJ1Zi5hcHBlbmQoIikgLSAxKSIp\nOw0KICAgIH0NCn0NCg==\n","encoding":"base64"}

