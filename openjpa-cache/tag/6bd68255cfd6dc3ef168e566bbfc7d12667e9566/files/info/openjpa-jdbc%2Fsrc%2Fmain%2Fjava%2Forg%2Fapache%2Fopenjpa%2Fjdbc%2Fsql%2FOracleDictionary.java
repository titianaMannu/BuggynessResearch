{"sha":"aa8ed1793b6917b7d8a3beb4b080fb92f7d9322f","node_id":"MDQ6QmxvYjIwNjM2NDphYThlZDE3OTNiNjkxN2I3ZDhhM2JlYjRiMDgwZmI5MmY3ZDkzMjJm","size":42812,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/aa8ed1793b6917b7d8a3beb4b080fb92f7d9322f","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zcWw7CgppbXBvcnQg\namF2YS5sYW5nLnJlZmxlY3QuSW52b2NhdGlvblRhcmdldEV4Y2VwdGlvbjsK\naW1wb3J0IGphdmEubGFuZy5yZWZsZWN0Lk1ldGhvZDsKaW1wb3J0IGphdmEu\nc3FsLkJsb2I7CmltcG9ydCBqYXZhLnNxbC5DbG9iOwppbXBvcnQgamF2YS5z\ncWwuQ29ubmVjdGlvbjsKaW1wb3J0IGphdmEuc3FsLkRhdGFiYXNlTWV0YURh\ndGE7CmltcG9ydCBqYXZhLnNxbC5QcmVwYXJlZFN0YXRlbWVudDsKaW1wb3J0\nIGphdmEuc3FsLlJlc3VsdFNldDsKaW1wb3J0IGphdmEuc3FsLlNRTEV4Y2Vw\ndGlvbjsKaW1wb3J0IGphdmEuc3FsLlN0YXRlbWVudDsKaW1wb3J0IGphdmEu\nc3FsLlRpbWVzdGFtcDsKaW1wb3J0IGphdmEuc3FsLlR5cGVzOwppbXBvcnQg\namF2YS51dGlsLkFycmF5TGlzdDsKaW1wb3J0IGphdmEudXRpbC5BcnJheXM7\nCmltcG9ydCBqYXZhLnV0aWwuQ2FsZW5kYXI7CmltcG9ydCBqYXZhLnV0aWwu\nSXRlcmF0b3I7CmltcG9ydCBqYXZhLnV0aWwuTGlzdDsKaW1wb3J0IGphdmEu\ndXRpbC5NYXA7CgppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMua2Vy\nbmVsLkpEQkNGZXRjaENvbmZpZ3VyYXRpb247CmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEuamRiYy5rZXJuZWwuZXhwcy5GaWx0ZXJWYWx1ZTsKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNjaGVtYS5Db2x1bW47CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hlbWEuRm9yZWlnbktleTsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNjaGVtYS5JbmRleDsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNjaGVtYS5QcmltYXJ5\nS2V5OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1hLlNl\ncXVlbmNlOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1h\nLlRhYmxlOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi5qZGJjLkRl\nbGVnYXRpbmdEYXRhYmFzZU1ldGFEYXRhOwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLmxpYi5qZGJjLkRlbGVnYXRpbmdQcmVwYXJlZFN0YXRlbWVudDsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIudXRpbC5Mb2NhbGl6ZXI7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5TdG9yZUV4Y2VwdGlv\nbjsKaW1wb3J0IHNlcnAudXRpbC5OdW1iZXJzOwoKLyoqCiAqIERpY3Rpb25h\ncnkgZm9yIE9yYWNsZS4KICovCnB1YmxpYyBjbGFzcyBPcmFjbGVEaWN0aW9u\nYXJ5CiAgICBleHRlbmRzIERCRGljdGlvbmFyeSB7CgogICAgcHVibGljIHN0\nYXRpYyBmaW5hbCBTdHJpbmcgU0VMRUNUX0hJTlQgPSAib3BlbmpwYS5oaW50\nLk9yYWNsZVNlbGVjdEhpbnQiOwogICAgcHVibGljIHN0YXRpYyBmaW5hbCBT\ndHJpbmcgVkVORE9SX09SQUNMRSA9ICJvcmFjbGUiOwoKICAgIHByaXZhdGUg\nc3RhdGljIGZpbmFsIGludCBCRUhBVkVfT1RIRVIgPSAwOwogICAgcHJpdmF0\nZSBzdGF0aWMgZmluYWwgaW50IEJFSEFWRV9PUkFDTEUgPSAxOwogICAgcHJp\ndmF0ZSBzdGF0aWMgZmluYWwgaW50IEJFSEFWRV9EQVRBRElSRUNUMzEgPSAy\nOwoKICAgIHByaXZhdGUgc3RhdGljIEJsb2IgRU1QVFlfQkxPQiA9IG51bGw7\nCiAgICBwcml2YXRlIHN0YXRpYyBDbG9iIEVNUFRZX0NMT0IgPSBudWxsOwoK\nICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIExvY2FsaXplciBfbG9jID0gTG9j\nYWxpemVyLmZvclBhY2thZ2UKICAgICAgICAoT3JhY2xlRGljdGlvbmFyeS5j\nbGFzcyk7CgogICAgLyoqCiAgICAgKiBJZiB0cnVlLCB0aGVuIHNpbXVsYXRl\nIGF1dG8tYXNzaWduZWQgdmFsdWVzIGluIE9yYWNsZSBieQogICAgICogdXNp\nbmcgYSB0cmlnZ2VyIHRoYXQgaW5zZXJ0cyBhIHNlcXVlbmNlIHZhbHVlIGlu\ndG8gdGhlCiAgICAgKiBwcmltYXJ5IGtleSB2YWx1ZSB3aGVuIGEgcm93IGlz\nIGluc2VydGVkLgogICAgICovCiAgICBwdWJsaWMgYm9vbGVhbiB1c2VUcmln\nZ2Vyc0ZvckF1dG9Bc3NpZ24gPSBmYWxzZTsKCiAgICAvKioKICAgICAqIFRo\nZSBnbG9iYWwgc2VxdWVuY2UgbmFtZSB0byB1c2UgZm9yIGF1dG9hc3NpZ24g\nc2ltdWxhdGlvbi4KICAgICAqLwogICAgcHVibGljIFN0cmluZyBhdXRvQXNz\naWduU2VxdWVuY2VOYW1lID0gbnVsbDsKCiAgICAvKioKICAgICAqIEZsYWcg\ndG8gdXNlIE9wZW5KUEEgMC4zIHN0eWxlIG5hbWluZyBmb3IgYXV0byBhc3Np\nZ24gc2VxdWVuY2UgbmFtZSBhbmQKICAgICAqIHRyaWdnZXIgbmFtZSBmb3Ig\nYmFja3dhcmRzIGNvbXBhdGliaWxpdHkuCiAgICAgKi8KICAgIHB1YmxpYyBi\nb29sZWFuIG9wZW5qcGEzR2VuZXJhdGVkS2V5TmFtZXMgPSBmYWxzZTsKCiAg\nICAvKioKICAgICAqIElmIHRydWUsIHRoZW4gT3BlbkpQQSB3aWxsIGF0dGVt\ncHQgdG8gdXNlIHRoZSBzcGVjaWFsCiAgICAgKiBPcmFjbGVQcmVwYXJlZFN0\nYXRlbWVudC5zZXRGb3JtT2ZVc2UgbWV0aG9kIHRvCiAgICAgKiBjb25maWd1\ncmUgc3RhdGVtZW50cyB0aGF0IGl0IGRldGVjdHMgYXJlIG9wZXJhdGluZyBv\nbiB1bmljb2RlIGZpZWxkcy4KICAgICAqLwogICAgcHVibGljIGJvb2xlYW4g\ndXNlU2V0Rm9ybU9mVXNlRm9yVW5pY29kZSA9IHRydWU7CgogICAgLy8gc29t\nZSBvcmFjbGUgZHJpdmVycyBoYXZlIHByb2JsZW1zIHdpdGggc2VsZWN0IGZv\nciB1cGRhdGU7IHdhcm4gdGhlCiAgICAvLyBmaXJzdCB0aW1lIGxvY2tpbmcg\naXMgYXR0ZW1wdGVkCiAgICBwcml2YXRlIGJvb2xlYW4gX2NoZWNrZWRVcGRh\ndGVCdWcgPSBmYWxzZTsKICAgIHByaXZhdGUgYm9vbGVhbiBfd2FybmVkQ2hh\nckNvbHVtbiA9IGZhbHNlOwogICAgcHJpdmF0ZSBib29sZWFuIF93YXJuZWRO\nY2hhckNvbHVtbiA9IGZhbHNlOwogICAgcHJpdmF0ZSBpbnQgX2RyaXZlckJl\naGF2aW9yID0gLTE7CgogICAgLy8gY2FjaGUgbG9iIG1ldGhvZHMKICAgIHBy\naXZhdGUgTWV0aG9kIF9wdXRCeXRlcyA9IG51bGw7CiAgICBwcml2YXRlIE1l\ndGhvZCBfcHV0U3RyaW5nID0gbnVsbDsKICAgIHByaXZhdGUgTWV0aG9kIF9w\ndXRDaGFycyA9IG51bGw7CgogICAgcHVibGljIE9yYWNsZURpY3Rpb25hcnko\nKSB7CiAgICAgICAgcGxhdGZvcm0gPSAiT3JhY2xlIjsKICAgICAgICB2YWxp\nZGF0aW9uU1FMID0gIlNFTEVDVCBTWVNEQVRFIEZST00gRFVBTCI7CiAgICAg\nICAgbmV4dFNlcXVlbmNlUXVlcnkgPSAiU0VMRUNUIHswfS5ORVhUVkFMIEZS\nT00gRFVBTCI7CiAgICAgICAgc3RyaW5nTGVuZ3RoRnVuY3Rpb24gPSAiTEVO\nR1RIKHswfSkiOwogICAgICAgIGpvaW5TeW50YXggPSBTWU5UQVhfREFUQUJB\nU0U7CiAgICAgICAgbWF4VGFibGVOYW1lTGVuZ3RoID0gMzA7CiAgICAgICAg\nbWF4Q29sdW1uTmFtZUxlbmd0aCA9IDMwOwogICAgICAgIG1heEluZGV4TmFt\nZUxlbmd0aCA9IDMwOwogICAgICAgIG1heENvbnN0cmFpbnROYW1lTGVuZ3Ro\nID0gMzA7CiAgICAgICAgbWF4RW1iZWRkZWRCbG9iU2l6ZSA9IDQwMDA7CiAg\nICAgICAgbWF4RW1iZWRkZWRDbG9iU2l6ZSA9IDQwMDA7CiAgICAgICAgaW5D\nbGF1c2VMaW1pdCA9IDEwMDA7CgogICAgICAgIHN1cHBvcnRzRGVmZXJyZWRD\nb25zdHJhaW50cyA9IHRydWU7CiAgICAgICAgc3VwcG9ydHNMb2NraW5nV2l0\naERpc3RpbmN0Q2xhdXNlID0gZmFsc2U7CiAgICAgICAgc3VwcG9ydHNTZWxl\nY3RTdGFydEluZGV4ID0gdHJ1ZTsKICAgICAgICBzdXBwb3J0c1NlbGVjdEVu\nZEluZGV4ID0gdHJ1ZTsKCiAgICAgICAgc3lzdGVtU2NoZW1hU2V0LmFkZEFs\nbChBcnJheXMuYXNMaXN0KG5ldyBTdHJpbmdbXXsKICAgICAgICAgICAgIkNU\nWFNZUyIsICJNRFNZUyIsICJTWVMiLCAiU1lTVEVNIiwgIldLU1lTIiwgIldN\nU1lTIiwgIlhEQiIsCiAgICAgICAgfSkpOwoKICAgICAgICBzdXBwb3J0c1hN\nTENvbHVtbiA9IHRydWU7CiAgICAgICAgeG1sVHlwZU5hbWUgPSAiWE1MVHlw\nZSI7CiAgICAgICAgYmlnaW50VHlwZU5hbWUgPSAiTlVNQkVSezB9IjsKICAg\nICAgICBiaXRUeXBlTmFtZSA9ICJOVU1CRVJ7MH0iOwogICAgICAgIGRlY2lt\nYWxUeXBlTmFtZSA9ICJOVU1CRVJ7MH0iOwogICAgICAgIGRvdWJsZVR5cGVO\nYW1lID0gIk5VTUJFUnswfSI7CiAgICAgICAgaW50ZWdlclR5cGVOYW1lID0g\nIk5VTUJFUnswfSI7CiAgICAgICAgbnVtZXJpY1R5cGVOYW1lID0gIk5VTUJF\nUnswfSI7CiAgICAgICAgc21hbGxpbnRUeXBlTmFtZSA9ICJOVU1CRVJ7MH0i\nOwogICAgICAgIHRpbnlpbnRUeXBlTmFtZSA9ICJOVU1CRVJ7MH0iOwogICAg\nICAgIGxvbmdWYXJjaGFyVHlwZU5hbWUgPSAiTE9ORyI7CiAgICAgICAgYmlu\nYXJ5VHlwZU5hbWUgPSAiQkxPQiI7CiAgICAgICAgdmFyYmluYXJ5VHlwZU5h\nbWUgPSAiQkxPQiI7CiAgICAgICAgbG9uZ1ZhcmJpbmFyeVR5cGVOYW1lID0g\nIkJMT0IiOwogICAgICAgIHRpbWVUeXBlTmFtZSA9ICJEQVRFIjsKICAgICAg\nICB2YXJjaGFyVHlwZU5hbWUgPSAiVkFSQ0hBUjJ7MH0iOwogICAgICAgIGZp\neGVkU2l6ZVR5cGVOYW1lU2V0LmFkZEFsbChBcnJheXMuYXNMaXN0KG5ldyBT\ndHJpbmdbXXsKICAgICAgICAgICAgIkxPTkcgUkFXIiwgIlJBVyIsICJMT05H\nIiwgIlJFRiIsCiAgICAgICAgfSkpOwogICAgICAgIHJlc2VydmVkV29yZFNl\ndC5hZGRBbGwoQXJyYXlzLmFzTGlzdChuZXcgU3RyaW5nW117CiAgICAgICAg\nICAgICJBQ0NFU1MiLCAiQVVESVQiLCAiQ0xVU1RFUiIsICJDT01NRU5UIiwg\nIkNPTVBSRVNTIiwgIkVYQ0xVU0lWRSIsCiAgICAgICAgICAgICJGSUxFIiwg\nIklERU5USUZJRUQiLCAiSU5DUkVNRU5UIiwgIklOREVYIiwgIklOSVRJQUwi\nLCAiTE9DSyIsCiAgICAgICAgICAgICJMT05HIiwgIk1BWEVYVEVOVFMiLCAi\nTUlOVVMiLCAiTU9ERSIsICJOT0FVRElUIiwgIk5PQ09NUFJFU1MiLAogICAg\nICAgICAgICAiTk9XQUlUIiwgIk9GRkxJTkUiLCAiT05MSU5FIiwgIlBDVEZS\nRUUiLCAiUk9XIiwKICAgICAgICB9KSk7CiAgICB9CgogICAgcHVibGljIHZv\naWQgZW5kQ29uZmlndXJhdGlvbigpIHsKICAgICAgICBzdXBlci5lbmRDb25m\naWd1cmF0aW9uKCk7CiAgICAgICAgaWYgKHVzZVRyaWdnZXJzRm9yQXV0b0Fz\nc2lnbikKICAgICAgICAgICAgc3VwcG9ydHNBdXRvQXNzaWduID0gdHJ1ZTsK\nICAgIH0KCiAgICBwdWJsaWMgdm9pZCBjb25uZWN0ZWRDb25maWd1cmF0aW9u\nKENvbm5lY3Rpb24gY29ubikKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9u\nIHsKICAgICAgICBzdXBlci5jb25uZWN0ZWRDb25maWd1cmF0aW9uKGNvbm4p\nOwogICAgICAgIGlmIChkcml2ZXJWZW5kb3IgPT0gbnVsbCkgewogICAgICAg\nICAgICBEYXRhYmFzZU1ldGFEYXRhIG1ldGEgPSBjb25uLmdldE1ldGFEYXRh\nKCk7CiAgICAgICAgICAgIFN0cmluZyB1cmwgPSAobWV0YS5nZXRVUkwoKSA9\nPSBudWxsKSA/ICIiIDogbWV0YS5nZXRVUkwoKTsKICAgICAgICAgICAgU3Ry\naW5nIGRyaXZlck5hbWUgPSBtZXRhLmdldERyaXZlck5hbWUoKTsKICAgICAg\nICAgICAgU3RyaW5nIG1ldGFkYXRhQ2xhc3NOYW1lOwogICAgICAgICAgICBp\nZiAobWV0YSBpbnN0YW5jZW9mIERlbGVnYXRpbmdEYXRhYmFzZU1ldGFEYXRh\nKQogICAgICAgICAgICAgICAgbWV0YWRhdGFDbGFzc05hbWUgPSAoKERlbGVn\nYXRpbmdEYXRhYmFzZU1ldGFEYXRhKSBtZXRhKS4KICAgICAgICAgICAgICAg\nICAgICBnZXRJbm5lcm1vc3REZWxlZ2F0ZSgpLmdldENsYXNzKCkuZ2V0TmFt\nZSgpOwogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICBtZXRhZGF0\nYUNsYXNzTmFtZSA9IG1ldGEuZ2V0Q2xhc3MoKS5nZXROYW1lKCk7CgogICAg\nICAgICAgICAvLyBjaGVjayBib3RoIHRoZSBkcml2ZXIgY2xhc3MgbmFtZSBh\nbmQgdGhlIFVSTCBmb3Iga25vd24gcGF0dGVybnMKICAgICAgICAgICAgaWYg\nKG1ldGFkYXRhQ2xhc3NOYW1lLnN0YXJ0c1dpdGgoIm9yYWNsZS4iKQogICAg\nICAgICAgICAgICAgfHwgdXJsLmluZGV4T2YoImpkYmM6b3JhY2xlOiIpICE9\nIC0xCiAgICAgICAgICAgICAgICB8fCAiT3JhY2xlIEpEQkMgZHJpdmVyIi5l\ncXVhbHMoZHJpdmVyTmFtZSkpIHsKICAgICAgICAgICAgICAgIGRyaXZlclZl\nbmRvciA9IFZFTkRPUl9PUkFDTEUgKyBtZXRhLmdldERyaXZlck1ham9yVmVy\nc2lvbigpCiAgICAgICAgICAgICAgICAgICAgKyBtZXRhLmdldERyaXZlck1p\nbm9yVmVyc2lvbigpOwoKICAgICAgICAgICAgICAgIFN0cmluZyBwcm9kdWN0\nVmVyc2lvbiA9IG1ldGEuZ2V0RGF0YWJhc2VQcm9kdWN0VmVyc2lvbigpCiAg\nICAgICAgICAgICAgICAgICAgLnNwbGl0KCJSZWxlYXNlICIsMClbMV0uc3Bs\naXQoIlxcLiIsMClbMF07CiAgICAgICAgICAgICAgICBpbnQgcmVsZWFzZSA9\nIEludGVnZXIucGFyc2VJbnQocHJvZHVjdFZlcnNpb24pOwogICAgICAgICAg\nICAgICAgCiAgICAgICAgICAgICAgICAvLyB3YXJuIHNxbDkyCiAgICAgICAg\nICAgICAgICBpZiAocmVsZWFzZSA9PSA4KSB7CiAgICAgICAgICAgICAgICAg\nICAgaWYgKGpvaW5TeW50YXggPT0gU1lOVEFYX1NRTDkyICYmIGxvZy5pc1dh\ncm5FbmFibGVkKCkpCiAgICAgICAgICAgICAgICAgICAgICAgIGxvZy53YXJu\nKF9sb2MuZ2V0KCJvcmFjbGUtc3ludGF4IikpOwogICAgICAgICAgICAgICAg\nICAgIGpvaW5TeW50YXggPSBTWU5UQVhfREFUQUJBU0U7CiAgICAgICAgICAg\nICAgICAgICAgZGF0ZVR5cGVOYW1lID0gIkRBVEUiOyAvLyBhZGRlZCBvcmFj\nbGUgOQogICAgICAgICAgICAgICAgICAgIHRpbWVzdGFtcFR5cGVOYW1lID0g\nIkRBVEUiOyAvLyBhZGRlZCBvcmFjbGUgOQogICAgICAgICAgICAgICAgICAg\nIHN1cHBvcnRzWE1MQ29sdW1uID0gZmFsc2U7CiAgICAgICAgICAgICAgICB9\nCiAgICAgICAgICAgICAgICBlbHNlIAogICAgICAgICAgICAgICAgICAgIC8v\nIHNlbGVjdCBvZiBhbiB4bWwgY29sdW1uIHJlcXVpcmVzICIuZ2V0U3RyaW5n\nVmFsKCkiCiAgICAgICAgICAgICAgICAgICAgLy8gc3VmZml4LiBlZy4gdDAu\neG1sY29sLmdldFN0cmluZ1ZhbCgpCiAgICAgICAgICAgICAgICAgICAgZ2V0\nU3RyaW5nVmFsID0gIi5nZXRTdHJpbmdWYWwoKSI7CiAgICAgICAgICAgIH0g\nZWxzZSBpZiAobWV0YWRhdGFDbGFzc05hbWUuc3RhcnRzV2l0aCgiY29tLmRk\ndGVrLiIpCiAgICAgICAgICAgICAgICB8fCB1cmwuaW5kZXhPZigiamRiYzpk\nYXRhZGlyZWN0Om9yYWNsZToiKSAhPSAtMQogICAgICAgICAgICAgICAgfHwg\nIk9yYWNsZSIuZXF1YWxzKGRyaXZlck5hbWUpKSB7CiAgICAgICAgICAgICAg\nICBkcml2ZXJWZW5kb3IgPSBWRU5ET1JfREFUQURJUkVDVCArIG1ldGEuZ2V0\nRHJpdmVyTWFqb3JWZXJzaW9uKCkKICAgICAgICAgICAgICAgICAgICArIG1l\ndGEuZ2V0RHJpdmVyTWlub3JWZXJzaW9uKCk7CiAgICAgICAgICAgIH0gZWxz\nZQogICAgICAgICAgICAgICAgZHJpdmVyVmVuZG9yID0gVkVORE9SX09USEVS\nOwogICAgICAgIH0KICAgICAgICBjYWNoZURyaXZlckJlaGF2aW9yKGRyaXZl\nclZlbmRvcik7CiAgICB9CgogICAgLyoqCiAgICAgKiBDYWNoZSBjb25zdGFu\ndCBmb3IgZHJpdmVycyB3aXRoIGJlaGF2aW9ycyB3ZSBoYXZlIHRvIGRlYWwg\nd2l0aC4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIGNhY2hlRHJpdmVyQmVo\nYXZpb3IoU3RyaW5nIGRyaXZlclZlbmRvcikgewogICAgICAgIGlmIChfZHJp\ndmVyQmVoYXZpb3IgIT0gLTEpCiAgICAgICAgICAgIHJldHVybjsKCiAgICAg\nICAgZHJpdmVyVmVuZG9yID0gZHJpdmVyVmVuZG9yLnRvTG93ZXJDYXNlKCk7\nCiAgICAgICAgaWYgKGRyaXZlclZlbmRvci5zdGFydHNXaXRoKFZFTkRPUl9P\nUkFDTEUpKQogICAgICAgICAgICBfZHJpdmVyQmVoYXZpb3IgPSBCRUhBVkVf\nT1JBQ0xFOwogICAgICAgIGVsc2UgaWYgKGRyaXZlclZlbmRvci5lcXVhbHMo\nVkVORE9SX0RBVEFESVJFQ1QgKyAiMzAiKQogICAgICAgICAgICB8fCBkcml2\nZXJWZW5kb3IuZXF1YWxzKFZFTkRPUl9EQVRBRElSRUNUICsgIjMxIikpCiAg\nICAgICAgICAgIF9kcml2ZXJCZWhhdmlvciA9IEJFSEFWRV9EQVRBRElSRUNU\nMzE7CiAgICAgICAgZWxzZQogICAgICAgICAgICBfZHJpdmVyQmVoYXZpb3Ig\nPSBCRUhBVkVfT1RIRVI7CiAgICB9CgogICAgLyoqCiAgICAgKiBFbnN1cmUg\ndGhhdCB0aGUgZHJpdmVyIHZlbmRvciBoYXMgYmVlbiBzZXQsIGFuZCBpZiBu\nb3QsIHNldCBpdCBub3cuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIGVuc3Vy\nZURyaXZlclZlbmRvcigpIHsKICAgICAgICBpZiAoZHJpdmVyVmVuZG9yICE9\nIG51bGwpIHsKICAgICAgICAgICAgY2FjaGVEcml2ZXJCZWhhdmlvcihkcml2\nZXJWZW5kb3IpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAg\nICAgICBpZiAobG9nLmlzSW5mb0VuYWJsZWQoKSkKICAgICAgICAgICAgbG9n\nLmluZm8oX2xvYy5nZXQoIm9yYWNsZS1jb25uZWN0aW5nLWZvci1kcml2ZXIi\nKSk7CiAgICAgICAgQ29ubmVjdGlvbiBjb25uID0gbnVsbDsKICAgICAgICB0\ncnkgewogICAgICAgICAgICBjb25uID0gY29uZi5nZXREYXRhU291cmNlMihu\ndWxsKS5nZXRDb25uZWN0aW9uKCk7CiAgICAgICAgICAgIGNvbm5lY3RlZENv\nbmZpZ3VyYXRpb24oY29ubik7CiAgICAgICAgfSBjYXRjaCAoU1FMRXhjZXB0\naW9uIHNlKSB7CiAgICAgICAgICAgIHRocm93IFNRTEV4Y2VwdGlvbnMuZ2V0\nU3RvcmUoc2UsIHRoaXMpOwogICAgICAgIH0gZmluYWxseSB7CiAgICAgICAg\nICAgIGlmIChjb25uICE9IG51bGwpCiAgICAgICAgICAgICAgICB0cnkgewog\nICAgICAgICAgICAgICAgICAgIGNvbm4uY2xvc2UoKTsKICAgICAgICAgICAg\nICAgIH0gY2F0Y2ggKFNRTEV4Y2VwdGlvbiBzZSkgewogICAgICAgICAgICAg\nICAgfQogICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBzdXBw\nb3J0c0xvY2tpbmcoU2VsZWN0IHNlbCkgewogICAgICAgIGlmICghc3VwZXIu\nc3VwcG9ydHNMb2NraW5nKHNlbCkpCiAgICAgICAgICAgIHJldHVybiBmYWxz\nZTsKICAgICAgICByZXR1cm4gIXJlcXVpcmVzU3Vic2VsZWN0Rm9yUmFuZ2Uo\nc2VsLmdldFN0YXJ0SW5kZXgoKSwKICAgICAgICAgICAgc2VsLmdldEVuZElu\nZGV4KCksIHNlbC5pc0Rpc3RpbmN0KCksIHNlbC5nZXRPcmRlcmluZygpKTsK\nICAgIH0KCiAgICBwcm90ZWN0ZWQgU1FMQnVmZmVyIGdldFNlbGVjdHMoU2Vs\nZWN0IHNlbCwgYm9vbGVhbiBkaXN0aW5jdElkZW50aWZpZXJzLAogICAgICAg\nIGJvb2xlYW4gZm9yVXBkYXRlKSB7CiAgICAgICAgLy8gaWYgcmFuZ2UgZG9l\nc24ndCByZXF1aXJlIGEgc3Vic2VsZWN0IGNhbiB1c2Ugc3VwZXIKICAgICAg\nICBpZiAoIXJlcXVpcmVzU3Vic2VsZWN0Rm9yUmFuZ2Uoc2VsLmdldFN0YXJ0\nSW5kZXgoKSwKICAgICAgICAgICAgc2VsLmdldEVuZEluZGV4KCksIHNlbC5p\nc0Rpc3RpbmN0KCksIHNlbC5nZXRPcmRlcmluZygpKSkKICAgICAgICAgICAg\ncmV0dXJuIHN1cGVyLmdldFNlbGVjdHMoc2VsLCBkaXN0aW5jdElkZW50aWZp\nZXJzLCBmb3JVcGRhdGUpOwoKICAgICAgICAvLyBpZiB0aGVyZSBhcmUgbm8g\nam9pbnMgaW52b2x2ZWQgb3Igd2UncmUgdXNpbmcgYSBmcm9tIHNlbGVjdCBz\nbwogICAgICAgIC8vIHRoYXQgYWxsIGNvbHMgYWxyZWFkeSBoYXZlIHVuaXF1\nZSBhbGlhc2VzLCBjYW4gdXNlIHN1cGVyCiAgICAgICAgaWYgKHNlbC5nZXRG\ncm9tU2VsZWN0KCkgIT0gbnVsbCB8fCBzZWwuZ2V0VGFibGVBbGlhc2VzKCku\nc2l6ZSgpIDwgMikKICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmdldFNlbGVj\ndHMoc2VsLCBkaXN0aW5jdElkZW50aWZpZXJzLCBmb3JVcGRhdGUpOwoKICAg\nICAgICAvLyBzaW5jZSBub25lIG9mIHRoZSBjb25kaXRpb25zIGFib3ZlIHdl\ncmUgbWV0LCB3ZSdyZSBkZWFsaW5nIHdpdGgKICAgICAgICAvLyBhIHNlbGVj\ndCB0aGF0IHVzZXMgam9pbnMgYW5kIHJlcXVpcmVzIHN1YnNlbGVjdHMgdG8g\nc2VsZWN0IHRoZQogICAgICAgIC8vIHByb3BlciByYW5nZTsgYWxpYXMgYWxs\nIGNvbHVtbiB2YWx1ZXMgc28gdGhhdCB0aGV5IGFyZSB1bmlxdWUgd2l0aGlu\nCiAgICAgICAgLy8gdGhlIHN1YnNlbGVjdAogICAgICAgIFNRTEJ1ZmZlciBz\nZWxlY3RTUUwgPSBuZXcgU1FMQnVmZmVyKHRoaXMpOwogICAgICAgIExpc3Qg\nYWxpYXNlczsKICAgICAgICBpZiAoZGlzdGluY3RJZGVudGlmaWVycykKICAg\nICAgICAgICAgYWxpYXNlcyA9IHNlbC5nZXRJZGVudGlmaWVyQWxpYXNlcygp\nOwogICAgICAgIGVsc2UKICAgICAgICAgICAgYWxpYXNlcyA9IHNlbC5nZXRT\nZWxlY3RBbGlhc2VzKCk7CgogICAgICAgIE9iamVjdCBhbGlhczsKICAgICAg\nICBpbnQgaSA9IDA7CiAgICAgICAgZm9yIChJdGVyYXRvciBpdHIgPSBhbGlh\nc2VzLml0ZXJhdG9yKCk7IGl0ci5oYXNOZXh0KCk7IGkrKykgewogICAgICAg\nICAgICBhbGlhcyA9IGl0ci5uZXh0KCk7CiAgICAgICAgICAgIGlmIChhbGlh\ncyBpbnN0YW5jZW9mIFNRTEJ1ZmZlcikKICAgICAgICAgICAgICAgIHNlbGVj\ndFNRTC5hcHBlbmQoKFNRTEJ1ZmZlcikgYWxpYXMpOwogICAgICAgICAgICBl\nbHNlCiAgICAgICAgICAgICAgICBzZWxlY3RTUUwuYXBwZW5kKGFsaWFzLnRv\nU3RyaW5nKCkpOwogICAgICAgICAgICBzZWxlY3RTUUwuYXBwZW5kKCIgQVMg\nYyIpLmFwcGVuZChTdHJpbmcudmFsdWVPZihpKSk7CiAgICAgICAgICAgIGlm\nIChpdHIuaGFzTmV4dCgpKQogICAgICAgICAgICAgICAgc2VsZWN0U1FMLmFw\ncGVuZCgiLCAiKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHNlbGVjdFNR\nTDsKICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBjYW5PdXRlckpvaW4oaW50\nIHN5bnRheCwgRm9yZWlnbktleSBmaykgewogICAgICAgIGlmICghc3VwZXIu\nY2FuT3V0ZXJKb2luKHN5bnRheCwgZmspKQogICAgICAgICAgICByZXR1cm4g\nZmFsc2U7CiAgICAgICAgaWYgKGZrICE9IG51bGwgJiYgc3ludGF4ID09IFNZ\nTlRBWF9EQVRBQkFTRSkgewogICAgICAgICAgICBpZiAoZmsuZ2V0Q29uc3Rh\nbnRzKCkubGVuZ3RoID4gMCkKICAgICAgICAgICAgICAgIHJldHVybiBmYWxz\nZTsKICAgICAgICAgICAgaWYgKGZrLmdldFByaW1hcnlLZXlDb25zdGFudHMo\nKS5sZW5ndGggPiAwKQogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwog\nICAgICAgIH0KICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBwdWJs\naWMgU1FMQnVmZmVyIHRvTmF0aXZlSm9pbihKb2luIGpvaW4pIHsKICAgICAg\nICBpZiAoam9pbi5nZXRUeXBlKCkgIT0gSm9pbi5UWVBFX09VVEVSKQogICAg\nICAgICAgICByZXR1cm4gdG9UcmFkaXRpb25hbEpvaW4oam9pbik7CgogICAg\nICAgIEZvcmVpZ25LZXkgZmsgPSBqb2luLmdldEZvcmVpZ25LZXkoKTsKICAg\nICAgICBpZiAoZmsgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIG51bGw7\nCgogICAgICAgIGJvb2xlYW4gaW52ZXJzZSA9IGpvaW4uaXNGb3JlaWduS2V5\nSW52ZXJzZWQoKTsKICAgICAgICBDb2x1bW5bXSBmcm9tID0gKGludmVyc2Up\nID8gZmsuZ2V0UHJpbWFyeUtleUNvbHVtbnMoKQogICAgICAgICAgICA6IGZr\nLmdldENvbHVtbnMoKTsKICAgICAgICBDb2x1bW5bXSB0byA9IChpbnZlcnNl\nKSA/IGZrLmdldENvbHVtbnMoKQogICAgICAgICAgICA6IGZrLmdldFByaW1h\ncnlLZXlDb2x1bW5zKCk7CgogICAgICAgIC8vIGRvIGNvbHVtbiBqb2lucwog\nICAgICAgIFNRTEJ1ZmZlciBidWYgPSBuZXcgU1FMQnVmZmVyKHRoaXMpOwog\nICAgICAgIGludCBjb3VudCA9IDA7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7\nIGkgPCBmcm9tLmxlbmd0aDsgaSsrLCBjb3VudCsrKSB7CiAgICAgICAgICAg\nIGlmIChjb3VudCA+IDApCiAgICAgICAgICAgICAgICBidWYuYXBwZW5kKCIg\nQU5EICIpOwogICAgICAgICAgICBidWYuYXBwZW5kKGpvaW4uZ2V0QWxpYXMx\nKCkpLmFwcGVuZCgiLiIpLmFwcGVuZChmcm9tW2ldKTsKICAgICAgICAgICAg\nYnVmLmFwcGVuZCgiID0gIik7CiAgICAgICAgICAgIGJ1Zi5hcHBlbmQoam9p\nbi5nZXRBbGlhczIoKSkuYXBwZW5kKCIuIikuYXBwZW5kKHRvW2ldKTsKICAg\nICAgICAgICAgYnVmLmFwcGVuZCgiKCspIik7CiAgICAgICAgfQoKICAgICAg\nICAvLyBjaGVjayBjb25zdGFudCBqb2lucwogICAgICAgIGlmIChmay5nZXRD\nb25zdGFudENvbHVtbnMoKS5sZW5ndGggPiAwKQogICAgICAgICAgICB0aHJv\ndyBuZXcgU3RvcmVFeGNlcHRpb24oX2xvYy5nZXQoIm9yYWNsZS1jb25zdGFu\ndCIsCiAgICAgICAgICAgICAgICBqb2luLmdldFRhYmxlMSgpLCBqb2luLmdl\ndFRhYmxlMigpKSkuc2V0RmF0YWwodHJ1ZSk7CgogICAgICAgIGlmIChmay5n\nZXRDb25zdGFudFByaW1hcnlLZXlDb2x1bW5zKCkubGVuZ3RoID4gMCkKICAg\nICAgICAgICAgdGhyb3cgbmV3IFN0b3JlRXhjZXB0aW9uKF9sb2MuZ2V0KCJv\ncmFjbGUtY29uc3RhbnQiLAogICAgICAgICAgICAgICAgam9pbi5nZXRUYWJs\nZTEoKSwgam9pbi5nZXRUYWJsZTIoKSkpLnNldEZhdGFsKHRydWUpOwogICAg\nICAgIHJldHVybiBidWY7CiAgICB9CgogICAgcHVibGljIFNRTEJ1ZmZlciB0\nb1NlbGVjdChTUUxCdWZmZXIgc2VsZWN0LCBKREJDRmV0Y2hDb25maWd1cmF0\naW9uIGZldGNoLAogICAgICAgIFNRTEJ1ZmZlciB0YWJsZXMsIFNRTEJ1ZmZl\nciB3aGVyZSwgU1FMQnVmZmVyIGdyb3VwLAogICAgICAgIFNRTEJ1ZmZlciBo\nYXZpbmcsIFNRTEJ1ZmZlciBvcmRlciwKICAgICAgICBib29sZWFuIGRpc3Rp\nbmN0LCBib29sZWFuIGZvclVwZGF0ZSwgbG9uZyBzdGFydCwgbG9uZyBlbmQp\nIHsKICAgICAgICBpZiAoIV9jaGVja2VkVXBkYXRlQnVnKSB7CiAgICAgICAg\nICAgIGVuc3VyZURyaXZlclZlbmRvcigpOwogICAgICAgICAgICBpZiAoZm9y\nVXBkYXRlICYmIF9kcml2ZXJCZWhhdmlvciA9PSBCRUhBVkVfREFUQURJUkVD\nVDMxKQogICAgICAgICAgICAgICAgbG9nLndhcm4oX2xvYy5nZXQoImRkLWxv\nY2stYnVnIikpOwogICAgICAgICAgICBfY2hlY2tlZFVwZGF0ZUJ1ZyA9IHRy\ndWU7CiAgICAgICAgfQoKICAgICAgICAvLyBpZiBubyByYW5nZSwgdXNlIHN0\nYW5kYXJkIHNlbGVjdAogICAgICAgIGlmIChzdGFydCA9PSAwICYmIGVuZCA9\nPSBMb25nLk1BWF9WQUxVRSkKICAgICAgICAgICAgcmV0dXJuIHN1cGVyLnRv\nU2VsZWN0KHNlbGVjdCwgZmV0Y2gsIHRhYmxlcywgd2hlcmUsIGdyb3VwLCBo\nYXZpbmcsCiAgICAgICAgICAgICAgICBvcmRlciwgZGlzdGluY3QsIGZvclVw\nZGF0ZSwgMCwgTG9uZy5NQVhfVkFMVUUpOwoKICAgICAgICAvLyBpZiBubyBz\na2lwLCBvcmRlcmluZywgb3IgZGlzdGluY3QgY2FuIHVzZSByb3dudW0gZGly\nZWN0bHkKICAgICAgICBTUUxCdWZmZXIgYnVmID0gbmV3IFNRTEJ1ZmZlcih0\naGlzKTsKICAgICAgICBpZiAoIXJlcXVpcmVzU3Vic2VsZWN0Rm9yUmFuZ2Uo\nc3RhcnQsIGVuZCwgZGlzdGluY3QsIG9yZGVyKSkgewogICAgICAgICAgICBp\nZiAod2hlcmUgIT0gbnVsbCAmJiAhd2hlcmUuaXNFbXB0eSgpKQogICAgICAg\nICAgICAgICAgYnVmLmFwcGVuZCh3aGVyZSkuYXBwZW5kKCIgQU5EICIpOwog\nICAgICAgICAgICBidWYuYXBwZW5kKCJST1dOVU0gPD0gIikuYXBwZW5kVmFs\ndWUoZW5kKTsKICAgICAgICAgICAgcmV0dXJuIHN1cGVyLnRvU2VsZWN0KHNl\nbGVjdCwgZmV0Y2gsIHRhYmxlcywgYnVmLCBncm91cCwgaGF2aW5nLAogICAg\nICAgICAgICAgICAgb3JkZXIsIGRpc3RpbmN0LCBmb3JVcGRhdGUsIDAsIExv\nbmcuTUFYX1ZBTFVFKTsKICAgICAgICB9CgogICAgICAgIC8vIGlmIHRoZXJl\nIGlzIG9yZGVyaW5nLCBza2lwLCBvciBkaXN0aW5jdCB3ZSBoYXZlIHRvIHVz\nZSBzdWJzZWxlY3RzCiAgICAgICAgU1FMQnVmZmVyIHNlbCA9IHN1cGVyLnRv\nU2VsZWN0KHNlbGVjdCwgZmV0Y2gsIHRhYmxlcywgd2hlcmUsCiAgICAgICAg\nICAgIGdyb3VwLCBoYXZpbmcsIG9yZGVyLCBkaXN0aW5jdCwgZm9yVXBkYXRl\nLCAwLCBMb25nLk1BWF9WQUxVRSk7CgogICAgICAgIC8vIGlmIG5vIHNraXAs\nIGNhbiB1c2Ugc2luZ2xlIG5lc3RlZCBzdWJzZWxlY3QKICAgICAgICBpZiAo\nc3RhcnQgPT0gMCkgewogICAgICAgICAgICBidWYuYXBwZW5kKGdldFNlbGVj\ndE9wZXJhdGlvbihmZXRjaCkgKyAiICogRlJPTSAoIik7CiAgICAgICAgICAg\nIGJ1Zi5hcHBlbmQoc2VsKTsKICAgICAgICAgICAgYnVmLmFwcGVuZCgiKSBX\nSEVSRSBST1dOVU0gPD0gIikuYXBwZW5kVmFsdWUoZW5kKTsKICAgICAgICAg\nICAgcmV0dXJuIGJ1ZjsKICAgICAgICB9CgogICAgICAgIC8vIHdpdGggYSBz\na2lwLCB3ZSBoYXZlIHRvIHVzZSBhIGRvdWJsZS1uZXN0ZWQgc3Vic2VsZWN0\nIHRvIHB1dAogICAgICAgIC8vIHdoZXJlIGNvbmRpdGlvbnMgb24gdGhlIHJv\nd251bQogICAgICAgIGJ1Zi5hcHBlbmQoZ2V0U2VsZWN0T3BlcmF0aW9uKGZl\ndGNoKQogICAgICAgICAgICArICIgKiBGUk9NIChTRUxFQ1Qgci4qLCBST1dO\nVU0gUk5VTSBGUk9NICgiKTsKICAgICAgICBidWYuYXBwZW5kKHNlbCk7CiAg\nICAgICAgYnVmLmFwcGVuZCgiKSByIik7CiAgICAgICAgaWYgKGVuZCAhPSBM\nb25nLk1BWF9WQUxVRSkKICAgICAgICAgICAgYnVmLmFwcGVuZCgiIFdIRVJF\nIFJPV05VTSA8PSAiKS5hcHBlbmRWYWx1ZShlbmQpOwogICAgICAgIGJ1Zi5h\ncHBlbmQoIikgV0hFUkUgUk5VTSA+ICIpLmFwcGVuZFZhbHVlKHN0YXJ0KTsK\nICAgICAgICByZXR1cm4gYnVmOwogICAgfQoKICAgIC8qKgogICAgICogUmV0\ndXJuIHRydWUgaWYgdGhlIHNlbGVjdCB3aXRoIHRoZSBnaXZlbiBwYXJhbWV0\nZXJzIG5lZWRzIGEKICAgICAqIHN1YnNlbGVjdCB0byBhcHBseSBhIHJhbmdl\nLgogICAgICovCiAgICBwcml2YXRlIGJvb2xlYW4gcmVxdWlyZXNTdWJzZWxl\nY3RGb3JSYW5nZShsb25nIHN0YXJ0LCBsb25nIGVuZCwKICAgICAgICBib29s\nZWFuIGRpc3RpbmN0LCBTUUxCdWZmZXIgb3JkZXIpIHsKICAgICAgICBpZiAo\nc3RhcnQgPT0gMCAmJiBlbmQgPT0gTG9uZy5NQVhfVkFMVUUpCiAgICAgICAg\nICAgIHJldHVybiBmYWxzZTsKICAgICAgICByZXR1cm4gc3RhcnQgIT0gMCB8\nfCBkaXN0aW5jdCB8fCAob3JkZXIgIT0gbnVsbCAmJiAhb3JkZXIuaXNFbXB0\neSgpKTsKICAgIH0KCiAgICAvKioKICAgICAqIENoZWNrIHRvIHNlZSBpZiB3\nZSBoYXZlIHNldCB0aGUge0BsaW5rICNTRUxFQ1RfSElOVH0gaW4gdGhlCiAg\nICAgKiBmZXRjaCBjb25maWd1cmFpdG9uLCBhbmQgaWYgc28sIGFwcGVuZCB0\naGUgT3JhY2hlIGhpbnQgYWZ0ZXIgdGhlCiAgICAgKiAiU0VMRUNUIiBwYXJ0\nIG9mIHRoZSBxdWVyeS4KICAgICAqLwogICAgcHVibGljIFN0cmluZyBnZXRT\nZWxlY3RPcGVyYXRpb24oSkRCQ0ZldGNoQ29uZmlndXJhdGlvbiBmZXRjaCkg\newogICAgICAgIE9iamVjdCBoaW50ID0gZmV0Y2ggPT0gbnVsbCA/IG51bGwg\nOiBmZXRjaC5nZXRIaW50KFNFTEVDVF9ISU5UKTsKICAgICAgICBTdHJpbmcg\nc2VsZWN0ID0gIlNFTEVDVCI7CiAgICAgICAgaWYgKGhpbnQgIT0gbnVsbCkK\nICAgICAgICAgICAgc2VsZWN0ICs9ICIgIiArIGhpbnQ7CiAgICAgICAgcmV0\ndXJuIHNlbGVjdDsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzdWJzdHJpbmco\nU1FMQnVmZmVyIGJ1ZiwgRmlsdGVyVmFsdWUgc3RyLCBGaWx0ZXJWYWx1ZSBz\ndGFydCwKICAgICAgICBGaWx0ZXJWYWx1ZSBlbmQpIHsKICAgICAgICBidWYu\nYXBwZW5kKCJTVUJTVFIoIik7CiAgICAgICAgc3RyLmFwcGVuZFRvKGJ1Zik7\nCiAgICAgICAgYnVmLmFwcGVuZCgiLCAoIik7CiAgICAgICAgc3RhcnQuYXBw\nZW5kVG8oYnVmKTsKICAgICAgICBidWYuYXBwZW5kKCIgKyAxKSIpOwogICAg\nICAgIGlmIChlbmQgIT0gbnVsbCkgewogICAgICAgICAgICBidWYuYXBwZW5k\nKCIsICgiKTsKICAgICAgICAgICAgZW5kLmFwcGVuZFRvKGJ1Zik7CiAgICAg\nICAgICAgIGJ1Zi5hcHBlbmQoIiAtICIpOwogICAgICAgICAgICBzdGFydC5h\ncHBlbmRUbyhidWYpOwogICAgICAgICAgICBidWYuYXBwZW5kKCIpIik7CiAg\nICAgICAgfQogICAgICAgIGJ1Zi5hcHBlbmQoIikiKTsKICAgIH0KCiAgICBw\ndWJsaWMgdm9pZCBzZXRTdHJpbmcoUHJlcGFyZWRTdGF0ZW1lbnQgc3RtbnQs\nIGludCBpZHgsIFN0cmluZyB2YWwsCiAgICAgICAgQ29sdW1uIGNvbCkKICAg\nICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAvLyBvcmFjbGUg\nTkNIQVIvTlZBUkNIQVIvTkNMT0IgdW5pY29kZSBjb2x1bW5zIHJlcXVpcmUg\nc29tZQogICAgICAgIC8vIHNwZWNpYWwgaGFuZGxpbmcgdG8gY29uZmlndXJl\nIHRoZW0gY29ycmVjdGx5OyBzZWU6CiAgICAgICAgLy8gaHR0cDovL3d3dy5v\ncmFjbGUuY29tL3RlY2hub2xvZ3kvc2FtcGxlX2NvZGUvdGVjaC9qYXZhLwog\nICAgICAgIC8vIHNxbGpfamRiYy9maWxlcy85aV9qZGJjL05DSEFSc3VwcG9y\ndDRVbmljb2RlU2FtcGxlL1JlYWRtZS5odG1sCiAgICAgICAgU3RyaW5nIHR5\ncGVOYW1lID0gKGNvbCA9PSBudWxsKSA/IG51bGwgOiBjb2wuZ2V0VHlwZU5h\nbWUoKTsKICAgICAgICBpZiAodXNlU2V0Rm9ybU9mVXNlRm9yVW5pY29kZSAm\nJiB0eXBlTmFtZSAhPSBudWxsICYmCiAgICAgICAgICAgICh0eXBlTmFtZS50\nb0xvd2VyQ2FzZSgpLnN0YXJ0c1dpdGgoIm52YXJjaGFyIikgfHwKICAgICAg\nICAgICAgICAgIHR5cGVOYW1lLnRvTG93ZXJDYXNlKCkuc3RhcnRzV2l0aCgi\nbmNoYXIiKSB8fAogICAgICAgICAgICAgICAgdHlwZU5hbWUudG9Mb3dlckNh\nc2UoKS5zdGFydHNXaXRoKCJuY2xvYiIpKSkgewogICAgICAgICAgICBTdGF0\nZW1lbnQgaW5uZXIgPSBzdG1udDsKICAgICAgICAgICAgaWYgKGlubmVyIGlu\nc3RhbmNlb2YgRGVsZWdhdGluZ1ByZXBhcmVkU3RhdGVtZW50KQogICAgICAg\nICAgICAgICAgaW5uZXIgPSAoKERlbGVnYXRpbmdQcmVwYXJlZFN0YXRlbWVu\ndCkgaW5uZXIpLgogICAgICAgICAgICAgICAgICAgIGdldElubmVybW9zdERl\nbGVnYXRlKCk7CiAgICAgICAgICAgIGlmIChpc09yYWNsZVByZXBhcmVkU3Rh\ndGVtZW50KGlubmVyKSkgewogICAgICAgICAgICAgICAgdHJ5IHsKICAgICAg\nICAgICAgICAgICAgICBpbm5lci5nZXRDbGFzcygpLmdldE1ldGhvZCgic2V0\nRm9ybU9mVXNlIiwKICAgICAgICAgICAgICAgICAgICAgICAgbmV3IENsYXNz\nW117IGludC5jbGFzcywgc2hvcnQuY2xhc3MgfSkuCiAgICAgICAgICAgICAg\nICAgICAgICAgIGludm9rZShpbm5lciwKICAgICAgICAgICAgICAgICAgICAg\nICAgICAgIG5ldyBPYmplY3RbXXsKICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICBuZXcgSW50ZWdlcihpZHgpLAogICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgIENsYXNzLmZvck5hbWUKICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgKCJvcmFjbGUuamRiYy5PcmFjbGVQcmVwYXJl\nZFN0YXRlbWVudCIpLgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICBnZXRGaWVsZCgiRk9STV9OQ0hBUiIpLmdldChudWxsKQogICAgICAg\nICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAg\ncmV0dXJuOwogICAgICAgICAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUp\nIHsKICAgICAgICAgICAgICAgICAgICBsb2cud2FybihlKTsKICAgICAgICAg\nICAgICAgIH0KICAgICAgICAgICAgfSBlbHNlIGlmICghX3dhcm5lZE5jaGFy\nQ29sdW1uICYmIGxvZy5pc1dhcm5FbmFibGVkKCkpIHsKICAgICAgICAgICAg\nICAgIF93YXJuZWROY2hhckNvbHVtbiA9IHRydWU7CiAgICAgICAgICAgICAg\nICBsb2cud2FybihfbG9jLmdldCgidW5jb25maWd1cmVkLW5jaGFyLWNvbHMi\nKSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIC8vIGNhbGwg\nc2V0Rml4ZWRDSEFSIGZvciBmaXhlZCB3aWR0aCBjaGFyYWN0ZXIgY29sdW1u\ncyB0byBnZXQgcGFkZGluZwogICAgICAgIC8vIHNlbWFudGljcwogICAgICAg\nIGlmIChjb2wgIT0gbnVsbCAmJiBjb2wuZ2V0VHlwZSgpID09IFR5cGVzLkNI\nQVIKICAgICAgICAgICAgJiYgdmFsICE9IG51bGwgJiYgdmFsLmxlbmd0aCgp\nICE9IGNvbC5nZXRTaXplKCkpIHsKICAgICAgICAgICAgU3RhdGVtZW50IGlu\nbmVyID0gc3RtbnQ7CiAgICAgICAgICAgIGlmIChpbm5lciBpbnN0YW5jZW9m\nIERlbGVnYXRpbmdQcmVwYXJlZFN0YXRlbWVudCkKICAgICAgICAgICAgICAg\nIGlubmVyID0gKChEZWxlZ2F0aW5nUHJlcGFyZWRTdGF0ZW1lbnQpIGlubmVy\nKS4KICAgICAgICAgICAgICAgICAgICBnZXRJbm5lcm1vc3REZWxlZ2F0ZSgp\nOwogICAgICAgICAgICBpZiAoaXNPcmFjbGVQcmVwYXJlZFN0YXRlbWVudChp\nbm5lcikpIHsKICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAg\nICAgICAgaW5uZXIuZ2V0Q2xhc3MoKS5nZXRNZXRob2QoInNldEZpeGVkQ0hB\nUiIsCiAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBDbGFzc1tdeyBpbnQu\nY2xhc3MsIFN0cmluZy5jbGFzcyB9KS4KICAgICAgICAgICAgICAgICAgICAg\nICAgaW52b2tlKGlubmVyLCBuZXcgT2JqZWN0W117IG5ldyBJbnRlZ2VyKGlk\neCksIHZhbCB9KTsKICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAg\nICAgICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkgewogICAgICAgICAg\nICAgICAgICAgIGxvZy53YXJuKGUpOwogICAgICAgICAgICAgICAgfQogICAg\nICAgICAgICB9CgogICAgICAgICAgICBpZiAoIV93YXJuZWRDaGFyQ29sdW1u\nICYmIGxvZy5pc1dhcm5FbmFibGVkKCkpIHsKICAgICAgICAgICAgICAgIF93\nYXJuZWRDaGFyQ29sdW1uID0gdHJ1ZTsKICAgICAgICAgICAgICAgIGxvZy53\nYXJuKF9sb2MuZ2V0KCJ1bnBhZGRlZC1jaGFyLWNvbHMiKSk7CiAgICAgICAg\nICAgIH0KICAgICAgICB9CiAgICAgICAgc3VwZXIuc2V0U3RyaW5nKHN0bW50\nLCBpZHgsIHZhbCwgY29sKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRO\ndWxsKFByZXBhcmVkU3RhdGVtZW50IHN0bW50LCBpbnQgaWR4LCBpbnQgY29s\nVHlwZSwKICAgICAgICBDb2x1bW4gY29sKQogICAgICAgIHRocm93cyBTUUxF\neGNlcHRpb24gewogICAgICAgIGlmIChjb2xUeXBlID09IFR5cGVzLkJMT0Ig\nJiYgX2RyaXZlckJlaGF2aW9yID09IEJFSEFWRV9PUkFDTEUpCiAgICAgICAg\nICAgIHN0bW50LnNldEJsb2IoaWR4LCBnZXRFbXB0eUJsb2IoKSk7CiAgICAg\nICAgZWxzZSBpZiAoY29sVHlwZSA9PSBUeXBlcy5DTE9CICYmIF9kcml2ZXJC\nZWhhdmlvciA9PSBCRUhBVkVfT1JBQ0xFCiAgICAgICAgICAgICYmICFjb2wu\naXNYTUwoKSkKICAgICAgICAgICAgc3RtbnQuc2V0Q2xvYihpZHgsIGdldEVt\ncHR5Q2xvYigpKTsKICAgICAgICBlbHNlIGlmICgoY29sVHlwZSA9PSBUeXBl\ncy5TVFJVQ1QgfHwgY29sVHlwZSA9PSBUeXBlcy5PVEhFUikKICAgICAgICAg\nICAgJiYgY29sICE9IG51bGwgJiYgY29sLmdldFR5cGVOYW1lKCkgIT0gbnVs\nbCkKICAgICAgICAgICAgc3RtbnQuc2V0TnVsbChpZHgsIFR5cGVzLlNUUlVD\nVCwgY29sLmdldFR5cGVOYW1lKCkpOwogICAgICAgICAgICAvLyBzb21lIHZl\ncnNpb25zIG9mIHRoZSBPcmFjbGUgSkRCQyBkcml2ZXIgd2lsbCBmYWlsIGlm\nIGNhbGxpbmcKICAgICAgICAgICAgLy8gc2V0TnVsbCB3aXRoIERBVEU7IHNl\nZSBidWcgIzExNzEKICAgICAgICBlbHNlIGlmIChjb2xUeXBlID09IFR5cGVz\nLkRBVEUpCiAgICAgICAgICAgIHN1cGVyLnNldE51bGwoc3RtbnQsIGlkeCwg\nVHlwZXMuVElNRVNUQU1QLCBjb2wpOwogICAgICAgIC8vIHRoZSBPcmFjbGUg\nZHJpdmVyIGRvZXMgbm90IHN1cHBvcnQgVHlwZXMuT1RIRVIgd2l0aCBzZXRO\ndWxsCiAgICAgICAgZWxzZSBpZiAoY29sVHlwZSA9PSBUeXBlcy5PVEhFUiB8\nfCBjb2wuaXNYTUwoKSkKICAgICAgICAgICAgc3VwZXIuc2V0TnVsbChzdG1u\ndCwgaWR4LCBUeXBlcy5OVUxMLCBjb2wpOwogICAgICAgIGVsc2UKICAgICAg\nICAgICAgc3VwZXIuc2V0TnVsbChzdG1udCwgaWR4LCBjb2xUeXBlLCBjb2wp\nOwogICAgfQoKICAgIHB1YmxpYyBTdHJpbmcgZ2V0Q2xvYlN0cmluZyhSZXN1\nbHRTZXQgcnMsIGludCBjb2x1bW4pCiAgICAgICAgdGhyb3dzIFNRTEV4Y2Vw\ndGlvbiB7CiAgICAgICAgaWYgKF9kcml2ZXJCZWhhdmlvciAhPSBCRUhBVkVf\nT1JBQ0xFKQogICAgICAgICAgICByZXR1cm4gc3VwZXIuZ2V0Q2xvYlN0cmlu\nZyhycywgY29sdW1uKTsKCiAgICAgICAgQ2xvYiBjbG9iID0gZ2V0Q2xvYihy\ncywgY29sdW1uKTsKICAgICAgICBpZiAoY2xvYiA9PSBudWxsKQogICAgICAg\nICAgICByZXR1cm4gbnVsbDsKICAgICAgICBpZiAoY2xvYi5nZXRDbGFzcygp\nLmdldE5hbWUoKS5lcXVhbHMoIm9yYWNsZS5zcWwuQ0xPQiIpKSB7CiAgICAg\nICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBpZiAoKChCb29sZWFuKSBD\nbGFzcy5mb3JOYW1lKCJvcmFjbGUuc3FsLkNMT0IiKS4KICAgICAgICAgICAg\nICAgICAgICBnZXRNZXRob2QoImlzRW1wdHlMb2IiLCBuZXcgQ2xhc3NbMF0p\nLgogICAgICAgICAgICAgICAgICAgIGludm9rZShjbG9iLCBuZXcgT2JqZWN0\nWzBdKSkuCiAgICAgICAgICAgICAgICAgICAgYm9vbGVhblZhbHVlKCkpCiAg\nICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgICAgIH0g\nY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgICAgICAvLyBwb3Nz\naWJseSBkaWZmZXJlbnQgdmVyc2lvbiBvZiB0aGUgZHJpdmVyCiAgICAgICAg\nICAgIH0KICAgICAgICB9CiAgICAgICAgaWYgKGNsb2IubGVuZ3RoKCkgPT0g\nMCkKICAgICAgICAgICAgcmV0dXJuIG51bGw7CgogICAgICAgIC8vIHVubGlr\nZWx5IHRoYXQgd2UnbGwgaGF2ZSBzdHJpbmdzIG92ZXIgNCBiaWxsaW9uIGNo\nYXJzCiAgICAgICAgcmV0dXJuIGNsb2IuZ2V0U3ViU3RyaW5nKDEsIChpbnQp\nIGNsb2IubGVuZ3RoKCkpOwogICAgfQoKICAgIHB1YmxpYyBUaW1lc3RhbXAg\nZ2V0VGltZXN0YW1wKFJlc3VsdFNldCBycywgaW50IGNvbHVtbiwgQ2FsZW5k\nYXIgY2FsKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAg\nIGlmIChjYWwgPT0gbnVsbCkgewogICAgICAgICAgICB0cnkgewogICAgICAg\nICAgICAgICAgcmV0dXJuIHN1cGVyLmdldFRpbWVzdGFtcChycywgY29sdW1u\nLCBjYWwpOwogICAgICAgICAgICB9IGNhdGNoIChBcnJheUluZGV4T3V0T2ZC\nb3VuZHNFeGNlcHRpb24gYWUpIHsKICAgICAgICAgICAgICAgIC8vIENSMjk1\nNjA0OiBpc3N1ZSBhIHdhcm5pbmcgdGhpcyB0aGlzIGJ1ZyBjYW4gYmUgZ290\ndGVuCiAgICAgICAgICAgICAgICAvLyBhcm91bmQgd2l0aCBTdXBwb3J0c1Rp\nbWVzdGFtcE5hbm9zPWZhbHNlCiAgICAgICAgICAgICAgICBsb2cud2Fybihf\nbG9jLmdldCgib3JhY2xlLXRpbWVzdGFtcC1idWciKSwgYWUpOwogICAgICAg\nICAgICAgICAgdGhyb3cgYWU7CiAgICAgICAgICAgIH0KICAgICAgICB9Cgog\nICAgICAgIC8vIGhhbmRsZSBPcmFjbGUgYnVnIHdoZXJlIG5hbm9zIG5vdCBy\nZXR1cm5lZCBmcm9tIGNhbGwgd2l0aCBDYWxlbmRhcgogICAgICAgIC8vIHBh\ncmFtZXRlcgogICAgICAgIFRpbWVzdGFtcCB0cyA9IHJzLmdldFRpbWVzdGFt\ncChjb2x1bW4sIGNhbCk7CiAgICAgICAgaWYgKHRzICE9IG51bGwgJiYgdHMu\nZ2V0TmFub3MoKSA9PSAwKQogICAgICAgICAgICB0cy5zZXROYW5vcyhycy5n\nZXRUaW1lc3RhbXAoY29sdW1uKS5nZXROYW5vcygpKTsKICAgICAgICByZXR1\ncm4gdHM7CiAgICB9CgogICAgcHVibGljIE9iamVjdCBnZXRPYmplY3QoUmVz\ndWx0U2V0IHJzLCBpbnQgY29sdW1uLCBNYXAgbWFwKQogICAgICAgIHRocm93\ncyBTUUxFeGNlcHRpb24gewogICAgICAgIC8vIHJlY2VudCBvcmFjbGUgZHJp\ndmVycyByZXR1cm4gb3JhY2xlLXNwZWNpZmljIHR5cGVzIGZvciB0aW1lc3Rh\nbXBzCiAgICAgICAgLy8gYW5kIGRhdGVzCiAgICAgICAgT2JqZWN0IG9iaiA9\nIHN1cGVyLmdldE9iamVjdChycywgY29sdW1uLCBtYXApOwogICAgICAgIGlm\nIChvYmogPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAg\nICAgaWYgKCJvcmFjbGUuc3FsLkRBVEUiLmVxdWFscyhvYmouZ2V0Q2xhc3Mo\nKS5nZXROYW1lKCkpKQogICAgICAgICAgICBvYmogPSBjb252ZXJ0RnJvbU9y\nYWNsZVR5cGUob2JqLCAiZGF0ZVZhbHVlIik7CiAgICAgICAgZWxzZSBpZiAo\nIm9yYWNsZS5zcWwuVElNRVNUQU1QIi5lcXVhbHMob2JqLmdldENsYXNzKCku\nZ2V0TmFtZSgpKSkKICAgICAgICAgICAgb2JqID0gY29udmVydEZyb21PcmFj\nbGVUeXBlKG9iaiwgInRpbWVzdGFtcFZhbHVlIik7CiAgICAgICAgcmV0dXJu\nIG9iajsKICAgIH0KCiAgICAvKioKICAgICAqIENvbnZlcnQgYW4gb2JqZWN0\nIGZyb20gaXRzIHByb3ByaWV0YXJ5IE9yYWNsZSB0eXBlIHRvIHRoZSBzdGFu\nZGFyZAogICAgICogSmF2YSB0eXBlLgogICAgICovCiAgICBwcml2YXRlIHN0\nYXRpYyBPYmplY3QgY29udmVydEZyb21PcmFjbGVUeXBlKE9iamVjdCBvYmos\nCiAgICAgICAgU3RyaW5nIGNvbnZlcnRNZXRob2QpCiAgICAgICAgdGhyb3dz\nIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgTWV0\naG9kIG0gPSBvYmouZ2V0Q2xhc3MoKS5nZXRNZXRob2QoY29udmVydE1ldGhv\nZCwgKENsYXNzW10pIG51bGwpOwogICAgICAgICAgICByZXR1cm4gbS5pbnZv\na2Uob2JqLCAoT2JqZWN0W10pIG51bGwpOwogICAgICAgIH0gY2F0Y2ggKFRo\ncm93YWJsZSB0KSB7CiAgICAgICAgICAgIGlmICh0IGluc3RhbmNlb2YgSW52\nb2NhdGlvblRhcmdldEV4Y2VwdGlvbikKICAgICAgICAgICAgICAgIHQgPSAo\nKEludm9jYXRpb25UYXJnZXRFeGNlcHRpb24pIHQpLmdldFRhcmdldEV4Y2Vw\ndGlvbigpOwogICAgICAgICAgICBpZiAodCBpbnN0YW5jZW9mIFNRTEV4Y2Vw\ndGlvbikKICAgICAgICAgICAgICAgIHRocm93KFNRTEV4Y2VwdGlvbikgdDsK\nICAgICAgICAgICAgdGhyb3cgbmV3IFNRTEV4Y2VwdGlvbih0LmdldE1lc3Nh\nZ2UoKSk7CiAgICAgICAgfQogICAgfQoKICAgIHB1YmxpYyBDb2x1bW5bXSBn\nZXRDb2x1bW5zKERhdGFiYXNlTWV0YURhdGEgbWV0YSwgU3RyaW5nIGNhdGFs\nb2csCiAgICAgICAgU3RyaW5nIHNjaGVtYU5hbWUsIFN0cmluZyB0YWJsZU5h\nbWUsIFN0cmluZyBjb2x1bW5OYW1lLCBDb25uZWN0aW9uIGNvbm4pCiAgICAg\nICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgQ29sdW1uW10gY29s\ncyA9IHN1cGVyLmdldENvbHVtbnMobWV0YSwgY2F0YWxvZywgc2NoZW1hTmFt\nZSwgdGFibGVOYW1lLAogICAgICAgICAgICBjb2x1bW5OYW1lLCBjb25uKTsK\nCiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGNvbHMgIT0gbnVsbCAmJiBpIDwg\nY29scy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBpZiAoY29sc1tpXS5n\nZXRUeXBlTmFtZSgpID09IG51bGwpCiAgICAgICAgICAgICAgICBjb250aW51\nZTsKICAgICAgICAgICAgaWYgKGNvbHNbaV0uZ2V0VHlwZU5hbWUoKS50b1Vw\ncGVyQ2FzZSgpLnN0YXJ0c1dpdGgoIlRJTUVTVEFNUCIpKQogICAgICAgICAg\nICAgICAgY29sc1tpXS5zZXRUeXBlKFR5cGVzLlRJTUVTVEFNUCk7CiAgICAg\nICAgICAgIGVsc2UgaWYgKCJCTE9CIi5lcXVhbHNJZ25vcmVDYXNlKGNvbHNb\naV0uZ2V0VHlwZU5hbWUoKSkpCiAgICAgICAgICAgICAgICBjb2xzW2ldLnNl\ndFR5cGUoVHlwZXMuQkxPQik7CiAgICAgICAgICAgIGVsc2UgaWYgKCJDTE9C\nIi5lcXVhbHNJZ25vcmVDYXNlKGNvbHNbaV0uZ2V0VHlwZU5hbWUoKSkKICAg\nICAgICAgICAgICAgIHx8ICJOQ0xPQiIuZXF1YWxzSWdub3JlQ2FzZShjb2xz\nW2ldLmdldFR5cGVOYW1lKCkpKQogICAgICAgICAgICAgICAgY29sc1tpXS5z\nZXRUeXBlKFR5cGVzLkNMT0IpOwogICAgICAgICAgICBlbHNlIGlmICgiRkxP\nQVQiLmVxdWFsc0lnbm9yZUNhc2UoY29sc1tpXS5nZXRUeXBlTmFtZSgpKSkK\nICAgICAgICAgICAgICAgIGNvbHNbaV0uc2V0VHlwZShUeXBlcy5GTE9BVCk7\nCiAgICAgICAgICAgIGVsc2UgaWYgKCJOVkFSQ0hBUiIuZXF1YWxzSWdub3Jl\nQ2FzZShjb2xzW2ldLmdldFR5cGVOYW1lKCkpKQogICAgICAgICAgICAgICAg\nY29sc1tpXS5zZXRUeXBlKFR5cGVzLlZBUkNIQVIpOwogICAgICAgICAgICBl\nbHNlIGlmICgiTkNIQVIiLmVxdWFsc0lnbm9yZUNhc2UoY29sc1tpXS5nZXRU\neXBlTmFtZSgpKSkKICAgICAgICAgICAgICAgIGNvbHNbaV0uc2V0VHlwZShU\neXBlcy5DSEFSKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGNvbHM7CiAg\nICB9CgogICAgcHVibGljIFByaW1hcnlLZXlbXSBnZXRQcmltYXJ5S2V5cyhE\nYXRhYmFzZU1ldGFEYXRhIG1ldGEsCiAgICAgICAgU3RyaW5nIGNhdGFsb2cs\nIFN0cmluZyBzY2hlbWFOYW1lLCBTdHJpbmcgdGFibGVOYW1lLCBDb25uZWN0\naW9uIGNvbm4pCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAg\nICAgU3RyaW5nQnVmZmVyIGJ1ZiA9IG5ldyBTdHJpbmdCdWZmZXIoKTsKICAg\nICAgICBidWYuYXBwZW5kKCJTRUxFQ1QgdDAuT1dORVIgQVMgVEFCTEVfU0NI\nRU0sICIpLgogICAgICAgICAgICBhcHBlbmQoInQwLlRBQkxFX05BTUUgQVMg\nVEFCTEVfTkFNRSwgIikuCiAgICAgICAgICAgIGFwcGVuZCgidDAuQ09MVU1O\nX05BTUUgQVMgQ09MVU1OX05BTUUsICIpLgogICAgICAgICAgICBhcHBlbmQo\nInQwLkNPTlNUUkFJTlRfTkFNRSBBUyBQS19OQU1FICIpLgogICAgICAgICAg\nICBhcHBlbmQoIkZST00gQUxMX0NPTlNfQ09MVU1OUyB0MCwgQUxMX0NPTlNU\nUkFJTlRTIHQxICIpLgogICAgICAgICAgICBhcHBlbmQoIldIRVJFIHQwLk9X\nTkVSID0gdDEuT1dORVIgIikuCiAgICAgICAgICAgIGFwcGVuZCgiQU5EIHQw\nLkNPTlNUUkFJTlRfTkFNRSA9IHQxLkNPTlNUUkFJTlRfTkFNRSAiKS4KICAg\nICAgICAgICAgYXBwZW5kKCJBTkQgdDEuQ09OU1RSQUlOVF9UWVBFID0gJ1An\nIik7CiAgICAgICAgaWYgKHNjaGVtYU5hbWUgIT0gbnVsbCkKICAgICAgICAg\nICAgYnVmLmFwcGVuZCgiIEFORCB0MC5PV05FUiA9ID8iKTsKICAgICAgICBp\nZiAodGFibGVOYW1lICE9IG51bGwpCiAgICAgICAgICAgIGJ1Zi5hcHBlbmQo\nIiBBTkQgdDAuVEFCTEVfTkFNRSA9ID8iKTsKCiAgICAgICAgUHJlcGFyZWRT\ndGF0ZW1lbnQgc3RtbnQgPSBjb25uLnByZXBhcmVTdGF0ZW1lbnQoYnVmLnRv\nU3RyaW5nKCkpOwogICAgICAgIFJlc3VsdFNldCBycyA9IG51bGw7CiAgICAg\nICAgdHJ5IHsKICAgICAgICAgICAgaW50IGlkeCA9IDE7CiAgICAgICAgICAg\nIGlmIChzY2hlbWFOYW1lICE9IG51bGwpCiAgICAgICAgICAgICAgICBzZXRT\ndHJpbmcoc3RtbnQsIGlkeCsrLCBzY2hlbWFOYW1lLnRvVXBwZXJDYXNlKCks\nIG51bGwpOwogICAgICAgICAgICBpZiAodGFibGVOYW1lICE9IG51bGwpCiAg\nICAgICAgICAgICAgICBzZXRTdHJpbmcoc3RtbnQsIGlkeCsrLCB0YWJsZU5h\nbWUudG9VcHBlckNhc2UoKSwgbnVsbCk7CgogICAgICAgICAgICBycyA9IHN0\nbW50LmV4ZWN1dGVRdWVyeSgpOwogICAgICAgICAgICBMaXN0IHBrTGlzdCA9\nIG5ldyBBcnJheUxpc3QoKTsKICAgICAgICAgICAgd2hpbGUgKHJzICE9IG51\nbGwgJiYgcnMubmV4dCgpKQogICAgICAgICAgICAgICAgcGtMaXN0LmFkZChu\nZXdQcmltYXJ5S2V5KHJzKSk7CiAgICAgICAgICAgIHJldHVybiAoUHJpbWFy\neUtleVtdKSBwa0xpc3QudG9BcnJheQogICAgICAgICAgICAgICAgKG5ldyBQ\ncmltYXJ5S2V5W3BrTGlzdC5zaXplKCldKTsKICAgICAgICB9IGZpbmFsbHkg\newogICAgICAgICAgICBpZiAocnMgIT0gbnVsbCkKICAgICAgICAgICAgICAg\nIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgcnMuY2xvc2UoKTsKICAgICAg\nICAgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAg\nICAgICB9CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBzdG1u\ndC5jbG9zZSgpOwogICAgICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkg\newogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQoKICAgIHB1YmxpYyBJ\nbmRleFtdIGdldEluZGV4SW5mbyhEYXRhYmFzZU1ldGFEYXRhIG1ldGEsIFN0\ncmluZyBjYXRhbG9nLAogICAgICAgIFN0cmluZyBzY2hlbWFOYW1lLCBTdHJp\nbmcgdGFibGVOYW1lLCBib29sZWFuIHVuaXF1ZSwgYm9vbGVhbiBhcHByb3gs\nCiAgICAgICAgQ29ubmVjdGlvbiBjb25uKQogICAgICAgIHRocm93cyBTUUxF\neGNlcHRpb24gewogICAgICAgIFN0cmluZ0J1ZmZlciBidWYgPSBuZXcgU3Ry\naW5nQnVmZmVyKCk7CiAgICAgICAgYnVmLmFwcGVuZCgiU0VMRUNUIHQwLklO\nREVYX09XTkVSIEFTIFRBQkxFX1NDSEVNLCAiKS4KICAgICAgICAgICAgYXBw\nZW5kKCJ0MC5UQUJMRV9OQU1FIEFTIFRBQkxFX05BTUUsICIpLgogICAgICAg\nICAgICBhcHBlbmQoIkRFQ09ERSh0MS5VTklRVUVORVNTLCAnVU5JUVVFJywg\nMCwgJ05PTlVOSVFVRScsIDEpICIpLgogICAgICAgICAgICBhcHBlbmQoIkFT\nIE5PTl9VTklRVUUsICIpLgogICAgICAgICAgICBhcHBlbmQoInQwLklOREVY\nX05BTUUgQVMgSU5ERVhfTkFNRSwgIikuCiAgICAgICAgICAgIGFwcGVuZCgi\ndDAuQ09MVU1OX05BTUUgQVMgQ09MVU1OX05BTUUgIikuCiAgICAgICAgICAg\nIGFwcGVuZCgiRlJPTSBBTExfSU5EX0NPTFVNTlMgdDAsIEFMTF9JTkRFWEVT\nIHQxICIpLgogICAgICAgICAgICBhcHBlbmQoIldIRVJFIHQwLklOREVYX09X\nTkVSID0gdDEuT1dORVIgIikuCiAgICAgICAgICAgIGFwcGVuZCgiQU5EIHQw\nLklOREVYX05BTUUgPSB0MS5JTkRFWF9OQU1FIik7CiAgICAgICAgaWYgKHNj\naGVtYU5hbWUgIT0gbnVsbCkKICAgICAgICAgICAgYnVmLmFwcGVuZCgiIEFO\nRCB0MC5UQUJMRV9PV05FUiA9ID8iKTsKICAgICAgICBpZiAodGFibGVOYW1l\nICE9IG51bGwpCiAgICAgICAgICAgIGJ1Zi5hcHBlbmQoIiBBTkQgdDAuVEFC\nTEVfTkFNRSA9ID8iKTsKCiAgICAgICAgUHJlcGFyZWRTdGF0ZW1lbnQgc3Rt\nbnQgPSBjb25uLnByZXBhcmVTdGF0ZW1lbnQoYnVmLnRvU3RyaW5nKCkpOwog\nICAgICAgIFJlc3VsdFNldCBycyA9IG51bGw7CiAgICAgICAgdHJ5IHsKICAg\nICAgICAgICAgaW50IGlkeCA9IDE7CiAgICAgICAgICAgIGlmIChzY2hlbWFO\nYW1lICE9IG51bGwpCiAgICAgICAgICAgICAgICBzZXRTdHJpbmcoc3RtbnQs\nIGlkeCsrLCBzY2hlbWFOYW1lLnRvVXBwZXJDYXNlKCksIG51bGwpOwogICAg\nICAgICAgICBpZiAodGFibGVOYW1lICE9IG51bGwpCiAgICAgICAgICAgICAg\nICBzZXRTdHJpbmcoc3RtbnQsIGlkeCsrLCB0YWJsZU5hbWUudG9VcHBlckNh\nc2UoKSwgbnVsbCk7CgogICAgICAgICAgICBycyA9IHN0bW50LmV4ZWN1dGVR\ndWVyeSgpOwogICAgICAgICAgICBMaXN0IGlkeExpc3QgPSBuZXcgQXJyYXlM\naXN0KCk7CiAgICAgICAgICAgIHdoaWxlIChycyAhPSBudWxsICYmIHJzLm5l\neHQoKSkKICAgICAgICAgICAgICAgIGlkeExpc3QuYWRkKG5ld0luZGV4KHJz\nKSk7CiAgICAgICAgICAgIHJldHVybiAoSW5kZXhbXSkgaWR4TGlzdC50b0Fy\ncmF5KG5ldyBJbmRleFtpZHhMaXN0LnNpemUoKV0pOwogICAgICAgIH0gZmlu\nYWxseSB7CiAgICAgICAgICAgIGlmIChycyAhPSBudWxsKQogICAgICAgICAg\nICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICBycy5jbG9zZSgpOwog\nICAgICAgICAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAgICAg\nICAgICAgICAgIH0KICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAg\nIHN0bW50LmNsb3NlKCk7CiAgICAgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlv\nbiBlKSB7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgcHVi\nbGljIEZvcmVpZ25LZXlbXSBnZXRJbXBvcnRlZEtleXMoRGF0YWJhc2VNZXRh\nRGF0YSBtZXRhLCBTdHJpbmcgY2F0YWxvZywKICAgICAgICBTdHJpbmcgc2No\nZW1hTmFtZSwgU3RyaW5nIHRhYmxlTmFtZSwgQ29ubmVjdGlvbiBjb25uKQog\nICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIFN0cmluZ0J1\nZmZlciBkZWxBY3Rpb24gPSBuZXcgU3RyaW5nQnVmZmVyKCJERUNPREUodDEu\nREVMRVRFX1JVTEUiKS4KICAgICAgICAgICAgYXBwZW5kKCIsICdOTyBBQ1RJ\nT04nLCAiKS5hcHBlbmQobWV0YS5pbXBvcnRlZEtleU5vQWN0aW9uKS4KICAg\nICAgICAgICAgYXBwZW5kKCIsICdSRVNUUklDVCcsICIpLmFwcGVuZChtZXRh\nLmltcG9ydGVkS2V5UmVzdHJpY3QpLgogICAgICAgICAgICBhcHBlbmQoIiwg\nJ0NBU0NBREUnLCAiKS5hcHBlbmQobWV0YS5pbXBvcnRlZEtleUNhc2NhZGUp\nLgogICAgICAgICAgICBhcHBlbmQoIiwgJ1NFVCBOVUxMJywgIikuYXBwZW5k\nKG1ldGEuaW1wb3J0ZWRLZXlTZXROdWxsKS4KICAgICAgICAgICAgYXBwZW5k\nKCIsICdTRVQgREVGQVVMVCcsICIpLmFwcGVuZChtZXRhLmltcG9ydGVkS2V5\nU2V0RGVmYXVsdCkuCiAgICAgICAgICAgIGFwcGVuZCgiKSIpOwoKICAgICAg\nICBTdHJpbmdCdWZmZXIgYnVmID0gbmV3IFN0cmluZ0J1ZmZlcigpOwogICAg\nICAgIGJ1Zi5hcHBlbmQoIlNFTEVDVCB0Mi5PV05FUiBBUyBQS1RBQkxFX1ND\nSEVNLCAiKS4KICAgICAgICAgICAgYXBwZW5kKCJ0Mi5UQUJMRV9OQU1FIEFT\nIFBLVEFCTEVfTkFNRSwgIikuCiAgICAgICAgICAgIGFwcGVuZCgidDIuQ09M\nVU1OX05BTUUgQVMgUEtDT0xVTU5fTkFNRSwgIikuCiAgICAgICAgICAgIGFw\ncGVuZCgidDAuT1dORVIgQVMgRktUQUJMRV9TQ0hFTSwgIikuCiAgICAgICAg\nICAgIGFwcGVuZCgidDAuVEFCTEVfTkFNRSBBUyBGS1RBQkxFX05BTUUsICIp\nLgogICAgICAgICAgICBhcHBlbmQoInQwLkNPTFVNTl9OQU1FIEFTIEZLQ09M\nVU1OX05BTUUsICIpLgogICAgICAgICAgICBhcHBlbmQoInQwLlBPU0lUSU9O\nIEFTIEtFWV9TRVEsICIpLgogICAgICAgICAgICBhcHBlbmQoZGVsQWN0aW9u\nKS5hcHBlbmQoIiBBUyBERUxFVEVfUlVMRSwgIikuCiAgICAgICAgICAgIGFw\ncGVuZCgidDAuQ09OU1RSQUlOVF9OQU1FIEFTIEZLX05BTUUsICIpLgogICAg\nICAgICAgICBhcHBlbmQoIkRFQ09ERSh0MS5ERUZFUlJFRCwgJ0RFRkVSUkVE\nJywgIikuCiAgICAgICAgICAgIGFwcGVuZChtZXRhLmltcG9ydGVkS2V5SW5p\ndGlhbGx5RGVmZXJyZWQpLgogICAgICAgICAgICBhcHBlbmQoIiwgJ0lNTUVE\nSUFURScsICIpLgogICAgICAgICAgICBhcHBlbmQobWV0YS5pbXBvcnRlZEtl\neUluaXRpYWxseUltbWVkaWF0ZSkuCiAgICAgICAgICAgIGFwcGVuZCgiKSBB\nUyBERUZFUlJBQklMSVRZICIpLgogICAgICAgICAgICBhcHBlbmQoIkZST00g\nQUxMX0NPTlNfQ09MVU1OUyB0MCwgQUxMX0NPTlNUUkFJTlRTIHQxLCAiKS4K\nICAgICAgICAgICAgYXBwZW5kKCJBTExfQ09OU19DT0xVTU5TIHQyICIpLgog\nICAgICAgICAgICBhcHBlbmQoIldIRVJFIHQwLk9XTkVSID0gdDEuT1dORVIg\nIikuCiAgICAgICAgICAgIGFwcGVuZCgiQU5EIHQwLkNPTlNUUkFJTlRfTkFN\nRSA9IHQxLkNPTlNUUkFJTlRfTkFNRSAiKS4KICAgICAgICAgICAgYXBwZW5k\nKCJBTkQgdDEuQ09OU1RSQUlOVF9UWVBFID0gJ1InICIpLgogICAgICAgICAg\nICBhcHBlbmQoIkFORCB0MS5SX09XTkVSID0gdDIuT1dORVIgIikuCiAgICAg\nICAgICAgIGFwcGVuZCgiQU5EIHQxLlJfQ09OU1RSQUlOVF9OQU1FID0gdDIu\nQ09OU1RSQUlOVF9OQU1FICIpLgogICAgICAgICAgICBhcHBlbmQoIkFORCB0\nMC5QT1NJVElPTiA9IHQyLlBPU0lUSU9OIik7CiAgICAgICAgaWYgKHNjaGVt\nYU5hbWUgIT0gbnVsbCkKICAgICAgICAgICAgYnVmLmFwcGVuZCgiIEFORCB0\nMC5PV05FUiA9ID8iKTsKICAgICAgICBpZiAodGFibGVOYW1lICE9IG51bGwp\nCiAgICAgICAgICAgIGJ1Zi5hcHBlbmQoIiBBTkQgdDAuVEFCTEVfTkFNRSA9\nID8iKTsKICAgICAgICBidWYuYXBwZW5kKCIgT1JERVIgQlkgdDIuT1dORVIs\nIHQyLlRBQkxFX05BTUUsIHQwLlBPU0lUSU9OIik7CgogICAgICAgIFByZXBh\ncmVkU3RhdGVtZW50IHN0bW50ID0gY29ubi5wcmVwYXJlU3RhdGVtZW50KGJ1\nZi50b1N0cmluZygpKTsKICAgICAgICBSZXN1bHRTZXQgcnMgPSBudWxsOwog\nICAgICAgIHRyeSB7CiAgICAgICAgICAgIGludCBpZHggPSAxOwogICAgICAg\nICAgICBpZiAoc2NoZW1hTmFtZSAhPSBudWxsKQogICAgICAgICAgICAgICAg\nc2V0U3RyaW5nKHN0bW50LCBpZHgrKywgc2NoZW1hTmFtZS50b1VwcGVyQ2Fz\nZSgpLCBudWxsKTsKICAgICAgICAgICAgaWYgKHRhYmxlTmFtZSAhPSBudWxs\nKQogICAgICAgICAgICAgICAgc2V0U3RyaW5nKHN0bW50LCBpZHgrKywgdGFi\nbGVOYW1lLnRvVXBwZXJDYXNlKCksIG51bGwpOwoKICAgICAgICAgICAgcnMg\nPSBzdG1udC5leGVjdXRlUXVlcnkoKTsKICAgICAgICAgICAgTGlzdCBma0xp\nc3QgPSBuZXcgQXJyYXlMaXN0KCk7CiAgICAgICAgICAgIHdoaWxlIChycyAh\nPSBudWxsICYmIHJzLm5leHQoKSkKICAgICAgICAgICAgICAgIGZrTGlzdC5h\nZGQobmV3Rm9yZWlnbktleShycykpOwogICAgICAgICAgICByZXR1cm4gKEZv\ncmVpZ25LZXlbXSkgZmtMaXN0LnRvQXJyYXkKICAgICAgICAgICAgICAgIChu\nZXcgRm9yZWlnbktleVtma0xpc3Quc2l6ZSgpXSk7CiAgICAgICAgfSBmaW5h\nbGx5IHsKICAgICAgICAgICAgaWYgKHJzICE9IG51bGwpCiAgICAgICAgICAg\nICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgIHJzLmNsb3NlKCk7CiAg\nICAgICAgICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkgewogICAgICAg\nICAgICAgICAgfQogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAg\nc3RtbnQuY2xvc2UoKTsKICAgICAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9u\nIGUpIHsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICBwdWJs\naWMgU3RyaW5nW10gZ2V0Q3JlYXRlVGFibGVTUUwoVGFibGUgdGFibGUpIHsK\nICAgICAgICAvLyBvbmx5IG92ZXJyaWRlIGlmIHdlIGFyZSBzaW11bGF0aW5n\nIGF1dG8taW5jcmVtZW5ldCB3aXRoIHRyaWdnZXJzCiAgICAgICAgU3RyaW5n\nW10gY3JlYXRlID0gc3VwZXIuZ2V0Q3JlYXRlVGFibGVTUUwodGFibGUpOwog\nICAgICAgIGlmICghdXNlVHJpZ2dlcnNGb3JBdXRvQXNzaWduKQogICAgICAg\nICAgICByZXR1cm4gY3JlYXRlOwoKICAgICAgICBDb2x1bW5bXSBjb2xzID0g\ndGFibGUuZ2V0Q29sdW1ucygpOwogICAgICAgIExpc3Qgc2VxcyA9IG51bGw7\nCiAgICAgICAgU3RyaW5nIHNlcSwgdHJpZzsKICAgICAgICBmb3IgKGludCBp\nID0gMDsgY29scyAhPSBudWxsICYmIGkgPCBjb2xzLmxlbmd0aDsgaSsrKSB7\nCiAgICAgICAgICAgIGlmICghY29sc1tpXS5pc0F1dG9Bc3NpZ25lZCgpKQog\nICAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgIGlmIChzZXFz\nID09IG51bGwpCiAgICAgICAgICAgICAgICBzZXFzID0gbmV3IEFycmF5TGlz\ndCg0KTsKCiAgICAgICAgICAgIHNlcSA9IGF1dG9Bc3NpZ25TZXF1ZW5jZU5h\nbWU7CiAgICAgICAgICAgIGlmIChzZXEgPT0gbnVsbCkgewogICAgICAgICAg\nICAgICAgaWYgKG9wZW5qcGEzR2VuZXJhdGVkS2V5TmFtZXMpCiAgICAgICAg\nICAgICAgICAgICAgc2VxID0gZ2V0T3BlbkpQQTNHZW5lcmF0ZWRLZXlTZXF1\nZW5jZU5hbWUoY29sc1tpXSk7CiAgICAgICAgICAgICAgICBlbHNlCiAgICAg\nICAgICAgICAgICAgICAgc2VxID0gZ2V0R2VuZXJhdGVkS2V5U2VxdWVuY2VO\nYW1lKGNvbHNbaV0pOwogICAgICAgICAgICAgICAgc2Vxcy5hZGQoIkNSRUFU\nRSBTRVFVRU5DRSAiICsgc2VxICsgIiBTVEFSVCBXSVRIIDEiKTsKICAgICAg\nICAgICAgfQogICAgICAgICAgICBpZiAob3BlbmpwYTNHZW5lcmF0ZWRLZXlO\nYW1lcykKICAgICAgICAgICAgICAgIHRyaWcgPSBnZXRPcGVuSlBBM0dlbmVy\nYXRlZEtleVRyaWdnZXJOYW1lKGNvbHNbaV0pOwogICAgICAgICAgICBlbHNl\nCiAgICAgICAgICAgICAgICB0cmlnID0gZ2V0R2VuZXJhdGVkS2V5VHJpZ2dl\nck5hbWUoY29sc1tpXSk7CgogICAgICAgICAgICAvLyBjcmVhdGUgdGhlIHRy\naWdnZXIgdGhhdCB3aWxsIGluc2VydCBuZXcgdmFsdWVzIGludG8KICAgICAg\nICAgICAgLy8gdGhlIHRhYmxlIHdoZW5ldmVyIGEgcm93IGlzIGNyZWF0ZWQK\nICAgICAgICAgICAgc2Vxcy5hZGQoIkNSRUFURSBPUiBSRVBMQUNFIFRSSUdH\nRVIgIiArIHRyaWcKICAgICAgICAgICAgICAgICsgIiBCRUZPUkUgSU5TRVJU\nIE9OICIgKyB0YWJsZS5nZXROYW1lKCkKICAgICAgICAgICAgICAgICsgIiBG\nT1IgRUFDSCBST1cgQkVHSU4gU0VMRUNUICIgKyBzZXEgKyAiLm5leHR2YWwg\nSU5UTyAiCiAgICAgICAgICAgICAgICArICI6bmV3LiIgKyBjb2xzW2ldLmdl\ndE5hbWUoKSArICIgRlJPTSBEVUFMOyAiCiAgICAgICAgICAgICAgICArICJF\nTkQgIiArIHRyaWcgKyAiOyIpOwogICAgICAgIH0KICAgICAgICBpZiAoc2Vx\ncyA9PSBudWxsKQogICAgICAgICAgICByZXR1cm4gY3JlYXRlOwoKICAgICAg\nICAvLyBjb21iaW5lIGNyZWF0ZSB0YWJsZSBzcWwgYW5kIGNyZWF0ZSBzZXFl\nbmNlcyBzcWwKICAgICAgICBTdHJpbmdbXSBzcWwgPSBuZXcgU3RyaW5nW2Ny\nZWF0ZS5sZW5ndGggKyBzZXFzLnNpemUoKV07CiAgICAgICAgU3lzdGVtLmFy\ncmF5Y29weShjcmVhdGUsIDAsIHNxbCwgMCwgY3JlYXRlLmxlbmd0aCk7CiAg\nICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBzZXFzLnNpemUoKTsgaSsrKQog\nICAgICAgICAgICBzcWxbY3JlYXRlLmxlbmd0aCArIGldID0gKFN0cmluZykg\nc2Vxcy5nZXQoaSk7CiAgICAgICAgcmV0dXJuIHNxbDsKICAgIH0KCiAgICBw\ndWJsaWMgU3RyaW5nW10gZ2V0Q3JlYXRlU2VxdWVuY2VTUUwoU2VxdWVuY2Ug\nc2VxKSB7CiAgICAgICAgU3RyaW5nW10gc3FsID0gc3VwZXIuZ2V0Q3JlYXRl\nU2VxdWVuY2VTUUwoc2VxKTsKICAgICAgICBpZiAoc2VxLmdldEFsbG9jYXRl\nKCkgPiAxKQogICAgICAgICAgICBzcWxbMF0gKz0gIiBDQUNIRSAiICsgc2Vx\nLmdldEFsbG9jYXRlKCk7CiAgICAgICAgcmV0dXJuIHNxbDsKICAgIH0KCiAg\nICBwcm90ZWN0ZWQgU3RyaW5nIGdldFNlcXVlbmNlc1NRTChTdHJpbmcgc2No\nZW1hTmFtZSwgU3RyaW5nIHNlcXVlbmNlTmFtZSkgewogICAgICAgIFN0cmlu\nZ0J1ZmZlciBidWYgPSBuZXcgU3RyaW5nQnVmZmVyKCk7CiAgICAgICAgYnVm\nLmFwcGVuZCgiU0VMRUNUIFNFUVVFTkNFX09XTkVSIEFTIFNFUVVFTkNFX1ND\nSEVNQSwgIikuCiAgICAgICAgICAgIGFwcGVuZCgiU0VRVUVOQ0VfTkFNRSBG\nUk9NIEFMTF9TRVFVRU5DRVMiKTsKICAgICAgICBpZiAoc2NoZW1hTmFtZSAh\nPSBudWxsIHx8IHNlcXVlbmNlTmFtZSAhPSBudWxsKQogICAgICAgICAgICBi\ndWYuYXBwZW5kKCIgV0hFUkUgIik7CiAgICAgICAgaWYgKHNjaGVtYU5hbWUg\nIT0gbnVsbCkgewogICAgICAgICAgICBidWYuYXBwZW5kKCJTRVFVRU5DRV9P\nV05FUiA9ID8iKTsKICAgICAgICAgICAgaWYgKHNlcXVlbmNlTmFtZSAhPSBu\ndWxsKQogICAgICAgICAgICAgICAgYnVmLmFwcGVuZCgiIEFORCAiKTsKICAg\nICAgICB9CiAgICAgICAgaWYgKHNlcXVlbmNlTmFtZSAhPSBudWxsKQogICAg\nICAgICAgICBidWYuYXBwZW5kKCJTRVFVRU5DRV9OQU1FID0gPyIpOwogICAg\nICAgIHJldHVybiBidWYudG9TdHJpbmcoKTsKICAgIH0KCiAgICBwdWJsaWMg\nYm9vbGVhbiBpc1N5c3RlbVNlcXVlbmNlKFN0cmluZyBuYW1lLCBTdHJpbmcg\nc2NoZW1hLAogICAgICAgIGJvb2xlYW4gdGFyZ2V0U2NoZW1hKSB7CiAgICAg\nICAgaWYgKHN1cGVyLmlzU3lzdGVtU2VxdWVuY2UobmFtZSwgc2NoZW1hLCB0\nYXJnZXRTY2hlbWEpKQogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKCiAgICAg\nICAgLy8gZmlsdGVyIG91dCBnZW5lcmF0ZWQgc2VxdWVuY2VzIHVzZWQgZm9y\nIGF1dG8tYXNzaWduCiAgICAgICAgcmV0dXJuIChhdXRvQXNzaWduU2VxdWVu\nY2VOYW1lICE9IG51bGwKICAgICAgICAgICAgJiYgbmFtZS5lcXVhbHNJZ25v\ncmVDYXNlKGF1dG9Bc3NpZ25TZXF1ZW5jZU5hbWUpKQogICAgICAgICAgICB8\nfCAoYXV0b0Fzc2lnblNlcXVlbmNlTmFtZSA9PSBudWxsCiAgICAgICAgICAg\nICYmIG5hbWUudG9VcHBlckNhc2UoKS5zdGFydHNXaXRoKCJTVF8iKSk7CiAg\nICB9CgogICAgcHVibGljIE9iamVjdCBnZXRHZW5lcmF0ZWRLZXkoQ29sdW1u\nIGNvbCwgQ29ubmVjdGlvbiBjb25uKQogICAgICAgIHRocm93cyBTUUxFeGNl\ncHRpb24gewogICAgICAgIGlmICghdXNlVHJpZ2dlcnNGb3JBdXRvQXNzaWdu\nKQogICAgICAgICAgICByZXR1cm4gTnVtYmVycy52YWx1ZU9mKDBMKTsKCiAg\nICAgICAgLy8gaWYgd2Ugc2ltdWxhdGUgYXV0by1hc3NpZ25lZCBjb2x1bW5z\nIHVzaW5nIHRyaWdnZXJzIGFuZAogICAgICAgIC8vIHNlcXVlbmNlcywgdGhl\nbiByZXR1cm4gdGhlIGN1cnJlbnQgdmFsdWUgb2YgdGhlIHNlcXVlbmNlCiAg\nICAgICAgLy8gZnJvbSBhdXRvQXNzaWduU2VxdWVuY2VOYW1lCiAgICAgICAg\nU3RyaW5nIHNlcSA9IGF1dG9Bc3NpZ25TZXF1ZW5jZU5hbWU7CiAgICAgICAg\naWYgKHNlcSA9PSBudWxsICYmIG9wZW5qcGEzR2VuZXJhdGVkS2V5TmFtZXMp\nCiAgICAgICAgICAgIHNlcSA9IGdldE9wZW5KUEEzR2VuZXJhdGVkS2V5U2Vx\ndWVuY2VOYW1lKGNvbCk7CiAgICAgICAgZWxzZSBpZiAoc2VxID09IG51bGwp\nCiAgICAgICAgICAgIHNlcSA9IGdldEdlbmVyYXRlZEtleVNlcXVlbmNlTmFt\nZShjb2wpOwogICAgICAgIFByZXBhcmVkU3RhdGVtZW50IHN0bW50ID0gY29u\nbi5wcmVwYXJlU3RhdGVtZW50KCJTRUxFQ1QgIiArIHNlcQogICAgICAgICAg\nICArICIuY3VycnZhbCBGUk9NIERVQUwiKTsKICAgICAgICBSZXN1bHRTZXQg\ncnMgPSBudWxsOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIHJzID0gc3Rt\nbnQuZXhlY3V0ZVF1ZXJ5KCk7CiAgICAgICAgICAgIHJzLm5leHQoKTsKICAg\nICAgICAgICAgcmV0dXJuIE51bWJlcnMudmFsdWVPZihycy5nZXRMb25nKDEp\nKTsKICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICBpZiAocnMgIT0g\nbnVsbCkKICAgICAgICAgICAgICAgIHRyeSB7IHJzLmNsb3NlKCk7IH0gY2F0\nY2ggKFNRTEV4Y2VwdGlvbiBzZSkge30KICAgICAgICAgICAgdHJ5IHsgc3Rt\nbnQuY2xvc2UoKTsgfSBjYXRjaCAoU1FMRXhjZXB0aW9uIHNlKSB7fQogICAg\nICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIFRyaWdnZXIgbmFtZSBmb3Ig\nc2ltdWxhdGluZyBhdXRvLWFzc2lnbiB2YWx1ZXMgb24gdGhlIGdpdmVuIGNv\nbHVtbi4KICAgICAqLwogICAgcHJvdGVjdGVkIFN0cmluZyBnZXRHZW5lcmF0\nZWRLZXlUcmlnZ2VyTmFtZShDb2x1bW4gY29sKSB7CiAgICAgICAgLy8gcmVw\nbGFjZSB0cmFpbGluZyBfU0VRIHdpdGggX1RSRwogICAgICAgIFN0cmluZyBz\nZXFOYW1lID0gZ2V0R2VuZXJhdGVkS2V5U2VxdWVuY2VOYW1lKGNvbCk7CiAg\nICAgICAgcmV0dXJuIHNlcU5hbWUuc3Vic3RyaW5nKDAsIHNlcU5hbWUubGVu\nZ3RoKCkgLSAzKSArICJUUkciOwogICAgfQoKICAgIC8qKgogICAgICogUmV0\ndXJucyBhIE9wZW5KUEEgMy1jb21wYXRpYmxlIG5hbWUgZm9yIGFuIGF1dG8t\nYXNzaWduIHNlcXVlbmNlLgogICAgICovCiAgICBwcm90ZWN0ZWQgU3RyaW5n\nIGdldE9wZW5KUEEzR2VuZXJhdGVkS2V5U2VxdWVuY2VOYW1lKENvbHVtbiBj\nb2wpIHsKICAgICAgICBUYWJsZSB0YWJsZSA9IGNvbC5nZXRUYWJsZSgpOwog\nICAgICAgIHJldHVybiBtYWtlTmFtZVZhbGlkKCJTRVFfIiArIHRhYmxlLmdl\ndE5hbWUoKSwgdGFibGUuZ2V0U2NoZW1hKCkuCiAgICAgICAgICAgIGdldFNj\naGVtYUdyb3VwKCksIG1heFRhYmxlTmFtZUxlbmd0aCwgTkFNRV9BTlkpOwog\nICAgfQoKICAgIC8qKgogICAgICogUmV0dXJucyBhIE9wZW5KUEEgMy1jb21w\nYXRpYmxlIG5hbWUgZm9yIGFuIGF1dG8tYXNzaWduIHRyaWdnZXIuCiAgICAg\nKi8KICAgIHByb3RlY3RlZCBTdHJpbmcgZ2V0T3BlbkpQQTNHZW5lcmF0ZWRL\nZXlUcmlnZ2VyTmFtZShDb2x1bW4gY29sKSB7CiAgICAgICAgVGFibGUgdGFi\nbGUgPSBjb2wuZ2V0VGFibGUoKTsKICAgICAgICByZXR1cm4gbWFrZU5hbWVW\nYWxpZCgiVFJJR18iICsgdGFibGUuZ2V0TmFtZSgpLCB0YWJsZS5nZXRTY2hl\nbWEoKS4KICAgICAgICAgICAgZ2V0U2NoZW1hR3JvdXAoKSwgbWF4VGFibGVO\nYW1lTGVuZ3RoLCBOQU1FX0FOWSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBJ\nbnZva2UgT3JhY2xlJ3MgPGNvZGU+cHV0Qnl0ZXM8L2NvZGU+IG1ldGhvZCBv\nbiB0aGUgZ2l2ZW4gQkxPQiBvYmplY3QuCiAgICAgKiBVc2VzIHJlZmxlY3Rp\nb24gaW4gY2FzZSB0aGUgYmxvYiBpcyB3cmFwcGVkIGluIGFub3RoZXIKICAg\nICAqIHZlbmRvci1zcGVjaWZpYyBjbGFzczsgZm9yIGV4YW1wbGUgV2VibG9n\naWMgd3JhcHMgb3JhY2xlIHRoaW4gZHJpdmVyCiAgICAgKiBsb2JzIGluIGl0\ncyBvd24gaW50ZXJmYWNlcyB3aXRoIHRoZSBzYW1lIG1ldGhvZHMuCiAgICAg\nKi8KICAgIHB1YmxpYyB2b2lkIHB1dEJ5dGVzKE9iamVjdCBibG9iLCBieXRl\nW10gZGF0YSkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAg\nICBpZiAoYmxvYiA9PSBudWxsKQogICAgICAgICAgICByZXR1cm47CiAgICAg\nICAgaWYgKF9wdXRCeXRlcyA9PSBudWxsKSB7CiAgICAgICAgICAgIHRyeSB7\nCiAgICAgICAgICAgICAgICBfcHV0Qnl0ZXMgPSBibG9iLmdldENsYXNzKCku\nZ2V0TWV0aG9kKCJwdXRCeXRlcyIsCiAgICAgICAgICAgICAgICAgICAgbmV3\nIENsYXNzW117IGxvbmcuY2xhc3MsIGJ5dGVbXS5jbGFzcyB9KTsKICAgICAg\nICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgICAg\nIHRocm93IG5ldyBTdG9yZUV4Y2VwdGlvbihlKTsKICAgICAgICAgICAgfQog\nICAgICAgIH0KICAgICAgICBpbnZva2VQdXRMb2JNZXRob2QoX3B1dEJ5dGVz\nLCBibG9iLCBkYXRhKTsKICAgIH0KCiAgICAvKioKICAgICAqIEludm9rZSBP\ncmFjbGUncyA8Y29kZT5wdXRTdHJpbmc8L2NvZGU+IG1ldGhvZCBvbiB0aGUg\nZ2l2ZW4gQ0xPQiBvYmplY3QuCiAgICAgKiBVc2VzIHJlZmxlY3Rpb24gaW4g\nY2FzZSB0aGUgY2xvYiBpcyB3cmFwcGVkIGluIGFub3RoZXIKICAgICAqIHZl\nbmRvci1zcGVjaWZpYyBjbGFzczsgZm9yIGV4YW1wbGUgV2VibG9naWMgd3Jh\ncHMgb3JhY2xlIHRoaW4gZHJpdmVyCiAgICAgKiBsb2JzIGluIGl0cyBvd24g\naW50ZXJmYWNlcyB3aXRoIHRoZSBzYW1lIG1ldGhvZHMuCiAgICAgKi8KICAg\nIHB1YmxpYyB2b2lkIHB1dFN0cmluZyhPYmplY3QgY2xvYiwgU3RyaW5nIGRh\ndGEpCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgaWYg\nKF9wdXRTdHJpbmcgPT0gbnVsbCkgewogICAgICAgICAgICB0cnkgewogICAg\nICAgICAgICAgICAgX3B1dFN0cmluZyA9IGNsb2IuZ2V0Q2xhc3MoKS5nZXRN\nZXRob2QoInB1dFN0cmluZyIsCiAgICAgICAgICAgICAgICAgICAgbmV3IENs\nYXNzW117IGxvbmcuY2xhc3MsIFN0cmluZy5jbGFzcyB9KTsKICAgICAgICAg\nICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgICAgIHRo\ncm93IG5ldyBTdG9yZUV4Y2VwdGlvbihlKTsKICAgICAgICAgICAgfQogICAg\nICAgIH0KICAgICAgICBpbnZva2VQdXRMb2JNZXRob2QoX3B1dFN0cmluZywg\nY2xvYiwgZGF0YSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBJbnZva2UgT3Jh\nY2xlJ3MgPGNvZGU+cHV0Q2hhcnM8L2NvZGU+IG1ldGhvZCBvbiB0aGUgZ2l2\nZW4gQ0xPQgogICAgICogb2JqZWN0LiBVc2VzIHJlZmxlY3Rpb24gaW4gY2Fz\nZSB0aGUgY2xvYiBpcyB3cmFwcGVkIGluIGFub3RoZXIKICAgICAqIHZlbmRv\nci1zcGVjaWZpYyBjbGFzczsgZm9yIGV4YW1wbGUgV2VibG9naWMgd3JhcHMg\nb3JhY2xlIHRoaW4gZHJpdmVyCiAgICAgKiBsb2JzIGluIGl0cyBvd24gaW50\nZXJmYWNlcyB3aXRoIHRoZSBzYW1lIG1ldGhvZHMuCiAgICAgKi8KICAgIHB1\nYmxpYyB2b2lkIHB1dENoYXJzKE9iamVjdCBjbG9iLCBjaGFyW10gZGF0YSkK\nICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBpZiAoX3B1\ndENoYXJzID09IG51bGwpIHsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAg\nICAgICAgIF9wdXRDaGFycyA9IGNsb2IuZ2V0Q2xhc3MoKS5nZXRNZXRob2Qo\nInB1dENoYXJzIiwKICAgICAgICAgICAgICAgICAgICBuZXcgQ2xhc3NbXXsg\nbG9uZy5jbGFzcywgY2hhcltdLmNsYXNzIH0pOwogICAgICAgICAgICB9IGNh\ndGNoIChFeGNlcHRpb24gZSkgewogICAgICAgICAgICAgICAgdGhyb3cgbmV3\nIFN0b3JlRXhjZXB0aW9uKGUpOwogICAgICAgICAgICB9CiAgICAgICAgfQog\nICAgICAgIGludm9rZVB1dExvYk1ldGhvZChfcHV0Q2hhcnMsIGNsb2IsIGRh\ndGEpOwogICAgfQoKICAgIC8qKgogICAgICogSW52b2tlIHRoZSBnaXZlbiBM\nT0IgbWV0aG9kIG9uIHRoZSBnaXZlbiB0YXJnZXQgd2l0aCB0aGUgZ2l2ZW4g\nZGF0YS4KICAgICAqLwogICAgcHJpdmF0ZSBzdGF0aWMgdm9pZCBpbnZva2VQ\ndXRMb2JNZXRob2QoTWV0aG9kIG1ldGhvZCwgT2JqZWN0IHRhcmdldCwKICAg\nICAgICBPYmplY3QgZGF0YSkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9u\nIHsKICAgICAgICB0cnkgewogICAgICAgICAgICBtZXRob2QuaW52b2tlKHRh\ncmdldCwgbmV3IE9iamVjdFtdeyBOdW1iZXJzLnZhbHVlT2YoMUwpLCBkYXRh\nIH0pOwogICAgICAgIH0gY2F0Y2ggKEludm9jYXRpb25UYXJnZXRFeGNlcHRp\nb24gaXRlKSB7CiAgICAgICAgICAgIFRocm93YWJsZSB0ID0gaXRlLmdldFRh\ncmdldEV4Y2VwdGlvbigpOwogICAgICAgICAgICBpZiAodCBpbnN0YW5jZW9m\nIFNRTEV4Y2VwdGlvbikKICAgICAgICAgICAgICAgIHRocm93KFNRTEV4Y2Vw\ndGlvbikgdDsKICAgICAgICAgICAgdGhyb3cgbmV3IFN0b3JlRXhjZXB0aW9u\nKHQpOwogICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAg\nICAgIHRocm93IG5ldyBTdG9yZUV4Y2VwdGlvbihlKTsKICAgICAgICB9CiAg\nICB9CgogICAgcHJpdmF0ZSBzdGF0aWMgQ2xvYiBnZXRFbXB0eUNsb2IoKQog\nICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIGlmIChFTVBU\nWV9DTE9CICE9IG51bGwpCiAgICAgICAgICAgIHJldHVybiBFTVBUWV9DTE9C\nOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIHJldHVybiBFTVBUWV9DTE9C\nID0gKENsb2IpIENsYXNzLmZvck5hbWUoIm9yYWNsZS5zcWwuQ0xPQiIpLgog\nICAgICAgICAgICAgICAgZ2V0TWV0aG9kKCJlbXB0eV9sb2IiLCBuZXcgQ2xh\nc3NbMF0pLgogICAgICAgICAgICAgICAgaW52b2tlKG51bGwsIG5ldyBPYmpl\nY3RbMF0pOwogICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAg\nICAgICAgIHRocm93IG5ldyBTUUxFeGNlcHRpb24oZS5nZXRNZXNzYWdlKCkp\nOwogICAgICAgIH0KICAgIH0KCiAgICBwcml2YXRlIHN0YXRpYyBCbG9iIGdl\ndEVtcHR5QmxvYigpCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAg\nICAgICAgaWYgKEVNUFRZX0JMT0IgIT0gbnVsbCkKICAgICAgICAgICAgcmV0\ndXJuIEVNUFRZX0JMT0I7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgcmV0\ndXJuIEVNUFRZX0JMT0IgPSAoQmxvYikgQ2xhc3MuZm9yTmFtZSgib3JhY2xl\nLnNxbC5CTE9CIikuCiAgICAgICAgICAgICAgICBnZXRNZXRob2QoImVtcHR5\nX2xvYiIsIG5ldyBDbGFzc1swXSkuCiAgICAgICAgICAgICAgICBpbnZva2Uo\nbnVsbCwgbmV3IE9iamVjdFswXSk7CiAgICAgICAgfSBjYXRjaCAoRXhjZXB0\naW9uIGUpIHsKICAgICAgICAgICAgdGhyb3cgbmV3IFNRTEV4Y2VwdGlvbihl\nLmdldE1lc3NhZ2UoKSk7CiAgICAgICAgfQogICAgfQoKICAgIHByaXZhdGUg\nc3RhdGljIGJvb2xlYW4gaXNPcmFjbGVQcmVwYXJlZFN0YXRlbWVudChTdGF0\nZW1lbnQgc3RtbnQpIHsKICAgICAgICB0cnkgewogICAgICAgICAgICByZXR1\ncm4gQ2xhc3MuZm9yTmFtZSgib3JhY2xlLmpkYmMuT3JhY2xlUHJlcGFyZWRT\ndGF0ZW1lbnQiKS4KICAgICAgICAgICAgICAgIGlzSW5zdGFuY2Uoc3RtbnQp\nOwogICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAg\nIHJldHVybiBmYWxzZTsKICAgICAgICB9CiAgICB9CiAgICAKICAgIC8qKgog\nICAgICogSWYgdGhpcyBkaWN0aW9uYXJ5IHN1cHBvcnRzIFhNTCB0eXBlLAog\nICAgICogdXNlIHRoaXMgbWV0aG9kIHRvIGFwcGVuZCB4bWwgcHJlZGljYXRl\nLgogICAgICogCiAgICAgKiBAcGFyYW0gYnVmIHRoZSBTUUwgYnVmZmVyIHRv\nIHdyaXRlIHRoZSBjb21wYXJpc29uCiAgICAgKiBAcGFyYW0gb3AgdGhlIGNv\nbXBhcmlzb24gb3BlcmF0aW9uIHRvIHBlcmZvcm0KICAgICAqIEBwYXJhbSBs\naHMgdGhlIGxlZnQgaGFuZCBzaWRlIG9mIHRoZSBjb21wYXJpc29uCiAgICAg\nKiBAcGFyYW0gcmhzIHRoZSByaWdodCBoYW5kIHNpZGUgb2YgdGhlIGNvbXBh\ncmlzb24KICAgICAqLwogICAgcHVibGljIHZvaWQgYXBwZW5kWG1sQ29tcGFy\naXNvbihTUUxCdWZmZXIgYnVmLCBTdHJpbmcgb3AsIEZpbHRlclZhbHVlIGxo\ncywKICAgICAgICBGaWx0ZXJWYWx1ZSByaHMsIGJvb2xlYW4gbGhzeG1sLCBi\nb29sZWFuIHJoc3htbCkgewogICAgICAgIHN1cGVyLmFwcGVuZFhtbENvbXBh\ncmlzb24oYnVmLCBvcCwgbGhzLCByaHMsIGxoc3htbCwgcmhzeG1sKTsKICAg\nICAgICBpZiAobGhzeG1sICYmIHJoc3htbCkKICAgICAgICAgICAgYXBwZW5k\nWG1sQ29tcGFyaXNvbjIoYnVmLCBvcCwgbGhzLCByaHMpOwogICAgICAgIGVs\nc2UgaWYgKGxoc3htbCkKICAgICAgICAgICAgYXBwZW5kWG1sQ29tcGFyaXNv\nbjEoYnVmLCBvcCwgbGhzLCByaHMpOwogICAgICAgIGVsc2UgCiAgICAgICAg\nICAgIGFwcGVuZFhtbENvbXBhcmlzb24xKGJ1Ziwgb3AsIHJocywgbGhzKTsK\nICAgIH0KICAgIAogICAgLyoqCiAgICAgKiBBcHBlbmQgYW4geG1sIGNvbXBh\ncmlzb24gcHJlZGljYXRlCiAgICAgKgogICAgICogQHBhcmFtIGJ1ZiB0aGUg\nU1FMIGJ1ZmZlciB0byB3cml0ZSB0aGUgY29tcGFyaXNvbgogICAgICogQHBh\ncmFtIG9wIHRoZSBjb21wYXJpc29uIG9wZXJhdGlvbiB0byBwZXJmb3JtCiAg\nICAgKiBAcGFyYW0gbGhzIHRoZSBsZWZ0IGhhbmQgc2lkZSBvZiB0aGUgY29t\ncGFyaXNvbiAobWFwcyB0byB4bWwgY29sdW1uKQogICAgICogQHBhcmFtIHJo\ncyB0aGUgcmlnaHQgaGFuZCBzaWRlIG9mIHRoZSBjb21wYXJpc29uCiAgICAg\nKi8KICAgIHByaXZhdGUgdm9pZCBhcHBlbmRYbWxDb21wYXJpc29uMShTUUxC\ndWZmZXIgYnVmLCBTdHJpbmcgb3AsCiAgICAgICAgRmlsdGVyVmFsdWUgbGhz\nLCBGaWx0ZXJWYWx1ZSByaHMpIHsKICAgICAgICBhcHBlbmRYbWxFeHRyYWN0\nVmFsdWUoYnVmLCBsaHMpOwogICAgICAgIGJ1Zi5hcHBlbmQoIiAiKS5hcHBl\nbmQob3ApLmFwcGVuZCgiICIpOwogICAgICAgIHJocy5hcHBlbmRUbyhidWYp\nOwogICAgfQogICAgCiAgICAvKioKICAgICAqIEFwcGVuZCBhbiB4bWwgY29t\ncGFyaXNvbiBwcmVkaWNhdGUgKGJvdGggb3BlcmFuZHMgbWFwIHRvIHhtbCBj\nb2x1bW4pCiAgICAgKgogICAgICogQHBhcmFtIGJ1ZiB0aGUgU1FMIGJ1ZmZl\nciB0byB3cml0ZSB0aGUgY29tcGFyaXNvbgogICAgICogQHBhcmFtIG9wIHRo\nZSBjb21wYXJpc29uIG9wZXJhdGlvbiB0byBwZXJmb3JtCiAgICAgKiBAcGFy\nYW0gbGhzIHRoZSBsZWZ0IGhhbmQgc2lkZSBvZiB0aGUgY29tcGFyaXNvbiAo\nbWFwcyB0byB4bWwgY29sdW1uKQogICAgICogQHBhcmFtIHJocyB0aGUgcmln\naHQgaGFuZCBzaWRlIG9mIHRoZSBjb21wYXJpc29uIChtYXBzIHRvIHhtbCBj\nb2x1bW4pCiAgICAgKi8KICAgIHByaXZhdGUgdm9pZCBhcHBlbmRYbWxDb21w\nYXJpc29uMihTUUxCdWZmZXIgYnVmLCBTdHJpbmcgb3AsIAogICAgICAgIEZp\nbHRlclZhbHVlIGxocywgRmlsdGVyVmFsdWUgcmhzKSB7CiAgICAgICAgYXBw\nZW5kWG1sRXh0cmFjdFZhbHVlKGJ1ZiwgbGhzKTsKICAgICAgICBidWYuYXBw\nZW5kKCIgIikuYXBwZW5kKG9wKS5hcHBlbmQoIiAiKTsKICAgICAgICBhcHBl\nbmRYbWxFeHRyYWN0VmFsdWUoYnVmLCByaHMpOwogICAgfQogICAgCiAgICBw\ncml2YXRlIHZvaWQgYXBwZW5kWG1sRXh0cmFjdFZhbHVlKFNRTEJ1ZmZlciBi\ndWYsIEZpbHRlclZhbHVlIHZhbCkgewogICAgICAgIGJ1Zi5hcHBlbmQoImV4\ndHJhY3RWYWx1ZSgiKS4KICAgICAgICAgICAgYXBwZW5kKHZhbC5nZXRDb2x1\nbW5BbGlhcygKICAgICAgICAgICAgdmFsLmdldEZpZWxkTWFwcGluZygpLmdl\ndENvbHVtbnMoKVswXSkpLgogICAgICAgICAgICBhcHBlbmQoIiwnLyovIik7\nCiAgICAgICAgdmFsLmFwcGVuZFRvKGJ1Zik7CiAgICAgICAgYnVmLmFwcGVu\nZCgiJykiKTsKICAgIH0KfQo=\n","encoding":"base64"}

