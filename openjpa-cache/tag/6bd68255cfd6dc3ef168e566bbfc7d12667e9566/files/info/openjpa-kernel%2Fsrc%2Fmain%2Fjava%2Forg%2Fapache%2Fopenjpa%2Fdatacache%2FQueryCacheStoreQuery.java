{"sha":"271c3c1059657d09f95705cf1f675ef96018a0f4","node_id":"MDQ6QmxvYjIwNjM2NDoyNzFjM2MxMDU5NjU3ZDA5Zjk1NzA1Y2YxZjY3NWVmOTYwMThhMGY0","size":21388,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/271c3c1059657d09f95705cf1f675ef96018a0f4","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuZGF0YWNhY2hlOwoKaW1wb3J0\nIGphdmEuaW8uT2JqZWN0U3RyZWFtRXhjZXB0aW9uOwppbXBvcnQgamF2YS5p\nby5TZXJpYWxpemFibGU7CmltcG9ydCBqYXZhLnV0aWwuQWJzdHJhY3RMaXN0\nOwppbXBvcnQgamF2YS51dGlsLkFycmF5TGlzdDsKaW1wb3J0IGphdmEudXRp\nbC5CaXRTZXQ7CmltcG9ydCBqYXZhLnV0aWwuQ29sbGVjdGlvbnM7CmltcG9y\ndCBqYXZhLnV0aWwuRGF0ZTsKaW1wb3J0IGphdmEudXRpbC5MaXN0OwppbXBv\ncnQgamF2YS51dGlsLkxvY2FsZTsKaW1wb3J0IGphdmEudXRpbC5NYXA7Cmlt\ncG9ydCBqYXZhLnV0aWwuVHJlZU1hcDsKCmltcG9ydCBvcmcuYXBhY2hlLmNv\nbW1vbnMuY29sbGVjdGlvbnMubWFwLkxpbmtlZE1hcDsKaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS5rZXJuZWwuRmV0Y2hDb25maWd1cmF0aW9uOwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5Mb2NrTGV2ZWxzOwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5RdWVyeUNvbnRleHQ7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLlN0b3JlQ29udGV4dDsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuU3RvcmVRdWVyeTsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuZXhwcy5BZ2dyZWdh\ndGVMaXN0ZW5lcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwu\nZXhwcy5GaWx0ZXJMaXN0ZW5lcjsKaW1wb3J0IG9yZy5hcGFjaGUub3Blbmpw\nYS5saWIucm9wLkxpc3RSZXN1bHRPYmplY3RQcm92aWRlcjsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5saWIucm9wLlJlc3VsdE9iamVjdFByb3ZpZGVy\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuQ2xhc3NNZXRhRGF0\nYTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRhLkphdmFUeXBlczsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRhLk1ldGFEYXRhUmVwb3Np\ndG9yeTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLk9iamVjdE5v\ndEZvdW5kRXhjZXB0aW9uOwppbXBvcnQgc2VycC51dGlsLk51bWJlcnM7Cgov\nKioKICogQSB7QGxpbmsgU3RvcmVRdWVyeX0gaW1wbGVtZW50YXRpb24gdGhh\ndCBjYWNoZXMgdGhlIE9JRHMgaW52b2x2ZWQgaW4KICogdGhlIHF1ZXJ5LCBh\nbmQgY2FuIGRldGVybWluZSB3aGV0aGVyIG9yIG5vdCB0aGUgcXVlcnkgaGFz\nIGJlZW4gZGlydGllZC4KICoKICogQGF1dGhvciBQYXRyaWNrIExpbnNrZXkK\nICogQHNpbmNlIDAuMi41LjAKICovCnB1YmxpYyBjbGFzcyBRdWVyeUNhY2hl\nU3RvcmVRdWVyeQogICAgaW1wbGVtZW50cyBTdG9yZVF1ZXJ5IHsKCiAgICBw\ncml2YXRlIGZpbmFsIFN0b3JlUXVlcnkgX3F1ZXJ5OwogICAgcHJpdmF0ZSBm\naW5hbCBRdWVyeUNhY2hlIF9jYWNoZTsKICAgIHByaXZhdGUgU3RvcmVDb250\nZXh0IF9zY3R4OwogICAgcHJpdmF0ZSBNZXRhRGF0YVJlcG9zaXRvcnkgX3Jl\ncG9zOwoKICAgIC8qKgogICAgICogQ3JlYXRlIGEgbmV3IGluc3RhbmNlIHRo\nYXQgZGVsZWdhdGVzIHRvIDxjb2RlPnF1ZXJ5PC9jb2RlPiBpZiBubwogICAg\nICogY2FjaGVkIHJlc3VsdHMgYXJlIGF2YWlsYWJsZS4KICAgICAqLwogICAg\ncHVibGljIFF1ZXJ5Q2FjaGVTdG9yZVF1ZXJ5KFN0b3JlUXVlcnkgcXVlcnks\nIFF1ZXJ5Q2FjaGUgY2FjaGUpIHsKICAgICAgICBfcXVlcnkgPSBxdWVyeTsK\nICAgICAgICBfY2FjaGUgPSBjYWNoZTsKICAgIH0KCiAgICAvKioKICAgICAq\nIFJldHVybiB0aGUge0BsaW5rIFF1ZXJ5Q2FjaGV9IHRoYXQgdGhpcyBvYmpl\nY3QgaXMgYXNzb2NpYXRlZCB3aXRoLgogICAgICovCiAgICBwdWJsaWMgUXVl\ncnlDYWNoZSBnZXRDYWNoZSgpIHsKICAgICAgICByZXR1cm4gX2NhY2hlOwog\nICAgfQoKICAgIC8qKgogICAgICogRGVsZWdhdGUuCiAgICAgKi8KICAgIHB1\nYmxpYyBTdG9yZVF1ZXJ5IGdldERlbGVnYXRlKCkgewogICAgICAgIHJldHVy\nbiBfcXVlcnk7CiAgICB9CgogICAgLyoqCiAgICAgKiBMb29rIGluIHRoZSBx\ndWVyeSBjYWNoZSBmb3IgYSByZXN1bHQgZm9yIHRoZSBnaXZlbiBxdWVyeQog\nICAgICoga2V5LiBPbmx5IGxvb2sgaWYgdGhpcyBxdWVyeSBpcyBiZWluZyBl\neGVjdXRlZCBvdXRzaWRlIGEKICAgICAqIHRyYW5zYWN0aW9uIG9yIGluIGEg\ndHJhbnNhY3Rpb24gd2l0aCBJZ25vcmVDaGFuZ2VzIHNldCB0byB0cnVlCiAg\nICAgKiBvciBpbiBhIHRyYW5zYWN0aW9uIHdpdGggSWdub3JlQ2hhbmdlcyBz\nZXQgdG8gZmFsc2UgYnV0IGluIHdoaWNoCiAgICAgKiBub25lIG9mIHRoZSBj\nbGFzc2VzIGludm9sdmVkIGluIHRoaXMgcXVlcnkgaGF2ZSBiZWVuIHRvdWNo\nZWQuCiAgICAgKiAgQ2FjaGluZyBpcyBub3QgdXNlZCB3aGVuIHVzaW5nIG9i\namVjdCBsb2NraW5nLgogICAgICogVGhpcyBpcyBiZWNhdXNlIHdlIG11c3Qg\nb2J0YWluIGxvY2tzIG9uIHRoZQogICAgICogZGF0YSwgYW5kIGl0IGlzIGxp\na2VseSB0aGF0IG1ha2luZyBuIHRyaXBzIHRvIHRoZSBkYXRhYmFzZSB0bwog\nICAgICogbWFrZSB0aGUgbG9ja3Mgd2lsbCBiZSBzbG93ZXIgdGhhbiBydW5u\naW5nIHRoZSBxdWVyeSBhZ2FpbnN0CiAgICAgKiB0aGUgZGF0YWJhc2UuCiAg\nICAgKiAgSWYgdGhlIGZldGNoIGNvbmZpZ3VyYXRpb24gaGFzIHF1ZXJ5IGNh\nY2hpbmcgZGlzYWJsZWQsCiAgICAgKiB0aGVuIHRoaXMgbWV0aG9kIHJldHVy\nbnMgPGNvZGU+bnVsbDwvY29kZT4uCiAgICAgKiAgUmV0dXJuIHRoZSBsaXN0\nIGlmIHdlIG1lZXQgdGhlIGFib3ZlIGNyaXRlcmlhIGFuZCBpZiBhIGxpc3QK\nICAgICAqIGlzIGZvdW5kIGZvciA8Y29kZT5xazwvY29kZT4uIEVsc2UsIHJl\ndHVybgogICAgICogPGNvZGU+bnVsbDwvY29kZT4uCiAgICAgKiAgVGhpcyBp\nbXBsZW1lbnRhdGlvbiBtZWFucyB0aGF0IHF1ZXJpZXMgYWdhaW5zdCB0aGUg\nY2FjaGUKICAgICAqIGFyZSBvZiBSRUFEX0NPTU1JVFRFRCBpc29sYXRpb24g\nbGV2ZWwuIEl0J2QgYmUgbmljZSB0byBzdXBwb3J0CiAgICAgKiBSRUFEX1NF\nUklBTElaQUJMRSAtLSB0byBkbyBzbywgd2UnZCBqdXN0IHJldHVybiBmYWxz\nZSB3aGVuIGluCiAgICAgKiBhIHRyYW5zYWN0aW9uLgogICAgICovCiAgICBw\ncml2YXRlIExpc3QgY2hlY2tDYWNoZShRdWVyeUtleSBxaykgewogICAgICAg\nIGlmIChxayA9PSBudWxsKQogICAgICAgICAgICByZXR1cm4gbnVsbDsKICAg\nICAgICBGZXRjaENvbmZpZ3VyYXRpb24gZmV0Y2ggPSBnZXRDb250ZXh0KCku\nZ2V0RmV0Y2hDb25maWd1cmF0aW9uKCk7CiAgICAgICAgaWYgKCFmZXRjaC5n\nZXRRdWVyeUNhY2hlRW5hYmxlZCgpKQogICAgICAgICAgICByZXR1cm4gbnVs\nbDsKICAgICAgICBpZiAoZmV0Y2guZ2V0UmVhZExvY2tMZXZlbCgpID4gTG9j\na0xldmVscy5MT0NLX05PTkUpCiAgICAgICAgICAgIHJldHVybiBudWxsOwoK\nICAgICAgICAvLyBnZXQgdGhlIGNhY2hlZCBkYXRhCiAgICAgICAgUXVlcnlS\nZXN1bHQgcmVzID0gX2NhY2hlLmdldChxayk7CiAgICAgICAgaWYgKHJlcyA9\nPSBudWxsKQogICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICBpZiAo\ncmVzLmlzRW1wdHkoKSkKICAgICAgICAgICAgcmV0dXJuIENvbGxlY3Rpb25z\nLkVNUFRZX0xJU1Q7CgogICAgICAgIGludCBwcm9qcyA9IGdldENvbnRleHQo\nKS5nZXRQcm9qZWN0aW9uQWxpYXNlcygpLmxlbmd0aDsKICAgICAgICBpZiAo\ncHJvanMgPT0gMCkgewogICAgICAgICAgICAvLyBtYWtlIHN1cmUgdGhlIGRh\ndGEgY2FjaGUgY29udGFpbnMgdGhlIG9pZHMgZm9yIHRoZSBxdWVyeSByZXN1\nbHQ7CiAgICAgICAgICAgIC8vIGlmIGl0IGRvZXNuJ3QsIHRoZW4gdXNpbmcg\ndGhlIHJlc3VsdCBjb3VsZCBiZSBzbG93ZXIgdGhhbiBub3QKICAgICAgICAg\nICAgLy8gdXNpbmcgaXQgYmVjYXVzZSBvZiB0aGUgaW5kaXZpZHVhbCBieS1v\naWQgbG9va3VwcwogICAgICAgICAgICBDbGFzc01ldGFEYXRhIG1ldGEgPSBf\ncmVwb3MuZ2V0TWV0YURhdGEoZ2V0Q29udGV4dCgpLgogICAgICAgICAgICAg\nICAgZ2V0Q2FuZGlkYXRlVHlwZSgpLCBfc2N0eC5nZXRDbGFzc0xvYWRlcigp\nLCB0cnVlKTsKICAgICAgICAgICAgQml0U2V0IGlkeHMgPSBtZXRhLmdldERh\ndGFDYWNoZSgpLmNvbnRhaW5zQWxsKHJlcyk7CgogICAgICAgICAgICAvLyBl\ndmVudHVhbGx5IHdlIHNob3VsZCBvcHRpbWl6ZSB0aGlzIHRvIGZpZ3VyZSBv\ndXQgaG93IG1hbnkgb2JqZWN0cwogICAgICAgICAgICAvLyB0aGUgY2FjaGUg\naXMgbWlzc2luZyBhbmQgaWYgb25seSBhIGZldyBkbyBhIGJ1bGsgZmV0Y2gg\nZm9yIHRoZW0KICAgICAgICAgICAgaW50IGxlbiA9IGlkeHMubGVuZ3RoKCk7\nCiAgICAgICAgICAgIGlmIChsZW4gPCByZXMuc2l6ZSgpKQogICAgICAgICAg\nICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgICAgIGZvciAoaW50IGkgPSAw\nOyBpIDwgbGVuOyBpKyspCiAgICAgICAgICAgICAgICBpZiAoIWlkeHMuZ2V0\nKGkpKQogICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAg\nIH0KICAgICAgICByZXR1cm4gbmV3IENhY2hlZExpc3QocmVzLCBwcm9qcyAh\nPSAwLCBfc2N0eCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBXcmFwIHRoZSBy\nZXN1bHQgb2JqZWN0IHByb3ZpZGVyIHJldHVybmVkIGJ5IG91ciBkZWxlZ2F0\nZSBpbiBhCiAgICAgKiBjYWNoaW5nIHByb3ZpZGVyLgogICAgICovCiAgICBw\ncml2YXRlIFJlc3VsdE9iamVjdFByb3ZpZGVyIHdyYXBSZXN1bHQoUmVzdWx0\nT2JqZWN0UHJvdmlkZXIgcm9wLAogICAgICAgIFF1ZXJ5S2V5IGtleSkgewog\nICAgICAgIGlmIChrZXkgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIHJv\ncDsKICAgICAgICByZXR1cm4gbmV3IENhY2hpbmdSZXN1bHRPYmplY3RQcm92\naWRlcihyb3AsIGdldENvbnRleHQoKS4KICAgICAgICAgICAgZ2V0UHJvamVj\ndGlvbkFsaWFzZXMoKS5sZW5ndGggPiAwLCBrZXkpOwogICAgfQoKICAgIC8q\nKgogICAgICogQ29weSBhIHByb2plY3Rpb24gZWxlbWVudCBmb3IgY2FjaGlu\nZyAvIHJldHVybmluZy4KICAgICAqLwogICAgcHJpdmF0ZSBzdGF0aWMgT2Jq\nZWN0IGNvcHlQcm9qZWN0aW9uKE9iamVjdCBvYmosIFN0b3JlQ29udGV4dCBj\ndHgpIHsKICAgICAgICBpZiAob2JqID09IG51bGwpCiAgICAgICAgICAgIHJl\ndHVybiBudWxsOwogICAgICAgIHN3aXRjaCAoSmF2YVR5cGVzLmdldFR5cGVD\nb2RlKG9iai5nZXRDbGFzcygpKSkgewogICAgICAgICAgICBjYXNlIEphdmFU\neXBlcy5TVFJJTkc6CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLkJPT0xF\nQU5fT0JKOgogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5CWVRFX09CSjoK\nICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuQ0hBUl9PQko6CiAgICAgICAg\nICAgIGNhc2UgSmF2YVR5cGVzLkRPVUJMRV9PQko6CiAgICAgICAgICAgIGNh\nc2UgSmF2YVR5cGVzLkZMT0FUX09CSjoKICAgICAgICAgICAgY2FzZSBKYXZh\nVHlwZXMuSU5UX09CSjoKICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuTE9O\nR19PQko6CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLlNIT1JUX09CSjoK\nICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuQklHREVDSU1BTDoKICAgICAg\nICAgICAgY2FzZSBKYXZhVHlwZXMuQklHSU5URUdFUjoKICAgICAgICAgICAg\nY2FzZSBKYXZhVHlwZXMuT0lEOgogICAgICAgICAgICAgICAgcmV0dXJuIG9i\najsKICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuREFURToKICAgICAgICAg\nICAgICAgIHJldHVybiAoKERhdGUpIG9iaikuY2xvbmUoKTsKICAgICAgICAg\nICAgY2FzZSBKYXZhVHlwZXMuTE9DQUxFOgogICAgICAgICAgICAgICAgcmV0\ndXJuICgoTG9jYWxlKSBvYmopLmNsb25lKCk7CiAgICAgICAgICAgIGRlZmF1\nbHQ6CiAgICAgICAgICAgICAgICBpZiAob2JqIGluc3RhbmNlb2YgQ2FjaGVk\nT2JqZWN0SWQpCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZyb21PYmpl\nY3RJZCgoKENhY2hlZE9iamVjdElkKSBvYmopLm9pZCwgY3R4KTsKICAgICAg\nICAgICAgICAgIE9iamVjdCBvaWQgPSBjdHguZ2V0T2JqZWN0SWQob2JqKTsK\nICAgICAgICAgICAgICAgIGlmIChvaWQgIT0gbnVsbCkKICAgICAgICAgICAg\nICAgICAgICByZXR1cm4gbmV3IENhY2hlZE9iamVjdElkKG9pZCk7CiAgICAg\nICAgICAgICAgICByZXR1cm4gb2JqOwogICAgICAgIH0KICAgIH0KCiAgICAv\nKioKICAgICAqIFJldHVybiB0aGUgcmVzdWx0IG9iamVjdCBiYXNlZCBvbiBp\ndHMgY2FjaGVkIG9pZC4KICAgICAqLwogICAgcHJpdmF0ZSBzdGF0aWMgT2Jq\nZWN0IGZyb21PYmplY3RJZChPYmplY3Qgb2lkLCBTdG9yZUNvbnRleHQgc2N0\neCkgewogICAgICAgIGlmIChvaWQgPT0gbnVsbCkKICAgICAgICAgICAgcmV0\ndXJuIG51bGw7CgogICAgICAgIE9iamVjdCBvYmogPSBzY3R4LmZpbmQob2lk\nLCBudWxsLCBudWxsLCBudWxsLCAwKTsKICAgICAgICBpZiAob2JqID09IG51\nbGwpCiAgICAgICAgICAgIHRocm93IG5ldyBPYmplY3ROb3RGb3VuZEV4Y2Vw\ndGlvbihvaWQpOwogICAgICAgIHJldHVybiBvYmo7CiAgICB9CgogICAgcHVi\nbGljIE9iamVjdCB3cml0ZVJlcGxhY2UoKQogICAgICAgIHRocm93cyBPYmpl\nY3RTdHJlYW1FeGNlcHRpb24gewogICAgICAgIHJldHVybiBfcXVlcnk7CiAg\nICB9CgogICAgcHVibGljIFF1ZXJ5Q29udGV4dCBnZXRDb250ZXh0KCkgewog\nICAgICAgIHJldHVybiBfcXVlcnkuZ2V0Q29udGV4dCgpOwogICAgfQoKICAg\nIHB1YmxpYyB2b2lkIHNldENvbnRleHQoUXVlcnlDb250ZXh0IHFjdHgpIHsK\nICAgICAgICBfcXVlcnkuc2V0Q29udGV4dChxY3R4KTsKICAgICAgICBfc2N0\neCA9IHFjdHguZ2V0U3RvcmVDb250ZXh0KCk7CiAgICAgICAgX3JlcG9zID0g\nX3NjdHguZ2V0Q29uZmlndXJhdGlvbigpLmdldE1ldGFEYXRhUmVwb3NpdG9y\neUluc3RhbmNlKCk7CiAgICB9CgogICAgcHVibGljIGJvb2xlYW4gc2V0UXVl\ncnkoT2JqZWN0IHF1ZXJ5KSB7CiAgICAgICAgcmV0dXJuIF9xdWVyeS5zZXRR\ndWVyeShxdWVyeSk7CiAgICB9CgogICAgcHVibGljIEZpbHRlckxpc3RlbmVy\nIGdldEZpbHRlckxpc3RlbmVyKFN0cmluZyB0YWcpIHsKICAgICAgICByZXR1\ncm4gX3F1ZXJ5LmdldEZpbHRlckxpc3RlbmVyKHRhZyk7CiAgICB9CgogICAg\ncHVibGljIEFnZ3JlZ2F0ZUxpc3RlbmVyIGdldEFnZ3JlZ2F0ZUxpc3RlbmVy\nKFN0cmluZyB0YWcpIHsKICAgICAgICByZXR1cm4gX3F1ZXJ5LmdldEFnZ3Jl\nZ2F0ZUxpc3RlbmVyKHRhZyk7CiAgICB9CgogICAgcHVibGljIE9iamVjdCBu\nZXdDb21waWxhdGlvbktleSgpIHsKICAgICAgICByZXR1cm4gX3F1ZXJ5Lm5l\nd0NvbXBpbGF0aW9uS2V5KCk7CiAgICB9CgogICAgcHVibGljIE9iamVjdCBu\nZXdDb21waWxhdGlvbigpIHsKICAgICAgICByZXR1cm4gX3F1ZXJ5Lm5ld0Nv\nbXBpbGF0aW9uKCk7CiAgICB9CgogICAgcHVibGljIHZvaWQgcG9wdWxhdGVG\ncm9tQ29tcGlsYXRpb24oT2JqZWN0IGNvbXApIHsKICAgICAgICBfcXVlcnku\ncG9wdWxhdGVGcm9tQ29tcGlsYXRpb24oY29tcCk7CiAgICB9CgogICAgcHVi\nbGljIHZvaWQgaW52YWxpZGF0ZUNvbXBpbGF0aW9uKCkgewogICAgICAgIF9x\ndWVyeS5pbnZhbGlkYXRlQ29tcGlsYXRpb24oKTsKICAgIH0KCiAgICBwdWJs\naWMgYm9vbGVhbiBzdXBwb3J0c0RhdGFTdG9yZUV4ZWN1dGlvbigpIHsKICAg\nICAgICByZXR1cm4gX3F1ZXJ5LnN1cHBvcnRzRGF0YVN0b3JlRXhlY3V0aW9u\nKCk7CiAgICB9CgogICAgcHVibGljIGJvb2xlYW4gc3VwcG9ydHNJbk1lbW9y\neUV4ZWN1dGlvbigpIHsKICAgICAgICByZXR1cm4gX3F1ZXJ5LnN1cHBvcnRz\nSW5NZW1vcnlFeGVjdXRpb24oKTsKICAgIH0KCiAgICBwdWJsaWMgRXhlY3V0\nb3IgbmV3SW5NZW1vcnlFeGVjdXRvcihDbGFzc01ldGFEYXRhIG1ldGEsIGJv\nb2xlYW4gc3VicykgewogICAgICAgIHJldHVybiBfcXVlcnkubmV3SW5NZW1v\ncnlFeGVjdXRvcihtZXRhLCBzdWJzKTsKICAgIH0KCiAgICBwdWJsaWMgRXhl\nY3V0b3IgbmV3RGF0YVN0b3JlRXhlY3V0b3IoQ2xhc3NNZXRhRGF0YSBtZXRh\nLCBib29sZWFuIHN1YnMpIHsKICAgICAgICBFeGVjdXRvciBleCA9IF9xdWVy\neS5uZXdEYXRhU3RvcmVFeGVjdXRvcihtZXRhLCBzdWJzKTsKICAgICAgICBy\nZXR1cm4gbmV3IFF1ZXJ5Q2FjaGVFeGVjdXRvcihleCwgbWV0YSwgc3Vicyk7\nCiAgICB9CgogICAgcHVibGljIGJvb2xlYW4gc3VwcG9ydHNBYnN0cmFjdEV4\nZWN1dG9ycygpIHsKICAgICAgICByZXR1cm4gX3F1ZXJ5LnN1cHBvcnRzQWJz\ndHJhY3RFeGVjdXRvcnMoKTsKICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBy\nZXF1aXJlc0NhbmRpZGF0ZVR5cGUoKSB7CiAgICAgICAgcmV0dXJuIF9xdWVy\neS5yZXF1aXJlc0NhbmRpZGF0ZVR5cGUoKTsKICAgIH0KCiAgICBwdWJsaWMg\nYm9vbGVhbiByZXF1aXJlc1BhcmFtZXRlckRlY2xhcmF0aW9ucygpIHsKICAg\nICAgICByZXR1cm4gX3F1ZXJ5LnJlcXVpcmVzUGFyYW1ldGVyRGVjbGFyYXRp\nb25zKCk7CiAgICB9CgogICAgcHVibGljIGJvb2xlYW4gc3VwcG9ydHNQYXJh\nbWV0ZXJEZWNsYXJhdGlvbnMoKSB7CiAgICAgICAgcmV0dXJuIF9xdWVyeS5z\ndXBwb3J0c1BhcmFtZXRlckRlY2xhcmF0aW9ucygpOwogICAgfQoKICAgIC8q\nKgogICAgICogQ2FjaGluZyBleGVjdXRvci4KICAgICAqLwogICAgcHJpdmF0\nZSBzdGF0aWMgY2xhc3MgUXVlcnlDYWNoZUV4ZWN1dG9yCiAgICAgICAgaW1w\nbGVtZW50cyBFeGVjdXRvciB7CgogICAgICAgIHByaXZhdGUgZmluYWwgRXhl\nY3V0b3IgX2V4OwogICAgICAgIHByaXZhdGUgZmluYWwgQ2xhc3MgX2NhbmRp\nZGF0ZTsKICAgICAgICBwcml2YXRlIGZpbmFsIGJvb2xlYW4gX3N1YnM7Cgog\nICAgICAgIHB1YmxpYyBRdWVyeUNhY2hlRXhlY3V0b3IoRXhlY3V0b3IgZXgs\nIENsYXNzTWV0YURhdGEgbWV0YSwKICAgICAgICAgICAgYm9vbGVhbiBzdWJz\nKSB7CiAgICAgICAgICAgIF9leCA9IGV4OwogICAgICAgICAgICBfY2FuZGlk\nYXRlID0gKG1ldGEgPT0gbnVsbCkgPyBudWxsIDogbWV0YS5nZXREZXNjcmli\nZWRUeXBlKCk7CiAgICAgICAgICAgIF9zdWJzID0gc3ViczsKICAgICAgICB9\nCgogICAgICAgIHB1YmxpYyBSZXN1bHRPYmplY3RQcm92aWRlciBleGVjdXRl\nUXVlcnkoU3RvcmVRdWVyeSBxLCBPYmplY3RbXSBwYXJhbXMsCiAgICAgICAg\nICAgIFJhbmdlIHJhbmdlKSB7CiAgICAgICAgICAgIFF1ZXJ5Q2FjaGVTdG9y\nZVF1ZXJ5IGNxID0gKFF1ZXJ5Q2FjaGVTdG9yZVF1ZXJ5KSBxOwogICAgICAg\nICAgICBRdWVyeUtleSBrZXkgPSBRdWVyeUtleS5uZXdJbnN0YW5jZShjcS5n\nZXRDb250ZXh0KCksCiAgICAgICAgICAgICAgICBfZXguaXNQYWNraW5nKHEp\nLCBwYXJhbXMsIF9jYW5kaWRhdGUsIF9zdWJzLCByYW5nZS5zdGFydCwgCiAg\nICAgICAgICAgICAgICByYW5nZS5lbmQpOwogICAgICAgICAgICBMaXN0IGNh\nY2hlZCA9IGNxLmNoZWNrQ2FjaGUoa2V5KTsKICAgICAgICAgICAgaWYgKGNh\nY2hlZCAhPSBudWxsKQogICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBMaXN0\nUmVzdWx0T2JqZWN0UHJvdmlkZXIoY2FjaGVkKTsKCiAgICAgICAgICAgIFJl\nc3VsdE9iamVjdFByb3ZpZGVyIHJvcCA9IF9leC5leGVjdXRlUXVlcnkoY3Eu\nZ2V0RGVsZWdhdGUoKSwKICAgICAgICAgICAgICAgIHBhcmFtcywgcmFuZ2Up\nOwogICAgICAgICAgICByZXR1cm4gY3Eud3JhcFJlc3VsdChyb3AsIGtleSk7\nCiAgICAgICAgfQoKICAgICAgICAvKioKICAgICAgICAgKiBDbGVhciB0aGUg\nY2FjaGVkIHF1ZXJpZXMgYXNzb2NpYXRlZCB3aXRoIHRoZSBhY2Nlc3MgcGF0\naAogICAgICAgICAqIGNsYXNzZXMgaW4gdGhlIHF1ZXJ5LiBUaGlzIGlzIGRv\nbmUgd2hlbiBidWxrIG9wZXJhdGlvbnMKICAgICAgICAgKiAoc3VjaCBhcyBk\nZWxldGVzIG9yIHVwZGF0ZXMpIGFyZSBwZXJmb3JtZWQgc28gdGhhdCB0aGUK\nICAgICAgICAgKiBjYWNoZSByZW1haW5zIHVwLXRvLWRhdGUuCiAgICAgICAg\nICovCiAgICAgICAgcHJpdmF0ZSB2b2lkIGNsZWFyQWNjZXNzUGF0aChTdG9y\nZVF1ZXJ5IHEpIHsKICAgICAgICAgICAgaWYgKHEgPT0gbnVsbCkKICAgICAg\nICAgICAgICAgIHJldHVybjsKCiAgICAgICAgICAgIENsYXNzTWV0YURhdGFb\nXSBjbWQgPSBnZXRBY2Nlc3NQYXRoTWV0YURhdGFzKHEpOwogICAgICAgICAg\nICBpZiAoY21kID09IG51bGwgfHwgY21kLmxlbmd0aCA9PSAwKQogICAgICAg\nICAgICAgICAgcmV0dXJuOwoKICAgICAgICAgICAgTGlzdCBjbGFzc2VzID0g\nbmV3IEFycmF5TGlzdChjbWQubGVuZ3RoKTsKICAgICAgICAgICAgZm9yIChp\nbnQgaSA9IDA7IGkgPCBjbWQubGVuZ3RoOyBpKyspCiAgICAgICAgICAgICAg\nICBjbGFzc2VzLmFkZChjbWRbaV0uZ2V0RGVzY3JpYmVkVHlwZSgpKTsKCiAg\nICAgICAgICAgIC8vIGV2aWN0IGZyb20gdGhlIHF1ZXJ5IGNhY2hlCiAgICAg\nICAgICAgIFF1ZXJ5Q2FjaGVTdG9yZVF1ZXJ5IGNxID0gKFF1ZXJ5Q2FjaGVT\ndG9yZVF1ZXJ5KSBxOwogICAgICAgICAgICBjcS5nZXRDYWNoZSgpLm9uVHlw\nZXNDaGFuZ2VkKG5ldyBUeXBlc0NoYW5nZWRFdmVudAogICAgICAgICAgICAg\nICAgKHEuZ2V0Q29udGV4dCgpLCBjbGFzc2VzKSk7CgogICAgICAgICAgICAv\nLyBldmljdCBmcm9tIHRoZSBkYXRhIGNhY2hlCiAgICAgICAgICAgIGZvciAo\naW50IGkgPSAwOyBpIDwgY21kLmxlbmd0aDsgaSsrKQogICAgICAgICAgICAg\nICAgY21kW2ldLmdldERhdGFDYWNoZSgpLnJlbW92ZUFsbCgKICAgICAgICAg\nICAgICAgICAgICBjbWRbaV0uZ2V0RGVzY3JpYmVkVHlwZSgpLCB0cnVlKTsK\nICAgICAgICB9CgogICAgICAgIHB1YmxpYyBOdW1iZXIgZXhlY3V0ZURlbGV0\nZShTdG9yZVF1ZXJ5IHEsIE9iamVjdFtdIHBhcmFtcykgewogICAgICAgICAg\nICB0cnkgewogICAgICAgICAgICAgICAgcmV0dXJuIF9leC5leGVjdXRlRGVs\nZXRlKHVud3JhcChxKSwgcGFyYW1zKTsKICAgICAgICAgICAgfSBmaW5hbGx5\nIHsKICAgICAgICAgICAgICAgIGNsZWFyQWNjZXNzUGF0aChxKTsKICAgICAg\nICAgICAgfQogICAgICAgIH0KCiAgICAgICAgcHVibGljIE51bWJlciBleGVj\ndXRlVXBkYXRlKFN0b3JlUXVlcnkgcSwgT2JqZWN0W10gcGFyYW1zKSB7CiAg\nICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICByZXR1cm4gX2V4LmV4\nZWN1dGVVcGRhdGUodW53cmFwKHEpLCBwYXJhbXMpOwogICAgICAgICAgICB9\nIGZpbmFsbHkgewogICAgICAgICAgICAgICAgY2xlYXJBY2Nlc3NQYXRoKHEp\nOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgU3Ry\naW5nW10gZ2V0RGF0YVN0b3JlQWN0aW9ucyhTdG9yZVF1ZXJ5IHEsIE9iamVj\ndFtdIHBhcmFtcywKICAgICAgICAgICAgUmFuZ2UgcmFuZ2UpIHsKICAgICAg\nICAgICAgcmV0dXJuIEVNUFRZX1NUUklOR1M7CiAgICAgICAgfQoKICAgICAg\nICBwdWJsaWMgdm9pZCB2YWxpZGF0ZShTdG9yZVF1ZXJ5IHEpIHsKICAgICAg\nICAgICAgX2V4LnZhbGlkYXRlKHVud3JhcChxKSk7CiAgICAgICAgfQogICAg\nICAgIAogICAgICAgIHB1YmxpYyB2b2lkIGdldFJhbmdlKFN0b3JlUXVlcnkg\ncSwgT2JqZWN0W10gcGFyYW1zLCBSYW5nZSByYW5nZSkgewogICAgICAgICAg\nICBfZXguZ2V0UmFuZ2UocSwgcGFyYW1zLCByYW5nZSk7IAogICAgICAgIH0K\nCiAgICAgICAgcHVibGljIE9iamVjdCBnZXRPcmRlcmluZ1ZhbHVlKFN0b3Jl\nUXVlcnkgcSwgT2JqZWN0W10gcGFyYW1zLAogICAgICAgICAgICBPYmplY3Qg\ncmVzdWx0T2JqZWN0LCBpbnQgb3JkZXJJbmRleCkgewogICAgICAgICAgICBy\nZXR1cm4gX2V4LmdldE9yZGVyaW5nVmFsdWUodW53cmFwKHEpLCBwYXJhbXMs\nIHJlc3VsdE9iamVjdCwKICAgICAgICAgICAgICAgIG9yZGVySW5kZXgpOwog\nICAgICAgIH0KCiAgICAgICAgcHVibGljIGJvb2xlYW5bXSBnZXRBc2NlbmRp\nbmcoU3RvcmVRdWVyeSBxKSB7CiAgICAgICAgICAgIHJldHVybiBfZXguZ2V0\nQXNjZW5kaW5nKHVud3JhcChxKSk7CiAgICAgICAgfQoKICAgICAgICBwdWJs\naWMgYm9vbGVhbiBpc1BhY2tpbmcoU3RvcmVRdWVyeSBxKSB7CiAgICAgICAg\nICAgIHJldHVybiBfZXguaXNQYWNraW5nKHVud3JhcChxKSk7CiAgICAgICAg\nfQoKICAgICAgICBwdWJsaWMgU3RyaW5nIGdldEFsaWFzKFN0b3JlUXVlcnkg\ncSkgewogICAgICAgICAgICByZXR1cm4gX2V4LmdldEFsaWFzKHVud3JhcChx\nKSk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgQ2xhc3MgZ2V0UmVzdWx0\nQ2xhc3MoU3RvcmVRdWVyeSBxKSB7CiAgICAgICAgICAgIHJldHVybiBfZXgu\nZ2V0UmVzdWx0Q2xhc3ModW53cmFwKHEpKTsKICAgICAgICB9CgogICAgICAg\nIHB1YmxpYyBTdHJpbmdbXSBnZXRQcm9qZWN0aW9uQWxpYXNlcyhTdG9yZVF1\nZXJ5IHEpIHsKICAgICAgICAgICAgcmV0dXJuIF9leC5nZXRQcm9qZWN0aW9u\nQWxpYXNlcyh1bndyYXAocSkpOwogICAgICAgIH0KCiAgICAgICAgcHVibGlj\nIENsYXNzW10gZ2V0UHJvamVjdGlvblR5cGVzKFN0b3JlUXVlcnkgcSkgewog\nICAgICAgICAgICByZXR1cm4gX2V4LmdldFByb2plY3Rpb25UeXBlcyh1bndy\nYXAocSkpOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIENsYXNzTWV0YURh\ndGFbXSBnZXRBY2Nlc3NQYXRoTWV0YURhdGFzKFN0b3JlUXVlcnkgcSkgewog\nICAgICAgICAgICByZXR1cm4gX2V4LmdldEFjY2Vzc1BhdGhNZXRhRGF0YXMo\ndW53cmFwKHEpKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBpbnQgZ2V0\nT3BlcmF0aW9uKFN0b3JlUXVlcnkgcSkgewogICAgICAgICAgICByZXR1cm4g\nX2V4LmdldE9wZXJhdGlvbih1bndyYXAocSkpOwogICAgICAgIH0KCiAgICAg\nICAgcHVibGljIGJvb2xlYW4gaXNBZ2dyZWdhdGUoU3RvcmVRdWVyeSBxKSB7\nCiAgICAgICAgICAgIHJldHVybiBfZXguaXNBZ2dyZWdhdGUodW53cmFwKHEp\nKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBib29sZWFuIGhhc0dyb3Vw\naW5nKFN0b3JlUXVlcnkgcSkgewogICAgICAgICAgICByZXR1cm4gX2V4Lmhh\nc0dyb3VwaW5nKHVud3JhcChxKSk7CiAgICAgICAgfQoKICAgICAgICBwdWJs\naWMgTGlua2VkTWFwIGdldFBhcmFtZXRlclR5cGVzKFN0b3JlUXVlcnkgcSkg\newogICAgICAgICAgICByZXR1cm4gX2V4LmdldFBhcmFtZXRlclR5cGVzKHVu\nd3JhcChxKSk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgTWFwIGdldFVw\nZGF0ZXMoU3RvcmVRdWVyeSBxKSB7CiAgICAgICAgICAgIHJldHVybiBfZXgu\nZ2V0VXBkYXRlcyh1bndyYXAocSkpOwogICAgICAgIH0KCiAgICAgICAgcHJp\ndmF0ZSBzdGF0aWMgU3RvcmVRdWVyeSB1bndyYXAoU3RvcmVRdWVyeSBxKSB7\nCiAgICAgICAgICAgIHJldHVybiAoKFF1ZXJ5Q2FjaGVTdG9yZVF1ZXJ5KSBx\nKS5nZXREZWxlZ2F0ZSgpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAg\nICAqIFJlc3VsdCBsaXN0IGltcGxlbWVudGF0aW9uIGZvciBhIGNhY2hlZCBx\ndWVyeSByZXN1bHQuIFBhY2thZ2UtcHJvdGVjdGVkCiAgICAgKiBmb3IgdGVz\ndGluZy4KICAgICAqLwogICAgcHVibGljIHN0YXRpYyBjbGFzcyBDYWNoZWRM\naXN0CiAgICAgICAgZXh0ZW5kcyBBYnN0cmFjdExpc3QKICAgICAgICBpbXBs\nZW1lbnRzIFNlcmlhbGl6YWJsZSB7CgogICAgICAgIHByaXZhdGUgZmluYWwg\nUXVlcnlSZXN1bHQgX3JlczsKICAgICAgICBwcml2YXRlIGZpbmFsIGJvb2xl\nYW4gX3Byb2o7CiAgICAgICAgcHJpdmF0ZSBmaW5hbCBTdG9yZUNvbnRleHQg\nX3NjdHg7CgogICAgICAgIHB1YmxpYyBDYWNoZWRMaXN0KFF1ZXJ5UmVzdWx0\nIHJlcywgYm9vbGVhbiBwcm9qLCBTdG9yZUNvbnRleHQgY3R4KSB7CiAgICAg\nICAgICAgIF9yZXMgPSByZXM7CiAgICAgICAgICAgIF9wcm9qID0gcHJvajsK\nICAgICAgICAgICAgX3NjdHggPSBjdHg7CiAgICAgICAgfQoKICAgICAgICBw\ndWJsaWMgT2JqZWN0IGdldChpbnQgaWR4KSB7CiAgICAgICAgICAgIGlmICgh\nX3Byb2opCiAgICAgICAgICAgICAgICByZXR1cm4gZnJvbU9iamVjdElkKF9y\nZXMuZ2V0KGlkeCksIF9zY3R4KTsKCiAgICAgICAgICAgIE9iamVjdFtdIGNh\nY2hlZCA9IChPYmplY3RbXSkgX3Jlcy5nZXQoaWR4KTsKICAgICAgICAgICAg\naWYgKGNhY2hlZCA9PSBudWxsKQogICAgICAgICAgICAgICAgcmV0dXJuIG51\nbGw7CiAgICAgICAgICAgIE9iamVjdFtdIHVuY2FjaGVkID0gbmV3IE9iamVj\ndFtjYWNoZWQubGVuZ3RoXTsKICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7\nIGkgPCBjYWNoZWQubGVuZ3RoOyBpKyspCiAgICAgICAgICAgICAgICB1bmNh\nY2hlZFtpXSA9IGNvcHlQcm9qZWN0aW9uKGNhY2hlZFtpXSwgX3NjdHgpOwog\nICAgICAgICAgICByZXR1cm4gdW5jYWNoZWQ7CiAgICAgICAgfQoKICAgICAg\nICBwdWJsaWMgaW50IHNpemUoKSB7CiAgICAgICAgICAgIHJldHVybiBfcmVz\nLnNpemUoKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBPYmplY3Qgd3Jp\ndGVSZXBsYWNlKCkKICAgICAgICAgICAgdGhyb3dzIE9iamVjdFN0cmVhbUV4\nY2VwdGlvbiB7CiAgICAgICAgICAgIHJldHVybiBuZXcgQXJyYXlMaXN0KHRo\naXMpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIEEgd3JhcHBl\nciBhcm91bmQgYSB7QGxpbmsgUmVzdWx0T2JqZWN0UHJvdmlkZXJ9IHRoYXQg\nYnVpbGRzIHVwIGEgbGlzdCBvZgogICAgICogYWxsIHRoZSBPSURzIGluIHRo\naXMgbGlzdCBhbmQgcmVnaXN0ZXJzIHRoYXQgbGlzdCB3aXRoIHRoZQogICAg\nICogcXVlcnkgY2FjaGUuIEFiYW5kb25zIG1vbml0b3JpbmcgYW5kIHJlZ2lz\ndGVyaW5nIGlmIG9uZSBvZiB0aGUgY2xhc3NlcwogICAgICogaW4gdGhlIGFj\nY2VzcyBwYXRoIGlzIG1vZGlmaWVkIHdoaWxlIHRoZSBxdWVyeSByZXN1bHRz\nIGFyZSBiZWluZyBsb2FkZWQuCiAgICAgKi8KICAgIHByaXZhdGUgY2xhc3Mg\nQ2FjaGluZ1Jlc3VsdE9iamVjdFByb3ZpZGVyCiAgICAgICAgaW1wbGVtZW50\ncyBSZXN1bHRPYmplY3RQcm92aWRlciwgVHlwZXNDaGFuZ2VkTGlzdGVuZXIg\newoKICAgICAgICBwcml2YXRlIGZpbmFsIFJlc3VsdE9iamVjdFByb3ZpZGVy\nIF9yb3A7CiAgICAgICAgcHJpdmF0ZSBmaW5hbCBib29sZWFuIF9wcm9qOwog\nICAgICAgIHByaXZhdGUgZmluYWwgUXVlcnlLZXkgX3FrOwogICAgICAgIHBy\naXZhdGUgZmluYWwgVHJlZU1hcCBfZGF0YSA9IG5ldyBUcmVlTWFwKCk7CiAg\nICAgICAgcHJpdmF0ZSBib29sZWFuIF9tYWludGFpbkNhY2hlID0gdHJ1ZTsK\nICAgICAgICBwcml2YXRlIGludCBfcG9zID0gLTE7CgogICAgICAgIC8vIHVz\nZWQgdG8gZGV0ZXJtaW5lIGxpc3Qgc2l6ZSB3aXRob3V0IG5lY2Vzc2FyaWx5\nIGNhbGxpbmcgc2l6ZSgpLAogICAgICAgIC8vIHdoaWNoIG1heSByZXF1aXJl\nIGEgREIgdHJpcCBvciByZXR1cm4gSW50ZWdlci5NQVhfVkFMVUUKICAgICAg\nICBwcml2YXRlIGludCBfbWF4ID0gLTE7CiAgICAgICAgcHJpdmF0ZSBpbnQg\nX3NpemUgPSBJbnRlZ2VyLk1BWF9WQUxVRTsKCiAgICAgICAgLyoqCiAgICAg\nICAgICogQ29uc3RydWN0b3IuIFN1cHBseSBkZWxlZ2F0ZSByZXN1bHQgcHJv\ndmlkZXIgYW5kIG91ciBxdWVyeSBrZXkuCiAgICAgICAgICovCiAgICAgICAg\ncHVibGljIENhY2hpbmdSZXN1bHRPYmplY3RQcm92aWRlcihSZXN1bHRPYmpl\nY3RQcm92aWRlciByb3AsCiAgICAgICAgICAgIGJvb2xlYW4gcHJvaiwgUXVl\ncnlLZXkga2V5KSB7CiAgICAgICAgICAgIF9yb3AgPSByb3A7CiAgICAgICAg\nICAgIF9wcm9qID0gcHJvajsKICAgICAgICAgICAgX3FrID0ga2V5OwogICAg\nICAgICAgICBfY2FjaGUuYWRkVHlwZXNDaGFuZ2VkTGlzdGVuZXIodGhpcyk7\nCiAgICAgICAgfQoKICAgICAgICAvKioKICAgICAgICAgKiBTdG9wIGNhY2hp\nbmcuCiAgICAgICAgICovCiAgICAgICAgcHJpdmF0ZSB2b2lkIGFib3J0Q2Fj\naGluZygpIHsKICAgICAgICAgICAgaWYgKCFfbWFpbnRhaW5DYWNoZSkKICAg\nICAgICAgICAgICAgIHJldHVybjsKCiAgICAgICAgICAgIC8vIHRoaXMgY2Fu\nIGJlIGNhbGxlZCB2aWEgYW4gZXZlbnQgZnJvbSBhbm90aGVyIHRocmVhZAog\nICAgICAgICAgICBzeW5jaHJvbml6ZWQgKHRoaXMpIHsKICAgICAgICAgICAg\nICAgIC8vIGl0J3MgaW1wb3J0YW50IHRoYXQgd2Ugc2V0IHRoaXMgZmxhZyBm\naXJzdCBzbyB0aGF0IGFueQogICAgICAgICAgICAgICAgLy8gc3Vic2VxdWVu\ndCBjYWxscyB0byB0aGlzIG9iamVjdCBhcmUgYnlwYXNzZWQuCiAgICAgICAg\nICAgICAgICBfbWFpbnRhaW5DYWNoZSA9IGZhbHNlOwogICAgICAgICAgICAg\nICAgX2NhY2hlLnJlbW92ZVR5cGVzQ2hhbmdlZExpc3RlbmVyKHRoaXMpOwog\nICAgICAgICAgICAgICAgX2RhdGEuY2xlYXIoKTsKICAgICAgICAgICAgfQog\nICAgICAgIH0KCiAgICAgICAgLyoqCiAgICAgICAgICogQ2hlY2sgd2hldGhl\nciB3ZSd2ZSBidWZmZXJlZCBhbGwgcmVzdWx0cywgd2hpbGUgb3B0aW9uYWxs\neSBhZGRpbmcKICAgICAgICAgKiB0aGUgZ2l2ZW4gcmVzdWx0LgogICAgICAg\nICAqLwogICAgICAgIHByaXZhdGUgdm9pZCBjaGVja0ZpbmlzaGVkKE9iamVj\ndCBvYmosIGJvb2xlYW4gcmVzdWx0KSB7CiAgICAgICAgICAgIC8vIHRoaXMg\nY2FuIGJlIGNhbGxlZCBhdCB0aGUgc2FtZSB0aW1lIGFzIGFib3J0Q2FjaGlu\nZyB2aWEKICAgICAgICAgICAgLy8gYSB0eXBlcyBjaGFuZ2VkIGV2ZW50CiAg\nICAgICAgICAgIGJvb2xlYW4gZmluaXNoZWQgPSBmYWxzZTsKICAgICAgICAg\nICAgc3luY2hyb25pemVkICh0aGlzKSB7CiAgICAgICAgICAgICAgICBpZiAo\nX21haW50YWluQ2FjaGUpIHsKICAgICAgICAgICAgICAgICAgICBpZiAocmVz\ndWx0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIEludGVnZXIgaW5kZXgg\nPSBOdW1iZXJzLnZhbHVlT2YoX3Bvcyk7CiAgICAgICAgICAgICAgICAgICAg\nICAgIGlmICghX2RhdGEuY29udGFpbnNLZXkoaW5kZXgpKSB7CiAgICAgICAg\nICAgICAgICAgICAgICAgICAgICBPYmplY3QgY2FjaGVkOwogICAgICAgICAg\nICAgICAgICAgICAgICAgICAgaWYgKG9iaiA9PSBudWxsKQogICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgIGNhY2hlZCA9IG51bGw7CiAgICAgICAg\nICAgICAgICAgICAgICAgICAgICBlbHNlIGlmICghX3Byb2opCiAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgY2FjaGVkID0gX3NjdHguZ2V0T2Jq\nZWN0SWQob2JqKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Ug\newogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE9iamVjdFtdIGFy\nciA9IChPYmplY3RbXSkgb2JqOwogICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgIE9iamVjdFtdIGNwID0gbmV3IE9iamVjdFthcnIubGVuZ3RoXTsK\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGludCBpID0g\nMDsgaSA8IGFyci5sZW5ndGg7IGkrKykKICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgY3BbaV0gPSBjb3B5UHJvamVjdGlvbihhcnJbaV0s\nIF9zY3R4KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWNo\nZWQgPSBjcDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAg\nICAgICAgICAgICAgICAgICAgICAgIGlmIChjYWNoZWQgIT0gbnVsbCkKICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfZGF0YS5wdXQoaW5kZXgs\nIGNhY2hlZCk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAg\nICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZmluaXNoZWQgPSBf\nc2l6ZSA9PSBfZGF0YS5zaXplKCk7CiAgICAgICAgICAgICAgICB9CiAgICAg\nICAgICAgIH0KCiAgICAgICAgICAgIGlmIChmaW5pc2hlZCkgewogICAgICAg\nICAgICAgICAgLy8gYW4gYWJvcnRDYWNoaW5nIGNhbGwgY2FuIHNuZWFrIGlu\nIGhlcmUgdmlhIG9uRXhwaXJlOyB0aGUKICAgICAgICAgICAgICAgIC8vIGNh\nY2hlIGlzIGxvY2tlZCBkdXJpbmcgZXZlbnQgZmlyaW5ncywgc28gdGhlIGxv\nY2sgaGVyZSB3aWxsCiAgICAgICAgICAgICAgICAvLyB3YWl0IGZvciBpdCAo\nb3Igd2lsbCBmb3JjZSB0aGUgbmV4dCBmaXJpbmcgdG8gd2FpdCkKICAgICAg\nICAgICAgICAgIF9jYWNoZS53cml0ZUxvY2soKTsKICAgICAgICAgICAgICAg\nIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgLy8gbWFrZSBzdXJlIHdlIGRp\nZG4ndCBhYm9ydAogICAgICAgICAgICAgICAgICAgIGlmIChfbWFpbnRhaW5D\nYWNoZSkgewogICAgICAgICAgICAgICAgICAgICAgICBRdWVyeVJlc3VsdCBy\nZXMgPSBuZXcgUXVlcnlSZXN1bHQoX3FrLCBfZGF0YS52YWx1ZXMoKSk7CiAg\nICAgICAgICAgICAgICAgICAgICAgIF9jYWNoZS5wdXQoX3FrLCByZXMpOwog\nICAgICAgICAgICAgICAgICAgICAgICBhYm9ydENhY2hpbmcoKTsKICAgICAg\nICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAg\nICAgICBmaW5hbGx5IHsKICAgICAgICAgICAgICAgICAgICBfY2FjaGUud3Jp\ndGVVbmxvY2soKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQog\nICAgICAgIH0KCiAgICAgICAgcHVibGljIGJvb2xlYW4gc3VwcG9ydHNSYW5k\nb21BY2Nlc3MoKSB7CiAgICAgICAgICAgIHJldHVybiBfcm9wLnN1cHBvcnRz\nUmFuZG9tQWNjZXNzKCk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgdm9p\nZCBvcGVuKCkKICAgICAgICAgICAgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAg\nICAgICAgIF9yb3Aub3BlbigpOwogICAgICAgIH0KCiAgICAgICAgcHVibGlj\nIE9iamVjdCBnZXRSZXN1bHRPYmplY3QoKQogICAgICAgICAgICB0aHJvd3Mg\nRXhjZXB0aW9uIHsKICAgICAgICAgICAgT2JqZWN0IG9iaiA9IF9yb3AuZ2V0\nUmVzdWx0T2JqZWN0KCk7CiAgICAgICAgICAgIGNoZWNrRmluaXNoZWQob2Jq\nLCB0cnVlKTsKICAgICAgICAgICAgcmV0dXJuIG9iajsKICAgICAgICB9Cgog\nICAgICAgIHB1YmxpYyBib29sZWFuIG5leHQoKQogICAgICAgICAgICB0aHJv\nd3MgRXhjZXB0aW9uIHsKICAgICAgICAgICAgX3BvcysrOwogICAgICAgICAg\nICBib29sZWFuIG5leHQgPSBfcm9wLm5leHQoKTsKICAgICAgICAgICAgaWYg\nKCFuZXh0ICYmIF9wb3MgPT0gX21heCArIDEpIHsKICAgICAgICAgICAgICAg\nIF9zaXplID0gX3BvczsKICAgICAgICAgICAgICAgIGNoZWNrRmluaXNoZWQo\nbnVsbCwgZmFsc2UpOwogICAgICAgICAgICB9IGVsc2UgaWYgKG5leHQgJiYg\nX3BvcyA+IF9tYXgpCiAgICAgICAgICAgICAgICBfbWF4ID0gX3BvczsKICAg\nICAgICAgICAgcmV0dXJuIG5leHQ7CiAgICAgICAgfQoKICAgICAgICBwdWJs\naWMgYm9vbGVhbiBhYnNvbHV0ZShpbnQgcG9zKQogICAgICAgICAgICB0aHJv\nd3MgRXhjZXB0aW9uIHsKICAgICAgICAgICAgX3BvcyA9IHBvczsKICAgICAg\nICAgICAgYm9vbGVhbiB2YWxpZCA9IF9yb3AuYWJzb2x1dGUocG9zKTsKICAg\nICAgICAgICAgaWYgKCF2YWxpZCAmJiBfcG9zID09IF9tYXggKyAxKSB7CiAg\nICAgICAgICAgICAgICBfc2l6ZSA9IF9wb3M7CiAgICAgICAgICAgICAgICBj\naGVja0ZpbmlzaGVkKG51bGwsIGZhbHNlKTsKICAgICAgICAgICAgfSBlbHNl\nIGlmICh2YWxpZCAmJiBfcG9zID4gX21heCkKICAgICAgICAgICAgICAgIF9t\nYXggPSBfcG9zOwogICAgICAgICAgICByZXR1cm4gdmFsaWQ7CiAgICAgICAg\nfQoKICAgICAgICBwdWJsaWMgaW50IHNpemUoKQogICAgICAgICAgICB0aHJv\nd3MgRXhjZXB0aW9uIHsKICAgICAgICAgICAgaWYgKF9zaXplICE9IEludGVn\nZXIuTUFYX1ZBTFVFKQogICAgICAgICAgICAgICAgcmV0dXJuIF9zaXplOwog\nICAgICAgICAgICBpbnQgc2l6ZSA9IF9yb3Auc2l6ZSgpOwogICAgICAgICAg\nICBfc2l6ZSA9IHNpemU7CiAgICAgICAgICAgIGNoZWNrRmluaXNoZWQobnVs\nbCwgZmFsc2UpOwogICAgICAgICAgICByZXR1cm4gc2l6ZTsKICAgICAgICB9\nCgogICAgICAgIHB1YmxpYyB2b2lkIHJlc2V0KCkKICAgICAgICAgICAgdGhy\nb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgICAgIF9yb3AucmVzZXQoKTsKICAg\nICAgICAgICAgX3BvcyA9IC0xOwogICAgICAgIH0KCiAgICAgICAgcHVibGlj\nIHZvaWQgY2xvc2UoKQogICAgICAgICAgICB0aHJvd3MgRXhjZXB0aW9uIHsK\nICAgICAgICAgICAgYWJvcnRDYWNoaW5nKCk7CiAgICAgICAgICAgIF9yb3Au\nY2xvc2UoKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyB2b2lkIGhhbmRs\nZUNoZWNrZWRFeGNlcHRpb24oRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAg\nX3JvcC5oYW5kbGVDaGVja2VkRXhjZXB0aW9uKGUpOwogICAgICAgIH0KCiAg\nICAgICAgcHVibGljIHZvaWQgb25UeXBlc0NoYW5nZWQoVHlwZXNDaGFuZ2Vk\nRXZlbnQgZXYpIHsKICAgICAgICAgICAgaWYgKF9xay5jaGFuZ2VJbnZhbGlk\nYXRlc1F1ZXJ5KGV2LmdldFR5cGVzKCkpKQogICAgICAgICAgICAgICAgYWJv\ncnRDYWNoaW5nKCk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICog\nU3RydWN0IHRvIHJlY29nbml6ZSBjYWNoZWQgb2lkcy4KICAgICAqLwogICAg\ncHJpdmF0ZSBzdGF0aWMgY2xhc3MgQ2FjaGVkT2JqZWN0SWQgewoKICAgICAg\nICBwdWJsaWMgZmluYWwgT2JqZWN0IG9pZDsKCiAgICAgICAgcHVibGljIENh\nY2hlZE9iamVjdElkIChPYmplY3Qgb2lkKQoJCXsKCQkJdGhpcy5vaWQgPSBv\naWQ7CgkJfQoJfQp9Cg==\n","encoding":"base64"}

