{"sha":"c9e210e503ff65680ef41ded0c80a3e945d4a207","node_id":"MDQ6QmxvYjIwNjM2NDpjOWUyMTBlNTAzZmY2NTY4MGVmNDFkZWQwYzgwYTNlOTQ1ZDRhMjA3","size":7934,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/c9e210e503ff65680ef41ded0c80a3e945d4a207","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuZWU7CgppbXBvcnQgamF2YS51\ndGlsLkxpbmtlZExpc3Q7CmltcG9ydCBqYXZhLnV0aWwuTGlzdDsKCmltcG9y\ndCBqYXZheC50cmFuc2FjdGlvbi5TeXN0ZW1FeGNlcHRpb247CmltcG9ydCBq\nYXZheC50cmFuc2FjdGlvbi5UcmFuc2FjdGlvbk1hbmFnZXI7CgppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLmxpYi5jb25mLkNvbmZpZ3VyYWJsZTsKaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIuY29uZi5Db25maWd1cmF0aW9u\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51dGlsLkxvY2FsaXpl\ncjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLkludmFsaWRTdGF0\nZUV4Y2VwdGlvbjsKCi8qKgogKiBJbXBsZW1lbnRhdGlvbiBvZiB0aGUge0Bs\naW5rIE1hbmFnZWRSdW50aW1lfSBpbnRlcmZhY2UgdGhhdCBzZWFyY2hlcwog\nKiB0aHJvdWdoIGEgc2V0IG9mIGtub3duIEpOREkgbG9jYXRpb25zIGFuZCBt\nZXRob2QgaW52b2NhdGlvbnMgdG8gbG9jYXRlIHRoZQogKiBhcHByb3ByaWF0\nZSBtZWNoYW5pc20gZm9yIG9idGFpbmluZyBhIFRyYW5zYWN0aW9uTWFuYWdl\nci4KICogIEJ1aWx0IGluIHN1cHBvcnQgaXMgcHJvdmlkZWQgZm9yIHRoZSBm\nb2xsb3dpbmcgQXBwbGljYXRpb24gU2VydmVyczoKICogPHVsPgogKiA8bGk+\nQmx1ZXN0b25lPC9saT4KICogPGxpPkhQIEFwcGxpY2F0aW9uIFNlcnZlcjwv\nbGk+CiAqIDxsaT5KQm9zczwvbGk+CiAqIDxsaT5KUnVuPC9saT4KICogPGxp\nPk9wZW5FSkI8L2xpPgogKiA8bGk+T3JhY2xlIEFwcGxpY2F0aW9uIFNlcnZl\ncjwvbGk+CiAqIDxsaT5PcmlvbjwvbGk+CiAqIDxsaT5TdW5PTkU8L2xpPgog\nKiA8bGk+V2VibG9naWM8L2xpPgogKiA8bGk+V2Vic3BoZXJlPC9saT4KICog\nPC91bD4KICoKICogQGF1dGhvciBNYXJjIFBydWQnaG9tbWVhdXgKICovCnB1\nYmxpYyBjbGFzcyBBdXRvbWF0aWNNYW5hZ2VkUnVudGltZSBleHRlbmRzIEFi\nc3RyYWN0TWFuYWdlZFJ1bnRpbWUKICAgIGltcGxlbWVudHMgTWFuYWdlZFJ1\nbnRpbWUsIENvbmZpZ3VyYWJsZSB7CgogICAgcHJpdmF0ZSBzdGF0aWMgZmlu\nYWwgU3RyaW5nIFtdIEpORElfTE9DUyA9IG5ldyBTdHJpbmcgW117CiAgICAg\nICAgImphdmF4LnRyYW5zYWN0aW9uLlRyYW5zYWN0aW9uTWFuYWdlciIsIC8v\nIHdlYmxvZ2ljCiAgICAgICAgImphdmE6L1RyYW5zYWN0aW9uTWFuYWdlciIs\nIC8vIGpib3NzICYganJ1bgogICAgICAgICJqYXZhOi9EZWZhdWx0RG9tYWlu\nL1RyYW5zYWN0aW9uTWFuYWdlciIsIC8vIGpydW4gdG9vCiAgICAgICAgImph\ndmE6Y29tcC9wbS9UcmFuc2FjdGlvbk1hbmFnZXIiLCAvLyBvcmlvbiAmIG9y\nYWNsZQogICAgICAgICJqYXZhOmNvbXAvVHJhbnNhY3Rpb25NYW5hZ2VyIiwg\nLy8gZ2VuZXJpYwogICAgICAgICJqYXZhOnBtL1RyYW5zYWN0aW9uTWFuYWdl\nciIsIC8vIGJvcmxhbmQKICAgIH07CiAgICBwcml2YXRlIHN0YXRpYyBmaW5h\nbCBTdHJpbmcgW10gTUVUSE9EUyA9IG5ldyBTdHJpbmdbXXsKICAgICAgICAi\nY29tLmFyanVuYS5qdGEuSlRBX1RyYW5zYWN0aW9uTWFuYWdlci50cmFuc2Fj\ndGlvbk1hbmFnZXIiLCAvLyBocAogICAgICAgICJjb20uYmx1ZXN0b25lLmp0\nYS5TYVRyYW5zYWN0aW9uTWFuYWdlckZhY3RvcnkuU2FHZXRUcmFuc2FjdGlv\nbk1hbmFnZXIiLAogICAgICAgICJvcmcub3BlbmVqYi5PcGVuRUpCLmdldFRy\nYW5zYWN0aW9uTWFuYWdlciIsCiAgICAgICAgImNvbS5zdW4uanRzLmp0YS5U\ncmFuc2FjdGlvbk1hbmFnZXJJbXBsLmdldFRyYW5zYWN0aW9uTWFuYWdlcklt\ncGwiLAogICAgICAgICJjb20uaW5wcmlzZS52aXNpdHJhbnNhY3QuanRhLlRy\nYW5zYWN0aW9uTWFuYWdlckltcGwuIgogICAgICAgICAgICArICJnZXRUcmFu\nc2FjdGlvbk1hbmFnZXJJbXBsIiwgLy8gYm9ybGFuZAogICAgfTsKCiAgICBw\ncml2YXRlIHN0YXRpYyBmaW5hbCBNYW5hZ2VkUnVudGltZSBSRUdJU1RSWTsK\nICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIFdMU01hbmFnZWRSdW50aW1lIFdM\nUzsKICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIFN1bk9uZU1hbmFnZWRSdW50\naW1lIFNVTk9ORTsKICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIFdBU01hbmFn\nZWRSdW50aW1lIFdBUzsKCiAgICBwcml2YXRlIHN0YXRpYyBMb2NhbGl6ZXIg\nX2xvYyA9IExvY2FsaXplci5mb3JQYWNrYWdlCiAgICAgICAgKEF1dG9tYXRp\nY01hbmFnZWRSdW50aW1lLmNsYXNzKTsKCiAgICBzdGF0aWMgewogICAgICAg\nIE1hbmFnZWRSdW50aW1lIG1yID0gbnVsbDsKCiAgICAgICAgbXIgPSBudWxs\nOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIG1yID0gKE1hbmFnZWRSdW50\naW1lKSBDbGFzcy4KICAgICAgICAgICAgICAgIGZvck5hbWUoIm9yZy5hcGFj\naGUub3BlbmpwYS5lZS5SZWdpc3RyeU1hbmFnZWRSdW50aW1lIikuCiAgICAg\nICAgICAgICAgICAgICAgbmV3SW5zdGFuY2UoKTsKICAgICAgICB9IGNhdGNo\nIChUaHJvd2FibGUgdCkgewogICAgICAgICAgICAvLyBtaWdodCBiZSBKVEEg\ndmVyc2lvbiBsb3dlciB0aGFuIDEuMSwgd2hpY2ggZG9lc24ndCBoYXZlIAog\nICAgICAgICAgICAvLyBUcmFuc2FjdGlvblN5bmNocm9uaXphdGlvblJlZ2lz\ndHJ5CiAgICAgICAgfQogICAgICAgIFJFR0lTVFJZID0gbXI7CgogICAgICAg\nIG1yID0gbnVsbDsKICAgICAgICB0cnkgewogICAgICAgICAgICBtciA9IG5l\ndyBXTFNNYW5hZ2VkUnVudGltZSgpOwogICAgICAgIH0gY2F0Y2ggKFRocm93\nYWJsZSB0KSB7CiAgICAgICAgfQogICAgICAgIFdMUyA9IChXTFNNYW5hZ2Vk\nUnVudGltZSkgbXI7CgogICAgICAgIG1yID0gbnVsbDsKICAgICAgICB0cnkg\newogICAgICAgICAgICBtciA9IG5ldyBTdW5PbmVNYW5hZ2VkUnVudGltZSgp\nOwogICAgICAgIH0gY2F0Y2ggKFRocm93YWJsZSB0KSB7CiAgICAgICAgfQog\nICAgICAgIFNVTk9ORSA9IChTdW5PbmVNYW5hZ2VkUnVudGltZSkgbXI7Cgog\nICAgICAgIG1yID0gbnVsbDsKICAgICAgICB0cnkgewogICAgICAgICAgICBt\nciA9IG5ldyBXQVNNYW5hZ2VkUnVudGltZSgpOwogICAgICAgIH0KICAgICAg\nICBjYXRjaCAoVGhyb3dhYmxlIHQpIHsKICAgICAgICB9CiAgICAgICAgV0FT\nPSAoV0FTTWFuYWdlZFJ1bnRpbWUpIG1yOwogICAgfQoKICAgIHByaXZhdGUg\nQ29uZmlndXJhdGlvbiBfY29uZiA9IG51bGw7CiAgICBwcml2YXRlIE1hbmFn\nZWRSdW50aW1lIF9ydW50aW1lID0gbnVsbDsKCiAgICBwdWJsaWMgVHJhbnNh\nY3Rpb25NYW5hZ2VyIGdldFRyYW5zYWN0aW9uTWFuYWdlcigpCiAgICAgICAg\ndGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgaWYgKF9ydW50aW1lICE9IG51\nbGwpCiAgICAgICAgICAgIHJldHVybiBfcnVudGltZS5nZXRUcmFuc2FjdGlv\nbk1hbmFnZXIoKTsKCiAgICAgICAgTGlzdCBlcnJvcnMgPSBuZXcgTGlua2Vk\nTGlzdCgpOwogICAgICAgIFRyYW5zYWN0aW9uTWFuYWdlciB0bSA9IG51bGw7\nCgogICAgICAgIC8vIGZpcnN0IHRyeSB0aGUgcmVnaXN0cnksIHdoaWNoIGlz\nIHRoZSBvZmZpY2lhbCB3YXkgdG8gb2J0YWluCiAgICAgICAgLy8gdHJhbnNh\nY3Rpb24gc3luY2hyb25pY2F0aW9uIGluIEpUQSAxLjEKICAgICAgICBpZiAo\nUkVHSVNUUlkgIT0gbnVsbCkgewogICAgICAgICAgICB0cnkgewogICAgICAg\nICAgICAgICAgdG0gPSBSRUdJU1RSWS5nZXRUcmFuc2FjdGlvbk1hbmFnZXIo\nKTsKICAgICAgICAgICAgfSBjYXRjaCAoVGhyb3dhYmxlIHQpIHsKICAgICAg\nICAgICAgICAgIGVycm9ycy5hZGQodCk7CiAgICAgICAgICAgIH0KICAgICAg\nICAgICAgaWYgKHRtICE9IG51bGwpIHsKICAgICAgICAgICAgICAgIF9ydW50\naW1lID0gUkVHSVNUUlk7CiAgICAgICAgICAgICAgICByZXR1cm4gdG07CiAg\nICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGlmIChXTFMgIT0gbnVs\nbCkgewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgdG0gPSBX\nTFMuZ2V0VHJhbnNhY3Rpb25NYW5hZ2VyKCk7CiAgICAgICAgICAgIH0gY2F0\nY2ggKFRocm93YWJsZSB0KSB7CiAgICAgICAgICAgICAgICBlcnJvcnMuYWRk\nKHQpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmICh0bSAhPSBudWxs\nKSB7CiAgICAgICAgICAgICAgICBfcnVudGltZSA9IFdMUzsKICAgICAgICAg\nICAgICAgIHJldHVybiB0bTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAg\nICAgICAgaWYgKFdBUyAhPSBudWxsKSB7CiAgICAgICAgICAgIHRyeSB7CiAg\nICAgICAgICAgICAgICBXQVMuc2V0Q29uZmlndXJhdGlvbihfY29uZik7CiAg\nICAgICAgICAgICAgICBXQVMuc3RhcnRDb25maWd1cmF0aW9uKCk7CiAgICAg\nICAgICAgICAgICBXQVMuZW5kQ29uZmlndXJhdGlvbigpOwogICAgICAgICAg\nICAgICAgdG0gPSBXQVMuZ2V0VHJhbnNhY3Rpb25NYW5hZ2VyKCk7CiAgICAg\nICAgICAgIH0gY2F0Y2ggKFRocm93YWJsZSB0KSB7CiAgICAgICAgICAgICAg\nICBlcnJvcnMuYWRkKHQpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlm\nICh0bSAhPSBudWxsKSB7CiAgICAgICAgICAgICAgICBfcnVudGltZSA9IFdB\nUzsKICAgICAgICAgICAgICAgIHJldHVybiB0bTsKICAgICAgICAgICAgfQog\nICAgICAgIH0KCiAgICAgICAgLy8gdHJ5IHRvIGZpbmQgYSBqbmRpIHJ1bnRp\nbWUKICAgICAgICBKTkRJTWFuYWdlZFJ1bnRpbWUgam1yID0gbmV3IEpORElN\nYW5hZ2VkUnVudGltZSgpOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwg\nSk5ESV9MT0NTLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGptci5zZXRU\ncmFuc2FjdGlvbk1hbmFnZXJOYW1lKEpORElfTE9DU1tpXSk7CiAgICAgICAg\nICAgIHRyeSB7CiAgICAgICAgICAgICAgICB0bSA9IGptci5nZXRUcmFuc2Fj\ndGlvbk1hbmFnZXIoKTsKICAgICAgICAgICAgfSBjYXRjaCAoVGhyb3dhYmxl\nIHQpIHsKICAgICAgICAgICAgICAgIGVycm9ycy5hZGQodCk7CiAgICAgICAg\nICAgIH0KICAgICAgICAgICAgaWYgKHRtICE9IG51bGwpIHsKICAgICAgICAg\nICAgICAgIF9ydW50aW1lID0gam1yOwogICAgICAgICAgICAgICAgcmV0dXJu\nIHRtOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAvLyBsb29r\nIGZvciBhIG1ldGhvZCBydW50aW1lCiAgICAgICAgSW52b2NhdGlvbk1hbmFn\nZWRSdW50aW1lIGltciA9IG5ldyBJbnZvY2F0aW9uTWFuYWdlZFJ1bnRpbWUo\nKTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IE1FVEhPRFMubGVuZ3Ro\nOyBpKyspIHsKICAgICAgICAgICAgaW1yLnNldENvbmZpZ3VyYXRpb24oX2Nv\nbmYpOwogICAgICAgICAgICBpbXIuc2V0VHJhbnNhY3Rpb25NYW5hZ2VyTWV0\naG9kKE1FVEhPRFNbaV0pOwogICAgICAgICAgICB0cnkgewogICAgICAgICAg\nICAgICAgdG0gPSBpbXIuZ2V0VHJhbnNhY3Rpb25NYW5hZ2VyKCk7CiAgICAg\nICAgICAgIH0gY2F0Y2ggKFRocm93YWJsZSB0KSB7CiAgICAgICAgICAgICAg\nICBlcnJvcnMuYWRkKHQpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlm\nICh0bSAhPSBudWxsKSB7CiAgICAgICAgICAgICAgICBfcnVudGltZSA9IGlt\ncjsKICAgICAgICAgICAgICAgIHJldHVybiB0bTsKICAgICAgICAgICAgfQog\nICAgICAgIH0KCiAgICAgICAgaWYgKFNVTk9ORSAhPSBudWxsKSB7CiAgICAg\nICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICB0bSA9IFNVTk9ORS5nZXRU\ncmFuc2FjdGlvbk1hbmFnZXIoKTsKICAgICAgICAgICAgfSBjYXRjaCAoVGhy\nb3dhYmxlIHQpIHsKICAgICAgICAgICAgICAgIGVycm9ycy5hZGQodCk7CiAg\nICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKHRtICE9IG51bGwpIHsKICAg\nICAgICAgICAgICAgIF9ydW50aW1lID0gU1VOT05FOwogICAgICAgICAgICAg\nICAgcmV0dXJuIHRtOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAg\nICBUaHJvd2FibGVbXSB0ID0gKFRocm93YWJsZSBbXSkgZXJyb3JzLnRvQXJy\nYXkoCiAgICAgICAgICAgIG5ldyBUaHJvd2FibGUgW2Vycm9ycy5zaXplKCld\nKTsKICAgICAgICB0aHJvdyBuZXcgSW52YWxpZFN0YXRlRXhjZXB0aW9uKF9s\nb2MuZ2V0KCJ0bS1ub3QtZm91bmQiKSkuCiAgICAgICAgICAgIHNldEZhdGFs\nKHRydWUpLnNldE5lc3RlZFRocm93YWJsZXModCk7CiAgICB9CgogICAgcHVi\nbGljIHZvaWQgc2V0Q29uZmlndXJhdGlvbihDb25maWd1cmF0aW9uIGNvbmYp\nIHsKICAgICAgICBfY29uZiA9IGNvbmY7CiAgICB9CgogICAgcHVibGljIHZv\naWQgc3RhcnRDb25maWd1cmF0aW9uKCkgewogICAgfQoKICAgIHB1YmxpYyB2\nb2lkIGVuZENvbmZpZ3VyYXRpb24oKSB7CiAgICB9CgogICAgcHVibGljIHZv\naWQgc2V0Um9sbGJhY2tPbmx5KFRocm93YWJsZSBjYXVzZSkKICAgICAgICB0\naHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICAvLyBjaGVjayB0byBzZWUgaWYg\ndGhlIHJ1bnRpbWUgaXMgY2FjaGVkCiAgICAgICAgaWYgKF9ydW50aW1lID09\nIG51bGwpCiAgICAgICAgICAgIGdldFRyYW5zYWN0aW9uTWFuYWdlcigpOwoK\nICAgICAgICBpZiAoX3J1bnRpbWUgIT0gbnVsbCkKICAgICAgICAgICAgX3J1\nbnRpbWUuc2V0Um9sbGJhY2tPbmx5KGNhdXNlKTsKICAgIH0KCiAgICBwdWJs\naWMgVGhyb3dhYmxlIGdldFJvbGxiYWNrQ2F1c2UoKQogICAgICAgIHRocm93\ncyBFeGNlcHRpb24gewogICAgICAgIC8vIGNoZWNrIHRvIHNlZSBpZiB0aGUg\ncnVudGltZSBpcyBjYWNoZWQKICAgICAgICBpZiAoX3J1bnRpbWUgPT0gbnVs\nbCkKICAgICAgICAgICAgZ2V0VHJhbnNhY3Rpb25NYW5hZ2VyKCk7CgogICAg\nICAgIGlmIChfcnVudGltZSAhPSBudWxsKQogICAgICAgICAgICByZXR1cm4g\nX3J1bnRpbWUuZ2V0Um9sbGJhY2tDYXVzZSgpOwoKICAgICAgICByZXR1cm4g\nbnVsbDsKICAgIH0KICAgIAogICAgcHVibGljIE9iamVjdCBnZXRUcmFuc2Fj\ndGlvbktleSgpIHRocm93cyBFeGNlcHRpb24sIFN5c3RlbUV4Y2VwdGlvbiB7\nCiAgICAgICAgaWYoX3J1bnRpbWUgPT0gbnVsbCkgCiAgICAgICAgICAgIGdl\ndFRyYW5zYWN0aW9uTWFuYWdlcigpOwogICAgICAgIAogICAgICAgIGlmKF9y\ndW50aW1lICE9IG51bGwgKQogICAgICAgICAgICByZXR1cm4gX3J1bnRpbWUu\nZ2V0VHJhbnNhY3Rpb25LZXkoKTsKICAgICAgICAKICAgICAgICByZXR1cm4g\nbnVsbDsKICAgIH0KfQo=\n","encoding":"base64"}

