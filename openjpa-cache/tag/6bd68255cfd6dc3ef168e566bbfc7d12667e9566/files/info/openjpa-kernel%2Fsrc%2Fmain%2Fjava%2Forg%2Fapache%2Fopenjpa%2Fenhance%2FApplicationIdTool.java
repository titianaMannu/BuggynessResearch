{"sha":"6e437883a245ec3fee291dfca1923c9c1e7cde0b","node_id":"MDQ6QmxvYjIwNjM2NDo2ZTQzNzg4M2EyNDVlYzNmZWUyOTFkZmNhMTkyM2M5YzFlN2NkZTBi","size":57419,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/6e437883a245ec3fee291dfca1923c9c1e7cde0b","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuZW5oYW5jZTsKCmltcG9ydCBq\nYXZhLmlvLkZpbGU7CmltcG9ydCBqYXZhLmlvLkZpbGVXcml0ZXI7CmltcG9y\ndCBqYXZhLmlvLklPRXhjZXB0aW9uOwppbXBvcnQgamF2YS5pby5QcmludFdy\naXRlcjsKaW1wb3J0IGphdmEuaW8uV3JpdGVyOwppbXBvcnQgamF2YS5sYW5n\nLnJlZmxlY3QuTW9kaWZpZXI7CmltcG9ydCBqYXZhLnNlY3VyaXR5LkFjY2Vz\nc0NvbnRyb2xsZXI7CmltcG9ydCBqYXZhLnV0aWwuQXJyYXlMaXN0OwppbXBv\ncnQgamF2YS51dGlsLkFycmF5czsKaW1wb3J0IGphdmEudXRpbC5Db2xsZWN0\naW9uOwppbXBvcnQgamF2YS51dGlsLkRhdGU7CmltcG9ydCBqYXZhLnV0aWwu\nSGFzaFNldDsKaW1wb3J0IGphdmEudXRpbC5JdGVyYXRvcjsKaW1wb3J0IGph\ndmEudXRpbC5MaXN0OwppbXBvcnQgamF2YS51dGlsLk1hcDsKaW1wb3J0IGph\ndmEudXRpbC5TZXQ7CmltcG9ydCBqYXZhLnV0aWwuVHJlZVNldDsKCmltcG9y\ndCBvcmcuYXBhY2hlLmNvbW1vbnMubGFuZy5TdHJpbmdVdGlsczsKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5jb25mLk9wZW5KUEFDb25maWd1cmF0aW9u\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmNvbmYuT3BlbkpQQUNvbmZp\nZ3VyYXRpb25JbXBsOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi5j\nb25mLkNvbmZpZ3VyYXRpb247CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\nbGliLmNvbmYuQ29uZmlndXJhdGlvbnM7CmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEubGliLmxvZy5Mb2c7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\nbGliLm1ldGEuQ2xhc3NBcmdQYXJzZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEubGliLnV0aWwuQ29kZUZvcm1hdDsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS5saWIudXRpbC5GaWxlczsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5saWIudXRpbC5KMkRvUHJpdkhlbHBlcjsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5saWIudXRpbC5KYXZhVmVyc2lvbnM7CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuTG9jYWxpemVyOwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLmxpYi51dGlsLk9wdGlvbnM7CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEubWV0YS5DbGFzc01ldGFEYXRhOwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLm1ldGEuRGVsZWdhdGluZ01ldGFEYXRhRmFjdG9y\neTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRhLkZpZWxkTWV0YURh\ndGE7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YS5KYXZhVHlwZXM7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YS5NZXRhRGF0YUZhY3Rv\ncnk7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YS5NZXRhRGF0YVJl\ncG9zaXRvcnk7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5JbnZh\nbGlkU3RhdGVFeGNlcHRpb247CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\ndXRpbC5Vc2VyRXhjZXB0aW9uOwppbXBvcnQgc2VycC5ieXRlY29kZS5CQ0Ns\nYXNzOwppbXBvcnQgc2VycC5ieXRlY29kZS5CQ0NsYXNzTG9hZGVyOwppbXBv\ncnQgc2VycC5ieXRlY29kZS5Qcm9qZWN0OwppbXBvcnQgc2VycC51dGlsLlN0\ncmluZ3M7CgovKioKICogR2VuZXJhdGVzIGEgY2xhc3MgYXBwcm9wcmlhdGUg\nZm9yIHVzZSBhcyBhbiBhcHBsaWNhdGlvbiBpZGVudGl0eSBjbGFzcy4KICoK\nICogQGF1dGhvciBQYXRyaWNrIExpbnNrZXkKICogQGF1dGhvciBBYmUgV2hp\ndGUKICovCnB1YmxpYyBjbGFzcyBBcHBsaWNhdGlvbklkVG9vbCB7CgogICAg\ncHVibGljIHN0YXRpYyBmaW5hbCBTdHJpbmcgVE9LRU5fREVGQVVMVCA9ICI6\nOiI7CgogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgU3RyaW5nIFRPS0VOSVpF\nUl9DVVNUT00gPSAiVG9rZW5pemVyIjsKICAgIHByaXZhdGUgc3RhdGljIGZp\nbmFsIFN0cmluZyBUT0tFTklaRVJfU1REID0gIlN0cmluZ1Rva2VuaXplciI7\nCgogICAgcHJpdmF0ZSBzdGF0aWMgTG9jYWxpemVyIF9sb2MgPSBMb2NhbGl6\nZXIuZm9yUGFja2FnZQogICAgICAgIChBcHBsaWNhdGlvbklkVG9vbC5jbGFz\ncyk7CgogICAgcHJpdmF0ZSBmaW5hbCBMb2cgX2xvZzsKICAgIHByaXZhdGUg\nZmluYWwgQ2xhc3MgX3R5cGU7CiAgICBwcml2YXRlIGZpbmFsIENsYXNzTWV0\nYURhdGEgX21ldGE7CiAgICBwcml2YXRlIGJvb2xlYW4gX2Fic3RyYWN0ID0g\nZmFsc2U7CiAgICBwcml2YXRlIEZpZWxkTWV0YURhdGFbXSBfZmllbGRzID0g\nbnVsbDsKICAgIHByaXZhdGUgYm9vbGVhbiBfaWdub3JlID0gdHJ1ZTsKICAg\nIHByaXZhdGUgRmlsZSBfZGlyID0gbnVsbDsKICAgIHByaXZhdGUgV3JpdGVy\nIF93cml0ZXIgPSBudWxsOwogICAgcHJpdmF0ZSBTdHJpbmcgX2NvZGUgPSBu\ndWxsOwogICAgcHJpdmF0ZSBTdHJpbmcgX3Rva2VuID0gVE9LRU5fREVGQVVM\nVDsKICAgIHByaXZhdGUgQ29kZUZvcm1hdCBfZm9ybWF0ID0gbnVsbDsKCiAg\nICAvKioKICAgICAqIENvbnN0cnVjdHMgYSBuZXcgQXBwbGljYXRpb25JZFRv\nb2wgY2FwYWJsZSBvZiBnZW5lcmF0aW5nIGFuCiAgICAgKiBvYmplY3QgaWQg\nY2xhc3MgZm9yIDxjb2RlPnR5cGU8L2NvZGU+LgogICAgICovCiAgICBwdWJs\naWMgQXBwbGljYXRpb25JZFRvb2woT3BlbkpQQUNvbmZpZ3VyYXRpb24gY29u\nZiwgQ2xhc3MgdHlwZSkgewogICAgICAgIF9sb2cgPSBjb25mLmdldExvZyhP\ncGVuSlBBQ29uZmlndXJhdGlvbi5MT0dfRU5IQU5DRSk7CiAgICAgICAgX3R5\ncGUgPSB0eXBlOwoKICAgICAgICBNZXRhRGF0YVJlcG9zaXRvcnkgcmVwb3Mg\nPSBjb25mLm5ld01ldGFEYXRhUmVwb3NpdG9yeUluc3RhbmNlKCk7CiAgICAg\nICAgcmVwb3Muc2V0VmFsaWRhdGUocmVwb3MuVkFMSURBVEVfTk9ORSk7CiAg\nICAgICAgcmVwb3Muc2V0U291cmNlTW9kZShyZXBvcy5NT0RFX01BUFBJTkcs\nIGZhbHNlKTsKICAgICAgICBsb2FkT2JqZWN0SWRzKHJlcG9zLCB0cnVlKTsK\nICAgICAgICBfbWV0YSA9IHJlcG9zLmdldE1ldGFEYXRhKHR5cGUsIG51bGws\nIGZhbHNlKTsKICAgICAgICBpZiAoX21ldGEgIT0gbnVsbCkgewogICAgICAg\nICAgICBfYWJzdHJhY3QgPSBNb2RpZmllci5pc0Fic3RyYWN0KF9tZXRhLmdl\ndERlc2NyaWJlZFR5cGUoKS4KICAgICAgICAgICAgICAgIGdldE1vZGlmaWVy\ncygpKTsKICAgICAgICAgICAgX2ZpZWxkcyA9IGdldERlY2xhcmVkUHJpbWFy\neUtleUZpZWxkcyhfbWV0YSk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgog\nICAgICogQ29uc3RydWN0cyBhIG5ldyB0b29sIGluc3RhbmNlIGNhcGFibGUg\nb2YgZ2VuZXJhdGluZyBhbgogICAgICogb2JqZWN0IGlkIGNsYXNzIGZvciA8\nY29kZT5tZXRhPC9jb2RlPi4KICAgICAqLwogICAgcHVibGljIEFwcGxpY2F0\naW9uSWRUb29sKE9wZW5KUEFDb25maWd1cmF0aW9uIGNvbmYsIENsYXNzIHR5\ncGUsCiAgICAgICAgQ2xhc3NNZXRhRGF0YSBtZXRhKSB7CiAgICAgICAgX2xv\nZyA9IGNvbmYuZ2V0TG9nKE9wZW5KUEFDb25maWd1cmF0aW9uLkxPR19FTkhB\nTkNFKTsKCiAgICAgICAgX3R5cGUgPSB0eXBlOwogICAgICAgIF9tZXRhID0g\nbWV0YTsKICAgICAgICBpZiAoX21ldGEgIT0gbnVsbCkgewogICAgICAgICAg\nICBfYWJzdHJhY3QgPSBNb2RpZmllci5pc0Fic3RyYWN0KF9tZXRhLmdldERl\nc2NyaWJlZFR5cGUoKS4KICAgICAgICAgICAgICAgIGdldE1vZGlmaWVycygp\nKTsKICAgICAgICAgICAgX2ZpZWxkcyA9IGdldERlY2xhcmVkUHJpbWFyeUtl\neUZpZWxkcyhfbWV0YSk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAg\nICogUmV0dXJuIG1ldGFkYXRhIGZvciBwcmltYXJ5IGtleSBmaWVsZHMgZGVj\nbGFyZWQgaW4gdGhlIGdpdmVuIGNsYXNzLgogICAgICovCiAgICBwcml2YXRl\nIHN0YXRpYyBGaWVsZE1ldGFEYXRhW10gZ2V0RGVjbGFyZWRQcmltYXJ5S2V5\nRmllbGRzCiAgICAgICAgKENsYXNzTWV0YURhdGEgbWV0YSkgewogICAgICAg\nIGlmIChtZXRhLmdldFBDU3VwZXJjbGFzcygpID09IG51bGwpCiAgICAgICAg\nICAgIHJldHVybiBtZXRhLmdldFByaW1hcnlLZXlGaWVsZHMoKTsKCiAgICAg\nICAgLy8gcmVtb3ZlIHRoZSBwcmltYXJ5IGtleSBmaWVsZHMgdGhhdCBhcmUg\nbm90IGRlY2xhcmVkCiAgICAgICAgLy8gaW4gdGhlIGN1cnJlbnQgY2xhc3MK\nICAgICAgICBGaWVsZE1ldGFEYXRhW10gZmllbGRzID0gbWV0YS5nZXRQcmlt\nYXJ5S2V5RmllbGRzKCk7CiAgICAgICAgTGlzdCBkZWNzID0gbmV3IEFycmF5\nTGlzdChmaWVsZHMubGVuZ3RoKTsKICAgICAgICBmb3IgKGludCBpID0gMDsg\naSA8IGZpZWxkcy5sZW5ndGg7IGkrKykKICAgICAgICAgICAgaWYgKGZpZWxk\nc1tpXS5nZXREZWNsYXJpbmdUeXBlKCkgPT0gbWV0YS5nZXREZXNjcmliZWRU\neXBlKCkpCiAgICAgICAgICAgICAgICBkZWNzLmFkZChmaWVsZHNbaV0pOwog\nICAgICAgIHJldHVybiAoRmllbGRNZXRhRGF0YVtdKSBkZWNzLnRvQXJyYXko\nbmV3IEZpZWxkTWV0YURhdGFbZGVjcy5zaXplKCldKTsKICAgIH0KCiAgICAv\nKioKICAgICAqIFJldHVybiBmYWxzZSBpZiB0aGlzIHRvb2wgaXMgY29uZmln\ndXJlZCB0byB0aHJvdyBhbiBleGNlcHRpb24gb24KICAgICAqIGFuIGF0dGVt\ncHQgdG8gZ2VuZXJhdGUgYW4gaWQgY2xhc3MgZm9yIGEgdHlwZSB0aGF0IGRv\nZXMgbm90IHVzZQogICAgICogYXBwbGljYXRpb24gaWRlbnRpdHkuCiAgICAg\nKi8KICAgIHB1YmxpYyBib29sZWFuIGdldElnbm9yZUVycm9ycygpIHsKICAg\nICAgICByZXR1cm4gX2lnbm9yZTsKICAgIH0KCiAgICAvKioKICAgICAqIFNl\ndCB0byBmYWxzZSBpZiB0aGlzIHRvb2wgc2hvdWxkIHRocm93IGFuIGV4Y2Vw\ndGlvbiBvbgogICAgICogYW4gYXR0ZW1wdCB0byBnZW5lcmF0ZSBhbiBpZCBj\nbGFzcyBmb3IgYSB0eXBlIHRoYXQgZG9lcyBub3QgdXNlCiAgICAgKiBhcHBs\naWNhdGlvbiBpZGVudGl0eS4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0\nSWdub3JlRXJyb3JzKGJvb2xlYW4gaWdub3JlKSB7CiAgICAgICAgX2lnbm9y\nZSA9IGlnbm9yZTsKICAgIH0KCiAgICAvKioKICAgICAqIFRoZSBjb2RlIGZv\ncm1hdHRlciBmb3IgdGhlIGdlbmVyYXRlZCBKYXZhIGNvZGUuCiAgICAgKi8K\nICAgIHB1YmxpYyBDb2RlRm9ybWF0IGdldENvZGVGb3JtYXQoKSB7CiAgICAg\nICAgcmV0dXJuIF9mb3JtYXQ7CiAgICB9CgogICAgLyoqCiAgICAgKiBTZXQg\ndGhlIGNvZGUgZm9ybWF0dGVyIGZvciB0aGUgZ2VuZXJhdGVkIEphdmEgY29k\nZS4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0Q29kZUZvcm1hdChDb2Rl\nRm9ybWF0IGZvcm1hdCkgewogICAgICAgIF9mb3JtYXQgPSBmb3JtYXQ7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBUaGUgZGlyZWN0b3J5IHRvIHdyaXRlIHNv\ndXJjZSB0by4gRGVmYXVsdHMgdG8gdGhlIGRpcmVjdG9yeQogICAgICogb2Yg\ndGhlIEphdmEgZmlsZSBmb3IgdGhlIHNldCB0eXBlLiBJZiB0aGUgZ2l2ZW4g\nZGlyZWN0b3J5IGRvZXMgbm90CiAgICAgKiBtYXRjaCB0aGUgcGFja2FnZSBv\nZiB0aGUgb2JqZWN0IGlkLCB0aGUgcGFja2FnZSBzdHJ1Y3R1cmUgd2lsbCBi\nZQogICAgICogY3JlYXRlZCBiZWxvdyB0aGUgZGlyZWN0b3J5LgogICAgICov\nCiAgICBwdWJsaWMgRmlsZSBnZXREaXJlY3RvcnkoKSB7CiAgICAgICAgcmV0\ndXJuIF9kaXI7CiAgICB9CgogICAgLyoqCiAgICAgKiBUaGUgZGlyZWN0b3J5\nIHRvIHdyaXRlIHNvdXJjZSB0by4gRGVmYXVsdHMgdG8gdGhlIGRpcmVjdG9y\neQogICAgICogb2YgdGhlIEphdmEgZmlsZSBmb3IgdGhlIHNldCB0eXBlLiBJ\nZiB0aGUgZ2l2ZW4gZGlyZWN0b3J5IGRvZXMgbm90CiAgICAgKiBtYXRjaCB0\naGUgcGFja2FnZSBvZiB0aGUgb2JqZWN0IGlkLCB0aGUgcGFja2FnZSBzdHJ1\nY3R1cmUgd2lsbCBiZQogICAgICogY3JlYXRlZCBiZWxvdyB0aGUgZGlyZWN0\nb3J5LgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXREaXJlY3RvcnkoRmls\nZSBkaXIpIHsKICAgICAgICBfZGlyID0gZGlyOwogICAgfQoKICAgIC8qKgog\nICAgICogVGhlIHRva2VuIHRvIHVzZSB0byBzZXBhcmF0ZSBzdHJpbmdpZmll\nZCBwcmltYXJ5IGtleSBmaWVsZCB2YWx1ZXMuCiAgICAgKi8KICAgIHB1Ymxp\nYyBTdHJpbmcgZ2V0VG9rZW4oKSB7CiAgICAgICAgcmV0dXJuIF90b2tlbjsK\nICAgIH0KCiAgICAvKioKICAgICAqIFRoZSB0b2tlbiB0byB1c2UgdG8gc2Vw\nYXJhdGUgc3RyaW5naWZpZWQgcHJpbWFyeSBrZXkgZmllbGQgdmFsdWVzLgog\nICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRUb2tlbihTdHJpbmcgdG9rZW4p\nIHsKICAgICAgICBfdG9rZW4gPSB0b2tlbjsKICAgIH0KCiAgICAvKioKICAg\nICAqIFRoZSB3cml0ZXIgdG8gd3JpdGUgc291cmNlIHRvLCBvciBudWxsIHRv\nIHdyaXRlIHRvIGRlZmF1bHQgZmlsZS4KICAgICAqLwogICAgcHVibGljIFdy\naXRlciBnZXRXcml0ZXIoKSB7CiAgICAgICAgcmV0dXJuIF93cml0ZXI7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBUaGUgd3JpdGVyIHRvIHdyaXRlIHNvdXJj\nZSB0bywgb3IgbnVsbCB0byB3cml0ZSB0byBkZWZhdWx0IGZpbGUuCiAgICAg\nKi8KICAgIHB1YmxpYyB2b2lkIHNldFdyaXRlcihXcml0ZXIgd3JpdGVyKSB7\nCiAgICAgICAgX3dyaXRlciA9IHdyaXRlcjsKICAgIH0KCiAgICAvKioKICAg\nICAqIFJldHVybiB0aGUgdHlwZSB3ZSBhcmUgZ2VuZXJhdGluZyBhbiBhcHBs\naWNhdGlvbiBpZCBmb3IuCiAgICAgKi8KICAgIHB1YmxpYyBDbGFzcyBnZXRU\neXBlKCkgewogICAgICAgIHJldHVybiBfdHlwZTsKICAgIH0KCiAgICAvKioK\nICAgICAqIFJldHVybiBtZXRhZGF0YSBmb3IgdGhlIHR5cGUgd2UgYXJlIGdl\nbmVyYXRpbmcgYW4gYXBwbGljYXRpb24gaWQgZm9yLgogICAgICovCiAgICBw\ndWJsaWMgQ2xhc3NNZXRhRGF0YSBnZXRNZXRhRGF0YSgpIHsKICAgICAgICBy\nZXR1cm4gX21ldGE7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhl\nIGNvZGUgZ2VuZXJhdGVkIGZvciB0aGUgYXBwbGljYXRpb24gaWQsIG9yIG51\nbGwKICAgICAqIGlmIGludmFsaWQgY2xhc3Mgb3IgdGhlIHtAbGluayAjcnVu\nfSBtZXRob2QgaGFzIG5vdCBiZWVuIGNhbGxlZC4KICAgICAqLwogICAgcHVi\nbGljIFN0cmluZyBnZXRDb2RlKCkgewogICAgICAgIHJldHVybiBfY29kZTsK\nICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybnMgdHJ1ZSBpZiB0aGUgYXBw\nbGljYXRpb24gaWRlbnRpdHkgY2xhc3Mgc2hvdWxkIGJlIGFuIGlubmVyIGNs\nYXNzLgogICAgICovCiAgICBwdWJsaWMgYm9vbGVhbiBpc0lubmVyQ2xhc3Mo\nKSB7CiAgICAgICAgQ2xhc3Mgb2lkQ2xhc3MgPSBfbWV0YS5nZXRPYmplY3RJ\nZFR5cGUoKTsKICAgICAgICByZXR1cm4gb2lkQ2xhc3MuZ2V0TmFtZSgpLmlu\nZGV4T2YoJyQnKSAhPSAtMTsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVy\nbnMgdGhlIHNob3J0IGNsYXNzIG5hbWUgZm9yIHRoZSBvYmplY3QgaWQgY2xh\nc3MuCiAgICAgKi8KICAgIHByaXZhdGUgU3RyaW5nIGdldENsYXNzTmFtZSgp\nIHsKICAgICAgICBpZiAoX21ldGEuaXNPcGVuSlBBSWRlbnRpdHkoKSkKICAg\nICAgICAgICAgcmV0dXJuIG51bGw7CgogICAgICAgIC8vIGNvbnZlcnQgZnJv\nbSBTb21lQ2xhc3MkSUQgdG8gSUQKICAgICAgICBTdHJpbmcgY2xhc3NOYW1l\nID0gU3RyaW5ncy5nZXRDbGFzc05hbWUoX21ldGEuZ2V0T2JqZWN0SWRUeXBl\nKCkpOwogICAgICAgIGlmIChpc0lubmVyQ2xhc3MoKSkKICAgICAgICAgICAg\nY2xhc3NOYW1lID0gY2xhc3NOYW1lLnN1YnN0cmluZyhjbGFzc05hbWUubGFz\ndEluZGV4T2YoJyQnKSArIDEpOwogICAgICAgIHJldHVybiBjbGFzc05hbWU7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBHZW5lcmF0ZXMgdGhlIHNvdXJjZWNv\nZGUgZm9yIHRoZSBhcHBsaWNhdGlvbiBpZCBjbGFzczsgcmV0dXJucwogICAg\nICogZmFsc2UgaWYgdGhlIGNsYXNzIGlzIGludmFsaWQuCiAgICAgKi8KICAg\nIHB1YmxpYyBib29sZWFuIHJ1bigpIHsKICAgICAgICBpZiAoX2xvZy5pc0lu\nZm9FbmFibGVkKCkpCiAgICAgICAgICAgIF9sb2cuaW5mbyhfbG9jLmdldCgi\nYXBwaWQtc3RhcnQiLCBfdHlwZSkpOwoKICAgICAgICAvLyBlbnN1cmUgdGhh\ndCB0aGlzIHR5cGUgaXMgYSBjYW5kaWRhdGUgZm9yIGFwcGxpY2F0aW9uIGlk\nZW50aXR5CiAgICAgICAgaWYgKF9tZXRhID09IG51bGwKICAgICAgICAgICAg\nfHwgX21ldGEuZ2V0SWRlbnRpdHlUeXBlKCkgIT0gQ2xhc3NNZXRhRGF0YS5J\nRF9BUFBMSUNBVElPTgogICAgICAgICAgICB8fCBfbWV0YS5pc09wZW5KUEFJ\nZGVudGl0eSgpKSB7CiAgICAgICAgICAgIGlmICghX2lnbm9yZSkKICAgICAg\nICAgICAgICAgIHRocm93IG5ldyBVc2VyRXhjZXB0aW9uKF9sb2MuZ2V0KCJh\ncHBpZC1pbnZhbGlkIiwgX3R5cGUpKTsKCiAgICAgICAgICAgIC8vIGVsc2Ug\nanVzdCB3YXJuCiAgICAgICAgICAgIGlmIChfbG9nLmlzV2FybkVuYWJsZWQo\nKSkKICAgICAgICAgICAgICAgIF9sb2cud2FybihfbG9jLmdldCgiYXBwaWQt\nd2FybiIsIF90eXBlKSk7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAg\nICAgICB9CgogICAgICAgIENsYXNzIG9pZENsYXNzID0gX21ldGEuZ2V0T2Jq\nZWN0SWRUeXBlKCk7CiAgICAgICAgQ2xhc3Mgc3VwZXJPaWRDbGFzcyA9IG51\nbGw7CgogICAgICAgIC8vIGFsbG93IGRpZmYgb2lkIGNsYXNzIGluIHN1YmNs\nYXNzIChob3Jpem9udGFsKQogICAgICAgIGlmIChfbWV0YS5nZXRQQ1N1cGVy\nY2xhc3MoKSAhPSBudWxsKSB7CiAgICAgICAgICAgIHN1cGVyT2lkQ2xhc3Mg\nPSBfbWV0YS5nZXRQQ1N1cGVyY2xhc3NNZXRhRGF0YSgpLmdldE9iamVjdElk\nVHlwZSgpOwogICAgICAgICAgICBpZiAob2lkQ2xhc3MgPT0gbnVsbCB8fCBv\naWRDbGFzcy5lcXVhbHMoc3VwZXJPaWRDbGFzcykpIHsKICAgICAgICAgICAg\nICAgIC8vIGp1c3Qgd2FybgogICAgICAgICAgICAgICAgaWYgKF9sb2cuaXNX\nYXJuRW5hYmxlZCgpKQogICAgICAgICAgICAgICAgICAgIF9sb2cud2Fybihf\nbG9jLmdldCgiYXBwaWQtd2FybiIsIF90eXBlKSk7CiAgICAgICAgICAgICAg\nICByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAg\nICAgIC8vIGVuc3VyZSB0aGF0IGFuIGlkIGNsYXNzIGlzIGRlY2xhcmVkCiAg\nICAgICAgaWYgKG9pZENsYXNzID09IG51bGwpCiAgICAgICAgICAgIHRocm93\nIG5ldyBVc2VyRXhjZXB0aW9uKF9sb2MuZ2V0KCJuby1pZC1jbGFzcyIsIF90\neXBlKSkuCiAgICAgICAgICAgICAgICBzZXRGYXRhbCh0cnVlKTsKCiAgICAg\nICAgLy8gZW5zdXJlIHRoZXJlIGlzIGF0IGxlYXN0IG9uZSBwayBmaWVsZCBp\nZiB3ZSBhcmUKICAgICAgICAvLyBub24tYWJzcmFjdCwgYW5kIHNlZSBpZiB3\nZSBoYXZlIGFueSBieXRlW10KICAgICAgICBib29sZWFuIGJ5dGVzID0gZmFs\nc2U7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7ICFieXRlcyAmJiBpIDwgX2Zp\nZWxkcy5sZW5ndGg7IGkrKykKICAgICAgICAgICAgYnl0ZXMgPSBfZmllbGRz\nW2ldLmdldERlY2xhcmVkVHlwZSgpID09IGJ5dGVbXS5jbGFzczsKCiAgICAg\nICAgLy8gY29sbGVjdCBpbmZvIG9uIGlkIHR5cGUKICAgICAgICBTdHJpbmcg\nY2xhc3NOYW1lID0gZ2V0Q2xhc3NOYW1lKCk7CiAgICAgICAgU3RyaW5nIHBh\nY2thZ2VOYW1lID0gU3RyaW5ncy5nZXRQYWNrYWdlTmFtZShvaWRDbGFzcyk7\nCiAgICAgICAgU3RyaW5nIHBhY2thZ2VEZWMgPSAiIjsKICAgICAgICBpZiAo\ncGFja2FnZU5hbWUubGVuZ3RoKCkgPiAwKQogICAgICAgICAgICBwYWNrYWdl\nRGVjID0gInBhY2thZ2UgIiArIHBhY2thZ2VOYW1lICsgIjsiOwoKICAgICAg\nICBTdHJpbmcgaW1wb3J0cyA9IGdldEltcG9ydHMoKTsKICAgICAgICBTdHJp\nbmcgZmllbGREZWNzID0gZ2V0RmllbGREZWNsYXJhdGlvbnMoKTsKICAgICAg\nICBTdHJpbmcgY29uc3RydWN0b3IgPSBnZXRDb25zdHJ1Y3RvcihzdXBlck9p\nZENsYXNzICE9IG51bGwpOwogICAgICAgIFN0cmluZyBwcm9wZXJ0aWVzID0g\nZ2V0UHJvcGVydGllcygpOwogICAgICAgIFN0cmluZyBmcm9tU3RyaW5nQ29k\nZSA9IGdldEZyb21TdHJpbmdDb2RlKHN1cGVyT2lkQ2xhc3MgIT0gbnVsbCk7\nCiAgICAgICAgU3RyaW5nIHRvU3RyaW5nQ29kZSA9IGdldFRvU3RyaW5nQ29k\nZShzdXBlck9pZENsYXNzICE9IG51bGwpOwogICAgICAgIFN0cmluZyBlcXVh\nbHNDb2RlID0gZ2V0RXF1YWxzQ29kZShzdXBlck9pZENsYXNzICE9IG51bGwp\nOwogICAgICAgIFN0cmluZyBoYXNoQ29kZUNvZGUgPSBnZXRIYXNoQ29kZUNv\nZGUoc3VwZXJPaWRDbGFzcyAhPSBudWxsKTsKCiAgICAgICAgLy8gYnVpbGQg\ndGhlIGphdmEgY29kZQogICAgICAgIENvZGVGb3JtYXQgY29kZSA9IG5ld0Nv\nZGVGb3JtYXQoKTsKICAgICAgICBpZiAoIWlzSW5uZXJDbGFzcygpICYmIHBh\nY2thZ2VEZWMubGVuZ3RoKCkgPiAwKQogICAgICAgICAgICBjb2RlLmFwcGVu\nZChwYWNrYWdlRGVjKS5hZnRlclNlY3Rpb24oKTsKCiAgICAgICAgaWYgKCFp\nc0lubmVyQ2xhc3MoKSAmJiBpbXBvcnRzLmxlbmd0aCgpID4gMCkKICAgICAg\nICAgICAgY29kZS5hcHBlbmQoaW1wb3J0cykuYWZ0ZXJTZWN0aW9uKCk7Cgog\nICAgICAgIGNvZGUuYXBwZW5kKCIvKioiKS5lbmRsKCkuCiAgICAgICAgICAg\nIGFwcGVuZCgiICogIikuCiAgICAgICAgICAgIGFwcGVuZChfbG9jLmdldCgi\nYXBwaWQtY29tbWVudC1mb3IiLCBfdHlwZS5nZXROYW1lKCkpKS4KICAgICAg\nICAgICAgZW5kbCgpLgogICAgICAgICAgICBhcHBlbmQoIiAqIikuZW5kbCgp\nLgogICAgICAgICAgICBhcHBlbmQoIiAqICIpLmFwcGVuZChfbG9jLmdldCgi\nYXBwaWQtY29tbWVudC1nZW4iKSkuZW5kbCgpLgogICAgICAgICAgICBhcHBl\nbmQoIiAqICIpLmFwcGVuZChnZXRDbGFzcygpLmdldE5hbWUoKSkuZW5kbCgp\nLgogICAgICAgICAgICBhcHBlbmQoIiAqLyIpLmVuZGwoKTsKICAgICAgICBj\nb2RlLmFwcGVuZCgicHVibGljICIpOwogICAgICAgIGlmIChpc0lubmVyQ2xh\nc3MoKSkKICAgICAgICAgICAgY29kZS5hcHBlbmQoInN0YXRpYyAiKTsKICAg\nICAgICBjb2RlLmFwcGVuZCgiY2xhc3MgIikuYXBwZW5kKGNsYXNzTmFtZSk7\nCiAgICAgICAgaWYgKGNvZGUuZ2V0QnJhY2VPblNhbWVMaW5lKCkpCiAgICAg\nICAgICAgIGNvZGUuYXBwZW5kKCIgIik7CiAgICAgICAgZWxzZQogICAgICAg\nICAgICBjb2RlLmVuZGwoKS50YWIoKTsKCiAgICAgICAgaWYgKHN1cGVyT2lk\nQ2xhc3MgIT0gbnVsbCkgewogICAgICAgICAgICBjb2RlLmFwcGVuZCgiZXh0\nZW5kcyAiICsgU3RyaW5ncy5nZXRDbGFzc05hbWUoc3VwZXJPaWRDbGFzcykp\nOwogICAgICAgICAgICBpZiAoY29kZS5nZXRCcmFjZU9uU2FtZUxpbmUoKSkK\nICAgICAgICAgICAgICAgIGNvZGUuYXBwZW5kKCIgIik7CiAgICAgICAgICAg\nIGVsc2UKICAgICAgICAgICAgICAgIGNvZGUuZW5kbCgpLnRhYigpOwogICAg\nICAgIH0KICAgICAgICBjb2RlLmFwcGVuZCgiaW1wbGVtZW50cyBTZXJpYWxp\nemFibGUiKS5vcGVuQnJhY2UoMSkuZW5kbCgpOwoKICAgICAgICAvLyBpZiB3\nZSB1c2UgYSBieXRlIGFycmF5IHdlIG5lZWQgYSBzdGF0aWMgYXJyYXkgZm9y\nIGVuY29kaW5nIHRvIHN0cmluZwogICAgICAgIGlmIChieXRlcykgewogICAg\nICAgICAgICBjb2RlLnRhYigpLmFwcGVuZCgicHJpdmF0ZSBzdGF0aWMgZmlu\nYWwgY2hhcltdIEhFWCA9ICIpLgogICAgICAgICAgICAgICAgYXBwZW5kKCJu\nZXcgY2hhcltdIHsiKS5lbmRsKCk7CiAgICAgICAgICAgIGNvZGUudGFiKDIp\nLmFwcGVuZCgiJzAnLCAnMScsICcyJywgJzMnLCAnNCcsICc1JywgJzYnLCAn\nNycsIikuCiAgICAgICAgICAgICAgICBlbmRsKCk7CiAgICAgICAgICAgIGNv\nZGUudGFiKDIpLmFwcGVuZCgiJzgnLCAnOScsICdBJywgJ0InLCAnQycsICdE\nJywgJ0UnLCAnRiciKS4KICAgICAgICAgICAgICAgIGVuZGwoKTsKICAgICAg\nICAgICAgY29kZS50YWIoKS5hcHBlbmQoIn07IikuZW5kbCgyKTsKICAgICAg\nICB9CgogICAgICAgIC8vIHN0YXRpYyBibG9jayB0byByZWdpc3RlciBjbGFz\ncwogICAgICAgIGNvZGUudGFiKCkuYXBwZW5kKCJzdGF0aWMiKS5vcGVuQnJh\nY2UoMikuZW5kbCgpOwogICAgICAgIGNvZGUudGFiKDIpLmFwcGVuZCgiLy8g\ncmVnaXN0ZXIgcGVyc2lzdGVudCBjbGFzcyBpbiBKVk0iKS5lbmRsKCk7CiAg\nICAgICAgaWYgKEphdmFWZXJzaW9ucy5WRVJTSU9OID49IDUpIHsKICAgICAg\nICAgICAgY29kZS50YWIoMikuYXBwZW5kKCJ0cnkgeyBDbGFzcy5mb3JOYW1l\nIikub3BlblBhcmVuKHRydWUpLgogICAgICAgICAgICAgICAgYXBwZW5kKCJc\nIiIpLmFwcGVuZChfdHlwZS5nZXROYW1lKCkpLmFwcGVuZCgiXCIiKS4KICAg\nICAgICAgICAgICAgIGNsb3NlUGFyZW4oKS5hcHBlbmQoIjsiKS5hcHBlbmQo\nIiB9IikuZW5kbCgpOwogICAgICAgICAgICBjb2RlLnRhYigyKS5hcHBlbmQo\nImNhdGNoIikub3BlblBhcmVuKHRydWUpLgogICAgICAgICAgICAgICAgYXBw\nZW5kKCJFeGNlcHRpb24gZSIpLmNsb3NlUGFyZW4oKS5hcHBlbmQoIiB7fSIp\nLmVuZGwoKTsKICAgICAgICB9IGVsc2UKICAgICAgICAgICAgY29kZS50YWIo\nMikuYXBwZW5kKCJDbGFzcyBjID0gIikuYXBwZW5kKF90eXBlLmdldE5hbWUo\nKSkuCiAgICAgICAgICAgICAgICBhcHBlbmQoIi5jbGFzczsiKS5lbmRsKCk7\nCiAgICAgICAgY29kZS5jbG9zZUJyYWNlKDIpOwoKICAgICAgICAvLyBmaWVs\nZCBkZWNsYXJhdGlvbnMKICAgICAgICBpZiAoZmllbGREZWNzLmxlbmd0aCgp\nID4gMCkKICAgICAgICAgICAgY29kZS5lbmRsKDIpLmFwcGVuZChmaWVsZERl\nY3MpOwoKICAgICAgICAvLyBkZWZhdWx0IGNvbnN0cnVjdG9yCiAgICAgICAg\nY29kZS5hZnRlclNlY3Rpb24oKS50YWIoKS5hcHBlbmQoInB1YmxpYyAiKS5h\ncHBlbmQoY2xhc3NOYW1lKS4KICAgICAgICAgICAgcGFyZW5zKCkub3BlbkJy\nYWNlKDIpLmVuZGwoKTsKICAgICAgICBjb2RlLmNsb3NlQnJhY2UoMik7Cgog\nICAgICAgIC8vIHN0cmluZyBjb25zdHJ1Y3RvcgogICAgICAgIGNvZGUuYWZ0\nZXJTZWN0aW9uKCkuYXBwZW5kKGNvbnN0cnVjdG9yKTsKCiAgICAgICAgLy8g\ncHJvcGVydGllcwogICAgICAgIGlmIChwcm9wZXJ0aWVzLmxlbmd0aCgpID4g\nMCkKICAgICAgICAgICAgY29kZS5hZnRlclNlY3Rpb24oKS5hcHBlbmQocHJv\ncGVydGllcyk7CgogICAgICAgIC8vIHRvU3RyaW5nLCBlcXVhbHMsIGhhc2hD\nb2RlIG1ldGhvZHMKICAgICAgICBpZiAodG9TdHJpbmdDb2RlLmxlbmd0aCgp\nID4gMCkKICAgICAgICAgICAgY29kZS5hZnRlclNlY3Rpb24oKS5hcHBlbmQo\ndG9TdHJpbmdDb2RlKTsKICAgICAgICBpZiAoaGFzaENvZGVDb2RlLmxlbmd0\naCgpID4gMCkKICAgICAgICAgICAgY29kZS5hZnRlclNlY3Rpb24oKS5hcHBl\nbmQoaGFzaENvZGVDb2RlKTsKICAgICAgICBpZiAoZXF1YWxzQ29kZS5sZW5n\ndGgoKSA+IDApCiAgICAgICAgICAgIGNvZGUuYWZ0ZXJTZWN0aW9uKCkuYXBw\nZW5kKGVxdWFsc0NvZGUpOwogICAgICAgIGlmIChmcm9tU3RyaW5nQ29kZS5s\nZW5ndGgoKSA+IDApCiAgICAgICAgICAgIGNvZGUuYWZ0ZXJTZWN0aW9uKCku\nYXBwZW5kKGZyb21TdHJpbmdDb2RlKTsKCiAgICAgICAgLy8gaWYgd2UgaGF2\nZSBhbnkgYnl0ZSBhcnJheSBmaWVsZHMsIHdlIGhhdmUgdG8gYWRkIHRoZSBl\neHRyYQogICAgICAgIC8vIG1ldGhvZHMgZm9yIGhhbmRsaW5nIGJ5dGUgYXJy\nYXlzCiAgICAgICAgaWYgKGJ5dGVzKSB7CiAgICAgICAgICAgIGNvZGUuYWZ0\nZXJTZWN0aW9uKCkuYXBwZW5kKGdldFRvQnl0ZXNCeXRlQXJyYXlDb2RlKCkp\nOwogICAgICAgICAgICBjb2RlLmFmdGVyU2VjdGlvbigpLmFwcGVuZChnZXRU\nb1N0cmluZ0J5dGVBcnJheUNvZGUoKSk7CiAgICAgICAgICAgIGNvZGUuYWZ0\nZXJTZWN0aW9uKCkuYXBwZW5kKGdldEVxdWFsc0J5dGVBcnJheUNvZGUoKSk7\nCiAgICAgICAgICAgIGNvZGUuYWZ0ZXJTZWN0aW9uKCkuYXBwZW5kKGdldEhh\nc2hDb2RlQnl0ZUFycmF5Q29kZSgpKTsKICAgICAgICB9CgogICAgICAgIC8v\nIGJhc2UgY2xhc3NlcyBtaWdodCBuZWVkIHRvIGRlZmluZSBhIGN1c3RvbSB0\nb2tlbml6ZXIKICAgICAgICBpZiAoc3VwZXJPaWRDbGFzcyA9PSBudWxsICYm\nIGdldFRva2VuaXplcihmYWxzZSkgPT0gVE9LRU5JWkVSX0NVU1RPTSkKICAg\nICAgICAgICAgY29kZS5hZnRlclNlY3Rpb24oKS5hcHBlbmQoZ2V0Q3VzdG9t\nVG9rZW5pemVyQ2xhc3MoKSk7CgogICAgICAgIGNvZGUuZW5kbCgpOwogICAg\nICAgIGNvZGUuY2xvc2VCcmFjZSgxKTsKCiAgICAgICAgX2NvZGUgPSBjb2Rl\nLnRvU3RyaW5nKCk7CgogICAgICAgIC8vIGlmIHRoaXMgaXMgYW4gaW5uZXIg\nY2xhc3MsIHRoZW4gaW5kZW50IHRoZSBlbnRpcmUKICAgICAgICAvLyBjb2Rl\nIHVuaXQgb25lIHRhYiBsZXZlbAogICAgICAgIGlmIChpc0lubmVyQ2xhc3Mo\nKSkgewogICAgICAgICAgICAvLyBpbmRlbnQgdGhlIGVudGlyZSBjb2RlIGJs\nb2NrIG9uZSBsZXZlbCB0byBtYWtlIGl0CiAgICAgICAgICAgIC8vIGEgcHJv\ncGVydGx5IGluZGVudGVkIGlubmRlciBjbGFzcwogICAgICAgICAgICBfY29k\nZSA9IGNvZGUuZ2V0VGFiKCkgKyBTdHJpbmdzLnJlcGxhY2UoX2NvZGUsCiAg\nICAgICAgICAgICAgICBKMkRvUHJpdkhlbHBlci5nZXRMaW5lU2VwYXJhdG9y\nKCksCiAgICAgICAgICAgICAgICBKMkRvUHJpdkhlbHBlci5nZXRMaW5lU2Vw\nYXJhdG9yKCkgKyBjb2RlLmdldFRhYigpKTsKICAgICAgICB9CgogICAgICAg\nIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qKgogICAgICogV3JpdGVzIHRo\nZSBnZW5lcmF0ZWQgY29kZSB0byB0aGUgcHJvcGVyIGZpbGUuCiAgICAgKi8K\nICAgIHB1YmxpYyB2b2lkIHJlY29yZCgpCiAgICAgICAgdGhyb3dzIElPRXhj\nZXB0aW9uIHsKICAgICAgICBpZiAoX2NvZGUgPT0gbnVsbCkKICAgICAgICAg\nICAgcmV0dXJuOwoKICAgICAgICBXcml0ZXIgd3JpdGVyID0gX3dyaXRlcjsK\nICAgICAgICBpZiAod3JpdGVyID09IG51bGwpIHsKICAgICAgICAgICAgRmls\nZSBmaWxlID0gZ2V0RmlsZSgpOwogICAgICAgICAgICBGaWxlcy5iYWNrdXAo\nZmlsZSwgZmFsc2UpOwogICAgICAgICAgICB3cml0ZXIgPSBuZXcgRmlsZVdy\naXRlcihmaWxlKTsKICAgICAgICB9CgogICAgICAgIFByaW50V3JpdGVyIHBy\naW50ZXIgPSBuZXcgUHJpbnRXcml0ZXIod3JpdGVyKTsKICAgICAgICBwcmlu\ndGVyLnByaW50KF9jb2RlKTsKICAgICAgICBwcmludGVyLmZsdXNoKCk7Cgog\nICAgICAgIGlmIChfd3JpdGVyID09IG51bGwpCiAgICAgICAgICAgIHdyaXRl\nci5jbG9zZSgpOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRoZSBu\nZWNlc3NhcnkgaW1wb3J0cyBmb3IgdGhlIGNsYXNzLgogICAgICovCiAgICBw\ncml2YXRlIFN0cmluZyBnZXRJbXBvcnRzKCkgewogICAgICAgIFNldCBwa2dz\nID0gZ2V0SW1wb3J0UGFja2FnZXMoKTsKCiAgICAgICAgQ29kZUZvcm1hdCBp\nbXBvcnRzID0gbmV3Q29kZUZvcm1hdCgpOwogICAgICAgIFN0cmluZyBiYXNl\nID0gU3RyaW5ncy5nZXRQYWNrYWdlTmFtZShfbWV0YS5nZXRPYmplY3RJZFR5\ncGUoKSk7CiAgICAgICAgU3RyaW5nIHBrZzsKICAgICAgICBmb3IgKEl0ZXJh\ndG9yIGl0ciA9IHBrZ3MuaXRlcmF0b3IoKTsgaXRyLmhhc05leHQoKTspIHsK\nICAgICAgICAgICAgcGtnID0gKFN0cmluZykgaXRyLm5leHQoKTsKICAgICAg\nICAgICAgaWYgKHBrZy5sZW5ndGgoKSA+IDAgJiYgISJqYXZhLmxhbmciLmVx\ndWFscyhwa2cpCiAgICAgICAgICAgICAgICAmJiAhYmFzZS5lcXVhbHMocGtn\nKSkgewogICAgICAgICAgICAgICAgaWYgKGltcG9ydHMubGVuZ3RoKCkgPiAw\nKQogICAgICAgICAgICAgICAgICAgIGltcG9ydHMuZW5kbCgpOwogICAgICAg\nICAgICAgICAgaW1wb3J0cy5hcHBlbmQoImltcG9ydCAiKS5hcHBlbmQocGtn\nKS5hcHBlbmQoIi4qOyIpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAg\nICAgIHJldHVybiBpbXBvcnRzLnRvU3RyaW5nKCk7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBSZXR1cm5zIHRoZSBjb2xsZWN0aW9uIG9mIHBhY2thZ2VzIHRo\nYXQgbmVlZCB0byBiZSBpbXBvcnRlZC4KICAgICAqLwogICAgcHVibGljIFNl\ndCBnZXRJbXBvcnRQYWNrYWdlcygpIHsKICAgICAgICBTZXQgcGtncyA9IG5l\ndyBUcmVlU2V0KCk7CiAgICAgICAgcGtncy5hZGQoU3RyaW5ncy5nZXRQYWNr\nYWdlTmFtZShfdHlwZSkpOwoKICAgICAgICBDbGFzcyBzdXBlck9pZENsYXNz\nID0gbnVsbDsKICAgICAgICBpZiAoX21ldGEgIT0gbnVsbCAmJiBfbWV0YS5n\nZXRQQ1N1cGVyY2xhc3NNZXRhRGF0YSgpICE9IG51bGwpCiAgICAgICAgICAg\nIHN1cGVyT2lkQ2xhc3MgPSBfbWV0YS5nZXRQQ1N1cGVyY2xhc3NNZXRhRGF0\nYSgpLmdldE9iamVjdElkVHlwZSgpOwogICAgICAgIGlmIChzdXBlck9pZENs\nYXNzICE9IG51bGwpCiAgICAgICAgICAgIHBrZ3MuYWRkKFN0cmluZ3MuZ2V0\nUGFja2FnZU5hbWUoc3VwZXJPaWRDbGFzcykpOwoKICAgICAgICBwa2dzLmFk\nZCgiamF2YS5pbyIpOwogICAgICAgIHBrZ3MuYWRkKCJqYXZhLnV0aWwiKTsK\nICAgICAgICBDbGFzcyB0eXBlOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBp\nIDwgX2ZpZWxkcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICB0eXBlID0g\nX2ZpZWxkc1tpXS5nZXRPYmplY3RJZEZpZWxkVHlwZSgpOwogICAgICAgICAg\nICBpZiAodHlwZSAhPSBieXRlW10uY2xhc3MgJiYgdHlwZSAhPSBjaGFyW10u\nY2xhc3MKICAgICAgICAgICAgICAgICYmICF0eXBlLmdldE5hbWUoKS5zdGFy\ndHNXaXRoKCJqYXZhLnNxbC4iKSkgewogICAgICAgICAgICAgICAgcGtncy5h\nZGQoU3RyaW5ncy5nZXRQYWNrYWdlTmFtZSh0eXBlKSk7CiAgICAgICAgICAg\nIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIHBrZ3M7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBSZXR1cm4gdGhlIGNvZGUgdG8gZGVjbGFyZSBhbGwgcHJp\nbWFyeSBrZXkgZmllbGRzLgogICAgICovCiAgICBwcml2YXRlIFN0cmluZyBn\nZXRGaWVsZERlY2xhcmF0aW9ucygpIHsKICAgICAgICBDb2RlRm9ybWF0IGNv\nZGUgPSBuZXdDb2RlRm9ybWF0KCk7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7\nIGkgPCBfZmllbGRzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGlmIChp\nID4gMCkKICAgICAgICAgICAgICAgIGNvZGUuZW5kbCgpOwogICAgICAgICAg\nICBjb2RlLnRhYigpLmFwcGVuZCgicHVibGljICIpLmFwcGVuZChnZXRUeXBl\nTmFtZShfZmllbGRzW2ldKSkuCiAgICAgICAgICAgICAgICBhcHBlbmQoIiAi\nKS5hcHBlbmQoX2ZpZWxkc1tpXS5nZXROYW1lKCkpLmFwcGVuZCgiOyIpOwog\nICAgICAgIH0KICAgICAgICByZXR1cm4gY29kZS50b1N0cmluZygpOwogICAg\nfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRoZSB0eXBlIG5hbWUgdG8gZGVj\nbGFyZSB0aGUgZ2l2ZW4gZmllbGQgYXMuCiAgICAgKi8KICAgIHByaXZhdGUg\nU3RyaW5nIGdldFR5cGVOYW1lKEZpZWxkTWV0YURhdGEgZm1kKSB7CiAgICAg\nICAgQ2xhc3MgdHlwZSA9IGZtZC5nZXRPYmplY3RJZEZpZWxkVHlwZSgpOwog\nICAgICAgIGlmICh0eXBlID09IGJ5dGVbXS5jbGFzcykKICAgICAgICAgICAg\ncmV0dXJuICJieXRlW10iOwogICAgICAgIGlmICh0eXBlID09IGNoYXJbXS5j\nbGFzcykKICAgICAgICAgICAgcmV0dXJuICJjaGFyW10iOwogICAgICAgIGlm\nICh0eXBlLmdldE5hbWUoKS5zdGFydHNXaXRoKCJqYXZhLnNxbC4iKSkKICAg\nICAgICAgICAgcmV0dXJuIHR5cGUuZ2V0TmFtZSgpOwogICAgICAgIHJldHVy\nbiBTdHJpbmdzLmdldENsYXNzTmFtZSh0eXBlKTsKICAgIH0KCiAgICAvKioK\nICAgICAqIFJldHVybiB0aGUgZ2V0dGVycyBhbmQgc2V0dGVycyBmb3IgYWxs\nIHByaW1hcnkga2V5IGZpZWxkcy4KICAgICAqLwogICAgcHJpdmF0ZSBTdHJp\nbmcgZ2V0UHJvcGVydGllcygpIHsKICAgICAgICBpZiAoX21ldGEuZ2V0QWNj\nZXNzVHlwZSgpID09IENsYXNzTWV0YURhdGEuQUNDRVNTX0ZJRUxEKQogICAg\nICAgICAgICByZXR1cm4gIiI7CgogICAgICAgIENvZGVGb3JtYXQgY29kZSA9\nIG5ld0NvZGVGb3JtYXQoKTsKICAgICAgICBTdHJpbmcgcHJvcE5hbWU7CiAg\nICAgICAgU3RyaW5nIHR5cGVOYW1lOwogICAgICAgIGZvciAoaW50IGkgPSAw\nOyBpIDwgX2ZpZWxkcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBpZiAo\naSA+IDApCiAgICAgICAgICAgICAgICBjb2RlLmFmdGVyU2VjdGlvbigpOwog\nICAgICAgICAgICB0eXBlTmFtZSA9IGdldFR5cGVOYW1lKF9maWVsZHNbaV0p\nOwogICAgICAgICAgICBwcm9wTmFtZSA9IFN0cmluZ1V0aWxzLmNhcGl0YWxp\nemUoX2ZpZWxkc1tpXS5nZXROYW1lKCkpOwoKICAgICAgICAgICAgY29kZS50\nYWIoKS5hcHBlbmQoInB1YmxpYyAiKS5hcHBlbmQodHlwZU5hbWUpLmFwcGVu\nZCgiICIpOwogICAgICAgICAgICBpZiAoX2ZpZWxkc1tpXS5nZXREZWNsYXJl\nZFR5cGVDb2RlKCkgPT0gSmF2YVR5cGVzLkJPT0xFQU4KICAgICAgICAgICAg\nICAgIHx8IF9maWVsZHNbaV0uZ2V0RGVjbGFyZWRUeXBlQ29kZSgpID09IEph\ndmFUeXBlcy5CT09MRUFOX09CSikKICAgICAgICAgICAgICAgIGNvZGUuYXBw\nZW5kKCJpcyIpOwogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICBj\nb2RlLmFwcGVuZCgiZ2V0Iik7CiAgICAgICAgICAgIGNvZGUuYXBwZW5kKHBy\nb3BOYW1lKS5wYXJlbnMoKS5vcGVuQnJhY2UoMikuZW5kbCgpOwogICAgICAg\nICAgICBjb2RlLnRhYigyKS5hcHBlbmQoInJldHVybiAiKS5hcHBlbmQoX2Zp\nZWxkc1tpXS5nZXROYW1lKCkpLgogICAgICAgICAgICAgICAgYXBwZW5kKCI7\nIikuZW5kbCgpOwogICAgICAgICAgICBjb2RlLmNsb3NlQnJhY2UoMik7CiAg\nICAgICAgICAgIGNvZGUuYWZ0ZXJTZWN0aW9uKCk7CgogICAgICAgICAgICBj\nb2RlLnRhYigpLmFwcGVuZCgicHVibGljIHZvaWQgc2V0IikuYXBwZW5kKHBy\nb3BOYW1lKTsKICAgICAgICAgICAgY29kZS5vcGVuUGFyZW4odHJ1ZSkuYXBw\nZW5kKHR5cGVOYW1lKS5hcHBlbmQoIiAiKS4KICAgICAgICAgICAgICAgIGFw\ncGVuZChfZmllbGRzW2ldLmdldE5hbWUoKSkuY2xvc2VQYXJlbigpOwogICAg\nICAgICAgICBjb2RlLm9wZW5CcmFjZSgyKS5lbmRsKCk7CiAgICAgICAgICAg\nIGNvZGUudGFiKDIpLmFwcGVuZCgidGhpcy4iKS5hcHBlbmQoX2ZpZWxkc1tp\nXS5nZXROYW1lKCkpLgogICAgICAgICAgICAgICAgYXBwZW5kKCIgPSAiKS5h\ncHBlbmQoX2ZpZWxkc1tpXS5nZXROYW1lKCkpLmFwcGVuZCgiOyIpLgogICAg\nICAgICAgICAgICAgZW5kbCgpOwogICAgICAgICAgICBjb2RlLmNsb3NlQnJh\nY2UoMik7CiAgICAgICAgfQogICAgICAgIHJldHVybiBjb2RlLnRvU3RyaW5n\nKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIHN0cmluZyBj\nb25zdHJ1Y3RvciBjb2RlLgogICAgICovCiAgICBwcml2YXRlIFN0cmluZyBn\nZXRDb25zdHJ1Y3Rvcihib29sZWFuIGhhc1N1cGVyY2xhc3MpIHsKICAgICAg\nICBDb2RlRm9ybWF0IGNvZGUgPSBuZXdDb2RlRm9ybWF0KCk7CiAgICAgICAg\nY29kZS50YWIoKS5hcHBlbmQoInB1YmxpYyAiKTsKICAgICAgICBjb2RlLmFw\ncGVuZChnZXRDbGFzc05hbWUoKSk7CiAgICAgICAgY29kZS5vcGVuUGFyZW4o\ndHJ1ZSkuYXBwZW5kKCJTdHJpbmcgc3RyIikuY2xvc2VQYXJlbigpOwogICAg\nICAgIGNvZGUub3BlbkJyYWNlKDIpLmVuZGwoKTsKCiAgICAgICAgaWYgKF9m\naWVsZHMubGVuZ3RoICE9IDAgfHwgKGhhc1N1cGVyY2xhc3MKICAgICAgICAg\nICAgJiYgX21ldGEuZ2V0UHJpbWFyeUtleUZpZWxkcygpLmxlbmd0aCA+IDAp\nKSB7CiAgICAgICAgICAgIGNvZGUudGFiKDIpLmFwcGVuZCgiZnJvbVN0cmlu\nZyIpLm9wZW5QYXJlbih0cnVlKS4KICAgICAgICAgICAgICAgIGFwcGVuZCgi\nc3RyIikuY2xvc2VQYXJlbigpLmFwcGVuZCgiOyIpLmVuZGwoKTsKICAgICAg\nICB9CgogICAgICAgIGNvZGUuY2xvc2VCcmFjZSgyKTsKICAgICAgICByZXR1\ncm4gY29kZS50b1N0cmluZygpOwogICAgfQoKICAgIC8qKgogICAgICogQ3Jl\nYXRlIHRoZSBmcm9tU3RyaW5nIG1ldGhvZCB0aGF0IHBhcnNlcyB0aGUgcmVz\ndWx0IG9mIG91ciB0b1N0cmluZwogICAgICogbWV0aG9kLiBJZiB3ZSBoYXZl\nIHN1cGVyY2xhc3NlcyB3aXRoIGlkIGZpZWxkcywgdGhpcyB3aWxsIGNhbGwK\nICAgICAqIHN1cGVyLmZyb21TdHJpbmcoKSBzbyB0aGF0IHRoZSBwYXJlbnQg\nY2xhc3MgY2FuIHBhcnNlIGl0cyBvd24gZmllbGRzLgogICAgICovCiAgICBw\ncml2YXRlIFN0cmluZyBnZXRGcm9tU3RyaW5nQ29kZShib29sZWFuIGhhc1N1\ncGVyY2xhc3MpIHsKICAgICAgICAvLyBpZiB3ZSBhcmUgYmVsb3cgYSBjb25j\ncmV0ZSBjbGFzcyB0aGVuIHdlIGNhbm5vdCBkZWNsYXJlIGFueQogICAgICAg\nIC8vIG1vcmUgcHJpbWFyeSBrZXkgZmllbGRzOyB0aHVzLCBqdXN0IHVzZSB0\naGUgcGFyZW50IGludm9jYXRpb24KICAgICAgICBpZiAoaGFzQ29uY3JldGVT\ndXBlcmNsYXNzKCkpCiAgICAgICAgICAgIHJldHVybiAiIjsKICAgICAgICBp\nZiAoX2ZpZWxkcy5sZW5ndGggPT0gMCkKICAgICAgICAgICAgcmV0dXJuICIi\nOwogICAgICAgIGhhc1N1cGVyY2xhc3MgPSBoYXNTdXBlcmNsYXNzICYmIGdl\ndERlY2xhcmVkUHJpbWFyeUtleUZpZWxkcwogICAgICAgICAgICAoX21ldGEu\nZ2V0UENTdXBlcmNsYXNzTWV0YURhdGEoKSkubGVuZ3RoID4gMDsKCiAgICAg\nICAgU3RyaW5nIHRva2UgPSBnZXRUb2tlbml6ZXIoaGFzU3VwZXJjbGFzcyk7\nCiAgICAgICAgQ29kZUZvcm1hdCBjb2RlID0gbmV3Q29kZUZvcm1hdCgpOwog\nICAgICAgIGlmIChfYWJzdHJhY3QgfHwgaGFzU3VwZXJjbGFzcykKICAgICAg\nICAgICAgY29kZS50YWIoKS5hcHBlbmQoInByb3RlY3RlZCAiKS5hcHBlbmQo\ndG9rZSkuCiAgICAgICAgICAgICAgICBhcHBlbmQoIiBmcm9tU3RyaW5nIik7\nCiAgICAgICAgZWxzZQogICAgICAgICAgICBjb2RlLnRhYigpLmFwcGVuZCgi\ncHJpdmF0ZSB2b2lkIGZyb21TdHJpbmciKTsKICAgICAgICBjb2RlLm9wZW5Q\nYXJlbih0cnVlKS5hcHBlbmQoIlN0cmluZyBzdHIiKS5jbG9zZVBhcmVuKCk7\nCiAgICAgICAgY29kZS5vcGVuQnJhY2UoMikuZW5kbCgpOwoKICAgICAgICAv\nLyBpZiB3ZSBoYXZlIGFueSBPYmplY3QtdHlwZSBmaWVsZHMsIGRpZSBpbW1l\nZGlhdGVseSAKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IF9maWVsZHMu\nbGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgaWYgKF9maWVsZHNbaV0uZ2V0\nT2JqZWN0SWRGaWVsZFR5cGUoKSAhPSBPYmplY3QuY2xhc3MpCiAgICAgICAg\nICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgY29kZS50YWIoMikuYXBw\nZW5kKCJ0aHJvdyBuZXcgVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb24i\nKS4KICAgICAgICAgICAgICAgIHBhcmVucygpLmFwcGVuZCgiOyIpLmVuZGwo\nKTsKICAgICAgICAgICAgY29kZS5jbG9zZUJyYWNlKDIpOyAKICAgICAgICAg\nICAgcmV0dXJuIGNvZGUudG9TdHJpbmcoKTsKICAgICAgICB9IAoKICAgICAg\nICBpZiAodG9rZSAhPSBudWxsKSB7CiAgICAgICAgICAgIGNvZGUudGFiKDIp\nLmFwcGVuZCh0b2tlKS5hcHBlbmQoIiB0b2tlID0gIik7CiAgICAgICAgICAg\nIGlmIChoYXNTdXBlcmNsYXNzKSB7CiAgICAgICAgICAgICAgICAvLyBjYWxs\nIHN1cGVyLmZyb21TdHJpbmcoc3RyKSB0byBnZXQgdGhlIHRva2VuaXplciB0\naGF0IHdhcwogICAgICAgICAgICAgICAgLy8gdXNlZCB0byBwYXJzZSB0aGUg\nc3VwZXJjbGFzcwogICAgICAgICAgICAgICAgY29kZS5hcHBlbmQoInN1cGVy\nLmZyb21TdHJpbmciKS5vcGVuUGFyZW4odHJ1ZSkuCiAgICAgICAgICAgICAg\nICAgICAgYXBwZW5kKCJzdHIiKS5jbG9zZVBhcmVuKCk7CiAgICAgICAgICAg\nIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAvLyBvdGhlcndpc2UgY29uc3Ry\ndWN0IGEgbmV3IHRva2VuaXplciB3aXRoIHRoZSBzdHJpbmcKICAgICAgICAg\nICAgICAgIGNvZGUuYXBwZW5kKCJuZXcgIikuYXBwZW5kKHRva2UpLm9wZW5Q\nYXJlbih0cnVlKS4KICAgICAgICAgICAgICAgICAgICBhcHBlbmQoInN0ciIp\nOwogICAgICAgICAgICAgICAgaWYgKHRva2UgPT0gVE9LRU5JWkVSX1NURCkK\nICAgICAgICAgICAgICAgICAgICBjb2RlLmFwcGVuZCgiLCBcIiIpLmFwcGVu\nZChfdG9rZW4pLmFwcGVuZCgiXCIiKTsKICAgICAgICAgICAgICAgIGNvZGUu\nY2xvc2VQYXJlbigpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGNvZGUu\nYXBwZW5kKCI7IikuZW5kbCgpOwogICAgICAgIH0KCiAgICAgICAgZm9yIChp\nbnQgaSA9IDA7IGkgPCBfZmllbGRzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAg\nICAgIGlmICh0b2tlICE9IG51bGwpIHsKICAgICAgICAgICAgICAgIGNvZGUu\ndGFiKDIpLmFwcGVuZCgic3RyID0gdG9rZS5uZXh0VG9rZW4iKS5wYXJlbnMo\nKS4KICAgICAgICAgICAgICAgICAgICBhcHBlbmQoIjsiKS5lbmRsKCk7CiAg\nICAgICAgICAgIH0KICAgICAgICAgICAgY29kZS50YWIoMikuYXBwZW5kKGdl\ndENvbnZlcnNpb25Db2RlKF9maWVsZHNbaV0sICJzdHIiKSkuZW5kbCgpOwog\nICAgICAgIH0KICAgICAgICBpZiAoX2Fic3RyYWN0IHx8IGhhc1N1cGVyY2xh\nc3MpCiAgICAgICAgICAgIGNvZGUudGFiKDIpLmFwcGVuZCgicmV0dXJuIHRv\na2U7IikuZW5kbCgpOwogICAgICAgIGNvZGUuY2xvc2VCcmFjZSgyKTsKICAg\nICAgICByZXR1cm4gY29kZS50b1N0cmluZygpOwogICAgfQoKICAgIC8qKgog\nICAgICogUmV0dXJucyB0aGUgdHlwZSBvZiB0b2tlbml6ZXIgdG8gdXNlLCBv\nciBudWxsIGlmIG5vbmUuCiAgICAgKi8KICAgIHByaXZhdGUgU3RyaW5nIGdl\ndFRva2VuaXplcihib29sZWFuIGhhc1N1cGVyY2xhc3MpIHsKICAgICAgICBp\nZiAoIV9hYnN0cmFjdCAmJiAhaGFzU3VwZXJjbGFzcyAmJiBfZmllbGRzLmxl\nbmd0aCA9PSAxKQogICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICBp\nZiAoX3Rva2VuLmxlbmd0aCgpID09IDEpCiAgICAgICAgICAgIHJldHVybiBU\nT0tFTklaRVJfU1REOwogICAgICAgIHJldHVybiBUT0tFTklaRVJfQ1VTVE9N\nOwogICAgfQoKICAgIC8qKgogICAgICogR2V0IHBhcnNpbmcgY29kZSBmb3Ig\ndGhlIGdpdmVuIGZpZWxkLgogICAgICovCiAgICBwcml2YXRlIFN0cmluZyBn\nZXRDb252ZXJzaW9uQ29kZShGaWVsZE1ldGFEYXRhIGZpZWxkLCBTdHJpbmcg\ndmFyKSB7CiAgICAgICAgQ29kZUZvcm1hdCBwYXJzZSA9IG5ld0NvZGVGb3Jt\nYXQoKTsKICAgICAgICBpZiAoZmllbGQuZ2V0TmFtZSgpLmVxdWFscyh2YXIp\nKQogICAgICAgICAgICBwYXJzZS5hcHBlbmQoInRoaXMuIik7CiAgICAgICAg\ncGFyc2UuYXBwZW5kKGZpZWxkLmdldE5hbWUoKSkuYXBwZW5kKCIgPSAiKTsK\nCiAgICAgICAgQ2xhc3MgdHlwZSA9IGZpZWxkLmdldE9iamVjdElkRmllbGRU\neXBlKCk7CiAgICAgICAgaWYgKHR5cGUgPT0gRGF0ZS5jbGFzcykgewogICAg\nICAgICAgICBwYXJzZS5hcHBlbmQoIm5ldyBEYXRlIikub3BlblBhcmVuKHRy\ndWUpLgogICAgICAgICAgICAgICAgYXBwZW5kKCJMb25nLnBhcnNlTG9uZyIp\nLm9wZW5QYXJlbih0cnVlKS4KICAgICAgICAgICAgICAgIGFwcGVuZCh2YXIp\nLmNsb3NlUGFyZW4oKS5jbG9zZVBhcmVuKCk7CiAgICAgICAgfSBlbHNlIGlm\nICh0eXBlID09IGphdmEuc3FsLkRhdGUuY2xhc3MKICAgICAgICAgICAgfHwg\ndHlwZSA9PSBqYXZhLnNxbC5UaW1lc3RhbXAuY2xhc3MKICAgICAgICAgICAg\nfHwgdHlwZSA9PSBqYXZhLnNxbC5UaW1lLmNsYXNzKSB7CiAgICAgICAgICAg\nIHBhcnNlLmFwcGVuZCh0eXBlLmdldE5hbWUoKSkuYXBwZW5kKCIudmFsdWVP\nZiIpLm9wZW5QYXJlbih0cnVlKS4KICAgICAgICAgICAgICAgIGFwcGVuZCh2\nYXIpLmNsb3NlUGFyZW4oKTsKICAgICAgICB9IGVsc2UgaWYgKHR5cGUgPT0g\nU3RyaW5nLmNsYXNzKQogICAgICAgICAgICBwYXJzZS5hcHBlbmQodmFyKTsK\nICAgICAgICBlbHNlIGlmICh0eXBlID09IENoYXJhY3Rlci5jbGFzcykgewog\nICAgICAgICAgICBwYXJzZS5hcHBlbmQoIm5ldyBDaGFyYWN0ZXIiKS5vcGVu\nUGFyZW4odHJ1ZSkuYXBwZW5kKHZhcikuCiAgICAgICAgICAgICAgICBhcHBl\nbmQoIi5jaGFyQXQiKS5vcGVuUGFyZW4odHJ1ZSkuYXBwZW5kKDApLgogICAg\nICAgICAgICAgICAgY2xvc2VQYXJlbigpLmNsb3NlUGFyZW4oKTsKICAgICAg\nICB9IGVsc2UgaWYgKHR5cGUgPT0gYnl0ZVtdLmNsYXNzKQogICAgICAgICAg\nICBwYXJzZS5hcHBlbmQoInRvQnl0ZXMiKS5vcGVuUGFyZW4odHJ1ZSkuYXBw\nZW5kKHZhcikuY2xvc2VQYXJlbigpOwogICAgICAgIGVsc2UgaWYgKHR5cGUg\nPT0gY2hhcltdLmNsYXNzKQogICAgICAgICAgICBwYXJzZS5hcHBlbmQodmFy\nKS5hcHBlbmQoIi50b0NoYXJBcnJheSIpLnBhcmVucygpOwogICAgICAgIGVs\nc2UgaWYgKCF0eXBlLmlzUHJpbWl0aXZlKCkpIHsKICAgICAgICAgICAgcGFy\nc2UuYXBwZW5kKCJuZXcgIikuYXBwZW5kKFN0cmluZ3MuZ2V0Q2xhc3NOYW1l\nKHR5cGUpKS4KICAgICAgICAgICAgICAgIG9wZW5QYXJlbih0cnVlKS5hcHBl\nbmQodmFyKS5jbG9zZVBhcmVuKCk7CiAgICAgICAgfSBlbHNlIC8vIHByaW1p\ndGl2ZQogICAgICAgIHsKICAgICAgICAgICAgc3dpdGNoICh0eXBlLmdldE5h\nbWUoKS5jaGFyQXQoMCkpIHsKICAgICAgICAgICAgICAgIGNhc2UgJ2InOgog\nICAgICAgICAgICAgICAgICAgIGlmICh0eXBlID09IGJvb2xlYW4uY2xhc3Mp\nCiAgICAgICAgICAgICAgICAgICAgICAgIHBhcnNlLmFwcGVuZCgiXCJ0cnVl\nXCIuZXF1YWxzIikub3BlblBhcmVuKHRydWUpLgogICAgICAgICAgICAgICAg\nICAgICAgICAgICAgYXBwZW5kKHZhcikuY2xvc2VQYXJlbigpOwogICAgICAg\nICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICAgICAgcGFy\nc2UuYXBwZW5kKCJCeXRlLnBhcnNlQnl0ZSIpLm9wZW5QYXJlbih0cnVlKS4K\nICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFwcGVuZCh2YXIpLmNsb3Nl\nUGFyZW4oKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAg\nICAgICAgIGNhc2UgJ2MnOgogICAgICAgICAgICAgICAgICAgIHBhcnNlLmFw\ncGVuZCh2YXIpLmFwcGVuZCgiLmNoYXJBdCIpLm9wZW5QYXJlbih0cnVlKS4K\nICAgICAgICAgICAgICAgICAgICAgICAgYXBwZW5kKDApLmNsb3NlUGFyZW4o\nKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAg\nIGNhc2UgJ2QnOgogICAgICAgICAgICAgICAgICAgIHBhcnNlLmFwcGVuZCgi\nRG91YmxlLnBhcnNlRG91YmxlIikub3BlblBhcmVuKHRydWUpLgogICAgICAg\nICAgICAgICAgICAgICAgICBhcHBlbmQodmFyKS5jbG9zZVBhcmVuKCk7CiAg\nICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNl\nICdmJzoKICAgICAgICAgICAgICAgICAgICBwYXJzZS5hcHBlbmQoIkZsb2F0\nLnBhcnNlRmxvYXQiKS5vcGVuUGFyZW4odHJ1ZSkuCiAgICAgICAgICAgICAg\nICAgICAgICAgIGFwcGVuZCh2YXIpLmNsb3NlUGFyZW4oKTsKICAgICAgICAg\nICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgJ2knOgog\nICAgICAgICAgICAgICAgICAgIHBhcnNlLmFwcGVuZCgiSW50ZWdlci5wYXJz\nZUludCIpLm9wZW5QYXJlbih0cnVlKS4KICAgICAgICAgICAgICAgICAgICAg\nICAgYXBwZW5kKHZhcikuY2xvc2VQYXJlbigpOwogICAgICAgICAgICAgICAg\nICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSAnbCc6CiAgICAgICAg\nICAgICAgICAgICAgcGFyc2UuYXBwZW5kKCJMb25nLnBhcnNlTG9uZyIpLm9w\nZW5QYXJlbih0cnVlKS4KICAgICAgICAgICAgICAgICAgICAgICAgYXBwZW5k\nKHZhcikuY2xvc2VQYXJlbigpOwogICAgICAgICAgICAgICAgICAgIGJyZWFr\nOwogICAgICAgICAgICAgICAgY2FzZSAncyc6CiAgICAgICAgICAgICAgICAg\nICAgcGFyc2UuYXBwZW5kKCJTaG9ydC5wYXJzZVNob3J0Iikub3BlblBhcmVu\nKHRydWUpLgogICAgICAgICAgICAgICAgICAgICAgICBhcHBlbmQodmFyKS5j\nbG9zZVBhcmVuKCk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAg\nICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGlmICghdHlwZS5pc1ByaW1p\ndGl2ZSgpICYmIHR5cGUgIT0gYnl0ZVtdLmNsYXNzKSB7CiAgICAgICAgICAg\nIENvZGVGb3JtYXQgaXNOdWxsID0gbmV3Q29kZUZvcm1hdCgpOwogICAgICAg\nICAgICBpc051bGwuYXBwZW5kKCJpZiIpLm9wZW5QYXJlbih0cnVlKS5hcHBl\nbmQoIlwibnVsbFwiLmVxdWFscyIpLgogICAgICAgICAgICAgICAgb3BlblBh\ncmVuKHRydWUpLmFwcGVuZCh2YXIpLmNsb3NlUGFyZW4oKS5jbG9zZVBhcmVu\nKCkuCiAgICAgICAgICAgICAgICBlbmRsKCkudGFiKDMpOwogICAgICAgICAg\nICBpZiAoZmllbGQuZ2V0TmFtZSgpLmVxdWFscyh2YXIpKQogICAgICAgICAg\nICAgICAgaXNOdWxsLmFwcGVuZCgidGhpcy4iKTsKICAgICAgICAgICAgaXNO\ndWxsLmFwcGVuZChmaWVsZC5nZXROYW1lKCkpLmFwcGVuZCgiID0gbnVsbDsi\nKS5lbmRsKCk7CiAgICAgICAgICAgIGlzTnVsbC50YWIoMikuYXBwZW5kKCJl\nbHNlIikuZW5kbCgpOwogICAgICAgICAgICBpc051bGwudGFiKDMpLmFwcGVu\nZChwYXJzZSk7CiAgICAgICAgICAgIHBhcnNlID0gaXNOdWxsOwogICAgICAg\nIH0KCiAgICAgICAgcmV0dXJuIHBhcnNlLmFwcGVuZCgiOyIpLnRvU3RyaW5n\nKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gYW4gZXF1YWxpdHkg\nbWV0aG9kIHRoYXQgY29tcGFyZXMgYWxsIHBrIHZhcmlhYmxlcy4KICAgICAq\nIE11c3QgZGVhbCBjb3JyZWN0bHkgd2l0aCBib3RoIHByaW1pdGl2ZXMgYW5k\nIG9iamVjdHMuCiAgICAgKi8KICAgIHByaXZhdGUgU3RyaW5nIGdldEVxdWFs\nc0NvZGUoYm9vbGVhbiBoYXNTdXBlcmNsYXNzKSB7CiAgICAgICAgLy8gaWYg\nd2UgYXJlIGJlbG93IGEgY29uY3JldGUgY2xhc3MgdGhlbiB3ZSBjYW5ub3Qg\nZGVjbGFyZSBhbnkKICAgICAgICAvLyBtb3JlIHByaW1hcnkga2V5IGZpZWxk\nczsgdGh1cywganVzdCB1c2UgdGhlIHBhcmVudCBpbnZvY2F0aW9uCiAgICAg\nICAgaWYgKGhhc0NvbmNyZXRlU3VwZXJjbGFzcygpIHx8IChoYXNTdXBlcmNs\nYXNzICYmIF9maWVsZHMubGVuZ3RoID09IDApKQogICAgICAgICAgICByZXR1\ncm4gIiI7CgogICAgICAgIENvZGVGb3JtYXQgY29kZSA9IG5ld0NvZGVGb3Jt\nYXQoKTsKICAgICAgICBjb2RlLnRhYigpLmFwcGVuZCgicHVibGljIGJvb2xl\nYW4gZXF1YWxzIikub3BlblBhcmVuKHRydWUpLgogICAgICAgICAgICBhcHBl\nbmQoIk9iamVjdCBvYmoiKS5jbG9zZVBhcmVuKCkub3BlbkJyYWNlKDIpLmVu\nZGwoKTsKCiAgICAgICAgY29kZS50YWIoMikuYXBwZW5kKCJpZiIpLm9wZW5Q\nYXJlbih0cnVlKS4KICAgICAgICAgICAgYXBwZW5kKCJ0aGlzID09IG9iaiIp\nLmNsb3NlUGFyZW4oKS5lbmRsKCk7CiAgICAgICAgY29kZS50YWIoMykuYXBw\nZW5kKCJyZXR1cm4gdHJ1ZTsiKS5lbmRsKCk7CgogICAgICAgIC8vIGNhbGwg\nc3VwZXIuZXF1YWxzKCkgaWYgd2UgaGF2ZSBhIHN1cGVyY2xhc3MKICAgICAg\nICBTdHJpbmcgY2xhc3NOYW1lID0gZ2V0Q2xhc3NOYW1lKCk7CiAgICAgICAg\naWYgKGhhc1N1cGVyY2xhc3MpIHsKICAgICAgICAgICAgY29kZS50YWIoMiku\nYXBwZW5kKCJpZiIpLm9wZW5QYXJlbih0cnVlKS4KICAgICAgICAgICAgICAg\nIGFwcGVuZCgiIXN1cGVyLmVxdWFscyIpLm9wZW5QYXJlbih0cnVlKS4KICAg\nICAgICAgICAgICAgIGFwcGVuZCgib2JqIikuY2xvc2VQYXJlbigpLmNsb3Nl\nUGFyZW4oKS5lbmRsKCk7CiAgICAgICAgICAgIGNvZGUudGFiKDMpLmFwcGVu\nZCgicmV0dXJuIGZhbHNlOyIpLmVuZGwoKTsKICAgICAgICB9IGVsc2Ugewog\nICAgICAgICAgICBjb2RlLnRhYigyKS5hcHBlbmQoImlmIikub3BlblBhcmVu\nKHRydWUpLgogICAgICAgICAgICAgICAgYXBwZW5kKCJvYmogPT0gbnVsbCB8\nfCBvYmouZ2V0Q2xhc3MiKS5wYXJlbnMoKS4KICAgICAgICAgICAgICAgIGFw\ncGVuZCgiICE9ICIpLmFwcGVuZCgiZ2V0Q2xhc3MiKS5wYXJlbnMoKS4KICAg\nICAgICAgICAgICAgIGNsb3NlUGFyZW4oKS5lbmRsKCk7CiAgICAgICAgICAg\nIGNvZGUudGFiKDMpLmFwcGVuZCgicmV0dXJuIGZhbHNlOyIpLmVuZGwoKTsK\nICAgICAgICB9CgogICAgICAgIFN0cmluZyBuYW1lOwogICAgICAgIENsYXNz\nIHR5cGU7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBfZmllbGRzLmxl\nbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGlmIChpID09IDApIHsKICAgICAg\nICAgICAgICAgIGNvZGUuZW5kbCgpLnRhYigyKS5hcHBlbmQoY2xhc3NOYW1l\nKS5hcHBlbmQoIiBvdGhlciA9ICIpLgogICAgICAgICAgICAgICAgICAgIG9w\nZW5QYXJlbihmYWxzZSkuYXBwZW5kKGNsYXNzTmFtZSkuY2xvc2VQYXJlbigp\nLgogICAgICAgICAgICAgICAgICAgIGFwcGVuZCgiIG9iajsiKS5lbmRsKCk7\nCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIGlmIHRoaXMgaXMgbm90\nIHRoZSBmaXJzdCBmaWVsZCwgYWRkIGFuICYmCiAgICAgICAgICAgIGlmIChp\nID09IDApCiAgICAgICAgICAgICAgICBjb2RlLnRhYigyKS5hcHBlbmQoInJl\ndHVybiAiKTsKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgY29k\nZS5lbmRsKCkudGFiKDMpLmFwcGVuZCgiJiYgIik7CgogICAgICAgICAgICBu\nYW1lID0gX2ZpZWxkc1tpXS5nZXROYW1lKCk7CiAgICAgICAgICAgIHR5cGUg\nPSBfZmllbGRzW2ldLmdldE9iamVjdElkRmllbGRUeXBlKCk7CiAgICAgICAg\nICAgIGlmICh0eXBlLmlzUHJpbWl0aXZlKCkpIHsKICAgICAgICAgICAgICAg\nIGNvZGUub3BlblBhcmVuKGZhbHNlKS5hcHBlbmQobmFtZSkuYXBwZW5kKCIg\nPT0gIikuCiAgICAgICAgICAgICAgICAgICAgYXBwZW5kKCJvdGhlci4iKS5h\ncHBlbmQobmFtZSkuY2xvc2VQYXJlbigpOwogICAgICAgICAgICB9IGVsc2Ug\naWYgKHR5cGUgPT0gYnl0ZVtdLmNsYXNzKSB7CiAgICAgICAgICAgICAgICBj\nb2RlLm9wZW5QYXJlbihmYWxzZSkuYXBwZW5kKCJlcXVhbHMiKS5vcGVuUGFy\nZW4odHJ1ZSkuCiAgICAgICAgICAgICAgICAgICAgYXBwZW5kKG5hbWUpLmFw\ncGVuZCgiLCAiKS5hcHBlbmQoIm90aGVyLiIpLgogICAgICAgICAgICAgICAg\nICAgIGFwcGVuZChuYW1lKS5jbG9zZVBhcmVuKCkuY2xvc2VQYXJlbigpOwog\nICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGUgPT0gY2hhcltdLmNsYXNzKSB7\nCiAgICAgICAgICAgICAgICAvLyAoKG5hbWUgPT0gbnVsbCAmJiBvdGhlci5u\nYW1lID09IG51bGwpCiAgICAgICAgICAgICAgICAvLwl8fCAobmFtZSAhPSBu\ndWxsICYmIFN0cmluZy52YWx1ZU9mIChuYW1lKS4KICAgICAgICAgICAgICAg\nIC8vCWVxdWFscyAoU3RyaW5nLnZhbHVlT2YgKG90aGVyLm5hbWUpKSkpCiAg\nICAgICAgICAgICAgICBjb2RlLmFwcGVuZCgiKCIpLm9wZW5QYXJlbihmYWxz\nZSkuYXBwZW5kKG5hbWUpLgogICAgICAgICAgICAgICAgICAgIGFwcGVuZCgi\nID09IG51bGwgJiYgb3RoZXIuIikuYXBwZW5kKG5hbWUpLgogICAgICAgICAg\nICAgICAgICAgIGFwcGVuZCgiID09IG51bGwiKS5jbG9zZVBhcmVuKCkuZW5k\nbCgpOwogICAgICAgICAgICAgICAgY29kZS50YWIoMykuYXBwZW5kKCJ8fCAi\nKTsKICAgICAgICAgICAgICAgIGNvZGUub3BlblBhcmVuKGZhbHNlKS5hcHBl\nbmQobmFtZSkuYXBwZW5kKCIgIT0gbnVsbCAiKS4KICAgICAgICAgICAgICAg\nICAgICBhcHBlbmQoIiYmIFN0cmluZy52YWx1ZU9mIikub3BlblBhcmVuKHRy\ndWUpLmFwcGVuZChuYW1lKS4KICAgICAgICAgICAgICAgICAgICBjbG9zZVBh\ncmVuKCkuYXBwZW5kKCIuIikuZW5kbCgpOwogICAgICAgICAgICAgICAgY29k\nZS50YWIoMykuYXBwZW5kKCJlcXVhbHMiKS5vcGVuUGFyZW4odHJ1ZSkuCiAg\nICAgICAgICAgICAgICAgICAgYXBwZW5kKCJTdHJpbmcudmFsdWVPZiIpLm9w\nZW5QYXJlbih0cnVlKS4KICAgICAgICAgICAgICAgICAgICBhcHBlbmQoIm90\naGVyLiIpLmFwcGVuZChuYW1lKS5jbG9zZVBhcmVuKCkuY2xvc2VQYXJlbigp\nLgogICAgICAgICAgICAgICAgICAgIGNsb3NlUGFyZW4oKS5hcHBlbmQoIiki\nKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIC8vICgo\nbmFtZSA9PSBudWxsICYmIG90aGVyLm5hbWUgPT0gbnVsbCkKICAgICAgICAg\nICAgICAgIC8vCXx8IChuYW1lICE9IG51bGwgJiYgbmFtZS5lcXVhbHMgKG90\naGVyLm5hbWUpKSkKICAgICAgICAgICAgICAgIGNvZGUuYXBwZW5kKCIoIiku\nb3BlblBhcmVuKGZhbHNlKS5hcHBlbmQobmFtZSkuCiAgICAgICAgICAgICAg\nICAgICAgYXBwZW5kKCIgPT0gbnVsbCAmJiBvdGhlci4iKS5hcHBlbmQobmFt\nZSkuCiAgICAgICAgICAgICAgICAgICAgYXBwZW5kKCIgPT0gbnVsbCIpLmNs\nb3NlUGFyZW4oKS5lbmRsKCk7CiAgICAgICAgICAgICAgICBjb2RlLnRhYigz\nKS5hcHBlbmQoInx8ICIpOwogICAgICAgICAgICAgICAgY29kZS5vcGVuUGFy\nZW4oZmFsc2UpLmFwcGVuZChuYW1lKS5hcHBlbmQoIiAhPSBudWxsICIpLgog\nICAgICAgICAgICAgICAgICAgIGFwcGVuZCgiJiYgIikuYXBwZW5kKG5hbWUp\nLmFwcGVuZCgiLmVxdWFscyIpLgogICAgICAgICAgICAgICAgICAgIG9wZW5Q\nYXJlbih0cnVlKS5hcHBlbmQoIm90aGVyLiIpLmFwcGVuZChuYW1lKS4KICAg\nICAgICAgICAgICAgICAgICBjbG9zZVBhcmVuKCkuY2xvc2VQYXJlbigpLmFw\ncGVuZCgiKSIpOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAv\nLyBubyBfZmllbGRzOiBqdXN0IHJldHVybiB0cnVlIGFmdGVyIGNoZWNraW5n\nIGluc3RhbmNlb2YKICAgICAgICBpZiAoX2ZpZWxkcy5sZW5ndGggPT0gMCkK\nICAgICAgICAgICAgY29kZS50YWIoMikuYXBwZW5kKCJyZXR1cm4gdHJ1ZTsi\nKS5lbmRsKCk7CiAgICAgICAgZWxzZQogICAgICAgICAgICBjb2RlLmFwcGVu\nZCgiOyIpLmVuZGwoKTsKCiAgICAgICAgY29kZS5jbG9zZUJyYWNlKDIpOwog\nICAgICAgIHJldHVybiBjb2RlLnRvU3RyaW5nKCk7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBSZXR1cm4gYSBoYXNoQ29kZSBtZXRob2QgdGhhdCB0YWtlcyBp\nbnRvIGFjY291bnQgYWxsCiAgICAgKiBwcmltYXJ5IGtleSB2YWx1ZXMuIE11\nc3QgZGVhbCBjb3JyZWN0bHkgd2l0aCBib3RoIHByaW1pdGl2ZXMgYW5kIG9i\namVjdHMuCiAgICAgKi8KICAgIHByaXZhdGUgU3RyaW5nIGdldEhhc2hDb2Rl\nQ29kZShib29sZWFuIGhhc1N1cGVyY2xhc3MpIHsKICAgICAgICAvLyBpZiB3\nZSBhcmUgYmVsb3cgYSBjb25jcmV0ZSBjbGFzcyB0aGVuIHdlIGNhbm5vdCBk\nZWNsYXJlIGFueQogICAgICAgIC8vIG1vcmUgcHJpbWFyeSBrZXkgZmllbGRz\nOyB0aHVzLCBqdXN0IHVzZSB0aGUgcGFyZW50IGludm9jYXRpb24KICAgICAg\nICBpZiAoaGFzQ29uY3JldGVTdXBlcmNsYXNzKCkgfHwgKGhhc1N1cGVyY2xh\nc3MgJiYgX2ZpZWxkcy5sZW5ndGggPT0gMCkpCiAgICAgICAgICAgIHJldHVy\nbiAiIjsKCiAgICAgICAgQ29kZUZvcm1hdCBjb2RlID0gbmV3Q29kZUZvcm1h\ndCgpOwogICAgICAgIGNvZGUudGFiKCkuYXBwZW5kKCJwdWJsaWMgaW50IGhh\nc2hDb2RlIikucGFyZW5zKCkuCiAgICAgICAgICAgIG9wZW5CcmFjZSgyKS5l\nbmRsKCk7CgogICAgICAgIGlmIChfZmllbGRzLmxlbmd0aCA9PSAwKQogICAg\nICAgICAgICBjb2RlLnRhYigyKS5hcHBlbmQoInJldHVybiAxNzsiKS5lbmRs\nKCk7CiAgICAgICAgZWxzZSBpZiAoX2ZpZWxkcy5sZW5ndGggPT0gMSAmJiAh\naGFzU3VwZXJjbGFzcykgewogICAgICAgICAgICBjb2RlLnRhYigyKS5hcHBl\nbmQoInJldHVybiAiKTsKICAgICAgICAgICAgYXBwZW5kSGFzaENvZGVDb2Rl\nKF9maWVsZHNbMF0sIGNvZGUpOwogICAgICAgICAgICBjb2RlLmFwcGVuZCgi\nOyIpLmVuZGwoKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBjb2Rl\nLnRhYigyKS5hcHBlbmQoImludCBycyA9ICIpOwogICAgICAgICAgICBpZiAo\naGFzU3VwZXJjbGFzcykgewogICAgICAgICAgICAgICAgLy8gY2FsbCBzdXBl\nci5oYXNoQ29kZSgpIGlmIHdlIGhhdmUgYSBzdXBlcmNsYXNzCiAgICAgICAg\nICAgICAgICBjb2RlLmFwcGVuZCgic3VwZXIuaGFzaENvZGUiKS5vcGVuUGFy\nZW4odHJ1ZSkuCiAgICAgICAgICAgICAgICAgICAgY2xvc2VQYXJlbigpLmFw\ncGVuZCgiOyIpOwogICAgICAgICAgICB9IGVsc2UKICAgICAgICAgICAgICAg\nIGNvZGUuYXBwZW5kKCIxNzsiKTsKICAgICAgICAgICAgY29kZS5lbmRsKCk7\nCgogICAgICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IF9maWVsZHMubGVu\nZ3RoOyBpKyspIHsKICAgICAgICAgICAgICAgIGNvZGUudGFiKDIpLmFwcGVu\nZCgicnMgPSBycyAqIDM3ICsgIik7CiAgICAgICAgICAgICAgICBhcHBlbmRI\nYXNoQ29kZUNvZGUoX2ZpZWxkc1tpXSwgY29kZSk7CiAgICAgICAgICAgICAg\nICBjb2RlLmFwcGVuZCgiOyIpLmVuZGwoKTsKICAgICAgICAgICAgfQogICAg\nICAgICAgICBjb2RlLnRhYigyKS5hcHBlbmQoInJldHVybiByczsiKS5lbmRs\nKCk7CiAgICAgICAgfQogICAgICAgIGNvZGUuY2xvc2VCcmFjZSgyKTsKICAg\nICAgICByZXR1cm4gY29kZS50b1N0cmluZygpOwogICAgfQoKICAgIC8qKgog\nICAgICogUmV0dXJuIHRydWUgaWYgdGhpcyBjbGFzcyBoYXMgYSBjb25jcmV0\nZSBzdXBlcmNsYXNzLgogICAgICovCiAgICBwcml2YXRlIGJvb2xlYW4gaGFz\nQ29uY3JldGVTdXBlcmNsYXNzKCkgewogICAgICAgIGZvciAoQ2xhc3NNZXRh\nRGF0YSBzdXAgPSBfbWV0YS5nZXRQQ1N1cGVyY2xhc3NNZXRhRGF0YSgpOwog\nICAgICAgICAgICBzdXAgIT0gbnVsbDsgc3VwID0gc3VwLmdldFBDU3VwZXJj\nbGFzc01ldGFEYXRhKCkpIHsKICAgICAgICAgICAgaWYgKCFNb2RpZmllci5p\nc0Fic3RyYWN0KHN1cC5nZXREZXNjcmliZWRUeXBlKCkuZ2V0TW9kaWZpZXJz\nKCkpKQogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQog\nICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICAvKioKICAgICAqIEFw\ncGVuZCBjb2RlIGNhbGN1bGF0aW5nIHRoZSBoYXNoY29kZSBmb3IgdGhlIGdp\ndmVuIGZpZWxkLgogICAgICovCiAgICBwcml2YXRlIHZvaWQgYXBwZW5kSGFz\naENvZGVDb2RlKEZpZWxkTWV0YURhdGEgZmllbGQsIENvZGVGb3JtYXQgY29k\nZSkgewogICAgICAgIFN0cmluZyBuYW1lID0gZmllbGQuZ2V0TmFtZSgpOwog\nICAgICAgIGlmICgicnMiLmVxdWFscyhuYW1lKSkKICAgICAgICAgICAgbmFt\nZSA9ICJ0aGlzLiIgKyBuYW1lOwogICAgICAgIENsYXNzIHR5cGUgPSBmaWVs\nZC5nZXRPYmplY3RJZEZpZWxkVHlwZSgpOwogICAgICAgIGlmICh0eXBlLmlz\nUHJpbWl0aXZlKCkpIHsKICAgICAgICAgICAgaWYgKHR5cGUgPT0gYm9vbGVh\nbi5jbGFzcykgewogICAgICAgICAgICAgICAgLy8gKChuYW1lKSA/IDEgOiAw\nKQogICAgICAgICAgICAgICAgY29kZS5hcHBlbmQoIigiKS5vcGVuUGFyZW4o\nZmFsc2UpLmFwcGVuZChuYW1lKS5jbG9zZVBhcmVuKCkuCiAgICAgICAgICAg\nICAgICAgICAgYXBwZW5kKCIgPyAxIDogMCIpLmFwcGVuZCgiKSIpOwogICAg\nICAgICAgICB9IGVsc2UgaWYgKHR5cGUgPT0gbG9uZy5jbGFzcykgewogICAg\nICAgICAgICAgICAgLy8gKGludCkgKG5hbWUgXiAobmFtZSA+Pj4gMzIpKQog\nICAgICAgICAgICAgICAgY29kZS5vcGVuUGFyZW4oZmFsc2UpLmFwcGVuZCgi\naW50IikuY2xvc2VQYXJlbigpLgogICAgICAgICAgICAgICAgICAgIGFwcGVu\nZCgiICIpLm9wZW5QYXJlbihmYWxzZSkuYXBwZW5kKG5hbWUpLgogICAgICAg\nICAgICAgICAgICAgIGFwcGVuZCgiIF4gIikub3BlblBhcmVuKGZhbHNlKS5h\ncHBlbmQobmFtZSkuCiAgICAgICAgICAgICAgICAgICAgYXBwZW5kKCIgPj4+\nIDMyIikuY2xvc2VQYXJlbigpLmNsb3NlUGFyZW4oKTsKICAgICAgICAgICAg\nfSBlbHNlIGlmICh0eXBlID09IGRvdWJsZS5jbGFzcykgewogICAgICAgICAg\nICAgICAgLy8gKGludCkgKERvdWJsZS5kb3VibGVUb0xvbmdCaXRzIChuYW1l\nKQogICAgICAgICAgICAgICAgLy8gICAgIF4gKERvdWJsZS5kb3VibGVUb0xv\nbmdCaXRzIChuYW1lKSA+Pj4gMzIpKQogICAgICAgICAgICAgICAgY29kZS5v\ncGVuUGFyZW4oZmFsc2UpLmFwcGVuZCgiaW50IikuY2xvc2VQYXJlbigpLgog\nICAgICAgICAgICAgICAgICAgIGFwcGVuZCgiICIpLm9wZW5QYXJlbihmYWxz\nZSkuCiAgICAgICAgICAgICAgICAgICAgYXBwZW5kKCJEb3VibGUuZG91Ymxl\nVG9Mb25nQml0cyIpLm9wZW5QYXJlbih0cnVlKS4KICAgICAgICAgICAgICAg\nICAgICBhcHBlbmQobmFtZSkuY2xvc2VQYXJlbigpLmVuZGwoKTsKICAgICAg\nICAgICAgICAgIGNvZGUudGFiKDMpLmFwcGVuZCgiXiAiKS5vcGVuUGFyZW4o\nZmFsc2UpLgogICAgICAgICAgICAgICAgICAgIGFwcGVuZCgiRG91YmxlLmRv\ndWJsZVRvTG9uZ0JpdHMiKS5vcGVuUGFyZW4odHJ1ZSkuCiAgICAgICAgICAg\nICAgICAgICAgYXBwZW5kKG5hbWUpLmNsb3NlUGFyZW4oKS5hcHBlbmQoIiA+\nPj4gMzIiKS4KICAgICAgICAgICAgICAgICAgICBjbG9zZVBhcmVuKCkuY2xv\nc2VQYXJlbigpOwogICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGUgPT0gZmxv\nYXQuY2xhc3MpIHsKICAgICAgICAgICAgICAgIC8vIEZsb2F0LmZsb2F0VG9J\nbnRCaXRzIChuYW1lKQogICAgICAgICAgICAgICAgY29kZS5hcHBlbmQoIkZs\nb2F0LmZsb2F0VG9JbnRCaXRzIikub3BlblBhcmVuKHRydWUpLgogICAgICAg\nICAgICAgICAgICAgIGFwcGVuZChuYW1lKS5jbG9zZVBhcmVuKCk7CiAgICAg\nICAgICAgIH0gZWxzZSBpZiAodHlwZSA9PSBpbnQuY2xhc3MpCiAgICAgICAg\nICAgICAgICBjb2RlLmFwcGVuZChuYW1lKTsKICAgICAgICAgICAgZWxzZSB7\nCiAgICAgICAgICAgICAgICAvLyAoaW50KSBuYW1lCiAgICAgICAgICAgICAg\nICBjb2RlLm9wZW5QYXJlbihmYWxzZSkuYXBwZW5kKCJpbnQiKS5jbG9zZVBh\ncmVuKCkuCiAgICAgICAgICAgICAgICAgICAgYXBwZW5kKCIgIikuYXBwZW5k\nKG5hbWUpOwogICAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIGlmICh0eXBl\nID09IGJ5dGVbXS5jbGFzcykgewogICAgICAgICAgICAvLyBoYXNoQ29kZSAo\nbmFtZSk7CiAgICAgICAgICAgIGNvZGUuYXBwZW5kKCJoYXNoQ29kZSIpLm9w\nZW5QYXJlbih0cnVlKS5hcHBlbmQobmFtZSkuCiAgICAgICAgICAgICAgICBj\nbG9zZVBhcmVuKCk7CiAgICAgICAgfSBlbHNlIGlmICh0eXBlID09IGNoYXJb\nXS5jbGFzcykgewogICAgICAgICAgICAvLyAoKG5hbWUgPT0gbnVsbCkgPyAw\nIDogU3RyaW5nLnZhbHVlT2YgKG5hbWUpLmhhc2hDb2RlICgpKQogICAgICAg\nICAgICBjb2RlLmFwcGVuZCgiKCIpLm9wZW5QYXJlbihmYWxzZSkuYXBwZW5k\nKG5hbWUpLgogICAgICAgICAgICAgICAgYXBwZW5kKCIgPT0gbnVsbCIpLmNs\nb3NlUGFyZW4oKS5hcHBlbmQoIiA/IDAgOiAiKS4KICAgICAgICAgICAgICAg\nIGFwcGVuZCgiU3RyaW5nLnZhbHVlT2YiKS5vcGVuUGFyZW4odHJ1ZSkuYXBw\nZW5kKG5hbWUpLgogICAgICAgICAgICAgICAgY2xvc2VQYXJlbigpLmFwcGVu\nZCgiLmhhc2hDb2RlIikucGFyZW5zKCkuYXBwZW5kKCIpIik7CiAgICAgICAg\nfSBlbHNlIHsKICAgICAgICAgICAgLy8gKChuYW1lID09IG51bGwpID8gMCA6\nIG5hbWUuaGFzaENvZGUgKCkpCiAgICAgICAgICAgIGNvZGUuYXBwZW5kKCIo\nIikub3BlblBhcmVuKGZhbHNlKS5hcHBlbmQobmFtZSkuCiAgICAgICAgICAg\nICAgICBhcHBlbmQoIiA9PSBudWxsIikuY2xvc2VQYXJlbigpLmFwcGVuZCgi\nID8gMCA6ICIpLgogICAgICAgICAgICAgICAgYXBwZW5kKG5hbWUpLmFwcGVu\nZCgiLmhhc2hDb2RlIikucGFyZW5zKCkuYXBwZW5kKCIpIik7CiAgICAgICAg\nfQogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIGEgbWV0aG9kIHRvIGNy\nZWF0ZSBhIHN0cmluZyBjb250YWluaW5nIHRoZSBwcmltYXJ5IGtleQogICAg\nICogdmFsdWVzIHRoYXQgZGVmaW5lIHRoZSBhcHBsaWNhdGlvbiBpZCBvYmpl\nY3QuCiAgICAgKi8KICAgIHByaXZhdGUgU3RyaW5nIGdldFRvU3RyaW5nQ29k\nZShib29sZWFuIGhhc1N1cGVyY2xhc3MpIHsKICAgICAgICAvLyBpZiB3ZSBh\ncmUgYmVsb3cgYSBjb25jcmV0ZSBjbGFzcyB0aGVuIHdlIGNhbm5vdCBkZWNs\nYXJlIGFueQogICAgICAgIC8vIG1vcmUgcHJpbWFyeSBrZXkgZmllbGRzOyB0\naHVzLCBqdXN0IHVzZSB0aGUgcGFyZW50IGludm9jYXRpb24KICAgICAgICBp\nZiAoaGFzQ29uY3JldGVTdXBlcmNsYXNzKCkgfHwgKGhhc1N1cGVyY2xhc3Mg\nJiYgX2ZpZWxkcy5sZW5ndGggPT0gMCkpCiAgICAgICAgICAgIHJldHVybiAi\nIjsKCiAgICAgICAgQ29kZUZvcm1hdCBjb2RlID0gbmV3Q29kZUZvcm1hdCgp\nOwogICAgICAgIGNvZGUudGFiKCkuYXBwZW5kKCJwdWJsaWMgU3RyaW5nIHRv\nU3RyaW5nIikucGFyZW5zKCkuCiAgICAgICAgICAgIG9wZW5CcmFjZSgyKS5l\nbmRsKCk7CgogICAgICAgIFN0cmluZyBuYW1lOwogICAgICAgIENsYXNzIHR5\ncGU7CiAgICAgICAgU3RyaW5nIGFwcGVuZERlbGltaXRlciA9ICIrIFwiIiAr\nIF90b2tlbiArICJcIiArICI7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkg\nPCBfZmllbGRzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIC8vIGlmIHRo\naXMgaXMgbm90IHRoZSBmaXJzdCBmaWVsZCwgYWRkIGEgKwogICAgICAgICAg\nICBpZiAoaSA9PSAwKSB7CiAgICAgICAgICAgICAgICBjb2RlLnRhYigyKS5h\ncHBlbmQoInJldHVybiAiKTsKCiAgICAgICAgICAgICAgICAvLyBhZGQgaW4g\ndGhlIHN1cGVyLnRvU3RyaW5nKCkgaWYgd2UgaGF2ZSBhIHBhcmVudAogICAg\nICAgICAgICAgICAgaWYgKGhhc1N1cGVyY2xhc3MgJiYgZ2V0RGVjbGFyZWRQ\ncmltYXJ5S2V5RmllbGRzCiAgICAgICAgICAgICAgICAgICAgKF9tZXRhLmdl\ndFBDU3VwZXJjbGFzc01ldGFEYXRhKCkpLmxlbmd0aCA+IDApIHsKICAgICAg\nICAgICAgICAgICAgICBjb2RlLmFwcGVuZCgic3VwZXIudG9TdHJpbmciKS5w\nYXJlbnMoKTsKICAgICAgICAgICAgICAgICAgICBjb2RlLmVuZGwoKS50YWIo\nMykuYXBwZW5kKGFwcGVuZERlbGltaXRlcik7CiAgICAgICAgICAgICAgICB9\nCiAgICAgICAgICAgIH0gZWxzZQogICAgICAgICAgICAgICAgY29kZS5lbmRs\nKCkudGFiKDMpLmFwcGVuZChhcHBlbmREZWxpbWl0ZXIpOwoKICAgICAgICAg\nICAgbmFtZSA9IF9maWVsZHNbaV0uZ2V0TmFtZSgpOwogICAgICAgICAgICB0\neXBlID0gX2ZpZWxkc1tpXS5nZXRPYmplY3RJZEZpZWxkVHlwZSgpOwogICAg\nICAgICAgICBpZiAodHlwZSA9PSBTdHJpbmcuY2xhc3MpCiAgICAgICAgICAg\nICAgICBjb2RlLmFwcGVuZChuYW1lKTsKICAgICAgICAgICAgZWxzZSBpZiAo\ndHlwZSA9PSBieXRlW10uY2xhc3MpCiAgICAgICAgICAgICAgICBjb2RlLmFw\ncGVuZCgidG9TdHJpbmciKS5vcGVuUGFyZW4odHJ1ZSkuCiAgICAgICAgICAg\nICAgICAgICAgYXBwZW5kKG5hbWUpLmNsb3NlUGFyZW4oKTsKICAgICAgICAg\nICAgZWxzZSBpZiAodHlwZSA9PSBjaGFyW10uY2xhc3MpCiAgICAgICAgICAg\nICAgICBjb2RlLm9wZW5QYXJlbih0cnVlKS5vcGVuUGFyZW4odHJ1ZSkuYXBw\nZW5kKG5hbWUpLgogICAgICAgICAgICAgICAgICAgIGFwcGVuZCgiID09IG51\nbGwiKS5jbG9zZVBhcmVuKCkuYXBwZW5kKCIgPyBcIm51bGxcIiIpLgogICAg\nICAgICAgICAgICAgICAgIGFwcGVuZCgiOiBTdHJpbmcudmFsdWVPZiIpLm9w\nZW5QYXJlbih0cnVlKS4KICAgICAgICAgICAgICAgICAgICBhcHBlbmQobmFt\nZSkuY2xvc2VQYXJlbigpLmNsb3NlUGFyZW4oKTsKICAgICAgICAgICAgZWxz\nZSBpZiAodHlwZSA9PSBEYXRlLmNsYXNzKQogICAgICAgICAgICAgICAgY29k\nZS5vcGVuUGFyZW4odHJ1ZSkub3BlblBhcmVuKHRydWUpLmFwcGVuZChuYW1l\nKS4KICAgICAgICAgICAgICAgICAgICBhcHBlbmQoIiA9PSBudWxsIikuY2xv\nc2VQYXJlbigpLmFwcGVuZCgiID8gXCJudWxsXCIiKS4KICAgICAgICAgICAg\nICAgICAgICBlbmRsKCkudGFiKDQpLmFwcGVuZCgiOiBTdHJpbmcudmFsdWVP\nZiIpLgogICAgICAgICAgICAgICAgICAgIG9wZW5QYXJlbih0cnVlKS5hcHBl\nbmQobmFtZSkuYXBwZW5kKCIuZ2V0VGltZSIpLgogICAgICAgICAgICAgICAg\nICAgIHBhcmVucygpLmNsb3NlUGFyZW4oKS5jbG9zZVBhcmVuKCk7CiAgICAg\nICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIGNvZGUuYXBwZW5kKCJTdHJp\nbmcudmFsdWVPZiIpLm9wZW5QYXJlbih0cnVlKS4KICAgICAgICAgICAgICAg\nICAgICBhcHBlbmQobmFtZSkuY2xvc2VQYXJlbigpOwogICAgICAgIH0KCiAg\nICAgICAgLy8gbm8gZmllbGRzOyBqdXN0IHVzZSAiIgogICAgICAgIGlmIChf\nZmllbGRzLmxlbmd0aCA9PSAwKQogICAgICAgICAgICBjb2RlLnRhYigyKS5h\ncHBlbmQoInJldHVybiBcIlwiIik7CiAgICAgICAgY29kZS5hcHBlbmQoIjsi\nKS5lbmRsKCk7CiAgICAgICAgY29kZS5jbG9zZUJyYWNlKDIpOwogICAgICAg\nIHJldHVybiBjb2RlLnRvU3RyaW5nKCk7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBDb2RlIHRvIGNvbnZlcnQgYSBzdHJpbmcgdG8gYSBieXRlIGFycmF5Lgog\nICAgICoKICAgICAqIEBzZWUgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51dGls\nLkJhc2UxNkVuY29kZXIjZGVjb2RlCiAgICAgKi8KICAgIHByaXZhdGUgU3Ry\naW5nIGdldFRvQnl0ZXNCeXRlQXJyYXlDb2RlKCkgewogICAgICAgIENvZGVG\nb3JtYXQgY29kZSA9IG5ld0NvZGVGb3JtYXQoKTsKICAgICAgICBjb2RlLnRh\nYigpLmFwcGVuZCgicHJpdmF0ZSBzdGF0aWMgYnl0ZVtdIHRvQnl0ZXMiKS5v\ncGVuUGFyZW4odHJ1ZSkuCiAgICAgICAgICAgIGFwcGVuZCgiU3RyaW5nIHMi\nKS5jbG9zZVBhcmVuKCkub3BlbkJyYWNlKDIpLmVuZGwoKTsKCiAgICAgICAg\nY29kZS50YWIoMikuYXBwZW5kKCJpZiIpLm9wZW5QYXJlbih0cnVlKS5hcHBl\nbmQoIlwibnVsbFwiLmVxdWFscyIpLgogICAgICAgICAgICBvcGVuUGFyZW4o\ndHJ1ZSkuYXBwZW5kKCJzIikuY2xvc2VQYXJlbigpLmNsb3NlUGFyZW4oKS5l\nbmRsKCk7CiAgICAgICAgY29kZS50YWIoMykuYXBwZW5kKCJyZXR1cm4gbnVs\nbDsiKS5lbmRsKDIpOwoKICAgICAgICBjb2RlLnRhYigyKS5hcHBlbmQoImlu\ndCBsZW4gPSBzLmxlbmd0aCIpLnBhcmVucygpLgogICAgICAgICAgICBhcHBl\nbmQoIjsiKS5lbmRsKCk7CiAgICAgICAgY29kZS50YWIoMikuYXBwZW5kKCJi\neXRlW10gciA9IG5ldyBieXRlW2xlbiAvIDJdOyIpLmVuZGwoKTsKICAgICAg\nICBjb2RlLnRhYigyKS5hcHBlbmQoImZvciIpLm9wZW5QYXJlbih0cnVlKS4K\nICAgICAgICAgICAgYXBwZW5kKCJpbnQgaSA9IDA7IGkgPCByLmxlbmd0aDsg\naSsrIikuY2xvc2VQYXJlbigpLgogICAgICAgICAgICBvcGVuQnJhY2UoMyku\nZW5kbCgpOwogICAgICAgIGNvZGUudGFiKDMpLmFwcGVuZCgiaW50IGRpZ2l0\nMSA9IHMuY2hhckF0Iikub3BlblBhcmVuKHRydWUpLgogICAgICAgICAgICBh\ncHBlbmQoImkgKiAyIikuY2xvc2VQYXJlbigpLmFwcGVuZCgiLCAiKS4KICAg\nICAgICAgICAgYXBwZW5kKCJkaWdpdDIgPSBzLmNoYXJBdCIpLm9wZW5QYXJl\nbih0cnVlKS4KICAgICAgICAgICAgYXBwZW5kKCJpICogMiArIDEiKS5jbG9z\nZVBhcmVuKCkuYXBwZW5kKCI7IikuZW5kbCgpOwogICAgICAgIGNvZGUudGFi\nKDMpLmFwcGVuZCgiaWYiKS5vcGVuUGFyZW4odHJ1ZSkuCiAgICAgICAgICAg\nIGFwcGVuZCgiZGlnaXQxID49ICcwJyAmJiBkaWdpdDEgPD0gJzknIikuY2xv\nc2VQYXJlbigpLmVuZGwoKTsKICAgICAgICBjb2RlLnRhYig0KS5hcHBlbmQo\nImRpZ2l0MSAtPSAnMCc7IikuZW5kbCgpOwogICAgICAgIGNvZGUudGFiKDMp\nLmFwcGVuZCgiZWxzZSBpZiIpLm9wZW5QYXJlbih0cnVlKS4KICAgICAgICAg\nICAgYXBwZW5kKCJkaWdpdDEgPj0gJ0EnICYmIGRpZ2l0MSA8PSAnRiciKS5j\nbG9zZVBhcmVuKCkuZW5kbCgpOwogICAgICAgIGNvZGUudGFiKDQpLmFwcGVu\nZCgiZGlnaXQxIC09ICdBJyAtIDEwOyIpLmVuZGwoKTsKICAgICAgICBjb2Rl\nLnRhYigzKS5hcHBlbmQoImlmIikub3BlblBhcmVuKHRydWUpLgogICAgICAg\nICAgICBhcHBlbmQoImRpZ2l0MiA+PSAnMCcgJiYgZGlnaXQyIDw9ICc5JyIp\nLmNsb3NlUGFyZW4oKS5lbmRsKCk7CiAgICAgICAgY29kZS50YWIoNCkuYXBw\nZW5kKCJkaWdpdDIgLT0gJzAnOyIpLmVuZGwoKTsKICAgICAgICBjb2RlLnRh\nYigzKS5hcHBlbmQoImVsc2UgaWYiKS5vcGVuUGFyZW4odHJ1ZSkuCiAgICAg\nICAgICAgIGFwcGVuZCgiZGlnaXQyID49ICdBJyAmJiBkaWdpdDIgPD0gJ0Yn\nIikuY2xvc2VQYXJlbigpLmVuZGwoKTsKICAgICAgICBjb2RlLnRhYig0KS5h\ncHBlbmQoImRpZ2l0MiAtPSAnQScgLSAxMDsiKS5lbmRsKDIpOwogICAgICAg\nIGNvZGUudGFiKDMpLmFwcGVuZCgicltpXSA9IChieXRlKSAiKS5vcGVuUGFy\nZW4oZmFsc2UpLgogICAgICAgICAgICBvcGVuUGFyZW4oZmFsc2UpLmFwcGVu\nZCgiZGlnaXQxIDw8IDQiKS5jbG9zZVBhcmVuKCkuCiAgICAgICAgICAgIGFw\ncGVuZCgiICsgZGlnaXQyIikuY2xvc2VQYXJlbigpLmFwcGVuZCgiOyIpLmVu\nZGwoKTsKICAgICAgICBjb2RlLmNsb3NlQnJhY2UoMykuZW5kbCgpOwogICAg\nICAgIGNvZGUudGFiKDIpLmFwcGVuZCgicmV0dXJuIHI7IikuZW5kbCgpOwoK\nICAgICAgICBjb2RlLmNsb3NlQnJhY2UoMik7CiAgICAgICAgcmV0dXJuIGNv\nZGUudG9TdHJpbmcoKTsKICAgIH0KCiAgICAvKioKICAgICAqIENvZGUgdG8g\nY29udmVydCBhIGJ5dGUgYXJyYXkgdG8gYSBzdHJpbmcuCiAgICAgKgogICAg\nICogQHNlZSBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuQmFzZTE2RW5j\nb2RlciNlbmNvZGUKICAgICAqLwogICAgcHJpdmF0ZSBTdHJpbmcgZ2V0VG9T\ndHJpbmdCeXRlQXJyYXlDb2RlKCkgewogICAgICAgIENvZGVGb3JtYXQgY29k\nZSA9IG5ld0NvZGVGb3JtYXQoKTsKICAgICAgICBjb2RlLnRhYigpLmFwcGVu\nZCgicHJpdmF0ZSBzdGF0aWMgU3RyaW5nIHRvU3RyaW5nIikub3BlblBhcmVu\nKHRydWUpLgogICAgICAgICAgICBhcHBlbmQoImJ5dGVbXSBiIikuY2xvc2VQ\nYXJlbigpLm9wZW5CcmFjZSgyKS5lbmRsKCk7CgogICAgICAgIGNvZGUudGFi\nKDIpLmFwcGVuZCgiaWYiKS5vcGVuUGFyZW4odHJ1ZSkuCiAgICAgICAgICAg\nIGFwcGVuZCgiYiA9PSBudWxsIikuY2xvc2VQYXJlbigpLmVuZGwoKTsKICAg\nICAgICBjb2RlLnRhYigzKS5hcHBlbmQoInJldHVybiBcIm51bGxcIjsiKS5l\nbmRsKDIpOwoKICAgICAgICBjb2RlLnRhYigyKS5hcHBlbmQoIlN0cmluZ0J1\nZmZlciByID0gbmV3IFN0cmluZ0J1ZmZlciIpLgogICAgICAgICAgICBvcGVu\nUGFyZW4odHJ1ZSkuYXBwZW5kKCJiLmxlbmd0aCAqIDIiKS5jbG9zZVBhcmVu\nKCkuCiAgICAgICAgICAgIGFwcGVuZCgiOyIpLmVuZGwoKTsKICAgICAgICBj\nb2RlLnRhYigyKS5hcHBlbmQoImZvciIpLm9wZW5QYXJlbih0cnVlKS4KICAg\nICAgICAgICAgYXBwZW5kKCJpbnQgaSA9IDA7IGkgPCBiLmxlbmd0aDsgaSsr\nIikuY2xvc2VQYXJlbigpLmVuZGwoKTsKICAgICAgICBjb2RlLnRhYigzKS5h\ncHBlbmQoImZvciIpLm9wZW5QYXJlbih0cnVlKS4KICAgICAgICAgICAgYXBw\nZW5kKCJpbnQgaiA9IDE7IGogPj0gMDsgai0tIikuY2xvc2VQYXJlbigpLmVu\nZGwoKTsKICAgICAgICBjb2RlLnRhYig0KS5hcHBlbmQoInIuYXBwZW5kIiku\nb3BlblBhcmVuKHRydWUpLgogICAgICAgICAgICBhcHBlbmQoIkhFWFsiKS5v\ncGVuUGFyZW4oZmFsc2UpLmFwcGVuZCgiYltpXSA+PiAiKS4KICAgICAgICAg\nICAgb3BlblBhcmVuKGZhbHNlKS5hcHBlbmQoImogKiA0IikuY2xvc2VQYXJl\nbigpLmNsb3NlUGFyZW4oKS4KICAgICAgICAgICAgYXBwZW5kKCIgJiAweEZd\nIikuY2xvc2VQYXJlbigpLmFwcGVuZCgiOyIpLmVuZGwoKTsKICAgICAgICBj\nb2RlLnRhYigyKS5hcHBlbmQoInJldHVybiByLnRvU3RyaW5nIikucGFyZW5z\nKCkuCiAgICAgICAgICAgIGFwcGVuZCgiOyIpLmVuZGwoKTsKCiAgICAgICAg\nY29kZS5jbG9zZUJyYWNlKDIpOwogICAgICAgIHJldHVybiBjb2RlLnRvU3Ry\naW5nKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBDb2RlIHRvIHRlc3QgaWYg\ndHdvIGJ5dGUgYXJyYXlzIGFyZSBlcXVhbC4KICAgICAqLwogICAgcHJpdmF0\nZSBTdHJpbmcgZ2V0RXF1YWxzQnl0ZUFycmF5Q29kZSgpIHsKICAgICAgICBD\nb2RlRm9ybWF0IGNvZGUgPSBuZXdDb2RlRm9ybWF0KCk7CiAgICAgICAgY29k\nZS50YWIoKS5hcHBlbmQoInByaXZhdGUgc3RhdGljIGJvb2xlYW4gZXF1YWxz\nIikub3BlblBhcmVuKHRydWUpLgogICAgICAgICAgICBhcHBlbmQoImJ5dGVb\nXSBiMSwgYnl0ZVtdIGIyIikuY2xvc2VQYXJlbigpLm9wZW5CcmFjZSgyKS5l\nbmRsKCk7CgogICAgICAgIGNvZGUudGFiKDIpLmFwcGVuZCgiaWYiKS5vcGVu\nUGFyZW4odHJ1ZSkuCiAgICAgICAgICAgIGFwcGVuZCgiYjEgPT0gbnVsbCAm\nJiBiMiA9PSBudWxsIikuY2xvc2VQYXJlbigpLmVuZGwoKTsKICAgICAgICBj\nb2RlLnRhYigzKS5hcHBlbmQoInJldHVybiB0cnVlOyIpLmVuZGwoKTsKICAg\nICAgICBjb2RlLnRhYigyKS5hcHBlbmQoImlmIikub3BlblBhcmVuKHRydWUp\nLgogICAgICAgICAgICBhcHBlbmQoImIxID09IG51bGwgfHwgYjIgPT0gbnVs\nbCIpLmNsb3NlUGFyZW4oKS5lbmRsKCk7CiAgICAgICAgY29kZS50YWIoMyku\nYXBwZW5kKCJyZXR1cm4gZmFsc2U7IikuZW5kbCgpOwogICAgICAgIGNvZGUu\ndGFiKDIpLmFwcGVuZCgiaWYiKS5vcGVuUGFyZW4odHJ1ZSkuCiAgICAgICAg\nICAgIGFwcGVuZCgiYjEubGVuZ3RoICE9IGIyLmxlbmd0aCIpLmNsb3NlUGFy\nZW4oKS5lbmRsKCk7CiAgICAgICAgY29kZS50YWIoMykuYXBwZW5kKCJyZXR1\ncm4gZmFsc2U7IikuZW5kbCgpOwogICAgICAgIGNvZGUudGFiKDIpLmFwcGVu\nZCgiZm9yIikub3BlblBhcmVuKHRydWUpLgogICAgICAgICAgICBhcHBlbmQo\nImludCBpID0gMDsgaSA8IGIxLmxlbmd0aDsgaSsrIikuY2xvc2VQYXJlbigp\nLmVuZGwoKTsKICAgICAgICBjb2RlLnRhYigzKS5hcHBlbmQoImlmIikub3Bl\nblBhcmVuKHRydWUpLgogICAgICAgICAgICBhcHBlbmQoImIxW2ldICE9IGIy\nW2ldIikuY2xvc2VQYXJlbigpLmVuZGwoKTsKICAgICAgICBjb2RlLnRhYig0\nKS5hcHBlbmQoInJldHVybiBmYWxzZTsiKS5lbmRsKCk7CiAgICAgICAgY29k\nZS50YWIoMikuYXBwZW5kKCJyZXR1cm4gdHJ1ZTsiKS5lbmRsKCk7CgogICAg\nICAgIGNvZGUuY2xvc2VCcmFjZSgyKTsKICAgICAgICByZXR1cm4gY29kZS50\nb1N0cmluZygpOwogICAgfQoKICAgIHByaXZhdGUgU3RyaW5nIGdldEhhc2hD\nb2RlQnl0ZUFycmF5Q29kZSgpIHsKICAgICAgICBDb2RlRm9ybWF0IGNvZGUg\nPSBuZXdDb2RlRm9ybWF0KCk7CiAgICAgICAgY29kZS50YWIoKS5hcHBlbmQo\nInByaXZhdGUgc3RhdGljIGludCBoYXNoQ29kZSIpLm9wZW5QYXJlbih0cnVl\nKS4KICAgICAgICAgICAgYXBwZW5kKCJieXRlW10gYiIpLmNsb3NlUGFyZW4o\nKS5vcGVuQnJhY2UoMikuZW5kbCgpOwoKICAgICAgICBjb2RlLnRhYigyKS5h\ncHBlbmQoImlmIikub3BlblBhcmVuKHRydWUpLmFwcGVuZCgiYiA9PSBudWxs\nIikuCiAgICAgICAgICAgIGNsb3NlUGFyZW4oKS5lbmRsKCk7CiAgICAgICAg\nY29kZS50YWIoMykuYXBwZW5kKCJyZXR1cm4gMDsiKS5lbmRsKCk7CiAgICAg\nICAgY29kZS50YWIoMikuYXBwZW5kKCJpbnQgc3VtID0gMDsiKS5lbmRsKCk7\nCiAgICAgICAgY29kZS50YWIoMikuYXBwZW5kKCJmb3IiKS5vcGVuUGFyZW4o\ndHJ1ZSkuCiAgICAgICAgICAgIGFwcGVuZCgiaW50IGkgPSAwOyBpIDwgYi5s\nZW5ndGg7IGkrKyIpLmNsb3NlUGFyZW4oKS5lbmRsKCk7CiAgICAgICAgY29k\nZS50YWIoMykuYXBwZW5kKCJzdW0gKz0gYltpXTsiKS5lbmRsKCk7CiAgICAg\nICAgY29kZS50YWIoMikuYXBwZW5kKCJyZXR1cm4gc3VtOyIpLmVuZGwoKTsK\nCiAgICAgICAgY29kZS5jbG9zZUJyYWNlKDIpOwogICAgICAgIHJldHVybiBj\nb2RlLnRvU3RyaW5nKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBDb2RlIGRl\nZmluaW5nIGEgdG9rZW5pemVyIGNsYXNzLgogICAgICovCiAgICBwcml2YXRl\nIFN0cmluZyBnZXRDdXN0b21Ub2tlbml6ZXJDbGFzcygpIHsKICAgICAgICBD\nb2RlRm9ybWF0IGNvZGUgPSBuZXdDb2RlRm9ybWF0KCk7CiAgICAgICAgY29k\nZS50YWIoKS5hcHBlbmQoInByb3RlY3RlZCBzdGF0aWMgY2xhc3MgIikuCiAg\nICAgICAgICAgIGFwcGVuZChUT0tFTklaRVJfQ1VTVE9NKS5vcGVuQnJhY2Uo\nMikuZW5kbCgpOwoKICAgICAgICBjb2RlLnRhYigyKS5hcHBlbmQoInByaXZh\ndGUgZmluYWwgU3RyaW5nIHN0cjsiKS5lbmRsKCk7CiAgICAgICAgY29kZS50\nYWIoMikuYXBwZW5kKCJwcml2YXRlIGludCBsYXN0OyIpLmFmdGVyU2VjdGlv\nbigpOwoKICAgICAgICBjb2RlLnRhYigyKS5hcHBlbmQoInB1YmxpYyBUb2tl\nbml6ZXIgKFN0cmluZyBzdHIpIikuCiAgICAgICAgICAgIG9wZW5CcmFjZSgz\nKS5lbmRsKCk7CiAgICAgICAgY29kZS50YWIoMykuYXBwZW5kKCJ0aGlzLnN0\nciA9IHN0cjsiKS5lbmRsKCk7CiAgICAgICAgY29kZS5jbG9zZUJyYWNlKDMp\nLmFmdGVyU2VjdGlvbigpOwoKICAgICAgICBjb2RlLnRhYigyKS5hcHBlbmQo\nInB1YmxpYyBTdHJpbmcgbmV4dFRva2VuICgpIikuCiAgICAgICAgICAgIG9w\nZW5CcmFjZSgzKS5lbmRsKCk7CiAgICAgICAgY29kZS50YWIoMykuYXBwZW5k\nKCJpbnQgbmV4dCA9IHN0ci5pbmRleE9mIikub3BlblBhcmVuKHRydWUpLgog\nICAgICAgICAgICBhcHBlbmQoIlwiIikuYXBwZW5kKF90b2tlbikuYXBwZW5k\nKCJcIiwgbGFzdCIpLmNsb3NlUGFyZW4oKS4KICAgICAgICAgICAgYXBwZW5k\nKCI7IikuZW5kbCgpOwogICAgICAgIGNvZGUudGFiKDMpLmFwcGVuZCgiU3Ry\naW5nIHBhcnQ7IikuZW5kbCgpOwogICAgICAgIGNvZGUudGFiKDMpLmFwcGVu\nZCgiaWYiKS5vcGVuUGFyZW4odHJ1ZSkuYXBwZW5kKCJuZXh0ID09IC0xIiku\nCiAgICAgICAgICAgIGNsb3NlUGFyZW4oKS5vcGVuQnJhY2UoNCkuZW5kbCgp\nOwogICAgICAgIGNvZGUudGFiKDQpLmFwcGVuZCgicGFydCA9IHN0ci5zdWJz\ndHJpbmciKS5vcGVuUGFyZW4odHJ1ZSkuCiAgICAgICAgICAgIGFwcGVuZCgi\nbGFzdCIpLmNsb3NlUGFyZW4oKS5hcHBlbmQoIjsiKS5lbmRsKCk7CiAgICAg\nICAgY29kZS50YWIoNCkuYXBwZW5kKCJsYXN0ID0gc3RyLmxlbmd0aCIpLnBh\ncmVucygpLmFwcGVuZCgiOyIpLgogICAgICAgICAgICBlbmRsKCkuY2xvc2VC\ncmFjZSg0KTsKICAgICAgICBpZiAoIWNvZGUuZ2V0QnJhY2VPblNhbWVMaW5l\nKCkpCiAgICAgICAgICAgIGNvZGUuZW5kbCgpLnRhYigzKTsKICAgICAgICBl\nbHNlCiAgICAgICAgICAgIGNvZGUuYXBwZW5kKCIgIik7CiAgICAgICAgY29k\nZS5hcHBlbmQoImVsc2UiKS5vcGVuQnJhY2UoNCkuZW5kbCgpOwogICAgICAg\nIGNvZGUudGFiKDQpLmFwcGVuZCgicGFydCA9IHN0ci5zdWJzdHJpbmciKS5v\ncGVuUGFyZW4odHJ1ZSkuCiAgICAgICAgICAgIGFwcGVuZCgibGFzdCwgbmV4\ndCIpLmNsb3NlUGFyZW4oKS5hcHBlbmQoIjsiKS5lbmRsKCk7CiAgICAgICAg\nY29kZS50YWIoNCkuYXBwZW5kKCJsYXN0ID0gbmV4dCArICIpLmFwcGVuZChf\ndG9rZW4ubGVuZ3RoKCkpLgogICAgICAgICAgICBhcHBlbmQoIjsiKS5lbmRs\nKCkuY2xvc2VCcmFjZSg0KS5lbmRsKCk7CgogICAgICAgIGNvZGUudGFiKDMp\nLmFwcGVuZCgicmV0dXJuIHBhcnQ7IikuZW5kbCgpOwogICAgICAgIGNvZGUu\nY2xvc2VCcmFjZSgzKTsKICAgICAgICBjb2RlLmVuZGwoKS5jbG9zZUJyYWNl\nKDIpOwogICAgICAgIHJldHVybiBjb2RlLnRvU3RyaW5nKCk7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIGZpbGUgdGhhdCB0aGlzIHRvb2wg\nc2hvdWxkIG91dHB1dCB0by4KICAgICAqLwogICAgcHJpdmF0ZSBGaWxlIGdl\ndEZpbGUoKSB7CiAgICAgICAgaWYgKF9tZXRhID09IG51bGwpCiAgICAgICAg\nICAgIHJldHVybiBudWxsOwoKICAgICAgICBTdHJpbmcgcGFja2FnZU5hbWUg\nPSBTdHJpbmdzLmdldFBhY2thZ2VOYW1lKF9tZXRhLmdldE9iamVjdElkVHlw\nZSgpKTsKICAgICAgICBTdHJpbmcgZmlsZU5hbWUgPSBTdHJpbmdzLmdldENs\nYXNzTmFtZShfbWV0YS5nZXRPYmplY3RJZFR5cGUoKSkKICAgICAgICAgICAg\nKyAiLmphdmEiOwoKICAgICAgICAvLyBpZiBwYyBjbGFzcyBpbiBzYW1lIHBh\nY2thZ2UgYXMgb2lkIGNsYXNzLCB0cnkgdG8gZmluZCBwYyAuamF2YSBmaWxl\nCiAgICAgICAgRmlsZSBkaXIgPSBudWxsOwogICAgICAgIGlmIChfZGlyID09\nIG51bGwgJiYgU3RyaW5ncy5nZXRQYWNrYWdlTmFtZShfdHlwZSkuZXF1YWxz\nKHBhY2thZ2VOYW1lKSkgewogICAgICAgICAgICBkaXIgPSBGaWxlcy5nZXRT\nb3VyY2VGaWxlKF90eXBlKTsKICAgICAgICAgICAgaWYgKGRpciAhPSBudWxs\nKQogICAgICAgICAgICAgICAgZGlyID0gZGlyLmdldFBhcmVudEZpbGUoKTsK\nICAgICAgICB9CiAgICAgICAgaWYgKGRpciA9PSBudWxsKQogICAgICAgICAg\nICBkaXIgPSBGaWxlcy5nZXRQYWNrYWdlRmlsZShfZGlyLCBwYWNrYWdlTmFt\nZSwgdHJ1ZSk7CiAgICAgICAgcmV0dXJuIG5ldyBGaWxlKGRpciwgZmlsZU5h\nbWUpOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIGEgY29weSBvZiB0\naGUgY29ycmVjdCBjb2RlIGZvcm1hdC4KICAgICAqLwogICAgcHJpdmF0ZSBD\nb2RlRm9ybWF0IG5ld0NvZGVGb3JtYXQoKSB7CiAgICAgICAgcmV0dXJuIChf\nZm9ybWF0ID09IG51bGwpID8gbmV3IENvZGVGb3JtYXQoKQogICAgICAgICAg\nICA6IChDb2RlRm9ybWF0KSBfZm9ybWF0LmNsb25lKCk7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBVc2FnZTogamF2YSBvcmcuYXBhY2hlLm9wZW5qcGEuZW5o\nYW5jZS5BcHBsaWNhdGlvbklkVG9vbCBbb3B0aW9uXSoKICAgICAqICZsdDtj\nbGFzcyBuYW1lIHwgLmphdmEgZmlsZSB8IC5jbGFzcyBmaWxlIHwgLmpkbyBm\naWxlJmd0OysKICAgICAqICBXaGVyZSB0aGUgZm9sbG93aW5nIG9wdGlvbnMg\nYXJlIHJlY29nbml6ZWQuCiAgICAgKiA8dWw+CiAgICAgKiA8bGk+PGk+LXBy\nb3BlcnRpZXMvLXAgJmx0O3Byb3BlcnRpZXMgZmlsZSZndDs8L2k+OiBUaGUg\ncGF0aCB0byBhIE9wZW5KUEEKICAgICAqIHByb3BlcnRpZXMgZmlsZSBjb250\nYWluaW5nIGluZm9ybWF0aW9uIGFzIG91dGxpbmVkIGluCiAgICAgKiB7QGxp\nbmsgQ29uZmlndXJhdGlvbn07IG9wdGlvbmFsLjwvbGk+CiAgICAgKiA8bGk+\nPGk+LSZsdDtwcm9wZXJ0eSBuYW1lJmd0OyAmbHQ7cHJvcGVydHkgdmFsdWUm\nZ3Q7PC9pPjogQWxsIGJlYW4KICAgICAqIHByb3BlcnRpZXMgb2YgdGhlIHN0\nYW5kYXJkIE9wZW5KUEEge0BsaW5rIE9wZW5KUEFDb25maWd1cmF0aW9ufSBj\nYW4gYmUKICAgICAqIHNldCBieSB1c2luZyB0aGVpciBuYW1lcyBhbmQgc3Vw\ncGx5aW5nIGEgdmFsdWUuPC9saT4KICAgICAqIDxsaT48aT4tZGlyZWN0b3J5\nLy1kICZsdDtvdXRwdXQgZGlyZWN0b3J5Jmd0OzwvaT46IFBhdGggdG8gdGhl\nIGJhc2UKICAgICAqIHNvdXJjZSBkaXJlY3RvcnkuIFRoZSBwYWNrYWdlIHN0\ncnVjdHVyZSB3aWxsIGJlIGNyZWF0ZWQgYmVuZWF0aAogICAgICogdGhpcyBk\naXJlY3RvcnkgaWYgbmVjZXNzYXJ5LiBJZiBub3Qgc3BlY2lmaWVkLCB0aGUg\ndG9vbCB3aWxsIHRyeQogICAgICogdG8gbG9jYXRlIHRoZSAuamF2YSBmaWxl\nIGluIHRoZSBDTEFTU1BBVEggYW5kIG91dHB1dCB0byB0aGUgc2FtZQogICAg\nICogZGlyZWN0b3J5OyBmYWlsaW5nIHRoYXQsIGl0IHdpbGwgdXNlIHRoZSBj\ndXJyZW50IGRpcmVjdG9yeSBhcwogICAgICogdGhlIGJhc2UgZGlyZWN0b3J5\nLgogICAgICogPGxpPjxpPi1pZ25vcmVFcnJvcnMvLWkgJmx0O3RydWUvdCB8\nIGZhbHNlL2YmZ3Q7PC9pPjogSWYgZmFsc2UsIGFuCiAgICAgKiBleGNlcHRp\nb24gd2lsbCBiZSB0aHJvd24gaWYgdGhlIHRvb2wgZW5jb3VudGVycyBhbnkg\nY2xhc3MgdGhhdAogICAgICogZG9lcyBub3QgdXNlIGFwcGxpY2F0aW9uIGlk\nZW50aXR5IG9yIHVzZXMgdGhlIGlkZW50aXR5IGNsYXNzIG9mCiAgICAgKiBp\ndHMgc3VwZXJjbGFzczsgZGVmYXVsdHMgdG8gdHJ1ZS48L2xpPgogICAgICog\nPGxpPjxpPi10b2tlbi8tdCAmbHQ7dG9rZW4mZ3Q7PC9pPjogVGhlIHRva2Vu\nIHRvIHVzZSB0byBzZXBhcmF0ZQogICAgICogc3RpbmdpZmllZCBwcmltYXJ5\nIGtleSBmaWVsZCB2YWx1ZXMgaW4gdGhlIHN0cmluZ2lmaWVkIG9pZC48L2xp\nPgogICAgICogPGxpPjxpPi1uYW1lLy1uICZsdDtpZCBjbGFzcyBuYW1lJmd0\nOzwvaT46IFRoZSBuYW1lIG9mIHRoZSBpZGVudGl0eQogICAgICogY2xhc3Mg\ndG8gZ2VuZXJhdGUuIElmIHRoaXMgb3B0aW9uIGlzIHNwZWNpZmllZCwgeW91\nIG11c3Qgb25seQogICAgICogZ2l2ZSBhIHNpbmdsZSBjbGFzcyBhcmd1bWVu\ndC4gSWYgdGhlIGNsYXNzIG1ldGFkYXRhIG5hbWVzIGFuIG9iamVjdAogICAg\nICogaWQgY2xhc3MsIHRoaXMgYXJndW1lbnQgaXMgaWdub3JlZC48L2xpPgog\nICAgICogPGxpPjxpPi1zdWZmaXgvLXMgJmx0O2lkIGNsYXNzIHN1ZmZpeCZn\ndDs8L2k+OiBBIHN0cmluZyB0byBzdWZmaXggZWFjaAogICAgICogcGVyc2lz\ndGVudCBjbGFzcyB3aXRoIHRvIGNyZWF0ZSB0aGUgaWRlbnRpdHkgY2xhc3Mg\nbmFtZS4gVGhpcyBpcwogICAgICogb3ZlcnJpZGRlbiBieSA8Y29kZT4tbmFt\nZTwvY29kZT4gb3IgYnkgYW55IGlkZW50aXR5IGNsYXNzIG5hbWUKICAgICAq\nIHNwZWNpZmllZCBpbiBtZXRhZGF0YS48L2xpPgogICAgICogPGxpPjxpPi1j\nb2RlRm9ybWF0Ly1jZi4mbHQ7cHJvcGVydHkgbmFtZSZndDsgJmx0OyBwcm9w\nZXJ0eSB2YWx1ZSZndDs8L2k+CiAgICAgKiA6IEFyZ3VtZW50cyBsaWtlIHRo\naXMgd2lsbCBiZSB1c2VkIHRvIGNvbmZpZ3VyZSB0aGUgYmVhbgogICAgICog\ncHJvcGVydGllcyBvZiB0aGUgaW50ZXJuYWwge0BsaW5rIENvZGVGb3JtYXR9\nLjwvbGk+CiAgICAgKiA8L3VsPgogICAgICogIEVhY2ggYWRkaXRpb25hbCBh\ncmd1bWVudCBjYW4gYmUgZWl0aGVyIHRoZSBmdWxsIGNsYXNzIG5hbWUgb2Yg\ndGhlCiAgICAgKiB0eXBlIHRvIGNyZWF0ZSBhbiBpZCBjbGFzcyBmb3IsIHRo\nZSBwYXRoIHRvIHRoZSAuamF2YSBmaWxlIGZvciB0aGUgdHlwZSwKICAgICAq\nIHRoZSBwYXRoIHRvIHRoZSAuY2xhc3MgZmlsZSBmb3IgdGhlIHR5cGUsIG9y\nIHRoZSBwYXRoIHRvIGEgLmpkbyBmaWxlCiAgICAgKiBsaXN0aW5nIG9uZSBv\nciBtb3JlIHR5cGVzLiBJZiBhIC5qYXZhIGZpbGUgYWxyZWFkeSBleGlzdHMg\nZm9yIGFuCiAgICAgKiBhcHBsaWNhdGlvbiBpZCwgaXQgd2lsbCBiZSBiYWNr\nZWQgdXAgdG8gYSBmaWxlIG5hbWVkCiAgICAgKiAmbHQ7b3JpZyBmaWxlIG5h\nbWUmZ3Q7fi4KICAgICAqLwogICAgcHVibGljIHN0YXRpYyB2b2lkIG1haW4o\nU3RyaW5nW10gYXJncykKICAgICAgICB0aHJvd3MgSU9FeGNlcHRpb24sIENs\nYXNzTm90Rm91bmRFeGNlcHRpb24gewogICAgICAgIE9wdGlvbnMgb3B0cyA9\nIG5ldyBPcHRpb25zKCk7CiAgICAgICAgYXJncyA9IG9wdHMuc2V0RnJvbUNt\nZExpbmUoYXJncyk7CiAgICAgICAgT3BlbkpQQUNvbmZpZ3VyYXRpb24gY29u\nZiA9IG5ldyBPcGVuSlBBQ29uZmlndXJhdGlvbkltcGwoKTsKICAgICAgICB0\ncnkgewogICAgICAgICAgICBpZiAoIXJ1bihjb25mLCBhcmdzLCBvcHRzKSkK\nICAgICAgICAgICAgICAgIFN5c3RlbS5lcnIucHJpbnRsbihfbG9jLmdldCgi\nYXBwaWQtdXNhZ2UiKSk7CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAg\nICAgY29uZi5jbG9zZSgpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAg\nICAqIFJ1biB0aGUgYXBwbGljYXRpb24gaWQgdG9vbCB3aXRoIHRoZSBnaXZl\nbiBjb21tYW5kLWxpbmUgYW5kCiAgICAgKiBnaXZlbiBjb25maWd1cmF0aW9u\nLiBSZXR1cm5zIGZhbHNlIGlmIGludmFsaWQgb3B0aW9ucyB3ZXJlIGdpdmVu\nLgogICAgICovCiAgICBwdWJsaWMgc3RhdGljIGJvb2xlYW4gcnVuKE9wZW5K\nUEFDb25maWd1cmF0aW9uIGNvbmYsIFN0cmluZ1tdIGFyZ3MsCiAgICAgICAg\nT3B0aW9ucyBvcHRzKQogICAgICAgIHRocm93cyBJT0V4Y2VwdGlvbiwgQ2xh\nc3NOb3RGb3VuZEV4Y2VwdGlvbiB7CiAgICAgICAgaWYgKG9wdHMuY29udGFp\nbnNLZXkoImhlbHAiKSB8fCBvcHRzLmNvbnRhaW5zS2V5KCItaGVscCIpKQog\nICAgICAgICAgICByZXR1cm4gZmFsc2U7CgogICAgICAgIEZsYWdzIGZsYWdz\nID0gbmV3IEZsYWdzKCk7CiAgICAgICAgZmxhZ3MuaWdub3JlRXJyb3JzID0g\nb3B0cy5yZW1vdmVCb29sZWFuUHJvcGVydHkKICAgICAgICAgICAgKCJpZ25v\ncmVFcnJvcnMiLCAiaSIsIGZsYWdzLmlnbm9yZUVycm9ycyk7CiAgICAgICAg\nZmxhZ3MuZGlyZWN0b3J5ID0gRmlsZXMuZ2V0RmlsZShvcHRzLnJlbW92ZVBy\nb3BlcnR5KCJkaXJlY3RvcnkiLCAiZCIsCiAgICAgICAgICAgIG51bGwpLCBu\ndWxsKTsKICAgICAgICBmbGFncy50b2tlbiA9IG9wdHMucmVtb3ZlUHJvcGVy\ndHkoInRva2VuIiwgInQiLCBmbGFncy50b2tlbik7CiAgICAgICAgZmxhZ3Mu\nbmFtZSA9IG9wdHMucmVtb3ZlUHJvcGVydHkoIm5hbWUiLCAibiIsIGZsYWdz\nLm5hbWUpOwogICAgICAgIGZsYWdzLnN1ZmZpeCA9IG9wdHMucmVtb3ZlUHJv\ncGVydHkoInN1ZmZpeCIsICJzIiwgZmxhZ3Muc3VmZml4KTsKCiAgICAgICAg\nLy8gc2VwYXJhdGUgdGhlIHByb3BlcnRpZXMgZm9yIHRoZSBjdXN0b21pemVy\nIGFuZCBjb2RlIGZvcm1hdAogICAgICAgIE9wdGlvbnMgZm9ybWF0T3B0cyA9\nIG5ldyBPcHRpb25zKCk7CiAgICAgICAgTWFwLkVudHJ5IGVudHJ5OwogICAg\nICAgIFN0cmluZyBrZXk7CiAgICAgICAgZm9yIChJdGVyYXRvciBpdHIgPSBv\ncHRzLmVudHJ5U2V0KCkuaXRlcmF0b3IoKTsgaXRyLmhhc05leHQoKTspIHsK\nICAgICAgICAgICAgZW50cnkgPSAoTWFwLkVudHJ5KSBpdHIubmV4dCgpOwog\nICAgICAgICAgICBrZXkgPSAoU3RyaW5nKSBlbnRyeS5nZXRLZXkoKTsKICAg\nICAgICAgICAgaWYgKGtleS5zdGFydHNXaXRoKCJjb2RlRm9ybWF0LiIpKSB7\nCiAgICAgICAgICAgICAgICBmb3JtYXRPcHRzLnB1dChrZXkuc3Vic3RyaW5n\nKDExKSwgZW50cnkuZ2V0VmFsdWUoKSk7CiAgICAgICAgICAgICAgICBpdHIu\ncmVtb3ZlKCk7CiAgICAgICAgICAgIH0gZWxzZSBpZiAoa2V5LnN0YXJ0c1dp\ndGgoImNmLiIpKSB7CiAgICAgICAgICAgICAgICBmb3JtYXRPcHRzLnB1dChr\nZXkuc3Vic3RyaW5nKDMpLCBlbnRyeS5nZXRWYWx1ZSgpKTsKICAgICAgICAg\nICAgICAgIGl0ci5yZW1vdmUoKTsKICAgICAgICAgICAgfQogICAgICAgIH0K\nICAgICAgICBpZiAoIWZvcm1hdE9wdHMuaXNFbXB0eSgpKSB7CiAgICAgICAg\nICAgIGZsYWdzLmZvcm1hdCA9IG5ldyBDb2RlRm9ybWF0KCk7CiAgICAgICAg\nICAgIGZvcm1hdE9wdHMuc2V0SW50byhmbGFncy5mb3JtYXQpOwogICAgICAg\nIH0KCiAgICAgICAgQ29uZmlndXJhdGlvbnMucG9wdWxhdGVDb25maWd1cmF0\naW9uKGNvbmYsIG9wdHMpOwogICAgICAgIENsYXNzTG9hZGVyIGxvYWRlciA9\nIGNvbmYuZ2V0Q2xhc3NSZXNvbHZlckluc3RhbmNlKCkuCiAgICAgICAgICAg\nIGdldENsYXNzTG9hZGVyKEFwcGxpY2F0aW9uSWRUb29sLmNsYXNzLCBudWxs\nKTsKICAgICAgICByZXR1cm4gcnVuKGNvbmYsIGFyZ3MsIGZsYWdzLCBsb2Fk\nZXIpOwogICAgfQoKICAgIC8qKgogICAgICogUnVuIHRoZSB0b29sLiBSZXR1\ncm5zIGZhbHNlIGlmIGludmFsaWQgb3B0aW9ucyB3ZXJlIGdpdmVuLgogICAg\nICovCiAgICBwdWJsaWMgc3RhdGljIGJvb2xlYW4gcnVuKE9wZW5KUEFDb25m\naWd1cmF0aW9uIGNvbmYsIFN0cmluZ1tdIGFyZ3MsCiAgICAgICAgRmxhZ3Mg\nZmxhZ3MsIENsYXNzTG9hZGVyIGxvYWRlcikKICAgICAgICB0aHJvd3MgSU9F\neGNlcHRpb24sIENsYXNzTm90Rm91bmRFeGNlcHRpb24gewogICAgICAgIE1l\ndGFEYXRhUmVwb3NpdG9yeSByZXBvcyA9IGNvbmYubmV3TWV0YURhdGFSZXBv\nc2l0b3J5SW5zdGFuY2UoKTsKICAgICAgICByZXBvcy5zZXRWYWxpZGF0ZShy\nZXBvcy5WQUxJREFURV9OT05FLCB0cnVlKTsKICAgICAgICBsb2FkT2JqZWN0\nSWRzKHJlcG9zLCBmbGFncy5uYW1lID09IG51bGwgJiYgZmxhZ3Muc3VmZml4\nID09IG51bGwpOwoKICAgICAgICBMb2cgbG9nID0gY29uZi5nZXRMb2coT3Bl\nbkpQQUNvbmZpZ3VyYXRpb24uTE9HX1RPT0wpOwogICAgICAgIENvbGxlY3Rp\nb24gY2xhc3NlczsKICAgICAgICBpZiAoYXJncy5sZW5ndGggPT0gMCkgewog\nICAgICAgICAgICBsb2cuaW5mbyhfbG9jLmdldCgicnVubmluZy1hbGwtY2xh\nc3NlcyIpKTsKICAgICAgICAgICAgY2xhc3NlcyA9IHJlcG9zLmxvYWRQZXJz\naXN0ZW50VHlwZXModHJ1ZSwgbG9hZGVyKTsKICAgICAgICB9IGVsc2Ugewog\nICAgICAgICAgICBDbGFzc0FyZ1BhcnNlciBjYXAgPSBjb25mLmdldE1ldGFE\nYXRhUmVwb3NpdG9yeUluc3RhbmNlKCkuCiAgICAgICAgICAgICAgICBnZXRN\nZXRhRGF0YUZhY3RvcnkoKS5uZXdDbGFzc0FyZ1BhcnNlcigpOwogICAgICAg\nICAgICBjYXAuc2V0Q2xhc3NMb2FkZXIobG9hZGVyKTsKICAgICAgICAgICAg\nY2xhc3NlcyA9IG5ldyBIYXNoU2V0KCk7CiAgICAgICAgICAgIGZvciAoaW50\nIGkgPSAwOyBpIDwgYXJncy5sZW5ndGg7IGkrKykKICAgICAgICAgICAgICAg\nIGNsYXNzZXMuYWRkQWxsKEFycmF5cy5hc0xpc3QoY2FwLnBhcnNlVHlwZXMo\nYXJnc1tpXSkpKTsKICAgICAgICB9CiAgICAgICAgaWYgKGZsYWdzLm5hbWUg\nIT0gbnVsbCAmJiBjbGFzc2VzLnNpemUoKSA+IDEpCiAgICAgICAgICAgIHRo\ncm93IG5ldyBVc2VyRXhjZXB0aW9uKF9sb2MuZ2V0KCJuYW1lLW11bHQtYXJn\ncyIsIGNsYXNzZXMpKTsKCiAgICAgICAgQXBwbGljYXRpb25JZFRvb2wgdG9v\nbDsKICAgICAgICBDbGFzcyBjbHM7CiAgICAgICAgQ2xhc3NNZXRhRGF0YSBt\nZXRhOwogICAgICAgIEJDQ2xhc3NMb2FkZXIgYmMgPSAoQkNDbGFzc0xvYWRl\ncikgQWNjZXNzQ29udHJvbGxlcgogICAgICAgICAgICAuZG9Qcml2aWxlZ2Vk\nKEoyRG9Qcml2SGVscGVyLm5ld0JDQ2xhc3NMb2FkZXJBY3Rpb24obmV3IFBy\nb2plY3QoKSkpOwogICAgICAgIGZvciAoSXRlcmF0b3IgaXRyID0gY2xhc3Nl\ncy5pdGVyYXRvcigpOyBpdHIuaGFzTmV4dCgpOykgewogICAgICAgICAgICBj\nbHMgPSAoQ2xhc3MpIGl0ci5uZXh0KCk7CiAgICAgICAgICAgIGxvZy5pbmZv\nKF9sb2MuZ2V0KCJhcHBpZC1ydW5uaW5nIiwgY2xzKSk7CgogICAgICAgICAg\nICBtZXRhID0gcmVwb3MuZ2V0TWV0YURhdGEoY2xzLCBudWxsLCBmYWxzZSk7\nCiAgICAgICAgICAgIHNldE9iamVjdElkVHlwZShtZXRhLCBmbGFncywgYmMp\nOwoKICAgICAgICAgICAgdG9vbCA9IG5ldyBBcHBsaWNhdGlvbklkVG9vbChj\nb25mLCBjbHMsIG1ldGEpOwogICAgICAgICAgICB0b29sLnNldERpcmVjdG9y\neShmbGFncy5kaXJlY3RvcnkpOwogICAgICAgICAgICB0b29sLnNldElnbm9y\nZUVycm9ycyhmbGFncy5pZ25vcmVFcnJvcnMpOwogICAgICAgICAgICB0b29s\nLnNldFRva2VuKGZsYWdzLnRva2VuKTsKICAgICAgICAgICAgdG9vbC5zZXRD\nb2RlRm9ybWF0KGZsYWdzLmZvcm1hdCk7CiAgICAgICAgICAgIGlmICh0b29s\nLnJ1bigpKSB7CiAgICAgICAgICAgICAgICBsb2cuaW5mbyhfbG9jLmdldCgi\nYXBwaWQtb3V0cHV0IiwgdG9vbC5nZXRGaWxlKCkpKTsKICAgICAgICAgICAg\nICAgIHRvb2wucmVjb3JkKCk7CiAgICAgICAgICAgIH0gZWxzZQogICAgICAg\nICAgICAgICAgbG9nLmluZm8oX2xvYy5nZXQoImFwcGlkLW5vcnVuIikpOwog\nICAgICAgIH0KICAgICAgICBiYy5nZXRQcm9qZWN0KCkuY2xlYXIoKTsKICAg\nICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvKioKICAgICAqIFNldCB0\naGUgb2JqZWN0IGlkIHR5cGUgb2YgdGhlIGdpdmVuIG1ldGFkYXRhLgogICAg\nICovCiAgICBwcml2YXRlIHN0YXRpYyB2b2lkIHNldE9iamVjdElkVHlwZShD\nbGFzc01ldGFEYXRhIG1ldGEsIEZsYWdzIGZsYWdzLAogICAgICAgIEJDQ2xh\nc3NMb2FkZXIgYmMpCiAgICAgICAgdGhyb3dzIENsYXNzTm90Rm91bmRFeGNl\ncHRpb24gewogICAgICAgIGlmIChtZXRhID09IG51bGwgfHwgKG1ldGEuZ2V0\nT2JqZWN0SWRUeXBlKCkgIT0gbnVsbAogICAgICAgICAgICAmJiAoIW1ldGEu\naXNPcGVuSlBBSWRlbnRpdHkoKSB8fCBmbGFncy5uYW1lID09IG51bGwpKQog\nICAgICAgICAgICB8fCBnZXREZWNsYXJlZFByaW1hcnlLZXlGaWVsZHMobWV0\nYSkubGVuZ3RoID09IDApCiAgICAgICAgICAgIHJldHVybjsKCiAgICAgICAg\nQ2xhc3MgZGVzYyA9IG1ldGEuZ2V0RGVzY3JpYmVkVHlwZSgpOwogICAgICAg\nIENsYXNzIGNscyA9IG51bGw7CiAgICAgICAgaWYgKGZsYWdzLm5hbWUgIT0g\nbnVsbCkKICAgICAgICAgICAgY2xzID0gbG9hZENsYXNzKGRlc2MsIGZsYWdz\nLm5hbWUsIGJjKTsKICAgICAgICBlbHNlIGlmIChmbGFncy5zdWZmaXggIT0g\nbnVsbCkKICAgICAgICAgICAgY2xzID0gbG9hZENsYXNzKGRlc2MsIGRlc2Mu\nZ2V0TmFtZSgpICsgZmxhZ3Muc3VmZml4LCBiYyk7CiAgICAgICAgbWV0YS5z\nZXRPYmplY3RJZFR5cGUoY2xzLCBmYWxzZSk7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBMb2FkIHRoZSBnaXZlbiBjbGFzcyBuYW1lIGV2ZW4gaWYgaXQgZG9l\ncyBub3QgZXhpc3QuCiAgICAgKi8KICAgIHByaXZhdGUgc3RhdGljIENsYXNz\nIGxvYWRDbGFzcyhDbGFzcyBjb250ZXh0LCBTdHJpbmcgbmFtZSwKICAgICAg\nICBCQ0NsYXNzTG9hZGVyIGJjKQogICAgICAgIHRocm93cyBDbGFzc05vdEZv\ndW5kRXhjZXB0aW9uIHsKICAgICAgICBpZiAobmFtZS5pbmRleE9mKCcuJykg\nPT0gLTEgJiYgY29udGV4dC5nZXROYW1lKCkuaW5kZXhPZignLicpICE9IC0x\nKQogICAgICAgICAgICBuYW1lID0gU3RyaW5ncy5nZXRQYWNrYWdlTmFtZShj\nb250ZXh0KSArICIuIiArIG5hbWU7CgogICAgICAgIC8vIGZpcnN0IHRyeSB3\naXRoIHJlZ3VsYXIgY2xhc3MgbG9hZGVyCiAgICAgICAgQ2xhc3NMb2FkZXIg\nbG9hZGVyID0gKENsYXNzTG9hZGVyKSBBY2Nlc3NDb250cm9sbGVyLmRvUHJp\ndmlsZWdlZCgKICAgICAgICAgICAgSjJEb1ByaXZIZWxwZXIuZ2V0Q2xhc3NM\nb2FkZXJBY3Rpb24oY29udGV4dCkpOyAKICAgICAgICBpZiAobG9hZGVyID09\nIG51bGwpCiAgICAgICAgICAgIGxvYWRlciA9IChDbGFzc0xvYWRlcikgQWNj\nZXNzQ29udHJvbGxlci5kb1ByaXZpbGVnZWQoCiAgICAgICAgICAgICAgICBK\nMkRvUHJpdkhlbHBlci5nZXRDb250ZXh0Q2xhc3NMb2FkZXJBY3Rpb24oKSk7\nIAogICAgICAgIHRyeSB7CiAgICAgICAgICAgIHJldHVybiBDbGFzcy5mb3JO\nYW1lKG5hbWUsIGZhbHNlLCBsb2FkZXIpOwogICAgICAgIH0gY2F0Y2ggKFRo\ncm93YWJsZSB0KSB7CiAgICAgICAgfQoKICAgICAgICAvLyBjcmVhdGUgY2xh\nc3MKICAgICAgICBCQ0NsYXNzIG9pZCA9IGJjLmdldFByb2plY3QoKS5sb2Fk\nQ2xhc3MobmFtZSwgbnVsbCk7CiAgICAgICAgb2lkLmFkZERlZmF1bHRDb25z\ndHJ1Y3RvcigpOwogICAgICAgIHJldHVybiBDbGFzcy5mb3JOYW1lKG5hbWUs\nIGZhbHNlLCBiYyk7CiAgICB9CgogICAgLyoqCiAgICAgKiBUZWxsIHRoZSBt\nZXRhZGF0YSBmYWN0b3J5IHRvIGxvYWQgb2JqZWN0IGlkIGNsYXNzZXMgZXZl\nbiBpZiB0aGV5IGRvbid0CiAgICAgKiBleGlzdC4KICAgICAqLwogICAgcHJp\ndmF0ZSBzdGF0aWMgdm9pZCBsb2FkT2JqZWN0SWRzKE1ldGFEYXRhUmVwb3Np\ndG9yeSByZXBvcywgYm9vbGVhbiBmYXRhbCkgewogICAgICAgIE1ldGFEYXRh\nRmFjdG9yeSBtZGYgPSByZXBvcy5nZXRNZXRhRGF0YUZhY3RvcnkoKTsKICAg\nICAgICBpZiAobWRmIGluc3RhbmNlb2YgRGVsZWdhdGluZ01ldGFEYXRhRmFj\ndG9yeSkKICAgICAgICAgICAgbWRmID0gKChEZWxlZ2F0aW5nTWV0YURhdGFG\nYWN0b3J5KSBtZGYpLmdldElubmVybW9zdERlbGVnYXRlKCk7CiAgICAgICAg\naWYgKG1kZiBpbnN0YW5jZW9mIE9iamVjdElkTG9hZGVyKQogICAgICAgICAg\nICAoKE9iamVjdElkTG9hZGVyKSBtZGYpLnNldExvYWRPYmplY3RJZHMoKTsK\nICAgICAgICBlbHNlIGlmIChmYXRhbCkKICAgICAgICAgICAgdGhyb3cgbmV3\nIEludmFsaWRTdGF0ZUV4Y2VwdGlvbihfbG9jLmdldCgiZmFjdG9yeS1ub3Qt\nb2lkbG9hZGVyIikpLgogICAgICAgICAgICAgICAgc2V0RmF0YWwodHJ1ZSk7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBSdW4gZmxhZ3MuCiAgICAgKi8KICAg\nIHB1YmxpYyBzdGF0aWMgY2xhc3MgRmxhZ3MgewoKICAgICAgICBwdWJsaWMg\nRmlsZSBkaXJlY3RvcnkgPSBudWxsOwogICAgICAgIHB1YmxpYyBib29sZWFu\nIGlnbm9yZUVycm9ycyA9IHRydWU7CiAgICAgICAgcHVibGljIFN0cmluZyB0\nb2tlbiA9IFRPS0VOX0RFRkFVTFQ7CiAgICAgICAgcHVibGljIENvZGVGb3Jt\nYXQgZm9ybWF0ID0gbnVsbDsKICAgICAgICBwdWJsaWMgU3RyaW5nIG5hbWUg\nPSBudWxsOwogICAgICAgIHB1YmxpYyBTdHJpbmcgc3VmZml4ID0gbnVsbDsK\nICAgIH0KCiAgICAvKioKICAgICAqIEludGVyZmFjZSBpbXBsZW1lbnRlZCBi\neSBtZXRhZGF0YSBmYWN0b3JpZXMgdGhhdCBjYW4gbG9hZCBub24tZXhpc3Rh\nbnQKICAgICAqIG9iamVjdCBpZCBjbGFzc2VzLgogICAgICovCiAgICBwdWJs\naWMgc3RhdGljIGludGVyZmFjZSBPYmplY3RJZExvYWRlcgoJewoJCS8qKgoJ\nCSAqIFR1cm4gb24gdGhlIGxvYWRpbmcgb2YgYWxsIGlkZW50aXR5IGNsYXNz\nZXMsIGV2ZW4gaWYgdGhleSBkb24ndCAKICAgICAgICAgKiBleGlzdC4KCSAJ\nICovCgkJcHVibGljIHZvaWQgc2V0TG9hZE9iamVjdElkcyAoKTsKCX0KfQo=\n","encoding":"base64"}

