{"sha":"648a6304258182ed3d77c85b53e009888e70d4ff","node_id":"MDQ6QmxvYjIwNjM2NDo2NDhhNjMwNDI1ODE4MmVkM2Q3N2M4NWI1M2UwMDk4ODhlNzBkNGZm","size":41598,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/648a6304258182ed3d77c85b53e009888e70d4ff","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuZW5oYW5jZTsKCmltcG9ydCBq\nYXZhLnV0aWwuQml0U2V0OwppbXBvcnQgamF2YS51dGlsLkNvbGxlY3Rpb247\nCmltcG9ydCBqYXZhLnV0aWwuSXRlcmF0b3I7CmltcG9ydCBqYXZhLnV0aWwu\nTGlua2VkTGlzdDsKaW1wb3J0IGphdmEudXRpbC5NYXA7CgppbXBvcnQgb3Jn\nLmFwYWNoZS5jb21tb25zLmxhbmcuU3RyaW5nVXRpbHM7CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEuY29uZi5PcGVuSlBBQ29uZmlndXJhdGlvbjsKaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuQWJzdHJhY3RQQ0RhdGE7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLkZldGNoQ29uZmln\ndXJhdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuT3Bl\nbkpQQVN0YXRlTWFuYWdlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5r\nZXJuZWwuUENEYXRhOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5l\nbC5TdG9yZUNvbnRleHQ7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGli\nLmxvZy5Mb2c7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwu\nTG9jYWxpemVyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51dGls\nLmNvbmN1cnJlbnQuQ29uY3VycmVudEhhc2hNYXA7CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEubWV0YS5DbGFzc01ldGFEYXRhOwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLm1ldGEuRmllbGRNZXRhRGF0YTsKaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS5tZXRhLkphdmFUeXBlczsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS51dGlsLkludGVybmFsRXhjZXB0aW9uOwppbXBvcnQgc2Vy\ncC5ieXRlY29kZS5CQ0NsYXNzOwppbXBvcnQgc2VycC5ieXRlY29kZS5CQ0Zp\nZWxkOwppbXBvcnQgc2VycC5ieXRlY29kZS5CQ01ldGhvZDsKaW1wb3J0IHNl\ncnAuYnl0ZWNvZGUuQ29kZTsKaW1wb3J0IHNlcnAuYnl0ZWNvZGUuQ29uc3Rh\nbnRzOwppbXBvcnQgc2VycC5ieXRlY29kZS5FeGNlcHRpb25IYW5kbGVyOwpp\nbXBvcnQgc2VycC5ieXRlY29kZS5JbnN0cnVjdGlvbjsKaW1wb3J0IHNlcnAu\nYnl0ZWNvZGUuSnVtcEluc3RydWN0aW9uOwppbXBvcnQgc2VycC5ieXRlY29k\nZS5Mb29rdXBTd2l0Y2hJbnN0cnVjdGlvbjsKCi8qKgogKiBHZW5lcmF0ZXMg\ne0BsaW5rIFBDRGF0YX0gaW5zdGFuY2VzIHdoaWNoIGF2b2lkIHByaW1pdHZl\nIHdyYXBwZXJzCiAqIHRvIG9wdGltaXplIG1lbW9yeSB1c2UgYW5kIHBlcmZv\ncm1hbmNlIGF0IHRoZSBjb3N0IG9mIHNsaWdodGx5IGhpZ2hlcgogKiBzdGFy\ndHVwIHRpbWUuCiAqCiAqIEBhdXRob3IgU3RldmUgS2ltCiAqIEBub2phdmFk\nb2MKICogQHNpbmNlIDAuMy4yCiAqLwpwdWJsaWMgY2xhc3MgUENEYXRhR2Vu\nZXJhdG9yCiAgICBleHRlbmRzIER5bmFtaWNTdG9yYWdlR2VuZXJhdG9yIHsK\nCiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBMb2NhbGl6ZXIgX2xvYyA9IExv\nY2FsaXplci5mb3JQYWNrYWdlCiAgICAgICAgKFBDRGF0YUdlbmVyYXRvci5j\nbGFzcyk7CgogICAgcHJvdGVjdGVkIHN0YXRpYyBmaW5hbCBTdHJpbmcgUE9T\nVEZJWCA9ICIkb3BlbmpwYXBjZGF0YSI7CgogICAgcHJpdmF0ZSBmaW5hbCBN\nYXAgX2dlbmVyYXRlZCA9IG5ldyBDb25jdXJyZW50SGFzaE1hcCgpOwogICAg\ncHJpdmF0ZSBmaW5hbCBPcGVuSlBBQ29uZmlndXJhdGlvbiBfY29uZjsKICAg\nIHByaXZhdGUgZmluYWwgTG9nIF9sb2c7CgogICAgcHVibGljIFBDRGF0YUdl\nbmVyYXRvcihPcGVuSlBBQ29uZmlndXJhdGlvbiBjb25mKSB7CiAgICAgICAg\nX2NvbmYgPSBjb25mOwogICAgICAgIF9sb2cgPSBfY29uZi5nZXRMb2dGYWN0\nb3J5KCkuZ2V0TG9nKE9wZW5KUEFDb25maWd1cmF0aW9uLkxPR19FTkhBTkNF\nKTsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgY29uZmlndXJh\ndGlvbi4KICAgICAqLwogICAgcHVibGljIE9wZW5KUEFDb25maWd1cmF0aW9u\nIGdldENvbmZpZ3VyYXRpb24oKSB7CiAgICAgICAgcmV0dXJuIF9jb25mOwog\nICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIGEge0BsaW5rIFBDRGF0YX0g\naW5zdGFuY2UgZm9yIHRoZSBnaXZlbiBvaWQgYW5kIG1ldGFkYXRhLgogICAg\nICovCiAgICBwdWJsaWMgUENEYXRhIGdlbmVyYXRlUENEYXRhKE9iamVjdCBv\naWQsIENsYXNzTWV0YURhdGEgbWV0YSkgewogICAgICAgIGlmIChtZXRhID09\nIG51bGwpCiAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgIENsYXNz\nIHR5cGUgPSBtZXRhLmdldERlc2NyaWJlZFR5cGUoKTsKICAgICAgICBEeW5h\nbWljU3RvcmFnZSBzdG9yYWdlID0gKER5bmFtaWNTdG9yYWdlKSBfZ2VuZXJh\ndGVkLmdldCh0eXBlKTsKICAgICAgICBpZiAoc3RvcmFnZSA9PSBudWxsKSB7\nCiAgICAgICAgICAgIHN0b3JhZ2UgPSBnZW5lcmF0ZVN0b3JhZ2UobWV0YSk7\nCiAgICAgICAgICAgIF9nZW5lcmF0ZWQucHV0KHR5cGUsIHN0b3JhZ2UpOwog\nICAgICAgICAgICBpZiAoX2xvZy5pc1RyYWNlRW5hYmxlZCgpKQogICAgICAg\nICAgICAgICAgX2xvZy50cmFjZShfbG9jLmdldCgicGNkYXRhLWNyZWF0ZWQi\nLCB0eXBlLmdldE5hbWUoKSwgbWV0YSkpOwogICAgICAgIH0KICAgICAgICBE\neW5hbWljUENEYXRhIGRhdGEgPSAoRHluYW1pY1BDRGF0YSkgc3RvcmFnZS5u\nZXdJbnN0YW5jZSgpOwogICAgICAgIGRhdGEuc2V0SWQob2lkKTsKICAgICAg\nICBkYXRhLnNldFN0b3JhZ2VHZW5lcmF0b3IodGhpcyk7CiAgICAgICAgZmlu\naXNoKGRhdGEsIG1ldGEpOwogICAgICAgIHJldHVybiBkYXRhOwogICAgfQoK\nICAgIC8qKgogICAgICogQWN0dWFsbHkgZ2VuZXJhdGUgdGhlIGZhY3Rvcnkg\naW5zdGFuY2UuCiAgICAgKi8KICAgIHByaXZhdGUgRHluYW1pY1N0b3JhZ2Ug\nZ2VuZXJhdGVTdG9yYWdlKENsYXNzTWV0YURhdGEgbWV0YSkgewogICAgICAg\nIGlmIChfbG9nLmlzVHJhY2VFbmFibGVkKCkpCiAgICAgICAgICAgIF9sb2cu\ndHJhY2UoX2xvYy5nZXQoInBjZGF0YS1nZW5lcmF0ZSIsIG1ldGEpKTsKCiAg\nICAgICAgRmllbGRNZXRhRGF0YVtdIGZpZWxkcyA9IG1ldGEuZ2V0RmllbGRz\nKCk7CiAgICAgICAgaW50W10gdHlwZXMgPSBuZXcgaW50W2ZpZWxkcy5sZW5n\ndGhdOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgdHlwZXMubGVuZ3Ro\nOyBpKyspCiAgICAgICAgICAgIHR5cGVzW2ldID0gcmVwbGFjZVR5cGUoZmll\nbGRzW2ldKTsKICAgICAgICByZXR1cm4gZ2VuZXJhdGVTdG9yYWdlKHR5cGVz\nLCBtZXRhKTsKICAgIH0KCiAgICAvKioKICAgICAqIFBlcmZvcm0gYW55IGZp\nbmFsIGFjdGlvbnMgYmVmb3JlIHRoZSBwY2RhdGEgaXMgcmV0dXJuZWQgdG8g\nY2xpZW50IGNvZGUuCiAgICAgKi8KICAgIHByb3RlY3RlZCB2b2lkIGZpbmlz\naChEeW5hbWljUENEYXRhIGRhdGEsIENsYXNzTWV0YURhdGEgbWV0YSkgewog\nICAgfQoKICAgIHByb3RlY3RlZCBpbnQgZ2V0Q3JlYXRlRmllbGRNZXRob2Rz\nKGludCB0eXBlQ29kZSkgewogICAgICAgIGlmICh0eXBlQ29kZSA+PSBKYXZh\nVHlwZXMuT0JKRUNUKQogICAgICAgICAgICByZXR1cm4gUE9MSUNZX1NJTEVO\nVDsKICAgICAgICAvLyBkb24ndCBib3RoZXIgY3JlYXRpbmcgc2V0L2dldDxQ\ncmltaXRpdmU+IG1ldGhvZHMKICAgICAgICByZXR1cm4gUE9MSUNZX0VNUFRZ\nOwogICAgfQoKICAgIHByb3RlY3RlZCB2b2lkIGRlY2xhcmVDbGFzc2VzKEJD\nQ2xhc3MgYmMpIHsKICAgICAgICBzdXBlci5kZWNsYXJlQ2xhc3NlcyhiYyk7\nCiAgICAgICAgYmMuZGVjbGFyZUludGVyZmFjZShEeW5hbWljUENEYXRhLmNs\nYXNzKTsKICAgICAgICBiYy5zZXRTdXBlcmNsYXNzKEFic3RyYWN0UENEYXRh\nLmNsYXNzKTsKICAgIH0KCiAgICBwcm90ZWN0ZWQgZmluYWwgU3RyaW5nIGdl\ndENsYXNzTmFtZShPYmplY3Qgb2JqKSB7CiAgICAgICAgcmV0dXJuIGdldFVu\naXF1ZU5hbWUoKChDbGFzc01ldGFEYXRhKSBvYmopLmdldERlc2NyaWJlZFR5\ncGUoKSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBDcmVhdGVzIGEgdW5pcXVl\nIG5hbWUgZm9yIHRoZSBnaXZlbiB0eXBlJ3MgcGNkYXRhIGltcGxlbWVudGF0\naW9uLgogICAgICovCiAgICBwcm90ZWN0ZWQgU3RyaW5nIGdldFVuaXF1ZU5h\nbWUoQ2xhc3MgdHlwZSkgewogICAgICAgIHJldHVybiB0eXBlLmdldE5hbWUo\nKSArICIkIiArIFN5c3RlbS5pZGVudGl0eUhhc2hDb2RlKHR5cGUpICsgUE9T\nVEZJWDsKICAgIH0KCiAgICBwcm90ZWN0ZWQgZmluYWwgdm9pZCBkZWNvcmF0\nZShPYmplY3Qgb2JqLCBCQ0NsYXNzIGJjLCBpbnRbXSB0eXBlcykgewogICAg\nICAgIHN1cGVyLmRlY29yYXRlKG9iaiwgYmMsIHR5cGVzKTsKICAgICAgICBD\nbGFzc01ldGFEYXRhIG1ldGEgPSAoQ2xhc3NNZXRhRGF0YSkgb2JqOwoKICAg\nICAgICBlbmhhbmNlQ29uc3RydWN0b3IoYmMpOwogICAgICAgIGFkZEJhc2VG\naWVsZHMoYmMpOwogICAgICAgIGFkZEltcGxEYXRhTWV0aG9kcyhiYywgbWV0\nYSk7CiAgICAgICAgYWRkRmllbGRJbXBsRGF0YU1ldGhvZHMoYmMsIG1ldGEp\nOwogICAgICAgIGFkZFZlcnNpb25NZXRob2RzKGJjKTsKICAgICAgICBhZGRH\nZXRUeXBlKGJjLCBtZXRhKTsKICAgICAgICBhZGRMb2FkTWV0aG9kKGJjLCBt\nZXRhKTsKICAgICAgICBhZGRMb2FkV2l0aEZpZWxkc01ldGhvZChiYywgbWV0\nYSk7CiAgICAgICAgYWRkU3RvcmVNZXRob2RzKGJjLCBtZXRhKTsKICAgICAg\nICBhZGROZXdFbWJlZGRlZChiYyk7CiAgICAgICAgYWRkR2V0RGF0YShiYyk7\nCiAgICAgICAgZGVjb3JhdGUoYmMsIG1ldGEpOwogICAgfQoKICAgIC8qKgog\nICAgICogQXBwbHkgYWRkaXRpb25hbCBkZWNvcmF0aW9uIHRvIGdlbmVyYXRl\nZCBjbGFzcy4KICAgICAqLwogICAgcHJvdGVjdGVkIHZvaWQgZGVjb3JhdGUo\nQkNDbGFzcyBiYywgQ2xhc3NNZXRhRGF0YSBtZXRhKSB7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBFbmhhbmNlIGNvbnN0cnVjdG9yIHRvIGluaXRpYWxpemUg\nZmllbGRzCiAgICAgKi8KICAgIHByaXZhdGUgdm9pZCBlbmhhbmNlQ29uc3Ry\ndWN0b3IoQkNDbGFzcyBiYykgewogICAgICAgIEJDTWV0aG9kIGNvbnMgPSBi\nYy5nZXREZWNsYXJlZE1ldGhvZCgiPGluaXQ+IiwgKFN0cmluZ1tdKSBudWxs\nKTsKICAgICAgICBDb2RlIGNvZGUgPSBjb25zLmdldENvZGUoZmFsc2UpOwog\nICAgICAgIGNvZGUuYWZ0ZXJMYXN0KCk7CiAgICAgICAgY29kZS5wcmV2aW91\ncygpOwoKICAgICAgICAvLyBwcml2YXRlIEJpdFNldCBsb2FkZWQgPSBuZXcg\nQml0U2V0KCk7CiAgICAgICAgQkNGaWVsZCBsb2FkZWQgPSBhZGRCZWFuRmll\nbGQoYmMsICJsb2FkZWQiLCBCaXRTZXQuY2xhc3MpOwogICAgICAgIGxvYWRl\nZC5zZXRGaW5hbCh0cnVlKTsKICAgICAgICBjb2RlLmFsb2FkKCkuc2V0VGhp\ncygpOwogICAgICAgIGNvZGUuYW5ldygpLnNldFR5cGUoQml0U2V0LmNsYXNz\nKTsKICAgICAgICBjb2RlLmR1cCgpOwogICAgICAgIGNvZGUuY29uc3RhbnQo\nKS5zZXRWYWx1ZShiYy5nZXRGaWVsZHMoKS5sZW5ndGgpOwogICAgICAgIGNv\nZGUuaW52b2tlc3BlY2lhbCgpLnNldE1ldGhvZChCaXRTZXQuY2xhc3MsICI8\naW5pdD4iLCB2b2lkLmNsYXNzLAogICAgICAgICAgICBuZXcgQ2xhc3NbXXsg\naW50LmNsYXNzIH0pOwogICAgICAgIGNvZGUucHV0ZmllbGQoKS5zZXRGaWVs\nZChsb2FkZWQpOwoKICAgICAgICBjb2RlLmNhbGN1bGF0ZU1heFN0YWNrKCk7\nCiAgICAgICAgY29kZS5jYWxjdWxhdGVNYXhMb2NhbHMoKTsKICAgIH0KCiAg\nICAvKioKICAgICAqIEhhdmUgdG8gbG9hZCB0aGUgdHlwZSBzaW5jZSBpdCBt\nYXkgbm90IGJlIGF2YWlsYWJsZSB0byB0aGUKICAgICAqIHNhbWUgY2xhc3Ns\nb2FkZXIgKGkuZS4gcmFyIHZzLiBlYXIpLiBUaGUgY29udGV4dCBjbGFzc2xv\nYWRlcgogICAgICogKGkuZS4gdGhlIHVzZXIgYXBwIGNsYXNzbG9hZGVyKSBz\naG91bGQgYmUgZmluZS4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIGFkZEdl\ndFR5cGUoQkNDbGFzcyBiYywgQ2xhc3NNZXRhRGF0YSBtZXRhKSB7CiAgICAg\nICAgQkNGaWVsZCB0eXBlID0gYmMuZGVjbGFyZUZpZWxkKCJ0eXBlIiwgQ2xh\nc3MuY2xhc3MpOwogICAgICAgIHR5cGUuc2V0U3RhdGljKHRydWUpOwogICAg\nICAgIHR5cGUubWFrZVByaXZhdGUoKTsKICAgICAgICAvLyBwdWJsaWMgQ2xh\nc3MgZ2V0VHlwZSgpIHsKICAgICAgICBCQ01ldGhvZCBnZXR0ZXIgPSBiYy5k\nZWNsYXJlTWV0aG9kKCJnZXRUeXBlIiwgQ2xhc3MuY2xhc3MsIG51bGwpOwog\nICAgICAgIGdldHRlci5tYWtlUHVibGljKCk7CiAgICAgICAgQ29kZSBjb2Rl\nID0gZ2V0dGVyLmdldENvZGUodHJ1ZSk7CiAgICAgICAgLy8gaWYgKHR5cGUg\nPT0gbnVsbCkgewogICAgICAgIC8vIAkJdHJ5IHsKICAgICAgICAvLyAJCQl0\neXBlID0gQ2xhc3MuZm9yTmFtZQogICAgICAgIC8vIAkJCQkobWV0YS5nZXRE\nZXNjcmliZWRUeXBlKCkuZ2V0TmFtZSgpLCB0cnVlLAogICAgICAgIC8vIAkJ\nCQlUaHJlYWQuY3VycmVudFRocmVhZCgpLmdldENvbnRleHRDbGFzc0xvYWRl\ncigpKTsKICAgICAgICAvLyAJCX0gY2F0Y2ggKENsYXNzTm90Rm91bmRFeGNl\ncHRpb24gY25mZSkgewogICAgICAgIC8vIAkJCXRocm93IG5ldyBJbnRlcm5h\nbEV4Y2VwdGlvbigpOwogICAgICAgIC8vIAkJfQogICAgICAgIC8vIH0KICAg\nICAgICBjb2RlLmdldHN0YXRpYygpLnNldEZpZWxkKHR5cGUpOwoKICAgICAg\nICBDb2xsZWN0aW9uIGp1bXBzID0gbmV3IExpbmtlZExpc3QoKTsKICAgICAg\nICBqdW1wcy5hZGQoY29kZS5pZm5vbm51bGwoKSk7CiAgICAgICAgRXhjZXB0\naW9uSGFuZGxlciBoYW5kbGVyID0gY29kZS5hZGRFeGNlcHRpb25IYW5kbGVy\nKCk7CgogICAgICAgIGhhbmRsZXIuc2V0VHJ5U3RhcnQoY29kZS5jb25zdGFu\ndCgpLnNldFZhbHVlCiAgICAgICAgICAgIChtZXRhLmdldERlc2NyaWJlZFR5\ncGUoKS5nZXROYW1lKCkpKTsKICAgICAgICBjb2RlLmNvbnN0YW50KCkuc2V0\nVmFsdWUodHJ1ZSk7CiAgICAgICAgY29kZS5pbnZva2VzdGF0aWMoKS5zZXRN\nZXRob2QoVGhyZWFkLmNsYXNzLCAiY3VycmVudFRocmVhZCIsCiAgICAgICAg\nICAgIFRocmVhZC5jbGFzcywgbnVsbCk7CiAgICAgICAgY29kZS5pbnZva2V2\naXJ0dWFsKCkuc2V0TWV0aG9kKFRocmVhZC5jbGFzcywgImdldENvbnRleHRD\nbGFzc0xvYWRlciIsCiAgICAgICAgICAgIENsYXNzTG9hZGVyLmNsYXNzLCBu\ndWxsKTsKICAgICAgICBjb2RlLmludm9rZXN0YXRpYygpLnNldE1ldGhvZChD\nbGFzcy5jbGFzcywgImZvck5hbWUiLCBDbGFzcy5jbGFzcywKICAgICAgICAg\nICAgbmV3IENsYXNzW117IFN0cmluZy5jbGFzcywgYm9vbGVhbi5jbGFzcywg\nQ2xhc3NMb2FkZXIuY2xhc3MgfSk7CiAgICAgICAgY29kZS5wdXRzdGF0aWMo\nKS5zZXRGaWVsZCh0eXBlKTsKICAgICAgICBJbnN0cnVjdGlvbiBnbzIgPSBj\nb2RlLmdvMigpOwogICAgICAgIGp1bXBzLmFkZChnbzIpOwogICAgICAgIGhh\nbmRsZXIuc2V0VHJ5RW5kKGdvMik7CiAgICAgICAgaGFuZGxlci5zZXRDYXRj\naChDbGFzc05vdEZvdW5kRXhjZXB0aW9uLmNsYXNzKTsKICAgICAgICBoYW5k\nbGVyLnNldEhhbmRsZXJTdGFydCh0aHJvd0V4Y2VwdGlvbgogICAgICAgICAg\nICAoY29kZSwgSW50ZXJuYWxFeGNlcHRpb24uY2xhc3MpKTsKICAgICAgICBz\nZXRUYXJnZXQoY29kZS5nZXRzdGF0aWMoKS5zZXRGaWVsZCh0eXBlKSwganVt\ncHMpOwogICAgICAgIGNvZGUuYXJldHVybigpOwoKICAgICAgICBjb2RlLmNh\nbGN1bGF0ZU1heFN0YWNrKCk7CiAgICAgICAgY29kZS5jYWxjdWxhdGVNYXhM\nb2NhbHMoKTsKICAgIH0KCiAgICAvKioKICAgICAqIERlY2xhcmUgc3RhbmRh\ncmQgZHluYW1pYyBwY2RhdGEgZmllbGRzLgogICAgICovCiAgICBwcml2YXRl\nIHZvaWQgYWRkQmFzZUZpZWxkcyhCQ0NsYXNzIGJjKSB7CiAgICAgICAgYWRk\nQmVhbkZpZWxkKGJjLCAiaWQiLCBPYmplY3QuY2xhc3MpOwogICAgICAgIEJD\nRmllbGQgZmllbGQgPSBhZGRCZWFuRmllbGQoYmMsICJzdG9yYWdlR2VuZXJh\ndG9yIiwKICAgICAgICAgICAgUENEYXRhR2VuZXJhdG9yLmNsYXNzKTsKICAg\nICAgICBmaWVsZC5zZXRBY2Nlc3NGbGFncyhmaWVsZC5nZXRBY2Nlc3NGbGFn\ncygpCiAgICAgICAgICAgIHwgQ29uc3RhbnRzLkFDQ0VTU19UUkFOU0lFTlQp\nOwogICAgfQoKICAgIC8qKgogICAgICogQWRkIG1ldGhvZHMgZm9yIGxvYWRp\nbmcgYW5kIHN0b3JpbmcgY2xhc3MtbGV2ZWwgaW1wbCBkYXRhLgogICAgICov\nCiAgICBwcml2YXRlIHZvaWQgYWRkSW1wbERhdGFNZXRob2RzKEJDQ2xhc3Mg\nYmMsIENsYXNzTWV0YURhdGEgbWV0YSkgewogICAgICAgIC8vIHZvaWQgc3Rv\ncmVJbXBsRGF0YShPcGVuSlBBU3RhdGVNYW5hZ2VyKTsKICAgICAgICBCQ01l\ndGhvZCBtZXRoID0gYmMuZGVjbGFyZU1ldGhvZCgic3RvcmVJbXBsRGF0YSIs\nIHZvaWQuY2xhc3MsCiAgICAgICAgICAgIG5ldyBDbGFzc1tdeyBPcGVuSlBB\nU3RhdGVNYW5hZ2VyLmNsYXNzIH0pOwogICAgICAgIENvZGUgY29kZSA9IG1l\ndGguZ2V0Q29kZSh0cnVlKTsKCiAgICAgICAgQkNGaWVsZCBpbXBsID0gbnVs\nbDsKICAgICAgICBpZiAoIXVzZXNJbXBsRGF0YShtZXRhKSkKICAgICAgICAg\nICAgY29kZS52cmV0dXJuKCk7CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAg\nIC8vIGlmIChzbS5pc0ltcGxEYXRhQ2FjaGVhYmxlKCkpCiAgICAgICAgICAg\nIC8vIAkJc2V0SW1wbERhdGEoc20uZ2V0SW1wbERhdGEoKSk7CiAgICAgICAg\nICAgIGltcGwgPSBhZGRCZWFuRmllbGQoYmMsICJpbXBsRGF0YSIsIE9iamVj\ndC5jbGFzcyk7CiAgICAgICAgICAgIGNvZGUuYWxvYWQoKS5zZXRQYXJhbSgw\nKTsKICAgICAgICAgICAgY29kZS5pbnZva2VpbnRlcmZhY2UoKS5zZXRNZXRo\nb2QoT3BlbkpQQVN0YXRlTWFuYWdlci5jbGFzcywKICAgICAgICAgICAgICAg\nICJpc0ltcGxEYXRhQ2FjaGVhYmxlIiwgYm9vbGVhbi5jbGFzcywgbnVsbCk7\nCiAgICAgICAgICAgIEp1bXBJbnN0cnVjdGlvbiBpZmlucyA9IGNvZGUuaWZl\ncSgpOwogICAgICAgICAgICBjb2RlLmFsb2FkKCkuc2V0VGhpcygpOwogICAg\nICAgICAgICBjb2RlLmFsb2FkKCkuc2V0UGFyYW0oMCk7CiAgICAgICAgICAg\nIGNvZGUuaW52b2tlaW50ZXJmYWNlKCkuc2V0TWV0aG9kKE9wZW5KUEFTdGF0\nZU1hbmFnZXIuY2xhc3MsCiAgICAgICAgICAgICAgICAiZ2V0SW1wbERhdGEi\nLCBPYmplY3QuY2xhc3MsIG51bGwpOwogICAgICAgICAgICBjb2RlLmludm9r\nZXZpcnR1YWwoKS5zZXRNZXRob2QoInNldEltcGxEYXRhIiwgdm9pZC5jbGFz\ncywKICAgICAgICAgICAgICAgIG5ldyBDbGFzc1tdeyBPYmplY3QuY2xhc3Mg\nfSk7CiAgICAgICAgICAgIGlmaW5zLnNldFRhcmdldChjb2RlLnZyZXR1cm4o\nKSk7CiAgICAgICAgfQogICAgICAgIGNvZGUuY2FsY3VsYXRlTWF4U3RhY2so\nKTsKICAgICAgICBjb2RlLmNhbGN1bGF0ZU1heExvY2FscygpOwoKICAgICAg\nICAvLyB2b2lkIGxvYWRJbXBsRGF0YShPcGVuSlBBU3RhdGVNYW5hZ2VyKTsK\nICAgICAgICBtZXRoID0gYmMuZGVjbGFyZU1ldGhvZCgibG9hZEltcGxEYXRh\nIiwgdm9pZC5jbGFzcywKICAgICAgICAgICAgbmV3IENsYXNzW117IE9wZW5K\nUEFTdGF0ZU1hbmFnZXIuY2xhc3MgfSk7CiAgICAgICAgY29kZSA9IG1ldGgu\nZ2V0Q29kZSh0cnVlKTsKICAgICAgICBpZiAoIXVzZXNJbXBsRGF0YShtZXRh\nKSkKICAgICAgICAgICAgY29kZS52cmV0dXJuKCk7CiAgICAgICAgZWxzZSB7\nCiAgICAgICAgICAgIC8vIGlmIChzbS5nZXRJbXBsRGF0YSgpID09IG51bGwg\nJiYgaW1wbERhdGEgIT0gbnVsbCkKICAgICAgICAgICAgLy8gCQlzbS5zZXRJ\nbXBsRGF0YShpbXBsLCB0cnVlKTsKICAgICAgICAgICAgY29kZS5hbG9hZCgp\nLnNldFBhcmFtKDApOwogICAgICAgICAgICBjb2RlLmludm9rZWludGVyZmFj\nZSgpLnNldE1ldGhvZChPcGVuSlBBU3RhdGVNYW5hZ2VyLmNsYXNzLAogICAg\nICAgICAgICAgICAgImdldEltcGxEYXRhIiwgT2JqZWN0LmNsYXNzLCBudWxs\nKTsKICAgICAgICAgICAgSnVtcEluc3RydWN0aW9uIGlmaW5zID0gY29kZS5p\nZm5vbm51bGwoKTsKICAgICAgICAgICAgY29kZS5hbG9hZCgpLnNldFRoaXMo\nKTsKICAgICAgICAgICAgY29kZS5nZXRmaWVsZCgpLnNldEZpZWxkKGltcGwp\nOwogICAgICAgICAgICBKdW1wSW5zdHJ1Y3Rpb24gaWZpbnMyID0gY29kZS5p\nZm51bGwoKTsKICAgICAgICAgICAgY29kZS5hbG9hZCgpLnNldFBhcmFtKDAp\nOwogICAgICAgICAgICBjb2RlLmFsb2FkKCkuc2V0VGhpcygpOwogICAgICAg\nICAgICBjb2RlLmdldGZpZWxkKCkuc2V0RmllbGQoaW1wbCk7CiAgICAgICAg\nICAgIGNvZGUuY29uc3RhbnQoKS5zZXRWYWx1ZSh0cnVlKTsKICAgICAgICAg\nICAgY29kZS5pbnZva2VpbnRlcmZhY2UoKS5zZXRNZXRob2QoT3BlbkpQQVN0\nYXRlTWFuYWdlci5jbGFzcywKICAgICAgICAgICAgICAgICJzZXRJbXBsRGF0\nYSIsIHZvaWQuY2xhc3MsCiAgICAgICAgICAgICAgICBuZXcgQ2xhc3NbXXsg\nT2JqZWN0LmNsYXNzLCBib29sZWFuLmNsYXNzIH0pOwogICAgICAgICAgICBJ\nbnN0cnVjdGlvbiBpbnMgPSBjb2RlLnZyZXR1cm4oKTsKICAgICAgICAgICAg\naWZpbnMuc2V0VGFyZ2V0KGlucyk7CiAgICAgICAgICAgIGlmaW5zMi5zZXRU\nYXJnZXQoaW5zKTsKICAgICAgICB9CiAgICAgICAgY29kZS5jYWxjdWxhdGVN\nYXhTdGFjaygpOwogICAgICAgIGNvZGUuY2FsY3VsYXRlTWF4TG9jYWxzKCk7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBBZGQgbWV0aG9kcyBmb3IgbG9hZGlu\nZyBhbmQgc3RvcmluZyBjbGFzcy1sZXZlbCBpbXBsIGRhdGEuCiAgICAgKi8K\nICAgIHByaXZhdGUgdm9pZCBhZGRGaWVsZEltcGxEYXRhTWV0aG9kcyhCQ0Ns\nYXNzIGJjLCBDbGFzc01ldGFEYXRhIG1ldGEpIHsKICAgICAgICAvLyBwdWJs\naWMgdm9pZCBsb2FkSW1wbERhdGEoT3BlbkpQQVN0YXRlTWFuYWdlciBzbSwg\naW50IGkpCiAgICAgICAgQkNNZXRob2QgbWV0aCA9IGJjLmRlY2xhcmVNZXRo\nb2QoImxvYWRJbXBsRGF0YSIsIHZvaWQuY2xhc3MsCiAgICAgICAgICAgIG5l\ndyBDbGFzc1tdeyBPcGVuSlBBU3RhdGVNYW5hZ2VyLmNsYXNzLCBpbnQuY2xh\nc3MgfSk7CiAgICAgICAgbWV0aC5tYWtlUHJpdmF0ZSgpOwogICAgICAgIENv\nZGUgY29kZSA9IG1ldGguZ2V0Q29kZSh0cnVlKTsKCiAgICAgICAgaW50IGNv\ndW50ID0gY291bnRJbXBsRGF0YUZpZWxkcyhtZXRhKTsKICAgICAgICBCQ0Zp\nZWxkIGltcGwgPSBudWxsOwogICAgICAgIGlmIChjb3VudCA9PSAwKQogICAg\nICAgICAgICBjb2RlLnZyZXR1cm4oKTsKICAgICAgICBlbHNlIHsKICAgICAg\nICAgICAgLy8gT2JqZWN0W10gZmllbGRJbXBsCiAgICAgICAgICAgIGltcGwg\nPSBiYy5kZWNsYXJlRmllbGQoImZpZWxkSW1wbCIsIE9iamVjdFtdLmNsYXNz\nKTsKICAgICAgICAgICAgaW1wbC5tYWtlUHJpdmF0ZSgpOwoKICAgICAgICAg\nICAgLy8gaWYgKGZpZWxkSW1wbCAhPSBudWxsKQogICAgICAgICAgICBjb2Rl\nLmFsb2FkKCkuc2V0VGhpcygpOwogICAgICAgICAgICBjb2RlLmdldGZpZWxk\nKCkuc2V0RmllbGQoaW1wbCk7CiAgICAgICAgICAgIEp1bXBJbnN0cnVjdGlv\nbiBpZmlucyA9IGNvZGUuaWZub25udWxsKCk7CiAgICAgICAgICAgIGNvZGUu\ndnJldHVybigpOwoKICAgICAgICAgICAgLy8gT2JqZWN0IG9iaiA9IG51bGw7\nCiAgICAgICAgICAgIGludCBvYmogPSBjb2RlLmdldE5leHRMb2NhbHNJbmRl\neCgpOwogICAgICAgICAgICBpZmlucy5zZXRUYXJnZXQoY29kZS5jb25zdGFu\ndCgpLnNldE51bGwoKSk7CiAgICAgICAgICAgIGNvZGUuYXN0b3JlKCkuc2V0\nTG9jYWwob2JqKTsKCiAgICAgICAgICAgIC8vIGVzdGFibGlzaCBzd2l0Y2gg\ndGFyZ2V0LCB0aGVuIG1vdmUgYmVmb3JlIGl0CiAgICAgICAgICAgIEluc3Ry\ndWN0aW9uIHRhcmdldCA9IGNvZGUuYWxvYWQoKS5zZXRMb2NhbChvYmopOwog\nICAgICAgICAgICBjb2RlLnByZXZpb3VzKCk7CgogICAgICAgICAgICAvLyBz\nd2l0Y2goaSkKICAgICAgICAgICAgY29kZS5pbG9hZCgpLnNldFBhcmFtKDEp\nOwogICAgICAgICAgICBMb29rdXBTd2l0Y2hJbnN0cnVjdGlvbiBsc3dpdGNo\nID0gY29kZS5sb29rdXBzd2l0Y2goKTsKICAgICAgICAgICAgRmllbGRNZXRh\nRGF0YVtdIGZpZWxkcyA9IG1ldGEuZ2V0RmllbGRzKCk7CiAgICAgICAgICAg\nIGludCBjYWNoZWFibGUgPSAwOwogICAgICAgICAgICBmb3IgKGludCBpID0g\nMDsgaSA8IGZpZWxkcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAg\naWYgKCF1c2VzSW1wbERhdGEoZmllbGRzW2ldKSkKICAgICAgICAgICAgICAg\nICAgICBjb250aW51ZTsKICAgICAgICAgICAgICAgIC8vIGNhc2UgeDogb2Jq\nID0gZmllbGRJbXBsW3ldOyBicmVhazsKICAgICAgICAgICAgICAgIGxzd2l0\nY2guYWRkQ2FzZShpLCBjb2RlLmFsb2FkKCkuc2V0VGhpcygpKTsKICAgICAg\nICAgICAgICAgIGNvZGUuZ2V0ZmllbGQoKS5zZXRGaWVsZChpbXBsKTsKICAg\nICAgICAgICAgICAgIGNvZGUuY29uc3RhbnQoKS5zZXRWYWx1ZShjYWNoZWFi\nbGUrKyk7CiAgICAgICAgICAgICAgICBjb2RlLmFhbG9hZCgpOwogICAgICAg\nICAgICAgICAgY29kZS5hc3RvcmUoKS5zZXRMb2NhbChvYmopOwogICAgICAg\nICAgICAgICAgY29kZS5nbzIoKS5zZXRUYXJnZXQodGFyZ2V0KTsKICAgICAg\nICAgICAgfQogICAgICAgICAgICBsc3dpdGNoLnNldERlZmF1bHRUYXJnZXQo\ndGFyZ2V0KTsKCiAgICAgICAgICAgIC8vIGlmIChvYmogIT0gbnVsbCkKICAg\nICAgICAgICAgY29kZS5uZXh0KCk7ICAgIC8vIGp1bXAgYmFjayBvdmVyIHRh\ncmdldAogICAgICAgICAgICBpZmlucyA9IGNvZGUuaWZub25udWxsKCk7CiAg\nICAgICAgICAgIGNvZGUudnJldHVybigpOwoKICAgICAgICAgICAgLy8gc20u\nc2V0SW1wbERhdGEoaW5kZXgsIGltcGwpOwogICAgICAgICAgICBpZmlucy5z\nZXRUYXJnZXQoY29kZS5hbG9hZCgpLnNldFBhcmFtKDApKTsKICAgICAgICAg\nICAgY29kZS5pbG9hZCgpLnNldFBhcmFtKDEpOwogICAgICAgICAgICBjb2Rl\nLmFsb2FkKCkuc2V0TG9jYWwob2JqKTsKICAgICAgICAgICAgY29kZS5pbnZv\na2VpbnRlcmZhY2UoKS5zZXRNZXRob2QoT3BlbkpQQVN0YXRlTWFuYWdlci5j\nbGFzcywKICAgICAgICAgICAgICAgICJzZXRJbXBsRGF0YSIsIHZvaWQuY2xh\nc3MsCiAgICAgICAgICAgICAgICBuZXcgQ2xhc3NbXXsgaW50LmNsYXNzLCBP\nYmplY3QuY2xhc3MgfSk7CiAgICAgICAgICAgIGNvZGUudnJldHVybigpOwog\nICAgICAgIH0KICAgICAgICBjb2RlLmNhbGN1bGF0ZU1heExvY2FscygpOwog\nICAgICAgIGNvZGUuY2FsY3VsYXRlTWF4U3RhY2soKTsKCiAgICAgICAgLy8g\ndm9pZCBzdG9yZUltcGxEYXRhKE9wZW5KUEFTdGF0ZU1hbmFnZXIgc20sIGlu\ndCBpbmRleCwgYm9vbGVhbiBsb2FkZWQpCiAgICAgICAgbWV0aCA9IGJjLmRl\nY2xhcmVNZXRob2QoInN0b3JlSW1wbERhdGEiLCB2b2lkLmNsYXNzLAogICAg\nICAgICAgICBuZXcgQ2xhc3NbXXsgT3BlbkpQQVN0YXRlTWFuYWdlci5jbGFz\ncywgaW50LmNsYXNzLCBib29sZWFuLmNsYXNzIH0pOwogICAgICAgIGNvZGUg\nPSBtZXRoLmdldENvZGUodHJ1ZSk7CiAgICAgICAgaWYgKGNvdW50ID09IDAp\nCiAgICAgICAgICAgIGNvZGUudnJldHVybigpOwogICAgICAgIGVsc2Ugewog\nICAgICAgICAgICAvLyBpbnQgYXJySWR4ID0gLTE7CiAgICAgICAgICAgIC8v\nIHN3aXRjaChpbmRleCkKICAgICAgICAgICAgaW50IGFycklkeCA9IGNvZGUu\nZ2V0TmV4dExvY2Fsc0luZGV4KCk7CiAgICAgICAgICAgIGNvZGUuY29uc3Rh\nbnQoKS5zZXRWYWx1ZSgtMSk7CiAgICAgICAgICAgIGNvZGUuaXN0b3JlKCku\nc2V0TG9jYWwoYXJySWR4KTsKICAgICAgICAgICAgY29kZS5pbG9hZCgpLnNl\ndFBhcmFtKDEpOwogICAgICAgICAgICBMb29rdXBTd2l0Y2hJbnN0cnVjdGlv\nbiBsc3dpdGNoID0gY29kZS5sb29rdXBzd2l0Y2goKTsKCiAgICAgICAgICAg\nIC8vIGVzdGFibGlzaCBzd2l0Y2ggdGFyZ2V0LCB0aGVuIG1vdmUgYmVmb3Jl\nIGl0CiAgICAgICAgICAgIEluc3RydWN0aW9uIHN3aXRjaFRhcmdldCA9IGNv\nZGUuaWxvYWQoKS5zZXRMb2NhbChhcnJJZHgpOwogICAgICAgICAgICBjb2Rl\nLnByZXZpb3VzKCk7CgogICAgICAgICAgICBGaWVsZE1ldGFEYXRhW10gZmll\nbGRzID0gbWV0YS5nZXRGaWVsZHMoKTsKICAgICAgICAgICAgaW50IGNhY2hl\nYWJsZSA9IDA7CiAgICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgZmll\nbGRzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgICBpZiAoIXVzZXNJ\nbXBsRGF0YShmaWVsZHNbaV0pKQogICAgICAgICAgICAgICAgICAgIGNvbnRp\nbnVlOwogICAgICAgICAgICAgICAgLy8gY2FzZSB4OiBhcnJJZHggPSB5OyBi\ncmVhazsKICAgICAgICAgICAgICAgIGxzd2l0Y2guYWRkQ2FzZShpLCBjb2Rl\nLmNvbnN0YW50KCkuc2V0VmFsdWUoY2FjaGVhYmxlKyspKTsKICAgICAgICAg\nICAgICAgIGNvZGUuaXN0b3JlKCkuc2V0TG9jYWwoYXJySWR4KTsKICAgICAg\nICAgICAgICAgIGNvZGUuZ28yKCkuc2V0VGFyZ2V0KHN3aXRjaFRhcmdldCk7\nCiAgICAgICAgICAgIH0KICAgICAgICAgICAgbHN3aXRjaC5zZXREZWZhdWx0\nVGFyZ2V0KHN3aXRjaFRhcmdldCk7CiAgICAgICAgICAgIGNvZGUubmV4dCgp\nOyAgICAvLyBzdGVwIG92ZXIgc3dpdGNoIHRhcmdldAoKICAgICAgICAgICAg\nLy8gaWYgKGFycklkeCAhPSAtMSkKICAgICAgICAgICAgY29kZS5jb25zdGFu\ndCgpLnNldFZhbHVlKC0xKTsKICAgICAgICAgICAgSnVtcEluc3RydWN0aW9u\nIGlmaW5zID0gY29kZS5pZmljbXBuZSgpOwogICAgICAgICAgICBjb2RlLnZy\nZXR1cm4oKTsKCiAgICAgICAgICAgIC8vIGNyZWF0ZSBudWxsIHRhcmdldCwg\ndGhlbiBtb3ZlIGJlZm9yZSBpdAogICAgICAgICAgICBJbnN0cnVjdGlvbiBu\ndWxsVGFyZ2V0ID0gY29kZS5hbG9hZCgpLnNldFRoaXMoKTsKICAgICAgICAg\nICAgY29kZS5wcmV2aW91cygpOwoKICAgICAgICAgICAgLy8gaWYgKGxvYWRl\nZCkKICAgICAgICAgICAgaWZpbnMuc2V0VGFyZ2V0KGNvZGUuaWxvYWQoKS5z\nZXRQYXJhbSgyKSk7CiAgICAgICAgICAgIGNvZGUuaWZlcSgpLnNldFRhcmdl\ndChudWxsVGFyZ2V0KTsKCiAgICAgICAgICAgIC8vIE9iamVjdCBvYmogPSBz\nbS5nZXRJbXBsRGF0YShpbmRleCkKICAgICAgICAgICAgaW50IG9iaiA9IGNv\nZGUuZ2V0TmV4dExvY2Fsc0luZGV4KCk7CiAgICAgICAgICAgIGNvZGUuYWxv\nYWQoKS5zZXRQYXJhbSgwKTsKICAgICAgICAgICAgY29kZS5pbG9hZCgpLnNl\ndFBhcmFtKDEpOwogICAgICAgICAgICBjb2RlLmludm9rZWludGVyZmFjZSgp\nLnNldE1ldGhvZChPcGVuSlBBU3RhdGVNYW5hZ2VyLmNsYXNzLAogICAgICAg\nICAgICAgICAgImdldEltcGxEYXRhIiwgT2JqZWN0LmNsYXNzLCBuZXcgQ2xh\nc3NbXXsgaW50LmNsYXNzIH0pOwogICAgICAgICAgICBjb2RlLmFzdG9yZSgp\nLnNldExvY2FsKG9iaik7CgogICAgICAgICAgICAvLyBpZiAob2JqICE9IG51\nbGwpCiAgICAgICAgICAgIGNvZGUuYWxvYWQoKS5zZXRMb2NhbChvYmopOwog\nICAgICAgICAgICBjb2RlLmlmbnVsbCgpLnNldFRhcmdldChudWxsVGFyZ2V0\nKTsKCiAgICAgICAgICAgIC8vIGlmIChmaWVsZEltcGwgPT0gbnVsbCkKICAg\nICAgICAgICAgLy8gCQlmaWVsZEltcGwgPSBuZXcgT2JqZWN0W2ZpZWxkc107\nCiAgICAgICAgICAgIGNvZGUuYWxvYWQoKS5zZXRUaGlzKCk7CiAgICAgICAg\nICAgIGNvZGUuZ2V0ZmllbGQoKS5zZXRGaWVsZChpbXBsKTsKICAgICAgICAg\nICAgaWZpbnMgPSBjb2RlLmlmbm9ubnVsbCgpOwogICAgICAgICAgICBjb2Rl\nLmFsb2FkKCkuc2V0VGhpcygpOwogICAgICAgICAgICBjb2RlLmNvbnN0YW50\nKCkuc2V0VmFsdWUoY291bnQpOwogICAgICAgICAgICBjb2RlLmFuZXdhcnJh\neSgpLnNldFR5cGUoT2JqZWN0LmNsYXNzKTsKICAgICAgICAgICAgY29kZS5w\ndXRmaWVsZCgpLnNldEZpZWxkKGltcGwpOwoKICAgICAgICAgICAgLy8gZmll\nbGRJbXBsW2FycklkeF0gPSBvYmo7CiAgICAgICAgICAgIC8vIHJldHVybjsK\nICAgICAgICAgICAgaWZpbnMuc2V0VGFyZ2V0KGNvZGUuYWxvYWQoKS5zZXRU\naGlzKCkpOwogICAgICAgICAgICBjb2RlLmdldGZpZWxkKCkuc2V0RmllbGQo\naW1wbCk7CiAgICAgICAgICAgIGNvZGUuaWxvYWQoKS5zZXRMb2NhbChhcnJJ\nZHgpOwogICAgICAgICAgICBjb2RlLmFsb2FkKCkuc2V0TG9jYWwob2JqKTsK\nICAgICAgICAgICAgY29kZS5hYXN0b3JlKCk7CiAgICAgICAgICAgIGNvZGUu\ndnJldHVybigpOwoKICAgICAgICAgICAgLy8gaWYgKGZpZWxkSW1wbCAhPSBu\ndWxsKQogICAgICAgICAgICAvLyAJCWZpZWxkSW1wbFtpbmRleF0gPSBudWxs\nOwogICAgICAgICAgICBjb2RlLm5leHQoKTsgLy8gc3RlcCBvdmVyIG51bGxU\nYXJnZXQKICAgICAgICAgICAgY29kZS5nZXRmaWVsZCgpLnNldEZpZWxkKGlt\ncGwpOwogICAgICAgICAgICBpZmlucyA9IGNvZGUuaWZub25udWxsKCk7CiAg\nICAgICAgICAgIGNvZGUudnJldHVybigpOwogICAgICAgICAgICBpZmlucy5z\nZXRUYXJnZXQoY29kZS5hbG9hZCgpLnNldFRoaXMoKSk7CiAgICAgICAgICAg\nIGNvZGUuZ2V0ZmllbGQoKS5zZXRGaWVsZChpbXBsKTsKICAgICAgICAgICAg\nY29kZS5pbG9hZCgpLnNldExvY2FsKGFycklkeCk7CiAgICAgICAgICAgIGNv\nZGUuY29uc3RhbnQoKS5zZXROdWxsKCk7CiAgICAgICAgICAgIGNvZGUuYWFz\ndG9yZSgpOwogICAgICAgICAgICBjb2RlLnZyZXR1cm4oKTsKICAgICAgICB9\nCiAgICAgICAgY29kZS5jYWxjdWxhdGVNYXhTdGFjaygpOwogICAgICAgIGNv\nZGUuY2FsY3VsYXRlTWF4TG9jYWxzKCk7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBBZGQgbWV0aG9kcyBmb3IgbG9hZGluZyBhbmQgc3RvcmluZyB2ZXJzaW9u\nIGRhdGEuCiAgICAgKi8KICAgIHByb3RlY3RlZCB2b2lkIGFkZFZlcnNpb25N\nZXRob2RzKEJDQ2xhc3MgYmMpIHsKICAgICAgICAvLyB2b2lkIHN0b3JlVmVy\nc2lvbihPcGVuSlBBU3RhdGVNYW5hZ2VyIHNtKTsKICAgICAgICBhZGRCZWFu\nRmllbGQoYmMsICJ2ZXJzaW9uIiwgT2JqZWN0LmNsYXNzKTsKICAgICAgICBC\nQ01ldGhvZCBtZXRoID0gYmMuZGVjbGFyZU1ldGhvZCgic3RvcmVWZXJzaW9u\nIiwgdm9pZC5jbGFzcywKICAgICAgICAgICAgbmV3IENsYXNzW117IE9wZW5K\nUEFTdGF0ZU1hbmFnZXIuY2xhc3MgfSk7CiAgICAgICAgQ29kZSBjb2RlID0g\nbWV0aC5nZXRDb2RlKHRydWUpOwoKICAgICAgICAvLyB2ZXJzaW9uID0gc20u\nZ2V0VmVyc2lvbigpOwogICAgICAgIGNvZGUuYWxvYWQoKS5zZXRUaGlzKCk7\nCiAgICAgICAgY29kZS5hbG9hZCgpLnNldFBhcmFtKDApOwogICAgICAgIGNv\nZGUuaW52b2tlaW50ZXJmYWNlKCkKICAgICAgICAgICAgLnNldE1ldGhvZChP\ncGVuSlBBU3RhdGVNYW5hZ2VyLmNsYXNzLCAiZ2V0VmVyc2lvbiIsCiAgICAg\nICAgICAgICAgICBPYmplY3QuY2xhc3MsIG51bGwpOwogICAgICAgIGNvZGUu\ncHV0ZmllbGQoKS5zZXRGaWVsZCgidmVyc2lvbiIsIE9iamVjdC5jbGFzcyk7\nCiAgICAgICAgY29kZS52cmV0dXJuKCk7CiAgICAgICAgY29kZS5jYWxjdWxh\ndGVNYXhTdGFjaygpOwogICAgICAgIGNvZGUuY2FsY3VsYXRlTWF4TG9jYWxz\nKCk7CgogICAgICAgIC8vIHZvaWQgbG9hZFZlcnNpb24oT3BlbkpQQVN0YXRl\nTWFuYWdlciBzbSkKICAgICAgICBtZXRoID0gYmMuZGVjbGFyZU1ldGhvZCgi\nbG9hZFZlcnNpb24iLCB2b2lkLmNsYXNzLAogICAgICAgICAgICBuZXcgQ2xh\nc3NbXXsgT3BlbkpQQVN0YXRlTWFuYWdlci5jbGFzcyB9KTsKICAgICAgICBj\nb2RlID0gbWV0aC5nZXRDb2RlKHRydWUpOwoKICAgICAgICAvLyBpZiAoc20u\nZ2V0VmVyc2lvbigpID09IG51bGwpCiAgICAgICAgLy8gCQlzbS5zZXRWZXJz\naW9uKHZlcnNpb24pOwogICAgICAgIGNvZGUuYWxvYWQoKS5zZXRQYXJhbSgw\nKTsKICAgICAgICBjb2RlLmludm9rZWludGVyZmFjZSgpLnNldE1ldGhvZChP\ncGVuSlBBU3RhdGVNYW5hZ2VyLmNsYXNzLAogICAgICAgICAgICAiZ2V0VmVy\nc2lvbiIsIE9iamVjdC5jbGFzcywgbnVsbCk7CiAgICAgICAgSnVtcEluc3Ry\ndWN0aW9uIGlmaW5zID0gY29kZS5pZm5vbm51bGwoKTsKICAgICAgICBjb2Rl\nLmFsb2FkKCkuc2V0UGFyYW0oMCk7CiAgICAgICAgY29kZS5hbG9hZCgpLnNl\ndFRoaXMoKTsKICAgICAgICBjb2RlLmdldGZpZWxkKCkuc2V0RmllbGQoInZl\ncnNpb24iLCBPYmplY3QuY2xhc3MpOwogICAgICAgIGNvZGUuaW52b2tlaW50\nZXJmYWNlKCkKICAgICAgICAgICAgLnNldE1ldGhvZChPcGVuSlBBU3RhdGVN\nYW5hZ2VyLmNsYXNzLCAic2V0VmVyc2lvbiIsCiAgICAgICAgICAgICAgICB2\nb2lkLmNsYXNzLCBuZXcgQ2xhc3NbXXsgT2JqZWN0LmNsYXNzIH0pOwogICAg\nICAgIGlmaW5zLnNldFRhcmdldChjb2RlLnZyZXR1cm4oKSk7CiAgICAgICAg\nY29kZS5jYWxjdWxhdGVNYXhTdGFjaygpOwogICAgICAgIGNvZGUuY2FsY3Vs\nYXRlTWF4TG9jYWxzKCk7CiAgICB9CgogICAgcHJpdmF0ZSB2b2lkIGFkZExv\nYWRNZXRob2QoQkNDbGFzcyBiYywgQ2xhc3NNZXRhRGF0YSBtZXRhKSB7CiAg\nICAgICAgLy8gcHVibGljIHZvaWQgbG9hZChPcGVuSlBBU3RhdGVNYW5hZ2Vy\nIHNtLCBGZXRjaENvbmZpZ3VyYXRpb24gZmV0Y2gsCiAgICAgICAgLy8gCQlP\nYmplY3QgY29udGV4dCkKICAgICAgICBDb2RlIGNvZGUgPSBhZGRMb2FkTWV0\naG9kKGJjLCBmYWxzZSk7CiAgICAgICAgRmllbGRNZXRhRGF0YVtdIGZtZHMg\nPSBtZXRhLmdldEZpZWxkcygpOwogICAgICAgIENvbGxlY3Rpb24ganVtcHMg\nPSBuZXcgTGlua2VkTGlzdCgpOwogICAgICAgIENvbGxlY3Rpb24ganVtcHMy\nOwoJCQogICAgICAgIGludCBsb2NhbCA9IGNvZGUuZ2V0TmV4dExvY2Fsc0lu\nZGV4KCk7CiAgICAgICAgY29kZS5jb25zdGFudCgpLnNldE51bGwoKTsKICAg\nICAgICBjb2RlLmFzdG9yZSgpLnNldExvY2FsKGxvY2FsKTsKICAgICAgICBp\nbnQgaW50ZXIgPSBjb2RlLmdldE5leHRMb2NhbHNJbmRleCgpOwogICAgICAg\nIGNvZGUuY29uc3RhbnQoKS5zZXROdWxsKCk7CiAgICAgICAgY29kZS5hc3Rv\ncmUoKS5zZXRMb2NhbChpbnRlcik7CgogICAgICAgIGludCBvYmplY3RDb3Vu\ndCA9IDA7CiAgICAgICAgYm9vbGVhbiBpbnRlcm1lZGlhdGU7CiAgICAgICAg\nZm9yIChpbnQgaSA9IDA7IGkgPCBmbWRzLmxlbmd0aDsgaSsrKSB7CiAgICAg\nICAgICAgIGp1bXBzMiA9IG5ldyBMaW5rZWRMaXN0KCk7CiAgICAgICAgICAg\nIGludGVybWVkaWF0ZSA9IHVzZXNJbnRlcm1lZGlhdGUoZm1kc1tpXSk7CiAg\nICAgICAgICAgIHNldFRhcmdldChjb2RlLmFsb2FkKCkuc2V0VGhpcygpLCBq\ndW1wcyk7CiAgICAgICAgICAgIC8vIGlmIChsb2FkZWQuZ2V0KGkpKSBvciAo\nIWxvYWRlZC5nZXQoaSkpIGRlcGVuZGluZyBvbiBpbnRlciByZXNwCiAgICAg\nICAgICAgIGNvZGUuZ2V0ZmllbGQoKS5zZXRGaWVsZCgibG9hZGVkIiwgQml0\nU2V0LmNsYXNzKTsKICAgICAgICAgICAgY29kZS5jb25zdGFudCgpLnNldFZh\nbHVlKGkpOwogICAgICAgICAgICBjb2RlLmludm9rZXZpcnR1YWwoKS5zZXRN\nZXRob2QoQml0U2V0LmNsYXNzLCAiZ2V0IiwKICAgICAgICAgICAgICAgIGJv\nb2xlYW4uY2xhc3MsIG5ldyBDbGFzc1tdeyBpbnQuY2xhc3MgfSk7CiAgICAg\nICAgICAgIGp1bXBzLmFkZChjb2RlLmlmbmUoKSk7CgogICAgICAgICAgICBp\nZiAoaW50ZXJtZWRpYXRlKQogICAgICAgICAgICAgICAgYWRkTG9hZEludGVy\nbWVkaWF0ZShjb2RlLCBpLCBvYmplY3RDb3VudCwganVtcHMyLCBpbnRlcik7\nCiAgICAgICAgICAgIGp1bXBzMi5hZGQoY29kZS5nbzIoKSk7CgogICAgICAg\nICAgICAvLyBpZiAoZmV0Y2gucmVxdWlyZXNGZXRjaChmbWRzW2ldKSE9RmV0\nY2hDb25maWd1cmF0aW9uLkZFVENIX05PTkUpCiAgICAgICAgICAgIHNldFRh\ncmdldChjb2RlLmFsb2FkKCkuc2V0UGFyYW0oMSksIGp1bXBzKTsKICAgICAg\nICAgICAgY29kZS5hbG9hZCgpLnNldFBhcmFtKDApOwogICAgICAgICAgICBj\nb2RlLmludm9rZWludGVyZmFjZSgpLnNldE1ldGhvZChPcGVuSlBBU3RhdGVN\nYW5hZ2VyLmNsYXNzLAogICAgICAgICAgICAgICAgImdldE1ldGFEYXRhIiwg\nQ2xhc3NNZXRhRGF0YS5jbGFzcywgbnVsbCk7CiAgICAgICAgICAgIGNvZGUu\nY29uc3RhbnQoKS5zZXRWYWx1ZShmbWRzW2ldLmdldEluZGV4KCkpOwogICAg\nICAgICAgICBjb2RlLmludm9rZXZpcnR1YWwoKS5zZXRNZXRob2QoQ2xhc3NN\nZXRhRGF0YS5jbGFzcywKICAgICAgICAgICAgICAgICJnZXRGaWVsZCIsIEZp\nZWxkTWV0YURhdGEuY2xhc3MsIG5ldyBDbGFzc1tde2ludC5jbGFzc30pOwog\nICAgICAgICAgICBjb2RlLmludm9rZWludGVyZmFjZSgpLnNldE1ldGhvZCAo\nRmV0Y2hDb25maWd1cmF0aW9uLmNsYXNzLCAKICAgICAgICAgICAgICAgICJy\nZXF1aXJlc0ZldGNoIiwgaW50LmNsYXNzLCBuZXcgQ2xhc3NbXXtGaWVsZE1l\ndGFEYXRhLmNsYXNzfSk7CiAgICAgICAgICAgIGNvZGUuY29uc3RhbnQoKS5z\nZXRWYWx1ZShGZXRjaENvbmZpZ3VyYXRpb24uRkVUQ0hfTk9ORSk7CiAgICAg\nICAgICAgIGp1bXBzMi5hZGQoY29kZS5pZmljbXBlcSgpKTsKICAgICAgICAg\nICAgYWRkTG9hZChiYywgY29kZSwgZm1kc1tpXSwgb2JqZWN0Q291bnQsIGxv\nY2FsLCBmYWxzZSk7CgogICAgICAgICAgICBqdW1wcyA9IGp1bXBzMjsKICAg\nICAgICAgICAgaWYgKHJlcGxhY2VUeXBlKGZtZHNbaV0pID49IEphdmFUeXBl\ncy5PQkpFQ1QpCiAgICAgICAgICAgICAgICBvYmplY3RDb3VudCsrOwogICAg\nICAgIH0KICAgICAgICBzZXRUYXJnZXQoY29kZS52cmV0dXJuKCksIGp1bXBz\nKTsKICAgICAgICBjb2RlLmNhbGN1bGF0ZU1heFN0YWNrKCk7CiAgICAgICAg\nY29kZS5jYWxjdWxhdGVNYXhMb2NhbHMoKTsKICAgIH0KCiAgICBwcml2YXRl\nIHZvaWQgYWRkTG9hZFdpdGhGaWVsZHNNZXRob2QoQkNDbGFzcyBiYywgQ2xh\nc3NNZXRhRGF0YSBtZXRhKSB7CiAgICAgICAgQ29kZSBjb2RlID0gYWRkTG9h\nZE1ldGhvZChiYywgdHJ1ZSk7CiAgICAgICAgLy8gcHVibGljIHZvaWQgbG9h\nZChPcGVuSlBBU3RhdGVNYW5hZ2VyIHNtLCBCaXRTZXQgZmllbGRzLAogICAg\nICAgIC8vIAkJRmV0Y2hDb25maWd1cmF0aW9uIGZldGNoLCBPYmplY3QgY29u\nbikKICAgICAgICBGaWVsZE1ldGFEYXRhW10gZm1kcyA9IG1ldGEuZ2V0Rmll\nbGRzKCk7CiAgICAgICAgQ29sbGVjdGlvbiBqdW1wcyA9IG5ldyBMaW5rZWRM\naXN0KCk7CiAgICAgICAgQ29sbGVjdGlvbiBqdW1wczI7CiAgICAgICAgaW50\nIG9iamVjdENvdW50ID0gMDsKICAgICAgICBib29sZWFuIGludGVybWVkaWF0\nZTsKICAgICAgICBpbnQgbG9jYWwgPSBjb2RlLmdldE5leHRMb2NhbHNJbmRl\neCgpOwogICAgICAgIGNvZGUuY29uc3RhbnQoKS5zZXROdWxsKCk7CiAgICAg\nICAgY29kZS5hc3RvcmUoKS5zZXRMb2NhbChsb2NhbCk7CiAgICAgICAgaW50\nIGludGVyID0gY29kZS5nZXROZXh0TG9jYWxzSW5kZXgoKTsKICAgICAgICBj\nb2RlLmNvbnN0YW50KCkuc2V0TnVsbCgpOwogICAgICAgIGNvZGUuYXN0b3Jl\nKCkuc2V0TG9jYWwoaW50ZXIpOwoKICAgICAgICBmb3IgKGludCBpID0gMDsg\naSA8IGZtZHMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAganVtcHMyID0g\nbmV3IExpbmtlZExpc3QoKTsKICAgICAgICAgICAgaW50ZXJtZWRpYXRlID0g\ndXNlc0ludGVybWVkaWF0ZShmbWRzW2ldKTsKICAgICAgICAgICAgLy8gaWYg\nKGZpZWxkcy5nZXQoaSkpCiAgICAgICAgICAgIC8vIHsKICAgICAgICAgICAg\nLy8gCQlpZiAobG9hZGVkLmdldChpKSkKICAgICAgICAgICAgc2V0VGFyZ2V0\nKGNvZGUuYWxvYWQoKS5zZXRQYXJhbSgxKSwganVtcHMpOwogICAgICAgICAg\nICBjb2RlLmNvbnN0YW50KCkuc2V0VmFsdWUoaSk7CiAgICAgICAgICAgIGNv\nZGUuaW52b2tldmlydHVhbCgpLnNldE1ldGhvZChCaXRTZXQuY2xhc3MsICJn\nZXQiLAogICAgICAgICAgICAgICAgYm9vbGVhbi5jbGFzcywgbmV3IENsYXNz\nW117IGludC5jbGFzcyB9KTsKICAgICAgICAgICAganVtcHMyLmFkZChjb2Rl\nLmlmZXEoKSk7CiAgICAgICAgICAgIGNvZGUuYWxvYWQoKS5zZXRUaGlzKCk7\nCiAgICAgICAgICAgIGNvZGUuZ2V0ZmllbGQoKS5zZXRGaWVsZCgibG9hZGVk\nIiwgQml0U2V0LmNsYXNzKTsKICAgICAgICAgICAgY29kZS5jb25zdGFudCgp\nLnNldFZhbHVlKGkpOwogICAgICAgICAgICBjb2RlLmludm9rZXZpcnR1YWwo\nKS5zZXRNZXRob2QoQml0U2V0LmNsYXNzLCAiZ2V0IiwKICAgICAgICAgICAg\nICAgIGJvb2xlYW4uY2xhc3MsIG5ldyBDbGFzc1tdeyBpbnQuY2xhc3MgfSk7\nCiAgICAgICAgICAgIGlmIChpbnRlcm1lZGlhdGUpCiAgICAgICAgICAgICAg\nICBqdW1wcy5hZGQoY29kZS5pZmVxKCkpOwogICAgICAgICAgICBlbHNlCiAg\nICAgICAgICAgICAgICBqdW1wczIuYWRkKGNvZGUuaWZlcSgpKTsKCiAgICAg\nICAgICAgIGFkZExvYWQoYmMsIGNvZGUsIGZtZHNbaV0sIG9iamVjdENvdW50\nLCBsb2NhbCwgdHJ1ZSk7CiAgICAgICAgICAgIGlmICh1c2VzSW1wbERhdGEo\nZm1kc1tpXSkpIHsKICAgICAgICAgICAgICAgIC8vIGxvYWRJbXBsRGF0YShz\nbSwgaSk7CiAgICAgICAgICAgICAgICBjb2RlLmFsb2FkKCkuc2V0VGhpcygp\nOwogICAgICAgICAgICAgICAgY29kZS5hbG9hZCgpLnNldFBhcmFtKDApOwog\nICAgICAgICAgICAgICAgY29kZS5jb25zdGFudCgpLnNldFZhbHVlKGkpOwog\nICAgICAgICAgICAgICAgY29kZS5pbnZva2V2aXJ0dWFsKCkuc2V0TWV0aG9k\nKCJsb2FkSW1wbERhdGEiLCB2b2lkLmNsYXNzLAogICAgICAgICAgICAgICAg\nICAgIG5ldyBDbGFzc1tdeyBPcGVuSlBBU3RhdGVNYW5hZ2VyLmNsYXNzLCBp\nbnQuY2xhc3MgfSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIGZp\nZWxkcy5jbGVhcihpKTsKICAgICAgICAgICAgY29kZS5hbG9hZCgpLnNldFBh\ncmFtKDEpOwogICAgICAgICAgICBjb2RlLmNvbnN0YW50KCkuc2V0VmFsdWUo\naSk7CiAgICAgICAgICAgIGNvZGUuaW52b2tldmlydHVhbCgpLnNldE1ldGhv\nZChCaXRTZXQuY2xhc3MsICJjbGVhciIsIHZvaWQuY2xhc3MsCiAgICAgICAg\nICAgICAgICBuZXcgQ2xhc3NbXSB7IGludC5jbGFzcyB9KTsKCiAgICAgICAg\nICAgIGp1bXBzMi5hZGQoY29kZS5nbzIoKSk7CgogICAgICAgICAgICBpZiAo\naW50ZXJtZWRpYXRlKQogICAgICAgICAgICAgICAgc2V0VGFyZ2V0KGFkZExv\nYWRJbnRlcm1lZGlhdGUKICAgICAgICAgICAgICAgICAgICAoY29kZSwgaSwg\nb2JqZWN0Q291bnQsIGp1bXBzMiwgaW50ZXIpLCBqdW1wcyk7CgogICAgICAg\nICAgICBqdW1wcyA9IGp1bXBzMjsKICAgICAgICAgICAgaWYgKHJlcGxhY2VU\neXBlKGZtZHNbaV0pID49IEphdmFUeXBlcy5PQkpFQ1QpCiAgICAgICAgICAg\nICAgICBvYmplY3RDb3VudCsrOwogICAgICAgIH0KICAgICAgICBzZXRUYXJn\nZXQoY29kZS52cmV0dXJuKCksIGp1bXBzKTsKICAgICAgICBjb2RlLmNhbGN1\nbGF0ZU1heFN0YWNrKCk7CiAgICAgICAgY29kZS5jYWxjdWxhdGVNYXhMb2Nh\nbHMoKTsKICAgIH0KCiAgICAvKioKICAgICAqIERlY2xhcmUgYW5kIHN0YXJ0\nIHRoZSBiYXNlIGxvYWQgbWV0aG9kLgogICAgICovCiAgICBwcml2YXRlIENv\nZGUgYWRkTG9hZE1ldGhvZChCQ0NsYXNzIGJjLCBib29sZWFuIGZpZWxkcykg\newogICAgICAgIENsYXNzW10gYXJncyA9IG51bGw7CiAgICAgICAgaWYgKGZp\nZWxkcykKICAgICAgICAgICAgYXJncyA9IG5ldyBDbGFzc1tdeyBPcGVuSlBB\nU3RhdGVNYW5hZ2VyLmNsYXNzLCBCaXRTZXQuY2xhc3MsCiAgICAgICAgICAg\nICAgICBGZXRjaENvbmZpZ3VyYXRpb24uY2xhc3MsIE9iamVjdC5jbGFzcyB9\nOwogICAgICAgIGVsc2UKICAgICAgICAgICAgYXJncyA9IG5ldyBDbGFzc1td\neyBPcGVuSlBBU3RhdGVNYW5hZ2VyLmNsYXNzLAogICAgICAgICAgICAgICAg\nRmV0Y2hDb25maWd1cmF0aW9uLmNsYXNzLCBPYmplY3QuY2xhc3MgfTsKICAg\nICAgICBCQ01ldGhvZCBsb2FkID0gYmMuZGVjbGFyZU1ldGhvZCgibG9hZCIs\nIHZvaWQuY2xhc3MsIGFyZ3MpOwogICAgICAgIENvZGUgY29kZSA9IGxvYWQu\nZ2V0Q29kZSh0cnVlKTsKCiAgICAgICAgLy9sb2FkVmVyc2lvbihzbSk7CiAg\nICAgICAgY29kZS5hbG9hZCgpLnNldFRoaXMoKTsKICAgICAgICBjb2RlLmFs\nb2FkKCkuc2V0UGFyYW0oMCk7CiAgICAgICAgY29kZS5pbnZva2V2aXJ0dWFs\nKCkuc2V0TWV0aG9kKCJsb2FkVmVyc2lvbiIsIHZvaWQuY2xhc3MsCiAgICAg\nICAgICAgIG5ldyBDbGFzc1tdeyBPcGVuSlBBU3RhdGVNYW5hZ2VyLmNsYXNz\nIH0pOwoKICAgICAgICAvL2xvYWRJbXBsRGF0YShzbSk7CiAgICAgICAgY29k\nZS5hbG9hZCgpLnNldFRoaXMoKTsKICAgICAgICBjb2RlLmFsb2FkKCkuc2V0\nUGFyYW0oMCk7CiAgICAgICAgY29kZS5pbnZva2V2aXJ0dWFsKCkuc2V0TWV0\naG9kKCJsb2FkSW1wbERhdGEiLCB2b2lkLmNsYXNzLAogICAgICAgICAgICBu\nZXcgQ2xhc3NbXXsgT3BlbkpQQVN0YXRlTWFuYWdlci5jbGFzcyB9KTsKICAg\nICAgICByZXR1cm4gY29kZTsKICAgIH0KCiAgICAvKioKICAgICAqIEFkZCB0\naGUgZmllbGQgbG9hZC4KICAgICAqLwogICAgcHJpdmF0ZSBJbnN0cnVjdGlv\nbiBhZGRMb2FkKEJDQ2xhc3MgYmMsIENvZGUgY29kZSwgRmllbGRNZXRhRGF0\nYSBmbWQsCiAgICAgICAgaW50IG9iamVjdENvdW50LCBpbnQgbG9jYWwsIGJv\nb2xlYW4gZmllbGRzKSB7CiAgICAgICAgaW50IGluZGV4ID0gZm1kLmdldElu\nZGV4KCk7CiAgICAgICAgaW50IHR5cGVDb2RlID0gcmVwbGFjZVR5cGUoZm1k\nKTsKICAgICAgICBJbnN0cnVjdGlvbiBmaXJzdDsKICAgICAgICBpZiAodHlw\nZUNvZGUgPCBKYXZhVHlwZXMuT0JKRUNUKSB7CiAgICAgICAgICAgIC8vIHNt\nLnN0b3JlPHR5cGU+KGksIGZpZWxkPGk+KQogICAgICAgICAgICBDbGFzcyB0\neXBlID0gZm9yVHlwZShmbWQuZ2V0VHlwZUNvZGUoKSk7CiAgICAgICAgICAg\nIGZpcnN0ID0gY29kZS5hbG9hZCgpLnNldFBhcmFtKDApOwogICAgICAgICAg\nICBjb2RlLmNvbnN0YW50KCkuc2V0VmFsdWUoaW5kZXgpOwogICAgICAgICAg\nICBjb2RlLmFsb2FkKCkuc2V0VGhpcygpOwogICAgICAgICAgICBjb2RlLmdl\ndGZpZWxkKCkuc2V0RmllbGQoZ2V0RmllbGROYW1lKGluZGV4KSwgdHlwZSk7\nCiAgICAgICAgICAgIGNvZGUuaW52b2tlaW50ZXJmYWNlKCkuc2V0TWV0aG9k\nKE9wZW5KUEFTdGF0ZU1hbmFnZXIuY2xhc3MsCiAgICAgICAgICAgICAgICAi\nc3RvcmUiICsgU3RyaW5nVXRpbHMuY2FwaXRhbGl6ZSh0eXBlLmdldE5hbWUo\nKSksCiAgICAgICAgICAgICAgICB2b2lkLmNsYXNzLCBuZXcgQ2xhc3NbXXsg\naW50LmNsYXNzLCB0eXBlIH0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAg\nICAgIC8vIGZtZCA9IHNtLmdldE1ldGFEYXRhKCkuZ2V0RmllbGQoaSk7CiAg\nICAgICAgICAgIGludCBvZmZzZXQgPSBmaWVsZHMgPyAxIDogMDsKICAgICAg\nICAgICAgZmlyc3QgPSBjb2RlLmFsb2FkKCkuc2V0UGFyYW0oMCk7CiAgICAg\nICAgICAgIGNvZGUuaW52b2tlaW50ZXJmYWNlKCkuc2V0TWV0aG9kKE9wZW5K\nUEFTdGF0ZU1hbmFnZXIuY2xhc3MsCiAgICAgICAgICAgICAgICAiZ2V0TWV0\nYURhdGEiLCBDbGFzc01ldGFEYXRhLmNsYXNzLCBudWxsKTsKICAgICAgICAg\nICAgY29kZS5jb25zdGFudCgpLnNldFZhbHVlKGZtZC5nZXRJbmRleCgpKTsK\nICAgICAgICAgICAgY29kZS5pbnZva2V2aXJ0dWFsKCkuc2V0TWV0aG9kKENs\nYXNzTWV0YURhdGEuY2xhc3MsICJnZXRGaWVsZCIsCiAgICAgICAgICAgICAg\nICBGaWVsZE1ldGFEYXRhLmNsYXNzLCBuZXcgQ2xhc3NbXXsgaW50LmNsYXNz\nIH0pOwogICAgICAgICAgICBjb2RlLmFzdG9yZSgpLnNldExvY2FsKGxvY2Fs\nKTsKICAgICAgICAgICAgLy8gc20uc3RvcmVGaWVsZChpLCB0b0ZpZWxkKHNt\nLCBmbWQsIG9iamVjdHNbb2JqZWN0Q291bnRdLAogICAgICAgICAgICAvLyAJ\nCWZldGNoLCBjb250ZXh0KTsKICAgICAgICAgICAgY29kZS5hbG9hZCgpLnNl\ndFBhcmFtKDApOwogICAgICAgICAgICBjb2RlLmNvbnN0YW50KCkuc2V0VmFs\ndWUoaW5kZXgpOwogICAgICAgICAgICBjb2RlLmFsb2FkKCkuc2V0VGhpcygp\nOwogICAgICAgICAgICBjb2RlLmFsb2FkKCkuc2V0UGFyYW0oMCk7CiAgICAg\nICAgICAgIGNvZGUuYWxvYWQoKS5zZXRMb2NhbChsb2NhbCk7CiAgICAgICAg\nICAgIGNvZGUuYWxvYWQoKS5zZXRUaGlzKCk7CiAgICAgICAgICAgIGNvZGUu\nZ2V0ZmllbGQoKS5zZXRGaWVsZCgib2JqZWN0cyIsIE9iamVjdFtdLmNsYXNz\nKTsKICAgICAgICAgICAgY29kZS5jb25zdGFudCgpLnNldFZhbHVlKG9iamVj\ndENvdW50KTsKICAgICAgICAgICAgY29kZS5hYWxvYWQoKTsKICAgICAgICAg\nICAgY29kZS5hbG9hZCgpLnNldFBhcmFtKDEgKyBvZmZzZXQpOwogICAgICAg\nICAgICBjb2RlLmFsb2FkKCkuc2V0UGFyYW0oMiArIG9mZnNldCk7CiAgICAg\nICAgICAgIGNvZGUuaW52b2tldmlydHVhbCgpLnNldE1ldGhvZChiYy5nZXRO\nYW1lKCksICJ0b0ZpZWxkIiwKICAgICAgICAgICAgICAgIE9iamVjdC5jbGFz\ncy5nZXROYW1lKCksIHRvU3RyaW5ncyhuZXcgQ2xhc3NbXXsgCiAgICAgICAg\nICAgICAgICBPcGVuSlBBU3RhdGVNYW5hZ2VyLmNsYXNzLCBGaWVsZE1ldGFE\nYXRhLmNsYXNzLAogICAgICAgICAgICAgICAgT2JqZWN0LmNsYXNzLCBGZXRj\naENvbmZpZ3VyYXRpb24uY2xhc3MsIE9iamVjdC5jbGFzcyB9KSk7CiAgICAg\nICAgICAgIGNvZGUuaW52b2tlaW50ZXJmYWNlKCkuc2V0TWV0aG9kKE9wZW5K\nUEFTdGF0ZU1hbmFnZXIuY2xhc3MsCiAgICAgICAgICAgICAgICAic3RvcmVG\naWVsZCIsIHZvaWQuY2xhc3MsCiAgICAgICAgICAgICAgICBuZXcgQ2xhc3Nb\nXXsgaW50LmNsYXNzLCBPYmplY3QuY2xhc3MgfSk7CiAgICAgICAgfQogICAg\nICAgIHJldHVybiBmaXJzdDsKICAgIH0KCiAgICAvKioKICAgICAqIExvYWQg\naW50ZXJtZWRpYXRlIGRhdGEgaWYgcG9zc2libGUuCiAgICAgKi8KICAgIHBy\naXZhdGUgSW5zdHJ1Y3Rpb24gYWRkTG9hZEludGVybWVkaWF0ZShDb2RlIGNv\nZGUsIGludCBpbmRleCwKICAgICAgICBpbnQgb2JqZWN0Q291bnQsIENvbGxl\nY3Rpb24ganVtcHMyLCBpbnQgaW50ZXIpIHsKICAgICAgICAvLyB7CiAgICAg\nICAgLy8gCQlPYmplY3QgaW50ZXIgPSBvYmplY3RzW29iamVjdENvdW50XTsK\nICAgICAgICBJbnN0cnVjdGlvbiBmaXJzdCA9IGNvZGUuYWxvYWQoKS5zZXRU\naGlzKCk7CiAgICAgICAgY29kZS5nZXRmaWVsZCgpLnNldEZpZWxkKCJvYmpl\nY3RzIiwgT2JqZWN0W10uY2xhc3MpOwogICAgICAgIGNvZGUuY29uc3RhbnQo\nKS5zZXRWYWx1ZShvYmplY3RDb3VudCk7CiAgICAgICAgY29kZS5hYWxvYWQo\nKTsKICAgICAgICBjb2RlLmFzdG9yZSgpLnNldExvY2FsKGludGVyKTsKICAg\nICAgICAvLyAJCWlmIChpbnRlciAhPSBudWxsICYmICFzbS5nZXRMb2FkZWQo\nKS5nZXQoaW5kZXgpKQogICAgICAgIGNvZGUuYWxvYWQoKS5zZXRMb2NhbChp\nbnRlcik7CiAgICAgICAganVtcHMyLmFkZChjb2RlLmlmbnVsbCgpKTsKICAg\nICAgICBjb2RlLmFsb2FkKCkuc2V0UGFyYW0oMCk7CiAgICAgICAgY29kZS5p\nbnZva2VpbnRlcmZhY2UoKS5zZXRNZXRob2QoT3BlbkpQQVN0YXRlTWFuYWdl\nci5jbGFzcywKICAgICAgICAgICAgImdldExvYWRlZCIsIEJpdFNldC5jbGFz\ncywgbnVsbCk7CiAgICAgICAgY29kZS5jb25zdGFudCgpLnNldFZhbHVlKGlu\nZGV4KTsKICAgICAgICBjb2RlLmludm9rZXZpcnR1YWwoKS5zZXRNZXRob2Qo\nQml0U2V0LmNsYXNzLCAiZ2V0IiwKICAgICAgICAgICAgYm9vbGVhbi5jbGFz\ncywgbmV3IENsYXNzW117IGludC5jbGFzcyB9KTsKICAgICAgICBqdW1wczIu\nYWRkKGNvZGUuaWZuZSgpKTsKICAgICAgICAvLwkJCXNtLnNldEludGVybWVk\naWF0ZShpbmRleCwgaW50ZXIpOwogICAgICAgIC8vCX0gIC8vIGVuZCBlbHNl\nCiAgICAgICAgY29kZS5hbG9hZCgpLnNldFBhcmFtKDApOwogICAgICAgIGNv\nZGUuY29uc3RhbnQoKS5zZXRWYWx1ZShpbmRleCk7CiAgICAgICAgY29kZS5h\nbG9hZCgpLnNldExvY2FsKGludGVyKTsKICAgICAgICBjb2RlLmludm9rZWlu\ndGVyZmFjZSgpLnNldE1ldGhvZChPcGVuSlBBU3RhdGVNYW5hZ2VyLmNsYXNz\nLAogICAgICAgICAgICAic2V0SW50ZXJtZWRpYXRlIiwgdm9pZC5jbGFzcywK\nICAgICAgICAgICAgbmV3IENsYXNzW117IGludC5jbGFzcywgT2JqZWN0LmNs\nYXNzIH0pOwogICAgICAgIHJldHVybiBmaXJzdDsKICAgIH0KCiAgICBwcml2\nYXRlIHZvaWQgYWRkU3RvcmVNZXRob2RzKEJDQ2xhc3MgYmMsIENsYXNzTWV0\nYURhdGEgbWV0YSkgewogICAgICAgIC8vIGkuZS4gdm9pZCBzdG9yZShPcGVu\nSlBBU3RhdGVNYW5hZ2VyIHNtLCBCaXRTZXQgZmllbGRzKTsKICAgICAgICBh\nZGRTdG9yZU1ldGhvZChiYywgbWV0YSwgdHJ1ZSk7CiAgICAgICAgLy8gaS5l\nLiB2b2lkIHN0b3JlKE9wZW5KUEFTdGF0ZU1hbmFnZXIgc20pOwogICAgICAg\nIGFkZFN0b3JlTWV0aG9kKGJjLCBtZXRhLCBmYWxzZSk7CiAgICB9CgogICAg\ncHJpdmF0ZSB2b2lkIGFkZFN0b3JlTWV0aG9kKEJDQ2xhc3MgYmMsIENsYXNz\nTWV0YURhdGEgbWV0YSwKICAgICAgICBib29sZWFuIGZpZWxkcykgewogICAg\nICAgIEJDTWV0aG9kIHN0b3JlOwogICAgICAgIGlmIChmaWVsZHMpCiAgICAg\nICAgICAgIHN0b3JlID0gYmMuZGVjbGFyZU1ldGhvZCgic3RvcmUiLCB2b2lk\nLmNsYXNzLAogICAgICAgICAgICAgICAgbmV3IENsYXNzW117IE9wZW5KUEFT\ndGF0ZU1hbmFnZXIuY2xhc3MsIEJpdFNldC5jbGFzcyB9KTsKICAgICAgICBl\nbHNlCiAgICAgICAgICAgIHN0b3JlID0gYmMuZGVjbGFyZU1ldGhvZCgic3Rv\ncmUiLCB2b2lkLmNsYXNzLAogICAgICAgICAgICAgICAgbmV3IENsYXNzW117\nIE9wZW5KUEFTdGF0ZU1hbmFnZXIuY2xhc3MgfSk7CiAgICAgICAgQ29kZSBj\nb2RlID0gc3RvcmUuZ2V0Q29kZSh0cnVlKTsKCiAgICAgICAgLy8gaW5pdGlh\nbGl6ZSgpOwogICAgICAgIGNvZGUuYWxvYWQoKS5zZXRUaGlzKCk7CiAgICAg\nICAgY29kZS5pbnZva2V2aXJ0dWFsKCkuc2V0TWV0aG9kKCJpbml0aWFsaXpl\nIiwgdm9pZC5jbGFzcywgbnVsbCk7CgogICAgICAgIC8vIHN0b3JlVmVyc2lv\nbihzbSk7CiAgICAgICAgY29kZS5hbG9hZCgpLnNldFRoaXMoKTsKICAgICAg\nICBjb2RlLmFsb2FkKCkuc2V0UGFyYW0oMCk7CiAgICAgICAgY29kZS5pbnZv\na2V2aXJ0dWFsKCkuc2V0TWV0aG9kKCJzdG9yZVZlcnNpb24iLCB2b2lkLmNs\nYXNzLAogICAgICAgICAgICBuZXcgQ2xhc3NbXXsgT3BlbkpQQVN0YXRlTWFu\nYWdlci5jbGFzcyB9KTsKCiAgICAgICAgLy8gc3RvcmVJbXBsRGF0YShzbSk7\nCiAgICAgICAgY29kZS5hbG9hZCgpLnNldFRoaXMoKTsKICAgICAgICBjb2Rl\nLmFsb2FkKCkuc2V0UGFyYW0oMCk7CiAgICAgICAgY29kZS5pbnZva2V2aXJ0\ndWFsKCkuc2V0TWV0aG9kKCJzdG9yZUltcGxEYXRhIiwgdm9pZC5jbGFzcywK\nICAgICAgICAgICAgbmV3IENsYXNzW117IE9wZW5KUEFTdGF0ZU1hbmFnZXIu\nY2xhc3MgfSk7CgogICAgICAgIEZpZWxkTWV0YURhdGFbXSBmbWRzID0gbWV0\nYS5nZXRGaWVsZHMoKTsKICAgICAgICBDb2xsZWN0aW9uIGp1bXBzID0gbmV3\nIExpbmtlZExpc3QoKTsKICAgICAgICBpbnQgb2JqZWN0Q291bnQgPSAwOwog\nICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgZm1kcy5sZW5ndGg7IGkrKykg\newogICAgICAgICAgICBpZiAoZmllbGRzKSB7CiAgICAgICAgICAgICAgICAv\nLyAgaWYgKGZpZWxkcyAhPSBudWxsICYmIGZpZWxkcy5nZXQoaW5kZXgpKQog\nICAgICAgICAgICAgICAgc2V0VGFyZ2V0KGNvZGUuYWxvYWQoKS5zZXRQYXJh\nbSgxKSwganVtcHMpOwogICAgICAgICAgICAgICAganVtcHMuYWRkKGNvZGUu\naWZudWxsKCkpOwogICAgICAgICAgICAgICAgY29kZS5hbG9hZCgpLnNldFBh\ncmFtKDEpOwogICAgICAgICAgICAgICAgY29kZS5jb25zdGFudCgpLnNldFZh\nbHVlKGkpOwogICAgICAgICAgICAgICAgY29kZS5pbnZva2V2aXJ0dWFsKCku\nc2V0TWV0aG9kKEJpdFNldC5jbGFzcywgImdldCIsCiAgICAgICAgICAgICAg\nICAgICAgYm9vbGVhbi5jbGFzcywgbmV3IENsYXNzW117IGludC5jbGFzcyB9\nKTsKICAgICAgICAgICAgICAgIGp1bXBzLmFkZChjb2RlLmlmZXEoKSk7CiAg\nICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAvLyBpZiAoc20u\nZ2V0TG9hZGVkKCkuZ2V0KGluZGV4KSkpCiAgICAgICAgICAgICAgICBzZXRU\nYXJnZXQoY29kZS5hbG9hZCgpLnNldFBhcmFtKDApLCBqdW1wcyk7CiAgICAg\nICAgICAgICAgICBjb2RlLmludm9rZWludGVyZmFjZSgpLnNldE1ldGhvZChP\ncGVuSlBBU3RhdGVNYW5hZ2VyLmNsYXNzLAogICAgICAgICAgICAgICAgICAg\nICJnZXRMb2FkZWQiLCBCaXRTZXQuY2xhc3MsIG51bGwpOwogICAgICAgICAg\nICAgICAgY29kZS5jb25zdGFudCgpLnNldFZhbHVlKGkpOwogICAgICAgICAg\nICAgICAgY29kZS5pbnZva2V2aXJ0dWFsKCkuc2V0TWV0aG9kKEJpdFNldC5j\nbGFzcywgImdldCIsCiAgICAgICAgICAgICAgICAgICAgYm9vbGVhbi5jbGFz\ncywgbmV3IENsYXNzW117IGludC5jbGFzcyB9KTsKICAgICAgICAgICAgICAg\nIGp1bXBzLmFkZChjb2RlLmlmZXEoKSk7CiAgICAgICAgICAgIH0KICAgICAg\nICAgICAgYWRkU3RvcmUoYmMsIGNvZGUsIGZtZHNbaV0sIG9iamVjdENvdW50\nKTsKICAgICAgICAgICAgaWYgKHVzZXNJbnRlcm1lZGlhdGUoZm1kc1tpXSkp\nIHsKICAgICAgICAgICAgICAgIEp1bXBJbnN0cnVjdGlvbiBlbHNlSW5zID0g\nY29kZS5nbzIoKTsKICAgICAgICAgICAgICAgIC8vIGVsc2UgaWYgKCFsb2Fk\nZWQuZ2V0KGluZGV4KSkKICAgICAgICAgICAgICAgIHNldFRhcmdldChjb2Rl\nLmFsb2FkKCkuc2V0VGhpcygpLCBqdW1wcyk7CiAgICAgICAgICAgICAgICBq\ndW1wcy5hZGQoZWxzZUlucyk7CiAgICAgICAgICAgICAgICBjb2RlLmdldGZp\nZWxkKCkuc2V0RmllbGQoImxvYWRlZCIsIEJpdFNldC5jbGFzcyk7CiAgICAg\nICAgICAgICAgICBjb2RlLmNvbnN0YW50KCkuc2V0VmFsdWUoaSk7CiAgICAg\nICAgICAgICAgICBjb2RlLmludm9rZXZpcnR1YWwoKS5zZXRNZXRob2QoQml0\nU2V0LmNsYXNzLCAiZ2V0IiwKICAgICAgICAgICAgICAgICAgICBib29sZWFu\nLmNsYXNzLCBuZXcgQ2xhc3NbXXsgaW50LmNsYXNzIH0pOwogICAgICAgICAg\nICAgICAganVtcHMuYWRkKGNvZGUuaWZuZSgpKTsKICAgICAgICAgICAgICAg\nIC8vIE9iamVjdCB2YWwgPSBzbS5nZXRJbnRlcm1lZGlhdGUoaW5kZXgpOwog\nICAgICAgICAgICAgICAgLy8gaWYgKHZhbCAhPSBudWxsKQogICAgICAgICAg\nICAgICAgLy8gCQlvYmplY3RzW29iamVjdENvdW50XSA9IHZhbDsKICAgICAg\nICAgICAgICAgIGNvZGUuYWxvYWQoKS5zZXRQYXJhbSgwKTsKICAgICAgICAg\nICAgICAgIGNvZGUuY29uc3RhbnQoKS5zZXRWYWx1ZShpKTsKICAgICAgICAg\nICAgICAgIGNvZGUuaW52b2tlaW50ZXJmYWNlKCkuc2V0TWV0aG9kKE9wZW5K\nUEFTdGF0ZU1hbmFnZXIuY2xhc3MsCiAgICAgICAgICAgICAgICAgICAgImdl\ndEludGVybWVkaWF0ZSIsIE9iamVjdC5jbGFzcywgbmV3IENsYXNzW117IGlu\ndC5jbGFzcyB9KTsKICAgICAgICAgICAgICAgIGludCBsb2NhbCA9IGNvZGUu\nZ2V0TmV4dExvY2Fsc0luZGV4KCk7CiAgICAgICAgICAgICAgICBjb2RlLmFz\ndG9yZSgpLnNldExvY2FsKGxvY2FsKTsKICAgICAgICAgICAgICAgIGNvZGUu\nYWxvYWQoKS5zZXRMb2NhbChsb2NhbCk7CiAgICAgICAgICAgICAgICBqdW1w\ncy5hZGQoY29kZS5pZm51bGwoKSk7CiAgICAgICAgICAgICAgICBjb2RlLmFs\nb2FkKCkuc2V0VGhpcygpOwogICAgICAgICAgICAgICAgY29kZS5nZXRmaWVs\nZCgpLnNldEZpZWxkKCJvYmplY3RzIiwgT2JqZWN0W10uY2xhc3MpOwogICAg\nICAgICAgICAgICAgY29kZS5jb25zdGFudCgpLnNldFZhbHVlKG9iamVjdENv\ndW50KTsKICAgICAgICAgICAgICAgIGNvZGUuYWxvYWQoKS5zZXRMb2NhbChs\nb2NhbCk7CiAgICAgICAgICAgICAgICBjb2RlLmFhc3RvcmUoKTsKICAgICAg\nICAgICAgfQogICAgICAgICAgICBpZiAocmVwbGFjZVR5cGUoZm1kc1tpXSkg\nPj0gSmF2YVR5cGVzLk9CSkVDVCkKICAgICAgICAgICAgICAgIG9iamVjdENv\ndW50Kys7CiAgICAgICAgfQogICAgICAgIHNldFRhcmdldChjb2RlLnZyZXR1\ncm4oKSwganVtcHMpOwogICAgICAgIGNvZGUuY2FsY3VsYXRlTWF4TG9jYWxz\nKCk7CiAgICAgICAgY29kZS5jYWxjdWxhdGVNYXhTdGFjaygpOwogICAgfQoK\nICAgIHByaXZhdGUgdm9pZCBhZGRTdG9yZShCQ0NsYXNzIGJjLCBDb2RlIGNv\nZGUsIEZpZWxkTWV0YURhdGEgZm1kLAogICAgICAgIGludCBvYmplY3RDb3Vu\ndCkgewogICAgICAgIGludCB0eXBlQ29kZSA9IHJlcGxhY2VUeXBlKGZtZCk7\nCiAgICAgICAgaW50IGluZGV4ID0gZm1kLmdldEluZGV4KCk7CiAgICAgICAg\naWYgKHR5cGVDb2RlIDwgSmF2YVR5cGVzLk9CSkVDVCkgewogICAgICAgICAg\nICBDbGFzcyB0eXBlID0gZm9yVHlwZSh0eXBlQ29kZSk7CiAgICAgICAgICAg\nIC8vIGZpZWxkPGk+ID0gc20uZmV0Y2g8VHlwZT4oaW5kZXgpCiAgICAgICAg\nICAgIGNvZGUuYWxvYWQoKS5zZXRUaGlzKCk7CiAgICAgICAgICAgIGNvZGUu\nYWxvYWQoKS5zZXRQYXJhbSgwKTsKICAgICAgICAgICAgY29kZS5jb25zdGFu\ndCgpLnNldFZhbHVlKGluZGV4KTsKICAgICAgICAgICAgY29kZS5pbnZva2Vp\nbnRlcmZhY2UoKS5zZXRNZXRob2QoT3BlbkpQQVN0YXRlTWFuYWdlci5jbGFz\ncywKICAgICAgICAgICAgICAgICJmZXRjaCIgKyBTdHJpbmdVdGlscy5jYXBp\ndGFsaXplKHR5cGUuZ2V0TmFtZSgpKSwgdHlwZSwKICAgICAgICAgICAgICAg\nIG5ldyBDbGFzc1tdeyBpbnQuY2xhc3MgfSk7CiAgICAgICAgICAgIGNvZGUu\ncHV0ZmllbGQoKS5zZXRGaWVsZChnZXRGaWVsZE5hbWUoaW5kZXgpLCB0eXBl\nKTsKICAgICAgICAgICAgY29kZS5hbG9hZCgpLnNldFRoaXMoKTsKICAgICAg\nICAgICAgY29kZS5nZXRmaWVsZCgpLnNldEZpZWxkKCJsb2FkZWQiLCBCaXRT\nZXQuY2xhc3MpOwogICAgICAgICAgICBjb2RlLmNvbnN0YW50KCkuc2V0VmFs\ndWUoaW5kZXgpOwogICAgICAgICAgICBjb2RlLmludm9rZXZpcnR1YWwoKS5z\nZXRNZXRob2QoQml0U2V0LmNsYXNzLCAic2V0Iiwgdm9pZC5jbGFzcywKICAg\nICAgICAgICAgICAgIG5ldyBDbGFzc1tdeyBpbnQuY2xhc3MgfSk7CiAgICAg\nICAgfSBlbHNlIHsKICAgICAgICAgICAgLy8gT2JqZWN0IHZhbCA9IHRvRGF0\nYShzbS5nZXRNZXRhRGF0YSgpLmdldEZpZWxkKGluZGV4KSwKICAgICAgICAg\nICAgLy8gCQlzbS5mZXRjaEZpZWxkKGluZGV4LCBmYWxzZSksIHNtLmdldENv\nbnRleHQoKSk7CiAgICAgICAgICAgIGludCBsb2NhbCA9IGNvZGUuZ2V0TmV4\ndExvY2Fsc0luZGV4KCk7CiAgICAgICAgICAgIGNvZGUuYWxvYWQoKS5zZXRU\naGlzKCk7CiAgICAgICAgICAgIGNvZGUuYWxvYWQoKS5zZXRQYXJhbSgwKTsK\nICAgICAgICAgICAgY29kZS5pbnZva2VpbnRlcmZhY2UoKS5zZXRNZXRob2Qo\nT3BlbkpQQVN0YXRlTWFuYWdlci5jbGFzcywKICAgICAgICAgICAgICAgICJn\nZXRNZXRhRGF0YSIsIENsYXNzTWV0YURhdGEuY2xhc3MsIG51bGwpOwogICAg\nICAgICAgICBjb2RlLmNvbnN0YW50KCkuc2V0VmFsdWUoZm1kLmdldEluZGV4\nKCkpOwogICAgICAgICAgICBjb2RlLmludm9rZXZpcnR1YWwoKS5zZXRNZXRo\nb2QoQ2xhc3NNZXRhRGF0YS5jbGFzcywKICAgICAgICAgICAgICAgICJnZXRG\naWVsZCIsIEZpZWxkTWV0YURhdGEuY2xhc3MsIG5ldyBDbGFzc1tdeyBpbnQu\nY2xhc3MgfSk7CiAgICAgICAgICAgIGNvZGUuYWxvYWQoKS5zZXRQYXJhbSgw\nKTsKICAgICAgICAgICAgY29kZS5jb25zdGFudCgpLnNldFZhbHVlKGZtZC5n\nZXRJbmRleCgpKTsKICAgICAgICAgICAgY29kZS5jb25zdGFudCgpLnNldFZh\nbHVlKGZhbHNlKTsKICAgICAgICAgICAgY29kZS5pbnZva2VpbnRlcmZhY2Uo\nKS5zZXRNZXRob2QoT3BlbkpQQVN0YXRlTWFuYWdlci5jbGFzcywKICAgICAg\nICAgICAgICAgICJmZXRjaEZpZWxkIiwgT2JqZWN0LmNsYXNzLCBuZXcgQ2xh\nc3NbXQogICAgICAgICAgICAgICAgeyBpbnQuY2xhc3MsIGJvb2xlYW4uY2xh\nc3MgfSk7CiAgICAgICAgICAgIGNvZGUuYWxvYWQoKS5zZXRQYXJhbSgwKTsK\nICAgICAgICAgICAgY29kZS5pbnZva2VpbnRlcmZhY2UoKS5zZXRNZXRob2Qo\nT3BlbkpQQVN0YXRlTWFuYWdlci5jbGFzcywKICAgICAgICAgICAgICAgICJn\nZXRDb250ZXh0IiwgU3RvcmVDb250ZXh0LmNsYXNzLCBudWxsKTsKICAgICAg\nICAgICAgY29kZS5pbnZva2V2aXJ0dWFsKCkuc2V0TWV0aG9kKGJjLmdldE5h\nbWUoKSwgInRvRGF0YSIsCiAgICAgICAgICAgICAgICBPYmplY3QuY2xhc3Mu\nZ2V0TmFtZSgpLCB0b1N0cmluZ3MobmV3IENsYXNzIFtdewogICAgICAgICAg\nICAgICAgRmllbGRNZXRhRGF0YS5jbGFzcywgT2JqZWN0LmNsYXNzLCBTdG9y\nZUNvbnRleHQuY2xhc3MgfSkpOwogICAgICAgICAgICBjb2RlLmFzdG9yZSgp\nLnNldExvY2FsKGxvY2FsKTsKCiAgICAgICAgICAgIC8vIGlmICh2YWwgPT0g\nTlVMTCkgewogICAgICAgICAgICAvLyAJCXZhbCA9IG51bGw7CiAgICAgICAg\nICAgIC8vIAkJbG9hZGVkLmNsZWFyKGluZGV4KTsKICAgICAgICAgICAgLy8g\nCX0gZWxzZQogICAgICAgICAgICAvLyAJCWxvYWRlZC5zZXQoaW5kZXgpOwog\nICAgICAgICAgICAvLyAJb2JqZWN0c1tvYmplY3RDb3VudF0gPSB2YWw7CiAg\nICAgICAgICAgIGNvZGUuYWxvYWQoKS5zZXRMb2NhbChsb2NhbCk7CiAgICAg\nICAgICAgIGNvZGUuZ2V0c3RhdGljKCkuc2V0RmllbGQoQWJzdHJhY3RQQ0Rh\ndGEuY2xhc3MsICJOVUxMIiwKICAgICAgICAgICAgICAgIE9iamVjdC5jbGFz\ncyk7CiAgICAgICAgICAgIEp1bXBJbnN0cnVjdGlvbiBpZmlucyA9IGNvZGUu\naWZhY21wbmUoKTsKICAgICAgICAgICAgY29kZS5jb25zdGFudCgpLnNldE51\nbGwoKTsKICAgICAgICAgICAgY29kZS5hc3RvcmUoKS5zZXRMb2NhbChsb2Nh\nbCk7CiAgICAgICAgICAgIGNvZGUuYWxvYWQoKS5zZXRUaGlzKCk7CiAgICAg\nICAgICAgIGNvZGUuZ2V0ZmllbGQoKS5zZXRGaWVsZCgibG9hZGVkIiwgQml0\nU2V0LmNsYXNzKTsKICAgICAgICAgICAgY29kZS5jb25zdGFudCgpLnNldFZh\nbHVlKGluZGV4KTsKICAgICAgICAgICAgY29kZS5pbnZva2V2aXJ0dWFsKCku\nc2V0TWV0aG9kKEJpdFNldC5jbGFzcywgImNsZWFyIiwgdm9pZC5jbGFzcywK\nICAgICAgICAgICAgICAgIG5ldyBDbGFzc1tdeyBpbnQuY2xhc3MgfSk7CiAg\nICAgICAgICAgIEp1bXBJbnN0cnVjdGlvbiBnbzIgPSBjb2RlLmdvMigpOwog\nICAgICAgICAgICBpZmlucy5zZXRUYXJnZXQoY29kZS5hbG9hZCgpLnNldFRo\naXMoKSk7CiAgICAgICAgICAgIGNvZGUuZ2V0ZmllbGQoKS5zZXRGaWVsZCgi\nbG9hZGVkIiwgQml0U2V0LmNsYXNzKTsKICAgICAgICAgICAgY29kZS5jb25z\ndGFudCgpLnNldFZhbHVlKGluZGV4KTsKICAgICAgICAgICAgY29kZS5pbnZv\na2V2aXJ0dWFsKCkuc2V0TWV0aG9kKEJpdFNldC5jbGFzcywgInNldCIsIHZv\naWQuY2xhc3MsCiAgICAgICAgICAgICAgICBuZXcgQ2xhc3NbXXsgaW50LmNs\nYXNzIH0pOwogICAgICAgICAgICBnbzIuc2V0VGFyZ2V0KGNvZGUuYWxvYWQo\nKS5zZXRUaGlzKCkpOwogICAgICAgICAgICBjb2RlLmdldGZpZWxkKCkuc2V0\nRmllbGQoIm9iamVjdHMiLCBPYmplY3RbXS5jbGFzcyk7CiAgICAgICAgICAg\nIGNvZGUuY29uc3RhbnQoKS5zZXRWYWx1ZShvYmplY3RDb3VudCk7CiAgICAg\nICAgICAgIGNvZGUuYWxvYWQoKS5zZXRMb2NhbChsb2NhbCk7CiAgICAgICAg\nICAgIGNvZGUuYWFzdG9yZSgpOwogICAgICAgIH0KICAgICAgICBpZiAoIXVz\nZXNJbXBsRGF0YShmbWQpKQogICAgICAgICAgICByZXR1cm47CgogICAgICAg\nIC8vIHN0b3JlSW1wbERhdGEoc20sIGksIGxvYWRlZC5nZXQoaSk7CiAgICAg\nICAgY29kZS5hbG9hZCgpLnNldFRoaXMoKTsKICAgICAgICBjb2RlLmFsb2Fk\nKCkuc2V0UGFyYW0oMCk7CiAgICAgICAgY29kZS5jb25zdGFudCgpLnNldFZh\nbHVlKGluZGV4KTsKICAgICAgICBjb2RlLmFsb2FkKCkuc2V0VGhpcygpOwog\nICAgICAgIGNvZGUuZ2V0ZmllbGQoKS5zZXRGaWVsZCgibG9hZGVkIiwgQml0\nU2V0LmNsYXNzKTsKICAgICAgICBjb2RlLmNvbnN0YW50KCkuc2V0VmFsdWUo\naW5kZXgpOwogICAgICAgIGNvZGUuaW52b2tldmlydHVhbCgpLnNldE1ldGhv\nZChCaXRTZXQuY2xhc3MsICJnZXQiLCBib29sZWFuLmNsYXNzLAogICAgICAg\nICAgICBuZXcgQ2xhc3NbXXsgaW50LmNsYXNzIH0pOwogICAgICAgIGNvZGUu\naW52b2tldmlydHVhbCgpLnNldE1ldGhvZCgic3RvcmVJbXBsRGF0YSIsIHZv\naWQuY2xhc3MsCiAgICAgICAgICAgIG5ldyBDbGFzc1tdeyBPcGVuSlBBU3Rh\ndGVNYW5hZ2VyLmNsYXNzLCBpbnQuY2xhc3MsIGJvb2xlYW4uY2xhc3MgfSk7\nCiAgICB9CgogICAgcHJpdmF0ZSB2b2lkIGFkZE5ld0VtYmVkZGVkKEJDQ2xh\nc3MgYmMpIHsKICAgICAgICAvLyB2b2lkIG5ld0VtYmVkZGVkUENEYXRhKE9w\nZW5KUEFTdGF0ZU1hbmFnZXIgZW1iZWRkZWQpCiAgICAgICAgQkNNZXRob2Qg\nbWV0aCA9IGJjLmRlY2xhcmVNZXRob2QoIm5ld0VtYmVkZGVkUENEYXRhIiwg\nUENEYXRhLmNsYXNzLAogICAgICAgICAgICBuZXcgQ2xhc3NbXXsgT3BlbkpQ\nQVN0YXRlTWFuYWdlci5jbGFzcyB9KTsKICAgICAgICBDb2RlIGNvZGUgPSBt\nZXRoLmdldENvZGUodHJ1ZSk7CiAgICAgICAgLy8gcmV0dXJuIGdldFN0b3Jh\nZ2VHZW5lcmF0b3IoKS5nZW5lcmF0ZVBDRGF0YQogICAgICAgIC8vIAkJKHNt\nLmdldElkKCksIHNtLmdldE1ldGFEYXRhKCkpOwogICAgICAgIGNvZGUuYWxv\nYWQoKS5zZXRUaGlzKCk7CiAgICAgICAgY29kZS5nZXRmaWVsZCgpLnNldEZp\nZWxkKCJzdG9yYWdlR2VuZXJhdG9yIiwgUENEYXRhR2VuZXJhdG9yLmNsYXNz\nKTsKICAgICAgICBjb2RlLmFsb2FkKCkuc2V0UGFyYW0oMCk7CiAgICAgICAg\nY29kZS5pbnZva2VpbnRlcmZhY2UoKS5zZXRNZXRob2QoT3BlbkpQQVN0YXRl\nTWFuYWdlci5jbGFzcywKICAgICAgICAgICAgImdldElkIiwgT2JqZWN0LmNs\nYXNzLCBudWxsKTsKICAgICAgICBjb2RlLmFsb2FkKCkuc2V0UGFyYW0oMCk7\nCiAgICAgICAgY29kZS5pbnZva2VpbnRlcmZhY2UoKS5zZXRNZXRob2QoT3Bl\nbkpQQVN0YXRlTWFuYWdlci5jbGFzcywKICAgICAgICAgICAgImdldE1ldGFE\nYXRhIiwgQ2xhc3NNZXRhRGF0YS5jbGFzcywgbnVsbCk7CiAgICAgICAgY29k\nZS5pbnZva2V2aXJ0dWFsKCkuc2V0TWV0aG9kKFBDRGF0YUdlbmVyYXRvci5j\nbGFzcywKICAgICAgICAgICAgImdlbmVyYXRlUENEYXRhIiwgUENEYXRhLmNs\nYXNzLCBuZXcgQ2xhc3NbXQogICAgICAgICAgICB7IE9iamVjdC5jbGFzcywg\nQ2xhc3NNZXRhRGF0YS5jbGFzcyB9KTsKICAgICAgICBjb2RlLmFyZXR1cm4o\nKTsKICAgICAgICBjb2RlLmNhbGN1bGF0ZU1heExvY2FscygpOwogICAgICAg\nIGNvZGUuY2FsY3VsYXRlTWF4U3RhY2soKTsKICAgIH0KCiAgICBwcml2YXRl\nIHZvaWQgYWRkR2V0RGF0YShCQ0NsYXNzIGJjKSB7CiAgICAgICAgLy8gcmV0\ndXJuIGdldE9iamVjdEZpZWxkKGkpOwogICAgICAgIEJDTWV0aG9kIG1ldGhv\nZCA9IGJjLmRlY2xhcmVNZXRob2QoImdldERhdGEiLCBPYmplY3QuY2xhc3Ms\nCiAgICAgICAgICAgIG5ldyBDbGFzc1tdeyBpbnQuY2xhc3MgfSk7CiAgICAg\nICAgQ29kZSBjb2RlID0gbWV0aG9kLmdldENvZGUodHJ1ZSk7CiAgICAgICAg\nY29kZS5hbG9hZCgpLnNldFRoaXMoKTsKICAgICAgICBjb2RlLmlsb2FkKCku\nc2V0UGFyYW0oMCk7CiAgICAgICAgY29kZS5pbnZva2V2aXJ0dWFsKCkuc2V0\nTWV0aG9kKCJnZXRPYmplY3QiLCBPYmplY3QuY2xhc3MsCiAgICAgICAgICAg\nIG5ldyBDbGFzc1tdeyBpbnQuY2xhc3MgfSk7CiAgICAgICAgY29kZS5hcmV0\ndXJuKCk7CiAgICAgICAgY29kZS5jYWxjdWxhdGVNYXhMb2NhbHMoKTsKICAg\nICAgICBjb2RlLmNhbGN1bGF0ZU1heFN0YWNrKCk7CiAgICB9CgogICAgLy8v\nLy8vLy8vLy8vLwogICAgLy8gVXRpbGl0aWVzCiAgICAvLy8vLy8vLy8vLy8v\nCgogICAgLyoqCiAgICAgKiBSZXR1cm4gYSB2YWxpZCB7QGxpbmsgSmF2YVR5\ncGVzfSBjb25zdGFudCBmb3IgdGhlIGdpdmVuIGZpZWxkCiAgICAgKi8KICAg\nIHByb3RlY3RlZCBpbnQgcmVwbGFjZVR5cGUoRmllbGRNZXRhRGF0YSBmbWQp\nIHsKICAgICAgICBpZiAodXNlc0ludGVybWVkaWF0ZShmbWQpKQogICAgICAg\nICAgICByZXR1cm4gSmF2YVR5cGVzLk9CSkVDVDsKICAgICAgICByZXR1cm4g\nZm1kLmdldFR5cGVDb2RlKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBXaGV0\naGVyIHRoZSBnaXZlbiBmaWVsZCB1c2VzIGEgY2FjaGVhYmxlIGludGVybWVk\naWF0ZSB2YWx1ZS4KICAgICAqLwogICAgcHJvdGVjdGVkIGJvb2xlYW4gdXNl\nc0ludGVybWVkaWF0ZShGaWVsZE1ldGFEYXRhIGZtZCkgewogICAgICAgIHJl\ndHVybiBmbWQudXNlc0ludGVybWVkaWF0ZSgpOwogICAgfQoKICAgIC8qKgog\nICAgICogV2hldGhlciB0aGUgZ2l2ZW4gdHlwZSBtaWdodCBoYXZlIGNhY2hl\nYWJsZSBjbGFzcy1sZXZlbCBpbXBsIGRhdGEuCiAgICAgKi8KICAgIHByb3Rl\nY3RlZCBib29sZWFuIHVzZXNJbXBsRGF0YShDbGFzc01ldGFEYXRhIG1ldGEp\nIHsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvKioKICAgICAq\nIFdoZXRoZXIgdGhlIGdpdmVuIGZpZWxkIG1pZ2h0IGhhdmUgY2FjaGVhYmxl\nIGltcGwgZGF0YS4KICAgICAqLwogICAgcHJvdGVjdGVkIGJvb2xlYW4gdXNl\nc0ltcGxEYXRhKEZpZWxkTWV0YURhdGEgZm1kKSB7CiAgICAgICAgcmV0dXJu\nIGZtZC51c2VzSW1wbERhdGEoKSA9PSBudWxsOwogICAgfQoKICAgIC8qKgog\nICAgICogVGhlIG51bWJlciBvZiBmaWVsZHMgd2l0aCBjYWNoZWFibGUgaW1w\nbCBkYXRhLgogICAgICovCiAgICBwcml2YXRlIGludCBjb3VudEltcGxEYXRh\nRmllbGRzKENsYXNzTWV0YURhdGEgbWV0YSkgewogICAgICAgIEZpZWxkTWV0\nYURhdGFbXSBmbWRzID0gbWV0YS5nZXRGaWVsZHMoKTsKICAgICAgICBpbnQg\nY291bnQgPSAwOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgZm1kcy5s\nZW5ndGg7IGkrKykKICAgICAgICAgICAgaWYgKHVzZXNJbXBsRGF0YShmbWRz\nW2ldKSkKICAgICAgICAgICAgICAgIGNvdW50Kys7CiAgICAgICAgcmV0dXJu\nIGNvdW50OwogICAgfQoKICAgIC8qKgogICAgICogQWRkIG1ldGhvZCB3aGlj\naCBkZWZlcnMgdG8gQWJzdHJhY3RQQ0RhdGEuCiAgICAgKi8KICAgIHByb3Rl\nY3RlZCB2b2lkIGNhbGxBYnN0cmFjdFBDRGF0YShCQ0NsYXNzIGJjLCBTdHJp\nbmcgbmFtZSwgQ2xhc3MgcmV0VHlwZSwKICAgICAgICBDbGFzc1tdIGFyZ3Mp\nIHsKICAgICAgICBCQ01ldGhvZCBtZXRoID0gYmMuZGVjbGFyZU1ldGhvZChu\nYW1lLCByZXRUeXBlLCBhcmdzKTsKICAgICAgICBDb2RlIGNvZGUgPSBtZXRo\nLmdldENvZGUodHJ1ZSk7CiAgICAgICAgY29kZS5hbG9hZCgpLnNldFRoaXMo\nKTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGFyZ3MubGVuZ3RoOyBp\nKyspCiAgICAgICAgICAgIGNvZGUueGxvYWQoKS5zZXRQYXJhbShpKS5zZXRU\neXBlKGFyZ3NbaV0pOwogICAgICAgIGNvZGUuaW52b2tldmlydHVhbCgpLnNl\ndE1ldGhvZChBYnN0cmFjdFBDRGF0YS5jbGFzcywgbmFtZSwgcmV0VHlwZSwK\nICAgICAgICAgICAgYXJncyk7CiAgICAgICAgaWYgKCF2b2lkLmNsYXNzLmVx\ndWFscyhyZXRUeXBlKSkKICAgICAgICAgICAgY29kZS54cmV0dXJuKCkuc2V0\nVHlwZShyZXRUeXBlKTsKICAgICAgICBjb2RlLmNhbGN1bGF0ZU1heExvY2Fs\ncygpOwogICAgICAgIGNvZGUuY2FsY3VsYXRlTWF4U3RhY2soKTsKICAgIH0K\nCiAgICAvKioKICAgICAqIFNldCB0aGUgY29sbGVjdGlvbiBvZiB7QGxpbmsg\nSnVtcEluc3RydWN0aW9ufXMgdG8gdGhlIGdpdmVuIGluc3RydWN0aW9uLAog\nICAgICogY2xlYXJpbmcgdGhlIGNvbGxlY3Rpb24gaW4gdGhlIHByb2Nlc3Mu\nCiAgICAgKi8KICAgIHByb3RlY3RlZCB2b2lkIHNldFRhcmdldChJbnN0cnVj\ndGlvbiBpbnMsIENvbGxlY3Rpb24ganVtcHMpIHsKICAgICAgICBmb3IgKEl0\nZXJhdG9yIGl0ID0ganVtcHMuaXRlcmF0b3IoKTsgaXQuaGFzTmV4dCgpOykK\nICAgICAgICAgICAgKChKdW1wSW5zdHJ1Y3Rpb24pIGl0Lm5leHQoKSkuc2V0\nVGFyZ2V0KGlucyk7CiAgICAgICAganVtcHMuY2xlYXIoKTsKICAgIH0KCiAg\nICAvKioKICAgICAqIFRyYW5zZm9ybSB0aGUgZ2l2ZW4gYXJyYXkgb2YgY2xh\nc3NlcyB0byBzdHJpbmdzLgogICAgICovCiAgICBwcml2YXRlIHN0YXRpYyBT\ndHJpbmdbXSB0b1N0cmluZ3MoQ2xhc3NbXSBjbHMpIHsKICAgICAgICBTdHJp\nbmdbXSBzdHJpbmdzID0gbmV3IFN0cmluZ1tjbHMubGVuZ3RoXTsKICAgICAg\nICBmb3IgKGludCBpID0gMDsgaSA8IHN0cmluZ3MubGVuZ3RoOyBpKyspCiAg\nICAgICAgICAgIHN0cmluZ3NbaV0gPSBjbHNbaV0uZ2V0TmFtZSgpOwogICAg\nICAgIHJldHVybiBzdHJpbmdzOwogICAgfQoKICAgIC8qKgogICAgICogRHlu\nYW1pYyB7QGxpbmsgUENEYXRhfXMgZ2VuZXJhdGVkIHdpbGwgaW1wbGVtZW50\nIHRoaXMgaW50ZXJmYWNlCiAgICAgKiB0byBzaW1wbGlmeSBpbml0aWFsaXph\ndGlvbi4KICAgICAqLwogICAgcHVibGljIHN0YXRpYyBpbnRlcmZhY2UgRHlu\nYW1pY1BDRGF0YSBleHRlbmRzIFBDRGF0YSB7CgogICAgICAgIHB1YmxpYyB2\nb2lkIHNldElkKE9iamVjdCBvaWQpOwoKICAgICAgICBwdWJsaWMgUENEYXRh\nR2VuZXJhdG9yIGdldFN0b3JhZ2VHZW5lcmF0b3IoKTsKCiAgICAgICAgcHVi\nbGljIHZvaWQgc2V0U3RvcmFnZUdlbmVyYXRvciAoUENEYXRhR2VuZXJhdG9y\nIGdlbmVyYXRvcik7Cgl9Cn0K\n","encoding":"base64"}

