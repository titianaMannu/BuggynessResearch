{"sha":"fa825746fd4de9ca83cdea430105cccf24e4c8ab","node_id":"MDQ6QmxvYjIwNjM2NDpmYTgyNTc0NmZkNGRlOWNhODNjZGVhNDMwMTA1Y2NjZjI0ZTRjOGFi","size":11045,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/fa825746fd4de9ca83cdea430105cccf24e4c8ab","content":"LyoNCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUNCiAqIG9yIG1vcmUgY29udHJpYnV0b3Ig\nbGljZW5zZSBhZ3JlZW1lbnRzLiAgU2VlIHRoZSBOT1RJQ0UgZmlsZQ0KICog\nZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5m\nb3JtYXRpb24NCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAg\nVGhlIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUNCiAqIHRvIHlvdSB1bmRlciB0\naGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUNCiAqICJMaWNl\nbnNlIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNv\nbXBsaWFuY2UNCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFp\nbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQNCiAqDQogKiBodHRwOi8vd3d3\nLmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjANCiAqDQogKiBVbmxl\nc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGlu\nIHdyaXRpbmcsDQogKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUg\nTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbg0KICogIkFTIElTIiBCQVNJ\nUywgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZDQog\nKiBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBM\naWNlbnNlIGZvciB0aGUNCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmlu\nZyBwZXJtaXNzaW9ucyBhbmQgbGltaXRhdGlvbnMNCiAqIHVuZGVyIHRoZSBM\naWNlbnNlLg0KICovDQpwYWNrYWdlIG9yZy5hcGFjaGUub3BlbmpwYS5lbmhh\nbmNlOw0KDQppbXBvcnQgamF2YS5sYW5nLnJlZmxlY3QuTW9kaWZpZXI7DQpp\nbXBvcnQgamF2YS5sYW5nLnJlZmxlY3QuQ29uc3RydWN0b3I7DQppbXBvcnQg\namF2YS5sYW5nLnJlZmxlY3QuTWV0aG9kOw0KaW1wb3J0IGphdmEudXRpbC5B\ncnJheUxpc3Q7DQppbXBvcnQgamF2YS51dGlsLkNvbGxlY3Rpb247DQoNCmlt\ncG9ydCBvcmcuYXBhY2hlLmNvbW1vbnMubGFuZy5TdHJpbmdVdGlsczsNCmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YS5DbGFzc01ldGFEYXRhOw0K\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRhLkZpZWxkTWV0YURhdGE7\nDQppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuVXNlckV4Y2VwdGlv\nbjsNCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5JbnRlcm5hbEV4\nY2VwdGlvbjsNCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwu\nTG9jYWxpemVyOw0KaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIudXRp\nbC5Mb2NhbGl6ZXIuTWVzc2FnZTsNCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEubGliLmxvZy5Mb2c7DQppbXBvcnQgc2VycC5ieXRlY29kZS5CQ0ZpZWxk\nOw0KaW1wb3J0IHNlcnAuYnl0ZWNvZGUuQkNDbGFzczsNCmltcG9ydCBzZXJw\nLmJ5dGVjb2RlLkJDTWV0aG9kOw0KDQovKioNCiAqCTxwPlZhbGlkYXRlcyB0\naGF0IGEgZ2l2ZW4gdHlwZSBtZWV0cyB0aGUgSlBBIGNvbnRyYWN0LCBwbHVz\nIGEgZmV3DQogKiAgT3BlbkpQQS1zcGVjaWZpYyBhZGRpdGlvbnMgZm9yIHN1\nYmNsYXNzaW5nIC8gcmVkZWZpbml0aW9uOg0KICoNCiAqCTx1bD4NCiAqIAkJ\nPGxpPm11c3QgaGF2ZSBhbiBhY2Nlc3NpYmxlIG5vLWFyZ3MgY29uc3RydWN0\nb3I8L2xpPg0KICogCQk8bGk+bXVzdCBiZSBhIHB1YmxpYyBvciBwcm90ZWN0\nZWQgY2xhc3M8L2xpPg0KICogCQk8bGk+bXVzdCBub3QgYmUgZmluYWw8L2xp\nPg0KICogCQk8bGk+bXVzdCBub3QgZXh0ZW5kIGFuIGVuaGFuY2VkIGNsYXNz\nPC9saT4NCiAqCQk8bGk+YWxsIHBlcnNpc3RlbnQgZGF0YSByZXByZXNlbnRl\nZCBieSBhY2Nlc3NpYmxlIHNldHRlci9nZXR0ZXINCiAqIAkJCW1ldGhvZHMg\nKHBlcnNpc3RlbnQgcHJvcGVydGllcyk8L2xpPg0KICogCQk8bGk+aWYgdmVy\nc2lvbmluZyBpcyB0byBiZSB1c2VkLCBleGFjdGx5IG9uZSBwZXJzaXN0ZW50\nIHByb3BlcnR5IGZvcg0KICogCQkJdGhlIG51bWVyaWMgdmVyc2lvbiBkYXRh\nPC9saT4gPCEtLSAjIyMjIyBpcyB0aGlzIHRydWU/IC0tPg0KICoNCiAqIAkJ\nPGxpPldoZW4gdXNpbmcgcHJvcGVydHkgYWNjZXNzLCB0aGUgYmFja2luZyBm\naWVsZCBmb3IgYSBwZXJzaXN0ZW50DQogKiAgICAgICAgICBwcm9wZXJ0eSBt\ndXN0IGJlOg0KICogCQkJPHVsPg0KICogCQkJCTwhLS0gIyMjIyMgSlBBIHZh\nbGlkYXRpb24gb2YgdGhlc2UgbmVlZHMgdG8gYmUgdGVzdGVkIC0tPg0KICog\nCQkJCTxsaT5wcml2YXRlPC9saT4NCiAqIAkJCQk8bGk+c2V0IG9ubHkgaW4g\ndGhlIGRlc2lnbmF0ZWQgc2V0dGVyLA0KICogCQkJCQlpbiB0aGUgY29uc3Ry\ndWN0b3IsIG9yIGluIHtAbGluayBPYmplY3QjY2xvbmUoKX0sDQogKiAJCQkJ\nCTxjb2RlPnJlYWRPYmplY3QoT2JqZWN0SW5wdXRTdHJlYW0pPC9jb2RlPiwg\nb3INCiAqIAkJCQkJe0BsaW5rIEV4dGVybmFsaXphYmxlI3JlYWRFeHRlcm5h\nbChPYmplY3RJbnB1dCl9LjwvbGk+DQogKiAJCQkJPGxpPnJlYWQgb25seSBp\nbiB0aGUgZGVzaWduYXRlZCBnZXR0ZXIgYW5kIHRoZQ0KICogCQkJCQljb25z\ndHJ1Y3Rvci48L2xpPg0KICoJCQk8L3VsPg0KICogCQk8L2xpPg0KICogCTwv\ndWw+DQogKg0KICogCTxwPklmIHlvdSB1c2UgdGhpcyB0ZWNobmlxdWUgYW5k\nIHVzZSB0aGUgPGNvZGU+bmV3PC9jb2RlPiBrZXl3b3JkIGluc3RlYWQgb2YN\nCiAqIAlhIE9wZW5KUEEtc3VwcGxpZWQgY29uc3RydWN0aW9uIHJvdXRpbmUs\nIE9wZW5KUEEgd2lsbCBuZWVkIHRvIGRvIGV4dHJhIHdvcmsNCiAqICB3aXRo\nIHBlcnNpc3RlbnQtbmV3LWZsdXNoZWQgaW5zdGFuY2VzLCBzaW5jZSBPcGVu\nSlBBIGNhbm5vdCBpbiB0aGlzIGNhc2UNCiAqICB0cmFjayB3aGF0IGhhcHBl\nbnMgdG8gc3VjaCBhbiBpbnN0YW5jZS48L3A+DQogKg0KICogCUBzaW5jZSAx\nLjAuMA0KICovDQpwdWJsaWMgY2xhc3MgUENTdWJjbGFzc1ZhbGlkYXRvciB7\nDQoNCiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBMb2NhbGl6ZXIgbG9jID0N\nCiAgICAgICAgTG9jYWxpemVyLmZvclBhY2thZ2UoUENTdWJjbGFzc1ZhbGlk\nYXRvci5jbGFzcyk7DQoNCiAgICBwcml2YXRlIGZpbmFsIENsYXNzTWV0YURh\ndGEgbWV0YTsNCiAgICBwcml2YXRlIGZpbmFsIEJDQ2xhc3MgcGM7DQogICAg\ncHJpdmF0ZSBmaW5hbCBMb2cgbG9nOw0KICAgIHByaXZhdGUgZmluYWwgYm9v\nbGVhbiBmYWlsT25Db250cmFjdFZpb2xhdGlvbnM7DQoNCiAgICBwcml2YXRl\nIENvbGxlY3Rpb24gZXJyb3JzOw0KICAgIHByaXZhdGUgQ29sbGVjdGlvbiBj\nb250cmFjdFZpb2xhdGlvbnM7DQoNCiAgICBwdWJsaWMgUENTdWJjbGFzc1Zh\nbGlkYXRvcihDbGFzc01ldGFEYXRhIG1ldGEsIEJDQ2xhc3MgYmMsIExvZyBs\nb2csDQogICAgICAgIGJvb2xlYW4gZW5mb3JjZUNvbnRyYWN0VmlvbGF0aW9u\ncykgew0KICAgICAgICB0aGlzLm1ldGEgPSBtZXRhOw0KICAgICAgICB0aGlz\nLnBjID0gYmM7DQogICAgICAgIHRoaXMubG9nID0gbG9nOw0KICAgICAgICB0\naGlzLmZhaWxPbkNvbnRyYWN0VmlvbGF0aW9ucyA9IGVuZm9yY2VDb250cmFj\ndFZpb2xhdGlvbnM7DQogICAgfQ0KDQogICAgcHVibGljIHZvaWQgYXNzZXJ0\nQ2FuU3ViY2xhc3MoKSB7DQogICAgICAgIENsYXNzIHN1cGVyY2xhc3MgPSBt\nZXRhLmdldERlc2NyaWJlZFR5cGUoKTsNCiAgICAgICAgU3RyaW5nIG5hbWUg\nPSBzdXBlcmNsYXNzLmdldE5hbWUoKTsNCiAgICAgICAgaWYgKHN1cGVyY2xh\nc3MuaXNJbnRlcmZhY2UoKSkNCiAgICAgICAgICAgIGFkZEVycm9yKGxvYy5n\nZXQoInN1YmNsYXNzZXItbm8taWZhY2VzIiwgbmFtZSksIG1ldGEpOw0KICAg\nICAgICBpZiAoTW9kaWZpZXIuaXNGaW5hbChzdXBlcmNsYXNzLmdldE1vZGlm\naWVycygpKSkNCiAgICAgICAgICAgIGFkZEVycm9yKGxvYy5nZXQoInN1YmNs\nYXNzZXItbm8tZmluYWwtY2xhc3NlcyIsIG5hbWUpLCBtZXRhKTsNCiAgICAg\nICAgaWYgKE1vZGlmaWVyLmlzUHJpdmF0ZShzdXBlcmNsYXNzLmdldE1vZGlm\naWVycygpKSkNCiAgICAgICAgICAgIGFkZEVycm9yKGxvYy5nZXQoInN1YmNs\nYXNzZXItbm8tcHJpdmF0ZS1jbGFzc2VzIiwgbmFtZSksIG1ldGEpOw0KICAg\nICAgICBpZiAoUGVyc2lzdGVuY2VDYXBhYmxlLmNsYXNzLmlzQXNzaWduYWJs\nZUZyb20oc3VwZXJjbGFzcykpDQogICAgICAgICAgICBhZGRFcnJvcihsb2Mu\nZ2V0KCJzdWJjbGFzc2VyLXN1cGVyLWFscmVhZHktcGMiLCBuYW1lKSwgbWV0\nYSk7DQoNCiAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgIENvbnN0cnVjdG9y\nIGMgPSBzdXBlcmNsYXNzLmdldERlY2xhcmVkQ29uc3RydWN0b3IobmV3IENs\nYXNzWzBdKTsNCiAgICAgICAgICAgIGlmICghKE1vZGlmaWVyLmlzUHJvdGVj\ndGVkKGMuZ2V0TW9kaWZpZXJzKCkpDQogICAgICAgICAgICAgICAgfHwgTW9k\naWZpZXIuaXNQdWJsaWMoYy5nZXRNb2RpZmllcnMoKSkpKQ0KICAgICAgICAg\nICAgICAgIGFkZEVycm9yKGxvYy5nZXQoInN1YmNsYXNzZXItcHJpdmF0ZS1j\ndG9yIiwgbmFtZSksIG1ldGEpOw0KICAgICAgICB9DQogICAgICAgIGNhdGNo\nIChOb1N1Y2hNZXRob2RFeGNlcHRpb24gZSkgew0KICAgICAgICAgICAgYWRk\nRXJyb3IobG9jLmdldCgic3ViY2xhc3Nlci1uby12b2lkLWN0b3IiLCBuYW1l\nKSwNCiAgICAgICAgICAgICAgICBtZXRhKTsNCiAgICAgICAgfQ0KDQogICAg\nICAgIC8vIGlmIHRoZSBCQ0NsYXNzIHdlIGxvYWRlZCBpcyBhbHJlYWR5IHBj\nIGFuZCB0aGUgc3VwZXJjbGFzcyBpcyBub3QsDQogICAgICAgIC8vIHRoZW4g\nd2Ugc2hvdWxkIG5ldmVyIGdldCBoZXJlLCBzbyBsZXQncyBtYWtlIHN1cmUg\ndGhhdCB0aGUNCiAgICAgICAgLy8gY2FsbGluZyBjb250ZXh0IGlzIGNhY2hp\nbmcgY29ycmVjdGx5IGJ5IHRocm93aW5nIGFuIGV4Y2VwdGlvbi4NCiAgICAg\nICAgaWYgKHBjLmlzSW5zdGFuY2VPZihQZXJzaXN0ZW5jZUNhcGFibGUuY2xh\nc3MpICYmDQogICAgICAgICAgICAhUGVyc2lzdGVuY2VDYXBhYmxlLmNsYXNz\nLmlzQXNzaWduYWJsZUZyb20oc3VwZXJjbGFzcykpDQogICAgICAgICAgICB0\naHJvdyBuZXcgSW50ZXJuYWxFeGNlcHRpb24oDQogICAgICAgICAgICAgICAg\nbG9jLmdldCgic3ViY2xhc3Nlci1jbGFzcy1hbHJlYWR5LXBjIiwgbmFtZSkp\nOw0KDQogICAgICAgIGlmIChtZXRhLmdldEFjY2Vzc1R5cGUoKSA9PSBDbGFz\nc01ldGFEYXRhLkFDQ0VTU19QUk9QRVJUWSkNCiAgICAgICAgICAgIGNoZWNr\nUHJvcGVydGllc0FyZUludGVyY2VwdGFibGUoKTsNCg0KICAgICAgICBpZiAo\nZXJyb3JzICE9IG51bGwgJiYgIWVycm9ycy5pc0VtcHR5KCkpDQogICAgICAg\nICAgICB0aHJvdyBuZXcgVXNlckV4Y2VwdGlvbihlcnJvcnMudG9TdHJpbmco\nKSk7DQogICAgICAgIGVsc2UgaWYgKGNvbnRyYWN0VmlvbGF0aW9ucyAhPSBu\ndWxsICYmDQogICAgICAgICAgICAhY29udHJhY3RWaW9sYXRpb25zLmlzRW1w\ndHkoKSAmJiBsb2cuaXNXYXJuRW5hYmxlZCgpKQ0KICAgICAgICAgICAgbG9n\nLndhcm4oY29udHJhY3RWaW9sYXRpb25zLnRvU3RyaW5nKCkpOw0KICAgIH0N\nCg0KICAgIHByaXZhdGUgdm9pZCBjaGVja1Byb3BlcnRpZXNBcmVJbnRlcmNl\ncHRhYmxlKCkgew0KICAgICAgICAvLyBqdXN0IGNvbnNpZGVycyBhY2Nlc3Nv\nciBtZXRob2RzIGZvciBub3cuDQogICAgICAgIEZpZWxkTWV0YURhdGFbXSBm\nbWRzID0gbWV0YS5nZXRGaWVsZHMoKTsNCiAgICAgICAgZm9yIChpbnQgaSA9\nIDA7IGkgPCBmbWRzLmxlbmd0aDsgaSsrKSB7DQogICAgICAgICAgICBNZXRo\nb2QgZ2V0dGVyID0gKE1ldGhvZCkgZm1kc1tpXS5nZXRCYWNraW5nTWVtYmVy\nKCk7DQogICAgICAgICAgICBpZiAoZ2V0dGVyID09IG51bGwpIHsNCiAgICAg\nICAgICAgICAgICBhZGRFcnJvcihsb2MuZ2V0KCJzdWJjbGFzc2VyLW5vLWdl\ndHRlciIsDQogICAgICAgICAgICAgICAgICAgIGZtZHNbaV0uZ2V0TmFtZSgp\nKSwgZm1kc1tpXSk7DQogICAgICAgICAgICAgICAgY29udGludWU7DQogICAg\nICAgICAgICB9DQogICAgICAgICAgICBCQ0ZpZWxkIHJldHVybmVkRmllbGQg\nPSBjaGVja0dldHRlcklzU3ViY2xhc3NhYmxlKGdldHRlciwgZm1kc1tpXSk7\nDQoNCiAgICAgICAgICAgIE1ldGhvZCBzZXR0ZXIgPSBzZXR0ZXJGb3JGaWVs\nZChmbWRzW2ldKTsNCiAgICAgICAgICAgIGlmIChzZXR0ZXIgPT0gbnVsbCkg\new0KICAgICAgICAgICAgICAgIGFkZEVycm9yKGxvYy5nZXQoInN1YmNsYXNz\nZXItbm8tc2V0dGVyIiwgZm1kc1tpXS5nZXROYW1lKCkpLA0KICAgICAgICAg\nICAgICAgICAgICBmbWRzW2ldKTsNCiAgICAgICAgICAgICAgICBjb250aW51\nZTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIEJDRmllbGQgYXNzaWdu\nZWRGaWVsZCA9IGNoZWNrU2V0dGVySXNTdWJjbGFzc2FibGUoc2V0dGVyLCBm\nbWRzW2ldKTsNCiAgICAgICAgICAgIGlmIChhc3NpZ25lZEZpZWxkID09IG51\nbGwpDQogICAgICAgICAgICAgICAgY29udGludWU7DQoNCiAgICAgICAgICAg\nIGlmIChhc3NpZ25lZEZpZWxkICE9IHJldHVybmVkRmllbGQpDQogICAgICAg\nICAgICAgICAgYWRkQ29udHJhY3RWaW9sYXRpb24obG9jLmdldA0KICAgICAg\nICAgICAgICAgICAgICAoInN1YmNsYXNzZXItc2V0dGVyLWdldHRlci1maWVs\nZC1taXNtYXRjaCIsDQogICAgICAgICAgICAgICAgICAgICAgICBmbWRzW2ld\nLmdldE5hbWUoKSwgcmV0dXJuZWRGaWVsZCxhc3NpZ25lZEZpZWxkKSwNCiAg\nICAgICAgICAgICAgICAgICAgZm1kc1tpXSk7DQoNCiAgICAgICAgICAgIC8v\nICMjIyBzY2FuIHRocm91Z2ggYWxsIHRoZSByZXN0IG9mIHRoZSBjbGFzcyB0\nbyBtYWtlIHN1cmUgaXQNCiAgICAgICAgICAgIC8vICMjIyBkb2Vzbid0IHVz\nZSB0aGUgZmllbGQuDQogICAgICAgIH0NCiAgICB9DQoNCiAgICBwcml2YXRl\nIE1ldGhvZCBzZXR0ZXJGb3JGaWVsZChGaWVsZE1ldGFEYXRhIGZtZCkgew0K\nICAgICAgICB0cnkgew0KICAgICAgICAgICAgcmV0dXJuIGZtZC5nZXREZWNs\nYXJpbmdUeXBlKCkuZ2V0RGVjbGFyZWRNZXRob2QoDQogICAgICAgICAgICAg\nICAgInNldCIgKyBTdHJpbmdVdGlscy5jYXBpdGFsaXplKGZtZC5nZXROYW1l\nKCkpLA0KICAgICAgICAgICAgICAgIG5ldyBDbGFzc1tdeyBmbWQuZ2V0RGVj\nbGFyZWRUeXBlKCkgfSk7DQogICAgICAgIH0NCiAgICAgICAgY2F0Y2ggKE5v\nU3VjaE1ldGhvZEV4Y2VwdGlvbiBlKSB7DQogICAgICAgICAgICByZXR1cm4g\nbnVsbDsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIEBy\nZXR1cm4gdGhlIG5hbWUgb2YgdGhlIGZpZWxkIHRoYXQgaXMgcmV0dXJuZWQg\nYnkgPGNvZGU+bWV0aDwvY29kZT4sIG9yDQogICAgICogICAgICAgICA8Y29k\nZT5udWxsPC9jb2RlPiBpZiBzb21ldGhpbmcgb3RoZXIgdGhhbiBhIHNpbmds\nZSBmaWVsZCBpcw0KICAgICAqICAgICAgICAgcmV0dXJuZWQsIG9yIGlmIGl0\nIGNhbm5vdCBiZSBkZXRlcm1pbmVkIHdoYXQgaXMgcmV0dXJuZWQuDQogICAg\nICovDQogICAgcHJpdmF0ZSBCQ0ZpZWxkIGNoZWNrR2V0dGVySXNTdWJjbGFz\nc2FibGUoTWV0aG9kIG1ldGgsIEZpZWxkTWV0YURhdGEgZm1kKSB7DQogICAg\nICAgIGNoZWNrTWV0aG9kSXNTdWJjbGFzc2FibGUobWV0aCwgZm1kKTsNCiAg\nICAgICAgQkNGaWVsZCBmaWVsZCA9IFBDRW5oYW5jZXIuZ2V0UmV0dXJuZWRG\naWVsZChnZXRCQ01ldGhvZChtZXRoKSk7DQogICAgICAgIGlmIChmaWVsZCA9\nPSBudWxsKSB7DQogICAgICAgICAgICBhZGRDb250cmFjdFZpb2xhdGlvbihs\nb2MuZ2V0KCJzdWJjbGFzc2VyLWludmFsaWQtZ2V0dGVyIiwNCiAgICAgICAg\nICAgICAgICBmbWQuZ2V0TmFtZSgpKSwgZm1kKTsNCiAgICAgICAgICAgIHJl\ndHVybiBudWxsOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgcmV0\ndXJuIGZpZWxkOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgLyoqDQogICAg\nICogQHJldHVybiB0aGUgZmllbGQgdGhhdCBpcyBzZXQgaW4gPGNvZGU+bWV0\naDwvY29kZT4sIG9yDQogICAgICogICAgICAgICA8Y29kZT5udWxsPC9jb2Rl\nPiBpZiBzb21ldGhpbmcgb3RoZXIgdGhhbiBhIHNpbmdsZSBmaWVsZCBpcw0K\nICAgICAqICAgICAgICAgc2V0LCBvciBpZiBpdCBjYW5ub3QgYmUgZGV0ZXJt\naW5lZCB3aGF0IGlzIHNldC4NCiAgICAgKi8NCiAgICBwcml2YXRlIEJDRmll\nbGQgY2hlY2tTZXR0ZXJJc1N1YmNsYXNzYWJsZShNZXRob2QgbWV0aCwgRmll\nbGRNZXRhRGF0YSBmbWQpIHsNCiAgICAgICAgY2hlY2tNZXRob2RJc1N1YmNs\nYXNzYWJsZShtZXRoLCBmbWQpOw0KICAgICAgICBCQ0ZpZWxkIGZpZWxkID0g\nUENFbmhhbmNlci5nZXRBc3NpZ25lZEZpZWxkKGdldEJDTWV0aG9kKG1ldGgp\nKTsNCiAgICAgICAgaWYgKGZpZWxkID09IG51bGwpIHsNCiAgICAgICAgICAg\nIGFkZENvbnRyYWN0VmlvbGF0aW9uKGxvYy5nZXQoInN1YmNsYXNzZXItaW52\nYWxpZC1zZXR0ZXIiLA0KICAgICAgICAgICAgICAgIGZtZC5nZXROYW1lKCkp\nLCBmbWQpOw0KICAgICAgICAgICAgcmV0dXJuIG51bGw7DQogICAgICAgIH0g\nZWxzZSB7DQogICAgICAgICAgICByZXR1cm4gZmllbGQ7DQogICAgICAgIH0N\nCiAgICB9DQoNCiAgICBwcml2YXRlIEJDTWV0aG9kIGdldEJDTWV0aG9kKE1l\ndGhvZCBtZXRoKSB7DQogICAgICAgIEJDQ2xhc3MgYmMgPSBwYy5nZXRQcm9q\nZWN0KCkubG9hZENsYXNzKG1ldGguZ2V0RGVjbGFyaW5nQ2xhc3MoKSk7DQog\nICAgICAgIHJldHVybiBiYy5nZXREZWNsYXJlZE1ldGhvZChtZXRoLmdldE5h\nbWUoKSwgbWV0aC5nZXRQYXJhbWV0ZXJUeXBlcygpKTsNCiAgICB9DQoNCiAg\nICBwcml2YXRlIHZvaWQgY2hlY2tNZXRob2RJc1N1YmNsYXNzYWJsZShNZXRo\nb2QgbWV0aCwgRmllbGRNZXRhRGF0YSBmbWQpIHsNCiAgICAgICAgU3RyaW5n\nIGNsYXNzTmFtZSA9IGZtZC5nZXREZWZpbmluZ01ldGFEYXRhKCkuDQogICAg\nICAgICAgICBnZXREZXNjcmliZWRUeXBlKCkuZ2V0TmFtZSgpOw0KICAgICAg\nICBpZiAoIShNb2RpZmllci5pc1Byb3RlY3RlZChtZXRoLmdldE1vZGlmaWVy\ncygpKQ0KICAgICAgICAgICAgfHwgTW9kaWZpZXIuaXNQdWJsaWMobWV0aC5n\nZXRNb2RpZmllcnMoKSkpKQ0KICAgICAgICAgICAgYWRkRXJyb3IobG9jLmdl\ndCgic3ViY2xhc3Nlci1wcml2YXRlLWFjY2Vzc29ycy11bnN1cHBvcnRlZCIs\nDQogICAgICAgICAgICAgICAgY2xhc3NOYW1lLCBtZXRoLmdldE5hbWUoKSks\nIGZtZCk7DQogICAgICAgIGlmIChNb2RpZmllci5pc0ZpbmFsKG1ldGguZ2V0\nTW9kaWZpZXJzKCkpKQ0KICAgICAgICAgICAgYWRkRXJyb3IobG9jLmdldCgi\nc3ViY2xhc3Nlci1maW5hbC1tZXRob2RzLW5vdC1hbGxvd2VkIiwNCiAgICAg\nICAgICAgICAgICBjbGFzc05hbWUsIG1ldGguZ2V0TmFtZSgpKSwgZm1kKTsN\nCiAgICAgICAgaWYgKE1vZGlmaWVyLmlzTmF0aXZlKG1ldGguZ2V0TW9kaWZp\nZXJzKCkpKQ0KICAgICAgICAgICAgYWRkQ29udHJhY3RWaW9sYXRpb24obG9j\nLmdldA0KICAgICAgICAgICAgICAgICgic3ViY2xhc3Nlci1uYXRpdmUtbWV0\naG9kcy1ub3QtYWxsb3dlZCIsIGNsYXNzTmFtZSwNCiAgICAgICAgICAgICAg\nICAgICAgbWV0aC5nZXROYW1lKCkpLA0KICAgICAgICAgICAgICAgIGZtZCk7\nDQogICAgICAgIGlmIChNb2RpZmllci5pc1N0YXRpYyhtZXRoLmdldE1vZGlm\naWVycygpKSkNCiAgICAgICAgICAgIGFkZEVycm9yKGxvYy5nZXQoInN1YmNs\nYXNzZXItc3RhdGljLW1ldGhvZHMtbm90LXN1cHBvcnRlZCIsDQogICAgICAg\nICAgICAgICAgY2xhc3NOYW1lLCBtZXRoLmdldE5hbWUoKSksIGZtZCk7DQog\nICAgfQ0KDQogICAgcHJpdmF0ZSB2b2lkIGFkZEVycm9yKE1lc3NhZ2Ugcywg\nQ2xhc3NNZXRhRGF0YSBjbHMpIHsNCiAgICAgICAgaWYgKGVycm9ycyA9PSBu\ndWxsKQ0KICAgICAgICAgICAgZXJyb3JzID0gbmV3IEFycmF5TGlzdCgpOw0K\nDQogICAgICAgIGVycm9ycy5hZGQobG9jLmdldCgic3ViY2xhc3Nlci1lcnJv\nci1tZXRhIiwgcywNCiAgICAgICAgICAgIGNscy5nZXREZXNjcmliZWRUeXBl\nKCkuZ2V0TmFtZSgpLA0KICAgICAgICAgICAgY2xzLmdldFNvdXJjZUZpbGUo\nKSkpOw0KICAgIH0NCg0KICAgIHByaXZhdGUgdm9pZCBhZGRFcnJvcihNZXNz\nYWdlIHMsIEZpZWxkTWV0YURhdGEgZm1kKSB7DQogICAgICAgIGlmIChlcnJv\ncnMgPT0gbnVsbCkNCiAgICAgICAgICAgIGVycm9ycyA9IG5ldyBBcnJheUxp\nc3QoKTsNCg0KICAgICAgICBlcnJvcnMuYWRkKGxvYy5nZXQoInN1YmNsYXNz\nZXItZXJyb3ItZmllbGQiLCBzLA0KICAgICAgICAgICAgZm1kLmdldEZ1bGxO\nYW1lKCksDQogICAgICAgICAgICBmbWQuZ2V0RGVjbGFyaW5nTWV0YURhdGEo\nKS5nZXRTb3VyY2VGaWxlKCkpKTsNCiAgICB9DQoNCiAgICBwcml2YXRlIHZv\naWQgYWRkQ29udHJhY3RWaW9sYXRpb24oTWVzc2FnZSBtLCBGaWVsZE1ldGFE\nYXRhIGZtZCkgew0KICAgICAgICAvLyBhZGQgdGhlIHZpb2xhdGlvbiBhcyBh\nbiBlcnJvciBpbiBjYXNlIHdlJ3JlIHByb2Nlc3NpbmcgdmlvbGF0aW9ucw0K\nICAgICAgICAvLyBhcyBlcnJvcnM7IHRoaXMga2VlcHMgdGhlbSBpbiB0aGUg\nb3JkZXIgdGhhdCB0aGV5IHdlcmUgZm91bmQgcmF0aGVyDQogICAgICAgIC8v\nIHRoYW4ganVzdCBhZGRpbmcgdGhlIHZpb2xhdGlvbnMgdG8gdGhlIGVuZCBv\nZiB0aGUgbGlzdC4NCiAgICAgICAgaWYgKGZhaWxPbkNvbnRyYWN0VmlvbGF0\naW9ucykNCiAgICAgICAgICAgIGFkZEVycm9yKG0sIGZtZCk7DQoNCiAgICAg\nICAgaWYgKGNvbnRyYWN0VmlvbGF0aW9ucyA9PSBudWxsKQ0KICAgICAgICAg\nICAgY29udHJhY3RWaW9sYXRpb25zID0gbmV3IEFycmF5TGlzdCgpOw0KDQog\nICAgICAgIGNvbnRyYWN0VmlvbGF0aW9ucy5hZGQobG9jLmdldA0KICAgICAg\nICAgICAgKCJzdWJjbGFzc2VyLWNvbnRyYWN0LXZpb2xhdGlvbi1maWVsZCIs\nIG0uZ2V0TWVzc2FnZSgpLA0KICAgICAgICAgICAgICAgIGZtZC5nZXRGdWxs\nTmFtZSgpLCBmbWQuZ2V0RGVjbGFyaW5nTWV0YURhdGEoKS5nZXRTb3VyY2VG\naWxlKCkpKTsNCiAgICB9DQp9DQo=\n","encoding":"base64"}

