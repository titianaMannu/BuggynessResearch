{"sha":"cb75b61732b794bfc3425b5dbd9933ad4abd3585","node_id":"MDQ6QmxvYjIwNjM2NDpjYjc1YjYxNzMyYjc5NGJmYzM0MjViNWRiZDk5MzNhZDRhYmQzNTg1","size":12275,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/cb75b61732b794bfc3425b5dbd9933ad4abd3585","content":"LyoNCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUNCiAqIG9yIG1vcmUgY29udHJpYnV0b3Ig\nbGljZW5zZSBhZ3JlZW1lbnRzLiAgU2VlIHRoZSBOT1RJQ0UgZmlsZQ0KICog\nZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5m\nb3JtYXRpb24NCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAg\nVGhlIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUNCiAqIHRvIHlvdSB1bmRlciB0\naGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUNCiAqICJMaWNl\nbnNlIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNv\nbXBsaWFuY2UNCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFp\nbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQNCiAqDQogKiBodHRwOi8vd3d3\nLmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjANCiAqDQogKiBVbmxl\nc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGlu\nIHdyaXRpbmcsDQogKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUg\nTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbg0KICogIkFTIElTIiBCQVNJ\nUywgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZDQog\nKiBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBM\naWNlbnNlIGZvciB0aGUNCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmlu\nZyBwZXJtaXNzaW9ucyBhbmQgbGltaXRhdGlvbnMNCiAqIHVuZGVyIHRoZSBM\naWNlbnNlLg0KICovDQpwYWNrYWdlIG9yZy5hcGFjaGUub3BlbmpwYS5lbmhh\nbmNlOw0KDQppbXBvcnQgamF2YS5sYW5nLnJlZmxlY3QuRmllbGQ7DQppbXBv\ncnQgamF2YS5sYW5nLnJlZmxlY3QuTWV0aG9kOw0KDQppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLm1ldGEuQ2xhc3NNZXRhRGF0YTsNCmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEubWV0YS5KYXZhVHlwZXM7DQppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLm1ldGEuRmllbGRNZXRhRGF0YTsNCmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEuY29uZi5PcGVuSlBBQ29uZmlndXJhdGlvbjsNCmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5BcHBsaWNhdGlvbklkczsN\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5JbnRlcm5hbEV4Y2Vw\ndGlvbjsNCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5PYmplY3RJ\nZDsNCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLlN0YXRlTWFu\nYWdlckltcGw7DQoNCi8qKg0KICogSW1wbGVtZW50YXRpb24gb2YgdGhlIHtA\nbGluayBQZXJzaXN0ZW5jZUNhcGFibGV9IGludGVyZmFjZSB0aGF0IGNhbiBo\nYW5kbGUNCiAqIHRoZSBwZXJzaXN0ZW5jZS1jYXBhYmxlIGNvbnRyYWN0IGZv\nciBpbnN0YW5jZXMgdGhhdCB3ZXJlIG5vdCBlbmhhbmNlZA0KICogYmVmb3Jl\nIGNsYXNzIGxvYWQgdGltZS4NCiAqDQogKiBAc2luY2UgMS4wLjANCiAqLw0K\ncHVibGljIGNsYXNzIFJlZmxlY3RpbmdQZXJzaXN0ZW5jZUNhcGFibGUNCiAg\nICBpbXBsZW1lbnRzIFBlcnNpc3RlbmNlQ2FwYWJsZSwgTWFuYWdlZEluc3Rh\nbmNlUHJvdmlkZXIgew0KDQogICAgcHJpdmF0ZSBPYmplY3QgbzsNCiAgICBw\ncml2YXRlIFN0YXRlTWFuYWdlciBzbTsNCiAgICBwcml2YXRlIFBlcnNpc3Rl\nbmNlQ2FwYWJsZSBwY1N1YmNsYXNzSW5zdGFuY2U7DQogICAgcHJpdmF0ZSBD\nbGFzc01ldGFEYXRhIG1ldGE7DQoNCiAgICBwdWJsaWMgUmVmbGVjdGluZ1Bl\ncnNpc3RlbmNlQ2FwYWJsZShPYmplY3QgbywgT3BlbkpQQUNvbmZpZ3VyYXRp\nb24gY29uZikgew0KICAgICAgICB0aGlzLm8gPSBvOw0KICAgICAgICBDbGFz\ncyB0eXBlID0gby5nZXRDbGFzcygpOw0KICAgICAgICBwY1N1YmNsYXNzSW5z\ndGFuY2UgPSBQQ1JlZ2lzdHJ5Lm5ld0luc3RhbmNlKHR5cGUsIG51bGwsIGZh\nbHNlKTsNCiAgICAgICAgbWV0YSA9IGNvbmYuZ2V0TWV0YURhdGFSZXBvc2l0\nb3J5SW5zdGFuY2UoKQ0KICAgICAgICAgICAgLmdldE1ldGFEYXRhKHR5cGUs\nIG51bGwsIHRydWUpOw0KICAgIH0NCg0KICAgIHB1YmxpYyBpbnQgcGNHZXRF\nbmhhbmNlbWVudENvbnRyYWN0VmVyc2lvbigpIHsNCiAgICAgICAgcmV0dXJu\nIFBDRW5oYW5jZXIuRU5IQU5DRVJfVkVSU0lPTjsNCiAgICB9DQoNCiAgICBw\ndWJsaWMgT2JqZWN0IHBjR2V0R2VuZXJpY0NvbnRleHQoKSB7DQogICAgICAg\nIGlmIChzbSA9PSBudWxsKQ0KICAgICAgICAgICAgcmV0dXJuIG51bGw7DQog\nICAgICAgIGVsc2UNCiAgICAgICAgICAgIHJldHVybiBzbS5nZXRHZW5lcmlj\nQ29udGV4dCgpOw0KICAgIH0NCg0KICAgIHB1YmxpYyBTdGF0ZU1hbmFnZXIg\ncGNHZXRTdGF0ZU1hbmFnZXIoKSB7DQogICAgICAgIHJldHVybiBzbTsNCiAg\nICB9DQoNCiAgICBwdWJsaWMgdm9pZCBwY1JlcGxhY2VTdGF0ZU1hbmFnZXIo\nU3RhdGVNYW5hZ2VyIHNtKSB7DQogICAgICAgIHRoaXMuc20gPSBzbTsNCiAg\nICB9DQoNCiAgICBwdWJsaWMgdm9pZCBwY1Byb3ZpZGVGaWVsZChpbnQgaSkg\new0KICAgICAgICBzd2l0Y2ggKG1ldGEuZ2V0RmllbGQoaSkuZ2V0VHlwZUNv\nZGUoKSkgew0KICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuQk9PTEVBTjoN\nCiAgICAgICAgICAgICAgICBzbS5wcm92aWRlZEJvb2xlYW5GaWVsZCh0aGlz\nLCBpLA0KICAgICAgICAgICAgICAgICAgICAoKEJvb2xlYW4pIGdldFZhbHVl\nKGksIG8pKS5ib29sZWFuVmFsdWUoKSk7DQogICAgICAgICAgICAgICAgYnJl\nYWs7DQogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5CWVRFOg0KICAgICAg\nICAgICAgICAgIHNtLnByb3ZpZGVkQnl0ZUZpZWxkKHRoaXMsIGksDQogICAg\nICAgICAgICAgICAgICAgICgoQnl0ZSkgZ2V0VmFsdWUoaSwgbykpLmJ5dGVW\nYWx1ZSgpKTsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAg\nIGNhc2UgSmF2YVR5cGVzLkNIQVI6DQogICAgICAgICAgICAgICAgc20ucHJv\ndmlkZWRDaGFyRmllbGQodGhpcywgaSwNCiAgICAgICAgICAgICAgICAgICAg\nKChDaGFyYWN0ZXIpIGdldFZhbHVlKGksIG8pKS5jaGFyVmFsdWUoKSk7DQog\nICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlIEphdmFU\neXBlcy5ET1VCTEU6DQogICAgICAgICAgICAgICAgc20ucHJvdmlkZWREb3Vi\nbGVGaWVsZCh0aGlzLCBpLA0KICAgICAgICAgICAgICAgICAgICAoKERvdWJs\nZSkgZ2V0VmFsdWUoaSwgbykpLmRvdWJsZVZhbHVlKCkpOw0KICAgICAgICAg\nICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuRkxP\nQVQ6DQogICAgICAgICAgICAgICAgc20ucHJvdmlkZWRGbG9hdEZpZWxkKHRo\naXMsIGksDQogICAgICAgICAgICAgICAgICAgICgoRmxvYXQpIGdldFZhbHVl\nKGksIG8pKS5mbG9hdFZhbHVlKCkpOw0KICAgICAgICAgICAgICAgIGJyZWFr\nOw0KICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuSU5UOg0KICAgICAgICAg\nICAgICAgIHNtLnByb3ZpZGVkSW50RmllbGQodGhpcywgaSwNCiAgICAgICAg\nICAgICAgICAgICAgKChJbnRlZ2VyKSBnZXRWYWx1ZShpLCBvKSkuaW50VmFs\ndWUoKSk7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBj\nYXNlIEphdmFUeXBlcy5MT05HOg0KICAgICAgICAgICAgICAgIHNtLnByb3Zp\nZGVkTG9uZ0ZpZWxkKHRoaXMsIGksDQogICAgICAgICAgICAgICAgICAgICgo\nTG9uZykgZ2V0VmFsdWUoaSwgbykpLmxvbmdWYWx1ZSgpKTsNCiAgICAgICAg\nICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLlNI\nT1JUOg0KICAgICAgICAgICAgICAgIHNtLnByb3ZpZGVkU2hvcnRGaWVsZCh0\naGlzLCBpLA0KICAgICAgICAgICAgICAgICAgICAoKFNob3J0KSBnZXRWYWx1\nZShpLCBvKSkuc2hvcnRWYWx1ZSgpKTsNCiAgICAgICAgICAgICAgICBicmVh\nazsNCiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLlNUUklORzoNCiAgICAg\nICAgICAgICAgICBzbS5wcm92aWRlZFN0cmluZ0ZpZWxkKHRoaXMsIGksDQog\nICAgICAgICAgICAgICAgICAgIChTdHJpbmcpIGdldFZhbHVlKGksIG8pKTsN\nCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGRlZmF1bHQ6\nDQogICAgICAgICAgICAgICAgc20ucHJvdmlkZWRPYmplY3RGaWVsZCh0aGlz\nLCBpLCBnZXRWYWx1ZShpLCBvKSk7DQogICAgICAgICAgICAgICAgYnJlYWs7\nDQogICAgICAgIH0NCiAgICB9DQoNCiAgICBwdWJsaWMgdm9pZCBwY1Byb3Zp\nZGVGaWVsZHMoaW50W10gZmllbGRJbmRpY2VzKSB7DQogICAgICAgIGZvcihp\nbnQgaSA9IDA7IGkgPCBmaWVsZEluZGljZXMubGVuZ3RoOyBpKyspDQogICAg\nICAgICAgICBwY1Byb3ZpZGVGaWVsZChmaWVsZEluZGljZXNbaV0pOw0KICAg\nIH0NCg0KICAgIHB1YmxpYyB2b2lkIHBjUmVwbGFjZUZpZWxkKGludCBpKSB7\nDQogICAgICAgIHN3aXRjaChtZXRhLmdldEZpZWxkKGkpLmdldFR5cGVDb2Rl\nKCkpIHsNCiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLkJPT0xFQU46DQog\nICAgICAgICAgICAgICAgc2V0VmFsdWUoaSwgbywgQm9vbGVhbi52YWx1ZU9m\nKA0KICAgICAgICAgICAgICAgICAgICBzbS5yZXBsYWNlQm9vbGVhbkZpZWxk\nKHRoaXMsIGkpKSk7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAg\nICAgICBjYXNlIEphdmFUeXBlcy5CWVRFOg0KICAgICAgICAgICAgICAgIHNl\ndFZhbHVlKGksIG8sIG5ldyBCeXRlKHNtLnJlcGxhY2VCeXRlRmllbGQodGhp\ncywgaSkpKTsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAg\nIGNhc2UgSmF2YVR5cGVzLkNIQVI6DQogICAgICAgICAgICAgICAgc2V0VmFs\ndWUoaSwgbywgbmV3IENoYXJhY3RlcihzbS5yZXBsYWNlQ2hhckZpZWxkKHRo\naXMsIGkpKSk7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAg\nICBjYXNlIEphdmFUeXBlcy5ET1VCTEU6DQogICAgICAgICAgICAgICAgc2V0\nVmFsdWUoaSwgbywgbmV3IERvdWJsZShzbS5yZXBsYWNlRG91YmxlRmllbGQo\ndGhpcywgaSkpKTsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAg\nICAgIGNhc2UgSmF2YVR5cGVzLkZMT0FUOg0KICAgICAgICAgICAgICAgIHNl\ndFZhbHVlKGksIG8sIG5ldyBGbG9hdChzbS5yZXBsYWNlRmxvYXRGaWVsZCh0\naGlzLCBpKSkpOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAg\nICAgY2FzZSBKYXZhVHlwZXMuSU5UOg0KICAgICAgICAgICAgICAgIHNldFZh\nbHVlKGksIG8sIG5ldyBJbnRlZ2VyKHNtLnJlcGxhY2VJbnRGaWVsZCh0aGlz\nLCBpKSkpOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAg\nY2FzZSBKYXZhVHlwZXMuTE9ORzoNCiAgICAgICAgICAgICAgICBzZXRWYWx1\nZShpLCBvLCBuZXcgTG9uZyhzbS5yZXBsYWNlTG9uZ0ZpZWxkKHRoaXMsIGkp\nKSk7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNl\nIEphdmFUeXBlcy5TSE9SVDoNCiAgICAgICAgICAgICAgICBzZXRWYWx1ZShp\nLCBvLCBuZXcgU2hvcnQoc20ucmVwbGFjZVNob3J0RmllbGQodGhpcywgaSkp\nKTsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGNhc2Ug\nSmF2YVR5cGVzLlNUUklORzoNCiAgICAgICAgICAgICAgICBzZXRWYWx1ZShp\nLCBvLCBzbS5yZXBsYWNlU3RyaW5nRmllbGQodGhpcywgaSkpOw0KICAgICAg\nICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgZGVmYXVsdDoNCiAgICAg\nICAgICAgICAgICBzZXRWYWx1ZShpLCBvLCBzbS5yZXBsYWNlT2JqZWN0Rmll\nbGQodGhpcywgaSkpOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAg\nICB9DQogICAgfQ0KDQogICAgcHVibGljIHZvaWQgcGNSZXBsYWNlRmllbGRz\nKGludFtdIGZpZWxkSW5kaWNlcykgew0KICAgICAgICBmb3IoaW50IGkgPSAw\nOyBpIDwgZmllbGRJbmRpY2VzLmxlbmd0aDsgaSsrKQ0KICAgICAgICAgICAg\ncGNSZXBsYWNlRmllbGQoZmllbGRJbmRpY2VzW2ldKTsNCiAgICB9DQoNCiAg\nICBwdWJsaWMgdm9pZCBwY0NvcHlGaWVsZChPYmplY3QgZnJvbU9iamVjdCwg\naW50IGkpIHsNCiAgICAgICAgLy8gdGhpcyBkb2Vzbid0IG5lZWQgc3dpdGNo\nIHRyZWF0bWVudCBiZWNhdXNlIHdlJ3JlIGp1c3QNCiAgICAgICAgLy8gcmVm\nbGVjdGluZyBvbiBib3RoIHNpZGVzLCBieXBhc3NpbmcgZmllbGQgbWFuYWdl\ncnMuDQogICAgICAgIHNldFZhbHVlKGksIG8sIGdldFZhbHVlKGksIGZyb21P\nYmplY3QpKTsNCiAgICB9DQoNCiAgICBwdWJsaWMgdm9pZCBwY0NvcHlGaWVs\nZHMoT2JqZWN0IGZyb21PYmplY3QsIGludFtdIGZpZWxkSW5kaWNlcykgew0K\nICAgICAgICBmb3IoaW50IGkgPSAwOyBpIDwgZmllbGRJbmRpY2VzLmxlbmd0\naDsgaSsrKQ0KICAgICAgICAgICAgcGNDb3B5RmllbGQoZnJvbU9iamVjdCwg\nZmllbGRJbmRpY2VzW2ldKTsNCiAgICB9DQoNCiAgICBwdWJsaWMgdm9pZCBw\nY0RpcnR5KFN0cmluZyBmaWVsZE5hbWUpIHsNCiAgICAgICAgaWYgKHNtICE9\nIG51bGwpDQogICAgICAgICAgICBzbS5kaXJ0eShmaWVsZE5hbWUpOw0KICAg\nIH0NCg0KICAgIHB1YmxpYyBPYmplY3QgcGNGZXRjaE9iamVjdElkKCkgew0K\nICAgICAgICBpZiAoc20gIT0gbnVsbCkNCiAgICAgICAgICAgIHJldHVybiBz\nbS5mZXRjaE9iamVjdElkKCk7DQogICAgICAgIGVsc2UNCiAgICAgICAgICAg\nIHJldHVybiBudWxsOw0KICAgIH0NCg0KICAgIHB1YmxpYyBPYmplY3QgcGNH\nZXRWZXJzaW9uKCkgew0KICAgICAgICBpZiAoc20gPT0gbnVsbCkNCiAgICAg\nICAgICAgIHJldHVybiBudWxsOw0KICAgICAgICBlbHNlDQogICAgICAgICAg\nICByZXR1cm4gc20uZ2V0VmVyc2lvbigpOw0KICAgIH0NCg0KICAgIHB1Ymxp\nYyBib29sZWFuIHBjSXNEaXJ0eSgpIHsNCiAgICAgICAgaWYgKHNtID09IG51\nbGwpDQogICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgIGVsc2Ug\new0KICAgICAgICAgICAgaWYgKHNtIGluc3RhbmNlb2YgU3RhdGVNYW5hZ2Vy\nSW1wbCkNCiAgICAgICAgICAgICAgICAoKFN0YXRlTWFuYWdlckltcGwpIHNt\nKS5kaXJ0eUNoZWNrKCk7DQogICAgICAgICAgICByZXR1cm4gc20uaXNEaXJ0\neSgpOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgcHVibGljIGJvb2xlYW4g\ncGNJc1RyYW5zYWN0aW9uYWwoKSB7DQogICAgICAgIGlmIChzbSA9PSBudWxs\nKQ0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICBlbHNlDQog\nICAgICAgICAgICByZXR1cm4gc20uaXNUcmFuc2FjdGlvbmFsKCk7DQogICAg\nfQ0KDQogICAgcHVibGljIGJvb2xlYW4gcGNJc1BlcnNpc3RlbnQoKSB7DQog\nICAgICAgIGlmIChzbSA9PSBudWxsKQ0KICAgICAgICAgICAgcmV0dXJuIGZh\nbHNlOw0KICAgICAgICBlbHNlDQogICAgICAgICAgICByZXR1cm4gc20uaXNQ\nZXJzaXN0ZW50KCk7DQogICAgfQ0KDQogICAgcHVibGljIGJvb2xlYW4gcGNJ\nc05ldygpIHsNCiAgICAgICAgaWYgKHNtID09IG51bGwpDQogICAgICAgICAg\nICByZXR1cm4gZmFsc2U7DQogICAgICAgIGVsc2UNCiAgICAgICAgICAgIHJl\ndHVybiBzbS5pc05ldygpOw0KICAgIH0NCg0KICAgIHB1YmxpYyBib29sZWFu\nIHBjSXNEZWxldGVkKCkgew0KICAgICAgICBpZiAoc20gPT0gbnVsbCkNCiAg\nICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgZWxzZQ0KICAgICAg\nICAgICAgcmV0dXJuIHNtLmlzRGVsZXRlZCgpOw0KICAgIH0NCg0KICAgIC8v\nIG51bGwgPT0gdW5rbm93bg0KICAgIHB1YmxpYyBCb29sZWFuIHBjSXNEZXRh\nY2hlZCgpIHsNCiAgICAgICAgaWYgKHNtICE9IG51bGwpDQogICAgICAgICAg\nICByZXR1cm4gQm9vbGVhbi52YWx1ZU9mKHNtLmlzRGV0YWNoZWQoKSk7DQoN\nCiAgICAgICAgLy8gIyMjIyMgd2UgY291bGQgZG8gYSBsb3QgbW9yZSBoZXJl\nIGlmIGEgZGV0YWNoZWQgc3RhdGUgZmllbGQNCiAgICAgICAgLy8gIyMjIyMg\nd2FzIHNwZWNpZmllZC4NCiAgICAgICAgcmV0dXJuIG51bGw7DQogICAgfQ0K\nDQogICAgcHVibGljIFBlcnNpc3RlbmNlQ2FwYWJsZSBwY05ld0luc3RhbmNl\nKFN0YXRlTWFuYWdlciBzbSwgYm9vbGVhbiBjbGVhcikgew0KICAgICAgICBy\nZXR1cm4gcGNTdWJjbGFzc0luc3RhbmNlLnBjTmV3SW5zdGFuY2Uoc20sIGNs\nZWFyKTsNCiAgICB9DQoNCiAgICBwdWJsaWMgUGVyc2lzdGVuY2VDYXBhYmxl\nIHBjTmV3SW5zdGFuY2UoU3RhdGVNYW5hZ2VyIHNtLCBPYmplY3Qgb2lkLA0K\nICAgICAgICBib29sZWFuIGNsZWFyKSB7DQogICAgICAgIHJldHVybiBwY1N1\nYmNsYXNzSW5zdGFuY2UucGNOZXdJbnN0YW5jZShzbSwgb2lkLCBjbGVhcik7\nDQogICAgfQ0KDQogICAgcHVibGljIE9iamVjdCBwY05ld09iamVjdElkSW5z\ndGFuY2UoKSB7DQogICAgICAgIEZpZWxkTWV0YURhdGFbXSBwa0ZpZWxkcyA9\nIG1ldGEuZ2V0UHJpbWFyeUtleUZpZWxkcygpOw0KICAgICAgICBPYmplY3Rb\nXSBwa3MgPSBuZXcgT2JqZWN0W3BrRmllbGRzLmxlbmd0aF07DQogICAgICAg\nIGZvciAoaW50IGkgPSAwOyBpIDwgcGtGaWVsZHMubGVuZ3RoOyBpKyspDQog\nICAgICAgICAgICBwa3NbaV0gPSBnZXRWYWx1ZShwa0ZpZWxkc1tpXS5nZXRJ\nbmRleCgpLCBvKTsNCiAgICAgICAgcmV0dXJuIEFwcGxpY2F0aW9uSWRzLmZy\nb21QS1ZhbHVlcyhwa3MsIG1ldGEpOw0KICAgIH0NCiAgICANCiAgICBwdWJs\naWMgT2JqZWN0IHBjTmV3T2JqZWN0SWRJbnN0YW5jZShPYmplY3Qgb2lkKSB7\nDQogICAgICAgIHJldHVybiBwY1N1YmNsYXNzSW5zdGFuY2UucGNOZXdPYmpl\nY3RJZEluc3RhbmNlKG9pZCk7DQogICAgfQ0KDQogICAgcHVibGljIHZvaWQg\ncGNDb3B5S2V5RmllbGRzVG9PYmplY3RJZChPYmplY3Qgb2lkKSB7DQogICAg\nICAgIE9iamVjdCB0YXJnZXQ7DQogICAgICAgIGlmIChvaWQgaW5zdGFuY2Vv\nZiBPYmplY3RJZCkNCiAgICAgICAgICAgIHRhcmdldCA9ICgoT2JqZWN0SWQp\nIG9pZCkuZ2V0SWQoKTsNCiAgICAgICAgZWxzZQ0KICAgICAgICAgICAgdGFy\nZ2V0ID0gb2lkOw0KDQogICAgICAgIEZpZWxkTWV0YURhdGFbXSBwa3MgPSBt\nZXRhLmdldFByaW1hcnlLZXlGaWVsZHMoKTsNCiAgICAgICAgZm9yIChpbnQg\naSA9IDA7IGkgPCBwa3MubGVuZ3RoOyBpKyspIHsNCiAgICAgICAgICAgIE9i\namVjdCB2YWwgPSBnZXRWYWx1ZShwa3NbaV0uZ2V0SW5kZXgoKSwgbyk7DQog\nICAgICAgICAgICBGaWVsZCBmID0gUmVmbGVjdGlvbi5maW5kRmllbGQodGFy\nZ2V0LmdldENsYXNzKCksIHBrc1tpXS5nZXROYW1lKCksDQogICAgICAgICAg\nICAgICAgdHJ1ZSk7DQogICAgICAgICAgICBSZWZsZWN0aW9uLnNldCh0YXJn\nZXQsIGYsIHZhbCk7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICBwdWJsaWMg\ndm9pZCBwY0NvcHlLZXlGaWVsZHNUb09iamVjdElkKEZpZWxkU3VwcGxpZXIg\nc3VwcGxpZXIsIE9iamVjdCBvYmopIHsNCiAgICAgICAgLy8gVGhpcyBpcyBv\nbmx5IGV2ZXIgaW52b2tlZCBhZ2FpbnN0IFBDcyBpbiB0aGUgUENSZWdpc3Ry\neS4gU3VjaCBQQ3MNCiAgICAgICAgLy8gd2lsbCBhbHdheXMgYmUgZW5oYW5j\nZWQgdHlwZXMgb3Igc3VidHlwZXMgb2YgdXNlciB0eXBlcywgYW5kIHdpbGwN\nCiAgICAgICAgLy8gbmV2ZXIgYmUgYSBSZWZsZWN0aW5nUGVyc2lzdGVuY2VD\nYXBhYmxlLg0KICAgICAgICB0aHJvdyBuZXcgSW50ZXJuYWxFeGNlcHRpb24o\nKTsNCiAgICB9DQoNCiAgICBwdWJsaWMgdm9pZCBwY0NvcHlLZXlGaWVsZHNG\ncm9tT2JqZWN0SWQoRmllbGRDb25zdW1lciBjb25zdW1lciwNCiAgICAgICAg\nT2JqZWN0IG9iaikgew0KICAgICAgICAvLyBUaGlzIGlzIG9ubHkgZXZlciBp\nbnZva2VkIGFnYWluc3QgUENzIGluIHRoZSBQQ1JlZ2lzdHJ5LiBTdWNoIFBD\ncw0KICAgICAgICAvLyB3aWxsIGFsd2F5cyBiZSBlbmhhbmNlZCB0eXBlcyBv\nciBzdWJ0eXBlcyBvZiB1c2VyIHR5cGVzLCBhbmQgd2lsbA0KICAgICAgICAv\nLyBuZXZlciBiZSBhIFJlZmxlY3RpbmdQZXJzaXN0ZW5jZUNhcGFibGUuDQog\nICAgICAgIHRocm93IG5ldyBJbnRlcm5hbEV4Y2VwdGlvbigpOw0KICAgIH0N\nCg0KICAgIHB1YmxpYyBPYmplY3QgcGNHZXREZXRhY2hlZFN0YXRlKCkgew0K\nICAgICAgICAvLyAjIyMjIyB3ZSBjYW4gaW1wbGVtZW50IHRoaXMgaWYgYSBz\ndGF0ZSBmaWVsZCBoYXMgYmVlbiBzZXQNCiAgICAgICAgcmV0dXJuIG51bGw7\nDQogICAgfQ0KDQogICAgcHVibGljIHZvaWQgcGNTZXREZXRhY2hlZFN0YXRl\nKE9iamVjdCBzdGF0ZSkgew0KICAgICAgICAvLyBTdGF0ZU1hbmFnZXJJbXBs\nIHdpbGwgaW52b2tlIHRoaXMgd2l0aCBudWxsIGR1cmluZyBpbnN0YW5jZQ0K\nICAgICAgICAvLyBpbml0aWFsaXphdGlvbg0KICAgICAgICBpZiAoc3RhdGUg\nIT0gbnVsbCkNCiAgICAgICAgICAgIHRocm93IG5ldyBVbnN1cHBvcnRlZE9w\nZXJhdGlvbkV4Y2VwdGlvbigpOw0KICAgICAgICAvLyAjIyMjIyB3ZSBjYW4g\naW1wbGVtZW50IHRoaXMgaWYgYSBzdGF0ZSBmaWVsZCBoYXMgYmVlbiBzZXQN\nCiAgICB9DQoNCiAgICBwdWJsaWMgT2JqZWN0IGdldE1hbmFnZWRJbnN0YW5j\nZSgpIHsNCiAgICAgICAgcmV0dXJuIG87DQogICAgfQ0KDQogICAgcHJpdmF0\nZSBPYmplY3QgZ2V0VmFsdWUoaW50IGksIE9iamVjdCBvKSB7DQogICAgICAg\nIGlmIChtZXRhLmdldEFjY2Vzc1R5cGUoKSA9PSBDbGFzc01ldGFEYXRhLkFD\nQ0VTU19QUk9QRVJUWSkgew0KICAgICAgICAgICAgaWYgKCFtZXRhLmlzSW50\nZXJjZXB0aW5nKCkpIHsNCiAgICAgICAgICAgICAgICBNZXRob2QgbWV0aCA9\nIFJlZmxlY3Rpb24uZmluZEdldHRlcihtZXRhLmdldERlc2NyaWJlZFR5cGUo\nKSwNCiAgICAgICAgICAgICAgICAgICAgbWV0YS5nZXRGaWVsZChpKS5nZXRO\nYW1lKCksIHRydWUpOw0KICAgICAgICAgICAgICAgIHJldHVybiBSZWZsZWN0\naW9uLmdldChvLCBtZXRoKTsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAg\nICAgICAgICAgICAgRmllbGQgZmllbGQgPSBSZWZsZWN0aW9uLmZpbmRGaWVs\nZChtZXRhLmdldERlc2NyaWJlZFR5cGUoKSwNCiAgICAgICAgICAgICAgICAg\nICAgdG9GaWVsZE5hbWUoaSksIHRydWUpOw0KICAgICAgICAgICAgICAgIHJl\ndHVybiBSZWZsZWN0aW9uLmdldChvLCBmaWVsZCk7DQogICAgICAgICAgICB9\nDQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICBGaWVsZCBmaWVsZCA9\nIChGaWVsZCkgbWV0YS5nZXRGaWVsZChpKS5nZXRCYWNraW5nTWVtYmVyKCk7\nDQogICAgICAgICAgICByZXR1cm4gUmVmbGVjdGlvbi5nZXQobywgZmllbGQp\nOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgcHJpdmF0ZSBTdHJpbmcgdG9G\naWVsZE5hbWUoaW50IGkpIHsNCiAgICAgICAgaWYgKHBjU3ViY2xhc3NJbnN0\nYW5jZSBpbnN0YW5jZW9mIEF0dHJpYnV0ZVRyYW5zbGF0b3IpDQogICAgICAg\nICAgICByZXR1cm4gKChBdHRyaWJ1dGVUcmFuc2xhdG9yKSBwY1N1YmNsYXNz\nSW5zdGFuY2UpDQogICAgICAgICAgICAgICAgLnBjQXR0cmlidXRlSW5kZXhU\nb0ZpZWxkTmFtZShpKTsNCiAgICAgICAgZWxzZQ0KICAgICAgICAgICAgcmV0\ndXJuIG1ldGEuZ2V0RmllbGQoaSkuZ2V0TmFtZSgpOw0KICAgIH0NCg0KICAg\nIHByaXZhdGUgdm9pZCBzZXRWYWx1ZShpbnQgaSwgT2JqZWN0IG8sIE9iamVj\ndCB2YWwpIHsNCiAgICAgICAgaWYgKG1ldGEuZ2V0QWNjZXNzVHlwZSgpID09\nIENsYXNzTWV0YURhdGEuQUNDRVNTX1BST1BFUlRZKSB7DQogICAgICAgICAg\nICBpZiAoIW1ldGEuaXNJbnRlcmNlcHRpbmcoKSkgew0KICAgICAgICAgICAg\nICAgIE1ldGhvZCBtZXRoID0gUmVmbGVjdGlvbi5maW5kU2V0dGVyKG1ldGEu\nZ2V0RGVzY3JpYmVkVHlwZSgpLA0KICAgICAgICAgICAgICAgICAgICBtZXRh\nLmdldEZpZWxkKGkpLmdldE5hbWUoKSwgdHJ1ZSk7DQogICAgICAgICAgICAg\nICAgUmVmbGVjdGlvbi5zZXQobywgbWV0aCwgdmFsKTsNCiAgICAgICAgICAg\nIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgRmllbGQgZmllbGQgPSBSZWZs\nZWN0aW9uLmZpbmRGaWVsZChtZXRhLmdldERlc2NyaWJlZFR5cGUoKSwNCiAg\nICAgICAgICAgICAgICAgICAgdG9GaWVsZE5hbWUoaSksIHRydWUpOw0KICAg\nICAgICAgICAgICAgIFJlZmxlY3Rpb24uc2V0KG8sIGZpZWxkLCB2YWwpOw0K\nICAgICAgICAgICAgfQ0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAg\nRmllbGQgZmllbGQgPSAoRmllbGQpIG1ldGEuZ2V0RmllbGQoaSkuZ2V0QmFj\na2luZ01lbWJlcigpOw0KICAgICAgICAgICAgUmVmbGVjdGlvbi5zZXQobywg\nZmllbGQsIHZhbCk7DQogICAgICAgIH0NCiAgICB9DQp9DQo=\n","encoding":"base64"}

