{"sha":"674ad7e40fe0d2f04ed84c32b5e70da23ebeb9ed","node_id":"MDQ6QmxvYjIwNjM2NDo2NzRhZDdlNDBmZTBkMmYwNGVkODRjMzJiNWU3MGRhMjNlYmViOWVk","size":23192,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/674ad7e40fe0d2f04ed84c32b5e70da23ebeb9ed","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuZXZlbnQ7CgppbXBvcnQgamF2\nYS51dGlsLkFycmF5TGlzdDsKaW1wb3J0IGphdmEudXRpbC5Db2xsZWN0aW9u\nOwppbXBvcnQgamF2YS51dGlsLkhhc2hNYXA7CmltcG9ydCBqYXZhLnV0aWwu\nSXRlcmF0b3I7CmltcG9ydCBqYXZhLnV0aWwuTGlua2VkTGlzdDsKaW1wb3J0\nIGphdmEudXRpbC5MaXN0OwppbXBvcnQgamF2YS51dGlsLk1hcDsKCmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YS5DbGFzc01ldGFEYXRhOwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuTWV0YURhdGFEZWZhdWx0czsK\nCi8qKgogKiBNYW5hZ2VyIHRoYXQgY2FuIGJlIHVzZWQgdG8gdHJhY2sgYW5k\nIG5vdGlmeSBsaXN0ZW5lcnMgb24gbGlmZWN5Y2xlIGV2ZW50cy4KICogIFRo\naXMgY2xhc3MgaXMgb3B0aW1pemVkIGZvciBldmVudCBmaXJpbmcgcmF0aGVy\nIHRoYW4gZm9yIGFkZGluZyBhbmQKICogcmVtb3ZpbmcgbGlzdGVuZXJzLCB3\naGljaCBhcmUgTyhuKSBvcGVyYXRpb25zLiBUaGlzIGNsYXNzIGFsc28gZG9l\ncyBub3QKICogbWFpbnRhaW4gcGVyZmVjdCBzZXQgc2VtYW50aWNzIGZvciBs\naXN0ZW5lcnM7IGl0IGlzIHBvc3NpYmxlIHRvIHdpbmQgdXAKICogaGF2aW5n\nIHRoZSBzYW1lIGxpc3RlbmVyIGludm9rZWQgbXVsdGlwbGUgdGltZXMgZm9y\nIGEgc2luZ2xlIGV2ZW50IGlmIGl0CiAqIGlzIGFkZGVkIHRvIHRoaXMgbWFu\nYWdlciBtdWx0aXBsZSB0aW1lcyB3aXRoIGRpZmZlcmVudCBjbGFzc2VzLCBv\nciB3aXRoCiAqIGEgYmFzZSBjbGFzcyBhbmQgaXRzIHN1YmNsYXNzLgogKgog\nKiBAYXV0aG9yIFN0ZXZlIEtpbQogKiBAYXV0aG9yIEFiZSBXaGl0ZQogKiBA\nc2luY2UgMC4zLjMKICogQG5vamF2YWRvYwogKi8KcHVibGljIGNsYXNzIExp\nZmVjeWNsZUV2ZW50TWFuYWdlcgogICAgaW1wbGVtZW50cyBDYWxsYmFja01v\nZGVzIHsKCiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBFeGNlcHRpb25bXSBF\nTVBUWV9FWENFUFRJT05TID0gbmV3IEV4Y2VwdGlvblswXTsKCiAgICBwcml2\nYXRlIE1hcCBfY2xhc3NMaXN0ZW5lcnMgPSBudWxsOyAvLyBjbGFzcyAtPiBs\naXN0ZW5lciBsaXN0CiAgICBwcml2YXRlIExpc3RlbmVyTGlzdCBfbGlzdGVu\nZXJzID0gbnVsbDsKICAgIHByaXZhdGUgTGlzdCBfYWRkTGlzdGVuZXJzID0g\nbmV3IExpbmtlZExpc3QoKTsKICAgIHByaXZhdGUgTGlzdCBfcmVtTGlzdGVu\nZXJzID0gbmV3IExpbmtlZExpc3QoKTsKICAgIHByaXZhdGUgTGlzdCBfZXhj\nZXBzID0gbmV3IExpbmtlZExpc3QoKTsKICAgIHByaXZhdGUgYm9vbGVhbiBf\nZmlyaW5nID0gZmFsc2U7CiAgICBwcml2YXRlIGJvb2xlYW4gX2ZhaWwgPSBm\nYWxzZTsKICAgIHByaXZhdGUgYm9vbGVhbiBfZmFpbEZhc3QgPSBmYWxzZTsK\nCiAgICAvKioKICAgICAqIFdoZXRoZXIgdG8gZmFpbCBhZnRlciBmaXJzdCBl\neGNlcHRpb24gd2hlbiBmaXJpbmcgZXZlbnRzIHRvIGxpc3RlbmVycy4KICAg\nICAqLwogICAgcHVibGljIGJvb2xlYW4gaXNGYWlsRmFzdCgpIHsKICAgICAg\nICByZXR1cm4gX2ZhaWxGYXN0OwogICAgfQoKICAgIC8qKgogICAgICogV2hl\ndGhlciB0byBmYWlsIGFmdGVyIGZpcnN0IGV4Y2VwdGlvbiB3aGVuIGZpcmlu\nZyBldmVudHMgdG8gbGlzdGVuZXJzLgogICAgICovCiAgICBwdWJsaWMgdm9p\nZCBzZXRGYWlsRmFzdChib29sZWFuIGZhaWxGYXN0KSB7CiAgICAgICAgX2Zh\naWxGYXN0ID0gZmFpbEZhc3Q7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZWdp\nc3RlciBhIGxpZmVjeWNsZSBsaXN0ZW5lciBmb3IgdGhlIGdpdmVuIGNsYXNz\nZXMuIElmIHRoZSBjbGFzc2VzCiAgICAgKiBhcnJheSBpcyBudWxsLCByZWdp\nc3RlciBmb3IgYWxsIGNsYXNzZXMuCiAgICAgKi8KICAgIHB1YmxpYyBzeW5j\naHJvbml6ZWQgdm9pZCBhZGRMaXN0ZW5lcihPYmplY3QgbGlzdGVuZXIsIENs\nYXNzW10gY2xhc3NlcykgewogICAgICAgIGlmIChsaXN0ZW5lciA9PSBudWxs\nKQogICAgICAgICAgICByZXR1cm47CiAgICAgICAgaWYgKGNsYXNzZXMgIT0g\nbnVsbCAmJiBjbGFzc2VzLmxlbmd0aCA9PSAwKQogICAgICAgICAgICByZXR1\ncm47CiAgICAgICAgaWYgKF9maXJpbmcpIHsKICAgICAgICAgICAgX2FkZExp\nc3RlbmVycy5hZGQobGlzdGVuZXIpOwogICAgICAgICAgICBfYWRkTGlzdGVu\nZXJzLmFkZChjbGFzc2VzKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAg\nIH0KCiAgICAgICAgaWYgKGNsYXNzZXMgPT0gbnVsbCkgewogICAgICAgICAg\nICBpZiAoX2xpc3RlbmVycyA9PSBudWxsKQogICAgICAgICAgICAgICAgX2xp\nc3RlbmVycyA9IG5ldyBMaXN0ZW5lckxpc3QoNSk7CiAgICAgICAgICAgIF9s\naXN0ZW5lcnMuYWRkKGxpc3RlbmVyKTsKICAgICAgICAgICAgcmV0dXJuOwog\nICAgICAgIH0KCiAgICAgICAgaWYgKF9jbGFzc0xpc3RlbmVycyA9PSBudWxs\nKQogICAgICAgICAgICBfY2xhc3NMaXN0ZW5lcnMgPSBuZXcgSGFzaE1hcCgp\nOwogICAgICAgIExpc3RlbmVyTGlzdCBsaXN0ZW5lcnM7CiAgICAgICAgZm9y\nIChpbnQgaSA9IDA7IGkgPCBjbGFzc2VzLmxlbmd0aDsgaSsrKSB7CiAgICAg\nICAgICAgIGxpc3RlbmVycyA9IChMaXN0ZW5lckxpc3QpIF9jbGFzc0xpc3Rl\nbmVycy5nZXQoY2xhc3Nlc1tpXSk7CiAgICAgICAgICAgIGlmIChsaXN0ZW5l\ncnMgPT0gbnVsbCkgewogICAgICAgICAgICAgICAgbGlzdGVuZXJzID0gbmV3\nIExpc3RlbmVyTGlzdCgzKTsKICAgICAgICAgICAgICAgIF9jbGFzc0xpc3Rl\nbmVycy5wdXQoY2xhc3Nlc1tpXSwgbGlzdGVuZXJzKTsKICAgICAgICAgICAg\nfQogICAgICAgICAgICBsaXN0ZW5lcnMuYWRkKGxpc3RlbmVyKTsKICAgICAg\nICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBSZW1vdmUgdGhlIGdpdmVuIGxp\nc3RlbmVyLgogICAgICovCiAgICBwdWJsaWMgc3luY2hyb25pemVkIHZvaWQg\ncmVtb3ZlTGlzdGVuZXIoT2JqZWN0IGxpc3RlbmVyKSB7CiAgICAgICAgaWYg\nKF9maXJpbmcpIHsKICAgICAgICAgICAgX3JlbUxpc3RlbmVycy5hZGQobGlz\ndGVuZXIpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAg\nICBpZiAoX2xpc3RlbmVycyAhPSBudWxsICYmIF9saXN0ZW5lcnMucmVtb3Zl\nKGxpc3RlbmVyKSkKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIGlmIChf\nY2xhc3NMaXN0ZW5lcnMgIT0gbnVsbCkgewogICAgICAgICAgICBMaXN0ZW5l\nckxpc3QgbGlzdGVuZXJzOwogICAgICAgICAgICBmb3IgKEl0ZXJhdG9yIGl0\nciA9IF9jbGFzc0xpc3RlbmVycy52YWx1ZXMoKS5pdGVyYXRvcigpOwogICAg\nICAgICAgICAgICAgaXRyLmhhc05leHQoKTspIHsKICAgICAgICAgICAgICAg\nIGxpc3RlbmVycyA9IChMaXN0ZW5lckxpc3QpIGl0ci5uZXh0KCk7CiAgICAg\nICAgICAgICAgICBsaXN0ZW5lcnMucmVtb3ZlKGxpc3RlbmVyKTsKICAgICAg\nICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIFJldHVy\nbiB3aGV0aGVyIHRoZXJlIGFyZSBsaXN0ZW5lcnMgb3IgY2FsbGJhY2tzIGZv\nciB0aGUgZ2l2ZW4gc291cmNlLgogICAgICovCiAgICBwdWJsaWMgYm9vbGVh\nbiBoYXNQZXJzaXN0TGlzdGVuZXJzKE9iamVjdCBzb3VyY2UsIENsYXNzTWV0\nYURhdGEgbWV0YSkgewogICAgICAgIHJldHVybiBoYXNIYW5kbGVycyhzb3Vy\nY2UsIG1ldGEsIExpZmVjeWNsZUV2ZW50LkJFRk9SRV9QRVJTSVNUKQogICAg\nICAgICAgICB8fCBoYXNIYW5kbGVycyhzb3VyY2UsIG1ldGEsIExpZmVjeWNs\nZUV2ZW50LkFGVEVSX1BFUlNJU1QpOwogICAgfQoKICAgIC8qKgogICAgICog\nUmV0dXJuIHdoZXRoZXIgdGhlcmUgYXJlIGxpc3RlbmVycyBvciBjYWxsYmFj\na3MgZm9yIHRoZSBnaXZlbiBzb3VyY2UuCiAgICAgKi8KICAgIHB1YmxpYyBi\nb29sZWFuIGhhc0RlbGV0ZUxpc3RlbmVycyhPYmplY3Qgc291cmNlLCBDbGFz\nc01ldGFEYXRhIG1ldGEpIHsKICAgICAgICByZXR1cm4gaGFzSGFuZGxlcnMo\nc291cmNlLCBtZXRhLCBMaWZlY3ljbGVFdmVudC5CRUZPUkVfREVMRVRFKQog\nICAgICAgICAgICB8fCBoYXNIYW5kbGVycyhzb3VyY2UsIG1ldGEsIExpZmVj\neWNsZUV2ZW50LkFGVEVSX0RFTEVURSk7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBSZXR1cm4gd2hldGhlciB0aGVyZSBhcmUgbGlzdGVuZXJzIG9yIGNhbGxi\nYWNrcyBmb3IgdGhlIGdpdmVuIHNvdXJjZS4KICAgICAqLwogICAgcHVibGlj\nIGJvb2xlYW4gaGFzQ2xlYXJMaXN0ZW5lcnMoT2JqZWN0IHNvdXJjZSwgQ2xh\nc3NNZXRhRGF0YSBtZXRhKSB7CiAgICAgICAgcmV0dXJuIGhhc0hhbmRsZXJz\nKHNvdXJjZSwgbWV0YSwgTGlmZWN5Y2xlRXZlbnQuQkVGT1JFX0NMRUFSKQog\nICAgICAgICAgICB8fCBoYXNIYW5kbGVycyhzb3VyY2UsIG1ldGEsIExpZmVj\neWNsZUV2ZW50LkFGVEVSX0NMRUFSKTsKICAgIH0KCiAgICAvKioKICAgICAq\nIFJldHVybiB3aGV0aGVyIHRoZXJlIGFyZSBsaXN0ZW5lcnMgb3IgY2FsbGJh\nY2tzIGZvciB0aGUgZ2l2ZW4gc291cmNlLgogICAgICovCiAgICBwdWJsaWMg\nYm9vbGVhbiBoYXNMb2FkTGlzdGVuZXJzKE9iamVjdCBzb3VyY2UsIENsYXNz\nTWV0YURhdGEgbWV0YSkgewogICAgICAgIHJldHVybiBoYXNIYW5kbGVycyhz\nb3VyY2UsIG1ldGEsIExpZmVjeWNsZUV2ZW50LkFGVEVSX0xPQUQpOwogICAg\nfQoKICAgIC8qKgogICAgICogUmV0dXJuIHdoZXRoZXIgdGhlcmUgYXJlIGxp\nc3RlbmVycyBvciBjYWxsYmFja3MgZm9yIHRoZSBnaXZlbiBzb3VyY2UuCiAg\nICAgKi8KICAgIHB1YmxpYyBib29sZWFuIGhhc1N0b3JlTGlzdGVuZXJzKE9i\namVjdCBzb3VyY2UsIENsYXNzTWV0YURhdGEgbWV0YSkgewogICAgICAgIHJl\ndHVybiBoYXNIYW5kbGVycyhzb3VyY2UsIG1ldGEsIExpZmVjeWNsZUV2ZW50\nLkJFRk9SRV9TVE9SRSkKICAgICAgICAgICAgfHwgaGFzSGFuZGxlcnMoc291\ncmNlLCBtZXRhLCBMaWZlY3ljbGVFdmVudC5BRlRFUl9TVE9SRSk7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBSZXR1cm4gd2hldGhlciB0aGVyZSBhcmUgbGlz\ndGVuZXJzIG9yIGNhbGxiYWNrcyBmb3IgdGhlIGdpdmVuIHNvdXJjZS4KICAg\nICAqLwogICAgcHVibGljIGJvb2xlYW4gaGFzRGlydHlMaXN0ZW5lcnMoT2Jq\nZWN0IHNvdXJjZSwgQ2xhc3NNZXRhRGF0YSBtZXRhKSB7CiAgICAgICAgcmV0\ndXJuIGhhc0hhbmRsZXJzKHNvdXJjZSwgbWV0YSwgTGlmZWN5Y2xlRXZlbnQu\nQkVGT1JFX0RJUlRZKQogICAgICAgICAgICB8fCBoYXNIYW5kbGVycyhzb3Vy\nY2UsIG1ldGEsIExpZmVjeWNsZUV2ZW50LkFGVEVSX0RJUlRZKTsKICAgIH0K\nCiAgICAvKioKICAgICAqIFJldHVybiB3aGV0aGVyIHRoZXJlIGFyZSBsaXN0\nZW5lcnMgb3IgY2FsbGJhY2tzIGZvciB0aGUgZ2l2ZW4gc291cmNlLgogICAg\nICovCiAgICBwdWJsaWMgYm9vbGVhbiBoYXNEZXRhY2hMaXN0ZW5lcnMoT2Jq\nZWN0IHNvdXJjZSwgQ2xhc3NNZXRhRGF0YSBtZXRhKSB7CiAgICAgICAgcmV0\ndXJuIGhhc0hhbmRsZXJzKHNvdXJjZSwgbWV0YSwgTGlmZWN5Y2xlRXZlbnQu\nQkVGT1JFX0RFVEFDSCkKICAgICAgICAgICAgfHwgaGFzSGFuZGxlcnMoc291\ncmNlLCBtZXRhLCBMaWZlY3ljbGVFdmVudC5BRlRFUl9ERVRBQ0gpOwogICAg\nfQoKICAgIC8qKgogICAgICogUmV0dXJuIHdoZXRoZXIgdGhlcmUgYXJlIGxp\nc3RlbmVycyBvciBjYWxsYmFja3MgZm9yIHRoZSBnaXZlbiBzb3VyY2UuCiAg\nICAgKi8KICAgIHB1YmxpYyBib29sZWFuIGhhc0F0dGFjaExpc3RlbmVycyhP\nYmplY3Qgc291cmNlLCBDbGFzc01ldGFEYXRhIG1ldGEpIHsKICAgICAgICBy\nZXR1cm4gaGFzSGFuZGxlcnMoc291cmNlLCBtZXRhLCBMaWZlY3ljbGVFdmVu\ndC5CRUZPUkVfQVRUQUNIKQogICAgICAgICAgICB8fCBoYXNIYW5kbGVycyhz\nb3VyY2UsIG1ldGEsIExpZmVjeWNsZUV2ZW50LkFGVEVSX0FUVEFDSCk7CiAg\nICB9CgogICAgcHJpdmF0ZSBib29sZWFuIGhhc0hhbmRsZXJzKE9iamVjdCBz\nb3VyY2UsIENsYXNzTWV0YURhdGEgbWV0YSwgaW50IHR5cGUpIHsKICAgICAg\nICByZXR1cm4gaGFzQ2FsbGJhY2tzKHNvdXJjZSwgbWV0YSwgdHlwZSkKICAg\nICAgICAgICAgfHwgaGFzTGlzdGVuZXJzKHNvdXJjZSwgbWV0YSwgdHlwZSk7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gdHJ1ZSBpZiBhbnkgY2Fs\nbGJhY2tzIGFyZSByZWdpc3RlcmVkIGZvciB0aGUgZ2l2ZW4gc291cmNlIGFu\nZAogICAgICogZXZlbnQgdHlwZS4KICAgICAqLwogICAgcHJpdmF0ZSBib29s\nZWFuIGhhc0NhbGxiYWNrcyhPYmplY3Qgc291cmNlLCBDbGFzc01ldGFEYXRh\nIG1ldGEsIGludCB0eXBlKSB7CiAgICAgICAgTGlmZWN5Y2xlQ2FsbGJhY2tz\nW10gY2FsbGJhY2tzID0gbWV0YS5nZXRMaWZlY3ljbGVNZXRhRGF0YSgpLgog\nICAgICAgICAgICBnZXRDYWxsYmFja3ModHlwZSk7CiAgICAgICAgaWYgKGNh\nbGxiYWNrcy5sZW5ndGggPT0gMCkKICAgICAgICAgICAgcmV0dXJuIGZhbHNl\nOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgY2FsbGJhY2tzLmxlbmd0\naDsgaSsrKQogICAgICAgICAgICBpZiAoY2FsbGJhY2tzW2ldLmhhc0NhbGxi\nYWNrKHNvdXJjZSwgdHlwZSkpCiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1\nZTsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBSZXR1cm4gdHJ1ZSBpZiBhbnkgbGlzdGVuZXJzIGFyZSByZWdpc3RlcmVk\nIGZvciB0aGUgZ2l2ZW4gc291cmNlIGFuZAogICAgICogZXZlbnQgdHlwZS4K\nICAgICAqLwogICAgcHJpdmF0ZSBzeW5jaHJvbml6ZWQgYm9vbGVhbiBoYXNM\naXN0ZW5lcnMoT2JqZWN0IHNvdXJjZSwKICAgICAgICBDbGFzc01ldGFEYXRh\nIG1ldGEsIGludCB0eXBlKSB7CiAgICAgICAgaWYgKG1ldGEuZ2V0TGlmZWN5\nY2xlTWV0YURhdGEoKS5nZXRJZ25vcmVTeXN0ZW1MaXN0ZW5lcnMoKSkKICAg\nICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIGlmIChmaXJlRXZlbnQo\nbnVsbCwgc291cmNlLCBudWxsLCB0eXBlLCBfbGlzdGVuZXJzLCB0cnVlLCBu\ndWxsKSAKICAgICAgICAgICAgPT0gQm9vbGVhbi5UUlVFKQogICAgICAgICAg\nICByZXR1cm4gdHJ1ZTsKICAgICAgICBMaXN0ZW5lckxpc3Qgc3lzdGVtID0g\nbWV0YS5nZXRSZXBvc2l0b3J5KCkuZ2V0U3lzdGVtTGlzdGVuZXJzKCk7CiAg\nICAgICAgaWYgKCFzeXN0ZW0uaXNFbXB0eSgpICYmIGZpcmVFdmVudChudWxs\nLCBzb3VyY2UsIG51bGwsIHR5cGUsIHN5c3RlbSwKICAgICAgICAgICAgdHJ1\nZSwgbnVsbCkgPT0gQm9vbGVhbi5UUlVFKQogICAgICAgICAgICByZXR1cm4g\ndHJ1ZTsKICAgICAgICBpZiAoX2NsYXNzTGlzdGVuZXJzICE9IG51bGwpIHsK\nICAgICAgICAgICAgQ2xhc3MgYyA9IHNvdXJjZSA9PSBudWxsID8gbWV0YS5n\nZXREZXNjcmliZWRUeXBlKCkgOgogICAgICAgICAgICAgICAgc291cmNlLmdl\ndENsYXNzKCk7CiAgICAgICAgICAgIGRvIHsKICAgICAgICAgICAgICAgIGlm\nIChmaXJlRXZlbnQobnVsbCwgc291cmNlLCBudWxsLCB0eXBlLCAoTGlzdGVu\nZXJMaXN0KQogICAgICAgICAgICAgICAgICAgIF9jbGFzc0xpc3RlbmVycy5n\nZXQoYyksIHRydWUsIG51bGwpID09IEJvb2xlYW4uVFJVRSkKICAgICAgICAg\nICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgICAgIGMgPSBj\nLmdldFN1cGVyY2xhc3MoKTsKICAgICAgICAgICAgfSB3aGlsZSAoYyAhPSBu\ndWxsICYmIGMgIT0gT2JqZWN0LmNsYXNzKTsKICAgICAgICB9CiAgICAgICAg\ncmV0dXJuIGZhbHNlOwogICAgfQoKICAgIC8qKgogICAgICogRmlyZSBsaWZl\nY3ljbGUgZXZlbnQgdG8gYWxsIHJlZ2lzdGVyZWQgbGlzdGVuZXJzIHdpdGhv\ndXQgYW4gYXJndW1lbnQuCiAgICAgKi8KICAgIHB1YmxpYyBFeGNlcHRpb25b\nXSBmaXJlRXZlbnQoT2JqZWN0IHNvdXJjZSwKICAgICAgICBDbGFzc01ldGFE\nYXRhIG1ldGEsIGludCB0eXBlKSB7CiAgICAgICAgcmV0dXJuIGZpcmVFdmVu\ndChzb3VyY2UsIG51bGwsIG1ldGEsIHR5cGUpOwogICAgfQoKICAgIC8qKgog\nICAgICogRmlyZSBsaWZlY3ljbGUgZXZlbnQgdG8gYWxsIHJlZ2lzdGVyZWQg\nbGlzdGVuZXJzLgogICAgICovCiAgICBwdWJsaWMgc3luY2hyb25pemVkIEV4\nY2VwdGlvbltdIGZpcmVFdmVudChPYmplY3Qgc291cmNlLCBPYmplY3QgcmVs\nYXRlZCwKICAgICAgICBDbGFzc01ldGFEYXRhIG1ldGEsIGludCB0eXBlKSB7\nCiAgICAgICAgYm9vbGVhbiByZWVudHJhbnQgPSBfZmlyaW5nOwogICAgICAg\nIF9maXJpbmcgPSB0cnVlOwogICAgICAgIExpc3QgZXhjZXB0aW9ucyA9IChy\nZWVudHJhbnQpID8gbmV3IExpbmtlZExpc3QoKSA6IF9leGNlcHM7CiAgICAg\nICAgTWV0YURhdGFEZWZhdWx0cyBkZWYgPSBtZXRhLmdldFJlcG9zaXRvcnko\nKS5nZXRNZXRhRGF0YUZhY3RvcnkoKS4KICAgICAgICAgICAgZ2V0RGVmYXVs\ndHMoKTsKCiAgICAgICAgYm9vbGVhbiBjYWxsYmFja3MgPSBkZWYuZ2V0Q2Fs\nbGJhY2tzQmVmb3JlTGlzdGVuZXJzKHR5cGUpOwogICAgICAgIGlmIChjYWxs\nYmFja3MpCiAgICAgICAgICAgIG1ha2VDYWxsYmFja3Moc291cmNlLCByZWxh\ndGVkLCBtZXRhLCB0eXBlLCBleGNlcHRpb25zKTsKCiAgICAgICAgTGlmZWN5\nY2xlRXZlbnQgZXYgPSAoTGlmZWN5Y2xlRXZlbnQpIGZpcmVFdmVudChudWxs\nLCBzb3VyY2UsIHJlbGF0ZWQsCiAgICAgICAgICAgIHR5cGUsIF9saXN0ZW5l\ncnMsIGZhbHNlLCBleGNlcHRpb25zKTsKCiAgICAgICAgaWYgKF9jbGFzc0xp\nc3RlbmVycyAhPSBudWxsKSB7CiAgICAgICAgICAgIENsYXNzIGMgPSBzb3Vy\nY2UgPT0gbnVsbCA/IG1ldGEuZ2V0RGVzY3JpYmVkVHlwZSgpIDoKICAgICAg\nICAgICAgICAgIHNvdXJjZS5nZXRDbGFzcygpOwogICAgICAgICAgICBkbyB7\nCiAgICAgICAgICAgICAgICBldiA9IChMaWZlY3ljbGVFdmVudCkgZmlyZUV2\nZW50KGV2LCBzb3VyY2UsIHJlbGF0ZWQsIHR5cGUsCiAgICAgICAgICAgICAg\nICAgICAgKExpc3RlbmVyTGlzdCkgX2NsYXNzTGlzdGVuZXJzLmdldChjKSwg\nZmFsc2UsIGV4Y2VwdGlvbnMpOwogICAgICAgICAgICAgICAgYyA9IGMuZ2V0\nU3VwZXJjbGFzcygpOwogICAgICAgICAgICB9IHdoaWxlIChjICE9IG51bGwg\nJiYgYyAhPSBPYmplY3QuY2xhc3MpOwogICAgICAgIH0KCiAgICAgICAgLy8g\nbWFrZSBzeXN0ZW0gbGlzdGVuZXJzCiAgICAgICAgaWYgKCFtZXRhLmdldExp\nZmVjeWNsZU1ldGFEYXRhKCkuZ2V0SWdub3JlU3lzdGVtTGlzdGVuZXJzKCkp\nIHsKICAgICAgICAgICAgTGlzdGVuZXJMaXN0IHN5c3RlbSA9IG1ldGEuZ2V0\nUmVwb3NpdG9yeSgpLmdldFN5c3RlbUxpc3RlbmVycygpOwogICAgICAgICAg\nICBmaXJlRXZlbnQoZXYsIHNvdXJjZSwgcmVsYXRlZCwgdHlwZSwgc3lzdGVt\nLCBmYWxzZSwgZXhjZXB0aW9ucyk7CiAgICAgICAgfQoKICAgICAgICBpZiAo\nIWNhbGxiYWNrcykKICAgICAgICAgICAgbWFrZUNhbGxiYWNrcyhzb3VyY2Us\nIHJlbGF0ZWQsIG1ldGEsIHR5cGUsIGV4Y2VwdGlvbnMpOwoKICAgICAgICAv\nLyBjcmVhdGUgcmV0dXJuIGFycmF5IGJlZm9yZSBjbGVhcmluZyBleGNlcHRp\nb25zCiAgICAgICAgRXhjZXB0aW9uW10gcmV0OwogICAgICAgIGlmIChleGNl\ncHRpb25zLmlzRW1wdHkoKSkKICAgICAgICAgICAgcmV0ID0gRU1QVFlfRVhD\nRVBUSU9OUzsKICAgICAgICBlbHNlCiAgICAgICAgICAgIHJldCA9IChFeGNl\ncHRpb25bXSkgZXhjZXB0aW9ucy50b0FycmF5CiAgICAgICAgICAgICAgICAo\nbmV3IEV4Y2VwdGlvbltleGNlcHRpb25zLnNpemUoKV0pOwoKICAgICAgICAv\nLyBpZiB0aGlzIHdhc24ndCBhIHJlZW50cmFudCBjYWxsLCBjYXRjaCB1cCB3\naXRoIGNhbGxzIHRvIGFkZAogICAgICAgIC8vIGFuZCByZW1vdmUgbGlzdGVu\nZXJzIG1hZGUgd2hpbGUgZmlyaW5nCiAgICAgICAgaWYgKCFyZWVudHJhbnQp\nIHsKICAgICAgICAgICAgX2ZpcmluZyA9IGZhbHNlOwogICAgICAgICAgICBf\nZmFpbCA9IGZhbHNlOwogICAgICAgICAgICBpZiAoIV9hZGRMaXN0ZW5lcnMu\naXNFbXB0eSgpKQogICAgICAgICAgICAgICAgZm9yIChJdGVyYXRvciBpdHIg\nPSBfYWRkTGlzdGVuZXJzLml0ZXJhdG9yKCk7IGl0ci5oYXNOZXh0KCk7KQog\nICAgICAgICAgICAgICAgICAgIGFkZExpc3RlbmVyKGl0ci5uZXh0KCksIChD\nbGFzc1tdKSBpdHIubmV4dCgpKTsKICAgICAgICAgICAgaWYgKCFfcmVtTGlz\ndGVuZXJzLmlzRW1wdHkoKSkKICAgICAgICAgICAgICAgIGZvciAoSXRlcmF0\nb3IgaXRyID0gX3JlbUxpc3RlbmVycy5pdGVyYXRvcigpOyBpdHIuaGFzTmV4\ndCgpOykKICAgICAgICAgICAgICAgICAgICByZW1vdmVMaXN0ZW5lcihpdHIu\nbmV4dCgpKTsKICAgICAgICAgICAgX2FkZExpc3RlbmVycy5jbGVhcigpOwog\nICAgICAgICAgICBfcmVtTGlzdGVuZXJzLmNsZWFyKCk7CiAgICAgICAgICAg\nIF9leGNlcHMuY2xlYXIoKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHJl\ndDsKICAgIH0KCiAgICAvKioKICAgICAqIE1ha2UgY2FsbGJhY2tzLCByZWNv\ncmRpbmcgYW55IGV4Y2VwdGlvbnMgaW4gdGhlIGdpdmVuIGNvbGxlY3Rpb24u\nCiAgICAgKi8KICAgIHByaXZhdGUgdm9pZCBtYWtlQ2FsbGJhY2tzKE9iamVj\ndCBzb3VyY2UsIE9iamVjdCByZWxhdGVkLAogICAgICAgIENsYXNzTWV0YURh\ndGEgbWV0YSwgaW50IHR5cGUsIENvbGxlY3Rpb24gZXhjZXB0aW9ucykgewog\nICAgICAgIC8vIG1ha2UgbGlmZWN5Y2xlIGNhbGxiYWNrcwogICAgICAgIExp\nZmVjeWNsZUNhbGxiYWNrc1tdIGNhbGxiYWNrcyA9IG1ldGEuZ2V0TGlmZWN5\nY2xlTWV0YURhdGEoKS4KICAgICAgICAgICAgZ2V0Q2FsbGJhY2tzKHR5cGUp\nOwogICAgICAgIGZvciAoaW50IGkgPSAwOyAhX2ZhaWwgJiYgaSA8IGNhbGxi\nYWNrcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICB0cnkgewogICAgICAg\nICAgICAgICAgY2FsbGJhY2tzW2ldLm1ha2VDYWxsYmFjayhzb3VyY2UsIHJl\nbGF0ZWQsIHR5cGUpOwogICAgICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24g\nZSkgewogICAgICAgICAgICAgICAgZXhjZXB0aW9ucy5hZGQoZSk7CiAgICAg\nICAgICAgICAgICBpZiAoX2ZhaWxGYXN0KQogICAgICAgICAgICAgICAgICAg\nIF9mYWlsID0gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0K\nCiAgICAvKioKICAgICAqIEZpcmUgYW4gZXZlbnQgd2l0aCB0aGUgZ2l2ZW4g\nc291cmNlIGFuZCB0eXBlIHRvIHRoZSBnaXZlbiBsaXN0IG9mCiAgICAgKiBs\naXN0ZW5lcnMuIFRoZSBldmVudCBtYXkgaGF2ZSBhbHJlYWR5IGJlZW4gY29u\nc3RydWN0ZWQuCiAgICAgKi8KICAgIHByaXZhdGUgT2JqZWN0IGZpcmVFdmVu\ndChMaWZlY3ljbGVFdmVudCBldiwgT2JqZWN0IHNvdXJjZSwgT2JqZWN0IHJl\nbCwKICAgICAgICBpbnQgdHlwZSwgTGlzdGVuZXJMaXN0IGxpc3RlbmVycywg\nYm9vbGVhbiBtb2NrLCBMaXN0IGV4Y2VwdGlvbnMpIHsKICAgICAgICBpZiAo\nbGlzdGVuZXJzID09IG51bGwgfHwgIWxpc3RlbmVycy5oYXNMaXN0ZW5lcnMo\ndHlwZSkpCiAgICAgICAgICAgIHJldHVybiBudWxsOwoKICAgICAgICBPYmpl\nY3QgbGlzdGVuZXI7CiAgICAgICAgYm9vbGVhbiByZXNwb25kczsKICAgICAg\nICBmb3IgKGludCBpID0gMCwgc2l6ZSA9IGxpc3RlbmVycy5zaXplKCk7ICFf\nZmFpbCAmJiBpIDwgc2l6ZTsgaSsrKSB7CiAgICAgICAgICAgIGxpc3RlbmVy\nID0gbGlzdGVuZXJzLmdldChpKTsKICAgICAgICAgICAgaWYgKHNpemUgPT0g\nMSkKICAgICAgICAgICAgICAgIHJlc3BvbmRzID0gdHJ1ZTsKICAgICAgICAg\nICAgZWxzZSBpZiAobGlzdGVuZXIgaW5zdGFuY2VvZiBMaXN0ZW5lckFkYXB0\nZXIpIHsKICAgICAgICAgICAgICAgIHJlc3BvbmRzID0gKChMaXN0ZW5lckFk\nYXB0ZXIpIGxpc3RlbmVyKS5yZXNwb25kc1RvKHR5cGUpOwogICAgICAgICAg\nICAgICAgaWYgKCFyZXNwb25kcykKICAgICAgICAgICAgICAgICAgICBjb250\naW51ZTsKICAgICAgICAgICAgfSBlbHNlCiAgICAgICAgICAgICAgICByZXNw\nb25kcyA9IGZhbHNlOwoKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAg\nICAgIHN3aXRjaCAodHlwZSkgewogICAgICAgICAgICAgICAgICAgIGNhc2Ug\nTGlmZWN5Y2xlRXZlbnQuQkVGT1JFX0NMRUFSOgogICAgICAgICAgICAgICAg\nICAgIGNhc2UgTGlmZWN5Y2xlRXZlbnQuQUZURVJfQ0xFQVI6CiAgICAgICAg\nICAgICAgICAgICAgICAgIGlmIChyZXNwb25kcyB8fCBsaXN0ZW5lciBpbnN0\nYW5jZW9mIENsZWFyTGlzdGVuZXIpIHsKICAgICAgICAgICAgICAgICAgICAg\nICAgICAgIGlmIChtb2NrKQogICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgIHJldHVybiBCb29sZWFuLlRSVUU7CiAgICAgICAgICAgICAgICAgICAg\nICAgICAgICBpZiAoZXYgPT0gbnVsbCkKICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICBldiA9IG5ldyBMaWZlY3ljbGVFdmVudChzb3VyY2UsIHR5\ncGUpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGUgPT0g\nTGlmZWN5Y2xlRXZlbnQuQkVGT1JFX0NMRUFSKQogICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICgoQ2xlYXJMaXN0ZW5lcikgbGlzdGVuZXIpLmJl\nZm9yZUNsZWFyKGV2KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVs\nc2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoKENsZWFyTGlz\ndGVuZXIpIGxpc3RlbmVyKS5hZnRlckNsZWFyKGV2KTsKICAgICAgICAgICAg\nICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsK\nICAgICAgICAgICAgICAgICAgICBjYXNlIExpZmVjeWNsZUV2ZW50LkJFRk9S\nRV9QRVJTSVNUOgogICAgICAgICAgICAgICAgICAgIGNhc2UgTGlmZWN5Y2xl\nRXZlbnQuQUZURVJfUEVSU0lTVDoKICAgICAgICAgICAgICAgICAgICAgICAg\naWYgKHJlc3BvbmRzIHx8IGxpc3RlbmVyIGluc3RhbmNlb2YgUGVyc2lzdExp\nc3RlbmVyKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobW9j\naykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gQm9v\nbGVhbi5UUlVFOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGV2\nID09IG51bGwpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXYg\nPSBuZXcgTGlmZWN5Y2xlRXZlbnQoc291cmNlLCB0eXBlKTsKICAgICAgICAg\nICAgICAgICAgICAgICAgICAgIGlmICh0eXBlID09IExpZmVjeWNsZUV2ZW50\nLkJFRk9SRV9QRVJTSVNUKQogICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICgoUGVyc2lzdExpc3RlbmVyKSBsaXN0ZW5lcikuYmVmb3JlUGVyc2lz\ndChldik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgKChQZXJzaXN0TGlzdGVuZXIp\nIGxpc3RlbmVyKS5hZnRlclBlcnNpc3QoZXYpOwogICAgICAgICAgICAgICAg\nICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAg\nICAgICAgICAgICAgICAgIGNhc2UgTGlmZWN5Y2xlRXZlbnQuQkVGT1JFX0RF\nTEVURToKICAgICAgICAgICAgICAgICAgICBjYXNlIExpZmVjeWNsZUV2ZW50\nLkFGVEVSX0RFTEVURToKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJl\nc3BvbmRzIHx8IGxpc3RlbmVyIGluc3RhbmNlb2YgRGVsZXRlTGlzdGVuZXIp\nIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtb2NrKQogICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBCb29sZWFuLlRS\nVUU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXYgPT0gbnVs\nbCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBldiA9IG5ldyBM\naWZlY3ljbGVFdmVudChzb3VyY2UsIHR5cGUpOwogICAgICAgICAgICAgICAg\nICAgICAgICAgICAgaWYgKHR5cGUgPT0gTGlmZWN5Y2xlRXZlbnQuQkVGT1JF\nX0RFTEVURSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoKERl\nbGV0ZUxpc3RlbmVyKSBsaXN0ZW5lcikuYmVmb3JlRGVsZXRlKGV2KTsKICAg\nICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAoKERlbGV0ZUxpc3RlbmVyKSBsaXN0ZW5lciku\nYWZ0ZXJEZWxldGUoZXYpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAg\nICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAg\nICAgIGNhc2UgTGlmZWN5Y2xlRXZlbnQuQkVGT1JFX0RJUlRZOgogICAgICAg\nICAgICAgICAgICAgIGNhc2UgTGlmZWN5Y2xlRXZlbnQuQUZURVJfRElSVFk6\nCiAgICAgICAgICAgICAgICAgICAgY2FzZSBMaWZlY3ljbGVFdmVudC5CRUZP\nUkVfRElSVFlfRkxVU0hFRDoKICAgICAgICAgICAgICAgICAgICBjYXNlIExp\nZmVjeWNsZUV2ZW50LkFGVEVSX0RJUlRZX0ZMVVNIRUQ6CiAgICAgICAgICAg\nICAgICAgICAgICAgIGlmIChyZXNwb25kcyB8fCBsaXN0ZW5lciBpbnN0YW5j\nZW9mIERpcnR5TGlzdGVuZXIpIHsKICAgICAgICAgICAgICAgICAgICAgICAg\nICAgIGlmIChtb2NrKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nIHJldHVybiBCb29sZWFuLlRSVUU7CiAgICAgICAgICAgICAgICAgICAgICAg\nICAgICBpZiAoZXYgPT0gbnVsbCkKICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICBldiA9IG5ldyBMaWZlY3ljbGVFdmVudChzb3VyY2UsIHR5cGUp\nOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoICh0eXBlKSB7\nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBMaWZlY3lj\nbGVFdmVudC5CRUZPUkVfRElSVFk6CiAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICgoRGlydHlMaXN0ZW5lcikgbGlzdGVuZXIpLmJlZm9y\nZURpcnR5KGV2KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2Fz\nZSBMaWZlY3ljbGVFdmVudC5BRlRFUl9ESVJUWToKICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgKChEaXJ0eUxpc3RlbmVyKSBsaXN0ZW5l\ncikuYWZ0ZXJEaXJ0eShldik7CiAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgIGNhc2UgTGlmZWN5Y2xlRXZlbnQuQkVGT1JFX0RJUlRZX0ZMVVNIRUQ6\nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICgoRGlydHlM\naXN0ZW5lcikgbGlzdGVuZXIpCiAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAuYmVmb3JlRGlydHlGbHVzaGVkKGV2KTsKICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBMaWZlY3ljbGVFdmVudC5B\nRlRFUl9ESVJUWV9GTFVTSEVEOgogICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAoKERpcnR5TGlzdGVuZXIpIGxpc3RlbmVyKQogICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmFmdGVyRGlydHlG\nbHVzaGVkKGV2KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAg\nICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAg\nYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgY2FzZSBMaWZlY3ljbGVFdmVu\ndC5BRlRFUl9MT0FEOgogICAgICAgICAgICAgICAgICAgIGNhc2UgTGlmZWN5\nY2xlRXZlbnQuQUZURVJfUkVGUkVTSDoKICAgICAgICAgICAgICAgICAgICAg\nICAgaWYgKHJlc3BvbmRzIHx8IGxpc3RlbmVyIGluc3RhbmNlb2YgTG9hZExp\nc3RlbmVyKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobW9j\naykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gQm9v\nbGVhbi5UUlVFOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGV2\nID09IG51bGwpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXYg\nPSBuZXcgTGlmZWN5Y2xlRXZlbnQoc291cmNlLCB0eXBlKTsKICAgICAgICAg\nICAgICAgICAgICAgICAgICAgIGlmICh0eXBlID09IExpZmVjeWNsZUV2ZW50\nLkFGVEVSX0xPQUQpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nKChMb2FkTGlzdGVuZXIpIGxpc3RlbmVyKS5hZnRlckxvYWQoZXYpOwogICAg\nICAgICAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICgoTG9hZExpc3RlbmVyKSBsaXN0ZW5lcikuYWZ0\nZXJSZWZyZXNoKGV2KTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAg\nICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAg\nICBjYXNlIExpZmVjeWNsZUV2ZW50LkJFRk9SRV9TVE9SRToKICAgICAgICAg\nICAgICAgICAgICBjYXNlIExpZmVjeWNsZUV2ZW50LkFGVEVSX1NUT1JFOgog\nICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzcG9uZHMgfHwgbGlzdGVu\nZXIgaW5zdGFuY2VvZiBTdG9yZUxpc3RlbmVyKSB7CiAgICAgICAgICAgICAg\nICAgICAgICAgICAgICBpZiAobW9jaykKICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICByZXR1cm4gQm9vbGVhbi5UUlVFOwogICAgICAgICAgICAg\nICAgICAgICAgICAgICAgaWYgKGV2ID09IG51bGwpCiAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgZXYgPSBuZXcgTGlmZWN5Y2xlRXZlbnQoc291\ncmNlLCB0eXBlKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0\neXBlID09IExpZmVjeWNsZUV2ZW50LkJFRk9SRV9TVE9SRSkKICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAoKFN0b3JlTGlzdGVuZXIpIGxpc3Rl\nbmVyKS5iZWZvcmVTdG9yZShldik7CiAgICAgICAgICAgICAgICAgICAgICAg\nICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKChT\ndG9yZUxpc3RlbmVyKSBsaXN0ZW5lcikuYWZ0ZXJTdG9yZShldik7CiAgICAg\nICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAg\nYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgY2FzZSBMaWZlY3ljbGVFdmVu\ndC5CRUZPUkVfREVUQUNIOgogICAgICAgICAgICAgICAgICAgIGNhc2UgTGlm\nZWN5Y2xlRXZlbnQuQUZURVJfREVUQUNIOgogICAgICAgICAgICAgICAgICAg\nICAgICBpZiAocmVzcG9uZHMgfHwgbGlzdGVuZXIgaW5zdGFuY2VvZiBEZXRh\nY2hMaXN0ZW5lcikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYg\nKG1vY2spCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJu\nIEJvb2xlYW4uVFJVRTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlm\nIChldiA9PSBudWxsKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nIGV2ID0gbmV3IExpZmVjeWNsZUV2ZW50KHNvdXJjZSwgcmVsLCB0eXBlKTsK\nICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0eXBlID09IExpZmVj\neWNsZUV2ZW50LkJFRk9SRV9ERVRBQ0gpCiAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgKChEZXRhY2hMaXN0ZW5lcikgbGlzdGVuZXIpLmJlZm9y\nZURldGFjaChldik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNl\nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKChEZXRhY2hMaXN0\nZW5lcikgbGlzdGVuZXIpLmFmdGVyRGV0YWNoKGV2KTsKICAgICAgICAgICAg\nICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsK\nICAgICAgICAgICAgICAgICAgICBjYXNlIExpZmVjeWNsZUV2ZW50LkJFRk9S\nRV9BVFRBQ0g6CiAgICAgICAgICAgICAgICAgICAgY2FzZSBMaWZlY3ljbGVF\ndmVudC5BRlRFUl9BVFRBQ0g6CiAgICAgICAgICAgICAgICAgICAgICAgIGlm\nIChyZXNwb25kcyB8fCBsaXN0ZW5lciBpbnN0YW5jZW9mIEF0dGFjaExpc3Rl\nbmVyKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobW9jaykK\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gQm9vbGVh\nbi5UUlVFOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGV2ID09\nIG51bGwpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXYgPSBu\nZXcgTGlmZWN5Y2xlRXZlbnQoc291cmNlLCByZWwsIHR5cGUpOwogICAgICAg\nICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGUgPT0gTGlmZWN5Y2xlRXZl\nbnQuQkVGT1JFX0FUVEFDSCkKICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAoKEF0dGFjaExpc3RlbmVyKSBsaXN0ZW5lcikuYmVmb3JlQXR0YWNo\nKGV2KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAoKEF0dGFjaExpc3RlbmVyKSBs\naXN0ZW5lcikuYWZ0ZXJBdHRhY2goZXYpOwogICAgICAgICAgICAgICAgICAg\nICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAg\nICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhdGNoIChF\neGNlcHRpb24gZSkgewogICAgICAgICAgICAgICAgZXhjZXB0aW9ucy5hZGQo\nZSk7CiAgICAgICAgICAgICAgICBpZiAoX2ZhaWxGYXN0KQogICAgICAgICAg\nICAgICAgICAgIF9mYWlsID0gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAg\nIH0KICAgICAgICByZXR1cm4gZXY7CiAgICB9CgogICAgLyoqCiAgICAgKiBJ\nbnRlcmZhY2UgdGhhdCBmYWNhZGVzIHRvIG90aGVyIGxpZmVjeWNsZSBsaXN0\nZW5lciBpbnRlcmZhY2VzIGNhbgogICAgICogaW1wbGVtZW50IHRvIGNob29z\nZSB3aGljaCBldmVudHMgdG8gcmVzcG9uZCB0byBiYXNlZCBvbiB0aGVpciBk\nZWxlZ2F0ZS4KICAgICAqIFRoaXMgaXMgbW9yZSBlZmZpY2llbnQgdGhhbiBy\nZWdpc3RlcmluZyBhcyBhIGxpc3RlbmVyIGZvciBhbGwgZXZlbnRzCiAgICAg\nKiBidXQgb25seSByZXNwb25kaW5nIHRvIHNvbWUuCiAgICAgKi8KICAgIHB1\nYmxpYyBzdGF0aWMgaW50ZXJmYWNlIExpc3RlbmVyQWRhcHRlciB7CgogICAg\nICAgIC8qKgogICAgICAgICAqIFJldHVybiB3aGV0aGVyIHRoaXMgaW5zdGFu\nY2UgcmVzcG9uZHMgdG8gdGhlIGdpdmVuIGV2ZW50IHR5cGUgZnJvbQogICAg\nICAgICAqIHtAbGluayBMaWZlY3ljbGVFdmVudH0uCiAgICAgICAgICovCiAg\nICAgICAgcHVibGljIGJvb2xlYW4gcmVzcG9uZHNUbyhpbnQgZXZlbnRUeXBl\nKTsKICAgIH0KCiAgICAvKioKICAgICAqIEV4dGVuZGVkIGxpc3QgdGhhdCB0\ncmFja3Mgd2hhdCBldmVudCB0eXBlcyBpdHMgZWxlbWVudHMgY2FyZSBhYm91\ndC4KICAgICAqIE1haW50YWlucyBzZXQgc2VtYW50aWNzIGFzIHdlbGwuCiAg\nICAgKi8KICAgIHB1YmxpYyBzdGF0aWMgY2xhc3MgTGlzdGVuZXJMaXN0CiAg\nICAgICAgZXh0ZW5kcyBBcnJheUxpc3QgewoKICAgICAgICBwcml2YXRlIGlu\ndCBfdHlwZXMgPSAwOwoKICAgICAgICBwdWJsaWMgTGlzdGVuZXJMaXN0KGlu\ndCBzaXplKSB7CiAgICAgICAgICAgIHN1cGVyKHNpemUpOwogICAgICAgIH0K\nCiAgICAgICAgcHVibGljIExpc3RlbmVyTGlzdChMaXN0ZW5lckxpc3QgY29w\neSkgewogICAgICAgICAgICBzdXBlcihjb3B5KTsKICAgICAgICAgICAgX3R5\ncGVzID0gY29weS5fdHlwZXM7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMg\nYm9vbGVhbiBoYXNMaXN0ZW5lcnMoaW50IHR5cGUpIHsKICAgICAgICAgICAg\ncmV0dXJuIChfdHlwZXMgJiAoMiA8PCB0eXBlKSkgPiAwOwogICAgICAgIH0K\nCiAgICAgICAgcHVibGljIGJvb2xlYW4gYWRkKE9iamVjdCBsaXN0ZW5lcikg\newogICAgICAgICAgICBpZiAoY29udGFpbnMobGlzdGVuZXIpKQogICAgICAg\nICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICBzdXBlci5hZGQo\nbGlzdGVuZXIpOwogICAgICAgICAgICBfdHlwZXMgfD0gZ2V0RXZlbnRUeXBl\ncyhsaXN0ZW5lcik7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAg\nIH0KCiAgICAgICAgcHVibGljIGJvb2xlYW4gcmVtb3ZlKE9iamVjdCBsaXN0\nZW5lcikgewogICAgICAgICAgICBpZiAoIXN1cGVyLnJlbW92ZShsaXN0ZW5l\ncikpCiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgogICAgICAgICAg\nICAvLyByZWNvbXB1dGUgdHlwZXMgbWFzawogICAgICAgICAgICBfdHlwZXMg\nPSAwOwogICAgICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IHNpemUoKTsg\naSsrKQogICAgICAgICAgICAgICAgX3R5cGVzIHw9IGdldEV2ZW50VHlwZXMo\nZ2V0KGkpKTsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQoK\nICAgICAgICAvKioKICAgICAgICAgKiBSZXR1cm4gYSBtYXNrIG9mIHRoZSBl\ndmVudCB0eXBlcyB0aGUgZ2l2ZW4gbGlzdGVuZXIgcHJvY2Vzc2VzLgogICAg\nICAgICAqLwogICAgICAgIHByaXZhdGUgc3RhdGljIGludCBnZXRFdmVudFR5\ncGVzKE9iamVjdCBsaXN0ZW5lcikgewogICAgICAgICAgICBpbnQgdHlwZXMg\nPSAwOwogICAgICAgICAgICBpZiAobGlzdGVuZXIgaW5zdGFuY2VvZiBMaXN0\nZW5lckFkYXB0ZXIpIHsKICAgICAgICAgICAgICAgIExpc3RlbmVyQWRhcHRl\nciBhZGFwdGVyID0gKExpc3RlbmVyQWRhcHRlcikgbGlzdGVuZXI7CiAgICAg\nICAgICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IExpZmVjeWNsZUV2ZW50\nLkFMTF9FVkVOVFMubGVuZ3RoOyBpKyspCiAgICAgICAgICAgICAgICAgICAg\naWYgKGFkYXB0ZXIucmVzcG9uZHNUbyhMaWZlY3ljbGVFdmVudC5BTExfRVZF\nTlRTW2ldKSkKICAgICAgICAgICAgICAgICAgICAgICAgdHlwZXMgfD0gMiA8\nPCBMaWZlY3ljbGVFdmVudC5BTExfRVZFTlRTW2ldOwogICAgICAgICAgICAg\nICAgcmV0dXJuIHR5cGVzOwogICAgICAgICAgICB9CgogICAgICAgICAgICBp\nZiAobGlzdGVuZXIgaW5zdGFuY2VvZiBQZXJzaXN0TGlzdGVuZXIpIHsKICAg\nICAgICAgICAgICAgIHR5cGVzIHw9IDIgPDwgTGlmZWN5Y2xlRXZlbnQuQkVG\nT1JFX1BFUlNJU1Q7CiAgICAgICAgICAgICAgICB0eXBlcyB8PSAyIDw8IExp\nZmVjeWNsZUV2ZW50LkFGVEVSX1BFUlNJU1Q7CiAgICAgICAgICAgIH0KICAg\nICAgICAgICAgaWYgKGxpc3RlbmVyIGluc3RhbmNlb2YgQ2xlYXJMaXN0ZW5l\ncikgewogICAgICAgICAgICAgICAgdHlwZXMgfD0gMiA8PCBMaWZlY3ljbGVF\ndmVudC5CRUZPUkVfQ0xFQVI7CiAgICAgICAgICAgICAgICB0eXBlcyB8PSAy\nIDw8IExpZmVjeWNsZUV2ZW50LkFGVEVSX0NMRUFSOwogICAgICAgICAgICB9\nCiAgICAgICAgICAgIGlmIChsaXN0ZW5lciBpbnN0YW5jZW9mIERlbGV0ZUxp\nc3RlbmVyKSB7CiAgICAgICAgICAgICAgICB0eXBlcyB8PSAyIDw8IExpZmVj\neWNsZUV2ZW50LkJFRk9SRV9ERUxFVEU7CiAgICAgICAgICAgICAgICB0eXBl\ncyB8PSAyIDw8IExpZmVjeWNsZUV2ZW50LkFGVEVSX0RFTEVURTsKICAgICAg\nICAgICAgfQogICAgICAgICAgICBpZiAobGlzdGVuZXIgaW5zdGFuY2VvZiBE\naXJ0eUxpc3RlbmVyKSB7CiAgICAgICAgICAgICAgICB0eXBlcyB8PSAyIDw8\nIExpZmVjeWNsZUV2ZW50LkJFRk9SRV9ESVJUWTsKICAgICAgICAgICAgICAg\nIHR5cGVzIHw9IDIgPDwgTGlmZWN5Y2xlRXZlbnQuQUZURVJfRElSVFk7CiAg\nICAgICAgICAgICAgICB0eXBlcyB8PSAyIDw8IExpZmVjeWNsZUV2ZW50LkJF\nRk9SRV9ESVJUWV9GTFVTSEVEOwogICAgICAgICAgICAgICAgdHlwZXMgfD0g\nMiA8PCBMaWZlY3ljbGVFdmVudC5BRlRFUl9ESVJUWV9GTFVTSEVEOwogICAg\nICAgICAgICB9CiAgICAgICAgICAgIGlmIChsaXN0ZW5lciBpbnN0YW5jZW9m\nIExvYWRMaXN0ZW5lcikKICAgICAgICAgICAgICAgIHR5cGVzIHw9IDIgPDwg\nTGlmZWN5Y2xlRXZlbnQuQUZURVJfTE9BRDsKICAgICAgICAgICAgaWYgKGxp\nc3RlbmVyIGluc3RhbmNlb2YgU3RvcmVMaXN0ZW5lcikgewogICAgICAgICAg\nICAgICAgdHlwZXMgfD0gMiA8PCBMaWZlY3ljbGVFdmVudC5CRUZPUkVfU1RP\nUkU7CiAgICAgICAgICAgICAgICB0eXBlcyB8PSAyIDw8IExpZmVjeWNsZUV2\nZW50LkFGVEVSX1NUT1JFOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlm\nIChsaXN0ZW5lciBpbnN0YW5jZW9mIERldGFjaExpc3RlbmVyKSB7CiAgICAg\nICAgICAgICAgICB0eXBlcyB8PSAyIDw8IExpZmVjeWNsZUV2ZW50LkJFRk9S\nRV9ERVRBQ0g7CiAgICAgICAgICAgICAgICB0eXBlcyB8PSAyIDw8IExpZmVj\neWNsZUV2ZW50LkFGVEVSX0RFVEFDSDsKICAgICAgICAgICAgfQogICAgICAg\nICAgICBpZiAobGlzdGVuZXIgaW5zdGFuY2VvZiBBdHRhY2hMaXN0ZW5lcikg\newogICAgICAgICAgICAgICAgdHlwZXMgfD0gMiA8PCBMaWZlY3ljbGVFdmVu\ndC5CRUZPUkVfQVRUQUNIOwogICAgICAgICAgICAgICAgdHlwZXMgfD0gMiA8\nPCBMaWZlY3ljbGVFdmVudC5BRlRFUl9BVFRBQ0g7CgkJCX0KCQkJcmV0dXJu\nIHR5cGVzOwoJCX0KCX0KfQo=\n","encoding":"base64"}

