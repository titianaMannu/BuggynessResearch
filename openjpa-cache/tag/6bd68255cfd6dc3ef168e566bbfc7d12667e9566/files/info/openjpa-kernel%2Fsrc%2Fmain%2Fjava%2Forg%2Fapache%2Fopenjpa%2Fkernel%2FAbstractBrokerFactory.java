{"sha":"af5e1732824a0e201c3fcfd5b7dd08fdca1a14e3","node_id":"MDQ6QmxvYjIwNjM2NDphZjVlMTczMjgyNGEwZTIwMWMzZmNmZDViN2RkMDhmZGNhMWExNGUz","size":27700,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/af5e1732824a0e201c3fcfd5b7dd08fdca1a14e3","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsOwoKaW1wb3J0IGph\ndmEuaW8uT2JqZWN0U3RyZWFtRXhjZXB0aW9uOwppbXBvcnQgamF2YS51dGls\nLkFycmF5TGlzdDsKaW1wb3J0IGphdmEudXRpbC5Db2xsZWN0aW9uOwppbXBv\ncnQgamF2YS51dGlsLkNvbGxlY3Rpb25zOwppbXBvcnQgamF2YS51dGlsLkhh\nc2hNYXA7CmltcG9ydCBqYXZhLnV0aWwuSXRlcmF0b3I7CmltcG9ydCBqYXZh\nLnV0aWwuTWFwOwppbXBvcnQgamF2YS51dGlsLlByb3BlcnRpZXM7CmltcG9y\ndCBqYXZhLnV0aWwuTGlua2VkTGlzdDsKaW1wb3J0IGphdmEudXRpbC5MaXN0\nOwppbXBvcnQgamF2YS5sYW5nLnJlZmxlY3QuSW52b2NhdGlvblRhcmdldEV4\nY2VwdGlvbjsKaW1wb3J0IGphdmF4LnRyYW5zYWN0aW9uLlN0YXR1czsKaW1w\nb3J0IGphdmF4LnRyYW5zYWN0aW9uLlN5bmNocm9uaXphdGlvbjsKaW1wb3J0\nIGphdmF4LnRyYW5zYWN0aW9uLlRyYW5zYWN0aW9uOwppbXBvcnQgamF2YXgu\ndHJhbnNhY3Rpb24uVHJhbnNhY3Rpb25NYW5hZ2VyOwoKaW1wb3J0IG9yZy5h\ncGFjaGUuY29tbW9ucy5sYW5nLlN0cmluZ1V0aWxzOwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLmNvbmYuT3BlbkpQQUNvbmZpZ3VyYXRpb247CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEuY29uZi5PcGVuSlBBVmVyc2lvbjsKaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5kYXRhY2FjaGUuRGF0YUNhY2hlU3Rv\ncmVNYW5hZ2VyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmVlLk1hbmFn\nZWRSdW50aW1lOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmVuaGFuY2Uu\nUENSZWdpc3RyeTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5lbmhhbmNl\nLlBlcnNpc3RlbmNlQ2FwYWJsZTsKaW1wb3J0IG9yZy5hcGFjaGUub3Blbmpw\nYS5ldmVudC5SZW1vdGVDb21taXRFdmVudE1hbmFnZXI7CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEuZXZlbnQuQnJva2VyRmFjdG9yeUV2ZW50OwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi5sb2cuTG9nOwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLmxpYi51dGlsLkoyRG9Qcml2SGVscGVyOwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51dGlsLkxvY2FsaXplcjsKaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIudXRpbC5SZWZlcmVuY2VIYXNo\nU2V0OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51dGlsLkphdmFW\nZXJzaW9uczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIudXRpbC5j\nb25jdXJyZW50LkNvbmN1cnJlbnRIYXNoTWFwOwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLmxpYi51dGlsLmNvbmN1cnJlbnQuQ29uY3VycmVudFJlZmVy\nZW5jZUhhc2hTZXQ7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0\naWwuY29uY3VycmVudC5SZWVudHJhbnRMb2NrOwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLm1ldGEuTWV0YURhdGFSZXBvc2l0b3J5OwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLnV0aWwuR2VuZXJhbEV4Y2VwdGlvbjsKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLkludmFsaWRTdGF0ZUV4Y2VwdGlv\nbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLk9wZW5KUEFFeGNl\ncHRpb247CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5Vc2VyRXhj\nZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuSW50ZXJu\nYWxFeGNlcHRpb247CgovKioKICogQWJzdHJhY3QgaW1wbGVtZW50YXRpb24g\nb2YgdGhlIHtAbGluayBCcm9rZXJGYWN0b3J5fQogKiB0aGF0IG11c3QgYmUg\nc3ViY2xhc3NlZCBmb3IgYSBzcGVjaWZpYyBydW50aW1lLgogKgogKiBAYXV0\naG9yIEFiZSBXaGl0ZQogKi8KcHVibGljIGFic3RyYWN0IGNsYXNzIEFic3Ry\nYWN0QnJva2VyRmFjdG9yeQogICAgaW1wbGVtZW50cyBCcm9rZXJGYWN0b3J5\nIHsKCiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBMb2NhbGl6ZXIgX2xvYyA9\nIExvY2FsaXplci5mb3JQYWNrYWdlCiAgICAgICAgKEFic3RyYWN0QnJva2Vy\nRmFjdG9yeS5jbGFzcyk7CgogICAgLy8gc3RhdGljIG1hcHBpbmcgb2YgY29u\nZmlndXJhdGlvbnMgdG8gcG9vbGVkIGJyb2tlciBmYWN0b3JpZXMKICAgIHBy\naXZhdGUgc3RhdGljIGZpbmFsIE1hcCBfcG9vbCA9IENvbGxlY3Rpb25zLnN5\nbmNocm9uaXplZE1hcChuZXcgSGFzaE1hcCgpKTsKCiAgICAvLyBjb25maWd1\ncmF0aW9uCiAgICBwcml2YXRlIGZpbmFsIE9wZW5KUEFDb25maWd1cmF0aW9u\nIF9jb25mOwogICAgcHJpdmF0ZSB0cmFuc2llbnQgYm9vbGVhbiBfcmVhZE9u\nbHkgPSBmYWxzZTsKICAgIHByaXZhdGUgdHJhbnNpZW50IGJvb2xlYW4gX2Ns\nb3NlZCA9IGZhbHNlOwogICAgcHJpdmF0ZSB0cmFuc2llbnQgUnVudGltZUV4\nY2VwdGlvbiBfY2xvc2VkRXhjZXB0aW9uID0gbnVsbDsKICAgIHByaXZhdGUg\nTWFwIF91c2VyT2JqZWN0cyA9IG51bGw7CgogICAgLy8gaW50ZXJuYWwgbG9j\nazogc3BlYyBmb3JiaWRzIHN5bmNocm9uaXphdGlvbiBvbiB0aGlzIG9iamVj\ndAogICAgcHJpdmF0ZSBmaW5hbCBSZWVudHJhbnRMb2NrIF9sb2NrID0gbmV3\nIFJlZW50cmFudExvY2soKTsKCiAgICAvLyBtYXBzIGdsb2JhbCB0cmFuc2Fj\ndGlvbnMgdG8gYXNzb2NpYXRlZCBicm9rZXJzCiAgICBwcml2YXRlIHRyYW5z\naWVudCBDb25jdXJyZW50SGFzaE1hcCBfdHJhbnNhY3Rpb25hbAogICAgICAg\nID0gbmV3IENvbmN1cnJlbnRIYXNoTWFwKCk7CgogICAgLy8gd2Vhay1yZWYg\ndHJhY2tpbmcgb2Ygb3BlbiBicm9rZXJzCiAgICBwcml2YXRlIHRyYW5zaWVu\ndCBDb2xsZWN0aW9uIF9icm9rZXJzID0gbmV3IENvbmN1cnJlbnRSZWZlcmVu\nY2VIYXNoU2V0CiAgICAgICAgKENvbmN1cnJlbnRSZWZlcmVuY2VIYXNoU2V0\nLldFQUspOwoKICAgIC8vIGNhY2hlIHRoZSBjbGFzcyBuYW1lcyBsb2FkZWQg\nZnJvbSB0aGUgcGVyc2lzdGVudCBjbGFzc2VzIHByb3BlcnR5IHNvCiAgICAv\nLyB0aGF0IHdlIGNhbiByZS1sb2FkIHRoZW0gZm9yIGVhY2ggbmV3IGJyb2tl\ncgogICAgcHJpdmF0ZSB0cmFuc2llbnQgQ29sbGVjdGlvbiBfcGNDbGFzc05h\nbWVzID0gbnVsbDsKICAgIHByaXZhdGUgdHJhbnNpZW50IENvbGxlY3Rpb24g\nX3BjQ2xhc3NMb2FkZXJzID0gbnVsbDsKCiAgICAvLyBsaWZlY3ljbGUgbGlz\ndGVuZXJzIHRvIHBhc3MgdG8gZWFjaCBicm9rZXIKICAgIHByaXZhdGUgdHJh\nbnNpZW50IE1hcCBfbGlmZWN5Y2xlTGlzdGVuZXJzID0gbnVsbDsKCiAgICAv\nLyB0cmFuc2FjdGlvbiBsaXN0ZW5lcnMgdG8gcGFzcyB0byBlYWNoIGJyb2tl\ncgogICAgcHJpdmF0ZSB0cmFuc2llbnQgTGlzdCBfdHJhbnNhY3Rpb25MaXN0\nZW5lcnMgPSBudWxsOwoKICAgIC8qKgogICAgICogUmV0dXJuIHRoZSBwb29s\nZWQgZmFjdG9yeSBtYXRjaGluZyB0aGUgZ2l2ZW4gY29uZmlndXJhdGlvbiwg\nb3IgbnVsbAogICAgICogaWYgbm9uZS4KICAgICAqLwogICAgcHVibGljIHN0\nYXRpYyBBYnN0cmFjdEJyb2tlckZhY3RvcnkgZ2V0UG9vbGVkRmFjdG9yeSgK\nICAgICAgICBPcGVuSlBBQ29uZmlndXJhdGlvbiBjb25mKSB7CiAgICAgICAg\ncmV0dXJuIChBYnN0cmFjdEJyb2tlckZhY3RvcnkpIF9wb29sLmdldCh0b1Bv\nb2xLZXkoY29uZikpOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIGFu\nIGludGVybmFsIGZhY3RvcnkgcG9vbCBrZXkgZm9yIHRoZSBnaXZlbiBjb25m\naWd1cmF0aW9uLgogICAgICogV2UgdXNlIHRoZSBjb25mIHByb3BlcnRpZXMg\nYXMgZ2l2ZW4gYnkgdGhlIHVzZXIgYmVjYXVzZSB0aGF0IGlzIHdoYXQncwog\nICAgICogcGFzc2VkIHRvIHtAbGluayAjZ2V0UG9vbGVkRmFjdG9yeX0gd2hl\nbiBsb29raW5nIGZvciBhbiBleGlzdGluZyBmYWN0b3J5LgogICAgICovCiAg\nICBwcml2YXRlIHN0YXRpYyBNYXAgdG9Qb29sS2V5KE9wZW5KUEFDb25maWd1\ncmF0aW9uIGNvbmYpIHsKICAgICAgICByZXR1cm4gY29uZi50b1Byb3BlcnRp\nZXMoZmFsc2UpOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRoZSBw\nb29sZWQgZmFjdG9yeSBtYXRjaGluZyB0aGUgZ2l2ZW4gY29uZmlndXJhdGlv\nbiBkYXRhLCBvciBudWxsCiAgICAgKiBpZiBub25lLgogICAgICovCiAgICBw\ncm90ZWN0ZWQgc3RhdGljIEFic3RyYWN0QnJva2VyRmFjdG9yeSBnZXRQb29s\nZWRGYWN0b3J5KE1hcCBtYXApIHsKICAgICAgICByZXR1cm4gKEFic3RyYWN0\nQnJva2VyRmFjdG9yeSkgX3Bvb2wuZ2V0KG1hcCk7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBDb25zdHJ1Y3Rvci4gQ29uZmlndXJhdGlvbiBtdXN0IGJlIHBy\nb3ZpZGVkIG9uIGNvbnN0cnVjdGlvbi4KICAgICAqLwogICAgcHJvdGVjdGVk\nIEFic3RyYWN0QnJva2VyRmFjdG9yeShPcGVuSlBBQ29uZmlndXJhdGlvbiBj\nb25maWcpIHsKICAgICAgICBfY29uZiA9IGNvbmZpZzsKICAgIH0KCiAgICAv\nKioKICAgICAqIFJldHVybiB0aGUgY29uZmlndXJhdGlvbiBmb3IgdGhpcyBm\nYWN0b3J5LgogICAgICovCiAgICBwdWJsaWMgT3BlbkpQQUNvbmZpZ3VyYXRp\nb24gZ2V0Q29uZmlndXJhdGlvbigpIHsKICAgICAgICByZXR1cm4gX2NvbmY7\nCiAgICB9CgogICAgcHVibGljIEJyb2tlciBuZXdCcm9rZXIoKSB7CiAgICAg\nICAgcmV0dXJuIG5ld0Jyb2tlcihfY29uZi5nZXRDb25uZWN0aW9uVXNlck5h\nbWUoKSwKICAgICAgICAgICAgX2NvbmYuZ2V0Q29ubmVjdGlvblBhc3N3b3Jk\nKCkpOwogICAgfQoKICAgIHB1YmxpYyBCcm9rZXIgbmV3QnJva2VyKFN0cmlu\nZyB1c2VyLCBTdHJpbmcgcGFzcykgewogICAgICAgIHJldHVybiBuZXdCcm9r\nZXIodXNlciwgcGFzcywgX2NvbmYuaXNUcmFuc2FjdGlvbk1vZGVNYW5hZ2Vk\nKCksCiAgICAgICAgICAgIF9jb25mLmdldENvbm5lY3Rpb25SZXRhaW5Nb2Rl\nQ29uc3RhbnQoKSk7CiAgICB9CgogICAgcHVibGljIEJyb2tlciBuZXdCcm9r\nZXIoYm9vbGVhbiBtYW5hZ2VkLCBpbnQgY29ublJldGFpbk1vZGUpIHsKICAg\nICAgICByZXR1cm4gbmV3QnJva2VyKF9jb25mLmdldENvbm5lY3Rpb25Vc2Vy\nTmFtZSgpLAogICAgICAgICAgICBfY29uZi5nZXRDb25uZWN0aW9uUGFzc3dv\ncmQoKSwgbWFuYWdlZCwgY29ublJldGFpbk1vZGUpOwogICAgfQoKICAgIHB1\nYmxpYyBCcm9rZXIgbmV3QnJva2VyKFN0cmluZyB1c2VyLCBTdHJpbmcgcGFz\ncywgYm9vbGVhbiBtYW5hZ2VkLAogICAgICAgIGludCBjb25uUmV0YWluTW9k\nZSkgewogICAgICAgIHJldHVybiBuZXdCcm9rZXIodXNlciwgcGFzcywgbWFu\nYWdlZCwgY29ublJldGFpbk1vZGUsIHRydWUpOwogICAgfQoKICAgIHB1Ymxp\nYyBCcm9rZXIgbmV3QnJva2VyKFN0cmluZyB1c2VyLCBTdHJpbmcgcGFzcywg\nYm9vbGVhbiBtYW5hZ2VkLAogICAgICAgIGludCBjb25uUmV0YWluTW9kZSwg\nYm9vbGVhbiBmaW5kRXhpc3RpbmcpIHsKICAgICAgICB0cnkgewogICAgICAg\nICAgICBhc3NlcnRPcGVuKCk7CiAgICAgICAgICAgIG1ha2VSZWFkT25seSgp\nOwoKICAgICAgICAgICAgQnJva2VySW1wbCBicm9rZXIgPSBudWxsOwogICAg\nICAgICAgICBpZiAoZmluZEV4aXN0aW5nKQogICAgICAgICAgICAgICAgYnJv\na2VyID0gZmluZEJyb2tlcih1c2VyLCBwYXNzLCBtYW5hZ2VkKTsKICAgICAg\nICAgICAgaWYgKGJyb2tlciA9PSBudWxsKSB7CiAgICAgICAgICAgICAgICAv\nLyBkZWNvcmF0ZSB0aGUgc3RvcmUgbWFuYWdlciBmb3IgZGF0YSBjYWNoaW5n\nIGFuZCBjdXN0b20KICAgICAgICAgICAgICAgIC8vIHJlc3VsdCBvYmplY3Qg\ncHJvdmlkZXJzOyBhbHdheXMgbWFrZSBzdXJlIGl0J3MgYSBkZWxlZ2F0aW5n\nCiAgICAgICAgICAgICAgICAvLyBzdG9yZSBtYW5hZ2VyLCBiZWNhdXNlIGl0\nJ3MgZWFzaWVyIGZvciB1c2VycyB0byBkZWFsIHdpdGgKICAgICAgICAgICAg\nICAgIC8vIHRoYXQgd2F5CiAgICAgICAgICAgICAgICBTdG9yZU1hbmFnZXIg\nc20gPSBuZXdTdG9yZU1hbmFnZXIoKTsKICAgICAgICAgICAgICAgIERlbGVn\nYXRpbmdTdG9yZU1hbmFnZXIgZHNtID0gbnVsbDsKICAgICAgICAgICAgICAg\nIGlmIChfY29uZi5nZXREYXRhQ2FjaGVNYW5hZ2VySW5zdGFuY2UoKS5nZXRT\neXN0ZW1EYXRhQ2FjaGUoKQogICAgICAgICAgICAgICAgICAgICE9IG51bGwp\nCiAgICAgICAgICAgICAgICAgICAgZHNtID0gbmV3IERhdGFDYWNoZVN0b3Jl\nTWFuYWdlcihzbSk7CiAgICAgICAgICAgICAgICBkc20gPSBuZXcgUk9QU3Rv\ncmVNYW5hZ2VyKChkc20gPT0gbnVsbCkgPyBzbSA6IGRzbSk7CgogICAgICAg\nICAgICAgICAgYnJva2VyID0gbmV3QnJva2VySW1wbCh1c2VyLCBwYXNzKTsK\nICAgICAgICAgICAgICAgIGJyb2tlci5pbml0aWFsaXplKHRoaXMsIGRzbSwg\nbWFuYWdlZCwgY29ublJldGFpbk1vZGUpOwogICAgICAgICAgICAgICAgYWRk\nTGlzdGVuZXJzKGJyb2tlcik7CgogICAgICAgICAgICAgICAgLy8gaWYgd2Un\ncmUgdXNpbmcgcmVtb3RlIGV2ZW50cywgcmVnaXN0ZXIgdGhlIGV2ZW50IG1h\nbmFnZXIgc28KICAgICAgICAgICAgICAgIC8vIHRoYXQgaXQgY2FuIGJyb2Fk\nY2FzdCBjb21taXQgbm90aWZpY2F0aW9ucyBmcm9tIHRoZSBicm9rZXIKICAg\nICAgICAgICAgICAgIFJlbW90ZUNvbW1pdEV2ZW50TWFuYWdlciByZW1vdGUg\nPSBfY29uZi4KICAgICAgICAgICAgICAgICAgICBnZXRSZW1vdGVDb21taXRF\ndmVudE1hbmFnZXIoKTsKICAgICAgICAgICAgICAgIGlmIChyZW1vdGUuYXJl\nUmVtb3RlRXZlbnRzRW5hYmxlZCgpKQogICAgICAgICAgICAgICAgICAgIGJy\nb2tlci5hZGRUcmFuc2FjdGlvbkxpc3RlbmVyKHJlbW90ZSk7CgogICAgICAg\nICAgICAgICAgbG9hZFBlcnNpc3RlbnRUeXBlcyhicm9rZXIuZ2V0Q2xhc3NM\nb2FkZXIoKSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgX2Jyb2tlcnMu\nYWRkKGJyb2tlcik7CgogICAgICAgICAgICByZXR1cm4gYnJva2VyOwogICAg\nICAgIH0gY2F0Y2ggKE9wZW5KUEFFeGNlcHRpb24ga2UpIHsKICAgICAgICAg\nICAgdGhyb3cga2U7CiAgICAgICAgfSBjYXRjaCAoUnVudGltZUV4Y2VwdGlv\nbiByZSkgewogICAgICAgICAgICB0aHJvdyBuZXcgR2VuZXJhbEV4Y2VwdGlv\nbihyZSk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogQWRkIGZh\nY3RvcnktcmVnaXN0ZXJlZCBsaWZlY3ljbGUgbGlzdGVuZXJzIHRvIHRoZSBi\ncm9rZXIuCiAgICAgKi8KICAgIHByb3RlY3RlZCB2b2lkIGFkZExpc3RlbmVy\ncyhCcm9rZXJJbXBsIGJyb2tlcikgewogICAgICAgIGlmIChfbGlmZWN5Y2xl\nTGlzdGVuZXJzICE9IG51bGwgJiYgIV9saWZlY3ljbGVMaXN0ZW5lcnMuaXNF\nbXB0eSgpKSB7CiAgICAgICAgICAgIE1hcC5FbnRyeSBlbnRyeTsKICAgICAg\nICAgICAgZm9yIChJdGVyYXRvciBpdHIgPSBfbGlmZWN5Y2xlTGlzdGVuZXJz\nLmVudHJ5U2V0KCkuaXRlcmF0b3IoKTsKICAgICAgICAgICAgICAgIGl0ci5o\nYXNOZXh0KCk7KSB7CiAgICAgICAgICAgICAgICBlbnRyeSA9IChNYXAuRW50\ncnkpIGl0ci5uZXh0KCk7CiAgICAgICAgICAgICAgICBicm9rZXIuYWRkTGlm\nZWN5Y2xlTGlzdGVuZXIoZW50cnkuZ2V0S2V5KCksIChDbGFzc1tdKQogICAg\nICAgICAgICAgICAgICAgIGVudHJ5LmdldFZhbHVlKCkpOwogICAgICAgICAg\nICB9CiAgICAgICAgfQoKICAgICAgICBpZiAoX3RyYW5zYWN0aW9uTGlzdGVu\nZXJzICE9IG51bGwgJiYgIV90cmFuc2FjdGlvbkxpc3RlbmVycy5pc0VtcHR5\nKCkpIHsKICAgICAgICAgICAgZm9yIChJdGVyYXRvciBpdHIgPSBfdHJhbnNh\nY3Rpb25MaXN0ZW5lcnMuaXRlcmF0b3IoKTsKICAgICAgICAgICAgICAgIGl0\nci5oYXNOZXh0KCk7ICkgewogICAgICAgICAgICAgICAgYnJva2VyLmFkZFRy\nYW5zYWN0aW9uTGlzdGVuZXIoaXRyLm5leHQoKSk7CiAgICAgICAgICAgIH0K\nICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBMb2FkIHRoZSBjb25m\naWd1cmVkIHBlcnNpc3RlbnQgY2xhc3NlcyBsaXN0LiBQZXJmb3JtZWQgYXV0\nb21hdGljYWxseQogICAgICogd2hlbmV2ZXIgYSBicm9rZXIgaXMgY3JlYXRl\nZC4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIGxvYWRQZXJzaXN0ZW50VHlw\nZXMoQ2xhc3NMb2FkZXIgZW52TG9hZGVyKSB7CiAgICAgICAgLy8gbm8gbGlz\ndGVkIHBlcnNpc3RlbnQgdHlwZXM/CiAgICAgICAgaWYgKF9wY0NsYXNzTmFt\nZXMgIT0gbnVsbCAmJiBfcGNDbGFzc05hbWVzLmlzRW1wdHkoKSkKICAgICAg\nICAgICAgcmV0dXJuOwoKICAgICAgICAvLyBjYWNoZSBwZXJzaXN0ZW50IHR5\ncGUgbmFtZXMgaWYgbm90IGFscmVhZHkKICAgICAgICBDbGFzc0xvYWRlciBs\nb2FkZXIgPSBfY29uZi5nZXRDbGFzc1Jlc29sdmVySW5zdGFuY2UoKS4KICAg\nICAgICAgICAgZ2V0Q2xhc3NMb2FkZXIoZ2V0Q2xhc3MoKSwgZW52TG9hZGVy\nKTsKICAgICAgICBDb2xsZWN0aW9uIHRvUmVkZWZpbmUgPSBuZXcgQXJyYXlM\naXN0KCk7CiAgICAgICAgaWYgKF9wY0NsYXNzTmFtZXMgPT0gbnVsbCkgewog\nICAgICAgICAgICBDb2xsZWN0aW9uIGNsc3MgPSBfY29uZi5nZXRNZXRhRGF0\nYVJlcG9zaXRvcnlJbnN0YW5jZSgpLgogICAgICAgICAgICAgICAgbG9hZFBl\ncnNpc3RlbnRUeXBlcyhmYWxzZSwgbG9hZGVyKTsKICAgICAgICAgICAgaWYg\nKGNsc3MuaXNFbXB0eSgpKQogICAgICAgICAgICAgICAgX3BjQ2xhc3NOYW1l\ncyA9IENvbGxlY3Rpb25zLkVNUFRZX1NFVDsKICAgICAgICAgICAgZWxzZSB7\nCiAgICAgICAgICAgICAgICBfcGNDbGFzc05hbWVzID0gbmV3IEFycmF5TGlz\ndChjbHNzLnNpemUoKSk7CiAgICAgICAgICAgICAgICBmb3IgKEl0ZXJhdG9y\nIGl0ciA9IGNsc3MuaXRlcmF0b3IoKTsgaXRyLmhhc05leHQoKTspIHsKICAg\nICAgICAgICAgICAgICAgICBDbGFzcyBjbHMgPSAoQ2xhc3MpIGl0ci5uZXh0\nKCk7CiAgICAgICAgICAgICAgICAgICAgX3BjQ2xhc3NOYW1lcy5hZGQoY2xz\nLmdldE5hbWUoKSk7CiAgICAgICAgICAgICAgICAgICAgaWYgKG5lZWRzU3Vi\nKGNscykpCiAgICAgICAgICAgICAgICAgICAgICAgIHRvUmVkZWZpbmUuYWRk\nKGNscyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBfcGND\nbGFzc0xvYWRlcnMgPSBuZXcgUmVmZXJlbmNlSGFzaFNldChSZWZlcmVuY2VI\nYXNoU2V0LldFQUspOwogICAgICAgICAgICAgICAgX3BjQ2xhc3NMb2FkZXJz\nLmFkZChsb2FkZXIpOwogICAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsK\nICAgICAgICAgICAgLy8gcmVsb2FkIHdpdGggdGhpcyBsb2FkZXIKICAgICAg\nICAgICAgaWYgKF9wY0NsYXNzTG9hZGVycy5hZGQobG9hZGVyKSkgewogICAg\nICAgICAgICAgICAgZm9yIChJdGVyYXRvciBpdHIgPSBfcGNDbGFzc05hbWVz\nLml0ZXJhdG9yKCk7IGl0ci5oYXNOZXh0KCk7KSB7CiAgICAgICAgICAgICAg\nICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICAgICAgQ2xhc3MgY2xz\nID0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIENsYXNzLmZvck5hbWUo\nKFN0cmluZykgaXRyLm5leHQoKSwgdHJ1ZSwgbG9hZGVyKTsKICAgICAgICAg\nICAgICAgICAgICAgICAgaWYgKG5lZWRzU3ViKGNscykpCiAgICAgICAgICAg\nICAgICAgICAgICAgICAgICB0b1JlZGVmaW5lLmFkZChjbHMpOwogICAgICAg\nICAgICAgICAgICAgIH0gY2F0Y2ggKFRocm93YWJsZSB0KSB7CiAgICAgICAg\nICAgICAgICAgICAgICAgIF9jb25mLmdldExvZyhPcGVuSlBBQ29uZmlndXJh\ndGlvbi5MT0dfUlVOVElNRSkKICAgICAgICAgICAgICAgICAgICAgICAgICAg\nIC53YXJuKG51bGwsIHQpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAg\nICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAg\naWYgKEphdmFWZXJzaW9ucy5WRVJTSU9OID49IDUpIHsKICAgICAgICAgICAg\ndHJ5IHsKICAgICAgICAgICAgICAgIC8vIFRoaXMgaXMgSmF2YSA1IC8gNiBj\nb2RlLiBUaGVyZSBtaWdodCBiZSBhIG1vcmUgZWxlZ2FudAogICAgICAgICAg\nICAgICAgLy8gd2F5IHRvIGJvb3RzdHJhcCB0aGlzIGludG8gdGhlIHN5c3Rl\nbSwgYnV0IHJlZmxlY3Rpb24KICAgICAgICAgICAgICAgIC8vIHdpbGwgZ2V0\nIHRoaW5ncyB3b3JraW5nIGZvciBub3cuIFdlIGNvdWxkIHBvdGVudGlhbGx5\nCiAgICAgICAgICAgICAgICAvLyBkbyB0aGlzIGJ5IGNyZWF0aW5nIGEgbmV3\nIEJyb2tlckZhY3RvcnlFdmVudCB0eXBlIGZvcgogICAgICAgICAgICAgICAg\nLy8gQnJva2VyIGNyZWF0aW9uLCBhdCB3aGljaCBwb2ludCB3ZSBoYXZlIGFu\nIGFwcHJvcHJpYXRlCiAgICAgICAgICAgICAgICAvLyBjbGFzc2xvYWRlciB0\nbyB1c2UuCiAgICAgICAgICAgICAgICBDbGFzcyBjbHMgPSBDbGFzcy5mb3JO\nYW1lKAogICAgICAgICAgICAgICAgICAgICJvcmcuYXBhY2hlLm9wZW5qcGEu\nZW5oYW5jZS5NYW5hZ2VkQ2xhc3NTdWJjbGFzc2VyIik7CiAgICAgICAgICAg\nICAgICBjbHMuZ2V0TWV0aG9kKCJwcmVwYXJlVW5lbmhhbmNlZENsYXNzZXMi\nLCBuZXcgQ2xhc3NbXSB7CiAgICAgICAgICAgICAgICAgICAgICAgIE9wZW5K\nUEFDb25maWd1cmF0aW9uLmNsYXNzLCBDb2xsZWN0aW9uLmNsYXNzLAogICAg\nICAgICAgICAgICAgICAgICAgICBDbGFzc0xvYWRlci5jbGFzcwogICAgICAg\nICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgLmludm9rZShu\ndWxsLCBuZXcgT2JqZWN0W117IF9jb25mLCB0b1JlZGVmaW5lLCBlbnZMb2Fk\nZXIgfSk7CiAgICAgICAgICAgIH0gY2F0Y2ggKE5vU3VjaE1ldGhvZEV4Y2Vw\ndGlvbiBlKSB7CiAgICAgICAgICAgICAgICAvLyBzaG91bGQgbmV2ZXIgaGFw\ncGVuIGluIGEgcHJvcGVybHktYnVpbHQgaW5zdGFsbGF0aW9uCiAgICAgICAg\nICAgICAgICB0aHJvdyBuZXcgSW50ZXJuYWxFeGNlcHRpb24oZSk7CiAgICAg\nICAgICAgIH0gY2F0Y2ggKElsbGVnYWxBY2Nlc3NFeGNlcHRpb24gZSkgewog\nICAgICAgICAgICAgICAgLy8gc2hvdWxkIG5ldmVyIGhhcHBlbiBpbiBhIHBy\nb3Blcmx5LWJ1aWx0IGluc3RhbGxhdGlvbgogICAgICAgICAgICAgICAgdGhy\nb3cgbmV3IEludGVybmFsRXhjZXB0aW9uKGUpOwogICAgICAgICAgICB9IGNh\ndGNoIChJbnZvY2F0aW9uVGFyZ2V0RXhjZXB0aW9uIGUpIHsKICAgICAgICAg\nICAgICAgIFRocm93YWJsZSBjYXVzZSA9IGUuZ2V0Q2F1c2UoKTsKICAgICAg\nICAgICAgICAgIGlmIChjYXVzZSBpbnN0YW5jZW9mIE9wZW5KUEFFeGNlcHRp\nb24pCiAgICAgICAgICAgICAgICAgICAgdGhyb3cgKE9wZW5KUEFFeGNlcHRp\nb24pIGNhdXNlOwogICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAg\nICAgICAgIHRocm93IG5ldyBJbnRlcm5hbEV4Y2VwdGlvbihjYXVzZSk7CiAg\nICAgICAgICAgIH0gY2F0Y2ggKENsYXNzTm90Rm91bmRFeGNlcHRpb24gZSkg\newogICAgICAgICAgICAgICAgLy8gc2hvdWxkIG5ldmVyIGhhcHBlbiBpbiBh\nIHByb3Blcmx5LWJ1aWx0IGluc3RhbGxhdGlvbgogICAgICAgICAgICAgICAg\ndGhyb3cgbmV3IEludGVybmFsRXhjZXB0aW9uKGUpOwogICAgICAgICAgICB9\nCiAgICAgICAgfQogICAgfQoKICAgIHByaXZhdGUgYm9vbGVhbiBuZWVkc1N1\nYihDbGFzcyBjbHMpIHsKICAgICAgICByZXR1cm4gIWNscy5pc0ludGVyZmFj\nZSgpCiAgICAgICAgICAgICYmICFQZXJzaXN0ZW5jZUNhcGFibGUuY2xhc3Mu\naXNBc3NpZ25hYmxlRnJvbShjbHMpOwogICAgfQoKICAgIHB1YmxpYyB2b2lk\nIGFkZExpZmVjeWNsZUxpc3RlbmVyKE9iamVjdCBsaXN0ZW5lciwgQ2xhc3Nb\nXSBjbGFzc2VzKSB7CiAgICAgICAgbG9jaygpOwogICAgICAgIHRyeSB7CiAg\nICAgICAgICAgIGFzc2VydE9wZW4oKTsKICAgICAgICAgICAgaWYgKF9saWZl\nY3ljbGVMaXN0ZW5lcnMgPT0gbnVsbCkKICAgICAgICAgICAgICAgIF9saWZl\nY3ljbGVMaXN0ZW5lcnMgPSBuZXcgSGFzaE1hcCg3KTsKICAgICAgICAgICAg\nX2xpZmVjeWNsZUxpc3RlbmVycy5wdXQobGlzdGVuZXIsIGNsYXNzZXMpOwog\nICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgIHVubG9jaygpOwogICAg\nICAgIH0KICAgIH0KCiAgICBwdWJsaWMgdm9pZCByZW1vdmVMaWZlY3ljbGVM\naXN0ZW5lcihPYmplY3QgbGlzdGVuZXIpIHsKICAgICAgICBsb2NrKCk7CiAg\nICAgICAgdHJ5IHsKICAgICAgICAgICAgYXNzZXJ0T3BlbigpOwogICAgICAg\nICAgICBpZiAoX2xpZmVjeWNsZUxpc3RlbmVycyAhPSBudWxsKQogICAgICAg\nICAgICAgICAgX2xpZmVjeWNsZUxpc3RlbmVycy5yZW1vdmUobGlzdGVuZXIp\nOwogICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgIHVubG9jaygpOwog\nICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMgdm9pZCBhZGRUcmFuc2FjdGlv\nbkxpc3RlbmVyKE9iamVjdCBsaXN0ZW5lcikgewogICAgICAgIGxvY2soKTsK\nICAgICAgICB0cnkgewogICAgICAgICAgICBhc3NlcnRPcGVuKCk7CiAgICAg\nICAgICAgIGlmIChfdHJhbnNhY3Rpb25MaXN0ZW5lcnMgPT0gbnVsbCkKICAg\nICAgICAgICAgICAgIF90cmFuc2FjdGlvbkxpc3RlbmVycyA9IG5ldyBMaW5r\nZWRMaXN0KCk7CiAgICAgICAgICAgIF90cmFuc2FjdGlvbkxpc3RlbmVycy5h\nZGQobGlzdGVuZXIpOwogICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAg\nIHVubG9jaygpOwogICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMgdm9pZCBy\nZW1vdmVUcmFuc2FjdGlvbkxpc3RlbmVyKE9iamVjdCBsaXN0ZW5lcikgewog\nICAgICAgIGxvY2soKTsKICAgICAgICB0cnkgewogICAgICAgICAgICBhc3Nl\ncnRPcGVuKCk7CiAgICAgICAgICAgIGlmIChfdHJhbnNhY3Rpb25MaXN0ZW5l\ncnMgIT0gbnVsbCkKICAgICAgICAgICAgICAgIF90cmFuc2FjdGlvbkxpc3Rl\nbmVycy5yZW1vdmUobGlzdGVuZXIpOwogICAgICAgIH0gZmluYWxseSB7CiAg\nICAgICAgICAgIHVubG9jaygpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioK\nICAgICAqIFJldHVybnMgdHJ1ZSBpZiB0aGlzIGJyb2tlciBmYWN0b3J5IGlz\nIGNsb3NlZC4KICAgICAqLwogICAgcHVibGljIGJvb2xlYW4gaXNDbG9zZWQo\nKSB7CiAgICAgICAgcmV0dXJuIF9jbG9zZWQ7CiAgICB9CgogICAgcHVibGlj\nIHZvaWQgY2xvc2UoKSB7CiAgICAgICAgbG9jaygpOwogICAgICAgIHRyeSB7\nCiAgICAgICAgICAgIGFzc2VydE9wZW4oKTsKICAgICAgICAgICAgYXNzZXJ0\nTm9BY3RpdmVUcmFuc2FjdGlvbigpOwoKICAgICAgICAgICAgLy8gcmVtb3Zl\nIGZyb20gZmFjdG9yeSBwb29sCiAgICAgICAgICAgIE1hcCBtYXAgPSB0b1Bv\nb2xLZXkoX2NvbmYpOwogICAgICAgICAgICBzeW5jaHJvbml6ZWQgKF9wb29s\nKSB7CiAgICAgICAgICAgICAgICBpZiAoX3Bvb2wuZ2V0KG1hcCkgPT0gdGhp\ncykKICAgICAgICAgICAgICAgICAgICBfcG9vbC5yZW1vdmUobWFwKTsKICAg\nICAgICAgICAgfQoKICAgICAgICAgICAgLy8gY2xvc2UgYWxsIGJyb2tlcnMK\nICAgICAgICAgICAgQnJva2VyIGJyb2tlcjsKICAgICAgICAgICAgZm9yIChJ\ndGVyYXRvciBpdHIgPSBfYnJva2Vycy5pdGVyYXRvcigpOyBpdHIuaGFzTmV4\ndCgpOykgewogICAgICAgICAgICAgICAgYnJva2VyID0gKEJyb2tlcikgaXRy\nLm5leHQoKTsKICAgICAgICAgICAgICAgIC8vIENoZWNrIGZvciBudWxsIGJl\nY2F1c2UgX2Jyb2tlcnMgY29udGFpbnMgd2VhayByZWZlcmVuY2VzCiAgICAg\nICAgICAgICAgICBpZiAoKGJyb2tlciAhPSBudWxsKSAmJiAoIWJyb2tlci5p\nc0Nsb3NlZCgpKSkKICAgICAgICAgICAgICAgICAgICBicm9rZXIuY2xvc2Uo\nKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gcmVtb3ZlIG1ldGFk\nYXRhIHJlcG9zaXRvcnkgZnJvbSBsaXN0ZW5lciBsaXN0CiAgICAgICAgICAg\nIFBDUmVnaXN0cnkucmVtb3ZlUmVnaXN0ZXJDbGFzc0xpc3RlbmVyCiAgICAg\nICAgICAgICAgICAoX2NvbmYuZ2V0TWV0YURhdGFSZXBvc2l0b3J5SW5zdGFu\nY2UoKSk7CgogICAgICAgICAgICBfY29uZi5jbG9zZSgpOwogICAgICAgICAg\nICBfY2xvc2VkID0gdHJ1ZTsKICAgICAgICAgICAgTG9nIGxvZyA9IF9jb25m\nLmdldExvZyhPcGVuSlBBQ29uZmlndXJhdGlvbi5MT0dfUlVOVElNRSk7CiAg\nICAgICAgICAgIGlmIChsb2cuaXNUcmFjZUVuYWJsZWQoKSkKICAgICAgICAg\nICAgICAgIF9jbG9zZWRFeGNlcHRpb24gPSBuZXcgSWxsZWdhbFN0YXRlRXhj\nZXB0aW9uKCk7CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgdW5s\nb2NrKCk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogU3ViY2xh\nc3NlcyBzaG91bGQgb3ZlcnJpZGUgdGhpcyBtZXRob2QgdG8gYWRkIGEgPGNv\nZGU+UGxhdGZvcm08L2NvZGU+CiAgICAgKiBwcm9wZXJ0eSBsaXN0aW5nIHRo\nZSBydW50aW1lIHBsYXRmb3JtLCBzdWNoIGFzOgogICAgICogPGNvZGU+T3Bl\nbkpQQSBKREJDIEVkaXRpb246IE9yYWNsZSBEYXRhYmFzZTwvY29kZT4KICAg\nICAqLwogICAgcHVibGljIFByb3BlcnRpZXMgZ2V0UHJvcGVydGllcygpIHsK\nICAgICAgICAvLyByZXF1aXJlZCBwcm9wcyBhcmUgVmVuZG9yTmFtZSBhbmQg\nVmVyc2lvbk51bWJlcgogICAgICAgIFByb3BlcnRpZXMgcHJvcHMgPSBuZXcg\nUHJvcGVydGllcygpOwogICAgICAgIHByb3BzLnNldFByb3BlcnR5KCJWZW5k\nb3JOYW1lIiwgT3BlbkpQQVZlcnNpb24uVkVORE9SX05BTUUpOwogICAgICAg\nIHByb3BzLnNldFByb3BlcnR5KCJWZXJzaW9uTnVtYmVyIiwgT3BlbkpQQVZl\ncnNpb24uVkVSU0lPTl9OVU1CRVIpOwogICAgICAgIHByb3BzLnNldFByb3Bl\ncnR5KCJWZXJzaW9uSWQiLCBPcGVuSlBBVmVyc2lvbi5WRVJTSU9OX0lEKTsK\nICAgICAgICByZXR1cm4gcHJvcHM7CiAgICB9CgogICAgcHVibGljIE9iamVj\ndCBnZXRVc2VyT2JqZWN0KE9iamVjdCBrZXkpIHsKICAgICAgICBsb2NrKCk7\nCiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgYXNzZXJ0T3BlbigpOwogICAg\nICAgICAgICByZXR1cm4gKF91c2VyT2JqZWN0cyA9PSBudWxsKSA/IG51bGwg\nOiBfdXNlck9iamVjdHMuZ2V0KGtleSk7CiAgICAgICAgfSBmaW5hbGx5IHsK\nICAgICAgICAgICAgdW5sb2NrKCk7CiAgICAgICAgfQogICAgfQoKICAgIHB1\nYmxpYyBPYmplY3QgcHV0VXNlck9iamVjdChPYmplY3Qga2V5LCBPYmplY3Qg\ndmFsKSB7CiAgICAgICAgbG9jaygpOwogICAgICAgIHRyeSB7CiAgICAgICAg\nICAgIGFzc2VydE9wZW4oKTsKICAgICAgICAgICAgaWYgKHZhbCA9PSBudWxs\nKQogICAgICAgICAgICAgICAgcmV0dXJuIChfdXNlck9iamVjdHMgPT0gbnVs\nbCkgPyBudWxsIDogX3VzZXJPYmplY3RzLnJlbW92ZShrZXkpOwoKICAgICAg\nICAgICAgaWYgKF91c2VyT2JqZWN0cyA9PSBudWxsKQogICAgICAgICAgICAg\nICAgX3VzZXJPYmplY3RzID0gbmV3IEhhc2hNYXAoKTsKICAgICAgICAgICAg\ncmV0dXJuIF91c2VyT2JqZWN0cy5wdXQoa2V5LCB2YWwpOwogICAgICAgIH0g\nZmluYWxseSB7CiAgICAgICAgICAgIHVubG9jaygpOwogICAgICAgIH0KICAg\nIH0KCiAgICBwdWJsaWMgdm9pZCBsb2NrKCkgewogICAgICAgIF9sb2NrLmxv\nY2soKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCB1bmxvY2soKSB7CiAgICAg\nICAgX2xvY2sudW5sb2NrKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXBs\nYWNlcyB0aGUgZmFjdG9yeSB3aXRoIHRoaXMgSlZNcyBwb29sZWQgdmVyc2lv\nbiBpZiBpdCBleGlzdHMuIEFsc28KICAgICAqIGZyZWV6ZXMgdGhlIGZhY3Rv\ncnkuCiAgICAgKi8KICAgIHByb3RlY3RlZCBPYmplY3QgcmVhZFJlc29sdmUo\nKQogICAgICAgIHRocm93cyBPYmplY3RTdHJlYW1FeGNlcHRpb24gewogICAg\nICAgIEFic3RyYWN0QnJva2VyRmFjdG9yeSBmYWN0b3J5ID0gZ2V0UG9vbGVk\nRmFjdG9yeShfY29uZik7CiAgICAgICAgaWYgKGZhY3RvcnkgIT0gbnVsbCkK\nICAgICAgICAgICAgcmV0dXJuIGZhY3Rvcnk7CgogICAgICAgIC8vIHJlc2V0\nIHRoZXNlIHRyYW5zaWVudCBmaWVsZHMgdG8gZW1wdHkgdmFsdWVzCiAgICAg\nICAgX3RyYW5zYWN0aW9uYWwgPSBuZXcgQ29uY3VycmVudEhhc2hNYXAoKTsK\nICAgICAgICBfYnJva2VycyA9IG5ldyBDb25jdXJyZW50UmVmZXJlbmNlSGFz\naFNldCgKICAgICAgICAgICAgICAgIENvbmN1cnJlbnRSZWZlcmVuY2VIYXNo\nU2V0LldFQUspOwoKICAgICAgICBtYWtlUmVhZE9ubHkoKTsKICAgICAgICBy\nZXR1cm4gdGhpczsKICAgIH0KCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8v\nLy8KICAgIC8vIE1ldGhvZHMgZm9yIE92ZXJyaWRlCiAgICAvLy8vLy8vLy8v\nLy8vLy8vLy8vLy8vLy8KCiAgICAvKioKICAgICAqIFJldHVybiBhIG5ldyBT\ndG9yZU1hbmFnZXIgZm9yIHRoaXMgcnVudGltZS4gTm90ZSB0aGF0IHRoZSBp\nbnN0YW5jZQogICAgICogcmV0dXJuZWQgaGVyZSBtYXkgYmUgd3JhcHBlZCBi\nZWZvcmUgYmVpbmcgcGFzc2VkIHRvIHRoZQogICAgICoge0BsaW5rICNuZXdC\ncm9rZXJ9IG1ldGhvZC4KICAgICAqLwogICAgcHJvdGVjdGVkIGFic3RyYWN0\nIFN0b3JlTWFuYWdlciBuZXdTdG9yZU1hbmFnZXIoKTsKCiAgICAvKioKICAg\nICAqIEZpbmQgYSBwb29sZWQgYnJva2VyLCBvciByZXR1cm4gbnVsbCBpZiBu\nb25lLiBJZiB1c2luZwogICAgICogbWFuYWdlZCB0cmFuc2FjdGlvbnMsIGxv\nb2tzIGZvciBhIHRyYW5zYWN0aW9uYWwgYnJva2VyOwogICAgICogb3RoZXJ3\naXNlIHJldHVybnMgbnVsbCBieSBkZWZhdWx0LiBUaGlzIG1ldGhvZCB3aWxs\nIGJlIGNhbGxlZCBiZWZvcmUKICAgICAqIHtAbGluayAjbmV3U3RvcmVNYW5h\nZ2VyfSBzbyB0aGF0IGZhY3Rvcnkgc3ViY2xhc3NlcyBpbXBsZW1lbnRpbmcK\nICAgICAqIHBvb2xpbmcgY2FuIHJldHVybiBhIG1hdGNoaW5nIG1hbmFnZXIg\nYmVmb3JlIGEgbmV3IHtAbGluayBTdG9yZU1hbmFnZXJ9CiAgICAgKiBpcyBj\ncmVhdGVkLgogICAgICovCiAgICBwcm90ZWN0ZWQgQnJva2VySW1wbCBmaW5k\nQnJva2VyKFN0cmluZyB1c2VyLCBTdHJpbmcgcGFzcywgYm9vbGVhbiBtYW5h\nZ2VkKSB7CiAgICAgICAgaWYgKG1hbmFnZWQpCiAgICAgICAgICAgIHJldHVy\nbiBmaW5kVHJhbnNhY3Rpb25hbEJyb2tlcih1c2VyLCBwYXNzKTsKICAgICAg\nICByZXR1cm4gbnVsbDsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiBh\nIGJyb2tlciBjb25maWd1cmVkIHdpdGggdGhlIHByb3BlciBzZXR0aW5ncy4K\nICAgICAqIEJ5IGRlZmF1bHQsIHRoaXMgbWV0aG9kIGNvbnN0cnVjdHMgYSBu\nZXcKICAgICAqIEJyb2tlckltcGwgb2YgdGhlIGNsYXNzIHNldCBmb3IgdGhp\ncyBmYWN0b3J5LgogICAgICovCiAgICBwcm90ZWN0ZWQgQnJva2VySW1wbCBu\nZXdCcm9rZXJJbXBsKFN0cmluZyB1c2VyLCBTdHJpbmcgcGFzcykgewogICAg\nICAgIEJyb2tlckltcGwgYnJva2VyID0gX2NvbmYubmV3QnJva2VySW5zdGFu\nY2UodXNlciwgcGFzcyk7CiAgICAgICAgaWYgKGJyb2tlciA9PSBudWxsKQog\nICAgICAgICAgICB0aHJvdyBuZXcgVXNlckV4Y2VwdGlvbihfbG9jLmdldCgi\nbm8tYnJva2VyLWNsYXNzIiwKICAgICAgICAgICAgICAgIF9jb25mLmdldEJy\nb2tlckltcGwoKSkpOwoKICAgICAgICByZXR1cm4gYnJva2VyOwogICAgfQoK\nICAgIC8qKgogICAgICogU2V0dXAgdHJhbnNpZW50IHN0YXRlIHVzZWQgYnkg\ndGhpcyBmYWN0b3J5IGJhc2VkIG9uIHRoZQogICAgICogY3VycmVudCBjb25m\naWd1cmF0aW9uLCB3aGljaCB3aWxsIHN1YnNlcXVlbnRseSBiZSBsb2NrZWQg\nZG93bi4gVGhpcwogICAgICogbWV0aG9kIHdpbGwgYmUgY2FsbGVkIGJlZm9y\nZSB0aGUgZmlyc3QgYnJva2VyIGlzIHJlcXVlc3RlZCwKICAgICAqIGFuZCB3\naWxsIGJlIHJlLWNhbGxlZCBlYWNoIHRpbWUgdGhlIGZhY3RvcnkgaXMgZGVz\nZXJpYWxpemVkIGludG8gYSBKVk0KICAgICAqIHRoYXQgaGFzIG5vIGNvbmZp\nZ3VyYXRpb24gZm9yIHRoaXMgZGF0YSBzdG9yZS4KICAgICAqLwogICAgcHJv\ndGVjdGVkIHZvaWQgc2V0dXAoKSB7CiAgICB9CgogICAgLy8vLy8vLy8vLy8v\nLwogICAgLy8gVXRpbGl0aWVzCiAgICAvLy8vLy8vLy8vLy8vCgogICAgLyoq\nCiAgICAgKiBGaW5kIGEgbWFuYWdlZCBydW50aW1lIGJyb2tlciBhc3NvY2lh\ndGVkIHdpdGggdGhlCiAgICAgKiBjdXJyZW50IHRyYW5zYWN0aW9uLCBvciBy\nZXR1cm5zIG51bGwgaWYgbm9uZS4KICAgICAqLwogICAgcHJvdGVjdGVkIEJy\nb2tlckltcGwgZmluZFRyYW5zYWN0aW9uYWxCcm9rZXIoU3RyaW5nIHVzZXIs\nIFN0cmluZyBwYXNzKSB7CiAgICAgICAgVHJhbnNhY3Rpb24gdHJhbnM7CiAg\nICAgICAgTWFuYWdlZFJ1bnRpbWUgbXIgPSBfY29uZi5nZXRNYW5hZ2VkUnVu\ndGltZUluc3RhbmNlKCk7CiAgICAgICAgT2JqZWN0IHR4S2V5OwogICAgICAg\nIHRyeSB7CiAgICAgICAgICAgIHRyYW5zID0gbXIuZ2V0VHJhbnNhY3Rpb25N\nYW5hZ2VyKCkuCiAgICAgICAgICAgICAgICBnZXRUcmFuc2FjdGlvbigpOwog\nICAgICAgICAgICB0eEtleSA9IG1yLmdldFRyYW5zYWN0aW9uS2V5KCk7Cgog\nICAgICAgICAgICBpZiAodHJhbnMgPT0gbnVsbAogICAgICAgICAgICAgICAg\nfHwgdHJhbnMuZ2V0U3RhdHVzKCkgPT0gU3RhdHVzLlNUQVRVU19OT19UUkFO\nU0FDVElPTgogICAgICAgICAgICAgICAgfHwgdHJhbnMuZ2V0U3RhdHVzKCkg\nPT0gU3RhdHVzLlNUQVRVU19VTktOT1dOKQogICAgICAgICAgICAgICAgcmV0\ndXJuIG51bGw7CiAgICAgICAgfSBjYXRjaCAoT3BlbkpQQUV4Y2VwdGlvbiBr\nZSkgewogICAgICAgICAgICB0aHJvdyBrZTsKICAgICAgICB9IGNhdGNoIChF\neGNlcHRpb24gZSkgewogICAgICAgICAgICB0aHJvdyBuZXcgR2VuZXJhbEV4\nY2VwdGlvbihlKTsKICAgICAgICB9CgogICAgICAgIENvbGxlY3Rpb24gYnJv\na2VycyA9IChDb2xsZWN0aW9uKSBfdHJhbnNhY3Rpb25hbC5nZXQodHhLZXkp\nOwogICAgICAgIGlmIChicm9rZXJzICE9IG51bGwpIHsKICAgICAgICAgICAg\nLy8gd2UgZG9uJ3QgbmVlZCB0byBzeW5jaHJvbml6ZSBvbiBicm9rZXJzIHNp\nbmNlIG9uZSBKVEEgdHJhbnNhY3Rpb24KICAgICAgICAgICAgLy8gY2FuIG5l\ndmVyIGJlIGFjdGl2ZSBvbiBtdWx0aXBsZSBjb25jdXJyZW50IHRocmVhZHMu\nCiAgICAgICAgICAgIEJyb2tlckltcGwgYnJva2VyOwogICAgICAgICAgICBm\nb3IgKEl0ZXJhdG9yIGl0ciA9IGJyb2tlcnMuaXRlcmF0b3IoKTsgaXRyLmhh\nc05leHQoKTspIHsKICAgICAgICAgICAgICAgIGJyb2tlciA9IChCcm9rZXJJ\nbXBsKSBpdHIubmV4dCgpOwogICAgICAgICAgICAgICAgaWYgKFN0cmluZ1V0\naWxzLmVxdWFscyhicm9rZXIuZ2V0Q29ubmVjdGlvblVzZXJOYW1lKCksCiAg\nICAgICAgICAgICAgICAgICAgdXNlcikgJiYgU3RyaW5nVXRpbHMuZXF1YWxz\nCiAgICAgICAgICAgICAgICAgICAgKGJyb2tlci5nZXRDb25uZWN0aW9uUGFz\nc3dvcmQoKSwgcGFzcykpCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGJy\nb2tlcjsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4g\nbnVsbDsKICAgIH0KCiAgICAvKioKICAgICAqIENvbmZpZ3VyZXMgdGhlIGdp\ndmVuIGJyb2tlciB3aXRoIHRoZSBjdXJyZW50IGZhY3Rvcnkgb3B0aW9uIHNl\ndHRpbmdzLgogICAgICovCiAgICBwcm90ZWN0ZWQgdm9pZCBjb25maWd1cmVC\ncm9rZXIoQnJva2VySW1wbCBicm9rZXIpIHsKICAgICAgICBicm9rZXIuc2V0\nT3B0aW1pc3RpYyhfY29uZi5nZXRPcHRpbWlzdGljKCkpOwogICAgICAgIGJy\nb2tlci5zZXROb250cmFuc2FjdGlvbmFsUmVhZChfY29uZi5nZXROb250cmFu\nc2FjdGlvbmFsUmVhZCgpKTsKICAgICAgICBicm9rZXIuc2V0Tm9udHJhbnNh\nY3Rpb25hbFdyaXRlKF9jb25mLmdldE5vbnRyYW5zYWN0aW9uYWxXcml0ZSgp\nKTsKICAgICAgICBicm9rZXIuc2V0UmV0YWluU3RhdGUoX2NvbmYuZ2V0UmV0\nYWluU3RhdGUoKSk7CiAgICAgICAgYnJva2VyLnNldFJlc3RvcmVTdGF0ZShf\nY29uZi5nZXRSZXN0b3JlU3RhdGVDb25zdGFudCgpKTsKICAgICAgICBicm9r\nZXIuc2V0QXV0b0NsZWFyKF9jb25mLmdldEF1dG9DbGVhckNvbnN0YW50KCkp\nOwogICAgICAgIGJyb2tlci5zZXRJZ25vcmVDaGFuZ2VzKF9jb25mLmdldEln\nbm9yZUNoYW5nZXMoKSk7CiAgICAgICAgYnJva2VyLnNldE11bHRpdGhyZWFk\nZWQoX2NvbmYuZ2V0TXVsdGl0aHJlYWRlZCgpKTsKICAgICAgICBicm9rZXIu\nc2V0QXV0b0RldGFjaChfY29uZi5nZXRBdXRvRGV0YWNoQ29uc3RhbnQoKSk7\nCiAgICAgICAgYnJva2VyLnNldERldGFjaFN0YXRlKF9jb25mLmdldERldGFj\naFN0YXRlSW5zdGFuY2UoKS4KICAgICAgICAgICAgZ2V0RGV0YWNoU3RhdGUo\nKSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBBZGQgdGhlIGZhY3RvcnkgdG8g\ndGhlIHBvb2wuCiAgICAgKi8KICAgIHByb3RlY3RlZCB2b2lkIHBvb2woKSB7\nCiAgICAgICAgc3luY2hyb25pemVkIChfcG9vbCkgewogICAgICAgICAgICBf\ncG9vbC5wdXQodG9Qb29sS2V5KF9jb25mKSwgdGhpcyk7CiAgICAgICAgICAg\nIG1ha2VSZWFkT25seSgpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAg\nICAqIEZyZWV6ZXMgdGhlIGNvbmZpZ3VyYXRpb24gb2YgdGhpcyBmYWN0b3J5\nLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBtYWtlUmVhZE9ubHkoKSB7CiAg\nICAgICAgaWYgKF9yZWFkT25seSkKICAgICAgICAgICAgcmV0dXJuOwoKICAg\nICAgICBsb2NrKCk7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgLy8gY2hl\nY2sgYWdhaW4KICAgICAgICAgICAgaWYgKF9yZWFkT25seSkKICAgICAgICAg\nICAgICAgIHJldHVybjsKICAgICAgICAgICAgX3JlYWRPbmx5ID0gdHJ1ZTsK\nCiAgICAgICAgICAgIExvZyBsb2cgPSBfY29uZi5nZXRMb2coT3BlbkpQQUNv\nbmZpZ3VyYXRpb24uTE9HX1JVTlRJTUUpOwogICAgICAgICAgICBpZiAobG9n\nLmlzSW5mb0VuYWJsZWQoKSkKICAgICAgICAgICAgICAgIGxvZy5pbmZvKGdl\ndEZhY3RvcnlJbml0aWFsaXphdGlvbkJhbm5lcigpKTsKICAgICAgICAgICAg\naWYgKGxvZy5pc1RyYWNlRW5hYmxlZCgpKSB7CiAgICAgICAgICAgICAgICBN\nYXAgcHJvcHMgPSBfY29uZi50b1Byb3BlcnRpZXModHJ1ZSk7CiAgICAgICAg\nICAgICAgICBTdHJpbmcgbGluZVNlcCA9IEoyRG9Qcml2SGVscGVyLmdldExp\nbmVTZXBhcmF0b3IoKTsKICAgICAgICAgICAgICAgIFN0cmluZ0J1ZmZlciBi\ndWYgPSBuZXcgU3RyaW5nQnVmZmVyKCk7CiAgICAgICAgICAgICAgICBNYXAu\nRW50cnkgZW50cnk7CiAgICAgICAgICAgICAgICBmb3IgKEl0ZXJhdG9yIGl0\nciA9IHByb3BzLmVudHJ5U2V0KCkuaXRlcmF0b3IoKTsKICAgICAgICAgICAg\nICAgICAgICBpdHIuaGFzTmV4dCgpOykgewogICAgICAgICAgICAgICAgICAg\nIGVudHJ5ID0gKE1hcC5FbnRyeSkgaXRyLm5leHQoKTsKICAgICAgICAgICAg\nICAgICAgICBidWYuYXBwZW5kKGVudHJ5LmdldEtleSgpKS5hcHBlbmQoIjog\nIikuCiAgICAgICAgICAgICAgICAgICAgICAgIGFwcGVuZChlbnRyeS5nZXRW\nYWx1ZSgpKTsKICAgICAgICAgICAgICAgICAgICBpZiAoaXRyLmhhc05leHQo\nKSkKICAgICAgICAgICAgICAgICAgICAgICAgYnVmLmFwcGVuZChsaW5lU2Vw\nKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGxvZy50cmFj\nZShfbG9jLmdldCgiZmFjdG9yeS1wcm9wZXJ0aWVzIiwgYnVmLnRvU3RyaW5n\nKCkpKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gc2V0dXAgdHJh\nbnNpZW50IHN0YXRlCiAgICAgICAgICAgIHNldHVwKCk7CgogICAgICAgICAg\nICAvLyByZWdpc3RlciB0aGUgbWV0ZGF0YSByZXBvc2l0b3J5IHRvIGF1dG8t\nbG9hZCBwZXJzaXN0ZW50IHR5cGVzCiAgICAgICAgICAgIC8vIGFuZCBtYWtl\nIHN1cmUgdHlwZXMgYXJlIGVuaGFuY2VkCiAgICAgICAgICAgIE1ldGFEYXRh\nUmVwb3NpdG9yeSByZXBvcyA9IF9jb25mLmdldE1ldGFEYXRhUmVwb3NpdG9y\neUluc3RhbmNlKCk7CiAgICAgICAgICAgIHJlcG9zLnNldFZhbGlkYXRlKHJl\ncG9zLlZBTElEQVRFX1JVTlRJTUUsIHRydWUpOwogICAgICAgICAgICByZXBv\ncy5zZXRSZXNvbHZlKHJlcG9zLk1PREVfTUFQUElOR19JTklULCB0cnVlKTsK\nICAgICAgICAgICAgUENSZWdpc3RyeS5hZGRSZWdpc3RlckNsYXNzTGlzdGVu\nZXIocmVwb3MpOwoKICAgICAgICAgICAgLy8gZnJlZXplIHVuZGVybHlpbmcg\nY29uZmlndXJhdGlvbiBhbmQgZWFnZXJseSBpbml0aWFsaXplIHRvCiAgICAg\nICAgICAgIC8vIGF2b2lkIHN5bmNocm9uaXphdGlvbgogICAgICAgICAgICBf\nY29uZi5zZXRSZWFkT25seSh0cnVlKTsKICAgICAgICAgICAgX2NvbmYuaW5z\ndGFudGlhdGVBbGwoKTsKCiAgICAgICAgICAgIC8vIGZpcmUgYW4gZXZlbnQg\nZm9yIGFsbCB0aGUgYnJva2VyIGZhY3RvcnkgbGlzdGVuZXJzCiAgICAgICAg\nICAgIC8vIHJlZ2lzdGVyZWQgb24gdGhlIGNvbmZpZ3VyYXRpb24uCiAgICAg\nICAgICAgIF9jb25mLmdldEJyb2tlckZhY3RvcnlFdmVudE1hbmFnZXIoKS5m\naXJlRXZlbnQoCiAgICAgICAgICAgICAgICBuZXcgQnJva2VyRmFjdG9yeUV2\nZW50KHRoaXMsCiAgICAgICAgICAgICAgICAgICAgQnJva2VyRmFjdG9yeUV2\nZW50LkJST0tFUl9GQUNUT1JZX0NSRUFURUQpKTsKICAgICAgICB9IGZpbmFs\nbHkgewogICAgICAgICAgICB1bmxvY2soKTsKICAgICAgICB9CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBSZXR1cm4gYW4gb2JqZWN0IHRvIGJlIHdyaXR0ZW4g\ndG8gdGhlIGxvZyB3aGVuIHRoaXMgYnJva2VyIGZhY3RvcnkKICAgICAqIGlu\naXRpYWxpemVzLiBUaGlzIGhhcHBlbnMgYWZ0ZXIgdGhlIGNvbmZpZ3VyYXRp\nb24gaXMgZnVsbHkgbG9hZGVkLgogICAgICovCiAgICBwcm90ZWN0ZWQgT2Jq\nZWN0IGdldEZhY3RvcnlJbml0aWFsaXphdGlvbkJhbm5lcigpIHsKICAgICAg\nICByZXR1cm4gX2xvYy5nZXQoImZhY3RvcnktaW5pdCIsIE9wZW5KUEFWZXJz\naW9uLlZFUlNJT05fTlVNQkVSKTsKICAgIH0KCiAgICAvKioKICAgICAqIFRo\ncm93IGFuIGV4Y2VwdGlvbiBpZiB0aGUgZmFjdG9yeSBpcyBjbG9zZWQuICBU\naGUgZXhhY3QgbWVzc2FnZSBhbmQKICAgICAqIGNvbnRlbnQgb2YgdGhlIGV4\nY2VwdGlvbiB2YXJpZXMgd2hldGhlciBUUkFDRSBpcyBlbmFibGVkIG9yIG5v\ndC4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIGFzc2VydE9wZW4oKSB7CiAg\nICAgICAgaWYgKF9jbG9zZWQpIHsKICAgICAgICAgICAgaWYgKF9jbG9zZWRF\neGNlcHRpb24gPT0gbnVsbCkgIC8vIFRSQUNFIG5vdCBlbmFibGVkCiAgICAg\nICAgICAgICAgICB0aHJvdyBuZXcgSW52YWxpZFN0YXRlRXhjZXB0aW9uKF9s\nb2MKICAgICAgICAgICAgICAgICAgICAgICAgLmdldCgiY2xvc2VkLWZhY3Rv\ncnktbm90cmFjZSIpKTsKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAg\nICAgdGhyb3cgbmV3IEludmFsaWRTdGF0ZUV4Y2VwdGlvbihfbG9jLmdldCgi\nY2xvc2VkLWZhY3RvcnkiKSkKICAgICAgICAgICAgICAgICAgICAgICAgLnNl\ndENhdXNlKF9jbG9zZWRFeGNlcHRpb24pOwogICAgICAgIH0KICAgIH0KCiAg\nICAvLy8vLy8vLy8vLy8vLy8vLy8vLwogICAgLy8gQnJva2VyIHV0aWxpdGll\ncwogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8KCiAgICAvKioKICAgICAqIFRo\ncm93cyBhIHtAbGluayBVc2VyRXhjZXB0aW9ufSBpZiBhIHRyYW5zYWN0aW9u\nIGlzIGFjdGl2ZS4gVGhlIHRocm93bgogICAgICogZXhjZXB0aW9uIHdpbGwg\nY29udGFpbiBhbGwgdGhlIEJyb2tlcnMgd2l0aCBhY3RpdmUgdHJhbnNhY3Rp\nb25zIGFzCiAgICAgKiBmYWlsZWQgb2JqZWN0cyBpbiB0aGUgbmVzdGVkIGV4\nY2VwdGlvbnMuCiAgICAgKi8KICAgIHByaXZhdGUgdm9pZCBhc3NlcnROb0Fj\ndGl2ZVRyYW5zYWN0aW9uKCkgewogICAgICAgIENvbGxlY3Rpb24gZXhjczsK\nICAgICAgICBpZiAoX3RyYW5zYWN0aW9uYWwuaXNFbXB0eSgpKQogICAgICAg\nICAgICByZXR1cm47CgogICAgICAgIGV4Y3MgPSBuZXcgQXJyYXlMaXN0KF90\ncmFuc2FjdGlvbmFsLnNpemUoKSk7CiAgICAgICAgZm9yIChJdGVyYXRvciB0\ncmFucyA9IF90cmFuc2FjdGlvbmFsLnZhbHVlcygpLml0ZXJhdG9yKCk7CiAg\nICAgICAgICAgIHRyYW5zLmhhc05leHQoKTspIHsKICAgICAgICAgICAgQ29s\nbGVjdGlvbiBicm9rZXJzID0gKENvbGxlY3Rpb24pIHRyYW5zLm5leHQoKTsK\nICAgICAgICAgICAgZm9yIChJdGVyYXRvciBpdHIgPSBicm9rZXJzLml0ZXJh\ndG9yKCk7IGl0ci5oYXNOZXh0KCk7KSB7CiAgICAgICAgICAgICAgICBleGNz\nLmFkZChuZXcgSW52YWxpZFN0YXRlRXhjZXB0aW9uKF9sb2MuZ2V0KCJhY3Rp\ndmUiKSkuCiAgICAgICAgICAgICAgICAgICAgc2V0RmFpbGVkT2JqZWN0KGl0\nci5uZXh0KCkpKTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAg\naWYgKCFleGNzLmlzRW1wdHkoKSkKICAgICAgICAgICAgdGhyb3cgbmV3IElu\ndmFsaWRTdGF0ZUV4Y2VwdGlvbihfbG9jLmdldCgibmVzdGVkLWV4Y2VwcyIp\nKS4KICAgICAgICAgICAgICAgIHNldE5lc3RlZFRocm93YWJsZXMoKFRocm93\nYWJsZVtdKSBleGNzLnRvQXJyYXkKICAgICAgICAgICAgICAgICAgICAobmV3\nIFRocm93YWJsZVtleGNzLnNpemUoKV0pKTsKICAgIH0KCiAgICAvKioKICAg\nICAqIFN5bmNocm9uaXplIHRoZSBnaXZlbiBicm9rZXIgd2l0aCBhIG1hbmFn\nZWQgdHJhbnNhY3Rpb24sCiAgICAgKiBvcHRpb25hbGx5IHN0YXJ0aW5nIG9u\nZSBpZiBub25lIGlzIGluIHByb2dyZXNzLgogICAgICoKICAgICAqIEByZXR1\ncm4gdHJ1ZSBpZiBzeW5jaGVkIHdpdGggdHJhbnNhY3Rpb24sIGZhbHNlIG90\naGVyd2lzZQogICAgICovCiAgICBib29sZWFuIHN5bmNXaXRoTWFuYWdlZFRy\nYW5zYWN0aW9uKEJyb2tlckltcGwgYnJva2VyLCBib29sZWFuIGJlZ2luKSB7\nCiAgICAgICAgVHJhbnNhY3Rpb24gdHJhbnM7CiAgICAgICAgdHJ5IHsKICAg\nICAgICAgICAgTWFuYWdlZFJ1bnRpbWUgbXIgPSBicm9rZXIuZ2V0TWFuYWdl\nZFJ1bnRpbWUoKTsKICAgICAgICAgICAgVHJhbnNhY3Rpb25NYW5hZ2VyIHRt\nID0gbXIuZ2V0VHJhbnNhY3Rpb25NYW5hZ2VyKCk7CiAgICAgICAgICAgIHRy\nYW5zID0gdG0uZ2V0VHJhbnNhY3Rpb24oKTsKICAgICAgICAgICAgaWYgKHRy\nYW5zICE9IG51bGwKICAgICAgICAgICAgICAgICYmICh0cmFucy5nZXRTdGF0\ndXMoKSA9PSBTdGF0dXMuU1RBVFVTX05PX1RSQU5TQUNUSU9OCiAgICAgICAg\nICAgICAgICB8fCB0cmFucy5nZXRTdGF0dXMoKSA9PSBTdGF0dXMuU1RBVFVT\nX1VOS05PV04pKQogICAgICAgICAgICAgICAgdHJhbnMgPSBudWxsOwoKICAg\nICAgICAgICAgaWYgKHRyYW5zID09IG51bGwgJiYgYmVnaW4pIHsKICAgICAg\nICAgICAgICAgIHRtLmJlZ2luKCk7CiAgICAgICAgICAgICAgICB0cmFucyA9\nIHRtLmdldFRyYW5zYWN0aW9uKCk7CiAgICAgICAgICAgIH0gZWxzZSBpZiAo\ndHJhbnMgPT0gbnVsbCkKICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsK\nCiAgICAgICAgICAgIC8vIHN5bmNoIGJyb2tlciBhbmQgdHJhbnMKICAgICAg\nICAgICAgdHJhbnMucmVnaXN0ZXJTeW5jaHJvbml6YXRpb24oYnJva2VyKTsK\nCiAgICAgICAgICAgIC8vIHdlIGRvbid0IG5lZWQgdG8gc3luY2hyb25pemUg\nb24gYnJva2VycyBvciBndWFyZCBhZ2FpbnN0IG11bHRpcGxlCiAgICAgICAg\nICAgIC8vIHRocmVhZHMgdXNpbmcgdGhlIHNhbWUgdHJhbnMgc2luY2Ugb25l\nIEpUQSB0cmFuc2FjdGlvbiBjYW4gbmV2ZXIKICAgICAgICAgICAgLy8gYmUg\nYWN0aXZlIG9uIG11bHRpcGxlIGNvbmN1cnJlbnQgdGhyZWFkcy4KICAgICAg\nICAgICAgT2JqZWN0IHR4S2V5ID0gbXIuZ2V0VHJhbnNhY3Rpb25LZXkoKTsK\nICAgICAgICAgICAgQ29sbGVjdGlvbiBicm9rZXJzID0gKENvbGxlY3Rpb24p\nIF90cmFuc2FjdGlvbmFsLmdldCh0eEtleSk7CiAgICAgICAgICAgIAogICAg\nICAgICAgICBpZiAoYnJva2VycyA9PSBudWxsKSB7CiAgICAgICAgICAgICAg\nICBicm9rZXJzID0gbmV3IEFycmF5TGlzdCgyKTsKICAgICAgICAgICAgICAg\nIF90cmFuc2FjdGlvbmFsLnB1dCh0eEtleSwgYnJva2Vycyk7CiAgICAgICAg\nICAgICAgICB0cmFucy5yZWdpc3RlclN5bmNocm9uaXphdGlvbihuZXcgUmVt\nb3ZlVHJhbnNhY3Rpb25TeW5jKHR4S2V5KSk7CiAgICAgICAgICAgIH0KICAg\nICAgICAgICAgYnJva2Vycy5hZGQoYnJva2VyKTsKICAgICAgICAgICAgCiAg\nICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0gY2F0Y2ggKE9wZW5K\nUEFFeGNlcHRpb24ga2UpIHsKICAgICAgICAgICAgdGhyb3cga2U7CiAgICAg\nICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgdGhyb3cg\nbmV3IEdlbmVyYWxFeGNlcHRpb24oZSk7CiAgICAgICAgfQogICAgfQoKICAg\nIC8qKgogICAgICogUmV0dXJucyBhIHNldCBvZiBhbGwgdGhlIG9wZW4gYnJv\na2VycyBhc3NvY2lhdGVkIHdpdGggdGhpcyBmYWN0b3J5LiBUaGUKICAgICAq\nIHJldHVybmVkIHNldCBpcyB1bm1vZGlmaWFibGUsIGFuZCBtYXkgY29udGFp\nbiBudWxsIHJlZmVyZW5jZXMuCiAgICAgKi8KICAgIHB1YmxpYyBDb2xsZWN0\naW9uIGdldE9wZW5Ccm9rZXJzKCkgewogICAgICAgIHJldHVybiBDb2xsZWN0\naW9ucy51bm1vZGlmaWFibGVDb2xsZWN0aW9uKF9icm9rZXJzKTsKICAgIH0K\nCiAgICAvKioKICAgICAqIFNpbXBsZSBzeW5jaHJvbml6YXRpb24gbGlzdGVu\nZXIgdG8gcmVtb3ZlIGNvbXBsZXRlZCB0cmFuc2FjdGlvbnMKICAgICAqIGZy\nb20gb3VyIGNhY2hlLgogICAgICovCiAgICBwcml2YXRlIGNsYXNzIFJlbW92\nZVRyYW5zYWN0aW9uU3luYwogICAgICAgIGltcGxlbWVudHMgU3luY2hyb25p\nemF0aW9uIHsKCiAgICAgICAgcHJpdmF0ZSBmaW5hbCBPYmplY3QgX3RyYW5z\nOwoKICAgICAgICBwdWJsaWMgUmVtb3ZlVHJhbnNhY3Rpb25TeW5jKE9iamVj\ndCB0cmFucykgewogICAgICAgICAgICBfdHJhbnMgPSB0cmFuczsKICAgICAg\nICB9CgogICAgICAgIHB1YmxpYyB2b2lkIGJlZm9yZUNvbXBsZXRpb24oKSB7\nCiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgdm9pZCBhZnRlckNvbXBsZXRp\nb24oaW50IHN0YXR1cykgewogICAgICAgICAgICBfdHJhbnNhY3Rpb25hbC5y\nZW1vdmUgKF90cmFucyk7CgkJfQoJfQp9Cg==\n","encoding":"base64"}

