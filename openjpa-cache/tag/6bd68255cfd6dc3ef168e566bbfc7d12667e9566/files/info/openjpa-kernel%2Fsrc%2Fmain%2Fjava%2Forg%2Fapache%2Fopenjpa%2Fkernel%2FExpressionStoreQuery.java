{"sha":"c683ba3902e030c4d8aca1f959b64b254c34e237","node_id":"MDQ6QmxvYjIwNjM2NDpjNjgzYmEzOTAyZTAzMGM0ZDhhY2ExZjk1OWI2NGIyNTRjMzRlMjM3","size":28236,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/c683ba3902e030c4d8aca1f959b64b254c34e237","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsOwoKaW1wb3J0IGph\ndmEudXRpbC5BcnJheUxpc3Q7CmltcG9ydCBqYXZhLnV0aWwuQ29sbGVjdGlv\nbjsKaW1wb3J0IGphdmEudXRpbC5IYXNoU2V0OwppbXBvcnQgamF2YS51dGls\nLkl0ZXJhdG9yOwppbXBvcnQgamF2YS51dGlsLkxpc3Q7CmltcG9ydCBqYXZh\nLnV0aWwuTWFwOwppbXBvcnQgamF2YS51dGlsLlNldDsKCmltcG9ydCBvcmcu\nYXBhY2hlLmNvbW1vbnMuY29sbGVjdGlvbnMubWFwLkxpbmtlZE1hcDsKaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5jb25mLk9wZW5KUEFDb25maWd1cmF0\naW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5leHBzLkFi\nc3RyYWN0RXhwcmVzc2lvblZpc2l0b3I7CmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEua2VybmVsLmV4cHMuQWdncmVnYXRlTGlzdGVuZXI7CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLmV4cHMuQ29uc3RhbnQ7CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLmV4cHMuRXhwcmVzc2lvbkZh\nY3Rvcnk7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLmV4cHMu\nRXhwcmVzc2lvblBhcnNlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5r\nZXJuZWwuZXhwcy5GaWx0ZXJMaXN0ZW5lcjsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS5rZXJuZWwuZXhwcy5Jbk1lbW9yeUV4cHJlc3Npb25GYWN0b3J5\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5leHBzLlBhdGg7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLmV4cHMuUXVlcnlF\neHByZXNzaW9uczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwu\nZXhwcy5SZXNvbHZlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJu\nZWwuZXhwcy5TdHJpbmdDb250YWluczsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5rZXJuZWwuZXhwcy5WYWw7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEua2VybmVsLmV4cHMuVmFsdWU7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEua2VybmVsLmV4cHMuV2lsZGNhcmRNYXRjaDsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5saWIucm9wLkxpc3RSZXN1bHRPYmplY3RQcm92aWRlcjsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIucm9wLlJhbmdlUmVzdWx0\nT2JqZWN0UHJvdmlkZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGli\nLnJvcC5SZXN1bHRPYmplY3RQcm92aWRlcjsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS5saWIudXRpbC5Mb2NhbGl6ZXI7CmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEubWV0YS5DbGFzc01ldGFEYXRhOwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLm1ldGEuRmllbGRNZXRhRGF0YTsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5tZXRhLkphdmFUeXBlczsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS51dGlsLkltcGxIZWxwZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEudXRpbC5JbnZhbGlkU3RhdGVFeGNlcHRpb247CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEudXRpbC5VbnN1cHBvcnRlZEV4Y2VwdGlvbjsKaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLlVzZXJFeGNlcHRpb247Cgov\nKioKICogSW1wbGVtZW50YXRpb24gb2YgYW4gZXhwcmVzc2lvbi1iYXNlZCBx\ndWVyeSwgd2hpY2ggY2FuIGhhbmRsZQogKiBTdHJpbmctYmFzZWQgcXVlcnkg\nZXhwcmVzc2lvbnMgc3VjaCBhcyBKUFFMIGFuZCBKRE9RTC4KICogVGhpcyBp\nbXBsZW1lbnRhdGlvbiBpcyBzdWl0YWJsZSBmb3IgaW4tbWVtb3J5IG9wZXJh\ndGlvbi4KICogT3ZlcnJpZGUgdGhlIGZvbGxvd2luZyBtZXRob2RzIHRvIGFs\nc28gc3VwcG9ydCBkYXRhc3RvcmUgb3BlcmF0aW9uOgogKiA8dWw+CiAqIDxs\naT5PdmVycmlkZSB7QGxpbmsgI3N1cHBvcnRzRGF0YVN0b3JlRXhlY3V0aW9u\nfSB0byByZXR1cm4KICogPGNvZGU+dHJ1ZTwvY29kZT4uPC9saT4KICogPGxp\nPk92ZXJyaWRlIHtAbGluayAjZXhlY3V0ZVF1ZXJ5fSwge0BsaW5rICNleGVj\ndXRlRGVsZXRlfSwgYW5kCiAqIHtAbGluayAjZXhlY3V0ZVVwZGF0ZX0gdG8g\nZXhlY3V0ZSB0aGUgcXVlcnkgYWdhaW5zdCB0aGUgZGF0YSBzdG9yZS4KICog\nS2VlcCBpbiBtaW5kIHRoYXQgdGhlIHBhcmFtZXRlcnMgcGFzc2VkIHRvIHRo\naXMgbWV0aG9kIG1pZ2h0IGJlIGluIHVzZQogKiBieSBzZXZlcmFsIHRocmVh\nZHMgaW4gZGlmZmVyZW50IHF1ZXJ5IGluc3RhbmNlcy4gVGh1cyBjb21wb25l\nbnRzIGxpa2UKICogdGhlIGV4cHJlc3Npb24gZmFjdG9yeSBtdXN0IGVpdGhl\nciBiZSB0aHJlYWQgc2FmZSwgb3IgdGhpcyBtZXRob2QgbXVzdAogKiBzeW5j\naHJvbml6ZSBvbiB0aGVtLjwvbGk+CiAqIDxsaT5PdmVycmlkZSB7QGxpbmsg\nI2dldERhdGFTdG9yZUFjdGlvbnN9IHRvIHJldHVybiBhIHJlcHJlc2VudGF0\naW9uIG9mCiAqIHRoZSBhY3Rpb25zIHRoYXQgd2lsbCBiZSB0YWtlbiBvbiB0\naGUgZGF0YSBzdG9yZS4gRm9yIHVzZSBpbiB2aXN1YWwKICogdG9vbHMuPC9s\naT4KICogPGxpPk92ZXJyaWRlIHtAbGluayAjZ2V0RXhwcmVzc2lvbkZhY3Rv\ncnl9IHRvIHJldHVybiBhIGZhY3RvcnkgZm9yIGNyZWF0aW5nCiAqIGV4cHJl\nc3Npb25zIGluIHRoZSBkYXRhc3RvcmUncyBsYW5ndWFnZS4gVGhlIGZhY3Rv\ncnkgbXVzdCBiZSBjYWNoYWJsZS48L2xpPgogKiA8L3VsPgogKgogKiBAYXV0\naG9yIEFiZSBXaGl0ZQogKi8KcHVibGljIGNsYXNzIEV4cHJlc3Npb25TdG9y\nZVF1ZXJ5CiAgICBleHRlbmRzIEFic3RyYWN0U3RvcmVRdWVyeSB7CgogICAg\ncHJpdmF0ZSBzdGF0aWMgZmluYWwgTG9jYWxpemVyIF9sb2MgPSBMb2NhbGl6\nZXIuZm9yUGFja2FnZQogICAgICAgIChFeHByZXNzaW9uU3RvcmVRdWVyeS5j\nbGFzcyk7CgogICAgLy8gbWFpbnRhaW4gc3VwcG9ydCBmb3IgYSBjb3VwbGUg\nb2YgZGVwcmVjYXRlZCBleHRlbnNpb25zCiAgICBwcml2YXRlIHN0YXRpYyBm\naW5hbCBGaWx0ZXJMaXN0ZW5lcltdIF9saXN0ZW5lcnMgPSBuZXcgRmlsdGVy\nTGlzdGVuZXJbXXsKICAgICAgICBuZXcgU3RyaW5nQ29udGFpbnMoKSwgbmV3\nIFdpbGRjYXJkTWF0Y2goKSwKICAgIH07CgogICAgcHJpdmF0ZSBmaW5hbCBF\neHByZXNzaW9uUGFyc2VyIF9wYXJzZXI7CiAgICBwcml2YXRlIHRyYW5zaWVu\ndCBPYmplY3QgX3BhcnNlZDsKCiAgICAvKioKICAgICAqIENvbnN0cnVjdCBh\nIHF1ZXJ5IHdpdGggYSBwYXJzZXIgZm9yIHRoZSBsYW5ndWFnZS4KICAgICAq\nLwogICAgcHVibGljIEV4cHJlc3Npb25TdG9yZVF1ZXJ5KEV4cHJlc3Npb25Q\nYXJzZXIgcGFyc2VyKSB7CiAgICAgICAgX3BhcnNlciA9IHBhcnNlcjsKICAg\nIH0KCiAgICAvKioKICAgICAqIFJlc29sdmVyIHVzZWQgaW4gcGFyc2luZy4K\nICAgICAqLwogICAgcHVibGljIFJlc29sdmVyIGdldFJlc29sdmVyKCkgewog\nICAgICAgIHJldHVybiBuZXcgUmVzb2x2ZXIoKSB7CiAgICAgICAgICAgIHB1\nYmxpYyBDbGFzcyBjbGFzc0Zvck5hbWUoU3RyaW5nIG5hbWUsIFN0cmluZ1td\nIGltcG9ydHMpIHsKICAgICAgICAgICAgICAgIHJldHVybiBjdHguY2xhc3NG\nb3JOYW1lKG5hbWUsIGltcG9ydHMpOwogICAgICAgICAgICB9CgogICAgICAg\nICAgICBwdWJsaWMgRmlsdGVyTGlzdGVuZXIgZ2V0RmlsdGVyTGlzdGVuZXIo\nU3RyaW5nIHRhZykgewogICAgICAgICAgICAgICAgcmV0dXJuIGN0eC5nZXRG\naWx0ZXJMaXN0ZW5lcih0YWcpOwogICAgICAgICAgICB9CgogICAgICAgICAg\nICBwdWJsaWMgQWdncmVnYXRlTGlzdGVuZXIgZ2V0QWdncmVnYXRlTGlzdGVu\nZXIoU3RyaW5nIHRhZykgewogICAgICAgICAgICAgICAgcmV0dXJuIGN0eC5n\nZXRBZ2dyZWdhdGVMaXN0ZW5lcih0YWcpOwogICAgICAgICAgICB9CgogICAg\nICAgICAgICBwdWJsaWMgT3BlbkpQQUNvbmZpZ3VyYXRpb24gZ2V0Q29uZmln\ndXJhdGlvbigpIHsKICAgICAgICAgICAgICAgIHJldHVybiBjdHguZ2V0U3Rv\ncmVDb250ZXh0KCkuZ2V0Q29uZmlndXJhdGlvbigpOwogICAgICAgICAgICB9\nCiAgICAgICAgfTsKICAgIH0KCiAgICAvKioKICAgICAqIEFsbG93IGRpcmVj\ndCBzZXR0aW5nIG9mIHBhcnNlZCBzdGF0ZSBmb3IgZmFjYWRlcyB0aGF0IGRv\nIHBhcnNpbmcuCiAgICAgKiBUaGUgZmFjYWRlIHNob3VsZCBjYWxsIHRoaXMg\nbWV0aG9kIHR3aWNlOiBvbmNlIHdpdGggdGhlIHF1ZXJ5IHN0cmluZywKICAg\nICAqIGFuZCBhZ2FpbiB3aXRoIHRoZSBwYXJzZWQgc3RhdGUuCiAgICAgKi8K\nICAgIHB1YmxpYyBib29sZWFuIHNldFF1ZXJ5KE9iamVjdCBxdWVyeSkgewog\nICAgICAgIF9wYXJzZWQgPSBxdWVyeTsKICAgICAgICByZXR1cm4gdHJ1ZTsK\nICAgIH0KCiAgICBwdWJsaWMgRmlsdGVyTGlzdGVuZXIgZ2V0RmlsdGVyTGlz\ndGVuZXIoU3RyaW5nIHRhZykgewogICAgICAgIGZvciAoaW50IGkgPSAwOyBp\nIDwgX2xpc3RlbmVycy5sZW5ndGg7IGkrKykKICAgICAgICAgICAgaWYgKF9s\naXN0ZW5lcnNbaV0uZ2V0VGFnKCkuZXF1YWxzKHRhZykpCiAgICAgICAgICAg\nICAgICByZXR1cm4gX2xpc3RlbmVyc1tpXTsKICAgICAgICByZXR1cm4gbnVs\nbDsKICAgIH0KCiAgICBwdWJsaWMgT2JqZWN0IG5ld0NvbXBpbGF0aW9uKCkg\newogICAgICAgIGlmIChfcGFyc2VkICE9IG51bGwpCiAgICAgICAgICAgIHJl\ndHVybiBfcGFyc2VkOwogICAgICAgIHJldHVybiBfcGFyc2VyLnBhcnNlKGN0\neC5nZXRRdWVyeVN0cmluZygpLCB0aGlzKTsKICAgIH0KCiAgICBwdWJsaWMg\ndm9pZCBwb3B1bGF0ZUZyb21Db21waWxhdGlvbihPYmplY3QgY29tcCkgewog\nICAgICAgIF9wYXJzZXIucG9wdWxhdGUoY29tcCwgdGhpcyk7CiAgICB9Cgog\nICAgcHVibGljIHZvaWQgaW52YWxpZGF0ZUNvbXBpbGF0aW9uKCkgewogICAg\nICAgIF9wYXJzZWQgPSBudWxsOwogICAgfQoKICAgIHB1YmxpYyBib29sZWFu\nIHN1cHBvcnRzSW5NZW1vcnlFeGVjdXRpb24oKSB7CiAgICAgICAgcmV0dXJu\nIHRydWU7CiAgICB9CgogICAgcHVibGljIEV4ZWN1dG9yIG5ld0luTWVtb3J5\nRXhlY3V0b3IoQ2xhc3NNZXRhRGF0YSBtZXRhLCBib29sZWFuIHN1YnMpIHsK\nICAgICAgICByZXR1cm4gbmV3IEluTWVtb3J5RXhlY3V0b3IodGhpcywgbWV0\nYSwgc3VicywgX3BhcnNlciwKICAgICAgICAgICAgY3R4LmdldENvbXBpbGF0\naW9uKCkpOwogICAgfQoKICAgIHB1YmxpYyBFeGVjdXRvciBuZXdEYXRhU3Rv\ncmVFeGVjdXRvcihDbGFzc01ldGFEYXRhIG1ldGEsIGJvb2xlYW4gc3Vicykg\newogICAgICAgIHJldHVybiBuZXcgRGF0YVN0b3JlRXhlY3V0b3IodGhpcywg\nbWV0YSwgc3VicywgX3BhcnNlciwKICAgICAgICAgICAgY3R4LmdldENvbXBp\nbGF0aW9uKCkpOwogICAgfQoKICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v\nLwogICAgLy8gTWV0aG9kcyBmb3IgT3ZlcnJpZGUKICAgIC8vLy8vLy8vLy8v\nLy8vLy8vLy8vLy8vLwoKICAgIC8qKgogICAgICogRXhlY3V0ZSB0aGUgZ2l2\nZW4gZXhwcmVzc2lvbiBhZ2FpbnN0IHRoZSBnaXZlbiBjYW5kaWRhdGUgZXh0\nZW50LgogICAgICoKICAgICAqIEBwYXJhbSBleCBjdXJyZW50IGV4ZWN1dG9y\nCiAgICAgKiBAcGFyYW0gYmFzZSB0aGUgYmFzZSB0eXBlIHRoZSBxdWVyeSBz\naG91bGQgbWF0Y2gKICAgICAqIEBwYXJhbSB0eXBlcyB0aGUgaW5kZXBlbmRl\nbnQgY2FuZGlkYXRlIHR5cGVzCiAgICAgKiBAcGFyYW0gc3ViY2xhc3NlcyB0\ncnVlIGlmIHN1YmNsYXNzZXMgc2hvdWxkIGJlIGluY2x1ZGVkIGluIHRoZSBy\nZXN1bHRzCiAgICAgKiBAcGFyYW0gZmFjdHMgdGhlIGV4cHJlc3Npb24gZmFj\ndG9yeSB1c2VkIHRvIGJ1aWxkIHRoZSBxdWVyeSBmb3IKICAgICAqIGVhY2gg\nYmFzZSB0eXBlCiAgICAgKiBAcGFyYW0gcGFyc2VkIHRoZSBwYXJzZWQgcXVl\ncnkgdmFsdWVzCiAgICAgKiBAcGFyYW0gcGFyYW1zIHBhcmFtZXRlciB2YWx1\nZXMsIG9yIGVtcHR5IGFycmF5CiAgICAgKiBAcGFyYW0gcmFuZ2UgcmVzdWx0\nIHJhbmdlCiAgICAgKiBAcmV0dXJuIGEgcHJvdmlkZXIgZm9yIG1hdGNoaW5n\nIG9iamVjdHMKICAgICAqLwogICAgcHJvdGVjdGVkIFJlc3VsdE9iamVjdFBy\nb3ZpZGVyIGV4ZWN1dGVRdWVyeShFeGVjdXRvciBleCwKICAgICAgICBDbGFz\nc01ldGFEYXRhIGJhc2UsIENsYXNzTWV0YURhdGFbXSB0eXBlcywgYm9vbGVh\nbiBzdWJjbGFzc2VzLAogICAgICAgIEV4cHJlc3Npb25GYWN0b3J5W10gZmFj\ndHMsIFF1ZXJ5RXhwcmVzc2lvbnNbXSBwYXJzZWQsIE9iamVjdFtdIHBhcmFt\ncywKICAgICAgICBSYW5nZSByYW5nZSkgewogICAgICAgIHRocm93IG5ldyBV\nbnN1cHBvcnRlZEV4Y2VwdGlvbigpOwogICAgfQoKICAgIC8qKgogICAgICog\nRXhlY3V0ZSB0aGUgZ2l2ZW4gZXhwcmVzc2lvbiBhZ2FpbnN0IHRoZSBnaXZl\nbiBjYW5kaWRhdGUgZXh0ZW50CiAgICAgKiBhbmQgZGVsZXRlIHRoZSBpbnN0\nYW5jZXMuCiAgICAgKgogICAgICogQHBhcmFtIGV4IGN1cnJlbnQgZXhlY3V0\nb3IKICAgICAqIEBwYXJhbSBiYXNlIHRoZSBiYXNlIHR5cGUgdGhlIHF1ZXJ5\nIHNob3VsZCBtYXRjaAogICAgICogQHBhcmFtIHR5cGVzIHRoZSBpbmRlcGVu\nZGVudCBjYW5kaWRhdGUgdHlwZXMKICAgICAqIEBwYXJhbSBzdWJjbGFzc2Vz\nIHRydWUgaWYgc3ViY2xhc3NlcyBzaG91bGQgYmUgaW5jbHVkZWQgaW4gdGhl\nIHJlc3VsdHMKICAgICAqIEBwYXJhbSBmYWN0cyB0aGUgZXhwcmVzc2lvbiBm\nYWN0b3J5IHVzZWQgdG8gYnVpbGQgdGhlIHF1ZXJ5IGZvcgogICAgICogZWFj\naCBiYXNlIHR5cGUKICAgICAqIEBwYXJhbSBwYXJzZWQgdGhlIHBhcnNlZCBx\ndWVyeSB2YWx1ZXMKICAgICAqIEBwYXJhbSBwYXJhbXMgcGFyYW1ldGVyIHZh\nbHVlcywgb3IgZW1wdHkgYXJyYXkKICAgICAqIEByZXR1cm4gYSBudW1iZXIg\naW5kaWNhdGluZyB0aGUgbnVtYmVyIG9mIGluc3RhbmNlcyBkZWxldGVkLAog\nICAgICogb3IgbnVsbCB0byBleGVjdXRlIHRoZSBkZWxldGUgaW4gbWVtb3J5\nCiAgICAgKi8KICAgIHByb3RlY3RlZCBOdW1iZXIgZXhlY3V0ZURlbGV0ZShF\neGVjdXRvciBleCwgQ2xhc3NNZXRhRGF0YSBiYXNlLAogICAgICAgIENsYXNz\nTWV0YURhdGFbXSB0eXBlcywgYm9vbGVhbiBzdWJjbGFzc2VzLCBFeHByZXNz\naW9uRmFjdG9yeVtdIGZhY3RzLAogICAgICAgIFF1ZXJ5RXhwcmVzc2lvbnNb\nXSBwYXJzZWQsIE9iamVjdFtdIHBhcmFtcykgewogICAgICAgIHJldHVybiBu\ndWxsOwogICAgfQoKICAgIC8qKgogICAgICogRXhlY3V0ZSB0aGUgZ2l2ZW4g\nZXhwcmVzc2lvbiBhZ2FpbnN0IHRoZSBnaXZlbiBjYW5kaWRhdGUgZXh0ZW50\nCiAgICAgKiBhbmQgdXBkYXRlcyB0aGUgaW5zdGFuY2VzLgogICAgICoKICAg\nICAqIEBwYXJhbSBleCBjdXJyZW50IGV4ZWN1dG9yCiAgICAgKiBAcGFyYW0g\nYmFzZSB0aGUgYmFzZSB0eXBlIHRoZSBxdWVyeSBzaG91bGQgbWF0Y2gKICAg\nICAqIEBwYXJhbSB0eXBlcyB0aGUgaW5kZXBlbmRlbnQgY2FuZGlkYXRlIHR5\ncGVzCiAgICAgKiBAcGFyYW0gc3ViY2xhc3NlcyB0cnVlIGlmIHN1YmNsYXNz\nZXMgc2hvdWxkIGJlIGluY2x1ZGVkIGluIHRoZSByZXN1bHRzCiAgICAgKiBA\ncGFyYW0gZmFjdHMgdGhlIGV4cHJlc3Npb24gZmFjdG9yeSB1c2VkIHRvIGJ1\naWxkIHRoZSBxdWVyeSBmb3IKICAgICAqIGVhY2ggYmFzZSB0eXBlCiAgICAg\nKiBAcGFyYW0gcGFyc2VkIHRoZSBwYXJzZWQgcXVlcnkgdmFsdWVzCiAgICAg\nKiBAcGFyYW0gcGFyYW1zIHBhcmFtZXRlciB2YWx1ZXMsIG9yIGVtcHR5IGFy\ncmF5CiAgICAgKiBAcmV0dXJuIGEgbnVtYmVyIGluZGljYXRpbmcgdGhlIG51\nbWJlciBvZiBpbnN0YW5jZXMgdXBkYXRlZCwKICAgICAqIG9yIG51bGwgdG8g\nZXhlY3V0ZSB0aGUgdXBkYXRlIGluIG1lbW9yeS4KICAgICAqLwogICAgcHJv\ndGVjdGVkIE51bWJlciBleGVjdXRlVXBkYXRlKEV4ZWN1dG9yIGV4LCBDbGFz\nc01ldGFEYXRhIGJhc2UsCiAgICAgICAgQ2xhc3NNZXRhRGF0YVtdIHR5cGVz\nLCBib29sZWFuIHN1YmNsYXNzZXMsIEV4cHJlc3Npb25GYWN0b3J5W10gZmFj\ndHMsCiAgICAgICAgUXVlcnlFeHByZXNzaW9uc1tdIHBhcnNlZCwgT2JqZWN0\nW10gcGFyYW1zKSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBSZXR1cm4gdGhlIGNvbW1hbmRzIHRoYXQgd2lsbCBiZSBz\nZW50IHRvIHRoZSBkYXRhc3RvcmUgaW4gb3JkZXIKICAgICAqIHRvIGV4ZWN1\ndGUgdGhlIHF1ZXJ5LCB0eXBpY2FsbHkgaW4gdGhlIGRhdGFiYXNlJ3MgbmF0\naXZlIGxhbmd1YWdlLgogICAgICoKICAgICAqIEBwYXJhbSBiYXNlIHRoZSBi\nYXNlIHR5cGUgdGhlIHF1ZXJ5IHNob3VsZCBtYXRjaAogICAgICogQHBhcmFt\nIHR5cGVzIHRoZSBpbmRlcGVuZGVudCBjYW5kaWRhdGUgdHlwZXMKICAgICAq\nIEBwYXJhbSBzdWJjbGFzc2VzIHRydWUgaWYgc3ViY2xhc3NlcyBzaG91bGQg\nYmUgaW5jbHVkZWQgaW4gdGhlIHJlc3VsdHMKICAgICAqIEBwYXJhbSBmYWN0\ncyB0aGUgZXhwcmVzc2lvbiBmYWN0b3J5IHVzZWQgdG8gYnVpbGQgdGhlIHF1\nZXJ5IGZvcgogICAgICogZWFjaCBiYXNlIHR5cGUKICAgICAqIEBwYXJhbSBw\nYXJzZWQgdGhlIHBhcnNlZCBxdWVyeSB2YWx1ZXMKICAgICAqIEBwYXJhbSBw\nYXJhbXMgcGFyYW1ldGVyIHZhbHVlcywgb3IgZW1wdHkgYXJyYXkKICAgICAq\nIEBwYXJhbSByYW5nZSByZXN1bHQgcmFuZ2UKICAgICAqIEByZXR1cm4gYSB0\nZXh0dWFsIGRlc2NyaXB0aW9uIG9mIHRoZSBxdWVyeSB0byBleGVjdXRlCiAg\nICAgKi8KICAgIHByb3RlY3RlZCBTdHJpbmdbXSBnZXREYXRhU3RvcmVBY3Rp\nb25zKENsYXNzTWV0YURhdGEgYmFzZSwKICAgICAgICBDbGFzc01ldGFEYXRh\nW10gdHlwZXMsIGJvb2xlYW4gc3ViY2xhc3NlcywgRXhwcmVzc2lvbkZhY3Rv\ncnlbXSBmYWN0cywKICAgICAgICBRdWVyeUV4cHJlc3Npb25zW10gcGFyc2Vk\nLCBPYmplY3RbXSBwYXJhbXMsIFJhbmdlIHJhbmdlKSB7CiAgICAgICAgcmV0\ndXJuIFN0b3JlUXVlcnkuRU1QVFlfU1RSSU5HUzsKICAgIH0KCiAgICAvKioK\nICAgICAqIFJldHVybiB0aGUgYXNzaWduYWJsZSB0eXBlcyBmb3IgdGhlIGdp\ndmVuIG1ldGFkYXRhIHdob3NlIGV4cHJlc3Npb24KICAgICAqIHRyZWVzIG11\nc3QgYmUgY29tcGlsZWQgaW5kZXBlbmRlbnRseS4KICAgICAqLwogICAgcHJv\ndGVjdGVkIENsYXNzTWV0YURhdGFbXSBnZXRJbmRlcGVuZGVudEV4cHJlc3Np\nb25DYW5kaWRhdGVzCiAgICAgICAgKENsYXNzTWV0YURhdGEgdHlwZSwgYm9v\nbGVhbiBzdWJjbGFzc2VzKSB7CiAgICAgICAgcmV0dXJuIG5ldyBDbGFzc01l\ndGFEYXRhW117IHR5cGUgfTsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVy\nbiBhbiB7QGxpbmsgRXhwcmVzc2lvbkZhY3Rvcnl9IHRvIHVzZSB0byBjcmVh\ndGUgYW4gZXhwcmVzc2lvbiB0bwogICAgICogYmUgZXhlY3V0ZWQgYWdhaW5z\ndCBhbiBleHRlbnQuIEVhY2ggZmFjdG9yeSB3aWxsIGJlIHVzZWQgdG8gY29t\ncGlsZQogICAgICogb25lIGZpbHRlciBvbmx5LiBUaGUgZmFjdG9yeSBtdXN0\nIGJlIGNhY2hhYmxlLgogICAgICovCiAgICBwcm90ZWN0ZWQgRXhwcmVzc2lv\nbkZhY3RvcnkgZ2V0RXhwcmVzc2lvbkZhY3RvcnkoQ2xhc3NNZXRhRGF0YSB0\neXBlKSB7CiAgICAgICAgdGhyb3cgbmV3IFVuc3VwcG9ydGVkRXhjZXB0aW9u\nKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBQcm92aWRlcyBzdXBwb3J0IGZv\nciBxdWVyaWVzIHRoYXQgaG9sZCBxdWVyeSBpbmZvcm1hdGlvbgogICAgICog\naW4gYSB7QGxpbmsgUXVlcnlFeHByZXNzaW9uc30gaW5zdGFuY2UuCiAgICAg\nKgogICAgICogQGF1dGhvciBNYXJjIFBydWQnaG9tbWVhdXgKICAgICAqLwog\nICAgcHJpdmF0ZSBzdGF0aWMgYWJzdHJhY3QgY2xhc3MgQWJzdHJhY3RFeHBy\nZXNzaW9uRXhlY3V0b3IKICAgICAgICBleHRlbmRzIEFic3RyYWN0RXhlY3V0\nb3IKICAgICAgICBpbXBsZW1lbnRzIEV4ZWN1dG9yIHsKCiAgICAgICAgLyoq\nCiAgICAgICAgICogUmV0dXJuIHRoZSBwYXJzZWQgcXVlcnkgZXhwcmVzc2lv\nbnMgZm9yIG91ciBjYW5kaWRhdGUgdHlwZXMuCiAgICAgICAgICovCiAgICAg\nICAgcHJvdGVjdGVkIGFic3RyYWN0IFF1ZXJ5RXhwcmVzc2lvbnNbXSBnZXRR\ndWVyeUV4cHJlc3Npb25zKCk7CgogICAgICAgIC8qKgogICAgICAgICAqIFJl\ndHVybiB0aGUgcXVlcnkgZXhwcmVzc2lvbnMgZm9yIG9uZSBjYW5kaWRhdGUg\ndHlwZSwgb3IgZGllIGlmIG5vbmUuCiAgICAgICAgICovCiAgICAgICAgcHJp\ndmF0ZSBRdWVyeUV4cHJlc3Npb25zIGFzc2VydFF1ZXJ5RXhwcmVzc2lvbigp\nIHsKICAgICAgICAgICAgUXVlcnlFeHByZXNzaW9uc1tdIGV4cCA9IGdldFF1\nZXJ5RXhwcmVzc2lvbnMoKTsKICAgICAgICAgICAgaWYgKGV4cCA9PSBudWxs\nIHx8IGV4cC5sZW5ndGggPCAxKQogICAgICAgICAgICAgICAgdGhyb3cgbmV3\nIEludmFsaWRTdGF0ZUV4Y2VwdGlvbihfbG9jLmdldCgibm8tZXhwcmVzc2lv\nbnMiKSk7CgogICAgICAgICAgICByZXR1cm4gZXhwWzBdOwogICAgICAgIH0K\nCiAgICAgICAgLyoqCiAgICAgICAgICogVGhyb3cgcHJvcGVyIGV4Y2VwdGlv\nbiBpZiBnaXZlbiB2YWx1ZSBpcyBhIGNvbGxlY3Rpb24vbWFwL2FycmF5Lgog\nICAgICAgICAqLwogICAgICAgIHByb3RlY3RlZCB2b2lkIGFzc2VydE5vdENv\nbnRhaW5lcihWYWx1ZSB2YWwsIFN0b3JlUXVlcnkgcSkgewogICAgICAgICAg\nICAvLyB2YXJpYWJsZXMgcmVwcmVzZW50IGNvbnRhaW5lciBlbGVtZW50cywg\nbm90IHRoZSBjb250YWluZXIgaXRzZWxmCiAgICAgICAgICAgIGlmICh2YWwu\naXNWYXJpYWJsZSgpKQogICAgICAgICAgICAgICAgcmV0dXJuOwoKICAgICAg\nICAgICAgQ2xhc3MgdHlwZTsKICAgICAgICAgICAgaWYgKHZhbCBpbnN0YW5j\nZW9mIFBhdGgpIHsKICAgICAgICAgICAgICAgIEZpZWxkTWV0YURhdGEgZm1k\nID0gKChQYXRoKSB2YWwpLmxhc3QoKTsKICAgICAgICAgICAgICAgIHR5cGUg\nPSAoZm1kID09IG51bGwpID8gdmFsLmdldFR5cGUoKSA6IGZtZC5nZXREZWNs\nYXJlZFR5cGUoKTsKICAgICAgICAgICAgfSBlbHNlCiAgICAgICAgICAgICAg\nICB0eXBlID0gdmFsLmdldFR5cGUoKTsKCiAgICAgICAgICAgIHN3aXRjaCAo\nSmF2YVR5cGVzLmdldFR5cGVDb2RlKHR5cGUpKSB7CiAgICAgICAgICAgICAg\nICBjYXNlIEphdmFUeXBlcy5BUlJBWToKICAgICAgICAgICAgICAgIGNhc2Ug\nSmF2YVR5cGVzLkNPTExFQ1RJT046CiAgICAgICAgICAgICAgICBjYXNlIEph\ndmFUeXBlcy5NQVA6CiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IFVz\nZXJFeGNlcHRpb24oX2xvYy5nZXQoImNvbnRhaW5lci1wcm9qZWN0aW9uIiwK\nICAgICAgICAgICAgICAgICAgICAgICAgcS5nZXRDb250ZXh0KCkuZ2V0UXVl\ncnlTdHJpbmcoKSkpOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAg\nICBwdWJsaWMgZmluYWwgdm9pZCB2YWxpZGF0ZShTdG9yZVF1ZXJ5IHEpIHsK\nICAgICAgICAgICAgUXVlcnlFeHByZXNzaW9ucyBleHBzID0gYXNzZXJ0UXVl\ncnlFeHByZXNzaW9uKCk7ICAgIAogICAgICAgICAgICBWYWxpZGF0ZUdyb3Vw\naW5nRXhwcmVzc2lvblZpc2l0b3IudmFsaWRhdGUocS5nZXRDb250ZXh0KCks\nIGV4cHMpOyAKICAgICAgICB9CgogICAgICAgIHB1YmxpYyB2b2lkIGdldFJh\nbmdlKFN0b3JlUXVlcnkgcSwgT2JqZWN0W10gcGFyYW1zLCBSYW5nZSByYW5n\nZSkgewogICAgICAgICAgICBRdWVyeUV4cHJlc3Npb25zIGV4cHMgPSBhc3Nl\ncnRRdWVyeUV4cHJlc3Npb24oKTsKICAgICAgICAgICAgaWYgKGV4cHMucmFu\nZ2UubGVuZ3RoID09IDApCiAgICAgICAgICAgICAgICByZXR1cm47CgogICAg\nICAgICAgICBpZiAoZXhwcy5yYW5nZS5sZW5ndGggPT0gMiAKICAgICAgICAg\nICAgICAgICYmIGV4cHMucmFuZ2VbMF0gaW5zdGFuY2VvZiBDb25zdGFudAog\nICAgICAgICAgICAgICAgJiYgZXhwcy5yYW5nZVsxXSBpbnN0YW5jZW9mIENv\nbnN0YW50KSB7CiAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAg\nICAgICAgIHJhbmdlLnN0YXJ0ID0gKChOdW1iZXIpICgoQ29uc3RhbnQpIGV4\ncHMucmFuZ2VbMF0pLgogICAgICAgICAgICAgICAgICAgICAgICBnZXRWYWx1\nZShwYXJhbXMpKS5sb25nVmFsdWUoKTsKICAgICAgICAgICAgICAgICAgICBy\nYW5nZS5lbmQgPSAoKE51bWJlcikgKChDb25zdGFudCkgZXhwcy5yYW5nZVsx\nXSkuCiAgICAgICAgICAgICAgICAgICAgICAgIGdldFZhbHVlKHBhcmFtcykp\nLmxvbmdWYWx1ZSgpOwogICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAg\nICAgICAgICAgICAgIH0gY2F0Y2ggKENsYXNzQ2FzdEV4Y2VwdGlvbiBjY2Up\nIHsKICAgICAgICAgICAgICAgICAgICAvLyBmYWxsIHRocm91Z2ggdG8gZXhj\nZXB0aW9uIGJlbG93CiAgICAgICAgICAgICAgICB9IGNhdGNoIChOdWxsUG9p\nbnRlckV4Y2VwdGlvbiBucGUpIHsKICAgICAgICAgICAgICAgICAgICAvLyBm\nYWxsIHRocm91Z2ggdG8gZXhjZXB0aW9uIGJlbG93CiAgICAgICAgICAgICAg\nICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgdGhyb3cgbmV3IFVzZXJF\neGNlcHRpb24oX2xvYy5nZXQoIm9ubHktcmFuZ2UtY29uc3RhbnRzIiwKICAg\nICAgICAgICAgICAgIHEuZ2V0Q29udGV4dCgpLmdldFF1ZXJ5U3RyaW5nKCkp\nKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBmaW5hbCBDbGFzcyBnZXRS\nZXN1bHRDbGFzcyhTdG9yZVF1ZXJ5IHEpIHsKICAgICAgICAgICAgcmV0dXJu\nIGFzc2VydFF1ZXJ5RXhwcmVzc2lvbigpLnJlc3VsdENsYXNzOwogICAgICAg\nIH0KCiAgICAgICAgcHVibGljIGZpbmFsIGJvb2xlYW5bXSBnZXRBc2NlbmRp\nbmcoU3RvcmVRdWVyeSBxKSB7CiAgICAgICAgICAgIHJldHVybiBhc3NlcnRR\ndWVyeUV4cHJlc3Npb24oKS5hc2NlbmRpbmc7CiAgICAgICAgfQoKICAgICAg\nICBwdWJsaWMgZmluYWwgU3RyaW5nIGdldEFsaWFzKFN0b3JlUXVlcnkgcSkg\newogICAgICAgICAgICByZXR1cm4gYXNzZXJ0UXVlcnlFeHByZXNzaW9uKCku\nYWxpYXM7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgZmluYWwgU3RyaW5n\nW10gZ2V0UHJvamVjdGlvbkFsaWFzZXMoU3RvcmVRdWVyeSBxKSB7CiAgICAg\nICAgICAgIHJldHVybiBhc3NlcnRRdWVyeUV4cHJlc3Npb24oKS5wcm9qZWN0\naW9uQWxpYXNlczsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBmaW5hbCBp\nbnQgZ2V0T3BlcmF0aW9uKFN0b3JlUXVlcnkgcSkgewogICAgICAgICAgICBy\nZXR1cm4gYXNzZXJ0UXVlcnlFeHByZXNzaW9uKCkub3BlcmF0aW9uOwogICAg\nICAgIH0KCiAgICAgICAgcHVibGljIGZpbmFsIGJvb2xlYW4gaXNBZ2dyZWdh\ndGUoU3RvcmVRdWVyeSBxKSB7CiAgICAgICAgICAgIHJldHVybiBhc3NlcnRR\ndWVyeUV4cHJlc3Npb24oKS5pc0FnZ3JlZ2F0ZSgpOwogICAgICAgIH0KCiAg\nICAgICAgcHVibGljIGZpbmFsIGJvb2xlYW4gaGFzR3JvdXBpbmcoU3RvcmVR\ndWVyeSBxKSB7CiAgICAgICAgICAgIHJldHVybiBhc3NlcnRRdWVyeUV4cHJl\nc3Npb24oKS5ncm91cGluZy5sZW5ndGggPiAwOwogICAgICAgIH0KCiAgICAg\nICAgcHVibGljIGZpbmFsIExpbmtlZE1hcCBnZXRQYXJhbWV0ZXJUeXBlcyhT\ndG9yZVF1ZXJ5IHEpIHsKICAgICAgICAgICAgcmV0dXJuIGFzc2VydFF1ZXJ5\nRXhwcmVzc2lvbigpLnBhcmFtZXRlclR5cGVzOwogICAgICAgIH0KCiAgICAg\nICAgcHVibGljIGZpbmFsIE1hcCBnZXRVcGRhdGVzKFN0b3JlUXVlcnkgcSkg\newogICAgICAgICAgICByZXR1cm4gYXNzZXJ0UXVlcnlFeHByZXNzaW9uKCku\ndXBkYXRlczsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBmaW5hbCBDbGFz\nc01ldGFEYXRhW10gZ2V0QWNjZXNzUGF0aE1ldGFEYXRhcyhTdG9yZVF1ZXJ5\nIHEpIHsKICAgICAgICAgICAgUXVlcnlFeHByZXNzaW9uc1tdIGV4cHMgPSBn\nZXRRdWVyeUV4cHJlc3Npb25zKCk7CiAgICAgICAgICAgIGlmIChleHBzLmxl\nbmd0aCA9PSAxKQogICAgICAgICAgICAgICAgcmV0dXJuIGV4cHNbMF0uYWNj\nZXNzUGF0aDsKCiAgICAgICAgICAgIExpc3QgbWV0YXMgPSBudWxsOwogICAg\nICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGV4cHMubGVuZ3RoOyBpKysp\nCiAgICAgICAgICAgICAgICBtZXRhcyA9IEZpbHRlcnMuYWRkQWNjZXNzUGF0\naE1ldGFEYXRhcyhtZXRhcywKICAgICAgICAgICAgICAgICAgICBleHBzW2ld\nLmFjY2Vzc1BhdGgpOwogICAgICAgICAgICBpZiAobWV0YXMgPT0gbnVsbCkK\nICAgICAgICAgICAgICAgIHJldHVybiBTdG9yZVF1ZXJ5LkVNUFRZX01FVEFT\nOwogICAgICAgICAgICByZXR1cm4gKENsYXNzTWV0YURhdGFbXSkgbWV0YXMu\ndG9BcnJheQogICAgICAgICAgICAgICAgKG5ldyBDbGFzc01ldGFEYXRhW21l\ndGFzLnNpemUoKV0pOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIGJvb2xl\nYW4gaXNQYWNraW5nKFN0b3JlUXVlcnkgcSkgewogICAgICAgICAgICByZXR1\ncm4gZmFsc2U7CiAgICAgICAgfQoKICAgICAgICAvKioKICAgICAgICAgKiBU\naHJvd3MgYW4gZXhjZXB0aW9uIGlmIHNlbGVjdCBvciBoYXZpbmcgY2xhdXNl\ncyBjb250YWluIAogICAgICAgICAqIG5vbi1hZ2dyZWdhdGUsIG5vbi1ncm91\ncGVkIHBhdGhzLgogICAgICAgICAqLwogICAgICAgIHByaXZhdGUgc3RhdGlj\nIGNsYXNzIFZhbGlkYXRlR3JvdXBpbmdFeHByZXNzaW9uVmlzaXRvciAKICAg\nICAgICAgICAgZXh0ZW5kcyBBYnN0cmFjdEV4cHJlc3Npb25WaXNpdG9yIHsK\nCiAgICAgICAgICAgIHByaXZhdGUgZmluYWwgUXVlcnlDb250ZXh0IF9jdHg7\nCiAgICAgICAgICAgIHByaXZhdGUgYm9vbGVhbiBfZ3JvdXBpbmcgPSBmYWxz\nZTsKICAgICAgICAgICAgcHJpdmF0ZSBTZXQgX2dyb3VwZWQgPSBudWxsOwog\nICAgICAgICAgICBwcml2YXRlIFZhbHVlIF9hZ2cgPSBudWxsOwoKICAgICAg\nICAgICAgLyoqCiAgICAgICAgICAgICAqIFRocm93IHByb3BlciBleGNlcHRp\nb24gaWYgcXVlcnkgZG9lcyBub3QgbWVldCB2YWxpZGF0aW9uLgogICAgICAg\nICAgICAgKi8KICAgICAgICAgICAgcHVibGljIHN0YXRpYyB2b2lkIHZhbGlk\nYXRlKFF1ZXJ5Q29udGV4dCBjdHgsIAogICAgICAgICAgICAgICAgUXVlcnlF\neHByZXNzaW9ucyBleHBzKSB7CiAgICAgICAgICAgICAgICBpZiAoZXhwcy5n\ncm91cGluZy5sZW5ndGggPT0gMCkKICAgICAgICAgICAgICAgICAgICByZXR1\ncm47CgogICAgICAgICAgICAgICAgVmFsaWRhdGVHcm91cGluZ0V4cHJlc3Np\nb25WaXNpdG9yIHZpc2l0b3IgPSAKICAgICAgICAgICAgICAgICAgICBuZXcg\nVmFsaWRhdGVHcm91cGluZ0V4cHJlc3Npb25WaXNpdG9yKGN0eCk7CiAgICAg\nICAgICAgICAgICB2aXNpdG9yLl9ncm91cGluZyA9IHRydWU7CiAgICAgICAg\nICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGV4cHMuZ3JvdXBpbmcubGVu\nZ3RoOyBpKyspCiAgICAgICAgICAgICAgICAgICAgZXhwcy5ncm91cGluZ1tp\nXS5hY2NlcHRWaXNpdCh2aXNpdG9yKTsKICAgICAgICAgICAgICAgIHZpc2l0\nb3IuX2dyb3VwaW5nID0gZmFsc2U7CiAgICAgICAgICAgICAgICBpZiAoZXhw\ncy5oYXZpbmcgIT0gbnVsbCkKICAgICAgICAgICAgICAgICAgICBleHBzLmhh\ndmluZy5hY2NlcHRWaXNpdCh2aXNpdG9yKTsKICAgICAgICAgICAgICAgIGZv\nciAoaW50IGkgPSAwOyBpIDwgZXhwcy5wcm9qZWN0aW9ucy5sZW5ndGg7IGkr\nKykKICAgICAgICAgICAgICAgICAgICBleHBzLnByb2plY3Rpb25zW2ldLmFj\nY2VwdFZpc2l0KHZpc2l0b3IpOwogICAgICAgICAgICB9CgogICAgICAgICAg\nICBwdWJsaWMgVmFsaWRhdGVHcm91cGluZ0V4cHJlc3Npb25WaXNpdG9yKFF1\nZXJ5Q29udGV4dCBjdHgpIHsKICAgICAgICAgICAgICAgIF9jdHggPSBjdHg7\nCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHB1YmxpYyB2b2lkIGVudGVy\nKFZhbHVlIHZhbCkgewogICAgICAgICAgICAgICAgaWYgKF9ncm91cGluZykg\newogICAgICAgICAgICAgICAgICAgIGlmICh2YWwgaW5zdGFuY2VvZiBQYXRo\nKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChfZ3JvdXBlZCA9PSBu\ndWxsKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgX2dyb3VwZWQgPSBu\nZXcgSGFzaFNldCgpOwogICAgICAgICAgICAgICAgICAgICAgICBfZ3JvdXBl\nZC5hZGQodmFsKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAg\nICAgICB9IGVsc2UgaWYgKF9hZ2cgPT0gbnVsbCkgewogICAgICAgICAgICAg\nICAgICAgIGlmICh2YWwuaXNBZ2dyZWdhdGUoKSkgCiAgICAgICAgICAgICAg\nICAgICAgICAgIF9hZ2cgPSB2YWw7CiAgICAgICAgICAgICAgICAgICAgZWxz\nZSBpZiAodmFsIGluc3RhbmNlb2YgUGF0aCAKICAgICAgICAgICAgICAgICAg\nICAgICAgJiYgKF9ncm91cGVkID09IG51bGwgfHwgIV9ncm91cGVkLmNvbnRh\naW5zKHZhbCkpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5l\ndyBVc2VyRXhjZXB0aW9uKF9sb2MuZ2V0KCJiYWQtZ3JvdXBpbmciLAogICAg\nICAgICAgICAgICAgICAgICAgICAgICAgX2N0eC5nZXRDYW5kaWRhdGVUeXBl\nKCksIF9jdHguZ2V0UXVlcnlTdHJpbmcoKSkpOyAKICAgICAgICAgICAgICAg\nICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAg\nICAgICAgIHB1YmxpYyB2b2lkIGV4aXQoVmFsdWUgdmFsKSB7CiAgICAgICAg\nICAgICAgICBpZiAodmFsID09IF9hZ2cpCiAgICAgICAgICAgICAgICAgICAg\nX2FnZyA9IG51bGw7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBSdW5zIHRoZSBleHByZXNzaW9uIHF1ZXJ5IGluIG1l\nbW9yeS4KICAgICAqLwogICAgcHJpdmF0ZSBzdGF0aWMgY2xhc3MgSW5NZW1v\ncnlFeGVjdXRvcgogICAgICAgIGV4dGVuZHMgQWJzdHJhY3RFeHByZXNzaW9u\nRXhlY3V0b3IKICAgICAgICBpbXBsZW1lbnRzIEV4ZWN1dG9yIHsKCiAgICAg\nICAgcHJpdmF0ZSBmaW5hbCBDbGFzc01ldGFEYXRhIF9tZXRhOwogICAgICAg\nIHByaXZhdGUgZmluYWwgYm9vbGVhbiBfc3ViczsKICAgICAgICBwcml2YXRl\nIGZpbmFsIEluTWVtb3J5RXhwcmVzc2lvbkZhY3RvcnkgX2ZhY3Rvcnk7CiAg\nICAgICAgcHJpdmF0ZSBmaW5hbCBRdWVyeUV4cHJlc3Npb25zW10gX2V4cHM7\nCiAgICAgICAgcHJpdmF0ZSBmaW5hbCBDbGFzc1tdIF9wcm9qVHlwZXM7Cgog\nICAgICAgIHB1YmxpYyBJbk1lbW9yeUV4ZWN1dG9yKEV4cHJlc3Npb25TdG9y\nZVF1ZXJ5IHEsCiAgICAgICAgICAgIENsYXNzTWV0YURhdGEgY2FuZGlkYXRl\nLCBib29sZWFuIHN1YmNsYXNzZXMsCiAgICAgICAgICAgIEV4cHJlc3Npb25Q\nYXJzZXIgcGFyc2VyLCBPYmplY3QgcGFyc2VkKSB7CiAgICAgICAgICAgIF9t\nZXRhID0gY2FuZGlkYXRlOwogICAgICAgICAgICBfc3VicyA9IHN1YmNsYXNz\nZXM7CiAgICAgICAgICAgIF9mYWN0b3J5ID0gbmV3IEluTWVtb3J5RXhwcmVz\nc2lvbkZhY3RvcnkoKTsKCiAgICAgICAgICAgIF9leHBzID0gbmV3IFF1ZXJ5\nRXhwcmVzc2lvbnNbXSB7CiAgICAgICAgICAgICAgICBwYXJzZXIuZXZhbChw\nYXJzZWQsIHEsIF9mYWN0b3J5LCBfbWV0YSkKICAgICAgICAgICAgfTsKICAg\nICAgICAgICAgaWYgKF9leHBzWzBdLnByb2plY3Rpb25zLmxlbmd0aCA9PSAw\nKQogICAgICAgICAgICAgICAgX3Byb2pUeXBlcyA9IFN0b3JlUXVlcnkuRU1Q\nVFlfQ0xBU1NFUzsKICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAg\nICBBc3NlcnROb1ZhcmlhYmxlc0V4cHJlc3Npb25WaXNpdG9yIG5vdmFycyA9\nIG5ldwogICAgICAgICAgICAgICAgICAgIEFzc2VydE5vVmFyaWFibGVzRXhw\ncmVzc2lvblZpc2l0b3IocS5nZXRDb250ZXh0KCkpOwogICAgICAgICAgICAg\nICAgX3Byb2pUeXBlcyA9IG5ldyBDbGFzc1tfZXhwc1swXS5wcm9qZWN0aW9u\ncy5sZW5ndGhdOwogICAgICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkg\nPCBfZXhwc1swXS5wcm9qZWN0aW9ucy5sZW5ndGg7IGkrKykgewogICAgICAg\nICAgICAgICAgICAgIF9wcm9qVHlwZXNbaV0gPSBfZXhwc1swXS5wcm9qZWN0\naW9uc1tpXS5nZXRUeXBlKCk7CiAgICAgICAgICAgICAgICAgICAgYXNzZXJ0\nTm90Q29udGFpbmVyKF9leHBzWzBdLnByb2plY3Rpb25zW2ldLCBxKTsKICAg\nICAgICAgICAgICAgICAgICBfZXhwc1swXS5wcm9qZWN0aW9uc1tpXS5hY2Nl\ncHRWaXNpdChub3ZhcnMpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAg\nICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBfZXhwc1swXS5ncm91cGluZy5s\nZW5ndGg7IGkrKykKICAgICAgICAgICAgICAgICAgICBfZXhwc1swXS5ncm91\ncGluZ1tpXS5hY2NlcHRWaXNpdChub3ZhcnMpOwogICAgICAgICAgICB9CiAg\nICAgICAgfQoKICAgICAgICBwcm90ZWN0ZWQgUXVlcnlFeHByZXNzaW9uc1td\nIGdldFF1ZXJ5RXhwcmVzc2lvbnMoKSB7CiAgICAgICAgICAgIHJldHVybiBf\nZXhwczsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBSZXN1bHRPYmplY3RQ\ncm92aWRlciBleGVjdXRlUXVlcnkoU3RvcmVRdWVyeSBxLAogICAgICAgICAg\nICBPYmplY3RbXSBwYXJhbXMsIFJhbmdlIHJhbmdlKSB7CiAgICAgICAgICAg\nIC8vIGV4ZWN1dGUgaW4gbWVtb3J5IGZvciBjYW5kaWRhdGUgY29sbGVjdGlv\nbjsKICAgICAgICAgICAgLy8gYWxzbyBleGVjdXRlIGluIG1lbW9yeSBmb3Ig\ndHJhbnNhY3Rpb25hbCBleHRlbnRzCiAgICAgICAgICAgIENvbGxlY3Rpb24g\nY29sbCA9IHEuZ2V0Q29udGV4dCgpLmdldENhbmRpZGF0ZUNvbGxlY3Rpb24o\nKTsKICAgICAgICAgICAgSXRlcmF0b3IgaXRyOwogICAgICAgICAgICBpZiAo\nY29sbCAhPSBudWxsKQogICAgICAgICAgICAgICAgaXRyID0gY29sbC5pdGVy\nYXRvcigpOwogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICBpdHIg\nPSBxLmdldENvbnRleHQoKS5nZXRTdG9yZUNvbnRleHQoKS4KICAgICAgICAg\nICAgICAgICAgICBleHRlbnRJdGVyYXRvcihfbWV0YS5nZXREZXNjcmliZWRU\neXBlKCksIF9zdWJzLAogICAgICAgICAgICAgICAgICAgICAgICBxLmdldENv\nbnRleHQoKS5nZXRGZXRjaENvbmZpZ3VyYXRpb24oKSwKICAgICAgICAgICAg\nICAgICAgICAgICAgcS5nZXRDb250ZXh0KCkuZ2V0SWdub3JlQ2hhbmdlcygp\nKTsKCiAgICAgICAgICAgIC8vIGZpbmQgbWF0Y2hpbmcgb2JqZWN0cwogICAg\nICAgICAgICBMaXN0IHJlc3VsdHMgPSBuZXcgQXJyYXlMaXN0KCk7CiAgICAg\nICAgICAgIFN0b3JlQ29udGV4dCBjdHggPSBxLmdldENvbnRleHQoKS5nZXRT\ndG9yZUNvbnRleHQoKTsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAg\nICAgIE9iamVjdCBvYmo7CiAgICAgICAgICAgICAgICB3aGlsZSAoaXRyLmhh\nc05leHQoKSkgewogICAgICAgICAgICAgICAgICAgIG9iaiA9IGl0ci5uZXh0\nKCk7CiAgICAgICAgICAgICAgICAgICAgaWYgKF9mYWN0b3J5Lm1hdGNoZXMo\nX2V4cHNbMF0sIF9tZXRhLCBfc3Vicywgb2JqLCBjdHgsCiAgICAgICAgICAg\nICAgICAgICAgICAgIHBhcmFtcykpCiAgICAgICAgICAgICAgICAgICAgICAg\nIHJlc3VsdHMuYWRkKG9iaik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAg\nICAgIH0KICAgICAgICAgICAgZmluYWxseSB7CiAgICAgICAgICAgICAgICBJ\nbXBsSGVscGVyLmNsb3NlKGl0cik7CiAgICAgICAgICAgIH0KCiAgICAgICAg\nICAgIC8vIGdyb3VwIHJlc3VsdHMKICAgICAgICAgICAgcmVzdWx0cyA9IF9m\nYWN0b3J5Lmdyb3VwKF9leHBzWzBdLCByZXN1bHRzLCBjdHgsIHBhcmFtcyk7\nCgogICAgICAgICAgICAvLyBhcHBseSBoYXZpbmcgdG8gZmlsdGVyIGdyb3Vw\ncwogICAgICAgICAgICBpZiAoX2V4cHNbMF0uaGF2aW5nICE9IG51bGwpIHsK\nICAgICAgICAgICAgICAgIExpc3QgbWF0Y2hlcyA9IG5ldyBBcnJheUxpc3Qo\ncmVzdWx0cy5zaXplKCkpOwogICAgICAgICAgICAgICAgQ29sbGVjdGlvbiBj\nOwogICAgICAgICAgICAgICAgaXRyID0gcmVzdWx0cy5pdGVyYXRvcigpOwog\nICAgICAgICAgICAgICAgd2hpbGUgKGl0ci5oYXNOZXh0KCkpIHsKICAgICAg\nICAgICAgICAgICAgICBjID0gKENvbGxlY3Rpb24pIGl0ci5uZXh0KCk7CiAg\nICAgICAgICAgICAgICAgICAgaWYgKF9mYWN0b3J5Lm1hdGNoZXMoX2V4cHNb\nMF0sIGMsIGN0eCwgcGFyYW1zKSkKICAgICAgICAgICAgICAgICAgICAgICAg\nbWF0Y2hlcy5hZGQoYyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAg\nICAgICByZXN1bHRzID0gbWF0Y2hlczsKICAgICAgICAgICAgfQoKICAgICAg\nICAgICAgLy8gYXBwbHkgcHJvamVjdGlvbnMsIG9yZGVyIHJlc3VsdHMsIGFu\nZCBmaWx0ZXIgZHVwbGljYXRlcwogICAgICAgICAgICByZXN1bHRzID0gX2Zh\nY3RvcnkucHJvamVjdChfZXhwc1swXSwgcmVzdWx0cywgY3R4LCBwYXJhbXMp\nOwogICAgICAgICAgICByZXN1bHRzID0gX2ZhY3Rvcnkub3JkZXIoX2V4cHNb\nMF0sIHJlc3VsdHMsIGN0eCwgcGFyYW1zKTsKICAgICAgICAgICAgcmVzdWx0\ncyA9IF9mYWN0b3J5LmRpc3RpbmN0KF9leHBzWzBdLCBjb2xsID09IG51bGws\nIHJlc3VsdHMpOwoKICAgICAgICAgICAgUmVzdWx0T2JqZWN0UHJvdmlkZXIg\ncm9wID0gbmV3IExpc3RSZXN1bHRPYmplY3RQcm92aWRlcihyZXN1bHRzKTsK\nICAgICAgICAgICAgaWYgKHJhbmdlLnN0YXJ0ICE9IDAgfHwgcmFuZ2UuZW5k\nICE9IExvbmcuTUFYX1ZBTFVFKQogICAgICAgICAgICAgICAgcm9wID0gbmV3\nIFJhbmdlUmVzdWx0T2JqZWN0UHJvdmlkZXIocm9wLCByYW5nZS5zdGFydCxy\nYW5nZS5lbmQpOwogICAgICAgICAgICByZXR1cm4gcm9wOwogICAgICAgIH0K\nCiAgICAgICAgcHVibGljIFN0cmluZ1tdIGdldERhdGFTdG9yZUFjdGlvbnMo\nU3RvcmVRdWVyeSBxLCBPYmplY3RbXSBwYXJhbXMsCiAgICAgICAgICAgIFJh\nbmdlIHJhbmdlKSB7CiAgICAgICAgICAgIC8vIGluIG1lbW9yeSBxdWVyaWVz\nIGhhdmUgbm8gZGF0YXN0b3JlIGFjdGlvbnMgdG8gcGVyZm9ybQogICAgICAg\nICAgICByZXR1cm4gU3RvcmVRdWVyeS5FTVBUWV9TVFJJTkdTOwogICAgICAg\nIH0KCiAgICAgICAgcHVibGljIE9iamVjdCBnZXRPcmRlcmluZ1ZhbHVlKFN0\nb3JlUXVlcnkgcSwgT2JqZWN0W10gcGFyYW1zLAogICAgICAgICAgICBPYmpl\nY3QgcmVzdWx0T2JqZWN0LCBpbnQgb3JkZXJJbmRleCkgewogICAgICAgICAg\nICAvLyBpZiB0aGlzIGlzIGEgcHJvamVjdGlvbiwgdGhlbiB3ZSBoYXZlIHRv\nIG9yZGVyIG9uIHNvbWV0aGluZwogICAgICAgICAgICAvLyB3ZSBzZWxlY3Rl\nZAogICAgICAgICAgICBpZiAoX2V4cHNbMF0ucHJvamVjdGlvbnMubGVuZ3Ro\nID4gMCkgewogICAgICAgICAgICAgICAgU3RyaW5nIG9yZGVyaW5nID0gX2V4\ncHNbMF0ub3JkZXJpbmdDbGF1c2VzW29yZGVySW5kZXhdOwogICAgICAgICAg\nICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBfZXhwc1swXS5wcm9qZWN0aW9u\nQ2xhdXNlcy5sZW5ndGg7IGkrKykKICAgICAgICAgICAgICAgICAgICBpZiAo\nb3JkZXJpbmcuZXF1YWxzKF9leHBzWzBdLnByb2plY3Rpb25DbGF1c2VzW2ld\nKSkKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICgoT2JqZWN0W10p\nIHJlc3VsdE9iamVjdClbaV07CgogICAgICAgICAgICAgICAgdGhyb3cgbmV3\nIEludmFsaWRTdGF0ZUV4Y2VwdGlvbihfbG9jLmdldAogICAgICAgICAgICAg\nICAgICAgICgibWVyZ2VkLW9yZGVyLXdpdGgtcmVzdWx0IiwgcS5nZXRDb250\nZXh0KCkuZ2V0TGFuZ3VhZ2UoKSwKICAgICAgICAgICAgICAgICAgICAgICAg\ncS5nZXRDb250ZXh0KCkuZ2V0UXVlcnlTdHJpbmcoKSwgb3JkZXJpbmcpKTsK\nICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gdXNlIHRoZSBwYXJzZWQg\nb3JkZXJpbmcgZXhwcmVzc2lvbiB0byBleHRyYWN0IHRoZSBvcmRlcmluZyB2\nYWx1ZQogICAgICAgICAgICBWYWwgdmFsID0gKFZhbCkgX2V4cHNbMF0ub3Jk\nZXJpbmdbb3JkZXJJbmRleF07CiAgICAgICAgICAgIHJldHVybiB2YWwuZXZh\nbHVhdGUocmVzdWx0T2JqZWN0LCByZXN1bHRPYmplY3QsIHEuZ2V0Q29udGV4\ndCgpLgogICAgICAgICAgICAgICAgZ2V0U3RvcmVDb250ZXh0KCksIHBhcmFt\ncyk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgQ2xhc3NbXSBnZXRQcm9q\nZWN0aW9uVHlwZXMoU3RvcmVRdWVyeSBxKSB7CiAgICAgICAgICAgIHJldHVy\nbiBfcHJvalR5cGVzOwogICAgICAgIH0KCiAgICAgICAgLyoqCiAgICAgICAg\nICogVGhyb3dzIGFuIGV4Y2VwdGlvbiBpZiBhIHZhcmlhYmxlIGlzIGZvdW5k\nLgogICAgICAgICAqLwogICAgICAgIHByaXZhdGUgc3RhdGljIGNsYXNzIEFz\nc2VydE5vVmFyaWFibGVzRXhwcmVzc2lvblZpc2l0b3IgCiAgICAgICAgICAg\nIGV4dGVuZHMgQWJzdHJhY3RFeHByZXNzaW9uVmlzaXRvciB7CgogICAgICAg\nICAgICBwcml2YXRlIGZpbmFsIFF1ZXJ5Q29udGV4dCBfY3R4OwoKICAgICAg\nICAgICAgcHVibGljIEFzc2VydE5vVmFyaWFibGVzRXhwcmVzc2lvblZpc2l0\nb3IoUXVlcnlDb250ZXh0IGN0eCkgewogICAgICAgICAgICAgICAgX2N0eCA9\nIGN0eDsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHVibGljIHZvaWQg\nZW50ZXIoVmFsdWUgdmFsKSB7CiAgICAgICAgICAgICAgICBpZiAoIXZhbC5p\nc1ZhcmlhYmxlKCkpCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAg\nICAgICAgICAgICAgdGhyb3cgbmV3IFVuc3VwcG9ydGVkRXhjZXB0aW9uKF9s\nb2MuZ2V0KCJpbm1lbS1hZ2ctcHJvai12YXIiLCAKICAgICAgICAgICAgICAg\nICAgICBfY3R4LmdldENhbmRpZGF0ZVR5cGUoKSwgX2N0eC5nZXRRdWVyeVN0\ncmluZygpKSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAg\nLyoqCiAgICAgKiBUaGUgRGF0YVN0b3JlRXhlY3V0b3IgZXhlY3V0ZXMgdGhl\nIHF1ZXJ5IGFnYWluc3QgdGhlCiAgICAgKiBpbXBsZW1lbnRhdGlvbidzIG92\nZXJyaWRkZW4ge0BsaW5rICNleGVjdXRlUXVlcnl9IG1ldGhvZC4KICAgICAq\nCiAgICAgKiBAYXV0aG9yIE1hcmMgUHJ1ZCdob21tZWF1eAogICAgICovCiAg\nICBwcml2YXRlIHN0YXRpYyBjbGFzcyBEYXRhU3RvcmVFeGVjdXRvcgogICAg\nICAgIGV4dGVuZHMgQWJzdHJhY3RFeHByZXNzaW9uRXhlY3V0b3IKICAgICAg\nICBpbXBsZW1lbnRzIEV4ZWN1dG9yIHsKCiAgICAgICAgcHJpdmF0ZSBmaW5h\nbCBDbGFzc01ldGFEYXRhIF9tZXRhOwogICAgICAgIHByaXZhdGUgZmluYWwg\nQ2xhc3NNZXRhRGF0YVtdIF9tZXRhczsKICAgICAgICBwcml2YXRlIGZpbmFs\nIGJvb2xlYW4gX3N1YnM7CiAgICAgICAgcHJpdmF0ZSBmaW5hbCBFeHByZXNz\naW9uUGFyc2VyIF9wYXJzZXI7CiAgICAgICAgcHJpdmF0ZSBmaW5hbCBFeHBy\nZXNzaW9uRmFjdG9yeVtdIF9mYWN0czsKICAgICAgICBwcml2YXRlIGZpbmFs\nIFF1ZXJ5RXhwcmVzc2lvbnNbXSBfZXhwczsKICAgICAgICBwcml2YXRlIGZp\nbmFsIENsYXNzW10gX3Byb2pUeXBlczsKICAgICAgICBwcml2YXRlIFZhbHVl\nW10gX2luTWVtT3JkZXJpbmc7CgogICAgICAgIHB1YmxpYyBEYXRhU3RvcmVF\neGVjdXRvcihFeHByZXNzaW9uU3RvcmVRdWVyeSBxLAogICAgICAgICAgICBD\nbGFzc01ldGFEYXRhIG1ldGEsIGJvb2xlYW4gc3ViY2xhc3NlcywKICAgICAg\nICAgICAgRXhwcmVzc2lvblBhcnNlciBwYXJzZXIsIE9iamVjdCBwYXJzZWQp\nIHsKICAgICAgICAgICAgX21ldGFzID0gcS5nZXRJbmRlcGVuZGVudEV4cHJl\nc3Npb25DYW5kaWRhdGVzKG1ldGEsIHN1YmNsYXNzZXMpOwogICAgICAgICAg\nICBpZiAoX21ldGFzLmxlbmd0aCA9PSAwKQogICAgICAgICAgICAgICAgdGhy\nb3cgbmV3IFVzZXJFeGNlcHRpb24oX2xvYy5nZXQoInF1ZXJ5LXVubWFwcGVk\nIiwgbWV0YSkpOwogICAgICAgICAgICBfbWV0YSA9IG1ldGE7CiAgICAgICAg\nICAgIF9zdWJzID0gc3ViY2xhc3NlczsKICAgICAgICAgICAgX3BhcnNlciA9\nIHBhcnNlcjsKCiAgICAgICAgICAgIF9mYWN0cyA9IG5ldyBFeHByZXNzaW9u\nRmFjdG9yeVtfbWV0YXMubGVuZ3RoXTsKICAgICAgICAgICAgZm9yIChpbnQg\naSA9IDA7IGkgPCBfZmFjdHMubGVuZ3RoOyBpKyspCiAgICAgICAgICAgICAg\nICBfZmFjdHNbaV0gPSBxLmdldEV4cHJlc3Npb25GYWN0b3J5KF9tZXRhc1tp\nXSk7CgogICAgICAgICAgICBfZXhwcyA9IG5ldyBRdWVyeUV4cHJlc3Npb25z\nW19tZXRhcy5sZW5ndGhdOwogICAgICAgICAgICBmb3IgKGludCBpID0gMDsg\naSA8IF9leHBzLmxlbmd0aDsgaSsrKQogICAgICAgICAgICAgICAgX2V4cHNb\naV0gPSBwYXJzZXIuZXZhbChwYXJzZWQsIHEsIF9mYWN0c1tpXSwgX21ldGFz\nW2ldKTsKCiAgICAgICAgICAgIGlmIChfZXhwc1swXS5wcm9qZWN0aW9ucy5s\nZW5ndGggPT0gMCkKICAgICAgICAgICAgICAgIF9wcm9qVHlwZXMgPSBTdG9y\nZVF1ZXJ5LkVNUFRZX0NMQVNTRVM7CiAgICAgICAgICAgIGVsc2UgewogICAg\nICAgICAgICAgICAgX3Byb2pUeXBlcyA9IG5ldyBDbGFzc1tfZXhwc1swXS5w\ncm9qZWN0aW9ucy5sZW5ndGhdOwogICAgICAgICAgICAgICAgZm9yIChpbnQg\naSA9IDA7IGkgPCBfZXhwc1swXS5wcm9qZWN0aW9ucy5sZW5ndGg7IGkrKykg\newogICAgICAgICAgICAgICAgICAgIGFzc2VydE5vdENvbnRhaW5lcihfZXhw\nc1swXS5wcm9qZWN0aW9uc1tpXSwgcSk7CiAgICAgICAgICAgICAgICAgICAg\nX3Byb2pUeXBlc1tpXSA9IF9leHBzWzBdLnByb2plY3Rpb25zW2ldLmdldFR5\ncGUoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAg\nIH0KCiAgICAgICAgcHJvdGVjdGVkIFF1ZXJ5RXhwcmVzc2lvbnNbXSBnZXRR\ndWVyeUV4cHJlc3Npb25zKCkgewogICAgICAgICAgICByZXR1cm4gX2V4cHM7\nCiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgUmVzdWx0T2JqZWN0UHJvdmlk\nZXIgZXhlY3V0ZVF1ZXJ5KFN0b3JlUXVlcnkgcSwKICAgICAgICAgICAgT2Jq\nZWN0W10gcGFyYW1zLCBSYW5nZSByYW5nZSkgewogICAgICAgICAgICByYW5n\nZS5scnMgJj0gIWlzQWdncmVnYXRlKHEpICYmICFoYXNHcm91cGluZyhxKTsK\nICAgICAgICAgICAgcmV0dXJuICgoRXhwcmVzc2lvblN0b3JlUXVlcnkpIHEp\nLmV4ZWN1dGVRdWVyeSh0aGlzLCBfbWV0YSwgX21ldGFzLAogICAgICAgICAg\nICAgICAgX3N1YnMsIF9mYWN0cywgX2V4cHMsIHBhcmFtcywgcmFuZ2UpOwog\nICAgICAgIH0KCiAgICAgICAgcHVibGljIE51bWJlciBleGVjdXRlRGVsZXRl\nKFN0b3JlUXVlcnkgcSwgT2JqZWN0W10gcGFyYW1zKSB7CiAgICAgICAgICAg\nIE51bWJlciBudW0gPSAoKEV4cHJlc3Npb25TdG9yZVF1ZXJ5KSBxKS5leGVj\ndXRlRGVsZXRlKHRoaXMsIF9tZXRhLAogICAgICAgICAgICAgICAgX21ldGFz\nLCBfc3VicywgX2ZhY3RzLCBfZXhwcywgcGFyYW1zKTsKICAgICAgICAgICAg\naWYgKG51bSA9PSBudWxsKQogICAgICAgICAgICAgICAgcmV0dXJuIHEuZ2V0\nQ29udGV4dCgpLmRlbGV0ZUluTWVtb3J5KHEsIHRoaXMsIHBhcmFtcyk7CiAg\nICAgICAgICAgIHJldHVybiBudW07CiAgICAgICAgfQoKICAgICAgICBwdWJs\naWMgTnVtYmVyIGV4ZWN1dGVVcGRhdGUoU3RvcmVRdWVyeSBxLCBPYmplY3Rb\nXSBwYXJhbXMpIHsKICAgICAgICAgICAgTnVtYmVyIG51bSA9ICgoRXhwcmVz\nc2lvblN0b3JlUXVlcnkpIHEpLmV4ZWN1dGVVcGRhdGUodGhpcywgX21ldGEs\nCiAgICAgICAgICAgICAgICBfbWV0YXMsIF9zdWJzLCBfZmFjdHMsIF9leHBz\nLCBwYXJhbXMpOwogICAgICAgICAgICBpZiAobnVtID09IG51bGwpCiAgICAg\nICAgICAgICAgICByZXR1cm4gcS5nZXRDb250ZXh0KCkudXBkYXRlSW5NZW1v\ncnkocSwgdGhpcywgcGFyYW1zKTsKICAgICAgICAgICAgcmV0dXJuIG51bTsK\nICAgICAgICB9CgogICAgICAgIHB1YmxpYyBTdHJpbmdbXSBnZXREYXRhU3Rv\ncmVBY3Rpb25zKFN0b3JlUXVlcnkgcSwgT2JqZWN0W10gcGFyYW1zLAogICAg\nICAgICAgICBSYW5nZSByYW5nZSkgewogICAgICAgICAgICByZXR1cm4gKChF\neHByZXNzaW9uU3RvcmVRdWVyeSkgcSkuZ2V0RGF0YVN0b3JlQWN0aW9ucyhf\nbWV0YSwKICAgICAgICAgICAgICAgIF9tZXRhcywgX3N1YnMsIF9mYWN0cywg\nX2V4cHMsIHBhcmFtcywgcmFuZ2UpOwogICAgICAgIH0KCiAgICAgICAgcHVi\nbGljIE9iamVjdCBnZXRPcmRlcmluZ1ZhbHVlKFN0b3JlUXVlcnkgcSwgT2Jq\nZWN0W10gcGFyYW1zLAogICAgICAgICAgICBPYmplY3QgcmVzdWx0T2JqZWN0\nLCBpbnQgb3JkZXJJbmRleCkgewogICAgICAgICAgICAvLyBpZiB0aGlzIGlz\nIGEgcHJvamVjdGlvbiwgdGhlbiB3ZSBoYXZlIHRvIG9yZGVyIG9uIHNvbWV0\naGluZwogICAgICAgICAgICAvLyB3ZSBzZWxlY3RlZAogICAgICAgICAgICBp\nZiAoX2V4cHNbMF0ucHJvamVjdGlvbnMubGVuZ3RoID4gMCkgewogICAgICAg\nICAgICAgICAgU3RyaW5nIG9yZGVyaW5nID0gX2V4cHNbMF0ub3JkZXJpbmdD\nbGF1c2VzW29yZGVySW5kZXhdOwogICAgICAgICAgICAgICAgZm9yIChpbnQg\naSA9IDA7IGkgPCBfZXhwc1swXS5wcm9qZWN0aW9uQ2xhdXNlcy5sZW5ndGg7\nIGkrKykKICAgICAgICAgICAgICAgICAgICBpZiAob3JkZXJpbmcuZXF1YWxz\nKF9leHBzWzBdLnByb2plY3Rpb25DbGF1c2VzW2ldKSkKICAgICAgICAgICAg\nICAgICAgICAgICAgcmV0dXJuICgoT2JqZWN0W10pIHJlc3VsdE9iamVjdClb\naV07CgogICAgICAgICAgICAgICAgdGhyb3cgbmV3IEludmFsaWRTdGF0ZUV4\nY2VwdGlvbihfbG9jLmdldAogICAgICAgICAgICAgICAgICAgICgibWVyZ2Vk\nLW9yZGVyLXdpdGgtcmVzdWx0IiwgcS5nZXRDb250ZXh0KCkuZ2V0TGFuZ3Vh\nZ2UoKSwKICAgICAgICAgICAgICAgICAgICAgICAgcS5nZXRDb250ZXh0KCku\nZ2V0UXVlcnlTdHJpbmcoKSwgb3JkZXJpbmcpKTsKICAgICAgICAgICAgfQoK\nICAgICAgICAgICAgLy8gbmVlZCB0byBwYXJzZSBvcmRlcmluZ3M/CiAgICAg\nICAgICAgIHN5bmNocm9uaXplZCAodGhpcykgewogICAgICAgICAgICAgICAg\naWYgKF9pbk1lbU9yZGVyaW5nID09IG51bGwpIHsKICAgICAgICAgICAgICAg\nICAgICBFeHByZXNzaW9uRmFjdG9yeSBmYWN0b3J5ID0gbmV3IEluTWVtb3J5\nRXhwcmVzc2lvbkZhY3RvcnkoKTsKICAgICAgICAgICAgICAgICAgICBfaW5N\nZW1PcmRlcmluZyA9IF9wYXJzZXIuZXZhbChfZXhwc1swXS5vcmRlcmluZ0Ns\nYXVzZXMsCiAgICAgICAgICAgICAgICAgICAgICAgIChFeHByZXNzaW9uU3Rv\ncmVRdWVyeSkgcSwgZmFjdG9yeSwgX21ldGEpOwogICAgICAgICAgICAgICAg\nfQogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyB1c2UgdGhlIHBhcnNl\nZCBvcmRlcmluZyBleHByZXNzaW9uIHRvIGV4dHJhY3QgdGhlIG9yZGVyaW5n\nIHZhbHVlCiAgICAgICAgICAgIFZhbCB2YWwgPSAoVmFsKSBfaW5NZW1PcmRl\ncmluZ1tvcmRlckluZGV4XTsKICAgICAgICAgICAgcmV0dXJuIHZhbC5ldmFs\ndWF0ZShyZXN1bHRPYmplY3QsIHJlc3VsdE9iamVjdCwKICAgICAgICAgICAg\nICAgIHEuZ2V0Q29udGV4dCgpLmdldFN0b3JlQ29udGV4dCgpLCBwYXJhbXMp\nOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIENsYXNzW10gZ2V0UHJvamVj\ndGlvblR5cGVzKFN0b3JlUXVlcnkgcSkgewogICAgICAgICAgICByZXR1cm4g\nX3Byb2pUeXBlczsKCQl9Cgl9Cn0K\n","encoding":"base64"}

