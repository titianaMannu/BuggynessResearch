{"sha":"e056934155b142c30d7d84c649b1d6b291a88e1e","node_id":"MDQ6QmxvYjIwNjM2NDplMDU2OTM0MTU1YjE0MmMzMGQ3ZDg0YzY0OWIxZDZiMjkxYTg4ZTFl","size":31263,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/e056934155b142c30d7d84c649b1d6b291a88e1e","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsOwoKaW1wb3J0IGph\ndmEubGFuZy5yZWZsZWN0Lk1ldGhvZDsKaW1wb3J0IGphdmEubWF0aC5CaWdE\nZWNpbWFsOwppbXBvcnQgamF2YS5tYXRoLkJpZ0ludGVnZXI7CmltcG9ydCBq\nYXZhLnNlY3VyaXR5LkFjY2Vzc0NvbnRyb2xsZXI7CmltcG9ydCBqYXZhLnNl\nY3VyaXR5LlByaXZpbGVnZWRBY3Rpb25FeGNlcHRpb247CmltcG9ydCBqYXZh\nLnV0aWwuQXJyYXlMaXN0OwppbXBvcnQgamF2YS51dGlsLkNhbGVuZGFyOwpp\nbXBvcnQgamF2YS51dGlsLkNvbGxlY3Rpb247CmltcG9ydCBqYXZhLnV0aWwu\nRGF0ZTsKaW1wb3J0IGphdmEudXRpbC5MaXN0OwoKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5lbmhhbmNlLlJlZmxlY3Rpb247CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEua2VybmVsLmV4cHMuQWdncmVnYXRlTGlzdGVuZXI7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLmV4cHMuRmlsdGVyTGlz\ndGVuZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuSjJE\nb1ByaXZIZWxwZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0\naWwuTG9jYWxpemVyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEu\nQ2xhc3NNZXRhRGF0YTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRh\nLkphdmFUeXBlczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLklu\ndGVybmFsRXhjZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0\naWwuVXNlckV4Y2VwdGlvbjsKaW1wb3J0IHNlcnAudXRpbC5OdW1iZXJzOwpp\nbXBvcnQgc2VycC51dGlsLlN0cmluZ3M7CgovKioKICogSGVscGVyIG1ldGhv\nZHMgZm9yIGRlYWxpbmcgd2l0aCBxdWVyeSBmaWx0ZXJzLgogKgogKiBAYXV0\naG9yIEFiZSBXaGl0ZQogKiBAbm9qYXZhZG9jCiAqLwpwdWJsaWMgY2xhc3Mg\nRmlsdGVycyB7CgogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgQmlnRGVjaW1h\nbCBaRVJPX0JJR0RFQ0lNQUwgPSBuZXcgQmlnRGVjaW1hbCgwRCk7CiAgICBw\ncml2YXRlIHN0YXRpYyBmaW5hbCBCaWdJbnRlZ2VyIFpFUk9fQklHSU5URUdF\nUiA9IG5ldyBCaWdJbnRlZ2VyKCIwIik7CgogICAgcHJpdmF0ZSBzdGF0aWMg\nZmluYWwgaW50IE9QX0FERCA9IDA7CiAgICBwcml2YXRlIHN0YXRpYyBmaW5h\nbCBpbnQgT1BfU1VCVFJBQ1QgPSAxOwogICAgcHJpdmF0ZSBzdGF0aWMgZmlu\nYWwgaW50IE9QX01VTFRJUExZID0gMjsKICAgIHByaXZhdGUgc3RhdGljIGZp\nbmFsIGludCBPUF9ESVZJREUgPSAzOwogICAgcHJpdmF0ZSBzdGF0aWMgZmlu\nYWwgaW50IE9QX01PRCA9IDQ7CgogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwg\nTG9jYWxpemVyIF9sb2MgPSBMb2NhbGl6ZXIuZm9yUGFja2FnZShGaWx0ZXJz\nLmNsYXNzKTsKCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgY29ycmVjdCB3\ncmFwcGVyIHR5cGUgZm9yIHRoZSBnaXZlbiBjbGFzcy4KICAgICAqLwogICAg\ncHVibGljIHN0YXRpYyBDbGFzcyB3cmFwKENsYXNzIGMpIHsKICAgICAgICBp\nZiAoIWMuaXNQcmltaXRpdmUoKSkKICAgICAgICAgICAgcmV0dXJuIGM7CiAg\nICAgICAgaWYgKGMgPT0gaW50LmNsYXNzKQogICAgICAgICAgICByZXR1cm4g\nSW50ZWdlci5jbGFzczsKICAgICAgICBpZiAoYyA9PSBmbG9hdC5jbGFzcykK\nICAgICAgICAgICAgcmV0dXJuIEZsb2F0LmNsYXNzOwogICAgICAgIGlmIChj\nID09IGRvdWJsZS5jbGFzcykKICAgICAgICAgICAgcmV0dXJuIERvdWJsZS5j\nbGFzczsKICAgICAgICBpZiAoYyA9PSBsb25nLmNsYXNzKQogICAgICAgICAg\nICByZXR1cm4gTG9uZy5jbGFzczsKICAgICAgICBpZiAoYyA9PSBib29sZWFu\nLmNsYXNzKQogICAgICAgICAgICByZXR1cm4gQm9vbGVhbi5jbGFzczsKICAg\nICAgICBpZiAoYyA9PSBzaG9ydC5jbGFzcykKICAgICAgICAgICAgcmV0dXJu\nIFNob3J0LmNsYXNzOwogICAgICAgIGlmIChjID09IGJ5dGUuY2xhc3MpCiAg\nICAgICAgICAgIHJldHVybiBCeXRlLmNsYXNzOwogICAgICAgIGlmIChjID09\nIGNoYXIuY2xhc3MpCiAgICAgICAgICAgIHJldHVybiBDaGFyYWN0ZXIuY2xh\nc3M7CiAgICAgICAgcmV0dXJuIGM7CiAgICB9CgogICAgLyoqCiAgICAgKiBS\nZXR1cm4gdGhlIGNvcnJlY3QgcHJpbWl0aXZlIHR5cGUgZm9yIHRoZSBnaXZl\nbiBjbGFzcywgaWYgaXQgaXMgYQogICAgICogd3JhcHBlci4KICAgICAqLwog\nICAgcHVibGljIHN0YXRpYyBDbGFzcyB1bndyYXAoQ2xhc3MgYykgewogICAg\nICAgIGlmIChjLmlzUHJpbWl0aXZlKCkgfHwgYyA9PSBTdHJpbmcuY2xhc3Mp\nCiAgICAgICAgICAgIHJldHVybiBjOwogICAgICAgIGlmIChjID09IEludGVn\nZXIuY2xhc3MpCiAgICAgICAgICAgIHJldHVybiBpbnQuY2xhc3M7CiAgICAg\nICAgaWYgKGMgPT0gRmxvYXQuY2xhc3MpCiAgICAgICAgICAgIHJldHVybiBm\nbG9hdC5jbGFzczsKICAgICAgICBpZiAoYyA9PSBEb3VibGUuY2xhc3MpCiAg\nICAgICAgICAgIHJldHVybiBkb3VibGUuY2xhc3M7CiAgICAgICAgaWYgKGMg\nPT0gTG9uZy5jbGFzcykKICAgICAgICAgICAgcmV0dXJuIGxvbmcuY2xhc3M7\nCiAgICAgICAgaWYgKGMgPT0gQm9vbGVhbi5jbGFzcykKICAgICAgICAgICAg\ncmV0dXJuIGJvb2xlYW4uY2xhc3M7CiAgICAgICAgaWYgKGMgPT0gU2hvcnQu\nY2xhc3MpCiAgICAgICAgICAgIHJldHVybiBzaG9ydC5jbGFzczsKICAgICAg\nICBpZiAoYyA9PSBCeXRlLmNsYXNzKQogICAgICAgICAgICByZXR1cm4gYnl0\nZS5jbGFzczsKICAgICAgICBpZiAoYyA9PSBDaGFyYWN0ZXIuY2xhc3MpCiAg\nICAgICAgICAgIHJldHVybiBjaGFyLmNsYXNzOwogICAgICAgIHJldHVybiBj\nOwogICAgfQoKICAgIC8qKgogICAgICogR2l2ZW4gdHdvIHR5cGVzLCByZXR1\ncm4gdHlwZSB0aGV5IHNob3VsZCBib3RoIGJlIGNvbnZlcnRlZAogICAgICog\ndG8gYmVmb3JlIHBlcmZvcm1pbmcgYW55IG9wZXJhdGlvbnMgYmV0d2VlbiB0\naGVtLgogICAgICovCiAgICBwdWJsaWMgc3RhdGljIENsYXNzIHByb21vdGUo\nQ2xhc3MgYzEsIENsYXNzIGMyKSB7CiAgICAgICAgaWYgKGMxID09IGMyKQog\nICAgICAgICAgICByZXR1cm4gdW53cmFwKGMxKTsKICAgICAgICBDbGFzcyB3\nMSA9IHdyYXAoYzEpOwogICAgICAgIENsYXNzIHcyID0gd3JhcChjMik7CiAg\nICAgICAgaWYgKHcxID09IHcyKQogICAgICAgICAgICByZXR1cm4gdW53cmFw\nKGMxKTsKCiAgICAgICAgLy8gbm90IG51bWJlcnM/CiAgICAgICAgYm9vbGVh\nbiB3MU51bWJlciA9IE51bWJlci5jbGFzcy5pc0Fzc2lnbmFibGVGcm9tKHcx\nKTsKICAgICAgICBib29sZWFuIHcyTnVtYmVyID0gTnVtYmVyLmNsYXNzLmlz\nQXNzaWduYWJsZUZyb20odzIpOwogICAgICAgIGlmICghdzFOdW1iZXIgfHwg\nIXcyTnVtYmVyKSB7CiAgICAgICAgICAgIC8vIHRoZSBvbmx5IG5vbi1udW1l\ncmljIHByb21vdGlvbiB3ZSBkbyBpcyBzdHJpbmcgdG8gY2hhciwKICAgICAg\nICAgICAgLy8gb3IgZnJvbSBjaGFyL3N0cmluZyB0byBudW1iZXIKICAgICAg\nICAgICAgaWYgKCF3MU51bWJlcikgewogICAgICAgICAgICAgICAgaWYgKHcy\nTnVtYmVyICYmICh3MSA9PSBDaGFyYWN0ZXIuY2xhc3MgfHwgdzEgPT0gU3Ry\naW5nLmNsYXNzKSkKICAgICAgICAgICAgICAgICAgICByZXR1cm4gKHcyID09\nIEJ5dGUuY2xhc3MgfHwgdzIgPT0gU2hvcnQuY2xhc3MpCiAgICAgICAgICAg\nICAgICAgICAgICAgID8gSW50ZWdlci5jbGFzcyA6IHVud3JhcChjMik7CiAg\nICAgICAgICAgICAgICBpZiAoIXcyTnVtYmVyICYmIHcxID09IENoYXJhY3Rl\nci5jbGFzcyAmJiB3MiA9PSBTdHJpbmcuY2xhc3MpCiAgICAgICAgICAgICAg\nICAgICAgcmV0dXJuIFN0cmluZy5jbGFzczsKICAgICAgICAgICAgICAgIGlm\nICh3Mk51bWJlcikKICAgICAgICAgICAgICAgICAgICByZXR1cm4gdW53cmFw\nKGMyKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoIXcyTnVtYmVy\nKSB7CiAgICAgICAgICAgICAgICBpZiAodzFOdW1iZXIgJiYgKHcyID09IENo\nYXJhY3Rlci5jbGFzcyB8fCB3MiA9PSBTdHJpbmcuY2xhc3MpKQogICAgICAg\nICAgICAgICAgICAgIHJldHVybiAodzEgPT0gQnl0ZS5jbGFzcyB8fCB3MSA9\nPSBTaG9ydC5jbGFzcykKICAgICAgICAgICAgICAgICAgICAgICAgPyBJbnRl\nZ2VyLmNsYXNzIDogdW53cmFwKGMxKTsKICAgICAgICAgICAgICAgIGlmICgh\ndzFOdW1iZXIgJiYgdzIgPT0gQ2hhcmFjdGVyLmNsYXNzICYmIHcxID09IFN0\ncmluZy5jbGFzcykKICAgICAgICAgICAgICAgICAgICByZXR1cm4gU3RyaW5n\nLmNsYXNzOwogICAgICAgICAgICAgICAgaWYgKHcxTnVtYmVyKQogICAgICAg\nICAgICAgICAgICAgIHJldHVybiB1bndyYXAoYzEpOwogICAgICAgICAgICB9\nCgogICAgICAgICAgICAvLyBpZiBuZWl0aGVyIGFyZSBudW1iZXJzLCB1c2Ug\nbGVhc3QtZGVyaXZlZCBvZiB0aGUgdHdvLiAgaWYgbmVpdGhlcgogICAgICAg\nICAgICAvLyBpcyBhc3NpZ25hYmxlIGZyb20gdGhlIG90aGVyIGJ1dCBvbmUg\naXMgYSBzdGFuZGFyZCB0eXBlLCBhc3N1bWUKICAgICAgICAgICAgLy8gdGhl\nIG90aGVyIGNhbiBiZSBjb252ZXJ0ZWQgdG8gdGhhdCBzdGFuZGFyZCB0eXBl\nCiAgICAgICAgICAgIGlmICghdzFOdW1iZXIgJiYgIXcyTnVtYmVyKSB7CiAg\nICAgICAgICAgICAgICBpZiAodzEgPT0gT2JqZWN0LmNsYXNzKQogICAgICAg\nICAgICAgICAgICAgIHJldHVybiB1bndyYXAoYzIpOwogICAgICAgICAgICAg\nICAgaWYgKHcyID09IE9iamVjdC5jbGFzcykKICAgICAgICAgICAgICAgICAg\nICByZXR1cm4gdW53cmFwKGMxKTsKICAgICAgICAgICAgICAgIGlmICh3MS5p\nc0Fzc2lnbmFibGVGcm9tKHcyKSkKICAgICAgICAgICAgICAgICAgICByZXR1\ncm4gdW53cmFwKGMxKTsKICAgICAgICAgICAgICAgIGlmICh3Mi5pc0Fzc2ln\nbmFibGVGcm9tKHcxKSkKICAgICAgICAgICAgICAgICAgICByZXR1cm4gdW53\ncmFwKGMyKTsKICAgICAgICAgICAgICAgIGlmIChpc05vbnN0YW5kYXJkVHlw\nZSh3MSkpCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChpc05vbnN0YW5k\nYXJkVHlwZSh3MikpID8gT2JqZWN0LmNsYXNzIDogdW53cmFwKGMyKTsKICAg\nICAgICAgICAgICAgIGlmIChpc05vbnN0YW5kYXJkVHlwZSh3MikpCiAgICAg\nICAgICAgICAgICAgICAgcmV0dXJuIChpc05vbnN0YW5kYXJkVHlwZSh3MSkp\nID8gT2JqZWN0LmNsYXNzIDogdW53cmFwKGMxKTsKICAgICAgICAgICAgfQog\nICAgICAgICAgICByZXR1cm4gT2JqZWN0LmNsYXNzOwogICAgICAgIH0KCiAg\nICAgICAgaWYgKHcxID09IEJpZ0RlY2ltYWwuY2xhc3MgfHwgdzIgPT0gQmln\nRGVjaW1hbC5jbGFzcykKICAgICAgICAgICAgcmV0dXJuIEJpZ0RlY2ltYWwu\nY2xhc3M7CiAgICAgICAgaWYgKHcxID09IEJpZ0ludGVnZXIuY2xhc3MpIHsK\nICAgICAgICAgICAgaWYgKHcyID09IEZsb2F0LmNsYXNzIHx8IHcyID09IERv\ndWJsZS5jbGFzcykKICAgICAgICAgICAgICAgIHJldHVybiBCaWdEZWNpbWFs\nLmNsYXNzOwogICAgICAgICAgICByZXR1cm4gQmlnSW50ZWdlci5jbGFzczsK\nICAgICAgICB9CiAgICAgICAgaWYgKHcyID09IEJpZ0ludGVnZXIuY2xhc3Mp\nIHsKICAgICAgICAgICAgaWYgKHcxID09IEZsb2F0LmNsYXNzIHx8IHcxID09\nIERvdWJsZS5jbGFzcykKICAgICAgICAgICAgICAgIHJldHVybiBCaWdEZWNp\nbWFsLmNsYXNzOwogICAgICAgICAgICByZXR1cm4gQmlnSW50ZWdlci5jbGFz\nczsKICAgICAgICB9CiAgICAgICAgaWYgKHcxID09IERvdWJsZS5jbGFzcyB8\nfCB3MiA9PSBEb3VibGUuY2xhc3MpCiAgICAgICAgICAgIHJldHVybiBkb3Vi\nbGUuY2xhc3M7CiAgICAgICAgaWYgKHcxID09IEZsb2F0LmNsYXNzIHx8IHcy\nID09IEZsb2F0LmNsYXNzKQogICAgICAgICAgICByZXR1cm4gZmxvYXQuY2xh\nc3M7CiAgICAgICAgaWYgKHcxID09IExvbmcuY2xhc3MgfHwgdzIgPT0gTG9u\nZy5jbGFzcykKICAgICAgICAgICAgcmV0dXJuIGxvbmcuY2xhc3M7CiAgICAg\nICAgcmV0dXJuIGludC5jbGFzczsKICAgIH0KCiAgICAvKioKICAgICAqIFJl\ndHVybiB3aGV0aGVyIHRoZSBnaXZlbiB0eXBlIGlzIG5vdCBhIHN0YW5kYXJk\nIHBlcnNpc3RlbnQgdHlwZS4KICAgICAqLwogICAgcHJpdmF0ZSBzdGF0aWMg\nYm9vbGVhbiBpc05vbnN0YW5kYXJkVHlwZShDbGFzcyBjKSB7CiAgICAgICAg\nc3dpdGNoIChKYXZhVHlwZXMuZ2V0VHlwZUNvZGUoYykpCiAgICAgICAgewog\nICAgICAgIGNhc2UgSmF2YVR5cGVzLkFSUkFZOgogICAgICAgIGNhc2UgSmF2\nYVR5cGVzLkNPTExFQ1RJT046CiAgICAgICAgY2FzZSBKYXZhVHlwZXMuTUFQ\nOgogICAgICAgIGNhc2UgSmF2YVR5cGVzLlBDOgogICAgICAgIGNhc2UgSmF2\nYVR5cGVzLlBDX1VOVFlQRUQ6CiAgICAgICAgY2FzZSBKYXZhVHlwZXMuT0lE\nOgogICAgICAgIGNhc2UgSmF2YVR5cGVzLk9CSkVDVDoKICAgICAgICAgICAg\ncmV0dXJuIHRydWU7CiAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgcmV0\ndXJuIGZhbHNlOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIFJl\ndHVybiB3aGV0aGVyIGFuIGluc3RhbmNlIG9mIHRoZSBmaXJzdCBjbGFzcyBj\nYW4gYmUgY29udmVydGVkIHRvCiAgICAgKiBhbiBpbnN0YW5jZSBvZiB0aGUg\nc2Vjb25kLgogICAgICovCiAgICBwdWJsaWMgc3RhdGljIGJvb2xlYW4gY2Fu\nQ29udmVydChDbGFzcyBjMSwgQ2xhc3MgYzIsIGJvb2xlYW4gc3RyaWN0KSB7\nCiAgICAgICAgYzEgPSB3cmFwKGMxKTsKICAgICAgICBjMiA9IHdyYXAoYzIp\nOwogICAgICAgIGlmIChjMi5pc0Fzc2lnbmFibGVGcm9tKGMxKSkKICAgICAg\nICAgICAgcmV0dXJuIHRydWU7CgogICAgICAgIGJvb2xlYW4gYzFOdW1iZXIg\nPSBOdW1iZXIuY2xhc3MuaXNBc3NpZ25hYmxlRnJvbShjMSk7CiAgICAgICAg\nYm9vbGVhbiBjMk51bWJlciA9IE51bWJlci5jbGFzcy5pc0Fzc2lnbmFibGVG\ncm9tKGMyKTsKICAgICAgICBpZiAoYzFOdW1iZXIgJiYgYzJOdW1iZXIpCiAg\nICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIGlmICgoYzFOdW1iZXIg\nJiYgKGMyID09IENoYXJhY3Rlci5jbGFzcwogICAgICAgICAgICB8fCAoIXN0\ncmljdCAmJiBjMiA9PSBTdHJpbmcuY2xhc3MpKSkKICAgICAgICAgICAgfHwg\nKGMyTnVtYmVyICYmIChjMSA9PSBDaGFyYWN0ZXIuY2xhc3MKICAgICAgICAg\nICAgfHwgKCFzdHJpY3QgJiYgYzEgPT0gU3RyaW5nLmNsYXNzKSkpKQogICAg\nICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICBpZiAoYzEgPT0gU3RyaW5n\nLmNsYXNzICYmIGMyID09IENoYXJhY3Rlci5jbGFzcykKICAgICAgICAgICAg\ncmV0dXJuIHRydWU7CiAgICAgICAgaWYgKGMyID09IFN0cmluZy5jbGFzcykK\nICAgICAgICAgICAgcmV0dXJuICFzdHJpY3Q7CiAgICAgICAgcmV0dXJuIGZh\nbHNlOwogICAgfQoKICAgIC8qKgogICAgICogQ29udmVydCB0aGUgZ2l2ZW4g\ndmFsdWUgdG8gdGhlIGdpdmVuIHR5cGUuCiAgICAgKi8KICAgIHB1YmxpYyBz\ndGF0aWMgT2JqZWN0IGNvbnZlcnQoT2JqZWN0IG8sIENsYXNzIHR5cGUpIHsK\nICAgICAgICBpZiAobyA9PSBudWxsKQogICAgICAgICAgICByZXR1cm4gbnVs\nbDsKICAgICAgICBpZiAoby5nZXRDbGFzcygpID09IHR5cGUpCiAgICAgICAg\nICAgIHJldHVybiBvOwoKICAgICAgICB0eXBlID0gd3JhcCh0eXBlKTsKICAg\nICAgICBpZiAodHlwZS5pc0Fzc2lnbmFibGVGcm9tKG8uZ2V0Q2xhc3MoKSkp\nCiAgICAgICAgICAgIHJldHVybiBvOwoKICAgICAgICAvLyB0aGUgb25seSBu\nb24tbnVtZXJpYyBjb252ZXJzaW9ucyB3ZSBkbyBhcmUgdG8gc3RyaW5nLCBv\nciBmcm9tCiAgICAgICAgLy8gc3RyaW5nL2NoYXIgdG8gbnVtYmVyLCBvciBj\nYWxlbmRhci9kYXRlCiAgICAgICAgYm9vbGVhbiBudW0gPSBvIGluc3RhbmNl\nb2YgTnVtYmVyOwogICAgICAgIGlmICghbnVtKSB7CiAgICAgICAgICAgIGlm\nICh0eXBlID09IFN0cmluZy5jbGFzcykKICAgICAgICAgICAgICAgIHJldHVy\nbiBvLnRvU3RyaW5nKCk7CiAgICAgICAgICAgIGVsc2UgaWYgKHR5cGUgPT0g\nQ2hhcmFjdGVyLmNsYXNzKSB7CiAgICAgICAgICAgICAgICBTdHJpbmcgc3Ry\nID0gby50b1N0cmluZygpOwogICAgICAgICAgICAgICAgaWYgKHN0ciAhPSBu\ndWxsICYmIHN0ci5sZW5ndGgoKSA9PSAxKQogICAgICAgICAgICAgICAgICAg\nIHJldHVybiBuZXcgQ2hhcmFjdGVyKHN0ci5jaGFyQXQoMCkpOwogICAgICAg\nICAgICB9IGVsc2UgaWYgKENhbGVuZGFyLmNsYXNzLmlzQXNzaWduYWJsZUZy\nb20odHlwZSkgJiYKICAgICAgICAgICAgICAgIG8gaW5zdGFuY2VvZiBEYXRl\nKSB7CiAgICAgICAgICAgICAgICBDYWxlbmRhciBjYWwgPSBDYWxlbmRhci5n\nZXRJbnN0YW5jZSgpOwogICAgICAgICAgICAgICAgY2FsLnNldFRpbWUoKERh\ndGUpIG8pOwogICAgICAgICAgICAgICAgcmV0dXJuIGNhbDsKICAgICAgICAg\nICAgfSBlbHNlIGlmIChEYXRlLmNsYXNzLmlzQXNzaWduYWJsZUZyb20odHlw\nZSkgJiYKICAgICAgICAgICAgICAgIG8gaW5zdGFuY2VvZiBDYWxlbmRhcikg\newogICAgICAgICAgICAgICAgcmV0dXJuICgoQ2FsZW5kYXIpIG8pLmdldFRp\nbWUoKTsKICAgICAgICAgICAgfSBlbHNlIGlmIChOdW1iZXIuY2xhc3MuaXNB\nc3NpZ25hYmxlRnJvbSh0eXBlKSkgewogICAgICAgICAgICAgICAgSW50ZWdl\nciBpID0gbnVsbDsKICAgICAgICAgICAgICAgIGlmIChvIGluc3RhbmNlb2Yg\nQ2hhcmFjdGVyKQogICAgICAgICAgICAgICAgICAgIGkgPSBOdW1iZXJzLnZh\nbHVlT2YoKChDaGFyYWN0ZXIpIG8pLmNoYXJWYWx1ZSgpKTsKICAgICAgICAg\nICAgICAgIGVsc2UgaWYgKG8gaW5zdGFuY2VvZiBTdHJpbmcgJiYgKChTdHJp\nbmcpIG8pLmxlbmd0aCgpID09IDEpCiAgICAgICAgICAgICAgICAgICAgaSA9\nIE51bWJlcnMudmFsdWVPZigoKFN0cmluZykgbykuY2hhckF0KDApKTsKCiAg\nICAgICAgICAgICAgICBpZiAoaSAhPSBudWxsKSB7CiAgICAgICAgICAgICAg\nICAgICAgaWYgKHR5cGUgPT0gSW50ZWdlci5jbGFzcykKICAgICAgICAgICAg\nICAgICAgICAgICAgcmV0dXJuIGk7CiAgICAgICAgICAgICAgICAgICAgbnVt\nID0gdHJ1ZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAg\nICAgIH0KICAgICAgICBpZiAoIW51bSkKICAgICAgICAgICAgdGhyb3cgbmV3\nIENsYXNzQ2FzdEV4Y2VwdGlvbihfbG9jLmdldCgiY2FudC1jb252ZXJ0Iiwg\nbywKICAgICAgICAgICAgICAgIG8uZ2V0Q2xhc3MoKSwgdHlwZSkuZ2V0TWVz\nc2FnZSgpKTsKCiAgICAgICAgaWYgKHR5cGUgPT0gSW50ZWdlci5jbGFzcykg\newogICAgICAgICAgICByZXR1cm4gTnVtYmVycy52YWx1ZU9mKCgoTnVtYmVy\nKSBvKS5pbnRWYWx1ZSgpKTsKICAgICAgICB9IGVsc2UgaWYgKHR5cGUgPT0g\nRmxvYXQuY2xhc3MpIHsKICAgICAgICAgICAgcmV0dXJuIG5ldyBGbG9hdCgo\nKE51bWJlcikgbykuZmxvYXRWYWx1ZSgpKTsKICAgICAgICB9IGVsc2UgaWYg\nKHR5cGUgPT0gRG91YmxlLmNsYXNzKSB7CiAgICAgICAgICAgIHJldHVybiBu\nZXcgRG91YmxlKCgoTnVtYmVyKSBvKS5kb3VibGVWYWx1ZSgpKTsKICAgICAg\nICB9IGVsc2UgaWYgKHR5cGUgPT0gTG9uZy5jbGFzcykgewogICAgICAgICAg\nICByZXR1cm4gTnVtYmVycy52YWx1ZU9mKCgoTnVtYmVyKSBvKS5sb25nVmFs\ndWUoKSk7CiAgICAgICAgfSBlbHNlIGlmICh0eXBlID09IEJpZ0RlY2ltYWwu\nY2xhc3MpIHsKICAgICAgICAgICAgLy8gdGhlIEJpZ0RlY2ltYWwgY29uc3Ry\ndWN0b3IgZG9lc24ndCBoYW5kbGUgdGhlCiAgICAgICAgICAgIC8vICJOYU4i\nIHN0cmluZyB2ZXJzaW9uIG9mIERvdWJsZS5OYU4gYW5kIEZsb2F0Lk5hTiwg\nbm9yCiAgICAgICAgICAgIC8vIGRvZXMgaXQgaGFuZGxlIGluZmluaXR5OyB3\nZSBuZWVkIHRvIGluc3RlYWQgdXNlIHRoZSBEb3VibGUKICAgICAgICAgICAg\nLy8gYW5kIEZsb2F0IHZlcnNpb25zLCBkZXNwaXRlIHdhbnRpbmcgdG8gY2Fz\ndCBpdCB0byBCaWdEZWNpbWFsCiAgICAgICAgICAgIGRvdWJsZSBkdmFsID0g\nKChOdW1iZXIpIG8pLmRvdWJsZVZhbHVlKCk7CiAgICAgICAgICAgIGlmIChE\nb3VibGUuaXNOYU4oZHZhbCkgfHwgRG91YmxlLmlzSW5maW5pdGUoZHZhbCkp\nCiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IERvdWJsZShkdmFsKTsKCiAg\nICAgICAgICAgIGZsb2F0IGZ2YWwgPSAoKE51bWJlcikgbykuZmxvYXRWYWx1\nZSgpOwogICAgICAgICAgICBpZiAoRmxvYXQuaXNOYU4oZnZhbCkgfHwgRmxv\nYXQuaXNJbmZpbml0ZShmdmFsKSkKICAgICAgICAgICAgICAgIHJldHVybiBu\nZXcgRmxvYXQoZnZhbCk7CgogICAgICAgICAgICByZXR1cm4gbmV3IEJpZ0Rl\nY2ltYWwoby50b1N0cmluZygpKTsKICAgICAgICB9IGVsc2UgaWYgKHR5cGUg\nPT0gQmlnSW50ZWdlci5jbGFzcykgewogICAgICAgICAgICByZXR1cm4gbmV3\nIEJpZ0ludGVnZXIoby50b1N0cmluZygpKTsKICAgICAgICB9IGVsc2UgaWYg\nKHR5cGUgPT0gU2hvcnQuY2xhc3MpIHsKICAgICAgICAgICAgcmV0dXJuIG5l\ndyBTaG9ydCgoKE51bWJlcikgbykuc2hvcnRWYWx1ZSgpKTsKICAgICAgICB9\nIGVsc2UgaWYgKHR5cGUgPT0gQnl0ZS5jbGFzcykgewogICAgICAgICAgICBy\nZXR1cm4gbmV3IEJ5dGUoKChOdW1iZXIpIG8pLmJ5dGVWYWx1ZSgpKTsKICAg\nICAgICB9IGVsc2UgewogICAgICAgICAgICByZXR1cm4gTnVtYmVycy52YWx1\nZU9mKCgoTnVtYmVyKSBvKS5pbnRWYWx1ZSgpKTsKICAgICAgICB9CiAgICB9\nCgogICAgLyoqCiAgICAgKiBBZGQgdGhlIGdpdmVuIHZhbHVlcy4KICAgICAq\nLwogICAgcHVibGljIHN0YXRpYyBPYmplY3QgYWRkKE9iamVjdCBvMSwgQ2xh\nc3MgYzEsIE9iamVjdCBvMiwgQ2xhc3MgYzIpIHsKICAgICAgICByZXR1cm4g\nb3AobzEsIGMxLCBvMiwgYzIsIE9QX0FERCk7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBTdWJ0cmFjdCB0aGUgZ2l2ZW4gdmFsdWVzLgogICAgICovCiAgICBw\ndWJsaWMgc3RhdGljIE9iamVjdCBzdWJ0cmFjdChPYmplY3QgbzEsIENsYXNz\nIGMxLCBPYmplY3QgbzIsIENsYXNzIGMyKSB7CiAgICAgICAgcmV0dXJuIG9w\nKG8xLCBjMSwgbzIsIGMyLCBPUF9TVUJUUkFDVCk7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBNdWx0aXBseSB0aGUgZ2l2ZW4gdmFsdWVzLgogICAgICovCiAg\nICBwdWJsaWMgc3RhdGljIE9iamVjdCBtdWx0aXBseShPYmplY3QgbzEsIENs\nYXNzIGMxLCBPYmplY3QgbzIsIENsYXNzIGMyKSB7CiAgICAgICAgcmV0dXJu\nIG9wKG8xLCBjMSwgbzIsIGMyLCBPUF9NVUxUSVBMWSk7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBEaXZpZGUgdGhlIGdpdmVuIHZhbHVlcy4KICAgICAqLwog\nICAgcHVibGljIHN0YXRpYyBPYmplY3QgZGl2aWRlKE9iamVjdCBvMSwgQ2xh\nc3MgYzEsIE9iamVjdCBvMiwgQ2xhc3MgYzIpIHsKICAgICAgICByZXR1cm4g\nb3AobzEsIGMxLCBvMiwgYzIsIE9QX0RJVklERSk7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBNb2QgdGhlIGdpdmVuIHZhbHVlcy4KICAgICAqLwogICAgcHVi\nbGljIHN0YXRpYyBPYmplY3QgbW9kKE9iamVjdCBvMSwgQ2xhc3MgYzEsIE9i\namVjdCBvMiwgQ2xhc3MgYzIpIHsKICAgICAgICByZXR1cm4gb3AobzEsIGMx\nLCBvMiwgYzIsIE9QX01PRCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBQZXJm\nb3JtIHRoZSBnaXZlbiBvcGVyYXRpb24gb24gdHdvIG51bWJlcnMuCiAgICAg\nKi8KICAgIHByaXZhdGUgc3RhdGljIE9iamVjdCBvcChPYmplY3QgbzEsIENs\nYXNzIGMxLCBPYmplY3QgbzIsIENsYXNzIGMyLCBpbnQgb3ApIHsKICAgICAg\nICBDbGFzcyBwcm9tb3RlID0gcHJvbW90ZShjMSwgYzIpOwogICAgICAgIGlm\nIChwcm9tb3RlID09IGludC5jbGFzcykgewogICAgICAgICAgICBpbnQgbjEg\nPSAobzEgPT0gbnVsbCkgPyAwIDogKChOdW1iZXIpIG8xKS5pbnRWYWx1ZSgp\nOwogICAgICAgICAgICBpbnQgbjIgPSAobzIgPT0gbnVsbCkgPyAwIDogKChO\ndW1iZXIpIG8yKS5pbnRWYWx1ZSgpOwogICAgICAgICAgICByZXR1cm4gb3Ao\nbjEsIG4yLCBvcCk7CiAgICAgICAgfQogICAgICAgIGlmIChwcm9tb3RlID09\nIGZsb2F0LmNsYXNzKSB7CiAgICAgICAgICAgIGZsb2F0IG4xID0gKG8xID09\nIG51bGwpID8gMEYgOiAoKE51bWJlcikgbzEpLmZsb2F0VmFsdWUoKTsKICAg\nICAgICAgICAgZmxvYXQgbjIgPSAobzIgPT0gbnVsbCkgPyAwRiA6ICgoTnVt\nYmVyKSBvMikuZmxvYXRWYWx1ZSgpOwogICAgICAgICAgICByZXR1cm4gb3Ao\nbjEsIG4yLCBvcCk7CiAgICAgICAgfQogICAgICAgIGlmIChwcm9tb3RlID09\nIGRvdWJsZS5jbGFzcykgewogICAgICAgICAgICBkb3VibGUgbjEgPSAobzEg\nPT0gbnVsbCkgPyAwRCA6ICgoTnVtYmVyKSBvMSkuZG91YmxlVmFsdWUoKTsK\nICAgICAgICAgICAgZG91YmxlIG4yID0gKG8yID09IG51bGwpID8gMEQgOiAo\nKE51bWJlcikgbzIpLmRvdWJsZVZhbHVlKCk7CiAgICAgICAgICAgIHJldHVy\nbiBvcChuMSwgbjIsIG9wKTsKICAgICAgICB9CiAgICAgICAgaWYgKHByb21v\ndGUgPT0gbG9uZy5jbGFzcykgewogICAgICAgICAgICBsb25nIG4xID0gKG8x\nID09IG51bGwpID8gMEwgOiAoKE51bWJlcikgbzEpLmxvbmdWYWx1ZSgpOwog\nICAgICAgICAgICBsb25nIG4yID0gKG8yID09IG51bGwpID8gMEwgOiAoKE51\nbWJlcikgbzIpLmxvbmdWYWx1ZSgpOwogICAgICAgICAgICByZXR1cm4gb3Ao\nbjEsIG4yLCBvcCk7CiAgICAgICAgfQogICAgICAgIGlmIChwcm9tb3RlID09\nIEJpZ0RlY2ltYWwuY2xhc3MpIHsKICAgICAgICAgICAgQmlnRGVjaW1hbCBu\nMSA9IChvMSA9PSBudWxsKSA/IFpFUk9fQklHREVDSU1BTAogICAgICAgICAg\nICAgICAgOiAoQmlnRGVjaW1hbCkgY29udmVydChvMSwgcHJvbW90ZSk7CiAg\nICAgICAgICAgIEJpZ0RlY2ltYWwgbjIgPSAobzIgPT0gbnVsbCkgPyBaRVJP\nX0JJR0RFQ0lNQUwKICAgICAgICAgICAgICAgIDogKEJpZ0RlY2ltYWwpIGNv\nbnZlcnQobzIsIHByb21vdGUpOwogICAgICAgICAgICByZXR1cm4gb3AobjEs\nIG4yLCBvcCk7CiAgICAgICAgfQogICAgICAgIGlmIChwcm9tb3RlID09IEJp\nZ0ludGVnZXIuY2xhc3MpIHsKICAgICAgICAgICAgQmlnSW50ZWdlciBuMSA9\nIChvMSA9PSBudWxsKSA/IFpFUk9fQklHSU5URUdFUgogICAgICAgICAgICAg\nICAgOiAoQmlnSW50ZWdlcikgY29udmVydChvMSwgcHJvbW90ZSk7CiAgICAg\nICAgICAgIEJpZ0ludGVnZXIgbjIgPSAobzIgPT0gbnVsbCkgPyBaRVJPX0JJ\nR0lOVEVHRVIKICAgICAgICAgICAgICAgIDogKEJpZ0ludGVnZXIpIGNvbnZl\ncnQobzIsIHByb21vdGUpOwogICAgICAgICAgICByZXR1cm4gb3AobjEsIG4y\nLCBvcCk7CiAgICAgICAgfQogICAgICAgIC8vIGRlZmF1bHQgdG8gaW50CiAg\nICAgICAgaW50IG4xID0gKG8xID09IG51bGwpID8gMCA6ICgoTnVtYmVyKSBv\nMSkuaW50VmFsdWUoKTsKICAgICAgICBpbnQgbjIgPSAobzIgPT0gbnVsbCkg\nPyAwIDogKChOdW1iZXIpIG8yKS5pbnRWYWx1ZSgpOwogICAgICAgIHJldHVy\nbiBvcChuMSwgbjIsIG9wKTsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVy\nbiB0aGUgcmVzdWx0IG9mIGEgbWF0aGVtYXRpY2FsIG9wZXJhdGlvbi4KICAg\nICAqLwogICAgcHJpdmF0ZSBzdGF0aWMgT2JqZWN0IG9wKGludCBuMSwgaW50\nIG4yLCBpbnQgb3ApIHsKICAgICAgICBpbnQgdG90OwogICAgICAgIHN3aXRj\naCAob3ApIHsKICAgICAgICAgICAgY2FzZSBPUF9BREQ6CiAgICAgICAgICAg\nICAgICB0b3QgPSBuMSArIG4yOwogICAgICAgICAgICAgICAgYnJlYWs7CiAg\nICAgICAgICAgIGNhc2UgT1BfU1VCVFJBQ1Q6CiAgICAgICAgICAgICAgICB0\nb3QgPSBuMSAtIG4yOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAg\nICAgIGNhc2UgT1BfTVVMVElQTFk6CiAgICAgICAgICAgICAgICB0b3QgPSBu\nMSAqIG4yOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNh\nc2UgT1BfRElWSURFOgogICAgICAgICAgICAgICAgdG90ID0gbjEgLyBuMjsK\nICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIE9QX01P\nRDoKICAgICAgICAgICAgICAgIHRvdCA9IG4xICUgbjI7CiAgICAgICAgICAg\nICAgICBicmVhazsKICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAg\nICAgIHRocm93IG5ldyBJbnRlcm5hbEV4Y2VwdGlvbigpOwogICAgICAgIH0K\nICAgICAgICByZXR1cm4gTnVtYmVycy52YWx1ZU9mKHRvdCk7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIHJlc3VsdCBvZiBhIG1hdGhlbWF0\naWNhbCBvcGVyYXRpb24uCiAgICAgKi8KICAgIHByaXZhdGUgc3RhdGljIE9i\namVjdCBvcChmbG9hdCBuMSwgZmxvYXQgbjIsIGludCBvcCkgewogICAgICAg\nIGZsb2F0IHRvdDsKICAgICAgICBzd2l0Y2ggKG9wKSB7CiAgICAgICAgICAg\nIGNhc2UgT1BfQUREOgogICAgICAgICAgICAgICAgdG90ID0gbjEgKyBuMjsK\nICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIE9QX1NV\nQlRSQUNUOgogICAgICAgICAgICAgICAgdG90ID0gbjEgLSBuMjsKICAgICAg\nICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIE9QX01VTFRJUExZ\nOgogICAgICAgICAgICAgICAgdG90ID0gbjEgKiBuMjsKICAgICAgICAgICAg\nICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIE9QX0RJVklERToKICAgICAg\nICAgICAgICAgIHRvdCA9IG4xIC8gbjI7CiAgICAgICAgICAgICAgICBicmVh\nazsKICAgICAgICAgICAgY2FzZSBPUF9NT0Q6CiAgICAgICAgICAgICAgICB0\nb3QgPSBuMSAlIG4yOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAg\nICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgSW50ZXJu\nYWxFeGNlcHRpb24oKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIG5ldyBG\nbG9hdCh0b3QpOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRoZSBy\nZXN1bHQgb2YgYSBtYXRoZW1hdGljYWwgb3BlcmF0aW9uLgogICAgICovCiAg\nICBwcml2YXRlIHN0YXRpYyBPYmplY3Qgb3AoZG91YmxlIG4xLCBkb3VibGUg\nbjIsIGludCBvcCkgewogICAgICAgIGRvdWJsZSB0b3Q7CiAgICAgICAgc3dp\ndGNoIChvcCkgewogICAgICAgICAgICBjYXNlIE9QX0FERDoKICAgICAgICAg\nICAgICAgIHRvdCA9IG4xICsgbjI7CiAgICAgICAgICAgICAgICBicmVhazsK\nICAgICAgICAgICAgY2FzZSBPUF9TVUJUUkFDVDoKICAgICAgICAgICAgICAg\nIHRvdCA9IG4xIC0gbjI7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAg\nICAgICAgY2FzZSBPUF9NVUxUSVBMWToKICAgICAgICAgICAgICAgIHRvdCA9\nIG4xICogbjI7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAg\nY2FzZSBPUF9ESVZJREU6CiAgICAgICAgICAgICAgICB0b3QgPSBuMSAvIG4y\nOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgT1Bf\nTU9EOgogICAgICAgICAgICAgICAgdG90ID0gbjEgJSBuMjsKICAgICAgICAg\nICAgICAgIGJyZWFrOwogICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAg\nICAgICAgdGhyb3cgbmV3IEludGVybmFsRXhjZXB0aW9uKCk7CiAgICAgICAg\nfQogICAgICAgIHJldHVybiBuZXcgRG91YmxlKHRvdCk7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBSZXR1cm4gdGhlIHJlc3VsdCBvZiBhIG1hdGhlbWF0aWNh\nbCBvcGVyYXRpb24uCiAgICAgKi8KICAgIHByaXZhdGUgc3RhdGljIE9iamVj\ndCBvcChsb25nIG4xLCBsb25nIG4yLCBpbnQgb3ApIHsKICAgICAgICBsb25n\nIHRvdDsKICAgICAgICBzd2l0Y2ggKG9wKSB7CiAgICAgICAgICAgIGNhc2Ug\nT1BfQUREOgogICAgICAgICAgICAgICAgdG90ID0gbjEgKyBuMjsKICAgICAg\nICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIE9QX1NVQlRSQUNU\nOgogICAgICAgICAgICAgICAgdG90ID0gbjEgLSBuMjsKICAgICAgICAgICAg\nICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIE9QX01VTFRJUExZOgogICAg\nICAgICAgICAgICAgdG90ID0gbjEgKiBuMjsKICAgICAgICAgICAgICAgIGJy\nZWFrOwogICAgICAgICAgICBjYXNlIE9QX0RJVklERToKICAgICAgICAgICAg\nICAgIHRvdCA9IG4xIC8gbjI7CiAgICAgICAgICAgICAgICBicmVhazsKICAg\nICAgICAgICAgY2FzZSBPUF9NT0Q6CiAgICAgICAgICAgICAgICB0b3QgPSBu\nMSAlIG4yOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGRl\nZmF1bHQ6CiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgSW50ZXJuYWxFeGNl\ncHRpb24oKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIE51bWJlcnMudmFs\ndWVPZih0b3QpOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRoZSBy\nZXN1bHQgb2YgYSBtYXRoZW1hdGljYWwgb3BlcmF0aW9uLgogICAgICovCiAg\nICBwcml2YXRlIHN0YXRpYyBPYmplY3Qgb3AoQmlnRGVjaW1hbCBuMSwgQmln\nRGVjaW1hbCBuMiwgaW50IG9wKSB7CiAgICAgICAgc3dpdGNoIChvcCkgewog\nICAgICAgICAgICBjYXNlIE9QX0FERDoKICAgICAgICAgICAgICAgIHJldHVy\nbiBuMS5hZGQobjIpOwogICAgICAgICAgICBjYXNlIE9QX1NVQlRSQUNUOgog\nICAgICAgICAgICAgICAgcmV0dXJuIG4xLnN1YnRyYWN0KG4yKTsKICAgICAg\nICAgICAgY2FzZSBPUF9NVUxUSVBMWToKICAgICAgICAgICAgICAgIHJldHVy\nbiBuMS5tdWx0aXBseShuMik7CiAgICAgICAgICAgIGNhc2UgT1BfRElWSURF\nOgogICAgICAgICAgICAgICAgaW50IHNjYWxlID0gTWF0aC5tYXgobjEuc2Nh\nbGUoKSwgbjIuc2NhbGUoKSk7CiAgICAgICAgICAgICAgICByZXR1cm4gbjEu\nZGl2aWRlKG4yLCBzY2FsZSwgQmlnRGVjaW1hbC5ST1VORF9IQUxGX1VQKTsK\nICAgICAgICAgICAgY2FzZSBPUF9NT0Q6CiAgICAgICAgICAgICAgICB0aHJv\ndyBuZXcgVXNlckV4Y2VwdGlvbihfbG9jLmdldCgibW9kLWJpZ2RlY2ltYWwi\nKSk7CiAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgICB0aHJv\ndyBuZXcgSW50ZXJuYWxFeGNlcHRpb24oKTsKICAgICAgICB9CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIHJlc3VsdCBvZiBhIG1hdGhlbWF0\naWNhbCBvcGVyYXRpb24uCiAgICAgKi8KICAgIHByaXZhdGUgc3RhdGljIE9i\namVjdCBvcChCaWdJbnRlZ2VyIG4xLCBCaWdJbnRlZ2VyIG4yLCBpbnQgb3Ap\nIHsKICAgICAgICBzd2l0Y2ggKG9wKSB7CiAgICAgICAgICAgIGNhc2UgT1Bf\nQUREOgogICAgICAgICAgICAgICAgcmV0dXJuIG4xLmFkZChuMik7CiAgICAg\nICAgICAgIGNhc2UgT1BfU1VCVFJBQ1Q6CiAgICAgICAgICAgICAgICByZXR1\ncm4gbjEuc3VidHJhY3QobjIpOwogICAgICAgICAgICBjYXNlIE9QX01VTFRJ\nUExZOgogICAgICAgICAgICAgICAgcmV0dXJuIG4xLm11bHRpcGx5KG4yKTsK\nICAgICAgICAgICAgY2FzZSBPUF9ESVZJREU6CiAgICAgICAgICAgICAgICBy\nZXR1cm4gbjEuZGl2aWRlKG4yKTsKICAgICAgICAgICAgZGVmYXVsdDoKICAg\nICAgICAgICAgICAgIHRocm93IG5ldyBJbnRlcm5hbEV4Y2VwdGlvbigpOwog\nICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIFBhcnNlcyB0aGUgZ2l2\nZW4gZGVjbGFyYXRpb25zIGludG8gYSBsaXN0IG9mIHR5cGUsIG5hbWUsIHR5\ncGUsIG5hbWUuLi4KICAgICAqIFJldHVybnMgbnVsbCBpZiBubyBkZWNsYXJh\ndGlvbnMuIEFzc3VtZXMgZGVjbGFyYXRpb24gaXMgbm90IGFuIGVtcHR5CiAg\nICAgKiBzdHJpbmcgYW5kIGlzIGFscmVhZHkgdHJpbW1lZCAodmFsaWQgYXNz\ndW1wdGlvbnMgZ2l2ZW4gdGhlIGNoZWNrcyBtYWRlCiAgICAgKiBpbiBvdXIg\nc2V0dGVycykuCiAgICAgKgogICAgICogQHBhcmFtIGRlY1R5cGUgdGhlIHR5\ncGUgb2YgZGVjbGFyYXRpb24gYmVpbmcgcGFyc2VkLCBmb3IgdXNlIGluCiAg\nICAgKiBlcnJvciBtZXNzYWdlcwogICAgICovCiAgICBwdWJsaWMgc3RhdGlj\nIExpc3QgcGFyc2VEZWNsYXJhdGlvbihTdHJpbmcgZGVjLCBjaGFyIHNwbGl0\nLAogICAgICAgIFN0cmluZyBkZWNUeXBlKSB7CiAgICAgICAgaWYgKGRlYyA9\nPSBudWxsKQogICAgICAgICAgICByZXR1cm4gbnVsbDsKCiAgICAgICAgLy8g\nd2F0Y2ggZm9yIGNvbW1vbiBtaXh1cHMgYmV0d2VlbiBjb21tYXMgYW5kIHNl\nbWlzCiAgICAgICAgY2hhciBiYWQgPSAoY2hhcikgMDsKICAgICAgICBpZiAo\nc3BsaXQgPT0gJywnKQogICAgICAgICAgICBiYWQgPSAnOyc7CiAgICAgICAg\nZWxzZSBpZiAoc3BsaXQgPT0gJzsnKQogICAgICAgICAgICBiYWQgPSAnLCc7\nCgogICAgICAgIGNoYXIgc2VudGluYWwgPSAnICc7CiAgICAgICAgY2hhciBj\ndXI7CiAgICAgICAgaW50IHN0YXJ0ID0gMDsKICAgICAgICBib29sZWFuIHNr\naXBTcGFjZSA9IGZhbHNlOwogICAgICAgIExpc3QgcmVzdWx0cyA9IG5ldyBB\ncnJheUxpc3QoNik7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBkZWMu\nbGVuZ3RoKCk7IGkrKykgewogICAgICAgICAgICBjdXIgPSBkZWMuY2hhckF0\nKGkpOwogICAgICAgICAgICBpZiAoY3VyID09IGJhZCkKICAgICAgICAgICAg\nICAgIHRocm93IG5ldyBVc2VyRXhjZXB0aW9uKF9sb2MuZ2V0KCJiYWQtZGVj\nIiwgZGVjLCBkZWNUeXBlKSk7CiAgICAgICAgICAgIGlmIChjdXIgPT0gJyAn\nICYmIHNraXBTcGFjZSkgewogICAgICAgICAgICAgICAgc3RhcnQrKzsKICAg\nICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICB9CgogICAgICAg\nICAgICBza2lwU3BhY2UgPSBmYWxzZTsKICAgICAgICAgICAgaWYgKGN1ciAh\nPSBzZW50aW5hbCkKICAgICAgICAgICAgICAgIGNvbnRpbnVlOwoKICAgICAg\nICAgICAgLy8gaWYgbG9va2luZyBmb3Igc3BhY2VzLCBsb29rIGZvciBzcGxp\ndCBjaGFyLCBvciB2aWNlIHZlcnNhCiAgICAgICAgICAgIHNlbnRpbmFsID0g\nKHNlbnRpbmFsID09ICcgJykgPyBzcGxpdCA6ICcgJzsKICAgICAgICAgICAg\ncmVzdWx0cy5hZGQoZGVjLnN1YnN0cmluZyhzdGFydCwgaSkudHJpbSgpKTsK\nICAgICAgICAgICAgc3RhcnQgPSBpICsgMTsKICAgICAgICAgICAgc2tpcFNw\nYWNlID0gdHJ1ZTsKICAgICAgICB9CgogICAgICAgIC8vIGFkZCBsYXN0IHRv\na2VuLCBpZiBhbnkKICAgICAgICBpZiAoc3RhcnQgPCBkZWMubGVuZ3RoKCkp\nCiAgICAgICAgICAgIHJlc3VsdHMuYWRkKGRlYy5zdWJzdHJpbmcoc3RhcnQp\nKTsKCiAgICAgICAgLy8gaWYgbm90IGFuIGV2ZW4gbnVtYmVyIG9mIGVsZW1l\nbnRzLCBzb21ldGhpbmcgaXMgd3JvbmcKICAgICAgICBpZiAocmVzdWx0cy5p\nc0VtcHR5KCkgfHwgcmVzdWx0cy5zaXplKCkgJSAyICE9IDApCiAgICAgICAg\nICAgIHRocm93IG5ldyBVc2VyRXhjZXB0aW9uKF9sb2MuZ2V0KCJiYWQtZGVj\nIiwgZGVjLCBkZWNUeXBlKSk7CgogICAgICAgIHJldHVybiByZXN1bHRzOwog\nICAgfQoKICAgIC8qKgogICAgICogU3BsaXQgdGhlIGdpdmVuIGV4cHJlc3Np\nb24gbGlzdCBpbnRvIGRpc3RpbmN0IGV4cHJlc3Npb25zLiBBc3N1bWVzIHRo\nZQogICAgICogZ2l2ZW4gc3RyaW5nIGlzIG5vdCBudWxsIG9yIG9mIHplcm8g\nbGVuZ3RoIGFuZCBpcyBhbHJlYWR5IHRyaW1tZWQKICAgICAqICh2YWxpZCBh\nc3N1bXB0aW9ucyBnaXZlbiB0aGUgY2hlY2tzIGluIG91ciBzZXR0ZXJzIGFu\nZCBiZWZvcmUKICAgICAqIHRoaXMgbWV0aG9kIGNhbGwpLgogICAgICovCiAg\nICBwdWJsaWMgc3RhdGljIExpc3Qgc3BsaXRFeHByZXNzaW9ucyhTdHJpbmcg\nc3RyLCBjaGFyIHNwbGl0LCBpbnQgZXhwZWN0ZWQpIHsKICAgICAgICBpZiAo\nc3RyID09IG51bGwpCiAgICAgICAgICAgIHJldHVybiBudWxsOwoKICAgICAg\nICBMaXN0IGV4cHMgPSBudWxsOwogICAgICAgIGludCBwYXJlbkRlcHRoID0g\nMDsKICAgICAgICBpbnQgYmVnaW4gPSAwLCBwb3MgPSAwOwogICAgICAgIGJv\nb2xlYW4gZXNjYXBlID0gZmFsc2U7CiAgICAgICAgYm9vbGVhbiBzdHJpbmcg\nPSBmYWxzZTsKICAgICAgICBib29sZWFuIG5vbnNwYWNlID0gZmFsc2U7CiAg\nICAgICAgY2hhciBxdW90ZSA9IDA7CiAgICAgICAgZm9yIChjaGFyIGM7IHBv\ncyA8IHN0ci5sZW5ndGgoKTsgcG9zKyspIHsKICAgICAgICAgICAgYyA9IHN0\nci5jaGFyQXQocG9zKTsKICAgICAgICAgICAgaWYgKGMgPT0gJ1xcJykgewog\nICAgICAgICAgICAgICAgZXNjYXBlID0gIWVzY2FwZTsKICAgICAgICAgICAg\nICAgIGNvbnRpbnVlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmIChl\nc2NhcGUpIHsKICAgICAgICAgICAgICAgIGVzY2FwZSA9IGZhbHNlOwogICAg\nICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgIH0KCiAgICAgICAg\nICAgIHN3aXRjaCAoYykgewogICAgICAgICAgICAgICAgY2FzZSAnXCcnOgog\nICAgICAgICAgICAgICAgY2FzZSAnIic6CiAgICAgICAgICAgICAgICAgICAg\naWYgKHN0cmluZyAmJiBxdW90ZSA9PSBjKQogICAgICAgICAgICAgICAgICAg\nICAgICBzdHJpbmcgPSBmYWxzZTsKICAgICAgICAgICAgICAgICAgICBlbHNl\nIGlmICghc3RyaW5nKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHF1b3Rl\nID0gYzsKICAgICAgICAgICAgICAgICAgICAgICAgc3RyaW5nID0gdHJ1ZTsK\nICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgbm9u\nc3BhY2UgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAg\nICAgICAgICAgICAgY2FzZSAnKCc6CiAgICAgICAgICAgICAgICAgICAgaWYg\nKCFzdHJpbmcpCiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVuRGVwdGgr\nKzsKICAgICAgICAgICAgICAgICAgICBub25zcGFjZSA9IHRydWU7CiAgICAg\nICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlICcp\nJzoKICAgICAgICAgICAgICAgICAgICBpZiAoIXN0cmluZykKICAgICAgICAg\nICAgICAgICAgICAgICAgcGFyZW5EZXB0aC0tOwogICAgICAgICAgICAgICAg\nICAgIG5vbnNwYWNlID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICBicmVh\nazsKICAgICAgICAgICAgICAgIGNhc2UgJyAnOgogICAgICAgICAgICAgICAg\nY2FzZSAnXHQnOgogICAgICAgICAgICAgICAgY2FzZSAnXG4nOgogICAgICAg\nICAgICAgICAgY2FzZSAnXHInOgogICAgICAgICAgICAgICAgICAgIGlmIChj\nID09IHNwbGl0ICYmICFzdHJpbmcgJiYgcGFyZW5EZXB0aCA9PSAwICYmIG5v\nbnNwYWNlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChleHBzID09\nIG51bGwpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBleHBzID0gbmV3\nIEFycmF5TGlzdChleHBlY3RlZCk7CiAgICAgICAgICAgICAgICAgICAgICAg\nIGV4cHMuYWRkKHN0ci5zdWJzdHJpbmcoYmVnaW4sIHBvcykudHJpbSgpKTsK\nICAgICAgICAgICAgICAgICAgICAgICAgYmVnaW4gPSBwb3MgKyAxOwogICAg\nICAgICAgICAgICAgICAgICAgICBub25zcGFjZSA9IGZhbHNlOwogICAgICAg\nICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBicmVhazsKICAg\nICAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgICAgICAgaWYg\nKGMgPT0gc3BsaXQgJiYgIXN0cmluZyAmJiBwYXJlbkRlcHRoID09IDApIHsK\nICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGV4cHMgPT0gbnVsbCkKICAg\nICAgICAgICAgICAgICAgICAgICAgICAgIGV4cHMgPSBuZXcgQXJyYXlMaXN0\nKGV4cGVjdGVkKTsKICAgICAgICAgICAgICAgICAgICAgICAgZXhwcy5hZGQo\nc3RyLnN1YnN0cmluZyhiZWdpbiwgcG9zKS50cmltKCkpOwogICAgICAgICAg\nICAgICAgICAgICAgICBiZWdpbiA9IHBvcyArIDE7CiAgICAgICAgICAgICAg\nICAgICAgfQogICAgICAgICAgICAgICAgICAgIG5vbnNwYWNlID0gdHJ1ZTsK\nICAgICAgICAgICAgfQogICAgICAgICAgICBlc2NhcGUgPSBmYWxzZTsKICAg\nICAgICB9CgogICAgICAgIGlmIChleHBzID09IG51bGwpIHsKICAgICAgICAg\nICAgLy8gQ29sbGVjdGlvbnMuc2luZ2xldG9uTGlzdCB3YXNuJ3QgYWRkZWQg\ndW50aWwgMS4zCiAgICAgICAgICAgIGV4cHMgPSBuZXcgQXJyYXlMaXN0KDEp\nOwogICAgICAgICAgICBleHBzLmFkZChzdHIpOwogICAgICAgICAgICByZXR1\ncm4gZXhwczsKICAgICAgICB9CgogICAgICAgIC8vIGFkZCBsYXN0IGV4cCBh\nbmQgcmV0dXJuIGFycmF5CiAgICAgICAgU3RyaW5nIGxhc3QgPSBzdHIuc3Vi\nc3RyaW5nKGJlZ2luKS50cmltKCk7CiAgICAgICAgaWYgKGxhc3QubGVuZ3Ro\nKCkgPiAwKQogICAgICAgICAgICBleHBzLmFkZChsYXN0KTsKICAgICAgICBy\nZXR1cm4gZXhwczsKICAgIH0KCiAgICAvKioKICAgICAqIEFkZCB0aGUgZ2l2\nZW4gYWNjZXNzIHBhdGggbWV0YWRhdGFzIHRvIHRoZSBmdWxsIHBhdGggbGlz\ndCwgbWFraW5nIHN1cmUKICAgICAqIHRvIG1haW50YWluIG9ubHkgYmFzZSBt\nZXRhZGF0YXMgaW4gdGhlIGxpc3QuIFRoZSBnaXZlbiBsaXN0IG1heSBiZSBu\ndWxsLgogICAgICovCiAgICBwdWJsaWMgc3RhdGljIExpc3QgYWRkQWNjZXNz\nUGF0aE1ldGFEYXRhcyhMaXN0IG1ldGFzLAogICAgICAgIENsYXNzTWV0YURh\ndGFbXSBwYXRoKSB7CiAgICAgICAgaWYgKHBhdGggPT0gbnVsbCB8fCBwYXRo\nLmxlbmd0aCA9PSAwKQogICAgICAgICAgICByZXR1cm4gbWV0YXM7CgogICAg\nICAgIC8vIGNyZWF0ZSBzZXQgb2YgYmFzZSBjbGFzcyBtZXRhZGF0YXMgaW4g\nYWNjZXNzIHBhdGgKICAgICAgICBpZiAobWV0YXMgPT0gbnVsbCkKICAgICAg\nICAgICAgbWV0YXMgPSBuZXcgQXJyYXlMaXN0KCk7CiAgICAgICAgaW50IGxh\nc3QgPSBtZXRhcy5zaXplKCk7CgogICAgICAgIC8vIGZvciBldmVyeSBlbGVt\nZW50IGluIHRoZSBwYXRoIG9mIHRoaXMgZXhlY3V0b3IsIGNvbXBhcmUgaXQK\nICAgICAgICAvLyB0byBhbHJlYWR5LWdhdGhlcmVkIGVsZW1lbnRzIHRvIHNl\nZSBpZiBpdCBzaG91bGQgcmVwbGFjZQogICAgICAgIC8vIGEgc3ViY2xhc3Mg\naW4gdGhlIGxpc3Qgb3Igc2hvdWxkIGJlIGFkZGVkIGFzIGEgbmV3IGJhc2U7\nCiAgICAgICAgLy8gYXQgbGVhc3QgaXQncyBuXjIgb2YgYSBzbWFsbCBuLi4u\nCiAgICAgICAgQ2xhc3NNZXRhRGF0YSBtZXRhOwogICAgICAgIGJvb2xlYW4g\nYWRkOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgcGF0aC5sZW5ndGg7\nIGkrKykgewogICAgICAgICAgICBhZGQgPSB0cnVlOwogICAgICAgICAgICBm\nb3IgKGludCBqID0gMDsgYWRkICYmIGogPCBsYXN0OyBqKyspIHsKICAgICAg\nICAgICAgICAgIG1ldGEgPSAoQ2xhc3NNZXRhRGF0YSkgbWV0YXMuZ2V0KGop\nOwoKICAgICAgICAgICAgICAgIGlmIChtZXRhLmdldERlc2NyaWJlZFR5cGUo\nKS5pc0Fzc2lnbmFibGVGcm9tCiAgICAgICAgICAgICAgICAgICAgKHBhdGhb\naV0uZ2V0RGVzY3JpYmVkVHlwZSgpKSkgewogICAgICAgICAgICAgICAgICAg\nIC8vIGxpc3QgYWxyZWFkeSBjb250YWlucyBiYXNlIGNsYXNzCiAgICAgICAg\nICAgICAgICAgICAgYWRkID0gZmFsc2U7CiAgICAgICAgICAgICAgICB9IGVs\nc2UgaWYgKHBhdGhbaV0uZ2V0RGVzY3JpYmVkVHlwZSgpLmlzQXNzaWduYWJs\nZUZyb20KICAgICAgICAgICAgICAgICAgICAobWV0YS5nZXREZXNjcmliZWRU\neXBlKCkpKSB7CiAgICAgICAgICAgICAgICAgICAgLy8gdGhpcyBlbGVtZW50\nIHJlcGxhY2VzIGl0cyBzdWJjbGFzcwogICAgICAgICAgICAgICAgICAgIGFk\nZCA9IGZhbHNlOwogICAgICAgICAgICAgICAgICAgIG1ldGFzLnNldChqLCBw\nYXRoW2ldKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAg\nICAgICAgICAgLy8gaWYgbm8gYmFzZSBjbGFzcyBvZiBjdXJyZW50IHBhdGgg\nZWxlbWVudCBhbHJlYWR5IGluCiAgICAgICAgICAgIC8vIGxpc3QgYW5kIHBh\ndGggZWxlbWVudCBkaWRuJ3QgcmVwbGFjZSBhIHN1YmNsYXNzIGluIHRoZQog\nICAgICAgICAgICAvLyBsaXN0LCB0aGVuIGFkZCBpdCBub3cgYXMgYSBuZXcg\nYmFzZQogICAgICAgICAgICBpZiAoYWRkKQogICAgICAgICAgICAgICAgbWV0\nYXMuYWRkKHBhdGhbaV0pOwogICAgICAgIH0KICAgICAgICByZXR1cm4gbWV0\nYXM7CiAgICB9CgogICAgLyoqCiAgICAgKiBDb252ZXJ0IHRoZSB1c2VyLWdp\ndmVuIGhpbnQgdmFsdWUgdG8gYW4gYWdncmVnYXRlIGxpc3RlbmVyLgogICAg\nICogVGhlIGhpbnQgY2FuIGJlIGFuIGFnZ3JlZ2F0ZSBsaXN0ZW5lciBpbnN0\nYW5jZSBvciBjbGFzcyBuYW1lLgogICAgICovCiAgICBwdWJsaWMgc3RhdGlj\nIEFnZ3JlZ2F0ZUxpc3RlbmVyIGhpbnRUb0FnZ3JlZ2F0ZUxpc3RlbmVyKE9i\namVjdCBoaW50LAogICAgICAgIENsYXNzTG9hZGVyIGxvYWRlcikgewogICAg\nICAgIGlmIChoaW50ID09IG51bGwpCiAgICAgICAgICAgIHJldHVybiBudWxs\nOwogICAgICAgIGlmIChoaW50IGluc3RhbmNlb2YgQWdncmVnYXRlTGlzdGVu\nZXIpCiAgICAgICAgICAgIHJldHVybiAoQWdncmVnYXRlTGlzdGVuZXIpIGhp\nbnQ7CgogICAgICAgIEV4Y2VwdGlvbiBjYXVzZSA9IG51bGw7CiAgICAgICAg\naWYgKGhpbnQgaW5zdGFuY2VvZiBTdHJpbmcpIHsKICAgICAgICAgICAgdHJ5\nIHsKICAgICAgICAgICAgICAgIHJldHVybiAoQWdncmVnYXRlTGlzdGVuZXIp\nIEFjY2Vzc0NvbnRyb2xsZXIuZG9Qcml2aWxlZ2VkKAogICAgICAgICAgICAg\nICAgICAgIEoyRG9Qcml2SGVscGVyLm5ld0luc3RhbmNlQWN0aW9uKAogICAg\nICAgICAgICAgICAgICAgICAgICBDbGFzcy5mb3JOYW1lKChTdHJpbmcpIGhp\nbnQsIHRydWUsIGxvYWRlcikpKTsKICAgICAgICAgICAgfSBjYXRjaCAoRXhj\nZXB0aW9uIGUpIHsKICAgICAgICAgICAgICAgIGlmIChlIGluc3RhbmNlb2Yg\nUHJpdmlsZWdlZEFjdGlvbkV4Y2VwdGlvbikKICAgICAgICAgICAgICAgICAg\nICBlID0gKChQcml2aWxlZ2VkQWN0aW9uRXhjZXB0aW9uKSBlKS5nZXRFeGNl\ncHRpb24oKTsKICAgICAgICAgICAgICAgIGNhdXNlID0gZTsKICAgICAgICAg\nICAgfQogICAgICAgIH0KICAgICAgICB0aHJvdyBuZXcgVXNlckV4Y2VwdGlv\nbihfbG9jLmdldCgiYmFkLWFnZy1saXN0ZW5lci1oaW50IiwgaGludCwKICAg\nICAgICAgICAgaGludC5nZXRDbGFzcygpKSkuc2V0Q2F1c2UoY2F1c2UpOwog\nICAgfQoKICAgIC8qKgogICAgICogQ29udmVydCB0aGUgdXNlci1naXZlbiBo\naW50IHZhbHVlIHRvIGFuIGFycmF5IG9mIGFnZ3JlZ2F0ZSBsaXN0ZW5lcnMu\nCiAgICAgKiBUaGUgaGludCBjYW4gYmUgYW4gYWdncmVnYXRlIGxpc3RlbmVy\nLCBhZ2dyZWdhdGUgbGlzdGVuZXIgYXJyYXksCiAgICAgKiBjb2xsZWN0aW9u\nLCBvciBjb21tYS1zZXBhcmF0ZWQgY2xhc3MgbmFtZXMuCiAgICAgKi8KICAg\nIHB1YmxpYyBzdGF0aWMgQWdncmVnYXRlTGlzdGVuZXJbXSBoaW50VG9BZ2dy\nZWdhdGVMaXN0ZW5lcnMoT2JqZWN0IGhpbnQsCiAgICAgICAgQ2xhc3NMb2Fk\nZXIgbG9hZGVyKSB7CiAgICAgICAgaWYgKGhpbnQgPT0gbnVsbCkKICAgICAg\nICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgaWYgKGhpbnQgaW5zdGFuY2Vv\nZiBBZ2dyZWdhdGVMaXN0ZW5lcltdKQogICAgICAgICAgICByZXR1cm4gKEFn\nZ3JlZ2F0ZUxpc3RlbmVyW10pIGhpbnQ7CiAgICAgICAgaWYgKGhpbnQgaW5z\ndGFuY2VvZiBBZ2dyZWdhdGVMaXN0ZW5lcikKICAgICAgICAgICAgcmV0dXJu\nIG5ldyBBZ2dyZWdhdGVMaXN0ZW5lcltdeyAoQWdncmVnYXRlTGlzdGVuZXIp\nIGhpbnQgfTsKICAgICAgICBpZiAoaGludCBpbnN0YW5jZW9mIENvbGxlY3Rp\nb24pIHsKICAgICAgICAgICAgQ29sbGVjdGlvbiBjID0gKENvbGxlY3Rpb24p\nIGhpbnQ7CiAgICAgICAgICAgIHJldHVybiAoQWdncmVnYXRlTGlzdGVuZXJb\nXSkgYy50b0FycmF5CiAgICAgICAgICAgICAgICAobmV3IEFnZ3JlZ2F0ZUxp\nc3RlbmVyW2Muc2l6ZSgpXSk7CiAgICAgICAgfQoKICAgICAgICBFeGNlcHRp\nb24gY2F1c2UgPSBudWxsOwogICAgICAgIGlmIChoaW50IGluc3RhbmNlb2Yg\nU3RyaW5nKSB7CiAgICAgICAgICAgIFN0cmluZ1tdIGNsc3MgPSBTdHJpbmdz\nLnNwbGl0KChTdHJpbmcpIGhpbnQsICIsIiwgMCk7CiAgICAgICAgICAgIEFn\nZ3JlZ2F0ZUxpc3RlbmVyW10gYWdncyA9IG5ldyBBZ2dyZWdhdGVMaXN0ZW5l\ncltjbHNzLmxlbmd0aF07CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAg\nICAgICBmb3IgKGludCBpID0gMDsgaSA8IGNsc3MubGVuZ3RoOyBpKyspCiAg\nICAgICAgICAgICAgICAgICAgYWdnc1tpXSA9IChBZ2dyZWdhdGVMaXN0ZW5l\ncikgQWNjZXNzQ29udHJvbGxlci5kb1ByaXZpbGVnZWQoCiAgICAgICAgICAg\nICAgICAgICAgICAgIEoyRG9Qcml2SGVscGVyLm5ld0luc3RhbmNlQWN0aW9u\nKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgQ2xhc3MuZm9yTmFtZShj\nbHNzW2ldLCB0cnVlLCBsb2FkZXIpKSk7IAogICAgICAgICAgICAgICAgcmV0\ndXJuIGFnZ3M7CiAgICAgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7\nCiAgICAgICAgICAgICAgICBpZiAoZSBpbnN0YW5jZW9mIFByaXZpbGVnZWRB\nY3Rpb25FeGNlcHRpb24pCiAgICAgICAgICAgICAgICAgICAgZSA9ICgoUHJp\ndmlsZWdlZEFjdGlvbkV4Y2VwdGlvbikgZSkuZ2V0RXhjZXB0aW9uKCk7CiAg\nICAgICAgICAgICAgICBjYXVzZSA9IGU7CiAgICAgICAgICAgIH0KICAgICAg\nICB9CiAgICAgICAgdGhyb3cgbmV3IFVzZXJFeGNlcHRpb24oX2xvYy5nZXQo\nImJhZC1hZ2ctbGlzdGVuZXItaGludCIsIGhpbnQsCiAgICAgICAgICAgIGhp\nbnQuZ2V0Q2xhc3MoKSkpLnNldENhdXNlKGNhdXNlKTsKICAgIH0KCiAgICAv\nKioKICAgICAqIENvbnZlcnQgdGhlIHVzZXItZ2l2ZW4gaGludCB2YWx1ZSB0\nbyBhIGZpbHRlciBsaXN0ZW5lci4KICAgICAqIFRoZSBoaW50IGNhbiBiZSBh\nIGZpbHRlciBsaXN0ZW5lciBpbnN0YW5jZSBvciBjbGFzcyBuYW1lLgogICAg\nICovCiAgICBwdWJsaWMgc3RhdGljIEZpbHRlckxpc3RlbmVyIGhpbnRUb0Zp\nbHRlckxpc3RlbmVyKE9iamVjdCBoaW50LAogICAgICAgIENsYXNzTG9hZGVy\nIGxvYWRlcikgewogICAgICAgIGlmIChoaW50ID09IG51bGwpCiAgICAgICAg\nICAgIHJldHVybiBudWxsOwogICAgICAgIGlmIChoaW50IGluc3RhbmNlb2Yg\nRmlsdGVyTGlzdGVuZXIpCiAgICAgICAgICAgIHJldHVybiAoRmlsdGVyTGlz\ndGVuZXIpIGhpbnQ7CgogICAgICAgIEV4Y2VwdGlvbiBjYXVzZSA9IG51bGw7\nCiAgICAgICAgaWYgKGhpbnQgaW5zdGFuY2VvZiBTdHJpbmcpIHsKICAgICAg\nICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIHJldHVybiAoRmlsdGVyTGlz\ndGVuZXIpIEFjY2Vzc0NvbnRyb2xsZXIuZG9Qcml2aWxlZ2VkKAogICAgICAg\nICAgICAgICAgICAgIEoyRG9Qcml2SGVscGVyLm5ld0luc3RhbmNlQWN0aW9u\nKAogICAgICAgICAgICAgICAgICAgICAgICBDbGFzcy5mb3JOYW1lKChTdHJp\nbmcpIGhpbnQsIHRydWUsIGxvYWRlcikpKTsgCiAgICAgICAgICAgIH0gY2F0\nY2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgICAgICBpZiAoZSBpbnN0\nYW5jZW9mIFByaXZpbGVnZWRBY3Rpb25FeGNlcHRpb24pCiAgICAgICAgICAg\nICAgICAgICAgZSA9ICgoUHJpdmlsZWdlZEFjdGlvbkV4Y2VwdGlvbikgZSku\nZ2V0RXhjZXB0aW9uKCk7CiAgICAgICAgICAgICAgICBjYXVzZSA9IGU7CiAg\nICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgdGhyb3cgbmV3IFVzZXJF\neGNlcHRpb24oX2xvYy5nZXQoImJhZC1maWx0ZXItbGlzdGVuZXItaGludCIs\nIGhpbnQsCiAgICAgICAgICAgIGhpbnQuZ2V0Q2xhc3MoKSkpLnNldENhdXNl\nKGNhdXNlKTsKICAgIH0KCiAgICAvKioKICAgICAqIENvbnZlcnQgdGhlIHVz\nZXItZ2l2ZW4gaGludCB2YWx1ZSB0byBhbiBhcnJheSBvZiBmaWx0ZXIgbGlz\ndGVuZXJzLgogICAgICogVGhlIGhpbnQgY2FuIGJlIGEgZmlsdGVyIGxpc3Rl\nbmVyLCBmaWx0ZXIgbGlzdGVuZXIgYXJyYXksCiAgICAgKiBjb2xsZWN0aW9u\nLCBvciBjb21tYS1zZXBhcmF0ZWQgY2xhc3MgbmFtZXMuCiAgICAgKi8KICAg\nIHB1YmxpYyBzdGF0aWMgRmlsdGVyTGlzdGVuZXJbXSBoaW50VG9GaWx0ZXJM\naXN0ZW5lcnMoT2JqZWN0IGhpbnQsCiAgICAgICAgQ2xhc3NMb2FkZXIgbG9h\nZGVyKSB7CiAgICAgICAgaWYgKGhpbnQgPT0gbnVsbCkKICAgICAgICAgICAg\ncmV0dXJuIG51bGw7CiAgICAgICAgaWYgKGhpbnQgaW5zdGFuY2VvZiBGaWx0\nZXJMaXN0ZW5lcltdKQogICAgICAgICAgICByZXR1cm4gKEZpbHRlckxpc3Rl\nbmVyW10pIGhpbnQ7CiAgICAgICAgaWYgKGhpbnQgaW5zdGFuY2VvZiBGaWx0\nZXJMaXN0ZW5lcikKICAgICAgICAgICAgcmV0dXJuIG5ldyBGaWx0ZXJMaXN0\nZW5lcltdeyAoRmlsdGVyTGlzdGVuZXIpIGhpbnQgfTsKICAgICAgICBpZiAo\naGludCBpbnN0YW5jZW9mIENvbGxlY3Rpb24pIHsKICAgICAgICAgICAgQ29s\nbGVjdGlvbiBjID0gKENvbGxlY3Rpb24pIGhpbnQ7CiAgICAgICAgICAgIHJl\ndHVybiAoRmlsdGVyTGlzdGVuZXJbXSkgYy50b0FycmF5KG5ldyBGaWx0ZXJM\naXN0ZW5lcltjLnNpemUoKV0pOwogICAgICAgIH0KCiAgICAgICAgRXhjZXB0\naW9uIGNhdXNlID0gbnVsbDsKICAgICAgICBpZiAoaGludCBpbnN0YW5jZW9m\nIFN0cmluZykgewogICAgICAgICAgICBTdHJpbmdbXSBjbHNzID0gU3RyaW5n\ncy5zcGxpdCgoU3RyaW5nKSBoaW50LCAiLCIsIDApOwogICAgICAgICAgICBG\naWx0ZXJMaXN0ZW5lcltdIGZpbHRzID0gbmV3IEZpbHRlckxpc3RlbmVyW2Ns\nc3MubGVuZ3RoXTsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAg\nIGZvciAoaW50IGkgPSAwOyBpIDwgY2xzcy5sZW5ndGg7IGkrKykKICAgICAg\nICAgICAgICAgICAgICBmaWx0c1tpXSA9IChGaWx0ZXJMaXN0ZW5lcikgQWNj\nZXNzQ29udHJvbGxlci5kb1ByaXZpbGVnZWQoCiAgICAgICAgICAgICAgICAg\nICAgICAgIEoyRG9Qcml2SGVscGVyLm5ld0luc3RhbmNlQWN0aW9uKAogICAg\nICAgICAgICAgICAgICAgICAgICAgICAgQ2xhc3MuZm9yTmFtZShjbHNzW2ld\nLCB0cnVlLCBsb2FkZXIpKSk7CiAgICAgICAgICAgICAgICByZXR1cm4gZmls\ndHM7CiAgICAgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAg\nICAgICAgICAgICBpZiAoZSBpbnN0YW5jZW9mIFByaXZpbGVnZWRBY3Rpb25F\neGNlcHRpb24pCiAgICAgICAgICAgICAgICAgICAgZSA9ICgoUHJpdmlsZWdl\nZEFjdGlvbkV4Y2VwdGlvbikgZSkuZ2V0RXhjZXB0aW9uKCk7CiAgICAgICAg\nICAgICAgICBjYXVzZSA9IGU7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAg\nICAgICAgdGhyb3cgbmV3IFVzZXJFeGNlcHRpb24oX2xvYy5nZXQoImJhZC1m\naWx0ZXItbGlzdGVuZXItaGludCIsIGhpbnQsCiAgICAgICAgICAgIGhpbnQu\nZ2V0Q2xhc3MoKSkpLnNldENhdXNlKGNhdXNlKTsKICAgIH0KCiAgICAvKioK\nICAgICAqIFJldHVybiB0aGUgdmFsdWUgb2YgdGhlIHByb3BlcnR5IG5hbWVk\nIGJ5IHRoZSBoaW50IGtleS4KICAgICAqLwogICAgcHVibGljIHN0YXRpYyBP\nYmplY3QgaGludFRvR2V0dGVyKE9iamVjdCB0YXJnZXQsIFN0cmluZyBoaW50\nS2V5KSB7CiAgICAgICAgaWYgKHRhcmdldCA9PSBudWxsIHx8IGhpbnRLZXkg\nPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIG51bGw7CgogICAgICAgIE1l\ndGhvZCBnZXR0ZXIgPSBSZWZsZWN0aW9uLmZpbmRHZXR0ZXIodGFyZ2V0Lmdl\ndENsYXNzKCksIGhpbnRLZXksIHRydWUpOwogICAgICAgIHJldHVybiBSZWZs\nZWN0aW9uLmdldCh0YXJnZXQsIGdldHRlcik7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBTZXQgdGhlIHZhbHVlIG9mIHRoZSBwcm9wZXJ0eSBuYW1lZCBieSB0\naGUgaGludCBrZXkuCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0aWMgdm9pZCBo\naW50VG9TZXR0ZXIoT2JqZWN0IHRhcmdldCwgU3RyaW5nIGhpbnRLZXksCiAg\nICAgICAgT2JqZWN0IHZhbHVlKSB7CiAgICAgICAgaWYgKHRhcmdldCA9PSBu\ndWxsIHx8IGhpbnRLZXkgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuOwoK\nICAgICAgICBNZXRob2Qgc2V0dGVyID0gUmVmbGVjdGlvbi5maW5kU2V0dGVy\nKHRhcmdldC5nZXRDbGFzcygpLCBoaW50S2V5LCB0cnVlKTsKICAgICAgICBp\nZiAodmFsdWUgaW5zdGFuY2VvZiBTdHJpbmcpIHsKICAgICAgICAgICAgaWYg\nKCJudWxsIi5lcXVhbHModmFsdWUpKQogICAgICAgICAgICAgICAgdmFsdWUg\nPSBudWxsOwogICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgIHRy\neSB7CiAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBTdHJpbmdzLnBhcnNl\nKChTdHJpbmcpIHZhbHVlLAogICAgICAgICAgICAgICAgICAgICAgICBzZXR0\nZXIuZ2V0UGFyYW1ldGVyVHlwZXMoKVswXSk7CiAgICAgICAgICAgICAgICB9\nIGNhdGNoIChFeGNlcHRpb24gZSkgewogICAgICAgICAgICAgICAgICAgIHRo\ncm93IG5ldyBVc2VyRXhjZXB0aW9uKF9sb2MuZ2V0KCJiYWQtc2V0dGVyLWhp\nbnQtYXJnIiwKICAgICAgICAgICAgICAgICAgICAgICAgaGludEtleSwgdmFs\ndWUsIHNldHRlci5nZXRQYXJhbWV0ZXJUeXBlcygpWzBdKSkuCiAgICAgICAg\nICAgICAgICAgICAgICAgIHNldENhdXNlKGUpOwogICAgICAgICAgICAgICAg\nfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIFJlZmxlY3Rpb24u\nc2V0KHRhcmdldCwgc2V0dGVyLCB2YWx1ZSk7Cgl9Cn0K\n","encoding":"base64"}

