{"sha":"7b3233a7e5335b6227aecd3ad8aabca795a3647c","node_id":"MDQ6QmxvYjIwNjM2NDo3YjMyMzNhN2U1MzM1YjYyMjdhZWNkM2FkOGFhYmNhNzk1YTM2NDdj","size":9288,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/7b3233a7e5335b6227aecd3ad8aabca795a3647c","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsOwoKaW1wb3J0IGph\ndmEudXRpbC5CaXRTZXQ7CgppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1l\ndGEuQ2xhc3NNZXRhRGF0YTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5t\nZXRhLkZpZWxkTWV0YURhdGE7CgovKioKICogRGVmYXVsdCB7QGxpbmsgUENE\nYXRhfSBpbXBsZW1lbnRhdGlvbi4KICoKICogQGF1dGhvciBQYXRyaWNrIExp\nbnNrZXkKICogQGF1dGhvciBBYmUgV2hpdGUKICogQG5vamF2YWRvYwogKi8K\ncHVibGljIGNsYXNzIFBDRGF0YUltcGwKICAgIGV4dGVuZHMgQWJzdHJhY3RQ\nQ0RhdGEgewoKICAgIHByaXZhdGUgZmluYWwgT2JqZWN0IF9vaWQ7CiAgICBw\ncml2YXRlIGZpbmFsIENsYXNzIF90eXBlOwogICAgcHJpdmF0ZSBmaW5hbCBP\nYmplY3RbXSBfZGF0YTsKICAgIHByaXZhdGUgZmluYWwgQml0U2V0IF9sb2Fk\nZWQ7CiAgICBwcml2YXRlIE9iamVjdCBfdmVyc2lvbiA9IG51bGw7CiAgICBw\ncml2YXRlIE9iamVjdCBfaW1wbCA9IG51bGw7CiAgICBwcml2YXRlIE9iamVj\ndFtdIF9maWVsZEltcGwgPSBudWxsOwoKICAgIC8qKgogICAgICogQ29uc3Ry\ndWN0b3IuCiAgICAgKi8KICAgIHB1YmxpYyBQQ0RhdGFJbXBsKE9iamVjdCBv\naWQsIENsYXNzTWV0YURhdGEgbWV0YSkgewogICAgICAgIF9vaWQgPSBvaWQ7\nCiAgICAgICAgX3R5cGUgPSBtZXRhLmdldERlc2NyaWJlZFR5cGUoKTsKCiAg\nICAgICAgaW50IGxlbiA9IG1ldGEuZ2V0RmllbGRzKCkubGVuZ3RoOwogICAg\nICAgIF9kYXRhID0gbmV3IE9iamVjdFtsZW5dOwogICAgICAgIF9sb2FkZWQg\nPSBuZXcgQml0U2V0KGxlbik7CiAgICB9CgogICAgcHVibGljIE9iamVjdCBn\nZXRJZCgpIHsKICAgICAgICByZXR1cm4gX29pZDsKICAgIH0KCiAgICBwdWJs\naWMgQ2xhc3MgZ2V0VHlwZSgpIHsKICAgICAgICByZXR1cm4gX3R5cGU7CiAg\nICB9CgogICAgcHVibGljIEJpdFNldCBnZXRMb2FkZWQoKSB7CiAgICAgICAg\ncmV0dXJuIF9sb2FkZWQ7CiAgICB9CgogICAgcHVibGljIE9iamVjdCBnZXRE\nYXRhKGludCBpbmRleCkgewogICAgICAgIC8vIG1ha2Ugc3VyZSBpbmRleCBp\ncyBhY3R1YWxseSBsb2FkZWQgdG8gYXZvaWQgcmV0dXJuaW5nIGFuCiAgICAg\nICAgLy8gaW50ZXJtZWRpYXRlIHZhbHVlCiAgICAgICAgcmV0dXJuIChfbG9h\nZGVkLmdldChpbmRleCkpID8gX2RhdGFbaW5kZXhdIDogbnVsbDsKICAgIH0K\nCiAgICBwdWJsaWMgdm9pZCBzZXREYXRhKGludCBpbmRleCwgT2JqZWN0IHZh\nbCkgewogICAgICAgIF9sb2FkZWQuc2V0KGluZGV4KTsKICAgICAgICBfZGF0\nYVtpbmRleF0gPSB2YWw7CiAgICB9CgogICAgcHVibGljIHZvaWQgY2xlYXJE\nYXRhKGludCBpbmRleCkgewogICAgICAgIF9sb2FkZWQuY2xlYXIoaW5kZXgp\nOwogICAgICAgIF9kYXRhW2luZGV4XSA9IG51bGw7CiAgICB9CgogICAgcHVi\nbGljIE9iamVjdCBnZXRJbXBsRGF0YSgpIHsKICAgICAgICByZXR1cm4gX2lt\ncGw7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0SW1wbERhdGEoT2JqZWN0\nIHZhbCkgewogICAgICAgIF9pbXBsID0gdmFsOwogICAgfQoKICAgIHB1Ymxp\nYyBPYmplY3QgZ2V0SW1wbERhdGEoaW50IGluZGV4KSB7CiAgICAgICAgcmV0\ndXJuIChfZmllbGRJbXBsICE9IG51bGwpID8gX2ZpZWxkSW1wbFtpbmRleF0g\nOiBudWxsOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldEltcGxEYXRhKGlu\ndCBpbmRleCwgT2JqZWN0IHZhbCkgewogICAgICAgIGlmICh2YWwgIT0gbnVs\nbCkgewogICAgICAgICAgICBpZiAoX2ZpZWxkSW1wbCA9PSBudWxsKQogICAg\nICAgICAgICAgICAgX2ZpZWxkSW1wbCA9IG5ldyBPYmplY3RbX2RhdGEubGVu\nZ3RoXTsKICAgICAgICAgICAgX2ZpZWxkSW1wbFtpbmRleF0gPSB2YWw7CiAg\nICAgICAgfSBlbHNlIGlmIChfZmllbGRJbXBsICE9IG51bGwpCiAgICAgICAg\nICAgIF9maWVsZEltcGxbaW5kZXhdID0gbnVsbDsKICAgIH0KCiAgICBwdWJs\naWMgT2JqZWN0IGdldEludGVybWVkaWF0ZShpbnQgaW5kZXgpIHsKICAgICAg\nICByZXR1cm4gKCFfbG9hZGVkLmdldChpbmRleCkpID8gX2RhdGFbaW5kZXhd\nIDogbnVsbDsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRJbnRlcm1lZGlh\ndGUoaW50IGluZGV4LCBPYmplY3QgdmFsKSB7CiAgICAgICAgX2xvYWRlZC5j\nbGVhcihpbmRleCk7CiAgICAgICAgX2RhdGFbaW5kZXhdID0gdmFsOwogICAg\nfQoKICAgIHB1YmxpYyBib29sZWFuIGlzTG9hZGVkKGludCBpbmRleCkgewog\nICAgICAgIHJldHVybiBfbG9hZGVkLmdldChpbmRleCk7CiAgICB9CgogICAg\ncHVibGljIHZvaWQgc2V0TG9hZGVkKGludCBpbmRleCwgYm9vbGVhbiBsb2Fk\nZWQpIHsKICAgICAgICBpZiAobG9hZGVkKQogICAgICAgICAgICBfbG9hZGVk\nLnNldChpbmRleCk7CiAgICAgICAgZWxzZQogICAgICAgICAgICBfbG9hZGVk\nLmNsZWFyKGluZGV4KTsKICAgIH0KCiAgICBwdWJsaWMgT2JqZWN0IGdldFZl\ncnNpb24oKSB7CiAgICAgICAgcmV0dXJuIF92ZXJzaW9uOwogICAgfQoKICAg\nIHB1YmxpYyB2b2lkIHNldFZlcnNpb24oT2JqZWN0IHZlcnNpb24pIHsKICAg\nICAgICBfdmVyc2lvbiA9IHZlcnNpb247CiAgICB9CgogICAgcHVibGljIHZv\naWQgbG9hZChPcGVuSlBBU3RhdGVNYW5hZ2VyIHNtLCBGZXRjaENvbmZpZ3Vy\nYXRpb24gZmV0Y2gsCiAgICAgICAgT2JqZWN0IGNvbnRleHQpIHsKICAgICAg\nICBsb2FkVmVyc2lvbihzbSk7CiAgICAgICAgbG9hZEltcGxEYXRhKHNtKTsK\nCiAgICAgICAgRmllbGRNZXRhRGF0YVtdIGZtZHMgPSBzbS5nZXRNZXRhRGF0\nYSgpLmdldEZpZWxkcygpOwogICAgICAgICgoU3RhdGVNYW5hZ2VySW1wbClz\nbSkuc2V0TG9hZGluZyh0cnVlKTsKICAgICAgICBmb3IgKGludCBpID0gMDsg\naSA8IGZtZHMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgLy8gbG9hZCBp\nbnRlcm1lZGlhdGUgZGF0YSBmb3IgYWxsIHVubG9hZGVkIGZpZWxkcyBhbmQg\nZGF0YSBmb3IKICAgICAgICAgICAgLy8gZmllbGRzIGluIGNvbmZpZ3VyZWQg\nZmV0Y2ggZ3JvdXBzCiAgICAgICAgICAgIGlmICghaXNMb2FkZWQoaSkpCiAg\nICAgICAgICAgICAgICBsb2FkSW50ZXJtZWRpYXRlKHNtLCBmbWRzW2ldKTsK\nICAgICAgICAgICAgZWxzZSBpZiAoIXNtLmdldExvYWRlZCgpLmdldChpKSAm\nJiBmZXRjaC5yZXF1aXJlc0ZldGNoKGZtZHNbaV0pIAogICAgICAgICAgICAg\nICAgIT0gRmV0Y2hDb25maWd1cmF0aW9uLkZFVENIX05PTkUpCiAgICAgICAg\nICAgICAgICBsb2FkRmllbGQoc20sIGZtZHNbaV0sIGZldGNoLCBjb250ZXh0\nKTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGljIHZvaWQgbG9hZChPcGVu\nSlBBU3RhdGVNYW5hZ2VyIHNtLCBCaXRTZXQgZmllbGRzLAogICAgICAgIEZl\ndGNoQ29uZmlndXJhdGlvbiBmZXRjaCwgT2JqZWN0IGNvbnRleHQpIHsKICAg\nICAgICBsb2FkVmVyc2lvbihzbSk7CiAgICAgICAgbG9hZEltcGxEYXRhKHNt\nKTsKCiAgICAgICAgLy8gYXR0ZW1wdCB0byBsb2FkIGdpdmVuIGZpZWxkcwog\nICAgICAgIGludCBsZW4gPSAoZmllbGRzID09IG51bGwpID8gMCA6IGZpZWxk\ncy5sZW5ndGgoKTsKICAgICAgICBGaWVsZE1ldGFEYXRhIGZtZDsKICAgICAg\nICBmb3IgKGludCBpID0gMDsgaSA8IGxlbjsgaSsrKSB7CiAgICAgICAgICAg\nIGlmICghZmllbGRzLmdldChpKSkKICAgICAgICAgICAgICAgIGNvbnRpbnVl\nOwoKICAgICAgICAgICAgZm1kID0gc20uZ2V0TWV0YURhdGEoKS5nZXRGaWVs\nZChpKTsKICAgICAgICAgICAgaWYgKCFpc0xvYWRlZChpKSkKICAgICAgICAg\nICAgICAgIGxvYWRJbnRlcm1lZGlhdGUoc20sIGZtZCk7CiAgICAgICAgICAg\nIGVsc2UgewogICAgICAgICAgICAgICAgbG9hZEZpZWxkKHNtLCBmbWQsIGZl\ndGNoLCBjb250ZXh0KTsKICAgICAgICAgICAgICAgIGxvYWRJbXBsRGF0YShz\nbSwgZm1kKTsKICAgICAgICAgICAgICAgIGZpZWxkcy5jbGVhcihpKTsKICAg\nICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIFNl\ndCB2ZXJzaW9uIGluZm9ybWF0aW9uIGludG8gdGhlIGdpdmVuIHN0YXRlIG1h\nbmFnZXIuCiAgICAgKi8KICAgIHByb3RlY3RlZCB2b2lkIGxvYWRWZXJzaW9u\nKE9wZW5KUEFTdGF0ZU1hbmFnZXIgc20pIHsKICAgICAgICBpZiAoc20uZ2V0\nVmVyc2lvbigpID09IG51bGwpCiAgICAgICAgICAgIHNtLnNldFZlcnNpb24o\nZ2V0VmVyc2lvbigpKTsKICAgIH0KCiAgICAvKioKICAgICAqIFNldCBpbXBs\nIGRhdGEgaW5mb3JtYXRpb24gaW50byB0aGUgZ2l2ZW4gc3RhdGUgbWFuYWdl\nci4KICAgICAqLwogICAgcHJvdGVjdGVkIHZvaWQgbG9hZEltcGxEYXRhKE9w\nZW5KUEFTdGF0ZU1hbmFnZXIgc20pIHsKICAgICAgICBPYmplY3QgaW1wbCA9\nIGdldEltcGxEYXRhKCk7CiAgICAgICAgaWYgKHNtLmdldEltcGxEYXRhKCkg\nPT0gbnVsbCAmJiBpbXBsICE9IG51bGwpCiAgICAgICAgICAgIHNtLnNldElt\ncGxEYXRhKGltcGwsIHRydWUpOwogICAgfQoKICAgIC8qKgogICAgICogU2V0\nIGZpZWxkLWxldmVsIGluZm9ybWF0aW9uIGludG8gdGhlIGdpdmVuIHN0YXRl\nIG1hbmFnZXIuCiAgICAgKi8KICAgIHByb3RlY3RlZCB2b2lkIGxvYWRGaWVs\nZChPcGVuSlBBU3RhdGVNYW5hZ2VyIHNtLCBGaWVsZE1ldGFEYXRhIGZtZCwK\nICAgICAgICBGZXRjaENvbmZpZ3VyYXRpb24gZmV0Y2gsIE9iamVjdCBjb250\nZXh0KSB7CiAgICAgICAgaW50IGluZGV4ID0gZm1kLmdldEluZGV4KCk7CiAg\nICAgICAgT2JqZWN0IHZhbCA9IHRvRmllbGQoc20sIGZtZCwgZ2V0RGF0YShp\nbmRleCksIGZldGNoLCBjb250ZXh0KTsKICAgICAgICBzbS5zdG9yZUZpZWxk\nKGluZGV4LCB2YWwpOwogICAgfQoKICAgIC8qKgogICAgICogU2V0IGZpZWxk\nLWxldmVsIGltcGwgZGF0YSBpbnRvIHRoZSBnaXZlbiBzdGF0ZSBtYW5hZ2Vy\nLgogICAgICovCiAgICBwcm90ZWN0ZWQgdm9pZCBsb2FkSW1wbERhdGEoT3Bl\nbkpQQVN0YXRlTWFuYWdlciBzbSwgRmllbGRNZXRhRGF0YSBmbWQpIHsKICAg\nICAgICBpbnQgaW5kZXggPSBmbWQuZ2V0SW5kZXgoKTsKICAgICAgICBPYmpl\nY3QgaW1wbCA9IGdldEltcGxEYXRhKGluZGV4KTsKICAgICAgICBpZiAoaW1w\nbCAhPSBudWxsKQogICAgICAgICAgICBzbS5zZXRJbXBsRGF0YShpbmRleCwg\naW1wbCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBTZXQgaW50ZXJtZWRpYXRl\nIGluZm9ybWF0aW9uIGZvciB0aGUgZ2l2ZW4gZmllbGQgaW50byB0aGUgc3Rh\ndGUgbWFuYWdlci4KICAgICAqLwogICAgcHJvdGVjdGVkIHZvaWQgbG9hZElu\ndGVybWVkaWF0ZShPcGVuSlBBU3RhdGVNYW5hZ2VyIHNtLCBGaWVsZE1ldGFE\nYXRhIGZtZCkgewogICAgICAgIGludCBpbmRleCA9IGZtZC5nZXRJbmRleCgp\nOwogICAgICAgIE9iamVjdCBpbnRlciA9IGdldEludGVybWVkaWF0ZShpbmRl\neCk7CiAgICAgICAgaWYgKGludGVyICE9IG51bGwgJiYgIXNtLmdldExvYWRl\nZCgpLmdldChpbmRleCkpCiAgICAgICAgICAgIHNtLnNldEludGVybWVkaWF0\nZShpbmRleCwgaW50ZXIpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHN0b3Jl\nKE9wZW5KUEFTdGF0ZU1hbmFnZXIgc20pIHsKICAgICAgICBzdG9yZVZlcnNp\nb24oc20pOwogICAgICAgIHN0b3JlSW1wbERhdGEoc20pOwoKICAgICAgICBG\naWVsZE1ldGFEYXRhW10gZm1kcyA9IHNtLmdldE1ldGFEYXRhKCkuZ2V0Rmll\nbGRzKCk7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBmbWRzLmxlbmd0\naDsgaSsrKSB7CiAgICAgICAgICAgIGlmIChzbS5nZXRMb2FkZWQoKS5nZXQo\naSkpIHsKICAgICAgICAgICAgICAgIHN0b3JlRmllbGQoc20sIGZtZHNbaV0p\nOwogICAgICAgICAgICAgICAgc3RvcmVJbXBsRGF0YShzbSwgZm1kc1tpXSwg\naXNMb2FkZWQoaSkpOwogICAgICAgICAgICB9IGVsc2UgaWYgKCFpc0xvYWRl\nZChpKSkKICAgICAgICAgICAgICAgIHN0b3JlSW50ZXJtZWRpYXRlKHNtLCBm\nbWRzW2ldKTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGljIHZvaWQgc3Rv\ncmUoT3BlbkpQQVN0YXRlTWFuYWdlciBzbSwgQml0U2V0IGZpZWxkcykgewog\nICAgICAgIHN0b3JlVmVyc2lvbihzbSk7CiAgICAgICAgc3RvcmVJbXBsRGF0\nYShzbSk7CgogICAgICAgIEZpZWxkTWV0YURhdGFbXSBmbWRzID0gc20uZ2V0\nTWV0YURhdGEoKS5nZXRGaWVsZHMoKTsKICAgICAgICBmb3IgKGludCBpID0g\nMDsgaSA8IGZtZHMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgaWYgKGZp\nZWxkcyAhPSBudWxsICYmIGZpZWxkcy5nZXQoaSkpIHsKICAgICAgICAgICAg\nICAgIHN0b3JlRmllbGQoc20sIGZtZHNbaV0pOwogICAgICAgICAgICAgICAg\nc3RvcmVJbXBsRGF0YShzbSwgZm1kc1tpXSwgaXNMb2FkZWQoaSkpOwogICAg\nICAgICAgICB9IGVsc2UgaWYgKCFpc0xvYWRlZChpKSkKICAgICAgICAgICAg\nICAgIHN0b3JlSW50ZXJtZWRpYXRlKHNtLCBmbWRzW2ldKTsKICAgICAgICB9\nCiAgICB9CgogICAgLyoqCiAgICAgKiBTdG9yZSB2ZXJzaW9uIGluZm9ybWF0\naW9uIGZyb20gdGhlIGdpdmVuIHN0YXRlIG1hbmFnZXIuCiAgICAgKi8KICAg\nIHByb3RlY3RlZCB2b2lkIHN0b3JlVmVyc2lvbihPcGVuSlBBU3RhdGVNYW5h\nZ2VyIHNtKSB7CiAgICAgICAgc2V0VmVyc2lvbihzbS5nZXRWZXJzaW9uKCkp\nOwogICAgfQoKICAgIC8qKgogICAgICogU3RvcmUgaW1wbCBkYXRhIGZyb20g\ndGhlIGdpdmVuIHN0YXRlIG1hbmFnZXIuCiAgICAgKi8KICAgIHByb3RlY3Rl\nZCB2b2lkIHN0b3JlSW1wbERhdGEoT3BlbkpQQVN0YXRlTWFuYWdlciBzbSkg\newogICAgICAgIGlmIChzbS5pc0ltcGxEYXRhQ2FjaGVhYmxlKCkpCiAgICAg\nICAgICAgIHNldEltcGxEYXRhKHNtLmdldEltcGxEYXRhKCkpOwogICAgfQoK\nICAgIC8qKgogICAgICogU3RvcmUgZmllbGQtbGV2ZWwgaW5mb3JtYXRpb24g\nZnJvbSB0aGUgZ2l2ZW4gc3RhdGUgbWFuYWdlci4KICAgICAqLwogICAgcHJv\ndGVjdGVkIHZvaWQgc3RvcmVGaWVsZChPcGVuSlBBU3RhdGVNYW5hZ2VyIHNt\nLCBGaWVsZE1ldGFEYXRhIGZtZCkgewogICAgICAgIGlmIChmbWQuZ2V0TWFu\nYWdlbWVudCgpICE9IGZtZC5NQU5BR0VfUEVSU0lTVEVOVCkKICAgICAgICAg\nICAgcmV0dXJuOwoKICAgICAgICBpbnQgaW5kZXggPSBmbWQuZ2V0SW5kZXgo\nKTsKICAgICAgICBPYmplY3QgdmFsID0gdG9EYXRhKGZtZCwgc20uZmV0Y2hG\naWVsZChpbmRleCwgZmFsc2UpLAogICAgICAgICAgICBzbS5nZXRDb250ZXh0\nKCkpOwogICAgICAgIGlmICh2YWwgIT0gTlVMTCkKICAgICAgICAgICAgc2V0\nRGF0YShpbmRleCwgdmFsKTsKICAgICAgICBlbHNlIC8vIHVuYWJsZSB0byBz\ndG9yZSBmaWVsZCB2YWx1ZTsgY2xlYXIgb3V0IGFueSBvbGQgdmFsdWVzCiAg\nICAgICAgICAgIGNsZWFyRGF0YShpbmRleCk7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBTdG9yZSB0aGUgaW50ZXJtZWRpYXRlIGZpZWxkIHZhbHVlIGZvciB0\naGUgZ2l2ZW4gZmllbGQuCiAgICAgKi8KICAgIHByb3RlY3RlZCB2b2lkIHN0\nb3JlSW50ZXJtZWRpYXRlKE9wZW5KUEFTdGF0ZU1hbmFnZXIgc20sCiAgICAg\nICAgRmllbGRNZXRhRGF0YSBmbWQpIHsKICAgICAgICBpbnQgaW5kZXggPSBm\nbWQuZ2V0SW5kZXgoKTsKICAgICAgICBPYmplY3QgdmFsID0gc20uZ2V0SW50\nZXJtZWRpYXRlKGluZGV4KTsKICAgICAgICBpZiAodmFsICE9IG51bGwpCiAg\nICAgICAgICAgIHNldEludGVybWVkaWF0ZShpbmRleCwgdmFsKTsKICAgIH0K\nCiAgICAvKioKICAgICAqIFN0b3JlIGltcGwgZGF0YSBmb3IgdGhlIGdpdmVu\nIGZpZWxkLgogICAgICovCiAgICBwcm90ZWN0ZWQgdm9pZCBzdG9yZUltcGxE\nYXRhKE9wZW5KUEFTdGF0ZU1hbmFnZXIgc20sIEZpZWxkTWV0YURhdGEgZm1k\nLAogICAgICAgIGJvb2xlYW4gZmllbGRMb2FkZWQpIHsKICAgICAgICBpbnQg\naW5kZXggPSBmbWQuZ2V0SW5kZXgoKTsKICAgICAgICBpZiAoZmllbGRMb2Fk\nZWQpIHsKICAgICAgICAgICAgLy8gaXMgdGhlcmUgaW1wbCBkYXRhIHRvIHN0\nb3JlPwogICAgICAgICAgICBPYmplY3QgaW1wbCA9IHNtLmdldEltcGxEYXRh\nKGluZGV4KTsKICAgICAgICAgICAgaWYgKGltcGwgIT0gbnVsbCAmJiBzbS5p\nc0ltcGxEYXRhQ2FjaGVhYmxlKGluZGV4KSkKICAgICAgICAgICAgICAgIHNl\ndEltcGxEYXRhKGluZGV4LCBpbXBsKTsKICAgICAgICB9IGVsc2UKICAgICAg\nICAgICAgc2V0SW1wbERhdGEoaW5kZXgsIG51bGwpOwogICAgfQoKICAgIC8q\nKgogICAgICogUmV0dXJuIGEgbmV3IHtAbGluayBQQ0RhdGF9IGltcGxlbWVu\ndGF0aW9uIG9mIHRoZSByaWdodCB0eXBlIGZvcgogICAgICogZW1iZWRkZWQg\naW5zdGFuY2VzLiBSZXR1cm5zIGEge0BsaW5rIFBDRGF0YUltcGx9IGJ5IGRl\nZmF1bHQuCiAgICAgKi8KICAgIHB1YmxpYyBBYnN0cmFjdFBDRGF0YSBuZXdF\nbWJlZGRlZFBDRGF0YShPcGVuSlBBU3RhdGVNYW5hZ2VyIHNtKSB7CiAgICAg\nICAgcmV0dXJuIG5ldyBQQ0RhdGFJbXBsKHNtLmdldElkICgpLCBzbS5nZXRN\nZXRhRGF0YSAoKSk7Cgl9Cn0K\n","encoding":"base64"}

