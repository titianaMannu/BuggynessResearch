{"sha":"8d89e01e52f9fc0dd374f75b38b3031de96d0ff0","node_id":"MDQ6QmxvYjIwNjM2NDo4ZDg5ZTAxZTUyZjlmYzBkZDM3NGY3NWIzOGIzMDMxZGU5NmQwZmYw","size":6236,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/8d89e01e52f9fc0dd374f75b38b3031de96d0ff0","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLmV4cHM7CgppbXBv\ncnQgamF2YS51dGlsLkl0ZXJhdG9yOwppbXBvcnQgamF2YS51dGlsLkxpbmtl\nZExpc3Q7CmltcG9ydCBqYXZhLnV0aWwuTGlzdEl0ZXJhdG9yOwoKaW1wb3J0\nIG9yZy5hcGFjaGUuY29tbW9ucy5sYW5nLk9iamVjdFV0aWxzOwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5Ccm9rZXI7CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEua2VybmVsLkZpbHRlcnM7CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEua2VybmVsLk9wZW5KUEFTdGF0ZU1hbmFnZXI7CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLlN0b3JlQ29udGV4dDsKaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRhLkNsYXNzTWV0YURhdGE7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YS5GaWVsZE1ldGFEYXRhOwpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuWE1MTWV0YURhdGE7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5JbXBsSGVscGVyOwoKLyoq\nCiAqIEEgcGF0aCByZXByZXNlbnRzIGEgdHJhdmVyc2FsIGludG8gZmllbGRz\nIG9mIGEgY2FuZGlkYXRlIG9iamVjdC4KICoKICogQGF1dGhvciBBYmUgV2hp\ndGUKICovCmNsYXNzIENhbmRpZGF0ZVBhdGgKICAgIGV4dGVuZHMgVmFsCiAg\nICBpbXBsZW1lbnRzIFBhdGggewoKICAgIHByaXZhdGUgTGlua2VkTGlzdCBf\nYWN0aW9ucyA9IG51bGw7CgogICAgLyoqCiAgICAgKiBUcmF2ZXJzZSBpbnRv\nIHRoZSBnaXZlbiBmaWVsZCBvZiB0aGUgY3VycmVudCBvYmplY3QsIGFuZCB1\ncGRhdGUKICAgICAqIHRoZSBjdXJyZW50IG9iamVjdCB0byB0aGF0IGZpZWxk\nIHZhbHVlLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBnZXQoRmllbGRNZXRh\nRGF0YSBmaWVsZCwgYm9vbGVhbiBudWxsVHJhdmVyc2FsKSB7CiAgICAgICAg\naWYgKF9hY3Rpb25zID09IG51bGwpCiAgICAgICAgICAgIF9hY3Rpb25zID0g\nbmV3IExpbmtlZExpc3QoKTsKICAgICAgICBfYWN0aW9ucy5hZGQobmV3IFRy\nYXZlcnNhbChmaWVsZCwgbnVsbFRyYXZlcnNhbCkpOwogICAgfQoKICAgIHB1\nYmxpYyBDbGFzcyBnZXRUeXBlKCkgewogICAgICAgIGlmIChfYWN0aW9ucyA9\nPSBudWxsKQogICAgICAgICAgICByZXR1cm4gZ2V0Q2FuZGlkYXRlVHlwZSgp\nOwoKICAgICAgICBPYmplY3QgbGFzdCA9IF9hY3Rpb25zLmdldExhc3QoKTsK\nICAgICAgICBpZiAobGFzdCBpbnN0YW5jZW9mIENsYXNzKQogICAgICAgICAg\nICByZXR1cm4gKENsYXNzKSBsYXN0OwogICAgICAgIEZpZWxkTWV0YURhdGEg\nZm1kID0gKChUcmF2ZXJzYWwpIGxhc3QpLmZpZWxkOwogICAgICAgIHJldHVy\nbiBmbWQuZ2V0RGVjbGFyZWRUeXBlKCk7CiAgICB9CgogICAgcHJvdGVjdGVk\nIENsYXNzIGdldENhbmRpZGF0ZVR5cGUoKSB7CiAgICAgICAgQ2xhc3NNZXRh\nRGF0YSBtZXRhID0gZ2V0TWV0YURhdGEoKTsKICAgICAgICBpZiAobWV0YSA9\nPSBudWxsKQogICAgICAgICAgICByZXR1cm4gT2JqZWN0LmNsYXNzOwogICAg\nICAgIHJldHVybiBtZXRhLmdldERlc2NyaWJlZFR5cGUoKTsKICAgIH0KCiAg\nICBwdWJsaWMgdm9pZCBzZXRJbXBsaWNpdFR5cGUoQ2xhc3MgdHlwZSkgewog\nICAgfQoKICAgIHB1YmxpYyBGaWVsZE1ldGFEYXRhIGxhc3QoKSB7CiAgICAg\nICAgaWYgKF9hY3Rpb25zID09IG51bGwpCiAgICAgICAgICAgIHJldHVybiBu\ndWxsOwoKICAgICAgICBMaXN0SXRlcmF0b3IgaXRyID0gX2FjdGlvbnMubGlz\ndEl0ZXJhdG9yKF9hY3Rpb25zLnNpemUoKSk7CiAgICAgICAgT2JqZWN0IHBy\nZXY7CiAgICAgICAgd2hpbGUgKGl0ci5oYXNQcmV2aW91cygpKSB7CiAgICAg\nICAgICAgIHByZXYgPSBpdHIucHJldmlvdXMoKTsKICAgICAgICAgICAgaWYg\nKHByZXYgaW5zdGFuY2VvZiBUcmF2ZXJzYWwpCiAgICAgICAgICAgICAgICBy\nZXR1cm4gKChUcmF2ZXJzYWwpIHByZXYpLmZpZWxkOwogICAgICAgIH0KICAg\nICAgICByZXR1cm4gbnVsbDsKICAgIH0KCiAgICAvKioKICAgICAqIENhc3Qg\ndGhpcyBwYXRoIHRvIHRoZSBnaXZlbiB0eXBlLgogICAgICovCiAgICBwdWJs\naWMgdm9pZCBjYXN0VG8oQ2xhc3MgdHlwZSkgewogICAgICAgIGlmIChfYWN0\naW9ucyA9PSBudWxsKQogICAgICAgICAgICBfYWN0aW9ucyA9IG5ldyBMaW5r\nZWRMaXN0KCk7CiAgICAgICAgX2FjdGlvbnMuYWRkKHR5cGUpOwogICAgfQoK\nICAgIHByb3RlY3RlZCBPYmplY3QgZXZhbChPYmplY3QgY2FuZGlkYXRlLCBP\nYmplY3Qgb3JpZywKICAgICAgICBTdG9yZUNvbnRleHQgY3R4LCBPYmplY3Rb\nXSBwYXJhbXMpIHsKICAgICAgICBpZiAoX2FjdGlvbnMgPT0gbnVsbCkKICAg\nICAgICAgICAgcmV0dXJuIGNhbmRpZGF0ZTsKCiAgICAgICAgT2JqZWN0IGFj\ndGlvbjsKICAgICAgICBPcGVuSlBBU3RhdGVNYW5hZ2VyIHNtOwogICAgICAg\nIEJyb2tlciB0bXBCcm9rZXIgPSBudWxsOwogICAgICAgIGZvciAoSXRlcmF0\nb3IgaXRyID0gX2FjdGlvbnMuaXRlcmF0b3IoKTsgaXRyLmhhc05leHQoKTsp\nIHsKICAgICAgICAgICAgYWN0aW9uID0gaXRyLm5leHQoKTsKCiAgICAgICAg\nICAgIC8vIGZhaWwgb24gbnVsbCB2YWx1ZQogICAgICAgICAgICBpZiAoY2Fu\nZGlkYXRlID09IG51bGwpIHsKICAgICAgICAgICAgICAgIGlmIChhY3Rpb24g\naW5zdGFuY2VvZiBUcmF2ZXJzYWwKICAgICAgICAgICAgICAgICAgICAmJiAo\nKFRyYXZlcnNhbCkgYWN0aW9uKS5udWxsVHJhdmVyc2FsKQogICAgICAgICAg\nICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgICAgICAgICAgdGhyb3cg\nbmV3IE51bGxQb2ludGVyRXhjZXB0aW9uKCk7CiAgICAgICAgICAgIH0KCiAg\nICAgICAgICAgIC8vIGNoZWNrIHRoYXQgdGhlIGNhc3QgaXMgdmFsaWQKICAg\nICAgICAgICAgaWYgKGFjdGlvbiBpbnN0YW5jZW9mIENsYXNzKSB7CiAgICAg\nICAgICAgICAgICBjYW5kaWRhdGUgPSBGaWx0ZXJzLmNvbnZlcnQoY2FuZGlk\nYXRlLCAoQ2xhc3MpIGFjdGlvbik7CiAgICAgICAgICAgICAgICBjb250aW51\nZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gbWFrZSBzdXJlIHdl\nIGNhbiBhY2Nlc3MgdGhlIGluc3RhbmNlOyBldmVuIG5vbi1wYyB2YWxzIG1p\nZ2h0CiAgICAgICAgICAgIC8vIGJlIHByb3h5YWJsZQogICAgICAgICAgICBz\nbSA9IG51bGw7CiAgICAgICAgICAgIHRtcEJyb2tlciA9IG51bGw7CiAgICAg\nICAgICAgIGlmIChJbXBsSGVscGVyLmlzTWFuYWdlYWJsZShjYW5kaWRhdGUp\nKQogICAgICAgICAgICAgICAgc20gPSAoT3BlbkpQQVN0YXRlTWFuYWdlcikg\nKEltcGxIZWxwZXIudG9QZXJzaXN0ZW5jZUNhcGFibGUoCiAgICAgICAgICAg\nICAgICAgICAgY2FuZGlkYXRlLCBjdHguZ2V0Q29uZmlndXJhdGlvbigpKSku\nCiAgICAgICAgICAgICAgICAgICAgcGNHZXRTdGF0ZU1hbmFnZXIoKTsKICAg\nICAgICAgICAgaWYgKHNtID09IG51bGwpIHsKICAgICAgICAgICAgICAgIHRt\ncEJyb2tlciA9IGN0eC5nZXRCcm9rZXIoKTsKICAgICAgICAgICAgICAgIHRt\ncEJyb2tlci50cmFuc2FjdGlvbmFsKGNhbmRpZGF0ZSwgZmFsc2UsIG51bGwp\nOwogICAgICAgICAgICAgICAgc20gPSB0bXBCcm9rZXIuZ2V0U3RhdGVNYW5h\nZ2VyKGNhbmRpZGF0ZSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHRy\neSB7CiAgICAgICAgICAgICAgICAvLyBnZXQgdGhlIHNwZWNpZmllZCBmaWVs\nZCB2YWx1ZSBhbmQgc3dpdGNoIGNhbmRpZGF0ZQogICAgICAgICAgICAgICAg\nVHJhdmVyc2FsIHRyYXZlcnNhbCA9IChUcmF2ZXJzYWwpIGFjdGlvbjsKICAg\nICAgICAgICAgICAgIGNhbmRpZGF0ZSA9IHNtLmZldGNoRmllbGQodHJhdmVy\nc2FsLmZpZWxkLmdldEluZGV4KCksIHRydWUpOwogICAgICAgICAgICB9IGZp\nbmFsbHkgewogICAgICAgICAgICAgICAgLy8gdHJhbnNhY3Rpb25hbCBkb2Vz\nIG5vdCBjbGVhciB0aGUgc3RhdGUsIHdoaWNoIGlzCiAgICAgICAgICAgICAg\nICAvLyBpbXBvcnRhbnQgc2luY2UgdG1wQ2FuZGlkYXRlIG1pZ2h0IGJlIGFs\nc28gbWFuYWdlZCBieQogICAgICAgICAgICAgICAgLy8gYW5vdGhlciBicm9r\nZXIgaWYgaXQncyBhIHByb3hpZWQgbm9uLXBjIGluc3RhbmNlCiAgICAgICAg\nICAgICAgICBpZiAodG1wQnJva2VyICE9IG51bGwpCiAgICAgICAgICAgICAg\nICAgICAgdG1wQnJva2VyLm5vbnRyYW5zYWN0aW9uYWwoc20uZ2V0TWFuYWdl\nZEluc3RhbmNlKCksIG51bGwpOwogICAgICAgICAgICB9CiAgICAgICAgfQog\nICAgICAgIHJldHVybiBjYW5kaWRhdGU7CiAgICB9CgogICAgcHVibGljIGlu\ndCBoYXNoQ29kZSgpIHsKICAgICAgICByZXR1cm4gKF9hY3Rpb25zID09IG51\nbGwpID8gMCA6IF9hY3Rpb25zLmhhc2hDb2RlKCk7CiAgICB9CgogICAgcHVi\nbGljIGJvb2xlYW4gZXF1YWxzKE9iamVjdCBvdGhlcikgewogICAgICAgIGlm\nIChvdGhlciA9PSB0aGlzKQogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAg\nICAgICBpZiAoIShvdGhlciBpbnN0YW5jZW9mIENhbmRpZGF0ZVBhdGgpKQog\nICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgcmV0dXJuIE9iamVj\ndFV0aWxzLmVxdWFscyhfYWN0aW9ucywgKChDYW5kaWRhdGVQYXRoKSBvdGhl\ncikuX2FjdGlvbnMpOwogICAgfQoKICAgIC8qKgogICAgICogUmVwcmVzZW50\ncyBhIHRyYXZlcnNhbCB0aHJvdWdoIGEgZmllbGQuCiAgICAgKi8KICAgIHBy\naXZhdGUgc3RhdGljIGNsYXNzIFRyYXZlcnNhbCB7CgogICAgICAgIHB1Ymxp\nYyBmaW5hbCBGaWVsZE1ldGFEYXRhIGZpZWxkOwogICAgICAgIHB1YmxpYyBm\naW5hbCBib29sZWFuIG51bGxUcmF2ZXJzYWw7CgogICAgICAgIHByaXZhdGUg\nVHJhdmVyc2FsKEZpZWxkTWV0YURhdGEgZmllbGQsIGJvb2xlYW4gbnVsbFRy\nYXZlcnNhbCkgewogICAgICAgICAgICB0aGlzLmZpZWxkID0gZmllbGQ7CiAg\nICAgICAgICAgIHRoaXMubnVsbFRyYXZlcnNhbCA9IG51bGxUcmF2ZXJzYWw7\nCiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgaW50IGhhc2hDb2RlKCkgewog\nICAgICAgICAgICByZXR1cm4gZmllbGQuaGFzaENvZGUoKTsKICAgICAgICB9\nCgogICAgICAgIHB1YmxpYyBib29sZWFuIGVxdWFscyhPYmplY3Qgb3RoZXIp\nIHsKICAgICAgICAgICAgaWYgKG90aGVyID09IHRoaXMpCiAgICAgICAgICAg\nICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgcmV0dXJuICgoVHJhdmVy\nc2FsKSBvdGhlcikuZmllbGQuZXF1YWxzKGZpZWxkKTsKICAgICAgICB9Cgl9\nCgogICAgcHVibGljIHZvaWQgZ2V0KEZpZWxkTWV0YURhdGEgZm1kLCBYTUxN\nZXRhRGF0YSBtZXRhKSB7CiAgICB9CiAgICAKICAgIHB1YmxpYyB2b2lkIGdl\ndChYTUxNZXRhRGF0YSBtZXRhLCBTdHJpbmcgbmFtZSkgewogICAgfQogICAg\nCiAgICBwdWJsaWMgWE1MTWV0YURhdGEgZ2V0WG1sTWFwcGluZygpIHsKICAg\nICAgICByZXR1cm4gbnVsbDsKICAgIH0KfQo=\n","encoding":"base64"}

