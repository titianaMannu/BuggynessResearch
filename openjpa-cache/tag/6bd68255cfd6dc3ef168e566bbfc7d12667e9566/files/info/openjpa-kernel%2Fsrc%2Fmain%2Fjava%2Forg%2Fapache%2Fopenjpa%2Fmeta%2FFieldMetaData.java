{"sha":"dca02966bb3102ab71a7ca46ff30fbeeb4ff262b","node_id":"MDQ6QmxvYjIwNjM2NDpkY2EwMjk2NmJiMzEwMmFiNzFhN2NhNDZmZjMwZmJlZWI0ZmYyNjJi","size":66474,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/dca02966bb3102ab71a7ca46ff30fbeeb4ff262b","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YTsKCmltcG9ydCBqYXZh\nLmlvLkV4dGVybmFsaXphYmxlOwppbXBvcnQgamF2YS5pby5JT0V4Y2VwdGlv\nbjsKaW1wb3J0IGphdmEuaW8uT2JqZWN0SW5wdXQ7CmltcG9ydCBqYXZhLmlv\nLk9iamVjdE91dHB1dDsKaW1wb3J0IGphdmEuaW8uU2VyaWFsaXphYmxlOwpp\nbXBvcnQgamF2YS5sYW5nLnJlZmxlY3QuQ29uc3RydWN0b3I7CmltcG9ydCBq\nYXZhLmxhbmcucmVmbGVjdC5GaWVsZDsKaW1wb3J0IGphdmEubGFuZy5yZWZs\nZWN0Lkludm9jYXRpb25UYXJnZXRFeGNlcHRpb247CmltcG9ydCBqYXZhLmxh\nbmcucmVmbGVjdC5NZW1iZXI7CmltcG9ydCBqYXZhLmxhbmcucmVmbGVjdC5N\nZXRob2Q7CmltcG9ydCBqYXZhLmxhbmcucmVmbGVjdC5Nb2RpZmllcjsKaW1w\nb3J0IGphdmEuc2VjdXJpdHkuQWNjZXNzQ29udHJvbGxlcjsKaW1wb3J0IGph\ndmEuc2VjdXJpdHkuUHJpdmlsZWdlZEFjdGlvbkV4Y2VwdGlvbjsKaW1wb3J0\nIGphdmEudXRpbC5BcnJheUxpc3Q7CmltcG9ydCBqYXZhLnV0aWwuQ2FsZW5k\nYXI7CmltcG9ydCBqYXZhLnV0aWwuQ29sbGVjdGlvbjsKaW1wb3J0IGphdmEu\ndXRpbC5Db2xsZWN0aW9uczsKaW1wb3J0IGphdmEudXRpbC5Db21wYXJhdG9y\nOwppbXBvcnQgamF2YS51dGlsLkhhc2hNYXA7CmltcG9ydCBqYXZhLnV0aWwu\nSGFzaFNldDsKaW1wb3J0IGphdmEudXRpbC5JdGVyYXRvcjsKaW1wb3J0IGph\ndmEudXRpbC5MaXN0OwppbXBvcnQgamF2YS51dGlsLk1hcDsKaW1wb3J0IGph\ndmEudXRpbC5Qcm9wZXJ0aWVzOwppbXBvcnQgamF2YS51dGlsLlNldDsKaW1w\nb3J0IGphdmEudXRpbC5UaW1lWm9uZTsKCmltcG9ydCBvcmcuYXBhY2hlLmNv\nbW1vbnMuY29sbGVjdGlvbnMuY29tcGFyYXRvcnMuQ29tcGFyYXRvckNoYWlu\nOwppbXBvcnQgb3JnLmFwYWNoZS5jb21tb25zLmxhbmcuU3RyaW5nVXRpbHM7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuY29uZi5PcGVuSlBBQ29uZmln\ndXJhdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuT3Bl\nbkpQQVN0YXRlTWFuYWdlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5r\nZXJuZWwuU3RvcmVDb250ZXh0OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLmxpYi5jb25mLkNvbmZpZ3VyYXRpb25zOwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLmxpYi5sb2cuTG9nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLmxpYi51dGlsLkoyRG9Qcml2SGVscGVyOwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLmxpYi51dGlsLkphdmFWZXJzaW9uczsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5saWIudXRpbC5Mb2NhbGl6ZXI7CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEubGliLnV0aWwuT3B0aW9uczsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5saWIueG1sLkNvbW1lbnRhYmxlOwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLnV0aWwuRXhjZXB0aW9uczsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS51dGlsLkludGVybmFsRXhjZXB0aW9uOwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLnV0aWwuTWV0YURhdGFFeGNlcHRpb247CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5PcGVuSlBBRXhjZXB0aW9uOwpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuVW5zdXBwb3J0ZWRFeGNl\ncHRpb247CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5JbXBsSGVs\ncGVyOwppbXBvcnQgc2VycC51dGlsLlN0cmluZ3M7CgovKioKICogTWV0YWRh\ndGEgZm9yIGEgbWFuYWdlZCBjbGFzcyBmaWVsZC4KICoKICogQGF1dGhvciBB\nYmUgV2hpdGUKICovCnB1YmxpYyBjbGFzcyBGaWVsZE1ldGFEYXRhCiAgICBl\neHRlbmRzIEV4dGVuc2lvbnMKICAgIGltcGxlbWVudHMgVmFsdWVNZXRhRGF0\nYSwgTWV0YURhdGFDb250ZXh0LCBNZXRhRGF0YU1vZGVzLCBDb21tZW50YWJs\nZSB7CiAgICAKICAgIC8qKgogICAgICogQ29uc3RhbnQgc3BlY2lmeWluZyB0\naGF0IG5vIG51bGwtdmFsdWUgd2FzIGdpdmVuLgogICAgICovCiAgICBwdWJs\naWMgc3RhdGljIGZpbmFsIGludCBOVUxMX1VOU0VUID0gLTE7CgogICAgLyoq\nCiAgICAgKiBDb25zdGFudCBzcGVjaWZ5aW5nIHRvIHVzZSBhIGRhdGFzdG9y\nZSBudWxsIHRvIHBlcnNpc3QgbnVsbCB2YWx1ZXMKICAgICAqIGluIG9iamVj\ndCBmaWVsZHMuCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgaW50\nIE5VTExfTk9ORSA9IDA7CgogICAgLyoqCiAgICAgKiBDb25zdGFudCBzcGVj\naWZ5aW5nIHRvIHVzZSBhIGRhdGFzdG9yZSBkZWZhdWx0IHZhbHVlIHRvIHBl\ncnNpc3QgbnVsbAogICAgICogdmFsdWVzIGluIG9iamVjdCBmaWVsZHMuCiAg\nICAgKi8KICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgaW50IE5VTExfREVGQVVM\nVCA9IDE7CgogICAgLyoqCiAgICAgKiBDb25zdGFudCBzcGVjaWZ5aW5nIHRv\nIHRocm93IGFuIGV4Y2VwdGlvbiB3aGVuIGF0dGVtcHRpbmcgdG8gcGVyc2lz\ndAogICAgICogbnVsbCB2YWx1ZXMgaW4gb2JqZWN0IGZpZWxkcy4KICAgICAq\nLwogICAgcHVibGljIHN0YXRpYyBmaW5hbCBpbnQgTlVMTF9FWENFUFRJT04g\nPSAyOwoKICAgIC8qKgogICAgICogQ29uc3RhbnQgc3BlY2lmeWluZyB0aGUg\nbWFuYWdlbWVudCBsZXZlbCBvZiBhIGZpZWxkLgogICAgICovCiAgICBwdWJs\naWMgc3RhdGljIGZpbmFsIGludCBNQU5BR0VfUEVSU0lTVEVOVCA9IDM7Cgog\nICAgLyoqCiAgICAgKiBDb25zdGFudCBzcGVjaWZ5aW5nIHRoZSBtYW5hZ2Vt\nZW50IGxldmVsIG9mIGEgZmllbGQuCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0\naWMgZmluYWwgaW50IE1BTkFHRV9UUkFOU0FDVElPTkFMID0gMTsKCiAgICAv\nKioKICAgICAqIENvbnN0YW50IHNwZWNpZnlpbmcgdGhlIG1hbmFnZW1lbnQg\nbGV2ZWwgb2YgYSBmaWVsZC4KICAgICAqLwogICAgcHVibGljIHN0YXRpYyBm\naW5hbCBpbnQgTUFOQUdFX05PTkUgPSAwOwoKICAgIHByaXZhdGUgc3RhdGlj\nIGZpbmFsIExvY2FsaXplciBfbG9jID0gTG9jYWxpemVyLmZvclBhY2thZ2UK\nICAgICAgICAoRmllbGRNZXRhRGF0YS5jbGFzcyk7CgogICAgcHJpdmF0ZSBz\ndGF0aWMgZmluYWwgaW50IERGR19GQUxTRSA9IDE7CiAgICBwcml2YXRlIHN0\nYXRpYyBmaW5hbCBpbnQgREZHX1RSVUUgPSAyOwogICAgcHJpdmF0ZSBzdGF0\naWMgZmluYWwgaW50IERGR19FWFBMSUNJVCA9IDQ7CgogICAgcHJpdmF0ZSBz\ndGF0aWMgZmluYWwgTWV0aG9kIERFRkFVTFRfTUVUSE9EOwogICAgc3RhdGlj\nIHsKICAgICAgICB0cnkgewogICAgICAgICAgICBERUZBVUxUX01FVEhPRCA9\nIE9iamVjdC5jbGFzcy5nZXRNZXRob2QoIndhaXQiLCAoQ2xhc3NbXSkgbnVs\nbCk7CiAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICAg\nICAgLy8gc2hvdWxkbid0IGV2ZXIgaGFwcGVuCiAgICAgICAgICAgIHRocm93\nIG5ldyBJbnRlcm5hbEV4Y2VwdGlvbihlKTsKICAgICAgICB9CiAgICB9Cgog\nICAgLy8gbmFtZSBhbmQgdHlwZQogICAgcHJpdmF0ZSBmaW5hbCBWYWx1ZU1l\ndGFEYXRhIF92YWw7CiAgICBwcml2YXRlIGZpbmFsIFZhbHVlTWV0YURhdGEg\nX2tleTsKICAgIHByaXZhdGUgZmluYWwgVmFsdWVNZXRhRGF0YSBfZWxlbTsK\nICAgIHByaXZhdGUgZmluYWwgQ2xhc3NNZXRhRGF0YSBfb3duZXI7CiAgICBw\ncml2YXRlIGZpbmFsIFN0cmluZyBfbmFtZTsKICAgIHByaXZhdGUgQ2xhc3Mg\nX2RlYyA9IG51bGw7CiAgICBwcml2YXRlIENsYXNzTWV0YURhdGEgX2RlY01l\ndGEgPSBudWxsOwogICAgcHJpdmF0ZSBTdHJpbmcgX2Z1bGxOYW1lID0gbnVs\nbDsKICAgIHByaXZhdGUgU3RyaW5nIF9lbWJlZEZ1bGxOYW1lID0gbnVsbDsK\nICAgIHByaXZhdGUgaW50IF9yZXNNb2RlID0gTU9ERV9OT05FOwoKICAgIC8v\nIGxvYWQvc3RvcmUgaW5mbwogICAgcHJpdmF0ZSBTdHJpbmdbXSBfY29tbWVu\ndHMgPSBudWxsOwogICAgcHJpdmF0ZSBpbnQgX2xpc3RJbmRleCA9IC0xOwoK\nICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v\nLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgICAvLyBOb3RlOiBpZiB5\nb3UgYWRkIGFkZGl0aW9uYWwgc3RhdGUsIG1ha2Ugc3VyZSB0byBhZGQgaXQg\ndG8gY29weSgpCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v\nLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwoKICAgIC8v\nIG1pc2MgaW5mbwogICAgcHJpdmF0ZSBDbGFzcyBfcHJveHlDbGFzcyA9IG51\nbGw7CiAgICBwcml2YXRlIE9iamVjdCBfaW5pdGlhbGl6ZXIgPSBudWxsOwog\nICAgcHJpdmF0ZSBib29sZWFuIF90cmFuc2llbnQgPSBmYWxzZTsKICAgIHBy\naXZhdGUgYm9vbGVhbiBfcHJpbUtleSA9IGZhbHNlOwogICAgcHJpdmF0ZSBC\nb29sZWFuIF92ZXJzaW9uID0gbnVsbDsKICAgIHByaXZhdGUgaW50IF9udWxs\nVmFsdWUgPSBOVUxMX1VOU0VUOwogICAgcHJpdmF0ZSBpbnQgX21hbmFnZSA9\nIE1BTkFHRV9QRVJTSVNURU5UOwogICAgcHJpdmF0ZSBpbnQgX2luZGV4ID0g\nLTE7CiAgICBwcml2YXRlIGludCBfZGVjSW5kZXggPSAtMTsKICAgIHByaXZh\ndGUgaW50IF9wa0luZGV4ID0gLTE7CiAgICBwcml2YXRlIGJvb2xlYW4gX2V4\ncGxpY2l0ID0gZmFsc2U7CiAgICBwcml2YXRlIGludCBfZGZnID0gMDsKICAg\nIHByaXZhdGUgU2V0IF9mZ1NldCA9IG51bGw7CiAgICBwcml2YXRlIFN0cmlu\nZ1tdIF9mZ3MgPSBudWxsOwogICAgcHJpdmF0ZSBTdHJpbmcgICBfbGZnID0g\nbnVsbDsKICAgIHByaXZhdGUgQm9vbGVhbiBfbHJzID0gbnVsbDsKICAgIHBy\naXZhdGUgU3RyaW5nIF9leHROYW1lID0gbnVsbDsKICAgIHByaXZhdGUgU3Ry\naW5nIF9mYWN0TmFtZSA9IG51bGw7CiAgICBwcml2YXRlIFN0cmluZyBfZXh0\nU3RyaW5nID0gbnVsbDsKICAgIHByaXZhdGUgTWFwIF9leHRWYWx1ZXMgPSBD\nb2xsZWN0aW9ucy5FTVBUWV9NQVA7CiAgICBwcml2YXRlIE1hcCBfZmllbGRW\nYWx1ZXMgPSBDb2xsZWN0aW9ucy5FTVBUWV9NQVA7CiAgICBwcml2YXRlIEJv\nb2xlYW4gX2VudW1GaWVsZCA9IG51bGw7CiAgICBwcml2YXRlIEJvb2xlYW4g\nX2xvYkZpZWxkID0gbnVsbDsKICAgIHByaXZhdGUgQm9vbGVhbiBfc2VyaWFs\naXphYmxlRmllbGQgPSBudWxsOwogICAgcHJpdmF0ZSBib29sZWFuIF9nZW5l\ncmF0ZWQgPSBmYWxzZTsKCiAgICAvLyBNZW1iZXJzIGFyZW4ndCBzZXJpYWxp\nemFibGUuIFVzZSBhIHByb3h5IHRoYXQgY2FuIHByb3ZpZGUgYSBNZW1iZXIK\nICAgIC8vIHRvIGF2b2lkIHdyaXRpbmcgdGhlIGZ1bGwgRXh0ZXJuYWxpemFi\nbGUgaW1wbGVtZW50YXRpb24uCiAgICBwcml2YXRlIHRyYW5zaWVudCBNZW1i\nZXJQcm92aWRlciBfYmFja2luZ01lbWJlciA9IG51bGw7CiAgICBwcml2YXRl\nIFN0cmluZyBfYmFja2luZ0ZpZWxkTmFtZSA9IG51bGw7CiAgICAKICAgIC8v\nIE1lbWJlcnMgYXJlbid0IHNlcmlhbGl6YWJsZS4gSW5pdGlhbGl6aW5nIF9l\neHRNZXRob2QgYW5kIF9mYWN0TWV0aG9kIHRvCiAgICAvLyBERUZBVUxUX01F\nVEhPRCBpcyBzdWZmaWNpZW50IHRvIHRyaWdnZXIgbGF6eSBwb3B1bGF0aW9u\nIG9mIHRoZXNlIGZpZWxkcy4KICAgIHByaXZhdGUgdHJhbnNpZW50IE1ldGhv\nZCBfZXh0TWV0aG9kID0gREVGQVVMVF9NRVRIT0Q7CiAgICBwcml2YXRlIHRy\nYW5zaWVudCBNZW1iZXIgX2ZhY3RNZXRob2QgPSBERUZBVUxUX01FVEhPRDsK\nCiAgICAvLyBpbnRlcm1lZGlhdGUgYW5kIGltcGwgZGF0YQogICAgcHJpdmF0\nZSBib29sZWFuIF9pbnRlcm1lZGlhdGUgPSB0cnVlOwogICAgcHJpdmF0ZSBC\nb29sZWFuIF9pbXBsRGF0YSA9IEJvb2xlYW4uVFJVRTsKCiAgICAvLyB2YWx1\nZSBnZW5lcmF0aW9uCiAgICBwcml2YXRlIGludCBfdmFsU3RyYXRlZ3kgPSAt\nMTsKICAgIHByaXZhdGUgaW50IF91cFN0cmF0ZWd5ID0gLTE7CiAgICBwcml2\nYXRlIFN0cmluZyBfc2VxTmFtZSA9IENsYXNzTWV0YURhdGEuREVGQVVMVF9T\nVFJJTkc7CiAgICBwcml2YXRlIFNlcXVlbmNlTWV0YURhdGEgX3NlcU1ldGEg\nPSBudWxsOwoKICAgIC8vIGludmVyc2VzCiAgICBwcml2YXRlIFN0cmluZyBf\nbWFwcGVkQnkgPSBudWxsOwogICAgcHJpdmF0ZSBGaWVsZE1ldGFEYXRhIF9t\nYXBwZWRCeU1ldGEgPSBudWxsOwogICAgcHJpdmF0ZSBGaWVsZE1ldGFEYXRh\nW10gX2ludmVyc2VzID0gbnVsbDsKICAgIHByaXZhdGUgU3RyaW5nIF9pbnZl\ncnNlID0gQ2xhc3NNZXRhRGF0YS5ERUZBVUxUX1NUUklORzsKCiAgICAvLyBv\ncmRlcmluZyBvbiBsb2FkCiAgICBwcml2YXRlIE9yZGVyW10gX29yZGVycyA9\nIG51bGw7CiAgICBwcml2YXRlIFN0cmluZyBfb3JkZXJEZWMgPSBudWxsOwoK\nICAgIC8qKgogICAgICogQ29uc3RydWN0b3IuCiAgICAgKgogICAgICogQHBh\ncmFtIG5hbWUgdGhlIGZpZWxkIG5hbWUKICAgICAqIEBwYXJhbSB0eXBlIHRo\nZSBmaWVsZCB0eXBlCiAgICAgKiBAcGFyYW0gb3duZXIgdGhlIG93bmluZyBj\nbGFzcyBtZXRhZGF0YQogICAgICovCiAgICBwcm90ZWN0ZWQgRmllbGRNZXRh\nRGF0YShTdHJpbmcgbmFtZSwgQ2xhc3MgdHlwZSwgQ2xhc3NNZXRhRGF0YSBv\nd25lcikgewogICAgICAgIF9uYW1lID0gbmFtZTsKICAgICAgICBfb3duZXIg\nPSBvd25lcjsKICAgICAgICBfZGVjID0gbnVsbDsKICAgICAgICBfZGVjTWV0\nYSA9IG51bGw7CiAgICAgICAgX3ZhbCA9IG93bmVyLmdldFJlcG9zaXRvcnko\nKS5uZXdWYWx1ZU1ldGFEYXRhKHRoaXMpOwogICAgICAgIF9rZXkgPSBvd25l\nci5nZXRSZXBvc2l0b3J5KCkubmV3VmFsdWVNZXRhRGF0YSh0aGlzKTsKICAg\nICAgICBfZWxlbSA9IG93bmVyLmdldFJlcG9zaXRvcnkoKS5uZXdWYWx1ZU1l\ndGFEYXRhKHRoaXMpOwoKICAgICAgICBzZXREZWNsYXJlZFR5cGUodHlwZSk7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBTdXBwbHkgdGhlIGJhY2tpbmcgbWVt\nYmVyIG9iamVjdDsgdGhpcyBhbGxvd3MgdXMgdG8gdXRpbGl6ZQogICAgICog\ncGFyYW1ldGVyaXplZCB0eXBlIGluZm9ybWF0aW9uIGlmIGF2YWlsYWJsZS4K\nICAgICAqLwogICAgcHVibGljIHZvaWQgYmFja2luZ01lbWJlcihNZW1iZXIg\nbWVtYmVyKSB7CiAgICAgICAgaWYgKG1lbWJlciA9PSBudWxsKQogICAgICAg\nICAgICByZXR1cm47CiAgICAgICAgaWYgKE1vZGlmaWVyLmlzVHJhbnNpZW50\nKG1lbWJlci5nZXRNb2RpZmllcnMoKSkpCiAgICAgICAgICAgIF90cmFuc2ll\nbnQgPSB0cnVlOwoKICAgICAgICBfYmFja2luZ01lbWJlciA9IG5ldyBNZW1i\nZXJQcm92aWRlcihtZW1iZXIpOwoKICAgICAgICBDbGFzcyB0eXBlOwogICAg\nICAgIENsYXNzW10gdHlwZXM7CiAgICAgICAgaWYgKG1lbWJlciBpbnN0YW5j\nZW9mIEZpZWxkKSB7CiAgICAgICAgICAgIEZpZWxkIGYgPSAoRmllbGQpIG1l\nbWJlcjsKICAgICAgICAgICAgdHlwZSA9IGYuZ2V0VHlwZSgpOwogICAgICAg\nICAgICB0eXBlcyA9IEphdmFWZXJzaW9ucy5nZXRQYXJhbWV0ZXJpemVkVHlw\nZXMoZik7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgTWV0aG9kIG1l\ndGggPSAoTWV0aG9kKSBtZW1iZXI7CiAgICAgICAgICAgIHR5cGUgPSBtZXRo\nLmdldFJldHVyblR5cGUoKTsKICAgICAgICAgICAgdHlwZXMgPSBKYXZhVmVy\nc2lvbnMuZ2V0UGFyYW1ldGVyaXplZFR5cGVzKG1ldGgpOwogICAgICAgIH0K\nCiAgICAgICAgc2V0RGVjbGFyZWRUeXBlKHR5cGUpOwogICAgICAgIGlmIChD\nb2xsZWN0aW9uLmNsYXNzLmlzQXNzaWduYWJsZUZyb20odHlwZSkKICAgICAg\nICAgICAgJiYgX2VsZW0uZ2V0RGVjbGFyZWRUeXBlKCkgPT0gT2JqZWN0LmNs\nYXNzCiAgICAgICAgICAgICYmIHR5cGVzLmxlbmd0aCA9PSAxKSB7CiAgICAg\nICAgICAgIF9lbGVtLnNldERlY2xhcmVkVHlwZSh0eXBlc1swXSk7CiAgICAg\nICAgfSBlbHNlIGlmIChNYXAuY2xhc3MuaXNBc3NpZ25hYmxlRnJvbSh0eXBl\nKQogICAgICAgICAgICAmJiB0eXBlcy5sZW5ndGggPT0gMikgewogICAgICAg\nICAgICBpZiAoX2tleS5nZXREZWNsYXJlZFR5cGUoKSA9PSBPYmplY3QuY2xh\nc3MpCiAgICAgICAgICAgICAgICBfa2V5LnNldERlY2xhcmVkVHlwZSh0eXBl\nc1swXSk7CiAgICAgICAgICAgIGlmIChfZWxlbS5nZXREZWNsYXJlZFR5cGUo\nKSA9PSBPYmplY3QuY2xhc3MpCiAgICAgICAgICAgICAgICBfZWxlbS5zZXRE\nZWNsYXJlZFR5cGUodHlwZXNbMV0pOwogICAgICAgIH0KICAgIH0KCiAgICAv\nKioKICAgICAqIFJldHVybiB0aGUgYmFja2luZyBtZW1iZXIgc3VwcGxpZWQg\naW4ge0BsaW5rICNiYWNraW5nTWVtYmVyfS4KICAgICAqLwogICAgcHVibGlj\nIE1lbWJlciBnZXRCYWNraW5nTWVtYmVyKCkgewogICAgICAgIHJldHVybiAo\nX2JhY2tpbmdNZW1iZXIgPT0gbnVsbCkgPyBudWxsIDogX2JhY2tpbmdNZW1i\nZXIuZ2V0TWVtYmVyKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBUaGUgbWV0\nYWRhdGEgcmVwb3NpdG9yeS4KICAgICAqLwogICAgcHVibGljIE1ldGFEYXRh\nUmVwb3NpdG9yeSBnZXRSZXBvc2l0b3J5KCkgewogICAgICAgIHJldHVybiBf\nb3duZXIuZ2V0UmVwb3NpdG9yeSgpOwogICAgfQoKICAgIC8qKgogICAgICog\nVGhlIGNsYXNzIHRoYXQgZGVmaW5lcyB0aGUgbWV0YWRhdGEgZm9yIHRoaXMg\nZmllbGQuCiAgICAgKi8KICAgIHB1YmxpYyBDbGFzc01ldGFEYXRhIGdldERl\nZmluaW5nTWV0YURhdGEoKSB7CiAgICAgICAgcmV0dXJuIF9vd25lcjsKICAg\nIH0KCiAgICAvKioKICAgICAqIFRoZSBkZWNsYXJpbmcgY2xhc3MuCiAgICAg\nKi8KICAgIHB1YmxpYyBDbGFzcyBnZXREZWNsYXJpbmdUeXBlKCkgewogICAg\nICAgIHJldHVybiAoX2RlYyA9PSBudWxsKSA/IF9vd25lci5nZXREZXNjcmli\nZWRUeXBlKCkgOiBfZGVjOwogICAgfQoKICAgIC8qKgogICAgICogVGhlIGRl\nY2xhcmluZyBjbGFzcy4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0RGVj\nbGFyaW5nVHlwZShDbGFzcyBjbHMpIHsKICAgICAgICBfZGVjID0gY2xzOwog\nICAgICAgIF9kZWNNZXRhID0gbnVsbDsKICAgICAgICBfZnVsbE5hbWUgPSBu\ndWxsOwogICAgICAgIF9lbWJlZEZ1bGxOYW1lID0gbnVsbDsKICAgIH0KCiAg\nICAvKioKICAgICAqIFRoZSBkZWNsYXJpbmcgY2xhc3MuCiAgICAgKi8KICAg\nIHB1YmxpYyBDbGFzc01ldGFEYXRhIGdldERlY2xhcmluZ01ldGFEYXRhKCkg\newogICAgICAgIGlmIChfZGVjID09IG51bGwpCiAgICAgICAgICAgIHJldHVy\nbiBfb3duZXI7CiAgICAgICAgaWYgKF9kZWNNZXRhID09IG51bGwpCiAgICAg\nICAgICAgIF9kZWNNZXRhID0gZ2V0UmVwb3NpdG9yeSgpLmdldE1ldGFEYXRh\nKF9kZWMsCiAgICAgICAgICAgICAgICBfb3duZXIuZ2V0RW52Q2xhc3NMb2Fk\nZXIoKSwgdHJ1ZSk7CiAgICAgICAgcmV0dXJuIF9kZWNNZXRhOwogICAgfQoK\nICAgIC8qKgogICAgICogVGhlIGZpZWxkIG5hbWUuCiAgICAgKi8KICAgIHB1\nYmxpYyBTdHJpbmcgZ2V0TmFtZSgpIHsKICAgICAgICByZXR1cm4gX25hbWU7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBUaGUgZmllbGQgbmFtZSwgcXVhbGlm\naWVkIGJ5IHRoZSBvd25pbmcgY2xhc3MuCiAgICAgKiBAZGVwcmVjYXRlZCBV\nc2UgZ2V0RnVsbE5hbWUoYm9vbGVhbikgaW5zdGVhZC4KICAgICAqLwogICAg\ncHVibGljIFN0cmluZyBnZXRGdWxsTmFtZSgpIHsKICAgICAgICByZXR1cm4g\nZ2V0RnVsbE5hbWUoZmFsc2UpOwogICAgfQoKICAgIC8qKgogICAgICogVGhl\nIGZpZWxkIG5hbWUsIHF1YWxpZmllZCBieSB0aGUgb3duaW5nIGNsYXNzIGFu\nZCBvcHRpb25hbGx5IHRoZQogICAgICogZW1iZWRkaW5nIG93bmVyJ3MgbmFt\nZSAoaWYgYW55KS4KICAgICAqLwogICAgcHVibGljIFN0cmluZyBnZXRGdWxs\nTmFtZShib29sZWFuIGVtYmVkT3duZXIpIHsKICAgICAgICBpZiAoX2Z1bGxO\nYW1lID09IG51bGwpCiAgICAgICAgICAgIF9mdWxsTmFtZSA9IGdldERlY2xh\ncmluZ1R5cGUoKS5nZXROYW1lKCkgKyAiLiIgKyBfbmFtZTsKICAgICAgICBp\nZiAoZW1iZWRPd25lciAmJiBfZW1iZWRGdWxsTmFtZSA9PSBudWxsKSB7CiAg\nICAgICAgICAgIGlmIChfb3duZXIuZ2V0RW1iZWRkaW5nTWV0YURhdGEoKSA9\nPSBudWxsKQogICAgICAgICAgICAgICAgX2VtYmVkRnVsbE5hbWUgPSBfZnVs\nbE5hbWU7CiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIF9lbWJl\nZEZ1bGxOYW1lID0gX293bmVyLmdldEVtYmVkZGluZ01ldGFEYXRhKCkuCiAg\nICAgICAgICAgICAgICAgICAgZ2V0RmllbGRNZXRhRGF0YSgpLmdldEZ1bGxO\nYW1lKHRydWUpICsgIi4iICsgX2Z1bGxOYW1lOwogICAgICAgIH0KICAgICAg\nICByZXR1cm4gKGVtYmVkT3duZXIpID8gX2VtYmVkRnVsbE5hbWUgOiBfZnVs\nbE5hbWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBNZXRhRGF0YSBhYm91dCB0\naGUgZmllbGQgdmFsdWUuCiAgICAgKi8KICAgIHB1YmxpYyBWYWx1ZU1ldGFE\nYXRhIGdldFZhbHVlKCkgewogICAgICAgIHJldHVybiBfdmFsOwogICAgfQoK\nICAgIC8qKgogICAgICogTWV0YWRhdGEgYWJvdXQgdGhlIGtleSB2YWx1ZS4K\nICAgICAqLwogICAgcHVibGljIFZhbHVlTWV0YURhdGEgZ2V0S2V5KCkgewog\nICAgICAgIHJldHVybiBfa2V5OwogICAgfQoKICAgIC8qKgogICAgICogTWV0\nYWRhdGEgYWJvdXQgdGhlIGVsZW1lbnQgdmFsdWUuCiAgICAgKi8KICAgIHB1\nYmxpYyBWYWx1ZU1ldGFEYXRhIGdldEVsZW1lbnQoKSB7CiAgICAgICAgcmV0\ndXJuIF9lbGVtOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHdoZXRo\nZXIgdGhpcyBmaWVsZCBpcyBtYXBwZWQgdG8gdGhlIGRhdGFzdG9yZS4gQnkg\nZGVmYXVsdCwKICAgICAqIHJldHVybnMgdHJ1ZSBmb3IgYWxsIHBlcnNpc3Rl\nbnQgZmllbGRzIHdob3NlIGRlZmluaW5nIGNsYXNzIGlzIG1hcHBlZC4KICAg\nICAqLwogICAgcHVibGljIGJvb2xlYW4gaXNNYXBwZWQoKSB7CiAgICAgICAg\ncmV0dXJuIF9tYW5hZ2UgPT0gTUFOQUdFX1BFUlNJU1RFTlQgJiYgX293bmVy\nLmlzTWFwcGVkKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBUaGUgdHlwZSB0\naGlzIGZpZWxkIHdhcyBpbml0aWFsaXplZCB3aXRoLCBhbmQgdGhlcmVmb3Jl\nIHRoZQogICAgICogdHlwZSB0byB1c2UgZm9yIHByb3hpZXMgd2hlbiBsb2Fk\naW5nIGRhdGEgaW50byB0aGlzIGZpZWxkLgogICAgICovCiAgICBwdWJsaWMg\nQ2xhc3MgZ2V0UHJveHlUeXBlKCkgewogICAgICAgIHJldHVybiAoX3Byb3h5\nQ2xhc3MgPT0gbnVsbCkgPyBnZXREZWNsYXJlZFR5cGUoKSA6IF9wcm94eUNs\nYXNzOwogICAgfQoKICAgIC8qKgogICAgICogVGhlIHR5cGUgdGhpcyBmaWVs\nZCB3YXMgaW5pdGlhbGl6ZWQgd2l0aCwgYW5kIHRoZXJlZm9yZSB0aGUKICAg\nICAqIHR5cGUgdG8gdXNlIGZvciBwcm94aWVzIHdoZW4gbG9hZGluZyBkYXRh\nIGludG8gdGhpcyBmaWVsZC4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0\nUHJveHlUeXBlKENsYXNzIHR5cGUpIHsKICAgICAgICBfcHJveHlDbGFzcyA9\nIHR5cGU7CiAgICB9CgogICAgLyoqCiAgICAgKiBUaGUgaW5pdGlhbGl6ZXIg\ndXNlZCBieSB0aGUgZmllbGQsIG9yIG51bGwgaWYgbm9uZS4gVGhpcwogICAg\nICogaXMgYWRkaXRpb25hbCBpbmZvcm1hdGlvbiBmb3IgaW5pdGlhbGl6aW5n\nIHRoZSBmaWVsZCwgc3VjaCBhcwogICAgICogYSBjdXN0b20ge0BsaW5rIENv\nbXBhcmF0b3J9IHVzZWQgYnkgYSB7QGxpbmsgU2V0fSBvcgogICAgICogYSB7\nQGxpbmsgVGltZVpvbmV9IHVzZWQgYnkgYSB7QGxpbmsgQ2FsZW5kYXJ9Lgog\nICAgICovCiAgICBwdWJsaWMgT2JqZWN0IGdldEluaXRpYWxpemVyKCkgewog\nICAgICAgIHJldHVybiBfaW5pdGlhbGl6ZXI7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBUaGUgaW5pdGlhbGl6ZXIgdXNlZCBieSB0aGUgZmllbGQsIG9yIG51\nbGwgaWYgbm9uZS4gVGhpcwogICAgICogaXMgYWRkaXRpb25hbCBpbmZvcm1h\ndGlvbiBmb3IgaW5pdGlhbGl6aW5nIHRoZSBmaWVsZCwgc3VjaCBhcwogICAg\nICogYSBjdXN0b20ge0BsaW5rIENvbXBhcmF0b3J9IHVzZWQgYnkgYSB7QGxp\nbmsgU2V0fSBvcgogICAgICogYSB7QGxpbmsgVGltZVpvbmV9IHVzZWQgYnkg\nYSB7QGxpbmsgQ2FsZW5kYXJ9LgogICAgICovCiAgICBwdWJsaWMgdm9pZCBz\nZXRJbml0aWFsaXplcihPYmplY3QgaW5pdGlhbGl6ZXIpIHsKICAgICAgICBf\naW5pdGlhbGl6ZXIgPSBpbml0aWFsaXplcjsKICAgIH0KCiAgICAvKioKICAg\nICAqIFJldHVybiB3aGV0aGVyIHRoaXMgaXMgYSB0cmFuc2llbnQgZmllbGQu\nCiAgICAgKi8KICAgIHB1YmxpYyBib29sZWFuIGlzVHJhbnNpZW50KCkgewog\nICAgICAgIHJldHVybiBfdHJhbnNpZW50OwogICAgfQoKICAgIC8qKgogICAg\nICogUmV0dXJuIHdoZXRoZXIgdGhpcyBpcyBhIHRyYW5zaWVudCBmaWVsZC4K\nICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0VHJhbnNpZW50KGJvb2xlYW4g\ndHJhbnMpIHsKICAgICAgICBfdHJhbnNpZW50ID0gdHJhbnM7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBUaGUgYWJzb2x1dGUgaW5kZXggb2YgdGhpcyBwZXJz\naXN0ZW50L3RyYW5zYWN0aW9uYWwgZmllbGQuCiAgICAgKi8KICAgIHB1Ymxp\nYyBpbnQgZ2V0SW5kZXgoKSB7CiAgICAgICAgcmV0dXJuIF9pbmRleDsKICAg\nIH0KCiAgICAvKioKICAgICAqIFRoZSBhYnNvbHV0ZSBpbmRleCBvZiB0aGlz\nIHBlcnNpc3RlbnQvdHJhbnNhY3Rpb25hbCBmaWVsZC4KICAgICAqLwogICAg\ncHVibGljIHZvaWQgc2V0SW5kZXgoaW50IGluZGV4KSB7CiAgICAgICAgX2lu\nZGV4ID0gaW5kZXg7CiAgICB9CgogICAgLyoqCiAgICAgKiBUaGUgcmVsYXRp\ndmUgaW5kZXggb2YgdGhpcyBwZXJzaXN0ZW50L3RyYW5zYWN0aW9uYWwgZmll\nbGQuCiAgICAgKi8KICAgIHB1YmxpYyBpbnQgZ2V0RGVjbGFyZWRJbmRleCgp\nIHsKICAgICAgICByZXR1cm4gX2RlY0luZGV4OwogICAgfQoKICAgIC8qKgog\nICAgICogVGhlIHJlbGF0aXZlIGluZGV4IG9mIHRoaXMgcGVyc2lzdGVudC90\ncmFuc2FjdGlvbmFsIGZpZWxkLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBz\nZXREZWNsYXJlZEluZGV4KGludCBpbmRleCkgewogICAgICAgIF9kZWNJbmRl\neCA9IGluZGV4OwogICAgfQoKICAgIC8qKgogICAgICogVGhlIGluZGV4IGlu\nIHdoaWNoIHRoaXMgZmllbGQgd2FzIGxpc3RlZCBpbiB0aGUgbWV0YWRhdGEu\nIERlZmF1bHRzIHRvCiAgICAgKiA8Y29kZT4tMTwvY29kZT4gaWYgdGhpcyBm\naWVsZCB3YXMgbm90IGxpc3RlZCBpbiB0aGUgbWV0YWRhdGEuCiAgICAgKi8K\nICAgIHB1YmxpYyBpbnQgZ2V0TGlzdGluZ0luZGV4KCkgewogICAgICAgIHJl\ndHVybiBfbGlzdEluZGV4OwogICAgfQoKICAgIC8qKgogICAgICogVGhlIGlu\nZGV4IGluIHdoaWNoIHRoaXMgZmllbGQgd2FzIGxpc3RlZCBpbiB0aGUgbWV0\nYWRhdGEuIERlZmF1bHRzIHRvCiAgICAgKiA8Y29kZT4tMTwvY29kZT4gaWYg\ndGhpcyBmaWVsZCB3YXMgbm90IGxpc3RlZCBpbiB0aGUgbWV0YWRhdGEuCiAg\nICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldExpc3RpbmdJbmRleChpbnQgaW5k\nZXgpIHsKICAgICAgICBfbGlzdEluZGV4ID0gaW5kZXg7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBUaGUgYWJzb2x1dGUgcHJpbWFyeSBrZXkgaW5kZXggZm9y\nIHRoaXMgZmllbGQsIG9yIC0xIGlmIG5vdCBhIHByaW1hcnkKICAgICAqIGtl\neS4gVGhlIGZpcnN0IHByaW1hcnkga2V5IGZpZWxkIGhhcyBpbmRleCAwLCB0\naGUgc2Vjb25kIGluZGV4IDEsIGV0Yy4KICAgICAqLwogICAgcHVibGljIGlu\ndCBnZXRQcmltYXJ5S2V5SW5kZXgoKSB7CiAgICAgICAgcmV0dXJuIF9wa0lu\nZGV4OwogICAgfQoKICAgIC8qKgogICAgICogVGhlIGFic29sdXRlIHByaW1h\ncnkga2V5IGluZGV4IGZvciB0aGlzIGZpZWxkLCBvciAtMSBpZiBub3QgYSBw\ncmltYXJ5CiAgICAgKiBrZXkuIFRoZSBmaXJzdCBwcmltYXJ5IGtleSBmaWVs\nZCBoYXMgaW5kZXggMCwgdGhlIHNlY29uZCBpbmRleCAxLCBldGMuCiAgICAg\nKi8KICAgIHB1YmxpYyB2b2lkIHNldFByaW1hcnlLZXlJbmRleChpbnQgaW5k\nZXgpIHsKICAgICAgICBfcGtJbmRleCA9IGluZGV4OwogICAgfQoKICAgIC8q\nKgogICAgICogUmV0dXJuIHRoZSBtYW5hZ2VtZW50IGxldmVsIGZvciB0aGUg\nZmllbGQuIFdpbGwgYmUgb25lIG9mOgogICAgICogPHVsPgogICAgICogPGxp\nPntAbGluayAjTUFOQUdFX1BFUlNJU1RFTlR9OiB0aGUgZmllbGQgaXMgcGVy\nc2lzdGVudDwvbGk+CiAgICAgKiA8bGk+e0BsaW5rICNNQU5BR0VfVFJBTlNB\nQ1RJT05BTH06IHRoZSBmaWVsZCBpcyB0cmFuc2FjdGlvbmFsIGJ1dCBub3QK\nICAgICAqIHBlcnNpc3RlbnQ8L2xpPgogICAgICogPGxpPntAbGluayAjTUFO\nQUdFX05PTkV9OiB0aGUgZmllbGQgaXMgbm90IG1hbmFnZWQ8L2xpPgogICAg\nICogPC91bD4gRGVmYXVsdHMgdG8ge0BsaW5rICNNQU5BR0VfUEVSU0lTVEVO\nVH0uCiAgICAgKi8KICAgIHB1YmxpYyBpbnQgZ2V0TWFuYWdlbWVudCgpIHsK\nICAgICAgICByZXR1cm4gX21hbmFnZTsKICAgIH0KCiAgICAvKioKICAgICAq\nIFJldHVybiB0aGUgbWFuYWdlbWVudCBsZXZlbCBmb3IgdGhlIGZpZWxkLiBX\naWxsIGJlIG9uZSBvZjoKICAgICAqIDx1bD4KICAgICAqIDxsaT57QGxpbmsg\nI01BTkFHRV9QRVJTSVNURU5UfTogdGhlIGZpZWxkIGlzIHBlcnNpc3RlbnQ8\nL2xpPgogICAgICogPGxpPntAbGluayAjTUFOQUdFX1RSQU5TQUNUSU9OQUx9\nOiB0aGUgZmllbGQgaXMgdHJhbnNhY3Rpb25hbCBidXQgbm90CiAgICAgKiBw\nZXJzaXN0ZW50PC9saT4KICAgICAqIDxsaT57QGxpbmsgI01BTkFHRV9OT05F\nfTogdGhlIGZpZWxkIGlzIG5vdCBtYW5hZ2VkPC9saT4KICAgICAqIDwvdWw+\nIAogICAgICogRGVmYXVsdHMgdG8ge0BsaW5rICNNQU5BR0VfUEVSU0lTVEVO\nVH0uCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldE1hbmFnZW1lbnQoaW50\nIG1hbmFnZSkgewogICAgICAgIGlmICgoX21hbmFnZSA9PSBNQU5BR0VfTk9O\nRSkgIT0gKG1hbmFnZSA9PSBNQU5BR0VfTk9ORSkpCiAgICAgICAgICAgIF9v\nd25lci5jbGVhckZpZWxkQ2FjaGUoKTsKICAgICAgICBfbWFuYWdlID0gbWFu\nYWdlOwogICAgfQoKICAgIC8qKgogICAgICogV2hldGhlciB0aGlzIGlzIGEg\ncHJpbWFyeSBrZXkgZmllbGQuCiAgICAgKi8KICAgIHB1YmxpYyBib29sZWFu\nIGlzUHJpbWFyeUtleSgpIHsKICAgICAgICByZXR1cm4gX3ByaW1LZXk7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBXaGV0aGVyIHRoaXMgaXMgYSBwcmltYXJ5\nIGtleSBmaWVsZC4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0UHJpbWFy\neUtleShib29sZWFuIHByaW1LZXkpIHsKICAgICAgICBfcHJpbUtleSA9IHBy\naW1LZXk7CiAgICB9CgogICAgLyoqCiAgICAgKiBGb3IgYSBwcmltYXJ5IGtl\neSBmaWVsZCwgcmV0dXJuIHRoZSB0eXBlIG9mIHRoZSBjb3JyZXNwb25kaW5n\nIG9iamVjdCBpZCAKICAgICAqIGNsYXNzIGZpZWxkLgogICAgICovCiAgICBw\ndWJsaWMgaW50IGdldE9iamVjdElkRmllbGRUeXBlQ29kZSgpIHsKICAgICAg\nICBDbGFzc01ldGFEYXRhIHJlbG1ldGEgPSBnZXREZWNsYXJlZFR5cGVNZXRh\nRGF0YSgpOwogICAgICAgIGlmIChyZWxtZXRhID09IG51bGwpCiAgICAgICAg\nICAgIHJldHVybiBnZXREZWNsYXJlZFR5cGVDb2RlKCk7CiAgICAgICAgaWYg\nKHJlbG1ldGEuZ2V0SWRlbnRpdHlUeXBlKCkgPT0gQ2xhc3NNZXRhRGF0YS5J\nRF9EQVRBU1RPUkUpIHsKICAgICAgICAgICAgYm9vbGVhbiB1bndyYXAgPSBn\nZXRSZXBvc2l0b3J5KCkuZ2V0TWV0YURhdGFGYWN0b3J5KCkuZ2V0RGVmYXVs\ndHMoKS4KICAgICAgICAgICAgICAgIGlzRGF0YVN0b3JlT2JqZWN0SWRGaWVs\nZFVud3JhcHBlZCgpOwogICAgICAgICAgICByZXR1cm4gKHVud3JhcCkgPyBK\nYXZhVHlwZXMuTE9ORyA6IEphdmFUeXBlcy5PQkpFQ1Q7CiAgICAgICAgfQog\nICAgICAgIGlmIChyZWxtZXRhLmlzT3BlbkpQQUlkZW50aXR5KCkpCiAgICAg\nICAgICAgIHJldHVybiByZWxtZXRhLmdldFByaW1hcnlLZXlGaWVsZHMoKVsw\nXS5nZXRPYmplY3RJZEZpZWxkVHlwZUNvZGUoKTsKICAgICAgICByZXR1cm4g\nSmF2YVR5cGVzLk9CSkVDVDsKICAgIH0KCiAgICAvKioKICAgICAqIEZvciBh\nIHByaW1hcnkga2V5IGZpZWxkLCByZXR1cm4gdGhlIHR5cGUgb2YgdGhlIGNv\ncnJlc3BvbmRpbmcgb2JqZWN0IGlkIAogICAgICogY2xhc3MgZmllbGQuCiAg\nICAgKi8KICAgIHB1YmxpYyBDbGFzcyBnZXRPYmplY3RJZEZpZWxkVHlwZSgp\nIHsKICAgICAgICBDbGFzc01ldGFEYXRhIHJlbG1ldGEgPSBnZXREZWNsYXJl\nZFR5cGVNZXRhRGF0YSgpOwogICAgICAgIGlmIChyZWxtZXRhID09IG51bGwp\nCiAgICAgICAgICAgIHJldHVybiBnZXREZWNsYXJlZFR5cGUoKTsKICAgICAg\nICBzd2l0Y2ggKHJlbG1ldGEuZ2V0SWRlbnRpdHlUeXBlKCkpIHsKICAgICAg\nICAgICAgY2FzZSBDbGFzc01ldGFEYXRhLklEX0RBVEFTVE9SRToKICAgICAg\nICAgICAgICAgIGJvb2xlYW4gdW53cmFwID0gZ2V0UmVwb3NpdG9yeSgpLmdl\ndE1ldGFEYXRhRmFjdG9yeSgpLgogICAgICAgICAgICAgICAgICAgIGdldERl\nZmF1bHRzKCkuaXNEYXRhU3RvcmVPYmplY3RJZEZpZWxkVW53cmFwcGVkKCk7\nCiAgICAgICAgICAgICAgICByZXR1cm4gKHVud3JhcCkgPyBsb25nLmNsYXNz\nIDogT2JqZWN0LmNsYXNzOwogICAgICAgICAgICBjYXNlIENsYXNzTWV0YURh\ndGEuSURfQVBQTElDQVRJT046CiAgICAgICAgICAgICAgICBpZiAocmVsbWV0\nYS5pc09wZW5KUEFJZGVudGl0eSgpKQogICAgICAgICAgICAgICAgICAgIHJl\ndHVybiByZWxtZXRhLmdldFByaW1hcnlLZXlGaWVsZHMoKVswXS4KICAgICAg\nICAgICAgICAgICAgICAgICAgZ2V0T2JqZWN0SWRGaWVsZFR5cGUoKTsKICAg\nICAgICAgICAgICAgIHJldHVybiAocmVsbWV0YS5nZXRPYmplY3RJZFR5cGUo\nKSA9PSBudWxsKSA/IE9iamVjdC5jbGFzcwogICAgICAgICAgICAgICAgICAg\nIDogcmVsbWV0YS5nZXRPYmplY3RJZFR5cGUoKTsKICAgICAgICAgICAgZGVm\nYXVsdDoKICAgICAgICAgICAgICAgIHJldHVybiBPYmplY3QuY2xhc3M7CiAg\nICAgICAgfSAKICAgIH0KCiAgICAvKioKICAgICAqIFdoZXRoZXIgdGhpcyBm\naWVsZCBob2xkcyBvcHRpbWlzdGljIHZlcnNpb24gaW5mb3JtYXRpb24uCiAg\nICAgKi8KICAgIHB1YmxpYyBib29sZWFuIGlzVmVyc2lvbigpIHsKICAgICAg\nICByZXR1cm4gX3ZlcnNpb24gPT0gQm9vbGVhbi5UUlVFOwogICAgfQoKICAg\nIC8qKgogICAgICogV2hldGhlciB0aGlzIGZpZWxkIGhvbGRzIG9wdGltaXN0\naWMgdmVyc2lvbiBpbmZvcm1hdGlvbi4KICAgICAqLwogICAgcHVibGljIHZv\naWQgc2V0VmVyc2lvbihib29sZWFuIHZlcnNpb24pIHsKICAgICAgICBfdmVy\nc2lvbiA9ICh2ZXJzaW9uKSA/IEJvb2xlYW4uVFJVRSA6IEJvb2xlYW4uRkFM\nU0U7CiAgICB9CgogICAgLyoqCiAgICAgKiBXaGV0aGVyIHRoaXMgZmllbGQg\naXMgaW4gdGhlIGRlZmF1bHQgZmV0Y2ggZ3JvdXAuCiAgICAgKi8KICAgIHB1\nYmxpYyBib29sZWFuIGlzSW5EZWZhdWx0RmV0Y2hHcm91cCgpIHsKICAgICAg\nICBpZiAoX2RmZyA9PSAwKSB7CiAgICAgICAgICAgIGlmIChfbWFuYWdlICE9\nIE1BTkFHRV9QRVJTSVNURU5UIHx8IGlzUHJpbWFyeUtleSgpIHx8IGlzVmVy\nc2lvbigpKQogICAgICAgICAgICAgICAgX2RmZyA9IERGR19GQUxTRTsKICAg\nICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAvLyBmaWVsZCBsZWZ0\nIGFzIGRlZmF1bHQ7IGRmZyBzZXR0aW5nIGRlcGVuZHMgb24gdHlwZQogICAg\nICAgICAgICAgICAgc3dpdGNoIChnZXRUeXBlQ29kZSgpKSB7CiAgICAgICAg\nICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuT0JKRUNUOgogICAgICAgICAg\nICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLlBDOgogICAgICAgICAgICAgICAg\nICAgICAgICBpZiAoaXNTZXJpYWxpemFibGUoKSB8fCBpc0VudW0oKSkKICAg\nICAgICAgICAgICAgICAgICAgICAgICAgIF9kZmcgPSBERkdfVFJVRTsKICAg\nICAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAg\nICAgICAgICAgX2RmZyA9IERGR19GQUxTRTsKICAgICAgICAgICAgICAgICAg\nICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgY2FzZSBKYXZhVHlw\nZXMuQVJSQVk6CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc0xvYkFy\ncmF5KCkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfZGZnID0gREZH\nX1RSVUU7CiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAg\nICAgICAgICAgICAgICAgICAgIF9kZmcgPSBERkdfRkFMU0U7CiAgICAgICAg\nICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIGNh\nc2UgSmF2YVR5cGVzLkNPTExFQ1RJT046CiAgICAgICAgICAgICAgICAgICAg\nY2FzZSBKYXZhVHlwZXMuTUFQOgogICAgICAgICAgICAgICAgICAgIGNhc2Ug\nSmF2YVR5cGVzLlBDX1VOVFlQRUQ6CiAgICAgICAgICAgICAgICAgICAgICAg\nIF9kZmcgPSBERkdfRkFMU0U7CiAgICAgICAgICAgICAgICAgICAgICAgIGJy\nZWFrOwogICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAg\nICAgICAgICAgICAgIF9kZmcgPSBERkdfVFJVRTsKICAgICAgICAgICAgICAg\nIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4gKF9k\nZmcgJiBERkdfVFJVRSkgPiAwOwogICAgfQoKICAgIHByaXZhdGUgYm9vbGVh\nbiBpc0VudW0oKSB7CiAgICAgICAgaWYgKF9lbnVtRmllbGQgPT0gbnVsbCkg\newogICAgICAgICAgICBDbGFzcyBkdCA9IGdldERlY2xhcmVkVHlwZSgpOwog\nICAgICAgICAgICBfZW51bUZpZWxkID0gSmF2YVZlcnNpb25zLmlzRW51bWVy\nYXRpb24oZHQpCiAgICAgICAgICAgICAgICA/IEJvb2xlYW4uVFJVRSA6IEJv\nb2xlYW4uRkFMU0U7CiAgICAgICAgfQogICAgICAgIHJldHVybiBfZW51bUZp\nZWxkLmJvb2xlYW5WYWx1ZSgpOwogICAgfQoKICAgIHByaXZhdGUgYm9vbGVh\nbiBpc1NlcmlhbGl6YWJsZSgpIHsKICAgICAgICBpZiAoX3NlcmlhbGl6YWJs\nZUZpZWxkID09IG51bGwpIHsKICAgICAgICAgICAgQ2xhc3MgZHQgPSBnZXRE\nZWNsYXJlZFR5cGUoKTsKICAgICAgICAgICAgaWYgKFNlcmlhbGl6YWJsZS5j\nbGFzcy5pc0Fzc2lnbmFibGVGcm9tKGR0KSkKICAgICAgICAgICAgICAgIF9z\nZXJpYWxpemFibGVGaWVsZCA9IEJvb2xlYW4uVFJVRTsKICAgICAgICAgICAg\nZWxzZQogICAgICAgICAgICAgICAgX3NlcmlhbGl6YWJsZUZpZWxkID0gQm9v\nbGVhbi5GQUxTRTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIF9zZXJpYWxp\nemFibGVGaWVsZC5ib29sZWFuVmFsdWUoKTsKICAgIH0KCiAgICBwcml2YXRl\nIGJvb2xlYW4gaXNMb2JBcnJheSgpIHsKICAgICAgICAvLyBjaGVjayBmb3Ig\nYnl0ZVtdLCBCeXRlW10sIGNoYXJbXSwgQ2hhcmFjdGVyW10KICAgICAgICBp\nZiAoX2xvYkZpZWxkID09IG51bGwpIHsKICAgICAgICAgICAgQ2xhc3MgZHQg\nPSBnZXREZWNsYXJlZFR5cGUoKTsKICAgICAgICAgICAgaWYgKGR0ID09IGJ5\ndGVbXS5jbGFzcyB8fCBkdCA9PSBCeXRlW10uY2xhc3MgfHwKICAgICAgICAg\nICAgICAgIGR0ID09IGNoYXJbXS5jbGFzcyB8fCBkdCA9PSBDaGFyYWN0ZXJb\nXS5jbGFzcykKICAgICAgICAgICAgICAgIF9sb2JGaWVsZCA9IEJvb2xlYW4u\nVFJVRTsKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgX2xvYkZp\nZWxkID0gQm9vbGVhbi5GQUxTRTsKICAgICAgICB9CiAgICAgICAgcmV0dXJu\nIF9sb2JGaWVsZC5ib29sZWFuVmFsdWUoKTsKICAgIH0KCiAgICAvKioKICAg\nICAqIFdoZXRoZXIgdGhpcyBmaWVsZCBpcyBpbiB0aGUgZGVmYXVsdCBmZXRj\naCBncm91cC4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0SW5EZWZhdWx0\nRmV0Y2hHcm91cChib29sZWFuIGRmZykgewogICAgICAgIGlmIChkZmcpCiAg\nICAgICAgICAgIF9kZmcgPSBERkdfVFJVRTsKICAgICAgICBlbHNlCiAgICAg\nICAgICAgIF9kZmcgPSBERkdfRkFMU0U7CiAgICAgICAgX2RmZyB8PSBERkdf\nRVhQTElDSVQ7CiAgICB9CgogICAgLyoqCiAgICAgKiBXaGV0aGVyIHRoZSBk\nZWZhdWx0IGZldGNoIGdyb3VwIHNldHRpbmcgaXMgZXhwbGljaXQuCiAgICAg\nKi8KICAgIHB1YmxpYyBib29sZWFuIGlzRGVmYXVsdEZldGNoR3JvdXBFeHBs\naWNpdCgpIHsKICAgICAgICByZXR1cm4gKF9kZmcgJiBERkdfRVhQTElDSVQp\nID4gMDsKICAgIH0KCiAgICAvKioKICAgICAqIFdoZXRoZXIgdGhlIGRlZmF1\nbHQgZmV0Y2ggZ3JvdXAgc2V0dGluZyBpcyBleHBsaWNpdC4gQWxsb3cgc2V0\ndGluZwogICAgICogZm9yIHRlc3RpbmcuCiAgICAgKi8KICAgIHB1YmxpYyB2\nb2lkIHNldERlZmF1bHRGZXRjaEdyb3VwRXhwbGljaXQoYm9vbGVhbiBleHBs\naWNpdCkgewogICAgICAgIGlmIChleHBsaWNpdCkKICAgICAgICAgICAgX2Rm\nZyB8PSBERkdfRVhQTElDSVQ7CiAgICAgICAgZWxzZQogICAgICAgICAgICBf\nZGZnICY9IH5ERkdfRVhQTElDSVQ7CiAgICB9CgogICAgLyoqCiAgICAgKiBH\nZXRzIHRoZSBuYW1lIG9mIHRoZSBjdXN0b20gZmV0Y2ggZ3JvdXBzIHRob3Nl\nIGFyZSBhc3NvY2lhdGVkIHRvIHRoaXMgCiAgICAgKiByZWNlaXZlci4gIFRo\naXMgZG9lcyBub3QgaW5jbHVkZSB0aGUgImRlZmF1bHQiIGFuZCAiYWxsIiBm\nZXRjaCBncm91cHMuCiAgICAgKgogICAgICogQHJldHVybiB0aGUgc2V0IG9m\nIGZldGNoIGdyb3VwIG5hbWVzLCBub3QgaW5jbHVkaW5nIHRoZSBkZWZhdWx0\nIGFuZAogICAgICogYWxsIGZldGNoIGdyb3Vwcy4KICAgICAqLwogICAgcHVi\nbGljIFN0cmluZ1tdIGdldEN1c3RvbUZldGNoR3JvdXBzKCkgewogICAgICAg\nIGlmIChfZmdzID09IG51bGwpIHsKICAgICAgICAgICAgaWYgKF9mZ1NldCA9\nPSBudWxsIHx8IF9tYW5hZ2UgIT0gTUFOQUdFX1BFUlNJU1RFTlQgCiAgICAg\nICAgICAgICAgICB8fCBpc1ByaW1hcnlLZXkoKSB8fCBpc1ZlcnNpb24oKSkK\nICAgICAgICAgICAgICAgIF9mZ3MgPSBuZXcgU3RyaW5nWzBdOwogICAgICAg\nICAgICBlbHNlCiAgICAgICAgICAgICAgICBfZmdzID0gKFN0cmluZ1tdKSBf\nZmdTZXQudG9BcnJheShuZXcgU3RyaW5nW19mZ1NldC5zaXplKCldKTsKICAg\nICAgICB9CiAgICAgICAgcmV0dXJuIF9mZ3M7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBUaGUgZmV0Y2ggZ3JvdXAgdGhhdCBpcyB0byBiZSBsb2FkZWQgd2hl\nbiB0aGlzIHJlY2VpdmVyIGlzIGxvYWRlZCwgb3IKICAgICAqIG51bGwgaWYg\nbm9uZSBzZXQuCiAgICAgKi8KICAgIHB1YmxpYyBTdHJpbmcgZ2V0TG9hZEZl\ndGNoR3JvdXAgKCkgewogICAgCXJldHVybiBfbGZnOwogICAgfQogICAgCiAg\nICAvKioKICAgICAqIFRoZSBmZXRjaCBncm91cCB0aGF0IGlzIHRvIGJlIGxv\nYWRlZCB3aGVuIHRoaXMgcmVjZWl2ZXIgaXMgbG9hZGVkLCBvcgogICAgICog\nbnVsbCBpZiBub25lIHNldC4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0\nTG9hZEZldGNoR3JvdXAgKFN0cmluZyBsZmcpIHsKICAgICAgICBpZiAoIiIu\nZXF1YWxzKGxmZykpCiAgICAgICAgICAgIGxmZyA9IG51bGw7CiAgICAJX2xm\nZyA9IGxmZzsKICAgIH0KCiAgICAvKioKICAgICAqIFdoZXRoZXIgdGhpcyBm\naWVsZCBpcyBpbiB0aGUgZ2l2ZW4gZmV0Y2ggZ3JvdXAuCiAgICAgKi8KICAg\nIHB1YmxpYyBib29sZWFuIGlzSW5GZXRjaEdyb3VwKFN0cmluZyBmZykgewog\nICAgICAgIGlmIChfbWFuYWdlICE9IE1BTkFHRV9QRVJTSVNURU5UIHx8IGlz\nUHJpbWFyeUtleSgpIHx8IGlzVmVyc2lvbigpKQogICAgICAgICAgICByZXR1\ncm4gZmFsc2U7CiAgICAgICAgaWYgKEZldGNoR3JvdXAuTkFNRV9BTEwuZXF1\nYWxzKGZnKSkKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgaWYg\nKEZldGNoR3JvdXAuTkFNRV9ERUZBVUxULmVxdWFscyhmZykpCiAgICAgICAg\nICAgIHJldHVybiBpc0luRGVmYXVsdEZldGNoR3JvdXAoKTsKICAgICAgICBy\nZXR1cm4gX2ZnU2V0ICE9IG51bGwgJiYgX2ZnU2V0LmNvbnRhaW5zKGZnKTsK\nICAgIH0KCiAgICAvKioKICAgICAqIFNldCB3aGV0aGVyIHRoaXMgZmllbGQg\naXMgaW4gdGhlIGdpdmVuIGZldGNoIGdyb3VwLgogICAgICoKICAgICAqIEBw\nYXJhbSBmZyBpcyB0aGUgbmFtZSBvZiBhIGZldGNoIGdyb3VwIHRoYXQgbXVz\ndCBiZSBwcmVzZW50IGluIHRoZQogICAgICogY2xhc3MgdGhhdCBkZWNsYXJl\nZCB0aGlzIGZpZWxkIG9yIGFueSBvZiBpdHMgcGVyc2lzdGVudCBzdXBlcmNs\nYXNzZXMuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldEluRmV0Y2hHcm91\ncChTdHJpbmcgZmcsIGJvb2xlYW4gaW4pIHsKICAgICAgICBpZiAoU3RyaW5n\nVXRpbHMuaXNFbXB0eShmZykpCiAgICAgICAgICAgIHRocm93IG5ldyBNZXRh\nRGF0YUV4Y2VwdGlvbihfbG9jLmdldCgiZW1wdHktZmctbmFtZSIsIHRoaXMp\nKTsKICAgICAgICBpZiAoZmcuZXF1YWxzKEZldGNoR3JvdXAuTkFNRV9BTEwp\nKQogICAgICAgICAgICByZXR1cm47CiAgICAgICAgaWYgKGZnLmVxdWFscyhG\nZXRjaEdyb3VwLk5BTUVfREVGQVVMVCkpIHsKICAgICAgICAgICAgc2V0SW5E\nZWZhdWx0RmV0Y2hHcm91cChpbik7CiAgICAgICAgICAgIHJldHVybjsKICAg\nICAgICB9CiAgICAgICAgaWYgKF9vd25lci5nZXRGZXRjaEdyb3VwKGZnKSA9\nPSBudWxsKQogICAgICAgICAgICB0aHJvdyBuZXcgTWV0YURhdGFFeGNlcHRp\nb24oX2xvYy5nZXQoInVua25vd24tZmciLCBmZywgdGhpcykpOwogICAgICAg\nIGlmIChpbiAmJiBfZmdTZXQgPT0gbnVsbCkKICAgICAgICAgICAgX2ZnU2V0\nID0gbmV3IEhhc2hTZXQoKTsKICAgICAgICBpZiAoKGluICYmIF9mZ1NldC5h\nZGQoZmcpKQogICAgICAgICAgICB8fCAoIWluICYmIF9mZ1NldCAhPSBudWxs\nICYmIF9mZ1NldC5yZW1vdmUoZmcpKSkKICAgICAgICAgICAgX2ZncyA9IG51\nbGw7CiAgICB9CiAgICAKICAgIC8qKgogICAgICogSG93IHRoZSBkYXRhIHN0\nb3JlIHNob3VsZCB0cmVhdCBudWxsIHZhbHVlcyBmb3IgdGhpcyBmaWVsZDoK\nICAgICAqIDx1bD4KICAgICAqIDxsaT57QGxpbmsgI05VTExfVU5TRVR9OiBu\nbyB2YWx1ZSBzdXBwbGllZDwvbGk+CiAgICAgKiA8bGk+e0BsaW5rICNOVUxM\nX05PTkV9OiBsZWF2ZSBudWxsIHZhbHVlcyBhcyBudWxsIGluIHRoZSBkYXRh\nIHN0b3JlPC9saT4KICAgICAqIDxsaT57QGxpbmsgI05VTExfRVhDRVBUSU9O\nfTogdGhyb3cgYW4gZXhjZXB0aW9uIGlmIHRoaXMgZmllbGQgaXMgbnVsbAog\nICAgICogYXQgY29tbWl0PC9saT4KICAgICAqIDxsaT57QGxpbmsgI05VTExf\nREVGQVVMVH06IHVzZSB0aGUgZGF0YWJhc2UgZGVmYXVsdCBpZiB0aGlzIGZp\nZWxkIGlzCiAgICAgKiBudWxsIGF0IGNvbW1pdDwvbGk+CiAgICAgKiA8L3Vs\nPiBEZWZhdWx0cyB0byB7QGxpbmsgI05VTExfVU5TRVR9LgogICAgICovCiAg\nICBwdWJsaWMgaW50IGdldE51bGxWYWx1ZSgpIHsKICAgICAgICByZXR1cm4g\nX251bGxWYWx1ZTsKICAgIH0KCiAgICAvKioKICAgICAqIEhvdyB0aGUgZGF0\nYSBzdG9yZSBzaG91bGQgdHJlYXQgbnVsbCB2YWx1ZXMgZm9yIHRoaXMgZmll\nbGQ6CiAgICAgKiA8dWw+CiAgICAgKiA8bGk+e0BsaW5rICNOVUxMX1VOU0VU\nfTogbm8gdmFsdWUgc3VwcGxpZWQ8L2xpPgogICAgICogPGxpPntAbGluayAj\nTlVMTF9OT05FfTogbGVhdmUgbnVsbCB2YWx1ZXMgYXMgbnVsbCBpbiB0aGUg\nZGF0YSBzdG9yZTwvbGk+CiAgICAgKiA8bGk+e0BsaW5rICNOVUxMX0VYQ0VQ\nVElPTn06IHRocm93IGFuIGV4Y2VwdGlvbiBpZiB0aGlzIGZpZWxkIGlzIG51\nbGwKICAgICAqIGF0IGNvbW1pdDwvbGk+CiAgICAgKiA8bGk+e0BsaW5rICNO\nVUxMX0RFRkFVTFR9OiB1c2UgdGhlIGRhdGFiYXNlIGRlZmF1bHQgaWYgdGhp\ncyBmaWVsZCBpcwogICAgICogbnVsbCBhdCBjb21taXQ8L2xpPgogICAgICog\nPC91bD4gRGVmYXVsdHMgdG8ge0BsaW5rICNOVUxMX1VOU0VUfS4KICAgICAq\nLwogICAgcHVibGljIHZvaWQgc2V0TnVsbFZhbHVlKGludCBudWxsVmFsdWUp\nIHsKICAgICAgICBfbnVsbFZhbHVlID0gbnVsbFZhbHVlOwogICAgfQoKICAg\nIC8qKgogICAgICogV2hldGhlciB0aGlzIGZpZWxkIGlzIGV4cGxpY2l0bHkg\nZGVjbGFyZWQgaW4gdGhlIG1ldGFkYXRhLgogICAgICovCiAgICBwdWJsaWMg\nYm9vbGVhbiBpc0V4cGxpY2l0KCkgewogICAgICAgIHJldHVybiBfZXhwbGlj\naXQ7CiAgICB9CgogICAgLyoqCiAgICAgKiBXaGV0aGVyIHRoaXMgZmllbGQg\naXMgZXhwbGljaXRseSBkZWNsYXJlZCBpbiB0aGUgbWV0YWRhdGEuCiAgICAg\nKi8KICAgIHB1YmxpYyB2b2lkIHNldEV4cGxpY2l0KGJvb2xlYW4gZXhwbGlj\naXQpIHsKICAgICAgICBfZXhwbGljaXQgPSBleHBsaWNpdDsKICAgIH0KCiAg\nICAvKioKICAgICAqIFRoZSBmaWVsZCB0aGF0IHRoaXMgZmllbGQgc2hhcmVz\nIGEgbWFwcGluZyB3aXRoLgogICAgICovCiAgICBwdWJsaWMgU3RyaW5nIGdl\ndE1hcHBlZEJ5KCkgewogICAgICAgIHJldHVybiBfbWFwcGVkQnk7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBUaGUgZmllbGQgdGhhdCB0aGlzIGZpZWxkIHNo\nYXJlcyBhIG1hcHBpbmcgd2l0aC4KICAgICAqLwogICAgcHVibGljIHZvaWQg\nc2V0TWFwcGVkQnkoU3RyaW5nIG1hcHBlZCkgewogICAgICAgIF9tYXBwZWRC\neSA9IG1hcHBlZDsKICAgICAgICBfbWFwcGVkQnlNZXRhID0gbnVsbDsKICAg\nIH0KCiAgICAvKioKICAgICAqIFRoZSBmaWVsZCB0aGF0IHRoaXMgZmllbGQg\nc2hhcmVzIGEgbWFwcGluZyB3aXRoLgogICAgICovCiAgICBwdWJsaWMgRmll\nbGRNZXRhRGF0YSBnZXRNYXBwZWRCeU1ldGFEYXRhKCkgewogICAgICAgIGlm\nIChfbWFwcGVkQnkgIT0gbnVsbCAmJiBfbWFwcGVkQnlNZXRhID09IG51bGwp\nIHsKICAgICAgICAgICAgQ2xhc3NNZXRhRGF0YSBtZXRhID0gbnVsbDsKICAg\nICAgICAgICAgc3dpdGNoIChnZXRUeXBlQ29kZSgpKSB7CiAgICAgICAgICAg\nICAgICBjYXNlIEphdmFUeXBlcy5QQzoKICAgICAgICAgICAgICAgICAgICBt\nZXRhID0gZ2V0VHlwZU1ldGFEYXRhKCk7CiAgICAgICAgICAgICAgICAgICAg\nYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5BUlJBWToK\nICAgICAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLkNPTExFQ1RJT046CiAg\nICAgICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5NQVA6CiAgICAgICAgICAg\nICAgICAgICAgbWV0YSA9IF9lbGVtLmdldFR5cGVNZXRhRGF0YSgpOwogICAg\nICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CgogICAgICAg\nICAgICBGaWVsZE1ldGFEYXRhIGZpZWxkID0gKG1ldGEgPT0gbnVsbCkgPyBu\ndWxsCiAgICAgICAgICAgICAgICA6IG1ldGEuZ2V0RmllbGQoX21hcHBlZEJ5\nKTsKICAgICAgICAgICAgaWYgKGZpZWxkID09IG51bGwpCiAgICAgICAgICAg\nICAgICB0aHJvdyBuZXcgTWV0YURhdGFFeGNlcHRpb24oX2xvYy5nZXQoIm5v\nLW1hcHBlZC1ieSIsIHRoaXMsCiAgICAgICAgICAgICAgICAgICAgX21hcHBl\nZEJ5KSk7CiAgICAgICAgICAgIGlmIChmaWVsZC5nZXRNYXBwZWRCeSgpICE9\nIG51bGwpCiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgTWV0YURhdGFFeGNl\ncHRpb24oX2xvYy5nZXQoImNpcmMtbWFwcGVkLWJ5IiwgdGhpcywKICAgICAg\nICAgICAgICAgICAgICBfbWFwcGVkQnkpKTsKICAgICAgICAgICAgX21hcHBl\nZEJ5TWV0YSA9IGZpZWxkOwogICAgICAgIH0KICAgICAgICByZXR1cm4gX21h\ncHBlZEJ5TWV0YTsKICAgIH0KCiAgICAvKioKICAgICAqIExvZ2ljYWwgaW52\nZXJzZSBmaWVsZC4KICAgICAqLwogICAgcHVibGljIFN0cmluZyBnZXRJbnZl\ncnNlKCkgewogICAgICAgIGlmIChDbGFzc01ldGFEYXRhLkRFRkFVTFRfU1RS\nSU5HLmVxdWFscyhfaW52ZXJzZSkpCiAgICAgICAgICAgIF9pbnZlcnNlID0g\nbnVsbDsKICAgICAgICByZXR1cm4gX2ludmVyc2U7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBMb2dpY2FsIGludmVyc2UgZmllbGQuCiAgICAgKi8KICAgIHB1\nYmxpYyB2b2lkIHNldEludmVyc2UoU3RyaW5nIGludmVyc2UpIHsKICAgICAg\nICBfaW52ZXJzZXMgPSBudWxsOwogICAgICAgIF9pbnZlcnNlID0gaW52ZXJz\nZTsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiBhbGwgaW52ZXJzZXMg\nb2YgdGhpcyBmaWVsZC4KICAgICAqLwogICAgcHVibGljIEZpZWxkTWV0YURh\ndGFbXSBnZXRJbnZlcnNlTWV0YURhdGFzKCkgewogICAgICAgIGlmIChfaW52\nZXJzZXMgPT0gbnVsbCkgewogICAgICAgICAgICAvLyBjYW4ndCBkZWNsYXJl\nIGJvdGggYW4gaW52ZXJzZSBvd25lciBhbmQgYSBsb2dpY2FsIGludmVyc2UK\nICAgICAgICAgICAgU3RyaW5nIGludiA9IGdldEludmVyc2UoKTsKICAgICAg\nICAgICAgaWYgKF9tYXBwZWRCeSAhPSBudWxsICYmIGludiAhPSBudWxsICYm\nICFfbWFwcGVkQnkuZXF1YWxzKGludikpCiAgICAgICAgICAgICAgICB0aHJv\ndyBuZXcgTWV0YURhdGFFeGNlcHRpb24oX2xvYy5nZXQoIm1hcHBlZC1ub3Qt\naW52ZXJzZSIsCiAgICAgICAgICAgICAgICAgICAgdGhpcykpOwoKICAgICAg\nICAgICAgLy8gZ2V0IHRoZSBtZXRhZGF0YSBmb3IgdGhlIHR5cGUgb24gdGhl\nIG90aGVyIHNpZGUgb2YgdGhpcyByZWxhdGlvbgogICAgICAgICAgICBDbGFz\nc01ldGFEYXRhIG1ldGEgPSBudWxsOwogICAgICAgICAgICBzd2l0Y2ggKGdl\ndFR5cGVDb2RlKCkpIHsKICAgICAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVz\nLlBDOgogICAgICAgICAgICAgICAgICAgIG1ldGEgPSBnZXRUeXBlTWV0YURh\ndGEoKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAg\nICAgIGNhc2UgSmF2YVR5cGVzLkFSUkFZOgogICAgICAgICAgICAgICAgY2Fz\nZSBKYXZhVHlwZXMuQ09MTEVDVElPTjoKICAgICAgICAgICAgICAgICAgICBt\nZXRhID0gX2VsZW0uZ2V0VHlwZU1ldGFEYXRhKCk7CiAgICAgICAgICAgICAg\nICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIENvbGxl\nY3Rpb24gaW52ZXJzZXMgPSBudWxsOwogICAgICAgICAgICBpZiAobWV0YSAh\nPSBudWxsKSB7CiAgICAgICAgICAgICAgICAvLyBhZGQgbWFwcGVkIGJ5IGFu\nZCBuYW1lZCBpbnZlcnNlLCBpZiBhbnkKICAgICAgICAgICAgICAgIEZpZWxk\nTWV0YURhdGEgZmllbGQgPSBnZXRNYXBwZWRCeU1ldGFEYXRhKCk7CiAgICAg\nICAgICAgICAgICBpZiAoZmllbGQgIT0gbnVsbCkgewogICAgICAgICAgICAg\nICAgICAgIC8vIG1hcHBlZCBieSBmaWVsZCBpc24ndCBuZWNlc3NhcmlseSBh\nIHBjIHR5cGUsIGJ1dCBhbGwKICAgICAgICAgICAgICAgICAgICAvLyBpbnZl\ncnNlcyBtdXN0IGJlCiAgICAgICAgICAgICAgICAgICAgaWYgKGZpZWxkLmdl\ndFR5cGVDb2RlKCkgPT0gSmF2YVR5cGVzLlBDCiAgICAgICAgICAgICAgICAg\nICAgICAgIHx8IGZpZWxkLmdldEVsZW1lbnQoKS5nZXRUeXBlQ29kZSgpID09\nIEphdmFUeXBlcy5QQykgewogICAgICAgICAgICAgICAgICAgICAgICBpbnZl\ncnNlcyA9IG5ldyBBcnJheUxpc3QoMyk7CiAgICAgICAgICAgICAgICAgICAg\nICAgIGludmVyc2VzLmFkZChmaWVsZCk7CiAgICAgICAgICAgICAgICAgICAg\nfQogICAgICAgICAgICAgICAgfSBlbHNlIGlmIChpbnYgIT0gbnVsbCkgewog\nICAgICAgICAgICAgICAgICAgIGZpZWxkID0gbWV0YS5nZXRGaWVsZChpbnYp\nOwogICAgICAgICAgICAgICAgICAgIGlmIChmaWVsZCA9PSBudWxsKQogICAg\nICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgTWV0YURhdGFFeGNlcHRp\nb24oX2xvYy5nZXQoIm5vLWludmVyc2UiLAogICAgICAgICAgICAgICAgICAg\nICAgICAgICAgdGhpcywgaW52KSk7CiAgICAgICAgICAgICAgICAgICAgaW52\nZXJzZXMgPSBuZXcgQXJyYXlMaXN0KDMpOwogICAgICAgICAgICAgICAgICAg\nIGludmVyc2VzLmFkZChmaWVsZCk7CiAgICAgICAgICAgICAgICB9CgogICAg\nICAgICAgICAgICAgLy8gc2NhbiByZWwgdHlwZSBmb3IgZmllbGRzIHRoYXQg\nbmFtZSB0aGlzIGZpZWxkIGFzIGFuIGludmVyc2UKICAgICAgICAgICAgICAg\nIEZpZWxkTWV0YURhdGFbXSBmaWVsZHMgPSBtZXRhLmdldEZpZWxkcygpOwog\nICAgICAgICAgICAgICAgQ2xhc3MgdHlwZSA9IGdldERlY2xhcmluZ01ldGFE\nYXRhKCkuZ2V0RGVzY3JpYmVkVHlwZSgpOwogICAgICAgICAgICAgICAgZm9y\nIChpbnQgaSA9IDA7IGkgPCBmaWVsZHMubGVuZ3RoOyBpKyspIHsKICAgICAg\nICAgICAgICAgICAgICAvLyBza2lwIGZpZWxkcyB0aGF0IGFyZW4ndCBjb21w\nYXRpYmxlIHdpdGggb3VyIG93bmluZyBjbGFzcwogICAgICAgICAgICAgICAg\nICAgIHN3aXRjaCAoZmllbGRzW2ldLmdldFR5cGVDb2RlKCkpIHsKICAgICAg\nICAgICAgICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuUEM6CiAgICAgICAg\nICAgICAgICAgICAgICAgICAgICBpZiAoIXR5cGUuaXNBc3NpZ25hYmxlRnJv\nbShmaWVsZHNbaV0uZ2V0VHlwZSgpKSkKICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgICAgICAgICAgICAg\nICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgICAgICBjYXNlIEphdmFU\neXBlcy5DT0xMRUNUSU9OOgogICAgICAgICAgICAgICAgICAgICAgICBjYXNl\nIEphdmFUeXBlcy5BUlJBWToKICAgICAgICAgICAgICAgICAgICAgICAgICAg\nIGlmICghdHlwZS5pc0Fzc2lnbmFibGVGcm9tKGZpZWxkc1tpXS4KICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICBnZXRFbGVtZW50KCkuZ2V0VHlw\nZSgpKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51\nZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAg\nICAgICAgICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgICAgICAg\nICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgICAgICAgICAgfQoKICAg\nICAgICAgICAgICAgICAgICAvLyBpZiB0aGUgZmllbGQgZGVjbGFyZXMgdXMg\nYXMgaXRzIGludmVyc2UgYW5kIHdlIGhhdmVuJ3QKICAgICAgICAgICAgICAg\nICAgICAvLyBhbHJlYWR5IGFkZGVkIGl0ICh3ZSBtaWdodCBoYXZlIGlmIHdl\nIGFsc28gZGVjbGFyZWQgaXQKICAgICAgICAgICAgICAgICAgICAvLyBhcyBv\ndXIgaW52ZXJzZSksIGFkZCBpdCBub3cKICAgICAgICAgICAgICAgICAgICBp\nZiAoX25hbWUuZXF1YWxzKGZpZWxkc1tpXS5nZXRNYXBwZWRCeSgpKQogICAg\nICAgICAgICAgICAgICAgICAgICB8fCBfbmFtZS5lcXVhbHMoZmllbGRzW2ld\nLmdldEludmVyc2UoKSkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYg\nKGludmVyc2VzID09IG51bGwpCiAgICAgICAgICAgICAgICAgICAgICAgICAg\nICBpbnZlcnNlcyA9IG5ldyBBcnJheUxpc3QoMyk7CiAgICAgICAgICAgICAg\nICAgICAgICAgIGlmICghaW52ZXJzZXMuY29udGFpbnMoZmllbGRzW2ldKSkK\nICAgICAgICAgICAgICAgICAgICAgICAgICAgIGludmVyc2VzLmFkZChmaWVs\nZHNbaV0pOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAg\nIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgTWV0YURhdGFSZXBvc2l0\nb3J5IHJlcG9zID0gZ2V0UmVwb3NpdG9yeSgpOwogICAgICAgICAgICBpZiAo\naW52ZXJzZXMgPT0gbnVsbCkKICAgICAgICAgICAgICAgIF9pbnZlcnNlcyA9\nIHJlcG9zLkVNUFRZX0ZJRUxEUzsKICAgICAgICAgICAgZWxzZQogICAgICAg\nICAgICAgICAgX2ludmVyc2VzID0gKEZpZWxkTWV0YURhdGFbXSkgaW52ZXJz\nZXMudG9BcnJheQogICAgICAgICAgICAgICAgICAgIChyZXBvcy5uZXdGaWVs\nZE1ldGFEYXRhQXJyYXkoaW52ZXJzZXMuc2l6ZSgpKSk7CiAgICAgICAgfQog\nICAgICAgIHJldHVybiBfaW52ZXJzZXM7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBUaGUgc3RyYXRlZ3kgdG8gdXNlIGZvciBpbnNlcnQgdmFsdWUgZ2VuZXJh\ndGlvbi4KICAgICAqIE9uZSBvZiB0aGUgY29uc3RhbnRzIGZyb20ge0BsaW5r\nIFZhbHVlU3RyYXRlZ2llc30uCiAgICAgKi8KICAgIHB1YmxpYyBpbnQgZ2V0\nVmFsdWVTdHJhdGVneSgpIHsKICAgICAgICBpZiAoX3ZhbFN0cmF0ZWd5ID09\nIC0xKQogICAgICAgICAgICBfdmFsU3RyYXRlZ3kgPSBWYWx1ZVN0cmF0ZWdp\nZXMuTk9ORTsKICAgICAgICByZXR1cm4gX3ZhbFN0cmF0ZWd5OwogICAgfQoK\nICAgIC8qKgogICAgICogVGhlIHN0cmF0ZWd5IHRvIHVzZSBmb3IgaW5zZXJ0\nIHZhbHVlIGdlbmVyYXRpb24uCiAgICAgKiBPbmUgb2YgdGhlIGNvbnN0YW50\ncyBmcm9tIHtAbGluayBWYWx1ZVN0cmF0ZWdpZXN9LgogICAgICovCiAgICBw\ndWJsaWMgdm9pZCBzZXRWYWx1ZVN0cmF0ZWd5KGludCBzdHJhdGVneSkgewog\nICAgICAgIF92YWxTdHJhdGVneSA9IHN0cmF0ZWd5OwogICAgICAgIGlmIChz\ndHJhdGVneSAhPSBWYWx1ZVN0cmF0ZWdpZXMuU0VRVUVOQ0UpCiAgICAgICAg\nICAgIHNldFZhbHVlU2VxdWVuY2VOYW1lKG51bGwpOwogICAgfQoKICAgIC8q\nKgogICAgICogVGhlIHZhbHVlIHNlcXVlbmNlIG5hbWUsIG9yIG51bGwgZm9y\nIG5vbmUuCiAgICAgKi8KICAgIHB1YmxpYyBTdHJpbmcgZ2V0VmFsdWVTZXF1\nZW5jZU5hbWUoKSB7CiAgICAgICAgaWYgKENsYXNzTWV0YURhdGEuREVGQVVM\nVF9TVFJJTkcuZXF1YWxzKF9zZXFOYW1lKSkKICAgICAgICAgICAgX3NlcU5h\nbWUgPSBudWxsOwogICAgICAgIHJldHVybiBfc2VxTmFtZTsKICAgIH0KCiAg\nICAvKioKICAgICAqIFRoZSB2YWx1ZSBzZXF1ZW5jZSBuYW1lLCBvciBudWxs\nIGZvciBub25lLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRWYWx1ZVNl\ncXVlbmNlTmFtZShTdHJpbmcgc2VxTmFtZSkgewogICAgICAgIF9zZXFOYW1l\nID0gc2VxTmFtZTsKICAgICAgICBfc2VxTWV0YSA9IG51bGw7CiAgICAgICAg\naWYgKHNlcU5hbWUgIT0gbnVsbCkKICAgICAgICAgICAgc2V0VmFsdWVTdHJh\ndGVneShWYWx1ZVN0cmF0ZWdpZXMuU0VRVUVOQ0UpOwogICAgfQoKICAgIC8q\nKgogICAgICogTWV0YWRhdGEgZm9yIHRoZSB2YWx1ZSBzZXF1ZW5jZS4KICAg\nICAqLwogICAgcHVibGljIFNlcXVlbmNlTWV0YURhdGEgZ2V0VmFsdWVTZXF1\nZW5jZU1ldGFEYXRhKCkgewogICAgICAgIGlmIChfc2VxTWV0YSA9PSBudWxs\nICYmIGdldFZhbHVlU2VxdWVuY2VOYW1lKCkgIT0gbnVsbCkKICAgICAgICAg\nICAgX3NlcU1ldGEgPSBnZXRSZXBvc2l0b3J5KCkuZ2V0U2VxdWVuY2VNZXRh\nRGF0YShfb3duZXIsCiAgICAgICAgICAgICAgICBnZXRWYWx1ZVNlcXVlbmNl\nTmFtZSgpLCB0cnVlKTsKICAgICAgICByZXR1cm4gX3NlcU1ldGE7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBUaGUgc3RyYXRlZ3kgdG8gdXNlIHdoZW4gdXBk\nYXRpbmcgdGhlIGZpZWxkLgogICAgICovCiAgICBwdWJsaWMgaW50IGdldFVw\nZGF0ZVN0cmF0ZWd5KCkgewogICAgICAgIGlmIChpc1ZlcnNpb24oKSkKICAg\nICAgICAgICAgcmV0dXJuIFVwZGF0ZVN0cmF0ZWdpZXMuUkVTVFJJQ1Q7CiAg\nICAgICAgaWYgKF91cFN0cmF0ZWd5ID09IC0xKQogICAgICAgICAgICBfdXBT\ndHJhdGVneSA9IFVwZGF0ZVN0cmF0ZWdpZXMuTk9ORTsKICAgICAgICByZXR1\ncm4gX3VwU3RyYXRlZ3k7CiAgICB9CgogICAgLyoqCiAgICAgKiBTZXQgdGhl\nIHVwZGF0ZSBzdHJhdGVneS4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0\nVXBkYXRlU3RyYXRlZ3koaW50IHN0cmF0ZWd5KSB7CiAgICAgICAgX3VwU3Ry\nYXRlZ3kgPSBzdHJhdGVneTsKICAgIH0KCiAgICAvKioKICAgICAqIFdoZXRo\nZXIgdGhpcyBmaWVsZCBpcyBiYWNrZWQgYnkgYSBsYXJnZSByZXN1bHQgc2V0\nLgogICAgICovCiAgICBwdWJsaWMgYm9vbGVhbiBpc0xSUygpIHsKICAgICAg\nICByZXR1cm4gX2xycyA9PSBCb29sZWFuLlRSVUUgJiYgX21hbmFnZSA9PSBN\nQU5BR0VfUEVSU0lTVEVOVDsKICAgIH0KCiAgICAvKioKICAgICAqIFdoZXRo\nZXIgdGhpcyBmaWVsZCBpcyBiYWNrZWQgYnkgYSBsYXJnZSByZXN1bHQgc2V0\nLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRMUlMoYm9vbGVhbiBscnMp\nIHsKICAgICAgICBfbHJzID0gKGxycykgPyBCb29sZWFuLlRSVUUgOiBCb29s\nZWFuLkZBTFNFOwogICAgfQoKICAgIC8qKgogICAgICogV2hldGhlciB0aGlz\nIGZpZWxkIHVzZXMgaW50ZXJtZWRpYXRlIGRhdGEgd2hlbiBsb2FkaW5nL3N0\nb3JpbmcKICAgICAqIGluZm9ybWF0aW9uIHRocm91Z2ggYSB7QGxpbmsgT3Bl\nbkpQQVN0YXRlTWFuYWdlcn0uIERlZmF1bHRzIHRvIHRydWUuCiAgICAgKgog\nICAgICogQHNlZSBPcGVuSlBBU3RhdGVNYW5hZ2VyI3NldEludGVybWVkaWF0\nZShpbnQsT2JqZWN0KQogICAgICovCiAgICBwdWJsaWMgYm9vbGVhbiB1c2Vz\nSW50ZXJtZWRpYXRlKCkgewogICAgICAgIHJldHVybiBfaW50ZXJtZWRpYXRl\nOwogICAgfQoKICAgIC8qKgogICAgICogV2hldGhlciB0aGlzIGZpZWxkIHVz\nZXMgaW50ZXJtZWRpYXRlIGRhdGEgd2hlbiBsb2FkaW5nL3N0b3JpbmcKICAg\nICAqIGluZm9ybWF0aW9uIHRocm91Z2ggYSB7QGxpbmsgT3BlbkpQQVN0YXRl\nTWFuYWdlcn0uIERlZmF1bHRzIHRvIHRydWUuCiAgICAgKgogICAgICogQHNl\nZSBPcGVuSlBBU3RhdGVNYW5hZ2VyI3NldEludGVybWVkaWF0ZShpbnQsT2Jq\nZWN0KQogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRVc2VzSW50ZXJtZWRp\nYXRlKGJvb2xlYW4gaW50ZXJtZWRpYXRlKSB7CiAgICAgICAgX2ludGVybWVk\naWF0ZSA9IGludGVybWVkaWF0ZTsKICAgICAgICBfb3duZXIuY2xlYXJFeHRy\nYUZpZWxkRGF0YVRhYmxlKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBXaGV0\naGVyIHRoaXMgZmllbGQgdXNlcyBpbXBsIGRhdGEgaW4gY29uanVuY3Rpb24g\nd2l0aCBzdGFuZGFyZAogICAgICogZmllbGQgZGF0YSB3aGVuIGFjdGluZyBv\nbiBhIHtAbGluayBPcGVuSlBBU3RhdGVNYW5hZ2VyfS4KICAgICAqIERlZmF1\nbHRzIHRvIHtAbGluayBCb29sZWFuI1RSVUV9IChub24tY2FjaGFibGUgaW1w\nbCBkYXRhKS4KICAgICAqCiAgICAgKiBAcmV0dXJuIHtAbGluayBCb29sZWFu\nI0ZBTFNFfSBpZiB0aGlzIGZpZWxkIGRvZXMgbm90IHVzZSBpbXBsIGRhdGEs\nCiAgICAgKiB7QGxpbmsgQm9vbGVhbiNUUlVFfSBpZiB0aGlzIGZpZWxkIHVz\nZXMgbm9uLWNhY2hhYmxlIGltcGwKICAgICAqIGRhdGEsIG9yIDxjb2RlPm51\nbGw8L2NvZGU+IGlmIHRoaXMgZmllbGQgdXNlcyBpbXBsIGRhdGEgdGhhdAog\nICAgICogc2hvdWxkIGJlIGNhY2hlZCBhY3Jvc3MgaW5zdGFuY2VzCiAgICAg\nKiBAc2VlIE9wZW5KUEFTdGF0ZU1hbmFnZXIjc2V0SW1wbERhdGEoaW50LE9i\namVjdCkKICAgICAqLwogICAgcHVibGljIEJvb2xlYW4gdXNlc0ltcGxEYXRh\nKCkgewogICAgICAgIHJldHVybiBfaW1wbERhdGE7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBXaGV0aGVyIHRoaXMgZmllbGQgdXNlcyBpbXBsIGRhdGEgaW4g\nY29uanVuY3Rpb24gd2l0aCBzdGFuZGFyZAogICAgICogZmllbGQgZGF0YSB3\naGVuIGFjdGluZyBvbiBhIHtAbGluayBPcGVuSlBBU3RhdGVNYW5hZ2VyfS4K\nICAgICAqCiAgICAgKiBAc2VlIE9wZW5KUEFTdGF0ZU1hbmFnZXIjc2V0SW1w\nbERhdGEoaW50LE9iamVjdCkKICAgICAqIEBzZWUgI3VzZXNJbXBsRGF0YQog\nICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRVc2VzSW1wbERhdGEoQm9vbGVh\nbiBpbXBsRGF0YSkgewogICAgICAgIF9pbXBsRGF0YSA9IGltcGxEYXRhOwog\nICAgICAgIF9vd25lci5jbGVhckV4dHJhRmllbGREYXRhVGFibGUoKTsKICAg\nIH0KCiAgICAvKioKICAgICAqIFRoZSBvcmRlcmluZ3MgZm9yIHRoaXMgZmll\nbGQgdG8gYmUgYXBwbGllZCBvbiBsb2FkLCBvciBlbXB0eSBhcnJheS4KICAg\nICAqLwogICAgcHVibGljIE9yZGVyW10gZ2V0T3JkZXJzKCkgewogICAgICAg\nIGlmIChfb3JkZXJzID09IG51bGwpIHsKICAgICAgICAgICAgaWYgKF9vcmRl\nckRlYyA9PSBudWxsKQogICAgICAgICAgICAgICAgX29yZGVycyA9IGdldFJl\ncG9zaXRvcnkoKS5FTVBUWV9PUkRFUlM7CiAgICAgICAgICAgIGVsc2Ugewog\nICAgICAgICAgICAgICAgU3RyaW5nW10gZGVjcyA9IFN0cmluZ3Muc3BsaXQo\nX29yZGVyRGVjLCAiLCIsIDApOwogICAgICAgICAgICAgICAgT3JkZXJbXSBv\ncmRlcnMgPSBnZXRSZXBvc2l0b3J5KCkubmV3T3JkZXJBcnJheShkZWNzLmxl\nbmd0aCk7CiAgICAgICAgICAgICAgICBpbnQgc3BjOwogICAgICAgICAgICAg\nICAgYm9vbGVhbiBhc2M7CiAgICAgICAgICAgICAgICBmb3IgKGludCBpID0g\nMDsgaSA8IGRlY3MubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICAgICAg\nICBkZWNzW2ldID0gZGVjc1tpXS50cmltKCk7CiAgICAgICAgICAgICAgICAg\nICAgc3BjID0gZGVjc1tpXS5pbmRleE9mKCcgJyk7CiAgICAgICAgICAgICAg\nICAgICAgaWYgKHNwYyA9PSAtMSkKICAgICAgICAgICAgICAgICAgICAgICAg\nYXNjID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAg\nICAgICAgICAgICAgICAgICAgYXNjID0gZGVjc1tpXS5zdWJzdHJpbmcoc3Bj\nICsgMSkudHJpbSgpLgogICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9M\nb3dlckNhc2UoKS5zdGFydHNXaXRoKCJhc2MiKTsKICAgICAgICAgICAgICAg\nICAgICAgICAgZGVjc1tpXSA9IGRlY3NbaV0uc3Vic3RyaW5nKDAsIHNwYyk7\nCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIG9y\nZGVyc1tpXSA9IGdldFJlcG9zaXRvcnkoKS5uZXdPcmRlcih0aGlzLCBkZWNz\nW2ldLCBhc2MpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAg\nX29yZGVycyA9IG9yZGVyczsKICAgICAgICAgICAgfQogICAgICAgIH0KICAg\nICAgICByZXR1cm4gX29yZGVyczsKICAgIH0KCiAgICAvKioKICAgICAqIFRo\nZSBvcmRlcmluZ3MgZm9yIHRoaXMgZmllbGQgdG8gYmUgYXBwbGllZCBvbiBs\nb2FkLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRPcmRlcnMoT3JkZXJb\nXSBvcmRlcnMpIHsKICAgICAgICBfb3JkZXJEZWMgPSBudWxsOwogICAgICAg\nIF9vcmRlcnMgPSBvcmRlcnM7CiAgICB9CgogICAgLyoqCiAgICAgKiBTdHJp\nbmcgZGVjbGFyaW5nIHRoZSBvcmRlcmluZ3MgZm9yIHRoaXMgZmllbGQgdG8g\nYmUgYXBwbGllZCBvbiBsb2FkLAogICAgICogb3IgbnVsbC4gVGhlIHN0cmlu\nZyBpcyBvZiB0aGUgZm9ybTo8YnIgLz4KICAgICAqIDxjb2RlPm9yZGVyYWJs\nZVsgYXNjfGRlc2NdWywgLi4uXTwvY29kZT48YnIgLz4KICAgICAqIFRoZSBv\ncmRlcmFibGUgPGNvZGU+I2VsZW1lbnQ8L2NvZGU+IGlzIHVzZWQgdG8gZGVu\nb3RlIHRoZSB2YWx1ZSBvZgogICAgICogdGhlIGZpZWxkJ3MgZWxlbWVudHMu\nCiAgICAgKi8KICAgIHB1YmxpYyBTdHJpbmcgZ2V0T3JkZXJEZWNsYXJhdGlv\nbigpIHsKICAgICAgICBpZiAoX29yZGVyRGVjID09IG51bGwgJiYgX29yZGVy\ncyAhPSBudWxsKSB7CiAgICAgICAgICAgIFN0cmluZ0J1ZmZlciBidWYgPSBu\nZXcgU3RyaW5nQnVmZmVyKCk7CiAgICAgICAgICAgIGZvciAoaW50IGkgPSAw\nOyBpIDwgX29yZGVycy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAg\naWYgKGkgPiAwKQogICAgICAgICAgICAgICAgICAgIGJ1Zi5hcHBlbmQoIiwg\nIik7CiAgICAgICAgICAgICAgICBidWYuYXBwZW5kKF9vcmRlcnNbaV0uZ2V0\nTmFtZSgpKS5hcHBlbmQoIiAiKTsKICAgICAgICAgICAgICAgIGJ1Zi5hcHBl\nbmQoKF9vcmRlcnNbaV0uaXNBc2NlbmRpbmcoKSkgPyAiYXNjIiA6ICJkZXNj\nIik7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgX29yZGVyRGVjID0gYnVm\nLnRvU3RyaW5nKCk7CiAgICAgICAgfQogICAgICAgIHJldHVybiBfb3JkZXJE\nZWM7CiAgICB9CgogICAgLyoqCiAgICAgKiBTdHJpbmcgZGVjbGFyaW5nIHRo\nZSBvcmRlcmluZ3MgZm9yIHRoaXMgZmllbGQgdG8gYmUgYXBwbGllZCBvbiBs\nb2FkLAogICAgICogb3IgbnVsbC4gVGhlIHN0cmluZyBpcyBvZiB0aGUgZm9y\nbTo8YnIgLz4KICAgICAqIDxjb2RlPm9yZGVyYWJsZVsgYXNjfGRlc2NdWywg\nLi4uXTwvY29kZT48YnIgLz4KICAgICAqIFRoZSBvcmRlcmFibGUgPGNvZGU+\nI2VsZW1lbnQ8L2NvZGU+IGlzIHVzZWQgdG8gZGVub3RlIHRoZSB2YWx1ZSBv\nZgogICAgICogdGhlIGZpZWxkJ3MgZWxlbWVudHMuCiAgICAgKi8KICAgIHB1\nYmxpYyB2b2lkIHNldE9yZGVyRGVjbGFyYXRpb24oU3RyaW5nIGRlYykgewog\nICAgICAgIF9vcmRlckRlYyA9IFN0cmluZ1V0aWxzLnRyaW1Ub051bGwoZGVj\nKTsKICAgICAgICBfb3JkZXJzID0gbnVsbDsKICAgIH0KCiAgICAvKioKICAg\nICAqIE9yZGVyIHRoaXMgZmllbGQgdmFsdWUgd2hlbiBpdCBpcyBsb2FkZWQu\nCiAgICAgKi8KICAgIHB1YmxpYyBPYmplY3Qgb3JkZXIoT2JqZWN0IHZhbCkg\newogICAgICAgIGlmICh2YWwgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJu\nIG51bGw7CgogICAgICAgIE9yZGVyW10gb3JkZXJzID0gZ2V0T3JkZXJzKCk7\nCiAgICAgICAgaWYgKG9yZGVycy5sZW5ndGggPT0gMCkKICAgICAgICAgICAg\ncmV0dXJuIHZhbDsKCiAgICAgICAgLy8gY3JlYXRlIGEgY29tcGFyYXRvciBm\nb3IgdGhlIGVsZW1lbnRzIG9mIHRoZSB2YWx1ZQogICAgICAgIENvbXBhcmF0\nb3IgY29tcDsKICAgICAgICBpZiAob3JkZXJzLmxlbmd0aCA9PSAxKQogICAg\nICAgICAgICBjb21wID0gb3JkZXJzWzBdLmdldENvbXBhcmF0b3IoKTsKICAg\nICAgICBlbHNlIHsKICAgICAgICAgICAgTGlzdCBjb21wcyA9IG51bGw7CiAg\nICAgICAgICAgIENvbXBhcmF0b3IgY3VyQ29tcDsKICAgICAgICAgICAgZm9y\nIChpbnQgaSA9IDA7IGkgPCBvcmRlcnMubGVuZ3RoOyBpKyspIHsKICAgICAg\nICAgICAgICAgIGN1ckNvbXAgPSBvcmRlcnNbaV0uZ2V0Q29tcGFyYXRvcigp\nOwogICAgICAgICAgICAgICAgaWYgKGN1ckNvbXAgIT0gbnVsbCkgewogICAg\nICAgICAgICAgICAgICAgIGlmIChjb21wcyA9PSBudWxsKQogICAgICAgICAg\nICAgICAgICAgICAgICBjb21wcyA9IG5ldyBBcnJheUxpc3Qob3JkZXJzLmxl\nbmd0aCk7CiAgICAgICAgICAgICAgICAgICAgaWYgKGkgIT0gY29tcHMuc2l6\nZSgpKQogICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgTWV0YURh\ndGFFeGNlcHRpb24oX2xvYy5nZXQKICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICgibWl4ZWQtaW5tZW0tb3JkZXJpbmciLCB0aGlzKSk7CiAgICAgICAg\nICAgICAgICAgICAgY29tcHMuYWRkKGN1ckNvbXApOwogICAgICAgICAgICAg\nICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmIChjb21wcyA9PSBu\ndWxsKQogICAgICAgICAgICAgICAgY29tcCA9IG51bGw7CiAgICAgICAgICAg\nIGVsc2UKICAgICAgICAgICAgICAgIGNvbXAgPSBuZXcgQ29tcGFyYXRvckNo\nYWluKGNvbXBzKTsKICAgICAgICB9CgogICAgICAgIGlmIChjb21wID09IG51\nbGwpCiAgICAgICAgICAgIHJldHVybiB2YWw7CgogICAgICAgIC8vIHNvcnQK\nICAgICAgICBzd2l0Y2ggKGdldFR5cGVDb2RlKCkpIHsKICAgICAgICAgICAg\nY2FzZSBKYXZhVHlwZXMuQVJSQVk6CiAgICAgICAgICAgICAgICBMaXN0IGwg\nPSBKYXZhVHlwZXMudG9MaXN0KHZhbCwgX2VsZW0uZ2V0VHlwZSgpLCB0cnVl\nKTsKICAgICAgICAgICAgICAgIENvbGxlY3Rpb25zLnNvcnQobCwgY29tcCk7\nCiAgICAgICAgICAgICAgICByZXR1cm4gSmF2YVR5cGVzLnRvQXJyYXkobCwg\nX2VsZW0uZ2V0VHlwZSgpKTsKICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMu\nQ09MTEVDVElPTjoKICAgICAgICAgICAgICAgIGlmICh2YWwgaW5zdGFuY2Vv\nZiBMaXN0KQogICAgICAgICAgICAgICAgICAgIENvbGxlY3Rpb25zLnNvcnQo\nKExpc3QpIHZhbCwgY29tcCk7CiAgICAgICAgICAgICAgICByZXR1cm4gdmFs\nOwogICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgICAgdGhyb3cg\nbmV3IE1ldGFEYXRhRXhjZXB0aW9uKF9sb2MuZ2V0KCJjYW50LW9yZGVyIiwg\ndGhpcykpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIFdoZXRo\nZXIgdGhlIGZpZWxkIGlzIGV4dGVybmFsaXplZC4KICAgICAqLwogICAgcHVi\nbGljIGJvb2xlYW4gaXNFeHRlcm5hbGl6ZWQoKSB7CiAgICAgICAgcmV0dXJu\nIGdldEV4dGVybmFsaXplck1ldGhvZCgpICE9IG51bGwKICAgICAgICAgICAg\nfHwgZ2V0RXh0ZXJuYWxWYWx1ZU1hcCgpICE9IG51bGw7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBDb252ZXJ0IHRoZSBnaXZlbiBmaWVsZCB2YWx1ZSB0byBp\ndHMgZXh0ZXJuYWwgdmFsdWUgdGhyb3VnaCB0aGUKICAgICAqIHByb3ZpZGVk\nIGV4dGVybmFsaXplciwgb3IgcmV0dXJuIHRoZSB2YWx1ZSBhcy1pcyBpZiBu\nbyBleHRlcm5hbGl6ZXIuCiAgICAgKi8KICAgIHB1YmxpYyBPYmplY3QgZ2V0\nRXh0ZXJuYWxWYWx1ZShPYmplY3QgdmFsLCBTdG9yZUNvbnRleHQgY3R4KSB7\nCiAgICAgICAgTWFwIGV4dFZhbHVlcyA9IGdldEV4dGVybmFsVmFsdWVNYXAo\nKTsKICAgICAgICBpZiAoZXh0VmFsdWVzICE9IG51bGwpCiAgICAgICAgICAg\nIHJldHVybiBleHRWYWx1ZXMuZ2V0KHZhbCk7CgogICAgICAgIE1ldGhvZCBl\neHRlcm5hbGl6ZXIgPSBnZXRFeHRlcm5hbGl6ZXJNZXRob2QoKTsKICAgICAg\nICBpZiAoZXh0ZXJuYWxpemVyID09IG51bGwpCiAgICAgICAgICAgIHJldHVy\nbiB2YWw7CgogICAgICAgIC8vIHNwZWNpYWwgY2FzZSBmb3IgcXVlcmllczog\nYWxsb3cgdGhlIGdpdmVuIHZhbHVlIHRvIHBhc3MgdGhyb3VnaAogICAgICAg\nIC8vIGFzLWlzIGlmIGl0IGlzIGFscmVhZHkgaW4gZXh0ZXJuYWxpemVkIGZv\ncm0KICAgICAgICBpZiAodmFsICE9IG51bGwgJiYgZ2V0VHlwZSgpLmlzSW5z\ndGFuY2UodmFsKQogICAgICAgICAgICAmJiAoIWdldERlY2xhcmVkVHlwZSgp\nLmlzSW5zdGFuY2UodmFsKQogICAgICAgICAgICB8fCBnZXREZWNsYXJlZFR5\ncGUoKSA9PSBPYmplY3QuY2xhc3MpKQogICAgICAgICAgICByZXR1cm4gdmFs\nOwoKICAgICAgICB0cnkgewogICAgICAgICAgICAvLyBlaXRoZXIgaW52b2tl\nIHRoZSBzdGF0aWMgdG9FeHRlcm5hbCh2YWxbLCBjdHhdKSBtZXRob2QsIG9y\nIHRoZQogICAgICAgICAgICAvLyBub24tc3RhdGljIHZhbC50b0V4dGVybmFs\nKFtjdHhdKSBtZXRob2QKICAgICAgICAgICAgaWYgKE1vZGlmaWVyLmlzU3Rh\ndGljKGV4dGVybmFsaXplci5nZXRNb2RpZmllcnMoKSkpIHsKICAgICAgICAg\nICAgICAgIGlmIChleHRlcm5hbGl6ZXIuZ2V0UGFyYW1ldGVyVHlwZXMoKS5s\nZW5ndGggPT0gMSkKICAgICAgICAgICAgICAgICAgICByZXR1cm4gZXh0ZXJu\nYWxpemVyLmludm9rZShudWxsLCBuZXcgT2JqZWN0W117IHZhbCB9KTsKICAg\nICAgICAgICAgICAgIHJldHVybiBleHRlcm5hbGl6ZXIuaW52b2tlKG51bGws\nIG5ldyBPYmplY3RbXXsgdmFsLCBjdHggfSk7CiAgICAgICAgICAgIH0KICAg\nICAgICAgICAgaWYgKHZhbCA9PSBudWxsKQogICAgICAgICAgICAgICAgcmV0\ndXJuIG51bGw7CiAgICAgICAgICAgIGlmIChleHRlcm5hbGl6ZXIuZ2V0UGFy\nYW1ldGVyVHlwZXMoKS5sZW5ndGggPT0gMCkKICAgICAgICAgICAgICAgIHJl\ndHVybiBleHRlcm5hbGl6ZXIuaW52b2tlKHZhbCwgKE9iamVjdFtdKSBudWxs\nKTsKICAgICAgICAgICAgcmV0dXJuIGV4dGVybmFsaXplci5pbnZva2UodmFs\nLCBuZXcgT2JqZWN0W117IGN0eCB9KTsKICAgICAgICB9IGNhdGNoIChPcGVu\nSlBBRXhjZXB0aW9uIGtlKSB7CiAgICAgICAgICAgIHRocm93IGtlOwogICAg\nICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgIHRocm93\nIG5ldyBNZXRhRGF0YUV4Y2VwdGlvbihfbG9jLmdldCgiZXh0ZXJuYWxpemVy\nLWVyciIsIHRoaXMsCiAgICAgICAgICAgICAgICBFeGNlcHRpb25zLnRvU3Ry\naW5nKHZhbCksIGUudG9TdHJpbmcoKSkpLnNldENhdXNlKGUpOwogICAgICAg\nIH0KICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgcmVzdWx0IG9m\nIHBhc3NpbmcgdGhlIGdpdmVuIGV4dGVybmFsIHZhbHVlIHRocm91Z2ggdGhl\nCiAgICAgKiBmYWN0b3J5IHRvIGdldCB0aGUgZmllbGQgdmFsdWUuIElmIG5v\nIGZhY3RvcnkgaXMgcHJlc2VudCwKICAgICAqIHRoZSBnaXZlbiB2YWx1ZSBp\ncyByZXR1cm5lZCBhcy1pcy4KICAgICAqLwogICAgcHVibGljIE9iamVjdCBn\nZXRGaWVsZFZhbHVlKE9iamVjdCB2YWwsIFN0b3JlQ29udGV4dCBjdHgpIHsK\nICAgICAgICBNYXAgZmllbGRWYWx1ZXMgPSBnZXRGaWVsZFZhbHVlTWFwKCk7\nCiAgICAgICAgaWYgKGZpZWxkVmFsdWVzICE9IG51bGwpCiAgICAgICAgICAg\nIHJldHVybiBmaWVsZFZhbHVlcy5nZXQodmFsKTsKCiAgICAgICAgTWVtYmVy\nIGZhY3RvcnkgPSBnZXRGYWN0b3J5TWV0aG9kKCk7CiAgICAgICAgaWYgKGZh\nY3RvcnkgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIHZhbDsKCiAgICAg\nICAgdHJ5IHsKICAgICAgICAgICAgaWYgKHZhbCA9PSBudWxsICYmIGdldE51\nbGxWYWx1ZSgpID09IE5VTExfREVGQVVMVCkKICAgICAgICAgICAgICAgIHJl\ndHVybiBBY2Nlc3NDb250cm9sbGVyLmRvUHJpdmlsZWdlZCgKICAgICAgICAg\nICAgICAgICAgICBKMkRvUHJpdkhlbHBlci5uZXdJbnN0YW5jZUFjdGlvbihn\nZXREZWNsYXJlZFR5cGUoKSkpOyAKCiAgICAgICAgICAgIC8vIGludm9rZSBl\naXRoZXIgdGhlIGNvbnN0cnVjdG9yIGZvciB0aGUgZmllbGQgdHlwZSwKICAg\nICAgICAgICAgLy8gb3IgdGhlIHN0YXRpYyB0eXBlLnRvRmllbGQodmFsWywg\nY3R4XSkgbWV0aG9kCiAgICAgICAgICAgIGlmIChmYWN0b3J5IGluc3RhbmNl\nb2YgQ29uc3RydWN0b3IpIHsKICAgICAgICAgICAgICAgIGlmICh2YWwgPT0g\nbnVsbCkKICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAg\nICAgICAgICAgIHJldHVybiAoKENvbnN0cnVjdG9yKSBmYWN0b3J5KS5uZXdJ\nbnN0YW5jZQogICAgICAgICAgICAgICAgICAgIChuZXcgT2JqZWN0W117IHZh\nbCB9KTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgTWV0aG9kIG1ldGgg\nPSAoTWV0aG9kKSBmYWN0b3J5OwogICAgICAgICAgICBpZiAobWV0aC5nZXRQ\nYXJhbWV0ZXJUeXBlcygpLmxlbmd0aCA9PSAxKQogICAgICAgICAgICAgICAg\ncmV0dXJuIG1ldGguaW52b2tlKG51bGwsIG5ldyBPYmplY3RbXXsgdmFsIH0p\nOwogICAgICAgICAgICByZXR1cm4gbWV0aC5pbnZva2UobnVsbCwgbmV3IE9i\namVjdFtdeyB2YWwsIGN0eCB9KTsKICAgICAgICB9IGNhdGNoIChFeGNlcHRp\nb24gZSkgewogICAgICAgICAgICAvLyB1bndyYXAgY2F1c2UKICAgICAgICAg\nICAgaWYgKGUgaW5zdGFuY2VvZiBJbnZvY2F0aW9uVGFyZ2V0RXhjZXB0aW9u\nKSB7CiAgICAgICAgICAgICAgICBUaHJvd2FibGUgdCA9ICgoSW52b2NhdGlv\nblRhcmdldEV4Y2VwdGlvbikgZSkuCiAgICAgICAgICAgICAgICAgICAgZ2V0\nVGFyZ2V0RXhjZXB0aW9uKCk7CiAgICAgICAgICAgICAgICBpZiAodCBpbnN0\nYW5jZW9mIEVycm9yKQogICAgICAgICAgICAgICAgICAgIHRocm93IChFcnJv\ncikgdDsKICAgICAgICAgICAgICAgIGUgPSAoRXhjZXB0aW9uKSB0OwoKICAg\nICAgICAgICAgICAgIC8vIGFsbG93IG51bGwgdmFsdWVzIHRvIGNhdXNlIE5Q\nRXMgYW5kIGlsbGVnYWwgYXJnIGV4Y2VwdGlvbnMKICAgICAgICAgICAgICAg\nIC8vIHdpdGhvdXQgZXJyb3IKICAgICAgICAgICAgICAgIGlmICh2YWwgPT0g\nbnVsbCAmJiAoZSBpbnN0YW5jZW9mIE51bGxQb2ludGVyRXhjZXB0aW9uCiAg\nICAgICAgICAgICAgICAgICAgfHwgZSBpbnN0YW5jZW9mIElsbGVnYWxBcmd1\nbWVudEV4Y2VwdGlvbikpCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51\nbGw7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmIChlIGluc3RhbmNl\nb2YgT3BlbkpQQUV4Y2VwdGlvbikKICAgICAgICAgICAgICAgIHRocm93IChP\ncGVuSlBBRXhjZXB0aW9uKSBlOwogICAgICAgICAgICBpZiAoZSBpbnN0YW5j\nZW9mIFByaXZpbGVnZWRBY3Rpb25FeGNlcHRpb24pCiAgICAgICAgICAgICAg\nICBlID0gKChQcml2aWxlZ2VkQWN0aW9uRXhjZXB0aW9uKSBlKS5nZXRFeGNl\ncHRpb24oKTsKICAgICAgICAgICAgdGhyb3cgbmV3IE1ldGFEYXRhRXhjZXB0\naW9uKF9sb2MuZ2V0KCJmYWN0b3J5LWVyciIsIHRoaXMsCiAgICAgICAgICAg\nICAgICBFeGNlcHRpb25zLnRvU3RyaW5nKHZhbCksIGUudG9TdHJpbmcoKSkp\nLnNldENhdXNlKGUpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAq\nIFRoZSBuYW1lIG9mIHRoaXMgZmllbGQncyBleHRlcm5hbGl6ZXIsIG9yIG51\nbGwgaWYgbm9uZS4KICAgICAqLwogICAgcHVibGljIFN0cmluZyBnZXRFeHRl\ncm5hbGl6ZXIoKSB7CiAgICAgICAgcmV0dXJuIF9leHROYW1lOwogICAgfQoK\nICAgIC8qKgogICAgICogVGhlIG5hbWUgb2YgdGhpcyBmaWVsZCdzIGV4dGVy\nbmFsaXplciwgb3IgbnVsbCBpZiBub25lLgogICAgICovCiAgICBwdWJsaWMg\ndm9pZCBzZXRFeHRlcm5hbGl6ZXIoU3RyaW5nIGV4dGVybmFsaXplcikgewog\nICAgICAgIF9leHROYW1lID0gZXh0ZXJuYWxpemVyOwogICAgICAgIF9leHRN\nZXRob2QgPSBERUZBVUxUX01FVEhPRDsKICAgIH0KCiAgICAvKioKICAgICAq\nIFRoZSBuYW1lIG9mIHRoaXMgZmllbGQncyBmYWN0b3J5LCBvciBudWxsIGlm\nIG5vbmUuCiAgICAgKi8KICAgIHB1YmxpYyBTdHJpbmcgZ2V0RmFjdG9yeSgp\nIHsKICAgICAgICByZXR1cm4gX2ZhY3ROYW1lOwogICAgfQoKICAgIC8qKgog\nICAgICogVGhlIG5hbWUgb2YgdGhpcyBmaWVsZCdzIGZhY3RvcnksIG9yIG51\nbGwgaWYgbm9uZS4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0RmFjdG9y\neShTdHJpbmcgZmFjdG9yeSkgewogICAgICAgIF9mYWN0TmFtZSA9IGZhY3Rv\ncnk7CiAgICAgICAgX2ZhY3RNZXRob2QgPSBERUZBVUxUX01FVEhPRDsKICAg\nIH0KCiAgICAvKioKICAgICAqIFByb3BlcnRpZXMgc3RyaW5nIG1hcHBpbmcg\nZmllbGQgdmFsdWVzIHRvIGV4dGVybmFsIHZhbHVlcy4KICAgICAqLwogICAg\ncHVibGljIFN0cmluZyBnZXRFeHRlcm5hbFZhbHVlcygpIHsKICAgICAgICBy\nZXR1cm4gX2V4dFN0cmluZzsKICAgIH0KCiAgICAvKioKICAgICAqIFByb3Bl\ncnRpZXMgc3RyaW5nIG1hcHBpbmcgZmllbGQgdmFsdWVzIHRvIGV4dGVybmFs\nIHZhbHVlcy4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0RXh0ZXJuYWxW\nYWx1ZXMoU3RyaW5nIHZhbHVlcykgewogICAgICAgIF9leHRTdHJpbmcgPSB2\nYWx1ZXM7CiAgICAgICAgX2V4dFZhbHVlcyA9IG51bGw7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBSZXR1cm4gdGhlIG1hcHBpbmcgb2YgZmllbGQgdmFsdWVz\nIHRvIGV4dGVybmFsIHZhbHVlcy4KICAgICAqLwogICAgcHVibGljIE1hcCBn\nZXRFeHRlcm5hbFZhbHVlTWFwKCkgewogICAgICAgIHBhcnNlRXh0ZXJuYWxW\nYWx1ZXMoKTsKICAgICAgICByZXR1cm4gX2V4dFZhbHVlczsKICAgIH0KCiAg\nICAvKioKICAgICAqIFJldHVybiB0aGUgbWFwcGluZyBvZiBleHRlcm5hbCB2\nYWx1ZXMgdG8gZmllbGQgdmFsdWVzLgogICAgICovCiAgICBwdWJsaWMgTWFw\nIGdldEZpZWxkVmFsdWVNYXAoKSB7CiAgICAgICAgcGFyc2VFeHRlcm5hbFZh\nbHVlcygpOwogICAgICAgIHJldHVybiBfZmllbGRWYWx1ZXM7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBQYXJzZSBleHRlcm5hbCB2YWx1ZXMgaW50byBtYXBz\nLgogICAgICovCiAgICBwcml2YXRlIHZvaWQgcGFyc2VFeHRlcm5hbFZhbHVl\ncygpIHsKICAgICAgICBpZiAoX2V4dFZhbHVlcyAhPSBDb2xsZWN0aW9ucy5F\nTVBUWV9NQVAKICAgICAgICAgICAgJiYgX2ZpZWxkVmFsdWVzICE9IENvbGxl\nY3Rpb25zLkVNUFRZX01BUCkKICAgICAgICAgICAgcmV0dXJuOwoKICAgICAg\nICBpZiAoX2V4dFN0cmluZyA9PSBudWxsKSB7CiAgICAgICAgICAgIF9leHRW\nYWx1ZXMgPSBudWxsOwogICAgICAgICAgICBfZmllbGRWYWx1ZXMgPSBudWxs\nOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICAvLyBw\nYXJzZSBzdHJpbmcgaW50byBvcHRpb25zOyB0aGlzIHRha2VzIGNhcmUgb2Yg\ncHJvcGVyIHRyaW1taW5nIGV0YwogICAgICAgIE9wdGlvbnMgdmFsdWVzID0g\nQ29uZmlndXJhdGlvbnMucGFyc2VQcm9wZXJ0aWVzKF9leHRTdHJpbmcpOwog\nICAgICAgIGlmICh2YWx1ZXMuaXNFbXB0eSgpKQogICAgICAgICAgICB0aHJv\ndyBuZXcgTWV0YURhdGFFeGNlcHRpb24oX2xvYy5nZXQoIm5vLWV4dGVybmFs\nLXZhbHVlcyIsIHRoaXMsCiAgICAgICAgICAgICAgICBfZXh0U3RyaW5nKSk7\nCgogICAgICAgIE1hcCBleHRWYWx1ZXMgPSBuZXcgSGFzaE1hcCgoaW50KSAo\ndmFsdWVzLnNpemUoKSAqIDEuMzMgKyAxKSk7CiAgICAgICAgTWFwIGZpZWxk\nVmFsdWVzID0gbmV3IEhhc2hNYXAoKGludCkgKHZhbHVlcy5zaXplKCkgKiAx\nLjMzICsgMSkpOwogICAgICAgIE1hcC5FbnRyeSBlbnRyeTsKICAgICAgICBP\nYmplY3QgZXh0VmFsdWUsIGZpZWxkVmFsdWU7CiAgICAgICAgZm9yIChJdGVy\nYXRvciBpdHIgPSB2YWx1ZXMuZW50cnlTZXQoKS5pdGVyYXRvcigpOyBpdHIu\naGFzTmV4dCgpOykgewogICAgICAgICAgICBlbnRyeSA9IChNYXAuRW50cnkp\nIGl0ci5uZXh0KCk7CiAgICAgICAgICAgIGZpZWxkVmFsdWUgPSB0cmFuc2Zv\ncm0oKFN0cmluZykgZW50cnkuZ2V0S2V5KCksCiAgICAgICAgICAgICAgICBn\nZXREZWNsYXJlZFR5cGVDb2RlKCkpOwogICAgICAgICAgICBleHRWYWx1ZSA9\nIHRyYW5zZm9ybSgoU3RyaW5nKSBlbnRyeS5nZXRWYWx1ZSgpLCBnZXRUeXBl\nQ29kZSgpKTsKCiAgICAgICAgICAgIGV4dFZhbHVlcy5wdXQoZmllbGRWYWx1\nZSwgZXh0VmFsdWUpOwogICAgICAgICAgICBmaWVsZFZhbHVlcy5wdXQoZXh0\nVmFsdWUsIGZpZWxkVmFsdWUpOwogICAgICAgIH0KCiAgICAgICAgX2V4dFZh\nbHVlcyA9IGV4dFZhbHVlczsKICAgICAgICBfZmllbGRWYWx1ZXMgPSBmaWVs\nZFZhbHVlczsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgc3Ry\naW5nIHZhbHVlIGNvbnZlcnRlZCB0byB0aGUgZ2l2ZW4gdHlwZSBjb2RlLiBU\naGUgc3RyaW5nCiAgICAgKiBtdXN0IGJlIG5vbi1udWxsIGFuZCB0cmltbWVk\nLgogICAgICovCiAgICBwcml2YXRlIE9iamVjdCB0cmFuc2Zvcm0oU3RyaW5n\nIHZhbCwgaW50IHR5cGVDb2RlKSB7CiAgICAgICAgaWYgKCJudWxsIi5lcXVh\nbHModmFsKSkKICAgICAgICAgICAgcmV0dXJuIG51bGw7CgogICAgICAgIHN3\naXRjaCAodHlwZUNvZGUpIHsKICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMu\nQk9PTEVBTjoKICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuQk9PTEVBTl9P\nQko6CiAgICAgICAgICAgICAgICByZXR1cm4gQm9vbGVhbi52YWx1ZU9mKHZh\nbCk7CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLkJZVEU6CiAgICAgICAg\nICAgIGNhc2UgSmF2YVR5cGVzLkJZVEVfT0JKOgogICAgICAgICAgICAgICAg\ncmV0dXJuIEJ5dGUudmFsdWVPZih2YWwpOwogICAgICAgICAgICBjYXNlIEph\ndmFUeXBlcy5JTlQ6CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLklOVF9P\nQko6CiAgICAgICAgICAgICAgICByZXR1cm4gSW50ZWdlci52YWx1ZU9mKHZh\nbCk7CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLkxPTkc6CiAgICAgICAg\nICAgIGNhc2UgSmF2YVR5cGVzLkxPTkdfT0JKOgogICAgICAgICAgICAgICAg\ncmV0dXJuIExvbmcudmFsdWVPZih2YWwpOwogICAgICAgICAgICBjYXNlIEph\ndmFUeXBlcy5TSE9SVDoKICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuU0hP\nUlRfT0JKOgogICAgICAgICAgICAgICAgcmV0dXJuIFNob3J0LnZhbHVlT2Yo\ndmFsKTsKICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuRE9VQkxFOgogICAg\nICAgICAgICBjYXNlIEphdmFUeXBlcy5ET1VCTEVfT0JKOgogICAgICAgICAg\nICAgICAgcmV0dXJuIERvdWJsZS52YWx1ZU9mKHZhbCk7CiAgICAgICAgICAg\nIGNhc2UgSmF2YVR5cGVzLkZMT0FUOgogICAgICAgICAgICBjYXNlIEphdmFU\neXBlcy5GTE9BVF9PQko6CiAgICAgICAgICAgICAgICByZXR1cm4gRmxvYXQu\ndmFsdWVPZih2YWwpOwogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5DSEFS\nOgogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5DSEFSX09CSjoKICAgICAg\nICAgICAgICAgIHJldHVybiBuZXcgQ2hhcmFjdGVyKHZhbC5jaGFyQXQoMCkp\nOwogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5TVFJJTkc6CiAgICAgICAg\nICAgICAgICByZXR1cm4gdmFsOwogICAgICAgIH0KICAgICAgICB0aHJvdyBu\nZXcgTWV0YURhdGFFeGNlcHRpb24oX2xvYy5nZXQoImJhZC1leHRlcm5hbC10\neXBlIiwgdGhpcykpOwogICAgfQoKICAgIC8qKgogICAgICogVGhlIGV4dGVy\nbmFsaXplciBtZXRob2QuCiAgICAgKi8KICAgIHB1YmxpYyBNZXRob2QgZ2V0\nRXh0ZXJuYWxpemVyTWV0aG9kKCkgewogICAgICAgIGlmIChfbWFuYWdlICE9\nIE1BTkFHRV9QRVJTSVNURU5UKQogICAgICAgICAgICByZXR1cm4gbnVsbDsK\nICAgICAgICBpZiAoX2V4dE1ldGhvZCA9PSBERUZBVUxUX01FVEhPRCkgewog\nICAgICAgICAgICBpZiAoX2V4dE5hbWUgIT0gbnVsbCkgewogICAgICAgICAg\nICAgICAgX2V4dE1ldGhvZCA9IGZpbmRNZXRob2QoX2V4dE5hbWUpOwogICAg\nICAgICAgICAgICAgaWYgKF9leHRNZXRob2QgPT0gbnVsbCkKICAgICAgICAg\nICAgICAgICAgICB0aHJvdyBuZXcgTWV0YURhdGFFeGNlcHRpb24oX2xvYy5n\nZXQoImJhZC1leHRlcm5hbGl6ZXIiLAogICAgICAgICAgICAgICAgICAgICAg\nICB0aGlzLCBfZXh0TmFtZSkpOwogICAgICAgICAgICB9IGVsc2UKICAgICAg\nICAgICAgICAgIF9leHRNZXRob2QgPSBudWxsOwogICAgICAgIH0KICAgICAg\nICByZXR1cm4gX2V4dE1ldGhvZDsKICAgIH0KCiAgICAvKioKICAgICAqIFRo\nZSBmYWN0b3J5IG1ldGhvZCBvciBjb25zdHJ1Y3Rvci4KICAgICAqLwogICAg\ncHVibGljIE1lbWJlciBnZXRGYWN0b3J5TWV0aG9kKCkgewogICAgICAgIGlm\nIChfbWFuYWdlICE9IE1BTkFHRV9QRVJTSVNURU5UKQogICAgICAgICAgICBy\nZXR1cm4gbnVsbDsKICAgICAgICBpZiAoX2ZhY3RNZXRob2QgPT0gREVGQVVM\nVF9NRVRIT0QpIHsKICAgICAgICAgICAgaWYgKGdldEV4dGVybmFsaXplck1l\ndGhvZCgpID09IG51bGwpCiAgICAgICAgICAgICAgICBfZmFjdE1ldGhvZCA9\nIG51bGw7CiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgdHJ5\nIHsKICAgICAgICAgICAgICAgICAgICBpZiAoX2ZhY3ROYW1lID09IG51bGwp\nCiAgICAgICAgICAgICAgICAgICAgICAgIF9mYWN0TWV0aG9kID0gZ2V0RGVj\nbGFyZWRUeXBlKCkuZ2V0Q29uc3RydWN0b3IKICAgICAgICAgICAgICAgICAg\nICAgICAgICAgIChuZXcgQ2xhc3NbXXsgZ2V0VHlwZSgpIH0pOwogICAgICAg\nICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICAgICAgX2Zh\nY3RNZXRob2QgPSBmaW5kTWV0aG9kKF9mYWN0TmFtZSk7CiAgICAgICAgICAg\nICAgICB9IGNhdGNoIChPcGVuSlBBRXhjZXB0aW9uIGtlKSB7CiAgICAgICAg\nICAgICAgICAgICAgdGhyb3cga2U7CiAgICAgICAgICAgICAgICB9IGNhdGNo\nIChFeGNlcHRpb24gZSkgewogICAgICAgICAgICAgICAgfQoKICAgICAgICAg\nICAgICAgIGlmICghKF9mYWN0TWV0aG9kIGluc3RhbmNlb2YgQ29uc3RydWN0\nb3IpCiAgICAgICAgICAgICAgICAgICAgJiYgIShfZmFjdE1ldGhvZCBpbnN0\nYW5jZW9mIE1ldGhvZCkpCiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3\nIE1ldGFEYXRhRXhjZXB0aW9uKF9sb2MuZ2V0KCJiYWQtZmFjdG9yeSIsIHRo\naXMpKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4g\nX2ZhY3RNZXRob2Q7CiAgICB9CgogICAgLyoqCiAgICAgKiBGaW5kIHRoZSBt\nZXRob2QgZm9yIHRoZSBzcGVjaWZpZWQgbmFtZS4gUG9zc2libGUgZm9ybXMg\nYXJlOgogICAgICogPHVsPgogICAgICogPGxpPnRvRXh0ZXJuYWxTdHJpbmc8\nL2xpPgogICAgICogPGxpPk15RmFjdG9yeUNsYXNzLnRvRXh0ZXJuYWxTdHJp\nbmc8L2xpPgogICAgICogPGxpPmNvbS5jb21wYW55Lk15RmFjdG9yeUNsYXNz\nLnRvRXh0ZXJuYWxTdHJpbmc8L2xpPgogICAgICogPC91bD4KICAgICAqCiAg\nICAgKiBAcGFyYW0gbWV0aG9kIHRoZSBuYW1lIG9mIHRoZSBtZXRob2QgdG8g\nbG9jYXRlCiAgICAgKiBAcmV0dXJuIHRoZSBtZXRob2QgZm9yIGludm9jYXRp\nb24KICAgICAqLwogICAgcHJpdmF0ZSBNZXRob2QgZmluZE1ldGhvZChTdHJp\nbmcgbWV0aG9kKSB7CiAgICAgICAgaWYgKFN0cmluZ1V0aWxzLmlzRW1wdHko\nbWV0aG9kKSkKICAgICAgICAgICAgcmV0dXJuIG51bGw7CgogICAgICAgIC8v\nIGdldCBjbGFzcyBuYW1lIGFuZCBnZXQgcGFja2FnZSBuYW1lIGRpdmlkZSBv\nbiB0aGUgbGFzdCAnLicsIHNvIHRoZQogICAgICAgIC8vIG5hbWVzIGRvbid0\nIGFwcGx5IGluIHRoaXMgY2FzZSwgYnV0IHRoZSBtZXRob2RzIGRvIHdoYXQg\nd2Ugd2FudAogICAgICAgIFN0cmluZyBtZXRob2ROYW1lID0gU3RyaW5ncy5n\nZXRDbGFzc05hbWUobWV0aG9kKTsKICAgICAgICBTdHJpbmcgY2xzTmFtZSA9\nIFN0cmluZ3MuZ2V0UGFja2FnZU5hbWUobWV0aG9kKTsKCiAgICAgICAgQ2xh\nc3MgY2xzID0gbnVsbDsKICAgICAgICBDbGFzcyBvd25lciA9IF9vd25lci5n\nZXREZXNjcmliZWRUeXBlKCk7CgogICAgICAgIGlmIChjbHNOYW1lLmxlbmd0\naCgpID09IDApCiAgICAgICAgICAgIGNscyA9IGdldERlY2xhcmVkVHlwZSgp\nOwogICAgICAgIGVsc2UgaWYgKGNsc05hbWUuZXF1YWxzKG93bmVyLmdldE5h\nbWUoKSkKICAgICAgICAgICAgfHwgY2xzTmFtZS5lcXVhbHMoU3RyaW5ncy5n\nZXRDbGFzc05hbWUob3duZXIpKSkKICAgICAgICAgICAgY2xzID0gb3duZXI7\nCiAgICAgICAgZWxzZQogICAgICAgICAgICBjbHMgPSBKYXZhVHlwZXMuY2xh\nc3NGb3JOYW1lKGNsc05hbWUsIHRoaXMpOwoKICAgICAgICAvLyBmaW5kIHRo\nZSBuYW1lZCBtZXRob2QKICAgICAgICBNZXRob2RbXSBtZXRob2RzID0gY2xz\nLmdldE1ldGhvZHMoKTsKICAgICAgICBDbGFzc1tdIHBhcmFtczsKICAgICAg\nICBmb3IgKGludCBpID0gMDsgaSA8IG1ldGhvZHMubGVuZ3RoOyBpKyspIHsK\nICAgICAgICAgICAgaWYgKG1ldGhvZHNbaV0uZ2V0TmFtZSgpLmVxdWFscyht\nZXRob2ROYW1lKSkgewogICAgICAgICAgICAgICAgcGFyYW1zID0gbWV0aG9k\nc1tpXS5nZXRQYXJhbWV0ZXJUeXBlcygpOwoKICAgICAgICAgICAgICAgIC8v\nIHN0YXRpYyBmYWN0b3J5IG1ldGhvZHMgcmVxdWlyZSBvbmUgYXJndW1lbnQg\nb3Igb25lIGFyZ3VtZW50CiAgICAgICAgICAgICAgICAvLyBwbHVzIGEgY3R4\nOyBub24tc3RhdGljIG1ldGhvZHMgcmVxdWlyZSB6ZXJvIGFyZ3VtZW50cyBv\ncgogICAgICAgICAgICAgICAgLy8ganVzdCBhIGN0eAogICAgICAgICAgICAg\nICAgaWYgKE1vZGlmaWVyLmlzU3RhdGljKG1ldGhvZHNbaV0uZ2V0TW9kaWZp\nZXJzKCkpCiAgICAgICAgICAgICAgICAgICAgJiYgKHBhcmFtcy5sZW5ndGgg\nPT0gMSB8fCAocGFyYW1zLmxlbmd0aCA9PSAyCiAgICAgICAgICAgICAgICAg\nICAgJiYgaXNTdG9yZUNvbnRleHRQYXJhbWV0ZXIocGFyYW1zWzFdKSkpKQog\nICAgICAgICAgICAgICAgICAgIHJldHVybiBtZXRob2RzW2ldOwogICAgICAg\nICAgICAgICAgaWYgKCFNb2RpZmllci5pc1N0YXRpYyhtZXRob2RzW2ldLmdl\ndE1vZGlmaWVycygpKQogICAgICAgICAgICAgICAgICAgICYmIChwYXJhbXMu\nbGVuZ3RoID09IDAgfHwgKHBhcmFtcy5sZW5ndGggPT0gMQogICAgICAgICAg\nICAgICAgICAgICYmIGlzU3RvcmVDb250ZXh0UGFyYW1ldGVyKHBhcmFtc1sw\nXSkpKSkKICAgICAgICAgICAgICAgICAgICByZXR1cm4gbWV0aG9kc1tpXTsK\nICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIG51bGw7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gdHJ1ZSBpZiB0aGUgZ2l2\nZW4gdHlwZSBpcyBhIHN0b3JlIGNvbnRleHQgdHlwZTsgd2UgY2FuJ3QKICAg\nICAqIHVzZSB0aGUgc3RhbmRhcmQgPGNvZGU+aXNBc3NpZ25hYmxlRnJvbTwv\nY29kZT4gYmVjYXVzZSBvZiBjbGFzc2xvYWRlcgogICAgICogb2RkbmVzcy4K\nICAgICAqLwogICAgcHJpdmF0ZSBzdGF0aWMgYm9vbGVhbiBpc1N0b3JlQ29u\ndGV4dFBhcmFtZXRlcihDbGFzcyB0eXBlKSB7CiAgICAgICAgcmV0dXJuIFN0\nb3JlQ29udGV4dC5jbGFzcy5nZXROYW1lKCkuZXF1YWxzKHR5cGUuZ2V0TmFt\nZSgpKTsKICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBlcXVhbHMoT2JqZWN0\nIG90aGVyKSB7CiAgICAgICAgaWYgKG90aGVyID09IHRoaXMpCiAgICAgICAg\nICAgIHJldHVybiB0cnVlOwogICAgICAgIGlmICghKG90aGVyIGluc3RhbmNl\nb2YgRmllbGRNZXRhRGF0YSkpCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsK\nICAgICAgICByZXR1cm4gZ2V0RnVsbE5hbWUodHJ1ZSkuZXF1YWxzKCgoRmll\nbGRNZXRhRGF0YSkgb3RoZXIpLgogICAgICAgICAgICBnZXRGdWxsTmFtZSh0\ncnVlKSk7CiAgICB9CgogICAgcHVibGljIGludCBoYXNoQ29kZSgpIHsKICAg\nICAgICByZXR1cm4gZ2V0RnVsbE5hbWUodHJ1ZSkuaGFzaENvZGUoKTsKICAg\nIH0KCiAgICBwdWJsaWMgaW50IGNvbXBhcmVUbyhPYmplY3Qgb3RoZXIpIHsK\nICAgICAgICBpZiAob3RoZXIgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJu\nIDE7CiAgICAgICAgcmV0dXJuIGdldEZ1bGxOYW1lKHRydWUpLmNvbXBhcmVU\nbygoKEZpZWxkTWV0YURhdGEpIG90aGVyKS4KICAgICAgICAgICAgZ2V0RnVs\nbE5hbWUodHJ1ZSkpOwogICAgfQoKICAgIHB1YmxpYyBTdHJpbmcgdG9TdHJp\nbmcoKSB7CiAgICAgICAgcmV0dXJuIGdldEZ1bGxOYW1lKHRydWUpOwogICAg\nfQoKICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwogICAgLy8gUmVzb2x2\nZSBhbmQgdmFsaWRhdGUKICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwoK\nICAgIC8qKgogICAgICogUmVzb2x2ZSBtb2RlIGZvciB0aGlzIGZpZWxkLgog\nICAgICovCiAgICBwdWJsaWMgaW50IGdldFJlc29sdmUoKSB7CiAgICAgICAg\ncmV0dXJuIF9yZXNNb2RlOwogICAgfQoKICAgIC8qKgogICAgICogUmVzb2x2\nZSBtb2RlIGZvciB0aGlzIGZpZWxkLgogICAgICovCiAgICBwdWJsaWMgdm9p\nZCBzZXRSZXNvbHZlKGludCBtb2RlKSB7CiAgICAgICAgX3Jlc01vZGUgPSBt\nb2RlOwogICAgfQoKICAgIC8qKgogICAgICogUmVzb2x2ZSBtb2RlIGZvciB0\naGlzIGZpZWxkLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRSZXNvbHZl\nKGludCBtb2RlLCBib29sZWFuIG9uKSB7CiAgICAgICAgaWYgKG1vZGUgPT0g\nTU9ERV9OT05FKQogICAgICAgICAgICBfcmVzTW9kZSA9IG1vZGU7CiAgICAg\nICAgZWxzZSBpZiAob24pCiAgICAgICAgICAgIF9yZXNNb2RlIHw9IG1vZGU7\nCiAgICAgICAgZWxzZQogICAgICAgICAgICBfcmVzTW9kZSAmPSB+bW9kZTsK\nICAgIH0KCiAgICAvKioKICAgICAqIFJlc29sdmUgYW5kIHZhbGlkYXRlIG1l\ndGFkYXRhLiBSZXR1cm4gdHJ1ZSBpZiBhbHJlYWR5IHJlc29sdmVkLgogICAg\nICovCiAgICBwdWJsaWMgYm9vbGVhbiByZXNvbHZlKGludCBtb2RlKSB7CiAg\nICAgICAgaWYgKChfcmVzTW9kZSAmIG1vZGUpID09IG1vZGUpCiAgICAgICAg\nICAgIHJldHVybiB0cnVlOwogICAgICAgIGludCBjdXIgPSBfcmVzTW9kZTsK\nICAgICAgICBfcmVzTW9kZSB8PSBtb2RlOwoKICAgICAgICBMb2cgbG9nID0g\nZ2V0UmVwb3NpdG9yeSgpLmdldExvZygpOwogICAgICAgIGlmIChsb2cuaXNU\ncmFjZUVuYWJsZWQoKSkKICAgICAgICAgICAgbG9nLnRyYWNlKF9sb2MuZ2V0\nKCJyZXNvbHZlLWZpZWxkIiwgX293bmVyICsgIkAiCiAgICAgICAgICAgICAg\nICArIFN5c3RlbS5pZGVudGl0eUhhc2hDb2RlKF9vd25lcikgKyAiLiIgKyBf\nbmFtZSkpOwoKICAgICAgICAvLyB3ZSBvbmx5IHBlcmZvcm0gYWN0aW9ucyBm\nb3IgbWV0YWRhdGEgbW9kZQogICAgICAgIGlmICgobW9kZSAmIE1PREVfTUVU\nQSkgPT0gMCB8fCAoY3VyICYgTU9ERV9NRVRBKSAhPSAwKQogICAgICAgICAg\nICByZXR1cm4gZmFsc2U7CgogICAgICAgIE1ldGhvZCBleHRlcm5hbGl6ZXIg\nPSBnZXRFeHRlcm5hbGl6ZXJNZXRob2QoKTsKICAgICAgICBpZiAoZXh0ZXJu\nYWxpemVyICE9IG51bGwpCiAgICAgICAgICAgIHNldFR5cGUoZXh0ZXJuYWxp\nemVyLmdldFJldHVyblR5cGUoKSk7CgogICAgICAgIC8vIG9ubHkgcGFzcyBv\nbiBtZXRhZGF0YSByZXNvbHZlIG1vZGUgc28gdGhhdCBtZXRhZGF0YSBpcyBh\nbHdheXMKICAgICAgICAvLyByZXNvbHZlZCBiZWZvcmUgYW55IG90aGVyIHJl\nc29sdmUgbW9kZXMgb3VyIHN1YmNsYXNzZXMgcGFzcyBhbG9uZwogICAgICAg\nIF92YWwucmVzb2x2ZShNT0RFX01FVEEpOwogICAgICAgIF9rZXkucmVzb2x2\nZShNT0RFX01FVEEpOwogICAgICAgIF9lbGVtLnJlc29sdmUoTU9ERV9NRVRB\nKTsKCiAgICAgICAgTWV0YURhdGFSZXBvc2l0b3J5IHJlcG9zID0gZ2V0UmVw\nb3NpdG9yeSgpOwogICAgICAgIGludCB2YWxpZGF0ZSA9IHJlcG9zLmdldFZh\nbGlkYXRlKCk7CiAgICAgICAgaWYgKCh2YWxpZGF0ZSAmIE1ldGFEYXRhUmVw\nb3NpdG9yeS5WQUxJREFURV9NRVRBKSAhPSAwCiAgICAgICAgICAgICYmICgh\nSW1wbEhlbHBlci5pc01hbmFnZWRUeXBlKHJlcG9zLmdldENvbmZpZ3VyYXRp\nb24oKSwKICAgICAgICAgICAgICAgIF9vd25lci5nZXREZXNjcmliZWRUeXBl\nKCkpCiAgICAgICAgICAgIHx8ICh2YWxpZGF0ZSAmIE1ldGFEYXRhUmVwb3Np\ndG9yeS5WQUxJREFURV9VTkVOSEFOQ0VEKSA9PSAwKSkgewogICAgICAgICAg\nICB2YWxpZGF0ZUxSUygpOwogICAgICAgICAgICBpZiAoKHZhbGlkYXRlICYg\ncmVwb3MuVkFMSURBVEVfUlVOVElNRSkgPT0gMCkKICAgICAgICAgICAgICAg\nIHZhbGlkYXRlU3VwcG9ydGVkVHlwZSgpOwogICAgICAgICAgICB2YWxpZGF0\nZVZhbHVlKCk7CiAgICAgICAgICAgIHZhbGlkYXRlRXh0ZW5zaW9uS2V5cygp\nOwogICAgICAgIH0KICAgICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBWYWxpZGF0ZSB0aGF0IHRoaXMgZmllbGQgY2FuIGJlIHVz\nZWQgZm9yIExSUy4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIHZhbGlkYXRl\nTFJTKCkgewogICAgICAgIGlmICghaXNMUlMoKSkKICAgICAgICAgICAgcmV0\ndXJuOwoKICAgICAgICAvLyBjYW4ndCB1c2UgbHJzIGZvciBhcnJheXMKICAg\nICAgICBpZiAoZ2V0VHlwZUNvZGUoKSA9PSBKYXZhVHlwZXMuQVJSQVkpCiAg\nICAgICAgICAgIHRocm93IG5ldyBNZXRhRGF0YUV4Y2VwdGlvbihfbG9jLmdl\ndCgiYmFkLWxycy1hcnJheSIsIHRoaXMpKTsKCiAgICAgICAgLy8gY2FuJ3Qg\ndXNlIGxycyBmb3IgZXh0cmFuYWxpemVkIHZhbHMKICAgICAgICBpZiAoZ2V0\nRXh0ZXJuYWxpemVyTWV0aG9kKCkgIT0gbnVsbCkKICAgICAgICAgICAgdGhy\nb3cgbmV3IE1ldGFEYXRhRXhjZXB0aW9uKF9sb2MuZ2V0KCJiYWQtbHJzLWV4\ndGVybiIsIHRoaXMpKTsKCiAgICAgICAgLy8gY2FuJ3QgdXNlIGxycyBmb3Ig\nY29uY3JldGUgdHlwZXMKICAgICAgICBpZiAoZ2V0VHlwZSgpICE9IENvbGxl\nY3Rpb24uY2xhc3MgJiYgZ2V0VHlwZSgpICE9IE1hcC5jbGFzcwogICAgICAg\nICAgICAmJiBnZXRUeXBlKCkgIT0gU2V0LmNsYXNzKQogICAgICAgICAgICB0\naHJvdyBuZXcgTWV0YURhdGFFeGNlcHRpb24oX2xvYy5nZXQoImJhZC1scnMt\nY29uY3JldGUiLCB0aGlzKSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBWYWxp\nZGF0ZSB0aGF0IHRoaXMgZmllbGQgaXMgc3VwcG9ydGVkIGJ5IHRoZSBydW50\naW1lLgogICAgICovCiAgICBwcml2YXRlIHZvaWQgdmFsaWRhdGVTdXBwb3J0\nZWRUeXBlKCkgewogICAgICAgIC8vIGxvZyB3YXJuaW5ncyBhYm91dCB0aGlu\nZ3Mgd2UgZG9uJ3QgaGFuZGxlCiAgICAgICAgT3BlbkpQQUNvbmZpZ3VyYXRp\nb24gY29uZiA9IGdldFJlcG9zaXRvcnkoKS5nZXRDb25maWd1cmF0aW9uKCk7\nCiAgICAgICAgQ29sbGVjdGlvbiBvcHRzID0gY29uZi5zdXBwb3J0ZWRPcHRp\nb25zKCk7CiAgICAgICAgTG9nIGxvZyA9IGNvbmYuZ2V0TG9nKGNvbmYuTE9H\nX01FVEFEQVRBKTsKICAgICAgICBzd2l0Y2ggKGdldFR5cGVDb2RlKCkpIHsK\nICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuUEM6CiAgICAgICAgICAgICAg\nICBpZiAoaXNFbWJlZGRlZCgpICYmCiAgICAgICAgICAgICAgICAgICAgIW9w\ndHMuY29udGFpbnMoY29uZi5PUFRJT05fRU1CRURERURfUkVMQVRJT04pKSB7\nCiAgICAgICAgICAgICAgICAgICAgc2V0RW1iZWRkZWQoZmFsc2UpOwogICAg\nICAgICAgICAgICAgICAgIGlmIChsb2cuaXNXYXJuRW5hYmxlZCgpKQogICAg\nICAgICAgICAgICAgICAgICAgICBsb2cud2FybihfbG9jLmdldCgiY2FudC1l\nbWJlZCIsIHRoaXMpKTsKICAgICAgICAgICAgICAgIH0gZWxzZQogICAgICAg\nICAgICAgICAgaWYgKGlzRW1iZWRkZWQoKSAmJiBnZXREZWNsYXJlZFR5cGVD\nb2RlKCkgIT0gSmF2YVR5cGVzLlBDKSB7CiAgICAgICAgICAgICAgICAgICAg\nc2V0RW1iZWRkZWQoZmFsc2UpOwogICAgICAgICAgICAgICAgICAgIGlmIChs\nb2cuaXNXYXJuRW5hYmxlZCgpKQogICAgICAgICAgICAgICAgICAgICAgICBs\nb2cud2FybihfbG9jLmdldCgiY2FudC1lbWJlZC1leHRlcm4iLCB0aGlzKSk7\nCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBicmVhazsKICAg\nICAgICAgICAgY2FzZSBKYXZhVHlwZXMuQ09MTEVDVElPTjoKICAgICAgICAg\nICAgICAgIGlmICghb3B0cy5jb250YWlucyhjb25mLk9QVElPTl9UWVBFX0NP\nTExFQ1RJT04pKQogICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBVbnN1\ncHBvcnRlZEV4Y2VwdGlvbigKICAgICAgICAgICAgICAgICAgICAgICAgX2xv\nYy5nZXQoInR5cGUtbm90LXN1cHBvcnRlZCIsCiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAiQ29sbGVjdGlvbiIsIHRoaXMpKTsKICAgICAgICAgICAg\nICAgIGlmIChfZWxlbS5pc0VtYmVkZGVkUEMoKQogICAgICAgICAgICAgICAg\nICAgICYmICFvcHRzLmNvbnRhaW5zKGNvbmYuT1BUSU9OX0VNQkVEREVEX0NP\nTExFQ1RJT05fUkVMQVRJT04pKQogICAgICAgICAgICAgICAgewogICAgICAg\nICAgICAgICAgICAgIF9lbGVtLnNldEVtYmVkZGVkKGZhbHNlKTsKICAgICAg\nICAgICAgICAgICAgICBpZiAobG9nLmlzV2FybkVuYWJsZWQoKSkKICAgICAg\nICAgICAgICAgICAgICAgICAgbG9nLndhcm4oX2xvYy5nZXQoImNhbnQtZW1i\nZWQtZWxlbWVudCIsIHRoaXMpKTsKICAgICAgICAgICAgICAgIH0KICAgICAg\nICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5B\nUlJBWToKICAgICAgICAgICAgICAgIGlmICghb3B0cy5jb250YWlucyhjb25m\nLk9QVElPTl9UWVBFX0FSUkFZKSkKICAgICAgICAgICAgICAgICAgICB0aHJv\ndyBuZXcgVW5zdXBwb3J0ZWRFeGNlcHRpb24oCiAgICAgICAgICAgICAgICAg\nICAgICAgIF9sb2MuZ2V0KCJ0eXBlLW5vdC1zdXBwb3J0ZWQiLAogICAgICAg\nICAgICAgICAgICAgICAgICAgICAgIkFycmF5IiwgdGhpcykpOwogICAgICAg\nICAgICAgICAgaWYgKF9lbGVtLmlzRW1iZWRkZWRQQygpCiAgICAgICAgICAg\nICAgICAgICAgJiYgIW9wdHMuY29udGFpbnMoY29uZi5PUFRJT05fRU1CRURE\nRURfQ09MTEVDVElPTl9SRUxBVElPTikpCiAgICAgICAgICAgICAgICB7CiAg\nICAgICAgICAgICAgICAgICAgX2VsZW0uc2V0RW1iZWRkZWQoZmFsc2UpOwog\nICAgICAgICAgICAgICAgICAgIGlmIChsb2cuaXNXYXJuRW5hYmxlZCgpKQog\nICAgICAgICAgICAgICAgICAgICAgICBsb2cud2FybihfbG9jLmdldCgiY2Fu\ndC1lbWJlZC1lbGVtZW50IiwgdGhpcykpOwogICAgICAgICAgICAgICAgfQog\nICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgSmF2YVR5\ncGVzLk1BUDoKICAgICAgICAgICAgICAgIGlmICghb3B0cy5jb250YWlucyhj\nb25mLk9QVElPTl9UWVBFX01BUCkpCiAgICAgICAgICAgICAgICAgICAgdGhy\nb3cgbmV3IFVuc3VwcG9ydGVkRXhjZXB0aW9uKAogICAgICAgICAgICAgICAg\nICAgICAgICBfbG9jLmdldCgidHlwZS1ub3Qtc3VwcG9ydGVkIiwKICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICJNYXAiLCB0aGlzKSk7CiAgICAgICAg\nICAgICAgICBpZiAoX2VsZW0uaXNFbWJlZGRlZFBDKCkKICAgICAgICAgICAg\nICAgICAgICAmJiAhb3B0cy5jb250YWlucyhjb25mLk9QVElPTl9FTUJFRERF\nRF9NQVBfUkVMQVRJT04pKSB7CiAgICAgICAgICAgICAgICAgICAgX2VsZW0u\nc2V0RW1iZWRkZWQoZmFsc2UpOwogICAgICAgICAgICAgICAgICAgIGlmIChs\nb2cuaXNXYXJuRW5hYmxlZCgpKQogICAgICAgICAgICAgICAgICAgICAgICBs\nb2cud2FybihfbG9jLmdldCgiY2FudC1lbWJlZC1lbGVtZW50IiwgdGhpcykp\nOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKF9rZXku\naXNFbWJlZGRlZFBDKCkKICAgICAgICAgICAgICAgICAgICAmJiAhb3B0cy5j\nb250YWlucyhjb25mLk9QVElPTl9FTUJFRERFRF9NQVBfUkVMQVRJT04pKSB7\nCiAgICAgICAgICAgICAgICAgICAgX2tleS5zZXRFbWJlZGRlZChmYWxzZSk7\nCiAgICAgICAgICAgICAgICAgICAgaWYgKGxvZy5pc1dhcm5FbmFibGVkKCkp\nCiAgICAgICAgICAgICAgICAgICAgICAgIGxvZy53YXJuKF9sb2MuZ2V0KCJj\nYW50LWVtYmVkLWtleSIsIHRoaXMpKTsKICAgICAgICAgICAgICAgIH0KICAg\nICAgICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgIH0KCiAgICAvKioK\nICAgICAqIFZhbGlkYXRlIG91ciB2YWx1ZSBzdHJhdGVneS4KICAgICAqLwog\nICAgcHJpdmF0ZSB2b2lkIHZhbGlkYXRlVmFsdWUoKSB7CiAgICAgICAgaWYg\nKGdldEV4dGVybmFsaXplck1ldGhvZCgpICE9IG51bGwgJiYgZ2V0RXh0ZXJu\nYWxWYWx1ZU1hcCgpICE9IG51bGwpCiAgICAgICAgICAgIHRocm93IG5ldyBN\nZXRhRGF0YUV4Y2VwdGlvbihfbG9jLmdldCgiZXh0ZXJuLWV4dGVybnZhbHVl\ncyIsIHRoaXMpKTsKICAgICAgICBpZiAoZ2V0VmFsdWVTdHJhdGVneSgpID09\nIFZhbHVlU3RyYXRlZ2llcy5TRVFVRU5DRQogICAgICAgICAgICAmJiBnZXRW\nYWx1ZVNlcXVlbmNlTmFtZSgpID09IG51bGwpCiAgICAgICAgICAgIHRocm93\nIG5ldyBNZXRhRGF0YUV4Y2VwdGlvbihfbG9jLmdldCgibm8tc2VxLW5hbWUi\nLCB0aGlzKSk7CiAgICAgICAgVmFsdWVTdHJhdGVnaWVzLmFzc2VydFN1cHBv\ncnRlZChnZXRWYWx1ZVN0cmF0ZWd5KCksIHRoaXMsCiAgICAgICAgICAgICJ2\nYWx1ZSBzdHJhdGVneSIpOwogICAgfQoKICAgIC8qKgogICAgICogQ29weSBz\ndGF0ZSBmcm9tIHRoZSBnaXZlbiBmaWVsZCB0byB0aGlzIG9uZS4gRG8gbm90\nIGNvcHkgbWFwcGluZwogICAgICogaW5mb3JtYXRpb24uCiAgICAgKi8KICAg\nIHB1YmxpYyB2b2lkIGNvcHkoRmllbGRNZXRhRGF0YSBmaWVsZCkgewogICAg\nICAgIHN1cGVyLmNvcHkoZmllbGQpOwoKICAgICAgICBfaW50ZXJtZWRpYXRl\nID0gZmllbGQudXNlc0ludGVybWVkaWF0ZSgpOwogICAgICAgIF9pbXBsRGF0\nYSA9IGZpZWxkLnVzZXNJbXBsRGF0YSgpOwoKICAgICAgICAvLyBjb3B5IGZp\nZWxkLWxldmVsIGluZm87IHVzZSBnZXQgbWV0aG9kcyB0byBmb3JjZSByZXNv\nbHV0aW9uIG9mCiAgICAgICAgLy8gbGF6eSBkYXRhCiAgICAgICAgX3Byb3h5\nQ2xhc3MgPSBmaWVsZC5nZXRQcm94eVR5cGUoKTsKICAgICAgICBfaW5pdGlh\nbGl6ZXIgPSBmaWVsZC5nZXRJbml0aWFsaXplcigpOwogICAgICAgIF90cmFu\nc2llbnQgPSBmaWVsZC5pc1RyYW5zaWVudCgpOwogICAgICAgIF9udWxsVmFs\ndWUgPSBmaWVsZC5nZXROdWxsVmFsdWUoKTsKICAgICAgICBfbWFuYWdlID0g\nZmllbGQuZ2V0TWFuYWdlbWVudCgpOwogICAgICAgIF9leHBsaWNpdCA9IGZp\nZWxkLmlzRXhwbGljaXQoKTsKICAgICAgICBfZXh0TmFtZSA9IGZpZWxkLmdl\ndEV4dGVybmFsaXplcigpOwogICAgICAgIF9leHRNZXRob2QgPSBERUZBVUxU\nX01FVEhPRDsKICAgICAgICBfZmFjdE5hbWUgPSBmaWVsZC5nZXRGYWN0b3J5\nKCk7CiAgICAgICAgX2ZhY3RNZXRob2QgPSBERUZBVUxUX01FVEhPRDsKICAg\nICAgICBfZXh0U3RyaW5nID0gZmllbGQuZ2V0RXh0ZXJuYWxWYWx1ZXMoKTsK\nICAgICAgICBfZXh0VmFsdWVzID0gQ29sbGVjdGlvbnMuRU1QVFlfTUFQOwog\nICAgICAgIF9maWVsZFZhbHVlcyA9IENvbGxlY3Rpb25zLkVNUFRZX01BUDsK\nICAgICAgICBfcHJpbUtleSA9IGZpZWxkLmlzUHJpbWFyeUtleSgpOwogICAg\nICAgIF9iYWNraW5nTWVtYmVyID0gZmllbGQuX2JhY2tpbmdNZW1iZXI7CiAg\nICAgICAgX2VudW1GaWVsZCA9IGZpZWxkLl9lbnVtRmllbGQ7CiAgICAgICAg\nX2xvYkZpZWxkID0gZmllbGQuX2xvYkZpZWxkOwogICAgICAgIF9zZXJpYWxp\nemFibGVGaWVsZCA9IGZpZWxkLl9zZXJpYWxpemFibGVGaWVsZDsKICAgICAg\nICBfZ2VuZXJhdGVkID0gZmllbGQuX2dlbmVyYXRlZDsKCiAgICAgICAgLy8g\nZW1iZWRkZWQgZmllbGRzIGNhbid0IGJlIHZlcnNpb25zCiAgICAgICAgaWYg\nKF9vd25lci5nZXRFbWJlZGRpbmdNZXRhRGF0YSgpID09IG51bGwgJiYgX3Zl\ncnNpb24gPT0gbnVsbCkKICAgICAgICAgICAgX3ZlcnNpb24gPSAoZmllbGQu\naXNWZXJzaW9uKCkpID8gQm9vbGVhbi5UUlVFIDogQm9vbGVhbi5GQUxTRTsK\nCiAgICAgICAgLy8gb25seSBjb3B5IHRoaXMgZGF0YSBpZiBub3QgYWxyZWFk\neSBzZXQgZXhwbGljaXRseSBpbiB0aGlzIGluc3RhbmNlCiAgICAgICAgaWYg\nKF9kZmcgPT0gMCkgewogICAgICAgICAgICBfZGZnID0gKGZpZWxkLmlzSW5E\nZWZhdWx0RmV0Y2hHcm91cCgpKSA/IERGR19UUlVFIDogREZHX0ZBTFNFOwog\nICAgICAgICAgICBpZiAoZmllbGQuaXNEZWZhdWx0RmV0Y2hHcm91cEV4cGxp\nY2l0KCkpCiAgICAgICAgICAgICAgICBfZGZnIHw9IERGR19FWFBMSUNJVDsK\nICAgICAgICB9CiAgICAgICAgaWYgKF9mZ1NldCA9PSBudWxsICYmIGZpZWxk\nLl9mZ1NldCAhPSBudWxsKQogICAgICAgICAgICBfZmdTZXQgPSBuZXcgSGFz\naFNldChmaWVsZC5fZmdTZXQpOwogICAgICAgIGlmIChfbGZnID09IG51bGwp\nCiAgICAgICAgICAgIF9sZmcgPSBmaWVsZC5nZXRMb2FkRmV0Y2hHcm91cCgp\nOwogICAgICAgIGlmIChfbHJzID09IG51bGwpCiAgICAgICAgICAgIF9scnMg\nPSAoZmllbGQuaXNMUlMoKSkgPyBCb29sZWFuLlRSVUUgOiBCb29sZWFuLkZB\nTFNFOwogICAgICAgIGlmIChfdmFsU3RyYXRlZ3kgPT0gLTEpCiAgICAgICAg\nICAgIF92YWxTdHJhdGVneSA9IGZpZWxkLmdldFZhbHVlU3RyYXRlZ3koKTsK\nICAgICAgICBpZiAoX3VwU3RyYXRlZ3kgPT0gLTEpCiAgICAgICAgICAgIF91\ncFN0cmF0ZWd5ID0gZmllbGQuZ2V0VXBkYXRlU3RyYXRlZ3koKTsKICAgICAg\nICBpZiAoQ2xhc3NNZXRhRGF0YS5ERUZBVUxUX1NUUklORy5lcXVhbHMoX3Nl\ncU5hbWUpKSB7CiAgICAgICAgICAgIF9zZXFOYW1lID0gZmllbGQuZ2V0VmFs\ndWVTZXF1ZW5jZU5hbWUoKTsKICAgICAgICAgICAgX3NlcU1ldGEgPSBudWxs\nOwogICAgICAgIH0KICAgICAgICBpZiAoQ2xhc3NNZXRhRGF0YS5ERUZBVUxU\nX1NUUklORy5lcXVhbHMoX2ludmVyc2UpKQogICAgICAgICAgICBfaW52ZXJz\nZSA9IGZpZWxkLmdldEludmVyc2UoKTsKCiAgICAgICAgLy8gY29weSB2YWx1\nZSBtZXRhZGF0YQogICAgICAgIF92YWwuY29weShmaWVsZCk7CiAgICAgICAg\nX2tleS5jb3B5KGZpZWxkLmdldEtleSgpKTsKICAgICAgICBfZWxlbS5jb3B5\nKGZpZWxkLmdldEVsZW1lbnQoKSk7CiAgICB9CgogICAgcHJvdGVjdGVkIHZv\naWQgYWRkRXh0ZW5zaW9uS2V5cyhDb2xsZWN0aW9uIGV4dHMpIHsKICAgICAg\nICBnZXRSZXBvc2l0b3J5KCkuZ2V0TWV0YURhdGFGYWN0b3J5KCkuYWRkRmll\nbGRFeHRlbnNpb25LZXlzKGV4dHMpOwogICAgfQoKICAgIC8vLy8vLy8vLy8v\nLy8vLwogICAgLy8gQ29tbWVudGFibGUKICAgIC8vLy8vLy8vLy8vLy8vLwoK\nICAgIHB1YmxpYyBTdHJpbmdbXSBnZXRDb21tZW50cygpIHsKICAgICAgICBy\nZXR1cm4gKF9jb21tZW50cyA9PSBudWxsKSA/IEVNUFRZX0NPTU1FTlRTIDog\nX2NvbW1lbnRzOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldENvbW1lbnRz\nKFN0cmluZ1tdIGNvbW1lbnRzKSB7CiAgICAgICAgX2NvbW1lbnRzID0gY29t\nbWVudHM7CiAgICB9CgogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v\nLy8vLy8KICAgIC8vIFZhbHVlTWV0YURhdGEgaW1wbGVtZW50YXRpb24KICAg\nIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCgogICAgcHVibGlj\nIEZpZWxkTWV0YURhdGEgZ2V0RmllbGRNZXRhRGF0YSgpIHsKICAgICAgICBy\nZXR1cm4gdGhpczsKICAgIH0KCiAgICBwdWJsaWMgQ2xhc3MgZ2V0VHlwZSgp\nIHsKICAgICAgICByZXR1cm4gX3ZhbC5nZXRUeXBlKCk7CiAgICB9CgogICAg\ncHVibGljIHZvaWQgc2V0VHlwZShDbGFzcyB0eXBlKSB7CiAgICAgICAgX3Zh\nbC5zZXRUeXBlKHR5cGUpOwogICAgICAgIGlmICh0eXBlLmlzQXJyYXkoKSkK\nICAgICAgICAgICAgX2VsZW0uc2V0VHlwZSh0eXBlLmdldENvbXBvbmVudFR5\ncGUoKSk7CiAgICAgICAgZWxzZSBpZiAodHlwZSA9PSBQcm9wZXJ0aWVzLmNs\nYXNzKSB7CiAgICAgICAgICAgIF9rZXkuc2V0VHlwZShTdHJpbmcuY2xhc3Mp\nOwogICAgICAgICAgICBfZWxlbS5zZXRUeXBlKFN0cmluZy5jbGFzcyk7CiAg\nICAgICAgfQogICAgfQoKICAgIHB1YmxpYyBpbnQgZ2V0VHlwZUNvZGUoKSB7\nCiAgICAgICAgcmV0dXJuIF92YWwuZ2V0VHlwZUNvZGUoKTsKICAgIH0KCiAg\nICBwdWJsaWMgdm9pZCBzZXRUeXBlQ29kZShpbnQgY29kZSkgewogICAgICAg\nIF92YWwuc2V0VHlwZUNvZGUoY29kZSk7CiAgICB9CgogICAgcHVibGljIGJv\nb2xlYW4gaXNUeXBlUEMoKSB7CiAgICAgICAgcmV0dXJuIF92YWwuaXNUeXBl\nUEMoKTsKICAgIH0KCiAgICBwdWJsaWMgQ2xhc3NNZXRhRGF0YSBnZXRUeXBl\nTWV0YURhdGEoKSB7CiAgICAgICAgcmV0dXJuIF92YWwuZ2V0VHlwZU1ldGFE\nYXRhKCk7CiAgICB9CgogICAgcHVibGljIENsYXNzIGdldERlY2xhcmVkVHlw\nZSgpIHsKICAgICAgICByZXR1cm4gX3ZhbC5nZXREZWNsYXJlZFR5cGUoKTsK\nICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZXREZWNsYXJlZFR5cGUoQ2xhc3Mg\ndHlwZSkgewogICAgICAgIF92YWwuc2V0RGVjbGFyZWRUeXBlKHR5cGUpOwog\nICAgICAgIGlmICh0eXBlLmlzQXJyYXkoKSkKICAgICAgICAgICAgX2VsZW0u\nc2V0RGVjbGFyZWRUeXBlKHR5cGUuZ2V0Q29tcG9uZW50VHlwZSgpKTsKICAg\nICAgICBlbHNlIGlmICh0eXBlID09IFByb3BlcnRpZXMuY2xhc3MpIHsKICAg\nICAgICAgICAgX2tleS5zZXREZWNsYXJlZFR5cGUoU3RyaW5nLmNsYXNzKTsK\nICAgICAgICAgICAgX2VsZW0uc2V0RGVjbGFyZWRUeXBlKFN0cmluZy5jbGFz\ncyk7CiAgICAgICAgfQogICAgfQoKICAgIHB1YmxpYyBpbnQgZ2V0RGVjbGFy\nZWRUeXBlQ29kZSgpIHsKICAgICAgICByZXR1cm4gX3ZhbC5nZXREZWNsYXJl\nZFR5cGVDb2RlKCk7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0RGVjbGFy\nZWRUeXBlQ29kZShpbnQgdHlwZSkgewogICAgICAgIF92YWwuc2V0RGVjbGFy\nZWRUeXBlQ29kZSh0eXBlKTsKICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBp\nc0RlY2xhcmVkVHlwZVBDKCkgewogICAgICAgIHJldHVybiBfdmFsLmlzRGVj\nbGFyZWRUeXBlUEMoKTsKICAgIH0KCiAgICBwdWJsaWMgQ2xhc3NNZXRhRGF0\nYSBnZXREZWNsYXJlZFR5cGVNZXRhRGF0YSgpIHsKICAgICAgICByZXR1cm4g\nX3ZhbC5nZXREZWNsYXJlZFR5cGVNZXRhRGF0YSgpOwogICAgfQoKICAgIHB1\nYmxpYyBib29sZWFuIGlzRW1iZWRkZWQoKSB7CiAgICAgICAgcmV0dXJuIF92\nYWwuaXNFbWJlZGRlZCgpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldEVt\nYmVkZGVkKGJvb2xlYW4gZW1iZWRkZWQpIHsKICAgICAgICBfdmFsLnNldEVt\nYmVkZGVkKGVtYmVkZGVkKTsKICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBp\nc0VtYmVkZGVkUEMoKSB7CiAgICAgICAgcmV0dXJuIF92YWwuaXNFbWJlZGRl\nZFBDKCk7CiAgICB9CgogICAgcHVibGljIENsYXNzTWV0YURhdGEgZ2V0RW1i\nZWRkZWRNZXRhRGF0YSgpIHsKICAgICAgICByZXR1cm4gX3ZhbC5nZXRFbWJl\nZGRlZE1ldGFEYXRhKCk7CiAgICB9CgogICAgcHVibGljIENsYXNzTWV0YURh\ndGEgYWRkRW1iZWRkZWRNZXRhRGF0YSgpIHsKICAgICAgICByZXR1cm4gX3Zh\nbC5hZGRFbWJlZGRlZE1ldGFEYXRhKCk7CiAgICB9CgogICAgcHVibGljIGlu\ndCBnZXRDYXNjYWRlRGVsZXRlKCkgewogICAgICAgIHJldHVybiBfdmFsLmdl\ndENhc2NhZGVEZWxldGUoKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRD\nYXNjYWRlRGVsZXRlKGludCBkZWxldGUpIHsKICAgICAgICBfdmFsLnNldENh\nc2NhZGVEZWxldGUoZGVsZXRlKTsKICAgIH0KCiAgICBwdWJsaWMgaW50IGdl\ndENhc2NhZGVQZXJzaXN0KCkgewogICAgICAgIHJldHVybiBfdmFsLmdldENh\nc2NhZGVQZXJzaXN0KCk7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0Q2Fz\nY2FkZVBlcnNpc3QoaW50IHBlcnNpc3QpIHsKICAgICAgICBfdmFsLnNldENh\nc2NhZGVQZXJzaXN0KHBlcnNpc3QpOwogICAgfQoKICAgIHB1YmxpYyBpbnQg\nZ2V0Q2FzY2FkZUF0dGFjaCgpIHsKICAgICAgICByZXR1cm4gX3ZhbC5nZXRD\nYXNjYWRlQXR0YWNoKCk7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0Q2Fz\nY2FkZUF0dGFjaChpbnQgYXR0YWNoKSB7CiAgICAgICAgX3ZhbC5zZXRDYXNj\nYWRlQXR0YWNoKGF0dGFjaCk7CiAgICB9CgogICAgcHVibGljIGludCBnZXRD\nYXNjYWRlUmVmcmVzaCgpIHsKICAgICAgICByZXR1cm4gX3ZhbC5nZXRDYXNj\nYWRlUmVmcmVzaCgpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldENhc2Nh\nZGVSZWZyZXNoKGludCByZWZyZXNoKSB7CiAgICAgICAgX3ZhbC5zZXRDYXNj\nYWRlUmVmcmVzaChyZWZyZXNoKTsKICAgIH0KCiAgICBwdWJsaWMgYm9vbGVh\nbiBpc1NlcmlhbGl6ZWQoKSB7CiAgICAgICAgcmV0dXJuIF92YWwuaXNTZXJp\nYWxpemVkKCk7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0U2VyaWFsaXpl\nZChib29sZWFuIHNlcmlhbGl6ZWQpIHsKICAgICAgICBfdmFsLnNldFNlcmlh\nbGl6ZWQoc2VyaWFsaXplZCk7CiAgICB9CgogICAgcHVibGljIFN0cmluZyBn\nZXRWYWx1ZU1hcHBlZEJ5KCkgewogICAgICAgIHJldHVybiBfdmFsLmdldFZh\nbHVlTWFwcGVkQnkoKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRWYWx1\nZU1hcHBlZEJ5KFN0cmluZyBtYXBwZWQpIHsKICAgICAgICBfdmFsLnNldFZh\nbHVlTWFwcGVkQnkobWFwcGVkKTsKICAgIH0KCiAgICBwdWJsaWMgRmllbGRN\nZXRhRGF0YSBnZXRWYWx1ZU1hcHBlZEJ5TWV0YURhdGEgKCkKCXsKCQlyZXR1\ncm4gX3ZhbC5nZXRWYWx1ZU1hcHBlZEJ5TWV0YURhdGEgKCk7Cgl9CgoJcHVi\nbGljIENsYXNzIGdldFR5cGVPdmVycmlkZSAoKQoJewoJCXJldHVybiBfdmFs\nLmdldFR5cGVPdmVycmlkZSAoKTsKCX0KCglwdWJsaWMgdm9pZCBzZXRUeXBl\nT3ZlcnJpZGUgKENsYXNzIHR5cGUpCgl7CgkJX3ZhbC5zZXRUeXBlT3ZlcnJp\nZGUgKHR5cGUpOwoJfQoKCXB1YmxpYyB2b2lkIGNvcHkgKFZhbHVlTWV0YURh\ndGEgdm1kKQoJewoJCV92YWwuY29weSAodm1kKTsKCX0KCiAgICAvKioKICAg\nICAqIFNlcmlhbGl6YWJsZSB3cmFwcGVyIGFyb3VuZCBhIHtAbGluayBNZXRo\nb2R9IG9yIHtAbGluayBGaWVsZH0uIEZvciAKICAgICAqIHNwYWNlIGNvbnNp\nZGVyYXRpb25zLCB0aGlzIGRvZXMgbm90IHN1cHBvcnQge0BsaW5rIENvbnN0\ncnVjdG9yfXMuCiAgICAgKi8KCXByaXZhdGUgc3RhdGljIGNsYXNzIE1lbWJl\nclByb3ZpZGVyIAogICAgICAgIGltcGxlbWVudHMgRXh0ZXJuYWxpemFibGUg\newoKICAgICAgICBwcml2YXRlIHRyYW5zaWVudCBNZW1iZXIgX21lbWJlcjsK\nICAgICAgICAKICAgICAgICBwcml2YXRlIE1lbWJlclByb3ZpZGVyKE1lbWJl\nciBtZW1iZXIpIHsKICAgICAgICAgICAgaWYgKG1lbWJlciBpbnN0YW5jZW9m\nIENvbnN0cnVjdG9yKQogICAgICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVn\nYWxBcmd1bWVudEV4Y2VwdGlvbigpOwoKICAgICAgICAgICAgX21lbWJlciA9\nIG1lbWJlcjsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgcHVibGljIE1l\nbWJlciBnZXRNZW1iZXIoKSB7CiAgICAgICAgICAgIHJldHVybiBfbWVtYmVy\nOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIHZvaWQgcmVhZEV4dGVybmFs\nKE9iamVjdElucHV0IGluKQogICAgICAgICAgICB0aHJvd3MgSU9FeGNlcHRp\nb24sIENsYXNzTm90Rm91bmRFeGNlcHRpb24gewogICAgICAgICAgICBib29s\nZWFuIGlzRmllbGQgPSBpbi5yZWFkQm9vbGVhbigpOwogICAgICAgICAgICBD\nbGFzcyBjbHMgPSBfbWVtYmVyLmdldERlY2xhcmluZ0NsYXNzKCk7CiAgICAg\nICAgICAgIFN0cmluZyBtZW1iZXJOYW1lID0gKFN0cmluZykgaW4ucmVhZE9i\namVjdCgpOwogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgaWYg\nKGlzRmllbGQpCiAgICAgICAgICAgICAgICAgICAgX21lbWJlciA9IChGaWVs\nZCkgQWNjZXNzQ29udHJvbGxlci5kb1ByaXZpbGVnZWQoCiAgICAgICAgICAg\nICAgICAgICAgICAgIEoyRG9Qcml2SGVscGVyLmdldERlY2xhcmVkRmllbGRB\nY3Rpb24oCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbHMsbWVtYmVy\nTmFtZSkpOyAKICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAg\nICAgICAgIENsYXNzW10gcGFyYW1ldGVyVHlwZXMgPSAoQ2xhc3NbXSkgaW4u\ncmVhZE9iamVjdCgpOwogICAgICAgICAgICAgICAgICAgIF9tZW1iZXIgPSAo\nTWV0aG9kKSBBY2Nlc3NDb250cm9sbGVyLmRvUHJpdmlsZWdlZCgKICAgICAg\nICAgICAgICAgICAgICAgICAgSjJEb1ByaXZIZWxwZXIuZ2V0RGVjbGFyZWRN\nZXRob2RBY3Rpb24oCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbHMs\nIG1lbWJlck5hbWUsIHBhcmFtZXRlclR5cGVzKSk7CiAgICAgICAgICAgICAg\nICB9CiAgICAgICAgICAgIH0gY2F0Y2ggKFNlY3VyaXR5RXhjZXB0aW9uIGUp\nIHsKICAgICAgICAgICAgICAgIElPRXhjZXB0aW9uIGlvZSA9IG5ldyBJT0V4\nY2VwdGlvbihlLmdldE1lc3NhZ2UoKSk7CiAgICAgICAgICAgICAgICBpb2Uu\naW5pdENhdXNlKGUpOwogICAgICAgICAgICAgICAgdGhyb3cgaW9lOwogICAg\nICAgICAgICB9IGNhdGNoIChQcml2aWxlZ2VkQWN0aW9uRXhjZXB0aW9uIHBh\nZSkgewogICAgICAgICAgICAgICAgSU9FeGNlcHRpb24gaW9lID0gbmV3IElP\nRXhjZXB0aW9uKAogICAgICAgICAgICAgICAgICAgIHBhZS5nZXRFeGNlcHRp\nb24oKS5nZXRNZXNzYWdlKCkpOwogICAgICAgICAgICAgICAgaW9lLmluaXRD\nYXVzZShwYWUpOwogICAgICAgICAgICAgICAgdGhyb3cgaW9lOwogICAgICAg\nICAgICB9CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgdm9pZCB3cml0ZUV4\ndGVybmFsKE9iamVjdE91dHB1dCBvdXQpCiAgICAgICAgICAgIHRocm93cyBJ\nT0V4Y2VwdGlvbiB7CiAgICAgICAgICAgIGJvb2xlYW4gaXNGaWVsZCA9IF9t\nZW1iZXIgaW5zdGFuY2VvZiBGaWVsZDsKICAgICAgICAgICAgb3V0LndyaXRl\nQm9vbGVhbihpc0ZpZWxkKTsKICAgICAgICAgICAgb3V0LndyaXRlT2JqZWN0\nKF9tZW1iZXIuZ2V0RGVjbGFyaW5nQ2xhc3MoKSk7CiAgICAgICAgICAgIG91\ndC53cml0ZU9iamVjdChfbWVtYmVyLmdldE5hbWUoKSk7CiAgICAgICAgICAg\nIGlmICghaXNGaWVsZCkKICAgICAgICAgICAgICAgIG91dC53cml0ZU9iamVj\ndCgoKE1ldGhvZCkgX21lbWJlcikuZ2V0UGFyYW1ldGVyVHlwZXMoKSk7CiAg\nICAgICAgfQogICAgfQoKICAgIHB1YmxpYyBib29sZWFuIGlzVmFsdWVHZW5l\ncmF0ZWQoKSB7CiAgICAgICAgcmV0dXJuIF9nZW5lcmF0ZWQ7CiAgICB9Cgog\nICAgcHVibGljIHZvaWQgc2V0VmFsdWVHZW5lcmF0ZWQoYm9vbGVhbiBnZW5l\ncmF0ZWQpIHsKICAgICAgICB0aGlzLl9nZW5lcmF0ZWQgPSBnZW5lcmF0ZWQ7\nCiAgICB9Cn0K\n","encoding":"base64"}

