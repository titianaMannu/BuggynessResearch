{"sha":"f13b8bad1a54cf155723df8693bd9a5e52f49c21","node_id":"MDQ6QmxvYjIwNjM2NDpmMTNiOGJhZDFhNTRjZjE1NTcyM2RmODY5M2JkOWE1ZTUyZjQ5YzIx","size":4498,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/f13b8bad1a54cf155723df8693bd9a5e52f49c21","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbDsKCmltcG9ydCBqYXZh\nLnNlY3VyaXR5LkFjY2Vzc0NvbnRyb2xsZXI7CgppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLmNvbmYuT3BlbkpQQUNvbmZpZ3VyYXRpb247CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuSjJEb1ByaXZIZWxwZXI7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuTG9jYWxpemVyOwpp\nbXBvcnQgc2VycC51dGlsLk51bWJlcnM7CgovKioKICogRGF0YXN0b3JlIGlk\nZW50aXR5IHR5cGUuIEltcGxlbWVudGF0aW9ucyBtYXkgY2hvb3NlIHRvIHVz\nZSB0aGlzIHR5cGUsCiAqIG9yIGNob29zZSB0byB1c2UgdGhlaXIgb3duIGRh\ndGFzdG9yZSBpZGVudGl0eSB2YWx1ZXMuCiAqCiAqIEBhdXRob3IgQWJlIFdo\naXRlCiAqLwpwdWJsaWMgZmluYWwgY2xhc3MgSWQKICAgIGV4dGVuZHMgT3Bl\nbkpQQUlkIHsKCiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBMb2NhbGl6ZXIg\nX2xvYyA9IExvY2FsaXplci5mb3JQYWNrYWdlKElkLmNsYXNzKTsKCiAgICBw\ncml2YXRlIGZpbmFsIGxvbmcgX2lkOwoKICAgIC8qKgogICAgICogQ3JlYXRl\nIGFuIGlkIGZyb20gdGhlIGdpdmVuIHR5cGUgYW5kIHZhbHVlOyB0aGUgdmFs\ndWUgbWlnaHQgYmUgYW4KICAgICAqIGlkIGluc3RuYWNlLCBhIHN0cmluZ2lm\naWVkIGlkLCBvciBhIHByaW1hcnkga2V5IHZhbHVlLgogICAgICovCiAgICBw\ndWJsaWMgc3RhdGljIElkIG5ld0luc3RhbmNlKENsYXNzIGNscywgT2JqZWN0\nIHZhbCkgewogICAgICAgIGlmICh2YWwgaW5zdGFuY2VvZiBJZCkKICAgICAg\nICAgICAgcmV0dXJuIChJZCkgdmFsOwogICAgICAgIGlmICh2YWwgaW5zdGFu\nY2VvZiBTdHJpbmcpCiAgICAgICAgICAgIHJldHVybiBuZXcgSWQoY2xzLCAo\nU3RyaW5nKSB2YWwpOwogICAgICAgIGlmICh2YWwgaW5zdGFuY2VvZiBOdW1i\nZXIpCiAgICAgICAgICAgIHJldHVybiBuZXcgSWQoY2xzLCAoKE51bWJlcikg\ndmFsKS5sb25nVmFsdWUoKSk7CiAgICAgICAgaWYgKHZhbCA9PSBudWxsKQog\nICAgICAgICAgICByZXR1cm4gbmV3IElkKGNscywgMEwpOwogICAgICAgIHRo\ncm93IG5ldyBVc2VyRXhjZXB0aW9uKF9sb2MuZ2V0KCJ1bmtub3duLW9pZCIs\nIGNscywgdmFsLAogICAgICAgICAgICB2YWwuZ2V0Q2xhc3MoKSkpOwogICAg\nfQoKICAgIC8qKgogICAgICogQ3JlYXRlIGFuIGlkIGZyb20gdGhlIHJlc3Vs\ndCBvZiBhIHtAbGluayAjdG9TdHJpbmd9IGNhbGwgb24gYW5vdGhlcgogICAg\nICogaW5zdGFuY2UuCiAgICAgKi8KICAgIHB1YmxpYyBJZChTdHJpbmcgc3Ry\nKSB7CiAgICAgICAgdGhpcyhzdHIsIChDbGFzc0xvYWRlcikgbnVsbCk7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBDcmVhdGUgYW4gaWQgZnJvbSB0aGUgcmVz\ndWx0IG9mIGFuIHtAbGluayAjdG9TdHJpbmd9IGNhbGwgb24gYW5vdGhlcgog\nICAgICogaW5zdGFuY2UuCiAgICAgKi8KICAgIHB1YmxpYyBJZChTdHJpbmcg\nc3RyLCBPcGVuSlBBQ29uZmlndXJhdGlvbiBjb25mLCBDbGFzc0xvYWRlciBi\ncm9rZXJMb2FkZXIpIHsKICAgICAgICB0aGlzKHN0ciwgKGNvbmYgPT0gbnVs\nbCkgPyBicm9rZXJMb2FkZXIgOiBjb25mLgogICAgICAgICAgICBnZXRDbGFz\nc1Jlc29sdmVySW5zdGFuY2UoKS5nZXRDbGFzc0xvYWRlcihJZC5jbGFzcywg\nYnJva2VyTG9hZGVyKSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBDcmVhdGUg\nYW4gaWQgZnJvbSB0aGUgcmVzdWx0IG9mIGFuIHtAbGluayAjdG9TdHJpbmd9\nIGNhbGwgb24gYW5vdGhlcgogICAgICogaW5zdGFuY2UuCiAgICAgKi8KICAg\nIHB1YmxpYyBJZChTdHJpbmcgc3RyLCBDbGFzc0xvYWRlciBsb2FkZXIpIHsK\nICAgICAgICBpZiAobG9hZGVyID09IG51bGwpCiAgICAgICAgICAgIGxvYWRl\nciA9IChDbGFzc0xvYWRlcikgQWNjZXNzQ29udHJvbGxlci5kb1ByaXZpbGVn\nZWQoCiAgICAgICAgICAgICAgICBKMkRvUHJpdkhlbHBlci5nZXRDb250ZXh0\nQ2xhc3NMb2FkZXJBY3Rpb24oKSk7CgogICAgICAgIGlmIChzdHIgPT0gbnVs\nbCkKICAgICAgICAgICAgX2lkID0gMEw7CiAgICAgICAgZWxzZSB7CiAgICAg\nICAgICAgIGludCBkYXNoID0gc3RyLmluZGV4T2YoJy0nKTsKICAgICAgICAg\nICAgdHJ5IHsKICAgICAgICAgICAgICAgIHR5cGUgPSBDbGFzcy5mb3JOYW1l\nKHN0ci5zdWJzdHJpbmcoMCwgZGFzaCksIHRydWUsIGxvYWRlcik7CiAgICAg\nICAgICAgIH0gY2F0Y2ggKFRocm93YWJsZSB0KSB7CiAgICAgICAgICAgICAg\nICB0aHJvdyBuZXcgVXNlckV4Y2VwdGlvbihfbG9jLmdldCgic3RyaW5nLWlk\nIiwgc3RyKSwgdCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgX2lkID0g\nTG9uZy5wYXJzZUxvbmcoc3RyLnN1YnN0cmluZyhkYXNoICsgMSkpOwogICAg\nICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIENvbnN0cnVjdCBmcm9tIHRo\nZSByZXN1bHQgb2YgYSB7QGxpbmsgI3RvU3RyaW5nfSBjYWxsIG9uIGFub3Ro\nZXIKICAgICAqIGluc3RhbmNlLgogICAgICovCiAgICBwdWJsaWMgSWQoQ2xh\nc3MgY2xzLCBTdHJpbmcga2V5KSB7CiAgICAgICAgc3VwZXIoY2xzKTsKCiAg\nICAgICAgaWYgKGtleSA9PSBudWxsKQogICAgICAgICAgICBfaWQgPSAwTDsK\nICAgICAgICBlbHNlIHsKICAgICAgICAgICAgLy8gYWxsb3cgZWl0aGVyIHN0\ncmluZ2lmaWVkIGxvbmcgb3IgcmVzdWx0IG9mIElkLnRvU3RyaW5nCiAgICAg\nICAgICAgIGludCBkYXNoID0ga2V5LmluZGV4T2YoJy0nKTsKICAgICAgICAg\nICAgaWYgKGRhc2ggPiAwKSAvLyBkb24ndCBjaGVjayBmb3IgLTE7IG1pZ2h0\nIGJlIG5lZ2F0aXZlIG51bWJlcgogICAgICAgICAgICAgICAga2V5ID0ga2V5\nLnN1YnN0cmluZyhkYXNoICsgMSk7CiAgICAgICAgICAgIF9pZCA9IExvbmcu\ncGFyc2VMb25nKGtleSk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAg\nICogQ29uc3RydWN0IGZyb20ga2V5IHZhbHVlLgogICAgICovCiAgICBwdWJs\naWMgSWQoQ2xhc3MgY2xzLCBMb25nIGtleSkgewogICAgICAgIHRoaXMoY2xz\nLCAoa2V5ID09IG51bGwpID8gMEwgOiBrZXkubG9uZ1ZhbHVlKCkpOwogICAg\nfQoKICAgIC8qKgogICAgICogQ29uc3RydWN0IGZyb20ga2V5IHZhbHVlLgog\nICAgICovCiAgICBwdWJsaWMgSWQoQ2xhc3MgY2xzLCBsb25nIGtleSkgewog\nICAgICAgIHN1cGVyKGNscyk7CiAgICAgICAgX2lkID0ga2V5OwogICAgfQoK\nICAgIC8qKgogICAgICogQ29uc3RydWN0IGZyb20ga2V5IHZhbHVlLgogICAg\nICovCiAgICBwdWJsaWMgSWQoQ2xhc3MgY2xzLCBsb25nIGtleSwgYm9vbGVh\nbiBzdWJzKSB7CiAgICAgICAgc3VwZXIoY2xzLCBzdWJzKTsKICAgICAgICBf\naWQgPSBrZXk7CiAgICB9CgogICAgLyoqCiAgICAgKiBQcmltYXJ5IGtleS4K\nICAgICAqLwogICAgcHVibGljIGxvbmcgZ2V0SWQoKSB7CiAgICAgICAgcmV0\ndXJuIF9pZDsKICAgIH0KCiAgICBwdWJsaWMgT2JqZWN0IGdldElkT2JqZWN0\nKCkgewogICAgICAgIHJldHVybiBOdW1iZXJzLnZhbHVlT2YoX2lkKTsKICAg\nIH0KCiAgICBwcm90ZWN0ZWQgaW50IGlkSGFzaCgpIHsKICAgICAgICByZXR1\ncm4gKGludCkgKF9pZCBeIChfaWQgPj4+IDMyKSk7CiAgICB9CgogICAgcHJv\ndGVjdGVkIGJvb2xlYW4gaWRFcXVhbHMoT3BlbkpQQUlkIG90aGVyKSB7CiAg\nICAgICAgcmV0dXJuIF9pZCA9PSAoKElkKSBvdGhlcikuX2lkOwoJfQp9Cg==\n","encoding":"base64"}

