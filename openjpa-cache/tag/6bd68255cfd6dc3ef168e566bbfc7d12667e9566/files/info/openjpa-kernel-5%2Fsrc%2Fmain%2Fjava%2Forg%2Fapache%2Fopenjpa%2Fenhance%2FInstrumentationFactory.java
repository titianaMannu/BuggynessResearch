{"sha":"505b5ff25e5777465e8ebc1530798393c94295d2","node_id":"MDQ6QmxvYjIwNjM2NDo1MDViNWZmMjVlNTc3NzQ2NWU4ZWJjMTUzMDc5ODM5M2M5NDI5NWQy","size":4527,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/505b5ff25e5777465e8ebc1530798393c94295d2","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuZW5oYW5jZTsKCmltcG9ydCBq\nYXZhLmlvLio7CmltcG9ydCBqYXZhLmxhbmcuaW5zdHJ1bWVudC4qOwppbXBv\ncnQgamF2YS5sYW5nLm1hbmFnZW1lbnQuKjsKaW1wb3J0IGphdmEubGFuZy5y\nZWZsZWN0Lkludm9jYXRpb25UYXJnZXRFeGNlcHRpb247CmltcG9ydCBqYXZh\nLnV0aWwuemlwLio7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0\naWwuKjsKCgovKioKICogRmFjdG9yeSBmb3Igb2J0YWluaW5nIGFuIHtAbGlu\nayBJbnN0cnVtZW50YXRpb259IGluc3RhbmNlLgogKgogKiBAYXV0aG9yIE1h\ncmMgUHJ1ZCdob21tZWF1eAogKiBAc2luY2UgMS4wLjAKICovCnB1YmxpYyBj\nbGFzcyBJbnN0cnVtZW50YXRpb25GYWN0b3J5IHsKICAgIHByaXZhdGUgc3Rh\ndGljIEluc3RydW1lbnRhdGlvbiBfaW5zdDsKICAgIHByaXZhdGUgc3RhdGlj\nIGJvb2xlYW4gX2R5bmFtaWNhbGx5SW5zdGFsbCA9IHRydWU7CgogICAgcHVi\nbGljIHN0YXRpYyB2b2lkIHNldEluc3RydW1lbnRhdGlvbihJbnN0cnVtZW50\nYXRpb24gaW5zdCkgewogICAgICAgIF9pbnN0ID0gaW5zdDsKICAgIH0KCiAg\nICAvKioKICAgICAqIENvbmZpZ3VyZXMgd2hldGhlciBvciBub3QgdGhpcyBp\nbnN0YW5jZSBzaG91bGQgYXR0ZW1wdCB0byBkeW5hbWljYWxseQogICAgICog\naW5zdGFsbCBhbiBhZ2VudCBpbiB0aGUgVk0uIERlZmF1bHRzIHRvIDxjb2Rl\nPnRydWU8L2NvZGU+LgogICAgICovCiAgICBwdWJsaWMgc3RhdGljIHN5bmNo\ncm9uaXplZCB2b2lkIHNldER5bmFtaWNhbGx5SW5zdGFsbEFnZW50KGJvb2xl\nYW4gdmFsKSB7CiAgICAgICAgX2R5bmFtaWNhbGx5SW5zdGFsbCA9IHZhbDsK\nICAgIH0KCiAgICBwdWJsaWMgc3RhdGljIHN5bmNocm9uaXplZCBJbnN0cnVt\nZW50YXRpb24gZ2V0SW5zdHJ1bWVudGF0aW9uKCkKICAgICAgICB0aHJvd3Mg\nSU9FeGNlcHRpb24sIE5vU3VjaE1ldGhvZEV4Y2VwdGlvbiwgSWxsZWdhbEFj\nY2Vzc0V4Y2VwdGlvbiwKICAgICAgICBJbnZvY2F0aW9uVGFyZ2V0RXhjZXB0\naW9uLCBDbGFzc05vdEZvdW5kRXhjZXB0aW9uIHsKICAgICAgICBpZiAoX2lu\nc3QgIT0gbnVsbCB8fCAhX2R5bmFtaWNhbGx5SW5zdGFsbCkKICAgICAgICAg\nICAgcmV0dXJuIF9pbnN0OwoKICAgICAgICAvLyBkeW5hbWljIGxvYWRpbmcg\nb2YgdGhlIGFnZW50IGlzIG9ubHkgYXZhaWxhYmxlIGluIEpESyAxLjYrCiAg\nICAgICAgaWYgKEphdmFWZXJzaW9ucy5WRVJTSU9OIDwgNikKICAgICAgICAg\nICAgcmV0dXJuIG51bGw7CgogICAgICAgIFN0cmluZyBhZ2VudFBhdGggPSBn\nZXRBZ2VudEphcigpOwoKICAgICAgICAvLyBmaXJzdCBvYnRhaW4gdGhlIFBJ\nRCBvZiB0aGUgY3VycmVudGx5LXJ1bm5pbmcgcHJvY2VzcwogICAgICAgIC8v\nICMjIyB0aGlzIHJlbGllcyBvbiB0aGUgdW5kb2N1bWVudGVkIGNvbnZlbnRp\nb24gb2YgdGhlIFJ1bnRpbWVNWEJlYW4ncwogICAgICAgIC8vICMjIyBuYW1l\nIHN0YXJ0aW5nIHdpdGggdGhlIFBJRCwgYnV0IHRoZXJlIGFwcGVhcnMgdG8g\nYmUgbm8gb3RoZXIKICAgICAgICAvLyAjIyMgd2F5IHRvIG9idGFpbiB0aGUg\nY3VycmVudCBwcm9jZXNzJyBpZCwgd2hpY2ggd2UgbmVlZCBmb3IKICAgICAg\nICAvLyAjIyMgdGhlIGF0dGFjaCBwcm9jZXNzCiAgICAgICAgUnVudGltZU1Y\nQmVhbiBydW50aW1lID0gTWFuYWdlbWVudEZhY3RvcnkuZ2V0UnVudGltZU1Y\nQmVhbigpOwogICAgICAgIFN0cmluZyBwaWQgPSBydW50aW1lLmdldE5hbWUo\nKTsKICAgICAgICBpZiAocGlkLmluZGV4T2YoIkAiKSAhPSAtMSkKICAgICAg\nICAgICAgcGlkID0gcGlkLnN1YnN0cmluZygwLCBwaWQuaW5kZXhPZigiQCIp\nKTsKCiAgICAgICAgLy8gSkRLMS42OiBub3cgYXR0YWNoIHRvIHRoZSBjdXJy\nZW50IFZNIHNvIHdlIGNhbiBkZXBsb3kgYSBuZXcgYWdlbnQKICAgICAgICAv\nLyAjIyMgdGhpcyBpcyBhIFN1biBKVk0gc3BlY2lmaWMgZmVhdHVyZTsgb3Ro\nZXIgSlZNcyBtYXkgb2ZmZXIKICAgICAgICAvLyAjIyMgdGhpcyBmZWF0dXJl\nLCBidXQgaW4gYW4gaW1wbGVtZW50YXRpb24tZGVwZW5kZW50IHdheQogICAg\nICAgIENsYXNzIHZtQ2xhc3MgPSBDbGFzcy5mb3JOYW1lKCJjb20uc3VuLnRv\nb2xzLmF0dGFjaC5WaXJ0dWFsTWFjaGluZSIpOwogICAgICAgIE9iamVjdCB2\nbSA9IHZtQ2xhc3MuZ2V0TWV0aG9kKCJhdHRhY2giLCBuZXcgQ2xhc3NbXSB7\nIFN0cmluZy5jbGFzcyB9KS4KICAgICAgICAgICAgaW52b2tlKG51bGwsIG5l\ndyBTdHJpbmdbXSB7IHBpZCB9KTsKCiAgICAgICAgLy8gbm93IGRlcGxveSB0\naGUgYWN0dWFsIGFnZW50LCB3aGljaCB3aWxsIHdpbmQgdXAgY2FsbGluZyBh\nZ2VudG1haW4oKQogICAgICAgIHZtLmdldENsYXNzKCkuZ2V0TWV0aG9kKCJs\nb2FkQWdlbnQiLCBuZXcgQ2xhc3NbXSB7IFN0cmluZy5jbGFzcyB9KS4KICAg\nICAgICAgICAgaW52b2tlKHZtLCBuZXcgT2JqZWN0W10geyBhZ2VudFBhdGgg\nfSk7CgogICAgICAgIGlmIChfaW5zdCAhPSBudWxsKQogICAgICAgICAgICBy\nZXR1cm4gX2luc3Q7CgogICAgICAgIHJldHVybiBudWxsOwogICAgfQoKICAg\nIC8qKiAKICAgICAqICBDcmVhdGUgYSBuZXcgamFyIGZpbGUgZm9yIHRoZSBz\nb2xlIHB1cnBvc2Ugb2Ygc3BlY2lmeWluZyBhbgogICAgICogIEFnZW50LUNs\nYXNzIHRvIGxvYWQgaW50byB0aGUgSlZNLgogICAgICovCiAgICBwcml2YXRl\nIHN0YXRpYyBTdHJpbmcgZ2V0QWdlbnRKYXIoKSB0aHJvd3MgSU9FeGNlcHRp\nb24gewogICAgICAgIEZpbGUgZmlsZSA9IEZpbGUuY3JlYXRlVGVtcEZpbGUo\nCiAgICAgICAgICAgIEluc3RydW1lbnRhdGlvbkZhY3RvcnkuY2xhc3MuZ2V0\nTmFtZSgpLCAiLmphciIpOwogICAgICAgIGZpbGUuZGVsZXRlT25FeGl0KCk7\nCgogICAgICAgIFppcE91dHB1dFN0cmVhbSB6b3V0ID0gbmV3IFppcE91dHB1\ndFN0cmVhbShuZXcgRmlsZU91dHB1dFN0cmVhbShmaWxlKSk7CiAgICAgICAg\nem91dC5wdXROZXh0RW50cnkobmV3IFppcEVudHJ5KCJNRVRBLUlORi9NQU5J\nRkVTVC5NRiIpKTsKCiAgICAgICAgUHJpbnRXcml0ZXIgd3JpdGVyID0gbmV3\nIFByaW50V3JpdGVyCiAgICAgICAgICAgIChuZXcgT3V0cHV0U3RyZWFtV3Jp\ndGVyKHpvdXQpKTsKCiAgICAgICAgd3JpdGVyLnByaW50bG4oIkFnZW50LUNs\nYXNzOiAiCiAgICAgICAgICAgICsgSW5zdHJ1bWVudGF0aW9uRmFjdG9yeS5j\nbGFzcy5nZXROYW1lKCkpOwogICAgICAgIHdyaXRlci5wcmludGxuKCJDYW4t\nUmVkZWZpbmUtQ2xhc3NlczogdHJ1ZSIpOwogICAgICAgIHdyaXRlci5wcmlu\ndGxuKCJDYW4tUmV0cmFuc2Zvcm0tQ2xhc3NlczogdHJ1ZSIpOwoKICAgICAg\nICB3cml0ZXIuY2xvc2UoKTsKCiAgICAgICAgcmV0dXJuIGZpbGUuZ2V0QWJz\nb2x1dGVQYXRoKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiAgVGhlIG1ldGhv\nZCB0aGF0IGlzIGNhbGxlZCB3aGVuIGEgamFyIGlzIGFkZGVkIGFzIGFuIGFn\nZW50IGF0IHJ1bnRpbWUuCiAgICAgKiAgQWxsIHRoaXMgbWV0aG9kIGRvZXMg\naXMgc3RvcmUgdGhlIHtAbGluayBJbnN0cnVtZW50YXRpb259IGZvcgogICAg\nICogIGxhdGVyIHVzZS4KICAgICAqLwogICAgcHVibGljIHN0YXRpYyB2b2lk\nIGFnZW50bWFpbihTdHJpbmcgYWdlbnRBcmdzLCBJbnN0cnVtZW50YXRpb24g\naW5zdCkgewogICAgICAgIEluc3RydW1lbnRhdGlvbkZhY3Rvcnkuc2V0SW5z\ndHJ1bWVudGF0aW9uKGluc3QpOwogICAgfQp9\n","encoding":"base64"}

