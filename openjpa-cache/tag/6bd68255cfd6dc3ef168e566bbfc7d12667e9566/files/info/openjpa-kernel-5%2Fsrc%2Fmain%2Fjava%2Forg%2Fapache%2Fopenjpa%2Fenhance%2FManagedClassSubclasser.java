{"sha":"6d6305e91d88ed180544c0ff888deed5d7923aa1","node_id":"MDQ6QmxvYjIwNjM2NDo2ZDYzMDVlOTFkODhlZDE4MDU0NGMwZmY4ODhkZWVkNWQ3OTIzYWEx","size":11883,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/6d6305e91d88ed180544c0ff888deed5d7923aa1","content":"LyoNCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUNCiAqIG9yIG1vcmUgY29udHJpYnV0b3Ig\nbGljZW5zZSBhZ3JlZW1lbnRzLiAgU2VlIHRoZSBOT1RJQ0UgZmlsZQ0KICog\nZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5m\nb3JtYXRpb24NCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAg\nVGhlIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUNCiAqIHRvIHlvdSB1bmRlciB0\naGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUNCiAqICJMaWNl\nbnNlIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNv\nbXBsaWFuY2UNCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFp\nbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQNCiAqDQogKiBodHRwOi8vd3d3\nLmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjANCiAqDQogKiBVbmxl\nc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGlu\nIHdyaXRpbmcsDQogKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUg\nTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbg0KICogIkFTIElTIiBCQVNJ\nUywgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZDQog\nKiBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBM\naWNlbnNlIGZvciB0aGUNCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmlu\nZyBwZXJtaXNzaW9ucyBhbmQgbGltaXRhdGlvbnMNCiAqIHVuZGVyIHRoZSBM\naWNlbnNlLg0KICovDQpwYWNrYWdlIG9yZy5hcGFjaGUub3BlbmpwYS5lbmhh\nbmNlOw0KDQppbXBvcnQgamF2YS5pby5JT0V4Y2VwdGlvbjsNCmltcG9ydCBq\nYXZhLnV0aWwuQXJyYXlMaXN0Ow0KaW1wb3J0IGphdmEudXRpbC5Db2xsZWN0\naW9uOw0KaW1wb3J0IGphdmEudXRpbC5Db2xsZWN0aW9uczsNCmltcG9ydCBq\nYXZhLnV0aWwuSGFzaE1hcDsNCmltcG9ydCBqYXZhLnV0aWwuSGFzaFNldDsN\nCmltcG9ydCBqYXZhLnV0aWwuSXRlcmF0b3I7DQppbXBvcnQgamF2YS51dGls\nLkxpc3Q7DQppbXBvcnQgamF2YS51dGlsLk1hcDsNCmltcG9ydCBqYXZhLnV0\naWwuU2V0Ow0KDQppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmNvbmYuT3Bl\nbkpQQUNvbmZpZ3VyYXRpb247DQppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLmxpYi5sb2cuTG9nOw0KaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIu\ndXRpbC5CeXRlY29kZVdyaXRlcjsNCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEubGliLnV0aWwuSmF2YVZlcnNpb25zOw0KaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS5saWIudXRpbC5Mb2NhbGl6ZXI7DQppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLmxpYi51dGlsLkxvY2FsaXplci5NZXNzYWdlOw0KaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5tZXRhLkNsYXNzTWV0YURhdGE7DQppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuRmllbGRNZXRhRGF0YTsNCmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YS5KYXZhVHlwZXM7DQppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuR2VuZXJhdGVkQ2xhc3NlczsN\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5JbXBsSGVscGVyOw0K\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLkludGVybmFsRXhjZXB0\naW9uOw0KaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLlVzZXJFeGNl\ncHRpb247DQppbXBvcnQgc2VycC5ieXRlY29kZS5CQ0NsYXNzOw0KDQovKioN\nCiAqIFJlZGVmaW5lcyB0aGUgbWV0aG9kIGJvZGllcyBvZiBleGlzdGluZyB1\nbmVuaGFuY2VkIGNsYXNzZXMgdG8gbWFrZSB0aGVtDQogKiBub3RpZnkgc3Rh\ndGUgbWFuYWdlcnMgb2YgbXV0YXRpb25zLg0KICoNCiAqIEBzaW5jZSAxLjAu\nMA0KICovDQpwdWJsaWMgY2xhc3MgTWFuYWdlZENsYXNzU3ViY2xhc3NlciB7\nDQogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgTG9jYWxpemVyIF9sb2MgPSBM\nb2NhbGl6ZXIuZm9yUGFja2FnZSgNCiAgICAgICAgTWFuYWdlZENsYXNzU3Vi\nY2xhc3Nlci5jbGFzcyk7DQoNCiAgICAvKioNCiAgICAgKiBGb3IgZWFjaCBl\nbGVtZW50IGluIDxjb2RlPmNsYXNzZXM8L2NvZGU+LCBjcmVhdGVzIGFuZCBy\nZWdpc3RlcnMgYQ0KICAgICAqIG5ldyBzdWJjbGFzcyB0aGF0IGltcGxlbWVu\ndHMge0BsaW5rIFBlcnNpc3RlbmNlQ2FwYWJsZX0sIGFuZCBwcmVwYXJlcw0K\nICAgICAqIE9wZW5KUEEgdG8gaGFuZGxlIG5ldyBpbnN0YW5jZXMgb2YgdGhl\nIHVuZW5oYW5jZWQgdHlwZS4gSWYgdGhpcyBpcw0KICAgICAqIGludm9rZWQg\naW4gYSBKYXZhIDYgZW52aXJvbm1lbnQsIHRoaXMgbWV0aG9kIHdpbGwgcmVk\nZWZpbmUgdGhlIG1ldGhvZHMNCiAgICAgKiBmb3IgZWFjaCBjbGFzcyBpbiB0\naGUgYXJndW1lbnQgbGlzdCBzdWNoIHRoYXQgZmllbGQgYWNjZXNzZXMgYXJl\nDQogICAgICogaW50ZXJjZXB0ZWQgaW4tbGluZS4gSWYgaW52b2tlZCBpbiBh\nIEphdmEgNSBlbnZpcm9ubWVudCwgdGhpcw0KICAgICAqIHJlZGVmaW5pdGlv\nbiBpcyBub3QgcG9zc2libGU7IGluIHRoZXNlIGNvbnRleHRzLCB3aGVuIHVz\naW5nIGZpZWxkDQogICAgICogYWNjZXNzLCBPcGVuSlBBIHdpbGwgbmVlZCB0\nbyBkbyBzdGF0ZSBjb21wYXJpc29ucyB0byBkZXRlY3QgYW55IGNoYW5nZQ0K\nICAgICAqIHRvIGFueSBpbnN0YW5jZSBhdCBhbnkgdGltZSwgYW5kIHdoZW4g\ndXNpbmcgcHJvcGVydHkgYWNjZXNzLCBPcGVuSlBBDQogICAgICogd2lsbCBu\nZWVkIHRvIGRvIHN0YXRlIGNvbXBhcmlzb25zIHRvIGRldGVjdCBjaGFuZ2Vz\nIHRvIG5ld2x5IGluc2VydGVkDQogICAgICogaW5zdGFuY2VzIGFmdGVyIGEg\nZmx1c2ggaGFzIGJlZW4gY2FsbGVkLg0KICAgICAqDQogICAgICogQHJldHVy\nbiB0aGUgbmV3IHN1YmNsYXNzZXMsIG9yIDxjb2RlPm51bGw8L2NvZGU+IGlm\nIDxjb2RlPmNsYXNzZXM8L2NvZGU+DQogICAgICogaXMgPGNvZGU+bnVsbDwv\nY29kZT4uDQogICAgICogQHRocm93cyBVc2VyRXhjZXB0aW9uIGlmIDxjb2Rl\nPmNvbmY8L2NvZGU+IHJlcXVpcmVzIGJ1aWxkLXRpbWUNCiAgICAgKiBlbmhh\nbmNlbWVudCBhbmQgPGNvZGU+Y2xhc3NlczwvY29kZT4gaW5jbHVkZXMgdW5l\nbmhhbmNlZCB0eXBlcy4NCiAgICAgKg0KICAgICAqIEBzaW5jZSAxLjAuMA0K\nICAgICAqLw0KICAgIHB1YmxpYyBzdGF0aWMgTGlzdDxDbGFzcz4gcHJlcGFy\nZVVuZW5oYW5jZWRDbGFzc2VzKA0KICAgICAgICBmaW5hbCBPcGVuSlBBQ29u\nZmlndXJhdGlvbiBjb25mLA0KICAgICAgICBmaW5hbCBDb2xsZWN0aW9uPD8g\nZXh0ZW5kcyBDbGFzcz4gY2xhc3NlcywNCiAgICAgICAgZmluYWwgQ2xhc3NM\nb2FkZXIgZW52TG9hZGVyKSB7DQogICAgICAgIGlmIChjbGFzc2VzID09IG51\nbGwpDQogICAgICAgICAgICByZXR1cm4gbnVsbDsNCiAgICAgICAgaWYgKGNs\nYXNzZXMuc2l6ZSgpID09IDApDQogICAgICAgICAgICByZXR1cm4gQ29sbGVj\ndGlvbnMuRU1QVFlfTElTVDsNCg0KICAgICAgICBMb2cgbG9nID0gY29uZi5n\nZXRMb2coT3BlbkpQQUNvbmZpZ3VyYXRpb24uTE9HX0VOSEFOQ0UpOw0KICAg\nICAgICBpZiAoY29uZi5nZXRSdW50aW1lVW5lbmhhbmNlZENsYXNzZXNDb25z\ndGFudCgpDQogICAgICAgICAgICAhPSBSdW50aW1lVW5lbmhhbmNlZENsYXNz\nc2VzTW9kZXMuU1VQUE9SVEVEKSB7DQogICAgICAgICAgICBDb2xsZWN0aW9u\nIHVuZW5oYW5jZWQgPSBuZXcgQXJyYXlMaXN0KCk7DQogICAgICAgICAgICBm\nb3IgKENsYXNzIGNscyA6IGNsYXNzZXMpDQogICAgICAgICAgICAgICAgaWYg\nKCFQZXJzaXN0ZW5jZUNhcGFibGUuY2xhc3MuaXNBc3NpZ25hYmxlRnJvbShj\nbHMpKQ0KICAgICAgICAgICAgICAgICAgICB1bmVuaGFuY2VkLmFkZChjbHMp\nOw0KICAgICAgICAgICAgaWYgKHVuZW5oYW5jZWQuc2l6ZSgpID4gMCkgew0K\nICAgICAgICAgICAgICAgIE1lc3NhZ2UgbXNnID0gX2xvYy5nZXQoInJ1bnRp\nbWUtb3B0aW1pemF0aW9uLWRpc2FibGVkIiwNCiAgICAgICAgICAgICAgICAg\nICAgdW5lbmhhbmNlZCk7DQogICAgICAgICAgICAgICAgaWYgKGNvbmYuZ2V0\nUnVudGltZVVuZW5oYW5jZWRDbGFzc2VzQ29uc3RhbnQoKQ0KICAgICAgICAg\nICAgICAgICAgICA9PSBSdW50aW1lVW5lbmhhbmNlZENsYXNzc2VzTW9kZXMu\nV0FSTikNCiAgICAgICAgICAgICAgICAgICAgbG9nLndhcm4obXNnKTsNCiAg\nICAgICAgICAgICAgICBlbHNlDQogICAgICAgICAgICAgICAgICAgIHRocm93\nIG5ldyBVc2VyRXhjZXB0aW9uKG1zZyk7DQogICAgICAgICAgICB9DQogICAg\nICAgICAgICByZXR1cm4gbnVsbDsNCiAgICAgICAgfQ0KDQogICAgICAgIGJv\nb2xlYW4gcmVkZWZpbmUgPSBDbGFzc1JlZGVmaW5lci5jYW5SZWRlZmluZUNs\nYXNzZXMoKTsNCiAgICAgICAgaWYgKHJlZGVmaW5lKQ0KICAgICAgICAgICAg\nbG9nLmluZm8oX2xvYy5nZXQoImVuaGFuY2UtYW5kLXN1YmNsYXNzLW5vLXJl\nZGVmLXN0YXJ0IiwNCiAgICAgICAgICAgICAgICBjbGFzc2VzKSk7DQogICAg\nICAgIGVsc2UNCiAgICAgICAgICAgIGxvZy5pbmZvKF9sb2MuZ2V0KCJlbmhh\nbmNlLWFuZC1zdWJjbGFzcy1hbmQtcmVkZWYtc3RhcnQiLA0KICAgICAgICAg\nICAgICAgIGNsYXNzZXMpKTsNCg0KICAgICAgICBmaW5hbCBNYXA8Q2xhc3Ms\nIGJ5dGVbXT4gbWFwID0gbmV3IEhhc2hNYXA8Q2xhc3MsIGJ5dGVbXT4oKTsN\nCiAgICAgICAgZmluYWwgTGlzdCBzdWJzID0gbmV3IEFycmF5TGlzdChjbGFz\nc2VzLnNpemUoKSk7DQogICAgICAgIGZpbmFsIExpc3QgaW50cyA9IG5ldyBB\ncnJheUxpc3QoY2xhc3Nlcy5zaXplKCkpOw0KICAgICAgICBTZXQ8Q2xhc3M+\nIHVuc3BlY2lmaWVkID0gbnVsbDsNCiAgICAgICAgZm9yIChJdGVyYXRvciBp\ndGVyID0gY2xhc3Nlcy5pdGVyYXRvcigpOyBpdGVyLmhhc05leHQoKTsgKSB7\nDQogICAgICAgICAgICBmaW5hbCBDbGFzcyBjbHMgPSAoQ2xhc3MpIGl0ZXIu\nbmV4dCgpOw0KICAgICAgICAgICAgZmluYWwgUENFbmhhbmNlciBlbmhhbmNl\nciA9IG5ldyBQQ0VuaGFuY2VyKGNvbmYsIGNscyk7DQoNCiAgICAgICAgICAg\nIGVuaGFuY2VyLnNldEJ5dGVjb2RlV3JpdGVyKG5ldyBCeXRlY29kZVdyaXRl\ncigpIHsNCiAgICAgICAgICAgICAgICBwdWJsaWMgdm9pZCB3cml0ZShCQ0Ns\nYXNzIGJjKSB0aHJvd3MgSU9FeGNlcHRpb24gew0KICAgICAgICAgICAgICAg\nICAgICBNYW5hZ2VkQ2xhc3NTdWJjbGFzc2VyLndyaXRlKGJjLCBlbmhhbmNl\nciwgbWFwLA0KICAgICAgICAgICAgICAgICAgICAgICAgY2xzLCBzdWJzLCBp\nbnRzKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9KTsNCiAg\nICAgICAgICAgIGlmIChyZWRlZmluZSkNCiAgICAgICAgICAgICAgICBlbmhh\nbmNlci5zZXRSZWRlZmluZSh0cnVlKTsNCiAgICAgICAgICAgIGVuaGFuY2Vy\nLnNldENyZWF0ZVN1YmNsYXNzKHRydWUpOw0KICAgICAgICAgICAgZW5oYW5j\nZXIuc2V0QWRkRGVmYXVsdENvbnN0cnVjdG9yKHRydWUpOw0KDQogICAgICAg\nICAgICAvLyBzZXQgdGhpcyBiZWZvcmUgZW5oYW5jZW1lbnQgYXMgd2VsbCBh\ncyBhZnRlciBzaW5jZSBlbmhhbmNlbWVudA0KICAgICAgICAgICAgLy8gdXNl\ncyBhIGRpZmZlcmVudCBtZXRhZGF0YSByZXBvc2l0b3J5LCBhbmQgdGhlIG1l\ndGFkYXRhIGNvbmZpZw0KICAgICAgICAgICAgLy8gbWF0dGVycyBpbiB0aGUg\nZW5oYW5jZW1lbnQgY29udHJhY3QuIERvbid0IGRvIGFueSB3YXJuaW5nIGhl\ncmUsDQogICAgICAgICAgICAvLyBzaW5jZSB3ZSdsbCBpc3N1ZSB3YXJuaW5n\ncyB3aGVuIHdlIGRvIHRoZSBmaW5hbCBtZXRhZGF0YQ0KICAgICAgICAgICAg\nLy8gcmVjb25maWd1cmF0aW9uIGF0IHRoZSBlbmQgb2YgdGhpcyBtZXRob2Qu\nDQogICAgICAgICAgICBjb25maWd1cmVNZXRhRGF0YShlbmhhbmNlci5nZXRN\nZXRhRGF0YSgpLCBjb25mLCByZWRlZmluZSwgZmFsc2UpOw0KDQogICAgICAg\nICAgICB1bnNwZWNpZmllZCA9IGNvbGxlY3RSZWxhdGVkVW5zcGVjaWZpZWRU\neXBlcyhlbmhhbmNlci5nZXRNZXRhRGF0YSgpLA0KICAgICAgICAgICAgICAg\nIGNsYXNzZXMsIHVuc3BlY2lmaWVkKTsNCg0KICAgICAgICAgICAgZW5oYW5j\nZXIucnVuKCk7DQogICAgICAgICAgICB0cnkgew0KICAgICAgICAgICAgICAg\nIGVuaGFuY2VyLnJlY29yZCgpOw0KICAgICAgICAgICAgfSBjYXRjaCAoSU9F\neGNlcHRpb24gZSkgew0KICAgICAgICAgICAgICAgIC8vIG91ciBpbXBsIG9m\nIEJ5dGVjb2RlV3JpdGVyIGRvZXNuJ3QgdGhyb3cgSU9FeGNlcHRpb24NCiAg\nICAgICAgICAgICAgICB0aHJvdyBuZXcgSW50ZXJuYWxFeGNlcHRpb24oZSk7\nDQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICBpZiAodW5z\ncGVjaWZpZWQgIT0gbnVsbCAmJiAhdW5zcGVjaWZpZWQuaXNFbXB0eSgpKQ0K\nICAgICAgICAgICAgdGhyb3cgbmV3IFVzZXJFeGNlcHRpb24oX2xvYy5nZXQo\nInVuc3BlY2lmaWVkLXVuZW5oYW5jZWQtdHlwZXMiLA0KICAgICAgICAgICAg\nICAgIGNsYXNzZXMsIHVuc3BlY2lmaWVkKSk7DQoNCiAgICAgICAgQ2xhc3NS\nZWRlZmluZXIucmVkZWZpbmVDbGFzc2VzKGNvbmYsIG1hcCk7DQogICAgICAg\nIGZvciAoQ2xhc3MgY2xzIDogbWFwLmtleVNldCgpKSB7DQogICAgICAgICAg\nICBzZXRJbnRlcmNlcHRpbmcoY29uZiwgZW52TG9hZGVyLCBjbHMpOw0KICAg\nICAgICAgICAgY29uZmlndXJlTWV0YURhdGEoY29uZiwgZW52TG9hZGVyLCBj\nbHMsIHJlZGVmaW5lKTsNCiAgICAgICAgfQ0KICAgICAgICBmb3IgKENsYXNz\nIGNscyA6IChDb2xsZWN0aW9uPENsYXNzPikgc3VicykNCiAgICAgICAgICAg\nIGNvbmZpZ3VyZU1ldGFEYXRhKGNvbmYsIGVudkxvYWRlciwgY2xzLCByZWRl\nZmluZSk7DQogICAgICAgIGZvciAoQ2xhc3MgY2xzIDogKENvbGxlY3Rpb248\nQ2xhc3M+KSBpbnRzKQ0KICAgICAgICAgICAgc2V0SW50ZXJjZXB0aW5nKGNv\nbmYsIGVudkxvYWRlciwgY2xzKTsNCg0KICAgICAgICByZXR1cm4gc3ViczsN\nCiAgICB9DQoNCiAgICBwcml2YXRlIHN0YXRpYyBTZXQ8Q2xhc3M+IGNvbGxl\nY3RSZWxhdGVkVW5zcGVjaWZpZWRUeXBlcyhDbGFzc01ldGFEYXRhIG1ldGEs\nDQogICAgICAgIENvbGxlY3Rpb248PyBleHRlbmRzIENsYXNzPiBjbGFzc2Vz\nLCBTZXQ8Q2xhc3M+IHVuc3BlY2lmaWVkKSB7DQogICAgICAgIHVuc3BlY2lm\naWVkID0gY29sbGVjdFVuc3BlY2lmaWVkVHlwZShtZXRhLmdldFBDU3VwZXJj\nbGFzcygpLCBjbGFzc2VzLA0KICAgICAgICAgICAgdW5zcGVjaWZpZWQpOw0K\nDQogICAgICAgIGZvciAoRmllbGRNZXRhRGF0YSBmbWQgOiBtZXRhLmdldEZp\nZWxkcygpKSB7DQogICAgICAgICAgICBpZiAoZm1kLmlzVHJhbnNpZW50KCkp\nDQogICAgICAgICAgICAgICAgY29udGludWU7DQogICAgICAgICAgICBpZiAo\nZm1kLmlzVHlwZVBDKCkpDQogICAgICAgICAgICAgICAgdW5zcGVjaWZpZWQg\nPSBjb2xsZWN0VW5zcGVjaWZpZWRUeXBlKGZtZC5nZXRUeXBlKCksIGNsYXNz\nZXMsDQogICAgICAgICAgICAgICAgICAgIHVuc3BlY2lmaWVkKTsNCiAgICAg\nICAgICAgIGlmIChmbWQuZ2V0RWxlbWVudCgpICE9IG51bGwgJiYgZm1kLmdl\ndEVsZW1lbnQoKS5pc1R5cGVQQygpKQ0KICAgICAgICAgICAgICAgIHVuc3Bl\nY2lmaWVkID0gY29sbGVjdFVuc3BlY2lmaWVkVHlwZShmbWQuZ2V0RWxlbWVu\ndCgpLmdldFR5cGUoKSwNCiAgICAgICAgICAgICAgICAgICAgY2xhc3Nlcywg\ndW5zcGVjaWZpZWQpOw0KICAgICAgICAgICAgaWYgKGZtZC5nZXRLZXkoKSAh\nPSBudWxsICYmIGZtZC5nZXRLZXkoKS5pc1R5cGVQQygpKQ0KICAgICAgICAg\nICAgICAgIHVuc3BlY2lmaWVkID0gY29sbGVjdFVuc3BlY2lmaWVkVHlwZShm\nbWQuZ2V0S2V5KCkuZ2V0VHlwZSgpLA0KICAgICAgICAgICAgICAgICAgICBj\nbGFzc2VzLCB1bnNwZWNpZmllZCk7DQogICAgICAgICAgICBpZiAoZm1kLmdl\ndFZhbHVlKCkgIT0gbnVsbCAmJiBmbWQuZ2V0VmFsdWUoKS5pc1R5cGVQQygp\nKQ0KICAgICAgICAgICAgICAgIHVuc3BlY2lmaWVkID0gY29sbGVjdFVuc3Bl\nY2lmaWVkVHlwZShmbWQuZ2V0VmFsdWUoKS5nZXRUeXBlKCksDQogICAgICAg\nICAgICAgICAgICAgIGNsYXNzZXMsIHVuc3BlY2lmaWVkKTsNCiAgICAgICAg\nfQ0KICAgICAgICByZXR1cm4gdW5zcGVjaWZpZWQ7DQogICAgfQ0KDQogICAg\ncHJpdmF0ZSBzdGF0aWMgU2V0PENsYXNzPiBjb2xsZWN0VW5zcGVjaWZpZWRU\neXBlKENsYXNzIGNscywNCiAgICAgICAgQ29sbGVjdGlvbjw/IGV4dGVuZHMg\nQ2xhc3M+IGNsYXNzZXMsIFNldDxDbGFzcz4gdW5zcGVjaWZpZWQpIHsNCiAg\nICAgICAgaWYgKGNscyAhPSBudWxsICYmICFjbGFzc2VzLmNvbnRhaW5zKGNs\ncykNCiAgICAgICAgICAgICYmICFJbXBsSGVscGVyLmlzTWFuYWdlZFR5cGUo\nbnVsbCwgY2xzKSkgew0KICAgICAgICAgICAgaWYgKHVuc3BlY2lmaWVkID09\nIG51bGwpDQogICAgICAgICAgICAgICAgdW5zcGVjaWZpZWQgPSBuZXcgSGFz\naFNldDxDbGFzcz4oKTsNCiAgICAgICAgICAgIHVuc3BlY2lmaWVkLmFkZChj\nbHMpOw0KICAgICAgICB9DQogICAgICAgIHJldHVybiB1bnNwZWNpZmllZDsN\nCiAgICB9DQoNCiAgICBwcml2YXRlIHN0YXRpYyB2b2lkIGNvbmZpZ3VyZU1l\ndGFEYXRhKE9wZW5KUEFDb25maWd1cmF0aW9uIGNvbmYsDQogICAgICAgIENs\nYXNzTG9hZGVyIGVudkxvYWRlciwgQ2xhc3MgY2xzLCBib29sZWFuIHJlZGVm\naW5lQXZhaWxhYmxlKSB7DQogICAgICAgIENsYXNzTWV0YURhdGEgbWV0YSA9\nIGNvbmYuZ2V0TWV0YURhdGFSZXBvc2l0b3J5SW5zdGFuY2UoKQ0KICAgICAg\nICAgICAgLmdldE1ldGFEYXRhKGNscywgZW52TG9hZGVyLCB0cnVlKTsNCiAg\nICAgICAgY29uZmlndXJlTWV0YURhdGEobWV0YSwgY29uZiwgcmVkZWZpbmVB\ndmFpbGFibGUsIHRydWUpOw0KICAgIH0NCg0KICAgIHByaXZhdGUgc3RhdGlj\nIHZvaWQgY29uZmlndXJlTWV0YURhdGEoQ2xhc3NNZXRhRGF0YSBtZXRhLA0K\nICAgICAgICBPcGVuSlBBQ29uZmlndXJhdGlvbiBjb25mLCBib29sZWFuIHJl\nZGVmaW5lQXZhaWxhYmxlLCBib29sZWFuIHdhcm4pIHsNCg0KICAgICAgICBz\nZXREZXRhY2hlZFN0YXRlKG1ldGEpOw0KDQogICAgICAgIGlmICh3YXJuICYm\nIG1ldGEuZ2V0QWNjZXNzVHlwZSgpID09IENsYXNzTWV0YURhdGEuQUNDRVNT\nX0ZJRUxEDQogICAgICAgICAgICAmJiAhcmVkZWZpbmVBdmFpbGFibGUpIHsN\nCiAgICAgICAgICAgIC8vIG9ubHkgd2FybiBhYm91dCBkZWNsYXJlZCBmaWVs\nZHM7IHN1cGVyY2xhc3MgZmllbGRzIHdpbGwgYmUNCiAgICAgICAgICAgIC8v\nIHdhcm5lZCBhYm91dCB3aGVuIHRoZSBzdXBlcmNsYXNzIGlzIGhhbmRsZWQN\nCiAgICAgICAgICAgIGZvciAoRmllbGRNZXRhRGF0YSBmbWQgOiBtZXRhLmdl\ndERlY2xhcmVkRmllbGRzKCkpIHsNCiAgICAgICAgICAgICAgICBzd2l0Y2gg\nKGZtZC5nZXRUeXBlQ29kZSgpKSB7DQogICAgICAgICAgICAgICAgICAgIGNh\nc2UgSmF2YVR5cGVzLkNPTExFQ1RJT046DQogICAgICAgICAgICAgICAgICAg\nIGNhc2UgSmF2YVR5cGVzLk1BUDoNCiAgICAgICAgICAgICAgICAgICAgICAg\nIC8vIHdlIGNhbiBsYXppbHkgbG9hZCB0aGVzZSwgc2luY2Ugd2Ugb3duIHRo\nZQ0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gcmVsYXRpb25zaGlwIGNv\nbnRhaW5lcg0KICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAg\nICAgICAgICAgICAgICAgIGRlZmF1bHQ6DQogICAgICAgICAgICAgICAgICAg\nICAgICBpZiAoIWZtZC5pc0luRGVmYXVsdEZldGNoR3JvdXAoKQ0KICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICYmICEoZm1kLmlzVmVyc2lvbigpIHx8\nIGZtZC5pc1ByaW1hcnlLZXkoKSkpIHsNCiAgICAgICAgICAgICAgICAgICAg\nICAgICAgICBMb2cgbG9nID0gY29uZi5nZXRMb2coDQogICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgIE9wZW5KUEFDb25maWd1cmF0aW9uLkxPR19F\nTkhBTkNFKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2cud2Fy\nbihfbG9jLmdldCgic3ViY2xhc3Nlci1mZXRjaC1ncm91cC1vdmVycmlkZSIs\nDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1ldGEuZ2V0RGVz\nY3JpYmVkVHlwZSgpLmdldE5hbWUoKSwNCiAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgZm1kLmdldE5hbWUoKSkpOw0KICAgICAgICAgICAgICAg\nICAgICAgICAgICAgIGZtZC5zZXRJbkRlZmF1bHRGZXRjaEdyb3VwKHRydWUp\nOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAg\nIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIHBy\naXZhdGUgc3RhdGljIHZvaWQgd3JpdGUoQkNDbGFzcyBiYywgUENFbmhhbmNl\nciBlbmhhbmNlciwNCiAgICAgICAgTWFwPENsYXNzLCBieXRlW10+IG1hcCwg\nQ2xhc3MgY2xzLCBMaXN0IHN1YnMsIExpc3QgaW50cykNCiAgICAgICAgdGhy\nb3dzIElPRXhjZXB0aW9uIHsNCg0KICAgICAgICBpZiAoYmMgPT0gZW5oYW5j\nZXIuZ2V0TWFuYWdlZFR5cGVCeXRlY29kZSgpKSB7DQogICAgICAgICAgICAv\nLyBpZiBpdCB3YXMgYWxyZWFkeSBkZWZpbmVkLCBkb24ndCBwdXQgaXQgaW4g\ndGhlIG1hcCwNCiAgICAgICAgICAgIC8vIGJ1dCBkbyBzZXQgdGhlIG1ldGFk\nYXRhIGFjY29yZGluZ2x5Lg0KICAgICAgICAgICAgaWYgKGVuaGFuY2VyLmlz\nQWxyZWFkeVJlZGVmaW5lZCgpKQ0KICAgICAgICAgICAgICAgIGludHMuYWRk\nKGJjLmdldFR5cGUoKSk7DQogICAgICAgICAgICBlbHNlIGlmIChKYXZhVmVy\nc2lvbnMuVkVSU0lPTiA+PSA1KQ0KICAgICAgICAgICAgICAgIG1hcC5wdXQo\nYmMuZ2V0VHlwZSgpLCBiYy50b0J5dGVBcnJheSgpKTsNCiAgICAgICAgfSBl\nbHNlIHsNCiAgICAgICAgICAgIGlmICghZW5oYW5jZXIuaXNBbHJlYWR5U3Vi\nY2xhc3NlZCgpKSB7DQogICAgICAgICAgICAgICAgLy8gdGhpcyBpcyB0aGUg\nbmV3IHN1YmNsYXNzDQogICAgICAgICAgICAgICAgQ2xhc3NMb2FkZXIgbG9h\nZGVyID0gR2VuZXJhdGVkQ2xhc3Nlcy5nZXRNb3N0RGVyaXZlZExvYWRlcigN\nCiAgICAgICAgICAgICAgICAgICAgY2xzLCBQZXJzaXN0ZW5jZUNhcGFibGUu\nY2xhc3MpOw0KICAgICAgICAgICAgICAgIHN1YnMuYWRkKEdlbmVyYXRlZENs\nYXNzZXMubG9hZEJDQ2xhc3MoYmMsIGxvYWRlcikpOw0KICAgICAgICAgICAg\nfQ0KICAgICAgICB9DQogICAgfQ0KDQogICAgcHJpdmF0ZSBzdGF0aWMgdm9p\nZCBzZXRJbnRlcmNlcHRpbmcoT3BlbkpQQUNvbmZpZ3VyYXRpb24gY29uZiwN\nCiAgICAgICAgQ2xhc3NMb2FkZXIgZW52TG9hZGVyLCBDbGFzcyBjbHMpIHsN\nCiAgICAgICAgQ2xhc3NNZXRhRGF0YSBtZXRhID0gY29uZi5nZXRNZXRhRGF0\nYVJlcG9zaXRvcnlJbnN0YW5jZSgpDQogICAgICAgICAgICAuZ2V0TWV0YURh\ndGEoY2xzLCBlbnZMb2FkZXIsIHRydWUpOw0KICAgICAgICBtZXRhLnNldElu\ndGVyY2VwdGluZyh0cnVlKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiBJ\nZiB0aGUgbWV0YWRhdGEgaXMgY29uZmlndXJlZCB0byB1c2UgYSBzeW50aGV0\naWMNCiAgICAgKiBkZXRhY2hlZCBzdGF0ZSwgcmVzZXQgaXQgdG8gbm90IHVz\nZSBhIGRldGFjaGVkDQogICAgICogc3RhdGUgZmllbGQsIHNpbmNlIHdlIGNh\nbid0IGFkZCBmaWVsZHMgd2hlbiByZWRlZmluaW5nLg0KICAgICAqLw0KICAg\nIHByaXZhdGUgc3RhdGljIHZvaWQgc2V0RGV0YWNoZWRTdGF0ZShDbGFzc01l\ndGFEYXRhIG1ldGEpIHsNCiAgICAgICAgaWYgKENsYXNzTWV0YURhdGEuU1lO\nVEhFVElDLmVxdWFscyhtZXRhLmdldERldGFjaGVkU3RhdGUoKSkpDQogICAg\nICAgICAgICBtZXRhLnNldERldGFjaGVkU3RhdGUobnVsbCk7DQogICAgfQ0K\nfQ0K\n","encoding":"base64"}

