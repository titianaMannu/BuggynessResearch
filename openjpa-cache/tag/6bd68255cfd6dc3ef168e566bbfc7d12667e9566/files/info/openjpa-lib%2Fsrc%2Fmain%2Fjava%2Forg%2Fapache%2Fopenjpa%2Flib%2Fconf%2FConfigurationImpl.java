{"sha":"bbf651e8bf65de1f1ded5b8965467c76ac6c0e25","node_id":"MDQ6QmxvYjIwNjM2NDpiYmY2NTFlOGJmNjVkZTFmMWRlZDViODk2NTQ2N2M3NmFjNmMwZTI1","size":34626,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/bbf651e8bf65de1f1ded5b8965467c76ac6c0e25","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEubGliLmNvbmY7CgppbXBvcnQg\namF2YS5hd3QuSW1hZ2U7CmltcG9ydCBqYXZhLmJlYW5zLkJlYW5EZXNjcmlw\ndG9yOwppbXBvcnQgamF2YS5iZWFucy5CZWFuSW5mbzsKaW1wb3J0IGphdmEu\nYmVhbnMuRXZlbnRTZXREZXNjcmlwdG9yOwppbXBvcnQgamF2YS5iZWFucy5J\nbnRyb3NwZWN0aW9uRXhjZXB0aW9uOwppbXBvcnQgamF2YS5iZWFucy5JbnRy\nb3NwZWN0b3I7CmltcG9ydCBqYXZhLmJlYW5zLk1ldGhvZERlc2NyaXB0b3I7\nCmltcG9ydCBqYXZhLmJlYW5zLlByb3BlcnR5Q2hhbmdlTGlzdGVuZXI7Cmlt\ncG9ydCBqYXZhLmJlYW5zLlByb3BlcnR5Q2hhbmdlU3VwcG9ydDsKaW1wb3J0\nIGphdmEuYmVhbnMuUHJvcGVydHlEZXNjcmlwdG9yOwppbXBvcnQgamF2YS5p\nby5FeHRlcm5hbGl6YWJsZTsKaW1wb3J0IGphdmEuaW8uRmlsZTsKaW1wb3J0\nIGphdmEuaW8uSU9FeGNlcHRpb247CmltcG9ydCBqYXZhLmlvLk9iamVjdElu\ncHV0OwppbXBvcnQgamF2YS5pby5PYmplY3RPdXRwdXQ7CmltcG9ydCBqYXZh\nLmlvLlByaW50V3JpdGVyOwppbXBvcnQgamF2YS5pby5TZXJpYWxpemFibGU7\nCmltcG9ydCBqYXZhLmlvLlN0cmluZ1dyaXRlcjsKaW1wb3J0IGphdmEubGFu\nZy5yZWZsZWN0LkNvbnN0cnVjdG9yOwppbXBvcnQgamF2YS5sYW5nLnJlZmxl\nY3QuSW52b2NhdGlvblRhcmdldEV4Y2VwdGlvbjsKaW1wb3J0IGphdmEubGFu\nZy5yZWZsZWN0Lk1ldGhvZDsKaW1wb3J0IGphdmEuc2VjdXJpdHkuQWNjZXNz\nQ29udHJvbGxlcjsKaW1wb3J0IGphdmEuc2VjdXJpdHkuUHJpdmlsZWdlZEFj\ndGlvbjsKaW1wb3J0IGphdmEudXRpbC5BcnJheUxpc3Q7CmltcG9ydCBqYXZh\nLnV0aWwuQXJyYXlzOwppbXBvcnQgamF2YS51dGlsLkNvbGxlY3Rpb247Cmlt\ncG9ydCBqYXZhLnV0aWwuQ29sbGVjdGlvbnM7CmltcG9ydCBqYXZhLnV0aWwu\nSGFzaE1hcDsKaW1wb3J0IGphdmEudXRpbC5JdGVyYXRvcjsKaW1wb3J0IGph\ndmEudXRpbC5MaXN0OwppbXBvcnQgamF2YS51dGlsLk1hcDsKaW1wb3J0IGph\ndmEudXRpbC5NaXNzaW5nUmVzb3VyY2VFeGNlcHRpb247CmltcG9ydCBqYXZh\nLnV0aWwuUHJvcGVydGllczsKaW1wb3J0IGphdmEudXRpbC5UcmVlU2V0OwoK\naW1wb3J0IG9yZy5hcGFjaGUuY29tbW9ucy5sYW5nLlN0cmluZ1V0aWxzOwpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi5sb2cuTG9nOwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLmxpYi5sb2cuTG9nRmFjdG9yeTsKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5saWIubG9nLkxvZ0ZhY3RvcnlJbXBsOwpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi5sb2cuTm9uZUxvZ0ZhY3Rv\ncnk7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuQ2xvc2Vh\nYmxlOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51dGlsLkoyRG9Q\ncml2SGVscGVyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51dGls\nLkxvY2FsaXplcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIudXRp\nbC5NdWx0aUNsYXNzTG9hZGVyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLmxpYi51dGlsLlBhcnNlRXhjZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLmxpYi51dGlsLlNlcnZpY2VzOwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLmxpYi51dGlsLlN0cmluZ0Rpc3RhbmNlOwppbXBvcnQgc2VycC51\ndGlsLlN0cmluZ3M7CgovKioKICogRGVmYXVsdCBpbXBsZW1lbnRhdGlvbiBv\nZiB0aGUge0BsaW5rIENvbmZpZ3VyYXRpb259IGludGVyZmFjZS4KICogU3Vi\nY2xhc3NlcyBjYW4gY2hvb3NlIHRvIG9idGFpbiBjb25maWd1cmF0aW9uCiAq\nIGluZm9ybWF0aW9uIGZyb20gSk5ESSwgUHJvcGVydGllcywgYSBCZWFuLWJ1\naWxkZXIsIGV0Yy4gVGhpcyBjbGFzcwogKiBwcm92aWRlcyBiYXNlIGNvbmZp\nZ3VyYXRpb24gZnVuY3Rpb25hbGl0eSwgaW5jbHVkaW5nIHNlcmlhbGl6YXRp\nb24sCiAqIHRoZSA8Y29kZT5lcXVhbHM8L2NvZGU+IGFuZCA8Y29kZT5oYXNo\nQ29kZTwvY29kZT4gY29udHJhY3RzLCBhbmQgZGVmYXVsdAogKiBwcm9wZXJ0\neSBsb2FkaW5nLgogKiBQcm9wZXJ0eSBkZXNjcmlwdG9ycyBmb3Ige0BsaW5r\nIFZhbHVlfSBpbnN0YW5jZXMgYXJlIGNvbnN0cnVjdGVkIGZyb20KICogdGhl\nIHtAbGluayBMb2NhbGl6ZXJ9IGZvciB0aGUgcGFja2FnZSBvZiB0aGUgY29u\nZmlndXJhdGlvbiBjbGFzcy4gVGhlCiAqIGZvbGxvd2luZyBsb2NhbGl6ZWQg\nc3RyaW5ncyB3aWxsIGJlIHVzZWQgZm9yIGRlc2NyaWJpbmcgYSB2YWx1ZSwg\nd2hlcmUKICogPGVtPm5hbWU8L2VtPiBpcyB0aGUgbGFzdCB0b2tlbiBvZiB0\naGUgdmFsdWUncyBwcm9wZXJ0eSBzdHJpbmc6CiAqIDx1bD4KICogPGxpPjxl\nbT5uYW1lPC9lbT4tbmFtZTogVGhlIG5hbWUgdGhhdCB3aWxsIGJlIGRpc3Bs\nYXllZCBmb3IgdGhlCiAqIG9wdGlvbiBpbiBhIHVzZXIgaW50ZXJmYWNlOyBy\nZXF1aXJlZC48L2xpPgogKiA8bGk+PGVtPm5hbWU8L2VtPi1kZXNjOiBBIGJy\naWVmIGRlc2NyaXB0aW9uIG9mIHRoZSBvcHRpb247IHJlcXVpcmVkLjwvbGk+\nCiAqIDxsaT48ZW0+bmFtZTwvZW0+LXR5cGU6IFRoZSB0eXBlIG9yIGNhdGVn\nb3J5IG5hbWUgZm9yIHRoaXMgb3B0aW9uOwogKiByZXF1aXJlZC48L2xpPgog\nKiA8bGk+PGVtPm5hbWU8L2VtPi1leHBlcnQ6IFRydWUgaWYgdGhpcyBpcyBh\nbiBleHBlcnQgb3B0aW9uLCBmYWxzZQogKiBvdGhlcndpc2U7IGRlZmF1bHRz\nIHRvIGZhbHNlLjwvbGk+CiAqIDxsaT48ZW0+bmFtZTwvZW0+LXZhbHVlczog\nU2V0IG9mIGV4cGVjdGVkIG9yIGNvbW1vbiB2YWx1ZXMsIGV4Y2x1ZGluZwog\nKiBhbGlhcyBrZXlzOyBvcHRpb25hbC48L2xpPgogKiA8bGk+PGVtPm5hbWU8\nL2VtPi1pbnRlcmZhY2U6IFRoZSBjbGFzcyBuYW1lIG9mIGFuIGludGVyZmFj\nZSB3aG9zZQogKiBkaXNjb3ZlcmFibGUgaW1wbGVtZW50YXRpb25zIHNob3Vs\nZCBiZSBpbmNsdWRlZCBpbiB0aGUgc2V0IG9mIGV4cGVjdGVkCiAqIG9yIGNv\nbW1vbiB2YWx1ZXM7IG9wdGlvbmFsLjwvbGk+CiAqIDxsaT48ZW0+bmFtZTwv\nZW0+LWNhdDogVGhlIGhpZXJhcmNoaWNhbCBjYXRlZ29yeSBmb3IgdGhlIHBy\nb3BlcnR5CiAqIG5hbWUsIHNlcGFyYXRlZCBieSAiLiIuCiAqIDxsaT48ZW0+\nbmFtZTwvZW0+LWRpc3BsYXlvcmRlcjogVGhlIG9yZGVyIGluIHdoaWNoIHRo\nZSBwcm9wZXJ0eSBzaG91bGQKICogYmUgZGlzcGxheWVyLjwvbGk+CiAqIDwv\ndWw+CiAqCiAqIEBhdXRob3IgQWJlIFdoaXRlCiAqLwpwdWJsaWMgY2xhc3Mg\nQ29uZmlndXJhdGlvbkltcGwKICAgIGltcGxlbWVudHMgQ29uZmlndXJhdGlv\nbiwgRXh0ZXJuYWxpemFibGUsIFZhbHVlTGlzdGVuZXIgewoKICAgIHByaXZh\ndGUgc3RhdGljIGZpbmFsIFN0cmluZyBTRVAgPSBKMkRvUHJpdkhlbHBlci5n\nZXRMaW5lU2VwYXJhdG9yKCk7CgogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwg\nTG9jYWxpemVyIF9sb2MgPSBMb2NhbGl6ZXIuZm9yUGFja2FnZQogICAgICAg\nIChDb25maWd1cmF0aW9uSW1wbC5jbGFzcyk7CgogICAgcHVibGljIE9iamVj\ndFZhbHVlIGxvZ0ZhY3RvcnlQbHVnaW47CiAgICBwdWJsaWMgU3RyaW5nVmFs\ndWUgaWQ7CgogICAgcHJpdmF0ZSBTdHJpbmcgX3Byb2R1Y3QgPSBudWxsOwog\nICAgcHJpdmF0ZSBib29sZWFuIF9yZWFkT25seSA9IGZhbHNlOwogICAgcHJp\ndmF0ZSBNYXAgX3Byb3BzID0gbnVsbDsKICAgIHByaXZhdGUgYm9vbGVhbiBf\nZ2xvYmFscyA9IGZhbHNlOwogICAgcHJpdmF0ZSBTdHJpbmcgX2F1dG8gPSBu\ndWxsOwogICAgcHJpdmF0ZSBmaW5hbCBMaXN0IF92YWxzID0gbmV3IEFycmF5\nTGlzdCgpOwoKICAgIC8vIHByb3BlcnR5IGxpc3RlbmVyIGhlbHBlcgogICAg\ncHJpdmF0ZSBQcm9wZXJ0eUNoYW5nZVN1cHBvcnQgX2NoYW5nZVN1cHBvcnQg\nPSBudWxsOwoKICAgIC8vIGNhY2hlIGRlc2NyaXB0b3JzCiAgICBwcml2YXRl\nIFByb3BlcnR5RGVzY3JpcHRvcltdIF9wZHMgPSBudWxsOwogICAgcHJpdmF0\nZSBNZXRob2REZXNjcmlwdG9yW10gX21kcyA9IG51bGw7CgogICAgLyoqCiAg\nICAgKiBEZWZhdWx0IGNvbnN0cnVjdG9yLiBBdHRlbXB0cyB0byBsb2FkIGRl\nZmF1bHQgcHJvcGVydGllcyB0aHJvdWdoCiAgICAgKiBzeXN0ZW0ncyBjb25m\naWd1cmVkIHtAbGluayBQcm9kdWN0RGVyaXZhdGlvbn1zLgogICAgICovCiAg\nICBwdWJsaWMgQ29uZmlndXJhdGlvbkltcGwoKSB7CiAgICAgICAgdGhpcyh0\ncnVlKTsKICAgIH0KCiAgICAvKioKICAgICAqIENvbnN0cnVjdG9yLgogICAg\nICoKICAgICAqIEBwYXJhbSBsb2FkR2xvYmFscyB3aGV0aGVyIHRvIGF0dGVt\ncHQgdG8gbG9hZCB0aGUgZ2xvYmFsIHByb3BlcnRpZXMKICAgICAqLwogICAg\ncHVibGljIENvbmZpZ3VyYXRpb25JbXBsKGJvb2xlYW4gbG9hZEdsb2JhbHMp\nIHsKICAgICAgICBzZXRQcm9kdWN0TmFtZSgib3BlbmpwYSIpOwoKICAgICAg\nICBsb2dGYWN0b3J5UGx1Z2luID0gYWRkUGx1Z2luKCJMb2ciLCB0cnVlKTsK\nICAgICAgICBTdHJpbmdbXSBhbGlhc2VzID0gbmV3IFN0cmluZ1tdewogICAg\nICAgICAgICAidHJ1ZSIsIExvZ0ZhY3RvcnlJbXBsLmNsYXNzLmdldE5hbWUo\nKSwKICAgICAgICAgICAgIm9wZW5qcGEiLCBMb2dGYWN0b3J5SW1wbC5jbGFz\ncy5nZXROYW1lKCksCiAgICAgICAgICAgICJjb21tb25zIiwgIm9yZy5hcGFj\naGUub3BlbmpwYS5saWIubG9nLkNvbW1vbnNMb2dGYWN0b3J5IiwKICAgICAg\nICAgICAgImxvZzRqIiwgIm9yZy5hcGFjaGUub3BlbmpwYS5saWIubG9nLkxv\nZzRKTG9nRmFjdG9yeSIsCiAgICAgICAgICAgICJub25lIiwgTm9uZUxvZ0Zh\nY3RvcnkuY2xhc3MuZ2V0TmFtZSgpLAogICAgICAgICAgICAiZmFsc2UiLCBO\nb25lTG9nRmFjdG9yeS5jbGFzcy5nZXROYW1lKCksCiAgICAgICAgfTsKICAg\nICAgICBsb2dGYWN0b3J5UGx1Z2luLnNldEFsaWFzZXMoYWxpYXNlcyk7CiAg\nICAgICAgbG9nRmFjdG9yeVBsdWdpbi5zZXREZWZhdWx0KGFsaWFzZXNbMF0p\nOwogICAgICAgIGxvZ0ZhY3RvcnlQbHVnaW4uc2V0U3RyaW5nKGFsaWFzZXNb\nMF0pOwogICAgICAgIGxvZ0ZhY3RvcnlQbHVnaW4uc2V0SW5zdGFudGlhdGlu\nZ0dldHRlcigiZ2V0TG9nRmFjdG9yeSIpOwoKICAgICAgICBpZCA9IGFkZFN0\ncmluZygiSWQiKTsKICAgICAgICAKICAgICAgICBpZiAobG9hZEdsb2JhbHMp\nCiAgICAgICAgICAgIGxvYWRHbG9iYWxzKCk7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBBdXRvbWF0aWNhbGx5IGxvYWQgZ2xvYmFsIHZhbHVlcyBmcm9tIHRo\nZSBzeXN0ZW0ncwogICAgICoge0BsaW5rIFByb2R1Y3REZXJpdmF0aW9ufXMs\nIGFuZCBmcm9tIFN5c3RlbSBwcm9wZXJ0aWVzLgogICAgICovCiAgICBwdWJs\naWMgYm9vbGVhbiBsb2FkR2xvYmFscygpIHsKICAgICAgICBNdWx0aUNsYXNz\nTG9hZGVyIGxvYWRlciA9IChNdWx0aUNsYXNzTG9hZGVyKSBBY2Nlc3NDb250\ncm9sbGVyCiAgICAgICAgICAgIC5kb1ByaXZpbGVnZWQoSjJEb1ByaXZIZWxw\nZXIubmV3TXVsdGlDbGFzc0xvYWRlckFjdGlvbigpKTsgCiAgICAgICAgbG9h\nZGVyLmFkZENsYXNzTG9hZGVyKChDbGFzc0xvYWRlcikgQWNjZXNzQ29udHJv\nbGxlci5kb1ByaXZpbGVnZWQoCiAgICAgICAgICAgIEoyRG9Qcml2SGVscGVy\nLmdldENvbnRleHRDbGFzc0xvYWRlckFjdGlvbigpKSk7CiAgICAgICAgbG9h\nZGVyLmFkZENsYXNzTG9hZGVyKGdldENsYXNzKCkuZ2V0Q2xhc3NMb2FkZXIo\nKSk7CiAgICAgICAgQ29uZmlndXJhdGlvblByb3ZpZGVyIHByb3ZpZGVyID0g\nUHJvZHVjdERlcml2YXRpb25zLmxvYWRHbG9iYWxzKGxvYWRlcik7CiAgICAg\nICAgaWYgKHByb3ZpZGVyICE9IG51bGwpCiAgICAgICAgICAgIHByb3ZpZGVy\nLnNldEludG8odGhpcyk7CgogICAgICAgIC8vIGxldCBzeXN0ZW0gcHJvcGVy\ndGllcyBvdmVycmlkZSBvdGhlciBnbG9iYWxzCiAgICAgICAgdHJ5IHsKICAg\nICAgICAgICAgZnJvbVByb3BlcnRpZXMobmV3IEhhc2hNYXAoCiAgICAgICAg\nICAgICAgICAoUHJvcGVydGllcykgQWNjZXNzQ29udHJvbGxlci5kb1ByaXZp\nbGVnZWQoCiAgICAgICAgICAgICAgICAgICAgSjJEb1ByaXZIZWxwZXIuZ2V0\nUHJvcGVydGllc0FjdGlvbigpKSkpOwogICAgICAgIH0gY2F0Y2ggKFNlY3Vy\naXR5RXhjZXB0aW9uIHNlKSB7CiAgICAgICAgICAgIC8vIHNlY3VyaXR5IG1h\nbmFnZXIgbWlnaHQgZGlzYWxsb3cKICAgICAgICB9CgogICAgICAgIF9nbG9i\nYWxzID0gdHJ1ZTsKICAgICAgICBpZiAocHJvdmlkZXIgPT0gbnVsbCkgewog\nICAgICAgICAgICBMb2cgbG9nID0gZ2V0Q29uZmlndXJhdGlvbkxvZygpOwog\nICAgICAgICAgICBpZiAobG9nLmlzVHJhY2VFbmFibGVkKCkpCiAgICAgICAg\nICAgICAgICBsb2cudHJhY2UoX2xvYy5nZXQoIm5vLWRlZmF1bHQtcHJvdmlk\nZXJzIikpOwogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQog\nICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIHB1YmxpYyBTdHJpbmcg\nZ2V0UHJvZHVjdE5hbWUoKSB7CiAgICAgICAgcmV0dXJuIF9wcm9kdWN0Owog\nICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldFByb2R1Y3ROYW1lKFN0cmluZyBu\nYW1lKSB7CiAgICAgICAgX3Byb2R1Y3QgPSBuYW1lOwogICAgfQoKICAgIHB1\nYmxpYyBMb2dGYWN0b3J5IGdldExvZ0ZhY3RvcnkoKSB7CiAgICAgICAgaWYg\nKGxvZ0ZhY3RvcnlQbHVnaW4uZ2V0KCkgPT0gbnVsbCkKICAgICAgICAgICAg\nbG9nRmFjdG9yeVBsdWdpbi5pbnN0YW50aWF0ZShMb2dGYWN0b3J5LmNsYXNz\nLCB0aGlzKTsKICAgICAgICByZXR1cm4gKExvZ0ZhY3RvcnkpIGxvZ0ZhY3Rv\ncnlQbHVnaW4uZ2V0KCk7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0TG9n\nRmFjdG9yeShMb2dGYWN0b3J5IGxvZ0ZhY3RvcnkpIHsKICAgICAgICBhc3Nl\ncnROb3RSZWFkT25seSgpOwogICAgICAgIGxvZ0ZhY3RvcnlQbHVnaW4uc2V0\nKGxvZ0ZhY3RvcnkpOwogICAgfQoKICAgIHB1YmxpYyBTdHJpbmcgZ2V0TG9n\nKCkgewogICAgICAgIHJldHVybiBsb2dGYWN0b3J5UGx1Z2luLmdldFN0cmlu\nZygpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldExvZyhTdHJpbmcgbG9n\nKSB7CiAgICAgICAgYXNzZXJ0Tm90UmVhZE9ubHkoKTsKICAgICAgICBsb2dG\nYWN0b3J5UGx1Z2luLnNldFN0cmluZyhsb2cpOwogICAgfQoKICAgIHB1Ymxp\nYyBMb2cgZ2V0TG9nKFN0cmluZyBjYXRlZ29yeSkgewogICAgICAgIHJldHVy\nbiBnZXRMb2dGYWN0b3J5KCkuZ2V0TG9nKGNhdGVnb3J5KTsKICAgIH0KCiAg\nICBwdWJsaWMgU3RyaW5nIGdldElkKCkgewogICAgICAgIHJldHVybiBpZC5n\nZXQoKTsKICAgIH0KICAgIAogICAgcHVibGljIHZvaWQgc2V0SWQoU3RyaW5n\nIGlkKSB7CiAgICAgICAgYXNzZXJ0Tm90UmVhZE9ubHkoKTsKICAgICAgICB0\naGlzLmlkLnNldChpZCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm5z\nIHRoZSBsb2dnaW5nIGNoYW5uZWwgPGNvZGU+b3BlbmpwYS5SdW50aW1lPC9j\nb2RlPiBieSBkZWZhdWx0LgogICAgICovCiAgICBwdWJsaWMgTG9nIGdldENv\nbmZpZ3VyYXRpb25Mb2coKSB7CiAgICAgICAgcmV0dXJuIGdldExvZygib3Bl\nbmpwYS5SdW50aW1lIik7CiAgICB9CgogICAgcHVibGljIFZhbHVlW10gZ2V0\nVmFsdWVzKCkgewogICAgICAgIHJldHVybiAoVmFsdWVbXSkgX3ZhbHMudG9B\ncnJheShuZXcgVmFsdWVbX3ZhbHMuc2l6ZSgpXSk7CiAgICB9CgogICAgcHVi\nbGljIFZhbHVlIGdldFZhbHVlKFN0cmluZyBwcm9wZXJ0eSkgewogICAgICAg\nIGlmIChwcm9wZXJ0eSA9PSBudWxsKQogICAgICAgICAgICByZXR1cm4gbnVs\nbDsKCiAgICAgICAgLy8gc2VhcmNoIGJhY2t3YXJkcyBzbyB0aGF0IGN1c3Rv\nbSB2YWx1ZXMgYWRkZWQgYWZ0ZXIgY29uc3RydWN0aW9uCiAgICAgICAgLy8g\nYXJlIGZvdW5kIHF1aWNrbHksIHNpbmNlIHRoaXMgd2lsbCBiZSB0aGUgc3Rk\nIHdheSBvZiBhY2Nlc3NpbmcgdGhlbQogICAgICAgIFZhbHVlIHZhbDsKICAg\nICAgICBmb3IgKGludCBpID0gX3ZhbHMuc2l6ZSgpIC0gMTsgaSA+PSAwOyBp\nLS0pIHsKICAgICAgICAgICAgdmFsID0gKFZhbHVlKSBfdmFscy5nZXQoaSk7\nCiAgICAgICAgICAgIGlmICh2YWwuZ2V0UHJvcGVydHkoKS5lcXVhbHMocHJv\ncGVydHkpKQogICAgICAgICAgICAgICAgcmV0dXJuIHZhbDsKICAgICAgICB9\nCiAgICAgICAgcmV0dXJuIG51bGw7CiAgICB9CgogICAgcHVibGljIHZvaWQg\nc2V0UmVhZE9ubHkoYm9vbGVhbiByZWFkT25seSkgewogICAgICAgIF9yZWFk\nT25seSA9IHJlYWRPbmx5OwogICAgfQoKICAgIHB1YmxpYyB2b2lkIGluc3Rh\nbnRpYXRlQWxsKCkgewogICAgICAgIFN0cmluZ1dyaXRlciBlcnJzID0gbnVs\nbDsKICAgICAgICBQcmludFdyaXRlciBzdGFjayA9IG51bGw7CiAgICAgICAg\nVmFsdWUgdmFsOwogICAgICAgIFN0cmluZyBnZXR0ZXJOYW1lOwogICAgICAg\nIE1ldGhvZCBnZXR0ZXI7CiAgICAgICAgT2JqZWN0IGdldHRlclRhcmdldDsK\nICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IF92YWxzLnNpemUoKTsgaSsr\nKSB7CiAgICAgICAgICAgIHZhbCA9IChWYWx1ZSkgX3ZhbHMuZ2V0KGkpOwog\nICAgICAgICAgICBnZXR0ZXJOYW1lID0gdmFsLmdldEluc3RhbnRpYXRpbmdH\nZXR0ZXIoKTsKICAgICAgICAgICAgaWYgKGdldHRlck5hbWUgPT0gbnVsbCkK\nICAgICAgICAgICAgICAgIGNvbnRpbnVlOwoKICAgICAgICAgICAgZ2V0dGVy\nVGFyZ2V0ID0gdGhpczsKICAgICAgICAgICAgaWYgKGdldHRlck5hbWUuc3Rh\ncnRzV2l0aCgidGhpcy4iKSkgewogICAgICAgICAgICAgICAgZ2V0dGVyTmFt\nZSA9IGdldHRlck5hbWUuc3Vic3RyaW5nKCJ0aGlzLiIubGVuZ3RoKCkpOwog\nICAgICAgICAgICAgICAgZ2V0dGVyVGFyZ2V0ID0gdmFsOwogICAgICAgICAg\nICB9CgogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgZ2V0dGVy\nID0gZ2V0dGVyVGFyZ2V0LmdldENsYXNzKCkuZ2V0TWV0aG9kKGdldHRlck5h\nbWUsCiAgICAgICAgICAgICAgICAgICAgKENsYXNzW10pIG51bGwpOwogICAg\nICAgICAgICAgICAgZ2V0dGVyLmludm9rZShnZXR0ZXJUYXJnZXQsIChPYmpl\nY3RbXSkgbnVsbCk7CiAgICAgICAgICAgIH0gY2F0Y2ggKFRocm93YWJsZSB0\nKSB7CiAgICAgICAgICAgICAgICBpZiAodCBpbnN0YW5jZW9mIEludm9jYXRp\nb25UYXJnZXRFeGNlcHRpb24pCiAgICAgICAgICAgICAgICAgICAgdCA9ICgo\nSW52b2NhdGlvblRhcmdldEV4Y2VwdGlvbikgdCkuZ2V0VGFyZ2V0RXhjZXB0\naW9uKCk7CiAgICAgICAgICAgICAgICBpZiAoZXJycyA9PSBudWxsKSB7CiAg\nICAgICAgICAgICAgICAgICAgZXJycyA9IG5ldyBTdHJpbmdXcml0ZXIoKTsK\nICAgICAgICAgICAgICAgICAgICBzdGFjayA9IG5ldyBQcmludFdyaXRlcihl\ncnJzKTsKICAgICAgICAgICAgICAgIH0gZWxzZQogICAgICAgICAgICAgICAg\nICAgIGVycnMud3JpdGUoU0VQKTsKICAgICAgICAgICAgICAgIHQucHJpbnRT\ndGFja1RyYWNlKHN0YWNrKTsKICAgICAgICAgICAgICAgIHN0YWNrLmZsdXNo\nKCk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgaWYgKGVycnMg\nIT0gbnVsbCkKICAgICAgICAgICAgdGhyb3cgbmV3IFJ1bnRpbWVFeGNlcHRp\nb24oX2xvYy5nZXQoImdldC1wcm9wLWVycnMiLAogICAgICAgICAgICAgICAg\nZXJycy50b1N0cmluZygpKS5nZXRNZXNzYWdlKCkpOwogICAgfQoKICAgIHB1\nYmxpYyBib29sZWFuIGlzUmVhZE9ubHkoKSB7CiAgICAgICAgcmV0dXJuIF9y\nZWFkT25seTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBhZGRQcm9wZXJ0eUNo\nYW5nZUxpc3RlbmVyKFByb3BlcnR5Q2hhbmdlTGlzdGVuZXIgbGlzdGVuZXIp\nIHsKICAgICAgICBpZiAoX2NoYW5nZVN1cHBvcnQgPT0gbnVsbCkKICAgICAg\nICAgICAgX2NoYW5nZVN1cHBvcnQgPSBuZXcgUHJvcGVydHlDaGFuZ2VTdXBw\nb3J0KHRoaXMpOwogICAgICAgIF9jaGFuZ2VTdXBwb3J0LmFkZFByb3BlcnR5\nQ2hhbmdlTGlzdGVuZXIobGlzdGVuZXIpOwogICAgfQoKICAgIHB1YmxpYyB2\nb2lkIHJlbW92ZVByb3BlcnR5Q2hhbmdlTGlzdGVuZXIoUHJvcGVydHlDaGFu\nZ2VMaXN0ZW5lciBsaXN0ZW5lcikgewogICAgICAgIGlmIChfY2hhbmdlU3Vw\ncG9ydCAhPSBudWxsKQogICAgICAgICAgICBfY2hhbmdlU3VwcG9ydC5yZW1v\ndmVQcm9wZXJ0eUNoYW5nZUxpc3RlbmVyKGxpc3RlbmVyKTsKICAgIH0KCiAg\nICBwdWJsaWMgdm9pZCB2YWx1ZUNoYW5nZWQoVmFsdWUgdmFsKSB7CiAgICAg\nICAgaWYgKF9jaGFuZ2VTdXBwb3J0ID09IG51bGwgJiYgX3Byb3BzID09IG51\nbGwpCiAgICAgICAgICAgIHJldHVybjsKCiAgICAgICAgU3RyaW5nIG5ld1N0\ncmluZyA9IHZhbC5nZXRTdHJpbmcoKTsKICAgICAgICBpZiAoX2NoYW5nZVN1\ncHBvcnQgIT0gbnVsbCkKICAgICAgICAgICAgX2NoYW5nZVN1cHBvcnQuZmly\nZVByb3BlcnR5Q2hhbmdlKHZhbC5nZXRQcm9wZXJ0eSgpLCBudWxsLAogICAg\nICAgICAgICAgICAgbmV3U3RyaW5nKTsKCiAgICAgICAgLy8ga2VlcCBjYWNo\nZWQgcHJvcHMgdXAgdG8gZGF0ZQogICAgICAgIGlmIChfcHJvcHMgIT0gbnVs\nbCkgewogICAgICAgICAgICBpZiAobmV3U3RyaW5nID09IG51bGwpCiAgICAg\nICAgICAgICAgICBDb25maWd1cmF0aW9ucy5yZW1vdmVQcm9wZXJ0eSh2YWwu\nZ2V0UHJvcGVydHkoKSwgX3Byb3BzKTsKICAgICAgICAgICAgZWxzZSBpZiAo\nQ29uZmlndXJhdGlvbnMuY29udGFpbnNQcm9wZXJ0eSh2YWwuZ2V0UHJvcGVy\ndHkoKSwgX3Byb3BzKQogICAgICAgICAgICAgICAgfHwgdmFsLmdldERlZmF1\nbHQoKSA9PSBudWxsCiAgICAgICAgICAgICAgICB8fCAhdmFsLmdldERlZmF1\nbHQoKS5lcXVhbHMobmV3U3RyaW5nKSkKICAgICAgICAgICAgICAgIHB1dChf\ncHJvcHMsIHZhbCwgbmV3U3RyaW5nKTsKICAgICAgICB9CiAgICB9CgogICAg\nLyoqCiAgICAgKiBDbG9zZXMgYWxsIGNsb3NlYWJsZSB2YWx1ZXMgYW5kIHBs\ndWdpbnMuCiAgICAgKi8KICAgIHB1YmxpYyBmaW5hbCB2b2lkIGNsb3NlKCkg\newogICAgICAgIFByb2R1Y3REZXJpdmF0aW9ucy5iZWZvcmVDbG9zZSh0aGlz\nKTsKICAgICAgICAKICAgICAgICBwcmVDbG9zZSgpOwogICAgICAgIAogICAg\nICAgIE9iamVjdFZhbHVlIHZhbDsKICAgICAgICBmb3IgKGludCBpID0gMDsg\naSA8IF92YWxzLnNpemUoKTsgaSsrKSB7CiAgICAgICAgICAgIGlmIChfdmFs\ncy5nZXQoaSkgaW5zdGFuY2VvZiBDbG9zZWFibGUpIHsKICAgICAgICAgICAg\nICAgIHRyeSB7ICgoQ2xvc2VhYmxlKSBfdmFscy5nZXQoaSkpLmNsb3NlKCk7\nIH0KICAgICAgICAgICAgICAgIGNhdGNoIChFeGNlcHRpb24gZSkge30gCiAg\nICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgfQoKICAgICAg\nICAgICAgaWYgKCEoX3ZhbHMuZ2V0KGkpIGluc3RhbmNlb2YgT2JqZWN0VmFs\ndWUpKQogICAgICAgICAgICAgICAgY29udGludWU7CgogICAgICAgICAgICB2\nYWwgPSAoT2JqZWN0VmFsdWUpIF92YWxzLmdldChpKTsKICAgICAgICAgICAg\naWYgKHZhbC5nZXQoKSBpbnN0YW5jZW9mIENsb3NlYWJsZSkgewogICAgICAg\nICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICAoKENsb3NlYWJs\nZSkgdmFsLmdldCgpKS5jbG9zZSgpOwogICAgICAgICAgICAgICAgfSBjYXRj\naCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgICAgIH0KICAgICAgICAg\nICAgfQogICAgICAgIH0KICAgIH0KICAgIAogICAgLyoqCiAgICAgKiBJbnZv\na2VkIGJ5IGZpbmFsIG1ldGhvZCB7QGxpbmsgI2Nsb3NlfSBhZnRlciBpbnZv\na2luZyB0aGUgCiAgICAgKiB7QGxpbmsgUHJvZHVjdERlcml2YXRpb24jYmVm\nb3JlQ29uZmlndXJhdGlvbkNsb3NlfSBjYWxsYmFja3MKICAgICAqIGJ1dCBi\nZWZvcmUgcGVyZm9ybWluZyBpbnRlcm5hbCBjbG9zZSBvcGVyYXRpb25zLgog\nICAgICogCiAgICAgKiBAc2luY2UgMC45LjcKICAgICAqLwogICAgcHJvdGVj\ndGVkIHZvaWQgcHJlQ2xvc2UoKSB7CiAgICB9CgogICAgLy8vLy8vLy8vLy8v\nLy8vLy8vLy8vLy8vLy8vCiAgICAvLyBCZWFuSW5mbyBpbXBsZW1lbnRhdGlv\nbgogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCgogICAgcHVibGlj\nIEJlYW5JbmZvW10gZ2V0QWRkaXRpb25hbEJlYW5JbmZvKCkgewogICAgICAg\nIHJldHVybiBuZXcgQmVhbkluZm9bMF07CiAgICB9CgogICAgcHVibGljIEJl\nYW5EZXNjcmlwdG9yIGdldEJlYW5EZXNjcmlwdG9yKCkgewogICAgICAgIHJl\ndHVybiBuZXcgQmVhbkRlc2NyaXB0b3IoZ2V0Q2xhc3MoKSk7CiAgICB9Cgog\nICAgcHVibGljIGludCBnZXREZWZhdWx0RXZlbnRJbmRleCgpIHsKICAgICAg\nICByZXR1cm4gMDsKICAgIH0KCiAgICBwdWJsaWMgaW50IGdldERlZmF1bHRQ\ncm9wZXJ0eUluZGV4KCkgewogICAgICAgIHJldHVybiAwOwogICAgfQoKICAg\nIHB1YmxpYyBFdmVudFNldERlc2NyaXB0b3JbXSBnZXRFdmVudFNldERlc2Ny\naXB0b3JzKCkgewogICAgICAgIHJldHVybiBuZXcgRXZlbnRTZXREZXNjcmlw\ndG9yWzBdOwogICAgfQoKICAgIHB1YmxpYyBJbWFnZSBnZXRJY29uKGludCBr\naW5kKSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICB9CgogICAgcHVibGlj\nIHN5bmNocm9uaXplZCBNZXRob2REZXNjcmlwdG9yW10gZ2V0TWV0aG9kRGVz\nY3JpcHRvcnMoKSB7CiAgICAgICAgaWYgKF9tZHMgIT0gbnVsbCkKICAgICAg\nICAgICAgcmV0dXJuIF9tZHM7CgogICAgICAgIFByb3BlcnR5RGVzY3JpcHRv\ncltdIHBkcyA9IGdldFByb3BlcnR5RGVzY3JpcHRvcnMoKTsKICAgICAgICBM\naXN0IGRlc2NzID0gbmV3IEFycmF5TGlzdCgpOyAKICAgICAgICBmb3IgKGlu\ndCBpID0gMDsgaSA8IHBkcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBN\nZXRob2Qgd3JpdGUgPSBwZHNbaV0uZ2V0V3JpdGVNZXRob2QoKTsKICAgICAg\nICAgICAgTWV0aG9kIHJlYWQgPSBwZHNbaV0uZ2V0UmVhZE1ldGhvZCgpOwog\nICAgICAgICAgICBpZiAocmVhZCAhPSBudWxsICYmIHdyaXRlICE9IG51bGwp\nIHsKICAgICAgICAgICAgICAgIGRlc2NzLmFkZChuZXcgTWV0aG9kRGVzY3Jp\ncHRvcih3cml0ZSkpOwogICAgICAgICAgICAgICAgZGVzY3MuYWRkKG5ldyBN\nZXRob2REZXNjcmlwdG9yKHJlYWQpKTsKICAgICAgICAgICAgfQogICAgICAg\nIH0KICAgICAgICBfbWRzID0gKE1ldGhvZERlc2NyaXB0b3JbXSkgZGVzY3Mu\nCiAgICAgICAgICAgIHRvQXJyYXkobmV3IE1ldGhvZERlc2NyaXB0b3JbZGVz\nY3Muc2l6ZSgpXSk7CiAgICAgICAgcmV0dXJuIF9tZHM7CiAgICB9CgogICAg\ncHVibGljIHN5bmNocm9uaXplZCBQcm9wZXJ0eURlc2NyaXB0b3JbXSBnZXRQ\ncm9wZXJ0eURlc2NyaXB0b3JzKCkgewogICAgICAgIGlmIChfcGRzICE9IG51\nbGwpCiAgICAgICAgICAgIHJldHVybiBfcGRzOwoKICAgICAgICBfcGRzID0g\nbmV3IFByb3BlcnR5RGVzY3JpcHRvcltfdmFscy5zaXplKCldOwogICAgICAg\nIExpc3QgZmFpbHVyZXMgPSBudWxsOwogICAgICAgIFZhbHVlIHZhbDsKICAg\nICAgICBmb3IgKGludCBpID0gMDsgaSA8IF92YWxzLnNpemUoKTsgaSsrKSB7\nCiAgICAgICAgICAgIHZhbCA9IChWYWx1ZSkgX3ZhbHMuZ2V0KGkpOwogICAg\nICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgX3Bkc1tpXSA9IGdldFBy\nb3BlcnR5RGVzY3JpcHRvcih2YWwpOwogICAgICAgICAgICB9IGNhdGNoIChN\naXNzaW5nUmVzb3VyY2VFeGNlcHRpb24gbXJlKSB7CiAgICAgICAgICAgICAg\nICBpZiAoZmFpbHVyZXMgPT0gbnVsbCkKICAgICAgICAgICAgICAgICAgICBm\nYWlsdXJlcyA9IG5ldyBBcnJheUxpc3QoKTsKICAgICAgICAgICAgICAgIGZh\naWx1cmVzLmFkZCh2YWwuZ2V0UHJvcGVydHkoKSk7CiAgICAgICAgICAgIH0g\nY2F0Y2ggKEludHJvc3BlY3Rpb25FeGNlcHRpb24gaWUpIHsKICAgICAgICAg\nICAgICAgIGlmIChmYWlsdXJlcyA9PSBudWxsKQogICAgICAgICAgICAgICAg\nICAgIGZhaWx1cmVzID0gbmV3IEFycmF5TGlzdCgpOwogICAgICAgICAgICAg\nICAgZmFpbHVyZXMuYWRkKHZhbC5nZXRQcm9wZXJ0eSgpKTsKICAgICAgICAg\nICAgfQogICAgICAgIH0KICAgICAgICBpZiAoZmFpbHVyZXMgIT0gbnVsbCkK\nICAgICAgICAgICAgdGhyb3cgbmV3IFBhcnNlRXhjZXB0aW9uKF9sb2MuZ2V0\nKCJpbnZhbGlkLXByb3BlcnR5LWRlc2NyaXB0b3JzIiwKICAgICAgICAgICAg\nICAgIGZhaWx1cmVzKSk7CgogICAgICAgIHJldHVybiBfcGRzOwogICAgfQoK\nICAgIC8qKgogICAgICogQ3JlYXRlIGEgcHJvcGVydHkgZGVzY3JpcHRvciBm\nb3IgdGhlIGdpdmVuIHZhbHVlLgogICAgICovCiAgICBwcml2YXRlIFByb3Bl\ncnR5RGVzY3JpcHRvciBnZXRQcm9wZXJ0eURlc2NyaXB0b3IoVmFsdWUgdmFs\nKQogICAgICAgIHRocm93cyBJbnRyb3NwZWN0aW9uRXhjZXB0aW9uIHsKICAg\nICAgICBTdHJpbmcgcHJvcCA9IHZhbC5nZXRQcm9wZXJ0eSgpOwogICAgICAg\nIHByb3AgPSBwcm9wLnN1YnN0cmluZyhwcm9wLmxhc3RJbmRleE9mKCcuJykg\nKyAxKTsKCiAgICAgICAgLy8gc2V0IHVwIHByb3BlcnR5IGRlc2NyaXB0b3IK\nICAgICAgICBQcm9wZXJ0eURlc2NyaXB0b3IgcGQ7CiAgICAgICAgdHJ5IHsK\nICAgICAgICAgICAgcGQgPSBuZXcgUHJvcGVydHlEZXNjcmlwdG9yKEludHJv\nc3BlY3Rvci5kZWNhcGl0YWxpemUocHJvcCksIAogICAgICAgICAgICAgICAg\nZ2V0Q2xhc3MoKSk7CiAgICAgICAgfSBjYXRjaCAoSW50cm9zcGVjdGlvbkV4\nY2VwdGlvbiBpZSkgewogICAgICAgICAgICAvLyBpZiB0aGVyZSBhcmVuJ3Qg\nYW55IG1ldGhvZHMgZm9yIHRoaXMgdmFsdWUoaS5lLiwgaWYgaXQncyBhCiAg\nICAgICAgICAgIC8vIGR5bmFtaWNhbGx5LWFkZGVkIHZhbHVlKSwgdGhlbiBh\nbiBJbnRyb3NwZWN0aW9uRXhjZXB0aW9uIHdpbGwKICAgICAgICAgICAgLy8g\nYmUgdGhyb3duLiBUcnkgdG8gY3JlYXRlIGEgUEQgd2l0aCBubyByZWFkIG9y\nIHdyaXRlIG1ldGhvZHMuCiAgICAgICAgICAgIHBkID0gbmV3IFByb3BlcnR5\nRGVzY3JpcHRvcihJbnRyb3NwZWN0b3IuZGVjYXBpdGFsaXplKHByb3ApLAog\nICAgICAgICAgICAgICAgKE1ldGhvZCkgbnVsbCwgKE1ldGhvZCkgbnVsbCk7\nCiAgICAgICAgfQogICAgICAgIHBkLnNldERpc3BsYXlOYW1lKGZpbmRMb2Nh\nbGl6ZWQocHJvcCArICItbmFtZSIsIHRydWUsIHZhbC5nZXRTY29wZSgpKSk7\nCiAgICAgICAgcGQuc2V0U2hvcnREZXNjcmlwdGlvbihmaW5kTG9jYWxpemVk\nKHByb3AgKyAiLWRlc2MiLCB0cnVlLAogICAgICAgICAgICB2YWwuZ2V0U2Nv\ncGUoKSkpOwogICAgICAgIHBkLnNldEV4cGVydCgidHJ1ZSIuZXF1YWxzKGZp\nbmRMb2NhbGl6ZWQocHJvcCArICItZXhwZXJ0IiwgZmFsc2UsCiAgICAgICAg\nICAgIHZhbC5nZXRTY29wZSgpKSkpOwoKICAgICAgICB0cnkgewogICAgICAg\nICAgICBwZC5zZXRSZWFkTWV0aG9kKGdldENsYXNzKCkuZ2V0TWV0aG9kKCJn\nZXQiCiAgICAgICAgICAgICAgICArIFN0cmluZ1V0aWxzLmNhcGl0YWxpemUo\ncHJvcCksIChDbGFzc1tdKSBudWxsKSk7CiAgICAgICAgICAgIHBkLnNldFdy\naXRlTWV0aG9kKGdldENsYXNzKCkuZ2V0TWV0aG9kKCJzZXQiCiAgICAgICAg\nICAgICAgICArIFN0cmluZ1V0aWxzLmNhcGl0YWxpemUocHJvcCksIG5ldyBD\nbGFzc1tdCiAgICAgICAgICAgICAgICB7IHBkLmdldFJlYWRNZXRob2QoKS5n\nZXRSZXR1cm5UeXBlKCkgfSkpOwogICAgICAgIH0gY2F0Y2ggKFRocm93YWJs\nZSB0KSB7CiAgICAgICAgICAgIC8vIGlmIGFuIGVycm9yIG9jY3VycywgaXQg\nbWlnaHQgYmUgYmVjYXVzZSB0aGUgdmFsdWUgaXMgYQogICAgICAgICAgICAv\nLyBkeW5hbWljIHByb3BlcnR5LgogICAgICAgIH0KCiAgICAgICAgU3RyaW5n\nIHR5cGUgPSBmaW5kTG9jYWxpemVkKHByb3AgKyAiLXR5cGUiLCB0cnVlLCB2\nYWwuZ2V0U2NvcGUoKSk7CiAgICAgICAgaWYgKHR5cGUgIT0gbnVsbCkKICAg\nICAgICAgICAgcGQuc2V0VmFsdWUoQVRUUklCVVRFX1RZUEUsIHR5cGUpOwoK\nICAgICAgICBTdHJpbmcgY2F0ID0gZmluZExvY2FsaXplZChwcm9wICsgIi1j\nYXQiLCBmYWxzZSwgdmFsLmdldFNjb3BlKCkpOwogICAgICAgIGlmIChjYXQg\nIT0gbnVsbCkKICAgICAgICAgICAgcGQuc2V0VmFsdWUoQVRUUklCVVRFX0NB\nVEVHT1JZLCBjYXQpOwogICAgICAgIAogICAgICAgIHBkLnNldFZhbHVlKEFU\nVFJJQlVURV9YTUwsIHRvWE1MTmFtZShwcm9wKSk7CgogICAgICAgIFN0cmlu\nZyBvcmRlciA9IGZpbmRMb2NhbGl6ZWQocHJvcCArICItZGlzcGxheW9yZGVy\nIiwgZmFsc2UsCiAgICAgICAgICAgIHZhbC5nZXRTY29wZSgpKTsKICAgICAg\nICBpZiAob3JkZXIgIT0gbnVsbCkKICAgICAgICAgICAgcGQuc2V0VmFsdWUo\nQVRUUklCVVRFX09SREVSLCBvcmRlcik7CgogICAgICAgIC8vIGNvbGxlY3Qg\nYWxsb3dlZCB2YWx1ZXMgZnJvbSBhbGlhcyBrZXlzLCBsaXN0ZWQgdmFsdWVz\nLCBhbmQKICAgICAgICAvLyBpbnRlcmZhY2UgaW1wbGVtZW50b3JzCiAgICAg\nICAgQ29sbGVjdGlvbiBhbGxvd2VkID0gbmV3IFRyZWVTZXQoKTsKICAgICAg\nICBMaXN0IGFsaWFzZXMgPSBDb2xsZWN0aW9ucy5FTVBUWV9MSVNUOwogICAg\nICAgIGlmICh2YWwuZ2V0QWxpYXNlcygpICE9IG51bGwpIHsKICAgICAgICAg\nICAgYWxpYXNlcyA9IEFycmF5cy5hc0xpc3QodmFsLmdldEFsaWFzZXMoKSk7\nCiAgICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgYWxpYXNlcy5zaXpl\nKCk7IGkgKz0gMikKICAgICAgICAgICAgICAgIGFsbG93ZWQuYWRkKGFsaWFz\nZXMuZ2V0KGkpKTsKICAgICAgICB9CiAgICAgICAgU3RyaW5nW10gdmFscyA9\nIFN0cmluZ3Muc3BsaXQoZmluZExvY2FsaXplZChwcm9wCiAgICAgICAgICAg\nICsgIi12YWx1ZXMiLCBmYWxzZSwgdmFsLmdldFNjb3BlKCkpLCAiLCIsIDAp\nOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgdmFscy5sZW5ndGg7IGkr\nKykKICAgICAgICAgICAgaWYgKCFhbGlhc2VzLmNvbnRhaW5zKHZhbHNbaV0p\nKQogICAgICAgICAgICAgICAgYWxsb3dlZC5hZGQodmFsc1tpXSk7CiAgICAg\nICAgdHJ5IHsKICAgICAgICAgICAgQ2xhc3MgaW50ZiA9IENsYXNzLmZvck5h\nbWUoZmluZExvY2FsaXplZChwcm9wCiAgICAgICAgICAgICAgICArICItaW50\nZXJmYWNlIiwgdHJ1ZSwgdmFsLmdldFNjb3BlKCkpLCBmYWxzZSwKICAgICAg\nICAgICAgICAgIGdldENsYXNzKCkuZ2V0Q2xhc3NMb2FkZXIoKSk7CiAgICAg\nICAgICAgIHBkLnNldFZhbHVlKEFUVFJJQlVURV9JTlRFUkZBQ0UsIGludGYu\nZ2V0TmFtZSgpKTsKICAgICAgICAgICAgU3RyaW5nW10gaW1wbHMgPSBTZXJ2\naWNlcy5nZXRJbXBsZW1lbnRvcnMoaW50Zik7CiAgICAgICAgICAgIGZvciAo\naW50IGkgPSAwOyBpIDwgaW1wbHMubGVuZ3RoOyBpKyspCiAgICAgICAgICAg\nICAgICBpZiAoIWFsaWFzZXMuY29udGFpbnMoaW1wbHNbaV0pKQogICAgICAg\nICAgICAgICAgICAgIGFsbG93ZWQuYWRkKGltcGxzW2ldKTsKICAgICAgICB9\nIGNhdGNoIChUaHJvd2FibGUgdCkgewogICAgICAgIH0KICAgICAgICBpZiAo\nIWFsbG93ZWQuaXNFbXB0eSgpKQogICAgICAgICAgICBwZC5zZXRWYWx1ZShB\nVFRSSUJVVEVfQUxMT1dFRF9WQUxVRVMsIChTdHJpbmdbXSkgYWxsb3dlZC50\nb0FycmF5CiAgICAgICAgICAgICAgICAobmV3IFN0cmluZ1thbGxvd2VkLnNp\nemUoKV0pKTsKCiAgICAgICAgcmV0dXJuIHBkOwogICAgfQoKICAgIC8qKgog\nICAgICogRmluZCB0aGUgZ2l2ZW4gbG9jYWxpemVkIHN0cmluZywgb3IgcmV0\ndXJuIG51bGwgaWYgbm90IGZvdW5kLgogICAgICovCiAgICBwcml2YXRlIFN0\ncmluZyBmaW5kTG9jYWxpemVkKFN0cmluZyBrZXksIGJvb2xlYW4gZmF0YWws\nIENsYXNzIHNjb3BlKSB7CiAgICAgICAgLy8gZmluZCB0aGUgbG9jYWxpemVy\nIHBhY2thZ2UgdGhhdCBjb250YWlucyB0aGlzIGtleQogICAgICAgIExvY2Fs\naXplciBsb2MgPSBudWxsOwoKICAgICAgICAvLyBjaGVjayB0aGUgcGFja2Fn\nZSB0aGF0IHRoZSB2YWx1ZSBjbGFpbXMgdG8gYmUgZGVmaW5lZCBpbiwgaWYK\nICAgICAgICAvLyBhdmFpbGFibGUsIGJlZm9yZSB3ZSBzdGFydCBndWVzc2lu\nZy4KICAgICAgICBpZiAoc2NvcGUgIT0gbnVsbCkgewogICAgICAgICAgICBs\nb2MgPSBMb2NhbGl6ZXIuZm9yUGFja2FnZShzY29wZSk7CiAgICAgICAgICAg\nIHRyeSB7CiAgICAgICAgICAgICAgICByZXR1cm4gbG9jLmdldEZhdGFsKGtl\neSkuZ2V0TWVzc2FnZSgpOwogICAgICAgICAgICB9IGNhdGNoIChNaXNzaW5n\nUmVzb3VyY2VFeGNlcHRpb24gbXNlKSB7CiAgICAgICAgICAgIH0KICAgICAg\nICB9CgogICAgICAgIGZvciAoQ2xhc3MgY2xzID0gZ2V0Q2xhc3MoKTsgY2xz\nICE9IE9iamVjdC5jbGFzczsKICAgICAgICAgICAgY2xzID0gY2xzLmdldFN1\ncGVyY2xhc3MoKSkgewogICAgICAgICAgICBsb2MgPSBMb2NhbGl6ZXIuZm9y\nUGFja2FnZShjbHMpOwogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAg\nICAgcmV0dXJuIGxvYy5nZXRGYXRhbChrZXkpLmdldE1lc3NhZ2UoKTsKICAg\nICAgICAgICAgfSBjYXRjaCAoTWlzc2luZ1Jlc291cmNlRXhjZXB0aW9uIG1z\nZSkgewogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAoZmF0\nYWwpCiAgICAgICAgICAgIHRocm93IG5ldyBNaXNzaW5nUmVzb3VyY2VFeGNl\ncHRpb24oa2V5LCBnZXRDbGFzcygpLmdldE5hbWUoKSwga2V5KTsKICAgICAg\nICByZXR1cm4gbnVsbDsKICAgIH0KCiAgICAvLy8vLy8vLy8vLy8vLy8vCiAg\nICAvLyBUby9mcm9tIG1hcHMKICAgIC8vLy8vLy8vLy8vLy8vLy8KCiAgICBw\ndWJsaWMgTWFwIHRvUHJvcGVydGllcyhib29sZWFuIHN0b3JlRGVmYXVsdHMp\nIHsKICAgICAgICAvLyBjbG9uZSBwcm9wZXJ0aWVzIGJlZm9yZSBtYWtpbmcg\nYW55IG1vZGlmaWNhdGlvbnM7IHdlIG5lZWQgdG8ga2VlcAogICAgICAgIC8v\nIHRoZSBpbnRlcm5hbCBwcm9wZXJ0aWVzIGluc3RhbmNlIGNvbnNpc3RlbnQg\ndG8gbWFpbnRhaW4gZXF1YWxzIGFuZAogICAgICAgIC8vIGhhc2hjb2RlIGNv\nbnRyYWN0cwogICAgICAgIE1hcCBjbG9uZTsKICAgICAgICBpZiAoX3Byb3Bz\nID09IG51bGwpCiAgICAgICAgICAgIGNsb25lID0gbmV3IEhhc2hNYXAoKTsK\nICAgICAgICBlbHNlIGlmIChfcHJvcHMgaW5zdGFuY2VvZiBQcm9wZXJ0aWVz\nKQogICAgICAgICAgICBjbG9uZSA9IChNYXApICgoUHJvcGVydGllcykgX3By\nb3BzKS5jbG9uZSgpOwogICAgICAgIGVsc2UKICAgICAgICAgICAgY2xvbmUg\nPSBuZXcgSGFzaE1hcChfcHJvcHMpOwoKICAgICAgICAvLyBpZiBubyBleGlz\ndGluZyBwcm9wZXJ0aWVzIG9yIHRoZSBwcm9wZXJ0aWVzIHNob3VsZCBjb250\nYWluIGVudHJpZXMKICAgICAgICAvLyB3aXRoIGRlZmF1bHQgdmFsdWVzLCBh\nZGQgdmFsdWVzIHRvIHByb3BlcnRpZXMKICAgICAgICBpZiAoX3Byb3BzID09\nIG51bGwgfHwgc3RvcmVEZWZhdWx0cykgewogICAgICAgICAgICBWYWx1ZSB2\nYWw7CiAgICAgICAgICAgIFN0cmluZyBzdHI7CiAgICAgICAgICAgIGZvciAo\naW50IGkgPSAwOyBpIDwgX3ZhbHMuc2l6ZSgpOyBpKyspIHsKICAgICAgICAg\nICAgICAgIC8vIGlmIGtleSBpbiBleGlzdGluZyBwcm9wZXJ0aWVzLCB3ZSBh\nbHJlYWR5IGtub3cgdmFsdWUgaXMgdXAKICAgICAgICAgICAgICAgIC8vIHRv\nIGRhdGUKICAgICAgICAgICAgICAgIHZhbCA9IChWYWx1ZSkgX3ZhbHMuZ2V0\nKGkpOwogICAgICAgICAgICAgICAgaWYgKF9wcm9wcyAhPSBudWxsICYmIENv\nbmZpZ3VyYXRpb25zLmNvbnRhaW5zUHJvcGVydHkKICAgICAgICAgICAgICAg\nICAgICAodmFsLmdldFByb3BlcnR5KCksIF9wcm9wcykpCiAgICAgICAgICAg\nICAgICAgICAgY29udGludWU7CgogICAgICAgICAgICAgICAgc3RyID0gdmFs\nLmdldFN0cmluZygpOwogICAgICAgICAgICAgICAgaWYgKHN0ciAhPSBudWxs\nICYmIChzdG9yZURlZmF1bHRzCiAgICAgICAgICAgICAgICAgICAgfHwgIXN0\nci5lcXVhbHModmFsLmdldERlZmF1bHQoKSkpKQogICAgICAgICAgICAgICAg\nICAgIHB1dChjbG9uZSwgdmFsLCBzdHIpOwogICAgICAgICAgICB9CiAgICAg\nICAgICAgIGlmIChfcHJvcHMgPT0gbnVsbCkKICAgICAgICAgICAgICAgIF9w\ncm9wcyA9IG5ldyBIYXNoTWFwKGNsb25lKTsKICAgICAgICB9CiAgICAgICAg\ncmV0dXJuIGNsb25lOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIGZyb21Qcm9w\nZXJ0aWVzKE1hcCBtYXApIHsKICAgICAgICBpZiAobWFwID09IG51bGwgfHwg\nbWFwLmlzRW1wdHkoKSkKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIGFz\nc2VydE5vdFJlYWRPbmx5KCk7CgogICAgICAgIC8vIGlmIHRoZSBvbmx5IHBy\nZXZpb3VzIGNhbGwgd2FzIHRvIGxvYWQgZGVmYXVsdHMsIGZvcmdldCB0aGVt\nLgogICAgICAgIC8vIHRoaXMgd2F5IHdlIHByZXNlcnZlIHRoZSBvcmlnaW5h\nbCBmb3JtYXR0aW5nIG9mIHRoZSB1c2VyJ3MgcHJvcHMKICAgICAgICAvLyBp\nbnN0ZWFkIG9mIHRoZSBkZWZhdWx0cy4gIHRoaXMgaXMgaW1wb3J0YW50IGZv\nciBjYWNoaW5nIG9uCiAgICAgICAgLy8gY29uZmlndXJhdGlvbiBvYmplY3Rz\nCiAgICAgICAgaWYgKF9nbG9iYWxzKSB7CiAgICAgICAgICAgIF9wcm9wcyA9\nIG51bGw7CiAgICAgICAgICAgIF9nbG9iYWxzID0gZmFsc2U7CiAgICAgICAg\nfQoKICAgICAgICBNYXAgcmVtYWluaW5nID0gbmV3IEhhc2hNYXAobWFwKTsK\nICAgICAgICBib29sZWFuIHNlciA9IHRydWU7CiAgICAgICAgVmFsdWUgdmFs\nOwogICAgICAgIE9iamVjdCBvOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBp\nIDwgX3ZhbHMuc2l6ZSgpOyBpKyspIHsKICAgICAgICAgICAgdmFsID0gKFZh\nbHVlKSBfdmFscy5nZXQoaSk7CiAgICAgICAgICAgIG8gPSBnZXQobWFwLCB2\nYWwsIHRydWUpOwogICAgICAgICAgICBpZiAobyA9PSBudWxsKQogICAgICAg\nICAgICAgICAgY29udGludWU7CgogICAgICAgICAgICBpZiAobyBpbnN0YW5j\nZW9mIFN0cmluZykgewogICAgICAgICAgICAgICAgaWYgKCFTdHJpbmdVdGls\ncy5lcXVhbHMoKFN0cmluZykgbywgdmFsLmdldFN0cmluZygpKSkKICAgICAg\nICAgICAgICAgICAgICB2YWwuc2V0U3RyaW5nKChTdHJpbmcpIG8pOwogICAg\nICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgc2VyICY9IG8gaW5z\ndGFuY2VvZiBTZXJpYWxpemFibGU7CiAgICAgICAgICAgICAgICB2YWwuc2V0\nT2JqZWN0KG8pOwogICAgICAgICAgICB9CiAgICAgICAgICAgIENvbmZpZ3Vy\nYXRpb25zLnJlbW92ZVByb3BlcnR5KHZhbC5nZXRQcm9wZXJ0eSgpLCByZW1h\naW5pbmcpOwogICAgICAgIH0KICAgICAgICAKICAgICAgICAvLyBjb252ZW50\naW9uIGlzIHRvIHBvaW50IHByb2R1Y3QgYXQgYSByZXNvdXJjZSB3aXRoIHRo\nZQogICAgICAgIC8vIDxwcmVmaXg+LnByb3BlcnRpZXMgU3lzdGVtIHByb3Bl\ncnR5OyByZW1vdmUgdGhhdCBwcm9wZXJ0eSBzbyB3ZQogICAgICAgIC8vIHdl\nIGRvbid0IHdhcm4gYWJvdXQgaXQKICAgICAgICBDb25maWd1cmF0aW9ucy5y\nZW1vdmVQcm9wZXJ0eSgicHJvcGVydGllcyIsIHJlbWFpbmluZyk7CiAgICAg\nICAgCiAgICAgICAgLy8gbm93IHdhcm4gaWYgdGhlcmUgYXJlIGFueSByZW1h\naW5pbmcgcHJvcGVydGllcyB0aGF0IHRoZXJlCiAgICAgICAgLy8gaXMgYW4g\ndW5oYW5kbGVkIHByb3AKICAgICAgICBNYXAuRW50cnkgZW50cnk7CiAgICAg\nICAgZm9yIChJdGVyYXRvciBpdHIgPSByZW1haW5pbmcuZW50cnlTZXQoKS5p\ndGVyYXRvcigpOyBpdHIuaGFzTmV4dCgpOykgewogICAgICAgICAgICBlbnRy\neSA9IChNYXAuRW50cnkpIGl0ci5uZXh0KCk7CiAgICAgICAgICAgIGlmIChl\nbnRyeS5nZXRLZXkoKSAhPSBudWxsKQogICAgICAgICAgICAgICAgd2Fybklu\ndmFsaWRQcm9wZXJ0eSgoU3RyaW5nKSBlbnRyeS5nZXRLZXkoKSk7CiAgICAg\nICAgICAgIHNlciAmPSBlbnRyeS5nZXRWYWx1ZSgpIGluc3RhbmNlb2YgU2Vy\naWFsaXphYmxlOwogICAgICAgIH0KCiAgICAgICAgLy8gY2FjaGUgcHJvcGVy\ndGllcwogICAgICAgIGlmIChfcHJvcHMgPT0gbnVsbCAmJiBzZXIpCiAgICAg\nICAgICAgIF9wcm9wcyA9IG1hcDsKICAgIH0KCiAgICAvKioKICAgICAqIEFk\nZHMgPGNvZGU+bzwvY29kZT4gdG8gPGNvZGU+bWFwPC9jb2RlPiB1bmRlciBr\nZXkgZm9yIDxjb2RlPnZhbDwvY29kZT4uCiAgICAgKiBVc2UgdGhpcyBtZXRo\nb2QgaW5zdGVhZCBvZiBhdHRlbXB0aW5nIHRvIGFkZCB0aGUgdmFsdWUgZGly\nZWN0bHkgYmVjYXVzZSAKICAgICAqIHRoaXMgd2lsbCBhY2NvdW50IGZvciB0\naGUgcHJvcGVydHkgcHJlZml4LgogICAgICovCiAgICBwcml2YXRlIHZvaWQg\ncHV0KE1hcCBtYXAsIFZhbHVlIHZhbCwgT2JqZWN0IG8pIHsKICAgICAgICBP\nYmplY3Qga2V5ID0gdmFsLmdldExvYWRLZXkoKTsKICAgICAgICBpZiAoa2V5\nID09IG51bGwpCiAgICAgICAgICAgIGtleSA9ICJvcGVuanBhLiIgKyB2YWwu\nZ2V0UHJvcGVydHkoKTsKICAgICAgICBtYXAucHV0KGtleSwgbyk7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBMb29rIHVwIHRoZSBnaXZlbiB2YWx1ZSwgdGVz\ndGluZyBhbGwgYXZhaWxhYmxlIHByZWZpeGVzLgogICAgICovCiAgICBwcml2\nYXRlIE9iamVjdCBnZXQoTWFwIG1hcCwgVmFsdWUgdmFsLCBib29sZWFuIHNl\ndExvYWRLZXkpIHsKICAgICAgICBTdHJpbmcga2V5ID0gUHJvZHVjdERlcml2\nYXRpb25zLmdldENvbmZpZ3VyYXRpb25LZXkoCiAgICAgICAgICAgIHZhbC5n\nZXRQcm9wZXJ0eSgpLCBtYXApOwogICAgICAgIGlmIChtYXAuY29udGFpbnNL\nZXkoa2V5KSAmJiBzZXRMb2FkS2V5KQogICAgICAgICAgICB2YWwuc2V0TG9h\nZEtleShrZXkpOwogICAgICAgIHJldHVybiBtYXAuZ2V0KGtleSk7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBJc3N1ZSBhIHdhcm5pbmcgdGhhdCB0aGUgc3Bl\nY2lmaWVkIHByb3BlcnR5IGlzIG5vdCB2YWxpZC4KICAgICAqLwogICAgcHJp\ndmF0ZSB2b2lkIHdhcm5JbnZhbGlkUHJvcGVydHkoU3RyaW5nIHByb3BOYW1l\nKSB7CiAgICAgICAgaWYgKCFpc0ludmFsaWRQcm9wZXJ0eShwcm9wTmFtZSkp\nCiAgICAgICAgICAgIHJldHVybjsKICAgICAgICBMb2cgbG9nID0gZ2V0Q29u\nZmlndXJhdGlvbkxvZygpOwogICAgICAgIGlmIChsb2cgPT0gbnVsbCB8fCAh\nbG9nLmlzV2FybkVuYWJsZWQoKSkKICAgICAgICAgICAgcmV0dXJuOwoKICAg\nICAgICAvLyB0cnkgdG8gZmluZCB0aGUgY2xvc2VzdCBzdHJpbmcgdG8gdGhl\nIGludmFsaWQgcHJvcGVydHkKICAgICAgICAvLyBzbyB0aGF0IHdlIGNhbiBw\ncm92aWRlIGEgaGludCBpbiBjYXNlIG9mIGEgbWlzc3BlbGxpbmcKICAgICAg\nICBTdHJpbmcgY2xvc2VzdCA9IFN0cmluZ0Rpc3RhbmNlLmdldENsb3Nlc3RM\nZXZlbnNodGVpbkRpc3RhbmNlCiAgICAgICAgICAgIChwcm9wTmFtZSwgbmV3\nUHJvcGVydHlMaXN0KCksIDE1KTsKCiAgICAgICAgaWYgKGNsb3Nlc3QgPT0g\nbnVsbCkKICAgICAgICAgICAgbG9nLndhcm4oX2xvYy5nZXQoImludmFsaWQt\ncHJvcGVydHkiLCBwcm9wTmFtZSkpOwogICAgICAgIGVsc2UKICAgICAgICAg\nICAgbG9nLndhcm4oX2xvYy5nZXQoImludmFsaWQtcHJvcGVydHktaGludCIs\nIHByb3BOYW1lLCBjbG9zZXN0KSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBS\nZXR1cm4gYSBjb21wcmVoZW5zaXZlIGxpc3Qgb2YgcmVjb2duaXplZCBtYXAg\na2V5cy4KICAgICAqLwogICAgcHJpdmF0ZSBDb2xsZWN0aW9uIG5ld1Byb3Bl\ncnR5TGlzdCgpIHsKICAgICAgICBTdHJpbmdbXSBwcmVmaXhlcyA9IFByb2R1\nY3REZXJpdmF0aW9ucy5nZXRDb25maWd1cmF0aW9uUHJlZml4ZXMoKTsKICAg\nICAgICBMaXN0IGwgPSBuZXcgQXJyYXlMaXN0KF92YWxzLnNpemUoKSAqIHBy\nZWZpeGVzLmxlbmd0aCk7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBf\ndmFscy5zaXplKCk7IGkrKykgewogICAgICAgICAgICBmb3IgKGludCBqID0g\nMDsgaiA8IHByZWZpeGVzLmxlbmd0aDsgaisrKQogICAgICAgICAgICAgICAg\nbC5hZGQocHJlZml4ZXNbal0gKyAiLiIgKyAoKFZhbHVlKSBfdmFscy5nZXQo\naSkpLmdldFByb3BlcnR5KCkpOwogICAgICAgIH0KICAgICAgICByZXR1cm4g\nbDsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybnMgdHJ1ZSBpZiB0aGUg\nc3BlY2lmaWVkIHByb3BlcnR5IG5hbWUgc2hvdWxkIHJhaXNlIGEgd2Fybmlu\nZwogICAgICogaWYgaXQgaXMgbm90IGZvdW5kIGluIHRoZSBsaXN0IG9mIGtu\nb3duIHByb3BlcnRpZXMuCiAgICAgKi8KICAgIHByb3RlY3RlZCBib29sZWFu\nIGlzSW52YWxpZFByb3BlcnR5KFN0cmluZyBwcm9wTmFtZSkgewogICAgICAg\nIC8vIGhhbmRsZSB3YXJuaW5ncyBmb3Igb3BlbmpwYS5Tb21lU3RyaW5nLCBi\ndXQgbm90IGZvcgogICAgICAgIC8vIG9wZW5qcGEuc29tZS5zdWJwYWNrYWdl\nLlNvbWVTdHJpbmcsIHNpbmNlIGl0IG1pZ2h0IGJlIHZhbGlkIGZvciBzb21l\nCiAgICAgICAgLy8gc3BlY2lmaWMgaW1wbGVtZW50YXRpb24gb2YgT3BlbkpQ\nQQogICAgICAgIFN0cmluZ1tdIHByZWZpeGVzID0gUHJvZHVjdERlcml2YXRp\nb25zLmdldENvbmZpZ3VyYXRpb25QcmVmaXhlcygpOwogICAgICAgIGZvciAo\naW50IGkgPSAwOyBpIDwgcHJlZml4ZXMubGVuZ3RoOyBpKyspIHsKICAgICAg\nICAgICAgaWYgKHByb3BOYW1lLnRvTG93ZXJDYXNlKCkuc3RhcnRzV2l0aChw\ncmVmaXhlc1tpXSkKICAgICAgICAgICAgICAgICYmIHByb3BOYW1lLmxlbmd0\naCgpID4gcHJlZml4ZXNbaV0ubGVuZ3RoKCkgKyAxCiAgICAgICAgICAgICAg\nICAmJiBwcm9wTmFtZS5pbmRleE9mKCcuJywgcHJlZml4ZXNbaV0ubGVuZ3Ro\nKCkpIAogICAgICAgICAgICAgICAgPT0gcHJlZml4ZXNbaV0ubGVuZ3RoKCkK\nICAgICAgICAgICAgICAgICYmIHByb3BOYW1lLmluZGV4T2YoJy4nLCBwcmVm\naXhlc1tpXS5sZW5ndGgoKSArIDEpID09IC0xKQogICAgICAgICAgICAgICAg\ncmV0dXJuIHRydWU7CiAgICAgICAgfQogICAgICAgIHJldHVybiBmYWxzZTsK\nICAgIH0KCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgICAvLyBBdXRv\nLWNvbmZpZ3VyYXRpb24KICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KCiAg\nICAvKioKICAgICAqIFRoaXMgbWV0aG9kIGxvYWRzIHRoZSBuYW1lZCByZXNv\ndXJjZSBhcyBhIHByb3BlcnRpZXMgZmlsZS4gSXQgaXMKICAgICAqIHVzZWZ1\nbCBmb3IgYXV0by1jb25maWd1cmF0aW9uIHRvb2xzIHNvIHVzZXJzIGNhbiBz\ncGVjaWZ5IGEKICAgICAqIDxjb2RlPnByb3BlcnRpZXM8L2NvZGU+IHZhbHVl\nIHdpdGggdGhlIG5hbWUgb2YgYSByZXNvdXJjZS4KICAgICAqLwogICAgcHVi\nbGljIHZvaWQgc2V0UHJvcGVydGllcyhTdHJpbmcgcmVzb3VyY2VOYW1lKSB0\naHJvd3MgSU9FeGNlcHRpb24gewogICAgICAgIFByb2R1Y3REZXJpdmF0aW9u\ncy5sb2FkKHJlc291cmNlTmFtZSwgbnVsbCwgCiAgICAgICAgICAgIGdldENs\nYXNzKCkuZ2V0Q2xhc3NMb2FkZXIoKSkuc2V0SW50byh0aGlzKTsKICAgICAg\nICBfYXV0byA9IHJlc291cmNlTmFtZTsKICAgIH0KCiAgICAvKioKICAgICAq\nIFRoaXMgbWV0aG9kIGxvYWRzIHRoZSBuYW1lZCBmaWxlIGFzIGEgcHJvcGVy\ndGllcyBmaWxlLiBJdCBpcwogICAgICogdXNlZnVsIGZvciBhdXRvLWNvbmZp\nZ3VyYXRpb24gdG9vbHMgc28gdXNlcnMgY2FuIHNwZWNpZnkgYQogICAgICog\nPGNvZGU+cHJvcGVydGllc0ZpbGU8L2NvZGU+IHZhbHVlIHdpdGggdGhlIG5h\nbWUgb2YgYSBmaWxlLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRQcm9w\nZXJ0aWVzRmlsZShGaWxlIGZpbGUpIHRocm93cyBJT0V4Y2VwdGlvbiB7CiAg\nICAgICAgUHJvZHVjdERlcml2YXRpb25zLmxvYWQoZmlsZSwgbnVsbCwgZ2V0\nQ2xhc3MoKS5nZXRDbGFzc0xvYWRlcigpKS4KICAgICAgICAgICAgc2V0SW50\nbyh0aGlzKTsKICAgICAgICBfYXV0byA9IGZpbGUudG9TdHJpbmcoKTsKICAg\nIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgcmVzb3VyY2UgdGhhdCB3\nYXMgc2V0IHZpYSBhdXRvLWNvbmZpZ3VyYXRpb24gbWV0aG9kcwogICAgICog\ne0BsaW5rICNzZXRQcm9wZXJ0aWVzfSBvciB7QGxpbmsgI3NldFByb3BlcnRp\nZXNGaWxlfSwgb3IgbnVsbCBpZiBub25lLgogICAgICovCiAgICBwdWJsaWMg\nU3RyaW5nIGdldFByb3BlcnRpZXNSZXNvdXJjZSgpIHsKICAgICAgICByZXR1\ncm4gX2F1dG87CiAgICB9CgogICAgLy8vLy8vLy8vLy8vLwogICAgLy8gVXRp\nbGl0aWVzCiAgICAvLy8vLy8vLy8vLy8vCgogICAgLyoqCiAgICAgKiBDaGVj\na3MgaWYgdGhlIGNvbmZpZ3VyYXRpb24gaXMgcmVhZCBvbmx5IGFuZCBpZiBz\nbyB0aHJvd3MgYW4KICAgICAqIGV4Y2VwdGlvbiwgb3RoZXJ3aXNlIHJldHVy\nbnMgc2lsZW50bHkuCiAgICAgKiBJbXBsZW1lbnRhdGlvbnMgc2hvdWxkIGNh\nbGwgdGhpcyBtZXRob2QgYmVmb3JlIHNldHRpbmcgYW55IHN0YXRlLgogICAg\nICovCiAgICBwdWJsaWMgdm9pZCBhc3NlcnROb3RSZWFkT25seSgpIHsKICAg\nICAgICBpZiAoaXNSZWFkT25seSgpKQogICAgICAgICAgICB0aHJvdyBuZXcg\nSWxsZWdhbFN0YXRlRXhjZXB0aW9uKF9sb2MuZ2V0KCJyZWFkLW9ubHkiKS5n\nZXRNZXNzYWdlKCkpOwogICAgfQoKICAgIC8qKgogICAgICogUGVyZm9ybXMg\nYW4gZXF1YWxpdHkgY2hlY2sgYmFzZWQgb24gdGhlIHByb3BlcnRpZXMgcmV0\ndXJuZWQgZnJvbQogICAgICoge0BsaW5rICN0b1Byb3BlcnRpZXN9LgogICAg\nICovCiAgICBwdWJsaWMgYm9vbGVhbiBlcXVhbHMoT2JqZWN0IG90aGVyKSB7\nCiAgICAgICAgaWYgKG90aGVyID09IHRoaXMpCiAgICAgICAgICAgIHJldHVy\nbiB0cnVlOwogICAgICAgIGlmIChvdGhlciA9PSBudWxsKQogICAgICAgICAg\nICByZXR1cm4gZmFsc2U7CiAgICAgICAgaWYgKCFnZXRDbGFzcygpLmVxdWFs\ncyhvdGhlci5nZXRDbGFzcygpKSkKICAgICAgICAgICAgcmV0dXJuIGZhbHNl\nOwoKICAgICAgICAvLyBjb21wYXJlIHByb3BlcnRpZXMKICAgICAgICBDb25m\naWd1cmF0aW9uSW1wbCBjb25mID0gKENvbmZpZ3VyYXRpb25JbXBsKSBvdGhl\ncjsKICAgICAgICBNYXAgcDEgPSAoX3Byb3BzID09IG51bGwpID8gdG9Qcm9w\nZXJ0aWVzKGZhbHNlKSA6IF9wcm9wczsKICAgICAgICBNYXAgcDIgPSAoY29u\nZi5fcHJvcHMgPT0gbnVsbCkgPyBjb25mLnRvUHJvcGVydGllcyhmYWxzZSkg\nOiBjb25mLl9wcm9wczsKICAgICAgICByZXR1cm4gZXhjbHVkZUR5bmFtaWMo\ncDEpLmVxdWFscyhleGNsdWRlRHluYW1pYyhwMikpOwogICAgfQoKICAgIC8q\nKgogICAgICogQ29tcHV0ZXMgaGFzaCBjb2RlIGJhc2VkIG9uIHRoZSBwcm9w\nZXJ0aWVzIHJldHVybmVkIGZyb20KICAgICAqIHtAbGluayAjdG9Qcm9wZXJ0\naWVzfS4KICAgICAqLwogICAgcHVibGljIGludCBoYXNoQ29kZSgpIHsKICAg\nIAlNYXAgY29weSA9IChfcHJvcHMgPT0gbnVsbCkgPyB0b1Byb3BlcnRpZXMo\nZmFsc2UpIDogX3Byb3BzOwogICAgCXJldHVybiBleGNsdWRlRHluYW1pYyhj\nb3B5KS5oYXNoQ29kZSgpOwogICAgfQoKICAgIC8qKgogICAgICogQ29udmVy\ndCA8Y29kZT5wcm9wTmFtZTwvY29kZT4gdG8gYSBsb3dlcmNhc2Utd2l0aC1o\neXBoZW5zLXN0eWxlIHN0cmluZy4KICAgICAqIFRoaXMgYWxnb3JpdGhtIGlz\nIG9ubHkgZGVzaWduZWQgZm9yIG1peGVzIG9mIHVwcGVyY2FzZSBhbmQgbG93\nZXJjYXNlIAogICAgICogbGV0dGVycyBhbmQgbG9uZSBkaWdpdHMuIEEgbW9y\nZSBzb3BoaXN0aWNhdGVkIGNvbnZlcnNpb24gc2hvdWxkIHByb2JhYmx5IAog\nICAgICogYmUgaGFuZGxlZCBieSBhIHByb3BlciBwYXJzZXIgZ2VuZXJhdG9y\nIG9yIHJlZ3VsYXIgZXhwcmVzc2lvbnMuCiAgICAgKi8KICAgIHB1YmxpYyBz\ndGF0aWMgU3RyaW5nIHRvWE1MTmFtZShTdHJpbmcgcHJvcE5hbWUpIHsKICAg\nICAgICBpZiAocHJvcE5hbWUgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJu\nIG51bGw7CiAgICAgICAgU3RyaW5nQnVmZmVyIGJ1ZiA9IG5ldyBTdHJpbmdC\ndWZmZXIoKTsKICAgICAgICBjaGFyIGM7CiAgICAgICAgZm9yIChpbnQgaSA9\nIDA7IGkgPCBwcm9wTmFtZS5sZW5ndGgoKTsgaSsrKSB7CiAgICAgICAgICAg\nIGMgPSBwcm9wTmFtZS5jaGFyQXQoaSk7CgogICAgICAgICAgICAvLyBjb252\nZXJ0IHNlcXVlbmNlcyBvZiBhbGwtY2FwcyB0byBkb3duY2FzZSB3aXRoIGRh\nc2hlcyBhcm91bmQgCiAgICAgICAgICAgIC8vIHRoZW0uIHB1dCBhIHRyYWls\naW5nIGNhcCB0aGF0IGlzIGZvbGxvd2VkIGJ5IGRvd25jYXNlIGludG8gdGhl\nCiAgICAgICAgICAgIC8vIGRvd25jYXNlIHdvcmQuCiAgICAgICAgICAgIGlm\nIChpICE9IDAgJiYgQ2hhcmFjdGVyLmlzVXBwZXJDYXNlKGMpIAogICAgICAg\nICAgICAgICAgJiYgKENoYXJhY3Rlci5pc0xvd2VyQ2FzZShwcm9wTmFtZS5j\naGFyQXQoaS0xKSkKICAgICAgICAgICAgICAgIHx8IChpID4gMSAmJiBpIDwg\ncHJvcE5hbWUubGVuZ3RoKCkgLSAxCiAgICAgICAgICAgICAgICAmJiBDaGFy\nYWN0ZXIuaXNVcHBlckNhc2UocHJvcE5hbWUuY2hhckF0KGktMSkpIAogICAg\nICAgICAgICAgICAgJiYgQ2hhcmFjdGVyLmlzTG93ZXJDYXNlKHByb3BOYW1l\nLmNoYXJBdChpKzEpKSkpKQogICAgICAgICAgICAgICAgYnVmLmFwcGVuZCgn\nLScpOwogICAgICAgICAgICAKICAgICAgICAgICAgLy8gc3Vycm91bmQgc2Vx\ndWVuY2VzIG9mIGRpZ2l0cyB3aXRoIGRhc2hlcy4KICAgICAgICAgICAgaWYg\nKGkgIT0gMAogICAgICAgICAgICAgICAgJiYgKCghQ2hhcmFjdGVyLmlzTGV0\ndGVyKGMpICYmIENoYXJhY3Rlci5pc0xldHRlcihwcm9wTmFtZQogICAgICAg\nICAgICAgICAgICAgIC5jaGFyQXQoaSAtIDEpKSkgCiAgICAgICAgICAgICAg\nICB8fCAoQ2hhcmFjdGVyLmlzTGV0dGVyKGMpICYmICFDaGFyYWN0ZXIuaXNM\nZXR0ZXIocHJvcE5hbWUKICAgICAgICAgICAgICAgICAgICAuY2hhckF0KGkg\nLSAxKSkpKSkKICAgICAgICAgICAgICAgIGJ1Zi5hcHBlbmQoJy0nKTsKICAg\nICAgICAgICAgCiAgICAgICAgICAgIGJ1Zi5hcHBlbmQoQ2hhcmFjdGVyLnRv\nTG93ZXJDYXNlKGMpKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGJ1Zi50\nb1N0cmluZygpOwogICAgfQogICAgCiAgICAvKioKICAgICAqIEltcGxlbWVu\ndGF0aW9uIG9mIHRoZSB7QGxpbmsgRXh0ZXJuYWxpemFibGV9IGludGVyZmFj\nZSB0byByZWFkIGZyb20KICAgICAqIHRoZSBwcm9wZXJ0aWVzIHdyaXR0ZW4g\nYnkge0BsaW5rICN3cml0ZUV4dGVybmFsfS4KICAgICAqLwogICAgcHVibGlj\nIHZvaWQgcmVhZEV4dGVybmFsKE9iamVjdElucHV0IGluKQogICAgICAgIHRo\ncm93cyBJT0V4Y2VwdGlvbiwgQ2xhc3NOb3RGb3VuZEV4Y2VwdGlvbiB7CiAg\nICAgICAgZnJvbVByb3BlcnRpZXMoKE1hcCkgaW4ucmVhZE9iamVjdCgpKTsK\nICAgICAgICBfcHJvcHMgPSAoTWFwKSBpbi5yZWFkT2JqZWN0KCk7CiAgICAg\nICAgX2dsb2JhbHMgPSBpbi5yZWFkQm9vbGVhbigpOwogICAgfQoKICAgIC8q\nKgogICAgICogSW1wbGVtZW50YXRpb24gb2YgdGhlIHtAbGluayBFeHRlcm5h\nbGl6YWJsZX0gaW50ZXJmYWNlIHRvIHdyaXRlCiAgICAgKiB0aGUgcHJvcGVy\ndGllcyByZXR1cm5lZCBieSB7QGxpbmsgI3RvUHJvcGVydGllc30uCiAgICAg\nKi8KICAgIHB1YmxpYyB2b2lkIHdyaXRlRXh0ZXJuYWwoT2JqZWN0T3V0cHV0\nIG91dCkgdGhyb3dzIElPRXhjZXB0aW9uIHsKICAgICAgICBvdXQud3JpdGVP\nYmplY3QodG9Qcm9wZXJ0aWVzKHRydWUpKTsKICAgICAgICBvdXQud3JpdGVP\nYmplY3QoX3Byb3BzKTsKICAgICAgICBvdXQud3JpdGVCb29sZWFuKF9nbG9i\nYWxzKTsKICAgIH0KCiAgICAvKioKICAgICAqIFVzZXMge0BsaW5rICN0b1By\nb3BlcnRpZXN9IGFuZCB7QGxpbmsgI2Zyb21Qcm9wZXJ0aWVzfSB0byBjbG9u\nZQogICAgICogY29uZmlndXJhdGlvbi4KICAgICAqLwogICAgcHVibGljIE9i\namVjdCBjbG9uZSgpIHsKICAgICAgICB0cnkgewogICAgICAgICAgICBDb25z\ndHJ1Y3RvciBjb25zID0gZ2V0Q2xhc3MoKS5nZXRDb25zdHJ1Y3RvcgogICAg\nICAgICAgICAgICAgKG5ldyBDbGFzc1tdeyBib29sZWFuLmNsYXNzIH0pOwog\nICAgICAgICAgICBDb25maWd1cmF0aW9uSW1wbCBjbG9uZSA9IChDb25maWd1\ncmF0aW9uSW1wbCkgY29ucy5uZXdJbnN0YW5jZQogICAgICAgICAgICAgICAg\nKG5ldyBPYmplY3RbXXsgQm9vbGVhbi5GQUxTRSB9KTsKICAgICAgICAgICAg\nY2xvbmUuZnJvbVByb3BlcnRpZXModG9Qcm9wZXJ0aWVzKHRydWUpKTsKICAg\nICAgICAgICAgY2xvbmUuX3Byb3BzID0gKF9wcm9wcyA9PSBudWxsKSA/IG51\nbGwgOiBuZXcgSGFzaE1hcChfcHJvcHMpOwogICAgICAgICAgICBjbG9uZS5f\nZ2xvYmFscyA9IF9nbG9iYWxzOwogICAgICAgICAgICByZXR1cm4gY2xvbmU7\nCiAgICAgICAgfSBjYXRjaCAoUnVudGltZUV4Y2VwdGlvbiByZSkgewogICAg\nICAgICAgICB0aHJvdyByZTsKICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24g\nZSkgewogICAgICAgICAgICB0aHJvdyBuZXcgUGFyc2VFeGNlcHRpb24oZSk7\nCiAgICAgICAgfQogICAgfQoKICAgIHB1YmxpYyBib29sZWFuIHJlbW92ZVZh\nbHVlKFZhbHVlIHZhbCkgewogICAgICAgIGlmICghX3ZhbHMucmVtb3ZlKHZh\nbCkpCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB2YWwuc2V0\nTGlzdGVuZXIobnVsbCk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9Cgog\nICAgcHVibGljIFZhbHVlIGFkZFZhbHVlKFZhbHVlIHZhbCkgewogICAgICAg\nIF92YWxzLmFkZCh2YWwpOwogICAgICAgIHZhbC5zZXRMaXN0ZW5lcih0aGlz\nKTsKICAgICAgICByZXR1cm4gdmFsOwogICAgfQoKICAgIC8qKgogICAgICog\nQWRkIHRoZSBnaXZlbiB2YWx1ZSB0byB0aGUgc2V0IG9mIGNvbmZpZ3VyYXRp\nb24gcHJvcGVydGllcy4KICAgICAqLwogICAgcHVibGljIFN0cmluZ1ZhbHVl\nIGFkZFN0cmluZyhTdHJpbmcgcHJvcGVydHkpIHsKICAgICAgICBTdHJpbmdW\nYWx1ZSB2YWwgPSBuZXcgU3RyaW5nVmFsdWUocHJvcGVydHkpOwogICAgICAg\nIGFkZFZhbHVlKHZhbCk7CiAgICAgICAgcmV0dXJuIHZhbDsKICAgIH0KCiAg\nICAvKioKICAgICAqIEFkZCB0aGUgZ2l2ZW4gdmFsdWUgdG8gdGhlIHNldCBv\nZiBjb25maWd1cmF0aW9uIHByb3BlcnRpZXMuCiAgICAgKi8KICAgIHB1Ymxp\nYyBGaWxlVmFsdWUgYWRkRmlsZShTdHJpbmcgcHJvcGVydHkpIHsKICAgICAg\nICBGaWxlVmFsdWUgdmFsID0gbmV3IEZpbGVWYWx1ZShwcm9wZXJ0eSk7CiAg\nICAgICAgYWRkVmFsdWUodmFsKTsKICAgICAgICByZXR1cm4gdmFsOwogICAg\nfQoKICAgIC8qKgogICAgICogQWRkIHRoZSBnaXZlbiB2YWx1ZSB0byB0aGUg\nc2V0IG9mIGNvbmZpZ3VyYXRpb24gcHJvcGVydGllcy4KICAgICAqLwogICAg\ncHVibGljIEludFZhbHVlIGFkZEludChTdHJpbmcgcHJvcGVydHkpIHsKICAg\nICAgICBJbnRWYWx1ZSB2YWwgPSBuZXcgSW50VmFsdWUocHJvcGVydHkpOwog\nICAgICAgIGFkZFZhbHVlKHZhbCk7CiAgICAgICAgcmV0dXJuIHZhbDsKICAg\nIH0KCiAgICAvKioKICAgICAqIEFkZCB0aGUgZ2l2ZW4gdmFsdWUgdG8gdGhl\nIHNldCBvZiBjb25maWd1cmF0aW9uIHByb3BlcnRpZXMuCiAgICAgKi8KICAg\nIHB1YmxpYyBEb3VibGVWYWx1ZSBhZGREb3VibGUoU3RyaW5nIHByb3BlcnR5\nKSB7CiAgICAgICAgRG91YmxlVmFsdWUgdmFsID0gbmV3IERvdWJsZVZhbHVl\nKHByb3BlcnR5KTsKICAgICAgICBhZGRWYWx1ZSh2YWwpOwogICAgICAgIHJl\ndHVybiB2YWw7CiAgICB9CgogICAgLyoqCiAgICAgKiBBZGQgdGhlIGdpdmVu\nIHZhbHVlIHRvIHRoZSBzZXQgb2YgY29uZmlndXJhdGlvbiBwcm9wZXJ0aWVz\nLgogICAgICovCiAgICBwdWJsaWMgQm9vbGVhblZhbHVlIGFkZEJvb2xlYW4o\nU3RyaW5nIHByb3BlcnR5KSB7CiAgICAgICAgQm9vbGVhblZhbHVlIHZhbCA9\nIG5ldyBCb29sZWFuVmFsdWUocHJvcGVydHkpOwogICAgICAgIGFkZFZhbHVl\nKHZhbCk7CiAgICAgICAgdmFsLnNldERlZmF1bHQoImZhbHNlIik7CiAgICAg\nICAgcmV0dXJuIHZhbDsKICAgIH0KCiAgICAvKioKICAgICAqIEFkZCB0aGUg\nZ2l2ZW4gdmFsdWUgdG8gdGhlIHNldCBvZiBjb25maWd1cmF0aW9uIHByb3Bl\ncnRpZXMuCiAgICAgKi8KICAgIHB1YmxpYyBTdHJpbmdMaXN0VmFsdWUgYWRk\nU3RyaW5nTGlzdChTdHJpbmcgcHJvcGVydHkpIHsKICAgICAgICBTdHJpbmdM\naXN0VmFsdWUgdmFsID0gbmV3IFN0cmluZ0xpc3RWYWx1ZShwcm9wZXJ0eSk7\nCiAgICAgICAgYWRkVmFsdWUodmFsKTsKICAgICAgICByZXR1cm4gdmFsOwog\nICAgfQoKICAgIC8qKgogICAgICogQWRkIHRoZSBnaXZlbiB2YWx1ZSB0byB0\naGUgc2V0IG9mIGNvbmZpZ3VyYXRpb24gcHJvcGVydGllcy4KICAgICAqLwog\nICAgcHVibGljIE9iamVjdFZhbHVlIGFkZE9iamVjdChTdHJpbmcgcHJvcGVy\ndHkpIHsKICAgICAgICBPYmplY3RWYWx1ZSB2YWwgPSBuZXcgT2JqZWN0VmFs\ndWUocHJvcGVydHkpOwogICAgICAgIGFkZFZhbHVlKHZhbCk7CiAgICAgICAg\ncmV0dXJuIHZhbDsKICAgIH0KCiAgICAvKioKICAgICAqIEFkZCB0aGUgZ2l2\nZW4gdmFsdWUgdG8gdGhlIHNldCBvZiBjb25maWd1cmF0aW9uIHByb3BlcnRp\nZXMuCiAgICAgKi8KICAgIHB1YmxpYyBQbHVnaW5WYWx1ZSBhZGRQbHVnaW4o\nU3RyaW5nIHByb3BlcnR5LCBib29sZWFuIHNpbmdsZXRvbikgewogICAgICAg\nIFBsdWdpblZhbHVlIHZhbCA9IG5ldyBQbHVnaW5WYWx1ZShwcm9wZXJ0eSwg\nc2luZ2xldG9uKTsKICAgICAgICBhZGRWYWx1ZSh2YWwpOwogICAgICAgIHJl\ndHVybiB2YWw7CiAgICB9CgogICAgLyoqCiAgICAgKiBBZGQgdGhlIGdpdmVu\nIHZhbHVlIHRvIHRoZSBzZXQgb2YgY29uZmlndXJhdGlvbiBwcm9wZXJ0aWVz\nLgogICAgICovCiAgICBwdWJsaWMgUGx1Z2luTGlzdFZhbHVlIGFkZFBsdWdp\nbkxpc3QoU3RyaW5nIHByb3BlcnR5KSB7CiAgICAgICAgUGx1Z2luTGlzdFZh\nbHVlIHZhbCA9IG5ldyBQbHVnaW5MaXN0VmFsdWUocHJvcGVydHkpOwogICAg\nICAgIGFkZFZhbHVlKHZhbCk7CiAgICAgICAgcmV0dXJuIHZhbDsKICAgIH0K\nICAgIAogICAgcHVibGljIHZvaWQgbW9kaWZ5RHluYW1pYyhTdHJpbmcgcHJv\ncGVydHksIE9iamVjdCBuZXdWYWx1ZSkgewogICAgCWlmICghaXNEeW5hbWlj\nKHByb3BlcnR5KSkgCiAgICAJCXRocm93IG5ldyBSdW50aW1lRXhjZXB0aW9u\nKF9sb2MuZ2V0KCJub3QtZHluYW1pYyIsIHByb3BlcnR5KQogICAgCQkJLnRv\nU3RyaW5nKCkpOwogICAgCVZhbHVlIHZhbHVlID0gZ2V0VmFsdWUocHJvcGVy\ndHkpOwogICAgCXZhbHVlLnNldE9iamVjdChuZXdWYWx1ZSk7CiAgICB9CiAg\nICAKICAgIHB1YmxpYyBib29sZWFuIGlzRHluYW1pYyhTdHJpbmcgcHJvcGVy\ndHkpIHsKICAgIAlWYWx1ZVtdIGR5bmFtaWNWYWx1ZXMgPSBnZXREeW5hbWlj\nVmFsdWVzKCk7CiAgICAJZm9yIChpbnQgaT0wOyBpPGR5bmFtaWNWYWx1ZXMu\nbGVuZ3RoOyBpKyspIAogICAgCQlpZiAoZHluYW1pY1ZhbHVlc1tpXS5nZXRQ\ncm9wZXJ0eSgpLmVxdWFscyhwcm9wZXJ0eSkpCiAgICAJCQlyZXR1cm4gdHJ1\nZTsKICAgIAlyZXR1cm4gZmFsc2U7CiAgICB9CiAgICAKICAgIHB1YmxpYyBW\nYWx1ZVtdIGdldER5bmFtaWNWYWx1ZXMoKSB7CiAgICAJcmV0dXJuIG5ldyBW\nYWx1ZVswXTsKICAgIH0KICAgIAogICAgTWFwIGV4Y2x1ZGVEeW5hbWljKE1h\ncCBtYXApIHsKICAgIAlpZiAobWFwID09IG51bGwpCiAgICAJCXJldHVybiBu\ndWxsOwogICAgCU1hcCBjb3B5ID0gbmV3IEhhc2hNYXAobWFwKTsKICAgIAlW\nYWx1ZVtdIGR5bmFtaWNWYWx1ZXMgPSBnZXREeW5hbWljVmFsdWVzKCk7CiAg\nICAJZm9yIChpbnQgaT0wOyBpPGR5bmFtaWNWYWx1ZXMubGVuZ3RoOyBpKysp\nIHsKICAgIAkJQ29uZmlndXJhdGlvbnMucmVtb3ZlUHJvcGVydHkoZHluYW1p\nY1ZhbHVlc1tpXS5nZXRQcm9wZXJ0eSgpLCBjb3B5KTsKICAgIAl9CiAgICAJ\ncmV0dXJuIGNvcHk7CiAgICB9Cn0K\n","encoding":"base64"}

