{"sha":"13869b506a338e4e809276a4cd73b6fa1e42294f","node_id":"MDQ6QmxvYjIwNjM2NDoxMzg2OWI1MDZhMzM4ZTRlODA5Mjc2YTRjZDczYjZmYTFlNDIyOTRm","size":14560,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/13869b506a338e4e809276a4cd73b6fa1e42294f","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEubGliLmNvbmY7CgppbXBvcnQg\namF2YS5pby5GaWxlOwppbXBvcnQgamF2YS5zZWN1cml0eS5BY2Nlc3NDb250\ncm9sbGVyOwppbXBvcnQgamF2YS5zZWN1cml0eS5Qcml2aWxlZ2VkQWN0aW9u\nRXhjZXB0aW9uOwppbXBvcnQgamF2YS51dGlsLkFycmF5TGlzdDsKaW1wb3J0\nIGphdmEudXRpbC5Db2xsZWN0aW9uczsKaW1wb3J0IGphdmEudXRpbC5Db21w\nYXJhdG9yOwppbXBvcnQgamF2YS51dGlsLkxpc3Q7CmltcG9ydCBqYXZhLnV0\naWwuTWFwOwppbXBvcnQgamF2YS51dGlsLk1pc3NpbmdSZXNvdXJjZUV4Y2Vw\ndGlvbjsKCmltcG9ydCBvcmcuYXBhY2hlLmNvbW1vbnMubGFuZy5TdHJpbmdV\ndGlsczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIudXRpbC5KMkRv\nUHJpdkhlbHBlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIudXRp\nbC5Mb2NhbGl6ZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0\naWwuU2VydmljZXM7CgovKioKICogVXRpbGl0aWVzIGZvciBydW5uaW5nIHBy\nb2R1Y3QgZGVyaXZhdGlvbnMuCiAqCiAqIEBhdXRob3IgQWJlIFdoaXRlCiAq\nIEBub2phdmFkb2MKICovCnB1YmxpYyBjbGFzcyBQcm9kdWN0RGVyaXZhdGlv\nbnMgewoKICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIExvY2FsaXplciBfbG9j\nID0gTG9jYWxpemVyLmZvclBhY2thZ2UKICAgICAgICAoUHJvZHVjdERlcml2\nYXRpb25zLmNsYXNzKTsKCiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBQcm9k\ndWN0RGVyaXZhdGlvbltdIF9kZXJpdmF0aW9uczsKICAgIHByaXZhdGUgc3Rh\ndGljIGZpbmFsIFN0cmluZ1tdIF9kZXJpdmF0aW9uTmFtZXM7CiAgICBwcml2\nYXRlIHN0YXRpYyBmaW5hbCBUaHJvd2FibGVbXSBfZGVyaXZhdGlvbkVycm9y\nczsKICAgIHByaXZhdGUgc3RhdGljIFN0cmluZ1tdIF9wcmVmaXhlczsKICAg\nIHN0YXRpYyB7CiAgICAgICAgQ2xhc3NMb2FkZXIgbCA9IChDbGFzc0xvYWRl\ncikgQWNjZXNzQ29udHJvbGxlci5kb1ByaXZpbGVnZWQoCiAgICAgICAgICAg\nIEoyRG9Qcml2SGVscGVyLmdldENsYXNzTG9hZGVyQWN0aW9uKFByb2R1Y3RE\nZXJpdmF0aW9uLmNsYXNzKSk7IAogICAgICAgIF9kZXJpdmF0aW9uTmFtZXMg\nPSBTZXJ2aWNlcy5nZXRJbXBsZW1lbnRvcnMoUHJvZHVjdERlcml2YXRpb24u\nY2xhc3MsIGwpOwogICAgICAgIF9kZXJpdmF0aW9uRXJyb3JzID0gbmV3IFRo\ncm93YWJsZVtfZGVyaXZhdGlvbk5hbWVzLmxlbmd0aF07CiAgICAgICAgTGlz\ndCBkZXJpdmF0aW9ucyA9IG5ldyBBcnJheUxpc3QoX2Rlcml2YXRpb25OYW1l\ncy5sZW5ndGgpOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgX2Rlcml2\nYXRpb25OYW1lcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICB0cnkgewog\nICAgICAgICAgICAgICAgUHJvZHVjdERlcml2YXRpb24gZCA9IChQcm9kdWN0\nRGVyaXZhdGlvbikKICAgICAgICAgICAgICAgICAgICBBY2Nlc3NDb250cm9s\nbGVyLmRvUHJpdmlsZWdlZCgKICAgICAgICAgICAgICAgICAgICAgICAgSjJE\nb1ByaXZIZWxwZXIubmV3SW5zdGFuY2VBY3Rpb24oCiAgICAgICAgICAgICAg\nICAgICAgICAgICAgICBDbGFzcy5mb3JOYW1lKF9kZXJpdmF0aW9uTmFtZXNb\naV0sIHRydWUsIGwpKSk7CiAgICAgICAgICAgICAgICBkLnZhbGlkYXRlKCk7\nCiAgICAgICAgICAgICAgICBkZXJpdmF0aW9ucy5hZGQoZCk7CiAgICAgICAg\nICAgIH0gY2F0Y2ggKFRocm93YWJsZSB0KSB7CiAgICAgICAgICAgICAgICBp\nZiAodCBpbnN0YW5jZW9mIFByaXZpbGVnZWRBY3Rpb25FeGNlcHRpb24pCiAg\nICAgICAgICAgICAgICAgICAgdCA9ICgoUHJpdmlsZWdlZEFjdGlvbkV4Y2Vw\ndGlvbikgdCkuZ2V0RXhjZXB0aW9uKCk7CiAgICAgICAgICAgICAgICBfZGVy\naXZhdGlvbkVycm9yc1tpXSA9IHQ7CiAgICAgICAgICAgIH0KICAgICAgICB9\nCgogICAgICAgIC8vIG11c3QgYmUgYXQgbGVhc3Qgb25lIHByb2R1Y3QgZGVy\naXZhdGlvbiB0byBkZWZpbmUgbWV0YWRhdGEgZmFjdG9yaWVzLAogICAgICAg\nIC8vIGV0Yy4gCiAgICAgICAgaWYgKGRlcml2YXRpb25zLmlzRW1wdHkoKSkg\newogICAgICAgICAgICB0aHJvdyBuZXcgTWlzc2luZ1Jlc291cmNlRXhjZXB0\naW9uKF9sb2MuZ2V0CiAgICAgICAgICAgICAgICAoIm5vLXByb2R1Y3QtZGVy\naXZhdGlvbnMiLCBQcm9kdWN0RGVyaXZhdGlvbi5jbGFzcy5nZXROYW1lKCks\nCiAgICAgICAgICAgICAgICBkZXJpdmF0aW9uRXJyb3JzVG9TdHJpbmcoKSku\nZ2V0TWVzc2FnZSgpLCAKICAgICAgICAgICAgICAgIFByb2R1Y3REZXJpdmF0\naW9ucy5jbGFzcy5nZXROYW1lKCksImRlcml2YXRpb25zIik7CiAgICAgICAg\nfQoKICAgICAgICAvLyBpZiBzb21lIGRlcml2YXRpb25zIHdlcmVuJ3QgaW5z\ndGFudGlhYmxlLCB3YXJuCiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBf\nZGVyaXZhdGlvbkVycm9ycy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBp\nZiAoX2Rlcml2YXRpb25FcnJvcnNbaV0gPT0gbnVsbCkKICAgICAgICAgICAg\nICAgIGNvbnRpbnVlOwogICAgICAgICAgICBTeXN0ZW0uZXJyLnByaW50bG4o\nX2xvYy5nZXQoImJhZC1wcm9kdWN0LWRlcml2YXRpb25zIiwKICAgICAgICAg\nICAgICAgIFByb2R1Y3REZXJpdmF0aW9ucy5jbGFzcy5nZXROYW1lKCkpKTsK\nICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgfQoKICAgICAgICBDb2xsZWN0\naW9ucy5zb3J0KGRlcml2YXRpb25zLCBuZXcgUHJvZHVjdERlcml2YXRpb25D\nb21wYXJhdG9yKCkpOwogICAgICAgIF9kZXJpdmF0aW9ucyA9IChQcm9kdWN0\nRGVyaXZhdGlvbltdKSBkZXJpdmF0aW9ucy50b0FycmF5CiAgICAgICAgICAg\nIChuZXcgUHJvZHVjdERlcml2YXRpb25bZGVyaXZhdGlvbnMuc2l6ZSgpXSk7\nCgogICAgICAgIExpc3QgcHJlZml4ZXMgPSBuZXcgQXJyYXlMaXN0KDIpOwog\nICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgX2Rlcml2YXRpb25zLmxlbmd0\naDsgaSsrKSB7CiAgICAgICAgICAgIGlmIChfZGVyaXZhdGlvbnNbaV0uZ2V0\nQ29uZmlndXJhdGlvblByZWZpeCgpICE9IG51bGwKICAgICAgICAgICAgICAg\nICYmICEib3BlbmpwYSIuZXF1YWxzKF9kZXJpdmF0aW9uc1tpXS5nZXRDb25m\naWd1cmF0aW9uUHJlZml4KCkpKQogICAgICAgICAgICAgICAgcHJlZml4ZXMu\nYWRkKF9kZXJpdmF0aW9uc1tpXS5nZXRDb25maWd1cmF0aW9uUHJlZml4KCkp\nOwogICAgICAgIH0KICAgICAgICBTdHJpbmdbXSBwcmVmaXhBcnJheSA9IG5l\ndyBTdHJpbmdbMSArIHByZWZpeGVzLnNpemUoKV07CiAgICAgICAgcHJlZml4\nQXJyYXlbMF0gPSAib3BlbmpwYSI7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7\nIGkgPCBwcmVmaXhlcy5zaXplKCk7IGkrKykKICAgICAgICAgICAgcHJlZml4\nQXJyYXlbaSArIDFdID0gKFN0cmluZykgcHJlZml4ZXMuZ2V0KGkpOwogICAg\nICAgIHNldENvbmZpZ3VyYXRpb25QcmVmaXhlcyhwcmVmaXhBcnJheSk7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gYWxsIHRoZSBwcm9kdWN0IGRl\ncml2YXRpb25zIHJlZ2lzdGVyZWQgaW4gdGhlIGN1cnJlbnQgY2xhc3Nsb2Fk\nZXIKICAgICAqLwogICAgcHVibGljIHN0YXRpYyBQcm9kdWN0RGVyaXZhdGlv\nbltdIGdldFByb2R1Y3REZXJpdmF0aW9ucygpIHsKICAgICAgICByZXR1cm4g\nX2Rlcml2YXRpb25zOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRo\nZSByZWNvZ25pemVkIHByZWZpeGVzIGZvciBjb25maWd1cmF0aW9uIHByb3Bl\ncnRpZXMuCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0aWMgU3RyaW5nW10gZ2V0\nQ29uZmlndXJhdGlvblByZWZpeGVzKCkgewogICAgICAgIHJldHVybiBfcHJl\nZml4ZXM7CiAgICB9CgogICAgLyoqCiAgICAgKiBTZXQgdGhlIGNvbmZpZ3Vy\nYXRpb24gcHJlZml4IGFycmF5LiBUaGlzIGlzIHBhY2thZ2UtdmlzaWJsZSBm\nb3IgCiAgICAgKiB0ZXN0aW5nIHB1cnBvc2VzLgogICAgICogCiAgICAgKiBA\nc2luY2UgMC45LjcKICAgICAqLwogICAgc3RhdGljIHZvaWQgc2V0Q29uZmln\ndXJhdGlvblByZWZpeGVzKFN0cmluZ1tdIHByZWZpeGVzKSB7CiAgICAgICAg\nX3ByZWZpeGVzID0gcHJlZml4ZXM7CiAgICB9CiAgICAKICAgIC8qKgogICAg\nICogRGV0ZXJtaW5lIHRoZSBmdWxsIGtleSBuYW1lIGZvciA8Y29kZT5rZXk8\nL2NvZGU+LCBnaXZlbiB0aGUgcmVnaXN0ZXJlZAogICAgICogcHJlZml4ZXMg\nYW5kIHRoZSBlbnRyaWVzIGluIDxjb2RlPm1hcDwvY29kZT4uIFRoaXMgbWV0\naG9kCiAgICAgKiBjb21wdXRlcyB0aGUgYXBwcm9wcmlhdGUgY29uZmlndXJh\ndGlvbiBwcmVmaXggdG8gdXNlIGJ5IGxvb2tpbmcgCiAgICAgKiB0aHJvdWdo\nIDxjb2RlPm1hcDwvY29kZT4gZm9yIGEga2V5IHN0YXJ0aW5nIHdpdGggYW55\nIG9mIHRoZSBrbm93bgogICAgICogY29uZmlndXJhdGlvbiBwcmVmaXhlcyBh\nbmQgZW5kaW5nIHdpdGggPGNvZGU+a2V5PC9jb2RlPiBhbmQsIGlmIGEKICAg\nICAqIHZhbHVlIGlzIGZvdW5kLCB1c2luZyB0aGUgcHJlZml4IG9mIHRoYXQg\na2V5LiBPdGhlcndpc2UsIGl0IHVzZXMKICAgICAqIHRoZSBmaXJzdCByZWdp\nc3RlcmVkIHByZWZpeC4gCiAgICAgKiAKICAgICAqIEBzaW5jZSAwLjkuNwog\nICAgICovCiAgICBwdWJsaWMgc3RhdGljIFN0cmluZyBnZXRDb25maWd1cmF0\naW9uS2V5KFN0cmluZyBwYXJ0aWFsS2V5LCBNYXAgbWFwKSB7CiAgICAgICAg\nU3RyaW5nIGZpcnN0S2V5ID0gbnVsbDsKICAgICAgICBmb3IgKGludCBpID0g\nMDsgbWFwICE9IG51bGwgJiYgaSA8IF9wcmVmaXhlcy5sZW5ndGg7IGkrKykg\newogICAgICAgICAgICBTdHJpbmcgZnVsbEtleSA9IF9wcmVmaXhlc1tpXSAr\nICIuIiArIHBhcnRpYWxLZXk7CiAgICAgICAgICAgIGlmIChtYXAuY29udGFp\nbnNLZXkoZnVsbEtleSkpIHsKICAgICAgICAgICAgICAgIGlmIChmaXJzdEtl\neSA9PSBudWxsKSAKICAgICAgICAgICAgICAgICAgICBmaXJzdEtleSA9IGZ1\nbGxLZXk7CiAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAg\nICAgICAvLyBpZiB3ZSd2ZSBhbHJlYWR5IGZvdW5kIGEgcHJvcGVydHkgd2l0\naCBhIHByZXZpb3VzIAogICAgICAgICAgICAgICAgICAgIC8vIHByZWZpeCwg\ndGhlbiB0aGlzIGlzIGEgY29sbGlzaW9uLgogICAgICAgICAgICAgICAgICAg\nIHRocm93IG5ldyBJbGxlZ2FsU3RhdGVFeGNlcHRpb24oX2xvYy5nZXQoCiAg\nICAgICAgICAgICAgICAgICAgICAgICJkdXAtd2l0aC1kaWZmZXJlbnQtcHJl\nZml4ZXMiLCBmaXJzdEtleSwgZnVsbEtleSkKICAgICAgICAgICAgICAgICAg\nICAgICAgLmdldE1lc3NhZ2UoKSk7CiAgICAgICAgICAgICAgICB9CiAgICAg\nICAgICAgIH0KICAgICAgICB9CiAgICAgICAgCiAgICAgICAgaWYgKGZpcnN0\nS2V5ID09IG51bGwpCiAgICAgICAgICAgIHJldHVybiBfcHJlZml4ZXNbMF0g\nKyAiLiIgKyBwYXJ0aWFsS2V5OwogICAgICAgIGVsc2UKICAgICAgICAgICAg\ncmV0dXJuIGZpcnN0S2V5OwogICAgfQoKICAgIC8qKgogICAgICogQXBwbHkg\ne0BsaW5rIFByb2R1Y3REZXJpdmF0aW9uI2JlZm9yZUNvbmZpZ3VyYXRpb25D\nb25zdHJ1Y3R9IGNhbGxiYWNrcwogICAgICogdG8gdGhlIHRoZSBnaXZlbiBp\nbnN0YW5jZS4gRXhjZXB0aW9ucyBvdGhlciB0aGFuIGZhdGFsCiAgICAgKiB7\nQGxpbmsgQm9vdHN0cmFwRXhjZXB0aW9ufSBhcmUgc3dhbGxvd2VkLgogICAg\nICovCiAgICBwdWJsaWMgc3RhdGljIHZvaWQgYmVmb3JlQ29uZmlndXJhdGlv\nbkNvbnN0cnVjdChDb25maWd1cmF0aW9uUHJvdmlkZXIgY3ApIHsKICAgICAg\nICBmb3IgKGludCBpID0gMDsgaSA8IF9kZXJpdmF0aW9ucy5sZW5ndGg7IGkr\nKykgewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgX2Rlcml2\nYXRpb25zW2ldLmJlZm9yZUNvbmZpZ3VyYXRpb25Db25zdHJ1Y3QoY3ApOwog\nICAgICAgICAgICB9IGNhdGNoIChCb290c3RyYXBFeGNlcHRpb24gYmUpIHsK\nICAgICAgICAgICAgCWlmIChiZS5pc0ZhdGFsKCkpCiAgICAgICAgICAgIAkJ\ndGhyb3cgYmU7CiAgICAgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7\nCiAgICAgICAgICAgICAgICAvLyBjYW4ndCBsb2c7IG5vIGNvbmZpZ3VyYXRp\nb24geWV0CiAgICAgICAgICAgICAgICBlLnByaW50U3RhY2tUcmFjZSgpOwog\nICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICog\nQXBwbHkge0BsaW5rIFByb2R1Y3REZXJpdmF0aW9uI2JlZm9yZUNvbmZpZ3Vy\nYXRpb25Mb2FkfSBjYWxsYmFja3MKICAgICAqIHRvIHRoZSB0aGUgZ2l2ZW4g\naW5zdGFuY2UuIEV4Y2VwdGlvbnMgb3RoZXIgdGhhbiBmYXRhbAogICAgICog\ne0BsaW5rIEJvb3RzdHJhcEV4Y2VwdGlvbn0gYXJlIHN3YWxsb3dlZC4KICAg\nICAqLwogICAgcHVibGljIHN0YXRpYyB2b2lkIGJlZm9yZUNvbmZpZ3VyYXRp\nb25Mb2FkKENvbmZpZ3VyYXRpb24gY29uZikgewogICAgICAgIGZvciAoaW50\nIGkgPSAwOyBpIDwgX2Rlcml2YXRpb25zLmxlbmd0aDsgaSsrKSB7CiAgICAg\nICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBfZGVyaXZhdGlvbnNbaV0u\nYmVmb3JlQ29uZmlndXJhdGlvbkxvYWQoY29uZik7CiAgICAgICAgICAgIH0g\nY2F0Y2ggKEJvb3RzdHJhcEV4Y2VwdGlvbiBiZSkgewogICAgICAgICAgICAJ\naWYgKGJlLmlzRmF0YWwoKSkKICAgICAgICAgICAgCQl0aHJvdyBiZTsKICAg\nICAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAg\nICAgIC8vIGxvZ2dpbmcgbm90IGNvbmZpZ3VyZWQgeWV0CiAgICAgICAgICAg\nICAgICBlLnByaW50U3RhY2tUcmFjZSgpOwogICAgICAgICAgICB9CiAgICAg\nICAgfQogICAgfQoKICAgIC8qKgogICAgICogQXBwbHkge0BsaW5rIFByb2R1\nY3REZXJpdmF0aW9uI2FmdGVyU3BlY2lmaWNhdGlvblNldH0gY2FsbGJhY2tz\nCiAgICAgKiB0byB0aGUgdGhlIGdpdmVuIGluc3RhbmNlLiBFeGNlcHRpb25z\nIG90aGVyIHRoYW4gZmF0YWwKICAgICAqIHtAbGluayBCb290c3RyYXBFeGNl\ncHRpb259IGFyZSBzd2FsbG93ZWQuCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0\naWMgdm9pZCBhZnRlclNwZWNpZmljYXRpb25TZXQoQ29uZmlndXJhdGlvbiBj\nb25mKSB7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBfZGVyaXZhdGlv\nbnMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAg\nICAgICAgIF9kZXJpdmF0aW9uc1tpXS5hZnRlclNwZWNpZmljYXRpb25TZXQo\nY29uZik7CiAgICAgICAgICAgIH0gY2F0Y2ggKEJvb3RzdHJhcEV4Y2VwdGlv\nbiBiZSkgewogICAgICAgICAgICAJaWYgKGJlLmlzRmF0YWwoKSkKICAgICAg\nICAgICAgCQl0aHJvdyBiZTsKICAgICAgICAgICAgfSBjYXRjaCAoRXhjZXB0\naW9uIGUpIHsKICAgICAgICAgICAgICAgIC8vIGxvZ2dpbmcgbm90IGNvbmZp\nZ3VyZWQgeWV0CiAgICAgICAgICAgICAgICBlLnByaW50U3RhY2tUcmFjZSgp\nOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAg\nICogQ2FsbGVkIGFzIHRoZSBmaXJzdCBzdGVwIG9mIGEgQ29uZmlndXJhdGlv\nbidzIGNsb3NlKCkgbWV0aG9kLiAKICAgICAqIEV4Y2VwdGlvbnMgYXJlIHN3\nYWxsb3dlZC4KICAgICAqIAogICAgICogQHNpbmNlIDAuOS43CiAgICAgKi8K\nICAgIHB1YmxpYyBzdGF0aWMgdm9pZCBiZWZvcmVDbG9zZShDb25maWd1cmF0\naW9uIGNvbmYpIHsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IF9kZXJp\ndmF0aW9ucy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICB0cnkgewogICAg\nICAgICAgICAgICAgX2Rlcml2YXRpb25zW2ldLmJlZm9yZUNvbmZpZ3VyYXRp\nb25DbG9zZShjb25mKTsKICAgICAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9u\nIGUpIHsKICAgICAgICAgICAgICAgIGNvbmYuZ2V0Q29uZmlndXJhdGlvbkxv\nZygpLndhcm4oX2xvYy5nZXQoImJlZm9yZS1jbG9zZS1leCIpLCBlKTsKICAg\nICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIExv\nYWQgdGhlIGdpdmVuIGdpdmVuIHJlc291cmNlLCBvciByZXR1cm4gZmFsc2Ug\naWYgaXQgaXMgbm90IGEgcmVzb3VyY2UKICAgICAqIHRoaXMgcHJvdmlkZXIg\ndW5kZXJzdGFuZHMuIFRoZSBnaXZlbiBjbGFzcyBsb2FkZXIgbWF5IGJlIG51\nbGwuCiAgICAgKgogICAgICogQHBhcmFtIGFuY2hvciBvcHRpb25hbCBuYW1l\nZCBhbmNob3Igd2l0aGluIGEgbXVsdGlwbGUtY29uZmlndXJhdGlvbgogICAg\nICogcmVzb3VyY2UKICAgICAqLwogICAgcHVibGljIHN0YXRpYyBDb25maWd1\ncmF0aW9uUHJvdmlkZXIgbG9hZChTdHJpbmcgcmVzb3VyY2UsIFN0cmluZyBh\nbmNob3IsIAogICAgICAgIENsYXNzTG9hZGVyIGxvYWRlcikgewogICAgICAg\nIGlmIChTdHJpbmdVdGlscy5pc0VtcHR5KHJlc291cmNlKSkKICAgICAgICAg\nICAgcmV0dXJuIG51bGw7CiAgICAgICAgaWYgKGxvYWRlciA9PSBudWxsKQog\nICAgICAgICAgICBsb2FkZXIgPSAoQ2xhc3NMb2FkZXIpIEFjY2Vzc0NvbnRy\nb2xsZXIuZG9Qcml2aWxlZ2VkKAogICAgICAgICAgICAgICAgSjJEb1ByaXZI\nZWxwZXIuZ2V0Q29udGV4dENsYXNzTG9hZGVyQWN0aW9uKCkpOwogICAgICAg\nIENvbmZpZ3VyYXRpb25Qcm92aWRlciBwcm92aWRlciA9IG51bGw7CiAgICAg\nICAgU3RyaW5nQnVmZmVyIGVycnMgPSBudWxsOwogICAgICAgIC8vIG1vc3Qg\nc3BlY2lmaWMgdG8gbGVhc3QKICAgICAgICBmb3IgKGludCBpID0gX2Rlcml2\nYXRpb25zLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7CiAgICAgICAgICAg\nIHRyeSB7CiAgICAgICAgICAgICAgICBwcm92aWRlciA9IF9kZXJpdmF0aW9u\nc1tpXS5sb2FkKHJlc291cmNlLCBhbmNob3IsIGxvYWRlcik7CiAgICAgICAg\nICAgICAgICBpZiAocHJvdmlkZXIgIT0gbnVsbCkKICAgICAgICAgICAgICAg\nICAgICByZXR1cm4gcHJvdmlkZXI7CiAgICAgICAgICAgIH0gY2F0Y2ggKFRo\ncm93YWJsZSB0KSB7CiAgICAgICAgICAgICAgICBlcnJzID0gKGVycnMgPT0g\nbnVsbCkgPyBuZXcgU3RyaW5nQnVmZmVyKCkgOiBlcnJzLmFwcGVuZCgiXG4i\nKTsKICAgICAgICAgICAgICAgIGVycnMuYXBwZW5kKF9kZXJpdmF0aW9uc1tp\nXS5nZXRDbGFzcygpLmdldE5hbWUoKSArICI6IiArIHQpOwogICAgICAgICAg\nICB9CiAgICAgICAgfQogICAgICAgIHJlcG9ydEVycm9ycyhlcnJzLCByZXNv\ndXJjZSk7CiAgICAgICAgdGhyb3cgbmV3IE1pc3NpbmdSZXNvdXJjZUV4Y2Vw\ndGlvbihyZXNvdXJjZSwgCiAgICAgICAgICAgIFByb2R1Y3REZXJpdmF0aW9u\ncy5jbGFzcy5nZXROYW1lKCksIHJlc291cmNlKTsKICAgIH0KCiAgICAvKioK\nICAgICAqIExvYWQgZ2l2ZW4gZmlsZSwgb3IgcmV0dXJuIGZhbHNlIGlmIGl0\nIGlzIG5vdCBhIGZpbGUgdGhpcyBwcm92aWRlcgogICAgICogdW5kZXJzdGFu\nZHMuCiAgICAgKgogICAgICogQHBhcmFtIGFuY2hvciBvcHRpb25hbCBuYW1l\nZCBhbmNob3Igd2l0aGluIGEgbXVsdGlwbGUtY29uZmlndXJhdGlvbiBmaWxl\nCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0aWMgQ29uZmlndXJhdGlvblByb3Zp\nZGVyIGxvYWQoRmlsZSBmaWxlLCBTdHJpbmcgYW5jaG9yLCAKICAgICAgICBD\nbGFzc0xvYWRlciBsb2FkZXIpIHsKICAgICAgICBpZiAoZmlsZSA9PSBudWxs\nKQogICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICBpZiAobG9hZGVy\nID09IG51bGwpCiAgICAgICAgICAgIGxvYWRlciA9IChDbGFzc0xvYWRlcikg\nQWNjZXNzQ29udHJvbGxlci5kb1ByaXZpbGVnZWQoCiAgICAgICAgICAgICAg\nICBKMkRvUHJpdkhlbHBlci5nZXRDb250ZXh0Q2xhc3NMb2FkZXJBY3Rpb24o\nKSk7CiAgICAgICAgQ29uZmlndXJhdGlvblByb3ZpZGVyIHByb3ZpZGVyID0g\nbnVsbDsKICAgICAgICBTdHJpbmdCdWZmZXIgZXJycyA9IG51bGw7CiAgICAg\nICAgLy8gbW9zdCBzcGVjaWZpYyB0byBsZWFzdAogICAgICAgIGZvciAoaW50\nIGkgPSBfZGVyaXZhdGlvbnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHsK\nICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIHByb3ZpZGVyID0g\nX2Rlcml2YXRpb25zW2ldLmxvYWQoZmlsZSwgYW5jaG9yKTsKICAgICAgICAg\nICAgICAgIGlmIChwcm92aWRlciAhPSBudWxsKQogICAgICAgICAgICAgICAg\nICAgIHJldHVybiBwcm92aWRlcjsKICAgICAgICAgICAgfSBjYXRjaCAoVGhy\nb3dhYmxlIHQpIHsKICAgICAgICAgICAgICAgIGVycnMgPSAoZXJycyA9PSBu\ndWxsKSA/IG5ldyBTdHJpbmdCdWZmZXIoKSA6IGVycnMuYXBwZW5kKCJcbiIp\nOwogICAgICAgICAgICAgICAgZXJycy5hcHBlbmQoX2Rlcml2YXRpb25zW2ld\nLmdldENsYXNzKCkuZ2V0TmFtZSgpICsgIjoiICsgdCk7CiAgICAgICAgICAg\nIH0KICAgICAgICB9CiAgICAgICAgU3RyaW5nIGFQYXRoID0gKFN0cmluZykg\nQWNjZXNzQ29udHJvbGxlci5kb1ByaXZpbGVnZWQoCiAgICAgICAgICAgIEoy\nRG9Qcml2SGVscGVyLmdldEFic29sdXRlUGF0aEFjdGlvbihmaWxlKSk7CiAg\nICAgICAgcmVwb3J0RXJyb3JzKGVycnMsIGFQYXRoKTsKICAgICAgICB0aHJv\ndyBuZXcgTWlzc2luZ1Jlc291cmNlRXhjZXB0aW9uKGFQYXRoLCAKICAgICAg\nICAgICAgUHJvZHVjdERlcml2YXRpb25zLmNsYXNzLmdldE5hbWUoKSwgYVBh\ndGgpOwogICAgfQogICAKICAgIC8qKgogICAgICogUmV0dXJuIGEge0BsaW5r\nIENvbmZpZ3VyYXRpb25Qcm92aWRlcn0gdGhhdCBoYXMgcGFyc2VkIHN5c3Rl\nbSBkZWZhdWx0cy4KICAgICAqLwogICAgcHVibGljIHN0YXRpYyBDb25maWd1\ncmF0aW9uUHJvdmlkZXIgbG9hZERlZmF1bHRzKENsYXNzTG9hZGVyIGxvYWRl\ncikgewogICAgICAgIHJldHVybiBsb2FkKGxvYWRlciwgZmFsc2UpOwogICAg\nfQoKICAgIC8qKgogICAgICogUmV0dXJuIGEge0BsaW5rIENvbmZpZ3VyYXRp\nb25Qcm92aWRlcn0gdGhhdCBoYXMgcGFyc2VkIHN5c3RlbSBnbG9iYWxzLgog\nICAgICovCiAgICBwdWJsaWMgc3RhdGljIENvbmZpZ3VyYXRpb25Qcm92aWRl\nciBsb2FkR2xvYmFscyhDbGFzc0xvYWRlciBsb2FkZXIpIHsKICAgICAgICBy\nZXR1cm4gbG9hZChsb2FkZXIsIHRydWUpOwogICAgfQogICAgICAgICAgICAK\nICAgIC8qKgogICAgICogTG9hZCBhIGJ1aWx0LWluIHJlc291cmNlIGxvY2F0\naW9uLgogICAgICovCiAgICBwcml2YXRlIHN0YXRpYyBDb25maWd1cmF0aW9u\nUHJvdmlkZXIgbG9hZChDbGFzc0xvYWRlciBsb2FkZXIsIAogICAgICAgYm9v\nbGVhbiBnbG9iYWxzKSB7CiAgICAgICAgaWYgKGxvYWRlciA9PSBudWxsKQog\nICAgICAgICAgICBsb2FkZXIgPSAoQ2xhc3NMb2FkZXIpIEFjY2Vzc0NvbnRy\nb2xsZXIuZG9Qcml2aWxlZ2VkKAogICAgICAgICAgICAgICAgSjJEb1ByaXZI\nZWxwZXIuZ2V0Q29udGV4dENsYXNzTG9hZGVyQWN0aW9uKCkpOwogICAgICAg\nIAogICAgICAgIENvbmZpZ3VyYXRpb25Qcm92aWRlciBwcm92aWRlciA9IG51\nbGw7CiAgICAgICAgU3RyaW5nQnVmZmVyIGVycnMgPSBudWxsOwogICAgICAg\nIFN0cmluZyB0eXBlID0gKGdsb2JhbHMpID8gImdsb2JhbHMiIDogImRlZmF1\nbHRzIjsKICAgICAgICAvLyBtb3N0IHNwZWNpZmljIHRvIGxlYXN0CiAgICAg\nICAgZm9yIChpbnQgaSA9IF9kZXJpdmF0aW9ucy5sZW5ndGggLSAxOyBpID49\nIDA7IGktLSkgewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAg\ncHJvdmlkZXIgPSAoZ2xvYmFscykgPyBfZGVyaXZhdGlvbnNbaV0ubG9hZEds\nb2JhbHMobG9hZGVyKSAKICAgICAgICAgICAgICAgICAgICA6IF9kZXJpdmF0\naW9uc1tpXS5sb2FkRGVmYXVsdHMobG9hZGVyKTsKICAgICAgICAgICAgICAg\nIGlmIChwcm92aWRlciAhPSBudWxsKQogICAgICAgICAgICAgICAgICAgcmV0\ndXJuIHByb3ZpZGVyOwogICAgICAgICAgICB9IGNhdGNoIChUaHJvd2FibGUg\ndCkgewogICAgICAgICAgICAgICAgZXJycyA9IChlcnJzID09IG51bGwpID8g\nbmV3IFN0cmluZ0J1ZmZlcigpIDogZXJycy5hcHBlbmQoIlxuIik7CiAgICAg\nICAgICAgICAgICBlcnJzLmFwcGVuZChfZGVyaXZhdGlvbnNbaV0uZ2V0Q2xh\nc3MoKS5nZXROYW1lKCkgKyAiOiIgKyB0KTsKICAgICAgICAgICAgfQogICAg\nICAgIH0KICAgICAgICByZXBvcnRFcnJvcnMoZXJycywgdHlwZSk7CiAgICAg\nICAgcmV0dXJuIG51bGw7CiAgICB9CiAKICAgIC8qKgogICAgICogVGhyb3du\nIHByb3BlciBleGNlcHRpb24gZm9yIGdpdmVuIGVycm9ycy4KICAgICAqLwog\nICAgcHJpdmF0ZSBzdGF0aWMgdm9pZCByZXBvcnRFcnJvcnMoU3RyaW5nQnVm\nZmVyIGVycnMsIFN0cmluZyByZXNvdXJjZSkgewogICAgICAgIGlmIChlcnJz\nID09IG51bGwpCiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB0aHJvdyBu\nZXcgTWlzc2luZ1Jlc291cmNlRXhjZXB0aW9uKGVycnMudG9TdHJpbmcoKSwg\nCiAgICAgICAgICAgIFByb2R1Y3REZXJpdmF0aW9ucy5jbGFzcy5nZXROYW1l\nKCksIHJlc291cmNlKTsKICAgIH0KCiAgICAvKioKICAgICAqIENvbXBhcmUg\ne0BsaW5rIFByb2R1Y3REZXJpdmF0aW9ufXMuCiAgICAgKi8KICAgIHByaXZh\ndGUgc3RhdGljIGNsYXNzIFByb2R1Y3REZXJpdmF0aW9uQ29tcGFyYXRvcgog\nICAgICAgIGltcGxlbWVudHMgQ29tcGFyYXRvciB7CgogICAgICAgIHB1Ymxp\nYyBpbnQgY29tcGFyZShPYmplY3QgbzEsIE9iamVjdCBvMikgewogICAgICAg\nICAgICBpbnQgdHlwZTEgPSAoKFByb2R1Y3REZXJpdmF0aW9uKSBvMSkuZ2V0\nVHlwZSgpOwogICAgICAgICAgICBpbnQgdHlwZTIgPSAoKFByb2R1Y3REZXJp\ndmF0aW9uKSBvMikuZ2V0VHlwZSgpOwogICAgICAgICAgICBpZiAodHlwZTEg\nIT0gdHlwZTIpCiAgICAgICAgICAgICAgICByZXR1cm4gdHlwZTEgLSB0eXBl\nMjsKCiAgICAgICAgICAgIC8vIGFyYml0cmFyeSBidXQgY29uc2lzdGVudCBv\ncmRlcgogICAgICAgICAgICByZXR1cm4gbzEuZ2V0Q2xhc3MoKS5nZXROYW1l\nKCkuY29tcGFyZVRvKG8yLmdldENsYXNzKCkuCiAgICAgICAgICAgICAgICBn\nZXROYW1lKCkpOwoJCX0KCX0KCiAgICAvKioKICAgICAqIFByaW50cyBwcm9k\ndWN0IGRlcml2YXRpb24gaW5mb3JtYXRpb24uCiAgICAgKi8KICAgIHB1Ymxp\nYyBzdGF0aWMgdm9pZCBtYWluKFN0cmluZ1tdIGFyZ3MpIHsKICAgICAgICBT\neXN0ZW0uZXJyLnByaW50bG4oZGVyaXZhdGlvbkVycm9yc1RvU3RyaW5nKCkp\nOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIGEgbWVzc2FnZSBhYm91\ndCB0aGUgc3RhdHVzIG9mIGVhY2ggcHJvZHVjdCBkZXJpdmF0aW9uLgogICAg\nICovCiAgICBwcml2YXRlIHN0YXRpYyBTdHJpbmcgZGVyaXZhdGlvbkVycm9y\nc1RvU3RyaW5nKCkgewogICAgICAgIFN0cmluZ0J1ZmZlciBidWYgPSBuZXcg\nU3RyaW5nQnVmZmVyKCk7CiAgICAgICAgYnVmLmFwcGVuZCgiUHJvZHVjdERl\ncml2YXRpb25zOiAiKS5hcHBlbmQoX2Rlcml2YXRpb25OYW1lcy5sZW5ndGgp\nOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgX2Rlcml2YXRpb25OYW1l\ncy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBidWYuYXBwZW5kKCJcbiIp\nLmFwcGVuZChpICsgMSkuYXBwZW5kKCIuICIpLgogICAgICAgICAgICAgICAg\nYXBwZW5kKF9kZXJpdmF0aW9uTmFtZXNbaV0pLmFwcGVuZCgiOiAiKTsKICAg\nICAgICAgICAgaWYgKF9kZXJpdmF0aW9uRXJyb3JzW2ldID09IG51bGwpCiAg\nICAgICAgICAgICAgICBidWYuYXBwZW5kKCJPSyIpOwogICAgICAgICAgICBl\nbHNlCiAgICAgICAgICAgICAgICBidWYuYXBwZW5kKF9kZXJpdmF0aW9uRXJy\nb3JzW2ldLnRvU3RyaW5nKCkpOwogICAgICAgIH0KICAgICAgICByZXR1cm4g\nYnVmLnRvU3RyaW5nKCk7CiAgICB9Cn0KCg==\n","encoding":"base64"}

