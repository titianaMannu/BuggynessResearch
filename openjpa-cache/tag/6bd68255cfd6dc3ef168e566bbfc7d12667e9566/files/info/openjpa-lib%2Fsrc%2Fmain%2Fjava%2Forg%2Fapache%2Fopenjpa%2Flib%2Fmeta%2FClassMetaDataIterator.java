{"sha":"789e89905c2f6ebc7dc7bc37d2a79e926548bb37","node_id":"MDQ6QmxvYjIwNjM2NDo3ODllODk5MDVjMmY2ZWJjN2RjN2JjMzdkMmE3OWU5MjY1NDhiYjM3","size":7269,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/789e89905c2f6ebc7dc7bc37d2a79e926548bb37","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEubGliLm1ldGE7CgppbXBvcnQg\namF2YS5pby5GaWxlOwppbXBvcnQgamF2YS5pby5JT0V4Y2VwdGlvbjsKaW1w\nb3J0IGphdmEuaW8uSW5wdXRTdHJlYW07CmltcG9ydCBqYXZhLm5ldC5VUkw7\nCmltcG9ydCBqYXZhLm5ldC5VUkxEZWNvZGVyOwppbXBvcnQgamF2YS5zZWN1\ncml0eS5BY2Nlc3NDb250cm9sbGVyOwppbXBvcnQgamF2YS5zZWN1cml0eS5Q\ncml2aWxlZ2VkQWN0aW9uRXhjZXB0aW9uOwppbXBvcnQgamF2YS51dGlsLkFy\ncmF5TGlzdDsKaW1wb3J0IGphdmEudXRpbC5Db2xsZWN0aW9uczsKaW1wb3J0\nIGphdmEudXRpbC5FbnVtZXJhdGlvbjsKaW1wb3J0IGphdmEudXRpbC5MaXN0\nOwppbXBvcnQgamF2YS51dGlsLk5vU3VjaEVsZW1lbnRFeGNlcHRpb247Cgpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51dGlsLkoyRG9Qcml2SGVs\ncGVyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51dGlsLk11bHRp\nQ2xhc3NMb2FkZXI7CmltcG9ydCBzZXJwLnV0aWwuU3RyaW5nczsKCi8qKgog\nKiBJdGVyYXRvciBvdmVyIGFsbCBtZXRhZGF0YSByZXNvdXJjZXMgdGhhdCBt\naWdodCBjb250YWluIHRoZQogKiBtZXRhZGF0YSBmb3IgYSBnaXZlbiBjbGFz\ncywgc3RhcnRpbmcgd2l0aCB0aGUgbW9zdCBnZW5lcmFsLiBBc3N1bWVzIHRo\nYXQKICogcGFja2FnZS1sZXZlbCByZXNvdXJjZXMgYXJlIG5hbWVkICJwYWNr\nYWdlLiZsdDtzdWZmaXgmZ3Q7Ii4KICoKICogQGF1dGhvciBBYmUgV2hpdGUK\nICogQG5vamF2YWRvYwogKi8KcHVibGljIGNsYXNzIENsYXNzTWV0YURhdGFJ\ndGVyYXRvciBpbXBsZW1lbnRzIE1ldGFEYXRhSXRlcmF0b3IgewoKICAgIHBy\naXZhdGUgZmluYWwgQ2xhc3NMb2FkZXIgX2xvYWRlcjsKICAgIHByaXZhdGUg\nZmluYWwgTGlzdCBfbG9jczsKICAgIHByaXZhdGUgaW50IF9sb2MgPSAtMTsK\nICAgIHByaXZhdGUgZmluYWwgTGlzdCBfdXJscyA9IG5ldyBBcnJheUxpc3Qo\nMyk7CiAgICBwcml2YXRlIGludCBfdXJsID0gLTE7CgogICAgLyoqCiAgICAg\nKiBDb25zdHJ1Y3Rvcjsgc3VwcGx5IHRoZSBjbGFzcyB3aG9zZSBtZXRhZGF0\nYSB0byBmaW5kLCB0aGUgc3VmZml4CiAgICAgKiBvZiBtZXRhZGF0YSBmaWxl\ncywgYW5kIHdoZXRoZXIgdG8gcGFyc2UgdG9wLWRvd24gb3IgYm90dG9tLXVw\nLgogICAgICovCiAgICBwdWJsaWMgQ2xhc3NNZXRhRGF0YUl0ZXJhdG9yKENs\nYXNzIGNscywgU3RyaW5nIHN1ZmZpeCwgYm9vbGVhbiB0b3BEb3duKSB7CiAg\nICAgICAgdGhpcyhjbHMsIHN1ZmZpeCwgbnVsbCwgdG9wRG93bik7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBDb25zdHJ1Y3Rvcjsgc3VwcGx5IHRoZSBjbGFz\ncyB3aG9zZSBtZXRhZGF0YSB0byBmaW5kLCB0aGUgc3VmZml4CiAgICAgKiBv\nZiBtZXRhZGF0YSBmaWxlcywgYW5kIHdoZXRoZXIgdG8gcGFyc2UgdG9wLWRv\nd24gb3IgYm90dG9tLXVwLgogICAgICovCiAgICBwdWJsaWMgQ2xhc3NNZXRh\nRGF0YUl0ZXJhdG9yKENsYXNzIGNscywgU3RyaW5nIHN1ZmZpeCwgQ2xhc3NM\nb2FkZXIgbG9hZGVyLAogICAgICAgIGJvb2xlYW4gdG9wRG93bikgewogICAg\nICAgIC8vIHNraXAgY2xhc3NlcyB0aGF0IGNhbid0IGhhdmUgbWV0YWRhdGEK\nICAgICAgICBpZiAoY2xzICE9IG51bGwgJiYgKGNscy5pc1ByaW1pdGl2ZSgp\nCiAgICAgICAgICAgIHx8IGNscy5nZXROYW1lKCkuc3RhcnRzV2l0aCgiamF2\nYS4iKQogICAgICAgICAgICB8fCBjbHMuZ2V0TmFtZSgpLnN0YXJ0c1dpdGgo\nImphdmF4LiIpKSkgewogICAgICAgICAgICBfbG9hZGVyID0gbnVsbDsKICAg\nICAgICAgICAgX2xvY3MgPSBDb2xsZWN0aW9ucy5FTVBUWV9MSVNUOwogICAg\nICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBpZiAobG9hZGVy\nID09IG51bGwpIHsKICAgICAgICAgICAgTXVsdGlDbGFzc0xvYWRlciBtdWx0\naSA9IChNdWx0aUNsYXNzTG9hZGVyKSBBY2Nlc3NDb250cm9sbGVyCiAgICAg\nICAgICAgICAgICAuZG9Qcml2aWxlZ2VkKEoyRG9Qcml2SGVscGVyLm5ld011\nbHRpQ2xhc3NMb2FkZXJBY3Rpb24oKSk7CiAgICAgICAgICAgIG11bHRpLmFk\nZENsYXNzTG9hZGVyKG11bHRpLlNZU1RFTV9MT0FERVIpOwogICAgICAgICAg\nICBtdWx0aS5hZGRDbGFzc0xvYWRlcihtdWx0aS5USFJFQURfTE9BREVSKTsK\nICAgICAgICAgICAgbXVsdGkuYWRkQ2xhc3NMb2FkZXIoZ2V0Q2xhc3MoKS5n\nZXRDbGFzc0xvYWRlcigpKTsKICAgICAgICAgICAgaWYgKGNscyAhPSBudWxs\nKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBDbGFzc0xvYWRlciBj\nbHNMb2FkZXIgPSAoQ2xhc3NMb2FkZXIpCiAgICAgICAgICAgICAgICAgICAg\nQWNjZXNzQ29udHJvbGxlci5kb1ByaXZpbGVnZWQoCiAgICAgICAgICAgICAg\nICAgICAgICAgIEoyRG9Qcml2SGVscGVyLmdldENsYXNzTG9hZGVyQWN0aW9u\nKGNscykpOwogICAgICAgICAgICAgICAgaWYgKGNsc0xvYWRlciAhPSBudWxs\nKQogICAgICAgICAgICAgICAgICAgIG11bHRpLmFkZENsYXNzTG9hZGVyKGNs\nc0xvYWRlcik7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgbG9hZGVyID0g\nbXVsdGk7CiAgICAgICAgfQogICAgICAgIF9sb2FkZXIgPSBsb2FkZXI7Cgog\nICAgICAgIC8vIGNvbGxlY3QgdGhlIHNldCBvZiBhbGwgcG9zc2libGUgbWV0\nYWRhdGEgbG9jYXRpb25zOyBzdGFydCB3aXRoCiAgICAgICAgLy8gc3lzdGVt\nIGxvY2F0aW9ucwogICAgICAgIF9sb2NzID0gbmV3IEFycmF5TGlzdCgpOwog\nICAgICAgIF9sb2NzLmFkZCgiTUVUQS1JTkYvcGFja2FnZSIgKyBzdWZmaXgp\nOwogICAgICAgIF9sb2NzLmFkZCgiV0VCLUlORi9wYWNrYWdlIiArIHN1ZmZp\neCk7CiAgICAgICAgX2xvY3MuYWRkKCJwYWNrYWdlIiArIHN1ZmZpeCk7Cgog\nICAgICAgIC8vIHB1dCB0aGlzIGxlZ2FjeSBsb2NhdGlvbiBhdCB0aGUgZW5k\nIHJlZ2FyZGxlc3Mgb2Ygd2hldGhlciB3ZSdyZQogICAgICAgIC8vIGdvaW5n\nIHRvcCBkb3duIG9yIGJvdHRvbSB1cCBzbyB3ZSBkb24ndCBoYXZlIHRvIHBh\ncnNlIGl0IGFzIG9mdGVuCiAgICAgICAgLy8gZHVyaW5nIHRlc3RpbmcKICAg\nICAgICBpZiAoIXRvcERvd24pCiAgICAgICAgICAgIF9sb2NzLmFkZCgic3lz\ndGVtIiArIHN1ZmZpeCk7CgogICAgICAgIGlmIChjbHMgIT0gbnVsbCkgewog\nICAgICAgICAgICAvLyBhbHNvIGNoZWNrOgogICAgICAgICAgICAvLyAxLiBm\nb3IgZWFjaCBwYWNrYWdlIGZyb20gdGhlIHRvcCBkb3duIHRvIGNscycgcGFj\na2FnZToKICAgICAgICAgICAgLy8gPHBhdGg+L3BhY2thZ2U8c3VmZml4Pgog\nICAgICAgICAgICAvLyA8cGF0aD4vPHBhY2thZ2UtbmFtZT48c3VmZml4PiAo\nbGVnYWN5IHN1cHBvcnQpCiAgICAgICAgICAgIC8vIDxwYXRoPi8uLi88cGFj\na2FnZS1uYW1lPjxzdWZmaXg+IChsZWdhY3kgc3VwcG9ydCkKICAgICAgICAg\nICAgLy8gMi4gPHBhdGg+LzxjbGFzcy1uYW1lPjxzdWZmaXg+CiAgICAgICAg\nICAgIFN0cmluZyBwa2cgPSBTdHJpbmdzLmdldFBhY2thZ2VOYW1lKGNscyku\ncmVwbGFjZSgnLicsICcvJyk7CiAgICAgICAgICAgIGlmIChwa2cubGVuZ3Ro\nKCkgPiAwKSB7CiAgICAgICAgICAgICAgICBpbnQgaWR4LCBzdGFydCA9IDA7\nCiAgICAgICAgICAgICAgICBTdHJpbmcgcGtnTmFtZSwgcGF0aCwgdXBQYXRo\nID0gIiI7CiAgICAgICAgICAgICAgICBkbyB7CiAgICAgICAgICAgICAgICAg\nICAgaWR4ID0gcGtnLmluZGV4T2YoJy8nLCBzdGFydCk7CiAgICAgICAgICAg\nICAgICAgICAgaWYgKGlkeCA9PSAtMSkgewogICAgICAgICAgICAgICAgICAg\nICAgICBwa2dOYW1lID0gKHN0YXJ0ID09IDApID8gcGtnIDogcGtnLnN1YnN0\ncmluZyhzdGFydCk7CiAgICAgICAgICAgICAgICAgICAgICAgIHBhdGggPSBw\na2cgKyAiLyI7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAg\nICAgICAgICAgICAgICAgICAgcGtnTmFtZSA9IHBrZy5zdWJzdHJpbmcoc3Rh\ncnQsIGlkeCk7CiAgICAgICAgICAgICAgICAgICAgICAgIHBhdGggPSBwa2cu\nc3Vic3RyaW5nKDAsIGlkeCArIDEpOwogICAgICAgICAgICAgICAgICAgIH0K\nCiAgICAgICAgICAgICAgICAgICAgX2xvY3MuYWRkKHBhdGggKyAicGFja2Fn\nZSIgKyBzdWZmaXgpOwogICAgICAgICAgICAgICAgICAgIF9sb2NzLmFkZChw\nYXRoICsgcGtnTmFtZSArIHN1ZmZpeCk7IC8vIGxlZ2FjeQogICAgICAgICAg\nICAgICAgICAgIF9sb2NzLmFkZCh1cFBhdGggKyBwa2dOYW1lICsgc3VmZml4\nKTsgLy8gbGVnYWN5CiAgICAgICAgICAgICAgICAgICAgaWYgKGlkeCA9PSAt\nMSkKICAgICAgICAgICAgICAgICAgICAgICAgX2xvY3MuYWRkKHBhdGggKyBT\ndHJpbmdzLmdldENsYXNzTmFtZShjbHMpICsgc3VmZml4KTsKCiAgICAgICAg\nICAgICAgICAgICAgc3RhcnQgPSBpZHggKyAxOwogICAgICAgICAgICAgICAg\nICAgIHVwUGF0aCA9IHBhdGg7CiAgICAgICAgICAgICAgICB9CiAgICAgICAg\nICAgICAgICB3aGlsZSAoaWR4ICE9IC0xKTsKICAgICAgICAgICAgfSBlbHNl\nIHsKICAgICAgICAgICAgICAgIC8vIDxjbGFzcy1uYW1lPjxzdWZmaXg+IGZv\nciB0b3AtbGV2ZWwgY2xhc3NlcwogICAgICAgICAgICAgICAgX2xvY3MuYWRk\nKGNscy5nZXROYW1lKCkgKyBzdWZmaXgpOwogICAgICAgICAgICB9CiAgICAg\nICAgfQogICAgICAgIGlmICh0b3BEb3duKQogICAgICAgICAgICBfbG9jcy5h\nZGQoInN5c3RlbSIgKyBzdWZmaXgpOyAvLyBsZWdhY3kKICAgICAgICBlbHNl\nCiAgICAgICAgICAgIENvbGxlY3Rpb25zLnJldmVyc2UoX2xvY3MpOwogICAg\nfQoKICAgIHB1YmxpYyBib29sZWFuIGhhc05leHQoKSB0aHJvd3MgSU9FeGNl\ncHRpb24gewogICAgICAgIEVudW1lcmF0aW9uIGU7CiAgICAgICAgd2hpbGUg\nKF91cmwgKyAxID49IF91cmxzLnNpemUoKSkgewogICAgICAgICAgICBpZiAo\nKytfbG9jID49IF9sb2NzLnNpemUoKSkKICAgICAgICAgICAgICAgIHJldHVy\nbiBmYWxzZTsKCiAgICAgICAgICAgIF91cmwgPSAtMTsKICAgICAgICAgICAg\nX3VybHMuY2xlYXIoKTsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAg\nICAgIGUgPSAoRW51bWVyYXRpb24pIEFjY2Vzc0NvbnRyb2xsZXIuZG9Qcml2\naWxlZ2VkKAogICAgICAgICAgICAgICAgICAgIEoyRG9Qcml2SGVscGVyLmdl\ndFJlc291cmNlc0FjdGlvbigKICAgICAgICAgICAgICAgICAgICAgICAgX2xv\nYWRlciwgKFN0cmluZykgX2xvY3MuZ2V0KF9sb2MpKSk7CiAgICAgICAgICAg\nIH0gY2F0Y2ggKFByaXZpbGVnZWRBY3Rpb25FeGNlcHRpb24gcGFlKSB7CiAg\nICAgICAgICAgICAgICB0aHJvdyAoSU9FeGNlcHRpb24pIHBhZS5nZXRFeGNl\ncHRpb24oKTsKICAgICAgICAgICAgfSAgICAKICAgICAgICAgICAgd2hpbGUg\nKGUuaGFzTW9yZUVsZW1lbnRzKCkpCiAgICAgICAgICAgICAgICBfdXJscy5h\nZGQoZS5uZXh0RWxlbWVudCgpKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJu\nIHRydWU7CiAgICB9CgogICAgcHVibGljIE9iamVjdCBuZXh0KCkgdGhyb3dz\nIElPRXhjZXB0aW9uIHsKICAgICAgICBpZiAoIWhhc05leHQoKSkKICAgICAg\nICAgICAgdGhyb3cgbmV3IE5vU3VjaEVsZW1lbnRFeGNlcHRpb24oKTsKICAg\nICAgICByZXR1cm4gX3VybHMuZ2V0KCsrX3VybCk7CiAgICB9CgogICAgcHVi\nbGljIElucHV0U3RyZWFtIGdldElucHV0U3RyZWFtKCkgdGhyb3dzIElPRXhj\nZXB0aW9uIHsKICAgICAgICBpZiAoX3VybCA9PSAtMSB8fCBfdXJsID49IF91\ncmxzLnNpemUoKSkKICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxTdGF0\nZUV4Y2VwdGlvbigpOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIHJldHVy\nbiAoSW5wdXRTdHJlYW0pIEFjY2Vzc0NvbnRyb2xsZXIuZG9Qcml2aWxlZ2Vk\nKAogICAgICAgICAgICAgICAgSjJEb1ByaXZIZWxwZXIub3BlblN0cmVhbUFj\ndGlvbigoVVJMKSBfdXJscy5nZXQoX3VybCkpKTsKICAgICAgICB9IGNhdGNo\nIChQcml2aWxlZ2VkQWN0aW9uRXhjZXB0aW9uIHBhZSkgewogICAgICAgICAg\nICB0aHJvdyAoSU9FeGNlcHRpb24pIHBhZS5nZXRFeGNlcHRpb24oKTsKICAg\nICAgICB9CiAgICB9CgogICAgcHVibGljIEZpbGUgZ2V0RmlsZSgpIHRocm93\ncyBJT0V4Y2VwdGlvbiB7CiAgICAgICAgaWYgKF91cmwgPT0gLTEgfHwgX3Vy\nbCA+PSBfdXJscy5zaXplKCkpCiAgICAgICAgICAgIHRocm93IG5ldyBJbGxl\nZ2FsU3RhdGVFeGNlcHRpb24oKTsKICAgICAgICBGaWxlIGZpbGUgPSBuZXcg\nRmlsZShVUkxEZWNvZGVyLmRlY29kZSgoKFVSTCkgX3VybHMuZ2V0KF91cmwp\nKS4KICAgICAgICAgICAgZ2V0RmlsZSgpKSk7CiAgICAgICAgcmV0dXJuICgo\nKEJvb2xlYW4pIEFjY2Vzc0NvbnRyb2xsZXIuZG9Qcml2aWxlZ2VkKAogICAg\nICAgICAgICBKMkRvUHJpdkhlbHBlci5leGlzdHNBY3Rpb24oZmlsZSkpKS5i\nb29sZWFuVmFsdWUoKSkgPyBmaWxlOm51bGw7CiAgICB9CgogICAgcHVibGlj\nIHZvaWQgY2xvc2UoKSB7CiAgICB9Cn0K\n","encoding":"base64"}

