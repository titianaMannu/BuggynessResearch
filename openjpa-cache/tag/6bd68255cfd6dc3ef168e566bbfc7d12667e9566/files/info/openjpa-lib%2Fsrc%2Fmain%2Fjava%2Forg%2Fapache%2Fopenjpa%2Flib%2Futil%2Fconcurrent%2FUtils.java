{"sha":"06bf5f3f95105b174a94279cf1f1824603c43826","node_id":"MDQ6QmxvYjIwNjM2NDowNmJmNWYzZjk1MTA1YjE3NGE5NDI3OWNmMWYxODI0NjAzYzQzODI2","size":14957,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/06bf5f3f95105b174a94279cf1f1824603c43826","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\nLyoKICogV3JpdHRlbiBieSBEYXdpZCBLdXJ6eW5pZWMsIGJhc2VkIG9uIGNv\nZGUgd3JpdHRlbiBieSBEb3VnIExlYSB3aXRoIGFzc2lzdGFuY2UKICogZnJv\nbSBtZW1iZXJzIG9mIEpDUCBKU1ItMTY2IEV4cGVydCBHcm91cC4gUmVsZWFz\nZWQgdG8gdGhlIHB1YmxpYyBkb21haW4sCiAqIGFzIGV4cGxhaW5lZCBhdCBo\ndHRwOi8vY3JlYXRpdmVjb21tb25zLm9yZy9saWNlbnNlcy9wdWJsaWNkb21h\naW4uCiAqIFRoYW5rcyB0byBDcmFpZyBNYXR0b2NrcyBmb3Igc3VnZ2VzdGlu\nZyB0byB1c2UgPGNvZGU+c3VuLm1pc2MuUGVyZjwvY29kZT4uCiAqLwoKcGFj\na2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuY29uY3VycmVudDsK\nCmltcG9ydCBqYXZhLmxhbmcucmVmbGVjdC5BcnJheTsKaW1wb3J0IGphdmEu\nc2VjdXJpdHkuQWNjZXNzQ29udHJvbGxlcjsKaW1wb3J0IGphdmEuc2VjdXJp\ndHkuUHJpdmlsZWdlZEFjdGlvbjsKaW1wb3J0IGphdmEudXRpbC5Db2xsZWN0\naW9uOwppbXBvcnQgamF2YS51dGlsLkl0ZXJhdG9yOwoKaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS5saWIudXRpbC5KMkRvUHJpdkhlbHBlcjsKCi8qKgog\nKiBUaGlzIGNsYXNzIGdyb3VwcyB0b2dldGhlciB0aGUgZnVuY3Rpb25hbGl0\neSBvZiBqYXZhLnV0aWwuY29uY3VycmVudCB0aGF0CiAqIGNhbm5vdCBiZSBm\ndWxseSBhbmQgcmVsaWFibHkgaW1wbGVtZW50ZWQgaW4gYmFja3BvcnQsIGJ1\ndCBmb3Igd2hpY2ggc29tZQogKiBmb3JtIG9mIGVtdWxhdGlvbiBpcyBwb3Nz\naWJsZS4KICogQ3VycmVudGx5LCB0aGlzIGNsYXNzIGNvbnRhaW5zIG1ldGhv\nZHMgcmVsYXRlZCB0byBuYW5vc2Vjb25kLXByZWNpc2lvbgogKiB0aW1pbmcs\nIHBhcnRpY3VsYXJseSB2aWEgdGhlIHtAbGluayAjbmFub1RpbWV9IG1ldGhv\nZC4gVG8gbWVhc3VyZSB0aW1lCiAqIGFjY3VyYXRlbHksIHRoaXMgbWV0aG9k\nIGJ5IGRlZmF1bHQgdXNlcyA8Y29kZT5qYXZhLnN1bi5QZXJmPC9jb2RlPiBv\nbgogKiBKREsxLjQuMiBhbmQgaXQgZmFsbHMgYmFjayB0byA8Y29kZT5TeXN0\nZW0uY3VycmVudFRpbWVNaWxsaXM8L2NvZGU+CiAqIG9uIGVhcmxpZXIgSkRL\ncy4KICoKICogQGF1dGhvciBEYXdpZCBLdXJ6eW5pZWMKICogQHZlcnNpb24g\nMS4wCiAqLwpwdWJsaWMgZmluYWwgY2xhc3MgVXRpbHMgewoKICAgIHByaXZh\ndGUgZmluYWwgc3RhdGljIE5hbm9UaW1lciBuYW5vVGltZXI7CiAgICBwcml2\nYXRlIGZpbmFsIHN0YXRpYyBTdHJpbmcgcHJvdmlkZXJQcm9wID0KICAgICAg\nICAiZWR1LmVtb3J5Lm1hdGhjcy5iYWNrcG9ydC5qYXZhLnV0aWwuY29uY3Vy\ncmVudC5OYW5vVGltZXJQcm92aWRlciI7CgogICAgc3RhdGljIHsKICAgICAg\nICBOYW5vVGltZXIgdGltZXIgPSBudWxsOwogICAgICAgIHRyeSB7CiAgICAg\nICAgICAgIFN0cmluZyBuYW5vVGltZXJDbGFzc05hbWUgPSAoU3RyaW5nKSBB\nY2Nlc3NDb250cm9sbGVyLmRvUHJpdmlsZWdlZCgKICAgICAgICAgICAgICAg\nIEoyRG9Qcml2SGVscGVyLmdldFByb3BlcnR5QWN0aW9uKHByb3ZpZGVyUHJv\ncCkpOyAKICAgICAgICAgICAgaWYgKG5hbm9UaW1lckNsYXNzTmFtZSAhPSBu\ndWxsKSB7CiAgICAgICAgICAgICAgICBDbGFzcyBjbHMgPSBDbGFzcy5mb3JO\nYW1lKG5hbm9UaW1lckNsYXNzTmFtZSk7CiAgICAgICAgICAgICAgICB0aW1l\nciA9IChOYW5vVGltZXIpICBBY2Nlc3NDb250cm9sbGVyLmRvUHJpdmlsZWdl\nZCgKICAgICAgICAgICAgICAgICAgICBKMkRvUHJpdkhlbHBlci5uZXdJbnN0\nYW5jZUFjdGlvbihjbHMpKTsgCiAgICAgICAgICAgIH0KICAgICAgICB9IGNh\ndGNoIChFeGNlcHRpb24gZSkgewogICAgICAgICAgICBTeXN0ZW0uZXJyLnBy\naW50bG4oCiAgICAgICAgICAgICAgICAiV0FSTklORzogdW5hYmxlIHRvIGxv\nYWQgdGhlIHN5c3RlbS1wcm9wZXJ0eS1kZWZpbmVkICIgKwogICAgICAgICAg\nICAgICAgICAgICJuYW5vdGltZSBwcm92aWRlcjsgc3dpdGNoaW5nIHRvIHRo\nZSBkZWZhdWx0Iik7CiAgICAgICAgICAgIGUucHJpbnRTdGFja1RyYWNlKCk7\nCiAgICAgICAgfQoKICAgICAgICBpZiAodGltZXIgPT0gbnVsbCkgewogICAg\nICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgdGltZXIgPSBuZXcgU3Vu\nUGVyZlByb3ZpZGVyKCk7CiAgICAgICAgICAgIH0gY2F0Y2ggKFRocm93YWJs\nZSBlKSB7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGlmICh0\naW1lciA9PSBudWxsKSB7CiAgICAgICAgICAgIHRpbWVyID0gbmV3IE1pbGxp\nc1Byb3ZpZGVyKCk7CiAgICAgICAgfQoKICAgICAgICBuYW5vVGltZXIgPSB0\naW1lcjsKICAgIH0KCiAgICBwcml2YXRlIFV0aWxzKCkgewogICAgfQoKICAg\nIC8qKgogICAgICogUmV0dXJucyB0aGUgY3VycmVudCB2YWx1ZSBvZiB0aGUg\nbW9zdCBwcmVjaXNlIGF2YWlsYWJsZSBzeXN0ZW0gdGltZXIsCiAgICAgKiBp\nbiBuYW5vc2Vjb25kcy4gVGhpcyBtZXRob2QgY2FuIG9ubHkgYmUgdXNlZCB0\nbyBtZWFzdXJlIGVsYXBzZWQgdGltZSBhbmQKICAgICAqIGlzIG5vdCByZWxh\ndGVkIHRvIGFueSBvdGhlciBub3Rpb24gb2Ygc3lzdGVtIG9yIHdhbGwtY2xv\nY2sgdGltZS4gVGhlCiAgICAgKiB2YWx1ZSByZXR1cm5lZCByZXByZXNlbnRz\nIG5hbm9zZWNvbmRzIHNpbmNlIHNvbWUgZml4ZWQgYnV0IGFyYml0cmFyeQog\nICAgICogdGltZShwZXJoYXBzIGluIHRoZSBmdXR1cmUsIHNvIHZhbHVlcyBt\nYXkgYmUgbmVnYXRpdmUpLiBUaGlzIG1ldGhvZAogICAgICogcHJvdmlkZXMg\nbmFub3NlY29uZCBwcmVjaXNpb24sIGJ1dCBub3QgbmVjZXNzYXJpbHkgbmFu\nb3NlY29uZCBhY2N1cmFjeS4KICAgICAqIE5vIGd1YXJhbnRlZXMgYXJlIG1h\nZGUgYWJvdXQgaG93IGZyZXF1ZW50bHkgdmFsdWVzIGNoYW5nZS4gRGlmZmVy\nZW5jZXMKICAgICAqIGluIHN1Y2Nlc3NpdmUgY2FsbHMgdGhhdCBzcGFuIGdy\nZWF0ZXIgdGhhbiBhcHByb3hpbWF0ZWx5IDI5MiB5ZWFycwogICAgICogKDJe\nNjMgbmFub3NlY29uZHMpIHdpbGwgbm90IGFjY3VyYXRlbHkgY29tcHV0ZSBl\nbGFwc2VkIHRpbWUgZHVlIHRvCiAgICAgKiBudW1lcmljYWwgb3ZlcmZsb3cu\nCiAgICAgKiAKICAgICAqIDxlbT5JbXBsZW1lbnRhdGlvbiBub3RlOjwvZW0+\nQnkgZGVmYXVsdCwgdGhpcyBtZXRob2QgdXNlcwogICAgICogPGNvZGU+c3Vu\nLm1pc2MuUGVyZjwvY29kZT4gb24gSmF2YSAxLjQuMiwgYW5kIGZhbGxzIGJh\nY2sgdG8KICAgICAqIFN5c3RlbS5jdXJyZW50VGltZU1pbGxpcygpIGVtdWxh\ndGlvbiBvbiBlYXJsaWVyIEpES3MuIEN1c3RvbQogICAgICogdGltZXIgY2Fu\nIGJlIHByb3ZpZGVkIHZpYSB0aGUgc3lzdGVtIHByb3BlcnR5CiAgICAgKiA8\nY29kZT5lZHUuZW1vcnkubWF0aGNzLmJhY2twb3J0LmphdmEudXRpbC5jb25j\ndXJyZW50Lk5hbm9UaW1lclByb3ZpZGVyPC9jb2RlPi4KICAgICAqIFRoZSB2\nYWx1ZSBvZiB0aGUgcHJvcGVydHkgc2hvdWxkIG5hbWUgYSBjbGFzcyBpbXBs\nZW1lbnRpbmcKICAgICAqIHtAbGluayBOYW5vVGltZXJ9IGludGVyZmFjZS4K\nICAgICAqIE5vdGU6IG9uIEpESyAxLjQuMiwgPGNvZGU+c3VuLm1pc2MuUGVy\nZjwvY29kZT4gdGltZXIgc2VlbXMgdG8gaGF2ZQogICAgICogcmVzb2x1dGlv\nbiBvZiB0aGUgb3JkZXIgb2YgMSBtaWNyb3NlY29uZCwgbWVhc3VyZWQgb24g\nTGludXguCiAgICAgKgogICAgICogQHJldHVybiBUaGUgY3VycmVudCB2YWx1\nZSBvZiB0aGUgc3lzdGVtIHRpbWVyLCBpbiBuYW5vc2Vjb25kcy4KICAgICAq\nLwogICAgcHVibGljIHN0YXRpYyBsb25nIG5hbm9UaW1lKCkgewogICAgICAg\nIHJldHVybiBuYW5vVGltZXIubmFub1RpbWUoKTsKICAgIH0KCiAgICAvKioK\nICAgICAqIENhdXNlcyB0aGUgY3VycmVudCB0aHJlYWQgdG8gd2FpdCB1bnRp\nbCBpdCBpcyBzaWduYWxsZWQgb3IgaW50ZXJydXB0ZWQsCiAgICAgKiBvciB0\naGUgc3BlY2lmaWVkIHdhaXRpbmcgdGltZSBlbGFwc2VzLiBUaGlzIG1ldGhv\nZCBvcmlnaW5hbGx5IGFwcGVhcnMKICAgICAqIGluIHRoZSB7QGxpbmsgQ29u\nZGl0aW9ufSBpbnRlcmZhY2UsIGJ1dCBpdCB3YXMgbW92ZWQgdG8gaGVyZSBz\naW5jZSBpdAogICAgICogY2FuIG9ubHkgYmUgZW11bGF0ZWQsIHdpdGggdmVy\neSBsaXR0bGUgYWNjdXJhY3kgZ3VhcmFudGVlczogdGhlCiAgICAgKiBlZmZp\nY2llbnQgaW1wbGVtZW50YXRpb24gcmVxdWlyZXMgYWNjdXJhdGUgbmFub3Nl\nY29uZCB0aW1lciBhbmQgbmF0aXZlCiAgICAgKiBzdXBwb3J0IGZvciBuYW5v\nc2Vjb25kLXByZWNpc2lvbiB3YWl0IHF1ZXVlcywgd2hpY2ggYXJlIG5vdCB1\nc3VhbGx5CiAgICAgKiBwcmVzZW50IGluIEpWTXMgcHJpb3IgdG8gMS41LiBM\nb3NzIG9mIHByZWNpc2lvbiBtYXkgY2F1c2UgdG90YWwgd2FpdGluZwogICAg\nICogdGltZXMgdG8gYmUgc3lzdGVtYXRpY2FsbHkgc2hvcnRlciB0aGFuIHNw\nZWNpZmllZCB3aGVuIHJlLXdhaXRzIG9jY3VyLgogICAgICogVGhlIGxvY2sg\nYXNzb2NpYXRlZCB3aXRoIHRoaXMgY29uZGl0aW9uIGlzIGF0b21pY2FsbHkK\nICAgICAqIHJlbGVhc2VkIGFuZCB0aGUgY3VycmVudCB0aHJlYWQgYmVjb21l\ncyBkaXNhYmxlZCBmb3IgdGhyZWFkIHNjaGVkdWxpbmcKICAgICAqIHB1cnBv\nc2VzIGFuZCBsaWVzIGRvcm1hbnQgdW50aWwgPGVtPm9uZTwvZW0+IG9mIGZp\ndmUgdGhpbmdzIGhhcHBlbnM6CiAgICAgKiA8dWw+CiAgICAgKiA8bGk+U29t\nZSBvdGhlciB0aHJlYWQgaW52b2tlcyB0aGUge0BsaW5rCiAgICAgKiBlZHUu\nZW1vcnkubWF0aGNzLmJhY2twb3J0LmphdmEudXRpbC5jb25jdXJyZW50Lmxv\nY2tzLkNvbmRpdGlvbiNzaWduYWx9CiAgICAgKiBtZXRob2QgZm9yIHRoaXMK\nICAgICAqIDx0dD5Db25kaXRpb248L3R0PiBhbmQgdGhlIGN1cnJlbnQgdGhy\nZWFkIGhhcHBlbnMgdG8gYmUgY2hvc2VuIGFzIHRoZQogICAgICogdGhyZWFk\nIHRvIGJlIGF3YWtlbmVkOyBvcgogICAgICogPGxpPlNvbWUgb3RoZXIgdGhy\nZWFkIGludm9rZXMgdGhlIHtAbGluawogICAgICogZWR1LmVtb3J5Lm1hdGhj\ncy5iYWNrcG9ydC5qYXZhLnV0aWwuY29uY3VycmVudC5sb2Nrcy5Db25kaXRp\nb24jc2lnbmFsQWxsfQogICAgICogbWV0aG9kIGZvciB0aGlzCiAgICAgKiA8\ndHQ+Q29uZGl0aW9uPC90dD47IG9yCiAgICAgKiA8bGk+U29tZSBvdGhlciB0\naHJlYWQge0BsaW5rIFRocmVhZCNpbnRlcnJ1cHQgaW50ZXJydXB0c30gdGhl\nIGN1cnJlbnQKICAgICAqIHRocmVhZCwgYW5kIGludGVycnVwdGlvbiBvZiB0\naHJlYWQgc3VzcGVuc2lvbiBpcyBzdXBwb3J0ZWQ7IG9yCiAgICAgKiA8bGk+\nVGhlIHNwZWNpZmllZCB3YWl0aW5nIHRpbWUgZWxhcHNlczsgb3IKICAgICAq\nIDxsaT5BICZxdW90OzxlbT5zcHVyaW91cyB3YWtldXA8L2VtPiZxdW90OyBv\nY2N1cnMuCiAgICAgKiA8L3VsPiBJbiBhbGwgY2FzZXMsIGJlZm9yZSB0aGlz\nIG1ldGhvZCBjYW4gcmV0dXJuIHRoZSBjdXJyZW50IHRocmVhZCBtdXN0CiAg\nICAgKiByZS1hY3F1aXJlIHRoZSBsb2NrIGFzc29jaWF0ZWQgd2l0aCB0aGlz\nIGNvbmRpdGlvbi4gV2hlbiB0aGUKICAgICAqIHRocmVhZCByZXR1cm5zIGl0\nIGlzIDxlbT5ndWFyYW50ZWVkPC9lbT4gdG8gaG9sZCB0aGlzIGxvY2suCiAg\nICAgKiBJZiB0aGUgY3VycmVudCB0aHJlYWQ6CiAgICAgKiA8dWw+CiAgICAg\nKiA8bGk+aGFzIGl0cyBpbnRlcnJ1cHRlZCBzdGF0dXMgc2V0IG9uIGVudHJ5\nIHRvIHRoaXMgbWV0aG9kOyBvcgogICAgICogPGxpPmlzIHtAbGluayBUaHJl\nYWQjaW50ZXJydXB0IGludGVycnVwdGVkfSB3aGlsZSB3YWl0aW5nCiAgICAg\nKiBhbmQgaW50ZXJydXB0aW9uIG9mIHRocmVhZCBzdXNwZW5zaW9uIGlzIHN1\ncHBvcnRlZCwKICAgICAqIDwvdWw+CiAgICAgKiB0aGVuIHtAbGluayBJbnRl\ncnJ1cHRlZEV4Y2VwdGlvbn0gaXMgdGhyb3duIGFuZCB0aGUgY3VycmVudCB0\naHJlYWQncwogICAgICogaW50ZXJydXB0ZWQgc3RhdHVzIGlzIGNsZWFyZWQu\nIEl0IGlzIG5vdCBzcGVjaWZpZWQsIGluIHRoZSBmaXJzdAogICAgICogY2Fz\nZSwgd2hldGhlciBvciBub3QgdGhlIHRlc3QgZm9yIGludGVycnVwdGlvbiBv\nY2N1cnMgYmVmb3JlIHRoZSBsb2NrCiAgICAgKiBpcyByZWxlYXNlZC4gVGhl\nIG1ldGhvZCByZXR1cm5zIGFuIGVzdGltYXRlIG9mIHRoZSBudW1iZXIgb2Yg\nbmFub3NlY29uZHMKICAgICAqIHJlbWFpbmluZyB0byB3YWl0IGdpdmVuIHRo\nZSBzdXBwbGllZCA8dHQ+bmFub3NUaW1lb3V0PC90dD4KICAgICAqIHZhbHVl\nIHVwb24gcmV0dXJuLCBvciBhIHZhbHVlIGxlc3MgdGhhbiBvciBlcXVhbCB0\nbyB6ZXJvIGlmIGl0CiAgICAgKiB0aW1lZCBvdXQuIEFjY3VyYWN5IG9mIHRo\naXMgZXN0aW1hdGUgaXMgZGlyZWN0bHkgZGVwZW5kZW50IG9uIHRoZQogICAg\nICogYWNjdXJhY3kgb2Yge0BsaW5rICNuYW5vVGltZX0uIFRoaXMgdmFsdWUg\nY2FuIGJlIHVzZWQgdG8gZGV0ZXJtaW5lCiAgICAgKiB3aGV0aGVyIGFuZCBo\nb3cgbG9uZyB0byByZS13YWl0IGluIGNhc2VzIHdoZXJlIHRoZSB3YWl0IHJl\ndHVybnMgYnV0IGFuCiAgICAgKiBhd2FpdGVkIGNvbmRpdGlvbiBzdGlsbCBk\nb2VzIG5vdCBob2xkLiBUeXBpY2FsIHVzZXMgb2YgdGhpcyBtZXRob2QgdGFr\nZQogICAgICogdGhlIGZvbGxvd2luZyBmb3JtOgogICAgICogCiAgICAgKiA8\ncHJlPiBzeW5jaHJvbml6ZWQgYm9vbGVhbiBhTWV0aG9kKGxvbmcgdGltZW91\ndCwgVGltZVVuaXQgdW5pdCkgewogICAgICogbG9uZyBuYW5vc1RpbWVvdXQg\nPSB1bml0LnRvTmFub3ModGltZW91dCk7CiAgICAgKiB3aGlsZSAoIWNvbmRp\ndGlvbkJlaW5nV2FpdGVkRm9yKSB7IGlmIChuYW5vc1RpbWVvdXQgJmd0OyAw\nKQogICAgICogbmFub3NUaW1lb3V0ID0gdGhlQ29uZGl0aW9uLmF3YWl0TmFu\nb3MobmFub3NUaW1lb3V0KTsgZWxzZSByZXR1cm4gZmFsc2U7CiAgICAgKiB9\nIC8vIC4uLiB9CiAgICAgKiA8L3ByZT4KICAgICAqIAogICAgICogPGI+SW1w\nbGVtZW50YXRpb24gQ29uc2lkZXJhdGlvbnM8L2I+CiAgICAgKiBUaGUgY3Vy\ncmVudCB0aHJlYWQgaXMgYXNzdW1lZCB0byBob2xkIHRoZSBsb2NrIGFzc29j\naWF0ZWQgd2l0aCB0aGlzCiAgICAgKiA8dHQ+Q29uZGl0aW9uPC90dD4gd2hl\nbiB0aGlzIG1ldGhvZCBpcyBjYWxsZWQuCiAgICAgKiBJdCBpcyB1cCB0byB0\naGUgaW1wbGVtZW50YXRpb24gdG8gZGV0ZXJtaW5lIGlmIHRoaXMgaXMKICAg\nICAqIHRoZSBjYXNlIGFuZCBpZiBub3QsIGhvdyB0byByZXNwb25kLiBUeXBp\nY2FsbHksIGFuIGV4Y2VwdGlvbiB3aWxsIGJlCiAgICAgKiB0aHJvd24oc3Vj\naCBhcyB7QGxpbmsgSWxsZWdhbE1vbml0b3JTdGF0ZUV4Y2VwdGlvbn0pIGFu\nZCB0aGUKICAgICAqIGltcGxlbWVudGF0aW9uIG11c3QgZG9jdW1lbnQgdGhh\ndCBmYWN0LgogICAgICogQSBjb25kaXRpb24gaW1wbGVtZW50YXRpb24gY2Fu\nIGZhdm9yIHJlc3BvbmRpbmcgdG8gYW4gaW50ZXJydXB0IG92ZXIKICAgICAq\nIG5vcm1hbCBtZXRob2QgcmV0dXJuIGluIHJlc3BvbnNlIHRvIGEgc2lnbmFs\nLCBvciBvdmVyIGluZGljYXRpbmcgdGhlCiAgICAgKiBlbGFwc2Ugb2YgdGhl\nIHNwZWNpZmllZCB3YWl0aW5nIHRpbWUuIEluIGVpdGhlciBjYXNlIHRoZSBp\nbXBsZW1lbnRhdGlvbgogICAgICogbXVzdCBlbnN1cmUgdGhhdCB0aGUgc2ln\nbmFsIGlzIHJlZGlyZWN0ZWQgdG8gYW5vdGhlciB3YWl0aW5nIHRocmVhZCwg\naWYKICAgICAqIHRoZXJlIGlzIG9uZS4KICAgICAqCiAgICAgKiBAcGFyYW0g\nY29uZCB0aGUgY29uZGl0aW9uIHRvIHdhaXQgZm9yCiAgICAgKiBAcGFyYW0g\nbmFub3NUaW1lb3V0IHRoZSBtYXhpbXVtIHRpbWUgdG8gd2FpdCwgaW4gbmFu\nb3NlY29uZHMKICAgICAqIEByZXR1cm4gQSB2YWx1ZSBsZXNzIHRoYW4gb3Ig\nZXF1YWwgdG8gemVybyBpZiB0aGUgd2FpdCBoYXMKICAgICAqIHRpbWVkIG91\ndDsgb3RoZXJ3aXNlIGFuIGVzdGltYXRlLCB0aGF0CiAgICAgKiBpcyBzdHJp\nY3RseSBsZXNzIHRoYW4gdGhlIDx0dD5uYW5vc1RpbWVvdXQ8L3R0PiBhcmd1\nbWVudCwKICAgICAqIG9mIHRoZSB0aW1lIHN0aWxsIHJlbWFpbmluZyB3aGVu\nIHRoaXMgbWV0aG9kIHJldHVybmVkLgogICAgICogQHRocm93cyBJbnRlcnJ1\ncHRlZEV4Y2VwdGlvbiBpZiB0aGUgY3VycmVudCB0aHJlYWQgaXMgaW50ZXJy\ndXB0ZWQoYW5kCiAgICAgKiBpbnRlcnJ1cHRpb24gb2YgdGhyZWFkIHN1c3Bl\nbnNpb24gaXMgc3VwcG9ydGVkKS4KICAgICAqLwogICAgcHVibGljIHN0YXRp\nYyBsb25nIGF3YWl0TmFub3MoQ29uZGl0aW9uIGNvbmQsIGxvbmcgbmFub3NU\naW1lb3V0KQogICAgICAgIHRocm93cyBJbnRlcnJ1cHRlZEV4Y2VwdGlvbiB7\nCiAgICAgICAgaWYgKG5hbm9zVGltZW91dCA8PSAwKSByZXR1cm4gbmFub3NU\naW1lb3V0OwogICAgICAgIGxvbmcgbm93ID0gbmFub1RpbWUoKTsKICAgICAg\nICBjb25kLmF3YWl0KG5hbm9zVGltZW91dCwgVGltZVVuaXQuTkFOT1NFQ09O\nRFMpOwogICAgICAgIHJldHVybiBuYW5vc1RpbWVvdXQgLSAobmFub1RpbWUo\nKSAtIG5vdyk7CiAgICB9CgogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgY2xh\nc3MgU3VuUGVyZlByb3ZpZGVyIGltcGxlbWVudHMgTmFub1RpbWVyIHsKCiAg\nICAgICAgZmluYWwgc3VuLm1pc2MuUGVyZiBwZXJmOwogICAgICAgIGZpbmFs\nIGxvbmcgbXVsdGlwbGllciwgZGl2aXNvcjsKCiAgICAgICAgU3VuUGVyZlBy\nb3ZpZGVyKCkgewogICAgICAgICAgICBwZXJmID0gKHN1bi5taXNjLlBlcmYp\nCiAgICAgICAgICAgICAgICBBY2Nlc3NDb250cm9sbGVyLmRvUHJpdmlsZWdl\nZChuZXcgUHJpdmlsZWdlZEFjdGlvbigpIHsKICAgICAgICAgICAgICAgICAg\nICBwdWJsaWMgT2JqZWN0IHJ1bigpIHsKICAgICAgICAgICAgICAgICAgICAg\nICAgcmV0dXJuIHN1bi5taXNjLlBlcmYuZ2V0UGVyZigpOwogICAgICAgICAg\nICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAv\nLyB0cnlpbmcgdG8gYXZvaWQgQk9USCBvdmVyZmxvdyBhbmQgcm91bmRpbmcg\nZXJyb3JzCiAgICAgICAgICAgIGxvbmcgbnVtZXJhdG9yID0gMTAwMDAwMDAw\nMDsKICAgICAgICAgICAgbG9uZyBkZW5vbWluYXRvciA9IHBlcmYuaGlnaFJl\nc0ZyZXF1ZW5jeSgpOwogICAgICAgICAgICBsb25nIGdjZCA9IGdjZChudW1l\ncmF0b3IsIGRlbm9taW5hdG9yKTsKICAgICAgICAgICAgdGhpcy5tdWx0aXBs\naWVyID0gbnVtZXJhdG9yIC8gZ2NkOwogICAgICAgICAgICB0aGlzLmRpdmlz\nb3IgPSBkZW5vbWluYXRvciAvIGdjZDsKICAgICAgICB9CgogICAgICAgIHB1\nYmxpYyBsb25nIG5hbm9UaW1lKCkgewogICAgICAgICAgICBsb25nIGN0ciA9\nIHBlcmYuaGlnaFJlc0NvdW50ZXIoKTsKCiAgICAgICAgICAgIC8vIGFueXRo\naW5nIGxlc3Mgc29waGlzdGljYXRlZCBzdWZmZXJzIGVpdGhlciBmcm9tIHJv\ndW5kaW5nIGVycm9ycwogICAgICAgICAgICAvLyAoRlAgYXJpdGhtZXRpY3Ms\nIGJhY2twb3J0IHYxLjApIG9yIG92ZXJmbG93LCB3aGVuIGdjZCBpcyBzbWFs\nbAogICAgICAgICAgICAvLyAoYSBidWcgaW4gYmFja3BvcnQgdjEuMF8wMSBy\nZXBvcnRlZCBieSBSYW1lc2ggTmV0aGkpCgogICAgICAgICAgICByZXR1cm4g\nKChjdHIgLyBkaXZpc29yKSAqIG11bHRpcGxpZXIpICsKICAgICAgICAgICAg\nICAgIChjdHIgJSBkaXZpc29yKSAqIG11bHRpcGxpZXIgLyBkaXZpc29yOwoK\nICAgICAgICAgICAgLy8gZXZlbiB0aGUgYWJvdmUgY2FuIHRoZW9yZXRpY2Fs\nbHkgY2F1c2UgcHJvYmxlbXMgaWYgeW91ciBKVk0gaXMKICAgICAgICAgICAg\nLy8gcnVubmluZyBmb3Igc3VmZmljaWVudGx5IGxvbmcgdGltZSwgYnV0ICJz\ndWZmaWNpZW50bHkiIG1lYW5zIDI5MgogICAgICAgICAgICAvLyB5ZWFycyh3\nb3JzdCBjYXNlKSwgb3IgMzAsMDAwIHllYXJzKGNvbW1vbiBjYXNlKS4KCiAg\nICAgICAgICAgIC8vIERldGFpbHM6IHdoZW4gdGhlIHRpY2tzIGN0ciBvdmVy\nZmxvd3MsIHRoZXJlIGlzIG5vIHdheSB0byBhdm9pZAogICAgICAgICAgICAv\nLyBkaXNjb250aW51aXR5IGluIGNvbXB1dGVkIG5hbm9zLCBldmVuIGluIGlu\nZmluaXRlIGFyaXRobWV0aWNzLAogICAgICAgICAgICAvLyB1bmxlc3Mgd2Ug\nY291bnQgbnVtYmVyIG9mIG92ZXJmbG93cyB0aGF0IHRoZSBjdHIgd2VudCB0\naHJvdWdoCiAgICAgICAgICAgIC8vIHNpbmNlIHRoZSBKVk0gc3RhcnRlZC4g\nVGhpcyBmb2xsb3dzIGZyb20gdGhlIGZhY3QgdGhhdAogICAgICAgICAgICAv\nLyAoMl42NCptdWx0aXBsaWVyL2Rpdmlzb3IpIG1vZCgyXjY0KSA+IDAgaW4g\nZ2VuZXJhbCBjYXNlLgogICAgICAgICAgICAvLyBUaGVvcmV0aWNhbGx5IHdl\nIGNvdWxkIGZpbmQgb3V0IHRoZSBudW1iZXIgb2Ygb3ZlcmZsb3dzIGJ5CiAg\nICAgICAgICAgIC8vIGNoZWNraW5nIFN5c3RlbS5jdXJyZW50VGltZU1pbGxp\ncygpLCBidXQgdGhpcyBpcyB1bnJlbGlhYmxlCiAgICAgICAgICAgIC8vIHNp\nbmNlIHRoZSBzeXN0ZW0gdGltZSBjYW4gdW5wcmVkaWN0YWJseSBjaGFuZ2Ug\nZHVyaW5nIHRoZSBKVk0KICAgICAgICAgICAgLy8gbGlmZXRpbWUuCiAgICAg\nICAgICAgIC8vIFRoZSB0aW1lIHRvIG92ZXJmbG93IGlzIDJeNjMgLyB0aWNr\ncyBmcmVxdWVuY3kuIFdpdGggY3VycmVudAogICAgICAgICAgICAvLyB0aWNr\ncyBmcmVxdWVuY2llcyBvZiBzZXZlcmFsIE1IeiwgaXQgZ2l2ZXMgYWJvdXQg\nMzAsMDAwIHllYXJzCiAgICAgICAgICAgIC8vIGJlZm9yZSB0aGUgcHJvYmxl\nbSBoYXBwZW5zLiBJZiB0aWNrcyBmcmVxdWVuY3kgcmVhY2hlcyAxIEdIeiwg\ndGhlCiAgICAgICAgICAgIC8vIHRpbWUgdG8gb3ZlcmZsb3cgaXMgMjkyIHll\nYXJzLiBJdCBpcyB1bmxpa2VseSB0aGF0IHRoZSBmcmVxdWVuY3kKICAgICAg\nICAgICAgLy8gZXZlciBleGNlZWRzIDEgR0h6LiBXZSBjb3VsZCBkb3VibGUg\ndGhlIHRpbWUgdG8gb3ZlcmZsb3cKICAgICAgICAgICAgLy8gKHRvIDJeNjQg\nLyBmcmVxdWVuY3kpIGJ5IHVzaW5nIHVuc2lnbmVkIGFyaXRobWV0aWNzLCBl\nLmcuIGJ5CiAgICAgICAgICAgIC8vIGFkZGluZyB0aGUgZm9sbG93aW5nIGNv\ncnJlY3Rpb24gd2hlbmV2ZXIgdGhlIHRpY2tzIGlzIG5lZ2F0aXZlOgogICAg\nICAgICAgICAvLyAgICAgIC0yKigoTG9uZy5NSU5fVkFMVUUgLyBkaXZpc29y\nKSAqIG11bHRpcGxpZXIgKwogICAgICAgICAgICAvLyAgICAgICAgICAoTG9u\nZy5NSU5fVkFMVUUgJSBkaXZpc29yKSAqIG11bHRpcGxpZXIgLyBkaXZpc29y\nKQogICAgICAgICAgICAvLyBCdXQsIHdpdGggdGhlIHdvcnN0IGNhc2Ugb2Yg\nYXMgbXVjaCBhcyAyOTIgeWVhcnMsIGl0IGRvZXMgbm90CiAgICAgICAgICAg\nIC8vIHNlZW0ganVzdGlmaWVkLgogICAgICAgIH0KICAgIH0KCiAgICBwcml2\nYXRlIHN0YXRpYyBmaW5hbCBjbGFzcyBNaWxsaXNQcm92aWRlciBpbXBsZW1l\nbnRzIE5hbm9UaW1lciB7CgogICAgICAgIE1pbGxpc1Byb3ZpZGVyKCkgewog\nICAgICAgIH0KCiAgICAgICAgcHVibGljIGxvbmcgbmFub1RpbWUoKSB7CiAg\nICAgICAgICAgIHJldHVybiBTeXN0ZW0uY3VycmVudFRpbWVNaWxsaXMoKSAq\nIDEwMDAwMDA7CiAgICAgICAgfQogICAgfQoKICAgIHByaXZhdGUgc3RhdGlj\nIGxvbmcgZ2NkKGxvbmcgYSwgbG9uZyBiKSB7CiAgICAgICAgbG9uZyByOwog\nICAgICAgIHdoaWxlIChiID4gMCkgewogICAgICAgICAgICByID0gYSAlIGI7\nCiAgICAgICAgICAgIGEgPSBiOwogICAgICAgICAgICBiID0gcjsKICAgICAg\nICB9CiAgICAgICAgcmV0dXJuIGE7CiAgICB9CgogICAgcHVibGljIHN0YXRp\nYyBPYmplY3RbXSBjb2xsZWN0aW9uVG9BcnJheShDb2xsZWN0aW9uIGMpIHsK\nICAgICAgICAvLyBndWVzcyB0aGUgYXJyYXkgc2l6ZTsgZXhwZWN0IHRvIHBv\nc3NpYmx5IGJlIGRpZmZlcmVudAogICAgICAgIGludCBsZW4gPSBjLnNpemUo\nKTsKICAgICAgICBPYmplY3RbXSBhcnIgPSBuZXcgT2JqZWN0W2xlbl07CiAg\nICAgICAgSXRlcmF0b3IgaXRyID0gYy5pdGVyYXRvcigpOwogICAgICAgIGlu\ndCBpZHggPSAwOwogICAgICAgIHdoaWxlICh0cnVlKSB7CiAgICAgICAgICAg\nIHdoaWxlIChpZHggPCBsZW4gJiYgaXRyLmhhc05leHQoKSkgewogICAgICAg\nICAgICAgICAgYXJyW2lkeCsrXSA9IGl0ci5uZXh0KCk7CiAgICAgICAgICAg\nIH0KICAgICAgICAgICAgaWYgKCFpdHIuaGFzTmV4dCgpKSB7CiAgICAgICAg\nICAgICAgICBpZiAoaWR4ID09IGxlbikgcmV0dXJuIGFycjsKICAgICAgICAg\nICAgICAgIC8vIG90aGVyd2lzZSBoYXZlIHRvIHRyaW0KICAgICAgICAgICAg\nICAgIHJldHVybiBBcnJheXMuY29weU9mKGFyciwgaWR4LCBPYmplY3RbXS5j\nbGFzcyk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgLy8gb3RoZXJ3aXNl\nLCBoYXZlIHRvIGdyb3cKICAgICAgICAgICAgaW50IG5ld2NhcCA9ICgoYXJy\nLmxlbmd0aCAvIDIpICsgMSkgKiAzOwogICAgICAgICAgICBpZiAobmV3Y2Fw\nIDwgYXJyLmxlbmd0aCkgewogICAgICAgICAgICAgICAgLy8gb3ZlcmZsb3cK\nICAgICAgICAgICAgICAgIGlmIChhcnIubGVuZ3RoIDwgSW50ZWdlci5NQVhf\nVkFMVUUpIHsKICAgICAgICAgICAgICAgICAgICBuZXdjYXAgPSBJbnRlZ2Vy\nLk1BWF9WQUxVRTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAg\nICAgICAgICAgICAgdGhyb3cgbmV3IE91dE9mTWVtb3J5RXJyb3IoInJlcXVp\ncmVkIGFycmF5IHNpemUgdG9vIGxhcmdlIik7CiAgICAgICAgICAgICAgICB9\nCiAgICAgICAgICAgIH0KICAgICAgICAgICAgYXJyID0gQXJyYXlzLmNvcHlP\nZihhcnIsIG5ld2NhcCwgT2JqZWN0W10uY2xhc3MpOwogICAgICAgICAgICBs\nZW4gPSBuZXdjYXA7CiAgICAgICAgfQogICAgfQoKICAgIHB1YmxpYyBzdGF0\naWMgT2JqZWN0W10gY29sbGVjdGlvblRvQXJyYXkoQ29sbGVjdGlvbiBjLCBP\nYmplY3RbXSBhKSB7CiAgICAgICAgQ2xhc3MgYVR5cGUgPSBhLmdldENsYXNz\nKCk7CiAgICAgICAgLy8gZ3Vlc3MgdGhlIGFycmF5IHNpemU7IGV4cGVjdCB0\nbyBwb3NzaWJseSBiZSBkaWZmZXJlbnQKICAgICAgICBpbnQgbGVuID0gYy5z\naXplKCk7CiAgICAgICAgT2JqZWN0W10gYXJyID0gKGEubGVuZ3RoID49IGxl\nbiA/IGEgOgogICAgICAgICAgICAoT2JqZWN0W10pIEFycmF5Lm5ld0luc3Rh\nbmNlKGFUeXBlLmdldENvbXBvbmVudFR5cGUoKSwgbGVuKSk7CiAgICAgICAg\nSXRlcmF0b3IgaXRyID0gYy5pdGVyYXRvcigpOwogICAgICAgIGludCBpZHgg\nPSAwOwogICAgICAgIHdoaWxlICh0cnVlKSB7CiAgICAgICAgICAgIHdoaWxl\nIChpZHggPCBsZW4gJiYgaXRyLmhhc05leHQoKSkgewogICAgICAgICAgICAg\nICAgYXJyW2lkeCsrXSA9IGl0ci5uZXh0KCk7CiAgICAgICAgICAgIH0KICAg\nICAgICAgICAgaWYgKCFpdHIuaGFzTmV4dCgpKSB7CiAgICAgICAgICAgICAg\nICBpZiAoaWR4ID09IGxlbikgcmV0dXJuIGFycjsKICAgICAgICAgICAgICAg\nIGlmIChhcnIgPT0gYSkgewogICAgICAgICAgICAgICAgICAgIC8vIG9yaWcg\nYXJyYXkgLT4gbnVsbCB0ZXJtaW5hdGUKICAgICAgICAgICAgICAgICAgICBh\nW2lkeF0gPSBudWxsOwogICAgICAgICAgICAgICAgICAgIHJldHVybiBhOwog\nICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAv\nLyBoYXZlIHRvIHRyaW0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gQXJy\nYXlzLmNvcHlPZihhcnIsIGlkeCwgYVR5cGUpOwogICAgICAgICAgICAgICAg\nfQogICAgICAgICAgICB9CiAgICAgICAgICAgIC8vIG90aGVyd2lzZSwgaGF2\nZSB0byBncm93CiAgICAgICAgICAgIGludCBuZXdjYXAgPSAoKGFyci5sZW5n\ndGggLyAyKSArIDEpICogMzsKICAgICAgICAgICAgaWYgKG5ld2NhcCA8IGFy\nci5sZW5ndGgpIHsKICAgICAgICAgICAgICAgIC8vIG92ZXJmbG93CiAgICAg\nICAgICAgICAgICBpZiAoYXJyLmxlbmd0aCA8IEludGVnZXIuTUFYX1ZBTFVF\nKSB7CiAgICAgICAgICAgICAgICAgICAgbmV3Y2FwID0gSW50ZWdlci5NQVhf\nVkFMVUU7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAg\nICAgICAgIHRocm93IG5ldyBPdXRPZk1lbW9yeUVycm9yKCJyZXF1aXJlZCBh\ncnJheSBzaXplIHRvbyBsYXJnZSIpOwogICAgICAgICAgICAgICAgfQogICAg\nICAgICAgICB9CiAgICAgICAgICAgIGFyciA9IEFycmF5cy5jb3B5T2YoYXJy\nLCBuZXdjYXAsIGFUeXBlKTsKICAgICAgICAgICAgbGVuID0gbmV3Y2FwOwog\nICAgICAgIH0KICAgIH0KfQo=\n","encoding":"base64"}

