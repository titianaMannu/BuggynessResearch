{"sha":"1f32790a37c1ad6e5db62ea326cbbade7b8b5bdc","node_id":"MDQ6QmxvYjIwNjM2NDoxZjMyNzkwYTM3YzFhZDZlNWRiNjJlYTMyNmNiYmFkZTdiOGI1YmRj","size":35804,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/1f32790a37c1ad6e5db62ea326cbbade7b8b5bdc","content":"LyoNCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUNCiAqIG9yIG1vcmUgY29udHJpYnV0b3Ig\nbGljZW5zZSBhZ3JlZW1lbnRzLiAgU2VlIHRoZSBOT1RJQ0UgZmlsZQ0KICog\nZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5m\nb3JtYXRpb24NCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAg\nVGhlIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUNCiAqIHRvIHlvdSB1bmRlciB0\naGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUNCiAqICJMaWNl\nbnNlIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNv\nbXBsaWFuY2UNCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFp\nbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQNCiAqDQogKiBodHRwOi8vd3d3\nLmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjANCiAqDQogKiBVbmxl\nc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGlu\nIHdyaXRpbmcsDQogKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUg\nTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbg0KICogIkFTIElTIiBCQVNJ\nUywgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZDQog\nKiBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBM\naWNlbnNlIGZvciB0aGUNCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmlu\nZyBwZXJtaXNzaW9ucyBhbmQgbGltaXRhdGlvbnMNCiAqIHVuZGVyIHRoZSBM\naWNlbnNlLiAgICANCiAqLw0KcGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEu\ncGVyc2lzdGVuY2U7DQoNCmltcG9ydCBqYXZhLmxhbmcucmVmbGVjdC5BcnJh\neTsNCmltcG9ydCBqYXZhLnV0aWwuQXJyYXlzOw0KaW1wb3J0IGphdmEudXRp\nbC5Db2xsZWN0aW9uOw0KaW1wb3J0IGphdmEudXRpbC5FbnVtU2V0Ow0KaW1w\nb3J0IGphdmF4LnBlcnNpc3RlbmNlLkVudGl0eU1hbmFnZXI7DQppbXBvcnQg\namF2YXgucGVyc2lzdGVuY2UuRmx1c2hNb2RlVHlwZTsNCmltcG9ydCBqYXZh\neC5wZXJzaXN0ZW5jZS5Mb2NrTW9kZVR5cGU7DQppbXBvcnQgamF2YXgucGVy\nc2lzdGVuY2UuUXVlcnk7DQoNCmltcG9ydCBvcmcuYXBhY2hlLmNvbW1vbnMu\nbGFuZy5TdHJpbmdVdGlsczsNCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\nY29uZi5PcGVuSlBBQ29uZmlndXJhdGlvbjsNCmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEuZWUuTWFuYWdlZFJ1bnRpbWU7DQppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLmtlcm5lbC5Ccm9rZXI7DQppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLmtlcm5lbC5EZWxlZ2F0aW5nQnJva2VyOw0KaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS5rZXJuZWwuRmluZENhbGxiYWNrczsNCmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLkxvY2tMZXZlbHM7DQppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5PcENhbGxiYWNrczsNCmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLk9wZW5KUEFTdGF0ZU1hbmFn\nZXI7DQppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5RdWVyeUZs\ndXNoTW9kZXM7DQppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5R\ndWVyeUxhbmd1YWdlczsNCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEua2Vy\nbmVsLlNlcTsNCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLmpw\ncWwuSlBRTFBhcnNlcjsNCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGli\nLnV0aWwuTG9jYWxpemVyOw0KaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5s\naWIudXRpbC5DbG9zZWFibGU7DQppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLm1ldGEuQ2xhc3NNZXRhRGF0YTsNCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEubWV0YS5GaWVsZE1ldGFEYXRhOw0KaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5tZXRhLlF1ZXJ5TWV0YURhdGE7DQppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLm1ldGEuU2VxdWVuY2VNZXRhRGF0YTsNCmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEudXRpbC5FeGNlcHRpb25zOw0KaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS51dGlsLkltcGxIZWxwZXI7DQppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLnV0aWwuUnVudGltZUV4Y2VwdGlvblRyYW5zbGF0b3I7DQpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuVXNlckV4Y2VwdGlvbjsN\nCg0KLyoqDQogKiBJbXBsZW1lbnRhdGlvbiBvZiB7QGxpbmsgRW50aXR5TWFu\nYWdlcn0gaW50ZXJmYWNlLg0KICoNCiAqIEBhdXRob3IgUGF0cmljayBMaW5z\na2V5DQogKiBAYXV0aG9yIEFiZSBXaGl0ZQ0KICogQG5vamF2YWRvYw0KICov\nDQpwdWJsaWMgY2xhc3MgRW50aXR5TWFuYWdlckltcGwNCiAgICBpbXBsZW1l\nbnRzIE9wZW5KUEFFbnRpdHlNYW5hZ2VyU1BJLA0KICAgIEZpbmRDYWxsYmFj\na3MsIE9wQ2FsbGJhY2tzLCBDbG9zZWFibGUsIE9wZW5KUEFFbnRpdHlUcmFu\nc2FjdGlvbiB7DQoNCiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBMb2NhbGl6\nZXIgX2xvYyA9IExvY2FsaXplci5mb3JQYWNrYWdlDQogICAgICAgIChFbnRp\ndHlNYW5hZ2VySW1wbC5jbGFzcyk7DQoNCiAgICBwcml2YXRlIGZpbmFsIERl\nbGVnYXRpbmdCcm9rZXIgX2Jyb2tlcjsNCiAgICBwcml2YXRlIGZpbmFsIEVu\ndGl0eU1hbmFnZXJGYWN0b3J5SW1wbCBfZW1mOw0KICAgIHByaXZhdGUgRmV0\nY2hQbGFuIF9mZXRjaCA9IG51bGw7DQogICAgcHJpdmF0ZSBzdGF0aWMgZmlu\nYWwgT2JqZWN0W10gRU1QVFlfT0JKRUNUUyA9IG5ldyBPYmplY3RbMF07DQoN\nCiAgICAvKioNCiAgICAgKiBDb25zdHJ1Y3Rvcjsgc3VwcGx5IGZhY3Rvcnkg\nYW5kIGRlbGVnYXRlLg0KICAgICAqLw0KICAgIHB1YmxpYyBFbnRpdHlNYW5h\nZ2VySW1wbChFbnRpdHlNYW5hZ2VyRmFjdG9yeUltcGwgZmFjdG9yeSwNCiAg\nICAgICAgQnJva2VyIGJyb2tlcikgew0KICAgICAgICBfZW1mID0gZmFjdG9y\neTsNCiAgICAgICAgUnVudGltZUV4Y2VwdGlvblRyYW5zbGF0b3IgdHJhbnNs\nYXRvciA9DQogICAgICAgICAgICBQZXJzaXN0ZW5jZUV4Y2VwdGlvbnMuZ2V0\nUm9sbGJhY2tUcmFuc2xhdG9yKHRoaXMpOw0KICAgICAgICBfYnJva2VyID0g\nbmV3IERlbGVnYXRpbmdCcm9rZXIoYnJva2VyLCB0cmFuc2xhdG9yKTsNCiAg\nICAgICAgX2Jyb2tlci5zZXRJbXBsaWNpdEJlaGF2aW9yKHRoaXMsIHRyYW5z\nbGF0b3IpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIEJyb2tlciBkZWxl\nZ2F0ZS4NCiAgICAgKi8NCiAgICBwdWJsaWMgQnJva2VyIGdldEJyb2tlcigp\nIHsNCiAgICAgICAgcmV0dXJuIF9icm9rZXIuZ2V0RGVsZWdhdGUoKTsNCiAg\nICB9DQoNCiAgICBwdWJsaWMgT3BlbkpQQUVudGl0eU1hbmFnZXJGYWN0b3J5\nIGdldEVudGl0eU1hbmFnZXJGYWN0b3J5KCkgew0KICAgICAgICByZXR1cm4g\nX2VtZjsNCiAgICB9DQoNCiAgICBwdWJsaWMgT3BlbkpQQUNvbmZpZ3VyYXRp\nb24gZ2V0Q29uZmlndXJhdGlvbigpIHsNCiAgICAgICAgcmV0dXJuIF9icm9r\nZXIuZ2V0Q29uZmlndXJhdGlvbigpOw0KICAgIH0NCg0KICAgIHB1YmxpYyBG\nZXRjaFBsYW4gZ2V0RmV0Y2hQbGFuKCkgew0KICAgICAgICBhc3NlcnROb3RD\nbG9zZUludm9rZWQoKTsNCiAgICAgICAgX2Jyb2tlci5sb2NrKCk7DQogICAg\nICAgIHRyeSB7DQogICAgICAgICAgICBpZiAoX2ZldGNoID09IG51bGwpDQog\nICAgICAgICAgICAgICAgX2ZldGNoID0gX2VtZi50b0ZldGNoUGxhbihfYnJv\na2VyLA0KICAgICAgICAgICAgICAgICAgICBfYnJva2VyLmdldEZldGNoQ29u\nZmlndXJhdGlvbigpKTsNCiAgICAgICAgICAgIHJldHVybiBfZmV0Y2g7DQog\nICAgICAgIH0gZmluYWxseSB7DQogICAgICAgICAgICBfYnJva2VyLnVubG9j\naygpOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgcHVibGljIENvbm5lY3Rp\nb25SZXRhaW5Nb2RlIGdldENvbm5lY3Rpb25SZXRhaW5Nb2RlKCkgew0KICAg\nICAgICByZXR1cm4gQ29ubmVjdGlvblJldGFpbk1vZGUuZnJvbUtlcm5lbENv\nbnN0YW50KA0KICAgICAgICAgICAgX2Jyb2tlci5nZXRDb25uZWN0aW9uUmV0\nYWluTW9kZSgpKTsNCiAgICB9DQoNCiAgICBwdWJsaWMgYm9vbGVhbiBpc01h\nbmFnZWQoKSB7DQogICAgICAgIHJldHVybiBfYnJva2VyLmlzTWFuYWdlZCgp\nOw0KICAgIH0NCg0KICAgIHB1YmxpYyBNYW5hZ2VkUnVudGltZSBnZXRNYW5h\nZ2VkUnVudGltZSgpIHsNCiAgICAgICAgcmV0dXJuIF9icm9rZXIuZ2V0TWFu\nYWdlZFJ1bnRpbWUoKTsNCiAgICB9DQoNCiAgICBwdWJsaWMgYm9vbGVhbiBn\nZXRTeW5jV2l0aE1hbmFnZWRUcmFuc2FjdGlvbnMoKSB7DQogICAgICAgIHJl\ndHVybiBfYnJva2VyLmdldFN5bmNXaXRoTWFuYWdlZFRyYW5zYWN0aW9ucygp\nOw0KICAgIH0NCg0KICAgIHB1YmxpYyB2b2lkIHNldFN5bmNXaXRoTWFuYWdl\nZFRyYW5zYWN0aW9ucyhib29sZWFuIHN5bmMpIHsNCiAgICAgICAgYXNzZXJ0\nTm90Q2xvc2VJbnZva2VkKCk7DQogICAgICAgIF9icm9rZXIuc2V0U3luY1dp\ndGhNYW5hZ2VkVHJhbnNhY3Rpb25zKHN5bmMpOw0KICAgIH0NCg0KICAgIHB1\nYmxpYyBDbGFzc0xvYWRlciBnZXRDbGFzc0xvYWRlcigpIHsNCiAgICAgICAg\ncmV0dXJuIF9icm9rZXIuZ2V0Q2xhc3NMb2FkZXIoKTsNCiAgICB9DQoNCiAg\nICBwdWJsaWMgU3RyaW5nIGdldENvbm5lY3Rpb25Vc2VyTmFtZSgpIHsNCiAg\nICAgICAgcmV0dXJuIF9icm9rZXIuZ2V0Q29ubmVjdGlvblVzZXJOYW1lKCk7\nDQogICAgfQ0KDQogICAgcHVibGljIFN0cmluZyBnZXRDb25uZWN0aW9uUGFz\nc3dvcmQoKSB7DQogICAgICAgIHJldHVybiBfYnJva2VyLmdldENvbm5lY3Rp\nb25QYXNzd29yZCgpOw0KICAgIH0NCg0KICAgIHB1YmxpYyBib29sZWFuIGdl\ndE11bHRpdGhyZWFkZWQoKSB7DQogICAgICAgIHJldHVybiBfYnJva2VyLmdl\ndE11bHRpdGhyZWFkZWQoKTsNCiAgICB9DQoNCiAgICBwdWJsaWMgdm9pZCBz\nZXRNdWx0aXRocmVhZGVkKGJvb2xlYW4gbXVsdGl0aHJlYWRlZCkgew0KICAg\nICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsNCiAgICAgICAgX2Jyb2tl\nci5zZXRNdWx0aXRocmVhZGVkKG11bHRpdGhyZWFkZWQpOw0KICAgIH0NCg0K\nICAgIHB1YmxpYyBib29sZWFuIGdldElnbm9yZUNoYW5nZXMoKSB7DQogICAg\nICAgIHJldHVybiBfYnJva2VyLmdldElnbm9yZUNoYW5nZXMoKTsNCiAgICB9\nDQoNCiAgICBwdWJsaWMgdm9pZCBzZXRJZ25vcmVDaGFuZ2VzKGJvb2xlYW4g\ndmFsKSB7DQogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOw0KICAg\nICAgICBfYnJva2VyLnNldElnbm9yZUNoYW5nZXModmFsKTsNCiAgICB9DQoN\nCiAgICBwdWJsaWMgYm9vbGVhbiBnZXROb250cmFuc2FjdGlvbmFsUmVhZCgp\nIHsNCiAgICAgICAgcmV0dXJuIF9icm9rZXIuZ2V0Tm9udHJhbnNhY3Rpb25h\nbFJlYWQoKTsNCiAgICB9DQoNCiAgICBwdWJsaWMgdm9pZCBzZXROb250cmFu\nc2FjdGlvbmFsUmVhZChib29sZWFuIHZhbCkgew0KICAgICAgICBhc3NlcnRO\nb3RDbG9zZUludm9rZWQoKTsNCiAgICAgICAgX2Jyb2tlci5zZXROb250cmFu\nc2FjdGlvbmFsUmVhZCh2YWwpOw0KICAgIH0NCg0KICAgIHB1YmxpYyBib29s\nZWFuIGdldE5vbnRyYW5zYWN0aW9uYWxXcml0ZSgpIHsNCiAgICAgICAgcmV0\ndXJuIF9icm9rZXIuZ2V0Tm9udHJhbnNhY3Rpb25hbFdyaXRlKCk7DQogICAg\nfQ0KDQogICAgcHVibGljIHZvaWQgc2V0Tm9udHJhbnNhY3Rpb25hbFdyaXRl\nKGJvb2xlYW4gdmFsKSB7DQogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tl\nZCgpOw0KICAgICAgICBfYnJva2VyLnNldE5vbnRyYW5zYWN0aW9uYWxXcml0\nZSh2YWwpOw0KICAgIH0NCg0KICAgIHB1YmxpYyBib29sZWFuIGdldE9wdGlt\naXN0aWMoKSB7DQogICAgICAgIHJldHVybiBfYnJva2VyLmdldE9wdGltaXN0\naWMoKTsNCiAgICB9DQoNCiAgICBwdWJsaWMgdm9pZCBzZXRPcHRpbWlzdGlj\nKGJvb2xlYW4gdmFsKSB7DQogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tl\nZCgpOw0KICAgICAgICBfYnJva2VyLnNldE9wdGltaXN0aWModmFsKTsNCiAg\nICB9DQoNCiAgICBwdWJsaWMgUmVzdG9yZVN0YXRlVHlwZSBnZXRSZXN0b3Jl\nU3RhdGUoKSB7DQogICAgICAgIHJldHVybiBSZXN0b3JlU3RhdGVUeXBlLmZy\nb21LZXJuZWxDb25zdGFudChfYnJva2VyLmdldFJlc3RvcmVTdGF0ZSgpKTsN\nCiAgICB9DQoNCiAgICBwdWJsaWMgdm9pZCBzZXRSZXN0b3JlU3RhdGUoUmVz\ndG9yZVN0YXRlVHlwZSB2YWwpIHsNCiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJ\nbnZva2VkKCk7DQogICAgICAgIF9icm9rZXIuc2V0UmVzdG9yZVN0YXRlKHZh\nbC50b0tlcm5lbENvbnN0YW50KCkpOw0KICAgIH0NCg0KICAgIHB1YmxpYyBi\nb29sZWFuIGdldFJldGFpblN0YXRlKCkgew0KICAgICAgICByZXR1cm4gX2Jy\nb2tlci5nZXRSZXRhaW5TdGF0ZSgpOw0KICAgIH0NCg0KICAgIHB1YmxpYyB2\nb2lkIHNldFJldGFpblN0YXRlKGJvb2xlYW4gdmFsKSB7DQogICAgICAgIGFz\nc2VydE5vdENsb3NlSW52b2tlZCgpOw0KICAgICAgICBfYnJva2VyLnNldFJl\ndGFpblN0YXRlKHZhbCk7DQogICAgfQ0KDQogICAgcHVibGljIEF1dG9DbGVh\nclR5cGUgZ2V0QXV0b0NsZWFyKCkgew0KICAgICAgICByZXR1cm4gQXV0b0Ns\nZWFyVHlwZS5mcm9tS2VybmVsQ29uc3RhbnQoX2Jyb2tlci5nZXRBdXRvQ2xl\nYXIoKSk7DQogICAgfQ0KDQogICAgcHVibGljIHZvaWQgc2V0QXV0b0NsZWFy\nKEF1dG9DbGVhclR5cGUgdmFsKSB7DQogICAgICAgIGFzc2VydE5vdENsb3Nl\nSW52b2tlZCgpOw0KICAgICAgICBfYnJva2VyLnNldEF1dG9DbGVhcih2YWwu\ndG9LZXJuZWxDb25zdGFudCgpKTsNCiAgICB9DQoNCiAgICBwdWJsaWMgRGV0\nYWNoU3RhdGVUeXBlIGdldERldGFjaFN0YXRlKCkgew0KICAgICAgICByZXR1\ncm4gRGV0YWNoU3RhdGVUeXBlLmZyb21LZXJuZWxDb25zdGFudChfYnJva2Vy\nLmdldERldGFjaFN0YXRlKCkpOw0KICAgIH0NCg0KICAgIHB1YmxpYyB2b2lk\nIHNldERldGFjaFN0YXRlKERldGFjaFN0YXRlVHlwZSB0eXBlKSB7DQogICAg\nICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOw0KICAgICAgICBfYnJva2Vy\nLnNldERldGFjaFN0YXRlKHR5cGUudG9LZXJuZWxDb25zdGFudCgpKTsNCiAg\nICB9DQoNCiAgICBwdWJsaWMgRW51bVNldDxBdXRvRGV0YWNoVHlwZT4gZ2V0\nQXV0b0RldGFjaCgpIHsNCiAgICAgICAgcmV0dXJuIEF1dG9EZXRhY2hUeXBl\nLnRvRW51bVNldChfYnJva2VyLmdldEF1dG9EZXRhY2goKSk7DQogICAgfQ0K\nDQogICAgcHVibGljIHZvaWQgc2V0QXV0b0RldGFjaChBdXRvRGV0YWNoVHlw\nZSBmbGFnKSB7DQogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOw0K\nICAgICAgICBfYnJva2VyLnNldEF1dG9EZXRhY2goQXV0b0RldGFjaFR5cGUu\nZnJvbUVudW1TZXQoRW51bVNldC5vZihmbGFnKSkpOw0KICAgIH0NCg0KICAg\nIHB1YmxpYyB2b2lkIHNldEF1dG9EZXRhY2goRW51bVNldDxBdXRvRGV0YWNo\nVHlwZT4gZmxhZ3MpIHsNCiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2Vk\nKCk7DQogICAgICAgIF9icm9rZXIuc2V0QXV0b0RldGFjaChBdXRvRGV0YWNo\nVHlwZS5mcm9tRW51bVNldChmbGFncykpOw0KICAgIH0NCg0KICAgIHB1Ymxp\nYyB2b2lkIHNldEF1dG9EZXRhY2goaW50IGZsYWcsIGJvb2xlYW4gb24pIHsN\nCiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7DQogICAgICAgIF9i\ncm9rZXIuc2V0QXV0b0RldGFjaChmbGFnLCBvbik7DQogICAgfQ0KDQogICAg\ncHVibGljIGJvb2xlYW4gZ2V0RXZpY3RGcm9tU3RvcmVDYWNoZSgpIHsNCiAg\nICAgICAgcmV0dXJuIF9icm9rZXIuZ2V0RXZpY3RGcm9tRGF0YUNhY2hlKCk7\nDQogICAgfQ0KDQogICAgcHVibGljIHZvaWQgc2V0RXZpY3RGcm9tU3RvcmVD\nYWNoZShib29sZWFuIGV2aWN0KSB7DQogICAgICAgIGFzc2VydE5vdENsb3Nl\nSW52b2tlZCgpOw0KICAgICAgICBfYnJva2VyLnNldEV2aWN0RnJvbURhdGFD\nYWNoZShldmljdCk7DQogICAgfQ0KDQogICAgcHVibGljIGJvb2xlYW4gZ2V0\nUG9wdWxhdGVTdG9yZUNhY2hlKCkgew0KICAgICAgICByZXR1cm4gX2Jyb2tl\nci5nZXRQb3B1bGF0ZURhdGFDYWNoZSgpOw0KICAgIH0NCg0KICAgIHB1Ymxp\nYyB2b2lkIHNldFBvcHVsYXRlU3RvcmVDYWNoZShib29sZWFuIGNhY2hlKSB7\nDQogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOw0KICAgICAgICBf\nYnJva2VyLnNldFBvcHVsYXRlRGF0YUNhY2hlKGNhY2hlKTsNCiAgICB9DQoN\nCiAgICBwdWJsaWMgYm9vbGVhbiBpc1RyYWNrQ2hhbmdlc0J5VHlwZSgpIHsN\nCiAgICAgICAgcmV0dXJuIF9icm9rZXIuaXNUcmFja0NoYW5nZXNCeVR5cGUo\nKTsNCiAgICB9DQoNCiAgICBwdWJsaWMgdm9pZCBzZXRUcmFja0NoYW5nZXNC\neVR5cGUoYm9vbGVhbiB0cmFja0J5VHlwZSkgew0KICAgICAgICBhc3NlcnRO\nb3RDbG9zZUludm9rZWQoKTsNCiAgICAgICAgX2Jyb2tlci5zZXRUcmFja0No\nYW5nZXNCeVR5cGUodHJhY2tCeVR5cGUpOw0KICAgIH0NCg0KICAgIHB1Ymxp\nYyBPYmplY3QgZ2V0VXNlck9iamVjdChPYmplY3Qga2V5KSB7DQogICAgICAg\nIHJldHVybiBfYnJva2VyLmdldFVzZXJPYmplY3Qoa2V5KTsNCiAgICB9DQoN\nCiAgICBwdWJsaWMgT2JqZWN0IHB1dFVzZXJPYmplY3QoT2JqZWN0IGtleSwg\nT2JqZWN0IHZhbCkgew0KICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQo\nKTsNCiAgICAgICAgcmV0dXJuIF9icm9rZXIucHV0VXNlck9iamVjdChrZXks\nIHZhbCk7DQogICAgfQ0KDQogICAgcHVibGljIHZvaWQgYWRkVHJhbnNhY3Rp\nb25MaXN0ZW5lcihPYmplY3QgbGlzdGVuZXIpIHsNCiAgICAgICAgYXNzZXJ0\nTm90Q2xvc2VJbnZva2VkKCk7DQogICAgICAgIF9icm9rZXIuYWRkVHJhbnNh\nY3Rpb25MaXN0ZW5lcihsaXN0ZW5lcik7DQogICAgfQ0KDQogICAgcHVibGlj\nIHZvaWQgcmVtb3ZlVHJhbnNhY3Rpb25MaXN0ZW5lcihPYmplY3QgbGlzdGVu\nZXIpIHsNCiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7DQogICAg\nICAgIF9icm9rZXIucmVtb3ZlVHJhbnNhY3Rpb25MaXN0ZW5lcihsaXN0ZW5l\ncik7DQogICAgfQ0KDQogICAgcHVibGljIEVudW1TZXQ8Q2FsbGJhY2tNb2Rl\nPiBnZXRUcmFuc2FjdGlvbkxpc3RlbmVyQ2FsbGJhY2tNb2RlKCkgew0KICAg\nICAgICByZXR1cm4gQ2FsbGJhY2tNb2RlLnRvRW51bVNldCgNCiAgICAgICAg\nICAgIF9icm9rZXIuZ2V0VHJhbnNhY3Rpb25MaXN0ZW5lckNhbGxiYWNrTW9k\nZSgpKTsNCiAgICB9DQoNCiAgICBwdWJsaWMgdm9pZCBzZXRUcmFuc2FjdGlv\nbkxpc3RlbmVyQ2FsbGJhY2tNb2RlKENhbGxiYWNrTW9kZSBtb2RlKSB7DQog\nICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOw0KICAgICAgICBfYnJv\na2VyLnNldFRyYW5zYWN0aW9uTGlzdGVuZXJDYWxsYmFja01vZGUoDQogICAg\nICAgICAgICBDYWxsYmFja01vZGUuZnJvbUVudW1TZXQoRW51bVNldC5vZiht\nb2RlKSkpOw0KICAgIH0NCg0KICAgIHB1YmxpYyB2b2lkIHNldFRyYW5zYWN0\naW9uTGlzdGVuZXJDYWxsYmFja01vZGUoRW51bVNldDxDYWxsYmFja01vZGU+\nIG1vZGVzKXsNCiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7DQog\nICAgICAgIF9icm9rZXIuc2V0VHJhbnNhY3Rpb25MaXN0ZW5lckNhbGxiYWNr\nTW9kZSgNCiAgICAgICAgICAgIENhbGxiYWNrTW9kZS5mcm9tRW51bVNldCht\nb2RlcykpOw0KICAgIH0NCg0KICAgIHB1YmxpYyB2b2lkIGFkZExpZmVjeWNs\nZUxpc3RlbmVyKE9iamVjdCBsaXN0ZW5lciwgQ2xhc3MuLi4gY2xhc3Nlcykg\new0KICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsNCiAgICAgICAg\nX2Jyb2tlci5hZGRMaWZlY3ljbGVMaXN0ZW5lcihsaXN0ZW5lciwgY2xhc3Nl\ncyk7DQogICAgfQ0KDQogICAgcHVibGljIHZvaWQgcmVtb3ZlTGlmZWN5Y2xl\nTGlzdGVuZXIoT2JqZWN0IGxpc3RlbmVyKSB7DQogICAgICAgIGFzc2VydE5v\ndENsb3NlSW52b2tlZCgpOw0KICAgICAgICBfYnJva2VyLnJlbW92ZUxpZmVj\neWNsZUxpc3RlbmVyKGxpc3RlbmVyKTsNCiAgICB9DQoNCiAgICBwdWJsaWMg\nRW51bVNldDxDYWxsYmFja01vZGU+IGdldExpZmVjeWNsZUxpc3RlbmVyQ2Fs\nbGJhY2tNb2RlKCkgew0KICAgICAgICByZXR1cm4gQ2FsbGJhY2tNb2RlLnRv\nRW51bVNldCgNCiAgICAgICAgICAgIF9icm9rZXIuZ2V0TGlmZWN5Y2xlTGlz\ndGVuZXJDYWxsYmFja01vZGUoKSk7DQogICAgfQ0KDQogICAgcHVibGljIHZv\naWQgc2V0TGlmZWN5Y2xlTGlzdGVuZXJDYWxsYmFja01vZGUoQ2FsbGJhY2tN\nb2RlIG1vZGUpIHsNCiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7\nDQogICAgICAgIF9icm9rZXIuc2V0TGlmZWN5Y2xlTGlzdGVuZXJDYWxsYmFj\na01vZGUoDQogICAgICAgICAgICBDYWxsYmFja01vZGUuZnJvbUVudW1TZXQo\nRW51bVNldC5vZihtb2RlKSkpOw0KICAgIH0NCg0KICAgIHB1YmxpYyB2b2lk\nIHNldExpZmVjeWNsZUxpc3RlbmVyQ2FsbGJhY2tNb2RlKEVudW1TZXQ8Q2Fs\nbGJhY2tNb2RlPiBtb2Rlcykgew0KICAgICAgICBhc3NlcnROb3RDbG9zZUlu\ndm9rZWQoKTsNCiAgICAgICAgX2Jyb2tlci5zZXRMaWZlY3ljbGVMaXN0ZW5l\nckNhbGxiYWNrTW9kZSgNCiAgICAgICAgICAgIENhbGxiYWNrTW9kZS5mcm9t\nRW51bVNldChtb2RlcykpOw0KICAgIH0NCg0KICAgIEBTdXBwcmVzc1dhcm5p\nbmdzKCJ1bmNoZWNrZWQiKQ0KICAgIHB1YmxpYyA8VD4gVCBnZXRSZWZlcmVu\nY2UoQ2xhc3M8VD4gY2xzLCBPYmplY3Qgb2lkKSB7DQogICAgICAgIGFzc2Vy\ndE5vdENsb3NlSW52b2tlZCgpOw0KICAgICAgICBvaWQgPSBfYnJva2VyLm5l\nd09iamVjdElkKGNscywgb2lkKTsNCiAgICAgICAgcmV0dXJuIChUKSBfYnJv\na2VyLmZpbmQob2lkLCBmYWxzZSwgdGhpcyk7DQogICAgfQ0KDQogICAgQFN1\ncHByZXNzV2FybmluZ3MoInVuY2hlY2tlZCIpDQogICAgcHVibGljIDxUPiBU\nIGZpbmQoQ2xhc3M8VD4gY2xzLCBPYmplY3Qgb2lkKSB7DQogICAgICAgIGFz\nc2VydE5vdENsb3NlSW52b2tlZCgpOw0KICAgICAgICBvaWQgPSBfYnJva2Vy\nLm5ld09iamVjdElkKGNscywgb2lkKTsNCiAgICAgICAgcmV0dXJuIChUKSBf\nYnJva2VyLmZpbmQob2lkLCB0cnVlLCB0aGlzKTsNCiAgICB9DQoNCiAgICBA\nU3VwcHJlc3NXYXJuaW5ncygidW5jaGVja2VkIikNCiAgICBwdWJsaWMgPFQ+\nIFRbXSBmaW5kQWxsKENsYXNzPFQ+IGNscywgT2JqZWN0Li4uIG9pZHMpIHsN\nCiAgICAgICAgaWYgKG9pZHMubGVuZ3RoID09IDApDQogICAgICAgICAgICBy\nZXR1cm4gKFRbXSkgQXJyYXkubmV3SW5zdGFuY2UoY2xzLCAwKTsNCiAgICAg\nICAgQ29sbGVjdGlvbjxUPiByZXQgPSBmaW5kQWxsKGNscywgQXJyYXlzLmFz\nTGlzdChvaWRzKSk7DQogICAgICAgIHJldHVybiByZXQudG9BcnJheSgoVFtd\nKSBBcnJheS5uZXdJbnN0YW5jZShjbHMsIHJldC5zaXplKCkpKTsNCiAgICB9\nDQoNCiAgICBAU3VwcHJlc3NXYXJuaW5ncygidW5jaGVja2VkIikNCiAgICBw\ndWJsaWMgPFQ+IENvbGxlY3Rpb248VD4gZmluZEFsbChmaW5hbCBDbGFzczxU\nPiBjbHMsIENvbGxlY3Rpb24gb2lkcykgew0KICAgICAgICBhc3NlcnROb3RD\nbG9zZUludm9rZWQoKTsNCiAgICAgICAgT2JqZWN0W10gb2JqcyA9IF9icm9r\nZXIuZmluZEFsbChvaWRzLCB0cnVlLCBuZXcgRmluZENhbGxiYWNrcygpIHsN\nCiAgICAgICAgICAgIHB1YmxpYyBPYmplY3QgcHJvY2Vzc0FyZ3VtZW50KE9i\namVjdCBvaWQpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gX2Jyb2tlci5u\nZXdPYmplY3RJZChjbHMsIG9pZCk7DQogICAgICAgICAgICB9DQoNCiAgICAg\nICAgICAgIHB1YmxpYyBPYmplY3QgcHJvY2Vzc1JldHVybihPYmplY3Qgb2lk\nLCBPcGVuSlBBU3RhdGVNYW5hZ2VyIHNtKSB7DQogICAgICAgICAgICAgICAg\ncmV0dXJuIEVudGl0eU1hbmFnZXJJbXBsLnRoaXMucHJvY2Vzc1JldHVybihv\naWQsIHNtKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSk7DQogICAgICAg\nIHJldHVybiAoQ29sbGVjdGlvbjxUPikgQXJyYXlzLmFzTGlzdChvYmpzKTsN\nCiAgICB9DQoNCiAgICBAU3VwcHJlc3NXYXJuaW5ncygidW5jaGVja2VkIikN\nCiAgICBwdWJsaWMgPFQ+IFQgZmluZENhY2hlZChDbGFzczxUPiBjbHMsIE9i\namVjdCBvaWQpIHsNCiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7\nDQogICAgICAgIHJldHVybiAoVCkgX2Jyb2tlci5maW5kQ2FjaGVkKF9icm9r\nZXIubmV3T2JqZWN0SWQoY2xzLCBvaWQpLCB0aGlzKTsNCiAgICB9DQoNCiAg\nICBwdWJsaWMgQ2xhc3MgZ2V0T2JqZWN0SWRDbGFzcyhDbGFzcyBjbHMpIHsN\nCiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7DQogICAgICAgIGlm\nIChjbHMgPT0gbnVsbCkNCiAgICAgICAgICAgIHJldHVybiBudWxsOw0KICAg\nICAgICByZXR1cm4gSlBBRmFjYWRlSGVscGVyLmZyb21PcGVuSlBBT2JqZWN0\nSWRDbGFzcw0KICAgICAgICAgICAgICAgIChfYnJva2VyLmdldE9iamVjdElk\nVHlwZShjbHMpKTsNCiAgICB9DQoNCiAgICBwdWJsaWMgT3BlbkpQQUVudGl0\neVRyYW5zYWN0aW9uIGdldFRyYW5zYWN0aW9uKCkgew0KICAgICAgICBpZiAo\nX2Jyb2tlci5pc01hbmFnZWQoKSkNCiAgICAgICAgICAgIHRocm93IG5ldyBJ\nbnZhbGlkU3RhdGVFeGNlcHRpb24oX2xvYy5nZXQoImdldC1tYW5hZ2VkLXRy\nYW5zIiksDQogICAgICAgICAgICAgICAgbnVsbCwgbnVsbCwgZmFsc2UpOw0K\nICAgICAgICByZXR1cm4gdGhpczsNCiAgICB9DQoNCiAgICBwdWJsaWMgdm9p\nZCBqb2luVHJhbnNhY3Rpb24oKSB7DQogICAgICAgIGFzc2VydE5vdENsb3Nl\nSW52b2tlZCgpOw0KICAgICAgICBpZiAoIV9icm9rZXIuc3luY1dpdGhNYW5h\nZ2VkVHJhbnNhY3Rpb24oKSkNCiAgICAgICAgICAgIHRocm93IG5ldyBUcmFu\nc2FjdGlvblJlcXVpcmVkRXhjZXB0aW9uKF9sb2MuZ2V0DQogICAgICAgICAg\nICAgICAgKCJuby1tYW5hZ2VkLXRyYW5zIiksIG51bGwsIG51bGwsIGZhbHNl\nKTsNCiAgICB9DQoNCiAgICBwdWJsaWMgdm9pZCBiZWdpbigpIHsNCiAgICAg\nICAgX2Jyb2tlci5iZWdpbigpOw0KICAgIH0NCg0KICAgIHB1YmxpYyB2b2lk\nIGNvbW1pdCgpIHsNCiAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgIF9icm9r\nZXIuY29tbWl0KCk7DQogICAgICAgIH0gY2F0Y2ggKFJvbGxiYWNrRXhjZXB0\naW9uIGUpIHsNCiAgICAgICAgICAgIHRocm93IGU7DQogICAgICAgIH0gY2F0\nY2ggKElsbGVnYWxTdGF0ZUV4Y2VwdGlvbiBlKSB7DQogICAgICAgICAgICB0\naHJvdyBlOw0KICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkgew0KICAg\nICAgICAgICAgLy8gUm9sbGJhY2tFeGNlcHRpb25zIGFyZSBzcGVjaWFsIGFu\nZCBhcmVuJ3QgaGFuZGxlZCBieSB0aGUNCiAgICAgICAgICAgIC8vIG5vcm1h\nbCBleGNlcHRpb24gdHJhbnNsYXRvciwgc2luY2UgdGhlIHNwZWMgc2F5cyB0\naGV5DQogICAgICAgICAgICAvLyBzaG91bGQgYmUgdGhyb3duIHdoZW5ldmVy\nIHRoZSBjb21taXQgZmFpbHMgZm9yIGFueSByZWFzb24gYXQNCiAgICAgICAg\nICAgIC8vIGFsbCwgd2hlcmFzIHRoZSBleGNlcHRpb24gdHJhbnNsYXRvciBo\nYW5kbGVzIGV4Y2VwdGlvbnMgdGhhdA0KICAgICAgICAgICAgLy8gYXJlIGNh\ndXNlZCBmb3Igc3BlY2lmaWMgcmVhc29ucw0KICAgICAgICAgICAgdGhyb3cg\nbmV3IFJvbGxiYWNrRXhjZXB0aW9uKGUpOw0KICAgICAgICB9DQogICAgfQ0K\nDQogICAgcHVibGljIHZvaWQgcm9sbGJhY2soKSB7DQogICAgICAgIF9icm9r\nZXIucm9sbGJhY2soKTsNCiAgICB9DQoNCiAgICBwdWJsaWMgdm9pZCBjb21t\naXRBbmRSZXN1bWUoKSB7DQogICAgICAgIF9icm9rZXIuY29tbWl0QW5kUmVz\ndW1lKCk7DQogICAgfQ0KDQogICAgcHVibGljIHZvaWQgcm9sbGJhY2tBbmRS\nZXN1bWUoKSB7DQogICAgICAgIF9icm9rZXIucm9sbGJhY2tBbmRSZXN1bWUo\nKTsNCiAgICB9DQoNCiAgICBwdWJsaWMgVGhyb3dhYmxlIGdldFJvbGxiYWNr\nQ2F1c2UoKSB7DQogICAgICAgIGlmICghaXNBY3RpdmUoKSkNCiAgICAgICAg\nICAgIHRocm93IG5ldyBJbGxlZ2FsU3RhdGVFeGNlcHRpb24oX2xvYy5nZXQo\nIm5vLXRyYW5zYWN0aW9uIikNCiAgICAgICAgICAgICAgICAuZ2V0TWVzc2Fn\nZSgpKTsNCg0KICAgICAgICByZXR1cm4gX2Jyb2tlci5nZXRSb2xsYmFja0Nh\ndXNlKCk7DQogICAgfQ0KDQogICAgcHVibGljIGJvb2xlYW4gZ2V0Um9sbGJh\nY2tPbmx5KCkgew0KICAgICAgICBpZiAoIWlzQWN0aXZlKCkpDQogICAgICAg\nICAgICB0aHJvdyBuZXcgSWxsZWdhbFN0YXRlRXhjZXB0aW9uKF9sb2MuZ2V0\nKCJuby10cmFuc2FjdGlvbiIpDQogICAgICAgICAgICAgICAgLmdldE1lc3Nh\nZ2UoKSk7DQoNCiAgICAgICAgcmV0dXJuIF9icm9rZXIuZ2V0Um9sbGJhY2tP\nbmx5KCk7DQogICAgfQ0KDQogICAgcHVibGljIHZvaWQgc2V0Um9sbGJhY2tP\nbmx5KCkgew0KICAgICAgICBfYnJva2VyLnNldFJvbGxiYWNrT25seSgpOw0K\nICAgIH0NCg0KICAgIHB1YmxpYyB2b2lkIHNldFJvbGxiYWNrT25seShUaHJv\nd2FibGUgY2F1c2UpIHsNCiAgICAgICAgX2Jyb2tlci5zZXRSb2xsYmFja09u\nbHkoY2F1c2UpOw0KICAgIH0NCg0KICAgIHB1YmxpYyB2b2lkIHNldFNhdmVw\nb2ludChTdHJpbmcgbmFtZSkgew0KICAgICAgICBhc3NlcnROb3RDbG9zZUlu\ndm9rZWQoKTsNCiAgICAgICAgX2Jyb2tlci5zZXRTYXZlcG9pbnQobmFtZSk7\nDQogICAgfQ0KDQogICAgcHVibGljIHZvaWQgcm9sbGJhY2tUb1NhdmVwb2lu\ndCgpIHsNCiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7DQogICAg\nICAgIF9icm9rZXIucm9sbGJhY2tUb1NhdmVwb2ludCgpOw0KICAgIH0NCg0K\nICAgIHB1YmxpYyB2b2lkIHJvbGxiYWNrVG9TYXZlcG9pbnQoU3RyaW5nIG5h\nbWUpIHsNCiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7DQogICAg\nICAgIF9icm9rZXIucm9sbGJhY2tUb1NhdmVwb2ludChuYW1lKTsNCiAgICB9\nDQoNCiAgICBwdWJsaWMgdm9pZCByZWxlYXNlU2F2ZXBvaW50KCkgew0KICAg\nICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsNCiAgICAgICAgX2Jyb2tl\nci5yZWxlYXNlU2F2ZXBvaW50KCk7DQogICAgfQ0KDQogICAgcHVibGljIHZv\naWQgcmVsZWFzZVNhdmVwb2ludChTdHJpbmcgbmFtZSkgew0KICAgICAgICBh\nc3NlcnROb3RDbG9zZUludm9rZWQoKTsNCiAgICAgICAgX2Jyb2tlci5yZWxl\nYXNlU2F2ZXBvaW50KG5hbWUpOw0KICAgIH0NCg0KICAgIHB1YmxpYyB2b2lk\nIGZsdXNoKCkgew0KICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsN\nCiAgICAgICAgX2Jyb2tlci5hc3NlcnRPcGVuKCk7DQogICAgICAgIF9icm9r\nZXIuYXNzZXJ0QWN0aXZlVHJhbnNhY3Rpb24oKTsNCiAgICAgICAgX2Jyb2tl\nci5mbHVzaCgpOw0KICAgIH0NCg0KICAgIHB1YmxpYyB2b2lkIHByZUZsdXNo\nKCkgew0KICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsNCiAgICAg\nICAgX2Jyb2tlci5wcmVGbHVzaCgpOw0KICAgIH0NCg0KICAgIHB1YmxpYyB2\nb2lkIHZhbGlkYXRlQ2hhbmdlcygpIHsNCiAgICAgICAgYXNzZXJ0Tm90Q2xv\nc2VJbnZva2VkKCk7DQogICAgICAgIF9icm9rZXIudmFsaWRhdGVDaGFuZ2Vz\nKCk7DQogICAgfQ0KDQogICAgcHVibGljIGJvb2xlYW4gaXNBY3RpdmUoKSB7\nDQogICAgICAgIHJldHVybiBpc09wZW4oKSAmJiBfYnJva2VyLmlzQWN0aXZl\nKCk7DQogICAgfQ0KDQogICAgcHVibGljIGJvb2xlYW4gaXNTdG9yZUFjdGl2\nZSgpIHsNCiAgICAgICAgcmV0dXJuIF9icm9rZXIuaXNTdG9yZUFjdGl2ZSgp\nOw0KICAgIH0NCg0KICAgIHB1YmxpYyB2b2lkIGJlZ2luU3RvcmUoKSB7DQog\nICAgICAgIF9icm9rZXIuYmVnaW5TdG9yZSgpOw0KICAgIH0NCg0KICAgIHB1\nYmxpYyBib29sZWFuIGNvbnRhaW5zKE9iamVjdCBlbnRpdHkpIHsNCiAgICAg\nICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7DQogICAgICAgIGlmIChlbnRp\ndHkgPT0gbnVsbCkNCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAg\nICAgT3BlbkpQQVN0YXRlTWFuYWdlciBzbSA9IF9icm9rZXIuZ2V0U3RhdGVN\nYW5hZ2VyKGVudGl0eSk7DQogICAgICAgIGlmIChzbSA9PSBudWxsDQogICAg\nICAgICAgICAmJiAhSW1wbEhlbHBlci5pc01hbmFnZWRUeXBlKGdldENvbmZp\nZ3VyYXRpb24oKSwgZW50aXR5LmdldENsYXNzKCkpKQ0KICAgICAgICAgICAg\ndGhyb3cgbmV3IEFyZ3VtZW50RXhjZXB0aW9uKF9sb2MuZ2V0KCJub3QtZW50\naXR5IiwNCiAgICAgICAgICAgICAgICBlbnRpdHkuZ2V0Q2xhc3MoKSksIG51\nbGwsIG51bGwsIHRydWUpOw0KICAgICAgICByZXR1cm4gc20gIT0gbnVsbCAm\nJiAhc20uaXNEZWxldGVkKCk7DQogICAgfQ0KDQogICAgcHVibGljIGJvb2xl\nYW4gY29udGFpbnNBbGwoT2JqZWN0Li4uIGVudGl0aWVzKSB7DQogICAgICAg\nIGZvciAoT2JqZWN0IGVudGl0eSA6IGVudGl0aWVzKQ0KICAgICAgICAgICAg\naWYgKCFjb250YWlucyhlbnRpdHkpKQ0KICAgICAgICAgICAgICAgIHJldHVy\nbiBmYWxzZTsNCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgfQ0KDQogICAg\ncHVibGljIGJvb2xlYW4gY29udGFpbnNBbGwoQ29sbGVjdGlvbiBlbnRpdGll\ncykgew0KICAgICAgICBmb3IgKE9iamVjdCBlbnRpdHkgOiBlbnRpdGllcykN\nCiAgICAgICAgICAgIGlmICghY29udGFpbnMoZW50aXR5KSkNCiAgICAgICAg\nICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgIHJldHVybiB0cnVlOw0K\nICAgIH0NCg0KICAgIHB1YmxpYyB2b2lkIHBlcnNpc3QoT2JqZWN0IGVudGl0\neSkgew0KICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsNCiAgICAg\nICAgX2Jyb2tlci5wZXJzaXN0KGVudGl0eSwgdGhpcyk7DQogICAgfQ0KDQog\nICAgcHVibGljIHZvaWQgcGVyc2lzdEFsbChPYmplY3QuLi4gZW50aXRpZXMp\nIHsNCiAgICAgICAgcGVyc2lzdEFsbChBcnJheXMuYXNMaXN0KGVudGl0aWVz\nKSk7DQogICAgfQ0KDQogICAgcHVibGljIHZvaWQgcGVyc2lzdEFsbChDb2xs\nZWN0aW9uIGVudGl0aWVzKSB7DQogICAgICAgIGFzc2VydE5vdENsb3NlSW52\nb2tlZCgpOw0KICAgICAgICBfYnJva2VyLnBlcnNpc3RBbGwoZW50aXRpZXMs\nIHRoaXMpOw0KICAgIH0NCg0KICAgIHB1YmxpYyB2b2lkIHJlbW92ZShPYmpl\nY3QgZW50aXR5KSB7DQogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgp\nOw0KICAgICAgICBfYnJva2VyLmRlbGV0ZShlbnRpdHksIHRoaXMpOw0KICAg\nIH0NCg0KICAgIHB1YmxpYyB2b2lkIHJlbW92ZUFsbChPYmplY3QuLi4gZW50\naXRpZXMpIHsNCiAgICAgICAgcmVtb3ZlQWxsKEFycmF5cy5hc0xpc3QoZW50\naXRpZXMpKTsNCiAgICB9DQoNCiAgICBwdWJsaWMgdm9pZCByZW1vdmVBbGwo\nQ29sbGVjdGlvbiBlbnRpdGllcykgew0KICAgICAgICBhc3NlcnROb3RDbG9z\nZUludm9rZWQoKTsNCiAgICAgICAgX2Jyb2tlci5kZWxldGVBbGwoZW50aXRp\nZXMsIHRoaXMpOw0KICAgIH0NCg0KICAgIHB1YmxpYyB2b2lkIHJlbGVhc2Uo\nT2JqZWN0IGVudGl0eSkgew0KICAgICAgICBhc3NlcnROb3RDbG9zZUludm9r\nZWQoKTsNCiAgICAgICAgX2Jyb2tlci5yZWxlYXNlKGVudGl0eSwgdGhpcyk7\nDQogICAgfQ0KDQogICAgcHVibGljIHZvaWQgcmVsZWFzZUFsbChDb2xsZWN0\naW9uIGVudGl0aWVzKSB7DQogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tl\nZCgpOw0KICAgICAgICBfYnJva2VyLnJlbGVhc2VBbGwoZW50aXRpZXMsIHRo\naXMpOw0KICAgIH0NCg0KICAgIHB1YmxpYyB2b2lkIHJlbGVhc2VBbGwoT2Jq\nZWN0Li4uIGVudGl0aWVzKSB7DQogICAgICAgIHJlbGVhc2VBbGwoQXJyYXlz\nLmFzTGlzdChlbnRpdGllcykpOw0KICAgIH0NCg0KICAgIHB1YmxpYyB2b2lk\nIHJlZnJlc2goT2JqZWN0IGVudGl0eSkgew0KICAgICAgICBhc3NlcnROb3RD\nbG9zZUludm9rZWQoKTsNCiAgICAgICAgX2Jyb2tlci5hc3NlcnRXcml0ZU9w\nZXJhdGlvbigpOw0KICAgICAgICBfYnJva2VyLnJlZnJlc2goZW50aXR5LCB0\naGlzKTsNCiAgICB9DQoNCiAgICBwdWJsaWMgdm9pZCByZWZyZXNoQWxsKCkg\new0KICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsNCiAgICAgICAg\nX2Jyb2tlci5hc3NlcnRXcml0ZU9wZXJhdGlvbigpOw0KICAgICAgICBfYnJv\na2VyLnJlZnJlc2hBbGwoX2Jyb2tlci5nZXRUcmFuc2FjdGlvbmFsT2JqZWN0\ncygpLCB0aGlzKTsNCiAgICB9DQoNCiAgICBwdWJsaWMgdm9pZCByZWZyZXNo\nQWxsKENvbGxlY3Rpb24gZW50aXRpZXMpIHsNCiAgICAgICAgYXNzZXJ0Tm90\nQ2xvc2VJbnZva2VkKCk7DQogICAgICAgIF9icm9rZXIuYXNzZXJ0V3JpdGVP\ncGVyYXRpb24oKTsNCiAgICAgICAgX2Jyb2tlci5yZWZyZXNoQWxsKGVudGl0\naWVzLCB0aGlzKTsNCiAgICB9DQoNCiAgICBwdWJsaWMgdm9pZCByZWZyZXNo\nQWxsKE9iamVjdC4uLiBlbnRpdGllcykgew0KICAgICAgICByZWZyZXNoQWxs\nKEFycmF5cy5hc0xpc3QoZW50aXRpZXMpKTsNCiAgICB9DQoNCiAgICBwdWJs\naWMgdm9pZCByZXRyaWV2ZShPYmplY3QgZW50aXR5KSB7DQogICAgICAgIGFz\nc2VydE5vdENsb3NlSW52b2tlZCgpOw0KICAgICAgICBfYnJva2VyLnJldHJp\nZXZlKGVudGl0eSwgdHJ1ZSwgdGhpcyk7DQogICAgfQ0KDQogICAgcHVibGlj\nIHZvaWQgcmV0cmlldmVBbGwoQ29sbGVjdGlvbiBlbnRpdGllcykgew0KICAg\nICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsNCiAgICAgICAgX2Jyb2tl\nci5yZXRyaWV2ZUFsbChlbnRpdGllcywgdHJ1ZSwgdGhpcyk7DQogICAgfQ0K\nDQogICAgcHVibGljIHZvaWQgcmV0cmlldmVBbGwoT2JqZWN0Li4uIGVudGl0\naWVzKSB7DQogICAgICAgIHJldHJpZXZlQWxsKEFycmF5cy5hc0xpc3QoZW50\naXRpZXMpKTsNCiAgICB9DQoNCiAgICBwdWJsaWMgdm9pZCBldmljdChPYmpl\nY3QgZW50aXR5KSB7DQogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgp\nOw0KICAgICAgICBfYnJva2VyLmV2aWN0KGVudGl0eSwgdGhpcyk7DQogICAg\nfQ0KDQogICAgcHVibGljIHZvaWQgZXZpY3RBbGwoQ29sbGVjdGlvbiBlbnRp\ndGllcykgew0KICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsNCiAg\nICAgICAgX2Jyb2tlci5ldmljdEFsbChlbnRpdGllcywgdGhpcyk7DQogICAg\nfQ0KDQogICAgcHVibGljIHZvaWQgZXZpY3RBbGwoT2JqZWN0Li4uIGVudGl0\naWVzKSB7DQogICAgICAgIGV2aWN0QWxsKEFycmF5cy5hc0xpc3QoZW50aXRp\nZXMpKTsNCiAgICB9DQoNCiAgICBwdWJsaWMgdm9pZCBldmljdEFsbCgpIHsN\nCiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7DQogICAgICAgIF9i\ncm9rZXIuZXZpY3RBbGwodGhpcyk7DQogICAgfQ0KDQogICAgcHVibGljIHZv\naWQgZXZpY3RBbGwoQ2xhc3MgY2xzKSB7DQogICAgICAgIGFzc2VydE5vdENs\nb3NlSW52b2tlZCgpOw0KICAgICAgICBfYnJva2VyLmV2aWN0QWxsKF9icm9r\nZXIubmV3RXh0ZW50KGNscywgdHJ1ZSksIHRoaXMpOw0KICAgIH0NCg0KICAg\nIHB1YmxpYyB2b2lkIGV2aWN0QWxsKEV4dGVudCBleHRlbnQpIHsNCiAgICAg\nICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7DQogICAgICAgIF9icm9rZXIu\nZXZpY3RBbGwoKChFeHRlbnRJbXBsKSBleHRlbnQpLmdldERlbGVnYXRlKCks\nIHRoaXMpOw0KICAgIH0NCg0KICAgIEBTdXBwcmVzc1dhcm5pbmdzKCJ1bmNo\nZWNrZWQiKQ0KICAgIHB1YmxpYyA8VD4gVCBkZXRhY2goVCBlbnRpdHkpIHsN\nCiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7DQogICAgICAgIHJl\ndHVybiAoVCkgX2Jyb2tlci5kZXRhY2goZW50aXR5LCB0aGlzKTsNCiAgICB9\nDQoNCiAgICBwdWJsaWMgT2JqZWN0W10gZGV0YWNoQWxsKE9iamVjdC4uLiBl\nbnRpdGllcykgew0KICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsN\nCiAgICAgICAgcmV0dXJuIF9icm9rZXIuZGV0YWNoQWxsKEFycmF5cy5hc0xp\nc3QoZW50aXRpZXMpLCB0aGlzKTsNCiAgICB9DQoNCiAgICBwdWJsaWMgQ29s\nbGVjdGlvbiBkZXRhY2hBbGwoQ29sbGVjdGlvbiBlbnRpdGllcykgew0KICAg\nICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsNCiAgICAgICAgcmV0dXJu\nIEFycmF5cy5hc0xpc3QoX2Jyb2tlci5kZXRhY2hBbGwoZW50aXRpZXMsIHRo\naXMpKTsNCiAgICB9DQoNCiAgICBAU3VwcHJlc3NXYXJuaW5ncygidW5jaGVj\na2VkIikNCiAgICBwdWJsaWMgPFQ+IFQgbWVyZ2UoVCBlbnRpdHkpIHsNCiAg\nICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7DQogICAgICAgIHJldHVy\nbiAoVCkgX2Jyb2tlci5hdHRhY2goZW50aXR5LCB0cnVlLCB0aGlzKTsNCiAg\nICB9DQoNCiAgICBwdWJsaWMgT2JqZWN0W10gbWVyZ2VBbGwoT2JqZWN0Li4u\nIGVudGl0aWVzKSB7DQogICAgICAgIGlmIChlbnRpdGllcy5sZW5ndGggPT0g\nMCkNCiAgICAgICAgICAgIHJldHVybiBFTVBUWV9PQkpFQ1RTOw0KICAgICAg\nICByZXR1cm4gbWVyZ2VBbGwoQXJyYXlzLmFzTGlzdChlbnRpdGllcykpLnRv\nQXJyYXkoKTsNCiAgICB9DQoNCiAgICBwdWJsaWMgQ29sbGVjdGlvbiBtZXJn\nZUFsbChDb2xsZWN0aW9uIGVudGl0aWVzKSB7DQogICAgICAgIGFzc2VydE5v\ndENsb3NlSW52b2tlZCgpOw0KICAgICAgICByZXR1cm4gQXJyYXlzLmFzTGlz\ndChfYnJva2VyLmF0dGFjaEFsbChlbnRpdGllcywgdHJ1ZSwgdGhpcykpOw0K\nICAgIH0NCg0KICAgIHB1YmxpYyB2b2lkIHRyYW5zYWN0aW9uYWwoT2JqZWN0\nIGVudGl0eSwgYm9vbGVhbiB1cGRhdGVWZXJzaW9uKSB7DQogICAgICAgIGFz\nc2VydE5vdENsb3NlSW52b2tlZCgpOw0KICAgICAgICBfYnJva2VyLnRyYW5z\nYWN0aW9uYWwoZW50aXR5LCB1cGRhdGVWZXJzaW9uLCB0aGlzKTsNCiAgICB9\nDQoNCiAgICBwdWJsaWMgdm9pZCB0cmFuc2FjdGlvbmFsQWxsKENvbGxlY3Rp\nb24gb2JqcywgYm9vbGVhbiB1cGRhdGVWZXJzaW9uKSB7DQogICAgICAgIGFz\nc2VydE5vdENsb3NlSW52b2tlZCgpOw0KICAgICAgICBfYnJva2VyLnRyYW5z\nYWN0aW9uYWxBbGwob2JqcywgdXBkYXRlVmVyc2lvbiwgdGhpcyk7DQogICAg\nfQ0KDQogICAgcHVibGljIHZvaWQgdHJhbnNhY3Rpb25hbEFsbChPYmplY3Rb\nXSBvYmpzLCBib29sZWFuIHVwZGF0ZVZlcnNpb24pIHsNCiAgICAgICAgYXNz\nZXJ0Tm90Q2xvc2VJbnZva2VkKCk7DQogICAgICAgIF9icm9rZXIudHJhbnNh\nY3Rpb25hbEFsbChBcnJheXMuYXNMaXN0KG9ianMpLCB1cGRhdGVWZXJzaW9u\nLCB0aGlzKTsNCiAgICB9DQoNCiAgICBwdWJsaWMgdm9pZCBub250cmFuc2Fj\ndGlvbmFsKE9iamVjdCBlbnRpdHkpIHsNCiAgICAgICAgYXNzZXJ0Tm90Q2xv\nc2VJbnZva2VkKCk7DQogICAgICAgIF9icm9rZXIubm9udHJhbnNhY3Rpb25h\nbChlbnRpdHksIHRoaXMpOw0KICAgIH0NCg0KICAgIHB1YmxpYyB2b2lkIG5v\nbnRyYW5zYWN0aW9uYWxBbGwoQ29sbGVjdGlvbiBvYmpzKSB7DQogICAgICAg\nIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOw0KICAgICAgICBfYnJva2VyLm5v\nbnRyYW5zYWN0aW9uYWxBbGwob2JqcywgdGhpcyk7DQogICAgfQ0KDQogICAg\ncHVibGljIHZvaWQgbm9udHJhbnNhY3Rpb25hbEFsbChPYmplY3RbXSBvYmpz\nKSB7DQogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOw0KICAgICAg\nICBfYnJva2VyLm5vbnRyYW5zYWN0aW9uYWxBbGwoQXJyYXlzLmFzTGlzdChv\nYmpzKSwgdGhpcyk7DQogICAgfQ0KDQogICAgcHVibGljIEdlbmVyYXRvciBn\nZXROYW1lZEdlbmVyYXRvcihTdHJpbmcgbmFtZSkgew0KICAgICAgICBhc3Nl\ncnROb3RDbG9zZUludm9rZWQoKTsNCiAgICAgICAgdHJ5IHsNCiAgICAgICAg\nICAgIFNlcXVlbmNlTWV0YURhdGEgbWV0YSA9IF9icm9rZXIuZ2V0Q29uZmln\ndXJhdGlvbigpLg0KICAgICAgICAgICAgICAgIGdldE1ldGFEYXRhUmVwb3Np\ndG9yeUluc3RhbmNlKCkuZ2V0U2VxdWVuY2VNZXRhRGF0YShuYW1lLA0KICAg\nICAgICAgICAgICAgIF9icm9rZXIuZ2V0Q2xhc3NMb2FkZXIoKSwgdHJ1ZSk7\nDQogICAgICAgICAgICBTZXEgc2VxID0gbWV0YS5nZXRJbnN0YW5jZShfYnJv\na2VyLmdldENsYXNzTG9hZGVyKCkpOw0KICAgICAgICAgICAgcmV0dXJuIG5l\ndyBHZW5lcmF0b3JJbXBsKHNlcSwgbmFtZSwgX2Jyb2tlciwgbnVsbCk7DQog\nICAgICAgIH0gY2F0Y2ggKFJ1bnRpbWVFeGNlcHRpb24gcmUpIHsNCiAgICAg\nICAgICAgIHRocm93IFBlcnNpc3RlbmNlRXhjZXB0aW9ucy50b1BlcnNpc3Rl\nbmNlRXhjZXB0aW9uKHJlKTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIHB1\nYmxpYyBHZW5lcmF0b3IgZ2V0SWRHZW5lcmF0b3IoQ2xhc3MgZm9yQ2xhc3Mp\nIHsNCiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7DQogICAgICAg\nIHRyeSB7DQogICAgICAgICAgICBDbGFzc01ldGFEYXRhIG1ldGEgPSBfYnJv\na2VyLmdldENvbmZpZ3VyYXRpb24oKS4NCiAgICAgICAgICAgICAgICBnZXRN\nZXRhRGF0YVJlcG9zaXRvcnlJbnN0YW5jZSgpLmdldE1ldGFEYXRhKGZvckNs\nYXNzLA0KICAgICAgICAgICAgICAgIF9icm9rZXIuZ2V0Q2xhc3NMb2FkZXIo\nKSwgdHJ1ZSk7DQogICAgICAgICAgICBTZXEgc2VxID0gX2Jyb2tlci5nZXRJ\nZGVudGl0eVNlcXVlbmNlKG1ldGEpOw0KICAgICAgICAgICAgcmV0dXJuIChz\nZXEgPT0gbnVsbCkgPyBudWxsIDogbmV3IEdlbmVyYXRvckltcGwoc2VxLCBu\ndWxsLCBfYnJva2VyLA0KICAgICAgICAgICAgICAgIG1ldGEpOw0KICAgICAg\nICB9IGNhdGNoIChFeGNlcHRpb24gZSkgew0KICAgICAgICAgICAgdGhyb3cg\nUGVyc2lzdGVuY2VFeGNlcHRpb25zLnRvUGVyc2lzdGVuY2VFeGNlcHRpb24o\nZSk7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICBwdWJsaWMgR2VuZXJhdG9y\nIGdldEZpZWxkR2VuZXJhdG9yKENsYXNzIGZvckNsYXNzLCBTdHJpbmcgZmll\nbGROYW1lKSB7DQogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOw0K\nICAgICAgICB0cnkgew0KICAgICAgICAgICAgQ2xhc3NNZXRhRGF0YSBtZXRh\nID0gX2Jyb2tlci5nZXRDb25maWd1cmF0aW9uKCkuDQogICAgICAgICAgICAg\nICAgZ2V0TWV0YURhdGFSZXBvc2l0b3J5SW5zdGFuY2UoKS5nZXRNZXRhRGF0\nYShmb3JDbGFzcywNCiAgICAgICAgICAgICAgICBfYnJva2VyLmdldENsYXNz\nTG9hZGVyKCksIHRydWUpOw0KICAgICAgICAgICAgRmllbGRNZXRhRGF0YSBm\nbWQgPSBtZXRhLmdldEZpZWxkKGZpZWxkTmFtZSk7DQogICAgICAgICAgICBp\nZiAoZm1kID09IG51bGwpDQogICAgICAgICAgICAgICAgdGhyb3cgbmV3IEFy\nZ3VtZW50RXhjZXB0aW9uKF9sb2MuZ2V0KCJuby1uYW1lZC1maWVsZCIsDQog\nICAgICAgICAgICAgICAgICAgIGZvckNsYXNzLCBmaWVsZE5hbWUpLCBudWxs\nLCBudWxsLCBmYWxzZSk7DQoNCiAgICAgICAgICAgIFNlcSBzZXEgPSBfYnJv\na2VyLmdldFZhbHVlU2VxdWVuY2UoZm1kKTsNCiAgICAgICAgICAgIHJldHVy\nbiAoc2VxID09IG51bGwpID8gbnVsbCA6IG5ldyBHZW5lcmF0b3JJbXBsKHNl\ncSwgbnVsbCwgX2Jyb2tlciwNCiAgICAgICAgICAgICAgICBtZXRhKTsNCiAg\nICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsNCiAgICAgICAgICAgIHRo\ncm93IFBlcnNpc3RlbmNlRXhjZXB0aW9ucy50b1BlcnNpc3RlbmNlRXhjZXB0\naW9uKGUpOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgcHVibGljIDxUPiBF\neHRlbnQ8VD4gY3JlYXRlRXh0ZW50KENsYXNzPFQ+IGNscywgYm9vbGVhbiBz\ndWJjbGFzc2VzKSB7DQogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgp\nOw0KICAgICAgICByZXR1cm4gbmV3IEV4dGVudEltcGw8VD4odGhpcywgX2Jy\nb2tlci5uZXdFeHRlbnQoY2xzLCBzdWJjbGFzc2VzKSk7DQogICAgfQ0KDQog\nICAgcHVibGljIE9wZW5KUEFRdWVyeSBjcmVhdGVRdWVyeShTdHJpbmcgcXVl\ncnkpIHsNCiAgICAgICAgcmV0dXJuIGNyZWF0ZVF1ZXJ5KEpQUUxQYXJzZXIu\nTEFOR19KUFFMLCBxdWVyeSk7DQogICAgfQ0KDQogICAgcHVibGljIE9wZW5K\nUEFRdWVyeSBjcmVhdGVRdWVyeShTdHJpbmcgbGFuZ3VhZ2UsIFN0cmluZyBx\ndWVyeSkgew0KICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsNCiAg\nICAgICAgcmV0dXJuIG5ldyBRdWVyeUltcGwodGhpcywgX2Jyb2tlci5uZXdR\ndWVyeShsYW5ndWFnZSwgcXVlcnkpKTsNCiAgICB9DQoNCiAgICBwdWJsaWMg\nT3BlbkpQQVF1ZXJ5IGNyZWF0ZVF1ZXJ5KFF1ZXJ5IHF1ZXJ5KSB7DQogICAg\nICAgIGlmIChxdWVyeSA9PSBudWxsKQ0KICAgICAgICAgICAgcmV0dXJuIGNy\nZWF0ZVF1ZXJ5KChTdHJpbmcpIG51bGwpOw0KICAgICAgICBhc3NlcnROb3RD\nbG9zZUludm9rZWQoKTsNCiAgICAgICAgb3JnLmFwYWNoZS5vcGVuanBhLmtl\ncm5lbC5RdWVyeSBxID0gKChRdWVyeUltcGwpIHF1ZXJ5KS5nZXREZWxlZ2F0\nZSgpOw0KICAgICAgICByZXR1cm4gbmV3IFF1ZXJ5SW1wbCh0aGlzLCBfYnJv\na2VyLm5ld1F1ZXJ5KHEuZ2V0TGFuZ3VhZ2UoKSwNCiAgICAgICAgICAgIHEp\nKTsNCiAgICB9DQoNCiAgICBwdWJsaWMgT3BlbkpQQVF1ZXJ5IGNyZWF0ZU5h\nbWVkUXVlcnkoU3RyaW5nIG5hbWUpIHsNCiAgICAgICAgYXNzZXJ0Tm90Q2xv\nc2VJbnZva2VkKCk7DQogICAgICAgIF9icm9rZXIuYXNzZXJ0T3BlbigpOw0K\nICAgICAgICB0cnkgew0KICAgICAgICAgICAgUXVlcnlNZXRhRGF0YSBtZXRh\nID0gX2Jyb2tlci5nZXRDb25maWd1cmF0aW9uKCkuDQogICAgICAgICAgICAg\nICAgZ2V0TWV0YURhdGFSZXBvc2l0b3J5SW5zdGFuY2UoKS5nZXRRdWVyeU1l\ndGFEYXRhKG51bGwsIG5hbWUsDQogICAgICAgICAgICAgICAgX2Jyb2tlci5n\nZXRDbGFzc0xvYWRlcigpLCB0cnVlKTsNCiAgICAgICAgICAgIG9yZy5hcGFj\naGUub3BlbmpwYS5rZXJuZWwuUXVlcnkgZGVsID0NCiAgICAgICAgICAgICAg\nICBfYnJva2VyLm5ld1F1ZXJ5KG1ldGEuZ2V0TGFuZ3VhZ2UoKSwgbnVsbCk7\nDQogICAgICAgICAgICBtZXRhLnNldEludG8oZGVsKTsNCiAgICAgICAgICAg\nIGRlbC5jb21waWxlKCk7DQoNCiAgICAgICAgICAgIE9wZW5KUEFRdWVyeSBx\nID0gbmV3IFF1ZXJ5SW1wbCh0aGlzLCBkZWwpOw0KICAgICAgICAgICAgU3Ry\naW5nW10gaGludHMgPSBtZXRhLmdldEhpbnRLZXlzKCk7DQogICAgICAgICAg\nICBPYmplY3RbXSB2YWx1ZXMgPSBtZXRhLmdldEhpbnRWYWx1ZXMoKTsNCiAg\nICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgaGludHMubGVuZ3RoOyBp\nKyspDQogICAgICAgICAgICAgICAgcS5zZXRIaW50KGhpbnRzW2ldLCB2YWx1\nZXNbaV0pOw0KICAgICAgICAgICAgcmV0dXJuIHE7DQogICAgICAgIH0gY2F0\nY2ggKFJ1bnRpbWVFeGNlcHRpb24gcmUpIHsNCiAgICAgICAgICAgIHRocm93\nIFBlcnNpc3RlbmNlRXhjZXB0aW9ucy50b1BlcnNpc3RlbmNlRXhjZXB0aW9u\nKHJlKTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIHB1YmxpYyBPcGVuSlBB\nUXVlcnkgY3JlYXRlTmF0aXZlUXVlcnkoU3RyaW5nIHF1ZXJ5KSB7DQogICAg\nICAgIHZhbGlkYXRlU1FMKHF1ZXJ5KTsNCiAgICAgICAgcmV0dXJuIGNyZWF0\nZVF1ZXJ5KFF1ZXJ5TGFuZ3VhZ2VzLkxBTkdfU1FMLCBxdWVyeSk7DQogICAg\nfQ0KDQogICAgcHVibGljIE9wZW5KUEFRdWVyeSBjcmVhdGVOYXRpdmVRdWVy\neShTdHJpbmcgcXVlcnksIENsYXNzIGNscykgew0KICAgICAgICByZXR1cm4g\nY3JlYXRlTmF0aXZlUXVlcnkocXVlcnkpLnNldFJlc3VsdENsYXNzKGNscyk7\nDQogICAgfQ0KDQogICAgcHVibGljIE9wZW5KUEFRdWVyeSBjcmVhdGVOYXRp\ndmVRdWVyeShTdHJpbmcgcXVlcnksIFN0cmluZyBtYXBwaW5nTmFtZSkgew0K\nICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsNCiAgICAgICAgdmFs\naWRhdGVTUUwocXVlcnkpOw0KICAgICAgICBvcmcuYXBhY2hlLm9wZW5qcGEu\na2VybmVsLlF1ZXJ5IGtlcm5lbFF1ZXJ5ID0gX2Jyb2tlci5uZXdRdWVyeSgN\nCiAgICAgICAgICAgIFF1ZXJ5TGFuZ3VhZ2VzLkxBTkdfU1FMLCBxdWVyeSk7\nDQogICAgICAgIGtlcm5lbFF1ZXJ5LnNldFJlc3VsdE1hcHBpbmcobnVsbCwg\nbWFwcGluZ05hbWUpOw0KICAgICAgICByZXR1cm4gbmV3IFF1ZXJ5SW1wbCh0\naGlzLCBrZXJuZWxRdWVyeSk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog\nVmFsaWRhdGUgdGhhdCB0aGUgdXNlciBwcm92aWRlZCBTUUwuDQogICAgICov\nDQogICAgcHJpdmF0ZSBzdGF0aWMgdm9pZCB2YWxpZGF0ZVNRTChTdHJpbmcg\ncXVlcnkpIHsNCiAgICAgICAgaWYgKFN0cmluZ1V0aWxzLnRyaW1Ub051bGwo\ncXVlcnkpID09IG51bGwpDQogICAgICAgICAgICB0aHJvdyBuZXcgQXJndW1l\nbnRFeGNlcHRpb24oX2xvYy5nZXQoIm5vLXNxbCIpLCBudWxsLCBudWxsLCBm\nYWxzZSk7DQogICAgfQ0KDQogICAgcHVibGljIHZvaWQgc2V0Rmx1c2hNb2Rl\nKEZsdXNoTW9kZVR5cGUgZmx1c2hNb2RlKSB7DQogICAgICAgIGFzc2VydE5v\ndENsb3NlSW52b2tlZCgpOw0KICAgICAgICBfYnJva2VyLmFzc2VydE9wZW4o\nKTsNCiAgICAgICAgX2Jyb2tlci5nZXRGZXRjaENvbmZpZ3VyYXRpb24oKS5z\nZXRGbHVzaEJlZm9yZVF1ZXJpZXMNCiAgICAgICAgICAgICh0b0ZsdXNoQmVm\nb3JlUXVlcmllcyhmbHVzaE1vZGUpKTsNCiAgICB9DQoNCiAgICBwdWJsaWMg\nRmx1c2hNb2RlVHlwZSBnZXRGbHVzaE1vZGUoKSB7DQogICAgICAgIGFzc2Vy\ndE5vdENsb3NlSW52b2tlZCgpOw0KICAgICAgICBfYnJva2VyLmFzc2VydE9w\nZW4oKTsNCiAgICAgICAgcmV0dXJuIGZyb21GbHVzaEJlZm9yZVF1ZXJpZXMo\nX2Jyb2tlci5nZXRGZXRjaENvbmZpZ3VyYXRpb24oKS4NCiAgICAgICAgICAg\nIGdldEZsdXNoQmVmb3JlUXVlcmllcygpKTsNCiAgICB9DQoNCiAgICAvKioN\nCiAgICAgKiBUcmFuc2xhdGUgb3VyIGludGVybmFsIGZsdXNoIGNvbnN0YW50\nIHRvIGEgZmx1c2ggbW9kZSBlbnVtIHZhbHVlLg0KICAgICAqLw0KICAgIHN0\nYXRpYyBGbHVzaE1vZGVUeXBlIGZyb21GbHVzaEJlZm9yZVF1ZXJpZXMoaW50\nIGZsdXNoKSB7DQogICAgICAgIHN3aXRjaCAoZmx1c2gpIHsNCiAgICAgICAg\nICAgIGNhc2UgUXVlcnlGbHVzaE1vZGVzLkZMVVNIX1RSVUU6DQogICAgICAg\nICAgICAgICAgcmV0dXJuIEZsdXNoTW9kZVR5cGUuQVVUTzsNCiAgICAgICAg\nICAgIGNhc2UgUXVlcnlGbHVzaE1vZGVzLkZMVVNIX0ZBTFNFOg0KICAgICAg\nICAgICAgICAgIHJldHVybiBGbHVzaE1vZGVUeXBlLkNPTU1JVDsNCiAgICAg\nICAgICAgIGRlZmF1bHQ6DQogICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7\nDQogICAgICAgIH0NCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiBUcmFuc2xh\ndGUgYSBmbHVzaCBtb2RlIGVudW0gdmFsdWUgdG8gb3VyIGludGVybmFsIGZs\ndXNoIGNvbnN0YW50Lg0KICAgICAqLw0KICAgIHN0YXRpYyBpbnQgdG9GbHVz\naEJlZm9yZVF1ZXJpZXMoRmx1c2hNb2RlVHlwZSBmbHVzaE1vZGUpIHsNCiAg\nICAgICAgLy8gY2hvb3NlIGRlZmF1bHQgZm9yIG51bGwNCiAgICAgICAgaWYg\nKGZsdXNoTW9kZSA9PSBudWxsKQ0KICAgICAgICAgICAgcmV0dXJuIFF1ZXJ5\nRmx1c2hNb2Rlcy5GTFVTSF9XSVRIX0NPTk5FQ1RJT047DQogICAgICAgIGlm\nIChmbHVzaE1vZGUgPT0gRmx1c2hNb2RlVHlwZS5BVVRPKQ0KICAgICAgICAg\nICAgcmV0dXJuIFF1ZXJ5Rmx1c2hNb2Rlcy5GTFVTSF9UUlVFOw0KICAgICAg\nICBpZiAoZmx1c2hNb2RlID09IEZsdXNoTW9kZVR5cGUuQ09NTUlUKQ0KICAg\nICAgICAgICAgcmV0dXJuIFF1ZXJ5Rmx1c2hNb2Rlcy5GTFVTSF9GQUxTRTsN\nCiAgICAgICAgdGhyb3cgbmV3IEFyZ3VtZW50RXhjZXB0aW9uKGZsdXNoTW9k\nZS50b1N0cmluZygpLCBudWxsLCBudWxsLCBmYWxzZSk7DQogICAgfQ0KDQog\nICAgcHVibGljIHZvaWQgY2xlYXIoKSB7DQogICAgICAgIGFzc2VydE5vdENs\nb3NlSW52b2tlZCgpOw0KICAgICAgICBfYnJva2VyLmRldGFjaEFsbCh0aGlz\nLCBmYWxzZSk7DQogICAgfQ0KDQogICAgcHVibGljIE9iamVjdCBnZXREZWxl\nZ2F0ZSgpIHsNCiAgICAgICAgX2Jyb2tlci5hc3NlcnRPcGVuKCk7DQogICAg\nICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOw0KICAgICAgICByZXR1cm4g\ndGhpczsNCiAgICB9DQoNCiAgICBwdWJsaWMgTG9ja01vZGVUeXBlIGdldExv\nY2tNb2RlKE9iamVjdCBlbnRpdHkpIHsNCiAgICAgICAgYXNzZXJ0Tm90Q2xv\nc2VJbnZva2VkKCk7DQogICAgICAgIHJldHVybiBmcm9tTG9ja0xldmVsKF9i\ncm9rZXIuZ2V0TG9ja0xldmVsKGVudGl0eSkpOw0KICAgIH0NCg0KICAgIHB1\nYmxpYyB2b2lkIGxvY2soT2JqZWN0IGVudGl0eSwgTG9ja01vZGVUeXBlIG1v\nZGUpIHsNCiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7DQogICAg\nICAgIF9icm9rZXIubG9jayhlbnRpdHksIHRvTG9ja0xldmVsKG1vZGUpLCAt\nMSwgdGhpcyk7DQogICAgfQ0KDQogICAgcHVibGljIHZvaWQgbG9jayhPYmpl\nY3QgZW50aXR5KSB7DQogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgp\nOw0KICAgICAgICBfYnJva2VyLmxvY2soZW50aXR5LCB0aGlzKTsNCiAgICB9\nDQoNCiAgICBwdWJsaWMgdm9pZCBsb2NrKE9iamVjdCBlbnRpdHksIExvY2tN\nb2RlVHlwZSBtb2RlLCBpbnQgdGltZW91dCkgew0KICAgICAgICBhc3NlcnRO\nb3RDbG9zZUludm9rZWQoKTsNCiAgICAgICAgX2Jyb2tlci5sb2NrKGVudGl0\neSwgdG9Mb2NrTGV2ZWwobW9kZSksIHRpbWVvdXQsIHRoaXMpOw0KICAgIH0N\nCg0KICAgIHB1YmxpYyB2b2lkIGxvY2tBbGwoQ29sbGVjdGlvbiBlbnRpdGll\ncykgew0KICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsNCiAgICAg\nICAgX2Jyb2tlci5sb2NrQWxsKGVudGl0aWVzLCB0aGlzKTsNCiAgICB9DQoN\nCiAgICBwdWJsaWMgdm9pZCBsb2NrQWxsKENvbGxlY3Rpb24gZW50aXRpZXMs\nIExvY2tNb2RlVHlwZSBtb2RlLCBpbnQgdGltZW91dCkgew0KICAgICAgICBh\nc3NlcnROb3RDbG9zZUludm9rZWQoKTsNCiAgICAgICAgX2Jyb2tlci5sb2Nr\nQWxsKGVudGl0aWVzLCB0b0xvY2tMZXZlbChtb2RlKSwgdGltZW91dCwgdGhp\ncyk7DQogICAgfQ0KDQogICAgcHVibGljIHZvaWQgbG9ja0FsbChPYmplY3Qu\nLi4gZW50aXRpZXMpIHsNCiAgICAgICAgbG9ja0FsbChBcnJheXMuYXNMaXN0\nKGVudGl0aWVzKSk7DQogICAgfQ0KDQogICAgcHVibGljIHZvaWQgbG9ja0Fs\nbChPYmplY3RbXSBlbnRpdGllcywgTG9ja01vZGVUeXBlIG1vZGUsIGludCB0\naW1lb3V0KSB7DQogICAgICAgIGxvY2tBbGwoQXJyYXlzLmFzTGlzdChlbnRp\ndGllcyksIG1vZGUsIHRpbWVvdXQpOw0KICAgIH0NCg0KICAgIC8qKg0KICAg\nICAqIFRyYW5zbGF0ZSBvdXIgaW50ZXJuYWwgbG9jayBsZXZlbCB0byBhIGph\ndmF4LnBlcnNpc3RlbmNlIGVudW0gdmFsdWUuDQogICAgICovDQogICAgc3Rh\ndGljIExvY2tNb2RlVHlwZSBmcm9tTG9ja0xldmVsKGludCBsZXZlbCkgew0K\nICAgICAgICBpZiAobGV2ZWwgPCBMb2NrTGV2ZWxzLkxPQ0tfUkVBRCkNCiAg\nICAgICAgICAgIHJldHVybiBudWxsOw0KICAgICAgICBpZiAobGV2ZWwgPCBM\nb2NrTGV2ZWxzLkxPQ0tfV1JJVEUpDQogICAgICAgICAgICByZXR1cm4gTG9j\na01vZGVUeXBlLlJFQUQ7DQogICAgICAgIHJldHVybiBMb2NrTW9kZVR5cGUu\nV1JJVEU7DQogICAgfQ0KDQogICAgLyoqDQogICAgICogVHJhbnNsYXRlIHRo\nZSBqYXZheC5wZXJzaXN0ZW5jZSBlbnVtIHZhbHVlIHRvIG91ciBpbnRlcm5h\nbCBsb2NrIGxldmVsLg0KICAgICAqLw0KICAgIHN0YXRpYyBpbnQgdG9Mb2Nr\nTGV2ZWwoTG9ja01vZGVUeXBlIG1vZGUpIHsNCiAgICAgICAgaWYgKG1vZGUg\nPT0gbnVsbCkNCiAgICAgICAgICAgIHJldHVybiBMb2NrTGV2ZWxzLkxPQ0tf\nTk9ORTsNCiAgICAgICAgaWYgKG1vZGUgPT0gTG9ja01vZGVUeXBlLlJFQUQp\nDQogICAgICAgICAgICByZXR1cm4gTG9ja0xldmVscy5MT0NLX1JFQUQ7DQog\nICAgICAgIGlmIChtb2RlID09IExvY2tNb2RlVHlwZS5XUklURSkNCiAgICAg\nICAgICAgIHJldHVybiBMb2NrTGV2ZWxzLkxPQ0tfV1JJVEU7DQogICAgICAg\nIHRocm93IG5ldyBBcmd1bWVudEV4Y2VwdGlvbihtb2RlLnRvU3RyaW5nKCks\nIG51bGwsIG51bGwsIHRydWUpOw0KICAgIH0NCg0KICAgIHB1YmxpYyBib29s\nZWFuIGNhbmNlbEFsbCgpIHsNCiAgICAgICAgcmV0dXJuIF9icm9rZXIuY2Fu\nY2VsQWxsKCk7DQogICAgfQ0KDQogICAgcHVibGljIE9iamVjdCBnZXRDb25u\nZWN0aW9uKCkgew0KICAgICAgICByZXR1cm4gX2Jyb2tlci5nZXRDb25uZWN0\naW9uKCk7DQogICAgfQ0KDQogICAgcHVibGljIENvbGxlY3Rpb24gZ2V0TWFu\nYWdlZE9iamVjdHMoKSB7DQogICAgICAgIHJldHVybiBfYnJva2VyLmdldE1h\nbmFnZWRPYmplY3RzKCk7DQogICAgfQ0KDQogICAgcHVibGljIENvbGxlY3Rp\nb24gZ2V0VHJhbnNhY3Rpb25hbE9iamVjdHMoKSB7DQogICAgICAgIHJldHVy\nbiBfYnJva2VyLmdldFRyYW5zYWN0aW9uYWxPYmplY3RzKCk7DQogICAgfQ0K\nDQogICAgcHVibGljIENvbGxlY3Rpb24gZ2V0UGVuZGluZ1RyYW5zYWN0aW9u\nYWxPYmplY3RzKCkgew0KICAgICAgICByZXR1cm4gX2Jyb2tlci5nZXRQZW5k\naW5nVHJhbnNhY3Rpb25hbE9iamVjdHMoKTsNCiAgICB9DQoNCiAgICBwdWJs\naWMgQ29sbGVjdGlvbiBnZXREaXJ0eU9iamVjdHMoKSB7DQogICAgICAgIHJl\ndHVybiBfYnJva2VyLmdldERpcnR5T2JqZWN0cygpOw0KICAgIH0NCg0KICAg\nIHB1YmxpYyBib29sZWFuIGdldE9yZGVyRGlydHlPYmplY3RzKCkgew0KICAg\nICAgICByZXR1cm4gX2Jyb2tlci5nZXRPcmRlckRpcnR5T2JqZWN0cygpOw0K\nICAgIH0NCg0KICAgIHB1YmxpYyB2b2lkIHNldE9yZGVyRGlydHlPYmplY3Rz\nKGJvb2xlYW4gb3JkZXIpIHsNCiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZv\na2VkKCk7DQogICAgICAgIF9icm9rZXIuc2V0T3JkZXJEaXJ0eU9iamVjdHMo\nb3JkZXIpOw0KICAgIH0NCg0KICAgIHB1YmxpYyB2b2lkIGRpcnR5Q2xhc3Mo\nQ2xhc3MgY2xzKSB7DQogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgp\nOw0KICAgICAgICBfYnJva2VyLmRpcnR5VHlwZShjbHMpOw0KICAgIH0NCg0K\nICAgIEBTdXBwcmVzc1dhcm5pbmdzKCJ1bmNoZWNrZWQiKQ0KICAgIHB1Ymxp\nYyBDb2xsZWN0aW9uPENsYXNzPiBnZXRQZXJzaXN0ZWRDbGFzc2VzKCkgew0K\nICAgICAgICByZXR1cm4gKENvbGxlY3Rpb248Q2xhc3M+KSBfYnJva2VyLmdl\ndFBlcnNpc3RlZFR5cGVzKCk7DQogICAgfQ0KDQogICAgQFN1cHByZXNzV2Fy\nbmluZ3MoInVuY2hlY2tlZCIpDQogICAgcHVibGljIENvbGxlY3Rpb248Q2xh\nc3M+IGdldFVwZGF0ZWRDbGFzc2VzKCkgew0KICAgICAgICByZXR1cm4gKENv\nbGxlY3Rpb248Q2xhc3M+KSBfYnJva2VyLmdldFVwZGF0ZWRUeXBlcygpOw0K\nICAgIH0NCg0KICAgIEBTdXBwcmVzc1dhcm5pbmdzKCJ1bmNoZWNrZWQiKQ0K\nICAgIHB1YmxpYyBDb2xsZWN0aW9uPENsYXNzPiBnZXRSZW1vdmVkQ2xhc3Nl\ncygpIHsNCiAgICAgICAgcmV0dXJuIChDb2xsZWN0aW9uPENsYXNzPikgX2Jy\nb2tlci5nZXREZWxldGVkVHlwZXMoKTsNCiAgICB9DQoNCiAgICBwdWJsaWMg\nPFQ+IFQgY3JlYXRlSW5zdGFuY2UoQ2xhc3M8VD4gY2xzKSB7DQogICAgICAg\nIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOw0KICAgICAgICByZXR1cm4gKFQp\nIF9icm9rZXIubmV3SW5zdGFuY2UoY2xzKTsNCiAgICB9DQoNCiAgICBwdWJs\naWMgdm9pZCBjbG9zZSgpIHsNCiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZv\na2VkKCk7DQogICAgICAgIF9icm9rZXIuY2xvc2UoKTsNCiAgICB9DQoNCiAg\nICBwdWJsaWMgYm9vbGVhbiBpc09wZW4oKSB7DQogICAgICAgIHJldHVybiAh\nX2Jyb2tlci5pc0Nsb3NlSW52b2tlZCgpOw0KICAgIH0NCg0KICAgIHB1Ymxp\nYyB2b2lkIGRpcnR5KE9iamVjdCBvLCBTdHJpbmcgZmllbGQpIHsNCiAgICAg\nICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7DQogICAgICAgIE9wZW5KUEFT\ndGF0ZU1hbmFnZXIgc20gPSBfYnJva2VyLmdldFN0YXRlTWFuYWdlcihvKTsN\nCiAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgIGlmIChzbSAhPSBudWxsKQ0K\nICAgICAgICAgICAgICAgIHNtLmRpcnR5KGZpZWxkKTsNCiAgICAgICAgfSBj\nYXRjaCAoRXhjZXB0aW9uIGUpIHsNCiAgICAgICAgICAgIHRocm93IFBlcnNp\nc3RlbmNlRXhjZXB0aW9ucy50b1BlcnNpc3RlbmNlRXhjZXB0aW9uKGUpOw0K\nICAgICAgICB9DQogICAgfQ0KDQogICAgcHVibGljIE9iamVjdCBnZXRPYmpl\nY3RJZChPYmplY3Qgbykgew0KICAgICAgICBhc3NlcnROb3RDbG9zZUludm9r\nZWQoKTsNCiAgICAgICAgcmV0dXJuIEpQQUZhY2FkZUhlbHBlci5mcm9tT3Bl\nbkpQQU9iamVjdElkKF9icm9rZXIuZ2V0T2JqZWN0SWQobykpOw0KICAgIH0N\nCg0KICAgIHB1YmxpYyBib29sZWFuIGlzRGlydHkoT2JqZWN0IG8pIHsNCiAg\nICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7DQogICAgICAgIHJldHVy\nbiBfYnJva2VyLmlzRGlydHkobyk7DQogICAgfQ0KDQogICAgcHVibGljIGJv\nb2xlYW4gaXNUcmFuc2FjdGlvbmFsKE9iamVjdCBvKSB7DQogICAgICAgIGFz\nc2VydE5vdENsb3NlSW52b2tlZCgpOw0KICAgICAgICByZXR1cm4gX2Jyb2tl\nci5pc1RyYW5zYWN0aW9uYWwobyk7DQogICAgfQ0KDQogICAgcHVibGljIGJv\nb2xlYW4gaXNQZXJzaXN0ZW50KE9iamVjdCBvKSB7DQogICAgICAgIGFzc2Vy\ndE5vdENsb3NlSW52b2tlZCgpOw0KICAgICAgICByZXR1cm4gX2Jyb2tlci5p\nc1BlcnNpc3RlbnQobyk7DQogICAgfQ0KDQogICAgcHVibGljIGJvb2xlYW4g\naXNOZXdseVBlcnNpc3RlbnQoT2JqZWN0IG8pIHsNCiAgICAgICAgYXNzZXJ0\nTm90Q2xvc2VJbnZva2VkKCk7DQogICAgICAgIHJldHVybiBfYnJva2VyLmlz\nTmV3KG8pOw0KICAgIH0NCg0KICAgIHB1YmxpYyBib29sZWFuIGlzUmVtb3Zl\nZChPYmplY3Qgbykgew0KICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQo\nKTsNCiAgICAgICAgcmV0dXJuIF9icm9rZXIuaXNEZWxldGVkKG8pOw0KICAg\nIH0NCg0KICAgIHB1YmxpYyBib29sZWFuIGlzRGV0YWNoZWQoT2JqZWN0IGVu\ndGl0eSkgew0KICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsNCiAg\nICAgICAgcmV0dXJuIF9icm9rZXIuaXNEZXRhY2hlZChlbnRpdHkpOw0KICAg\nIH0NCg0KICAgIHB1YmxpYyBPYmplY3QgZ2V0VmVyc2lvbihPYmplY3Qgbykg\new0KICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsNCiAgICAgICAg\ncmV0dXJuIF9icm9rZXIuZ2V0VmVyc2lvbihvKTsNCiAgICB9DQoNCiAgICAv\nKioNCiAgICAgKiBUaHJvdyBhcHByb3ByaWF0ZSBleGNlcHRpb24gaWYgY2xv\nc2UgaGFzIGJlZW4gaW52b2tlZCBidXQgdGhlIGJyb2tlcg0KICAgICAqIGlz\nIHN0aWxsIG9wZW4uICBXZSB0ZXN0IG9ubHkgZm9yIHRoaXMgYmVjYXVzZSBp\nZiB0aGUgYnJva2VyIGlzIGFscmVhZHkNCiAgICAgKiBjbG9zZWQsIGl0IHdp\nbGwgdGhyb3cgaXRzIG93biBtb3JlIGluZm9ybWF0aXZlIGV4Y2VwdGlvbiB3\naGVuIHdlIA0KICAgICAqIGRlbGVnYXRlIHRoZSBwZW5kaW5nIG9wZXJhdGlv\nbiB0byBpdC4NCiAgICAgKi8NCiAgICB2b2lkIGFzc2VydE5vdENsb3NlSW52\nb2tlZCgpIHsNCiAgICAgICAgaWYgKCFfYnJva2VyLmlzQ2xvc2VkKCkgJiYg\nX2Jyb2tlci5pc0Nsb3NlSW52b2tlZCgpKQ0KICAgICAgICAgICAgdGhyb3cg\nbmV3IEludmFsaWRTdGF0ZUV4Y2VwdGlvbihfbG9jLmdldCgiY2xvc2UtaW52\nb2tlZCIpLCBudWxsLA0KICAgICAgICAgICAgICAgIG51bGwsIHRydWUpOw0K\nICAgIH0NCg0KICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v\nDQogICAgLy8gRmluZENhbGxiYWNrcyBpbXBsZW1lbnRhdGlvbg0KICAgIC8v\nLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vDQoNCiAgICBwdWJsaWMg\nT2JqZWN0IHByb2Nlc3NBcmd1bWVudChPYmplY3QgYXJnKSB7DQogICAgICAg\nIHJldHVybiBhcmc7DQogICAgfQ0KDQogICAgcHVibGljIE9iamVjdCBwcm9j\nZXNzUmV0dXJuKE9iamVjdCBvaWQsIE9wZW5KUEFTdGF0ZU1hbmFnZXIgc20p\nIHsNCiAgICAgICAgcmV0dXJuIChzbSA9PSBudWxsIHx8IHNtLmlzRGVsZXRl\nZCgpKSA/IG51bGwgOiBzbS5nZXRNYW5hZ2VkSW5zdGFuY2UoKTsNCiAgICB9\nDQoNCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8NCiAgICAv\nLyBPcENhbGxiYWNrcyBpbXBsZW1lbnRhdGlvbg0KICAgIC8vLy8vLy8vLy8v\nLy8vLy8vLy8vLy8vLy8vLy8vLw0KDQogICAgcHVibGljIGludCBwcm9jZXNz\nQXJndW1lbnQoaW50IG9wLCBPYmplY3Qgb2JqLCBPcGVuSlBBU3RhdGVNYW5h\nZ2VyIHNtKSB7DQogICAgICAgIHN3aXRjaCAob3ApIHsNCiAgICAgICAgICAg\nIGNhc2UgT1BfREVMRVRFOg0KICAgICAgICAgICAgICAgIC8vIGNhc2NhZGUg\ndGhyb3VnaCBub24tcGVyc2lzdGVudCBub24tZGV0YWNoZWQgaW5zdGFuY2Vz\nDQogICAgICAgICAgICAgICAgaWYgKHNtID09IG51bGwgJiYgIV9icm9rZXIu\naXNEZXRhY2hlZChvYmopKQ0KICAgICAgICAgICAgICAgICAgICByZXR1cm4g\nQUNUX0NBU0NBREU7DQogICAgICAgICAgICAgICAgaWYgKHNtICE9IG51bGwg\nJiYgIXNtLmlzRGV0YWNoZWQoKSAmJiAhc20uaXNQZXJzaXN0ZW50KCkpDQog\nICAgICAgICAgICAgICAgICAgIHJldHVybiBBQ1RfQ0FTQ0FERTsNCiAgICAg\nICAgICAgICAgICAvLyBpZ25vcmUgZGVsZXRlZCBpbnN0YW5jZXMNCiAgICAg\nICAgICAgICAgICBpZiAoc20gIT0gbnVsbCAmJiBzbS5pc0RlbGV0ZWQoKSkN\nCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIEFDVF9OT05FOw0KICAgICAg\nICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgY2FzZSBPUF9BVFRBQ0g6\nDQogICAgICAgICAgICAgICAgLy8gZGllIG9uIHJlbW92ZWQNCiAgICAgICAg\nICAgICAgICBpZiAoc20gIT0gbnVsbCAmJiBzbS5pc0RlbGV0ZWQoKSkNCiAg\nICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IFVzZXJFeGNlcHRpb24oX2xv\nYy5nZXQoInJlbW92ZWQiLA0KICAgICAgICAgICAgICAgICAgICAgICAgRXhj\nZXB0aW9ucy50b1N0cmluZyhvYmopKSkuc2V0RmFpbGVkT2JqZWN0KG9iaik7\nDQogICAgICAgICAgICAgICAgLy8gY2FzY2FkZSB0aHJvdWdoIG1hbmFnZWQg\naW5zdGFuY2VzDQogICAgICAgICAgICAgICAgaWYgKHNtICE9IG51bGwgJiYg\nIXNtLmlzRGV0YWNoZWQoKSkNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJu\nIEFDVF9DQVNDQURFOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAg\nICAgICAgY2FzZSBPUF9SRUZSRVNIOg0KICAgICAgICAgICAgICAgIC8vIGRp\nZSBvbiB1bm1hbmFnZWQgaW5zdGFuY2VzDQogICAgICAgICAgICAgICAgaWYg\nKHNtID09IG51bGwpDQogICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBV\nc2VyRXhjZXB0aW9uKF9sb2MuZ2V0KCJub3QtbWFuYWdlZCIsDQogICAgICAg\nICAgICAgICAgICAgICAgICBFeGNlcHRpb25zLnRvU3RyaW5nKG9iaikpKS5z\nZXRGYWlsZWRPYmplY3Qob2JqKTsNCiAgICAgICAgICAgICAgICBicmVhazsN\nCiAgICAgICAgfQ0KICAgICAgICByZXR1cm4gQUNUX1JVTiB8IEFDVF9DQVND\nQURFOw0KICAgIH0NCg0KICAgIHB1YmxpYyBpbnQgaGFzaENvZGUoKSB7DQog\nICAgICAgIHJldHVybiBfYnJva2VyLmhhc2hDb2RlKCk7DQogICAgfQ0KDQog\nICAgcHVibGljIGJvb2xlYW4gZXF1YWxzKE9iamVjdCBvdGhlcikgew0KICAg\nICAgICBpZiAob3RoZXIgPT0gdGhpcykNCiAgICAgICAgICAgIHJldHVybiB0\ncnVlOw0KICAgICAgICBpZiAoIShvdGhlciBpbnN0YW5jZW9mIEVudGl0eU1h\nbmFnZXJJbXBsKSkNCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAg\nICAgcmV0dXJuIF9icm9rZXIuZXF1YWxzKCgoRW50aXR5TWFuYWdlckltcGwp\nIG90aGVyKS5fYnJva2VyKTsNCiAgICB9DQp9DQo=\n","encoding":"base64"}

