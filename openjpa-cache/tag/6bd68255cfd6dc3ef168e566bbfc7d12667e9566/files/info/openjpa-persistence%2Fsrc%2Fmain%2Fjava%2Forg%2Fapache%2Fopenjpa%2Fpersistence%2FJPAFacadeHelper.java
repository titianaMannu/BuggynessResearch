{"sha":"2ccb875ffe7559671d1780d9bf5692067c16b69a","node_id":"MDQ6QmxvYjIwNjM2NDoyY2NiODc1ZmZlNzU1OTY3MWQxNzgwZDliZjU2OTIwNjdjMTZiNjlh","size":11086,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/2ccb875ffe7559671d1780d9bf5692067c16b69a","content":"LyoNCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUNCiAqIG9yIG1vcmUgY29udHJpYnV0b3Ig\nbGljZW5zZSBhZ3JlZW1lbnRzLiAgU2VlIHRoZSBOT1RJQ0UgZmlsZQ0KICog\nZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5m\nb3JtYXRpb24NCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAg\nVGhlIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUNCiAqIHRvIHlvdSB1bmRlciB0\naGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUNCiAqICJMaWNl\nbnNlIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNv\nbXBsaWFuY2UNCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFp\nbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQNCiAqDQogKiBodHRwOi8vd3d3\nLmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjANCiAqDQogKiBVbmxl\nc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGlu\nIHdyaXRpbmcsDQogKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUg\nTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbg0KICogIkFTIElTIiBCQVNJ\nUywgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZDQog\nKiBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBM\naWNlbnNlIGZvciB0aGUNCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmlu\nZyBwZXJtaXNzaW9ucyBhbmQgbGltaXRhdGlvbnMNCiAqIHVuZGVyIHRoZSBM\naWNlbnNlLg0KICovDQpwYWNrYWdlIG9yZy5hcGFjaGUub3BlbmpwYS5wZXJz\naXN0ZW5jZTsNCg0KaW1wb3J0IGphdmEudXRpbC5BcnJheUxpc3Q7DQppbXBv\ncnQgamF2YS51dGlsLkNvbGxlY3Rpb247DQppbXBvcnQgamF2YS51dGlsLkl0\nZXJhdG9yOw0KaW1wb3J0IGphdmF4LnBlcnNpc3RlbmNlLkVudGl0eU1hbmFn\nZXI7DQppbXBvcnQgamF2YXgucGVyc2lzdGVuY2UuRW50aXR5TWFuYWdlckZh\nY3Rvcnk7DQoNCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLkJy\nb2tlcjsNCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLkJyb2tl\nckZhY3Rvcnk7DQppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuQ2xh\nc3NNZXRhRGF0YTsNCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5C\neXRlSWQ7DQppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuQ2hhcklk\nOw0KaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLkRvdWJsZUlkOw0K\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLkZsb2F0SWQ7DQppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuSWQ7DQppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLnV0aWwuSW1wbEhlbHBlcjsNCmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEudXRpbC5JbnRJZDsNCmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEudXRpbC5Mb25nSWQ7DQppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLnV0aWwuT2JqZWN0SWQ7DQppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0\naWwuT3BlbkpQQUlkOw0KaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGls\nLlNob3J0SWQ7DQppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuU3Ry\naW5nSWQ7DQppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51dGlsLkxv\nY2FsaXplcjsNCg0KLyoqDQogKiBIZWxwZXIgY2xhc3MgZm9yIHN3aXRjaGlu\nZyBiZXR3ZWVuIE9wZW5KUEEncyBKUEEgZmFjYWRlIGFuZCB0aGUgdW5kZXJs\neWluZw0KICogQnJva2VyIGtlcm5lbC4NCiAqDQogKiBAc2luY2UgMS4wLjAN\nCiAqIEBub2phdmFkb2MNCiAqLw0KcHVibGljIGNsYXNzIEpQQUZhY2FkZUhl\nbHBlciB7DQoNCiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIFN0cmluZyBFTV9L\nRVkgPQ0KICAgICAgICAib3JnLmFwYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNl\nLkVudGl0eU1hbmFnZXIiOw0KICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgU3Ry\naW5nIEVNRl9LRVkgPQ0KICAgICAgICAib3JnLmFwYWNoZS5vcGVuanBhLnBl\ncnNpc3RlbmNlLkVudGl0eU1hbmFnZXJGYWN0b3J5IjsNCg0KICAgIHByaXZh\ndGUgc3RhdGljIGZpbmFsIExvY2FsaXplciBfbG9jID0NCiAgICAgICAgTG9j\nYWxpemVyLmZvclBhY2thZ2UoSlBBRmFjYWRlSGVscGVyLmNsYXNzKTsNCg0K\nICAgIHB1YmxpYyBzdGF0aWMgT3BlbkpQQUVudGl0eU1hbmFnZXJGYWN0b3J5\nIHRvRW50aXR5TWFuYWdlckZhY3RvcnkoDQogICAgICAgIEJyb2tlckZhY3Rv\ncnkgZmFjdG9yeSkgew0KICAgICAgICBpZiAoZmFjdG9yeSA9PSBudWxsKQ0K\nICAgICAgICAgICAgcmV0dXJuIG51bGw7DQoNCiAgICAgICAgZmFjdG9yeS5s\nb2NrKCk7DQogICAgICAgIHRyeSB7DQogICAgICAgICAgICBPcGVuSlBBRW50\naXR5TWFuYWdlckZhY3RvcnkgZW1mID0gKE9wZW5KUEFFbnRpdHlNYW5hZ2Vy\nRmFjdG9yeSkNCiAgICAgICAgICAgICAgICBmYWN0b3J5LmdldFVzZXJPYmpl\nY3QoRU1GX0tFWSk7DQogICAgICAgICAgICBpZiAoZW1mID09IG51bGwpIHsN\nCiAgICAgICAgICAgICAgICBlbWYgPSBFbnRpdHlNYW5hZ2VyRmFjdG9yeVZh\nbHVlLm5ld0ZhY3RvcnkoZmFjdG9yeSk7DQogICAgICAgICAgICAgICAgZmFj\ndG9yeS5wdXRVc2VyT2JqZWN0KEVNRl9LRVksIGVtZik7DQogICAgICAgICAg\nICB9DQogICAgICAgICAgICByZXR1cm4gZW1mOw0KICAgICAgICB9IGNhdGNo\nIChFeGNlcHRpb24gZSkgew0KICAgICAgICAgICAgdGhyb3cgUGVyc2lzdGVu\nY2VFeGNlcHRpb25zLnRvUGVyc2lzdGVuY2VFeGNlcHRpb24oZSk7DQogICAg\nICAgIH0gZmluYWxseSB7DQogICAgICAgICAgICBmYWN0b3J5LnVubG9jaygp\nOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgLyoqDQogICAgICogUmV0dXJu\nIHRoZSB1bmRlcmx5aW5nIGJyb2tlciBmYWN0b3J5IGZvciB0aGUgZ2l2ZW4g\ncGVyc2lzdGVuY2UgbWFuYWdlcg0KICAgICAqIGZhY3RvcnkgZmFjYWRlLg0K\nICAgICAqLw0KICAgIHB1YmxpYyBzdGF0aWMgQnJva2VyRmFjdG9yeSB0b0Jy\nb2tlckZhY3RvcnkoRW50aXR5TWFuYWdlckZhY3RvcnkgZW1mKSB7DQogICAg\nICAgIGlmIChlbWYgPT0gbnVsbCkNCiAgICAgICAgICAgIHJldHVybiBudWxs\nOw0KICAgICAgICBpZiAoIShlbWYgaW5zdGFuY2VvZiBFbnRpdHlNYW5hZ2Vy\nRmFjdG9yeUltcGwpKSB7DQogICAgICAgICAgICBDbGFzcyBjID0gZW1mLmdl\ndENsYXNzKCk7DQogICAgICAgICAgICB0cnkgew0KICAgICAgICAgICAgICAg\nIC8vIGVpdGhlciBjYXN0IGhlcmUgbWF5IGZhaWwNCiAgICAgICAgICAgICAg\nICBlbWYgPSAoRW50aXR5TWFuYWdlckZhY3RvcnlJbXBsKSAoKE9wZW5KUEFF\nbnRpdHlNYW5hZ2VyRmFjdG9yeSkNCiAgICAgICAgICAgICAgICAgICAgZW1m\nKS5nZXRVc2VyT2JqZWN0KEVNRl9LRVkpOw0KICAgICAgICAgICAgfSBjYXRj\naCAoQ2xhc3NDYXN0RXhjZXB0aW9uIGNjZSkgew0KICAgICAgICAgICAgICAg\nIHRocm93IG5ldyBBcmd1bWVudEV4Y2VwdGlvbihfbG9jLmdldCgNCiAgICAg\nICAgICAgICAgICAgICAgImNhbnQtY29udmVydC1icm9rZXJmYWN0b3J5Iiwg\nYyksIG51bGwsIG51bGwsIGZhbHNlKTsNCiAgICAgICAgICAgIH0NCiAgICAg\nICAgfQ0KICAgICAgICByZXR1cm4gKChFbnRpdHlNYW5hZ2VyRmFjdG9yeUlt\ncGwpIGVtZikuZ2V0QnJva2VyRmFjdG9yeSgpOw0KICAgIH0NCg0KICAgIC8q\nKg0KICAgICAqIFJldHVybiBhIHBlcnNpc3RlbmNlIG1hbmFnZXIgZmFjYWRl\nIHRvIHRoZSBnaXZlbiBicm9rZXIgcmV0YWluaW5nDQogICAgICogcHJldmlv\ndXNseSBhc3NvY2lhdGVkIHBlcnNpc3RlbmNlIGNvbnRleHQgdHlwZS4NCiAg\nICAgKi8NCiAgICBwdWJsaWMgc3RhdGljIE9wZW5KUEFFbnRpdHlNYW5hZ2Vy\nIHRvRW50aXR5TWFuYWdlcihCcm9rZXIgYnJva2VyKSB7DQogICAgICAgIGlm\nIChicm9rZXIgPT0gbnVsbCkNCiAgICAgICAgICAgIHJldHVybiBudWxsOw0K\nDQogICAgICAgIGJyb2tlci5sb2NrKCk7DQogICAgICAgIHRyeSB7DQogICAg\nICAgICAgICBPcGVuSlBBRW50aXR5TWFuYWdlciBlbSA9IChPcGVuSlBBRW50\naXR5TWFuYWdlcikNCiAgICAgICAgICAgICAgICBicm9rZXIuZ2V0VXNlck9i\namVjdChFTV9LRVkpOw0KICAgICAgICAgICAgaWYgKGVtID09IG51bGwpIHsN\nCiAgICAgICAgICAgICAgICBFbnRpdHlNYW5hZ2VyRmFjdG9yeUltcGwgZW1m\nID0gKEVudGl0eU1hbmFnZXJGYWN0b3J5SW1wbCkNCiAgICAgICAgICAgICAg\nICAgICAgdG9FbnRpdHlNYW5hZ2VyRmFjdG9yeShicm9rZXIuZ2V0QnJva2Vy\nRmFjdG9yeSgpKTsNCiAgICAgICAgICAgICAgICBlbSA9IGVtZi5uZXdFbnRp\ndHlNYW5hZ2VySW1wbChicm9rZXIpOw0KICAgICAgICAgICAgICAgIGJyb2tl\nci5wdXRVc2VyT2JqZWN0KEVNX0tFWSwgZW0pOw0KICAgICAgICAgICAgfQ0K\nICAgICAgICAgICAgcmV0dXJuIGVtOw0KICAgICAgICB9IGNhdGNoIChFeGNl\ncHRpb24gZSkgew0KICAgICAgICAgICAgdGhyb3cgUGVyc2lzdGVuY2VFeGNl\ncHRpb25zLnRvUGVyc2lzdGVuY2VFeGNlcHRpb24oZSk7DQogICAgICAgIH0g\nZmluYWxseSB7DQogICAgICAgICAgICBicm9rZXIudW5sb2NrKCk7DQogICAg\nICAgIH0NCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiBSZXR1cm4gdGhlIHVu\nZGVybHlpbmcgYnJva2VyIGZvciB0aGUgZ2l2ZW4gZW50aXR5IG1hbmFnZXIg\nZmFjYWRlLg0KICAgICAqLw0KICAgIHB1YmxpYyBzdGF0aWMgQnJva2VyIHRv\nQnJva2VyKEVudGl0eU1hbmFnZXIgZW0pIHsNCiAgICAgICAgaWYgKGVtID09\nIG51bGwpDQogICAgICAgICAgICByZXR1cm4gbnVsbDsNCiAgICAgICAgaWYg\nKCEoZW0gaW5zdGFuY2VvZiBFbnRpdHlNYW5hZ2VySW1wbCkpIHsNCiAgICAg\nICAgICAgIENsYXNzIGMgPSBlbS5nZXRDbGFzcygpOw0KICAgICAgICAgICAg\ndHJ5IHsNCiAgICAgICAgICAgICAgICAvLyBlaXRoZXIgY2FzdCBoZXJlIG1h\neSBmYWlsDQogICAgICAgICAgICAgICAgZW0gPSAoRW50aXR5TWFuYWdlcklt\ncGwpICgoT3BlbkpQQUVudGl0eU1hbmFnZXIpIGVtKS4NCiAgICAgICAgICAg\nICAgICAgICAgZ2V0VXNlck9iamVjdChFTV9LRVkpOw0KICAgICAgICAgICAg\nfSBjYXRjaCAoQ2xhc3NDYXN0RXhjZXB0aW9uIGNjZSkgew0KICAgICAgICAg\nICAgICAgIHRocm93IG5ldyBBcmd1bWVudEV4Y2VwdGlvbihfbG9jLmdldCgi\nY2FudC1jb252ZXJ0LWJyb2tlciIsIGMpLA0KICAgICAgICAgICAgICAgICAg\nICBudWxsLCBudWxsLCBmYWxzZSk7DQogICAgICAgICAgICB9DQogICAgICAg\nIH0NCiAgICAgICAgcmV0dXJuICgoRW50aXR5TWFuYWdlckltcGwpIGVtKS5n\nZXRCcm9rZXIoKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiBSZXR1cm5z\nIHRoZSB7QGxpbmsgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuQ2xhc3NNZXRh\nRGF0YX0gYXNzb2NpYXRlZCB3aXRoIHRoZQ0KICAgICAqIHBlcnNpc3RlbnQg\nb2JqZWN0IDxjb2RlPm88L2NvZGU+Lg0KICAgICAqLw0KICAgIHB1YmxpYyBz\ndGF0aWMgQ2xhc3NNZXRhRGF0YSBnZXRNZXRhRGF0YShPYmplY3Qgbykgew0K\nICAgICAgICBpZiAobyA9PSBudWxsKQ0KICAgICAgICAgICAgcmV0dXJuIG51\nbGw7DQogICAgICAgIEVudGl0eU1hbmFnZXIgZW0gPSBPcGVuSlBBUGVyc2lz\ndGVuY2UuZ2V0RW50aXR5TWFuYWdlcihvKTsNCiAgICAgICAgcmV0dXJuIChl\nbSA9PSBudWxsKSA/IG51bGwgOiBnZXRNZXRhRGF0YShlbSwNCiAgICAgICAg\nICAgIEltcGxIZWxwZXIuZ2V0TWFuYWdlZEluc3RhbmNlKG8pLmdldENsYXNz\nKCkpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIFJldHVybnMgdGhlIHtA\nbGluayBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YS5DbGFzc01ldGFEYXRhfSBh\nc3NvY2lhdGVkDQogICAgICogd2l0aCB0aGUgcGVyc2lzdGVudCB0eXBlIDxj\nb2RlPmNsczwvY29kZT4uDQogICAgICovDQogICAgcHVibGljIHN0YXRpYyBD\nbGFzc01ldGFEYXRhIGdldE1ldGFEYXRhKEVudGl0eU1hbmFnZXIgZW0sIENs\nYXNzIGNscykgew0KICAgICAgICBpZiAoZW0gPT0gbnVsbCkNCiAgICAgICAg\nICAgIHRocm93IG5ldyBOdWxsUG9pbnRlckV4Y2VwdGlvbigiZW0gPT0gbnVs\nbCIpOw0KDQogICAgICAgIE9wZW5KUEFFbnRpdHlNYW5hZ2VyU1BJIGtlbSA9\nIChPcGVuSlBBRW50aXR5TWFuYWdlclNQSSkNCiAgICAgICAgICAgIE9wZW5K\nUEFQZXJzaXN0ZW5jZS5jYXN0KGVtKTsNCiAgICAgICAgdHJ5IHsNCiAgICAg\nICAgICAgIHJldHVybiBrZW0uZ2V0Q29uZmlndXJhdGlvbigpLmdldE1ldGFE\nYXRhUmVwb3NpdG9yeUluc3RhbmNlKCkuDQogICAgICAgICAgICAgICAgZ2V0\nTWV0YURhdGEoY2xzLCBrZW0uZ2V0Q2xhc3NMb2FkZXIoKSwgZmFsc2UpOw0K\nICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkgew0KICAgICAgICAgICAg\ndGhyb3cgUGVyc2lzdGVuY2VFeGNlcHRpb25zLnRvUGVyc2lzdGVuY2VFeGNl\ncHRpb24oZSk7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICAvKioNCiAgICAg\nKiBSZXR1cm5zIHRoZSB7QGxpbmsgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEu\nQ2xhc3NNZXRhRGF0YX0gYXNzb2NpYXRlZA0KICAgICAqIHdpdGggdGhlIHBl\ncnNpc3RlbnQgdHlwZSA8Y29kZT5jbHM8L2NvZGU+Lg0KICAgICAqLw0KICAg\nIHB1YmxpYyBzdGF0aWMgQ2xhc3NNZXRhRGF0YSBnZXRNZXRhRGF0YShFbnRp\ndHlNYW5hZ2VyRmFjdG9yeSBlbWYsDQogICAgICAgIENsYXNzIGNscykgew0K\nICAgICAgICBpZiAoZW1mID09IG51bGwpDQogICAgICAgICAgICB0aHJvdyBu\nZXcgTnVsbFBvaW50ZXJFeGNlcHRpb24oImVtZiA9PSBudWxsIik7DQoNCiAg\nICAgICAgT3BlbkpQQUVudGl0eU1hbmFnZXJGYWN0b3J5U1BJIGVtZlNQSSA9\nDQogICAgICAgICAgICAoT3BlbkpQQUVudGl0eU1hbmFnZXJGYWN0b3J5U1BJ\nKSBPcGVuSlBBUGVyc2lzdGVuY2UuY2FzdChlbWYpOw0KICAgICAgICB0cnkg\new0KICAgICAgICAgICAgcmV0dXJuIGVtZlNQSS5nZXRDb25maWd1cmF0aW9u\nKCkuZ2V0TWV0YURhdGFSZXBvc2l0b3J5SW5zdGFuY2UoKS4NCiAgICAgICAg\nICAgICAgICBnZXRNZXRhRGF0YShjbHMsIG51bGwsIGZhbHNlKTsNCiAgICAg\nICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsNCiAgICAgICAgICAgIHRocm93\nIFBlcnNpc3RlbmNlRXhjZXB0aW9ucy50b1BlcnNpc3RlbmNlRXhjZXB0aW9u\nKGUpOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgLyoqDQogICAgICogVHJh\nbnNsYXRlIGZyb20gYSBPcGVuSlBBIGlkZW50aXR5IG9iamVjdCB0byBhIFBl\ncnNpc3RlbmNlIG9uZS4NCiAgICAgKi8NCiAgICBwdWJsaWMgc3RhdGljIE9i\namVjdCBmcm9tT3BlbkpQQU9iamVjdElkKE9iamVjdCBvaWQpIHsNCiAgICAg\nICAgaWYgKG9pZCBpbnN0YW5jZW9mIE9wZW5KUEFJZCkNCiAgICAgICAgICAg\nIHJldHVybiAoKE9wZW5KUEFJZCkgb2lkKS5nZXRJZE9iamVjdCgpOw0KICAg\nICAgICByZXR1cm4gb2lkOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIFRy\nYW5zbGF0ZSBmcm9tIGEgUGVyc2lzdGVuY2UgaWRlbnRpdHkgb2JqZWN0IHRv\nIGEgT3BlbkpQQSBvbmUuDQogICAgICovDQogICAgcHVibGljIHN0YXRpYyBP\nYmplY3QgdG9PcGVuSlBBT2JqZWN0SWQoQ2xhc3NNZXRhRGF0YSBtZXRhLCBP\nYmplY3Qgb2lkKSB7DQogICAgICAgIGlmIChvaWQgPT0gbnVsbCB8fCBtZXRh\nID09IG51bGwpDQogICAgICAgICAgICByZXR1cm4gbnVsbDsNCg0KICAgICAg\nICBDbGFzcyBjbHMgPSBtZXRhLmdldERlc2NyaWJlZFR5cGUoKTsNCiAgICAg\nICAgaWYgKG1ldGEuZ2V0SWRlbnRpdHlUeXBlKCkgPT0gQ2xhc3NNZXRhRGF0\nYS5JRF9EQVRBU1RPUkUpDQogICAgICAgICAgICByZXR1cm4gbmV3IElkKGNs\ncywgKChOdW1iZXIpIG9pZCkubG9uZ1ZhbHVlKCkpOw0KDQogICAgICAgIGlm\nIChvaWQgaW5zdGFuY2VvZiBCeXRlKQ0KICAgICAgICAgICAgcmV0dXJuIG5l\ndyBCeXRlSWQoY2xzLCAoQnl0ZSkgb2lkKTsNCiAgICAgICAgaWYgKG9pZCBp\nbnN0YW5jZW9mIENoYXJhY3RlcikNCiAgICAgICAgICAgIHJldHVybiBuZXcg\nQ2hhcklkKGNscywgKENoYXJhY3Rlcikgb2lkKTsNCiAgICAgICAgaWYgKG9p\nZCBpbnN0YW5jZW9mIERvdWJsZSkNCiAgICAgICAgICAgIHJldHVybiBuZXcg\nRG91YmxlSWQoY2xzLCAoRG91YmxlKSBvaWQpOw0KICAgICAgICBpZiAob2lk\nIGluc3RhbmNlb2YgRmxvYXQpDQogICAgICAgICAgICByZXR1cm4gbmV3IEZs\nb2F0SWQoY2xzLCAoRmxvYXQpIG9pZCk7DQogICAgICAgIGlmIChvaWQgaW5z\ndGFuY2VvZiBJbnRlZ2VyKQ0KICAgICAgICAgICAgcmV0dXJuIG5ldyBJbnRJ\nZChjbHMsIChJbnRlZ2VyKSBvaWQpOw0KICAgICAgICBpZiAob2lkIGluc3Rh\nbmNlb2YgTG9uZykNCiAgICAgICAgICAgIHJldHVybiBuZXcgTG9uZ0lkKGNs\ncywgKExvbmcpIG9pZCk7DQogICAgICAgIGlmIChvaWQgaW5zdGFuY2VvZiBT\naG9ydCkNCiAgICAgICAgICAgIHJldHVybiBuZXcgU2hvcnRJZChjbHMsIChT\naG9ydCkgb2lkKTsNCiAgICAgICAgaWYgKG9pZCBpbnN0YW5jZW9mIFN0cmlu\nZykNCiAgICAgICAgICAgIHJldHVybiBuZXcgU3RyaW5nSWQoY2xzLCAoU3Ry\naW5nKSBvaWQpOw0KICAgICAgICByZXR1cm4gbmV3IE9iamVjdElkKGNscywg\nb2lkKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiBSZXR1cm4gYW4gYXJy\nYXkgb2YgT3BlbkpQQSBvaWRzIGZvciB0aGUgZ2l2ZW4gbmF0aXZlIG9pZCBh\ncnJheS4NCiAgICAgKi8NCiAgICBwdWJsaWMgc3RhdGljIE9iamVjdFtdIHRv\nT3BlbkpQQU9iamVjdElkcyhDbGFzc01ldGFEYXRhIG1ldGEsDQogICAgICAg\nIE9iamVjdC4uLiBvaWRzKSB7DQogICAgICAgIGlmIChvaWRzID09IG51bGwg\nfHwgb2lkcy5sZW5ndGggPT0gMCkNCiAgICAgICAgICAgIHJldHVybiBvaWRz\nOw0KDQogICAgICAgIC8vIHNpbmNlIHRoZSBjbGFzcyBpZiBmaXhlZCBmb3Ig\nYWxsIG9pZHMsIHdlIGNhbiB0ZWxsIGlmIHdlIGhhdmUgdG8NCiAgICAgICAg\nLy8gdHJhbnNsYXRlIHRoZSBhcnJheSBiYXNlZCBvbiB3aGV0aGVyIHRoZSBm\naXJzdCBvaWQgbmVlZHMgdHJhbnNsYXRpbmcNCiAgICAgICAgT2JqZWN0IG9p\nZCA9IHRvT3BlbkpQQU9iamVjdElkKG1ldGEsIG9pZHNbMF0pOw0KICAgICAg\nICBpZiAob2lkID09IG9pZHNbMF0pDQogICAgICAgICAgICByZXR1cm4gb2lk\nczsNCg0KICAgICAgICBPYmplY3RbXSBjb3B5ID0gbmV3IE9iamVjdFtvaWRz\nLmxlbmd0aF07DQogICAgICAgIGNvcHlbMF0gPSBvaWQ7DQogICAgICAgIGZv\nciAoaW50IGkgPSAxOyBpIDwgb2lkcy5sZW5ndGg7IGkrKykNCiAgICAgICAg\nICAgIGNvcHlbaV0gPSB0b09wZW5KUEFPYmplY3RJZChtZXRhLCBvaWRzW2ld\nKTsNCiAgICAgICAgcmV0dXJuIGNvcHk7DQogICAgfQ0KDQogICAgLyoqDQog\nICAgICogUmV0dXJuIGEgY29sbGVjdGlvbiBvZiBPcGVuSlBBIG9pZHMgZm9y\nIHRoZSBnaXZlbiBuYXRpdmUgb2lkIGNvbGxlY3Rpb24uDQogICAgICovDQog\nICAgcHVibGljIHN0YXRpYyBDb2xsZWN0aW9uIHRvT3BlbkpQQU9iamVjdElk\ncyhDbGFzc01ldGFEYXRhIG1ldGEsDQogICAgICAgIENvbGxlY3Rpb24gb2lk\ncykgew0KICAgICAgICBpZiAob2lkcyA9PSBudWxsIHx8IG9pZHMuaXNFbXB0\neSgpKQ0KICAgICAgICAgICAgcmV0dXJuIG9pZHM7DQoNCiAgICAgICAgLy8g\nc2luY2UgdGhlIGNsYXNzIGlmIGZpeGVkIGZvciBhbGwgb2lkcywgd2UgY2Fu\nIHRlbGwgaWYgd2UgaGF2ZSB0bw0KICAgICAgICAvLyB0cmFuc2xhdGUgdGhl\nIGFycmF5IGJhc2VkIG9uIHdoZXRoZXIgdGhlIGZpcnN0IG9pZCBuZWVkcyB0\ncmFuc2xhdGluZw0KICAgICAgICBJdGVyYXRvciBpdHIgPSBvaWRzLml0ZXJh\ndG9yKCk7DQogICAgICAgIE9iamVjdCBvcmlnID0gaXRyLm5leHQoKTsNCiAg\nICAgICAgT2JqZWN0IG9pZCA9IHRvT3BlbkpQQU9iamVjdElkKG1ldGEsIG9y\naWcpOw0KICAgICAgICBpZiAob2lkID09IG9yaWcpDQogICAgICAgICAgICBy\nZXR1cm4gb2lkczsNCg0KICAgICAgICBDb2xsZWN0aW9uIGNvcHkgPSBuZXcg\nQXJyYXlMaXN0KG9pZHMuc2l6ZSgpKTsNCiAgICAgICAgY29weS5hZGQob2lk\nKTsNCiAgICAgICAgd2hpbGUgKGl0ci5oYXNOZXh0KCkpDQogICAgICAgICAg\nICBjb3B5LmFkZCh0b09wZW5KUEFPYmplY3RJZChtZXRhLCBpdHIubmV4dCgp\nKSk7DQogICAgICAgIHJldHVybiBjb3B5Ow0KICAgIH0NCg0KICAgIC8qKg0K\nICAgICAqIFRyYW5zbGF0ZSBmcm9tIGEgT3BlbkpQQSBpZGVudGl0eSBjbGFz\ncyB0byBhIG5hdGl2ZSBvbmUuDQogICAgICovDQogICAgcHVibGljIHN0YXRp\nYyBDbGFzcyBmcm9tT3BlbkpQQU9iamVjdElkQ2xhc3MoQ2xhc3Mgb2lkQ2xh\nc3MpIHsNCiAgICAgICAgaWYgKG9pZENsYXNzID09IG51bGwpDQogICAgICAg\nICAgICByZXR1cm4gbnVsbDsNCiAgICAgICAgaWYgKG9pZENsYXNzID09IElk\nLmNsYXNzKQ0KICAgICAgICAgICAgcmV0dXJuIExvbmcuY2xhc3M7DQogICAg\nICAgIGlmIChvaWRDbGFzcyA9PSBCeXRlSWQuY2xhc3MpDQogICAgICAgICAg\nICByZXR1cm4gQnl0ZS5jbGFzczsNCiAgICAgICAgaWYgKG9pZENsYXNzID09\nIENoYXJJZC5jbGFzcykNCiAgICAgICAgICAgIHJldHVybiBDaGFyYWN0ZXIu\nY2xhc3M7DQogICAgICAgIGlmIChvaWRDbGFzcyA9PSBEb3VibGVJZC5jbGFz\ncykNCiAgICAgICAgICAgIHJldHVybiBEb3VibGUuY2xhc3M7DQogICAgICAg\nIGlmIChvaWRDbGFzcyA9PSBGbG9hdElkLmNsYXNzKQ0KICAgICAgICAgICAg\ncmV0dXJuIEZsb2F0LmNsYXNzOw0KICAgICAgICBpZiAob2lkQ2xhc3MgPT0g\nSW50SWQuY2xhc3MpDQogICAgICAgICAgICByZXR1cm4gSW50ZWdlci5jbGFz\nczsNCiAgICAgICAgaWYgKG9pZENsYXNzID09IExvbmdJZC5jbGFzcykNCiAg\nICAgICAgICAgIHJldHVybiBMb25nLmNsYXNzOw0KICAgICAgICBpZiAob2lk\nQ2xhc3MgPT0gU2hvcnRJZC5jbGFzcykNCiAgICAgICAgICAgIHJldHVybiBT\naG9ydC5jbGFzczsNCiAgICAgICAgaWYgKG9pZENsYXNzID09IFN0cmluZ0lk\nLmNsYXNzKQ0KCQkJcmV0dXJuIFN0cmluZy5jbGFzczsNCgkJcmV0dXJuIG9p\nZENsYXNzOw0KCX0NCn0NCg==\n","encoding":"base64"}

