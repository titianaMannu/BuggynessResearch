{"sha":"30ab53773c9285552ff676ec242ab1a3984fe4d3","node_id":"MDQ6QmxvYjIwNjM2NDozMGFiNTM3NzNjOTI4NTU1MmZmNjc2ZWMyNDJhYjFhMzk4NGZlNGQz","size":55505,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/30ab53773c9285552ff676ec242ab1a3984fe4d3","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2U7CgppbXBv\ncnQgamF2YS5sYW5nLnJlZmxlY3QuRmllbGQ7CmltcG9ydCBqYXZhLmxhbmcu\ncmVmbGVjdC5NZW1iZXI7CmltcG9ydCBqYXZhLmxhbmcucmVmbGVjdC5NZXRo\nb2Q7CmltcG9ydCBqYXZhLnNlY3VyaXR5LkFjY2Vzc0NvbnRyb2xsZXI7Cmlt\ncG9ydCBqYXZhLnNlY3VyaXR5LlByaXZpbGVnZWRBY3Rpb25FeGNlcHRpb247\nCmltcG9ydCBqYXZhLnV0aWwuQXJyYXlMaXN0OwppbXBvcnQgamF2YS51dGls\nLkNvbGxlY3Rpb247CmltcG9ydCBqYXZhLnV0aWwuRW51bVNldDsKaW1wb3J0\nIGphdmEudXRpbC5IYXNoTWFwOwppbXBvcnQgamF2YS51dGlsLk1hcDsKaW1w\nb3J0IGphdmEudXRpbC5TZXQ7CmltcG9ydCBqYXZhLnV0aWwuU3RhY2s7Cmlt\ncG9ydCBqYXZheC5wZXJzaXN0ZW5jZS5DYXNjYWRlVHlwZTsKaW1wb3J0IGph\ndmF4LnBlcnNpc3RlbmNlLkdlbmVyYXRpb25UeXBlOwppbXBvcnQgc3RhdGlj\nIGphdmF4LnBlcnNpc3RlbmNlLkNhc2NhZGVUeXBlLio7CgppbXBvcnQgb3Jn\nLmFwYWNoZS5jb21tb25zLmxhbmcuU3RyaW5nVXRpbHM7CmltcG9ydCBvcmcu\neG1sLnNheC5BdHRyaWJ1dGVzOwppbXBvcnQgb3JnLnhtbC5zYXguU0FYRXhj\nZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmNvbmYuT3BlbkpQ\nQUNvbmZpZ3VyYXRpb247CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuZW5o\nYW5jZS5QZXJzaXN0ZW5jZUNhcGFibGU7CmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEuZXZlbnQuQmVhbkxpZmVjeWNsZUNhbGxiYWNrczsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5ldmVudC5MaWZlY3ljbGVDYWxsYmFja3M7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuZXZlbnQuTGlmZWN5Y2xlRXZlbnQ7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuZXZlbnQuTWV0aG9kTGlmZWN5\nY2xlQ2FsbGJhY2tzOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5l\nbC5RdWVyeUxhbmd1YWdlczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5r\nZXJuZWwuanBxbC5KUFFMUGFyc2VyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLmxpYi5jb25mLkNvbmZpZ3VyYXRpb25zOwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLmxpYi5sb2cuTG9nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLmxpYi5tZXRhLkNGTWV0YURhdGFQYXJzZXI7CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEubGliLnV0aWwuSjJEb1ByaXZIZWxwZXI7CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuTG9jYWxpemVyOwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuQ2xhc3NNZXRhRGF0YTsKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5tZXRhLkRlbGVnYXRpbmdNZXRhRGF0YUZh\nY3Rvcnk7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YS5GaWVsZE1l\ndGFEYXRhOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuSmF2YVR5\ncGVzOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuTGlmZWN5Y2xl\nTWV0YURhdGE7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YS5NZXRh\nRGF0YURlZmF1bHRzOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEu\nTWV0YURhdGFGYWN0b3J5OwppbXBvcnQgc3RhdGljIG9yZy5hcGFjaGUub3Bl\nbmpwYS5tZXRhLk1ldGFEYXRhTW9kZXMuKjsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS5tZXRhLk1ldGFEYXRhUmVwb3NpdG9yeTsKaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS5tZXRhLk9yZGVyOwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLm1ldGEuUXVlcnlNZXRhRGF0YTsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS5tZXRhLlNlcXVlbmNlTWV0YURhdGE7CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEubWV0YS5WYWx1ZU1ldGFEYXRhOwppbXBvcnQgc3RhdGlj\nIG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5NZXRhRGF0YVRhZy4q\nOwppbXBvcnQgc3RhdGljIG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5j\nZS5QZXJzaXN0ZW5jZVN0cmF0ZWd5Lio7CmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEudXRpbC5JbXBsSGVscGVyOwoKLyoqCiAqIEN1c3RvbSBTQVggcGFy\nc2VyIHVzZWQgYnkgdGhlIHN5c3RlbSB0byBxdWlja2x5IHBhcnNlIHBlcnNp\nc3RlbmNlIGkKICogbWV0YWRhdGEgZmlsZXMuCiAqCiAqIEBhdXRob3IgU3Rl\ndmUgS2ltCiAqIEBub2phdmFkb2MKICovCnB1YmxpYyBjbGFzcyBYTUxQZXJz\naXN0ZW5jZU1ldGFEYXRhUGFyc2VyCiAgICBleHRlbmRzIENGTWV0YURhdGFQ\nYXJzZXIKICAgIGltcGxlbWVudHMgUGVyc2lzdGVuY2VNZXRhRGF0YUZhY3Rv\ncnkuUGFyc2VyIHsKCiAgICAvLyBwYXJzZSBjb25zdGFudHMKICAgIHByb3Rl\nY3RlZCBzdGF0aWMgZmluYWwgU3RyaW5nIEVMRU1fUEtHID0gInBhY2thZ2Ui\nOwogICAgcHJvdGVjdGVkIHN0YXRpYyBmaW5hbCBTdHJpbmcgRUxFTV9BQ0NF\nU1MgPSAiYWNjZXNzIjsKICAgIHByb3RlY3RlZCBzdGF0aWMgZmluYWwgU3Ry\naW5nIEVMRU1fQVRUUlMgPSAiYXR0cmlidXRlcyI7CiAgICBwcm90ZWN0ZWQg\nc3RhdGljIGZpbmFsIFN0cmluZyBFTEVNX0xJU1RFTkVSID0gImVudGl0eS1s\naXN0ZW5lciI7CiAgICBwcm90ZWN0ZWQgc3RhdGljIGZpbmFsIFN0cmluZyBF\nTEVNX0NBU0NBREUgPSAiY2FzY2FkZSI7CiAgICBwcm90ZWN0ZWQgc3RhdGlj\nIGZpbmFsIFN0cmluZyBFTEVNX0NBU0NBREVfQUxMID0gImNhc2NhZGUtYWxs\nIjsKICAgIHByb3RlY3RlZCBzdGF0aWMgZmluYWwgU3RyaW5nIEVMRU1fQ0FT\nQ0FERV9QRVIgPSAiY2FzY2FkZS1wZXJzaXN0IjsKICAgIHByb3RlY3RlZCBz\ndGF0aWMgZmluYWwgU3RyaW5nIEVMRU1fQ0FTQ0FERV9NRVIgPSAiY2FzY2Fk\nZS1tZXJnZSI7CiAgICBwcm90ZWN0ZWQgc3RhdGljIGZpbmFsIFN0cmluZyBF\nTEVNX0NBU0NBREVfUkVNID0gImNhc2NhZGUtcmVtb3ZlIjsKICAgIHByb3Rl\nY3RlZCBzdGF0aWMgZmluYWwgU3RyaW5nIEVMRU1fQ0FTQ0FERV9SRUYgPSAi\nY2FzY2FkZS1yZWZyZXNoIjsKICAgIHByb3RlY3RlZCBzdGF0aWMgZmluYWwg\nU3RyaW5nIEVMRU1fUFVfTUVUQSA9ICJwZXJzaXN0ZW5jZS11bml0LW1ldGFk\nYXRhIjsKICAgIHByb3RlY3RlZCBzdGF0aWMgZmluYWwgU3RyaW5nIEVMRU1f\nUFVfREVGID0gInBlcnNpc3RlbmNlLXVuaXQtZGVmYXVsdHMiOwogICAgcHJv\ndGVjdGVkIHN0YXRpYyBmaW5hbCBTdHJpbmcgRUxFTV9YTUxfTUFQX01FVEFf\nQ09NUExFVEUgPQogICAgICAgICJ4bWwtbWFwcGluZy1tZXRhZGF0YS1jb21w\nbGV0ZSI7CgogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgTWFwPFN0cmluZywg\nT2JqZWN0PiBfZWxlbXMgPQogICAgICAgIG5ldyBIYXNoTWFwPFN0cmluZywg\nT2JqZWN0PigpOwoKICAgIHN0YXRpYyB7CiAgICAgICAgX2VsZW1zLnB1dChF\nTEVNX1BLRywgRUxFTV9QS0cpOwogICAgICAgIF9lbGVtcy5wdXQoRUxFTV9B\nQ0NFU1MsIEVMRU1fQUNDRVNTKTsKICAgICAgICBfZWxlbXMucHV0KEVMRU1f\nQVRUUlMsIEVMRU1fQVRUUlMpOwogICAgICAgIF9lbGVtcy5wdXQoRUxFTV9M\nSVNURU5FUiwgRUxFTV9MSVNURU5FUik7CiAgICAgICAgX2VsZW1zLnB1dChF\nTEVNX0NBU0NBREUsIEVMRU1fQ0FTQ0FERSk7CiAgICAgICAgX2VsZW1zLnB1\ndChFTEVNX0NBU0NBREVfQUxMLCBFTEVNX0NBU0NBREVfQUxMKTsKICAgICAg\nICBfZWxlbXMucHV0KEVMRU1fQ0FTQ0FERV9QRVIsIEVMRU1fQ0FTQ0FERV9Q\nRVIpOwogICAgICAgIF9lbGVtcy5wdXQoRUxFTV9DQVNDQURFX1JFTSwgRUxF\nTV9DQVNDQURFX1JFTSk7CiAgICAgICAgX2VsZW1zLnB1dChFTEVNX0NBU0NB\nREVfTUVSLCBFTEVNX0NBU0NBREVfTUVSKTsKICAgICAgICBfZWxlbXMucHV0\nKEVMRU1fQ0FTQ0FERV9SRUYsIEVMRU1fQ0FTQ0FERV9SRUYpOwogICAgICAg\nIF9lbGVtcy5wdXQoRUxFTV9QVV9NRVRBLCBFTEVNX1BVX01FVEEpOwogICAg\nICAgIF9lbGVtcy5wdXQoRUxFTV9QVV9ERUYsIEVMRU1fUFVfREVGKTsKICAg\nICAgICBfZWxlbXMucHV0KEVMRU1fWE1MX01BUF9NRVRBX0NPTVBMRVRFLCBF\nTEVNX1hNTF9NQVBfTUVUQV9DT01QTEVURSk7CgogICAgICAgIF9lbGVtcy5w\ndXQoImVudGl0eS1saXN0ZW5lcnMiLCBFTlRJVFlfTElTVEVORVJTKTsKICAg\nICAgICBfZWxlbXMucHV0KCJwcmUtcGVyc2lzdCIsIFBSRV9QRVJTSVNUKTsK\nICAgICAgICBfZWxlbXMucHV0KCJwb3N0LXBlcnNpc3QiLCBQT1NUX1BFUlNJ\nU1QpOwogICAgICAgIF9lbGVtcy5wdXQoInByZS1yZW1vdmUiLCBQUkVfUkVN\nT1ZFKTsKICAgICAgICBfZWxlbXMucHV0KCJwb3N0LXJlbW92ZSIsIFBPU1Rf\nUkVNT1ZFKTsKICAgICAgICBfZWxlbXMucHV0KCJwcmUtdXBkYXRlIiwgUFJF\nX1VQREFURSk7CiAgICAgICAgX2VsZW1zLnB1dCgicG9zdC11cGRhdGUiLCBQ\nT1NUX1VQREFURSk7CiAgICAgICAgX2VsZW1zLnB1dCgicG9zdC1sb2FkIiwg\nUE9TVF9MT0FEKTsKICAgICAgICBfZWxlbXMucHV0KCJleGNsdWRlLWRlZmF1\nbHQtbGlzdGVuZXJzIiwgRVhDTFVERV9ERUZBVUxUX0xJU1RFTkVSUyk7CiAg\nICAgICAgX2VsZW1zLnB1dCgiZXhjbHVkZS1zdXBlcmNsYXNzLWxpc3RlbmVy\ncyIsCiAgICAgICAgICAgIEVYQ0xVREVfU1VQRVJDTEFTU19MSVNURU5FUlMp\nOwoKICAgICAgICBfZWxlbXMucHV0KCJuYW1lZC1xdWVyeSIsIFFVRVJZKTsK\nICAgICAgICBfZWxlbXMucHV0KCJuYW1lZC1uYXRpdmUtcXVlcnkiLCBOQVRJ\nVkVfUVVFUlkpOwogICAgICAgIF9lbGVtcy5wdXQoInF1ZXJ5LWhpbnQiLCBR\nVUVSWV9ISU5UKTsKICAgICAgICBfZWxlbXMucHV0KCJxdWVyeSIsIFFVRVJZ\nX1NUUklORyk7CgogICAgICAgIF9lbGVtcy5wdXQoImZsdXNoLW1vZGUiLCBG\nTFVTSF9NT0RFKTsKICAgICAgICBfZWxlbXMucHV0KCJzZXF1ZW5jZS1nZW5l\ncmF0b3IiLCBTRVFfR0VORVJBVE9SKTsKCiAgICAgICAgX2VsZW1zLnB1dCgi\naWQiLCBJRCk7CiAgICAgICAgX2VsZW1zLnB1dCgiaWQtY2xhc3MiLCBJRF9D\nTEFTUyk7CiAgICAgICAgX2VsZW1zLnB1dCgiZW1iZWRkZWQtaWQiLCBFTUJF\nRERFRF9JRCk7CiAgICAgICAgX2VsZW1zLnB1dCgidmVyc2lvbiIsIFZFUlNJ\nT04pOwogICAgICAgIF9lbGVtcy5wdXQoImdlbmVyYXRlZC12YWx1ZSIsIEdF\nTkVSQVRFRF9WQUxVRSk7CiAgICAgICAgX2VsZW1zLnB1dCgibWFwLWtleSIs\nIE1BUF9LRVkpOwogICAgICAgIF9lbGVtcy5wdXQoIm9yZGVyLWJ5IiwgT1JE\nRVJfQlkpOwogICAgICAgIF9lbGVtcy5wdXQoImxvYiIsIExPQik7CgogICAg\nICAgIF9lbGVtcy5wdXQoImJhc2ljIiwgQkFTSUMpOwogICAgICAgIF9lbGVt\ncy5wdXQoIm1hbnktdG8tb25lIiwgTUFOWV9PTkUpOwogICAgICAgIF9lbGVt\ncy5wdXQoIm9uZS10by1vbmUiLCBPTkVfT05FKTsKICAgICAgICBfZWxlbXMu\ncHV0KCJlbWJlZGRlZCIsIEVNQkVEREVEKTsKICAgICAgICBfZWxlbXMucHV0\nKCJvbmUtdG8tbWFueSIsIE9ORV9NQU5ZKTsKICAgICAgICBfZWxlbXMucHV0\nKCJtYW55LXRvLW1hbnkiLCBNQU5ZX01BTlkpOwogICAgICAgIF9lbGVtcy5w\ndXQoInRyYW5zaWVudCIsIFRSQU5TSUVOVCk7CiAgICB9CgogICAgcHJpdmF0\nZSBzdGF0aWMgZmluYWwgTG9jYWxpemVyIF9sb2MgPSBMb2NhbGl6ZXIuZm9y\nUGFja2FnZQogICAgICAgIChYTUxQZXJzaXN0ZW5jZU1ldGFEYXRhUGFyc2Vy\nLmNsYXNzKTsKCiAgICBwcml2YXRlIGZpbmFsIE9wZW5KUEFDb25maWd1cmF0\naW9uIF9jb25mOwogICAgcHJpdmF0ZSBNZXRhRGF0YVJlcG9zaXRvcnkgX3Jl\ncG9zID0gbnVsbDsKICAgIHByaXZhdGUgQW5ub3RhdGlvblBlcnNpc3RlbmNl\nTWV0YURhdGFQYXJzZXIgX3BhcnNlciA9IG51bGw7CiAgICBwcml2YXRlIENs\nYXNzTG9hZGVyIF9lbnZMb2FkZXIgPSBudWxsOwogICAgcHJpdmF0ZSBpbnQg\nX21vZGUgPSBNT0RFX05PTkU7CiAgICBwcml2YXRlIGJvb2xlYW4gX292ZXJy\naWRlID0gZmFsc2U7CgogICAgcHJpdmF0ZSBmaW5hbCBTdGFjayBfZWxlbWVu\ndHMgPSBuZXcgU3RhY2soKTsKICAgIHByaXZhdGUgZmluYWwgU3RhY2sgX3Bh\ncmVudHMgPSBuZXcgU3RhY2soKTsKCiAgICBwcml2YXRlIENsYXNzIF9jbHMg\nPSBudWxsOwogICAgcHJpdmF0ZSBpbnQgX2ZpZWxkUG9zID0gMDsKICAgIHBy\naXZhdGUgaW50IF9jbHNQb3MgPSAwOwogICAgcHJpdmF0ZSBpbnQgX2FjY2Vz\ncyA9IENsYXNzTWV0YURhdGEuQUNDRVNTX1VOS05PV047CiAgICBwcml2YXRl\nIFBlcnNpc3RlbmNlU3RyYXRlZ3kgX3N0cmF0ZWd5ID0gbnVsbDsKICAgIHBy\naXZhdGUgU2V0PENhc2NhZGVUeXBlPiBfY2FzY2FkZXMgPSBudWxsOwogICAg\ncHJpdmF0ZSBTZXQ8Q2FzY2FkZVR5cGU+IF9wa2dDYXNjYWRlcyA9IG51bGw7\nCgogICAgcHJpdmF0ZSBDbGFzcyBfbGlzdGVuZXIgPSBudWxsOwogICAgcHJp\ndmF0ZSBDb2xsZWN0aW9uPExpZmVjeWNsZUNhbGxiYWNrcz5bXSBfY2FsbGJh\nY2tzID0gbnVsbDsKICAgIHByaXZhdGUgaW50W10gX2hpZ2hzID0gbnVsbDsK\nCiAgICAvKioKICAgICAqIENvbnN0cnVjdG9yOyBzdXBwbHkgY29uZmlndXJh\ndGlvbi4KICAgICAqLwogICAgcHVibGljIFhNTFBlcnNpc3RlbmNlTWV0YURh\ndGFQYXJzZXIoT3BlbkpQQUNvbmZpZ3VyYXRpb24gY29uZikgewogICAgICAg\nIF9jb25mID0gY29uZjsKICAgICAgICBzZXRWYWxpZGF0aW5nKHRydWUpOwog\nICAgICAgIHNldExvZyhjb25mLmdldExvZyhPcGVuSlBBQ29uZmlndXJhdGlv\nbi5MT0dfTUVUQURBVEEpKTsKICAgICAgICBzZXRQYXJzZUNvbW1lbnRzKHRy\ndWUpOwogICAgICAgIHNldE1vZGUoTU9ERV9NRVRBIHwgTU9ERV9NQVBQSU5H\nIHwgTU9ERV9RVUVSWSk7CiAgICAgICAgc2V0UGFyc2VUZXh0KHRydWUpOwog\nICAgfQoKICAgIC8qKgogICAgICogQ29uZmlndXJhdGlvbiBzdXBwbGllZCBv\nbiBjb25zdHJ1Y3Rpb24uCiAgICAgKi8KICAgIHB1YmxpYyBPcGVuSlBBQ29u\nZmlndXJhdGlvbiBnZXRDb25maWd1cmF0aW9uKCkgewogICAgICAgIHJldHVy\nbiBfY29uZjsKICAgIH0KCiAgICAvKioKICAgICAqIFRoZSBhbm5vdGF0aW9u\nIHBhcnNlci4gV2hlbiBjbGFzcyBpcyBkaXNjb3ZlcmVkIGluIGFuIFhNTCBm\naWxlLAogICAgICogd2UgZmlyc3QgcGFyc2UgYW55IGFubm90YXRpb25zIHBy\nZXNlbnQsIHRoZW4gb3ZlcnJpZGUgd2l0aCB0aGUgWE1MLgogICAgICovCiAg\nICBwdWJsaWMgQW5ub3RhdGlvblBlcnNpc3RlbmNlTWV0YURhdGFQYXJzZXIg\nZ2V0QW5ub3RhdGlvblBhcnNlcigpIHsKICAgICAgICByZXR1cm4gX3BhcnNl\ncjsKICAgIH0KCiAgICAvKioKICAgICAqIFRoZSBhbm5vdGF0aW9uIHBhcnNl\nci4gV2hlbiBjbGFzcyBpcyBkaXNjb3ZlcmVkIGluIGFuIFhNTCBmaWxlLAog\nICAgICogd2UgZmlyc3QgcGFyc2UgYW55IGFubm90YXRpb25zIHByZXNlbnQs\nIHRoZW4gb3ZlcnJpZGUgd2l0aCB0aGUgWE1MLgogICAgICovCiAgICBwdWJs\naWMgdm9pZCBzZXRBbm5vdGF0aW9uUGFyc2VyKEFubm90YXRpb25QZXJzaXN0\nZW5jZU1ldGFEYXRhUGFyc2VyIHBhcnNlcil7CiAgICAgICAgX3BhcnNlciA9\nIHBhcnNlcjsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybnMgdGhlIHJl\ncG9zaXRvcnkgZm9yIHRoaXMgcGFyc2VyLiBJZiBub25lIGhhcyBiZWVuIHNl\ndCwgY3JlYXRlcwogICAgICogYSBuZXcgcmVwb3NpdG9yeSBhbmQgc2V0cyBp\ndC4KICAgICAqLwogICAgcHVibGljIE1ldGFEYXRhUmVwb3NpdG9yeSBnZXRS\nZXBvc2l0b3J5KCkgewogICAgICAgIGlmIChfcmVwb3MgPT0gbnVsbCkgewog\nICAgICAgICAgICBNZXRhRGF0YVJlcG9zaXRvcnkgcmVwb3MgPSBfY29uZi5u\nZXdNZXRhRGF0YVJlcG9zaXRvcnlJbnN0YW5jZSgpOwogICAgICAgICAgICBN\nZXRhRGF0YUZhY3RvcnkgbWRmID0gcmVwb3MuZ2V0TWV0YURhdGFGYWN0b3J5\nKCk7CiAgICAgICAgICAgIGlmIChtZGYgaW5zdGFuY2VvZiBEZWxlZ2F0aW5n\nTWV0YURhdGFGYWN0b3J5KQogICAgICAgICAgICAgICAgbWRmID0gKChEZWxl\nZ2F0aW5nTWV0YURhdGFGYWN0b3J5KSBtZGYpLmdldElubmVybW9zdERlbGVn\nYXRlKCk7CiAgICAgICAgICAgIGlmIChtZGYgaW5zdGFuY2VvZiBQZXJzaXN0\nZW5jZU1ldGFEYXRhRmFjdG9yeSkKICAgICAgICAgICAgICAgICgoUGVyc2lz\ndGVuY2VNZXRhRGF0YUZhY3RvcnkpIG1kZikuc2V0WE1MUGFyc2VyKHRoaXMp\nOwogICAgICAgICAgICBfcmVwb3MgPSByZXBvczsKICAgICAgICB9CiAgICAg\nICAgcmV0dXJuIF9yZXBvczsKICAgIH0KCiAgICAvKioKICAgICAqIFNldCB0\naGUgbWV0YWRhdGEgcmVwb3NpdG9yeSBmb3IgdGhpcyBwYXJzZXIuCiAgICAg\nKi8KICAgIHB1YmxpYyB2b2lkIHNldFJlcG9zaXRvcnkoTWV0YURhdGFSZXBv\nc2l0b3J5IHJlcG9zKSB7CiAgICAgICAgX3JlcG9zID0gcmVwb3M7CiAgICAg\nICAgaWYgKHJlcG9zICE9IG51bGwKICAgICAgICAgICAgJiYgKHJlcG9zLmdl\ndFZhbGlkYXRlKCkgJiByZXBvcy5WQUxJREFURV9SVU5USU1FKSAhPSAwKQog\nICAgICAgICAgICBzZXRQYXJzZUNvbW1lbnRzKGZhbHNlKTsKICAgIH0KCiAg\nICAvKioKICAgICAqIFJldHVybiB0aGUgZW52aXJvbm1lbnRhbCBjbGFzcyBs\nb2FkZXIgdG8gcGFzcyBvbiB0byBwYXJzZWQKICAgICAqIG1ldGFkYXRhIGlu\nc3RhbmNlcy4KICAgICAqLwogICAgcHVibGljIENsYXNzTG9hZGVyIGdldEVu\ndkNsYXNzTG9hZGVyKCkgewogICAgICAgIHJldHVybiBfZW52TG9hZGVyOwog\nICAgfQoKICAgIC8qKgogICAgICogU2V0IHRoZSBlbnZpcm9ubWVudGFsIGNs\nYXNzIGxvYWRlciB0byBwYXNzIG9uIHRvIHBhcnNlZAogICAgICogbWV0YWRh\ndGEgaW5zdGFuY2VzLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRFbnZD\nbGFzc0xvYWRlcihDbGFzc0xvYWRlciBsb2FkZXIpIHsKICAgICAgICBfZW52\nTG9hZGVyID0gbG9hZGVyOwogICAgfQoKICAgIC8qKgogICAgICogV2hldGhl\nciB0byBhbGxvdyBsYXRlciBwYXJzZXMgb2YgbWFwcGluZyBpbmZvcm1hdGlv\nbiB0byBvdmVycmlkZQogICAgICogZWFybGllciBpbmZvcm1hdGlvbiBmb3Ig\ndGhlIHNhbWUgY2xhc3MuIERlZmF1bHRzIHRvIGZhbHNlLiBVc2VmdWwKICAg\nICAqIHdoZW4gYSB0b29sIGlzIG1hcHBpbmcgYSBjbGFzcywgc28gdGhhdCAu\namRvIGZpbGUgcGFydGlhbCBtYXBwaW5nCiAgICAgKiBpbmZvcm1hdGlvbiBj\nYW4gYmUgdXNlZCBldmVuIHdoZW4gbWFwcGluZ3MgYXJlIHN0b3JlZCBpbiAu\nb3JtIGZpbGVzCiAgICAgKiBvciBvdGhlciBsb2NhdGlvbnMuCiAgICAgKi8K\nICAgIHB1YmxpYyBib29sZWFuIGdldE1hcHBpbmdPdmVycmlkZSgpIHsKICAg\nICAgICByZXR1cm4gX292ZXJyaWRlOwogICAgfQoKICAgIC8qKgogICAgICog\nV2hldGhlciB0byBhbGxvdyBsYXRlciBwYXJzZXMgb2YgbWFwcGluZyBpbmZv\ncm1hdGlvbiB0byBvdmVycmlkZQogICAgICogZWFybGllciBpbmZvcm1hdGlv\nbiBmb3IgdGhlIHNhbWUgY2xhc3MuIERlZmF1bHRzIHRvIGZhbHNlLiBVc2Vm\ndWwKICAgICAqIHdoZW4gYSB0b29sIGlzIG1hcHBpbmcgYSBjbGFzcywgc28g\ndGhhdCAuamRvIGZpbGUgcGFydGlhbCBtYXBwaW5nCiAgICAgKiBpbmZvcm1h\ndGlvbiBjYW4gYmUgdXNlZCBldmVuIHdoZW4gbWFwcGluZ3MgYXJlIHN0b3Jl\nZCBpbiAub3JtIGZpbGVzCiAgICAgKiBvciBvdGhlciBsb2NhdGlvbnMuCiAg\nICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldE1hcHBpbmdPdmVycmlkZShib29s\nZWFuIG92ZXJyaWRlKSB7CiAgICAgICAgX292ZXJyaWRlID0gb3ZlcnJpZGU7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBUaGUgcGFyc2UgbW9kZSBhY2NvcmRp\nbmcgdG8gdGhlIGV4cGVjdGVkIGRvY3VtZW50IHR5cGUuIFRoZQogICAgICog\nbW9kZSBjb25zdGFudHMgYWN0IGFzIGJpdCBmbGFncywgYW5kIHRoZXJlZm9y\nZSBjYW4gYmUgY29tYmluZWQuCiAgICAgKi8KICAgIHB1YmxpYyBpbnQgZ2V0\nTW9kZSgpIHsKICAgICAgICByZXR1cm4gX21vZGU7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBUaGUgcGFyc2UgbW9kZSBhY2NvcmRpbmcgdG8gdGhlIGV4cGVj\ndGVkIGRvY3VtZW50IHR5cGUuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNl\ndE1vZGUoaW50IG1vZGUsIGJvb2xlYW4gb24pIHsKICAgICAgICBpZiAobW9k\nZSA9PSBNT0RFX05PTkUpCiAgICAgICAgICAgIHNldE1vZGUoTU9ERV9OT05F\nKTsKICAgICAgICBlbHNlIGlmIChvbikKICAgICAgICAgICAgc2V0TW9kZShf\nbW9kZSB8IG1vZGUpOwogICAgICAgIGVsc2UKICAgICAgICAgICAgc2V0TW9k\nZShfbW9kZSAmIH5tb2RlKTsKICAgIH0KCiAgICAvKioKICAgICAqIFRoZSBw\nYXJzZSBtb2RlIGFjY29yZGluZyB0byB0aGUgZXhwZWN0ZWQgZG9jdW1lbnQg\ndHlwZS4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0TW9kZShpbnQgbW9k\nZSkgewogICAgICAgIF9tb2RlID0gbW9kZTsKICAgICAgICBpZiAoX3BhcnNl\nciAhPSBudWxsKQogICAgICAgICAgICBfcGFyc2VyLnNldE1vZGUobW9kZSk7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBDb252ZW5pZW5jZSBtZXRob2QgZm9y\nIGludGVycHJldGluZyB7QGxpbmsgI2dldE1vZGV9LgogICAgICovCiAgICBw\ncm90ZWN0ZWQgYm9vbGVhbiBpc01ldGFEYXRhTW9kZSgpIHsKICAgICAgICBy\nZXR1cm4gKF9tb2RlICYgTU9ERV9NRVRBKSAhPSAwOwogICAgfQoKICAgIC8q\nKgogICAgICogQ29udmVuaWVuY2UgbWV0aG9kIGZvciBpbnRlcnByZXRpbmcg\ne0BsaW5rICNnZXRNb2RlfS4KICAgICAqLwogICAgcHJvdGVjdGVkIGJvb2xl\nYW4gaXNRdWVyeU1vZGUoKSB7CiAgICAgICAgcmV0dXJuIChfbW9kZSAmIE1P\nREVfUVVFUlkpICE9IDA7CiAgICB9CgogICAgLyoqCiAgICAgKiBDb252ZW5p\nZW5jZSBtZXRob2QgZm9yIGludGVycHJldGluZyB7QGxpbmsgI2dldE1vZGV9\nLgogICAgICovCiAgICBwcm90ZWN0ZWQgYm9vbGVhbiBpc01hcHBpbmdNb2Rl\nKCkgewogICAgICAgIHJldHVybiAoX21vZGUgJiBNT0RFX01BUFBJTkcpICE9\nIDA7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm5zIHRydWUgaWYgd2Un\ncmUgaW4gbWFwcGluZyBtb2RlIG9yIGluIG1ldGFkYXRhIG1vZGUgd2l0aAog\nICAgICogbWFwcGluZyBvdmVycmlkZSBlbmFibGVkLgogICAgICovCiAgICBw\ncm90ZWN0ZWQgYm9vbGVhbiBpc01hcHBpbmdPdmVycmlkZU1vZGUoKSB7CiAg\nICAgICAgcmV0dXJuIGlzTWFwcGluZ01vZGUoKSB8fCAoX292ZXJyaWRlICYm\nIGlzTWV0YURhdGFNb2RlKCkpOwogICAgfQoKICAgIC8vLy8vLy8vLy8vLy8v\nLwogICAgLy8gWE1MIHBhcnNpbmcKICAgIC8vLy8vLy8vLy8vLy8vLwoKICAg\nIC8qKgogICAgICogUHVzaCBhIHBhcnNlIGVsZW1lbnQgb250byB0aGUgc3Rh\nY2suCiAgICAgKi8KICAgIHByb3RlY3RlZCB2b2lkIHB1c2hFbGVtZW50KE9i\namVjdCBlbGVtKSB7CiAgICAgICAgX2VsZW1lbnRzLnB1c2goZWxlbSk7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBQb3AgYSBwYXJzZSBlbGVtZW50IGZyb20g\ndGhlIHN0YWNrLgogICAgICovCiAgICBwcm90ZWN0ZWQgT2JqZWN0IHBvcEVs\nZW1lbnQoKSB7CiAgICAgICAgcmV0dXJuIF9lbGVtZW50cy5wb3AoKTsKICAg\nIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgY3VycmVudCBlbGVtZW50\nIGJlaW5nIHBhcnNlZC4gTWF5IGJlIGEgY2xhc3MgbWV0YWRhdGEsCiAgICAg\nKiBmaWVsZCBtZXRhZGF0YSwgcXVlcnkgbWV0YWRhdGEsIGV0Yy4KICAgICAq\nLwogICAgcHJvdGVjdGVkIE9iamVjdCBjdXJyZW50RWxlbWVudCgpIHsKICAg\nICAgICBpZiAoX2VsZW1lbnRzLmlzRW1wdHkoKSkKICAgICAgICAgICAgcmV0\ndXJuIG51bGw7CiAgICAgICAgcmV0dXJuIF9lbGVtZW50cy5wZWVrKCk7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIGN1cnJlbnQge0BsaW5r\nIFBlcnNpc3RlbmNlU3RyYXRlZ3l9IGlmIGFueS4KICAgICAqLwogICAgcHJv\ndGVjdGVkIFBlcnNpc3RlbmNlU3RyYXRlZ3kgY3VycmVudFN0cmF0ZWd5KCkg\newogICAgICAgIHJldHVybiBfc3RyYXRlZ3k7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBSZXR1cm4gdGhlIHRhZyBvZiB0aGUgY3VycmVudCBwYXJlbnQgZWxl\nbWVudC4KICAgICAqLwogICAgcHJvdGVjdGVkIE9iamVjdCBjdXJyZW50UGFy\nZW50KCkgewogICAgICAgIGlmIChfcGFyZW50cy5pc0VtcHR5KCkpCiAgICAg\nICAgICAgIHJldHVybiBudWxsOwogICAgICAgIHJldHVybiBfcGFyZW50cy5w\nZWVrKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gd2hldGhlciB3\nZSdyZSBydW5uaW5nIHRoZSBwYXJzZXIgYXQgcnVudGltZS4KICAgICAqLwog\nICAgcHJvdGVjdGVkIGJvb2xlYW4gaXNSdW50aW1lKCkgewogICAgICAgIHJl\ndHVybiAoZ2V0UmVwb3NpdG9yeSgpLmdldFZhbGlkYXRlKCkKICAgICAgICAg\nICAgJiBNZXRhRGF0YVJlcG9zaXRvcnkuVkFMSURBVEVfUlVOVElNRSkgIT0g\nMDsKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHByb3RlY3RlZCBPYmplY3Qg\nZ2V0U2NoZW1hU291cmNlKCkgewogICAgICAgIHJldHVybiBYTUxQZXJzaXN0\nZW5jZU1ldGFEYXRhUGFyc2VyLmNsYXNzLmdldFJlc291cmNlQXNTdHJlYW0K\nICAgICAgICAgICAgKCJvcm0teHNkLnJzcmMiKTsKICAgIH0KCiAgICBAT3Zl\ncnJpZGUKICAgIHByb3RlY3RlZCBTdHJpbmcgZ2V0UGFja2FnZUF0dHJpYnV0\nZU5hbWUoKSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICB9CgogICAgQE92\nZXJyaWRlCiAgICBwcm90ZWN0ZWQgU3RyaW5nIGdldENsYXNzQXR0cmlidXRl\nTmFtZSgpIHsKICAgICAgICByZXR1cm4gImNsYXNzIjsKICAgIH0KCiAgICBA\nT3ZlcnJpZGUKICAgIHByb3RlY3RlZCBpbnQgZ2V0Q2xhc3NFbGVtZW50RGVw\ndGgoKSB7CiAgICAgICAgcmV0dXJuIDE7CiAgICB9CgogICAgQE92ZXJyaWRl\nCiAgICBwcm90ZWN0ZWQgYm9vbGVhbiBpc0NsYXNzRWxlbWVudE5hbWUoU3Ry\naW5nIG5hbWUpIHsKICAgICAgICByZXR1cm4gImVudGl0eSIuZXF1YWxzKG5h\nbWUpCiAgICAgICAgICAgIHx8ICJlbWJlZGRhYmxlIi5lcXVhbHMobmFtZSkK\nICAgICAgICAgICAgfHwgIm1hcHBlZC1zdXBlcmNsYXNzIi5lcXVhbHMobmFt\nZSk7CiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwcm90ZWN0ZWQgdm9pZCBy\nZXNldCgpIHsKICAgICAgICBzdXBlci5yZXNldCgpOwogICAgICAgIF9lbGVt\nZW50cy5jbGVhcigpOwogICAgICAgIF9wYXJlbnRzLmNsZWFyKCk7CiAgICAg\nICAgX2NscyA9IG51bGw7CiAgICAgICAgX2ZpZWxkUG9zID0gMDsKICAgICAg\nICBfY2xzUG9zID0gMDsKCiAgICAgICAgX2FjY2VzcyA9IENsYXNzTWV0YURh\ndGEuQUNDRVNTX1VOS05PV047CiAgICAgICAgX3N0cmF0ZWd5ID0gbnVsbDsK\nICAgICAgICBfbGlzdGVuZXIgPSBudWxsOwogICAgICAgIF9jYWxsYmFja3Mg\nPSBudWxsOwogICAgICAgIF9oaWdocyA9IG51bGw7CiAgICAgICAgX2Nhc2Nh\nZGVzID0gbnVsbDsKICAgICAgICBfcGtnQ2FzY2FkZXMgPSBudWxsOwogICAg\nfQoKICAgIEBPdmVycmlkZQogICAgcHJvdGVjdGVkIGJvb2xlYW4gc3RhcnRT\neXN0ZW1FbGVtZW50KFN0cmluZyBuYW1lLCBBdHRyaWJ1dGVzIGF0dHJzKQog\nICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24gewogICAgICAgIE9iamVjdCB0\nYWcgPSAoT2JqZWN0KSBfZWxlbXMuZ2V0KG5hbWUpOwogICAgICAgIGJvb2xl\nYW4gcmV0ID0gZmFsc2U7CiAgICAgICAgaWYgKHRhZyA9PSBudWxsKSB7CiAg\nICAgICAgICAgIGlmIChpc01hcHBpbmdPdmVycmlkZU1vZGUoKSkKICAgICAg\nICAgICAgICAgIHRhZyA9IHN0YXJ0U3lzdGVtTWFwcGluZ0VsZW1lbnQobmFt\nZSwgYXR0cnMpOwogICAgICAgICAgICByZXQgPSB0YWcgIT0gbnVsbDsKICAg\nICAgICB9IGVsc2UgaWYgKHRhZyBpbnN0YW5jZW9mIE1ldGFEYXRhVGFnKSB7\nCiAgICAgICAgICAgIHN3aXRjaCAoKE1ldGFEYXRhVGFnKSB0YWcpIHsKICAg\nICAgICAgICAgICAgIGNhc2UgUVVFUlk6CiAgICAgICAgICAgICAgICAgICAg\ncmV0ID0gc3RhcnROYW1lZFF1ZXJ5KGF0dHJzKTsKICAgICAgICAgICAgICAg\nICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgUVVFUllfSElOVDoK\nICAgICAgICAgICAgICAgICAgICByZXQgPSBzdGFydFF1ZXJ5SGludChhdHRy\ncyk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAg\nICBjYXNlIE5BVElWRV9RVUVSWToKICAgICAgICAgICAgICAgICAgICByZXQg\nPSBzdGFydE5hbWVkTmF0aXZlUXVlcnkoYXR0cnMpOwogICAgICAgICAgICAg\nICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSBRVUVSWV9TVFJJ\nTkc6CiAgICAgICAgICAgICAgICAgICAgcmV0ID0gc3RhcnRRdWVyeVN0cmlu\nZyhhdHRycyk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAg\nICAgICAgICBjYXNlIFNFUV9HRU5FUkFUT1I6CiAgICAgICAgICAgICAgICAg\nICAgcmV0ID0gc3RhcnRTZXF1ZW5jZUdlbmVyYXRvcihhdHRycyk7CiAgICAg\nICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIEZM\nVVNIX01PREU6CiAgICAgICAgICAgICAgICAgICAgcmV0ID0gc3RhcnRGbHVz\naE1vZGUoYXR0cnMpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAg\nICAgICAgICAgICAgY2FzZSBFTlRJVFlfTElTVEVORVJTOgogICAgICAgICAg\nICAgICAgICAgIHJldCA9IHN0YXJ0RW50aXR5TGlzdGVuZXJzKGF0dHJzKTsK\nICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNh\nc2UgUFJFX1BFUlNJU1Q6CiAgICAgICAgICAgICAgICBjYXNlIFBPU1RfUEVS\nU0lTVDoKICAgICAgICAgICAgICAgIGNhc2UgUFJFX1JFTU9WRToKICAgICAg\nICAgICAgICAgIGNhc2UgUE9TVF9SRU1PVkU6CiAgICAgICAgICAgICAgICBj\nYXNlIFBSRV9VUERBVEU6CiAgICAgICAgICAgICAgICBjYXNlIFBPU1RfVVBE\nQVRFOgogICAgICAgICAgICAgICAgY2FzZSBQT1NUX0xPQUQ6CiAgICAgICAg\nICAgICAgICAgICAgcmV0ID0gc3RhcnRDYWxsYmFjaygoTWV0YURhdGFUYWcp\nIHRhZywgYXR0cnMpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAg\nICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAgICAgICB3YXJu\nVW5zdXBwb3J0ZWRUYWcobmFtZSk7CiAgICAgICAgICAgIH0KICAgICAgICB9\nIGVsc2UgaWYgKHRhZyA9PSBFTEVNX1BVX01FVEEgfHwgdGFnID09IEVMRU1f\nUFVfREVGKQogICAgICAgICAgICByZXQgPSBpc01ldGFEYXRhTW9kZSgpOwog\nICAgICAgIGVsc2UgaWYgKHRhZyA9PSBFTEVNX1hNTF9NQVBfTUVUQV9DT01Q\nTEVURSkKICAgICAgICAgICAgc2V0QW5ub3RhdGlvblBhcnNlcihudWxsKTsK\nICAgICAgICBlbHNlIGlmICh0YWcgPT0gRUxFTV9BQ0NFU1MpCiAgICAgICAg\nICAgIHJldCA9IF9tb2RlICE9IE1PREVfUVVFUlk7CiAgICAgICAgZWxzZSBp\nZiAodGFnID09IEVMRU1fTElTVEVORVIpCiAgICAgICAgICAgIHJldCA9IHN0\nYXJ0RW50aXR5TGlzdGVuZXIoYXR0cnMpOwogICAgICAgIGVsc2UgaWYgKHRh\nZyA9PSBFTEVNX0NBU0NBREUpCiAgICAgICAgICAgIHJldCA9IGlzTWV0YURh\ndGFNb2RlKCk7CiAgICAgICAgZWxzZSBpZiAodGFnID09IEVMRU1fQ0FTQ0FE\nRV9BTEwgfHwgdGFnID09IEVMRU1fQ0FTQ0FERV9QRVIKICAgICAgICAgICAg\nfHwgdGFnID09IEVMRU1fQ0FTQ0FERV9NRVIgfHwgdGFnID09IEVMRU1fQ0FT\nQ0FERV9SRU0KICAgICAgICAgICAgfHwgdGFnID09IEVMRU1fQ0FTQ0FERV9S\nRUYpCiAgICAgICAgICAgIHJldCA9IHN0YXJ0Q2FzY2FkZSh0YWcsIGF0dHJz\nKTsKCiAgICAgICAgaWYgKHJldCkKICAgICAgICAgICAgX3BhcmVudHMucHVz\naCh0YWcpOwogICAgICAgIHJldHVybiByZXQ7CiAgICB9CgogICAgQE92ZXJy\naWRlCiAgICBwcm90ZWN0ZWQgdm9pZCBlbmRTeXN0ZW1FbGVtZW50KFN0cmlu\nZyBuYW1lKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24gewogICAgICAg\nIE9iamVjdCB0YWcgPSBfZWxlbXMuZ2V0KG5hbWUpOwogICAgICAgIGlmICh0\nYWcgPT0gbnVsbCAmJiBpc01hcHBpbmdPdmVycmlkZU1vZGUoKSkKICAgICAg\nICAgICAgZW5kU3lzdGVtTWFwcGluZ0VsZW1lbnQobmFtZSk7CiAgICAgICAg\nZWxzZSBpZiAodGFnIGluc3RhbmNlb2YgTWV0YURhdGFUYWcpIHsKICAgICAg\nICAgICAgc3dpdGNoICgoTWV0YURhdGFUYWcpIHRhZykgewogICAgICAgICAg\nICAgICAgY2FzZSBRVUVSWToKICAgICAgICAgICAgICAgICAgICBlbmROYW1l\nZFF1ZXJ5KCk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAg\nICAgICAgICBjYXNlIFFVRVJZX0hJTlQ6CiAgICAgICAgICAgICAgICAgICAg\nZW5kUXVlcnlIaW50KCk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAg\nICAgICAgICAgICAgICBjYXNlIE5BVElWRV9RVUVSWToKICAgICAgICAgICAg\nICAgICAgICBlbmROYW1lZE5hdGl2ZVF1ZXJ5KCk7CiAgICAgICAgICAgICAg\nICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIFFVRVJZX1NUUklO\nRzoKICAgICAgICAgICAgICAgICAgICBlbmRRdWVyeVN0cmluZygpOwogICAg\nICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSBT\nRVFfR0VORVJBVE9SOgogICAgICAgICAgICAgICAgICAgIGVuZFNlcXVlbmNl\nR2VuZXJhdG9yKCk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAg\nICAgICAgIH0KICAgICAgICB9IGVsc2UgaWYgKHRhZyA9PSBFTEVNX0FDQ0VT\nUykKICAgICAgICAgICAgZW5kQWNjZXNzKCk7CiAgICAgICAgZWxzZSBpZiAo\ndGFnID09IEVMRU1fTElTVEVORVIpCiAgICAgICAgICAgIGVuZEVudGl0eUxp\nc3RlbmVyKCk7CgogICAgICAgIF9wYXJlbnRzLnBvcCgpOwogICAgfQoKICAg\nIC8qKgogICAgICogSW1wbGVtZW50IHRvIHBhcnNlIGEgbWFwcGluZyBlbGVt\nZW50IG91dHNpZGUgb2YgYW55IGNsYXNzLgogICAgICoKICAgICAqIEByZXR1\ncm4gdGhlIHRhZyBmb3IgdGhlIGdpdmVuIGVsZW1lbnQsIG9yIG51bGwgdG8g\nc2tpcCB0aGUgZWxlbWVudAogICAgICovCiAgICBwcm90ZWN0ZWQgT2JqZWN0\nIHN0YXJ0U3lzdGVtTWFwcGluZ0VsZW1lbnQoU3RyaW5nIG5hbWUsIEF0dHJp\nYnV0ZXMgYXR0cnMpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAg\nICAgICAgcmV0dXJuIG51bGw7CiAgICB9CgogICAgLyoqCiAgICAgKiBJbXBs\nZW1lbnQgdG8gcGFyc2UgYSBtYXBwaW5nIGVsZW1lbnQgb3V0c2lkZSBvZiBh\nbnkgY2xhc3MuCiAgICAgKi8KICAgIHByb3RlY3RlZCB2b2lkIGVuZFN5c3Rl\nbU1hcHBpbmdFbGVtZW50KFN0cmluZyBuYW1lKQogICAgICAgIHRocm93cyBT\nQVhFeGNlcHRpb24gewogICAgfQoKICAgIEBPdmVycmlkZQogICAgcHJvdGVj\ndGVkIGJvb2xlYW4gc3RhcnRDbGFzc0VsZW1lbnQoU3RyaW5nIG5hbWUsIEF0\ndHJpYnV0ZXMgYXR0cnMpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7\nCiAgICAgICAgT2JqZWN0IHRhZyA9IChPYmplY3QpIF9lbGVtcy5nZXQobmFt\nZSk7CiAgICAgICAgYm9vbGVhbiByZXQgPSBmYWxzZTsKICAgICAgICBpZiAo\ndGFnID09IG51bGwpIHsKICAgICAgICAgICAgaWYgKGlzTWFwcGluZ092ZXJy\naWRlTW9kZSgpKQogICAgICAgICAgICAgICAgdGFnID0gc3RhcnRDbGFzc01h\ncHBpbmdFbGVtZW50KG5hbWUsIGF0dHJzKTsKICAgICAgICAgICAgcmV0ID0g\ndGFnICE9IG51bGw7CiAgICAgICAgfSBlbHNlIGlmICh0YWcgaW5zdGFuY2Vv\nZiBNZXRhRGF0YVRhZykgewogICAgICAgICAgICBzd2l0Y2ggKChNZXRhRGF0\nYVRhZykgdGFnKSB7CiAgICAgICAgICAgICAgICBjYXNlIEdFTkVSQVRFRF9W\nQUxVRToKICAgICAgICAgICAgICAgICAgICByZXQgPSBzdGFydEdlbmVyYXRl\nZFZhbHVlKGF0dHJzKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAg\nICAgICAgICAgICAgIGNhc2UgSUQ6CiAgICAgICAgICAgICAgICAgICAgcmV0\nID0gc3RhcnRJZChhdHRycyk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7\nCiAgICAgICAgICAgICAgICBjYXNlIEVNQkVEREVEX0lEOgogICAgICAgICAg\nICAgICAgICAgIHJldCA9IHN0YXJ0RW1iZWRkZWRJZChhdHRycyk7CiAgICAg\nICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIElE\nX0NMQVNTOgogICAgICAgICAgICAgICAgICAgIHJldCA9IHN0YXJ0SWRDbGFz\ncyhhdHRycyk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAg\nICAgICAgICBjYXNlIExPQjoKICAgICAgICAgICAgICAgICAgICByZXQgPSBz\ndGFydExvYihhdHRycyk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAg\nICAgICAgICAgICAgICBjYXNlIFFVRVJZOgogICAgICAgICAgICAgICAgICAg\nIHJldCA9IHN0YXJ0TmFtZWRRdWVyeShhdHRycyk7CiAgICAgICAgICAgICAg\nICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIFFVRVJZX0hJTlQ6\nCiAgICAgICAgICAgICAgICAgICAgcmV0ID0gc3RhcnRRdWVyeUhpbnQoYXR0\ncnMpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAg\nICAgY2FzZSBOQVRJVkVfUVVFUlk6CiAgICAgICAgICAgICAgICAgICAgcmV0\nID0gc3RhcnROYW1lZE5hdGl2ZVF1ZXJ5KGF0dHJzKTsKICAgICAgICAgICAg\nICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgUVVFUllfU1RS\nSU5HOgogICAgICAgICAgICAgICAgICAgIHJldCA9IHN0YXJ0UXVlcnlTdHJp\nbmcoYXR0cnMpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAg\nICAgICAgICAgY2FzZSBTRVFfR0VORVJBVE9SOgogICAgICAgICAgICAgICAg\nICAgIHJldCA9IHN0YXJ0U2VxdWVuY2VHZW5lcmF0b3IoYXR0cnMpOwogICAg\nICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSBW\nRVJTSU9OOgogICAgICAgICAgICAgICAgICAgIHJldCA9IHN0YXJ0VmVyc2lv\nbihhdHRycyk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAg\nICAgICAgICBjYXNlIE1BUF9LRVk6CiAgICAgICAgICAgICAgICAgICAgcmV0\nID0gc3RhcnRNYXBLZXkoYXR0cnMpOwogICAgICAgICAgICAgICAgICAgIGJy\nZWFrOwogICAgICAgICAgICAgICAgY2FzZSBGTFVTSF9NT0RFOgogICAgICAg\nICAgICAgICAgICAgIHJldCA9IHN0YXJ0Rmx1c2hNb2RlKGF0dHJzKTsKICAg\nICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2Ug\nT1JERVJfQlk6CiAgICAgICAgICAgICAgICBjYXNlIEVOVElUWV9MSVNURU5F\nUlM6CiAgICAgICAgICAgICAgICAgICAgcmV0ID0gaXNNZXRhRGF0YU1vZGUo\nKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAg\nIGNhc2UgRVhDTFVERV9ERUZBVUxUX0xJU1RFTkVSUzoKICAgICAgICAgICAg\nICAgICAgICByZXQgPSBzdGFydEV4Y2x1ZGVEZWZhdWx0TGlzdGVuZXJzKGF0\ndHJzKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAg\nICAgIGNhc2UgRVhDTFVERV9TVVBFUkNMQVNTX0xJU1RFTkVSUzoKICAgICAg\nICAgICAgICAgICAgICByZXQgPSBzdGFydEV4Y2x1ZGVTdXBlcmNsYXNzTGlz\ndGVuZXJzKGF0dHJzKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAg\nICAgICAgICAgICAgIGNhc2UgUFJFX1BFUlNJU1Q6CiAgICAgICAgICAgICAg\nICBjYXNlIFBPU1RfUEVSU0lTVDoKICAgICAgICAgICAgICAgIGNhc2UgUFJF\nX1JFTU9WRToKICAgICAgICAgICAgICAgIGNhc2UgUE9TVF9SRU1PVkU6CiAg\nICAgICAgICAgICAgICBjYXNlIFBSRV9VUERBVEU6CiAgICAgICAgICAgICAg\nICBjYXNlIFBPU1RfVVBEQVRFOgogICAgICAgICAgICAgICAgY2FzZSBQT1NU\nX0xPQUQ6CiAgICAgICAgICAgICAgICAgICAgcmV0ID0gc3RhcnRDYWxsYmFj\naygoTWV0YURhdGFUYWcpIHRhZywgYXR0cnMpOwogICAgICAgICAgICAgICAg\nICAgIGJyZWFrOwogICAgICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAg\nICAgICAgICAgICB3YXJuVW5zdXBwb3J0ZWRUYWcobmFtZSk7CiAgICAgICAg\nICAgIH0KICAgICAgICB9IGVsc2UgaWYgKHRhZyBpbnN0YW5jZW9mIFBlcnNp\nc3RlbmNlU3RyYXRlZ3kpIHsKICAgICAgICAgICAgUGVyc2lzdGVuY2VTdHJh\ndGVneSBwcyA9IChQZXJzaXN0ZW5jZVN0cmF0ZWd5KSB0YWc7CiAgICAgICAg\nICAgIHJldCA9IHN0YXJ0U3RyYXRlZ3kocHMsIGF0dHJzKTsKICAgICAgICAg\nICAgaWYgKHJldCkKICAgICAgICAgICAgICAgIF9zdHJhdGVneSA9IHBzOwog\nICAgICAgIH0gZWxzZSBpZiAodGFnID09IEVMRU1fTElTVEVORVIpCiAgICAg\nICAgICAgIHJldCA9IHN0YXJ0RW50aXR5TGlzdGVuZXIoYXR0cnMpOwogICAg\nICAgIGVsc2UgaWYgKHRhZyA9PSBFTEVNX0FUVFJTKQogICAgICAgICAgICBy\nZXQgPSBfbW9kZSAhPSBNT0RFX1FVRVJZOwogICAgICAgIGVsc2UgaWYgKHRh\nZyA9PSBFTEVNX0NBU0NBREUpCiAgICAgICAgICAgIHJldCA9IGlzTWV0YURh\ndGFNb2RlKCk7CiAgICAgICAgZWxzZSBpZiAodGFnID09IEVMRU1fQ0FTQ0FE\nRV9BTEwgfHwgdGFnID09IEVMRU1fQ0FTQ0FERV9QRVIKICAgICAgICAgICAg\nfHwgdGFnID09IEVMRU1fQ0FTQ0FERV9NRVIgfHwgdGFnID09IEVMRU1fQ0FT\nQ0FERV9SRU0KICAgICAgICAgICAgfHwgdGFnID09IEVMRU1fQ0FTQ0FERV9S\nRUYpCiAgICAgICAgICAgIHJldCA9IHN0YXJ0Q2FzY2FkZSh0YWcsIGF0dHJz\nKTsKCiAgICAgICAgaWYgKHJldCkKICAgICAgICAgICAgX3BhcmVudHMucHVz\naCh0YWcpOwogICAgICAgIHJldHVybiByZXQ7CiAgICB9CgogICAgQE92ZXJy\naWRlCiAgICBwcm90ZWN0ZWQgdm9pZCBlbmRDbGFzc0VsZW1lbnQoU3RyaW5n\nIG5hbWUpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAg\nT2JqZWN0IHRhZyA9IF9lbGVtcy5nZXQobmFtZSk7CiAgICAgICAgaWYgKHRh\nZyA9PSBudWxsICYmIGlzTWFwcGluZ092ZXJyaWRlTW9kZSgpKQogICAgICAg\nICAgICBlbmRDbGFzc01hcHBpbmdFbGVtZW50KG5hbWUpOwogICAgICAgIGVs\nc2UgaWYgKHRhZyBpbnN0YW5jZW9mIE1ldGFEYXRhVGFnKSB7CiAgICAgICAg\nICAgIHN3aXRjaCAoKE1ldGFEYXRhVGFnKSB0YWcpIHsKICAgICAgICAgICAg\nICAgIGNhc2UgR0VORVJBVEVEX1ZBTFVFOgogICAgICAgICAgICAgICAgICAg\nIGVuZEdlbmVyYXRlZFZhbHVlKCk7CiAgICAgICAgICAgICAgICAgICAgYnJl\nYWs7CiAgICAgICAgICAgICAgICBjYXNlIElEOgogICAgICAgICAgICAgICAg\nICAgIGVuZElkKCk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAg\nICAgICAgICAgICBjYXNlIEVNQkVEREVEX0lEOgogICAgICAgICAgICAgICAg\nICAgIGVuZEVtYmVkZGVkSWQoKTsKICAgICAgICAgICAgICAgICAgICBicmVh\nazsKICAgICAgICAgICAgICAgIGNhc2UgSURfQ0xBU1M6CiAgICAgICAgICAg\nICAgICAgICAgZW5kSWRDbGFzcygpOwogICAgICAgICAgICAgICAgICAgIGJy\nZWFrOwogICAgICAgICAgICAgICAgY2FzZSBMT0I6CiAgICAgICAgICAgICAg\nICAgICAgZW5kTG9iKCk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAg\nICAgICAgICAgICAgICBjYXNlIFFVRVJZOgogICAgICAgICAgICAgICAgICAg\nIGVuZE5hbWVkUXVlcnkoKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsK\nICAgICAgICAgICAgICAgIGNhc2UgUVVFUllfSElOVDoKICAgICAgICAgICAg\nICAgICAgICBlbmRRdWVyeUhpbnQoKTsKICAgICAgICAgICAgICAgICAgICBi\ncmVhazsKICAgICAgICAgICAgICAgIGNhc2UgTkFUSVZFX1FVRVJZOgogICAg\nICAgICAgICAgICAgICAgIGVuZE5hbWVkTmF0aXZlUXVlcnkoKTsKICAgICAg\nICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgUVVF\nUllfU1RSSU5HOgogICAgICAgICAgICAgICAgICAgIGVuZFF1ZXJ5U3RyaW5n\nKCk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAg\nICBjYXNlIFNFUV9HRU5FUkFUT1I6CiAgICAgICAgICAgICAgICAgICAgZW5k\nU2VxdWVuY2VHZW5lcmF0b3IoKTsKICAgICAgICAgICAgICAgICAgICBicmVh\nazsKICAgICAgICAgICAgICAgIGNhc2UgVkVSU0lPTjoKICAgICAgICAgICAg\nICAgICAgICBlbmRWZXJzaW9uKCk7CiAgICAgICAgICAgICAgICAgICAgYnJl\nYWs7CiAgICAgICAgICAgICAgICBjYXNlIE9SREVSX0JZOgogICAgICAgICAg\nICAgICAgICAgIGVuZE9yZGVyQnkoKTsKICAgICAgICAgICAgICAgICAgICBi\ncmVhazsKICAgICAgICAgICAgfQogICAgICAgIH0gZWxzZSBpZiAodGFnIGlu\nc3RhbmNlb2YgUGVyc2lzdGVuY2VTdHJhdGVneSkKICAgICAgICAgICAgZW5k\nU3RyYXRlZ3koKFBlcnNpc3RlbmNlU3RyYXRlZ3kpIHRhZyk7CiAgICAgICAg\nZWxzZSBpZiAodGFnID09IEVMRU1fQUNDRVNTKQogICAgICAgICAgICBlbmRB\nY2Nlc3MoKTsKICAgICAgICBlbHNlIGlmICh0YWcgPT0gRUxFTV9MSVNURU5F\nUikKICAgICAgICAgICAgZW5kRW50aXR5TGlzdGVuZXIoKTsKCiAgICAgICAg\nX3BhcmVudHMucG9wKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBMb2cgd2Fy\nbmluZyBhYm91dCBhbiB1bnN1cHBvcnRlZCB0YWcuCiAgICAgKi8KICAgIHBy\naXZhdGUgdm9pZCB3YXJuVW5zdXBwb3J0ZWRUYWcoU3RyaW5nIG5hbWUpIHsK\nICAgICAgICBMb2cgbG9nID0gZ2V0TG9nKCk7CiAgICAgICAgaWYgKGxvZy5p\nc0luZm9FbmFibGVkKCkpCiAgICAgICAgICAgIGxvZy50cmFjZShfbG9jLmdl\ndCgidW5zdXBwb3J0ZWQtdGFnIiwgbmFtZSkpOwogICAgfQoKICAgIC8qKgog\nICAgICogSW1wbGVtZW50IHRvIHBhcnNlIGEgbWFwcGluZyBlbGVtZW50IHdp\ndGhpbiBhIGNsYXNzLgogICAgICoKICAgICAqIEByZXR1cm4gdGhlIHRhZyBm\nb3IgdGhlIGdpdmVuIGVsZW1lbnQsIG9yIG51bGwgdG8gc2tpcCBlbGVtZW50\nCiAgICAgKi8KICAgIHByb3RlY3RlZCBPYmplY3Qgc3RhcnRDbGFzc01hcHBp\nbmdFbGVtZW50KFN0cmluZyBuYW1lLCBBdHRyaWJ1dGVzIGF0dHJzKQogICAg\nICAgIHRocm93cyBTQVhFeGNlcHRpb24gewogICAgICAgIHJldHVybiBudWxs\nOwogICAgfQoKICAgIC8qKgogICAgICogSW1wbGVtZW50IHRvIHBhcnNlIGEg\nbWFwcGluZyBlbGVtZW50IHdpdGhpbiBhIGNsYXNzLgogICAgICovCiAgICBw\ncm90ZWN0ZWQgdm9pZCBlbmRDbGFzc01hcHBpbmdFbGVtZW50KFN0cmluZyBu\nYW1lKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24gewogICAgfQoKICAg\nIEBPdmVycmlkZQogICAgcHJvdGVjdGVkIGJvb2xlYW4gc3RhcnRDbGFzcyhT\ndHJpbmcgZWxlbSwgQXR0cmlidXRlcyBhdHRycykKICAgICAgICB0aHJvd3Mg\nU0FYRXhjZXB0aW9uIHsKICAgICAgICBzdXBlci5zdGFydENsYXNzKGVsZW0s\nIGF0dHJzKTsKCiAgICAgICAgLy8gcXVlcnkgbW9kZSBvbmx5PwogICAgICAg\nIF9jbHMgPSBjbGFzc0Zvck5hbWUoY3VycmVudENsYXNzTmFtZSgpKTsKICAg\nICAgICBpZiAoX21vZGUgPT0gTU9ERV9RVUVSWSkgewogICAgICAgICAgICBp\nZiAoX3BhcnNlciAhPSBudWxsICYmCiAgICAgICAgICAgICAgICAhInRydWUi\nLmVxdWFscyhhdHRycy5nZXRWYWx1ZSgibWV0YWRhdGEtY29tcGxldGUiKSkp\nCiAgICAgICAgICAgICAgICBfcGFyc2VyLnBhcnNlKF9jbHMpOwogICAgICAg\nICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CgogICAgICAgIExvZyBsb2cg\nPSBnZXRMb2coKTsKICAgICAgICBpZiAobG9nLmlzVHJhY2VFbmFibGVkKCkp\nCiAgICAgICAgICAgIGxvZy50cmFjZShfbG9jLmdldCgicGFyc2UtY2xhc3Mi\nLCBfY2xzLmdldE5hbWUoKSkpOwoKICAgICAgICBNZXRhRGF0YVJlcG9zaXRv\ncnkgcmVwb3MgPSBnZXRSZXBvc2l0b3J5KCk7CiAgICAgICAgQ2xhc3NNZXRh\nRGF0YSBtZXRhID0gcmVwb3MuZ2V0Q2FjaGVkTWV0YURhdGEoX2Nscyk7CiAg\nICAgICAgaWYgKG1ldGEgIT0gbnVsbAogICAgICAgICAgICAmJiAoKGlzTWV0\nYURhdGFNb2RlKCkgJiYgKG1ldGEuZ2V0U291cmNlTW9kZSgpICYgTU9ERV9N\nRVRBKSAhPSAwKQogICAgICAgICAgICB8fCAoaXNNYXBwaW5nTW9kZSgpICYm\nIChtZXRhLmdldFNvdXJjZU1vZGUoKSAmIE1PREVfTUFQUElORykgIT0gMCkp\nKQogICAgICAgIHsKICAgICAgICAgICAgaWYgKGxvZy5pc1dhcm5FbmFibGVk\nKCkpCiAgICAgICAgICAgICAgICBsb2cud2FybihfbG9jLmdldCgiZHVwLW1l\ndGFkYXRhIiwgX2NscywgZ2V0U291cmNlTmFtZSgpKSk7CiAgICAgICAgICAg\nIF9jbHMgPSBudWxsOwogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAg\nICAgfQoKICAgICAgICAvLyBpZiB3ZSBkb24ndCBrbm93IHRoZSBhY2Nlc3Mg\ndHlwZSwgY2hlY2sgdG8gc2VlIGlmIGEgc3VwZXJjbGFzcwogICAgICAgIC8v\nIGhhcyBhbHJlYWR5IGRlZmluZWQgdGhlIGFjY2VzcyB0eXBlCiAgICAgICAg\naW50IGRlZmF1bHRBY2Nlc3MgPSBfYWNjZXNzOwogICAgICAgIGlmIChkZWZh\ndWx0QWNjZXNzID09IENsYXNzTWV0YURhdGEuQUNDRVNTX1VOS05PV04pIHsK\nICAgICAgICAgICAgQ2xhc3NNZXRhRGF0YSBzdXAgPSByZXBvcy5nZXRDYWNo\nZWRNZXRhRGF0YShfY2xzLmdldFN1cGVyY2xhc3MoKSk7CiAgICAgICAgICAg\nIGlmIChzdXAgIT0gbnVsbCkKICAgICAgICAgICAgICAgIGRlZmF1bHRBY2Nl\nc3MgPSBzdXAuZ2V0QWNjZXNzVHlwZSgpOwogICAgICAgIH0KCiAgICAgICAg\naWYgKG1ldGEgPT0gbnVsbCkgewogICAgICAgICAgICAvLyBhZGQgbWV0YWRh\ndGEgZm9yIHRoaXMgdHlwZQogICAgICAgICAgICBpbnQgYWNjZXNzID0gdG9B\nY2Nlc3NUeXBlKGF0dHJzLmdldFZhbHVlKCJhY2Nlc3MiKSwgZGVmYXVsdEFj\nY2Vzcyk7CiAgICAgICAgICAgIG1ldGEgPSByZXBvcy5hZGRNZXRhRGF0YShf\nY2xzLCBhY2Nlc3MpOwogICAgICAgICAgICBtZXRhLnNldEVudkNsYXNzTG9h\nZGVyKF9lbnZMb2FkZXIpOwogICAgICAgICAgICBtZXRhLnNldFNvdXJjZU1v\nZGUoTU9ERV9OT05FKTsKCiAgICAgICAgICAgIC8vIHBhcnNlIGFubm90YXRp\nb25zIGZpcnN0IHNvIFhNTCBvdmVycmlkZXMgdGhlbQogICAgICAgICAgICBp\nZiAoX3BhcnNlciAhPSBudWxsICYmCiAgICAgICAgICAgICAgICAhInRydWUi\nLmVxdWFscyhhdHRycy5nZXRWYWx1ZSgibWV0YWRhdGEtY29tcGxldGUiKSkp\nCiAgICAgICAgICAgICAgICBfcGFyc2VyLnBhcnNlKF9jbHMpOwogICAgICAg\nIH0KCiAgICAgICAgYm9vbGVhbiBtYXBwZWRTdXBlciA9ICJtYXBwZWQtc3Vw\nZXJjbGFzcyIuZXF1YWxzKGVsZW0pOwogICAgICAgIGlmIChpc01ldGFEYXRh\nTW9kZSgpKSB7CiAgICAgICAgICAgIG1ldGEuc2V0U291cmNlKGdldFNvdXJj\nZUZpbGUoKSwgbWV0YS5TUkNfWE1MKTsKICAgICAgICAgICAgbWV0YS5zZXRT\nb3VyY2VNb2RlKE1PREVfTUVUQSwgdHJ1ZSk7CiAgICAgICAgICAgIG1ldGEu\nc2V0TGlzdGluZ0luZGV4KF9jbHNQb3MpOwogICAgICAgICAgICBTdHJpbmcg\nbmFtZSA9IGF0dHJzLmdldFZhbHVlKCJuYW1lIik7CiAgICAgICAgICAgIGlm\nICghU3RyaW5nVXRpbHMuaXNFbXB0eShuYW1lKSkKICAgICAgICAgICAgICAg\nIG1ldGEuc2V0VHlwZUFsaWFzKG5hbWUpOwogICAgICAgICAgICBtZXRhLnNl\ndEVtYmVkZGVkT25seShtYXBwZWRTdXBlciB8fCAiZW1iZWRkYWJsZSIuZXF1\nYWxzKGVsZW0pKTsKICAgICAgICAgICAgaWYgKG1hcHBlZFN1cGVyKQogICAg\nICAgICAgICAgICAgbWV0YS5zZXRJZGVudGl0eVR5cGUobWV0YS5JRF9VTktO\nT1dOKTsKICAgICAgICB9CiAgICAgICAgaWYgKGlzTWFwcGluZ01vZGUoKSkK\nICAgICAgICAgICAgbWV0YS5zZXRTb3VyY2VNb2RlKE1PREVfTUFQUElORywg\ndHJ1ZSk7CiAgICAgICAgaWYgKGlzTWFwcGluZ092ZXJyaWRlTW9kZSgpKQog\nICAgICAgICAgICBzdGFydENsYXNzTWFwcGluZyhtZXRhLCBtYXBwZWRTdXBl\nciwgYXR0cnMpOwogICAgICAgIGlmIChpc1F1ZXJ5TW9kZSgpKQogICAgICAg\nICAgICBtZXRhLnNldFNvdXJjZU1vZGUoTU9ERV9RVUVSWSwgdHJ1ZSk7Cgog\nICAgICAgIF9jbHNQb3MrKzsKICAgICAgICBfZmllbGRQb3MgPSAwOwogICAg\nICAgIGFkZENvbW1lbnRzKG1ldGEpOwogICAgICAgIHB1c2hFbGVtZW50KG1l\ndGEpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIEBPdmVycmlk\nZQogICAgcHJvdGVjdGVkIHZvaWQgZW5kQ2xhc3MoU3RyaW5nIGVsZW0pCiAg\nICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgaWYgKF9tb2Rl\nICE9IE1PREVfUVVFUlkpIHsKICAgICAgICAgICAgQ2xhc3NNZXRhRGF0YSBt\nZXRhID0gKENsYXNzTWV0YURhdGEpIHBvcEVsZW1lbnQoKTsKICAgICAgICAg\nICAgc3RvcmVDYWxsYmFja3MobWV0YSk7CiAgICAgICAgICAgIGlmIChpc01h\ncHBpbmdPdmVycmlkZU1vZGUoKSkKICAgICAgICAgICAgICAgIGVuZENsYXNz\nTWFwcGluZyhtZXRhKTsKICAgICAgICB9CiAgICAgICAgX2NscyA9IG51bGw7\nCiAgICAgICAgc3VwZXIuZW5kQ2xhc3MoZWxlbSk7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBJbXBsZW1lbnQgdG8gYWRkIG1hcHBpbmcgYXR0cmlidXRlcyB0\nbyBjbGFzcy4KICAgICAqLwogICAgcHJvdGVjdGVkIHZvaWQgc3RhcnRDbGFz\nc01hcHBpbmcoQ2xhc3NNZXRhRGF0YSBtYXBwaW5nLAogICAgICAgIGJvb2xl\nYW4gbWFwcGVkU3VwZXIsIEF0dHJpYnV0ZXMgYXR0cnMpCiAgICAgICAgdGhy\nb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICB9CgogICAgLyoqCiAgICAgKiBJbXBs\nZW1lbnQgdG8gZmluYWxpemUgY2xhc3MgbWFwcGluZy4KICAgICAqLwogICAg\ncHJvdGVjdGVkIHZvaWQgZW5kQ2xhc3NNYXBwaW5nKENsYXNzTWV0YURhdGEg\nbWFwcGluZykKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgIH0K\nCiAgICAvKioKICAgICAqIERlZmF1bHQgYWNjZXNzIGVsZW1lbnQuCiAgICAg\nKi8KICAgIHByaXZhdGUgdm9pZCBlbmRBY2Nlc3MoKSB7CiAgICAgICAgX2Fj\nY2VzcyA9IHRvQWNjZXNzVHlwZShjdXJyZW50VGV4dCgpLCBDbGFzc01ldGFE\nYXRhLkFDQ0VTU19VTktOT1dOKTsKICAgIH0KCiAgICAvKioKICAgICAqIFBh\ncnNlIHRoZSBnaXZlbiBzdHJpbmcgYXMgYW4gZW50aXR5IGFjY2VzcyB0eXBl\nLCBkZWZhdWx0aW5nIHRvIGdpdmVuCiAgICAgKiBkZWZhdWx0IGlmIHN0cmlu\nZyBpcyBlbXB0eS4KICAgICAqLwogICAgcHJpdmF0ZSBpbnQgdG9BY2Nlc3NU\neXBlKFN0cmluZyBzdHIsIGludCBkZWYpIHsKICAgICAgICBpZiAoU3RyaW5n\nVXRpbHMuaXNFbXB0eShzdHIpKQogICAgICAgICAgICByZXR1cm4gZGVmOwog\nICAgICAgIGlmICgiUFJPUEVSVFkiLmVxdWFscyhzdHIpKQogICAgICAgICAg\nICByZXR1cm4gQ2xhc3NNZXRhRGF0YS5BQ0NFU1NfUFJPUEVSVFk7CiAgICAg\nICAgcmV0dXJuIENsYXNzTWV0YURhdGEuQUNDRVNTX0ZJRUxEOwogICAgfQoK\nICAgIC8qKgogICAgICogUGFyc2UgZmx1c2gtbW9kZSBlbGVtZW50LgogICAg\nICovCiAgICBwcml2YXRlIGJvb2xlYW4gc3RhcnRGbHVzaE1vZGUoQXR0cmli\ndXRlcyBhdHRycykKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAg\nICAgICBMb2cgbG9nID0gZ2V0TG9nKCk7CiAgICAgICAgaWYgKGxvZy5pc1dh\ncm5FbmFibGVkKCkpCiAgICAgICAgICAgIGxvZy53YXJuKF9sb2MuZ2V0KCJ1\nbnN1cHBvcnRlZCIsICJmbHVzaC1tb2RlIiwgZ2V0U291cmNlTmFtZSgpKSk7\nCiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIC8qKgogICAgICog\nUGFyc2Ugc2VxdWVuY2UtZ2VuZXJhdG9yLgogICAgICovCiAgICBwcm90ZWN0\nZWQgYm9vbGVhbiBzdGFydFNlcXVlbmNlR2VuZXJhdG9yKEF0dHJpYnV0ZXMg\nYXR0cnMpIHsKICAgICAgICBpZiAoIWlzTWFwcGluZ092ZXJyaWRlTW9kZSgp\nKQogICAgICAgICAgICByZXR1cm4gZmFsc2U7CgogICAgICAgIFN0cmluZyBu\nYW1lID0gYXR0cnMuZ2V0VmFsdWUoIm5hbWUiKTsKICAgICAgICBMb2cgbG9n\nID0gZ2V0TG9nKCk7CiAgICAgICAgaWYgKGxvZy5pc1RyYWNlRW5hYmxlZCgp\nKQogICAgICAgICAgICBsb2cudHJhY2UoX2xvYy5nZXQoInBhcnNlLXNlcXVl\nbmNlIiwgbmFtZSkpOwoKICAgICAgICBTZXF1ZW5jZU1ldGFEYXRhIG1ldGEg\nPSBnZXRSZXBvc2l0b3J5KCkuZ2V0Q2FjaGVkU2VxdWVuY2VNZXRhRGF0YShu\nYW1lKTsKICAgICAgICBpZiAobWV0YSAhPSBudWxsICYmIGxvZy5pc1dhcm5F\nbmFibGVkKCkpCiAgICAgICAgICAgIGxvZy53YXJuKF9sb2MuZ2V0KCJvdmVy\ncmlkZS1zZXF1ZW5jZSIsIG5hbWUpKTsKCiAgICAgICAgbWV0YSA9IGdldFJl\ncG9zaXRvcnkoKS5hZGRTZXF1ZW5jZU1ldGFEYXRhKG5hbWUpOwogICAgICAg\nIFN0cmluZyBzZXEgPSBhdHRycy5nZXRWYWx1ZSgic2VxdWVuY2UtbmFtZSIp\nOwogICAgICAgIFN0cmluZyB2YWwgPSBhdHRycy5nZXRWYWx1ZSgiaW5pdGlh\nbC12YWx1ZSIpOwogICAgICAgIGludCBpbml0aWFsID0gdmFsID09IG51bGwg\nPyAxIDogSW50ZWdlci5wYXJzZUludCh2YWwpOwogICAgICAgIHZhbCA9IGF0\ndHJzLmdldFZhbHVlKCJhbGxvY2F0aW9uLXNpemUiKTsKICAgICAgICBpbnQg\nYWxsb2NhdGUgPSB2YWwgPT0gbnVsbCA/IDUwIDogSW50ZWdlci5wYXJzZUlu\ndCh2YWwpOwoKICAgICAgICBTdHJpbmcgY2xzTmFtZSwgcHJvcHM7CiAgICAg\nICAgaWYgKHNlcSA9PSBudWxsIHx8IHNlcS5pbmRleE9mKCcoJykgPT0gLTEp\nIHsKICAgICAgICAgICAgY2xzTmFtZSA9IFNlcXVlbmNlTWV0YURhdGEuSU1Q\nTF9OQVRJVkU7CiAgICAgICAgICAgIHByb3BzID0gbnVsbDsKICAgICAgICB9\nIGVsc2UgeyAvLyBwbHVnaW4KICAgICAgICAgICAgY2xzTmFtZSA9IENvbmZp\nZ3VyYXRpb25zLmdldENsYXNzTmFtZShzZXEpOwogICAgICAgICAgICBwcm9w\ncyA9IENvbmZpZ3VyYXRpb25zLmdldFByb3BlcnRpZXMoc2VxKTsKICAgICAg\nICAgICAgc2VxID0gbnVsbDsKICAgICAgICB9CgogICAgICAgIG1ldGEuc2V0\nU2VxdWVuY2VQbHVnaW4oQ29uZmlndXJhdGlvbnMuZ2V0UGx1Z2luKGNsc05h\nbWUsIHByb3BzKSk7CiAgICAgICAgbWV0YS5zZXRTZXF1ZW5jZShzZXEpOwog\nICAgICAgIG1ldGEuc2V0SW5pdGlhbFZhbHVlKGluaXRpYWwpOwogICAgICAg\nIG1ldGEuc2V0QWxsb2NhdGUoYWxsb2NhdGUpOwoKICAgICAgICBPYmplY3Qg\nY3VyID0gY3VycmVudEVsZW1lbnQoKTsKICAgICAgICBPYmplY3Qgc2NvcGUg\nPSAoY3VyIGluc3RhbmNlb2YgQ2xhc3NNZXRhRGF0YSkKICAgICAgICAgICAg\nPyAoKENsYXNzTWV0YURhdGEpIGN1cikuZ2V0RGVzY3JpYmVkVHlwZSgpIDog\nbnVsbDsKICAgICAgICBtZXRhLnNldFNvdXJjZShnZXRTb3VyY2VGaWxlKCks\nIHNjb3BlLCBtZXRhLlNSQ19YTUwpOwogICAgICAgIHJldHVybiB0cnVlOwog\nICAgfQoKICAgIHByb3RlY3RlZCB2b2lkIGVuZFNlcXVlbmNlR2VuZXJhdG9y\nKCkgewogICAgfQoKICAgIC8qKgogICAgICogUGFyc2UgaWQuCiAgICAgKi8K\nICAgIHByb3RlY3RlZCBib29sZWFuIHN0YXJ0SWQoQXR0cmlidXRlcyBhdHRy\ncykKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICBGaWVs\nZE1ldGFEYXRhIGZtZCA9IHBhcnNlRmllbGQoYXR0cnMpOwogICAgICAgIGZt\nZC5zZXRFeHBsaWNpdCh0cnVlKTsKICAgICAgICBmbWQuc2V0UHJpbWFyeUtl\neSh0cnVlKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBwcm90\nZWN0ZWQgdm9pZCBlbmRJZCgpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlv\nbiB7CiAgICAgICAgZmluaXNoRmllbGQoKTsKICAgIH0KCiAgICAvKioKICAg\nICAqIFBhcnNlIGVtYmVkZGVkLWlkLgogICAgICovCiAgICBwcm90ZWN0ZWQg\nYm9vbGVhbiBzdGFydEVtYmVkZGVkSWQoQXR0cmlidXRlcyBhdHRycykKICAg\nICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICBGaWVsZE1ldGFE\nYXRhIGZtZCA9IHBhcnNlRmllbGQoYXR0cnMpOwogICAgICAgIGZtZC5zZXRF\neHBsaWNpdCh0cnVlKTsKICAgICAgICBmbWQuc2V0UHJpbWFyeUtleSh0cnVl\nKTsKICAgICAgICBmbWQuc2V0RW1iZWRkZWQodHJ1ZSk7CiAgICAgICAgaWYg\nKGZtZC5nZXRFbWJlZGRlZE1ldGFEYXRhKCkgPT0gbnVsbCkKICAgICAgICAg\nICAgZm1kLmFkZEVtYmVkZGVkTWV0YURhdGEoKTsKICAgICAgICByZXR1cm4g\ndHJ1ZTsKICAgIH0KCiAgICBwcm90ZWN0ZWQgdm9pZCBlbmRFbWJlZGRlZElk\nKCkKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICBmaW5p\nc2hGaWVsZCgpOwogICAgfQoKICAgIC8qKgogICAgICogUGFyc2UgaWQtY2xh\nc3MuCiAgICAgKi8KICAgIHByb3RlY3RlZCBib29sZWFuIHN0YXJ0SWRDbGFz\ncyhBdHRyaWJ1dGVzIGF0dHJzKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRp\nb24gewogICAgICAgIGlmICghaXNNZXRhRGF0YU1vZGUoKSkKICAgICAgICAg\nICAgcmV0dXJuIGZhbHNlOwoKICAgICAgICBDbGFzc01ldGFEYXRhIG1ldGEg\nPSAoQ2xhc3NNZXRhRGF0YSkgY3VycmVudEVsZW1lbnQoKTsKICAgICAgICBT\ndHJpbmcgY2xzID0gYXR0cnMuZ2V0VmFsdWUoImNsYXNzIik7CiAgICAgICAg\nQ2xhc3MgaWRDbHMgPSBudWxsOwogICAgICAgIHRyeSB7CiAgICAgICAgICAg\nIGlkQ2xzID0gY2xhc3NGb3JOYW1lKGNscyk7CiAgICAgICAgfSBjYXRjaCAo\nVGhyb3dhYmxlIHQpIHsKICAgICAgICAgICAgdGhyb3cgZ2V0RXhjZXB0aW9u\nKF9sb2MuZ2V0KCJpbnZhbGlkLWlkLWNsYXNzIiwgbWV0YSwgY2xzKSwgdCk7\nCiAgICAgICAgfQogICAgICAgIG1ldGEuc2V0T2JqZWN0SWRUeXBlKGlkQ2xz\nLCB0cnVlKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBwcm90\nZWN0ZWQgdm9pZCBlbmRJZENsYXNzKCkKICAgICAgICB0aHJvd3MgU0FYRXhj\nZXB0aW9uIHsKICAgIH0KCiAgICAvKioKICAgICAqIFBhcnNlIGxvYi4KICAg\nICAqLwogICAgcHJvdGVjdGVkIGJvb2xlYW4gc3RhcnRMb2IoQXR0cmlidXRl\ncyBhdHRycykKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAg\nICBGaWVsZE1ldGFEYXRhIGZtZCA9IChGaWVsZE1ldGFEYXRhKSBjdXJyZW50\nRWxlbWVudCgpOwogICAgICAgIGlmIChmbWQuZ2V0RGVjbGFyZWRUeXBlQ29k\nZSgpICE9IEphdmFUeXBlcy5TVFJJTkcKICAgICAgICAgICAgJiYgZm1kLmdl\ndERlY2xhcmVkVHlwZSgpICE9IGNoYXJbXS5jbGFzcwogICAgICAgICAgICAm\nJiBmbWQuZ2V0RGVjbGFyZWRUeXBlKCkgIT0gQ2hhcmFjdGVyW10uY2xhc3MK\nICAgICAgICAgICAgJiYgZm1kLmdldERlY2xhcmVkVHlwZSgpICE9IGJ5dGVb\nXS5jbGFzcwogICAgICAgICAgICAmJiBmbWQuZ2V0RGVjbGFyZWRUeXBlKCkg\nIT0gQnl0ZVtdLmNsYXNzKQogICAgICAgICAgICBmbWQuc2V0U2VyaWFsaXpl\nZCh0cnVlKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBwcm90\nZWN0ZWQgdm9pZCBlbmRMb2IoKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRp\nb24gewogICAgfQoKICAgIC8qKgogICAgICogUGFyc2UgZ2VuZXJhdGVkLXZh\nbHVlLgogICAgICovCiAgICBwcm90ZWN0ZWQgYm9vbGVhbiBzdGFydEdlbmVy\nYXRlZFZhbHVlKEF0dHJpYnV0ZXMgYXR0cnMpCiAgICAgICAgdGhyb3dzIFNB\nWEV4Y2VwdGlvbiB7CiAgICAgICAgaWYgKCFpc01hcHBpbmdPdmVycmlkZU1v\nZGUoKSkKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoKICAgICAgICBTdHJp\nbmcgc3RyYXRlZ3kgPSBhdHRycy5nZXRWYWx1ZSgic3RyYXRlZ3kiKTsKICAg\nICAgICBTdHJpbmcgZ2VuZXJhdG9yID0gYXR0cnMuZ2V0VmFsdWUoImdlbmVy\nYXRvciIpOwogICAgICAgIEdlbmVyYXRpb25UeXBlIHR5cGUgPSBTdHJpbmdV\ndGlscy5pc0VtcHR5KHN0cmF0ZWd5KQogICAgICAgICAgICA/IEdlbmVyYXRp\nb25UeXBlLkFVVE8gOiBHZW5lcmF0aW9uVHlwZS52YWx1ZU9mKHN0cmF0ZWd5\nKTsKCiAgICAgICAgRmllbGRNZXRhRGF0YSBmbWQgPSAoRmllbGRNZXRhRGF0\nYSkgY3VycmVudEVsZW1lbnQoKTsKICAgICAgICBBbm5vdGF0aW9uUGVyc2lz\ndGVuY2VNZXRhRGF0YVBhcnNlci5wYXJzZUdlbmVyYXRlZFZhbHVlKGZtZCwg\ndHlwZSwKICAgICAgICAgICAgZ2VuZXJhdG9yKTsKICAgICAgICByZXR1cm4g\ndHJ1ZTsKICAgIH0KCiAgICBwcm90ZWN0ZWQgdm9pZCBlbmRHZW5lcmF0ZWRW\nYWx1ZSgpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBMYXppbHkgcGFyc2UgY2FzY2FkZXMuCiAgICAgKi8K\nICAgIHByb3RlY3RlZCBib29sZWFuIHN0YXJ0Q2FzY2FkZShPYmplY3QgdGFn\nLCBBdHRyaWJ1dGVzIGF0dHJzKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRp\nb24gewogICAgICAgIGlmICghaXNNZXRhRGF0YU1vZGUoKSkKICAgICAgICAg\nICAgcmV0dXJuIGZhbHNlOwoKICAgICAgICBTZXQ8Q2FzY2FkZVR5cGU+IGNh\nc2NhZGVzID0gbnVsbDsKICAgICAgICBpZiAoY3VycmVudEVsZW1lbnQoKSBp\nbnN0YW5jZW9mIEZpZWxkTWV0YURhdGEpIHsKICAgICAgICAgICAgaWYgKF9j\nYXNjYWRlcyA9PSBudWxsKQogICAgICAgICAgICAgICAgX2Nhc2NhZGVzID0g\nRW51bVNldC5ub25lT2YoQ2FzY2FkZVR5cGUuY2xhc3MpOwogICAgICAgICAg\nICBjYXNjYWRlcyA9IF9jYXNjYWRlczsKICAgICAgICB9IGVsc2UgewogICAg\nICAgICAgICBpZiAoX3BrZ0Nhc2NhZGVzID09IG51bGwpCiAgICAgICAgICAg\nICAgICBfcGtnQ2FzY2FkZXMgPSBFbnVtU2V0Lm5vbmVPZihDYXNjYWRlVHlw\nZS5jbGFzcyk7CiAgICAgICAgICAgIGNhc2NhZGVzID0gX3BrZ0Nhc2NhZGVz\nOwogICAgICAgIH0KICAgICAgICBib29sZWFuIGFsbCA9IEVMRU1fQ0FTQ0FE\nRV9BTEwgPT0gdGFnOwogICAgICAgIGlmIChhbGwgfHwgRUxFTV9DQVNDQURF\nX1BFUiA9PSB0YWcpCiAgICAgICAgICAgIGNhc2NhZGVzLmFkZChQRVJTSVNU\nKTsKICAgICAgICBpZiAoYWxsIHx8IEVMRU1fQ0FTQ0FERV9SRU0gPT0gdGFn\nKQogICAgICAgICAgICBjYXNjYWRlcy5hZGQoUkVNT1ZFKTsKICAgICAgICBp\nZiAoYWxsIHx8IEVMRU1fQ0FTQ0FERV9NRVIgPT0gdGFnKQogICAgICAgICAg\nICBjYXNjYWRlcy5hZGQoTUVSR0UpOwogICAgICAgIGlmIChhbGwgfHwgRUxF\nTV9DQVNDQURFX1JFRiA9PSB0YWcpCiAgICAgICAgICAgIGNhc2NhZGVzLmFk\nZChSRUZSRVNIKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAv\nKioKICAgICAqIFNldCB0aGUgY2FjaGVkIGNhc2NhZGVzIGludG8gdGhlIGZp\nZWxkLgogICAgICovCiAgICBwcm90ZWN0ZWQgdm9pZCBzZXRDYXNjYWRlcyhG\naWVsZE1ldGFEYXRhIGZtZCkgewogICAgICAgIFNldDxDYXNjYWRlVHlwZT4g\nY2FzY2FkZXMgPSBfY2FzY2FkZXM7CiAgICAgICAgaWYgKF9jYXNjYWRlcyA9\nPSBudWxsKQogICAgICAgICAgICBjYXNjYWRlcyA9IF9wa2dDYXNjYWRlczsK\nICAgICAgICBpZiAoY2FzY2FkZXMgPT0gbnVsbCkKICAgICAgICAgICAgcmV0\ndXJuOwoKICAgICAgICBWYWx1ZU1ldGFEYXRhIHZtZCA9IGZtZDsKICAgICAg\nICBzd2l0Y2ggKF9zdHJhdGVneSkgewogICAgICAgICAgICBjYXNlIE9ORV9N\nQU5ZOgogICAgICAgICAgICBjYXNlIE1BTllfTUFOWToKICAgICAgICAgICAg\nICAgIHZtZCA9IGZtZC5nZXRFbGVtZW50KCk7CiAgICAgICAgfQogICAgICAg\nIGZvciAoQ2FzY2FkZVR5cGUgY2FzY2FkZSA6IGNhc2NhZGVzKSB7CiAgICAg\nICAgICAgIHN3aXRjaCAoY2FzY2FkZSkgewogICAgICAgICAgICAgICAgY2Fz\nZSBQRVJTSVNUOgogICAgICAgICAgICAgICAgICAgIHZtZC5zZXRDYXNjYWRl\nUGVyc2lzdChWYWx1ZU1ldGFEYXRhLkNBU0NBREVfSU1NRURJQVRFKTsKICAg\nICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2Ug\nTUVSR0U6CiAgICAgICAgICAgICAgICAgICAgdm1kLnNldENhc2NhZGVBdHRh\nY2goVmFsdWVNZXRhRGF0YS5DQVNDQURFX0lNTUVESUFURSk7CiAgICAgICAg\nICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIFJFTU9W\nRToKICAgICAgICAgICAgICAgICAgICB2bWQuc2V0Q2FzY2FkZURlbGV0ZShW\nYWx1ZU1ldGFEYXRhLkNBU0NBREVfSU1NRURJQVRFKTsKICAgICAgICAgICAg\nICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgUkVGUkVTSDoK\nICAgICAgICAgICAgICAgICAgICB2bWQuc2V0Q2FzY2FkZVJlZnJlc2goVmFs\ndWVNZXRhRGF0YS5DQVNDQURFX0lNTUVESUFURSk7CiAgICAgICAgICAgICAg\nICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAg\nX2Nhc2NhZGVzID0gbnVsbDsKICAgIH0KCiAgICAvKioKICAgICAqIFBhcnNl\nIGNvbW1vbiBmaWVsZCBhdHRyaWJ1dGVzLgogICAgICovCiAgICBwcml2YXRl\nIEZpZWxkTWV0YURhdGEgcGFyc2VGaWVsZChBdHRyaWJ1dGVzIGF0dHJzKQog\nICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24gewogICAgICAgIENsYXNzTWV0\nYURhdGEgbWV0YSA9IChDbGFzc01ldGFEYXRhKSBjdXJyZW50RWxlbWVudCgp\nOwogICAgICAgIFN0cmluZyBuYW1lID0gYXR0cnMuZ2V0VmFsdWUoIm5hbWUi\nKTsKICAgICAgICBGaWVsZE1ldGFEYXRhIGZpZWxkID0gbWV0YS5nZXREZWNs\nYXJlZEZpZWxkKG5hbWUpOwogICAgICAgIGlmICgoZmllbGQgPT0gbnVsbCB8\nfCBmaWVsZC5nZXREZWNsYXJlZFR5cGUoKSA9PSBPYmplY3QuY2xhc3MpCiAg\nICAgICAgICAgICYmIG1ldGEuZ2V0RGVzY3JpYmVkVHlwZSgpICE9IE9iamVj\ndC5jbGFzcykgewogICAgICAgICAgICBNZW1iZXIgbWVtYmVyID0gbnVsbDsK\nICAgICAgICAgICAgQ2xhc3MgdHlwZSA9IG51bGw7CiAgICAgICAgICAgIGlu\ndCBkZWYgPSBfcmVwb3MuZ2V0TWV0YURhdGFGYWN0b3J5KCkuZ2V0RGVmYXVs\ndHMoKS4KICAgICAgICAgICAgICAgIGdldERlZmF1bHRBY2Nlc3NUeXBlKCk7\nCiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBpZiAobWV0YS5n\nZXRBY2Nlc3NUeXBlKCkgPT0gQ2xhc3NNZXRhRGF0YS5BQ0NFU1NfUFJPUEVS\nVFkKICAgICAgICAgICAgICAgICAgICB8fCAobWV0YS5nZXRBY2Nlc3NUeXBl\nKCkgPT0gQ2xhc3NNZXRhRGF0YS5BQ0NFU1NfVU5LTk9XTgogICAgICAgICAg\nICAgICAgICAgICYmIGRlZiA9PSBDbGFzc01ldGFEYXRhLkFDQ0VTU19QUk9Q\nRVJUWSkpIHsKICAgICAgICAgICAgICAgICAgICBTdHJpbmcgY2FwID0gU3Ry\naW5nVXRpbHMuY2FwaXRhbGl6ZShuYW1lKTsKICAgICAgICAgICAgICAgICAg\nICB0eXBlID0gbWV0YS5nZXREZXNjcmliZWRUeXBlKCk7CiAgICAgICAgICAg\nICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICAgICAgbWVtYmVy\nID0gKE1ldGhvZCkgQWNjZXNzQ29udHJvbGxlci5kb1ByaXZpbGVnZWQoCiAg\nICAgICAgICAgICAgICAgICAgICAgICAgICBKMkRvUHJpdkhlbHBlci5nZXRE\nZWNsYXJlZE1ldGhvZEFjdGlvbigKICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICB0eXBlLCAiZ2V0IiArIGNhcCwKICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAoQ2xhc3NbXSkgbnVsbCkpOy8vIHZhcmFyZ3MgZGlz\nYW1iaWd1YXRlCiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoRXhjZXB0\naW9uIGV4Y2VwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7CiAg\nICAgICAgICAgICAgICAgICAgICAgICAgICBtZW1iZXIgPSAoTWV0aG9kKSBB\nY2Nlc3NDb250cm9sbGVyLmRvUHJpdmlsZWdlZCgKICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICBKMkRvUHJpdkhlbHBlci5nZXREZWNsYXJlZE1l\ndGhvZEFjdGlvbigKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgdHlwZSwgImlzIiArIGNhcCwgKENsYXNzW10pIG51bGwpKTsKICAgICAg\nICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGV4Y2VwMikg\newogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgZXhjZXA7CiAg\nICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9\nCiAgICAgICAgICAgICAgICAgICAgdHlwZSA9ICgoTWV0aG9kKSBtZW1iZXIp\nLmdldFJldHVyblR5cGUoKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAg\nICAgICAgICAgICAgICAgICAgbWVtYmVyID0gKEZpZWxkKSBBY2Nlc3NDb250\ncm9sbGVyLmRvUHJpdmlsZWdlZCgKICAgICAgICAgICAgICAgICAgICAgICAg\nSjJEb1ByaXZIZWxwZXIuZ2V0RGVjbGFyZWRGaWVsZEFjdGlvbigKICAgICAg\nICAgICAgICAgICAgICAgICAgICAgIG1ldGEuZ2V0RGVzY3JpYmVkVHlwZSgp\nLCBuYW1lKSk7CiAgICAgICAgICAgICAgICAgICAgdHlwZSA9ICgoRmllbGQp\nIG1lbWJlcikuZ2V0VHlwZSgpOwogICAgICAgICAgICAgICAgfQogICAgICAg\nICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkgewogICAgICAgICAgICAgICAg\naWYgKGUgaW5zdGFuY2VvZiBQcml2aWxlZ2VkQWN0aW9uRXhjZXB0aW9uKQog\nICAgICAgICAgICAgICAgICAgIGUgPSAoKFByaXZpbGVnZWRBY3Rpb25FeGNl\ncHRpb24pIGUpLmdldEV4Y2VwdGlvbigpOwogICAgICAgICAgICAgICAgdGhy\nb3cgZ2V0RXhjZXB0aW9uKF9sb2MuZ2V0KCJpbnZhbGlkLWF0dHIiLCBuYW1l\nLCBtZXRhKSwgZSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmIChm\naWVsZCA9PSBudWxsKSB7CiAgICAgICAgICAgICAgICBmaWVsZCA9IG1ldGEu\nYWRkRGVjbGFyZWRGaWVsZChuYW1lLCB0eXBlKTsKICAgICAgICAgICAgICAg\nIFBlcnNpc3RlbmNlTWV0YURhdGFEZWZhdWx0cy5zZXRDYXNjYWRlTm9uZShm\naWVsZCk7CiAgICAgICAgICAgICAgICBQZXJzaXN0ZW5jZU1ldGFEYXRhRGVm\nYXVsdHMuc2V0Q2FzY2FkZU5vbmUoZmllbGQuZ2V0S2V5KCkpOwogICAgICAg\nICAgICAgICAgUGVyc2lzdGVuY2VNZXRhRGF0YURlZmF1bHRzLnNldENhc2Nh\nZGVOb25lKGZpZWxkLmdldEVsZW1lbnQoKSk7CiAgICAgICAgICAgIH0KICAg\nICAgICAgICAgZmllbGQuYmFja2luZ01lbWJlcihtZW1iZXIpOwogICAgICAg\nIH0gZWxzZSBpZiAoZmllbGQgPT0gbnVsbCkgewogICAgICAgICAgICBmaWVs\nZCA9IG1ldGEuYWRkRGVjbGFyZWRGaWVsZChuYW1lLCBPYmplY3QuY2xhc3Mp\nOwogICAgICAgICAgICBQZXJzaXN0ZW5jZU1ldGFEYXRhRGVmYXVsdHMuc2V0\nQ2FzY2FkZU5vbmUoZmllbGQpOwogICAgICAgICAgICBQZXJzaXN0ZW5jZU1l\ndGFEYXRhRGVmYXVsdHMuc2V0Q2FzY2FkZU5vbmUoZmllbGQuZ2V0S2V5KCkp\nOwogICAgICAgICAgICBQZXJzaXN0ZW5jZU1ldGFEYXRhRGVmYXVsdHMuc2V0\nQ2FzY2FkZU5vbmUoZmllbGQuZ2V0RWxlbWVudCgpKTsKICAgICAgICB9Cgog\nICAgICAgIGlmIChpc01ldGFEYXRhTW9kZSgpKQogICAgICAgICAgICBmaWVs\nZC5zZXRMaXN0aW5nSW5kZXgoX2ZpZWxkUG9zKTsKCiAgICAgICAgX2ZpZWxk\nUG9zKys7CiAgICAgICAgcHVzaEVsZW1lbnQoZmllbGQpOwogICAgICAgIGFk\nZENvbW1lbnRzKGZpZWxkKTsKCiAgICAgICAgaWYgKGlzTWFwcGluZ092ZXJy\naWRlTW9kZSgpKQogICAgICAgICAgICBzdGFydEZpZWxkTWFwcGluZyhmaWVs\nZCwgYXR0cnMpOwogICAgICAgIHJldHVybiBmaWVsZDsKICAgIH0KCiAgICAv\nKioKICAgICAqIFBvcHMgZmllbGQgZWxlbWVudC4KICAgICAqLwogICAgcHJp\ndmF0ZSB2b2lkIGZpbmlzaEZpZWxkKCkKICAgICAgICB0aHJvd3MgU0FYRXhj\nZXB0aW9uIHsKICAgICAgICBGaWVsZE1ldGFEYXRhIGZpZWxkID0gKEZpZWxk\nTWV0YURhdGEpIHBvcEVsZW1lbnQoKTsKICAgICAgICBzZXRDYXNjYWRlcyhm\naWVsZCk7CiAgICAgICAgaWYgKGlzTWFwcGluZ092ZXJyaWRlTW9kZSgpKQog\nICAgICAgICAgICBlbmRGaWVsZE1hcHBpbmcoZmllbGQpOwogICAgICAgIF9z\ndHJhdGVneSA9IG51bGw7CiAgICB9CgogICAgLyoqCiAgICAgKiBJbXBsZW1l\nbnQgdG8gYWRkIGZpZWxkIG1hcHBpbmcgZGF0YS4gRG9lcyBub3RoaW5nIGJ5\nIGRlZmF1bHQuCiAgICAgKi8KICAgIHByb3RlY3RlZCB2b2lkIHN0YXJ0Rmll\nbGRNYXBwaW5nKEZpZWxkTWV0YURhdGEgZmllbGQsIEF0dHJpYnV0ZXMgYXR0\ncnMpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBJbXBsZW1lbnQgdG8gZmluYWxpemUgZmllbGQgbWFwcGlu\nZy4gRG9lcyBub3RoaW5nIGJ5IGRlZmF1bHQuCiAgICAgKi8KICAgIHByb3Rl\nY3RlZCB2b2lkIGVuZEZpZWxkTWFwcGluZyhGaWVsZE1ldGFEYXRhIGZpZWxk\nKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24gewogICAgfQoKICAgIC8q\nKgogICAgICogUGFyc2UgdmVyc2lvbi4KICAgICAqLwogICAgcHJvdGVjdGVk\nIGJvb2xlYW4gc3RhcnRWZXJzaW9uKEF0dHJpYnV0ZXMgYXR0cnMpCiAgICAg\nICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgRmllbGRNZXRhRGF0\nYSBmbWQgPSBwYXJzZUZpZWxkKGF0dHJzKTsKICAgICAgICBmbWQuc2V0RXhw\nbGljaXQodHJ1ZSk7CiAgICAgICAgZm1kLnNldFZlcnNpb24odHJ1ZSk7CiAg\nICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgcHJvdGVjdGVkIHZvaWQg\nZW5kVmVyc2lvbigpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAg\nICAgICAgZmluaXNoRmllbGQoKTsKICAgIH0KCiAgICAvKioKICAgICAqIFBh\ncnNlIHN0cmF0ZWd5IGVsZW1lbnQuCiAgICAgKi8KICAgIHByaXZhdGUgYm9v\nbGVhbiBzdGFydFN0cmF0ZWd5KFBlcnNpc3RlbmNlU3RyYXRlZ3kgc3RyYXRl\nZ3ksCiAgICAgICAgQXR0cmlidXRlcyBhdHRycykKICAgICAgICB0aHJvd3Mg\nU0FYRXhjZXB0aW9uIHsKICAgICAgICBGaWVsZE1ldGFEYXRhIGZtZCA9IHBh\ncnNlRmllbGQoYXR0cnMpOwogICAgICAgIGZtZC5zZXRFeHBsaWNpdCh0cnVl\nKTsKICAgICAgICBmbWQuc2V0TWFuYWdlbWVudChGaWVsZE1ldGFEYXRhLk1B\nTkFHRV9QRVJTSVNURU5UKTsKCiAgICAgICAgU3RyaW5nIHZhbCA9IGF0dHJz\nLmdldFZhbHVlKCJmZXRjaCIpOwogICAgICAgIGlmICh2YWwgIT0gbnVsbCkK\nICAgICAgICAgICAgZm1kLnNldEluRGVmYXVsdEZldGNoR3JvdXAoIkVBR0VS\nIi5lcXVhbHModmFsKSk7CiAgICAgICAgdmFsID0gYXR0cnMuZ2V0VmFsdWUo\nIm9wdGlvbmFsIik7CiAgICAgICAgaWYgKCJmYWxzZSIuZXF1YWxzKHZhbCkp\nCiAgICAgICAgICAgIGZtZC5zZXROdWxsVmFsdWUoRmllbGRNZXRhRGF0YS5O\nVUxMX0VYQ0VQVElPTik7CiAgICAgICAgZWxzZSBpZiAoInRydWUiLmVxdWFs\ncyh2YWwpCiAgICAgICAgICAgICAgICAmJiBmbWQuZ2V0TnVsbFZhbHVlKCkg\nPT0gRmllbGRNZXRhRGF0YS5OVUxMX0VYQ0VQVElPTikgewogICAgICAgICAg\nICAvLyBSZXNldCB2YWx1ZSBpZiB0aGUgZmllbGQgd2FzIGFubm90YXRlZCB3\naXRoIG9wdGlvbmFsPWZhbHNlLiAKICAgICAgICAgICAgLy8gT3RoZXJ3aXNl\nIGxlYXZlIGl0IGFsb25lLgogICAgICAgICAgICBmbWQuc2V0TnVsbFZhbHVl\nKEZpZWxkTWV0YURhdGEuTlVMTF9VTlNFVCk7CiAgICAgICAgfQogICAgICAg\nIGlmIChpc01hcHBpbmdPdmVycmlkZU1vZGUoKSkgewogICAgICAgICAgICB2\nYWwgPSBhdHRycy5nZXRWYWx1ZSgibWFwcGVkLWJ5Iik7CiAgICAgICAgICAg\nIGlmICh2YWwgIT0gbnVsbCkKICAgICAgICAgICAgICAgIGZtZC5zZXRNYXBw\nZWRCeSh2YWwpOwogICAgICAgIH0KICAgICAgICBwYXJzZVN0cmF0ZWd5KGZt\nZCwgc3RyYXRlZ3ksIGF0dHJzKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAg\nIH0KCiAgICBwcml2YXRlIHZvaWQgZW5kU3RyYXRlZ3koUGVyc2lzdGVuY2VT\ndHJhdGVneSBzdHJhdGVneSkKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9u\nIHsKICAgICAgICBmaW5pc2hGaWVsZCgpOwogICAgfQoKICAgIC8qKgogICAg\nICogUGFyc2Ugc3RyYXRlZ3kgc3BlY2lmaWMgYXR0cmlidXRlcy4KICAgICAq\nLwogICAgcHJpdmF0ZSB2b2lkIHBhcnNlU3RyYXRlZ3koRmllbGRNZXRhRGF0\nYSBmbWQsCiAgICAgICAgUGVyc2lzdGVuY2VTdHJhdGVneSBzdHJhdGVneSwg\nQXR0cmlidXRlcyBhdHRycykKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9u\nIHsKICAgICAgICBzd2l0Y2ggKHN0cmF0ZWd5KSB7CiAgICAgICAgICAgIGNh\nc2UgQkFTSUM6CiAgICAgICAgICAgICAgICBwYXJzZUJhc2ljKGZtZCwgYXR0\ncnMpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2Ug\nRU1CRURERUQ6CiAgICAgICAgICAgICAgICBwYXJzZUVtYmVkZGVkKGZtZCwg\nYXR0cnMpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNh\nc2UgT05FX09ORToKICAgICAgICAgICAgICAgIHBhcnNlT25lVG9PbmUoZm1k\nLCBhdHRycyk7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAg\nY2FzZSBNQU5ZX09ORToKICAgICAgICAgICAgICAgIHBhcnNlTWFueVRvT25l\nKGZtZCwgYXR0cnMpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAg\nICAgIGNhc2UgTUFOWV9NQU5ZOgogICAgICAgICAgICAgICAgcGFyc2VNYW55\nVG9NYW55KGZtZCwgYXR0cnMpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAg\nICAgICAgICAgIGNhc2UgT05FX01BTlk6CiAgICAgICAgICAgICAgICBwYXJz\nZU9uZVRvTWFueShmbWQsIGF0dHJzKTsKICAgICAgICAgICAgICAgIGJyZWFr\nOwogICAgICAgICAgICBjYXNlIFRSQU5TSUVOVDoKICAgICAgICAgICAgICAg\nIGZtZC5zZXRNYW5hZ2VtZW50KEZpZWxkTWV0YURhdGEuTUFOQUdFX05PTkUp\nOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgfQoKICAg\nIC8qKgogICAgICogUGFyc2UgYmFzaWMuCiAgICAgKi8KICAgIHByb3RlY3Rl\nZCB2b2lkIHBhcnNlQmFzaWMoRmllbGRNZXRhRGF0YSBmbWQsIEF0dHJpYnV0\nZXMgYXR0cnMpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBQYXJzZSBlbWJlZGRlZC4KICAgICAqLwogICAg\ncHJvdGVjdGVkIHZvaWQgcGFyc2VFbWJlZGRlZChGaWVsZE1ldGFEYXRhIGZt\nZCwgQXR0cmlidXRlcyBhdHRycykKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0\naW9uIHsKICAgICAgICBhc3NlcnRQQyhmbWQsICJFbWJlZGRlZCIpOwogICAg\nICAgIGZtZC5zZXRFbWJlZGRlZCh0cnVlKTsKICAgICAgICBmbWQuc2V0U2Vy\naWFsaXplZChmYWxzZSk7IC8vIG92ZXJyaWRlIGFueSBMb2IgYW5ub3RhdGlv\nbgogICAgICAgIGlmIChmbWQuZ2V0RW1iZWRkZWRNZXRhRGF0YSgpID09IG51\nbGwpCiAgICAgICAgICAgIGZtZC5hZGRFbWJlZGRlZE1ldGFEYXRhKCk7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBUaHJvdyBwcm9wZXIgZXhjZXB0aW9uIGlm\nIGdpdmVuIHZhbHVlIGlzIG5vdCBwb3NzaWJseSBwZXJzaXN0ZW5jZQogICAg\nICogY2FwYWJsZS4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIGFzc2VydFBD\nKEZpZWxkTWV0YURhdGEgZm1kLCBTdHJpbmcgYXR0cikKICAgICAgICB0aHJv\nd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICBpZiAoIUphdmFUeXBlcy5tYXli\nZVBDKGZtZCkpCiAgICAgICAgICAgIHRocm93IGdldEV4Y2VwdGlvbihfbG9j\nLmdldCgiYmFkLW1ldGEtYW5ubyIsIGZtZCwgYXR0cikpOwogICAgfQoKICAg\nIC8qKgogICAgICogUGFyc2Ugb25lLXRvLW9uZS4KICAgICAqLwogICAgcHJv\ndGVjdGVkIHZvaWQgcGFyc2VPbmVUb09uZShGaWVsZE1ldGFEYXRhIGZtZCwg\nQXR0cmlidXRlcyBhdHRycykKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9u\nIHsKICAgICAgICBTdHJpbmcgdmFsID0gYXR0cnMuZ2V0VmFsdWUoInRhcmdl\ndC1lbnRpdHkiKTsKICAgICAgICBpZiAodmFsICE9IG51bGwpCiAgICAgICAg\nICAgIGZtZC5zZXRUeXBlT3ZlcnJpZGUoY2xhc3NGb3JOYW1lKHZhbCkpOwog\nICAgICAgIGFzc2VydFBDKGZtZCwgIk9uZVRvT25lIik7CiAgICAgICAgZm1k\nLnNldFNlcmlhbGl6ZWQoZmFsc2UpOyAvLyBvdmVycmlkZSBhbnkgTG9iIGFu\nbm90YXRpb24KICAgICAgICBpZiAoIWZtZC5pc0RlZmF1bHRGZXRjaEdyb3Vw\nRXhwbGljaXQoKSkKICAgICAgICAgICAgZm1kLnNldEluRGVmYXVsdEZldGNo\nR3JvdXAodHJ1ZSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBQYXJzZSBtYW55\nLXRvLW9uZS4KICAgICAqLwogICAgcHJvdGVjdGVkIHZvaWQgcGFyc2VNYW55\nVG9PbmUoRmllbGRNZXRhRGF0YSBmbWQsIEF0dHJpYnV0ZXMgYXR0cnMpCiAg\nICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgU3RyaW5nIHZh\nbCA9IGF0dHJzLmdldFZhbHVlKCJ0YXJnZXQtZW50aXR5Iik7CiAgICAgICAg\naWYgKHZhbCAhPSBudWxsKQogICAgICAgICAgICBmbWQuc2V0VHlwZU92ZXJy\naWRlKGNsYXNzRm9yTmFtZSh2YWwpKTsKICAgICAgICBhc3NlcnRQQyhmbWQs\nICJNYW55VG9PbmUiKTsKICAgICAgICBmbWQuc2V0U2VyaWFsaXplZChmYWxz\nZSk7IC8vIG92ZXJyaWRlIGFueSBMb2IgYW5ub3RhdGlvbgogICAgICAgIGlm\nICghZm1kLmlzRGVmYXVsdEZldGNoR3JvdXBFeHBsaWNpdCgpKQogICAgICAg\nICAgICBmbWQuc2V0SW5EZWZhdWx0RmV0Y2hHcm91cCh0cnVlKTsKICAgIH0K\nCiAgICAvKioKICAgICAqIFBhcnNlIG1hbnktdG8tbWFueS4KICAgICAqLwog\nICAgcHJvdGVjdGVkIHZvaWQgcGFyc2VNYW55VG9NYW55KEZpZWxkTWV0YURh\ndGEgZm1kLCBBdHRyaWJ1dGVzIGF0dHJzKQogICAgICAgIHRocm93cyBTQVhF\neGNlcHRpb24gewogICAgICAgIFN0cmluZyB2YWwgPSBhdHRycy5nZXRWYWx1\nZSgidGFyZ2V0LWVudGl0eSIpOwogICAgICAgIGlmICh2YWwgIT0gbnVsbCkK\nICAgICAgICAgICAgZm1kLmdldEVsZW1lbnQoKS5zZXREZWNsYXJlZFR5cGUo\nY2xhc3NGb3JOYW1lKHZhbCkpOwogICAgICAgIGFzc2VydFBDQ29sbGVjdGlv\nbihmbWQsICJNYW55VG9NYW55Iik7CiAgICAgICAgZm1kLnNldFNlcmlhbGl6\nZWQoZmFsc2UpOyAvLyBvdmVycmlkZSBMb2IgaW4gYW5ub3RhdGlvbgogICAg\nfQoKICAgIC8qKgogICAgICogVGhyb3cgZXhjZXB0aW9uIGlmIGdpdmVuIGZp\nZWxkIG5vdCBhIGNvbGxlY3Rpb24gb2YgcG9zc2libGUgcGVyc2lzdGVuY2UK\nICAgICAqIGNhcGFibGVzLgogICAgICovCiAgICBwcml2YXRlIHZvaWQgYXNz\nZXJ0UENDb2xsZWN0aW9uKEZpZWxkTWV0YURhdGEgZm1kLCBTdHJpbmcgYXR0\ncikKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICBzd2l0\nY2ggKGZtZC5nZXREZWNsYXJlZFR5cGVDb2RlKCkpIHsKICAgICAgICAgICAg\nY2FzZSBKYXZhVHlwZXMuQVJSQVk6CiAgICAgICAgICAgIGNhc2UgSmF2YVR5\ncGVzLkNPTExFQ1RJT046CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLk1B\nUDoKICAgICAgICAgICAgICAgIGlmIChKYXZhVHlwZXMubWF5YmVQQyhmbWQu\nZ2V0RWxlbWVudCgpKSkKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAg\nICAgICAgICAgICAgIC8vIG5vIGJyZWFrCiAgICAgICAgICAgIGRlZmF1bHQ6\nCiAgICAgICAgICAgICAgICB0aHJvdyBnZXRFeGNlcHRpb24oX2xvYy5nZXQo\nImJhZC1tZXRhLWFubm8iLCBmbWQsIGF0dHIpKTsKICAgICAgICB9CiAgICB9\nCgogICAgLyoqCiAgICAgKiBQYXJzZSBvbmUtdG8tbWFueS4KICAgICAqLwog\nICAgcHJvdGVjdGVkIHZvaWQgcGFyc2VPbmVUb01hbnkoRmllbGRNZXRhRGF0\nYSBmbWQsIEF0dHJpYnV0ZXMgYXR0cnMpCiAgICAgICAgdGhyb3dzIFNBWEV4\nY2VwdGlvbiB7CiAgICAgICAgU3RyaW5nIHZhbCA9IGF0dHJzLmdldFZhbHVl\nKCJ0YXJnZXQtZW50aXR5Iik7CiAgICAgICAgaWYgKHZhbCAhPSBudWxsKQog\nICAgICAgICAgICBmbWQuZ2V0RWxlbWVudCgpLnNldERlY2xhcmVkVHlwZShj\nbGFzc0Zvck5hbWUodmFsKSk7CiAgICAgICAgYXNzZXJ0UENDb2xsZWN0aW9u\nKGZtZCwgIk9uZVRvTWFueSIpOwogICAgICAgIGZtZC5zZXRTZXJpYWxpemVk\nKGZhbHNlKTsgLy8gb3ZlcnJpZGUgYW55IExvYiBhbm5vdGF0aW9uCiAgICB9\nCgogICAgLyoqCiAgICAgKiBQYXJzZSBtYXAta2V5LgogICAgICovCiAgICBw\ncml2YXRlIGJvb2xlYW4gc3RhcnRNYXBLZXkoQXR0cmlidXRlcyBhdHRycykK\nICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICBpZiAoIWlz\nTWFwcGluZ092ZXJyaWRlTW9kZSgpKQogICAgICAgICAgICByZXR1cm4gZmFs\nc2U7CgogICAgICAgIEZpZWxkTWV0YURhdGEgZm1kID0gKEZpZWxkTWV0YURh\ndGEpIGN1cnJlbnRFbGVtZW50KCk7CiAgICAgICAgU3RyaW5nIG1hcEtleSA9\nIGF0dHJzLmdldFZhbHVlKCJuYW1lIik7CiAgICAgICAgaWYgKG1hcEtleSA9\nPSBudWxsKQogICAgICAgICAgICBmbWQuZ2V0S2V5KCkuc2V0VmFsdWVNYXBw\nZWRCeShWYWx1ZU1ldGFEYXRhLk1BUFBFRF9CWV9QSyk7CiAgICAgICAgZWxz\nZQogICAgICAgICAgICBmbWQuZ2V0S2V5KCkuc2V0VmFsdWVNYXBwZWRCeSht\nYXBLZXkpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qKgog\nICAgICogUGFyc2Ugb3JkZXItYnkuCiAgICAgKi8KICAgIHByaXZhdGUgdm9p\nZCBlbmRPcmRlckJ5KCkKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsK\nICAgICAgICBGaWVsZE1ldGFEYXRhIGZtZCA9IChGaWVsZE1ldGFEYXRhKSBj\ndXJyZW50RWxlbWVudCgpOwogICAgICAgIFN0cmluZyBkZWMgPSBjdXJyZW50\nVGV4dCgpOwogICAgICAgIGlmIChTdHJpbmdVdGlscy5pc0VtcHR5KGRlYykp\nCiAgICAgICAgICAgIGRlYyA9IE9yZGVyLkVMRU1FTlQgKyAiIGFzYyI7CiAg\nICAgICAgZm1kLnNldE9yZGVyRGVjbGFyYXRpb24oZGVjKTsKICAgIH0KCiAg\nICAvKioKICAgICAqIFBhcnNlIG5hbWVkLXF1ZXJ5LgogICAgICovCiAgICBw\ncm90ZWN0ZWQgYm9vbGVhbiBzdGFydE5hbWVkUXVlcnkoQXR0cmlidXRlcyBh\ndHRycykKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICBp\nZiAoIWlzUXVlcnlNb2RlKCkpCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsK\nCiAgICAgICAgU3RyaW5nIG5hbWUgPSBhdHRycy5nZXRWYWx1ZSgibmFtZSIp\nOwogICAgICAgIExvZyBsb2cgPSBnZXRMb2coKTsKICAgICAgICBpZiAobG9n\nLmlzVHJhY2VFbmFibGVkKCkpCiAgICAgICAgICAgIGxvZy50cmFjZShfbG9j\nLmdldCgicGFyc2UtcXVlcnkiLCBuYW1lKSk7CgogICAgICAgIFF1ZXJ5TWV0\nYURhdGEgbWV0YSA9IGdldFJlcG9zaXRvcnkoKS5nZXRDYWNoZWRRdWVyeU1l\ndGFEYXRhKG51bGwsIG5hbWUpOwogICAgICAgIGlmIChtZXRhICE9IG51bGwg\nJiYgbG9nLmlzV2FybkVuYWJsZWQoKSkKICAgICAgICAgICAgbG9nLndhcm4o\nX2xvYy5nZXQoIm92ZXJyaWRlLXF1ZXJ5IiwgbmFtZSwgY3VycmVudExvY2F0\naW9uKCkpKTsKCiAgICAgICAgbWV0YSA9IGdldFJlcG9zaXRvcnkoKS5hZGRR\ndWVyeU1ldGFEYXRhKG51bGwsIG5hbWUpOwogICAgICAgIG1ldGEuc2V0RGVm\naW5pbmdUeXBlKF9jbHMpOwogICAgICAgIG1ldGEuc2V0UXVlcnlTdHJpbmco\nYXR0cnMuZ2V0VmFsdWUoInF1ZXJ5IikpOwogICAgICAgIG1ldGEuc2V0TGFu\nZ3VhZ2UoSlBRTFBhcnNlci5MQU5HX0pQUUwpOwoKICAgICAgICBPYmplY3Qg\nY3VyID0gY3VycmVudEVsZW1lbnQoKTsKICAgICAgICBPYmplY3Qgc2NvcGUg\nPSAoY3VyIGluc3RhbmNlb2YgQ2xhc3NNZXRhRGF0YSkKICAgICAgICAgICAg\nPyAoKENsYXNzTWV0YURhdGEpIGN1cikuZ2V0RGVzY3JpYmVkVHlwZSgpIDog\nbnVsbDsKICAgICAgICBtZXRhLnNldFNvdXJjZShnZXRTb3VyY2VGaWxlKCks\nIHNjb3BlLCBtZXRhLlNSQ19YTUwpOwogICAgICAgIGlmIChpc01ldGFEYXRh\nTW9kZSgpKQogICAgICAgICAgICBtZXRhLnNldFNvdXJjZU1vZGUoTU9ERV9N\nRVRBKTsKICAgICAgICBlbHNlIGlmIChpc01hcHBpbmdNb2RlKCkpCiAgICAg\nICAgICAgIG1ldGEuc2V0U291cmNlTW9kZShNT0RFX01BUFBJTkcpOwogICAg\nICAgIGVsc2UKICAgICAgICAgICAgbWV0YS5zZXRTb3VyY2VNb2RlKE1PREVf\nUVVFUlkpOwogICAgICAgIHB1c2hFbGVtZW50KG1ldGEpOwogICAgICAgIHJl\ndHVybiB0cnVlOwogICAgfQoKICAgIHByb3RlY3RlZCB2b2lkIGVuZE5hbWVk\nUXVlcnkoKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24gewogICAgICAg\nIHBvcEVsZW1lbnQoKTsKICAgIH0KCiAgICBwcm90ZWN0ZWQgYm9vbGVhbiBz\ndGFydFF1ZXJ5U3RyaW5nKEF0dHJpYnV0ZXMgYXR0cnMpCiAgICAgICAgdGhy\nb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9\nCgogICAgcHJvdGVjdGVkIHZvaWQgZW5kUXVlcnlTdHJpbmcoKQogICAgICAg\nIHRocm93cyBTQVhFeGNlcHRpb24gewogICAgICAgIFF1ZXJ5TWV0YURhdGEg\nbWV0YSA9IChRdWVyeU1ldGFEYXRhKSBjdXJyZW50RWxlbWVudCgpOwogICAg\nICAgIG1ldGEuc2V0UXVlcnlTdHJpbmcoY3VycmVudFRleHQoKSk7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBQYXJzZSBxdWVyeS1oaW50LgogICAgICovCiAg\nICBwcm90ZWN0ZWQgYm9vbGVhbiBzdGFydFF1ZXJ5SGludChBdHRyaWJ1dGVz\nIGF0dHJzKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24gewogICAgICAg\nIFF1ZXJ5TWV0YURhdGEgbWV0YSA9IChRdWVyeU1ldGFEYXRhKSBjdXJyZW50\nRWxlbWVudCgpOwogICAgICAgIG1ldGEuYWRkSGludChhdHRycy5nZXRWYWx1\nZSgibmFtZSIpLCBhdHRycy5nZXRWYWx1ZSgidmFsdWUiKSk7CiAgICAgICAg\ncmV0dXJuIHRydWU7CiAgICB9CgogICAgcHJvdGVjdGVkIHZvaWQgZW5kUXVl\ncnlIaW50KCkKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgIH0K\nCiAgICAvKioKICAgICAqIFBhcnNlIG5hdGl2ZS1uYW1lZC1xdWVyeS4KICAg\nICAqLwogICAgcHJvdGVjdGVkIGJvb2xlYW4gc3RhcnROYW1lZE5hdGl2ZVF1\nZXJ5KEF0dHJpYnV0ZXMgYXR0cnMpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2Vw\ndGlvbiB7CiAgICAgICAgaWYgKCFpc1F1ZXJ5TW9kZSgpKQogICAgICAgICAg\nICByZXR1cm4gZmFsc2U7CgogICAgICAgIFN0cmluZyBuYW1lID0gYXR0cnMu\nZ2V0VmFsdWUoIm5hbWUiKTsKICAgICAgICBMb2cgbG9nID0gZ2V0TG9nKCk7\nCiAgICAgICAgaWYgKGxvZy5pc1RyYWNlRW5hYmxlZCgpKQogICAgICAgICAg\nICBsb2cudHJhY2UoX2xvYy5nZXQoInBhcnNlLW5hdGl2ZS1xdWVyeSIsIG5h\nbWUpKTsKCiAgICAgICAgUXVlcnlNZXRhRGF0YSBtZXRhID0gZ2V0UmVwb3Np\ndG9yeSgpLmdldENhY2hlZFF1ZXJ5TWV0YURhdGEobnVsbCwgbmFtZSk7CiAg\nICAgICAgaWYgKG1ldGEgIT0gbnVsbCAmJiBsb2cuaXNXYXJuRW5hYmxlZCgp\nKQogICAgICAgICAgICBsb2cud2FybihfbG9jLmdldCgib3ZlcnJpZGUtcXVl\ncnkiLCBuYW1lLCBjdXJyZW50TG9jYXRpb24oKSkpOwoKICAgICAgICBtZXRh\nID0gZ2V0UmVwb3NpdG9yeSgpLmFkZFF1ZXJ5TWV0YURhdGEobnVsbCwgbmFt\nZSk7CiAgICAgICAgbWV0YS5zZXREZWZpbmluZ1R5cGUoX2Nscyk7CiAgICAg\nICAgbWV0YS5zZXRRdWVyeVN0cmluZyhhdHRycy5nZXRWYWx1ZSgicXVlcnki\nKSk7CiAgICAgICAgbWV0YS5zZXRMYW5ndWFnZShRdWVyeUxhbmd1YWdlcy5M\nQU5HX1NRTCk7CiAgICAgICAgU3RyaW5nIHZhbCA9IGF0dHJzLmdldFZhbHVl\nKCJyZXN1bHQtY2xhc3MiKTsKICAgICAgICBpZiAodmFsICE9IG51bGwpIHsK\nICAgICAgICAgICAgQ2xhc3MgdHlwZSA9IGNsYXNzRm9yTmFtZSh2YWwpOwog\nICAgICAgICAgICBpZiAoSW1wbEhlbHBlci5pc01hbmFnZWRUeXBlKGdldENv\nbmZpZ3VyYXRpb24oKSwgdHlwZSkpCiAgICAgICAgICAgICAgICBtZXRhLnNl\ndENhbmRpZGF0ZVR5cGUodHlwZSk7CiAgICAgICAgICAgIGVsc2UKICAgICAg\nICAgICAgICAgIG1ldGEuc2V0UmVzdWx0VHlwZSh0eXBlKTsKICAgICAgICB9\nCgogICAgICAgIHZhbCA9IGF0dHJzLmdldFZhbHVlKCJyZXN1bHQtc2V0LW1h\ncHBpbmciKTsKICAgICAgICBpZiAodmFsICE9IG51bGwpCiAgICAgICAgICAg\nIG1ldGEuc2V0UmVzdWx0U2V0TWFwcGluZ05hbWUodmFsKTsKCiAgICAgICAg\nT2JqZWN0IGN1ciA9IGN1cnJlbnRFbGVtZW50KCk7CiAgICAgICAgT2JqZWN0\nIHNjb3BlID0gKGN1ciBpbnN0YW5jZW9mIENsYXNzTWV0YURhdGEpCiAgICAg\nICAgICAgID8gKChDbGFzc01ldGFEYXRhKSBjdXIpLmdldERlc2NyaWJlZFR5\ncGUoKSA6IG51bGw7CiAgICAgICAgbWV0YS5zZXRTb3VyY2UoZ2V0U291cmNl\nRmlsZSgpLCBzY29wZSwgbWV0YS5TUkNfWE1MKTsKICAgICAgICBpZiAoaXNN\nZXRhRGF0YU1vZGUoKSkKICAgICAgICAgICAgbWV0YS5zZXRTb3VyY2VNb2Rl\nKE1PREVfTUVUQSk7CiAgICAgICAgZWxzZSBpZiAoaXNNYXBwaW5nTW9kZSgp\nKQogICAgICAgICAgICBtZXRhLnNldFNvdXJjZU1vZGUoTU9ERV9NQVBQSU5H\nKTsKICAgICAgICBlbHNlCiAgICAgICAgICAgIG1ldGEuc2V0U291cmNlTW9k\nZShNT0RFX1FVRVJZKTsKICAgICAgICBwdXNoRWxlbWVudChtZXRhKTsKICAg\nICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBwcm90ZWN0ZWQgdm9pZCBl\nbmROYW1lZE5hdGl2ZVF1ZXJ5KCkKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0\naW9uIHsKICAgICAgICBwb3BFbGVtZW50KCk7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBTdGFydCBlbnRpdHktbGlzdGVuZXJzCiAgICAgKi8KICAgIHByaXZh\ndGUgYm9vbGVhbiBzdGFydEVudGl0eUxpc3RlbmVycyhBdHRyaWJ1dGVzIGF0\ndHJzKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24gewogICAgICAgIGlm\nICghaXNNZXRhRGF0YU1vZGUoKSkKICAgICAgICAgICAgcmV0dXJuIGZhbHNl\nOwogICAgICAgIGlmIChjdXJyZW50RWxlbWVudCgpID09IG51bGwpCiAgICAg\nICAgICAgIHJldHVybiB0cnVlOwoKICAgICAgICAvLyByZXNldCBsaXN0ZW5l\ncnMgZGVjbGFyZWQgaW4gYW5ub3RhdGlvbnMuCiAgICAgICAgTGlmZWN5Y2xl\nTWV0YURhdGEgbWV0YSA9ICgoQ2xhc3NNZXRhRGF0YSkgY3VycmVudEVsZW1l\nbnQoKSkuCiAgICAgICAgICAgIGdldExpZmVjeWNsZU1ldGFEYXRhKCk7CiAg\nICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBMaWZlY3ljbGVFdmVudC5BTExf\nRVZFTlRTLmxlbmd0aDsgaSsrKQogICAgICAgICAgICBtZXRhLnNldERlY2xh\ncmVkQ2FsbGJhY2tzKGksIG51bGwsIDApOwogICAgICAgIHJldHVybiB0cnVl\nOwogICAgfQoKICAgIC8qKgogICAgICogUGFyc2UgZXhjbHVkZS1kZWZhdWx0\nLWxpc3RlbmVycy4KICAgICAqLwogICAgcHJpdmF0ZSBib29sZWFuIHN0YXJ0\nRXhjbHVkZURlZmF1bHRMaXN0ZW5lcnMoQXR0cmlidXRlcyBhdHRycykKICAg\nICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICBpZiAoIWlzTWV0\nYURhdGFNb2RlKCkpCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAg\nICBDbGFzc01ldGFEYXRhIG1ldGEgPSAoQ2xhc3NNZXRhRGF0YSkgY3VycmVu\ndEVsZW1lbnQoKTsKICAgICAgICBtZXRhLmdldExpZmVjeWNsZU1ldGFEYXRh\nKCkuc2V0SWdub3JlU3lzdGVtTGlzdGVuZXJzKHRydWUpOwogICAgICAgIHJl\ndHVybiB0cnVlOwogICAgfQoKICAgIC8qKgogICAgICogUGFyc2UgZXhjbHVk\nZS1zdXBlcmNsYXNzLWxpc3RlbmVycy4KICAgICAqLwogICAgcHJpdmF0ZSBi\nb29sZWFuIHN0YXJ0RXhjbHVkZVN1cGVyY2xhc3NMaXN0ZW5lcnMoQXR0cmli\ndXRlcyBhdHRycykKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAg\nICAgICBpZiAoIWlzTWV0YURhdGFNb2RlKCkpCiAgICAgICAgICAgIHJldHVy\nbiBmYWxzZTsKICAgICAgICBDbGFzc01ldGFEYXRhIG1ldGEgPSAoQ2xhc3NN\nZXRhRGF0YSkgY3VycmVudEVsZW1lbnQoKTsKICAgICAgICBtZXRhLmdldExp\nZmVjeWNsZU1ldGFEYXRhKCkuc2V0SWdub3JlU3VwZXJjbGFzc0NhbGxiYWNr\ncwogICAgICAgICAgICAoTGlmZWN5Y2xlTWV0YURhdGEuSUdOT1JFX0hJR0gp\nOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qKgogICAgICog\nUGFyc2UgZW50aXR5LWxpc3RlbmVyLgogICAgICovCiAgICBwcml2YXRlIGJv\nb2xlYW4gc3RhcnRFbnRpdHlMaXN0ZW5lcihBdHRyaWJ1dGVzIGF0dHJzKQog\nICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24gewogICAgICAgIF9saXN0ZW5l\nciA9IGNsYXNzRm9yTmFtZShhdHRycy5nZXRWYWx1ZSgiY2xhc3MiKSk7CiAg\nICAgICAgYm9vbGVhbiBzeXN0ZW0gPSBjdXJyZW50RWxlbWVudCgpID09IG51\nbGw7CiAgICAgICAgQ29sbGVjdGlvbjxMaWZlY3ljbGVDYWxsYmFja3M+W10g\ncGFyc2VkID0KICAgICAgICAgICAgQW5ub3RhdGlvblBlcnNpc3RlbmNlTWV0\nYURhdGFQYXJzZXIucGFyc2VDYWxsYmFja01ldGhvZHMoX2xpc3RlbmVyLAog\nICAgICAgICAgICAgICAgbnVsbCwgdHJ1ZSwgdHJ1ZSwgX3JlcG9zKTsKICAg\nICAgICBpZiAocGFyc2VkID09IG51bGwpCiAgICAgICAgICAgIHJldHVybiB0\ncnVlOwoKICAgICAgICBpZiAoX2NhbGxiYWNrcyA9PSBudWxsKSB7CiAgICAg\nICAgICAgIF9jYWxsYmFja3MgPSAoQ29sbGVjdGlvbjxMaWZlY3ljbGVDYWxs\nYmFja3M+W10pCiAgICAgICAgICAgICAgICBuZXcgQ29sbGVjdGlvbltMaWZl\nY3ljbGVFdmVudC5BTExfRVZFTlRTLmxlbmd0aF07CiAgICAgICAgICAgIGlm\nICghc3lzdGVtKQogICAgICAgICAgICAgICAgX2hpZ2hzID0gbmV3IGludFtM\naWZlY3ljbGVFdmVudC5BTExfRVZFTlRTLmxlbmd0aF07CiAgICAgICAgfQog\nICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgcGFyc2VkLmxlbmd0aDsgaSsr\nKSB7CiAgICAgICAgICAgIGlmIChwYXJzZWRbaV0gPT0gbnVsbCkKICAgICAg\nICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICBpZiAoX2NhbGxiYWNr\nc1tpXSA9PSBudWxsKQogICAgICAgICAgICAgICAgX2NhbGxiYWNrc1tpXSA9\nIHBhcnNlZFtpXTsKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAg\nX2NhbGxiYWNrc1tpXS5hZGRBbGwocGFyc2VkW2ldKTsKICAgICAgICAgICAg\naWYgKCFzeXN0ZW0pCiAgICAgICAgICAgICAgICBfaGlnaHNbaV0gKz0gcGFy\nc2VkW2ldLnNpemUoKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHRydWU7\nCiAgICB9CgogICAgcHJpdmF0ZSB2b2lkIGVuZEVudGl0eUxpc3RlbmVyKCkK\nICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICAvLyBzaG91\nbGQgYmUgaW4gZW5kRW50aXR5TGlzdGVuZXJzIEkgdGhpbmsgdG8gbWVyZ2Ug\nY2FsbGJhY2tzCiAgICAgICAgLy8gaW50byBhIHNpbmdsZSBsaXN0ZW5lci4g\nIEJ1dCB0aGVuIHRoZSB1c2VyIGNhbm5vdCByZW1vdmUuCiAgICAgICAgaWYg\nKGN1cnJlbnRFbGVtZW50KCkgPT0gbnVsbCAmJiBfY2FsbGJhY2tzICE9IG51\nbGwpIHsKICAgICAgICAgICAgX3JlcG9zLmFkZFN5c3RlbUxpc3RlbmVyKG5l\ndyBQZXJzaXN0ZW5jZUxpc3RlbmVyQWRhcHRlcgogICAgICAgICAgICAgICAg\nKF9jYWxsYmFja3MpKTsKICAgICAgICAgICAgX2NhbGxiYWNrcyA9IG51bGw7\nCiAgICAgICAgfQogICAgICAgIF9saXN0ZW5lciA9IG51bGw7CiAgICB9Cgog\nICAgcHJpdmF0ZSBib29sZWFuIHN0YXJ0Q2FsbGJhY2soTWV0YURhdGFUYWcg\nY2FsbGJhY2ssIEF0dHJpYnV0ZXMgYXR0cnMpCiAgICAgICAgdGhyb3dzIFNB\nWEV4Y2VwdGlvbiB7CiAgICAgICAgaWYgKCFpc01ldGFEYXRhTW9kZSgpKQog\nICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgaW50W10gZXZlbnRz\nID0gTWV0YURhdGFQYXJzZXJzLmdldEV2ZW50VHlwZXMoY2FsbGJhY2spOwog\nICAgICAgIGlmIChldmVudHMgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJu\nIGZhbHNlOwoKICAgICAgICBib29sZWFuIHN5c3RlbSA9IGN1cnJlbnRFbGVt\nZW50KCkgPT0gbnVsbDsKICAgICAgICBDbGFzcyB0eXBlID0gY3VycmVudEVs\nZW1lbnQoKSA9PSBudWxsID8gbnVsbCA6CiAgICAgICAgICAgICgoQ2xhc3NN\nZXRhRGF0YSkgY3VycmVudEVsZW1lbnQoKSkuZ2V0RGVzY3JpYmVkVHlwZSgp\nOwogICAgICAgIGlmICh0eXBlID09IG51bGwpCiAgICAgICAgICAgIHR5cGUg\nPSBPYmplY3QuY2xhc3M7CgogICAgICAgIGlmIChfY2FsbGJhY2tzID09IG51\nbGwpIHsKICAgICAgICAgICAgX2NhbGxiYWNrcyA9IChDb2xsZWN0aW9uPExp\nZmVjeWNsZUNhbGxiYWNrcz5bXSkKICAgICAgICAgICAgICAgIG5ldyBDb2xs\nZWN0aW9uW0xpZmVjeWNsZUV2ZW50LkFMTF9FVkVOVFMubGVuZ3RoXTsKICAg\nICAgICAgICAgaWYgKCFzeXN0ZW0pCiAgICAgICAgICAgICAgICBfaGlnaHMg\nPSBuZXcgaW50W0xpZmVjeWNsZUV2ZW50LkFMTF9FVkVOVFMubGVuZ3RoXTsK\nICAgICAgICB9CgogICAgICAgIE1ldGFEYXRhRGVmYXVsdHMgZGVmID0gX3Jl\ncG9zLmdldE1ldGFEYXRhRmFjdG9yeSgpLmdldERlZmF1bHRzKCk7CiAgICAg\nICAgTGlmZWN5Y2xlQ2FsbGJhY2tzIGFkYXB0ZXI7CiAgICAgICAgaWYgKF9s\naXN0ZW5lciAhPSBudWxsKQogICAgICAgICAgICBhZGFwdGVyID0gbmV3IEJl\nYW5MaWZlY3ljbGVDYWxsYmFja3MoX2xpc3RlbmVyLAogICAgICAgICAgICAg\nICAgYXR0cnMuZ2V0VmFsdWUoIm1ldGhvZC1uYW1lIiksIGZhbHNlLCB0eXBl\nKTsKICAgICAgICBlbHNlCiAgICAgICAgICAgIGFkYXB0ZXIgPSBuZXcgTWV0\naG9kTGlmZWN5Y2xlQ2FsbGJhY2tzKF9jbHMsCiAgICAgICAgICAgICAgICBh\ndHRycy5nZXRWYWx1ZSgibWV0aG9kLW5hbWUiKSwgZmFsc2UpOwoKICAgICAg\nICBmb3IgKGludCBpID0gMDsgaSA8IGV2ZW50cy5sZW5ndGg7IGkrKykgewog\nICAgICAgICAgICBpbnQgZXZlbnQgPSBldmVudHNbaV07CiAgICAgICAgICAg\nIGlmIChfbGlzdGVuZXIgIT0gbnVsbCkgewogICAgICAgICAgICAgICAgTWV0\nYURhdGFQYXJzZXJzLnZhbGlkYXRlTWV0aG9kc0ZvclNhbWVDYWxsYmFjayhf\nbGlzdGVuZXIsCiAgICAgICAgICAgICAgICAgICAgX2NhbGxiYWNrc1tldmVu\ndF0sICgoQmVhbkxpZmVjeWNsZUNhbGxiYWNrcykgYWRhcHRlcikuCiAgICAg\nICAgICAgICAgICAgICAgZ2V0Q2FsbGJhY2tNZXRob2QoKSwgY2FsbGJhY2ss\nIGRlZiwgZ2V0TG9nKCkpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAg\nICAgICAgICAgTWV0YURhdGFQYXJzZXJzLnZhbGlkYXRlTWV0aG9kc0ZvclNh\nbWVDYWxsYmFjayhfY2xzLAogICAgICAgICAgICAgICAgICAgIF9jYWxsYmFj\na3NbZXZlbnRdLCAoKE1ldGhvZExpZmVjeWNsZUNhbGxiYWNrcykgYWRhcHRl\ncikuCiAgICAgICAgICAgICAgICAgICAgZ2V0Q2FsbGJhY2tNZXRob2QoKSwg\nY2FsbGJhY2ssIGRlZiwgZ2V0TG9nKCkpOwoKICAgICAgICAgICAgfQogICAg\nICAgICAgICBpZiAoX2NhbGxiYWNrc1tldmVudF0gPT0gbnVsbCkKICAgICAg\nICAgICAgICAgIF9jYWxsYmFja3NbZXZlbnRdID0gbmV3IEFycmF5TGlzdDxM\naWZlY3ljbGVDYWxsYmFja3M+KDMpOwogICAgICAgICAgICBfY2FsbGJhY2tz\nW2V2ZW50XS5hZGQoYWRhcHRlcik7CiAgICAgICAgICAgIGlmICghc3lzdGVt\nICYmIF9saXN0ZW5lciAhPSBudWxsKQogICAgICAgICAgICAgICAgX2hpZ2hz\nW2V2ZW50XSsrOwogICAgICAgIH0KICAgICAgICByZXR1cm4gdHJ1ZTsKICAg\nIH0KCiAgICAvKioKICAgICAqIFN0b3JlIGxpZmVjeWNsZSBtZXRhZGF0YS4K\nICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIHN0b3JlQ2FsbGJhY2tzKENsYXNz\nTWV0YURhdGEgY2xzKSB7CiAgICAgICAgTGlmZWN5Y2xlTWV0YURhdGEgbWV0\nYSA9IGNscy5nZXRMaWZlY3ljbGVNZXRhRGF0YSgpOwogICAgICAgIENsYXNz\nIHN1cENscyA9IGNscy5nZXREZXNjcmliZWRUeXBlKCkuZ2V0U3VwZXJjbGFz\ncygpOwogICAgICAgIENvbGxlY3Rpb248TGlmZWN5Y2xlQ2FsbGJhY2tzPltd\nIHN1cENhbGxzID0gbnVsbDsKICAgICAgICBpZiAoIU9iamVjdC5jbGFzcy5l\ncXVhbHMoc3VwQ2xzKSkgewogICAgICAgICAgICBzdXBDYWxscyA9IEFubm90\nYXRpb25QZXJzaXN0ZW5jZU1ldGFEYXRhUGFyc2VyLnBhcnNlQ2FsbGJhY2tN\nZXRob2RzCiAgICAgICAgICAgICAgICAoc3VwQ2xzLCBudWxsLCB0cnVlLCBm\nYWxzZSwgX3JlcG9zKTsKICAgICAgICB9CiAgICAgICAgaWYgKHN1cENhbGxz\nICE9IG51bGwpIHsKICAgICAgICAgICAgZm9yIChpbnQgZXZlbnQgOiBMaWZl\nY3ljbGVFdmVudC5BTExfRVZFTlRTKSB7CiAgICAgICAgICAgICAgICBpZiAo\nc3VwQ2FsbHNbZXZlbnRdID09IG51bGwpCiAgICAgICAgICAgICAgICAgICAg\nY29udGludWU7CiAgICAgICAgICAgICAgICBtZXRhLnNldE5vblBDU3VwZXJj\nbGFzc0NhbGxiYWNrcyhldmVudCwgc3VwQ2FsbHNbZXZlbnRdLnRvQXJyYXkK\nICAgICAgICAgICAgICAgICAgICAobmV3IExpZmVjeWNsZUNhbGxiYWNrc1tz\ndXBDYWxsc1tldmVudF0uc2l6ZSgpXSksIDApOwogICAgICAgICAgICB9CiAg\nICAgICAgfQogICAgICAgIGlmIChfY2FsbGJhY2tzID09IG51bGwpCiAgICAg\nICAgICAgIHJldHVybjsKCiAgICAgICAgZm9yIChpbnQgZXZlbnQgOiBMaWZl\nY3ljbGVFdmVudC5BTExfRVZFTlRTKSB7CiAgICAgICAgICAgIGlmIChfY2Fs\nbGJhY2tzW2V2ZW50XSA9PSBudWxsKQogICAgICAgICAgICAgICAgY29udGlu\ndWU7CiAgICAgICAgICAgIG1ldGEuc2V0RGVjbGFyZWRDYWxsYmFja3MoZXZl\nbnQsIChMaWZlY3ljbGVDYWxsYmFja3NbXSkKICAgICAgICAgICAgICAgIF9j\nYWxsYmFja3NbZXZlbnRdLnRvQXJyYXkKICAgICAgICAgICAgICAgICAgICAo\nbmV3IExpZmVjeWNsZUNhbGxiYWNrc1tfY2FsbGJhY2tzW2V2ZW50XS5zaXpl\nKCldKSwKICAgICAgICAgICAgICAgIF9oaWdoc1tldmVudF0pOwogICAgICAg\nIH0KICAgICAgICBfY2FsbGJhY2tzID0gbnVsbDsKICAgICAgICBfaGlnaHMg\nPSBudWxsOwogICAgfQoKICAgIC8qKgogICAgICogSW5zdGFudGlhdGUgdGhl\nIGdpdmVuIGNsYXNzLCB0YWtpbmcgaW50byBhY2NvdW50IHRoZSBkZWZhdWx0\nIHBhY2thZ2UuCgkgKi8KCXByb3RlY3RlZCBDbGFzcyBjbGFzc0Zvck5hbWUo\nU3RyaW5nIG5hbWUpCgkJdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CgkJaWYgKCJF\nbnRpdHkiLmVxdWFscyhuYW1lKSkKCQkJcmV0dXJuIFBlcnNpc3RlbmNlQ2Fw\nYWJsZS5jbGFzczsKCQlyZXR1cm4gc3VwZXIuY2xhc3NGb3JOYW1lKG5hbWUs\nIGlzUnVudGltZSgpKTsKCX0KfQo=\n","encoding":"base64"}

