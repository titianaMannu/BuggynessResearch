{"sha":"daed50ccb2c539b7e860a1f1c786f6d100f79f63","node_id":"MDQ6QmxvYjIwNjM2NDpkYWVkNTBjY2IyYzUzOWI3ZTg2MGExZjFjNzg2ZjZkMTAwZjc5ZjYz","size":30825,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/daed50ccb2c539b7e860a1f1c786f6d100f79f63","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuamRiYzsK\nCmltcG9ydCBqYXZhLmxhbmcucmVmbGVjdC5Nb2RpZmllcjsKaW1wb3J0IGph\ndmEuc3FsLlR5cGVzOwppbXBvcnQgamF2YS51dGlsLkFycmF5TGlzdDsKaW1w\nb3J0IGphdmEudXRpbC5BcnJheXM7CmltcG9ydCBqYXZhLnV0aWwuRW51bVNl\ndDsKaW1wb3J0IGphdmEudXRpbC5IYXNoTWFwOwppbXBvcnQgamF2YS51dGls\nLkxpc3Q7CmltcG9ydCBqYXZhLnV0aWwuTWFwOwppbXBvcnQgamF2YXgucGVy\nc2lzdGVuY2UuRGlzY3JpbWluYXRvclR5cGU7CmltcG9ydCBqYXZheC5wZXJz\naXN0ZW5jZS5FbnVtVHlwZTsKaW1wb3J0IGphdmF4LnBlcnNpc3RlbmNlLklu\naGVyaXRhbmNlVHlwZTsKaW1wb3J0IGphdmF4LnBlcnNpc3RlbmNlLlRlbXBv\ncmFsVHlwZTsKCmltcG9ydCBvcmcuYXBhY2hlLmNvbW1vbnMubGFuZy5TdHJp\nbmdVdGlsczsKaW1wb3J0IG9yZy54bWwuc2F4LkF0dHJpYnV0ZXM7CmltcG9y\ndCBvcmcueG1sLnNheC5TQVhFeGNlcHRpb247CmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEuamRiYy5jb25mLkpEQkNDb25maWd1cmF0aW9uOwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0YS5DbGFzc01hcHBpbmc7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhLkNsYXNzTWFwcGlu\nZ0luZm87CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhLkRp\nc2NyaW1pbmF0b3JNYXBwaW5nSW5mbzsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5qZGJjLm1ldGEuRmllbGRNYXBwaW5nOwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLmpkYmMubWV0YS5NYXBwaW5nUmVwb3NpdG9yeTsKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLm1ldGEuUXVlcnlSZXN1bHRNYXBw\naW5nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0YS5TZXF1\nZW5jZU1hcHBpbmc7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5t\nZXRhLnN0cmF0cy5FbnVtVmFsdWVIYW5kbGVyOwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLmpkYmMubWV0YS5zdHJhdHMuRmxhdENsYXNzU3RyYXRlZ3k7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhLnN0cmF0cy5G\ndWxsQ2xhc3NTdHJhdGVneTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5q\nZGJjLm1ldGEuc3RyYXRzLk5vbmVDbGFzc1N0cmF0ZWd5OwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0YS5zdHJhdHMuVmVydGljYWxDbGFz\nc1N0cmF0ZWd5OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2No\nZW1hLkNvbHVtbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNj\naGVtYS5VbmlxdWU7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLmxv\nZy5Mb2c7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuTG9j\nYWxpemVyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuQ2xhc3NN\nZXRhRGF0YTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRhLkZpZWxk\nTWV0YURhdGE7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YS5KYXZh\nVHlwZXM7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YS5NZXRhRGF0\nYVJlcG9zaXRvcnk7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lz\ndGVuY2UuWE1MUGVyc2lzdGVuY2VNZXRhRGF0YVBhcnNlcjsKaW1wb3J0IHN0\nYXRpYyBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuamRiYy5NYXBw\naW5nVGFnLio7CgovKioKICogQ3VzdG9tIFNBWCBwYXJzZXIgdXNlZCBieSB0\naGUgc3lzdGVtIHRvIHBhcnNlIHBlcnNpc3RlbmNlIG1hcHBpbmcgZmlsZXMu\nCiAqCiAqIEBhdXRob3IgU3RldmUgS2ltCiAqIEBub2phdmFkb2MKICovCnB1\nYmxpYyBjbGFzcyBYTUxQZXJzaXN0ZW5jZU1hcHBpbmdQYXJzZXIKICAgIGV4\ndGVuZHMgWE1MUGVyc2lzdGVuY2VNZXRhRGF0YVBhcnNlciB7CgogICAgcHJp\ndmF0ZSBzdGF0aWMgZmluYWwgTWFwPFN0cmluZywgTWFwcGluZ1RhZz4gX2Vs\nZW1zID0KICAgICAgICBuZXcgSGFzaE1hcDxTdHJpbmcsIE1hcHBpbmdUYWc+\nKCk7CgogICAgc3RhdGljIHsKICAgICAgICBfZWxlbXMucHV0KCJhc3NvY2lh\ndGlvbi1vdmVycmlkZSIsIEFTU09DX09WRVJSSURFKTsKICAgICAgICBfZWxl\nbXMucHV0KCJhdHRyaWJ1dGUtb3ZlcnJpZGUiLCBBVFRSX09WRVJSSURFKTsK\nICAgICAgICBfZWxlbXMucHV0KCJjb2x1bW4iLCBDT0wpOwogICAgICAgIF9l\nbGVtcy5wdXQoImNvbHVtbi1uYW1lIiwgQ09MVU1OX05BTUUpOwogICAgICAg\nIF9lbGVtcy5wdXQoImNvbHVtbi1yZXN1bHQiLCBDT0xVTU5fUkVTVUxUKTsK\nICAgICAgICBfZWxlbXMucHV0KCJkaXNjcmltaW5hdG9yLWNvbHVtbiIsIERJ\nU0NSSU1fQ09MKTsKICAgICAgICBfZWxlbXMucHV0KCJkaXNjcmltaW5hdG9y\nLXZhbHVlIiwgRElTQ1JJTV9WQUwpOwogICAgICAgIF9lbGVtcy5wdXQoImVu\ndGl0eS1yZXN1bHQiLCBFTlRJVFlfUkVTVUxUKTsKICAgICAgICBfZWxlbXMu\ncHV0KCJlbnVtZXJhdGVkIiwgRU5VTUVSQVRFRCk7CiAgICAgICAgX2VsZW1z\nLnB1dCgiZmllbGQtcmVzdWx0IiwgRklFTERfUkVTVUxUKTsKICAgICAgICBf\nZWxlbXMucHV0KCJpbmhlcml0YW5jZSIsIElOSEVSSVRBTkNFKTsKICAgICAg\nICBfZWxlbXMucHV0KCJqb2luLWNvbHVtbiIsIEpPSU5fQ09MKTsKICAgICAg\nICBfZWxlbXMucHV0KCJpbnZlcnNlLWpvaW4tY29sdW1uIiwgQ09MKTsKICAg\nICAgICBfZWxlbXMucHV0KCJqb2luLXRhYmxlIiwgSk9JTl9UQUJMRSk7CiAg\nICAgICAgX2VsZW1zLnB1dCgicHJpbWFyeS1rZXktam9pbi1jb2x1bW4iLCBQ\nS19KT0lOX0NPTCk7CiAgICAgICAgX2VsZW1zLnB1dCgic2Vjb25kYXJ5LXRh\nYmxlIiwgU0VDT05EQVJZX1RBQkxFKTsKICAgICAgICBfZWxlbXMucHV0KCJz\ncWwtcmVzdWx0LXNldC1tYXBwaW5nIiwgU1FMX1JFU1VMVF9TRVRfTUFQUElO\nRyk7CiAgICAgICAgX2VsZW1zLnB1dCgidGFibGUiLCBUQUJMRSk7CiAgICAg\nICAgX2VsZW1zLnB1dCgidGFibGUtZ2VuZXJhdG9yIiwgVEFCTEVfR0VOKTsK\nICAgICAgICBfZWxlbXMucHV0KCJ0ZW1wb3JhbCIsIFRFTVBPUkFMKTsKICAg\nICAgICBfZWxlbXMucHV0KCJ1bmlxdWUtY29uc3RyYWludCIsIFVOSVFVRSk7\nCiAgICB9CgogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgTG9jYWxpemVyIF9s\nb2MgPSBMb2NhbGl6ZXIuZm9yUGFja2FnZQogICAgICAgIChYTUxQZXJzaXN0\nZW5jZU1hcHBpbmdQYXJzZXIuY2xhc3MpOwoKICAgIHByaXZhdGUgU3RyaW5n\nIF9vdmVycmlkZSA9IG51bGw7CiAgICBwcml2YXRlIFN0cmluZyBfc2NoZW1h\nID0gbnVsbDsKICAgIHByaXZhdGUgU3RyaW5nIF9jb2xUYWJsZSA9IG51bGw7\nCiAgICBwcml2YXRlIFN0cmluZyBfc2Vjb25kYXJ5VGFibGUgPSBudWxsOwog\nICAgcHJpdmF0ZSBMaXN0PENvbHVtbj4gX2NvbHMgPSBudWxsOwogICAgcHJp\ndmF0ZSBMaXN0PENvbHVtbj4gX2pvaW5Db2xzID0gbnVsbDsKICAgIHByaXZh\ndGUgTGlzdDxDb2x1bW4+IF9zdXBKb2luQ29scyA9IG51bGw7CiAgICBwcml2\nYXRlIGJvb2xlYW4gX2xvYiA9IGZhbHNlOwogICAgcHJpdmF0ZSBUZW1wb3Jh\nbFR5cGUgX3RlbXBvcmFsID0gbnVsbDsKICAgIHByaXZhdGUgRW51bVNldDxV\nbmlxdWVGbGFnPiBfdW5pcXVlID0gRW51bVNldC5ub25lT2YoVW5pcXVlRmxh\nZy5jbGFzcyk7CiAgICBwcml2YXRlIERpc2NyaW1pbmF0b3JUeXBlIF9kaXNj\nVHlwZTsKICAgIHByaXZhdGUgQ29sdW1uIF9kaXNjQ29sOwogICAgcHJpdmF0\nZSBpbnQgX3Jlc3VsdElkeCA9IDA7CgogICAgLyoqCiAgICAgKiBDb25zdHJ1\nY3Rvcjsgc3VwcGx5IGNvbmZpZ3VyYXRpb24uCiAgICAgKi8KICAgIHB1Ymxp\nYyBYTUxQZXJzaXN0ZW5jZU1hcHBpbmdQYXJzZXIoSkRCQ0NvbmZpZ3VyYXRp\nb24gY29uZikgewogICAgICAgIHN1cGVyKGNvbmYpOwogICAgfQoKICAgIEBP\ndmVycmlkZQogICAgcHJvdGVjdGVkIHZvaWQgcmVzZXQoKSB7CiAgICAgICAg\nc3VwZXIucmVzZXQoKTsKICAgICAgICBjbGVhckNvbHVtbkluZm8oKTsKICAg\nICAgICBjbGVhckNsYXNzSW5mbygpOwogICAgICAgIGNsZWFyU2Vjb25kYXJ5\nVGFibGVJbmZvKCk7CiAgICAgICAgX292ZXJyaWRlID0gbnVsbDsKICAgICAg\nICBfc2NoZW1hID0gbnVsbDsKICAgICAgICBfcmVzdWx0SWR4ID0gMDsKICAg\nIH0KCiAgICBAT3ZlcnJpZGUKICAgIHByb3RlY3RlZCBPYmplY3Qgc3RhcnRT\neXN0ZW1NYXBwaW5nRWxlbWVudChTdHJpbmcgbmFtZSwgQXR0cmlidXRlcyBh\ndHRycykKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICBN\nYXBwaW5nVGFnIHRhZyA9IF9lbGVtcy5nZXQobmFtZSk7CiAgICAgICAgaWYg\nKHRhZyA9PSBudWxsKSB7CiAgICAgICAgICAgIGlmICgic2NoZW1hIi5lcXVh\nbHMobmFtZSkpCiAgICAgICAgICAgICAgICByZXR1cm4gbmFtZTsKICAgICAg\nICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgfQoKICAgICAgICBib29sZWFu\nIHJldDsKICAgICAgICBzd2l0Y2ggKHRhZykgewogICAgICAgICAgICBjYXNl\nIFRBQkxFX0dFTjoKICAgICAgICAgICAgICAgIHJldCA9IHN0YXJ0VGFibGVH\nZW5lcmF0b3IoYXR0cnMpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAg\nICAgICAgIGNhc2UgU1FMX1JFU1VMVF9TRVRfTUFQUElORzoKICAgICAgICAg\nICAgICAgIHJldCA9IHN0YXJ0U1FMUmVzdWx0U2V0TWFwcGluZyhhdHRycyk7\nCiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSBFTlRJ\nVFlfUkVTVUxUOgogICAgICAgICAgICAgICAgcmV0ID0gc3RhcnRFbnRpdHlS\nZXN1bHQoYXR0cnMpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAg\nICAgIGNhc2UgRklFTERfUkVTVUxUOgogICAgICAgICAgICAgICAgcmV0ID0g\nc3RhcnRGaWVsZFJlc3VsdChhdHRycyk7CiAgICAgICAgICAgICAgICBicmVh\nazsKICAgICAgICAgICAgY2FzZSBDT0xVTU5fUkVTVUxUOgogICAgICAgICAg\nICAgICAgcmV0ID0gc3RhcnRDb2x1bW5SZXN1bHQoYXR0cnMpOwogICAgICAg\nICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAg\nICAgICAgICByZXQgPSBmYWxzZTsKICAgICAgICB9CiAgICAgICAgcmV0dXJu\nIChyZXQpID8gdGFnIDogbnVsbDsKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAg\nIHByb3RlY3RlZCB2b2lkIGVuZFN5c3RlbU1hcHBpbmdFbGVtZW50KFN0cmlu\nZyBuYW1lKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24gewogICAgICAg\nIE1hcHBpbmdUYWcgdGFnID0gX2VsZW1zLmdldChuYW1lKTsKICAgICAgICBp\nZiAodGFnID09IG51bGwpIHsKICAgICAgICAgICAgaWYgKCJzY2hlbWEiLmVx\ndWFscyhuYW1lKSkKICAgICAgICAgICAgICAgIF9zY2hlbWEgPSBjdXJyZW50\nVGV4dCgpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAg\nICBzd2l0Y2ggKHRhZykgewogICAgICAgICAgICBjYXNlIFNRTF9SRVNVTFRf\nU0VUX01BUFBJTkc6CiAgICAgICAgICAgICAgICBlbmRTUUxSZXN1bHRTZXRN\nYXBwaW5nKCk7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAg\nY2FzZSBFTlRJVFlfUkVTVUxUOgogICAgICAgICAgICAgICAgZW5kRW50aXR5\nUmVzdWx0KCk7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICB9CiAg\nICB9CgogICAgQE92ZXJyaWRlCiAgICBwcm90ZWN0ZWQgT2JqZWN0IHN0YXJ0\nQ2xhc3NNYXBwaW5nRWxlbWVudChTdHJpbmcgbmFtZSwgQXR0cmlidXRlcyBh\ndHRycykKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICBN\nYXBwaW5nVGFnIHRhZyA9IF9lbGVtcy5nZXQobmFtZSk7CiAgICAgICAgaWYg\nKHRhZyA9PSBudWxsKQogICAgICAgICAgICByZXR1cm4gbnVsbDsKCiAgICAg\nICAgYm9vbGVhbiByZXQ7CiAgICAgICAgc3dpdGNoICh0YWcpIHsKICAgICAg\nICAgICAgY2FzZSBUQUJMRToKICAgICAgICAgICAgICAgIHJldCA9IHN0YXJ0\nVGFibGUoYXR0cnMpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAg\nICAgIGNhc2UgU0VDT05EQVJZX1RBQkxFOgogICAgICAgICAgICAgICAgcmV0\nID0gc3RhcnRTZWNvbmRhcnlUYWJsZShhdHRycyk7CiAgICAgICAgICAgICAg\nICBicmVhazsKICAgICAgICAgICAgY2FzZSBESVNDUklNX0NPTDoKICAgICAg\nICAgICAgICAgIHBhcnNlRGlzY3JpbWluYXRvckNvbHVtbihhdHRycyk7CiAg\nICAgICAgICAgICAgICBfZGlzY0NvbCA9IHBhcnNlQ29sdW1uKGF0dHJzKTsK\nICAgICAgICAgICAgICAgIHJldCA9IHRydWU7CiAgICAgICAgICAgICAgICBi\ncmVhazsKICAgICAgICAgICAgY2FzZSBESVNDUklNX1ZBTDoKICAgICAgICAg\nICAgICAgIHJldCA9IHRydWU7CiAgICAgICAgICAgICAgICBicmVhazsKICAg\nICAgICAgICAgY2FzZSBJTkhFUklUQU5DRToKICAgICAgICAgICAgICAgIHJl\ndCA9IHN0YXJ0SW5oZXJpdGFuY2UoYXR0cnMpOwogICAgICAgICAgICAgICAg\nYnJlYWs7CiAgICAgICAgICAgIGNhc2UgQVNTT0NfT1ZFUlJJREU6CiAgICAg\nICAgICAgIGNhc2UgQVRUUl9PVkVSUklERToKICAgICAgICAgICAgICAgIHJl\ndCA9IHN0YXJ0QXR0cmlidXRlT3ZlcnJpZGUoYXR0cnMpOwogICAgICAgICAg\nICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgUEtfSk9JTl9DT0w6CiAg\nICAgICAgICAgICAgICByZXQgPSBzdGFydFByaW1hcnlLZXlKb2luQ29sdW1u\nKGF0dHJzKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBj\nYXNlIENPTDoKICAgICAgICAgICAgICAgIHJldCA9IHN0YXJ0Q29sdW1uKGF0\ndHJzKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNl\nIEpPSU5fQ09MOgogICAgICAgICAgICAgICAgcmV0ID0gc3RhcnRKb2luQ29s\ndW1uKGF0dHJzKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAg\nICBjYXNlIEpPSU5fVEFCTEU6CiAgICAgICAgICAgICAgICByZXQgPSBzdGFy\ndEpvaW5UYWJsZShhdHRycyk7CiAgICAgICAgICAgICAgICBicmVhazsKICAg\nICAgICAgICAgY2FzZSBUQUJMRV9HRU46CiAgICAgICAgICAgICAgICByZXQg\nPSBzdGFydFRhYmxlR2VuZXJhdG9yKGF0dHJzKTsKICAgICAgICAgICAgICAg\nIGJyZWFrOwogICAgICAgICAgICBjYXNlIFVOSVFVRToKICAgICAgICAgICAg\nICAgIHJldCA9IHN0YXJ0VW5pcXVlQ29uc3RyYWludChhdHRycyk7CiAgICAg\nICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSBURU1QT1JBTDoK\nICAgICAgICAgICAgY2FzZSBFTlVNRVJBVEVEOgogICAgICAgICAgICAgICAg\ncmV0ID0gdHJ1ZTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAg\nICBjYXNlIFNRTF9SRVNVTFRfU0VUX01BUFBJTkc6CiAgICAgICAgICAgICAg\nICByZXQgPSBzdGFydFNRTFJlc3VsdFNldE1hcHBpbmcoYXR0cnMpOwogICAg\nICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgRU5USVRZX1JF\nU1VMVDoKICAgICAgICAgICAgICAgIHJldCA9IHN0YXJ0RW50aXR5UmVzdWx0\nKGF0dHJzKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBj\nYXNlIEZJRUxEX1JFU1VMVDoKICAgICAgICAgICAgICAgIHJldCA9IHN0YXJ0\nRmllbGRSZXN1bHQoYXR0cnMpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAg\nICAgICAgICAgIGNhc2UgQ09MVU1OX1JFU1VMVDoKICAgICAgICAgICAgICAg\nIHJldCA9IHN0YXJ0Q29sdW1uUmVzdWx0KGF0dHJzKTsKICAgICAgICAgICAg\nICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIENPTFVNTl9OQU1FOgogICAg\nICAgICAgICAgICAgcmV0ID0gdHJ1ZTsKICAgICAgICAgICAgICAgIGJyZWFr\nOwogICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgICAgcmV0ID0g\nZmFsc2U7CiAgICAgICAgfQogICAgICAgIHJldHVybiAocmV0KSA/IHRhZyA6\nIG51bGw7CiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwcm90ZWN0ZWQgdm9p\nZCBlbmRDbGFzc01hcHBpbmdFbGVtZW50KFN0cmluZyBuYW1lKQogICAgICAg\nIHRocm93cyBTQVhFeGNlcHRpb24gewogICAgICAgIE1hcHBpbmdUYWcgdGFn\nID0gX2VsZW1zLmdldChuYW1lKTsKICAgICAgICBpZiAodGFnID09IG51bGwp\nCiAgICAgICAgICAgIHJldHVybjsKCiAgICAgICAgc3dpdGNoICh0YWcpIHsK\nICAgICAgICAgICAgY2FzZSBTRUNPTkRBUllfVEFCTEU6CiAgICAgICAgICAg\nICAgICBlbmRTZWNvbmRhcnlUYWJsZSgpOwogICAgICAgICAgICAgICAgYnJl\nYWs7CiAgICAgICAgICAgIGNhc2UgRElTQ1JJTV9WQUw6CiAgICAgICAgICAg\nICAgICBlbmREaXNjcmltaW5hdG9yVmFsdWUoKTsKICAgICAgICAgICAgICAg\nIGJyZWFrOwogICAgICAgICAgICBjYXNlIEFUVFJfT1ZFUlJJREU6CiAgICAg\nICAgICAgICAgICBlbmRBdHRyaWJ1dGVPdmVycmlkZSgpOwogICAgICAgICAg\nICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgSk9JTl9UQUJMRToKICAg\nICAgICAgICAgICAgIGVuZEpvaW5UYWJsZSgpOwogICAgICAgICAgICAgICAg\nYnJlYWs7CiAgICAgICAgICAgIGNhc2UgVEVNUE9SQUw6CiAgICAgICAgICAg\nICAgICBlbmRUZW1wb3JhbCgpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAg\nICAgICAgICAgIGNhc2UgRU5VTUVSQVRFRDoKICAgICAgICAgICAgICAgIGVu\nZEVudW1lcmF0ZWQoKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAg\nICAgICBjYXNlIFNRTF9SRVNVTFRfU0VUX01BUFBJTkc6CiAgICAgICAgICAg\nICAgICBlbmRTUUxSZXN1bHRTZXRNYXBwaW5nKCk7CiAgICAgICAgICAgICAg\nICBicmVhazsKICAgICAgICAgICAgY2FzZSBFTlRJVFlfUkVTVUxUOgogICAg\nICAgICAgICAgICAgZW5kRW50aXR5UmVzdWx0KCk7CiAgICAgICAgICAgICAg\nICBicmVhazsKICAgICAgICAgICAgY2FzZSBVTklRVUU6CiAgICAgICAgICAg\nICAgICBlbmRVbmlxdWVDb25zdHJhaW50KCk7CiAgICAgICAgICAgICAgICBi\ncmVhazsKICAgICAgICAgICAgY2FzZSBDT0xVTU5fTkFNRToKICAgICAgICAg\nICAgICAgIGVuZENvbHVtbk5hbWUoKTsKICAgICAgICAgICAgICAgIGJyZWFr\nOwogICAgICAgIH0KICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHByb3RlY3Rl\nZCB2b2lkIHN0YXJ0Q2xhc3NNYXBwaW5nKENsYXNzTWV0YURhdGEgbWV0YSwg\nYm9vbGVhbiBtYXBwZWRTdXBlciwKICAgICAgICBBdHRyaWJ1dGVzIGF0dHJz\nKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24gewogICAgICAgIGlmICht\nYXBwZWRTdXBlcikKICAgICAgICAgICAgKChDbGFzc01hcHBpbmcpIG1ldGEp\nLmdldE1hcHBpbmdJbmZvKCkuc2V0U3RyYXRlZ3kKICAgICAgICAgICAgICAg\nIChOb25lQ2xhc3NTdHJhdGVneS5BTElBUyk7CiAgICB9CgogICAgQE92ZXJy\naWRlCiAgICBwcm90ZWN0ZWQgdm9pZCBlbmRDbGFzc01hcHBpbmcoQ2xhc3NN\nZXRhRGF0YSBtZXRhKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24gewog\nICAgICAgIENsYXNzTWFwcGluZyBjbSA9IChDbGFzc01hcHBpbmcpIG1ldGE7\nCiAgICAgICAgaWYgKF9zY2hlbWEgIT0gbnVsbCkKICAgICAgICAgICAgY20u\nZ2V0TWFwcGluZ0luZm8oKS5zZXRTY2hlbWFOYW1lKF9zY2hlbWEpOwoKICAg\nICAgICBpZiAoX3N1cEpvaW5Db2xzICE9IG51bGwpCiAgICAgICAgICAgIGNt\nLmdldE1hcHBpbmdJbmZvKCkuc2V0Q29sdW1ucyhfc3VwSm9pbkNvbHMpOwoK\nICAgICAgICBpZiAoX2Rpc2NDb2wgIT0gbnVsbCkgewogICAgICAgICAgICBE\naXNjcmltaW5hdG9yTWFwcGluZ0luZm8gZGluZm8gPSBjbS5nZXREaXNjcmlt\naW5hdG9yKCkKICAgICAgICAgICAgICAgICAgICAuZ2V0TWFwcGluZ0luZm8o\nKTsKICAgICAgICAgICAgc3dpdGNoIChfZGlzY1R5cGUpIHsKICAgICAgICAg\nICAgICAgIGNhc2UgQ0hBUjoKICAgICAgICAgICAgICAgICAgICBfZGlzY0Nv\nbC5zZXRKYXZhVHlwZShKYXZhVHlwZXMuQ0hBUik7CiAgICAgICAgICAgICAg\nICAgICAgY20uZ2V0RGlzY3JpbWluYXRvcigpLnNldEphdmFUeXBlKEphdmFU\neXBlcy5DSEFSKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAg\nICAgICAgICAgIGNhc2UgSU5URUdFUjoKICAgICAgICAgICAgICAgICAgICBf\nZGlzY0NvbC5zZXRKYXZhVHlwZShKYXZhVHlwZXMuSU5UKTsKICAgICAgICAg\nICAgICAgICAgICBjbS5nZXREaXNjcmltaW5hdG9yKCkuc2V0SmF2YVR5cGUo\nSmF2YVR5cGVzLklOVCk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAg\nICAgICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgICAgICAgIF9k\naXNjQ29sLnNldEphdmFUeXBlKEphdmFUeXBlcy5TVFJJTkcpOwogICAgICAg\nICAgICAgICAgICAgIGNtLmdldERpc2NyaW1pbmF0b3IoKS5zZXRKYXZhVHlw\nZShKYXZhVHlwZXMuU1RSSU5HKTsKICAgICAgICAgICAgICAgICAgICBicmVh\nazsKICAgICAgICAgICAgfQogICAgICAgICAgICBkaW5mby5zZXRDb2x1bW5z\nKEFycmF5cy5hc0xpc3QobmV3IENvbHVtbltdeyBfZGlzY0NvbCB9KSk7CiAg\nICAgICAgfQogICAgICAgIGNsZWFyQ2xhc3NJbmZvKCk7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBDbGVhciBjYWNoZWQgY2xhc3MgbWFwcGluZyBpbmZvLgog\nICAgICovCiAgICBwcml2YXRlIHZvaWQgY2xlYXJDbGFzc0luZm8oKSB7CiAg\nICAgICAgX3N1cEpvaW5Db2xzID0gbnVsbDsKICAgICAgICBfZGlzY0NvbCA9\nIG51bGw7CiAgICAgICAgX2Rpc2NUeXBlID0gbnVsbDsKICAgIH0KCiAgICAv\nKioKICAgICAqIFN0YXJ0IHRyYWNraW5nIHNlY29uZGFyeSB0YWJsZSBpbmZv\ncm1hdGlvbiBhbmQgY29sdW1ucwogICAgICovCiAgICBwcml2YXRlIGJvb2xl\nYW4gc3RhcnRTZWNvbmRhcnlUYWJsZShBdHRyaWJ1dGVzIGF0dHJzKQogICAg\nICAgIHRocm93cyBTQVhFeGNlcHRpb24gewogICAgICAgIF9zZWNvbmRhcnlU\nYWJsZSA9IHRvVGFibGVOYW1lKGF0dHJzLmdldFZhbHVlKCJzY2hlbWEiKSwK\nICAgICAgICAgICAgYXR0cnMuZ2V0VmFsdWUoIm5hbWUiKSk7CiAgICAgICAg\ncmV0dXJuIHRydWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBTZXQgdGhlIHNl\nY29uZGFyeSB0YWJsZSBpbmZvcm1hdGlvbiBiYWNrIHRvIHRoZSBvd25pbmcg\nY2xhc3MgbWFwcGluZy4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIGVuZFNl\nY29uZGFyeVRhYmxlKCkgewogICAgICAgIENsYXNzTWFwcGluZyBjbSA9IChD\nbGFzc01hcHBpbmcpIGN1cnJlbnRFbGVtZW50KCk7CiAgICAgICAgQ2xhc3NN\nYXBwaW5nSW5mbyBpbmZvID0gY20uZ2V0TWFwcGluZ0luZm8oKTsKICAgICAg\nICBpbmZvLnNldFNlY29uZGFyeVRhYmxlSm9pbkNvbHVtbnMoX3NlY29uZGFy\neVRhYmxlLCBfam9pbkNvbHMpOwogICAgICAgIGNsZWFyU2Vjb25kYXJ5VGFi\nbGVJbmZvKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBDbGVhciBjYWNoZWQg\nc2Vjb25kYXJ5IHRhYmxlIGluZm8uCiAgICAgKi8KICAgIHByaXZhdGUgdm9p\nZCBjbGVhclNlY29uZGFyeVRhYmxlSW5mbygpIHsKICAgICAgICBfam9pbkNv\nbHMgPSBudWxsOwogICAgICAgIF9zZWNvbmRhcnlUYWJsZSA9IG51bGw7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBQYXJzZSB0YWJsZS1nZW5lcmF0b3IuCiAg\nICAgKi8KICAgIHByaXZhdGUgYm9vbGVhbiBzdGFydFRhYmxlR2VuZXJhdG9y\nKEF0dHJpYnV0ZXMgYXR0cnMpIHsKICAgICAgICBTdHJpbmcgbmFtZSA9IGF0\ndHJzLmdldFZhbHVlKCJuYW1lIik7CiAgICAgICAgTG9nIGxvZyA9IGdldExv\nZygpOwogICAgICAgIGlmIChsb2cuaXNUcmFjZUVuYWJsZWQoKSkKICAgICAg\nICAgICAgbG9nLnRyYWNlKF9sb2MuZ2V0KCJwYXJzZS1nZW4iLCBuYW1lKSk7\nCiAgICAgICAgaWYgKGdldFJlcG9zaXRvcnkoKS5nZXRDYWNoZWRTZXF1ZW5j\nZU1ldGFEYXRhKG5hbWUpICE9IG51bGwKICAgICAgICAgICAgJiYgbG9nLmlz\nV2FybkVuYWJsZWQoKSkKICAgICAgICAgICAgbG9nLndhcm4oX2xvYy5nZXQo\nIm92ZXJyaWRlLWdlbiIsIG5hbWUpKTsKCiAgICAgICAgU2VxdWVuY2VNYXBw\naW5nIHNlcSA9IChTZXF1ZW5jZU1hcHBpbmcpIGdldFJlcG9zaXRvcnkoKS4K\nICAgICAgICAgICAgYWRkU2VxdWVuY2VNZXRhRGF0YShuYW1lKTsKICAgICAg\nICBzZXEuc2V0U2VxdWVuY2VQbHVnaW4oU2VxdWVuY2VNYXBwaW5nLklNUExf\nVkFMVUVfVEFCTEUpOwogICAgICAgIHNlcS5zZXRUYWJsZSh0b1RhYmxlTmFt\nZShhdHRycy5nZXRWYWx1ZSgic2NoZW1hIiksCiAgICAgICAgICAgIGF0dHJz\nLmdldFZhbHVlKCJ0YWJsZSIpKSk7CiAgICAgICAgc2VxLnNldFByaW1hcnlL\nZXlDb2x1bW4oYXR0cnMuZ2V0VmFsdWUoInBrLWNvbHVtbi1uYW1lIikpOwog\nICAgICAgIHNlcS5zZXRTZXF1ZW5jZUNvbHVtbihhdHRycy5nZXRWYWx1ZSgi\ndmFsdWUtY29sdW1uLW5hbWUiKSk7CiAgICAgICAgc2VxLnNldFByaW1hcnlL\nZXlWYWx1ZShhdHRycy5nZXRWYWx1ZSgicGstY29sdW1uLXZhbHVlIikpOwog\nICAgICAgIFN0cmluZyB2YWwgPSBhdHRycy5nZXRWYWx1ZSgiaW5pdGlhbC12\nYWx1ZSIpOwogICAgICAgIGlmICh2YWwgIT0gbnVsbCkKICAgICAgICAgICAg\nc2VxLnNldEluaXRpYWxWYWx1ZShJbnRlZ2VyLnBhcnNlSW50KHZhbCkpOwog\nICAgICAgIHZhbCA9IGF0dHJzLmdldFZhbHVlKCJhbGxvY2F0aW9uLXNpemUi\nKTsKICAgICAgICBpZiAodmFsICE9IG51bGwpCiAgICAgICAgICAgIHNlcS5z\nZXRBbGxvY2F0ZShJbnRlZ2VyLnBhcnNlSW50KHZhbCkpOwoKICAgICAgICBP\nYmplY3QgY3VyID0gY3VycmVudEVsZW1lbnQoKTsKICAgICAgICBPYmplY3Qg\nc2NvcGUgPSAoY3VyIGluc3RhbmNlb2YgQ2xhc3NNZXRhRGF0YSkKICAgICAg\nICAgICAgPyAoKENsYXNzTWV0YURhdGEpIGN1cikuZ2V0RGVzY3JpYmVkVHlw\nZSgpIDogbnVsbDsKICAgICAgICBzZXEuc2V0U291cmNlKGdldFNvdXJjZUZp\nbGUoKSwgc2NvcGUsIHNlcS5TUkNfWE1MKTsKICAgICAgICByZXR1cm4gdHJ1\nZTsKICAgIH0KCiAgICAvKioKICAgICAqIFBhcnNlIGluaGVyaXRhbmNlLgog\nICAgICovCiAgICBwcml2YXRlIGJvb2xlYW4gc3RhcnRJbmhlcml0YW5jZShB\ndHRyaWJ1dGVzIGF0dHJzKSB7CiAgICAgICAgU3RyaW5nIHZhbCA9IGF0dHJz\nLmdldFZhbHVlKCJzdHJhdGVneSIpOwogICAgICAgIGlmICh2YWwgPT0gbnVs\nbCkKICAgICAgICAgICAgcmV0dXJuIHRydWU7CgogICAgICAgIENsYXNzTWFw\ncGluZyBjbSA9IChDbGFzc01hcHBpbmcpIGN1cnJlbnRFbGVtZW50KCk7CiAg\nICAgICAgQ2xhc3NNYXBwaW5nSW5mbyBpbmZvID0gY20uZ2V0TWFwcGluZ0lu\nZm8oKTsKICAgICAgICBzd2l0Y2ggKEVudW0udmFsdWVPZihJbmhlcml0YW5j\nZVR5cGUuY2xhc3MsIHZhbCkpIHsKICAgICAgICAgICAgY2FzZSBTSU5HTEVf\nVEFCTEU6CiAgICAgICAgICAgICAgICBpbmZvLnNldEhpZXJhcmNoeVN0cmF0\nZWd5KEZsYXRDbGFzc1N0cmF0ZWd5LkFMSUFTKTsKICAgICAgICAgICAgICAg\nIGJyZWFrOwogICAgICAgICAgICBjYXNlIEpPSU5FRDoKICAgICAgICAgICAg\nICAgIGluZm8uc2V0SGllcmFyY2h5U3RyYXRlZ3koVmVydGljYWxDbGFzc1N0\ncmF0ZWd5LkFMSUFTKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAg\nICAgICBjYXNlIFRBQkxFX1BFUl9DTEFTUzoKICAgICAgICAgICAgICAgIGlu\nZm8uc2V0SGllcmFyY2h5U3RyYXRlZ3koRnVsbENsYXNzU3RyYXRlZ3kuQUxJ\nQVMpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICAg\nIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qKgogICAgICogUGFyc2UgZGlz\nY3JpbWluYXRvci12YWx1ZS4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIGVu\nZERpc2NyaW1pbmF0b3JWYWx1ZSgpIHsKICAgICAgICBTdHJpbmcgdmFsID0g\nY3VycmVudFRleHQoKTsKICAgICAgICBpZiAoU3RyaW5nVXRpbHMuaXNFbXB0\neSh2YWwpKQogICAgICAgICAgICByZXR1cm47CgogICAgICAgIENsYXNzTWFw\ncGluZyBjbSA9IChDbGFzc01hcHBpbmcpIGN1cnJlbnRFbGVtZW50KCk7CiAg\nICAgICAgY20uZ2V0RGlzY3JpbWluYXRvcigpLmdldE1hcHBpbmdJbmZvKCku\nc2V0VmFsdWUodmFsKTsKCiAgICAgICAgaWYgKE1vZGlmaWVyLmlzQWJzdHJh\nY3QoY20uZ2V0RGVzY3JpYmVkVHlwZSgpLmdldE1vZGlmaWVycygpKQogICAg\nICAgICAgICAgICAgJiYgZ2V0TG9nKCkuaXNJbmZvRW5hYmxlZCgpKSB7CiAg\nICAgICAgICAgIGdldExvZygpLmluZm8oCiAgICAgICAgICAgICAgICAgICAg\nX2xvYy5nZXQoImRpc2NyaW1pbmF0b3Itb24tYWJzdHJhY3QtY2xhc3MiLCBj\nbQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLmdldERlc2NyaWJlZFR5\ncGUoKS5nZXROYW1lKCkpKTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAg\nICAgKiBQYXJzZSB0ZW1wb3JhbC4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lk\nIGVuZFRlbXBvcmFsKCkgewogICAgICAgIFN0cmluZyB0ZW1wID0gY3VycmVu\ndFRleHQoKTsKICAgICAgICBpZiAoIVN0cmluZ1V0aWxzLmlzRW1wdHkodGVt\ncCkpCiAgICAgICAgICAgIF90ZW1wb3JhbCA9IEVudW0udmFsdWVPZihUZW1w\nb3JhbFR5cGUuY2xhc3MsIHRlbXApOwogICAgfQoKICAgIC8qKgogICAgICog\nUGFyc2UgZW51bWVyYXRlZC4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIGVu\nZEVudW1lcmF0ZWQoKSB7CiAgICAgICAgU3RyaW5nIHRleHQgPSBjdXJyZW50\nVGV4dCgpOwogICAgICAgIGlmIChTdHJpbmdVdGlscy5pc0VtcHR5KHRleHQp\nKQogICAgICAgICAgICByZXR1cm47CiAgICAgICAgRW51bVR5cGUgdHlwZSA9\nIEVudW0udmFsdWVPZihFbnVtVHlwZS5jbGFzcywgdGV4dCk7CgogICAgICAg\nIEZpZWxkTWFwcGluZyBmbSA9IChGaWVsZE1hcHBpbmcpIGN1cnJlbnRFbGVt\nZW50KCk7CiAgICAgICAgU3RyaW5nIHN0cmF0ID0gRW51bVZhbHVlSGFuZGxl\nci5jbGFzcy5nZXROYW1lKCkgKyAiKFN0b3JlT3JkaW5hbD0iCiAgICAgICAg\nICAgICsgU3RyaW5nLnZhbHVlT2YodHlwZSA9PSBFbnVtVHlwZS5PUkRJTkFM\nKSArICIpIjsKICAgICAgICBmbS5nZXRWYWx1ZUluZm8oKS5zZXRTdHJhdGVn\neShzdHJhdCk7CiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwcm90ZWN0ZWQg\nYm9vbGVhbiBzdGFydExvYihBdHRyaWJ1dGVzIGF0dHJzKQogICAgICAgIHRo\ncm93cyBTQVhFeGNlcHRpb24gewogICAgICAgIGlmIChzdXBlci5zdGFydExv\nYihhdHRycykpIHsKICAgICAgICAgICAgX2xvYiA9IHRydWU7CiAgICAgICAg\nICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KICAgICAgICByZXR1cm4gZmFs\nc2U7CiAgICB9CgogICAgLyoqCiAgICAgKiBFeHRlbmQgdG8gY2xlYXIgYW5u\nb3RhdGlvbiBtYXBwaW5nIGluZm8uCiAgICAgKi8KICAgIEBPdmVycmlkZQog\nICAgcHJvdGVjdGVkIHZvaWQgc3RhcnRGaWVsZE1hcHBpbmcoRmllbGRNZXRh\nRGF0YSBmaWVsZCwgQXR0cmlidXRlcyBhdHRycykKICAgICAgICB0aHJvd3Mg\nU0FYRXhjZXB0aW9uIHsKICAgICAgICBzdXBlci5zdGFydEZpZWxkTWFwcGlu\nZyhmaWVsZCwgYXR0cnMpOwogICAgICAgIGlmIChnZXRBbm5vdGF0aW9uUGFy\nc2VyKCkgIT0gbnVsbCkgewogICAgICAgICAgICBGaWVsZE1hcHBpbmcgZm0g\nPSAoRmllbGRNYXBwaW5nKSBmaWVsZDsKICAgICAgICAgICAgZm0uZ2V0TWFw\ncGluZ0luZm8oKS5jbGVhcigpOwogICAgICAgICAgICBmbS5nZXRWYWx1ZUlu\nZm8oKS5jbGVhcigpOwogICAgICAgICAgICBmbS5nZXRFbGVtZW50TWFwcGlu\nZygpLmdldFZhbHVlSW5mbygpLmNsZWFyKCk7CiAgICAgICAgICAgIGZtLmdl\ndEtleU1hcHBpbmcoKS5nZXRWYWx1ZUluZm8oKS5jbGVhcigpOwogICAgICAg\nIH0KICAgIH0KCiAgICAvKioKICAgICAqIEV4dGVuZCB0byBzZXQgdGhlIGNv\nbHVtbnMuCiAgICAgKi8KICAgIEBPdmVycmlkZQogICAgcHJvdGVjdGVkIHZv\naWQgZW5kRmllbGRNYXBwaW5nKEZpZWxkTWV0YURhdGEgZmllbGQpCiAgICAg\nICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgLy8gc2V0dXAgY29s\ndW1ucyB3aXRoIGNhY2hlZCBsb2IgYW5kIHRlbXBvcmFsIGluZm8KICAgICAg\nICBGaWVsZE1hcHBpbmcgZm0gPSAoRmllbGRNYXBwaW5nKSBmaWVsZDsKICAg\nICAgICBpZiAoX2xvYiB8fCBfdGVtcG9yYWwgIT0gbnVsbCkgewogICAgICAg\nICAgICBpZiAoX2NvbHMgPT0gbnVsbCkgewogICAgICAgICAgICAgICAgX2Nv\nbHMgPSBuZXcgQXJyYXlMaXN0PENvbHVtbj4oMSk7CiAgICAgICAgICAgICAg\nICBfY29scy5hZGQobmV3IENvbHVtbigpKTsKICAgICAgICAgICAgfQogICAg\nICAgICAgICBmb3IgKENvbHVtbiBjb2wgOiBfY29scykgewogICAgICAgICAg\nICAgICAgaWYgKF9sb2IgJiYgKGZtLmdldERlY2xhcmVkVHlwZUNvZGUoKSA9\nPSBKYXZhVHlwZXMuU1RSSU5HCiAgICAgICAgICAgICAgICAgICAgfHwgZm0u\nZ2V0RGVjbGFyZWRUeXBlKCkgPT0gY2hhcltdLmNsYXNzCiAgICAgICAgICAg\nICAgICAgICAgfHwgZm0uZ2V0RGVjbGFyZWRUeXBlKCkgPT0gQ2hhcmFjdGVy\nW10uY2xhc3MpKSB7CiAgICAgICAgICAgICAgICAgICAgY29sLnNldFNpemUo\nLTEpOwogICAgICAgICAgICAgICAgICAgIGNvbC5zZXRUeXBlKFR5cGVzLkNM\nT0IpOwogICAgICAgICAgICAgICAgfSBlbHNlIGlmIChfbG9iKQogICAgICAg\nICAgICAgICAgICAgIGNvbC5zZXRUeXBlKFR5cGVzLkJMT0IpOwogICAgICAg\nICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChf\ndGVtcG9yYWwpIHsKICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBEQVRF\nOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sLnNldFR5cGUoVHlw\nZXMuREFURSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsK\nICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBUSU1FOgogICAgICAgICAg\nICAgICAgICAgICAgICAgICAgY29sLnNldFR5cGUoVHlwZXMuVElNRSk7CiAg\nICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAg\nICAgICAgICAgICAgY2FzZSBUSU1FU1RBTVA6CiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICBjb2wuc2V0VHlwZShUeXBlcy5USU1FU1RBTVApOwogICAg\nICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAg\nICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAg\nICAgfQoKICAgICAgICBpZiAoX2NvbHMgIT0gbnVsbCkgewogICAgICAgICAg\nICBzd2l0Y2ggKGZtLmdldERlY2xhcmVkVHlwZUNvZGUoKSkgewogICAgICAg\nICAgICAgICAgY2FzZSBKYXZhVHlwZXMuQVJSQVk6CiAgICAgICAgICAgICAg\nICAgICAgaWYgKGZtLmdldERlY2xhcmVkVHlwZSgpID09IGJ5dGVbXS5jbGFz\ncwogICAgICAgICAgICAgICAgICAgICAgICB8fCBmbS5nZXREZWNsYXJlZFR5\ncGUoKSA9PSBjaGFyW10uY2xhc3MKICAgICAgICAgICAgICAgICAgICAgICAg\nfHwgZm0uZ2V0RGVjbGFyZWRUeXBlKCkgPT0gQ2hhcmFjdGVyW10uY2xhc3Mp\nIHsKICAgICAgICAgICAgICAgICAgICAgICAgZm0uZ2V0VmFsdWVJbmZvKCku\nc2V0Q29sdW1ucyhfY29scyk7CiAgICAgICAgICAgICAgICAgICAgICAgIGJy\nZWFrOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAg\nICAvLyBlbHNlIG5vIGJyZWFrCiAgICAgICAgICAgICAgICBjYXNlIEphdmFU\neXBlcy5DT0xMRUNUSU9OOgogICAgICAgICAgICAgICAgY2FzZSBKYXZhVHlw\nZXMuTUFQOgogICAgICAgICAgICAgICAgICAgIGZtLmdldEVsZW1lbnRNYXBw\naW5nKCkuZ2V0VmFsdWVJbmZvKCkuc2V0Q29sdW1ucyhfY29scyk7CiAgICAg\nICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBkZWZhdWx0\nOgogICAgICAgICAgICAgICAgICAgIGZtLmdldFZhbHVlSW5mbygpLnNldENv\nbHVtbnMoX2NvbHMpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmIChf\nY29sVGFibGUgIT0gbnVsbCkKICAgICAgICAgICAgICAgIGZtLmdldE1hcHBp\nbmdJbmZvKCkuc2V0VGFibGVOYW1lKF9jb2xUYWJsZSk7CiAgICAgICAgICAg\nIHNldFVuaXF1ZShmbSk7CiAgICAgICAgfQogICAgICAgIGNsZWFyQ29sdW1u\nSW5mbygpOwogICAgfQoKICAgIC8qKgogICAgICogU2V0IHVuaXF1ZSBmb3Ig\nZmllbGQuCiAgICAgKi8KICAgIHByaXZhdGUgdm9pZCBzZXRVbmlxdWUoRmll\nbGRNYXBwaW5nIGZtKSB7CiAgICAgICAgaWYgKF91bmlxdWUuc2l6ZSgpID09\nIDIpIC8vIGkuZS4gVFJVRSAmIEZBTFNFCiAgICAgICAgICAgIGdldExvZygp\nLndhcm4oX2xvYy5nZXQoImluY29uc2lzdC1jb2wtYXR0cnMiLCBmbSkpOwog\nICAgICAgIGVsc2UgaWYgKF91bmlxdWUuY29udGFpbnMoVW5pcXVlRmxhZy5U\nUlVFKSkKICAgICAgICAgICAgZm0uZ2V0VmFsdWVJbmZvKCkuc2V0VW5pcXVl\nKG5ldyBVbmlxdWUoKSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBDbGVhciBm\naWVsZCBsZXZlbCBjb2x1bW4gaW5mb3JtYXRpb24uCiAgICAgKi8KICAgIHBy\naXZhdGUgdm9pZCBjbGVhckNvbHVtbkluZm8oKSB7CiAgICAgICAgX2NvbHMg\nPSBudWxsOwogICAgICAgIF9qb2luQ29scyA9IG51bGw7CiAgICAgICAgX2Nv\nbFRhYmxlID0gbnVsbDsKICAgICAgICBfbG9iID0gZmFsc2U7CiAgICAgICAg\nX3RlbXBvcmFsID0gbnVsbDsKICAgICAgICBfdW5pcXVlLmNsZWFyKCk7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBQYXJzZSBhdHRyaWJ1dGUtb3ZlcnJpZGUu\nCiAgICAgKi8KICAgIHByaXZhdGUgYm9vbGVhbiBzdGFydEF0dHJpYnV0ZU92\nZXJyaWRlKEF0dHJpYnV0ZXMgYXR0cikgewogICAgICAgIF9vdmVycmlkZSA9\nIGF0dHIuZ2V0VmFsdWUoIm5hbWUiKTsKICAgICAgICByZXR1cm4gdHJ1ZTsK\nICAgIH0KCiAgICAvKioKICAgICAqIFNldCBhdHRyaWJ1dGUgb3ZlcnJpZGUg\naW50byBwcm9wZXIgbWFwcGluZy4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lk\nIGVuZEF0dHJpYnV0ZU92ZXJyaWRlKCkKICAgICAgICB0aHJvd3MgU0FYRXhj\nZXB0aW9uIHsKICAgICAgICBPYmplY3QgZWxlbSA9IGN1cnJlbnRFbGVtZW50\nKCk7CiAgICAgICAgRmllbGRNYXBwaW5nIGZtOwogICAgICAgIGlmIChlbGVt\nIGluc3RhbmNlb2YgQ2xhc3NNYXBwaW5nKQogICAgICAgICAgICBmbSA9IGdl\ndEF0dHJpYnV0ZU92ZXJyaWRlKChDbGFzc01hcHBpbmcpIGVsZW0pOwogICAg\nICAgIGVsc2UKICAgICAgICAgICAgZm0gPSBnZXRBdHRyaWJ1dGVPdmVycmlk\nZSgoRmllbGRNYXBwaW5nKSBlbGVtKTsKICAgICAgICBpZiAoX2NvbHMgIT0g\nbnVsbCkgewogICAgICAgICAgICBmbS5nZXRWYWx1ZUluZm8oKS5zZXRDb2x1\nbW5zKF9jb2xzKTsKICAgICAgICAgICAgaWYgKF9jb2xUYWJsZSAhPSBudWxs\nKQogICAgICAgICAgICAgICAgZm0uZ2V0TWFwcGluZ0luZm8oKS5zZXRUYWJs\nZU5hbWUoX2NvbFRhYmxlKTsKICAgICAgICAgICAgc2V0VW5pcXVlKGZtKTsK\nICAgICAgICB9CiAgICAgICAgY2xlYXJDb2x1bW5JbmZvKCk7CiAgICAgICAg\nX292ZXJyaWRlID0gbnVsbDsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVy\nbiB0aGUgcHJvcGVyIG92ZXJyaWRlLgogICAgICovCiAgICBwcml2YXRlIEZp\nZWxkTWFwcGluZyBnZXRBdHRyaWJ1dGVPdmVycmlkZShDbGFzc01hcHBpbmcg\nY20pIHsKICAgICAgICBGaWVsZE1hcHBpbmcgc3VwID0gKEZpZWxkTWFwcGlu\nZykgY20uZ2V0RGVmaW5lZFN1cGVyY2xhc3NGaWVsZAogICAgICAgICAgICAo\nX292ZXJyaWRlKTsKICAgICAgICBpZiAoc3VwID09IG51bGwpCiAgICAgICAg\nICAgIHN1cCA9IChGaWVsZE1hcHBpbmcpIGNtLmFkZERlZmluZWRTdXBlcmNs\nYXNzRmllbGQoX292ZXJyaWRlLAogICAgICAgICAgICAgICAgT2JqZWN0LmNs\nYXNzLCBPYmplY3QuY2xhc3MpOwogICAgICAgIHJldHVybiBzdXA7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIHByb3BlciBvdmVycmlkZS4K\nICAgICAqLwogICAgcHJpdmF0ZSBGaWVsZE1hcHBpbmcgZ2V0QXR0cmlidXRl\nT3ZlcnJpZGUoRmllbGRNYXBwaW5nIGZtKQogICAgICAgIHRocm93cyBTQVhF\neGNlcHRpb24gewogICAgICAgIENsYXNzTWFwcGluZyBlbWJlZCA9IGZtLmdl\ndEVtYmVkZGVkTWFwcGluZygpOwogICAgICAgIGlmIChlbWJlZCA9PSBudWxs\nKQogICAgICAgICAgICB0aHJvdyBnZXRFeGNlcHRpb24oX2xvYy5nZXQoIm5v\ndC1lbWJlZGRlZCIsIGZtKSk7CgogICAgICAgIEZpZWxkTWFwcGluZyBlZm0g\nPSBlbWJlZC5nZXRGaWVsZE1hcHBpbmcoX292ZXJyaWRlKTsKICAgICAgICBp\nZiAoZWZtID09IG51bGwpCiAgICAgICAgICAgIHRocm93IGdldEV4Y2VwdGlv\nbihfbG9jLmdldCgiZW1iZWQtb3ZlcnJpZGUtbmFtZSIsCiAgICAgICAgICAg\nICAgICBmbSwgX292ZXJyaWRlKSk7CiAgICAgICAgcmV0dXJuIGVmbTsKICAg\nIH0KCiAgICAvKioKICAgICAqIFBhcnNlIHRhYmxlLgogICAgICovCiAgICBw\ncml2YXRlIGJvb2xlYW4gc3RhcnRUYWJsZShBdHRyaWJ1dGVzIGF0dHJzKQog\nICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24gewogICAgICAgIFN0cmluZyB0\nYWJsZSA9IHRvVGFibGVOYW1lKGF0dHJzLmdldFZhbHVlKCJzY2hlbWEiKSwK\nICAgICAgICAgICAgYXR0cnMuZ2V0VmFsdWUoIm5hbWUiKSk7CiAgICAgICAg\naWYgKHRhYmxlICE9IG51bGwpCiAgICAgICAgICAgICgoQ2xhc3NNYXBwaW5n\nKSBjdXJyZW50RWxlbWVudCgpKS5nZXRNYXBwaW5nSW5mbygpLnNldFRhYmxl\nTmFtZQogICAgICAgICAgICAgICAgKHRhYmxlKTsKICAgICAgICByZXR1cm4g\ndHJ1ZTsKICAgIH0KCiAgICAvKioKICAgICAqIFBhcnNlIGpvaW4tdGFibGUu\nCiAgICAgKi8KICAgIHByaXZhdGUgYm9vbGVhbiBzdGFydEpvaW5UYWJsZShB\ndHRyaWJ1dGVzIGF0dHJzKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24g\newogICAgICAgIFN0cmluZyB0YWJsZSA9IHRvVGFibGVOYW1lKGF0dHJzLmdl\ndFZhbHVlKCJzY2hlbWEiKSwKICAgICAgICAgICAgYXR0cnMuZ2V0VmFsdWUo\nIm5hbWUiKSk7CiAgICAgICAgaWYgKHRhYmxlICE9IG51bGwpCiAgICAgICAg\nICAgICgoRmllbGRNYXBwaW5nKSBjdXJyZW50RWxlbWVudCgpKS5nZXRNYXBw\naW5nSW5mbygpLnNldFRhYmxlTmFtZQogICAgICAgICAgICAgICAgKHRhYmxl\nKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvKioKICAgICAq\nIFNldCB0aGUgam9pbiB0YWJsZSBpbmZvcm1hdGlvbiBiYWNrLgogICAgICov\nCiAgICBwcml2YXRlIHZvaWQgZW5kSm9pblRhYmxlKCkgewogICAgICAgIEZp\nZWxkTWFwcGluZyBmbSA9IChGaWVsZE1hcHBpbmcpIGN1cnJlbnRFbGVtZW50\nKCk7CiAgICAgICAgaWYgKF9qb2luQ29scyAhPSBudWxsKQogICAgICAgICAg\nICBmbS5nZXRNYXBwaW5nSW5mbygpLnNldENvbHVtbnMoX2pvaW5Db2xzKTsK\nICAgICAgICBpZiAoX2NvbHMgIT0gbnVsbCkKICAgICAgICAgICAgZm0uZ2V0\nRWxlbWVudE1hcHBpbmcoKS5nZXRWYWx1ZUluZm8oKS5zZXRDb2x1bW5zKF9j\nb2xzKTsKICAgICAgICBjbGVhckNvbHVtbkluZm8oKTsKICAgIH0KCiAgICAv\nKioKICAgICAqIFBhcnNlIHByaW1hcnkta2V5LWpvaW4tY29sdW1uLgogICAg\nICovCiAgICBwcml2YXRlIGJvb2xlYW4gc3RhcnRQcmltYXJ5S2V5Sm9pbkNv\nbHVtbihBdHRyaWJ1dGVzIGF0dHJzKQogICAgICAgIHRocm93cyBTQVhFeGNl\ncHRpb24gewogICAgICAgIENvbHVtbiBjb2wgPSBwYXJzZUNvbHVtbihhdHRy\ncyk7CiAgICAgICAgY29sLnNldEZsYWcoQ29sdW1uLkZMQUdfUEtfSk9JTiwg\ndHJ1ZSk7CiAgICAgICAgLy8gcGsgam9pbiBjb2x1bW5zIG9uIGZpZWxkcyBh\nY3QgYXMgZmllbGQgY29scwogICAgICAgIGlmIChjdXJyZW50RWxlbWVudCgp\nIGluc3RhbmNlb2YgRmllbGRNYXBwaW5nKSB7CiAgICAgICAgICAgIGlmIChf\nY29scyA9PSBudWxsKQogICAgICAgICAgICAgICAgX2NvbHMgPSBuZXcgQXJy\nYXlMaXN0PENvbHVtbj4oMyk7CiAgICAgICAgICAgIF9jb2xzLmFkZChjb2wp\nOwogICAgICAgIH0gZWxzZSBpZiAoY3VycmVudFBhcmVudCgpID09IFNFQ09O\nREFSWV9UQUJMRSkgewogICAgICAgICAgICAvLyBwayBqb2luIGNvbHVtbnMg\naW4gc2Vjb25kYXJ5IHRhYmxlIGFjdHMgYXMgam9pbiBjb2xzCiAgICAgICAg\nICAgIGlmIChfam9pbkNvbHMgPT0gbnVsbCkKICAgICAgICAgICAgICAgIF9q\nb2luQ29scyA9IG5ldyBBcnJheUxpc3Q8Q29sdW1uPigzKTsKICAgICAgICAg\nICAgX2pvaW5Db2xzLmFkZChjb2wpOwogICAgICAgIH0gZWxzZSB7CiAgICAg\nICAgICAgIC8vIG11c3QgYmUgcGsgam9pbiBjb2xzIGZyb20gdGhpcyBjbGFz\ncyB0byBzdXBlcmNsYXNzCiAgICAgICAgICAgIGlmIChfc3VwSm9pbkNvbHMg\nPT0gbnVsbCkKICAgICAgICAgICAgICAgIF9zdXBKb2luQ29scyA9IG5ldyBB\ncnJheUxpc3Q8Q29sdW1uPigzKTsKICAgICAgICAgICAgX3N1cEpvaW5Db2xz\nLmFkZChjb2wpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gdHJ1ZTsKICAg\nIH0KCiAgICAvKioKICAgICAqIFBhcnNlIGpvaW4tY29sdW1uLgogICAgICov\nCiAgICBwcml2YXRlIGJvb2xlYW4gc3RhcnRKb2luQ29sdW1uKEF0dHJpYnV0\nZXMgYXR0cnMpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAg\nICAgLy8gb25seSBqb2luIGNvbHMgaW4gYSBqb2luIHRhYmxlIGpvaW4gZmll\nbGQgdGFibGUgdG8gY2xhc3MgdGFibGU7CiAgICAgICAgLy8gb3RoZXJzIGFj\ndCBhcyBkYXRhIGZrIGNvbHMKICAgICAgICBpZiAoY3VycmVudFBhcmVudCgp\nICE9IEpPSU5fVEFCTEUpCiAgICAgICAgICAgIHJldHVybiBzdGFydENvbHVt\nbihhdHRycyk7CgogICAgICAgIGlmIChfam9pbkNvbHMgPT0gbnVsbCkKICAg\nICAgICAgICAgX2pvaW5Db2xzID0gbmV3IEFycmF5TGlzdDxDb2x1bW4+KDMp\nOwogICAgICAgIF9qb2luQ29scy5hZGQocGFyc2VDb2x1bW4oYXR0cnMpKTsK\nICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvKioKICAgICAqIFBh\ncnNlIGNvbHVtbi4KICAgICAqLwogICAgcHJpdmF0ZSBib29sZWFuIHN0YXJ0\nQ29sdW1uKEF0dHJpYnV0ZXMgYXR0cnMpCiAgICAgICAgdGhyb3dzIFNBWEV4\nY2VwdGlvbiB7CiAgICAgICAgaWYgKF9jb2xzID09IG51bGwpCiAgICAgICAg\nICAgIF9jb2xzID0gbmV3IEFycmF5TGlzdDxDb2x1bW4+KDMpOwogICAgICAg\nIF9jb2xzLmFkZChwYXJzZUNvbHVtbihhdHRycykpOwogICAgICAgIHJldHVy\nbiB0cnVlOwogICAgfQoKICAgIC8qKgogICAgICogQ3JlYXRlIGEgY29sdW1u\nIHdpdGggdGhlIGdpdmVuIGF0dHJpYnV0ZXMuCiAgICAgKi8KICAgIHByaXZh\ndGUgQ29sdW1uIHBhcnNlQ29sdW1uKEF0dHJpYnV0ZXMgYXR0cnMpCiAgICAg\nICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgQ29sdW1uIGNvbCA9\nIG5ldyBDb2x1bW4oKTsKICAgICAgICBTdHJpbmcgdmFsID0gYXR0cnMuZ2V0\nVmFsdWUoIm5hbWUiKTsKICAgICAgICBpZiAodmFsICE9IG51bGwpCiAgICAg\nICAgICAgIGNvbC5zZXROYW1lKHZhbCk7CiAgICAgICAgdmFsID0gYXR0cnMu\nZ2V0VmFsdWUoInJlZmVyZW5jZWQtY29sdW1uLW5hbWUiKTsKICAgICAgICBp\nZiAodmFsICE9IG51bGwpCiAgICAgICAgICAgIGNvbC5zZXRUYXJnZXQodmFs\nKTsKICAgICAgICB2YWwgPSBhdHRycy5nZXRWYWx1ZSgiY29sdW1uLWRlZmlu\naXRpb24iKTsKICAgICAgICBpZiAodmFsICE9IG51bGwpCiAgICAgICAgICAg\nIGNvbC5zZXRUeXBlTmFtZSh2YWwpOwogICAgICAgIHZhbCA9IGF0dHJzLmdl\ndFZhbHVlKCJwcmVjaXNpb24iKTsKICAgICAgICBpZiAodmFsICE9IG51bGwp\nCiAgICAgICAgICAgIGNvbC5zZXRTaXplKEludGVnZXIucGFyc2VJbnQodmFs\nKSk7CiAgICAgICAgdmFsID0gYXR0cnMuZ2V0VmFsdWUoImxlbmd0aCIpOwog\nICAgICAgIGlmICh2YWwgIT0gbnVsbCkKICAgICAgICAgICAgY29sLnNldFNp\nemUoSW50ZWdlci5wYXJzZUludCh2YWwpKTsKICAgICAgICB2YWwgPSBhdHRy\ncy5nZXRWYWx1ZSgic2NhbGUiKTsKICAgICAgICBpZiAodmFsICE9IG51bGwp\nCiAgICAgICAgICAgIGNvbC5zZXREZWNpbWFsRGlnaXRzKEludGVnZXIucGFy\nc2VJbnQodmFsKSk7CiAgICAgICAgdmFsID0gYXR0cnMuZ2V0VmFsdWUoIm51\nbGxhYmxlIik7CiAgICAgICAgaWYgKHZhbCAhPSBudWxsKQogICAgICAgICAg\nICBjb2wuc2V0Tm90TnVsbCgiZmFsc2UiLmVxdWFscyh2YWwpKTsKICAgICAg\nICB2YWwgPSBhdHRycy5nZXRWYWx1ZSgiaW5zZXJ0YWJsZSIpOwogICAgICAg\nIGlmICh2YWwgIT0gbnVsbCkKICAgICAgICAgICAgY29sLnNldEZsYWcoQ29s\ndW1uLkZMQUdfVU5JTlNFUlRBQkxFLCAiZmFsc2UiLmVxdWFscyh2YWwpKTsK\nICAgICAgICB2YWwgPSBhdHRycy5nZXRWYWx1ZSgidXBkYXRhYmxlIik7CiAg\nICAgICAgaWYgKHZhbCAhPSBudWxsKQogICAgICAgICAgICBjb2wuc2V0Rmxh\nZyhDb2x1bW4uRkxBR19VTlVQREFUQUJMRSwgImZhbHNlIi5lcXVhbHModmFs\nKSk7CgogICAgICAgIHZhbCA9IGF0dHJzLmdldFZhbHVlKCJ1bmlxdWUiKTsK\nICAgICAgICBpZiAodmFsICE9IG51bGwpCiAgICAgICAgICAgIF91bmlxdWUu\nYWRkKEVudW0udmFsdWVPZihVbmlxdWVGbGFnLmNsYXNzLCB2YWwudG9VcHBl\nckNhc2UoKSkpOwogICAgICAgIHZhbCA9IGF0dHJzLmdldFZhbHVlKCJ0YWJs\nZSIpOwogICAgICAgIGlmICh2YWwgIT0gbnVsbCkgewogICAgICAgICAgICBp\nZiAoX2NvbFRhYmxlICE9IG51bGwgJiYgIV9jb2xUYWJsZS5lcXVhbHModmFs\nKSkKICAgICAgICAgICAgICAgIHRocm93IGdldEV4Y2VwdGlvbihfbG9jLmdl\ndCgic2Vjb25kLWluY29uc2lzdCIsCiAgICAgICAgICAgICAgICAgICAgY3Vy\ncmVudEVsZW1lbnQoKSkpOwogICAgICAgICAgICBfY29sVGFibGUgPSB2YWw7\nCiAgICAgICAgfQogICAgICAgIHJldHVybiBjb2w7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBSZXR1cm4gYSB0YWJsZSBuYW1lIGZvciB0aGUgZ2l2ZW4gYXR0\ncmlidXRlcy4KICAgICAqLwogICAgcHJpdmF0ZSBTdHJpbmcgdG9UYWJsZU5h\nbWUoU3RyaW5nIHNjaGVtYSwgU3RyaW5nIHRhYmxlKSB7CiAgICAgICAgaWYg\nKFN0cmluZ1V0aWxzLmlzRW1wdHkodGFibGUpKQogICAgICAgICAgICByZXR1\ncm4gbnVsbDsKICAgICAgICBpZiAoU3RyaW5nVXRpbHMuaXNFbXB0eShzY2hl\nbWEpKQogICAgICAgICAgICBzY2hlbWEgPSBfc2NoZW1hOwogICAgICAgIHJl\ndHVybiAoU3RyaW5nVXRpbHMuaXNFbXB0eShzY2hlbWEpKSA/IHRhYmxlIDog\nc2NoZW1hICsgIi4iICsgdGFibGU7CiAgICB9CgogICAgLyoqCiAgICAgKiBT\ndGFydCBwcm9jZXNzaW5nIDxjb2RlPnNxbC1yZXN1bHQtc2V0LW1hcHBpbmc8\nL2NvZGU+IG5vZGUuCiAgICAgKiBQdXNoZXMgdGhlIHtAbGluayBRdWVyeVJl\nc3VsdE1hcHBpbmd9IG9udG8gdGhlIHN0YWNrIGFzIGN1cnJlbnQgZWxlbWVu\ndC4KICAgICAqLwogICAgcHJpdmF0ZSBib29sZWFuIHN0YXJ0U1FMUmVzdWx0\nU2V0TWFwcGluZyhBdHRyaWJ1dGVzIGF0dHJzKSB7CiAgICAgICAgU3RyaW5n\nIG5hbWUgPSBhdHRycy5nZXRWYWx1ZSgibmFtZSIpOwogICAgICAgIExvZyBs\nb2cgPSBnZXRMb2coKTsKICAgICAgICBpZiAobG9nLmlzVHJhY2VFbmFibGVk\nKCkpCiAgICAgICAgICAgIGxvZy50cmFjZShfbG9jLmdldCgicGFyc2Utc3Fs\ncnNtYXBwaW5nIiwgbmFtZSkpOwoKICAgICAgICBNYXBwaW5nUmVwb3NpdG9y\neSByZXBvcyA9IChNYXBwaW5nUmVwb3NpdG9yeSkgZ2V0UmVwb3NpdG9yeSgp\nOwogICAgICAgIFF1ZXJ5UmVzdWx0TWFwcGluZyByZXN1bHQgPSByZXBvcy5n\nZXRDYWNoZWRRdWVyeVJlc3VsdE1hcHBpbmcKICAgICAgICAgICAgKG51bGws\nIG5hbWUpOwogICAgICAgIGlmIChyZXN1bHQgIT0gbnVsbCAmJiBsb2cuaXNX\nYXJuRW5hYmxlZCgpKQogICAgICAgICAgICBsb2cud2FybihfbG9jLmdldCgi\nb3ZlcnJpZGUtc3FscnNtYXBwaW5nIiwgbmFtZSwKICAgICAgICAgICAgICAg\nIGN1cnJlbnRMb2NhdGlvbigpKSk7CgogICAgICAgIHJlc3VsdCA9IHJlcG9z\nLmFkZFF1ZXJ5UmVzdWx0TWFwcGluZyhudWxsLCBuYW1lKTsKICAgICAgICBy\nZXN1bHQuc2V0TGlzdGluZ0luZGV4KF9yZXN1bHRJZHgrKyk7CiAgICAgICAg\nYWRkQ29tbWVudHMocmVzdWx0KTsKCiAgICAgICAgT2JqZWN0IGN1ciA9IGN1\ncnJlbnRFbGVtZW50KCk7CiAgICAgICAgT2JqZWN0IHNjb3BlID0gKGN1ciBp\nbnN0YW5jZW9mIENsYXNzTWV0YURhdGEpCiAgICAgICAgICAgID8gKChDbGFz\nc01ldGFEYXRhKSBjdXIpLmdldERlc2NyaWJlZFR5cGUoKSA6IG51bGw7CiAg\nICAgICAgcmVzdWx0LnNldFNvdXJjZShnZXRTb3VyY2VGaWxlKCksIHNjb3Bl\nLCByZXN1bHQuU1JDX1hNTCk7CgogICAgICAgIHB1c2hFbGVtZW50KHJlc3Vs\ndCk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgcHJpdmF0ZSB2\nb2lkIGVuZFNRTFJlc3VsdFNldE1hcHBpbmcoKQogICAgICAgIHRocm93cyBT\nQVhFeGNlcHRpb24gewogICAgICAgIHBvcEVsZW1lbnQoKTsKICAgIH0KCiAg\nICAvKioKICAgICAqIFN0YXJ0IHByb2Nlc3NpbmcgPGNvZGU+ZW50aXR5LXJl\nc3VsdDwvY29kZT4gbm9kZS4KICAgICAqIFB1c2hlcyB0aGUge0BsaW5rIFF1\nZXJ5UmVzdWx0TWFwcGluZy5QQ1Jlc3VsdH0KICAgICAqIG9udG8gdGhlIHN0\nYWNrIGFzIGN1cnJlbnQgZWxlbWVudC4KICAgICAqLwogICAgcHJpdmF0ZSBi\nb29sZWFuIHN0YXJ0RW50aXR5UmVzdWx0KEF0dHJpYnV0ZXMgYXR0cnMpCiAg\nICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgQ2xhc3MgZW50\naXR5Q2xhc3MgPSBjbGFzc0Zvck5hbWUoYXR0cnMuZ2V0VmFsdWUoImVudGl0\neS1jbGFzcyIpKTsKICAgICAgICBTdHJpbmcgZGlzY3JpbWluYXRvciA9IGF0\ndHJzLmdldFZhbHVlKCJkaXNjcmltaW5hdG9yLWNvbHVtbiIpOwoKICAgICAg\nICBRdWVyeVJlc3VsdE1hcHBpbmcgcGFyZW50ID0gKFF1ZXJ5UmVzdWx0TWFw\ncGluZykgY3VycmVudEVsZW1lbnQoKTsKICAgICAgICBRdWVyeVJlc3VsdE1h\ncHBpbmcuUENSZXN1bHQgcmVzdWx0ID0gcGFyZW50LmFkZFBDUmVzdWx0KGVu\ndGl0eUNsYXNzKTsKICAgICAgICBpZiAoIVN0cmluZ1V0aWxzLmlzRW1wdHko\nZGlzY3JpbWluYXRvcikpCiAgICAgICAgICAgIHJlc3VsdC5hZGRNYXBwaW5n\nKHJlc3VsdC5ESVNDUklNSU5BVE9SLCBkaXNjcmltaW5hdG9yKTsKICAgICAg\nICBwdXNoRWxlbWVudChyZXN1bHQpOwogICAgICAgIHJldHVybiB0cnVlOwog\nICAgfQoKICAgIHByaXZhdGUgdm9pZCBlbmRFbnRpdHlSZXN1bHQoKQogICAg\nICAgIHRocm93cyBTQVhFeGNlcHRpb24gewogICAgICAgIHBvcEVsZW1lbnQo\nKTsKICAgIH0KCiAgICAvKioKICAgICAqIFByb2Nlc3MgYSA8Y29kZT5maWVs\nZC1yZXN1bHQ8L2NvZGU+IG5vZGUuCiAgICAgKi8KICAgIHByaXZhdGUgYm9v\nbGVhbiBzdGFydEZpZWxkUmVzdWx0KEF0dHJpYnV0ZXMgYXR0cnMpCiAgICAg\nICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgU3RyaW5nIGZpZWxk\nTmFtZSA9IGF0dHJzLmdldFZhbHVlKCJuYW1lIik7CiAgICAgICAgU3RyaW5n\nIGNvbHVtbk5hbWUgPSBhdHRycy5nZXRWYWx1ZSgiY29sdW1uIik7CgogICAg\nICAgIFF1ZXJ5UmVzdWx0TWFwcGluZy5QQ1Jlc3VsdCBwYXJlbnQgPSAoUXVl\ncnlSZXN1bHRNYXBwaW5nLlBDUmVzdWx0KQogICAgICAgICAgICBjdXJyZW50\nRWxlbWVudCgpOwogICAgICAgIHBhcmVudC5hZGRNYXBwaW5nKGZpZWxkTmFt\nZSwgY29sdW1uTmFtZSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBQcm9jZXNzIGEgPGNvZGU+Y29sdW1uLXJlc3VsdDwv\nY29kZT4gbm9kZS4KICAgICAqLwogICAgcHJpdmF0ZSBib29sZWFuIHN0YXJ0\nQ29sdW1uUmVzdWx0KEF0dHJpYnV0ZXMgYXR0cnMpCiAgICAgICAgdGhyb3dz\nIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgUXVlcnlSZXN1bHRNYXBwaW5nIHBh\ncmVudCA9IChRdWVyeVJlc3VsdE1hcHBpbmcpIGN1cnJlbnRFbGVtZW50KCk7\nCiAgICAgICAgcGFyZW50LmFkZENvbHVtblJlc3VsdChhdHRycy5nZXRWYWx1\nZSgibmFtZSIpKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAv\nKiogCiAgICAgKiBTdGFydHMgcHJvY2Vzc2luZyAmbHQ7dW5pcXVlLWNvbnN0\ncmFpbnQmZ3Q7IHByb3ZpZGVkIHRoZSB0YWcgb2NjdXJzCiAgICAgKiB3aXRo\naW4gYSBDbGFzc01hcHBpbmcgZWxlbWVudCBhbmQgPGVtPm5vdDwvZW0+IHdp\ndGhpbiBhIHNlY29uZGFyeQogICAgICogdGFibGUuIAogICAgICogUHVzaGVz\nIHRoZSBVbmlxdWUgZWxlbWVudCBpbiB0aGUgc3RhY2suCiAgICAgKi8KICAg\nIHByaXZhdGUgYm9vbGVhbiBzdGFydFVuaXF1ZUNvbnN0cmFpbnQoQXR0cmli\ndXRlcyBhdHRycykgCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAg\nICAgICAgT2JqZWN0IGN1cnJlbnQgPSBjdXJyZW50RWxlbWVudCgpOwogICAg\nICAgIGlmIChjdXJyZW50IGluc3RhbmNlb2YgQ2xhc3NNYXBwaW5nICYmIF9z\nZWNvbmRhcnlUYWJsZSA9PSBudWxsKSB7CiAgICAgICAgICAgIFVuaXF1ZSB1\nbmlxdWUgPSBuZXcgVW5pcXVlKCk7CiAgICAgICAgICAgIHB1c2hFbGVtZW50\nKHVuaXF1ZSk7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0g\nCiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQogICAgCiAgICAvKioKICAg\nICAqIEVuZHMgcHJvY2Vzc2luZyAmbHQ7dW5pcXVlLWNvbnN0cmFpbnQmZ3Q7\nIHByb3ZpZGVkIHRoZSB0YWcgb2NjdXJzCiAgICAgKiB3aXRoaW4gYSBDbGFz\nc01hcHBpbmcgZWxlbWVudCBhbmQgPGVtPm5vdDwvZW0+IHdpdGhpbiBhIHNl\nY29uZGFyeQogICAgICogdGFibGUuIFRoZSBzdGFjayBpcyBwb3BwZWQgYW5k\nIHRoZSBVbmlxdWUgZWxlbWVudCBpcyBhZGRlZCB0byB0aGUKICAgICAqIENs\nYXNzTWFwcGluZ0luZm8uIAogICAgICovCiAgICBwcml2YXRlIHZvaWQgZW5k\nVW5pcXVlQ29uc3RyYWludCgpIHsKICAgICAgICBVbmlxdWUgdW5pcXVlID0g\nKFVuaXF1ZSkgcG9wRWxlbWVudCgpOwogICAgICAgIE9iamVjdCBjdXJyZW50\nID0gY3VycmVudEVsZW1lbnQoKTsKICAgICAgICBpZiAoY3VycmVudCBpbnN0\nYW5jZW9mIENsYXNzTWFwcGluZyAmJiBfc2Vjb25kYXJ5VGFibGUgPT0gbnVs\nbCkKICAgICAgICAgICAgKChDbGFzc01hcHBpbmcpIGN1cnJlbnQpLmdldE1h\ncHBpbmdJbmZvKCkuYWRkVW5pcXVlKHVuaXF1ZSk7CiAgICB9CiAgICAKICAg\nIC8qKgogICAgICogRW5kcyBwcm9jZXNzaW5nICZsdDtjb2x1bW4tbmFtZSZn\ndDsgdGFnIGJ5IGFkZGluZyB0aGUgY29sdW1uIG5hbWUgaW4KICAgICAqIHRo\nZSBjdXJyZW50IFVuaXF1ZSBlbGVtZW50IHRoYXQgcmVzaWRlcyBpbiB0aGUg\ndG9wIG9mIHRoZSBzdGFjay4KICAgICAqLwogICAgcHJpdmF0ZSBib29sZWFu\nIGVuZENvbHVtbk5hbWUoKSB7CiAgICAgICAgT2JqZWN0IGN1cnJlbnQgPSBj\ndXJyZW50RWxlbWVudCgpOwogICAgICAgIGlmIChjdXJyZW50IGluc3RhbmNl\nb2YgVW5pcXVlKSB7CiAgICAgICAgICAgIFVuaXF1ZSB1bmlxdWUgPSAoVW5p\ncXVlKSBjdXJyZW50OwogICAgICAgICAgICBDb2x1bW4gY29sdW1uID0gbmV3\nIENvbHVtbigpOwogICAgICAgICAgICBjb2x1bW4uc2V0TmFtZSh0aGlzLmN1\ncnJlbnRUZXh0KCkpOwogICAgICAgICAgICB1bmlxdWUuYWRkQ29sdW1uKGNv\nbHVtbik7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KICAg\nICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgICAKICAgIC8qKgogICAgICog\nVHJhY2sgdW5pcXVlIGNvbHVtbiBzZXR0aW5ncy4KCSAqLwoJcHJpdmF0ZSBz\ndGF0aWMgZW51bSBVbmlxdWVGbGFnCgl7CgkJVFJVRSwKCQlGQUxTRQoJfQoJ\nCglwcml2YXRlIHZvaWQgcGFyc2VEaXNjcmltaW5hdG9yQ29sdW1uKEF0dHJp\nYnV0ZXMgYXR0cnMpIHsgCgkgICAgU3RyaW5nIHZhbCA9IGF0dHJzLmdldFZh\nbHVlKCJkaXNjcmltaW5hdG9yLXR5cGUiKTsKICAgICAgICBpZiAodmFsICE9\nIG51bGwpIHsKICAgICAgICAgICAgX2Rpc2NUeXBlID0gRW51bS52YWx1ZU9m\nKERpc2NyaW1pbmF0b3JUeXBlLmNsYXNzLCB2YWwpOwogICAgICAgIH0KICAg\nICAgICBlbHNlIHsKICAgICAgICAgICAgX2Rpc2NUeXBlID0gRGlzY3JpbWlu\nYXRvclR5cGUuU1RSSU5HOwogICAgICAgIH0KICAgICAgICAgICAgCgl9Cn0K\n","encoding":"base64"}

