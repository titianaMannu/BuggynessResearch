{"sha":"4ef989f9239f955f9ef8889f2359ecdba49a9fb1","node_id":"MDQ6QmxvYjIwNjM2NDo0ZWY5ODlmOTIzOWY5NTVmOWVmODg4OWYyMzU5ZWNkYmE0OWE5ZmIx","size":6084,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/4ef989f9239f955f9ef8889f2359ecdba49a9fb1","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UudGVzdDsK\nCmltcG9ydCBqYXZhLmxhbmcucmVmbGVjdC5Nb2RpZmllcjsKaW1wb3J0IGph\ndmEudXRpbC5BcnJheUxpc3Q7CmltcG9ydCBqYXZhLnV0aWwuSXRlcmF0b3I7\nCmltcG9ydCBqYXZhLnV0aWwuTGlzdDsKaW1wb3J0IGphdmEudXRpbC5NYXA7\nCmltcG9ydCBqYXZhLnV0aWwuSGFzaE1hcDsKaW1wb3J0IGphdmF4LnBlcnNp\nc3RlbmNlLkVudGl0eU1hbmFnZXI7CmltcG9ydCBqYXZheC5wZXJzaXN0ZW5j\nZS5FbnRpdHlNYW5hZ2VyRmFjdG9yeTsKaW1wb3J0IGphdmF4LnBlcnNpc3Rl\nbmNlLlBlcnNpc3RlbmNlOwoKaW1wb3J0IGp1bml0LmZyYW1ld29yay5UZXN0\nQ2FzZTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuQWJzdHJh\nY3RCcm9rZXJGYWN0b3J5OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmtl\ncm5lbC5Ccm9rZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YS5D\nbGFzc01ldGFEYXRhOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNp\nc3RlbmNlLk9wZW5KUEFFbnRpdHlNYW5hZ2VyRmFjdG9yeVNQSTsKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5KUEFGYWNhZGVIZWxw\nZXI7CgovKioKICogQmFzZSB0ZXN0IGNsYXNzIHByb3ZpZGluZyBwZXJzaXN0\nZW5jZSB1dGlsaXRpZXMuCiAqLwpwdWJsaWMgYWJzdHJhY3QgY2xhc3MgUGVy\nc2lzdGVuY2VUZXN0Q2FzZQogICAgZXh0ZW5kcyBUZXN0Q2FzZSB7CgogICAg\nLyoqCiAgICAgKiBNYXJrZXIgb2JqZWN0IHlvdSBhbiBwYXNzIHRvIHtAbGlu\nayAjc2V0VXB9IHRvIGluZGljYXRlIHRoYXQgdGhlCiAgICAgKiBkYXRhYmFz\nZSB0YWJsZXMgc2hvdWxkIGJlIGNsZWFyZWQuCiAgICAgKi8KICAgIHByb3Rl\nY3RlZCBzdGF0aWMgZmluYWwgT2JqZWN0IENMRUFSX1RBQkxFUyA9IG5ldyBP\nYmplY3QoKTsKCiAgICAvKioKICAgICAqIENyZWF0ZSBhbiBlbnRpdHkgbWFu\nYWdlciBmYWN0b3J5LiBQdXQge0BsaW5rICNDTEVBUl9UQUJMRVN9IGluCiAg\nICAgKiB0aGlzIGxpc3QgdG8gdGVsbCB0aGUgdGVzdCBmcmFtZXdvcmsgdG8g\nZGVsZXRlIGFsbCB0YWJsZSBjb250ZW50cwogICAgICogYmVmb3JlIHJ1bm5p\nbmcgdGhlIHRlc3RzLgogICAgICoKICAgICAqIEBwYXJhbSBwcm9wcyBsaXN0\nIG9mIHBlcnNpc3RlbnQgdHlwZXMgdXNlZCBpbiB0ZXN0aW5nIGFuZC9vciAK\nICAgICAqIGNvbmZpZ3VyYXRpb24gdmFsdWVzIGluIHRoZSBmb3JtIGtleSx2\nYWx1ZSxrZXksdmFsdWUuLi4KICAgICAqLwogICAgcHJvdGVjdGVkIE9wZW5K\nUEFFbnRpdHlNYW5hZ2VyRmFjdG9yeVNQSSBjcmVhdGVFTUYoT2JqZWN0Li4u\nIHByb3BzKSB7CiAgICAgICAgTWFwIG1hcCA9IG5ldyBIYXNoTWFwKFN5c3Rl\nbS5nZXRQcm9wZXJ0aWVzKCkpOwogICAgICAgIExpc3Q8Q2xhc3M+IHR5cGVz\nID0gbmV3IEFycmF5TGlzdDxDbGFzcz4oKTsKICAgICAgICBib29sZWFuIHBy\nb3AgPSBmYWxzZTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IHByb3Bz\nLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGlmIChwcm9wKSB7CiAgICAg\nICAgICAgICAgICBtYXAucHV0KHByb3BzW2kgLSAxXSwgcHJvcHNbaV0pOwog\nICAgICAgICAgICAgICAgcHJvcCA9IGZhbHNlOwogICAgICAgICAgICB9IGVs\nc2UgaWYgKHByb3BzW2ldID09IENMRUFSX1RBQkxFUykgewogICAgICAgICAg\nICAgICAgbWFwLnB1dCgib3BlbmpwYS5qZGJjLlN5bmNocm9uaXplTWFwcGlu\nZ3MiLAogICAgICAgICAgICAgICAgICAgICJidWlsZFNjaGVtYShGb3JlaWdu\nS2V5cz10cnVlLCIgCiAgICAgICAgICAgICAgICAgICAgKyAiU2NoZW1hQWN0\naW9uPSdhZGQsZGVsZXRlVGFibGVDb250ZW50cycpIik7CiAgICAgICAgICAg\nIH0gZWxzZSBpZiAocHJvcHNbaV0gaW5zdGFuY2VvZiBDbGFzcykKICAgICAg\nICAgICAgICAgIHR5cGVzLmFkZCgoQ2xhc3MpIHByb3BzW2ldKTsKICAgICAg\nICAgICAgZWxzZQogICAgICAgICAgICAgICAgcHJvcCA9IHRydWU7CiAgICAg\nICAgfQoKICAgICAgICBpZiAoIXR5cGVzLmlzRW1wdHkoKSkgewogICAgICAg\nICAgICBTdHJpbmdCdWZmZXIgYnVmID0gbmV3IFN0cmluZ0J1ZmZlcigpOwog\nICAgICAgICAgICBmb3IgKENsYXNzIGMgOiB0eXBlcykgewogICAgICAgICAg\nICAgICAgaWYgKGJ1Zi5sZW5ndGgoKSA+IDApCiAgICAgICAgICAgICAgICAg\nICAgYnVmLmFwcGVuZCgiOyIpOwogICAgICAgICAgICAgICAgYnVmLmFwcGVu\nZChjLmdldE5hbWUoKSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgbWFw\nLnB1dCgib3BlbmpwYS5NZXRhRGF0YUZhY3RvcnkiLAogICAgICAgICAgICAg\nICAgImpwYShUeXBlcz0iICsgYnVmLnRvU3RyaW5nKCkgKyAiKSIpOwogICAg\nICAgIH0KCiAgICAgICAgcmV0dXJuIChPcGVuSlBBRW50aXR5TWFuYWdlckZh\nY3RvcnlTUEkpIFBlcnNpc3RlbmNlLgogICAgICAgICAgICBjcmVhdGVFbnRp\ndHlNYW5hZ2VyRmFjdG9yeSgidGVzdCIsIG1hcCk7CiAgICB9CgogICAgcHVi\nbGljIHZvaWQgdGVhckRvd24oKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAg\nICBzdXBlci50ZWFyRG93bigpOwogICAgfQoKICAgIC8qKgogICAgICogU2Fm\nZWx5IGNsb3NlIHRoZSBnaXZlbiBmYWN0b3J5LgogICAgICovCiAgICBwcm90\nZWN0ZWQgYm9vbGVhbiBjbG9zZUVNRihFbnRpdHlNYW5hZ2VyRmFjdG9yeSBl\nbWYpIHsKICAgICAgICBpZiAoZW1mID09IG51bGwpCiAgICAgICAgICAgIHJl\ndHVybiBmYWxzZTsKICAgICAgICBpZiAoIWVtZi5pc09wZW4oKSkKICAgICAg\nICAgICAgcmV0dXJuIGZhbHNlOwoKICAgICAgICBmb3IgKEl0ZXJhdG9yIGl0\nZXIgPSAoKEFic3RyYWN0QnJva2VyRmFjdG9yeSkgSlBBRmFjYWRlSGVscGVy\nCiAgICAgICAgICAgIC50b0Jyb2tlckZhY3RvcnkoZW1mKSkuZ2V0T3BlbkJy\nb2tlcnMoKS5pdGVyYXRvcigpOwogICAgICAgICAgICBpdGVyLmhhc05leHQo\nKTsgKSB7CiAgICAgICAgICAgIEJyb2tlciBiID0gKEJyb2tlcikgaXRlci5u\nZXh0KCk7CiAgICAgICAgICAgIGlmIChiICE9IG51bGwgJiYgIWIuaXNDbG9z\nZWQoKSkgewogICAgICAgICAgICAgICAgRW50aXR5TWFuYWdlciBlbSA9IEpQ\nQUZhY2FkZUhlbHBlci50b0VudGl0eU1hbmFnZXIoYik7CiAgICAgICAgICAg\nICAgICBpZiAoZW0uZ2V0VHJhbnNhY3Rpb24oKS5pc0FjdGl2ZSgpKQogICAg\nICAgICAgICAgICAgICAgIGVtLmdldFRyYW5zYWN0aW9uKCkucm9sbGJhY2so\nKTsKICAgICAgICAgICAgICAgIGVtLmNsb3NlKCk7CiAgICAgICAgICAgIH0K\nICAgICAgICB9CgogICAgICAgIGVtZi5jbG9zZSgpOwogICAgICAgIHJldHVy\nbiAhZW1mLmlzT3BlbigpOwogICAgfQoKICAgIC8qKgogICAgICogRGVsZXRl\nIGFsbCBpbnN0YW5jZXMgb2YgdGhlIGdpdmVuIHR5cGVzIHVzaW5nIGJ1bGsg\nZGVsZXRlIHF1ZXJpZXMuCiAgICAgKi8KICAgIHByb3RlY3RlZCB2b2lkIGNs\nZWFyKEVudGl0eU1hbmFnZXJGYWN0b3J5IGVtZiwgQ2xhc3MuLi4gdHlwZXMp\nIHsKICAgICAgICBpZiAoZW1mID09IG51bGwgfHwgdHlwZXMubGVuZ3RoID09\nIDApCiAgICAgICAgICAgIHJldHVybjsKCiAgICAgICAgTGlzdDxDbGFzc01l\ndGFEYXRhPiBtZXRhcyA9IG5ldyBBcnJheUxpc3Q8Q2xhc3NNZXRhRGF0YT4o\ndHlwZXMubGVuZ3RoKTsKICAgICAgICBmb3IgKENsYXNzIGMgOiB0eXBlcykg\newogICAgICAgICAgICBDbGFzc01ldGFEYXRhIG1ldGEgPSBKUEFGYWNhZGVI\nZWxwZXIuZ2V0TWV0YURhdGEoZW1mLCBjKTsKICAgICAgICAgICAgaWYgKG1l\ndGEgIT0gbnVsbCkKICAgICAgICAgICAgICAgIG1ldGFzLmFkZChtZXRhKTsK\nICAgICAgICB9CiAgICAgICAgY2xlYXIoZW1mLCBtZXRhcy50b0FycmF5KG5l\ndyBDbGFzc01ldGFEYXRhW21ldGFzLnNpemUoKV0pKTsKICAgIH0KCiAgICAv\nKioKICAgICAqIERlbGV0ZSBhbGwgaW5zdGFuY2VzIG9mIHRoZSBwZXJzaXN0\nZW50IHR5cGVzIHJlZ2lzdGVyZWQgd2l0aCB0aGUgZ2l2ZW4KICAgICAqIGZh\nY3RvcnkgdXNpbmcgYnVsayBkZWxldGUgcXVlcmllcy4KICAgICAqLwogICAg\ncHJvdGVjdGVkIHZvaWQgY2xlYXIoRW50aXR5TWFuYWdlckZhY3RvcnkgZW1m\nKSB7CiAgICAgICAgaWYgKGVtZiA9PSBudWxsKQogICAgICAgICAgICByZXR1\ncm47CiAgICAgICAgY2xlYXIoZW1mLCAoKE9wZW5KUEFFbnRpdHlNYW5hZ2Vy\nRmFjdG9yeVNQSSkgZW1mKS5nZXRDb25maWd1cmF0aW9uKCkuCiAgICAgICAg\nICAgIGdldE1ldGFEYXRhUmVwb3NpdG9yeUluc3RhbmNlKCkuZ2V0TWV0YURh\ndGFzKCkpOwogICAgfQoKICAgIC8qKgogICAgICogRGVsZXRlIGFsbCBpbnN0\nYW5jZXMgb2YgdGhlIGdpdmVuIHR5cGVzIHVzaW5nIGJ1bGsgZGVsZXRlIHF1\nZXJpZXMuCiAgICAgKi8KICAgIHByaXZhdGUgdm9pZCBjbGVhcihFbnRpdHlN\nYW5hZ2VyRmFjdG9yeSBlbWYsIENsYXNzTWV0YURhdGEuLi4gdHlwZXMpIHsK\nICAgICAgICBpZiAoZW1mID09IG51bGwgfHwgdHlwZXMubGVuZ3RoID09IDAp\nCiAgICAgICAgICAgIHJldHVybjsKCiAgICAgICAgRW50aXR5TWFuYWdlciBl\nbSA9IGVtZi5jcmVhdGVFbnRpdHlNYW5hZ2VyKCk7CiAgICAgICAgZW0uZ2V0\nVHJhbnNhY3Rpb24oKS5iZWdpbigpOwogICAgICAgIGZvciAoQ2xhc3NNZXRh\nRGF0YSBtZXRhIDogdHlwZXMpIHsKICAgICAgICAgICAgaWYgKCFtZXRhLmlz\nTWFwcGVkKCkgfHwgbWV0YS5pc0VtYmVkZGVkT25seSgpIAogICAgICAgICAg\nICAgICAgfHwgTW9kaWZpZXIuaXNBYnN0cmFjdChtZXRhLmdldERlc2NyaWJl\nZFR5cGUoKS5nZXRNb2RpZmllcnMoKSkpCiAgICAgICAgICAgICAgICBjb250\naW51ZTsKICAgICAgICAgICAgZW0uY3JlYXRlUXVlcnkoIkRFTEVURSBGUk9N\nICIgKyBtZXRhLmdldFR5cGVBbGlhcygpICsgIiBvIikuCiAgICAgICAgICAg\nICAgICBleGVjdXRlVXBkYXRlKCk7CiAgICAgICAgfQogICAgICAgIGVtLmdl\ndFRyYW5zYWN0aW9uKCkuY29tbWl0KCk7CiAgICAgICAgZW0uY2xvc2UoKTsK\nICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgZW50aXR5IG5hbWUg\nZm9yIHRoZSBnaXZlbiB0eXBlLiAgIAogICAgICovCiAgICBwcm90ZWN0ZWQg\nU3RyaW5nIGVudGl0eU5hbWUoRW50aXR5TWFuYWdlckZhY3RvcnkgZW1mLCBD\nbGFzcyBjKSB7CiAgICAgICAgQ2xhc3NNZXRhRGF0YSBtZXRhID0gSlBBRmFj\nYWRlSGVscGVyLmdldE1ldGFEYXRhKGVtZiwgYyk7CiAgICAgICAgcmV0dXJu\nIChtZXRhID09IG51bGwpID8gbnVsbCA6IG1ldGEuZ2V0VHlwZUFsaWFzKCk7\nCiAgICB9Cn0K\n","encoding":"base64"}

