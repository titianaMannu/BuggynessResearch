{"sha":"75cce66534153b70ac66888fb2e5b4e2d8b31d7d","node_id":"MDQ6QmxvYjIwNjM2NDo3NWNjZTY2NTM0MTUzYjcwYWM2Njg4OGZiMmU1YjRlMmQ4YjMxZDdk","size":145224,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/75cce66534153b70ac66888fb2e5b4e2d8b31d7d","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zcWw7CgppbXBvcnQg\namF2YS5pby5CdWZmZXJlZFJlYWRlcjsKaW1wb3J0IGphdmEuaW8uQnl0ZUFy\ncmF5SW5wdXRTdHJlYW07CmltcG9ydCBqYXZhLmlvLklPRXhjZXB0aW9uOwpp\nbXBvcnQgamF2YS5pby5JbnB1dFN0cmVhbTsKaW1wb3J0IGphdmEuaW8uSW5w\ndXRTdHJlYW1SZWFkZXI7CmltcG9ydCBqYXZhLmlvLlJlYWRlcjsKaW1wb3J0\nIGphdmEuaW8uU3RyaW5nUmVhZGVyOwppbXBvcnQgamF2YS5pby5Xcml0ZXI7\nCmltcG9ydCBqYXZhLmxhbmcucmVmbGVjdC5JbnZvY2F0aW9uVGFyZ2V0RXhj\nZXB0aW9uOwppbXBvcnQgamF2YS5sYW5nLnJlZmxlY3QuTWV0aG9kOwppbXBv\ncnQgamF2YS5tYXRoLkJpZ0RlY2ltYWw7CmltcG9ydCBqYXZhLm1hdGguQmln\nSW50ZWdlcjsKaW1wb3J0IGphdmEuc3FsLkFycmF5OwppbXBvcnQgamF2YS5z\ncWwuQmxvYjsKaW1wb3J0IGphdmEuc3FsLkNsb2I7CmltcG9ydCBqYXZhLnNx\nbC5Db25uZWN0aW9uOwppbXBvcnQgamF2YS5zcWwuRGF0YWJhc2VNZXRhRGF0\nYTsKaW1wb3J0IGphdmEuc3FsLlByZXBhcmVkU3RhdGVtZW50OwppbXBvcnQg\namF2YS5zcWwuUmVmOwppbXBvcnQgamF2YS5zcWwuUmVzdWx0U2V0OwppbXBv\ncnQgamF2YS5zcWwuU1FMRXhjZXB0aW9uOwppbXBvcnQgamF2YS5zcWwuU1FM\nV2FybmluZzsKaW1wb3J0IGphdmEuc3FsLlN0YXRlbWVudDsKaW1wb3J0IGph\ndmEuc3FsLlRpbWU7CmltcG9ydCBqYXZhLnNxbC5UaW1lc3RhbXA7CmltcG9y\ndCBqYXZhLnNxbC5UeXBlczsKaW1wb3J0IGphdmEudGV4dC5NZXNzYWdlRm9y\nbWF0OwppbXBvcnQgamF2YS51dGlsLkFycmF5TGlzdDsKaW1wb3J0IGphdmEu\ndXRpbC5BcnJheXM7CmltcG9ydCBqYXZhLnV0aWwuQ2FsZW5kYXI7CmltcG9y\ndCBqYXZhLnV0aWwuQ29sbGVjdGlvbjsKaW1wb3J0IGphdmEudXRpbC5Db2xs\nZWN0aW9uczsKaW1wb3J0IGphdmEudXRpbC5EYXRlOwppbXBvcnQgamF2YS51\ndGlsLkhhc2hTZXQ7CmltcG9ydCBqYXZhLnV0aWwuSXRlcmF0b3I7CmltcG9y\ndCBqYXZhLnV0aWwuTGlua2VkSGFzaFNldDsKaW1wb3J0IGphdmEudXRpbC5M\naXN0OwppbXBvcnQgamF2YS51dGlsLkxvY2FsZTsKaW1wb3J0IGphdmEudXRp\nbC5NYXA7CmltcG9ydCBqYXZhLnV0aWwuU2V0OwppbXBvcnQgamF2YXguc3Fs\nLkRhdGFTb3VyY2U7CgppbXBvcnQgb3JnLmFwYWNoZS5jb21tb25zLmxhbmcu\nU3RyaW5nVXRpbHM7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5j\nb25mLkpEQkNDb25maWd1cmF0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLmpkYmMua2VybmVsLkpEQkNGZXRjaENvbmZpZ3VyYXRpb247CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5rZXJuZWwuSkRCQ1N0b3JlOwpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMua2VybmVsLmV4cHMuRXhw\nQ29udGV4dDsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLmtlcm5l\nbC5leHBzLkV4cFN0YXRlOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpk\nYmMua2VybmVsLmV4cHMuRmlsdGVyVmFsdWU7CmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEuamRiYy5rZXJuZWwuZXhwcy5WYWw7CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEuamRiYy5tZXRhLkNsYXNzTWFwcGluZzsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5qZGJjLm1ldGEuRmllbGRNYXBwaW5nOwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0YS5KYXZhU1FMVHlwZXM7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hlbWEuQ29sdW1u\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1hLkRhdGFT\nb3VyY2VGYWN0b3J5OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMu\nc2NoZW1hLkZvcmVpZ25LZXk7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\namRiYy5zY2hlbWEuSW5kZXg7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\namRiYy5zY2hlbWEuTmFtZVNldDsKaW1wb3J0IG9yZy5hcGFjaGUub3Blbmpw\nYS5qZGJjLnNjaGVtYS5QcmltYXJ5S2V5OwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLmpkYmMuc2NoZW1hLlNjaGVtYTsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS5qZGJjLnNjaGVtYS5TY2hlbWFHcm91cDsKaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS5qZGJjLnNjaGVtYS5TZXF1ZW5jZTsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNjaGVtYS5UYWJsZTsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNjaGVtYS5VbmlxdWU7CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLkZpbHRlcnM7CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEubGliLmNvbmYuQ29uZmlndXJhYmxlOwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLmxpYi5jb25mLkNvbmZpZ3VyYXRpb247Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLmpkYmMuQ29ubmVjdGlvbkRl\nY29yYXRvcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIuamRiYy5M\nb2dnaW5nQ29ubmVjdGlvbkRlY29yYXRvcjsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS5saWIubG9nLkxvZzsKaW1wb3J0IG9yZy5hcGFjaGUub3Blbmpw\nYS5saWIudXRpbC5Mb2NhbGl6ZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEubGliLnV0aWwuTG9jYWxpemVyLk1lc3NhZ2U7CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEubWV0YS5KYXZhVHlwZXM7CmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEudXRpbC5HZW5lcmFsRXhjZXB0aW9uOwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLnV0aWwuT3BlbkpQQUV4Y2VwdGlvbjsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS51dGlsLlJlZmVyZW50aWFsSW50ZWdyaXR5RXhj\nZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuU2VyaWFs\naXphdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLlN0b3Jl\nRXhjZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuVW5z\ndXBwb3J0ZWRFeGNlcHRpb247CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\ndXRpbC5Vc2VyRXhjZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLnV0aWwuSW52YWxpZFN0YXRlRXhjZXB0aW9uOwppbXBvcnQgc2VycC51dGls\nLk51bWJlcnM7CmltcG9ydCBzZXJwLnV0aWwuU3RyaW5nczsKCi8qKgogKiBD\nbGFzcyB3aGljaCBhbGxvd3MgdGhlIGNyZWF0aW9uIG9mIFNRTCBkeW5hbWlj\nYWxseSwgaW4gYQogKiBkYXRhYmFzZSBhZ25vc3RpYyBmYXNoaW9uLiBTdWJj\nbGFzcyBmb3IgdGhlIG51YW5jZXMgb2YgZGlmZmVyZW50IGRhdGEgc3RvcmVz\nLgogKi8KcHVibGljIGNsYXNzIERCRGljdGlvbmFyeQogICAgaW1wbGVtZW50\ncyBDb25maWd1cmFibGUsIENvbm5lY3Rpb25EZWNvcmF0b3IsIEpvaW5TeW50\nYXhlcywKICAgIExvZ2dpbmdDb25uZWN0aW9uRGVjb3JhdG9yLlNRTFdhcm5p\nbmdIYW5kbGVyIHsKCiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIFN0cmluZyBW\nRU5ET1JfT1RIRVIgPSAib3RoZXIiOwogICAgcHVibGljIHN0YXRpYyBmaW5h\nbCBTdHJpbmcgVkVORE9SX0RBVEFESVJFQ1QgPSAiZGF0YWRpcmVjdCI7Cgog\nICAgcHVibGljIHN0YXRpYyBmaW5hbCBTdHJpbmcgU0NIRU1BX0NBU0VfVVBQ\nRVIgPSAidXBwZXIiOwogICAgcHVibGljIHN0YXRpYyBmaW5hbCBTdHJpbmcg\nU0NIRU1BX0NBU0VfTE9XRVIgPSAibG93ZXIiOwogICAgcHVibGljIHN0YXRp\nYyBmaW5hbCBTdHJpbmcgU0NIRU1BX0NBU0VfUFJFU0VSVkUgPSAicHJlc2Vy\ndmUiOwoKICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgU3RyaW5nIENPTlNfTkFN\nRV9CRUZPUkUgPSAiYmVmb3JlIjsKICAgIHB1YmxpYyBzdGF0aWMgZmluYWwg\nU3RyaW5nIENPTlNfTkFNRV9NSUQgPSAibWlkIjsKICAgIHB1YmxpYyBzdGF0\naWMgZmluYWwgU3RyaW5nIENPTlNfTkFNRV9BRlRFUiA9ICJhZnRlciI7Cgog\nICAgcHJvdGVjdGVkIHN0YXRpYyBmaW5hbCBpbnQgUkFOR0VfUE9TVF9TRUxF\nQ1QgPSAwOwogICAgcHJvdGVjdGVkIHN0YXRpYyBmaW5hbCBpbnQgUkFOR0Vf\nUFJFX0RJU1RJTkNUID0gMTsKICAgIHByb3RlY3RlZCBzdGF0aWMgZmluYWwg\naW50IFJBTkdFX1BPU1RfRElTVElOQ1QgPSAyOwogICAgcHJvdGVjdGVkIHN0\nYXRpYyBmaW5hbCBpbnQgUkFOR0VfUE9TVF9MT0NLID0gMzsKCiAgICBwcm90\nZWN0ZWQgc3RhdGljIGZpbmFsIGludCBOQU5PID0gMTsKICAgIHByb3RlY3Rl\nZCBzdGF0aWMgZmluYWwgaW50IE1JQ1JPID0gTkFOTyAqIDEwMDA7CiAgICBw\ncm90ZWN0ZWQgc3RhdGljIGZpbmFsIGludCBNSUxMSSA9IE1JQ1JPICogMTAw\nMDsKICAgIHByb3RlY3RlZCBzdGF0aWMgZmluYWwgaW50IENFTlRJID0gTUlM\nTEkgKiAxMDsKICAgIHByb3RlY3RlZCBzdGF0aWMgZmluYWwgaW50IERFQ0kg\nPSBNSUxMSSAqIDEwMDsKICAgIHByb3RlY3RlZCBzdGF0aWMgZmluYWwgaW50\nIFNFQyA9IE1JTExJICogMTAwMDsKCiAgICBwcm90ZWN0ZWQgc3RhdGljIGZp\nbmFsIGludCBOQU1FX0FOWSA9IDA7CiAgICBwcm90ZWN0ZWQgc3RhdGljIGZp\nbmFsIGludCBOQU1FX1RBQkxFID0gMTsKICAgIHByb3RlY3RlZCBzdGF0aWMg\nZmluYWwgaW50IE5BTUVfU0VRVUVOQ0UgPSAyOwoKICAgIHByaXZhdGUgc3Rh\ndGljIGZpbmFsIFN0cmluZyBaRVJPX0RBVEVfU1RSID0KICAgICAgICAiJyIg\nKyBuZXcgamF2YS5zcWwuRGF0ZSgwKSArICInIjsKICAgIHByaXZhdGUgc3Rh\ndGljIGZpbmFsIFN0cmluZyBaRVJPX1RJTUVfU1RSID0gIiciICsgbmV3IFRp\nbWUoMCkgKyAiJyI7CiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBTdHJpbmcg\nWkVST19USU1FU1RBTVBfU1RSID0KICAgICAgICAiJyIgKyBuZXcgVGltZXN0\nYW1wKDApICsgIiciOwoKICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIExvY2Fs\naXplciBfbG9jID0gTG9jYWxpemVyLmZvclBhY2thZ2UKICAgICAgICAoREJE\naWN0aW9uYXJ5LmNsYXNzKTsKCiAgICAvLyBzY2hlbWEgZGF0YQogICAgcHVi\nbGljIFN0cmluZyBwbGF0Zm9ybSA9ICJHZW5lcmljIjsKICAgIHB1YmxpYyBT\ndHJpbmcgZHJpdmVyVmVuZG9yID0gbnVsbDsKICAgIHB1YmxpYyBTdHJpbmcg\nY2F0YWxvZ1NlcGFyYXRvciA9ICIuIjsKICAgIHB1YmxpYyBib29sZWFuIGNy\nZWF0ZVByaW1hcnlLZXlzID0gdHJ1ZTsKICAgIHB1YmxpYyBTdHJpbmcgY29u\nc3RyYWludE5hbWVNb2RlID0gQ09OU19OQU1FX0JFRk9SRTsKICAgIHB1Ymxp\nYyBpbnQgbWF4VGFibGVOYW1lTGVuZ3RoID0gMTI4OwogICAgcHVibGljIGlu\ndCBtYXhDb2x1bW5OYW1lTGVuZ3RoID0gMTI4OwogICAgcHVibGljIGludCBt\nYXhDb25zdHJhaW50TmFtZUxlbmd0aCA9IDEyODsKICAgIHB1YmxpYyBpbnQg\nbWF4SW5kZXhOYW1lTGVuZ3RoID0gMTI4OwogICAgcHVibGljIGludCBtYXhJ\nbmRleGVzUGVyVGFibGUgPSBJbnRlZ2VyLk1BWF9WQUxVRTsKICAgIHB1Ymxp\nYyBib29sZWFuIHN1cHBvcnRzRm9yZWlnbktleXMgPSB0cnVlOwogICAgcHVi\nbGljIGJvb2xlYW4gc3VwcG9ydHNUaW1lc3RhbXBOYW5vcyA9IHRydWU7CiAg\nICBwdWJsaWMgYm9vbGVhbiBzdXBwb3J0c1VuaXF1ZUNvbnN0cmFpbnRzID0g\ndHJ1ZTsKICAgIHB1YmxpYyBib29sZWFuIHN1cHBvcnRzRGVmZXJyZWRDb25z\ndHJhaW50cyA9IHRydWU7CiAgICBwdWJsaWMgYm9vbGVhbiBzdXBwb3J0c1Jl\nc3RyaWN0RGVsZXRlQWN0aW9uID0gdHJ1ZTsKICAgIHB1YmxpYyBib29sZWFu\nIHN1cHBvcnRzQ2FzY2FkZURlbGV0ZUFjdGlvbiA9IHRydWU7CiAgICBwdWJs\naWMgYm9vbGVhbiBzdXBwb3J0c051bGxEZWxldGVBY3Rpb24gPSB0cnVlOwog\nICAgcHVibGljIGJvb2xlYW4gc3VwcG9ydHNEZWZhdWx0RGVsZXRlQWN0aW9u\nID0gdHJ1ZTsKICAgIHB1YmxpYyBib29sZWFuIHN1cHBvcnRzUmVzdHJpY3RV\ncGRhdGVBY3Rpb24gPSB0cnVlOwogICAgcHVibGljIGJvb2xlYW4gc3VwcG9y\ndHNDYXNjYWRlVXBkYXRlQWN0aW9uID0gdHJ1ZTsKICAgIHB1YmxpYyBib29s\nZWFuIHN1cHBvcnRzTnVsbFVwZGF0ZUFjdGlvbiA9IHRydWU7CiAgICBwdWJs\naWMgYm9vbGVhbiBzdXBwb3J0c0RlZmF1bHRVcGRhdGVBY3Rpb24gPSB0cnVl\nOwogICAgcHVibGljIGJvb2xlYW4gc3VwcG9ydHNBbHRlclRhYmxlV2l0aEFk\nZENvbHVtbiA9IHRydWU7CiAgICBwdWJsaWMgYm9vbGVhbiBzdXBwb3J0c0Fs\ndGVyVGFibGVXaXRoRHJvcENvbHVtbiA9IHRydWU7CiAgICBwdWJsaWMgU3Ry\naW5nIHJlc2VydmVkV29yZHMgPSBudWxsOwogICAgcHVibGljIFN0cmluZyBz\neXN0ZW1TY2hlbWFzID0gbnVsbDsKICAgIHB1YmxpYyBTdHJpbmcgc3lzdGVt\nVGFibGVzID0gbnVsbDsKICAgIHB1YmxpYyBTdHJpbmcgZml4ZWRTaXplVHlw\nZU5hbWVzID0gbnVsbDsKICAgIHB1YmxpYyBTdHJpbmcgc2NoZW1hQ2FzZSA9\nIFNDSEVNQV9DQVNFX1VQUEVSOwoKICAgIC8vIHNxbAogICAgcHVibGljIFN0\ncmluZyB2YWxpZGF0aW9uU1FMID0gbnVsbDsKICAgIHB1YmxpYyBTdHJpbmcg\nY2xvc2VQb29sU1FMID0gbnVsbDsKICAgIHB1YmxpYyBTdHJpbmcgaW5pdGlh\nbGl6YXRpb25TUUwgPSBudWxsOwogICAgcHVibGljIGludCBqb2luU3ludGF4\nID0gU1lOVEFYX1NRTDkyOwogICAgcHVibGljIFN0cmluZyBvdXRlckpvaW5D\nbGF1c2UgPSAiTEVGVCBPVVRFUiBKT0lOIjsKICAgIHB1YmxpYyBTdHJpbmcg\naW5uZXJKb2luQ2xhdXNlID0gIklOTkVSIEpPSU4iOwogICAgcHVibGljIFN0\ncmluZyBjcm9zc0pvaW5DbGF1c2UgPSAiQ1JPU1MgSk9JTiI7CiAgICBwdWJs\naWMgYm9vbGVhbiByZXF1aXJlc0NvbmRpdGlvbkZvckNyb3NzSm9pbiA9IGZh\nbHNlOwogICAgcHVibGljIFN0cmluZyBmb3JVcGRhdGVDbGF1c2UgPSAiRk9S\nIFVQREFURSI7CiAgICBwdWJsaWMgU3RyaW5nIHRhYmxlRm9yVXBkYXRlQ2xh\ndXNlID0gbnVsbDsKICAgIHB1YmxpYyBTdHJpbmcgZGlzdGluY3RDb3VudENv\nbHVtblNlcGFyYXRvciA9IG51bGw7CiAgICBwdWJsaWMgYm9vbGVhbiBzdXBw\nb3J0c1NlbGVjdEZvclVwZGF0ZSA9IHRydWU7CiAgICBwdWJsaWMgYm9vbGVh\nbiBzdXBwb3J0c0xvY2tpbmdXaXRoRGlzdGluY3RDbGF1c2UgPSB0cnVlOwog\nICAgcHVibGljIGJvb2xlYW4gc3VwcG9ydHNMb2NraW5nV2l0aE11bHRpcGxl\nVGFibGVzID0gdHJ1ZTsKICAgIHB1YmxpYyBib29sZWFuIHN1cHBvcnRzTG9j\na2luZ1dpdGhPcmRlckNsYXVzZSA9IHRydWU7CiAgICBwdWJsaWMgYm9vbGVh\nbiBzdXBwb3J0c0xvY2tpbmdXaXRoT3V0ZXJKb2luID0gdHJ1ZTsKICAgIHB1\nYmxpYyBib29sZWFuIHN1cHBvcnRzTG9ja2luZ1dpdGhJbm5lckpvaW4gPSB0\ncnVlOwogICAgcHVibGljIGJvb2xlYW4gc3VwcG9ydHNMb2NraW5nV2l0aFNl\nbGVjdFJhbmdlID0gdHJ1ZTsKICAgIHB1YmxpYyBib29sZWFuIHN1cHBvcnRz\nUXVlcnlUaW1lb3V0ID0gdHJ1ZTsKICAgIHB1YmxpYyBib29sZWFuIHNpbXVs\nYXRlTG9ja2luZyA9IGZhbHNlOwogICAgcHVibGljIGJvb2xlYW4gc3VwcG9y\ndHNTdWJzZWxlY3QgPSB0cnVlOwogICAgcHVibGljIGJvb2xlYW4gc3VwcG9y\ndHNDb3JyZWxhdGVkU3Vic2VsZWN0ID0gdHJ1ZTsKICAgIHB1YmxpYyBib29s\nZWFuIHN1cHBvcnRzSGF2aW5nID0gdHJ1ZTsKICAgIHB1YmxpYyBib29sZWFu\nIHN1cHBvcnRzU2VsZWN0U3RhcnRJbmRleCA9IGZhbHNlOwogICAgcHVibGlj\nIGJvb2xlYW4gc3VwcG9ydHNTZWxlY3RFbmRJbmRleCA9IGZhbHNlOwogICAg\ncHVibGljIGludCByYW5nZVBvc2l0aW9uID0gUkFOR0VfUE9TVF9TRUxFQ1Q7\nCiAgICBwdWJsaWMgYm9vbGVhbiByZXF1aXJlc0FsaWFzRm9yU3Vic2VsZWN0\nID0gZmFsc2U7CiAgICBwdWJsaWMgYm9vbGVhbiBhbGxvd3NBbGlhc0luQnVs\na0NsYXVzZSA9IHRydWU7CiAgICBwdWJsaWMgYm9vbGVhbiBzdXBwb3J0c011\nbHRpcGxlTm9udHJhbnNhY3Rpb25hbFJlc3VsdFNldHMgPSB0cnVlOwogICAg\ncHVibGljIFN0cmluZyBzZWFyY2hTdHJpbmdFc2NhcGUgPSAiXFwiOwogICAg\ncHVibGljIGJvb2xlYW4gcmVxdWlyZXNDYXN0Rm9yTWF0aEZ1bmN0aW9ucyA9\nIGZhbHNlOwogICAgcHVibGljIGJvb2xlYW4gcmVxdWlyZXNDYXN0Rm9yQ29t\ncGFyaXNvbnMgPSBmYWxzZTsKICAgIHB1YmxpYyBib29sZWFuIHN1cHBvcnRz\nTW9kT3BlcmF0b3IgPSBmYWxzZTsKICAgIHB1YmxpYyBib29sZWFuIHN1cHBv\ncnRzWE1MQ29sdW1uID0gZmFsc2U7CgogICAgLy8gZnVuY3Rpb25zCiAgICBw\ndWJsaWMgU3RyaW5nIGNhc3RGdW5jdGlvbiA9ICJDQVNUKHswfSBBUyB7MX0p\nIjsKICAgIHB1YmxpYyBTdHJpbmcgdG9Mb3dlckNhc2VGdW5jdGlvbiA9ICJM\nT1dFUih7MH0pIjsKICAgIHB1YmxpYyBTdHJpbmcgdG9VcHBlckNhc2VGdW5j\ndGlvbiA9ICJVUFBFUih7MH0pIjsKICAgIHB1YmxpYyBTdHJpbmcgc3RyaW5n\nTGVuZ3RoRnVuY3Rpb24gPSAiQ0hBUl9MRU5HVEgoezB9KSI7CiAgICBwdWJs\naWMgU3RyaW5nIGJpdExlbmd0aEZ1bmN0aW9uID0gIihPQ1RFVF9MRU5HVEgo\nezB9KSAqIDgpIjsKICAgIHB1YmxpYyBTdHJpbmcgdHJpbUxlYWRpbmdGdW5j\ndGlvbiA9ICJUUklNKExFQURJTkcgezF9IEZST00gezB9KSI7CiAgICBwdWJs\naWMgU3RyaW5nIHRyaW1UcmFpbGluZ0Z1bmN0aW9uID0gIlRSSU0oVFJBSUxJ\nTkcgezF9IEZST00gezB9KSI7CiAgICBwdWJsaWMgU3RyaW5nIHRyaW1Cb3Ro\nRnVuY3Rpb24gPSAiVFJJTShCT1RIIHsxfSBGUk9NIHswfSkiOwogICAgcHVi\nbGljIFN0cmluZyBjb25jYXRlbmF0ZUZ1bmN0aW9uID0gIih7MH18fHsxfSki\nOwogICAgcHVibGljIFN0cmluZyBjb25jYXRlbmF0ZURlbGltaXRlciA9ICIn\nT1BFTkpQQVRPS0VOJyI7CiAgICBwdWJsaWMgU3RyaW5nIHN1YnN0cmluZ0Z1\nbmN0aW9uTmFtZSA9ICJTVUJTVFJJTkciOwogICAgcHVibGljIFN0cmluZyBj\ndXJyZW50RGF0ZUZ1bmN0aW9uID0gIkNVUlJFTlRfREFURSI7CiAgICBwdWJs\naWMgU3RyaW5nIGN1cnJlbnRUaW1lRnVuY3Rpb24gPSAiQ1VSUkVOVF9USU1F\nIjsKICAgIHB1YmxpYyBTdHJpbmcgY3VycmVudFRpbWVzdGFtcEZ1bmN0aW9u\nID0gIkNVUlJFTlRfVElNRVNUQU1QIjsKICAgIHB1YmxpYyBTdHJpbmcgZHJv\ncFRhYmxlU1FMID0gIkRST1AgVEFCTEUgezB9IjsKCiAgICAvLyB0eXBlcwog\nICAgcHVibGljIGJvb2xlYW4gc3RvcmFnZUxpbWl0YXRpb25zRmF0YWwgPSBm\nYWxzZTsKICAgIHB1YmxpYyBib29sZWFuIHN0b3JlTGFyZ2VOdW1iZXJzQXNT\ndHJpbmdzID0gZmFsc2U7CiAgICBwdWJsaWMgYm9vbGVhbiBzdG9yZUNoYXJz\nQXNOdW1iZXJzID0gdHJ1ZTsKICAgIHB1YmxpYyBib29sZWFuIHVzZUdldEJ5\ndGVzRm9yQmxvYnMgPSBmYWxzZTsKICAgIHB1YmxpYyBib29sZWFuIHVzZVNl\ndEJ5dGVzRm9yQmxvYnMgPSBmYWxzZTsKICAgIHB1YmxpYyBib29sZWFuIHVz\nZUdldE9iamVjdEZvckJsb2JzID0gZmFsc2U7CiAgICBwdWJsaWMgYm9vbGVh\nbiB1c2VHZXRTdHJpbmdGb3JDbG9icyA9IGZhbHNlOwogICAgcHVibGljIGJv\nb2xlYW4gdXNlU2V0U3RyaW5nRm9yQ2xvYnMgPSBmYWxzZTsKICAgIHB1Ymxp\nYyBpbnQgbWF4RW1iZWRkZWRCbG9iU2l6ZSA9IC0xOwogICAgcHVibGljIGlu\ndCBtYXhFbWJlZGRlZENsb2JTaXplID0gLTE7CiAgICBwdWJsaWMgaW50IGlu\nQ2xhdXNlTGltaXQgPSAtMTsKICAgIHB1YmxpYyBpbnQgZGF0ZVByZWNpc2lv\nbiA9IE1JTExJOwogICAgcHVibGljIGludCBjaGFyYWN0ZXJDb2x1bW5TaXpl\nID0gMjU1OwogICAgcHVibGljIFN0cmluZyBhcnJheVR5cGVOYW1lID0gIkFS\nUkFZIjsKICAgIHB1YmxpYyBTdHJpbmcgYmlnaW50VHlwZU5hbWUgPSAiQklH\nSU5UIjsKICAgIHB1YmxpYyBTdHJpbmcgYmluYXJ5VHlwZU5hbWUgPSAiQklO\nQVJZIjsKICAgIHB1YmxpYyBTdHJpbmcgYml0VHlwZU5hbWUgPSAiQklUIjsK\nICAgIHB1YmxpYyBTdHJpbmcgYmxvYlR5cGVOYW1lID0gIkJMT0IiOwogICAg\ncHVibGljIFN0cmluZyBib29sZWFuVHlwZU5hbWUgPSAiQk9PTEVBTiI7CiAg\nICBwdWJsaWMgU3RyaW5nIGNoYXJUeXBlTmFtZSA9ICJDSEFSIjsKICAgIHB1\nYmxpYyBTdHJpbmcgY2xvYlR5cGVOYW1lID0gIkNMT0IiOwogICAgcHVibGlj\nIFN0cmluZyBkYXRlVHlwZU5hbWUgPSAiREFURSI7CiAgICBwdWJsaWMgU3Ry\naW5nIGRlY2ltYWxUeXBlTmFtZSA9ICJERUNJTUFMIjsKICAgIHB1YmxpYyBT\ndHJpbmcgZGlzdGluY3RUeXBlTmFtZSA9ICJESVNUSU5DVCI7CiAgICBwdWJs\naWMgU3RyaW5nIGRvdWJsZVR5cGVOYW1lID0gIkRPVUJMRSI7CiAgICBwdWJs\naWMgU3RyaW5nIGZsb2F0VHlwZU5hbWUgPSAiRkxPQVQiOwogICAgcHVibGlj\nIFN0cmluZyBpbnRlZ2VyVHlwZU5hbWUgPSAiSU5URUdFUiI7CiAgICBwdWJs\naWMgU3RyaW5nIGphdmFPYmplY3RUeXBlTmFtZSA9ICJKQVZBX09CSkVDVCI7\nCiAgICBwdWJsaWMgU3RyaW5nIGxvbmdWYXJiaW5hcnlUeXBlTmFtZSA9ICJM\nT05HVkFSQklOQVJZIjsKICAgIHB1YmxpYyBTdHJpbmcgbG9uZ1ZhcmNoYXJU\neXBlTmFtZSA9ICJMT05HVkFSQ0hBUiI7CiAgICBwdWJsaWMgU3RyaW5nIG51\nbGxUeXBlTmFtZSA9ICJOVUxMIjsKICAgIHB1YmxpYyBTdHJpbmcgbnVtZXJp\nY1R5cGVOYW1lID0gIk5VTUVSSUMiOwogICAgcHVibGljIFN0cmluZyBvdGhl\nclR5cGVOYW1lID0gIk9USEVSIjsKICAgIHB1YmxpYyBTdHJpbmcgcmVhbFR5\ncGVOYW1lID0gIlJFQUwiOwogICAgcHVibGljIFN0cmluZyByZWZUeXBlTmFt\nZSA9ICJSRUYiOwogICAgcHVibGljIFN0cmluZyBzbWFsbGludFR5cGVOYW1l\nID0gIlNNQUxMSU5UIjsKICAgIHB1YmxpYyBTdHJpbmcgc3RydWN0VHlwZU5h\nbWUgPSAiU1RSVUNUIjsKICAgIHB1YmxpYyBTdHJpbmcgdGltZVR5cGVOYW1l\nID0gIlRJTUUiOwogICAgcHVibGljIFN0cmluZyB0aW1lc3RhbXBUeXBlTmFt\nZSA9ICJUSU1FU1RBTVAiOwogICAgcHVibGljIFN0cmluZyB0aW55aW50VHlw\nZU5hbWUgPSAiVElOWUlOVCI7CiAgICBwdWJsaWMgU3RyaW5nIHZhcmJpbmFy\neVR5cGVOYW1lID0gIlZBUkJJTkFSWSI7CiAgICBwdWJsaWMgU3RyaW5nIHZh\ncmNoYXJUeXBlTmFtZSA9ICJWQVJDSEFSIjsKICAgIHB1YmxpYyBTdHJpbmcg\neG1sVHlwZU5hbWUgPSAiWE1MIjsKICAgIHB1YmxpYyBTdHJpbmcgZ2V0U3Ry\naW5nVmFsID0gIiI7CgogICAgLy8gc2NoZW1hIG1ldGFkYXRhCiAgICBwdWJs\naWMgYm9vbGVhbiB1c2VTY2hlbWFOYW1lID0gdHJ1ZTsKICAgIHB1YmxpYyBT\ndHJpbmcgdGFibGVUeXBlcyA9ICJUQUJMRSI7CiAgICBwdWJsaWMgYm9vbGVh\nbiBzdXBwb3J0c1NjaGVtYUZvckdldFRhYmxlcyA9IHRydWU7CiAgICBwdWJs\naWMgYm9vbGVhbiBzdXBwb3J0c1NjaGVtYUZvckdldENvbHVtbnMgPSB0cnVl\nOwogICAgcHVibGljIGJvb2xlYW4gc3VwcG9ydHNOdWxsVGFibGVGb3JHZXRD\nb2x1bW5zID0gdHJ1ZTsKICAgIHB1YmxpYyBib29sZWFuIHN1cHBvcnRzTnVs\nbFRhYmxlRm9yR2V0UHJpbWFyeUtleXMgPSBmYWxzZTsKICAgIHB1YmxpYyBi\nb29sZWFuIHN1cHBvcnRzTnVsbFRhYmxlRm9yR2V0SW5kZXhJbmZvID0gZmFs\nc2U7CiAgICBwdWJsaWMgYm9vbGVhbiBzdXBwb3J0c051bGxUYWJsZUZvckdl\ndEltcG9ydGVkS2V5cyA9IGZhbHNlOwogICAgcHVibGljIGJvb2xlYW4gdXNl\nR2V0QmVzdFJvd0lkZW50aWZpZXJGb3JQcmltYXJ5S2V5cyA9IGZhbHNlOwog\nICAgcHVibGljIGJvb2xlYW4gcmVxdWlyZXNBdXRvQ29tbWl0Rm9yTWV0YURh\ndGEgPSBmYWxzZTsKCiAgICAvLyBhdXRvLWluY3JlbWVudAogICAgcHVibGlj\nIGludCBtYXhBdXRvQXNzaWduTmFtZUxlbmd0aCA9IDMxOwogICAgcHVibGlj\nIFN0cmluZyBhdXRvQXNzaWduQ2xhdXNlID0gbnVsbDsKICAgIHB1YmxpYyBT\ndHJpbmcgYXV0b0Fzc2lnblR5cGVOYW1lID0gbnVsbDsKICAgIHB1YmxpYyBi\nb29sZWFuIHN1cHBvcnRzQXV0b0Fzc2lnbiA9IGZhbHNlOwogICAgcHVibGlj\nIFN0cmluZyBsYXN0R2VuZXJhdGVkS2V5UXVlcnkgPSBudWxsOwogICAgcHVi\nbGljIFN0cmluZyBuZXh0U2VxdWVuY2VRdWVyeSA9IG51bGw7CiAgICBwdWJs\naWMgU3RyaW5nIHNlcXVlbmNlU1FMID0gbnVsbDsKICAgIHB1YmxpYyBTdHJp\nbmcgc2VxdWVuY2VTY2hlbWFTUUwgPSBudWxsOwogICAgcHVibGljIFN0cmlu\nZyBzZXF1ZW5jZU5hbWVTUUwgPSBudWxsOwoKICAgIHByb3RlY3RlZCBKREJD\nQ29uZmlndXJhdGlvbiBjb25mID0gbnVsbDsKICAgIHByb3RlY3RlZCBMb2cg\nbG9nID0gbnVsbDsKICAgIHByb3RlY3RlZCBib29sZWFuIGNvbm5lY3RlZCA9\nIGZhbHNlOwogICAgcHJvdGVjdGVkIGZpbmFsIFNldCByZXNlcnZlZFdvcmRT\nZXQgPSBuZXcgSGFzaFNldCgpOwogICAgcHJvdGVjdGVkIGZpbmFsIFNldCBz\neXN0ZW1TY2hlbWFTZXQgPSBuZXcgSGFzaFNldCgpOwogICAgcHJvdGVjdGVk\nIGZpbmFsIFNldCBzeXN0ZW1UYWJsZVNldCA9IG5ldyBIYXNoU2V0KCk7CiAg\nICBwcm90ZWN0ZWQgZmluYWwgU2V0IGZpeGVkU2l6ZVR5cGVOYW1lU2V0ID0g\nbmV3IEhhc2hTZXQoKTsKCiAgICAvKioKICAgICAqIElmIGEgbmF0aXZlIHF1\nZXJ5IGJlZ2lucyB3aXRoIGFueSBvZiB0aGUgdmFsdWVzIGZvdW5kIGhlcmUg\ndGhlbiBpdCB3aWxsCiAgICAgKiBiZSB0cmVhdGVkIGFzIGEgc2VsZWN0IHN0\nYXRlbWVudC4gIAogICAgICovCiAgICBwcm90ZWN0ZWQgZmluYWwgU2V0IHNl\nbGVjdFdvcmRTZXQgPSBuZXcgSGFzaFNldCgpOwoKICAgIC8vIHdoZW4gd2Ug\nc3RvcmUgdmFsdWVzIHRoYXQgbG9zZSBwcmVjaW9uLCB0cmFjayB0aGUgdHlw\nZXMgc28gdGhhdCB0aGUKICAgIC8vIGZpcnN0IHRpbWUgaXQgaGFwcGVucyB3\nZSBjYW4gd2FybiB0aGUgdXNlcgogICAgcHJpdmF0ZSBTZXQgX3ByZWNpc2lv\nbldhcm5lZFR5cGVzID0gbnVsbDsKCiAgICAvLyBjYWNoZSBsb2IgbWV0aG9k\ncwogICAgcHJpdmF0ZSBNZXRob2QgX3NldEJ5dGVzID0gbnVsbDsKICAgIHBy\naXZhdGUgTWV0aG9kIF9zZXRTdHJpbmcgPSBudWxsOwogICAgcHJpdmF0ZSBN\nZXRob2QgX3NldENoYXJTdHJlYW0gPSBudWxsOwoKICAgIHB1YmxpYyBEQkRp\nY3Rpb25hcnkoKSB7CiAgICAgICAgZml4ZWRTaXplVHlwZU5hbWVTZXQuYWRk\nQWxsKEFycmF5cy5hc0xpc3QobmV3IFN0cmluZ1tdewogICAgICAgICAgICAi\nQklHSU5UIiwgIkJJVCIsICJCTE9CIiwgIkNMT0IiLCAiREFURSIsICJERUNJ\nTUFMIiwgIkRJU1RJTkNUIiwKICAgICAgICAgICAgIkRPVUJMRSIsICJGTE9B\nVCIsICJJTlRFR0VSIiwgIkpBVkFfT0JKRUNUIiwgIk5VTEwiLCAiTlVNRVJJ\nQyIsCiAgICAgICAgICAgICJPVEhFUiIsICJSRUFMIiwgIlJFRiIsICJTTUFM\nTElOVCIsICJTVFJVQ1QiLCAiVElNRSIsICJUSU1FU1RBTVAiLAogICAgICAg\nICAgICAiVElOWUlOVCIsCiAgICAgICAgfSkpOwogICAgICAgIAogICAgICAg\nIHNlbGVjdFdvcmRTZXQuYWRkKCJTRUxFQ1QiKTsKICAgIH0KCiAgICAvKioK\nICAgICAqIFRoaXMgbWV0aG9kIGlzIGNhbGxlZCB3aGVuIHRoZSBkaWN0aW9u\nYXJ5IGZpcnN0IHNlZXMgYW55IGNvbm5lY3Rpb24uCiAgICAgKiBJdCBpcyB1\nc2VkIHRvIGluaXRpYWxpemUgZGljdGlvbmFyeSBtZXRhZGF0YSBpZiBuZWVk\nZWQuIElmIHlvdQogICAgICogb3ZlcnJpZGUgdGhpcyBtZXRob2QsIGJlIHN1\ncmUgdG8gY2FsbAogICAgICogPGNvZGU+c3VwZXIuY29ubmVjdGVkQ29uZmln\ndXJhdGlvbjwvY29kZT4uCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIGNvbm5l\nY3RlZENvbmZpZ3VyYXRpb24oQ29ubmVjdGlvbiBjb25uKQogICAgICAgIHRo\ncm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIGlmICghY29ubmVjdGVkKSB7\nCiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBpZiAobG9nLmlz\nVHJhY2VFbmFibGVkKCkpCiAgICAgICAgICAgICAgICAgICAgbG9nLnRyYWNl\nKERCRGljdGlvbmFyeUZhY3RvcnkudG9TdHJpbmcKICAgICAgICAgICAgICAg\nICAgICAgICAgKGNvbm4uZ2V0TWV0YURhdGEoKSkpOwogICAgICAgICAgICB9\nIGNhdGNoIChFeGNlcHRpb24gZSkgewogICAgICAgICAgICAgICAgbG9nLnRy\nYWNlKGUudG9TdHJpbmcoKSwgZSk7CiAgICAgICAgICAgIH0KICAgICAgICB9\nCiAgICAgICAgY29ubmVjdGVkID0gdHJ1ZTsKICAgIH0KCiAgICAvLy8vLy8v\nLy8vLy8vLy8vLy8vLy8vCiAgICAvLyBSZXN1bHRTZXQgd3JhcHBlcnMKICAg\nIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KCiAgICAvKioKICAgICAqIENvbnZl\ncnQgdGhlIHNwZWNpZmllZCBjb2x1bW4gb2YgdGhlIFNRTCBSZXN1bHRTZXQg\ndG8gdGhlIHByb3BlcgogICAgICogamF2YSB0eXBlLgogICAgICovCiAgICBw\ndWJsaWMgQXJyYXkgZ2V0QXJyYXkoUmVzdWx0U2V0IHJzLCBpbnQgY29sdW1u\nKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIHJldHVy\nbiBycy5nZXRBcnJheShjb2x1bW4pOwogICAgfQoKICAgIC8qKgogICAgICog\nQ29udmVydCB0aGUgc3BlY2lmaWVkIGNvbHVtbiBvZiB0aGUgU1FMIFJlc3Vs\ndFNldCB0byB0aGUgcHJvcGVyCiAgICAgKiBqYXZhIHR5cGUuCiAgICAgKi8K\nICAgIHB1YmxpYyBJbnB1dFN0cmVhbSBnZXRBc2NpaVN0cmVhbShSZXN1bHRT\nZXQgcnMsIGludCBjb2x1bW4pCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlv\nbiB7CiAgICAgICAgcmV0dXJuIHJzLmdldEFzY2lpU3RyZWFtKGNvbHVtbik7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBDb252ZXJ0IHRoZSBzcGVjaWZpZWQg\nY29sdW1uIG9mIHRoZSBTUUwgUmVzdWx0U2V0IHRvIHRoZSBwcm9wZXIKICAg\nICAqIGphdmEgdHlwZS4KICAgICAqLwogICAgcHVibGljIEJpZ0RlY2ltYWwg\nZ2V0QmlnRGVjaW1hbChSZXN1bHRTZXQgcnMsIGludCBjb2x1bW4pCiAgICAg\nICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgaWYgKHN0b3JlTGFy\nZ2VOdW1iZXJzQXNTdHJpbmdzKSB7CiAgICAgICAgICAgIFN0cmluZyBzdHIg\nPSBnZXRTdHJpbmcocnMsIGNvbHVtbik7CiAgICAgICAgICAgIHJldHVybiAo\nc3RyID09IG51bGwpID8gbnVsbCA6IG5ldyBCaWdEZWNpbWFsKHN0cik7CiAg\nICAgICAgfQogICAgICAgIHJldHVybiBycy5nZXRCaWdEZWNpbWFsKGNvbHVt\nbik7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm5zIHRoZSBzcGVjaWZp\nZWQgY29sdW1uIHZhbHVlIGFzIGFuIHVua25vd24gbnVtZXJpYyB0eXBlOwog\nICAgICogd2UgdHJ5IGZyb20gdGhlIG1vc3QgZ2VuZXJpYyB0byB0aGUgbGVh\nc3QgZ2VuZXJpYy4KICAgICAqLwogICAgcHVibGljIE51bWJlciBnZXROdW1i\nZXIoUmVzdWx0U2V0IHJzLCBpbnQgY29sdW1uKQogICAgICAgIHRocm93cyBT\nUUxFeGNlcHRpb24gewogICAgICAgIC8vIHRyeSBmcm9tIHRoZSBtb3N0IGdl\nbmVyaWMsIGFuZCBpZiBlcnJvcnMgb2NjdXIsIHRyeQogICAgICAgIC8vIGxl\nc3MgZ2VuZXJpYyB0eXBlczsgdGhpcyBlbmFibGVzIHVzIHRvIGhhbmRsZSB2\nYWx1ZXMKICAgICAgICAvLyBsaWtlIERvdWJsZS5OYU4gd2l0aG91dCBoYXZp\nbmcgdG8gaW50cm9zcGVjdCBvbiB0aGUKICAgICAgICAvLyBSZXN1bHRTZXRN\nZXRhRGF0YSAoYnVnICMxMDUzKS4gbm90ZSB0aGF0IHdlIGhhbmRsZQogICAg\nICAgIC8vIGdlbmVyaWMgZXhjZXB0aW9ucywgc2luY2Ugc29tZSBkcml2ZXJz\nIG1heSB0aHJvdwogICAgICAgIC8vIE51bWJlckZvcm1hdEV4Y2VwdGlvbnMs\nIHdoZXJlYXMgb3RoZXJzIG1heSB0aHJvdyBTUUxFeGNlcHRpb25zCiAgICAg\nICAgdHJ5IHsKICAgICAgICAgICAgcmV0dXJuIGdldEJpZ0RlY2ltYWwocnMs\nIGNvbHVtbik7CiAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUxKSB7CiAg\nICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IERv\ndWJsZShnZXREb3VibGUocnMsIGNvbHVtbikpOwogICAgICAgICAgICB9IGNh\ndGNoIChFeGNlcHRpb24gZTIpIHsKICAgICAgICAgICAgICAgIHRyeSB7CiAg\nICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBGbG9hdChnZXRGbG9hdChy\ncywgY29sdW1uKSk7CiAgICAgICAgICAgICAgICB9IGNhdGNoIChFeGNlcHRp\nb24gZTMpIHsKICAgICAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAg\nICAgICAgICAgICAgICByZXR1cm4gTnVtYmVycy52YWx1ZU9mKGdldExvbmco\ncnMsIGNvbHVtbikpOwogICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKEV4\nY2VwdGlvbiBlNCkgewogICAgICAgICAgICAgICAgICAgICAgICB0cnkgewog\nICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIE51bWJlcnMudmFs\ndWVPZihnZXRJbnQocnMsIGNvbHVtbikpOwogICAgICAgICAgICAgICAgICAg\nICAgICB9IGNhdGNoIChFeGNlcHRpb24gZTUpIHsKICAgICAgICAgICAgICAg\nICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAg\nICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKGUxIGluc3Rh\nbmNlb2YgUnVudGltZUV4Y2VwdGlvbikKICAgICAgICAgICAgICAgIHRocm93\nKFJ1bnRpbWVFeGNlcHRpb24pIGUxOwogICAgICAgICAgICBpZiAoZTEgaW5z\ndGFuY2VvZiBTUUxFeGNlcHRpb24pCiAgICAgICAgICAgICAgICB0aHJvdyhT\nUUxFeGNlcHRpb24pIGUxOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIG51\nbGw7CiAgICB9CgogICAgLyoqCiAgICAgKiBDb252ZXJ0IHRoZSBzcGVjaWZp\nZWQgY29sdW1uIG9mIHRoZSBTUUwgUmVzdWx0U2V0IHRvIHRoZSBwcm9wZXIK\nICAgICAqIGphdmEgdHlwZS4KICAgICAqLwogICAgcHVibGljIEJpZ0ludGVn\nZXIgZ2V0QmlnSW50ZWdlcihSZXN1bHRTZXQgcnMsIGludCBjb2x1bW4pCiAg\nICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgaWYgKHN0b3Jl\nTGFyZ2VOdW1iZXJzQXNTdHJpbmdzKSB7CiAgICAgICAgICAgIFN0cmluZyBz\ndHIgPSBnZXRTdHJpbmcocnMsIGNvbHVtbik7CiAgICAgICAgICAgIHJldHVy\nbiAoc3RyID09IG51bGwpID8gbnVsbCA6IG5ldyBCaWdEZWNpbWFsKHN0ciku\ndG9CaWdJbnRlZ2VyKCk7CiAgICAgICAgfQogICAgICAgIEJpZ0RlY2ltYWwg\nYmQgPSBnZXRCaWdEZWNpbWFsKHJzLCBjb2x1bW4pOwogICAgICAgIHJldHVy\nbiAoYmQgPT0gbnVsbCkgPyBudWxsIDogYmQudG9CaWdJbnRlZ2VyKCk7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBDb252ZXJ0IHRoZSBzcGVjaWZpZWQgY29s\ndW1uIG9mIHRoZSBTUUwgUmVzdWx0U2V0IHRvIHRoZSBwcm9wZXIKICAgICAq\nIGphdmEgdHlwZS4KICAgICAqLwogICAgcHVibGljIElucHV0U3RyZWFtIGdl\ndEJpbmFyeVN0cmVhbShSZXN1bHRTZXQgcnMsIGludCBjb2x1bW4pCiAgICAg\nICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgcmV0dXJuIHJzLmdl\ndEJpbmFyeVN0cmVhbShjb2x1bW4pOwogICAgfQoKICAgIC8qKgogICAgICog\nQ29udmVydCB0aGUgc3BlY2lmaWVkIGNvbHVtbiBvZiB0aGUgU1FMIFJlc3Vs\ndFNldCB0byB0aGUgcHJvcGVyCiAgICAgKiBqYXZhIHR5cGUuCiAgICAgKi8K\nICAgIHB1YmxpYyBCbG9iIGdldEJsb2IoUmVzdWx0U2V0IHJzLCBpbnQgY29s\ndW1uKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIHJl\ndHVybiBycy5nZXRCbG9iKGNvbHVtbik7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBDb252ZXJ0IHRoZSBzcGVjaWZpZWQgY29sdW1uIG9mIHRoZSBTUUwgUmVz\ndWx0U2V0IHRvIHRoZSBwcm9wZXIKICAgICAqIGphdmEgdHlwZS4KICAgICAq\nLwogICAgcHVibGljIE9iamVjdCBnZXRCbG9iT2JqZWN0KFJlc3VsdFNldCBy\ncywgaW50IGNvbHVtbiwgSkRCQ1N0b3JlIHN0b3JlKQogICAgICAgIHRocm93\ncyBTUUxFeGNlcHRpb24gewogICAgICAgIElucHV0U3RyZWFtIGluID0gbnVs\nbDsKICAgICAgICBpZiAodXNlR2V0Qnl0ZXNGb3JCbG9icyB8fCB1c2VHZXRP\nYmplY3RGb3JCbG9icykgewogICAgICAgICAgICBieXRlW10gYnl0ZXMgPSBn\nZXRCeXRlcyhycywgY29sdW1uKTsKICAgICAgICAgICAgaWYgKGJ5dGVzICE9\nIG51bGwgJiYgYnl0ZXMubGVuZ3RoID4gMCkKICAgICAgICAgICAgICAgIGlu\nID0gbmV3IEJ5dGVBcnJheUlucHV0U3RyZWFtKGJ5dGVzKTsKICAgICAgICB9\nIGVsc2UgewogICAgICAgICAgICBCbG9iIGJsb2IgPSBnZXRCbG9iKHJzLCBj\nb2x1bW4pOwogICAgICAgICAgICBpZiAoYmxvYiAhPSBudWxsICYmIGJsb2Iu\nbGVuZ3RoKCkgPiAwKQogICAgICAgICAgICAgICAgaW4gPSBibG9iLmdldEJp\nbmFyeVN0cmVhbSgpOwogICAgICAgIH0KICAgICAgICBpZiAoaW4gPT0gbnVs\nbCkKICAgICAgICAgICAgcmV0dXJuIG51bGw7CgogICAgICAgIHRyeSB7CiAg\nICAgICAgICAgIGlmIChzdG9yZSA9PSBudWxsKQogICAgICAgICAgICAgICAg\ncmV0dXJuIFNlcmlhbGl6YXRpb24uZGVzZXJpYWxpemUoaW4sIG51bGwpOwog\nICAgICAgICAgICByZXR1cm4gU2VyaWFsaXphdGlvbi5kZXNlcmlhbGl6ZShp\nbiwgc3RvcmUuZ2V0Q29udGV4dCgpKTsKICAgICAgICB9IGZpbmFsbHkgewog\nICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgaW4uY2xvc2UoKTsK\nICAgICAgICAgICAgfSBjYXRjaCAoSU9FeGNlcHRpb24gaW9lKSB7CiAgICAg\nICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBDb252\nZXJ0IHRoZSBzcGVjaWZpZWQgY29sdW1uIG9mIHRoZSBTUUwgUmVzdWx0U2V0\nIHRvIHRoZSBwcm9wZXIKICAgICAqIGphdmEgdHlwZS4KICAgICAqLwogICAg\ncHVibGljIGJvb2xlYW4gZ2V0Qm9vbGVhbihSZXN1bHRTZXQgcnMsIGludCBj\nb2x1bW4pCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAg\ncmV0dXJuIHJzLmdldEJvb2xlYW4oY29sdW1uKTsKICAgIH0KCiAgICAvKioK\nICAgICAqIENvbnZlcnQgdGhlIHNwZWNpZmllZCBjb2x1bW4gb2YgdGhlIFNR\nTCBSZXN1bHRTZXQgdG8gdGhlIHByb3BlcgogICAgICogamF2YSB0eXBlLgog\nICAgICovCiAgICBwdWJsaWMgYnl0ZSBnZXRCeXRlKFJlc3VsdFNldCBycywg\naW50IGNvbHVtbikKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAg\nICAgICByZXR1cm4gcnMuZ2V0Qnl0ZShjb2x1bW4pOwogICAgfQoKICAgIC8q\nKgogICAgICogQ29udmVydCB0aGUgc3BlY2lmaWVkIGNvbHVtbiBvZiB0aGUg\nU1FMIFJlc3VsdFNldCB0byB0aGUgcHJvcGVyCiAgICAgKiBqYXZhIHR5cGUu\nCiAgICAgKi8KICAgIHB1YmxpYyBieXRlW10gZ2V0Qnl0ZXMoUmVzdWx0U2V0\nIHJzLCBpbnQgY29sdW1uKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24g\newogICAgICAgIGlmICh1c2VHZXRCeXRlc0ZvckJsb2JzKQogICAgICAgICAg\nICByZXR1cm4gcnMuZ2V0Qnl0ZXMoY29sdW1uKTsKICAgICAgICBpZiAodXNl\nR2V0T2JqZWN0Rm9yQmxvYnMpCiAgICAgICAgICAgIHJldHVybiAoYnl0ZVtd\nKSBycy5nZXRPYmplY3QoY29sdW1uKTsKCiAgICAgICAgQmxvYiBibG9iID0g\nZ2V0QmxvYihycywgY29sdW1uKTsKICAgICAgICBpZiAoYmxvYiA9PSBudWxs\nKQogICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICBpbnQgbGVuZ3Ro\nID0gKGludCkgYmxvYi5sZW5ndGgoKTsKICAgICAgICBpZiAobGVuZ3RoID09\nIDApCiAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgIHJldHVybiBi\nbG9iLmdldEJ5dGVzKDEsIGxlbmd0aCk7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBDb252ZXJ0IHRoZSBzcGVjaWZpZWQgY29sdW1uIG9mIHRoZSBTUUwgUmVz\ndWx0U2V0IHRvIHRoZSBwcm9wZXIKICAgICAqIGphdmEgdHlwZS4gQ29udmVy\ndHMgdGhlIGRhdGUgZnJvbSBhIHtAbGluayBUaW1lc3RhbXB9IGJ5IGRlZmF1\nbHQuCiAgICAgKi8KICAgIHB1YmxpYyBDYWxlbmRhciBnZXRDYWxlbmRhcihS\nZXN1bHRTZXQgcnMsIGludCBjb2x1bW4pCiAgICAgICAgdGhyb3dzIFNRTEV4\nY2VwdGlvbiB7CiAgICAgICAgRGF0ZSBkID0gZ2V0RGF0ZShycywgY29sdW1u\nKTsKICAgICAgICBpZiAoZCA9PSBudWxsKQogICAgICAgICAgICByZXR1cm4g\nbnVsbDsKCiAgICAgICAgQ2FsZW5kYXIgY2FsID0gQ2FsZW5kYXIuZ2V0SW5z\ndGFuY2UoKTsKICAgICAgICBjYWwuc2V0VGltZShkKTsKICAgICAgICByZXR1\ncm4gY2FsOwogICAgfQoKICAgIC8qKgogICAgICogQ29udmVydCB0aGUgc3Bl\nY2lmaWVkIGNvbHVtbiBvZiB0aGUgU1FMIFJlc3VsdFNldCB0byB0aGUgcHJv\ncGVyCiAgICAgKiBqYXZhIHR5cGUuCiAgICAgKi8KICAgIHB1YmxpYyBjaGFy\nIGdldENoYXIoUmVzdWx0U2V0IHJzLCBpbnQgY29sdW1uKQogICAgICAgIHRo\ncm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIGlmIChzdG9yZUNoYXJzQXNO\ndW1iZXJzKQogICAgICAgICAgICByZXR1cm4gKGNoYXIpIGdldEludChycywg\nY29sdW1uKTsKCiAgICAgICAgU3RyaW5nIHN0ciA9IGdldFN0cmluZyhycywg\nY29sdW1uKTsKICAgICAgICByZXR1cm4gKFN0cmluZ1V0aWxzLmlzRW1wdHko\nc3RyKSkgPyAwIDogc3RyLmNoYXJBdCgwKTsKICAgIH0KCiAgICAvKioKICAg\nICAqIENvbnZlcnQgdGhlIHNwZWNpZmllZCBjb2x1bW4gb2YgdGhlIFNRTCBS\nZXN1bHRTZXQgdG8gdGhlIHByb3BlcgogICAgICogamF2YSB0eXBlLgogICAg\nICovCiAgICBwdWJsaWMgUmVhZGVyIGdldENoYXJhY3RlclN0cmVhbShSZXN1\nbHRTZXQgcnMsIGludCBjb2x1bW4pCiAgICAgICAgdGhyb3dzIFNRTEV4Y2Vw\ndGlvbiB7CiAgICAgICAgcmV0dXJuIHJzLmdldENoYXJhY3RlclN0cmVhbShj\nb2x1bW4pOwogICAgfQoKICAgIC8qKgogICAgICogQ29udmVydCB0aGUgc3Bl\nY2lmaWVkIGNvbHVtbiBvZiB0aGUgU1FMIFJlc3VsdFNldCB0byB0aGUgcHJv\ncGVyCiAgICAgKiBqYXZhIHR5cGUuCiAgICAgKi8KICAgIHB1YmxpYyBDbG9i\nIGdldENsb2IoUmVzdWx0U2V0IHJzLCBpbnQgY29sdW1uKQogICAgICAgIHRo\ncm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIHJldHVybiBycy5nZXRDbG9i\nKGNvbHVtbik7CiAgICB9CgogICAgLyoqCiAgICAgKiBDb252ZXJ0IHRoZSBz\ncGVjaWZpZWQgY29sdW1uIG9mIHRoZSBTUUwgUmVzdWx0U2V0IHRvIHRoZSBw\ncm9wZXIKICAgICAqIGphdmEgdHlwZS4KICAgICAqLwogICAgcHVibGljIFN0\ncmluZyBnZXRDbG9iU3RyaW5nKFJlc3VsdFNldCBycywgaW50IGNvbHVtbikK\nICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBpZiAodXNl\nR2V0U3RyaW5nRm9yQ2xvYnMpCiAgICAgICAgICAgIHJldHVybiBycy5nZXRT\ndHJpbmcoY29sdW1uKTsKCiAgICAgICAgQ2xvYiBjbG9iID0gZ2V0Q2xvYihy\ncywgY29sdW1uKTsKICAgICAgICBpZiAoY2xvYiA9PSBudWxsKQogICAgICAg\nICAgICByZXR1cm4gbnVsbDsKICAgICAgICBpZiAoY2xvYi5sZW5ndGgoKSA9\nPSAwKQogICAgICAgICAgICByZXR1cm4gIiI7CgogICAgICAgIC8vIHVubGlr\nZWx5IHRoYXQgd2UnbGwgaGF2ZSBzdHJpbmdzIG92ZXIgSW50ZWdlci5NQVhf\nVkFMVUUgY2hhcnMKICAgICAgICByZXR1cm4gY2xvYi5nZXRTdWJTdHJpbmco\nMSwgKGludCkgY2xvYi5sZW5ndGgoKSk7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBDb252ZXJ0IHRoZSBzcGVjaWZpZWQgY29sdW1uIG9mIHRoZSBTUUwgUmVz\ndWx0U2V0IHRvIHRoZSBwcm9wZXIKICAgICAqIGphdmEgdHlwZS4gQ29udmVy\ndHMgdGhlIGRhdGUgZnJvbSBhIHtAbGluayBUaW1lc3RhbXB9IGJ5IGRlZmF1\nbHQuCiAgICAgKi8KICAgIHB1YmxpYyBEYXRlIGdldERhdGUoUmVzdWx0U2V0\nIHJzLCBpbnQgY29sdW1uKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24g\newogICAgICAgIFRpbWVzdGFtcCB0c3RhbXAgPSBnZXRUaW1lc3RhbXAocnMs\nIGNvbHVtbiwgbnVsbCk7CiAgICAgICAgaWYgKHRzdGFtcCA9PSBudWxsKQog\nICAgICAgICAgICByZXR1cm4gbnVsbDsKCiAgICAgICAgLy8gZ2V0IHRoZSBm\ncmFjdGlvbmFsIHNlY29uZHMgY29tcG9uZW50LCByb3VuZGluZyBhd2F5IGFu\neXRoaW5nIGJleW9uZAogICAgICAgIC8vIG1pbGxpc2Vjb25kcwogICAgICAg\nIGludCBmcmFjdGlvbmFsID0gKGludCkgTWF0aC5yb3VuZCh0c3RhbXAuZ2V0\nTmFub3MoKSAvIChkb3VibGUpIE1JTExJKTsKCiAgICAgICAgLy8gZ2V0IHRo\nZSBtaWxsaXMgY29tcG9uZW50OyBzb21lIEpEQkMgZHJpdmVycyByb3VuZCB0\naGlzIHRvIHRoZQogICAgICAgIC8vIG5lYXJlc3Qgc2Vjb25kLCB3aGlsZSBv\ndGhlcnMgZG8gbm90CiAgICAgICAgbG9uZyBtaWxsaXMgPSAodHN0YW1wLmdl\ndFRpbWUoKSAvIDEwMDBMKSAqIDEwMDBMOwogICAgICAgIHJldHVybiBuZXcg\nRGF0ZShtaWxsaXMgKyBmcmFjdGlvbmFsKTsKICAgIH0KCiAgICAvKioKICAg\nICAqIENvbnZlcnQgdGhlIHNwZWNpZmllZCBjb2x1bW4gb2YgdGhlIFNRTCBS\nZXN1bHRTZXQgdG8gdGhlIHByb3BlcgogICAgICogamF2YSB0eXBlLgogICAg\nICovCiAgICBwdWJsaWMgamF2YS5zcWwuRGF0ZSBnZXREYXRlKFJlc3VsdFNl\ndCBycywgaW50IGNvbHVtbiwgQ2FsZW5kYXIgY2FsKQogICAgICAgIHRocm93\ncyBTUUxFeGNlcHRpb24gewogICAgICAgIGlmIChjYWwgPT0gbnVsbCkKICAg\nICAgICAgICAgcmV0dXJuIHJzLmdldERhdGUoY29sdW1uKTsKICAgICAgICBy\nZXR1cm4gcnMuZ2V0RGF0ZShjb2x1bW4sIGNhbCk7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBDb252ZXJ0IHRoZSBzcGVjaWZpZWQgY29sdW1uIG9mIHRoZSBT\nUUwgUmVzdWx0U2V0IHRvIHRoZSBwcm9wZXIKICAgICAqIGphdmEgdHlwZS4K\nICAgICAqLwogICAgcHVibGljIGRvdWJsZSBnZXREb3VibGUoUmVzdWx0U2V0\nIHJzLCBpbnQgY29sdW1uKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24g\newogICAgICAgIHJldHVybiBycy5nZXREb3VibGUoY29sdW1uKTsKICAgIH0K\nCiAgICAvKioKICAgICAqIENvbnZlcnQgdGhlIHNwZWNpZmllZCBjb2x1bW4g\nb2YgdGhlIFNRTCBSZXN1bHRTZXQgdG8gdGhlIHByb3BlcgogICAgICogamF2\nYSB0eXBlLgogICAgICovCiAgICBwdWJsaWMgZmxvYXQgZ2V0RmxvYXQoUmVz\ndWx0U2V0IHJzLCBpbnQgY29sdW1uKQogICAgICAgIHRocm93cyBTUUxFeGNl\ncHRpb24gewogICAgICAgIHJldHVybiBycy5nZXRGbG9hdChjb2x1bW4pOwog\nICAgfQoKICAgIC8qKgogICAgICogQ29udmVydCB0aGUgc3BlY2lmaWVkIGNv\nbHVtbiBvZiB0aGUgU1FMIFJlc3VsdFNldCB0byB0aGUgcHJvcGVyCiAgICAg\nKiBqYXZhIHR5cGUuCiAgICAgKi8KICAgIHB1YmxpYyBpbnQgZ2V0SW50KFJl\nc3VsdFNldCBycywgaW50IGNvbHVtbikKICAgICAgICB0aHJvd3MgU1FMRXhj\nZXB0aW9uIHsKICAgICAgICByZXR1cm4gcnMuZ2V0SW50KGNvbHVtbik7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBDb252ZXJ0IHRoZSBzcGVjaWZpZWQgY29s\ndW1uIG9mIHRoZSBTUUwgUmVzdWx0U2V0IHRvIHRoZSBwcm9wZXIKICAgICAq\nIGphdmEgdHlwZS4KICAgICAqLwogICAgcHVibGljIExvY2FsZSBnZXRMb2Nh\nbGUoUmVzdWx0U2V0IHJzLCBpbnQgY29sdW1uKQogICAgICAgIHRocm93cyBT\nUUxFeGNlcHRpb24gewogICAgICAgIFN0cmluZyBzdHIgPSBnZXRTdHJpbmco\ncnMsIGNvbHVtbik7CiAgICAgICAgaWYgKFN0cmluZ1V0aWxzLmlzRW1wdHko\nc3RyKSkKICAgICAgICAgICAgcmV0dXJuIG51bGw7CgogICAgICAgIFN0cmlu\nZ1tdIHBhcmFtcyA9IFN0cmluZ3Muc3BsaXQoc3RyLCAiXyIsIDMpOwogICAg\nICAgIGlmIChwYXJhbXMubGVuZ3RoIDwgMykKICAgICAgICAgICAgcmV0dXJu\nIG51bGw7CiAgICAgICAgcmV0dXJuIG5ldyBMb2NhbGUocGFyYW1zWzBdLCBw\nYXJhbXNbMV0sIHBhcmFtc1syXSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBD\nb252ZXJ0IHRoZSBzcGVjaWZpZWQgY29sdW1uIG9mIHRoZSBTUUwgUmVzdWx0\nU2V0IHRvIHRoZSBwcm9wZXIKICAgICAqIGphdmEgdHlwZS4KICAgICAqLwog\nICAgcHVibGljIGxvbmcgZ2V0TG9uZyhSZXN1bHRTZXQgcnMsIGludCBjb2x1\nbW4pCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgcmV0\ndXJuIHJzLmdldExvbmcoY29sdW1uKTsKICAgIH0KCiAgICAvKioKICAgICAq\nIENvbnZlcnQgdGhlIHNwZWNpZmllZCBjb2x1bW4gb2YgdGhlIFNRTCBSZXN1\nbHRTZXQgdG8gdGhlIHByb3BlcgogICAgICogamF2YSB0eXBlLgogICAgICov\nCiAgICBwdWJsaWMgT2JqZWN0IGdldE9iamVjdChSZXN1bHRTZXQgcnMsIGlu\ndCBjb2x1bW4sIE1hcCBtYXApCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlv\nbiB7CiAgICAgICAgaWYgKG1hcCA9PSBudWxsKQogICAgICAgICAgICByZXR1\ncm4gcnMuZ2V0T2JqZWN0KGNvbHVtbik7CiAgICAgICAgcmV0dXJuIHJzLmdl\ndE9iamVjdChjb2x1bW4sIG1hcCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBD\nb252ZXJ0IHRoZSBzcGVjaWZpZWQgY29sdW1uIG9mIHRoZSBTUUwgUmVzdWx0\nU2V0IHRvIHRoZSBwcm9wZXIKICAgICAqIGphdmEgdHlwZS4KICAgICAqLwog\nICAgcHVibGljIFJlZiBnZXRSZWYoUmVzdWx0U2V0IHJzLCBpbnQgY29sdW1u\nLCBNYXAgbWFwKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAg\nICAgIHJldHVybiBycy5nZXRSZWYoY29sdW1uKTsKICAgIH0KCiAgICAvKioK\nICAgICAqIENvbnZlcnQgdGhlIHNwZWNpZmllZCBjb2x1bW4gb2YgdGhlIFNR\nTCBSZXN1bHRTZXQgdG8gdGhlIHByb3BlcgogICAgICogamF2YSB0eXBlLgog\nICAgICovCiAgICBwdWJsaWMgc2hvcnQgZ2V0U2hvcnQoUmVzdWx0U2V0IHJz\nLCBpbnQgY29sdW1uKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewog\nICAgICAgIHJldHVybiBycy5nZXRTaG9ydChjb2x1bW4pOwogICAgfQoKICAg\nIC8qKgogICAgICogQ29udmVydCB0aGUgc3BlY2lmaWVkIGNvbHVtbiBvZiB0\naGUgU1FMIFJlc3VsdFNldCB0byB0aGUgcHJvcGVyCiAgICAgKiBqYXZhIHR5\ncGUuCiAgICAgKi8KICAgIHB1YmxpYyBTdHJpbmcgZ2V0U3RyaW5nKFJlc3Vs\ndFNldCBycywgaW50IGNvbHVtbikKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0\naW9uIHsKICAgICAgICByZXR1cm4gcnMuZ2V0U3RyaW5nKGNvbHVtbik7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBDb252ZXJ0IHRoZSBzcGVjaWZpZWQgY29s\ndW1uIG9mIHRoZSBTUUwgUmVzdWx0U2V0IHRvIHRoZSBwcm9wZXIKICAgICAq\nIGphdmEgdHlwZS4KICAgICAqLwogICAgcHVibGljIFRpbWUgZ2V0VGltZShS\nZXN1bHRTZXQgcnMsIGludCBjb2x1bW4sIENhbGVuZGFyIGNhbCkKICAgICAg\nICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBpZiAoY2FsID09IG51\nbGwpCiAgICAgICAgICAgIHJldHVybiBycy5nZXRUaW1lKGNvbHVtbik7CiAg\nICAgICAgcmV0dXJuIHJzLmdldFRpbWUoY29sdW1uLCBjYWwpOwogICAgfQoK\nICAgIC8qKgogICAgICogQ29udmVydCB0aGUgc3BlY2lmaWVkIGNvbHVtbiBv\nZiB0aGUgU1FMIFJlc3VsdFNldCB0byB0aGUgcHJvcGVyCiAgICAgKiBqYXZh\nIHR5cGUuCiAgICAgKi8KICAgIHB1YmxpYyBUaW1lc3RhbXAgZ2V0VGltZXN0\nYW1wKFJlc3VsdFNldCBycywgaW50IGNvbHVtbiwgQ2FsZW5kYXIgY2FsKQog\nICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIGlmIChjYWwg\nPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIHJzLmdldFRpbWVzdGFtcChj\nb2x1bW4pOwogICAgICAgIHJldHVybiBycy5nZXRUaW1lc3RhbXAoY29sdW1u\nLCBjYWwpOwogICAgfQoKICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v\nLy8vLwogICAgLy8gUHJlcGFyZWRTdGF0ZW1lbnQgd3JhcHBlcnMKICAgIC8v\nLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwoKICAgIC8qKgogICAgICog\nU2V0IHRoZSBnaXZlbiB2YWx1ZSBhcyBhIHBhcmFtZXRlciB0byB0aGUgc3Rh\ndGVtZW50LgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRBcnJheShQcmVw\nYXJlZFN0YXRlbWVudCBzdG1udCwgaW50IGlkeCwgQXJyYXkgdmFsLAogICAg\nICAgIENvbHVtbiBjb2wpCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7\nCiAgICAgICAgc3RtbnQuc2V0QXJyYXkoaWR4LCB2YWwpOwogICAgfQoKICAg\nIC8qKgogICAgICogU2V0IHRoZSBnaXZlbiB2YWx1ZSBhcyBhIHBhcmFtZXRl\nciB0byB0aGUgc3RhdGVtZW50LgogICAgICovCiAgICBwdWJsaWMgdm9pZCBz\nZXRBc2NpaVN0cmVhbShQcmVwYXJlZFN0YXRlbWVudCBzdG1udCwgaW50IGlk\neCwKICAgICAgICBJbnB1dFN0cmVhbSB2YWwsIGludCBsZW5ndGgsIENvbHVt\nbiBjb2wpCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAg\nc3RtbnQuc2V0QXNjaWlTdHJlYW0oaWR4LCB2YWwsIGxlbmd0aCk7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBTZXQgdGhlIGdpdmVuIHZhbHVlIGFzIGEgcGFy\nYW1ldGVyIHRvIHRoZSBzdGF0ZW1lbnQuCiAgICAgKi8KICAgIHB1YmxpYyB2\nb2lkIHNldEJpZ0RlY2ltYWwoUHJlcGFyZWRTdGF0ZW1lbnQgc3RtbnQsIGlu\ndCBpZHgsIEJpZ0RlY2ltYWwgdmFsLAogICAgICAgIENvbHVtbiBjb2wpCiAg\nICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgaWYgKChjb2wg\nIT0gbnVsbCAmJiBjb2wuaXNDb21wYXRpYmxlKFR5cGVzLlZBUkNIQVIsIG51\nbGwsIDAsIDApKQogICAgICAgICAgICB8fCAoY29sID09IG51bGwgJiYgc3Rv\ncmVMYXJnZU51bWJlcnNBc1N0cmluZ3MpKQogICAgICAgICAgICBzZXRTdHJp\nbmcoc3RtbnQsIGlkeCwgdmFsLnRvU3RyaW5nKCksIGNvbCk7CiAgICAgICAg\nZWxzZQogICAgICAgICAgICBzdG1udC5zZXRCaWdEZWNpbWFsKGlkeCwgdmFs\nKTsKICAgIH0KCiAgICAvKioKICAgICAqIFNldCB0aGUgZ2l2ZW4gdmFsdWUg\nYXMgYSBwYXJhbWV0ZXIgdG8gdGhlIHN0YXRlbWVudC4KICAgICAqLwogICAg\ncHVibGljIHZvaWQgc2V0QmlnSW50ZWdlcihQcmVwYXJlZFN0YXRlbWVudCBz\ndG1udCwgaW50IGlkeCwgQmlnSW50ZWdlciB2YWwsCiAgICAgICAgQ29sdW1u\nIGNvbCkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBp\nZiAoKGNvbCAhPSBudWxsICYmIGNvbC5pc0NvbXBhdGlibGUoVHlwZXMuVkFS\nQ0hBUiwgbnVsbCwgMCwgMCkpCiAgICAgICAgICAgIHx8IChjb2wgPT0gbnVs\nbCAmJiBzdG9yZUxhcmdlTnVtYmVyc0FzU3RyaW5ncykpCiAgICAgICAgICAg\nIHNldFN0cmluZyhzdG1udCwgaWR4LCB2YWwudG9TdHJpbmcoKSwgY29sKTsK\nICAgICAgICBlbHNlCiAgICAgICAgICAgIHNldEJpZ0RlY2ltYWwoc3RtbnQs\nIGlkeCwgbmV3IEJpZ0RlY2ltYWwodmFsKSwgY29sKTsKICAgIH0KCiAgICAv\nKioKICAgICAqIFNldCB0aGUgZ2l2ZW4gdmFsdWUgYXMgYSBwYXJhbWV0ZXIg\ndG8gdGhlIHN0YXRlbWVudC4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0\nQmluYXJ5U3RyZWFtKFByZXBhcmVkU3RhdGVtZW50IHN0bW50LCBpbnQgaWR4\nLAogICAgICAgIElucHV0U3RyZWFtIHZhbCwgaW50IGxlbmd0aCwgQ29sdW1u\nIGNvbCkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBz\ndG1udC5zZXRCaW5hcnlTdHJlYW0oaWR4LCB2YWwsIGxlbmd0aCk7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBTZXQgdGhlIGdpdmVuIHZhbHVlIGFzIGEgcGFy\nYW1ldGVyIHRvIHRoZSBzdGF0ZW1lbnQuCiAgICAgKi8KICAgIHB1YmxpYyB2\nb2lkIHNldEJsb2IoUHJlcGFyZWRTdGF0ZW1lbnQgc3RtbnQsIGludCBpZHgs\nIEJsb2IgdmFsLCBDb2x1bW4gY29sKQogICAgICAgIHRocm93cyBTUUxFeGNl\ncHRpb24gewogICAgICAgIHN0bW50LnNldEJsb2IoaWR4LCB2YWwpOwogICAg\nfQoKICAgIC8qKgogICAgICogU2V0IHRoZSBnaXZlbiB2YWx1ZSBhcyBhIHBh\ncmFtZXRlciB0byB0aGUgc3RhdGVtZW50LiBVc2VzIHRoZQogICAgICoge0Bs\naW5rICNzZXJpYWxpemV9IG1ldGhvZCB0byBzZXJpYWxpemUgdGhlIHZhbHVl\nLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRCbG9iT2JqZWN0KFByZXBh\ncmVkU3RhdGVtZW50IHN0bW50LCBpbnQgaWR4LCBPYmplY3QgdmFsLAogICAg\nICAgIENvbHVtbiBjb2wsIEpEQkNTdG9yZSBzdG9yZSkKICAgICAgICB0aHJv\nd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBzZXRCeXRlcyhzdG1udCwgaWR4\nLCBzZXJpYWxpemUodmFsLCBzdG9yZSksIGNvbCk7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBTZXQgdGhlIGdpdmVuIHZhbHVlIGFzIGEgcGFyYW1ldGVyIHRv\nIHRoZSBzdGF0ZW1lbnQuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldEJv\nb2xlYW4oUHJlcGFyZWRTdGF0ZW1lbnQgc3RtbnQsIGludCBpZHgsIGJvb2xl\nYW4gdmFsLAogICAgICAgIENvbHVtbiBjb2wpCiAgICAgICAgdGhyb3dzIFNR\nTEV4Y2VwdGlvbiB7CiAgICAgICAgc3RtbnQuc2V0SW50KGlkeCwgKHZhbCkg\nPyAxIDogMCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBTZXQgdGhlIGdpdmVu\nIHZhbHVlIGFzIGEgcGFyYW1ldGVyIHRvIHRoZSBzdGF0ZW1lbnQuCiAgICAg\nKi8KICAgIHB1YmxpYyB2b2lkIHNldEJ5dGUoUHJlcGFyZWRTdGF0ZW1lbnQg\nc3RtbnQsIGludCBpZHgsIGJ5dGUgdmFsLCBDb2x1bW4gY29sKQogICAgICAg\nIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIHN0bW50LnNldEJ5dGUo\naWR4LCB2YWwpOwogICAgfQoKICAgIC8qKgogICAgICogU2V0IHRoZSBnaXZl\nbiB2YWx1ZSBhcyBhIHBhcmFtZXRlciB0byB0aGUgc3RhdGVtZW50LgogICAg\nICovCiAgICBwdWJsaWMgdm9pZCBzZXRCeXRlcyhQcmVwYXJlZFN0YXRlbWVu\ndCBzdG1udCwgaW50IGlkeCwgYnl0ZVtdIHZhbCwKICAgICAgICBDb2x1bW4g\nY29sKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIGlm\nICh1c2VTZXRCeXRlc0ZvckJsb2JzKQogICAgICAgICAgICBzdG1udC5zZXRC\neXRlcyhpZHgsIHZhbCk7CiAgICAgICAgZWxzZQogICAgICAgICAgICBzZXRC\naW5hcnlTdHJlYW0oc3RtbnQsIGlkeCwgbmV3IEJ5dGVBcnJheUlucHV0U3Ry\nZWFtKHZhbCksCiAgICAgICAgICAgICAgICB2YWwubGVuZ3RoLCBjb2wpOwog\nICAgfQoKICAgIC8qKgogICAgICogU2V0IHRoZSBnaXZlbiB2YWx1ZSBhcyBh\nIHBhcmFtZXRlciB0byB0aGUgc3RhdGVtZW50LgogICAgICovCiAgICBwdWJs\naWMgdm9pZCBzZXRDaGFyKFByZXBhcmVkU3RhdGVtZW50IHN0bW50LCBpbnQg\naWR4LCBjaGFyIHZhbCwgQ29sdW1uIGNvbCkKICAgICAgICB0aHJvd3MgU1FM\nRXhjZXB0aW9uIHsKICAgICAgICBpZiAoKGNvbCAhPSBudWxsICYmIGNvbC5p\nc0NvbXBhdGlibGUoVHlwZXMuSU5URUdFUiwgbnVsbCwgMCwgMCkpCiAgICAg\nICAgICAgIHx8IChjb2wgPT0gbnVsbCAmJiBzdG9yZUNoYXJzQXNOdW1iZXJz\nKSkKICAgICAgICAgICAgc2V0SW50KHN0bW50LCBpZHgsIChpbnQpIHZhbCwg\nY29sKTsKICAgICAgICBlbHNlCiAgICAgICAgICAgIHNldFN0cmluZyhzdG1u\ndCwgaWR4LCBTdHJpbmcudmFsdWVPZih2YWwpLCBjb2wpOwogICAgfQoKICAg\nIC8qKgogICAgICogU2V0IHRoZSBnaXZlbiB2YWx1ZSBhcyBhIHBhcmFtZXRl\nciB0byB0aGUgc3RhdGVtZW50LgogICAgICovCiAgICBwdWJsaWMgdm9pZCBz\nZXRDaGFyYWN0ZXJTdHJlYW0oUHJlcGFyZWRTdGF0ZW1lbnQgc3RtbnQsIGlu\ndCBpZHgsCiAgICAgICAgUmVhZGVyIHZhbCwgaW50IGxlbmd0aCwgQ29sdW1u\nIGNvbCkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBz\ndG1udC5zZXRDaGFyYWN0ZXJTdHJlYW0oaWR4LCB2YWwsIGxlbmd0aCk7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBTZXQgdGhlIGdpdmVuIHZhbHVlIGFzIGEg\ncGFyYW1ldGVyIHRvIHRoZSBzdGF0ZW1lbnQuCiAgICAgKi8KICAgIHB1Ymxp\nYyB2b2lkIHNldENsb2IoUHJlcGFyZWRTdGF0ZW1lbnQgc3RtbnQsIGludCBp\nZHgsIENsb2IgdmFsLCBDb2x1bW4gY29sKQogICAgICAgIHRocm93cyBTUUxF\neGNlcHRpb24gewogICAgICAgIHN0bW50LnNldENsb2IoaWR4LCB2YWwpOwog\nICAgfQoKICAgIC8qKgogICAgICogU2V0IHRoZSBnaXZlbiB2YWx1ZSBhcyBh\nIHBhcmFtZXRlciB0byB0aGUgc3RhdGVtZW50LgogICAgICovCiAgICBwdWJs\naWMgdm9pZCBzZXRDbG9iU3RyaW5nKFByZXBhcmVkU3RhdGVtZW50IHN0bW50\nLCBpbnQgaWR4LCBTdHJpbmcgdmFsLAogICAgICAgIENvbHVtbiBjb2wpCiAg\nICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgaWYgKHVzZVNl\ndFN0cmluZ0ZvckNsb2JzKQogICAgICAgICAgICBzdG1udC5zZXRTdHJpbmco\naWR4LCB2YWwpOwogICAgICAgIGVsc2UgewogICAgICAgICAgICAvLyBzZXQg\ncmVhZGVyIGZyb20gc3RyaW5nCiAgICAgICAgICAgIFN0cmluZ1JlYWRlciBp\nbiA9IG5ldyBTdHJpbmdSZWFkZXIodmFsKTsKICAgICAgICAgICAgc2V0Q2hh\ncmFjdGVyU3RyZWFtKHN0bW50LCBpZHgsIGluLCB2YWwubGVuZ3RoKCksIGNv\nbCk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogU2V0IHRoZSBn\naXZlbiB2YWx1ZSBhcyBhIHBhcmFtZXRlciB0byB0aGUgc3RhdGVtZW50Lgog\nICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXREYXRlKFByZXBhcmVkU3RhdGVt\nZW50IHN0bW50LCBpbnQgaWR4LCBEYXRlIHZhbCwgQ29sdW1uIGNvbCkKICAg\nICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBpZiAoY29sICE9\nIG51bGwgJiYgY29sLmdldFR5cGUoKSA9PSBUeXBlcy5EQVRFKQogICAgICAg\nICAgICBzZXREYXRlKHN0bW50LCBpZHgsIG5ldyBqYXZhLnNxbC5EYXRlKHZh\nbC5nZXRUaW1lKCkpLCBudWxsLCBjb2wpOwogICAgICAgIGVsc2UgaWYgKGNv\nbCAhPSBudWxsICYmIGNvbC5nZXRUeXBlKCkgPT0gVHlwZXMuVElNRSkKICAg\nICAgICAgICAgc2V0VGltZShzdG1udCwgaWR4LCBuZXcgVGltZSh2YWwuZ2V0\nVGltZSgpKSwgbnVsbCwgY29sKTsKICAgICAgICBlbHNlIGlmICh2YWwgaW5z\ndGFuY2VvZiBUaW1lc3RhbXApCiAgICAgICAgICAgIHNldFRpbWVzdGFtcChz\ndG1udCwgaWR4LChUaW1lc3RhbXApIHZhbCwgbnVsbCwgY29sKTsgICAKICAg\nICAgICBlbHNlCiAgICAgICAgICAgIHNldFRpbWVzdGFtcChzdG1udCwgaWR4\nLCBuZXcgVGltZXN0YW1wKHZhbC5nZXRUaW1lKCkpLCBudWxsLCBjb2wpOwog\nICAgfQoKICAgIC8qKgogICAgICogU2V0IHRoZSBnaXZlbiB2YWx1ZSBhcyBh\nIHBhcmFtZXRlciB0byB0aGUgc3RhdGVtZW50LgogICAgICovCiAgICBwdWJs\naWMgdm9pZCBzZXREYXRlKFByZXBhcmVkU3RhdGVtZW50IHN0bW50LCBpbnQg\naWR4LCBqYXZhLnNxbC5EYXRlIHZhbCwKICAgICAgICBDYWxlbmRhciBjYWws\nIENvbHVtbiBjb2wpCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAg\nICAgICAgaWYgKGNhbCA9PSBudWxsKQogICAgICAgICAgICBzdG1udC5zZXRE\nYXRlKGlkeCwgdmFsKTsKICAgICAgICBlbHNlCiAgICAgICAgICAgIHN0bW50\nLnNldERhdGUoaWR4LCB2YWwsIGNhbCk7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBTZXQgdGhlIGdpdmVuIHZhbHVlIGFzIGEgcGFyYW1ldGVyIHRvIHRoZSBz\ndGF0ZW1lbnQuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldENhbGVuZGFy\nKFByZXBhcmVkU3RhdGVtZW50IHN0bW50LCBpbnQgaWR4LCBDYWxlbmRhciB2\nYWwsCiAgICAgICAgQ29sdW1uIGNvbCkKICAgICAgICB0aHJvd3MgU1FMRXhj\nZXB0aW9uIHsKICAgICAgICAvLyBieSBkZWZhdWx0IHdlIG1lcmVseSBkZWxl\nZ2F0ZSB0aGUgdGhlIERhdGUgcGFyYW1ldGVyCiAgICAgICAgc2V0RGF0ZShz\ndG1udCwgaWR4LCB2YWwuZ2V0VGltZSgpLCBjb2wpOwogICAgfQoKICAgIC8q\nKgogICAgICogU2V0IHRoZSBnaXZlbiB2YWx1ZSBhcyBhIHBhcmFtZXRlciB0\nbyB0aGUgc3RhdGVtZW50LgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRE\nb3VibGUoUHJlcGFyZWRTdGF0ZW1lbnQgc3RtbnQsIGludCBpZHgsIGRvdWJs\nZSB2YWwsCiAgICAgICAgQ29sdW1uIGNvbCkKICAgICAgICB0aHJvd3MgU1FM\nRXhjZXB0aW9uIHsKICAgICAgICBzdG1udC5zZXREb3VibGUoaWR4LCB2YWwp\nOwogICAgfQoKICAgIC8qKgogICAgICogU2V0IHRoZSBnaXZlbiB2YWx1ZSBh\ncyBhIHBhcmFtZXRlciB0byB0aGUgc3RhdGVtZW50LgogICAgICovCiAgICBw\ndWJsaWMgdm9pZCBzZXRGbG9hdChQcmVwYXJlZFN0YXRlbWVudCBzdG1udCwg\naW50IGlkeCwgZmxvYXQgdmFsLAogICAgICAgIENvbHVtbiBjb2wpCiAgICAg\nICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgc3RtbnQuc2V0Rmxv\nYXQoaWR4LCB2YWwpOwogICAgfQoKICAgIC8qKgogICAgICogU2V0IHRoZSBn\naXZlbiB2YWx1ZSBhcyBhIHBhcmFtZXRlciB0byB0aGUgc3RhdGVtZW50Lgog\nICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRJbnQoUHJlcGFyZWRTdGF0ZW1l\nbnQgc3RtbnQsIGludCBpZHgsIGludCB2YWwsIENvbHVtbiBjb2wpCiAgICAg\nICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgc3RtbnQuc2V0SW50\nKGlkeCwgdmFsKTsKICAgIH0KCiAgICAvKioKICAgICAqIFNldCB0aGUgZ2l2\nZW4gdmFsdWUgYXMgYSBwYXJhbWV0ZXIgdG8gdGhlIHN0YXRlbWVudC4KICAg\nICAqLwogICAgcHVibGljIHZvaWQgc2V0TG9uZyhQcmVwYXJlZFN0YXRlbWVu\ndCBzdG1udCwgaW50IGlkeCwgbG9uZyB2YWwsIENvbHVtbiBjb2wpCiAgICAg\nICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgc3RtbnQuc2V0TG9u\nZyhpZHgsIHZhbCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBTZXQgdGhlIGdp\ndmVuIHZhbHVlIGFzIGEgcGFyYW1ldGVyIHRvIHRoZSBzdGF0ZW1lbnQuCiAg\nICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldExvY2FsZShQcmVwYXJlZFN0YXRl\nbWVudCBzdG1udCwgaW50IGlkeCwgTG9jYWxlIHZhbCwKICAgICAgICBDb2x1\nbW4gY29sKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAg\nIHNldFN0cmluZyhzdG1udCwgaWR4LCB2YWwuZ2V0TGFuZ3VhZ2UoKSArICJf\nIiArIHZhbC5nZXRDb3VudHJ5KCkKICAgICAgICAgICAgKyAiXyIgKyB2YWwu\nZ2V0VmFyaWFudCgpLCBjb2wpOwogICAgfQoKICAgIC8qKgogICAgICogU2V0\nIHRoZSBnaXZlbiB2YWx1ZSBhcyBhIHBhcmFtZXRlcnMgdG8gdGhlIHN0YXRl\nbWVudC4gVGhlIGNvbHVtbgogICAgICogdHlwZSB3aWxsIGNvbWUgZnJvbSB7\nQGxpbmsgVHlwZXN9LgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXROdWxs\nKFByZXBhcmVkU3RhdGVtZW50IHN0bW50LCBpbnQgaWR4LCBpbnQgY29sVHlw\nZSwKICAgICAgICBDb2x1bW4gY29sKQogICAgICAgIHRocm93cyBTUUxFeGNl\ncHRpb24gewogICAgICAgIHN0bW50LnNldE51bGwoaWR4LCBjb2xUeXBlKTsK\nICAgIH0KCiAgICAvKioKICAgICAqIFNldCB0aGUgZ2l2ZW4gdmFsdWUgYXMg\nYSBwYXJhbWV0ZXIgdG8gdGhlIHN0YXRlbWVudC4KICAgICAqLwogICAgcHVi\nbGljIHZvaWQgc2V0TnVtYmVyKFByZXBhcmVkU3RhdGVtZW50IHN0bW50LCBp\nbnQgaWR4LCBOdW1iZXIgbnVtLAogICAgICAgIENvbHVtbiBjb2wpCiAgICAg\nICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgLy8gY2hlY2sgZm9y\nIGtub3duIGZsb2F0aW5nIHBvaW50IHR5cGVzIHRvIGdpdmUgZHJpdmVyIGEg\nY2hhbmNlIHRvCiAgICAgICAgLy8gaGFuZGxlIHNwZWNpYWwgbnVtYmVycyBs\naWtlIE5hTiBhbmQgaW5maW5pdHk7IGJ1ZyAjMTA1MwogICAgICAgIGlmIChu\ndW0gaW5zdGFuY2VvZiBEb3VibGUpCiAgICAgICAgICAgIHNldERvdWJsZShz\ndG1udCwgaWR4LCAoKERvdWJsZSkgbnVtKS5kb3VibGVWYWx1ZSgpLCBjb2wp\nOwogICAgICAgIGVsc2UgaWYgKG51bSBpbnN0YW5jZW9mIEZsb2F0KQogICAg\nICAgICAgICBzZXRGbG9hdChzdG1udCwgaWR4LCAoKEZsb2F0KSBudW0pLmZs\nb2F0VmFsdWUoKSwgY29sKTsKICAgICAgICBlbHNlCiAgICAgICAgICAgIHNl\ndEJpZ0RlY2ltYWwoc3RtbnQsIGlkeCwgbmV3IEJpZ0RlY2ltYWwobnVtLnRv\nU3RyaW5nKCkpLCBjb2wpOwogICAgfQoKICAgIC8qKgogICAgICogU2V0IHRo\nZSBnaXZlbiB2YWx1ZSBhcyBhIHBhcmFtZXRlcnMgdG8gdGhlIHN0YXRlbWVu\ndC4gVGhlIGNvbHVtbgogICAgICogdHlwZSB3aWxsIGNvbWUgZnJvbSB7QGxp\nbmsgVHlwZXN9LgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRPYmplY3Qo\nUHJlcGFyZWRTdGF0ZW1lbnQgc3RtbnQsIGludCBpZHgsIE9iamVjdCB2YWws\nCiAgICAgICAgaW50IGNvbFR5cGUsIENvbHVtbiBjb2wpCiAgICAgICAgdGhy\nb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgaWYgKGNvbFR5cGUgPT0gLTEg\nfHwgY29sVHlwZSA9PSBUeXBlcy5PVEhFUikKICAgICAgICAgICAgc3RtbnQu\nc2V0T2JqZWN0KGlkeCwgdmFsKTsKICAgICAgICBlbHNlCiAgICAgICAgICAg\nIHN0bW50LnNldE9iamVjdChpZHgsIHZhbCwgY29sVHlwZSk7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBTZXQgdGhlIGdpdmVuIHZhbHVlIGFzIGEgcGFyYW1l\ndGVyIHRvIHRoZSBzdGF0ZW1lbnQuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lk\nIHNldFJlZihQcmVwYXJlZFN0YXRlbWVudCBzdG1udCwgaW50IGlkeCwgUmVm\nIHZhbCwgQ29sdW1uIGNvbCkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9u\nIHsKICAgICAgICBzdG1udC5zZXRSZWYoaWR4LCB2YWwpOwogICAgfQoKICAg\nIC8qKgogICAgICogU2V0IHRoZSBnaXZlbiB2YWx1ZSBhcyBhIHBhcmFtZXRl\nciB0byB0aGUgc3RhdGVtZW50LgogICAgICovCiAgICBwdWJsaWMgdm9pZCBz\nZXRTaG9ydChQcmVwYXJlZFN0YXRlbWVudCBzdG1udCwgaW50IGlkeCwgc2hv\ncnQgdmFsLAogICAgICAgIENvbHVtbiBjb2wpCiAgICAgICAgdGhyb3dzIFNR\nTEV4Y2VwdGlvbiB7CiAgICAgICAgc3RtbnQuc2V0U2hvcnQoaWR4LCB2YWwp\nOwogICAgfQoKICAgIC8qKgogICAgICogU2V0IHRoZSBnaXZlbiB2YWx1ZSBh\ncyBhIHBhcmFtZXRlciB0byB0aGUgc3RhdGVtZW50LgogICAgICovCiAgICBw\ndWJsaWMgdm9pZCBzZXRTdHJpbmcoUHJlcGFyZWRTdGF0ZW1lbnQgc3RtbnQs\nIGludCBpZHgsIFN0cmluZyB2YWwsCiAgICAgICAgQ29sdW1uIGNvbCkKICAg\nICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBzdG1udC5zZXRT\ndHJpbmcoaWR4LCB2YWwpOwogICAgfQoKICAgIC8qKgogICAgICogU2V0IHRo\nZSBnaXZlbiB2YWx1ZSBhcyBhIHBhcmFtZXRlciB0byB0aGUgc3RhdGVtZW50\nLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRUaW1lKFByZXBhcmVkU3Rh\ndGVtZW50IHN0bW50LCBpbnQgaWR4LCBUaW1lIHZhbCwKICAgICAgICBDYWxl\nbmRhciBjYWwsIENvbHVtbiBjb2wpCiAgICAgICAgdGhyb3dzIFNRTEV4Y2Vw\ndGlvbiB7CiAgICAgICAgaWYgKGNhbCA9PSBudWxsKQogICAgICAgICAgICBz\ndG1udC5zZXRUaW1lKGlkeCwgdmFsKTsKICAgICAgICBlbHNlCiAgICAgICAg\nICAgIHN0bW50LnNldFRpbWUoaWR4LCB2YWwsIGNhbCk7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBTZXQgdGhlIGdpdmVuIHZhbHVlIGFzIGEgcGFyYW1ldGVy\nIHRvIHRoZSBzdGF0ZW1lbnQuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNl\ndFRpbWVzdGFtcChQcmVwYXJlZFN0YXRlbWVudCBzdG1udCwgaW50IGlkeCwK\nICAgICAgICBUaW1lc3RhbXAgdmFsLCBDYWxlbmRhciBjYWwsIENvbHVtbiBj\nb2wpCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgLy8g\nZW5zdXJlIHRoYXQgd2UgZG8gbm90IGluc2VydCBkYXRlcyBhdCBhIGdyZWF0\nZXIgcHJlY2lzaW9uIHRoYW4KICAgICAgICAvLyB0aGF0IGF0IHdoaWNoIHRo\nZXkgd2lsbCBiZSByZXR1cm5lZCBieSBhIFNFTEVDVAogICAgICAgIGludCBy\nb3VuZGVkID0gKGludCkgTWF0aC5yb3VuZCh2YWwuZ2V0TmFub3MoKSAvCiAg\nICAgICAgICAgIChkb3VibGUpIGRhdGVQcmVjaXNpb24pOwogICAgICAgIGlu\ndCBuYW5vcyA9IHJvdW5kZWQgKiBkYXRlUHJlY2lzaW9uOwogICAgICAgIGlm\nIChuYW5vcyA+IDk5OTk5OTk5OSkgewogICAgICAgICAgICAvLyByb2xsb3Zl\nciB0byBuZXh0IHNlY29uZAogICAgICAgICAgICB2YWwuc2V0VGltZSh2YWwu\nZ2V0VGltZSgpICsgMTAwMCk7CiAgICAgICAgICAgIG5hbm9zID0gMDsKICAg\nICAgICB9CgogICAgICAgIGlmIChzdXBwb3J0c1RpbWVzdGFtcE5hbm9zKQog\nICAgICAgICAgICB2YWwuc2V0TmFub3MobmFub3MpOwogICAgICAgIGVsc2UK\nICAgICAgICAgICAgdmFsLnNldE5hbm9zKDApOwoKICAgICAgICBpZiAoY2Fs\nID09IG51bGwpCiAgICAgICAgICAgIHN0bW50LnNldFRpbWVzdGFtcChpZHgs\nIHZhbCk7CiAgICAgICAgZWxzZQogICAgICAgICAgICBzdG1udC5zZXRUaW1l\nc3RhbXAoaWR4LCB2YWwsIGNhbCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBT\nZXQgYSBjb2x1bW4gdmFsdWUgaW50byBhIHByZXBhcmVkIHN0YXRlbWVudC4K\nICAgICAqCiAgICAgKiBAcGFyYW0gc3RtbnQgdGhlIHByZXBhcmVkIHN0YXRl\nbWVudCB0byBwYXJhbWV0ZXJpemUKICAgICAqIEBwYXJhbSBpZHggdGhlIGlu\nZGV4IG9mIHRoZSBwYXJhbWV0ZXIgaW4gdGhlIHByZXBhcmVkIHN0YXRlbWVu\ndAogICAgICogQHBhcmFtIHZhbCB0aGUgdmFsdWUgb2YgdGhlIGNvbHVtbgog\nICAgICogQHBhcmFtIGNvbCB0aGUgY29sdW1uIGJlaW5nIHNldAogICAgICog\nQHBhcmFtIHR5cGUgdGhlIGZpZWxkIG1hcHBpbmcgdHlwZSBjb2RlIGZvciB0\naGUgdmFsdWUKICAgICAqIEBwYXJhbSBzdG9yZSB0aGUgc3RvcmUgbWFuYWdl\nciBmb3IgdGhlIGN1cnJlbnQgY29udGV4dAogICAgICovCiAgICBwdWJsaWMg\ndm9pZCBzZXRUeXBlZChQcmVwYXJlZFN0YXRlbWVudCBzdG1udCwgaW50IGlk\neCwgT2JqZWN0IHZhbCwKICAgICAgICBDb2x1bW4gY29sLCBpbnQgdHlwZSwg\nSkRCQ1N0b3JlIHN0b3JlKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24g\newogICAgICAgIGlmICh2YWwgPT0gbnVsbCkgewogICAgICAgICAgICBzZXRO\ndWxsKHN0bW50LCBpZHgsIChjb2wgPT0gbnVsbCkgPyBUeXBlcy5PVEhFUiA6\nIGNvbC5nZXRUeXBlKCksCiAgICAgICAgICAgICAgICBjb2wpOwogICAgICAg\nICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBTaXplZCBzOwogICAg\nICAgIENhbGVuZGFyZCBjOwogICAgICAgIHN3aXRjaCAodHlwZSkgewogICAg\nICAgICAgICBjYXNlIEphdmFUeXBlcy5CT09MRUFOOgogICAgICAgICAgICBj\nYXNlIEphdmFUeXBlcy5CT09MRUFOX09CSjoKICAgICAgICAgICAgICAgIHNl\ndEJvb2xlYW4oc3RtbnQsIGlkeCwgKChCb29sZWFuKSB2YWwpLmJvb2xlYW5W\nYWx1ZSgpLCBjb2wpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAg\nICAgIGNhc2UgSmF2YVR5cGVzLkJZVEU6CiAgICAgICAgICAgIGNhc2UgSmF2\nYVR5cGVzLkJZVEVfT0JKOgogICAgICAgICAgICAgICAgc2V0Qnl0ZShzdG1u\ndCwgaWR4LCAoKE51bWJlcikgdmFsKS5ieXRlVmFsdWUoKSwgY29sKTsKICAg\nICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIEphdmFUeXBl\ncy5DSEFSOgogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5DSEFSX09CSjoK\nICAgICAgICAgICAgICAgIHNldENoYXIoc3RtbnQsIGlkeCwgKChDaGFyYWN0\nZXIpIHZhbCkuY2hhclZhbHVlKCksIGNvbCk7CiAgICAgICAgICAgICAgICBi\ncmVhazsKICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuRE9VQkxFOgogICAg\nICAgICAgICBjYXNlIEphdmFUeXBlcy5ET1VCTEVfT0JKOgogICAgICAgICAg\nICAgICAgc2V0RG91YmxlKHN0bW50LCBpZHgsICgoTnVtYmVyKSB2YWwpLmRv\ndWJsZVZhbHVlKCksIGNvbCk7CiAgICAgICAgICAgICAgICBicmVhazsKICAg\nICAgICAgICAgY2FzZSBKYXZhVHlwZXMuRkxPQVQ6CiAgICAgICAgICAgIGNh\nc2UgSmF2YVR5cGVzLkZMT0FUX09CSjoKICAgICAgICAgICAgICAgIHNldEZs\nb2F0KHN0bW50LCBpZHgsICgoTnVtYmVyKSB2YWwpLmZsb2F0VmFsdWUoKSwg\nY29sKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNl\nIEphdmFUeXBlcy5JTlQ6CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLklO\nVF9PQko6CiAgICAgICAgICAgICAgICBzZXRJbnQoc3RtbnQsIGlkeCwgKChO\ndW1iZXIpIHZhbCkuaW50VmFsdWUoKSwgY29sKTsKICAgICAgICAgICAgICAg\nIGJyZWFrOwogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5MT05HOgogICAg\nICAgICAgICBjYXNlIEphdmFUeXBlcy5MT05HX09CSjoKICAgICAgICAgICAg\nICAgIHNldExvbmcoc3RtbnQsIGlkeCwgKChOdW1iZXIpIHZhbCkubG9uZ1Zh\nbHVlKCksIGNvbCk7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAg\nICAgY2FzZSBKYXZhVHlwZXMuU0hPUlQ6CiAgICAgICAgICAgIGNhc2UgSmF2\nYVR5cGVzLlNIT1JUX09CSjoKICAgICAgICAgICAgICAgIHNldFNob3J0KHN0\nbW50LCBpZHgsICgoTnVtYmVyKSB2YWwpLnNob3J0VmFsdWUoKSwgY29sKTsK\nICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIEphdmFU\neXBlcy5TVFJJTkc6CiAgICAgICAgICAgICAgICBpZiAoY29sICE9IG51bGwg\nJiYgKGNvbC5nZXRUeXBlKCkgPT0gVHlwZXMuQ0xPQgogICAgICAgICAgICAg\nICAgICAgIHx8IGNvbC5nZXRUeXBlKCkgPT0gVHlwZXMuTE9OR1ZBUkNIQVIp\nKQogICAgICAgICAgICAgICAgICAgIHNldENsb2JTdHJpbmcoc3RtbnQsIGlk\neCwgKFN0cmluZykgdmFsLCBjb2wpOwogICAgICAgICAgICAgICAgZWxzZQog\nICAgICAgICAgICAgICAgICAgIHNldFN0cmluZyhzdG1udCwgaWR4LCAoU3Ry\naW5nKSB2YWwsIGNvbCk7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAg\nICAgICAgY2FzZSBKYXZhVHlwZXMuT0JKRUNUOgogICAgICAgICAgICAgICAg\nc2V0QmxvYk9iamVjdChzdG1udCwgaWR4LCB2YWwsIGNvbCwgc3RvcmUpOwog\nICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgSmF2YVR5\ncGVzLkRBVEU6CiAgICAgICAgICAgICAgICBzZXREYXRlKHN0bW50LCBpZHgs\nIChEYXRlKSB2YWwsIGNvbCk7CiAgICAgICAgICAgICAgICBicmVhazsKICAg\nICAgICAgICAgY2FzZSBKYXZhVHlwZXMuQ0FMRU5EQVI6CiAgICAgICAgICAg\nICAgICBzZXRDYWxlbmRhcihzdG1udCwgaWR4LCAoQ2FsZW5kYXIpIHZhbCwg\nY29sKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNl\nIEphdmFUeXBlcy5CSUdERUNJTUFMOgogICAgICAgICAgICAgICAgc2V0Qmln\nRGVjaW1hbChzdG1udCwgaWR4LCAoQmlnRGVjaW1hbCkgdmFsLCBjb2wpOwog\nICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgSmF2YVR5\ncGVzLkJJR0lOVEVHRVI6CiAgICAgICAgICAgICAgICBzZXRCaWdJbnRlZ2Vy\nKHN0bW50LCBpZHgsIChCaWdJbnRlZ2VyKSB2YWwsIGNvbCk7CiAgICAgICAg\nICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuTlVN\nQkVSOgogICAgICAgICAgICAgICAgc2V0TnVtYmVyKHN0bW50LCBpZHgsIChO\ndW1iZXIpIHZhbCwgY29sKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAg\nICAgICAgICBjYXNlIEphdmFUeXBlcy5MT0NBTEU6CiAgICAgICAgICAgICAg\nICBzZXRMb2NhbGUoc3RtbnQsIGlkeCwgKExvY2FsZSkgdmFsLCBjb2wpOwog\nICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgSmF2YVNR\nTFR5cGVzLlNRTF9BUlJBWToKICAgICAgICAgICAgICAgIHNldEFycmF5KHN0\nbW50LCBpZHgsIChBcnJheSkgdmFsLCBjb2wpOwogICAgICAgICAgICAgICAg\nYnJlYWs7CiAgICAgICAgICAgIGNhc2UgSmF2YVNRTFR5cGVzLkFTQ0lJX1NU\nUkVBTToKICAgICAgICAgICAgICAgIHMgPSAoU2l6ZWQpIHZhbDsKICAgICAg\nICAgICAgICAgIHNldEFzY2lpU3RyZWFtKHN0bW50LCBpZHgsIChJbnB1dFN0\ncmVhbSkgcy52YWx1ZSwgcy5zaXplLCBjb2wpOwogICAgICAgICAgICAgICAg\nYnJlYWs7CiAgICAgICAgICAgIGNhc2UgSmF2YVNRTFR5cGVzLkJJTkFSWV9T\nVFJFQU06CiAgICAgICAgICAgICAgICBzID0gKFNpemVkKSB2YWw7CiAgICAg\nICAgICAgICAgICBzZXRCaW5hcnlTdHJlYW0oc3RtbnQsIGlkeCwgKElucHV0\nU3RyZWFtKSBzLnZhbHVlLCBzLnNpemUsIGNvbCk7CiAgICAgICAgICAgICAg\nICBicmVhazsKICAgICAgICAgICAgY2FzZSBKYXZhU1FMVHlwZXMuQkxPQjoK\nICAgICAgICAgICAgICAgIHNldEJsb2Ioc3RtbnQsIGlkeCwgKEJsb2IpIHZh\nbCwgY29sKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBj\nYXNlIEphdmFTUUxUeXBlcy5CWVRFUzoKICAgICAgICAgICAgICAgIHNldEJ5\ndGVzKHN0bW50LCBpZHgsIChieXRlW10pIHZhbCwgY29sKTsKICAgICAgICAg\nICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIEphdmFTUUxUeXBlcy5D\nSEFSX1NUUkVBTToKICAgICAgICAgICAgICAgIHMgPSAoU2l6ZWQpIHZhbDsK\nICAgICAgICAgICAgICAgIHNldENoYXJhY3RlclN0cmVhbShzdG1udCwgaWR4\nLCAoUmVhZGVyKSBzLnZhbHVlLCBzLnNpemUsIGNvbCk7CiAgICAgICAgICAg\nICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSBKYXZhU1FMVHlwZXMuQ0xP\nQjoKICAgICAgICAgICAgICAgIHNldENsb2Ioc3RtbnQsIGlkeCwgKENsb2Ip\nIHZhbCwgY29sKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAg\nICBjYXNlIEphdmFTUUxUeXBlcy5TUUxfREFURToKICAgICAgICAgICAgICAg\nIGlmICh2YWwgaW5zdGFuY2VvZiBDYWxlbmRhcmQpIHsKICAgICAgICAgICAg\nICAgICAgICBjID0gKENhbGVuZGFyZCkgdmFsOwogICAgICAgICAgICAgICAg\nICAgIHNldERhdGUoc3RtbnQsIGlkeCwgKGphdmEuc3FsLkRhdGUpIGMudmFs\ndWUsIGMuY2FsZW5kYXIsCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbCk7\nCiAgICAgICAgICAgICAgICB9IGVsc2UKICAgICAgICAgICAgICAgICAgICBz\nZXREYXRlKHN0bW50LCBpZHgsIChqYXZhLnNxbC5EYXRlKSB2YWwsIG51bGws\nIGNvbCk7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2Fz\nZSBKYXZhU1FMVHlwZXMuUkVGOgogICAgICAgICAgICAgICAgc2V0UmVmKHN0\nbW50LCBpZHgsIChSZWYpIHZhbCwgY29sKTsKICAgICAgICAgICAgICAgIGJy\nZWFrOwogICAgICAgICAgICBjYXNlIEphdmFTUUxUeXBlcy5USU1FOgogICAg\nICAgICAgICAgICAgaWYgKHZhbCBpbnN0YW5jZW9mIENhbGVuZGFyZCkgewog\nICAgICAgICAgICAgICAgICAgIGMgPSAoQ2FsZW5kYXJkKSB2YWw7CiAgICAg\nICAgICAgICAgICAgICAgc2V0VGltZShzdG1udCwgaWR4LCAoVGltZSkgYy52\nYWx1ZSwgYy5jYWxlbmRhciwgY29sKTsKICAgICAgICAgICAgICAgIH0gZWxz\nZQogICAgICAgICAgICAgICAgICAgIHNldFRpbWUoc3RtbnQsIGlkeCwgKFRp\nbWUpIHZhbCwgbnVsbCwgY29sKTsKICAgICAgICAgICAgICAgIGJyZWFrOwog\nICAgICAgICAgICBjYXNlIEphdmFTUUxUeXBlcy5USU1FU1RBTVA6CiAgICAg\nICAgICAgICAgICBpZiAodmFsIGluc3RhbmNlb2YgQ2FsZW5kYXJkKSB7CiAg\nICAgICAgICAgICAgICAgICAgYyA9IChDYWxlbmRhcmQpIHZhbDsKICAgICAg\nICAgICAgICAgICAgICBzZXRUaW1lc3RhbXAoc3RtbnQsIGlkeCwgKFRpbWVz\ndGFtcCkgYy52YWx1ZSwgYy5jYWxlbmRhciwKICAgICAgICAgICAgICAgICAg\nICAgICAgY29sKTsKICAgICAgICAgICAgICAgIH0gZWxzZQogICAgICAgICAg\nICAgICAgICAgIHNldFRpbWVzdGFtcChzdG1udCwgaWR4LCAoVGltZXN0YW1w\nKSB2YWwsIG51bGwsIGNvbCk7CiAgICAgICAgICAgICAgICBicmVhazsKICAg\nICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAgIGlmIChjb2wgIT0g\nbnVsbCAmJiAoY29sLmdldFR5cGUoKSA9PSBUeXBlcy5CTE9CCiAgICAgICAg\nICAgICAgICAgICAgfHwgY29sLmdldFR5cGUoKSA9PSBUeXBlcy5WQVJCSU5B\nUlkpKQogICAgICAgICAgICAgICAgICAgIHNldEJsb2JPYmplY3Qoc3RtbnQs\nIGlkeCwgdmFsLCBjb2wsIHN0b3JlKTsKICAgICAgICAgICAgICAgIGVsc2UK\nICAgICAgICAgICAgICAgICAgICBzZXRPYmplY3Qoc3RtbnQsIGlkeCwgdmFs\nLCBjb2wuZ2V0VHlwZSgpLCBjb2wpOwogICAgICAgIH0KICAgIH0KCiAgICAv\nKioKICAgICAqIFNldCBhIGNvbXBsZXRlbHkgdW5rbm93biBwYXJhbWV0ZXIg\naW50byBhIHByZXBhcmVkIHN0YXRlbWVudC4KICAgICAqLwogICAgcHVibGlj\nIHZvaWQgc2V0VW5rbm93bihQcmVwYXJlZFN0YXRlbWVudCBzdG1udCwgaW50\nIGlkeCwgT2JqZWN0IHZhbCwKICAgICAgICBDb2x1bW4gY29sKQogICAgICAg\nIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIFNpemVkIHNpemVkID0g\nbnVsbDsKICAgICAgICBDYWxlbmRhcmQgY2FsZCA9IG51bGw7CiAgICAgICAg\naWYgKHZhbCBpbnN0YW5jZW9mIFNpemVkKSB7CiAgICAgICAgICAgIHNpemVk\nID0gKFNpemVkKSB2YWw7CiAgICAgICAgICAgIHZhbCA9IHNpemVkLnZhbHVl\nOwogICAgICAgIH0gZWxzZSBpZiAodmFsIGluc3RhbmNlb2YgQ2FsZW5kYXJk\nKSB7CiAgICAgICAgICAgIGNhbGQgPSAoQ2FsZW5kYXJkKSB2YWw7CiAgICAg\nICAgICAgIHZhbCA9IGNhbGQudmFsdWU7CiAgICAgICAgfQoKICAgICAgICBp\nZiAodmFsID09IG51bGwpCiAgICAgICAgICAgIHNldE51bGwoc3RtbnQsIGlk\neCwgKGNvbCA9PSBudWxsKSA/IFR5cGVzLk9USEVSIDogY29sLmdldFR5cGUo\nKSwKICAgICAgICAgICAgICAgIGNvbCk7CiAgICAgICAgZWxzZSBpZiAodmFs\nIGluc3RhbmNlb2YgU3RyaW5nKQogICAgICAgICAgICBzZXRTdHJpbmcoc3Rt\nbnQsIGlkeCwgdmFsLnRvU3RyaW5nKCksIGNvbCk7CiAgICAgICAgZWxzZSBp\nZiAodmFsIGluc3RhbmNlb2YgSW50ZWdlcikKICAgICAgICAgICAgc2V0SW50\nKHN0bW50LCBpZHgsICgoSW50ZWdlcikgdmFsKS5pbnRWYWx1ZSgpLCBjb2wp\nOwogICAgICAgIGVsc2UgaWYgKHZhbCBpbnN0YW5jZW9mIEJvb2xlYW4pCiAg\nICAgICAgICAgIHNldEJvb2xlYW4oc3RtbnQsIGlkeCwgKChCb29sZWFuKSB2\nYWwpLmJvb2xlYW5WYWx1ZSgpLCBjb2wpOwogICAgICAgIGVsc2UgaWYgKHZh\nbCBpbnN0YW5jZW9mIExvbmcpCiAgICAgICAgICAgIHNldExvbmcoc3RtbnQs\nIGlkeCwgKChMb25nKSB2YWwpLmxvbmdWYWx1ZSgpLCBjb2wpOwogICAgICAg\nIGVsc2UgaWYgKHZhbCBpbnN0YW5jZW9mIEZsb2F0KQogICAgICAgICAgICBz\nZXRGbG9hdChzdG1udCwgaWR4LCAoKEZsb2F0KSB2YWwpLmZsb2F0VmFsdWUo\nKSwgY29sKTsKICAgICAgICBlbHNlIGlmICh2YWwgaW5zdGFuY2VvZiBEb3Vi\nbGUpCiAgICAgICAgICAgIHNldERvdWJsZShzdG1udCwgaWR4LCAoKERvdWJs\nZSkgdmFsKS5kb3VibGVWYWx1ZSgpLCBjb2wpOwogICAgICAgIGVsc2UgaWYg\nKHZhbCBpbnN0YW5jZW9mIEJ5dGUpCiAgICAgICAgICAgIHNldEJ5dGUoc3Rt\nbnQsIGlkeCwgKChCeXRlKSB2YWwpLmJ5dGVWYWx1ZSgpLCBjb2wpOwogICAg\nICAgIGVsc2UgaWYgKHZhbCBpbnN0YW5jZW9mIENoYXJhY3RlcikKICAgICAg\nICAgICAgc2V0Q2hhcihzdG1udCwgaWR4LCAoKENoYXJhY3RlcikgdmFsKS5j\naGFyVmFsdWUoKSwgY29sKTsKICAgICAgICBlbHNlIGlmICh2YWwgaW5zdGFu\nY2VvZiBTaG9ydCkKICAgICAgICAgICAgc2V0U2hvcnQoc3RtbnQsIGlkeCwg\nKChTaG9ydCkgdmFsKS5zaG9ydFZhbHVlKCksIGNvbCk7CiAgICAgICAgZWxz\nZSBpZiAodmFsIGluc3RhbmNlb2YgTG9jYWxlKQogICAgICAgICAgICBzZXRM\nb2NhbGUoc3RtbnQsIGlkeCwgKExvY2FsZSkgdmFsLCBjb2wpOwogICAgICAg\nIGVsc2UgaWYgKHZhbCBpbnN0YW5jZW9mIEJpZ0RlY2ltYWwpCiAgICAgICAg\nICAgIHNldEJpZ0RlY2ltYWwoc3RtbnQsIGlkeCwgKEJpZ0RlY2ltYWwpIHZh\nbCwgY29sKTsKICAgICAgICBlbHNlIGlmICh2YWwgaW5zdGFuY2VvZiBCaWdJ\nbnRlZ2VyKQogICAgICAgICAgICBzZXRCaWdJbnRlZ2VyKHN0bW50LCBpZHgs\nIChCaWdJbnRlZ2VyKSB2YWwsIGNvbCk7CiAgICAgICAgZWxzZSBpZiAodmFs\nIGluc3RhbmNlb2YgQXJyYXkpCiAgICAgICAgICAgIHNldEFycmF5KHN0bW50\nLCBpZHgsIChBcnJheSkgdmFsLCBjb2wpOwogICAgICAgIGVsc2UgaWYgKHZh\nbCBpbnN0YW5jZW9mIEJsb2IpCiAgICAgICAgICAgIHNldEJsb2Ioc3RtbnQs\nIGlkeCwgKEJsb2IpIHZhbCwgY29sKTsKICAgICAgICBlbHNlIGlmICh2YWwg\naW5zdGFuY2VvZiBieXRlW10pCiAgICAgICAgICAgIHNldEJ5dGVzKHN0bW50\nLCBpZHgsIChieXRlW10pIHZhbCwgY29sKTsKICAgICAgICBlbHNlIGlmICh2\nYWwgaW5zdGFuY2VvZiBDbG9iKQogICAgICAgICAgICBzZXRDbG9iKHN0bW50\nLCBpZHgsIChDbG9iKSB2YWwsIGNvbCk7CiAgICAgICAgZWxzZSBpZiAodmFs\nIGluc3RhbmNlb2YgUmVmKQogICAgICAgICAgICBzZXRSZWYoc3RtbnQsIGlk\neCwgKFJlZikgdmFsLCBjb2wpOwogICAgICAgIGVsc2UgaWYgKHZhbCBpbnN0\nYW5jZW9mIGphdmEuc3FsLkRhdGUpCiAgICAgICAgICAgIHNldERhdGUoc3Rt\nbnQsIGlkeCwgKGphdmEuc3FsLkRhdGUpIHZhbCwKICAgICAgICAgICAgICAg\nIChjYWxkID09IG51bGwpID8gbnVsbCA6IGNhbGQuY2FsZW5kYXIsIGNvbCk7\nCiAgICAgICAgZWxzZSBpZiAodmFsIGluc3RhbmNlb2YgVGltZXN0YW1wKQog\nICAgICAgICAgICBzZXRUaW1lc3RhbXAoc3RtbnQsIGlkeCwgKFRpbWVzdGFt\ncCkgdmFsLAogICAgICAgICAgICAgICAgKGNhbGQgPT0gbnVsbCkgPyBudWxs\nIDogY2FsZC5jYWxlbmRhciwgY29sKTsKICAgICAgICBlbHNlIGlmICh2YWwg\naW5zdGFuY2VvZiBUaW1lKQogICAgICAgICAgICBzZXRUaW1lKHN0bW50LCBp\nZHgsIChUaW1lKSB2YWwsCiAgICAgICAgICAgICAgICAoY2FsZCA9PSBudWxs\nKSA/IG51bGwgOiBjYWxkLmNhbGVuZGFyLCBjb2wpOwogICAgICAgIGVsc2Ug\naWYgKHZhbCBpbnN0YW5jZW9mIERhdGUpCiAgICAgICAgICAgIHNldERhdGUo\nc3RtbnQsIGlkeCwgKERhdGUpIHZhbCwgY29sKTsKICAgICAgICBlbHNlIGlm\nICh2YWwgaW5zdGFuY2VvZiBDYWxlbmRhcikKICAgICAgICAgICAgc2V0RGF0\nZShzdG1udCwgaWR4LCAoKENhbGVuZGFyKSB2YWwpLmdldFRpbWUoKSwgY29s\nKTsKICAgICAgICBlbHNlIGlmICh2YWwgaW5zdGFuY2VvZiBSZWFkZXIpCiAg\nICAgICAgICAgIHNldENoYXJhY3RlclN0cmVhbShzdG1udCwgaWR4LCAoUmVh\nZGVyKSB2YWwsCiAgICAgICAgICAgICAgICAoc2l6ZWQgPT0gbnVsbCkgPyAw\nIDogc2l6ZWQuc2l6ZSwgY29sKTsKICAgICAgICBlbHNlCiAgICAgICAgICAg\nIHRocm93IG5ldyBVc2VyRXhjZXB0aW9uKF9sb2MuZ2V0KCJiYWQtcGFyYW0i\nLCB2YWwuZ2V0Q2xhc3MoKSkpOwogICAgfQoKICAgIC8qKgogICAgICogUmV0\ndXJuIHRoZSBzZXJpYWxpemVkIGJ5dGVzIGZvciB0aGUgZ2l2ZW4gb2JqZWN0\nLgogICAgICovCiAgICBwdWJsaWMgYnl0ZVtdIHNlcmlhbGl6ZShPYmplY3Qg\ndmFsLCBKREJDU3RvcmUgc3RvcmUpCiAgICAgICAgdGhyb3dzIFNRTEV4Y2Vw\ndGlvbiB7CiAgICAgICAgaWYgKHZhbCA9PSBudWxsKQogICAgICAgICAgICBy\nZXR1cm4gbnVsbDsKICAgICAgICBpZiAodmFsIGluc3RhbmNlb2YgU2VyaWFs\naXplZERhdGEpCiAgICAgICAgICAgIHJldHVybiAoKFNlcmlhbGl6ZWREYXRh\nKSB2YWwpLmJ5dGVzOwogICAgICAgIHJldHVybiBTZXJpYWxpemF0aW9uLnNl\ncmlhbGl6ZSh2YWwsIHN0b3JlLmdldENvbnRleHQoKSk7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBJbnZva2UgdGhlIEpESyAxLjQgPGNvZGU+c2V0Qnl0ZXM8\nL2NvZGU+IG1ldGhvZCBvbiB0aGUgZ2l2ZW4gQkxPQiBvYmplY3QuCiAgICAg\nKi8KICAgIHB1YmxpYyB2b2lkIHB1dEJ5dGVzKE9iamVjdCBibG9iLCBieXRl\nW10gZGF0YSkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAg\nICBpZiAoX3NldEJ5dGVzID09IG51bGwpIHsKICAgICAgICAgICAgdHJ5IHsK\nICAgICAgICAgICAgICAgIF9zZXRCeXRlcyA9IGJsb2IuZ2V0Q2xhc3MoKS5n\nZXRNZXRob2QoInNldEJ5dGVzIiwKICAgICAgICAgICAgICAgICAgICBuZXcg\nQ2xhc3NbXXsgbG9uZy5jbGFzcywgYnl0ZVtdLmNsYXNzIH0pOwogICAgICAg\nICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkgewogICAgICAgICAgICAgICAg\ndGhyb3cgbmV3IFN0b3JlRXhjZXB0aW9uKGUpOwogICAgICAgICAgICB9CiAg\nICAgICAgfQogICAgICAgIGludm9rZVB1dExvYk1ldGhvZChfc2V0Qnl0ZXMs\nIGJsb2IsCiAgICAgICAgICAgIG5ldyBPYmplY3RbXXsgTnVtYmVycy52YWx1\nZU9mKDFMKSwgZGF0YSB9KTsKICAgIH0KCiAgICAvKioKICAgICAqIEludm9r\nZSB0aGUgSkRLIDEuNCA8Y29kZT5zZXRTdHJpbmc8L2NvZGU+IG1ldGhvZCBv\nbiB0aGUgZ2l2ZW4gQ0xPQgogICAgICogb2JqZWN0LgogICAgICovCiAgICBw\ndWJsaWMgdm9pZCBwdXRTdHJpbmcoT2JqZWN0IGNsb2IsIFN0cmluZyBkYXRh\nKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIGlmIChf\nc2V0U3RyaW5nID09IG51bGwpIHsKICAgICAgICAgICAgdHJ5IHsKICAgICAg\nICAgICAgICAgIF9zZXRTdHJpbmcgPSBjbG9iLmdldENsYXNzKCkuZ2V0TWV0\naG9kKCJzZXRTdHJpbmciLAogICAgICAgICAgICAgICAgICAgIG5ldyBDbGFz\nc1tdeyBsb25nLmNsYXNzLCBTdHJpbmcuY2xhc3MgfSk7CiAgICAgICAgICAg\nIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgICAgICB0aHJv\ndyBuZXcgU3RvcmVFeGNlcHRpb24oZSk7CiAgICAgICAgICAgIH0KICAgICAg\nICB9CiAgICAgICAgaW52b2tlUHV0TG9iTWV0aG9kKF9zZXRTdHJpbmcsIGNs\nb2IsCiAgICAgICAgICAgIG5ldyBPYmplY3RbXXsgTnVtYmVycy52YWx1ZU9m\nKDFMKSwgZGF0YSB9KTsKICAgIH0KCiAgICAvKioKICAgICAqIEludm9rZSB0\naGUgSkRLIDEuNCA8Y29kZT5zZXRDaGFyYWN0ZXJTdHJlYW08L2NvZGU+IG1l\ndGhvZCBvbiB0aGUgZ2l2ZW4KICAgICAqIENMT0Igb2JqZWN0LgogICAgICov\nCiAgICBwdWJsaWMgdm9pZCBwdXRDaGFycyhPYmplY3QgY2xvYiwgY2hhcltd\nIGRhdGEpCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAg\naWYgKF9zZXRDaGFyU3RyZWFtID09IG51bGwpIHsKICAgICAgICAgICAgdHJ5\nIHsKICAgICAgICAgICAgICAgIF9zZXRDaGFyU3RyZWFtID0gY2xvYi5nZXRD\nbGFzcygpLmdldE1ldGhvZAogICAgICAgICAgICAgICAgICAgICgic2V0Q2hh\ncmFjdGVyU3RyZWFtIiwgbmV3IENsYXNzW117IGxvbmcuY2xhc3MgfSk7CiAg\nICAgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAg\nICAgICB0aHJvdyBuZXcgU3RvcmVFeGNlcHRpb24oZSk7CiAgICAgICAgICAg\nIH0KICAgICAgICB9CgogICAgICAgIFdyaXRlciB3cml0ZXIgPSAoV3JpdGVy\nKSBpbnZva2VQdXRMb2JNZXRob2QoX3NldENoYXJTdHJlYW0sIGNsb2IsCiAg\nICAgICAgICAgIG5ldyBPYmplY3RbXXsgTnVtYmVycy52YWx1ZU9mKDFMKSB9\nKTsKICAgICAgICB0cnkgewogICAgICAgICAgICB3cml0ZXIud3JpdGUoZGF0\nYSk7CiAgICAgICAgICAgIHdyaXRlci5mbHVzaCgpOwogICAgICAgIH0gY2F0\nY2ggKElPRXhjZXB0aW9uIGlvZSkgewogICAgICAgICAgICB0aHJvdyBuZXcg\nU1FMRXhjZXB0aW9uKGlvZS50b1N0cmluZygpKTsKICAgICAgICB9CiAgICB9\nCgogICAgLyoqCiAgICAgKiBJbnZva2UgdGhlIGdpdmVuIExPQiBtZXRob2Qg\nb24gdGhlIGdpdmVuIHRhcmdldCB3aXRoIHRoZSBnaXZlbiBkYXRhLgogICAg\nICovCiAgICBwcml2YXRlIHN0YXRpYyBPYmplY3QgaW52b2tlUHV0TG9iTWV0\naG9kKE1ldGhvZCBtZXRob2QsIE9iamVjdCB0YXJnZXQsCiAgICAgICAgT2Jq\nZWN0W10gYXJncykKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAg\nICAgICB0cnkgewogICAgICAgICAgICByZXR1cm4gbWV0aG9kLmludm9rZSh0\nYXJnZXQsIGFyZ3MpOwogICAgICAgIH0gY2F0Y2ggKEludm9jYXRpb25UYXJn\nZXRFeGNlcHRpb24gaXRlKSB7CiAgICAgICAgICAgIFRocm93YWJsZSB0ID0g\naXRlLmdldFRhcmdldEV4Y2VwdGlvbigpOwogICAgICAgICAgICBpZiAodCBp\nbnN0YW5jZW9mIFNRTEV4Y2VwdGlvbikKICAgICAgICAgICAgICAgIHRocm93\nKFNRTEV4Y2VwdGlvbikgdDsKICAgICAgICAgICAgdGhyb3cgbmV3IFN0b3Jl\nRXhjZXB0aW9uKHQpOwogICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7\nCiAgICAgICAgICAgIHRocm93IG5ldyBTdG9yZUV4Y2VwdGlvbihlKTsKICAg\nICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBXYXJuIHRoYXQgYSBwYXJ0\naWN1bGFyIHZhbHVlIGNvdWxkIG5vdCBiZSBzdG9yZWQgcHJlY2lzZWx5Lgog\nICAgICogQWZ0ZXIgdGhlIGZpcnN0IHdhcm5pbmcgZm9yIGEgcGFydGljdWxh\nciB0eXBlLCBtZXNzYWdlcwogICAgICogd2lsbCBiZSB0dXJuZWQgaW50byB0\ncmFjZSBtZXNzYWdlcy4KICAgICAqLwogICAgcHJvdGVjdGVkIHZvaWQgc3Rv\ncmFnZVdhcm5pbmcoT2JqZWN0IG9yaWcsIE9iamVjdCBjb252ZXJ0ZWQpIHsK\nICAgICAgICBib29sZWFuIHdhcm47CiAgICAgICAgc3luY2hyb25pemVkICh0\naGlzKSB7CiAgICAgICAgICAgIGlmIChfcHJlY2lzaW9uV2FybmVkVHlwZXMg\nPT0gbnVsbCkKICAgICAgICAgICAgICAgIF9wcmVjaXNpb25XYXJuZWRUeXBl\ncyA9IG5ldyBIYXNoU2V0KCk7CiAgICAgICAgICAgIHdhcm4gPSBfcHJlY2lz\naW9uV2FybmVkVHlwZXMuYWRkKG9yaWcuZ2V0Q2xhc3MoKSk7CiAgICAgICAg\nfQoKICAgICAgICBpZiAoc3RvcmFnZUxpbWl0YXRpb25zRmF0YWwgfHwgKHdh\ncm4gJiYgbG9nLmlzV2FybkVuYWJsZWQoKSkKICAgICAgICAgICAgfHwgKCF3\nYXJuICYmIGxvZy5pc1RyYWNlRW5hYmxlZCgpKSkgewogICAgICAgICAgICBN\nZXNzYWdlIG1zZyA9IF9sb2MuZ2V0KCJzdG9yYWdlLXJlc3RyaWN0aW9uIiwg\nbmV3IE9iamVjdFtdewogICAgICAgICAgICAgICAgcGxhdGZvcm0sCiAgICAg\nICAgICAgICAgICBvcmlnLAogICAgICAgICAgICAgICAgb3JpZy5nZXRDbGFz\ncygpLmdldE5hbWUoKSwKICAgICAgICAgICAgICAgIGNvbnZlcnRlZCwKICAg\nICAgICAgICAgfSk7CgogICAgICAgICAgICBpZiAoc3RvcmFnZUxpbWl0YXRp\nb25zRmF0YWwpCiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgU3RvcmVFeGNl\ncHRpb24obXNnKTsKCiAgICAgICAgICAgIGlmICh3YXJuKQogICAgICAgICAg\nICAgICAgbG9nLndhcm4obXNnKTsKICAgICAgICAgICAgZWxzZQogICAgICAg\nICAgICAgICAgbG9nLnRyYWNlKG1zZyk7CiAgICAgICAgfQogICAgfQoKICAg\nIC8vLy8vLy8vLwogICAgLy8gVHlwZXMKICAgIC8vLy8vLy8vLwoKICAgIC8q\nKgogICAgICogUmV0dXJuIHRoZSBwcmVmZXJyZWQge0BsaW5rIFR5cGVzfSBj\nb25zdGFudCBmb3IgdGhlIGdpdmVuCiAgICAgKiB7QGxpbmsgSmF2YVR5cGVz\nfSBvciB7QGxpbmsgSmF2YVNRTFR5cGVzfSBjb25zdGFudC4KICAgICAqLwog\nICAgcHVibGljIGludCBnZXRKREJDVHlwZShpbnQgbWV0YVR5cGVDb2RlLCBi\nb29sZWFuIGxvYikgewogICAgICAgIGlmIChsb2IpIHsKICAgICAgICAgICAg\nc3dpdGNoIChtZXRhVHlwZUNvZGUpIHsKICAgICAgICAgICAgICAgIGNhc2Ug\nSmF2YVR5cGVzLlNUUklORzoKICAgICAgICAgICAgICAgIGNhc2UgSmF2YVNR\nTFR5cGVzLkFTQ0lJX1NUUkVBTToKICAgICAgICAgICAgICAgIGNhc2UgSmF2\nYVNRTFR5cGVzLkNIQVJfU1RSRUFNOgogICAgICAgICAgICAgICAgICAgIHJl\ndHVybiBnZXRQcmVmZXJyZWRUeXBlKFR5cGVzLkNMT0IpOwogICAgICAgICAg\nICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAgICAgICByZXR1cm4gZ2V0\nUHJlZmVycmVkVHlwZShUeXBlcy5CTE9CKTsKICAgICAgICAgICAgfQogICAg\nICAgIH0KCiAgICAgICAgc3dpdGNoIChtZXRhVHlwZUNvZGUpIHsKICAgICAg\nICAgICAgY2FzZSBKYXZhVHlwZXMuQk9PTEVBTjoKICAgICAgICAgICAgY2Fz\nZSBKYXZhVHlwZXMuQk9PTEVBTl9PQko6CiAgICAgICAgICAgICAgICByZXR1\ncm4gZ2V0UHJlZmVycmVkVHlwZShUeXBlcy5CSVQpOwogICAgICAgICAgICBj\nYXNlIEphdmFUeXBlcy5CWVRFOgogICAgICAgICAgICBjYXNlIEphdmFUeXBl\ncy5CWVRFX09CSjoKICAgICAgICAgICAgICAgIHJldHVybiBnZXRQcmVmZXJy\nZWRUeXBlKFR5cGVzLlRJTllJTlQpOwogICAgICAgICAgICBjYXNlIEphdmFU\neXBlcy5DSEFSOgogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5DSEFSX09C\nSjoKICAgICAgICAgICAgICAgIGlmIChzdG9yZUNoYXJzQXNOdW1iZXJzKQog\nICAgICAgICAgICAgICAgICAgIHJldHVybiBnZXRQcmVmZXJyZWRUeXBlKFR5\ncGVzLklOVEVHRVIpOwogICAgICAgICAgICAgICAgcmV0dXJuIGdldFByZWZl\ncnJlZFR5cGUoVHlwZXMuQ0hBUik7CiAgICAgICAgICAgIGNhc2UgSmF2YVR5\ncGVzLkRPVUJMRToKICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuRE9VQkxF\nX09CSjoKICAgICAgICAgICAgICAgIHJldHVybiBnZXRQcmVmZXJyZWRUeXBl\nKFR5cGVzLkRPVUJMRSk7CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLkZM\nT0FUOgogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5GTE9BVF9PQko6CiAg\nICAgICAgICAgICAgICByZXR1cm4gZ2V0UHJlZmVycmVkVHlwZShUeXBlcy5S\nRUFMKTsKICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuSU5UOgogICAgICAg\nICAgICBjYXNlIEphdmFUeXBlcy5JTlRfT0JKOgogICAgICAgICAgICAgICAg\ncmV0dXJuIGdldFByZWZlcnJlZFR5cGUoVHlwZXMuSU5URUdFUik7CiAgICAg\nICAgICAgIGNhc2UgSmF2YVR5cGVzLkxPTkc6CiAgICAgICAgICAgIGNhc2Ug\nSmF2YVR5cGVzLkxPTkdfT0JKOgogICAgICAgICAgICAgICAgcmV0dXJuIGdl\ndFByZWZlcnJlZFR5cGUoVHlwZXMuQklHSU5UKTsKICAgICAgICAgICAgY2Fz\nZSBKYXZhVHlwZXMuU0hPUlQ6CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVz\nLlNIT1JUX09CSjoKICAgICAgICAgICAgICAgIHJldHVybiBnZXRQcmVmZXJy\nZWRUeXBlKFR5cGVzLlNNQUxMSU5UKTsKICAgICAgICAgICAgY2FzZSBKYXZh\nVHlwZXMuU1RSSU5HOgogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5MT0NB\nTEU6CiAgICAgICAgICAgIGNhc2UgSmF2YVNRTFR5cGVzLkFTQ0lJX1NUUkVB\nTToKICAgICAgICAgICAgY2FzZSBKYXZhU1FMVHlwZXMuQ0hBUl9TVFJFQU06\nCiAgICAgICAgICAgICAgICByZXR1cm4gZ2V0UHJlZmVycmVkVHlwZShUeXBl\ncy5WQVJDSEFSKTsKICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuQklHSU5U\nRUdFUjoKICAgICAgICAgICAgICAgIGlmIChzdG9yZUxhcmdlTnVtYmVyc0Fz\nU3RyaW5ncykKICAgICAgICAgICAgICAgICAgICByZXR1cm4gZ2V0UHJlZmVy\ncmVkVHlwZShUeXBlcy5WQVJDSEFSKTsKICAgICAgICAgICAgICAgIHJldHVy\nbiBnZXRQcmVmZXJyZWRUeXBlKFR5cGVzLkJJR0lOVCk7CiAgICAgICAgICAg\nIGNhc2UgSmF2YVR5cGVzLkJJR0RFQ0lNQUw6CiAgICAgICAgICAgICAgICBp\nZiAoc3RvcmVMYXJnZU51bWJlcnNBc1N0cmluZ3MpCiAgICAgICAgICAgICAg\nICAgICAgcmV0dXJuIGdldFByZWZlcnJlZFR5cGUoVHlwZXMuVkFSQ0hBUik7\nCiAgICAgICAgICAgICAgICByZXR1cm4gZ2V0UHJlZmVycmVkVHlwZShUeXBl\ncy5ET1VCTEUpOwogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5OVU1CRVI6\nCiAgICAgICAgICAgICAgICBpZiAoc3RvcmVMYXJnZU51bWJlcnNBc1N0cmlu\nZ3MpCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGdldFByZWZlcnJlZFR5\ncGUoVHlwZXMuVkFSQ0hBUik7CiAgICAgICAgICAgICAgICByZXR1cm4gZ2V0\nUHJlZmVycmVkVHlwZShUeXBlcy5OVU1FUklDKTsKICAgICAgICAgICAgY2Fz\nZSBKYXZhVHlwZXMuQ0FMRU5EQVI6CiAgICAgICAgICAgIGNhc2UgSmF2YVR5\ncGVzLkRBVEU6CiAgICAgICAgICAgICAgICByZXR1cm4gZ2V0UHJlZmVycmVk\nVHlwZShUeXBlcy5USU1FU1RBTVApOwogICAgICAgICAgICBjYXNlIEphdmFT\nUUxUeXBlcy5TUUxfQVJSQVk6CiAgICAgICAgICAgICAgICByZXR1cm4gZ2V0\nUHJlZmVycmVkVHlwZShUeXBlcy5BUlJBWSk7CiAgICAgICAgICAgIGNhc2Ug\nSmF2YVNRTFR5cGVzLkJJTkFSWV9TVFJFQU06CiAgICAgICAgICAgIGNhc2Ug\nSmF2YVNRTFR5cGVzLkJMT0I6CiAgICAgICAgICAgIGNhc2UgSmF2YVNRTFR5\ncGVzLkJZVEVTOgogICAgICAgICAgICAgICAgcmV0dXJuIGdldFByZWZlcnJl\nZFR5cGUoVHlwZXMuQkxPQik7CiAgICAgICAgICAgIGNhc2UgSmF2YVNRTFR5\ncGVzLkNMT0I6CiAgICAgICAgICAgICAgICByZXR1cm4gZ2V0UHJlZmVycmVk\nVHlwZShUeXBlcy5DTE9CKTsKICAgICAgICAgICAgY2FzZSBKYXZhU1FMVHlw\nZXMuU1FMX0RBVEU6CiAgICAgICAgICAgICAgICByZXR1cm4gZ2V0UHJlZmVy\ncmVkVHlwZShUeXBlcy5EQVRFKTsKICAgICAgICAgICAgY2FzZSBKYXZhU1FM\nVHlwZXMuVElNRToKICAgICAgICAgICAgICAgIHJldHVybiBnZXRQcmVmZXJy\nZWRUeXBlKFR5cGVzLlRJTUUpOwogICAgICAgICAgICBjYXNlIEphdmFTUUxU\neXBlcy5USU1FU1RBTVA6CiAgICAgICAgICAgICAgICByZXR1cm4gZ2V0UHJl\nZmVycmVkVHlwZShUeXBlcy5USU1FU1RBTVApOwogICAgICAgICAgICBkZWZh\ndWx0OgogICAgICAgICAgICAgICAgcmV0dXJuIGdldFByZWZlcnJlZFR5cGUo\nVHlwZXMuQkxPQik7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICog\nUmV0dXJuIHRoZSBwcmVmZXJyZWQge0BsaW5rIFR5cGVzfSB0eXBlIGZvciB0\naGUgZ2l2ZW4gb25lLiBSZXR1cm5zCiAgICAgKiB0aGUgZ2l2ZW4gdHlwZSBi\neSBkZWZhdWx0LgogICAgICovCiAgICBwdWJsaWMgaW50IGdldFByZWZlcnJl\nZFR5cGUoaW50IHR5cGUpIHsKICAgICAgICByZXR1cm4gdHlwZTsKICAgIH0K\nCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgcHJlZmVycmVkIGRhdGFiYXNl\nIHR5cGUgbmFtZSBmb3IgdGhlIGdpdmVuIGNvbHVtbidzIHR5cGUKICAgICAq\nIGZyb20ge0BsaW5rIFR5cGVzfS4KICAgICAqLwogICAgcHVibGljIFN0cmlu\nZyBnZXRUeXBlTmFtZShDb2x1bW4gY29sKSB7CiAgICAgICAgaWYgKCFTdHJp\nbmdVdGlscy5pc0VtcHR5KGNvbC5nZXRUeXBlTmFtZSgpKSkKICAgICAgICAg\nICAgcmV0dXJuIGFwcGVuZFNpemUoY29sLCBjb2wuZ2V0VHlwZU5hbWUoKSk7\nCgogICAgICAgIGlmIChjb2wuaXNBdXRvQXNzaWduZWQoKSAmJiBhdXRvQXNz\naWduVHlwZU5hbWUgIT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIGFwcGVu\nZFNpemUoY29sLCBhdXRvQXNzaWduVHlwZU5hbWUpOwoKICAgICAgICByZXR1\ncm4gYXBwZW5kU2l6ZShjb2wsIGdldFR5cGVOYW1lKGNvbC5nZXRUeXBlKCkp\nKTsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybnMgdGhlIHR5cGUgbmFt\nZSBmb3IgdGhlIHNwZWNpZmljIGNvbnN0YW50IGFzIGRlZmluZWQKICAgICAq\nIGJ5IHtAbGluayBqYXZhLnNxbC5UeXBlc30uCiAgICAgKgogICAgICogQHBh\ncmFtIHR5cGUgdGhlIHR5cGUKICAgICAqIEByZXR1cm4gdGhlIG5hbWUgZm9y\nIHRoZSB0eXBlCiAgICAgKi8KICAgIHB1YmxpYyBTdHJpbmcgZ2V0VHlwZU5h\nbWUoaW50IHR5cGUpIHsKICAgICAgICBzd2l0Y2ggKHR5cGUpIHsKICAgICAg\nICAgICAgY2FzZSBUeXBlcy5BUlJBWToKICAgICAgICAgICAgICAgIHJldHVy\nbiBhcnJheVR5cGVOYW1lOwogICAgICAgICAgICBjYXNlIFR5cGVzLkJJR0lO\nVDoKICAgICAgICAgICAgICAgIHJldHVybiBiaWdpbnRUeXBlTmFtZTsKICAg\nICAgICAgICAgY2FzZSBUeXBlcy5CSU5BUlk6CiAgICAgICAgICAgICAgICBy\nZXR1cm4gYmluYXJ5VHlwZU5hbWU7CiAgICAgICAgICAgIGNhc2UgVHlwZXMu\nQklUOgogICAgICAgICAgICAgICAgcmV0dXJuIGJpdFR5cGVOYW1lOwogICAg\nICAgICAgICBjYXNlIFR5cGVzLkJMT0I6CiAgICAgICAgICAgICAgICByZXR1\ncm4gYmxvYlR5cGVOYW1lOwogICAgICAgICAgICBjYXNlIDE2OiAvLyBKREsg\nMS40IGludHJvZHVjZXMgVHlwZXMuQk9PTEVBTiwgd2hvc2UgdmFsdWUgaXMg\nMTYKICAgICAgICAgICAgICAgIHJldHVybiBib29sZWFuVHlwZU5hbWU7CiAg\nICAgICAgICAgIGNhc2UgVHlwZXMuQ0hBUjoKICAgICAgICAgICAgICAgIHJl\ndHVybiBjaGFyVHlwZU5hbWU7CiAgICAgICAgICAgIGNhc2UgVHlwZXMuQ0xP\nQjoKICAgICAgICAgICAgICAgIHJldHVybiBjbG9iVHlwZU5hbWU7CiAgICAg\nICAgICAgIGNhc2UgVHlwZXMuREFURToKICAgICAgICAgICAgICAgIHJldHVy\nbiBkYXRlVHlwZU5hbWU7CiAgICAgICAgICAgIGNhc2UgVHlwZXMuREVDSU1B\nTDoKICAgICAgICAgICAgICAgIHJldHVybiBkZWNpbWFsVHlwZU5hbWU7CiAg\nICAgICAgICAgIGNhc2UgVHlwZXMuRElTVElOQ1Q6CiAgICAgICAgICAgICAg\nICByZXR1cm4gZGlzdGluY3RUeXBlTmFtZTsKICAgICAgICAgICAgY2FzZSBU\neXBlcy5ET1VCTEU6CiAgICAgICAgICAgICAgICByZXR1cm4gZG91YmxlVHlw\nZU5hbWU7CiAgICAgICAgICAgIGNhc2UgVHlwZXMuRkxPQVQ6CiAgICAgICAg\nICAgICAgICByZXR1cm4gZmxvYXRUeXBlTmFtZTsKICAgICAgICAgICAgY2Fz\nZSBUeXBlcy5JTlRFR0VSOgogICAgICAgICAgICAgICAgcmV0dXJuIGludGVn\nZXJUeXBlTmFtZTsKICAgICAgICAgICAgY2FzZSBUeXBlcy5KQVZBX09CSkVD\nVDoKICAgICAgICAgICAgICAgIHJldHVybiBqYXZhT2JqZWN0VHlwZU5hbWU7\nCiAgICAgICAgICAgIGNhc2UgVHlwZXMuTE9OR1ZBUkJJTkFSWToKICAgICAg\nICAgICAgICAgIHJldHVybiBsb25nVmFyYmluYXJ5VHlwZU5hbWU7CiAgICAg\nICAgICAgIGNhc2UgVHlwZXMuTE9OR1ZBUkNIQVI6CiAgICAgICAgICAgICAg\nICByZXR1cm4gbG9uZ1ZhcmNoYXJUeXBlTmFtZTsKICAgICAgICAgICAgY2Fz\nZSBUeXBlcy5OVUxMOgogICAgICAgICAgICAgICAgcmV0dXJuIG51bGxUeXBl\nTmFtZTsKICAgICAgICAgICAgY2FzZSBUeXBlcy5OVU1FUklDOgogICAgICAg\nICAgICAgICAgcmV0dXJuIG51bWVyaWNUeXBlTmFtZTsKICAgICAgICAgICAg\nY2FzZSBUeXBlcy5PVEhFUjoKICAgICAgICAgICAgICAgIHJldHVybiBvdGhl\nclR5cGVOYW1lOwogICAgICAgICAgICBjYXNlIFR5cGVzLlJFQUw6CiAgICAg\nICAgICAgICAgICByZXR1cm4gcmVhbFR5cGVOYW1lOwogICAgICAgICAgICBj\nYXNlIFR5cGVzLlJFRjoKICAgICAgICAgICAgICAgIHJldHVybiByZWZUeXBl\nTmFtZTsKICAgICAgICAgICAgY2FzZSBUeXBlcy5TTUFMTElOVDoKICAgICAg\nICAgICAgICAgIHJldHVybiBzbWFsbGludFR5cGVOYW1lOwogICAgICAgICAg\nICBjYXNlIFR5cGVzLlNUUlVDVDoKICAgICAgICAgICAgICAgIHJldHVybiBz\ndHJ1Y3RUeXBlTmFtZTsKICAgICAgICAgICAgY2FzZSBUeXBlcy5USU1FOgog\nICAgICAgICAgICAgICAgcmV0dXJuIHRpbWVUeXBlTmFtZTsKICAgICAgICAg\nICAgY2FzZSBUeXBlcy5USU1FU1RBTVA6CiAgICAgICAgICAgICAgICByZXR1\ncm4gdGltZXN0YW1wVHlwZU5hbWU7CiAgICAgICAgICAgIGNhc2UgVHlwZXMu\nVElOWUlOVDoKICAgICAgICAgICAgICAgIHJldHVybiB0aW55aW50VHlwZU5h\nbWU7CiAgICAgICAgICAgIGNhc2UgVHlwZXMuVkFSQklOQVJZOgogICAgICAg\nICAgICAgICAgcmV0dXJuIHZhcmJpbmFyeVR5cGVOYW1lOwogICAgICAgICAg\nICBjYXNlIFR5cGVzLlZBUkNIQVI6CiAgICAgICAgICAgICAgICByZXR1cm4g\ndmFyY2hhclR5cGVOYW1lOwogICAgICAgICAgICBkZWZhdWx0OgogICAgICAg\nICAgICAgICAgcmV0dXJuIG90aGVyVHlwZU5hbWU7CiAgICAgICAgfQogICAg\nfQoKICAgIC8qKgogICAgICogSGVscGVyIG1ldGhvZCB0byBhZGQgc2l6ZSBw\ncm9wZXJ0aWVzIHRvIHRoZSBzcGVjaWZpZWQgdHlwZS4KICAgICAqIElmIHBy\nZXNlbnQsIHRoZSBzdHJpbmcgInswfSIgd2lsbCBiZSByZXBsYWNlZCB3aXRo\nIHRoZSBzaXplIGRlZmluaXRpb247CiAgICAgKiBvdGhlcndpc2UgdGhlIHNp\nemUgZGVmaW5pdGlvbiB3aWxsIGJlIGFwcGVuZGVkIHRvIHRoZSB0eXBlIG5h\nbWUuCiAgICAgKiBJZiB5b3VyIGRhdGFiYXNlIGhhcyBjb2x1bW4gdHlwZXMg\ndGhhdCBkb24ndCBhbGxvdyBzaXplIGRlZmluaXRpb25zLAogICAgICogb3Zl\ncnJpZGUgdGhpcyBtZXRob2QgdG8gcmV0dXJuIHRoZSB1bmFsdGVyZWQgdHlw\nZSBuYW1lIGZvciBjb2x1bW5zIG9mCiAgICAgKiB0aG9zZSB0eXBlcyAob3Ig\nYWRkIHRoZSB0eXBlIG5hbWVzIHRvIHRoZQogICAgICogPGNvZGU+Zml4ZWRT\naXplVHlwZU5hbWVTZXQ8L2NvZGU+KS4KICAgICAqLwogICAgcHJvdGVjdGVk\nIFN0cmluZyBhcHBlbmRTaXplKENvbHVtbiBjb2wsIFN0cmluZyB0eXBlTmFt\nZSkgewogICAgICAgIGlmIChmaXhlZFNpemVUeXBlTmFtZVNldC5jb250YWlu\ncyh0eXBlTmFtZS50b1VwcGVyQ2FzZSgpKSkKICAgICAgICAgICAgcmV0dXJu\nIHR5cGVOYW1lOwogICAgICAgIGlmICh0eXBlTmFtZS5pbmRleE9mKCcoJykg\nIT0gLTEpCiAgICAgICAgICAgIHJldHVybiB0eXBlTmFtZTsKCiAgICAgICAg\nU3RyaW5nIHNpemUgPSBudWxsOwogICAgICAgIGlmIChjb2wuZ2V0U2l6ZSgp\nID4gMCkgewogICAgICAgICAgICBTdHJpbmdCdWZmZXIgYnVmID0gbmV3IFN0\ncmluZ0J1ZmZlcigxMCk7CiAgICAgICAgICAgIGJ1Zi5hcHBlbmQoIigiKS5h\ncHBlbmQoY29sLmdldFNpemUoKSk7CiAgICAgICAgICAgIGlmIChjb2wuZ2V0\nRGVjaW1hbERpZ2l0cygpID4gMCkKICAgICAgICAgICAgICAgIGJ1Zi5hcHBl\nbmQoIiwgIikuYXBwZW5kKGNvbC5nZXREZWNpbWFsRGlnaXRzKCkpOwogICAg\nICAgICAgICBidWYuYXBwZW5kKCIpIik7CiAgICAgICAgICAgIHNpemUgPSBi\ndWYudG9TdHJpbmcoKTsKICAgICAgICB9CgogICAgICAgIGludCBpZHggPSB0\neXBlTmFtZS5pbmRleE9mKCJ7MH0iKTsKICAgICAgICBpZiAoaWR4ID09IC0x\nICYmIHNpemUgIT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIHR5cGVOYW1l\nICsgc2l6ZTsKICAgICAgICBpZiAoaWR4ID09IC0xKQogICAgICAgICAgICBy\nZXR1cm4gdHlwZU5hbWU7CgogICAgICAgIC8vIHJlcGxhY2UgJ3swfScgd2l0\naCBzaXplCiAgICAgICAgU3RyaW5nIHJldCA9IHR5cGVOYW1lLnN1YnN0cmlu\nZygwLCBpZHgpOwogICAgICAgIGlmIChzaXplICE9IG51bGwpCiAgICAgICAg\nICAgIHJldCA9IHJldCArIHNpemU7CiAgICAgICAgaWYgKHR5cGVOYW1lLmxl\nbmd0aCgpID4gaWR4ICsgMykKICAgICAgICAgICAgcmV0ID0gcmV0ICsgdHlw\nZU5hbWUuc3Vic3RyaW5nKGlkeCArIDMpOwogICAgICAgIHJldHVybiByZXQ7\nCiAgICB9CgogICAgLy8vLy8vLy8vLy8KICAgIC8vIFNlbGVjdHMKICAgIC8v\nLy8vLy8vLy8vCgogICAgLyoqCiAgICAgKiBTZXQgdGhlIG5hbWUgb2YgdGhl\nIGpvaW4gc3ludGF4IHRvIHVzZTogc3FsOTIsIHRyYWRpdGlvbmFsLCBkYXRh\nYmFzZQogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRKb2luU3ludGF4KFN0\ncmluZyBzeW50YXgpIHsKICAgICAgICBpZiAoInNxbDkyIi5lcXVhbHMoc3lu\ndGF4KSkKICAgICAgICAgICAgam9pblN5bnRheCA9IFNZTlRBWF9TUUw5MjsK\nICAgICAgICBlbHNlIGlmICgidHJhZGl0aW9uYWwiLmVxdWFscyhzeW50YXgp\nKQogICAgICAgICAgICBqb2luU3ludGF4ID0gU1lOVEFYX1RSQURJVElPTkFM\nOwogICAgICAgIGVsc2UgaWYgKCJkYXRhYmFzZSIuZXF1YWxzKHN5bnRheCkp\nCiAgICAgICAgICAgIGpvaW5TeW50YXggPSBTWU5UQVhfREFUQUJBU0U7CiAg\nICAgICAgZWxzZSBpZiAoIVN0cmluZ1V0aWxzLmlzRW1wdHkoc3ludGF4KSkK\nICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlv\nbihzeW50YXgpOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIGEgU1FM\nIHN0cmluZyB0byBhY3QgYXMgYSBwbGFjZWhvbGRlciBmb3IgdGhlIGdpdmVu\nIGNvbHVtbi4KICAgICAqLwogICAgcHVibGljIFN0cmluZyBnZXRQbGFjZWhv\nbGRlclZhbHVlU3RyaW5nKENvbHVtbiBjb2wpIHsKICAgICAgICBzd2l0Y2gg\nKGNvbC5nZXRUeXBlKCkpIHsKICAgICAgICAgICAgY2FzZSBUeXBlcy5CSUdJ\nTlQ6CiAgICAgICAgICAgIGNhc2UgVHlwZXMuQklUOgogICAgICAgICAgICBj\nYXNlIFR5cGVzLklOVEVHRVI6CiAgICAgICAgICAgIGNhc2UgVHlwZXMuTlVN\nRVJJQzoKICAgICAgICAgICAgY2FzZSBUeXBlcy5TTUFMTElOVDoKICAgICAg\nICAgICAgY2FzZSBUeXBlcy5USU5ZSU5UOgogICAgICAgICAgICAgICAgcmV0\ndXJuICIwIjsKICAgICAgICAgICAgY2FzZSBUeXBlcy5DSEFSOgogICAgICAg\nICAgICAgICAgcmV0dXJuIChzdG9yZUNoYXJzQXNOdW1iZXJzKSA/ICIwIiA6\nICInICciOwogICAgICAgICAgICBjYXNlIFR5cGVzLkNMT0I6CiAgICAgICAg\nICAgIGNhc2UgVHlwZXMuTE9OR1ZBUkNIQVI6CiAgICAgICAgICAgIGNhc2Ug\nVHlwZXMuVkFSQ0hBUjoKICAgICAgICAgICAgICAgIHJldHVybiAiJyciOwog\nICAgICAgICAgICBjYXNlIFR5cGVzLkRBVEU6CiAgICAgICAgICAgICAgICBy\nZXR1cm4gWkVST19EQVRFX1NUUjsKICAgICAgICAgICAgY2FzZSBUeXBlcy5E\nRUNJTUFMOgogICAgICAgICAgICBjYXNlIFR5cGVzLkRPVUJMRToKICAgICAg\nICAgICAgY2FzZSBUeXBlcy5GTE9BVDoKICAgICAgICAgICAgY2FzZSBUeXBl\ncy5SRUFMOgogICAgICAgICAgICAgICAgcmV0dXJuICIwLjAiOwogICAgICAg\nICAgICBjYXNlIFR5cGVzLlRJTUU6CiAgICAgICAgICAgICAgICByZXR1cm4g\nWkVST19USU1FX1NUUjsKICAgICAgICAgICAgY2FzZSBUeXBlcy5USU1FU1RB\nTVA6CiAgICAgICAgICAgICAgICByZXR1cm4gWkVST19USU1FU1RBTVBfU1RS\nOwogICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgICAgcmV0dXJu\nICJOVUxMIjsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBDcmVh\ndGUgYSBTRUxFQ1QgQ09VTlQgc3RhdGVtZW50IGluIHRoZSBwcm9wZXIgam9p\nbiBzeW50YXggZm9yIHRoZQogICAgICogZ2l2ZW4gaW5zdGFuY2UuCiAgICAg\nKi8KICAgIHB1YmxpYyBTUUxCdWZmZXIgdG9TZWxlY3RDb3VudChTZWxlY3Qg\nc2VsKSB7CiAgICAgICAgU1FMQnVmZmVyIHNlbGVjdFNRTCA9IG5ldyBTUUxC\ndWZmZXIodGhpcyk7CiAgICAgICAgU1FMQnVmZmVyIGZyb207CiAgICAgICAg\nc2VsLmFkZEpvaW5DbGFzc0NvbmRpdGlvbnMoKTsKICAgICAgICBpZiAoc2Vs\nLmdldEZyb21TZWxlY3QoKSAhPSBudWxsKQogICAgICAgICAgICBmcm9tID0g\nZ2V0RnJvbVNlbGVjdChzZWwsIGZhbHNlKTsKICAgICAgICBlbHNlCiAgICAg\nICAgICAgIGZyb20gPSBnZXRGcm9tKHNlbCwgZmFsc2UpOwogICAgICAgIFNR\nTEJ1ZmZlciB3aGVyZSA9IGdldFdoZXJlKHNlbCwgZmFsc2UpOwoKICAgICAg\nICAvLyBpZiBubyBncm91cGluZyBhbmQgbm8gcmFuZ2UsIHdlIG1pZ2h0IGJl\nIGFibGUgdG8gZ2V0IGJ5IHdpdGhvdXQKICAgICAgICAvLyBhIHN1YnNlbGVj\ndAogICAgICAgIGlmIChzZWwuZ2V0R3JvdXBpbmcoKSA9PSBudWxsICYmIHNl\nbC5nZXRTdGFydEluZGV4KCkgPT0gMAogICAgICAgICAgICAmJiBzZWwuZ2V0\nRW5kSW5kZXgoKSA9PSBMb25nLk1BWF9WQUxVRSkgewogICAgICAgICAgICAv\nLyBpZiB0aGUgc2VsZWN0IGhhcyBubyBpZGVudGlmaWVyIGNvbHMsIHVzZSBD\nT1VOVCgqKQogICAgICAgICAgICBMaXN0IGFsaWFzZXMgPSAoIXNlbC5pc0Rp\nc3RpbmN0KCkpID8gQ29sbGVjdGlvbnMuRU1QVFlfTElTVAogICAgICAgICAg\nICAgICAgOiBzZWwuZ2V0SWRlbnRpZmllckFsaWFzZXMoKTsKICAgICAgICAg\nICAgaWYgKGFsaWFzZXMuaXNFbXB0eSgpKSB7CiAgICAgICAgICAgICAgICBz\nZWxlY3RTUUwuYXBwZW5kKCJDT1VOVCgqKSIpOwogICAgICAgICAgICAgICAg\ncmV0dXJuIHRvU2VsZWN0KHNlbGVjdFNRTCwgbnVsbCwgZnJvbSwgd2hlcmUs\nIG51bGwsIG51bGwsIG51bGwsCiAgICAgICAgICAgICAgICAgICAgZmFsc2Us\nIGZhbHNlLCAwLCBMb25nLk1BWF9WQUxVRSk7CiAgICAgICAgICAgIH0KCiAg\nICAgICAgICAgIC8vIGlmIHRoZXJlIGlzIGEgc2luZ2xlIGRpc3RpbmN0IGNv\nbCwgdXNlIENPVU5UKERJU1RJTkNUIGNvbCkKICAgICAgICAgICAgaWYgKGFs\naWFzZXMuc2l6ZSgpID09IDEpIHsKICAgICAgICAgICAgICAgIHNlbGVjdFNR\nTC5hcHBlbmQoIkNPVU5UKERJU1RJTkNUICIpLgogICAgICAgICAgICAgICAg\nICAgIGFwcGVuZChhbGlhc2VzLmdldCgwKS50b1N0cmluZygpKS5hcHBlbmQo\nIikiKTsKICAgICAgICAgICAgICAgIHJldHVybiB0b1NlbGVjdChzZWxlY3RT\nUUwsIG51bGwsIGZyb20sIHdoZXJlLCBudWxsLCBudWxsLCBudWxsLAogICAg\nICAgICAgICAgICAgICAgIGZhbHNlLCBmYWxzZSwgMCwgTG9uZy5NQVhfVkFM\nVUUpOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBjYW4gd2UgY29t\nYmluZSBkaXN0aW5jdCBjb2xzPwogICAgICAgICAgICBpZiAoZGlzdGluY3RD\nb3VudENvbHVtblNlcGFyYXRvciAhPSBudWxsKSB7CiAgICAgICAgICAgICAg\nICBzZWxlY3RTUUwuYXBwZW5kKCJDT1VOVChESVNUSU5DVCAiKTsKICAgICAg\nICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgYWxpYXNlcy5zaXplKCk7\nIGkrKykgewogICAgICAgICAgICAgICAgICAgIGlmIChpID4gMCkgewogICAg\nICAgICAgICAgICAgICAgICAgICBzZWxlY3RTUUwuYXBwZW5kKCIgIik7CiAg\nICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdFNRTC5hcHBlbmQoZGlzdGlu\nY3RDb3VudENvbHVtblNlcGFyYXRvcik7CiAgICAgICAgICAgICAgICAgICAg\nICAgIHNlbGVjdFNRTC5hcHBlbmQoIiAiKTsKICAgICAgICAgICAgICAgICAg\nICB9CiAgICAgICAgICAgICAgICAgICAgc2VsZWN0U1FMLmFwcGVuZChhbGlh\nc2VzLmdldChpKS50b1N0cmluZygpKTsKICAgICAgICAgICAgICAgIH0KICAg\nICAgICAgICAgICAgIHNlbGVjdFNRTC5hcHBlbmQoIikiKTsKICAgICAgICAg\nICAgICAgIHJldHVybiB0b1NlbGVjdChzZWxlY3RTUUwsIG51bGwsIGZyb20s\nIHdoZXJlLCBudWxsLCBudWxsLCBudWxsLAogICAgICAgICAgICAgICAgICAg\nIGZhbHNlLCBmYWxzZSwgMCwgTG9uZy5NQVhfVkFMVUUpOwogICAgICAgICAg\nICB9CiAgICAgICAgfQoKICAgICAgICAvLyBzaW5jZSB3ZSBjYW4ndCBjb21i\naW5lIGRpc3RpbmN0IGNvbHMsIHdlIGhhdmUgdG8gcGVyZm9ybSBhbiBvdXRl\ncgogICAgICAgIC8vIENPVU5UKCopIHNlbGVjdCB1c2luZyB0aGUgb3JpZ2lu\nYWwgc2VsZWN0IGFzIGEgc3Vic2VsZWN0IGluIHRoZQogICAgICAgIC8vIEZS\nT00gY2xhdXNlCiAgICAgICAgYXNzZXJ0U3VwcG9ydChzdXBwb3J0c1N1YnNl\nbGVjdCwgIlN1cHBvcnRzU3Vic2VsZWN0Iik7CgogICAgICAgIFNRTEJ1ZmZl\nciBzdWJTZWxlY3QgPSBnZXRTZWxlY3RzKHNlbCwgdHJ1ZSwgZmFsc2UpOwog\nICAgICAgIFNRTEJ1ZmZlciBzdWJGcm9tID0gZnJvbTsKICAgICAgICBmcm9t\nID0gbmV3IFNRTEJ1ZmZlcih0aGlzKTsKICAgICAgICBmcm9tLmFwcGVuZCgi\nKCIpOwogICAgICAgIGZyb20uYXBwZW5kKHRvU2VsZWN0KHN1YlNlbGVjdCwg\nbnVsbCwgc3ViRnJvbSwgd2hlcmUsCiAgICAgICAgICAgIHNlbC5nZXRHcm91\ncGluZygpLCBzZWwuZ2V0SGF2aW5nKCksIG51bGwsIHNlbC5pc0Rpc3RpbmN0\nKCksCiAgICAgICAgICAgIGZhbHNlLCBzZWwuZ2V0U3RhcnRJbmRleCgpLCBz\nZWwuZ2V0RW5kSW5kZXgoKSwgdHJ1ZSkpOwogICAgICAgIGZyb20uYXBwZW5k\nKCIpIik7CiAgICAgICAgaWYgKHJlcXVpcmVzQWxpYXNGb3JTdWJzZWxlY3Qp\nCiAgICAgICAgICAgIGZyb20uYXBwZW5kKCIgIikuYXBwZW5kKFNlbGVjdC5G\nUk9NX1NFTEVDVF9BTElBUyk7CgogICAgICAgIHNlbGVjdFNRTC5hcHBlbmQo\nIkNPVU5UKCopIik7CiAgICAgICAgcmV0dXJuIHRvU2VsZWN0KHNlbGVjdFNR\nTCwgbnVsbCwgZnJvbSwgbnVsbCwgbnVsbCwgbnVsbCwgbnVsbCwKICAgICAg\nICAgICAgZmFsc2UsIGZhbHNlLCAwLCBMb25nLk1BWF9WQUxVRSk7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBDcmVhdGUgYSBERUxFVEUgc3RhdGVtZW50IGZv\nciB0aGUgc3BlY2lmaWVkIFNlbGVjdC4gSWYgdGhlCiAgICAgKiBkYXRhYmFz\nZSBkb2VzIG5vdCBzdXBwb3J0IHRoZSBidWxrIGRlbGV0ZSBzdGF0ZW1lbnQg\nKHN1Y2ggYXMKICAgICAqIGNhc2VzIHdoZXJlIGEgc3Vic2VsZWN0IGlzIHJl\ncXVpcmVkIGFuZCB0aGUgZGF0YWJhc2UgZG9lc24ndCBzdXBwb3J0CiAgICAg\nKiBzdWJzZWxlY3RzKSwgdGhpcyBtZXRob2Qgc2hvdWxkIHJldHVybiBudWxs\nLgogICAgICovCiAgICBwdWJsaWMgU1FMQnVmZmVyIHRvRGVsZXRlKENsYXNz\nTWFwcGluZyBtYXBwaW5nLCBTZWxlY3Qgc2VsLCAKICAgICAgICBPYmplY3Rb\nXSBwYXJhbXMpIHsKICAgICAgICByZXR1cm4gdG9CdWxrT3BlcmF0aW9uKG1h\ncHBpbmcsIHNlbCwgbnVsbCwgcGFyYW1zLCBudWxsKTsKICAgIH0KCiAgICBw\ndWJsaWMgU1FMQnVmZmVyIHRvVXBkYXRlKENsYXNzTWFwcGluZyBtYXBwaW5n\nLCBTZWxlY3Qgc2VsLAogICAgICAgIEpEQkNTdG9yZSBzdG9yZSwgT2JqZWN0\nW10gcGFyYW1zLCBNYXAgdXBkYXRlcykgewogICAgICAgIHJldHVybiB0b0J1\nbGtPcGVyYXRpb24obWFwcGluZywgc2VsLCBzdG9yZSwgcGFyYW1zLCB1cGRh\ndGVzKTsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybnMgdGhlIFNRTCBm\nb3IgYSBidWxrIG9wZXJhdGlvbiwgZWl0aGVyIGEgREVMRVRFIG9yIGFuIFVQ\nREFURS4KICAgICAqCiAgICAgKiBAcGFyYW0gbWFwcGluZyB0aGUgbWFwcG5n\nIGFnYWluc3Qgd2hpY2ggd2UgYXJlIG9wZXJhdGluZwogICAgICogQHBhcmFt\nIHNlbCB0aGUgU2VsZWN0IHRoYXQgd2lsbCBjb25zdGl0dXRlIHRoZSBXSEVS\nRSBjbGF1c2UKICAgICAqIEBwYXJhbSBzdG9yZSB0aGUgY3VycmVudCBzdG9y\nZQogICAgICogQHBhcmFtIHVwZGF0ZVBhcmFtcyB0aGUgTWFwIHRoYXQgaG9s\nZHMgdGhlIHVwZGF0ZSBwYXJhbWV0ZXJzOyBhIG51bGwKICAgICAqIHZhbHVl\nIGluZGljYXRlcyB0aGF0IHRoaXMgaXMgYSBkZWxldGUgb3BlcmF0aW9uCiAg\nICAgKiBAcmV0dXJuIHRoZSBTUUxCdWZmZXIgZm9yIHRoZSB1cGRhdGUsIG9y\nIDxlbT5udWxsPC9lbT4gaWYgaXQgaXMgbm90CiAgICAgKiBwb3NzaWJsZSB0\nbyBwZXJmb3JtIHRoZSBidWxrIHVwZGF0ZQogICAgICovCiAgICBwcm90ZWN0\nZWQgU1FMQnVmZmVyIHRvQnVsa09wZXJhdGlvbihDbGFzc01hcHBpbmcgbWFw\ncGluZywgU2VsZWN0IHNlbCwKICAgICAgICBKREJDU3RvcmUgc3RvcmUsIE9i\namVjdFtdIHBhcmFtcywgTWFwIHVwZGF0ZVBhcmFtcykgewogICAgICAgIFNR\nTEJ1ZmZlciBzcWwgPSBuZXcgU1FMQnVmZmVyKHRoaXMpOwogICAgICAgIGlm\nICh1cGRhdGVQYXJhbXMgPT0gbnVsbCkKICAgICAgICAgICAgc3FsLmFwcGVu\nZCgiREVMRVRFIEZST00gIik7CiAgICAgICAgZWxzZQogICAgICAgICAgICBz\ncWwuYXBwZW5kKCJVUERBVEUgIik7CiAgICAgICAgc2VsLmFkZEpvaW5DbGFz\nc0NvbmRpdGlvbnMoKTsKCiAgICAgICAgLy8gaWYgdGhlcmUgaXMgb25seSBh\nIHNpbmdsZSB0YWJsZSBpbiB0aGUgc2VsZWN0LCB0aGVuIHdlIGNhbgogICAg\nICAgIC8vIGp1c3QgaXNzdWUgYSBzaW5nbGUgREVMRVRFIEZST00gVEFCTEUg\nV0hFUkUgPGNvbmRpdGlvbnM+CiAgICAgICAgLy8gc3RhdGVtZW50OyBvdGhl\ncndpc2UsIHNpbmNlIFNRTCBkb2Vzbid0IGFsbG93IGRlbGV0aW5nCiAgICAg\nICAgLy8gZnJvbSBvbmUgb2YgYSBtdWx0aS10YWJsZSBzZWxlY3QsIHdlIG5l\nZWQgdG8gaXNzdWUgYSBzdWJzZWxlY3QKICAgICAgICAvLyBsaWtlIERFTEVU\nRSBGUk9NIFRBQkxFIFdIRVJFIEVYSVNUUwogICAgICAgIC8vIChTRUxFQ1Qg\nMSBGUk9NIFRBQkxFIHQwIFdIRVJFIHQwLklEID0gVEFCTEUuSUQpOyBhbHNv\nLCBzb21lCiAgICAgICAgLy8gZGF0YWJhc2VzIGRvIG5vdCBhbGxvdyBhbGlh\nc2VzIGluIGRlbGV0ZSBzdGF0ZW1lbnRzLCB3aGljaAogICAgICAgIC8vIGFs\nc28gY2F1c2VzIHVzIHRvIHVzZSBhIHN1YnNlbGVjdAogICAgICAgIGlmIChz\nZWwuZ2V0VGFibGVBbGlhc2VzKCkuc2l6ZSgpID09IDEgJiYgc3VwcG9ydHNT\ndWJzZWxlY3QKICAgICAgICAgICAgJiYgYWxsb3dzQWxpYXNJbkJ1bGtDbGF1\nc2UpIHsKICAgICAgICAgICAgU1FMQnVmZmVyIGZyb207CiAgICAgICAgICAg\nIGlmIChzZWwuZ2V0RnJvbVNlbGVjdCgpICE9IG51bGwpCiAgICAgICAgICAg\nICAgICBmcm9tID0gZ2V0RnJvbVNlbGVjdChzZWwsIGZhbHNlKTsKICAgICAg\nICAgICAgZWxzZQogICAgICAgICAgICAgICAgZnJvbSA9IGdldEZyb20oc2Vs\nLCBmYWxzZSk7CgogICAgICAgICAgICBzcWwuYXBwZW5kKGZyb20pOwogICAg\nICAgICAgICBhcHBlbmRVcGRhdGVzKHNlbCwgc3RvcmUsIHNxbCwgcGFyYW1z\nLCB1cGRhdGVQYXJhbXMsCiAgICAgICAgICAgICAgICBhbGxvd3NBbGlhc0lu\nQnVsa0NsYXVzZSk7CgogICAgICAgICAgICBTUUxCdWZmZXIgd2hlcmUgPSBz\nZWwuZ2V0V2hlcmUoKTsKICAgICAgICAgICAgaWYgKHdoZXJlICE9IG51bGwg\nJiYgIXdoZXJlLmlzRW1wdHkoKSkgewogICAgICAgICAgICAgICAgc3FsLmFw\ncGVuZCgiIFdIRVJFICIpOwogICAgICAgICAgICAgICAgc3FsLmFwcGVuZCh3\naGVyZSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIHNxbDsK\nICAgICAgICB9CgogICAgICAgIFRhYmxlIHRhYmxlID0gbWFwcGluZy5nZXRU\nYWJsZSgpOwogICAgICAgIFN0cmluZyB0YWJsZU5hbWUgPSBnZXRGdWxsTmFt\nZSh0YWJsZSwgZmFsc2UpOwoKICAgICAgICAvLyBvbmx5IHVzZSBhICBzdWJz\nZWxlY3QgaWYgdGhlIHdoZXJlIGlzIG5vdCBlbXB0eTsgb3RoZXJ3aXNlCiAg\nICAgICAgLy8gYW4gdW5xdWFsaWZpZWQgZGVsZXRlIG9yIHVwZGF0ZSB3aWxs\nIHdvcmsKICAgICAgICBpZiAoc2VsLmdldFdoZXJlKCkgPT0gbnVsbCB8fCBz\nZWwuZ2V0V2hlcmUoKS5pc0VtcHR5KCkpIHsKICAgICAgICAgICAgc3FsLmFw\ncGVuZCh0YWJsZU5hbWUpOwogICAgICAgICAgICBhcHBlbmRVcGRhdGVzKHNl\nbCwgc3RvcmUsIHNxbCwgcGFyYW1zLCB1cGRhdGVQYXJhbXMsIGZhbHNlKTsK\nICAgICAgICAgICAgcmV0dXJuIHNxbDsKICAgICAgICB9CgogICAgICAgIC8v\nIHdlIG5lZWQgdG8gdXNlIGEgc3Vic2VsZWN0IGlmIHdlIGFyZSB0byBidWxr\nIGRlbGV0ZSB3aGVyZQogICAgICAgIC8vIHRoZSBzZWxlY3QgaW5jbHVkZXMg\nbXVsdGlwbGUgdGFibGVzOyBpZiB0aGUgZGF0YWJhc2UKICAgICAgICAvLyBk\nb2Vzbid0IHN1cHBvcnQgaXQsIHRoZW4gd2UgbmVlZCB0byBzaWdhbCB0aGlz\nIGJ5IHJldHVybmluZyBudWxsCiAgICAgICAgaWYgKCFzdXBwb3J0c1N1YnNl\nbGVjdCB8fCAhc3VwcG9ydHNDb3JyZWxhdGVkU3Vic2VsZWN0KQogICAgICAg\nICAgICByZXR1cm4gbnVsbDsKCiAgICAgICAgQ29sdW1uW10gcGtzID0gbWFw\ncGluZy5nZXRQcmltYXJ5S2V5Q29sdW1ucygpOwogICAgICAgIHNlbC5jbGVh\nclNlbGVjdHMoKTsKICAgICAgICBzZWwuc2V0RGlzdGluY3QodHJ1ZSk7Cgog\nICAgICAgIC8vIGlmIHdlIGhhdmUgb25seSBhIHNpbmdsZSBQSywgd2UgY2Fu\nIHVzZSBhIG5vbi1jb3JyZWxhdGVkCiAgICAgICAgLy8gc3VicXVlcnkgKHVz\naW5nIGFuIElOIHN0YXRlbWVudCksIHdoaWNoIGlzIG11Y2ggZmFzdGVyIHRo\nYW4KICAgICAgICAvLyBhIGNvcnJlbGF0ZWQgc3VicXVlcnkgKHNpbmNlIGEg\nY29ycmVsYXRlZCBzdWJxdWVyeSBuZWVkcwogICAgICAgIC8vIHRvIGJlIGV4\nZWN1dGVkIG9uY2UgZm9yIGVhY2ggcm93IGluIHRoZSB0YWJsZSkKICAgICAg\nICBpZiAocGtzLmxlbmd0aCA9PSAxKSB7CiAgICAgICAgICAgIHNlbC5zZWxl\nY3QocGtzWzBdKTsKICAgICAgICAgICAgc3FsLmFwcGVuZCh0YWJsZU5hbWUp\nOwogICAgICAgICAgICBhcHBlbmRVcGRhdGVzKHNlbCwgc3RvcmUsIHNxbCwg\ncGFyYW1zLCB1cGRhdGVQYXJhbXMsIGZhbHNlKTsKICAgICAgICAgICAgc3Fs\nLmFwcGVuZCgiIFdIRVJFICIpLgogICAgICAgICAgICAgICAgYXBwZW5kKHBr\nc1swXSkuYXBwZW5kKCIgSU4gKCIpLgogICAgICAgICAgICAgICAgYXBwZW5k\nKHNlbC50b1NlbGVjdChmYWxzZSwgbnVsbCkpLmFwcGVuZCgiKSIpOwogICAg\nICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHNlbC5jbGVhclNlbGVjdHMoKTsK\nICAgICAgICAgICAgc2VsLnNldERpc3RpbmN0KGZhbHNlKTsKCiAgICAgICAg\nICAgIC8vIHNpbmNlIHRoZSBzZWxlY3QgaXMgdXNpbmcgYSBjb3JyZWxhdGVk\nIHN1YnF1ZXJ5LCB3ZQogICAgICAgICAgICAvLyBvbmx5IG5lZWQgdG8gc2Vs\nZWN0IGEgYm9ndXMgdmlydHVhbCBjb2x1bW4KICAgICAgICAgICAgc2VsLnNl\nbGVjdCgiMSIsIG51bGwpOwoKICAgICAgICAgICAgLy8gYWRkIGluIHRoZSBq\nb2lucyB0byB0aGUgdGFibGUKICAgICAgICAgICAgQ29sdW1uW10gY29scyA9\nIHRhYmxlLmdldFByaW1hcnlLZXkoKS5nZXRDb2x1bW5zKCk7CiAgICAgICAg\nICAgIFNRTEJ1ZmZlciBidWYgPSBuZXcgU1FMQnVmZmVyKHRoaXMpOwogICAg\nICAgICAgICBidWYuYXBwZW5kKCIoIik7CiAgICAgICAgICAgIGZvciAoaW50\nIGkgPSAwOyBpIDwgY29scy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAg\nICAgaWYgKGkgPiAwKQogICAgICAgICAgICAgICAgICAgIGJ1Zi5hcHBlbmQo\nIiBBTkQgIik7CgogICAgICAgICAgICAgICAgLy8gYWRkIGluICJ0MC5QSyA9\nIE1ZVEFCTEUuUEsiCiAgICAgICAgICAgICAgICBidWYuYXBwZW5kKHNlbC5n\nZXRDb2x1bW5BbGlhcyhjb2xzW2ldLCBudWxsKSkuYXBwZW5kKCIgPSAiKS4K\nICAgICAgICAgICAgICAgICAgICBhcHBlbmQodGFibGUpLmFwcGVuZChjYXRh\nbG9nU2VwYXJhdG9yKS5hcHBlbmQoY29sc1tpXSk7CiAgICAgICAgICAgIH0K\nICAgICAgICAgICAgYnVmLmFwcGVuZCgiKSIpOwogICAgICAgICAgICBzZWwu\nd2hlcmUoYnVmLCBudWxsKTsKCiAgICAgICAgICAgIHNxbC5hcHBlbmQodGFi\nbGVOYW1lKTsKICAgICAgICAgICAgYXBwZW5kVXBkYXRlcyhzZWwsIHN0b3Jl\nLCBzcWwsIHBhcmFtcywgdXBkYXRlUGFyYW1zLCBmYWxzZSk7CiAgICAgICAg\nICAgIHNxbC5hcHBlbmQoIiBXSEVSRSBFWElTVFMgKCIpLgogICAgICAgICAg\nICAgICAgYXBwZW5kKHNlbC50b1NlbGVjdChmYWxzZSwgbnVsbCkpLmFwcGVu\nZCgiKSIpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gc3FsOwogICAgfQoK\nICAgIHByb3RlY3RlZCB2b2lkIGFwcGVuZFVwZGF0ZXMoU2VsZWN0IHNlbCwg\nSkRCQ1N0b3JlIHN0b3JlLCBTUUxCdWZmZXIgc3FsLAogICAgICAgIE9iamVj\ndFtdIHBhcmFtcywgTWFwIHVwZGF0ZVBhcmFtcywgYm9vbGVhbiBhbGxvd0Fs\naWFzKSB7CiAgICAgICAgaWYgKHVwZGF0ZVBhcmFtcyA9PSBudWxsIHx8IHVw\nZGF0ZVBhcmFtcy5zaXplKCkgPT0gMCkKICAgICAgICAgICAgcmV0dXJuOwoK\nICAgICAgICAvLyBtYW51YWxseSBidWlsZCB1cCB0aGUgU0VUIGNsYXVzZSBm\nb3IgdGhlIFVQREFURSBzdGF0ZW1lbnQKICAgICAgICBzcWwuYXBwZW5kKCIg\nU0VUICIpOwogICAgICAgIEV4cENvbnRleHQgY3R4ID0gbmV3IEV4cENvbnRl\neHQoc3RvcmUsIHBhcmFtcywgCiAgICAgICAgICAgIHN0b3JlLmdldEZldGNo\nQ29uZmlndXJhdGlvbigpKTsKCiAgICAgICAgLy8gSWYgdGhlIHVwZGF0ZXMg\nbWFwIGNvbnRhaW5zIGFueSB2ZXJzaW9uIGZpZWxkcywgYXNzdW1lIHRoYXQg\ndGhlCiAgICAgICAgLy8gb3B0aW1pc3RpYyBsb2NrIHZlcnNpb24gZGF0YSBp\ncyBiZWluZyBoYW5kbGVkIHByb3Blcmx5IGJ5IHRoZQogICAgICAgIC8vIGNh\nbGxlci4gT3RoZXJ3aXNlLCBnaXZlIHRoZSB2ZXJzaW9uIGluZGljYXRvciBh\nbiBvcHBvcnR1bml0eSB0bwogICAgICAgIC8vIGFkZCBtb3JlIHVwZGF0ZSBj\nbGF1c2VzIGFzIG5lZWRlZC4KICAgICAgICBib29sZWFuIGF1Z21lbnRVcGRh\ndGVzID0gdHJ1ZTsKCiAgICAgICAgZm9yIChJdGVyYXRvciBpID0gdXBkYXRl\nUGFyYW1zLmVudHJ5U2V0KCkuaXRlcmF0b3IoKTsgaS5oYXNOZXh0KCk7KSB7\nCiAgICAgICAgICAgIE1hcC5FbnRyeSBuZXh0ID0gKE1hcC5FbnRyeSkgaS5u\nZXh0KCk7CiAgICAgICAgICAgIEZpZWxkTWFwcGluZyBmbWQgPSAoRmllbGRN\nYXBwaW5nKSBuZXh0LmdldEtleSgpOwoKICAgICAgICAgICAgaWYgKGZtZC5p\nc1ZlcnNpb24oKSkKICAgICAgICAgICAgICAgIGF1Z21lbnRVcGRhdGVzID0g\nZmFsc2U7CgogICAgICAgICAgICBWYWwgdmFsID0gKFZhbCkgbmV4dC5nZXRW\nYWx1ZSgpOwoKICAgICAgICAgICAgQ29sdW1uIGNvbCA9IGZtZC5nZXRDb2x1\nbW5zKClbMF07CiAgICAgICAgICAgIHNxbC5hcHBlbmQoY29sLmdldE5hbWUo\nKSk7CiAgICAgICAgICAgIHNxbC5hcHBlbmQoIiA9ICIpOwoKICAgICAgICAg\nICAgRXhwU3RhdGUgc3RhdGUgPSB2YWwuaW5pdGlhbGl6ZShzZWwsIGN0eCwg\nMCk7CiAgICAgICAgICAgIHZhbC5jYWxjdWxhdGVWYWx1ZShzZWwsIGN0eCwg\nc3RhdGUsIG51bGwsIG51bGwpOwoKICAgICAgICAgICAgLy8gYXBwZW5kIHRo\nZSB2YWx1ZSB3aXRoIGEgbnVsbCBmb3IgdGhlIFNlbGVjdDsgaQogICAgICAg\nICAgICAvLyBpbmRpY2F0ZXMgdGhhdCB0aGUKICAgICAgICAgICAgaW50IGxl\nbmd0aCA9IHZhbC5sZW5ndGgoc2VsLCBjdHgsIHN0YXRlKTsKICAgICAgICAg\nICAgZm9yIChpbnQgaiA9IDA7IGogPCBsZW5ndGg7IGorKykKICAgICAgICAg\nICAgICAgIHZhbC5hcHBlbmRUbygoYWxsb3dBbGlhcykgPyBzZWwgOiBudWxs\nLCBjdHgsIHN0YXRlLCBzcWwsIGopOwoKICAgICAgICAgICAgaWYgKGkuaGFz\nTmV4dCgpKQogICAgICAgICAgICAgICAgc3FsLmFwcGVuZCgiLCAiKTsKICAg\nICAgICB9CgogICAgICAgIGlmIChhdWdtZW50VXBkYXRlcykgewogICAgICAg\nICAgICBDbGFzc01hcHBpbmcgbWV0YSA9CiAgICAgICAgICAgICAgICAoKEZp\nZWxkTWFwcGluZykgdXBkYXRlUGFyYW1zLmtleVNldCgpLml0ZXJhdG9yKCku\nbmV4dCgpKQogICAgICAgICAgICAgICAgICAgIC5nZXREZWNsYXJpbmdNYXBw\naW5nKCk7CiAgICAgICAgICAgIE1hcCB1cGRhdGVzID0gbWV0YS5nZXRWZXJz\naW9uKCkuZ2V0QnVsa1VwZGF0ZVZhbHVlcygpOwogICAgICAgICAgICBmb3Ig\nKEl0ZXJhdG9yIGl0ZXIgPSB1cGRhdGVzLmVudHJ5U2V0KCkuaXRlcmF0b3Io\nKTsKICAgICAgICAgICAgICAgIGl0ZXIuaGFzTmV4dCgpOyApIHsKICAgICAg\nICAgICAgICAgIE1hcC5FbnRyeSBlID0gKE1hcC5FbnRyeSkgaXRlci5uZXh0\nKCk7CiAgICAgICAgICAgICAgICBDb2x1bW4gY29sID0gKENvbHVtbikgZS5n\nZXRLZXkoKTsKICAgICAgICAgICAgICAgIFN0cmluZyB2YWwgPSAoU3RyaW5n\nKSBlLmdldFZhbHVlKCk7CiAgICAgICAgICAgICAgICBzcWwuYXBwZW5kKCIs\nICIpLmFwcGVuZChjb2wuZ2V0TmFtZSgpKQogICAgICAgICAgICAgICAgICAg\nIC5hcHBlbmQoIiA9ICIpLmFwcGVuZCh2YWwpOwogICAgICAgICAgICB9CiAg\nICAgICAgfQogICAgfQogICAgCiAgICAvKioKICAgICAqIENyZWF0ZSBTUUwg\ndG8gZGVsZXRlIHRoZSBjb250ZW50cyBvZiB0aGUgc3BlY2lmaWVkIHRhYmxl\ncy4gCiAgICAgKiBUaGUgZGVmYXVsdCBpbXBsZW1lbnRhdGlvbiBkcm9wcyBh\nbGwgbm9uLWRlZmVycmVkIFJFU1RSSUNUIGZvcmVpZ24ga2V5IAogICAgICog\nY29uc3RyYWludHMgaW52b2x2aW5nIHRoZSBzcGVjaWZpZWQgdGFibGVzLCBp\nc3N1ZXMgREVMRVRFIHN0YXRlbWVudHMgCiAgICAgKiBhZ2FpbnN0IHRoZSB0\nYWJsZXMsIGFuZCB0aGVuIGFkZHMgdGhlIGRyb3BwZWQgY29uc3RyYWludHMg\nYmFjayBpbi4gCiAgICAgKiBEYXRhYmFzZXMgd2l0aCBtb3JlIG9wdGltYWwg\nd2F5cyBvZiBkZWxldGluZyB0aGUgY29udGVudHMgb2Ygc2V2ZXJhbCAKICAg\nICAqIHRhYmxlcyBzaG91bGQgb3ZlcnJpZGUgdGhpcyBtZXRob2QuCiAgICAg\nKi8KICAgIHB1YmxpYyBTdHJpbmdbXSBnZXREZWxldGVUYWJsZUNvbnRlbnRz\nU1FMKFRhYmxlW10gdGFibGVzKSB7CiAgICAgICAgQ29sbGVjdGlvbiBzcWwg\nPSBuZXcgQXJyYXlMaXN0KCk7CiAgICAgICAgCiAgICAgICAgLy8gY29sbGVj\ndCBhbmQgZHJvcCBub24tZGVmZXJyZWQgcGh5c2ljYWwgcmVzdHJpY3QgY29u\nc3RyYWludHMsIGFuZAogICAgICAgIC8vIGNvbGxlY3QgdGhlIERFTEVURSBG\nUk9NIHN0YXRlbWVudHMKICAgICAgICBDb2xsZWN0aW9uIGRlbGV0ZVNRTCA9\nIG5ldyBBcnJheUxpc3QodGFibGVzLmxlbmd0aCk7CiAgICAgICAgQ29sbGVj\ndGlvbiByZXN0cmljdENvbnN0cmFpbnRzID0gbmV3IExpbmtlZEhhc2hTZXQo\nKTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IHRhYmxlcy5sZW5ndGg7\nIGkrKykgewogICAgICAgICAgICBGb3JlaWduS2V5W10gZmtzID0gdGFibGVz\nW2ldLmdldEZvcmVpZ25LZXlzKCk7CiAgICAgICAgICAgIGZvciAoaW50IGog\nPSAwOyBqIDwgZmtzLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICAgICAgICBp\nZiAoIWZrc1tqXS5pc0xvZ2ljYWwoKSAmJiAhZmtzW2pdLmlzRGVmZXJyZWQo\nKSAKICAgICAgICAgICAgICAgICAgICAmJiBma3Nbal0uZ2V0RGVsZXRlQWN0\naW9uKCkgPT0gRm9yZWlnbktleS5BQ1RJT05fUkVTVFJJQ1QpCiAgICAgICAg\nICAgICAgICByZXN0cmljdENvbnN0cmFpbnRzLmFkZChma3Nbal0pOwogICAg\nICAgICAgICAgICAgU3RyaW5nW10gY29uc3RyYWludFNRTCA9IGdldERyb3BG\nb3JlaWduS2V5U1FMKGZrc1tqXSk7CiAgICAgICAgICAgICAgICBzcWwuYWRk\nQWxsKEFycmF5cy5hc0xpc3QoY29uc3RyYWludFNRTCkpOwogICAgICAgICAg\nICB9CiAgICAgICAgICAgIAogICAgICAgICAgICBkZWxldGVTUUwuYWRkKCJE\nRUxFVEUgRlJPTSAiICsgdGFibGVzW2ldLmdldEZ1bGxOYW1lKCkpOwogICAg\nICAgIH0KICAgICAgICAKICAgICAgICAvLyBhZGQgdGhlIGRlbGV0ZSBzdGF0\nZW1lbnRzIGFmdGVyIGFsbCB0aGUgY29uc3RyYWludCBtdXRhdGlvbnMKICAg\nICAgICBzcWwuYWRkQWxsKGRlbGV0ZVNRTCk7CiAgICAgICAgCiAgICAgICAg\nLy8gYWRkIHRoZSBkZWxldGVkIGNvbnN0cmFpbnRzIGJhY2sgdG8gdGhlIHNj\naGVtYQogICAgICAgIGZvciAoSXRlcmF0b3IgaXRlciA9IHJlc3RyaWN0Q29u\nc3RyYWludHMuaXRlcmF0b3IoKTsgaXRlci5oYXNOZXh0KCk7ICkgewogICAg\nICAgICAgICBTdHJpbmdbXSBjb25zdHJhaW50U1FMID0gCiAgICAgICAgICAg\nICAgICBnZXRBZGRGb3JlaWduS2V5U1FMKChGb3JlaWduS2V5KSBpdGVyLm5l\neHQoKSk7CiAgICAgICAgICAgIHNxbC5hZGRBbGwoQXJyYXlzLmFzTGlzdChj\nb25zdHJhaW50U1FMKSk7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIHJl\ndHVybiAoU3RyaW5nW10pIHNxbC50b0FycmF5KG5ldyBTdHJpbmdbc3FsLnNp\nemUoKV0pOwogICAgfQoKICAgIC8qKgogICAgICogQ3JlYXRlIGEgU0VMRUNU\nIHN0YXRlbWVudCBpbiB0aGUgcHJvcGVyIGpvaW4gc3ludGF4IGZvciB0aGUg\nZ2l2ZW4KICAgICAqIGluc3RhbmNlLgogICAgICovCiAgICBwdWJsaWMgU1FM\nQnVmZmVyIHRvU2VsZWN0KFNlbGVjdCBzZWwsIGJvb2xlYW4gZm9yVXBkYXRl\nLAogICAgICAgIEpEQkNGZXRjaENvbmZpZ3VyYXRpb24gZmV0Y2gpIHsKICAg\nICAgICBzZWwuYWRkSm9pbkNsYXNzQ29uZGl0aW9ucygpOwogICAgICAgIGJv\nb2xlYW4gdXBkYXRlID0gZm9yVXBkYXRlICYmIHNlbC5nZXRGcm9tU2VsZWN0\nKCkgPT0gbnVsbDsKICAgICAgICBTUUxCdWZmZXIgc2VsZWN0ID0gZ2V0U2Vs\nZWN0cyhzZWwsIGZhbHNlLCB1cGRhdGUpOwogICAgICAgIFNRTEJ1ZmZlciBv\ncmRlcmluZyA9IG51bGw7CiAgICAgICAgaWYgKCFzZWwuaXNBZ2dyZWdhdGUo\nKSB8fCBzZWwuZ2V0R3JvdXBpbmcoKSAhPSBudWxsKQogICAgICAgICAgICBv\ncmRlcmluZyA9IHNlbC5nZXRPcmRlcmluZygpOwogICAgICAgIFNRTEJ1ZmZl\nciBmcm9tOwogICAgICAgIGlmIChzZWwuZ2V0RnJvbVNlbGVjdCgpICE9IG51\nbGwpCiAgICAgICAgICAgIGZyb20gPSBnZXRGcm9tU2VsZWN0KHNlbCwgZm9y\nVXBkYXRlKTsKICAgICAgICBlbHNlCiAgICAgICAgICAgIGZyb20gPSBnZXRG\ncm9tKHNlbCwgdXBkYXRlKTsKICAgICAgICBTUUxCdWZmZXIgd2hlcmUgPSBn\nZXRXaGVyZShzZWwsIHVwZGF0ZSk7CiAgICAgICAgcmV0dXJuIHRvU2VsZWN0\nKHNlbGVjdCwgZmV0Y2gsIGZyb20sIHdoZXJlLCBzZWwuZ2V0R3JvdXBpbmco\nKSwKICAgICAgICAgICAgc2VsLmdldEhhdmluZygpLCBvcmRlcmluZywgc2Vs\nLmlzRGlzdGluY3QoKSwgZm9yVXBkYXRlLAogICAgICAgICAgICBzZWwuZ2V0\nU3RhcnRJbmRleCgpLCBzZWwuZ2V0RW5kSW5kZXgoKSwgc2VsKTsKICAgIH0K\nCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgcG9ydGlvbiBvZiB0aGUgc2Vs\nZWN0IHN0YXRlbWVudCBiZXR3ZWVuIHRoZSBGUk9NIGtleXdvcmQKICAgICAq\nIGFuZCB0aGUgV0hFUkUga2V5d29yZC4KICAgICAqLwogICAgcHJvdGVjdGVk\nIFNRTEJ1ZmZlciBnZXRGcm9tKFNlbGVjdCBzZWwsIGJvb2xlYW4gZm9yVXBk\nYXRlKSB7CiAgICAgICAgU1FMQnVmZmVyIGZyb21TUUwgPSBuZXcgU1FMQnVm\nZmVyKHRoaXMpOwogICAgICAgIENvbGxlY3Rpb24gYWxpYXNlcyA9IHNlbC5n\nZXRUYWJsZUFsaWFzZXMoKTsKICAgICAgICBpZiAoYWxpYXNlcy5zaXplKCkg\nPCAyIHx8IHNlbC5nZXRKb2luU3ludGF4KCkgIT0gU1lOVEFYX1NRTDkyKSB7\nCiAgICAgICAgICAgIGZvciAoSXRlcmF0b3IgaXRyID0gYWxpYXNlcy5pdGVy\nYXRvcigpOyBpdHIuaGFzTmV4dCgpOykgewogICAgICAgICAgICAgICAgZnJv\nbVNRTC5hcHBlbmQoaXRyLm5leHQoKS50b1N0cmluZygpKTsKICAgICAgICAg\nICAgICAgIGlmIChmb3JVcGRhdGUgJiYgdGFibGVGb3JVcGRhdGVDbGF1c2Ug\nIT0gbnVsbCkKICAgICAgICAgICAgICAgICAgICBmcm9tU1FMLmFwcGVuZCgi\nICIpLmFwcGVuZCh0YWJsZUZvclVwZGF0ZUNsYXVzZSk7CiAgICAgICAgICAg\nICAgICBpZiAoaXRyLmhhc05leHQoKSkKICAgICAgICAgICAgICAgICAgICBm\ncm9tU1FMLmFwcGVuZCgiLCAiKTsKICAgICAgICAgICAgfQogICAgICAgIH0g\nZWxzZSB7CiAgICAgICAgICAgIEl0ZXJhdG9yIGl0ciA9IHNlbC5nZXRKb2lu\nSXRlcmF0b3IoKTsKICAgICAgICAgICAgYm9vbGVhbiBmaXJzdCA9IHRydWU7\nCiAgICAgICAgICAgIHdoaWxlIChpdHIuaGFzTmV4dCgpKSB7CiAgICAgICAg\nICAgICAgICBmcm9tU1FMLmFwcGVuZCh0b1NRTDkySm9pbigoSm9pbikgaXRy\nLm5leHQoKSwgZm9yVXBkYXRlLAogICAgICAgICAgICAgICAgICAgIGZpcnN0\nKSk7CiAgICAgICAgICAgICAgICBmaXJzdCA9IGZhbHNlOwogICAgICAgICAg\nICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiBmcm9tU1FMOwogICAgfQoK\nICAgIC8qKgogICAgICogUmV0dXJuIHRoZSBGUk9NIGNsYXVzZSBmb3IgYSBz\nZWxlY3QgdGhhdCBzZWxlY3RzIGZyb20gYSB0bXAgdGFibGUKICAgICAqIGNy\nZWF0ZWQgYnkgYW4gaW5uZXIgc2VsZWN0LgogICAgICovCiAgICBwcm90ZWN0\nZWQgU1FMQnVmZmVyIGdldEZyb21TZWxlY3QoU2VsZWN0IHNlbCwgYm9vbGVh\nbiBmb3JVcGRhdGUpIHsKICAgICAgICBTUUxCdWZmZXIgZnJvbVNRTCA9IG5l\ndyBTUUxCdWZmZXIodGhpcyk7CiAgICAgICAgZnJvbVNRTC5hcHBlbmQoIigi\nKTsKICAgICAgICBmcm9tU1FMLmFwcGVuZCh0b1NlbGVjdChzZWwuZ2V0RnJv\nbVNlbGVjdCgpLCBmb3JVcGRhdGUsIG51bGwpKTsKICAgICAgICBmcm9tU1FM\nLmFwcGVuZCgiKSIpOwogICAgICAgIGlmIChyZXF1aXJlc0FsaWFzRm9yU3Vi\nc2VsZWN0KQogICAgICAgICAgICBmcm9tU1FMLmFwcGVuZCgiICIpLmFwcGVu\nZChTZWxlY3QuRlJPTV9TRUxFQ1RfQUxJQVMpOwogICAgICAgIHJldHVybiBm\ncm9tU1FMOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRoZSBXSEVS\nRSBwb3J0aW9uIG9mIHRoZSBzZWxlY3Qgc3RhdGVtZW50LCBvciBudWxsIGlm\nIG5vIHdoZXJlCiAgICAgKiBjb25kaXRpb25zLgogICAgICovCiAgICBwcm90\nZWN0ZWQgU1FMQnVmZmVyIGdldFdoZXJlKFNlbGVjdCBzZWwsIGJvb2xlYW4g\nZm9yVXBkYXRlKSB7CiAgICAgICAgSm9pbnMgam9pbnMgPSBzZWwuZ2V0Sm9p\nbnMoKTsKICAgICAgICBpZiAoc2VsLmdldEpvaW5TeW50YXgoKSA9PSBTWU5U\nQVhfU1FMOTIKICAgICAgICAgICAgfHwgam9pbnMgPT0gbnVsbCB8fCBqb2lu\ncy5pc0VtcHR5KCkpCiAgICAgICAgICAgIHJldHVybiBzZWwuZ2V0V2hlcmUo\nKTsKCiAgICAgICAgU1FMQnVmZmVyIHdoZXJlID0gbmV3IFNRTEJ1ZmZlcih0\naGlzKTsKICAgICAgICBpZiAoc2VsLmdldFdoZXJlKCkgIT0gbnVsbCkKICAg\nICAgICAgICAgd2hlcmUuYXBwZW5kKHNlbC5nZXRXaGVyZSgpKTsKICAgICAg\nICBpZiAoam9pbnMgIT0gbnVsbCkKICAgICAgICAgICAgc2VsLmFwcGVuZCh3\naGVyZSwgam9pbnMpOwogICAgICAgIHJldHVybiB3aGVyZTsKICAgIH0KCiAg\nICAvKioKICAgICAqIFVzZSB0aGUgZ2l2ZW4gam9pbiBpbnN0YW5jZSB0byBj\ncmVhdGUgU1FMIGpvaW5pbmcgaXRzIHRhYmxlcyBpbgogICAgICogdGhlIHRy\nYWRpdGlvbmFsIHN0eWxlLgogICAgICovCiAgICBwdWJsaWMgU1FMQnVmZmVy\nIHRvVHJhZGl0aW9uYWxKb2luKEpvaW4gam9pbikgewogICAgICAgIEZvcmVp\nZ25LZXkgZmsgPSBqb2luLmdldEZvcmVpZ25LZXkoKTsKICAgICAgICBpZiAo\nZmsgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIG51bGw7CgogICAgICAg\nIGJvb2xlYW4gaW52ZXJzZSA9IGpvaW4uaXNGb3JlaWduS2V5SW52ZXJzZWQo\nKTsKICAgICAgICBDb2x1bW5bXSBmcm9tID0gKGludmVyc2UpID8gZmsuZ2V0\nUHJpbWFyeUtleUNvbHVtbnMoKQogICAgICAgICAgICA6IGZrLmdldENvbHVt\nbnMoKTsKICAgICAgICBDb2x1bW5bXSB0byA9IChpbnZlcnNlKSA/IGZrLmdl\ndENvbHVtbnMoKQogICAgICAgICAgICA6IGZrLmdldFByaW1hcnlLZXlDb2x1\nbW5zKCk7CgogICAgICAgIC8vIGRvIGNvbHVtbiBqb2lucwogICAgICAgIFNR\nTEJ1ZmZlciBidWYgPSBuZXcgU1FMQnVmZmVyKHRoaXMpOwogICAgICAgIGlu\ndCBjb3VudCA9IDA7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBmcm9t\nLmxlbmd0aDsgaSsrLCBjb3VudCsrKSB7CiAgICAgICAgICAgIGlmIChjb3Vu\ndCA+IDApCiAgICAgICAgICAgICAgICBidWYuYXBwZW5kKCIgQU5EICIpOwog\nICAgICAgICAgICBidWYuYXBwZW5kKGpvaW4uZ2V0QWxpYXMxKCkpLmFwcGVu\nZCgiLiIpLmFwcGVuZChmcm9tW2ldKTsKICAgICAgICAgICAgYnVmLmFwcGVu\nZCgiID0gIik7CiAgICAgICAgICAgIGJ1Zi5hcHBlbmQoam9pbi5nZXRBbGlh\nczIoKSkuYXBwZW5kKCIuIikuYXBwZW5kKHRvW2ldKTsKICAgICAgICB9Cgog\nICAgICAgIC8vIGRvIGNvbnN0YW50IGpvaW5zCiAgICAgICAgQ29sdW1uW10g\nY29uc3RDb2xzID0gZmsuZ2V0Q29uc3RhbnRDb2x1bW5zKCk7CiAgICAgICAg\nZm9yIChpbnQgaSA9IDA7IGkgPCBjb25zdENvbHMubGVuZ3RoOyBpKyssIGNv\ndW50KyspIHsKICAgICAgICAgICAgaWYgKGNvdW50ID4gMCkKICAgICAgICAg\nICAgICAgIGJ1Zi5hcHBlbmQoIiBBTkQgIik7CiAgICAgICAgICAgIGlmIChp\nbnZlcnNlKQogICAgICAgICAgICAgICAgYnVmLmFwcGVuZFZhbHVlKGZrLmdl\ndENvbnN0YW50KGNvbnN0Q29sc1tpXSksIGNvbnN0Q29sc1tpXSk7CiAgICAg\nICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIGJ1Zi5hcHBlbmQoam9pbi5n\nZXRBbGlhczEoKSkuYXBwZW5kKCIuIikuCiAgICAgICAgICAgICAgICAgICAg\nYXBwZW5kKGNvbnN0Q29sc1tpXSk7CiAgICAgICAgICAgIGJ1Zi5hcHBlbmQo\nIiA9ICIpOwoKICAgICAgICAgICAgaWYgKGludmVyc2UpCiAgICAgICAgICAg\nICAgICBidWYuYXBwZW5kKGpvaW4uZ2V0QWxpYXMyKCkpLmFwcGVuZCgiLiIp\nLgogICAgICAgICAgICAgICAgICAgIGFwcGVuZChjb25zdENvbHNbaV0pOwog\nICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICBidWYuYXBwZW5kVmFs\ndWUoZmsuZ2V0Q29uc3RhbnQoY29uc3RDb2xzW2ldKSwgY29uc3RDb2xzW2ld\nKTsKICAgICAgICB9CgogICAgICAgIENvbHVtbltdIGNvbnN0Q29sc1BLID0g\nZmsuZ2V0Q29uc3RhbnRQcmltYXJ5S2V5Q29sdW1ucygpOwogICAgICAgIGZv\nciAoaW50IGkgPSAwOyBpIDwgY29uc3RDb2xzUEsubGVuZ3RoOyBpKyssIGNv\ndW50KyspIHsKICAgICAgICAgICAgaWYgKGNvdW50ID4gMCkKICAgICAgICAg\nICAgICAgIGJ1Zi5hcHBlbmQoIiBBTkQgIik7CiAgICAgICAgICAgIGlmIChp\nbnZlcnNlKQogICAgICAgICAgICAgICAgYnVmLmFwcGVuZChqb2luLmdldEFs\naWFzMSgpKS5hcHBlbmQoIi4iKS4KICAgICAgICAgICAgICAgICAgICBhcHBl\nbmQoY29uc3RDb2xzUEtbaV0pOwogICAgICAgICAgICBlbHNlCiAgICAgICAg\nICAgICAgICBidWYuYXBwZW5kVmFsdWUoZmsuZ2V0UHJpbWFyeUtleUNvbnN0\nYW50KGNvbnN0Q29sc1BLW2ldKSwKICAgICAgICAgICAgICAgICAgICBjb25z\ndENvbHNQS1tpXSk7CiAgICAgICAgICAgIGJ1Zi5hcHBlbmQoIiA9ICIpOwoK\nICAgICAgICAgICAgaWYgKGludmVyc2UpCiAgICAgICAgICAgICAgICBidWYu\nYXBwZW5kVmFsdWUoZmsuZ2V0UHJpbWFyeUtleUNvbnN0YW50KGNvbnN0Q29s\nc1BLW2ldKSwKICAgICAgICAgICAgICAgICAgICBjb25zdENvbHNQS1tpXSk7\nCiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIGJ1Zi5hcHBlbmQo\nam9pbi5nZXRBbGlhczIoKSkuYXBwZW5kKCIuIikuCiAgICAgICAgICAgICAg\nICAgICAgYXBwZW5kKGNvbnN0Q29sc1BLW2ldKTsKICAgICAgICB9CiAgICAg\nICAgcmV0dXJuIGJ1ZjsKICAgIH0KCiAgICAvKioKICAgICAqIFVzZSB0aGUg\nZ2l2ZW4gam9pbiBpbnN0YW5jZSB0byBjcmVhdGUgU1FMIGpvaW5pbmcgaXRz\nIHRhYmxlcyBpbgogICAgICogdGhlIFNRTDkyIHN0eWxlLgogICAgICovCiAg\nICBwdWJsaWMgU1FMQnVmZmVyIHRvU1FMOTJKb2luKEpvaW4gam9pbiwgYm9v\nbGVhbiBmb3JVcGRhdGUsIGJvb2xlYW4gZmlyc3QpIHsKICAgICAgICBTUUxC\ndWZmZXIgYnVmID0gbmV3IFNRTEJ1ZmZlcih0aGlzKTsKICAgICAgICBpZiAo\nZmlyc3QpIHsKICAgICAgICAgICAgYnVmLmFwcGVuZChqb2luLmdldFRhYmxl\nMSgpKS5hcHBlbmQoIiAiKS4KICAgICAgICAgICAgICAgIGFwcGVuZChqb2lu\nLmdldEFsaWFzMSgpKTsKICAgICAgICAgICAgaWYgKGZvclVwZGF0ZSAmJiB0\nYWJsZUZvclVwZGF0ZUNsYXVzZSAhPSBudWxsKQogICAgICAgICAgICAgICAg\nYnVmLmFwcGVuZCgiICIpLmFwcGVuZCh0YWJsZUZvclVwZGF0ZUNsYXVzZSk7\nCiAgICAgICAgfQoKICAgICAgICBidWYuYXBwZW5kKCIgIik7CiAgICAgICAg\naWYgKGpvaW4uZ2V0VHlwZSgpID09IEpvaW4uVFlQRV9PVVRFUikKICAgICAg\nICAgICAgYnVmLmFwcGVuZChvdXRlckpvaW5DbGF1c2UpOwogICAgICAgIGVs\nc2UgaWYgKGpvaW4uZ2V0VHlwZSgpID09IEpvaW4uVFlQRV9JTk5FUikKICAg\nICAgICAgICAgYnVmLmFwcGVuZChpbm5lckpvaW5DbGF1c2UpOwogICAgICAg\nIGVsc2UgLy8gY3Jvc3MKICAgICAgICAgICAgYnVmLmFwcGVuZChjcm9zc0pv\naW5DbGF1c2UpOwogICAgICAgIGJ1Zi5hcHBlbmQoIiAiKTsKCiAgICAgICAg\nYnVmLmFwcGVuZChqb2luLmdldFRhYmxlMigpKS5hcHBlbmQoIiAiKS5hcHBl\nbmQoam9pbi5nZXRBbGlhczIoKSk7CiAgICAgICAgaWYgKGZvclVwZGF0ZSAm\nJiB0YWJsZUZvclVwZGF0ZUNsYXVzZSAhPSBudWxsKQogICAgICAgICAgICBi\ndWYuYXBwZW5kKCIgIikuYXBwZW5kKHRhYmxlRm9yVXBkYXRlQ2xhdXNlKTsK\nCiAgICAgICAgaWYgKGpvaW4uZ2V0Rm9yZWlnbktleSgpICE9IG51bGwpCiAg\nICAgICAgICAgIGJ1Zi5hcHBlbmQoIiBPTiAiKS5hcHBlbmQodG9UcmFkaXRp\nb25hbEpvaW4oam9pbikpOwogICAgICAgIGVsc2UgaWYgKHJlcXVpcmVzQ29u\nZGl0aW9uRm9yQ3Jvc3NKb2luICYmCiAgICAgICAgICAgIGpvaW4uZ2V0VHlw\nZSgpID09IEpvaW4uVFlQRV9DUk9TUykKICAgICAgICAgICAgYnVmLmFwcGVu\nZCgiIE9OICgxID0gMSkiKTsKCiAgICAgICAgcmV0dXJuIGJ1ZjsKICAgIH0K\nCiAgICAvKioKICAgICAqIFVzZSB0aGUgZ2l2ZW4gam9pbiBpbnN0YW5jZSB0\nbyBjcmVhdGUgU1FMIGpvaW5pbmcgaXRzIHRhYmxlcyBpbgogICAgICogdGhl\nIGRhdGFiYXNlJ3MgbmF0aXZlIHN5bnRheC4gVGhyb3dzIGFuIGV4Y2VwdGlv\nbiBieSBkZWZhdWx0LgogICAgICovCiAgICBwdWJsaWMgU1FMQnVmZmVyIHRv\nTmF0aXZlSm9pbihKb2luIGpvaW4pIHsKICAgICAgICB0aHJvdyBuZXcgVW5z\ndXBwb3J0ZWRFeGNlcHRpb24oKTsKICAgIH0KCiAgICAvKioKICAgICAqIFJl\ndHVybnMgaWYgdGhlIGdpdmVuIGZvcmVpZ24ga2V5IGNhbiBiZSBlYWdlcmx5\nIGxvYWRlZCB1c2luZyBvdGhlciBqb2lucy4KICAgICAqLwogICAgcHVibGlj\nIGJvb2xlYW4gY2FuT3V0ZXJKb2luKGludCBzeW50YXgsIEZvcmVpZ25LZXkg\nZmspIHsKICAgICAgICByZXR1cm4gc3ludGF4ICE9IFNZTlRBWF9UUkFESVRJ\nT05BTDsKICAgIH0KCiAgICAvKioKICAgICAqIENvbWJpbmUgdGhlIGdpdmVu\nIGNvbXBvbmVudHMgaW50byBhIFNFTEVDVCBzdGF0ZW1lbnQuCiAgICAgKi8K\nICAgIHB1YmxpYyBTUUxCdWZmZXIgdG9TZWxlY3QoU1FMQnVmZmVyIHNlbGVj\ndHMsIEpEQkNGZXRjaENvbmZpZ3VyYXRpb24gZmV0Y2gsCiAgICAgICAgU1FM\nQnVmZmVyIGZyb20sIFNRTEJ1ZmZlciB3aGVyZSwgU1FMQnVmZmVyIGdyb3Vw\nLAogICAgICAgIFNRTEJ1ZmZlciBoYXZpbmcsIFNRTEJ1ZmZlciBvcmRlciwK\nICAgICAgICBib29sZWFuIGRpc3RpbmN0LCBib29sZWFuIGZvclVwZGF0ZSwg\nbG9uZyBzdGFydCwgbG9uZyBlbmQpIHsKICAgICAgICByZXR1cm4gdG9PcGVy\nYXRpb24oZ2V0U2VsZWN0T3BlcmF0aW9uKGZldGNoKSwgc2VsZWN0cywgZnJv\nbSwgd2hlcmUsCiAgICAgICAgICAgIGdyb3VwLCBoYXZpbmcsIG9yZGVyLCBk\naXN0aW5jdCwgc3RhcnQsIGVuZCwKICAgICAgICAgICAgZ2V0Rm9yVXBkYXRl\nQ2xhdXNlKGZldGNoLCBmb3JVcGRhdGUsIG51bGwpKTsKICAgIH0KCiAgICAv\nKioKICAgICAqIENvbWJpbmUgdGhlIGdpdmVuIGNvbXBvbmVudHMgaW50byBh\nIFNFTEVDVCBzdGF0ZW1lbnQuCiAgICAgKi8KICAgIHB1YmxpYyBTUUxCdWZm\nZXIgdG9TZWxlY3QoU1FMQnVmZmVyIHNlbGVjdHMsIEpEQkNGZXRjaENvbmZp\nZ3VyYXRpb24gZmV0Y2gsCiAgICAgICAgU1FMQnVmZmVyIGZyb20sIFNRTEJ1\nZmZlciB3aGVyZSwgU1FMQnVmZmVyIGdyb3VwLAogICAgICAgIFNRTEJ1ZmZl\nciBoYXZpbmcsIFNRTEJ1ZmZlciBvcmRlciwKICAgICAgICBib29sZWFuIGRp\nc3RpbmN0LCBib29sZWFuIGZvclVwZGF0ZSwgbG9uZyBzdGFydCwgbG9uZyBl\nbmQsCiAgICAgICAgYm9vbGVhbiBzdWJzZWxlY3QpIHsKICAgICAgICByZXR1\ncm4gdG9PcGVyYXRpb24oZ2V0U2VsZWN0T3BlcmF0aW9uKGZldGNoKSwgc2Vs\nZWN0cywgZnJvbSwgd2hlcmUsCiAgICAgICAgICAgIGdyb3VwLCBoYXZpbmcs\nIG9yZGVyLCBkaXN0aW5jdCwgc3RhcnQsIGVuZCwKICAgICAgICAgICAgZ2V0\nRm9yVXBkYXRlQ2xhdXNlKGZldGNoLCBmb3JVcGRhdGUsIG51bGwpLCBzdWJz\nZWxlY3QpOwogICAgfQogICAgCiAgICBwdWJsaWMgU1FMQnVmZmVyIHRvU2Vs\nZWN0KFNRTEJ1ZmZlciBzZWxlY3RzLCBKREJDRmV0Y2hDb25maWd1cmF0aW9u\nIGZldGNoLAogICAgICAgICAgICBTUUxCdWZmZXIgZnJvbSwgU1FMQnVmZmVy\nIHdoZXJlLCBTUUxCdWZmZXIgZ3JvdXAsCiAgICAgICAgICAgIFNRTEJ1ZmZl\nciBoYXZpbmcsIFNRTEJ1ZmZlciBvcmRlciwKICAgICAgICAgICAgYm9vbGVh\nbiBkaXN0aW5jdCwgYm9vbGVhbiBmb3JVcGRhdGUsIGxvbmcgc3RhcnQsIGxv\nbmcgZW5kLAogICAgICAgICAgICBib29sZWFuIHN1YnNlbGVjdCwgYm9vbGVh\nbiBjaGVja1RhYmxlRm9yVXBkYXRlKSB7CiAgICAgICAgICAgIHJldHVybiB0\nb09wZXJhdGlvbihnZXRTZWxlY3RPcGVyYXRpb24oZmV0Y2gpLCBzZWxlY3Rz\nLCBmcm9tLCB3aGVyZSwKICAgICAgICAgICAgICAgIGdyb3VwLCBoYXZpbmcs\nIG9yZGVyLCBkaXN0aW5jdCwgc3RhcnQsIGVuZCwKICAgICAgICAgICAgICAg\nIGdldEZvclVwZGF0ZUNsYXVzZShmZXRjaCwgZm9yVXBkYXRlLCBudWxsKSwg\nc3Vic2VsZWN0LCBjaGVja1RhYmxlRm9yVXBkYXRlKTsKICAgICAgICB9Cgog\nICAgLyoqCiAgICAgKiBDb21iaW5lIHRoZSBnaXZlbiBjb21wb25lbnRzIGlu\ndG8gYSBTRUxFQ1Qgc3RhdGVtZW50LgogICAgICovCiAgICBwdWJsaWMgU1FM\nQnVmZmVyIHRvU2VsZWN0KFNRTEJ1ZmZlciBzZWxlY3RzLCBKREJDRmV0Y2hD\nb25maWd1cmF0aW9uIGZldGNoLAogICAgICAgIFNRTEJ1ZmZlciBmcm9tLCBT\nUUxCdWZmZXIgd2hlcmUsIFNRTEJ1ZmZlciBncm91cCwKICAgICAgICBTUUxC\ndWZmZXIgaGF2aW5nLCBTUUxCdWZmZXIgb3JkZXIsCiAgICAgICAgYm9vbGVh\nbiBkaXN0aW5jdCwgYm9vbGVhbiBmb3JVcGRhdGUsIGxvbmcgc3RhcnQsIGxv\nbmcgZW5kCiAgICAgICAgLCBTZWxlY3Qgc2VsKSB7CiAgICAgICAgcmV0dXJu\nIHRvT3BlcmF0aW9uKGdldFNlbGVjdE9wZXJhdGlvbihmZXRjaCksIHNlbGVj\ndHMsIGZyb20sIHdoZXJlLAogICAgICAgICAgICBncm91cCwgaGF2aW5nLCBv\ncmRlciwgZGlzdGluY3QsIHN0YXJ0LCBlbmQsCiAgICAgICAgICAgIGdldEZv\nclVwZGF0ZUNsYXVzZShmZXRjaCwgZm9yVXBkYXRlLCBzZWwpKTsKICAgIH0K\nCiAgICAvKioKICAgICAqIEdldCB0aGUgdXBkYXRlIGNsYXVzZSBmb3IgdGhl\nIHF1ZXJ5IGJhc2VkIG9uIHRoZQogICAgICogdXBkYXRlQ2xhdXNlIGFuZCBp\nc29sYXRpb25MZXZlbCBoaW50cwogICAgICovCiAgICBwcm90ZWN0ZWQgU3Ry\naW5nIGdldEZvclVwZGF0ZUNsYXVzZShKREJDRmV0Y2hDb25maWd1cmF0aW9u\nIGZldGNoLAogICAgICAgIGJvb2xlYW4gaXNGb3JVcGRhdGUsIFNlbGVjdCBz\nZWwpIHsKICAgICAgICBpZiAoZmV0Y2ggIT0gbnVsbCAmJiBmZXRjaC5nZXRJ\nc29sYXRpb24oKSAhPSAtMSkgewogICAgICAgICAgICB0aHJvdyBuZXcgSW52\nYWxpZFN0YXRlRXhjZXB0aW9uKF9sb2MuZ2V0KAogICAgICAgICAgICAgICAg\nImlzb2xhdGlvbi1sZXZlbC1jb25maWctbm90LXN1cHBvcnRlZCIsIGdldENs\nYXNzKCkuZ2V0TmFtZSgpKSk7CiAgICAgICAgfSBlbHNlIGlmIChpc0ZvclVw\nZGF0ZSAmJiAhc2ltdWxhdGVMb2NraW5nKSB7CiAgICAgICAgICAgIGFzc2Vy\ndFN1cHBvcnQoc3VwcG9ydHNTZWxlY3RGb3JVcGRhdGUsICJTdXBwb3J0c1Nl\nbGVjdEZvclVwZGF0ZSIpOwogICAgICAgICAgICByZXR1cm4gZm9yVXBkYXRl\nQ2xhdXNlOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJldHVybiBu\ndWxsOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0\naGUgIlNFTEVDVCIgb3BlcmF0aW9uIGNsYXVzZSwgYWRkaW5nIGFueSBhdmFp\nbGFibGUgaGludHMsIGV0Yy4KICAgICAqLwogICAgcHVibGljIFN0cmluZyBn\nZXRTZWxlY3RPcGVyYXRpb24oSkRCQ0ZldGNoQ29uZmlndXJhdGlvbiBmZXRj\naCkgewogICAgICAgIHJldHVybiAiU0VMRUNUIjsKICAgIH0KCiAgICAvKioK\nICAgICAqIFJldHVybiB0aGUgU1FMIGZvciB0aGUgZ2l2ZW4gc2VsZWN0aW5n\nIG9wZXJhdGlvbi4KICAgICAqLwogICAgcHVibGljIFNRTEJ1ZmZlciB0b09w\nZXJhdGlvbihTdHJpbmcgb3AsIFNRTEJ1ZmZlciBzZWxlY3RzLAogICAgICAg\nIFNRTEJ1ZmZlciBmcm9tLCBTUUxCdWZmZXIgd2hlcmUsIFNRTEJ1ZmZlciBn\ncm91cCwgU1FMQnVmZmVyIGhhdmluZywKICAgICAgICBTUUxCdWZmZXIgb3Jk\nZXIsIGJvb2xlYW4gZGlzdGluY3QsIGxvbmcgc3RhcnQsIGxvbmcgZW5kLAog\nICAgICAgIFN0cmluZyBmb3JVcGRhdGVDbGF1c2UpIHsKICAgICAgICByZXR1\ncm4gdG9PcGVyYXRpb24ob3AsIHNlbGVjdHMsIGZyb20sIHdoZXJlLCBncm91\ncCwgaGF2aW5nLCBvcmRlciwKICAgICAgICAgICAgZGlzdGluY3QsIHN0YXJ0\nLCBlbmQsIGZvclVwZGF0ZUNsYXVzZSwgZmFsc2UpOwogICAgfQogICAgCiAg\nICAvKioKICAgICAqIFJldHVybiB0aGUgU1FMIGZvciB0aGUgZ2l2ZW4gc2Vs\nZWN0aW5nIG9wZXJhdGlvbi4KICAgICAqLwogICAgcHVibGljIFNRTEJ1ZmZl\nciB0b09wZXJhdGlvbihTdHJpbmcgb3AsIFNRTEJ1ZmZlciBzZWxlY3RzLAog\nICAgICAgIFNRTEJ1ZmZlciBmcm9tLCBTUUxCdWZmZXIgd2hlcmUsIFNRTEJ1\nZmZlciBncm91cCwgU1FMQnVmZmVyIGhhdmluZywKICAgICAgICBTUUxCdWZm\nZXIgb3JkZXIsIGJvb2xlYW4gZGlzdGluY3QsIGxvbmcgc3RhcnQsIGxvbmcg\nZW5kLAogICAgICAgIFN0cmluZyBmb3JVcGRhdGVDbGF1c2UsIGJvb2xlYW4g\nc3Vic2VsZWN0KSB7CiAgICAgICAgcmV0dXJuIHRvT3BlcmF0aW9uKG9wLCBz\nZWxlY3RzLCBmcm9tLCB3aGVyZSwgZ3JvdXAsIGhhdmluZywgb3JkZXIsCiAg\nICAgICAgICAgICAgICBkaXN0aW5jdCwgc3RhcnQsIGVuZCwgZm9yVXBkYXRl\nQ2xhdXNlLCBzdWJzZWxlY3QsIGZhbHNlKTsKICAgIH0KCiAgICAvKioKICAg\nICAqIFJldHVybiB0aGUgU1FMIGZvciB0aGUgZ2l2ZW4gc2VsZWN0aW5nIG9w\nZXJhdGlvbi4KICAgICAqLwogICAgcHJpdmF0ZSBTUUxCdWZmZXIgdG9PcGVy\nYXRpb24oU3RyaW5nIG9wLCBTUUxCdWZmZXIgc2VsZWN0cywKICAgICAgICBT\nUUxCdWZmZXIgZnJvbSwgU1FMQnVmZmVyIHdoZXJlLCBTUUxCdWZmZXIgZ3Jv\ndXAsIFNRTEJ1ZmZlciBoYXZpbmcsCiAgICAgICAgU1FMQnVmZmVyIG9yZGVy\nLCBib29sZWFuIGRpc3RpbmN0LCBsb25nIHN0YXJ0LCBsb25nIGVuZCwKICAg\nICAgICBTdHJpbmcgZm9yVXBkYXRlQ2xhdXNlLCBib29sZWFuIHN1YnNlbGVj\ndCwgYm9vbGVhbiBjaGVja1RhYmxlRm9yVXBkYXRlKSB7CiAgICAgICAgU1FM\nQnVmZmVyIGJ1ZiA9IG5ldyBTUUxCdWZmZXIodGhpcyk7CiAgICAgICAgYnVm\nLmFwcGVuZChvcCk7CgogICAgICAgIGJvb2xlYW4gcmFuZ2UgPSBzdGFydCAh\nPSAwIHx8IGVuZCAhPSBMb25nLk1BWF9WQUxVRTsKICAgICAgICBpZiAocmFu\nZ2UgJiYgcmFuZ2VQb3NpdGlvbiA9PSBSQU5HRV9QUkVfRElTVElOQ1QpCiAg\nICAgICAgICAgIGFwcGVuZFNlbGVjdFJhbmdlKGJ1Ziwgc3RhcnQsIGVuZCwg\nc3Vic2VsZWN0KTsKICAgICAgICBpZiAoZGlzdGluY3QpCiAgICAgICAgICAg\nIGJ1Zi5hcHBlbmQoIiBESVNUSU5DVCIpOwogICAgICAgIGlmIChyYW5nZSAm\nJiByYW5nZVBvc2l0aW9uID09IFJBTkdFX1BPU1RfRElTVElOQ1QpCiAgICAg\nICAgICAgIGFwcGVuZFNlbGVjdFJhbmdlKGJ1Ziwgc3RhcnQsIGVuZCwgc3Vi\nc2VsZWN0KTsKCiAgICAgICAgYnVmLmFwcGVuZCgiICIpLmFwcGVuZChzZWxl\nY3RzKS5hcHBlbmQoIiBGUk9NICIpLmFwcGVuZChmcm9tKTsKCiAgICAgICAg\naWYgKGNoZWNrVGFibGVGb3JVcGRhdGUKICAgICAgICAgICAgICAgICYmIChT\ndHJpbmdVdGlscy5pc0VtcHR5KGZvclVwZGF0ZUNsYXVzZSkgJiYgIVN0cmlu\nZ1V0aWxzCiAgICAgICAgICAgICAgICAgICAgICAgIC5pc0VtcHR5KHRhYmxl\nRm9yVXBkYXRlQ2xhdXNlKSkpIHsKICAgICAgICAgICAgYnVmLmFwcGVuZCgi\nICIpLmFwcGVuZCh0YWJsZUZvclVwZGF0ZUNsYXVzZSk7CiAgICAgICAgfQoK\nICAgICAgICBpZiAod2hlcmUgIT0gbnVsbCAmJiAhd2hlcmUuaXNFbXB0eSgp\nKQogICAgICAgICAgICBidWYuYXBwZW5kKCIgV0hFUkUgIikuYXBwZW5kKHdo\nZXJlKTsKICAgICAgICBpZiAoZ3JvdXAgIT0gbnVsbCAmJiAhZ3JvdXAuaXNF\nbXB0eSgpKQogICAgICAgICAgICBidWYuYXBwZW5kKCIgR1JPVVAgQlkgIiku\nYXBwZW5kKGdyb3VwKTsKICAgICAgICBpZiAoaGF2aW5nICE9IG51bGwgJiYg\nIWhhdmluZy5pc0VtcHR5KCkpIHsKICAgICAgICAgICAgYXNzZXJ0U3VwcG9y\ndChzdXBwb3J0c0hhdmluZywgIlN1cHBvcnRzSGF2aW5nIik7CiAgICAgICAg\nICAgIGJ1Zi5hcHBlbmQoIiBIQVZJTkcgIikuYXBwZW5kKGhhdmluZyk7CiAg\nICAgICAgfQogICAgICAgIGlmIChvcmRlciAhPSBudWxsICYmICFvcmRlci5p\nc0VtcHR5KCkpCiAgICAgICAgICAgIGJ1Zi5hcHBlbmQoIiBPUkRFUiBCWSAi\nKS5hcHBlbmQob3JkZXIpOwogICAgICAgIGlmIChyYW5nZSAmJiByYW5nZVBv\nc2l0aW9uID09IFJBTkdFX1BPU1RfU0VMRUNUKQogICAgICAgICAgICBhcHBl\nbmRTZWxlY3RSYW5nZShidWYsIHN0YXJ0LCBlbmQsIHN1YnNlbGVjdCk7CiAg\nICAgICAgaWYgKGZvclVwZGF0ZUNsYXVzZSAhPSBudWxsKQogICAgICAgICAg\nICBidWYuYXBwZW5kKCIgIikuYXBwZW5kKGZvclVwZGF0ZUNsYXVzZSk7CiAg\nICAgICAgaWYgKHJhbmdlICYmIHJhbmdlUG9zaXRpb24gPT0gUkFOR0VfUE9T\nVF9MT0NLKQogICAgICAgICAgICBhcHBlbmRTZWxlY3RSYW5nZShidWYsIHN0\nYXJ0LCBlbmQsIHN1YnNlbGVjdCk7CiAgICAgICAgcmV0dXJuIGJ1ZjsKICAg\nIH0KCiAgICAvKioKICAgICAqIElmIHRoaXMgZGljdGlvbmFyeSBjYW4gc2Vs\nZWN0IHJhbmdlcywKICAgICAqIHVzZSB0aGlzIG1ldGhvZCB0byBhcHBlbmQg\ndGhlIHJhbmdlIFNRTC4KICAgICAqLwogICAgcHJvdGVjdGVkIHZvaWQgYXBw\nZW5kU2VsZWN0UmFuZ2UoU1FMQnVmZmVyIGJ1ZiwgbG9uZyBzdGFydCwgbG9u\nZyBlbmQKICAgICAgICAsIGJvb2xlYW4gc3Vic2VsZWN0KSB7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIHBvcnRpb24gb2YgdGhlIHNlbGVj\ndCBzdGF0ZW1lbnQgYmV0d2VlbiB0aGUgU0VMRUNUIGtleXdvcmQKICAgICAq\nIGFuZCB0aGUgRlJPTSBrZXl3b3JkLgogICAgICovCiAgICBwcm90ZWN0ZWQg\nU1FMQnVmZmVyIGdldFNlbGVjdHMoU2VsZWN0IHNlbCwgYm9vbGVhbiBkaXN0\naW5jdElkZW50aWZpZXJzLAogICAgICAgIGJvb2xlYW4gZm9yVXBkYXRlKSB7\nCiAgICAgICAgLy8gYXBwZW5kIHRoZSBhbGlhc2VzIGZvciBhbGwgdGhlIGNv\nbHVtbnMKICAgICAgICBTUUxCdWZmZXIgc2VsZWN0U1FMID0gbmV3IFNRTEJ1\nZmZlcih0aGlzKTsKICAgICAgICBMaXN0IGFsaWFzZXM7CiAgICAgICAgaWYg\nKGRpc3RpbmN0SWRlbnRpZmllcnMpCiAgICAgICAgICAgIGFsaWFzZXMgPSBz\nZWwuZ2V0SWRlbnRpZmllckFsaWFzZXMoKTsKICAgICAgICBlbHNlCiAgICAg\nICAgICAgIGFsaWFzZXMgPSBzZWwuZ2V0U2VsZWN0QWxpYXNlcygpOwoKICAg\nICAgICBPYmplY3QgYWxpYXM7CiAgICAgICAgZm9yIChJdGVyYXRvciBpdHIg\nPSBhbGlhc2VzLml0ZXJhdG9yKCk7IGl0ci5oYXNOZXh0KCk7KSB7CiAgICAg\nICAgICAgIGFsaWFzID0gaXRyLm5leHQoKTsKICAgICAgICAgICAgaWYgKGFs\naWFzIGluc3RhbmNlb2YgU1FMQnVmZmVyKQogICAgICAgICAgICAgICAgc2Vs\nZWN0U1FMLmFwcGVuZCgoU1FMQnVmZmVyKSBhbGlhcyk7CiAgICAgICAgICAg\nIGVsc2UKICAgICAgICAgICAgICAgIHNlbGVjdFNRTC5hcHBlbmQoYWxpYXMu\ndG9TdHJpbmcoKSk7CiAgICAgICAgICAgIGlmIChpdHIuaGFzTmV4dCgpKQog\nICAgICAgICAgICAgICAgc2VsZWN0U1FMLmFwcGVuZCgiLCAiKTsKICAgICAg\nICB9CiAgICAgICAgcmV0dXJuIHNlbGVjdFNRTDsKICAgIH0KCiAgICAvKioK\nICAgICAqIFJldHVybnMgdHJ1ZSBpZiBhICJGT1IgVVBEQVRFIiBjbGF1c2Ug\nY2FuIGJlIHVzZWQgZm9yIHRoZSBzcGVjaWZpZWQKICAgICAqIFNlbGVjdCBv\nYmplY3QuCiAgICAgKi8KICAgIHB1YmxpYyBib29sZWFuIHN1cHBvcnRzTG9j\na2luZyhTZWxlY3Qgc2VsKSB7CiAgICAgICAgaWYgKHNlbC5pc0FnZ3JlZ2F0\nZSgpKQogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgaWYgKCFz\ndXBwb3J0c1NlbGVjdEZvclVwZGF0ZSkKICAgICAgICAgICAgcmV0dXJuIGZh\nbHNlOwogICAgICAgIGlmICghc3VwcG9ydHNMb2NraW5nV2l0aFNlbGVjdFJh\nbmdlICYmIChzZWwuZ2V0U3RhcnRJbmRleCgpICE9IDAKICAgICAgICAgICAg\nfHwgc2VsLmdldEVuZEluZGV4KCkgIT0gTG9uZy5NQVhfVkFMVUUpKQogICAg\nICAgICAgICByZXR1cm4gZmFsc2U7CgogICAgICAgIC8vIG9ubHkgaW5uZXIg\nc2VsZWN0IGlzIGxvY2tlZAogICAgICAgIGlmIChzZWwuZ2V0RnJvbVNlbGVj\ndCgpICE9IG51bGwpCiAgICAgICAgICAgIHNlbCA9IHNlbC5nZXRGcm9tU2Vs\nZWN0KCk7CgogICAgICAgIGlmICghc3VwcG9ydHNMb2NraW5nV2l0aERpc3Rp\nbmN0Q2xhdXNlICYmIHNlbC5pc0Rpc3RpbmN0KCkpCiAgICAgICAgICAgIHJl\ndHVybiBmYWxzZTsKICAgICAgICBpZiAoIXN1cHBvcnRzTG9ja2luZ1dpdGhN\ndWx0aXBsZVRhYmxlcwogICAgICAgICAgICAmJiBzZWwuZ2V0VGFibGVBbGlh\nc2VzKCkuc2l6ZSgpID4gMSkKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwog\nICAgICAgIGlmICghc3VwcG9ydHNMb2NraW5nV2l0aE9yZGVyQ2xhdXNlICYm\nIHNlbC5nZXRPcmRlcmluZygpICE9IG51bGwpCiAgICAgICAgICAgIHJldHVy\nbiBmYWxzZTsKICAgICAgICBpZiAoIXN1cHBvcnRzTG9ja2luZ1dpdGhPdXRl\nckpvaW4gfHwgIXN1cHBvcnRzTG9ja2luZ1dpdGhJbm5lckpvaW4pIHsKICAg\nICAgICAgICAgZm9yIChJdGVyYXRvciBpdHIgPSBzZWwuZ2V0Sm9pbkl0ZXJh\ndG9yKCk7IGl0ci5oYXNOZXh0KCk7KSB7CiAgICAgICAgICAgICAgICBKb2lu\nIGpvaW4gPSAoSm9pbikgaXRyLm5leHQoKTsKICAgICAgICAgICAgICAgIGlm\nICghc3VwcG9ydHNMb2NraW5nV2l0aE91dGVySm9pbgogICAgICAgICAgICAg\nICAgICAgICYmIGpvaW4uZ2V0VHlwZSgpID09IEpvaW4uVFlQRV9PVVRFUikK\nICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICAg\nICAgICBpZiAoIXN1cHBvcnRzTG9ja2luZ1dpdGhJbm5lckpvaW4KICAgICAg\nICAgICAgICAgICAgICAmJiBqb2luLmdldFR5cGUoKSA9PSBKb2luLlRZUEVf\nSU5ORVIpCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAg\nICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiB0cnVlOwogICAg\nfQoKICAgIC8qKgogICAgICogUmV0dXJuIGZhbHNlIGlmIHRoZSBnaXZlbiBz\nZWxlY3QgcmVxdWlyZXMgYSBmb3J3YXJkLW9ubHkgcmVzdWx0IHNldC4KICAg\nICAqLwogICAgcHVibGljIGJvb2xlYW4gc3VwcG9ydHNSYW5kb21BY2Nlc3NS\nZXN1bHRTZXQoU2VsZWN0IHNlbCwKICAgICAgICBib29sZWFuIGZvclVwZGF0\nZSkgewogICAgICAgIHJldHVybiAhc2VsLmlzQWdncmVnYXRlKCk7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBBc3NlcnQgdGhhdCB0aGUgZ2l2ZW4gZGljdGlv\nbmFyeSBmbGFnIGlzIHRydWUuIElmIGl0IGlzIG5vdCB0cnVlLAogICAgICog\ndGhyb3cgYW4gZXJyb3Igc2F5aW5nIHRoYXQgdGhlIGdpdmVuIHNldHRpbmcg\nbmVlZHMgdG8gcmV0dXJuIHRydWUgZm9yCiAgICAgKiB0aGUgY3VycmVudCBv\ncGVyYXRpb24gdG8gd29yay4KICAgICAqLwogICAgcHVibGljIHZvaWQgYXNz\nZXJ0U3VwcG9ydChib29sZWFuIGZlYXR1cmUsIFN0cmluZyBwcm9wZXJ0eSkg\newogICAgICAgIGlmICghZmVhdHVyZSkKICAgICAgICAgICAgdGhyb3cgbmV3\nIFVuc3VwcG9ydGVkRXhjZXB0aW9uKF9sb2MuZ2V0KCJmZWF0dXJlLW5vdC1z\ndXBwb3J0ZWQiLAogICAgICAgICAgICAgICAgZ2V0Q2xhc3MoKSwgcHJvcGVy\ndHkpKTsKICAgIH0KCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLwogICAgLy8g\nUXVlcnkgZnVuY3Rpb25zCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLwoKICAg\nIC8qKgogICAgICogSW52b2tlIHRoaXMgZGF0YWJhc2UncyBzdWJzdHJpbmcg\nZnVuY3Rpb24uCiAgICAgKgogICAgICogQHBhcmFtIGJ1ZiB0aGUgU1FMIGJ1\nZmZlciB0byB3cml0ZSB0aGUgc3Vic3RyaW5nIGludm9jYXRpb24gdG8KICAg\nICAqIEBwYXJhbSBzdHIgYSBxdWVyeSB2YWx1ZSByZXByZXNlbnRpbmcgdGhl\nIHRhcmdldCBzdHJpbmcKICAgICAqIEBwYXJhbSBzdGFydCBhIHF1ZXJ5IHZh\nbHVlIHJlcHJlc2VudGluZyB0aGUgc3RhcnQgaW5kZXgKICAgICAqIEBwYXJh\nbSBlbmQgYSBxdWVyeSB2YWx1ZSByZXByZXNlbnRpbmcgdGhlIGVuZCBpbmRl\neCwgb3IgbnVsbCBmb3Igbm9uZQogICAgICovCiAgICBwdWJsaWMgdm9pZCBz\ndWJzdHJpbmcoU1FMQnVmZmVyIGJ1ZiwgRmlsdGVyVmFsdWUgc3RyLCBGaWx0\nZXJWYWx1ZSBzdGFydCwKICAgICAgICBGaWx0ZXJWYWx1ZSBlbmQpIHsKICAg\nICAgICBidWYuYXBwZW5kKHN1YnN0cmluZ0Z1bmN0aW9uTmFtZSkuYXBwZW5k\nKCIoKCIpOwogICAgICAgIHN0ci5hcHBlbmRUbyhidWYpOwogICAgICAgIGJ1\nZi5hcHBlbmQoIiksICgiKTsKICAgICAgICBzdGFydC5hcHBlbmRUbyhidWYp\nOwogICAgICAgIGJ1Zi5hcHBlbmQoIiArIDEpIik7CiAgICAgICAgaWYgKGVu\nZCAhPSBudWxsKSB7CiAgICAgICAgICAgIGJ1Zi5hcHBlbmQoIiwgKCIpOwog\nICAgICAgICAgICBlbmQuYXBwZW5kVG8oYnVmKTsKICAgICAgICAgICAgYnVm\nLmFwcGVuZCgiIC0gKCIpOwogICAgICAgICAgICBzdGFydC5hcHBlbmRUbyhi\ndWYpOwogICAgICAgICAgICBidWYuYXBwZW5kKCIpKSIpOwogICAgICAgIH0K\nICAgICAgICBidWYuYXBwZW5kKCIpIik7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBJbnZva2UgdGhpcyBkYXRhYmFzZSdzIGluZGV4T2YgZnVuY3Rpb24uCiAg\nICAgKgogICAgICogQHBhcmFtIGJ1ZiB0aGUgU1FMIGJ1ZmZlciB0byB3cml0\nZSB0aGUgaW5kZXhPZiBpbnZvY2F0aW9uIHRvCiAgICAgKiBAcGFyYW0gc3Ry\nIGEgcXVlcnkgdmFsdWUgcmVwcmVzZW50aW5nIHRoZSB0YXJnZXQgc3RyaW5n\nCiAgICAgKiBAcGFyYW0gZmluZCBhIHF1ZXJ5IHZhbHVlIHJlcHJlc2VudGlu\nZyB0aGUgc2VhcmNoIHN0cmluZwogICAgICogQHBhcmFtIHN0YXJ0IGEgcXVl\ncnkgdmFsdWUgcmVwcmVzZW50aW5nIHRoZSBzdGFydCBpbmRleCwgb3IgbnVs\nbAogICAgICogdG8gc3RhcnQgYXQgdGhlIGJlZ2lubmluZwogICAgICovCiAg\nICBwdWJsaWMgdm9pZCBpbmRleE9mKFNRTEJ1ZmZlciBidWYsIEZpbHRlclZh\nbHVlIHN0ciwgRmlsdGVyVmFsdWUgZmluZCwKICAgICAgICBGaWx0ZXJWYWx1\nZSBzdGFydCkgewogICAgICAgIGJ1Zi5hcHBlbmQoIihJTlNUUigoIik7CiAg\nICAgICAgaWYgKHN0YXJ0ICE9IG51bGwpCiAgICAgICAgICAgIHN1YnN0cmlu\nZyhidWYsIHN0ciwgc3RhcnQsIG51bGwpOwogICAgICAgIGVsc2UKICAgICAg\nICAgICAgc3RyLmFwcGVuZFRvKGJ1Zik7CiAgICAgICAgYnVmLmFwcGVuZCgi\nKSwgKCIpOwogICAgICAgIGZpbmQuYXBwZW5kVG8oYnVmKTsKICAgICAgICBi\ndWYuYXBwZW5kKCIpKSAtIDEiKTsKICAgICAgICBpZiAoc3RhcnQgIT0gbnVs\nbCkgewogICAgICAgICAgICBidWYuYXBwZW5kKCIgKyAiKTsKICAgICAgICAg\nICAgc3RhcnQuYXBwZW5kVG8oYnVmKTsKICAgICAgICB9CiAgICAgICAgYnVm\nLmFwcGVuZCgiKSIpOwogICAgfQoKICAgIC8qKgogICAgICogQXBwZW5kIHRo\nZSBudW1lcmljIHBhcnRzIG9mIGEgbWF0aGVtYXRpY2FsIGZ1bmN0aW9uLgog\nICAgICoKICAgICAqIEBwYXJhbSBidWYgdGhlIFNRTCBidWZmZXIgdG8gd3Jp\ndGUgdGhlIG1hdGggZnVuY3Rpb24KICAgICAqIEBwYXJhbSBvcCB0aGUgbWF0\naGVtYXRpY2FsIG9wZXJhdGlvbiB0byBwZXJmb3JtCiAgICAgKiBAcGFyYW0g\nbGhzIHRoZSBsZWZ0IGhhbmQgc2lkZSBvZiB0aGUgbWF0aCBmdW5jdGlvbgog\nICAgICogQHBhcmFtIHJocyB0aGUgcmlnaHQgaGFuZCBzaWRlIG9mIHRoZSBt\nYXRoIGZ1bmN0aW9uCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIG1hdGhGdW5j\ndGlvbihTUUxCdWZmZXIgYnVmLCBTdHJpbmcgb3AsIEZpbHRlclZhbHVlIGxo\ncywKICAgICAgICBGaWx0ZXJWYWx1ZSByaHMpIHsKICAgICAgICBib29sZWFu\nIGNhc3RsaHMgPSBmYWxzZTsKICAgICAgICBib29sZWFuIGNhc3RyaHMgPSBm\nYWxzZTsKICAgICAgICBDbGFzcyBsYyA9IEZpbHRlcnMud3JhcChsaHMuZ2V0\nVHlwZSgpKTsKICAgICAgICBDbGFzcyByYyA9IEZpbHRlcnMud3JhcChyaHMu\nZ2V0VHlwZSgpKTsKICAgICAgICBpbnQgdHlwZSA9IDA7CiAgICAgICAgaWYg\nKHJlcXVpcmVzQ2FzdEZvck1hdGhGdW5jdGlvbnMgJiYgKGxjICE9IHJjCiAg\nICAgICAgICAgIHx8IChsaHMuaXNDb25zdGFudCgpICYmIHJocy5pc0NvbnN0\nYW50KCkpKSkgewogICAgICAgICAgICBDbGFzcyBjID0gRmlsdGVycy5wcm9t\nb3RlKGxjLCByYyk7CiAgICAgICAgICAgIHR5cGUgPSBnZXRKREJDVHlwZShK\nYXZhVHlwZXMuZ2V0VHlwZUNvZGUoYyksIGZhbHNlKTsKICAgICAgICAgICAg\naWYgKHR5cGUgIT0gVHlwZXMuVkFSQklOQVJZICYmIHR5cGUgIT0gVHlwZXMu\nQkxPQikgewogICAgICAgICAgICAgICAgY2FzdGxocyA9IChsaHMuaXNDb25z\ndGFudCgpICYmIHJocy5pc0NvbnN0YW50KCkpIHx8IGxjICE9IGM7CiAgICAg\nICAgICAgICAgICBjYXN0cmhzID0gKGxocy5pc0NvbnN0YW50KCkgJiYgcmhz\nLmlzQ29uc3RhbnQoKSkgfHwgcmMgIT0gYzsKICAgICAgICAgICAgfQogICAg\nICAgIH0KCiAgICAgICAgYm9vbGVhbiBtb2QgPSAiTU9EIi5lcXVhbHMob3Ap\nOwogICAgICAgIGlmIChtb2QpIHsKICAgICAgICAgICAgaWYgKHN1cHBvcnRz\nTW9kT3BlcmF0b3IpCiAgICAgICAgICAgICAgICBvcCA9ICIlIjsKICAgICAg\nICAgICAgZWxzZQogICAgICAgICAgICAgICAgYnVmLmFwcGVuZChvcCk7CiAg\nICAgICAgfQogICAgICAgIGJ1Zi5hcHBlbmQoIigiKTsKCiAgICAgICAgaWYg\nKGNhc3RsaHMpCiAgICAgICAgICAgIGFwcGVuZENhc3QoYnVmLCBsaHMsIHR5\ncGUpOwogICAgICAgIGVsc2UKICAgICAgICAgICAgbGhzLmFwcGVuZFRvKGJ1\nZik7CgogICAgICAgIGlmIChtb2QgJiYgIXN1cHBvcnRzTW9kT3BlcmF0b3Ip\nCiAgICAgICAgICAgIGJ1Zi5hcHBlbmQoIiwgIik7CiAgICAgICAgZWxzZQog\nICAgICAgICAgICBidWYuYXBwZW5kKCIgIikuYXBwZW5kKG9wKS5hcHBlbmQo\nIiAiKTsKCiAgICAgICAgaWYgKGNhc3RyaHMpCiAgICAgICAgICAgIGFwcGVu\nZENhc3QoYnVmLCByaHMsIHR5cGUpOwogICAgICAgIGVsc2UKICAgICAgICAg\nICAgcmhzLmFwcGVuZFRvKGJ1Zik7CgogICAgICAgIGJ1Zi5hcHBlbmQoIiki\nKTsKICAgIH0KCiAgICAvKioKICAgICAqIEFwcGVuZCBhIGNvbXBhcmlzb24u\nCiAgICAgKgogICAgICogQHBhcmFtIGJ1ZiB0aGUgU1FMIGJ1ZmZlciB0byB3\ncml0ZSB0aGUgY29tcGFyaXNvbgogICAgICogQHBhcmFtIG9wIHRoZSBjb21w\nYXJpc29uIG9wZXJhdGlvbiB0byBwZXJmb3JtCiAgICAgKiBAcGFyYW0gbGhz\nIHRoZSBsZWZ0IGhhbmQgc2lkZSBvZiB0aGUgY29tcGFyaXNvbgogICAgICog\nQHBhcmFtIHJocyB0aGUgcmlnaHQgaGFuZCBzaWRlIG9mIHRoZSBjb21wYXJp\nc29uCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIGNvbXBhcmlzb24oU1FMQnVm\nZmVyIGJ1ZiwgU3RyaW5nIG9wLCBGaWx0ZXJWYWx1ZSBsaHMsCiAgICAgICAg\nRmlsdGVyVmFsdWUgcmhzKSB7CiAgICAgICAgYm9vbGVhbiBsaHN4bWwgPSBs\naHMuZ2V0WFBhdGgoKSAhPSBudWxsOwogICAgICAgIGJvb2xlYW4gcmhzeG1s\nID0gcmhzLmdldFhQYXRoKCkgIT0gbnVsbDsKICAgICAgICBpZiAobGhzeG1s\nIHx8IHJoc3htbCkgewogICAgICAgICAgICBhcHBlbmRYbWxDb21wYXJpc29u\nKGJ1Ziwgb3AsIGxocywgcmhzLCBsaHN4bWwsIHJoc3htbCk7CiAgICAgICAg\nICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgYm9vbGVhbiBjYXN0bGhz\nID0gZmFsc2U7CiAgICAgICAgYm9vbGVhbiBjYXN0cmhzID0gZmFsc2U7CiAg\nICAgICAgQ2xhc3MgbGMgPSBGaWx0ZXJzLndyYXAobGhzLmdldFR5cGUoKSk7\nCiAgICAgICAgQ2xhc3MgcmMgPSBGaWx0ZXJzLndyYXAocmhzLmdldFR5cGUo\nKSk7CiAgICAgICAgaW50IHR5cGUgPSAwOwogICAgICAgIGlmIChyZXF1aXJl\nc0Nhc3RGb3JDb21wYXJpc29ucyAmJiAobGMgIT0gcmMKICAgICAgICAgICAg\nfHwgKGxocy5pc0NvbnN0YW50KCkgJiYgcmhzLmlzQ29uc3RhbnQoKSkpKSB7\nCiAgICAgICAgICAgIENsYXNzIGMgPSBGaWx0ZXJzLnByb21vdGUobGMsIHJj\nKTsKICAgICAgICAgICAgdHlwZSA9IGdldEpEQkNUeXBlKEphdmFUeXBlcy5n\nZXRUeXBlQ29kZShjKSwgZmFsc2UpOwogICAgICAgICAgICBpZiAodHlwZSAh\nPSBUeXBlcy5WQVJCSU5BUlkgJiYgdHlwZSAhPSBUeXBlcy5CTE9CKSB7CiAg\nICAgICAgICAgICAgICBjYXN0bGhzID0gKGxocy5pc0NvbnN0YW50KCkgJiYg\ncmhzLmlzQ29uc3RhbnQoKSkgfHwgbGMgIT0gYzsKICAgICAgICAgICAgICAg\nIGNhc3RyaHMgPSAobGhzLmlzQ29uc3RhbnQoKSAmJiByaHMuaXNDb25zdGFu\ndCgpKSB8fCByYyAhPSBjOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAg\nICAgICBpZiAoY2FzdGxocykKICAgICAgICAgICAgYXBwZW5kQ2FzdChidWYs\nIGxocywgdHlwZSk7CiAgICAgICAgZWxzZQogICAgICAgICAgICBsaHMuYXBw\nZW5kVG8oYnVmKTsKCiAgICAgICAgYnVmLmFwcGVuZCgiICIpLmFwcGVuZChv\ncCkuYXBwZW5kKCIgIik7CgogICAgICAgIGlmIChjYXN0cmhzKQogICAgICAg\nICAgICBhcHBlbmRDYXN0KGJ1ZiwgcmhzLCB0eXBlKTsKICAgICAgICBlbHNl\nCiAgICAgICAgICAgIHJocy5hcHBlbmRUbyhidWYpOwogICAgfQoKICAgIC8q\nKgogICAgICogSWYgdGhpcyBkaWN0aW9uYXJ5IHN1cHBvcnRzIFhNTCB0eXBl\nLAogICAgICogdXNlIHRoaXMgbWV0aG9kIHRvIGFwcGVuZCB4bWwgcHJlZGlj\nYXRlLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBhcHBlbmRYbWxDb21wYXJp\nc29uKFNRTEJ1ZmZlciBidWYsIFN0cmluZyBvcCwgRmlsdGVyVmFsdWUgbGhz\nLAogICAgICAgIEZpbHRlclZhbHVlIHJocywgYm9vbGVhbiBsaHN4bWwsIGJv\nb2xlYW4gcmhzeG1sKSB7CiAgICAgICAgYXNzZXJ0U3VwcG9ydChzdXBwb3J0\nc1hNTENvbHVtbiwgIlN1cHBvcnRzWE1MQ29sdW1uIik7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBBcHBlbmQgU1FMIGZvciB0aGUgZ2l2ZW4gbnVtZXJpYyB2\nYWx1ZSB0byB0aGUgYnVmZmVyLCBjYXN0aW5nIGFzIG5lZWRlZC4KICAgICAq\nLwogICAgcHJvdGVjdGVkIHZvaWQgYXBwZW5kTnVtZXJpY0Nhc3QoU1FMQnVm\nZmVyIGJ1ZiwgRmlsdGVyVmFsdWUgdmFsKSB7CiAgICAgICAgaWYgKHZhbC5p\nc0NvbnN0YW50KCkpCiAgICAgICAgICAgIGFwcGVuZENhc3QoYnVmLCB2YWws\nIFR5cGVzLk5VTUVSSUMpOwogICAgICAgIGVsc2UKICAgICAgICAgICAgdmFs\nLmFwcGVuZFRvKGJ1Zik7CiAgICB9CgogICAgLyoqCiAgICAgKiBDYXN0IHRo\nZSBzcGVjaWZpZWQgdmFsdWUgdG8gdGhlIHNwZWNpZmllZCB0eXBlLgogICAg\nICoKICAgICAqIEBwYXJhbSBidWYgdGhlIGJ1ZmZlciB0byBhcHBlbmQgdGhl\nIGNhc3QgdG8KICAgICAqIEBwYXJhbSB2YWwgdGhlIHZhbHVlIHRvIGNhc3QK\nICAgICAqIEBwYXJhbSB0eXBlIHRoZSB0eXBlIG9mIHRoZSBjYXNlLCBlLmcu\nIHtAbGluayBUeXBlcyNOVU1FUklDfQogICAgICovCiAgICBwdWJsaWMgdm9p\nZCBhcHBlbmRDYXN0KFNRTEJ1ZmZlciBidWYsIEZpbHRlclZhbHVlIHZhbCwg\naW50IHR5cGUpIHsKICAgICAgICAvLyBDb252ZXJ0IHRoZSBjYXN0IGZ1bmN0\naW9uOiAiQ0FTVCh7MH0gQVMgezF9KSIKICAgICAgICBpbnQgZmlyc3RQYXJh\nbSA9IGNhc3RGdW5jdGlvbi5pbmRleE9mKCJ7MH0iKTsKICAgICAgICBTdHJp\nbmcgcHJlID0gY2FzdEZ1bmN0aW9uLnN1YnN0cmluZygwLCBmaXJzdFBhcmFt\nKTsgLy8gIkNBU1QoIgogICAgICAgIFN0cmluZyBtaWQgPSBjYXN0RnVuY3Rp\nb24uc3Vic3RyaW5nKGZpcnN0UGFyYW0gKyAzKTsKICAgICAgICBpbnQgc2Vj\nb25kUGFyYW0gPSBtaWQuaW5kZXhPZigiezF9Iik7CiAgICAgICAgU3RyaW5n\nIHBvc3Q7CiAgICAgICAgaWYgKHNlY29uZFBhcmFtID4gLTEpIHsKICAgICAg\nICAgICAgcG9zdCA9IG1pZC5zdWJzdHJpbmcoc2Vjb25kUGFyYW0gKyAzKTsg\nLy8gIikiCiAgICAgICAgICAgIG1pZCA9IG1pZC5zdWJzdHJpbmcoMCwgc2Vj\nb25kUGFyYW0pOyAvLyAiIEFTICIKICAgICAgICB9IGVsc2UKICAgICAgICAg\nICAgcG9zdCA9ICIiOwoKICAgICAgICBidWYuYXBwZW5kKHByZSk7CiAgICAg\nICAgdmFsLmFwcGVuZFRvKGJ1Zik7CiAgICAgICAgYnVmLmFwcGVuZChtaWQp\nOwogICAgICAgIGJ1Zi5hcHBlbmQoZ2V0VHlwZU5hbWUodHlwZSkpOwogICAg\nICAgIGFwcGVuZExlbmd0aChidWYsIHR5cGUpOwogICAgICAgIGJ1Zi5hcHBl\nbmQocG9zdCk7CiAgICB9CiAgICAKICAgIHByb3RlY3RlZCB2b2lkIGFwcGVu\nZExlbmd0aChTUUxCdWZmZXIgYnVmLCBpbnQgdHlwZSkgeyAgICAgICAgCiAg\nICB9CgogICAgCiAgICAvKioKICAgICAqIGFkZCBDQVNUIGZvciBhIGZ1bmN0\naW9uIG9wZXJhdG9yIHdoZXJlIG9wZXJhbmQgaXMgYSBwYXJhbQogICAgICog\nQHBhcmFtIGZ1bmMgIGZ1bmN0aW9uIG5hbWUKICAgICAqIEBwYXJhbSB2YWwg\nCiAgICAgKiBAcmV0dXJuIHVwZGF0ZWQgZnVuYwogICAgICovCiAgICBwdWJs\naWMgU3RyaW5nIGFkZENhc3RBc1R5cGUoU3RyaW5nIGZ1bmMsIFZhbCB2YWwp\nIHsKICAgICAgICByZXR1cm4gbnVsbDsKICAgIH0gICAgCgoKICAgIC8vLy8v\nLy8vLy8vCiAgICAvLyBEREwgU1FMCiAgICAvLy8vLy8vLy8vLwoKICAgIC8q\nKgogICAgICogSW5jcmVtZW50IHRoZSByZWZlcmVuY2UgY291bnQgb2YgYW55\nIHRhYmxlIGNvbXBvbmVudHMgdGhhdCB0aGlzCiAgICAgKiBkaWN0aW9uYXJ5\nIGFkZHMgdGhhdCBhcmUgbm90IHVzZWQgYnkgbWFwcGluZ3MuIERvZXMgbm90\naGluZyBieSBkZWZhdWx0LgogICAgICovCiAgICBwdWJsaWMgdm9pZCByZWZT\nY2hlbWFDb21wb25lbnRzKFRhYmxlIHRhYmxlKSB7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBSZXR1cm5zIHRoZSBmdWxsIG5hbWUgb2YgdGhlIHRhYmxlLCBp\nbmNsdWRpbmcgdGhlIHNjaGVtYSAoZGVsaW1pdGVkCiAgICAgKiBieSB7QGxp\nbmsgI2NhdGFsb2dTZXBhcmF0b3J9KS4KICAgICAqLwogICAgcHVibGljIFN0\ncmluZyBnZXRGdWxsTmFtZShUYWJsZSB0YWJsZSwgYm9vbGVhbiBsb2dpY2Fs\nKSB7CiAgICAgICAgaWYgKCF1c2VTY2hlbWFOYW1lIHx8IHRhYmxlLmdldFNj\naGVtYU5hbWUoKSA9PSBudWxsKQogICAgICAgICAgICByZXR1cm4gdGFibGUu\nZ2V0TmFtZSgpOwogICAgICAgIGlmIChsb2dpY2FsIHx8ICIuIi5lcXVhbHMo\nY2F0YWxvZ1NlcGFyYXRvcikpCiAgICAgICAgICAgIHJldHVybiB0YWJsZS5n\nZXRGdWxsTmFtZSgpOwogICAgICAgIHJldHVybiB0YWJsZS5nZXRTY2hlbWFO\nYW1lKCkgKyBjYXRhbG9nU2VwYXJhdG9yICsgdGFibGUuZ2V0TmFtZSgpOwog\nICAgfQoKICAgIC8qKgogICAgICogUmV0dXJucyB0aGUgZnVsbCBuYW1lIG9m\nIHRoZSBpbmRleCwgaW5jbHVkaW5nIHRoZSBzY2hlbWEgKGRlbGltaXRlZAog\nICAgICogYnkgdGhlIHJlc3VsdCBvZiB7QGxpbmsgI2NhdGFsb2dTZXBhcmF0\nb3J9KS4KICAgICAqLwogICAgcHVibGljIFN0cmluZyBnZXRGdWxsTmFtZShJ\nbmRleCBpbmRleCkgewogICAgICAgIGlmICghdXNlU2NoZW1hTmFtZSB8fCBp\nbmRleC5nZXRTY2hlbWFOYW1lKCkgPT0gbnVsbCkKICAgICAgICAgICAgcmV0\ndXJuIGluZGV4LmdldE5hbWUoKTsKICAgICAgICBpZiAoIi4iLmVxdWFscyhj\nYXRhbG9nU2VwYXJhdG9yKSkKICAgICAgICAgICAgcmV0dXJuIGluZGV4Lmdl\ndEZ1bGxOYW1lKCk7CiAgICAgICAgcmV0dXJuIGluZGV4LmdldFNjaGVtYU5h\nbWUoKSArIGNhdGFsb2dTZXBhcmF0b3IgKyBpbmRleC5nZXROYW1lKCk7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm5zIHRoZSBmdWxsIG5hbWUgb2Yg\ndGhlIHNlcXVlbmNlLCBpbmNsdWRpbmcgdGhlIHNjaGVtYSAoZGVsaW1pdGVk\nCiAgICAgKiBieSB0aGUgcmVzdWx0IG9mIHtAbGluayAjY2F0YWxvZ1NlcGFy\nYXRvcn0pLgogICAgICovCiAgICBwdWJsaWMgU3RyaW5nIGdldEZ1bGxOYW1l\nKFNlcXVlbmNlIHNlcSkgewogICAgICAgIGlmICghdXNlU2NoZW1hTmFtZSB8\nfCBzZXEuZ2V0U2NoZW1hTmFtZSgpID09IG51bGwpCiAgICAgICAgICAgIHJl\ndHVybiBzZXEuZ2V0TmFtZSgpOwogICAgICAgIGlmICgiLiIuZXF1YWxzKGNh\ndGFsb2dTZXBhcmF0b3IpKQogICAgICAgICAgICByZXR1cm4gc2VxLmdldEZ1\nbGxOYW1lKCk7CiAgICAgICAgcmV0dXJuIHNlcS5nZXRTY2hlbWFOYW1lKCkg\nKyBjYXRhbG9nU2VwYXJhdG9yICsgc2VxLmdldE5hbWUoKTsKICAgIH0KCiAg\nICAvKioKICAgICAqIE1ha2UgYW55IG5lY2Vzc2FyeSBjaGFuZ2VzIHRvIHRo\nZSBnaXZlbiB0YWJsZSBuYW1lIHRvIG1ha2UgaXQgdmFsaWQKICAgICAqIGZv\nciB0aGUgY3VycmVudCBEQi4KICAgICAqLwogICAgcHVibGljIFN0cmluZyBn\nZXRWYWxpZFRhYmxlTmFtZShTdHJpbmcgbmFtZSwgU2NoZW1hIHNjaGVtYSkg\newogICAgICAgIHdoaWxlIChuYW1lLnN0YXJ0c1dpdGgoIl8iKSkKICAgICAg\nICAgICAgbmFtZSA9IG5hbWUuc3Vic3RyaW5nKDEpOwogICAgICAgIHJldHVy\nbiBtYWtlTmFtZVZhbGlkKG5hbWUsIHNjaGVtYS5nZXRTY2hlbWFHcm91cCgp\nLAogICAgICAgICAgICBtYXhUYWJsZU5hbWVMZW5ndGgsIE5BTUVfVEFCTEUp\nOwogICAgfQoKICAgIC8qKgogICAgICogTWFrZSBhbnkgbmVjZXNzYXJ5IGNo\nYW5nZXMgdG8gdGhlIGdpdmVuIHNlcXVlbmNlIG5hbWUgdG8gbWFrZSBpdCB2\nYWxpZAogICAgICogZm9yIHRoZSBjdXJyZW50IERCLgogICAgICovCiAgICBw\ndWJsaWMgU3RyaW5nIGdldFZhbGlkU2VxdWVuY2VOYW1lKFN0cmluZyBuYW1l\nLCBTY2hlbWEgc2NoZW1hKSB7CiAgICAgICAgd2hpbGUgKG5hbWUuc3RhcnRz\nV2l0aCgiXyIpKQogICAgICAgICAgICBuYW1lID0gbmFtZS5zdWJzdHJpbmco\nMSk7CiAgICAgICAgcmV0dXJuIG1ha2VOYW1lVmFsaWQoIlNfIiArIG5hbWUs\nIHNjaGVtYS5nZXRTY2hlbWFHcm91cCgpLAogICAgICAgICAgICBtYXhUYWJs\nZU5hbWVMZW5ndGgsIE5BTUVfU0VRVUVOQ0UpOwogICAgfQoKICAgIC8qKgog\nICAgICogTWFrZSBhbnkgbmVjZXNzYXJ5IGNoYW5nZXMgdG8gdGhlIGdpdmVu\nIGNvbHVtbiBuYW1lIHRvIG1ha2UgaXQgdmFsaWQKICAgICAqIGZvciB0aGUg\nY3VycmVudCBEQi4KICAgICAqLwogICAgcHVibGljIFN0cmluZyBnZXRWYWxp\nZENvbHVtbk5hbWUoU3RyaW5nIG5hbWUsIFRhYmxlIHRhYmxlKSB7CiAgICAg\nICAgd2hpbGUgKG5hbWUuc3RhcnRzV2l0aCgiXyIpKQogICAgICAgICAgICBu\nYW1lID0gbmFtZS5zdWJzdHJpbmcoMSk7CiAgICAgICAgcmV0dXJuIG1ha2VO\nYW1lVmFsaWQobmFtZSwgdGFibGUsIG1heENvbHVtbk5hbWVMZW5ndGgsIE5B\nTUVfQU5ZKTsKICAgIH0KCiAgICAvKioKICAgICAqIE1ha2UgYW55IG5lY2Vz\nc2FyeSBjaGFuZ2VzIHRvIHRoZSBnaXZlbiBwcmltYXJ5IGtleSBuYW1lIHRv\nIG1ha2UgaXQKICAgICAqIHZhbGlkIGZvciB0aGUgY3VycmVudCBEQi4KICAg\nICAqLwogICAgcHVibGljIFN0cmluZyBnZXRWYWxpZFByaW1hcnlLZXlOYW1l\nKFN0cmluZyBuYW1lLCBUYWJsZSB0YWJsZSkgewogICAgICAgIHdoaWxlIChu\nYW1lLnN0YXJ0c1dpdGgoIl8iKSkKICAgICAgICAgICAgbmFtZSA9IG5hbWUu\nc3Vic3RyaW5nKDEpOwogICAgICAgIHJldHVybiBtYWtlTmFtZVZhbGlkKCJQ\nXyIgKyBuYW1lLCB0YWJsZS5nZXRTY2hlbWEoKS5nZXRTY2hlbWFHcm91cCgp\nLAogICAgICAgICAgICBtYXhDb25zdHJhaW50TmFtZUxlbmd0aCwgTkFNRV9B\nTlkpOwogICAgfQoKICAgIC8qKgogICAgICogTWFrZSBhbnkgbmVjZXNzYXJ5\nIGNoYW5nZXMgdG8gdGhlIGdpdmVuIGZvcmVpZ24ga2V5IG5hbWUgdG8gbWFr\nZSBpdAogICAgICogdmFsaWQgZm9yIHRoZSBjdXJyZW50IERCLgogICAgICov\nCiAgICBwdWJsaWMgU3RyaW5nIGdldFZhbGlkRm9yZWlnbktleU5hbWUoU3Ry\naW5nIG5hbWUsIFRhYmxlIHRhYmxlLAogICAgICAgIFRhYmxlIHRvVGFibGUp\nIHsKICAgICAgICB3aGlsZSAobmFtZS5zdGFydHNXaXRoKCJfIikpCiAgICAg\nICAgICAgIG5hbWUgPSBuYW1lLnN1YnN0cmluZygxKTsKICAgICAgICBTdHJp\nbmcgdGFibGVOYW1lID0gdGFibGUuZ2V0TmFtZSgpOwogICAgICAgIGludCBs\nZW4gPSBNYXRoLm1pbih0YWJsZU5hbWUubGVuZ3RoKCksIDcpOwogICAgICAg\nIG5hbWUgPSAiRl8iICsgc2hvcnRlbih0YWJsZU5hbWUsIGxlbikgKyAiXyIg\nKyBuYW1lOwogICAgICAgIHJldHVybiBtYWtlTmFtZVZhbGlkKG5hbWUsIHRh\nYmxlLmdldFNjaGVtYSgpLmdldFNjaGVtYUdyb3VwKCksCiAgICAgICAgICAg\nIG1heENvbnN0cmFpbnROYW1lTGVuZ3RoLCBOQU1FX0FOWSk7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBNYWtlIGFueSBuZWNlc3NhcnkgY2hhbmdlcyB0byB0\naGUgZ2l2ZW4gaW5kZXggbmFtZSB0byBtYWtlIGl0IHZhbGlkCiAgICAgKiBm\nb3IgdGhlIGN1cnJlbnQgREIuCiAgICAgKi8KICAgIHB1YmxpYyBTdHJpbmcg\nZ2V0VmFsaWRJbmRleE5hbWUoU3RyaW5nIG5hbWUsIFRhYmxlIHRhYmxlKSB7\nCiAgICAgICAgd2hpbGUgKG5hbWUuc3RhcnRzV2l0aCgiXyIpKQogICAgICAg\nICAgICBuYW1lID0gbmFtZS5zdWJzdHJpbmcoMSk7CiAgICAgICAgU3RyaW5n\nIHRhYmxlTmFtZSA9IHRhYmxlLmdldE5hbWUoKTsKICAgICAgICBpbnQgbGVu\nID0gTWF0aC5taW4odGFibGVOYW1lLmxlbmd0aCgpLCA3KTsKICAgICAgICBu\nYW1lID0gIklfIiArIHNob3J0ZW4odGFibGVOYW1lLCBsZW4pICsgIl8iICsg\nbmFtZTsKICAgICAgICByZXR1cm4gbWFrZU5hbWVWYWxpZChuYW1lLCB0YWJs\nZS5nZXRTY2hlbWEoKS5nZXRTY2hlbWFHcm91cCgpLAogICAgICAgICAgICBt\nYXhJbmRleE5hbWVMZW5ndGgsIE5BTUVfQU5ZKTsKICAgIH0KCiAgICAvKioK\nICAgICAqIE1ha2UgYW55IG5lY2Vzc2FyeSBjaGFuZ2VzIHRvIHRoZSBnaXZl\nbiB1bmlxdWUgY29uc3RyYWludCBuYW1lIHRvIG1ha2UKICAgICAqIGl0IHZh\nbGlkIGZvciB0aGUgY3VycmVudCBEQi4KICAgICAqLwogICAgcHVibGljIFN0\ncmluZyBnZXRWYWxpZFVuaXF1ZU5hbWUoU3RyaW5nIG5hbWUsIFRhYmxlIHRh\nYmxlKSB7CiAgICAgICAgd2hpbGUgKG5hbWUuc3RhcnRzV2l0aCgiXyIpKQog\nICAgICAgICAgICBuYW1lID0gbmFtZS5zdWJzdHJpbmcoMSk7CiAgICAgICAg\nU3RyaW5nIHRhYmxlTmFtZSA9IHRhYmxlLmdldE5hbWUoKTsKICAgICAgICBp\nbnQgbGVuID0gTWF0aC5taW4odGFibGVOYW1lLmxlbmd0aCgpLCA3KTsKICAg\nICAgICBuYW1lID0gIlVfIiArIHNob3J0ZW4odGFibGVOYW1lLCBsZW4pICsg\nIl8iICsgbmFtZTsKICAgICAgICByZXR1cm4gbWFrZU5hbWVWYWxpZChuYW1l\nLCB0YWJsZS5nZXRTY2hlbWEoKS5nZXRTY2hlbWFHcm91cCgpLAogICAgICAg\nICAgICBtYXhDb25zdHJhaW50TmFtZUxlbmd0aCwgTkFNRV9BTlkpOwogICAg\nfQoKICAgIC8qKgogICAgICogU2hvcnRlbiB0aGUgc3BlY2lmaWVkIG5hbWUg\ndG8gdGhlIHNwZWNpZmllZCB0YXJnZXQgbmFtZS4gVGhpcyB3aWxsCiAgICAg\nKiBiZSBkb25lIGJ5IGZpcnN0IHN0cmlwcGluZyBvdXQgdGhlIHZvd2Vscywg\nYW5kIHRoZW4gcmVtb3ZpbmcKICAgICAqIGNoYXJhY3RlcnMgZnJvbSB0aGUg\nbWlkZGxlIG9mIHRoZSB3b3JkIHVudGlsIGl0IHJlYWNoZXMgdGhlIHRhcmdl\ndAogICAgICogbGVuZ3RoLgogICAgICovCiAgICBwcm90ZWN0ZWQgc3RhdGlj\nIFN0cmluZyBzaG9ydGVuKFN0cmluZyBuYW1lLCBpbnQgdGFyZ2V0TGVuZ3Ro\nKSB7CiAgICAgICAgaWYgKG5hbWUgPT0gbnVsbCB8fCBuYW1lLmxlbmd0aCgp\nIDw9IHRhcmdldExlbmd0aCkKICAgICAgICAgICAgcmV0dXJuIG5hbWU7Cgog\nICAgICAgIFN0cmluZ0J1ZmZlciBubSA9IG5ldyBTdHJpbmdCdWZmZXIobmFt\nZSk7CiAgICAgICAgd2hpbGUgKG5tLmxlbmd0aCgpID4gdGFyZ2V0TGVuZ3Ro\nKSB7CiAgICAgICAgICAgIGlmICghc3RyaXBWb3dlbChubSkpIHsKICAgICAg\nICAgICAgICAgIC8vIGN1dCBvdXQgdGhlIG1pZGRsZSBjaGFyCiAgICAgICAg\nICAgICAgICBubS5yZXBsYWNlKG5tLmxlbmd0aCgpIC8gMiwgKG5tLmxlbmd0\naCgpIC8gMikgKyAxLCAiIik7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAg\nICAgICAgcmV0dXJuIG5tLnRvU3RyaW5nKCk7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBSZW1vdmUgdm93ZWxzIGZyb20gdGhlIHNwZWNpZmllZCBTdHJpbmdC\ndWZmZXIuCiAgICAgKgogICAgICogQHJldHVybiB0cnVlIGlmIGFueSB2b3dl\nbHMgaGF2ZSBiZWVuIHJlbW92ZWQKICAgICAqLwogICAgcHJpdmF0ZSBzdGF0\naWMgYm9vbGVhbiBzdHJpcFZvd2VsKFN0cmluZ0J1ZmZlciBuYW1lKSB7CiAg\nICAgICAgaWYgKG5hbWUgPT0gbnVsbCB8fCBuYW1lLmxlbmd0aCgpID09IDAp\nCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCiAgICAgICAgY2hhcltdIHZv\nd2VscyA9IHsgJ0EnLCAnRScsICdJJywgJ08nLCAnVScsIH07CiAgICAgICAg\nZm9yIChpbnQgaSA9IDA7IGkgPCB2b3dlbHMubGVuZ3RoOyBpKyspIHsKICAg\nICAgICAgICAgaW50IGluZGV4ID0gbmFtZS50b1N0cmluZygpLnRvVXBwZXJD\nYXNlKCkuaW5kZXhPZih2b3dlbHNbaV0pOwogICAgICAgICAgICBpZiAoaW5k\nZXggIT0gLTEpIHsKICAgICAgICAgICAgICAgIG5hbWUucmVwbGFjZShpbmRl\neCwgaW5kZXggKyAxLCAiIik7CiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1\nZTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4gZmFs\nc2U7CiAgICB9CgogICAgLyoqCiAgICAgKiBTaG9ydGVucyB0aGUgZ2l2ZW4g\nbmFtZSB0byB0aGUgZ2l2ZW4gbWF4aW11bSBsZW5ndGgsIHRoZW4gY2hlY2tz\nIHRoYXQKICAgICAqIGl0IGlzIG5vdCBhIHJlc2VydmVkIHdvcmQuIElmIGl0\nIGlzIHJlc2VydmVkLCBhcHBlbmRzIGEgIjAiLiBJZgogICAgICogdGhlIG5h\nbWUgY29uZmxpY3RzIHdpdGggYW4gZXhpc3Rpbmcgc2NoZW1hIGNvbXBvbmVu\ndCwgdGhlIGxhc3QKICAgICAqIGNoYXJhY3RlciBpcyByZXBsYWNlIHdpdGgg\nJzAnLCB0aGVuICcxJywgZXRjLgogICAgICogTm90ZSB0aGF0IHRoZSBnaXZl\nbiBtYXggbGVuIG1heSBiZSAwIGlmIHRoZSBkYXRhYmFzZSBtZXRhZGF0YSBp\ncwogICAgICogaW5jb21wbGV0ZS4KICAgICAqLwogICAgcHJvdGVjdGVkIFN0\ncmluZyBtYWtlTmFtZVZhbGlkKFN0cmluZyBuYW1lLCBOYW1lU2V0IHNldCwg\naW50IG1heExlbiwKICAgICAgICBpbnQgbmFtZVR5cGUpIHsKICAgICAgICBp\nZiAobWF4TGVuIDwgMSkKICAgICAgICAgICAgbWF4TGVuID0gMjU1OwogICAg\nICAgIGlmIChuYW1lLmxlbmd0aCgpID4gbWF4TGVuKQogICAgICAgICAgICBu\nYW1lID0gbmFtZS5zdWJzdHJpbmcoMCwgbWF4TGVuKTsKICAgICAgICBpZiAo\ncmVzZXJ2ZWRXb3JkU2V0LmNvbnRhaW5zKG5hbWUudG9VcHBlckNhc2UoKSkp\nIHsKICAgICAgICAgICAgaWYgKG5hbWUubGVuZ3RoKCkgPT0gbWF4TGVuKQog\nICAgICAgICAgICAgICAgbmFtZSA9IG5hbWUuc3Vic3RyaW5nKDAsIG5hbWUu\nbGVuZ3RoKCkgLSAxKTsKICAgICAgICAgICAgbmFtZSArPSAiMCI7CiAgICAg\nICAgfQoKICAgICAgICAvLyBub3cgbWFrZSBzdXJlIHRoZSBuYW1lIGlzIHVu\naXF1ZQogICAgICAgIGlmIChzZXQgIT0gbnVsbCkgewogICAgICAgICAgICBv\ndXRlcjoKICAgICAgICAgICAgZm9yIChpbnQgdmVyc2lvbiA9IDEsIGNoYXJz\nID0gMTsgdHJ1ZTsgdmVyc2lvbisrKSB7CiAgICAgICAgICAgICAgICAvLyBm\nb3IgdGFibGUgbmFtZXMsIHdlIGNoZWNrIGZvciB0aGUgdGFibGUgaXRzZWxm\nIGluIGNhc2UgdGhlCiAgICAgICAgICAgICAgICAvLyBuYW1lIHNldCBpcyBs\nYXp5IGFib3V0IHNjaGVtYSByZWZsZWN0aW9uCiAgICAgICAgICAgICAgICBz\nd2l0Y2ggKG5hbWVUeXBlKSB7CiAgICAgICAgICAgICAgICAgICAgY2FzZSBO\nQU1FX1RBQkxFOgogICAgICAgICAgICAgICAgICAgICAgICBpZiAoISgoU2No\nZW1hR3JvdXApIHNldCkuaXNLbm93blRhYmxlKG5hbWUpKQogICAgICAgICAg\nICAgICAgICAgICAgICAgICAgYnJlYWsgb3V0ZXI7CiAgICAgICAgICAgICAg\nICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIGNhc2UgTkFN\nRV9TRVFVRU5DRToKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEoKFNj\naGVtYUdyb3VwKSBzZXQpLmlzS25vd25TZXF1ZW5jZShuYW1lKSkKICAgICAg\nICAgICAgICAgICAgICAgICAgICAgIGJyZWFrIG91dGVyOwogICAgICAgICAg\nICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICBkZWZh\ndWx0OgogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXNldC5pc05hbWVU\nYWtlbihuYW1lKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFr\nIG91dGVyOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIC8v\nIGEgc2luZ2xlIGNoYXIgZm9yIHRoZSB2ZXJzaW9uIGlzIHByb2JhYmx5IGVu\nb3VnaCwgYnV0IG1pZ2h0CiAgICAgICAgICAgICAgICAvLyBhcyB3ZWxsIGJl\nIGdlbmVyYWwgYWJvdXQgaXQuLi4KICAgICAgICAgICAgICAgIGlmICh2ZXJz\naW9uID4gMSkKICAgICAgICAgICAgICAgICAgICBuYW1lID0gbmFtZS5zdWJz\ndHJpbmcoMCwgbmFtZS5sZW5ndGgoKSAtIGNoYXJzKTsKICAgICAgICAgICAg\nICAgIGlmICh2ZXJzaW9uID49IE1hdGgucG93KDEwLCBjaGFycykpCiAgICAg\nICAgICAgICAgICAgICAgY2hhcnMrKzsKICAgICAgICAgICAgICAgIGlmIChu\nYW1lLmxlbmd0aCgpICsgY2hhcnMgPiBtYXhMZW4pCiAgICAgICAgICAgICAg\nICAgICAgbmFtZSA9IG5hbWUuc3Vic3RyaW5nKDAsIG1heExlbiAtIGNoYXJz\nKTsKICAgICAgICAgICAgICAgIG5hbWUgPSBuYW1lICsgdmVyc2lvbjsKICAg\nICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4gbmFtZS50b1Vw\ncGVyQ2FzZSgpOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIGEgc2Vy\naWVzIG9mIFNRTCBzdGF0ZW1lbnRzIHRvIGNyZWF0ZSB0aGUgZ2l2ZW4gdGFi\nbGUsIGNvbXBsZXRlCiAgICAgKiB3aXRoIGNvbHVtbnMuIEluZGV4ZXMgYW5k\nIGNvbnN0cmFpbnRzIHdpbGwgYmUgY3JlYXRlZCBzZXBhcmF0ZWx5LgogICAg\nICovCiAgICBwdWJsaWMgU3RyaW5nW10gZ2V0Q3JlYXRlVGFibGVTUUwoVGFi\nbGUgdGFibGUpIHsKICAgICAgICBTdHJpbmdCdWZmZXIgYnVmID0gbmV3IFN0\ncmluZ0J1ZmZlcigpOwogICAgICAgIGJ1Zi5hcHBlbmQoIkNSRUFURSBUQUJM\nRSAiKS5hcHBlbmQoZ2V0RnVsbE5hbWUodGFibGUsIGZhbHNlKSkuCiAgICAg\nICAgICAgIGFwcGVuZCgiICgiKTsKCiAgICAgICAgQ29sdW1uW10gY29scyA9\nIHRhYmxlLmdldENvbHVtbnMoKTsKICAgICAgICBmb3IgKGludCBpID0gMDsg\naSA8IGNvbHMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgaWYgKGkgPiAw\nKQogICAgICAgICAgICAgICAgYnVmLmFwcGVuZCgiLCAiKTsKICAgICAgICAg\nICAgYnVmLmFwcGVuZChnZXREZWNsYXJlQ29sdW1uU1FMKGNvbHNbaV0sIGZh\nbHNlKSk7CiAgICAgICAgfQoKICAgICAgICBQcmltYXJ5S2V5IHBrID0gdGFi\nbGUuZ2V0UHJpbWFyeUtleSgpOwogICAgICAgIFN0cmluZyBwa1N0cjsKICAg\nICAgICBpZiAocGsgIT0gbnVsbCkgewogICAgICAgICAgICBwa1N0ciA9IGdl\ndFByaW1hcnlLZXlDb25zdHJhaW50U1FMKHBrKTsKICAgICAgICAgICAgaWYg\nKHBrU3RyICE9IG51bGwpCiAgICAgICAgICAgICAgICBidWYuYXBwZW5kKCIs\nICIpLmFwcGVuZChwa1N0cik7CiAgICAgICAgfQoKICAgICAgICBVbmlxdWVb\nXSB1bnFzID0gdGFibGUuZ2V0VW5pcXVlcygpOwogICAgICAgIFN0cmluZyB1\nbnFTdHI7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCB1bnFzLmxlbmd0\naDsgaSsrKSB7CiAgICAgICAgICAgIHVucVN0ciA9IGdldFVuaXF1ZUNvbnN0\ncmFpbnRTUUwodW5xc1tpXSk7CiAgICAgICAgICAgIGlmICh1bnFTdHIgIT0g\nbnVsbCkKICAgICAgICAgICAgICAgIGJ1Zi5hcHBlbmQoIiwgIikuYXBwZW5k\nKHVucVN0cik7CiAgICAgICAgfQoKICAgICAgICBidWYuYXBwZW5kKCIpIik7\nCiAgICAgICAgcmV0dXJuIG5ldyBTdHJpbmdbXXsgYnVmLnRvU3RyaW5nKCkg\nfTsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiBhIHNlcmllcyBvZiBT\nUUwgc3RhdGVtZW50cyB0byBkcm9wIHRoZSBnaXZlbiB0YWJsZS4gSW5kZXhl\ncwogICAgICogd2lsbCBiZSBkcm9wcGVkIHNlcGFyYXRlbHkuIFJldHVybnMK\nICAgICAqIDxjb2RlPkRST1AgVEFCTEUgJmx0O3RhYmxlIG5hbWUmZ3Q7PC9j\nb2RlPiBieSBkZWZhdWx0LgogICAgICovCiAgICBwdWJsaWMgU3RyaW5nW10g\nZ2V0RHJvcFRhYmxlU1FMKFRhYmxlIHRhYmxlKSB7CiAgICAgICAgU3RyaW5n\nIGRyb3AgPSBNZXNzYWdlRm9ybWF0LmZvcm1hdChkcm9wVGFibGVTUUwsIG5l\ndyBPYmplY3RbXXsKICAgICAgICAgICAgZ2V0RnVsbE5hbWUodGFibGUsIGZh\nbHNlKSB9KTsKICAgICAgICByZXR1cm4gbmV3IFN0cmluZ1tdeyBkcm9wIH07\nCiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gYSBzZXJpZXMgb2YgU1FM\nIHN0YXRlbWVudHMgdG8gY3JlYXRlIHRoZSBnaXZlbiBzZXF1ZW5jZS4gUmV0\ndXJucwogICAgICogPGNvZGU+Q1JFQVRFIFNFUVVFTkNFICZsdDtzZXF1ZW5j\nZSBuYW1lJmd0O1sgU1RBUlQgV0lUSCAmbHQ7c3RhcnQmZ3Q7XQogICAgICog\nWyBJTkNSRU1FTlQgQlkgJmx0O2luY3JlbWVudCZndDtdPC9jb2RlPiBieSBk\nZWZhdWx0LgogICAgICovCiAgICBwdWJsaWMgU3RyaW5nW10gZ2V0Q3JlYXRl\nU2VxdWVuY2VTUUwoU2VxdWVuY2Ugc2VxKSB7CiAgICAgICAgaWYgKG5leHRT\nZXF1ZW5jZVF1ZXJ5ID09IG51bGwpCiAgICAgICAgICAgIHJldHVybiBudWxs\nOwoKICAgICAgICBTdHJpbmdCdWZmZXIgYnVmID0gbmV3IFN0cmluZ0J1ZmZl\ncigpOwogICAgICAgIGJ1Zi5hcHBlbmQoIkNSRUFURSBTRVFVRU5DRSAiKTsK\nICAgICAgICBidWYuYXBwZW5kKGdldEZ1bGxOYW1lKHNlcSkpOwogICAgICAg\nIGlmIChzZXEuZ2V0SW5pdGlhbFZhbHVlKCkgIT0gMCkKICAgICAgICAgICAg\nYnVmLmFwcGVuZCgiIFNUQVJUIFdJVEggIikuYXBwZW5kKHNlcS5nZXRJbml0\naWFsVmFsdWUoKSk7CiAgICAgICAgaWYgKHNlcS5nZXRJbmNyZW1lbnQoKSA+\nIDEpCiAgICAgICAgICAgIGJ1Zi5hcHBlbmQoIiBJTkNSRU1FTlQgQlkgIiku\nYXBwZW5kKHNlcS5nZXRJbmNyZW1lbnQoKSk7CiAgICAgICAgcmV0dXJuIG5l\ndyBTdHJpbmdbXXsgYnVmLnRvU3RyaW5nKCkgfTsKICAgIH0KCiAgICAvKioK\nICAgICAqIFJldHVybiBhIHNlcmllcyBvZiBTUUwgc3RhdGVtZW50cyB0byBk\ncm9wIHRoZSBnaXZlbiBzZXF1ZW5jZS4gUmV0dXJucwogICAgICogPGNvZGU+\nRFJPUCBTRVFVRU5DRSAmbHQ7c2VxdWVuY2UgbmFtZSZndDs8L2NvZGU+IGJ5\nIGRlZmF1bHQuCiAgICAgKi8KICAgIHB1YmxpYyBTdHJpbmdbXSBnZXREcm9w\nU2VxdWVuY2VTUUwoU2VxdWVuY2Ugc2VxKSB7CiAgICAgICAgcmV0dXJuIG5l\ndyBTdHJpbmdbXXsgIkRST1AgU0VRVUVOQ0UgIiArIGdldEZ1bGxOYW1lKHNl\ncSkgfTsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiBhIHNlcmllcyBv\nZiBTUUwgc3RhdGVtZW50cyB0byBjcmVhdGUgdGhlIGdpdmVuIGluZGV4LiBS\nZXR1cm5zCiAgICAgKiA8Y29kZT5DUkVBVEUgW1VOSVFVRV0gSU5ERVggJmx0\nO2luZGV4IG5hbWUmZ3Q7IE9OICZsdDt0YWJsZSBuYW1lJmd0OwogICAgICog\nKCZsdDtjb2wgbGlzdCZndDspPC9jb2RlPiBieSBkZWZhdWx0LgogICAgICov\nCiAgICBwdWJsaWMgU3RyaW5nW10gZ2V0Q3JlYXRlSW5kZXhTUUwoSW5kZXgg\naW5kZXgpIHsKICAgICAgICBTdHJpbmdCdWZmZXIgYnVmID0gbmV3IFN0cmlu\nZ0J1ZmZlcigpOwogICAgICAgIGJ1Zi5hcHBlbmQoIkNSRUFURSAiKTsKICAg\nICAgICBpZiAoaW5kZXguaXNVbmlxdWUoKSkKICAgICAgICAgICAgYnVmLmFw\ncGVuZCgiVU5JUVVFICIpOwogICAgICAgIGJ1Zi5hcHBlbmQoIklOREVYICIp\nLmFwcGVuZChpbmRleC5nZXROYW1lKCkpOwoKICAgICAgICBidWYuYXBwZW5k\nKCIgT04gIikuYXBwZW5kKGdldEZ1bGxOYW1lKGluZGV4LmdldFRhYmxlKCks\nIGZhbHNlKSk7CiAgICAgICAgYnVmLmFwcGVuZCgiICgiKS5hcHBlbmQoU3Ry\naW5ncy5qb2luKGluZGV4LmdldENvbHVtbnMoKSwgIiwgIikpLgogICAgICAg\nICAgICBhcHBlbmQoIikiKTsKCiAgICAgICAgcmV0dXJuIG5ldyBTdHJpbmdb\nXXsgYnVmLnRvU3RyaW5nKCkgfTsKICAgIH0KCiAgICAvKioKICAgICAqIFJl\ndHVybiBhIHNlcmllcyBvZiBTUUwgc3RhdGVtZW50cyB0byBkcm9wIHRoZSBn\naXZlbiBpbmRleC4gUmV0dXJucwogICAgICogPGNvZGU+RFJPUCBJTkRFWCAm\nbHQ7aW5kZXggbmFtZSZndDs8L2NvZGU+IGJ5IGRlZmF1bHQuCiAgICAgKi8K\nICAgIHB1YmxpYyBTdHJpbmdbXSBnZXREcm9wSW5kZXhTUUwoSW5kZXggaW5k\nZXgpIHsKICAgICAgICByZXR1cm4gbmV3IFN0cmluZ1tdeyAiRFJPUCBJTkRF\nWCAiICsgZ2V0RnVsbE5hbWUoaW5kZXgpIH07CiAgICB9CgogICAgLyoqCiAg\nICAgKiBSZXR1cm4gYSBzZXJpZXMgb2YgU1FMIHN0YXRlbWVudHMgdG8gYWRk\nIHRoZSBnaXZlbiBjb2x1bW4gdG8KICAgICAqIGl0cyB0YWJsZS4gUmV0dXJu\nIGFuIGVtcHR5IGFycmF5IGlmIG9wZXJhdGlvbiBub3Qgc3VwcG9ydGVkLiBS\nZXR1cm5zCiAgICAgKiA8Y29kZT5BTFRFUiBUQUJMRSAmbHQ7dGFibGUgbmFt\nZSZndDsgQUREICgmbHQ7Y29sIGRlYyZndDspPC9jb2RlPgogICAgICogYnkg\nZGVmYXVsdC4KICAgICAqLwogICAgcHVibGljIFN0cmluZ1tdIGdldEFkZENv\nbHVtblNRTChDb2x1bW4gY29sdW1uKSB7CiAgICAgICAgaWYgKCFzdXBwb3J0\nc0FsdGVyVGFibGVXaXRoQWRkQ29sdW1uKQogICAgICAgICAgICByZXR1cm4g\nbmV3IFN0cmluZ1swXTsKCiAgICAgICAgU3RyaW5nIGRlYyA9IGdldERlY2xh\ncmVDb2x1bW5TUUwoY29sdW1uLCB0cnVlKTsKICAgICAgICBpZiAoZGVjID09\nIG51bGwpCiAgICAgICAgICAgIHJldHVybiBuZXcgU3RyaW5nWzBdOwogICAg\nICAgIHJldHVybiBuZXcgU3RyaW5nW117ICJBTFRFUiBUQUJMRSAiCiAgICAg\nICAgICAgICsgZ2V0RnVsbE5hbWUoY29sdW1uLmdldFRhYmxlKCksIGZhbHNl\nKSArICIgQUREICIgKyBkZWMgfTsKICAgIH0KCiAgICAvKioKICAgICAqIFJl\ndHVybiBhIHNlcmllcyBvZiBTUUwgc3RhdGVtZW50cyB0byBkcm9wIHRoZSBn\naXZlbiBjb2x1bW4gZnJvbQogICAgICogaXRzIHRhYmxlLiBSZXR1cm4gYW4g\nZW1wdHkgYXJyYXkgaWYgb3BlcmF0aW9uIG5vdCBzdXBwb3J0ZWQuIFJldHVy\nbnMKICAgICAqIDxjb2RlPkFMVEVSIFRBQkxFICZsdDt0YWJsZSBuYW1lJmd0\nOyBEUk9QIENPTFVNTiAmbHQ7Y29sIG5hbWUmZ3Q7PC9jb2RlPgogICAgICog\nYnkgZGVmYXVsdC4KICAgICAqLwogICAgcHVibGljIFN0cmluZ1tdIGdldERy\nb3BDb2x1bW5TUUwoQ29sdW1uIGNvbHVtbikgewogICAgICAgIGlmICghc3Vw\ncG9ydHNBbHRlclRhYmxlV2l0aERyb3BDb2x1bW4pCiAgICAgICAgICAgIHJl\ndHVybiBuZXcgU3RyaW5nWzBdOwogICAgICAgIHJldHVybiBuZXcgU3RyaW5n\nW117ICJBTFRFUiBUQUJMRSAiCiAgICAgICAgICAgICsgZ2V0RnVsbE5hbWUo\nY29sdW1uLmdldFRhYmxlKCksIGZhbHNlKQogICAgICAgICAgICArICIgRFJP\nUCBDT0xVTU4gIiArIGNvbHVtbiB9OwogICAgfQoKICAgIC8qKgogICAgICog\nUmV0dXJuIGEgc2VyaWVzIG9mIFNRTCBzdGF0ZW1lbnRzIHRvIGFkZCB0aGUg\nZ2l2ZW4gcHJpbWFyeSBrZXkgdG8KICAgICAqIGl0cyB0YWJsZS4gUmV0dXJu\nIGFuIGVtcHR5IGFycmF5IGlmIG9wZXJhdGlvbiBub3Qgc3VwcG9ydGVkLgog\nICAgICogUmV0dXJucyA8Y29kZT5BTFRFUiBUQUJMRSAmbHQ7dGFibGUgbmFt\nZSZndDsgQURECiAgICAgKiAmbHQ7cGsgY29ucyBzcWwgJmd0OzwvY29kZT4g\nYnkgZGVmYXVsdC4KICAgICAqLwogICAgcHVibGljIFN0cmluZ1tdIGdldEFk\nZFByaW1hcnlLZXlTUUwoUHJpbWFyeUtleSBwaykgewogICAgICAgIFN0cmlu\nZyBwa3NxbCA9IGdldFByaW1hcnlLZXlDb25zdHJhaW50U1FMKHBrKTsKICAg\nICAgICBpZiAocGtzcWwgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIG5l\ndyBTdHJpbmdbMF07CiAgICAgICAgcmV0dXJuIG5ldyBTdHJpbmdbXXsgIkFM\nVEVSIFRBQkxFICIKICAgICAgICAgICAgKyBnZXRGdWxsTmFtZShway5nZXRU\nYWJsZSgpLCBmYWxzZSkgKyAiIEFERCAiICsgcGtzcWwgfTsKICAgIH0KCiAg\nICAvKioKICAgICAqIFJldHVybiBhIHNlcmllcyBvZiBTUUwgc3RhdGVtZW50\ncyB0byBkcm9wIHRoZSBnaXZlbiBwcmltYXJ5IGtleSBmcm9tCiAgICAgKiBp\ndHMgdGFibGUuIFJldHVybiBhbiBlbXB0eSBhcnJheSBpZiBvcGVyYXRpb24g\nbm90IHN1cHBvcnRlZC4KICAgICAqIFJldHVybnMgPGNvZGU+QUxURVIgVEFC\nTEUgJmx0O3RhYmxlIG5hbWUmZ3Q7IERST1AgQ09OU1RSQUlOVAogICAgICog\nJmx0O3BrIG5hbWUmZ3Q7PC9jb2RlPiBieSBkZWZhdWx0LgogICAgICovCiAg\nICBwdWJsaWMgU3RyaW5nW10gZ2V0RHJvcFByaW1hcnlLZXlTUUwoUHJpbWFy\neUtleSBwaykgewogICAgICAgIGlmIChway5nZXROYW1lKCkgPT0gbnVsbCkK\nICAgICAgICAgICAgcmV0dXJuIG5ldyBTdHJpbmdbMF07CiAgICAgICAgcmV0\ndXJuIG5ldyBTdHJpbmdbXXsgIkFMVEVSIFRBQkxFICIKICAgICAgICAgICAg\nKyBnZXRGdWxsTmFtZShway5nZXRUYWJsZSgpLCBmYWxzZSkKICAgICAgICAg\nICAgKyAiIERST1AgQ09OU1RSQUlOVCAiICsgcGsuZ2V0TmFtZSgpIH07CiAg\nICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gYSBzZXJpZXMgb2YgU1FMIHN0\nYXRlbWVudHMgdG8gYWRkIHRoZSBnaXZlbiBmb3JlaWduIGtleSB0bwogICAg\nICogaXRzIHRhYmxlLiBSZXR1cm4gYW4gZW1wdHkgYXJyYXkgaWYgb3BlcmF0\naW9uIG5vdCBzdXBwb3J0ZWQuCiAgICAgKiBSZXR1cm5zIDxjb2RlPkFMVEVS\nIFRBQkxFICZsdDt0YWJsZSBuYW1lJmd0OyBBREQKICAgICAqICZsdDtmayBj\nb25zIHNxbCAmZ3Q7PC9jb2RlPiBieSBkZWZhdWx0LgogICAgICovCiAgICBw\ndWJsaWMgU3RyaW5nW10gZ2V0QWRkRm9yZWlnbktleVNRTChGb3JlaWduS2V5\nIGZrKSB7CiAgICAgICAgU3RyaW5nIGZrU1FMID0gZ2V0Rm9yZWlnbktleUNv\nbnN0cmFpbnRTUUwoZmspOwogICAgICAgIGlmIChma1NRTCA9PSBudWxsKQog\nICAgICAgICAgICByZXR1cm4gbmV3IFN0cmluZ1swXTsKICAgICAgICByZXR1\ncm4gbmV3IFN0cmluZ1tdeyAiQUxURVIgVEFCTEUgIgogICAgICAgICAgICAr\nIGdldEZ1bGxOYW1lKGZrLmdldFRhYmxlKCksIGZhbHNlKSArICIgQUREICIg\nKyBma1NRTCB9OwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIGEgc2Vy\naWVzIG9mIFNRTCBzdGF0ZW1lbnRzIHRvIGRyb3AgdGhlIGdpdmVuIGZvcmVp\nZ24ga2V5IGZyb20KICAgICAqIGl0cyB0YWJsZS4gUmV0dXJuIGFuIGVtcHR5\nIGFycmF5IGlmIG9wZXJhdGlvbiBub3Qgc3VwcG9ydGVkLgogICAgICogUmV0\ndXJucyA8Y29kZT5BTFRFUiBUQUJMRSAmbHQ7dGFibGUgbmFtZSZndDsgRFJP\nUCBDT05TVFJBSU5UCiAgICAgKiAmbHQ7ZmsgbmFtZSZndDs8L2NvZGU+IGJ5\nIGRlZmF1bHQuCiAgICAgKi8KICAgIHB1YmxpYyBTdHJpbmdbXSBnZXREcm9w\nRm9yZWlnbktleVNRTChGb3JlaWduS2V5IGZrKSB7CiAgICAgICAgaWYgKGZr\nLmdldE5hbWUoKSA9PSBudWxsKQogICAgICAgICAgICByZXR1cm4gbmV3IFN0\ncmluZ1swXTsKICAgICAgICByZXR1cm4gbmV3IFN0cmluZ1tdeyAiQUxURVIg\nVEFCTEUgIgogICAgICAgICAgICArIGdldEZ1bGxOYW1lKGZrLmdldFRhYmxl\nKCksIGZhbHNlKQogICAgICAgICAgICArICIgRFJPUCBDT05TVFJBSU5UICIg\nKyBmay5nZXROYW1lKCkgfTsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVy\nbiB0aGUgZGVjbGFyYXRpb24gU1FMIGZvciB0aGUgZ2l2ZW4gY29sdW1uLiBU\naGlzIG1ldGhvZCBpcyB1c2VkCiAgICAgKiBmb3IgZWFjaCBjb2x1bW4gZnJv\nbSB3aXRoaW4ge0BsaW5rICNnZXRDcmVhdGVUYWJsZVNRTH0gYW5kCiAgICAg\nKiB7QGxpbmsgI2dldEFkZENvbHVtblNRTH0uCiAgICAgKi8KICAgIHByb3Rl\nY3RlZCBTdHJpbmcgZ2V0RGVjbGFyZUNvbHVtblNRTChDb2x1bW4gY29sLCBi\nb29sZWFuIGFsdGVyKSB7CiAgICAgICAgU3RyaW5nQnVmZmVyIGJ1ZiA9IG5l\ndyBTdHJpbmdCdWZmZXIoKTsKICAgICAgICBidWYuYXBwZW5kKGNvbCkuYXBw\nZW5kKCIgIik7CiAgICAgICAgYnVmLmFwcGVuZChnZXRUeXBlTmFtZShjb2wp\nKTsKCiAgICAgICAgLy8gY2FuJ3QgYWRkIGNvbnN0cmFpbnRzIHRvIGEgY29s\ndW1uIHdlJ3JlIGFkZGluZyBhZnRlciB0YWJsZQogICAgICAgIC8vIGNyZWF0\naW9uLCBjYXVzZSBzb21lIGRhdGEgbWlnaHQgYWxyZWFkeSBiZSBpbnNlcnRl\nZAogICAgICAgIGlmICghYWx0ZXIpIHsKICAgICAgICAgICAgaWYgKGNvbC5n\nZXREZWZhdWx0U3RyaW5nKCkgIT0gbnVsbCAmJiAhY29sLmlzQXV0b0Fzc2ln\nbmVkKCkpCiAgICAgICAgICAgICAgICBidWYuYXBwZW5kKCIgREVGQVVMVCAi\nKS5hcHBlbmQoY29sLmdldERlZmF1bHRTdHJpbmcoKSk7CiAgICAgICAgICAg\nIGlmIChjb2wuaXNOb3ROdWxsKCkpCiAgICAgICAgICAgICAgICBidWYuYXBw\nZW5kKCIgTk9UIE5VTEwiKTsKICAgICAgICB9CiAgICAgICAgaWYgKGNvbC5p\nc0F1dG9Bc3NpZ25lZCgpKSB7CiAgICAgICAgICAgIGlmICghc3VwcG9ydHNB\ndXRvQXNzaWduKQogICAgICAgICAgICAgICAgbG9nLndhcm4oX2xvYy5nZXQo\nImludmFsaWQtYXV0b2Fzc2lnbiIsIHBsYXRmb3JtLCBjb2wpKTsKICAgICAg\nICAgICAgZWxzZSBpZiAoYXV0b0Fzc2lnbkNsYXVzZSAhPSBudWxsKQogICAg\nICAgICAgICAgICAgYnVmLmFwcGVuZCgiICIpLmFwcGVuZChhdXRvQXNzaWdu\nQ2xhdXNlKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGJ1Zi50b1N0cmlu\nZygpOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRoZSBkZWNsYXJh\ndGlvbiBTUUwgZm9yIHRoZSBnaXZlbiBwcmltYXJ5IGtleS4gVGhpcyBtZXRo\nb2QgaXMKICAgICAqIHVzZWQgZnJvbSB3aXRoaW4ge0BsaW5rICNnZXRDcmVh\ndGVUYWJsZVNRTH0gYW5kCiAgICAgKiB7QGxpbmsgI2dldEFkZFByaW1hcnlL\nZXlTUUx9LiBSZXR1cm5zCiAgICAgKiA8Y29kZT5DT05TVFJBSU5UICZsdDtw\nayBuYW1lJmd0OyBQUklNQVJZIEtFWSAoJmx0O2NvbCBsaXN0Jmd0Oyk8L2Nv\nZGU+CiAgICAgKiBieSBkZWZhdWx0LgogICAgICovCiAgICBwcm90ZWN0ZWQg\nU3RyaW5nIGdldFByaW1hcnlLZXlDb25zdHJhaW50U1FMKFByaW1hcnlLZXkg\ncGspIHsKICAgICAgICAvLyBpZiB3ZSBoYXZlIGRpc2FibGVkIHRoZSBjcmVh\ndGlvbiBvZiBwcmltYXJ5IGtleXMsIGFib3J0IGhlcmUKICAgICAgICBpZiAo\nIWNyZWF0ZVByaW1hcnlLZXlzKQogICAgICAgICAgICByZXR1cm4gbnVsbDsK\nCiAgICAgICAgU3RyaW5nIG5hbWUgPSBway5nZXROYW1lKCk7CiAgICAgICAg\naWYgKG5hbWUgIT0gbnVsbCAmJiByZXNlcnZlZFdvcmRTZXQuY29udGFpbnMo\nbmFtZS50b1VwcGVyQ2FzZSgpKSkKICAgICAgICAgICAgbmFtZSA9IG51bGw7\nCgogICAgICAgIFN0cmluZ0J1ZmZlciBidWYgPSBuZXcgU3RyaW5nQnVmZmVy\nKCk7CiAgICAgICAgaWYgKG5hbWUgIT0gbnVsbCAmJiBDT05TX05BTUVfQkVG\nT1JFLmVxdWFscyhjb25zdHJhaW50TmFtZU1vZGUpKQogICAgICAgICAgICBi\ndWYuYXBwZW5kKCJDT05TVFJBSU5UICIpLmFwcGVuZChuYW1lKS5hcHBlbmQo\nIiAiKTsKICAgICAgICBidWYuYXBwZW5kKCJQUklNQVJZIEtFWSAiKTsKICAg\nICAgICBpZiAobmFtZSAhPSBudWxsICYmIENPTlNfTkFNRV9NSUQuZXF1YWxz\nKGNvbnN0cmFpbnROYW1lTW9kZSkpCiAgICAgICAgICAgIGJ1Zi5hcHBlbmQo\nbmFtZSkuYXBwZW5kKCIgIik7CiAgICAgICAgYnVmLmFwcGVuZCgiKCIpLmFw\ncGVuZChTdHJpbmdzLmpvaW4ocGsuZ2V0Q29sdW1ucygpLCAiLCAiKSkuCiAg\nICAgICAgICAgIGFwcGVuZCgiKSIpOwogICAgICAgIGlmIChuYW1lICE9IG51\nbGwgJiYgQ09OU19OQU1FX0FGVEVSLmVxdWFscyhjb25zdHJhaW50TmFtZU1v\nZGUpKQogICAgICAgICAgICBidWYuYXBwZW5kKCIgQ09OU1RSQUlOVCAiKS5h\ncHBlbmQobmFtZSk7CiAgICAgICAgcmV0dXJuIGJ1Zi50b1N0cmluZygpOwog\nICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRoZSBkZWNsYXJhdGlvbiBT\nUUwgZm9yIHRoZSBnaXZlbiBmb3JlaWduIGtleSwgb3IgbnVsbCBpZiBpdCBp\ncwogICAgICogbm90IHN1cHBvcnRlZC4gVGhpcyBtZXRob2QgaXMgdXNlZCBm\ncm9tIHdpdGhpbgogICAgICoge0BsaW5rICNnZXRDcmVhdGVUYWJsZVNRTH0g\nYW5kIHtAbGluayAjZ2V0QWRkRm9yZWlnbktleVNRTH0uIFJldHVybnMKICAg\nICAqIDxjb2RlPkNPTlNUUkFJTlQgJmx0O2NvbnMgbmFtZSZndDsgRk9SRUlH\nTiBLRVkgKCZsdDtjb2wgbGlzdCZndDspCiAgICAgKiBSRUZFUkVOQ0VTICZs\ndDtmb3JlaWduIHRhYmxlJmd0OyAoJmx0O2NvbCBsaXN0Jmd0OykKICAgICAq\nIFtPTiBERUxFVEUgJmx0O2FjdGlvbiZndDtdIFtPTiBVUERBVEUgJmx0O2Fj\ndGlvbiZndDtdPC9jb2RlPiBieSBkZWZhdWx0LgogICAgICovCiAgICBwcm90\nZWN0ZWQgU3RyaW5nIGdldEZvcmVpZ25LZXlDb25zdHJhaW50U1FMKEZvcmVp\nZ25LZXkgZmspIHsKICAgICAgICBpZiAoIXN1cHBvcnRzRm9yZWlnbktleXMp\nCiAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgIGlmIChmay5nZXRE\nZWxldGVBY3Rpb24oKSA9PSBGb3JlaWduS2V5LkFDVElPTl9OT05FKQogICAg\nICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICBpZiAoZmsuaXNEZWZlcnJl\nZCgpICYmICFzdXBwb3J0c0RlZmVycmVkRm9yZWlnbktleUNvbnN0cmFpbnRz\nKCkpCiAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgIGlmICghc3Vw\ncG9ydHNEZWxldGVBY3Rpb24oZmsuZ2V0RGVsZXRlQWN0aW9uKCkpCiAgICAg\nICAgICAgIHx8ICFzdXBwb3J0c1VwZGF0ZUFjdGlvbihmay5nZXRVcGRhdGVB\nY3Rpb24oKSkpCiAgICAgICAgICAgIHJldHVybiBudWxsOwoKICAgICAgICBD\nb2x1bW5bXSBsb2NhbHMgPSBmay5nZXRDb2x1bW5zKCk7CiAgICAgICAgQ29s\ndW1uW10gZm9yZWlnbnMgPSBmay5nZXRQcmltYXJ5S2V5Q29sdW1ucygpOwoK\nICAgICAgICBpbnQgZGVsQWN0aW9uSWQgPSBmay5nZXREZWxldGVBY3Rpb24o\nKTsKICAgICAgICBpZiAoZGVsQWN0aW9uSWQgPT0gRm9yZWlnbktleS5BQ1RJ\nT05fTlVMTCkgewogICAgICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGxv\nY2Fscy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgaWYgKGxvY2Fs\nc1tpXS5pc05vdE51bGwoKSkKICAgICAgICAgICAgICAgICAgICBkZWxBY3Rp\nb25JZCA9IEZvcmVpZ25LZXkuQUNUSU9OX05PTkU7CiAgICAgICAgICAgIH0K\nICAgICAgICB9CgogICAgICAgIFN0cmluZyBkZWxBY3Rpb24gPSBnZXRBY3Rp\nb25OYW1lKGRlbEFjdGlvbklkKTsKICAgICAgICBTdHJpbmcgdXBBY3Rpb24g\nPSBnZXRBY3Rpb25OYW1lKGZrLmdldFVwZGF0ZUFjdGlvbigpKTsKCiAgICAg\nICAgU3RyaW5nQnVmZmVyIGJ1ZiA9IG5ldyBTdHJpbmdCdWZmZXIoKTsKICAg\nICAgICBpZiAoZmsuZ2V0TmFtZSgpICE9IG51bGwKICAgICAgICAgICAgJiYg\nQ09OU19OQU1FX0JFRk9SRS5lcXVhbHMoY29uc3RyYWludE5hbWVNb2RlKSkK\nICAgICAgICAgICAgYnVmLmFwcGVuZCgiQ09OU1RSQUlOVCAiKS5hcHBlbmQo\nZmsuZ2V0TmFtZSgpKS5hcHBlbmQoIiAiKTsKICAgICAgICBidWYuYXBwZW5k\nKCJGT1JFSUdOIEtFWSAiKTsKICAgICAgICBpZiAoZmsuZ2V0TmFtZSgpICE9\nIG51bGwgJiYgQ09OU19OQU1FX01JRC5lcXVhbHMoY29uc3RyYWludE5hbWVN\nb2RlKSkKICAgICAgICAgICAgYnVmLmFwcGVuZChmay5nZXROYW1lKCkpLmFw\ncGVuZCgiICIpOwogICAgICAgIGJ1Zi5hcHBlbmQoIigiKS5hcHBlbmQoU3Ry\naW5ncy5qb2luKGxvY2FscywgIiwgIikpLmFwcGVuZCgiKSIpOwogICAgICAg\nIGJ1Zi5hcHBlbmQoIiBSRUZFUkVOQ0VTICIpOwogICAgICAgIGJ1Zi5hcHBl\nbmQoZ2V0RnVsbE5hbWUoZm9yZWlnbnNbMF0uZ2V0VGFibGUoKSwgZmFsc2Up\nKTsKICAgICAgICBidWYuYXBwZW5kKCIgKCIpLmFwcGVuZChTdHJpbmdzLmpv\naW4oZm9yZWlnbnMsICIsICIpKS5hcHBlbmQoIikiKTsKICAgICAgICBpZiAo\nZGVsQWN0aW9uICE9IG51bGwpCiAgICAgICAgICAgIGJ1Zi5hcHBlbmQoIiBP\nTiBERUxFVEUgIikuYXBwZW5kKGRlbEFjdGlvbik7CiAgICAgICAgaWYgKHVw\nQWN0aW9uICE9IG51bGwpCiAgICAgICAgICAgIGJ1Zi5hcHBlbmQoIiBPTiBV\nUERBVEUgIikuYXBwZW5kKHVwQWN0aW9uKTsKICAgICAgICBpZiAoZmsuaXNE\nZWZlcnJlZCgpKQogICAgICAgICAgICBidWYuYXBwZW5kKCIgSU5JVElBTExZ\nIERFRkVSUkVEIik7CiAgICAgICAgaWYgKHN1cHBvcnRzRGVmZXJyZWRGb3Jl\naWduS2V5Q29uc3RyYWludHMoKSkKICAgICAgICAgICAgYnVmLmFwcGVuZCgi\nIERFRkVSUkFCTEUiKTsKICAgICAgICBpZiAoZmsuZ2V0TmFtZSgpICE9IG51\nbGwKICAgICAgICAgICAgJiYgQ09OU19OQU1FX0FGVEVSLmVxdWFscyhjb25z\ndHJhaW50TmFtZU1vZGUpKQogICAgICAgICAgICBidWYuYXBwZW5kKCIgQ09O\nU1RSQUlOVCAiKS5hcHBlbmQoZmsuZ2V0TmFtZSgpKTsKICAgICAgICByZXR1\ncm4gYnVmLnRvU3RyaW5nKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBXaGV0\naGVyIG9yIG5vdCB0aGlzIGRpY3Rpb25hcnkgc3VwcG9ydHMgZGVmZXJyZWQg\nZm9yZWlnbiBrZXkgY29uc3RyYWludHMuCiAgICAgKiBUaGlzIGltcGxlbWVu\ndGF0aW9uIHJldHVybnMge0BsaW5rICNzdXBwb3J0c1VuaXF1ZUNvbnN0cmFp\nbnRzfS4KICAgICAqCiAgICAgKiBAc2luY2UgMS4xLjAKICAgICAqLwogICAg\ncHJvdGVjdGVkIGJvb2xlYW4gc3VwcG9ydHNEZWZlcnJlZEZvcmVpZ25LZXlD\nb25zdHJhaW50cygpIHsKICAgICAgICByZXR1cm4gc3VwcG9ydHNEZWZlcnJl\nZENvbnN0cmFpbnRzOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRo\nZSBuYW1lIG9mIHRoZSBnaXZlbiBmb3JlaWduIGtleSBhY3Rpb24uCiAgICAg\nKi8KICAgIHByaXZhdGUgU3RyaW5nIGdldEFjdGlvbk5hbWUoaW50IGFjdGlv\nbikgewogICAgICAgIHN3aXRjaCAoYWN0aW9uKSB7CiAgICAgICAgICAgIGNh\nc2UgRm9yZWlnbktleS5BQ1RJT05fQ0FTQ0FERToKICAgICAgICAgICAgICAg\nIHJldHVybiAiQ0FTQ0FERSI7CiAgICAgICAgICAgIGNhc2UgRm9yZWlnbktl\neS5BQ1RJT05fTlVMTDoKICAgICAgICAgICAgICAgIHJldHVybiAiU0VUIE5V\nTEwiOwogICAgICAgICAgICBjYXNlIEZvcmVpZ25LZXkuQUNUSU9OX0RFRkFV\nTFQ6CiAgICAgICAgICAgICAgICByZXR1cm4gIlNFVCBERUZBVUxUIjsKICAg\nICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAgIHJldHVybiBudWxs\nOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIFdoZXRoZXIgdGhp\ncyBkYXRhYmFzZSBzdXBwb3J0cyB0aGUgZ2l2ZW4gZm9yZWlnbiBrZXkgZGVs\nZXRlIGFjdGlvbi4KICAgICAqLwogICAgcHVibGljIGJvb2xlYW4gc3VwcG9y\ndHNEZWxldGVBY3Rpb24oaW50IGFjdGlvbikgewogICAgICAgIGlmIChhY3Rp\nb24gPT0gRm9yZWlnbktleS5BQ1RJT05fTk9ORSkKICAgICAgICAgICAgcmV0\ndXJuIHRydWU7CiAgICAgICAgaWYgKCFzdXBwb3J0c0ZvcmVpZ25LZXlzKQog\nICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgc3dpdGNoIChhY3Rp\nb24pIHsKICAgICAgICAgICAgY2FzZSBGb3JlaWduS2V5LkFDVElPTl9SRVNU\nUklDVDoKICAgICAgICAgICAgICAgIHJldHVybiBzdXBwb3J0c1Jlc3RyaWN0\nRGVsZXRlQWN0aW9uOwogICAgICAgICAgICBjYXNlIEZvcmVpZ25LZXkuQUNU\nSU9OX0NBU0NBREU6CiAgICAgICAgICAgICAgICByZXR1cm4gc3VwcG9ydHND\nYXNjYWRlRGVsZXRlQWN0aW9uOwogICAgICAgICAgICBjYXNlIEZvcmVpZ25L\nZXkuQUNUSU9OX05VTEw6CiAgICAgICAgICAgICAgICByZXR1cm4gc3VwcG9y\ndHNOdWxsRGVsZXRlQWN0aW9uOwogICAgICAgICAgICBjYXNlIEZvcmVpZ25L\nZXkuQUNUSU9OX0RFRkFVTFQ6CiAgICAgICAgICAgICAgICByZXR1cm4gc3Vw\ncG9ydHNEZWZhdWx0RGVsZXRlQWN0aW9uOwogICAgICAgICAgICBkZWZhdWx0\nOgogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAg\nIH0KCiAgICAvKioKICAgICAqIFdoZXRoZXIgdGhpcyBkYXRhYmFzZSBzdXBw\nb3J0cyB0aGUgZ2l2ZW4gZm9yZWlnbiBrZXkgdXBkYXRlIGFjdGlvbi4KICAg\nICAqLwogICAgcHVibGljIGJvb2xlYW4gc3VwcG9ydHNVcGRhdGVBY3Rpb24o\naW50IGFjdGlvbikgewogICAgICAgIGlmIChhY3Rpb24gPT0gRm9yZWlnbktl\neS5BQ1RJT05fTk9ORSkKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAg\nICAgaWYgKCFzdXBwb3J0c0ZvcmVpZ25LZXlzKQogICAgICAgICAgICByZXR1\ncm4gZmFsc2U7CiAgICAgICAgc3dpdGNoIChhY3Rpb24pIHsKICAgICAgICAg\nICAgY2FzZSBGb3JlaWduS2V5LkFDVElPTl9SRVNUUklDVDoKICAgICAgICAg\nICAgICAgIHJldHVybiBzdXBwb3J0c1Jlc3RyaWN0VXBkYXRlQWN0aW9uOwog\nICAgICAgICAgICBjYXNlIEZvcmVpZ25LZXkuQUNUSU9OX0NBU0NBREU6CiAg\nICAgICAgICAgICAgICByZXR1cm4gc3VwcG9ydHNDYXNjYWRlVXBkYXRlQWN0\naW9uOwogICAgICAgICAgICBjYXNlIEZvcmVpZ25LZXkuQUNUSU9OX05VTEw6\nCiAgICAgICAgICAgICAgICByZXR1cm4gc3VwcG9ydHNOdWxsVXBkYXRlQWN0\naW9uOwogICAgICAgICAgICBjYXNlIEZvcmVpZ25LZXkuQUNUSU9OX0RFRkFV\nTFQ6CiAgICAgICAgICAgICAgICByZXR1cm4gc3VwcG9ydHNEZWZhdWx0VXBk\nYXRlQWN0aW9uOwogICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAg\nICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAg\nICAqIFJldHVybiB0aGUgZGVjbGFyYXRpb24gU1FMIGZvciB0aGUgZ2l2ZW4g\ndW5pcXVlIGNvbnN0cmFpbnQuIFRoaXMKICAgICAqIG1ldGhvZCBpcyB1c2Vk\nIGZyb20gd2l0aGluIHtAbGluayAjZ2V0Q3JlYXRlVGFibGVTUUx9LgogICAg\nICogUmV0dXJucwk8Y29kZT5DT05TVFJBSU5UICZsdDtuYW1lJmd0OyBVTklR\nVUUgKCZsdDtjb2wgbGlzdCZndDspPC9jb2RlPgogICAgICogYnkgZGVmYXVs\ndC4KICAgICAqLwogICAgcHJvdGVjdGVkIFN0cmluZyBnZXRVbmlxdWVDb25z\ndHJhaW50U1FMKFVuaXF1ZSB1bnEpIHsKICAgICAgICBpZiAoIXN1cHBvcnRz\nVW5pcXVlQ29uc3RyYWludHMKICAgICAgICAgICAgfHwgKHVucS5pc0RlZmVy\ncmVkKCkgJiYgIXN1cHBvcnRzRGVmZXJyZWRVbmlxdWVDb25zdHJhaW50cygp\nKSkKICAgICAgICAgICAgcmV0dXJuIG51bGw7CgogICAgICAgIFN0cmluZ0J1\nZmZlciBidWYgPSBuZXcgU3RyaW5nQnVmZmVyKCk7CiAgICAgICAgaWYgKHVu\ncS5nZXROYW1lKCkgIT0gbnVsbAogICAgICAgICAgICAmJiBDT05TX05BTUVf\nQkVGT1JFLmVxdWFscyhjb25zdHJhaW50TmFtZU1vZGUpKQogICAgICAgICAg\nICBidWYuYXBwZW5kKCJDT05TVFJBSU5UICIpLmFwcGVuZCh1bnEuZ2V0TmFt\nZSgpKS5hcHBlbmQoIiAiKTsKICAgICAgICBidWYuYXBwZW5kKCJVTklRVUUg\nIik7CiAgICAgICAgaWYgKHVucS5nZXROYW1lKCkgIT0gbnVsbCAmJiBDT05T\nX05BTUVfTUlELmVxdWFscyhjb25zdHJhaW50TmFtZU1vZGUpKQogICAgICAg\nICAgICBidWYuYXBwZW5kKHVucS5nZXROYW1lKCkpLmFwcGVuZCgiICIpOwog\nICAgICAgIGJ1Zi5hcHBlbmQoIigiKS5hcHBlbmQoU3RyaW5ncy5qb2luKHVu\ncS5nZXRDb2x1bW5zKCksICIsICIpKS4KICAgICAgICAgICAgYXBwZW5kKCIp\nIik7CiAgICAgICAgaWYgKHVucS5pc0RlZmVycmVkKCkpCiAgICAgICAgICAg\nIGJ1Zi5hcHBlbmQoIiBJTklUSUFMTFkgREVGRVJSRUQiKTsKICAgICAgICBp\nZiAoc3VwcG9ydHNEZWZlcnJlZFVuaXF1ZUNvbnN0cmFpbnRzKCkpCiAgICAg\nICAgICAgIGJ1Zi5hcHBlbmQoIiBERUZFUlJBQkxFIik7CiAgICAgICAgaWYg\nKHVucS5nZXROYW1lKCkgIT0gbnVsbAogICAgICAgICAgICAmJiBDT05TX05B\nTUVfQUZURVIuZXF1YWxzKGNvbnN0cmFpbnROYW1lTW9kZSkpCiAgICAgICAg\nICAgIGJ1Zi5hcHBlbmQoIiBDT05TVFJBSU5UICIpLmFwcGVuZCh1bnEuZ2V0\nTmFtZSgpKTsKICAgICAgICByZXR1cm4gYnVmLnRvU3RyaW5nKCk7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBXaGV0aGVyIG9yIG5vdCB0aGlzIGRpY3Rpb25h\ncnkgc3VwcG9ydHMgZGVmZXJyZWQgdW5pcXVlIGNvbnN0cmFpbnRzLgogICAg\nICogVGhpcyBpbXBsZW1lbnRhdGlvbiByZXR1cm5zIHtAbGluayAjc3VwcG9y\ndHNVbmlxdWVDb25zdHJhaW50c30uCiAgICAgKgogICAgICogQHNpbmNlIDEu\nMS4wCiAgICAgKi8KICAgIHByb3RlY3RlZCBib29sZWFuIHN1cHBvcnRzRGVm\nZXJyZWRVbmlxdWVDb25zdHJhaW50cygpIHsKICAgICAgICByZXR1cm4gc3Vw\ncG9ydHNEZWZlcnJlZENvbnN0cmFpbnRzOwogICAgfQoKICAgIC8vLy8vLy8v\nLy8vLy8vLy8vLy8vLwogICAgLy8gRGF0YWJhc2UgbWV0YWRhdGEKICAgIC8v\nLy8vLy8vLy8vLy8vLy8vLy8vLwoKICAgIC8qKgogICAgICogVGhpcyBtZXRo\nb2QgaXMgdXNlZCB0byBmaWx0ZXIgc3lzdGVtIHRhYmxlcyBmcm9tIGRhdGFi\nYXNlIG1ldGFkYXRhLgogICAgICogUmV0dXJuIHRydWUgaWYgdGhlIGdpdmVu\nIHRhYmxlIG5hbWUgcmVwcmVzZW50cyBhIHN5c3RlbSB0YWJsZSB0aGF0CiAg\nICAgKiBzaG91bGQgbm90IGFwcGVhciBpbiB0aGUgc2NoZW1hIGRlZmluaXRp\nb24uIEJ5IGRlZmF1bHQsIHJldHVybnMKICAgICAqIHRydWUgb25seSBpZiB0\naGUgZ2l2ZW4gdGFibGUgaXMgaW4gdGhlIGludGVybmFsIGxpc3Qgb2Ygc3lz\ndGVtIHRhYmxlcywKICAgICAqIG9yIGlmIHRoZSBnaXZlbiBzY2hlbWEgaXMg\naW4gdGhlIGxpc3Qgb2Ygc3lzdGVtIHNjaGVtYXMgYW5kIGlzIG5vdAogICAg\nICogdGhlIHRhcmdldCBzY2hlbWEuCiAgICAgKgogICAgICogQHBhcmFtIG5h\nbWUgdGhlIHRhYmxlIG5hbWUKICAgICAqIEBwYXJhbSBzY2hlbWEgdGhlIHRh\nYmxlIHNjaGVtYTsgbWF5IGJlIG51bGwKICAgICAqIEBwYXJhbSB0YXJnZXRT\nY2hlbWEgaWYgdHJ1ZSwgdGhlbiB0aGUgZ2l2ZW4gc2NoZW1hIHdhcyBsaXN0\nZWQgYnkKICAgICAqIHRoZSB1c2VyIGFzIG9uZSBvZiBoaXMgc2NoZW1hcwog\nICAgICovCiAgICBwdWJsaWMgYm9vbGVhbiBpc1N5c3RlbVRhYmxlKFN0cmlu\nZyBuYW1lLCBTdHJpbmcgc2NoZW1hLAogICAgICAgIGJvb2xlYW4gdGFyZ2V0\nU2NoZW1hKSB7CiAgICAgICAgaWYgKHN5c3RlbVRhYmxlU2V0LmNvbnRhaW5z\nKG5hbWUudG9VcHBlckNhc2UoKSkpCiAgICAgICAgICAgIHJldHVybiB0cnVl\nOwogICAgICAgIHJldHVybiAhdGFyZ2V0U2NoZW1hICYmIHNjaGVtYSAhPSBu\ndWxsCiAgICAgICAgICAgICYmIHN5c3RlbVNjaGVtYVNldC5jb250YWlucyhz\nY2hlbWEudG9VcHBlckNhc2UoKSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBU\naGlzIG1ldGhvZCBpcyB1c2VkIHRvIGZpbHRlciBzeXN0ZW0gaW5kZXhlcyBm\ncm9tIGRhdGFiYXNlIG1ldGFkYXRhLgogICAgICogUmV0dXJuIHRydWUgaWYg\ndGhlIGdpdmVuIGluZGV4IG5hbWUgcmVwcmVzZW50cyBhIHN5c3RlbSBpbmRl\neCB0aGF0CiAgICAgKiBzaG91bGQgbm90IGFwcGVhciBpbiB0aGUgc2NoZW1h\nIGRlZmluaXRpb24uIFJldHVybnMgZmFsc2UgYnkgZGVmYXVsdC4KICAgICAq\nCiAgICAgKiBAcGFyYW0gbmFtZSB0aGUgaW5kZXggbmFtZQogICAgICogQHBh\ncmFtIHRhYmxlIHRoZSBpbmRleCB0YWJsZQogICAgICovCiAgICBwdWJsaWMg\nYm9vbGVhbiBpc1N5c3RlbUluZGV4KFN0cmluZyBuYW1lLCBUYWJsZSB0YWJs\nZSkgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICAvKioKICAg\nICAqIFRoaXMgbWV0aG9kIGlzIHVzZWQgdG8gZmlsdGVyIHN5c3RlbSBzZXF1\nZW5jZXMgZnJvbSBkYXRhYmFzZSBtZXRhZGF0YS4KICAgICAqIFJldHVybiB0\ncnVlIGlmIHRoZSBnaXZlbiBzZXF1ZW5jZSByZXByZXNlbnRzIGEgc3lzdGVt\nIHNlcXVlbmNlIHRoYXQKICAgICAqIHNob3VsZCBub3QgYXBwZWFyIGluIHRo\nZSBzY2hlbWEgZGVmaW5pdGlvbi4gUmV0dXJucyB0cnVlIGlmIHN5c3RlbQog\nICAgICogc2NoZW1hIGJ5IGRlZmF1bHQuCiAgICAgKgogICAgICogQHBhcmFt\nIG5hbWUgdGhlIHRhYmxlIG5hbWUKICAgICAqIEBwYXJhbSBzY2hlbWEgdGhl\nIHRhYmxlIHNjaGVtYTsgbWF5IGJlIG51bGwKICAgICAqIEBwYXJhbSB0YXJn\nZXRTY2hlbWEgaWYgdHJ1ZSwgdGhlbiB0aGUgZ2l2ZW4gc2NoZW1hIHdhcyBs\naXN0ZWQgYnkKICAgICAqIHRoZSB1c2VyIGFzIG9uZSBvZiBoaXMgc2NoZW1h\ncwogICAgICovCiAgICBwdWJsaWMgYm9vbGVhbiBpc1N5c3RlbVNlcXVlbmNl\nKFN0cmluZyBuYW1lLCBTdHJpbmcgc2NoZW1hLAogICAgICAgIGJvb2xlYW4g\ndGFyZ2V0U2NoZW1hKSB7CiAgICAgICAgcmV0dXJuICF0YXJnZXRTY2hlbWEg\nJiYgc2NoZW1hICE9IG51bGwKICAgICAgICAgICAgJiYgc3lzdGVtU2NoZW1h\nU2V0LmNvbnRhaW5zKHNjaGVtYS50b1VwcGVyQ2FzZSgpKTsKICAgIH0KCiAg\nICAvKioKICAgICAqIFJlZmxlY3Qgb24gdGhlIHNjaGVtYSB0byBmaW5kIHRh\nYmxlcyBtYXRjaGluZyB0aGUgZ2l2ZW4gbmFtZSBwYXR0ZXJuLgogICAgICov\nCiAgICBwdWJsaWMgVGFibGVbXSBnZXRUYWJsZXMoRGF0YWJhc2VNZXRhRGF0\nYSBtZXRhLCBTdHJpbmcgY2F0YWxvZywKICAgICAgICBTdHJpbmcgc2NoZW1h\nTmFtZSwgU3RyaW5nIHRhYmxlTmFtZSwgQ29ubmVjdGlvbiBjb25uKQogICAg\nICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIGlmICghc3VwcG9y\ndHNTY2hlbWFGb3JHZXRUYWJsZXMpCiAgICAgICAgICAgIHNjaGVtYU5hbWUg\nPSBudWxsOwogICAgICAgIGVsc2UKICAgICAgICAgICAgc2NoZW1hTmFtZSA9\nIGdldFNjaGVtYU5hbWVGb3JNZXRhZGF0YShzY2hlbWFOYW1lKTsKCiAgICAg\nICAgU3RyaW5nW10gdHlwZXMgPSBTdHJpbmdzLnNwbGl0KHRhYmxlVHlwZXMs\nICIsIiwgMCk7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCB0eXBlcy5s\nZW5ndGg7IGkrKykKICAgICAgICAgICAgdHlwZXNbaV0gPSB0eXBlc1tpXS50\ncmltKCk7CgogICAgICAgIGJlZm9yZU1ldGFkYXRhT3BlcmF0aW9uKGNvbm4p\nOwogICAgICAgIFJlc3VsdFNldCB0YWJsZXMgPSBudWxsOwogICAgICAgIHRy\neSB7CiAgICAgICAgICAgIHRhYmxlcyA9IG1ldGEuZ2V0VGFibGVzKGdldENh\ndGFsb2dOYW1lRm9yTWV0YWRhdGEoY2F0YWxvZyksCiAgICAgICAgICAgICAg\nICBzY2hlbWFOYW1lLCBnZXRUYWJsZU5hbWVGb3JNZXRhZGF0YSh0YWJsZU5h\nbWUpLCB0eXBlcyk7CiAgICAgICAgICAgIExpc3QgdGFibGVMaXN0ID0gbmV3\nIEFycmF5TGlzdCgpOwogICAgICAgICAgICB3aGlsZSAodGFibGVzICE9IG51\nbGwgJiYgdGFibGVzLm5leHQoKSkKICAgICAgICAgICAgICAgIHRhYmxlTGlz\ndC5hZGQobmV3VGFibGUodGFibGVzKSk7CiAgICAgICAgICAgIHJldHVybiAo\nVGFibGVbXSkgdGFibGVMaXN0LnRvQXJyYXkobmV3IFRhYmxlW3RhYmxlTGlz\ndC5zaXplKCldKTsKICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICBp\nZiAodGFibGVzICE9IG51bGwpCiAgICAgICAgICAgICAgICB0cnkgewogICAg\nICAgICAgICAgICAgICAgIHRhYmxlcy5jbG9zZSgpOwogICAgICAgICAgICAg\nICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgICAgIH0K\nICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBDcmVhdGUgYSBuZXcg\ndGFibGUgZnJvbSB0aGUgaW5mb3JtYXRpb24gaW4gdGhlIHNjaGVtYSBtZXRh\nZGF0YS4KICAgICAqLwogICAgcHJvdGVjdGVkIFRhYmxlIG5ld1RhYmxlKFJl\nc3VsdFNldCB0YWJsZU1ldGEpCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlv\nbiB7CiAgICAgICAgVGFibGUgdCA9IG5ldyBUYWJsZSgpOwogICAgICAgIHQu\nc2V0TmFtZSh0YWJsZU1ldGEuZ2V0U3RyaW5nKCJUQUJMRV9OQU1FIikpOwog\nICAgICAgIHJldHVybiB0OwogICAgfQoKICAgIC8qKgogICAgICogUmVmbGVj\ndCBvbiB0aGUgc2NoZW1hIHRvIGZpbmQgc2VxdWVuY2VzIG1hdGNoaW5nIHRo\nZSBnaXZlbiBuYW1lIHBhdHRlcm4uCiAgICAgKiBSZXR1cm5zIGFuIGVtcHR5\nIGFycmF5IGJ5IGRlZmF1bHQsIGFzIHRoZXJlIGlzIG5vIHN0YW5kYXJkIHdh\neSB0bwogICAgICogcmV0cmlldmUgYSBsaXN0IG9mIHNlcXVlbmNlcy4KICAg\nICAqLwogICAgcHVibGljIFNlcXVlbmNlW10gZ2V0U2VxdWVuY2VzKERhdGFi\nYXNlTWV0YURhdGEgbWV0YSwgU3RyaW5nIGNhdGFsb2csCiAgICAgICAgU3Ry\naW5nIHNjaGVtYU5hbWUsIFN0cmluZyBzZXF1ZW5jZU5hbWUsIENvbm5lY3Rp\nb24gY29ubikKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAg\nICBTdHJpbmcgc3RyID0gZ2V0U2VxdWVuY2VzU1FMKHNjaGVtYU5hbWUsIHNl\ncXVlbmNlTmFtZSk7CiAgICAgICAgaWYgKHN0ciA9PSBudWxsKQogICAgICAg\nICAgICByZXR1cm4gbmV3IFNlcXVlbmNlWzBdOwoKICAgICAgICBQcmVwYXJl\nZFN0YXRlbWVudCBzdG1udCA9IGNvbm4ucHJlcGFyZVN0YXRlbWVudChzdHIp\nOwogICAgICAgIFJlc3VsdFNldCBycyA9IG51bGw7CiAgICAgICAgdHJ5IHsK\nICAgICAgICAgICAgaW50IGlkeCA9IDE7CiAgICAgICAgICAgIGlmIChzY2hl\nbWFOYW1lICE9IG51bGwpCiAgICAgICAgICAgICAgICBzdG1udC5zZXRTdHJp\nbmcoaWR4KyssIHNjaGVtYU5hbWUudG9VcHBlckNhc2UoKSk7CiAgICAgICAg\nICAgIGlmIChzZXF1ZW5jZU5hbWUgIT0gbnVsbCkKICAgICAgICAgICAgICAg\nIHN0bW50LnNldFN0cmluZyhpZHgrKywgc2VxdWVuY2VOYW1lKTsKCiAgICAg\nICAgICAgIHJzID0gc3RtbnQuZXhlY3V0ZVF1ZXJ5KCk7CiAgICAgICAgICAg\nIExpc3Qgc2VxTGlzdCA9IG5ldyBBcnJheUxpc3QoKTsKICAgICAgICAgICAg\nd2hpbGUgKHJzLm5leHQoKSkKICAgICAgICAgICAgICAgIHNlcUxpc3QuYWRk\nKG5ld1NlcXVlbmNlKHJzKSk7CiAgICAgICAgICAgIHJldHVybiAoU2VxdWVu\nY2VbXSkgc2VxTGlzdC50b0FycmF5KG5ldyBTZXF1ZW5jZVtzZXFMaXN0LnNp\nemUoKV0pOwogICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgIGlmIChy\ncyAhPSBudWxsKQogICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAg\nICAgICAgICBycy5jbG9zZSgpOwogICAgICAgICAgICAgICAgfSBjYXRjaCAo\nU1FMRXhjZXB0aW9uIHNlKSB7CiAgICAgICAgICAgICAgICB9CiAgICAgICAg\nICAgIHRyeSB7CiAgICAgICAgICAgICAgICBzdG1udC5jbG9zZSgpOwogICAg\nICAgICAgICB9IGNhdGNoIChTUUxFeGNlcHRpb24gc2UpIHsKICAgICAgICAg\nICAgfQogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIENyZWF0ZSBh\nIG5ldyBzZXF1ZW5jZSBmcm9tIHRoZSBpbmZvcm1hdGlvbiBpbiB0aGUgc2No\nZW1hIG1ldGFkYXRhLgogICAgICovCiAgICBwcm90ZWN0ZWQgU2VxdWVuY2Ug\nbmV3U2VxdWVuY2UoUmVzdWx0U2V0IHNlcXVlbmNlTWV0YSkKICAgICAgICB0\naHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBTZXF1ZW5jZSBzZXEgPSBu\nZXcgU2VxdWVuY2UoKTsKICAgICAgICBzZXEuc2V0U2NoZW1hTmFtZShzZXF1\nZW5jZU1ldGEuZ2V0U3RyaW5nKCJTRVFVRU5DRV9TQ0hFTUEiKSk7CiAgICAg\nICAgc2VxLnNldE5hbWUoc2VxdWVuY2VNZXRhLmdldFN0cmluZygiU0VRVUVO\nQ0VfTkFNRSIpKTsKICAgICAgICByZXR1cm4gc2VxOwogICAgfQoKICAgIC8q\nKgogICAgICogUmV0dXJuIHRoZSBTUUwgbmVlZGVkIHRvIHNlbGVjdCB0aGUg\nbGlzdCBvZiBzZXF1ZW5jZXMuCiAgICAgKi8KICAgIHByb3RlY3RlZCBTdHJp\nbmcgZ2V0U2VxdWVuY2VzU1FMKFN0cmluZyBzY2hlbWFOYW1lLCBTdHJpbmcg\nc2VxdWVuY2VOYW1lKSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBSZWZsZWN0IG9uIHRoZSBzY2hlbWEgdG8gZmluZCBj\nb2x1bW5zIG1hdGNoaW5nIHRoZSBnaXZlbiB0YWJsZSBhbmQKICAgICAqIGNv\nbHVtbiBwYXR0ZXJucy4KICAgICAqLwogICAgcHVibGljIENvbHVtbltdIGdl\ndENvbHVtbnMoRGF0YWJhc2VNZXRhRGF0YSBtZXRhLCBTdHJpbmcgY2F0YWxv\nZywKICAgICAgICBTdHJpbmcgc2NoZW1hTmFtZSwgU3RyaW5nIHRhYmxlTmFt\nZSwgU3RyaW5nIGNvbHVtbk5hbWUsIENvbm5lY3Rpb24gY29ubikKICAgICAg\nICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBpZiAodGFibGVOYW1l\nID09IG51bGwgJiYgIXN1cHBvcnRzTnVsbFRhYmxlRm9yR2V0Q29sdW1ucykK\nICAgICAgICAgICAgcmV0dXJuIG51bGw7CgogICAgICAgIGlmICghc3VwcG9y\ndHNTY2hlbWFGb3JHZXRDb2x1bW5zKQogICAgICAgICAgICBzY2hlbWFOYW1l\nID0gbnVsbDsKICAgICAgICBlbHNlCiAgICAgICAgICAgIHNjaGVtYU5hbWUg\nPSBnZXRTY2hlbWFOYW1lRm9yTWV0YWRhdGEoc2NoZW1hTmFtZSk7CgogICAg\nICAgIGJlZm9yZU1ldGFkYXRhT3BlcmF0aW9uKGNvbm4pOwogICAgICAgIFJl\nc3VsdFNldCBjb2xzID0gbnVsbDsKICAgICAgICB0cnkgewogICAgICAgICAg\nICBjb2xzID0gbWV0YS5nZXRDb2x1bW5zKGdldENhdGFsb2dOYW1lRm9yTWV0\nYWRhdGEoY2F0YWxvZyksCiAgICAgICAgICAgICAgICBzY2hlbWFOYW1lLCBn\nZXRUYWJsZU5hbWVGb3JNZXRhZGF0YSh0YWJsZU5hbWUpLAogICAgICAgICAg\nICAgICAgZ2V0Q29sdW1uTmFtZUZvck1ldGFkYXRhKGNvbHVtbk5hbWUpKTsK\nCiAgICAgICAgICAgIExpc3QgY29sdW1uTGlzdCA9IG5ldyBBcnJheUxpc3Qo\nKTsKICAgICAgICAgICAgd2hpbGUgKGNvbHMgIT0gbnVsbCAmJiBjb2xzLm5l\neHQoKSkKICAgICAgICAgICAgICAgIGNvbHVtbkxpc3QuYWRkKG5ld0NvbHVt\nbihjb2xzKSk7CiAgICAgICAgICAgIHJldHVybiAoQ29sdW1uW10pIGNvbHVt\nbkxpc3QudG9BcnJheQogICAgICAgICAgICAgICAgKG5ldyBDb2x1bW5bY29s\ndW1uTGlzdC5zaXplKCldKTsKICAgICAgICB9IGZpbmFsbHkgewogICAgICAg\nICAgICBpZiAoY29scyAhPSBudWxsKQogICAgICAgICAgICAgICAgdHJ5IHsK\nICAgICAgICAgICAgICAgICAgICBjb2xzLmNsb3NlKCk7CiAgICAgICAgICAg\nICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkgewogICAgICAgICAgICAgICAg\nfQogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIENyZWF0ZSBhIG5l\ndyBjb2x1bW4gZnJvbSB0aGUgaW5mb3JtYXRpb24gaW4gdGhlIHNjaGVtYSBt\nZXRhZGF0YS4KICAgICAqLwogICAgcHJvdGVjdGVkIENvbHVtbiBuZXdDb2x1\nbW4oUmVzdWx0U2V0IGNvbE1ldGEpCiAgICAgICAgdGhyb3dzIFNRTEV4Y2Vw\ndGlvbiB7CiAgICAgICAgQ29sdW1uIGMgPSBuZXcgQ29sdW1uKCk7CiAgICAg\nICAgYy5zZXRTY2hlbWFOYW1lKGNvbE1ldGEuZ2V0U3RyaW5nKCJUQUJMRV9T\nQ0hFTSIpKTsKICAgICAgICBjLnNldFRhYmxlTmFtZShjb2xNZXRhLmdldFN0\ncmluZygiVEFCTEVfTkFNRSIpKTsKICAgICAgICBjLnNldE5hbWUoY29sTWV0\nYS5nZXRTdHJpbmcoIkNPTFVNTl9OQU1FIikpOwogICAgICAgIGMuc2V0VHlw\nZShjb2xNZXRhLmdldEludCgiREFUQV9UWVBFIikpOwogICAgICAgIGMuc2V0\nVHlwZU5hbWUoY29sTWV0YS5nZXRTdHJpbmcoIlRZUEVfTkFNRSIpKTsKICAg\nICAgICBjLnNldFNpemUoY29sTWV0YS5nZXRJbnQoIkNPTFVNTl9TSVpFIikp\nOwogICAgICAgIGMuc2V0RGVjaW1hbERpZ2l0cyhjb2xNZXRhLmdldEludCgi\nREVDSU1BTF9ESUdJVFMiKSk7CiAgICAgICAgYy5zZXROb3ROdWxsKGNvbE1l\ndGEuZ2V0SW50KCJOVUxMQUJMRSIpCiAgICAgICAgICAgID09IERhdGFiYXNl\nTWV0YURhdGEuY29sdW1uTm9OdWxscyk7CgogICAgICAgIFN0cmluZyBkZWYg\nPSBjb2xNZXRhLmdldFN0cmluZygiQ09MVU1OX0RFRiIpOwogICAgICAgIGlm\nICghU3RyaW5nVXRpbHMuaXNFbXB0eShkZWYpICYmICEibnVsbCIuZXF1YWxz\nSWdub3JlQ2FzZShkZWYpKQogICAgICAgICAgICBjLnNldERlZmF1bHRTdHJp\nbmcoZGVmKTsKICAgICAgICByZXR1cm4gYzsKICAgIH0KCiAgICAvKioKICAg\nICAqIFJlZmxlY3Qgb24gdGhlIHNjaGVtYSB0byBmaW5kIHByaW1hcnkga2V5\ncyBmb3IgdGhlIGdpdmVuIHRhYmxlIHBhdHRlcm4uCiAgICAgKi8KICAgIHB1\nYmxpYyBQcmltYXJ5S2V5W10gZ2V0UHJpbWFyeUtleXMoRGF0YWJhc2VNZXRh\nRGF0YSBtZXRhLAogICAgICAgIFN0cmluZyBjYXRhbG9nLCBTdHJpbmcgc2No\nZW1hTmFtZSwgU3RyaW5nIHRhYmxlTmFtZSwgQ29ubmVjdGlvbiBjb25uKQog\nICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIGlmICh1c2VH\nZXRCZXN0Um93SWRlbnRpZmllckZvclByaW1hcnlLZXlzKQogICAgICAgICAg\nICByZXR1cm4gZ2V0UHJpbWFyeUtleXNGcm9tQmVzdFJvd0lkZW50aWZpZXIo\nbWV0YSwgY2F0YWxvZywKICAgICAgICAgICAgICAgIHNjaGVtYU5hbWUsIHRh\nYmxlTmFtZSwgY29ubik7CiAgICAgICAgcmV0dXJuIGdldFByaW1hcnlLZXlz\nRnJvbUdldFByaW1hcnlLZXlzKG1ldGEsIGNhdGFsb2csCiAgICAgICAgICAg\nIHNjaGVtYU5hbWUsIHRhYmxlTmFtZSwgY29ubik7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBSZWZsZWN0IG9uIHRoZSBzY2hlbWEgdG8gZmluZCBwcmltYXJ5\nIGtleXMgZm9yIHRoZSBnaXZlbiB0YWJsZSBwYXR0ZXJuLgogICAgICovCiAg\nICBwcm90ZWN0ZWQgUHJpbWFyeUtleVtdIGdldFByaW1hcnlLZXlzRnJvbUdl\ndFByaW1hcnlLZXlzCiAgICAgICAgKERhdGFiYXNlTWV0YURhdGEgbWV0YSwg\nU3RyaW5nIGNhdGFsb2csIFN0cmluZyBzY2hlbWFOYW1lLAogICAgICAgICAg\nICBTdHJpbmcgdGFibGVOYW1lLCBDb25uZWN0aW9uIGNvbm4pCiAgICAgICAg\ndGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgaWYgKHRhYmxlTmFtZSA9\nPSBudWxsICYmICFzdXBwb3J0c051bGxUYWJsZUZvckdldFByaW1hcnlLZXlz\nKQogICAgICAgICAgICByZXR1cm4gbnVsbDsKCiAgICAgICAgYmVmb3JlTWV0\nYWRhdGFPcGVyYXRpb24oY29ubik7CiAgICAgICAgUmVzdWx0U2V0IHBrcyA9\nIG51bGw7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgcGtzID0gbWV0YS5n\nZXRQcmltYXJ5S2V5cyhnZXRDYXRhbG9nTmFtZUZvck1ldGFkYXRhKGNhdGFs\nb2cpLAogICAgICAgICAgICAgICAgZ2V0U2NoZW1hTmFtZUZvck1ldGFkYXRh\nKHNjaGVtYU5hbWUpLAogICAgICAgICAgICAgICAgZ2V0VGFibGVOYW1lRm9y\nTWV0YWRhdGEodGFibGVOYW1lKSk7CgogICAgICAgICAgICBMaXN0IHBrTGlz\ndCA9IG5ldyBBcnJheUxpc3QoKTsKICAgICAgICAgICAgd2hpbGUgKHBrcyAh\nPSBudWxsICYmIHBrcy5uZXh0KCkpCiAgICAgICAgICAgICAgICBwa0xpc3Qu\nYWRkKG5ld1ByaW1hcnlLZXkocGtzKSk7CiAgICAgICAgICAgIHJldHVybiAo\nUHJpbWFyeUtleVtdKSBwa0xpc3QudG9BcnJheQogICAgICAgICAgICAgICAg\nKG5ldyBQcmltYXJ5S2V5W3BrTGlzdC5zaXplKCldKTsKICAgICAgICB9IGZp\nbmFsbHkgewogICAgICAgICAgICBpZiAocGtzICE9IG51bGwpCiAgICAgICAg\nICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgIHBrcy5jbG9zZSgp\nOwogICAgICAgICAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAg\nICAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAg\nKiBDcmVhdGUgYSBuZXcgcHJpbWFyeSBrZXkgZnJvbSB0aGUgaW5mb3JtYXRp\nb24gaW4gdGhlIHNjaGVtYSBtZXRhZGF0YS4KICAgICAqLwogICAgcHJvdGVj\ndGVkIFByaW1hcnlLZXkgbmV3UHJpbWFyeUtleShSZXN1bHRTZXQgcGtNZXRh\nKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIFByaW1h\ncnlLZXkgcGsgPSBuZXcgUHJpbWFyeUtleSgpOwogICAgICAgIHBrLnNldFNj\naGVtYU5hbWUocGtNZXRhLmdldFN0cmluZygiVEFCTEVfU0NIRU0iKSk7CiAg\nICAgICAgcGsuc2V0VGFibGVOYW1lKHBrTWV0YS5nZXRTdHJpbmcoIlRBQkxF\nX05BTUUiKSk7CiAgICAgICAgcGsuc2V0Q29sdW1uTmFtZShwa01ldGEuZ2V0\nU3RyaW5nKCJDT0xVTU5fTkFNRSIpKTsKICAgICAgICBway5zZXROYW1lKHBr\nTWV0YS5nZXRTdHJpbmcoIlBLX05BTUUiKSk7CiAgICAgICAgcmV0dXJuIHBr\nOwogICAgfQoKICAgIC8qKgogICAgICogUmVmbGVjdCBvbiB0aGUgc2NoZW1h\nIHRvIGZpbmQgcHJpbWFyeSBrZXlzIGZvciB0aGUgZ2l2ZW4gdGFibGUgcGF0\ndGVybi4KICAgICAqLwogICAgcHJvdGVjdGVkIFByaW1hcnlLZXlbXSBnZXRQ\ncmltYXJ5S2V5c0Zyb21CZXN0Um93SWRlbnRpZmllcgogICAgICAgIChEYXRh\nYmFzZU1ldGFEYXRhIG1ldGEsIFN0cmluZyBjYXRhbG9nLCBTdHJpbmcgc2No\nZW1hTmFtZSwKICAgICAgICAgICAgU3RyaW5nIHRhYmxlTmFtZSwgQ29ubmVj\ndGlvbiBjb25uKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAg\nICAgIGlmICh0YWJsZU5hbWUgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJu\nIG51bGw7CgogICAgICAgIGJlZm9yZU1ldGFkYXRhT3BlcmF0aW9uKGNvbm4p\nOwogICAgICAgIFJlc3VsdFNldCBwa3MgPSBudWxsOwogICAgICAgIHRyeSB7\nCiAgICAgICAgICAgIHBrcyA9IG1ldGEuZ2V0QmVzdFJvd0lkZW50aWZpZXIo\nY2F0YWxvZywgc2NoZW1hTmFtZSwKICAgICAgICAgICAgICAgIHRhYmxlTmFt\nZSwgMCwgZmFsc2UpOwoKICAgICAgICAgICAgTGlzdCBwa0xpc3QgPSBuZXcg\nQXJyYXlMaXN0KCk7CiAgICAgICAgICAgIHdoaWxlIChwa3MgIT0gbnVsbCAm\nJiBwa3MubmV4dCgpKSB7CiAgICAgICAgICAgICAgICBQcmltYXJ5S2V5IHBr\nID0gbmV3IFByaW1hcnlLZXkoKTsKICAgICAgICAgICAgICAgIHBrLnNldFNj\naGVtYU5hbWUoc2NoZW1hTmFtZSk7CiAgICAgICAgICAgICAgICBway5zZXRU\nYWJsZU5hbWUodGFibGVOYW1lKTsKICAgICAgICAgICAgICAgIHBrLnNldENv\nbHVtbk5hbWUocGtzLmdldFN0cmluZygiQ09MVU1OX05BTUUiKSk7CiAgICAg\nICAgICAgICAgICBwa0xpc3QuYWRkKHBrKTsKICAgICAgICAgICAgfQogICAg\nICAgICAgICByZXR1cm4gKFByaW1hcnlLZXlbXSkgcGtMaXN0LnRvQXJyYXkK\nICAgICAgICAgICAgICAgIChuZXcgUHJpbWFyeUtleVtwa0xpc3Quc2l6ZSgp\nXSk7CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgaWYgKHBrcyAh\nPSBudWxsKQogICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAg\nICAgICBwa3MuY2xvc2UoKTsKICAgICAgICAgICAgICAgIH0gY2F0Y2ggKEV4\nY2VwdGlvbiBlKSB7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgfQogICAg\nfQoKICAgIC8qKgogICAgICogUmVmbGVjdCBvbiB0aGUgc2NoZW1hIHRvIGZp\nbmQgaW5kZXhlcyBtYXRjaGluZyB0aGUgZ2l2ZW4gdGFibGUgcGF0dGVybi4K\nICAgICAqLwogICAgcHVibGljIEluZGV4W10gZ2V0SW5kZXhJbmZvKERhdGFi\nYXNlTWV0YURhdGEgbWV0YSwgU3RyaW5nIGNhdGFsb2csCiAgICAgICAgU3Ry\naW5nIHNjaGVtYU5hbWUsIFN0cmluZyB0YWJsZU5hbWUsIGJvb2xlYW4gdW5p\ncXVlLAogICAgICAgIGJvb2xlYW4gYXBwcm94LCBDb25uZWN0aW9uIGNvbm4p\nCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgaWYgKHRh\nYmxlTmFtZSA9PSBudWxsICYmICFzdXBwb3J0c051bGxUYWJsZUZvckdldElu\nZGV4SW5mbykKICAgICAgICAgICAgcmV0dXJuIG51bGw7CgogICAgICAgIGJl\nZm9yZU1ldGFkYXRhT3BlcmF0aW9uKGNvbm4pOwogICAgICAgIFJlc3VsdFNl\ndCBpbmRleGVzID0gbnVsbDsKICAgICAgICB0cnkgewogICAgICAgICAgICBp\nbmRleGVzID0gbWV0YS5nZXRJbmRleEluZm8oZ2V0Q2F0YWxvZ05hbWVGb3JN\nZXRhZGF0YShjYXRhbG9nKSwKICAgICAgICAgICAgICAgIGdldFNjaGVtYU5h\nbWVGb3JNZXRhZGF0YShzY2hlbWFOYW1lKSwKICAgICAgICAgICAgICAgIGdl\ndFRhYmxlTmFtZUZvck1ldGFkYXRhKHRhYmxlTmFtZSksIHVuaXF1ZSwgYXBw\ncm94KTsKCiAgICAgICAgICAgIExpc3QgaW5kZXhMaXN0ID0gbmV3IEFycmF5\nTGlzdCgpOwogICAgICAgICAgICB3aGlsZSAoaW5kZXhlcyAhPSBudWxsICYm\nIGluZGV4ZXMubmV4dCgpKQogICAgICAgICAgICAgICAgaW5kZXhMaXN0LmFk\nZChuZXdJbmRleChpbmRleGVzKSk7CiAgICAgICAgICAgIHJldHVybiAoSW5k\nZXhbXSkgaW5kZXhMaXN0LnRvQXJyYXkobmV3IEluZGV4W2luZGV4TGlzdC5z\naXplKCldKTsKICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICBpZiAo\naW5kZXhlcyAhPSBudWxsKQogICAgICAgICAgICAgICAgdHJ5IHsKICAgICAg\nICAgICAgICAgICAgICBpbmRleGVzLmNsb3NlKCk7CiAgICAgICAgICAgICAg\nICB9IGNhdGNoIChFeGNlcHRpb24gZSkgewogICAgICAgICAgICAgICAgfQog\nICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIENyZWF0ZSBhIG5ldyBp\nbmRleCBmcm9tIHRoZSBpbmZvcm1hdGlvbiBpbiB0aGUgc2NoZW1hIG1ldGFk\nYXRhLgogICAgICovCiAgICBwcm90ZWN0ZWQgSW5kZXggbmV3SW5kZXgoUmVz\ndWx0U2V0IGlkeE1ldGEpCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7\nCiAgICAgICAgSW5kZXggaWR4ID0gbmV3IEluZGV4KCk7CiAgICAgICAgaWR4\nLnNldFNjaGVtYU5hbWUoaWR4TWV0YS5nZXRTdHJpbmcoIlRBQkxFX1NDSEVN\nIikpOwogICAgICAgIGlkeC5zZXRUYWJsZU5hbWUoaWR4TWV0YS5nZXRTdHJp\nbmcoIlRBQkxFX05BTUUiKSk7CiAgICAgICAgaWR4LnNldENvbHVtbk5hbWUo\naWR4TWV0YS5nZXRTdHJpbmcoIkNPTFVNTl9OQU1FIikpOwogICAgICAgIGlk\neC5zZXROYW1lKGlkeE1ldGEuZ2V0U3RyaW5nKCJJTkRFWF9OQU1FIikpOwog\nICAgICAgIGlkeC5zZXRVbmlxdWUoIWlkeE1ldGEuZ2V0Qm9vbGVhbigiTk9O\nX1VOSVFVRSIpKTsKICAgICAgICByZXR1cm4gaWR4OwogICAgfQoKICAgIC8q\nKgogICAgICogUmVmbGVjdCBvbiB0aGUgc2NoZW1hIHRvIHJldHVybiBmb3Jl\naWduIGtleXMgaW1wb3J0ZWQgYnkgdGhlIGdpdmVuCiAgICAgKiB0YWJsZSBw\nYXR0ZXJuLgogICAgICovCiAgICBwdWJsaWMgRm9yZWlnbktleVtdIGdldElt\ncG9ydGVkS2V5cyhEYXRhYmFzZU1ldGFEYXRhIG1ldGEsIFN0cmluZyBjYXRh\nbG9nLAogICAgICAgIFN0cmluZyBzY2hlbWFOYW1lLCBTdHJpbmcgdGFibGVO\nYW1lLCBDb25uZWN0aW9uIGNvbm4pCiAgICAgICAgdGhyb3dzIFNRTEV4Y2Vw\ndGlvbiB7CiAgICAgICAgaWYgKCFzdXBwb3J0c0ZvcmVpZ25LZXlzKQogICAg\nICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICBpZiAodGFibGVOYW1lID09\nIG51bGwgJiYgIXN1cHBvcnRzTnVsbFRhYmxlRm9yR2V0SW1wb3J0ZWRLZXlz\nKQogICAgICAgICAgICByZXR1cm4gbnVsbDsKCiAgICAgICAgYmVmb3JlTWV0\nYWRhdGFPcGVyYXRpb24oY29ubik7CiAgICAgICAgUmVzdWx0U2V0IGtleXMg\nPSBudWxsOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIGtleXMgPSBtZXRh\nLmdldEltcG9ydGVkS2V5cyhnZXRDYXRhbG9nTmFtZUZvck1ldGFkYXRhKGNh\ndGFsb2cpLAogICAgICAgICAgICAgICAgZ2V0U2NoZW1hTmFtZUZvck1ldGFk\nYXRhKHNjaGVtYU5hbWUpLAogICAgICAgICAgICAgICAgZ2V0VGFibGVOYW1l\nRm9yTWV0YWRhdGEodGFibGVOYW1lKSk7CgogICAgICAgICAgICBMaXN0IGlt\ncG9ydGVkS2V5TGlzdCA9IG5ldyBBcnJheUxpc3QoKTsKICAgICAgICAgICAg\nd2hpbGUgKGtleXMgIT0gbnVsbCAmJiBrZXlzLm5leHQoKSkKICAgICAgICAg\nICAgICAgIGltcG9ydGVkS2V5TGlzdC5hZGQobmV3Rm9yZWlnbktleShrZXlz\nKSk7CiAgICAgICAgICAgIHJldHVybiAoRm9yZWlnbktleVtdKSBpbXBvcnRl\nZEtleUxpc3QudG9BcnJheQogICAgICAgICAgICAgICAgKG5ldyBGb3JlaWdu\nS2V5W2ltcG9ydGVkS2V5TGlzdC5zaXplKCldKTsKICAgICAgICB9IGZpbmFs\nbHkgewogICAgICAgICAgICBpZiAoa2V5cyAhPSBudWxsKQogICAgICAgICAg\nICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICBrZXlzLmNsb3NlKCk7\nCiAgICAgICAgICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkgewogICAg\nICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAq\nIENyZWF0ZSBhIG5ldyBmb3JlaWduIGtleSBmcm9tIHRoZSBpbmZvcm1hdGlv\nbiBpbiB0aGUgc2NoZW1hIG1ldGFkYXRhLgogICAgICovCiAgICBwcm90ZWN0\nZWQgRm9yZWlnbktleSBuZXdGb3JlaWduS2V5KFJlc3VsdFNldCBma01ldGEp\nCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgRm9yZWln\nbktleSBmayA9IG5ldyBGb3JlaWduS2V5KCk7CiAgICAgICAgZmsuc2V0U2No\nZW1hTmFtZShma01ldGEuZ2V0U3RyaW5nKCJGS1RBQkxFX1NDSEVNIikpOwog\nICAgICAgIGZrLnNldFRhYmxlTmFtZShma01ldGEuZ2V0U3RyaW5nKCJGS1RB\nQkxFX05BTUUiKSk7CiAgICAgICAgZmsuc2V0Q29sdW1uTmFtZShma01ldGEu\nZ2V0U3RyaW5nKCJGS0NPTFVNTl9OQU1FIikpOwogICAgICAgIGZrLnNldE5h\nbWUoZmtNZXRhLmdldFN0cmluZygiRktfTkFNRSIpKTsKICAgICAgICBmay5z\nZXRQcmltYXJ5S2V5U2NoZW1hTmFtZShma01ldGEuZ2V0U3RyaW5nKCJQS1RB\nQkxFX1NDSEVNIikpOwogICAgICAgIGZrLnNldFByaW1hcnlLZXlUYWJsZU5h\nbWUoZmtNZXRhLmdldFN0cmluZygiUEtUQUJMRV9OQU1FIikpOwogICAgICAg\nIGZrLnNldFByaW1hcnlLZXlDb2x1bW5OYW1lKGZrTWV0YS5nZXRTdHJpbmco\nIlBLQ09MVU1OX05BTUUiKSk7CiAgICAgICAgZmsuc2V0S2V5U2VxdWVuY2Uo\nZmtNZXRhLmdldFNob3J0KCJLRVlfU0VRIikpOwogICAgICAgIGZrLnNldERl\nZmVycmVkKGZrTWV0YS5nZXRTaG9ydCgiREVGRVJSQUJJTElUWSIpCiAgICAg\nICAgICAgID09IERhdGFiYXNlTWV0YURhdGEuaW1wb3J0ZWRLZXlJbml0aWFs\nbHlEZWZlcnJlZCk7CgogICAgICAgIGludCBkZWwgPSBma01ldGEuZ2V0U2hv\ncnQoIkRFTEVURV9SVUxFIik7CiAgICAgICAgc3dpdGNoIChkZWwpIHsKICAg\nICAgICAgICAgY2FzZSBEYXRhYmFzZU1ldGFEYXRhLmltcG9ydGVkS2V5U2V0\nTnVsbDoKICAgICAgICAgICAgICAgIGZrLnNldERlbGV0ZUFjdGlvbihGb3Jl\naWduS2V5LkFDVElPTl9OVUxMKTsKICAgICAgICAgICAgICAgIGJyZWFrOwog\nICAgICAgICAgICBjYXNlIERhdGFiYXNlTWV0YURhdGEuaW1wb3J0ZWRLZXlT\nZXREZWZhdWx0OgogICAgICAgICAgICAgICAgZmsuc2V0RGVsZXRlQWN0aW9u\nKEZvcmVpZ25LZXkuQUNUSU9OX0RFRkFVTFQpOwogICAgICAgICAgICAgICAg\nYnJlYWs7CiAgICAgICAgICAgIGNhc2UgRGF0YWJhc2VNZXRhRGF0YS5pbXBv\ncnRlZEtleUNhc2NhZGU6CiAgICAgICAgICAgICAgICBmay5zZXREZWxldGVB\nY3Rpb24oRm9yZWlnbktleS5BQ1RJT05fQ0FTQ0FERSk7CiAgICAgICAgICAg\nICAgICBicmVhazsKICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAg\nICAgIGZrLnNldERlbGV0ZUFjdGlvbihGb3JlaWduS2V5LkFDVElPTl9SRVNU\nUklDVCk7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAg\nICAgcmV0dXJuIGZrOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJucyB0\naGUgdGFibGUgbmFtZSB0aGF0IHdpbGwgYmUgdXNlZCBmb3Igb2J0YWluaW5n\nIGluZm9ybWF0aW9uCiAgICAgKiBmcm9tIHtAbGluayBEYXRhYmFzZU1ldGFE\nYXRhfS4KICAgICAqLwogICAgcHJvdGVjdGVkIFN0cmluZyBnZXRUYWJsZU5h\nbWVGb3JNZXRhZGF0YShTdHJpbmcgdGFibGVOYW1lKSB7CiAgICAgICAgcmV0\ndXJuIGNvbnZlcnRTY2hlbWFDYXNlKHRhYmxlTmFtZSk7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBSZXR1cm5zIHRoZSBzY2hlbWEgbmFtZSB0aGF0IHdpbGwg\nYmUgdXNlZCBmb3Igb2J0YWluaW5nIGluZm9ybWF0aW9uCiAgICAgKiBmcm9t\nIHtAbGluayBEYXRhYmFzZU1ldGFEYXRhfS4KICAgICAqLwogICAgcHJvdGVj\ndGVkIFN0cmluZyBnZXRTY2hlbWFOYW1lRm9yTWV0YWRhdGEoU3RyaW5nIHNj\naGVtYU5hbWUpIHsKICAgICAgICBpZiAoc2NoZW1hTmFtZSA9PSBudWxsKQog\nICAgICAgICAgICBzY2hlbWFOYW1lID0gY29uZi5nZXRTY2hlbWEoKTsKICAg\nICAgICByZXR1cm4gY29udmVydFNjaGVtYUNhc2Uoc2NoZW1hTmFtZSk7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm5zIHRoZSBjYXRhbG9nIG5hbWUg\ndGhhdCB3aWxsIGJlIHVzZWQgZm9yIG9idGFpbmluZyBpbmZvcm1hdGlvbgog\nICAgICogZnJvbSB7QGxpbmsgRGF0YWJhc2VNZXRhRGF0YX0uCiAgICAgKi8K\nICAgIHByb3RlY3RlZCBTdHJpbmcgZ2V0Q2F0YWxvZ05hbWVGb3JNZXRhZGF0\nYShTdHJpbmcgY2F0YWxvZ05hbWUpIHsKICAgICAgICByZXR1cm4gY29udmVy\ndFNjaGVtYUNhc2UoY2F0YWxvZ05hbWUpOwogICAgfQoKICAgIC8qKgogICAg\nICogUmV0dXJucyB0aGUgY29sdW1uIG5hbWUgdGhhdCB3aWxsIGJlIHVzZWQg\nZm9yIG9idGFpbmluZyBpbmZvcm1hdGlvbgogICAgICogZnJvbSB7QGxpbmsg\nRGF0YWJhc2VNZXRhRGF0YX0uCiAgICAgKi8KICAgIHByb3RlY3RlZCBTdHJp\nbmcgZ2V0Q29sdW1uTmFtZUZvck1ldGFkYXRhKFN0cmluZyBjb2x1bW5OYW1l\nKSB7CiAgICAgICAgcmV0dXJuIGNvbnZlcnRTY2hlbWFDYXNlKGNvbHVtbk5h\nbWUpOwogICAgfQoKICAgIC8qKgogICAgICogQ29udmVydCB0aGUgc3BlY2lm\naWVkIHNjaGVtYSBuYW1lIHRvIGEgbmFtZSB0aGF0IHRoZSBkYXRhYmFzZSB3\naWxsCiAgICAgKiBiZSBhYmxlIHRvIHVuZGVyc3RhbmQuCiAgICAgKi8KICAg\nIHByb3RlY3RlZCBTdHJpbmcgY29udmVydFNjaGVtYUNhc2UoU3RyaW5nIG9i\namVjdE5hbWUpIHsKICAgICAgICBpZiAob2JqZWN0TmFtZSA9PSBudWxsKQog\nICAgICAgICAgICByZXR1cm4gbnVsbDsKCiAgICAgICAgU3RyaW5nIHNjYXNl\nID0gZ2V0U2NoZW1hQ2FzZSgpOwogICAgICAgIGlmIChTQ0hFTUFfQ0FTRV9M\nT1dFUi5lcXVhbHMoc2Nhc2UpKQogICAgICAgICAgICByZXR1cm4gb2JqZWN0\nTmFtZS50b0xvd2VyQ2FzZSgpOwogICAgICAgIGlmIChTQ0hFTUFfQ0FTRV9Q\nUkVTRVJWRS5lcXVhbHMoc2Nhc2UpKQogICAgICAgICAgICByZXR1cm4gb2Jq\nZWN0TmFtZTsKICAgICAgICByZXR1cm4gb2JqZWN0TmFtZS50b1VwcGVyQ2Fz\nZSgpOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIERCIHNwZWNpZmlj\nIHNjaGVtYUNhc2UgCiAgICAgKi8KICAgIHB1YmxpYyBTdHJpbmcgZ2V0U2No\nZW1hQ2FzZSgpewogICAgICAgIHJldHVybiBzY2hlbWFDYXNlOwogICAgfQog\nICAgCiAgICAvKioKICAgICAqIFByZXBhcmVkIHRoZSBjb25uZWN0aW9uIGZv\nciBtZXRhZGF0YSBvcGVyYXRpb25zLgogICAgICovCiAgICBwcml2YXRlIHZv\naWQgYmVmb3JlTWV0YWRhdGFPcGVyYXRpb24oQ29ubmVjdGlvbiBjKSB7CiAg\nICAgICAgaWYgKHJlcXVpcmVzQXV0b0NvbW1pdEZvck1ldGFEYXRhKSB7CiAg\nICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBjLnJvbGxiYWNrKCk7\nCiAgICAgICAgICAgIH0gY2F0Y2ggKFNRTEV4Y2VwdGlvbiBzcWxlKSB7CiAg\nICAgICAgICAgIH0KICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAg\nIGlmICghYy5nZXRBdXRvQ29tbWl0KCkpCiAgICAgICAgICAgICAgICAgICAg\nYy5zZXRBdXRvQ29tbWl0KHRydWUpOwogICAgICAgICAgICB9IGNhdGNoIChT\nUUxFeGNlcHRpb24gc3FsZSkgewogICAgICAgICAgICB9CiAgICAgICAgfQog\nICAgfQoKICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgICAv\nLyBTZXF1ZW5jZXMgYW5kIEF1dG8tQXNzaWduCiAgICAvLy8vLy8vLy8vLy8v\nLy8vLy8vLy8vLy8vLy8vLwoKICAgIC8qKgogICAgICogUmV0dXJuIHRoZSBs\nYXN0IGdlbmVyYXRlZCB2YWx1ZSBmb3IgdGhlIGdpdmVuIGNvbHVtbi4KICAg\nICAqIFRocm93cyBhbiBleGNlcHRpb24gYnkgZGVmYXVsdCBpZiB7QGxpbmsg\nI2xhc3RHZW5lcmF0ZWRLZXlRdWVyeX0gaXMgbnVsbC4KICAgICAqLwogICAg\ncHVibGljIE9iamVjdCBnZXRHZW5lcmF0ZWRLZXkoQ29sdW1uIGNvbCwgQ29u\nbmVjdGlvbiBjb25uKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewog\nICAgICAgIGlmIChsYXN0R2VuZXJhdGVkS2V5UXVlcnkgPT0gbnVsbCkKICAg\nICAgICAgICAgdGhyb3cgbmV3IFN0b3JlRXhjZXB0aW9uKF9sb2MuZ2V0KCJu\nby1hdXRvLWFzc2lnbiIpKTsKCiAgICAgICAgLy8gcmVwbGFjZSB0aGluZ3Mg\nbGlrZSAiU0VMRUNUIE1BWCh7MH0pIEZST00gezF9IgogICAgICAgIFN0cmlu\nZyBxdWVyeSA9IGxhc3RHZW5lcmF0ZWRLZXlRdWVyeTsKICAgICAgICBpZiAo\ncXVlcnkuaW5kZXhPZigneycpICE9IC0xKSAvLyBvbmx5IGlmIHRoZSB0b2tl\nbiBpcyBpbiB0aGUgc3RyaW5nCiAgICAgICAgewogICAgICAgICAgICBxdWVy\neSA9IE1lc3NhZ2VGb3JtYXQuZm9ybWF0KHF1ZXJ5LCBuZXcgT2JqZWN0W117\nCiAgICAgICAgICAgICAgICBjb2wuZ2V0TmFtZSgpLCBnZXRGdWxsTmFtZShj\nb2wuZ2V0VGFibGUoKSwgZmFsc2UpLAogICAgICAgICAgICAgICAgZ2V0R2Vu\nZXJhdGVkS2V5U2VxdWVuY2VOYW1lKGNvbCksCiAgICAgICAgICAgIH0pOwog\nICAgICAgIH0KCiAgICAgICAgUHJlcGFyZWRTdGF0ZW1lbnQgc3RtbnQgPSBj\nb25uLnByZXBhcmVTdGF0ZW1lbnQocXVlcnkpOwogICAgICAgIFJlc3VsdFNl\ndCBycyA9IG51bGw7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgcnMgPSBz\ndG1udC5leGVjdXRlUXVlcnkoKTsKICAgICAgICAgICAgaWYgKCFycy5uZXh0\nKCkpCiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgU3RvcmVFeGNlcHRpb24o\nX2xvYy5nZXQoIm5vLWdlbmtleSIpKTsKICAgICAgICAgICAgT2JqZWN0IGtl\neSA9IHJzLmdldE9iamVjdCgxKTsKICAgICAgICAgICAgaWYgKGtleSA9PSBu\ndWxsKQogICAgICAgICAgICAgICAgbG9nLndhcm4oX2xvYy5nZXQoImludmFs\naWQtZ2Vua2V5IiwgY29sKSk7CiAgICAgICAgICAgIHJldHVybiBrZXk7CiAg\nICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgaWYgKHJzICE9IG51bGwp\nCiAgICAgICAgICAgICAgICB0cnkgeyBycy5jbG9zZSgpOyB9IGNhdGNoIChT\nUUxFeGNlcHRpb24gc2UpIHt9CiAgICAgICAgICAgIHRyeSB7IHN0bW50LmNs\nb3NlKCk7IH0gY2F0Y2ggKFNRTEV4Y2VwdGlvbiBzZSkge30gCiAgICAgICAg\nfQogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRoZSBzZXF1ZW5jZSBu\nYW1lIHVzZWQgYnkgZGF0YWJhc2VzIGZvciB0aGUgZ2l2ZW4gYXV0b2Fzc2ln\nbmVkCiAgICAgKiBjb2x1bW4uIFRoaXMgaXMgb25seSB1c2VkIGJ5IGRhdGFi\nYXNlcyB0aGF0IHJlcXVpcmUgYW4gZXhwbGljaXQgbmFtZQogICAgICogdG8g\nYmUgdXNlZCBmb3IgYXV0by1hc3NpZ24gc3VwcG9ydC4KICAgICAqLwogICAg\ncHJvdGVjdGVkIFN0cmluZyBnZXRHZW5lcmF0ZWRLZXlTZXF1ZW5jZU5hbWUo\nQ29sdW1uIGNvbCkgewogICAgICAgIFN0cmluZyB0bmFtZSA9IGNvbC5nZXRU\nYWJsZU5hbWUoKTsKICAgICAgICBTdHJpbmcgY25hbWUgPSBjb2wuZ2V0TmFt\nZSgpOwogICAgICAgIGludCBtYXggPSBtYXhBdXRvQXNzaWduTmFtZUxlbmd0\naDsKICAgICAgICBpbnQgZXh0cmFDaGFycyA9IC1tYXggKyB0bmFtZS5sZW5n\ndGgoKSArIDEgLy8gPHRuYW1lPiArICdfJwogICAgICAgICAgICArIGNuYW1l\nLmxlbmd0aCgpICsgNDsgLy8gPGNuYW1lPiArICdfU0VRJwogICAgICAgIGlm\nIChleHRyYUNoYXJzID4gMCkgewogICAgICAgICAgICAvLyB0aGlzIGFzc3Vt\nZXMgdGhhdCB0bmFtZSBpcyBsb25nZXIgdGhhbiBleHRyYUNoYXJzCiAgICAg\nICAgICAgIHRuYW1lID0gdG5hbWUuc3Vic3RyaW5nKDAsIHRuYW1lLmxlbmd0\naCgpIC0gZXh0cmFDaGFycyk7CiAgICAgICAgfQogICAgICAgIFN0cmluZ0J1\nZmZlciBidWYgPSBuZXcgU3RyaW5nQnVmZmVyKG1heCk7CiAgICAgICAgYnVm\nLmFwcGVuZCh0bmFtZSkuYXBwZW5kKCJfIikuYXBwZW5kKGNuYW1lKS5hcHBl\nbmQoIl9TRVEiKTsKICAgICAgICByZXR1cm4gYnVmLnRvU3RyaW5nKCk7CiAg\nICB9CgogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwogICAg\nLy8gQ29uZmlndXJhYmxlIGltcGxlbWVudGF0aW9uCiAgICAvLy8vLy8vLy8v\nLy8vLy8vLy8vLy8vLy8vLy8vLy8vCgogICAgcHVibGljIHZvaWQgc2V0Q29u\nZmlndXJhdGlvbihDb25maWd1cmF0aW9uIGNvbmYpIHsKICAgICAgICB0aGlz\nLmNvbmYgPSAoSkRCQ0NvbmZpZ3VyYXRpb24pIGNvbmY7CiAgICAgICAgdGhp\ncy5sb2cgPSB0aGlzLmNvbmYuZ2V0TG9nKEpEQkNDb25maWd1cmF0aW9uLkxP\nR19KREJDKTsKCiAgICAgICAgLy8gd2FybiBhYm91dCB1bnN1cHBvcnRlZCBk\naWN0cwogICAgICAgIGlmIChsb2cuaXNXYXJuRW5hYmxlZCgpICYmICFpc1N1\ncHBvcnRlZCgpKQogICAgICAgICAgICBsb2cud2FybihfbG9jLmdldCgiZGlj\ndC1ub3Qtc3VwcG9ydGVkIiwgZ2V0Q2xhc3MoKSkpOwogICAgfQoKICAgIHBy\naXZhdGUgYm9vbGVhbiBpc1N1cHBvcnRlZCgpIHsKICAgICAgICAvLyBpZiB0\naGlzIGlzIGEgY3VzdG9tIGRpY3QsIHRyYXZlcnNlIHRvIHdoYXRldmVyIG9w\nZW5qcGEgZGljdCBpdCBleHRlbmRzCiAgICAgICAgQ2xhc3MgYyA9IGdldENs\nYXNzKCk7CiAgICAgICAgd2hpbGUgKCFjLmdldE5hbWUoKS5zdGFydHNXaXRo\nKCJvcmcuYXBhY2hlLm9wZW5qcGEuIikpCiAgICAgICAgICAgIGMgPSBjLmdl\ndFN1cGVyY2xhc3MoKTsKCiAgICAgICAgLy8gdGhlIGdlbmVyaWMgZGJkaWN0\naW9uYXJ5IGlzIG5vdCBjb25zaWRlcmVkIGEgc3VwcG9ydGVkIGRpY3Q7IGFs\nbAogICAgICAgIC8vIG90aGVyIGNvbmNyZXRlIGRpY3Rpb25hcmllcyBhcmUK\nICAgICAgICBpZiAoYyA9PSBEQkRpY3Rpb25hcnkuY2xhc3MpCiAgICAgICAg\nICAgIHJldHVybiBmYWxzZTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0K\nCiAgICBwdWJsaWMgdm9pZCBzdGFydENvbmZpZ3VyYXRpb24oKSB7CiAgICB9\nCgogICAgcHVibGljIHZvaWQgZW5kQ29uZmlndXJhdGlvbigpIHsKICAgICAg\nICAvLyBpbml0aWFsaXplIHRoZSBzZXQgb2YgcmVzZXJ2ZWQgU1FMOTIgd29y\nZHMgZnJvbSByZXNvdXJjZQogICAgICAgIElucHV0U3RyZWFtIGluID0gREJE\naWN0aW9uYXJ5LmNsYXNzLmdldFJlc291cmNlQXNTdHJlYW0KICAgICAgICAg\nICAgKCJzcWwta2V5d29yZHMucnNyYyIpOwogICAgICAgIHRyeSB7CiAgICAg\nICAgICAgIFN0cmluZyBrZXl3b3JkcyA9IG5ldyBCdWZmZXJlZFJlYWRlcihu\nZXcgSW5wdXRTdHJlYW1SZWFkZXIoaW4pKS4KICAgICAgICAgICAgICAgIHJl\nYWRMaW5lKCk7CiAgICAgICAgICAgIGluLmNsb3NlKCk7CiAgICAgICAgICAg\nIHJlc2VydmVkV29yZFNldC5hZGRBbGwoQXJyYXlzLmFzTGlzdChTdHJpbmdz\nLnNwbGl0CiAgICAgICAgICAgICAgICAoa2V5d29yZHMsICIsIiwgMCkpKTsK\nICAgICAgICB9IGNhdGNoIChJT0V4Y2VwdGlvbiBpb2UpIHsKICAgICAgICAg\nICAgdGhyb3cgbmV3IEdlbmVyYWxFeGNlcHRpb24oaW9lKTsKICAgICAgICB9\nIGZpbmFsbHkgewogICAgICAgICAgICB0cnkgeyBpbi5jbG9zZSgpOyB9IGNh\ndGNoIChJT0V4Y2VwdGlvbiBlKSB7fQogICAgICAgIH0KCiAgICAgICAgLy8g\nYWRkIGFkZGl0aW9uYWwgcmVzZXJ2ZWQgd29yZHMgc2V0IGJ5IHVzZXIKICAg\nICAgICBpZiAocmVzZXJ2ZWRXb3JkcyAhPSBudWxsKQogICAgICAgICAgICBy\nZXNlcnZlZFdvcmRTZXQuYWRkQWxsKEFycmF5cy5hc0xpc3QoU3RyaW5ncy5z\ncGxpdAogICAgICAgICAgICAgICAgKHJlc2VydmVkV29yZHMudG9VcHBlckNh\nc2UoKSwgIiwiLCAwKSkpOwoKICAgICAgICAvLyBhZGQgc3lzdGVtIHNjaGVt\nYXMgc2V0IGJ5IHVzZXIKICAgICAgICBpZiAoc3lzdGVtU2NoZW1hcyAhPSBu\ndWxsKQogICAgICAgICAgICBzeXN0ZW1TY2hlbWFTZXQuYWRkQWxsKEFycmF5\ncy5hc0xpc3QoU3RyaW5ncy5zcGxpdAogICAgICAgICAgICAgICAgKHN5c3Rl\nbVNjaGVtYXMudG9VcHBlckNhc2UoKSwgIiwiLCAwKSkpOwoKICAgICAgICAv\nLyBhZGQgc3lzdGVtIHRhYmxlcyBzZXQgYnkgdXNlcgogICAgICAgIGlmIChz\neXN0ZW1UYWJsZXMgIT0gbnVsbCkKICAgICAgICAgICAgc3lzdGVtVGFibGVT\nZXQuYWRkQWxsKEFycmF5cy5hc0xpc3QoU3RyaW5ncy5zcGxpdAogICAgICAg\nICAgICAgICAgKHN5c3RlbVRhYmxlcy50b1VwcGVyQ2FzZSgpLCAiLCIsIDAp\nKSk7CgogICAgICAgIC8vIGFkZCBmaXhlZCBzaXplIHR5cGUgbmFtZXMgc2V0\nIGJ5IHRoZSB1c2VyCiAgICAgICAgaWYgKGZpeGVkU2l6ZVR5cGVOYW1lcyAh\nPSBudWxsKQogICAgICAgICAgICBmaXhlZFNpemVUeXBlTmFtZVNldC5hZGRB\nbGwoQXJyYXlzLmFzTGlzdChTdHJpbmdzLnNwbGl0CiAgICAgICAgICAgICAg\nICAoZml4ZWRTaXplVHlwZU5hbWVzLnRvVXBwZXJDYXNlKCksICIsIiwgMCkp\nKTsKCiAgICAgICAgLy8gaWYgdXNlciBoYXMgdW5zZXQgc2VxdWVuY2Ugc3Fs\nLCBudWxsIGl0IG91dCBzbyB3ZSBrbm93IHNlcXVlbmNlcwogICAgICAgIC8v\nIGFyZW4ndCBzdXBwb3J0ZWQKICAgICAgICBuZXh0U2VxdWVuY2VRdWVyeSA9\nIFN0cmluZ1V0aWxzLnRyaW1Ub051bGwobmV4dFNlcXVlbmNlUXVlcnkpOwog\nICAgfQoKICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v\nLy8vCiAgICAvLyBDb25uZWN0aW9uRGVjb3JhdG9yIGltcGxlbWVudGF0aW9u\nCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwoK\nICAgIC8qKgogICAgICogRGVjb3JhdGUgdGhlIGdpdmVuIGNvbm5lY3Rpb24g\naWYgbmVlZGVkLiBTb21lIGRhdGFiYXNlcyByZXF1aXJlIHNwZWNpYWwKICAg\nICAqIGhhbmRsaW5nIGZvciBKREJDIGJ1Z3MuIFRoaXMgaW1wbGVtZW50YXRp\nb24gaXNzdWVzIGFueQogICAgICoge0BsaW5rICNpbml0aWFsaXphdGlvblNR\nTH0gdGhhdCBoYXMgYmVlbiBzZXQgZm9yIHRoZSBkaWN0aW9uYXJ5IGJ1dAog\nICAgICogZG9lcyBub3QgZGVjb3JlYXRlIHRoZSBjb25uZWN0aW9uLgogICAg\nICovCiAgICBwdWJsaWMgQ29ubmVjdGlvbiBkZWNvcmF0ZShDb25uZWN0aW9u\nIGNvbm4pCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAg\naWYgKCFjb25uZWN0ZWQpCiAgICAgICAgICAgIGNvbm5lY3RlZENvbmZpZ3Vy\nYXRpb24oY29ubik7CiAgICAgICAgaWYgKCFTdHJpbmdVdGlscy5pc0VtcHR5\nKGluaXRpYWxpemF0aW9uU1FMKSkgewogICAgICAgICAgICBQcmVwYXJlZFN0\nYXRlbWVudCBzdG1udCA9IG51bGw7CiAgICAgICAgICAgIHRyeSB7CiAgICAg\nICAgICAgICAgICBzdG1udCA9IGNvbm4ucHJlcGFyZVN0YXRlbWVudChpbml0\naWFsaXphdGlvblNRTCk7CiAgICAgICAgICAgICAgICBzdG1udC5leGVjdXRl\nKCk7CiAgICAgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAg\nICAgICAgICAgICBpZiAobG9nLmlzVHJhY2VFbmFibGVkKCkpCiAgICAgICAg\nICAgICAgICAgICAgbG9nLnRyYWNlKGUudG9TdHJpbmcoKSwgZSk7CiAgICAg\nICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgICAgICBpZiAoc3RtbnQg\nIT0gbnVsbCkKICAgICAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAg\nICAgICAgICAgICAgICBzdG1udC5jbG9zZSgpOwogICAgICAgICAgICAgICAg\nICAgIH0gY2F0Y2ggKFNRTEV4Y2VwdGlvbiBzZSkgewogICAgICAgICAgICAg\nICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1\ncm4gY29ubjsKICAgIH0KCiAgICAvKioKICAgICAqIEltcGxlbWVudGF0aW9u\nIG9mIHRoZQogICAgICoge0BsaW5rIExvZ2dpbmdDb25uZWN0aW9uRGVjb3Jh\ndG9yLlNRTFdhcm5pbmdIYW5kbGVyfSBpbnRlcmZhY2UKICAgICAqIHRoYXQg\nYWxsb3dzIGN1c3RvbWl6YXRpb24gb2YgdGhlIGFjdGlvbnMgdG8gcGVyZm9y\nbSB3aGVuIGEKICAgICAqIHtAbGluayBTUUxXYXJuaW5nfSBvY2N1cnMgYXQg\nYW55IHBvaW50IG9uIGEge0BsaW5rIENvbm5lY3Rpb259LAogICAgICoge0Bs\naW5rIFN0YXRlbWVudH0sIG9yIHtAbGluayBSZXN1bHRTZXR9LiBUaGlzIG1l\ndGhvZCBtYXkKICAgICAqIGJlIHVzZWQgZGV0ZXJtaW5lIHRob3NlIHdhcm5p\nbmdzIHRoZSBhcHBsaWNhdGlvbiB3YW50cyB0bwogICAgICogY29uc2lkZXIg\nY3JpdGljYWwgZmFpbHVyZXMsIGFuZCB0aHJvdyB0aGUgd2FybmluZyBpbiB0\naG9zZQogICAgICogY2FzZXMuIEJ5IGRlZmF1bHQsIHRoaXMgbWV0aG9kIGRv\nZXMgbm90aGluZy4KICAgICAqCiAgICAgKiBAc2VlIExvZ2dpbmdDb25uZWN0\naW9uRGVjb3JhdG9yI3NldFdhcm5pbmdBY3Rpb24KICAgICAqIEBzZWUgTG9n\nZ2luZ0Nvbm5lY3Rpb25EZWNvcmF0b3Ijc2V0V2FybmluZ0hhbmRsZXIKICAg\nICAqLwogICAgcHVibGljIHZvaWQgaGFuZGxlV2FybmluZyhTUUxXYXJuaW5n\nIHdhcm5pbmcpCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBSZXR1cm4gYSBuZXcgZXhjZXB0aW9uIHRoYXQg\nd3JhcHMgPGNvZGU+Y2F1c2VzPC9jb2RlPi4KICAgICAqIEhvd2V2ZXIsIHRo\nZSBkZXRhaWxzIG9mIGV4YWN0bHkgd2hhdCB0eXBlIG9mIGV4Y2VwdGlvbiBp\ncyByZXR1cm5lZCBjYW4KICAgICAqIGJlIGRldGVybWluZWQgYnkgdGhlIGlt\ncGxlbWVudGF0aW9uLiBUaGlzIG1heSB0YWtlIGludG8gYWNjb3VudAogICAg\nICogREItc3BlY2lmaWMgZXhjZXB0aW9uIGluZm9ybWF0aW9uIGluIDxjb2Rl\nPmNhdXNlczwvY29kZT4uCiAgICAgKi8KICAgIHB1YmxpYyBPcGVuSlBBRXhj\nZXB0aW9uIG5ld1N0b3JlRXhjZXB0aW9uKFN0cmluZyBtc2csIFNRTEV4Y2Vw\ndGlvbltdIGNhdXNlcywKICAgICAgICBPYmplY3QgZmFpbGVkKSB7CiAgICAg\nICAgaWYgKGNhdXNlcy5sZW5ndGggPiAwICYmICIyMzAwMCIuZXF1YWxzKGNh\ndXNlc1swXS5nZXRTUUxTdGF0ZSgpKSkKICAgICAgICAgICAgcmV0dXJuIG5l\ndyBSZWZlcmVudGlhbEludGVncml0eUV4Y2VwdGlvbihtc2cpLgogICAgICAg\nICAgICAgICAgc2V0RmFpbGVkT2JqZWN0KGZhaWxlZCkuc2V0TmVzdGVkVGhy\nb3dhYmxlcyhjYXVzZXMpOwogICAgICAgIHJldHVybiBuZXcgU3RvcmVFeGNl\ncHRpb24obXNnKS5zZXRGYWlsZWRPYmplY3QoZmFpbGVkKS4KICAgICAgICAg\nICAgc2V0TmVzdGVkVGhyb3dhYmxlcyhjYXVzZXMpOwogICAgfQoKICAgIC8q\nKgogICAgICogQ2xvc2VzIHRoZSBzcGVjaWZpZWQge0BsaW5rIERhdGFTb3Vy\nY2V9IGFuZCByZWxlYXNlcyBhbnkKICAgICAqIHJlc291cmNlcyBhc3NvY2lh\ndGVkIHdpdGggaXQuCiAgICAgKgogICAgICogQHBhcmFtIGRhdGFTb3VyY2Ug\ndGhlIERhdGFTb3VyY2UgdG8gY2xvc2UKICAgICAqLwogICAgcHVibGljIHZv\naWQgY2xvc2VEYXRhU291cmNlKERhdGFTb3VyY2UgZGF0YVNvdXJjZSkgewog\nICAgICAgIERhdGFTb3VyY2VGYWN0b3J5LmNsb3NlRGF0YVNvdXJjZShkYXRh\nU291cmNlKTsKICAgIH0KCiAgICAvKioKICAgICAqIFVzZWQgYnkgc29tZSBt\nYXBwaW5ncyB0byByZXByZXNlbnQgZGF0YSB0aGF0IGhhcyBhbHJlYWR5IGJl\nZW4KICAgICAqIHNlcmlhbGl6ZWQgc28gdGhhdCB3ZSBkb24ndCBoYXZlIHRv\nIHNlcmlhbGl6ZSBtdWx0aXBsZSB0aW1lcy4KICAgICAqLwogICAgcHVibGlj\nIHN0YXRpYyBjbGFzcyBTZXJpYWxpemVkRGF0YSB7CgogICAgICAgIHB1Ymxp\nYyBmaW5hbCBieXRlW10gYnl0ZXM7CgogICAgICAgIHB1YmxpYyBTZXJpYWxp\nemVkRGF0YShieXRlW10gYnl0ZXMpIHsKICAgICAgICAgICAgdGhpcy5ieXRl\ncyA9IGJ5dGVzOwogICAgICAgIH0KICAgIH0KICAgIAogICAgLyoqCiAgICAg\nKiBSZXR1cm4gdmVyc2lvbiBjb2x1bW4gbmFtZQogICAgICogQHBhcmFtIGNv\nbHVtbgogICAgICogQHBhcmFtIHRhYmxlQWxpYXMgOiB0aGlzIGlzIG5lZWRl\nZCBmb3IgcGxhdGZvcm0gc3BlY2lmaWMgdmVyc2lvbiBjb2x1bW4KICAgICAq\nIEByZXR1cm4KICAgICAqLwogICAgcHVibGljIFN0cmluZyBnZXRWZXJzaW9u\nQ29sdW1uKENvbHVtbiBjb2x1bW4sIFN0cmluZyB0YWJsZUFsaWFzKSB7CiAg\nICAgICAgcmV0dXJuIGNvbHVtbi50b1N0cmluZygpOwogICAgfQogICAgCiAg\nICAvKioKICAgICAqIEF0dGFjaCBDQVNUIHRvIHRoZSBjdXJyZW50IGZ1bmN0\naW9uIGlmIG5lY2Vzc2FyeQogICAgICogCiAgICAgKiBAcGFyYW0gdmFsIG9w\nZXJhbmQgdmFsdWUKICAgICAqIEBwYXJtYSBmdW5jIHRoZSBzcWwgZnVuY3Rp\nb24gc3RhdGVtZW50CiAgICAgKiBAcmV0dXJuIGEgU3RyaW5nIHdpdGggdGhl\nIGNvcnJlY3QgQ0FTVCBmdW5jdGlvbiBzeW50YXgKICAgICAqLwogICAgcHVi\nbGljIFN0cmluZyBnZXRDYXN0RnVuY3Rpb24oVmFsIHZhbCwgU3RyaW5nIGZ1\nbmMpIHsKICAgICAgICByZXR1cm4gZnVuYzsKICAgIH0KICAgIAogICAgLyoq\nCiAgICAgKiBDcmVhdGUgYW4gaW5kZXggaWYgbmVjZXNzYXJ5IGZvciBzb21l\nIGRhdGFiYXNlIHRhYmxlcwogICAgICovCiAgICBwdWJsaWMgdm9pZCBjcmVh\ndGVJbmRleElmTmVjZXNzYXJ5KFNjaGVtYSBzY2hlbWEsIFN0cmluZyB0YWJs\nZSwKICAgICAgICAgICAgQ29sdW1uIHBrQ29sdW1uKSB7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBEZXRlcm1pbmUgd2hldGhlciB0aGUgcHJvdmlkZWQgPGNv\nZGU+c3FsPC9jb2RlPiBtYXkgYmUgdHJlYXRlZCBhcyBhIAogICAgICogc2Vs\nZWN0IHN0YXRlbWVudCBvbiB0aGlzIGRhdGFiYXNlLgogICAgICogIAogICAg\nICogQHBhcmFtIHNxbCAgIEEgc3FsIHN0YXRlbWVudC4gCiAgICAgKiAKICAg\nICAqIEByZXR1cm4gdHJ1ZSBpZiA8Y29kZT5zcWw8L2NvZGU+IHJlcHJlc2Vu\ndHMgYSBzZWxlY3Qgc3RhdGVtZW50LgogICAgICovCiAgICBwdWJsaWMgYm9v\nbGVhbiBpc1NlbGVjdChTdHJpbmcgc3FsKSB7CiAgICAgICAgSXRlcmF0b3Ig\naSA9IHNlbGVjdFdvcmRTZXQuaXRlcmF0b3IoKTsKICAgICAgICBTdHJpbmcg\nY3VyOwogICAgICAgIHdoaWxlIChpLmhhc05leHQoKSkgewogICAgICAgICAg\nICBjdXIgPSAoU3RyaW5nKSBpLm5leHQoKTsKICAgICAgICAgICAgaWYgKHNx\nbC5sZW5ndGgoKSA+PSBjdXIubGVuZ3RoKCkKICAgICAgICAgICAgICAgICAg\nICAmJiBzcWwuc3Vic3RyaW5nKDAsIGN1ci5sZW5ndGgoKSkuZXF1YWxzSWdu\nb3JlQ2FzZShjdXIpKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsK\nICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4gZmFsc2U7\nCiAgICB9Cn0K\n","encoding":"base64"}

