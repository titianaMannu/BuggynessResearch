{"sha":"e359a114b6cae7c96c63e2ae658371541bb239be","node_id":"MDQ6QmxvYjIwNjM2NDplMzU5YTExNGI2Y2FlN2M5NmM2M2UyYWU2NTgzNzE1NDFiYjIzOWJl","size":7254,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/e359a114b6cae7c96c63e2ae658371541bb239be","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zcWw7CgppbXBvcnQg\namF2YS5zcWwuUmVzdWx0U2V0OwppbXBvcnQgamF2YS5zcWwuU1FMRXhjZXB0\naW9uOwppbXBvcnQgamF2YS5zcWwuVHlwZXM7CmltcG9ydCBqYXZhLnV0aWwu\nQXJyYXlzOwoKaW1wb3J0IG9yZy5hcGFjaGUuY29tbW9ucy5sYW5nLlN0cmlu\nZ1V0aWxzOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMua2VybmVs\nLkpEQkNTdG9yZTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNj\naGVtYS5Db2x1bW47CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5z\nY2hlbWEuRm9yZWlnbktleTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5q\nZGJjLnNjaGVtYS5JbmRleDsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5q\nZGJjLnNjaGVtYS5QcmltYXJ5S2V5OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLmpkYmMuc2NoZW1hLlRhYmxlOwoKLyoqCiAqIERpY3Rpb25hcnkgZm9y\nIE15U1FMLgogKi8KcHVibGljIGNsYXNzIE15U1FMRGljdGlvbmFyeQogICAg\nZXh0ZW5kcyBEQkRpY3Rpb25hcnkgewoKICAgIC8qKgogICAgICogVGhlIE15\nU1FMIHRhYmxlIHR5cGUgdG8gdXNlIHdoZW4gY3JlYXRpbmcgdGFibGVzOyBk\nZWZhdWx0cyB0byBpbm5vZGIuCiAgICAgKi8KICAgIHB1YmxpYyBTdHJpbmcg\ndGFibGVUeXBlID0gImlubm9kYiI7CgogICAgLyoqCiAgICAgKiBXaGV0aGVy\nIHRvIHVzZSBjbG9icy4gU29tZSBvbGRlciB2ZXJzaW9ucyBvZiBNeVNRTCBk\nbyBub3QgaGFuZGxlCiAgICAgKiBjbG9icyBwcm9wZXJseSBzbyB3ZSBkZWZh\ndWx0IHRvIGZhbHNlIGhlcmUuCiAgICAgKi8KICAgIHB1YmxpYyBib29sZWFu\nIHVzZUNsb2JzID0gdHJ1ZTsKCiAgICAvKioKICAgICAqIFdoZXRoZXIgdGhl\nIGRyaXZlciBhdXRvbWF0aWNhbGx5IGRlc2VyaWFsaXplcyBibG9icy4KICAg\nICAqLwogICAgcHVibGljIGJvb2xlYW4gZHJpdmVyRGVzZXJpYWxpemVzQmxv\nYnMgPSB0cnVlOwoKICAgIC8qKgogICAgICogV2hldGhlciB0byBpbmxpbmUg\nbXVsdGktdGFibGUgYnVsay1kZWxldGUgb3BlcmF0aW9ucyBpbnRvIE15U1FM\nJ3MgCiAgICAgKiBjb21iaW5lZCA8Y29kZT5ERUxFVEUgRlJPTSBmb28sIGJh\nciwgYmF6PC9jb2RlPiBzeW50YXguIAogICAgICogRGVmYXVsdHMgdG8gZmFs\nc2UsIHNpbmNlIHRoaXMgbWF5IGZhaWwgaW4gdGhlIHByZXNlbmNlIG9mIElu\nbm9EQiB0YWJsZXMKICAgICAqIHdpdGggZm9yZWlnbiBrZXlzLgogICAgICog\nQHNlZSBodHRwOi8vZGV2Lm15c3FsLmNvbS9kb2MvcmVmbWFuLzUuMC9lbi9k\nZWxldGUuaHRtbAogICAgICovCiAgICBwdWJsaWMgYm9vbGVhbiBvcHRpbWl6\nZU11bHRpVGFibGVEZWxldGVzID0gZmFsc2U7CgogICAgcHVibGljIE15U1FM\nRGljdGlvbmFyeSgpIHsKICAgICAgICBwbGF0Zm9ybSA9ICJNeVNRTCI7CiAg\nICAgICAgdmFsaWRhdGlvblNRTCA9ICJTRUxFQ1QgTk9XKCkiOwogICAgICAg\nIGRpc3RpbmN0Q291bnRDb2x1bW5TZXBhcmF0b3IgPSAiLCI7CgogICAgICAg\nIHN1cHBvcnRzRGVmZXJyZWRDb25zdHJhaW50cyA9IGZhbHNlOwogICAgICAg\nIGNvbnN0cmFpbnROYW1lTW9kZSA9IENPTlNfTkFNRV9NSUQ7CiAgICAgICAg\nc3VwcG9ydHNNdWx0aXBsZU5vbnRyYW5zYWN0aW9uYWxSZXN1bHRTZXRzID0g\nZmFsc2U7CiAgICAgICAgc3VwcG9ydHNTdWJzZWxlY3QgPSBmYWxzZTsgLy8g\nb2xkIHZlcnNpb25zCiAgICAgICAgcmVxdWlyZXNBbGlhc0ZvclN1YnNlbGVj\ndCA9IHRydWU7IC8vIG5ldyB2ZXJzaW9ucwogICAgICAgIHN1cHBvcnRzU2Vs\nZWN0U3RhcnRJbmRleCA9IHRydWU7CiAgICAgICAgc3VwcG9ydHNTZWxlY3RF\nbmRJbmRleCA9IHRydWU7CiAgICAgICAgYWxsb3dzQWxpYXNJbkJ1bGtDbGF1\nc2UgPSBmYWxzZTsKCiAgICAgICAgY29uY2F0ZW5hdGVGdW5jdGlvbiA9ICJD\nT05DQVQoezB9LHsxfSkiOwoKICAgICAgICBtYXhUYWJsZU5hbWVMZW5ndGgg\nPSA2NDsKICAgICAgICBtYXhDb2x1bW5OYW1lTGVuZ3RoID0gNjQ7CiAgICAg\nICAgbWF4SW5kZXhOYW1lTGVuZ3RoID0gNjQ7CiAgICAgICAgbWF4Q29uc3Ry\nYWludE5hbWVMZW5ndGggPSA2NDsKICAgICAgICBtYXhJbmRleGVzUGVyVGFi\nbGUgPSAzMjsKICAgICAgICBzY2hlbWFDYXNlID0gU0NIRU1BX0NBU0VfUFJF\nU0VSVkU7CgogICAgICAgIHN1cHBvcnRzQXV0b0Fzc2lnbiA9IHRydWU7CiAg\nICAgICAgbGFzdEdlbmVyYXRlZEtleVF1ZXJ5ID0gIlNFTEVDVCBMQVNUX0lO\nU0VSVF9JRCgpIjsKICAgICAgICBhdXRvQXNzaWduQ2xhdXNlID0gIkFVVE9f\nSU5DUkVNRU5UIjsKCiAgICAgICAgY2xvYlR5cGVOYW1lID0gIlRFWFQiOwog\nICAgICAgIGxvbmdWYXJjaGFyVHlwZU5hbWUgPSAiVEVYVCI7CiAgICAgICAg\nbG9uZ1ZhcmJpbmFyeVR5cGVOYW1lID0gIkxPTkcgVkFSQklOQVJZIjsKICAg\nICAgICB0aW1lc3RhbXBUeXBlTmFtZSA9ICJEQVRFVElNRSI7CiAgICAgICAg\nZml4ZWRTaXplVHlwZU5hbWVTZXQuYWRkQWxsKEFycmF5cy5hc0xpc3QobmV3\nIFN0cmluZ1tdewogICAgICAgICAgICAiQk9PTCIsICJMT05HIFZBUkJJTkFS\nWSIsICJNRURJVU1CTE9CIiwgIkxPTkdCTE9CIiwKICAgICAgICAgICAgIlRJ\nTllCTE9CIiwgIkxPTkcgVkFSQ0hBUiIsICJNRURJVU1URVhUIiwgIkxPTkdU\nRVhUIiwgIlRFWFQiLAogICAgICAgICAgICAiVElOWVRFWFQiLCAiRE9VQkxF\nIFBSRUNJU0lPTiIsICJFTlVNIiwgIlNFVCIsICJEQVRFVElNRSIsCiAgICAg\nICAgfSkpOwogICAgICAgIHJlc2VydmVkV29yZFNldC5hZGRBbGwoQXJyYXlz\nLmFzTGlzdChuZXcgU3RyaW5nW117CiAgICAgICAgICAgICJJTlQxIiwgIklO\nVDIiLCAiSU5UNCIsICJGTE9BVDEiLCAiRkxPQVQyIiwgIkZMT0FUNCIsCiAg\nICAgICAgICAgICJBVVRPX0lOQ1JFTUVOVCIsICJCSU5BUlkiLCAiQkxPQiIs\nICJDSEFOR0UiLCAiRU5VTSIsICJJTkZJTEUiLAogICAgICAgICAgICAiTE9B\nRCIsICJNRURJVU1JTlQiLCAiT1BUSU9OIiwgIk9VVEZJTEUiLCAiUkVQTEFD\nRSIsCiAgICAgICAgICAgICJTRVQiLCAiU1RBUlRJTkciLCAiVEVYVCIsICJV\nTlNJR05FRCIsICJaRVJPRklMTCIsCiAgICAgICAgfSkpOwoKICAgICAgICAv\nLyBNeVNRTCByZXF1aXJlcyBkb3VibGUtZXNjYXBlIGZvciBzdHJpbmdzCiAg\nICAgICAgc2VhcmNoU3RyaW5nRXNjYXBlID0gIlxcXFwiOwogICAgfQoKICAg\nIHB1YmxpYyBTdHJpbmdbXSBnZXRDcmVhdGVUYWJsZVNRTChUYWJsZSB0YWJs\nZSkgewogICAgICAgIFN0cmluZ1tdIHNxbCA9IHN1cGVyLmdldENyZWF0ZVRh\nYmxlU1FMKHRhYmxlKTsKICAgICAgICBpZiAoIVN0cmluZ1V0aWxzLmlzRW1w\ndHkodGFibGVUeXBlKSkKICAgICAgICAgICAgc3FsWzBdID0gc3FsWzBdICsg\nIiBUWVBFID0gIiArIHRhYmxlVHlwZTsKICAgICAgICByZXR1cm4gc3FsOwog\nICAgfQoKICAgIHB1YmxpYyBTdHJpbmdbXSBnZXREcm9wSW5kZXhTUUwoSW5k\nZXggaW5kZXgpIHsKICAgICAgICByZXR1cm4gbmV3IFN0cmluZ1tdeyAiRFJP\nUCBJTkRFWCAiICsgZ2V0RnVsbE5hbWUoaW5kZXgpICsgIiBPTiAiCiAgICAg\nICAgICAgICsgZ2V0RnVsbE5hbWUoaW5kZXguZ2V0VGFibGUoKSwgZmFsc2Up\nIH07CiAgICB9CgogICAgcHVibGljIFN0cmluZ1tdIGdldEFkZFByaW1hcnlL\nZXlTUUwoUHJpbWFyeUtleSBwaykgewogICAgICAgIFN0cmluZ1tdIHNxbCA9\nIHN1cGVyLmdldEFkZFByaW1hcnlLZXlTUUwocGspOwoKICAgICAgICAvLyBt\neXNxbCByZXF1aXJlcyB0aGF0IGEgY29sdW1uIGJlIGRlY2xhcmVkIE5PVCBO\nVUxMIGJlZm9yZQogICAgICAgIC8vIGl0IGNhbiBiZSBtYWRlIGEgcHJpbWFy\neSBrZXkuCiAgICAgICAgQ29sdW1uW10gY29scyA9IHBrLmdldENvbHVtbnMo\nKTsKICAgICAgICBTdHJpbmdbXSByZXQgPSBuZXcgU3RyaW5nW2NvbHMubGVu\nZ3RoICsgc3FsLmxlbmd0aF07CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkg\nPCBjb2xzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIHJldFtpXSA9ICJB\nTFRFUiBUQUJMRSAiICsgZ2V0RnVsbE5hbWUoY29sc1tpXS5nZXRUYWJsZSgp\nLCBmYWxzZSkKICAgICAgICAgICAgICAgICsgIiBDSEFOR0UgIiArIGNvbHNb\naV0uZ2V0TmFtZSgpCiAgICAgICAgICAgICAgICArICIgIiArIGNvbHNbaV0u\nZ2V0TmFtZSgpIC8vIG5hbWUgdHdpY2UKICAgICAgICAgICAgICAgICsgIiAi\nICsgZ2V0VHlwZU5hbWUoY29sc1tpXSkgKyAiIE5PVCBOVUxMIjsKICAgICAg\nICB9CgogICAgICAgIFN5c3RlbS5hcnJheWNvcHkoc3FsLCAwLCByZXQsIGNv\nbHMubGVuZ3RoLCBzcWwubGVuZ3RoKTsKICAgICAgICByZXR1cm4gcmV0Owog\nICAgfQoKICAgIHByb3RlY3RlZCBTdHJpbmcgZ2V0Rm9yZWlnbktleUNvbnN0\ncmFpbnRTUUwoRm9yZWlnbktleSBmaykgewogICAgICAgIC8vIG15c3FsIGRv\nZXMgbm90IHN1cHBvcnQgY29tcG9zaXRlIGZvcmVpZ24ga2V5cwogICAgICAg\nIGlmIChmay5nZXRDb2x1bW5zKCkubGVuZ3RoID4gMSkKICAgICAgICAgICAg\ncmV0dXJuIG51bGw7CiAgICAgICAgcmV0dXJuIHN1cGVyLmdldEZvcmVpZ25L\nZXlDb25zdHJhaW50U1FMKGZrKTsKICAgIH0KICAgIAogICAgcHVibGljIFN0\ncmluZ1tdIGdldERlbGV0ZVRhYmxlQ29udGVudHNTUUwoVGFibGVbXSB0YWJs\nZXMpIHsKICAgICAgICAvLyBteXNxbCA+PSA0IHN1cHBvcnRzIG1vcmUtb3B0\naW1hbCBkZWxldGUgc3ludGF4CiAgICAgICAgaWYgKCFvcHRpbWl6ZU11bHRp\nVGFibGVEZWxldGVzKQogICAgICAgICAgICByZXR1cm4gc3VwZXIuZ2V0RGVs\nZXRlVGFibGVDb250ZW50c1NRTCh0YWJsZXMpOwogICAgICAgIGVsc2Ugewog\nICAgICAgICAgICBTdHJpbmdCdWZmZXIgYnVmID0gbmV3IFN0cmluZ0J1ZmZl\ncih0YWJsZXMubGVuZ3RoICogOCk7CiAgICAgICAgICAgIGJ1Zi5hcHBlbmQo\nIkRFTEVURSBGUk9NICIpOwogICAgICAgICAgICBmb3IgKGludCBpID0gMDsg\naSA8IHRhYmxlcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgYnVm\nLmFwcGVuZCh0YWJsZXNbaV0uZ2V0RnVsbE5hbWUoKSk7CiAgICAgICAgICAg\nICAgICBpZiAoaSA8IHRhYmxlcy5sZW5ndGggLSAxKQogICAgICAgICAgICAg\nICAgICAgIGJ1Zi5hcHBlbmQoIiwgIik7CiAgICAgICAgICAgIH0KICAgICAg\nICAgICAgcmV0dXJuIG5ldyBTdHJpbmdbXSB7IGJ1Zi50b1N0cmluZygpIH07\nCiAgICAgICAgfQogICAgfQoKICAgIHByb3RlY3RlZCB2b2lkIGFwcGVuZFNl\nbGVjdFJhbmdlKFNRTEJ1ZmZlciBidWYsIGxvbmcgc3RhcnQsIGxvbmcgZW5k\nLAogICAgICAgIGJvb2xlYW4gc3Vic2VsZWN0KSB7CiAgICAgICAgYnVmLmFw\ncGVuZCgiIExJTUlUICIpLmFwcGVuZFZhbHVlKHN0YXJ0KS5hcHBlbmQoIiwg\nIik7CiAgICAgICAgaWYgKGVuZCA9PSBMb25nLk1BWF9WQUxVRSkKICAgICAg\nICAgICAgYnVmLmFwcGVuZFZhbHVlKExvbmcuTUFYX1ZBTFVFKTsKICAgICAg\nICBlbHNlCiAgICAgICAgICAgIGJ1Zi5hcHBlbmRWYWx1ZShlbmQgLSBzdGFy\ndCk7CiAgICB9CgogICAgcHJvdGVjdGVkIENvbHVtbiBuZXdDb2x1bW4oUmVz\ndWx0U2V0IGNvbE1ldGEpCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7\nCiAgICAgICAgQ29sdW1uIGNvbCA9IHN1cGVyLm5ld0NvbHVtbihjb2xNZXRh\nKTsKICAgICAgICBpZiAoY29sLmlzTm90TnVsbCgpICYmICIwIi5lcXVhbHMo\nY29sLmdldERlZmF1bHRTdHJpbmcoKSkpCiAgICAgICAgICAgIGNvbC5zZXRE\nZWZhdWx0U3RyaW5nKG51bGwpOwogICAgICAgIHJldHVybiBjb2w7CiAgICB9\nCgogICAgcHVibGljIE9iamVjdCBnZXRCbG9iT2JqZWN0KFJlc3VsdFNldCBy\ncywgaW50IGNvbHVtbiwgSkRCQ1N0b3JlIHN0b3JlKQogICAgICAgIHRocm93\ncyBTUUxFeGNlcHRpb24gewogICAgICAgIC8vIGlmIHRoZSB1c2VyIGhhcyBz\nZXQgYSBnZXQtYmxvYiBzdHJhdGVneSBleHBsaWNpdGx5IG9yIHRoZSBkcml2\nZXIKICAgICAgICAvLyBkb2VzIG5vdCBhdXRvbWF0aWNhbGx5IGRlc2VyaWFs\naXplLCBkZWxlZ2F0ZSB0byBzdXBlcgogICAgICAgIGlmICh1c2VHZXRCeXRl\nc0ZvckJsb2JzIHx8IHVzZUdldE9iamVjdEZvckJsb2JzCiAgICAgICAgICAg\nIHx8ICFkcml2ZXJEZXNlcmlhbGl6ZXNCbG9icykKICAgICAgICAgICAgcmV0\ndXJuIHN1cGVyLmdldEJsb2JPYmplY3QocnMsIGNvbHVtbiwgc3RvcmUpOwoK\nICAgICAgICAvLyBtb3N0IG15c3FsIGRyaXZlcnMgZGVzZXJpYWxpemUgb24g\nZ2V0T2JqZWN0CiAgICAgICAgcmV0dXJuIHJzLmdldE9iamVjdChjb2x1bW4p\nOwogICAgfQoKICAgIHB1YmxpYyBpbnQgZ2V0UHJlZmVycmVkVHlwZShpbnQg\ndHlwZSkgewogICAgICAgIGlmICh0eXBlID09IFR5cGVzLkNMT0IgJiYgIXVz\nZUNsb2JzKQogICAgICAgICAgICByZXR1cm4gVHlwZXMuTE9OR1ZBUkNIQVI7\nCiAgICAgICAgcmV0dXJuIHN1cGVyLmdldFByZWZlcnJlZFR5cGUodHlwZSk7\nCiAgICB9Cn0K\n","encoding":"base64"}

