{"sha":"8fff8c718f2da5fc6a98db6208f5963ead4ee1f9","node_id":"MDQ6QmxvYjIwNjM2NDo4ZmZmOGM3MThmMmRhNWZjNmE5OGRiNjIwOGY1OTYzZWFkNGVlMWY5","size":14776,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/8fff8c718f2da5fc6a98db6208f5963ead4ee1f9","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zcWw7CgppbXBvcnQg\namF2YS5zcWwuQ29ubmVjdGlvbjsKaW1wb3J0IGphdmEuc3FsLlByZXBhcmVk\nU3RhdGVtZW50OwppbXBvcnQgamF2YS5zcWwuUmVzdWx0U2V0OwppbXBvcnQg\namF2YS5zcWwuU1FMRXhjZXB0aW9uOwppbXBvcnQgamF2YS5zcWwuU3RhdGVt\nZW50OwppbXBvcnQgamF2YS5zcWwuVHlwZXM7CmltcG9ydCBqYXZhLnRleHQu\nUGFyc2VFeGNlcHRpb247CmltcG9ydCBqYXZhLnRleHQuU2ltcGxlRGF0ZUZv\ncm1hdDsKaW1wb3J0IGphdmEudXRpbC5BcnJheXM7CmltcG9ydCBqYXZhLnV0\naWwuRGF0ZTsKCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5rZXJu\nZWwuZXhwcy5GaWx0ZXJWYWx1ZTsKaW1wb3J0IG9yZy5hcGFjaGUub3Blbmpw\nYS5qZGJjLnNjaGVtYS5Db2x1bW47CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEuamRiYy5zY2hlbWEuU2VxdWVuY2U7CmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEuamRiYy5zY2hlbWEuVGFibGU7CmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEubGliLmpkYmMuRGVsZWdhdGluZ0Nvbm5lY3Rpb247CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEubGliLmpkYmMuRGVsZWdhdGluZ1ByZXBhcmVk\nU3RhdGVtZW50OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51dGls\nLkxvY2FsaXplcjsKCi8qKgogKiBEaWN0aW9uYXJ5IGZvciBQb3N0Z3Jlcy4K\nICovCnB1YmxpYyBjbGFzcyBQb3N0Z3Jlc0RpY3Rpb25hcnkKICAgIGV4dGVu\nZHMgREJEaWN0aW9uYXJ5IHsKCiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBM\nb2NhbGl6ZXIgX2xvYyA9IExvY2FsaXplci5mb3JQYWNrYWdlCiAgICAgICAg\nKFBvc3RncmVzRGljdGlvbmFyeS5jbGFzcyk7CgogICAgLyoqCiAgICAgKiBT\nUUwgc3RhdGVtZW50IHRvIGxvYWQgYWxsIHNlcXVlbmNlIHNjaGVtYSxuYW1l\nIHBhaXJzIGZyb20gYWxsIHNjaGVtYXMuCiAgICAgKi8KICAgIHB1YmxpYyBT\ndHJpbmcgYWxsU2VxdWVuY2VzU1FMID0gIlNFTEVDVCBOVUxMIEFTIFNFUVVF\nTkNFX1NDSEVNQSwgcmVsbmFtZSAiICsKICAgICAgICAiQVMgU0VRVUVOQ0Vf\nTkFNRSBGUk9NIHBnX2NsYXNzIFdIRVJFIHJlbGtpbmQ9J1MnIjsKCiAgICAv\nKioKICAgICAqIFNRTCBzdGF0ZW1lbnQgdG8gbG9hZCBzY2hlbWEsbmFtZSBw\nYWlycyBmb3IgYWxsIHNlcXVlbmNlcyB3aXRoIGEKICAgICAqIGNlcnRhaW4g\nbmFtZSBmcm9tIGFsbCBzY2hlbWFzLgogICAgICovCiAgICBwdWJsaWMgU3Ry\naW5nIG5hbWVkU2VxdWVuY2VzRnJvbUFsbFNjaGVtYXNTUUwgPSAiU0VMRUNU\nIE5VTEwgQVMgIiArCiAgICAgICAgIlNFUVVFTkNFX1NDSEVNQSwgcmVsbmFt\nZSBBUyBTRVFVRU5DRV9OQU1FIEZST00gcGdfY2xhc3MgIiArCiAgICAgICAg\nIldIRVJFIHJlbGtpbmQ9J1MnIEFORCByZWxuYW1lID0gPyI7CgogICAgLyoq\nCiAgICAgKiBTUUwgc3RhdGVtZW50IHRvIGxvYWQgc2NoZW1hLG5hbWUgcGFp\ncnMgZnJvbSBhIG5hbWVkIHNjaGVtYS4KICAgICAqLwogICAgcHVibGljIFN0\ncmluZyBhbGxTZXF1ZW5jZXNGcm9tT25lU2NoZW1hU1FMID0gIlNFTEVDVCBO\nVUxMIEFTICIgKwogICAgICAgICJTRVFVRU5DRV9TQ0hFTUEsIHJlbG5hbWUg\nQVMgU0VRVUVOQ0VfTkFNRSBGUk9NIHBnX2NsYXNzLCAiICsKICAgICAgICAi\ncGdfbmFtZXNwYWNlIFdIRVJFIHJlbGtpbmQ9J1MnIEFORCBwZ19jbGFzcy5y\nZWxuYW1lc3BhY2UgPSAiICsKICAgICAgICAicGdfbmFtZXNwYWNlLm9pZCBB\nTkQgbnNwbmFtZSA9ID8iOwoKICAgIC8qKgogICAgICogU1FMIHN0YXRlbWVu\ndCB0byBsb2FkIGEgc2VxdWVuY2UncyBzY2hlbWEsbmFtZSBwYWlyIGZyb20g\nb25lIHNjaGVtYS4KICAgICAqLwogICAgcHVibGljIFN0cmluZyBuYW1lZFNl\ncXVlbmNlRnJvbU9uZVNjaGVtYVNRTCA9ICJTRUxFQ1QgTlVMTCBBUyAiICsK\nICAgICAgICAiU0VRVUVOQ0VfU0NIRU1BLCByZWxuYW1lIEFTIFNFUVVFTkNF\nX05BTUUgRlJPTSBwZ19jbGFzcywgIiArCiAgICAgICAgInBnX25hbWVzcGFj\nZSBXSEVSRSByZWxraW5kPSdTJyBBTkQgcGdfY2xhc3MucmVsbmFtZXNwYWNl\nID0gIiArCiAgICAgICAgInBnX25hbWVzcGFjZS5vaWQgQU5EIHJlbG5hbWUg\nPSA/IEFORCBuc3BuYW1lID0gPyI7CgogICAgLyoqCiAgICAgKiBTb21lIFBv\nc3RncmVzIGRyaXZlcnMgZG8gbm90IHN1cHBvcnQgdGhlIHtAbGluayBTdGF0\nZW1lbnQjc2V0RmV0Y2hTaXplfQogICAgICogbWV0aG9kLgogICAgICovCiAg\nICBwdWJsaWMgYm9vbGVhbiBzdXBwb3J0c1NldEZldGNoU2l6ZSA9IHRydWU7\nCgogICAgcHVibGljIFBvc3RncmVzRGljdGlvbmFyeSgpIHsKICAgICAgICBw\nbGF0Zm9ybSA9ICJQb3N0Z3JlU1FMIjsKICAgICAgICB2YWxpZGF0aW9uU1FM\nID0gIlNFTEVDVCBOT1coKSI7CiAgICAgICAgZGF0ZVByZWNpc2lvbiA9IENF\nTlRJOwogICAgICAgIHN1cHBvcnRzQWx0ZXJUYWJsZVdpdGhEcm9wQ29sdW1u\nID0gZmFsc2U7CiAgICAgICAgc3VwcG9ydHNEZWZlcnJlZENvbnN0cmFpbnRz\nID0gdHJ1ZTsKICAgICAgICBzdXBwb3J0c1NlbGVjdFN0YXJ0SW5kZXggPSB0\ncnVlOwogICAgICAgIHN1cHBvcnRzU2VsZWN0RW5kSW5kZXggPSB0cnVlOwoK\nICAgICAgICAvLyBQb3N0Z3JlU1FMIHJlcXVpcmVzIGRvdWJsZS1lc2NhcGUg\nZm9yIHN0cmluZ3MKICAgICAgICBzZWFyY2hTdHJpbmdFc2NhcGUgPSAiXFxc\nXCI7CgogICAgICAgIG1heFRhYmxlTmFtZUxlbmd0aCA9IDYzOwogICAgICAg\nIG1heENvbHVtbk5hbWVMZW5ndGggPSA2MzsKICAgICAgICBtYXhJbmRleE5h\nbWVMZW5ndGggPSA2MzsKICAgICAgICBtYXhDb25zdHJhaW50TmFtZUxlbmd0\naCA9IDYzOwogICAgICAgIHNjaGVtYUNhc2UgPSBTQ0hFTUFfQ0FTRV9MT1dF\nUjsKICAgICAgICByYW5nZVBvc2l0aW9uID0gUkFOR0VfUE9TVF9MT0NLOwog\nICAgICAgIHJlcXVpcmVzQWxpYXNGb3JTdWJzZWxlY3QgPSB0cnVlOwogICAg\nICAgIGFsbG93c0FsaWFzSW5CdWxrQ2xhdXNlID0gZmFsc2U7CgogICAgICAg\nIC8vIHsyfSBpcyB0aGUgcmVzdWx0IG9mIGdldEdlbmVyYXRlZEtleVNlcXVl\nbmNlTmFtZTsgdGhlCiAgICAgICAgLy8gc2luZ2xlLXF1b3RlIGVzY2FwZSB3\naWxsIHJlc3VsdCBpbiBTRUxFQ1QgQ1VSVkFMKCdteXNlcXVlbmNlJykKICAg\nICAgICBsYXN0R2VuZXJhdGVkS2V5UXVlcnkgPSAiU0VMRUNUIENVUlJWQUwo\nJyd7Mn0nJykiOwogICAgICAgIHN1cHBvcnRzQXV0b0Fzc2lnbiA9IHRydWU7\nCiAgICAgICAgYXV0b0Fzc2lnblR5cGVOYW1lID0gIkJJR1NFUklBTCI7CiAg\nICAgICAgbmV4dFNlcXVlbmNlUXVlcnkgPSAiU0VMRUNUIE5FWFRWQUwoJyd7\nMH0nJykiOwoKICAgICAgICB1c2VHZXRCeXRlc0ZvckJsb2JzID0gdHJ1ZTsK\nICAgICAgICB1c2VTZXRCeXRlc0ZvckJsb2JzID0gdHJ1ZTsKICAgICAgICB1\nc2VHZXRTdHJpbmdGb3JDbG9icyA9IHRydWU7CiAgICAgICAgdXNlU2V0U3Ry\naW5nRm9yQ2xvYnMgPSB0cnVlOwogICAgICAgIGJpdFR5cGVOYW1lID0gIkJP\nT0wiOwogICAgICAgIHNtYWxsaW50VHlwZU5hbWUgPSAiU01BTExJTlQiOwog\nICAgICAgIHJlYWxUeXBlTmFtZSA9ICJGTE9BVDgiOwogICAgICAgIHRpbnlp\nbnRUeXBlTmFtZSA9ICJTTUFMTElOVCI7CiAgICAgICAgYmluYXJ5VHlwZU5h\nbWUgPSAiQllURUEiOwogICAgICAgIGJsb2JUeXBlTmFtZSA9ICJCWVRFQSI7\nCiAgICAgICAgbG9uZ1ZhcmJpbmFyeVR5cGVOYW1lID0gIkJZVEVBIjsKICAg\nICAgICB2YXJiaW5hcnlUeXBlTmFtZSA9ICJCWVRFQSI7CiAgICAgICAgY2xv\nYlR5cGVOYW1lID0gIlRFWFQiOwogICAgICAgIGxvbmdWYXJjaGFyVHlwZU5h\nbWUgPSAiVEVYVCI7CiAgICAgICAgZG91YmxlVHlwZU5hbWUgPSAiRE9VQkxF\nIFBSRUNJU0lPTiI7CiAgICAgICAgdmFyY2hhclR5cGVOYW1lID0gIlZBUkNI\nQVJ7MH0iOwogICAgICAgIHRpbWVzdGFtcFR5cGVOYW1lID0gIkFCU1RJTUUi\nOwogICAgICAgIGZpeGVkU2l6ZVR5cGVOYW1lU2V0LmFkZEFsbChBcnJheXMu\nYXNMaXN0KG5ldyBTdHJpbmdbXXsKICAgICAgICAgICAgIkJPT0wiLCAiQllU\nRUEiLCAiTkFNRSIsICJJTlQ4IiwgIklOVDIiLCAiSU5UMlZFQ1RPUiIsICJJ\nTlQ0IiwKICAgICAgICAgICAgIlJFR1BST0MiLCAiVEVYVCIsICJPSUQiLCAi\nVElEIiwgIlhJRCIsICJDSUQiLCAiT0lEVkVDVE9SIiwKICAgICAgICAgICAg\nIlNFVCIsICJGTE9BVDQiLCAiRkxPQVQ4IiwgIkFCU1RJTUUiLCAiUkVMVElN\nRSIsICJUSU5URVJWQUwiLAogICAgICAgICAgICAiTU9ORVkiLAogICAgICAg\nIH0pKTsKCiAgICAgICAgc3VwcG9ydHNMb2NraW5nV2l0aERpc3RpbmN0Q2xh\ndXNlID0gZmFsc2U7CiAgICAgICAgc3VwcG9ydHNMb2NraW5nV2l0aE91dGVy\nSm9pbiA9IGZhbHNlOwogICAgICAgIHN1cHBvcnRzTnVsbFRhYmxlRm9yR2V0\nSW1wb3J0ZWRLZXlzID0gdHJ1ZTsKCiAgICAgICAgcmVzZXJ2ZWRXb3JkU2V0\nLmFkZEFsbChBcnJheXMuYXNMaXN0KG5ldyBTdHJpbmdbXXsKICAgICAgICAg\nICAgIkFCT1JUIiwgIkFDTCIsICJBR0dSRUdBVEUiLCAiQVBQRU5EIiwgIkFS\nQ0hJVkUiLCAiQVJDSF9TVE9SRSIsCiAgICAgICAgICAgICJCQUNLV0FSRCIs\nICJCSU5BUlkiLCAiQ0hBTkdFIiwgIkNMVVNURVIiLCAiQ09QWSIsICJEQVRB\nQkFTRSIsCiAgICAgICAgICAgICJERUxJTUlURVIiLCAiREVMSU1JVEVSUyIs\nICJETyIsICJFWFBMQUlOIiwgIkVYVEVORCIsCiAgICAgICAgICAgICJGT1JX\nQVJEIiwgIkhFQVZZIiwgIklOREVYIiwgIklOSEVSSVRTIiwgIklTTlVMTCIs\nICJMSUdIVCIsCiAgICAgICAgICAgICJMSVNURU4iLCAiTE9BRCIsICJNRVJH\nRSIsICJOT1RISU5HIiwgIk5PVElGWSIsICJOT1ROVUxMIiwKICAgICAgICAg\nICAgIk9JRCIsICJPSURTIiwgIlBVUkdFIiwgIlJFQ0lQRSIsICJSRU5BTUUi\nLCAiUkVQTEFDRSIsCiAgICAgICAgICAgICJSRVRSSUVWRSIsICJSRVRVUk5T\nIiwgIlJVTEUiLCAiU0VUT0YiLCAiU1RESU4iLCAiU1RET1VUIiwKICAgICAg\nICAgICAgIlNUT1JFIiwgIlZBQ1VVTSIsICJWRVJCT1NFIiwgIlZFUlNJT04i\nLAogICAgICAgIH0pKTsKICAgIH0KCiAgICBwdWJsaWMgRGF0ZSBnZXREYXRl\nKFJlc3VsdFNldCBycywgaW50IGNvbHVtbikKICAgICAgICB0aHJvd3MgU1FM\nRXhjZXB0aW9uIHsKICAgICAgICB0cnkgewogICAgICAgICAgICByZXR1cm4g\nc3VwZXIuZ2V0RGF0ZShycywgY29sdW1uKTsKICAgICAgICB9IGNhdGNoIChT\ndHJpbmdJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uIHNpb29iZSkgewogICAg\nICAgICAgICAvLyB0aGVyZSBpcyBhIGJ1ZyBpbiBzb21lIHZlcnNpb25zIG9m\nIHRoZSBwb3N0Z3JlcyBKREJDCiAgICAgICAgICAgIC8vIGRyaXZlciBzdWNo\nIHRoYXQgYSBkYXRlIHdpdGggbm90IGVub3VnaCBudW1iZXJzIGluIGl0CiAg\nICAgICAgICAgIC8vIHdpbGwgdGhyb3cgYSBwYXJzaW5nIGV4Y2VwdGlvbjog\ndGhpcyB0cmllcyB0byB3b3JrCiAgICAgICAgICAgIC8vIGFyb3VuZCBpdC4g\nVGhlIGJ1ZyBvbmx5IG9jY3VycyB3aGVuIHRoZXJlIGlzIGEgdHJhaWxpbmcK\nICAgICAgICAgICAgLy8gbWlsbGlzZWNvbmQgbWlzc2luZyBmcm9tIHRoZSBl\nbmQuIEUuZy4sIHdoZW4gdGhlIGRhdGUgaXMKICAgICAgICAgICAgLy8gbGlr\nZToKICAgICAgICAgICAgLy8gMjA2Ni0xMC0xOSAyMjowODozMi44MwogICAg\nICAgICAgICAvLyByYXRoZXIgdGhhbiB3aGF0IHRoZSBkcml2ZXIgZXhwZWN0\nczoKICAgICAgICAgICAgLy8gMjA2Ni0xMC0xOSAyMjowODozMi44MzAKICAg\nICAgICAgICAgU3RyaW5nIGRhdGVTdHIgPSBycy5nZXRTdHJpbmcoY29sdW1u\nKTsKICAgICAgICAgICAgU2ltcGxlRGF0ZUZvcm1hdCBmbXQgPSBuZXcgU2lt\ncGxlRGF0ZUZvcm1hdCgKICAgICAgICAgICAgICAgICJ5eXl5LU1NLWRkIGho\nOm1tOnNzLlNTIik7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAg\nICByZXR1cm4gZm10LnBhcnNlKGRhdGVTdHIpOwogICAgICAgICAgICB9IGNh\ndGNoIChQYXJzZUV4Y2VwdGlvbiBwZSkgewogICAgICAgICAgICAgICAgdGhy\nb3cgbmV3IFNRTEV4Y2VwdGlvbihwZS50b1N0cmluZygpKTsKICAgICAgICAg\nICAgfQogICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMgYnl0ZSBnZXRCeXRl\nKFJlc3VsdFNldCBycywgaW50IGNvbHVtbikKICAgICAgICB0aHJvd3MgU1FM\nRXhjZXB0aW9uIHsKICAgICAgICAvLyBwb3N0Z3JlcyBkb2VzIG5vdCBwZXJm\nb3JtIGF1dG9tYXRpYyBjb252ZXJzaW9ucywgc28gYXR0ZW1wdGluZyB0bwog\nICAgICAgIC8vIGdldCBhIHdob2xlIG51bWJlciBvdXQgb2YgYSBkZWNpbWFs\nIHdpbGwgdGhyb3cgYW4gZXhjZXB0aW9uLgogICAgICAgIC8vIGZhbGwgYmFj\nayB0byBwZXJmb3JtaW5nIG1hbnVhbCBjb252ZXJzaW9uIGlmIHRoZSBpbml0\naWFsIGdldCBmYWlscwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIHJldHVy\nbiBzdXBlci5nZXRCeXRlKHJzLCBjb2x1bW4pOwogICAgICAgIH0gY2F0Y2gg\nKFNRTEV4Y2VwdGlvbiBzcWxlKSB7CiAgICAgICAgICAgIHJldHVybiBzdXBl\nci5nZXRCaWdEZWNpbWFsKHJzLCBjb2x1bW4pLmJ5dGVWYWx1ZSgpOwogICAg\nICAgIH0KICAgIH0KCiAgICBwdWJsaWMgc2hvcnQgZ2V0U2hvcnQoUmVzdWx0\nU2V0IHJzLCBpbnQgY29sdW1uKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRp\nb24gewogICAgICAgIC8vIHBvc3RncmVzIGRvZXMgbm90IHBlcmZvcm0gYXV0\nb21hdGljIGNvbnZlcnNpb25zLCBzbyBhdHRlbXB0aW5nIHRvCiAgICAgICAg\nLy8gZ2V0IGEgd2hvbGUgbnVtYmVyIG91dCBvZiBhIGRlY2ltYWwgd2lsbCB0\naHJvdyBhbiBleGNlcHRpb24uCiAgICAgICAgLy8gZmFsbCBiYWNrIHRvIHBl\ncmZvcm1pbmcgbWFudWFsIGNvbnZlcnNpb24gaWYgdGhlIGluaXRpYWwgZ2V0\nIGZhaWxzCiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgcmV0dXJuIHN1cGVy\nLmdldFNob3J0KHJzLCBjb2x1bW4pOwogICAgICAgIH0gY2F0Y2ggKFNRTEV4\nY2VwdGlvbiBzcWxlKSB7CiAgICAgICAgICAgIHJldHVybiBzdXBlci5nZXRC\naWdEZWNpbWFsKHJzLCBjb2x1bW4pLnNob3J0VmFsdWUoKTsKICAgICAgICB9\nCiAgICB9CgogICAgcHVibGljIGludCBnZXRJbnQoUmVzdWx0U2V0IHJzLCBp\nbnQgY29sdW1uKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAg\nICAgIC8vIHBvc3RncmVzIGRvZXMgbm90IHBlcmZvcm0gYXV0b21hdGljIGNv\nbnZlcnNpb25zLCBzbyBhdHRlbXB0aW5nIHRvCiAgICAgICAgLy8gZ2V0IGEg\nd2hvbGUgbnVtYmVyIG91dCBvZiBhIGRlY2ltYWwgd2lsbCB0aHJvdyBhbiBl\neGNlcHRpb24uCiAgICAgICAgLy8gZmFsbCBiYWNrIHRvIHBlcmZvcm1pbmcg\nbWFudWFsIGNvbnZlcnNpb24gaWYgdGhlIGluaXRpYWwgZ2V0IGZhaWxzCiAg\nICAgICAgdHJ5IHsKICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmdldEludChy\ncywgY29sdW1uKTsKICAgICAgICB9IGNhdGNoIChTUUxFeGNlcHRpb24gc3Fs\nZSkgewogICAgICAgICAgICByZXR1cm4gc3VwZXIuZ2V0QmlnRGVjaW1hbChy\ncywgY29sdW1uKS5pbnRWYWx1ZSgpOwogICAgICAgIH0KICAgIH0KCiAgICBw\ndWJsaWMgbG9uZyBnZXRMb25nKFJlc3VsdFNldCBycywgaW50IGNvbHVtbikK\nICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAvLyBwb3N0\nZ3JlcyBkb2VzIG5vdCBwZXJmb3JtIGF1dG9tYXRpYyBjb252ZXJzaW9ucywg\nc28gYXR0ZW1wdGluZyB0bwogICAgICAgIC8vIGdldCBhIHdob2xlIG51bWJl\nciBvdXQgb2YgYSBkZWNpbWFsIHdpbGwgdGhyb3cgYW4gZXhjZXB0aW9uLgog\nICAgICAgIC8vIGZhbGwgYmFjayB0byBwZXJmb3JtaW5nIG1hbnVhbCBjb252\nZXJzaW9uIGlmIHRoZSBpbml0aWFsIGdldCBmYWlscwogICAgICAgIHRyeSB7\nCiAgICAgICAgICAgIHJldHVybiBzdXBlci5nZXRMb25nKHJzLCBjb2x1bW4p\nOwogICAgICAgIH0gY2F0Y2ggKFNRTEV4Y2VwdGlvbiBzcWxlKSB7CiAgICAg\nICAgICAgIHJldHVybiBzdXBlci5nZXRCaWdEZWNpbWFsKHJzLCBjb2x1bW4p\nLmxvbmdWYWx1ZSgpOwogICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMgdm9p\nZCBzZXRCb29sZWFuKFByZXBhcmVkU3RhdGVtZW50IHN0bW50LCBpbnQgaWR4\nLCBib29sZWFuIHZhbCwKICAgICAgICBDb2x1bW4gY29sKQogICAgICAgIHRo\ncm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIC8vIHBvc3RncmVzIGFjdHVh\nbGx5IHJlcXVpcmVzIHRoYXQgYSBib29sZWFuIGJlIHNldDogaXQgY2Fubm90\nCiAgICAgICAgLy8gaGFuZGxlIGEgbnVtZXJpYyBhcmd1bWVudC4KICAgICAg\nICBzdG1udC5zZXRCb29sZWFuKGlkeCwgdmFsKTsKICAgIH0KCiAgICBwdWJs\naWMgdm9pZCBzZXROdWxsKFByZXBhcmVkU3RhdGVtZW50IHN0bW50LCBpbnQg\naWR4LCBpbnQgY29sVHlwZSwKICAgICAgICBDb2x1bW4gY29sKQogICAgICAg\nIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIC8vIE9QRU5KUEEtCiAg\nICAgICAgaWYgKGNvbFR5cGUgPT0gVHlwZXMuQkxPQikKICAgICAgICAgICAg\nY29sVHlwZSA9IFR5cGVzLkJJTkFSWTsKICAgICAgICBzdG1udC5zZXROdWxs\nKGlkeCwgY29sVHlwZSk7CiAgICB9CgogICAgcHJvdGVjdGVkIHZvaWQgYXBw\nZW5kU2VsZWN0UmFuZ2UoU1FMQnVmZmVyIGJ1ZiwgbG9uZyBzdGFydCwgbG9u\nZyBlbmQsCiAgICAgICAgYm9vbGVhbiBzdWJzZWxlY3QpIHsKICAgICAgICBp\nZiAoZW5kICE9IExvbmcuTUFYX1ZBTFVFKQogICAgICAgICAgICBidWYuYXBw\nZW5kKCIgTElNSVQgIikuYXBwZW5kVmFsdWUoZW5kIC0gc3RhcnQpOwogICAg\nICAgIGlmIChzdGFydCAhPSAwKQogICAgICAgICAgICBidWYuYXBwZW5kKCIg\nT0ZGU0VUICIpLmFwcGVuZFZhbHVlKHN0YXJ0KTsKICAgIH0KCiAgICBwdWJs\naWMgdm9pZCBpbmRleE9mKFNRTEJ1ZmZlciBidWYsIEZpbHRlclZhbHVlIHN0\nciwgRmlsdGVyVmFsdWUgZmluZCwKICAgICAgICBGaWx0ZXJWYWx1ZSBzdGFy\ndCkgewogICAgICAgIGJ1Zi5hcHBlbmQoIihQT1NJVElPTigiKTsKICAgICAg\nICBmaW5kLmFwcGVuZFRvKGJ1Zik7CiAgICAgICAgYnVmLmFwcGVuZCgiIElO\nICIpOwogICAgICAgIGlmIChzdGFydCAhPSBudWxsKQogICAgICAgICAgICBz\ndWJzdHJpbmcoYnVmLCBzdHIsIHN0YXJ0LCBudWxsKTsKICAgICAgICBlbHNl\nCiAgICAgICAgICAgIHN0ci5hcHBlbmRUbyhidWYpOwogICAgICAgIGJ1Zi5h\ncHBlbmQoIikgLSAxIik7CiAgICAgICAgaWYgKHN0YXJ0ICE9IG51bGwpIHsK\nICAgICAgICAgICAgYnVmLmFwcGVuZCgiICsgIik7CiAgICAgICAgICAgIHN0\nYXJ0LmFwcGVuZFRvKGJ1Zik7CiAgICAgICAgfQogICAgICAgIGJ1Zi5hcHBl\nbmQoIikiKTsKICAgIH0KCiAgICBwdWJsaWMgU3RyaW5nW10gZ2V0Q3JlYXRl\nU2VxdWVuY2VTUUwoU2VxdWVuY2Ugc2VxKSB7CiAgICAgICAgU3RyaW5nW10g\nc3FsID0gc3VwZXIuZ2V0Q3JlYXRlU2VxdWVuY2VTUUwoc2VxKTsKICAgICAg\nICBpZiAoc2VxLmdldEFsbG9jYXRlKCkgPiAxKQogICAgICAgICAgICBzcWxb\nMF0gKz0gIiBDQUNIRSAiICsgc2VxLmdldEFsbG9jYXRlKCk7CiAgICAgICAg\ncmV0dXJuIHNxbDsKICAgIH0KCiAgICBwcm90ZWN0ZWQgYm9vbGVhbiBzdXBw\nb3J0c0RlZmVycmVkVW5pcXVlQ29uc3RyYWludHMoKSB7CiAgICAgICAgLy8g\nUG9zdGdyZXMgb25seSBzdXBwb3J0cyBkZWZlcnJlZCBmb3JlaWduIGtleSBj\nb25zdHJhaW50cy4KICAgICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAg\ncHJvdGVjdGVkIFN0cmluZyBnZXRTZXF1ZW5jZXNTUUwoU3RyaW5nIHNjaGVt\nYU5hbWUsIFN0cmluZyBzZXF1ZW5jZU5hbWUpIHsKICAgICAgICBpZiAoc2No\nZW1hTmFtZSA9PSBudWxsICYmIHNlcXVlbmNlTmFtZSA9PSBudWxsKQogICAg\nICAgICAgICByZXR1cm4gYWxsU2VxdWVuY2VzU1FMOwogICAgICAgIGVsc2Ug\naWYgKHNjaGVtYU5hbWUgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIG5h\nbWVkU2VxdWVuY2VzRnJvbUFsbFNjaGVtYXNTUUw7CiAgICAgICAgZWxzZSBp\nZiAoc2VxdWVuY2VOYW1lID09IG51bGwpCiAgICAgICAgICAgIHJldHVybiBh\nbGxTZXF1ZW5jZXNGcm9tT25lU2NoZW1hU1FMOwogICAgICAgIGVsc2UKICAg\nICAgICAgICAgcmV0dXJuIG5hbWVkU2VxdWVuY2VGcm9tT25lU2NoZW1hU1FM\nOwogICAgfQoKICAgIHB1YmxpYyBib29sZWFuIGlzU3lzdGVtU2VxdWVuY2Uo\nU3RyaW5nIG5hbWUsIFN0cmluZyBzY2hlbWEsCiAgICAgICAgYm9vbGVhbiB0\nYXJnZXRTY2hlbWEpIHsKICAgICAgICBpZiAoc3VwZXIuaXNTeXN0ZW1TZXF1\nZW5jZShuYW1lLCBzY2hlbWEsIHRhcmdldFNjaGVtYSkpCiAgICAgICAgICAg\nIHJldHVybiB0cnVlOwoKICAgICAgICAvLyBmaWx0ZXIgb3V0IGdlbmVyYXRl\nZCBzZXF1ZW5jZXMgdXNlZCBmb3IgYmlnc2VyaWFsIGNvbHMsIHdoaWNoIGFy\nZQogICAgICAgIC8vIG9mIHRoZSBmb3JtIDx0YWJsZT5fPGNvbD5fc2VxCiAg\nICAgICAgaW50IGlkeCA9IG5hbWUuaW5kZXhPZignXycpOwogICAgICAgIHJl\ndHVybiBpZHggIT0gLTEgJiYgaWR4ICE9IG5hbWUubGVuZ3RoKCkgLSA0CiAg\nICAgICAgICAgICYmIG5hbWUudG9VcHBlckNhc2UoKS5lbmRzV2l0aCgiX1NF\nUSIpOwogICAgfQoKICAgIHB1YmxpYyBib29sZWFuIGlzU3lzdGVtVGFibGUo\nU3RyaW5nIG5hbWUsIFN0cmluZyBzY2hlbWEsCiAgICAgICAgYm9vbGVhbiB0\nYXJnZXRTY2hlbWEpIHsKICAgICAgICAvLyBuYW1lcyBzdGFydGluZyB3aXRo\nICJwZ18iIGFyZSByZXNlcnZlZCBmb3IgUG9zdGdyZXNxbCBpbnRlcm5hbCB1\nc2UKICAgICAgICByZXR1cm4gc3VwZXIuaXNTeXN0ZW1UYWJsZShuYW1lLCBz\nY2hlbWEsIHRhcmdldFNjaGVtYSkKICAgICAgICAgICAgfHwgKG5hbWUgIT0g\nbnVsbCAmJiBuYW1lLnRvTG93ZXJDYXNlKCkuc3RhcnRzV2l0aCgicGdfIikp\nOwogICAgfQoKICAgIHB1YmxpYyBib29sZWFuIGlzU3lzdGVtSW5kZXgoU3Ry\naW5nIG5hbWUsIFRhYmxlIHRhYmxlKSB7CiAgICAgICAgLy8gbmFtZXMgc3Rh\ncnRpbmcgd2l0aCAicGdfIiBhcmUgcmVzZXJ2ZWQgZm9yIFBvc3RncmVzcWwg\naW50ZXJuYWwgdXNlCiAgICAgICAgcmV0dXJuIHN1cGVyLmlzU3lzdGVtSW5k\nZXgobmFtZSwgdGFibGUpCiAgICAgICAgICAgIHx8IChuYW1lICE9IG51bGwg\nJiYgbmFtZS50b0xvd2VyQ2FzZSgpLnN0YXJ0c1dpdGgoInBnXyIpKTsKICAg\nIH0KCiAgICBwdWJsaWMgQ29ubmVjdGlvbiBkZWNvcmF0ZShDb25uZWN0aW9u\nIGNvbm4pCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAg\ncmV0dXJuIG5ldyBQb3N0Z3Jlc0Nvbm5lY3Rpb24oc3VwZXIuZGVjb3JhdGUo\nY29ubiksIHRoaXMpOwogICAgfQoKICAgIC8qKgogICAgICogQ29ubmVjdGlv\nbiB3cmFwcGVyIHRvIHdvcmsgYXJvdW5kIHRoZSBwb3N0Z3JlcyBlbXB0eSBy\nZXN1bHQgc2V0IGJ1Zy4KICAgICAqLwogICAgcHJpdmF0ZSBzdGF0aWMgY2xh\nc3MgUG9zdGdyZXNDb25uZWN0aW9uCiAgICAgICAgZXh0ZW5kcyBEZWxlZ2F0\naW5nQ29ubmVjdGlvbiB7CgogICAgICAgIHByaXZhdGUgZmluYWwgUG9zdGdy\nZXNEaWN0aW9uYXJ5IF9kaWN0OwoKICAgICAgICBwdWJsaWMgUG9zdGdyZXND\nb25uZWN0aW9uKENvbm5lY3Rpb24gY29ubiwgUG9zdGdyZXNEaWN0aW9uYXJ5\nIGRpY3QpIHsKICAgICAgICAgICAgc3VwZXIoY29ubik7CiAgICAgICAgICAg\nIF9kaWN0ID0gZGljdDsKICAgICAgICB9CgogICAgICAgIHByb3RlY3RlZCBQ\ncmVwYXJlZFN0YXRlbWVudCBwcmVwYXJlU3RhdGVtZW50KFN0cmluZyBzcWws\nIGJvb2xlYW4gd3JhcCkKICAgICAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlv\nbiB7CiAgICAgICAgICAgIHJldHVybiBuZXcgUG9zdGdyZXNQcmVwYXJlZFN0\nYXRlbWVudChzdXBlci5wcmVwYXJlU3RhdGVtZW50CiAgICAgICAgICAgICAg\nICAoc3FsLCBmYWxzZSksIHRoaXMsIF9kaWN0KTsKICAgICAgICB9CgogICAg\nICAgIHByb3RlY3RlZCBQcmVwYXJlZFN0YXRlbWVudCBwcmVwYXJlU3RhdGVt\nZW50KFN0cmluZyBzcWwsIGludCByc1R5cGUsCiAgICAgICAgICAgIGludCBy\nc0NvbmN1ciwgYm9vbGVhbiB3cmFwKQogICAgICAgICAgICB0aHJvd3MgU1FM\nRXhjZXB0aW9uIHsKICAgICAgICAgICAgcmV0dXJuIG5ldyBQb3N0Z3Jlc1By\nZXBhcmVkU3RhdGVtZW50KHN1cGVyLnByZXBhcmVTdGF0ZW1lbnQKICAgICAg\nICAgICAgICAgIChzcWwsIHJzVHlwZSwgcnNDb25jdXIsIGZhbHNlKSwgdGhp\ncywgX2RpY3QpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIFN0\nYXRlbWVudCB3cmFwcGVyIHRvIHdvcmsgYXJvdW5kIHRoZSBwb3N0Z3JlcyBl\nbXB0eSByZXN1bHQgc2V0IGJ1Zy4KICAgICAqLwogICAgcHJpdmF0ZSBzdGF0\naWMgY2xhc3MgUG9zdGdyZXNQcmVwYXJlZFN0YXRlbWVudAogICAgICAgIGV4\ndGVuZHMgRGVsZWdhdGluZ1ByZXBhcmVkU3RhdGVtZW50IHsKCiAgICAgICAg\ncHJpdmF0ZSBmaW5hbCBQb3N0Z3Jlc0RpY3Rpb25hcnkgX2RpY3Q7CgogICAg\nICAgIHB1YmxpYyBQb3N0Z3Jlc1ByZXBhcmVkU3RhdGVtZW50KFByZXBhcmVk\nU3RhdGVtZW50IHBzLAogICAgICAgICAgICBDb25uZWN0aW9uIGNvbm4sIFBv\nc3RncmVzRGljdGlvbmFyeSBkaWN0KSB7CiAgICAgICAgICAgIHN1cGVyKHBz\nLCBjb25uKTsKICAgICAgICAgICAgX2RpY3QgPSBkaWN0OwogICAgICAgIH0K\nCiAgICAgICAgcHJvdGVjdGVkIFJlc3VsdFNldCBleGVjdXRlUXVlcnkoYm9v\nbGVhbiB3cmFwKQogICAgICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsK\nICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIHJldHVybiBzdXBl\nci5leGVjdXRlUXVlcnkod3JhcCk7CiAgICAgICAgICAgIH0gY2F0Y2ggKFNR\nTEV4Y2VwdGlvbiBzZSkgewogICAgICAgICAgICAgICAgLy8gd2UgbmVlZCB0\nbyBtYWtlIG91ciBiZXN0IGd1ZXNzIHdoZXRoZXIgdGhpcyBpcyB0aGUgZW1w\ndHkKICAgICAgICAgICAgICAgIC8vIFJlc3VsdFNldCBidWcsIHNpbmNlIHRo\naXMgZXhjZXB0aW9uIGNvdWxkIG9jY3VyCiAgICAgICAgICAgICAgICAvLyBm\nb3Igb3RoZXIgcmVhc29ucyAobGlrZSBhbiBpbnZhbGlkIHF1ZXJ5IHN0cmlu\nZykuIE5vdGUKICAgICAgICAgICAgICAgIC8vIHRoYXQgUG9zdGdyZXMgZXJy\nb3IgbWVzc2FnZXMgYXJlIGxvY2FsaXplZCwgc28gd2UKICAgICAgICAgICAg\nICAgIC8vIGNhbm5vdCBqdXN0IHBhcnNlIHRoZSBleGNlcHRpb24gU3RyaW5n\nLgogICAgICAgICAgICAgICAgUmVzdWx0U2V0IHJzID0gZ2V0UmVzdWx0U2V0\nKHdyYXApOwoKICAgICAgICAgICAgICAgIC8vIFJlc3VsdFNldCBzaG91bGQg\nYmUgZW1wdHk6IGlmIG5vdCwgdGhlbiBtYXliZSBhbgogICAgICAgICAgICAg\nICAgLy8gYWN0dWFsIGVycm9yIG9jY3VyZWQKICAgICAgICAgICAgICAgIGlm\nIChycyA9PSBudWxsKQogICAgICAgICAgICAgICAgICAgIHRocm93IHNlOwoK\nICAgICAgICAgICAgICAgIHJldHVybiByczsKICAgICAgICAgICAgfQogICAg\nICAgIH0KCiAgICAgICAgcHVibGljIHZvaWQgc2V0RmV0Y2hTaXplKGludCBp\nKQogICAgICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAg\nICAgLy8gc29tZSBwb3N0Z3JlcyBkcml2ZXJzIGRvIG5vdCBzdXBwb3J0IHRo\nZSBzZXRGZXRjaFNpemUgbWV0aG9kCiAgICAgICAgICAgIHRyeSB7CiAgICAg\nICAgICAgICAgICBpZiAoX2RpY3Quc3VwcG9ydHNTZXRGZXRjaFNpemUpCiAg\nICAgICAgICAgICAgICAgICAgc3VwZXIuc2V0RmV0Y2hTaXplKGkpOwogICAg\nICAgICAgICB9IGNhdGNoIChTUUxFeGNlcHRpb24gZSkgewogICAgICAgICAg\nICAgICAgX2RpY3Quc3VwcG9ydHNTZXRGZXRjaFNpemUgPSBmYWxzZTsKICAg\nICAgICAgICAgICAgIGlmIChfZGljdC5sb2cuaXNXYXJuRW5hYmxlZCgpKQog\nICAgICAgICAgICAgICAgICAgIF9kaWN0LmxvZy53YXJuKF9sb2MuZ2V0KCJw\nc3FsLW5vLXNldC1mZXRjaC1zaXplIiksIGUpOwogICAgICAgICAgICB9CiAg\nICAgICAgfQogICAgfQp9Cg==\n","encoding":"base64"}

