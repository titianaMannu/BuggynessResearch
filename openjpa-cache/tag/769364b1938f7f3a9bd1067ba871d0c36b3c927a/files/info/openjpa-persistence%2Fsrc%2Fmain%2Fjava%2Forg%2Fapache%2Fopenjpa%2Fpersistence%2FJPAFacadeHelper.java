{"sha":"f03f2081791cd6413a92330ac6ef4b9c72728503","node_id":"MDQ6QmxvYjIwNjM2NDpmMDNmMjA4MTc5MWNkNjQxM2E5MjMzMGFjNmVmNGI5YzcyNzI4NTAz","size":11621,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/f03f2081791cd6413a92330ac6ef4b9c72728503","content":"LyoNCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUNCiAqIG9yIG1vcmUgY29udHJpYnV0b3Ig\nbGljZW5zZSBhZ3JlZW1lbnRzLiAgU2VlIHRoZSBOT1RJQ0UgZmlsZQ0KICog\nZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5m\nb3JtYXRpb24NCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAg\nVGhlIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUNCiAqIHRvIHlvdSB1bmRlciB0\naGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUNCiAqICJMaWNl\nbnNlIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNv\nbXBsaWFuY2UNCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFp\nbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQNCiAqDQogKiBodHRwOi8vd3d3\nLmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjANCiAqDQogKiBVbmxl\nc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGlu\nIHdyaXRpbmcsDQogKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUg\nTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbg0KICogIkFTIElTIiBCQVNJ\nUywgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZDQog\nKiBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBM\naWNlbnNlIGZvciB0aGUNCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmlu\nZyBwZXJtaXNzaW9ucyBhbmQgbGltaXRhdGlvbnMNCiAqIHVuZGVyIHRoZSBM\naWNlbnNlLg0KICovDQpwYWNrYWdlIG9yZy5hcGFjaGUub3BlbmpwYS5wZXJz\naXN0ZW5jZTsNCg0KaW1wb3J0IGphdmEubWF0aC5CaWdEZWNpbWFsOw0KaW1w\nb3J0IGphdmEubWF0aC5CaWdJbnRlZ2VyOw0KaW1wb3J0IGphdmEudXRpbC5B\ncnJheUxpc3Q7DQppbXBvcnQgamF2YS51dGlsLkNvbGxlY3Rpb247DQppbXBv\ncnQgamF2YS51dGlsLkl0ZXJhdG9yOw0KaW1wb3J0IGphdmF4LnBlcnNpc3Rl\nbmNlLkVudGl0eU1hbmFnZXI7DQppbXBvcnQgamF2YXgucGVyc2lzdGVuY2Uu\nRW50aXR5TWFuYWdlckZhY3Rvcnk7DQoNCmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEua2VybmVsLkJyb2tlcjsNCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEua2VybmVsLkJyb2tlckZhY3Rvcnk7DQppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLm1ldGEuQ2xhc3NNZXRhRGF0YTsNCmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEudXRpbC5CaWdEZWNpbWFsSWQ7DQppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLnV0aWwuQmlnSW50ZWdlcklkOw0KaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS51dGlsLkJ5dGVJZDsNCmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEudXRpbC5DaGFySWQ7DQppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLnV0aWwuRG91YmxlSWQ7DQppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0\naWwuRmxvYXRJZDsNCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5J\nZDsNCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5JbXBsSGVscGVy\nOw0KaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLkludElkOw0KaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLkxvbmdJZDsNCmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEudXRpbC5PYmplY3RJZDsNCmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEudXRpbC5PcGVuSlBBSWQ7DQppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLnV0aWwuU2hvcnRJZDsNCmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEudXRpbC5TdHJpbmdJZDsNCmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEubGliLnV0aWwuTG9jYWxpemVyOw0KDQovKioNCiAqIEhlbHBlciBj\nbGFzcyBmb3Igc3dpdGNoaW5nIGJldHdlZW4gT3BlbkpQQSdzIEpQQSBmYWNh\nZGUgYW5kIHRoZSB1bmRlcmx5aW5nDQogKiBCcm9rZXIga2VybmVsLg0KICoN\nCiAqIEBzaW5jZSAxLjAuMA0KICogQG5vamF2YWRvYw0KICovDQpwdWJsaWMg\nY2xhc3MgSlBBRmFjYWRlSGVscGVyIHsNCg0KICAgIHB1YmxpYyBzdGF0aWMg\nZmluYWwgU3RyaW5nIEVNX0tFWSA9DQogICAgICAgICJvcmcuYXBhY2hlLm9w\nZW5qcGEucGVyc2lzdGVuY2UuRW50aXR5TWFuYWdlciI7DQogICAgcHVibGlj\nIHN0YXRpYyBmaW5hbCBTdHJpbmcgRU1GX0tFWSA9DQogICAgICAgICJvcmcu\nYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuRW50aXR5TWFuYWdlckZhY3Rv\ncnkiOw0KDQogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgTG9jYWxpemVyIF9s\nb2MgPQ0KICAgICAgICBMb2NhbGl6ZXIuZm9yUGFja2FnZShKUEFGYWNhZGVI\nZWxwZXIuY2xhc3MpOw0KDQogICAgcHVibGljIHN0YXRpYyBPcGVuSlBBRW50\naXR5TWFuYWdlckZhY3RvcnkgdG9FbnRpdHlNYW5hZ2VyRmFjdG9yeSgNCiAg\nICAgICAgQnJva2VyRmFjdG9yeSBmYWN0b3J5KSB7DQogICAgICAgIGlmIChm\nYWN0b3J5ID09IG51bGwpDQogICAgICAgICAgICByZXR1cm4gbnVsbDsNCg0K\nICAgICAgICBmYWN0b3J5LmxvY2soKTsNCiAgICAgICAgdHJ5IHsNCiAgICAg\nICAgICAgIE9wZW5KUEFFbnRpdHlNYW5hZ2VyRmFjdG9yeSBlbWYgPSAoT3Bl\nbkpQQUVudGl0eU1hbmFnZXJGYWN0b3J5KQ0KICAgICAgICAgICAgICAgIGZh\nY3RvcnkuZ2V0VXNlck9iamVjdChFTUZfS0VZKTsNCiAgICAgICAgICAgIGlm\nIChlbWYgPT0gbnVsbCkgew0KICAgICAgICAgICAgICAgIGVtZiA9IEVudGl0\neU1hbmFnZXJGYWN0b3J5VmFsdWUubmV3RmFjdG9yeShmYWN0b3J5KTsNCiAg\nICAgICAgICAgICAgICBmYWN0b3J5LnB1dFVzZXJPYmplY3QoRU1GX0tFWSwg\nZW1mKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHJldHVybiBlbWY7\nDQogICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7DQogICAgICAgICAg\nICB0aHJvdyBQZXJzaXN0ZW5jZUV4Y2VwdGlvbnMudG9QZXJzaXN0ZW5jZUV4\nY2VwdGlvbihlKTsNCiAgICAgICAgfSBmaW5hbGx5IHsNCiAgICAgICAgICAg\nIGZhY3RvcnkudW5sb2NrKCk7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICAv\nKioNCiAgICAgKiBSZXR1cm4gdGhlIHVuZGVybHlpbmcgYnJva2VyIGZhY3Rv\ncnkgZm9yIHRoZSBnaXZlbiBwZXJzaXN0ZW5jZSBtYW5hZ2VyDQogICAgICog\nZmFjdG9yeSBmYWNhZGUuDQogICAgICovDQogICAgcHVibGljIHN0YXRpYyBC\ncm9rZXJGYWN0b3J5IHRvQnJva2VyRmFjdG9yeShFbnRpdHlNYW5hZ2VyRmFj\ndG9yeSBlbWYpIHsNCiAgICAgICAgaWYgKGVtZiA9PSBudWxsKQ0KICAgICAg\nICAgICAgcmV0dXJuIG51bGw7DQogICAgICAgIGlmICghKGVtZiBpbnN0YW5j\nZW9mIEVudGl0eU1hbmFnZXJGYWN0b3J5SW1wbCkpIHsNCiAgICAgICAgICAg\nIENsYXNzIGMgPSBlbWYuZ2V0Q2xhc3MoKTsNCiAgICAgICAgICAgIHRyeSB7\nDQogICAgICAgICAgICAgICAgLy8gZWl0aGVyIGNhc3QgaGVyZSBtYXkgZmFp\nbA0KICAgICAgICAgICAgICAgIGVtZiA9IChFbnRpdHlNYW5hZ2VyRmFjdG9y\neUltcGwpICgoT3BlbkpQQUVudGl0eU1hbmFnZXJGYWN0b3J5KQ0KICAgICAg\nICAgICAgICAgICAgICBlbWYpLmdldFVzZXJPYmplY3QoRU1GX0tFWSk7DQog\nICAgICAgICAgICB9IGNhdGNoIChDbGFzc0Nhc3RFeGNlcHRpb24gY2NlKSB7\nDQogICAgICAgICAgICAgICAgdGhyb3cgbmV3IEFyZ3VtZW50RXhjZXB0aW9u\nKF9sb2MuZ2V0KA0KICAgICAgICAgICAgICAgICAgICAiY2FudC1jb252ZXJ0\nLWJyb2tlcmZhY3RvcnkiLCBjKSwgbnVsbCwgbnVsbCwgZmFsc2UpOw0KICAg\nICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIHJldHVybiAoKEVudGl0\neU1hbmFnZXJGYWN0b3J5SW1wbCkgZW1mKS5nZXRCcm9rZXJGYWN0b3J5KCk7\nDQogICAgfQ0KDQogICAgLyoqDQogICAgICogUmV0dXJuIGEgcGVyc2lzdGVu\nY2UgbWFuYWdlciBmYWNhZGUgdG8gdGhlIGdpdmVuIGJyb2tlciByZXRhaW5p\nbmcNCiAgICAgKiBwcmV2aW91c2x5IGFzc29jaWF0ZWQgcGVyc2lzdGVuY2Ug\nY29udGV4dCB0eXBlLg0KICAgICAqLw0KICAgIHB1YmxpYyBzdGF0aWMgT3Bl\nbkpQQUVudGl0eU1hbmFnZXIgdG9FbnRpdHlNYW5hZ2VyKEJyb2tlciBicm9r\nZXIpIHsNCiAgICAgICAgaWYgKGJyb2tlciA9PSBudWxsKQ0KICAgICAgICAg\nICAgcmV0dXJuIG51bGw7DQoNCiAgICAgICAgYnJva2VyLmxvY2soKTsNCiAg\nICAgICAgdHJ5IHsNCiAgICAgICAgICAgIE9wZW5KUEFFbnRpdHlNYW5hZ2Vy\nIGVtID0gKE9wZW5KUEFFbnRpdHlNYW5hZ2VyKQ0KICAgICAgICAgICAgICAg\nIGJyb2tlci5nZXRVc2VyT2JqZWN0KEVNX0tFWSk7DQogICAgICAgICAgICBp\nZiAoZW0gPT0gbnVsbCkgew0KICAgICAgICAgICAgICAgIEVudGl0eU1hbmFn\nZXJGYWN0b3J5SW1wbCBlbWYgPSAoRW50aXR5TWFuYWdlckZhY3RvcnlJbXBs\nKQ0KICAgICAgICAgICAgICAgICAgICB0b0VudGl0eU1hbmFnZXJGYWN0b3J5\nKGJyb2tlci5nZXRCcm9rZXJGYWN0b3J5KCkpOw0KICAgICAgICAgICAgICAg\nIGVtID0gZW1mLm5ld0VudGl0eU1hbmFnZXJJbXBsKGJyb2tlcik7DQogICAg\nICAgICAgICAgICAgYnJva2VyLnB1dFVzZXJPYmplY3QoRU1fS0VZLCBlbSk7\nDQogICAgICAgICAgICB9DQogICAgICAgICAgICByZXR1cm4gZW07DQogICAg\nICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7DQogICAgICAgICAgICB0aHJv\ndyBQZXJzaXN0ZW5jZUV4Y2VwdGlvbnMudG9QZXJzaXN0ZW5jZUV4Y2VwdGlv\nbihlKTsNCiAgICAgICAgfSBmaW5hbGx5IHsNCiAgICAgICAgICAgIGJyb2tl\nci51bmxvY2soKTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIC8qKg0KICAg\nICAqIFJldHVybiB0aGUgdW5kZXJseWluZyBicm9rZXIgZm9yIHRoZSBnaXZl\nbiBlbnRpdHkgbWFuYWdlciBmYWNhZGUuDQogICAgICovDQogICAgcHVibGlj\nIHN0YXRpYyBCcm9rZXIgdG9Ccm9rZXIoRW50aXR5TWFuYWdlciBlbSkgew0K\nICAgICAgICBpZiAoZW0gPT0gbnVsbCkNCiAgICAgICAgICAgIHJldHVybiBu\ndWxsOw0KICAgICAgICBpZiAoIShlbSBpbnN0YW5jZW9mIEVudGl0eU1hbmFn\nZXJJbXBsKSkgew0KICAgICAgICAgICAgQ2xhc3MgYyA9IGVtLmdldENsYXNz\nKCk7DQogICAgICAgICAgICB0cnkgew0KICAgICAgICAgICAgICAgIC8vIGVp\ndGhlciBjYXN0IGhlcmUgbWF5IGZhaWwNCiAgICAgICAgICAgICAgICBlbSA9\nIChFbnRpdHlNYW5hZ2VySW1wbCkgKChPcGVuSlBBRW50aXR5TWFuYWdlcikg\nZW0pLg0KICAgICAgICAgICAgICAgICAgICBnZXRVc2VyT2JqZWN0KEVNX0tF\nWSk7DQogICAgICAgICAgICB9IGNhdGNoIChDbGFzc0Nhc3RFeGNlcHRpb24g\nY2NlKSB7DQogICAgICAgICAgICAgICAgdGhyb3cgbmV3IEFyZ3VtZW50RXhj\nZXB0aW9uKF9sb2MuZ2V0KCJjYW50LWNvbnZlcnQtYnJva2VyIiwgYyksDQog\nICAgICAgICAgICAgICAgICAgIG51bGwsIG51bGwsIGZhbHNlKTsNCiAgICAg\nICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICByZXR1cm4gKChFbnRpdHlN\nYW5hZ2VySW1wbCkgZW0pLmdldEJyb2tlcigpOw0KICAgIH0NCg0KICAgIC8q\nKg0KICAgICAqIFJldHVybnMgdGhlIHtAbGluayBvcmcuYXBhY2hlLm9wZW5q\ncGEubWV0YS5DbGFzc01ldGFEYXRhfSBhc3NvY2lhdGVkIHdpdGggdGhlDQog\nICAgICogcGVyc2lzdGVudCBvYmplY3QgPGNvZGU+bzwvY29kZT4uDQogICAg\nICovDQogICAgcHVibGljIHN0YXRpYyBDbGFzc01ldGFEYXRhIGdldE1ldGFE\nYXRhKE9iamVjdCBvKSB7DQogICAgICAgIGlmIChvID09IG51bGwpDQogICAg\nICAgICAgICByZXR1cm4gbnVsbDsNCiAgICAgICAgRW50aXR5TWFuYWdlciBl\nbSA9IE9wZW5KUEFQZXJzaXN0ZW5jZS5nZXRFbnRpdHlNYW5hZ2VyKG8pOw0K\nICAgICAgICByZXR1cm4gKGVtID09IG51bGwpID8gbnVsbCA6IGdldE1ldGFE\nYXRhKGVtLA0KICAgICAgICAgICAgSW1wbEhlbHBlci5nZXRNYW5hZ2VkSW5z\ndGFuY2UobykuZ2V0Q2xhc3MoKSk7DQogICAgfQ0KDQogICAgLyoqDQogICAg\nICogUmV0dXJucyB0aGUge0BsaW5rIG9yZy5hcGFjaGUub3BlbmpwYS5tZXRh\nLkNsYXNzTWV0YURhdGF9IGFzc29jaWF0ZWQNCiAgICAgKiB3aXRoIHRoZSBw\nZXJzaXN0ZW50IHR5cGUgPGNvZGU+Y2xzPC9jb2RlPi4NCiAgICAgKi8NCiAg\nICBwdWJsaWMgc3RhdGljIENsYXNzTWV0YURhdGEgZ2V0TWV0YURhdGEoRW50\naXR5TWFuYWdlciBlbSwgQ2xhc3MgY2xzKSB7DQogICAgICAgIGlmIChlbSA9\nPSBudWxsKQ0KICAgICAgICAgICAgdGhyb3cgbmV3IE51bGxQb2ludGVyRXhj\nZXB0aW9uKCJlbSA9PSBudWxsIik7DQoNCiAgICAgICAgT3BlbkpQQUVudGl0\neU1hbmFnZXJTUEkga2VtID0gKE9wZW5KUEFFbnRpdHlNYW5hZ2VyU1BJKQ0K\nICAgICAgICAgICAgT3BlbkpQQVBlcnNpc3RlbmNlLmNhc3QoZW0pOw0KICAg\nICAgICB0cnkgew0KICAgICAgICAgICAgcmV0dXJuIGtlbS5nZXRDb25maWd1\ncmF0aW9uKCkuZ2V0TWV0YURhdGFSZXBvc2l0b3J5SW5zdGFuY2UoKS4NCiAg\nICAgICAgICAgICAgICBnZXRNZXRhRGF0YShjbHMsIGtlbS5nZXRDbGFzc0xv\nYWRlcigpLCBmYWxzZSk7DQogICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBl\nKSB7DQogICAgICAgICAgICB0aHJvdyBQZXJzaXN0ZW5jZUV4Y2VwdGlvbnMu\ndG9QZXJzaXN0ZW5jZUV4Y2VwdGlvbihlKTsNCiAgICAgICAgfQ0KICAgIH0N\nCg0KICAgIC8qKg0KICAgICAqIFJldHVybnMgdGhlIHtAbGluayBvcmcuYXBh\nY2hlLm9wZW5qcGEubWV0YS5DbGFzc01ldGFEYXRhfSBhc3NvY2lhdGVkDQog\nICAgICogd2l0aCB0aGUgcGVyc2lzdGVudCB0eXBlIDxjb2RlPmNsczwvY29k\nZT4uDQogICAgICovDQogICAgcHVibGljIHN0YXRpYyBDbGFzc01ldGFEYXRh\nIGdldE1ldGFEYXRhKEVudGl0eU1hbmFnZXJGYWN0b3J5IGVtZiwNCiAgICAg\nICAgQ2xhc3MgY2xzKSB7DQogICAgICAgIGlmIChlbWYgPT0gbnVsbCkNCiAg\nICAgICAgICAgIHRocm93IG5ldyBOdWxsUG9pbnRlckV4Y2VwdGlvbigiZW1m\nID09IG51bGwiKTsNCg0KICAgICAgICBPcGVuSlBBRW50aXR5TWFuYWdlckZh\nY3RvcnlTUEkgZW1mU1BJID0NCiAgICAgICAgICAgIChPcGVuSlBBRW50aXR5\nTWFuYWdlckZhY3RvcnlTUEkpIE9wZW5KUEFQZXJzaXN0ZW5jZS5jYXN0KGVt\nZik7DQogICAgICAgIHRyeSB7DQogICAgICAgICAgICByZXR1cm4gZW1mU1BJ\nLmdldENvbmZpZ3VyYXRpb24oKS5nZXRNZXRhRGF0YVJlcG9zaXRvcnlJbnN0\nYW5jZSgpLg0KICAgICAgICAgICAgICAgIGdldE1ldGFEYXRhKGNscywgbnVs\nbCwgZmFsc2UpOw0KICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkgew0K\nICAgICAgICAgICAgdGhyb3cgUGVyc2lzdGVuY2VFeGNlcHRpb25zLnRvUGVy\nc2lzdGVuY2VFeGNlcHRpb24oZSk7DQogICAgICAgIH0NCiAgICB9DQoNCiAg\nICAvKioNCiAgICAgKiBUcmFuc2xhdGUgZnJvbSBhIE9wZW5KUEEgaWRlbnRp\ndHkgb2JqZWN0IHRvIGEgUGVyc2lzdGVuY2Ugb25lLg0KICAgICAqLw0KICAg\nIHB1YmxpYyBzdGF0aWMgT2JqZWN0IGZyb21PcGVuSlBBT2JqZWN0SWQoT2Jq\nZWN0IG9pZCkgew0KICAgICAgICBpZiAob2lkIGluc3RhbmNlb2YgT3BlbkpQ\nQUlkKQ0KICAgICAgICAgICAgcmV0dXJuICgoT3BlbkpQQUlkKSBvaWQpLmdl\ndElkT2JqZWN0KCk7DQogICAgICAgIHJldHVybiBvaWQ7DQogICAgfQ0KDQog\nICAgLyoqDQogICAgICogVHJhbnNsYXRlIGZyb20gYSBQZXJzaXN0ZW5jZSBp\nZGVudGl0eSBvYmplY3QgdG8gYSBPcGVuSlBBIG9uZS4NCiAgICAgKi8NCiAg\nICBwdWJsaWMgc3RhdGljIE9iamVjdCB0b09wZW5KUEFPYmplY3RJZChDbGFz\nc01ldGFEYXRhIG1ldGEsIE9iamVjdCBvaWQpIHsNCiAgICAgICAgaWYgKG9p\nZCA9PSBudWxsIHx8IG1ldGEgPT0gbnVsbCkNCiAgICAgICAgICAgIHJldHVy\nbiBudWxsOw0KDQogICAgICAgIENsYXNzIGNscyA9IG1ldGEuZ2V0RGVzY3Jp\nYmVkVHlwZSgpOw0KICAgICAgICBpZiAobWV0YS5nZXRJZGVudGl0eVR5cGUo\nKSA9PSBDbGFzc01ldGFEYXRhLklEX0RBVEFTVE9SRSkNCiAgICAgICAgICAg\nIHJldHVybiBuZXcgSWQoY2xzLCAoKE51bWJlcikgb2lkKS5sb25nVmFsdWUo\nKSk7DQoNCiAgICAgICAgaWYgKG9pZCBpbnN0YW5jZW9mIEJ5dGUpDQogICAg\nICAgICAgICByZXR1cm4gbmV3IEJ5dGVJZChjbHMsIChCeXRlKSBvaWQpOw0K\nICAgICAgICBpZiAob2lkIGluc3RhbmNlb2YgQ2hhcmFjdGVyKQ0KICAgICAg\nICAgICAgcmV0dXJuIG5ldyBDaGFySWQoY2xzLCAoQ2hhcmFjdGVyKSBvaWQp\nOw0KICAgICAgICBpZiAob2lkIGluc3RhbmNlb2YgRG91YmxlKQ0KICAgICAg\nICAgICAgcmV0dXJuIG5ldyBEb3VibGVJZChjbHMsIChEb3VibGUpIG9pZCk7\nDQogICAgICAgIGlmIChvaWQgaW5zdGFuY2VvZiBGbG9hdCkNCiAgICAgICAg\nICAgIHJldHVybiBuZXcgRmxvYXRJZChjbHMsIChGbG9hdCkgb2lkKTsNCiAg\nICAgICAgaWYgKG9pZCBpbnN0YW5jZW9mIEludGVnZXIpDQogICAgICAgICAg\nICByZXR1cm4gbmV3IEludElkKGNscywgKEludGVnZXIpIG9pZCk7DQogICAg\nICAgIGlmIChvaWQgaW5zdGFuY2VvZiBMb25nKQ0KICAgICAgICAgICAgcmV0\ndXJuIG5ldyBMb25nSWQoY2xzLCAoTG9uZykgb2lkKTsNCiAgICAgICAgaWYg\nKG9pZCBpbnN0YW5jZW9mIFNob3J0KQ0KICAgICAgICAgICAgcmV0dXJuIG5l\ndyBTaG9ydElkKGNscywgKFNob3J0KSBvaWQpOw0KICAgICAgICBpZiAob2lk\nIGluc3RhbmNlb2YgU3RyaW5nKQ0KICAgICAgICAgICAgcmV0dXJuIG5ldyBT\ndHJpbmdJZChjbHMsIChTdHJpbmcpIG9pZCk7DQogICAgICAgIGlmIChvaWQg\naW5zdGFuY2VvZiBCaWdEZWNpbWFsKQ0KICAgICAgICAgICAgcmV0dXJuIG5l\ndyBCaWdEZWNpbWFsSWQoY2xzLCAoQmlnRGVjaW1hbCkgb2lkKTsNCiAgICAg\nICAgaWYgKG9pZCBpbnN0YW5jZW9mIEJpZ0ludGVnZXIpDQogICAgICAgICAg\nICByZXR1cm4gbmV3IEJpZ0ludGVnZXJJZChjbHMsIChCaWdJbnRlZ2VyKSBv\naWQpOw0KICAgICAgICByZXR1cm4gbmV3IE9iamVjdElkKGNscywgb2lkKTsN\nCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiBSZXR1cm4gYW4gYXJyYXkgb2Yg\nT3BlbkpQQSBvaWRzIGZvciB0aGUgZ2l2ZW4gbmF0aXZlIG9pZCBhcnJheS4N\nCiAgICAgKi8NCiAgICBwdWJsaWMgc3RhdGljIE9iamVjdFtdIHRvT3BlbkpQ\nQU9iamVjdElkcyhDbGFzc01ldGFEYXRhIG1ldGEsDQogICAgICAgIE9iamVj\ndC4uLiBvaWRzKSB7DQogICAgICAgIGlmIChvaWRzID09IG51bGwgfHwgb2lk\ncy5sZW5ndGggPT0gMCkNCiAgICAgICAgICAgIHJldHVybiBvaWRzOw0KDQog\nICAgICAgIC8vIHNpbmNlIHRoZSBjbGFzcyBpZiBmaXhlZCBmb3IgYWxsIG9p\nZHMsIHdlIGNhbiB0ZWxsIGlmIHdlIGhhdmUgdG8NCiAgICAgICAgLy8gdHJh\nbnNsYXRlIHRoZSBhcnJheSBiYXNlZCBvbiB3aGV0aGVyIHRoZSBmaXJzdCBv\naWQgbmVlZHMgdHJhbnNsYXRpbmcNCiAgICAgICAgT2JqZWN0IG9pZCA9IHRv\nT3BlbkpQQU9iamVjdElkKG1ldGEsIG9pZHNbMF0pOw0KICAgICAgICBpZiAo\nb2lkID09IG9pZHNbMF0pDQogICAgICAgICAgICByZXR1cm4gb2lkczsNCg0K\nICAgICAgICBPYmplY3RbXSBjb3B5ID0gbmV3IE9iamVjdFtvaWRzLmxlbmd0\naF07DQogICAgICAgIGNvcHlbMF0gPSBvaWQ7DQogICAgICAgIGZvciAoaW50\nIGkgPSAxOyBpIDwgb2lkcy5sZW5ndGg7IGkrKykNCiAgICAgICAgICAgIGNv\ncHlbaV0gPSB0b09wZW5KUEFPYmplY3RJZChtZXRhLCBvaWRzW2ldKTsNCiAg\nICAgICAgcmV0dXJuIGNvcHk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog\nUmV0dXJuIGEgY29sbGVjdGlvbiBvZiBPcGVuSlBBIG9pZHMgZm9yIHRoZSBn\naXZlbiBuYXRpdmUgb2lkIGNvbGxlY3Rpb24uDQogICAgICovDQogICAgcHVi\nbGljIHN0YXRpYyBDb2xsZWN0aW9uIHRvT3BlbkpQQU9iamVjdElkcyhDbGFz\nc01ldGFEYXRhIG1ldGEsDQogICAgICAgIENvbGxlY3Rpb24gb2lkcykgew0K\nICAgICAgICBpZiAob2lkcyA9PSBudWxsIHx8IG9pZHMuaXNFbXB0eSgpKQ0K\nICAgICAgICAgICAgcmV0dXJuIG9pZHM7DQoNCiAgICAgICAgLy8gc2luY2Ug\ndGhlIGNsYXNzIGlmIGZpeGVkIGZvciBhbGwgb2lkcywgd2UgY2FuIHRlbGwg\naWYgd2UgaGF2ZSB0bw0KICAgICAgICAvLyB0cmFuc2xhdGUgdGhlIGFycmF5\nIGJhc2VkIG9uIHdoZXRoZXIgdGhlIGZpcnN0IG9pZCBuZWVkcyB0cmFuc2xh\ndGluZw0KICAgICAgICBJdGVyYXRvciBpdHIgPSBvaWRzLml0ZXJhdG9yKCk7\nDQogICAgICAgIE9iamVjdCBvcmlnID0gaXRyLm5leHQoKTsNCiAgICAgICAg\nT2JqZWN0IG9pZCA9IHRvT3BlbkpQQU9iamVjdElkKG1ldGEsIG9yaWcpOw0K\nICAgICAgICBpZiAob2lkID09IG9yaWcpDQogICAgICAgICAgICByZXR1cm4g\nb2lkczsNCg0KICAgICAgICBDb2xsZWN0aW9uIGNvcHkgPSBuZXcgQXJyYXlM\naXN0KG9pZHMuc2l6ZSgpKTsNCiAgICAgICAgY29weS5hZGQob2lkKTsNCiAg\nICAgICAgd2hpbGUgKGl0ci5oYXNOZXh0KCkpDQogICAgICAgICAgICBjb3B5\nLmFkZCh0b09wZW5KUEFPYmplY3RJZChtZXRhLCBpdHIubmV4dCgpKSk7DQog\nICAgICAgIHJldHVybiBjb3B5Ow0KICAgIH0NCg0KICAgIC8qKg0KICAgICAq\nIFRyYW5zbGF0ZSBmcm9tIGEgT3BlbkpQQSBpZGVudGl0eSBjbGFzcyB0byBh\nIG5hdGl2ZSBvbmUuDQogICAgICovDQogICAgcHVibGljIHN0YXRpYyBDbGFz\ncyBmcm9tT3BlbkpQQU9iamVjdElkQ2xhc3MoQ2xhc3Mgb2lkQ2xhc3MpIHsN\nCiAgICAgICAgaWYgKG9pZENsYXNzID09IG51bGwpDQogICAgICAgICAgICBy\nZXR1cm4gbnVsbDsNCiAgICAgICAgaWYgKG9pZENsYXNzID09IElkLmNsYXNz\nKQ0KICAgICAgICAgICAgcmV0dXJuIExvbmcuY2xhc3M7DQogICAgICAgIGlm\nIChvaWRDbGFzcyA9PSBCeXRlSWQuY2xhc3MpDQogICAgICAgICAgICByZXR1\ncm4gQnl0ZS5jbGFzczsNCiAgICAgICAgaWYgKG9pZENsYXNzID09IENoYXJJ\nZC5jbGFzcykNCiAgICAgICAgICAgIHJldHVybiBDaGFyYWN0ZXIuY2xhc3M7\nDQogICAgICAgIGlmIChvaWRDbGFzcyA9PSBEb3VibGVJZC5jbGFzcykNCiAg\nICAgICAgICAgIHJldHVybiBEb3VibGUuY2xhc3M7DQogICAgICAgIGlmIChv\naWRDbGFzcyA9PSBGbG9hdElkLmNsYXNzKQ0KICAgICAgICAgICAgcmV0dXJu\nIEZsb2F0LmNsYXNzOw0KICAgICAgICBpZiAob2lkQ2xhc3MgPT0gSW50SWQu\nY2xhc3MpDQogICAgICAgICAgICByZXR1cm4gSW50ZWdlci5jbGFzczsNCiAg\nICAgICAgaWYgKG9pZENsYXNzID09IExvbmdJZC5jbGFzcykNCiAgICAgICAg\nICAgIHJldHVybiBMb25nLmNsYXNzOw0KICAgICAgICBpZiAob2lkQ2xhc3Mg\nPT0gU2hvcnRJZC5jbGFzcykNCiAgICAgICAgICAgIHJldHVybiBTaG9ydC5j\nbGFzczsNCiAgICAgICAgaWYgKG9pZENsYXNzID09IFN0cmluZ0lkLmNsYXNz\nKQ0KICAgICAgICAgICAgcmV0dXJuIFN0cmluZy5jbGFzczsNCiAgICAgICAg\naWYgKG9pZENsYXNzID09IEJpZ0RlY2ltYWxJZC5jbGFzcykNCiAgICAgICAg\nICAgIHJldHVybiBCaWdEZWNpbWFsLmNsYXNzOw0KICAgICAgICBpZiAob2lk\nQ2xhc3MgPT0gQmlnSW50ZWdlcklkLmNsYXNzKQ0KICAgICAgICAgICAgcmV0\ndXJuIEJpZ0ludGVnZXIuY2xhc3M7DQogICAgICAgIHJldHVybiBvaWRDbGFz\nczsNCgl9DQp9DQo=\n","encoding":"base64"}

