{"sha":"9b1cff7e4b4fa8d44108135d19b3934aef3a3dc4","node_id":"MDQ6QmxvYjIwNjM2NDo5YjFjZmY3ZTRiNGZhOGQ0NDEwODEzNWQxOWIzOTM0YWVmM2EzZGM0","size":6754,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/9b1cff7e4b4fa8d44108135d19b3934aef3a3dc4","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UudGVzdDsK\nCmltcG9ydCBqYXZhLmxhbmcucmVmbGVjdC5Nb2RpZmllcjsKaW1wb3J0IGph\ndmEudXRpbC5BcnJheUxpc3Q7CmltcG9ydCBqYXZhLnV0aWwuSXRlcmF0b3I7\nCmltcG9ydCBqYXZhLnV0aWwuTGlzdDsKaW1wb3J0IGphdmEudXRpbC5NYXA7\nCmltcG9ydCBqYXZhLnV0aWwuSGFzaE1hcDsKaW1wb3J0IGphdmF4LnBlcnNp\nc3RlbmNlLkVudGl0eU1hbmFnZXI7CmltcG9ydCBqYXZheC5wZXJzaXN0ZW5j\nZS5FbnRpdHlNYW5hZ2VyRmFjdG9yeTsKaW1wb3J0IGphdmF4LnBlcnNpc3Rl\nbmNlLlBlcnNpc3RlbmNlOwoKaW1wb3J0IGp1bml0LmZyYW1ld29yay5UZXN0\nQ2FzZTsKaW1wb3J0IGp1bml0LmZyYW1ld29yay5UZXN0UmVzdWx0OwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5BYnN0cmFjdEJyb2tlckZh\nY3Rvcnk7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLkJyb2tl\ncjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRhLkNsYXNzTWV0YURh\ndGE7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuT3Bl\nbkpQQUVudGl0eU1hbmFnZXJGYWN0b3J5U1BJOwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLnBlcnNpc3RlbmNlLkpQQUZhY2FkZUhlbHBlcjsKCi8qKgog\nKiBCYXNlIHRlc3QgY2xhc3MgcHJvdmlkaW5nIHBlcnNpc3RlbmNlIHV0aWxp\ndGllcy4KICovCnB1YmxpYyBhYnN0cmFjdCBjbGFzcyBQZXJzaXN0ZW5jZVRl\nc3RDYXNlCiAgICBleHRlbmRzIFRlc3RDYXNlIHsKCiAgICAvKioKICAgICAq\nIE1hcmtlciBvYmplY3QgeW91IGFuIHBhc3MgdG8ge0BsaW5rICNzZXRVcH0g\ndG8gaW5kaWNhdGUgdGhhdCB0aGUKICAgICAqIGRhdGFiYXNlIHRhYmxlcyBz\naG91bGQgYmUgY2xlYXJlZC4KICAgICAqLwogICAgcHJvdGVjdGVkIHN0YXRp\nYyBmaW5hbCBPYmplY3QgQ0xFQVJfVEFCTEVTID0gbmV3IE9iamVjdCgpOwoK\nICAgIC8qKgogICAgICogVGhlIHtAbGluayBUZXN0UmVzdWx0fSBpbnN0YW5j\nZSBmb3IgdGhlIGN1cnJlbnQgdGVzdCBydW4uCiAgICAgKi8KICAgIHByb3Rl\nY3RlZCBUZXN0UmVzdWx0IHRlc3RSZXN1bHQ7CgogICAgLyoqCiAgICAgKiBD\ncmVhdGUgYW4gZW50aXR5IG1hbmFnZXIgZmFjdG9yeS4gUHV0IHtAbGluayAj\nQ0xFQVJfVEFCTEVTfSBpbgogICAgICogdGhpcyBsaXN0IHRvIHRlbGwgdGhl\nIHRlc3QgZnJhbWV3b3JrIHRvIGRlbGV0ZSBhbGwgdGFibGUgY29udGVudHMK\nICAgICAqIGJlZm9yZSBydW5uaW5nIHRoZSB0ZXN0cy4KICAgICAqCiAgICAg\nKiBAcGFyYW0gcHJvcHMgbGlzdCBvZiBwZXJzaXN0ZW50IHR5cGVzIHVzZWQg\naW4gdGVzdGluZyBhbmQvb3IgCiAgICAgKiBjb25maWd1cmF0aW9uIHZhbHVl\ncyBpbiB0aGUgZm9ybSBrZXksdmFsdWUsa2V5LHZhbHVlLi4uCiAgICAgKi8K\nICAgIHByb3RlY3RlZCBPcGVuSlBBRW50aXR5TWFuYWdlckZhY3RvcnlTUEkg\nY3JlYXRlRU1GKE9iamVjdC4uLiBwcm9wcykgewogICAgICAgIE1hcCBtYXAg\nPSBuZXcgSGFzaE1hcChTeXN0ZW0uZ2V0UHJvcGVydGllcygpKTsKICAgICAg\nICBMaXN0PENsYXNzPiB0eXBlcyA9IG5ldyBBcnJheUxpc3Q8Q2xhc3M+KCk7\nCiAgICAgICAgYm9vbGVhbiBwcm9wID0gZmFsc2U7CiAgICAgICAgZm9yIChp\nbnQgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgewogICAgICAgICAg\nICBpZiAocHJvcCkgewogICAgICAgICAgICAgICAgbWFwLnB1dChwcm9wc1tp\nIC0gMV0sIHByb3BzW2ldKTsKICAgICAgICAgICAgICAgIHByb3AgPSBmYWxz\nZTsKICAgICAgICAgICAgfSBlbHNlIGlmIChwcm9wc1tpXSA9PSBDTEVBUl9U\nQUJMRVMpIHsKICAgICAgICAgICAgICAgIG1hcC5wdXQoIm9wZW5qcGEuamRi\nYy5TeW5jaHJvbml6ZU1hcHBpbmdzIiwKICAgICAgICAgICAgICAgICAgICAi\nYnVpbGRTY2hlbWEoRm9yZWlnbktleXM9dHJ1ZSwiIAogICAgICAgICAgICAg\nICAgICAgICsgIlNjaGVtYUFjdGlvbj0nYWRkLGRlbGV0ZVRhYmxlQ29udGVu\ndHMnKSIpOwogICAgICAgICAgICB9IGVsc2UgaWYgKHByb3BzW2ldIGluc3Rh\nbmNlb2YgQ2xhc3MpCiAgICAgICAgICAgICAgICB0eXBlcy5hZGQoKENsYXNz\nKSBwcm9wc1tpXSk7CiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAg\nIHByb3AgPSB0cnVlOwogICAgICAgIH0KCiAgICAgICAgaWYgKCF0eXBlcy5p\nc0VtcHR5KCkpIHsKICAgICAgICAgICAgU3RyaW5nQnVmZmVyIGJ1ZiA9IG5l\ndyBTdHJpbmdCdWZmZXIoKTsKICAgICAgICAgICAgZm9yIChDbGFzcyBjIDog\ndHlwZXMpIHsKICAgICAgICAgICAgICAgIGlmIChidWYubGVuZ3RoKCkgPiAw\nKQogICAgICAgICAgICAgICAgICAgIGJ1Zi5hcHBlbmQoIjsiKTsKICAgICAg\nICAgICAgICAgIGJ1Zi5hcHBlbmQoYy5nZXROYW1lKCkpOwogICAgICAgICAg\nICB9CiAgICAgICAgICAgIG1hcC5wdXQoIm9wZW5qcGEuTWV0YURhdGFGYWN0\nb3J5IiwKICAgICAgICAgICAgICAgICJqcGEoVHlwZXM9IiArIGJ1Zi50b1N0\ncmluZygpICsgIikiKTsKICAgICAgICB9CgogICAgICAgIHJldHVybiAoT3Bl\nbkpQQUVudGl0eU1hbmFnZXJGYWN0b3J5U1BJKSBQZXJzaXN0ZW5jZS4KICAg\nICAgICAgICAgY3JlYXRlRW50aXR5TWFuYWdlckZhY3RvcnkoZ2V0UGVyc2lz\ndGVuY2VVbml0TmFtZSgpLCBtYXApOwogICAgfQoKICAgIHByb3RlY3RlZCBT\ndHJpbmcgZ2V0UGVyc2lzdGVuY2VVbml0TmFtZSgpIHsKICAgICAgICByZXR1\ncm4gInRlc3QiOwogICAgfQoKICAgIEBPdmVycmlkZQogICAgcHVibGljIHZv\naWQgcnVuKFRlc3RSZXN1bHQgdGVzdFJlc3VsdCkgewogICAgICAgIHRoaXMu\ndGVzdFJlc3VsdCA9IHRlc3RSZXN1bHQ7CiAgICAgICAgc3VwZXIucnVuKHRl\nc3RSZXN1bHQpOwogICAgfQoKICAgIEBPdmVycmlkZQogICAgcHVibGljIHZv\naWQgdGVhckRvd24oKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICB0cnkg\newogICAgICAgICAgICBzdXBlci50ZWFyRG93bigpOwogICAgICAgIH0gY2F0\nY2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgIC8vIGlmIGEgdGVzdCBm\nYWlsZWQsIHN3YWxsb3cgYW55IGV4Y2VwdGlvbnMgdGhhdCBoYXBwZW4KICAg\nICAgICAgICAgLy8gZHVyaW5nIHRlYXItZG93biwgYXMgdGhlc2UganVzdCBt\nYXNrIHRoZSBvcmlnaW5hbCBwcm9ibGVtLgogICAgICAgICAgICBpZiAodGVz\ndFJlc3VsdC53YXNTdWNjZXNzZnVsKCkpCiAgICAgICAgICAgICAgICB0aHJv\ndyBlOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIFNhZmVseSBj\nbG9zZSB0aGUgZ2l2ZW4gZmFjdG9yeS4KICAgICAqLwogICAgcHJvdGVjdGVk\nIGJvb2xlYW4gY2xvc2VFTUYoRW50aXR5TWFuYWdlckZhY3RvcnkgZW1mKSB7\nCiAgICAgICAgaWYgKGVtZiA9PSBudWxsKQogICAgICAgICAgICByZXR1cm4g\nZmFsc2U7CiAgICAgICAgaWYgKCFlbWYuaXNPcGVuKCkpCiAgICAgICAgICAg\nIHJldHVybiBmYWxzZTsKCiAgICAgICAgZm9yIChJdGVyYXRvciBpdGVyID0g\nKChBYnN0cmFjdEJyb2tlckZhY3RvcnkpIEpQQUZhY2FkZUhlbHBlcgogICAg\nICAgICAgICAudG9Ccm9rZXJGYWN0b3J5KGVtZikpLmdldE9wZW5Ccm9rZXJz\nKCkuaXRlcmF0b3IoKTsKICAgICAgICAgICAgaXRlci5oYXNOZXh0KCk7ICkg\newogICAgICAgICAgICBCcm9rZXIgYiA9IChCcm9rZXIpIGl0ZXIubmV4dCgp\nOwogICAgICAgICAgICBpZiAoYiAhPSBudWxsICYmICFiLmlzQ2xvc2VkKCkp\nIHsKICAgICAgICAgICAgICAgIEVudGl0eU1hbmFnZXIgZW0gPSBKUEFGYWNh\nZGVIZWxwZXIudG9FbnRpdHlNYW5hZ2VyKGIpOwogICAgICAgICAgICAgICAg\naWYgKGVtLmdldFRyYW5zYWN0aW9uKCkuaXNBY3RpdmUoKSkKICAgICAgICAg\nICAgICAgICAgICBlbS5nZXRUcmFuc2FjdGlvbigpLnJvbGxiYWNrKCk7CiAg\nICAgICAgICAgICAgICBlbS5jbG9zZSgpOwogICAgICAgICAgICB9CiAgICAg\nICAgfQoKICAgICAgICBlbWYuY2xvc2UoKTsKICAgICAgICByZXR1cm4gIWVt\nZi5pc09wZW4oKTsKICAgIH0KCiAgICAvKioKICAgICAqIERlbGV0ZSBhbGwg\naW5zdGFuY2VzIG9mIHRoZSBnaXZlbiB0eXBlcyB1c2luZyBidWxrIGRlbGV0\nZSBxdWVyaWVzLgogICAgICovCiAgICBwcm90ZWN0ZWQgdm9pZCBjbGVhcihF\nbnRpdHlNYW5hZ2VyRmFjdG9yeSBlbWYsIENsYXNzLi4uIHR5cGVzKSB7CiAg\nICAgICAgaWYgKGVtZiA9PSBudWxsIHx8IHR5cGVzLmxlbmd0aCA9PSAwKQog\nICAgICAgICAgICByZXR1cm47CgogICAgICAgIExpc3Q8Q2xhc3NNZXRhRGF0\nYT4gbWV0YXMgPSBuZXcgQXJyYXlMaXN0PENsYXNzTWV0YURhdGE+KHR5cGVz\nLmxlbmd0aCk7CiAgICAgICAgZm9yIChDbGFzcyBjIDogdHlwZXMpIHsKICAg\nICAgICAgICAgQ2xhc3NNZXRhRGF0YSBtZXRhID0gSlBBRmFjYWRlSGVscGVy\nLmdldE1ldGFEYXRhKGVtZiwgYyk7CiAgICAgICAgICAgIGlmIChtZXRhICE9\nIG51bGwpCiAgICAgICAgICAgICAgICBtZXRhcy5hZGQobWV0YSk7CiAgICAg\nICAgfQogICAgICAgIGNsZWFyKGVtZiwgbWV0YXMudG9BcnJheShuZXcgQ2xh\nc3NNZXRhRGF0YVttZXRhcy5zaXplKCldKSk7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBEZWxldGUgYWxsIGluc3RhbmNlcyBvZiB0aGUgcGVyc2lzdGVudCB0\neXBlcyByZWdpc3RlcmVkIHdpdGggdGhlIGdpdmVuCiAgICAgKiBmYWN0b3J5\nIHVzaW5nIGJ1bGsgZGVsZXRlIHF1ZXJpZXMuCiAgICAgKi8KICAgIHByb3Rl\nY3RlZCB2b2lkIGNsZWFyKEVudGl0eU1hbmFnZXJGYWN0b3J5IGVtZikgewog\nICAgICAgIGlmIChlbWYgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuOwog\nICAgICAgIGNsZWFyKGVtZiwgKChPcGVuSlBBRW50aXR5TWFuYWdlckZhY3Rv\ncnlTUEkpIGVtZikuZ2V0Q29uZmlndXJhdGlvbigpLgogICAgICAgICAgICBn\nZXRNZXRhRGF0YVJlcG9zaXRvcnlJbnN0YW5jZSgpLmdldE1ldGFEYXRhcygp\nKTsKICAgIH0KCiAgICAvKioKICAgICAqIERlbGV0ZSBhbGwgaW5zdGFuY2Vz\nIG9mIHRoZSBnaXZlbiB0eXBlcyB1c2luZyBidWxrIGRlbGV0ZSBxdWVyaWVz\nLgogICAgICovCiAgICBwcml2YXRlIHZvaWQgY2xlYXIoRW50aXR5TWFuYWdl\nckZhY3RvcnkgZW1mLCBDbGFzc01ldGFEYXRhLi4uIHR5cGVzKSB7CiAgICAg\nICAgaWYgKGVtZiA9PSBudWxsIHx8IHR5cGVzLmxlbmd0aCA9PSAwKQogICAg\nICAgICAgICByZXR1cm47CgogICAgICAgIEVudGl0eU1hbmFnZXIgZW0gPSBl\nbWYuY3JlYXRlRW50aXR5TWFuYWdlcigpOwogICAgICAgIGVtLmdldFRyYW5z\nYWN0aW9uKCkuYmVnaW4oKTsKICAgICAgICBmb3IgKENsYXNzTWV0YURhdGEg\nbWV0YSA6IHR5cGVzKSB7CiAgICAgICAgICAgIGlmICghbWV0YS5pc01hcHBl\nZCgpIHx8IG1ldGEuaXNFbWJlZGRlZE9ubHkoKSAKICAgICAgICAgICAgICAg\nIHx8IE1vZGlmaWVyLmlzQWJzdHJhY3QobWV0YS5nZXREZXNjcmliZWRUeXBl\nKCkuZ2V0TW9kaWZpZXJzKCkpKQogICAgICAgICAgICAgICAgY29udGludWU7\nCiAgICAgICAgICAgIGVtLmNyZWF0ZVF1ZXJ5KCJERUxFVEUgRlJPTSAiICsg\nbWV0YS5nZXRUeXBlQWxpYXMoKSArICIgbyIpLgogICAgICAgICAgICAgICAg\nZXhlY3V0ZVVwZGF0ZSgpOwogICAgICAgIH0KICAgICAgICBlbS5nZXRUcmFu\nc2FjdGlvbigpLmNvbW1pdCgpOwogICAgICAgIGVtLmNsb3NlKCk7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIGVudGl0eSBuYW1lIGZvciB0\naGUgZ2l2ZW4gdHlwZS4gICAKICAgICAqLwogICAgcHJvdGVjdGVkIFN0cmlu\nZyBlbnRpdHlOYW1lKEVudGl0eU1hbmFnZXJGYWN0b3J5IGVtZiwgQ2xhc3Mg\nYykgewogICAgICAgIENsYXNzTWV0YURhdGEgbWV0YSA9IEpQQUZhY2FkZUhl\nbHBlci5nZXRNZXRhRGF0YShlbWYsIGMpOwogICAgICAgIHJldHVybiAobWV0\nYSA9PSBudWxsKSA/IG51bGwgOiBtZXRhLmdldFR5cGVBbGlhcygpOwogICAg\nfQp9Cg==\n","encoding":"base64"}

