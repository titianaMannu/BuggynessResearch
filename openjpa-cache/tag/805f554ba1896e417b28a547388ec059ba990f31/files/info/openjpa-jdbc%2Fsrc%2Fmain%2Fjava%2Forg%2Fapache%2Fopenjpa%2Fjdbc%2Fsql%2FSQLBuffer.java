{"sha":"d98483e7287c54d29510c693e9c93bf1a6c0bab7","node_id":"MDQ6QmxvYjIwNjM2NDpkOTg0ODNlNzI4N2M1NGQyOTUxMGM2OTNlOWM5M2JmMWE2YzBiYWI3","size":22755,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/d98483e7287c54d29510c693e9c93bf1a6c0bab7","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zcWw7CgppbXBvcnQg\namF2YS5pby5TZXJpYWxpemFibGU7CmltcG9ydCBqYXZhLnNxbC5DYWxsYWJs\nZVN0YXRlbWVudDsKaW1wb3J0IGphdmEuc3FsLkNvbm5lY3Rpb247CmltcG9y\ndCBqYXZhLnNxbC5QcmVwYXJlZFN0YXRlbWVudDsKaW1wb3J0IGphdmEuc3Fs\nLlJlc3VsdFNldDsKaW1wb3J0IGphdmEuc3FsLlNRTEV4Y2VwdGlvbjsKaW1w\nb3J0IGphdmEudXRpbC5BcnJheUxpc3Q7CmltcG9ydCBqYXZhLnV0aWwuQ29s\nbGVjdGlvbnM7CmltcG9ydCBqYXZhLnV0aWwuSXRlcmF0b3I7CmltcG9ydCBq\nYXZhLnV0aWwuTGlzdDsKCmltcG9ydCBvcmcuYXBhY2hlLmNvbW1vbnMubGFu\nZy5PYmplY3RVdGlsczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJj\nLmlkZW50aWZpZXIuREJJZGVudGlmaWVyOwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLmpkYmMua2VybmVsLkpEQkNGZXRjaENvbmZpZ3VyYXRpb247Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5rZXJuZWwuZXhwcy5Db2xs\nZWN0aW9uUGFyYW07CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5r\nZXJuZWwuZXhwcy5WYWw7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRi\nYy5zY2hlbWEuQ29sdW1uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpk\nYmMuc2NoZW1hLlNlcXVlbmNlOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLmpkYmMuc2NoZW1hLlRhYmxlOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLmtlcm5lbC5leHBzLlBhcmFtZXRlcjsKCgovKioKICogQnVmZmVyIGZvciBT\nUUwgc3RhdGVtZW50cyB0aGF0IGNhbiBiZSB1c2VkIHRvIGNyZWF0ZQogKiBq\nYXZhLnNxbC5QcmVwYXJlZFN0YXRlbWVudHMuCiAqIFRoaXMgYnVmZmVyIGhv\nbGRzIHRoZSBTUUwgc3RhdGVtZW50IHBhcmFtZXRlcnMgYW5kIHRoZWlyIGNv\ncnJlc3BvbmRpbmcgCiAqIGNvbHVtbnMuIFRoZSBwYXJhbWV0ZXJzIGludHJv\nZHVjZWQgYnkgdGhlIHJ1bnRpbWUgc3lzdGVtIGFyZSBkaXN0aW5ndWlzaGVk\nCiAqIGZyb20gdGhlIHBhcmFtZXRlcnMgc2V0IGJ5IHRoZSB1c2VyLiAgCiAq\nCiAqIEBhdXRob3IgTWFyYyBQcnVkJ2hvbW1lYXV4CiAqIEBhdXRob3IgQWJl\nIFdoaXRlCiAqIEBhdXRob3IgUGluYWtpIFBvZGRhcgogKiAKICogQHNpbmNl\nIDAuMi40CiAqLwpwdWJsaWMgZmluYWwgY2xhc3MgU1FMQnVmZmVyCiAgICBp\nbXBsZW1lbnRzIFNlcmlhbGl6YWJsZSwgQ2xvbmVhYmxlIHsKCiAgICBwcml2\nYXRlIHN0YXRpYyBmaW5hbCBTdHJpbmcgUEFSQU1FVEVSX1RPS0VOID0gIj8i\nOwoKICAgIHByaXZhdGUgZmluYWwgREJEaWN0aW9uYXJ5IF9kaWN0OwogICAg\ncHJpdmF0ZSBmaW5hbCBTdHJpbmdCdWlsZGVyIF9zcWwgPSBuZXcgU3RyaW5n\nQnVpbGRlcigpOwogICAgcHJpdmF0ZSBMaXN0IF9zdWJzZWxzID0gbnVsbDsK\nICAgIHByaXZhdGUgTGlzdCBfcGFyYW1zID0gbnVsbDsKICAgIHByaXZhdGUg\nTGlzdCBfY29scyA9IG51bGw7CiAgICAKICAgIC8vIEV2ZW4gZWxlbWVudCBy\nZWZlcnMgdG8gYW4gaW5kZXggb2YgdGhlIF9wYXJhbXMgbGlzdAogICAgLy8g\nT2RkIGVsZW1lbnQgcmVmZXJzIHRvIHRoZSB1c2VyIHBhcmFtZXRlcgogICAg\ncHJpdmF0ZSBMaXN0IF91c2VySW5kZXggPSBudWxsOwogICAgcHJpdmF0ZSBM\naXN0IF91c2VyUGFyYW1zID0gbnVsbDsKICAgIAogICAgLyoqCiAgICAgKiBE\nZWZhdWx0IGNvbnN0cnVjdG9yLgogICAgICovCiAgICBwdWJsaWMgU1FMQnVm\nZmVyKERCRGljdGlvbmFyeSBkaWN0KSB7CiAgICAgICAgX2RpY3QgPSBkaWN0\nOwogICAgfQoKICAgIC8qKgogICAgICogQ29weSBjb25zdHJ1Y3Rvci4KICAg\nICAqLwogICAgcHVibGljIFNRTEJ1ZmZlcihTUUxCdWZmZXIgYnVmKSB7CiAg\nICAgICAgX2RpY3QgPSBidWYuX2RpY3Q7CiAgICAgICAgYXBwZW5kKGJ1Zik7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBQZXJmb3JtIGEgc2hhbGxvdyBjbG9u\nZSBvZiB0aGlzIFNRTCBCdWZmZXIuCiAgICAgKi8KICAgIHB1YmxpYyBPYmpl\nY3QgY2xvbmUoKSB7CiAgICAgICAgcmV0dXJuIG5ldyBTUUxCdWZmZXIodGhp\ncyk7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gdHJ1ZSBpZiB0aGUg\nYnVmZmVyIGlzIGVtdHB5LgogICAgICovCiAgICBwdWJsaWMgYm9vbGVhbiBp\nc0VtcHR5KCkgewogICAgICAgIHJldHVybiBfc3FsLmxlbmd0aCgpID09IDA7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBBcHBlbmQgYWxsIFNRTCBhbmQgcGFy\nYW1ldGVycyBvZiB0aGUgZ2l2ZW4gYnVmZmVyLgogICAgICovCiAgICBwdWJs\naWMgU1FMQnVmZmVyIGFwcGVuZChTUUxCdWZmZXIgYnVmKSB7CiAgICAgICAg\nYXBwZW5kKGJ1ZiwgX3NxbC5sZW5ndGgoKSwgKF9wYXJhbXMgPT0gbnVsbCkg\nPyAwIDogX3BhcmFtcy5zaXplKCksCiAgICAgICAgICAgIHRydWUpOwogICAg\nICAgIHJldHVybiB0aGlzOwogICAgfQoKICAgIC8qKgogICAgICogQXBwZW5k\nIGFsbCBTUUwgYW5kIHBhcmFtZXRlcnMgb2YgdGhlIGdpdmVuIGJ1ZmZlciBh\ndCB0aGUgZ2l2ZW4gcG9zaXRpb25zLgogICAgICovCiAgICBwcml2YXRlIHZv\naWQgYXBwZW5kKFNRTEJ1ZmZlciBidWYsIGludCBzcWxJbmRleCwgaW50IHBh\ncmFtSW5kZXgsCiAgICAgICAgYm9vbGVhbiBzdWJzZWxzKSB7CiAgICAgICAg\naWYgKHN1YnNlbHMpIHsKICAgICAgICAgICAgLy8gb25seSBhbGxvdyBhcHBl\nbmRpbmcgb2YgYnVmZmVycyB3aXRoIHN1YnNlbGVjdHMsIG5vdCBpbnNlcnRp\nb24KICAgICAgICAgICAgaWYgKF9zdWJzZWxzICE9IG51bGwgJiYgIV9zdWJz\nZWxzLmlzRW1wdHkoKQogICAgICAgICAgICAgICAgJiYgc3FsSW5kZXggIT0g\nX3NxbC5sZW5ndGgoKSkKICAgICAgICAgICAgICAgIHRocm93IG5ldyBJbGxl\nZ2FsU3RhdGVFeGNlcHRpb24oKTsKICAgICAgICAgICAgaWYgKGJ1Zi5fc3Vi\nc2VscyAhPSBudWxsICYmICFidWYuX3N1YnNlbHMuaXNFbXB0eSgpKSB7CiAg\nICAgICAgICAgICAgICBpZiAoc3FsSW5kZXggIT0gX3NxbC5sZW5ndGgoKSkK\nICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbFN0YXRlRXhj\nZXB0aW9uKCk7CiAgICAgICAgICAgICAgICBpZiAoX3N1YnNlbHMgPT0gbnVs\nbCkKICAgICAgICAgICAgICAgICAgICBfc3Vic2VscyA9IG5ldyBBcnJheUxp\nc3QoYnVmLl9zdWJzZWxzLnNpemUoKSk7CiAgICAgICAgICAgICAgICBmb3Ig\nKGludCBpID0gMDsgaSA8IGJ1Zi5fc3Vic2Vscy5zaXplKCk7IGkrKykKICAg\nICAgICAgICAgICAgICAgICBfc3Vic2Vscy5hZGQoKChTdWJzZWxlY3QpIGJ1\nZi5fc3Vic2Vscy5nZXQoaSkpLgogICAgICAgICAgICAgICAgICAgICAgICBj\nbG9uZShzcWxJbmRleCwgcGFyYW1JbmRleCkpOwogICAgICAgICAgICB9CiAg\nICAgICAgfQoKICAgICAgICBpZiAoc3FsSW5kZXggPT0gX3NxbC5sZW5ndGgo\nKSkKICAgICAgICAgICAgX3NxbC5hcHBlbmQoYnVmLl9zcWwudG9TdHJpbmco\nKSk7CiAgICAgICAgZWxzZQogICAgICAgICAgICBfc3FsLmluc2VydChzcWxJ\nbmRleCwgYnVmLl9zcWwudG9TdHJpbmcoKSk7CgogICAgICAgIGlmIChidWYu\nX3BhcmFtcyAhPSBudWxsKSB7CiAgICAgICAgICAgIGlmIChfcGFyYW1zID09\nIG51bGwpCiAgICAgICAgICAgICAgICBfcGFyYW1zID0gbmV3IEFycmF5TGlz\ndCgpOwogICAgICAgICAgICBpZiAoX2NvbHMgPT0gbnVsbCAmJiBidWYuX2Nv\nbHMgIT0gbnVsbCkgewogICAgICAgICAgICAgICAgX2NvbHMgPSBuZXcgQXJy\nYXlMaXN0KCk7CiAgICAgICAgICAgICAgICB3aGlsZSAoX2NvbHMuc2l6ZSgp\nIDwgX3BhcmFtcy5zaXplKCkpCiAgICAgICAgICAgICAgICAgICAgX2NvbHMu\nYWRkKG51bGwpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAocGFy\nYW1JbmRleCA9PSBfcGFyYW1zLnNpemUoKSkgewogICAgICAgICAgICAgICAg\nX3BhcmFtcy5hZGRBbGwoYnVmLl9wYXJhbXMpOwogICAgICAgICAgICAgICAg\naWYgKGJ1Zi5fdXNlclBhcmFtcyAhPSBudWxsKSB7CiAgICAgICAgICAgICAg\nICAgICAgaWYgKF91c2VyUGFyYW1zID09IG51bGwpCiAgICAgICAgICAgICAg\nICAgICAgICAgIF91c2VyUGFyYW1zID0gbmV3IEFycmF5TGlzdCgpOwogICAg\nICAgICAgICAgICAgICAgX3VzZXJQYXJhbXMuYWRkQWxsKHBhcmFtSW5kZXgs\nIGJ1Zi5fdXNlclBhcmFtcyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAg\nICAgICAgICBpZiAoYnVmLl91c2VySW5kZXggIT0gbnVsbCkgewogICAgICAg\nICAgICAgICAgICAgIGlmIChfdXNlckluZGV4ID09IG51bGwpCiAgICAgICAg\nICAgICAgICAgICAgICAgIF91c2VySW5kZXggPSBuZXcgQXJyYXlMaXN0KCk7\nCiAgICAgICAgICAgICAgICAgICAgX3VzZXJJbmRleC5hZGRBbGwoYnVmLl91\nc2VySW5kZXgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAg\naWYgKGJ1Zi5fY29scyAhPSBudWxsKQogICAgICAgICAgICAgICAgICAgIF9j\nb2xzLmFkZEFsbChidWYuX2NvbHMpOwogICAgICAgICAgICAgICAgZWxzZSBp\nZiAoX2NvbHMgIT0gbnVsbCkKICAgICAgICAgICAgICAgICAgICB3aGlsZSAo\nX2NvbHMuc2l6ZSgpIDwgX3BhcmFtcy5zaXplKCkpCiAgICAgICAgICAgICAg\nICAgICAgICAgIF9jb2xzLmFkZChudWxsKTsKICAgICAgICAgICAgfSBlbHNl\nIHsKICAgICAgICAgICAgICAgIF9wYXJhbXMuYWRkQWxsKHBhcmFtSW5kZXgs\nIGJ1Zi5fcGFyYW1zKTsKICAgICAgICAgICAgICAgIGlmICggYnVmLl91c2Vy\nUGFyYW1zICE9IG51bGwpIHsKICAgICAgICAgICAgICAgICAgICBpZiAoX3Vz\nZXJQYXJhbXMgPT0gbnVsbCkKICAgICAgICAgICAgICAgICAgICAgICAgX3Vz\nZXJQYXJhbXMgPSBuZXcgQXJyYXlMaXN0KCk7CiAgICAgICAgICAgICAgICAg\nICAgX3VzZXJQYXJhbXMuYWRkQWxsKHBhcmFtSW5kZXgsIGJ1Zi5fdXNlclBh\ncmFtcyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAo\nYnVmLl91c2VySW5kZXggIT0gbnVsbCkgewogICAgICAgICAgICAgICAgICAg\nICBpZiAoX3VzZXJJbmRleCA9PSBudWxsKSB7CiAgICAgICAgICAgICAgICAg\nICAgICAgICBfdXNlckluZGV4ID0gbmV3IEFycmF5TGlzdCgpOwogICAgICAg\nICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgIF91c2VySW5k\nZXguYWRkQWxsKGJ1Zi5fdXNlckluZGV4KTsKICAgICAgICAgICAgICAgIH0K\nICAgICAgICAgICAgICAgIGlmIChidWYuX2NvbHMgIT0gbnVsbCkKICAgICAg\nICAgICAgICAgICAgICBfY29scy5hZGRBbGwocGFyYW1JbmRleCwgYnVmLl9j\nb2xzKTsKICAgICAgICAgICAgICAgIGVsc2UgaWYgKF9jb2xzICE9IG51bGwp\nCiAgICAgICAgICAgICAgICAgICAgd2hpbGUgKF9jb2xzLnNpemUoKSA8IF9w\nYXJhbXMuc2l6ZSgpKQogICAgICAgICAgICAgICAgICAgICAgICBfY29scy5h\nZGQocGFyYW1JbmRleCwgbnVsbCk7CiAgICAgICAgICAgIH0KICAgICAgICB9\nCgogICAgICAgIGlmIChfdXNlckluZGV4ICE9IG51bGwpIHsKICAgICAgICAg\nICAgLy8gZml4IHVwIHVzZXIgcGFyYW1ldGVyIGluZGV4CiAgICAgICAgICAg\nIGZvciAoaW50IGkgPSAwOyBpIDwgX3VzZXJJbmRleC5zaXplKCk7IGkrPTIp\nIHsKICAgICAgICAgICAgICAgIF91c2VySW5kZXguc2V0KGksIF91c2VyUGFy\nYW1zLmluZGV4T2YoX3VzZXJJbmRleC5nZXQoaSsxKSkpOwogICAgICAgICAg\nICB9CiAgICAgICAgfQogICAgfQogICAgCiAgICBwdWJsaWMgU1FMQnVmZmVy\nIGFwcGVuZChEQklkZW50aWZpZXIgbmFtZSkgewogICAgICAgIF9zcWwuYXBw\nZW5kKF9kaWN0LnRvREJOYW1lKG5hbWUpKTsKICAgICAgICByZXR1cm4gdGhp\nczsKICAgIH0KCiAgICBwdWJsaWMgU1FMQnVmZmVyIGFwcGVuZChUYWJsZSB0\nYWJsZSkgewogICAgICAgIF9zcWwuYXBwZW5kKF9kaWN0LmdldEZ1bGxOYW1l\nKHRhYmxlLCBmYWxzZSkpOwogICAgICAgIHJldHVybiB0aGlzOwogICAgfQoK\nICAgIHB1YmxpYyBTUUxCdWZmZXIgYXBwZW5kKFNlcXVlbmNlIHNlcSkgewog\nICAgICAgIF9zcWwuYXBwZW5kKF9kaWN0LmdldEZ1bGxOYW1lKHNlcSkpOwog\nICAgICAgIHJldHVybiB0aGlzOwogICAgfQoKICAgIHB1YmxpYyBTUUxCdWZm\nZXIgYXBwZW5kKENvbHVtbiBjb2wpIHsKICAgICAgICBfc3FsLmFwcGVuZChf\nZGljdC5nZXRDb2x1bW5EQk5hbWUoY29sKSk7CiAgICAgICAgcmV0dXJuIHRo\naXM7CiAgICB9CgogICAgcHVibGljIFNRTEJ1ZmZlciBhcHBlbmQoU3RyaW5n\nIHMpIHsKICAgICAgICBfc3FsLmFwcGVuZChzKTsKICAgICAgICByZXR1cm4g\ndGhpczsKICAgIH0KCiAgICAvKioKICAgICAqIEFwcGVuZCBhIHN1YnNlbGVj\ndC4gVGhpcyBkZWxheXMgcmVzb2x1dGlvbiBvZiB0aGUgc2VsZWN0IFNRTC4K\nICAgICAqLwogICAgcHVibGljIFNRTEJ1ZmZlciBhcHBlbmQoU2VsZWN0IHNl\nbCwgSkRCQ0ZldGNoQ29uZmlndXJhdGlvbiBmZXRjaCkgewogICAgICAgIHJl\ndHVybiBhcHBlbmQoc2VsLCBmZXRjaCwgZmFsc2UpOwogICAgfQoKICAgIC8q\nKgogICAgICogQXBwZW5kIGEgc3Vic2VsZWN0IGNvdW50LiBUaGlzIGRlbGF5\ncyByZXNvbHV0aW9uIG9mIHRoZSBzZWxlY3QgU1FMLgogICAgICovCiAgICBw\ndWJsaWMgU1FMQnVmZmVyIGFwcGVuZENvdW50KFNlbGVjdCBzZWwsIEpEQkNG\nZXRjaENvbmZpZ3VyYXRpb24gZmV0Y2gpIHsKICAgICAgICByZXR1cm4gYXBw\nZW5kKHNlbCwgZmV0Y2gsIHRydWUpOwogICAgfQoKICAgIC8qKgogICAgICog\nQXBwZW5kIGEgc3Vic2VsZWN0LiBUaGlzIGRlbGF5cyByZXNvbHV0aW9uIG9m\nIHRoZSBzZWxlY3QgU1FMLgogICAgICovCiAgICBwcml2YXRlIFNRTEJ1ZmZl\nciBhcHBlbmQoU2VsZWN0IHNlbCwgSkRCQ0ZldGNoQ29uZmlndXJhdGlvbiBm\nZXRjaCwKICAgICAgICBib29sZWFuIGNvdW50KSB7CiAgICAgICAgX3NxbC5h\ncHBlbmQoIigiKTsKICAgICAgICBTdWJzZWxlY3Qgc3ViID0gbmV3IFN1YnNl\nbGVjdCgpOwogICAgICAgIHN1Yi5zZWxlY3QgPSBzZWw7CiAgICAgICAgc3Vi\nLmZldGNoID0gZmV0Y2g7CiAgICAgICAgc3ViLmNvdW50ID0gY291bnQ7CiAg\nICAgICAgc3ViLnNxbEluZGV4ID0gX3NxbC5sZW5ndGgoKTsKICAgICAgICBz\ndWIucGFyYW1JbmRleCA9IChfcGFyYW1zID09IG51bGwpID8gMCA6IF9wYXJh\nbXMuc2l6ZSgpOwogICAgICAgIF9zcWwuYXBwZW5kKCIpIik7CgogICAgICAg\nIGlmIChfc3Vic2VscyA9PSBudWxsKQogICAgICAgICAgICBfc3Vic2VscyA9\nIG5ldyBBcnJheUxpc3QoMik7CiAgICAgICAgX3N1YnNlbHMuYWRkKHN1Yik7\nCiAgICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CgogICAgLyoqCiAgICAgKiBS\nZXBsYWNlIGEgc3Vic2VsZWN0LgogICAgICovCiAgICBwdWJsaWMgYm9vbGVh\nbiByZXBsYWNlKFNlbGVjdCBvbGQsIFNlbGVjdCBzZWwpIHsKICAgICAgICBp\nZiAoX3N1YnNlbHMgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIGZhbHNl\nOwogICAgICAgIFN1YnNlbGVjdCBzdWI7CiAgICAgICAgZm9yIChpbnQgaSA9\nIDA7IGkgPCBfc3Vic2Vscy5zaXplKCk7IGkrKykgewogICAgICAgICAgICBz\ndWIgPSAoU3Vic2VsZWN0KSBfc3Vic2Vscy5nZXQoaSk7CiAgICAgICAgICAg\nIGlmIChzdWIuc2VsZWN0ID09IG9sZCkgewogICAgICAgICAgICAgICAgc3Vi\nLnNlbGVjdCA9IHNlbDsKICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwog\nICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiBmYWxzZTsK\nICAgIH0KCiAgICAvKioKICAgICAqIEFwcGVuZCBhIHBhcmFtZXRlciB2YWx1\nZS4KICAgICAqLwogICAgcHVibGljIFNRTEJ1ZmZlciBhcHBlbmRWYWx1ZShP\nYmplY3QgbykgewogICAgICAgIHJldHVybiBhcHBlbmRWYWx1ZShvLCBudWxs\nKTsKICAgIH0KICAgIAogICAgLyoqCiAgICAgKiBBcHBlbmQgYSBzeXN0ZW0g\naW5zZXJ0ZWQgcGFyYW1ldGVyIHZhbHVlIGZvciBhIHNwZWNpZmljIGNvbHVt\nbi4KICAgICAqLwogICAgcHVibGljIFNRTEJ1ZmZlciBhcHBlbmRWYWx1ZShP\nYmplY3QgbywgQ29sdW1uIGNvbCkgewogICAgICAgIHJldHVybiBhcHBlbmRW\nYWx1ZShvLCBjb2wsIG51bGwpOwogICAgfQogICAgCiAgICAvKioKICAgICAq\nIEFwcGVuZCBhIHVzZXIgcGFyYW1ldGVyIHZhbHVlIGZvciBhIHNwZWNpZmlj\nIGNvbHVtbi4gVXNlciBwYXJhbWV0ZXJzCiAgICAgKiBhcmUgbWFya2VkIGFz\nIG9wcG9zZWQgdG8gdGhlIHBhcmFtZXRlcnMgaW5zZXJ0ZWQgYnkgdGhlIGlu\ndGVybmFsIHJ1bnRpbWUKICAgICAqIHN5c3RlbS4gVGhpcyBoZWxwcyB0byBy\nZXVzZSB0aGUgYnVmZmVyIGJ5IHJlcGFybWV0ZXJpemluZyBpdCB3aXRoIG5l\ndwogICAgICogc2V0IG9mIHVzZXIgcGFyYW1ldGVycyB3aGlsZSB0aGUgJ2lu\ndGVybmFsJyBwYXJhbWV0ZXJzIHJlbWFpbiB1bmNoYW5nZWQuCiAgICAgKiAK\nICAgICAqIEBwYXJhbSB1c2VyUGFyYW0gaWYgbm9uLW51bGwsIGRlc2lnbmF0\nZXMgYSAndXNlcicgcGFyYW1ldGVyLgogICAgICovCiAgICBwdWJsaWMgU1FM\nQnVmZmVyIGFwcGVuZFZhbHVlKE9iamVjdCBvLCBDb2x1bW4gY29sLCBQYXJh\nbWV0ZXIgdXNlclBhcmFtKSB7CiAgICAgICAgaWYgKG8gPT0gbnVsbCkKICAg\nICAgICAgICAgX3NxbC5hcHBlbmQoIk5VTEwiKTsKICAgICAgICBlbHNlIGlm\nIChvIGluc3RhbmNlb2YgUmF3KQogICAgICAgICAgICBfc3FsLmFwcGVuZChv\nLnRvU3RyaW5nKCkpOwogICAgICAgIGVsc2UgewogICAgICAgICAgICBfc3Fs\nLmFwcGVuZChQQVJBTUVURVJfVE9LRU4pOwoKICAgICAgICAgICAgLy8gaW5p\ndGlhbGl6ZSBwYXJhbSBhbmQgY29sIGxpc3RzOyB3ZSBob2xkIG9mZiBvbiBj\nb2wgbGlzdCB1bnRpbAogICAgICAgICAgICAvLyB3ZSBnZXQgdGhlIGZpcnN0\nIG5vbi1udWxsIGNvbAogICAgICAgICAgICBpZiAoX3BhcmFtcyA9PSBudWxs\nKQogICAgICAgICAgICAgICAgX3BhcmFtcyA9IG5ldyBBcnJheUxpc3QoKTsK\nICAgICAgICAgICAgaWYgKF91c2VyUGFyYW1zID09IG51bGwpCiAgICAgICAg\nICAgICAgICBfdXNlclBhcmFtcyA9IG5ldyBBcnJheUxpc3QoKTsKICAgICAg\nICAgICAgaWYgKGNvbCAhPSBudWxsICYmIF9jb2xzID09IG51bGwpIHsKICAg\nICAgICAgICAgICAgIF9jb2xzID0gbmV3IEFycmF5TGlzdCgpOwogICAgICAg\nICAgICAgICAgd2hpbGUgKF9jb2xzLnNpemUoKSA8IF9wYXJhbXMuc2l6ZSgp\nKQogICAgICAgICAgICAgICAgICAgIF9jb2xzLmFkZChudWxsKTsKICAgICAg\nICAgICAgfQoKICAgICAgICAgICAgX3BhcmFtcy5hZGQobyk7CiAgICAgICAg\nICAgIGlmICh1c2VyUGFyYW0gIT0gbnVsbCkgewogICAgICAgICAgICAgICAg\nT2JqZWN0IHBhcmFtID0gdXNlclBhcmFtOwogICAgICAgICAgICAgICAgaWYg\nKHVzZXJQYXJhbSBpbnN0YW5jZW9mIENvbGxlY3Rpb25QYXJhbSkKICAgICAg\nICAgICAgICAgICAgICBwYXJhbSA9ICgoQ29sbGVjdGlvblBhcmFtKSB1c2Vy\nUGFyYW0pLmNsb25lKCk7CiAgICAgICAgICAgICAgICBfdXNlclBhcmFtcy5h\nZGQocGFyYW0pOwogICAgICAgICAgICAgICAgaWYgKF91c2VySW5kZXggPT0g\nbnVsbCkKICAgICAgICAgICAgICAgICAgICBfdXNlckluZGV4ID0gbmV3IEFy\ncmF5TGlzdCgpOwogICAgICAgICAgICAgICAgaW50IGluZGV4ID0gX3BhcmFt\ncy5zaXplKCktMTsKICAgICAgICAgICAgICAgIF91c2VySW5kZXguYWRkKGlu\nZGV4KTsKICAgICAgICAgICAgICAgIF91c2VySW5kZXguYWRkKHBhcmFtKTsK\nICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAg\nICBfdXNlclBhcmFtcy5hZGQobyk7CiAgICAgICAgICAgIGlmIChfY29scyAh\nPSBudWxsKQogICAgICAgICAgICAgICAgX2NvbHMuYWRkKGNvbCk7CiAgICAg\nICAgfQogICAgICAgIHJldHVybiB0aGlzOwogICAgfQoKICAgIC8qKgogICAg\nICogQXBwZW5kIGEgcGFyYW1ldGVyIHZhbHVlLgogICAgICovCiAgICBwdWJs\naWMgU1FMQnVmZmVyIGFwcGVuZFZhbHVlKGJvb2xlYW4gYikgewogICAgICAg\nIHJldHVybiBhcHBlbmRWYWx1ZShiLCBudWxsKTsKICAgIH0KCiAgICAvKioK\nICAgICAqIEFwcGVuZCBhIHBhcmFtZXRlciB2YWx1ZS4KICAgICAqLwogICAg\ncHVibGljIFNRTEJ1ZmZlciBhcHBlbmRWYWx1ZShib29sZWFuIGIsIENvbHVt\nbiBjb2wpIHsKICAgICAgICByZXR1cm4gYXBwZW5kVmFsdWUoKGIpID8gQm9v\nbGVhbi5UUlVFIDogQm9vbGVhbi5GQUxTRSwgY29sKTsKICAgIH0KCiAgICAv\nKioKICAgICAqIEFwcGVuZCBhIHBhcmFtZXRlciB2YWx1ZS4KICAgICAqLwog\nICAgcHVibGljIFNRTEJ1ZmZlciBhcHBlbmRWYWx1ZShieXRlIGIpIHsKICAg\nICAgICByZXR1cm4gYXBwZW5kVmFsdWUoYiwgbnVsbCk7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBBcHBlbmQgYSBwYXJhbWV0ZXIgdmFsdWUuCiAgICAgKi8K\nICAgIHB1YmxpYyBTUUxCdWZmZXIgYXBwZW5kVmFsdWUoYnl0ZSBiLCBDb2x1\nbW4gY29sKSB7CiAgICAgICAgcmV0dXJuIGFwcGVuZFZhbHVlKG5ldyBCeXRl\nKGIpLCBjb2wpOwogICAgfQoKICAgIC8qKgogICAgICogQXBwZW5kIGEgcGFy\nYW1ldGVyIHZhbHVlLgogICAgICovCiAgICBwdWJsaWMgU1FMQnVmZmVyIGFw\ncGVuZFZhbHVlKGNoYXIgYykgewogICAgICAgIHJldHVybiBhcHBlbmRWYWx1\nZShjLCBudWxsKTsKICAgIH0KCiAgICAvKioKICAgICAqIEFwcGVuZCBhIHBh\ncmFtZXRlciB2YWx1ZS4KICAgICAqLwogICAgcHVibGljIFNRTEJ1ZmZlciBh\ncHBlbmRWYWx1ZShjaGFyIGMsIENvbHVtbiBjb2wpIHsKICAgICAgICByZXR1\ncm4gYXBwZW5kVmFsdWUobmV3IENoYXJhY3RlcihjKSwgY29sKTsKICAgIH0K\nCiAgICAvKioKICAgICAqIEFwcGVuZCBhIHBhcmFtZXRlciB2YWx1ZS4KICAg\nICAqLwogICAgcHVibGljIFNRTEJ1ZmZlciBhcHBlbmRWYWx1ZShkb3VibGUg\nZCkgewogICAgICAgIHJldHVybiBhcHBlbmRWYWx1ZShkLCBudWxsKTsKICAg\nIH0KCiAgICAvKioKICAgICAqIEFwcGVuZCBhIHBhcmFtZXRlciB2YWx1ZS4K\nICAgICAqLwogICAgcHVibGljIFNRTEJ1ZmZlciBhcHBlbmRWYWx1ZShkb3Vi\nbGUgZCwgQ29sdW1uIGNvbCkgewogICAgICAgIHJldHVybiBhcHBlbmRWYWx1\nZShuZXcgRG91YmxlKGQpLCBjb2wpOwogICAgfQoKICAgIC8qKgogICAgICog\nQXBwZW5kIGEgcGFyYW1ldGVyIHZhbHVlLgogICAgICovCiAgICBwdWJsaWMg\nU1FMQnVmZmVyIGFwcGVuZFZhbHVlKGZsb2F0IGYpIHsKICAgICAgICByZXR1\ncm4gYXBwZW5kVmFsdWUoZiwgbnVsbCk7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBBcHBlbmQgYSBwYXJhbWV0ZXIgdmFsdWUuCiAgICAgKi8KICAgIHB1Ymxp\nYyBTUUxCdWZmZXIgYXBwZW5kVmFsdWUoZmxvYXQgZiwgQ29sdW1uIGNvbCkg\newogICAgICAgIHJldHVybiBhcHBlbmRWYWx1ZShuZXcgRmxvYXQoZiksIGNv\nbCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBBcHBlbmQgYSBwYXJhbWV0ZXIg\ndmFsdWUuCiAgICAgKi8KICAgIHB1YmxpYyBTUUxCdWZmZXIgYXBwZW5kVmFs\ndWUoaW50IGkpIHsKICAgICAgICByZXR1cm4gYXBwZW5kVmFsdWUoSW50ZWdl\nci52YWx1ZU9mKGkpLCBudWxsKTsKICAgIH0KCiAgICAvKioKICAgICAqIEFw\ncGVuZCBhIHBhcmFtZXRlciB2YWx1ZS4KICAgICAqLwogICAgcHVibGljIFNR\nTEJ1ZmZlciBhcHBlbmRWYWx1ZShpbnQgaSwgQ29sdW1uIGNvbCkgewogICAg\nICAgIHJldHVybiBhcHBlbmRWYWx1ZShJbnRlZ2VyLnZhbHVlT2YoaSksIGNv\nbCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBBcHBlbmQgYSBwYXJhbWV0ZXIg\ndmFsdWUuCiAgICAgKi8KICAgIHB1YmxpYyBTUUxCdWZmZXIgYXBwZW5kVmFs\ndWUobG9uZyBsKSB7CiAgICAgICAgcmV0dXJuIGFwcGVuZFZhbHVlKExvbmcu\ndmFsdWVPZihsKSwgbnVsbCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBBcHBl\nbmQgYSBwYXJhbWV0ZXIgdmFsdWUuCiAgICAgKi8KICAgIHB1YmxpYyBTUUxC\ndWZmZXIgYXBwZW5kVmFsdWUobG9uZyBsLCBDb2x1bW4gY29sKSB7CiAgICAg\nICAgcmV0dXJuIGFwcGVuZFZhbHVlKExvbmcudmFsdWVPZihsKSwgY29sKTsK\nICAgIH0KCiAgICAvKioKICAgICAqIEFwcGVuZCBhIHBhcmFtZXRlciB2YWx1\nZS4KICAgICAqLwogICAgcHVibGljIFNRTEJ1ZmZlciBhcHBlbmRWYWx1ZShz\naG9ydCBzKSB7CiAgICAgICAgcmV0dXJuIGFwcGVuZFZhbHVlKHMsIG51bGwp\nOwogICAgfQoKICAgIC8qKgogICAgICogQXBwZW5kIGEgcGFyYW1ldGVyIHZh\nbHVlLgogICAgICovCiAgICBwdWJsaWMgU1FMQnVmZmVyIGFwcGVuZFZhbHVl\nKHNob3J0IHMsIENvbHVtbiBjb2wpIHsKICAgICAgICByZXR1cm4gYXBwZW5k\nVmFsdWUobmV3IFNob3J0KHMpLCBjb2wpOwogICAgfQoKICAgIC8qKgogICAg\nICogUmV0dXJuIHRoZSBsaXN0IG9mIHBhcmFtZXRlciB2YWx1ZXMuCiAgICAg\nKi8KICAgIHB1YmxpYyBMaXN0IGdldFBhcmFtZXRlcnMoKSB7CiAgICAgICAg\ncmV0dXJuIChfcGFyYW1zID09IG51bGwpID8gQ29sbGVjdGlvbnMuRU1QVFlf\nTElTVCA6IF9wYXJhbXM7CiAgICB9CiAgICAKICAgIC8qKgogICAgICogR2V0\nIHRoZSB1c2VyIHBhcmFtZXRlciBwb3NpdGlvbnMgaW4gdGhlIGxpc3Qgb2Yg\ncGFyYW1ldGVycy4gVGhlIG9kZCAKICAgICAqIGVsZW1lbnQgb2YgdGhlIHJl\ndHVybmVkIGxpc3QgY29udGFpbnMgYW4gaW50ZWdlciBpbmRleCB0aGF0IHJl\nZmVycwogICAgICogdG8gdGhlIHBvc2l0aW9uIGluIHRoZSB7QGxpbmsgI2dl\ndFBhcmFtZXRlcnMoKX0gbGlzdC4gVGhlIGV2ZW4gZWxlbWVudAogICAgICog\nb2YgdGhlIHJldHVybmVkIGxpc3QgcmVmZXJzIHRvIHRoZSB1c2VyIHBhcmFt\nZXRlciBrZXkuIAogICAgICogVGhpcyBzdHJ1Y3R1cmUgaXMgcHJlZmVycmVk\nIG92ZXIgYSBub3JtYWwgbWFwIGJlY2F1c2UgYSB1c2VyIHBhcmFtZXRlciAK\nICAgICAqIG1heSBvY2N1ciBtb3JlIHRoYW4gb25lIGluIHRoZSBwYXJhbWV0\nZXJzLiAKICAgICAqLwogICAgcHVibGljIExpc3QgZ2V0VXNlclBhcmFtZXRl\ncnMoKSB7CiAgICAgICAgaWYgKF91c2VySW5kZXggPT0gbnVsbCkKICAgICAg\nICAgICAgcmV0dXJuIENvbGxlY3Rpb25zLkVNUFRZX0xJU1Q7CiAgICAgICAg\ncmV0dXJuIF91c2VySW5kZXg7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1\ncm4gdGhlIFNRTCBmb3IgdGhpcyBidWZmZXIuCiAgICAgKi8KICAgIHB1Ymxp\nYyBTdHJpbmcgZ2V0U1FMKCkgewogICAgICAgIHJldHVybiBnZXRTUUwoZmFs\nc2UpOwogICAgfQogICAgCiAgICAvKioKICAgICAqIFJldHVybnMgdGhlIFNR\nTCBmb3IgdGhpcyBidWZmZXIuCiAgICAgKgogICAgICogQHBhcmFtIHJlcGxh\nY2VQYXJhbXMgaWYgdHJ1ZSwgdGhlbiByZXBsYWNlIHBhcmFtZXRlcnMgd2l0\naCB0aGUKICAgICAqIGFjdHVhbCBwYXJhbWV0ZXIgdmFsdWVzCiAgICAgKi8K\nICAgIHB1YmxpYyBTdHJpbmcgZ2V0U1FMKGJvb2xlYW4gcmVwbGFjZVBhcmFt\ncykgewogICAgICAgIHJlc29sdmVTdWJzZWxlY3RzKCk7CiAgICAgICAgU3Ry\naW5nIHNxbCA9IF9zcWwudG9TdHJpbmcoKTsKICAgICAgICBpZiAoIXJlcGxh\nY2VQYXJhbXMgfHwgX3BhcmFtcyA9PSBudWxsIHx8IF9wYXJhbXMuaXNFbXB0\neSgpKQogICAgICAgICAgICByZXR1cm4gc3FsOwoKICAgICAgICBTdHJpbmdC\ndWlsZGVyIGJ1ZiA9IG5ldyBTdHJpbmdCdWlsZGVyKCk7CiAgICAgICAgSXRl\ncmF0b3IgcGkgPSBfcGFyYW1zLml0ZXJhdG9yKCk7CiAgICAgICAgZm9yIChp\nbnQgaSA9IDA7IGkgPCBzcWwubGVuZ3RoKCk7IGkrKykgewogICAgICAgICAg\nICBpZiAoc3FsLmNoYXJBdChpKSAhPSAnPycpIHsKICAgICAgICAgICAgICAg\nIGJ1Zi5hcHBlbmQoc3FsLmNoYXJBdChpKSk7CiAgICAgICAgICAgICAgICBj\nb250aW51ZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgT2JqZWN0IHBh\ncmFtID0gcGkuaGFzTmV4dCgpID8gcGkubmV4dCgpIDogbnVsbDsKICAgICAg\nICAgICAgaWYgKHBhcmFtID09IG51bGwpCiAgICAgICAgICAgICAgICBidWYu\nYXBwZW5kKCJOVUxMIik7CiAgICAgICAgICAgIGVsc2UgaWYgKHBhcmFtIGlu\nc3RhbmNlb2YgTnVtYmVyIHx8IHBhcmFtIGluc3RhbmNlb2YgQm9vbGVhbikK\nICAgICAgICAgICAgICAgIGJ1Zi5hcHBlbmQocGFyYW0pOwogICAgICAgICAg\nICBlbHNlIGlmIChwYXJhbSBpbnN0YW5jZW9mIFN0cmluZyB8fCBwYXJhbSBp\nbnN0YW5jZW9mIENoYXJhY3RlcikKICAgICAgICAgICAgICAgIGJ1Zi5hcHBl\nbmQoIiciKS5hcHBlbmQocGFyYW0pLmFwcGVuZCgiJyIpOwogICAgICAgICAg\nICBlbHNlCiAgICAgICAgICAgICAgICBidWYuYXBwZW5kKCI/Iik7CiAgICAg\nICAgfQogICAgICAgIHJldHVybiBidWYudG9TdHJpbmcoKTsKICAgIH0KCiAg\nICAvKioKICAgICAqIFJlc29sdmUgb3VyIGRlbGF5ZWQgc3Vic2VsZWN0cy4K\nICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIHJlc29sdmVTdWJzZWxlY3RzKCkg\newogICAgICAgIGlmIChfc3Vic2VscyA9PSBudWxsIHx8IF9zdWJzZWxzLmlz\nRW1wdHkoKSkKICAgICAgICAgICAgcmV0dXJuOwoKICAgICAgICAvLyBhZGQg\nc3Vic2VscyBiYWNrd2FyZHMgc28gdGhhdCB0aGUgc3RvcmVkIGluc2VydGlv\nbiBwb2ludHMgb2YKICAgICAgICAvLyBsYXRlciBzdWJzZWxzIHJlbWFpbiB2\nYWxpZAogICAgICAgIFN1YnNlbGVjdCBzdWI7CiAgICAgICAgU1FMQnVmZmVy\nIGJ1ZjsKICAgICAgICBmb3IgKGludCBpID0gX3N1YnNlbHMuc2l6ZSgpIC0g\nMTsgaSA+PSAwOyBpLS0pIHsKICAgICAgICAgICAgc3ViID0gKFN1YnNlbGVj\ndCkgX3N1YnNlbHMuZ2V0KGkpOwogICAgICAgICAgICBpZiAoc3ViLmNvdW50\nKQogICAgICAgICAgICAgICAgYnVmID0gc3ViLnNlbGVjdC50b1NlbGVjdENv\ndW50KCk7CiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIGJ1ZiA9\nIHN1Yi5zZWxlY3QudG9TZWxlY3QoZmFsc2UsIHN1Yi5mZXRjaCk7CiAgICAg\nICAgICAgIGJ1Zi5yZXNvbHZlU3Vic2VsZWN0cygpOwogICAgICAgICAgICBh\ncHBlbmQoYnVmLCBzdWIuc3FsSW5kZXgsIHN1Yi5wYXJhbUluZGV4LCBmYWxz\nZSk7CiAgICAgICAgfQogICAgICAgIF9zdWJzZWxzLmNsZWFyKCk7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBDcmVhdGUgYW5kIHBvcHVsYXRlIHRoZSBwYXJh\nbWV0ZXJzIG9mIGEgcHJlcGFyZWQgc3RhdGVtZW50IHVzaW5nCiAgICAgKiB0\naGUgU1FMIGluIHRoaXMgYnVmZmVyLgogICAgICovCiAgICBwdWJsaWMgUHJl\ncGFyZWRTdGF0ZW1lbnQgcHJlcGFyZVN0YXRlbWVudChDb25uZWN0aW9uIGNv\nbm4pCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgcmV0\ndXJuIHByZXBhcmVTdGF0ZW1lbnQoY29ubiwgUmVzdWx0U2V0LlRZUEVfRk9S\nV0FSRF9PTkxZLAogICAgICAgICAgICBSZXN1bHRTZXQuQ09OQ1VSX1JFQURf\nT05MWSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBDcmVhdGUgYW5kIHBvcHVs\nYXRlIHRoZSBwYXJhbWV0ZXJzIG9mIGEgcHJlcGFyZWQgc3RhdGVtZW50IHVz\naW5nCiAgICAgKiB0aGUgU1FMIGluIHRoaXMgYnVmZmVyLgogICAgICovCiAg\nICBwdWJsaWMgUHJlcGFyZWRTdGF0ZW1lbnQgcHJlcGFyZVN0YXRlbWVudChD\nb25uZWN0aW9uIGNvbm4sIGludCByc1R5cGUsCiAgICAgICAgaW50IHJzQ29u\nY3VyKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIHJl\ndHVybiBwcmVwYXJlU3RhdGVtZW50KGNvbm4sIG51bGwsIHJzVHlwZSwgcnND\nb25jdXIpOwogICAgfQoKICAgIC8qKgogICAgICogQ3JlYXRlIGFuZCBwb3B1\nbGF0ZSB0aGUgcGFyYW1ldGVycyBvZiBhIHByZXByZWQgc3RhdGVtZW50IHVz\naW5nIHRoZQogICAgICogU1FMIGluIHRoaXMgYnVmZmVyIGFuZCB0aGUgZ2l2\nZW4gZmV0Y2ggY29uZmlndXJhdGlvbi4KICAgICAqLwogICAgcHVibGljIFBy\nZXBhcmVkU3RhdGVtZW50IHByZXBhcmVTdGF0ZW1lbnQoQ29ubmVjdGlvbiBj\nb25uLAogICAgICAgIEpEQkNGZXRjaENvbmZpZ3VyYXRpb24gZmV0Y2gsIGlu\ndCByc1R5cGUsIGludCByc0NvbmN1cikKICAgICAgICB0aHJvd3MgU1FMRXhj\nZXB0aW9uIHsKICAgICAgICBpZiAocnNUeXBlID09IC0xICYmIGZldGNoID09\nIG51bGwpCiAgICAgICAgICAgIHJzVHlwZSA9IFJlc3VsdFNldC5UWVBFX0ZP\nUldBUkRfT05MWTsKICAgICAgICBlbHNlIGlmIChyc1R5cGUgPT0gLTEpCiAg\nICAgICAgICAgIHJzVHlwZSA9IGZldGNoLmdldFJlc3VsdFNldFR5cGUoKTsK\nICAgICAgICBpZiAocnNDb25jdXIgPT0gLTEpCiAgICAgICAgICAgIHJzQ29u\nY3VyID0gUmVzdWx0U2V0LkNPTkNVUl9SRUFEX09OTFk7CgogICAgICAgIFBy\nZXBhcmVkU3RhdGVtZW50IHN0bW50OwogICAgICAgIGlmIChyc1R5cGUgPT0g\nUmVzdWx0U2V0LlRZUEVfRk9SV0FSRF9PTkxZCiAgICAgICAgICAgICYmIHJz\nQ29uY3VyID09IFJlc3VsdFNldC5DT05DVVJfUkVBRF9PTkxZKQogICAgICAg\nICAgICBzdG1udCA9IGNvbm4ucHJlcGFyZVN0YXRlbWVudChnZXRTUUwoKSk7\nCiAgICAgICAgZWxzZQogICAgICAgICAgICBzdG1udCA9IGNvbm4ucHJlcGFy\nZVN0YXRlbWVudChnZXRTUUwoKSwgcnNUeXBlLCByc0NvbmN1cik7CiAgICAg\nICAgdHJ5IHsKICAgICAgICAgICAgc2V0UGFyYW1ldGVycyhzdG1udCk7CiAg\nICAgICAgICAgIGlmIChmZXRjaCAhPSBudWxsKSB7CiAgICAgICAgICAgICAg\nICBpZiAoZmV0Y2guZ2V0RmV0Y2hCYXRjaFNpemUoKSA+IDApCiAgICAgICAg\nICAgICAgICAgICAgc3RtbnQuc2V0RmV0Y2hTaXplKAogICAgICAgICAgICAg\nICAgICAgICAgICBfZGljdC5nZXRCYXRjaEZldGNoU2l6ZShmZXRjaC5nZXRG\nZXRjaEJhdGNoU2l6ZSgpKSk7CiAgICAgICAgICAgICAgICBpZiAocnNUeXBl\nICE9IFJlc3VsdFNldC5UWVBFX0ZPUldBUkRfT05MWQogICAgICAgICAgICAg\nICAgICAgICYmIGZldGNoLmdldEZldGNoRGlyZWN0aW9uKCkgIT0gUmVzdWx0\nU2V0LkZFVENIX0ZPUldBUkQpCiAgICAgICAgICAgICAgICAgICAgc3RtbnQu\nc2V0RmV0Y2hEaXJlY3Rpb24oZmV0Y2guZ2V0RmV0Y2hEaXJlY3Rpb24oKSk7\nCiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIHN0bW50OwogICAg\nICAgIH0gY2F0Y2ggKFNRTEV4Y2VwdGlvbiBzZSkgewogICAgICAgICAgICB0\ncnkgewogICAgICAgICAgICAgICAgc3RtbnQuY2xvc2UoKTsKICAgICAgICAg\nICAgfSBjYXRjaCAoU1FMRXhjZXB0aW9uIHNlMikgewogICAgICAgICAgICB9\nCiAgICAgICAgICAgIHRocm93IHNlOwogICAgICAgIH0KICAgIH0KCiAgICAv\nKioKICAgICAqIENyZWF0ZSBhbmQgcG9wdWxhdGUgdGhlIHBhcmFtZXRlcnMg\nb2YgYSBwcmVwYXJlZCBzdGF0ZW1lbnQgdXNpbmcKICAgICAqIHRoZSBTUUwg\naW4gdGhpcyBidWZmZXIuCiAgICAgKi8KICAgIHB1YmxpYyBDYWxsYWJsZVN0\nYXRlbWVudCBwcmVwYXJlQ2FsbChDb25uZWN0aW9uIGNvbm4pCiAgICAgICAg\ndGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgcmV0dXJuIHByZXBhcmVD\nYWxsKGNvbm4sIFJlc3VsdFNldC5UWVBFX0ZPUldBUkRfT05MWSwKICAgICAg\nICAgICAgUmVzdWx0U2V0LkNPTkNVUl9SRUFEX09OTFkpOwogICAgfQoKICAg\nIC8qKgogICAgICogQ3JlYXRlIGFuZCBwb3B1bGF0ZSB0aGUgcGFyYW1ldGVy\ncyBvZiBhIHByZXBhcmVkIHN0YXRlbWVudCB1c2luZwogICAgICogdGhlIFNR\nTCBpbiB0aGlzIGJ1ZmZlci4KICAgICAqLwogICAgcHVibGljIENhbGxhYmxl\nU3RhdGVtZW50IHByZXBhcmVDYWxsKENvbm5lY3Rpb24gY29ubiwgaW50IHJz\nVHlwZSwKICAgICAgICBpbnQgcnNDb25jdXIpCiAgICAgICAgdGhyb3dzIFNR\nTEV4Y2VwdGlvbiB7CiAgICAgICAgcmV0dXJuIHByZXBhcmVDYWxsKGNvbm4s\nIG51bGwsIHJzVHlwZSwgcnNDb25jdXIpOwogICAgfQoKICAgIC8qKgogICAg\nICogQ3JlYXRlIGFuZCBwb3B1bGF0ZSB0aGUgcGFyYW1ldGVycyBvZiBhIHBy\nZXByZWQgc3RhdGVtZW50IHVzaW5nIHRoZQogICAgICogU1FMIGluIHRoaXMg\nYnVmZmVyIGFuZCB0aGUgZ2l2ZW4gZmV0Y2ggY29uZmlndXJhdGlvbi4KICAg\nICAqLwogICAgcHVibGljIENhbGxhYmxlU3RhdGVtZW50IHByZXBhcmVDYWxs\nKENvbm5lY3Rpb24gY29ubiwKICAgICAgICBKREJDRmV0Y2hDb25maWd1cmF0\naW9uIGZldGNoLCBpbnQgcnNUeXBlLCBpbnQgcnNDb25jdXIpCiAgICAgICAg\ndGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgaWYgKHJzVHlwZSA9PSAt\nMSAmJiBmZXRjaCA9PSBudWxsKQogICAgICAgICAgICByc1R5cGUgPSBSZXN1\nbHRTZXQuVFlQRV9GT1JXQVJEX09OTFk7CiAgICAgICAgZWxzZSBpZiAocnNU\neXBlID09IC0xKQogICAgICAgICAgICByc1R5cGUgPSBmZXRjaC5nZXRSZXN1\nbHRTZXRUeXBlKCk7CiAgICAgICAgaWYgKHJzQ29uY3VyID09IC0xKQogICAg\nICAgICAgICByc0NvbmN1ciA9IFJlc3VsdFNldC5DT05DVVJfUkVBRF9PTkxZ\nOwoKICAgICAgICBDYWxsYWJsZVN0YXRlbWVudCBzdG1udDsKICAgICAgICBp\nZiAocnNUeXBlID09IFJlc3VsdFNldC5UWVBFX0ZPUldBUkRfT05MWQogICAg\nICAgICAgICAmJiByc0NvbmN1ciA9PSBSZXN1bHRTZXQuQ09OQ1VSX1JFQURf\nT05MWSkKICAgICAgICAgICAgc3RtbnQgPSBjb25uLnByZXBhcmVDYWxsKGdl\ndFNRTCgpKTsKICAgICAgICBlbHNlCiAgICAgICAgICAgIHN0bW50ID0gY29u\nbi5wcmVwYXJlQ2FsbChnZXRTUUwoKSwgcnNUeXBlLCByc0NvbmN1cik7CiAg\nICAgICAgdHJ5IHsKICAgICAgICAgICAgc2V0UGFyYW1ldGVycyhzdG1udCk7\nCiAgICAgICAgICAgIGlmIChmZXRjaCAhPSBudWxsKSB7CiAgICAgICAgICAg\nICAgICBpZiAoZmV0Y2guZ2V0RmV0Y2hCYXRjaFNpemUoKSA+IDApCiAgICAg\nICAgICAgICAgICAgICAgc3RtbnQuc2V0RmV0Y2hTaXplKAogICAgICAgICAg\nICAgICAgICAgICAgICBfZGljdC5nZXRCYXRjaEZldGNoU2l6ZShmZXRjaC5n\nZXRGZXRjaEJhdGNoU2l6ZSgpKSk7CiAgICAgICAgICAgICAgICBpZiAocnNU\neXBlICE9IFJlc3VsdFNldC5UWVBFX0ZPUldBUkRfT05MWQogICAgICAgICAg\nICAgICAgICAgICYmIGZldGNoLmdldEZldGNoRGlyZWN0aW9uKCkgIT0gUmVz\ndWx0U2V0LkZFVENIX0ZPUldBUkQpCiAgICAgICAgICAgICAgICAgICAgc3Rt\nbnQuc2V0RmV0Y2hEaXJlY3Rpb24oZmV0Y2guZ2V0RmV0Y2hEaXJlY3Rpb24o\nKSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIHN0bW50Owog\nICAgICAgIH0gY2F0Y2ggKFNRTEV4Y2VwdGlvbiBzZSkgewogICAgICAgICAg\nICB0cnkgewogICAgICAgICAgICAgICAgc3RtbnQuY2xvc2UoKTsKICAgICAg\nICAgICAgfSBjYXRjaCAoU1FMRXhjZXB0aW9uIHNlMikgewogICAgICAgICAg\nICB9CiAgICAgICAgICAgIHRocm93IHNlOwogICAgICAgIH0KICAgIH0KCiAg\nICAvKioKICAgICAqIFBvcHVsYXRlIHRoZSBwYXJhbWV0ZXJzIG9mIGFuIGV4\naXN0aW5nIFByZXBhcmVkU3RhdGVtZW50CiAgICAgKiB3aXRoIHZhbHVlcyBm\ncm9tIHRoaXMgYnVmZmVyLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRQ\nYXJhbWV0ZXJzKFByZXBhcmVkU3RhdGVtZW50IHBzKQogICAgICAgIHRocm93\ncyBTUUxFeGNlcHRpb24gewogICAgICAgIGlmIChfcGFyYW1zID09IG51bGwp\nCiAgICAgICAgICAgIHJldHVybjsKCiAgICAgICAgQ29sdW1uIGNvbDsKICAg\nICAgICBmb3IgKGludCBpID0gMDsgaSA8IF9wYXJhbXMuc2l6ZSgpOyBpKysp\nIHsKICAgICAgICAgICAgY29sID0gKF9jb2xzID09IG51bGwpID8gbnVsbCA6\nIChDb2x1bW4pIF9jb2xzLmdldChpKTsKICAgICAgICAgICAgX2RpY3Quc2V0\nVW5rbm93bihwcywgaSArIDEsIF9wYXJhbXMuZ2V0KGkpLCBjb2wpOwogICAg\nICAgIH0KICAgIH0KCiAgICBwdWJsaWMgaW50IGhhc2hDb2RlKCkgewogICAg\nICAgIGludCBoYXNoID0gX3NxbC5oYXNoQ29kZSgpOwogICAgICAgIHJldHVy\nbiAoX3BhcmFtcyA9PSBudWxsKSA/IGhhc2ggOiBoYXNoIF4gX3BhcmFtcy5o\nYXNoQ29kZSgpOwogICAgfQoKICAgIC8qKgogICAgICogQ29tcGFyZSBpbnRl\ncm5hbCBTUUwgd2l0aG91dCByZXNvbHZpbmcgc3Vic2VsZWN0cyBvciBzdHJp\nbmdpZnlpbmcKICAgICAqIHBhcmFtZXRlcnMuCiAgICAgKi8KICAgIHB1Ymxp\nYyBib29sZWFuIHNxbEVxdWFscyhTdHJpbmcgc3FsKSB7CiAgICAgICAgcmV0\ndXJuIF9zcWwudG9TdHJpbmcoKS5lcXVhbHMoc3FsKTsKICAgIH0KCiAgICBw\ndWJsaWMgYm9vbGVhbiBlcXVhbHMoT2JqZWN0IG90aGVyKSB7CiAgICAgICAg\naWYgKG90aGVyID09IHRoaXMpCiAgICAgICAgICAgIHJldHVybiB0cnVlOwog\nICAgICAgIGlmICghKG90aGVyIGluc3RhbmNlb2YgU1FMQnVmZmVyKSkKICAg\nICAgICAgICAgcmV0dXJuIGZhbHNlOwoKICAgICAgICBTUUxCdWZmZXIgYnVm\nID0gKFNRTEJ1ZmZlcikgb3RoZXI7CiAgICAgICAgcmV0dXJuIF9zcWwuZXF1\nYWxzKGJ1Zi5fc3FsKQogICAgICAgICAgICAmJiBPYmplY3RVdGlscy5lcXVh\nbHMoX3BhcmFtcywgYnVmLl9wYXJhbXMpOwogICAgfQoKICAgIC8qKgogICAg\nICogUmVwbGFjZSBTUUwgJz8nIHdpdGggQ0FTVCBzdHJpbmcgaWYgcmVxdWly\nZWQgYnkgREIgcGxhdGZvcm0KICAgICAqIEBwYXJhbSBvcGVyCiAgICAgKiBA\ncGFyYW0gdmFsCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIGFkZENhc3RGb3JQ\nYXJhbShTdHJpbmcgb3BlciwgVmFsIHZhbCkgewogICAgICAgIGlmIChfc3Fs\nLmNoYXJBdChfc3FsLmxlbmd0aCgpIC0gMSkgPT0gJz8nKSB7CiAgICAgICAg\nICAgIFN0cmluZyBjYXN0U3RyaW5nID0gX2RpY3QuYWRkQ2FzdEFzVHlwZShv\ncGVyLCB2YWwpOwogICAgICAgICAgICBpZiAoY2FzdFN0cmluZyAhPSBudWxs\nKQogICAgICAgICAgICAgICAgX3NxbC5yZXBsYWNlKF9zcWwubGVuZ3RoKCkg\nLSAxLCBfc3FsLmxlbmd0aCgpLCBjYXN0U3RyaW5nKTsKICAgICAgICB9CiAg\nICB9CgogICAgLyoqCiAgICAgKiBSZXBsYWNlIGN1cnJlbnQgYnVmZmVyIHN0\ncmluZyB3aXRoIHRoZSBuZXcgc3RyaW5nCiAgICAgKiAKICAgICAqIEBwYXJh\nbSBzdGFydCByZXBsYWNlIHN0YXJ0IHBvc2l0aW9uCiAgICAgKiBAcGFyYW0g\nZW5kIHJlcGxhY2UgZW5kIHBvc2l0aW9uCiAgICAgKiBAcGFyYW0gbmV3U3Ry\naW5nCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHJlcGxhY2VTcWxTdHJpbmco\naW50IHN0YXJ0LCBpbnQgZW5kLCBTdHJpbmcgbmV3U3RyaW5nKSB7CiAgICAg\nICAgX3NxbC5yZXBsYWNlKHN0YXJ0LCBlbmQsIG5ld1N0cmluZyk7CiAgICB9\nCiAgICAKICAgIC8qKgogICAgICogUmVwcmVzZW50cyBhIHN1YnNlbGVjdC4K\nICAgICAqLwogICAgcHJpdmF0ZSBzdGF0aWMgY2xhc3MgU3Vic2VsZWN0IHsK\nCiAgICAgICAgcHVibGljIFNlbGVjdCBzZWxlY3Q7CiAgICAgICAgcHVibGlj\nIEpEQkNGZXRjaENvbmZpZ3VyYXRpb24gZmV0Y2g7CiAgICAgICAgcHVibGlj\nIGJvb2xlYW4gY291bnQ7CiAgICAgICAgcHVibGljIGludCBzcWxJbmRleDsK\nICAgICAgICBwdWJsaWMgaW50IHBhcmFtSW5kZXg7CgogICAgICAgIHB1Ymxp\nYyBTdWJzZWxlY3QgY2xvbmUoaW50IHNxbEluZGV4LCBpbnQgcGFyYW1JbmRl\neCkgewogICAgICAgICAgICBpZiAoc3FsSW5kZXggPT0gMCAmJiBwYXJhbUlu\nZGV4ID09IDApCiAgICAgICAgICAgICAgICByZXR1cm4gdGhpczsKCiAgICAg\nICAgICAgIFN1YnNlbGVjdCBzdWIgPSBuZXcgU3Vic2VsZWN0KCk7CiAgICAg\nICAgICAgIHN1Yi5zZWxlY3QgPSBzZWxlY3Q7CiAgICAgICAgICAgIHN1Yi5m\nZXRjaCA9IGZldGNoOwogICAgICAgICAgICBzdWIuY291bnQgPSBjb3VudDsK\nICAgICAgICAgICAgc3ViLnNxbEluZGV4ID0gdGhpcy5zcWxJbmRleCArIHNx\nbEluZGV4OwogICAgICAgICAgICBzdWIucGFyYW1JbmRleCA9IHRoaXMucGFy\nYW1JbmRleCArIHBhcmFtSW5kZXg7CiAgICAgICAgICAgIHJldHVybiBzdWI7\nCiAgICAgICAgfQogICAgfQogICAgCiAgICBwdWJsaWMgdm9pZCBzZXRQYXJh\nbWV0ZXJzKExpc3QgcGFyYW1zKSB7CiAgICAgICAgX3BhcmFtcyA9IHBhcmFt\nczsKICAgIH0KICAgIAogICAgcHVibGljIExpc3QgZ2V0Q29sdW1ucygpIHsK\nICAgICAgICByZXR1cm4gX2NvbHM7CiAgICB9Cn0K\n","encoding":"base64"}

