{"sha":"3972a32a8c4b9799e44365a6ac2c62010c2a6c62","node_id":"MDQ6QmxvYjIwNjM2NDozOTcyYTMyYThjNGI5Nzk5ZTQ0MzY1YTZhYzJjNjIwMTBjMmE2YzYy","size":30503,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/3972a32a8c4b9799e44365a6ac2c62010c2a6c62","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsOwoKaW1wb3J0IGph\ndmEuaW8uT2JqZWN0U3RyZWFtRXhjZXB0aW9uOwppbXBvcnQgamF2YS51dGls\nLkFycmF5TGlzdDsKaW1wb3J0IGphdmEudXRpbC5Db2xsZWN0aW9uOwppbXBv\ncnQgamF2YS51dGlsLkNvbGxlY3Rpb25zOwppbXBvcnQgamF2YS51dGlsLkhh\nc2hNYXA7CmltcG9ydCBqYXZhLnV0aWwuSXRlcmF0b3I7CmltcG9ydCBqYXZh\nLnV0aWwuTGlua2VkTGlzdDsKaW1wb3J0IGphdmEudXRpbC5MaXN0OwppbXBv\ncnQgamF2YS51dGlsLk1hcDsKaW1wb3J0IGphdmEudXRpbC5TZXQ7CmltcG9y\ndCBqYXZhLnV0aWwuY29uY3VycmVudC5Db25jdXJyZW50SGFzaE1hcDsKaW1w\nb3J0IGphdmEudXRpbC5jb25jdXJyZW50LmxvY2tzLlJlZW50cmFudExvY2s7\nCgppbXBvcnQgamF2YXgubmFtaW5nLk5hbWluZ0V4Y2VwdGlvbjsKaW1wb3J0\nIGphdmF4LnRyYW5zYWN0aW9uLlN0YXR1czsKaW1wb3J0IGphdmF4LnRyYW5z\nYWN0aW9uLlN5bmNocm9uaXphdGlvbjsKaW1wb3J0IGphdmF4LnRyYW5zYWN0\naW9uLlRyYW5zYWN0aW9uOwppbXBvcnQgamF2YXgudHJhbnNhY3Rpb24uVHJh\nbnNhY3Rpb25NYW5hZ2VyOwoKaW1wb3J0IG9yZy5hcGFjaGUuY29tbW9ucy5j\nb2xsZWN0aW9ucy5zZXQuTWFwQmFja2VkU2V0OwppbXBvcnQgb3JnLmFwYWNo\nZS5jb21tb25zLmxhbmcuU3RyaW5nVXRpbHM7CmltcG9ydCBvcmcuYXBhY2hl\nLmNvbW1vbnMubGFuZy5leGNlcHRpb24uTmVzdGFibGVSdW50aW1lRXhjZXB0\naW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmNvbmYuQnJva2VyVmFs\ndWU7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuY29uZi5NZXRhRGF0YVJl\ncG9zaXRvcnlWYWx1ZTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5jb25m\nLk9wZW5KUEFDb25maWd1cmF0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLmNvbmYuT3BlbkpQQUNvbmZpZ3VyYXRpb25JbXBsOwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLmNvbmYuT3BlbkpQQVZlcnNpb247CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEuZGF0YWNhY2hlLkRhdGFDYWNoZVN0b3JlTWFu\nYWdlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5lZS5NYW5hZ2VkUnVu\ndGltZTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5lbmhhbmNlLk1hbmFn\nZWRDbGFzc1N1YmNsYXNzZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\nZW5oYW5jZS5QQ1JlZ2lzdHJ5OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLmVuaGFuY2UuUGVyc2lzdGVuY2VDYXBhYmxlOwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLmV2ZW50LkJyb2tlckZhY3RvcnlFdmVudDsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5ldmVudC5SZW1vdGVDb21taXRFdmVudE1hbmFn\nZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLmNvbmYuQ29uZmln\ndXJhdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIuY29uZi5D\nb25maWd1cmF0aW9uczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIu\nbG9nLkxvZzsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIudXRpbC5K\nMkRvUHJpdkhlbHBlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIu\ndXRpbC5Mb2NhbGl6ZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGli\nLnV0aWwuY29uY3VycmVudC5Db25jdXJyZW50UmVmZXJlbmNlSGFzaFNldDsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRhLk1ldGFEYXRhTW9kZXM7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YS5NZXRhRGF0YVJlcG9z\naXRvcnk7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5HZW5lcmFs\nRXhjZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuSW52\nYWxpZFN0YXRlRXhjZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLnV0aWwuTWV0YURhdGFFeGNlcHRpb247CmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEudXRpbC5PcGVuSlBBRXhjZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLnV0aWwuVXNlckV4Y2VwdGlvbjsKCi8qKgogKiBBYnN0cmFj\ndCBpbXBsZW1lbnRhdGlvbiBvZiB0aGUge0BsaW5rIEJyb2tlckZhY3Rvcnl9\nCiAqIHRoYXQgbXVzdCBiZSBzdWJjbGFzc2VkIGZvciBhIHNwZWNpZmljIHJ1\nbnRpbWUuCiAqCiAqIEBhdXRob3IgQWJlIFdoaXRlCiAqLwpAU3VwcHJlc3NX\nYXJuaW5ncygic2VyaWFsIikKcHVibGljIGFic3RyYWN0IGNsYXNzIEFic3Ry\nYWN0QnJva2VyRmFjdG9yeQogICAgaW1wbGVtZW50cyBCcm9rZXJGYWN0b3J5\nIHsKCiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBMb2NhbGl6ZXIgX2xvYyA9\nIExvY2FsaXplci5mb3JQYWNrYWdlKEFic3RyYWN0QnJva2VyRmFjdG9yeS5j\nbGFzcyk7CgogICAgLy8gc3RhdGljIG1hcHBpbmcgb2YgY29uZmlndXJhdGlv\nbnMgdG8gcG9vbGVkIGJyb2tlciBmYWN0b3JpZXMKICAgIHByaXZhdGUgc3Rh\ndGljIGZpbmFsIE1hcDxPYmplY3QsQWJzdHJhY3RCcm9rZXJGYWN0b3J5PiBf\ncG9vbCA9IAogICAgICAgQ29sbGVjdGlvbnMuc3luY2hyb25pemVkTWFwKG5l\ndyBIYXNoTWFwPE9iamVjdCxBYnN0cmFjdEJyb2tlckZhY3Rvcnk+KCkpOwoK\nICAgIC8vIGNvbmZpZ3VyYXRpb24KICAgIHByaXZhdGUgZmluYWwgT3BlbkpQ\nQUNvbmZpZ3VyYXRpb24gX2NvbmY7CiAgICBwcml2YXRlIHRyYW5zaWVudCBi\nb29sZWFuIF9yZWFkT25seSA9IGZhbHNlOwogICAgcHJpdmF0ZSB0cmFuc2ll\nbnQgYm9vbGVhbiBfY2xvc2VkID0gZmFsc2U7CiAgICBwcml2YXRlIHRyYW5z\naWVudCBSdW50aW1lRXhjZXB0aW9uIF9jbG9zZWRFeGNlcHRpb24gPSBudWxs\nOwogICAgcHJpdmF0ZSBNYXA8T2JqZWN0LE9iamVjdD4gX3VzZXJPYmplY3Rz\nID0gbnVsbDsKCiAgICAvLyBpbnRlcm5hbCBsb2NrOiBzcGVjIGZvcmJpZHMg\nc3luY2hyb25pemF0aW9uIG9uIHRoaXMgb2JqZWN0CiAgICBwcml2YXRlIGZp\nbmFsIFJlZW50cmFudExvY2sgX2xvY2sgPSBuZXcgUmVlbnRyYW50TG9jaygp\nOwoKICAgIC8vIG1hcHMgZ2xvYmFsIHRyYW5zYWN0aW9ucyB0byBhc3NvY2lh\ndGVkIGJyb2tlcnMKICAgIHByaXZhdGUgdHJhbnNpZW50IENvbmN1cnJlbnRI\nYXNoTWFwPE9iamVjdCxDb2xsZWN0aW9uPEJyb2tlcj4+IAogICAgICAgIF90\ncmFuc2FjdGlvbmFsID0gbmV3IENvbmN1cnJlbnRIYXNoTWFwPE9iamVjdCxD\nb2xsZWN0aW9uPEJyb2tlcj4+KCk7CgogICAgLy8gd2Vhay1yZWYgdHJhY2tp\nbmcgb2Ygb3BlbiBicm9rZXJzCiAgICBwcml2YXRlIHRyYW5zaWVudCBTZXQ8\nQnJva2VyPiBfYnJva2VyczsKCiAgICAvLyBjYWNoZSB0aGUgY2xhc3MgbmFt\nZXMgbG9hZGVkIGZyb20gdGhlIHBlcnNpc3RlbnQgY2xhc3NlcyBwcm9wZXJ0\neSBzbwogICAgLy8gdGhhdCB3ZSBjYW4gcmUtbG9hZCB0aGVtIGZvciBlYWNo\nIG5ldyBicm9rZXIKICAgIHByaXZhdGUgdHJhbnNpZW50IENvbGxlY3Rpb248\nU3RyaW5nPiBfcGNDbGFzc05hbWVzID0gbnVsbDsKICAgIHByaXZhdGUgdHJh\nbnNpZW50IENvbGxlY3Rpb248Q2xhc3NMb2FkZXI+IF9wY0NsYXNzTG9hZGVy\ncyA9IG51bGw7CiAgICBwcml2YXRlIHRyYW5zaWVudCBib29sZWFuIF9wZXJz\naXN0ZW50VHlwZXNMb2FkZWQgPSBmYWxzZTsKCiAgICAvLyBsaWZlY3ljbGUg\nbGlzdGVuZXJzIHRvIHBhc3MgdG8gZWFjaCBicm9rZXIKICAgIHByaXZhdGUg\ndHJhbnNpZW50IE1hcDxPYmplY3QsIENsYXNzPD8+W10+IF9saWZlY3ljbGVM\naXN0ZW5lcnMgPSBudWxsOwoKICAgIC8vIHRyYW5zYWN0aW9uIGxpc3RlbmVy\ncyB0byBwYXNzIHRvIGVhY2ggYnJva2VyCiAgICBwcml2YXRlIHRyYW5zaWVu\ndCBMaXN0PE9iamVjdD4gX3RyYW5zYWN0aW9uTGlzdGVuZXJzID0gbnVsbDsK\nCiAgICAvLyBrZXkgdW5kZXIgd2hpY2ggdGhpcyBpbnN0YW5jZSBjYW4gYmUg\nc3RvcmVkIGluIHRoZSBicm9rZXIgcG9vbAogICAgLy8gYW5kIGxhdGVyIGlk\nZW50aWZpZWQKICAgIHByaXZhdGUgT2JqZWN0IF9wb29sS2V5OyAgIAogICAg\nCiAgICAvKioKICAgICAqIFJldHVybiBhbiBpbnRlcm5hbCBmYWN0b3J5IHBv\nb2wga2V5IGZvciB0aGUgZ2l2ZW4gY29uZmlndXJhdGlvbi4KICAgICAqCiAg\nICAgKiBAc2luY2UgMS4xLjAKICAgICAqLwogICAgcHJvdGVjdGVkIHN0YXRp\nYyBPYmplY3QgdG9Qb29sS2V5KE1hcDxTdHJpbmcsT2JqZWN0PiBtYXApIHsK\nICAgICAgICBPYmplY3Qga2V5ID0gQ29uZmlndXJhdGlvbnMuZ2V0UHJvcGVy\ndHkoIklkIiwgbWFwKTsKICAgICAgICByZXR1cm4gKCBrZXkgIT0gbnVsbCkg\nPyBrZXkgOiBtYXA7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZWdpc3RlciA8\nY29kZT5mYWN0b3J5PC9jb2RlPiBpbiB0aGUgcG9vbCB1bmRlciA8Y29kZT5r\nZXk8L2NvZGU+LgogICAgICoKICAgICAqIEBzaW5jZSAxLjEuMAogICAgICov\nCiAgICBwcm90ZWN0ZWQgc3RhdGljIHZvaWQgcG9vbChPYmplY3Qga2V5LCBB\nYnN0cmFjdEJyb2tlckZhY3RvcnkgZmFjdG9yeSkgewogICAgICAgIHN5bmNo\ncm9uaXplZChfcG9vbCkgewogICAgICAgICAgICBfcG9vbC5wdXQoa2V5LCBm\nYWN0b3J5KTsKICAgICAgICAgICAgZmFjdG9yeS5zZXRQb29sS2V5KGtleSk7\nCiAgICAgICAgICAgIGZhY3RvcnkubWFrZVJlYWRPbmx5KCk7CiAgICAgICAg\nfQogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRoZSBwb29sZWQgZmFj\ndG9yeSBtYXRjaGluZyB0aGUgZ2l2ZW4ga2V5LCBvciBudWxsCiAgICAgKiBp\nZiBub25lLiBUaGUga2V5IG11c3QgYmUgb2YgdGhlIGZvcm0gY3JlYXRlZCBi\neSB7QGxpbmsgI2dldFBvb2xLZXl9LgogICAgICovCiAgICBwdWJsaWMgc3Rh\ndGljIEFic3RyYWN0QnJva2VyRmFjdG9yeSBnZXRQb29sZWRGYWN0b3J5Rm9y\nS2V5KE9iamVjdCBrZXkpIHsKICAgICAgICByZXR1cm4gKEFic3RyYWN0QnJv\na2VyRmFjdG9yeSkgX3Bvb2wuZ2V0KGtleSk7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBDb25zdHJ1Y3Rvci4gQ29uZmlndXJhdGlvbiBtdXN0IGJlIHByb3Zp\nZGVkIG9uIGNvbnN0cnVjdGlvbi4KICAgICAqLwogICAgcHJvdGVjdGVkIEFi\nc3RyYWN0QnJva2VyRmFjdG9yeShPcGVuSlBBQ29uZmlndXJhdGlvbiBjb25m\naWcpIHsKICAgICAgICBfY29uZiA9IGNvbmZpZzsKICAgICAgICBfYnJva2Vy\ncyA9IG5ld0Jyb2tlclNldCgpOwogICAgICAgIGdldFBjQ2xhc3NMb2FkZXJz\nKCk7CiAgICAgICAgaWYgKGNvbmZpZy5pc0luaXRpYWxpemVFYWdlcmx5KCkp\nIHsKICAgICAgICAgICAgbmV3QnJva2VyKF9jb25mLmdldENvbm5lY3Rpb25V\nc2VyTmFtZSgpLCAKICAgICAgICAgICAgCV9jb25mLmdldENvbm5lY3Rpb25Q\nYXNzd29yZCgpLCAKICAgICAgICAgICAgCV9jb25mLmlzQ29ubmVjdGlvbkZh\nY3RvcnlNb2RlTWFuYWdlZCgpLAogICAgICAgICAgICAgICAgX2NvbmYuZ2V0\nQ29ubmVjdGlvblJldGFpbk1vZGVDb25zdGFudCgpLCBmYWxzZSkuY2xvc2Uo\nKTsgCiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRo\nZSBjb25maWd1cmF0aW9uIGZvciB0aGlzIGZhY3RvcnkuCiAgICAgKi8KICAg\nIHB1YmxpYyBPcGVuSlBBQ29uZmlndXJhdGlvbiBnZXRDb25maWd1cmF0aW9u\nKCkgewogICAgICAgIHJldHVybiBfY29uZjsKICAgIH0KCiAgICBwdWJsaWMg\nQnJva2VyIG5ld0Jyb2tlcigpIHsKICAgICAgICByZXR1cm4gbmV3QnJva2Vy\nKF9jb25mLmdldENvbm5lY3Rpb25Vc2VyTmFtZSgpLCBfY29uZi5nZXRDb25u\nZWN0aW9uUGFzc3dvcmQoKSk7CiAgICB9CgogICAgcHVibGljIEJyb2tlciBu\nZXdCcm9rZXIoU3RyaW5nIHVzZXIsIFN0cmluZyBwYXNzKSB7CiAgICAgICAg\ncmV0dXJuIG5ld0Jyb2tlcih1c2VyLCBwYXNzLCBfY29uZi5pc1RyYW5zYWN0\naW9uTW9kZU1hbmFnZWQoKSwgX2NvbmYuZ2V0Q29ubmVjdGlvblJldGFpbk1v\nZGVDb25zdGFudCgpKTsKICAgIH0KCiAgICBwdWJsaWMgQnJva2VyIG5ld0Jy\nb2tlcihib29sZWFuIG1hbmFnZWQsIGludCBjb25uUmV0YWluTW9kZSkgewog\nICAgICAgIHJldHVybiBuZXdCcm9rZXIoX2NvbmYuZ2V0Q29ubmVjdGlvblVz\nZXJOYW1lKCksIF9jb25mLmdldENvbm5lY3Rpb25QYXNzd29yZCgpLCBtYW5h\nZ2VkLCBjb25uUmV0YWluTW9kZSk7CiAgICB9CgogICAgcHVibGljIEJyb2tl\nciBuZXdCcm9rZXIoU3RyaW5nIHVzZXIsIFN0cmluZyBwYXNzLCBib29sZWFu\nIG1hbmFnZWQsIGludCBjb25uUmV0YWluTW9kZSkgewogICAgICAgIHJldHVy\nbiBuZXdCcm9rZXIodXNlciwgcGFzcywgbWFuYWdlZCwgY29ublJldGFpbk1v\nZGUsIHRydWUpOwogICAgfQogICAgCiAgICBwdWJsaWMgQnJva2VyIG5ld0Jy\nb2tlcihTdHJpbmcgdXNlciwgU3RyaW5nIHBhc3MsIGJvb2xlYW4gbWFuYWdl\nZCwgaW50IGNvbm5SZXRhaW5Nb2RlLCBib29sZWFuIGZpbmRFeGlzdGluZykg\newogICAgICAgIHJldHVybiBuZXdCcm9rZXIodXNlciwgcGFzcywgbWFuYWdl\nZCwgY29ublJldGFpbk1vZGUsIGZpbmRFeGlzdGluZywgIiIsICIiKTsKICAg\nIH0KCiAgICBwdWJsaWMgQnJva2VyIG5ld0Jyb2tlcihTdHJpbmcgdXNlciwg\nU3RyaW5nIHBhc3MsIGJvb2xlYW4gbWFuYWdlZCwgaW50IGNvbm5SZXRhaW5N\nb2RlLCBib29sZWFuIGZpbmRFeGlzdGluZywKICAgICAgICBTdHJpbmcgY2Yx\nTmFtZSwgU3RyaW5nIGNmMk5hbWUpIHsKICAgICAgICB0cnkgewogICAgICAg\nICAgICBhc3NlcnRPcGVuKCk7CiAgICAgICAgICAgIAogICAgICAgICAgICBp\nZihTdHJpbmdVdGlscy5pc05vdEVtcHR5KGNmMU5hbWUpKSB7CiAgICAgICAg\nICAgICAgICAvLyBJZiB0aGUgY2ZOYW1lIGhhcyBiZWVuIHNldCBvbiB0aGUg\nYnJva2VyIHRyeSBsb29raW5nIHVwIG5vdy4KICAgICAgICAgICAgICAgIHRy\neSB7IAogICAgICAgICAgICAgICAgICAgIF9jb25mLmdldENvbm5lY3Rpb25G\nYWN0b3J5KCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBj\nYXRjaChVc2VyRXhjZXB0aW9uIHVlKSB7IAogICAgICAgICAgICAgICAgICAg\nICAvLyB0cnkgc2V0dGluZyB0aGUgYnJva2VyJ3MgQ0YgaW50byB0aGUgY29u\nZmlndXJhdGlvbi4gCiAgICAgICAgICAgICAgICAgICAgX2NvbmYuc2V0Q29u\nbmVjdGlvbkZhY3RvcnlOYW1lKGNmMU5hbWUpOyAKICAgICAgICAgICAgICAg\nIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBtYWtlUmVhZE9ubHkoKTsK\nCiAgICAgICAgICAgIEJyb2tlciBicm9rZXIgPSBudWxsOwogICAgICAgICAg\nICBpZiAoZmluZEV4aXN0aW5nKQogICAgICAgICAgICAgICAgYnJva2VyID0g\nZmluZEJyb2tlcih1c2VyLCBwYXNzLCBtYW5hZ2VkKTsKICAgICAgICAgICAg\naWYgKGJyb2tlciA9PSBudWxsKSB7CiAgICAgICAgICAgICAgICBicm9rZXIg\nPSBuZXdCcm9rZXJJbXBsKHVzZXIsIHBhc3MpOwogICAgICAgICAgICAgICAg\nYnJva2VyLnNldENvbm5lY3Rpb25GYWN0b3J5TmFtZShjZjFOYW1lKTsKICAg\nICAgICAgICAgICAgIGJyb2tlci5zZXRDb25uZWN0aW9uRmFjdG9yeTJOYW1l\nKGNmMk5hbWUpOwogICAgICAgICAgICAgICAgaW5pdGlhbGl6ZUJyb2tlciht\nYW5hZ2VkLCBjb25uUmV0YWluTW9kZSwgYnJva2VyLCBmYWxzZSk7CiAgICAg\nICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIGJyb2tlcjsKICAgICAgICB9\nIGNhdGNoIChPcGVuSlBBRXhjZXB0aW9uIGtlKSB7CiAgICAgICAgICAgIHRo\ncm93IGtlOwogICAgICAgIH0gY2F0Y2ggKFJ1bnRpbWVFeGNlcHRpb24gcmUp\nIHsKICAgICAgICAgICAgdGhyb3cgbmV3IEdlbmVyYWxFeGNlcHRpb24ocmUp\nOwogICAgICAgIH0KICAgIH0KCiAgICB2b2lkIGluaXRpYWxpemVCcm9rZXIo\nYm9vbGVhbiBtYW5hZ2VkLCBpbnQgY29ublJldGFpbk1vZGUsIEJyb2tlciBi\ncm9rZXIsIGJvb2xlYW4gZnJvbURlc2VyaWFsaXphdGlvbikgewogICAgICAg\nIGFzc2VydE9wZW4oKTsKICAgICAgICBtYWtlUmVhZE9ubHkoKTsKICAgICAg\nICAKICAgICAgICBEZWxlZ2F0aW5nU3RvcmVNYW5hZ2VyIGRzbSA9IGNyZWF0\nZURlbGVnYXRpbmdTdG9yZU1hbmFnZXIoKTsKCiAgICAgICAgKChCcm9rZXJJ\nbXBsKSBicm9rZXIpLmluaXRpYWxpemUodGhpcywgZHNtLCBtYW5hZ2VkLCBj\nb25uUmV0YWluTW9kZSwgZnJvbURlc2VyaWFsaXphdGlvbik7CiAgICAgICAg\naWYgKCFmcm9tRGVzZXJpYWxpemF0aW9uKQogICAgICAgICAgICBhZGRMaXN0\nZW5lcnMoYnJva2VyKTsKCiAgICAgICAgLy8gaWYgd2UncmUgdXNpbmcgcmVt\nb3RlIGV2ZW50cywgcmVnaXN0ZXIgdGhlIGV2ZW50IG1hbmFnZXIgc28KICAg\nICAgICAvLyB0aGF0IGl0IGNhbiBicm9hZGNhc3QgY29tbWl0IG5vdGlmaWNh\ndGlvbnMgZnJvbSB0aGUgYnJva2VyCiAgICAgICAgUmVtb3RlQ29tbWl0RXZl\nbnRNYW5hZ2VyIHJlbW90ZSA9IF9jb25mLmdldFJlbW90ZUNvbW1pdEV2ZW50\nTWFuYWdlcigpOwogICAgICAgIGlmIChyZW1vdGUuYXJlUmVtb3RlRXZlbnRz\nRW5hYmxlZCgpKQogICAgICAgICAgICBicm9rZXIuYWRkVHJhbnNhY3Rpb25M\naXN0ZW5lcihyZW1vdGUpOwoKICAgICAgICBsb2FkUGVyc2lzdGVudFR5cGVz\nKGJyb2tlci5nZXRDbGFzc0xvYWRlcigpKTsKICAgICAgICBfYnJva2Vycy5h\nZGQoYnJva2VyKTsKICAgICAgICBfY29uZi5zZXRSZWFkT25seShDb25maWd1\ncmF0aW9uLklOSVRfU1RBVEVfRlJPWkVOKTsKICAgIH0KCiAgICAvKioKICAg\nICAqIEFkZCBmYWN0b3J5LXJlZ2lzdGVyZWQgbGlmZWN5Y2xlIGxpc3RlbmVy\ncyB0byB0aGUgYnJva2VyLgogICAgICovCiAgICBwcm90ZWN0ZWQgdm9pZCBh\nZGRMaXN0ZW5lcnMoQnJva2VyIGJyb2tlcikgewogICAgICAgIGlmIChfbGlm\nZWN5Y2xlTGlzdGVuZXJzICE9IG51bGwgJiYgIV9saWZlY3ljbGVMaXN0ZW5l\ncnMuaXNFbXB0eSgpKSB7CiAgICAgICAgICAgIGZvciAoTWFwLkVudHJ5PE9i\namVjdCxDbGFzczw/PltdPiBlbnRyeSA6IF9saWZlY3ljbGVMaXN0ZW5lcnMu\nZW50cnlTZXQoKSkgewogICAgICAgICAgICAgICAgYnJva2VyLmFkZExpZmVj\neWNsZUxpc3RlbmVyKGVudHJ5LmdldEtleSgpLCBlbnRyeS5nZXRWYWx1ZSgp\nKTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgKF90cmFu\nc2FjdGlvbkxpc3RlbmVycyAhPSBudWxsICYmICFfdHJhbnNhY3Rpb25MaXN0\nZW5lcnMuaXNFbXB0eSgpKSB7CiAgICAgICAgICAgIGZvciAoSXRlcmF0b3I8\nT2JqZWN0PiBpdHIgPSBfdHJhbnNhY3Rpb25MaXN0ZW5lcnMuaXRlcmF0b3Io\nKTsKICAgICAgICAgICAgICAgIGl0ci5oYXNOZXh0KCk7ICkgewogICAgICAg\nICAgICAgICAgYnJva2VyLmFkZFRyYW5zYWN0aW9uTGlzdGVuZXIoaXRyLm5l\neHQoKSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgLyoq\nCiAgICAgKiBMb2FkIHRoZSBjb25maWd1cmVkIHBlcnNpc3RlbnQgY2xhc3Nl\ncyBsaXN0LiBQZXJmb3JtZWQgYXV0b21hdGljYWxseQogICAgICogd2hlbmV2\nZXIgYSBicm9rZXIgaXMgY3JlYXRlZC4KICAgICAqLwogICAgcHVibGljIHZv\naWQgbG9hZFBlcnNpc3RlbnRUeXBlcyhDbGFzc0xvYWRlciBlbnZMb2FkZXIp\nIHsKICAgICAgICAvLyBpZiB3ZSd2ZSBsb2FkZWQgdGhlIHBlcnNpc3RlbnQg\ndHlwZXMgYW5kIHRoZSBjbGFzcyBuYW1lIGxpc3QKICAgICAgICAvLyBpcyBl\nbXB0eSwgdGhlbiB3ZSBjYW4gc2ltcGx5IHJldHVybi4gTm90ZSB0aGF0IHRo\nZXJlIGlzIGEKICAgICAgICAvLyBwb3RlbnRpYWwgdGhyZWFkaW5nIHNjZW5h\ncmlvIGluIHdoaWNoIF9wZXJzaXN0ZW50VHlwZXNMb2FkZWQgaXMKICAgICAg\nICAvLyBmYWxzZSB3aGVuIHJlYWQsIGJ1dCB0aGUgd29yayB0byBwb3B1bGF0\nZSBfcGNDbGFzc05hbWVzIGhhcwogICAgICAgIC8vIGFscmVhZHkgYmVlbiBk\nb25lLiBUaGlzIGlzIG9rOyBfcGNDbGFzc05hbWVzIGNhbiB0b2xlcmF0ZQog\nICAgICAgIC8vIGNvbmN1cnJlbnQgYWNjZXNzLCBzbyB0aGUgd29yc3QgY2Fz\nZSBpcyB0aGF0IHRoZSBsaXN0IGlzCiAgICAgICAgLy8gcGVyc2lzdGVudCB0\neXBlIGRhdGEgaXMgcHJvY2Vzc2VkIG11bHRpcGxlIHRpbWVzLCB3aGljaCB0\naGlzCiAgICAgICAgLy8gYWxnb3JpdGhtIHRha2VzIGludG8gYWNjb3VudC4K\nICAgICAgICBpZiAoX3BlcnNpc3RlbnRUeXBlc0xvYWRlZCAmJiBfcGNDbGFz\nc05hbWVzLmlzRW1wdHkoKSkKICAgICAgICAgICAgcmV0dXJuOwoKICAgICAg\nICAvLyBjYWNoZSBwZXJzaXN0ZW50IHR5cGUgbmFtZXMgaWYgbm90IGFscmVh\nZHkKICAgICAgICBDbGFzc0xvYWRlciBsb2FkZXIgPSBfY29uZi5nZXRDbGFz\nc1Jlc29sdmVySW5zdGFuY2UoKS4KICAgICAgICAgICAgZ2V0Q2xhc3NMb2Fk\nZXIoZ2V0Q2xhc3MoKSwgZW52TG9hZGVyKTsKICAgICAgICBDb2xsZWN0aW9u\nPENsYXNzPD8+PiB0b1JlZGVmaW5lID0gbmV3IEFycmF5TGlzdDxDbGFzczw/\nPj4oKTsKICAgICAgICBpZiAoIV9wZXJzaXN0ZW50VHlwZXNMb2FkZWQpIHsK\nICAgICAgICAgICAgQ29sbGVjdGlvbjxDbGFzczw/Pj4gY2xzcyA9IF9jb25m\nLmdldE1ldGFEYXRhUmVwb3NpdG9yeUluc3RhbmNlKCkuCiAgICAgICAgICAg\nICAgICBsb2FkUGVyc2lzdGVudFR5cGVzKGZhbHNlLCBsb2FkZXIsIF9jb25m\nLmlzSW5pdGlhbGl6ZUVhZ2VybHkoKSk7CiAgICAgICAgICAgIGlmIChjbHNz\nLmlzRW1wdHkoKSkKICAgICAgICAgICAgICAgIF9wY0NsYXNzTmFtZXMgPSBD\nb2xsZWN0aW9ucy5lbXB0eUxpc3QoKTsKICAgICAgICAgICAgZWxzZSB7CiAg\nICAgICAgICAgICAgICBDb2xsZWN0aW9uPFN0cmluZz4gYyA9IG5ldyBBcnJh\neUxpc3Q8U3RyaW5nPihjbHNzLnNpemUoKSk7CiAgICAgICAgICAgICAgICBm\nb3IgKEl0ZXJhdG9yPENsYXNzPD8+PiBpdHIgPSBjbHNzLml0ZXJhdG9yKCk7\nIGl0ci5oYXNOZXh0KCk7KSB7CiAgICAgICAgICAgICAgICAgICAgQ2xhc3M8\nPz4gY2xzID0gaXRyLm5leHQoKTsKICAgICAgICAgICAgICAgICAgICBjLmFk\nZChjbHMuZ2V0TmFtZSgpKTsKICAgICAgICAgICAgICAgICAgICBpZiAobmVl\nZHNTdWIoY2xzKSkKICAgICAgICAgICAgICAgICAgICAgICAgdG9SZWRlZmlu\nZS5hZGQoY2xzKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAg\nIGdldFBjQ2xhc3NMb2FkZXJzKCkuYWRkKGxvYWRlcik7CiAgICAgICAgICAg\nICAgICBfcGNDbGFzc05hbWVzID0gYzsKICAgICAgICAgICAgfQogICAgICAg\nICAgICBfcGVyc2lzdGVudFR5cGVzTG9hZGVkID0gdHJ1ZTsKICAgICAgICB9\nIGVsc2UgewogICAgICAgICAgICAvLyByZWxvYWQgd2l0aCB0aGlzIGxvYWRl\ncgogICAgICAgICAgICBpZiAoZ2V0UGNDbGFzc0xvYWRlcnMoKS5hZGQobG9h\nZGVyKSkgewogICAgICAgICAgICAgICAgZm9yIChTdHJpbmcgY2xzTmFtZSA6\nIF9wY0NsYXNzTmFtZXMpIHsKICAgICAgICAgICAgICAgICAgICB0cnkgewog\nICAgICAgICAgICAgICAgICAgICAgICBDbGFzczw/PiBjbHMgPSBDbGFzcy5m\nb3JOYW1lKGNsc05hbWUsIHRydWUsIGxvYWRlcik7CiAgICAgICAgICAgICAg\nICAgICAgICAgIGlmIChuZWVkc1N1YihjbHMpKQogICAgICAgICAgICAgICAg\nICAgICAgICAgICAgdG9SZWRlZmluZS5hZGQoY2xzKTsKICAgICAgICAgICAg\nICAgICAgICB9IGNhdGNoIChUaHJvd2FibGUgdCkgewogICAgICAgICAgICAg\nICAgICAgICAgICBfY29uZi5nZXRMb2coT3BlbkpQQUNvbmZpZ3VyYXRpb24u\nTE9HX1JVTlRJTUUpLndhcm4obnVsbCwgdCk7CiAgICAgICAgICAgICAgICAg\nICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAg\nfQoKICAgICAgICAvLyBnZXQgdGhlIE1hbmFnZWRDbGFzc1N1YmNsYXNzZXIg\naW50byB0aGUgbG9vcAogICAgICAgIE1hbmFnZWRDbGFzc1N1YmNsYXNzZXIu\ncHJlcGFyZVVuZW5oYW5jZWRDbGFzc2VzKF9jb25mLCB0b1JlZGVmaW5lLCBl\nbnZMb2FkZXIpOwogICAgfQoKICAgIHByaXZhdGUgYm9vbGVhbiBuZWVkc1N1\nYihDbGFzczw/PiBjbHMpIHsKICAgICAgICByZXR1cm4gIWNscy5pc0ludGVy\nZmFjZSgpCiAgICAgICAgICAgICYmICFQZXJzaXN0ZW5jZUNhcGFibGUuY2xh\nc3MuaXNBc3NpZ25hYmxlRnJvbShjbHMpOwogICAgfQoKICAgIHB1YmxpYyB2\nb2lkIGFkZExpZmVjeWNsZUxpc3RlbmVyKE9iamVjdCBsaXN0ZW5lciwgQ2xh\nc3M8Pz5bXSBjbGFzc2VzKSB7CiAgICAgICAgbG9jaygpOwogICAgICAgIHRy\neSB7CiAgICAgICAgICAgIGFzc2VydE9wZW4oKTsKICAgICAgICAgICAgaWYg\nKF9saWZlY3ljbGVMaXN0ZW5lcnMgPT0gbnVsbCkKICAgICAgICAgICAgICAg\nIF9saWZlY3ljbGVMaXN0ZW5lcnMgPSBuZXcgSGFzaE1hcDxPYmplY3QsIENs\nYXNzPD8+W10+KDcpOwogICAgICAgICAgICBfbGlmZWN5Y2xlTGlzdGVuZXJz\nLnB1dChsaXN0ZW5lciwgY2xhc3Nlcyk7CiAgICAgICAgfSBmaW5hbGx5IHsK\nICAgICAgICAgICAgdW5sb2NrKCk7CiAgICAgICAgfQogICAgfQoKICAgIHB1\nYmxpYyB2b2lkIHJlbW92ZUxpZmVjeWNsZUxpc3RlbmVyKE9iamVjdCBsaXN0\nZW5lcikgewogICAgICAgIGxvY2soKTsKICAgICAgICB0cnkgewogICAgICAg\nICAgICBhc3NlcnRPcGVuKCk7CiAgICAgICAgICAgIGlmIChfbGlmZWN5Y2xl\nTGlzdGVuZXJzICE9IG51bGwpCiAgICAgICAgICAgICAgICBfbGlmZWN5Y2xl\nTGlzdGVuZXJzLnJlbW92ZShsaXN0ZW5lcik7CiAgICAgICAgfSBmaW5hbGx5\nIHsKICAgICAgICAgICAgdW5sb2NrKCk7CiAgICAgICAgfQogICAgfQoKICAg\nIHB1YmxpYyB2b2lkIGFkZFRyYW5zYWN0aW9uTGlzdGVuZXIoT2JqZWN0IGxp\nc3RlbmVyKSB7CiAgICAgICAgbG9jaygpOwogICAgICAgIHRyeSB7CiAgICAg\nICAgICAgIGFzc2VydE9wZW4oKTsKICAgICAgICAgICAgaWYgKF90cmFuc2Fj\ndGlvbkxpc3RlbmVycyA9PSBudWxsKQogICAgICAgICAgICAgICAgX3RyYW5z\nYWN0aW9uTGlzdGVuZXJzID0gbmV3IExpbmtlZExpc3Q8T2JqZWN0PigpOwog\nICAgICAgICAgICBfdHJhbnNhY3Rpb25MaXN0ZW5lcnMuYWRkKGxpc3RlbmVy\nKTsKICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICB1bmxvY2soKTsK\nICAgICAgICB9CiAgICB9CgogICAgcHVibGljIHZvaWQgcmVtb3ZlVHJhbnNh\nY3Rpb25MaXN0ZW5lcihPYmplY3QgbGlzdGVuZXIpIHsKICAgICAgICBsb2Nr\nKCk7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgYXNzZXJ0T3BlbigpOwog\nICAgICAgICAgICBpZiAoX3RyYW5zYWN0aW9uTGlzdGVuZXJzICE9IG51bGwp\nCiAgICAgICAgICAgICAgICBfdHJhbnNhY3Rpb25MaXN0ZW5lcnMucmVtb3Zl\nKGxpc3RlbmVyKTsKICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICB1\nbmxvY2soKTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1\ncm5zIHRydWUgaWYgdGhpcyBicm9rZXIgZmFjdG9yeSBpcyBjbG9zZWQuCiAg\nICAgKi8KICAgIHB1YmxpYyBib29sZWFuIGlzQ2xvc2VkKCkgewogICAgICAg\nIHJldHVybiBfY2xvc2VkOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIGNsb3Nl\nKCkgewogICAgICAgIGxvY2soKTsKCiAgICAgICAgdHJ5IHsKICAgICAgICAg\nICAgYXNzZXJ0T3BlbigpOwogICAgICAgICAgICBhc3NlcnROb0FjdGl2ZVRy\nYW5zYWN0aW9uKCk7CgogICAgICAgICAgICAvLyByZW1vdmUgZnJvbSBmYWN0\nb3J5IHBvb2wKICAgICAgICAgICAgc3luY2hyb25pemVkIChfcG9vbCkgewog\nICAgICAgICAgICAgICAgaWYgKF9wb29sLmdldChfcG9vbEtleSkgPT0gdGhp\ncykKICAgICAgICAgICAgICAgICAgICBfcG9vbC5yZW1vdmUoX3Bvb2xLZXkp\nOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBjbG9zZSBhbGwgYnJv\na2VycwogICAgICAgICAgICBmb3IgKEJyb2tlciBicm9rZXIgOiBfYnJva2Vy\ncykgewogICAgICAgICAgICAgICAgLy8gQ2hlY2sgZm9yIG51bGwgYmVjYXVz\nZSBfYnJva2VycyBtYXkgY29udGFpbiB3ZWFrIHJlZmVyZW5jZXMKICAgICAg\nICAgICAgICAgIGlmICgoYnJva2VyICE9IG51bGwpICYmICghYnJva2VyLmlz\nQ2xvc2VkKCkpKQogICAgICAgICAgICAgICAgICAgIGJyb2tlci5jbG9zZSgp\nOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZihfY29uZi5tZXRhRGF0\nYVJlcG9zaXRvcnlBdmFpbGFibGUoKSkgewogICAgICAgICAgICAgICAgLy8g\ncmVtb3ZlIG1ldGFkYXRhIHJlcG9zaXRvcnkgZnJvbSBsaXN0ZW5lciBsaXN0\nCiAgICAgICAgICAgICAgICBQQ1JlZ2lzdHJ5LnJlbW92ZVJlZ2lzdGVyQ2xh\nc3NMaXN0ZW5lcgogICAgICAgICAgICAgICAgICAgIChfY29uZi5nZXRNZXRh\nRGF0YVJlcG9zaXRvcnlJbnN0YW5jZSgpKTsKICAgICAgICAgICAgfQoKICAg\nICAgICAgICAgX2NvbmYuY2xvc2UoKTsKICAgICAgICAgICAgX2Nsb3NlZCA9\nIHRydWU7CiAgICAgICAgICAgIExvZyBsb2cgPSBfY29uZi5nZXRMb2coT3Bl\nbkpQQUNvbmZpZ3VyYXRpb24uTE9HX1JVTlRJTUUpOwogICAgICAgICAgICBp\nZiAobG9nLmlzVHJhY2VFbmFibGVkKCkpCiAgICAgICAgICAgICAgICBfY2xv\nc2VkRXhjZXB0aW9uID0gbmV3IElsbGVnYWxTdGF0ZUV4Y2VwdGlvbigpOwog\nICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgIHVubG9jaygpOwogICAg\nICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIFN1YmNsYXNzZXMgc2hvdWxk\nIG92ZXJyaWRlIHRoaXMgbWV0aG9kIHRvIGFkZCBhIDxjb2RlPlBsYXRmb3Jt\nPC9jb2RlPgogICAgICogcHJvcGVydHkgbGlzdGluZyB0aGUgcnVudGltZSBw\nbGF0Zm9ybSwgc3VjaCBhczoKICAgICAqIDxjb2RlPk9wZW5KUEEgSkRCQyBF\nZGl0aW9uOiBPcmFjbGUgRGF0YWJhc2U8L2NvZGU+CiAgICAgKi8KICAgIHB1\nYmxpYyBNYXA8U3RyaW5nLE9iamVjdD4gZ2V0UHJvcGVydGllcygpIHsKICAg\nICAgICAvLyByZXF1aXJlZCBwcm9wcyBhcmUgVmVuZG9yTmFtZSBhbmQgVmVy\nc2lvbk51bWJlcgogICAgICAgIE1hcDxTdHJpbmcsT2JqZWN0PiBwcm9wcyA9\nIF9jb25mLnRvUHJvcGVydGllcyh0cnVlKTsKICAgICAgICBwcm9wcy5wdXQo\nIlZlbmRvck5hbWUiLCBPcGVuSlBBVmVyc2lvbi5WRU5ET1JfTkFNRSk7CiAg\nICAgICAgcHJvcHMucHV0KCJWZXJzaW9uTnVtYmVyIiwgT3BlbkpQQVZlcnNp\nb24uVkVSU0lPTl9OVU1CRVIpOwogICAgICAgIHByb3BzLnB1dCgiVmVyc2lv\nbklkIiwgT3BlbkpQQVZlcnNpb24uVkVSU0lPTl9JRCk7CiAgICAgICAgcmV0\ndXJuIHByb3BzOwogICAgfQoKICAgIHB1YmxpYyBTZXQ8U3RyaW5nPiBnZXRT\ndXBwb3J0ZWRQcm9wZXJ0aWVzKCkgewogICAgICAgIHJldHVybiBfY29uZi5n\nZXRQcm9wZXJ0eUtleXMoKTsKICAgIH0KCiAgICBwdWJsaWMgT2JqZWN0IGdl\ndFVzZXJPYmplY3QoT2JqZWN0IGtleSkgewogICAgICAgIGxvY2soKTsKICAg\nICAgICB0cnkgewogICAgICAgICAgICBhc3NlcnRPcGVuKCk7CiAgICAgICAg\nICAgIHJldHVybiAoX3VzZXJPYmplY3RzID09IG51bGwpID8gbnVsbCA6IF91\nc2VyT2JqZWN0cy5nZXQoa2V5KTsKICAgICAgICB9IGZpbmFsbHkgewogICAg\nICAgICAgICB1bmxvY2soKTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGlj\nIE9iamVjdCBwdXRVc2VyT2JqZWN0KE9iamVjdCBrZXksIE9iamVjdCB2YWwp\nIHsKICAgICAgICBsb2NrKCk7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAg\nYXNzZXJ0T3BlbigpOwogICAgICAgICAgICBpZiAodmFsID09IG51bGwpCiAg\nICAgICAgICAgICAgICByZXR1cm4gKF91c2VyT2JqZWN0cyA9PSBudWxsKSA/\nIG51bGwgOiBfdXNlck9iamVjdHMucmVtb3ZlKGtleSk7CgogICAgICAgICAg\nICBpZiAoX3VzZXJPYmplY3RzID09IG51bGwpCiAgICAgICAgICAgICAgICBf\ndXNlck9iamVjdHMgPSBuZXcgSGFzaE1hcDxPYmplY3QsT2JqZWN0PigpOwog\nICAgICAgICAgICByZXR1cm4gX3VzZXJPYmplY3RzLnB1dChrZXksIHZhbCk7\nCiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgdW5sb2NrKCk7CiAg\nICAgICAgfQogICAgfQoKICAgIHB1YmxpYyB2b2lkIGxvY2soKSB7CiAgICAg\nICAgX2xvY2subG9jaygpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHVubG9j\naygpIHsKICAgICAgICBfbG9jay51bmxvY2soKTsKICAgIH0KCiAgICAvKioK\nICAgICAqIFJlcGxhY2VzIHRoZSBmYWN0b3J5IHdpdGggdGhpcyBKVk1zIHBv\nb2xlZCB2ZXJzaW9uIGlmIGl0IGV4aXN0cy4gQWxzbwogICAgICogZnJlZXpl\ncyB0aGUgZmFjdG9yeS4KICAgICAqLwogICAgcHJvdGVjdGVkIE9iamVjdCBy\nZWFkUmVzb2x2ZSgpCiAgICAgICAgdGhyb3dzIE9iamVjdFN0cmVhbUV4Y2Vw\ndGlvbiB7CiAgICAgICAgQWJzdHJhY3RCcm9rZXJGYWN0b3J5IGZhY3Rvcnkg\nPSBnZXRQb29sZWRGYWN0b3J5Rm9yS2V5KF9wb29sS2V5KTsKICAgICAgICBp\nZiAoZmFjdG9yeSAhPSBudWxsKQogICAgICAgICAgICByZXR1cm4gZmFjdG9y\neTsKCiAgICAgICAgLy8gcmVzZXQgdGhlc2UgdHJhbnNpZW50IGZpZWxkcyB0\nbyBlbXB0eSB2YWx1ZXMKICAgICAgICBfdHJhbnNhY3Rpb25hbCA9IG5ldyBD\nb25jdXJyZW50SGFzaE1hcDxPYmplY3QsQ29sbGVjdGlvbjxCcm9rZXI+Pigp\nOwogICAgICAgIF9icm9rZXJzID0gbmV3QnJva2VyU2V0KCk7CgogICAgICAg\nIG1ha2VSZWFkT25seSgpOwogICAgICAgIHJldHVybiB0aGlzOwogICAgfQoK\nICAgIHByaXZhdGUgU2V0PEJyb2tlcj4gbmV3QnJva2VyU2V0KCkgewogICAg\nICAgIEJyb2tlclZhbHVlIGJ2OwogICAgICAgIGlmIChfY29uZiBpbnN0YW5j\nZW9mIE9wZW5KUEFDb25maWd1cmF0aW9uSW1wbCkKICAgICAgICAgICAgYnYg\nPSAoKE9wZW5KUEFDb25maWd1cmF0aW9uSW1wbCkgX2NvbmYpLmJyb2tlclBs\ndWdpbjsKICAgICAgICBlbHNlCiAgICAgICAgICAgIGJ2ID0gKEJyb2tlclZh\nbHVlKSBfY29uZi5nZXRWYWx1ZShCcm9rZXJWYWx1ZS5LRVkpOwoKICAgICAg\nICBpZiAoRmluYWxpemluZ0Jyb2tlckltcGwuY2xhc3MuaXNBc3NpZ25hYmxl\nRnJvbSgKICAgICAgICAgICAgYnYuZ2V0VGVtcGxhdGVCcm9rZXJUeXBlKF9j\nb25mKSkpIHsKICAgICAgICAgICAgcmV0dXJuIE1hcEJhY2tlZFNldC5kZWNv\ncmF0ZShuZXcgQ29uY3VycmVudEhhc2hNYXAoKSwgbmV3IE9iamVjdCgpIHsg\nfSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmV0dXJuIG5ldyBD\nb25jdXJyZW50UmVmZXJlbmNlSGFzaFNldDxCcm9rZXI+KENvbmN1cnJlbnRS\nZWZlcmVuY2VIYXNoU2V0LldFQUspOwogICAgICAgIH0KICAgIH0KCiAgICAv\nLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KICAgIC8vIE1ldGhvZHMgZm9yIE92\nZXJyaWRlCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KCiAgICAvKioK\nICAgICAqIFJldHVybiBhIG5ldyBTdG9yZU1hbmFnZXIgZm9yIHRoaXMgcnVu\ndGltZS4gTm90ZSB0aGF0IHRoZSBpbnN0YW5jZQogICAgICogcmV0dXJuZWQg\naGVyZSBtYXkgYmUgd3JhcHBlZCBiZWZvcmUgYmVpbmcgcGFzc2VkIHRvIHRo\nZQogICAgICoge0BsaW5rICNuZXdCcm9rZXJ9IG1ldGhvZC4KICAgICAqLwog\nICAgcHJvdGVjdGVkIGFic3RyYWN0IFN0b3JlTWFuYWdlciBuZXdTdG9yZU1h\nbmFnZXIoKTsKCiAgICAvKioKICAgICAqIEZpbmQgYSBwb29sZWQgYnJva2Vy\nLCBvciByZXR1cm4gbnVsbCBpZiBub25lLiBJZiB1c2luZwogICAgICogbWFu\nYWdlZCB0cmFuc2FjdGlvbnMsIGxvb2tzIGZvciBhIHRyYW5zYWN0aW9uYWwg\nYnJva2VyOwogICAgICogb3RoZXJ3aXNlIHJldHVybnMgbnVsbCBieSBkZWZh\ndWx0LiBUaGlzIG1ldGhvZCB3aWxsIGJlIGNhbGxlZCBiZWZvcmUKICAgICAq\nIHtAbGluayAjbmV3U3RvcmVNYW5hZ2VyfSBzbyB0aGF0IGZhY3Rvcnkgc3Vi\nY2xhc3NlcyBpbXBsZW1lbnRpbmcKICAgICAqIHBvb2xpbmcgY2FuIHJldHVy\nbiBhIG1hdGNoaW5nIG1hbmFnZXIgYmVmb3JlIGEgbmV3IHtAbGluayBTdG9y\nZU1hbmFnZXJ9CiAgICAgKiBpcyBjcmVhdGVkLgogICAgICovCiAgICBwcm90\nZWN0ZWQgQnJva2VyIGZpbmRCcm9rZXIoU3RyaW5nIHVzZXIsIFN0cmluZyBw\nYXNzLCBib29sZWFuIG1hbmFnZWQpIHsKICAgICAgICBpZiAobWFuYWdlZCkK\nICAgICAgICAgICAgcmV0dXJuIGZpbmRUcmFuc2FjdGlvbmFsQnJva2VyKHVz\nZXIsIHBhc3MpOwogICAgICAgIHJldHVybiBudWxsOwogICAgfQoKICAgIC8q\nKgogICAgICogUmV0dXJuIGEgYnJva2VyIGNvbmZpZ3VyZWQgd2l0aCB0aGUg\ncHJvcGVyIHNldHRpbmdzLgogICAgICogQnkgZGVmYXVsdCwgdGhpcyBtZXRo\nb2QgY29uc3RydWN0cyBhIG5ldwogICAgICogQnJva2VySW1wbCBvZiB0aGUg\nY2xhc3Mgc2V0IGZvciB0aGlzIGZhY3RvcnkuCiAgICAgKi8KICAgIHByb3Rl\nY3RlZCBCcm9rZXJJbXBsIG5ld0Jyb2tlckltcGwoU3RyaW5nIHVzZXIsIFN0\ncmluZyBwYXNzKSB7CiAgICAgICAgQnJva2VySW1wbCBicm9rZXIgPSBfY29u\nZi5uZXdCcm9rZXJJbnN0YW5jZSh1c2VyLCBwYXNzKTsKICAgICAgICBpZiAo\nYnJva2VyID09IG51bGwpCiAgICAgICAgICAgIHRocm93IG5ldyBVc2VyRXhj\nZXB0aW9uKF9sb2MuZ2V0KCJuby1icm9rZXItY2xhc3MiLAogICAgICAgICAg\nICAgICAgX2NvbmYuZ2V0QnJva2VySW1wbCgpKSk7CgogICAgICAgIHJldHVy\nbiBicm9rZXI7CiAgICB9CgogICAgLyoqCiAgICAgKiBTZXR1cCB0cmFuc2ll\nbnQgc3RhdGUgdXNlZCBieSB0aGlzIGZhY3RvcnkgYmFzZWQgb24gdGhlCiAg\nICAgKiBjdXJyZW50IGNvbmZpZ3VyYXRpb24sIHdoaWNoIHdpbGwgc3Vic2Vx\ndWVudGx5IGJlIGxvY2tlZCBkb3duLiBUaGlzCiAgICAgKiBtZXRob2Qgd2ls\nbCBiZSBjYWxsZWQgYmVmb3JlIHRoZSBmaXJzdCBicm9rZXIgaXMgcmVxdWVz\ndGVkLAogICAgICogYW5kIHdpbGwgYmUgcmUtY2FsbGVkIGVhY2ggdGltZSB0\naGUgZmFjdG9yeSBpcyBkZXNlcmlhbGl6ZWQgaW50byBhIEpWTQogICAgICog\ndGhhdCBoYXMgbm8gY29uZmlndXJhdGlvbiBmb3IgdGhpcyBkYXRhIHN0b3Jl\nLgogICAgICovCiAgICBwcm90ZWN0ZWQgdm9pZCBzZXR1cCgpIHsKICAgIH0K\nCiAgICAvLy8vLy8vLy8vLy8vCiAgICAvLyBVdGlsaXRpZXMKICAgIC8vLy8v\nLy8vLy8vLy8KCiAgICAvKioKICAgICAqIEZpbmQgYSBtYW5hZ2VkIHJ1bnRp\nbWUgYnJva2VyIGFzc29jaWF0ZWQgd2l0aCB0aGUKICAgICAqIGN1cnJlbnQg\ndHJhbnNhY3Rpb24sIG9yIHJldHVybnMgbnVsbCBpZiBub25lLgogICAgICov\nCiAgICBwcm90ZWN0ZWQgQnJva2VyIGZpbmRUcmFuc2FjdGlvbmFsQnJva2Vy\nKFN0cmluZyB1c2VyLCBTdHJpbmcgcGFzcykgewogICAgICAgIFRyYW5zYWN0\naW9uIHRyYW5zOwogICAgICAgIE1hbmFnZWRSdW50aW1lIG1yID0gX2NvbmYu\nZ2V0TWFuYWdlZFJ1bnRpbWVJbnN0YW5jZSgpOwogICAgICAgIE9iamVjdCB0\neEtleTsKICAgICAgICB0cnkgewogICAgICAgICAgICB0cmFucyA9IG1yLmdl\ndFRyYW5zYWN0aW9uTWFuYWdlcigpLgogICAgICAgICAgICAgICAgZ2V0VHJh\nbnNhY3Rpb24oKTsKICAgICAgICAgICAgdHhLZXkgPSBtci5nZXRUcmFuc2Fj\ndGlvbktleSgpOwoKICAgICAgICAgICAgaWYgKHRyYW5zID09IG51bGwKICAg\nICAgICAgICAgICAgIHx8IHRyYW5zLmdldFN0YXR1cygpID09IFN0YXR1cy5T\nVEFUVVNfTk9fVFJBTlNBQ1RJT04KICAgICAgICAgICAgICAgIHx8IHRyYW5z\nLmdldFN0YXR1cygpID09IFN0YXR1cy5TVEFUVVNfVU5LTk9XTikKICAgICAg\nICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgIH0gY2F0Y2ggKE9wZW5K\nUEFFeGNlcHRpb24ga2UpIHsKICAgICAgICAgICAgdGhyb3cga2U7CiAgICAg\nICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgdGhyb3cg\nbmV3IEdlbmVyYWxFeGNlcHRpb24oZSk7CiAgICAgICAgfQoKICAgICAgICBD\nb2xsZWN0aW9uPEJyb2tlcj4gYnJva2VycyA9IF90cmFuc2FjdGlvbmFsLmdl\ndCh0eEtleSk7CiAgICAgICAgaWYgKGJyb2tlcnMgIT0gbnVsbCkgewogICAg\nICAgICAgICAvLyB3ZSBkb24ndCBuZWVkIHRvIHN5bmNocm9uaXplIG9uIGJy\nb2tlcnMgc2luY2Ugb25lIEpUQSB0cmFuc2FjdGlvbgogICAgICAgICAgICAv\nLyBjYW4gbmV2ZXIgYmUgYWN0aXZlIG9uIG11bHRpcGxlIGNvbmN1cnJlbnQg\ndGhyZWFkcy4KICAgICAgICAgICAgZm9yIChCcm9rZXIgYnJva2VyIDogYnJv\na2VycykgewogICAgICAgICAgICAgICAgaWYgKFN0cmluZ1V0aWxzLmVxdWFs\ncyhicm9rZXIuZ2V0Q29ubmVjdGlvblVzZXJOYW1lKCksIHVzZXIpIAogICAg\nICAgICAgICAgICAgICYmIFN0cmluZ1V0aWxzLmVxdWFscyhicm9rZXIuZ2V0\nQ29ubmVjdGlvblBhc3N3b3JkKCksIHBhc3MpKQogICAgICAgICAgICAgICAg\nICAgIHJldHVybiBicm9rZXI7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAg\nICAgICAgcmV0dXJuIG51bGw7CiAgICB9CgogICAgLyoqCiAgICAgKiBDb25m\naWd1cmVzIHRoZSBnaXZlbiBicm9rZXIgd2l0aCB0aGUgY3VycmVudCBmYWN0\nb3J5IG9wdGlvbiBzZXR0aW5ncy4KICAgICAqLwogICAgcHJvdGVjdGVkIHZv\naWQgY29uZmlndXJlQnJva2VyKEJyb2tlckltcGwgYnJva2VyKSB7CiAgICAg\nICAgYnJva2VyLnNldE9wdGltaXN0aWMoX2NvbmYuZ2V0T3B0aW1pc3RpYygp\nKTsKICAgICAgICBicm9rZXIuc2V0Tm9udHJhbnNhY3Rpb25hbFJlYWQoX2Nv\nbmYuZ2V0Tm9udHJhbnNhY3Rpb25hbFJlYWQoKSk7CiAgICAgICAgYnJva2Vy\nLnNldE5vbnRyYW5zYWN0aW9uYWxXcml0ZShfY29uZi5nZXROb250cmFuc2Fj\ndGlvbmFsV3JpdGUoKSk7CiAgICAgICAgYnJva2VyLnNldFJldGFpblN0YXRl\nKF9jb25mLmdldFJldGFpblN0YXRlKCkpOwogICAgICAgIGJyb2tlci5zZXRS\nZXN0b3JlU3RhdGUoX2NvbmYuZ2V0UmVzdG9yZVN0YXRlQ29uc3RhbnQoKSk7\nCiAgICAgICAgYnJva2VyLnNldEF1dG9DbGVhcihfY29uZi5nZXRBdXRvQ2xl\nYXJDb25zdGFudCgpKTsKICAgICAgICBicm9rZXIuc2V0SWdub3JlQ2hhbmdl\ncyhfY29uZi5nZXRJZ25vcmVDaGFuZ2VzKCkpOwogICAgICAgIGJyb2tlci5z\nZXRNdWx0aXRocmVhZGVkKF9jb25mLmdldE11bHRpdGhyZWFkZWQoKSk7CiAg\nICAgICAgYnJva2VyLnNldEF1dG9EZXRhY2goX2NvbmYuZ2V0QXV0b0RldGFj\naENvbnN0YW50KCkpOwogICAgICAgIGJyb2tlci5zZXREZXRhY2hTdGF0ZShf\nY29uZi5nZXREZXRhY2hTdGF0ZUluc3RhbmNlKCkuZ2V0RGV0YWNoU3RhdGUo\nKSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBGcmVlemVzIHRoZSBjb25maWd1\ncmF0aW9uIG9mIHRoaXMgZmFjdG9yeS4KICAgICAqLwogICAgcHVibGljIHZv\naWQgbWFrZVJlYWRPbmx5KCkgewogICAgICAgIGlmIChfcmVhZE9ubHkpCiAg\nICAgICAgICAgIHJldHVybjsKCiAgICAgICAgbG9jaygpOwogICAgICAgIHRy\neSB7CiAgICAgICAgICAgIC8vIGNoZWNrIGFnYWluCiAgICAgICAgICAgIGlm\nIChfcmVhZE9ubHkpCiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAg\nICAgIF9yZWFkT25seSA9IHRydWU7CgogICAgICAgICAgICBMb2cgbG9nID0g\nX2NvbmYuZ2V0TG9nKE9wZW5KUEFDb25maWd1cmF0aW9uLkxPR19SVU5USU1F\nKTsKICAgICAgICAgICAgaWYgKGxvZy5pc0luZm9FbmFibGVkKCkpCiAgICAg\nICAgICAgICAgICBsb2cuaW5mbyhnZXRGYWN0b3J5SW5pdGlhbGl6YXRpb25C\nYW5uZXIoKSk7CiAgICAgICAgICAgIGlmIChsb2cuaXNUcmFjZUVuYWJsZWQo\nKSkgewogICAgICAgICAgICAgICAgTWFwPFN0cmluZyxPYmplY3Q+IHByb3Bz\nID0gX2NvbmYudG9Qcm9wZXJ0aWVzKHRydWUpOwogICAgICAgICAgICAgICAg\nU3RyaW5nIGxpbmVTZXAgPSBKMkRvUHJpdkhlbHBlci5nZXRMaW5lU2VwYXJh\ndG9yKCk7CiAgICAgICAgICAgICAgICBTdHJpbmdCdWlsZGVyIGJ1ZiA9IG5l\ndyBTdHJpbmdCdWlsZGVyKCk7CiAgICAgICAgICAgICAgICBNYXAuRW50cnk8\nPyw/PiBlbnRyeTsKICAgICAgICAgICAgICAgIGZvciAoSXRlcmF0b3I8TWFw\nLkVudHJ5PFN0cmluZyxPYmplY3Q+PiBpdHIgPSBwcm9wcy5lbnRyeVNldCgp\nLml0ZXJhdG9yKCk7IGl0ci5oYXNOZXh0KCk7KSB7CiAgICAgICAgICAgICAg\nICAgICAgZW50cnkgPSBpdHIubmV4dCgpOwogICAgICAgICAgICAgICAgICAg\nIGJ1Zi5hcHBlbmQoZW50cnkuZ2V0S2V5KCkpLmFwcGVuZCgiOiAiKS5hcHBl\nbmQoZW50cnkuZ2V0VmFsdWUoKSk7CiAgICAgICAgICAgICAgICAgICAgaWYg\nKGl0ci5oYXNOZXh0KCkpCiAgICAgICAgICAgICAgICAgICAgICAgIGJ1Zi5h\ncHBlbmQobGluZVNlcCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAg\nICAgICBsb2cudHJhY2UoX2xvYy5nZXQoImZhY3RvcnktcHJvcGVydGllcyIs\nIGJ1Zi50b1N0cmluZygpKSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAg\nIC8vIHNldHVwIHRyYW5zaWVudCBzdGF0ZQogICAgICAgICAgICBzZXR1cCgp\nOwoKICAgICAgICAgICAgLy8gcmVnaXN0ZXIgdGhlIG1ldGRhdGEgcmVwb3Np\ndG9yeSB0byBhdXRvLWxvYWQgcGVyc2lzdGVudCB0eXBlcwogICAgICAgICAg\nICAvLyBhbmQgbWFrZSBzdXJlIHR5cGVzIGFyZSBlbmhhbmNlZAogICAgICAg\nICAgICBNZXRhRGF0YVJlcG9zaXRvcnkgcmVwb3MgPSBfY29uZi5nZXRNZXRh\nRGF0YVJlcG9zaXRvcnlJbnN0YW5jZSgpOwogICAgICAgICAgICByZXBvcy5z\nZXRWYWxpZGF0ZShNZXRhRGF0YVJlcG9zaXRvcnkuVkFMSURBVEVfUlVOVElN\nRSwgdHJ1ZSk7CiAgICAgICAgICAgIHJlcG9zLnNldFJlc29sdmUoTWV0YURh\ndGFNb2Rlcy5NT0RFX01BUFBJTkdfSU5JVCwgdHJ1ZSk7CiAgICAgICAgICAg\nIFBDUmVnaXN0cnkuYWRkUmVnaXN0ZXJDbGFzc0xpc3RlbmVyKHJlcG9zKTsK\nCiAgICAgICAgICAgIC8vIGZyZWV6ZSB1bmRlcmx5aW5nIGNvbmZpZ3VyYXRp\nb24gYW5kIGVhZ2VybHkgaW5pdGlhbGl6ZSB0bwogICAgICAgICAgICAvLyBh\ndm9pZCBzeW5jaHJvbml6YXRpb24KICAgICAgICAgICAgX2NvbmYuc2V0UmVh\nZE9ubHkoQ29uZmlndXJhdGlvbi5JTklUX1NUQVRFX0ZSRUVaSU5HKTsKICAg\nICAgICAgICAgX2NvbmYuaW5zdGFudGlhdGVBbGwoKTsKICAgICAgICAgICAg\naWYgKF9jb25mLmlzSW5pdGlhbGl6ZUVhZ2VybHkoKSkKICAgICAgICAgICAg\nCV9jb25mLnNldFJlYWRPbmx5KENvbmZpZ3VyYXRpb24uSU5JVF9TVEFURV9G\nUk9aRU4pOwogICAgICAgICAgICAvLyBmaXJlIGFuIGV2ZW50IGZvciBhbGwg\ndGhlIGJyb2tlciBmYWN0b3J5IGxpc3RlbmVycwogICAgICAgICAgICAvLyBy\nZWdpc3RlcmVkIG9uIHRoZSBjb25maWd1cmF0aW9uLgogICAgICAgICAgICBf\nY29uZi5nZXRCcm9rZXJGYWN0b3J5RXZlbnRNYW5hZ2VyKCkuZmlyZUV2ZW50\nKAogICAgICAgICAgICAgICAgbmV3IEJyb2tlckZhY3RvcnlFdmVudCh0aGlz\nLAogICAgICAgICAgICAgICAgICAgIEJyb2tlckZhY3RvcnlFdmVudC5CUk9L\nRVJfRkFDVE9SWV9DUkVBVEVEKSk7CiAgICAgICAgfSBmaW5hbGx5IHsKICAg\nICAgICAgICAgdW5sb2NrKCk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgog\nICAgICogUmV0dXJuIGFuIG9iamVjdCB0byBiZSB3cml0dGVuIHRvIHRoZSBs\nb2cgd2hlbiB0aGlzIGJyb2tlciBmYWN0b3J5CiAgICAgKiBpbml0aWFsaXpl\ncy4gVGhpcyBoYXBwZW5zIGFmdGVyIHRoZSBjb25maWd1cmF0aW9uIGlzIGZ1\nbGx5IGxvYWRlZC4KICAgICAqLwogICAgcHJvdGVjdGVkIE9iamVjdCBnZXRG\nYWN0b3J5SW5pdGlhbGl6YXRpb25CYW5uZXIoKSB7CiAgICAgICAgcmV0dXJu\nIF9sb2MuZ2V0KCJmYWN0b3J5LWluaXQiLCBPcGVuSlBBVmVyc2lvbi5WRVJT\nSU9OX05VTUJFUik7CiAgICB9CgogICAgLyoqCiAgICAgKiBUaHJvdyBhbiBl\neGNlcHRpb24gaWYgdGhlIGZhY3RvcnkgaXMgY2xvc2VkLiAgVGhlIGV4YWN0\nIG1lc3NhZ2UgYW5kCiAgICAgKiBjb250ZW50IG9mIHRoZSBleGNlcHRpb24g\ndmFyaWVzIHdoZXRoZXIgVFJBQ0UgaXMgZW5hYmxlZCBvciBub3QuCiAgICAg\nKi8KICAgIHB1YmxpYyB2b2lkIGFzc2VydE9wZW4oKSB7CiAgICAgICAgaWYg\nKF9jbG9zZWQpIHsKICAgICAgICAgICAgaWYgKF9jbG9zZWRFeGNlcHRpb24g\nPT0gbnVsbCkgIC8vIFRSQUNFIG5vdCBlbmFibGVkCiAgICAgICAgICAgICAg\nICB0aHJvdyBuZXcgSW52YWxpZFN0YXRlRXhjZXB0aW9uKF9sb2MKICAgICAg\nICAgICAgICAgICAgICAgICAgLmdldCgiY2xvc2VkLWZhY3Rvcnktbm90cmFj\nZSIpKTsKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgdGhyb3cg\nbmV3IEludmFsaWRTdGF0ZUV4Y2VwdGlvbihfbG9jLmdldCgiY2xvc2VkLWZh\nY3RvcnkiKSkKICAgICAgICAgICAgICAgICAgICAgICAgLnNldENhdXNlKF9j\nbG9zZWRFeGNlcHRpb24pOwogICAgICAgIH0KICAgIH0KCiAgICAvLy8vLy8v\nLy8vLy8vLy8vLy8vLwogICAgLy8gQnJva2VyIHV0aWxpdGllcwogICAgLy8v\nLy8vLy8vLy8vLy8vLy8vLy8KCiAgICAvKioKICAgICAqIFRocm93cyBhIHtA\nbGluayBVc2VyRXhjZXB0aW9ufSBpZiBhIHRyYW5zYWN0aW9uIGlzIGFjdGl2\nZS4gVGhlIHRocm93bgogICAgICogZXhjZXB0aW9uIHdpbGwgY29udGFpbiBh\nbGwgdGhlIEJyb2tlcnMgd2l0aCBhY3RpdmUgdHJhbnNhY3Rpb25zIGFzCiAg\nICAgKiBmYWlsZWQgb2JqZWN0cyBpbiB0aGUgbmVzdGVkIGV4Y2VwdGlvbnMu\nCiAgICAgKi8KICAgIHByaXZhdGUgdm9pZCBhc3NlcnROb0FjdGl2ZVRyYW5z\nYWN0aW9uKCkgewogICAgICAgIENvbGxlY3Rpb248VGhyb3dhYmxlPiBleGNz\nOwogICAgICAgIGlmIChfdHJhbnNhY3Rpb25hbC5pc0VtcHR5KCkpCiAgICAg\nICAgICAgIHJldHVybjsKCiAgICAgICAgZXhjcyA9IG5ldyBBcnJheUxpc3Q8\nVGhyb3dhYmxlPihfdHJhbnNhY3Rpb25hbC5zaXplKCkpOwogICAgICAgIGZv\nciAoQ29sbGVjdGlvbjxCcm9rZXI+IGJyb2tlcnMgOiBfdHJhbnNhY3Rpb25h\nbC52YWx1ZXMoKSkgewogICAgICAgICAgICBmb3IgKEJyb2tlciBicm9rZXIg\nOiBicm9rZXJzKSB7CiAgICAgICAgICAgICAgICBleGNzLmFkZChuZXcgSW52\nYWxpZFN0YXRlRXhjZXB0aW9uKF9sb2MuZ2V0KCJhY3RpdmUiKSkuc2V0RmFp\nbGVkT2JqZWN0KGJyb2tlcikpOwogICAgICAgICAgICB9CiAgICAgICAgfQoK\nICAgICAgICBpZiAoIWV4Y3MuaXNFbXB0eSgpKQogICAgICAgICAgICB0aHJv\ndyBuZXcgSW52YWxpZFN0YXRlRXhjZXB0aW9uKF9sb2MuZ2V0KCJuZXN0ZWQt\nZXhjZXBzIikpLgogICAgICAgICAgICAgICAgc2V0TmVzdGVkVGhyb3dhYmxl\ncygoVGhyb3dhYmxlW10pIGV4Y3MudG9BcnJheShuZXcgVGhyb3dhYmxlW2V4\nY3Muc2l6ZSgpXSkpOwogICAgfQoKICAgIC8qKgogICAgICogU3luY2hyb25p\nemUgdGhlIGdpdmVuIGJyb2tlciB3aXRoIGEgbWFuYWdlZCB0cmFuc2FjdGlv\nbiwKICAgICAqIG9wdGlvbmFsbHkgc3RhcnRpbmcgb25lIGlmIG5vbmUgaXMg\naW4gcHJvZ3Jlc3MuCiAgICAgKgogICAgICogQHJldHVybiB0cnVlIGlmIHN5\nbmNoZWQgd2l0aCB0cmFuc2FjdGlvbiwgZmFsc2Ugb3RoZXJ3aXNlCiAgICAg\nKi8KICAgIGJvb2xlYW4gc3luY1dpdGhNYW5hZ2VkVHJhbnNhY3Rpb24oQnJv\na2VySW1wbCBicm9rZXIsIGJvb2xlYW4gYmVnaW4pIHsKICAgICAgICBUcmFu\nc2FjdGlvbiB0cmFuczsKICAgICAgICB0cnkgewogICAgICAgICAgICBNYW5h\nZ2VkUnVudGltZSBtciA9IGJyb2tlci5nZXRNYW5hZ2VkUnVudGltZSgpOwog\nICAgICAgICAgICBUcmFuc2FjdGlvbk1hbmFnZXIgdG0gPSBtci5nZXRUcmFu\nc2FjdGlvbk1hbmFnZXIoKTsKICAgICAgICAgICAgdHJhbnMgPSB0bS5nZXRU\ncmFuc2FjdGlvbigpOwogICAgICAgICAgICBpZiAodHJhbnMgIT0gbnVsbAog\nICAgICAgICAgICAgICAgJiYgKHRyYW5zLmdldFN0YXR1cygpID09IFN0YXR1\ncy5TVEFUVVNfTk9fVFJBTlNBQ1RJT04KICAgICAgICAgICAgICAgIHx8IHRy\nYW5zLmdldFN0YXR1cygpID09IFN0YXR1cy5TVEFUVVNfVU5LTk9XTikpCiAg\nICAgICAgICAgICAgICB0cmFucyA9IG51bGw7CgogICAgICAgICAgICBpZiAo\ndHJhbnMgPT0gbnVsbCAmJiBiZWdpbikgewogICAgICAgICAgICAgICAgdG0u\nYmVnaW4oKTsKICAgICAgICAgICAgICAgIHRyYW5zID0gdG0uZ2V0VHJhbnNh\nY3Rpb24oKTsKICAgICAgICAgICAgfSBlbHNlIGlmICh0cmFucyA9PSBudWxs\nKQogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoKICAgICAgICAgICAg\nLy8gc3luY2ggYnJva2VyIGFuZCB0cmFucwogICAgICAgICAgICB0cmFucy5y\nZWdpc3RlclN5bmNocm9uaXphdGlvbihicm9rZXIpOwoKICAgICAgICAgICAg\nLy8gd2UgZG9uJ3QgbmVlZCB0byBzeW5jaHJvbml6ZSBvbiBicm9rZXJzIG9y\nIGd1YXJkIGFnYWluc3QgbXVsdGlwbGUKICAgICAgICAgICAgLy8gdGhyZWFk\ncyB1c2luZyB0aGUgc2FtZSB0cmFucyBzaW5jZSBvbmUgSlRBIHRyYW5zYWN0\naW9uIGNhbiBuZXZlcgogICAgICAgICAgICAvLyBiZSBhY3RpdmUgb24gbXVs\ndGlwbGUgY29uY3VycmVudCB0aHJlYWRzLgogICAgICAgICAgICBPYmplY3Qg\ndHhLZXkgPSBtci5nZXRUcmFuc2FjdGlvbktleSgpOwogICAgICAgICAgICBD\nb2xsZWN0aW9uPEJyb2tlcj4gYnJva2VycyA9IF90cmFuc2FjdGlvbmFsLmdl\ndCh0eEtleSk7CiAgICAgICAgICAgIAogICAgICAgICAgICBpZiAoYnJva2Vy\ncyA9PSBudWxsKSB7CiAgICAgICAgICAgICAgICBicm9rZXJzID0gbmV3IEFy\ncmF5TGlzdDxCcm9rZXI+KDIpOwogICAgICAgICAgICAgICAgX3RyYW5zYWN0\naW9uYWwucHV0KHR4S2V5LCBicm9rZXJzKTsKICAgICAgICAgICAgICAgIHRy\nYW5zLnJlZ2lzdGVyU3luY2hyb25pemF0aW9uKG5ldyBSZW1vdmVUcmFuc2Fj\ndGlvblN5bmModHhLZXkpKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBi\ncm9rZXJzLmFkZChicm9rZXIpOwogICAgICAgICAgICAKICAgICAgICAgICAg\ncmV0dXJuIHRydWU7CiAgICAgICAgfSBjYXRjaCAoT3BlbkpQQUV4Y2VwdGlv\nbiBrZSkgewogICAgICAgICAgICB0aHJvdyBrZTsKICAgICAgICB9IGNhdGNo\nIChFeGNlcHRpb24gZSkgewogICAgICAgICAgICB0aHJvdyBuZXcgR2VuZXJh\nbEV4Y2VwdGlvbihlKTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAg\nKiBSZXR1cm5zIGEgc2V0IG9mIGFsbCB0aGUgb3BlbiBicm9rZXJzIGFzc29j\naWF0ZWQgd2l0aCB0aGlzIGZhY3RvcnkuIFRoZQogICAgICogcmV0dXJuZWQg\nc2V0IGlzIHVubW9kaWZpYWJsZSwgYW5kIG1heSBjb250YWluIG51bGwgcmVm\nZXJlbmNlcy4KICAgICAqLwogICAgcHVibGljIENvbGxlY3Rpb248QnJva2Vy\nPiBnZXRPcGVuQnJva2VycygpIHsKICAgICAgICByZXR1cm4gQ29sbGVjdGlv\nbnMudW5tb2RpZmlhYmxlQ29sbGVjdGlvbihfYnJva2Vycyk7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBSZWxlYXNlIDxjb2RlPmJyb2tlcjwvY29kZT4gZnJv\nbSBhbnkgaW50ZXJuYWwgZGF0YSBzdHJ1Y3R1cmVzLiBUaGlzCiAgICAgKiBp\ncyBpbnZva2VkIGJ5IDxjb2RlPmJyb2tlcjwvY29kZT4gYWZ0ZXIgdGhlIGJy\nb2tlciBpcyBmdWxseSBjbG9zZWQuCiAgICAgKgogICAgICogQHNpbmNlIDEu\nMS4wCiAgICAgKi8KICAgIHByb3RlY3RlZCB2b2lkIHJlbGVhc2VCcm9rZXIo\nQnJva2VySW1wbCBicm9rZXIpIHsKICAgICAgICBfYnJva2Vycy5yZW1vdmUo\nYnJva2VyKTsKICAgIH0KCiAgICAvKioKICAgICAqIEByZXR1cm4gYSBrZXkg\ndGhhdCBjYW4gYmUgdXNlZCB0byBvYnRhaW4gdGhpcyBicm9rZXIgZmFjdG9y\neSBmcm9tIHRoZQogICAgICogcG9vbCBhdCBhIGxhdGVyIHRpbWUuCiAgICAg\nKgogICAgICogQHNpbmNlIDEuMS4wCiAgICAgKi8KICAgIHB1YmxpYyBPYmpl\nY3QgZ2V0UG9vbEtleSgpIHsKICAgICAgICByZXR1cm4gX3Bvb2xLZXk7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBTZXQgYSBrZXkgdGhhdCBjYW4gYmUgdXNl\nZCB0byBvYnRhaW4gdGhpcyBicm9rZXIgZmFjdG9yeSBmcm9tIHRoZQogICAg\nICogcG9vbCBhdCBhIGxhdGVyIHRpbWUuCiAgICAgKgogICAgICogQHNpbmNl\nIDEuMS4wCiAgICAgKi8KICAgIHZvaWQgc2V0UG9vbEtleShPYmplY3Qga2V5\nKSB7CiAgICAgICAgX3Bvb2xLZXkgPSBrZXk7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBTaW1wbGUgc3luY2hyb25pemF0aW9uIGxpc3RlbmVyIHRvIHJlbW92\nZSBjb21wbGV0ZWQgdHJhbnNhY3Rpb25zCiAgICAgKiBmcm9tIG91ciBjYWNo\nZS4KICAgICAqLwogICAgcHJpdmF0ZSBjbGFzcyBSZW1vdmVUcmFuc2FjdGlv\nblN5bmMKICAgICAgICBpbXBsZW1lbnRzIFN5bmNocm9uaXphdGlvbiB7Cgog\nICAgICAgIHByaXZhdGUgZmluYWwgT2JqZWN0IF90cmFuczsKCiAgICAgICAg\ncHVibGljIFJlbW92ZVRyYW5zYWN0aW9uU3luYyhPYmplY3QgdHJhbnMpIHsK\nICAgICAgICAgICAgX3RyYW5zID0gdHJhbnM7CiAgICAgICAgfQoKICAgICAg\nICBwdWJsaWMgdm9pZCBiZWZvcmVDb21wbGV0aW9uKCkgewogICAgICAgIH0K\nCiAgICAgICAgcHVibGljIHZvaWQgYWZ0ZXJDb21wbGV0aW9uKGludCBzdGF0\ndXMpIHsKICAgICAgICAgICAgX3RyYW5zYWN0aW9uYWwucmVtb3ZlIChfdHJh\nbnMpOwoJCX0KCX0KICAgIAogICAgLyoqCiAgICAgKiBNZXRob2QgaW5zdXJl\ncyB0aGF0IGRlc2VyaWFsaXplZCBFTUYgaGFzIHRoaXMgcmVmZXJlbmNlIHJl\nLWluc3RhbnRpYXRlZAogICAgICovCiAgICBwcml2YXRlIENvbGxlY3Rpb248\nQ2xhc3NMb2FkZXI+IGdldFBjQ2xhc3NMb2FkZXJzKCkgewogICAgICAgaWYg\nKF9wY0NsYXNzTG9hZGVycyA9PSBudWxsKQogICAgICAgICBfcGNDbGFzc0xv\nYWRlcnMgPSBuZXcgQ29uY3VycmVudFJlZmVyZW5jZUhhc2hTZXQ8Q2xhc3NM\nb2FkZXI+KENvbmN1cnJlbnRSZWZlcmVuY2VIYXNoU2V0LldFQUspOwogICAg\nICAgICAgCiAgICAgICByZXR1cm4gX3BjQ2xhc3NMb2FkZXJzOwogICAgfQoK\nICAgIC8qKgogICAgICogPFA+CiAgICAgKiBDcmVhdGUgYSBEZWxlZ2F0aW5n\nU3RvcmVNYW5hZ2VyIGZvciB1c2Ugd2l0aCBhIEJyb2tlciBjcmVhdGVkIGJ5\nIHRoaXMgZmFjdG9yeS4KICAgICAqIElmIGEgRGF0YUNhY2hlIGhhcyBiZWVu\nIGVuYWJsZWQgYSBEYXRhQ2FjaGVTdG9yZU1hbmFnZXIgd2lsbCBiZSByZXR1\ncm5lZC4KICAgICAqIDwvUD4KICAgICAqIDxQPgogICAgICogSWYgbm8gRGF0\nYUNhY2hlIGlzIGluIHVzZSBhbiBST1BTdG9yZU1hbmFnZXIgd2lsbCBiZSBy\nZXR1cm5lZC4gCiAgICAgKiA8L1A+CiAgICAgKiAKICAgICAqIEByZXR1cm4g\nQSBkZWxlZ2F0aW5nIHN0b3JlIG1hbmFnZXIgc3VpdGFibGUgZm9yIHRoZSBj\ndXJyZW50CiAgICAgKiAgICAgICAgIGNvbmZpZ3VyYXRpb24uCiAgICAgKi8K\nICAgIHByb3RlY3RlZCBEZWxlZ2F0aW5nU3RvcmVNYW5hZ2VyIGNyZWF0ZURl\nbGVnYXRpbmdTdG9yZU1hbmFnZXIoKSB7IAogICAgICAgIC8vIGRlY29yYXRl\nIHRoZSBzdG9yZSBtYW5hZ2VyIGZvciBkYXRhIGNhY2hpbmcgYW5kIGN1c3Rv\nbQogICAgICAgIC8vIHJlc3VsdCBvYmplY3QgcHJvdmlkZXJzOyBhbHdheXMg\nbWFrZSBzdXJlIGl0J3MgYSBkZWxlZ2F0aW5nCiAgICAgICAgLy8gc3RvcmUg\nbWFuYWdlciwgYmVjYXVzZSBpdCdzIGVhc2llciBmb3IgdXNlcnMgdG8gZGVh\nbCB3aXRoCiAgICAgICAgLy8gdGhhdCB3YXkKICAgICAgICBTdG9yZU1hbmFn\nZXIgc20gPSBuZXdTdG9yZU1hbmFnZXIoKTsKICAgICAgICBEZWxlZ2F0aW5n\nU3RvcmVNYW5hZ2VyIGRzbSA9IG51bGw7CiAgICAgICAgaWYgKF9jb25mLmdl\ndERhdGFDYWNoZU1hbmFnZXJJbnN0YW5jZSgpLmdldFN5c3RlbURhdGFDYWNo\nZSgpICE9IG51bGwpIHsKICAgICAgICAgICAgZHNtID0gbmV3IERhdGFDYWNo\nZVN0b3JlTWFuYWdlcihzbSk7CiAgICAgICAgfQogICAgICAgIGRzbSA9IG5l\ndyBST1BTdG9yZU1hbmFnZXIoKGRzbSA9PSBudWxsKSA/IHNtIDogZHNtKTsK\nICAgICAgICAKICAgICAgICByZXR1cm4gZHNtOwogICAgfQp9Cgo=\n","encoding":"base64"}

