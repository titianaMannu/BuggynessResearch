{"sha":"cef48dfea947efaac65847c2c3261db77b418661","node_id":"MDQ6QmxvYjIwNjM2NDpjZWY0OGRmZWE5NDdlZmFhYzY1ODQ3YzJjMzI2MWRiNzdiNDE4NjYx","size":82904,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/cef48dfea947efaac65847c2c3261db77b418661","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEubGliLmpkYmM7CgppbXBvcnQg\namF2YS5pby5JbnB1dFN0cmVhbTsKaW1wb3J0IGphdmEuaW8uUmVhZGVyOwpp\nbXBvcnQgamF2YS5sYW5nLnJlZmxlY3QuQ29uc3RydWN0b3I7CmltcG9ydCBq\nYXZhLm1hdGguQmlnRGVjaW1hbDsKaW1wb3J0IGphdmEuc3FsLkFycmF5Owpp\nbXBvcnQgamF2YS5zcWwuQmF0Y2hVcGRhdGVFeGNlcHRpb247CmltcG9ydCBq\nYXZhLnNxbC5CbG9iOwppbXBvcnQgamF2YS5zcWwuQ2FsbGFibGVTdGF0ZW1l\nbnQ7CmltcG9ydCBqYXZhLnNxbC5DbG9iOwppbXBvcnQgamF2YS5zcWwuQ29u\nbmVjdGlvbjsKaW1wb3J0IGphdmEuc3FsLkRhdGFiYXNlTWV0YURhdGE7Cmlt\ncG9ydCBqYXZhLnNxbC5EYXRlOwppbXBvcnQgamF2YS5zcWwuUHJlcGFyZWRT\ndGF0ZW1lbnQ7CmltcG9ydCBqYXZhLnNxbC5SZWY7CmltcG9ydCBqYXZhLnNx\nbC5SZXN1bHRTZXQ7CmltcG9ydCBqYXZhLnNxbC5SZXN1bHRTZXRNZXRhRGF0\nYTsKaW1wb3J0IGphdmEuc3FsLlNRTEV4Y2VwdGlvbjsKaW1wb3J0IGphdmEu\nc3FsLlNRTFdhcm5pbmc7CmltcG9ydCBqYXZhLnNxbC5TYXZlcG9pbnQ7Cmlt\ncG9ydCBqYXZhLnNxbC5TdGF0ZW1lbnQ7CmltcG9ydCBqYXZhLnNxbC5UaW1l\nOwppbXBvcnQgamF2YS5zcWwuVGltZXN0YW1wOwppbXBvcnQgamF2YS51dGls\nLkFycmF5TGlzdDsKaW1wb3J0IGphdmEudXRpbC5BcnJheXM7CmltcG9ydCBq\nYXZhLnV0aWwuQ2FsZW5kYXI7CmltcG9ydCBqYXZhLnV0aWwuSXRlcmF0b3I7\nCmltcG9ydCBqYXZhLnV0aWwuTGlzdDsKCmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEubGliLmpkYmMuTG9nZ2luZ0Nvbm5lY3Rpb25EZWNvcmF0b3IuTG9n\nZ2luZ0Nvbm5lY3Rpb24uCiAgICAgICAgTG9nZ2luZ0NhbGxhYmxlU3RhdGVt\nZW50OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi5qZGJjLkxvZ2dp\nbmdDb25uZWN0aW9uRGVjb3JhdG9yLkxvZ2dpbmdDb25uZWN0aW9uLgogICAg\nICAgIExvZ2dpbmdEYXRhYmFzZU1ldGFEYXRhOwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLmxpYi5qZGJjLkxvZ2dpbmdDb25uZWN0aW9uRGVjb3JhdG9y\nLkxvZ2dpbmdDb25uZWN0aW9uLgogICAgICAgIExvZ2dpbmdQcmVwYXJlZFN0\nYXRlbWVudDsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIuamRiYy5M\nb2dnaW5nQ29ubmVjdGlvbkRlY29yYXRvci5Mb2dnaW5nQ29ubmVjdGlvbi4K\nICAgICAgICBMb2dnaW5nUmVzdWx0U2V0OwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLmxpYi5qZGJjLkxvZ2dpbmdDb25uZWN0aW9uRGVjb3JhdG9yLkxv\nZ2dpbmdDb25uZWN0aW9uLgogICAgICAgIExvZ2dpbmdTdGF0ZW1lbnQ7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLmxvZy5Mb2c7CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuQ29uY3JldGVDbGFzc0dlbmVy\nYXRvcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIudXRpbC5KMkRv\nUHJpdkhlbHBlcjsKCi8qKgogKiBBIHtAbGluayBDb25uZWN0aW9uRGVjb3Jh\ndG9yfSB0aGF0IGNyZWF0ZXMgbG9nZ2luZyBjb25uZWN0aW9ucyBhbmQKICog\ne0BsaW5rIFJlcG9ydGluZ1NRTEV4Y2VwdGlvbn1zLgogKgogKiBAYXV0aG9y\nIE1hcmMgUHJ1ZCdob21tZWF1eAogKiBAbm9qYXZhZG9jCiAqLwpwdWJsaWMg\nY2xhc3MgTG9nZ2luZ0Nvbm5lY3Rpb25EZWNvcmF0b3IgaW1wbGVtZW50cyBD\nb25uZWN0aW9uRGVjb3JhdG9yIHsKCiAgICBwcml2YXRlIHN0YXRpYyBmaW5h\nbCBTdHJpbmcgU0VQID0gSjJEb1ByaXZIZWxwZXIuZ2V0TGluZVNlcGFyYXRv\ncigpOwogICAgc3RhdGljIGZpbmFsIENvbnN0cnVjdG9yPExvZ2dpbmdDb25u\nZWN0aW9uPiBsb2dnaW5nQ29ubmVjdGlvbkltcGw7CiAgICBzdGF0aWMgZmlu\nYWwgQ29uc3RydWN0b3I8TG9nZ2luZ1Jlc3VsdFNldD4gbG9nZ2luZ1Jlc3Vs\ndFNldEltcGw7CiAgICBzdGF0aWMgZmluYWwgQ29uc3RydWN0b3I8TG9nZ2lu\nZ1N0YXRlbWVudD4gbG9nZ2luZ1N0YXRlbWVudEltcGw7CiAgICBzdGF0aWMg\nZmluYWwgQ29uc3RydWN0b3I8TG9nZ2luZ1ByZXBhcmVkU3RhdGVtZW50PiBs\nb2dnaW5nUHJlcGFyZWRTdGF0ZW1lbnRJbXBsOwogICAgc3RhdGljIGZpbmFs\nIENvbnN0cnVjdG9yPExvZ2dpbmdDYWxsYWJsZVN0YXRlbWVudD4gbG9nZ2lu\nZ0NhbGxhYmxlU3RhdGVtZW50SW1wbDsKICAgIHN0YXRpYyBmaW5hbCBDb25z\ndHJ1Y3RvcjxMb2dnaW5nRGF0YWJhc2VNZXRhRGF0YT4gbG9nZ2luZ0RhdGFi\nYXNlTWV0YURhdGFJbXBsOwoKICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIGlu\ndCBXQVJOX0lHTk9SRSA9IDA7CiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBp\nbnQgV0FSTl9MT0dfVFJBQ0UgPSAxOwogICAgcHJpdmF0ZSBzdGF0aWMgZmlu\nYWwgaW50IFdBUk5fTE9HX0lORk8gPSAyOwogICAgcHJpdmF0ZSBzdGF0aWMg\nZmluYWwgaW50IFdBUk5fTE9HX1dBUk4gPSAzOwogICAgcHJpdmF0ZSBzdGF0\naWMgZmluYWwgaW50IFdBUk5fTE9HX0VSUk9SID0gNDsKICAgIHByaXZhdGUg\nc3RhdGljIGZpbmFsIGludCBXQVJOX1RIUk9XID0gNTsKICAgIHByaXZhdGUg\nc3RhdGljIGZpbmFsIGludCBXQVJOX0hBTkRMRSA9IDY7CiAgICBwcml2YXRl\nIHN0YXRpYyBmaW5hbCBTdHJpbmdbXSBXQVJOSU5HX0FDVElPTlMgPSBuZXcg\nU3RyaW5nWzddOwogICAgCiAgICBzdGF0aWMgewogICAgICAgIFdBUk5JTkdf\nQUNUSU9OU1tXQVJOX0lHTk9SRV0gPSAiaWdub3JlIjsKICAgICAgICBXQVJO\nSU5HX0FDVElPTlNbV0FSTl9MT0dfVFJBQ0VdID0gInRyYWNlIjsKICAgICAg\nICBXQVJOSU5HX0FDVElPTlNbV0FSTl9MT0dfSU5GT10gPSAiaW5mbyI7CiAg\nICAgICAgV0FSTklOR19BQ1RJT05TW1dBUk5fTE9HX1dBUk5dID0gIndhcm4i\nOwogICAgICAgIFdBUk5JTkdfQUNUSU9OU1tXQVJOX0xPR19FUlJPUl0gPSAi\nZXJyb3IiOwogICAgICAgIFdBUk5JTkdfQUNUSU9OU1tXQVJOX1RIUk9XXSA9\nICJ0aHJvdyI7CiAgICAgICAgV0FSTklOR19BQ1RJT05TW1dBUk5fSEFORExF\nXSA9ICJoYW5kbGUiOwoKICAgICAgICB0cnkgewogICAgICAgICAgICBsb2dn\naW5nQ29ubmVjdGlvbkltcGwgPSBDb25jcmV0ZUNsYXNzR2VuZXJhdG9yLmdl\ndENvbmNyZXRlQ29uc3RydWN0b3IoTG9nZ2luZ0Nvbm5lY3Rpb24uY2xhc3Ms\nCiAgICAgICAgICAgICAgICBMb2dnaW5nQ29ubmVjdGlvbkRlY29yYXRvci5j\nbGFzcywgQ29ubmVjdGlvbi5jbGFzcyk7CiAgICAgICAgICAgIGxvZ2dpbmdS\nZXN1bHRTZXRJbXBsID0gQ29uY3JldGVDbGFzc0dlbmVyYXRvci5nZXRDb25j\ncmV0ZUNvbnN0cnVjdG9yKAogICAgICAgICAgICAgICAgTG9nZ2luZ0Nvbm5l\nY3Rpb24uTG9nZ2luZ1Jlc3VsdFNldC5jbGFzcywgCiAgICAgICAgICAgICAg\nICBMb2dnaW5nQ29ubmVjdGlvbi5jbGFzcywgUmVzdWx0U2V0LmNsYXNzLCBT\ndGF0ZW1lbnQuY2xhc3MpOwogICAgICAgICAgICBsb2dnaW5nU3RhdGVtZW50\nSW1wbCA9IENvbmNyZXRlQ2xhc3NHZW5lcmF0b3IuZ2V0Q29uY3JldGVDb25z\ndHJ1Y3RvcigKICAgICAgICAgICAgICAgIExvZ2dpbmdDb25uZWN0aW9uLkxv\nZ2dpbmdTdGF0ZW1lbnQuY2xhc3MsCiAgICAgICAgICAgICAgICBMb2dnaW5n\nQ29ubmVjdGlvbi5jbGFzcywgU3RhdGVtZW50LmNsYXNzKTsKICAgICAgICAg\nICAgbG9nZ2luZ1ByZXBhcmVkU3RhdGVtZW50SW1wbCA9IENvbmNyZXRlQ2xh\nc3NHZW5lcmF0b3IuZ2V0Q29uY3JldGVDb25zdHJ1Y3RvcigKICAgICAgICAg\nICAgICAgIExvZ2dpbmdDb25uZWN0aW9uLkxvZ2dpbmdQcmVwYXJlZFN0YXRl\nbWVudC5jbGFzcywgCiAgICAgICAgICAgICAgICBMb2dnaW5nQ29ubmVjdGlv\nbi5jbGFzcywgUHJlcGFyZWRTdGF0ZW1lbnQuY2xhc3MsIFN0cmluZy5jbGFz\ncyk7CiAgICAgICAgICAgIGxvZ2dpbmdDYWxsYWJsZVN0YXRlbWVudEltcGwg\nPSBDb25jcmV0ZUNsYXNzR2VuZXJhdG9yLmdldENvbmNyZXRlQ29uc3RydWN0\nb3IoCiAgICAgICAgICAgICAgICBMb2dnaW5nQ29ubmVjdGlvbi5Mb2dnaW5n\nQ2FsbGFibGVTdGF0ZW1lbnQuY2xhc3MsCiAgICAgICAgICAgICAgICBMb2dn\naW5nQ29ubmVjdGlvbi5jbGFzcywgQ2FsbGFibGVTdGF0ZW1lbnQuY2xhc3Ms\nIFN0cmluZy5jbGFzcyk7CiAgICAgICAgICAgIGxvZ2dpbmdEYXRhYmFzZU1l\ndGFEYXRhSW1wbCA9IENvbmNyZXRlQ2xhc3NHZW5lcmF0b3IuZ2V0Q29uY3Jl\ndGVDb25zdHJ1Y3RvcigKICAgICAgICAgICAgICAgIExvZ2dpbmdDb25uZWN0\naW9uLkxvZ2dpbmdEYXRhYmFzZU1ldGFEYXRhLmNsYXNzLAogICAgICAgICAg\nICAgICAgTG9nZ2luZ0Nvbm5lY3Rpb24uY2xhc3MsIERhdGFiYXNlTWV0YURh\ndGEuY2xhc3MpOwogICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAg\nICAgICAgICAgIHRocm93IG5ldyBFeGNlcHRpb25JbkluaXRpYWxpemVyRXJy\nb3IoZSk7CiAgICAgICAgfQogICAgfQoKICAgIHByaXZhdGUgZmluYWwgRGF0\nYVNvdXJjZUxvZ3MgX2xvZ3MgPSBuZXcgRGF0YVNvdXJjZUxvZ3MoKTsKICAg\nIHByaXZhdGUgU1FMRm9ybWF0dGVyIF9mb3JtYXR0ZXI7CiAgICBwcml2YXRl\nIGJvb2xlYW4gX3ByZXR0eVByaW50OwogICAgcHJpdmF0ZSBpbnQgX3ByZXR0\neVByaW50TGluZUxlbmd0aCA9IDYwOwogICAgcHJpdmF0ZSBpbnQgX3dhcm5p\nbmdBY3Rpb24gPSBXQVJOX0lHTk9SRTsKICAgIHByaXZhdGUgU1FMV2Fybmlu\nZ0hhbmRsZXIgX3dhcm5pbmdIYW5kbGVyOwogICAgcHJpdmF0ZSBib29sZWFu\nIF90cmFja1BhcmFtZXRlcnMgPSB0cnVlOwogICAgcHJpdmF0ZSBib29sZWFu\nIF9wcmludFBhcmFtZXRlcnMgPSBmYWxzZTsKCiAgICAvKioKICAgICAqIElm\nIHNldCB0byA8Y29kZT50cnVlPC9jb2RlPiwgcHJldHR5LXByaW50IFNRTCBi\neSBydW5uaW5nIGl0CiAgICAgKiB0aHJvdWdoIHtAbGluayBTUUxGb3JtYXR0\nZXIjcHJldHR5UHJpbnR9LiBJZgogICAgICogPGNvZGU+ZmFsc2U8L2NvZGU+\nLCBkb24ndCBwcmV0dHktcHJpbnQsIGFuZCBvdXRwdXQgU1FMIGxvZ3MgaW4K\nICAgICAqIGEgc2luZ2xlIGxpbmUuIFByZXR0eS1wcmludGVkIFNRTCBjYW4g\nYmUgZWFzaWVyIGZvciBhIGh1bWFuIHRvCiAgICAgKiByZWFkLCBidXQgaXMg\naGFyZGVyIHRvIHBhcnNlIHdpdGggdG9vbHMgbGlrZSBncmVwLgogICAgICov\nCiAgICBwdWJsaWMgdm9pZCBzZXRQcmV0dHlQcmludChib29sZWFuIHByZXR0\neVByaW50KSB7CiAgICAgICAgX3ByZXR0eVByaW50ID0gcHJldHR5UHJpbnQ7\nCiAgICAgICAgaWYgKF9mb3JtYXR0ZXIgPT0gbnVsbCAmJiBfcHJldHR5UHJp\nbnQpIHsKICAgICAgICAgICAgX2Zvcm1hdHRlciA9IG5ldyBTUUxGb3JtYXR0\nZXIoKTsKICAgICAgICAgICAgX2Zvcm1hdHRlci5zZXRMaW5lTGVuZ3RoKF9w\ncmV0dHlQcmludExpbmVMZW5ndGgpOwogICAgICAgIH0gZWxzZSBpZiAoIV9w\ncmV0dHlQcmludCkKICAgICAgICAgICAgX2Zvcm1hdHRlciA9IG51bGw7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBAc2VlICNzZXRQcmV0dHlQcmludAogICAg\nICovCiAgICBwdWJsaWMgYm9vbGVhbiBnZXRQcmV0dHlQcmludCgpIHsKICAg\nICAgICByZXR1cm4gX3ByZXR0eVByaW50OwogICAgfQoKICAgIC8qKgogICAg\nICogVGhlIG51bWJlciBvZiBjaGFyYWN0ZXJzIHRvIHByaW50IHBlciBsaW5l\nIHdoZW4KICAgICAqIHByZXR0eS1wcmludGluZyBvZiBTUUwgaXMgZW5hYmxl\nZC4gRGVmYXVsdHMgdG8gNjAgdG8gcHJvdmlkZQogICAgICogc29tZSBzcGFj\nZSBmb3IgYW55IGFudC1yZWxhdGVkIGNoYXJhY3RlcnMgb24gdGhlIGxlZnQg\nb2YgYQogICAgICogc3RhbmRhcmQgODAtY2hhcmFjdGVyIGRpc3BsYXkuCiAg\nICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldFByZXR0eVByaW50TGluZUxlbmd0\naChpbnQgbGVuZ3RoKSB7CiAgICAgICAgX3ByZXR0eVByaW50TGluZUxlbmd0\naCA9IGxlbmd0aDsKICAgICAgICBpZiAoX2Zvcm1hdHRlciAhPSBudWxsKQog\nICAgICAgICAgICBfZm9ybWF0dGVyLnNldExpbmVMZW5ndGgobGVuZ3RoKTsK\nICAgIH0KCiAgICAvKioKICAgICAqIEBzZWUgI3NldFByZXR0eVByaW50TGlu\nZUxlbmd0aAogICAgICovCiAgICBwdWJsaWMgaW50IGdldFByZXR0eVByaW50\nTGluZUxlbmd0aCgpIHsKICAgICAgICByZXR1cm4gX3ByZXR0eVByaW50TGlu\nZUxlbmd0aDsKICAgIH0KCiAgICAvKioKICAgICAqIFdoZXRoZXIgdG8gdHJh\nY2sgcGFyYW1ldGVycyBmb3IgdGhlIHB1cnBvc2VzIG9mIHJlcG9ydGluZyBl\neGNlcHRpb25zLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRUcmFja1Bh\ncmFtZXRlcnMoYm9vbGVhbiB0cmFja1BhcmFtZXRlcnMpIHsKICAgICAgICBf\ndHJhY2tQYXJhbWV0ZXJzID0gdHJhY2tQYXJhbWV0ZXJzOwogICAgfQoKICAg\nIC8qKgogICAgICogV2hldGhlciB0byB0cmFjayBwYXJhbWV0ZXJzIGZvciB0\naGUgcHVycG9zZXMgb2YgcmVwb3J0aW5nIGV4Y2VwdGlvbnMuCiAgICAgKi8K\nICAgIHB1YmxpYyBib29sZWFuIGdldFRyYWNrUGFyYW1ldGVycygpIHsKICAg\nICAgICByZXR1cm4gX3RyYWNrUGFyYW1ldGVyczsKICAgIH0KCiAgICAvKioK\nICAgICAqIDxwPgogICAgICogV2hldGhlciBwYXJhbWV0ZXIgdmFsdWVzIHdp\nbGwgYmUgcHJpbnRlZCBpbiBleGNlcHRpb24gbWVzc2FnZXMgb3IgaW4gdHJh\nY2UuIFRoaXMgaXMgZGlmZmVyZW50IGZyb20KICAgICAqIHRyYWNrUGFyYW1l\ndGVycyB3aGljaCBjb250cm9scyB3aGV0aGVyIE9wZW5KUEEgd2lsbCB0cmFj\nayBwYXJhbWV0ZXJzIGludGVybmFsbHkgKHZpc2libGUgd2hpbGUgZGVidWdn\naW5nIGFuZCB1c2VkCiAgICAgKiBpbiBiYXRjaGluZykuCiAgICAgKiA8L3A+\nCiAgICAgKi8KICAgIHB1YmxpYyBib29sZWFuIGdldFByaW50UGFyYW1ldGVy\ncygpIHsKICAgICAgICByZXR1cm4gX3ByaW50UGFyYW1ldGVyczsKICAgIH0K\nCiAgICBwdWJsaWMgdm9pZCBzZXRQcmludFBhcmFtZXRlcnMoYm9vbGVhbiBw\ncmludFBhcmFtZXRlcnMpIHsKICAgICAgICBfcHJpbnRQYXJhbWV0ZXJzID0g\ncHJpbnRQYXJhbWV0ZXJzOwogICAgfQoKICAgIC8qKgogICAgICogV2hhdCB0\nbyBkbyB3aXRoIFNRTCB3YXJuaW5ncy4KICAgICAqLwogICAgcHVibGljIHZv\naWQgc2V0V2FybmluZ0FjdGlvbihTdHJpbmcgd2FybmluZ0FjdGlvbikgewog\nICAgICAgIGludCBpbmRleCA9IEFycmF5cy5hc0xpc3QoV0FSTklOR19BQ1RJ\nT05TKS5pbmRleE9mKHdhcm5pbmdBY3Rpb24pOwogICAgICAgIGlmIChpbmRl\neCA8IDApCiAgICAgICAgICAgIGluZGV4ID0gV0FSTl9JR05PUkU7CiAgICAg\nICAgX3dhcm5pbmdBY3Rpb24gPSBpbmRleDsKICAgIH0KCiAgICAvKioKICAg\nICAqIFdoYXQgdG8gZG8gd2l0aCBTUUwgd2FybmluZ3MuCiAgICAgKi8KICAg\nIHB1YmxpYyBTdHJpbmcgZ2V0V2FybmluZ0FjdGlvbigpIHsKICAgICAgICBy\nZXR1cm4gV0FSTklOR19BQ1RJT05TW193YXJuaW5nQWN0aW9uXTsKICAgIH0K\nCiAgICAvKioKICAgICAqIFdoYXQgdG8gZG8gd2l0aCBTUUwgd2FybmluZ3Mu\nCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldFdhcm5pbmdIYW5kbGVyKFNR\nTFdhcm5pbmdIYW5kbGVyIHdhcm5pbmdIYW5kbGVyKSB7CiAgICAgICAgX3dh\ncm5pbmdIYW5kbGVyID0gd2FybmluZ0hhbmRsZXI7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBXaGF0IHRvIGRvIHdpdGggU1FMIHdhcm5pbmdzLgogICAgICov\nCiAgICBwdWJsaWMgU1FMV2FybmluZ0hhbmRsZXIgZ2V0V2FybmluZ0hhbmRs\nZXIoKSB7CiAgICAgICAgcmV0dXJuIF93YXJuaW5nSGFuZGxlcjsKICAgIH0K\nCiAgICAvKioKICAgICAqIFRoZSBsb2cgdG8gd3JpdGUgdG8uCiAgICAgKi8K\nICAgIHB1YmxpYyBEYXRhU291cmNlTG9ncyBnZXRMb2dzKCkgewogICAgICAg\nIHJldHVybiBfbG9nczsKICAgIH0KCiAgICBwdWJsaWMgQ29ubmVjdGlvbiBk\nZWNvcmF0ZShDb25uZWN0aW9uIGNvbm4pIHRocm93cyBTUUxFeGNlcHRpb24g\newogICAgICAgIHJldHVybiBuZXdMb2dnaW5nQ29ubmVjdGlvbihjb25uKTsK\nICAgIH0KICAgICAgICAgCiAgICBwcml2YXRlIExvZ2dpbmdDb25uZWN0aW9u\nIG5ld0xvZ2dpbmdDb25uZWN0aW9uKENvbm5lY3Rpb24gY29ubikKICAgICAg\nICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICByZXR1cm4gQ29uY3Jl\ndGVDbGFzc0dlbmVyYXRvci5uZXdJbnN0YW5jZShsb2dnaW5nQ29ubmVjdGlv\nbkltcGwsIExvZ2dpbmdDb25uZWN0aW9uRGVjb3JhdG9yLnRoaXMsIGNvbm4p\nOwogICAgfQoKICAgIHByaXZhdGUgU1FMRXhjZXB0aW9uIHdyYXAoU1FMRXhj\nZXB0aW9uIHNxbGUsIFN0YXRlbWVudCBzdG1udCkgewogICAgICAgIHJldHVy\nbiB3cmFwKHNxbGUsIHN0bW50LCBudWxsLCAtMSk7CiAgICB9CgogICAgcHJp\ndmF0ZSBTUUxFeGNlcHRpb24gd3JhcChTUUxFeGNlcHRpb24gc3FsZSwgU3Ry\naW5nIHNxbCkgewogICAgICAgIHJldHVybiB3cmFwKHNxbGUsIG51bGwsIHNx\nbCwgLTEpOwogICAgfQogICAgCiAgICBwcml2YXRlIFNRTEV4Y2VwdGlvbiB3\ncmFwKFNRTEV4Y2VwdGlvbiBzcWxlLCBTdGF0ZW1lbnQgc3RtbnQsIFN0cmlu\nZyBzcWwpIHsKICAgICAgICByZXR1cm4gd3JhcChzcWxlLCBzdG1udCwgc3Fs\nLCAtMSk7CiAgICB9CgogICAgcHJpdmF0ZSBTUUxFeGNlcHRpb24gd3JhcChT\nUUxFeGNlcHRpb24gc3FsZSwgU3RhdGVtZW50IHN0bW50LCBpbnQgaW5kZXhP\nZkZhaWxlZEJhdGNoT2JqZWN0KSB7CiAgICAgICAgcmV0dXJuIHdyYXAoc3Fs\nZSwgc3RtbnQsIG51bGwsIGluZGV4T2ZGYWlsZWRCYXRjaE9iamVjdCk7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBJbmNsdWRlIFNRTCBpbiBleGNlcHRpb24u\nCiAgICAgKi8KICAgIHByaXZhdGUgU1FMRXhjZXB0aW9uIHdyYXAoU1FMRXhj\nZXB0aW9uIHNxbGUsIFN0YXRlbWVudCBzdG1udCwgU3RyaW5nIHNxbCwgaW50\nIGluZGV4T2ZGYWlsZWRCYXRjaE9iamVjdCkgewogICAgICAgIFJlcG9ydGlu\nZ1NRTEV4Y2VwdGlvbiB0b1JldHVybiA9IG51bGw7CgogICAgICAgIGlmIChz\ncWxlIGluc3RhbmNlb2YgUmVwb3J0aW5nU1FMRXhjZXB0aW9uKSB7CiAgICAg\nICAgICAgIHRvUmV0dXJuID0gKFJlcG9ydGluZ1NRTEV4Y2VwdGlvbikgc3Fs\nZTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB0b1JldHVybiA9IG5l\ndyBSZXBvcnRpbmdTUUxFeGNlcHRpb24oc3FsZSwgc3RtbnQsIHNxbCk7CiAg\nICAgICAgfQoKICAgICAgICB0b1JldHVybi5zZXRJbmRleE9mRmlyc3RGYWls\nZWRPYmplY3QoaW5kZXhPZkZhaWxlZEJhdGNoT2JqZWN0KTsKICAgICAgICBy\nZXR1cm4gdG9SZXR1cm47CiAgICB9CgogICAgLyoqCiAgICAgKiBJbnRlcmZh\nY2UgdGhhdCBhbGxvd3MgY3VzdG9taXphdGlvbiBvZiB3aGF0IHRvIGRvIHdo\nZW4KICAgICAqIHtAbGluayBTUUxXYXJuaW5nfXMgb2NjdXIuCiAgICAgKi8K\nICAgIHB1YmxpYyBzdGF0aWMgaW50ZXJmYWNlIFNRTFdhcm5pbmdIYW5kbGVy\nIHsKCiAgICAgICAgcHVibGljIHZvaWQgaGFuZGxlV2FybmluZyhTUUxXYXJu\naW5nIHdhcm5pbmcpIHRocm93cyBTUUxFeGNlcHRpb247CiAgICB9CgogICAg\nLyoqCiAgICAgKiBMb2dnaW5nIGNvbm5lY3Rpb24uCiAgICAgKi8KICAgIHBy\nb3RlY3RlZCBhYnN0cmFjdCBjbGFzcyBMb2dnaW5nQ29ubmVjdGlvbiBleHRl\nbmRzIERlbGVnYXRpbmdDb25uZWN0aW9uIHsKCiAgICAgICAgcHVibGljIExv\nZ2dpbmdDb25uZWN0aW9uKENvbm5lY3Rpb24gY29ubikgdGhyb3dzIFNRTEV4\nY2VwdGlvbiB7CiAgICAgICAgICAgIHN1cGVyKGNvbm4pOwogICAgICAgIH0K\nCiAgICAgICAgcHJvdGVjdGVkIFByZXBhcmVkU3RhdGVtZW50IHByZXBhcmVT\ndGF0ZW1lbnQoU3RyaW5nIHNxbCwgYm9vbGVhbiB3cmFwKQogICAgICAgICAg\nICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAgICAgU1FMRXhjZXB0\naW9uIGVyciA9IG51bGw7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAg\nICAgICBQcmVwYXJlZFN0YXRlbWVudCBzdG1udCA9IHN1cGVyLnByZXBhcmVT\ndGF0ZW1lbnQoc3FsLCBmYWxzZSk7CiAgICAgICAgICAgICAgICByZXR1cm4g\nbmV3TG9nZ2luZ1ByZXBhcmVkU3RhdGVtZW50KHN0bW50LCBzcWwpOwogICAg\nICAgICAgICB9IGNhdGNoIChTUUxFeGNlcHRpb24gc2UpIHsKICAgICAgICAg\nICAgICAgIGVyciA9IHdyYXAoc2UsIHNxbCk7CiAgICAgICAgICAgICAgICB0\naHJvdyBlcnI7CiAgICAgICAgICAgIH0gIGZpbmFsbHkgewogICAgICAgICAg\nICAgICAgaGFuZGxlU1FMRXJyb3JzKGVycik7CiAgICAgICAgICAgIH0KICAg\nICAgICB9CgogICAgICAgIHByb3RlY3RlZCBQcmVwYXJlZFN0YXRlbWVudCBw\ncmVwYXJlU3RhdGVtZW50KFN0cmluZyBzcWwsIGludCByc1R5cGUsCiAgICAg\nICAgICAgIGludCByc0NvbmN1ciwgYm9vbGVhbiB3cmFwKSB0aHJvd3MgU1FM\nRXhjZXB0aW9uIHsKICAgICAgICAgICAgU1FMRXhjZXB0aW9uIGVyciA9IG51\nbGw7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBQcmVwYXJl\nZFN0YXRlbWVudCBzdG1udCA9IHN1cGVyLnByZXBhcmVTdGF0ZW1lbnQKICAg\nICAgICAgICAgICAgICAgICAoc3FsLCByc1R5cGUsIHJzQ29uY3VyLCBmYWxz\nZSk7CiAgICAgICAgICAgICAgICByZXR1cm4gbmV3TG9nZ2luZ1ByZXBhcmVk\nU3RhdGVtZW50KHN0bW50LCBzcWwpOwogICAgICAgICAgICB9IGNhdGNoIChT\nUUxFeGNlcHRpb24gc2UpIHsKICAgICAgICAgICAgICAgIGVyciA9ICB3cmFw\nKHNlLCBzcWwpOwogICAgICAgICAgICAgICAgdGhyb3cgZXJyOwogICAgICAg\nICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICAgICAgaGFuZGxlU1FMRXJy\nb3JzKGVycik7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHBy\nb3RlY3RlZCBTdGF0ZW1lbnQgY3JlYXRlU3RhdGVtZW50KGJvb2xlYW4gd3Jh\ncCkgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgICAgIFNRTEV4Y2Vw\ndGlvbiBlcnIgPSBudWxsOwogICAgICAgICAgICB0cnkgewogICAgICAgICAg\nICAgICAgU3RhdGVtZW50IHN0bW50ID0gc3VwZXIuY3JlYXRlU3RhdGVtZW50\nKGZhbHNlKTsKICAgICAgICAgICAgICAgIHJldHVybiBuZXdMb2dnaW5nU3Rh\ndGVtZW50KHN0bW50KTsKICAgICAgICAgICAgfWNhdGNoIChTUUxFeGNlcHRp\nb24gc2UpIHsKICAgICAgICAgICAgICAgIGVyciA9IHNlOwogICAgICAgICAg\nICAgICAgdGhyb3cgc2U7CiAgICAgICAgICAgIH0gZmluYWxseSB7CiAgICAg\nICAgICAgICAgICBoYW5kbGVTUUxFcnJvcnMoZXJyKTsKICAgICAgICAgICAg\nfQogICAgICAgIH0KCiAgICAgICAgcHJvdGVjdGVkIFN0YXRlbWVudCBjcmVh\ndGVTdGF0ZW1lbnQoaW50IHR5cGUsIGludCBjb25jdXJyZW5jeSwKICAgICAg\nICAgICAgYm9vbGVhbiB3cmFwKSB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAg\nICAgICAgICAgU1FMRXhjZXB0aW9uIGVyciA9IG51bGw7CiAgICAgICAgICAg\nIHRyeSB7CiAgICAgICAgICAgICAgICBTdGF0ZW1lbnQgc3RtbnQgPSBzdXBl\nci5jcmVhdGVTdGF0ZW1lbnQodHlwZSwgY29uY3VycmVuY3ksIAogICAgICAg\nICAgICAgICAgICAgIGZhbHNlKTsKICAgICAgICAgICAgICAgIHJldHVybiBu\nZXdMb2dnaW5nU3RhdGVtZW50KHN0bW50KTsKICAgICAgICAgICAgfSBjYXRj\naCAoU1FMRXhjZXB0aW9uIHNlKSB7CiAgICAgICAgICAgICAgICBlcnIgPSBz\nZTsKICAgICAgICAgICAgICAgIHRocm93IHNlOwogICAgICAgICAgICB9IGZp\nbmFsbHkgewogICAgICAgICAgICAgICAgaGFuZGxlU1FMRXJyb3JzKGVycik7\nCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgCiAgICAgICAgcHJv\ndGVjdGVkIENhbGxhYmxlU3RhdGVtZW50IHByZXBhcmVDYWxsKFN0cmluZyBz\ncWwsIGJvb2xlYW4gd3JhcCkgCiAgICAgICAgICAgIHRocm93cyBTUUxFeGNl\ncHRpb24gewogICAgICAgICAgICBTUUxFeGNlcHRpb24gZXJyID0gbnVsbDsK\nICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIENhbGxhYmxlU3Rh\ndGVtZW50IHN0bXQgPSBzdXBlci5wcmVwYXJlQ2FsbChzcWwsIHdyYXApOwog\nICAgICAgICAgICAgICAgcmV0dXJuIG5ld0xvZ2dpbmdDYWxsYWJsZVN0YXRl\nbWVudChzdG10LCBzcWwpOwogICAgICAgICAgICB9IGNhdGNoIChTUUxFeGNl\ncHRpb24gc2UpIHsKICAgICAgICAgICAgICAgIGVyciA9IHdyYXAoc2UsIHNx\nbCk7CiAgICAgICAgICAgICAgICB0aHJvdyBlcnI7CiAgICAgICAgICAgIH0g\nZmluYWxseSB7CiAgICAgICAgICAgICAgICBoYW5kbGVTUUxFcnJvcnMoZXJy\nKTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgcHJpdmF0ZSBM\nb2dnaW5nUHJlcGFyZWRTdGF0ZW1lbnQgbmV3TG9nZ2luZ1ByZXBhcmVkU3Rh\ndGVtZW50CiAgICAgICAgICAgIChQcmVwYXJlZFN0YXRlbWVudCBzdG1udCwg\nU3RyaW5nIHNxbCkgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgICAg\nIHJldHVybiBDb25jcmV0ZUNsYXNzR2VuZXJhdG9yLm5ld0luc3RhbmNlKGxv\nZ2dpbmdQcmVwYXJlZFN0YXRlbWVudEltcGwsIExvZ2dpbmdDb25uZWN0aW9u\nLnRoaXMsIHN0bW50LCBzcWwpOwogICAgICAgIH0KICAgICAgICAKICAgICAg\nICBwcml2YXRlIENhbGxhYmxlU3RhdGVtZW50IG5ld0xvZ2dpbmdDYWxsYWJs\nZVN0YXRlbWVudChDYWxsYWJsZVN0YXRlbWVudCBzdG1udCwgU3RyaW5nIHNx\nbCkgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgICAgIHJldHVybiBD\nb25jcmV0ZUNsYXNzR2VuZXJhdG9yLm5ld0luc3RhbmNlKGxvZ2dpbmdDYWxs\nYWJsZVN0YXRlbWVudEltcGwsIExvZ2dpbmdDb25uZWN0aW9uLnRoaXMsIHN0\nbW50LCBzcWwpOwogICAgICAgIH0KICAgICAgICAKICAgICAgICBwcml2YXRl\nIExvZ2dpbmdTdGF0ZW1lbnQgbmV3TG9nZ2luZ1N0YXRlbWVudChTdGF0ZW1l\nbnQgc3RtbnQpCiAgICAgICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewog\nICAgICAgICAgICByZXR1cm4gQ29uY3JldGVDbGFzc0dlbmVyYXRvci5uZXdJ\nbnN0YW5jZShsb2dnaW5nU3RhdGVtZW50SW1wbCwgTG9nZ2luZ0Nvbm5lY3Rp\nb24udGhpcywgc3RtbnQpOwogICAgICAgIH0KICAgICAgICAKICAgICAgICBw\ncml2YXRlIExvZ2dpbmdEYXRhYmFzZU1ldGFEYXRhIG5ld0xvZ2dpbmdEYXRh\nYmFzZU1ldGFEYXRhCiAgICAgICAgICAgIChEYXRhYmFzZU1ldGFEYXRhIG1l\ndGEpIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgICAgICByZXR1cm4g\nQ29uY3JldGVDbGFzc0dlbmVyYXRvci5uZXdJbnN0YW5jZShsb2dnaW5nRGF0\nYWJhc2VNZXRhRGF0YUltcGwsIExvZ2dpbmdDb25uZWN0aW9uLnRoaXMsIG1l\ndGEpOwogICAgICAgIH0KCgoKICAgICAgICBwdWJsaWMgdm9pZCBjb21taXQo\nKSB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAgICAgbG9uZyBzdGFy\ndCA9IFN5c3RlbS5jdXJyZW50VGltZU1pbGxpcygpOwogICAgICAgICAgICBT\nUUxFeGNlcHRpb24gZXJyID0gbnVsbDsgICAgICAgICAgICAKICAgICAgICAg\nICAgdHJ5IHsKICAgICAgICAgICAgICAgIHN1cGVyLmNvbW1pdCgpOwogICAg\nICAgICAgICB9IGNhdGNoIChTUUxFeGNlcHRpb24gc2UpIHsKICAgICAgICAg\nICAgICAgIGVyciA9IHNlOwogICAgICAgICAgICAgICAgdGhyb3cgc2U7CiAg\nICAgICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgICAgICBpZiAoX2xv\nZ3MuaXNKREJDRW5hYmxlZCgpKQogICAgICAgICAgICAgICAgICAgIF9sb2dz\nLmxvZ0pEQkMoImNvbW1pdCIsIHN0YXJ0LCB0aGlzKTsKICAgICAgICAgICAg\nICAgIGhhbmRsZVNRTEVycm9ycyhlcnIpOwogICAgICAgICAgICB9CiAgICAg\nICAgfQoKICAgICAgICBwdWJsaWMgdm9pZCByb2xsYmFjaygpIHRocm93cyBT\nUUxFeGNlcHRpb24gewogICAgICAgICAgICBsb25nIHN0YXJ0ID0gU3lzdGVt\nLmN1cnJlbnRUaW1lTWlsbGlzKCk7CiAgICAgICAgICAgIFNRTEV4Y2VwdGlv\nbiBlcnIgPSBudWxsOyAgICAgICAgICAgIAogICAgICAgICAgICB0cnkgewog\nICAgICAgICAgICAgICAgc3VwZXIucm9sbGJhY2soKTsKICAgICAgICAgICAg\nfSBjYXRjaCAoU1FMRXhjZXB0aW9uIHNlKSB7CiAgICAgICAgICAgICAgICBl\ncnIgPSBzZTsKICAgICAgICAgICAgICAgIHRocm93IHNlOwogICAgICAgICAg\nICB9IGZpbmFsbHkgewogICAgICAgICAgICAgICAgaWYgKF9sb2dzLmlzSkRC\nQ0VuYWJsZWQoKSkKICAgICAgICAgICAgICAgICAgICBfbG9ncy5sb2dKREJD\nKCJyb2xsYmFjayIsIHN0YXJ0LCB0aGlzKTsKICAgICAgICAgICAgICAgIGhh\nbmRsZVNRTEVycm9ycyhlcnIpOwogICAgICAgICAgICB9CiAgICAgICAgfQoK\nICAgICAgICBwdWJsaWMgdm9pZCBjbG9zZSgpIHRocm93cyBTUUxFeGNlcHRp\nb24gewogICAgICAgICAgICBsb25nIHN0YXJ0ID0gU3lzdGVtLmN1cnJlbnRU\naW1lTWlsbGlzKCk7ICAgICAgIAogICAgICAgICAgICB0cnkgewogICAgICAg\nICAgICAgICAgc3VwZXIuY2xvc2UoKTsKICAgICAgICAgICAgfSBmaW5hbGx5\nIHsKICAgICAgICAgICAgICAgIGlmIChfbG9ncy5pc0pEQkNFbmFibGVkKCkp\nCiAgICAgICAgICAgICAgICAgICAgX2xvZ3MubG9nSkRCQygiY2xvc2UiLCBz\ndGFydCwgdGhpcyk7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAg\nIHB1YmxpYyBTYXZlcG9pbnQgc2V0U2F2ZXBvaW50KCkgdGhyb3dzIFNRTEV4\nY2VwdGlvbiB7CiAgICAgICAgICAgIGxvbmcgc3RhcnQgPSBTeXN0ZW0uY3Vy\ncmVudFRpbWVNaWxsaXMoKTsKICAgICAgICAgICAgU1FMRXhjZXB0aW9uIGVy\nciA9IG51bGw7ICAgICAgICAgICAgCiAgICAgICAgICAgIHRyeSB7CiAgICAg\nICAgICAgICAgICByZXR1cm4gc3VwZXIuc2V0U2F2ZXBvaW50KCk7CiAgICAg\nICAgICAgIH0gY2F0Y2ggKFNRTEV4Y2VwdGlvbiBzZSkgewogICAgICAgICAg\nICAgICAgZXJyID0gc2U7CiAgICAgICAgICAgICAgICB0aHJvdyBzZTsKICAg\nICAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgICAgIGlmIChfbG9n\ncy5pc0pEQkNFbmFibGVkKCkpCiAgICAgICAgICAgICAgICAgICAgX2xvZ3Mu\nbG9nSkRCQygic2F2ZXBvaW50Iiwgc3RhcnQsIHRoaXMpOwogICAgICAgICAg\nICAgICAgaGFuZGxlU1FMRXJyb3JzKGVycik7CiAgICAgICAgICAgIH0KICAg\nICAgICB9CgogICAgICAgIHB1YmxpYyBTYXZlcG9pbnQgc2V0U2F2ZXBvaW50\nKFN0cmluZyBuYW1lKSB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAg\nICAgbG9uZyBzdGFydCA9IFN5c3RlbS5jdXJyZW50VGltZU1pbGxpcygpOwog\nICAgICAgICAgICBTUUxFeGNlcHRpb24gZXJyID0gbnVsbDsgICAgICAgICAg\nICAKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIHJldHVybiBz\ndXBlci5zZXRTYXZlcG9pbnQobmFtZSk7CiAgICAgICAgICAgIH0gY2F0Y2gg\nKFNRTEV4Y2VwdGlvbiBzZSkgewogICAgICAgICAgICAgICAgZXJyID0gc2U7\nCiAgICAgICAgICAgICAgICB0aHJvdyBzZTsKICAgICAgICAgICAgfSBmaW5h\nbGx5IHsKICAgICAgICAgICAgICAgIGlmIChfbG9ncy5pc0pEQkNFbmFibGVk\nKCkpCiAgICAgICAgICAgICAgICAgICAgX2xvZ3MubG9nSkRCQygic2F2ZXBv\naW50OiAiICsgbmFtZSwgc3RhcnQsIHRoaXMpOwogICAgICAgICAgICAgICAg\naGFuZGxlU1FMRXJyb3JzKGVycik7CiAgICAgICAgICAgIH0KICAgICAgICB9\nCgogICAgICAgIHB1YmxpYyB2b2lkIHJvbGxiYWNrKFNhdmVwb2ludCBzYXZl\ncG9pbnQpIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgICAgICBsb25n\nIHN0YXJ0ID0gU3lzdGVtLmN1cnJlbnRUaW1lTWlsbGlzKCk7CiAgICAgICAg\nICAgIFNRTEV4Y2VwdGlvbiBlcnIgPSBudWxsOyAgICAgICAgICAgIAogICAg\nICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgc3VwZXIucm9sbGJhY2so\nc2F2ZXBvaW50KTsKICAgICAgICAgICAgfSBjYXRjaCAoU1FMRXhjZXB0aW9u\nIHNlKSB7CiAgICAgICAgICAgICAgICBlcnIgPSBzZTsKICAgICAgICAgICAg\nICAgIHRocm93IHNlOwogICAgICAgICAgICB9IGZpbmFsbHkgewogICAgICAg\nICAgICAgICAgaWYgKF9sb2dzLmlzSkRCQ0VuYWJsZWQoKSkgewogICAgICAg\nICAgICAgICAgICAgIFN0cmluZyBuYW1lID0gbnVsbDsKICAgICAgICAgICAg\nICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgICAgICBuYW1lID0g\nc2F2ZXBvaW50LmdldFNhdmVwb2ludE5hbWUoKTsKICAgICAgICAgICAgICAg\nICAgICB9IGNhdGNoIChTUUxFeGNlcHRpb24gc3FlKSB7CiAgICAgICAgICAg\nICAgICAgICAgICAgIG5hbWUgPSBTdHJpbmcudmFsdWVPZihzYXZlcG9pbnQu\nZ2V0U2F2ZXBvaW50SWQoKSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAg\nICAgICAgICAgICAgICAgIF9sb2dzLmxvZ0pEQkMoInJvbGxiYWNrOiAiICsg\nbmFtZSwgc3RhcnQsIHRoaXMpOwogICAgICAgICAgICAgICAgfQogICAgICAg\nICAgICAgICAgaGFuZGxlU1FMRXJyb3JzKGVycik7CiAgICAgICAgICAgIH0K\nICAgICAgICB9CgogICAgICAgIHB1YmxpYyB2b2lkIHJlbGVhc2VTYXZlcG9p\nbnQoU2F2ZXBvaW50IHNhdmVwb2ludCkgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7\nCiAgICAgICAgICAgIGxvbmcgc3RhcnQgPSBTeXN0ZW0uY3VycmVudFRpbWVN\naWxsaXMoKTsKICAgICAgICAgICAgU1FMRXhjZXB0aW9uIGVyciA9IG51bGw7\nICAgICAgICAgICAgCiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAg\nICBzdXBlci5yZWxlYXNlU2F2ZXBvaW50KHNhdmVwb2ludCk7CiAgICAgICAg\nICAgIH0gY2F0Y2ggKFNRTEV4Y2VwdGlvbiBzZSkgewogICAgICAgICAgICAg\nICAgZXJyID0gc2U7CiAgICAgICAgICAgICAgICB0aHJvdyBzZTsKICAgICAg\nICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgICAgIGlmIChfbG9ncy5p\nc0pEQkNFbmFibGVkKCkpIHsKICAgICAgICAgICAgICAgICAgICBTdHJpbmcg\nbmFtZSA9IG51bGw7CiAgICAgICAgICAgICAgICAgICAgdHJ5IHsKICAgICAg\nICAgICAgICAgICAgICAgICAgbmFtZSA9IHNhdmVwb2ludC5nZXRTYXZlcG9p\nbnROYW1lKCk7CiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoU1FMRXhj\nZXB0aW9uIHNxZSkgewogICAgICAgICAgICAgICAgICAgICAgICBuYW1lID0g\nU3RyaW5nLnZhbHVlT2Yoc2F2ZXBvaW50LmdldFNhdmVwb2ludElkKCkpOwog\nICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBfbG9n\ncy5sb2dKREJDKCJyZWxlYXNlOiAiICsgbmFtZSwgc3RhcnQsIHRoaXMpOwog\nICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaGFuZGxlU1FMRXJy\nb3JzKGVycik7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHBy\nb3RlY3RlZCBTdGF0ZW1lbnQgY3JlYXRlU3RhdGVtZW50KGludCByZXN1bHRT\nZXRUeXBlLAogICAgICAgICAgICBpbnQgcmVzdWx0U2V0Q29uY3VycmVuY3ks\nIGludCByZXN1bHRTZXRIb2xkYWJpbGl0eSwgYm9vbGVhbiB3cmFwKQogICAg\nICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAgICAgU1FM\nRXhjZXB0aW9uIGVyciA9IG51bGw7CiAgICAgICAgICAgIHRyeSB7CiAgICAg\nICAgICAgICAgICBTdGF0ZW1lbnQgc3RtbnQgPSBzdXBlci5jcmVhdGVTdGF0\nZW1lbnQocmVzdWx0U2V0VHlwZSwKICAgICAgICAgICAgICAgICAgICByZXN1\nbHRTZXRDb25jdXJyZW5jeSwgcmVzdWx0U2V0SG9sZGFiaWxpdHksIGZhbHNl\nKTsKICAgICAgICAgICAgICAgIHJldHVybiBuZXdMb2dnaW5nU3RhdGVtZW50\nKHN0bW50KTsKICAgICAgICAgICAgfWNhdGNoIChTUUxFeGNlcHRpb24gc2Up\nIHsKICAgICAgICAgICAgICAgIGVyciA9IHNlOwogICAgICAgICAgICAgICAg\ndGhyb3cgc2U7CiAgICAgICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAg\nICAgICBoYW5kbGVTUUxFcnJvcnMoZXJyKTsKICAgICAgICAgICAgfQogICAg\nICAgIH0KCiAgICAgICAgcHJvdGVjdGVkIFByZXBhcmVkU3RhdGVtZW50IHBy\nZXBhcmVTdGF0ZW1lbnQoU3RyaW5nIHNxbCwKICAgICAgICAgICAgaW50IHJl\nc3VsdFNldFR5cGUsIGludCByZXN1bHRTZXRDb25jdXJyZW5jeSwKICAgICAg\nICAgICAgaW50IHJlc3VsdFNldEhvbGRhYmlsaXR5LCBib29sZWFuIHdyYXAp\nIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgICAgICBTUUxFeGNlcHRp\nb24gZXJyID0gbnVsbDsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAg\nICAgIFByZXBhcmVkU3RhdGVtZW50IHN0bW50ID0gc3VwZXIucHJlcGFyZVN0\nYXRlbWVudAogICAgICAgICAgICAgICAgICAgIChzcWwsIHJlc3VsdFNldFR5\ncGUsIHJlc3VsdFNldENvbmN1cnJlbmN5LAogICAgICAgICAgICAgICAgICAg\nICAgICByZXN1bHRTZXRIb2xkYWJpbGl0eSwgZmFsc2UpOwogICAgICAgICAg\nICAgICAgcmV0dXJuIG5ld0xvZ2dpbmdQcmVwYXJlZFN0YXRlbWVudChzdG1u\ndCwgc3FsKTsKICAgICAgICAgICAgfSBjYXRjaCAoU1FMRXhjZXB0aW9uIHNl\nKSB7CiAgICAgICAgICAgICAgICBlcnIgPSB3cmFwKHNlLCBzcWwpOwogICAg\nICAgICAgICAgICAgdGhyb3cgZXJyOwogICAgICAgICAgICB9IGZpbmFsbHkg\newogICAgICAgICAgICAgICAgaGFuZGxlU1FMRXJyb3JzKGVycik7CiAgICAg\nICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHByb3RlY3RlZCBQcmVwYXJl\nZFN0YXRlbWVudCBwcmVwYXJlU3RhdGVtZW50KFN0cmluZyBzcWwsCiAgICAg\nICAgICAgIGludCBhdXRvR2VuZXJhdGVkS2V5cywgYm9vbGVhbiB3cmFwKSB0\naHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAgICAgU1FMRXhjZXB0aW9u\nIGVyciA9IG51bGw7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAg\nICBQcmVwYXJlZFN0YXRlbWVudCBzdG1udCA9IHN1cGVyLnByZXBhcmVTdGF0\nZW1lbnQKICAgICAgICAgICAgICAgICAgICAoc3FsLCBhdXRvR2VuZXJhdGVk\nS2V5cywgZmFsc2UpOwogICAgICAgICAgICAgICAgcmV0dXJuIG5ld0xvZ2dp\nbmdQcmVwYXJlZFN0YXRlbWVudChzdG1udCwgc3FsKTsKICAgICAgICAgICAg\nfSBjYXRjaCAoU1FMRXhjZXB0aW9uIHNlKSB7CiAgICAgICAgICAgICAgICBl\ncnIgPSB3cmFwKHNlLCBzcWwpOwogICAgICAgICAgICAgICAgdGhyb3cgZXJy\nOwogICAgICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICAgICAgaGFu\nZGxlU1FMRXJyb3JzKGVycik7CiAgICAgICAgICAgIH0KICAgICAgICB9Cgog\nICAgICAgIHByb3RlY3RlZCBQcmVwYXJlZFN0YXRlbWVudCBwcmVwYXJlU3Rh\ndGVtZW50KFN0cmluZyBzcWwsCiAgICAgICAgICAgIGludFtdIGNvbHVtbklu\nZGV4ZXMsIGJvb2xlYW4gd3JhcCkgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAg\nICAgICAgICAgIFNRTEV4Y2VwdGlvbiBlcnIgPSBudWxsOwogICAgICAgICAg\nICB0cnkgewogICAgICAgICAgICAgICAgUHJlcGFyZWRTdGF0ZW1lbnQgc3Rt\nbnQgPSBzdXBlci5wcmVwYXJlU3RhdGVtZW50CiAgICAgICAgICAgICAgICAg\nICAgKHNxbCwgY29sdW1uSW5kZXhlcywgZmFsc2UpOwogICAgICAgICAgICAg\nICAgcmV0dXJuIG5ld0xvZ2dpbmdQcmVwYXJlZFN0YXRlbWVudChzdG1udCwg\nc3FsKTsKICAgICAgICAgICAgfSBjYXRjaCAoU1FMRXhjZXB0aW9uIHNlKSB7\nCiAgICAgICAgICAgICAgICBlcnIgPSB3cmFwKHNlLCBzcWwpOwogICAgICAg\nICAgICAgICAgdGhyb3cgZXJyOwogICAgICAgICAgICB9IGZpbmFsbHkgewog\nICAgICAgICAgICAgICAgaGFuZGxlU1FMRXJyb3JzKGVycik7CiAgICAgICAg\nICAgIH0KICAgICAgICB9CgogICAgICAgIHByb3RlY3RlZCBQcmVwYXJlZFN0\nYXRlbWVudCBwcmVwYXJlU3RhdGVtZW50KFN0cmluZyBzcWwsCiAgICAgICAg\nICAgIFN0cmluZ1tdIGNvbHVtbk5hbWVzLCBib29sZWFuIHdyYXApIHRocm93\ncyBTUUxFeGNlcHRpb24gewogICAgICAgICAgICBTUUxFeGNlcHRpb24gZXJy\nID0gbnVsbDsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIFBy\nZXBhcmVkU3RhdGVtZW50IHN0bW50ID0gc3VwZXIucHJlcGFyZVN0YXRlbWVu\ndAogICAgICAgICAgICAgICAgICAgIChzcWwsIGNvbHVtbk5hbWVzLCBmYWxz\nZSk7CiAgICAgICAgICAgICAgICByZXR1cm4gbmV3TG9nZ2luZ1ByZXBhcmVk\nU3RhdGVtZW50KHN0bW50LCBzcWwpOwogICAgICAgICAgICB9IGNhdGNoIChT\nUUxFeGNlcHRpb24gc2UpIHsKICAgICAgICAgICAgICAgIGVyciA9IHdyYXAo\nc2UsIHNxbCk7CiAgICAgICAgICAgICAgICB0aHJvdyBlcnI7CiAgICAgICAg\nICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgICAgICBoYW5kbGVTUUxFcnJv\ncnMoZXJyKTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgcHJv\ndGVjdGVkIERhdGFiYXNlTWV0YURhdGEgZ2V0TWV0YURhdGEoYm9vbGVhbiB3\ncmFwKQogICAgICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAg\nICAgICAgcmV0dXJuIG5ld0xvZ2dpbmdEYXRhYmFzZU1ldGFEYXRhKHN1cGVy\nLmdldE1ldGFEYXRhKGZhbHNlKSk7CiAgICAgICAgfQoKICAgICAgICAvKioK\nICAgICAgICAgKiBMb2cgdGltZSBlbGFwc2VkIHNpbmNlIGdpdmVuIHN0YXJ0\nLgogICAgICAgICAqLwogICAgICAgIHByaXZhdGUgdm9pZCBsb2dUaW1lKGxv\nbmcgc3RhcnRUaW1lKSB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAg\nICAgaWYgKF9sb2dzLmlzU1FMRW5hYmxlZCgpKQogICAgICAgICAgICAgICAg\nX2xvZ3MubG9nU1FMKCJzcGVudCIsIHN0YXJ0VGltZSwgdGhpcyk7IAogICAg\nICAgIH0KCiAgICAgICAgLyoqCiAgICAgICAgICogTG9nIHRpbWUgZWxhcHNl\nZCBzaW5jZSBnaXZlbiBzdGFydC4KICAgICAgICAgKi8KICAgICAgICBwcml2\nYXRlIHZvaWQgbG9nU1FMKFN0YXRlbWVudCBzdG1udCkgdGhyb3dzIFNRTEV4\nY2VwdGlvbiB7CiAgICAgICAgICAgIGlmIChfbG9ncy5pc1NRTEVuYWJsZWQo\nKSkKICAgICAgICAgICAgICAgIF9sb2dzLmxvZ1NRTCgiZXhlY3V0aW5nICIg\nKyBzdG1udCwgdGhpcyk7CiAgICAgICAgfQoKICAgICAgICAvKioKICAgICAg\nICAgKiBMb2cgdGltZSBlbGFwc2VkIHNpbmNlIGdpdmVuIHN0YXJ0LgogICAg\nICAgICAqLwogICAgICAgIHByaXZhdGUgdm9pZCBsb2dCYXRjaFNRTChTdGF0\nZW1lbnQgc3RtbnQpIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgICAg\nICBpZiAoX2xvZ3MuaXNTUUxFbmFibGVkKCkpCiAgICAgICAgICAgICAgICBf\nbG9ncy5sb2dTUUwoImV4ZWN1dGluZyBiYXRjaCAiICsgc3RtbnQsIHRoaXMp\nOwogICAgICAgIH0KICAgICAgICAKICAgICAgICAvKioKICAgICAgICAgKiBI\nYW5kbGUgYW55IHtAbGluayBTUUxXYXJuaW5nfXMgb24gdGhlIGN1cnJlbnQg\ne0BsaW5rIENvbm5lY3Rpb259LgogICAgICAgICAqIENoYWluIHRocm93ZWQg\nU1FMV2FybmluZ3MgdG8gU1FMRXhjZXB0aW9uLgogICAgICAgICAqIEBzZWUg\nI2hhbmRsZVNRTFdhcm5pbmcoU1FMV2FybmluZykKICAgICAgICAgKi8KICAg\nICAgICBwcml2YXRlIHZvaWQgaGFuZGxlU1FMRXJyb3JzKFNRTEV4Y2VwdGlv\nbiBlcnIpIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgICAgICBpZiAo\nX3dhcm5pbmdBY3Rpb24gPT0gV0FSTl9JR05PUkUpCiAgICAgICAgICAgICAg\nICByZXR1cm47CgogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAg\naGFuZGxlU1FMV2FybmluZyhnZXRXYXJuaW5ncygpKTsKICAgICAgICAgICAg\nfSBjYXRjaCAoU1FMRXhjZXB0aW9uIHdhcm5pbmcpIHsKICAgICAgICAgICAg\nICAgIGlmIChlcnIgIT0gbnVsbCkKICAgICAgICAgICAgICAgICAgICBlcnIu\nc2V0TmV4dEV4Y2VwdGlvbih3YXJuaW5nKTsKICAgICAgICAgICAgICAgIGVs\nc2UKICAgICAgICAgICAgICAgICAgICB0aHJvdyB3YXJuaW5nOwogICAgICAg\nICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICAgICAgY2xlYXJXYXJuaW5n\ncygpOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAvKioKICAg\nICAgICAgKiBIYW5kbGUgYW55IHtAbGluayBTUUxXYXJuaW5nfXMgb24gdGhl\nIHNwZWNpZmllZCB7QGxpbmsgU3RhdGVtZW50fS4KICAgICAgICAgKiBDaGFp\nbiB0aHJvd2VkIFNRTFdhcm5pbmdzIHRvIFNRTEV4Y2VwdGlvbi4KICAgICAg\nICAgKgogICAgICAgICAqIEBzZWUgI2hhbmRsZVNRTFdhcm5pbmcoU1FMV2Fy\nbmluZykKICAgICAgICAgKi8KICAgICAgICBwcml2YXRlIHZvaWQgaGFuZGxl\nU1FMRXJyb3JzKFN0YXRlbWVudCBzdG1udCwgU1FMRXhjZXB0aW9uIGVycikg\nCiAgICAgICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgICAg\nICBpZiAoX3dhcm5pbmdBY3Rpb24gPT0gV0FSTl9JR05PUkUpCiAgICAgICAg\nICAgICAgICByZXR1cm47IAogICAgICAgICAgICAKICAgICAgICAgICAgdHJ5\nIHsKICAgICAgICAgICAgICAgIGhhbmRsZVNRTFdhcm5pbmcoc3RtbnQuZ2V0\nV2FybmluZ3MoKSk7CiAgICAgICAgICAgIH0gY2F0Y2ggKFNRTEV4Y2VwdGlv\nbiB3YXJuaW5nKSB7CiAgICAgICAgICAgICAgICBpZiAoZXJyICE9IG51bGwp\nCiAgICAgICAgICAgICAgICAgICAgZXJyLnNldE5leHRFeGNlcHRpb24od2Fy\nbmluZyk7CiAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAg\nICAgdGhyb3cgd2FybmluZzsKICAgICAgICAgICAgfSBmaW5hbGx5IHsKICAg\nICAgICAgICAgICAgIHN0bW50LmNsZWFyV2FybmluZ3MoKTsKICAgICAgICAg\nICAgfQogICAgICAgIH0gICAgICAgIAogICAgICAgIAogICAgICAgIC8qKgog\nICAgICAgICAqIEhhbmRsZSBhbnkge0BsaW5rIFNRTFdhcm5pbmd9cyBvbiB0\naGUgc3BlY2lmaWVkIHtAbGluayBSZXN1bHRTZXR9LgogICAgICAgICAqIENo\nYWluIHRocm93ZWQgU1FMV2FybmluZ3MgdG8gU1FMRXhjZXB0aW9uLgogICAg\nICAgICAqIAogICAgICAgICAqIEBzZWUgI2hhbmRsZVNRTFdhcm5pbmcoU1FM\nV2FybmluZykKICAgICAgICAgKi8KICAgICAgICBwcml2YXRlIHZvaWQgaGFu\nZGxlU1FMRXJyb3JzKFJlc3VsdFNldCBycywgU1FMRXhjZXB0aW9uIGVycikg\nCiAgICAgICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgICAg\nICBpZiAoX3dhcm5pbmdBY3Rpb24gPT0gV0FSTl9JR05PUkUpCiAgICAgICAg\nICAgICAgICByZXR1cm47CiAgICAgICAgICAgIAogICAgICAgICAgICB0cnkg\newogICAgICAgICAgICAgICAgaGFuZGxlU1FMV2FybmluZyhycy5nZXRXYXJu\naW5ncygpKTsKICAgICAgICAgICAgfSBjYXRjaCAoU1FMRXhjZXB0aW9uIHdh\ncm5pbmcpewogICAgICAgICAgICAgICAgaWYgKGVyciAhPSBudWxsKQogICAg\nICAgICAgICAgICAgICAgIGVyci5zZXROZXh0RXhjZXB0aW9uKHdhcm5pbmcp\nOwogICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgIHRo\ncm93IHdhcm5pbmc7CiAgICAgICAgICAgIH0gZmluYWxseSB7CiAgICAgICAg\nICAgICAgICBycy5jbGVhcldhcm5pbmdzKCk7CiAgICAgICAgICAgIH0KICAg\nICAgICB9CiAgICAgICAgCiAgICAgICAgLyoqCiAgICAgICAgICogSGFuZGxl\nIHRoZSBzcGVjaWZpZWQge0BsaW5rIFNRTFdhcm5pbmd9IGRlcGVuZGluZyBv\nbiB0aGUKICAgICAgICAgKiBzZXR0aW5nIG9mIHRoZSB7QGxpbmsgI3NldFdh\ncm5pbmdBY3Rpb259IGF0dHJpYnV0ZS4KICAgICAgICAgKgogICAgICAgICAq\nIEBwYXJhbSB3YXJuaW5nIHRoZSB3YXJuaW5nIHRvIGhhbmRsZQogICAgICAg\nICAqLwogICAgICAgIHByaXZhdGUgdm9pZCBoYW5kbGVTUUxXYXJuaW5nKFNR\nTFdhcm5pbmcgd2FybmluZykgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAg\nICAgICAgIGlmICh3YXJuaW5nID09IG51bGwpCiAgICAgICAgICAgICAgICBy\nZXR1cm47CiAgICAgICAgICAgIGlmIChfd2FybmluZ0FjdGlvbiA9PSBXQVJO\nX0lHTk9SRSkKICAgICAgICAgICAgICAgIHJldHVybjsKCiAgICAgICAgICAg\nIExvZyBsb2cgPSBfbG9ncy5nZXRKREJDTG9nKCk7CiAgICAgICAgICAgIGZv\nciAoOyB3YXJuaW5nICE9IG51bGw7IHdhcm5pbmcgPSB3YXJuaW5nLmdldE5l\neHRXYXJuaW5nKCkpIHsKICAgICAgICAgICAgICAgIHN3aXRjaCAoX3dhcm5p\nbmdBY3Rpb24pIHsKICAgICAgICAgICAgICAgICAgICBjYXNlIFdBUk5fTE9H\nX1RSQUNFOgogICAgICAgICAgICAgICAgICAgICAgICBpZiAobG9nLmlzVHJh\nY2VFbmFibGVkKCkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2cu\ndHJhY2Uod2FybmluZyk7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFr\nOwogICAgICAgICAgICAgICAgICAgIGNhc2UgV0FSTl9MT0dfSU5GTzoKICAg\nICAgICAgICAgICAgICAgICAgICAgaWYgKGxvZy5pc0luZm9FbmFibGVkKCkp\nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2cuaW5mbyh3YXJuaW5n\nKTsKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAg\nICAgICAgICAgY2FzZSBXQVJOX0xPR19XQVJOOgogICAgICAgICAgICAgICAg\nICAgICAgICBpZiAobG9nLmlzV2FybkVuYWJsZWQoKSkKICAgICAgICAgICAg\nICAgICAgICAgICAgICAgIGxvZy53YXJuKHdhcm5pbmcpOwogICAgICAgICAg\nICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICBjYXNl\nIFdBUk5fTE9HX0VSUk9SOgogICAgICAgICAgICAgICAgICAgICAgICBpZiAo\nbG9nLmlzRXJyb3JFbmFibGVkKCkpCiAgICAgICAgICAgICAgICAgICAgICAg\nICAgICBsb2cuZXJyb3Iod2FybmluZyk7CiAgICAgICAgICAgICAgICAgICAg\nICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIGNhc2UgV0FSTl9USFJP\nVzoKICAgICAgICAgICAgICAgICAgICAgICAgLy8ganVzdCB0aHJvdyBpdCBh\ncyBpZiBpdCB3ZXJlIGEgU1FMRXhjZXB0aW9uCiAgICAgICAgICAgICAgICAg\nICAgICAgIHRocm93IHdhcm5pbmc7CiAgICAgICAgICAgICAgICAgICAgY2Fz\nZSBXQVJOX0hBTkRMRToKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKF93\nYXJuaW5nSGFuZGxlciAhPSBudWxsKQogICAgICAgICAgICAgICAgICAgICAg\nICAgICAgX3dhcm5pbmdIYW5kbGVyLmhhbmRsZVdhcm5pbmcod2FybmluZyk7\nCiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAg\nICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGln\nbm9yZQogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAg\nICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgLyoq\nCiAgICAgICAgICogTWV0YWRhdGEgd3JhcHBlciB0aGF0IGxvZ3MgYWN0aW9u\ncy4KICAgICAgICAgKi8KICAgICAgICBwcm90ZWN0ZWQgYWJzdHJhY3QgY2xh\nc3MgTG9nZ2luZ0RhdGFiYXNlTWV0YURhdGEKICAgICAgICAgICAgZXh0ZW5k\ncyBEZWxlZ2F0aW5nRGF0YWJhc2VNZXRhRGF0YSB7CgogICAgICAgICAgICBw\ndWJsaWMgTG9nZ2luZ0RhdGFiYXNlTWV0YURhdGEoRGF0YWJhc2VNZXRhRGF0\nYSBtZXRhKSB7CiAgICAgICAgICAgICAgICBzdXBlcihtZXRhLCBMb2dnaW5n\nQ29ubmVjdGlvbi50aGlzKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAg\ncHVibGljIFJlc3VsdFNldCBnZXRCZXN0Um93SWRlbnRpZmllcihTdHJpbmcg\nY2F0YWxvZywKICAgICAgICAgICAgICAgIFN0cmluZyBzY2hlbWEsIFN0cmlu\nZyB0YWJsZSwgaW50IHNjb3BlLCBib29sZWFuIG51bGxhYmxlKQogICAgICAg\nICAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgICAgICAg\nICBpZiAoX2xvZ3MuaXNKREJDRW5hYmxlZCgpKQogICAgICAgICAgICAgICAg\nICAgIF9sb2dzLmxvZ0pEQkMoImdldEJlc3RSb3dJZGVudGlmaWVyOiAiCiAg\nICAgICAgICAgICAgICAgICAgICAgICsgY2F0YWxvZyArICIsICIgKyBzY2hl\nbWEgKyAiLCAiICsgdGFibGUsCiAgICAgICAgICAgICAgICAgICAgICAgIExv\nZ2dpbmdDb25uZWN0aW9uLnRoaXMpOwogICAgICAgICAgICAgICAgcmV0dXJu\nIHN1cGVyLmdldEJlc3RSb3dJZGVudGlmaWVyKGNhdGFsb2csIHNjaGVtYSwK\nICAgICAgICAgICAgICAgICAgICB0YWJsZSwgc2NvcGUsIG51bGxhYmxlKTsK\nICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHVibGljIFJlc3VsdFNldCBn\nZXRDYXRhbG9ncygpIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgICAg\nICAgICAgaWYgKF9sb2dzLmlzSkRCQ0VuYWJsZWQoKSkKICAgICAgICAgICAg\nICAgICAgICBfbG9ncy5sb2dKREJDKCJnZXRDYXRhbG9ncyIsIExvZ2dpbmdD\nb25uZWN0aW9uLnRoaXMpOwogICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVy\nLmdldENhdGFsb2dzKCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHB1\nYmxpYyBSZXN1bHRTZXQgZ2V0Q29sdW1uUHJpdmlsZWdlcyhTdHJpbmcgY2F0\nYWxvZywgU3RyaW5nIHNjaGVtYSwKICAgICAgICAgICAgICAgIFN0cmluZyB0\nYWJsZSwgU3RyaW5nIGNvbHVtbk5hbWVQYXR0ZXJuKSB0aHJvd3MgU1FMRXhj\nZXB0aW9uIHsKICAgICAgICAgICAgICAgIGlmIChfbG9ncy5pc0pEQkNFbmFi\nbGVkKCkpCiAgICAgICAgICAgICAgICAgICAgX2xvZ3MubG9nSkRCQygiZ2V0\nQ29sdW1uUHJpdmlsZWdlczogIgogICAgICAgICAgICAgICAgICAgICAgICAr\nIGNhdGFsb2cgKyAiLCAiICsgc2NoZW1hICsgIiwgIiArIHRhYmxlLAogICAg\nICAgICAgICAgICAgICAgICAgICBMb2dnaW5nQ29ubmVjdGlvbi50aGlzKTsK\nICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5nZXRDb2x1bW5Qcml2aWxl\nZ2VzKGNhdGFsb2csIHNjaGVtYSwKICAgICAgICAgICAgICAgICAgICB0YWJs\nZSwgY29sdW1uTmFtZVBhdHRlcm4pOwogICAgICAgICAgICB9CgogICAgICAg\nICAgICBwdWJsaWMgUmVzdWx0U2V0IGdldENvbHVtbnMoU3RyaW5nIGNhdGFs\nb2csIFN0cmluZyBzY2hlbWFQYXR0ZXJuLAogICAgICAgICAgICAgICAgU3Ry\naW5nIHRhYmxlTmFtZVBhdHRlcm4sIFN0cmluZyBjb2x1bW5OYW1lUGF0dGVy\nbikKICAgICAgICAgICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAg\nICAgICAgICAgICAgaWYgKF9sb2dzLmlzSkRCQ0VuYWJsZWQoKSkKICAgICAg\nICAgICAgICAgICAgICBfbG9ncy5sb2dKREJDKCJnZXRDb2x1bW5zOiAiCiAg\nICAgICAgICAgICAgICAgICAgICAgICsgY2F0YWxvZyArICIsICIgKyBzY2hl\nbWFQYXR0ZXJuICsgIiwgIgogICAgICAgICAgICAgICAgICAgICAgICArIHRh\nYmxlTmFtZVBhdHRlcm4gKyAiLCAiICsgY29sdW1uTmFtZVBhdHRlcm4sCiAg\nICAgICAgICAgICAgICAgICAgICAgIExvZ2dpbmdDb25uZWN0aW9uLnRoaXMp\nOwogICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmdldENvbHVtbnMoY2F0\nYWxvZywgc2NoZW1hUGF0dGVybiwKICAgICAgICAgICAgICAgICAgICB0YWJs\nZU5hbWVQYXR0ZXJuLCBjb2x1bW5OYW1lUGF0dGVybik7CiAgICAgICAgICAg\nIH0KCiAgICAgICAgICAgIHB1YmxpYyBSZXN1bHRTZXQgZ2V0Q3Jvc3NSZWZl\ncmVuY2UoU3RyaW5nIHByaW1hcnlDYXRhbG9nLAogICAgICAgICAgICAgICAg\nU3RyaW5nIHByaW1hcnlTY2hlbWEsIFN0cmluZyBwcmltYXJ5VGFibGUsCiAg\nICAgICAgICAgICAgICBTdHJpbmcgZm9yZWlnbkNhdGFsb2csIFN0cmluZyBm\nb3JlaWduU2NoZW1hLAogICAgICAgICAgICAgICAgU3RyaW5nIGZvcmVpZ25U\nYWJsZSkgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgICAgICAgICBp\nZiAoX2xvZ3MuaXNKREJDRW5hYmxlZCgpKQogICAgICAgICAgICAgICAgICAg\nIF9sb2dzLmxvZ0pEQkMoImdldENyb3NzUmVmZXJlbmNlOiAiCiAgICAgICAg\nICAgICAgICAgICAgICAgICsgcHJpbWFyeUNhdGFsb2cgKyAiLCAiICsgcHJp\nbWFyeVNjaGVtYSArICIsICIKICAgICAgICAgICAgICAgICAgICAgICAgKyBw\ncmltYXJ5VGFibGUgKyAiLCAiICsgZm9yZWlnbkNhdGFsb2cgKyAiLCAiCiAg\nICAgICAgICAgICAgICAgICAgICAgICsgZm9yZWlnblNjaGVtYSArICIsICIg\nKyBmb3JlaWduU2NoZW1hLAogICAgICAgICAgICAgICAgICAgICAgICBMb2dn\naW5nQ29ubmVjdGlvbi50aGlzKTsKICAgICAgICAgICAgICAgIHJldHVybiBz\ndXBlci5nZXRDcm9zc1JlZmVyZW5jZShwcmltYXJ5Q2F0YWxvZywgcHJpbWFy\neVNjaGVtYSwKICAgICAgICAgICAgICAgICAgICBwcmltYXJ5VGFibGUsIGZv\ncmVpZ25DYXRhbG9nLCBmb3JlaWduU2NoZW1hLCBmb3JlaWduVGFibGUpOwog\nICAgICAgICAgICB9CgogICAgICAgICAgICBwdWJsaWMgUmVzdWx0U2V0IGdl\ndEV4cG9ydGVkS2V5cyhTdHJpbmcgY2F0YWxvZywgU3RyaW5nIHNjaGVtYSwK\nICAgICAgICAgICAgICAgIFN0cmluZyB0YWJsZSkgdGhyb3dzIFNRTEV4Y2Vw\ndGlvbiB7CiAgICAgICAgICAgICAgICBpZiAoX2xvZ3MuaXNKREJDRW5hYmxl\nZCgpKQogICAgICAgICAgICAgICAgICAgIF9sb2dzLmxvZ0pEQkMoImdldEV4\ncG9ydGVkS2V5czogIgogICAgICAgICAgICAgICAgICAgICAgICArIGNhdGFs\nb2cgKyAiLCAiICsgc2NoZW1hICsgIiwgIiArIHRhYmxlLAogICAgICAgICAg\nICAgICAgICAgICAgICBMb2dnaW5nQ29ubmVjdGlvbi50aGlzKTsKICAgICAg\nICAgICAgICAgIHJldHVybiBzdXBlci5nZXRFeHBvcnRlZEtleXMoY2F0YWxv\nZywgc2NoZW1hLCB0YWJsZSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAg\nIHB1YmxpYyBSZXN1bHRTZXQgZ2V0SW1wb3J0ZWRLZXlzKFN0cmluZyBjYXRh\nbG9nLCBTdHJpbmcgc2NoZW1hLAogICAgICAgICAgICAgICAgU3RyaW5nIHRh\nYmxlKSB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAgICAgICAgIGlm\nIChfbG9ncy5pc0pEQkNFbmFibGVkKCkpCiAgICAgICAgICAgICAgICAgICAg\nX2xvZ3MubG9nSkRCQygiZ2V0SW1wb3J0ZWRLZXlzOiAiCiAgICAgICAgICAg\nICAgICAgICAgICAgICsgY2F0YWxvZyArICIsICIgKyBzY2hlbWEgKyAiLCAi\nICsgdGFibGUsCiAgICAgICAgICAgICAgICAgICAgICAgIExvZ2dpbmdDb25u\nZWN0aW9uLnRoaXMpOwogICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmdl\ndEltcG9ydGVkS2V5cyhjYXRhbG9nLCBzY2hlbWEsIHRhYmxlKTsKICAgICAg\nICAgICAgfQoKICAgICAgICAgICAgcHVibGljIFJlc3VsdFNldCBnZXRJbmRl\neEluZm8oU3RyaW5nIGNhdGFsb2csIFN0cmluZyBzY2hlbWEsCiAgICAgICAg\nICAgICAgICBTdHJpbmcgdGFibGUsIGJvb2xlYW4gdW5pcXVlLCBib29sZWFu\nIGFwcHJveGltYXRlKQogICAgICAgICAgICAgICAgdGhyb3dzIFNRTEV4Y2Vw\ndGlvbiB7CiAgICAgICAgICAgICAgICBpZiAoX2xvZ3MuaXNKREJDRW5hYmxl\nZCgpKQogICAgICAgICAgICAgICAgICAgIF9sb2dzLmxvZ0pEQkMoImdldElu\nZGV4SW5mbzogIgogICAgICAgICAgICAgICAgICAgICAgICArIGNhdGFsb2cg\nKyAiLCAiICsgc2NoZW1hICsgIiwgIiArIHRhYmxlLAogICAgICAgICAgICAg\nICAgICAgICAgICBMb2dnaW5nQ29ubmVjdGlvbi50aGlzKTsKICAgICAgICAg\nICAgICAgIHJldHVybiBzdXBlci5nZXRJbmRleEluZm8oY2F0YWxvZywgc2No\nZW1hLCB0YWJsZSwgdW5pcXVlLAogICAgICAgICAgICAgICAgICAgIGFwcHJv\neGltYXRlKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHVibGljIFJl\nc3VsdFNldCBnZXRQcmltYXJ5S2V5cyhTdHJpbmcgY2F0YWxvZywgU3RyaW5n\nIHNjaGVtYSwKICAgICAgICAgICAgICAgIFN0cmluZyB0YWJsZSkgdGhyb3dz\nIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgICAgICAgICBpZiAoX2xvZ3MuaXNK\nREJDRW5hYmxlZCgpKQogICAgICAgICAgICAgICAgICAgIF9sb2dzLmxvZ0pE\nQkMoImdldFByaW1hcnlLZXlzOiAiCiAgICAgICAgICAgICAgICAgICAgICAg\nICsgY2F0YWxvZyArICIsICIgKyBzY2hlbWEgKyAiLCAiICsgdGFibGUsCiAg\nICAgICAgICAgICAgICAgICAgICAgIExvZ2dpbmdDb25uZWN0aW9uLnRoaXMp\nOwogICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmdldFByaW1hcnlLZXlz\nKGNhdGFsb2csIHNjaGVtYSwgdGFibGUpOwogICAgICAgICAgICB9CgogICAg\nICAgICAgICBwdWJsaWMgUmVzdWx0U2V0IGdldFByb2NlZHVyZUNvbHVtbnMo\nU3RyaW5nIGNhdGFsb2csCiAgICAgICAgICAgICAgICBTdHJpbmcgc2NoZW1h\nUGF0dGVybiwgU3RyaW5nIHByb2NlZHVyZU5hbWVQYXR0ZXJuLAogICAgICAg\nICAgICAgICAgU3RyaW5nIGNvbHVtbk5hbWVQYXR0ZXJuKSB0aHJvd3MgU1FM\nRXhjZXB0aW9uIHsKICAgICAgICAgICAgICAgIGlmIChfbG9ncy5pc0pEQkNF\nbmFibGVkKCkpCiAgICAgICAgICAgICAgICAgICAgX2xvZ3MubG9nSkRCQygi\nZ2V0UHJvY2VkdXJlQ29sdW1uczogIgogICAgICAgICAgICAgICAgICAgICAg\nICArIGNhdGFsb2cgKyAiLCAiICsgc2NoZW1hUGF0dGVybiArICIsICIKICAg\nICAgICAgICAgICAgICAgICAgICAgKyBwcm9jZWR1cmVOYW1lUGF0dGVybiAr\nICIsICIgKyBjb2x1bW5OYW1lUGF0dGVybiwKICAgICAgICAgICAgICAgICAg\nICAgICAgTG9nZ2luZ0Nvbm5lY3Rpb24udGhpcyk7CiAgICAgICAgICAgICAg\nICByZXR1cm4gc3VwZXIuZ2V0UHJvY2VkdXJlQ29sdW1ucyhjYXRhbG9nLCBz\nY2hlbWFQYXR0ZXJuLAogICAgICAgICAgICAgICAgICAgIHByb2NlZHVyZU5h\nbWVQYXR0ZXJuLCBjb2x1bW5OYW1lUGF0dGVybik7CiAgICAgICAgICAgIH0K\nCiAgICAgICAgICAgIHB1YmxpYyBSZXN1bHRTZXQgZ2V0UHJvY2VkdXJlcyhT\ndHJpbmcgY2F0YWxvZywKICAgICAgICAgICAgICAgIFN0cmluZyBzY2hlbWFQ\nYXR0ZXJuLCBTdHJpbmcgcHJvY2VkdXJlTmFtZVBhdHRlcm4pCiAgICAgICAg\nICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAgICAgICAg\nIGlmIChfbG9ncy5pc0pEQkNFbmFibGVkKCkpCiAgICAgICAgICAgICAgICAg\nICAgX2xvZ3MubG9nSkRCQygiZ2V0UHJvY2VkdXJlczogIgogICAgICAgICAg\nICAgICAgICAgICAgICArIGNhdGFsb2cgKyAiLCAiICsgc2NoZW1hUGF0dGVy\nbiArICIsICIKICAgICAgICAgICAgICAgICAgICAgICAgKyBwcm9jZWR1cmVO\nYW1lUGF0dGVybiwgTG9nZ2luZ0Nvbm5lY3Rpb24udGhpcyk7CiAgICAgICAg\nICAgICAgICByZXR1cm4gc3VwZXIuZ2V0UHJvY2VkdXJlcyhjYXRhbG9nLCBz\nY2hlbWFQYXR0ZXJuLAogICAgICAgICAgICAgICAgICAgIHByb2NlZHVyZU5h\nbWVQYXR0ZXJuKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHVibGlj\nIFJlc3VsdFNldCBnZXRTY2hlbWFzKCkgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7\nCiAgICAgICAgICAgICAgICBpZiAoX2xvZ3MuaXNKREJDRW5hYmxlZCgpKQog\nICAgICAgICAgICAgICAgICAgIF9sb2dzLmxvZ0pEQkMoImdldFNjaGVtYXMi\nLCBMb2dnaW5nQ29ubmVjdGlvbi50aGlzKTsKICAgICAgICAgICAgICAgIHJl\ndHVybiBzdXBlci5nZXRTY2hlbWFzKCk7CiAgICAgICAgICAgIH0KCiAgICAg\nICAgICAgIHB1YmxpYyBSZXN1bHRTZXQgZ2V0VGFibGVQcml2aWxlZ2VzKFN0\ncmluZyBjYXRhbG9nLAogICAgICAgICAgICAgICAgU3RyaW5nIHNjaGVtYVBh\ndHRlcm4sIFN0cmluZyB0YWJsZU5hbWVQYXR0ZXJuKQogICAgICAgICAgICAg\nICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgICAgICAgICBpZiAo\nX2xvZ3MuaXNKREJDRW5hYmxlZCgpKQogICAgICAgICAgICAgICAgICAgIF9s\nb2dzLmxvZ0pEQkMoImdldFRhYmxlUHJpdmlsZWdlcyIsIExvZ2dpbmdDb25u\nZWN0aW9uLnRoaXMpOwogICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmdl\ndFRhYmxlUHJpdmlsZWdlcyhjYXRhbG9nLCBzY2hlbWFQYXR0ZXJuLAogICAg\nICAgICAgICAgICAgICAgIHRhYmxlTmFtZVBhdHRlcm4pOwogICAgICAgICAg\nICB9CgogICAgICAgICAgICBwdWJsaWMgUmVzdWx0U2V0IGdldFRhYmxlcyhT\ndHJpbmcgY2F0YWxvZywgU3RyaW5nIHNjaGVtYVBhdHRlcm4sCiAgICAgICAg\nICAgICAgICBTdHJpbmcgdGFibGVOYW1lUGF0dGVybiwgU3RyaW5nW10gdHlw\nZXMpIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgICAgICAgICAgaWYg\nKF9sb2dzLmlzSkRCQ0VuYWJsZWQoKSkKICAgICAgICAgICAgICAgICAgICBf\nbG9ncy5sb2dKREJDKCJnZXRUYWJsZXM6ICIKICAgICAgICAgICAgICAgICAg\nICAgICAgKyBjYXRhbG9nICsgIiwgIiArIHNjaGVtYVBhdHRlcm4gKyAiLCAi\nCiAgICAgICAgICAgICAgICAgICAgICAgICsgdGFibGVOYW1lUGF0dGVybiwg\nTG9nZ2luZ0Nvbm5lY3Rpb24udGhpcyk7CiAgICAgICAgICAgICAgICByZXR1\ncm4gc3VwZXIuZ2V0VGFibGVzKGNhdGFsb2csIHNjaGVtYVBhdHRlcm4sCiAg\nICAgICAgICAgICAgICAgICAgdGFibGVOYW1lUGF0dGVybiwgdHlwZXMpOwog\nICAgICAgICAgICB9CgogICAgICAgICAgICBwdWJsaWMgUmVzdWx0U2V0IGdl\ndFRhYmxlVHlwZXMoKSB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAg\nICAgICAgIGlmIChfbG9ncy5pc0pEQkNFbmFibGVkKCkpCiAgICAgICAgICAg\nICAgICAgICAgX2xvZ3MubG9nSkRCQygiZ2V0VGFibGVUeXBlcyIsIExvZ2dp\nbmdDb25uZWN0aW9uLnRoaXMpOwogICAgICAgICAgICAgICAgcmV0dXJuIHN1\ncGVyLmdldFRhYmxlVHlwZXMoKTsKICAgICAgICAgICAgfQoKICAgICAgICAg\nICAgcHVibGljIFJlc3VsdFNldCBnZXRUeXBlSW5mbygpIHRocm93cyBTUUxF\neGNlcHRpb24gewogICAgICAgICAgICAgICAgaWYgKF9sb2dzLmlzSkRCQ0Vu\nYWJsZWQoKSkKICAgICAgICAgICAgICAgICAgICBfbG9ncy5sb2dKREJDKCJn\nZXRUeXBlSW5mbyIsIExvZ2dpbmdDb25uZWN0aW9uLnRoaXMpOwogICAgICAg\nICAgICAgICAgcmV0dXJuIHN1cGVyLmdldFR5cGVJbmZvKCk7CiAgICAgICAg\nICAgIH0KCiAgICAgICAgICAgIHB1YmxpYyBSZXN1bHRTZXQgZ2V0VURUcyhT\ndHJpbmcgY2F0YWxvZywgU3RyaW5nIHNjaGVtYVBhdHRlcm4sCiAgICAgICAg\nICAgICAgICBTdHJpbmcgdHlwZU5hbWVQYXR0ZXJuLCBpbnRbXSB0eXBlcykg\ndGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgICAgICAgICBpZiAoX2xv\nZ3MuaXNKREJDRW5hYmxlZCgpKQogICAgICAgICAgICAgICAgICAgIF9sb2dz\nLmxvZ0pEQkMoImdldFVEVHMiLCBMb2dnaW5nQ29ubmVjdGlvbi50aGlzKTsK\nICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5nZXRVRFRzKGNhdGFsb2cs\nIHNjaGVtYVBhdHRlcm4sCiAgICAgICAgICAgICAgICAgICAgdHlwZU5hbWVQ\nYXR0ZXJuLCB0eXBlcyk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHB1\nYmxpYyBSZXN1bHRTZXQgZ2V0VmVyc2lvbkNvbHVtbnMoU3RyaW5nIGNhdGFs\nb2csCiAgICAgICAgICAgICAgICBTdHJpbmcgc2NoZW1hLCBTdHJpbmcgdGFi\nbGUpIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgICAgICAgICAgaWYg\nKF9sb2dzLmlzSkRCQ0VuYWJsZWQoKSkKICAgICAgICAgICAgICAgICAgICBf\nbG9ncy5sb2dKREJDKCJnZXRWZXJzaW9uQ29sdW1uczogIgogICAgICAgICAg\nICAgICAgICAgICAgICArIGNhdGFsb2cgKyAiLCAiICsgc2NoZW1hICsgIiwg\nIiArIHRhYmxlLAogICAgICAgICAgICAgICAgICAgICAgICBMb2dnaW5nQ29u\nbmVjdGlvbi50aGlzKTsKICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5n\nZXRWZXJzaW9uQ29sdW1ucyhjYXRhbG9nLCBzY2hlbWEsIHRhYmxlKTsKICAg\nICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgLyoqCiAgICAgICAgICog\nU3RhdGVtZW50IHdyYXBwZXIgdGhhdCBsb2dzIFNRTCB0byB0aGUgcGFyZW50\nIGRhdGEgc291cmNlIGFuZAogICAgICAgICAqIHJlbWVtYmVycyB0aGUgbGFz\ndCBwaWVjZSBvZiBTUUwgdG8gYmUgZXhlY3V0ZWQgb24gaXQuCiAgICAgICAg\nICovCiAgICAgICAgcHJvdGVjdGVkIGFic3RyYWN0IGNsYXNzIExvZ2dpbmdT\ndGF0ZW1lbnQgZXh0ZW5kcyBEZWxlZ2F0aW5nU3RhdGVtZW50IHsKCiAgICAg\nICAgICAgIHByaXZhdGUgU3RyaW5nIF9zcWwgPSBudWxsOwoKICAgICAgICAg\nICAgcHVibGljIExvZ2dpbmdTdGF0ZW1lbnQoU3RhdGVtZW50IHN0bW50KSB0\naHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAgICAgICAgIHN1cGVyKHN0\nbW50LCBMb2dnaW5nQ29ubmVjdGlvbi50aGlzKTsKICAgICAgICAgICAgfQoK\nICAgICAgICAgICAgcHJpdmF0ZSBMb2dnaW5nUmVzdWx0U2V0IG5ld0xvZ2dp\nbmdSZXN1bHRTZXQoUmVzdWx0U2V0IHJzLCBTdGF0ZW1lbnQgc3RtbnQpIHsK\nICAgICAgICAgICAgICAgIHJldHVybiBDb25jcmV0ZUNsYXNzR2VuZXJhdG9y\nLm5ld0luc3RhbmNlKGxvZ2dpbmdSZXN1bHRTZXRJbXBsLCBMb2dnaW5nQ29u\nbmVjdGlvbi50aGlzLCBycywgc3RtbnQpOwogICAgICAgICAgICB9CgogICAg\nICAgICAgICBwdWJsaWMgdm9pZCBhcHBlbmRJbmZvKFN0cmluZ0J1ZmZlciBi\ndWYpIHsKICAgICAgICAgICAgICAgIGlmIChfc3FsICE9IG51bGwpIHsKICAg\nICAgICAgICAgICAgICAgICBidWYuYXBwZW5kKCIgIik7CiAgICAgICAgICAg\nICAgICAgICAgaWYgKF9mb3JtYXR0ZXIgIT0gbnVsbCkgewogICAgICAgICAg\nICAgICAgICAgICAgICBidWYuYXBwZW5kKFNFUCk7CiAgICAgICAgICAgICAg\nICAgICAgICAgIGJ1Zi5hcHBlbmQoX2Zvcm1hdHRlci5wcmV0dHlQcmludChf\nc3FsKSk7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAg\nICAgICAgICAgICAgICAgYnVmLmFwcGVuZChfc3FsKTsKICAgICAgICAgICAg\nICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAg\nICAgICAgICAgIHByb3RlY3RlZCBSZXN1bHRTZXQgd3JhcFJlc3VsdChSZXN1\nbHRTZXQgcnMsIGJvb2xlYW4gd3JhcCkgewogICAgICAgICAgICAgICAgaWYg\nKCF3cmFwIHx8IHJzID09IG51bGwpCiAgICAgICAgICAgICAgICAgICAgcmV0\ndXJuIHN1cGVyLndyYXBSZXN1bHQocnMsIHdyYXApOwogICAgICAgICAgICAg\nICAgcmV0dXJuIG5ld0xvZ2dpbmdSZXN1bHRTZXQocnMsIHRoaXMpOwogICAg\nICAgICAgICB9CgogICAgICAgICAgICBwdWJsaWMgdm9pZCBjYW5jZWwoKSB0\naHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAgICAgICAgIGlmIChfbG9n\ncy5pc0pEQkNFbmFibGVkKCkpCiAgICAgICAgICAgICAgICAgICAgX2xvZ3Mu\nbG9nSkRCQygiY2FuY2VsICIgKyB0aGlzLCBMb2dnaW5nQ29ubmVjdGlvbi50\naGlzKTsKICAgICAgICAgICAgICAgIHN1cGVyLmNhbmNlbCgpOwogICAgICAg\nICAgICB9CgogICAgICAgICAgICBwcm90ZWN0ZWQgUmVzdWx0U2V0IGV4ZWN1\ndGVRdWVyeShTdHJpbmcgc3FsLCBib29sZWFuIHdyYXApCiAgICAgICAgICAg\nICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAgICAgICAgIF9z\ncWwgPSBzcWw7CiAgICAgICAgICAgICAgICBsb2dTUUwodGhpcyk7CiAgICAg\nICAgICAgICAgICBsb25nIHN0YXJ0ID0gU3lzdGVtLmN1cnJlbnRUaW1lTWls\nbGlzKCk7CiAgICAgICAgICAgICAgICBTUUxFeGNlcHRpb24gZXJyID0gbnVs\nbDsKICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAg\ncmV0dXJuIHN1cGVyLmV4ZWN1dGVRdWVyeShzcWwsIHdyYXApOwogICAgICAg\nICAgICAgICAgfSBjYXRjaCAoU1FMRXhjZXB0aW9uIHNlKSB7ICAgICAgICAg\nICAgICAgCQogICAgICAgICAgICAgICAgICAgIGVyciA9IHdyYXAoc2UsIExv\nZ2dpbmdTdGF0ZW1lbnQudGhpcywgc3FsKTsKICAgICAgICAgICAgICAgICAg\nICB0aHJvdyBlcnI7CiAgICAgICAgICAgICAgICB9IGZpbmFsbHkgewogICAg\nICAgICAgICAgICAgICAgIGxvZ1RpbWUoc3RhcnQpOwogICAgICAgICAgICAg\nICAgICAgIGhhbmRsZVNRTEVycm9ycyhMb2dnaW5nU3RhdGVtZW50LnRoaXMs\nIGVycik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAg\nICAgICAgIHB1YmxpYyBpbnQgZXhlY3V0ZVVwZGF0ZShTdHJpbmcgc3FsKSB0\naHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAgICAgICAgIF9zcWwgPSBz\ncWw7CiAgICAgICAgICAgICAgICBsb2dTUUwodGhpcyk7CiAgICAgICAgICAg\nICAgICBsb25nIHN0YXJ0ID0gU3lzdGVtLmN1cnJlbnRUaW1lTWlsbGlzKCk7\nCiAgICAgICAgICAgICAgICBTUUxFeGNlcHRpb24gZXJyID0gbnVsbDsKICAg\nICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJu\nIHN1cGVyLmV4ZWN1dGVVcGRhdGUoc3FsKTsKICAgICAgICAgICAgICAgIH0g\nY2F0Y2ggKFNRTEV4Y2VwdGlvbiBzZSkgeyAgICAgICAgICAgICAgICAJCiAg\nICAgICAgICAgICAgICAgICAgZXJyID0gd3JhcChzZSwgTG9nZ2luZ1N0YXRl\nbWVudC50aGlzLCBzcWwpOwogICAgICAgICAgICAgICAgICAgIHRocm93IGVy\ncjsKICAgICAgICAgICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgICAg\nICAgICAgbG9nVGltZShzdGFydCk7CiAgICAgICAgICAgICAgICAgICAgaGFu\nZGxlU1FMRXJyb3JzKExvZ2dpbmdTdGF0ZW1lbnQudGhpcywgZXJyKTsKICAg\nICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHVi\nbGljIGJvb2xlYW4gZXhlY3V0ZShTdHJpbmcgc3FsKSB0aHJvd3MgU1FMRXhj\nZXB0aW9uIHsKICAgICAgICAgICAgICAgIF9zcWwgPSBzcWw7CiAgICAgICAg\nICAgICAgICBsb2dTUUwodGhpcyk7CiAgICAgICAgICAgICAgICBsb25nIHN0\nYXJ0ID0gU3lzdGVtLmN1cnJlbnRUaW1lTWlsbGlzKCk7CiAgICAgICAgICAg\nICAgICBTUUxFeGNlcHRpb24gZXJyID0gbnVsbDsKICAgICAgICAgICAgICAg\nIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmV4ZWN1\ndGUoc3FsKTsKICAgICAgICAgICAgICAgIH0gY2F0Y2ggKFNRTEV4Y2VwdGlv\nbiBzZSkgewogICAgICAgICAgICAgICAgICAgIGVyciA9IHdyYXAoc2UsIExv\nZ2dpbmdTdGF0ZW1lbnQudGhpcywgc3FsKTsKICAgICAgICAgICAgICAgICAg\nICB0aHJvdyBlcnI7CiAgICAgICAgICAgICAgICB9IGZpbmFsbHkgewogICAg\nICAgICAgICAgICAgICAgIGxvZ1RpbWUoc3RhcnQpOwogICAgICAgICAgICAg\nICAgICAgIGhhbmRsZVNRTEVycm9ycyhMb2dnaW5nU3RhdGVtZW50LnRoaXMs\nIGVycik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAg\nICB9CgogICAgICAgIHByb3RlY3RlZCBhYnN0cmFjdCBjbGFzcyBMb2dnaW5n\nUHJlcGFyZWRTdGF0ZW1lbnQKICAgICAgICAgICAgZXh0ZW5kcyBEZWxlZ2F0\naW5nUHJlcGFyZWRTdGF0ZW1lbnQgewoKICAgICAgICAgICAgcHJpdmF0ZSBm\naW5hbCBTdHJpbmcgX3NxbDsKICAgICAgICAgICAgcHJpdmF0ZSBMaXN0PFN0\ncmluZz4gX3BhcmFtcyA9IG51bGw7CiAgICAgICAgICAgIHByaXZhdGUgTGlz\ndDxMaXN0PFN0cmluZz4+IF9wYXJhbUJhdGNoID0gbnVsbDsKICAgICAgICAg\nICAgLy8gV2hlbiBiYXRjaGluZyBpcyB1c2VkLCB0aGlzIHZhcmlhYmxlIGNv\nbnRhaW5zIHRoZSBpbmRleCBpbnRvIHRoZQogICAgICAgICAgICAvLyBsYXN0\nIHN1Y2Nlc3NmdWxseSBleGVjdXRlZCBiYXRjaGVkIHN0YXRlbWVudC4KICAg\nICAgICAgICAgaW50IGJhdGNoZWRSb3dzQmFzZUluZGV4ID0gMDsKCiAgICAg\nICAgICAgIHB1YmxpYyBMb2dnaW5nUHJlcGFyZWRTdGF0ZW1lbnQoUHJlcGFy\nZWRTdGF0ZW1lbnQgc3RtbnQsIFN0cmluZyBzcWwpCiAgICAgICAgICAgICAg\nICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAgICAgICAgIHN1cGVy\nKHN0bW50LCBMb2dnaW5nQ29ubmVjdGlvbi50aGlzKTsKICAgICAgICAgICAg\nICAgIF9zcWwgPSBzcWw7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHBy\naXZhdGUgTG9nZ2luZ1Jlc3VsdFNldCBuZXdMb2dnaW5nUmVzdWx0U2V0KFJl\nc3VsdFNldCBycywKICAgICAgICAgICAgICAgIFByZXBhcmVkU3RhdGVtZW50\nIHN0bW50KSB7CiAgICAgICAgICAgICAgICByZXR1cm4gQ29uY3JldGVDbGFz\nc0dlbmVyYXRvci4KICAgICAgICAgICAgICAgICAgICBuZXdJbnN0YW5jZShs\nb2dnaW5nUmVzdWx0U2V0SW1wbCwKICAgICAgICAgICAgICAgICAgICBMb2dn\naW5nQ29ubmVjdGlvbi5jbGFzcywgTG9nZ2luZ0Nvbm5lY3Rpb24udGhpcywK\nICAgICAgICAgICAgICAgICAgICBSZXN1bHRTZXQuY2xhc3MsIHJzLAogICAg\nICAgICAgICAgICAgICAgIFByZXBhcmVkU3RhdGVtZW50LmNsYXNzLCBzdG1u\ndCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHByb3RlY3RlZCBSZXN1\nbHRTZXQgd3JhcFJlc3VsdChSZXN1bHRTZXQgcnMsIGJvb2xlYW4gd3JhcCkg\newogICAgICAgICAgICAgICAgaWYgKCF3cmFwIHx8IHJzID09IG51bGwpCiAg\nICAgICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLndyYXBSZXN1bHQocnMs\nIHdyYXApOwogICAgICAgICAgICAgICAgcmV0dXJuIG5ld0xvZ2dpbmdSZXN1\nbHRTZXQocnMsIHRoaXMpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBw\ncm90ZWN0ZWQgUmVzdWx0U2V0IGV4ZWN1dGVRdWVyeShTdHJpbmcgc3FsLCBi\nb29sZWFuIHdyYXApCiAgICAgICAgICAgICAgICB0aHJvd3MgU1FMRXhjZXB0\naW9uIHsKICAgICAgICAgICAgICAgIGxvZ1NRTCh0aGlzKTsKICAgICAgICAg\nICAgICAgIGxvbmcgc3RhcnQgPSBTeXN0ZW0uY3VycmVudFRpbWVNaWxsaXMo\nKTsKICAgICAgICAgICAgICAgIFNRTEV4Y2VwdGlvbiBlcnIgPSBudWxsOwog\nICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICByZXR1\ncm4gc3VwZXIuZXhlY3V0ZVF1ZXJ5KHNxbCwgd3JhcCk7CiAgICAgICAgICAg\nICAgICB9IGNhdGNoIChTUUxFeGNlcHRpb24gc2UpIHsKICAgICAgICAgICAg\nICAgICAgICBlcnIgPSB3cmFwKHNlLCBMb2dnaW5nUHJlcGFyZWRTdGF0ZW1l\nbnQudGhpcywgc3FsKTsKICAgICAgICAgICAgICAgICAgICB0aHJvdyBlcnI7\nCiAgICAgICAgICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICAgICAg\nICAgIGxvZ1RpbWUoc3RhcnQpOwogICAgICAgICAgICAgICAgICAgIGNsZWFy\nTG9nUGFyYW1ldGVycyh0cnVlKTsKICAgICAgICAgICAgICAgICAgICBoYW5k\nbGVTUUxFcnJvcnMoTG9nZ2luZ1ByZXBhcmVkU3RhdGVtZW50LnRoaXMsIGVy\ncik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAg\nICAgIHB1YmxpYyBpbnQgZXhlY3V0ZVVwZGF0ZShTdHJpbmcgc3FsKSB0aHJv\nd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAgICAgICAgIGxvZ1NRTCh0aGlz\nKTsKICAgICAgICAgICAgICAgIGxvbmcgc3RhcnQgPSBTeXN0ZW0uY3VycmVu\ndFRpbWVNaWxsaXMoKTsKICAgICAgICAgICAgICAgIFNRTEV4Y2VwdGlvbiBl\ncnIgPSBudWxsOwogICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAg\nICAgICAgICByZXR1cm4gc3VwZXIuZXhlY3V0ZVVwZGF0ZShzcWwpOwogICAg\nICAgICAgICAgICAgfSBjYXRjaCAoU1FMRXhjZXB0aW9uIHNlKSB7CiAgICAg\nICAgICAgICAgICAgICAgZXJyID0gIHdyYXAoc2UsIExvZ2dpbmdQcmVwYXJl\nZFN0YXRlbWVudC50aGlzLCBzcWwpOwogICAgICAgICAgICAgICAgICAgIHRo\ncm93IGVycjsKICAgICAgICAgICAgICAgIH0gZmluYWxseSB7CiAgICAgICAg\nICAgICAgICAgICAgbG9nVGltZShzdGFydCk7CiAgICAgICAgICAgICAgICAg\nICAgY2xlYXJMb2dQYXJhbWV0ZXJzKHRydWUpOwogICAgICAgICAgICAgICAg\nICAgIGhhbmRsZVNRTEVycm9ycyhMb2dnaW5nUHJlcGFyZWRTdGF0ZW1lbnQu\ndGhpcywgZXJyKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoK\nICAgICAgICAgICAgcHVibGljIGJvb2xlYW4gZXhlY3V0ZShTdHJpbmcgc3Fs\nKSB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAgICAgICAgIGxvZ1NR\nTCh0aGlzKTsKICAgICAgICAgICAgICAgIGxvbmcgc3RhcnQgPSBTeXN0ZW0u\nY3VycmVudFRpbWVNaWxsaXMoKTsKICAgICAgICAgICAgICAgIFNRTEV4Y2Vw\ndGlvbiBlcnIgPSBudWxsOwogICAgICAgICAgICAgICAgdHJ5IHsKICAgICAg\nICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZXhlY3V0ZShzcWwpOwogICAg\nICAgICAgICAgICAgfSBjYXRjaCAoU1FMRXhjZXB0aW9uIHNlKSB7CiAgICAg\nICAgICAgICAgICAgICAgZXJyID0gd3JhcChzZSwgTG9nZ2luZ1ByZXBhcmVk\nU3RhdGVtZW50LnRoaXMsIHNxbCk7CiAgICAgICAgICAgICAgICAgICAgdGhy\nb3cgZXJyOwogICAgICAgICAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAg\nICAgICAgICAgICBsb2dUaW1lKHN0YXJ0KTsKICAgICAgICAgICAgICAgICAg\nICBjbGVhckxvZ1BhcmFtZXRlcnModHJ1ZSk7CiAgICAgICAgICAgICAgICAg\nICAgaGFuZGxlU1FMRXJyb3JzKExvZ2dpbmdQcmVwYXJlZFN0YXRlbWVudC50\naGlzLCBlcnIpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9Cgog\nICAgICAgICAgICBwcm90ZWN0ZWQgUmVzdWx0U2V0IGV4ZWN1dGVRdWVyeShi\nb29sZWFuIHdyYXApIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgICAg\nICAgICAgbG9nU1FMKHRoaXMpOwogICAgICAgICAgICAgICAgbG9uZyBzdGFy\ndCA9IFN5c3RlbS5jdXJyZW50VGltZU1pbGxpcygpOwogICAgICAgICAgICAg\nICAgU1FMRXhjZXB0aW9uIGVyciA9IG51bGw7CiAgICAgICAgICAgICAgICB0\ncnkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5leGVjdXRl\nUXVlcnkod3JhcCk7CiAgICAgICAgICAgICAgICB9IGNhdGNoIChTUUxFeGNl\ncHRpb24gc2UpIHsKICAgICAgICAgICAgICAgICAgICBlcnIgPSB3cmFwKHNl\nLCBMb2dnaW5nUHJlcGFyZWRTdGF0ZW1lbnQudGhpcywgX3NxbCk7CiAgICAg\nICAgICAgICAgICAgICAgdGhyb3cgZXJyOwogICAgICAgICAgICAgICAgfSBm\naW5hbGx5IHsKICAgICAgICAgICAgICAgICAgICBsb2dUaW1lKHN0YXJ0KTsK\nICAgICAgICAgICAgICAgICAgICBjbGVhckxvZ1BhcmFtZXRlcnModHJ1ZSk7\nCiAgICAgICAgICAgICAgICAgICAgaGFuZGxlU1FMRXJyb3JzKExvZ2dpbmdQ\ncmVwYXJlZFN0YXRlbWVudC50aGlzLCBlcnIpOwogICAgICAgICAgICAgICAg\nfQogICAgICAgICAgICB9CgogICAgICAgICAgICBwdWJsaWMgaW50IGV4ZWN1\ndGVVcGRhdGUoKSB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAgICAg\nICAgIGxvZ1NRTCh0aGlzKTsKICAgICAgICAgICAgICAgIGxvbmcgc3RhcnQg\nPSBTeXN0ZW0uY3VycmVudFRpbWVNaWxsaXMoKTsKICAgICAgICAgICAgICAg\nIFNRTEV4Y2VwdGlvbiBlcnIgPSBudWxsOwogICAgICAgICAgICAgICAgdHJ5\nIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZXhlY3V0ZVVw\nZGF0ZSgpOwogICAgICAgICAgICAgICAgfSBjYXRjaCAoU1FMRXhjZXB0aW9u\nIHNlKSB7CiAgICAgICAgICAgICAgICAgICAgZXJyID0gd3JhcChzZSwgTG9n\nZ2luZ1ByZXBhcmVkU3RhdGVtZW50LnRoaXMpOwogICAgICAgICAgICAgICAg\nICAgIHRocm93IGVycjsKICAgICAgICAgICAgICAgIH0gZmluYWxseSB7CiAg\nICAgICAgICAgICAgICAgICAgbG9nVGltZShzdGFydCk7CiAgICAgICAgICAg\nICAgICAgICAgY2xlYXJMb2dQYXJhbWV0ZXJzKHRydWUpOwogICAgICAgICAg\nICAgICAgICAgIGhhbmRsZVNRTEVycm9ycyhMb2dnaW5nUHJlcGFyZWRTdGF0\nZW1lbnQudGhpcywgZXJyKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAg\nICAgfQoKICAgICAgICAgICAgcHVibGljIGludFtdIGV4ZWN1dGVCYXRjaCgp\nIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgICAgICAgICAgaW50IGlu\nZGV4T2ZGaXJzdEZhaWxlZE9iamVjdCA9IC0xOwoKICAgICAgICAgICAgICAg\nIGxvZ0JhdGNoU1FMKHRoaXMpOwogICAgICAgICAgICAgICAgbG9uZyBzdGFy\ndCA9IFN5c3RlbS5jdXJyZW50VGltZU1pbGxpcygpOwogICAgICAgICAgICAg\nICAgU1FMRXhjZXB0aW9uIGVyciA9IG51bGw7CiAgICAgICAgICAgICAgICB0\ncnkgewogICAgICAgICAgICAgICAgICAgIGludFtdIHRvUmV0dXJuID0gc3Vw\nZXIuZXhlY3V0ZUJhdGNoKCk7CiAgICAgICAgICAgICAgICAgICAgLy9leGVj\ndXRlQmF0Y2ggaXMgY2FsbGVkIGFueSB0aW1lIHRoZSBudW1iZXIgb2YgYmF0\nY2hlZCBzdGF0ZW1lbnRzCiAgICAgICAgICAgICAgICAgICAgLy9pcyBlcXVh\nbCB0bywgb3IgbGVzcyB0aGFuLCBiYXRjaExpbWl0LiAgSW4gdGhlICdjYXRj\naCcgYmxvY2sgYmVsb3csCiAgICAgICAgICAgICAgICAgICAgLy90aGUgbG9n\naWMgc2Vla3MgdG8gZmluZCBhbiBpbmRleCBiYXNlZCBvbiB0aGUgY3VycmVu\ndCBleGVjdXRlQmF0Y2gKICAgICAgICAgICAgICAgICAgICAvL3Jlc3VsdHMu\nICBUaGlzIGlzIGZpbmUgd2hlbiBleGVjdXRlQmF0Y2ggaXMgb25seSBjYWxs\nZWQgb25jZSwgYnV0CiAgICAgICAgICAgICAgICAgICAgLy9pZiBleGVjdXRl\nQmF0Y2ggaXMgY2FsbGVkIG1hbnkgdGltZXMsIHRoZSBfcGFyYW1zQmF0Y2gg\nd2lsbCBjb250aW51ZQogICAgICAgICAgICAgICAgICAgIC8vdG8gZ3Jvdywg\nYXMgc3VjaCwgdG8gaW5kZXggaW50byBfcGFyYW1zQmF0Y2gsIHdlIG5lZWQg\ndG8gdGFrZSBpbnRvCiAgICAgICAgICAgICAgICAgICAgLy9hY2NvdW50IHRo\nZSBudW1iZXIgb2YgdGltZXMgZXhlY3V0ZUJhdGNoIGlzIGNhbGxlZCBpbiBv\nciBkZXIgdG8KICAgICAgICAgICAgICAgICAgICAvL2NvcnJlY3RseSBpbmRl\neCBpbnRvIF9wYXJhbXNCYXRjaC4gIFRvIHRoYXQgZW5kLCBlYWNoIHRpbWUg\nZXhlY3V0ZUJhdGNoCiAgICAgICAgICAgICAgICAgICAgLy9pcyBjYWxsZWQs\nIGxldHMgZ2V0IHRoZSBzaXplIG9mIF9wYXJhbUJhdGNoLiAgVGhpcyB3aWxs\nIGVmZmVjdGl2ZWx5CiAgICAgICAgICAgICAgICAgICAgLy90ZWxsIHVzIHRo\nZSBpbmRleCBvZiB0aGUgbGFzdCBzdWNjZXNzZnVsbHkgZXhlY3V0ZWQgYmF0\nY2ggc3RhdGVtZW50LgogICAgICAgICAgICAgICAgICAgIC8vSWYgYW4gZXhj\nZXB0aW9uIGlzIGNhdXNlZCwgdGhlbiB3ZSBrbm93IHRoYXQgX3BhcmFtQmF0\nY2guc2l6ZSB3YXMKICAgICAgICAgICAgICAgICAgICAvL3RoZSBpbmRleCBv\nZiB0aGUgTEFTVCByb3cgdG8gc3VjY2Vzc2Z1bGx5IGV4ZWN1dGUuCiAgICAg\nICAgICAgICAgICAgICAgaWYgKF9wYXJhbUJhdGNoICE9IG51bGwpewogICAg\nICAgICAgICAgICAgICAgICAgICBiYXRjaGVkUm93c0Jhc2VJbmRleCA9IF9w\nYXJhbUJhdGNoLnNpemUoKTsgICAgICAgICAgICAKICAgICAgICAgICAgICAg\nICAgICB9CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRvUmV0dXJuOwog\nICAgICAgICAgICAgICAgfSBjYXRjaCAoU1FMRXhjZXB0aW9uIHNlKSB7CiAg\nICAgICAgICAgICAgICAgICAgLy8gaWYgdGhlIGV4Y2VwdGlvbiBpcyBhIEJh\ndGNoVXBkYXRlRXhjZXB0aW9uLCBhbmQKICAgICAgICAgICAgICAgICAgICAv\nLyB3ZSBhcmUgdHJhY2tpbmcgcGFyYW1ldGVycywgdGhlbiBzZXQgdGhlIGN1\ncnJlbnQKICAgICAgICAgICAgICAgICAgICAvLyBwYXJhbWV0ZXIgc2V0IHRv\nIGJlIHRoZSBpbmRleCBvZiB0aGUgZmFpbGVkCiAgICAgICAgICAgICAgICAg\nICAgLy8gc3RhdGVtZW50IHNvIHRoYXQgdGhlIFJlcG9ydGluZ1NRTEV4Y2Vw\ndGlvbiB3aWxsCiAgICAgICAgICAgICAgICAgICAgLy8gc2hvdyB0aGUgY29y\ncmVjdCBwYXJhbShzKQogICAgICAgICAgICAgICAgICAgIGlmIChzZSBpbnN0\nYW5jZW9mIEJhdGNoVXBkYXRlRXhjZXB0aW9uCiAgICAgICAgICAgICAgICAg\nICAgICAgICYmIF9wYXJhbUJhdGNoICE9IG51bGwgJiYgc2hvdWxkVHJhY2tQ\nYXJhbWV0ZXJzKCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaW50W10g\nY291bnQgPSAoKEJhdGNoVXBkYXRlRXhjZXB0aW9uKSBzZSkuCiAgICAgICAg\nICAgICAgICAgICAgICAgICAgICBnZXRVcGRhdGVDb3VudHMoKTsKICAgICAg\nICAgICAgICAgICAgICAgICAgaWYgKGNvdW50ICE9IG51bGwgJiYgY291bnQu\nbGVuZ3RoIDw9IF9wYXJhbUJhdGNoLnNpemUoKSkKICAgICAgICAgICAgICAg\nICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChp\nbnQgaSA9IDA7IGkgPCBjb3VudC5sZW5ndGg7IGkrKykgewogICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgIC8vIC0zIGlzIFN0YXRlbWVudC5TVEFU\nRU1FTlRfRkFJTEVELCBidXQgaXMKICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAvLyBvbmx5IGF2YWlsYWJsZSBpbiBKREsgMS40KwogICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjb3VudFtpXSA9PSBTdGF0\nZW1lbnQuRVhFQ1VURV9GQUlMRUQpIHsKICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgaW5kZXhPZkZpcnN0RmFpbGVkT2JqZWN0ID0gaTsK\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAg\nICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgICAg\nIC8vIG5vIC0zIGVsZW1lbnQ6IGl0IG1heSBiZSB0aGF0IHRoZSBzZXJ2ZXIg\nc3RvcHBlZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gcHJvY2Vz\nc2luZywgc28gdGhlIHNpemUgb2YgdGhlIGNvdW50IHdpbGwgYmUKICAgICAg\nICAgICAgICAgICAgICAgICAgICAgIC8vIHRoZSBpbmRleAogICAgICAgICAg\nICAgICAgICAgICAgICAgICAgLy9TZWUgdGhlIEphdmFkb2MgZm9yICdnZXRV\ncGRhdGVDb3VudHMnOyBhIHByb3ZpZGVyCiAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAvL21heSBzdG9wIHByb2Nlc3Npbmcgd2hlbiB0aGUgZmlyc3Qg\nZmFpbHVyZSBvY2N1cnMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAv\nL2FzIHN1Y2gsIGl0IG1heSBvbmx5IHJldHVybiAnVXBkYXRlQ291bnRzJyBm\nb3IgdGhlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2ZpcnN0IGZl\ndyB3aGljaCBwYXNzLiAgQXMgc3VjaCwgdGhlIGZhaWxlZAogICAgICAgICAg\nICAgICAgICAgICAgICAgICAgLy9pbmRleCBpcyAnY291bnQubGVuZ3RoJywg\nTk9UIGNvdW50Lmxlbmd0aCsxLiAgVGhhdAogICAgICAgICAgICAgICAgICAg\nICAgICAgICAgLy9pcywgaWYgdGhlIHByb3ZpZGVyIE9OTFkgcmV0dXJucyB0\naGUgZmlyc3QgZmV3IHRoYXQKICAgICAgICAgICAgICAgICAgICAgICAgICAg\nIC8vcGFzc2VzIChpLmUuIHNheSBhbiBhcnJheSBvZiBbMSwxXSBpcyByZXR1\ncm5lZCkgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9sZW5n\ndGggaXMgMiwgYW5kIHNpbmNlIF9wYXJhbUJhdGNoIHN0YXJ0cyBhdCAwLCB3\nZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9kb24ndCB3YW50IHRv\nIHVzZSBsZW5ndGgrMSBhcyB0aGF0IHdpbGwgZ2l2ZSB1cyB0aGUKICAgICAg\nICAgICAgICAgICAgICAgICAgICAgIC8vd3JvbmcgaW5kZXguCiAgICAgICAg\nICAgICAgICAgICAgICAgICAgICBpZiAoaW5kZXhPZkZpcnN0RmFpbGVkT2Jq\nZWN0ID09IC0xKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBp\nbmRleE9mRmlyc3RGYWlsZWRPYmplY3QgPSBjb3VudC5sZW5ndGg7CiAgICAg\nICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAg\nICAgICAgICAgLy9GaW5hbGx5LCB3aGF0ZXZlciB0aGUgaW5kZXggaXMgYXQg\ndGhpcyBwb2ludCwgYWRkIGJhdGNoZWRSb3dzQmFzZUluZGV4CiAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAvL3RvIGl0IHRvIGdldCB0aGUgZmluYWwg\naW5kZXguICBSZWNhbGwsIHdlIG5lZWQgdG8gc3RhcnQgb3VyIGluZGV4IGZy\nb20gdGhlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2xhc3QgYmF0\nY2ggd2hpY2ggc3VjY2Vzc2Z1bGx5IGV4ZWN1dGVkLgogICAgICAgICAgICAg\nICAgICAgICAgICAgICAgaW5kZXhPZkZpcnN0RmFpbGVkT2JqZWN0ICs9IGJh\ndGNoZWRSb3dzQmFzZUluZGV4OwoKICAgICAgICAgICAgICAgICAgICAgICAg\nICAgIC8vIHNldCB0aGUgY3VycmVudCBwYXJhbXMgdG8gdGhlIHNhdmVkIHZh\nbHVlcwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGluZGV4T2ZG\naXJzdEZhaWxlZE9iamVjdCA8IF9wYXJhbUJhdGNoLnNpemUoKSkKICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICBfcGFyYW1zID0gKExpc3QpIF9w\nYXJhbUJhdGNoLmdldChpbmRleE9mRmlyc3RGYWlsZWRPYmplY3QpOwogICAg\nICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQog\nICAgICAgICAgICAgICAgICAgIGVyciA9IHdyYXAoc2UsIExvZ2dpbmdQcmVw\nYXJlZFN0YXRlbWVudC50aGlzLCBpbmRleE9mRmlyc3RGYWlsZWRPYmplY3Qp\nOwogICAgICAgICAgICAgICAgICAgIHRocm93IGVycjsKICAgICAgICAgICAg\nICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgICAgICAgICAgbG9nVGltZShz\ndGFydCk7CiAgICAgICAgICAgICAgICAgICAgaGFuZGxlU1FMRXJyb3JzKExv\nZ2dpbmdQcmVwYXJlZFN0YXRlbWVudC50aGlzLCBlcnIpOwogICAgICAgICAg\nICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICBwdWJsaWMgYm9v\nbGVhbiBleGVjdXRlKCkgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAg\nICAgICAgICBsb2dTUUwodGhpcyk7CiAgICAgICAgICAgICAgICBsb25nIHN0\nYXJ0ID0gU3lzdGVtLmN1cnJlbnRUaW1lTWlsbGlzKCk7CiAgICAgICAgICAg\nICAgICBTUUxFeGNlcHRpb24gZXJyID0gbnVsbDsKICAgICAgICAgICAgICAg\nIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmV4ZWN1\ndGUoKTsKICAgICAgICAgICAgICAgIH0gY2F0Y2ggKFNRTEV4Y2VwdGlvbiBz\nZSkgewogICAgICAgICAgICAgICAgICAgIGVyciA9IHdyYXAoc2UsIExvZ2dp\nbmdQcmVwYXJlZFN0YXRlbWVudC50aGlzKTsKICAgICAgICAgICAgICAgICAg\nICB0aHJvdyBlcnI7CiAgICAgICAgICAgICAgICB9IGZpbmFsbHkgewogICAg\nICAgICAgICAgICAgICAgIGxvZ1RpbWUoc3RhcnQpOwogICAgICAgICAgICAg\nICAgICAgIGNsZWFyTG9nUGFyYW1ldGVycyh0cnVlKTsKICAgICAgICAgICAg\nICAgICAgICBoYW5kbGVTUUxFcnJvcnMoTG9nZ2luZ1ByZXBhcmVkU3RhdGVt\nZW50LnRoaXMsIGVycik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAg\nIH0KCiAgICAgICAgICAgIHB1YmxpYyB2b2lkIGNhbmNlbCgpIHRocm93cyBT\nUUxFeGNlcHRpb24gewogICAgICAgICAgICAgICAgaWYgKF9sb2dzLmlzSkRC\nQ0VuYWJsZWQoKSkKICAgICAgICAgICAgICAgICAgICBfbG9ncy5sb2dKREJD\nKCJjYW5jZWwgIiArIHRoaXMgKyAiOiAiICsgX3NxbCwKICAgICAgICAgICAg\nICAgICAgICAgICAgTG9nZ2luZ0Nvbm5lY3Rpb24udGhpcyk7CgogICAgICAg\nICAgICAgICAgc3VwZXIuY2FuY2VsKCk7CiAgICAgICAgICAgIH0KCiAgICAg\nICAgICAgIHB1YmxpYyB2b2lkIHNldE51bGwoaW50IGkxLCBpbnQgaTIpIHRo\ncm93cyBTUUxFeGNlcHRpb24gewogICAgICAgICAgICAgICAgc2V0TG9nUGFy\nYW1ldGVyKGkxLCAibnVsbCIsIG51bGwpOwogICAgICAgICAgICAgICAgc3Vw\nZXIuc2V0TnVsbChpMSwgaTIpOwogICAgICAgICAgICB9CgogICAgICAgICAg\nICBwdWJsaWMgdm9pZCBzZXRCb29sZWFuKGludCBpLCBib29sZWFuIGIpIHRo\ncm93cyBTUUxFeGNlcHRpb24gewogICAgICAgICAgICAgICAgc2V0TG9nUGFy\nYW1ldGVyKGksIGIpOwogICAgICAgICAgICAgICAgc3VwZXIuc2V0Qm9vbGVh\nbihpLCBiKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHVibGljIHZv\naWQgc2V0Qnl0ZShpbnQgaSwgYnl0ZSBiKSB0aHJvd3MgU1FMRXhjZXB0aW9u\nIHsKICAgICAgICAgICAgICAgIHNldExvZ1BhcmFtZXRlcihpLCBiKTsKICAg\nICAgICAgICAgICAgIHN1cGVyLnNldEJ5dGUoaSwgYik7CiAgICAgICAgICAg\nIH0KCiAgICAgICAgICAgIHB1YmxpYyB2b2lkIHNldFNob3J0KGludCBpLCBz\naG9ydCBzKSB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAgICAgICAg\nIHNldExvZ1BhcmFtZXRlcihpLCBzKTsKICAgICAgICAgICAgICAgIHN1cGVy\nLnNldFNob3J0KGksIHMpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBw\ndWJsaWMgdm9pZCBzZXRJbnQoaW50IGkxLCBpbnQgaTIpIHRocm93cyBTUUxF\neGNlcHRpb24gewogICAgICAgICAgICAgICAgc2V0TG9nUGFyYW1ldGVyKGkx\nLCBpMik7CiAgICAgICAgICAgICAgICBzdXBlci5zZXRJbnQoaTEsIGkyKTsK\nICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHVibGljIHZvaWQgc2V0TG9u\nZyhpbnQgaSwgbG9uZyBsKSB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAg\nICAgICAgICAgIHNldExvZ1BhcmFtZXRlcihpLCBsKTsKICAgICAgICAgICAg\nICAgIHN1cGVyLnNldExvbmcoaSwgbCk7CiAgICAgICAgICAgIH0KCiAgICAg\nICAgICAgIHB1YmxpYyB2b2lkIHNldEZsb2F0KGludCBpLCBmbG9hdCBmKSB0\naHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAgICAgICAgIHNldExvZ1Bh\ncmFtZXRlcihpLCBmKTsKICAgICAgICAgICAgICAgIHN1cGVyLnNldEZsb2F0\nKGksIGYpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBwdWJsaWMgdm9p\nZCBzZXREb3VibGUoaW50IGksIGRvdWJsZSBkKSB0aHJvd3MgU1FMRXhjZXB0\naW9uIHsKICAgICAgICAgICAgICAgIHNldExvZ1BhcmFtZXRlcihpLCBkKTsK\nICAgICAgICAgICAgICAgIHN1cGVyLnNldERvdWJsZShpLCBkKTsKICAgICAg\nICAgICAgfQoKICAgICAgICAgICAgcHVibGljIHZvaWQgc2V0QmlnRGVjaW1h\nbChpbnQgaSwgQmlnRGVjaW1hbCBiZCkKICAgICAgICAgICAgICAgIHRocm93\ncyBTUUxFeGNlcHRpb24gewogICAgICAgICAgICAgICAgc2V0TG9nUGFyYW1l\ndGVyKGksICJCaWdEZWNpbWFsIiwgYmQpOwogICAgICAgICAgICAgICAgc3Vw\nZXIuc2V0QmlnRGVjaW1hbChpLCBiZCk7CiAgICAgICAgICAgIH0KCiAgICAg\nICAgICAgIHB1YmxpYyB2b2lkIHNldFN0cmluZyhpbnQgaSwgU3RyaW5nIHMp\nIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgICAgICAgICAgc2V0TG9n\nUGFyYW1ldGVyKGksICJTdHJpbmciLCBzKTsKICAgICAgICAgICAgICAgIHN1\ncGVyLnNldFN0cmluZyhpLCBzKTsKICAgICAgICAgICAgfQoKICAgICAgICAg\nICAgcHVibGljIHZvaWQgc2V0Qnl0ZXMoaW50IGksIGJ5dGVbXSBiKSB0aHJv\nd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAgICAgICAgIHNldExvZ1BhcmFt\nZXRlcihpLCAiYnl0ZVtdIiwgYik7CiAgICAgICAgICAgICAgICBzdXBlci5z\nZXRCeXRlcyhpLCBiKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHVi\nbGljIHZvaWQgc2V0RGF0ZShpbnQgaSwgRGF0ZSBkKSB0aHJvd3MgU1FMRXhj\nZXB0aW9uIHsKICAgICAgICAgICAgICAgIHNldExvZ1BhcmFtZXRlcihpLCAi\nRGF0ZSIsIGQpOwogICAgICAgICAgICAgICAgc3VwZXIuc2V0RGF0ZShpLCBk\nKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHVibGljIHZvaWQgc2V0\nVGltZShpbnQgaSwgVGltZSB0KSB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAg\nICAgICAgICAgICAgIHNldExvZ1BhcmFtZXRlcihpLCAiVGltZSIsIHQpOwog\nICAgICAgICAgICAgICAgc3VwZXIuc2V0VGltZShpLCB0KTsKICAgICAgICAg\nICAgfQoKICAgICAgICAgICAgcHVibGljIHZvaWQgc2V0VGltZXN0YW1wKGlu\ndCBpLCBUaW1lc3RhbXAgdCkgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAg\nICAgICAgICAgICBzZXRMb2dQYXJhbWV0ZXIoaSwgIlRpbWVzdGFtcCIsIHQp\nOwogICAgICAgICAgICAgICAgc3VwZXIuc2V0VGltZXN0YW1wKGksIHQpOwog\nICAgICAgICAgICB9CgogICAgICAgICAgICBwdWJsaWMgdm9pZCBzZXRBc2Np\naVN0cmVhbShpbnQgaTEsIElucHV0U3RyZWFtIGlzLCBpbnQgaTIpCiAgICAg\nICAgICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAgICAg\nICAgIHNldExvZ1BhcmFtZXRlcihpMSwgIklucHV0U3RyZWFtIiwgaXMpOwog\nICAgICAgICAgICAgICAgc3VwZXIuc2V0QXNjaWlTdHJlYW0oaTEsIGlzLCBp\nMik7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIEBEZXByZWNhdGVkCiAg\nICAgICAgICAgIHB1YmxpYyB2b2lkIHNldFVuaWNvZGVTdHJlYW0oaW50IGkx\nLCBJbnB1dFN0cmVhbSBpcywgaW50IGkyKQogICAgICAgICAgICAgICAgdGhy\nb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgICAgICAgICBzZXRMb2dQYXJh\nbWV0ZXIoaTEsICJJbnB1dFN0cmVhbSIsIGlzKTsKICAgICAgICAgICAgICAg\nIHN1cGVyLnNldFVuaWNvZGVTdHJlYW0oaTIsIGlzLCBpMik7CiAgICAgICAg\nICAgIH0KCiAgICAgICAgICAgIHB1YmxpYyB2b2lkIHNldEJpbmFyeVN0cmVh\nbShpbnQgaTEsIElucHV0U3RyZWFtIGlzLCBpbnQgaTIpCiAgICAgICAgICAg\nICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAgICAgICAgIHNl\ndExvZ1BhcmFtZXRlcihpMSwgIklucHV0U3RyZWFtIiwgaXMpOwogICAgICAg\nICAgICAgICAgc3VwZXIuc2V0QmluYXJ5U3RyZWFtKGkxLCBpcywgaTIpOwog\nICAgICAgICAgICB9CgogICAgICAgICAgICBwdWJsaWMgdm9pZCBjbGVhclBh\ncmFtZXRlcnMoKSB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAgICAg\nICAgIGNsZWFyTG9nUGFyYW1ldGVycyhmYWxzZSk7CiAgICAgICAgICAgICAg\nICBzdXBlci5jbGVhclBhcmFtZXRlcnMoKTsKICAgICAgICAgICAgfQoKICAg\nICAgICAgICAgcHVibGljIHZvaWQgc2V0T2JqZWN0KGludCBpMSwgT2JqZWN0\nIG8sIGludCBpMiwgaW50IGkzKQogICAgICAgICAgICAgICAgdGhyb3dzIFNR\nTEV4Y2VwdGlvbiB7CiAgICAgICAgICAgICAgICBzZXRMb2dQYXJhbWV0ZXIo\naTEsICJPYmplY3QiLCBvKTsKICAgICAgICAgICAgICAgIHN1cGVyLnNldE9i\namVjdChpMSwgbywgaTIsIGkzKTsKICAgICAgICAgICAgfQoKICAgICAgICAg\nICAgcHVibGljIHZvaWQgc2V0T2JqZWN0KGludCBpMSwgT2JqZWN0IG8sIGlu\ndCBpMikKICAgICAgICAgICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewog\nICAgICAgICAgICAgICAgc2V0TG9nUGFyYW1ldGVyKGkxLCAiT2JqZWN0Iiwg\nbyk7CiAgICAgICAgICAgICAgICBzdXBlci5zZXRPYmplY3QoaTEsIG8sIGky\nKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHVibGljIHZvaWQgc2V0\nT2JqZWN0KGludCBpLCBPYmplY3QgbykgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7\nCiAgICAgICAgICAgICAgICBzZXRMb2dQYXJhbWV0ZXIoaSwgIk9iamVjdCIs\nIG8pOwogICAgICAgICAgICAgICAgc3VwZXIuc2V0T2JqZWN0KGksIG8pOwog\nICAgICAgICAgICB9CgogICAgICAgICAgICBwdWJsaWMgdm9pZCBhZGRCYXRj\naCgpIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgICAgICAgICAgaWYg\nKF9sb2dzLmlzU1FMRW5hYmxlZCgpKQogICAgICAgICAgICAgICAgICAgIF9s\nb2dzLmxvZ1NRTCgiYmF0Y2hpbmcgIiArIHRoaXMsIExvZ2dpbmdDb25uZWN0\naW9uLnRoaXMpOwogICAgICAgICAgICAgICAgbG9uZyBzdGFydCA9IFN5c3Rl\nbS5jdXJyZW50VGltZU1pbGxpcygpOwogICAgICAgICAgICAgICAgdHJ5IHsK\nICAgICAgICAgICAgICAgICAgICBzdXBlci5hZGRCYXRjaCgpOwogICAgICAg\nICAgICAgICAgICAgIGlmIChzaG91bGRUcmFja1BhcmFtZXRlcnMoKSkgewog\nICAgICAgICAgICAgICAgICAgICAgICAvLyBtYWtlIHN1cmUgb3VyIGxpc3Qg\naXMgaW5pdGlhbGl6ZWQKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKF9w\nYXJhbUJhdGNoID09IG51bGwpCiAgICAgICAgICAgICAgICAgICAgICAgICAg\nICBfcGFyYW1CYXRjaCA9IG5ldyBBcnJheUxpc3Q8TGlzdDxTdHJpbmc+Pigp\nOwogICAgICAgICAgICAgICAgICAgICAgICAvLyBjb3B5IHBhcmFtZXRlcnMg\nc2luY2UgdGhleSB3aWxsIGJlIHJlLXVzZWQKICAgICAgICAgICAgICAgICAg\nICAgICAgaWYgKF9wYXJhbXMgIT0gbnVsbCkgewogICAgICAgICAgICAgICAg\nICAgICAgICAgICAgTGlzdDxTdHJpbmc+IGNvcHlQYXJtcyA9CiAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBBcnJheUxpc3Q8U3Ry\naW5nPihfcGFyYW1zKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9w\nYXJhbUJhdGNoLmFkZChjb3B5UGFybXMpOwogICAgICAgICAgICAgICAgICAg\nICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAg\nICAgICAgICAgICAgICAgICAgIF9wYXJhbUJhdGNoLmFkZChudWxsKTsKICAg\nICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAg\nICAgICAgICBmaW5hbGx5IHsKICAgICAgICAgICAgICAgICAgICBsb2dUaW1l\nKHN0YXJ0KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAg\nICAgICAgICAgcHVibGljIHZvaWQgc2V0Q2hhcmFjdGVyU3RyZWFtKGludCBp\nMSwgUmVhZGVyIHIsIGludCBpMikKICAgICAgICAgICAgICAgIHRocm93cyBT\nUUxFeGNlcHRpb24gewogICAgICAgICAgICAgICAgc2V0TG9nUGFyYW1ldGVy\nKGkxLCAiUmVhZGVyIiwgcik7CiAgICAgICAgICAgICAgICBzdXBlci5zZXRD\naGFyYWN0ZXJTdHJlYW0oaTEsIHIsIGkyKTsKICAgICAgICAgICAgfQoKICAg\nICAgICAgICAgcHVibGljIHZvaWQgc2V0UmVmKGludCBpLCBSZWYgcikgdGhy\nb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgICAgICAgICBzZXRMb2dQYXJh\nbWV0ZXIoaSwgIlJlZiIsIHIpOwogICAgICAgICAgICAgICAgc3VwZXIuc2V0\nUmVmKGksIHIpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBwdWJsaWMg\ndm9pZCBzZXRCbG9iKGludCBpLCBCbG9iIGIpIHRocm93cyBTUUxFeGNlcHRp\nb24gewogICAgICAgICAgICAgICAgc2V0TG9nUGFyYW1ldGVyKGksICJCbG9i\nIiwgYik7CiAgICAgICAgICAgICAgICBzdXBlci5zZXRCbG9iKGksIGIpOwog\nICAgICAgICAgICB9CgogICAgICAgICAgICBwdWJsaWMgdm9pZCBzZXRDbG9i\nKGludCBpLCBDbG9iIGMpIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAg\nICAgICAgICAgc2V0TG9nUGFyYW1ldGVyKGksICJDbG9iIiwgYyk7CiAgICAg\nICAgICAgICAgICBzdXBlci5zZXRDbG9iKGksIGMpOwogICAgICAgICAgICB9\nCgogICAgICAgICAgICBwdWJsaWMgdm9pZCBzZXRBcnJheShpbnQgaSwgQXJy\nYXkgYSkgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgICAgICAgICBz\nZXRMb2dQYXJhbWV0ZXIoaSwgIkFycmF5IiwgYSk7CiAgICAgICAgICAgICAg\nICBzdXBlci5zZXRBcnJheShpLCBhKTsKICAgICAgICAgICAgfQoKICAgICAg\nICAgICAgcHVibGljIFJlc3VsdFNldE1ldGFEYXRhIGdldE1ldGFEYXRhKCkg\ndGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgICAgICAgICByZXR1cm4g\nc3VwZXIuZ2V0TWV0YURhdGEoKTsKICAgICAgICAgICAgfQoKICAgICAgICAg\nICAgcHVibGljIHZvaWQgc2V0RGF0ZShpbnQgaSwgRGF0ZSBkLCBDYWxlbmRh\nciBjKSB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAgICAgICAgIHNl\ndExvZ1BhcmFtZXRlcihpLCAiRGF0ZSIsIGQpOwogICAgICAgICAgICAgICAg\nc3VwZXIuc2V0RGF0ZShpLCBkLCBjKTsKICAgICAgICAgICAgfQoKICAgICAg\nICAgICAgcHVibGljIHZvaWQgc2V0VGltZShpbnQgaSwgVGltZSB0LCBDYWxl\nbmRhciBjKSB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAgICAgICAg\nIHNldExvZ1BhcmFtZXRlcihpLCAiVGltZSIsIHQpOwogICAgICAgICAgICAg\nICAgc3VwZXIuc2V0VGltZShpLCB0LCBjKTsKICAgICAgICAgICAgfQoKICAg\nICAgICAgICAgcHVibGljIHZvaWQgc2V0VGltZXN0YW1wKGludCBpLCBUaW1l\nc3RhbXAgdCwgQ2FsZW5kYXIgYykKICAgICAgICAgICAgICAgIHRocm93cyBT\nUUxFeGNlcHRpb24gewogICAgICAgICAgICAgICAgc2V0TG9nUGFyYW1ldGVy\nKGksICJUaW1lc3RhbXAiLCB0KTsKICAgICAgICAgICAgICAgIHN1cGVyLnNl\ndFRpbWVzdGFtcChpLCB0LCBjKTsKICAgICAgICAgICAgfQoKICAgICAgICAg\nICAgcHVibGljIHZvaWQgc2V0TnVsbChpbnQgaTEsIGludCBpMiwgU3RyaW5n\nIHMpIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgICAgICAgICAgc2V0\nTG9nUGFyYW1ldGVyKGkxLCAibnVsbCIsIG51bGwpOwogICAgICAgICAgICAg\nICAgc3VwZXIuc2V0TnVsbChpMSwgaTIsIHMpOwogICAgICAgICAgICB9Cgog\nICAgICAgICAgICBwcm90ZWN0ZWQgdm9pZCBhcHBlbmRJbmZvKFN0cmluZ0J1\nZmZlciBidWYpIHsKICAgICAgICAgICAgICAgIGJ1Zi5hcHBlbmQoIiAiKTsK\nICAgICAgICAgICAgICAgIGlmIChfZm9ybWF0dGVyICE9IG51bGwpIHsKICAg\nICAgICAgICAgICAgICAgICBidWYuYXBwZW5kKFNFUCk7CiAgICAgICAgICAg\nICAgICAgICAgYnVmLmFwcGVuZChfZm9ybWF0dGVyLnByZXR0eVByaW50KF9z\ncWwpKTsKICAgICAgICAgICAgICAgICAgICBidWYuYXBwZW5kKFNFUCk7CiAg\nICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIGJ1\nZi5hcHBlbmQoX3NxbCk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAg\nICAgICAgU3RyaW5nQnVpbGRlciBwYXJhbUJ1ZiA9IG51bGw7CiAgICAgICAg\nICAgICAgICBpZiAoX3BhcmFtcyAhPSBudWxsICYmICFfcGFyYW1zLmlzRW1w\ndHkoKSkgewogICAgICAgICAgICAgICAgICAgIHBhcmFtQnVmID0gbmV3IFN0\ncmluZ0J1aWxkZXIoKTsKICAgICAgICAgICAgICAgICAgICBmb3IgKEl0ZXJh\ndG9yPFN0cmluZz4gaXRyID0gX3BhcmFtcy5pdGVyYXRvcigpOyBpdHIKICAg\nICAgICAgICAgICAgICAgICAgICAgLmhhc05leHQoKTspIHsKICAgICAgICAg\nICAgICAgICAgICAgICAgaWYoX3ByaW50UGFyYW1ldGVycykgeyAKICAgICAg\nICAgICAgICAgICAgICAgICAgICAgIHBhcmFtQnVmLmFwcGVuZChpdHIubmV4\ndCgpKTsKICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsgCiAgICAg\nICAgICAgICAgICAgICAgICAgICAgICBwYXJhbUJ1Zi5hcHBlbmQoIj8iKTsK\nICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ci5uZXh0KCk7CiAgICAg\nICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAg\naWYgKGl0ci5oYXNOZXh0KCkpCiAgICAgICAgICAgICAgICAgICAgICAgICAg\nICBwYXJhbUJ1Zi5hcHBlbmQoIiwgIik7CiAgICAgICAgICAgICAgICAgICAg\nfQogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGlmIChwYXJh\nbUJ1ZiAhPSBudWxsKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKCFfcHJl\ndHR5UHJpbnQpCiAgICAgICAgICAgICAgICAgICAgICAgIGJ1Zi5hcHBlbmQo\nIiAiKTsKICAgICAgICAgICAgICAgICAgICBidWYuYXBwZW5kKCJbcGFyYW1z\nPSIpLgogICAgICAgICAgICAgICAgICAgICAgICBhcHBlbmQocGFyYW1CdWYu\ndG9TdHJpbmcoKSkuYXBwZW5kKCJdIik7CiAgICAgICAgICAgICAgICB9CiAg\nICAgICAgICAgICAgICBzdXBlci5hcHBlbmRJbmZvKGJ1Zik7CiAgICAgICAg\nICAgIH0KCiAgICAgICAgICAgIHByaXZhdGUgdm9pZCBjbGVhckxvZ1BhcmFt\nZXRlcnMoYm9vbGVhbiBiYXRjaCkgewogICAgICAgICAgICAgICAgaWYgKF9w\nYXJhbXMgIT0gbnVsbCkgewogICAgICAgICAgICAgICAgICAgIF9wYXJhbXMu\nY2xlYXIoKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBp\nZiAoYmF0Y2ggJiYgX3BhcmFtQmF0Y2ggIT0gbnVsbCkgewogICAgICAgICAg\nICAgICAgICAgIF9wYXJhbUJhdGNoLmNsZWFyKCk7CiAgICAgICAgICAgICAg\nICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHByaXZhdGUgYm9vbGVh\nbiBzaG91bGRUcmFja1BhcmFtZXRlcnMoKSB7CiAgICAgICAgICAgICAgICBy\nZXR1cm4gX3RyYWNrUGFyYW1ldGVycyB8fCBfbG9ncy5pc1NRTEVuYWJsZWQo\nKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHJpdmF0ZSB2b2lkIHNl\ndExvZ1BhcmFtZXRlcihpbnQgaW5kZXgsIGJvb2xlYW4gdmFsKSB7CiAgICAg\nICAgICAgICAgICBpZiAoc2hvdWxkVHJhY2tQYXJhbWV0ZXJzKCkpCiAgICAg\nICAgICAgICAgICAgICAgc2V0TG9nUGFyYW1ldGVyKGluZGV4LCAiKGJvb2xl\nYW4pICIgKyB2YWwpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBwcml2\nYXRlIHZvaWQgc2V0TG9nUGFyYW1ldGVyKGludCBpbmRleCwgYnl0ZSB2YWwp\nIHsKICAgICAgICAgICAgICAgIGlmIChzaG91bGRUcmFja1BhcmFtZXRlcnMo\nKSkKICAgICAgICAgICAgICAgICAgICBzZXRMb2dQYXJhbWV0ZXIoaW5kZXgs\nICIoYnl0ZSkgIiArIHZhbCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAg\nIHByaXZhdGUgdm9pZCBzZXRMb2dQYXJhbWV0ZXIoaW50IGluZGV4LCBkb3Vi\nbGUgdmFsKSB7CiAgICAgICAgICAgICAgICBpZiAoc2hvdWxkVHJhY2tQYXJh\nbWV0ZXJzKCkpCiAgICAgICAgICAgICAgICAgICAgc2V0TG9nUGFyYW1ldGVy\nKGluZGV4LCAiKGRvdWJsZSkgIiArIHZhbCk7CiAgICAgICAgICAgIH0KCiAg\nICAgICAgICAgIHByaXZhdGUgdm9pZCBzZXRMb2dQYXJhbWV0ZXIoaW50IGlu\nZGV4LCBmbG9hdCB2YWwpIHsKICAgICAgICAgICAgICAgIGlmIChzaG91bGRU\ncmFja1BhcmFtZXRlcnMoKSkKICAgICAgICAgICAgICAgICAgICBzZXRMb2dQ\nYXJhbWV0ZXIoaW5kZXgsICIoZmxvYXQpICIgKyB2YWwpOwogICAgICAgICAg\nICB9CgogICAgICAgICAgICBwcml2YXRlIHZvaWQgc2V0TG9nUGFyYW1ldGVy\nKGludCBpbmRleCwgaW50IHZhbCkgewogICAgICAgICAgICAgICAgaWYgKHNo\nb3VsZFRyYWNrUGFyYW1ldGVycygpKQogICAgICAgICAgICAgICAgICAgIHNl\ndExvZ1BhcmFtZXRlcihpbmRleCwgIihpbnQpICIgKyB2YWwpOwogICAgICAg\nICAgICB9CgogICAgICAgICAgICBwcml2YXRlIHZvaWQgc2V0TG9nUGFyYW1l\ndGVyKGludCBpbmRleCwgbG9uZyB2YWwpIHsKICAgICAgICAgICAgICAgIGlm\nIChzaG91bGRUcmFja1BhcmFtZXRlcnMoKSkKICAgICAgICAgICAgICAgICAg\nICBzZXRMb2dQYXJhbWV0ZXIoaW5kZXgsICIobG9uZykgIiArIHZhbCk7CiAg\nICAgICAgICAgIH0KCiAgICAgICAgICAgIHByaXZhdGUgdm9pZCBzZXRMb2dQ\nYXJhbWV0ZXIoaW50IGluZGV4LCBzaG9ydCB2YWwpIHsKICAgICAgICAgICAg\nICAgIGlmIChzaG91bGRUcmFja1BhcmFtZXRlcnMoKSkKICAgICAgICAgICAg\nICAgICAgICBzZXRMb2dQYXJhbWV0ZXIoaW5kZXgsICIoc2hvcnQpICIgKyB2\nYWwpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBwcml2YXRlIHZvaWQg\nc2V0TG9nUGFyYW1ldGVyKGludCBpbmRleCwgU3RyaW5nIHR5cGUsIE9iamVj\ndCB2YWwpIHsKICAgICAgICAgICAgICAgIGlmIChzaG91bGRUcmFja1BhcmFt\nZXRlcnMoKSkKICAgICAgICAgICAgICAgICAgICBzZXRMb2dQYXJhbWV0ZXIo\naW5kZXgsICIoIiArIHR5cGUgKyAiKSAiICsgdmFsKTsKICAgICAgICAgICAg\nfQoKICAgICAgICAgICAgcHJpdmF0ZSB2b2lkIHNldExvZ1BhcmFtZXRlcihp\nbnQgaW5kZXgsIFN0cmluZyB2YWwpIHsKICAgICAgICAgICAgICAgIGlmIChf\ncGFyYW1zID09IG51bGwpCiAgICAgICAgICAgICAgICAgICAgX3BhcmFtcyA9\nIG5ldyBBcnJheUxpc3Q8U3RyaW5nPigpOwogICAgICAgICAgICAgICAgd2hp\nbGUgKF9wYXJhbXMuc2l6ZSgpIDwgaW5kZXgpCiAgICAgICAgICAgICAgICAg\nICAgX3BhcmFtcy5hZGQobnVsbCk7CiAgICAgICAgICAgICAgICBpZiAodmFs\nLmxlbmd0aCgpID4gODApCiAgICAgICAgICAgICAgICAgICAgdmFsID0gdmFs\nLnN1YnN0cmluZygwLCA3NykgKyAiLi4uIjsKICAgICAgICAgICAgICAgIF9w\nYXJhbXMuc2V0KGluZGV4IC0gMSwgdmFsKTsKICAgICAgICAgICAgfQogICAg\nICAgIH0KCiAgICAgICAgLyoqCiAgICAgICAgICogV2FybmluZy1oYW5kbGlu\nZyByZXN1bHQgc2V0LgogICAgICAgICAqLwogICAgICAgIHByb3RlY3RlZCBh\nYnN0cmFjdCBjbGFzcyBMb2dnaW5nUmVzdWx0U2V0IGV4dGVuZHMgRGVsZWdh\ndGluZ1Jlc3VsdFNldCB7CgogICAgICAgICAgICBwdWJsaWMgTG9nZ2luZ1Jl\nc3VsdFNldChSZXN1bHRTZXQgcnMsIFN0YXRlbWVudCBzdG1udCkgewogICAg\nICAgICAgICAgICAgc3VwZXIocnMsIHN0bW50KTsKICAgICAgICAgICAgfQoK\nICAgICAgICAgICAgcHVibGljIGJvb2xlYW4gbmV4dCgpIHRocm93cyBTUUxF\neGNlcHRpb24gewogICAgICAgICAgICAgICAgU1FMRXhjZXB0aW9uIGVyciA9\nIG51bGw7CiAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAg\nICAgIHJldHVybiBzdXBlci5uZXh0KCk7CiAgICAgICAgICAgICAgICB9IGNh\ndGNoIChTUUxFeGNlcHRpb24gc2UpIHsKICAgICAgICAgICAgICAgICAgICBl\ncnIgPSBzZTsKICAgICAgICAgICAgICAgICAgICB0aHJvdyBzZTsKICAgICAg\nICAgICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgICAgICAgICAgaGFu\nZGxlU1FMRXJyb3JzKExvZ2dpbmdSZXN1bHRTZXQudGhpcywgZXJyKTsKICAg\nICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHVi\nbGljIHZvaWQgY2xvc2UoKSB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAg\nICAgICAgICAgIFNRTEV4Y2VwdGlvbiBlcnIgPSBudWxsOyAgICAgICAgICAg\nIAkKICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAg\nc3VwZXIuY2xvc2UoKTsKICAgICAgICAgICAgICAgIH0gY2F0Y2ggKFNRTEV4\nY2VwdGlvbiBzZSkgewogICAgICAgICAgICAgICAgICAgIGVyciA9IHNlOwog\nICAgICAgICAgICAgICAgICAgIHRocm93IHNlOwogICAgICAgICAgICAgICAg\nfSBmaW5hbGx5IHsKICAgICAgICAgICAgICAgICAgICBoYW5kbGVTUUxFcnJv\ncnMoTG9nZ2luZ1Jlc3VsdFNldC50aGlzLCBlcnIpOwogICAgICAgICAgICAg\nICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICBwdWJsaWMgdm9pZCBi\nZWZvcmVGaXJzdCgpIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgICAg\nICAgICAgU1FMRXhjZXB0aW9uIGVyciA9IG51bGw7ICAgICAgICAgICAgCQog\nICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICBzdXBl\nci5iZWZvcmVGaXJzdCgpOwogICAgICAgICAgICAgICAgfSBjYXRjaCAoU1FM\nRXhjZXB0aW9uIHNlKSB7CiAgICAgICAgICAgICAgICAgICAgZXJyID0gc2U7\nCiAgICAgICAgICAgICAgICAgICAgdGhyb3cgc2U7CiAgICAgICAgICAgICAg\nICB9IGZpbmFsbHkgewogICAgICAgICAgICAgICAgICAgIGhhbmRsZVNRTEVy\ncm9ycyhMb2dnaW5nUmVzdWx0U2V0LnRoaXMsIGVycik7CiAgICAgICAgICAg\nICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHB1YmxpYyB2b2lk\nIGFmdGVyTGFzdCgpIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgICAg\nICAgICAgU1FMRXhjZXB0aW9uIGVyciA9IG51bGw7ICAgICAgICAgICAgCQog\nICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICBzdXBl\nci5hZnRlckxhc3QoKTsKICAgICAgICAgICAgICAgIH0gY2F0Y2ggKFNRTEV4\nY2VwdGlvbiBzZSkgewogICAgICAgICAgICAgICAgICAgIGVyciA9IHNlOwog\nICAgICAgICAgICAgICAgICAgIHRocm93IHNlOwogICAgICAgICAgICAgICAg\nfSBmaW5hbGx5IHsKICAgICAgICAgICAgICAgICAgICBoYW5kbGVTUUxFcnJv\ncnMoTG9nZ2luZ1Jlc3VsdFNldC50aGlzLCBlcnIpOwogICAgICAgICAgICAg\nICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICBwdWJsaWMgYm9vbGVh\nbiBmaXJzdCgpIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgICAgICAg\nICAgU1FMRXhjZXB0aW9uIGVyciA9IG51bGw7ICAgICAgICAgICAgCQogICAg\nICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4g\nc3VwZXIuZmlyc3QoKTsKICAgICAgICAgICAgICAgIH0gY2F0Y2ggKFNRTEV4\nY2VwdGlvbiBzZSkgewogICAgICAgICAgICAgICAgICAgIGVyciA9IHNlOwog\nICAgICAgICAgICAgICAgICAgIHRocm93IHNlOwogICAgICAgICAgICAgICAg\nfSBmaW5hbGx5IHsKICAgICAgICAgICAgICAgICAgICBoYW5kbGVTUUxFcnJv\ncnMoTG9nZ2luZ1Jlc3VsdFNldC50aGlzLCBlcnIpOwogICAgICAgICAgICAg\nICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICBwdWJsaWMgYm9vbGVh\nbiBsYXN0KCkgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgICAgICAg\nICBTUUxFeGNlcHRpb24gZXJyID0gbnVsbDsgICAgICAgICAgICAJCiAgICAg\nICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBz\ndXBlci5sYXN0KCk7CiAgICAgICAgICAgICAgICB9IGNhdGNoIChTUUxFeGNl\ncHRpb24gc2UpIHsKICAgICAgICAgICAgICAgICAgICBlcnIgPSBzZTsKICAg\nICAgICAgICAgICAgICAgICB0aHJvdyBzZTsKICAgICAgICAgICAgICAgIH0g\nZmluYWxseSB7CiAgICAgICAgICAgICAgICAgICAgaGFuZGxlU1FMRXJyb3Jz\nKExvZ2dpbmdSZXN1bHRTZXQudGhpcywgZXJyKTsKICAgICAgICAgICAgICAg\nIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHVibGljIGJvb2xlYW4g\nYWJzb2x1dGUoaW50IGEpIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAg\nICAgICAgICAgU1FMRXhjZXB0aW9uIGVyciA9IG51bGw7ICAgICAgICAgICAg\nCQogICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICBy\nZXR1cm4gc3VwZXIuYWJzb2x1dGUoYSk7CiAgICAgICAgICAgICAgICB9IGNh\ndGNoIChTUUxFeGNlcHRpb24gc2UpIHsKICAgICAgICAgICAgICAgICAgICBl\ncnIgPSBzZTsKICAgICAgICAgICAgICAgICAgICB0aHJvdyBzZTsKICAgICAg\nICAgICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgICAgICAgICAgaGFu\nZGxlU1FMRXJyb3JzKExvZ2dpbmdSZXN1bHRTZXQudGhpcywgZXJyKTsKICAg\nICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHVi\nbGljIGJvb2xlYW4gcmVsYXRpdmUoaW50IGEpIHRocm93cyBTUUxFeGNlcHRp\nb24gewogICAgICAgICAgICAgICAgU1FMRXhjZXB0aW9uIGVyciA9IG51bGw7\nICAgICAgICAgICAgCQogICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAg\nICAgICAgICAgICByZXR1cm4gc3VwZXIucmVsYXRpdmUoYSk7CiAgICAgICAg\nICAgICAgICB9IGNhdGNoIChTUUxFeGNlcHRpb24gc2UpIHsKICAgICAgICAg\nICAgICAgICAgICBlcnIgPSBzZTsKICAgICAgICAgICAgICAgICAgICB0aHJv\ndyBzZTsKICAgICAgICAgICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAg\nICAgICAgICAgaGFuZGxlU1FMRXJyb3JzKExvZ2dpbmdSZXN1bHRTZXQudGhp\ncywgZXJyKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAg\nICAgICAgICAgcHVibGljIGJvb2xlYW4gcHJldmlvdXMoKSB0aHJvd3MgU1FM\nRXhjZXB0aW9uIHsKICAgICAgICAgICAgICAgIFNRTEV4Y2VwdGlvbiBlcnIg\nPSBudWxsOyAgICAgICAgICAgIAkKICAgICAgICAgICAgICAgIHRyeSB7CiAg\nICAgICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLnByZXZpb3VzKCk7CiAg\nICAgICAgICAgICAgICB9IGNhdGNoIChTUUxFeGNlcHRpb24gc2UpIHsKICAg\nICAgICAgICAgICAgICAgICBlcnIgPSBzZTsKICAgICAgICAgICAgICAgICAg\nICB0aHJvdyBzZTsKICAgICAgICAgICAgICAgIH0gZmluYWxseSB7CiAgICAg\nICAgICAgICAgICAgICAgaGFuZGxlU1FMRXJyb3JzKExvZ2dpbmdSZXN1bHRT\nZXQudGhpcywgZXJyKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAg\nfQogICAgICAgIH0KICAgICAgICAKICAgICAgICAvKioKICAgICAgICAgKiBD\nYWxsYWJsZVN0YXRlbWVudCBkZWNvcmF0ZWQgd2l0aCBsb2dnaW5nLgogICAg\nICAgICAqIFNpbWlsYXIgdG8ge0BsaW5rIExvZ2dpbmdQcmVwYXJlZFN0YXRl\nbWVudH0gYnV0IGNhbiBub3QgYmUgZXh0ZW5kZWQKICAgICAgICAgKiBkdWUg\ndG8gdGhlIGV4aXN0aW5nIGRlbGVnYXRpb24gaGllcmFyY2h5LgogICAgICAg\nICAqLwogICAgICAgIHByb3RlY3RlZCBhYnN0cmFjdCBjbGFzcyBMb2dnaW5n\nQ2FsbGFibGVTdGF0ZW1lbnQgZXh0ZW5kcyAKICAgICAgICAgICAgRGVsZWdh\ndGluZ0NhbGxhYmxlU3RhdGVtZW50IHsKICAgICAgICAgICAgcHJpdmF0ZSBm\naW5hbCBTdHJpbmcgX3NxbDsKICAgICAgICAgICAgcHJpdmF0ZSBMaXN0PFN0\ncmluZz4gX3BhcmFtcyA9IG51bGw7CiAgICAgICAgICAgIHByaXZhdGUgTGlz\ndDxMaXN0PFN0cmluZz4+IF9wYXJhbUJhdGNoID0gbnVsbDsKICAgICAgICAg\nICAgLy9XaGVuIGJhdGNoaW5nIGlzIHVzZWQsIHRoaXMgdmFyaWFibGUgY29u\ndGFpbnMgdGhlIGluZGV4IGludG8gdGhlIGxhc3QKICAgICAgICAgICAgLy9z\ndWNjZXNzZnVsbHkgZXhlY3V0ZWQgYmF0Y2hlZCBzdGF0ZW1lbnQuCiAgICAg\nICAgICAgIGludCBiYXRjaGVkUm93c0Jhc2VJbmRleCA9IDA7ICAgICAgICAg\nICAgCgogICAgICAgICAgICBwdWJsaWMgTG9nZ2luZ0NhbGxhYmxlU3RhdGVt\nZW50KENhbGxhYmxlU3RhdGVtZW50IHN0bXQsIFN0cmluZyBzcWwpIAogICAg\nICAgICAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgCQlz\ndXBlcihzdG10LCBMb2dnaW5nQ29ubmVjdGlvbi50aGlzKTsKICAgICAgICAJ\nCV9zcWwgPSBzcWw7CiAgICAgICAgCX0KICAgICAgICAJCiAgICAgICAgICAg\nIHByaXZhdGUgTG9nZ2luZ1Jlc3VsdFNldCBuZXdMb2dnaW5nUmVzdWx0U2V0\nKFJlc3VsdFNldCBycywKICAgICAgICAgICAgICAgIENhbGxhYmxlU3RhdGVt\nZW50IHN0bW50KSB7CiAgICAgICAgICAgICAgICByZXR1cm4gQ29uY3JldGVD\nbGFzc0dlbmVyYXRvci4KICAgICAgICAgICAgICAgICAgICBuZXdJbnN0YW5j\nZShsb2dnaW5nUmVzdWx0U2V0SW1wbCwKICAgICAgICAgICAgICAgICAgICBM\nb2dnaW5nQ29ubmVjdGlvbi5jbGFzcywgTG9nZ2luZ0Nvbm5lY3Rpb24udGhp\ncywKICAgICAgICAgICAgICAgICAgICBSZXN1bHRTZXQuY2xhc3MsIHJzLAog\nICAgICAgICAgICAgICAgICAgIENhbGxhYmxlU3RhdGVtZW50LmNsYXNzLCBz\ndG1udCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgCiAgICAgICAgICAg\nIHByb3RlY3RlZCBSZXN1bHRTZXQgd3JhcFJlc3VsdChSZXN1bHRTZXQgcnMs\nIGJvb2xlYW4gd3JhcCkgewogICAgICAgICAgICAgICAgaWYgKCF3cmFwIHx8\nIHJzID09IG51bGwpCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVy\nLndyYXBSZXN1bHQod3JhcCwgcnMpOwogICAgICAgICAgICAgICAgcmV0dXJu\nIG5ld0xvZ2dpbmdSZXN1bHRTZXQocnMsIHRoaXMpOwogICAgICAgICAgICB9\nCgogICAgICAgICAgICBwcm90ZWN0ZWQgUmVzdWx0U2V0IGV4ZWN1dGVRdWVy\neShTdHJpbmcgc3FsLCBib29sZWFuIHdyYXApCiAgICAgICAgICAgICAgICB0\naHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAgICAgICAgIGxvZ1NRTCh0\naGlzKTsKICAgICAgICAgICAgICAgIGxvbmcgc3RhcnQgPSBTeXN0ZW0uY3Vy\ncmVudFRpbWVNaWxsaXMoKTsKICAgICAgICAgICAgICAgIFNRTEV4Y2VwdGlv\nbiBlcnIgPSBudWxsOwogICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAg\nICAgICAgICAgICByZXR1cm4gc3VwZXIuZXhlY3V0ZVF1ZXJ5KHNxbCwgd3Jh\ncCk7CiAgICAgICAgICAgICAgICB9IGNhdGNoIChTUUxFeGNlcHRpb24gc2Up\nIHsKICAgICAgICAgICAgICAgICAgICBlcnIgPSB3cmFwKHNlLCBMb2dnaW5n\nQ2FsbGFibGVTdGF0ZW1lbnQudGhpcywgc3FsKTsKICAgICAgICAgICAgICAg\nICAgICB0aHJvdyBlcnI7CiAgICAgICAgICAgICAgICB9IGZpbmFsbHkgewog\nICAgICAgICAgICAgICAgICAgIGxvZ1RpbWUoc3RhcnQpOwogICAgICAgICAg\nICAgICAgICAgIGNsZWFyTG9nUGFyYW1ldGVycyh0cnVlKTsKICAgICAgICAg\nICAgICAgICAgICBoYW5kbGVTUUxFcnJvcnMoTG9nZ2luZ0NhbGxhYmxlU3Rh\ndGVtZW50LnRoaXMsIGVycik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAg\nICAgIH0KCiAgICAgICAgICAgIHB1YmxpYyBpbnQgZXhlY3V0ZVVwZGF0ZShT\ndHJpbmcgc3FsKSB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAgICAg\nICAgIGxvZ1NRTCh0aGlzKTsKICAgICAgICAgICAgICAgIGxvbmcgc3RhcnQg\nPSBTeXN0ZW0uY3VycmVudFRpbWVNaWxsaXMoKTsKICAgICAgICAgICAgICAg\nIFNRTEV4Y2VwdGlvbiBlcnIgPSBudWxsOwogICAgICAgICAgICAgICAgdHJ5\nIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZXhlY3V0ZVVw\nZGF0ZShzcWwpOwogICAgICAgICAgICAgICAgfSBjYXRjaCAoU1FMRXhjZXB0\naW9uIHNlKSB7CiAgICAgICAgICAgICAgICAgICAgZXJyID0gd3JhcChzZSwg\nTG9nZ2luZ0NhbGxhYmxlU3RhdGVtZW50LnRoaXMsIHNxbCk7CiAgICAgICAg\nICAgICAgICAgICAgdGhyb3cgZXJyOwogICAgICAgICAgICAgICAgfSBmaW5h\nbGx5IHsKICAgICAgICAgICAgICAgICAgICBsb2dUaW1lKHN0YXJ0KTsKICAg\nICAgICAgICAgICAgICAgICBjbGVhckxvZ1BhcmFtZXRlcnModHJ1ZSk7CiAg\nICAgICAgICAgICAgICAgICAgaGFuZGxlU1FMRXJyb3JzKExvZ2dpbmdDYWxs\nYWJsZVN0YXRlbWVudC50aGlzLCBlcnIpOwogICAgICAgICAgICAgICAgfQog\nICAgICAgICAgICB9CgogICAgICAgICAgICBwdWJsaWMgYm9vbGVhbiBleGVj\ndXRlKFN0cmluZyBzcWwpIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAg\nICAgICAgICAgbG9nU1FMKHRoaXMpOwogICAgICAgICAgICAgICAgbG9uZyBz\ndGFydCA9IFN5c3RlbS5jdXJyZW50VGltZU1pbGxpcygpOwogICAgICAgICAg\nICAgICAgU1FMRXhjZXB0aW9uIGVyciA9IG51bGw7CiAgICAgICAgICAgICAg\nICB0cnkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5leGVj\ndXRlKHNxbCk7CiAgICAgICAgICAgICAgICB9IGNhdGNoIChTUUxFeGNlcHRp\nb24gc2UpIHsKICAgICAgICAgICAgICAgICAgICBlcnIgPSB3cmFwKHNlLCBM\nb2dnaW5nQ2FsbGFibGVTdGF0ZW1lbnQudGhpcywgc3FsKTsKICAgICAgICAg\nICAgICAgICAgICB0aHJvdyBlcnI7CiAgICAgICAgICAgICAgICB9IGZpbmFs\nbHkgewogICAgICAgICAgICAgICAgICAgIGxvZ1RpbWUoc3RhcnQpOwogICAg\nICAgICAgICAgICAgICAgIGNsZWFyTG9nUGFyYW1ldGVycyh0cnVlKTsKICAg\nICAgICAgICAgICAgICAgICBoYW5kbGVTUUxFcnJvcnMoTG9nZ2luZ0NhbGxh\nYmxlU3RhdGVtZW50LnRoaXMsIGVycik7CiAgICAgICAgICAgICAgICB9CiAg\nICAgICAgICAgIH0KCiAgICAgICAgICAgIHByb3RlY3RlZCBSZXN1bHRTZXQg\nZXhlY3V0ZVF1ZXJ5KGJvb2xlYW4gd3JhcCkgdGhyb3dzIFNRTEV4Y2VwdGlv\nbiB7CiAgICAgICAgICAgICAgICBsb2dTUUwodGhpcyk7CiAgICAgICAgICAg\nICAgICBsb25nIHN0YXJ0ID0gU3lzdGVtLmN1cnJlbnRUaW1lTWlsbGlzKCk7\nCiAgICAgICAgICAgICAgICBTUUxFeGNlcHRpb24gZXJyID0gbnVsbDsKICAg\nICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJu\nIHN1cGVyLmV4ZWN1dGVRdWVyeSh3cmFwKTsKICAgICAgICAgICAgICAgIH0g\nY2F0Y2ggKFNRTEV4Y2VwdGlvbiBzZSkgewogICAgICAgICAgICAgICAgICAg\nIGVyciA9IHdyYXAoc2UsIExvZ2dpbmdDYWxsYWJsZVN0YXRlbWVudC50aGlz\nKTsKICAgICAgICAgICAgICAgICAgICB0aHJvdyBlcnI7CiAgICAgICAgICAg\nICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICAgICAgICAgIGxvZ1RpbWUo\nc3RhcnQpOwogICAgICAgICAgICAgICAgICAgIGNsZWFyTG9nUGFyYW1ldGVy\ncyh0cnVlKTsKICAgICAgICAgICAgICAgICAgICBoYW5kbGVTUUxFcnJvcnMo\nTG9nZ2luZ0NhbGxhYmxlU3RhdGVtZW50LnRoaXMsIGVycik7CiAgICAgICAg\nICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHB1YmxpYyBp\nbnQgZXhlY3V0ZVVwZGF0ZSgpIHRocm93cyBTUUxFeGNlcHRpb24gewogICAg\nICAgICAgICAgICAgbG9nU1FMKHRoaXMpOwogICAgICAgICAgICAgICAgbG9u\nZyBzdGFydCA9IFN5c3RlbS5jdXJyZW50VGltZU1pbGxpcygpOwogICAgICAg\nICAgICAgICAgU1FMRXhjZXB0aW9uIGVyciA9IG51bGw7ICAgICAgICAgICAg\nICAgIAogICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAg\nICByZXR1cm4gc3VwZXIuZXhlY3V0ZVVwZGF0ZSgpOwogICAgICAgICAgICAg\nICAgfSBjYXRjaCAoU1FMRXhjZXB0aW9uIHNlKSB7CiAgICAgICAgICAgICAg\nICAgICAgZXJyID0gd3JhcChzZSwgTG9nZ2luZ0NhbGxhYmxlU3RhdGVtZW50\nLnRoaXMpOwogICAgICAgICAgICAgICAgICAgIHRocm93IGVycjsKICAgICAg\nICAgICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgICAgICAgICAgbG9n\nVGltZShzdGFydCk7CiAgICAgICAgICAgICAgICAgICAgY2xlYXJMb2dQYXJh\nbWV0ZXJzKHRydWUpOwogICAgICAgICAgICAgICAgICAgIGhhbmRsZVNRTEVy\ncm9ycyhMb2dnaW5nQ2FsbGFibGVTdGF0ZW1lbnQudGhpcywgZXJyKTsKICAg\nICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHVi\nbGljIGludFtdIGV4ZWN1dGVCYXRjaCgpIHRocm93cyBTUUxFeGNlcHRpb24g\newogICAgICAgICAgICAgICAgaW50IGluZGV4T2ZGaXJzdEZhaWxlZE9iamVj\ndCA9IC0xOwoKICAgICAgICAgICAgICAgIGxvZ0JhdGNoU1FMKHRoaXMpOwog\nICAgICAgICAgICAgICAgbG9uZyBzdGFydCA9IFN5c3RlbS5jdXJyZW50VGlt\nZU1pbGxpcygpOwogICAgICAgICAgICAgICAgU1FMRXhjZXB0aW9uIGVyciA9\nIG51bGw7ICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgdHJ5IHsK\nICAgICAgICAgICAgICAgICAgICBpbnRbXSB0b1JldHVybiA9IHN1cGVyLmV4\nZWN1dGVCYXRjaCgpOwogICAgICAgICAgICAgICAgICAgIC8vZXhlY3V0ZUJh\ndGNoIGlzIGNhbGxlZCBhbnkgdGltZSB0aGUgbnVtYmVyIG9mIGJhdGNoZWQg\nc3RhdGVtZW50cwogICAgICAgICAgICAgICAgICAgIC8vaXMgZXF1YWwgdG8s\nIG9yIGxlc3MgdGhhbiwgYmF0Y2hMaW1pdC4gIEluIHRoZSAnY2F0Y2gnIGJs\nb2NrIGJlbG93LCAKICAgICAgICAgICAgICAgICAgICAvL3RoZSBsb2dpYyBz\nZWVrcyB0byBmaW5kIGFuIGluZGV4IGJhc2VkIG9uIHRoZSBjdXJyZW50IGV4\nZWN1dGVCYXRjaCAKICAgICAgICAgICAgICAgICAgICAvL3Jlc3VsdHMuICBU\naGlzIGlzIGZpbmUgd2hlbiBleGVjdXRlQmF0Y2ggaXMgb25seSBjYWxsZWQg\nb25jZSwgYnV0IAogICAgICAgICAgICAgICAgICAgIC8vaWYgZXhlY3V0ZUJh\ndGNoIGlzIGNhbGxlZCBtYW55IHRpbWVzLCB0aGUgX3BhcmFtc0JhdGNoIHdp\nbGwgY29udGludWUgCiAgICAgICAgICAgICAgICAgICAgLy90byBncm93LCBh\ncyBzdWNoLCB0byBpbmRleCBpbnRvIF9wYXJhbXNCYXRjaCwgd2UgbmVlZCB0\nbyB0YWtlIGludG8gCiAgICAgICAgICAgICAgICAgICAgLy9hY2NvdW50IHRo\nZSBudW1iZXIgb2YgdGltZXMgZXhlY3V0ZUJhdGNoIGlzIGNhbGxlZCBpbiBv\ncmRlciB0byAKICAgICAgICAgICAgICAgICAgICAvL2NvcnJlY3RseSBpbmRl\neCBpbnRvIF9wYXJhbXNCYXRjaC4gIFRvIHRoYXQgZW5kLCBlYWNoIHRpbWUg\nZXhlY3V0ZUJhdGNoIAogICAgICAgICAgICAgICAgICAgIC8vaXMgY2FsbGVk\nLCBsZXRzIGdldCB0aGUgc2l6ZSBvZiBfcGFyYW1CYXRjaC4gIFRoaXMgd2ls\nbCBlZmZlY3RpdmVseSAKICAgICAgICAgICAgICAgICAgICAvL3RlbGwgdXMg\ndGhlIGluZGV4IG9mIHRoZSBsYXN0IHN1Y2Nlc3NmdWxseSBleGVjdXRlZCBi\nYXRjaCBzdGF0ZW1lbnQuICAKICAgICAgICAgICAgICAgICAgICAvL0lmIGFu\nIGV4Y2VwdGlvbiBpcyBjYXVzZWQsIHRoZW4gd2Uga25vdyB0aGF0IF9wYXJh\nbUJhdGNoLnNpemUgd2FzIAogICAgICAgICAgICAgICAgICAgIC8vdGhlIGlu\nZGV4IG9mIHRoZSBMQVNUIHJvdyB0byBzdWNjZXNzZnVsbHkgZXhlY3V0ZS4K\nICAgICAgICAgICAgICAgICAgICBpZiAoX3BhcmFtQmF0Y2ggIT0gbnVsbCl7\nCiAgICAgICAgICAgICAgICAgICAgICAgIGJhdGNoZWRSb3dzQmFzZUluZGV4\nID0gX3BhcmFtQmF0Y2guc2l6ZSgpOyAgICAgICAgICAgICAgICAgICAgICAg\nIAogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBy\nZXR1cm4gdG9SZXR1cm47IAogICAgICAgICAgICAgICAgfSBjYXRjaCAoU1FM\nRXhjZXB0aW9uIHNlKSB7CiAgICAgICAgICAgICAgICAgICAgLy8gaWYgdGhl\nIGV4Y2VwdGlvbiBpcyBhIEJhdGNoVXBkYXRlRXhjZXB0aW9uLCBhbmQKICAg\nICAgICAgICAgICAgICAgICAvLyB3ZSBhcmUgdHJhY2tpbmcgcGFyYW1ldGVy\ncywgdGhlbiBzZXQgdGhlIGN1cnJlbnQKICAgICAgICAgICAgICAgICAgICAv\nLyBwYXJhbWV0ZXIgc2V0IHRvIGJlIHRoZSBpbmRleCBvZiB0aGUgZmFpbGVk\nCiAgICAgICAgICAgICAgICAgICAgLy8gc3RhdGVtZW50IHNvIHRoYXQgdGhl\nIFJlcG9ydGluZ1NRTEV4Y2VwdGlvbiB3aWxsCiAgICAgICAgICAgICAgICAg\nICAgLy8gc2hvdyB0aGUgY29ycmVjdCBwYXJhbQogICAgICAgICAgICAgICAg\nICAgIGlmIChzZSBpbnN0YW5jZW9mIEJhdGNoVXBkYXRlRXhjZXB0aW9uCiAg\nICAgICAgICAgICAgICAgICAgICAgICYmIF9wYXJhbUJhdGNoICE9IG51bGwg\nJiYgc2hvdWxkVHJhY2tQYXJhbWV0ZXJzKCkpIHsKICAgICAgICAgICAgICAg\nICAgICAgICAgaW50W10gY291bnQgPSAoKEJhdGNoVXBkYXRlRXhjZXB0aW9u\nKSBzZSkuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnZXRVcGRhdGVD\nb3VudHMoKTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvdW50ICE9\nIG51bGwgJiYgY291bnQubGVuZ3RoIDw9IF9wYXJhbUJhdGNoLnNpemUoKSkK\nICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAg\nICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBjb3VudC5sZW5ndGg7IGkr\nKykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIC0zIGlz\nIFN0YXRlbWVudC5TVEFURU1FTlRfRkFJTEVELCBidXQgaXMKICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAvLyBvbmx5IGF2YWlsYWJsZSBpbiBK\nREsgMS40KwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChj\nb3VudFtpXSA9PSBTdGF0ZW1lbnQuRVhFQ1VURV9GQUlMRUQpIHsKICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5kZXhPZkZpcnN0RmFp\nbGVkT2JqZWN0ID0gaTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAg\nICAgICAgICAgICAgICAgIC8vIG5vIC0zIGVsZW1lbnQ6IGl0IG1heSBiZSB0\naGF0IHRoZSBzZXJ2ZXIgc3RvcHBlZAogICAgICAgICAgICAgICAgICAgICAg\nICAgICAgLy8gcHJvY2Vzc2luZywgc28gdGhlIHNpemUgb2YgdGhlIGNvdW50\nIHdpbGwgYmUKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRoZSBp\nbmRleAogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9TZWUgdGhlIEph\ndmFkb2MgZm9yICdnZXRVcGRhdGVDb3VudHMnOyBhIHByb3ZpZGVyIAogICAg\nICAgICAgICAgICAgICAgICAgICAgICAgLy9tYXkgc3RvcCBwcm9jZXNzaW5n\nIHdoZW4gdGhlIGZpcnN0IGZhaWx1cmUgb2NjdXJzLCAKICAgICAgICAgICAg\nICAgICAgICAgICAgICAgIC8vYXMgc3VjaCwgaXQgbWF5IG9ubHkgcmV0dXJu\nICdVcGRhdGVDb3VudHMnIGZvciB0aGUgCiAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAvL2ZpcnN0IGZldyB3aGljaCBwYXNzLiAgQXMgc3VjaCwgdGhl\nIGZhaWxlZCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vaW5kZXgg\naXMgJ2NvdW50Lmxlbmd0aCcsIE5PVCBjb3VudC5sZW5ndGgrMS4gIFRoYXQK\nICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vaXMsIGlmIHRoZSBwcm92\naWRlciBPTkxZIHJldHVybnMgdGhlIGZpcnN0IGZldyB0aGF0IAogICAgICAg\nICAgICAgICAgICAgICAgICAgICAgLy9wYXNzZXMgKGkuZS4gc2F5IGFuIGFy\ncmF5IG9mIFsxLDFdIGlzIHJldHVybmVkKSB0aGVuCiAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAvL2xlbmd0aCBpcyAyLCBhbmQgc2luY2UgX3BhcmFt\nQmF0Y2ggc3RhcnRzIGF0IDAsIHdlIAogICAgICAgICAgICAgICAgICAgICAg\nICAgICAgLy9kb24ndCB3YW50IHRvIHVzZSBsZW5ndGgrMSBhcyB0aGF0IHdp\nbGwgZ2l2ZSB1cyB0aGUgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAv\nL3dyb25nIGluZGV4LgogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYg\nKGluZGV4T2ZGaXJzdEZhaWxlZE9iamVjdCA9PSAtMSl7CiAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgaW5kZXhPZkZpcnN0RmFpbGVkT2JqZWN0\nID0gY291bnQubGVuZ3RoOwogICAgICAgICAgICAgICAgICAgICAgICAgICAg\nfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAvL0ZpbmFsbHksIHdoYXRldmVyIHRoZSBpbmRleCBp\ncyBhdCB0aGlzIHBvaW50LCBhZGQgYmF0Y2hlZFJvd3NCYXNlSW5kZXgKICAg\nICAgICAgICAgICAgICAgICAgICAgICAgIC8vdG8gaXQgdG8gZ2V0IHRoZSBm\naW5hbCBpbmRleC4gIFJlY2FsbCwgd2UgbmVlZCB0byBzdGFydCBvdXIgaW5k\nZXggZnJvbSB0aGUKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vbGFz\ndCBiYXRjaCB3aGljaCBzdWNjZXNzZnVsbHkgZXhlY3V0ZWQuCiAgICAgICAg\nICAgICAgICAgICAgICAgICAgICBpbmRleE9mRmlyc3RGYWlsZWRPYmplY3Qg\nKz0gYmF0Y2hlZFJvd3NCYXNlSW5kZXg7CgogICAgICAgICAgICAgICAgICAg\nICAgICAgICAgLy8gc2V0IHRoZSBjdXJyZW50IHBhcmFtcyB0byB0aGUgc2F2\nZWQgdmFsdWVzCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaW5k\nZXhPZkZpcnN0RmFpbGVkT2JqZWN0IDwgX3BhcmFtQmF0Y2guc2l6ZSgpKXsK\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfcGFyYW1zID0gKExp\nc3Q8U3RyaW5nPikgX3BhcmFtQmF0Y2guZ2V0KGluZGV4T2ZGaXJzdEZhaWxl\nZE9iamVjdCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAg\nICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAg\nICAgICAgICAgICAgICAgICAgZXJyID0gd3JhcChzZSwgTG9nZ2luZ0NhbGxh\nYmxlU3RhdGVtZW50LnRoaXMsIGluZGV4T2ZGaXJzdEZhaWxlZE9iamVjdCk7\nCiAgICAgICAgICAgICAgICAgICAgdGhyb3cgZXJyOwogICAgICAgICAgICAg\nICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgICAgICAgICBsb2dUaW1lKHN0\nYXJ0KTsKICAgICAgICAgICAgICAgICAgICBoYW5kbGVTUUxFcnJvcnMoTG9n\nZ2luZ0NhbGxhYmxlU3RhdGVtZW50LnRoaXMsIGVycik7CiAgICAgICAgICAg\nICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHB1YmxpYyBib29s\nZWFuIGV4ZWN1dGUoKSB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAg\nICAgICAgIGxvZ1NRTCh0aGlzKTsKICAgICAgICAgICAgICAgIGxvbmcgc3Rh\ncnQgPSBTeXN0ZW0uY3VycmVudFRpbWVNaWxsaXMoKTsKICAgICAgICAgICAg\nICAgIFNRTEV4Y2VwdGlvbiBlcnIgPSBudWxsOyAgICAgICAgICAgICAgICAK\nICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgcmV0\ndXJuIHN1cGVyLmV4ZWN1dGUoKTsKICAgICAgICAgICAgICAgIH0gY2F0Y2gg\nKFNRTEV4Y2VwdGlvbiBzZSkgewogICAgICAgICAgICAgICAgICAgIGVyciA9\nIHdyYXAoc2UsIExvZ2dpbmdDYWxsYWJsZVN0YXRlbWVudC50aGlzKTsKICAg\nICAgICAgICAgICAgICAgICB0aHJvdyBlcnI7CiAgICAgICAgICAgICAgICB9\nIGZpbmFsbHkgewogICAgICAgICAgICAgICAgICAgIGxvZ1RpbWUoc3RhcnQp\nOwogICAgICAgICAgICAgICAgICAgIGNsZWFyTG9nUGFyYW1ldGVycyh0cnVl\nKTsKICAgICAgICAgICAgICAgICAgICBoYW5kbGVTUUxFcnJvcnMoTG9nZ2lu\nZ0NhbGxhYmxlU3RhdGVtZW50LnRoaXMsIGVycik7CiAgICAgICAgICAgICAg\nICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHB1YmxpYyB2b2lkIGNh\nbmNlbCgpIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgICAgICAgICAg\naWYgKF9sb2dzLmlzSkRCQ0VuYWJsZWQoKSkKICAgICAgICAgICAgICAgICAg\nICBfbG9ncy5sb2dKREJDKCJjYW5jZWwgIiArIHRoaXMgKyAiOiAiICsgX3Nx\nbCwKICAgICAgICAgICAgICAgICAgICAgICAgTG9nZ2luZ0Nvbm5lY3Rpb24u\ndGhpcyk7CgogICAgICAgICAgICAgICAgc3VwZXIuY2FuY2VsKCk7CiAgICAg\nICAgICAgIH0KCiAgICAgICAgICAgIHB1YmxpYyB2b2lkIHNldE51bGwoaW50\nIGkxLCBpbnQgaTIpIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgICAg\nICAgICAgc2V0TG9nUGFyYW1ldGVyKGkxLCAibnVsbCIsIG51bGwpOwogICAg\nICAgICAgICAgICAgc3VwZXIuc2V0TnVsbChpMSwgaTIpOwogICAgICAgICAg\nICB9CgogICAgICAgICAgICBwdWJsaWMgdm9pZCBzZXRCb29sZWFuKGludCBp\nLCBib29sZWFuIGIpIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgICAg\nICAgICAgc2V0TG9nUGFyYW1ldGVyKGksIGIpOwogICAgICAgICAgICAgICAg\nc3VwZXIuc2V0Qm9vbGVhbihpLCBiKTsKICAgICAgICAgICAgfQoKICAgICAg\nICAgICAgcHVibGljIHZvaWQgc2V0Qnl0ZShpbnQgaSwgYnl0ZSBiKSB0aHJv\nd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAgICAgICAgIHNldExvZ1BhcmFt\nZXRlcihpLCBiKTsKICAgICAgICAgICAgICAgIHN1cGVyLnNldEJ5dGUoaSwg\nYik7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHB1YmxpYyB2b2lkIHNl\ndFNob3J0KGludCBpLCBzaG9ydCBzKSB0aHJvd3MgU1FMRXhjZXB0aW9uIHsK\nICAgICAgICAgICAgICAgIHNldExvZ1BhcmFtZXRlcihpLCBzKTsKICAgICAg\nICAgICAgICAgIHN1cGVyLnNldFNob3J0KGksIHMpOwogICAgICAgICAgICB9\nCgogICAgICAgICAgICBwdWJsaWMgdm9pZCBzZXRJbnQoaW50IGkxLCBpbnQg\naTIpIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgICAgICAgICAgc2V0\nTG9nUGFyYW1ldGVyKGkxLCBpMik7CiAgICAgICAgICAgICAgICBzdXBlci5z\nZXRJbnQoaTEsIGkyKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHVi\nbGljIHZvaWQgc2V0TG9uZyhpbnQgaSwgbG9uZyBsKSB0aHJvd3MgU1FMRXhj\nZXB0aW9uIHsKICAgICAgICAgICAgICAgIHNldExvZ1BhcmFtZXRlcihpLCBs\nKTsKICAgICAgICAgICAgICAgIHN1cGVyLnNldExvbmcoaSwgbCk7CiAgICAg\nICAgICAgIH0KCiAgICAgICAgICAgIHB1YmxpYyB2b2lkIHNldEZsb2F0KGlu\ndCBpLCBmbG9hdCBmKSB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAg\nICAgICAgIHNldExvZ1BhcmFtZXRlcihpLCBmKTsKICAgICAgICAgICAgICAg\nIHN1cGVyLnNldEZsb2F0KGksIGYpOwogICAgICAgICAgICB9CgogICAgICAg\nICAgICBwdWJsaWMgdm9pZCBzZXREb3VibGUoaW50IGksIGRvdWJsZSBkKSB0\naHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAgICAgICAgIHNldExvZ1Bh\ncmFtZXRlcihpLCBkKTsKICAgICAgICAgICAgICAgIHN1cGVyLnNldERvdWJs\nZShpLCBkKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHVibGljIHZv\naWQgc2V0QmlnRGVjaW1hbChpbnQgaSwgQmlnRGVjaW1hbCBiZCkKICAgICAg\nICAgICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgICAgICAg\nICAgc2V0TG9nUGFyYW1ldGVyKGksICJCaWdEZWNpbWFsIiwgYmQpOwogICAg\nICAgICAgICAgICAgc3VwZXIuc2V0QmlnRGVjaW1hbChpLCBiZCk7CiAgICAg\nICAgICAgIH0KCiAgICAgICAgICAgIHB1YmxpYyB2b2lkIHNldFN0cmluZyhp\nbnQgaSwgU3RyaW5nIHMpIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAg\nICAgICAgICAgc2V0TG9nUGFyYW1ldGVyKGksICJTdHJpbmciLCBzKTsKICAg\nICAgICAgICAgICAgIHN1cGVyLnNldFN0cmluZyhpLCBzKTsKICAgICAgICAg\nICAgfQoKICAgICAgICAgICAgcHVibGljIHZvaWQgc2V0Qnl0ZXMoaW50IGks\nIGJ5dGVbXSBiKSB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAgICAg\nICAgIHNldExvZ1BhcmFtZXRlcihpLCAiYnl0ZVtdIiwgYik7CiAgICAgICAg\nICAgICAgICBzdXBlci5zZXRCeXRlcyhpLCBiKTsKICAgICAgICAgICAgfQoK\nICAgICAgICAgICAgcHVibGljIHZvaWQgc2V0RGF0ZShpbnQgaSwgRGF0ZSBk\nKSB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAgICAgICAgIHNldExv\nZ1BhcmFtZXRlcihpLCAiRGF0ZSIsIGQpOwogICAgICAgICAgICAgICAgc3Vw\nZXIuc2V0RGF0ZShpLCBkKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAg\ncHVibGljIHZvaWQgc2V0VGltZShpbnQgaSwgVGltZSB0KSB0aHJvd3MgU1FM\nRXhjZXB0aW9uIHsKICAgICAgICAgICAgICAgIHNldExvZ1BhcmFtZXRlcihp\nLCAiVGltZSIsIHQpOwogICAgICAgICAgICAgICAgc3VwZXIuc2V0VGltZShp\nLCB0KTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHVibGljIHZvaWQg\nc2V0VGltZXN0YW1wKGludCBpLCBUaW1lc3RhbXAgdCkgdGhyb3dzIFNRTEV4\nY2VwdGlvbiB7CiAgICAgICAgICAgICAgICBzZXRMb2dQYXJhbWV0ZXIoaSwg\nIlRpbWVzdGFtcCIsIHQpOwogICAgICAgICAgICAgICAgc3VwZXIuc2V0VGlt\nZXN0YW1wKGksIHQpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBwdWJs\naWMgdm9pZCBzZXRBc2NpaVN0cmVhbShpbnQgaTEsIElucHV0U3RyZWFtIGlz\nLCBpbnQgaTIpCiAgICAgICAgICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9u\nIHsKICAgICAgICAgICAgICAgIHNldExvZ1BhcmFtZXRlcihpMSwgIklucHV0\nU3RyZWFtIiwgaXMpOwogICAgICAgICAgICAgICAgc3VwZXIuc2V0QXNjaWlT\ndHJlYW0oaTEsIGlzLCBpMik7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAg\nIEBEZXByZWNhdGVkCiAgICAgICAgICAgIHB1YmxpYyB2b2lkIHNldFVuaWNv\nZGVTdHJlYW0oaW50IGkxLCBJbnB1dFN0cmVhbSBpcywgaW50IGkyKQogICAg\nICAgICAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgICAg\nICAgICBzZXRMb2dQYXJhbWV0ZXIoaTEsICJJbnB1dFN0cmVhbSIsIGlzKTsK\nICAgICAgICAgICAgICAgIHN1cGVyLnNldFVuaWNvZGVTdHJlYW0oaTIsIGlz\nLCBpMik7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHB1YmxpYyB2b2lk\nIHNldEJpbmFyeVN0cmVhbShpbnQgaTEsIElucHV0U3RyZWFtIGlzLCBpbnQg\naTIpCiAgICAgICAgICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAg\nICAgICAgICAgICAgIHNldExvZ1BhcmFtZXRlcihpMSwgIklucHV0U3RyZWFt\nIiwgaXMpOwogICAgICAgICAgICAgICAgc3VwZXIuc2V0QmluYXJ5U3RyZWFt\nKGkxLCBpcywgaTIpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBwdWJs\naWMgdm9pZCBjbGVhclBhcmFtZXRlcnMoKSB0aHJvd3MgU1FMRXhjZXB0aW9u\nIHsKICAgICAgICAgICAgICAgIGNsZWFyTG9nUGFyYW1ldGVycyhmYWxzZSk7\nCiAgICAgICAgICAgICAgICBzdXBlci5jbGVhclBhcmFtZXRlcnMoKTsKICAg\nICAgICAgICAgfQoKICAgICAgICAgICAgcHVibGljIHZvaWQgc2V0T2JqZWN0\nKGludCBpMSwgT2JqZWN0IG8sIGludCBpMiwgaW50IGkzKQogICAgICAgICAg\nICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgICAgICAgICBz\nZXRMb2dQYXJhbWV0ZXIoaTEsICJPYmplY3QiLCBvKTsKICAgICAgICAgICAg\nICAgIHN1cGVyLnNldE9iamVjdChpMSwgbywgaTIsIGkzKTsKICAgICAgICAg\nICAgfQoKICAgICAgICAgICAgcHVibGljIHZvaWQgc2V0T2JqZWN0KGludCBp\nMSwgT2JqZWN0IG8sIGludCBpMikKICAgICAgICAgICAgICAgIHRocm93cyBT\nUUxFeGNlcHRpb24gewogICAgICAgICAgICAgICAgc2V0TG9nUGFyYW1ldGVy\nKGkxLCAiT2JqZWN0Iiwgbyk7CiAgICAgICAgICAgICAgICBzdXBlci5zZXRP\nYmplY3QoaTEsIG8sIGkyKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAg\ncHVibGljIHZvaWQgc2V0T2JqZWN0KGludCBpLCBPYmplY3QgbykgdGhyb3dz\nIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgICAgICAgICBzZXRMb2dQYXJhbWV0\nZXIoaSwgIk9iamVjdCIsIG8pOwogICAgICAgICAgICAgICAgc3VwZXIuc2V0\nT2JqZWN0KGksIG8pOwogICAgICAgICAgICB9CgogICAgICAgICAgICBwdWJs\naWMgdm9pZCBhZGRCYXRjaCgpIHRocm93cyBTUUxFeGNlcHRpb24gewogICAg\nICAgICAgICAgICAgaWYgKF9sb2dzLmlzU1FMRW5hYmxlZCgpKQogICAgICAg\nICAgICAgICAgICAgIF9sb2dzLmxvZ1NRTCgiYmF0Y2hpbmcgIiArIHRoaXMs\nIExvZ2dpbmdDb25uZWN0aW9uLnRoaXMpOwogICAgICAgICAgICAgICAgbG9u\nZyBzdGFydCA9IFN5c3RlbS5jdXJyZW50VGltZU1pbGxpcygpOwogICAgICAg\nICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICBzdXBlci5hZGRC\nYXRjaCgpOwogICAgICAgICAgICAgICAgICAgIGlmIChzaG91bGRUcmFja1Bh\ncmFtZXRlcnMoKSkgewogICAgICAgICAgICAgICAgICAgICAgICAvLyBtYWtl\nIHN1cmUgb3VyIGxpc3QgaXMgaW5pdGlhbGl6ZWQKICAgICAgICAgICAgICAg\nICAgICAgICAgaWYgKF9wYXJhbUJhdGNoID09IG51bGwpCiAgICAgICAgICAg\nICAgICAgICAgICAgICAgICBfcGFyYW1CYXRjaCA9IG5ldyBBcnJheUxpc3Q8\nTGlzdDxTdHJpbmc+PigpOwogICAgICAgICAgICAgICAgICAgICAgICAvLyBj\nb3B5IHBhcmFtZXRlcnMgc2luY2UgdGhleSB3aWxsIGJlIHJlLXVzZWQKICAg\nICAgICAgICAgICAgICAgICAgICAgaWYgKF9wYXJhbXMgIT0gbnVsbCkgewog\nICAgICAgICAgICAgICAgICAgICAgICAgICAgTGlzdDxTdHJpbmc+IGNvcHlQ\nYXJhbXMgPQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBB\ncnJheUxpc3Q8U3RyaW5nPihfcGFyYW1zKTsKICAgICAgICAgICAgICAgICAg\nICAgICAgICAgIF9wYXJhbUJhdGNoLmFkZChjb3B5UGFyYW1zKTsKICAgICAg\nICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBl\nbHNlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfcGFyYW1CYXRjaC5h\nZGQobnVsbCk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAg\nICAgfQogICAgICAgICAgICAgICAgZmluYWxseSB7CiAgICAgICAgICAgICAg\nICAgICAgbG9nVGltZShzdGFydCk7CiAgICAgICAgICAgICAgICB9CiAgICAg\nICAgICAgIH0KCiAgICAgICAgICAgIHB1YmxpYyB2b2lkIHNldENoYXJhY3Rl\nclN0cmVhbShpbnQgaTEsIFJlYWRlciByLCBpbnQgaTIpCiAgICAgICAgICAg\nICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAgICAgICAgIHNl\ndExvZ1BhcmFtZXRlcihpMSwgIlJlYWRlciIsIHIpOwogICAgICAgICAgICAg\nICAgc3VwZXIuc2V0Q2hhcmFjdGVyU3RyZWFtKGkxLCByLCBpMik7CiAgICAg\nICAgICAgIH0KCiAgICAgICAgICAgIHB1YmxpYyB2b2lkIHNldFJlZihpbnQg\naSwgUmVmIHIpIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgICAgICAg\nICAgc2V0TG9nUGFyYW1ldGVyKGksICJSZWYiLCByKTsKICAgICAgICAgICAg\nICAgIHN1cGVyLnNldFJlZihpLCByKTsKICAgICAgICAgICAgfQoKICAgICAg\nICAgICAgcHVibGljIHZvaWQgc2V0QmxvYihpbnQgaSwgQmxvYiBiKSB0aHJv\nd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAgICAgICAgIHNldExvZ1BhcmFt\nZXRlcihpLCAiQmxvYiIsIGIpOwogICAgICAgICAgICAgICAgc3VwZXIuc2V0\nQmxvYihpLCBiKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHVibGlj\nIHZvaWQgc2V0Q2xvYihpbnQgaSwgQ2xvYiBjKSB0aHJvd3MgU1FMRXhjZXB0\naW9uIHsKICAgICAgICAgICAgICAgIHNldExvZ1BhcmFtZXRlcihpLCAiQ2xv\nYiIsIGMpOwogICAgICAgICAgICAgICAgc3VwZXIuc2V0Q2xvYihpLCBjKTsK\nICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHVibGljIHZvaWQgc2V0QXJy\nYXkoaW50IGksIEFycmF5IGEpIHRocm93cyBTUUxFeGNlcHRpb24gewogICAg\nICAgICAgICAgICAgc2V0TG9nUGFyYW1ldGVyKGksICJBcnJheSIsIGEpOwog\nICAgICAgICAgICAgICAgc3VwZXIuc2V0QXJyYXkoaSwgYSk7CiAgICAgICAg\nICAgIH0KCiAgICAgICAgICAgIHB1YmxpYyBSZXN1bHRTZXRNZXRhRGF0YSBn\nZXRNZXRhRGF0YSgpIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgICAg\nICAgICAgcmV0dXJuIHN1cGVyLmdldE1ldGFEYXRhKCk7CiAgICAgICAgICAg\nIH0KCiAgICAgICAgICAgIHB1YmxpYyB2b2lkIHNldERhdGUoaW50IGksIERh\ndGUgZCwgQ2FsZW5kYXIgYykgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAg\nICAgICAgICAgICBzZXRMb2dQYXJhbWV0ZXIoaSwgIkRhdGUiLCBkKTsKICAg\nICAgICAgICAgICAgIHN1cGVyLnNldERhdGUoaSwgZCwgYyk7CiAgICAgICAg\nICAgIH0KCiAgICAgICAgICAgIHB1YmxpYyB2b2lkIHNldFRpbWUoaW50IGks\nIFRpbWUgdCwgQ2FsZW5kYXIgYykgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAg\nICAgICAgICAgICAgICBzZXRMb2dQYXJhbWV0ZXIoaSwgIlRpbWUiLCB0KTsK\nICAgICAgICAgICAgICAgIHN1cGVyLnNldFRpbWUoaSwgdCwgYyk7CiAgICAg\nICAgICAgIH0KCiAgICAgICAgICAgIHB1YmxpYyB2b2lkIHNldFRpbWVzdGFt\ncChpbnQgaSwgVGltZXN0YW1wIHQsIENhbGVuZGFyIGMpCiAgICAgICAgICAg\nICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAgICAgICAgIHNl\ndExvZ1BhcmFtZXRlcihpLCAiVGltZXN0YW1wIiwgdCk7CiAgICAgICAgICAg\nICAgICBzdXBlci5zZXRUaW1lc3RhbXAoaSwgdCwgYyk7CiAgICAgICAgICAg\nIH0KCiAgICAgICAgICAgIHB1YmxpYyB2b2lkIHNldE51bGwoaW50IGkxLCBp\nbnQgaTIsIFN0cmluZyBzKSB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAg\nICAgICAgICAgIHNldExvZ1BhcmFtZXRlcihpMSwgIm51bGwiLCBudWxsKTsK\nICAgICAgICAgICAgICAgIHN1cGVyLnNldE51bGwoaTEsIGkyLCBzKTsKICAg\nICAgICAgICAgfQoKICAgICAgICAgICAgcHJvdGVjdGVkIHZvaWQgYXBwZW5k\nSW5mbyhTdHJpbmdCdWZmZXIgYnVmKSB7CiAgICAgICAgICAgICAgICBidWYu\nYXBwZW5kKCIgIik7CiAgICAgICAgICAgICAgICBpZiAoX2Zvcm1hdHRlciAh\nPSBudWxsKSB7CiAgICAgICAgICAgICAgICAgICAgYnVmLmFwcGVuZChTRVAp\nOwogICAgICAgICAgICAgICAgICAgIGJ1Zi5hcHBlbmQoX2Zvcm1hdHRlci5w\ncmV0dHlQcmludChfc3FsKSk7CiAgICAgICAgICAgICAgICAgICAgYnVmLmFw\ncGVuZChTRVApOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAg\nICAgICAgICAgICBidWYuYXBwZW5kKF9zcWwpOwogICAgICAgICAgICAgICAg\nfQoKICAgICAgICAgICAgICAgIFN0cmluZ0J1aWxkZXIgcGFyYW1CdWYgPSBu\ndWxsOwogICAgICAgICAgICAgICAgaWYgKF9wYXJhbXMgIT0gbnVsbCAmJiAh\nX3BhcmFtcy5pc0VtcHR5KCkpIHsKICAgICAgICAgICAgICAgICAgICBwYXJh\nbUJ1ZiA9IG5ldyBTdHJpbmdCdWlsZGVyKCk7CiAgICAgICAgICAgICAgICAg\nICAgZm9yIChJdGVyYXRvcjxTdHJpbmc+IGl0ciA9IF9wYXJhbXMuaXRlcmF0\nb3IoKTsgaXRyCiAgICAgICAgICAgICAgICAgICAgICAgIC5oYXNOZXh0KCk7\nKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtQnVmLmFwcGVuZChp\ndHIubmV4dCgpKTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGl0ci5o\nYXNOZXh0KCkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJhbUJ1\nZi5hcHBlbmQoIiwgIik7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAg\nICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGlmIChwYXJhbUJ1ZiAhPSBu\ndWxsKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKCFfcHJldHR5UHJpbnQp\nCiAgICAgICAgICAgICAgICAgICAgICAgIGJ1Zi5hcHBlbmQoIiAiKTsKICAg\nICAgICAgICAgICAgICAgICBidWYuYXBwZW5kKCJbcGFyYW1zPSIpLgogICAg\nICAgICAgICAgICAgICAgICAgICBhcHBlbmQocGFyYW1CdWYudG9TdHJpbmco\nKSkuYXBwZW5kKCJdIik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAg\nICAgICBzdXBlci5hcHBlbmRJbmZvKGJ1Zik7CiAgICAgICAgICAgIH0KCiAg\nICAgICAgICAgIHByb3RlY3RlZCB2b2lkIGNsZWFyTG9nUGFyYW1ldGVycyhi\nb29sZWFuIGJhdGNoKSB7CiAgICAgICAgICAgICAgICBpZiAoX3BhcmFtcyAh\nPSBudWxsKQogICAgICAgICAgICAgICAgICAgIF9wYXJhbXMuY2xlYXIoKTsK\nICAgICAgICAgICAgICAgIGlmIChiYXRjaCAmJiBfcGFyYW1CYXRjaCAhPSBu\ndWxsKQogICAgICAgICAgICAgICAgICAgIF9wYXJhbUJhdGNoLmNsZWFyKCk7\nCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHByaXZhdGUgYm9vbGVhbiBz\naG91bGRUcmFja1BhcmFtZXRlcnMoKSB7CiAgICAgICAgICAgICAgICByZXR1\ncm4gX3RyYWNrUGFyYW1ldGVycyB8fCBfbG9ncy5pc1NRTEVuYWJsZWQoKTsK\nICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHJpdmF0ZSB2b2lkIHNldExv\nZ1BhcmFtZXRlcihpbnQgaW5kZXgsIGJvb2xlYW4gdmFsKSB7CiAgICAgICAg\nICAgICAgICBpZiAoc2hvdWxkVHJhY2tQYXJhbWV0ZXJzKCkpCiAgICAgICAg\nICAgICAgICAgICAgc2V0TG9nUGFyYW1ldGVyKGluZGV4LCAiKGJvb2xlYW4p\nICIgKyB2YWwpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBwcml2YXRl\nIHZvaWQgc2V0TG9nUGFyYW1ldGVyKGludCBpbmRleCwgYnl0ZSB2YWwpIHsK\nICAgICAgICAgICAgICAgIGlmIChzaG91bGRUcmFja1BhcmFtZXRlcnMoKSkK\nICAgICAgICAgICAgICAgICAgICBzZXRMb2dQYXJhbWV0ZXIoaW5kZXgsICIo\nYnl0ZSkgIiArIHZhbCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHBy\naXZhdGUgdm9pZCBzZXRMb2dQYXJhbWV0ZXIoaW50IGluZGV4LCBkb3VibGUg\ndmFsKSB7CiAgICAgICAgICAgICAgICBpZiAoc2hvdWxkVHJhY2tQYXJhbWV0\nZXJzKCkpCiAgICAgICAgICAgICAgICAgICAgc2V0TG9nUGFyYW1ldGVyKGlu\nZGV4LCAiKGRvdWJsZSkgIiArIHZhbCk7CiAgICAgICAgICAgIH0KCiAgICAg\nICAgICAgIHByaXZhdGUgdm9pZCBzZXRMb2dQYXJhbWV0ZXIoaW50IGluZGV4\nLCBmbG9hdCB2YWwpIHsKICAgICAgICAgICAgICAgIGlmIChzaG91bGRUcmFj\na1BhcmFtZXRlcnMoKSkKICAgICAgICAgICAgICAgICAgICBzZXRMb2dQYXJh\nbWV0ZXIoaW5kZXgsICIoZmxvYXQpICIgKyB2YWwpOwogICAgICAgICAgICB9\nCgogICAgICAgICAgICBwcml2YXRlIHZvaWQgc2V0TG9nUGFyYW1ldGVyKGlu\ndCBpbmRleCwgaW50IHZhbCkgewogICAgICAgICAgICAgICAgaWYgKHNob3Vs\nZFRyYWNrUGFyYW1ldGVycygpKQogICAgICAgICAgICAgICAgICAgIHNldExv\nZ1BhcmFtZXRlcihpbmRleCwgIihpbnQpICIgKyB2YWwpOwogICAgICAgICAg\nICB9CgogICAgICAgICAgICBwcml2YXRlIHZvaWQgc2V0TG9nUGFyYW1ldGVy\nKGludCBpbmRleCwgbG9uZyB2YWwpIHsKICAgICAgICAgICAgICAgIGlmIChz\naG91bGRUcmFja1BhcmFtZXRlcnMoKSkKICAgICAgICAgICAgICAgICAgICBz\nZXRMb2dQYXJhbWV0ZXIoaW5kZXgsICIobG9uZykgIiArIHZhbCk7CiAgICAg\nICAgICAgIH0KCiAgICAgICAgICAgIHByaXZhdGUgdm9pZCBzZXRMb2dQYXJh\nbWV0ZXIoaW50IGluZGV4LCBzaG9ydCB2YWwpIHsKICAgICAgICAgICAgICAg\nIGlmIChzaG91bGRUcmFja1BhcmFtZXRlcnMoKSkKICAgICAgICAgICAgICAg\nICAgICBzZXRMb2dQYXJhbWV0ZXIoaW5kZXgsICIoc2hvcnQpICIgKyB2YWwp\nOwogICAgICAgICAgICB9CgogICAgICAgICAgICBwcml2YXRlIHZvaWQgc2V0\nTG9nUGFyYW1ldGVyKGludCBpbmRleCwgU3RyaW5nIHR5cGUsIE9iamVjdCB2\nYWwpIHsKICAgICAgICAgICAgICAgIGlmIChzaG91bGRUcmFja1BhcmFtZXRl\ncnMoKSkKICAgICAgICAgICAgICAgICAgICBzZXRMb2dQYXJhbWV0ZXIoaW5k\nZXgsICIoIiArIHR5cGUgKyAiKSAiICsgdmFsKTsKICAgICAgICAgICAgfQoK\nICAgICAgICAgICAgcHJpdmF0ZSB2b2lkIHNldExvZ1BhcmFtZXRlcihpbnQg\naW5kZXgsIFN0cmluZyB2YWwpIHsKICAgICAgICAgICAgICAgIGlmIChfcGFy\nYW1zID09IG51bGwpCiAgICAgICAgICAgICAgICAgICAgX3BhcmFtcyA9IG5l\ndyBBcnJheUxpc3Q8U3RyaW5nPigpOwogICAgICAgICAgICAgICAgd2hpbGUg\nKF9wYXJhbXMuc2l6ZSgpIDwgaW5kZXgpCiAgICAgICAgICAgICAgICAgICAg\nX3BhcmFtcy5hZGQobnVsbCk7CiAgICAgICAgICAgICAgICBpZiAodmFsLmxl\nbmd0aCgpID4gODApCiAgICAgICAgICAgICAgICAgICAgdmFsID0gdmFsLnN1\nYnN0cmluZygwLCA3NykgKyAiLi4uIjsKICAgICAgICAgICAgICAgIF9wYXJh\nbXMuc2V0KGluZGV4IC0gMSwgdmFsKTsKICAgICAgICAgICAgfQogICAgICAg\nIH0KICAgIH0gICAKfQo=\n","encoding":"base64"}

