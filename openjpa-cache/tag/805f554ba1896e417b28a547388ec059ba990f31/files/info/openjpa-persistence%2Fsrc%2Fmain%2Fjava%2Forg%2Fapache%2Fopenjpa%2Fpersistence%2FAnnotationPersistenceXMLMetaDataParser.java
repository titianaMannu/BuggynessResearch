{"sha":"02bad512f754754448c639575481f97c10589895","node_id":"MDQ6QmxvYjIwNjM2NDowMmJhZDUxMmY3NTQ3NTQ0NDhjNjM5NTc1NDgxZjk3YzEwNTg5ODk1","size":11405,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/02bad512f754754448c639575481f97c10589895","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2U7CgppbXBv\ncnQgamF2YS5sYW5nLnJlZmxlY3QuQW5ub3RhdGVkRWxlbWVudDsKaW1wb3J0\nIGphdmEubGFuZy5yZWZsZWN0LkZpZWxkOwppbXBvcnQgamF2YS5sYW5nLnJl\nZmxlY3QuTWVtYmVyOwppbXBvcnQgamF2YS5sYW5nLnJlZmxlY3QuTWV0aG9k\nOwppbXBvcnQgamF2YS5zZWN1cml0eS5BY2Nlc3NDb250cm9sbGVyOwoKaW1w\nb3J0IG9yZy5hcGFjaGUuY29tbW9ucy5sYW5nLlN0cmluZ1V0aWxzOwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLmNvbmYuT3BlbkpQQUNvbmZpZ3VyYXRp\nb247CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLmxvZy5Mb2c7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuSjJEb1ByaXZIZWxw\nZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuTG9jYWxp\nemVyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuRGVsZWdhdGlu\nZ01ldGFEYXRhRmFjdG9yeTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5t\nZXRhLkZpZWxkTWV0YURhdGE7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\nbWV0YS5NZXRhRGF0YUZhY3Rvcnk7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEubWV0YS5NZXRhRGF0YVJlcG9zaXRvcnk7CmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEubWV0YS5YTUxGaWVsZE1ldGFEYXRhOwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLm1ldGEuWE1MTWV0YURhdGE7CgovKioKICogSkFYQiB4\nbWwgYW5ub3RhdGlvbiBtZXRhZGF0YSBwYXJzZXIuCiAqCiAqIEBhdXRob3Ig\nQ2F0YWxpbmEgV2VpCiAqIEBzaW5jZSAxLjAuMAogKiBAbm9qYXZhZG9jCiAq\nLwpwdWJsaWMgY2xhc3MgQW5ub3RhdGlvblBlcnNpc3RlbmNlWE1MTWV0YURh\ndGFQYXJzZXIgewoKICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIExvY2FsaXpl\nciBfbG9jID0gTG9jYWxpemVyLmZvclBhY2thZ2UKICAgICAgICAoQW5ub3Rh\ndGlvblBlcnNpc3RlbmNlWE1MTWV0YURhdGFQYXJzZXIuY2xhc3MpOwoKICAg\nIHByaXZhdGUgZmluYWwgT3BlbkpQQUNvbmZpZ3VyYXRpb24gX2NvbmY7CiAg\nICBwcml2YXRlIGZpbmFsIExvZyBfbG9nOwogICAgcHJpdmF0ZSBNZXRhRGF0\nYVJlcG9zaXRvcnkgX3JlcG9zID0gbnVsbDsKICAgIAogICAgLy8gY2FjaGUg\ndGhlIEpBWEIgWG1sLi4uIGNsYXNzZXMgaWYgdGhleSBhcmUgcHJlc2VudCBz\nbyB3ZSBkbyBub3QKICAgIC8vIGhhdmUgYSBoYXJkLXdpcmVkIGRlcGVuZGVu\nY3kgb24gSkFYQiBoZXJlCiAgICBwcml2YXRlIENsYXNzIHhtbFR5cGVDbGFz\ncyA9IG51bGw7CiAgICBwcml2YXRlIENsYXNzIHhtbFJvb3RFbGVtZW50Q2xh\nc3MgPSBudWxsOwogICAgcHJpdmF0ZSBDbGFzcyB4bWxBY2Nlc3NvclR5cGVD\nbGFzcyA9IG51bGw7CiAgICBwcml2YXRlIENsYXNzIHhtbEF0dHJpYnV0ZUNs\nYXNzID0gbnVsbDsKICAgIHByaXZhdGUgQ2xhc3MgeG1sRWxlbWVudENsYXNz\nID0gbnVsbDsKICAgIHByaXZhdGUgTWV0aG9kIHhtbFR5cGVOYW1lID0gbnVs\nbDsKICAgIHByaXZhdGUgTWV0aG9kIHhtbFR5cGVOYW1lc3BhY2UgPSBudWxs\nOwogICAgcHJpdmF0ZSBNZXRob2QgeG1sUm9vdE5hbWUgPSBudWxsOwogICAg\ncHJpdmF0ZSBNZXRob2QgeG1sUm9vdE5hbWVzcGFjZSA9IG51bGw7CiAgICBw\ncml2YXRlIE1ldGhvZCB4bWxBdHRyaWJ1dGVOYW1lID0gbnVsbDsKICAgIHBy\naXZhdGUgTWV0aG9kIHhtbEF0dHJpYnV0ZU5hbWVzcGFjZSA9IG51bGw7CiAg\nICBwcml2YXRlIE1ldGhvZCB4bWxFbGVtZW50TmFtZSA9IG51bGw7CiAgICBw\ncml2YXRlIE1ldGhvZCB4bWxFbGVtZW50TmFtZXNwYWNlID0gbnVsbDsKICAg\nIHByaXZhdGUgTWV0aG9kIHhtbEFjY2Vzc29yVmFsdWUgPSBudWxsOwoKICAg\nIC8qKgogICAgICogQ29uc3RydWN0b3I7IHN1cHBseSBjb25maWd1cmF0aW9u\nLgogICAgICovCiAgICBwdWJsaWMgQW5ub3RhdGlvblBlcnNpc3RlbmNlWE1M\nTWV0YURhdGFQYXJzZXIoT3BlbkpQQUNvbmZpZ3VyYXRpb24gY29uZikgewog\nICAgICAgIF9jb25mID0gY29uZjsKICAgICAgICBfbG9nID0gY29uZi5nZXRM\nb2coT3BlbkpQQUNvbmZpZ3VyYXRpb24uTE9HX01FVEFEQVRBKTsKICAgICAg\nICB0cnkgewogICAgICAgICAgICB4bWxUeXBlQ2xhc3MgPSBDbGFzcy5mb3JO\nYW1lKAogICAgICAgICAgICAgICAgImphdmF4LnhtbC5iaW5kLmFubm90YXRp\nb24uWG1sVHlwZSIpOwogICAgICAgICAgICB4bWxUeXBlTmFtZSA9IHhtbFR5\ncGVDbGFzcy5nZXRNZXRob2QoIm5hbWUiLCBudWxsKTsKICAgICAgICAgICAg\neG1sVHlwZU5hbWVzcGFjZSA9IHhtbFR5cGVDbGFzcy5nZXRNZXRob2QoIm5h\nbWVzcGFjZSIsIG51bGwpOwogICAgICAgICAgICB4bWxSb290RWxlbWVudENs\nYXNzID0gQ2xhc3MuZm9yTmFtZSgKICAgICAgICAgICAgICAgICJqYXZheC54\nbWwuYmluZC5hbm5vdGF0aW9uLlhtbFJvb3RFbGVtZW50Iik7CiAgICAgICAg\nICAgIHhtbFJvb3ROYW1lID0geG1sUm9vdEVsZW1lbnRDbGFzcy5nZXRNZXRo\nb2QoIm5hbWUiLCBudWxsKTsKICAgICAgICAgICAgeG1sUm9vdE5hbWVzcGFj\nZSA9IHhtbFJvb3RFbGVtZW50Q2xhc3MuZ2V0TWV0aG9kKCJuYW1lc3BhY2Ui\nLCBudWxsKTsKICAgICAgICAgICAgeG1sQWNjZXNzb3JUeXBlQ2xhc3MgPSBD\nbGFzcy5mb3JOYW1lKAogICAgICAgICAgICAgICAgImphdmF4LnhtbC5iaW5k\nLmFubm90YXRpb24uWG1sQWNjZXNzb3JUeXBlIik7CiAgICAgICAgICAgIHht\nbEFjY2Vzc29yVmFsdWUgPSB4bWxBY2Nlc3NvclR5cGVDbGFzcy5nZXRNZXRo\nb2QoInZhbHVlIiwgbnVsbCk7CiAgICAgICAgICAgIHhtbEF0dHJpYnV0ZUNs\nYXNzID0gQ2xhc3MuZm9yTmFtZSgKICAgICAgICAgICAgICAgICJqYXZheC54\nbWwuYmluZC5hbm5vdGF0aW9uLlhtbEF0dHJpYnV0ZSIpOwogICAgICAgICAg\nICB4bWxBdHRyaWJ1dGVOYW1lID0geG1sQXR0cmlidXRlQ2xhc3MuZ2V0TWV0\naG9kKCJuYW1lIiwgbnVsbCk7CiAgICAgICAgICAgIHhtbEF0dHJpYnV0ZU5h\nbWVzcGFjZSA9IHhtbEF0dHJpYnV0ZUNsYXNzLmdldE1ldGhvZCgibmFtZXNw\nYWNlIgogICAgICAgICAgICAgICAgLCBudWxsKTsKICAgICAgICAgICAgeG1s\nRWxlbWVudENsYXNzID0gQ2xhc3MuZm9yTmFtZSgKICAgICAgICAgICAgICAg\nICJqYXZheC54bWwuYmluZC5hbm5vdGF0aW9uLlhtbEVsZW1lbnQiKTsKICAg\nICAgICAgICAgeG1sRWxlbWVudE5hbWUgPSB4bWxFbGVtZW50Q2xhc3MuZ2V0\nTWV0aG9kKCJuYW1lIiwgbnVsbCk7CiAgICAgICAgICAgIHhtbEVsZW1lbnRO\nYW1lc3BhY2UgPSB4bWxFbGVtZW50Q2xhc3MuZ2V0TWV0aG9kKCJuYW1lc3Bh\nY2UiLCBudWxsKTsKICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkgewog\nICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIENvbmZpZ3VyYXRpb24g\nc3VwcGxpZWQgb24gY29uc3RydWN0aW9uLgogICAgICovCiAgICBwdWJsaWMg\nT3BlbkpQQUNvbmZpZ3VyYXRpb24gZ2V0Q29uZmlndXJhdGlvbigpIHsKICAg\nICAgICByZXR1cm4gX2NvbmY7CiAgICB9CgogICAgLyoqCiAgICAgKiBNZXRh\nZGF0YSBsb2cuCiAgICAgKi8KICAgIHB1YmxpYyBMb2cgZ2V0TG9nKCkgewog\nICAgICAgIHJldHVybiBfbG9nOwogICAgfQoKICAgIC8qKgogICAgICogUmV0\ndXJucyB0aGUgcmVwb3NpdG9yeSBmb3IgdGhpcyBwYXJzZXIuIElmIG5vbmUg\naGFzIGJlZW4gc2V0LAogICAgICogY3JlYXRlIGEgbmV3IHJlcG9zaXRvcnkg\nYW5kIHNldHMgaXQuCiAgICAgKi8KICAgIHB1YmxpYyBNZXRhRGF0YVJlcG9z\naXRvcnkgZ2V0UmVwb3NpdG9yeSgpIHsKICAgICAgICBpZiAoX3JlcG9zID09\nIG51bGwpIHsKICAgICAgICAgICAgTWV0YURhdGFSZXBvc2l0b3J5IHJlcG9z\nID0gX2NvbmYubmV3TWV0YURhdGFSZXBvc2l0b3J5SW5zdGFuY2UoKTsKICAg\nICAgICAgICAgTWV0YURhdGFGYWN0b3J5IG1kZiA9IHJlcG9zLmdldE1ldGFE\nYXRhRmFjdG9yeSgpOwogICAgICAgICAgICBpZiAobWRmIGluc3RhbmNlb2Yg\nRGVsZWdhdGluZ01ldGFEYXRhRmFjdG9yeSkKICAgICAgICAgICAgICAgIG1k\nZiA9ICgoRGVsZWdhdGluZ01ldGFEYXRhRmFjdG9yeSkgbWRmKS5nZXRJbm5l\ncm1vc3REZWxlZ2F0ZSgpOwogICAgICAgICAgICBpZiAobWRmIGluc3RhbmNl\nb2YgUGVyc2lzdGVuY2VNZXRhRGF0YUZhY3RvcnkpCiAgICAgICAgICAgICAg\nICAoKFBlcnNpc3RlbmNlTWV0YURhdGFGYWN0b3J5KSBtZGYpLnNldFhNTEFu\nbm90YXRpb25QYXJzZXIodGhpcyk7CiAgICAgICAgICAgIF9yZXBvcyA9IHJl\ncG9zOwogICAgICAgIH0KICAgICAgICByZXR1cm4gX3JlcG9zOwogICAgfQoK\nICAgIC8qKgogICAgICogU2V0IHRoZSBtZXRhZGF0YSByZXBvc2l0b3J5IGZv\nciB0aGlzIHBhcnNlci4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0UmVw\nb3NpdG9yeShNZXRhRGF0YVJlcG9zaXRvcnkgcmVwb3MpIHsKICAgICAgICBf\ncmVwb3MgPSByZXBvczsKICAgIH0KCiAgICAvKioKICAgICAqIENsZWFyIGNh\nY2hlcy4KICAgICAqLwogICAgcHVibGljIHZvaWQgY2xlYXIoKSB7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBQYXJzZSBwZXJzaXN0ZW5jZSBtZXRhZGF0YSBm\nb3IgdGhlIGdpdmVuIGZpZWxkIG1ldGFkYXRhLiBJZiB0aGUgTWV0YURhdGEo\nL01hcHBpbmcpUmVwb3NpdG9yeQogICAgICogaXMgdXNpbmcgbG9ja2luZywg\ndGhhdCBsb2NrIE1VU1QgYmUgaGVsZCBwcmlvciB0byBjYWxsaW5nIHRoaXMg\nbWV0aG9kLgogICAgICovCiAgICBwdWJsaWMgc3luY2hyb25pemVkIHZvaWQg\ncGFyc2UoRmllbGRNZXRhRGF0YSBmbWQpIHsKICAgICAgICBDbGFzczw/PiBj\nbHMgPSBmbWQuZ2V0RGVjbGFyZWRUeXBlKCk7CiAgICAgICAgaWYgKF9sb2cu\naXNUcmFjZUVuYWJsZWQoKSkKICAgICAgICAgICAgX2xvZy50cmFjZShfbG9j\nLmdldCgicGFyc2UtY2xhc3MiLCBjbHMuZ2V0TmFtZSgpKSk7CiAgICAgICAg\ncGFyc2VYTUxDbGFzc0Fubm90YXRpb25zKGNscywgZm1kKTsKICAgIH0KCiAg\nICAvKioKICAgICAqIFJlYWQgYW5ub3RhdGlvbnMgZm9yIHRoZSBjdXJyZW50\nIHR5cGUuCiAgICAgKi8KICAgIHByaXZhdGUgWE1MTWV0YURhdGEgcGFyc2VY\nTUxDbGFzc0Fubm90YXRpb25zKENsYXNzPD8+IGNscywgRmllbGRNZXRhRGF0\nYSBmbWQpIHsKICAgICAgICAvLyBjaGVjayBpbW1lZGlhdGVseSB3aGV0aGVy\nIHRoZSBjbGFzcyBoYXMgSkFYQiBYTUwgYW5ub3RhdGlvbnMKICAgICAgICBp\nZiAoY2xzID09IG51bGwgfHwgeG1sVHlwZUNsYXNzID09IG51bGwKICAgICAg\nICAgICAgfHwgISgoQWNjZXNzQ29udHJvbGxlci5kb1ByaXZpbGVnZWQoSjJE\nb1ByaXZIZWxwZXIKICAgICAgICAgICAgICAgIC5pc0Fubm90YXRpb25QcmVz\nZW50QWN0aW9uKGNscywgeG1sVHlwZUNsYXNzKSkpLmJvb2xlYW5WYWx1ZSgp\nCiAgICAgICAgICAgICAgICAmJiAoQWNjZXNzQ29udHJvbGxlcgogICAgICAg\nICAgICAgICAgLmRvUHJpdmlsZWdlZChKMkRvUHJpdkhlbHBlci5pc0Fubm90\nYXRpb25QcmVzZW50QWN0aW9uKGNscywKICAgICAgICAgICAgICAgICAgICB4\nbWxSb290RWxlbWVudENsYXNzKSkpLmJvb2xlYW5WYWx1ZSgpKSkKICAgICAg\nICAgICAgcmV0dXJuIG51bGw7CgogICAgICAgIC8vIGZpbmQgLyBjcmVhdGUg\nbWV0YWRhdGEKICAgICAgICBYTUxNZXRhRGF0YSBtZXRhID0gZ2V0WE1MTWV0\nYURhdGEoY2xzLCBmbWQpOwogICAgICAgIAogICAgICAgIHJldHVybiBtZXRh\nOwogICAgfQoKICAgIC8qKgogICAgICogRmluZCBvciBjcmVhdGUgeG1sIG1l\ndGFkYXRhIGZvciB0aGUgY3VycmVudCB0eXBlLiAKICAgICAqLwogICAgcHJp\ndmF0ZSBYTUxNZXRhRGF0YSBnZXRYTUxNZXRhRGF0YShDbGFzczw/PiBjbHMs\nIEZpZWxkTWV0YURhdGEgZm1kKSB7CiAgICAgICAgWE1MTWV0YURhdGEgbWV0\nYSA9IGdldFJlcG9zaXRvcnkoKS5nZXRDYWNoZWRYTUxNZXRhRGF0YShjbHMp\nOwogICAgICAgIGlmIChtZXRhID09IG51bGwpIHsKICAgICAgICAgICAgLy8g\naWYgbm90IGluIGNhY2hlLCBjcmVhdGUgbWV0YWRhdGEKICAgICAgICAgICAg\nbWV0YSA9IGdldFJlcG9zaXRvcnkoKS5hZGRYTUxNZXRhRGF0YShjbHMsIGZt\nZC5nZXROYW1lKCkpOwogICAgICAgICAgICBwYXJzZVhtbFJvb3RFbGVtZW50\nKGNscywgbWV0YSk7CiAgICAgICAgICAgIHBvcHVsYXRlRnJvbVJlZmxlY3Rp\nb24oY2xzLCBtZXRhKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIG1ldGE7\nCiAgICB9CiAgICAKICAgIHByaXZhdGUgdm9pZCBwYXJzZVhtbFJvb3RFbGVt\nZW50KENsYXNzIHR5cGUsIFhNTE1ldGFEYXRhIG1ldGEpIHsKICAgICAgICB0\ncnkgewogICAgICAgICAgICBpZiAodHlwZS5nZXRBbm5vdGF0aW9uKHhtbFJv\nb3RFbGVtZW50Q2xhc3MpICE9IG51bGwpIHsKICAgICAgICAgICAgICAgIG1l\ndGEuc2V0WG1sUm9vdEVsZW1lbnQodHJ1ZSk7CiAgICAgICAgICAgICAgICBt\nZXRhLnNldFhtbG5hbWUoKFN0cmluZykgeG1sUm9vdE5hbWUuaW52b2tlKHR5\ncGUuZ2V0QW5ub3RhdGlvbgogICAgICAgICAgICAgICAgICAgICh4bWxSb290\nRWxlbWVudENsYXNzKSwgbmV3IE9iamVjdFtde30pKTsKICAgICAgICAgICAg\nICAgIG1ldGEuc2V0WG1sbmFtZXNwYWNlKChTdHJpbmcpIHhtbFJvb3ROYW1l\nc3BhY2UuaW52b2tlKHR5cGUKICAgICAgICAgICAgICAgICAgICAuZ2V0QW5u\nb3RhdGlvbih4bWxSb290RWxlbWVudENsYXNzKSwgbmV3IE9iamVjdFtde30p\nKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlIHsKICAgICAgICAg\nICAgICAgIG1ldGEuc2V0WG1sbmFtZSgoU3RyaW5nKSB4bWxUeXBlTmFtZS5p\nbnZva2UodHlwZS5nZXRBbm5vdGF0aW9uCiAgICAgICAgICAgICAgICAgICAg\nKHhtbFR5cGVDbGFzcyksIG5ldyBPYmplY3RbXXt9KSk7CiAgICAgICAgICAg\nICAgICBtZXRhLnNldFhtbG5hbWVzcGFjZSgoU3RyaW5nKSB4bWxUeXBlTmFt\nZXNwYWNlLmludm9rZSh0eXBlCiAgICAgICAgICAgICAgICAgICAgLmdldEFu\nbm90YXRpb24oeG1sVHlwZUNsYXNzKSwgbmV3IE9iamVjdFtde30pKTsgICAg\nICAgICAgIAogICAgICAgICAgICB9CiAgICAgICAgfSBjYXRjaCAoRXhjZXB0\naW9uIGUpIHsgICAgICAgICAgICAKICAgICAgICB9CiAgICB9CgogICAgcHJp\ndmF0ZSB2b2lkIHBvcHVsYXRlRnJvbVJlZmxlY3Rpb24oQ2xhc3MgY2xzLCBY\nTUxNZXRhRGF0YSBtZXRhKSB7CiAgICAgICAgTWVtYmVyW10gbWVtYmVyczsK\nICAgICAgICAKICAgICAgICBDbGFzcyBzdXBlcmNsYXNzID0gY2xzLmdldFN1\ncGVyY2xhc3MoKTsKCiAgICAgICAgLy8gaGFuZGxlIGluaGVyaXRhbmNlIGF0\nIHN1Yi1lbGVtZW50IGxldmVsCiAgICAgICAgaWYgKChBY2Nlc3NDb250cm9s\nbGVyLmRvUHJpdmlsZWdlZChKMkRvUHJpdkhlbHBlcgogICAgICAgICAgICAu\naXNBbm5vdGF0aW9uUHJlc2VudEFjdGlvbihzdXBlcmNsYXNzLCB4bWxUeXBl\nQ2xhc3MpKSkKICAgICAgICAgICAgLmJvb2xlYW5WYWx1ZSgpKQogICAgICAg\nICAgICBwb3B1bGF0ZUZyb21SZWZsZWN0aW9uKHN1cGVyY2xhc3MsIG1ldGEp\nOwoKICAgICAgICB0cnkgewogICAgICAgICAgICBpZiAoU3RyaW5nVXRpbHMu\nZXF1YWxzKHhtbEFjY2Vzc29yVmFsdWUuaW52b2tlKGNscy5nZXRBbm5vdGF0\naW9uKAogICAgICAgICAgICAgICAgeG1sQWNjZXNzb3JUeXBlQ2xhc3MpLCBu\nZXcgT2JqZWN0W117fSkudG9TdHJpbmcoKSwgIkZJRUxEIikpCiAgICAgICAg\nICAgICAgICBtZW1iZXJzID0gY2xzLmdldERlY2xhcmVkRmllbGRzKCk7CiAg\nICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIG1lbWJlcnMgPSBjbHMu\nZ2V0RGVjbGFyZWRNZXRob2RzKCk7CgogICAgICAgICAgICBmb3IgKGludCBp\nID0gMDsgaSA8IG1lbWJlcnMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAg\nICAgIE1lbWJlciBtZW1iZXIgPSBtZW1iZXJzW2ldOwogICAgICAgICAgICAg\nICAgQW5ub3RhdGVkRWxlbWVudCBlbCA9IChBbm5vdGF0ZWRFbGVtZW50KSBt\nZW1iZXI7CiAgICAgICAgICAgICAgICBYTUxNZXRhRGF0YSBmaWVsZCA9IG51\nbGw7CiAgICAgICAgICAgICAgICBpZiAoZWwuZ2V0QW5ub3RhdGlvbih4bWxF\nbGVtZW50Q2xhc3MpICE9IG51bGwpIHsKICAgICAgICAgICAgICAgICAgICBT\ndHJpbmcgeG1sbmFtZSA9IChTdHJpbmcpIHhtbEVsZW1lbnROYW1lLmludm9r\nZShlbAogICAgICAgICAgICAgICAgICAgICAgICAuZ2V0QW5ub3RhdGlvbih4\nbWxFbGVtZW50Q2xhc3MpLCBuZXcgT2JqZWN0W117fSk7CiAgICAgICAgICAg\nICAgICAgICAgLy8gYXZvaWQgSkFYQiBYTUwgYmluZCBkZWZhdWx0IG5hbWUK\nICAgICAgICAgICAgICAgICAgICBpZiAoU3RyaW5nVXRpbHMuZXF1YWxzKFhN\nTE1ldGFEYXRhLmRlZmF1bHROYW1lLCB4bWxuYW1lKSkKICAgICAgICAgICAg\nICAgICAgICAgICAgeG1sbmFtZSA9IG1lbWJlci5nZXROYW1lKCk7CiAgICAg\nICAgICAgICAgICAgICAgaWYgKChBY2Nlc3NDb250cm9sbGVyLmRvUHJpdmls\nZWdlZChKMkRvUHJpdkhlbHBlcgogICAgICAgICAgICAgICAgICAgICAgICAu\naXNBbm5vdGF0aW9uUHJlc2VudEFjdGlvbigoKEZpZWxkKSBtZW1iZXIpLmdl\ndFR5cGUoKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHhtbFR5cGVD\nbGFzcykpKS5ib29sZWFuVmFsdWUoKSkgewogICAgICAgICAgICAgICAgICAg\nICAgICBmaWVsZCA9IF9yZXBvcy5hZGRYTUxNZXRhRGF0YSgoKEZpZWxkKSBt\nZW1iZXIpLmdldFR5cGUoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAg\nLCBtZW1iZXIuZ2V0TmFtZSgpKTsKICAgICAgICAgICAgICAgICAgICAgICAg\ncGFyc2VYbWxSb290RWxlbWVudCgoKEZpZWxkKSBtZW1iZXIpLmdldFR5cGUo\nKSwgZmllbGQpOwogICAgICAgICAgICAgICAgICAgICAgICBwb3B1bGF0ZUZy\nb21SZWZsZWN0aW9uKCgoRmllbGQpIG1lbWJlcikuZ2V0VHlwZSgpCiAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAsIGZpZWxkKTsKICAgICAgICAgICAg\nICAgICAgICAgICAgZmllbGQuc2V0WG1sdHlwZShYTUxNZXRhRGF0YS5YTUxU\nWVBFKTsKICAgICAgICAgICAgICAgICAgICAgICAgZmllbGQuc2V0WG1sbmFt\nZSh4bWxuYW1lKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAg\nICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGZpZWxk\nID0gX3JlcG9zLm5ld1hNTEZpZWxkTWV0YURhdGEoKChGaWVsZCkgbWVtYmVy\nKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLmdldFR5cGUoKSwgbWVt\nYmVyLmdldE5hbWUoKSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGZpZWxk\nLnNldFhtbHR5cGUoWE1MTWV0YURhdGEuRUxFTUVOVCk7CiAgICAgICAgICAg\nICAgICAgICAgICAgIGZpZWxkLnNldFhtbG5hbWUoeG1sbmFtZSk7CiAgICAg\nICAgICAgICAgICAgICAgICAgIGZpZWxkLnNldFhtbG5hbWVzcGFjZSgoU3Ry\naW5nKSB4bWxFbGVtZW50TmFtZXNwYWNlCiAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAuaW52b2tlKGVsLmdldEFubm90YXRpb24oeG1sRWxlbWVudENs\nYXNzKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLCBuZXcgT2JqZWN0\nW117fSkpOyAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAg\nICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZSBp\nZiAoZWwuZ2V0QW5ub3RhdGlvbih4bWxBdHRyaWJ1dGVDbGFzcykgIT0gbnVs\nbCkgewogICAgICAgICAgICAgICAgICAgIGZpZWxkID0gX3JlcG9zLm5ld1hN\nTEZpZWxkTWV0YURhdGEoKChGaWVsZCkgbWVtYmVyKQogICAgICAgICAgICAg\nICAgICAgICAgICAuZ2V0VHlwZSgpLCBtZW1iZXIuZ2V0TmFtZSgpKTsKICAg\nICAgICAgICAgICAgICAgICBmaWVsZC5zZXRYbWx0eXBlKFhNTEZpZWxkTWV0\nYURhdGEuQVRUUklCVVRFKTsKICAgICAgICAgICAgICAgICAgICBTdHJpbmcg\neG1sbmFtZSA9IChTdHJpbmcpIHhtbEF0dHJpYnV0ZU5hbWUuaW52b2tlKAog\nICAgICAgICAgICAgICAgICAgICAgICBlbC5nZXRBbm5vdGF0aW9uKHhtbEF0\ndHJpYnV0ZUNsYXNzKSwgbmV3IE9iamVjdFtde30pOwogICAgICAgICAgICAg\nICAgICAgIC8vIGF2b2lkIEpBWEIgWE1MIGJpbmQgZGVmYXVsdCBuYW1lCiAg\nICAgICAgICAgICAgICAgICAgaWYgKFN0cmluZ1V0aWxzLmVxdWFscyhYTUxN\nZXRhRGF0YS5kZWZhdWx0TmFtZSwgeG1sbmFtZSkpCiAgICAgICAgICAgICAg\nICAgICAgICAgIHhtbG5hbWUgPSBtZW1iZXIuZ2V0TmFtZSgpOwogICAgICAg\nICAgICAgICAgICAgIGZpZWxkLnNldFhtbG5hbWUoIkAiK3htbG5hbWUpOwog\nICAgICAgICAgICAgICAgICAgIGZpZWxkLnNldFhtbG5hbWVzcGFjZSgoU3Ry\naW5nKSB4bWxBdHRyaWJ1dGVOYW1lc3BhY2UuaW52b2tlKAogICAgICAgICAg\nICAgICAgICAgICAgICBlbC5nZXRBbm5vdGF0aW9uKHhtbEF0dHJpYnV0ZUNs\nYXNzKSwgbmV3IE9iamVjdFtde30pKTsKICAgICAgICAgICAgICAgIH0KICAg\nICAgICAgICAgICAgIGlmIChmaWVsZCAhPSBudWxsKQogICAgICAgICAgICAg\nICAgICAgIG1ldGEuYWRkRmllbGQobWVtYmVyLmdldE5hbWUoKSwgZmllbGQp\nOwogICAgICAgICAgICB9CiAgICAgICAgfSBjYXRjaChFeGNlcHRpb24gZSkg\newogICAgICAgIH0KICAgIH0KfQo=\n","encoding":"base64"}

