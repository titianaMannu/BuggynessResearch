{"sha":"4c61022a01bf98aac9df2d16eb38f0483d880c8e","node_id":"MDQ6QmxvYjIwNjM2NDo0YzYxMDIyYTAxYmY5OGFhYzlkZjJkMTZlYjM4ZjA0ODNkODgwYzhl","size":13998,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/4c61022a01bf98aac9df2d16eb38f0483d880c8e","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2U7CgppbXBv\ncnQgamF2YS5sYW5nLnJlZmxlY3QuQ29uc3RydWN0b3I7CmltcG9ydCBqYXZh\nLmxhbmcucmVmbGVjdC5JbnZvY2F0aW9uVGFyZ2V0RXhjZXB0aW9uOwppbXBv\ncnQgamF2YS51dGlsLkNvbGxlY3Rpb25zOwppbXBvcnQgamF2YS51dGlsLkhh\nc2hNYXA7CmltcG9ydCBqYXZhLnV0aWwuTWFwOwppbXBvcnQgamF2YS51dGls\nLlNldDsKCmltcG9ydCBqYXZheC5wZXJzaXN0ZW5jZS5DYWNoZTsKaW1wb3J0\nIGphdmF4LnBlcnNpc3RlbmNlLkVudGl0eU1hbmFnZXJGYWN0b3J5OwppbXBv\ncnQgamF2YXgucGVyc2lzdGVuY2UuUGVyc2lzdGVuY2VVbml0VXRpbDsKaW1w\nb3J0IGphdmF4LnBlcnNpc3RlbmNlLnNwaS5Mb2FkU3RhdGU7CgppbXBvcnQg\nb3JnLmFwYWNoZS5jb21tb25zLmxhbmcuU3RyaW5nVXRpbHM7CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEuY29uZi5PcGVuSlBBQ29uZmlndXJhdGlvbjsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuQXV0b0RldGFjaDsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuQnJva2VyOwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5Ccm9rZXJGYWN0b3J5Owpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5EZWxlZ2F0aW5nQnJv\na2VyRmFjdG9yeTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwu\nRGVsZWdhdGluZ0ZldGNoQ29uZmlndXJhdGlvbjsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5rZXJuZWwuRmV0Y2hDb25maWd1cmF0aW9uOwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLmxpYi5jb25mLkNvbmZpZ3VyYXRpb25zOwpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi5jb25mLlZhbHVlOwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi5sb2cuTG9nOwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLmxpYi51dGlsLkNsb3NlYWJsZTsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5saWIudXRpbC5Mb2NhbGl6ZXI7CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuY3JpdGVyaWEuQ3JpdGVy\naWFCdWlsZGVySW1wbDsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5wZXJz\naXN0ZW5jZS5jcml0ZXJpYS5PcGVuSlBBQ3JpdGVyaWFCdWlsZGVyOwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNlLm1ldGEuTWV0YW1v\nZGVsSW1wbDsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5j\nZS5xdWVyeS5PcGVuSlBBUXVlcnlCdWlsZGVyOwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLnBlcnNpc3RlbmNlLnF1ZXJ5LlF1ZXJ5QnVpbGRlckltcGw7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5Vc2VyRXhjZXB0aW9u\nOwoKLyoqCiAqIEltcGxlbWVudGF0aW9uIG9mIHtAbGluayBFbnRpdHlNYW5h\nZ2VyRmFjdG9yeX0gdGhhdCBhY3RzIGFzIGEKICogZmFjYWRlIHRvIGEge0Bs\naW5rIEJyb2tlckZhY3Rvcnl9LgogKgogKiBAYXV0aG9yIE1hcmMgUHJ1ZCdo\nb21tZWF1eAogKiBAbm9qYXZhZG9jCiAqLwpAU3VwcHJlc3NXYXJuaW5ncygi\nc2VyaWFsIikKcHVibGljIGNsYXNzIEVudGl0eU1hbmFnZXJGYWN0b3J5SW1w\nbAogICAgaW1wbGVtZW50cyBPcGVuSlBBRW50aXR5TWFuYWdlckZhY3Rvcnks\nIE9wZW5KUEFFbnRpdHlNYW5hZ2VyRmFjdG9yeVNQSSwKICAgIENsb3NlYWJs\nZSwgUGVyc2lzdGVuY2VVbml0VXRpbCB7CgogICAgcHJpdmF0ZSBzdGF0aWMg\nZmluYWwgTG9jYWxpemVyIF9sb2MgPSBMb2NhbGl6ZXIuZm9yUGFja2FnZQog\nICAgICAgIChFbnRpdHlNYW5hZ2VyRmFjdG9yeUltcGwuY2xhc3MpOwoKICAg\nIHByaXZhdGUgRGVsZWdhdGluZ0Jyb2tlckZhY3RvcnkgX2ZhY3RvcnkgPSBu\ndWxsOwogICAgcHJpdmF0ZSB0cmFuc2llbnQgQ29uc3RydWN0b3I8RmV0Y2hQ\nbGFuPiBfcGxhbiA9IG51bGw7CiAgICBwcml2YXRlIHRyYW5zaWVudCBTdG9y\nZUNhY2hlIF9jYWNoZSA9IG51bGw7CiAgICBwcml2YXRlIHRyYW5zaWVudCBR\ndWVyeVJlc3VsdENhY2hlIF9xdWVyeUNhY2hlID0gbnVsbDsKICAgIHByaXZh\ndGUgdHJhbnNpZW50IE1ldGFtb2RlbEltcGwgX21ldGFNb2RlbDsKICAgIAog\nICAgLyoqCiAgICAgKiBEZWZhdWx0IGNvbnN0cnVjdG9yIHByb3ZpZGVkIGZv\nciBhdXRvLWluc3RhbnRpYXRpb24uCiAgICAgKi8KICAgIHB1YmxpYyBFbnRp\ndHlNYW5hZ2VyRmFjdG9yeUltcGwoKSB7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBTdXBwbHkgZGVsZWdhdGUgb24gY29uc3RydWN0aW9uLgogICAgICovCiAg\nICBwdWJsaWMgRW50aXR5TWFuYWdlckZhY3RvcnlJbXBsKEJyb2tlckZhY3Rv\ncnkgZmFjdG9yeSkgewogICAgICAgIHNldEJyb2tlckZhY3RvcnkoZmFjdG9y\neSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBEZWxlZ2F0ZS4KICAgICAqLwog\nICAgcHVibGljIEJyb2tlckZhY3RvcnkgZ2V0QnJva2VyRmFjdG9yeSgpIHsK\nICAgICAgICByZXR1cm4gX2ZhY3RvcnkuZ2V0RGVsZWdhdGUoKTsKICAgIH0K\nCiAgICAvKioKICAgICAqIERlbGVnYXRlIG11c3QgYmUgcHJvdmlkZWQgYmVm\nb3JlIHVzZS4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0QnJva2VyRmFj\ndG9yeShCcm9rZXJGYWN0b3J5IGZhY3RvcnkpIHsKICAgICAgICBfZmFjdG9y\neSA9IG5ldyBEZWxlZ2F0aW5nQnJva2VyRmFjdG9yeShmYWN0b3J5LAogICAg\nICAgICAgICBQZXJzaXN0ZW5jZUV4Y2VwdGlvbnMuVFJBTlNMQVRPUik7CiAg\nICB9CgogICAgcHVibGljIE9wZW5KUEFDb25maWd1cmF0aW9uIGdldENvbmZp\nZ3VyYXRpb24oKSB7CiAgICAgICAgcmV0dXJuIF9mYWN0b3J5LmdldENvbmZp\nZ3VyYXRpb24oKTsKICAgIH0KICAgIAogICAgcHVibGljIE1hcDxTdHJpbmcs\nT2JqZWN0PiBnZXRQcm9wZXJ0aWVzKCkgewogICAgICAgIE1hcDxTdHJpbmcs\nT2JqZWN0PiBwcm9wcyA9IF9mYWN0b3J5LmdldFByb3BlcnRpZXMoKTsKICAg\nICAgICAvLyBjb252ZXJ0IHRvIHVzZXIgcmVhZGFibGUgdmFsdWVzCiAgICAg\nICAgcHJvcHMucHV0QWxsKGNyZWF0ZUVudGl0eU1hbmFnZXIoKS5nZXRQcm9w\nZXJ0aWVzKCkpOwogICAgICAgIHJldHVybiBwcm9wczsKICAgIH0KCiAgICBw\ndWJsaWMgT2JqZWN0IHB1dFVzZXJPYmplY3QoT2JqZWN0IGtleSwgT2JqZWN0\nIHZhbCkgewogICAgICAgIHJldHVybiBfZmFjdG9yeS5wdXRVc2VyT2JqZWN0\nKGtleSwgdmFsKTsKICAgIH0KCiAgICBwdWJsaWMgT2JqZWN0IGdldFVzZXJP\nYmplY3QoT2JqZWN0IGtleSkgewogICAgICAgIHJldHVybiBfZmFjdG9yeS5n\nZXRVc2VyT2JqZWN0KGtleSk7CiAgICB9CgogICAgcHVibGljIFN0b3JlQ2Fj\naGUgZ2V0U3RvcmVDYWNoZSgpIHsKICAgICAgICBfZmFjdG9yeS5sb2NrKCk7\nCiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgaWYgKF9jYWNoZSA9PSBudWxs\nKSB7CiAgICAgICAgICAgICAgICBPcGVuSlBBQ29uZmlndXJhdGlvbiBjb25m\nID0gX2ZhY3RvcnkuZ2V0Q29uZmlndXJhdGlvbigpOwogICAgICAgICAgICAg\nICAgX2NhY2hlID0gbmV3IFN0b3JlQ2FjaGVJbXBsKHRoaXMsCiAgICAgICAg\nICAgICAgICAgICAgY29uZi5nZXREYXRhQ2FjaGVNYW5hZ2VySW5zdGFuY2Uo\nKS5nZXRTeXN0ZW1EYXRhQ2FjaGUoKSk7CiAgICAgICAgICAgIH0KICAgICAg\nICAgICAgcmV0dXJuIF9jYWNoZTsKICAgICAgICB9IGZpbmFsbHkgewogICAg\nICAgICAgICBfZmFjdG9yeS51bmxvY2soKTsKICAgICAgICB9CiAgICB9Cgog\nICAgcHVibGljIFN0b3JlQ2FjaGUgZ2V0U3RvcmVDYWNoZShTdHJpbmcgY2Fj\naGVOYW1lKSB7CiAgICAgICAgcmV0dXJuIG5ldyBTdG9yZUNhY2hlSW1wbCh0\naGlzLCBfZmFjdG9yeS5nZXRDb25maWd1cmF0aW9uKCkuCiAgICAgICAgICAg\nIGdldERhdGFDYWNoZU1hbmFnZXJJbnN0YW5jZSgpLmdldERhdGFDYWNoZShj\nYWNoZU5hbWUsIHRydWUpKTsKICAgIH0KCiAgICBwdWJsaWMgUXVlcnlSZXN1\nbHRDYWNoZSBnZXRRdWVyeVJlc3VsdENhY2hlKCkgewogICAgICAgIF9mYWN0\nb3J5LmxvY2soKTsKICAgICAgICB0cnkgewogICAgICAgICAgICBpZiAoX3F1\nZXJ5Q2FjaGUgPT0gbnVsbCkKICAgICAgICAgICAgICAgIF9xdWVyeUNhY2hl\nID0gbmV3IFF1ZXJ5UmVzdWx0Q2FjaGVJbXBsKF9mYWN0b3J5LgogICAgICAg\nICAgICAgICAgICAgIGdldENvbmZpZ3VyYXRpb24oKS5nZXREYXRhQ2FjaGVN\nYW5hZ2VySW5zdGFuY2UoKS4KICAgICAgICAgICAgICAgICAgICBnZXRTeXN0\nZW1RdWVyeUNhY2hlKCkpOwogICAgICAgICAgICByZXR1cm4gX3F1ZXJ5Q2Fj\naGU7CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgX2ZhY3Rvcnku\ndW5sb2NrKCk7CiAgICAgICAgfQogICAgfQoKICAgIHB1YmxpYyBPcGVuSlBB\nRW50aXR5TWFuYWdlclNQSSBjcmVhdGVFbnRpdHlNYW5hZ2VyKCkgewogICAg\nICAgIHJldHVybiBjcmVhdGVFbnRpdHlNYW5hZ2VyKG51bGwpOwogICAgfQoK\nICAgIC8qKgogICAgICogQ3JlYXRlcyBhbmQgY29uZmlndXJlcyBhIGVudGl0\neSBtYW5hZ2VyIHdpdGggdGhlIGdpdmVuIHByb3BlcnRpZXMuCiAgICAgKiAg\nCiAgICAgKiBUaGUgcHJvcGVydHkga2V5cyBpbiB0aGUgZ2l2ZW4gbWFwIGNh\nbiBiZSBlaXRoZXIgcXVhbGlmaWVkIG9yIG5vdC4KICAgICAqIAogICAgICog\nQHJldHVybiBsaXN0IG9mIGV4Y2VwdGlvbnMgcmFpc2VkIG9yIGVtcHR5IGxp\nc3QuCiAgICAgKi8KICAgIHB1YmxpYyBPcGVuSlBBRW50aXR5TWFuYWdlclNQ\nSSBjcmVhdGVFbnRpdHlNYW5hZ2VyKE1hcCBwcm9wcykgewogICAgICAgIGlm\nIChwcm9wcyA9PSBudWxsKQogICAgICAgICAgICBwcm9wcyA9IENvbGxlY3Rp\nb25zLkVNUFRZX01BUDsKICAgICAgICBlbHNlIGlmICghcHJvcHMuaXNFbXB0\neSgpKQogICAgICAgICAgICBwcm9wcyA9IG5ldyBIYXNoTWFwKHByb3BzKTsK\nCiAgICAgICAgT3BlbkpQQUNvbmZpZ3VyYXRpb24gY29uZiA9IGdldENvbmZp\nZ3VyYXRpb24oKTsKICAgICAgICBMb2cgbG9nID0gY29uZi5nZXRMb2coT3Bl\nbkpQQUNvbmZpZ3VyYXRpb24uTE9HX1JVTlRJTUUpOwogICAgICAgIFN0cmlu\nZyB1c2VyID0gKFN0cmluZykgQ29uZmlndXJhdGlvbnMucmVtb3ZlUHJvcGVy\ndHkoIkNvbm5lY3Rpb25Vc2VyTmFtZSIsIHByb3BzKTsKICAgICAgICBpZiAo\ndXNlciA9PSBudWxsKQogICAgICAgICAgICB1c2VyID0gY29uZi5nZXRDb25u\nZWN0aW9uVXNlck5hbWUoKTsKICAgICAgICBTdHJpbmcgcGFzcyA9IChTdHJp\nbmcpIENvbmZpZ3VyYXRpb25zLnJlbW92ZVByb3BlcnR5KCJDb25uZWN0aW9u\nUGFzc3dvcmQiLCBwcm9wcyk7CiAgICAgICAgaWYgKHBhc3MgPT0gbnVsbCkK\nICAgICAgICAgICAgcGFzcyA9IGNvbmYuZ2V0Q29ubmVjdGlvblBhc3N3b3Jk\nKCk7CgogICAgICAgIFN0cmluZyBzdHIgPSAoU3RyaW5nKSBDb25maWd1cmF0\naW9ucy5yZW1vdmVQcm9wZXJ0eSgiVHJhbnNhY3Rpb25Nb2RlIiwgcHJvcHMp\nOwogICAgICAgIGJvb2xlYW4gbWFuYWdlZDsKICAgICAgICBpZiAoc3RyID09\nIG51bGwpCiAgICAgICAgICAgIG1hbmFnZWQgPSBjb25mLmlzVHJhbnNhY3Rp\nb25Nb2RlTWFuYWdlZCgpOwogICAgICAgIGVsc2UgewogICAgICAgICAgICBW\nYWx1ZSB2YWwgPSBjb25mLmdldFZhbHVlKCJUcmFuc2FjdGlvbk1vZGUiKTsK\nICAgICAgICAgICAgbWFuYWdlZCA9IEJvb2xlYW4ucGFyc2VCb29sZWFuKHZh\nbC51bmFsaWFzKHN0cikpOwogICAgICAgIH0KCiAgICAgICAgT2JqZWN0IG9i\naiA9IENvbmZpZ3VyYXRpb25zLnJlbW92ZVByb3BlcnR5KCJDb25uZWN0aW9u\nUmV0YWluTW9kZSIsIHByb3BzKTsKICAgICAgICBpbnQgcmV0YWluTW9kZTsK\nICAgICAgICBpZiAob2JqIGluc3RhbmNlb2YgTnVtYmVyKSB7CiAgICAgICAg\nICAgIHJldGFpbk1vZGUgPSAoKE51bWJlcikgb2JqKS5pbnRWYWx1ZSgpOwog\nICAgICAgIH0gZWxzZSBpZiAob2JqID09IG51bGwpIHsKICAgICAgICAgICAg\ncmV0YWluTW9kZSA9IGNvbmYuZ2V0Q29ubmVjdGlvblJldGFpbk1vZGVDb25z\ndGFudCgpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIFZhbHVlIHZh\nbCA9IGNvbmYuZ2V0VmFsdWUoIkNvbm5lY3Rpb25SZXRhaW5Nb2RlIik7CiAg\nICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICByZXRhaW5Nb2RlID0g\nSW50ZWdlci5wYXJzZUludCh2YWwudW5hbGlhcygoU3RyaW5nKSBvYmopKTsK\nICAgICAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICAg\nICAgICAgIHRocm93IG5ldyBBcmd1bWVudEV4Y2VwdGlvbihfbG9jLmdldCgi\nYmFkLWVtLXByb3AiLCAib3BlbmpwYS5Db25uZWN0aW9uUmV0YWluTW9kZSIs\nIG9iaiksCiAgICAgICAgICAgICAgICAgICAgbmV3IFRocm93YWJsZVtdeyBl\nIH0sIG9iaiwgdHJ1ZSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAg\nICAgIC8vIGphdmF4LnBlcnNpc3RlbmNlLmp0YURhdGFTb3VyY2UgYW5kIG9w\nZW5qcGEuQ29ubmVjdGlvbkZhY3RvcnkgbmFtZSBhcmUgZXF1aXZhbGVudC4K\nICAgICAgICAvLyBwcmVmZXIgamF2YXgucGVyc2lzdGVuY2UgZm9yIG5vdy4g\nCiAgICAgICAgU3RyaW5nIGNmTmFtZSA9IChTdHJpbmcpIENvbmZpZ3VyYXRp\nb25zLnJlbW92ZVByb3BlcnR5KCJqdGFEYXRhU291cmNlIiwgcHJvcHMpOyAg\nCiAgICAgICAgaWYoY2ZOYW1lID09IG51bGwpIHsKICAgICAgICAgICAgY2ZO\nYW1lID0gKFN0cmluZykgQ29uZmlndXJhdGlvbnMucmVtb3ZlUHJvcGVydHko\nIkNvbm5lY3Rpb25GYWN0b3J5TmFtZSIsIHByb3BzKTsKICAgICAgICB9CiAg\nICAgICAgCiAgICAgICAgU3RyaW5nIGNmMk5hbWUgPSAoU3RyaW5nKSBDb25m\naWd1cmF0aW9ucy5yZW1vdmVQcm9wZXJ0eSgibm9uSnRhRGF0YVNvdXJjZSIs\nIHByb3BzKTsgCiAgICAgICAgCiAgICAgICAgaWYoY2YyTmFtZSA9PSBudWxs\nKSB7IAogICAgICAgICAgICBjZjJOYW1lID0gKFN0cmluZykgQ29uZmlndXJh\ndGlvbnMucmVtb3ZlUHJvcGVydHkoIkNvbm5lY3Rpb25GYWN0b3J5Mk5hbWUi\nLCBwcm9wcyk7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIGlmIChsb2cg\nIT0gbnVsbCAmJiBsb2cuaXNUcmFjZUVuYWJsZWQoKSkgewogICAgICAgICAg\nICBpZihTdHJpbmdVdGlscy5pc05vdEVtcHR5KGNmTmFtZSkpIHsKICAgICAg\nICAgICAgICAgIGxvZy50cmFjZSgiRm91bmQgQ29ubmVjdGlvbkZhY3RvcnlO\nYW1lIGZyb20gcHJvcHM6ICIgKyBjZk5hbWUpOwogICAgICAgICAgICB9CiAg\nICAgICAgICAgIGlmKFN0cmluZ1V0aWxzLmlzTm90RW1wdHkoY2YyTmFtZSkp\nIHsgCiAgICAgICAgICAgICAgICBsb2cudHJhY2UoIkZvdW5kIENvbm5lY3Rp\nb25GYWN0b3J5Mk5hbWUgZnJvbSBwcm9wczogIiArIGNmMk5hbWUpOwogICAg\nICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHZhbGlkYXRlQ2ZOYW1lUHJv\ncHMoY29uZiwgY2ZOYW1lLCBjZjJOYW1lKTsKCiAgICAgICAgQnJva2VyIGJy\nb2tlciA9IF9mYWN0b3J5Lm5ld0Jyb2tlcih1c2VyLCBwYXNzLCBtYW5hZ2Vk\nLCByZXRhaW5Nb2RlLCBmYWxzZSwgY2ZOYW1lLCBjZjJOYW1lKTsKICAgICAg\nICAgICAgCiAgICAgICAgLy8gYWRkIGF1dG9kZXRhY2ggZm9yIGNsb3NlIGFu\nZCByb2xsYmFjayBjb25kaXRpb25zIHRvIHRoZSBjb25maWd1cmF0aW9uCiAg\nICAgICAgYnJva2VyLnNldEF1dG9EZXRhY2goQXV0b0RldGFjaC5ERVRBQ0hf\nQ0xPU0UsIHRydWUpOwogICAgICAgIGJyb2tlci5zZXRBdXRvRGV0YWNoKEF1\ndG9EZXRhY2guREVUQUNIX1JPTExCQUNLLCB0cnVlKTsKICAgICAgICBicm9r\nZXIuc2V0RGV0YWNoZWROZXcoZmFsc2UpOwogICAgICAgIAogICAgICAgIE9w\nZW5KUEFFbnRpdHlNYW5hZ2VyU1BJIGVtID0gbmV3RW50aXR5TWFuYWdlcklt\ncGwoYnJva2VyKTsKCiAgICAgICAgLy8gYWxsb3cgc2V0dGluZyBvZiBvdGhl\nciBiZWFuIHByb3BlcnRpZXMgb2YgRU0KICAgICAgICBmb3IgKE9iamVjdCBr\nZXkgOiBwcm9wcy5rZXlTZXQoKSkgewogICAgICAgICAgICBlbS5zZXRQcm9w\nZXJ0eShrZXkudG9TdHJpbmcoKSwgcHJvcHMuZ2V0KGtleSkpOwogICAgICAg\nIH0KICAgICAgICByZXR1cm4gZW07CiAgICB9CiAgICAKICAgIC8qKgogICAg\nICogQ3JlYXRlIGEgbmV3IGVudGl0eSBtYW5hZ2VyIGFyb3VuZCB0aGUgZ2l2\nZW4gYnJva2VyLgogICAgICovCiAgICBwcm90ZWN0ZWQgRW50aXR5TWFuYWdl\nckltcGwgbmV3RW50aXR5TWFuYWdlckltcGwoQnJva2VyIGJyb2tlcikgewog\nICAgICAgIHJldHVybiBuZXcgRW50aXR5TWFuYWdlckltcGwodGhpcywgYnJv\na2VyKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBhZGRMaWZlY3ljbGVMaXN0\nZW5lcihPYmplY3QgbGlzdGVuZXIsIENsYXNzLi4uIGNsYXNzZXMpIHsKICAg\nICAgICBfZmFjdG9yeS5hZGRMaWZlY3ljbGVMaXN0ZW5lcihsaXN0ZW5lciwg\nY2xhc3Nlcyk7CiAgICB9CgogICAgcHVibGljIHZvaWQgcmVtb3ZlTGlmZWN5\nY2xlTGlzdGVuZXIoT2JqZWN0IGxpc3RlbmVyKSB7CiAgICAgICAgX2ZhY3Rv\ncnkucmVtb3ZlTGlmZWN5Y2xlTGlzdGVuZXIobGlzdGVuZXIpOwogICAgfQoK\nICAgIHB1YmxpYyB2b2lkIGFkZFRyYW5zYWN0aW9uTGlzdGVuZXIoT2JqZWN0\nIGxpc3RlbmVyKSB7CiAgICAgICAgX2ZhY3RvcnkuYWRkVHJhbnNhY3Rpb25M\naXN0ZW5lcihsaXN0ZW5lcik7CiAgICB9CgogICAgcHVibGljIHZvaWQgcmVt\nb3ZlVHJhbnNhY3Rpb25MaXN0ZW5lcihPYmplY3QgbGlzdGVuZXIpIHsKICAg\nICAgICBfZmFjdG9yeS5yZW1vdmVUcmFuc2FjdGlvbkxpc3RlbmVyKGxpc3Rl\nbmVyKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBjbG9zZSgpIHsKICAgICAg\nICBfZmFjdG9yeS5jbG9zZSgpOwogICAgfQoKICAgIHB1YmxpYyBib29sZWFu\nIGlzT3BlbigpIHsKICAgICAgICByZXR1cm4gIV9mYWN0b3J5LmlzQ2xvc2Vk\nKCk7CiAgICB9CgogICAgcHVibGljIGludCBoYXNoQ29kZSgpIHsKICAgICAg\nICByZXR1cm4gKF9mYWN0b3J5ID09IG51bGwpID8gMCA6IF9mYWN0b3J5Lmhh\nc2hDb2RlKCk7CiAgICB9CgogICAgcHVibGljIGJvb2xlYW4gZXF1YWxzKE9i\namVjdCBvdGhlcikgewogICAgICAgIGlmIChvdGhlciA9PSB0aGlzKQogICAg\nICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICBpZiAoKG90aGVyID09IG51\nbGwpIHx8IChvdGhlci5nZXRDbGFzcygpICE9IHRoaXMuZ2V0Q2xhc3MoKSkp\nCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICBpZiAoX2ZhY3Rv\ncnkgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAg\nIHJldHVybiBfZmFjdG9yeS5lcXVhbHMoKChFbnRpdHlNYW5hZ2VyRmFjdG9y\neUltcGwpIG90aGVyKS5fZmFjdG9yeSk7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBDcmVhdGUgYSBzdG9yZS1zcGVjaWZpYyBmYWNhZGUgZm9yIHRoZSBnaXZl\nbiBmZXRjaCBjb25maWd1cmF0aW9uLgoJICogSWYgbm8gZmFjYWRlIGNsYXNz\nIGV4aXN0cywgd2UgdXNlIHRoZSBkZWZhdWx0IHtAbGluayBGZXRjaFBsYW59\nLgogICAgICovCiAgICBGZXRjaFBsYW4gdG9GZXRjaFBsYW4oQnJva2VyIGJy\nb2tlciwgRmV0Y2hDb25maWd1cmF0aW9uIGZldGNoKSB7CiAgICAgICAgaWYg\nKGZldGNoID09IG51bGwpCiAgICAgICAgICAgIHJldHVybiBudWxsOwoKICAg\nICAgICBpZiAoZmV0Y2ggaW5zdGFuY2VvZiBEZWxlZ2F0aW5nRmV0Y2hDb25m\naWd1cmF0aW9uKQogICAgICAgICAgICBmZXRjaCA9ICgoRGVsZWdhdGluZ0Zl\ndGNoQ29uZmlndXJhdGlvbikgZmV0Y2gpLgogICAgICAgICAgICAgICAgZ2V0\nSW5uZXJtb3N0RGVsZWdhdGUoKTsKCiAgICAgICAgdHJ5IHsKICAgICAgICAg\nICAgaWYgKF9wbGFuID09IG51bGwpIHsKICAgICAgICAgICAgICAgIENsYXNz\nIHN0b3JlVHlwZSA9IChicm9rZXIgPT0gbnVsbCkgPyBudWxsIDogYnJva2Vy\nLgogICAgICAgICAgICAgICAgICAgIGdldFN0b3JlTWFuYWdlcigpLmdldElu\nbmVybW9zdERlbGVnYXRlKCkuZ2V0Q2xhc3MoKTsKICAgICAgICAgICAgICAg\nIENsYXNzIGNscyA9IF9mYWN0b3J5LmdldENvbmZpZ3VyYXRpb24oKS4KICAg\nICAgICAgICAgICAgICAgICBnZXRTdG9yZUZhY2FkZVR5cGVSZWdpc3RyeSgp\nLgogICAgICAgICAgICAgICAgICAgIGdldEltcGxlbWVudGF0aW9uKEZldGNo\nUGxhbi5jbGFzcywgc3RvcmVUeXBlLCAKICAgICAgICAgICAgICAgICAgICAJ\nCUZldGNoUGxhbkltcGwuY2xhc3MpOwogICAgICAgICAgICAgICAgX3BsYW4g\nPSBjbHMuZ2V0Q29uc3RydWN0b3IoRmV0Y2hDb25maWd1cmF0aW9uLmNsYXNz\nKTsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gX3BsYW4ubmV3\nSW5zdGFuY2UoZmV0Y2gpOwogICAgICAgIH0gY2F0Y2ggKEludm9jYXRpb25U\nYXJnZXRFeGNlcHRpb24gaXRlKSB7CiAgICAgICAgICAgIHRocm93IFBlcnNp\nc3RlbmNlRXhjZXB0aW9ucy50b1BlcnNpc3RlbmNlRXhjZXB0aW9uCiAgICAg\nICAgICAgICAgICAoaXRlLmdldFRhcmdldEV4Y2VwdGlvbigpKTsKICAgICAg\nICB9IGNhdGNoIChFeGNlcHRpb24gZSkgewogICAgICAgICAgICB0aHJvdyBQ\nZXJzaXN0ZW5jZUV4Y2VwdGlvbnMudG9QZXJzaXN0ZW5jZUV4Y2VwdGlvbihl\nKTsKICAgICAgICB9Cgl9CgogICAgcHVibGljIENhY2hlIGdldENhY2hlKCkg\newogICAgICAgIF9mYWN0b3J5LmFzc2VydE9wZW4oKTsKICAgICAgICByZXR1\ncm4gZ2V0U3RvcmVDYWNoZSgpOwogICAgfQoKICAgIHB1YmxpYyBPcGVuSlBB\nQ3JpdGVyaWFCdWlsZGVyIGdldENyaXRlcmlhQnVpbGRlcigpIHsKICAgICAg\nICByZXR1cm4gbmV3IENyaXRlcmlhQnVpbGRlckltcGwoKS5zZXRNZXRhTW9k\nZWwoZ2V0TWV0YW1vZGVsKCkpOwogICAgfQogICAgCiAgICBwdWJsaWMgT3Bl\nbkpQQVF1ZXJ5QnVpbGRlciBnZXREeW5hbWljUXVlcnlCdWlsZGVyKCkgewog\nICAgICAgIHJldHVybiBuZXcgUXVlcnlCdWlsZGVySW1wbCh0aGlzKTsKICAg\nIH0KCiAgICBwdWJsaWMgU2V0PFN0cmluZz4gZ2V0U3VwcG9ydGVkUHJvcGVy\ndGllcygpIHsKICAgICAgICByZXR1cm4gX2ZhY3RvcnkuZ2V0U3VwcG9ydGVk\nUHJvcGVydGllcygpOwogICAgfQoKICAgIHB1YmxpYyBNZXRhbW9kZWxJbXBs\nIGdldE1ldGFtb2RlbCgpIHsKICAgICAgICBpZiAoX21ldGFNb2RlbCA9PSBu\ndWxsKSB7CiAgICAgICAgICAgIF9tZXRhTW9kZWwgPSBuZXcgTWV0YW1vZGVs\nSW1wbChnZXRDb25maWd1cmF0aW9uKCkKICAgICAgICAgICAgICAgIC5nZXRN\nZXRhRGF0YVJlcG9zaXRvcnlJbnN0YW5jZSgpKTsKICAgICAgICB9CiAgICAg\nICAgcmV0dXJuIF9tZXRhTW9kZWw7CiAgICB9CgogICAgcHVibGljIFBlcnNp\nc3RlbmNlVW5pdFV0aWwgZ2V0UGVyc2lzdGVuY2VVbml0VXRpbCgpIHsKICAg\nICAgICByZXR1cm4gdGhpczsKICAgIH0KCiAgICAvKioKICAgICAqIEdldCB0\naGUgaWRlbnRpZmllciBmb3IgdGhlIHNwZWNpZmllZCBlbnRpdHkuICBJZiBu\nb3QgbWFuYWdlZCBieSBhbnkKICAgICAqIG9mIHRoZSBlbSdzIGluIHRoaXMg\nUFUgb3Igbm90IHBlcnNpc3RlbmNlIGNhcGFibGUsIHJldHVybiBudWxsLgog\nICAgICovCiAgICBwdWJsaWMgT2JqZWN0IGdldElkZW50aWZpZXIoT2JqZWN0\nIGVudGl0eSkgewogICAgICAgIHJldHVybiBPcGVuSlBBUGVyc2lzdGVuY2VV\ndGlsLmdldElkZW50aWZpZXIodGhpcywgZW50aXR5KTsKICAgIH0KCiAgICBw\ndWJsaWMgYm9vbGVhbiBpc0xvYWRlZChPYmplY3QgZW50aXR5KSB7CiAgICAg\nICAgcmV0dXJuIGlzTG9hZGVkKGVudGl0eSwgbnVsbCk7CiAgICB9CgogICAg\ncHVibGljIGJvb2xlYW4gaXNMb2FkZWQoT2JqZWN0IGVudGl0eSwgU3RyaW5n\nIGF0dHJpYnV0ZSkgewogICAgICAgIGlmIChlbnRpdHkgPT0gbnVsbCkgewog\nICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQogICAgICAgIHJl\ndHVybiAoT3BlbkpQQVBlcnNpc3RlbmNlVXRpbC5pc01hbmFnZWRCeSh0aGlz\nLCBlbnRpdHkpICYmCiAgICAgICAgICAgICAgICAoT3BlbkpQQVBlcnNpc3Rl\nbmNlVXRpbC5pc0xvYWRlZChlbnRpdHksIGF0dHJpYnV0ZSkgPT0gTG9hZFN0\nYXRlLkxPQURFRCkpOwogICAgfQogICAgCiAgICBwcml2YXRlIHZvaWQgdmFs\naWRhdGVDZk5hbWVQcm9wcyhPcGVuSlBBQ29uZmlndXJhdGlvbiBjb25mLCBT\ndHJpbmcgY2ZOYW1lLCBTdHJpbmcgY2YyTmFtZSkgewogICAgICAgIGlmIChT\ndHJpbmdVdGlscy5pc05vdEVtcHR5KGNmTmFtZSkgfHwgU3RyaW5nVXRpbHMu\naXNOb3RFbXB0eShjZjJOYW1lKSkgewogICAgICAgICAgICBpZiAoY29uZi5n\nZXREYXRhQ2FjaGUoKSAhPSAiZmFsc2UiICYmIGNvbmYuZ2V0RGF0YUNhY2hl\nKCkgIT0gbnVsbCkgewogICAgICAgICAgICAgICAgdGhyb3cgbmV3IEFyZ3Vt\nZW50RXhjZXB0aW9uKF9sb2MuZ2V0KCJpbnZhbGlkLWNmbmFtZS1wcm9wIiwg\nbmV3IE9iamVjdFtdIHsKICAgICAgICAgICAgICAgICAgICAib3BlbmpwYS5E\nYXRhQ2FjaGUgKEwyIENhY2hlKSIsCiAgICAgICAgICAgICAgICAgICAgY2ZO\nYW1lLAogICAgICAgICAgICAgICAgICAgIGNmMk5hbWUgfSksIG51bGwsIG51\nbGwsIHRydWUpOwoKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoY29u\nZi5nZXRRdWVyeUNhY2hlKCkgIT0gImZhbHNlIiAmJiBjb25mLmdldFF1ZXJ5\nQ2FjaGUoKSAhPSBudWxsKSB7CiAgICAgICAgICAgICAgICB0aHJvdyBuZXcg\nQXJndW1lbnRFeGNlcHRpb24oX2xvYy5nZXQoImludmFsaWQtY2ZuYW1lLXBy\nb3AiLCBuZXcgT2JqZWN0W10gewogICAgICAgICAgICAgICAgICAgICJvcGVu\nanBhLlF1ZXJ5Q2FjaGUiLAogICAgICAgICAgICAgICAgICAgIGNmTmFtZSwK\nICAgICAgICAgICAgICAgICAgICBjZjJOYW1lIH0pLCBudWxsLCBudWxsLCB0\ncnVlKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBPYmplY3Qgc3luY01h\ncCA9IGNvbmYudG9Qcm9wZXJ0aWVzKGZhbHNlKS5nZXQoIm9wZW5qcGEuamRi\nYy5TeW5jaHJvbml6ZU1hcHBpbmdzIik7CiAgICAgICAgICAgIGlmKHN5bmNN\nYXAgIT0gbnVsbCkgeyAKICAgICAgICAgICAgICAgIHRocm93IG5ldyBBcmd1\nbWVudEV4Y2VwdGlvbihfbG9jLmdldCgiaW52YWxpZC1jZm5hbWUtcHJvcCIs\nIG5ldyBPYmplY3RbXSB7CiAgICAgICAgICAgICAgICAgICAgIm9wZW5qcGEu\namRiYy5TeW5jaHJvbml6ZU1hcHBpbmdzIiwKICAgICAgICAgICAgICAgICAg\nICBjZk5hbWUsCiAgICAgICAgICAgICAgICAgICAgY2YyTmFtZSB9KSwgbnVs\nbCwgbnVsbCwgdHJ1ZSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9\nCn0K\n","encoding":"base64"}

