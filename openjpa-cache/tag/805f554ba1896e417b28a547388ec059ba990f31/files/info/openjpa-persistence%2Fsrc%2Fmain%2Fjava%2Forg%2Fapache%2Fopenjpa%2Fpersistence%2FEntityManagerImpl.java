{"sha":"f0fc8c4c52f21c40e53e492dddb11d33b8162294","node_id":"MDQ6QmxvYjIwNjM2NDpmMGZjOGM0YzUyZjIxYzQwZTUzZTQ5MmRkZGIxMWQzM2I4MTYyMjk0","size":61611,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/f0fc8c4c52f21c40e53e492dddb11d33b8162294","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2U7CgppbXBv\ncnQgamF2YS5pby5CeXRlQXJyYXlJbnB1dFN0cmVhbTsKaW1wb3J0IGphdmEu\naW8uQnl0ZUFycmF5T3V0cHV0U3RyZWFtOwppbXBvcnQgamF2YS5pby5FeHRl\ncm5hbGl6YWJsZTsKaW1wb3J0IGphdmEuaW8uSU9FeGNlcHRpb247CmltcG9y\ndCBqYXZhLmlvLk9iamVjdElucHV0OwppbXBvcnQgamF2YS5pby5PYmplY3RJ\nbnB1dFN0cmVhbTsKaW1wb3J0IGphdmEuaW8uT2JqZWN0T3V0cHV0OwppbXBv\ncnQgamF2YS5pby5PYmplY3RPdXRwdXRTdHJlYW07CmltcG9ydCBqYXZhLmlv\nLk9iamVjdFN0cmVhbUNsYXNzOwppbXBvcnQgamF2YS5sYW5nLnJlZmxlY3Qu\nQXJyYXk7CmltcG9ydCBqYXZhLmxhbmcucmVmbGVjdC5GaWVsZDsKaW1wb3J0\nIGphdmEubGFuZy5yZWZsZWN0Lk1ldGhvZDsKaW1wb3J0IGphdmEudXRpbC5B\ncnJheXM7CmltcG9ydCBqYXZhLnV0aWwuQ29sbGVjdGlvbjsKaW1wb3J0IGph\ndmEudXRpbC5FbnVtU2V0OwppbXBvcnQgamF2YS51dGlsLkhhc2hNYXA7Cmlt\ncG9ydCBqYXZhLnV0aWwuSWRlbnRpdHlIYXNoTWFwOwppbXBvcnQgamF2YS51\ndGlsLk1hcDsKaW1wb3J0IGphdmEudXRpbC5TZXQ7CgppbXBvcnQgamF2YXgu\ncGVyc2lzdGVuY2UuQ2FjaGVSZXRyaWV2ZU1vZGU7CmltcG9ydCBqYXZheC5w\nZXJzaXN0ZW5jZS5DYWNoZVN0b3JlTW9kZTsKaW1wb3J0IGphdmF4LnBlcnNp\nc3RlbmNlLkVudGl0eU1hbmFnZXI7CmltcG9ydCBqYXZheC5wZXJzaXN0ZW5j\nZS5GbHVzaE1vZGVUeXBlOwppbXBvcnQgamF2YXgucGVyc2lzdGVuY2UuTG9j\na01vZGVUeXBlOwppbXBvcnQgamF2YXgucGVyc2lzdGVuY2UuUXVlcnk7Cmlt\ncG9ydCBqYXZheC5wZXJzaXN0ZW5jZS5UeXBlZFF1ZXJ5OwppbXBvcnQgamF2\nYXgucGVyc2lzdGVuY2UuY3JpdGVyaWEuQ3JpdGVyaWFRdWVyeTsKaW1wb3J0\nIGphdmF4LnBlcnNpc3RlbmNlLmNyaXRlcmlhLlBhcmFtZXRlckV4cHJlc3Np\nb247CmltcG9ydCBqYXZheC5wZXJzaXN0ZW5jZS5tZXRhbW9kZWwuTWV0YW1v\nZGVsOwoKaW1wb3J0IG9yZy5hcGFjaGUuY29tbW9ucy5sYW5nLlN0cmluZ1V0\naWxzOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmNvbmYuQ29tcGF0aWJp\nbGl0eTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5jb25mLk9wZW5KUEFD\nb25maWd1cmF0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmVlLk1h\nbmFnZWRSdW50aW1lOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmVuaGFu\nY2UuUENFbmhhbmNlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5lbmhh\nbmNlLlBDUmVnaXN0cnk7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuZW5o\nYW5jZS5SZWZsZWN0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmtl\ncm5lbC5BYnN0cmFjdEJyb2tlckZhY3Rvcnk7CmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEua2VybmVsLkJyb2tlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5rZXJuZWwuRGF0YUNhY2hlUmV0cmlldmVNb2RlOwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5EYXRhQ2FjaGVTdG9yZU1vZGU7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLkRlbGVnYXRpbmdCcm9r\nZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLkZldGNoQ29u\nZmlndXJhdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwu\nRmluZENhbGxiYWNrczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJu\nZWwuT3BDYWxsYmFja3M7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEua2Vy\nbmVsLk9wZW5KUEFTdGF0ZU1hbmFnZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEua2VybmVsLlByZXBhcmVkUXVlcnk7CmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEua2VybmVsLlByZXBhcmVkUXVlcnlDYWNoZTsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuUXVlcnlGbHVzaE1vZGVzOwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5RdWVyeUxhbmd1YWdlczsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuU2VxOwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5qcHFsLkpQUUxQYXJzZXI7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLmxvZy5Mb2c7CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuQ2xvc2VhYmxlOwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51dGlsLkxvY2FsaXplcjsKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5tZXRhLkNsYXNzTWV0YURhdGE7CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YS5GaWVsZE1ldGFEYXRhOwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuUXVlcnlNZXRhRGF0YTsKaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRhLlNlcXVlbmNlTWV0YURhdGE7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuY3JpdGVy\naWEuQ3JpdGVyaWFCdWlsZGVySW1wbDsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5wZXJzaXN0ZW5jZS5jcml0ZXJpYS5PcGVuSlBBQ3JpdGVyaWFCdWls\nZGVyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNlLmNy\naXRlcmlhLk9wZW5KUEFDcml0ZXJpYVF1ZXJ5OwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLnBlcnNpc3RlbmNlLnZhbGlkYXRpb24uVmFsaWRhdGlvblV0\naWxzOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuRXhjZXB0aW9u\nSW5mbzsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLkV4Y2VwdGlv\nbnM7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5JbXBsSGVscGVy\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuUnVudGltZUV4Y2Vw\ndGlvblRyYW5zbGF0b3I7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRp\nbC5Vc2VyRXhjZXB0aW9uOwoKaW1wb3J0IHNlcnAudXRpbC5TdHJpbmdzOwoK\nLyoqCiAqIEltcGxlbWVudGF0aW9uIG9mIHtAbGluayBFbnRpdHlNYW5hZ2Vy\nfSBpbnRlcmZhY2UuCiAqCiAqIEBhdXRob3IgUGF0cmljayBMaW5za2V5CiAq\nIEBhdXRob3IgQWJlIFdoaXRlCiAqIEBub2phdmFkb2MKICovCnB1YmxpYyBj\nbGFzcyBFbnRpdHlNYW5hZ2VySW1wbAogICAgaW1wbGVtZW50cyBPcGVuSlBB\nRW50aXR5TWFuYWdlclNQSSwgRXh0ZXJuYWxpemFibGUsCiAgICBGaW5kQ2Fs\nbGJhY2tzLCBPcENhbGxiYWNrcywgQ2xvc2VhYmxlLCBPcGVuSlBBRW50aXR5\nVHJhbnNhY3Rpb24gewoKICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIExvY2Fs\naXplciBfbG9jID0gTG9jYWxpemVyLmZvclBhY2thZ2UoRW50aXR5TWFuYWdl\nckltcGwuY2xhc3MpOwogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgT2JqZWN0\nW10gRU1QVFlfT0JKRUNUUyA9IG5ldyBPYmplY3RbMF07CiAgICAKICAgIHBy\naXZhdGUgc3RhdGljIGZpbmFsIFN0cmluZyBHRVRfTE9DS19NT0RFID0gImdl\ndExvY2tNb2RlIjsKICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIFN0cmluZyBM\nT0NLID0gImxvY2siOwogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgU3RyaW5n\nIFJFRlJFU0ggPSAicmVmcmVzaCI7CgogICAgcHJpdmF0ZSBEZWxlZ2F0aW5n\nQnJva2VyIF9icm9rZXI7CiAgICBwcml2YXRlIEVudGl0eU1hbmFnZXJGYWN0\nb3J5SW1wbCBfZW1mOwogICAgcHJpdmF0ZSBNYXA8RmV0Y2hDb25maWd1cmF0\naW9uLEZldGNoUGxhbj4gX3BsYW5zID0gbmV3IElkZW50aXR5SGFzaE1hcDxG\nZXRjaENvbmZpZ3VyYXRpb24sRmV0Y2hQbGFuPigxKTsKICAgIHByb3RlY3Rl\nZCBSdW50aW1lRXhjZXB0aW9uVHJhbnNsYXRvciBfcmV0ID0gUGVyc2lzdGVu\nY2VFeGNlcHRpb25zLmdldFJvbGxiYWNrVHJhbnNsYXRvcih0aGlzKTsKCiAg\nICBwdWJsaWMgRW50aXR5TWFuYWdlckltcGwoKSB7CiAgICAgICAgLy8gZm9y\nIEV4dGVybmFsaXphYmxlCiAgICB9CgogICAgLyoqCiAgICAgKiBDb25zdHJ1\nY3Rvcjsgc3VwcGx5IGZhY3RvcnkgYW5kIGRlbGVnYXRlLgogICAgICovCiAg\nICBwdWJsaWMgRW50aXR5TWFuYWdlckltcGwoRW50aXR5TWFuYWdlckZhY3Rv\ncnlJbXBsIGZhY3RvcnksIEJyb2tlciBicm9rZXIpIHsKICAgICAgICBpbml0\naWFsaXplKGZhY3RvcnksIGJyb2tlcik7CiAgICB9CgogICAgcHJpdmF0ZSB2\nb2lkIGluaXRpYWxpemUoRW50aXR5TWFuYWdlckZhY3RvcnlJbXBsIGZhY3Rv\ncnksIEJyb2tlciBicm9rZXIpIHsKICAgICAgICBfZW1mID0gZmFjdG9yeTsK\nICAgICAgICBfYnJva2VyID0gbmV3IERlbGVnYXRpbmdCcm9rZXIoYnJva2Vy\nLCBfcmV0KTsKICAgICAgICBfYnJva2VyLnNldEltcGxpY2l0QmVoYXZpb3Io\ndGhpcywgX3JldCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBCcm9rZXIgZGVs\nZWdhdGUuCiAgICAgKi8KICAgIHB1YmxpYyBCcm9rZXIgZ2V0QnJva2VyKCkg\newogICAgICAgIHJldHVybiBfYnJva2VyLmdldERlbGVnYXRlKCk7CiAgICB9\nCgogICAgcHVibGljIE9wZW5KUEFFbnRpdHlNYW5hZ2VyRmFjdG9yeSBnZXRF\nbnRpdHlNYW5hZ2VyRmFjdG9yeSgpIHsKICAgICAgICByZXR1cm4gX2VtZjsK\nICAgIH0KCiAgICBwdWJsaWMgT3BlbkpQQUNvbmZpZ3VyYXRpb24gZ2V0Q29u\nZmlndXJhdGlvbigpIHsKICAgICAgICByZXR1cm4gX2Jyb2tlci5nZXRDb25m\naWd1cmF0aW9uKCk7CiAgICB9CgogICAgcHVibGljIEZldGNoUGxhbiBnZXRG\nZXRjaFBsYW4oKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7\nCiAgICAgICAgX2Jyb2tlci5sb2NrKCk7CiAgICAgICAgdHJ5IHsKICAgICAg\nICAgICAgRmV0Y2hDb25maWd1cmF0aW9uIGZjID0gX2Jyb2tlci5nZXRGZXRj\naENvbmZpZ3VyYXRpb24oKTsKICAgICAgICAgICAgRmV0Y2hQbGFuIGZwID0g\nX3BsYW5zLmdldChmYyk7CiAgICAgICAgICAgIGlmIChmcCA9PSBudWxsKSB7\nCiAgICAgICAgICAgICAgICBmcCA9IF9lbWYudG9GZXRjaFBsYW4oX2Jyb2tl\nciwgZmMpOwogICAgICAgICAgICAgICAgX3BsYW5zLnB1dChmYywgZnApOwog\nICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiBmcDsKICAgICAgICB9\nIGZpbmFsbHkgewogICAgICAgICAgICBfYnJva2VyLnVubG9jaygpOwogICAg\nICAgIH0KICAgIH0KCiAgICBwdWJsaWMgRmV0Y2hQbGFuIHB1c2hGZXRjaFBs\nYW4oKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAg\nICAgX2Jyb2tlci5sb2NrKCk7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAg\nX2Jyb2tlci5wdXNoRmV0Y2hDb25maWd1cmF0aW9uKCk7CiAgICAgICAgICAg\nIHJldHVybiBnZXRGZXRjaFBsYW4oKTsKICAgICAgICB9IGZpbmFsbHkgewog\nICAgICAgICAgICBfYnJva2VyLnVubG9jaygpOwogICAgICAgIH0KICAgIH0K\nCiAgICBwdWJsaWMgdm9pZCBwb3BGZXRjaFBsYW4oKSB7CiAgICAgICAgYXNz\nZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAgX2Jyb2tlci5sb2NrKCk7\nCiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgX3BsYW5zLnJlbW92ZShfYnJv\na2VyLmdldEZldGNoQ29uZmlndXJhdGlvbigpKTsKICAgICAgICAgICAgX2Jy\nb2tlci5wb3BGZXRjaENvbmZpZ3VyYXRpb24oKTsKICAgICAgICB9IGZpbmFs\nbHkgewogICAgICAgICAgICBfYnJva2VyLnVubG9jaygpOwogICAgICAgIH0K\nICAgIH0KCiAgICBwdWJsaWMgQ29ubmVjdGlvblJldGFpbk1vZGUgZ2V0Q29u\nbmVjdGlvblJldGFpbk1vZGUoKSB7CiAgICAgICAgcmV0dXJuIENvbm5lY3Rp\nb25SZXRhaW5Nb2RlLmZyb21LZXJuZWxDb25zdGFudCgKICAgICAgICAgICAg\nX2Jyb2tlci5nZXRDb25uZWN0aW9uUmV0YWluTW9kZSgpKTsKICAgIH0KCiAg\nICBwdWJsaWMgYm9vbGVhbiBpc1RyYW5zYWN0aW9uTWFuYWdlZCgpIHsKICAg\nICAgICByZXR1cm4gX2Jyb2tlci5pc01hbmFnZWQoKTsKICAgIH0KCiAgICBw\ndWJsaWMgYm9vbGVhbiBpc01hbmFnZWQoKSB7CiAgICAgICAgcmV0dXJuIF9i\ncm9rZXIuaXNNYW5hZ2VkKCk7CiAgICB9CgogICAgcHVibGljIE1hbmFnZWRS\ndW50aW1lIGdldE1hbmFnZWRSdW50aW1lKCkgewogICAgICAgIHJldHVybiBf\nYnJva2VyLmdldE1hbmFnZWRSdW50aW1lKCk7CiAgICB9CgogICAgcHVibGlj\nIGJvb2xlYW4gZ2V0U3luY1dpdGhNYW5hZ2VkVHJhbnNhY3Rpb25zKCkgewog\nICAgICAgIHJldHVybiBfYnJva2VyLmdldFN5bmNXaXRoTWFuYWdlZFRyYW5z\nYWN0aW9ucygpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldFN5bmNXaXRo\nTWFuYWdlZFRyYW5zYWN0aW9ucyhib29sZWFuIHN5bmMpIHsKICAgICAgICBh\nc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICBfYnJva2VyLnNldFN5\nbmNXaXRoTWFuYWdlZFRyYW5zYWN0aW9ucyhzeW5jKTsKICAgIH0KCiAgICBw\ndWJsaWMgQ2xhc3NMb2FkZXIgZ2V0Q2xhc3NMb2FkZXIoKSB7CiAgICAgICAg\ncmV0dXJuIF9icm9rZXIuZ2V0Q2xhc3NMb2FkZXIoKTsKICAgIH0KCiAgICBw\ndWJsaWMgU3RyaW5nIGdldENvbm5lY3Rpb25Vc2VyTmFtZSgpIHsKICAgICAg\nICByZXR1cm4gX2Jyb2tlci5nZXRDb25uZWN0aW9uVXNlck5hbWUoKTsKICAg\nIH0KCiAgICBwdWJsaWMgU3RyaW5nIGdldENvbm5lY3Rpb25QYXNzd29yZCgp\nIHsKICAgICAgICByZXR1cm4gX2Jyb2tlci5nZXRDb25uZWN0aW9uUGFzc3dv\ncmQoKTsKICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBnZXRNdWx0aXRocmVh\nZGVkKCkgewogICAgICAgIHJldHVybiBfYnJva2VyLmdldE11bHRpdGhyZWFk\nZWQoKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRNdWx0aXRocmVhZGVk\nKGJvb2xlYW4gbXVsdGl0aHJlYWRlZCkgewogICAgICAgIGFzc2VydE5vdENs\nb3NlSW52b2tlZCgpOwogICAgICAgIF9icm9rZXIuc2V0TXVsdGl0aHJlYWRl\nZChtdWx0aXRocmVhZGVkKTsKICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBn\nZXRJZ25vcmVDaGFuZ2VzKCkgewogICAgICAgIHJldHVybiBfYnJva2VyLmdl\ndElnbm9yZUNoYW5nZXMoKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRJ\nZ25vcmVDaGFuZ2VzKGJvb2xlYW4gdmFsKSB7CiAgICAgICAgYXNzZXJ0Tm90\nQ2xvc2VJbnZva2VkKCk7CiAgICAgICAgX2Jyb2tlci5zZXRJZ25vcmVDaGFu\nZ2VzKHZhbCk7CiAgICB9CgogICAgcHVibGljIGJvb2xlYW4gZ2V0Tm9udHJh\nbnNhY3Rpb25hbFJlYWQoKSB7CiAgICAgICAgcmV0dXJuIF9icm9rZXIuZ2V0\nTm9udHJhbnNhY3Rpb25hbFJlYWQoKTsKICAgIH0KCiAgICBwdWJsaWMgdm9p\nZCBzZXROb250cmFuc2FjdGlvbmFsUmVhZChib29sZWFuIHZhbCkgewogICAg\nICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIF9icm9rZXIu\nc2V0Tm9udHJhbnNhY3Rpb25hbFJlYWQodmFsKTsKICAgIH0KCiAgICBwdWJs\naWMgYm9vbGVhbiBnZXROb250cmFuc2FjdGlvbmFsV3JpdGUoKSB7CiAgICAg\nICAgcmV0dXJuIF9icm9rZXIuZ2V0Tm9udHJhbnNhY3Rpb25hbFdyaXRlKCk7\nCiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0Tm9udHJhbnNhY3Rpb25hbFdy\naXRlKGJvb2xlYW4gdmFsKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZv\na2VkKCk7CiAgICAgICAgX2Jyb2tlci5zZXROb250cmFuc2FjdGlvbmFsV3Jp\ndGUodmFsKTsKICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBnZXRPcHRpbWlz\ndGljKCkgewogICAgICAgIHJldHVybiBfYnJva2VyLmdldE9wdGltaXN0aWMo\nKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRPcHRpbWlzdGljKGJvb2xl\nYW4gdmFsKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAg\nICAgICAgX2Jyb2tlci5zZXRPcHRpbWlzdGljKHZhbCk7CiAgICB9CgogICAg\ncHVibGljIFJlc3RvcmVTdGF0ZVR5cGUgZ2V0UmVzdG9yZVN0YXRlKCkgewog\nICAgICAgIHJldHVybiBSZXN0b3JlU3RhdGVUeXBlLmZyb21LZXJuZWxDb25z\ndGFudChfYnJva2VyLmdldFJlc3RvcmVTdGF0ZSgpKTsKICAgIH0KCiAgICBw\ndWJsaWMgdm9pZCBzZXRSZXN0b3JlU3RhdGUoUmVzdG9yZVN0YXRlVHlwZSB2\nYWwpIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAgICAg\nICBfYnJva2VyLnNldFJlc3RvcmVTdGF0ZSh2YWwudG9LZXJuZWxDb25zdGFu\ndCgpKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRSZXN0b3JlU3RhdGUo\naW50IHJlc3RvcmUpIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQo\nKTsKICAgICAgICBfYnJva2VyLnNldFJlc3RvcmVTdGF0ZShyZXN0b3JlKTsK\nICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBnZXRSZXRhaW5TdGF0ZSgpIHsK\nICAgICAgICByZXR1cm4gX2Jyb2tlci5nZXRSZXRhaW5TdGF0ZSgpOwogICAg\nfQoKICAgIHB1YmxpYyB2b2lkIHNldFJldGFpblN0YXRlKGJvb2xlYW4gdmFs\nKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAg\nX2Jyb2tlci5zZXRSZXRhaW5TdGF0ZSh2YWwpOwogICAgfQoKICAgIHB1Ymxp\nYyBBdXRvQ2xlYXJUeXBlIGdldEF1dG9DbGVhcigpIHsKICAgICAgICByZXR1\ncm4gQXV0b0NsZWFyVHlwZS5mcm9tS2VybmVsQ29uc3RhbnQoX2Jyb2tlci5n\nZXRBdXRvQ2xlYXIoKSk7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0QXV0\nb0NsZWFyKEF1dG9DbGVhclR5cGUgdmFsKSB7CiAgICAgICAgYXNzZXJ0Tm90\nQ2xvc2VJbnZva2VkKCk7CiAgICAgICAgX2Jyb2tlci5zZXRBdXRvQ2xlYXIo\ndmFsLnRvS2VybmVsQ29uc3RhbnQoKSk7CiAgICB9CgogICAgcHVibGljIHZv\naWQgc2V0QXV0b0NsZWFyKGludCBhdXRvQ2xlYXIpIHsKICAgICAgICBhc3Nl\ncnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICBfYnJva2VyLnNldEF1dG9D\nbGVhcihhdXRvQ2xlYXIpOwogICAgfQoKICAgIHB1YmxpYyBEZXRhY2hTdGF0\nZVR5cGUgZ2V0RGV0YWNoU3RhdGUoKSB7CiAgICAgICAgcmV0dXJuIERldGFj\naFN0YXRlVHlwZS5mcm9tS2VybmVsQ29uc3RhbnQoX2Jyb2tlci5nZXREZXRh\nY2hTdGF0ZSgpKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZXREZXRhY2hT\ndGF0ZShEZXRhY2hTdGF0ZVR5cGUgdHlwZSkgewogICAgICAgIGFzc2VydE5v\ndENsb3NlSW52b2tlZCgpOwogICAgICAgIF9icm9rZXIuc2V0RGV0YWNoU3Rh\ndGUodHlwZS50b0tlcm5lbENvbnN0YW50KCkpOwogICAgfQoKICAgIHB1Ymxp\nYyB2b2lkIHNldERldGFjaFN0YXRlKGludCBkZXRhY2gpIHsKICAgICAgICBh\nc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICBfYnJva2VyLnNldERl\ndGFjaFN0YXRlKGRldGFjaCk7CiAgICB9CgogICAgcHVibGljIEVudW1TZXQ8\nQXV0b0RldGFjaFR5cGU+IGdldEF1dG9EZXRhY2goKSB7CiAgICAgICAgcmV0\ndXJuIEF1dG9EZXRhY2hUeXBlLnRvRW51bVNldChfYnJva2VyLmdldEF1dG9E\nZXRhY2goKSk7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0QXV0b0RldGFj\naChBdXRvRGV0YWNoVHlwZSBmbGFnKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xv\nc2VJbnZva2VkKCk7CiAgICAgICAgX2Jyb2tlci5zZXRBdXRvRGV0YWNoKEF1\ndG9EZXRhY2hUeXBlLmZyb21FbnVtU2V0KEVudW1TZXQub2YoZmxhZykpKTsK\nICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRBdXRvRGV0YWNoKEVudW1TZXQ8\nQXV0b0RldGFjaFR5cGU+IGZsYWdzKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xv\nc2VJbnZva2VkKCk7CiAgICAgICAgX2Jyb2tlci5zZXRBdXRvRGV0YWNoKEF1\ndG9EZXRhY2hUeXBlLmZyb21FbnVtU2V0KGZsYWdzKSk7CiAgICB9CgogICAg\ncHVibGljIHZvaWQgc2V0QXV0b0RldGFjaChpbnQgYXV0b0RldGFjaEZsYWdz\nKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAg\nX2Jyb2tlci5zZXRBdXRvRGV0YWNoKGF1dG9EZXRhY2hGbGFncyk7CiAgICB9\nCgogICAgcHVibGljIHZvaWQgc2V0QXV0b0RldGFjaChBdXRvRGV0YWNoVHlw\nZSB2YWx1ZSwgYm9vbGVhbiBvbikgewogICAgICAgIGFzc2VydE5vdENsb3Nl\nSW52b2tlZCgpOwogICAgICAgIF9icm9rZXIuc2V0QXV0b0RldGFjaChBdXRv\nRGV0YWNoVHlwZS5mcm9tRW51bVNldChFbnVtU2V0Lm9mKHZhbHVlKSksb24p\nOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldEF1dG9EZXRhY2goaW50IGZs\nYWcsIGJvb2xlYW4gb24pIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUludm9r\nZWQoKTsKICAgICAgICBfYnJva2VyLnNldEF1dG9EZXRhY2goZmxhZywgb24p\nOwogICAgfQoKICAgIHB1YmxpYyBib29sZWFuIGdldEV2aWN0RnJvbVN0b3Jl\nQ2FjaGUoKSB7CiAgICAgICAgcmV0dXJuIF9icm9rZXIuZ2V0RXZpY3RGcm9t\nRGF0YUNhY2hlKCk7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0RXZpY3RG\ncm9tU3RvcmVDYWNoZShib29sZWFuIGV2aWN0KSB7CiAgICAgICAgYXNzZXJ0\nTm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAgX2Jyb2tlci5zZXRFdmljdEZy\nb21EYXRhQ2FjaGUoZXZpY3QpOwogICAgfQoKICAgIHB1YmxpYyBib29sZWFu\nIGdldFBvcHVsYXRlU3RvcmVDYWNoZSgpIHsKICAgICAgICByZXR1cm4gX2Jy\nb2tlci5nZXRQb3B1bGF0ZURhdGFDYWNoZSgpOwogICAgfQoKICAgIHB1Ymxp\nYyB2b2lkIHNldFBvcHVsYXRlU3RvcmVDYWNoZShib29sZWFuIGNhY2hlKSB7\nCiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAgX2Jy\nb2tlci5zZXRQb3B1bGF0ZURhdGFDYWNoZShjYWNoZSk7CiAgICB9CgogICAg\ncHVibGljIGJvb2xlYW4gaXNUcmFja0NoYW5nZXNCeVR5cGUoKSB7CiAgICAg\nICAgcmV0dXJuIF9icm9rZXIuaXNUcmFja0NoYW5nZXNCeVR5cGUoKTsKICAg\nIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRUcmFja0NoYW5nZXNCeVR5cGUoYm9v\nbGVhbiB0cmFja0J5VHlwZSkgewogICAgICAgIGFzc2VydE5vdENsb3NlSW52\nb2tlZCgpOwogICAgICAgIF9icm9rZXIuc2V0VHJhY2tDaGFuZ2VzQnlUeXBl\nKHRyYWNrQnlUeXBlKTsKICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBpc0xh\ncmdlVHJhbnNhY3Rpb24oKSB7CiAgICAgICAgcmV0dXJuIGlzVHJhY2tDaGFu\nZ2VzQnlUeXBlKCk7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0TGFyZ2VU\ncmFuc2FjdGlvbihib29sZWFuIHZhbHVlKSB7CiAgICAgICAgc2V0VHJhY2tD\naGFuZ2VzQnlUeXBlKHZhbHVlKTsKICAgIH0KCiAgICBwdWJsaWMgT2JqZWN0\nIGdldFVzZXJPYmplY3QoT2JqZWN0IGtleSkgewogICAgICAgIHJldHVybiBf\nYnJva2VyLmdldFVzZXJPYmplY3Qoa2V5KTsKICAgIH0KCiAgICBwdWJsaWMg\nT2JqZWN0IHB1dFVzZXJPYmplY3QoT2JqZWN0IGtleSwgT2JqZWN0IHZhbCkg\newogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIHJl\ndHVybiBfYnJva2VyLnB1dFVzZXJPYmplY3Qoa2V5LCB2YWwpOwogICAgfQoK\nICAgIHB1YmxpYyB2b2lkIGFkZFRyYW5zYWN0aW9uTGlzdGVuZXIoT2JqZWN0\nIGxpc3RlbmVyKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7\nCiAgICAgICAgX2Jyb2tlci5hZGRUcmFuc2FjdGlvbkxpc3RlbmVyKGxpc3Rl\nbmVyKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCByZW1vdmVUcmFuc2FjdGlv\nbkxpc3RlbmVyKE9iamVjdCBsaXN0ZW5lcikgewogICAgICAgIGFzc2VydE5v\ndENsb3NlSW52b2tlZCgpOwogICAgICAgIF9icm9rZXIucmVtb3ZlVHJhbnNh\nY3Rpb25MaXN0ZW5lcihsaXN0ZW5lcik7CiAgICB9CgogICAgcHVibGljIEVu\ndW1TZXQ8Q2FsbGJhY2tNb2RlPiBnZXRUcmFuc2FjdGlvbkxpc3RlbmVyQ2Fs\nbGJhY2tNb2RlcygpIHsKICAgICAgICByZXR1cm4gQ2FsbGJhY2tNb2RlLnRv\nRW51bVNldCgKICAgICAgICAgICAgX2Jyb2tlci5nZXRUcmFuc2FjdGlvbkxp\nc3RlbmVyQ2FsbGJhY2tNb2RlKCkpOwogICAgfQoKICAgIHB1YmxpYyB2b2lk\nIHNldFRyYW5zYWN0aW9uTGlzdGVuZXJDYWxsYmFja01vZGUoQ2FsbGJhY2tN\nb2RlIG1vZGUpIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsK\nICAgICAgICBfYnJva2VyLnNldFRyYW5zYWN0aW9uTGlzdGVuZXJDYWxsYmFj\na01vZGUoCiAgICAgICAgICAgIENhbGxiYWNrTW9kZS5mcm9tRW51bVNldChF\nbnVtU2V0Lm9mKG1vZGUpKSk7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0\nVHJhbnNhY3Rpb25MaXN0ZW5lckNhbGxiYWNrTW9kZShFbnVtU2V0PENhbGxi\nYWNrTW9kZT4gbW9kZXMpewogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tl\nZCgpOwogICAgICAgIF9icm9rZXIuc2V0VHJhbnNhY3Rpb25MaXN0ZW5lckNh\nbGxiYWNrTW9kZSgKICAgICAgICAgICAgQ2FsbGJhY2tNb2RlLmZyb21FbnVt\nU2V0KG1vZGVzKSk7CiAgICB9CgogICAgcHVibGljIGludCBnZXRUcmFuc2Fj\ndGlvbkxpc3RlbmVyQ2FsbGJhY2tNb2RlKCkgewogICAgICAgIHJldHVybiBf\nYnJva2VyLmdldFRyYW5zYWN0aW9uTGlzdGVuZXJDYWxsYmFja01vZGUoKTsK\nICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRUcmFuc2FjdGlvbkxpc3RlbmVy\nQ2FsbGJhY2tNb2RlKGludCBjYWxsYmFja01vZGUpIHsKICAgICAgICB0aHJv\ndyBuZXcgVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb24oKTsKICAgIH0K\nCiAgICBwdWJsaWMgdm9pZCBhZGRMaWZlY3ljbGVMaXN0ZW5lcihPYmplY3Qg\nbGlzdGVuZXIsIENsYXNzLi4uIGNsYXNzZXMpIHsKICAgICAgICBhc3NlcnRO\nb3RDbG9zZUludm9rZWQoKTsKICAgICAgICBfYnJva2VyLmFkZExpZmVjeWNs\nZUxpc3RlbmVyKGxpc3RlbmVyLCBjbGFzc2VzKTsKICAgIH0KCiAgICBwdWJs\naWMgdm9pZCByZW1vdmVMaWZlY3ljbGVMaXN0ZW5lcihPYmplY3QgbGlzdGVu\nZXIpIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAgICAg\nICBfYnJva2VyLnJlbW92ZUxpZmVjeWNsZUxpc3RlbmVyKGxpc3RlbmVyKTsK\nICAgIH0KCiAgICBwdWJsaWMgRW51bVNldDxDYWxsYmFja01vZGU+IGdldExp\nZmVjeWNsZUxpc3RlbmVyQ2FsbGJhY2tNb2RlcygpIHsKICAgICAgICByZXR1\ncm4gQ2FsbGJhY2tNb2RlLnRvRW51bVNldCgKICAgICAgICAgICAgX2Jyb2tl\nci5nZXRMaWZlY3ljbGVMaXN0ZW5lckNhbGxiYWNrTW9kZSgpKTsKICAgIH0K\nCiAgICBwdWJsaWMgdm9pZCBzZXRMaWZlY3ljbGVMaXN0ZW5lckNhbGxiYWNr\nTW9kZShDYWxsYmFja01vZGUgbW9kZSkgewogICAgICAgIGFzc2VydE5vdENs\nb3NlSW52b2tlZCgpOwogICAgICAgIF9icm9rZXIuc2V0TGlmZWN5Y2xlTGlz\ndGVuZXJDYWxsYmFja01vZGUoCiAgICAgICAgICAgIENhbGxiYWNrTW9kZS5m\ncm9tRW51bVNldChFbnVtU2V0Lm9mKG1vZGUpKSk7CiAgICB9CgogICAgcHVi\nbGljIHZvaWQgc2V0TGlmZWN5Y2xlTGlzdGVuZXJDYWxsYmFja01vZGUoRW51\nbVNldDxDYWxsYmFja01vZGU+IG1vZGVzKSB7CiAgICAgICAgYXNzZXJ0Tm90\nQ2xvc2VJbnZva2VkKCk7CiAgICAgICAgX2Jyb2tlci5zZXRMaWZlY3ljbGVM\naXN0ZW5lckNhbGxiYWNrTW9kZSgKICAgICAgICAgICAgQ2FsbGJhY2tNb2Rl\nLmZyb21FbnVtU2V0KG1vZGVzKSk7CiAgICB9CgogICAgcHVibGljIGludCBn\nZXRMaWZlY3ljbGVMaXN0ZW5lckNhbGxiYWNrTW9kZSgpIHsKICAgICAgICBy\nZXR1cm4gX2Jyb2tlci5nZXRMaWZlY3ljbGVMaXN0ZW5lckNhbGxiYWNrTW9k\nZSgpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldExpZmVjeWNsZUxpc3Rl\nbmVyQ2FsbGJhY2tNb2RlKGludCBjYWxsYmFja01vZGUpIHsKICAgICAgICBh\nc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICBfYnJva2VyLnNldExp\nZmVjeWNsZUxpc3RlbmVyQ2FsbGJhY2tNb2RlKGNhbGxiYWNrTW9kZSk7CiAg\nICB9CgogICAgQFN1cHByZXNzV2FybmluZ3MoInVuY2hlY2tlZCIpCiAgICBw\ndWJsaWMgPFQ+IFQgZ2V0UmVmZXJlbmNlKENsYXNzPFQ+IGNscywgT2JqZWN0\nIG9pZCkgewogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAg\nICAgIG9pZCA9IF9icm9rZXIubmV3T2JqZWN0SWQoY2xzLCBvaWQpOwogICAg\nICAgIHJldHVybiAoVCkgX2Jyb2tlci5maW5kKG9pZCwgZmFsc2UsIHRoaXMp\nOwogICAgfQoKICAgIEBTdXBwcmVzc1dhcm5pbmdzKCJ1bmNoZWNrZWQiKQog\nICAgcHVibGljIDxUPiBUIGZpbmQoQ2xhc3M8VD4gY2xzLCBPYmplY3Qgb2lk\nKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAg\naWYgKG9pZCA9PSBudWxsKQogICAgICAgIAlyZXR1cm4gbnVsbDsKICAgICAg\nICBvaWQgPSBfYnJva2VyLm5ld09iamVjdElkKGNscywgb2lkKTsKICAgICAg\nICByZXR1cm4gKFQpIF9icm9rZXIuZmluZChvaWQsIHRydWUsIHRoaXMpOwog\nICAgfQoKICAgIHB1YmxpYyA8VD4gVCBmaW5kKENsYXNzPFQ+IGNscywgT2Jq\nZWN0IG9pZCwgTG9ja01vZGVUeXBlIG1vZGUpIHsKICAgICAgICByZXR1cm4g\nZmluZChjbHMsIG9pZCwgbW9kZSwgbnVsbCk7CiAgICB9CgogICAgcHVibGlj\nIDxUPiBUIGZpbmQoQ2xhc3M8VD4gY2xzLCBPYmplY3Qgb2lkLCAKICAgICAg\nICBNYXA8U3RyaW5nLCBPYmplY3Q+IHByb3BlcnRpZXMpewogICAgICAgIHJl\ndHVybiBmaW5kKGNscywgb2lkLCBudWxsLCBwcm9wZXJ0aWVzKTsKICAgIH0K\nCiAgICBAU3VwcHJlc3NXYXJuaW5ncygidW5jaGVja2VkIikKICAgIHB1Ymxp\nYyA8VD4gVCBmaW5kKENsYXNzPFQ+IGNscywgT2JqZWN0IG9pZCwgTG9ja01v\nZGVUeXBlIG1vZGUsIE1hcDxTdHJpbmcsIE9iamVjdD4gcHJvcGVydGllcykg\newogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIHBy\nb3BlcnRpZXMgPSBjbG9uZVByb3BlcnRpZXMocHJvcGVydGllcyk7CiAgICAg\nICAgY29uZmlndXJlQ3VycmVudENhY2hlTW9kZXMocHVzaEZldGNoUGxhbigp\nLCBwcm9wZXJ0aWVzKTsKICAgICAgICBjb25maWd1cmVDdXJyZW50RmV0Y2hQ\nbGFuKGdldEZldGNoUGxhbigpLCBwcm9wZXJ0aWVzLCBtb2RlLCB0cnVlKTsK\nICAgICAgICB0cnkgewogICAgICAgICAgICBvaWQgPSBfYnJva2VyLm5ld09i\namVjdElkKGNscywgb2lkKTsKICAgICAgICAgICAgcmV0dXJuIChUKSBfYnJv\na2VyLmZpbmQob2lkLCB0cnVlLCB0aGlzKTsKICAgICAgICB9IGZpbmFsbHkg\newogICAgICAgICAgICBwb3BGZXRjaFBsYW4oKTsKICAgICAgICB9CiAgICB9\nCgogICAgQFN1cHByZXNzV2FybmluZ3MoInVuY2hlY2tlZCIpCiAgICBwdWJs\naWMgPFQ+IFRbXSBmaW5kQWxsKENsYXNzPFQ+IGNscywgT2JqZWN0Li4uIG9p\nZHMpIHsKICAgICAgICBpZiAob2lkcy5sZW5ndGggPT0gMCkKICAgICAgICAg\nICAgcmV0dXJuIChUW10pIEFycmF5Lm5ld0luc3RhbmNlKGNscywgMCk7CiAg\nICAgICAgQ29sbGVjdGlvbjxUPiByZXQgPSBmaW5kQWxsKGNscywgQXJyYXlz\nLmFzTGlzdChvaWRzKSk7CiAgICAgICAgcmV0dXJuIHJldC50b0FycmF5KChU\nW10pIEFycmF5Lm5ld0luc3RhbmNlKGNscywgcmV0LnNpemUoKSkpOwogICAg\nfQoKICAgIEBTdXBwcmVzc1dhcm5pbmdzKCJ1bmNoZWNrZWQiKQogICAgcHVi\nbGljIDxUPiBDb2xsZWN0aW9uPFQ+IGZpbmRBbGwoZmluYWwgQ2xhc3M8VD4g\nY2xzLCBDb2xsZWN0aW9uIG9pZHMpIHsKICAgICAgICBhc3NlcnROb3RDbG9z\nZUludm9rZWQoKTsKICAgICAgICBPYmplY3RbXSBvYmpzID0gX2Jyb2tlci5m\naW5kQWxsKG9pZHMsIHRydWUsIG5ldyBGaW5kQ2FsbGJhY2tzKCkgewogICAg\nICAgICAgICBwdWJsaWMgT2JqZWN0IHByb2Nlc3NBcmd1bWVudChPYmplY3Qg\nb2lkKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gX2Jyb2tlci5uZXdPYmpl\nY3RJZChjbHMsIG9pZCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHB1\nYmxpYyBPYmplY3QgcHJvY2Vzc1JldHVybihPYmplY3Qgb2lkLCBPcGVuSlBB\nU3RhdGVNYW5hZ2VyIHNtKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gRW50\naXR5TWFuYWdlckltcGwudGhpcy5wcm9jZXNzUmV0dXJuKG9pZCwgc20pOwog\nICAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuIChDb2xs\nZWN0aW9uPFQ+KSBBcnJheXMuYXNMaXN0KG9ianMpOwogICAgfQoKICAgIEBT\ndXBwcmVzc1dhcm5pbmdzKCJ1bmNoZWNrZWQiKQogICAgcHVibGljIDxUPiBU\nIGZpbmRDYWNoZWQoQ2xhc3M8VD4gY2xzLCBPYmplY3Qgb2lkKSB7CiAgICAg\nICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAgcmV0dXJuIChU\nKSBfYnJva2VyLmZpbmRDYWNoZWQoX2Jyb2tlci5uZXdPYmplY3RJZChjbHMs\nIG9pZCksIHRoaXMpOwogICAgfQoKICAgIHB1YmxpYyBDbGFzcyBnZXRPYmpl\nY3RJZENsYXNzKENsYXNzIGNscykgewogICAgICAgIGFzc2VydE5vdENsb3Nl\nSW52b2tlZCgpOwogICAgICAgIGlmIChjbHMgPT0gbnVsbCkKICAgICAgICAg\nICAgcmV0dXJuIG51bGw7CiAgICAgICAgcmV0dXJuIEpQQUZhY2FkZUhlbHBl\nci5mcm9tT3BlbkpQQU9iamVjdElkQ2xhc3MKICAgICAgICAgICAgICAgIChf\nYnJva2VyLmdldE9iamVjdElkVHlwZShjbHMpKTsKICAgIH0KCiAgICBwdWJs\naWMgT3BlbkpQQUVudGl0eVRyYW5zYWN0aW9uIGdldFRyYW5zYWN0aW9uKCkg\newogICAgICAgIGlmIChfYnJva2VyLmlzTWFuYWdlZCgpKQogICAgICAgICAg\nICB0aHJvdyBuZXcgSW52YWxpZFN0YXRlRXhjZXB0aW9uKF9sb2MuZ2V0KCJn\nZXQtbWFuYWdlZC10cmFucyIpLAogICAgICAgICAgICAgICAgbnVsbCwgbnVs\nbCwgZmFsc2UpOwogICAgICAgIHJldHVybiB0aGlzOwogICAgfQoKICAgIHB1\nYmxpYyB2b2lkIGpvaW5UcmFuc2FjdGlvbigpIHsKICAgICAgICBhc3NlcnRO\nb3RDbG9zZUludm9rZWQoKTsKICAgICAgICBpZiAoIV9icm9rZXIuc3luY1dp\ndGhNYW5hZ2VkVHJhbnNhY3Rpb24oKSkKICAgICAgICAgICAgdGhyb3cgbmV3\nIFRyYW5zYWN0aW9uUmVxdWlyZWRFeGNlcHRpb24oX2xvYy5nZXQKICAgICAg\nICAgICAgICAgICgibm8tbWFuYWdlZC10cmFucyIpLCBudWxsLCBudWxsLCBm\nYWxzZSk7CiAgICB9CgogICAgcHVibGljIHZvaWQgYmVnaW4oKSB7CiAgICAg\nICAgX2Jyb2tlci5iZWdpbigpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIGNv\nbW1pdCgpIHsKICAgICAgICB0cnkgewogICAgICAgICAgICBfYnJva2VyLmNv\nbW1pdCgpOwogICAgICAgIH0gY2F0Y2ggKFJvbGxiYWNrRXhjZXB0aW9uIGUp\nIHsKICAgICAgICAgICAgdGhyb3cgZTsKICAgICAgICB9IGNhdGNoIChJbGxl\nZ2FsU3RhdGVFeGNlcHRpb24gZSkgewogICAgICAgICAgICB0aHJvdyBlOwog\nICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgCS8vIFBl\nciBKUEEgMi4wIHNwZWMsIGlmIHRoZSBleGNlcHRpb24gd2FzIGR1ZSB0byBh\nIEpTUi0zMDMgCiAgICAgICAgICAgIC8vIGNvbnN0cmFpbnQgdmlvbGF0aW9u\nLCB0aGUgQ29uc3RyYWludFZpb2xhdGlvbkV4Y2VwdGlvbiBzaG91bGQgYmUg\nCiAgICAgICAgICAgIC8vIHRocm93bi4gIFNpbmNlIEpTUi0zMDMgaXMgb3B0\naW9uYWwsIHRoZSBjYXN0IHRvIFJ1bnRpbWVFeGNlcHRpb24gCiAgICAgICAg\nICAgIC8vIHByZXZlbnRzIHRoZSBpbnRyb2R1Y3Rpb24gb2YgYSBydW50aW1l\nIGRlcGVuZGVuY3kgb24gdGhlIEJWIEFQSS4KICAgICAgICAgICAgaWYgKFZh\nbGlkYXRpb25VdGlscy5pc0NvbnN0cmFpbnRWaW9sYXRpb25FeGNlcHRpb24o\nZSkpCiAgICAgICAgICAgICAgICB0aHJvdyAoUnVudGltZUV4Y2VwdGlvbill\nOwogICAgICAgICAgICAvLyBSb2xsYmFja0V4Y2VwdGlvbnMgYXJlIHNwZWNp\nYWwgYW5kIGFyZW4ndCBoYW5kbGVkIGJ5IHRoZQogICAgICAgICAgICAvLyBu\nb3JtYWwgZXhjZXB0aW9uIHRyYW5zbGF0b3IsIHNpbmNlIHRoZSBzcGVjIHNh\neXMgdGhleQogICAgICAgICAgICAvLyBzaG91bGQgYmUgdGhyb3duIHdoZW5l\ndmVyIHRoZSBjb21taXQgZmFpbHMgZm9yIGFueSByZWFzb24gYXQKICAgICAg\nICAgICAgLy8gYWxsLCB3aGVyYXMgdGhlIGV4Y2VwdGlvbiB0cmFuc2xhdG9y\nIGhhbmRsZXMgZXhjZXB0aW9ucyB0aGF0CiAgICAgICAgICAgIC8vIGFyZSBj\nYXVzZWQgZm9yIHNwZWNpZmljIHJlYXNvbnMgICAgICAgICAgICAKCiAgICAg\nICAgICAgIC8vIHBhc3MgYWxvbmcgdGhlIGZhaWxlZCBvYmplY3QgaWYgb25l\nIGlzIGF2YWlsYWJsZS4KICAgICAgICAgICAgT2JqZWN0IGZhaWxlZE9iamVj\ndCA9IG51bGw7CiAgICAgICAgICAgIGlmIChlIGluc3RhbmNlb2YgRXhjZXB0\naW9uSW5mbyl7CiAgICAgICAgICAgIAlmYWlsZWRPYmplY3QgPSAoKEV4Y2Vw\ndGlvbkluZm8pZSkuZ2V0RmFpbGVkT2JqZWN0KCk7ICAgICAgICAgICAgCQog\nICAgICAgICAgICB9CiAgICAgICAgICAgIAogICAgICAgICAgICB0aHJvdyBu\nZXcgUm9sbGJhY2tFeGNlcHRpb24oZSkuc2V0RmFpbGVkT2JqZWN0KGZhaWxl\nZE9iamVjdCk7CiAgICAgICAgfQogICAgfQoKICAgIHB1YmxpYyB2b2lkIHJv\nbGxiYWNrKCkgewogICAgICAgIF9icm9rZXIucm9sbGJhY2soKTsKICAgIH0K\nCiAgICBwdWJsaWMgdm9pZCBjb21taXRBbmRSZXN1bWUoKSB7CiAgICAgICAg\nX2Jyb2tlci5jb21taXRBbmRSZXN1bWUoKTsKICAgIH0KCiAgICBwdWJsaWMg\ndm9pZCByb2xsYmFja0FuZFJlc3VtZSgpIHsKICAgICAgICBfYnJva2VyLnJv\nbGxiYWNrQW5kUmVzdW1lKCk7CiAgICB9CgogICAgcHVibGljIFRocm93YWJs\nZSBnZXRSb2xsYmFja0NhdXNlKCkgewogICAgICAgIGlmICghaXNBY3RpdmUo\nKSkKICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxTdGF0ZUV4Y2VwdGlv\nbihfbG9jLmdldCgibm8tdHJhbnNhY3Rpb24iKQogICAgICAgICAgICAgICAg\nLmdldE1lc3NhZ2UoKSk7CgogICAgICAgIHJldHVybiBfYnJva2VyLmdldFJv\nbGxiYWNrQ2F1c2UoKTsKICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBnZXRS\nb2xsYmFja09ubHkoKSB7CiAgICAgICAgaWYgKCFpc0FjdGl2ZSgpKQogICAg\nICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbFN0YXRlRXhjZXB0aW9uKF9sb2Mu\nZ2V0KCJuby10cmFuc2FjdGlvbiIpCiAgICAgICAgICAgICAgICAuZ2V0TWVz\nc2FnZSgpKTsKCiAgICAgICAgcmV0dXJuIF9icm9rZXIuZ2V0Um9sbGJhY2tP\nbmx5KCk7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0Um9sbGJhY2tPbmx5\nKCkgewogICAgICAgIF9icm9rZXIuc2V0Um9sbGJhY2tPbmx5KCk7CiAgICB9\nCgogICAgcHVibGljIHZvaWQgc2V0Um9sbGJhY2tPbmx5KFRocm93YWJsZSBj\nYXVzZSkgewogICAgICAgIF9icm9rZXIuc2V0Um9sbGJhY2tPbmx5KGNhdXNl\nKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRTYXZlcG9pbnQoU3RyaW5n\nIG5hbWUpIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAg\nICAgICBfYnJva2VyLnNldFNhdmVwb2ludChuYW1lKTsKICAgIH0KCiAgICBw\ndWJsaWMgdm9pZCByb2xsYmFja1RvU2F2ZXBvaW50KCkgewogICAgICAgIGFz\nc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIF9icm9rZXIucm9sbGJh\nY2tUb1NhdmVwb2ludCgpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHJvbGxi\nYWNrVG9TYXZlcG9pbnQoU3RyaW5nIG5hbWUpIHsKICAgICAgICBhc3NlcnRO\nb3RDbG9zZUludm9rZWQoKTsKICAgICAgICBfYnJva2VyLnJvbGxiYWNrVG9T\nYXZlcG9pbnQobmFtZSk7CiAgICB9CgogICAgcHVibGljIHZvaWQgcmVsZWFz\nZVNhdmVwb2ludCgpIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQo\nKTsKICAgICAgICBfYnJva2VyLnJlbGVhc2VTYXZlcG9pbnQoKTsKICAgIH0K\nCiAgICBwdWJsaWMgdm9pZCByZWxlYXNlU2F2ZXBvaW50KFN0cmluZyBuYW1l\nKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAg\nX2Jyb2tlci5yZWxlYXNlU2F2ZXBvaW50KG5hbWUpOwogICAgfQoKICAgIHB1\nYmxpYyB2b2lkIGZsdXNoKCkgewogICAgICAgIGFzc2VydE5vdENsb3NlSW52\nb2tlZCgpOwogICAgICAgIF9icm9rZXIuYXNzZXJ0T3BlbigpOwogICAgICAg\nIF9icm9rZXIuYXNzZXJ0QWN0aXZlVHJhbnNhY3Rpb24oKTsKICAgICAgICBf\nYnJva2VyLmZsdXNoKCk7CiAgICB9CgogICAgcHVibGljIHZvaWQgcHJlRmx1\nc2goKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAg\nICAgX2Jyb2tlci5wcmVGbHVzaCgpOwogICAgfQoKICAgIHB1YmxpYyB2b2lk\nIHZhbGlkYXRlQ2hhbmdlcygpIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUlu\ndm9rZWQoKTsKICAgICAgICBfYnJva2VyLnZhbGlkYXRlQ2hhbmdlcygpOwog\nICAgfQoKICAgIHB1YmxpYyBib29sZWFuIGlzQWN0aXZlKCkgewogICAgICAg\nIHJldHVybiBpc09wZW4oKSAmJiBfYnJva2VyLmlzQWN0aXZlKCk7CiAgICB9\nCgogICAgcHVibGljIGJvb2xlYW4gaXNTdG9yZUFjdGl2ZSgpIHsKICAgICAg\nICByZXR1cm4gX2Jyb2tlci5pc1N0b3JlQWN0aXZlKCk7CiAgICB9CgogICAg\ncHVibGljIHZvaWQgYmVnaW5TdG9yZSgpIHsKICAgICAgICBfYnJva2VyLmJl\nZ2luU3RvcmUoKTsKICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBjb250YWlu\ncyhPYmplY3QgZW50aXR5KSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZv\na2VkKCk7CiAgICAgICAgaWYgKGVudGl0eSA9PSBudWxsKQogICAgICAgICAg\nICByZXR1cm4gZmFsc2U7CiAgICAgICAgT3BlbkpQQVN0YXRlTWFuYWdlciBz\nbSA9IF9icm9rZXIuZ2V0U3RhdGVNYW5hZ2VyKGVudGl0eSk7CiAgICAgICAg\naWYgKHNtID09IG51bGwKICAgICAgICAgICAgJiYgIUltcGxIZWxwZXIuaXNN\nYW5hZ2VkVHlwZShnZXRDb25maWd1cmF0aW9uKCksIGVudGl0eS5nZXRDbGFz\ncygpKSkKICAgICAgICAgICAgdGhyb3cgbmV3IEFyZ3VtZW50RXhjZXB0aW9u\nKF9sb2MuZ2V0KCJub3QtZW50aXR5IiwKICAgICAgICAgICAgICAgIGVudGl0\neS5nZXRDbGFzcygpKSwgbnVsbCwgbnVsbCwgdHJ1ZSk7CiAgICAgICAgcmV0\ndXJuIHNtICE9IG51bGwgJiYgIXNtLmlzRGVsZXRlZCgpOwogICAgfQoKICAg\nIHB1YmxpYyBib29sZWFuIGNvbnRhaW5zQWxsKE9iamVjdC4uLiBlbnRpdGll\ncykgewogICAgICAgIGZvciAoT2JqZWN0IGVudGl0eSA6IGVudGl0aWVzKQog\nICAgICAgICAgICBpZiAoIWNvbnRhaW5zKGVudGl0eSkpCiAgICAgICAgICAg\nICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9\nCgogICAgcHVibGljIGJvb2xlYW4gY29udGFpbnNBbGwoQ29sbGVjdGlvbiBl\nbnRpdGllcykgewogICAgICAgIGZvciAoT2JqZWN0IGVudGl0eSA6IGVudGl0\naWVzKQogICAgICAgICAgICBpZiAoIWNvbnRhaW5zKGVudGl0eSkpCiAgICAg\nICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgcmV0dXJuIHRydWU7\nCiAgICB9CgogICAgcHVibGljIHZvaWQgcGVyc2lzdChPYmplY3QgZW50aXR5\nKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAg\nX2Jyb2tlci5wZXJzaXN0KGVudGl0eSwgdGhpcyk7CiAgICB9CgogICAgcHVi\nbGljIHZvaWQgcGVyc2lzdEFsbChPYmplY3QuLi4gZW50aXRpZXMpIHsKICAg\nICAgICBwZXJzaXN0QWxsKEFycmF5cy5hc0xpc3QoZW50aXRpZXMpKTsKICAg\nIH0KCiAgICBwdWJsaWMgdm9pZCBwZXJzaXN0QWxsKENvbGxlY3Rpb24gZW50\naXRpZXMpIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAg\nICAgICBfYnJva2VyLnBlcnNpc3RBbGwoZW50aXRpZXMsIHRoaXMpOwogICAg\nfQoKICAgIHB1YmxpYyB2b2lkIHJlbW92ZShPYmplY3QgZW50aXR5KSB7CiAg\nICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAgX2Jyb2tl\nci5kZWxldGUoZW50aXR5LCB0aGlzKTsKICAgIH0KCiAgICBwdWJsaWMgdm9p\nZCByZW1vdmVBbGwoT2JqZWN0Li4uIGVudGl0aWVzKSB7CiAgICAgICAgcmVt\nb3ZlQWxsKEFycmF5cy5hc0xpc3QoZW50aXRpZXMpKTsKICAgIH0KCiAgICBw\ndWJsaWMgdm9pZCByZW1vdmVBbGwoQ29sbGVjdGlvbiBlbnRpdGllcykgewog\nICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIF9icm9r\nZXIuZGVsZXRlQWxsKGVudGl0aWVzLCB0aGlzKTsKICAgIH0KCiAgICBwdWJs\naWMgdm9pZCByZWxlYXNlKE9iamVjdCBlbnRpdHkpIHsKICAgICAgICBhc3Nl\ncnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICBfYnJva2VyLnJlbGVhc2Uo\nZW50aXR5LCB0aGlzKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCByZWxlYXNl\nQWxsKENvbGxlY3Rpb24gZW50aXRpZXMpIHsKICAgICAgICBhc3NlcnROb3RD\nbG9zZUludm9rZWQoKTsKICAgICAgICBfYnJva2VyLnJlbGVhc2VBbGwoZW50\naXRpZXMsIHRoaXMpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHJlbGVhc2VB\nbGwoT2JqZWN0Li4uIGVudGl0aWVzKSB7CiAgICAgICAgcmVsZWFzZUFsbChB\ncnJheXMuYXNMaXN0KGVudGl0aWVzKSk7CiAgICB9CgogICAgcHVibGljIHZv\naWQgcmVmcmVzaChPYmplY3QgZW50aXR5KSB7CiAgICAgICAgcmVmcmVzaChl\nbnRpdHksIG51bGwsIG51bGwpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHJl\nZnJlc2goT2JqZWN0IGVudGl0eSwgTG9ja01vZGVUeXBlIG1vZGUpIHsKICAg\nICAgICByZWZyZXNoKGVudGl0eSwgbW9kZSwgbnVsbCk7CiAgICB9CgogICAg\ncHVibGljIHZvaWQgcmVmcmVzaChPYmplY3QgZW50aXR5LCBNYXA8U3RyaW5n\nLCBPYmplY3Q+IHByb3BlcnRpZXMpIHsKICAgICAgICByZWZyZXNoKGVudGl0\neSwgbnVsbCwgcHJvcGVydGllcyk7CiAgICB9CgogICAgcHVibGljIHZvaWQg\ncmVmcmVzaChPYmplY3QgZW50aXR5LCBMb2NrTW9kZVR5cGUgbW9kZSwgTWFw\nPFN0cmluZywgT2JqZWN0PiBwcm9wZXJ0aWVzKSB7CiAgICAgICAgYXNzZXJ0\nTm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAgYXNzZXJ0VmFsaWRBdHRjaGVk\nRW50aXR5KFJFRlJFU0gsIGVudGl0eSk7CgogICAgICAgIF9icm9rZXIuYXNz\nZXJ0V3JpdGVPcGVyYXRpb24oKTsKICAgICAgICBjb25maWd1cmVDdXJyZW50\nRmV0Y2hQbGFuKHB1c2hGZXRjaFBsYW4oKSwgcHJvcGVydGllcywgbW9kZSwg\ndHJ1ZSk7CiAgICAgICAgRGF0YUNhY2hlUmV0cmlldmVNb2RlIHJtb2RlID0g\nZ2V0RmV0Y2hQbGFuKCkuZ2V0Q2FjaGVSZXRyaWV2ZU1vZGUoKTsKICAgICAg\nICBpZiAoRGF0YUNhY2hlUmV0cmlldmVNb2RlLlVTRS5lcXVhbHMocm1vZGUp\nIHx8IHJtb2RlID09IG51bGwpIHsKICAgICAgICAgICAgZ2V0RmV0Y2hQbGFu\nKCkuc2V0Q2FjaGVSZXRyaWV2ZU1vZGUoRGF0YUNhY2hlUmV0cmlldmVNb2Rl\nLkJZUEFTUyk7CiAgICAgICAgICAgIGlmIChybW9kZSAhPSBudWxsKSB7CiAg\nICAgICAgICAgICAgICBMb2cgbG9nID0gX2Jyb2tlci5nZXRDb25maWd1cmF0\naW9uKCkuZ2V0Q29uZmlndXJhdGlvbkxvZygpOwogICAgICAgICAgICAgICAg\nbG9nLndhcm4oX2xvYy5nZXQoImNhY2hlLXJldHJpZXZlLW92ZXJyaWRlIiwg\nRXhjZXB0aW9ucy50b1N0cmluZyhlbnRpdHkpKSk7CiAgICAgICAgICAgIH0K\nICAgICAgICB9CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgX2Jyb2tlci5y\nZWZyZXNoKGVudGl0eSwgdGhpcyk7CiAgICAgICAgfSBmaW5hbGx5IHsKICAg\nICAgICAgICAgcG9wRmV0Y2hQbGFuKCk7CiAgICAgICAgfQogICAgfQoKICAg\nIHB1YmxpYyB2b2lkIHJlZnJlc2hBbGwoKSB7CiAgICAgICAgYXNzZXJ0Tm90\nQ2xvc2VJbnZva2VkKCk7CiAgICAgICAgX2Jyb2tlci5hc3NlcnRXcml0ZU9w\nZXJhdGlvbigpOwogICAgICAgIF9icm9rZXIucmVmcmVzaEFsbChfYnJva2Vy\nLmdldFRyYW5zYWN0aW9uYWxPYmplY3RzKCksIHRoaXMpOwogICAgfQoKICAg\nIHB1YmxpYyB2b2lkIHJlZnJlc2hBbGwoQ29sbGVjdGlvbiBlbnRpdGllcykg\newogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIF9i\ncm9rZXIuYXNzZXJ0V3JpdGVPcGVyYXRpb24oKTsKICAgICAgICBfYnJva2Vy\nLnJlZnJlc2hBbGwoZW50aXRpZXMsIHRoaXMpOwogICAgfQoKICAgIHB1Ymxp\nYyB2b2lkIHJlZnJlc2hBbGwoT2JqZWN0Li4uIGVudGl0aWVzKSB7CiAgICAg\nICAgcmVmcmVzaEFsbChBcnJheXMuYXNMaXN0KGVudGl0aWVzKSk7CiAgICB9\nCgogICAgcHVibGljIHZvaWQgcmV0cmlldmUoT2JqZWN0IGVudGl0eSkgewog\nICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIF9icm9r\nZXIucmV0cmlldmUoZW50aXR5LCB0cnVlLCB0aGlzKTsKICAgIH0KCiAgICBw\ndWJsaWMgdm9pZCByZXRyaWV2ZUFsbChDb2xsZWN0aW9uIGVudGl0aWVzKSB7\nCiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAgX2Jy\nb2tlci5yZXRyaWV2ZUFsbChlbnRpdGllcywgdHJ1ZSwgdGhpcyk7CiAgICB9\nCgogICAgcHVibGljIHZvaWQgcmV0cmlldmVBbGwoT2JqZWN0Li4uIGVudGl0\naWVzKSB7CiAgICAgICAgcmV0cmlldmVBbGwoQXJyYXlzLmFzTGlzdChlbnRp\ndGllcykpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIGV2aWN0KE9iamVjdCBl\nbnRpdHkpIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAg\nICAgICBfYnJva2VyLmV2aWN0KGVudGl0eSwgdGhpcyk7CiAgICB9CgogICAg\ncHVibGljIHZvaWQgZXZpY3RBbGwoQ29sbGVjdGlvbiBlbnRpdGllcykgewog\nICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIF9icm9r\nZXIuZXZpY3RBbGwoZW50aXRpZXMsIHRoaXMpOwogICAgfQoKICAgIHB1Ymxp\nYyB2b2lkIGV2aWN0QWxsKE9iamVjdC4uLiBlbnRpdGllcykgewogICAgICAg\nIGV2aWN0QWxsKEFycmF5cy5hc0xpc3QoZW50aXRpZXMpKTsKICAgIH0KCiAg\nICBwdWJsaWMgdm9pZCBldmljdEFsbCgpIHsKICAgICAgICBhc3NlcnROb3RD\nbG9zZUludm9rZWQoKTsKICAgICAgICBfYnJva2VyLmV2aWN0QWxsKHRoaXMp\nOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIGV2aWN0QWxsKENsYXNzIGNscykg\newogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIF9i\ncm9rZXIuZXZpY3RBbGwoX2Jyb2tlci5uZXdFeHRlbnQoY2xzLCB0cnVlKSwg\ndGhpcyk7CiAgICB9CgogICAgcHVibGljIHZvaWQgZXZpY3RBbGwoRXh0ZW50\nIGV4dGVudCkgewogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwog\nICAgICAgIF9icm9rZXIuZXZpY3RBbGwoKChFeHRlbnRJbXBsKSBleHRlbnQp\nLmdldERlbGVnYXRlKCksIHRoaXMpOwogICAgfQoKICAgIEBTdXBwcmVzc1dh\ncm5pbmdzKCJ1bmNoZWNrZWQiKQogICAgcHVibGljIDxUPiBUIGRldGFjaENv\ncHkoVCBlbnRpdHkpIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQo\nKTsKICAgICAgICBDb21wYXRpYmlsaXR5IGNvbXBhdCA9IHRoaXMuZ2V0Q29u\nZmlndXJhdGlvbigpLgogICAgICAgICAgICBnZXRDb21wYXRpYmlsaXR5SW5z\ndGFuY2UoKTsKICAgICAgICBib29sZWFuIGNvcHlPbkRldGFjaCA9IGNvbXBh\ndC5nZXRDb3B5T25EZXRhY2goKTsKICAgICAgICBib29sZWFuIGNhc2NhZGVX\naXRoRGV0YWNoID0gY29tcGF0LmdldENhc2NhZGVXaXRoRGV0YWNoKCk7CiAg\nICAgICAgLy8gU2V0IGNvbXBhdGliaWxpdHkgb3B0aW9ucyB0byBnZXQgMS54\nIGRldGFjaCBiZWhhdmlvcgogICAgICAgIGNvbXBhdC5zZXRDb3B5T25EZXRh\nY2godHJ1ZSk7CiAgICAgICAgY29tcGF0LnNldENhc2NhZGVXaXRoRGV0YWNo\nKHRydWUpOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIFQgdCA9IChUKV9i\ncm9rZXIuZGV0YWNoKGVudGl0eSwgdGhpcyk7CiAgICAgICAgICAgIHJldHVy\nbiB0OwogICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgIC8vIFJlc2V0\nIGNvbXBhdGliaWxpdHkgb3B0aW9ucwogICAgICAgICAgICBjb21wYXQuc2V0\nQ29weU9uRGV0YWNoKGNvcHlPbkRldGFjaCk7CiAgICAgICAgICAgIGNvbXBh\ndC5zZXRDYXNjYWRlV2l0aERldGFjaChjYXNjYWRlV2l0aERldGFjaCk7CiAg\nICAgICAgfSAgICAgICAgCiAgICB9CgogICAgcHVibGljIE9iamVjdFtdIGRl\ndGFjaEFsbChPYmplY3QuLi4gZW50aXRpZXMpIHsKICAgICAgICBhc3NlcnRO\nb3RDbG9zZUludm9rZWQoKTsKICAgICAgICByZXR1cm4gX2Jyb2tlci5kZXRh\nY2hBbGwoQXJyYXlzLmFzTGlzdChlbnRpdGllcyksIHRoaXMpOwogICAgfQoK\nICAgIHB1YmxpYyBDb2xsZWN0aW9uIGRldGFjaEFsbChDb2xsZWN0aW9uIGVu\ndGl0aWVzKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAg\nICAgICAgcmV0dXJuIEFycmF5cy5hc0xpc3QoX2Jyb2tlci5kZXRhY2hBbGwo\nZW50aXRpZXMsIHRoaXMpKTsKICAgIH0KCiAgICBAU3VwcHJlc3NXYXJuaW5n\ncygidW5jaGVja2VkIikKICAgIHB1YmxpYyA8VD4gVCBtZXJnZShUIGVudGl0\neSkgewogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAgICAg\nIHJldHVybiAoVCkgX2Jyb2tlci5hdHRhY2goZW50aXR5LCB0cnVlLCB0aGlz\nKTsKICAgIH0KCiAgICBwdWJsaWMgT2JqZWN0W10gbWVyZ2VBbGwoT2JqZWN0\nLi4uIGVudGl0aWVzKSB7CiAgICAgICAgaWYgKGVudGl0aWVzLmxlbmd0aCA9\nPSAwKQogICAgICAgICAgICByZXR1cm4gRU1QVFlfT0JKRUNUUzsKICAgICAg\nICByZXR1cm4gbWVyZ2VBbGwoQXJyYXlzLmFzTGlzdChlbnRpdGllcykpLnRv\nQXJyYXkoKTsKICAgIH0KCiAgICBwdWJsaWMgQ29sbGVjdGlvbiBtZXJnZUFs\nbChDb2xsZWN0aW9uIGVudGl0aWVzKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xv\nc2VJbnZva2VkKCk7CiAgICAgICAgcmV0dXJuIEFycmF5cy5hc0xpc3QoX2Jy\nb2tlci5hdHRhY2hBbGwoZW50aXRpZXMsIHRydWUsIHRoaXMpKTsKICAgIH0K\nCiAgICBwdWJsaWMgdm9pZCB0cmFuc2FjdGlvbmFsKE9iamVjdCBlbnRpdHks\nIGJvb2xlYW4gdXBkYXRlVmVyc2lvbikgewogICAgICAgIGFzc2VydE5vdENs\nb3NlSW52b2tlZCgpOwogICAgICAgIF9icm9rZXIudHJhbnNhY3Rpb25hbChl\nbnRpdHksIHVwZGF0ZVZlcnNpb24sIHRoaXMpOwogICAgfQoKICAgIHB1Ymxp\nYyB2b2lkIHRyYW5zYWN0aW9uYWxBbGwoQ29sbGVjdGlvbiBvYmpzLCBib29s\nZWFuIHVwZGF0ZVZlcnNpb24pIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUlu\ndm9rZWQoKTsKICAgICAgICBfYnJva2VyLnRyYW5zYWN0aW9uYWxBbGwob2Jq\ncywgdXBkYXRlVmVyc2lvbiwgdGhpcyk7CiAgICB9CgogICAgcHVibGljIHZv\naWQgdHJhbnNhY3Rpb25hbEFsbChPYmplY3RbXSBvYmpzLCBib29sZWFuIHVw\nZGF0ZVZlcnNpb24pIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQo\nKTsKICAgICAgICBfYnJva2VyLnRyYW5zYWN0aW9uYWxBbGwoQXJyYXlzLmFz\nTGlzdChvYmpzKSwgdXBkYXRlVmVyc2lvbiwgdGhpcyk7CiAgICB9CgogICAg\ncHVibGljIHZvaWQgbm9udHJhbnNhY3Rpb25hbChPYmplY3QgZW50aXR5KSB7\nCiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAgX2Jy\nb2tlci5ub250cmFuc2FjdGlvbmFsKGVudGl0eSwgdGhpcyk7CiAgICB9Cgog\nICAgcHVibGljIHZvaWQgbm9udHJhbnNhY3Rpb25hbEFsbChDb2xsZWN0aW9u\nIG9ianMpIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAg\nICAgICBfYnJva2VyLm5vbnRyYW5zYWN0aW9uYWxBbGwob2JqcywgdGhpcyk7\nCiAgICB9CgogICAgcHVibGljIHZvaWQgbm9udHJhbnNhY3Rpb25hbEFsbChP\nYmplY3RbXSBvYmpzKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2Vk\nKCk7CiAgICAgICAgX2Jyb2tlci5ub250cmFuc2FjdGlvbmFsQWxsKEFycmF5\ncy5hc0xpc3Qob2JqcyksIHRoaXMpOwogICAgfQoKICAgIHB1YmxpYyBHZW5l\ncmF0b3IgZ2V0TmFtZWRHZW5lcmF0b3IoU3RyaW5nIG5hbWUpIHsKICAgICAg\nICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICB0cnkgewogICAg\nICAgICAgICBTZXF1ZW5jZU1ldGFEYXRhIG1ldGEgPSBfYnJva2VyLmdldENv\nbmZpZ3VyYXRpb24oKS4KICAgICAgICAgICAgICAgIGdldE1ldGFEYXRhUmVw\nb3NpdG9yeUluc3RhbmNlKCkuZ2V0U2VxdWVuY2VNZXRhRGF0YShuYW1lLAog\nICAgICAgICAgICAgICAgX2Jyb2tlci5nZXRDbGFzc0xvYWRlcigpLCB0cnVl\nKTsKICAgICAgICAgICAgU2VxIHNlcSA9IG1ldGEuZ2V0SW5zdGFuY2UoX2Jy\nb2tlci5nZXRDbGFzc0xvYWRlcigpKTsKICAgICAgICAgICAgcmV0dXJuIG5l\ndyBHZW5lcmF0b3JJbXBsKHNlcSwgbmFtZSwgX2Jyb2tlciwgbnVsbCk7CiAg\nICAgICAgfSBjYXRjaCAoUnVudGltZUV4Y2VwdGlvbiByZSkgewogICAgICAg\nICAgICB0aHJvdyBQZXJzaXN0ZW5jZUV4Y2VwdGlvbnMudG9QZXJzaXN0ZW5j\nZUV4Y2VwdGlvbihyZSk7CiAgICAgICAgfQogICAgfQoKICAgIHB1YmxpYyBH\nZW5lcmF0b3IgZ2V0SWRHZW5lcmF0b3IoQ2xhc3MgZm9yQ2xhc3MpIHsKICAg\nICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICB0cnkgewog\nICAgICAgICAgICBDbGFzc01ldGFEYXRhIG1ldGEgPSBfYnJva2VyLmdldENv\nbmZpZ3VyYXRpb24oKS4KICAgICAgICAgICAgICAgIGdldE1ldGFEYXRhUmVw\nb3NpdG9yeUluc3RhbmNlKCkuZ2V0TWV0YURhdGEoZm9yQ2xhc3MsCiAgICAg\nICAgICAgICAgICBfYnJva2VyLmdldENsYXNzTG9hZGVyKCksIHRydWUpOwog\nICAgICAgICAgICBTZXEgc2VxID0gX2Jyb2tlci5nZXRJZGVudGl0eVNlcXVl\nbmNlKG1ldGEpOwogICAgICAgICAgICByZXR1cm4gKHNlcSA9PSBudWxsKSA/\nIG51bGwgOiBuZXcgR2VuZXJhdG9ySW1wbChzZXEsIG51bGwsIF9icm9rZXIs\nCiAgICAgICAgICAgICAgICBtZXRhKTsKICAgICAgICB9IGNhdGNoIChFeGNl\ncHRpb24gZSkgewogICAgICAgICAgICB0aHJvdyBQZXJzaXN0ZW5jZUV4Y2Vw\ndGlvbnMudG9QZXJzaXN0ZW5jZUV4Y2VwdGlvbihlKTsKICAgICAgICB9CiAg\nICB9CgogICAgcHVibGljIEdlbmVyYXRvciBnZXRGaWVsZEdlbmVyYXRvcihD\nbGFzcyBmb3JDbGFzcywgU3RyaW5nIGZpZWxkTmFtZSkgewogICAgICAgIGFz\nc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIHRyeSB7CiAgICAgICAg\nICAgIENsYXNzTWV0YURhdGEgbWV0YSA9IF9icm9rZXIuZ2V0Q29uZmlndXJh\ndGlvbigpLgogICAgICAgICAgICAgICAgZ2V0TWV0YURhdGFSZXBvc2l0b3J5\nSW5zdGFuY2UoKS5nZXRNZXRhRGF0YShmb3JDbGFzcywKICAgICAgICAgICAg\nICAgIF9icm9rZXIuZ2V0Q2xhc3NMb2FkZXIoKSwgdHJ1ZSk7CiAgICAgICAg\nICAgIEZpZWxkTWV0YURhdGEgZm1kID0gbWV0YS5nZXRGaWVsZChmaWVsZE5h\nbWUpOwogICAgICAgICAgICBpZiAoZm1kID09IG51bGwpCiAgICAgICAgICAg\nICAgICB0aHJvdyBuZXcgQXJndW1lbnRFeGNlcHRpb24oX2xvYy5nZXQoIm5v\nLW5hbWVkLWZpZWxkIiwKICAgICAgICAgICAgICAgICAgICBmb3JDbGFzcywg\nZmllbGROYW1lKSwgbnVsbCwgbnVsbCwgZmFsc2UpOwoKICAgICAgICAgICAg\nU2VxIHNlcSA9IF9icm9rZXIuZ2V0VmFsdWVTZXF1ZW5jZShmbWQpOwogICAg\nICAgICAgICByZXR1cm4gKHNlcSA9PSBudWxsKSA/IG51bGwgOiBuZXcgR2Vu\nZXJhdG9ySW1wbChzZXEsIG51bGwsIF9icm9rZXIsCiAgICAgICAgICAgICAg\nICBtZXRhKTsKICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkgewogICAg\nICAgICAgICB0aHJvdyBQZXJzaXN0ZW5jZUV4Y2VwdGlvbnMudG9QZXJzaXN0\nZW5jZUV4Y2VwdGlvbihlKTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGlj\nIDxUPiBFeHRlbnQ8VD4gY3JlYXRlRXh0ZW50KENsYXNzPFQ+IGNscywgYm9v\nbGVhbiBzdWJjbGFzc2VzKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZv\na2VkKCk7CiAgICAgICAgcmV0dXJuIG5ldyBFeHRlbnRJbXBsPFQ+KHRoaXMs\nIF9icm9rZXIubmV3RXh0ZW50KGNscywgc3ViY2xhc3NlcykpOwogICAgfQoK\nICAgIEBTdXBwcmVzc1dhcm5pbmdzKCJ1bmNoZWNrZWQiKQogICAgcHVibGlj\nIDxUPiBUeXBlZFF1ZXJ5PFQ+IGNyZWF0ZVF1ZXJ5KFN0cmluZyBxdWVyeSwg\nQ2xhc3M8VD4gcmVzdWx0Q2xhc3MpIHsKICAgICAgICByZXR1cm4gY3JlYXRl\nUXVlcnkocXVlcnkpLnNldFJlc3VsdENsYXNzKHJlc3VsdENsYXNzKTsKICAg\nIH0KICAgIAogICAgcHVibGljIE9wZW5KUEFRdWVyeSBjcmVhdGVRdWVyeShT\ndHJpbmcgcXVlcnkpIHsKICAgICAgICByZXR1cm4gY3JlYXRlUXVlcnkoSlBR\nTFBhcnNlci5MQU5HX0pQUUwsIHF1ZXJ5KTsKICAgIH0KCiAgICBwdWJsaWMg\nT3BlbkpQQVF1ZXJ5IGNyZWF0ZVF1ZXJ5KFN0cmluZyBsYW5ndWFnZSwgU3Ry\naW5nIHF1ZXJ5KSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7\nCiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgU3RyaW5nIHFpZCA9IHF1ZXJ5\nOwogICAgICAgICAgICBQcmVwYXJlZFF1ZXJ5IHBxID0gSlBRTFBhcnNlci5M\nQU5HX0pQUUwuZXF1YWxzKGxhbmd1YWdlKQogICAgICAgICAgICAgICAgPyBn\nZXRQcmVwYXJlZFF1ZXJ5KHFpZCkgOiBudWxsOwogICAgICAgICAgICBvcmcu\nYXBhY2hlLm9wZW5qcGEua2VybmVsLlF1ZXJ5IHEgPSAocHEgPT0gbnVsbCB8\nfCAhcHEuaXNJbml0aWFsaXplZCgpKQogICAgICAgICAgICAgICAgPyBfYnJv\na2VyLm5ld1F1ZXJ5KGxhbmd1YWdlLCBxdWVyeSkKICAgICAgICAgICAgICAg\nIDogX2Jyb2tlci5uZXdRdWVyeShwcS5nZXRMYW5ndWFnZSgpLCBwcSk7CiAg\nICAgICAgICAgIC8vIGhhdmUgdG8gdmFsaWRhdGUgSlBRTCBhY2NvcmRpbmcg\ndG8gc3BlYwogICAgICAgICAgICBpZiAocHEgPT0gbnVsbCAmJiBKUFFMUGFy\nc2VyLkxBTkdfSlBRTC5lcXVhbHMobGFuZ3VhZ2UpKQogICAgICAgICAgICAg\nICAgcS5jb21waWxlKCk7IAogICAgICAgICAgICBpZiAocHEgIT0gbnVsbCkg\newogICAgICAgICAgICAgICAgcHEuc2V0SW50byhxKTsKICAgICAgICAgICAg\nfQogICAgICAgICAgICByZXR1cm4gbmV3UXVlcnlJbXBsKHEpLnNldElkKHFp\nZCk7CiAgICAgICAgfSBjYXRjaCAoUnVudGltZUV4Y2VwdGlvbiByZSkgewog\nICAgICAgICAgICB0aHJvdyBQZXJzaXN0ZW5jZUV4Y2VwdGlvbnMudG9QZXJz\naXN0ZW5jZUV4Y2VwdGlvbihyZSk7CiAgICAgICAgfQogICAgfQogICAgCiAg\nICBwdWJsaWMgT3BlbkpQQVF1ZXJ5IGNyZWF0ZVF1ZXJ5KFF1ZXJ5IHF1ZXJ5\nKSB7CiAgICAgICAgaWYgKHF1ZXJ5ID09IG51bGwpCiAgICAgICAgICAgIHJl\ndHVybiBjcmVhdGVRdWVyeSgoU3RyaW5nKSBudWxsKTsKICAgICAgICBhc3Nl\ncnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICBvcmcuYXBhY2hlLm9wZW5q\ncGEua2VybmVsLlF1ZXJ5IHEgPSAoKFF1ZXJ5SW1wbCkgcXVlcnkpLmdldERl\nbGVnYXRlKCk7CiAgICAgICAgcmV0dXJuIG5ld1F1ZXJ5SW1wbChfYnJva2Vy\nLm5ld1F1ZXJ5KHEuZ2V0TGFuZ3VhZ2UoKSwgcSkpOwogICAgfQogICAgCiAg\nICBAU3VwcHJlc3NXYXJuaW5ncygidW5jaGVja2VkIikKICAgIHB1YmxpYyA8\nVD4gVHlwZWRRdWVyeTxUPiBjcmVhdGVOYW1lZFF1ZXJ5KFN0cmluZyBuYW1l\nLCBDbGFzczxUPiByZXN1bHRDbGFzcykgewogICAgICAgIHJldHVybiBjcmVh\ndGVOYW1lZFF1ZXJ5KG5hbWUpLnNldFJlc3VsdENsYXNzKHJlc3VsdENsYXNz\nKTsKICAgIH0KCiAgICBwdWJsaWMgT3BlbkpQQVF1ZXJ5IGNyZWF0ZU5hbWVk\nUXVlcnkoU3RyaW5nIG5hbWUpIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUlu\ndm9rZWQoKTsKICAgICAgICBfYnJva2VyLmFzc2VydE9wZW4oKTsKICAgICAg\nICB0cnkgewogICAgICAgICAgICBRdWVyeU1ldGFEYXRhIG1ldGEgPSBfYnJv\na2VyLmdldENvbmZpZ3VyYXRpb24oKS4KICAgICAgICAgICAgICAgIGdldE1l\ndGFEYXRhUmVwb3NpdG9yeUluc3RhbmNlKCkuZ2V0UXVlcnlNZXRhRGF0YShu\ndWxsLCBuYW1lLAogICAgICAgICAgICAgICAgX2Jyb2tlci5nZXRDbGFzc0xv\nYWRlcigpLCB0cnVlKTsKICAgICAgICAgICAgU3RyaW5nIHFpZCA9IG1ldGEu\nZ2V0UXVlcnlTdHJpbmcoKTsKICAgICAgICAgICAgCiAgICAgICAgICAgIFBy\nZXBhcmVkUXVlcnkgcHEgPSBKUFFMUGFyc2VyLkxBTkdfSlBRTC5lcXVhbHMo\nbWV0YS5nZXRMYW5ndWFnZSgpKQogICAgICAgICAgICAgICAgPyBnZXRQcmVw\nYXJlZFF1ZXJ5KHFpZCkgOiBudWxsOwogICAgICAgICAgICBvcmcuYXBhY2hl\nLm9wZW5qcGEua2VybmVsLlF1ZXJ5IGRlbCA9IChwcSA9PSBudWxsIHx8ICFw\ncS5pc0luaXRpYWxpemVkKCkpCiAgICAgICAgICAgICAgICA/IF9icm9rZXIu\nbmV3UXVlcnkobWV0YS5nZXRMYW5ndWFnZSgpLCBtZXRhLmdldFF1ZXJ5U3Ry\naW5nKCkpCiAgICAgICAgICAgICAgICA6IF9icm9rZXIubmV3UXVlcnkocHEu\nZ2V0TGFuZ3VhZ2UoKSwgcHEpOwogICAgICAgICAgICAKICAgICAgICAgICAg\naWYgKHBxICE9IG51bGwpIHsKICAgICAgICAgICAgICAgIHBxLnNldEludG8o\nZGVsKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIG1l\ndGEuc2V0SW50byhkZWwpOwogICAgICAgICAgICAgICAgZGVsLmNvbXBpbGUo\nKTsKICAgICAgICAgICAgfQogICAgICAgICAgICAKICAgICAgICAgICAgT3Bl\nbkpQQVF1ZXJ5IHEgPSBuZXdRdWVyeUltcGwoZGVsKS5zZXRJZChxaWQpOwog\nICAgICAgICAgICBTdHJpbmdbXSBoaW50cyA9IG1ldGEuZ2V0SGludEtleXMo\nKTsKICAgICAgICAgICAgT2JqZWN0W10gdmFsdWVzID0gbWV0YS5nZXRIaW50\nVmFsdWVzKCk7CiAgICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgaGlu\ndHMubGVuZ3RoOyBpKyspCiAgICAgICAgICAgICAgICBxLnNldEhpbnQoaGlu\ndHNbaV0sIHZhbHVlc1tpXSk7CiAgICAgICAgICAgIHJldHVybiBxOwogICAg\nICAgIH0gY2F0Y2ggKFJ1bnRpbWVFeGNlcHRpb24gcmUpIHsKICAgICAgICAg\nICAgdGhyb3cgUGVyc2lzdGVuY2VFeGNlcHRpb25zLnRvUGVyc2lzdGVuY2VF\neGNlcHRpb24ocmUpOwogICAgICAgIH0KICAgIH0gICAgCgogICAgcHVibGlj\nIE9wZW5KUEFRdWVyeSBjcmVhdGVOYXRpdmVRdWVyeShTdHJpbmcgcXVlcnkp\nIHsKICAgICAgICB2YWxpZGF0ZVNRTChxdWVyeSk7CiAgICAgICAgcmV0dXJu\nIGNyZWF0ZVF1ZXJ5KFF1ZXJ5TGFuZ3VhZ2VzLkxBTkdfU1FMLCBxdWVyeSk7\nCiAgICB9CgogICAgcHVibGljIE9wZW5KUEFRdWVyeSBjcmVhdGVOYXRpdmVR\ndWVyeShTdHJpbmcgcXVlcnksIENsYXNzIGNscykgewogICAgICAgIHJldHVy\nbiBjcmVhdGVOYXRpdmVRdWVyeShxdWVyeSkuc2V0UmVzdWx0Q2xhc3MoY2xz\nKTsKICAgIH0KCiAgICBwdWJsaWMgT3BlbkpQQVF1ZXJ5IGNyZWF0ZU5hdGl2\nZVF1ZXJ5KFN0cmluZyBxdWVyeSwgU3RyaW5nIG1hcHBpbmdOYW1lKSB7CiAg\nICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAgdmFsaWRh\ndGVTUUwocXVlcnkpOwogICAgICAgIG9yZy5hcGFjaGUub3BlbmpwYS5rZXJu\nZWwuUXVlcnkga2VybmVsUXVlcnkgPSBfYnJva2VyLm5ld1F1ZXJ5KAogICAg\nICAgICAgICBRdWVyeUxhbmd1YWdlcy5MQU5HX1NRTCwgcXVlcnkpOwogICAg\nICAgIGtlcm5lbFF1ZXJ5LnNldFJlc3VsdE1hcHBpbmcobnVsbCwgbWFwcGlu\nZ05hbWUpOwogICAgICAgIHJldHVybiBuZXdRdWVyeUltcGwoa2VybmVsUXVl\ncnkpOwogICAgfQoKICAgIHByb3RlY3RlZCA8VD4gUXVlcnlJbXBsPFQ+IG5l\nd1F1ZXJ5SW1wbChvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLlF1ZXJ5IGtl\ncm5lbFF1ZXJ5KSB7CiAgICAgICAgcmV0dXJuIG5ldyBRdWVyeUltcGw8VD4o\ndGhpcywgX3JldCwga2VybmVsUXVlcnkpOwogICAgfQoKICAgIC8qKgogICAg\nICogVmFsaWRhdGUgdGhhdCB0aGUgdXNlciBwcm92aWRlZCBTUUwuCiAgICAg\nKi8KICAgIHByb3RlY3RlZCB2b2lkIHZhbGlkYXRlU1FMKFN0cmluZyBxdWVy\neSkgewogICAgICAgIGlmIChTdHJpbmdVdGlscy50cmltVG9OdWxsKHF1ZXJ5\nKSA9PSBudWxsKQogICAgICAgICAgICB0aHJvdyBuZXcgQXJndW1lbnRFeGNl\ncHRpb24oX2xvYy5nZXQoIm5vLXNxbCIpLCBudWxsLCBudWxsLCBmYWxzZSk7\nCiAgICB9CiAgICAKICAgIFByZXBhcmVkUXVlcnlDYWNoZSBnZXRQcmVwYXJl\nZFF1ZXJ5Q2FjaGUoKSB7CiAgICAgICAgcmV0dXJuIF9icm9rZXIuZ2V0Q2Fj\naGVQcmVwYXJlZFF1ZXJ5KCkgPwogICAgICAgICAgICBnZXRDb25maWd1cmF0\naW9uKCkuZ2V0UXVlcnlTUUxDYWNoZUluc3RhbmNlKCkgOiBudWxsOwogICAg\nfQogICAgCiAgICAvKioKICAgICAqIEdldHMgdGhlIHByZXBhcmVkIHF1ZXJ5\nIGNhY2hlZCBieSB0aGUgZ2l2ZW4ga2V5LiAKICAgICAqIAogICAgICogQHJl\ndHVybiB0aGUgY2FjaGVkIFByZXBhcmVkUXVlcnkgb3IgbnVsbCBpZiBub25l\nIGV4aXN0cy4KICAgICAqLwogICAgUHJlcGFyZWRRdWVyeSBnZXRQcmVwYXJl\nZFF1ZXJ5KFN0cmluZyBpZCkgewogICAgICAgIFByZXBhcmVkUXVlcnlDYWNo\nZSBjYWNoZSA9IGdldFByZXBhcmVkUXVlcnlDYWNoZSgpOwogICAgICAgIHJl\ndHVybiAoY2FjaGUgPT0gbnVsbCkgPyBudWxsIDogY2FjaGUuZ2V0KGlkKTsK\nICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRGbHVzaE1vZGUoRmx1c2hNb2Rl\nVHlwZSBmbHVzaE1vZGUpIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUludm9r\nZWQoKTsKICAgICAgICBfYnJva2VyLmFzc2VydE9wZW4oKTsKICAgICAgICBf\nYnJva2VyLmdldEZldGNoQ29uZmlndXJhdGlvbigpLnNldEZsdXNoQmVmb3Jl\nUXVlcmllcwogICAgICAgICAgICAodG9GbHVzaEJlZm9yZVF1ZXJpZXMoZmx1\nc2hNb2RlKSk7CiAgICB9CgogICAgcHVibGljIEZsdXNoTW9kZVR5cGUgZ2V0\nRmx1c2hNb2RlKCkgewogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgp\nOwogICAgICAgIF9icm9rZXIuYXNzZXJ0T3BlbigpOwogICAgICAgIHJldHVy\nbiBmcm9tRmx1c2hCZWZvcmVRdWVyaWVzKF9icm9rZXIuZ2V0RmV0Y2hDb25m\naWd1cmF0aW9uKCkuCiAgICAgICAgICAgIGdldEZsdXNoQmVmb3JlUXVlcmll\ncygpKTsKICAgIH0KCiAgICAvKioKICAgICAqIFRyYW5zbGF0ZSBvdXIgaW50\nZXJuYWwgZmx1c2ggY29uc3RhbnQgdG8gYSBmbHVzaCBtb2RlIGVudW0gdmFs\ndWUuCiAgICAgKi8KICAgIHN0YXRpYyBGbHVzaE1vZGVUeXBlIGZyb21GbHVz\naEJlZm9yZVF1ZXJpZXMoaW50IGZsdXNoKSB7CiAgICAgICAgc3dpdGNoIChm\nbHVzaCkgewogICAgICAgICAgICBjYXNlIFF1ZXJ5Rmx1c2hNb2Rlcy5GTFVT\nSF9UUlVFOgogICAgICAgICAgICAgICAgcmV0dXJuIEZsdXNoTW9kZVR5cGUu\nQVVUTzsKICAgICAgICAgICAgY2FzZSBRdWVyeUZsdXNoTW9kZXMuRkxVU0hf\nRkFMU0U6CiAgICAgICAgICAgICAgICByZXR1cm4gRmx1c2hNb2RlVHlwZS5D\nT01NSVQ7CiAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgICBy\nZXR1cm4gbnVsbDsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBU\ncmFuc2xhdGUgYSBmbHVzaCBtb2RlIGVudW0gdmFsdWUgdG8gb3VyIGludGVy\nbmFsIGZsdXNoIGNvbnN0YW50LgogICAgICovCiAgICBzdGF0aWMgaW50IHRv\nRmx1c2hCZWZvcmVRdWVyaWVzKEZsdXNoTW9kZVR5cGUgZmx1c2hNb2RlKSB7\nCiAgICAgICAgLy8gY2hvb3NlIGRlZmF1bHQgZm9yIG51bGwKICAgICAgICBp\nZiAoZmx1c2hNb2RlID09IG51bGwpCiAgICAgICAgICAgIHJldHVybiBRdWVy\neUZsdXNoTW9kZXMuRkxVU0hfV0lUSF9DT05ORUNUSU9OOwogICAgICAgIGlm\nIChmbHVzaE1vZGUgPT0gRmx1c2hNb2RlVHlwZS5BVVRPKQogICAgICAgICAg\nICByZXR1cm4gUXVlcnlGbHVzaE1vZGVzLkZMVVNIX1RSVUU7CiAgICAgICAg\naWYgKGZsdXNoTW9kZSA9PSBGbHVzaE1vZGVUeXBlLkNPTU1JVCkKICAgICAg\nICAgICAgcmV0dXJuIFF1ZXJ5Rmx1c2hNb2Rlcy5GTFVTSF9GQUxTRTsKICAg\nICAgICB0aHJvdyBuZXcgQXJndW1lbnRFeGNlcHRpb24oZmx1c2hNb2RlLnRv\nU3RyaW5nKCksIG51bGwsIG51bGwsIGZhbHNlKTsKICAgIH0KCiAgICAvKgog\nICAgICogVXNlZCBieSBKYXZhIEVFIENvbnRhaW5lcnMgdGhhdCB3aXNoIHRv\nIHBvb2wgT3BlbkpQQSBFbnRpdHlNYW5hZ2Vycy4gIFRoZSBzcGVjaWZpY2F0\naW9uCiAgICAgKiBkb2Vzbid0IGFsbG93IHRoZSBjbG9zaW5nIG9mIGNvbm5l\nY3Rpb25zIHdpdGggdGhlIGNsZWFyKCkgbWV0aG9kLiAgQnkgaW50cm9kdWNp\nbmcgdGhpcwogICAgICogbmV3IG1ldGhvZCwgd2UgY2FuIGRvIGFkZGl0aW9u\nYWwgcHJvY2Vzc2luZyAoYW5kIG1heWJlIG1vcmUgZWZmaWNpZW50IHByb2Nl\nc3NpbmcpIHRvIAogICAgICogcHJvcGVybHkgcHJlcGFyZSBhbiBFTSBmb3Ig\ncG9vbGluZy4KICAgICAqLwogICAgcHVibGljIHZvaWQgcHJlcGFyZUZvclBv\nb2xpbmcoKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAg\nICAgICAgY2xlYXIoKTsKICAgICAgICBfYnJva2VyLmxvY2soKTsgIC8vIHNp\nbmNlIHRoaXMgZGlyZWN0IGNsb3NlIHBhdGggaXMgbm90IHByb3RlY3RlZC4u\nLgogICAgICAgIHRyeSB7CiAgICAgICAgICAgIF9icm9rZXIuZ2V0U3RvcmVN\nYW5hZ2VyKCkuY2xvc2UoKTsKICAgICAgICB9IGZpbmFsbHkgewogICAgICAg\nICAgICBfYnJva2VyLnVubG9jaygpOwogICAgICAgIH0KICAgIH0KICAgIAog\nICAgcHVibGljIHZvaWQgY2xlYXIoKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xv\nc2VJbnZva2VkKCk7CiAgICAgICAgX2Jyb2tlci5kZXRhY2hBbGwodGhpcywg\nZmFsc2UpOwogICAgICAgIF9wbGFucy5jbGVhcigpOwogICAgfQoKICAgIHB1\nYmxpYyBPYmplY3QgZ2V0RGVsZWdhdGUoKSB7CiAgICAgICAgX2Jyb2tlci5h\nc3NlcnRPcGVuKCk7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7\nCiAgICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CgogICAgcHVibGljIExvY2tN\nb2RlVHlwZSBnZXRMb2NrTW9kZShPYmplY3QgZW50aXR5KSB7CiAgICAgICAg\nYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAgX2Jyb2tlci5hc3Nl\ncnRBY3RpdmVUcmFuc2FjdGlvbigpOwogICAgICAgIGFzc2VydFZhbGlkQXR0\nY2hlZEVudGl0eShHRVRfTE9DS19NT0RFLCBlbnRpdHkpOwogICAgICAgIHJl\ndHVybiBNaXhlZExvY2tMZXZlbHNIZWxwZXIuZnJvbUxvY2tMZXZlbCgKICAg\nICAgICAgICAgX2Jyb2tlci5nZXRMb2NrTGV2ZWwoZW50aXR5KSk7CiAgICB9\nCgogICAgcHVibGljIHZvaWQgbG9jayhPYmplY3QgZW50aXR5LCBMb2NrTW9k\nZVR5cGUgbW9kZSkgewogICAgICAgIGxvY2soZW50aXR5LCBtb2RlLCAtMSk7\nCiAgICB9CgogICAgcHVibGljIHZvaWQgbG9jayhPYmplY3QgZW50aXR5KSB7\nCiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAgYXNz\nZXJ0VmFsaWRBdHRjaGVkRW50aXR5KExPQ0ssIGVudGl0eSk7CiAgICAgICAg\nX2Jyb2tlci5sb2NrKGVudGl0eSwgdGhpcyk7CiAgICB9CgogICAgcHVibGlj\nIHZvaWQgbG9jayhPYmplY3QgZW50aXR5LCBMb2NrTW9kZVR5cGUgbW9kZSwg\naW50IHRpbWVvdXQpIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQo\nKTsKICAgICAgICBhc3NlcnRWYWxpZEF0dGNoZWRFbnRpdHkoTE9DSywgZW50\naXR5KTsKCiAgICAgICAgY29uZmlndXJlQ3VycmVudEZldGNoUGxhbihwdXNo\nRmV0Y2hQbGFuKCksIG51bGwsIG1vZGUsIGZhbHNlKTsKICAgICAgICB0cnkg\newogICAgICAgICAgICBfYnJva2VyLmxvY2soZW50aXR5LCBNaXhlZExvY2tM\nZXZlbHNIZWxwZXIudG9Mb2NrTGV2ZWwobW9kZSksICB0aW1lb3V0LCB0aGlz\nKTsKICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICBwb3BGZXRjaFBs\nYW4oKTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGljIHZvaWQgbG9jayhP\nYmplY3QgZW50aXR5LCBMb2NrTW9kZVR5cGUgbW9kZSwgTWFwPFN0cmluZywg\nT2JqZWN0PiBwcm9wZXJ0aWVzKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJ\nbnZva2VkKCk7CiAgICAgICAgYXNzZXJ0VmFsaWRBdHRjaGVkRW50aXR5KExP\nQ0ssIGVudGl0eSk7CiAgICAgICAgX2Jyb2tlci5hc3NlcnRBY3RpdmVUcmFu\nc2FjdGlvbigpOwogICAgICAgIHByb3BlcnRpZXMgPSBjbG9uZVByb3BlcnRp\nZXMocHJvcGVydGllcyk7CiAgICAgICAgY29uZmlndXJlQ3VycmVudENhY2hl\nTW9kZXMocHVzaEZldGNoUGxhbigpLCBwcm9wZXJ0aWVzKTsKICAgICAgICBj\nb25maWd1cmVDdXJyZW50RmV0Y2hQbGFuKGdldEZldGNoUGxhbigpLCBwcm9w\nZXJ0aWVzLCBtb2RlLCBmYWxzZSk7CiAgICAgICAgdHJ5IHsKICAgICAgICAg\nICAgX2Jyb2tlci5sb2NrKGVudGl0eSwgTWl4ZWRMb2NrTGV2ZWxzSGVscGVy\nLnRvTG9ja0xldmVsKG1vZGUpLAogICAgICAgICAgICAgICAgX2Jyb2tlci5n\nZXRGZXRjaENvbmZpZ3VyYXRpb24oKS5nZXRMb2NrVGltZW91dCgpLCB0aGlz\nKTsKICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICBwb3BGZXRjaFBs\nYW4oKTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGljIHZvaWQgbG9ja0Fs\nbChDb2xsZWN0aW9uIGVudGl0aWVzKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xv\nc2VJbnZva2VkKCk7CiAgICAgICAgX2Jyb2tlci5sb2NrQWxsKGVudGl0aWVz\nLCB0aGlzKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBsb2NrQWxsKENvbGxl\nY3Rpb24gZW50aXRpZXMsIExvY2tNb2RlVHlwZSBtb2RlLCBpbnQgdGltZW91\ndCkgewogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAgICAg\nIF9icm9rZXIubG9ja0FsbChlbnRpdGllcywgTWl4ZWRMb2NrTGV2ZWxzSGVs\ncGVyLnRvTG9ja0xldmVsKG1vZGUpLAogICAgICAgICAgICB0aW1lb3V0LCB0\naGlzKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBsb2NrQWxsKE9iamVjdC4u\nLiBlbnRpdGllcykgewogICAgICAgIGxvY2tBbGwoQXJyYXlzLmFzTGlzdChl\nbnRpdGllcykpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIGxvY2tBbGwoT2Jq\nZWN0W10gZW50aXRpZXMsIExvY2tNb2RlVHlwZSBtb2RlLCBpbnQgdGltZW91\ndCkgewogICAgICAgIGxvY2tBbGwoQXJyYXlzLmFzTGlzdChlbnRpdGllcyks\nIG1vZGUsIHRpbWVvdXQpOwogICAgfQoKICAgIHB1YmxpYyBib29sZWFuIGNh\nbmNlbEFsbCgpIHsKICAgICAgICByZXR1cm4gX2Jyb2tlci5jYW5jZWxBbGwo\nKTsKICAgIH0KCiAgICBwdWJsaWMgT2JqZWN0IGdldENvbm5lY3Rpb24oKSB7\nCiAgICAgICAgcmV0dXJuIF9icm9rZXIuZ2V0Q29ubmVjdGlvbigpOwogICAg\nfQoKICAgIHB1YmxpYyBDb2xsZWN0aW9uIGdldE1hbmFnZWRPYmplY3RzKCkg\newogICAgICAgIHJldHVybiBfYnJva2VyLmdldE1hbmFnZWRPYmplY3RzKCk7\nCiAgICB9CgogICAgcHVibGljIENvbGxlY3Rpb24gZ2V0VHJhbnNhY3Rpb25h\nbE9iamVjdHMoKSB7CiAgICAgICAgcmV0dXJuIF9icm9rZXIuZ2V0VHJhbnNh\nY3Rpb25hbE9iamVjdHMoKTsKICAgIH0KCiAgICBwdWJsaWMgQ29sbGVjdGlv\nbiBnZXRQZW5kaW5nVHJhbnNhY3Rpb25hbE9iamVjdHMoKSB7CiAgICAgICAg\ncmV0dXJuIF9icm9rZXIuZ2V0UGVuZGluZ1RyYW5zYWN0aW9uYWxPYmplY3Rz\nKCk7CiAgICB9CgogICAgcHVibGljIENvbGxlY3Rpb24gZ2V0RGlydHlPYmpl\nY3RzKCkgewogICAgICAgIHJldHVybiBfYnJva2VyLmdldERpcnR5T2JqZWN0\ncygpOwogICAgfQoKICAgIHB1YmxpYyBib29sZWFuIGdldE9yZGVyRGlydHlP\nYmplY3RzKCkgewogICAgICAgIHJldHVybiBfYnJva2VyLmdldE9yZGVyRGly\ndHlPYmplY3RzKCk7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0T3JkZXJE\naXJ0eU9iamVjdHMoYm9vbGVhbiBvcmRlcikgewogICAgICAgIGFzc2VydE5v\ndENsb3NlSW52b2tlZCgpOwogICAgICAgIF9icm9rZXIuc2V0T3JkZXJEaXJ0\neU9iamVjdHMob3JkZXIpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIGRpcnR5\nQ2xhc3MoQ2xhc3MgY2xzKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZv\na2VkKCk7CiAgICAgICAgX2Jyb2tlci5kaXJ0eVR5cGUoY2xzKTsKICAgIH0K\nCiAgICBAU3VwcHJlc3NXYXJuaW5ncygidW5jaGVja2VkIikKICAgIHB1Ymxp\nYyBDb2xsZWN0aW9uPENsYXNzPiBnZXRQZXJzaXN0ZWRDbGFzc2VzKCkgewog\nICAgICAgIHJldHVybiAoQ29sbGVjdGlvbjxDbGFzcz4pIF9icm9rZXIuZ2V0\nUGVyc2lzdGVkVHlwZXMoKTsKICAgIH0KCiAgICBAU3VwcHJlc3NXYXJuaW5n\ncygidW5jaGVja2VkIikKICAgIHB1YmxpYyBDb2xsZWN0aW9uPENsYXNzPiBn\nZXRVcGRhdGVkQ2xhc3NlcygpIHsKICAgICAgICByZXR1cm4gKENvbGxlY3Rp\nb248Q2xhc3M+KSBfYnJva2VyLmdldFVwZGF0ZWRUeXBlcygpOwogICAgfQoK\nICAgIEBTdXBwcmVzc1dhcm5pbmdzKCJ1bmNoZWNrZWQiKQogICAgcHVibGlj\nIENvbGxlY3Rpb248Q2xhc3M+IGdldFJlbW92ZWRDbGFzc2VzKCkgewogICAg\nICAgIHJldHVybiAoQ29sbGVjdGlvbjxDbGFzcz4pIF9icm9rZXIuZ2V0RGVs\nZXRlZFR5cGVzKCk7CiAgICB9CgogICAgcHVibGljIDxUPiBUIGNyZWF0ZUlu\nc3RhbmNlKENsYXNzPFQ+IGNscykgewogICAgICAgIGFzc2VydE5vdENsb3Nl\nSW52b2tlZCgpOwogICAgICAgIHJldHVybiAoVCkgX2Jyb2tlci5uZXdJbnN0\nYW5jZShjbHMpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIGNsb3NlKCkgewog\nICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIF9icm9r\nZXIuY2xvc2UoKTsKICAgICAgICBfcGxhbnMuY2xlYXIoKTsKICAgIH0KCiAg\nICBwdWJsaWMgYm9vbGVhbiBpc09wZW4oKSB7CiAgICAgICAgcmV0dXJuICFf\nYnJva2VyLmlzQ2xvc2VJbnZva2VkKCk7CiAgICB9CgogICAgcHVibGljIHZv\naWQgZGlydHkoT2JqZWN0IG8sIFN0cmluZyBmaWVsZCkgewogICAgICAgIGFz\nc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIE9wZW5KUEFTdGF0ZU1h\nbmFnZXIgc20gPSBfYnJva2VyLmdldFN0YXRlTWFuYWdlcihvKTsKICAgICAg\nICB0cnkgewogICAgICAgICAgICBpZiAoc20gIT0gbnVsbCkKICAgICAgICAg\nICAgICAgIHNtLmRpcnR5KGZpZWxkKTsKICAgICAgICB9IGNhdGNoIChFeGNl\ncHRpb24gZSkgewogICAgICAgICAgICB0aHJvdyBQZXJzaXN0ZW5jZUV4Y2Vw\ndGlvbnMudG9QZXJzaXN0ZW5jZUV4Y2VwdGlvbihlKTsKICAgICAgICB9CiAg\nICB9CgogICAgcHVibGljIE9iamVjdCBnZXRPYmplY3RJZChPYmplY3Qgbykg\newogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIHJl\ndHVybiBKUEFGYWNhZGVIZWxwZXIuZnJvbU9wZW5KUEFPYmplY3RJZChfYnJv\na2VyLmdldE9iamVjdElkKG8pKTsKICAgIH0KCiAgICBwdWJsaWMgYm9vbGVh\nbiBpc0RpcnR5KE9iamVjdCBvKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJ\nbnZva2VkKCk7CiAgICAgICAgcmV0dXJuIF9icm9rZXIuaXNEaXJ0eShvKTsK\nICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBpc1RyYW5zYWN0aW9uYWwoT2Jq\nZWN0IG8pIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAg\nICAgICByZXR1cm4gX2Jyb2tlci5pc1RyYW5zYWN0aW9uYWwobyk7CiAgICB9\nCgogICAgcHVibGljIGJvb2xlYW4gaXNQZXJzaXN0ZW50KE9iamVjdCBvKSB7\nCiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAgcmV0\ndXJuIF9icm9rZXIuaXNQZXJzaXN0ZW50KG8pOwogICAgfQoKICAgIHB1Ymxp\nYyBib29sZWFuIGlzTmV3bHlQZXJzaXN0ZW50KE9iamVjdCBvKSB7CiAgICAg\nICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAgcmV0dXJuIF9i\ncm9rZXIuaXNOZXcobyk7CiAgICB9CgogICAgcHVibGljIGJvb2xlYW4gaXNS\nZW1vdmVkKE9iamVjdCBvKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZv\na2VkKCk7CiAgICAgICAgcmV0dXJuIF9icm9rZXIuaXNEZWxldGVkKG8pOwog\nICAgfQoKICAgIHB1YmxpYyBib29sZWFuIGlzRGV0YWNoZWQoT2JqZWN0IGVu\ndGl0eSkgewogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAg\nICAgIHJldHVybiBfYnJva2VyLmlzRGV0YWNoZWQoZW50aXR5KTsKICAgIH0K\nCiAgICBwdWJsaWMgT2JqZWN0IGdldFZlcnNpb24oT2JqZWN0IG8pIHsKICAg\nICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICByZXR1cm4g\nX2Jyb2tlci5nZXRWZXJzaW9uKG8pOwogICAgfQoKICAgIC8qKgogICAgICog\nVGhyb3cgYXBwcm9wcmlhdGUgZXhjZXB0aW9uIGlmIGNsb3NlIGhhcyBiZWVu\nIGludm9rZWQgYnV0IHRoZSBicm9rZXIKICAgICAqIGlzIHN0aWxsIG9wZW4u\nICBXZSB0ZXN0IG9ubHkgZm9yIHRoaXMgYmVjYXVzZSBpZiB0aGUgYnJva2Vy\nIGlzIGFscmVhZHkKICAgICAqIGNsb3NlZCwgaXQgd2lsbCB0aHJvdyBpdHMg\nb3duIG1vcmUgaW5mb3JtYXRpdmUgZXhjZXB0aW9uIHdoZW4gd2UgCiAgICAg\nKiBkZWxlZ2F0ZSB0aGUgcGVuZGluZyBvcGVyYXRpb24gdG8gaXQuCiAgICAg\nKi8KICAgIHByb3RlY3RlZCB2b2lkIGFzc2VydE5vdENsb3NlSW52b2tlZCgp\nIHsKICAgICAgICBpZiAoIV9icm9rZXIuaXNDbG9zZWQoKSAmJiBfYnJva2Vy\nLmlzQ2xvc2VJbnZva2VkKCkpCiAgICAgICAgICAgIHRocm93IG5ldyBJbnZh\nbGlkU3RhdGVFeGNlcHRpb24oX2xvYy5nZXQoImNsb3NlLWludm9rZWQiKSwg\nbnVsbCwKICAgICAgICAgICAgICAgIG51bGwsIHRydWUpOwogICAgfQoKICAg\nIC8qKgogICAgICogVGhyb3cgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uaWYg\naWYgZW50aXR5IGlzIG5vdCBhIHZhbGlkIGVudGl0eSBvcgogICAgICogaWYg\naXQgaXMgZGV0YWNoZWQuCiAgICAgKi8KICAgIHZvaWQgYXNzZXJ0VmFsaWRB\ndHRjaGVkRW50aXR5KFN0cmluZyBjYWxsLCBPYmplY3QgZW50aXR5KSB7CiAg\nICAgICAgT3BlbkpQQVN0YXRlTWFuYWdlciBzbSA9IF9icm9rZXIuZ2V0U3Rh\ndGVNYW5hZ2VyKGVudGl0eSk7CiAgICAgICAgaWYgKHNtID09IG51bGwgfHwg\nIXNtLmlzUGVyc2lzdGVudCgpIHx8IHNtLmlzRGV0YWNoZWQoKSB8fCAoY2Fs\nbC5lcXVhbHMoUkVGUkVTSCkgJiYgc20uaXNEZWxldGVkKCkpKSB7CiAgICAg\nICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24oX2xv\nYy5nZXQoImludmFsaWRfZW50aXR5X2FyZ3VtZW50IiwgCiAgICAgICAgICAg\nICAgICBjYWxsLCBlbnRpdHkgPT0gbnVsbCA/ICJudWxsIiA6IEV4Y2VwdGlv\nbnMudG9TdHJpbmcoZW50aXR5KSkuZ2V0TWVzc2FnZSgpKTsKICAgICAgICB9\nCiAgICB9CgogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8K\nICAgIC8vIEZpbmRDYWxsYmFja3MgaW1wbGVtZW50YXRpb24KICAgIC8vLy8v\nLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCgogICAgcHVibGljIE9iamVj\ndCBwcm9jZXNzQXJndW1lbnQoT2JqZWN0IGFyZykgewogICAgICAgIHJldHVy\nbiBhcmc7CiAgICB9CgogICAgcHVibGljIE9iamVjdCBwcm9jZXNzUmV0dXJu\nKE9iamVjdCBvaWQsIE9wZW5KUEFTdGF0ZU1hbmFnZXIgc20pIHsKICAgICAg\nICByZXR1cm4gKHNtID09IG51bGwgfHwgc20uaXNEZWxldGVkKCkpID8gbnVs\nbCA6IHNtLmdldE1hbmFnZWRJbnN0YW5jZSgpOwogICAgfQoKICAgIC8vLy8v\nLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwogICAgLy8gT3BDYWxsYmFja3Mg\naW1wbGVtZW50YXRpb24KICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v\nLy8vLwoKICAgIHB1YmxpYyBpbnQgcHJvY2Vzc0FyZ3VtZW50KGludCBvcCwg\nT2JqZWN0IG9iaiwgT3BlbkpQQVN0YXRlTWFuYWdlciBzbSkgewogICAgICAg\nIHN3aXRjaCAob3ApIHsKICAgICAgICAgICAgY2FzZSBPUF9ERUxFVEU6CiAg\nICAgICAgICAgICAgICAvLyBjYXNjYWRlIHRocm91Z2ggbm9uLXBlcnNpc3Rl\nbnQgbm9uLWRldGFjaGVkIGluc3RhbmNlcwogICAgICAgICAgICAgICAgaWYg\nKHNtID09IG51bGwgJiYgIV9icm9rZXIuaXNEZXRhY2hlZChvYmopKQogICAg\nICAgICAgICAgICAgICAgIHJldHVybiBBQ1RfQ0FTQ0FERTsKICAgICAgICAg\nICAgICAgIGlmIChzbSAhPSBudWxsICYmICFzbS5pc0RldGFjaGVkKCkgJiYg\nIXNtLmlzUGVyc2lzdGVudCgpKQogICAgICAgICAgICAgICAgICAgIHJldHVy\nbiBBQ1RfQ0FTQ0FERTsKICAgICAgICAgICAgICAgIC8vIGlnbm9yZSBkZWxl\ndGVkIGluc3RhbmNlcwogICAgICAgICAgICAgICAgaWYgKHNtICE9IG51bGwg\nJiYgc20uaXNEZWxldGVkKCkpCiAgICAgICAgICAgICAgICAgICAgcmV0dXJu\nIEFDVF9OT05FOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAg\nIGNhc2UgT1BfQVRUQUNIOgogICAgICAgICAgICAgICAgLy8gZGllIG9uIHJl\nbW92ZWQKICAgICAgICAgICAgICAgIGlmIChzbSAhPSBudWxsICYmIHNtLmlz\nRGVsZXRlZCgpKQogICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBVc2Vy\nRXhjZXB0aW9uKF9sb2MuZ2V0KCJyZW1vdmVkIiwKICAgICAgICAgICAgICAg\nICAgICAgICAgRXhjZXB0aW9ucy50b1N0cmluZyhvYmopKSkuc2V0RmFpbGVk\nT2JqZWN0KG9iaik7CiAgICAgICAgICAgICAgICAvLyBjYXNjYWRlIHRocm91\nZ2ggbWFuYWdlZCBpbnN0YW5jZXMKICAgICAgICAgICAgICAgIGlmIChzbSAh\nPSBudWxsICYmICFzbS5pc0RldGFjaGVkKCkpCiAgICAgICAgICAgICAgICAg\nICAgcmV0dXJuIEFDVF9DQVNDQURFOwogICAgICAgICAgICAgICAgYnJlYWs7\nCiAgICAgICAgICAgIGNhc2UgT1BfUkVGUkVTSDoKICAgICAgICAgICAgICAg\nIC8vIGRpZSBvbiB1bm1hbmFnZWQgaW5zdGFuY2VzCiAgICAgICAgICAgICAg\nICBpZiAoc20gPT0gbnVsbCkKICAgICAgICAgICAgICAgICAgICB0aHJvdyBu\nZXcgVXNlckV4Y2VwdGlvbihfbG9jLmdldCgibm90LW1hbmFnZWQiLAogICAg\nICAgICAgICAgICAgICAgICAgICBFeGNlcHRpb25zLnRvU3RyaW5nKG9iaikp\nKS5zZXRGYWlsZWRPYmplY3Qob2JqKTsKICAgICAgICAgICAgICAgIGJyZWFr\nOwogICAgICAgICAgICBjYXNlIE9QX0RFVEFDSDoKICAgICAgICAgICAgICAg\nIGlmIChzbSA9PSBudWxsIHx8ICFzbS5pc1BlcnNpc3RlbnQoKSB8fCBzbS5p\nc0RldGFjaGVkKCkpCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIEFDVF9O\nT05FOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICAg\nIHJldHVybiBBQ1RfUlVOIHwgQUNUX0NBU0NBREU7CiAgICB9CgogICAgcHVi\nbGljIGludCBoYXNoQ29kZSgpIHsKICAgICAgICByZXR1cm4gKF9icm9rZXIg\nPT0gbnVsbCkgPyAwIDogX2Jyb2tlci5oYXNoQ29kZSgpOwogICAgfQoKICAg\nIHB1YmxpYyBib29sZWFuIGVxdWFscyhPYmplY3Qgb3RoZXIpIHsKICAgICAg\nICBpZiAob3RoZXIgPT0gdGhpcykKICAgICAgICAgICAgcmV0dXJuIHRydWU7\nCiAgICAgICAgaWYgKChvdGhlciA9PSBudWxsKSB8fCAob3RoZXIuZ2V0Q2xh\nc3MoKSAhPSB0aGlzLmdldENsYXNzKCkpKQogICAgICAgICAgICByZXR1cm4g\nZmFsc2U7CiAgICAgICAgaWYgKF9icm9rZXIgPT0gbnVsbCkKICAgICAgICAg\nICAgcmV0dXJuIGZhbHNlOwogICAgICAgIHJldHVybiBfYnJva2VyLmVxdWFs\ncygoKEVudGl0eU1hbmFnZXJJbXBsKSBvdGhlcikuX2Jyb2tlcik7CiAgICB9\nCgogICAgcHVibGljIHZvaWQgcmVhZEV4dGVybmFsKE9iamVjdElucHV0IGlu\nKQogICAgICAgIHRocm93cyBJT0V4Y2VwdGlvbiwgQ2xhc3NOb3RGb3VuZEV4\nY2VwdGlvbiB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgX3JldCA9IFBl\ncnNpc3RlbmNlRXhjZXB0aW9ucy5nZXRSb2xsYmFja1RyYW5zbGF0b3IodGhp\ncyk7CgogICAgICAgICAgICAvLyB0aGlzIGFzc3VtZXMgdGhhdCBzZXJpYWxp\nemVkIEJyb2tlcnMgYXJlIGZyb20gc29tZXRoaW5nCiAgICAgICAgICAgIC8v\nIHRoYXQgZXh0ZW5kcyBBYnN0cmFjdEJyb2tlckZhY3RvcnkuCiAgICAgICAg\nICAgIE9iamVjdCBmYWN0b3J5S2V5ID0gaW4ucmVhZE9iamVjdCgpOwogICAg\nICAgICAgICBBYnN0cmFjdEJyb2tlckZhY3RvcnkgZmFjdG9yeSA9CiAgICAg\nICAgICAgICAgICBBYnN0cmFjdEJyb2tlckZhY3RvcnkuZ2V0UG9vbGVkRmFj\ndG9yeUZvcktleShmYWN0b3J5S2V5KTsKICAgICAgICAgICAgYnl0ZVtdIGJy\nb2tlckJ5dGVzID0gKGJ5dGVbXSkgaW4ucmVhZE9iamVjdCgpOwogICAgICAg\nICAgICBPYmplY3RJbnB1dFN0cmVhbSBpbm5lckluID0gbmV3IEJyb2tlckJ5\ndGVzSW5wdXRTdHJlYW0oYnJva2VyQnl0ZXMsCiAgICAgICAgICAgICAgICBm\nYWN0b3J5LmdldENvbmZpZ3VyYXRpb24oKSk7CgogICAgICAgICAgICBCcm9r\nZXIgYnJva2VyID0gKEJyb2tlcikgaW5uZXJJbi5yZWFkT2JqZWN0KCk7CiAg\nICAgICAgICAgIEVudGl0eU1hbmFnZXJGYWN0b3J5SW1wbCBlbWYgPSAoRW50\naXR5TWFuYWdlckZhY3RvcnlJbXBsKQogICAgICAgICAgICAgICAgSlBBRmFj\nYWRlSGVscGVyLnRvRW50aXR5TWFuYWdlckZhY3RvcnkoCiAgICAgICAgICAg\nICAgICAgICAgYnJva2VyLmdldEJyb2tlckZhY3RvcnkoKSk7CiAgICAgICAg\nICAgIGJyb2tlci5wdXRVc2VyT2JqZWN0KEpQQUZhY2FkZUhlbHBlci5FTV9L\nRVksIHRoaXMpOwogICAgICAgICAgICBpbml0aWFsaXplKGVtZiwgYnJva2Vy\nKTsKICAgICAgICB9IGNhdGNoIChSdW50aW1lRXhjZXB0aW9uIHJlKSB7CiAg\nICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICByZSA9IF9yZXQudHJh\nbnNsYXRlKHJlKTsKICAgICAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUp\nIHsKICAgICAgICAgICAgICAgIC8vIGlnbm9yZQogICAgICAgICAgICB9CiAg\nICAgICAgICAgIHRocm93IHJlOwogICAgICAgIH0KICAgIH0KCiAgICBwdWJs\naWMgdm9pZCB3cml0ZUV4dGVybmFsKE9iamVjdE91dHB1dCBvdXQpIHRocm93\ncyBJT0V4Y2VwdGlvbiB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgLy8g\ndGhpcyByZXF1aXJlcyB0aGF0IG9ubHkgQWJzdHJhY3RCcm9rZXJGYWN0b3J5\nLXNvdXJjZWQKICAgICAgICAgICAgLy8gYnJva2VycyBjYW4gYmUgc2VyaWFs\naXplZAogICAgICAgICAgICBPYmplY3QgZmFjdG9yeUtleSA9ICgoQWJzdHJh\nY3RCcm9rZXJGYWN0b3J5KSBfYnJva2VyCiAgICAgICAgICAgICAgICAuZ2V0\nQnJva2VyRmFjdG9yeSgpKS5nZXRQb29sS2V5KCk7CiAgICAgICAgICAgIG91\ndC53cml0ZU9iamVjdChmYWN0b3J5S2V5KTsKICAgICAgICAgICAgQnl0ZUFy\ncmF5T3V0cHV0U3RyZWFtIGJhb3MgPSBuZXcgQnl0ZUFycmF5T3V0cHV0U3Ry\nZWFtKCk7CiAgICAgICAgICAgIE9iamVjdE91dHB1dFN0cmVhbSBpbm5lck91\ndCA9IG5ldyBPYmplY3RPdXRwdXRTdHJlYW0oYmFvcyk7CiAgICAgICAgICAg\nIGlubmVyT3V0LndyaXRlT2JqZWN0KF9icm9rZXIuZ2V0RGVsZWdhdGUoKSk7\nCiAgICAgICAgICAgIGlubmVyT3V0LmZsdXNoKCk7CiAgICAgICAgICAgIG91\ndC53cml0ZU9iamVjdChiYW9zLnRvQnl0ZUFycmF5KCkpOwogICAgICAgIH0g\nY2F0Y2ggKFJ1bnRpbWVFeGNlcHRpb24gcmUpIHsKICAgICAgICAgICAgdHJ5\nIHsKICAgICAgICAgICAgICAgIHJlID0gX3JldC50cmFuc2xhdGUocmUpOwog\nICAgICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkgewogICAgICAgICAg\nICAgICAgLy8gaWdub3JlCiAgICAgICAgICAgIH0KICAgICAgICAgICAgdGhy\nb3cgcmU7CiAgICAgICAgfQogICAgfQoKICAgIHByaXZhdGUgc3RhdGljIGNs\nYXNzIEJyb2tlckJ5dGVzSW5wdXRTdHJlYW0gZXh0ZW5kcyBPYmplY3RJbnB1\ndFN0cmVhbSB7CgogICAgICAgIHByaXZhdGUgT3BlbkpQQUNvbmZpZ3VyYXRp\nb24gY29uZjsKCiAgICAgICAgQnJva2VyQnl0ZXNJbnB1dFN0cmVhbShieXRl\nW10gYnl0ZXMsIE9wZW5KUEFDb25maWd1cmF0aW9uIGNvbmYpCiAgICAgICAg\nICAgIHRocm93cyBJT0V4Y2VwdGlvbiB7CiAgICAgICAgICAgIHN1cGVyKG5l\ndyBCeXRlQXJyYXlJbnB1dFN0cmVhbShieXRlcykpOwogICAgICAgICAgICBp\nZiAoY29uZiA9PSBudWxsKQogICAgICAgICAgICAgICAgdGhyb3cgbmV3IEls\nbGVnYWxBcmd1bWVudEV4Y2VwdGlvbigKICAgICAgICAgICAgICAgICAgICAi\nSWxsZWdhbCBudWxsIGFyZ3VtZW50IHRvIE9iamVjdElucHV0U3RyZWFtV2l0\naExvYWRlciIpOwogICAgICAgICAgICB0aGlzLmNvbmYgPSBjb25mOwogICAg\nICAgIH0KCiAgICAgICAgLyoqCiAgICAgICAgICogTWFrZSBhIHByaW1pdGl2\nZSBhcnJheSBjbGFzcwogICAgICAgICAqLwogICAgICAgIHByaXZhdGUgQ2xh\nc3MgcHJpbWl0aXZlVHlwZShjaGFyIHR5cGUpIHsKICAgICAgICAgICAgc3dp\ndGNoICh0eXBlKSB7CiAgICAgICAgICAgICAgICBjYXNlICdCJzogcmV0dXJu\nIGJ5dGUuY2xhc3M7CiAgICAgICAgICAgICAgICBjYXNlICdDJzogcmV0dXJu\nIGNoYXIuY2xhc3M7CiAgICAgICAgICAgICAgICBjYXNlICdEJzogcmV0dXJu\nIGRvdWJsZS5jbGFzczsKICAgICAgICAgICAgICAgIGNhc2UgJ0YnOiByZXR1\ncm4gZmxvYXQuY2xhc3M7CiAgICAgICAgICAgICAgICBjYXNlICdJJzogcmV0\ndXJuIGludC5jbGFzczsKICAgICAgICAgICAgICAgIGNhc2UgJ0onOiByZXR1\ncm4gbG9uZy5jbGFzczsKICAgICAgICAgICAgICAgIGNhc2UgJ1MnOiByZXR1\ncm4gc2hvcnQuY2xhc3M7CiAgICAgICAgICAgICAgICBjYXNlICdaJzogcmV0\ndXJuIGJvb2xlYW4uY2xhc3M7CiAgICAgICAgICAgICAgICBkZWZhdWx0OiBy\nZXR1cm4gbnVsbDsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAg\ncHJvdGVjdGVkIENsYXNzPD8+IHJlc29sdmVDbGFzcyhPYmplY3RTdHJlYW1D\nbGFzcyBjbGFzc0Rlc2MpCiAgICAgICAgICAgIHRocm93cyBJT0V4Y2VwdGlv\nbiwgQ2xhc3NOb3RGb3VuZEV4Y2VwdGlvbiB7CgogICAgICAgICAgICBTdHJp\nbmcgY25hbWUgPSBjbGFzc0Rlc2MuZ2V0TmFtZSgpOwogICAgICAgICAgICBp\nZiAoY25hbWUuc3RhcnRzV2l0aCgiWyIpKSB7CiAgICAgICAgICAgICAgICAv\nLyBBbiBhcnJheQogICAgICAgICAgICAgICAgQ2xhc3M8Pz4gY29tcG9uZW50\nOwkJLy8gY29tcG9uZW50IGNsYXNzCiAgICAgICAgICAgICAgICBpbnQgZGNv\ndW50OwkJCSAgICAvLyBkaW1lbnNpb24KICAgICAgICAgICAgICAgIGZvciAo\nZGNvdW50PTE7IGNuYW1lLmNoYXJBdChkY291bnQpPT0nWyc7IGRjb3VudCsr\nKSA7CiAgICAgICAgICAgICAgICBpZiAoY25hbWUuY2hhckF0KGRjb3VudCkg\nPT0gJ0wnKSB7CiAgICAgICAgICAgICAgICAgICAgY29tcG9uZW50ID0gbG9v\na3VwQ2xhc3MoY25hbWUuc3Vic3RyaW5nKGRjb3VudCsxLAogICAgICAgICAg\nICAgICAgICAgICAgICBjbmFtZS5sZW5ndGgoKS0xKSk7CiAgICAgICAgICAg\nICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIGlmIChjbmFtZS5s\nZW5ndGgoKSAhPSBkY291bnQrMSkgewogICAgICAgICAgICAgICAgICAgICAg\nICB0aHJvdyBuZXcgQ2xhc3NOb3RGb3VuZEV4Y2VwdGlvbihjbmFtZSk7Ly8g\nbWFsZm9ybWVkCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAg\nICAgICAgIGNvbXBvbmVudCA9IHByaW1pdGl2ZVR5cGUoY25hbWUuY2hhckF0\nKGRjb3VudCkpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAg\naW50IGRpbVtdID0gbmV3IGludFtkY291bnRdOwogICAgICAgICAgICAgICAg\nZm9yIChpbnQgaT0wOyBpPGRjb3VudDsgaSsrKSB7CiAgICAgICAgICAgICAg\nICAgICAgZGltW2ldPTA7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAg\nICAgICByZXR1cm4gQXJyYXkubmV3SW5zdGFuY2UoY29tcG9uZW50LCBkaW0p\nLmdldENsYXNzKCk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAg\nICAgICByZXR1cm4gbG9va3VwQ2xhc3MoY25hbWUpOwogICAgICAgICAgICB9\nCiAgICAgICAgfQoKICAgICAgICAvKioKICAgICAgICAgKiBJZiB0aGlzIGlz\nIGEgZ2VuZXJhdGVkIHN1YmNsYXNzLCBsb29rIHVwIHRoZSBjb3JyZXNwb25k\naW5nIENsYXNzCiAgICAgICAgICogb2JqZWN0IHZpYSBtZXRhZGF0YS4KICAg\nICAgICAgKi8KICAgICAgICBwcml2YXRlIENsYXNzPD8+IGxvb2t1cENsYXNz\nKFN0cmluZyBjbGFzc05hbWUpCiAgICAgICAgICAgIHRocm93cyBDbGFzc05v\ndEZvdW5kRXhjZXB0aW9uIHsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAg\nICAgICAgIHJldHVybiBDbGFzcy5mb3JOYW1lKGNsYXNzTmFtZSk7CiAgICAg\nICAgICAgIH0gY2F0Y2ggKENsYXNzTm90Rm91bmRFeGNlcHRpb24gZSkgewog\nICAgICAgICAgICAgICAgaWYgKFBDRW5oYW5jZXIuaXNQQ1N1YmNsYXNzTmFt\nZShjbGFzc05hbWUpKSB7CiAgICAgICAgICAgICAgICAgICAgU3RyaW5nIHN1\ncGVyTmFtZSA9IFBDRW5oYW5jZXIudG9NYW5hZ2VkVHlwZU5hbWUoY2xhc3NO\nYW1lKTsKICAgICAgICAgICAgICAgICAgICBDbGFzc01ldGFEYXRhW10gbWV0\nYXMgPSBjb25mLmdldE1ldGFEYXRhUmVwb3NpdG9yeUluc3RhbmNlKCkKICAg\nICAgICAgICAgICAgICAgICAgICAgLmdldE1ldGFEYXRhcygpOwogICAgICAg\nICAgICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgbWV0YXMubGVuZ3Ro\nOyBpKyspIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN1cGVyTmFt\nZS5lcXVhbHMoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXRhc1tp\nXS5nZXREZXNjcmliZWRUeXBlKCkuZ2V0TmFtZSgpKSkgewogICAgICAgICAg\nICAgICAgICAgICAgICAgICAgcmV0dXJuIFBDUmVnaXN0cnkuZ2V0UENUeXBl\nKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1ldGFzW2ldLmdl\ndERlc2NyaWJlZFR5cGUoKSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0K\nICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIC8v\nIGlmIGl0J3Mgbm90IGZvdW5kLCB0cnkgdG8gbG9vayBmb3IgaXQgYW55d2F5\ncwogICAgICAgICAgICAgICAgICAgIHJldHVybiBDbGFzcy5mb3JOYW1lKGNs\nYXNzTmFtZSk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAg\nICAgICAgICAgIHRocm93IGU7CiAgICAgICAgICAgICAgICB9CiAgICAgICAg\nICAgIH0KICAgICAgICB9CiAgICB9CgogICAgcHVibGljIHZvaWQgZGV0YWNo\nKE9iamVjdCBlbnRpdHkpIHsKICAgICAgICBpZiAoZW50aXR5ID09IG51bGwp\nCiAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRp\nb24oX2xvYy5nZXQoIm51bGwtZGV0YWNoIikuZ2V0TWVzc2FnZSgpKTsKICAg\nICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICBfYnJva2Vy\nLmRldGFjaChlbnRpdHksIHRoaXMpOwogICAgfQoKICAgIC8qKgogICAgICog\nQ3JlYXRlIGEgcXVlcnkgZnJvbSB0aGUgZ2l2ZW4gQ3JpdHJpYVF1ZXJ5Lgog\nICAgICogQ29tcGlsZSB0byByZWdpc3RlciB0aGUgcGFyYW1ldGVycyBpbiB0\naGlzIHF1ZXJ5LgogICAgICovCiAgICBwdWJsaWMgPFQ+IFR5cGVkUXVlcnk8\nVD4gY3JlYXRlUXVlcnkoQ3JpdGVyaWFRdWVyeTxUPiBjcml0ZXJpYVF1ZXJ5\nKSB7CiAgICAgICAgKChPcGVuSlBBQ3JpdGVyaWFRdWVyeTxUPiljcml0ZXJp\nYVF1ZXJ5KS5jb21waWxlKCk7IAogICAgICAgIAogICAgICAgIG9yZy5hcGFj\naGUub3BlbmpwYS5rZXJuZWwuUXVlcnkga2VybmVsUXVlcnkgPV9icm9rZXIu\nbmV3UXVlcnkoQ3JpdGVyaWFCdWlsZGVySW1wbC5MQU5HX0NSSVRFUklBLCBj\ncml0ZXJpYVF1ZXJ5KTsKICAgICAgICAKICAgICAgICBRdWVyeUltcGw8VD4g\nZmFjYWRlUXVlcnkgPSBuZXdRdWVyeUltcGwoa2VybmVsUXVlcnkpLnNldElk\nKGNyaXRlcmlhUXVlcnkudG9TdHJpbmcoKSk7CiAgICAgICAgU2V0PFBhcmFt\nZXRlckV4cHJlc3Npb248Pz4+IHBhcmFtcyA9IGNyaXRlcmlhUXVlcnkuZ2V0\nUGFyYW1ldGVycygpOwogICAgICAgIAogICAgICAgIGZvciAoUGFyYW1ldGVy\nRXhwcmVzc2lvbjw/PiBwYXJhbSA6IHBhcmFtcykgewogICAgICAgICAgICBm\nYWNhZGVRdWVyeS5kZWNsYXJlUGFyYW1ldGVyKHBhcmFtLCBwYXJhbSk7CiAg\nICAgICAgfQogICAgICAgIHJldHVybiBmYWNhZGVRdWVyeTsKICAgIH0KICAg\nIAogICAgcHVibGljIE9wZW5KUEFRdWVyeSBjcmVhdGVEeW5hbWljUXVlcnko\nCiAgICAgICAgb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNlLnF1ZXJ5\nLlF1ZXJ5RGVmaW5pdGlvbiBxZGVmKSB7CiAgICAgICAgU3RyaW5nIGpwcWwg\nPSBfZW1mLmdldER5bmFtaWNRdWVyeUJ1aWxkZXIoKS50b0pQUUwocWRlZik7\nCiAgICAgICAgcmV0dXJuIGNyZWF0ZVF1ZXJ5KGpwcWwpOwogICAgfQoKICAg\nIC8qKgogICAgICogR2V0IHRoZSBwcm9wZXJ0aWVzIHVzZWQgY3VycmVudGx5\nIGJ5IHRoaXMgZW50aXR5IG1hbmFnZXIuCiAgICAgKiBUaGUgcHJvcGVydHkg\na2V5cyBhbmQgdGhlaXIgdmFsdWVzIGFyZSBoYXJ2ZXN0ZWQgZnJvbSBrZXJu\nZWwgYXJ0aWZhY3RzIG5hbWVseQogICAgICogdGhlIEJyb2tlciBhbmQgRmV0\nY2hQbGFuIGJ5IHJlZmxlY3Rpb24uCiAgICAgKiBUaGVzZSBwcm9wZXJ0eSBr\nZXlzIGFuZCB2YWx1ZXMgdGhhdCBkZW5vdGUgdGhlIGJlYW4gcHJvcGVydGll\ncy92YWx1ZXMgb2YgdGhlIGtlcm5lbCBhcnRpZmFjdHMKICAgICAqIGFyZSBj\nb252ZXJ0ZWQgdG8gdGhlIG9yaWdpbmFsIGtleXMvdmFsdWVzIHRoYXQgdXNl\nciB1c2VkIHRvIHNldCB0aGUgcHJvcGVydGllcy4KICAgICAqICAgIAogICAg\nICovCiAgICBwdWJsaWMgTWFwPFN0cmluZywgT2JqZWN0PiBnZXRQcm9wZXJ0\naWVzKCkgewogICAgICAgIE1hcDxTdHJpbmcsT2JqZWN0PiBwcm9wcyA9IF9i\ncm9rZXIuZ2V0UHJvcGVydGllcygpOwogICAgICAgIGZvciAoU3RyaW5nIHMg\nOiBfYnJva2VyLmdldFN1cHBvcnRlZFByb3BlcnRpZXMoKSkgewogICAgICAg\nICAgICBTdHJpbmcga2VybmVsS2V5ID0gZ2V0QmVhblByb3BlcnR5TmFtZShz\nKTsKICAgICAgICAgICAgTWV0aG9kIGdldHRlciA9IFJlZmxlY3Rpb24uZmlu\nZEdldHRlcih0aGlzLmdldENsYXNzKCksIGtlcm5lbEtleSwgZmFsc2UpOwog\nICAgICAgICAgICBpZiAoZ2V0dGVyICE9IG51bGwpIHsKICAgICAgICAgICAg\nICAgIFN0cmluZyB1c2VyS2V5ID0gSlBBUHJvcGVydGllcy5nZXRVc2VyTmFt\nZShrZXJuZWxLZXkpOwogICAgICAgICAgICAgICAgT2JqZWN0IGt2YWx1ZSAg\nPSBSZWZsZWN0aW9uLmdldCh0aGlzLCBnZXR0ZXIpOwogICAgICAgICAgICAg\nICAgcHJvcHMucHV0KHVzZXJLZXkuZXF1YWxzKGtlcm5lbEtleSkgPyBzIDog\ndXNlcktleSwgSlBBUHJvcGVydGllcy5jb252ZXJ0VG9Vc2VyVmFsdWUodXNl\ncktleSwga3ZhbHVlKSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAg\nICAgRmV0Y2hQbGFuIGZldGNoID0gZ2V0RmV0Y2hQbGFuKCk7CiAgICAgICAg\nQ2xhc3M8Pz4gZmV0Y2hUeXBlID0gZmV0Y2guZ2V0Q2xhc3MoKTsKICAgICAg\nICBTZXQ8U3RyaW5nPiBmUHJvcGVydGllcyA9IFJlZmxlY3Rpb24uZ2V0QmVh\nblN0eWxlUHJvcGVydHlOYW1lcyhmZXRjaFR5cGUpOwogICAgICAgIGZvciAo\nU3RyaW5nIHMgOiBmUHJvcGVydGllcykgewogICAgICAgICAgICBTdHJpbmcg\na2VybmVsS2V5ID0gZ2V0QmVhblByb3BlcnR5TmFtZShzKTsKICAgICAgICAg\nICAgTWV0aG9kIGdldHRlciA9IFJlZmxlY3Rpb24uZmluZEdldHRlcihmZXRj\naFR5cGUsIGtlcm5lbEtleSwgZmFsc2UpOwogICAgICAgICAgICBpZiAoZ2V0\ndGVyICE9IG51bGwpIHsKICAgICAgICAgICAgICAgIFN0cmluZyB1c2VyS2V5\nID0gSlBBUHJvcGVydGllcy5nZXRVc2VyTmFtZShrZXJuZWxLZXkpOwogICAg\nICAgICAgICAgICAgT2JqZWN0IGt2YWx1ZSAgPSBSZWZsZWN0aW9uLmdldChm\nZXRjaCwgZ2V0dGVyKTsKICAgICAgICAgICAgICAgIHByb3BzLnB1dCh1c2Vy\nS2V5LmVxdWFscyhrZXJuZWxLZXkpID8gcyA6IHVzZXJLZXksIEpQQVByb3Bl\ncnRpZXMuY29udmVydFRvVXNlclZhbHVlKHVzZXJLZXksIGt2YWx1ZSkpOwog\nICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiBwcm9wczsK\nICAgIH0KCiAgICBwdWJsaWMgT3BlbkpQQUNyaXRlcmlhQnVpbGRlciBnZXRD\ncml0ZXJpYUJ1aWxkZXIoKSB7CiAgICAgICAgcmV0dXJuIF9lbWYuZ2V0Q3Jp\ndGVyaWFCdWlsZGVyKCk7CiAgICB9CgogICAgcHVibGljIFNldDxTdHJpbmc+\nIGdldFN1cHBvcnRlZFByb3BlcnRpZXMoKSB7CiAgICAgICAgcmV0dXJuIF9i\ncm9rZXIuZ2V0U3VwcG9ydGVkUHJvcGVydGllcygpOwogICAgfQoKICAgIC8q\nKgogICAgICogVW53cmFwcyB0aGlzIHJlY2VpdmVyIHRvIGFuIGluc3RhbmNl\nIG9mIHRoZSBnaXZlbiBjbGFzcywgaWYgcG9zc2libGUuCiAgICAgKiAKICAg\nICAqIEBleGNlcHRpb24gaWYgdGhlIGdpdmVuIGNsYXNzIGlzIG51bGwsIGdl\nbmVyaWMgPGNvZGU+T2JqZWN0LmNsYXNzPC9jb2RlPiBvciBhIGNsYXNzCiAg\nICAgKiB0aGF0IGlzIG5vdCB3cmFwcGVkIGJ5IHRoaXMgcmVjZWl2ZXIuICAK\nICAgICAqLwogICAgcHVibGljIDxUPiBUIHVud3JhcChDbGFzczxUPiBjbHMp\nIHsKICAgICAgICBPYmplY3RbXSBkZWxlZ2F0ZXMgPSBuZXcgT2JqZWN0W117\nX2Jyb2tlci5nZXRJbm5lcm1vc3REZWxlZ2F0ZSgpLAogICAgICAgICAgICBf\nYnJva2VyLmdldERlbGVnYXRlKCksIF9icm9rZXIsIHRoaXN9OwogICAgICAg\nIGZvciAoT2JqZWN0IG8gOiBkZWxlZ2F0ZXMpIHsKICAgICAgICAgICAgaWYg\nKGNscyAhPSBudWxsICYmIGNscyAhPSBPYmplY3QuY2xhc3MgJiYgY2xzLmlz\nSW5zdGFuY2UobykpCiAgICAgICAgICAgICAgICByZXR1cm4gKFQpbzsKICAg\nICAgICB9CiAgICAgICAgLy8gU2V0IHRoaXMgdHJhbnNhY3Rpb24gdG8gcm9s\nbGJhY2sgb25seSAoYXMgcGVyIHNwZWMpIGhlcmUgYmVjYXVzZSB0aGUgcmFp\nc2VkIGV4Y2VwdGlvbiAKICAgICAgICAvLyBkb2VzIG5vdCBnbyB0aHJvdWdo\nIG5vcm1hbCBleGNlcHRpb24gdHJhbnNsYXRpb24gcGF0aHdheXMKICAgICAg\nICBSdW50aW1lRXhjZXB0aW9uIGV4ID0gbmV3IFBlcnNpc3RlbmNlRXhjZXB0\naW9uKF9sb2MuZ2V0KCJ1bndyYXAtZW0taW52YWxpZCIsIGNscykudG9TdHJp\nbmcoKSwgbnVsbCwgCiAgICAgICAgICAgICAgICB0aGlzLCBmYWxzZSk7CiAg\nICAgICAgaWYgKGlzQWN0aXZlKCkpCiAgICAgICAgICAgIHNldFJvbGxiYWNr\nT25seShleCk7CiAgICAgICAgdGhyb3cgZXg7CiAgICB9CgogICAgcHVibGlj\nIHZvaWQgc2V0UXVlcnlTUUxDYWNoZShib29sZWFuIGZsYWcpIHsKICAgICAg\nICBfYnJva2VyLnNldENhY2hlUHJlcGFyZWRRdWVyeShmbGFnKTsKICAgIH0K\nICAgIAogICAgcHVibGljIGJvb2xlYW4gZ2V0UXVlcnlTUUxDYWNoZSgpIHsK\nICAgICAgICByZXR1cm4gX2Jyb2tlci5nZXRDYWNoZVByZXBhcmVkUXVlcnko\nKTsKICAgIH0KICAgIAogICAgUnVudGltZUV4Y2VwdGlvblRyYW5zbGF0b3Ig\nZ2V0RXhjZXB0aW9uVHJhbnNsYXRvcigpIHsKICAgICAgICByZXR1cm4gX3Jl\ndDsKICAgIH0KCiAgICAvKioKICAgICAqIFBvcHVsYXRlIHRoZSBnaXZlbiBG\nZXRjaFBsYW4gd2l0aCB0aGUgZ2l2ZW4gcHJvcGVydGllcy4gCiAgICAgKiBP\ncHRpb25hbGx5IG92ZXJyaWRlcyB0aGUgZ2l2ZW4gbG9jayBtb2RlLgogICAg\nICovCiAgICBwcml2YXRlIHZvaWQgY29uZmlndXJlQ3VycmVudEZldGNoUGxh\nbihGZXRjaFBsYW4gZmV0Y2gsIE1hcDxTdHJpbmcsIE9iamVjdD4gcHJvcGVy\ndGllcywgCiAgICAgICAgICAgIExvY2tNb2RlVHlwZSBsb2NrLCBib29sZWFu\nIHJlcXVpcmVzVHhuKSB7CiAgICAgICAgLy8gaGFuZGxlIHByb3BlcnRpZXMg\naW4gbWFwIGZpcnN0CiAgICAgICAgaWYgKHByb3BlcnRpZXMgIT0gbnVsbCkg\newogICAgICAgICAgICBmb3IgKE1hcC5FbnRyeTxTdHJpbmcsIE9iamVjdD4g\nZW50cnkgOiBwcm9wZXJ0aWVzLmVudHJ5U2V0KCkpCiAgICAgICAgICAgICAg\nICBmZXRjaC5zZXRIaW50KGVudHJ5LmdldEtleSgpLCBlbnRyeS5nZXRWYWx1\nZSgpKTsKICAgICAgICB9CiAgICAgICAgLy8gb3ZlcnJpZGUgd2l0aCB0aGUg\nc3BlY2lmaWMgbG9ja01vZGUsIGlmIG5lZWRlZC4KICAgICAgICBpZiAobG9j\nayAhPSBudWxsICYmIGxvY2sgIT0gTG9ja01vZGVUeXBlLk5PTkUpIHsKICAg\nICAgICAgICAgaWYgKHJlcXVpcmVzVHhuKSB7CiAgICAgICAgICAgICAgICBf\nYnJva2VyLmFzc2VydEFjdGl2ZVRyYW5zYWN0aW9uKCk7CiAgICAgICAgICAg\nIH0KICAgICAgICAgICAgLy8gT3ZlcnJpZGUgcmVhZCBsb2NrIGxldmVsCiAg\nICAgICAgICAgIExvY2tNb2RlVHlwZSBjdXJSZWFkTG9ja01vZGUgPSBmZXRj\naC5nZXRSZWFkTG9ja01vZGUoKTsKICAgICAgICAgICAgaWYgKGxvY2sgIT0g\nY3VyUmVhZExvY2tNb2RlKQogICAgICAgICAgICAgICAgZmV0Y2guc2V0UmVh\nZExvY2tNb2RlKGxvY2spOwogICAgICAgIH0KICAgIH0KICAgIAogICAgLyoq\nCiAgICAgKiBQb3B1bGF0ZSB0aGUgZmV0Y2ggY29uZmlndXJhdGlvbiB3aXRo\nIHNwZWNpZmllZCBjYWNoZSBtb2RlIHByb3BlcnRpZXMuCiAgICAgKiBUaGUg\nY2FjaGUgbW9kZSBwcm9wZXJ0aWVzIG1vZGlmeSB0aGUgZmV0Y2ggY29uZmln\ndXJhdGlvbiBhbmQgcmVtb3ZlIHRob3NlCiAgICAgKiBwcm9wZXJ0aWVzLiBU\naGlzIG1ldGhvZCBzaG91bGQgYmUgY2FsbGVkIDxlbT5iZWZvcmU8L2VtPiB0\naGUgZmV0Y2ggY29uZmlndXJhdGlvbiBvZiB0aGUgY3VycmVudCAKICAgICAq\nIGNvbnRleHQgaGFzIGJlZW4gcHVzaGVkLgogICAgICogQHBhcmFtIGZldGNo\nIHRoZSBmZXRjaCBjb25maWd1cmF0aW9uIG9mIHRoZSBjdXJyZW50IGNvbnRl\neHQuIE5vdCB0aGUgCiAgICAgKiBuZXcgY29uZmlndXJhdGlvbiBwdXNoZWQg\nKGFuZCBsYXRlciBwb3BwZWQpIGR1cmluZyBhIHNpbmdsZSBvcGVyYXRpb24u\nCiAgICAgKiAKICAgICAqIEBwYXJhbSBwcm9wZXJ0aWVzCiAgICAgKi8KICAg\nIHByaXZhdGUgdm9pZCBjb25maWd1cmVDdXJyZW50Q2FjaGVNb2RlcyhGZXRj\naFBsYW4gZmV0Y2gsIE1hcDxTdHJpbmcsIE9iamVjdD4gcHJvcGVydGllcykg\newogICAgICAgIGlmIChwcm9wZXJ0aWVzID09IG51bGwpCiAgICAgICAgICAg\nIHJldHVybjsKICAgICAgICBDYWNoZVJldHJpZXZlTW9kZSByTW9kZSA9IEpQ\nQVByb3BlcnRpZXMuZ2V0RW51bVZhbHVlKENhY2hlUmV0cmlldmVNb2RlLmNs\nYXNzLCAKICAgICAgICAgICAgICAgIEpQQVByb3BlcnRpZXMuQ0FDSEVfUkVU\nUklFVkVfTU9ERSwgcHJvcGVydGllcyk7CiAgICAgICAgaWYgKHJNb2RlICE9\nIG51bGwpIHsKICAgICAgICAgICAgZmV0Y2guc2V0Q2FjaGVSZXRyaWV2ZU1v\nZGUoSlBBUHJvcGVydGllcy5jb252ZXJ0VG9LZXJuZWxWYWx1ZShEYXRhQ2Fj\naGVSZXRyaWV2ZU1vZGUuY2xhc3MsIAogICAgICAgICAgICAgICAgICAgIEpQ\nQVByb3BlcnRpZXMuQ0FDSEVfUkVUUklFVkVfTU9ERSwgck1vZGUpKTsKICAg\nICAgICAgICAgcHJvcGVydGllcy5yZW1vdmUoSlBBUHJvcGVydGllcy5DQUNI\nRV9SRVRSSUVWRV9NT0RFKTsKICAgICAgICB9CiAgICAgICAgQ2FjaGVTdG9y\nZU1vZGUgc01vZGUgPSBKUEFQcm9wZXJ0aWVzLmdldEVudW1WYWx1ZShDYWNo\nZVN0b3JlTW9kZS5jbGFzcywgCiAgICAgICAgICAgICAgICBKUEFQcm9wZXJ0\naWVzLkNBQ0hFX1NUT1JFX01PREUsIHByb3BlcnRpZXMpOwogICAgICAgIGlm\nIChzTW9kZSAhPSBudWxsKSB7CiAgICAgICAgICAgIGZldGNoLnNldENhY2hl\nU3RvcmVNb2RlKEpQQVByb3BlcnRpZXMuY29udmVydFRvS2VybmVsVmFsdWUo\nRGF0YUNhY2hlU3RvcmVNb2RlLmNsYXNzLCAKICAgICAgICAgICAgICAgICAg\nICBKUEFQcm9wZXJ0aWVzLkNBQ0hFX1NUT1JFX01PREUsIHNNb2RlKSk7CiAg\nICAgICAgICAgIHByb3BlcnRpZXMucmVtb3ZlKEpQQVByb3BlcnRpZXMuQ0FD\nSEVfU1RPUkVfTU9ERSk7CiAgICAgICAgfQogICAgfQoKICAgIHB1YmxpYyBN\nZXRhbW9kZWwgZ2V0TWV0YW1vZGVsKCkgewogICAgICAgIHJldHVybiBfZW1m\nLmdldE1ldGFtb2RlbCgpOwogICAgfQoKICAgIC8qKgogICAgICogU2V0cyB0\naGUgZ2l2ZW4gcHJvcGVydHkgdG8gdGhlIGdpdmVuIHZhbHVlLCByZWZsZWN0\naXZlbHkuCiAgICAgKiAKICAgICAqIFRoZSBwcm9wZXJ0eSBrZXkgaXMgdHJh\nbnNwb3NlZCB0byBhIGJlYW4tc3R5bGUgcHJvcGVydHkuCiAgICAgKiBUaGUg\ndmFsdWUgaXMgY29udmVydGVkIHRvIGEgdHlwZSBjb25zdW1hYmxlIGJ5IHRo\nZSBrZXJuZWwuCiAgICAgKiBBZnRlciByZXF1aXNpdGUgdHJhbnNmb3JtYXRp\nb24sIGlmIHRoZSB2YWx1ZSBjYW4gbm90IGJlIHNldAogICAgICogb24gZWl0\naGVyIHRoaXMgaW5zdGFuY2Ugb3IgaXRzIGZldGNoIHBsYW4gYnkgcmVmbGVj\ndGlvbiwKICAgICAqIHRoZW4gYW4gd2FybmluZyBtZXNzYWdlIChub3QgYW4g\nZXhjZXB0aW9uIGFzIHBlciBKUEEgc3BlY2lmaWNhdGlvbikgaXMgaXNzdWVk\nLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRQcm9wZXJ0eShTdHJpbmcg\ncHJvcCwgT2JqZWN0IHZhbHVlKSB7CiAgICAgICAgaWYgKCFzZXRLZXJuZWxQ\ncm9wZXJ0eSh0aGlzLCBwcm9wLCB2YWx1ZSkpIHsKICAgICAgICAgICAgaWYg\nKCFzZXRLZXJuZWxQcm9wZXJ0eSh0aGlzLmdldEZldGNoUGxhbigpLCBwcm9w\nLCB2YWx1ZSkpIHsKICAgICAgICAgICAgICAgIExvZyBsb2cgPSBnZXRDb25m\naWd1cmF0aW9uKCkuZ2V0TG9nKE9wZW5KUEFDb25maWd1cmF0aW9uLkxPR19S\nVU5USU1FKTsKICAgICAgICAgICAgICAgIGlmIChsb2cuaXNXYXJuRW5hYmxl\nZCgpKSB7CiAgICAgICAgICAgICAgICAgICAgbG9nLndhcm4oX2xvYy5nZXQo\nImlnbm9yZWQtZW0tcHJvcCIsIHByb3AsIHZhbHVlID09IG51bGwgPyAiIiA6\nIHZhbHVlLmdldENsYXNzKCkrIjoiICsgdmFsdWUpKTsKICAgICAgICAgICAg\nICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CiAgICAKICAg\nIC8qKgogICAgICogQXR0ZW1wdCB0byBzZXQgdGhlIGdpdmVuIHByb3BlcnR5\nIGFuZCB2YWx1ZSB0byB0aGUgZ2l2ZW4gdGFyZ2V0IGluc3RhbmNlLgogICAg\nICogVGhlIG9yaWdpbmFsIHByb3BlcnR5IGlzIHRyYW5zcG9zZWQgdG8gYSBi\nZWFuLXN0eWxlIHByb3BlcnR5IG5hbWUuCiAgICAgKiBUaGUgb3JpZ2luYWwg\ndmFsdWUgaXMgdHJhbnNmb3JtZWQgdG8gYSB0eXBlIGNvbnN1bWFibGUgYnkg\ndGhlIHRhcmdldC4KICAgICAqICAKICAgICAqIEByZXR1cm4gaWYgdGhlIHBy\nb3BlcnR5IGNhbiBiZSBzZXQgdG8gdGhlIGdpdmVuIHRhcmdldC4KICAgICAq\nLwogICAgcHJpdmF0ZSBib29sZWFuIHNldEtlcm5lbFByb3BlcnR5KE9iamVj\ndCB0YXJnZXQsIFN0cmluZyBvcmlnaW5hbCwgT2JqZWN0IHZhbHVlKSB7CiAg\nICAgICAgU3RyaW5nIGJlYW5Qcm9wID0gZ2V0QmVhblByb3BlcnR5TmFtZShv\ncmlnaW5hbCk7CiAgICAgICAgSlBBUHJvcGVydGllcy5yZWNvcmQoYmVhblBy\nb3AsIG9yaWdpbmFsKTsKICAgICAgICBDbGFzczw/PiBrVHlwZSAgPSBudWxs\nOwogICAgICAgIE9iamVjdCAgIGtWYWx1ZSA9IG51bGw7CiAgICAgICAgTWV0\naG9kIHNldHRlciA9IFJlZmxlY3Rpb24uZmluZFNldHRlcih0YXJnZXQuZ2V0\nQ2xhc3MoKSwgYmVhblByb3AsIGZhbHNlKTsKICAgICAgICBpZiAoc2V0dGVy\nICE9IG51bGwpIHsKICAgICAgICAgICAga1R5cGUgID0gc2V0dGVyLmdldFBh\ncmFtZXRlclR5cGVzKClbMF07CiAgICAgICAgICAgIGtWYWx1ZSA9IGNvbnZl\ncnRVc2VyVmFsdWUob3JpZ2luYWwsIHZhbHVlLCBrVHlwZSk7CiAgICAgICAg\nICAgIFJlZmxlY3Rpb24uc2V0KHRhcmdldCwgc2V0dGVyLCBrVmFsdWUpOwog\nICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9IGVsc2UgewogICAg\nICAgICAgICBGaWVsZCBmaWVsZCA9IFJlZmxlY3Rpb24uZmluZEZpZWxkKHRh\ncmdldC5nZXRDbGFzcygpLCBiZWFuUHJvcCwgZmFsc2UpOwogICAgICAgICAg\nICBpZiAoZmllbGQgIT0gbnVsbCkgewogICAgICAgICAgICAgICAga1R5cGUg\nID0gZmllbGQuZ2V0VHlwZSgpOwogICAgICAgICAgICAgICAga1ZhbHVlID0g\nY29udmVydFVzZXJWYWx1ZShvcmlnaW5hbCwgdmFsdWUsIGtUeXBlKTsKICAg\nICAgICAgICAgICAgIFJlZmxlY3Rpb24uc2V0KHRhcmdldCwgZmllbGQsIGtW\nYWx1ZSk7CiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAg\nICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAg\nICAKICAgIC8qKgogICAgICogRXh0cmFjdCBhIGJlYW4tc3R5bGUgcHJvcGVy\ndHkgbmFtZSBmcm9tIHRoZSBnaXZlbiBzdHJpbmcuCiAgICAgKiBJZiB0aGUg\nZ2l2ZW4gc3RyaW5nIGlzIDxjb2RlPiJhLmIueHl6IjwvY29kZT4gdGhlbiBy\nZXR1cm5zIDxjb2RlPiJ4eXoiPC9jb2RlPiAKICAgICAqLwogICAgU3RyaW5n\nIGdldEJlYW5Qcm9wZXJ0eU5hbWUoU3RyaW5nIHVzZXIpIHsKICAgICAgICBT\ndHJpbmcgcmVzdWx0ID0gdXNlcjsKICAgICAgICBpZiAoSlBBUHJvcGVydGll\ncy5pc1ZhbGlkS2V5KHVzZXIpKSB7CiAgICAgICAgICAgIHJlc3VsdCA9IEpQ\nQVByb3BlcnRpZXMuZ2V0QmVhblByb3BlcnR5KHVzZXIpOwogICAgICAgIH0g\nZWxzZSB7CiAgICAgICAgICAgIGludCBkb3QgPSB1c2VyLmxhc3RJbmRleE9m\nKCcuJyk7CiAgICAgICAgICAgIGlmIChkb3QgIT0gLTEpCiAgICAgICAgICAg\nICAgICByZXN1bHQgPSB1c2VyLnN1YnN0cmluZyhkb3QrMSk7CiAgICAgICAg\nfQogICAgICAgIHJldHVybiByZXN1bHQ7IAogICAgfQogICAgCiAgICAKICAg\nIC8qKgogICAgICogQ29udmVydCB0aGUgZ2l2ZW4gdmFsdWUgdG8gYSB2YWx1\nZSBjb25zdW1hYmxlIGJ5IE9wZW5KUEEga2VybmVsIGNvbnN0cnVjdHMuCiAg\nICAgKi8KICAgIE9iamVjdCBjb252ZXJ0VXNlclZhbHVlKFN0cmluZyBrZXks\nIE9iamVjdCB2YWx1ZSwgQ2xhc3M8Pz4gdGFyZ2V0VHlwZSkgewogICAgICAg\nIGlmIChKUEFQcm9wZXJ0aWVzLmlzVmFsaWRLZXkoa2V5KSkgCiAgICAgICAg\nICAgIHJldHVybiBKUEFQcm9wZXJ0aWVzLmNvbnZlcnRUb0tlcm5lbFZhbHVl\nKHRhcmdldFR5cGUsIGtleSwgdmFsdWUpOwogICAgICAgIGlmICh2YWx1ZSBp\nbnN0YW5jZW9mIFN0cmluZykgewogICAgICAgICAgICBpZiAoIm51bGwiLmVx\ndWFscyh2YWx1ZSkpIHsKICAgICAgICAgICAgICAgIHJldHVybiBudWxsOwog\nICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgcmV0dXJuIFN0\ncmluZ3MucGFyc2UoKFN0cmluZykgdmFsdWUsIHRhcmdldFR5cGUpOwogICAg\nICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiB2YWx1ZTsKICAg\nIH0KCiAgICBwcml2YXRlIE1hcDxTdHJpbmcsIE9iamVjdD4gY2xvbmVQcm9w\nZXJ0aWVzKE1hcDxTdHJpbmcsIE9iamVjdD4gcHJvcGVydGllcykgewogICAg\nICAgIGlmIChwcm9wZXJ0aWVzICE9IG51bGwpIHsKICAgICAgICAgICAgcHJv\ncGVydGllcyA9IG5ldyBIYXNoTWFwPFN0cmluZywgT2JqZWN0Pihwcm9wZXJ0\naWVzKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHByb3BlcnRpZXM7CiAg\nICB9Cn0K\n","encoding":"base64"}

