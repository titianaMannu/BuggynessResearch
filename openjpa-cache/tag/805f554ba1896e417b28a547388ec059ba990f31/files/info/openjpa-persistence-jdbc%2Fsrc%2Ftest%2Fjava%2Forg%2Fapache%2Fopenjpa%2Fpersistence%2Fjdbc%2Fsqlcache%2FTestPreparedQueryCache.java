{"sha":"4239f51fef6914905dc73d7b6e2f2acc60fce795","node_id":"MDQ6QmxvYjIwNjM2NDo0MjM5ZjUxZmVmNjkxNDkwNWRjNzNkN2I2ZTJmMmFjYzYwZmNlNzk1","size":51094,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/4239f51fef6914905dc73d7b6e2f2acc60fce795","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuamRiYy5z\ncWxjYWNoZTsKCmltcG9ydCBqYXZhLnV0aWwuQXJyYXlMaXN0OwppbXBvcnQg\namF2YS51dGlsLkFycmF5czsKaW1wb3J0IGphdmEudXRpbC5Db2xsZWN0aW9u\nczsKaW1wb3J0IGphdmEudXRpbC5JdGVyYXRvcjsKaW1wb3J0IGphdmEudXRp\nbC5MaXN0OwppbXBvcnQgamF2YS51dGlsLlByb3BlcnRpZXM7CgppbXBvcnQg\namF2YXgucGVyc2lzdGVuY2UuRW50aXR5TWFuYWdlcjsKaW1wb3J0IGphdmF4\nLnBlcnNpc3RlbmNlLkxvY2tNb2RlVHlwZTsKaW1wb3J0IGphdmF4LnBlcnNp\nc3RlbmNlLlF1ZXJ5OwppbXBvcnQgamF2YXgucGVyc2lzdGVuY2UuVHlwZWRR\ndWVyeTsKCmltcG9ydCBqdW5pdC5mcmFtZXdvcmsuVGVzdENhc2U7CgppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5QcmVwYXJlZFF1ZXJ5Owpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5QcmVwYXJlZFF1ZXJ5\nQ2FjaGU7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLlF1ZXJ5\nSGludHM7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLlF1ZXJ5\nTGFuZ3VhZ2VzOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5R\ndWVyeVN0YXRpc3RpY3M7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEua2Vy\nbmVsLmpwcWwuSlBRTFBhcnNlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3Blbmpw\nYS5saWIuamRiYy5BYnN0cmFjdEpEQkNMaXN0ZW5lcjsKaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS5saWIuamRiYy5KREJDRXZlbnQ7CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEubGliLmpkYmMuSkRCQ0xpc3RlbmVyOwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNlLk9wZW5KUEFFbnRpdHlN\nYW5hZ2VyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNl\nLk9wZW5KUEFFbnRpdHlNYW5hZ2VyRmFjdG9yeVNQSTsKaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5PcGVuSlBBRW50aXR5TWFuYWdl\nclNQSTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5P\ncGVuSlBBUGVyc2lzdGVuY2U7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\ncGVyc2lzdGVuY2UuT3BlbkpQQVF1ZXJ5OwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLnBlcnNpc3RlbmNlLmpkYmMuc3FsY2FjaGUuRW1wbG95ZWUuQ2F0\nZWdvcnk7CgovKioKICogVGVzdHMgY29ycmVjdG5lc3MgYW5kIHBlcmZvcm1h\nbmNlIG9mIHF1ZXJpZXMgd2l0aCBhbmQgd2l0aG91dCBQcmVwYXJlZCBRdWVy\neSBDYWNoZWluZy4KICogIAogKiBUaGlzIHRlc3QgdXNlcyBhIHNpbmdsZSBF\nbnRpdHlNYW5hZ2VyRmFjdG9yeSBpbml0aWFsaXplZCB3aXRoIGZpeGVkIHNl\ndCBvZiBlbnRpdHkgY2xhc3NlcyAKICogYW5kIGFwcHJvcHJpYXRlIGNvbmZp\nZ3VyYXRpb24gcGFyYW1ldGVycyBmb3IgUHJlcGFyZWQgUXVlcnkgQ2FjaGUu\nIAogKiAKICogVGhlIGVudGl0eSBjbGFzc2VzIGFyZSBzcGVjaWZpZWQgaW4g\ncGVyc2lzdGVuY2UgdW5pdCA8Y29kZT4iUHJlcGFyZWRRdWVyeSI8L2NvZGU+\nIGluIGEgCiAqIDxjb2RlPk1FVEEtSU5GL3BlcnNpc3RlbmNlLnhtbDwvY29k\nZT4gdGhhdCBtdXN0IGJlIGF2YWlsYWJsZSB0byB0aGUgY2xhc3NwYXRoLgog\nKiAKICogQ29uZmlndXJlcyB0aGUgRW50aXR5TWFuYWdlckZhY3Rvcnkgd2l0\naCBwcm9wZXJ0aWVzIHRoYXQgYXJlIHJlbGV2YW50IHRvIHRlc3RpbmcgUHJl\ncGFyZWRRdWVyeSBjYWNoZXMuCiAqIFN3aXRjaGVzIG9mZiBydW50aW1lIGVu\naGFuY2VtZW50IHRvIGF2b2lkIHVuaW50ZW5kZWQgY29uc2VxdWVuY2VzLgog\nKiBQcm92aWRlcyBmYWNpbGl0aWVzIHRvIHJ1biBhIEpQUUwgcXVlcnkgd2l0\naCBhbmQgd2l0aG91dCBjYWNoZSBhbmQgY29tcHV0ZSB0aGUgcGVyZm9ybWFu\nY2UgZGVsdGEuIAogKiAKICogVXNlcyBhIGhhcmQtY29kZWQgZGF0YSBzZXQg\naW5pdGlhbGl6ZWQgb25jZSBmb3IgdGhlIGVudGlyZSBzdWl0ZS4gCiAqIAog\nKiBAYXV0aG9yIFBpbmFraSBQb2RkYXIKICogCiAqLwpwdWJsaWMgY2xhc3Mg\nVGVzdFByZXBhcmVkUXVlcnlDYWNoZSBleHRlbmRzIFRlc3RDYXNlIHsKICAg\nIAogICAgcHJpdmF0ZSBzdGF0aWMgU3RyaW5nIFJFU09VUkNFID0gIk1FVEEt\nSU5GL3BlcnNpc3RlbmNlLnhtbCI7IAogICAgcHJpdmF0ZSBzdGF0aWMgU3Ry\naW5nIFVOSVRfTkFNRSA9ICJQcmVwYXJlZFF1ZXJ5IjsKICAgIAogICAgcHJv\ndGVjdGVkIHN0YXRpYyBmaW5hbCBpbnQgU0FNUExFX1NJWkUgPSAxMDA7ICAv\nLyBuby4gb2Ygb2JzZXJ2YXRpb25zIGZvciBwZXJmb3JtYW5jZSBzdGF0aXN0\naWNzIAogICAgcHVibGljIHN0YXRpYyBmaW5hbCBib29sZWFuIFVTRV9DQUNI\nRSAgPSB0cnVlOyAvLyBtbmVtb25pYyBmb3IgdXNpbmcgY2FjaGUKICAgIHBy\naXZhdGUgc3RhdGljIE9iamVjdFtdIE5PX1BBUkFNUyAgICAgID0gbnVsbDsg\nLy8gbW5lbW9uaWMgZm9yIG5vIHF1ZXJ5IHBhcmFtZXRlcnMKICAgIHB1Ymxp\nYyBzdGF0aWMgZmluYWwgYm9vbGVhbiBJU19OQU1FRF9RVUVSWSAgPSB0cnVl\nOyAvLyBtbmVtb25pYyBmb3IgbmFtZWQgcXVlcnkKICAgIAogICAgcHJpdmF0\nZSBzdGF0aWMgYm9vbGVhbiBGQUlMX0lGX1BFUkZfREVHUkFERSA9IGZhbHNl\nOyAKCiAgICAKICAgIHByaXZhdGUgc3RhdGljIENvbXBhbnkgSUJNOwogICAg\ncHVibGljIHN0YXRpYyBmaW5hbCBTdHJpbmdbXSBDT01QQU5ZX05BTUVTICAg\nID0geyJJQk0iLCAiQkVBIiwgImFjbWUub3JnIiB9OwogICAgcHVibGljIHN0\nYXRpYyBmaW5hbCBpbnRbXSAgICBTVEFSVF9ZRUFSUyAgICAgID0gezE5MDAs\nIDIwMDAsIDIwMTAgfTsKCXB1YmxpYyBzdGF0aWMgZmluYWwgU3RyaW5nW10g\nREVQQVJUTUVOVF9OQU1FUyA9IHsiTWFya2V0aW5nIiwgIlNhbGVzIiwgIkVu\nZ2luZWVyaW5nIiB9OwogICAgcHVibGljIHN0YXRpYyBmaW5hbCBTdHJpbmdb\nXSBFTVBMT1lFRV9OQU1FUyAgID0geyJUb20iLCAiRGljayIsICJIYXJyYXki\nIH07CglwdWJsaWMgc3RhdGljIGZpbmFsIFN0cmluZ1tdIENJVFlfTkFNRVMg\nICAgICAgPSB7IlR1bHNhIiwgIkR1cmJhbiIsICJIYXJsZW0ifTsKCQogICAg\ncHVibGljIHN0YXRpYyBmaW5hbCBTdHJpbmcgRVhDTFVERURfUVVFUllfMSA9\nICJzZWxlY3QgY291bnQocCkgZnJvbSBDb21wYW55IHAiOwogICAgcHVibGlj\nIHN0YXRpYyBmaW5hbCBTdHJpbmcgRVhDTFVERURfUVVFUllfMiA9ICJzZWxl\nY3QgY291bnQocCkgZnJvbSBEZXBhcnRtZW50IHAiOwoJcHVibGljIHN0YXRp\nYyBmaW5hbCBTdHJpbmcgSU5DTFVERURfUVVFUlkgICA9ICJzZWxlY3QgcCBm\ncm9tIEFkZHJlc3MgcCI7CgkKICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgbG9u\nZ1tdIEJPT0tfSURTICAgICA9IHsxMDAwLCAyMDAwLCAzMDAwfTsKICAgIHB1\nYmxpYyBzdGF0aWMgZmluYWwgU3RyaW5nW10gQk9PS19OQU1FUyA9IHsiQXJn\ndW1lbnRhdGl2ZSBJbmRpYW4iLCAiVGluIERydW0iLCAiQmxpbmsifTsKICAg\nIHB1YmxpYyBzdGF0aWMgZmluYWwgbG9uZ1tdIENEX0lEUyAgICAgICA9IHsx\nMDAxLCAyMDAxLCAzMDAxfTsKICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgU3Ry\naW5nW10gQ0RfTEFCRUxTICA9ICB7IkJlYXRsZXMiLCAiU2luYXRyYSIsICJE\nb24ndCBSb2NrIE15IEJvYXQifTsKICAgIAogICAgcHJvdGVjdGVkIHN0YXRp\nYyBPcGVuSlBBRW50aXR5TWFuYWdlckZhY3RvcnlTUEkgZW1mOwogICAgcHJv\ndGVjdGVkIHN0YXRpYyBTUUxBdWRpdG9yIGF1ZGl0b3I7CiAgICBwcml2YXRl\nIE9wZW5KUEFFbnRpdHlNYW5hZ2VyU1BJIGVtOwoJCgkvKioKCSAqIFNldHMg\ndXAgdGhlIHRlc3Qgc3VpdGUgd2l0aCBhIHN0YXRpY2FsbHkgaW5pdGlhbGl6\nZWQgRW50aXR5TWFuYWdlckZhY3RvcnkuCgkgKiBDcmVhdGVzIGRhdGEgb25j\nZSBmb3IgYWxsIG90aGVyIHRlc3RzIHRvIHVzZS4KCSAqLwoJcHVibGljIHZv\naWQgc2V0VXAoKSAgewogICAgICAgIGlmIChlbWYgPT0gbnVsbCkgewogICAg\nICAgICAgICBQcm9wZXJ0aWVzIGNvbmZpZyA9IG5ldyBQcm9wZXJ0aWVzKCk7\nCiAgICAgICAgICAgIGNvbmZpZy5wdXQoIm9wZW5qcGEuamRiYy5TeW5jaHJv\nbml6ZU1hcHBpbmdzIiwgImJ1aWxkU2NoZW1hKEZvcmVpZ25LZXlzPXRydWUs\nU2NoZW1hQWN0aW9uPSdkcm9wLGFkZCcpIik7CiAgICAgICAgICAgIGNvbmZp\nZy5wdXQoIm9wZW5qcGEuamRiYy5KREJDTGlzdGVuZXJzIiwgbmV3IEpEQkNM\naXN0ZW5lcltdIHsgYXVkaXRvciA9IG5ldyBTUUxBdWRpdG9yKCl9KTsKICAg\nICAgICAgICAgY29uZmlnLnB1dCgib3BlbmpwYS5qZGJjLlF1ZXJ5U1FMQ2Fj\naGUiLCAidHJ1ZShFbmFibGVTdGF0aXN0aWNzPXRydWUpIik7CiAgICAgICAg\nICAgIGNvbmZpZy5wdXQoIm9wZW5qcGEuUnVudGltZVVuZW5oYW5jZWRDbGFz\nc2VzIiwgInVuc3VwcG9ydGVkIik7CiAgICAgICAgICAgIGNvbmZpZy5wdXQo\nIm9wZW5qcGEuRHluYW1pY0VuaGFuY2VtZW50QWdlbnQiLCAiZmFsc2UiKTsK\nICAgICAgICAgICAgZW1mID0gKE9wZW5KUEFFbnRpdHlNYW5hZ2VyRmFjdG9y\neVNQSSlPcGVuSlBBUGVyc2lzdGVuY2UuY3JlYXRlRW50aXR5TWFuYWdlckZh\nY3RvcnkoCiAgICAgICAgICAgICAgICAgICAgVU5JVF9OQU1FLCBSRVNPVVJD\nRSwgY29uZmlnKTsKICAgICAgICAgICAgZW0gPSBlbWYuY3JlYXRlRW50aXR5\nTWFuYWdlcigpOwogICAgICAgICAgICBjcmVhdGVUZXN0RGF0YSgpOwogICAg\nICAgIH0gZWxzZSB7CiAgICAJCWVtID0gZW1mLmNyZWF0ZUVudGl0eU1hbmFn\nZXIoKTsKICAgICAgICAgICAgZ2V0UHJlcGFyZWRRdWVyeUNhY2hlKCkuY2xl\nYXIoKTsKICAgICAgICB9Cgl9CgkKCS8qKgoJICogQ3JlYXRlIGRhdGEgZm9y\nIHRoZSBlbnRpcmUgdGVzdCBzdWl0ZSB0byB1c2UuCgkgKi8KCXZvaWQgY3Jl\nYXRlVGVzdERhdGEoKSB7CgkgICAgZW0uZ2V0VHJhbnNhY3Rpb24oKS5iZWdp\nbigpOwoJICAgIGZvciAoaW50IGkgPSAwOyBpIDwgQ09NUEFOWV9OQU1FUy5s\nZW5ndGg7IGkrKykgewoJICAgICAgICBDb21wYW55IGNvbXBhbnkgPSBuZXcg\nQ29tcGFueSgpOwoJICAgICAgICBpZiAoaSA9PSAwKSAKCSAgICAgICAgICAg\nIElCTSA9IGNvbXBhbnk7CgkgICAgICAgIGNvbXBhbnkuc2V0TmFtZShDT01Q\nQU5ZX05BTUVTW2ldKTsKCSAgICAgICAgY29tcGFueS5zZXRTdGFydFllYXIo\nU1RBUlRfWUVBUlNbaV0pOwoJICAgICAgICBlbS5wZXJzaXN0KGNvbXBhbnkp\nOwoJICAgICAgICBmb3IgKGludCBqID0gMDsgaiA8IERFUEFSVE1FTlRfTkFN\nRVMubGVuZ3RoOyBqKyspIHsKCSAgICAgICAgICAgIERlcGFydG1lbnQgZGVw\ndCA9IG5ldyBEZXBhcnRtZW50KCk7CgkgICAgICAgICAgICBkZXB0LnNldE5h\nbWUoREVQQVJUTUVOVF9OQU1FU1tqXSk7CgkgICAgICAgICAgICBjb21wYW55\nLmFkZERlcGFydG1lbnQoZGVwdCk7CgkgICAgICAgICAgICBlbS5wZXJzaXN0\nKGRlcHQpOwoJICAgICAgICAgICAgZm9yIChpbnQgayA9IDA7IGsgPCBFTVBM\nT1lFRV9OQU1FUy5sZW5ndGg7IGsrKykgewoJICAgICAgICAgICAgICAgIEVt\ncGxveWVlIGVtcCA9IG5ldyBFbXBsb3llZSgpOwoJICAgICAgICAgICAgICAg\nIGVtcC5zZXROYW1lKEVNUExPWUVFX05BTUVTW2tdKTsKCSAgICAgICAgICAg\nICAgICBBZGRyZXNzIGFkZHIgPSBuZXcgQWRkcmVzcygpOwoJICAgICAgICAg\nICAgICAgIGFkZHIuc2V0Q2l0eShDSVRZX05BTUVTW2tdKTsKICAgICAgICAg\nICAgICAgICAgICBlbS5wZXJzaXN0KGVtcCk7CgkgICAgICAgICAgICAgICAg\nZW0ucGVyc2lzdChhZGRyKTsKCSAgICAgICAgICAgICAgICBlbXAuc2V0QWRk\ncmVzcyhhZGRyKTsKICAgICAgICAgICAgICAgICAgICBkZXB0LmFkZEVtcGxv\neWVlcyhlbXApOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgfQog\nICAgICAgIFBlcnNvbiBwMSA9IG5ldyBQZXJzb24oIkpvaG4iLCAiRG9lIiwg\nKHNob3J0KTQ1LCAxOTY0KTsKICAgICAgICBQZXJzb24gcDIgPSBuZXcgUGVy\nc29uKCJKb2huIiwgIkRvZSIsIChzaG9ydCk0MiwgMTk2Nyk7CiAgICAgICAg\nUGVyc29uIHAzID0gbmV3IFBlcnNvbigiSGFycnkiLCAiRG9lIiwgKHNob3J0\nKTEyLCAxOTk1KTsKICAgICAgICBQZXJzb24gcDQgPSBuZXcgUGVyc29uKCJC\nYXJyeSIsICJEb2UiLCAoc2hvcnQpMjIsIDE5ODUpOwogICAgICAgIGVtLnBl\ncnNpc3QocDEpOwogICAgICAgIGVtLnBlcnNpc3QocDIpOwogICAgICAgIGVt\nLnBlcnNpc3QocDMpOwogICAgICAgIGVtLnBlcnNpc3QocDQpOwogICAgICAg\nIAogICAgICAgIEF1dGhvciBhMSA9IG5ldyBBdXRob3IoIkF1dGhvcjEiLCAi\nIiwgKHNob3J0KTQwLCAxOTYwKTsKICAgICAgICBBdXRob3IgYTIgPSBuZXcg\nQXV0aG9yKCJBdXRob3IyIiwgIiIsIChzaG9ydCk0MSwgMTk2MSk7CiAgICAg\nICAgQXV0aG9yIGEzID0gbmV3IEF1dGhvcigiQXV0aG9yMyIsICIiLCAoc2hv\ncnQpNDIsIDE5NjIpOwogICAgICAgIFNpbmdlciBzMSA9IG5ldyBTaW5nZXIo\nIlNpbmdlcjEiLCAiIiwgKHNob3J0KTIxLCAxOTkxKTsKICAgICAgICBTaW5n\nZXIgczIgPSBuZXcgU2luZ2VyKCJTaW5nZXIyIiwgIiIsIChzaG9ydCkyMiwg\nMTk5Mik7CiAgICAgICAgCiAgICAgICAgbG9uZyBpZCA9IDEwMDsKICAgICAg\nICBCb29rICAgYjEgPSBuZXcgQm9vaygiQm9vazEiKTsKICAgICAgICBCb29r\nICAgYjIgPSBuZXcgQm9vaygiQm9vazIiKTsKICAgICAgICBDRCAgICAgYzEg\nPSBuZXcgQ0QoIkNEMSIpOwogICAgICAgIENEICAgICBjMiA9IG5ldyBDRCgi\nQ0QyIik7CiAgICAgICAgCiAgICAgICAgYjEuc2V0SWQoaWQrKyk7IGIxLnNl\ndFRpdGxlKCJ0aXRsZS0xIik7IGIxLnNldFRva2VuKCJMQVJHRSIpOwogICAg\nICAgIGIyLnNldElkKGlkKyspOyBiMi5zZXRUaXRsZSgidGl0bGUtMiIpOyBi\nMi5zZXRUb2tlbigiTUVESVVNIik7CiAgICAgICAgYzEuc2V0SWQoaWQrKyk7\nCiAgICAgICAgYzIuc2V0SWQoaWQrKyk7CiAgICAgICAgYjEuYWRkQXV0aG9y\nKGExKTsKICAgICAgICBiMS5hZGRBdXRob3IoYTIpOwogICAgICAgIGIyLmFk\nZEF1dGhvcihhMik7CiAgICAgICAgYjIuYWRkQXV0aG9yKGEzKTsKICAgICAg\nICBjMS5zZXRTaW5nZXIoczEpOwogICAgICAgIGMyLnNldFNpbmdlcihzMik7\nCiAgICAgICAgCiAgICAgICAgZW0ucGVyc2lzdChhMSk7IGVtLnBlcnNpc3Qo\nYTIpOyAgIGVtLnBlcnNpc3QoYTMpOwogICAgICAgIGVtLnBlcnNpc3QoczEp\nOyBlbS5wZXJzaXN0KHMyKTsKICAgICAgICBlbS5wZXJzaXN0KGIxKTsgZW0u\ncGVyc2lzdChiMik7CiAgICAgICAgZW0ucGVyc2lzdChjMSk7IGVtLnBlcnNp\nc3QoYzIpOwoKICAgICAgICBpZCA9IChpbnQpU3lzdGVtLmN1cnJlbnRUaW1l\nTWlsbGlzKCk7CiAgICAgICAgT3JkZXJKUEEgbzEgPSBuZXcgT3JkZXJKUEEo\nKTsKICAgICAgICBvMS5zZXRPcmRlcklkKGlkKyspOwogICAgICAgIG8xLnNl\ndEN1c3RvbWVySWQoMzM5KTsKICAgICAgICBvMS5zZXREaXN0cmljdElkKDMp\nOwogICAgICAgIG8xLnNldFdhcmVob3VzZUlkKDIzKTsKICAgICAgICAKICAg\nICAgICBPcmRlckpQQSBvMiA9IG5ldyBPcmRlckpQQSgpOwogICAgICAgIG8y\nLnNldE9yZGVySWQoaWQrKyk7CiAgICAgICAgbzIuc2V0Q3VzdG9tZXJJZCgy\nOTY3KTsKICAgICAgICBvMi5zZXREaXN0cmljdElkKDUpOwogICAgICAgIG8y\nLnNldFdhcmVob3VzZUlkKDIyKTsKICAgICAgICAKICAgICAgICBlbS5wZXJz\naXN0KG8xKTsKICAgICAgICBlbS5wZXJzaXN0KG8yKTsKICAgICAgICAKICAg\nICAgICAKICAgICAgICBlbS5nZXRUcmFuc2FjdGlvbigpLmNvbW1pdCgpOwoJ\nfQoKCXB1YmxpYyB2b2lkIHRlYXJEb3duKCkgdGhyb3dzIEV4Y2VwdGlvbiB7\nCgkgICAgaWYgKGVtLmlzT3BlbigpKQoJICAgICAgICBlbS5jbG9zZSgpOwoJ\nCXN1cGVyLnRlYXJEb3duKCk7Cgl9CiAgICAKICAgIHB1YmxpYyB2b2lkIHRl\nc3RSZXBlYXRlZFBhcmFtZXRlckluU3VicXVlcnlJbkRpZmZlcmVudE9yZGVy\nU3ViUUxhc3QoKSB7CiAgICAgICAgT3BlbkpQQUVudGl0eU1hbmFnZXIgZW0g\nPSBlbWYuY3JlYXRlRW50aXR5TWFuYWdlcigpOwogICAgICAgCiAgICAgICAg\nU3RyaW5nIGpwcWwgPSAiU0VMRUNUIG8gZnJvbSBPcmRlckpQQSBvICIgKwog\nICAgICAgICAgICAgICAgIldIRVJFIChvLkN1c3RvbWVySWQgPSA6Y3VzdG9t\nZXJJZCkgIiArCiAgICAgICAgICAgICAgICAiQU5EIChvLldhcmVob3VzZUlk\nID0gOndhcmVob3VzZUlkKSAiICsKICAgICAgICAgICAgICAgICJBTkQgKG8u\nRGlzdHJpY3RJZCA9IDpkaXN0cmljdElkKSAiICsKICAgICAgICAgICAgICAg\nICJBTkQgby5PcmRlcklkIElOIChTRUxFQ1QgTUFYIChvMS5PcmRlcklkKSBm\ncm9tIE9yZGVySlBBIG8xICIgKwogICAgICAgICAgICAgICAgICAgICJXSEVS\nRSAoKG8xLkN1c3RvbWVySWQgPSA6Y3VzdG9tZXJJZCkgIiArCiAgICAgICAg\nICAgICAgICAgICAgIkFORCAgICAobzEuRGlzdHJpY3RJZCA9IDpkaXN0cmlj\ndElkKSAiICsKICAgICAgICAgICAgICAgICAgICAiQU5EICAgIChvMS5XYXJl\naG91c2VJZCA9IDp3YXJlaG91c2VJZCkpKSI7CiAgICAgICAgCiAgICAgICAg\nZW0uZ2V0VHJhbnNhY3Rpb24oKS5iZWdpbigpOwogICAgICAgIFR5cGVkUXVl\ncnk8T3JkZXJKUEE+IHExID0gZW0uY3JlYXRlUXVlcnkoanBxbCwgT3JkZXJK\nUEEuY2xhc3MpOwogICAgICAgIHExLnNldFBhcmFtZXRlcigiY3VzdG9tZXJJ\nZCIsIDMzOSkKICAgICAgICAgIC5zZXRQYXJhbWV0ZXIoImRpc3RyaWN0SWQi\nLCAzKQogICAgICAgICAgLnNldFBhcmFtZXRlcigid2FyZWhvdXNlSWQiLCAy\nMyk7CiAgICAgICAgICAgICAgICAgIAogICAgICAgIGFzc2VydEVxdWFscyhK\nUFFMUGFyc2VyLkxBTkdfSlBRTCwgT3BlbkpQQVBlcnNpc3RlbmNlLmNhc3Qo\ncTEpLmdldExhbmd1YWdlKCkpOwogICAgICAgIGFzc2VydEZhbHNlKHExLmdl\ndFJlc3VsdExpc3QoKS5pc0VtcHR5KCkpOyAgICAgICAgCiAgICAgICAgCiAg\nICAgICAgVHlwZWRRdWVyeTxPcmRlckpQQT4gcTIgPSBlbS5jcmVhdGVRdWVy\neShqcHFsLCBPcmRlckpQQS5jbGFzcyk7CiAgICAgICAgYXNzZXJ0RXF1YWxz\nKFF1ZXJ5TGFuZ3VhZ2VzLkxBTkdfUFJFUEFSRURfU1FMLCBPcGVuSlBBUGVy\nc2lzdGVuY2UuY2FzdChxMikuZ2V0TGFuZ3VhZ2UoKSk7CiAgICAgICAgcTIu\nc2V0UGFyYW1ldGVyKCJjdXN0b21lcklkIiwgMjk2NykKICAgICAgICAgIC5z\nZXRQYXJhbWV0ZXIoImRpc3RyaWN0SWQiLCA1KQogICAgICAgICAgLnNldFBh\ncmFtZXRlcigid2FyZWhvdXNlSWQiLCAyMik7CiAgICAgICAgCiAgICAgICAg\nYXNzZXJ0RmFsc2UocTIuZ2V0UmVzdWx0TGlzdCgpLmlzRW1wdHkoKSk7CiAg\nICAgICAgZW0uZ2V0VHJhbnNhY3Rpb24oKS5yb2xsYmFjaygpOwogICAgICAg\nIAogICAgfQoKCXB1YmxpYyB2b2lkIHRlc3RQcmVwYXJlZFF1ZXJ5Q2FjaGVJ\nc0FjdGl2ZUJ5RGVmYXVsdCgpIHsKCQlhc3NlcnROb3ROdWxsKGdldFByZXBh\ncmVkUXVlcnlDYWNoZSgpKTsKCX0KCQoJcHVibGljIHZvaWQgdGVzdFByZXBh\ncmVkUXVlcnlDYWNoZUlzUGVyVW5pdFNpbmdsZXRvbigpIHsKCQlQcmVwYXJl\nZFF1ZXJ5Q2FjaGUgYzEgPSBnZXRQcmVwYXJlZFF1ZXJ5Q2FjaGUoKTsKCQlQ\ncmVwYXJlZFF1ZXJ5Q2FjaGUgYzIgPSBnZXRQcmVwYXJlZFF1ZXJ5Q2FjaGUo\nKTsKCQlhc3NlcnRTYW1lKGMxLCBjMik7Cgl9CgkKCXB1YmxpYyB2b2lkIHRl\nc3RQcmVwYXJlZFF1ZXJ5SWRlbnRpZmllcklzT3JpZ2luYWxKUFFMUXVlcnko\nKSB7CiAgICAgICAgU3RyaW5nIGpwcWwgPSAic2VsZWN0IHAgZnJvbSBDb21w\nYW55IHAiOwogICAgICAgIE9wZW5KUEFRdWVyeTw/PiBxMSA9IGVtLmNyZWF0\nZVF1ZXJ5KGpwcWwpOwogICAgICAgIHExLmdldFJlc3VsdExpc3QoKTsKICAg\nICAgICBQcmVwYXJlZFF1ZXJ5IHBxID0gZ2V0UHJlcGFyZWRRdWVyeUNhY2hl\nKCkuZ2V0KGpwcWwpOwogICAgICAgIGFzc2VydE5vdE51bGwocHEpOwogICAg\nICAgIGFzc2VydEVxdWFscyhqcHFsLCBwcS5nZXRJZGVudGlmaWVyKCkpOwog\nICAgICAgIGFzc2VydEVxdWFscyhqcHFsLCBwcS5nZXRPcmlnaW5hbFF1ZXJ5\nKCkpOwoJfQoJCglwdWJsaWMgdm9pZCB0ZXN0T3JpZ2luYWxKUFFMUXVlcnlT\ndHJpbmdJc1NldE9uUHJlcGFyZWRRdWVyeSgpIHsKICAgICAgICBTdHJpbmcg\nanBxbCA9ICJzZWxlY3QgcCBmcm9tIENvbXBhbnkgcCI7CiAgICAgICAgT3Bl\nbkpQQVF1ZXJ5PD8+IHExID0gZW0uY3JlYXRlUXVlcnkoanBxbCk7CiAgICAg\nICAgcTEuZ2V0UmVzdWx0TGlzdCgpOwogICAgICAgIFByZXBhcmVkUXVlcnkg\ncHEgPSBnZXRQcmVwYXJlZFF1ZXJ5Q2FjaGUoKS5nZXQoanBxbCk7CiAgICAg\nICAgYXNzZXJ0Tm90TnVsbChwcSk7CiAgICAgICAgT3BlbkpQQVF1ZXJ5PD8+\nIHEyID0gZW0uY3JlYXRlUXVlcnkoanBxbCk7CiAgICAgICAgYXNzZXJ0RXF1\nYWxzKGpwcWwscTIuZ2V0UXVlcnlTdHJpbmcoKSk7Cgl9CgoJcHVibGljIHZv\naWQgdGVzdE9yZGVyQnlFbGVtZW50c0Fic2VudEluUHJvamVjdGlvbigpIHsK\nCSAgICBTdHJpbmcganBxbCA9ICJzZWxlY3QgYy5uYW1lIGZyb20gQ29tcGFu\neSBjIE9SREVSIEJZIGMuc3RhcnRZZWFyIjsKICAgICAgICBPcGVuSlBBUXVl\ncnk8Pz4gcTEgPSBlbS5jcmVhdGVRdWVyeShqcHFsKTsKICAgICAgICBMaXN0\nIGwxID0gcTEuZ2V0UmVzdWx0TGlzdCgpOwogICAgICAgIAogICAgICAgIFBy\nZXBhcmVkUXVlcnkgcHEgPSBnZXRQcmVwYXJlZFF1ZXJ5Q2FjaGUoKS5nZXQo\nanBxbCk7CiAgICAgICAgYXNzZXJ0Tm90TnVsbChwcSk7CiAgICAgICAgT3Bl\nbkpQQVF1ZXJ5PD8+IHEyID0gZW0uY3JlYXRlUXVlcnkoanBxbCk7CiAgICAg\nICAgTGlzdCBsMiA9IHEyLmdldFJlc3VsdExpc3QoKTsKICAgICAgICAKICAg\nICAgICBhc3NlcnRFcXVhbHMobDEuc2l6ZSgpLCBsMi5zaXplKCkpOwogICAg\nICAgIGFzc2VydEVxdWFscyhsMS50b1N0cmluZygpLCBsMi50b1N0cmluZygp\nKTsKCX0KCQoJcHVibGljIHZvaWQgdGVzdEV4Y2x1c2lvblBhdHRlcm4oKSB7\nCgkJT3BlbkpQQVF1ZXJ5PD8+IHExID0gZW0uY3JlYXRlUXVlcnkoRVhDTFVE\nRURfUVVFUllfMSk7CgkJcTEuZ2V0UmVzdWx0TGlzdCgpOwoJCWFzc2VydE5v\ndENhY2hlZChFWENMVURFRF9RVUVSWV8xKTsKCQkKCQlPcGVuSlBBUXVlcnk8\nPz4gcTIgPSBlbS5jcmVhdGVRdWVyeShFWENMVURFRF9RVUVSWV8yKTsKCQlx\nMi5nZXRSZXN1bHRMaXN0KCk7CgkJYXNzZXJ0Tm90Q2FjaGVkKEVYQ0xVREVE\nX1FVRVJZXzIpOwoJCQoJCU9wZW5KUEFRdWVyeTw/PiBxMyA9IGVtLmNyZWF0\nZVF1ZXJ5KElOQ0xVREVEX1FVRVJZKTsKCQlxMy5nZXRSZXN1bHRMaXN0KCk7\nCgkJYXNzZXJ0Q2FjaGVkKElOQ0xVREVEX1FVRVJZKTsKCX0KCQoJdm9pZCBh\nc3NlcnRMYW5ndWFnZShPcGVuSlBBUXVlcnk8Pz4gcSwgU3RyaW5nIGxhbmcp\nIHsKCQlhc3NlcnRFcXVhbHMobGFuZywgcS5nZXRMYW5ndWFnZSgpKTsKCX0K\nCQoJdm9pZCBhc3NlcnRDYWNoZWQoU3RyaW5nIGlkKSB7CgkJUHJlcGFyZWRR\ndWVyeSBjYWNoZWQgPSBnZXRQcmVwYXJlZFF1ZXJ5Q2FjaGUoKS5nZXQoaWQp\nOwoJCWFzc2VydE5vdE51bGwoZ2V0UHJlcGFyZWRRdWVyeUNhY2hlKCkgKyAi\nOiAiICsgZ2V0UHJlcGFyZWRRdWVyeUNhY2hlKCkuZ2V0TWFwVmlldygpICsg\nCgkJCQkiIGRvZXMgbm90IGNvbnRhaW4gIiArIGlkLCBjYWNoZWQpOwoJfQoJ\nCgl2b2lkIGFzc2VydE5vdENhY2hlZChTdHJpbmcgaWQpIHsKCSAgICBQcmVw\nYXJlZFF1ZXJ5Q2FjaGUgY2FjaGUgPSBnZXRQcmVwYXJlZFF1ZXJ5Q2FjaGUo\nKTsKCQlpZiAoY2FjaGUgIT0gbnVsbCkgewoJCQlhc3NlcnROdWxsKGNhY2hl\nLmdldChpZCkpOwoJCX0KCX0KCQoJcHVibGljIHZvaWQgdGVzdFByZXBhcmVk\nUXVlcnlJc0NhY2hlZE9uRXhlY3V0aW9uKCkgewoJCVN0cmluZyBqcHFsID0g\nInNlbGVjdCBwIGZyb20gQ29tcGFueSBwIjsKCQlPcGVuSlBBUXVlcnk8Pz4g\ncTEgPSBlbS5jcmVhdGVRdWVyeShqcHFsKTsKCQlhc3NlcnROb3RDYWNoZWQo\nanBxbCk7CgkJYXNzZXJ0TGFuZ3VhZ2UocTEsIEpQUUxQYXJzZXIuTEFOR19K\nUFFMKTsKCQkKCQlxMS5nZXRSZXN1bHRMaXN0KCk7CgkJYXNzZXJ0Q2FjaGVk\nKGpwcWwpOwoJCWFzc2VydExhbmd1YWdlKHExLCBKUFFMUGFyc2VyLkxBTkdf\nSlBRTCk7CgkJCgkJUHJlcGFyZWRRdWVyeSBjYWNoZWQgPSBnZXRQcmVwYXJl\nZFF1ZXJ5Q2FjaGUoKS5nZXQoanBxbCk7CgkJYXNzZXJ0RXF1YWxzKGpwcWws\nIGNhY2hlZC5nZXRJZGVudGlmaWVyKCkpOwoJCWFzc2VydEZhbHNlKGpwcWwu\nZXF1YWxzSWdub3JlQ2FzZShjYWNoZWQuZ2V0VGFyZ2V0UXVlcnkoKSkpOwoJ\nfQoKCXB1YmxpYyB2b2lkIHRlc3RQcmVwYXJlZFF1ZXJ5SXNDYWNoZWRBY3Jv\nc3NFeGVjdXRpb24oKSB7CgkJU3RyaW5nIGpwcWwgPSAic2VsZWN0IHAgZnJv\nbSBDb21wYW55IHAiOwoJCU9wZW5KUEFRdWVyeTw/PiBxMSA9IGVtLmNyZWF0\nZVF1ZXJ5KGpwcWwpOwoJCWFzc2VydE5vdENhY2hlZChqcHFsKTsKCQlhc3Nl\ncnRMYW5ndWFnZShxMSwgSlBRTFBhcnNlci5MQU5HX0pQUUwpOwoJCQoJCQoJ\nCXExLmdldFJlc3VsdExpc3QoKTsKCQlhc3NlcnRDYWNoZWQoanBxbCk7CgkJ\nYXNzZXJ0TGFuZ3VhZ2UocTEsIEpQUUxQYXJzZXIuTEFOR19KUFFMKTsKCQkK\nCQkvLyBDcmVhdGUgYSBuZXcgcXVlcnkgd2l0aCB0aGUgc2FtZSBKUFFMCgkJ\nLy8gVGhpcyBpcyBub3Qgb25seSBjYWNoZWQsIGl0cyBsYW5ndWFnZSBpcyBk\naWZmZXJlbnQgdG9vCgkJT3BlbkpQQVF1ZXJ5PD8+IHEyID0gZW0uY3JlYXRl\nUXVlcnkoanBxbCk7CgkJYXNzZXJ0Q2FjaGVkKGpwcWwpOwoJCWFzc2VydExh\nbmd1YWdlKHEyLCBRdWVyeUxhbmd1YWdlcy5MQU5HX1BSRVBBUkVEX1NRTCk7\nCgl9CgkKCXB1YmxpYyB2b2lkIHRlc3RJbnZhbGlkYXRlUHJlcGFyZWRRdWVy\neVdpdGhIaW50KCkgewoJCVN0cmluZyBqcHFsID0gInNlbGVjdCBwIGZyb20g\nQ29tcGFueSBwIjsKCQlPcGVuSlBBUXVlcnk8Pz4gcTEgPSBlbS5jcmVhdGVR\ndWVyeShqcHFsKTsKCQlhc3NlcnROb3RDYWNoZWQoanBxbCk7CgkJCgkJcTEu\nZ2V0UmVzdWx0TGlzdCgpOwoJCWFzc2VydENhY2hlZChqcHFsKTsKCQlhc3Nl\ncnRMYW5ndWFnZShxMSwgSlBRTFBhcnNlci5MQU5HX0pQUUwpOwoJCQoJCS8v\nIENyZWF0ZSBhIG5ldyBxdWVyeSB3aXRoIHRoZSBzYW1lIEpQUUwKCQkvLyBU\naGlzIGlzIGNhY2hlZCBvbiBjcmVhdGlvbiwgaXRzIGxhbmd1YWdlIGlzIFBy\nZXBhcmVkIFNRTAoJCU9wZW5KUEFRdWVyeTw/PiBxMiA9IGVtLmNyZWF0ZVF1\nZXJ5KGpwcWwpOwoJCWFzc2VydENhY2hlZChqcHFsKTsKCQlhc3NlcnRMYW5n\ndWFnZShxMiwgUXVlcnlMYW5ndWFnZXMuTEFOR19QUkVQQVJFRF9TUUwpOwoJ\nCXEyLmdldFJlc3VsdExpc3QoKTsKCQkKCQkvLyBOb3cgZXhlY3V0ZSB3aXRo\nIGhpbnRzIHRvIGludmFsaWRhdGUuIAoJCXEyLnNldEhpbnQoUXVlcnlIaW50\ncy5ISU5UX0lOVkFMSURBVEVfUFJFUEFSRURfUVVFUlksIHRydWUpOwoJCS8v\nIEltbWVkaWF0ZWx5IGl0IHNob3VsZCBiZSByZW1vdmVkIGZyb20gdGhlIGNh\nY2hlCgkJYXNzZXJ0Tm90Q2FjaGVkKGpwcWwpOwoJCWFzc2VydEVxdWFscyhK\nUFFMUGFyc2VyLkxBTkdfSlBRTCwgcTIuZ2V0TGFuZ3VhZ2UoKSk7CgkJcTIu\nZ2V0UmVzdWx0TGlzdCgpOwoJCQoJCS8vIENyZWF0ZSBhIG5ldyBxdWVyeSB3\naXRoIHRoZSBzYW1lIEpQUUwKCQkvLyBUaGlzIGlzIG5vdCBjYWNoZWQgb24g\nY3JlYXRpb24sIGl0cyBsYW5ndWFnZSBpcyBKUFFMCgkJT3BlbkpQQVF1ZXJ5\nPD8+IHEzID0gZW0uY3JlYXRlUXVlcnkoanBxbCk7CgkJYXNzZXJ0Tm90Q2Fj\naGVkKGpwcWwpOwoJCWFzc2VydExhbmd1YWdlKHEzLCBKUFFMUGFyc2VyLkxB\nTkdfSlBRTCk7Cgl9CgkKCXB1YmxpYyB2b2lkIHRlc3RJZ25vcmVQcmVwYXJl\nZFF1ZXJ5V2l0aEhpbnQoKSB7CgkJU3RyaW5nIGpwcWwgPSAic2VsZWN0IHAg\nZnJvbSBDb21wYW55IHAiOwoJCU9wZW5KUEFRdWVyeTw/PiBxMSA9IGVtLmNy\nZWF0ZVF1ZXJ5KGpwcWwpOwoJCWFzc2VydE5vdENhY2hlZChqcHFsKTsKCQkK\nCQlxMS5nZXRSZXN1bHRMaXN0KCk7CgkJYXNzZXJ0Q2FjaGVkKGpwcWwpOwoJ\nCWFzc2VydExhbmd1YWdlKHExLCBKUFFMUGFyc2VyLkxBTkdfSlBRTCk7CgkJ\nCgkJLy8gQ3JlYXRlIGEgbmV3IHF1ZXJ5IHdpdGggdGhlIHNhbWUgSlBRTAoJ\nCS8vIFRoaXMgaXMgY2FjaGVkIG9uIGNyZWF0aW9uLCBpdHMgbGFuZ3VhZ2Ug\naXMgUFJFUEFSRUQgU1FMCgkJT3BlbkpQQVF1ZXJ5PD8+IHEyID0gZW0uY3Jl\nYXRlUXVlcnkoanBxbCk7CgkJYXNzZXJ0Q2FjaGVkKGpwcWwpOwoJCWFzc2Vy\ndExhbmd1YWdlKHEyLCBRdWVyeUxhbmd1YWdlcy5MQU5HX1BSRVBBUkVEX1NR\nTCk7CgkJcTIuZ2V0UmVzdWx0TGlzdCgpOwoJCQoJCS8vIE5vdyBleGVjdXRl\nIHdpdGggaGludHMgdG8gaWdub3JlLiAKCQlxMi5zZXRIaW50KFF1ZXJ5SGlu\ndHMuSElOVF9JR05PUkVfUFJFUEFSRURfUVVFUlksIHRydWUpOwoJCS8vIEl0\nIHNob3VsZCByZW1haW4gaW4gdGhlIGNhY2hlCgkJYXNzZXJ0Q2FjaGVkKGpw\ncWwpOwoJCS8vIEJ1dCBpdHMgbGFuZ3VhZ2Ugc2hvdWxkIGJlIEpQUUwgYW5k\nIG5vdCBQUkVQQVJFRCBTUUwKCQlhc3NlcnRFcXVhbHMoSlBRTFBhcnNlci5M\nQU5HX0pQUUwsIHEyLmdldExhbmd1YWdlKCkpOwoJCXEyLmdldFJlc3VsdExp\nc3QoKTsKCQkKCQkvLyBDcmVhdGUgYSBuZXcgcXVlcnkgd2l0aCB0aGUgc2Ft\nZSBKUFFMCgkJLy8gVGhpcyBpcyBjYWNoZWQgb24gY3JlYXRpb24sIGl0cyBs\nYW5ndWFnZSBpcyBQUkVQQVJFRCBTUUwKCQlPcGVuSlBBUXVlcnk8Pz4gcTMg\nPSBlbS5jcmVhdGVRdWVyeShqcHFsKTsKCQlhc3NlcnRDYWNoZWQoanBxbCk7\nCgkJYXNzZXJ0TGFuZ3VhZ2UocTMsIFF1ZXJ5TGFuZ3VhZ2VzLkxBTkdfUFJF\nUEFSRURfU1FMKTsKCX0KCglwdWJsaWMgdm9pZCB0ZXN0UXVlcnlTdGF0aXN0\naWNzKCkgewogICAgICAgIFF1ZXJ5U3RhdGlzdGljczxTdHJpbmc+IHN0YXRz\nID0gZ2V0UHJlcGFyZWRRdWVyeUNhY2hlKCkuZ2V0U3RhdGlzdGljcygpOwog\nICAgICAgIHN0YXRzLnJlc2V0KCk7CgogICAgICAgIFN0cmluZyBqcHFsMSA9\nICJzZWxlY3QgYyBmcm9tIENvbXBhbnkgYyI7CiAgICAgICAgU3RyaW5nIGpw\ncWwyID0gInNlbGVjdCBjIGZyb20gQ29tcGFueSBjIHdoZXJlIGMubmFtZSA9\nICdQT2JqZWN0JyI7CgkJaW50IE4xID0gNTsKCQlpbnQgTjIgPSA4OwoJCWZv\nciAoaW50IGkgPSAwOyBpIDwgTjE7IGkrKykgewoJICAgICAgICBPcGVuSlBB\nUXVlcnk8Pz4gcTEgPSBlbS5jcmVhdGVRdWVyeShqcHFsMSk7CgkJCXExLmdl\ndFJlc3VsdExpc3QoKTsKCQl9CgkJZm9yIChpbnQgaSA9IDA7IGkgPCBOMjsg\naSsrKSB7CgkgICAgICAgIE9wZW5KUEFRdWVyeTw/PiBxMiA9IGVtLmNyZWF0\nZVF1ZXJ5KGpwcWwyKTsKCQkJcTIuZ2V0UmVzdWx0TGlzdCgpOwoJCX0KCQkK\nCQlhc3NlcnRFcXVhbHMoTjEsICAgICAgc3RhdHMuZ2V0RXhlY3V0aW9uQ291\nbnQoanBxbDEpKTsKCQlhc3NlcnRFcXVhbHMoTjIsICAgICAgc3RhdHMuZ2V0\nRXhlY3V0aW9uQ291bnQoanBxbDIpKTsKCQlhc3NlcnRFcXVhbHMoTjErTjIs\nICAgc3RhdHMuZ2V0RXhlY3V0aW9uQ291bnQoKSk7CgkJYXNzZXJ0RXF1YWxz\nKE4xLTEsICAgIHN0YXRzLmdldEhpdENvdW50KGpwcWwxKSk7CgkJYXNzZXJ0\nRXF1YWxzKE4yLTEsICAgIHN0YXRzLmdldEhpdENvdW50KGpwcWwyKSk7CgkJ\nYXNzZXJ0RXF1YWxzKE4xK04yLTIsIHN0YXRzLmdldEhpdENvdW50KCkpOwoJ\nCQoJfQoKCXB1YmxpYyB2b2lkIHRlc3RSZXNldFF1ZXJ5U3RhdGlzdGljcygp\nIHsKICAgICAgICBRdWVyeVN0YXRpc3RpY3M8U3RyaW5nPiBzdGF0cyA9IGdl\ndFByZXBhcmVkUXVlcnlDYWNoZSgpLmdldFN0YXRpc3RpY3MoKTsKICAgICAg\nICBzdGF0cy5yZXNldCgpOwogICAgICAgIAoJCVN0cmluZyBqcHFsMSA9ICJz\nZWxlY3QgYyBmcm9tIENvbXBhbnkgYyI7CiAgICAgICAgU3RyaW5nIGpwcWwy\nID0gInNlbGVjdCBjIGZyb20gQ29tcGFueSBjIHdoZXJlIGMubmFtZSA9ICdQ\nT2JqZWN0JyI7CgkJaW50IE4xMCA9IDQ7CgkJaW50IE4yMCA9IDc7CgkJZm9y\nIChpbnQgaSA9IDA7IGkgPCBOMTA7IGkrKykgewoJICAgICAgICBPcGVuSlBB\nUXVlcnk8Pz4gcTEgPSBlbS5jcmVhdGVRdWVyeShqcHFsMSk7CgkJCXExLmdl\ndFJlc3VsdExpc3QoKTsKCQl9CgkJZm9yIChpbnQgaSA9IDA7IGkgPCBOMjA7\nIGkrKykgewoJICAgICAgICBPcGVuSlBBUXVlcnk8Pz4gcTIgPSBlbS5jcmVh\ndGVRdWVyeShqcHFsMik7CgkJCXEyLmdldFJlc3VsdExpc3QoKTsKCQl9CgkJ\nCgkJYXNzZXJ0RXF1YWxzKE4xMCwgICAgICAgc3RhdHMuZ2V0RXhlY3V0aW9u\nQ291bnQoanBxbDEpKTsKCQlhc3NlcnRFcXVhbHMoTjIwLCAgICAgICBzdGF0\ncy5nZXRFeGVjdXRpb25Db3VudChqcHFsMikpOwoJCWFzc2VydEVxdWFscyhO\nMTArTjIwLCAgIHN0YXRzLmdldEV4ZWN1dGlvbkNvdW50KCkpOwoJCWFzc2Vy\ndEVxdWFscyhOMTAtMSwgICAgIHN0YXRzLmdldEhpdENvdW50KGpwcWwxKSk7\nCgkJYXNzZXJ0RXF1YWxzKE4yMC0xLCAgICAgc3RhdHMuZ2V0SGl0Q291bnQo\nanBxbDIpKTsKCQlhc3NlcnRFcXVhbHMoTjEwK04yMC0yLCBzdGF0cy5nZXRI\naXRDb3VudCgpKTsKCQkKCQlzdGF0cy5yZXNldCgpOwoJCQoJCWludCBOMTEg\nPSA3OwoJCWludCBOMjEgPSA0OwoJCWZvciAoaW50IGkgPSAwOyBpIDwgTjEx\nOyBpKyspIHsKICAgICAgICAgICAgT3BlbkpQQVF1ZXJ5PD8+IHExID0gZW0u\nY3JlYXRlUXVlcnkoanBxbDEpOwoJCQlxMS5nZXRSZXN1bHRMaXN0KCk7CgkJ\nfQoJCWZvciAoaW50IGkgPSAwOyBpIDwgTjIxOyBpKyspIHsKICAgICAgICAg\nICAgT3BlbkpQQVF1ZXJ5PD8+IHEyID0gZW0uY3JlYXRlUXVlcnkoanBxbDIp\nOwoJCQlxMi5nZXRSZXN1bHRMaXN0KCk7CgkJfQoKCQlhc3NlcnRFcXVhbHMo\nTjExLCAgICAgc3RhdHMuZ2V0RXhlY3V0aW9uQ291bnQoanBxbDEpKTsKCQlh\nc3NlcnRFcXVhbHMoTjIxLCAgICAgc3RhdHMuZ2V0RXhlY3V0aW9uQ291bnQo\nanBxbDIpKTsKCQlhc3NlcnRFcXVhbHMoTjExK04yMSwgc3RhdHMuZ2V0RXhl\nY3V0aW9uQ291bnQoKSk7CgkJYXNzZXJ0RXF1YWxzKE4xMSwgICAgIHN0YXRz\nLmdldEhpdENvdW50KGpwcWwxKSk7CgkJYXNzZXJ0RXF1YWxzKE4yMSwgICAg\nIHN0YXRzLmdldEhpdENvdW50KGpwcWwyKSk7CgkJYXNzZXJ0RXF1YWxzKE4x\nMStOMjEsIHN0YXRzLmdldEhpdENvdW50KCkpOwoJCQovLwkJYXNzZXJ0RXF1\nYWxzKE4xMCtOMTEsICAgICBzdGF0cy5nZXRUb3RhbEV4ZWN1dGlvbkNvdW50\nKGpwcWwxKSk7Ci8vCQlhc3NlcnRFcXVhbHMoTjIwK04yMSwgICAgIHN0YXRz\nLmdldFRvdGFsRXhlY3V0aW9uQ291bnQoanBxbDIpKTsKLy8JCWFzc2VydEVx\ndWFscyhOMTArTjExK04yMCtOMjEsIHN0YXRzLmdldFRvdGFsRXhlY3V0aW9u\nQ291bnQoKSk7CgkJYXNzZXJ0RXF1YWxzKE4xMCtOMTEtMSwgICAgIHN0YXRz\nLmdldFRvdGFsSGl0Q291bnQoanBxbDEpKTsKCQlhc3NlcnRFcXVhbHMoTjIw\nK04yMS0xLCAgICAgc3RhdHMuZ2V0VG90YWxIaXRDb3VudChqcHFsMikpOwoJ\nCWFzc2VydEVxdWFscyhOMTArTjExK04yMCtOMjEtMiwgc3RhdHMuZ2V0VG90\nYWxIaXRDb3VudCgpKTsKCQkKCX0KCglwdWJsaWMgdm9pZCB0ZXN0UXVlcnlX\naXRoTm9QYXJhbWV0ZXIoKSB7CgkJU3RyaW5nIGpwcWwgPSAic2VsZWN0IHAg\nZnJvbSBDb21wYW55IHAiOwoJCWNvbXBhcmUoanBxbCwgIUlTX05BTUVEX1FV\nRVJZKTsKCX0KCglwdWJsaWMgdm9pZCB0ZXN0UXVlcnlXaXRoTGl0ZXJhbCgp\nIHsKICAgICAgICBTdHJpbmcganBxbCA9ICJzZWxlY3QgcCBmcm9tIENvbXBh\nbnkgcCB3aGVyZSBwLm5hbWUgPSAiICsgbGl0ZXJhbChDT01QQU5ZX05BTUVT\nWzBdKTsKCQljb21wYXJlKGpwcWwsICFJU19OQU1FRF9RVUVSWSk7Cgl9CgoJ\ncHVibGljIHZvaWQgdGVzdFF1ZXJ5V2l0aFBhcmFtZXRlcigpIHsKCQlTdHJp\nbmcganBxbCA9ICJzZWxlY3QgcCBmcm9tIENvbXBhbnkgcCB3aGVyZSBwLm5h\nbWUgPSA6cGFyYW0iOwoJCU9iamVjdFtdIHBhcmFtcyA9IHsicGFyYW0iLCBD\nT01QQU5ZX05BTUVTWzBdfTsKCQljb21wYXJlKGpwcWwsICFJU19OQU1FRF9R\nVUVSWSwgIHBhcmFtcyk7Cgl9CgoJcHVibGljIHZvaWQgdGVzdFF1ZXJ5V2l0\naEpvaW5zQW5kUGFyYW1ldGVycygpIHsKICAgICAgICBTdHJpbmcganBxbCA9\nICJzZWxlY3QgZSBmcm9tIEVtcGxveWVlIGUgIiArICJ3aGVyZSBlLm5hbWUg\nPSA6ZW1wIgoJCQkJCSsgIiBhbmQgZS5kZXBhcnRtZW50Lm5hbWUgPSA6ZGVw\ndCIKICAgICAgICAgICAgICAgICAgICArICIgYW5kIGUuZGVwYXJ0bWVudC5j\nb21wYW55Lm5hbWUgTElLRSAgIgogICAgICAgICAgICAgICAgICAgICsgbGl0\nZXJhbChDT01QQU5ZX05BTUVTWzBdKSAKCQkJCQkrICIgYW5kIGUuYWRkcmVz\ncy5jaXR5ID0gOmNpdHkiOwoJCU9iamVjdFtdIHBhcmFtcyA9IHsgImVtcCIs\nIEVNUExPWUVFX05BTUVTWzBdLCAKICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICJkZXB0IiwgREVQQVJUTUVOVF9OQU1FU1swXSwKCQkJCQkJCSJjaXR5\nIiwgQ0lUWV9OQU1FU1swXX07CgkJY29tcGFyZShqcHFsLCAhSVNfTkFNRURf\nUVVFUlksICBwYXJhbXMpOwoJfQoKCXB1YmxpYyB2b2lkIHRlc3ROYW1lZFF1\nZXJ5V2l0aE5vUGFyYW1ldGVyKCkgewoJCVN0cmluZyBuYW1lZFF1ZXJ5ID0g\nIkNvbXBhbnkuUHJlcGFyZWRRdWVyeVdpdGhOb1BhcmFtZXRlciI7CiAgICAg\nICAgY29tcGFyZShuYW1lZFF1ZXJ5LCBJU19OQU1FRF9RVUVSWSk7Cgl9CgoJ\ncHVibGljIHZvaWQgdGVzdE5hbWVkUXVlcnlXaXRoTGl0ZXJhbCgpIHsKCQlT\ndHJpbmcgbmFtZWRRdWVyeSA9ICJDb21wYW55LlByZXBhcmVkUXVlcnlXaXRo\nTGl0ZXJhbCI7CgkJY29tcGFyZShuYW1lZFF1ZXJ5LCBJU19OQU1FRF9RVUVS\nWSk7Cgl9CgoJcHVibGljIHZvaWQgdGVzdE5hbWVkUXVlcnlXaXRoUG9zaXRp\nb25hbFBhcmFtZXRlcigpIHsKICAgICAgICBTdHJpbmcgbmFtZWRRdWVyeSA9\nICJDb21wYW55LlByZXBhcmVkUXVlcnlXaXRoUG9zaXRpb25hbFBhcmFtZXRl\nciI7CgkJT2JqZWN0W10gcGFyYW1zID0gezEsIENPTVBBTllfTkFNRVNbMF0s\nIDIsIFNUQVJUX1lFQVJTWzBdfTsKCQljb21wYXJlKG5hbWVkUXVlcnksIElT\nX05BTUVEX1FVRVJZLCAgcGFyYW1zKTsKCX0KCQoJcHVibGljIHZvaWQgdGVz\ndE5hbWVkUXVlcnlXaXRoTmFtZWRQYXJhbWV0ZXIoKSB7CgkJU3RyaW5nIG5h\nbWVkUXVlcnkgPSAiQ29tcGFueS5QcmVwYXJlZFF1ZXJ5V2l0aE5hbWVkUGFy\nYW1ldGVyIjsKICAgICAgICBPYmplY3RbXSBwYXJhbXMgPSB7Im5hbWUiLCBD\nT01QQU5ZX05BTUVTWzBdLCAic3RhcnRZZWFyIiwKICAgICAgICAgICAgICAg\nIFNUQVJUX1lFQVJTWzBdfTsKCQljb21wYXJlKG5hbWVkUXVlcnksIElTX05B\nTUVEX1FVRVJZLCAgcGFyYW1zKTsKCX0KCQoJcHVibGljIHZvaWQgdGVzdFBl\ncnNpc3RlbmNlQ2FwYWJsZVBhcmFtZXRlcigpIHsKICAgICAgICBTdHJpbmcg\nanBxbCA9ICJzZWxlY3QgZSBmcm9tIEVtcGxveWVlIGUgIiArCiAgICAgICAg\nICAgICAgICAid2hlcmUgZS5kZXBhcnRtZW50LmNvbXBhbnk9OmNvbXBhbnki\nOwoJICAgIE9iamVjdFtdIHBhcmFtcyA9IHsiY29tcGFueSIsIElCTX07Cgkg\nICAgY29tcGFyZShqcHFsLCAhSVNfTkFNRURfUVVFUlksICBwYXJhbXMpOwoJ\nfQoJCgkvKioKCSAqIFByb2plY3QgcmVzdWx0cyBhcmUgcmV0dXJuZWQgd2l0\naCBkaWZmZXJlbnQgdHlwZXMgb2YgUk9QLgoJICovCglwdWJsaWMgdm9pZCB0\nZXN0UHJvamVjdGlvblJlc3VsdCgpIHsKICAgICAgICBTdHJpbmcganBxbCA9\nICJzZWxlY3QgZS5uYW1lIGZyb20gRW1wbG95ZWUgZSAiICsKICAgICAgICAg\nICAgICAgICJ3aGVyZSBlLmFkZHJlc3MuY2l0eT06Y2l0eSI7CiAgICAgICAg\nT2JqZWN0W10gcGFyYW1zID0geyJjaXR5IiwgQ0lUWV9OQU1FU1swXX07CiAg\nICAgICAgY29tcGFyZShqcHFsLCAhSVNfTkFNRURfUVVFUlksIHBhcmFtcyk7\nCgl9CgkKCXB1YmxpYyB2b2lkIHRlc3RDb2xsZWN0aW9uVmFsdWVkUGFyYW1l\ndGVycygpIHsKCSAgICBTdHJpbmcganBxbCA9ICJzZWxlY3QgZSBmcm9tIEVt\ncGxveWVlIGUgd2hlcmUgZS5uYW1lIGluIDpuYW1lcyI7CgkgICAgT2JqZWN0\nW10gcGFyYW1zMSA9IHsibmFtZXMiLAoJICAgICAgICAgICAgQXJyYXlzLmFz\nTGlzdChuZXcgU3RyaW5nW117RU1QTE9ZRUVfTkFNRVNbMF0sCgkgICAgICAg\nICAgICBFTVBMT1lFRV9OQU1FU1sxXX0pfTsKICAgICAgICBPYmplY3RbXSBw\nYXJhbXMyID0geyJuYW1lcyIsCiAgICAgICAgICAgICAgICBBcnJheXMuYXNM\naXN0KG5ldyBTdHJpbmdbXXtFTVBMT1lFRV9OQU1FU1syXX0pfTsKICAgICAg\nICBPYmplY3RbXSBwYXJhbXMzID0geyJuYW1lcyIsIEFycmF5cy5hc0xpc3Qo\nRU1QTE9ZRUVfTkFNRVMpfTsKICAgICAgICAKICAgICAgICBpbnQgZXhwZWN0\nZWRDb3VudCA9IDIgKiBDT01QQU5ZX05BTUVTLmxlbmd0aCAqIERFUEFSVE1F\nTlRfTkFNRVMubGVuZ3RoOwogICAgICAgIHJ1bihqcHFsLCAhSVNfTkFNRURf\nUVVFUlksIHBhcmFtczEsIGV4cGVjdGVkQ291bnQsIFVTRV9DQUNIRSwgMSk7\nCiAgICAgICAgCiAgICAgICAgZXhwZWN0ZWRDb3VudCA9IDEgKiBDT01QQU5Z\nX05BTUVTLmxlbmd0aCAqIERFUEFSVE1FTlRfTkFNRVMubGVuZ3RoOwogICAg\nICAgIHJ1bihqcHFsLCAhSVNfTkFNRURfUVVFUlksIHBhcmFtczIsIGV4cGVj\ndGVkQ291bnQsIFVTRV9DQUNIRSwgMSk7CiAgICAgICAgCiAgICAgICAgZXhw\nZWN0ZWRDb3VudCA9IEVNUExPWUVFX05BTUVTLmxlbmd0aCAqIENPTVBBTllf\nTkFNRVMubGVuZ3RoICogREVQQVJUTUVOVF9OQU1FUy5sZW5ndGg7CiAgICAg\nICAgcnVuKGpwcWwsICFJU19OQU1FRF9RVUVSWSwgcGFyYW1zMywgZXhwZWN0\nZWRDb3VudCwgVVNFX0NBQ0hFLCAxKTsKCX0KCQogICAgcHVibGljIHZvaWQg\ndGVzdFF1ZXJ5UHJvamVjdGlvbk5vdENhbmRpZGF0ZUNsYXNzKCkgewogICAg\nICAgIFN0cmluZyBqcHFsID0gInNlbGVjdCBlLmRlcGFydG1lbnQgZnJvbSBF\nbXBsb3llZSBlIjsKICAgICAgICBjb21wYXJlKGpwcWwsICFJU19OQU1FRF9R\nVUVSWSk7CiAgICB9CiAgICAKICAgIHB1YmxpYyB2b2lkIHRlc3RRdWVyeU11\nbHRpcGxlUHJvamVjdGlvbkNsYXNzKCkgewogICAgICAgIFN0cmluZyBqcHFs\nID0gInNlbGVjdCBkLCBlIGZyb20gRGVwYXJ0bWVudCBkLCBpbiAoZC5lbXBs\nb3llZXMpIGUiOwogICAgICAgIGNvbXBhcmUoanBxbCwgIUlTX05BTUVEX1FV\nRVJZKTsKICAgIH0KICAgIAogICAgcHVibGljIHZvaWQgdGVzdFF1ZXJ5V2l0\naE9yZGVyQnlDbGF1c2UoKSB7CiAgICAgICAgU3RyaW5nIGpwcWwgPSAic2Vs\nZWN0IGUubmFtZSBmcm9tIEVtcGxveWVlIGUgb3JkZXIgYnkgZS5pZCI7CiAg\nICAgICAgY29tcGFyZShqcHFsLCAhSVNfTkFNRURfUVVFUlkpOwogICAgfQog\nICAgCiAgICBwdWJsaWMgdm9pZCB0ZXN0UXVlcnlDb3VudCgpIHsKICAgICAg\nICBTdHJpbmcganBxbCA9ICJzZWxlY3QgY291bnQoZSksZCBmcm9tIERlcGFy\ndG1lbnQgZCBqb2luIGQuZW1wbG95ZWVzIGUgZ3JvdXAgYnkgZCI7CiAgICAg\nICAgY29tcGFyZShqcHFsLCAhSVNfTkFNRURfUVVFUlkpOwogICAgfQogICAg\nCiAgICBwdWJsaWMgdm9pZCB0ZXN0UHJvamVjdFJlcGVhdHNUZXJtKCkgewog\nICAgICAgIFN0cmluZyBqcHFsID0gInNlbGVjdCBlLm5hbWUsIGUubmFtZSBm\ncm9tIEVtcGxveWVlIGUiOwogICAgICAgIGNvbXBhcmUoanBxbCwgIUlTX05B\nTUVEX1FVRVJZKTsKICAgIH0KICAgIAogICAgcHVibGljIHZvaWQgdGVzdFBy\nb2plY3RFbWJlZGRlZCgpIHsKICAgICAgICBTdHJpbmcganBxbCA9ICJzZWxl\nY3QgZS5hZGRyZXNzIGZyb20gRW1wbG95ZWUgZSI7CiAgICAgICAgY29tcGFy\nZShqcHFsLCAhSVNfTkFNRURfUVVFUlkpOwogICAgfQogICAgCiAgICBwdWJs\naWMgdm9pZCB0ZXN0TmVlZHNUeXBlQ29udmVyc2lvbigpIHsKICAgICAgICBT\ndHJpbmcganBxbCA9ICJzZWxlY3QgZS5uYW1lLCBlLmlzTWFuYWdlciBmcm9t\nIEVtcGxveWVlIGUiOwogICAgICAgIGNvbXBhcmUoanBxbCwgIUlTX05BTUVE\nX1FVRVJZKTsKICAgIH0gICAgCgkKCVN0cmluZyBsaXRlcmFsKFN0cmluZyBz\nKSB7CgkgICAgcmV0dXJuICInIitzKyInIjsKCX0KCQogICAgcHVibGljIHZv\naWQgdGVzdFBvc2l0aW9uYWwoKSB7CiAgICAgICAgU3RyaW5nIGpwcWwgPSAi\nc2VsZWN0IHAgZnJvbSBQZXJzb24gcCB3aGVyZSBwLmZpcnN0TmFtZT0/MSIg\nKwogICAgICAgICAgICAgICAgICAgICAgIiBhbmQgcC5sYXN0TmFtZT0nRG9l\nJyBhbmQgcC5hZ2UgPiA/MiI7CiAgICAgICAgRW50aXR5TWFuYWdlciBlbSA9\nIGVtZi5jcmVhdGVFbnRpdHlNYW5hZ2VyKCk7CiAgICAgICAgCiAgICAgICAg\nT3BlbkpQQVF1ZXJ5PD8+IHExID0gT3BlbkpQQVBlcnNpc3RlbmNlLmNhc3Qo\nZW0uY3JlYXRlUXVlcnkoanBxbCkpOwogICAgICAgIGFzc2VydEVxdWFscyhK\nUFFMUGFyc2VyLkxBTkdfSlBRTCwgcTEuZ2V0TGFuZ3VhZ2UoKSk7CiAgICAg\nICAgCiAgICAgICAgTGlzdDw/PiByZXN1bHQxID0gcTEuc2V0UGFyYW1ldGVy\nKDEsICJKb2huIikKICAgICAgICAgICAgICAgICAgICAgICAuc2V0UGFyYW1l\ndGVyKDIsIChzaG9ydCk0MCkKICAgICAgICAgICAgICAgICAgICAgICAuZ2V0\nUmVzdWx0TGlzdCgpOwogICAgICAgIAogICAgICAgIGFzc2VydEVxdWFscygy\nLCByZXN1bHQxLnNpemUoKSk7CiAgICAgICAgCiAgICAgICAgT3BlbkpQQVF1\nZXJ5PD8+IHEyID0gT3BlbkpQQVBlcnNpc3RlbmNlLmNhc3QoZW0uY3JlYXRl\nUXVlcnkoanBxbCkpOwogICAgICAgIGFzc2VydEVxdWFscyhRdWVyeUxhbmd1\nYWdlcy5MQU5HX1BSRVBBUkVEX1NRTCwgcTIuZ2V0TGFuZ3VhZ2UoKSk7CiAg\nICAgICAgTGlzdDw/PiByZXN1bHQyID0gcTIuc2V0UGFyYW1ldGVyKDEsICJI\nYXJyeSIpCiAgICAgICAgICAgICAgICAgIC5zZXRQYXJhbWV0ZXIoMiwgKHNo\nb3J0KTEwKQogICAgICAgICAgICAgICAgICAuZ2V0UmVzdWx0TGlzdCgpOwog\nICAgICAgIAogICAgICAgIGFzc2VydEVxdWFscygxLCByZXN1bHQyLnNpemUo\nKSk7CiAgICB9CiAgICAKICAgIHB1YmxpYyB2b2lkIHRlc3ROYW1lZCgpIHsK\nICAgICAgICBTdHJpbmcganBxbCA9ICJzZWxlY3QgcCBmcm9tIFBlcnNvbiBw\nIHdoZXJlIHAuZmlyc3ROYW1lPTpmaXJzdCIgKwogICAgICAgICAgICAgICAg\nICAgICAgIiBhbmQgcC5sYXN0TmFtZT0nRG9lJyBhbmQgcC5hZ2UgPiA6YWdl\nIjsKICAgICAgICBFbnRpdHlNYW5hZ2VyIGVtID0gZW1mLmNyZWF0ZUVudGl0\neU1hbmFnZXIoKTsKICAgICAgICAKICAgICAgICBPcGVuSlBBUXVlcnk8Pz4g\ncTEgPSBPcGVuSlBBUGVyc2lzdGVuY2UuY2FzdChlbS5jcmVhdGVRdWVyeShq\ncHFsKSk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKEpQUUxQYXJzZXIuTEFOR19K\nUFFMLCBxMS5nZXRMYW5ndWFnZSgpKTsKICAgICAgICAKICAgICAgICBMaXN0\nPD8+IHJlc3VsdDEgPSBxMS5zZXRQYXJhbWV0ZXIoImZpcnN0IiwgIkpvaG4i\nKQogICAgICAgICAgICAgICAgICAgICAgIC5zZXRQYXJhbWV0ZXIoImFnZSIs\nIChzaG9ydCk0MCkKICAgICAgICAgICAgICAgICAgICAgICAuZ2V0UmVzdWx0\nTGlzdCgpOwogICAgICAgIAogICAgICAgIGFzc2VydEVxdWFscygyLCByZXN1\nbHQxLnNpemUoKSk7CiAgICAgICAgCiAgICAgICAgT3BlbkpQQVF1ZXJ5PD8+\nIHEyID0gT3BlbkpQQVBlcnNpc3RlbmNlLmNhc3QoZW0uY3JlYXRlUXVlcnko\nanBxbCkpOwogICAgICAgIGFzc2VydEVxdWFscyhRdWVyeUxhbmd1YWdlcy5M\nQU5HX1BSRVBBUkVEX1NRTCwgcTIuZ2V0TGFuZ3VhZ2UoKSk7CiAgICAgICAg\nTGlzdDw/PiByZXN1bHQyID0gcTIuc2V0UGFyYW1ldGVyKCJmaXJzdCIsICJC\nYXJyeSIpCiAgICAgICAgICAgICAgICAgIC5zZXRQYXJhbWV0ZXIoImFnZSIs\nIChzaG9ydCkyMCkKICAgICAgICAgICAgICAgICAgLmdldFJlc3VsdExpc3Qo\nKTsKICAgICAgICAKICAgICAgICBhc3NlcnRFcXVhbHMoMSwgcmVzdWx0Mi5z\naXplKCkpOwogICAgfQogICAgCiAgICBwdWJsaWMgdm9pZCB0ZXN0V3JvbmdQ\nYXJhbWV0ZXJWYWx1ZVR5cGVUaHJvd0V4Y2VwdGlvbigpIHsKICAgICAgICBT\ndHJpbmcganBxbCA9ICJzZWxlY3QgcCBmcm9tIFBlcnNvbiBwIHdoZXJlIHAu\nZmlyc3ROYW1lPTpmaXJzdCIgCiAgICAgICAgICAgICAgICAgICAgKyAiIGFu\nZCBwLmFnZSA+IDphZ2UiOwogICAgICAgIEVudGl0eU1hbmFnZXIgZW0gPSBl\nbWYuY3JlYXRlRW50aXR5TWFuYWdlcigpOwoKICAgICAgICBPcGVuSlBBUXVl\ncnk8Pz4gcTEgPSBPcGVuSlBBUGVyc2lzdGVuY2UuY2FzdChlbS5jcmVhdGVR\ndWVyeShqcHFsKSk7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgTGlzdDw/\nPiByZXN1bHQxID0gcTEuc2V0UGFyYW1ldGVyKCJmaXJzdCIsIChzaG9ydCk0\nMCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuc2V0UGFyYW1ldGVy\nKCJhZ2UiLCAiSm9obiIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nLmdldFJlc3VsdExpc3QoKTsKICAgICAgICAgICAgZmFpbCgiRXhwZWN0ZWQg\ndG8gZmFpbCB3aXRoIHdyb25nIHBhcmFtZXRlciB2YWx1ZSIpOwogICAgICAg\nIH0gY2F0Y2ggKElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiBlKSB7CiAgICAg\nICAgICAgIC8vIGdvb2QKICAgICAgICB9CiAgICB9CiAgICAKICAgIHB1Ymxp\nYyB2b2lkIHRlc3ROdWxsUGFyYW1ldGVyVmFsdWVGb3JQcmltaXRpdmVUeXBl\nVGhyb3dzRXhjZXB0aW9uKCkgewogICAgICAgIFN0cmluZyBqcHFsID0gInNl\nbGVjdCBwIGZyb20gUGVyc29uIHAgd2hlcmUgcC5maXJzdE5hbWU9OmZpcnN0\nIiAKICAgICAgICAgICAgICAgICAgICArICIgYW5kIHAuYWdlID4gOmFnZSI7\nCiAgICAgICAgRW50aXR5TWFuYWdlciBlbSA9IGVtZi5jcmVhdGVFbnRpdHlN\nYW5hZ2VyKCk7CgogICAgICAgIE9wZW5KUEFRdWVyeTw/PiBxMSA9IE9wZW5K\nUEFQZXJzaXN0ZW5jZS5jYXN0KGVtLmNyZWF0ZVF1ZXJ5KGpwcWwpKTsKICAg\nICAgICB0cnkgewogICAgICAgICAgICBMaXN0PD8+IHJlc3VsdDEgPSBxMS5z\nZXRQYXJhbWV0ZXIoImZpcnN0IiwgIkpvaG4iKQogICAgICAgICAgICAgICAg\nICAgICAgICAgICAgIC5zZXRQYXJhbWV0ZXIoImFnZSIsIG51bGwpCiAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgLmdldFJlc3VsdExpc3QoKTsKICAg\nICAgICAgICAgZmFpbCgiRXhwZWN0ZWQgdG8gZmFpbCB3aXRoIG51bGwgcGFy\nYW1ldGVyIHZhbHVlIGZvciBwcmltaXRpdmVzIik7CiAgICAgICAgfSBjYXRj\naCAoUnVudGltZUV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgIC8vIGdvb2QK\nICAgICAgICB9CiAgICB9CiAgICBwdWJsaWMgdm9pZCB0ZXN0UXVlcnlXaXRo\nTGF6eVJlbGF0aW9uSXNDYWNoZWQoKSB7CiAgICAgICAgLy8gQXV0aG9yIGlz\nIGxhemlseSByZWxhdGVkIHRvIEJvb2sKICAgICAgICBTdHJpbmcganBxbCA9\nICJzZWxlY3QgcCBmcm9tIEF1dGhvciBwIjsKICAgICAgICBFbnRpdHlNYW5h\nZ2VyIGVtID0gZW1mLmNyZWF0ZUVudGl0eU1hbmFnZXIoKTsKICAgICAgICAK\nICAgICAgICBRdWVyeSBxMSA9IGVtLmNyZWF0ZVF1ZXJ5KGpwcWwpOwogICAg\nICAgIGFzc2VydEVxdWFscyhPcGVuSlBBUGVyc2lzdGVuY2UuY2FzdChxMSku\nZ2V0TGFuZ3VhZ2UoKSwKICAgICAgICAgICAgICAgIEpQUUxQYXJzZXIuTEFO\nR19KUFFMKTsKICAgICAgICBMaXN0PEF1dGhvcj4gYXV0aG9yczEgPSBxMS5n\nZXRSZXN1bHRMaXN0KCk7CiAgICAgICAgYXNzZXJ0RmFsc2UoYXV0aG9yczEu\naXNFbXB0eSgpKTsKICAgICAgICBBdXRob3IgYXV0aG9yMSA9IGF1dGhvcnMx\nLml0ZXJhdG9yKCkubmV4dCgpOwogICAgICAgIGVtLmNsb3NlKCk7IC8vIG5v\ndGhpbmcgd2lsbCBiZSBsb2FkZWQgYnkgY2hhbmNlCiAgICAgICAgCiAgICAg\nICAgYXNzZXJ0TnVsbChhdXRob3IxLmdldEJvb2tzKCkpOwogICAgICAgIAog\nICAgICAgIC8vIGRvIHRoZSBzYW1lIHRoaW5nIGFnYWluLCB0aGlzIHRpbWUg\ncXVlcnkgc2hvdWxkIGJlIGNhY2hlZAogICAgICAgIGVtID0gZW1mLmNyZWF0\nZUVudGl0eU1hbmFnZXIoKTsKICAgICAgICBRdWVyeSBxMiA9IGVtLmNyZWF0\nZVF1ZXJ5KGpwcWwpOwogICAgICAgIGFzc2VydEVxdWFscyhPcGVuSlBBUGVy\nc2lzdGVuY2UuY2FzdChxMikuZ2V0TGFuZ3VhZ2UoKSwKICAgICAgICAgICAg\nICAgIFF1ZXJ5TGFuZ3VhZ2VzLkxBTkdfUFJFUEFSRURfU1FMKTsKICAgICAg\nICBMaXN0PEF1dGhvcj4gYXV0aG9yczIgPSBxMi5nZXRSZXN1bHRMaXN0KCk7\nCiAgICAgICAgYXNzZXJ0RmFsc2UoYXV0aG9yczIuaXNFbXB0eSgpKTsKICAg\nICAgICBBdXRob3IgYXV0aG9yMiA9IGF1dGhvcnMyLml0ZXJhdG9yKCkubmV4\ndCgpOwogICAgICAgIGVtLmNsb3NlKCk7CiAgICAgICAgCiAgICAgICAgYXNz\nZXJ0TnVsbChhdXRob3IyLmdldEJvb2tzKCkpOwogICAgfQogICAgCiAgICBw\ndWJsaWMgdm9pZCB0ZXN0UXVlcnlXaXRoRWFnZXJSZWxhdGlvbklzTm90Q2Fj\naGVkKCkgewogICAgICAgIC8vIEJvb2sgaXMgZWFnZXJseSByZWxhdGVkIHRv\nIEF1dGhvcgogICAgICAgIFN0cmluZyBqcHFsID0gInNlbGVjdCBiIGZyb20g\nQm9vayBiIjsKICAgICAgICBFbnRpdHlNYW5hZ2VyIGVtID0gZW1mLmNyZWF0\nZUVudGl0eU1hbmFnZXIoKTsKICAgICAgICAKICAgICAgICBRdWVyeSBxMSA9\nIGVtLmNyZWF0ZVF1ZXJ5KGpwcWwpOwogICAgICAgIGFzc2VydEVxdWFscyhP\ncGVuSlBBUGVyc2lzdGVuY2UuY2FzdChxMSkuZ2V0TGFuZ3VhZ2UoKSwKICAg\nICAgICAgICAgICAgIEpQUUxQYXJzZXIuTEFOR19KUFFMKTsKICAgICAgICBM\naXN0PEJvb2s+IGJvb2tzID0gcTEuZ2V0UmVzdWx0TGlzdCgpOwogICAgICAg\nIGFzc2VydEZhbHNlKGJvb2tzLmlzRW1wdHkoKSk7CiAgICAgICAgQm9vayBi\nb29rMSA9IGJvb2tzLml0ZXJhdG9yKCkubmV4dCgpOwogICAgICAgIGVtLmNs\nb3NlKCk7IC8vIG5vdGhpbmcgd2lsbCBiZSBsb2FkZWQgYnkgY2hhbmNlCiAg\nICAgICAgCiAgICAgICAgYXNzZXJ0Tm90TnVsbChib29rMS5nZXRBdXRob3Jz\nKCkpOwogICAgICAgIGFzc2VydEZhbHNlKGJvb2sxLmdldEF1dGhvcnMoKS5p\nc0VtcHR5KCkpOwogICAgICAgIAogICAgICAgIC8vIGRvIHRoZSBzYW1lIHRo\naW5nIGFnYWluLCB0aGlzIHRpbWUgcXVlcnkgc2hvdWxkIG5vdCBiZSBjYWNo\nZWQKICAgICAgICAvLyBiZWNhdXNlIGl0IHJlcXVpcmVzIG11bHRpcGxlIHNl\nbGVjdHMKICAgICAgICBlbSA9IGVtZi5jcmVhdGVFbnRpdHlNYW5hZ2VyKCk7\nCiAgICAgICAgUXVlcnkgcTIgPSBlbS5jcmVhdGVRdWVyeShqcHFsKTsKICAg\nICAgICBhc3NlcnRFcXVhbHMoT3BlbkpQQVBlcnNpc3RlbmNlLmNhc3QocTIp\nLmdldExhbmd1YWdlKCksCiAgICAgICAgICAgICAgICBKUFFMUGFyc2VyLkxB\nTkdfSlBRTCk7CiAgICAgICAgTGlzdDxCb29rPiBib29rczIgPSBxMi5nZXRS\nZXN1bHRMaXN0KCk7CiAgICAgICAgYXNzZXJ0RmFsc2UoYm9va3MyLmlzRW1w\ndHkoKSk7CiAgICAgICAgQm9vayBib29rMiA9IGJvb2tzMi5pdGVyYXRvcigp\nLm5leHQoKTsKICAgICAgICBlbS5jbG9zZSgpOwogICAgICAgIAogICAgICAg\nIGFzc2VydE5vdE51bGwoYm9vazIuZ2V0QXV0aG9ycygpKTsKICAgICAgICBh\nc3NlcnRGYWxzZShib29rMi5nZXRBdXRob3JzKCkuaXNFbXB0eSgpKTsKICAg\nIH0KCiAgICBwdWJsaWMgdm9pZCB0ZXN0UXVlcnlXaXRoVXNlckRlZmluZWRB\nbmRJbnRlcm5hbFBhcmFtdGVyc0luU3VicXVlcnkoKSB7CiAgICAgICAgU3Ry\naW5nIGpwcWwgPSAiU2VsZWN0IGEgRnJvbSBBZGRyZXNzIGEgV2hlcmUgTm90\nIEV4aXN0cyAoIgogICAgICAgICAgICArICIgICAgIFNlbGVjdCBzLmlkIEZy\nb20gU2luZ2VyIEFzIHMgV2hlcmUgIgogICAgICAgICAgICArICIgICAgICAg\nIHMuYWRkcmVzcyA9IGEgIEFuZCAiCiAgICAgICAgICAgICsgIiAgICAgICAg\nTm90ICgiCiAgICAgICAgICAgICsgIiAgICAgICAgICAgICAgKHMuZmlyc3RO\nYW1lID0gOmZpcnN0TmFtZSkgIgogICAgICAgICAgICArICIgICAgICAgICAg\nICAgIE9yICIKICAgICAgICAgICAgKyAiICAgICAgICAgICAgICAoIgogICAg\nICAgICAgICArICIgICAgICAgICAgICAgICAgICAoIgogICAgICAgICAgICAr\nICIgICAgICAgICAgICAgICAgICAgICAgZXhpc3RzIChzZWxlY3QgYy5pZCBm\ncm9tIENEIGMgd2hlcmUgYy5zaW5nZXIgPSBzIGFuZCBjLnN0YXR1cyA9IDEp\nIEFuZCAiCiAgICAgICAgICAgICsgIiAgICAgICAgICAgICAgICAgICAgICBz\nLmxhc3ROYW1lID0gOmxhc3ROYW1lIgogICAgICAgICAgICArICIgICAgICAg\nICAgICAgICAgICApICIKICAgICAgICAgICAgKyAiICAgICAgICAgICAgICAg\nICAgT3IgIgogICAgICAgICAgICArICIgICAgICAgICAgICAgICAgICAoIgog\nICAgICAgICAgICArICIgICAgICAgICAgICAgICAgICAgICAgbm90IGV4aXN0\ncyAoU2VsZWN0IGMuaWQgZnJvbSBDRCBjIHdoZXJlIGMuc2luZ2VyID0gcyBh\nbmQgYy5zdGF0dXMgPSAyKSIKICAgICAgICAgICAgKyAiICAgICAgICAgICAg\nICAgICAgKSIKICAgICAgICAgICAgKyAiICAgICAgICAgICAgICApIgogICAg\nICAgICAgICArICIgICAgICAgICAgICApIgogICAgICAgICAgICArICIgICAg\nICkiOwogICAgICAgIAogICAgICAgIFF1ZXJ5IGpRID0gZW0uY3JlYXRlUXVl\ncnkoanBxbCk7CiAgICAgICAgalEuc2V0UGFyYW1ldGVyKCJsYXN0TmFtZSIs\nICJMYXN0TmFtZSIpOwogICAgICAgIGpRLnNldFBhcmFtZXRlcigiZmlyc3RO\nYW1lIiwgIkZpcnN0TmFtZSIpOwogICAgICAgIExpc3Qgakxpc3QgPSBqUS5n\nZXRSZXN1bHRMaXN0KCk7CiAgICAgICAgCiAgICAgICAgUXVlcnkgalExID0g\nZW0uY3JlYXRlUXVlcnkoanBxbCk7CiAgICAgICAgalExLnNldFBhcmFtZXRl\ncigibGFzdE5hbWUiLCAiTGFzdE5hbWUxIik7CiAgICAgICAgalExLnNldFBh\ncmFtZXRlcigiZmlyc3ROYW1lIiwgIkZpcnN0TmFtZTEiKTsKICAgICAgICB0\ncnkgewogICAgICAgICAgICBMaXN0IGpMaXN0MSA9IGpRMS5nZXRSZXN1bHRM\naXN0KCk7CiAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAgICAg\nICAgICAgU3lzdGVtLmVyci5wcmludGxuKGpRMS5nZXRQYXJhbWV0ZXJzKCkp\nOwogICAgICAgICAgICBlLnByaW50U3RhY2tUcmFjZSgpOwogICAgICAgICAg\nICBmYWlsKCJGYWlsIHRvIGV4ZWN1dGUgYWdhaW4gLSBQYXJhbWV0ZXJzIGFy\nZSBtZXNzZWQgdXA6IiArIGUuZ2V0TWVzc2FnZSgpKTsKICAgICAgICB9CiAg\nICB9CiAgICAKICAgIHB1YmxpYyB2b2lkIHRlc3RQcmVwYXJlZFF1ZXJ5SWdu\nb3JlZFdoZW5Mb2NrTW9kZUlzU2V0KCkgewogICAgICAgIFN0cmluZyBqcHFs\nID0gInNlbGVjdCBwIGZyb20gQXV0aG9yIHAiOwogICAgICAgIEVudGl0eU1h\nbmFnZXIgZW0gPSBlbWYuY3JlYXRlRW50aXR5TWFuYWdlcigpOwogICAgICAg\nIAogICAgICAgIFF1ZXJ5IHExID0gZW0uY3JlYXRlUXVlcnkoanBxbCk7CiAg\nICAgICAgYXNzZXJ0RXF1YWxzKEpQUUxQYXJzZXIuTEFOR19KUFFMLCBPcGVu\nSlBBUGVyc2lzdGVuY2UuY2FzdChxMSkuZ2V0TGFuZ3VhZ2UoKSk7CiAgICAg\nICAgTGlzdDxBdXRob3I+IGF1dGhvcnMxID0gcTEuZ2V0UmVzdWx0TGlzdCgp\nOwogICAgICAgIAogICAgICAgIC8vIGRvIHRoZSBzYW1lIHRoaW5nIGFnYWlu\nLCB0aGlzIHRpbWUgcXVlcnkgc2hvdWxkIGJlIGNhY2hlZAogICAgICAgIGVt\nLmdldFRyYW5zYWN0aW9uKCkuYmVnaW4oKTsKICAgICAgICBRdWVyeSBxMiA9\nIGVtLmNyZWF0ZVF1ZXJ5KGpwcWwpOwogICAgICAgIGFzc2VydEVxdWFscyhR\ndWVyeUxhbmd1YWdlcy5MQU5HX1BSRVBBUkVEX1NRTCwgT3BlbkpQQVBlcnNp\nc3RlbmNlLmNhc3QocTIpLmdldExhbmd1YWdlKCkpOwogICAgICAgIExvY2tN\nb2RlVHlwZSBsbW9kZTEgPSBxMi5nZXRMb2NrTW9kZSgpOwogICAgICAgIHEy\nLnNldExvY2tNb2RlKExvY2tNb2RlVHlwZS5PUFRJTUlTVElDKTsKICAgICAg\nICBMb2NrTW9kZVR5cGUgbG1vZGUyID0gcTIuZ2V0TG9ja01vZGUoKTsKICAg\nICAgICBhc3NlcnRFcXVhbHMoSlBRTFBhcnNlci5MQU5HX0pQUUwsIE9wZW5K\nUEFQZXJzaXN0ZW5jZS5jYXN0KHEyKS5nZXRMYW5ndWFnZSgpKTsKICAgICAg\nICBhc3NlcnRGYWxzZShsbW9kZTEuZXF1YWxzKGxtb2RlMikpOwogICAgICAg\nIExpc3Q8QXV0aG9yPiBhdXRob3JzMiA9IHEyLmdldFJlc3VsdExpc3QoKTsK\nICAgICAgICBlbS5nZXRUcmFuc2FjdGlvbigpLnJvbGxiYWNrKCk7CiAgICB9\nCiAgICAKICAgIHB1YmxpYyB2b2lkIHRlc3RFbnVtUGFyYW1ldGVyKCkgewog\nICAgICAgIFN0cmluZyBqcHFsID0gInNlbGVjdCBlIGZyb20gRW1wbG95ZWUg\nZSB3aGVyZSBlLnN0YXR1cz06Y3VycmVudCBhbmQgZS5oaXJlU3RhdHVzPTpo\naXJlIjsKICAgICAgICBFbnRpdHlNYW5hZ2VyIGVtID0gZW1mLmNyZWF0ZUVu\ndGl0eU1hbmFnZXIoKTsKICAgICAgICAKICAgICAgICBUeXBlZFF1ZXJ5PEVt\ncGxveWVlPiBxMSA9IGVtLmNyZWF0ZVF1ZXJ5KGpwcWwsIEVtcGxveWVlLmNs\nYXNzKTsKICAgICAgICBhc3NlcnRFcXVhbHMoSlBRTFBhcnNlci5MQU5HX0pQ\nUUwsIE9wZW5KUEFQZXJzaXN0ZW5jZS5jYXN0KHExKS5nZXRMYW5ndWFnZSgp\nKTsKICAgICAgICBMaXN0PEVtcGxveWVlPiBlbXBzID0gcTEuc2V0UGFyYW1l\ndGVyKCJjdXJyZW50IiwgQ2F0ZWdvcnkuUEVSTUFORU5UKQogICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgIC5zZXRQYXJhbWV0ZXIoImhpcmUiLCBD\nYXRlZ29yeS5DT05UUkFDVE9SKS5nZXRSZXN1bHRMaXN0KCk7CiAgICAgICAg\nCiAgICAgICAgLy8gZG8gdGhlIHNhbWUgdGhpbmcgYWdhaW4sIHRoaXMgdGlt\nZSBxdWVyeSBzaG91bGQgYmUgY2FjaGVkCiAgICAgICAgZW0uZ2V0VHJhbnNh\nY3Rpb24oKS5iZWdpbigpOwogICAgICAgIFR5cGVkUXVlcnk8RW1wbG95ZWU+\nIHEyID0gZW0uY3JlYXRlUXVlcnkoanBxbCwgRW1wbG95ZWUuY2xhc3MpOwog\nICAgICAgIGFzc2VydEVxdWFscyhRdWVyeUxhbmd1YWdlcy5MQU5HX1BSRVBB\nUkVEX1NRTCwgT3BlbkpQQVBlcnNpc3RlbmNlLmNhc3QocTIpLmdldExhbmd1\nYWdlKCkpOwogICAgICAgIExpc3Q8RW1wbG95ZWU+IGVtcHMyID0gcTIuc2V0\nUGFyYW1ldGVyKCJjdXJyZW50IiwgQ2F0ZWdvcnkuUEVSTUFORU5UKQogICAg\nICAgICAgICAgICAgICAgICAgICAgICAgLnNldFBhcmFtZXRlcigiaGlyZSIs\nIENhdGVnb3J5LkNPTlRSQUNUT1IpLmdldFJlc3VsdExpc3QoKTsKICAgICAg\nICBlbS5nZXRUcmFuc2FjdGlvbigpLnJvbGxiYWNrKCk7CiAgICB9CiAgICAK\nICAgIHB1YmxpYyB2b2lkIHRlc3RNdWx0aXRocmVhZGVkQWNjZXNzKCkgewog\nICAgICAgIE9wZW5KUEFFbnRpdHlNYW5hZ2VyIGVtMSA9IGVtZi5jcmVhdGVF\nbnRpdHlNYW5hZ2VyKCk7CiAgICAgICAgU3RyaW5nIGpwcWwgPSAic2VsZWN0\nIHAgZnJvbSBBdXRob3IgcCB3aGVyZSBwLm5hbWU9Om5hbWUiOwogICAgICAg\nIGludCBOID0gNTsKICAgICAgICBUaHJlYWRbXSB0aHJlYWRzID0gIG5ldyBU\naHJlYWRbTl07CiAgICAgICAgUXVlcnlUaHJlYWRbXSBxdHMgPSBuZXcgUXVl\ncnlUaHJlYWRbTl07CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBOOyBp\nKyspIHsKICAgICAgICAgICAgT3BlbkpQQUVudGl0eU1hbmFnZXIgZW10ID0g\nZW1mLmNyZWF0ZUVudGl0eU1hbmFnZXIoKTsKICAgICAgICAgICAgcXRzW2ld\nID0gbmV3IFF1ZXJ5VGhyZWFkKGVtdCwganBxbCk7CiAgICAgICAgICAgIHRo\ncmVhZHNbaV0gPSBuZXcgVGhyZWFkKHF0c1tpXSk7CiAgICAgICAgICAgIHRo\ncmVhZHNbaV0uc2V0RGFlbW9uKHRydWUpOwogICAgICAgIH0KICAgICAgICBm\nb3IgKFRocmVhZCB0IDogdGhyZWFkcykgewogICAgICAgICAgICB0LnN0YXJ0\nKCk7IAogICAgICAgIH0KICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IE47\nIGkrKykgewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgIHRocmVh\nZHNbaV0uam9pbigpOwogICAgICAgICAgICAgIGFzc2VydEZhbHNlKHF0c1tp\nXS5pc0ZhaWxlZCgpKTsKICAgICAgICAgICAgfSBjYXRjaCAoSW50ZXJydXB0\nZWRFeGNlcHRpb24gZSkgewogICAgICAgICAgICAgICAgZS5wcmludFN0YWNr\nVHJhY2UoKTsKICAgICAgICAgICAgICAgIGZhaWwoKTsKICAgICAgICAgICAg\nfQogICAgICAgIH0KICAgIH0KICAgIAogICAgcHVibGljIHZvaWQgdGVzdFBh\ncmFtZXRlck9uRXh0ZXJuYWxpemVkRmllbGRJc0V4Y2x1ZGVkKCkgewogICAg\nICAgIFN0cmluZyBqcHFsID0gInNlbGVjdCBiIGZyb20gQm9vayBiIHdoZXJl\nIGIudGl0bGU9OnRpdGxlIGFuZCBiLnRva2VuPTp0b2tlbiI7CiAgICAgICAg\nUXVlcnkgcTEgPSBlbS5jcmVhdGVRdWVyeShqcHFsKQogICAgICAgICAgLnNl\ndFBhcmFtZXRlcigidGl0bGUiLCAidGl0bGUtMSIpCiAgICAgICAgICAuc2V0\nUGFyYW1ldGVyKCJ0b2tlbiIsICJMQVJHRSIpOwogICAgICAgIC8vIGRlZmF1\nbHQgZmV0Y2hlcyBhdXRob3JzIGVhZ2VybHkgYW5kIHRodXMgY3JlYXRlcyBt\ndWx0aXBsZSBTUUwgYW5kIGhlbmNlIG5vdCBjYWNoZXMgYW55d2F5CiAgICAg\nICAgT3BlbkpQQVBlcnNpc3RlbmNlLmNhc3QocTEpLmdldEZldGNoUGxhbigp\nLnJlbW92ZUZldGNoR3JvdXAoImRlZmF1bHQiKTsKICAgICAgICBhc3NlcnRG\nYWxzZShxMS5nZXRSZXN1bHRMaXN0KCkuaXNFbXB0eSgpKTsKICAgICAgICBh\nc3NlcnROb3RDYWNoZWQoanBxbCk7CiAgICAgICAgUXVlcnkgcTIgPSBlbS5j\ncmVhdGVRdWVyeShqcHFsKQogICAgICAgICAgICAgICAgICAgICAuc2V0UGFy\nYW1ldGVyKCJ0aXRsZSIsICJ0aXRsZS0yIikKICAgICAgICAgICAgICAgICAg\nICAgLnNldFBhcmFtZXRlcigidG9rZW4iLCAiTUVESVVNIik7CiAgICAgICBh\nc3NlcnRGYWxzZShxMi5nZXRSZXN1bHRMaXN0KCkuaXNFbXB0eSgpKTsKICAg\nIH0KICAgIAogICAgcHVibGljIHZvaWQgdGVzdE5vUGFyYW1ldGVyT25FeHRl\ncm5hbGl6ZWRGaWVsZElzSW5jbHVkZWQoKSB7CiAgICAgICAgU3RyaW5nIGpw\ncWwgPSAic2VsZWN0IGIgZnJvbSBCb29rIGIgd2hlcmUgYi50aXRsZT06dGl0\nbGUiOwogICAgICAgIFF1ZXJ5IHExID0gZW0uY3JlYXRlUXVlcnkoanBxbCkK\nICAgICAgICAgIC5zZXRQYXJhbWV0ZXIoInRpdGxlIiwgInRpdGxlLTEiKTsK\nICAgICAgICAvLyBkZWZhdWx0IGZldGNoZXMgYXV0aG9ycyBlYWdlcmx5IGFu\nZCB0aHVzIGNyZWF0ZXMgbXVsdGlwbGUgU1FMIGFuZCBoZW5jZSBub3QgY2Fj\naGVzIGFueXdheQogICAgICAgIE9wZW5KUEFQZXJzaXN0ZW5jZS5jYXN0KHEx\nKS5nZXRGZXRjaFBsYW4oKS5yZW1vdmVGZXRjaEdyb3VwKCJkZWZhdWx0Iik7\nCiAgICAgICAgYXNzZXJ0RmFsc2UocTEuZ2V0UmVzdWx0TGlzdCgpLmlzRW1w\ndHkoKSk7CiAgICAgICAgYXNzZXJ0Q2FjaGVkKGpwcWwpOwogICAgICAgIFF1\nZXJ5IHEyID0gZW0uY3JlYXRlUXVlcnkoanBxbCkKICAgICAgICAgICAgICAg\nICAgICAgLnNldFBhcmFtZXRlcigidGl0bGUiLCAidGl0bGUtMiIpOwogICAg\nICAgYXNzZXJ0RmFsc2UocTIuZ2V0UmVzdWx0TGlzdCgpLmlzRW1wdHkoKSk7\nCiAgICB9CiAgICAKICAgIHB1YmxpYyB2b2lkIHRlc3RTdWJxdWVyeVBhcmFt\nZXRlcnMoKSB7CiAgICAgICAgRW50aXR5TWFuYWdlciBlbSA9IGVtZi5jcmVh\ndGVFbnRpdHlNYW5hZ2VyKCk7CiAgICAgICAgU3RyaW5nIHF1ZXJ5ID0gInNl\nbGVjdCBlIGZyb20gRW1wbG95ZWUgZSAiCiAgICAgICAgICAgICsgImlubmVy\nIGpvaW4gZS5kZXBhcnRtZW50IGQgIgogICAgICAgICAgICArICJpbm5lciBq\nb2luIGQuY29tcGFueSBjICIKICAgICAgICAgICAgKyAid2hlcmUgbW9kKGMu\nc3RhcnRZZWFyLCAxMDApID0gMCAiCiAgICAgICAgICAgICsgImFuZCBleGlz\ndHMgKHNlbGVjdCBlMiBmcm9tIEVtcGxveWVlIGUyICIKICAgICAgICAgICAg\nICAgICsgImlubmVyIGpvaW4gZTIuZGVwYXJ0bWVudCBkMiAiCiAgICAgICAg\nICAgICAgICArICJpbm5lciBqb2luIGQyLmNvbXBhbnkgYzIgIgogICAgICAg\nICAgICAgICAgKyAid2hlcmUgZTIuYWRkcmVzcy5jaXR5ID0gZS5hZGRyZXNz\nLmNpdHkgIgogICAgICAgICAgICAgICAgKyAiYW5kIGUyLmlzTWFuYWdlciA9\nIGZhbHNlICIKICAgICAgICAgICAgICAgICsgImFuZCBkMi5uYW1lID0gZC5u\nYW1lICIKICAgICAgICAgICAgICAgICsgImFuZCBjMi5uYW1lID0gOmNvbXBh\nbnlOYW1lKSAiCiAgICAgICAgICAgICsgImFuZCBkLm5hbWUgPSA6ZGVwYXJ0\nbWVudE5hbWUiOwoKICAgICAgICBlbS5nZXRUcmFuc2FjdGlvbigpLmJlZ2lu\nKCk7CiAgICAgICAgVHlwZWRRdWVyeTxFbXBsb3llZT4gcTEgPSBlbS5jcmVh\ndGVRdWVyeShxdWVyeSwgRW1wbG95ZWUuY2xhc3MpOwogICAgICAgIHExLnNl\ndFBhcmFtZXRlcigiY29tcGFueU5hbWUiLCAiYWNtZS5vcmciKTsKICAgICAg\nICBxMS5zZXRQYXJhbWV0ZXIoImRlcGFydG1lbnROYW1lIiwgIkVuZ2luZWVy\naW5nIik7CiAgICAgICAgYXNzZXJ0RXF1YWxzKHExLmdldFJlc3VsdExpc3Qo\nKS5zaXplKCksIDYpOwoKICAgICAgICBUeXBlZFF1ZXJ5PEVtcGxveWVlPiBx\nMiA9IGVtLmNyZWF0ZVF1ZXJ5KHF1ZXJ5LCBFbXBsb3llZS5jbGFzcyk7CiAg\nICAgICAgcTIuc2V0UGFyYW1ldGVyKCJjb21wYW55TmFtZSIsICJhY21lLm9y\nZyIpOwogICAgICAgIHEyLnNldFBhcmFtZXRlcigiZGVwYXJ0bWVudE5hbWUi\nLCAiRW5naW5lZXJpbmciKTsKICAgICAgICBhc3NlcnRFcXVhbHMocTIuZ2V0\nUmVzdWx0TGlzdCgpLnNpemUoKSwgNik7CiAgICAgICAgZW0uZ2V0VHJhbnNh\nY3Rpb24oKS5yb2xsYmFjaygpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHRl\nc3RSZXBlYXRlZFBhcmFtZXRlckluU3VicXVlcnlJbkRpZmZlcmVudE9yZGVy\nKCkgewogICAgICAgIE9wZW5KUEFFbnRpdHlNYW5hZ2VyIGVtID0gZW1mLmNy\nZWF0ZUVudGl0eU1hbmFnZXIoKTsKICAgICAgICBTdHJpbmcganBxbCA9ICAi\nc2VsZWN0IG8gZnJvbSBPcmRlckpQQSBvICIgCiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgKyAid2hlcmUgby5PcmRlcklkIGluIChzZWxlY3QgbWF4\nKG8xLk9yZGVySWQpIGZyb20gT3JkZXJKUEEgbzEgIgogICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICsgICJ3aGVyZSAoKG8xLkN1c3RvbWVy\nSWQgPSA6Y3VzdG9tZXJJZCkgIiAKICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICArICAiYW5kICAgKG8xLkRpc3RyaWN0SWQgPSA6ZGlzdHJp\nY3RJZCkgIiAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAr\nICAiYW5kICAgKG8xLldhcmVob3VzZUlkID0gOndhcmVob3VzZUlkKSkpICIg\nCiAgICAgICAgICAgICAgICAgICAgKyAgImFuZCAoby5DdXN0b21lcklkID0g\nOmN1c3RvbWVySWQpICIKICAgICAgICAgICAgICAgICAgICArICAiYW5kIChv\nLldhcmVob3VzZUlkID0gOndhcmVob3VzZUlkKSAiCiAgICAgICAgICAgICAg\nICAgICAgKyAgImFuZCAoby5EaXN0cmljdElkID0gOmRpc3RyaWN0SWQpIjsK\nCiAgICAgICAgZW0uZ2V0VHJhbnNhY3Rpb24oKS5iZWdpbigpOwogICAgICAg\nIFR5cGVkUXVlcnk8T3JkZXJKUEE+IHExID0gZW0uY3JlYXRlUXVlcnkoanBx\nbCwgT3JkZXJKUEEuY2xhc3MpOwogICAgICAgIHExLnNldFBhcmFtZXRlcigi\nY3VzdG9tZXJJZCIsIDMzOSkKICAgICAgICAgIC5zZXRQYXJhbWV0ZXIoImRp\nc3RyaWN0SWQiLCAzKQogICAgICAgICAgLnNldFBhcmFtZXRlcigid2FyZWhv\ndXNlSWQiLCAyMyk7CiAgICAgICAgICAgICAgICAgIAogICAgICAgIGFzc2Vy\ndEVxdWFscyhKUFFMUGFyc2VyLkxBTkdfSlBRTCwgT3BlbkpQQVBlcnNpc3Rl\nbmNlLmNhc3QocTEpLmdldExhbmd1YWdlKCkpOwogICAgICAgIGFzc2VydEZh\nbHNlKHExLmdldFJlc3VsdExpc3QoKS5pc0VtcHR5KCkpOwogICAgICAgIAog\nICAgICAgIAogICAgICAgIFR5cGVkUXVlcnk8T3JkZXJKUEE+IHEyID0gZW0u\nY3JlYXRlUXVlcnkoanBxbCwgT3JkZXJKUEEuY2xhc3MpOwogICAgICAgIGFz\nc2VydEVxdWFscyhRdWVyeUxhbmd1YWdlcy5MQU5HX1BSRVBBUkVEX1NRTCwg\nT3BlbkpQQVBlcnNpc3RlbmNlLmNhc3QocTIpLmdldExhbmd1YWdlKCkpOwog\nICAgICAgIHEyLnNldFBhcmFtZXRlcigiY3VzdG9tZXJJZCIsIDI5NjcpCiAg\nICAgICAgICAuc2V0UGFyYW1ldGVyKCJkaXN0cmljdElkIiwgNSkKICAgICAg\nICAgIC5zZXRQYXJhbWV0ZXIoIndhcmVob3VzZUlkIiwgMjIpOwogICAgICAg\nIAogICAgICAgIGFzc2VydEZhbHNlKHEyLmdldFJlc3VsdExpc3QoKS5pc0Vt\ncHR5KCkpOwogICAgICAgIGVtLmdldFRyYW5zYWN0aW9uKCkucm9sbGJhY2so\nKTsKICAgIH0KICAgIAogICAgcHVibGljIHZvaWQgdGVzdFJlcGVhdGVkUGFy\nYW1ldGVySW5TdWJxdWVyeUluU2FtZU9yZGVyKCkgewogICAgICAgIE9wZW5K\nUEFFbnRpdHlNYW5hZ2VyIGVtID0gZW1mLmNyZWF0ZUVudGl0eU1hbmFnZXIo\nKTsKICAgICAgICBTdHJpbmcganBxbCA9ICAic2VsZWN0IG8gZnJvbSBPcmRl\nckpQQSBvICIgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKyAid2hl\ncmUgby5PcmRlcklkIGluIChzZWxlY3QgbWF4KG8xLk9yZGVySWQpIGZyb20g\nT3JkZXJKUEEgbzEgIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICsg\nICJ3aGVyZSAoKG8xLkN1c3RvbWVySWQgPSA6Y3VzdG9tZXJJZCkgIiAKICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICArICAiYW5kICAgKG8xLkRpc3Ry\naWN0SWQgPSA6ZGlzdHJpY3RJZCkgIiAKICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICArICAiYW5kICAgKG8xLldhcmVob3VzZUlkID0gOndhcmVob3Vz\nZUlkKSkpICIgCiAgICAgICAgICAgICAgICAgICAgICAgICsgICJhbmQgKG8u\nQ3VzdG9tZXJJZCA9IDpjdXN0b21lcklkKSAiCiAgICAgICAgICAgICAgICAg\nICAgICAgICsgICJhbmQgKG8uRGlzdHJpY3RJZCA9IDpkaXN0cmljdElkKSAi\nCiAgICAgICAgICAgICAgICAgICAgICAgICsgICJhbmQgKG8uV2FyZWhvdXNl\nSWQgPSA6d2FyZWhvdXNlSWQpIjsKCiAgICAgICAgZW0uZ2V0VHJhbnNhY3Rp\nb24oKS5iZWdpbigpOwogICAgICAgIFR5cGVkUXVlcnk8T3JkZXJKUEE+IHEx\nID0gZW0uY3JlYXRlUXVlcnkoanBxbCwgT3JkZXJKUEEuY2xhc3MpOwogICAg\nICAgIHExLnNldFBhcmFtZXRlcigiY3VzdG9tZXJJZCIsIDMzOSkKICAgICAg\nICAgIC5zZXRQYXJhbWV0ZXIoImRpc3RyaWN0SWQiLCAzKQogICAgICAgICAg\nLnNldFBhcmFtZXRlcigid2FyZWhvdXNlSWQiLCAyMyk7CiAgICAgICAgICAg\nICAgICAgIAogICAgICAgIGFzc2VydEVxdWFscyhKUFFMUGFyc2VyLkxBTkdf\nSlBRTCwgT3BlbkpQQVBlcnNpc3RlbmNlLmNhc3QocTEpLmdldExhbmd1YWdl\nKCkpOwogICAgICAgIGFzc2VydEZhbHNlKHExLmdldFJlc3VsdExpc3QoKS5p\nc0VtcHR5KCkpOwogICAgICAgIAogICAgICAgIAogICAgICAgIFR5cGVkUXVl\ncnk8T3JkZXJKUEE+IHEyID0gZW0uY3JlYXRlUXVlcnkoanBxbCwgT3JkZXJK\nUEEuY2xhc3MpOwogICAgICAgIGFzc2VydEVxdWFscyhRdWVyeUxhbmd1YWdl\ncy5MQU5HX1BSRVBBUkVEX1NRTCwgT3BlbkpQQVBlcnNpc3RlbmNlLmNhc3Qo\ncTIpLmdldExhbmd1YWdlKCkpOwogICAgICAgIHEyLnNldFBhcmFtZXRlcigi\nY3VzdG9tZXJJZCIsIDI5NjcpCiAgICAgICAgICAuc2V0UGFyYW1ldGVyKCJk\naXN0cmljdElkIiwgNSkKICAgICAgICAgIC5zZXRQYXJhbWV0ZXIoIndhcmVo\nb3VzZUlkIiwgMjIpOwogICAgICAgIAogICAgICAgIGFzc2VydEZhbHNlKHEy\nLmdldFJlc3VsdExpc3QoKS5pc0VtcHR5KCkpOwogICAgICAgIGVtLmdldFRy\nYW5zYWN0aW9uKCkucm9sbGJhY2soKTsKICAgIH0KICAgIAogICAgcHVibGlj\nIHZvaWQgdGVzdFBhcnRpYWxseVJlcGVhdGVkUGFyYW1ldGVySW5TdWJxdWVy\neSgpIHsKICAgICAgICBPcGVuSlBBRW50aXR5TWFuYWdlciBlbSA9IGVtZi5j\ncmVhdGVFbnRpdHlNYW5hZ2VyKCk7CiAgICAgICAgU3RyaW5nIGpwcWwgPSAg\nInNlbGVjdCBvIGZyb20gT3JkZXJKUEEgbyAiIAogICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICsgIndoZXJlIG8uT3JkZXJJZCBpbiAoc2VsZWN0IG1h\neChvMS5PcmRlcklkKSBmcm9tIE9yZGVySlBBIG8xICIKICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICArICAid2hlcmUgKChvMS5DdXN0b21lcklkID0g\nOmN1c3RvbWVySWQpICIgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nKyAgImFuZCAgIChvMS5XYXJlaG91c2VJZCA9IDp3YXJlaG91c2VJZCkpKSAi\nIAogICAgICAgICAgICAgICAgICAgICAgICArICAiYW5kIChvLkN1c3RvbWVy\nSWQgPSA6Y3VzdG9tZXJJZCkgIgogICAgICAgICAgICAgICAgICAgICAgICAr\nICAiYW5kIChvLkRpc3RyaWN0SWQgPSA6ZGlzdHJpY3RJZCkgIgogICAgICAg\nICAgICAgICAgICAgICAgICArICAiYW5kIChvLldhcmVob3VzZUlkID0gOndh\ncmVob3VzZUlkKSI7CgogICAgICAgIGVtLmdldFRyYW5zYWN0aW9uKCkuYmVn\naW4oKTsKICAgICAgICBUeXBlZFF1ZXJ5PE9yZGVySlBBPiBxMSA9IGVtLmNy\nZWF0ZVF1ZXJ5KGpwcWwsIE9yZGVySlBBLmNsYXNzKTsKICAgICAgICBxMS5z\nZXRQYXJhbWV0ZXIoImN1c3RvbWVySWQiLCAzMzkpCiAgICAgICAgICAuc2V0\nUGFyYW1ldGVyKCJkaXN0cmljdElkIiwgMykKICAgICAgICAgIC5zZXRQYXJh\nbWV0ZXIoIndhcmVob3VzZUlkIiwgMjMpOwogICAgICAgICAgICAgICAgICAK\nICAgICAgICBhc3NlcnRFcXVhbHMoSlBRTFBhcnNlci5MQU5HX0pQUUwsIE9w\nZW5KUEFQZXJzaXN0ZW5jZS5jYXN0KHExKS5nZXRMYW5ndWFnZSgpKTsKICAg\nICAgICBhc3NlcnRGYWxzZShxMS5nZXRSZXN1bHRMaXN0KCkuaXNFbXB0eSgp\nKTsKICAgICAgICAKICAgICAgICAKICAgICAgICBUeXBlZFF1ZXJ5PE9yZGVy\nSlBBPiBxMiA9IGVtLmNyZWF0ZVF1ZXJ5KGpwcWwsIE9yZGVySlBBLmNsYXNz\nKTsKICAgICAgICBhc3NlcnRFcXVhbHMoUXVlcnlMYW5ndWFnZXMuTEFOR19Q\nUkVQQVJFRF9TUUwsIE9wZW5KUEFQZXJzaXN0ZW5jZS5jYXN0KHEyKS5nZXRM\nYW5ndWFnZSgpKTsKICAgICAgICBxMi5zZXRQYXJhbWV0ZXIoImN1c3RvbWVy\nSWQiLCAyOTY3KQogICAgICAgICAgLnNldFBhcmFtZXRlcigiZGlzdHJpY3RJ\nZCIsIDUpCiAgICAgICAgICAuc2V0UGFyYW1ldGVyKCJ3YXJlaG91c2VJZCIs\nIDIyKTsKICAgICAgICAKICAgICAgICBhc3NlcnRGYWxzZShxMi5nZXRSZXN1\nbHRMaXN0KCkuaXNFbXB0eSgpKTsKICAgICAgICBlbS5nZXRUcmFuc2FjdGlv\nbigpLnJvbGxiYWNrKCk7CiAgICB9CiAgICAKICAgIHB1YmxpYyB2b2lkIHRl\nc3RQYXJ0aWFsbHlSZXBlYXRlZFBhcmFtZXRlckluTWFpbnF1ZXJ5KCkgewog\nICAgICAgIE9wZW5KUEFFbnRpdHlNYW5hZ2VyIGVtID0gZW1mLmNyZWF0ZUVu\ndGl0eU1hbmFnZXIoKTsKICAgICAgICBTdHJpbmcganBxbCA9ICAic2VsZWN0\nIG8gZnJvbSBPcmRlckpQQSBvICIgCiAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgKyAid2hlcmUgby5PcmRlcklkIGluIChzZWxlY3QgbWF4KG8xLk9y\nZGVySWQpIGZyb20gT3JkZXJKUEEgbzEgIgogICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICsgICJ3aGVyZSAoKG8xLkN1c3RvbWVySWQgPSA6Y3VzdG9t\nZXJJZCkgIiAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICArICAiYW5k\nICAgKG8xLkRpc3RyaWN0SWQgPSA6ZGlzdHJpY3RJZCkgIiAKICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICArICAiYW5kICAgKG8xLldhcmVob3VzZUlk\nID0gOndhcmVob3VzZUlkKSkpICIgCiAgICAgICAgICAgICAgICAgICAgICAg\nICsgICJhbmQgKG8uQ3VzdG9tZXJJZCA9IDpjdXN0b21lcklkKSAiCiAgICAg\nICAgICAgICAgICAgICAgICAgICsgICJhbmQgKG8uV2FyZWhvdXNlSWQgPSA6\nd2FyZWhvdXNlSWQpIjsKCiAgICAgICAgZW0uZ2V0VHJhbnNhY3Rpb24oKS5i\nZWdpbigpOwogICAgICAgIFR5cGVkUXVlcnk8T3JkZXJKUEE+IHExID0gZW0u\nY3JlYXRlUXVlcnkoanBxbCwgT3JkZXJKUEEuY2xhc3MpOwogICAgICAgIHEx\nLnNldFBhcmFtZXRlcigiY3VzdG9tZXJJZCIsIDMzOSkKICAgICAgICAgIC5z\nZXRQYXJhbWV0ZXIoImRpc3RyaWN0SWQiLCAzKQogICAgICAgICAgLnNldFBh\ncmFtZXRlcigid2FyZWhvdXNlSWQiLCAyMyk7CiAgICAgICAgICAgICAgICAg\nIAogICAgICAgIGFzc2VydEVxdWFscyhKUFFMUGFyc2VyLkxBTkdfSlBRTCwg\nT3BlbkpQQVBlcnNpc3RlbmNlLmNhc3QocTEpLmdldExhbmd1YWdlKCkpOwog\nICAgICAgIGFzc2VydEZhbHNlKHExLmdldFJlc3VsdExpc3QoKS5pc0VtcHR5\nKCkpOwogICAgICAgIAogICAgICAgIAogICAgICAgIFR5cGVkUXVlcnk8T3Jk\nZXJKUEE+IHEyID0gZW0uY3JlYXRlUXVlcnkoanBxbCwgT3JkZXJKUEEuY2xh\nc3MpOwogICAgICAgIGFzc2VydEVxdWFscyhRdWVyeUxhbmd1YWdlcy5MQU5H\nX1BSRVBBUkVEX1NRTCwgT3BlbkpQQVBlcnNpc3RlbmNlLmNhc3QocTIpLmdl\ndExhbmd1YWdlKCkpOwogICAgICAgIHEyLnNldFBhcmFtZXRlcigiY3VzdG9t\nZXJJZCIsIDI5NjcpCiAgICAgICAgICAuc2V0UGFyYW1ldGVyKCJkaXN0cmlj\ndElkIiwgNSkKICAgICAgICAgIC5zZXRQYXJhbWV0ZXIoIndhcmVob3VzZUlk\nIiwgMjIpOwogICAgICAgIAogICAgICAgIGFzc2VydEZhbHNlKHEyLmdldFJl\nc3VsdExpc3QoKS5pc0VtcHR5KCkpOwogICAgICAgIGVtLmdldFRyYW5zYWN0\naW9uKCkucm9sbGJhY2soKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCB0ZXN0\nUmFuZ2VJc0V4Y2x1ZGVkKCkgewogICAgICAgIExpc3Q8Q29tcGFueT4gbCA9\nIG51bGw7CgogICAgICAgIGwgPSBnZXRBbGxDb21wYW5pZXNQYWdlZCgwLCAx\nKTsKICAgICAgICBhc3NlcnRFcXVhbHMoMSwgbC5zaXplKCkpOwogICAgICAg\nIGFzc2VydEVxdWFscygxOTAwLCBsLmdldCgwKS5nZXRTdGFydFllYXIoKSk7\nCiAgICAgICAgCiAgICAgICAgbCA9IGdldEFsbENvbXBhbmllc1BhZ2VkKDEs\nIDEpOwogICAgICAgIGFzc2VydEVxdWFscygxLCBsLnNpemUoKSk7CiAgICAg\nICAgYXNzZXJ0RXF1YWxzKDIwMDAsIGwuZ2V0KDApLmdldFN0YXJ0WWVhcigp\nKTsKICAgICAgICAKICAgICAgICBsID0gZ2V0QWxsQ29tcGFuaWVzUGFnZWQo\nMiwgMSk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKDEsIGwuc2l6ZSgpKTsKICAg\nICAgICBhc3NlcnRFcXVhbHMoMjAxMCwgbC5nZXQoMCkuZ2V0U3RhcnRZZWFy\nKCkpOwogICAgfQoKICAgIHB1YmxpYyBMaXN0PENvbXBhbnk+IGdldEFsbENv\nbXBhbmllc1BhZ2VkKGludCBzdGFydCwgaW50IG1heCkgewogICAgICAgIEVu\ndGl0eU1hbmFnZXIgZW0gPSBlbWYuY3JlYXRlRW50aXR5TWFuYWdlcigpOwog\nICAgICAgIFF1ZXJ5IHEgPSBlbS5jcmVhdGVRdWVyeSgic2VsZWN0IHAgZnJv\nbSBDb21wYW55IHAgb3JkZXIgYnkgcC5zdGFydFllYXIiKTsKICAgICAgICBx\nLnNldEZpcnN0UmVzdWx0KHN0YXJ0KTsKICAgICAgICBxLnNldE1heFJlc3Vs\ndHMobWF4KTsKICAgICAgICByZXR1cm4gKExpc3Q8Q29tcGFueT4pIHEuZ2V0\nUmVzdWx0TGlzdCgpOwogICAgfQogICAgCiAgICBQcmVwYXJlZFF1ZXJ5Q2Fj\naGUgZ2V0UHJlcGFyZWRRdWVyeUNhY2hlKCkgewogICAgICAgIHJldHVybiBl\nbWYuZ2V0Q29uZmlndXJhdGlvbigpLmdldFF1ZXJ5U1FMQ2FjaGVJbnN0YW5j\nZSgpOwogICAgfQogICAgCiAgICAvKioKICAgICAqIENvbXBhcmUgdGhlIHJl\nc3VsdCBvZiBleGVjdXRpb24gb2YgdGhlIG5vbi1wYXJhbWV0ZXJpemVkIHF1\nZXJ5IHdpdGggYW5kIHdpdGhvdXQgUHJlcGFyZWRRdWVyeSBjYWNoZS4KICAg\nICAqIAogICAgICogQHBhcmFtIGpwcWwgYSBTdHJpbmcgcmVwcmVzZW50aW5n\nIGVpdGhlciBhIEpQUUwgb3IgdGhlIG5hbWUgb2YgYSBOYW1lZFF1ZXJ5CiAg\nICAgKiBAcGFyYW0gaXNOYW1lZFF1ZXJ5IGZsYWdzIGlmIHRoZSBmaXJzdCBp\nbnB1dCByZXByZXNlbnRzIGEgSlBRTCBzdHJpbmcgb3IgYSBOYW1lZFF1ZXJ5\nIG5hbWUKICAgICAqLwogICAgdm9pZCBjb21wYXJlKFN0cmluZyBqcHFsLCBi\nb29sZWFuIGlzTmFtZWQpIHsKICAgICAgICBjb21wYXJlKGpwcWwsIGlzTmFt\nZWQsIC0xLCBOT19QQVJBTVMpOwogICAgfQoKICAgIAogICAgLyoqCiAgICAg\nKiBDb21wYXJlIHRoZSByZXN1bHQgb2YgZXhlY3V0aW9uIG9mIHRoZSBub24t\ncGFyYW1ldGVyaXplZCBxdWVyeSB3aXRoIGFuZCB3aXRob3V0IFByZXBhcmVk\nUXVlcnkgY2FjaGUuCiAgICAgKiAKICAgICAqIEBwYXJhbSBqcHFsIGEgU3Ry\naW5nIHJlcHJlc2VudGluZyBlaXRoZXIgYSBKUFFMIG9yIHRoZSBuYW1lIG9m\nIGEgTmFtZWRRdWVyeQogICAgICogQHBhcmFtIGlzTmFtZWRRdWVyeSBmbGFn\ncyBpZiB0aGUgZmlyc3QgaW5wdXQgcmVwcmVzZW50cyBhIEpQUUwgc3RyaW5n\nIG9yIGEgTmFtZWRRdWVyeSBuYW1lCiAgICAgKiBAcGFyYW0gZXhwZWN0ZWRD\nb3VudCBleHBlY3RlZCBudW1iZXIgb2YgcmVzdWx0cwogICAgICovCiAgICB2\nb2lkIGNvbXBhcmUoU3RyaW5nIGpwcWwsIGJvb2xlYW4gaXNOYW1lZCwgaW50\nIGV4cGVjdGVkQ291bnQpIHsKICAgICAgICBjb21wYXJlKGpwcWwsIGlzTmFt\nZWQsIGV4cGVjdGVkQ291bnQsIE5PX1BBUkFNUyk7CiAgICB9CiAgICAKICAg\nIC8qKgogICAgICogQ29tcGFyZSB0aGUgcmVzdWx0IG9mIGV4ZWN1dGlvbiBv\nZiB0aGUgcXVlcnkgd2l0aCBhbmQgd2l0aG91dCBQcmVwYXJlZFF1ZXJ5IGNh\nY2hlLgogICAgICogCiAgICAgKiAKICAgICAqIEBwYXJhbSBqcHFsIGEgU3Ry\naW5nIHJlcHJlc2VudGluZyBlaXRoZXIgYSBKUFFMIG9yIHRoZSBuYW1lIG9m\nIGEgTmFtZWRRdWVyeQogICAgICogQHBhcmFtIGlzTmFtZWRRdWVyeSBmbGFn\ncyBpZiB0aGUgZmlyc3QgaW5wdXQgcmVwcmVzZW50cyBhIEpQUUwgc3RyaW5n\nIG9yIGEgTmFtZWRRdWVyeSBuYW1lCiAgICAgKiBAcGFyYW0gcGFyYW1zIGEg\nZXZlbiBzaXplZCBhcnJheSB3aG9zZSBldmVuLWluZGV4ZWQgZWxlbWVudHMg\nYXJlIGtleXMgYW5kIG9kZC1pbmRleGVkIGVsZW1lbnRzIGFyZSBjb3JyZXNw\nb25kaW5nCiAgICAgKiBwYXJhbWV0ZXIgdmFsdWUgZm9yIHRoZSBxdWVyeS4g\nQSBudWxsIGFycmF5IGRlbm90ZXMgdGhlIHF1ZXJ5IGlzIG5vdCBwYXJhbWV0\nZXJpemVkLgogICAgICovCiAgICB2b2lkIGNvbXBhcmUoU3RyaW5nIGpwcWws\nIGJvb2xlYW4gaXNOYW1lZCwgT2JqZWN0Li4uIHBhcmFtcykgewogICAgICAg\nIGNvbXBhcmUoanBxbCwgaXNOYW1lZCwgLTEsIHBhcmFtcyk7CiAgICB9CiAg\nICAvKioKICAgICAqIENvbXBhcmUgdGhlIHJlc3VsdCBvZiBleGVjdXRpb24g\nb2YgdGhlIHF1ZXJ5IHdpdGggYW5kIHdpdGhvdXQgUHJlcGFyZWRRdWVyeSBj\nYWNoZS4KICAgICAqIAogICAgICogCiAgICAgKiBAcGFyYW0ganBxbCBhIFN0\ncmluZyByZXByZXNlbnRpbmcgZWl0aGVyIGEgSlBRTCBvciB0aGUgbmFtZSBv\nZiBhIE5hbWVkUXVlcnkKICAgICAqIEBwYXJhbSBpc05hbWVkUXVlcnkgZmxh\nZ3MgaWYgdGhlIGZpcnN0IGlucHV0IHJlcHJlc2VudHMgYSBKUFFMIHN0cmlu\nZyBvciBhIE5hbWVkUXVlcnkgbmFtZQogICAgICogQHBhcmFtIHBhcmFtcyBh\nIGV2ZW4gc2l6ZWQgYXJyYXkgd2hvc2UgZXZlbi1pbmRleGVkIGVsZW1lbnRz\nIGFyZSBrZXlzIGFuZCBvZGQtaW5kZXhlZCBlbGVtZW50cyBhcmUgY29ycmVz\ncG9uZGluZwogICAgICogcGFyYW1ldGVyIHZhbHVlIGZvciB0aGUgcXVlcnku\nIEEgbnVsbCBhcnJheSBkZW5vdGVzIHRoZSBxdWVyeSBpcyBub3QgcGFyYW1l\ndGVyaXplZC4KICAgICAqIEBwYXJhbSBleHBlY3RlZENvdW50IGV4cGVjdGVk\nIG51bWJlciBvZiByZXN1bHRzLiBTdXBwbHkgYSBuZWdhdGl2ZSBudW1iZXIg\ndG8gaWdub3JlLgogICAgICovCiAgICB2b2lkIGNvbXBhcmUoU3RyaW5nIHF1\nZXJ5LCBib29sZWFuIGlzTmFtZWQsIGludCBleHBlY3RlZENvdW50LCBPYmpl\nY3QuLi4gcGFyYW1zKSB7CiAgICAgICAgcnVuKHF1ZXJ5LCBpc05hbWVkLCBw\nYXJhbXMsIGV4cGVjdGVkQ291bnQsICFVU0VfQ0FDSEUsIDEpOyAvLyBydW4g\ndGhlIHF1ZXJ5IG9uY2UgZm9yIHdhcm1pbmcgdXAKICAgICAgICAKICAgICAg\nICAvLyBydW4gTiB0aW1lcyB3aXRob3V0IGNhY2hlCiAgICAgICAgYXVkaXRv\nci5jbGVhcigpOwogICAgICAgIGxvbmcgd2l0aG91dCA9IHJ1bihxdWVyeSwg\naXNOYW1lZCwgcGFyYW1zLCBleHBlY3RlZENvdW50LCAhVVNFX0NBQ0hFLCBT\nQU1QTEVfU0laRSk7CiAgICAgICAgTGlzdDxTdHJpbmc+IG9yaWdpbmFsU1FM\ncyA9IGF1ZGl0b3IuZ2V0U1FMcygpOwogICAgICAgIAogICAgICAgIC8vIHJ1\nbiBOIHRpbWVzIHdpdGggY2FjaGUKICAgICAgICBhdWRpdG9yLmNsZWFyKCk7\nCiAgICAgICAgbG9uZyB3aXRoID0gcnVuKHF1ZXJ5LCBpc05hbWVkLCBwYXJh\nbXMsIGV4cGVjdGVkQ291bnQsIFVTRV9DQUNIRSwgU0FNUExFX1NJWkUpOwog\nICAgICAgIExpc3Q8U3RyaW5nPiBjYWNoZWRTUUxzID0gYXVkaXRvci5nZXRT\nUUxzKCk7CiAgICAgICAgCiAgICAgICAgY29tcGFyZVNRTHMob3JpZ2luYWxT\nUUxzLCBjYWNoZWRTUUxzKTsKICAgICAgICBsb25nIGRlbHRhID0gKHdpdGhv\ndXQgPT0gMCkgPyAwIDogKHdpdGhvdXQgLSB3aXRoKSAqIDEwMCAvIHdpdGhv\ndXQ7CiAgICAgICAgCiAgICAgICAgU3RyaW5nIGpwcWwgPSBnZXRKUFFMU3Ry\naW5nKHF1ZXJ5LCBpc05hbWVkKTsKICAgICAgICBTeXN0ZW0uZXJyLnByaW50\nbG4oKGRlbHRhIDwgMCA/ICIqKipXQVJOICIgOiAiIikgKyBNYXRoLmFicyhk\nZWx0YSkgKyAiJSAiICsgCiAgICAgICAgICAgICAgICAoZGVsdGEgPCAwID8g\nImRlZ3JhZHRpb24iIDogImltcHJvdmVtZW50IikgKyAiIGZvciBbIisganBx\nbCArICJdIik7CiAgICAgICAgYXNzZXJ0VHJ1ZShNYXRoLmFicyhkZWx0YSkg\nKyAiJSBkZWdyYWR0aW9uIGZvciBbIisganBxbCArICJdIiwgIUZBSUxfSUZf\nUEVSRl9ERUdSQURFIHx8IGRlbHRhID4gMCk7CiAgICB9CiAgICAKICAgIHZv\naWQgY29tcGFyZVNRTHMoTGlzdDxTdHJpbmc+IGEsIExpc3Q8U3RyaW5nPiBi\nKSB7CiAgICAgICAgYXNzZXJ0RXF1YWxzKGEuc2l6ZSgpLCBiLnNpemUoKSk7\nCiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBhLnNpemUoKTsgaSsrKSB7\nCiAgICAgICAgICAgIGFzc2VydEVxdWFscyhhLmdldChpKSwgYi5nZXQoaSkp\nOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIENyZWF0ZSBhIHF1\nZXJ5IGZyb20gdGhlIGdpdmVuIHN0cmluZyBhbmQgZXhlY3V0ZSBpdCBmb3Ig\nZ2l2ZW4gbnVtYmVyIG9mIHRpbWVzLgogICAgICogCiAgICAgKiBAcGFyYW0g\nanBxbCBhIFN0cmluZyByZXByZXNlbnRpbmcgZWl0aGVyIGEgSlBRTCBvciB0\naGUgbmFtZSBvZiBhIE5hbWVkUXVlcnkKICAgICAqIEBwYXJhbSBpc05hbWVk\nUXVlcnkgZmxhZ3MgaWYgdGhlIGZpcnN0IGlucHV0IHJlcHJlc2VudHMgYSBK\nUFFMIHN0cmluZyBvciBhIE5hbWVkUXVlcnkgbmFtZQogICAgICogQHBhcmFt\nIHBhcmFtcyBhIGV2ZW4gc2l6ZWQgYXJyYXkgd2hvc2UgZXZlbi1pbmRleGVk\nIGVsZW1lbnRzIGFyZSBrZXlzIGFuZCBvZGQtaW5kZXhlZCBlbGVtZW50cyBh\ncmUgY29ycmVzcG9uZGluZwogICAgICogcGFyYW1ldGVyIHZhbHVlIGZvciB0\naGUgcXVlcnkuIEEgbnVsbCBhcnJheSBkZW5vdGVzIHRoZSBxdWVyeSBpcyBu\nb3QgcGFyYW1ldGVyaXplZC4KICAgICAqIEBwYXJhbSBleHBlY3RlZENvdW50\nIGV4cGVjdGVkIG51bWJlciBvZiByZXN1bHRzLiBTdXBwbHkgYSBuZWdhdGl2\nZSBudW1iZXIgdG8gaWdub3JlLgogICAgICogQHBhcmFtIHVzZUNhY2hlIGZs\nYWdzIGlmIHRoZSBQcmVwYXJlZFF1ZXJ5IGNhY2hlIGlzIHRvIGJlIGFjdGl2\nYXRlZC4KICAgICAqIEBwYXJhbSBOIG51bWJlciBvZiB0aW1lcyB0aGUgcXVl\ncnkgaXMgdG8gYmUgZXhlY3V0ZWQgdG8gY2FsY3VsYXRlIHJlYXNvbmFibGUg\nc3RhdGlzdGljcy4KICAgICAqIAogICAgICogQHJldHVybiBtZWRpYW4gdGlt\nZSB0byBleGVjdXRlIGEgcXVlcnkgYW5kIGl0ZXJhdGUgdGhyb3VnaCBpdHMg\ncmVzdWx0cyAKICAgICAqLwogICAgbG9uZyBydW4oU3RyaW5nIGpwcWwsIGJv\nb2xlYW4gaXNOYW1lZFF1ZXJ5LCBPYmplY3RbXSBwYXJhbXMsIGludCBleHBl\nY3RlZENvdW50LCBib29sZWFuIHVzZUNhY2hlLCBpbnQgTikgewogICAgICAg\nIExpc3Q8TG9uZz4gc3RhdHMgPSBuZXcgQXJyYXlMaXN0PExvbmc+KCk7CiAg\nICAgICAgU3RyaW5nIGNhY2hlS2V5ID0gZ2V0SlBRTFN0cmluZyhqcHFsLCBp\nc05hbWVkUXVlcnkpOwogICAgICAgIFF1ZXJ5U3RhdGlzdGljczxTdHJpbmc+\nIGNhY2hlU3RhdHMgPSBnZXRQcmVwYXJlZFF1ZXJ5Q2FjaGUoKS5nZXRTdGF0\naXN0aWNzKCk7CiAgICAgICAgZ2V0UHJlcGFyZWRRdWVyeUNhY2hlKCkuY2xl\nYXIoKTsKICAgICAgICBhc3NlcnRFcXVhbHMoMCwgY2FjaGVTdGF0cy5nZXRF\neGVjdXRpb25Db3VudChjYWNoZUtleSkpOwogICAgICAgIGFzc2VydEVxdWFs\ncygwLCBjYWNoZVN0YXRzLmdldEhpdENvdW50KGNhY2hlS2V5KSk7CiAgICAg\nICAgCiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBOOyBpKyspIHsKICAg\nICAgICAgICAgT3BlbkpQQUVudGl0eU1hbmFnZXJTUEkgZW0gPSAoT3BlbkpQ\nQUVudGl0eU1hbmFnZXJTUEkpZW1mLmNyZWF0ZUVudGl0eU1hbmFnZXIoKTsK\nICAgICAgICAgICAgZW0uc2V0UXVlcnlTUUxDYWNoZSh1c2VDYWNoZSk7CiAg\nICAgICAgICAgIGFzc2VydEVxdWFscyh1c2VDYWNoZSwgZW0uZ2V0UXVlcnlT\nUUxDYWNoZSgpKTsKICAgICAgICAgICAgCiAgICAgICAgICAgIC8vIG1lYXN1\ncmUgdGltZSAKICAgICAgICAgICAgbG9uZyBzdGFydCA9IFN5c3RlbS5uYW5v\nVGltZSgpOwogICAgICAgICAgICBPcGVuSlBBUXVlcnk8Pz4gcSA9IGlzTmFt\nZWRRdWVyeSA/IGVtLmNyZWF0ZU5hbWVkUXVlcnkoanBxbCkgOiBlbS5jcmVh\ndGVRdWVyeShqcHFsKTsKICAgICAgICAgICAgcGFyYW1ldGVyaXplKHEsIHBh\ncmFtcyk7CiAgICAgICAgICAgIExpc3Q8Pz4gbGlzdCA9IHEuZ2V0UmVzdWx0\nTGlzdCgpOwogICAgICAgICAgICBpZiAoZXhwZWN0ZWRDb3VudCA+PSAwKQog\nICAgICAgICAgICAgICAgYXNzZXJ0RXF1YWxzKGV4cGVjdGVkQ291bnQsIGxp\nc3Quc2l6ZSgpKTsKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAg\nYXNzZXJ0RmFsc2UobGlzdC5pc0VtcHR5KCkpOwogICAgICAgICAgICBpdGVy\nYXRlKGxpc3QpOwogICAgICAgICAgICBsb25nIGVuZCA9IFN5c3RlbS5uYW5v\nVGltZSgpOyAgIAogICAgICAgICAgICAKICAgICAgICAgICAgYXNzZXJ0RXF1\nYWxzKHVzZUNhY2hlID8gaSsxIDogMCwgY2FjaGVTdGF0cy5nZXRFeGVjdXRp\nb25Db3VudChjYWNoZUtleSkpOwogICAgICAgICAgICBhc3NlcnRFcXVhbHMo\ndXNlQ2FjaGUgPyBpIDogMCwgICBjYWNoZVN0YXRzLmdldEhpdENvdW50KGNh\nY2hlS2V5KSk7CiAgICAgICAgICAgIAogICAgICAgICAgICBxLmNsb3NlQWxs\nKCk7CiAgICAgICAgICAgIHN0YXRzLmFkZChlbmQgLSBzdGFydCk7CiAgICAg\nICAgICAgIGVtLmNsb3NlKCk7CiAgICAgICAgfQogICAgICAgIGFzc2VydEVx\ndWFscygiRXhlY3V0aW9uIENvdW50IFsiICsgY2FjaGVLZXkgKyAiXSIsIHVz\nZUNhY2hlID8gTiA6IDAsIGNhY2hlU3RhdHMuZ2V0VG90YWxFeGVjdXRpb25D\nb3VudCgpKTsKICAgICAgICBhc3NlcnRFcXVhbHMoIkhpdCBDb3VudCBbIiAr\nIGNhY2hlS2V5ICsgIl0iLCB1c2VDYWNoZSA/IE4tMSA6IDAsIGNhY2hlU3Rh\ndHMuZ2V0VG90YWxIaXRDb3VudCgpKTsKICAgICAgICAKICAgICAgICBDb2xs\nZWN0aW9ucy5zb3J0KHN0YXRzKTsKICAgICAgICByZXR1cm4gc3RhdHMuZ2V0\nKE4vMik7CiAgICB9ICAgCiAgICAKICAgIAogICAgdm9pZCBwYXJhbWV0ZXJp\nemUoUXVlcnkgcSwgT2JqZWN0W10gcGFyYW1zKSB7CiAgICAgICAgaWYgKHBh\ncmFtcyA9PSBudWxsKQogICAgICAgICAgICByZXR1cm47CiAgICAgICAgZm9y\nIChpbnQgaiA9IDA7IHBhcmFtcyAhPSBudWxsICYmIGogPCBwYXJhbXMubGVu\nZ3RoIC0gMTsgaiArPSAyKSB7CiAgICAgICAgICAgIE9iamVjdCBrZXkgPSBw\nYXJhbXNbal07CiAgICAgICAgICAgIE9iamVjdCB2YWwgPSBwYXJhbXNbaiAr\nIDFdOwogICAgICAgICAgICBpZiAoa2V5IGluc3RhbmNlb2YgSW50ZWdlcikK\nICAgICAgICAgICAgICAgIHEuc2V0UGFyYW1ldGVyKCgoTnVtYmVyKWtleSku\naW50VmFsdWUoKSwgdmFsKTsgCiAgICAgICAgICAgIGVsc2UgaWYgKGtleSBp\nbnN0YW5jZW9mIFN0cmluZykKICAgICAgICAgICAgICAgIHEuc2V0UGFyYW1l\ndGVyKGtleS50b1N0cmluZygpLCB2YWwpOyAKICAgICAgICAgICAgZWxzZQog\nICAgICAgICAgICAgICAgZmFpbCgia2V5ICIgKyBrZXkgKyAiIGlzIG5laXRo\nZXIgTnVtYmVyIG5vciBTdHJpbmciKTsKICAgICAgICB9CiAgICB9CiAgICAK\nICAgIHZvaWQgaXRlcmF0ZShMaXN0PD8+IGxpc3QpIHsKICAgICAgICBJdGVy\nYXRvcjw/PiBpID0gbGlzdC5pdGVyYXRvcigpOwogICAgICAgIHdoaWxlIChp\nLmhhc05leHQoKSkKICAgICAgICAgICAgaS5uZXh0KCk7CiAgICB9CiAgICAK\nICAgIC8qKgogICAgICogR2V0cyB0aGUgSlBRTCBTdHJpbmcgb2YgYSBOYW1l\nZFF1ZXJ5IG9mIHRoZSBnaXZlbiBuYW1lLgogICAgICovCiAgICBTdHJpbmcg\nZ2V0SlBRTFN0cmluZyhTdHJpbmcgbmFtZSwgYm9vbGVhbiBpc05hbWVkUXVl\ncnkpIHsKICAgICAgICBpZiAoIWlzTmFtZWRRdWVyeSkKICAgICAgICAgICAg\ncmV0dXJuIG5hbWU7CiAgICAgICAgcmV0dXJuIGVtZi5nZXRDb25maWd1cmF0\naW9uKCkKICAgICAgICAgICAgICAgICAgLmdldE1ldGFEYXRhUmVwb3NpdG9y\neUluc3RhbmNlKCkKICAgICAgICAgICAgICAgICAgLmdldFF1ZXJ5TWV0YURh\ndGEobnVsbCwgbmFtZSwgbnVsbCwgdHJ1ZSkKICAgICAgICAgICAgICAgICAg\nLmdldFF1ZXJ5U3RyaW5nKCk7CiAgICB9CgoKICAgIC8qKgogICAgICogQSBK\nREJDIExpc3RlbmVyIHRvIGF1ZGl0IHRhcmdldCBTUUwgZXhlY3V0ZWQgcGVy\nIEpQUUwgcXVlcnkuCiAgICAgKgogICAgICovCiAgICBwdWJsaWMgY2xhc3Mg\nU1FMQXVkaXRvciBleHRlbmRzIEFic3RyYWN0SkRCQ0xpc3RlbmVyIHsKICAg\nICAgICBwcml2YXRlIExpc3Q8U3RyaW5nPiBzcWxzID0gbmV3IEFycmF5TGlz\ndDxTdHJpbmc+KCk7CiAgICAKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBw\ndWJsaWMgdm9pZCBiZWZvcmVFeGVjdXRlU3RhdGVtZW50KEpEQkNFdmVudCBl\ndmVudCkgewogICAgICAgICAgICBpZiAoZXZlbnQuZ2V0U1FMKCkgIT0gbnVs\nbCAmJiBzcWxzICE9IG51bGwpIHsKICAgICAgICAgICAgICAgc3Fscy5hZGQo\nZXZlbnQuZ2V0U1FMKCkpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAg\nICAgIAogICAgICAgIHZvaWQgY2xlYXIoKSB7CiAgICAgICAgICAgIHNxbHMu\nY2xlYXIoKTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgTGlzdDxTdHJp\nbmc+IGdldFNRTHMoKSB7CiAgICAgICAgICAgIHJldHVybiBuZXcgQXJyYXlM\naXN0PFN0cmluZz4oc3Fscyk7CiAgICAgICAgfQogICAgfQogICAgCiAgICBw\ndWJsaWMgc3RhdGljIGNsYXNzIFF1ZXJ5VGhyZWFkIGltcGxlbWVudHMgUnVu\nbmFibGUgewogICAgICAgIHByaXZhdGUgZmluYWwgT3BlbkpQQUVudGl0eU1h\nbmFnZXIgZW07CiAgICAgICAgcHJpdmF0ZSBmaW5hbCBTdHJpbmcganBxbDsK\nICAgICAgICBwcml2YXRlIGJvb2xlYW4gZmFpbGVkID0gZmFsc2U7CiAgICAg\nICAgcHVibGljIFF1ZXJ5VGhyZWFkKE9wZW5KUEFFbnRpdHlNYW5hZ2VyIGVt\nLCBTdHJpbmcganBxbCkgewogICAgICAgICAgICBzdXBlcigpOwogICAgICAg\nICAgICB0aGlzLmVtID0gZW07CiAgICAgICAgICAgIHRoaXMuanBxbCA9IGpw\ncWw7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIHB1YmxpYyB2b2lkIHJ1\nbigpIHsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIGZvciAo\naW50IGkgPSAwOyBpIDwgMTAgJiYgIWZhaWxlZDsgaSsrKSB7CiAgICAgICAg\nICAgICAgICAgICAgT3BlbkpQQVF1ZXJ5IHEgPSBlbS5jcmVhdGVRdWVyeShq\ncHFsKTsKICAgICAgICAgICAgICAgICAgICBxLnNldFBhcmFtZXRlcigibmFt\nZSIsICJBdXRob3ItIitpKTsKICAgICAgICAgICAgICAgICAgICBxLmdldFJl\nc3VsdExpc3QoKTsKICAgICAgICAgICAgICAgICAgICBpZiAoaSA+IDEpIAog\nICAgICAgICAgICAgICAgICAgICAgICBhc3NlcnRFcXVhbHMoUXVlcnlMYW5n\ndWFnZXMuTEFOR19QUkVQQVJFRF9TUUwsIHEuZ2V0TGFuZ3VhZ2UoKSk7CiAg\nICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlv\nbiBlKSB7CiAgICAgICAgICAgICAgICBlLnByaW50U3RhY2tUcmFjZSgpOwog\nICAgICAgICAgICAgICAgZmFpbGVkID0gdHJ1ZTsKICAgICAgICAgICAgfQog\nICAgICAgIH0KICAgICAgICAKICAgICAgICBwdWJsaWMgYm9vbGVhbiBpc0Zh\naWxlZCgpIHsKICAgICAgICAgICAgcmV0dXJuIGZhaWxlZDsKICAgICAgICB9\nCiAgICAgICAgCiAgICB9Cgp9Cg==\n","encoding":"base64"}

