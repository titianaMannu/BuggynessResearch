{"sha":"5b141f0487007cfd1862921da433a01b59565176","node_id":"MDQ6QmxvYjIwNjM2NDo1YjE0MWYwNDg3MDA3Y2ZkMTg2MjkyMWRhNDMzYTAxYjU5NTY1MTc2","size":7382,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/5b141f0487007cfd1862921da433a01b59565176","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UudGVzdDsK\nCmltcG9ydCBqYXZhLnV0aWwuTGlzdDsKCmltcG9ydCBqYXZheC5wZXJzaXN0\nZW5jZS5FbnRpdHlNYW5hZ2VyOwoKaW1wb3J0IG9yZy5hcGFjaGUub3Blbmpw\nYS5qZGJjLmNvbmYuSkRCQ0NvbmZpZ3VyYXRpb247CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEuamRiYy5tZXRhLkNsYXNzTWFwcGluZzsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNxbC5EQkRpY3Rpb25hcnk7CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLmxvZy5Mb2c7CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuT3BlbkpQQUVudGl0eU1hbmFn\nZXJGYWN0b3J5U1BJOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNp\nc3RlbmNlLk9wZW5KUEFFbnRpdHlNYW5hZ2VyU1BJOwoKLyoqCiAqIEJhc2Ug\nY2xhc3MgZm9yIE9wZW5KUEEtc3BlY2lmaWMgVGVzdCBDYXNlLgogKiBQcm92\naWRlcyB1dGlsaXRpZXMgZm9yIGNvbmZpZ3VyYXRpb24gc2V0dXAgYW5kIHBl\ncnNpc3RlbnQgZW50aXR5IAogKiByZWdpc3RyYXRpb24gZHVyaW5nIHNldFVw\nKCkgbWV0aG9kLgogKiBEZXJpdmVkIGNsYXNzZXMgY2FuIGFjY2VzcyBwcm90\nZWN0ZWQgRW50aXR5TWFuYWdlckZhY3RvcnkgdG8gY3JlYXRlIAogKiBFbnRp\ndHlNYW5hZ2VyLiBUaGUgcHJvdGVjdGVkIEVudGl0eU1hbmFnZXJGYWN0b3J5\nIGlzIGRlY2xhcmVkIHRvIGJlCiAqIE9wZW5KUEEtZXh0ZW5kZWQgU1BJIGlu\ndGVyZmFjZSA8Y29kZT5PcGVuSlBBRW50aXR5TWFuYWdlckZhY3RvcnlTUEk8\nL2NvZGU+CiAqIHNvIHRoYXQgZGVyaXZlZCBjbGFzc2VzIGNhbiBhY2Nlc3Mg\naW50ZXJuYWwgbWFwcGluZy9tZXRhZGF0YS9jb25maWd1cmF0aW9uCiAqIGFu\nZCBvdGhlciBzdHJ1Y3R1cmVzLiAgCiAqICAgCiAqLwpwdWJsaWMgYWJzdHJh\nY3QgY2xhc3MgU2luZ2xlRU1GVGVzdENhc2UKICAgIGV4dGVuZHMgQWJzdHJh\nY3RDYWNoZWRFTUZUZXN0Q2FzZSAgewoKICAgIHByb3RlY3RlZCBPcGVuSlBB\nRW50aXR5TWFuYWdlckZhY3RvcnlTUEkgZW1mOwoKICAgIC8qKgogICAgICog\nQ2FsbCB7QGxpbmsgI3NldFVwKE9iamVjdC4uLiBwcm9wcyl9IHdpdGggbm8g\nYXJndW1lbnRzIHNvIHRoYXQgdGhlIGVtZgogICAgICogc2V0LXVwIGhhcHBl\nbnMgZXZlbiBpZiA8Y29kZT5zZXRVcCgpPC9jb2RlPiBpcyBub3QgY2FsbGVk\nIGZyb20gdGhlCiAgICAgKiBzdWJjbGFzcy4KICAgICAqLwogICAgcHVibGlj\nIHZvaWQgc2V0VXAoKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBzdXBl\nci5zZXRVcCgpOwogICAgICAgIHNldFVwKG5ldyBPYmplY3RbMF0pOwogICAg\nfQoKICAgIC8qKgogICAgICogSW5pdGlhbGl6ZSBlbnRpdHkgbWFuYWdlciBm\nYWN0b3J5LiBQdXQge0BsaW5rICNDTEVBUl9UQUJMRVN9IGluCiAgICAgKiB0\naGlzIGxpc3QgdG8gdGVsbCB0aGUgdGVzdCBmcmFtZXdvcmsgdG8gZGVsZXRl\nIGFsbCB0YWJsZSBjb250ZW50cwogICAgICogYmVmb3JlIHJ1bm5pbmcgdGhl\nIHRlc3RzLgogICAgICoKICAgICAqIEBwYXJhbSBwcm9wcyBsaXN0IG9mIHBl\ncnNpc3RlbnQgdHlwZXMgdXNlZCBpbiB0ZXN0aW5nIGFuZC9vciAKICAgICAq\nIGNvbmZpZ3VyYXRpb24gdmFsdWVzIGluIHRoZSBmb3JtIGtleSx2YWx1ZSxr\nZXksdmFsdWUuLi4KICAgICAqLwogICAgcHJvdGVjdGVkIHZvaWQgc2V0VXAo\nT2JqZWN0Li4uIHByb3BzKSB7CiAgICAgICAgZW1mID0gY3JlYXRlRU1GKHBy\nb3BzKTsKICAgIH0KCiAgICAvKioKICAgICAqIENsb3NlcyB0aGUgZW50aXR5\nIG1hbmFnZXIgZmFjdG9yeS4KICAgICAqLwogICAgcHVibGljIHZvaWQgdGVh\nckRvd24oKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBzdXBlci50ZWFy\nRG93bigpOwoKICAgICAgICBpZiAoZW1mID09IG51bGwpCiAgICAgICAgICAg\nIHJldHVybjsKCiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgY2xlYXIoZW1m\nKTsKICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkgewogICAgICAgICAg\nICAvLyBpZiBhIHRlc3QgZmFpbGVkLCBzd2FsbG93IGFueSBleGNlcHRpb25z\nIHRoYXQgaGFwcGVuCiAgICAgICAgICAgIC8vIGR1cmluZyB0ZWFyLWRvd24s\nIGFzIHRoZXNlIGp1c3QgbWFzayB0aGUgb3JpZ2luYWwgcHJvYmxlbS4KICAg\nICAgICAgICAgaWYgKHRlc3RSZXN1bHQud2FzU3VjY2Vzc2Z1bCgpKQogICAg\nICAgICAgICAgICAgdGhyb3cgZTsKICAgICAgICB9IGZpbmFsbHkgewogICAg\nICAgICAgICBjbG9zZUVNRihlbWYpOwogICAgICAgIH0KICAgIH0KICAgIAog\nICAgLyoqCiAgICAgKiBHZXQgdGhlIGNsYXNzIG1hcHBpbmcgZm9yIGEgZ2l2\nZW4gZW50aXR5CiAgICAgKiAKICAgICAqIEBwYXJhbSBuYW1lIFRoZSBFbnRp\ndHkncyBuYW1lLgogICAgICogCiAgICAgKiBAcmV0dXJuIElmIHRoZSBlbnRp\ndHkgaXMgYSBrbm93biB0eXBlIHRoZSBDbGFzc01hcHBpbmcgZm9yIHRoZSBF\nbnRpdHkKICAgICAqICAgICAgICAgd2lsbCBiZSByZXR1cm5lZC4gT3RoZXJ3\naXNlIG51bGwKICAgICAqLwogICAgcHJvdGVjdGVkIENsYXNzTWFwcGluZyBn\nZXRNYXBwaW5nKFN0cmluZyBuYW1lKSB7CiAgICAgICAgcmV0dXJuIChDbGFz\nc01hcHBpbmcpIGVtZi5nZXRDb25maWd1cmF0aW9uKCkKICAgICAgICAgICAg\nICAgIC5nZXRNZXRhRGF0YVJlcG9zaXRvcnlJbnN0YW5jZSgpLmdldE1ldGFE\nYXRhKG5hbWUsCiAgICAgICAgICAgICAgICAgICAgICAgIGdldENsYXNzKCku\nZ2V0Q2xhc3NMb2FkZXIoKSwgdHJ1ZSk7CiAgICB9CiAgICAKICAgIC8qKgog\nICAgICogR2V0IHRoZSBjbGFzcyBtYXBwaW5nIGZvciBhIGdpdmVuIGVudGl0\neQogICAgICogCiAgICAgKiBAcGFyYW0gZW50aXR5Q2xhc3MgYW4gZW50aXR5\nIGNsYXNzLgogICAgICogCiAgICAgKiBAcmV0dXJuIElmIHRoZSBlbnRpdHkg\naXMgYSBrbm93biB0eXBlIHRoZSBDbGFzc01hcHBpbmcgZm9yIHRoZSBFbnRp\ndHkKICAgICAqICAgICAgICAgd2lsbCBiZSByZXR1cm5lZC4gT3RoZXJ3aXNl\nIG51bGwKICAgICAqLwogICAgcHJvdGVjdGVkIENsYXNzTWFwcGluZyBnZXRN\nYXBwaW5nKENsYXNzPD8+IGVudGl0eUNsYXNzKSB7CiAgICAgICAgcmV0dXJu\nIChDbGFzc01hcHBpbmcpIGVtZi5nZXRDb25maWd1cmF0aW9uKCkKICAgICAg\nICAgICAgICAgIC5nZXRNZXRhRGF0YVJlcG9zaXRvcnlJbnN0YW5jZSgpLmdl\ndE1ldGFEYXRhKGVudGl0eUNsYXNzLAogICAgICAgICAgICAgICAgICAgICAg\nICBnZXRDbGFzcygpLmdldENsYXNzTG9hZGVyKCksIHRydWUpOwogICAgfQog\nICAgCiAgICAvKioKICAgICAqIEdldCBudW1iZXIgb2YgaW5zdGFuY2VzIGJ5\nIGFuIGFnZ3JlZ2F0ZSBxdWVyeSB3aXRoIHRoZSBnaXZlbiBhbGlhcy4KICAg\nICAqLwogICAgcHVibGljIGludCBjb3VudChTdHJpbmcgYWxpYXMpIHsKICAg\nICAgICByZXR1cm4gKChOdW1iZXIpZW1mLmNyZWF0ZUVudGl0eU1hbmFnZXIo\nKS5jcmVhdGVRdWVyeSgKICAgICAgICAgICAgICAgICJTRUxFQ1QgQ09VTlQo\ncCkgRlJPTSAiICsgYWxpYXMgKyAiIHAiKQogICAgICAgICAgICAgICAgLmdl\ndFNpbmdsZVJlc3VsdCgpKS5pbnRWYWx1ZSgpOwogICAgfQogICAgCiAgICAv\nKioKICAgICAqIENvdW50IG51bWJlciBvZiBpbnN0YW5jZXMgb2YgdGhlIGdp\ndmVuIGNsYXNzIGFzc3VtaW5nIHRoYXQgdGhlIGFsaWFzCiAgICAgKiBmb3Ig\ndGhlIGNsYXNzIGlzIGl0cyBzaW1wbGUgbmFtZS4KICAgICAqLwogICAgcHVi\nbGljIGludCBjb3VudChDbGFzczw/PiBjKSB7CiAgICAJcmV0dXJuIGNvdW50\nKGdldEFsaWFzKGMpKTsKICAgIH0KICAgIAogICAgLyoqCiAgICAgKiBHZXQg\nYWxsIHRoZSBpbnN0YW5jZXMgb2YgZ2l2ZW4gdHlwZS4KICAgICAqIFRoZSBy\nZXR1cm5lZCBpbnN0YW5jZXMgYXJlIG9idGFpbmVkIHdpdGhvdXQgYSBwZXJz\naXN0ZW5jZSBjb250ZXh0LiAKICAgICAqLwogICAgQFN1cHByZXNzV2Fybmlu\nZ3MoInVuY2hlY2tlZCIpCiAgICBwdWJsaWMgPFQ+IExpc3Q8VD4gZ2V0QWxs\nKENsYXNzPFQ+IHQpIHsKICAgICAgICByZXR1cm4gKExpc3Q8VD4pZW1mLmNy\nZWF0ZUVudGl0eU1hbmFnZXIoKS5jcmVhdGVRdWVyeSgKICAgICAgICAgICAg\nICAgICJTRUxFQ1QgcCBGUk9NICIgKyBnZXRBbGlhcyh0KSArICIgcCIpLmdl\ndFJlc3VsdExpc3QoKTsKICAgIH0KICAgIAogICAgLyoqCiAgICAgKiBHZXQg\nYWxsIHRoZSBpbnN0YW5jZXMgb2YgZ2l2ZW4gdHlwZS4KICAgICAqIFRoZSBy\nZXR1cm5lZCBpbnN0YW5jZXMgYXJlIG9idGFpbmVkIHdpdGhpbiB0aGUgZ2l2\nZW4gcGVyc2lzdGVuY2UgY29udGV4dC4KICAgICAqLwogICAgQFN1cHByZXNz\nV2FybmluZ3MoInVuY2hlY2tlZCIpCiAgICBwdWJsaWMgPFQ+IExpc3Q8VD4g\nZ2V0QWxsKEVudGl0eU1hbmFnZXIgZW0sIENsYXNzPFQ+IHQpIHsKICAgIAly\nZXR1cm4gKExpc3Q8VD4pZW0uY3JlYXRlUXVlcnkoIlNFTEVDVCBwIEZST00g\nIiArIGdldEFsaWFzKHQpICsgIiBwIikKCQkJCSAgIC5nZXRSZXN1bHRMaXN0\nKCk7CiAgICB9CiAgICAKICAgIHB1YmxpYyBTdHJpbmcgZ2V0QWxpYXMoQ2xh\nc3M8Pz4gdCkgewogICAgICAgIHJldHVybiBlbWYuZ2V0Q29uZmlndXJhdGlv\nbigpLmdldE1ldGFEYXRhUmVwb3NpdG9yeUluc3RhbmNlKCkKICAgICAgICAg\nICAgLmdldE1ldGFEYXRhKHQsIG51bGwsIHRydWUpLmdldFR5cGVBbGlhcygp\nOwogICAgfQoKICAgIHByb3RlY3RlZCBDbGFzc01hcHBpbmcgW10gZ2V0TWFw\ncGluZ3MoKSB7CiAgICAgICAgcmV0dXJuIChDbGFzc01hcHBpbmcgW10gKSBl\nbWYuZ2V0Q29uZmlndXJhdGlvbigpLmdldE1ldGFEYXRhUmVwb3NpdG9yeUlu\nc3RhbmNlKCkuZ2V0TWV0YURhdGFzKCk7ICAgCiAgICB9CiAgICAKICAgIHBy\nb3RlY3RlZCB2b2lkIHNldFVuc3VwcG9ydGVkRGF0YWJhc2VzKENsYXNzPD8+\nIC4uLiBkYnMpIHsKICAgICAgICBPcGVuSlBBRW50aXR5TWFuYWdlckZhY3Rv\ncnlTUEkgdGVtcEVNRiA9IGVtZjsKICAgICAgICBpZiAodGVtcEVNRiA9PSBu\ndWxsKSB7CiAgICAgICAgICAgIHRlbXBFTUYgPSBjcmVhdGVFTUYoKTsKICAg\nICAgICB9CiAgICAgICAgREJEaWN0aW9uYXJ5IGRpY3QgPSAoKEpEQkNDb25m\naWd1cmF0aW9uKXRlbXBFTUYuZ2V0Q29uZmlndXJhdGlvbigpKS5nZXREQkRp\nY3Rpb25hcnlJbnN0YW5jZSgpOwogICAgICAgIGZvciAoQ2xhc3M8Pz4gZGIg\nOiBkYnMpIHsKICAgICAgICAgICAgaWYgKGRpY3QuZ2V0Q2xhc3MoKS5nZXRD\nYW5vbmljYWxOYW1lKCkuZXF1YWxzSWdub3JlQ2FzZShkYi5nZXRDYW5vbmlj\nYWxOYW1lKCkpKSB7CiAgICAgICAgICAgICAgICBzZXRUZXN0c0Rpc2FibGVk\nKHRydWUpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0K\nICAgICAgICB9CiAgICAgICAgaWYgKGVtZiA9PSBudWxsKSB7CiAgICAgICAg\nICAgIGNsb3NlRU1GKHRlbXBFTUYpOwogICAgICAgIH0KICAgIH0KICAgIAog\nICAgcHJvdGVjdGVkIHZvaWQgc2V0U3VwcG9ydGVkRGF0YWJhc2VzKENsYXNz\nPD8+IC4uLiBkYnMpIHsKICAgICAgICBPcGVuSlBBRW50aXR5TWFuYWdlckZh\nY3RvcnlTUEkgdGVtcEVNRiA9IGVtZjsKICAgICAgICBpZiAodGVtcEVNRiA9\nPSBudWxsKSB7CiAgICAgICAgICAgIHRlbXBFTUYgPSBjcmVhdGVFTUYoKTsK\nICAgICAgICB9CiAgICAgICAgREJEaWN0aW9uYXJ5IGRpY3QgPSAoKEpEQkND\nb25maWd1cmF0aW9uKXRlbXBFTUYuZ2V0Q29uZmlndXJhdGlvbigpKS5nZXRE\nQkRpY3Rpb25hcnlJbnN0YW5jZSgpOwogICAgICAgIGJvb2xlYW4gc3VwcG9y\ndGVkREIgPSBmYWxzZTsKICAgICAgICBmb3IgKENsYXNzPD8+IGRiIDogZGJz\nKSB7CiAgICAgICAgICAgIGlmIChkaWN0LmdldENsYXNzKCkuZ2V0Q2Fub25p\nY2FsTmFtZSgpLmVxdWFsc0lnbm9yZUNhc2UoZGIuZ2V0Q2Fub25pY2FsTmFt\nZSgpKSkgewogICAgICAgICAgICAgICAgc3VwcG9ydGVkREIgPSB0cnVlOwog\nICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICB9\nCiAgICAgICAgc2V0VGVzdHNEaXNhYmxlZCghc3VwcG9ydGVkREIpOwogICAg\nICAgIGlmIChlbWYgPT0gbnVsbCkgewogICAgICAgICAgICBjbG9zZUVNRih0\nZW1wRU1GKTsKICAgICAgICB9CiAgICB9CiAgICAKICAgIHByb3RlY3RlZCBM\nb2cgZ2V0TG9nKCkgewogICAgICAgIHJldHVybiBlbWYuZ2V0Q29uZmlndXJh\ndGlvbigpLmdldExvZygiVGVzdHMiKTsKICAgIH0KICAgIAogICAgcHJvdGVj\ndGVkIFN0cmluZyBnZXRGb3JVcGRhdGVDbGF1c2UoKSB7CiAgICAgICAgREJE\naWN0aW9uYXJ5IGRpY3QgPSAoKEpEQkNDb25maWd1cmF0aW9uKSBlbWYuZ2V0\nQ29uZmlndXJhdGlvbigpKS5nZXREQkRpY3Rpb25hcnlJbnN0YW5jZSgpOwog\nICAgICAgIGlmIChkaWN0LmZvclVwZGF0ZUNsYXVzZSAhPSBudWxsKSB7CiAg\nICAgICAgICAgIHJldHVybiBkaWN0LmZvclVwZGF0ZUNsYXVzZTsKICAgICAg\nICB9CiAgICAgICAgaWYgKGRpY3QudGFibGVGb3JVcGRhdGVDbGF1c2UgIT0g\nbnVsbCkgewogICAgICAgICAgICByZXR1cm4gZGljdC50YWJsZUZvclVwZGF0\nZUNsYXVzZTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuICIiOwogICAgfQp9\nCgo=\n","encoding":"base64"}

