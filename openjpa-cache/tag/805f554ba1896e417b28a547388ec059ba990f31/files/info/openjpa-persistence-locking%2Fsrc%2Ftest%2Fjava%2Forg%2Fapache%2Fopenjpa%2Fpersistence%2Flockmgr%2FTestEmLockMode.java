{"sha":"daee91e131ace28349f6ad1dea17b5c0fae74f7a","node_id":"MDQ6QmxvYjIwNjM2NDpkYWVlOTFlMTMxYWNlMjgzNDlmNmFkMWRlYTE3YjVjMGZhZTc0Zjdh","size":13956,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/daee91e131ace28349f6ad1dea17b5c0fae74f7a","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNr\nYWdlIG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5sb2NrbWdyOwoK\naW1wb3J0IGphdmF4LnBlcnNpc3RlbmNlLkVudGl0eU1hbmFnZXI7CmltcG9y\ndCBqYXZheC5wZXJzaXN0ZW5jZS5Mb2NrTW9kZVR5cGU7CmltcG9ydCBqYXZh\neC5wZXJzaXN0ZW5jZS5UcmFuc2FjdGlvblJlcXVpcmVkRXhjZXB0aW9uOwoK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLmNvbmYuSkRCQ0NvbmZp\nZ3VyYXRpb247CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5rZXJu\nZWwuSkRCQ0ZldGNoQ29uZmlndXJhdGlvbkltcGw7CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEuamRiYy5zcWwuREIyRGljdGlvbmFyeTsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNxbC5EQkRpY3Rpb25hcnk7CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuRW50aXR5TWFuYWdl\nckltcGw7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2Uu\nT3BlbkpQQUVudGl0eU1hbmFnZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEucGVyc2lzdGVuY2UuT3BlbkpQQUVudGl0eU1hbmFnZXJTUEk7CgovKioK\nICogVGVzdCBoaW50cyB1c2luZyBFbnRpdHlNYW5hZ2VyIGludGVyZmFjZS4K\nICovCnB1YmxpYyBjbGFzcyBUZXN0RW1Mb2NrTW9kZSBleHRlbmRzIFNlcXVl\nbmNlZEFjdGlvbnNUZXN0IHsKICAgIHByaXZhdGUgc3RhdGljIFN0cmluZyBO\nT05fU1VQUE9SVEVEX09QVElNSVNUSUNfU1FMID0gCiAgICAgICAgIlNFTEVD\nVCAuKiBGUk9NIExvY2tFbXBsb3llZSAuKiI7CiAgICBwcml2YXRlIHN0YXRp\nYyBTdHJpbmcgTk9OX1NVUFBPUlRFRF9GT1JfVVBEQVRFX1NRTCA9ICIiIDsg\nLy8gYXBwZW5kIGxvY2sgY2xhdXNlIGZyb20gZGljdAogICAgcHJpdmF0ZSBz\ndGF0aWMgU3RyaW5nIFZFUlNJT05fVVBEQVRFX1NRTCA9IAogICAgICAgICJV\nUERBVEUgTG9ja0VtcGxveWVlIFNFVCB2ZXJzaW9uIC4qIFdIRVJFIC4qIjsK\nICAgIHByaXZhdGUgc3RhdGljIFN0cmluZyBEQjJfT1BUSU1JU1RJQ19TUUwg\nPSAKICAgICAgICAiU0VMRUNUIC4qIEZST00gTG9ja0VtcGxveWVlIC4qIFdI\nRVJFIC4qIjsKICAgIHByaXZhdGUgc3RhdGljIFN0cmluZyBEQjJfUEVTU0lN\nSVNUSUNfUlNfU1FMID0gCiAgICAgICAgIlNFTEVDVCAuKiBGUk9NIExvY2tF\nbXBsb3llZSAuKiBXSVRIIFJTIFVTRSAuKiI7CiAgICBwcml2YXRlIHN0YXRp\nYyBTdHJpbmcgREIyX1BFU1NJTUlTVElDX1JSX1NRTCA9IAogICAgICAgICJT\nRUxFQ1QgLiogRlJPTSBMb2NrRW1wbG95ZWUgLiogV0lUSCBSUiBVU0UgLioi\nOwoKICAgIHB1YmxpYyB2b2lkIHNldFVwKCkgewogICAgICAgIHNldFVwKExv\nY2tFbXBsb3llZS5jbGFzcywgIm9wZW5qcGEuTG9ja01hbmFnZXIiLCAibWl4\nZWQiKTsKICAgICAgICBjb21tb25TZXRVcCgpOwogICAgICAgIE5PTl9TVVBQ\nT1JURURfRk9SX1VQREFURV9TUUwgPSBOT05fU1VQUE9SVEVEX09QVElNSVNU\nSUNfU1FMICsgIiAiICsgZXNjYXBlUmVnZXgoZ2V0Rm9yVXBkYXRlQ2xhdXNl\nKCkpICsgIi4qIjsKICAgIH0KICAgIAogICAgcHJpdmF0ZSBTdHJpbmcgZXNj\nYXBlUmVnZXgoU3RyaW5nIGNsYXVzZSkgewogICAgICAgIC8vIGVzY2FwZSBh\nbiB1cGRhdGUgY2xhdXNlIGZvciB1c2UgaW4gYSByZWdleC4gCiAgICAgICAg\nLy8gb25seSBoYW5kbGluZyAoICkgZm9yIG5vdwogICAgICAgIFN0cmluZyBy\ndmFsID0gY2xhdXNlLnJlcGxhY2UoIigiLCAiXFwoIik7CiAgICAgICAgcnZh\nbCA9IHJ2YWwucmVwbGFjZSgiKSIsICJcXCkiKTsKICAgICAgICByZXR1cm4g\ncnZhbDsKICAgIH0KCiAgICAvKgogICAgICogVGVzdCBlbS5maW5kKGxvY2tt\nb2RlKTsKICAgICAqLwogICAgcHVibGljIHZvaWQgdGVzdEZpbmRMb2NrTW9k\nZUlzb2xhdGlvbnMoKSB7CiAgICAgICAgRW50aXR5TWFuYWdlciBlbSA9IGVt\nZi5jcmVhdGVFbnRpdHlNYW5hZ2VyKCk7CgogICAgICAgIGVtLmdldFRyYW5z\nYWN0aW9uKCkuYmVnaW4oKTsKCiAgICAgICAgY29tbW9uVGVzdEZpbmRMb2Nr\nTW9kZUlzb2xhdGlvbnMoZW0sIExvY2tNb2RlVHlwZS5OT05FLCAxLAogICAg\nICAgICAgICBEQjJfT1BUSU1JU1RJQ19TUUwsIDEsIE5PTl9TVVBQT1JURURf\nT1BUSU1JU1RJQ19TUUwsIDAsIG51bGwpOwogICAgICAgIGNvbW1vblRlc3RG\naW5kTG9ja01vZGVJc29sYXRpb25zKGVtLCBMb2NrTW9kZVR5cGUuUkVBRCwg\nMSwKICAgICAgICAgICAgREIyX09QVElNSVNUSUNfU1FMLCAxLCBOT05fU1VQ\nUE9SVEVEX09QVElNSVNUSUNfU1FMLCAxLAogICAgICAgICAgICBOT05fU1VQ\nUE9SVEVEX09QVElNSVNUSUNfU1FMKTsKICAgICAgICBjb21tb25UZXN0Rmlu\nZExvY2tNb2RlSXNvbGF0aW9ucyhlbSwgTG9ja01vZGVUeXBlLldSSVRFLCAx\nLAogICAgICAgICAgICBEQjJfT1BUSU1JU1RJQ19TUUwsIDEsIE5PTl9TVVBQ\nT1JURURfT1BUSU1JU1RJQ19TUUwsIDEsCiAgICAgICAgICAgIFZFUlNJT05f\nVVBEQVRFX1NRTCk7CiAgICAgICAgY29tbW9uVGVzdEZpbmRMb2NrTW9kZUlz\nb2xhdGlvbnMoZW0sIExvY2tNb2RlVHlwZS5PUFRJTUlTVElDLCAxLAogICAg\nICAgICAgICBEQjJfT1BUSU1JU1RJQ19TUUwsIDEsIE5PTl9TVVBQT1JURURf\nT1BUSU1JU1RJQ19TUUwsIDEsCiAgICAgICAgICAgIE5PTl9TVVBQT1JURURf\nT1BUSU1JU1RJQ19TUUwpOwogICAgICAgIGNvbW1vblRlc3RGaW5kTG9ja01v\nZGVJc29sYXRpb25zKGVtLAogICAgICAgICAgICBMb2NrTW9kZVR5cGUuT1BU\nSU1JU1RJQ19GT1JDRV9JTkNSRU1FTlQsIDEsIERCMl9PUFRJTUlTVElDX1NR\nTCwgMSwKICAgICAgICAgICAgTk9OX1NVUFBPUlRFRF9PUFRJTUlTVElDX1NR\nTCwgMSwgVkVSU0lPTl9VUERBVEVfU1FMKTsKICAgICAgICBjb21tb25UZXN0\nRmluZExvY2tNb2RlSXNvbGF0aW9ucyhlbSwgTG9ja01vZGVUeXBlLlBFU1NJ\nTUlTVElDX1JFQUQsIDIsCiAgICAgICAgICAgIERCMl9QRVNTSU1JU1RJQ19S\nU19TUUwsIDIsIE5PTl9TVVBQT1JURURfRk9SX1VQREFURV9TUUwsIDEsCiAg\nICAgICAgICAgIE5PTl9TVVBQT1JURURfT1BUSU1JU1RJQ19TUUwpOwogICAg\nICAgIGNvbW1vblRlc3RGaW5kTG9ja01vZGVJc29sYXRpb25zKGVtLCBMb2Nr\nTW9kZVR5cGUuUEVTU0lNSVNUSUNfV1JJVEUsIDIsCiAgICAgICAgICAgIERC\nMl9QRVNTSU1JU1RJQ19SUl9TUUwsIDIsIE5PTl9TVVBQT1JURURfRk9SX1VQ\nREFURV9TUUwsIDEsCiAgICAgICAgICAgIE5PTl9TVVBQT1JURURfT1BUSU1J\nU1RJQ19TUUwpOwogICAgICAgIGNvbW1vblRlc3RGaW5kTG9ja01vZGVJc29s\nYXRpb25zKGVtLAogICAgICAgICAgICBMb2NrTW9kZVR5cGUuUEVTU0lNSVNU\nSUNfRk9SQ0VfSU5DUkVNRU5ULCAyLAogICAgICAgICAgICBEQjJfUEVTU0lN\nSVNUSUNfUlJfU1FMLCAyLCBOT05fU1VQUE9SVEVEX0ZPUl9VUERBVEVfU1FM\nLCAxLAogICAgICAgICAgICBWRVJTSU9OX1VQREFURV9TUUwpOwoKICAgICAg\nICBlbS5nZXRUcmFuc2FjdGlvbigpLnJvbGxiYWNrKCk7CiAgICAgICAgZW0u\nY2xvc2UoKTsKICAgIH0KCiAgICBwcml2YXRlIHZvaWQgY29tbW9uVGVzdEZp\nbmRMb2NrTW9kZUlzb2xhdGlvbnMoRW50aXR5TWFuYWdlciBlbSwKICAgICAg\nICBMb2NrTW9kZVR5cGUgbG9ja01vZGUsIGludCBleHBlY3RlZFN1cHBvcnRT\nUUxDb3VudCwKICAgICAgICBTdHJpbmcgZXhwZWN0ZWRTdXBwb3J0U1FMLCBp\nbnQgZXhwZWN0ZWROb25TdXBwb3J0U1FMQ291bnQsCiAgICAgICAgU3RyaW5n\nIGV4cGVjdGVkTm9uU3VwcG9ydFNRTCwgaW50IGV4cGVjdGVkVmVyc2lvblVw\nZGF0ZUNvdW50LAogICAgICAgIFN0cmluZyBleHBlY3RlZFZlcnNpb25VcGRh\ndGVTUUwpIHsKICAgICAgICBPcGVuSlBBRW50aXR5TWFuYWdlciBvZW0gPSAo\nT3BlbkpQQUVudGl0eU1hbmFnZXIpIGVtLmdldERlbGVnYXRlKCk7CiAgICAg\nICAgSkRCQ0ZldGNoQ29uZmlndXJhdGlvbkltcGwgZkNvbmZpZyA9IChKREJD\nRmV0Y2hDb25maWd1cmF0aW9uSW1wbCkKICAgICAgICAgICAgKChFbnRpdHlN\nYW5hZ2VySW1wbCkgb2VtKS5nZXRCcm9rZXIoKS5nZXRGZXRjaENvbmZpZ3Vy\nYXRpb24oKTsKICAgICAgICBEQkRpY3Rpb25hcnkgZGljdCA9ICgoSkRCQ0Nv\nbmZpZ3VyYXRpb24pICgoT3BlbkpQQUVudGl0eU1hbmFnZXJTUEkpIG9lbSkK\nICAgICAgICAgICAgLmdldENvbmZpZ3VyYXRpb24oKSkuZ2V0REJEaWN0aW9u\nYXJ5SW5zdGFuY2UoKTsKCiAgICAgICAgZW0uY2xlYXIoKTsKICAgICAgICBy\nZXNldFNRTCgpOwogICAgICAgIGludCBiZWZvcmVJc29sYXRpb24gPSBmQ29u\nZmlnLmdldElzb2xhdGlvbigpOwogICAgICAgIGVtLmZpbmQoTG9ja0VtcGxv\neWVlLmNsYXNzLCAxLCBsb2NrTW9kZSk7CiAgICAgICAgaWYgKGRpY3Quc3Vw\ncG9ydHNJc29sYXRpb25Gb3JVcGRhdGUoKSAmJiAKICAgICAgICAgICAgZGlj\ndCBpbnN0YW5jZW9mIERCMkRpY3Rpb25hcnkpIHsKICAgICAgICAgICAgYXNz\nZXJ0RXF1YWxzKGV4cGVjdGVkU3VwcG9ydFNRTENvdW50LCBnZXRTUUxDb3Vu\ndCgpKTsKICAgICAgICAgICAgYXNzZXJ0QWxsU1FMSW5PcmRlcihleHBlY3Rl\nZFN1cHBvcnRTUUwpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGFz\nc2VydEVxdWFscyhleHBlY3RlZE5vblN1cHBvcnRTUUxDb3VudCwgZ2V0U1FM\nQ291bnQoKSk7CiAgICAgICAgICAgIGFzc2VydEFsbFNRTEluT3JkZXIoZXhw\nZWN0ZWROb25TdXBwb3J0U1FMKTsKICAgICAgICB9CgogICAgICAgIHJlc2V0\nU1FMKCk7CiAgICAgICAgZW0uZmx1c2goKTsKICAgICAgICBhc3NlcnRFcXVh\nbHMoZXhwZWN0ZWRWZXJzaW9uVXBkYXRlQ291bnQsIGdldFNRTENvdW50KCkp\nOwogICAgICAgIGlmIChleHBlY3RlZFZlcnNpb25VcGRhdGVTUUwgIT0gbnVs\nbCkKICAgICAgICAgICAgYXNzZXJ0QWxsU1FMSW5PcmRlcihleHBlY3RlZFZl\ncnNpb25VcGRhdGVTUUwpOwoKICAgICAgICBhc3NlcnRFcXVhbHMoYmVmb3Jl\nSXNvbGF0aW9uLCBmQ29uZmlnLmdldElzb2xhdGlvbigpKTsKICAgIH0KCiAg\nICAvKgogICAgICogVGVzdCBlbS5yZWZyZXNoKGxvY2ttb2RlKTsKICAgICAq\nLwogICAgcHVibGljIHZvaWQgdGVzdFJlZnJlc2hMb2NrTW9kZUlzb2xhdGlv\nbnMoKSB7CiAgICAgICAgRW50aXR5TWFuYWdlciBlbSA9IGVtZi5jcmVhdGVF\nbnRpdHlNYW5hZ2VyKCk7CgogICAgICAgIGVtLmdldFRyYW5zYWN0aW9uKCku\nYmVnaW4oKTsKCiAgICAgICAgY29tbW9uVGVzdFJlZnJlc2hMb2NrTW9kZUlz\nb2xhdGlvbnMoZW0sIExvY2tNb2RlVHlwZS5OT05FLCAxLAogICAgICAgICAg\nICBEQjJfT1BUSU1JU1RJQ19TUUwsIDEsIE5PTl9TVVBQT1JURURfT1BUSU1J\nU1RJQ19TUUwsIDAsIG51bGwpOwogICAgICAgIGNvbW1vblRlc3RSZWZyZXNo\nTG9ja01vZGVJc29sYXRpb25zKGVtLCBMb2NrTW9kZVR5cGUuUkVBRCwgMSwK\nICAgICAgICAgICAgREIyX09QVElNSVNUSUNfU1FMLCAxLCBOT05fU1VQUE9S\nVEVEX09QVElNSVNUSUNfU1FMLCAxLAogICAgICAgICAgICBOT05fU1VQUE9S\nVEVEX09QVElNSVNUSUNfU1FMKTsKICAgICAgICBjb21tb25UZXN0UmVmcmVz\naExvY2tNb2RlSXNvbGF0aW9ucyhlbSwgTG9ja01vZGVUeXBlLldSSVRFLCAx\nLAogICAgICAgICAgICBEQjJfT1BUSU1JU1RJQ19TUUwsIDEsIE5PTl9TVVBQ\nT1JURURfT1BUSU1JU1RJQ19TUUwsIDEsCiAgICAgICAgICAgIFZFUlNJT05f\nVVBEQVRFX1NRTCk7CiAgICAgICAgY29tbW9uVGVzdFJlZnJlc2hMb2NrTW9k\nZUlzb2xhdGlvbnMoZW0sIExvY2tNb2RlVHlwZS5PUFRJTUlTVElDLCAxLAog\nICAgICAgICAgICBEQjJfT1BUSU1JU1RJQ19TUUwsIDEsIE5PTl9TVVBQT1JU\nRURfT1BUSU1JU1RJQ19TUUwsIDEsCiAgICAgICAgICAgIE5PTl9TVVBQT1JU\nRURfT1BUSU1JU1RJQ19TUUwpOwogICAgICAgIGNvbW1vblRlc3RSZWZyZXNo\nTG9ja01vZGVJc29sYXRpb25zKGVtLAogICAgICAgICAgICBMb2NrTW9kZVR5\ncGUuT1BUSU1JU1RJQ19GT1JDRV9JTkNSRU1FTlQsIDEsIERCMl9PUFRJTUlT\nVElDX1NRTCwgMSwKICAgICAgICAgICAgTk9OX1NVUFBPUlRFRF9PUFRJTUlT\nVElDX1NRTCwgMSwgVkVSU0lPTl9VUERBVEVfU1FMKTsKICAgICAgICBjb21t\nb25UZXN0UmVmcmVzaExvY2tNb2RlSXNvbGF0aW9ucyhlbSwgTG9ja01vZGVU\neXBlLlBFU1NJTUlTVElDX1JFQUQsCiAgICAgICAgICAgIDIsIERCMl9QRVNT\nSU1JU1RJQ19SU19TUUwsIDIsIE5PTl9TVVBQT1JURURfRk9SX1VQREFURV9T\nUUwsIDEsCiAgICAgICAgICAgIE5PTl9TVVBQT1JURURfT1BUSU1JU1RJQ19T\nUUwpOwogICAgICAgIGNvbW1vblRlc3RSZWZyZXNoTG9ja01vZGVJc29sYXRp\nb25zKGVtLCBMb2NrTW9kZVR5cGUuUEVTU0lNSVNUSUNfV1JJVEUsCiAgICAg\nICAgICAgIDIsIERCMl9QRVNTSU1JU1RJQ19SUl9TUUwsIDIsIE5PTl9TVVBQ\nT1JURURfRk9SX1VQREFURV9TUUwsIDEsCiAgICAgICAgICAgIE5PTl9TVVBQ\nT1JURURfT1BUSU1JU1RJQ19TUUwpOwogICAgICAgIGNvbW1vblRlc3RSZWZy\nZXNoTG9ja01vZGVJc29sYXRpb25zKGVtLAogICAgICAgICAgICBMb2NrTW9k\nZVR5cGUuUEVTU0lNSVNUSUNfRk9SQ0VfSU5DUkVNRU5ULCAyLAogICAgICAg\nICAgICBEQjJfUEVTU0lNSVNUSUNfUlJfU1FMLCAyLCBOT05fU1VQUE9SVEVE\nX0ZPUl9VUERBVEVfU1FMLCAxLAogICAgICAgICAgICBWRVJTSU9OX1VQREFU\nRV9TUUwpOwoKICAgICAgICBlbS5nZXRUcmFuc2FjdGlvbigpLnJvbGxiYWNr\nKCk7CiAgICAgICAgZW0uY2xvc2UoKTsKICAgIH0KCiAgICBwcml2YXRlIHZv\naWQgY29tbW9uVGVzdFJlZnJlc2hMb2NrTW9kZUlzb2xhdGlvbnMoRW50aXR5\nTWFuYWdlciBlbSwKICAgICAgICBMb2NrTW9kZVR5cGUgbG9ja01vZGUsIGlu\ndCBleHBlY3RlZFN1cHBvcnRTUUxDb3VudCwKICAgICAgICBTdHJpbmcgZXhw\nZWN0ZWRTdXBwb3J0U1FMLCBpbnQgZXhwZWN0ZWROb25TdXBwb3J0U1FMQ291\nbnQsCiAgICAgICAgU3RyaW5nIGV4cGVjdGVkTm9uU3VwcG9ydFNRTCwgaW50\nIGV4cGVjdGVkVmVyc2lvblVwZGF0ZUNvdW50LAogICAgICAgIFN0cmluZyBl\neHBlY3RlZFZlcnNpb25VcGRhdGVTUUwpIHsKICAgICAgICBPcGVuSlBBRW50\naXR5TWFuYWdlciBvZW0gPSAoT3BlbkpQQUVudGl0eU1hbmFnZXIpIGVtLmdl\ndERlbGVnYXRlKCk7CiAgICAgICAgSkRCQ0ZldGNoQ29uZmlndXJhdGlvbklt\ncGwgZkNvbmZpZyA9IChKREJDRmV0Y2hDb25maWd1cmF0aW9uSW1wbCkgCiAg\nICAgICAgICAgICgoRW50aXR5TWFuYWdlckltcGwpIG9lbSkuZ2V0QnJva2Vy\nKCkuZ2V0RmV0Y2hDb25maWd1cmF0aW9uKCk7CiAgICAgICAgREJEaWN0aW9u\nYXJ5IGRpY3QgPSAoKEpEQkNDb25maWd1cmF0aW9uKSAoKE9wZW5KUEFFbnRp\ndHlNYW5hZ2VyU1BJKSBvZW0pCiAgICAgICAgICAgIC5nZXRDb25maWd1cmF0\naW9uKCkpLmdldERCRGljdGlvbmFyeUluc3RhbmNlKCk7CgogICAgICAgIGVt\nLmNsZWFyKCk7CiAgICAgICAgTG9ja0VtcGxveWVlIGVtcGxveWVlID0gZW0u\nZmluZChMb2NrRW1wbG95ZWUuY2xhc3MsIDEpOwogICAgICAgIHJlc2V0U1FM\nKCk7CiAgICAgICAgaW50IGJlZm9yZUlzb2xhdGlvbiA9IGZDb25maWcuZ2V0\nSXNvbGF0aW9uKCk7CiAgICAgICAgZW0ucmVmcmVzaChlbXBsb3llZSwgbG9j\na01vZGUpOwogICAgICAgIGlmIChkaWN0LnN1cHBvcnRzSXNvbGF0aW9uRm9y\nVXBkYXRlKCkgJiYgCiAgICAgICAgICAgIGRpY3QgaW5zdGFuY2VvZiBEQjJE\naWN0aW9uYXJ5KSB7CiAgICAgICAgICAgIGFzc2VydEVxdWFscyhleHBlY3Rl\nZFN1cHBvcnRTUUxDb3VudCwgZ2V0U1FMQ291bnQoKSk7CiAgICAgICAgICAg\nIGFzc2VydEFsbFNRTEluT3JkZXIoZXhwZWN0ZWRTdXBwb3J0U1FMKTsKICAg\nICAgICB9IGVsc2UgewogICAgICAgICAgICBhc3NlcnRFcXVhbHMoZXhwZWN0\nZWROb25TdXBwb3J0U1FMQ291bnQsIGdldFNRTENvdW50KCkpOwogICAgICAg\nICAgICBhc3NlcnRBbGxTUUxJbk9yZGVyKGV4cGVjdGVkTm9uU3VwcG9ydFNR\nTCk7CiAgICAgICAgfQoKICAgICAgICByZXNldFNRTCgpOwogICAgICAgIGVt\nLmZsdXNoKCk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKGV4cGVjdGVkVmVyc2lv\nblVwZGF0ZUNvdW50LCBnZXRTUUxDb3VudCgpKTsKICAgICAgICBpZiAoZXhw\nZWN0ZWRWZXJzaW9uVXBkYXRlU1FMICE9IG51bGwpCiAgICAgICAgICAgIGFz\nc2VydEFsbFNRTEluT3JkZXIoZXhwZWN0ZWRWZXJzaW9uVXBkYXRlU1FMKTsK\nCiAgICAgICAgYXNzZXJ0RXF1YWxzKGJlZm9yZUlzb2xhdGlvbiwgZkNvbmZp\nZy5nZXRJc29sYXRpb24oKSk7CiAgICB9CgogICAgLyoKICAgICAqIFRlc3Qg\nZW0ubG9jayhsb2NrbW9kZSk7CiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHRl\nc3RMb2NrTG9ja01vZGVJc29sYXRpb25zKCkgewogICAgICAgIEVudGl0eU1h\nbmFnZXIgZW0gPSBlbWYuY3JlYXRlRW50aXR5TWFuYWdlcigpOwoKICAgICAg\nICBlbS5nZXRUcmFuc2FjdGlvbigpLmJlZ2luKCk7CgogICAgICAgIGNvbW1v\nblRlc3RMb2NrTG9ja01vZGVJc29sYXRpb25zKGVtLCBMb2NrTW9kZVR5cGUu\nTk9ORSwgMCwgbnVsbCwgMCwKICAgICAgICAgICAgbnVsbCwgMCwgbnVsbCk7\nCiAgICAgICAgY29tbW9uVGVzdExvY2tMb2NrTW9kZUlzb2xhdGlvbnMoZW0s\nIExvY2tNb2RlVHlwZS5SRUFELCAwLCBudWxsLCAwLAogICAgICAgICAgICBu\ndWxsLCAxLCBOT05fU1VQUE9SVEVEX09QVElNSVNUSUNfU1FMKTsKICAgICAg\nICBjb21tb25UZXN0TG9ja0xvY2tNb2RlSXNvbGF0aW9ucyhlbSwgTG9ja01v\nZGVUeXBlLldSSVRFLCAwLCBudWxsLCAwLAogICAgICAgICAgICBudWxsLCAx\nLCBWRVJTSU9OX1VQREFURV9TUUwpOwogICAgICAgIGNvbW1vblRlc3RMb2Nr\nTG9ja01vZGVJc29sYXRpb25zKGVtLCBMb2NrTW9kZVR5cGUuT1BUSU1JU1RJ\nQywgMCwgbnVsbCwKICAgICAgICAgICAgMCwgbnVsbCwgMSwgTk9OX1NVUFBP\nUlRFRF9PUFRJTUlTVElDX1NRTCk7CiAgICAgICAgY29tbW9uVGVzdExvY2tM\nb2NrTW9kZUlzb2xhdGlvbnMoZW0sCiAgICAgICAgICAgIExvY2tNb2RlVHlw\nZS5PUFRJTUlTVElDX0ZPUkNFX0lOQ1JFTUVOVCwgMCwgbnVsbCwgMCwgbnVs\nbCwgMSwKICAgICAgICAgICAgVkVSU0lPTl9VUERBVEVfU1FMKTsKICAgICAg\nICBjb21tb25UZXN0TG9ja0xvY2tNb2RlSXNvbGF0aW9ucyhlbSwgTG9ja01v\nZGVUeXBlLlBFU1NJTUlTVElDX1JFQUQsIDIsCiAgICAgICAgICAgIERCMl9Q\nRVNTSU1JU1RJQ19SU19TUUwsIDIsIE5PTl9TVVBQT1JURURfRk9SX1VQREFU\nRV9TUUwsIDEsCiAgICAgICAgICAgIE5PTl9TVVBQT1JURURfT1BUSU1JU1RJ\nQ19TUUwpOwogICAgICAgIGNvbW1vblRlc3RMb2NrTG9ja01vZGVJc29sYXRp\nb25zKGVtLCBMb2NrTW9kZVR5cGUuUEVTU0lNSVNUSUNfV1JJVEUsIDIsCiAg\nICAgICAgICAgIERCMl9QRVNTSU1JU1RJQ19SUl9TUUwsIDIsIE5PTl9TVVBQ\nT1JURURfRk9SX1VQREFURV9TUUwsIDEsCiAgICAgICAgICAgIE5PTl9TVVBQ\nT1JURURfT1BUSU1JU1RJQ19TUUwpOwogICAgICAgIGNvbW1vblRlc3RMb2Nr\nTG9ja01vZGVJc29sYXRpb25zKGVtLAogICAgICAgICAgICBMb2NrTW9kZVR5\ncGUuUEVTU0lNSVNUSUNfRk9SQ0VfSU5DUkVNRU5ULCAyLAogICAgICAgICAg\nICBEQjJfUEVTU0lNSVNUSUNfUlJfU1FMLCAyLCBOT05fU1VQUE9SVEVEX0ZP\nUl9VUERBVEVfU1FMLCAxLAogICAgICAgICAgICBWRVJTSU9OX1VQREFURV9T\nUUwpOwoKICAgICAgICBlbS5nZXRUcmFuc2FjdGlvbigpLnJvbGxiYWNrKCk7\nCiAgICAgICAgZW0uY2xvc2UoKTsKICAgIH0KCiAgICBwcml2YXRlIHZvaWQg\nY29tbW9uVGVzdExvY2tMb2NrTW9kZUlzb2xhdGlvbnMoRW50aXR5TWFuYWdl\nciBlbSwKICAgICAgICBMb2NrTW9kZVR5cGUgbG9ja01vZGUsIGludCBleHBl\nY3RlZFN1cHBvcnRTUUxDb3VudCwKICAgICAgICBTdHJpbmcgZXhwZWN0ZWRT\ndXBwb3J0U1FMLCBpbnQgZXhwZWN0ZWROb25TdXBwb3J0U1FMQ291bnQsCiAg\nICAgICAgU3RyaW5nIGV4cGVjdGVkTm9uU3VwcG9ydFNRTCwgaW50IGV4cGVj\ndGVkVmVyc2lvblVwZGF0ZUNvdW50LAogICAgICAgIFN0cmluZyBleHBlY3Rl\nZFZlcnNpb25VcGRhdGVTUUwpIHsKICAgICAgICBPcGVuSlBBRW50aXR5TWFu\nYWdlciBvZW0gPSAoT3BlbkpQQUVudGl0eU1hbmFnZXIpIGVtLmdldERlbGVn\nYXRlKCk7CiAgICAgICAgSkRCQ0ZldGNoQ29uZmlndXJhdGlvbkltcGwgZkNv\nbmZpZyA9IChKREJDRmV0Y2hDb25maWd1cmF0aW9uSW1wbCkKICAgICAgICAg\nICAgKChFbnRpdHlNYW5hZ2VySW1wbCkgb2VtKS5nZXRCcm9rZXIoKS5nZXRG\nZXRjaENvbmZpZ3VyYXRpb24oKTsKICAgICAgICBEQkRpY3Rpb25hcnkgZGlj\ndCA9ICgoSkRCQ0NvbmZpZ3VyYXRpb24pICgoT3BlbkpQQUVudGl0eU1hbmFn\nZXJTUEkpIG9lbSkKICAgICAgICAgICAgLmdldENvbmZpZ3VyYXRpb24oKSku\nZ2V0REJEaWN0aW9uYXJ5SW5zdGFuY2UoKTsKCiAgICAgICAgZW0uY2xlYXIo\nKTsKICAgICAgICBMb2NrRW1wbG95ZWUgZW1wbG95ZWUgPSBlbS5maW5kKExv\nY2tFbXBsb3llZS5jbGFzcywgMSk7CiAgICAgICAgcmVzZXRTUUwoKTsKICAg\nICAgICBpbnQgYmVmb3JlSXNvbGF0aW9uID0gZkNvbmZpZy5nZXRJc29sYXRp\nb24oKTsKICAgICAgICBlbS5sb2NrKGVtcGxveWVlLCBsb2NrTW9kZSk7CiAg\nICAgICAgaWYgKGRpY3Quc3VwcG9ydHNJc29sYXRpb25Gb3JVcGRhdGUoKSAm\nJiAKICAgICAgICAgICAgZGljdCBpbnN0YW5jZW9mIERCMkRpY3Rpb25hcnkp\nIHsKICAgICAgICAgICAgYXNzZXJ0RXF1YWxzKGV4cGVjdGVkU3VwcG9ydFNR\nTENvdW50LCBnZXRTUUxDb3VudCgpKTsKICAgICAgICAgICAgaWYgKGV4cGVj\ndGVkU3VwcG9ydFNRTCAhPSBudWxsKQogICAgICAgICAgICAgICAgYXNzZXJ0\nQWxsU1FMSW5PcmRlcihleHBlY3RlZFN1cHBvcnRTUUwpOwogICAgICAgIH0g\nZWxzZSB7CiAgICAgICAgICAgIGFzc2VydEVxdWFscyhleHBlY3RlZE5vblN1\ncHBvcnRTUUxDb3VudCwgZ2V0U1FMQ291bnQoKSk7CiAgICAgICAgICAgIGlm\nIChleHBlY3RlZE5vblN1cHBvcnRTUUwgIT0gbnVsbCkKICAgICAgICAgICAg\nICAgIGFzc2VydEFsbFNRTEluT3JkZXIoZXhwZWN0ZWROb25TdXBwb3J0U1FM\nKTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgcmVzZXRTUUwoKTsKICAg\nICAgICBlbS5mbHVzaCgpOwogICAgICAgIGFzc2VydEVxdWFscyhleHBlY3Rl\nZFZlcnNpb25VcGRhdGVDb3VudCwgZ2V0U1FMQ291bnQoKSk7CiAgICAgICAg\naWYgKGV4cGVjdGVkVmVyc2lvblVwZGF0ZVNRTCAhPSBudWxsKQogICAgICAg\nICAgICBhc3NlcnRBbGxTUUxJbk9yZGVyKGV4cGVjdGVkVmVyc2lvblVwZGF0\nZVNRTCk7CgogICAgICAgIGFzc2VydEVxdWFscyhiZWZvcmVJc29sYXRpb24s\nIGZDb25maWcuZ2V0SXNvbGF0aW9uKCkpOwogICAgfQoKICAgIC8qCiAgICAg\nKiBUZXN0IGVtLmdldExvY2tNb2RlKCk7CiAgICAgKi8KICAgIHB1YmxpYyB2\nb2lkIHRlc3RHZXRMb2NrTW9kZSgpIHsKICAgICAgICBFbnRpdHlNYW5hZ2Vy\nIGVtID0gZW1mLmNyZWF0ZUVudGl0eU1hbmFnZXIoKTsKCiAgICAgICAgTG9j\na0VtcGxveWVlIGVtcGxveWVlID0gZW0uZmluZChMb2NrRW1wbG95ZWUuY2xh\nc3MsIDEpOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIGVtLmdldExvY2tN\nb2RlKGVtcGxveWVlKTsKICAgICAgICAgICAgZmFpbCgiRXhwZWN0aW5nIFRy\nYW5zYWN0aW9uUmVxdWlyZWRFeGNlcHRpb24uIik7CiAgICAgICAgfSBjYXRj\naCAoVHJhbnNhY3Rpb25SZXF1aXJlZEV4Y2VwdGlvbiB0cmUpIHsKICAgICAg\nICB9IGNhdGNoIChFeGNlcHRpb24gZSl7CiAgICAgICAgICAgIGZhaWwoIkV4\ncGVjdGluZyBUcmFuc2FjdGlvblJlcXVpcmVkRXhjZXB0aW9uLiIpOwogICAg\nICAgIH0KCiAgICAgICAgZW0uZ2V0VHJhbnNhY3Rpb24oKS5iZWdpbigpOwog\nICAgICAgIHRyeSB7CiAgICAgICAgICAgIGFzc2VydEVxdWFscygiZ2V0TG9j\na01vZGUgb25seSBhbGxvd3MgaW4gdHJhbnNhY3Rpb24uIixMb2NrTW9kZVR5\ncGUuTk9ORSwgZW0uZ2V0TG9ja01vZGUoZW1wbG95ZWUpKTsKICAgICAgICB9\nIGNhdGNoIChFeGNlcHRpb24gZSl7CiAgICAgICAgICAgIGZhaWwoIkRvIG5v\ndCBleHBlY3RpbmcgYW55IGV4Y2VwdGlvbi4iKTsKICAgICAgICB9ICAgICAg\nICAKICAgICAgICBlbS5nZXRUcmFuc2FjdGlvbigpLnJvbGxiYWNrKCk7Cgog\nICAgICAgIGVtLmNsZWFyKCk7CiAgICAgICAgZW0uZ2V0VHJhbnNhY3Rpb24o\nKS5iZWdpbigpOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIC8vIGdldExv\nY2tNb2RlIG9uIGEgZGV0YWNoZWQgZW50aXR5OwogICAgICAgICAgICBlbS5n\nZXRMb2NrTW9kZShlbXBsb3llZSk7CiAgICAgICAgICAgIGZhaWwoIkV4cGVj\ndGluZyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24gZm9yIGdldExvY2tNb2Rl\nIG9uIGEgZGV0YWNoZWQgZW50aXR5IGluIGFuIGFjdGl2ZSB0cmFuc2FjdGlv\nbi4iKTsKICAgICAgICB9IGNhdGNoIChJbGxlZ2FsQXJndW1lbnRFeGNlcHRp\nb24gaWFlKSB7CiAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpewogICAg\nICAgICAgICBmYWlsKCJFeHBlY3RpbmcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0\naW9uIGZvciBnZXRMb2NrTW9kZSBvbiBhIGRldGFjaGVkIGVudGl0eSBpbiBh\nbiBhY3RpdmUgdHJhbnNhY3Rpb24uIik7CiAgICAgICAgfSAgICAgICAgCiAg\nICAgICAgZW0uZ2V0VHJhbnNhY3Rpb24oKS5yb2xsYmFjaygpOwoKICAgICAg\nICBlbS5nZXRUcmFuc2FjdGlvbigpLmJlZ2luKCk7CiAgICAgICAgdHJ5IHsK\nICAgICAgICAgICAgZW1wbG95ZWUgPSBlbS5maW5kKExvY2tFbXBsb3llZS5j\nbGFzcywgMSwgTG9ja01vZGVUeXBlLlBFU1NJTUlTVElDX1dSSVRFKTsKICAg\nICAgICAgICAgYXNzZXJ0RXF1YWxzKCJUZXN0IGdldExvY2tNb2RlIG9uIG5v\nbi1OT05FIGxvY2sgbW9kZSB0eXBlLiIsIExvY2tNb2RlVHlwZS5QRVNTSU1J\nU1RJQ19XUklURSwgZW0KICAgICAgICAgICAgICAgICAgICAuZ2V0TG9ja01v\nZGUoZW1wbG95ZWUpKTsKICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSl7\nCiAgICAgICAgICAgIGZhaWwoIkRvIG5vdCBleHBlY3RpbmcgYW55IGV4Y2Vw\ndGlvbi4iKTsKICAgICAgICB9ICAgICAgICAKICAgICAgICBlbS5nZXRUcmFu\nc2FjdGlvbigpLnJvbGxiYWNrKCk7CgogICAgICAgIGVtLmNsb3NlKCk7CiAg\nICB9Cn0K\n","encoding":"base64"}

