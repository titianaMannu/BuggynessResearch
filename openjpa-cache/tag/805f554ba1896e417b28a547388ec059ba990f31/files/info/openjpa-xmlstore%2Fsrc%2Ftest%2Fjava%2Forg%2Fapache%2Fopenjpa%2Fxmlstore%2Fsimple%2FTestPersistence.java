{"sha":"5a6d6b9f35e85e9e5c4149ce173dadd1fb9d69bb","node_id":"MDQ6QmxvYjIwNjM2NDo1YTZkNmI5ZjM1ZTg1ZTllNWM0MTQ5Y2UxNzNkYWRkMWZiOWQ2OWJi","size":4716,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/5a6d6b9f35e85e9e5c4149ce173dadd1fb9d69bb","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEueG1sc3RvcmUuc2ltcGxlOwoK\naW1wb3J0IGphdmF4LnBlcnNpc3RlbmNlLkVudGl0eU1hbmFnZXI7CmltcG9y\ndCBqYXZheC5wZXJzaXN0ZW5jZS5FbnRpdHlUcmFuc2FjdGlvbjsKCmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuT3BlbkpQQUVudGl0\neU1hbmFnZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVu\nY2UuT3BlbkpQQUVudGl0eU1hbmFnZXJGYWN0b3J5U1BJOwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNlLnRlc3QuQWJzdHJhY3RQZXJz\naXN0ZW5jZVRlc3RDYXNlOwoKLyoqCiAqIFNpbXBsZSBYTUxTdG9yZSB0ZXN0\nIGNhc2UgdG8gZ2V0IGFuIEVudGl0eU1hbmFnZXIgYW5kIHBlcmZvcm0gc29t\nZSBiYXNpYyBvcGVyYXRpb25zLgogKi8KcHVibGljIGNsYXNzIFRlc3RQZXJz\naXN0ZW5jZSBleHRlbmRzIEFic3RyYWN0UGVyc2lzdGVuY2VUZXN0Q2FzZSB7\nCgogICAgcHVibGljIHZvaWQgdGVzdENyZWF0ZUVudGl0eU1hbmFnZXIoKSB7\nCiAgICAgICAgT3BlbkpQQUVudGl0eU1hbmFnZXJGYWN0b3J5U1BJIGVtZiA9\nIGNyZWF0ZU5hbWVkRU1GKCJ4bWxzdG9yZS1zaW1wbGUiKTsKICAgICAgICB0\ncnkgewogICAgICAgICAgICBFbnRpdHlNYW5hZ2VyIGVtID0gZW1mLmNyZWF0\nZUVudGl0eU1hbmFnZXIoKTsKCiAgICAgICAgICAgIEVudGl0eVRyYW5zYWN0\naW9uIHQgPSBlbS5nZXRUcmFuc2FjdGlvbigpOwogICAgICAgICAgICBhc3Nl\ncnROb3ROdWxsKHQpOwogICAgICAgICAgICB0LmJlZ2luKCk7CiAgICAgICAg\nICAgIHQuc2V0Um9sbGJhY2tPbmx5KCk7CiAgICAgICAgICAgIHQucm9sbGJh\nY2soKTsKCiAgICAgICAgICAgIC8vIG9wZW5qcGEtZmFjYWRlIHRlc3QKICAg\nICAgICAgICAgYXNzZXJ0VHJ1ZShlbSBpbnN0YW5jZW9mIE9wZW5KUEFFbnRp\ndHlNYW5hZ2VyKTsKICAgICAgICAgICAgT3BlbkpQQUVudGl0eU1hbmFnZXIg\nb2plbSA9IChPcGVuSlBBRW50aXR5TWFuYWdlcikgZW07CiAgICAgICAgICAg\nIG9qZW0uZ2V0RmV0Y2hQbGFuKCkuc2V0TWF4RmV0Y2hEZXB0aCgxKTsKICAg\nICAgICAgICAgYXNzZXJ0RXF1YWxzKDEsIG9qZW0uZ2V0RmV0Y2hQbGFuKCku\nZ2V0TWF4RmV0Y2hEZXB0aCgpKTsKICAgICAgICAgICAgZW0uY2xvc2UoKTsK\nICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICBjbG9zZUVNRihlbWYp\nOwogICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMgdm9pZCB0ZXN0UXVlcnko\nKSB7CiAgICAgICAgT3BlbkpQQUVudGl0eU1hbmFnZXJGYWN0b3J5U1BJIGVt\nZiA9IGNyZWF0ZU5hbWVkRU1GKCJ4bWxzdG9yZS1zaW1wbGUiLAogICAgICAg\nICAgICBDTEVBUl9UQUJMRVMsIEFsbEZpZWxkVHlwZXMuY2xhc3MpOwogICAg\nICAgIHRyeSB7CiAgICAgICAgICAgIEVudGl0eU1hbmFnZXIgZW0gPSBlbWYu\nY3JlYXRlRW50aXR5TWFuYWdlcigpOwogICAgICAgICAgICBlbS5nZXRUcmFu\nc2FjdGlvbigpLmJlZ2luKCk7CiAgICAgICAgICAgIEFsbEZpZWxkVHlwZXMg\nYWZ0ID0gbmV3IEFsbEZpZWxkVHlwZXMoKTsKICAgICAgICAgICAgYWZ0LnNl\ndFN0cmluZ0ZpZWxkKCJmb28iKTsKICAgICAgICAgICAgYWZ0LnNldEludEZp\nZWxkKDEwKTsKICAgICAgICAgICAgZW0ucGVyc2lzdChhZnQpOwogICAgICAg\nICAgICBlbS5nZXRUcmFuc2FjdGlvbigpLmNvbW1pdCgpOwogICAgICAgICAg\nICBlbS5jbG9zZSgpOwoKICAgICAgICAgICAgZW0gPSBlbWYuY3JlYXRlRW50\naXR5TWFuYWdlcigpOwogICAgICAgICAgICBlbS5nZXRUcmFuc2FjdGlvbigp\nLmJlZ2luKCk7CiAgICAgICAgICAgIGFzc2VydEVxdWFscygxLCBlbS5jcmVh\ndGVRdWVyeQogICAgICAgICAgICAgICAgKCJzZWxlY3QgeCBmcm9tIEFsbEZp\nZWxkVHlwZXMgeCB3aGVyZSB4LnN0cmluZ0ZpZWxkID0gJ2ZvbyciKS4KICAg\nICAgICAgICAgICAgIGdldFJlc3VsdExpc3QoKS5zaXplKCkpOwogICAgICAg\nICAgICBhc3NlcnRFcXVhbHMoMCwgZW0uY3JlYXRlUXVlcnkKICAgICAgICAg\nICAgICAgICgic2VsZWN0IHggZnJvbSBBbGxGaWVsZFR5cGVzIHggd2hlcmUg\neC5zdHJpbmdGaWVsZCA9ICdiYXInIikuCiAgICAgICAgICAgICAgICBnZXRS\nZXN1bHRMaXN0KCkuc2l6ZSgpKTsKICAgICAgICAgICAgYXNzZXJ0RXF1YWxz\nKDEsIGVtLmNyZWF0ZVF1ZXJ5CiAgICAgICAgICAgICAgICAoInNlbGVjdCB4\nIGZyb20gQWxsRmllbGRUeXBlcyB4IHdoZXJlIHguaW50RmllbGQgPj0gMTAi\nKS4KICAgICAgICAgICAgICAgIGdldFJlc3VsdExpc3QoKS5zaXplKCkpOwog\nICAgICAgICAgICBlbS5nZXRUcmFuc2FjdGlvbigpLnJvbGxiYWNrKCk7CiAg\nICAgICAgICAgIGVtLmNsb3NlKCk7CiAgICAgICAgfSBmaW5hbGx5IHsKICAg\nICAgICAgICAgY2xvc2VFTUYoZW1mKTsKICAgICAgICB9CiAgICB9CgogICAg\ncHVibGljIHZvaWQgdGVzdE5ld0RlbGV0ZU5ldygpIHsKICAgICAgICBPcGVu\nSlBBRW50aXR5TWFuYWdlckZhY3RvcnlTUEkgZW1mID0gY3JlYXRlTmFtZWRF\nTUYoInhtbHN0b3JlLXNpbXBsZSIsCiAgICAgICAgICAgIENMRUFSX1RBQkxF\nUywgUGxhY2UuY2xhc3MpOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIEVu\ndGl0eU1hbmFnZXIgZW0gPSBlbWYuY3JlYXRlRW50aXR5TWFuYWdlcigpOwoK\nICAgICAgICAgICAgLy8gY3JlYXRlIG5ldwogICAgICAgICAgICBQbGFjZSBw\nbGFjZSA9IG5ldyBQbGFjZSgpOwogICAgICAgICAgICBwbGFjZS5zZXRMb2Nh\ndGlvbigiTGV4aW5ndG9uIik7CiAgICAgICAgICAgIGFzc2VydEZhbHNlKGVt\nLmNvbnRhaW5zKHBsYWNlKSk7CiAgICAgICAgICAgIGVtLmdldFRyYW5zYWN0\naW9uKCkuYmVnaW4oKTsKICAgICAgICAgICAgZW0ucGVyc2lzdChwbGFjZSk7\nCiAgICAgICAgICAgIGVtLmdldFRyYW5zYWN0aW9uKCkuY29tbWl0KCk7CiAg\nICAgICAgICAgIGFzc2VydFRydWUoZW0uY29udGFpbnMocGxhY2UpKTsKCiAg\nICAgICAgICAgIC8vIGZpbmQgYW5kIHZlcmlmeQogICAgICAgICAgICBwbGFj\nZSA9IGVtLmZpbmQoUGxhY2UuY2xhc3MsICJMZXhpbmd0b24iKTsKICAgICAg\nICAgICAgYXNzZXJ0Tm90TnVsbChwbGFjZSk7CiAgICAgICAgICAgIGFzc2Vy\ndEVxdWFscygiTGV4aW5ndG9uIiwgcGxhY2UuZ2V0TG9jYXRpb24oKSk7Cgog\nICAgICAgICAgICAvLyBkZWxldGUKICAgICAgICAgICAgZW0uZ2V0VHJhbnNh\nY3Rpb24oKS5iZWdpbigpOwogICAgICAgICAgICBlbS5yZW1vdmUocGxhY2Up\nOwogICAgICAgICAgICBlbS5nZXRUcmFuc2FjdGlvbigpLmNvbW1pdCgpOwog\nICAgICAgICAgICBhc3NlcnRGYWxzZShlbS5jb250YWlucyhwbGFjZSkpOwoK\nICAgICAgICAgICAgLy8gcmVjcmVhdGUKICAgICAgICAgICAgcGxhY2UgPSBu\nZXcgUGxhY2UoKTsKICAgICAgICAgICAgcGxhY2Uuc2V0TG9jYXRpb24oIkxl\neGluZ3RvbiIpOwogICAgICAgICAgICBhc3NlcnRGYWxzZShlbS5jb250YWlu\ncyhwbGFjZSkpOwogICAgICAgICAgICBlbS5nZXRUcmFuc2FjdGlvbigpLmJl\nZ2luKCk7CiAgICAgICAgICAgIGVtLnBlcnNpc3QocGxhY2UpOwogICAgICAg\nICAgICBlbS5nZXRUcmFuc2FjdGlvbigpLmNvbW1pdCgpOwogICAgICAgICAg\nICBhc3NlcnRUcnVlKGVtLmNvbnRhaW5zKHBsYWNlKSk7CgogICAgICAgICAg\nICAvLyBmaW5kIGFuZCB2ZXJpZnkKICAgICAgICAgICAgcGxhY2UgPSBlbS5m\naW5kKFBsYWNlLmNsYXNzLCAiTGV4aW5ndG9uIik7CiAgICAgICAgICAgIGFz\nc2VydE5vdE51bGwocGxhY2UpOwogICAgICAgICAgICBhc3NlcnRFcXVhbHMo\nIkxleGluZ3RvbiIsIHBsYWNlLmdldExvY2F0aW9uKCkpOwogICAgICAgICAg\nICBlbS5jbG9zZSgpOwogICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAg\nIGNsb3NlRU1GKGVtZik7CiAgICAgICAgfQogICAgfQoKfQoK\n","encoding":"base64"}

