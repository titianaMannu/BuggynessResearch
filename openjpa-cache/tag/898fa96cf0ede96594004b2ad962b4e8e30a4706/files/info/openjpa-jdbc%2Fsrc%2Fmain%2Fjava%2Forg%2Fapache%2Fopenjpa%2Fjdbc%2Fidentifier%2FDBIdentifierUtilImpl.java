{"sha":"ba292dca488bddd414e5b5b24e54688e252044b6","node_id":"MDQ6QmxvYjIwNjM2NDpiYTI5MmRjYTQ4OGJkZGQ0MTRlNWI1YjI0ZTU0Njg4ZTI1MjA0NGI2","size":19350,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/ba292dca488bddd414e5b5b24e54688e252044b6","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5pZGVudGlmaWVyOwoK\naW1wb3J0IG9yZy5hcGFjaGUuY29tbW9ucy5sYW5nLlN0cmluZ1V0aWxzOwpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuY29uZi5KREJDQ29uZmln\ndXJhdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLmlkZW50\naWZpZXIuREJJZGVudGlmaWVyLkRCSWRlbnRpZmllclR5cGU7CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hlbWEuQ29sdW1uOwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1hLk5hbWVTZXQ7CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hlbWEuU2NoZW1hOwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1hLlNjaGVtYUdyb3Vw\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1hLlRhYmxl\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc3FsLkRCRGljdGlv\nbmFyeTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIuY29uZi5Db25m\naWd1cmFibGU7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLmNvbmYu\nQ29uZmlndXJhdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIu\naWRlbnRpZmllci5JZGVudGlmaWVyQ29uZmlndXJhdGlvbjsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5saWIuaWRlbnRpZmllci5JZGVudGlmaWVyUnVs\nZTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIuaWRlbnRpZmllci5J\nZGVudGlmaWVyVXRpbDsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIu\naWRlbnRpZmllci5JZGVudGlmaWVyVXRpbEltcGw7CgpwdWJsaWMgY2xhc3Mg\nREJJZGVudGlmaWVyVXRpbEltcGwgZXh0ZW5kcyBJZGVudGlmaWVyVXRpbElt\ncGwgaW1wbGVtZW50cyBEQklkZW50aWZpZXJVdGlsLAogICAgQ29uZmlndXJh\nYmxlIHsKICAgIAogICAgcHJpdmF0ZSBKREJDQ29uZmlndXJhdGlvbiBfY29u\nZiA9IG51bGw7CgogICAgcHVibGljIERCSWRlbnRpZmllclV0aWxJbXBsKCkg\newogICAgfQogICAgCiAgICBwdWJsaWMgREJJZGVudGlmaWVyVXRpbEltcGwo\nSWRlbnRpZmllckNvbmZpZ3VyYXRpb24gY29uZmlnKSB7CiAgICAgICAgc3Vw\nZXIoY29uZmlnKTsKICAgIH0KICAgIAogICAgcHVibGljIERCSWRlbnRpZmll\nciBnZXRWYWxpZENvbHVtbklkZW50aWZpZXIoREJJZGVudGlmaWVyIG5hbWUs\nIFRhYmxlIHRhYmxlLAogICAgICAgIGludCBtYXhMZW4sIGJvb2xlYW4gY2hl\nY2tGb3JVbmlxdWVuZXNzKSB7CiAgICAgICAgaWYgKERCSWRlbnRpZmllci5p\nc051bGwobmFtZSkpIHsKICAgICAgICAgICAgcmV0dXJuIG5hbWU7CiAgICAg\nICAgfQogICAgICAgIFN0cmluZyBydWxlID0gbmFtZS5nZXRUeXBlKCkubmFt\nZSgpOwogICAgICAgIG1heExlbiA9IGdldE1heExlbihydWxlLCBuYW1lLCBt\nYXhMZW4pOwoKICAgICAgICBEQklkZW50aWZpZXIgc05hbWUgPSBEQklkZW50\naWZpZXIucmVtb3ZlTGVhZGluZyhuYW1lLCBJZGVudGlmaWVyVXRpbC5VTkRF\nUlNDT1JFKTsKICAgICAgICByZXR1cm4gbWFrZUlkZW50aWZpZXJWYWxpZChz\nTmFtZSwgdGFibGUsIG1heExlbiwgY2hlY2tGb3JVbmlxdWVuZXNzKTsKICAg\nIH0KICAgIAogICAgcHVibGljIERCSWRlbnRpZmllciBnZXRWYWxpZEZvcmVp\nZ25LZXlJZGVudGlmaWVyKERCSWRlbnRpZmllciBuYW1lLCBUYWJsZSB0YWJs\nZSwgVGFibGUgdG9UYWJsZSwgaW50IG1heExlbikgewogICAgICAgIGlmIChE\nQklkZW50aWZpZXIuaXNOdWxsKG5hbWUpKSB7CiAgICAgICAgICAgIHJldHVy\nbiBuYW1lOwogICAgICAgIH0KICAgICAgICBTdHJpbmcgcnVsZSA9IG5hbWUu\nZ2V0VHlwZSgpLm5hbWUoKTsKICAgICAgICBtYXhMZW4gPSBnZXRNYXhMZW4o\ncnVsZSwgbmFtZSwgbWF4TGVuKTsKCiAgICAgICAgREJJZGVudGlmaWVyIHNO\nYW1lID0gbWFrZU5hbWUocnVsZSwgbmFtZSwgdGFibGUsICJGIik7CiAgICAg\nICAgcmV0dXJuIG1ha2VJZGVudGlmaWVyVmFsaWQoc05hbWUsIHRhYmxlLmdl\ndFNjaGVtYSgpLmdldFNjaGVtYUdyb3VwKCksCiAgICAgICAgICAgIG1heExl\nbiwgdHJ1ZSk7CiAgICB9CgogICAgCiAgICBwdWJsaWMgREJJZGVudGlmaWVy\nIGdldFZhbGlkVW5pcXVlSWRlbnRpZmllcihEQklkZW50aWZpZXIgbmFtZSwg\nVGFibGUgdGFibGUsIGludCBtYXhMZW4pIHsKICAgICAgICBpZiAoREJJZGVu\ndGlmaWVyLmlzTnVsbChuYW1lKSkgewogICAgICAgICAgICByZXR1cm4gbmFt\nZTsKICAgICAgICB9CiAgICAgICAgU3RyaW5nIHJ1bGUgPSBuYW1lLmdldFR5\ncGUoKS5uYW1lKCk7CiAgICAgICAgbWF4TGVuID0gZ2V0TWF4TGVuKHJ1bGUs\nIG5hbWUsIG1heExlbik7CgogICAgICAgIERCSWRlbnRpZmllciBzTmFtZSA9\nIG1ha2VOYW1lKHJ1bGUsIG5hbWUsIHRhYmxlLCAiVSIpOwogICAgICAgIHJl\ndHVybiBtYWtlSWRlbnRpZmllclZhbGlkKHNOYW1lLCB0YWJsZS5nZXRTY2hl\nbWEoKS5nZXRTY2hlbWFHcm91cCgpLAogICAgICAgICAgICBtYXhMZW4sIHRy\ndWUpOwogICAgfQoKICAgIHB1YmxpYyBEQklkZW50aWZpZXIgZ2V0VmFsaWRJ\nbmRleElkZW50aWZpZXIoREJJZGVudGlmaWVyIG5hbWUsIFRhYmxlIHRhYmxl\nLCBpbnQgbWF4TGVuKSB7CiAgICAgICAgaWYgKERCSWRlbnRpZmllci5pc051\nbGwobmFtZSkpIHsKICAgICAgICAgICAgcmV0dXJuIG5hbWU7CiAgICAgICAg\nfQogICAgICAgIFN0cmluZyBydWxlID0gbmFtZS5nZXRUeXBlKCkubmFtZSgp\nOwogICAgICAgIG1heExlbiA9IGdldE1heExlbihydWxlLCBuYW1lLCBtYXhM\nZW4pOwoKICAgICAgICBEQklkZW50aWZpZXIgc05hbWUgPSBtYWtlTmFtZShy\ndWxlLCBuYW1lLCB0YWJsZSwgIkkiKTsKICAgICAgICByZXR1cm4gbWFrZUlk\nZW50aWZpZXJWYWxpZChzTmFtZSwgdGFibGUuZ2V0U2NoZW1hKCkuZ2V0U2No\nZW1hR3JvdXAoKSwKICAgICAgICAgICAgbWF4TGVuLCB0cnVlKTsKICAgIH0K\nCiAgICBwdWJsaWMgREJJZGVudGlmaWVyIGdldFZhbGlkU2VxdWVuY2VJZGVu\ndGlmaWVyKERCSWRlbnRpZmllciBuYW1lLCBTY2hlbWEgc2NoZW1hLCBpbnQg\nbWF4TGVuKSB7CiAgICAgICAgaWYgKERCSWRlbnRpZmllci5pc051bGwobmFt\nZSkpIHsKICAgICAgICAgICAgcmV0dXJuIG5hbWU7CiAgICAgICAgfQogICAg\nICAgIFN0cmluZyBydWxlID0gbmFtZS5nZXRUeXBlKCkubmFtZSgpOwogICAg\nICAgIG1heExlbiA9IGdldE1heExlbihydWxlLCBuYW1lLCBtYXhMZW4pOwoK\nICAgICAgICBEQklkZW50aWZpZXIgc05hbWUgPSBtYWtlTmFtZShydWxlLCBu\nYW1lLCAiUyIpOwogICAgICAgIHJldHVybiBtYWtlSWRlbnRpZmllclZhbGlk\nKHNOYW1lLCBzY2hlbWEuZ2V0U2NoZW1hR3JvdXAoKSwgbWF4TGVuLCB0cnVl\nKTsKICAgIH0KCiAgICBwdWJsaWMgREJJZGVudGlmaWVyIGdldFZhbGlkVGFi\nbGVJZGVudGlmaWVyKERCSWRlbnRpZmllciBuYW1lLCBTY2hlbWEgc2NoZW1h\nLCBpbnQgbWF4TGVuKSB7CiAgICAgICAgaWYgKERCSWRlbnRpZmllci5pc051\nbGwobmFtZSkpIHsKICAgICAgICAgICAgcmV0dXJuIG5hbWU7CiAgICAgICAg\nfQogICAgICAgIFN0cmluZyBydWxlID0gbmFtZS5nZXRUeXBlKCkubmFtZSgp\nOwogICAgICAgIG1heExlbiA9IGdldE1heExlbihydWxlLCBuYW1lLCBtYXhM\nZW4pOwoKICAgICAgICBEQklkZW50aWZpZXIgc05hbWUgPSBtYWtlTmFtZShy\ndWxlLCBuYW1lLCBudWxsKTsKICAgICAgICAKICAgICAgICByZXR1cm4gbWFr\nZUlkZW50aWZpZXJWYWxpZChzTmFtZSwgc2NoZW1hLmdldFNjaGVtYUdyb3Vw\nKCksCiAgICAgICAgICAgIG1heExlbiwgdHJ1ZSk7CiAgICB9CgogICAgcHVi\nbGljIERCSWRlbnRpZmllciBtYWtlTmFtZVZhbGlkKFN0cmluZyBuYW1lLCBO\nYW1lU2V0IHNldCwgaW50IG1heExlbiwKICAgICAgICBpbnQgbmFtZVR5cGUs\nIGJvb2xlYW4gY2hlY2tGb3JVbmlxdWVuZXNzKSB7CiAgICAgICAgREJJZGVu\ndGlmaWVyVHlwZSBpZCA9IERCSWRlbnRpZmllclR5cGUuREVGQVVMVDsKICAg\nICAgICBzd2l0Y2ggKG5hbWVUeXBlKSB7CiAgICAgICAgICAgIGNhc2UgREJJ\nZGVudGlmaWVyVXRpbC5UQUJMRToKICAgICAgICAgICAgICAgIGlkID0gREJJ\nZGVudGlmaWVyVHlwZS5UQUJMRTsKICAgICAgICAgICAgICAgIGJyZWFrOwog\nICAgICAgICAgICBjYXNlIERCSWRlbnRpZmllclV0aWwuU0VRVUVOQ0U6CiAg\nICAgICAgICAgICAgICBpZCA9IERCSWRlbnRpZmllclR5cGUuU0VRVUVOQ0U7\nCiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSBEQklk\nZW50aWZpZXJVdGlsLkNPTFVNTjoKICAgICAgICAgICAgICAgIGlkID0gREJJ\nZGVudGlmaWVyVHlwZS5DT0xVTU47CiAgICAgICAgICAgICAgICBicmVhazsK\nICAgICAgICB9CiAgICAgICAgcmV0dXJuIG1ha2VJZGVudGlmaWVyVmFsaWQo\nREJJZGVudGlmaWVyLm5ld0lkZW50aWZpZXIobmFtZSwgaWQpLCBzZXQsIG1h\neExlbiwgY2hlY2tGb3JVbmlxdWVuZXNzKTsKICAgIH0KCiAgICBwdWJsaWMg\nREJJZGVudGlmaWVyIG1ha2VJZGVudGlmaWVyVmFsaWQoREJJZGVudGlmaWVy\nIHNuYW1lLCBOYW1lU2V0IHNldCwgaW50IG1heExlbiwKICAgICAgICBib29s\nZWFuIGNoZWNrRm9yVW5pcXVlbmVzcykgewogICAgICAgIERCSWRlbnRpZmll\nciB2YWxpZE5hbWUgPSBzbmFtZTsKICAgICAgICBTdHJpbmcgcnVsZSA9IHNu\nYW1lLmdldFR5cGUoKS5uYW1lKCk7CiAgICAgICAgCiAgICAgICAgbWF4TGVu\nID0gZ2V0TWF4TGVuKHJ1bGUsIHZhbGlkTmFtZSwgbWF4TGVuKTsKCiAgICAg\nICAgaW50IG5hbWVMZW4gPSB2YWxpZE5hbWUuZ2V0TmFtZSgpLmxlbmd0aCgp\nOwogICAgICAgIGlmIChuYW1lTGVuID4gbWF4TGVuKSB7CiAgICAgICAgICAg\nIHZhbGlkTmFtZSA9IERCSWRlbnRpZmllci50cnVuY2F0ZSh2YWxpZE5hbWUs\nIG5hbWVMZW4gLSBtYXhMZW4pOwogICAgICAgICAgICBuYW1lTGVuID0gdmFs\naWROYW1lLmdldE5hbWUoKS5sZW5ndGgoKTsKICAgICAgICB9CiAgICAgICAg\naWYgKGlzUmVzZXJ2ZWRXb3JkKHJ1bGUsIHZhbGlkTmFtZS5nZXROYW1lKCkp\nKSB7CiAgICAgICAgICAgIGlmIChuYW1lTGVuID09IG1heExlbikKICAgICAg\nICAgICAgICAgIHZhbGlkTmFtZSA9IERCSWRlbnRpZmllci50cnVuY2F0ZSh2\nYWxpZE5hbWUsIDEpOwogICAgICAgICAgICB2YWxpZE5hbWUgPSBEQklkZW50\naWZpZXIuYXBwZW5kKHZhbGlkTmFtZSwgIjAiKTsKICAgICAgICAgICAgbmFt\nZUxlbiA9IHZhbGlkTmFtZS5nZXROYW1lKCkubGVuZ3RoKCk7CiAgICAgICAg\nfQoKICAgICAgICAvLyBub3cgbWFrZSBzdXJlIHRoZSBuYW1lIGlzIHVuaXF1\nZQogICAgICAgIGlmIChzZXQgIT0gbnVsbCAmJiBjaGVja0ZvclVuaXF1ZW5l\nc3MpIHsKICAgICAgICAgICAgZm9yIChpbnQgdmVyc2lvbiA9IDEsIGNoYXJz\nID0gMTsgdHJ1ZTsgdmVyc2lvbisrKSB7CiAgICAgICAgICAgICAgICAvLyBm\nb3IgdGFibGUgbmFtZXMsIHdlIGNoZWNrIGZvciB0aGUgdGFibGUgaXRzZWxm\nIGluIGNhc2UgdGhlCiAgICAgICAgICAgICAgICAvLyBuYW1lIHNldCBpcyBs\nYXp5IGFib3V0IHNjaGVtYSByZWZsZWN0aW9uCiAgICAgICAgICAgICAgICBp\nZiAodmFsaWROYW1lLmdldFR5cGUoKSA9PSBEQklkZW50aWZpZXJUeXBlLlRB\nQkxFKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKCEoKFNjaGVtYUdyb3Vw\nKSBzZXQpLmlzS25vd25UYWJsZShRdWFsaWZpZWREQklkZW50aWZpZXIuZ2V0\nUGF0aCh2YWxpZE5hbWUpKSkKICAgICAgICAgICAgICAgICAgICAgICAgYnJl\nYWs7CiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHZhbGlkTmFtZS5nZXRU\neXBlKCkgPT0gREJJZGVudGlmaWVyVHlwZS5TRVFVRU5DRSkgewogICAgICAg\nICAgICAgICAgICAgIGlmICghKChTY2hlbWFHcm91cCkgc2V0KS5pc0tub3du\nU2VxdWVuY2UoUXVhbGlmaWVkREJJZGVudGlmaWVyLmdldFBhdGgodmFsaWRO\nYW1lKSkpCiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAg\nICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBpZiAoIXNl\ndC5pc05hbWVUYWtlbih2YWxpZE5hbWUpKQogICAgICAgICAgICAgICAgICAg\nICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAg\nICAvLyBhIHNpbmdsZSBjaGFyIGZvciB0aGUgdmVyc2lvbiBpcyBwcm9iYWJs\neSBlbm91Z2gsIGJ1dCBtaWdodAogICAgICAgICAgICAgICAgLy8gYXMgd2Vs\nbCBiZSBnZW5lcmFsIGFib3V0IGl0Li4uCiAgICAgICAgICAgICAgICBpZiAo\ndmVyc2lvbiA+IDEpIHsKICAgICAgICAgICAgICAgICAgICB2YWxpZE5hbWUg\nPSBEQklkZW50aWZpZXIudHJ1bmNhdGUodmFsaWROYW1lLCBjaGFycyk7CiAg\nICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAodmVyc2lvbiA+\nPSBNYXRoLnBvdygxMCwgY2hhcnMpKQogICAgICAgICAgICAgICAgICAgIGNo\nYXJzKys7CiAgICAgICAgICAgICAgICBpZiAobmFtZUxlbiArIGNoYXJzID4g\nbWF4TGVuKSB7CiAgICAgICAgICAgICAgICAgICAgdmFsaWROYW1lID0gREJJ\nZGVudGlmaWVyLnRydW5jYXRlKHZhbGlkTmFtZSwgbmFtZUxlbiArIGNoYXJz\nIC0gbWF4TGVuKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAg\nIHZhbGlkTmFtZSA9IERCSWRlbnRpZmllci5hcHBlbmQodmFsaWROYW1lLCBJ\nbnRlZ2VyLnRvU3RyaW5nKHZlcnNpb24pKTsgCiAgICAgICAgICAgICAgICBu\nYW1lTGVuID0gdmFsaWROYW1lLmdldE5hbWUoKS5sZW5ndGgoKTsKICAgICAg\nICAgICAgfQogICAgICAgIH0KICAgICAgICAKICAgICAgICBpZiAodmFsaWRO\nYW1lLmlzRGVsaW1pdGVkKCkpIHsKICAgICAgICAgICAgU3RyaW5nIGRlbGlt\nQ2FzZSA9IGdldElkZW50aWZpZXJDb25maWd1cmF0aW9uKCkuZ2V0RGVsaW1p\ndGVkQ2FzZSgpOwogICAgICAgICAgICBpZiAoZGVsaW1DYXNlLmVxdWFscyhD\nQVNFX0xPV0VSKSkgewogICAgICAgICAgICAgICAgcmV0dXJuIERCSWRlbnRp\nZmllci50b0xvd2VyKHZhbGlkTmFtZSx0cnVlKTsKICAgICAgICAgICAgfQog\nICAgICAgICAgICBlbHNlIGlmIChkZWxpbUNhc2UuZXF1YWxzKENBU0VfVVBQ\nRVIpKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gREJJZGVudGlmaWVyLnRv\nVXBwZXIodmFsaWROYW1lLHRydWUpOwogICAgICAgICAgICB9CiAgICAgICAg\nICAgIGVsc2UgewogICAgICAgICAgICAgICAgcmV0dXJuIHZhbGlkTmFtZTsK\nICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4gREJJZGVu\ndGlmaWVyLnRvVXBwZXIodmFsaWROYW1lKTsKICAgIH0KCiAgICAvKioKICAg\nICAqICBDb252ZXJ0cyB0aGUgbmFtZSB0byBhIG5hbWUgd2hpY2ggY2FuIGJl\nIHVzZWQgd2l0aGluIGEgU1FMIHN0YXRlbWVudC4gIFVzZXMKICAgICAqICB0\naGUgYXBwcm9wcmlhdGUgZGVsaW1pdGVycyBhbmQgc2VwYXJhdG9ycy4gCiAg\nICAgKiAgQHBhcm0gbmFtZSBhIERCSWRlbnRpZmllcgogICAgICovCiAgICBw\ndWJsaWMgU3RyaW5nIHRvREJOYW1lKERCSWRlbnRpZmllciBuYW1lKSB7CiAg\nICAgICAgcmV0dXJuIHRvREJOYW1lKG5hbWUsIHRydWUpOwogICAgfQogICAg\nCiAgICAvKioKICAgICAqICBDb252ZXJ0cyB0aGUgbmFtZSB0byBhIG5hbWUg\nd2hpY2ggY2FuIGJlIHVzZWQgd2l0aGluIGEgU1FMIHN0YXRlbWVudC4gIFVz\nZXMKICAgICAqICB0aGUgYXBwcm9wcmlhdGUgZGVsaW1pdGVycyBhbmQgc2Vw\nYXJhdG9ycy4gCiAgICAgKiAgQHBhcm0gbmFtZSBhIERCSWRlbnRpZmllcgog\nICAgICogIEBwYXJhbSBkZWxpbWl0IElmIHRydWUsIGFsbG93cyB0aGUgbmFt\nZSB0byBiZSBkZWxpbWl0ZWQsIGlmIG5lY2Vzc2FyeS4gIAogICAgICogIE90\naGVyd2lzZSwgdGhlIGlkZW50aWZpZXIgaXMgbm90IGRlbGltaXRlZC4KICAg\nICAqLwogICAgcHVibGljIFN0cmluZyB0b0RCTmFtZShEQklkZW50aWZpZXIg\nbmFtZSwgYm9vbGVhbiBkZWxpbWl0KSB7CiAgICAgICAgaWYgKERCSWRlbnRp\nZmllci5pc051bGwobmFtZSkpIHsKICAgICAgICAgICAgcmV0dXJuIG51bGw7\nCiAgICAgICAgfQogICAgICAgIGlmIChnZXRJZGVudGlmaWVyQ29uZmlndXJh\ndGlvbigpLmdldFN1cHBvcnRzRGVsaW1pdGVkSWRlbnRpZmllcnMoKSAmJiBk\nZWxpbWl0IAogICAgICAgICAgICAmJiBnZXRJZGVudGlmaWVyQ29uZmlndXJh\ndGlvbigpLmRlbGltaXRBbGwoKSAmJiAhbmFtZS5pc0RlbGltaXRlZCgpKSB7\nCiAgICAgICAgICAgIHJldHVybiBkZWxpbWl0KG5hbWUsIHRydWUpOwogICAg\nICAgIH0KICAgICAgICBTdHJpbmcgcnVsZSA9IG5hbWUuZ2V0VHlwZSgpLm5h\nbWUoKTsKICAgICAgICBpZiAobmFtZSBpbnN0YW5jZW9mIFF1YWxpZmllZERC\nSWRlbnRpZmllcikgewogICAgICAgICAgICBRdWFsaWZpZWREQklkZW50aWZp\nZXIgcGF0aCA9IChRdWFsaWZpZWREQklkZW50aWZpZXIpbmFtZTsKICAgICAg\nICAgICAgcmV0dXJuIGNvbnZlcnRGdWxsKE5vcm1hbGl6ZXIuZ2V0TmFtaW5n\nQ29uZmlndXJhdGlvbigpLCBydWxlLCBwYXRoLmdldE5hbWUoKSk7CiAgICAg\nICAgfQogICAgICAgIHJldHVybiBjb252ZXJ0KE5vcm1hbGl6ZXIuZ2V0TmFt\naW5nQ29uZmlndXJhdGlvbigpLCBydWxlLCBuYW1lLmdldE5hbWUoKSk7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBDb252ZXJ0cyB0aGUgaWRlbnRpZmllciB0\nbyBhIGZvcm1hdCBhcHByb3ByaWF0ZSBmb3IgdGhlIGNvbmZpZ3VyYXRpb24u\nCiAgICAgKiBEZWxpbWl0cyBpZiBuZWNlc3NhcnkKICAgICAqLwogICAgcHVi\nbGljIFN0cmluZyB0b0RCTmFtZShTdHJpbmcgbmFtZSkgewogICAgICAgIHJl\ndHVybiB0b0RCTmFtZShuYW1lLCB0cnVlKTsKICAgIH0KCiAgICAvKioKICAg\nICAqIENvbnZlcnRzIHRoZSBpZGVudGlmaWVyIHRvIGEgZm9ybWF0IGFwcHJv\ncHJpYXRlIGZvciB0aGUgY29uZmlndXJhdGlvbiB1c2luZwogICAgICogdGhl\nIGRlZmF1bHQgbmFtaW5nIHJ1bGUuCiAgICAgKiBAcGFyYW0gZGVsaW1pdCBJ\nZiBmYWxzZSwgZG8gbm90IGRlbGltaXQuICBPdGhlcndpc2UsIGRlbGltaXQg\naWYgbmVjZXNzYXJ5LgogICAgICovCiAgICBwdWJsaWMgU3RyaW5nIHRvREJO\nYW1lKFN0cmluZyBuYW1lLCBib29sZWFuIGRlbGltaXQpIHsKICAgICAgICBy\nZXR1cm4gdG9EQk5hbWUoZ2V0SWRlbnRpZmllckNvbmZpZ3VyYXRpb24oKS5n\nZXREZWZhdWx0SWRlbnRpZmllclJ1bGUoKS5nZXROYW1lKCksIG5hbWUsIGRl\nbGltaXQpOwogICAgfQoKICAgIC8qKgogICAgICogQ29udmVydHMgdGhlIGlk\nZW50aWZpZXIgdG8gYSBmb3JtYXQgYXBwcm9wcmlhdGUgZm9yIHRoZSBjb25m\naWd1cmF0aW9uIHVzaW5nCiAgICAgKiB0aGUgc3BlY2lmaWVkIG5hbWluZyBy\ndWxlLgogICAgICogQHBhcmFtIGRlbGltaXQgSWYgZmFsc2UsIGRvIG5vdCBk\nZWxpbWl0LiAgT3RoZXJ3aXNlLCBkZWxpbWl0IGlmIG5lY2Vzc2FyeS4KICAg\nICAqLwogICAgcHJpdmF0ZSBTdHJpbmcgdG9EQk5hbWUoU3RyaW5nIHJ1bGUs\nIFN0cmluZyBuYW1lLCBib29sZWFuIGRlbGltaXQpIHsKICAgICAgICBpZiAo\nbmFtZSA9PSBudWxsKSB7CiAgICAgICAgICAgIHJldHVybiBudWxsOwogICAg\nICAgIH0KICAgICAgICBpZiAoZ2V0SWRlbnRpZmllckNvbmZpZ3VyYXRpb24o\nKS5nZXRTdXBwb3J0c0RlbGltaXRlZElkZW50aWZpZXJzKCkgJiYgZGVsaW1p\ndCAmJiAKICAgICAgICAgICAgZ2V0SWRlbnRpZmllckNvbmZpZ3VyYXRpb24o\nKS5kZWxpbWl0QWxsKCkgJiYgIU5vcm1hbGl6ZXIuaXNEZWxpbWl0ZWQobmFt\nZSkpIHsKICAgICAgICAgICAgcmV0dXJuIGRlbGltaXQocnVsZSwgbmFtZSwg\ndHJ1ZSk7CiAgICAgICAgfQogICAgICAgIHJldHVybiBjb252ZXJ0KE5vcm1h\nbGl6ZXIuZ2V0TmFtaW5nQ29uZmlndXJhdGlvbigpLCBydWxlLCBuYW1lKTsK\nICAgIH0KCiAgICAvKioKICAgICAqIENyZWF0ZXMgYSBuZXcgaWRlbnRpZmll\nciBvZiBhIGdpdmVuIHR5cGUgYmFzZWQgdXBvbiB0aGUgbmFtZSByZXR1cm5l\nZAogICAgICogZnJvbSB0aGUgZGF0YWJhc2UuICAKICAgICAqLwogICAgcHVi\nbGljIERCSWRlbnRpZmllciBmcm9tREJOYW1lKFN0cmluZyBuYW1lLCBEQklk\nZW50aWZpZXJUeXBlIGlkKSB7CiAgICAgICAgaWYgKG5hbWUgPT0gbnVsbCkg\newogICAgICAgICAgICByZXR1cm4gREJJZGVudGlmaWVyLk5VTEw7CiAgICAg\nICAgfQogICAgICAgIGlmICghZ2V0SWRlbnRpZmllckNvbmZpZ3VyYXRpb24o\nKS5nZXRTdXBwb3J0c0RlbGltaXRlZElkZW50aWZpZXJzKCkpIHsKICAgICAg\nICAgICAgcmV0dXJuIERCSWRlbnRpZmllci5uZXdJZGVudGlmaWVyKG5hbWUs\nIGlkKTsKICAgICAgICB9CiAgICAgICAgU3RyaW5nIGRlbGltQ2FzZSA9IGdl\ndElkZW50aWZpZXJDb25maWd1cmF0aW9uKCkuZ2V0RGVsaW1pdGVkQ2FzZSgp\nOwogICAgICAgIFN0cmluZyBub25EZWxpbUNhc2UgPSBnZXRJZGVudGlmaWVy\nQ29uZmlndXJhdGlvbigpLmdldFNjaGVtYUNhc2UoKTsKICAgICAgICBTdHJp\nbmcgY2FzZU5hbWUgPSBuYW1lOwogICAgICAgIAogICAgICAgIC8vIElmIGRl\nbGltaXRlZCBhbmQgbm9uLWRlbGltaXRlZCBjYXNlIGFyZSB0aGUgc2FtZSwg\nZG9uJ3QgY2hhbmdlIAogICAgICAgIC8vIGNhc2Ugb3IgdHJ5IHRvIGRldGVy\nbWluZSB3aGV0aGVyIGRlbGltaXRpbmcgaXMgcmVxdWlyZWQuICBMZXQgdGhl\nCiAgICAgICAgLy8gbm9ybWFsaXplciBmaWd1cmUgaXQgb3V0IHVzaW5nIHN0\nYW5kYXJkIHJ1bGVzLgogICAgICAgIGlmIChkZWxpbUNhc2UuZXF1YWxzKG5v\nbkRlbGltQ2FzZSkpIHsKICAgICAgICAgICAgcmV0dXJuIERCSWRlbnRpZmll\nci5uZXdJZGVudGlmaWVyKG5hbWUsIGlkLCBmYWxzZSwgZmFsc2UpOwogICAg\nICAgIH0KICAgICAgICAKICAgICAgICAvLyBPdGhlcndpc2UsIHRyeSB0byBk\nZXRlcm1pbmUgd2hldGhlciB0byBkZWxpbWl0IGJhc2VkIG9uIGFuIGV4cGVj\ndGVkIHZzLgogICAgICAgIC8vIGFjdHVhbCBuYW1lIGNvbXBhcmlzb24uCiAg\nICAgICAgaWYgKGRlbGltQ2FzZS5lcXVhbHMoQ0FTRV9QUkVTRVJWRSkpIHsK\nICAgICAgICAgICAgaWYgKG5vbkRlbGltQ2FzZS5lcXVhbHMoQ0FTRV9MT1dF\nUikpIHsKICAgICAgICAgICAgICAgIGNhc2VOYW1lID0gbmFtZS50b0xvd2Vy\nQ2FzZSgpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAg\nY2FzZU5hbWUgPSBuYW1lLnRvVXBwZXJDYXNlKCk7CiAgICAgICAgICAgIH0K\nICAgICAgICB9IGVsc2UgaWYgKGRlbGltQ2FzZS5lcXVhbHMoQ0FTRV9MT1dF\nUikpIHsKICAgICAgICAgICAgaWYgKG5vbkRlbGltQ2FzZS5lcXVhbHMoQ0FT\nRV9VUFBFUikpIHsKICAgICAgICAgICAgICAgIGNhc2VOYW1lID0gbmFtZS50\nb1VwcGVyQ2FzZSgpOwogICAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIGlm\nIChkZWxpbUNhc2UuZXF1YWxzKENBU0VfVVBQRVIpKSB7CiAgICAgICAgICAg\nIGlmIChub25EZWxpbUNhc2UuZXF1YWxzKENBU0VfTE9XRVIpKSB7CiAgICAg\nICAgICAgICAgICBjYXNlTmFtZSA9IG5hbWUudG9Mb3dlckNhc2UoKTsKICAg\nICAgICAgICAgfQogICAgICAgIH0KICAgICAgICAKICAgICAgICBib29sZWFu\nIGRlbGltaXQgPSAhY2FzZU5hbWUuZXF1YWxzKG5hbWUpIHx8IGdldElkZW50\naWZpZXJDb25maWd1cmF0aW9uKCkuZGVsaW1pdEFsbCgpOwogICAgICAgIHJl\ndHVybiBEQklkZW50aWZpZXIubmV3SWRlbnRpZmllcigoZGVsaW1pdCA/IG5h\nbWUgOiBjYXNlTmFtZSksIGlkLCBmYWxzZSwgZGVsaW1pdCk7CiAgICB9Cgog\nICAgcHVibGljIERCSWRlbnRpZmllciBhcHBlbmQoREJJZGVudGlmaWVyVHlw\nZSByZXN1bHRJZCwgREJJZGVudGlmaWVyLi4ubmFtZXMpIHsKICAgICAgICBp\nZiAobmFtZXMgPT0gbnVsbCB8fCBuYW1lcy5sZW5ndGggPT0gMCkgewogICAg\nICAgICAgICByZXR1cm4gREJJZGVudGlmaWVyLk5VTEw7CiAgICAgICAgfQog\nICAgICAgIERCSWRlbnRpZmllciBzTmFtZSA9IERCSWRlbnRpZmllci5uZXdJ\nZGVudGlmaWVyKCIiLCByZXN1bHRJZCk7CiAgICAgICAgZm9yIChEQklkZW50\naWZpZXIgbmFtZSA6IG5hbWVzKSB7CiAgICAgICAgICAgIERCSWRlbnRpZmll\nci5hcHBlbmQoc05hbWUsIG5hbWUuZ2V0TmFtZSgpKTsKICAgICAgICB9CiAg\nICAgICAgcmV0dXJuIHNOYW1lOwogICAgfQogICAgCiAgICBwdWJsaWMgU3Ry\naW5nIGFwcGVuZENvbHVtbnMoQ29sdW1uW10gY29sdW1ucykgewogICAgICAg\nIGlmIChjb2x1bW5zID09IG51bGwgfHwgY29sdW1ucy5sZW5ndGggPT0gMCkg\newogICAgICAgICAgICByZXR1cm4gIiI7CiAgICAgICAgfQogICAgICAgIGlm\nIChjb2x1bW5zLmxlbmd0aCA9PSAxKSB7CiAgICAgICAgICAgIHJldHVybiB0\nb0RCTmFtZShjb2x1bW5zWzBdLmdldElkZW50aWZpZXIoKSk7CiAgICAgICAg\nfQogICAgICAgIFN0cmluZ0J1aWxkZXIgY29sc2IgPSBuZXcgU3RyaW5nQnVp\nbGRlcigiIik7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBjb2x1bW5z\nLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGNvbHNiLmFwcGVuZCh0b0RC\nTmFtZShjb2x1bW5zW2ldLmdldElkZW50aWZpZXIoKSkpOwogICAgICAgICAg\nICBpZiAoaSA8IChjb2x1bW5zLmxlbmd0aCAtIDEpKSB7CiAgICAgICAgICAg\nICAgICBjb2xzYi5hcHBlbmQoIiwgIik7CiAgICAgICAgICAgIH0KICAgICAg\nICB9CiAgICAgICAgcmV0dXJuIGNvbHNiLnRvU3RyaW5nKCk7CiAgICB9CiAg\nICAKICAgIHB1YmxpYyBTdHJpbmcgZGVsaW1pdChEQklkZW50aWZpZXIgbmFt\nZSwgYm9vbGVhbiBmb3JjZSkgewogICAgICAgIFN0cmluZyBydWxlID0gbmFt\nZS5nZXRUeXBlKCkubmFtZSgpOwogICAgICAgIC8vIElmIHRoaXMgaXMgYSBj\nb21wb3VuZCBwYXRoLCBlYWNoIGl0ZW0gbXVzdCBiZSBkZWxpbWl0ZWQKICAg\nICAgICAvLyBzZXBhcmF0ZWx5CiAgICAgICAgaWYgKG5hbWUgaW5zdGFuY2Vv\nZiBRdWFsaWZpZWREQklkZW50aWZpZXIpIHsKICAgICAgICAgICAgUXVhbGlm\naWVkREJJZGVudGlmaWVyIHBhdGggPSAoUXVhbGlmaWVkREJJZGVudGlmaWVy\nKW5hbWU7CiAgICAgICAgICAgIC8vIE1ha2Ugc3VyZSB0aGlzIGlzIGEgcXVh\nbGlmaWVkIHBhdGggYmVmb3JlIGRlbGltaXRpbmcKICAgICAgICAgICAgLy8g\nc2VwYXJhdGVseQogICAgICAgICAgICBpZiAoISgocGF0aC5nZXRUeXBlKCkg\nPT0gREJJZGVudGlmaWVyVHlwZS5DT0xVTU4gJiYKICAgICAgICAgICAgICAg\nICAgcGF0aC5pc1VucXVhbGlmaWVkQ29sdW1uKCkpIHx8CiAgICAgICAgICAg\nICAgICAgIChwYXRoLmdldFR5cGUoKSAhPSBEQklkZW50aWZpZXJUeXBlLkNP\nTFVNTiAmJgogICAgICAgICAgICAgICAgICAgcGF0aC5pc1VucXVhbGlmaWVk\nT2JqZWN0KCkpKSkgewogICAgICAgICAgICAgICAgREJJZGVudGlmaWVyW10g\nbmFtZXMgPSBRdWFsaWZpZWREQklkZW50aWZpZXIuc3BsaXRQYXRoKG5hbWUp\nOwogICAgICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBuYW1lcy5s\nZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgICAgIERCSWRlbnRpZmll\nciBzTmFtZSA9IG5hbWVzW2ldLmdldFVucXVhbGlmaWVkTmFtZSgpOwogICAg\nICAgICAgICAgICAgICAgIGlmICghc05hbWUuaXNEZWxpbWl0ZWQoKSkgewog\nICAgICAgICAgICAgICAgICAgICAgICBTdHJpbmcgcFJ1bGUgPSBzTmFtZS5n\nZXRUeXBlKCkubmFtZSgpOwogICAgICAgICAgICAgICAgICAgICAgICBuYW1l\nc1tpXS5zZXROYW1lKGRlbGltaXQocFJ1bGUsIHNOYW1lLmdldE5hbWUoKSwg\nZm9yY2UpKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAg\nICB9CiAgICAgICAgICAgICAgICByZXR1cm4gUXVhbGlmaWVkREJJZGVudGlm\naWVyLm5ld1BhdGgobmFtZXMpLmdldE5hbWUoKTsKICAgICAgICAgICAgfQog\nICAgICAgIH0KICAgICAgICByZXR1cm4gZGVsaW1pdChydWxlLCBuYW1lLmdl\ndE5hbWUoKSwgZm9yY2UpOwogICAgfQogICAgCiAgICBwdWJsaWMgU3RyaW5n\nIHNob3J0ZW4oU3RyaW5nIG5hbWUsIGludCB0YXJnZXRMZW5ndGgpIHsKICAg\nICAgICByZXR1cm4gREJEaWN0aW9uYXJ5LnNob3J0ZW4obmFtZSwgdGFyZ2V0\nTGVuZ3RoKTsKICAgIH0KICAgIAogICAgcHVibGljIERCSWRlbnRpZmllciBn\nZXRHZW5lcmF0ZWRLZXlTZXF1ZW5jZU5hbWUoQ29sdW1uIGNvbCwgaW50IG1h\neExlbikgewogICAgICAgIERCSWRlbnRpZmllciB0bmFtZSA9IGNvbC5nZXRU\nYWJsZUlkZW50aWZpZXIoKTsKICAgICAgICBEQklkZW50aWZpZXIgY25hbWUg\nPSBjb2wuZ2V0SWRlbnRpZmllcigpOwogICAgICAgIGludCBtYXggPSBtYXhM\nZW47CiAgICAgICAgaW50IGV4dHJhQ2hhcnMgPSAtbWF4ICsgdG5hbWUuZ2V0\nTmFtZSgpLmxlbmd0aCgpICsgMSAvLyA8dG5hbWU+ICsgJ18nCiAgICAgICAg\nICAgICsgY25hbWUuZ2V0TmFtZSgpLmxlbmd0aCgpICsgNDsgLy8gPGNuYW1l\nPiArICdfU0VRJwogICAgICAgIFN0cmluZyB0c25hbWUgPSB0bmFtZS5nZXRO\nYW1lKCk7CiAgICAgICAgaWYgKGV4dHJhQ2hhcnMgPiAwKSB7CiAgICAgICAg\nICAgIC8vIHRoaXMgYXNzdW1lcyB0aGF0IHRuYW1lIGlzIGxvbmdlciB0aGFu\nIGV4dHJhQ2hhcnMKICAgICAgICAgICAgdHNuYW1lID0gdHNuYW1lLnN1YnN0\ncmluZygwLCB0c25hbWUubGVuZ3RoKCkgLSBleHRyYUNoYXJzKTsKICAgICAg\nICB9CiAgICAgICAgcmV0dXJuIERCSWRlbnRpZmllci5jb21iaW5lKERCSWRl\nbnRpZmllclR5cGUuU0VRVUVOQ0UsIHRzbmFtZSwgY25hbWUuZ2V0TmFtZSgp\nLCAiU0VRIik7CiAgICB9CiAgICAKICAgIC8qKgogICAgICogQ29udmVydCB0\naGUgc3BlY2lmaWVkIHNjaGVtYSBuYW1lIHRvIGEgbmFtZSB0aGF0IHRoZSBk\nYXRhYmFzZSB3aWxsCiAgICAgKiBiZSBhYmxlIHRvIHVuZGVyc3RhbmQgaW4g\nbWV0YWRhdGEgb3BlcmF0aW9ucy4KICAgICAqLwogICAgcHVibGljIERCSWRl\nbnRpZmllciBjb252ZXJ0U2NoZW1hQ2FzZShEQklkZW50aWZpZXIgbmFtZSkg\newogICAgICAgIGlmIChEQklkZW50aWZpZXIuaXNOdWxsKG5hbWUpKQogICAg\nICAgICAgICByZXR1cm4gREJJZGVudGlmaWVyLk5VTEw7CgogICAgICAgIERC\nSWRlbnRpZmllciBzTmFtZSA9IG5hbWUuY2xvbmUoKTsKICAgICAgICAvLyBI\nYW5kbGUgZGVsaW1pdGVkIHN0cmluZyBkaWZmZXJlbnRseS4gUmV0dXJuIHVu\ncXVvdGVkIG5hbWUuCiAgICAgICAgU3RyaW5nIGRlbGltQ2FzZSA9IGdldElk\nZW50aWZpZXJDb25maWd1cmF0aW9uKCkuZ2V0RGVsaW1pdGVkQ2FzZSgpOwog\nICAgICAgIGlmICgvKiBnZXROYW1pbmdDb25maWd1cmF0aW9uKCkuZGVsaW1p\ndEFsbCgpIHx8ICovIG5hbWUuaXNEZWxpbWl0ZWQoKSkgewogICAgICAgICAg\nICBpZiAoQ0FTRV9VUFBFUi5lcXVhbHMoZGVsaW1DYXNlKSkgewogICAgICAg\nICAgICAgICAgc05hbWUgPSBEQklkZW50aWZpZXIudG9VcHBlcihzTmFtZSx0\ncnVlKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlIGlmIChDQVNF\nX0xPV0VSLmVxdWFscyhkZWxpbUNhc2UpKSB7CiAgICAgICAgICAgICAgICBz\nTmFtZSA9IERCSWRlbnRpZmllci50b0xvd2VyKHNOYW1lLHRydWUpOwogICAg\nICAgICAgICB9CiAgICAgICAgICAgIAogICAgICAgICAgICByZXR1cm4gREJJ\nZGVudGlmaWVyLnJlbW92ZURlbGltaXRlcnMoc05hbWUpOwogICAgICAgIH0K\nICAgICAgICBpZiAoIWdldElkZW50aWZpZXJDb25maWd1cmF0aW9uKCkuZGVs\naW1pdEFsbCgpKSB7CiAgICAgICAgICAgIC8vIE5vdCBkZWxpbWl0ZWQsIHVz\nZSB0aGUgYmFzZSBzY2hlbWEgY2FzZSBleHBlY3RlZCBieSB0aGUgREIKICAg\nICAgICAgICAgU3RyaW5nIHNjaGVtYUNhc2UgPSBnZXRJZGVudGlmaWVyQ29u\nZmlndXJhdGlvbigpLmdldFNjaGVtYUNhc2UoKTsKICAgICAgICAgICAgaWYg\nKENBU0VfTE9XRVIuZXF1YWxzKHNjaGVtYUNhc2UpKQogICAgICAgICAgICAg\nICAgcmV0dXJuIERCSWRlbnRpZmllci50b0xvd2VyKHNOYW1lKTsKICAgICAg\nICAgICAgaWYgKENBU0VfUFJFU0VSVkUuZXF1YWxzKHNjaGVtYUNhc2UpKQog\nICAgICAgICAgICAgICAgcmV0dXJuIHNOYW1lOwogICAgICAgICAgICByZXR1\ncm4gREJJZGVudGlmaWVyLnRvVXBwZXIoc05hbWUpOwogICAgICAgIH0KICAg\nICAgICByZXR1cm4gc05hbWU7CiAgICB9CiAgICAKICAgIC8qKgogICAgICog\nQ29udmVydHMgYSBjb2x1bW4gYWxpYXMgdG8gdXNlIHRoZSBhcHByb3ByaWF0\nZSBkZWxpbWl0ZXJzCiAgICAgKi8KICAgIHB1YmxpYyBTdHJpbmcgY29udmVy\ndEFsaWFzKFN0cmluZyBhbGlhcykgewogICAgICAgIGlmICghbmVlZHNDb252\nZXJzaW9uKGdldElkZW50aWZpZXJDb25maWd1cmF0aW9uKCkpKSB7CiAgICAg\nICAgICAgIHJldHVybiBhbGlhczsKICAgICAgICB9CgogICAgICAgIFN0cmlu\nZ1tdIG5hbWVzID0gTm9ybWFsaXplci5zcGxpdE5hbWUoYWxpYXMpOwogICAg\nICAgIGlmIChuYW1lcy5sZW5ndGggPD0gMSkgewogICAgICAgICAgICAvLyBO\nb3RoaW5nIHRvIHNwbGl0CiAgICAgICAgICAgIHJldHVybiBhbGlhczsKICAg\nICAgICB9CiAgICAgICAgLy8gU2tpcCB0aGUgdGhlIGZpcnN0IG5hbWUuICBJ\ndCBpcyB0aGUgYWxpYXMgKFQwLCBUMSwgZXRjLikKICAgICAgICBmb3IgKGlu\ndCBpID0gMTsgaSA8IG5hbWVzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAg\nIG5hbWVzW2ldID0gdG9EQk5hbWUoZ2V0SWRlbnRpZmllckNvbmZpZ3VyYXRp\nb24oKS5nZXREZWZhdWx0SWRlbnRpZmllclJ1bGUoKS50b1N0cmluZygpLCBu\nYW1lc1tpXSwgdHJ1ZSk7CiAgICAgICAgfQogICAgICAgIHJldHVybiBqb2lu\nTmFtZXMoZ2V0SWRlbnRpZmllckNvbmZpZ3VyYXRpb24oKS5nZXREZWZhdWx0\nSWRlbnRpZmllclJ1bGUoKSwgbmFtZXMpOwogICAgfQoKICAgIHByaXZhdGUg\nREJJZGVudGlmaWVyIG1ha2VOYW1lKFN0cmluZyBydWxlLCBEQklkZW50aWZp\nZXIgbmFtZSwgVGFibGUgdGJsLCBTdHJpbmcgcHJlZml4KSB7CiAgICAgICAg\nREJJZGVudGlmaWVyIHNOYW1lID0gREJJZGVudGlmaWVyLnJlbW92ZUxlYWRp\nbmcobmFtZSwgSWRlbnRpZmllclV0aWwuVU5ERVJTQ09SRSk7CiAgICAgICAg\nU3RyaW5nIHRhYmxlTmFtZSA9IHRibC5nZXRJZGVudGlmaWVyKCkuZ2V0TmFt\nZSgpOwogICAgICAgIGludCBsZW4gPSBNYXRoLm1pbih0YWJsZU5hbWUubGVu\nZ3RoKCksIDcpOwogICAgICAgIAogICAgICAgIC8vIENvbWJpbmUgdGhlIG5h\nbWVzIHVzaW5nIHRoZSBub3JtYWxpemVkIGNvbmZpZ3VyYXRpb24uICAKICAg\nICAgICBTdHJpbmcgc3RyID0gY29tYmluZU5hbWVzKE5vcm1hbGl6ZXIuZ2V0\nTmFtaW5nQ29uZmlndXJhdGlvbigpLCBydWxlLCAKICAgICAgICAgICAgbmV3\nIFN0cmluZ1tdIHsgcHJlZml4ID09IG51bGwgPyAiIiA6IHByZWZpeCwgCiAg\nICAgICAgICAgIHNob3J0ZW4odGFibGVOYW1lLCBsZW4pLCBzTmFtZS5nZXRO\nYW1lKCkgfSk7CiAgICAgICAgc05hbWUuc2V0TmFtZShzdHIpOwogICAgICAg\nIHJldHVybiBzTmFtZTsKICAgIH0KCiAgICBwcml2YXRlIERCSWRlbnRpZmll\nciBtYWtlTmFtZShTdHJpbmcgcnVsZSwgREJJZGVudGlmaWVyIG5hbWUsIFN0\ncmluZyBwcmVmaXgpIHsKICAgICAgICBEQklkZW50aWZpZXIgc05hbWUgPSBE\nQklkZW50aWZpZXIucmVtb3ZlTGVhZGluZyhuYW1lLCBJZGVudGlmaWVyVXRp\nbC5VTkRFUlNDT1JFKTsKICAgICAgICBpZiAoIVN0cmluZ1V0aWxzLmlzRW1w\ndHkocHJlZml4KSkgewogICAgICAgICAgICBzTmFtZSA9IERCSWRlbnRpZmll\nci5wcmVDb21iaW5lKHNOYW1lLCBwcmVmaXgpOwogICAgICAgIH0KICAgICAg\nICByZXR1cm4gc05hbWU7CiAgICB9CgogICAgcHJpdmF0ZSBpbnQgZ2V0TWF4\nTGVuKFN0cmluZyBydWxlLCBEQklkZW50aWZpZXIgbmFtZSwgaW50IG1heExl\nbikgewogICAgICAgIElkZW50aWZpZXJDb25maWd1cmF0aW9uIGNvbmZpZyA9\nIGdldElkZW50aWZpZXJDb25maWd1cmF0aW9uKCk7CiAgICAgICAgaWYgKG1h\neExlbiA8IDEpIHsKICAgICAgICAgICAgSWRlbnRpZmllclJ1bGUgbnJ1bGUg\nPSBjb25maWcuZ2V0SWRlbnRpZmllclJ1bGUocnVsZSk7CiAgICAgICAgICAg\nIG1heExlbiA9IG5ydWxlLmdldE1heExlbmd0aCgpOwogICAgICAgIH0KICAg\nICAgICAvLyBTdWJ0cmFjdCBkZWxpbWl0ZXIgbGVuZ3RoIGlmIG5hbWUgaXMg\nZGVsaW1pdGVkIG9yIHdpbGwgYmUgZGVsaW1pdGVkCiAgICAgICAgaWYgKGNv\nbmZpZy5kZWxpbWl0QWxsKCkgfHwgbmFtZS5pc0RlbGltaXRlZCgpKSB7CiAg\nICAgICAgICAgIG1heExlbiA9IG1heExlbiAtIChjb25maWcuZ2V0TGVhZGlu\nZ0RlbGltaXRlcigpLmxlbmd0aCgpICsgY29uZmlnLmdldFRyYWlsaW5nRGVs\naW1pdGVyKCkubGVuZ3RoKCkpOwogICAgICAgIH0KICAgICAgICAKICAgICAg\nICByZXR1cm4gbWF4TGVuOwogICAgfQogICAgCiAgICAvKioKICAgICAqIFN5\nc3RlbSBjb25maWd1cmF0aW9uLgogICAgICovCiAgICBwdWJsaWMgSkRCQ0Nv\nbmZpZ3VyYXRpb24gZ2V0Q29uZmlndXJhdGlvbigpIHsKICAgICAgICByZXR1\ncm4gX2NvbmY7CiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgdm9p\nZCBzZXRDb25maWd1cmF0aW9uKENvbmZpZ3VyYXRpb24gY29uZikgewogICAg\nICAgIF9jb25mID0gKEpEQkNDb25maWd1cmF0aW9uKWNvbmY7CiAgICB9Cn0K\n","encoding":"base64"}

