{"sha":"4df87296921216260cf021c1fce3125b27495a53","node_id":"MDQ6QmxvYjIwNjM2NDo0ZGY4NzI5NjkyMTIxNjI2MGNmMDIxYzFmY2UzMTI1YjI3NDk1YTUz","size":15786,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/4df87296921216260cf021c1fce3125b27495a53","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5rZXJuZWw7CgppbXBv\ncnQgamF2YS5pby5TZXJpYWxpemFibGU7CmltcG9ydCBqYXZhLnNxbC5Db25u\nZWN0aW9uOwppbXBvcnQgamF2YS5zcWwuUmVzdWx0U2V0OwppbXBvcnQgamF2\nYS51dGlsLkNvbGxlY3Rpb247CmltcG9ydCBqYXZhLnV0aWwuQ29sbGVjdGlv\nbnM7CmltcG9ydCBqYXZhLnV0aWwuSGFzaFNldDsKaW1wb3J0IGphdmEudXRp\nbC5JdGVyYXRvcjsKaW1wb3J0IGphdmEudXRpbC5TZXQ7CgppbXBvcnQgb3Jn\nLmFwYWNoZS5jb21tb25zLmxhbmcuU3RyaW5nVXRpbHM7CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEuY29uZi5PcGVuSlBBQ29uZmlndXJhdGlvbjsKaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLmNvbmYuSkRCQ0NvbmZpZ3Vy\nYXRpb247CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhLkNs\nYXNzTWFwcGluZzsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNx\nbC5Kb2luU3ludGF4ZXM7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEua2Vy\nbmVsLkZldGNoQ29uZmlndXJhdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5rZXJuZWwuRmV0Y2hDb25maWd1cmF0aW9uSW1wbDsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuU3RvcmVDb250ZXh0OwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLmxpYi5yb3AuRWFnZXJSZXN1bHRMaXN0Owpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi5yb3AuTGlzdFJlc3VsdE9i\namVjdFByb3ZpZGVyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi5y\nb3AuUmVzdWx0TGlzdDsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIu\ncm9wLlJlc3VsdE9iamVjdFByb3ZpZGVyOwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLmxpYi5yb3AuU2ltcGxlUmVzdWx0TGlzdDsKaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS5saWIucm9wLlNvZnRSYW5kb21BY2Nlc3NSZXN1bHRM\naXN0OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi5yb3AuV2luZG93\nUmVzdWx0TGlzdDsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIudXRp\nbC5Mb2NhbGl6ZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YS5G\naWVsZE1ldGFEYXRhOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwu\nVXNlckV4Y2VwdGlvbjsKCi8qKgogKiBKREJDIGV4dGVuc2lvbnMgdG8gT3Bl\nbkpQQSdzIHtAbGluayBGZXRjaENvbmZpZ3VyYXRpb259LgogKgogKiBAYXV0\naG9yIEFiZSBXaGl0ZQogKiBAbm9qYXZhZG9jCiAqLwpAU3VwcHJlc3NXYXJu\naW5ncygic2VyaWFsIikKcHVibGljIGNsYXNzIEpEQkNGZXRjaENvbmZpZ3Vy\nYXRpb25JbXBsCiAgICBleHRlbmRzIEZldGNoQ29uZmlndXJhdGlvbkltcGwK\nICAgIGltcGxlbWVudHMgSkRCQ0ZldGNoQ29uZmlndXJhdGlvbiB7CgogICAg\ncHJpdmF0ZSBzdGF0aWMgZmluYWwgTG9jYWxpemVyIF9sb2MgPSBMb2NhbGl6\nZXIuZm9yUGFja2FnZShKREJDRmV0Y2hDb25maWd1cmF0aW9uSW1wbC5jbGFz\ncyk7CiAgICAKICAgIC8qKgogICAgICogSGludCBrZXlzIHRoYXQgY29ycmVz\ncG9uZCB0byBhIG11dGFibGUgYmVhbi1zdHlsZSBzZXR0ZXIgaW4gdGhpcyBy\nZWNlaXZlci4KICAgICAqIFRoZXNlIGtleXMgYXJlIHJlZ2lzdGVyZWQgd2l0\naCBib3RoIDxjb2RlPm9wZW5qcGEuRmV0Y2hQbGFuPC9jb2RlPiBhbmQgPGNv\nZGU+b3BlbmpwYS5qZGJjPC9jb2RlPiBhcyBwcmVmaXguCiAgICAgKiA8YnI+\nCiAgICAgKiBBIGhpbnQgd2l0aG91dCBhIHNldHRlciBtZXRob2QgaXMgYWxz\nbyByZWNvZ25pemVkIGJ5IHRoaXMgcmVjZWl2ZXIuCiAgICAgKi8KICAgIHN0\nYXRpYyB7CiAgICAgICAgU3RyaW5nW10gcHJlZml4ZXMgPSB7Im9wZW5qcGEu\nRmV0Y2hQbGFuIiwgIm9wZW5qcGEuamRiYyJ9OwogICAgICAgIENsYXNzPD8+\nIHRhcmdldCA9IEpEQkNGZXRjaENvbmZpZ3VyYXRpb24uY2xhc3M7CiAgICAg\nICAgcG9wdWxhdGVIaW50U2V0dGVyKHRhcmdldCwgIkVhZ2VyRmV0Y2hNb2Rl\nIiwgaW50LmNsYXNzLCBwcmVmaXhlcyk7CiAgICAgICAgcG9wdWxhdGVIaW50\nU2V0dGVyKHRhcmdldCwgIkZldGNoRGlyZWN0aW9uIiwgaW50LmNsYXNzLCBw\ncmVmaXhlcyk7CiAgICAgICAgcG9wdWxhdGVIaW50U2V0dGVyKHRhcmdldCwg\nIklzb2xhdGlvbiIsIGludC5jbGFzcywgcHJlZml4ZXMpOwogICAgICAgIHBv\ncHVsYXRlSGludFNldHRlcih0YXJnZXQsICJzZXRJc29sYXRpb24iLCAiVHJh\nbnNhY3Rpb25Jc29sYXRpb24iLCBpbnQuY2xhc3MsICJvcGVuanBhLmpkYmMi\nKTsKICAgICAgICBwb3B1bGF0ZUhpbnRTZXR0ZXIodGFyZ2V0LCAiSm9pblN5\nbnRheCIsIGludC5jbGFzcywgcHJlZml4ZXMpOwogICAgICAgIHBvcHVsYXRl\nSGludFNldHRlcih0YXJnZXQsICJTdWJjbGFzc0ZldGNoTW9kZSIsIGludC5j\nbGFzcywgcHJlZml4ZXMpOwogICAgICAgIHBvcHVsYXRlSGludFNldHRlcih0\nYXJnZXQsICJMUlNTaXplIiwgaW50LmNsYXNzLCBwcmVmaXhlcyk7CiAgICAg\nICAgcG9wdWxhdGVIaW50U2V0dGVyKHRhcmdldCwgInNldExSU1NpemUiLCAi\nTFJTU2l6ZUFsZ29yaXRobSIsIGludC5jbGFzcywgcHJlZml4ZXMpOwogICAg\nICAgIHBvcHVsYXRlSGludFNldHRlcih0YXJnZXQsICJSZXN1bHRTZXRUeXBl\nIiwgaW50LmNsYXNzLCBwcmVmaXhlcyk7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBDb25maWd1cmFibGUgSkRCQyBzdGF0ZSBzaGFyZWQgdGhyb3VnaG91dCBh\nIHRyYXZlcnNhbCBjaGFpbi4KICAgICAqLwogICAgcHJvdGVjdGVkIHN0YXRp\nYyBjbGFzcyBKREJDQ29uZmlndXJhdGlvblN0YXRlIGltcGxlbWVudHMgU2Vy\naWFsaXphYmxlIHsKICAgICAgICBwdWJsaWMgaW50IGVhZ2VyTW9kZSA9IDA7\nCiAgICAgICAgcHVibGljIGludCBzdWJjbGFzc01vZGUgPSAwOwogICAgICAg\nIHB1YmxpYyBpbnQgdHlwZSA9IDA7CiAgICAgICAgcHVibGljIGludCBkaXJl\nY3Rpb24gPSAwOwogICAgICAgIHB1YmxpYyBpbnQgc2l6ZSA9IDA7CiAgICAg\nICAgcHVibGljIGludCBzeW50YXggPSAwOwogICAgICAgIHB1YmxpYyBTZXQ8\nU3RyaW5nPiBqb2lucyA9IG51bGw7CiAgICAgICAgcHVibGljIFNldDxTdHJp\nbmc+IGZldGNoSW5uZXJKb2lucyA9IG51bGw7CiAgICAgICAgcHVibGljIGlu\ndCBpc29sYXRpb25MZXZlbCA9IC0xOwogICAgfQoKICAgIHByb3RlY3RlZCBm\naW5hbCBKREJDQ29uZmlndXJhdGlvblN0YXRlIF9zdGF0ZTsKCiAgICBwdWJs\naWMgSkRCQ0ZldGNoQ29uZmlndXJhdGlvbkltcGwoKSB7CiAgICAgICAgdGhp\ncyhudWxsLCBudWxsKTsKICAgIH0KCiAgICBwcm90ZWN0ZWQgSkRCQ0ZldGNo\nQ29uZmlndXJhdGlvbkltcGwoQ29uZmlndXJhdGlvblN0YXRlIHN0YXRlLCAK\nICAgICAgICBKREJDQ29uZmlndXJhdGlvblN0YXRlIGpzdGF0ZSkgewogICAg\nICAgIHN1cGVyKHN0YXRlKTsKICAgICAgICBfc3RhdGUgPSAoanN0YXRlID09\nIG51bGwpID8gbmV3IEpEQkNDb25maWd1cmF0aW9uU3RhdGUoKSA6IGpzdGF0\nZTsKICAgIH0KCiAgICBwcm90ZWN0ZWQgRmV0Y2hDb25maWd1cmF0aW9uSW1w\nbCBuZXdJbnN0YW5jZShDb25maWd1cmF0aW9uU3RhdGUgc3RhdGUpIHsKICAg\nICAgICBKREJDQ29uZmlndXJhdGlvblN0YXRlIGpzdGF0ZSA9IChzdGF0ZSA9\nPSBudWxsKSA/IG51bGwgOiBfc3RhdGU7CiAgICAgICAgcmV0dXJuIG5ldyBK\nREJDRmV0Y2hDb25maWd1cmF0aW9uSW1wbChzdGF0ZSwganN0YXRlKTsKICAg\nIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRDb250ZXh0KFN0b3JlQ29udGV4dCBj\ndHgpIHsKICAgICAgICBzdXBlci5zZXRDb250ZXh0KGN0eCk7CiAgICAgICAg\nSkRCQ0NvbmZpZ3VyYXRpb24gY29uZiA9IGdldEpEQkNDb25maWd1cmF0aW9u\nKCk7CiAgICAgICAgaWYgKGNvbmYgPT0gbnVsbCkKICAgICAgICAgICAgcmV0\ndXJuOwoKICAgICAgICBzZXRFYWdlckZldGNoTW9kZShjb25mLmdldEVhZ2Vy\nRmV0Y2hNb2RlQ29uc3RhbnQoKSk7CiAgICAgICAgc2V0U3ViY2xhc3NGZXRj\naE1vZGUoY29uZi5nZXRTdWJjbGFzc0ZldGNoTW9kZUNvbnN0YW50KCkpOwog\nICAgICAgIHNldFJlc3VsdFNldFR5cGUoY29uZi5nZXRSZXN1bHRTZXRUeXBl\nQ29uc3RhbnQoKSk7CiAgICAgICAgc2V0RmV0Y2hEaXJlY3Rpb24oY29uZi5n\nZXRGZXRjaERpcmVjdGlvbkNvbnN0YW50KCkpOwogICAgICAgIHNldExSU1Np\nemUoY29uZi5nZXRMUlNTaXplQ29uc3RhbnQoKSk7CiAgICAgICAgc2V0Sm9p\nblN5bnRheChjb25mLmdldERCRGljdGlvbmFyeUluc3RhbmNlKCkuam9pblN5\nbnRheCk7CiAgICB9CgogICAgcHVibGljIHZvaWQgY29weShGZXRjaENvbmZp\nZ3VyYXRpb24gZmV0Y2gpIHsKICAgICAgICBzdXBlci5jb3B5KGZldGNoKTsK\nICAgICAgICBKREJDRmV0Y2hDb25maWd1cmF0aW9uIGpmID0gKEpEQkNGZXRj\naENvbmZpZ3VyYXRpb24pIGZldGNoOwogICAgICAgIHNldEVhZ2VyRmV0Y2hN\nb2RlKGpmLmdldEVhZ2VyRmV0Y2hNb2RlKCkpOwogICAgICAgIHNldFN1YmNs\nYXNzRmV0Y2hNb2RlKGpmLmdldFN1YmNsYXNzRmV0Y2hNb2RlKCkpOwogICAg\nICAgIHNldFJlc3VsdFNldFR5cGUoamYuZ2V0UmVzdWx0U2V0VHlwZSgpKTsK\nICAgICAgICBzZXRGZXRjaERpcmVjdGlvbihqZi5nZXRGZXRjaERpcmVjdGlv\nbigpKTsKICAgICAgICBzZXRMUlNTaXplKGpmLmdldExSU1NpemUoKSk7CiAg\nICAgICAgc2V0Sm9pblN5bnRheChqZi5nZXRKb2luU3ludGF4KCkpOwogICAg\nICAgIGFkZEpvaW5zKGpmLmdldEpvaW5zKCkpOwogICAgfQoKICAgIHB1Ymxp\nYyBpbnQgZ2V0RWFnZXJGZXRjaE1vZGUoKSB7CiAgICAgICAgcmV0dXJuIF9z\ndGF0ZS5lYWdlck1vZGU7CiAgICB9CgogICAgcHVibGljIEpEQkNGZXRjaENv\nbmZpZ3VyYXRpb24gc2V0RWFnZXJGZXRjaE1vZGUoaW50IG1vZGUpIHsKICAg\nICAgICBpZiAobW9kZSAhPSBERUZBVUxUCiAgICAgICAgICAgICYmIG1vZGUg\nIT0gRWFnZXJGZXRjaE1vZGVzLkVBR0VSX05PTkUKICAgICAgICAgICAgJiYg\nbW9kZSAhPSBFYWdlckZldGNoTW9kZXMuRUFHRVJfSk9JTgogICAgICAgICAg\nICAmJiBtb2RlICE9IEVhZ2VyRmV0Y2hNb2Rlcy5FQUdFUl9QQVJBTExFTCkK\nICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlv\nbigKICAgICAgICAgICAgICAgIF9sb2MuZ2V0KCJiYWQtZmV0Y2gtbW9kZSIs\nIG5ldyBJbnRlZ2VyKG1vZGUpKS5nZXRNZXNzYWdlKCkpOwoKICAgICAgICBp\nZiAobW9kZSA9PSBERUZBVUxUKSB7CiAgICAgICAgICAgIEpEQkNDb25maWd1\ncmF0aW9uIGNvbmYgPSBnZXRKREJDQ29uZmlndXJhdGlvbigpOwogICAgICAg\nICAgICBpZiAoY29uZiAhPSBudWxsKQogICAgICAgICAgICAgICAgbW9kZSA9\nIGNvbmYuZ2V0RWFnZXJGZXRjaE1vZGVDb25zdGFudCgpOwogICAgICAgIH0K\nICAgICAgICBpZiAobW9kZSAhPSBERUZBVUxUKQogICAgICAgICAgICBfc3Rh\ndGUuZWFnZXJNb2RlID0gbW9kZTsKICAgICAgICByZXR1cm4gdGhpczsKICAg\nIH0KICAgIAogICAgcHVibGljIGludCBnZXRTdWJjbGFzc0ZldGNoTW9kZSgp\nIHsKICAgICAgICByZXR1cm4gX3N0YXRlLnN1YmNsYXNzTW9kZTsKICAgIH0K\nCiAgICBwdWJsaWMgaW50IGdldFN1YmNsYXNzRmV0Y2hNb2RlKENsYXNzTWFw\ncGluZyBjbHMpIHsKICAgICAgICBpZiAoY2xzID09IG51bGwpCiAgICAgICAg\nICAgIHJldHVybiBfc3RhdGUuc3ViY2xhc3NNb2RlOwogICAgICAgIGludCBt\nb2RlID0gY2xzLmdldFN1YmNsYXNzRmV0Y2hNb2RlKCk7CiAgICAgICAgaWYg\nKG1vZGUgPT0gREVGQVVMVCkKICAgICAgICAgICAgcmV0dXJuIF9zdGF0ZS5z\ndWJjbGFzc01vZGU7CiAgICAgICAgcmV0dXJuIE1hdGgubWluKG1vZGUsIF9z\ndGF0ZS5zdWJjbGFzc01vZGUpOwogICAgfQoKICAgIHB1YmxpYyBKREJDRmV0\nY2hDb25maWd1cmF0aW9uIHNldFN1YmNsYXNzRmV0Y2hNb2RlKGludCBtb2Rl\nKSB7CiAgICAgICAgaWYgKG1vZGUgIT0gREVGQVVMVAogICAgICAgICAgICAm\nJiBtb2RlICE9IEVhZ2VyRmV0Y2hNb2Rlcy5FQUdFUl9OT05FCiAgICAgICAg\nICAgICYmIG1vZGUgIT0gRWFnZXJGZXRjaE1vZGVzLkVBR0VSX0pPSU4KICAg\nICAgICAgICAgJiYgbW9kZSAhPSBFYWdlckZldGNoTW9kZXMuRUFHRVJfUEFS\nQUxMRUwpCiAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRF\neGNlcHRpb24oCiAgICAgICAgICAgICAgICBfbG9jLmdldCgiYmFkLWZldGNo\nLW1vZGUiLCBuZXcgSW50ZWdlcihtb2RlKSkuZ2V0TWVzc2FnZSgpKTsKCiAg\nICAgICAgaWYgKG1vZGUgPT0gREVGQVVMVCkgewogICAgICAgICAgICBKREJD\nQ29uZmlndXJhdGlvbiBjb25mID0gZ2V0SkRCQ0NvbmZpZ3VyYXRpb24oKTsK\nICAgICAgICAgICAgaWYgKGNvbmYgIT0gbnVsbCkKICAgICAgICAgICAgICAg\nIG1vZGUgPSBjb25mLmdldFN1YmNsYXNzRmV0Y2hNb2RlQ29uc3RhbnQoKTsK\nICAgICAgICB9CiAgICAgICAgaWYgKG1vZGUgIT0gREVGQVVMVCkKICAgICAg\nICAgICAgX3N0YXRlLnN1YmNsYXNzTW9kZSA9IG1vZGU7CiAgICAgICAgcmV0\ndXJuIHRoaXM7CiAgICB9CgogICAgcHVibGljIGludCBnZXRSZXN1bHRTZXRU\neXBlKCkgewogICAgICAgIHJldHVybiBfc3RhdGUudHlwZTsKICAgIH0KCiAg\nICBwdWJsaWMgSkRCQ0ZldGNoQ29uZmlndXJhdGlvbiBzZXRSZXN1bHRTZXRU\neXBlKGludCB0eXBlKSB7CiAgICAgICAgaWYgKHR5cGUgIT0gREVGQVVMVAog\nICAgICAgICAgICAmJiB0eXBlICE9IFJlc3VsdFNldC5UWVBFX0ZPUldBUkRf\nT05MWQogICAgICAgICAgICAmJiB0eXBlICE9IFJlc3VsdFNldC5UWVBFX1ND\nUk9MTF9JTlNFTlNJVElWRQogICAgICAgICAgICAmJiB0eXBlICE9IFJlc3Vs\ndFNldC5UWVBFX1NDUk9MTF9TRU5TSVRJVkUpCiAgICAgICAgICAgIHRocm93\nIG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24oX2xvYy5nZXQoImJhZC1y\nZXN1bHRzZXQtdHlwZSIsCiAgICAgICAgICAgICAgICBuZXcgSW50ZWdlcih0\neXBlKSkuZ2V0TWVzc2FnZSgpKTsKCiAgICAgICAgaWYgKHR5cGUgPT0gREVG\nQVVMVCkgewogICAgICAgICAgICBKREJDQ29uZmlndXJhdGlvbiBjb25mID0g\nZ2V0SkRCQ0NvbmZpZ3VyYXRpb24oKTsKICAgICAgICAgICAgaWYgKGNvbmYg\nIT0gbnVsbCkKICAgICAgICAgICAgICAgIF9zdGF0ZS50eXBlID0gY29uZi5n\nZXRSZXN1bHRTZXRUeXBlQ29uc3RhbnQoKTsKICAgICAgICB9IGVsc2UKICAg\nICAgICAgICAgX3N0YXRlLnR5cGUgPSB0eXBlOwogICAgICAgIHJldHVybiB0\naGlzOwogICAgfQoKICAgIHB1YmxpYyBpbnQgZ2V0RmV0Y2hEaXJlY3Rpb24o\nKSB7CiAgICAgICAgcmV0dXJuIF9zdGF0ZS5kaXJlY3Rpb247CiAgICB9Cgog\nICAgcHVibGljIEpEQkNGZXRjaENvbmZpZ3VyYXRpb24gc2V0RmV0Y2hEaXJl\nY3Rpb24oaW50IGRpcmVjdGlvbikgewogICAgICAgIGlmIChkaXJlY3Rpb24g\nIT0gREVGQVVMVAogICAgICAgICAgICAmJiBkaXJlY3Rpb24gIT0gUmVzdWx0\nU2V0LkZFVENIX0ZPUldBUkQKICAgICAgICAgICAgJiYgZGlyZWN0aW9uICE9\nIFJlc3VsdFNldC5GRVRDSF9SRVZFUlNFCiAgICAgICAgICAgICYmIGRpcmVj\ndGlvbiAhPSBSZXN1bHRTZXQuRkVUQ0hfVU5LTk9XTikKICAgICAgICAgICAg\ndGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbihfbG9jLmdldCgi\nYmFkLWZldGNoLWRpcmVjdGlvbiIsCiAgICAgICAgICAgICAgICBuZXcgSW50\nZWdlcihkaXJlY3Rpb24pKS5nZXRNZXNzYWdlKCkpOwoKICAgICAgICBpZiAo\nZGlyZWN0aW9uID09IERFRkFVTFQpIHsKICAgICAgICAgICAgSkRCQ0NvbmZp\nZ3VyYXRpb24gY29uZiA9IGdldEpEQkNDb25maWd1cmF0aW9uKCk7CiAgICAg\nICAgICAgIGlmIChjb25mICE9IG51bGwpCiAgICAgICAgICAgICAgICBfc3Rh\ndGUuZGlyZWN0aW9uID0gY29uZi5nZXRGZXRjaERpcmVjdGlvbkNvbnN0YW50\nKCk7CiAgICAgICAgfSBlbHNlCiAgICAgICAgICAgIF9zdGF0ZS5kaXJlY3Rp\nb24gPSBkaXJlY3Rpb247CiAgICAgICAgcmV0dXJuIHRoaXM7CiAgICB9Cgog\nICAgcHVibGljIGludCBnZXRMUlNTaXplKCkgewogICAgICAgIHJldHVybiBf\nc3RhdGUuc2l6ZTsKICAgIH0KCiAgICBwdWJsaWMgSkRCQ0ZldGNoQ29uZmln\ndXJhdGlvbiBzZXRMUlNTaXplKGludCBzaXplKSB7CiAgICAgICAgaWYgKHNp\nemUgIT0gREVGQVVMVAogICAgICAgICAgICAmJiBzaXplICE9IExSU1NpemVz\nLlNJWkVfUVVFUlkKICAgICAgICAgICAgJiYgc2l6ZSAhPSBMUlNTaXplcy5T\nSVpFX0xBU1QKICAgICAgICAgICAgJiYgc2l6ZSAhPSBMUlNTaXplcy5TSVpF\nX1VOS05PV04pCiAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1l\nbnRFeGNlcHRpb24oCiAgICAgICAgICAgICAgICBfbG9jLmdldCgiYmFkLWxy\ncy1zaXplIiwgbmV3IEludGVnZXIoc2l6ZSkpLmdldE1lc3NhZ2UoKSk7Cgog\nICAgICAgIGlmIChzaXplID09IERFRkFVTFQpIHsKICAgICAgICAgICAgSkRC\nQ0NvbmZpZ3VyYXRpb24gY29uZiA9IGdldEpEQkNDb25maWd1cmF0aW9uKCk7\nCiAgICAgICAgICAgIGlmIChjb25mICE9IG51bGwpCiAgICAgICAgICAgICAg\nICBfc3RhdGUuc2l6ZSA9IGNvbmYuZ2V0TFJTU2l6ZUNvbnN0YW50KCk7CiAg\nICAgICAgfSBlbHNlCiAgICAgICAgICAgIF9zdGF0ZS5zaXplID0gc2l6ZTsK\nICAgICAgICByZXR1cm4gdGhpczsKICAgIH0KCiAgICBwdWJsaWMgaW50IGdl\ndEpvaW5TeW50YXgoKSB7CiAgICAgICAgcmV0dXJuIF9zdGF0ZS5zeW50YXg7\nCiAgICB9CgogICAgcHVibGljIEpEQkNGZXRjaENvbmZpZ3VyYXRpb24gc2V0\nSm9pblN5bnRheChpbnQgc3ludGF4KSB7CiAgICAgICAgaWYgKHN5bnRheCAh\nPSBERUZBVUxUCiAgICAgICAgICAgICYmIHN5bnRheCAhPSBKb2luU3ludGF4\nZXMuU1lOVEFYX1NRTDkyCiAgICAgICAgICAgICYmIHN5bnRheCAhPSBKb2lu\nU3ludGF4ZXMuU1lOVEFYX1RSQURJVElPTkFMCiAgICAgICAgICAgICYmIHN5\nbnRheCAhPSBKb2luU3ludGF4ZXMuU1lOVEFYX0RBVEFCQVNFKQogICAgICAg\nICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uKAogICAg\nICAgICAgICAgICAgX2xvYy5nZXQoImJhZC1qb2luLXN5bnRheCIsIG5ldyBJ\nbnRlZ2VyKHN5bnRheCkpLmdldE1lc3NhZ2UoKSk7CgogICAgICAgIGlmIChz\neW50YXggPT0gREVGQVVMVCkgewogICAgICAgICAgICBKREJDQ29uZmlndXJh\ndGlvbiBjb25mID0gZ2V0SkRCQ0NvbmZpZ3VyYXRpb24oKTsKICAgICAgICAg\nICAgaWYgKGNvbmYgIT0gbnVsbCkKICAgICAgICAgICAgICAgIF9zdGF0ZS5z\neW50YXggPSBjb25mLmdldERCRGljdGlvbmFyeUluc3RhbmNlKCkuam9pblN5\nbnRheDsKICAgICAgICB9IGVsc2UKICAgICAgICAgICAgX3N0YXRlLnN5bnRh\neCA9IHN5bnRheDsKICAgICAgICByZXR1cm4gdGhpczsKICAgIH0KCiAgICBw\ndWJsaWMgUmVzdWx0TGlzdDw/PiBuZXdSZXN1bHRMaXN0KFJlc3VsdE9iamVj\ndFByb3ZpZGVyIHJvcCkgewogICAgICAgIC8vIGlmIGJ1aWx0IGFyb3VuZCBh\nIGxpc3QsIGp1c3QgdXNlIGEgc2ltcGxlIHdyYXBwZXIKICAgICAgICBpZiAo\ncm9wIGluc3RhbmNlb2YgTGlzdFJlc3VsdE9iamVjdFByb3ZpZGVyKQogICAg\nICAgICAgICByZXR1cm4gbmV3IFNpbXBsZVJlc3VsdExpc3Qocm9wKTsKCiAg\nICAgICAgLy8gaWYgYnVpbHQgYXJvdW5kIGEgcGFnaW5nIGxpc3QsIHVzZSBh\nIHdpbmRvdyBwcm92aWRlciB3aXRoIHRoZQogICAgICAgIC8vIHNhbWUgd2lu\nZG93IHNpemUKICAgICAgICBpZiAocm9wIGluc3RhbmNlb2YgUGFnaW5nUmVz\ndWx0T2JqZWN0UHJvdmlkZXIpCiAgICAgICAgICAgIHJldHVybiBuZXcgV2lu\nZG93UmVzdWx0TGlzdChyb3AsICgoUGFnaW5nUmVzdWx0T2JqZWN0UHJvdmlk\nZXIpCiAgICAgICAgICAgICAgICByb3ApLmdldFBhZ2VTaXplKCkpOwoKICAg\nICAgICAvLyBpZiBmZXRjaCBzaXplIDwgMCBqdXN0IHJlYWQgaW4gYWxsIHJl\nc3VsdHMgaW1tZWRpYXRlbHkKICAgICAgICBpZiAoZ2V0RmV0Y2hCYXRjaFNp\nemUoKSA8IDApCiAgICAgICAgICAgIHJldHVybiBuZXcgRWFnZXJSZXN1bHRM\naXN0KHJvcCk7CgogICAgICAgIC8vIGlmIGZvd2FyZCBvbmx5IG9yIGZvcndh\ncmQgZGlyZWN0aW9uIHVzZSBhIGZvcndhcmQgd2luZG93CiAgICAgICAgaWYg\nKF9zdGF0ZS50eXBlID09IFJlc3VsdFNldC5UWVBFX0ZPUldBUkRfT05MWQog\nICAgICAgICAgICB8fCBfc3RhdGUuZGlyZWN0aW9uID09IFJlc3VsdFNldC5G\nRVRDSF9GT1JXQVJECiAgICAgICAgICAgIHx8ICFyb3Auc3VwcG9ydHNSYW5k\nb21BY2Nlc3MoKSkgewogICAgICAgICAgICBpZiAoZ2V0RmV0Y2hCYXRjaFNp\nemUoKSA+IDAgJiYgZ2V0RmV0Y2hCYXRjaFNpemUoKSA8PSA1MCkKICAgICAg\nICAgICAgICAgIHJldHVybiBuZXcgV2luZG93UmVzdWx0TGlzdChyb3AsIGdl\ndEZldGNoQmF0Y2hTaXplKCkpOwogICAgICAgICAgICByZXR1cm4gbmV3IFdp\nbmRvd1Jlc3VsdExpc3Qocm9wLCA1MCk7CiAgICAgICAgfQoKICAgICAgICAv\nLyBpZiBza2lwcGluZyBhcm91bmQgdXNlIGEgY2FjaGluZyByYW5kb20gYWNj\nZXNzIGxpc3QKICAgICAgICBpZiAoX3N0YXRlLmRpcmVjdGlvbiA9PSBSZXN1\nbHRTZXQuRkVUQ0hfVU5LTk9XTikKICAgICAgICAgICAgcmV0dXJuIG5ldyBT\nb2Z0UmFuZG9tQWNjZXNzUmVzdWx0TGlzdChyb3ApOwoKICAgICAgICAvLyBz\nY3JvbGxpbmcgcmV2ZXJzZS4uLiBqdXN0IHVzZSBub24tY2FjaGluZyBzaW1w\nbGUgcmVzdWx0IGxpc3QKICAgICAgICByZXR1cm4gbmV3IFNpbXBsZVJlc3Vs\ndExpc3Qocm9wKTsKICAgIH0KCiAgICBwdWJsaWMgU2V0PFN0cmluZz4gZ2V0\nSm9pbnMoKSB7CiAgICAgICAgaWYgKF9zdGF0ZS5qb2lucyA9PSBudWxsKSAK\nICAgICAgICAgICAgcmV0dXJuIENvbGxlY3Rpb25zLmVtcHR5U2V0KCk7CiAg\nICAgICAgcmV0dXJuIF9zdGF0ZS5qb2luczsKICAgIH0KCiAgICBwdWJsaWMg\nYm9vbGVhbiBoYXNKb2luKFN0cmluZyBmaWVsZCkgewogICAgICAgIHJldHVy\nbiBfc3RhdGUuam9pbnMgIT0gbnVsbCAmJiBfc3RhdGUuam9pbnMuY29udGFp\nbnMoZmllbGQpOwogICAgfQoKICAgIHB1YmxpYyBKREJDRmV0Y2hDb25maWd1\ncmF0aW9uIGFkZEpvaW4oU3RyaW5nIGpvaW4pIHsKICAgICAgICBpZiAoU3Ry\naW5nVXRpbHMuaXNFbXB0eShqb2luKSkKICAgICAgICAgICAgdGhyb3cgbmV3\nIFVzZXJFeGNlcHRpb24oX2xvYy5nZXQoIm51bGwtam9pbiIpKTsKICAgICAg\nICAKICAgICAgICBsb2NrKCk7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAg\naWYgKF9zdGF0ZS5qb2lucyA9PSBudWxsKQogICAgICAgICAgICAgICAgX3N0\nYXRlLmpvaW5zID0gbmV3IEhhc2hTZXQ8U3RyaW5nPigpOwogICAgICAgICAg\nICBfc3RhdGUuam9pbnMuYWRkKGpvaW4pOwogICAgICAgIH0gZmluYWxseSB7\nCiAgICAgICAgICAgIHVubG9jaygpOwogICAgICAgIH0KICAgICAgICByZXR1\ncm4gdGhpczsKICAgIH0KCiAgICBwdWJsaWMgSkRCQ0ZldGNoQ29uZmlndXJh\ndGlvbiBhZGRKb2lucyhDb2xsZWN0aW9uPFN0cmluZz4gam9pbnMpIHsKICAg\nICAgICBpZiAoam9pbnMgPT0gbnVsbCB8fCBqb2lucy5pc0VtcHR5KCkpCiAg\nICAgICAgICAgIHJldHVybiB0aGlzOwogICAgICAgIGZvciAoSXRlcmF0b3I8\nU3RyaW5nPiBpdHIgPSBqb2lucy5pdGVyYXRvcigpOyBpdHIuaGFzTmV4dCgp\nOykKICAgICAgICAgICAgYWRkSm9pbihpdHIubmV4dCgpKTsKICAgICAgICBy\nZXR1cm4gdGhpczsKICAgIH0KCiAgICBwdWJsaWMgSkRCQ0ZldGNoQ29uZmln\ndXJhdGlvbiByZW1vdmVKb2luKFN0cmluZyBmaWVsZCkgewogICAgICAgIGxv\nY2soKTsKICAgICAgICB0cnkgewogICAgICAgICAgICBpZiAoX3N0YXRlLmpv\naW5zICE9IG51bGwpCiAgICAgICAgICAgICAgICBfc3RhdGUuam9pbnMucmVt\nb3ZlKGZpZWxkKTsKICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICB1\nbmxvY2soKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHRoaXM7CiAgICB9\nCgogICAgcHVibGljIEpEQkNGZXRjaENvbmZpZ3VyYXRpb24gcmVtb3ZlSm9p\nbnMoQ29sbGVjdGlvbjxTdHJpbmc+IGpvaW5zKSB7CiAgICAgICAgbG9jaygp\nOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIGlmIChfc3RhdGUuam9pbnMg\nIT0gbnVsbCkKICAgICAgICAgICAgICAgIF9zdGF0ZS5qb2lucy5yZW1vdmVB\nbGwoam9pbnMpOwogICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgIHVu\nbG9jaygpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gdGhpczsKICAgIH0K\nCiAgICBwdWJsaWMgSkRCQ0ZldGNoQ29uZmlndXJhdGlvbiBjbGVhckpvaW5z\nKCkgewogICAgICAgIGxvY2soKTsKICAgICAgICB0cnkgewogICAgICAgICAg\nICBpZiAoX3N0YXRlLmpvaW5zICE9IG51bGwpCiAgICAgICAgICAgICAgICBf\nc3RhdGUuam9pbnMuY2xlYXIoKTsKICAgICAgICB9IGZpbmFsbHkgewogICAg\nICAgICAgICB1bmxvY2soKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHRo\naXM7CiAgICB9CgogICAgcHVibGljIGludCBnZXRJc29sYXRpb24oKSB7CiAg\nICAgICAgcmV0dXJuIF9zdGF0ZS5pc29sYXRpb25MZXZlbDsKICAgIH0KCiAg\nICBwdWJsaWMgSkRCQ0ZldGNoQ29uZmlndXJhdGlvbiBzZXRJc29sYXRpb24o\naW50IGxldmVsKSB7CiAgICAgICAgaWYgKGxldmVsICE9IC0xICYmIGxldmVs\nICE9IERFRkFVTFQKICAgICAgICAgICAgJiYgbGV2ZWwgIT0gQ29ubmVjdGlv\nbi5UUkFOU0FDVElPTl9OT05FCiAgICAgICAgICAgICYmIGxldmVsICE9IENv\nbm5lY3Rpb24uVFJBTlNBQ1RJT05fUkVBRF9VTkNPTU1JVFRFRAogICAgICAg\nICAgICAmJiBsZXZlbCAhPSBDb25uZWN0aW9uLlRSQU5TQUNUSU9OX1JFQURf\nQ09NTUlUVEVECiAgICAgICAgICAgICYmIGxldmVsICE9IENvbm5lY3Rpb24u\nVFJBTlNBQ1RJT05fUkVQRUFUQUJMRV9SRUFECiAgICAgICAgICAgICYmIGxl\ndmVsICE9IENvbm5lY3Rpb24uVFJBTlNBQ1RJT05fU0VSSUFMSVpBQkxFKQog\nICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9u\nKAogICAgICAgICAgICAgICAgX2xvYy5nZXQoImJhZC1sZXZlbCIsIG5ldyBJ\nbnRlZ2VyKGxldmVsKSkuZ2V0TWVzc2FnZSgpKTsKCiAgICAgICAgaWYgKGxl\ndmVsID09IERFRkFVTFQpCiAgICAgICAgICAgIF9zdGF0ZS5pc29sYXRpb25M\nZXZlbCA9IC0xOwogICAgICAgIGVsc2UKICAgICAgICAgICAgX3N0YXRlLmlz\nb2xhdGlvbkxldmVsID0gbGV2ZWw7CiAgICAgICAgcmV0dXJuIHRoaXM7CiAg\nICB9CgogICAgcHVibGljIEpEQkNGZXRjaENvbmZpZ3VyYXRpb24gdHJhdmVy\nc2VKREJDKEZpZWxkTWV0YURhdGEgZm0pIHsKICAgICAgICByZXR1cm4gKEpE\nQkNGZXRjaENvbmZpZ3VyYXRpb24pIHRyYXZlcnNlKGZtKTsKICAgIH0KCiAg\nICAvKioKICAgICAqIEFjY2VzcyBKREJDIGNvbmZpZ3VyYXRpb24gaW5mb3Jt\nYXRpb24uIE1heSByZXR1cm4gbnVsbCBpZiBub3QgYQogICAgICogSkRCQyBi\nYWNrLWVuZCAocG9zc2libGUgdG8gZ2V0IGEgSkRCQ0ZldGNoQ29uZmlndXJh\ndGlvbiBvbiBub24tSkRCQwogICAgICogYmFjayBlbmQgaW4gcmVtb3RlIGNs\naWVudCkuCiAgICAgKi8KICAgIHByaXZhdGUgSkRCQ0NvbmZpZ3VyYXRpb24g\nZ2V0SkRCQ0NvbmZpZ3VyYXRpb24oKSB7CiAgICAgICAgU3RvcmVDb250ZXh0\nIGN0eCA9IGdldENvbnRleHQoKTsKICAgICAgICBpZiAoY3R4ID09IG51bGwp\nCiAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgIE9wZW5KUEFDb25m\naWd1cmF0aW9uIGNvbmYgPSBjdHguZ2V0Q29uZmlndXJhdGlvbigpOwogICAg\nICAgIGlmICghKGNvbmYgaW5zdGFuY2VvZiBKREJDQ29uZmlndXJhdGlvbikp\nCiAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgIHJldHVybiAoSkRC\nQ0NvbmZpZ3VyYXRpb24pIGNvbmY7CiAgICB9CgogICAgcHVibGljIFNldDxT\ndHJpbmc+IGdldEZldGNoSW5uZXJKb2lucygpIHsKICAgICAgICBpZiAoX3N0\nYXRlLmZldGNoSW5uZXJKb2lucyA9PSBudWxsKSAKICAgICAgICAgICAgcmV0\ndXJuIENvbGxlY3Rpb25zLmVtcHR5U2V0KCk7CiAgICAgICAgcmV0dXJuIF9z\ndGF0ZS5mZXRjaElubmVySm9pbnM7CiAgICB9CgogICAgcHVibGljIGJvb2xl\nYW4gaGFzRmV0Y2hJbm5lckpvaW4oU3RyaW5nIGZpZWxkKSB7CiAgICAgICAg\ncmV0dXJuIF9zdGF0ZS5mZXRjaElubmVySm9pbnMgIT0gbnVsbCAmJgogICAg\nICAgICAgICBfc3RhdGUuZmV0Y2hJbm5lckpvaW5zLmNvbnRhaW5zKGZpZWxk\nKTsKICAgIH0KCiAgICBwdWJsaWMgSkRCQ0ZldGNoQ29uZmlndXJhdGlvbiBh\nZGRGZXRjaElubmVySm9pbihTdHJpbmcgam9pbikgewogICAgICAgIGlmIChT\ndHJpbmdVdGlscy5pc0VtcHR5KGpvaW4pKQogICAgICAgICAgICB0aHJvdyBu\nZXcgVXNlckV4Y2VwdGlvbihfbG9jLmdldCgibnVsbC1qb2luIikpOwogICAg\nICAgIAogICAgICAgIGxvY2soKTsKICAgICAgICB0cnkgewogICAgICAgICAg\nICBpZiAoX3N0YXRlLmZldGNoSW5uZXJKb2lucyA9PSBudWxsKQogICAgICAg\nICAgICAgICAgX3N0YXRlLmZldGNoSW5uZXJKb2lucyA9IG5ldyBIYXNoU2V0\nPFN0cmluZz4oKTsKICAgICAgICAgICAgX3N0YXRlLmZldGNoSW5uZXJKb2lu\ncy5hZGQoam9pbik7CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAg\ndW5sb2NrKCk7CiAgICAgICAgfQogICAgICAgIHJldHVybiB0aGlzOwogICAg\nfQoKICAgIHB1YmxpYyBKREJDRmV0Y2hDb25maWd1cmF0aW9uIGFkZEZldGNo\nSW5uZXJKb2lucyhDb2xsZWN0aW9uPFN0cmluZz4gam9pbnMpIHsKICAgICAg\nICBpZiAoam9pbnMgPT0gbnVsbCB8fCBqb2lucy5pc0VtcHR5KCkpCiAgICAg\nICAgICAgIHJldHVybiB0aGlzOwogICAgICAgIGZvciAoSXRlcmF0b3I8U3Ry\naW5nPiBpdHIgPSBqb2lucy5pdGVyYXRvcigpOyBpdHIuaGFzTmV4dCgpOykK\nICAgICAgICAgICAgYWRkRmV0Y2hJbm5lckpvaW4oKFN0cmluZykgaXRyLm5l\neHQoKSk7CiAgICAgICAgcmV0dXJuIHRoaXM7CiAgICB9Cn0K\n","encoding":"base64"}

