{"sha":"429419b01165d6a4c85aebfbc6c6221b42a571a2","node_id":"MDQ6QmxvYjIwNjM2NDo0Mjk0MTliMDExNjVkNmE0Yzg1YWViZmJjNmM2MjIxYjQyYTU3MWEy","size":5795,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/429419b01165d6a4c85aebfbc6c6221b42a571a2","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5rZXJuZWw7CgppbXBv\ncnQgamF2YS5zcWwuU1FMRXhjZXB0aW9uOwppbXBvcnQgamF2YS51dGlsLkhh\nc2hNYXA7CmltcG9ydCBqYXZhLnV0aWwuTGlzdDsKaW1wb3J0IGphdmEudXRp\nbC5NYXA7CgppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuaWRlbnRp\nZmllci5EQklkZW50aWZpZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\namRiYy5tZXRhLkNsYXNzTWFwcGluZzsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5qZGJjLm1ldGEuRmllbGRNYXBwaW5nOwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLmpkYmMuc3FsLkRCRGljdGlvbmFyeTsKaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS5qZGJjLnNxbC5TUUxCdWZmZXI7CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEuamRiYy5zcWwuU1FMRXhjZXB0aW9uczsKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNxbC5TUUxGYWN0b3J5OwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc3FsLlNlbGVjdDsKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuTWl4ZWRMb2NrTGV2ZWxzOwpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5PcGVuSlBBU3RhdGVN\nYW5hZ2VyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51dGlsLkxv\nY2FsaXplcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLk9wdGlt\naXN0aWNFeGNlcHRpb247CgovKioKICogTWl4ZWQgbG9jayBtYW5hZ2VyIGlt\ncGxlbWVudHMgYm90aCBvcHRpbWlzdGljIGFuZCBwZXNzaW1pc3RpYyBsb2Nr\naW5nCiAqIHNlbWFudGljcyBpbiBwYXJhbGxlbCB0byB0aGUgSlBBIDIuMCBz\ncGVjaWZpY2F0aW9uLgogKgogKiBAYXV0aG9yIEFsYmVydCBMZWUKICogQHNp\nbmNlIDIuMC4wCiAqLwpwdWJsaWMgY2xhc3MgTWl4ZWRMb2NrTWFuYWdlciBl\neHRlbmRzIFBlc3NpbWlzdGljTG9ja01hbmFnZXIgewoKICAgIHByaXZhdGUg\nc3RhdGljIGZpbmFsIExvY2FsaXplciBfbG9jID0gTG9jYWxpemVyCiAgICAg\nICAgLmZvclBhY2thZ2UoTWl4ZWRMb2NrTWFuYWdlci5jbGFzcyk7CgogICAg\nLyoKICAgICAqIChub24tSmF2YWRvYykKICAgICAqIEBzZWUgb3JnLmFwYWNo\nZS5vcGVuanBhLmpkYmMua2VybmVsLlBlc3NpbWlzdGljTG9ja01hbmFnZXIK\nICAgICAqICAjc2VsZWN0Rm9yVXBkYXRlKG9yZy5hcGFjaGUub3BlbmpwYS5q\nZGJjLnNxbC5TZWxlY3QsaW50KQogICAgICovCiAgICBwdWJsaWMgYm9vbGVh\nbiBzZWxlY3RGb3JVcGRhdGUoU2VsZWN0IHNlbCwgaW50IGxvY2tMZXZlbCkg\newogICAgICAgIHJldHVybiAobG9ja0xldmVsID49IE1peGVkTG9ja0xldmVs\ncy5MT0NLX1BFU1NJTUlTVElDX1JFQUQpIAogICAgICAgICAgICA/IHN1cGVy\nLnNlbGVjdEZvclVwZGF0ZShzZWwsIGxvY2tMZXZlbCkgOiBmYWxzZTsKICAg\nIH0KCiAgICAvKgogICAgICogKG5vbi1KYXZhZG9jKQogICAgICogQHNlZSBv\ncmcuYXBhY2hlLm9wZW5qcGEuamRiYy5rZXJuZWwuUGVzc2ltaXN0aWNMb2Nr\nTWFuYWdlciMKICAgICAqICBsb2NrSW50ZXJuYWwob3JnLmFwYWNoZS5vcGVu\nanBhLmtlcm5lbC5PcGVuSlBBU3RhdGVNYW5hZ2VyLCBpbnQsIGludCwKICAg\nICAqICAgICAgICAgICAgICAgamF2YS5sYW5nLk9iamVjdCkKICAgICAqLwog\nICAgcHJvdGVjdGVkIHZvaWQgbG9ja0ludGVybmFsKE9wZW5KUEFTdGF0ZU1h\nbmFnZXIgc20sIGludCBsZXZlbCwgaW50IHRpbWVvdXQsCiAgICAgICAgT2Jq\nZWN0IHNkYXRhLCBib29sZWFuIHBvc3RMb2NrVmVyc2lvbkNoZWNrKSB7CiAg\nICAgICAgaWYgKGxldmVsID49IE1peGVkTG9ja0xldmVscy5MT0NLX1BFU1NJ\nTUlTVElDX0ZPUkNFX0lOQ1JFTUVOVCkgewogICAgICAgICAgICBzZXRWZXJz\naW9uQ2hlY2tPblJlYWRMb2NrKHRydWUpOwogICAgICAgICAgICBzZXRWZXJz\naW9uVXBkYXRlT25Xcml0ZUxvY2sodHJ1ZSk7CiAgICAgICAgICAgIHN1cGVy\nLmxvY2tJbnRlcm5hbChzbSwgbGV2ZWwsIHRpbWVvdXQsIHNkYXRhLCBwb3N0\nTG9ja1ZlcnNpb25DaGVjayk7CiAgICAgICAgfSBlbHNlIGlmIChsZXZlbCA+\nPSBNaXhlZExvY2tMZXZlbHMuTE9DS19QRVNTSU1JU1RJQ19SRUFEKSB7CiAg\nICAgICAgICAgIHNldFZlcnNpb25DaGVja09uUmVhZExvY2sodHJ1ZSk7CiAg\nICAgICAgICAgIHNldFZlcnNpb25VcGRhdGVPbldyaXRlTG9jayhmYWxzZSk7\nCiAgICAgICAgICAgIHN1cGVyLmxvY2tJbnRlcm5hbChzbSwgbGV2ZWwsIHRp\nbWVvdXQsIHNkYXRhLCBwb3N0TG9ja1ZlcnNpb25DaGVjayk7CiAgICAgICAg\nfSBlbHNlIGlmIChsZXZlbCA+PSBNaXhlZExvY2tMZXZlbHMuTE9DS19SRUFE\nKSB7CiAgICAgICAgICAgIHNldFZlcnNpb25DaGVja09uUmVhZExvY2sodHJ1\nZSk7CiAgICAgICAgICAgIHNldFZlcnNpb25VcGRhdGVPbldyaXRlTG9jayh0\ncnVlKTsKICAgICAgICAgICAgb3B0aW1pc3RpY0xvY2tJbnRlcm5hbChzbSwg\nbGV2ZWwsIHRpbWVvdXQsIHNkYXRhLAogICAgICAgICAgICAgICAgcG9zdExv\nY2tWZXJzaW9uQ2hlY2spOwogICAgICAgIH0KICAgIH0KCiAgICBwcm90ZWN0\nZWQgTGlzdDxTUUxCdWZmZXI+IGdldExvY2tSb3dzKERCRGljdGlvbmFyeSBk\naWN0LCBPYmplY3QgaWQsIENsYXNzTWFwcGluZyBtYXBwaW5nLAogICAgICAg\nICAgICBKREJDRmV0Y2hDb25maWd1cmF0aW9uIGZldGNoLCBTUUxGYWN0b3J5\nIGZhY3RvcnkpIHsKICAgICAgICBMaXN0PFNRTEJ1ZmZlcj4gc3FscyA9IHN1\ncGVyLmdldExvY2tSb3dzKGRpY3QsIGlkLCBtYXBwaW5nLCBmZXRjaCwgZmFj\ndG9yeSk7CiAgICAgICAgLy8gCiAgICAgICAgaWYoIWRpY3Quc3VwcG9ydHNM\nb2NraW5nV2l0aE11bHRpcGxlVGFibGVzKSB7CiAgICAgICAgICAgIC8vIGxv\nb2sgZm9yIGNvbHVtbnMgbWFwcGVkIHRvIHNlY29uZGFyeSB0YWJsZXMgd2hp\nY2ggbmVlZCB0byBiZSBsb2NrZWQKICAgICAgICAgICAgTWFwPERCSWRlbnRp\nZmllcixGaWVsZE1hcHBpbmc+IGNvbHNNYXBwZWRUb1NlY1RhYmxlID0gbmV3\nIEhhc2hNYXA8REJJZGVudGlmaWVyLEZpZWxkTWFwcGluZz4oKTsKICAgICAg\nICAgICAgRmllbGRNYXBwaW5nIGZtc1tdID0gbWFwcGluZy5nZXRGaWVsZE1h\ncHBpbmdzKCk7CiAgICAgICAgICAgIGZvciggRmllbGRNYXBwaW5nIGZtIDog\nZm1zKSB7CiAgICAgICAgICAgICAgICBEQklkZW50aWZpZXIgc2VjVGFibGVO\nYW1lID0gZm0uZ2V0TWFwcGluZ0luZm8oKS5nZXRUYWJsZUlkZW50aWZpZXIo\nKTsKICAgICAgICAgICAgICAgIGlmKCFEQklkZW50aWZpZXIuaXNOdWxsKHNl\nY1RhYmxlTmFtZSkpIHsKICAgICAgICAgICAgICAgICAgICBjb2xzTWFwcGVk\nVG9TZWNUYWJsZS5wdXQoc2VjVGFibGVOYW1lLCBmbSk7CiAgICAgICAgICAg\nICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZm9yKCBEQklkZW50\naWZpZXIgc2VjVGFibGVOYW1lIDogY29sc01hcHBlZFRvU2VjVGFibGUua2V5\nU2V0KCkpIHsKICAgICAgICAgICAgICAgIEZpZWxkTWFwcGluZyBmbSA9IGNv\nbHNNYXBwZWRUb1NlY1RhYmxlLmdldChzZWNUYWJsZU5hbWUpOwogICAgICAg\nICAgICAgICAgLy8gc2VsZWN0IG9ubHkgdGhlIFBLIGNvbHVtbnMsIHNpbmNl\nIHdlIGp1c3Qgd2FudCB0byBsb2NrCiAgICAgICAgICAgICAgICBTZWxlY3Qg\nc2VsZWN0ID0gZmFjdG9yeS5uZXdTZWxlY3QoKTsKICAgICAgICAgICAgICAg\nIHNlbGVjdC5zZWxlY3QoZm0uZ2V0Q29sdW1ucygpKTsKICAgICAgICAgICAg\nICAgIHNlbGVjdC53aGVyZUZvcmVpZ25LZXkoZm0uZ2V0Sm9pbkZvcmVpZ25L\nZXkoKSwgaWQsIG1hcHBpbmcsIF9zdG9yZSk7CiAgICAgICAgICAgICAgICBz\ncWxzLmFkZChzZWxlY3QudG9TZWxlY3QodHJ1ZSwgZmV0Y2gpKTsKICAgICAg\nICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4gc3FsczsKICAgIH0K\nCiAgICBwcm90ZWN0ZWQgdm9pZCBvcHRpbWlzdGljTG9ja0ludGVybmFsKE9w\nZW5KUEFTdGF0ZU1hbmFnZXIgc20sIGludCBsZXZlbCwKICAgICAgICBpbnQg\ndGltZW91dCwgT2JqZWN0IHNkYXRhLCBib29sZWFuIHBvc3RMb2NrVmVyc2lv\nbkNoZWNrKSB7CiAgICAgICAgc3VwZXIub3B0aW1pc3RpY0xvY2tJbnRlcm5h\nbChzbSwgbGV2ZWwsIHRpbWVvdXQsIHNkYXRhLAogICAgICAgICAgICBwb3N0\nTG9ja1ZlcnNpb25DaGVjayk7CiAgICAgICAgaWYgKHBvc3RMb2NrVmVyc2lv\nbkNoZWNrKSB7CiAgICAgICAgICAgIGlmIChsZXZlbCA+PSBNaXhlZExvY2tM\nZXZlbHMuTE9DS19QRVNTSU1JU1RJQ19SRUFEKSB7CiAgICAgICAgICAgICAg\nICBDbGFzc01hcHBpbmcgbWFwcGluZyA9IChDbGFzc01hcHBpbmcpIHNtLmdl\ndE1ldGFEYXRhKCk7CiAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAg\nICAgICAgICAgIGlmICghbWFwcGluZy5nZXRWZXJzaW9uKCkuY2hlY2tWZXJz\naW9uKHNtLCB0aGlzLmdldFN0b3JlKCksCiAgICAgICAgICAgICAgICAgICAg\nICAgIGZhbHNlKSkgewogICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyAo\nbmV3IE9wdGltaXN0aWNFeGNlcHRpb24oX2xvYy5nZXQoCiAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAib3B0aW1pc3RpYy12aW9sYXRpb24tbG9jayIp\nLmdldE1lc3NhZ2UoKSkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAu\nc2V0RmFpbGVkT2JqZWN0KHNtLmdldE9iamVjdElkKCkpOwogICAgICAgICAg\nICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0gY2F0Y2ggKFNRTEV4Y2Vw\ndGlvbiBzZSkgewogICAgICAgICAgICAgICAgICAgIHRocm93IFNRTEV4Y2Vw\ndGlvbnMuZ2V0U3RvcmUoc2UsIHNtLmdldE9iamVjdElkKCksCiAgICAgICAg\nICAgICAgICAgICAgICAgIGdldFN0b3JlKCkuZ2V0REJEaWN0aW9uYXJ5KCkp\nOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQog\nICAgfQoKICAgIHB1YmxpYyBib29sZWFuIHNraXBSZWxhdGlvbkZpZWxkTG9j\naygpIHsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KfQo=\n","encoding":"base64"}

