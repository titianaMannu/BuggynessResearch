{"sha":"1bcac2b2163aa6a86b3c09400fddb8d65732d435","node_id":"MDQ6QmxvYjIwNjM2NDoxYmNhYzJiMjE2M2FhNmE4NmIzYzA5NDAwZmRkYjhkNjU3MzJkNDM1","size":7757,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/1bcac2b2163aa6a86b3c09400fddb8d65732d435","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5rZXJuZWw7CgppbXBv\ncnQgamF2YS5zcWwuQ29ubmVjdGlvbjsKaW1wb3J0IGphdmEuc3FsLlByZXBh\ncmVkU3RhdGVtZW50OwppbXBvcnQgamF2YS5zcWwuUmVzdWx0U2V0OwppbXBv\ncnQgamF2YS5zcWwuU1FMRXhjZXB0aW9uOwppbXBvcnQgamF2YS51dGlsLkFy\ncmF5TGlzdDsKaW1wb3J0IGphdmEudXRpbC5MaXN0OwoKaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS5qZGJjLm1ldGEuQ2xhc3NNYXBwaW5nOwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc3FsLkRCRGljdGlvbmFyeTsKaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNxbC5TUUxCdWZmZXI7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zcWwuU1FMRXhjZXB0aW9u\nczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNxbC5TUUxGYWN0\nb3J5OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc3FsLlNlbGVj\ndDsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuT3BlbkpQQVN0\nYXRlTWFuYWdlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwu\nU3RvcmVDb250ZXh0OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5l\nbC5WZXJzaW9uTG9ja01hbmFnZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEubGliLnV0aWwuTG9jYWxpemVyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLnV0aWwuTG9ja0V4Y2VwdGlvbjsKCi8qKgogKiBMb2NrIG1hbmFnZXIg\ndGhhdCB1c2VzIGV4Y2x1c2l2ZSBkYXRhYmFzZSBsb2Nrcy4KICoKICogQGF1\ndGhvciBNYXJjIFBydWQnaG9tbWVhdXgKICovCnB1YmxpYyBjbGFzcyBQZXNz\naW1pc3RpY0xvY2tNYW5hZ2VyCiAgICBleHRlbmRzIFZlcnNpb25Mb2NrTWFu\nYWdlcgogICAgaW1wbGVtZW50cyBKREJDTG9ja01hbmFnZXIgewoKICAgIHB1\nYmxpYyBzdGF0aWMgZmluYWwgaW50IExPQ0tfREFUQVNUT1JFX09OTFkgPSAx\nOwoKICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIExvY2FsaXplciBfbG9jID0g\nTG9jYWxpemVyLmZvclBhY2thZ2UKICAgICAgICAoUGVzc2ltaXN0aWNMb2Nr\nTWFuYWdlci5jbGFzcyk7CgogICAgcHJvdGVjdGVkIEpEQkNTdG9yZSBfc3Rv\ncmU7CgogICAgcHVibGljIFBlc3NpbWlzdGljTG9ja01hbmFnZXIoKSB7CiAg\nICAgICAgc2V0VmVyc2lvbkNoZWNrT25SZWFkTG9jayhmYWxzZSk7CiAgICAg\nICAgc2V0VmVyc2lvblVwZGF0ZU9uV3JpdGVMb2NrKGZhbHNlKTsKICAgIH0K\nCiAgICBwdWJsaWMgdm9pZCBzZXRDb250ZXh0KFN0b3JlQ29udGV4dCBjdHgp\nIHsKICAgICAgICBzdXBlci5zZXRDb250ZXh0KGN0eCk7CiAgICAgICAgX3N0\nb3JlID0gKEpEQkNTdG9yZSkgY3R4LmdldFN0b3JlTWFuYWdlcigpLmdldElu\nbmVybW9zdERlbGVnYXRlKCk7CiAgICB9CgogICAgcHVibGljIGJvb2xlYW4g\nc2VsZWN0Rm9yVXBkYXRlKFNlbGVjdCBzZWwsIGludCBsb2NrTGV2ZWwpIHsK\nICAgICAgICBpZiAobG9ja0xldmVsID09IExPQ0tfTk9ORSkKICAgICAgICAg\nICAgcmV0dXJuIGZhbHNlOwoKICAgICAgICBEQkRpY3Rpb25hcnkgZGljdCA9\nIF9zdG9yZS5nZXREQkRpY3Rpb25hcnkoKTsKICAgICAgICBpZiAoZGljdC5z\naW11bGF0ZUxvY2tpbmcpCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAg\nICAgICBkaWN0LmFzc2VydFN1cHBvcnQoZGljdC5zdXBwb3J0c1NlbGVjdEZv\nclVwZGF0ZSwKICAgICAgICAgICAgIlN1cHBvcnRzU2VsZWN0Rm9yVXBkYXRl\nIik7CgogICAgICAgIGlmICghc2VsLnN1cHBvcnRzTG9ja2luZygpKSB7CiAg\nICAgICAgICAgIGlmIChsb2cuaXNJbmZvRW5hYmxlZCgpKQogICAgICAgICAg\nICAgICAgbG9nLmluZm8oX2xvYy5nZXQoImNhbnQtbG9jay1vbi1sb2FkIiwK\nICAgICAgICAgICAgICAgICAgICBzZWwudG9TZWxlY3QoZmFsc2UsIG51bGwp\nLmdldFNRTCgpKSk7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAg\nICB9CgogICAgICAgIGVuc3VyZVN0b3JlTWFuYWdlclRyYW5zYWN0aW9uKCk7\nCiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgcHVibGljIHZvaWQg\nbG9hZGVkRm9yVXBkYXRlKE9wZW5KUEFTdGF0ZU1hbmFnZXIgc20pIHsKICAg\nICAgICAvLyB3ZSBzZXQgYSBsb3cgbG9jayBsZXZlbCB0byBpbmRpY2F0ZSB0\naGF0IHdlIGRvbid0IG5lZWQgZGF0YXN0b3JlCiAgICAgICAgLy8gbG9ja2lu\nZywgYnV0IHdlIGRvbid0IG5lY2Vzc2FyaWx5IGhhdmUgYSByZWFkIG9yIHdy\naXRlIGxvY2sKICAgICAgICAvLyBhY2NvcmRpbmcgdG8gb3VyIHN1cGVyY2xh\nc3MKICAgICAgICBpZiAoZ2V0TG9ja0xldmVsKHNtKSA9PSBMT0NLX05PTkUp\nCiAgICAgICAgICAgIHNldExvY2tMZXZlbChzbSwgTE9DS19EQVRBU1RPUkVf\nT05MWSk7CiAgICB9CgogICAgcHJvdGVjdGVkIHZvaWQgbG9ja0ludGVybmFs\nKE9wZW5KUEFTdGF0ZU1hbmFnZXIgc20sIGludCBsZXZlbCwgaW50IHRpbWVv\ndXQsCiAgICAgICAgT2JqZWN0IHNkYXRhLCBib29sZWFuIHBvc3RWZXJzaW9u\nQ2hlY2spIHsKICAgICAgICAvLyB3ZSBjYW4gc2tpcCBhbnkgYWxyZWFkeS1s\nb2NrZWQgaW5zdGFuY2UgcmVnYXJkbGVzcyBvZiBsZXZlbCBiZWNhdXNlCiAg\nICAgICAgLy8gd2UgdHJlYXQgYWxsIGxvY2tzIHRoZSBzYW1lICh0aG91Z2gg\nc3VwZXIgZG9lc24ndCkKICAgICAgICBpZiAoZ2V0TG9ja0xldmVsKHNtKSA9\nPSBMT0NLX05PTkUpIHsKICAgICAgICAgICAgLy8gb25seSBuZWVkIHRvIGxv\nY2sgaWYgbm90IGxvYWRlZCBmcm9tIGxvY2tpbmcgcmVzdWx0CiAgICAgICAg\nICAgIENvbm5lY3Rpb25JbmZvIGluZm8gPSAoQ29ubmVjdGlvbkluZm8pIHNk\nYXRhOwogICAgICAgICAgICBpZiAoaW5mbyA9PSBudWxsIHx8IGluZm8ucmVz\ndWx0ID09IG51bGwgfHwgIWluZm8ucmVzdWx0LmlzTG9ja2luZygpKQogICAg\nICAgICAgICAgICAgbG9ja1JvdyhzbSwgdGltZW91dCwgbGV2ZWwpOwogICAg\nICAgIH0KICAgICAgICBvcHRpbWlzdGljTG9ja0ludGVybmFsKHNtLCBsZXZl\nbCwgdGltZW91dCwgc2RhdGEsIHBvc3RWZXJzaW9uQ2hlY2spOwogICAgfQoK\nICAgIC8qKgogICAgICogTG9jayB0aGUgc3BlY2lmaWVkIGluc3RhbmNlIHJv\ndyBieSBpc3N1aW5nIGEgIlNFTEVDVCAuLi4gRk9SIFVQREFURSIKICAgICAq\nIHN0YXRlbWVudC4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIGxvY2tSb3co\nT3BlbkpQQVN0YXRlTWFuYWdlciBzbSwgaW50IHRpbWVvdXQsIGludCBsZXZl\nbCkgewogICAgICAgIC8vIGFzc2VydCB0aGF0IHRoZSBkaWN0aW9uYXJ5IHN1\ncHBvcnRzIHRoZSAiU0VMRUNUIC4uLiBGT1IgVVBEQVRFIgogICAgICAgIC8v\nIGNvbnN0cnVjdDsgaWYgbm90LCBhbmQgd2UgdGhlIGFzc2VydGlvbiBkb2Vz\nIG5vdCB0aHJvdyBhbgogICAgICAgIC8vIGV4Y2VwdGlvbiwgdGhlbiBqdXN0\nIHJldHVybiB3aXRob3V0IGxvY2tpbmcKICAgICAgICBEQkRpY3Rpb25hcnkg\nZGljdCA9IF9zdG9yZS5nZXREQkRpY3Rpb25hcnkoKTsKICAgICAgICBKREJD\nRmV0Y2hDb25maWd1cmF0aW9uIGZldGNoID0gX3N0b3JlLmdldEZldGNoQ29u\nZmlndXJhdGlvbigpOwogICAgICAgIGlmIChkaWN0LnNpbXVsYXRlTG9ja2lu\nZykKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIGRpY3QuYXNzZXJ0U3Vw\ncG9ydChkaWN0LnN1cHBvcnRzU2VsZWN0Rm9yVXBkYXRlLAogICAgICAgICAg\nICAiU3VwcG9ydHNTZWxlY3RGb3JVcGRhdGUiKTsKCiAgICAgICAgT2JqZWN0\nIGlkID0gc20uZ2V0T2JqZWN0SWQoKTsKICAgICAgICBDbGFzc01hcHBpbmcg\nbWFwcGluZyA9IChDbGFzc01hcHBpbmcpIHNtLmdldE1ldGFEYXRhKCk7Cgog\nICAgICAgIExpc3Q8U1FMQnVmZmVyPiBzcWxzID0gZ2V0TG9ja1Jvd3MoZGlj\ndCwgaWQsIG1hcHBpbmcsIGZldGNoLCBfc3RvcmUuZ2V0U1FMRmFjdG9yeSgp\nKTsgCgogICAgICAgIGVuc3VyZVN0b3JlTWFuYWdlclRyYW5zYWN0aW9uKCk7\nCiAgICAgICAgQ29ubmVjdGlvbiBjb25uID0gX3N0b3JlLmdldENvbm5lY3Rp\nb24oKTsKICAgICAgICBQcmVwYXJlZFN0YXRlbWVudCBzdG1udCA9IG51bGw7\nCiAgICAgICAgUmVzdWx0U2V0IHJzID0gbnVsbDsKICAgICAgICB0cnkgewog\nICAgICAgICAgICBmb3IgKFNRTEJ1ZmZlciBzcWwgOiBzcWxzKSB7CiAgICAg\nICAgICAgICAgICBzdG1udCA9IHByZXBhcmVTdGF0ZW1lbnQoY29ubiwgc3Fs\nKTsKICAgICAgICAgICAgICAgIGRpY3Quc2V0VGltZW91dHMoc3RtbnQsIGZl\ndGNoLCB0cnVlKTsKICAgICAgICAgICAgICAgIHJzID0gZXhlY3V0ZVF1ZXJ5\nKGNvbm4sIHN0bW50LCBzcWwpOwogICAgICAgICAgICAgICAgY2hlY2tMb2Nr\nKHJzLCBzbSwgdGltZW91dCk7CiAgICAgICAgICAgIH0KICAgICAgICB9IGNh\ndGNoIChTUUxFeGNlcHRpb24gc2UpIHsKICAgICAgICAgICAgdGhyb3cgU1FM\nRXhjZXB0aW9ucy5nZXRTdG9yZShzZSwgZGljdCwgbGV2ZWwpOwogICAgICAg\nIH0gZmluYWxseSB7CiAgICAgICAgICAgIGlmIChzdG1udCAhPSBudWxsKQog\nICAgICAgICAgICAgICAgdHJ5IHsgc3RtbnQuY2xvc2UoKTsgfSBjYXRjaCAo\nU1FMRXhjZXB0aW9uIHNlKSB7fQogICAgICAgICAgICBpZiAocnMgIT0gbnVs\nbCkKICAgICAgICAgICAgICAgIHRyeSB7IHJzLmNsb3NlKCk7IH0gY2F0Y2gg\nKFNRTEV4Y2VwdGlvbiBzZSkge30KICAgICAgICAgICAgdHJ5IHsgY29ubi5j\nbG9zZSgpOyB9IGNhdGNoIChTUUxFeGNlcHRpb24gc2UpIHt9CiAgICAgICAg\nfQogICAgfQoKICAgIHByb3RlY3RlZCBMaXN0PFNRTEJ1ZmZlcj4gZ2V0TG9j\na1Jvd3MoREJEaWN0aW9uYXJ5IGRpY3QsIE9iamVjdCBpZCwgQ2xhc3NNYXBw\naW5nIG1hcHBpbmcsCiAgICAgICAgICAgIEpEQkNGZXRjaENvbmZpZ3VyYXRp\nb24gZmV0Y2gsIFNRTEZhY3RvcnkgZmFjdG9yeSkgewogICAgICAgIHdoaWxl\nIChtYXBwaW5nLmdldEpvaW5hYmxlUENTdXBlcmNsYXNzTWFwcGluZygpICE9\nIG51bGwpCiAgICAgICAgICAgIG1hcHBpbmcgPSBtYXBwaW5nLmdldEpvaW5h\nYmxlUENTdXBlcmNsYXNzTWFwcGluZygpOwogICAgICAgIC8vIHNlbGVjdCBv\nbmx5IHRoZSBQSyBjb2x1bW5zLCBzaW5jZSB3ZSBqdXN0IHdhbnQgdG8gbG9j\nawogICAgICAgIFNlbGVjdCBzZWxlY3QgPSBmYWN0b3J5Lm5ld1NlbGVjdCgp\nOwogICAgICAgIHNlbGVjdC5zZWxlY3QobWFwcGluZy5nZXRQcmltYXJ5S2V5\nQ29sdW1ucygpKTsKICAgICAgICBzZWxlY3Qud2hlcmVQcmltYXJ5S2V5KGlk\nLCBtYXBwaW5nLCBfc3RvcmUpOwogICAgICAgIExpc3Q8U1FMQnVmZmVyPiBz\ncWxzID0gbmV3IEFycmF5TGlzdDxTUUxCdWZmZXI+KCk7CiAgICAgICAgc3Fs\ncy5hZGQoc2VsZWN0LnRvU2VsZWN0KHRydWUsIGZldGNoKSk7CiAgICAgICAg\ncmV0dXJuIHNxbHM7CiAgICB9CgogICAgLyoqCiAgICAgKiBFbmZvcmNlIHRo\nYXQgd2UgaGF2ZSBhbiBhY3R1YWwgdHJhbnNhY3Rpb24gaW4gcHJvZ3Jlc3Mg\nc28gdGhhdCB3ZSBjYW4KICAgICAqIHN0YXJ0IGxvY2tpbmcuIFRoZSB0cmFu\nc2FjdGlvbiBzaG91bGQgYWxyZWFkeSBiZSBiZWd1biB3aGVuIHVzaW5nIGEK\nICAgICAqIGRhdGFzdG9yZSB0cmFuc2FjdGlvbjsgdGhpcyB3aWxsIGp1c3Qg\nYmUgdXNlZCBpZiB3ZSBhcmUgbG9ja2luZyBpbgogICAgICogb3B0aW1pc3Rp\nYyBtb2RlLgogICAgICovCiAgICBwcml2YXRlIHZvaWQgZW5zdXJlU3RvcmVN\nYW5hZ2VyVHJhbnNhY3Rpb24oKSB7CiAgICAgICAgaWYgKCFfc3RvcmUuZ2V0\nQ29udGV4dCgpLmlzU3RvcmVBY3RpdmUoKSkgewogICAgICAgICAgICBfc3Rv\ncmUuZ2V0Q29udGV4dCgpLmJlZ2luU3RvcmUoKTsKICAgICAgICAgICAgaWYg\nKGxvZy5pc0luZm9FbmFibGVkKCkpCiAgICAgICAgICAgICAgICBsb2cuaW5m\nbyhfbG9jLmdldCgic3RhcnQtdHJhbnMtZm9yLWxvY2siKSk7CiAgICAgICAg\nfQogICAgfQogICAgCiAgICBwdWJsaWMgSkRCQ1N0b3JlIGdldFN0b3JlKCkg\newogICAgICAgIHJldHVybiBfc3RvcmU7CiAgICB9CiAgICAKICAgIC8qKgog\nICAgICogVGhpcyBtZXRob2QgaXMgdG8gcHJvdmlkZSBvdmVycmlkZSBmb3Ig\nbm9uLUpEQkMgb3IgSkRCQy1saWtlIAogICAgICogaW1wbGVtZW50YXRpb24g\nb2YgcHJlcGFyaW5nIHN0YXRlbWVudC4KICAgICAqLwogICAgcHJvdGVjdGVk\nIFByZXBhcmVkU3RhdGVtZW50IHByZXBhcmVTdGF0ZW1lbnQoQ29ubmVjdGlv\nbiBjb25uLCBTUUxCdWZmZXIgc3FsKQogICAgICAgIHRocm93cyBTUUxFeGNl\ncHRpb24gewogICAgICAgIHJldHVybiBzcWwucHJlcGFyZVN0YXRlbWVudChj\nb25uKTsKICAgIH0KICAgIAogICAgLyoqCiAgICAgKiBUaGlzIG1ldGhvZCBp\ncyB0byBwcm92aWRlIG92ZXJyaWRlIGZvciBub24tSkRCQyBvciBKREJDLWxp\na2UgCiAgICAgKiBpbXBsZW1lbnRhdGlvbiBvZiBleGVjdXRpbmcgcXVlcnku\nCiAgICAgKi8KICAgIHByb3RlY3RlZCBSZXN1bHRTZXQgZXhlY3V0ZVF1ZXJ5\nKENvbm5lY3Rpb24gY29ubiwgUHJlcGFyZWRTdGF0ZW1lbnQgc3RtbnQsIAog\nICAgICAgIFNRTEJ1ZmZlciBzcWwpIHRocm93cyBTUUxFeGNlcHRpb24gewog\nICAgICAgIHJldHVybiBzdG1udC5leGVjdXRlUXVlcnkoKTsKICAgIH0KICAg\nIAogICAgLyoqCiAgICAgKiBUaGlzIG1ldGhvZCBpcyB0byBwcm92aWRlIG92\nZXJyaWRlIGZvciBub24tSkRCQyBvciBKREJDLWxpa2UgCiAgICAgKiBpbXBs\nZW1lbnRhdGlvbiBvZiBjaGVja2luZyBsb2NrIGZyb20gdGhlIHJlc3VsdCBz\nZXQuCiAgICAgKi8KICAgIHByb3RlY3RlZCB2b2lkIGNoZWNrTG9jayhSZXN1\nbHRTZXQgcnMsIE9wZW5KUEFTdGF0ZU1hbmFnZXIgc20sIGludCB0aW1lb3V0\nKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24geyAKICAgICAgICBpZiAo\nIXJzLm5leHQoKSkKICAgICAgICAgICAgdGhyb3cgbmV3IExvY2tFeGNlcHRp\nb24oc20uZ2V0TWFuYWdlZEluc3RhbmNlKCksIHRpbWVvdXQpOwogICAgICAg\nIHJldHVybjsKICAgIH0KfQo=\n","encoding":"base64"}

