{"sha":"29b51e48d25864128bfbd0f6437e374174475db4","node_id":"MDQ6QmxvYjIwNjM2NDoyOWI1MWU0OGQyNTg2NDEyOGJmYmQwZjY0MzdlMzc0MTc0NDc1ZGI0","size":11334,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/29b51e48d25864128bfbd0f6437e374174475db4","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5rZXJuZWw7CgppbXBv\ncnQgamF2YS5zcWwuQ29ubmVjdGlvbjsKaW1wb3J0IGphdmEuc3FsLlByZXBh\ncmVkU3RhdGVtZW50OwppbXBvcnQgamF2YS5zcWwuUmVzdWx0U2V0OwppbXBv\ncnQgamF2YS5zcWwuU1FMRXhjZXB0aW9uOwppbXBvcnQgamF2YS5zcWwuU1FM\nV2FybmluZzsKaW1wb3J0IGphdmEudXRpbC5BcnJheUxpc3Q7CmltcG9ydCBq\nYXZhLnV0aWwuQ29sbGVjdGlvbjsKaW1wb3J0IGphdmEudXRpbC5MaW5rZWRM\naXN0OwppbXBvcnQgamF2YS51dGlsLkxpc3Q7CgppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLmpkYmMuY29uZi5KREJDQ29uZmlndXJhdGlvbjsKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLmlkZW50aWZpZXIuREJJZGVudGlm\naWVyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuaWRlbnRpZmll\nci5EQklkZW50aWZpZXIuREJJZGVudGlmaWVyVHlwZTsKaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS5qZGJjLm1ldGEuQ2xhc3NNYXBwaW5nOwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0YS5GaWVsZE1hcHBpbmc7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hlbWEuQ29sdW1uOwpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc3FsLkRCRGljdGlvbmFy\neTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNxbC5Sb3c7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zcWwuUm93SW1wbDsKaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNxbC5TUUxFeGNlcHRpb25z\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5PcGVuSlBBU3Rh\ndGVNYW5hZ2VyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5T\ndGF0ZU1hbmFnZXJJbXBsOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxp\nYi5sb2cuTG9nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51dGls\nLkxvY2FsaXplcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRhLlZh\nbHVlU3RyYXRlZ2llczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGls\nLkFwcGxpY2F0aW9uSWRzOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0\naWwuT3BlbkpQQUV4Y2VwdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUub3Blbmpw\nYS51dGlsLk9wdGltaXN0aWNFeGNlcHRpb247CgovKioKICogQmFzaWMgcHJl\ncGFyZWQgc3RhdGVtZW50IG1hbmFnZXIgaW1wbGVtZW50YXRpb24uCiAqCiAq\nIEBhdXRob3IgQWJlIFdoaXRlCiAqLwpwdWJsaWMgY2xhc3MgUHJlcGFyZWRT\ndGF0ZW1lbnRNYW5hZ2VySW1wbCAKICAgIGltcGxlbWVudHMgUHJlcGFyZWRT\ndGF0ZW1lbnRNYW5hZ2VyIHsKCiAgICBwcml2YXRlIGZpbmFsIHN0YXRpYyBM\nb2NhbGl6ZXIgX2xvYyA9IExvY2FsaXplcgogICAgICAgIC5mb3JQYWNrYWdl\nKFByZXBhcmVkU3RhdGVtZW50TWFuYWdlckltcGwuY2xhc3MpOwoKICAgIHBy\nb3RlY3RlZCBmaW5hbCBKREJDU3RvcmUgX3N0b3JlOwogICAgcHJvdGVjdGVk\nIGZpbmFsIENvbm5lY3Rpb24gX2Nvbm47CiAgICBwcm90ZWN0ZWQgZmluYWwg\nREJEaWN0aW9uYXJ5IF9kaWN0OwogICAgcHJvdGVjdGVkIHRyYW5zaWVudCBM\nb2cgX2xvZyA9IG51bGw7CgogICAgLy8gdHJhY2sgZXhjZXB0aW9ucwogICAg\ncHJvdGVjdGVkIGZpbmFsIENvbGxlY3Rpb24gX2V4Y2VwdGlvbnMgPSBuZXcg\nTGlua2VkTGlzdCgpOwoKICAgIC8qKgogICAgICogQ29uc3RydWN0b3IuIFN1\ncHBseSBjb25uZWN0aW9uLgogICAgICovCiAgICBwdWJsaWMgUHJlcGFyZWRT\ndGF0ZW1lbnRNYW5hZ2VySW1wbChKREJDU3RvcmUgc3RvcmUsIENvbm5lY3Rp\nb24gY29ubikgewogICAgICAgIF9zdG9yZSA9IHN0b3JlOwogICAgICAgIF9k\naWN0ID0gc3RvcmUuZ2V0REJEaWN0aW9uYXJ5KCk7CiAgICAgICAgX2Nvbm4g\nPSBjb25uOwogICAgICAgIGlmIChzdG9yZS5nZXRDb25maWd1cmF0aW9uKCkg\nIT0gbnVsbCkKICAgICAgICAgICAgX2xvZyA9IHN0b3JlLmdldENvbmZpZ3Vy\nYXRpb24oKS5nZXRMb2coSkRCQ0NvbmZpZ3VyYXRpb24uTE9HX0pEQkMpOwog\nICAgfQoKICAgIHB1YmxpYyBDb2xsZWN0aW9uIGdldEV4Y2VwdGlvbnMoKSB7\nCiAgICAgICAgcmV0dXJuIF9leGNlcHRpb25zOwogICAgfQoKICAgIHB1Ymxp\nYyB2b2lkIGZsdXNoKFJvd0ltcGwgcm93KSB7CiAgICAgICAgdHJ5IHsKICAg\nICAgICAgICAgaWYgKCFyb3cuaXNGbHVzaGVkKCkpCiAgICAgICAgICAgICAg\nICBmbHVzaEludGVybmFsKHJvdyk7CiAgICAgICAgfSBjYXRjaCAoU1FMRXhj\nZXB0aW9uIHNlKSB7CiAgICAgICAgICAgIF9leGNlcHRpb25zLmFkZChTUUxF\neGNlcHRpb25zLmdldFN0b3JlKHNlLCBfZGljdCkpOwogICAgICAgIH0gY2F0\nY2ggKE9wZW5KUEFFeGNlcHRpb24ga2UpIHsKICAgICAgICAgICAgX2V4Y2Vw\ndGlvbnMuYWRkKGtlKTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAg\nKiBGbHVzaCB0aGUgZ2l2ZW4gcm93LgogICAgICovCiAgICBwcm90ZWN0ZWQg\ndm9pZCBmbHVzaEludGVybmFsKFJvd0ltcGwgcm93KSB0aHJvd3MgU1FMRXhj\nZXB0aW9uIHsKICAgICAgICBmbHVzaEFuZFVwZGF0ZShyb3cpOwogICAgfQoK\nICAgIC8qKgogICAgICogRmx1c2ggdGhlIGdpdmVuIHJvdyBpbW1lZGlhdGVs\neS4gCiAgICAgKi8KICAgIHByb3RlY3RlZCB2b2lkIGZsdXNoQW5kVXBkYXRl\nKFJvd0ltcGwgcm93KQogICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAg\nICAgQ29sdW1uW10gYXV0b0Fzc2lnbiA9IGdldEF1dG9Bc3NpZ25Db2x1bW5z\nKHJvdyk7CiAgICAgICAgU3RyaW5nW10gYXV0b0Fzc2lnbkNvbE5hbWVzID0g\nZ2V0QXV0b0Fzc2lnbkNvbE5hbWVzKGF1dG9Bc3NpZ24sIHJvdyk7CgogICAg\nICAgIC8vIHByZXBhcmUgc3RhdGVtZW50CiAgICAgICAgU3RyaW5nIHNxbCA9\nIHJvdy5nZXRTUUwoX2RpY3QpOwogICAgICAgIFByZXBhcmVkU3RhdGVtZW50\nIHN0bW50ID0gcHJlcGFyZVN0YXRlbWVudChzcWwsIGF1dG9Bc3NpZ25Db2xO\nYW1lcyk7CgogICAgICAgIC8vIHNldHVwIHBhcmFtZXRlcnMgYW5kIGV4ZWN1\ndGUgc3RhdGVtZW50CiAgICAgICAgaWYgKHN0bW50ICE9IG51bGwpCiAgICAg\nICAgICAgIHJvdy5mbHVzaChzdG1udCwgX2RpY3QsIF9zdG9yZSk7CiAgICAg\nICAgdHJ5IHsKICAgICAgICAgICAgaW50IGNvdW50ID0gZXhlY3V0ZVVwZGF0\nZShzdG1udCwgc3FsLCByb3cpOwogICAgICAgICAgICBpZiAoY291bnQgIT0g\nMSkgewogICAgICAgICAgICAgICAgbG9nU1FMV2FybmluZ3Moc3RtbnQpOwog\nICAgICAgICAgICAgICAgT2JqZWN0IGZhaWxlZCA9IHJvdy5nZXRGYWlsZWRP\nYmplY3QoKTsKICAgICAgICAgICAgICAgIGlmIChmYWlsZWQgIT0gbnVsbCkK\nICAgICAgICAgICAgICAgICAgICBfZXhjZXB0aW9ucy5hZGQobmV3IE9wdGlt\naXN0aWNFeGNlcHRpb24oZmFpbGVkKSk7CiAgICAgICAgICAgICAgICBlbHNl\nIGlmIChyb3cuZ2V0QWN0aW9uKCkgPT0gUm93LkFDVElPTl9JTlNFUlQpCiAg\nICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IFNRTEV4Y2VwdGlvbihfbG9j\nLmdldCgKICAgICAgICAgICAgICAgICAgICAgICAgInVwZGF0ZS1mYWlsZWQt\nbm8tZmFpbGVkLW9iaiIsIFN0cmluZy52YWx1ZU9mKGNvdW50KSwKICAgICAg\nICAgICAgICAgICAgICAgICAgc3FsKS5nZXRNZXNzYWdlKCkpOwogICAgICAg\nICAgICB9CiAgICAgICAgICAgIGlmIChhdXRvQXNzaWduQ29sTmFtZXMgIT0g\nbnVsbCkKICAgICAgICAgICAgICAgIHBvcHVsYXRlQXV0b0Fzc2lnbkNvbHMo\nc3RtbnQsIGF1dG9Bc3NpZ24sIGF1dG9Bc3NpZ25Db2xOYW1lcywKICAgICAg\nICAgICAgICAgICAgICByb3cpOwogICAgICAgICAgICBlbHNlIHsKICAgICAg\nICAgICAgICAgIFN0YXRlTWFuYWdlckltcGwgc20gPSAoU3RhdGVNYW5hZ2Vy\nSW1wbClyb3cuZ2V0UHJpbWFyeUtleSgpOwogICAgICAgICAgICAgICAgaWYg\nKHNtICE9IG51bGwpIHsKICAgICAgICAgICAgICAgICAgICBDbGFzc01hcHBp\nbmcgbWV0YSA9IChDbGFzc01hcHBpbmcpc20uZ2V0TWV0YURhdGEoKTsKICAg\nICAgICAgICAgICAgICAgICBpZiAoaGFzR2VuZXJhdGVkS2V5KG1ldGEpKSB7\nCiAgICAgICAgICAgICAgICAgICAgICAgIHNtLnNldE9iamVjdElkKEFwcGxp\nY2F0aW9uSWRzLmNyZWF0ZSgKICAgICAgICAgICAgICAgICAgICAgICAgICAg\nIHNtLmdldFBlcnNpc3RlbmNlQ2FwYWJsZSgpLCBtZXRhKSk7CiAgICAgICAg\nICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9\nCiAgICAgICAgfSBjYXRjaCAoU1FMRXhjZXB0aW9uIHNlKSB7CiAgICAgICAg\nICAgIHRocm93IFNRTEV4Y2VwdGlvbnMuZ2V0U3RvcmUoc2UsIHJvdy5nZXRG\nYWlsZWRPYmplY3QoKSwgX2RpY3QpOwogICAgICAgIH0gZmluYWxseSB7CiAg\nICAgICAgICAgIGlmIChzdG1udCAhPSBudWxsKSB7CiAgICAgICAgICAgICAg\nICB0cnkgewogICAgICAgICAgICAgICAgICAgIHN0bW50LmNsb3NlKCk7CiAg\nICAgICAgICAgICAgICB9IGNhdGNoIChTUUxFeGNlcHRpb24gc2UpIHsKICAg\nICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0K\nICAgIAogICAgcHJpdmF0ZSBib29sZWFuIGhhc0dlbmVyYXRlZEtleShDbGFz\nc01hcHBpbmcgbWV0YSkgewogICAgICAgIEZpZWxkTWFwcGluZ1tdIHBrcyA9\nIG1ldGEuZ2V0UHJpbWFyeUtleUZpZWxkTWFwcGluZ3MoKTsKICAgICAgICBm\nb3IgKGludCBpID0gMDsgaSA8IHBrcy5sZW5ndGg7IGkrKykgewogICAgICAg\nICAgICBDbGFzc01hcHBpbmcgcGtNZXRhID0gcGtzW2ldLmdldFR5cGVNYXBw\naW5nKCk7IAogICAgICAgICAgICBpZiAocGtNZXRhICE9IG51bGwpIHsKICAg\nICAgICAgICAgICAgIHJldHVybiBoYXNHZW5lcmF0ZWRLZXkocGtNZXRhKTsK\nICAgICAgICAgICAgfSBlbHNlIGlmIChwa3NbaV0uZ2V0VmFsdWVTdHJhdGVn\neSgpID09IFZhbHVlU3RyYXRlZ2llcy5BVVRPQVNTSUdOKQogICAgICAgICAg\nICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQogICAgICAgIHJldHVybiBm\nYWxzZTsKICAgIH0KCiAgICAvKiogCiAgICAgKiBUaGlzIG1ldGhvZCB3aWxs\nIG9ubHkgYmUgY2FsbGVkIHdoZW4gdGhlcmUgaXMgYXV0byBhc3NpZ24gY29s\ndW1ucy4KICAgICAqIElmIGRhdGFiYXNlIHN1cHBvcnRzIGdldEdlbmVyYXRl\nZEtleXMsIHRoZSBrZXlzIHdpbGwgYmUgb2J0YWluZWQKICAgICAqIGZyb20g\ndGhlIHJlc3VsdCBzZXQgYXNzb2NpYXRlZCB3aXRoIHRoZSBzdG1udC4gSWYg\nbm90LCBhIHNlcGFyYXRlIAogICAgICogc3FsIHRvIHNlbGVjdCB0aGUga2V5\nIHdpbGwgYmUgaXNzdWVkIGZyb20gREJEaWN0aW9uYXJ5LiAKICAgICAqLwog\nICAgcHJvdGVjdGVkIExpc3Q8T2JqZWN0PiBwb3B1bGF0ZUF1dG9Bc3NpZ25D\nb2xzKFByZXBhcmVkU3RhdGVtZW50IHN0bW50LCAKICAgICAgICBDb2x1bW5b\nXSBhdXRvQXNzaWduLCBEQklkZW50aWZpZXJbXSBhdXRvQXNzaWduQ29sTmFt\nZXMsIFJvd0ltcGwgcm93KSAKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9u\nIHsKICAgICAgICBMaXN0PE9iamVjdD4gdmFscyA9IG51bGw7CiAgICAgICAg\naWYgKF9kaWN0LnN1cHBvcnRzR2V0R2VuZXJhdGVkS2V5cykgewogICAgICAg\nICAgICAvLyBzZXQgYXV0byBhc3NpZ24gdmFsdWVzIHRvIGlkIGNvbAogICAg\nICAgICAgICB2YWxzID0gZ2V0R2VuZXJhdGVkS2V5cyhzdG1udCwgYXV0b0Fz\nc2lnbkNvbE5hbWVzKTsKICAgICAgICB9CiAgICAgICAgc2V0T2JqZWN0SWQo\ndmFscywgYXV0b0Fzc2lnbiwgYXV0b0Fzc2lnbkNvbE5hbWVzLCByb3cpOwog\nICAgICAgIHJldHVybiB2YWxzOwogICAgfQoKICAgIHByb3RlY3RlZCBMaXN0\nPE9iamVjdD4gcG9wdWxhdGVBdXRvQXNzaWduQ29scyhQcmVwYXJlZFN0YXRl\nbWVudCBzdG1udCwgCiAgICAgICAgQ29sdW1uW10gYXV0b0Fzc2lnbiwgU3Ry\naW5nW10gYXV0b0Fzc2lnbkNvbE5hbWVzLCBSb3dJbXBsIHJvdykgCiAgICAg\nICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgcmV0dXJuIHBvcHVs\nYXRlQXV0b0Fzc2lnbkNvbHMoc3RtbnQsIGF1dG9Bc3NpZ24sIAogICAgICAg\nICAgICBEQklkZW50aWZpZXIudG9BcnJheShhdXRvQXNzaWduQ29sTmFtZXMs\nIERCSWRlbnRpZmllclR5cGUuQ09MVU1OKSwgcm93KTsKICAgIH0KICAgIAog\nICAgcHJvdGVjdGVkIHZvaWQgc2V0T2JqZWN0SWQoTGlzdCB2YWxzLCBDb2x1\nbW5bXSBhdXRvQXNzaWduLAogICAgICAgIFN0cmluZ1tdIGF1dG9Bc3NpZ25D\nb2xOYW1lcywgUm93SW1wbCByb3cpIAogICAgICAgIHRocm93cyBTUUxFeGNl\ncHRpb257CiAgICAgICAgc2V0T2JqZWN0SWQodmFscywgYXV0b0Fzc2lnbiwg\nREJJZGVudGlmaWVyLnRvQXJyYXkoYXV0b0Fzc2lnbkNvbE5hbWVzLCBEQklk\nZW50aWZpZXJUeXBlLkNPTFVNTiksIHJvdyk7CiAgICB9CiAgICAKICAgIHBy\nb3RlY3RlZCB2b2lkIHNldE9iamVjdElkKExpc3QgdmFscywgQ29sdW1uW10g\nYXV0b0Fzc2lnbiwKICAgICAgICBEQklkZW50aWZpZXJbXSBhdXRvQXNzaWdu\nQ29sTmFtZXMsIFJvd0ltcGwgcm93KSAKICAgICAgICB0aHJvd3MgU1FMRXhj\nZXB0aW9uewogICAgICAgIE9wZW5KUEFTdGF0ZU1hbmFnZXIgc20gPSByb3cu\nZ2V0UHJpbWFyeUtleSgpOwogICAgICAgIENsYXNzTWFwcGluZyBtYXBwaW5n\nID0gKENsYXNzTWFwcGluZykgc20uZ2V0TWV0YURhdGEoKTsKICAgICAgICBP\nYmplY3QgdmFsID0gbnVsbDsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8\nIGF1dG9Bc3NpZ24ubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgaWYgKF9k\naWN0LnN1cHBvcnRzR2V0R2VuZXJhdGVkS2V5cyAmJiB2YWxzICE9IG51bGwg\nJiYgCiAgICAgICAgICAgICAgICB2YWxzLnNpemUoKSA+IDApCiAgICAgICAg\nICAgICAgICB2YWwgPSB2YWxzLmdldChpKTsKICAgICAgICAgICAgZWxzZQog\nICAgICAgICAgICAgICAgdmFsID0gX2RpY3QuZ2V0R2VuZXJhdGVkS2V5KGF1\ndG9Bc3NpZ25baV0sIF9jb25uKTsKICAgICAgICAgICAgbWFwcGluZy5hc3Nl\ncnRKb2luYWJsZShhdXRvQXNzaWduW2ldKS5zZXRBdXRvQXNzaWduZWRWYWx1\nZShzbSwKICAgICAgICAgICAgICAgIF9zdG9yZSwgYXV0b0Fzc2lnbltpXSwg\ndmFsKTsKICAgICAgICB9CiAgICAgICAgc20uc2V0T2JqZWN0SWQoCiAgICAg\nICAgICAgIEFwcGxpY2F0aW9uSWRzLmNyZWF0ZShzbS5nZXRQZXJzaXN0ZW5j\nZUNhcGFibGUoKSwgbWFwcGluZykpOwogICAgfQoKICAgIC8qKgogICAgICog\nVGhpcyBtZXRob2Qgd2lsbCBvbmx5IGJlIGNhbGxlZCB3aGVuIHRoZSBkYXRh\nYmFzZSBzdXBwb3J0cwogICAgICogZ2V0R2VuZXJhdGVkS2V5cy4KICAgICAq\nLwogICAgcHJvdGVjdGVkIExpc3Q8T2JqZWN0PiBnZXRHZW5lcmF0ZWRLZXlz\nKFByZXBhcmVkU3RhdGVtZW50IHN0bW50LCAKICAgICAgICBTdHJpbmdbXSBh\ndXRvQXNzaWduQ29sTmFtZXMpIAogICAgICAgIHRocm93cyBTUUxFeGNlcHRp\nb24gewogICAgICAgIHJldHVybiBnZXRHZW5lcmF0ZWRLZXlzKHN0bW50LCBE\nQklkZW50aWZpZXIudG9BcnJheShhdXRvQXNzaWduQ29sTmFtZXMsIERCSWRl\nbnRpZmllclR5cGUuQ09MVU1OKSk7CiAgICB9CgogICAgcHJvdGVjdGVkIExp\nc3Q8T2JqZWN0PiBnZXRHZW5lcmF0ZWRLZXlzKFByZXBhcmVkU3RhdGVtZW50\nIHN0bW50LCAKICAgICAgICBEQklkZW50aWZpZXJbXSBhdXRvQXNzaWduQ29s\nTmFtZXMpIAogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAg\nIFJlc3VsdFNldCBycyA9IHN0bW50LmdldEdlbmVyYXRlZEtleXMoKTsKICAg\nICAgICBMaXN0PE9iamVjdD4gdmFscyA9IG5ldyBBcnJheUxpc3Q8T2JqZWN0\nPigpOwogICAgICAgIHdoaWxlIChycy5uZXh0KCkpIHsKICAgICAgICAgICAg\nZm9yIChpbnQgaSA9IDA7IGkgPCBhdXRvQXNzaWduQ29sTmFtZXMubGVuZ3Ro\nOyBpKyspCiAgICAgICAgICAgICAgICB2YWxzLmFkZChycy5nZXRPYmplY3Qo\naSArIDEpKTsKICAgICAgICB9CiAgICAgICAgcnMuY2xvc2UoKTsKICAgICAg\nICByZXR1cm4gdmFsczsKICAgIH0KCiAgICBwcm90ZWN0ZWQgQ29sdW1uW10g\nZ2V0QXV0b0Fzc2lnbkNvbHVtbnMoUm93SW1wbCByb3cpIHsKICAgICAgICBD\nb2x1bW5bXSBhdXRvQXNzaWduID0gbnVsbDsKICAgICAgICBpZiAocm93Lmdl\ndEFjdGlvbigpID09IFJvdy5BQ1RJT05fSU5TRVJUKQogICAgICAgICAgICBh\ndXRvQXNzaWduID0gcm93LmdldFRhYmxlKCkuZ2V0QXV0b0Fzc2lnbmVkQ29s\ndW1ucygpOwogICAgICAgIHJldHVybiBhdXRvQXNzaWduOwogICAgfQoKICAg\nIHByb3RlY3RlZCBTdHJpbmdbXSBnZXRBdXRvQXNzaWduQ29sTmFtZXMoQ29s\ndW1uW10gYXV0b0Fzc2lnbiwgUm93SW1wbCByb3cpIHsKICAgICAgICBTdHJp\nbmdbXSBhdXRvQXNzaWduQ29sTmFtZXMgPSBudWxsOwogICAgICAgIGlmIChh\ndXRvQXNzaWduICE9IG51bGwgJiYgYXV0b0Fzc2lnbi5sZW5ndGggPiAwCiAg\nICAgICAgICAgICYmIHJvdy5nZXRQcmltYXJ5S2V5KCkgIT0gbnVsbCkgewog\nICAgICAgICAgICBhdXRvQXNzaWduQ29sTmFtZXMgPSBuZXcgU3RyaW5nW2F1\ndG9Bc3NpZ24ubGVuZ3RoXTsKICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7\nIGkgPCBhdXRvQXNzaWduLmxlbmd0aDsgaSsrKQogICAgICAgICAgICAgICAg\nYXV0b0Fzc2lnbkNvbE5hbWVzW2ldID0KICAgICAgICAgICAgICAgICAgICBf\nZGljdC5jb252ZXJ0U2NoZW1hQ2FzZShhdXRvQXNzaWduW2ldLmdldElkZW50\naWZpZXIoKSk7CiAgICAgICAgfQogICAgICAgIHJldHVybiBhdXRvQXNzaWdu\nQ29sTmFtZXM7CiAgICB9CgogICAgcHVibGljIHZvaWQgZmx1c2goKSB7CiAg\nICB9CiAgICAKICAgIC8qKgogICAgICogVGhpcyBtZXRob2QgaXMgdG8gcHJv\ndmlkZSBvdmVycmlkZSBmb3Igbm9uLUpEQkMgb3IgSkRCQy1saWtlIAogICAg\nICogaW1wbGVtZW50YXRpb24gb2YgZXhlY3V0aW5nIHVwZGF0ZS4KICAgICAq\nLwogICAgcHJvdGVjdGVkIGludCBleGVjdXRlVXBkYXRlKFByZXBhcmVkU3Rh\ndGVtZW50IHN0bW50LCBTdHJpbmcgc3FsLCAKICAgICAgICBSb3dJbXBsIHJv\ndykgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgcmV0dXJuIHN0bW50\nLmV4ZWN1dGVVcGRhdGUoKTsKICAgIH0KCiAgICAvKioKICAgICAqIFRoaXMg\nbWV0aG9kIGlzIHRvIHByb3ZpZGUgb3ZlcnJpZGUgZm9yIG5vbi1KREJDIG9y\nIEpEQkMtbGlrZSAKICAgICAqIGltcGxlbWVudGF0aW9uIG9mIHByZXBhcmlu\nZyBzdGF0ZW1lbnQuCiAgICAgKi8KICAgIHByb3RlY3RlZCBQcmVwYXJlZFN0\nYXRlbWVudCBwcmVwYXJlU3RhdGVtZW50KFN0cmluZyBzcWwpIAogICAgICAg\nIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIHJldHVybiBwcmVwYXJl\nU3RhdGVtZW50KHNxbCwgbnVsbCk7CiAgICB9ICAgIAogICAgLyoqCiAgICAg\nKiBUaGlzIG1ldGhvZCBpcyB0byBwcm92aWRlIG92ZXJyaWRlIGZvciBub24t\nSkRCQyBvciBKREJDLWxpa2UgCiAgICAgKiBpbXBsZW1lbnRhdGlvbiBvZiBw\ncmVwYXJpbmcgc3RhdGVtZW50LgogICAgICovCiAgICBwcm90ZWN0ZWQgUHJl\ncGFyZWRTdGF0ZW1lbnQgcHJlcGFyZVN0YXRlbWVudChTdHJpbmcgc3FsLCAK\nICAgICAgICBTdHJpbmdbXSBhdXRvQXNzaWduQ29sTmFtZXMpCiAgICAgICAg\ndGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgLy8gcGFzcyBpbiBBdXRv\nQXNzaWduQ29sdW1uIG5hbWVzCiAgICAgICAgaWYgKGF1dG9Bc3NpZ25Db2xO\nYW1lcyAhPSBudWxsICYmIF9kaWN0LnN1cHBvcnRzR2V0R2VuZXJhdGVkS2V5\ncykgCiAgICAgICAgICAgIHJldHVybiBfY29ubi5wcmVwYXJlU3RhdGVtZW50\nKHNxbCwgYXV0b0Fzc2lnbkNvbE5hbWVzKTsKICAgICAgICBlbHNlCiAgICAg\nICAgICAgIHJldHVybiBfY29ubi5wcmVwYXJlU3RhdGVtZW50KHNxbCk7CiAg\nICB9CiAgICAKICAgIC8qKgogICAgICogUHJvdmlkZWQgdGhlIEpEQkMgbG9n\nIGNhdGVnb3J5IGlzIGxvZ2dpbmcgd2FybmluZ3MsIHRoaXMgbWV0aG9kIHdp\nbGwgCiAgICAgKiBsb2cgYW55IFNRTCB3YXJuaW5ncyB0aGF0IHJlc3VsdCBm\ncm9tIHRoZSBleGVjdXRpb24gb2YgYSBTUUwgc3RhdGVtZW50LiAKICAgICAq\nLwogICAgcHJvdGVjdGVkIHZvaWQgbG9nU1FMV2FybmluZ3MoUHJlcGFyZWRT\ndGF0ZW1lbnQgc3RtdCkgewogICAgICAgIGlmIChzdG10ICE9IG51bGwgJiYg\nX2xvZyAhPSBudWxsICYmIF9sb2cuaXNUcmFjZUVuYWJsZWQoKSkgewogICAg\nICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgU1FMV2FybmluZyB3YXJu\nID0gc3RtdC5nZXRXYXJuaW5ncygpOwogICAgICAgICAgICAgICAgd2hpbGUg\nKHdhcm4gIT0gbnVsbCkgewogICAgICAgICAgICAgICAgICAgIF9sb2cudHJh\nY2UoX2xvYy5nZXQoInNxbC13YXJuaW5nIiwgd2Fybi5nZXRNZXNzYWdlKCkp\nKTsKICAgICAgICAgICAgICAgICAgICB3YXJuID0gd2Fybi5nZXROZXh0V2Fy\nbmluZygpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGNhdGNo\nIChTUUxFeGNlcHRpb24gZSkge30KICAgICAgICB9CiAgICB9Cn0K\n","encoding":"base64"}

