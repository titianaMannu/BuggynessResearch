{"sha":"fe12a3492b0cd6be33b2178346b7046c8c288366","node_id":"MDQ6QmxvYjIwNjM2NDpmZTEyYTM0OTJiMGNkNmJlMzNiMjE3ODM0NmI3MDQ2YzhjMjg4MzY2","size":37817,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/fe12a3492b0cd6be33b2178346b7046c8c288366","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhOwoKaW1wb3J0\nIGphdmEuc3FsLlNRTEV4Y2VwdGlvbjsKaW1wb3J0IGphdmEudXRpbC5BcnJh\neUxpc3Q7CmltcG9ydCBqYXZhLnV0aWwuQXJyYXlzOwppbXBvcnQgamF2YS51\ndGlsLkNvbGxlY3Rpb247CmltcG9ydCBqYXZhLnV0aWwuSXRlcmF0b3I7Cmlt\ncG9ydCBqYXZhLnV0aWwuTGlua2VkSGFzaFNldDsKaW1wb3J0IGphdmEudXRp\nbC5MaXN0OwppbXBvcnQgamF2YS51dGlsLk1hcDsKaW1wb3J0IGphdmEudXRp\nbC5TZXQ7CmltcG9ydCBqYXZhLnV0aWwuY29uY3VycmVudC5Db25jdXJyZW50\nSGFzaE1hcDsKCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuZW5oYW5jZS5Q\nZXJzaXN0ZW5jZUNhcGFibGU7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\nZW5oYW5jZS5SZWZsZWN0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLmpkYmMua2VybmVsLkpEQkNGZXRjaENvbmZpZ3VyYXRpb247CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEuamRiYy5rZXJuZWwuSkRCQ1N0b3JlOwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0YS5zdHJhdHMuTm9uZUNs\nYXNzU3RyYXRlZ3k7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5z\nY2hlbWEuQ29sdW1uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMu\nc2NoZW1hLkNvbHVtbklPOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpk\nYmMuc2NoZW1hLkZvcmVpZ25LZXk7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEuamRiYy5zY2hlbWEuU2NoZW1hczsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5qZGJjLnNjaGVtYS5UYWJsZTsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5qZGJjLnNxbC5Kb2luczsKaW1wb3J0IG9yZy5hcGFjaGUub3Blbmpw\nYS5qZGJjLnNxbC5SZXN1bHQ7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\namRiYy5zcWwuUm93TWFuYWdlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3Blbmpw\nYS5qZGJjLnNxbC5TZWxlY3Q7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\na2VybmVsLkZldGNoQ29uZmlndXJhdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS5rZXJuZWwuT3BlbkpQQVN0YXRlTWFuYWdlcjsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuUENTdGF0ZTsKaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS5saWIubG9nLkxvZzsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS5saWIucm9wLlJlc3VsdE9iamVjdFByb3ZpZGVyOwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51dGlsLkxvY2FsaXplcjsKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5tZXRhLkNsYXNzTWV0YURhdGE7CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YS5WYWx1ZU1ldGFEYXRhOwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuQXBwbGljYXRpb25JZHM7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5JbXBsSGVscGVyOwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuSW50ZXJuYWxFeGNlcHRpb247\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5NZXRhRGF0YUV4Y2Vw\ndGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLk9wZW5KUEFJ\nZDsKCi8qKgogKiBTcGVjaWFsaXphdGlvbiBvZiBtZXRhZGF0YSBmb3IgcmVs\nYXRpb25hbCBkYXRhYmFzZXMuCiAqCiAqIEBhdXRob3IgQWJlIFdoaXRlCiAq\nLwpwdWJsaWMgY2xhc3MgQ2xhc3NNYXBwaW5nCiAgICBleHRlbmRzIENsYXNz\nTWV0YURhdGEKICAgIGltcGxlbWVudHMgQ2xhc3NTdHJhdGVneSB7CgogICAg\ncHVibGljIHN0YXRpYyBmaW5hbCBDbGFzc01hcHBpbmdbXSBFTVBUWV9NQVBQ\nSU5HUyA9IG5ldyBDbGFzc01hcHBpbmdbMF07CgogICAgcHJpdmF0ZSBzdGF0\naWMgZmluYWwgTG9jYWxpemVyIF9sb2MgPSBMb2NhbGl6ZXIuZm9yUGFja2Fn\nZQogICAgICAgIChDbGFzc01hcHBpbmcuY2xhc3MpOwoKICAgIHByaXZhdGUg\nZmluYWwgQ2xhc3NNYXBwaW5nSW5mbyBfaW5mbzsKICAgIHByaXZhdGUgZmlu\nYWwgRGlzY3JpbWluYXRvciBfZGlzY3JpbTsKICAgIHByaXZhdGUgZmluYWwg\nVmVyc2lvbiBfdmVyc2lvbjsKICAgIHByaXZhdGUgQ2xhc3NTdHJhdGVneSBf\nc3RyYXRlZ3kgPSBudWxsOwoKICAgIHByaXZhdGUgVGFibGUgX3RhYmxlID0g\nbnVsbDsKICAgIHByaXZhdGUgQ29sdW1uSU8gX2lvID0gbnVsbDsKICAgIHBy\naXZhdGUgQ29sdW1uW10gX2NvbHMgPSBTY2hlbWFzLkVNUFRZX0NPTFVNTlM7\nCiAgICBwcml2YXRlIEZvcmVpZ25LZXkgX2ZrID0gbnVsbDsKICAgIHByaXZh\ndGUgaW50IF9zdWJjbGFzc01vZGUgPSBJbnRlZ2VyLk1BWF9WQUxVRTsKCiAg\nICBwcml2YXRlIENsYXNzTWFwcGluZ1tdIF9qb2luU3ViTWFwcyA9IG51bGw7\nCiAgICBwcml2YXRlIENsYXNzTWFwcGluZ1tdIF9hc3NpZ25NYXBzID0gbnVs\nbDsKCiAgICAvLyBtYXBzIGNvbHVtbnMgdG8gam9pbmFibGVzCiAgICBwcml2\nYXRlIGZpbmFsIE1hcCBfam9pbmFibGVzID0gbmV3IENvbmN1cnJlbnRIYXNo\nTWFwKCk7CgogICAgLyoqCiAgICAgKiBDb25zdHJ1Y3Rvci4gU3VwcGx5IGRl\nc2NyaWJlZCB0eXBlIGFuZCBvd25pbmcgcmVwb3NpdG9yeS4KICAgICAqLwog\nICAgcHJvdGVjdGVkIENsYXNzTWFwcGluZyhDbGFzcyB0eXBlLCBNYXBwaW5n\nUmVwb3NpdG9yeSByZXBvcykgewogICAgICAgIHN1cGVyKHR5cGUsIHJlcG9z\nKTsKICAgICAgICBfZGlzY3JpbSA9IHJlcG9zLm5ld0Rpc2NyaW1pbmF0b3Io\ndGhpcyk7CiAgICAgICAgX3ZlcnNpb24gPSByZXBvcy5uZXdWZXJzaW9uKHRo\naXMpOwogICAgICAgIF9pbmZvID0gcmVwb3MubmV3TWFwcGluZ0luZm8odGhp\ncyk7CiAgICB9CgogICAgLyoqCiAgICAgKiBFbWJlZGRlZCBjb25zdHJ1Y3Rv\nci4gU3VwcGx5IGVtYmVkZGluZyB2YWx1ZSBhbmQgb3duaW5nIHJlcG9zaXRv\ncnkuCiAgICAgKi8KICAgIHByb3RlY3RlZCBDbGFzc01hcHBpbmcoVmFsdWVN\nZXRhRGF0YSB2bWQpIHsKICAgICAgICBzdXBlcih2bWQpOwogICAgICAgIF9k\naXNjcmltID0gZ2V0TWFwcGluZ1JlcG9zaXRvcnkoKS5uZXdEaXNjcmltaW5h\ndG9yKHRoaXMpOwogICAgICAgIF92ZXJzaW9uID0gZ2V0TWFwcGluZ1JlcG9z\naXRvcnkoKS5uZXdWZXJzaW9uKHRoaXMpOwogICAgICAgIF9pbmZvID0gZ2V0\nTWFwcGluZ1JlcG9zaXRvcnkoKS5uZXdNYXBwaW5nSW5mbyh0aGlzKTsKICAg\nIH0KCiAgICAvKioKICAgICAqIFRoZSBjbGFzcyBkaXNjcmltaW5hdG9yLgog\nICAgICovCiAgICBwdWJsaWMgRGlzY3JpbWluYXRvciBnZXREaXNjcmltaW5h\ndG9yKCkgewogICAgICAgIHJldHVybiBfZGlzY3JpbTsKICAgIH0KCiAgICAv\nKioKICAgICAqIFRoZSB2ZXJzaW9uIGluZGljYXRvci4KICAgICAqLwogICAg\ncHVibGljIFZlcnNpb24gZ2V0VmVyc2lvbigpIHsKICAgICAgICByZXR1cm4g\nX3ZlcnNpb247CiAgICB9CgogICAgLy8vLy8vLy8vLy8KICAgIC8vIFJ1bnRp\nbWUKICAgIC8vLy8vLy8vLy8vCgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhl\nIG9pZCB2YWx1ZSBzdG9yZWQgaW4gdGhlIHJlc3VsdC4gVGhpcyBpbXBsZW1l\nbnRhdGlvbiB3aWxsCiAgICAgKiByZWN1cnNlIHVudGlsIGl0IGZpbmRzIGFu\nIGFuY2VzdG9yIGNsYXNzIHdobyB1c2VzIG9pZCB2YWx1ZXMgZm9yIGl0cwog\nICAgICogcHJpbWFyeSBrZXkuCiAgICAgKgogICAgICogQHBhcmFtIGZrIGlm\nIG5vbi1udWxsLCB1c2UgdGhlIGxvY2FsIGNvbHVtbnMgb2YgdGhlIGdpdmVu\nIGZvcmVpZ24KICAgICAqIGtleSBpbiBwbGFjZSBvZiB0aGlzIGNsYXNzJyBw\ncmltYXJ5IGtleSBjb2x1bW5zCiAgICAgKiBAc2VlICNpc1ByaW1hcnlLZXlP\nYmplY3RJZAogICAgICovCiAgICBwdWJsaWMgT2JqZWN0IGdldE9iamVjdElk\nKEpEQkNTdG9yZSBzdG9yZSwgUmVzdWx0IHJlcywgRm9yZWlnbktleSBmaywK\nICAgICAgICBib29sZWFuIHN1YnMsIEpvaW5zIGpvaW5zKQogICAgICAgIHRo\ncm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIFZhbHVlTWFwcGluZyBlbWJl\nZCA9IGdldEVtYmVkZGluZ01hcHBpbmcoKTsKICAgICAgICBpZiAoZW1iZWQg\nIT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIGVtYmVkLmdldEZpZWxkTWFw\ncGluZygpLmdldERlZmluaW5nTWFwcGluZygpLgogICAgICAgICAgICAgICAg\nZ2V0T2JqZWN0SWQoc3RvcmUsIHJlcywgZmssIHN1YnMsIGpvaW5zKTsKCiAg\nICAgICAgcmV0dXJuIGdldE9iamVjdElkKHRoaXMsIHN0b3JlLCByZXMsIGZr\nLCBzdWJzLCBqb2lucyk7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZWN1cnNp\ndmUgaGVscGVyIGZvciBwdWJsaWMgPGNvZGU+Z2V0T2JqZWN0SWQ8L2NvZGU+\nIG1ldGhvZC4KICAgICAqLwogICAgcHJpdmF0ZSBPYmplY3QgZ2V0T2JqZWN0\nSWQoQ2xhc3NNYXBwaW5nIGNscywgSkRCQ1N0b3JlIHN0b3JlLCBSZXN1bHQg\ncmVzLAogICAgICAgIEZvcmVpZ25LZXkgZmssIGJvb2xlYW4gc3VicywgSm9p\nbnMgam9pbnMpCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAg\nICAgaWYgKCFpc1ByaW1hcnlLZXlPYmplY3RJZCh0cnVlKSkKICAgICAgICAg\nICAgcmV0dXJuIGdldFBDU3VwZXJjbGFzc01hcHBpbmcoKS5nZXRPYmplY3RJ\nZChjbHMsIHN0b3JlLCByZXMsIGZrLAogICAgICAgICAgICAgICAgc3Vicywg\nam9pbnMpOwogICAgICAgIGlmIChnZXRJZGVudGl0eVR5cGUoKSA9PSBJRF9V\nTktOT1dOKQogICAgICAgICAgICB0aHJvdyBuZXcgSW50ZXJuYWxFeGNlcHRp\nb24oKTsKCiAgICAgICAgQ29sdW1uW10gcGtzID0gZ2V0UHJpbWFyeUtleUNv\nbHVtbnMoKTsKICAgICAgICBpZiAoZ2V0SWRlbnRpdHlUeXBlKCkgPT0gSURf\nREFUQVNUT1JFKSB7CiAgICAgICAgICAgIENvbHVtbiBjb2wgPSAoZmsgPT0g\nbnVsbCkgPyBwa3NbMF0gOiBmay5nZXRDb2x1bW4ocGtzWzBdKTsKICAgICAg\nICAgICAgbG9uZyBpZCA9IHJlcy5nZXRMb25nKGNvbCwgam9pbnMpOwogICAg\nICAgICAgICByZXR1cm4gKGlkID09IDAgJiYgcmVzLndhc051bGwoKSkgPyBu\ndWxsCiAgICAgICAgICAgICAgICA6IHN0b3JlLm5ld0RhdGFTdG9yZUlkKGlk\nLCBjbHMsIHN1YnMpOwogICAgICAgIH0KCiAgICAgICAgLy8gYXBwbGljYXRp\nb24gaWRlbnRpdHkKICAgICAgICBPYmplY3RbXSB2YWxzID0gbmV3IE9iamVj\ndFtnZXRQcmltYXJ5S2V5RmllbGRzKCkubGVuZ3RoXTsKICAgICAgICBGaWVs\nZE1hcHBpbmcgZm07CiAgICAgICAgSm9pbmFibGUgam9pbjsKICAgICAgICBp\nbnQgcGtJZHg7CiAgICAgICAgYm9vbGVhbiBjYW5SZWFkRGlzY3JpbWluYXRv\nciA9IHRydWU7CiAgICAgICAgYm9vbGVhbiBpc051bGxQSyA9IHRydWU7CiAg\nICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBwa3MubGVuZ3RoOyBpKyspIHsK\nICAgICAgICAgICAgLy8gd2Uga25vdyB0aGF0IGFsbCBwayBjb2x1bW4gam9p\nbiBtYXBwaW5ncyB1c2UgcHJpbWFyeSBrZXkgZmllbGRzLAogICAgICAgICAg\nICAvLyBjYXVzZSB0aGlzIG1hcHBpbmcgdXNlcyB0aGUgb2lkIGFzIGl0cyBw\ncmltYXJ5IGtleSAod2UgcmVjdXJzZWQKICAgICAgICAgICAgLy8gYXQgdGhl\nIGJlZ2lubmluZyBvZiB0aGUgbWV0aG9kIHRvIGVuc3VyZSB0aGlzKQogICAg\nICAgICAgICBqb2luID0gYXNzZXJ0Sm9pbmFibGUocGtzW2ldKTsKICAgICAg\nICAgICAgZm0gPSBnZXRGaWVsZE1hcHBpbmcoam9pbi5nZXRGaWVsZEluZGV4\nKCkpOwogICAgICAgICAgICBwa0lkeCA9IGZtLmdldFByaW1hcnlLZXlJbmRl\neCgpOwogICAgICAgICAgICBjYW5SZWFkRGlzY3JpbWluYXRvciAmPSBpc1Nl\nbGZSZWZlcmVuY2UoZmssIGpvaW4uZ2V0Q29sdW1ucygpKTsgCiAgICAgICAg\nICAgIC8vIGNvdWxkIGhhdmUgYWxyZWFkeSBzZXQgdmFsdWUgd2l0aCBwcmV2\naW91cyBtdWx0aS1jb2x1bW4gam9pbmFibGUKICAgICAgICAgICAgaWYgKHZh\nbHNbcGtJZHhdID09IG51bGwpIHsKICAgICAgICAgICAgICAgIHJlcy5zdGFy\ndERhdGFSZXF1ZXN0KGZtKTsKICAgICAgICAgICAgICAgIHZhbHNbcGtJZHhd\nID0gam9pbi5nZXRQcmltYXJ5S2V5VmFsdWUocmVzLCBqb2luLmdldENvbHVt\nbnMoKSwKICAgICAgICAgICAgICAgICAgICBmaywgc3RvcmUsIGpvaW5zKTsK\nICAgICAgICAgICAgICAgIHJlcy5lbmREYXRhUmVxdWVzdCgpOwogICAgICAg\nICAgICAgICAgaXNOdWxsUEsgPSBpc051bGxQSyAmJiB2YWxzW3BrSWR4XSA9\nPSBudWxsOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGlmIChp\nc051bGxQSykgewogICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICB9\nCgogICAgICAgIC8vIHRoZSBvaWQgZGF0YSBpcyBsb2FkZWQgYnkgdGhlIGJh\nc2UgdHlwZSwgYnV0IGlmIGRpc2NyaW1pbmF0b3IgZGF0YQogICAgICAgIC8v\nIGlzIHByZXNlbnQsIG1ha2Ugc3VyZSB0byB1c2UgaXQgdG8gY29uc3RydWN0\nIHRoZSBhY3R1YWwgb2lkIGluc3RhbmNlCiAgICAgICAgLy8gc28gdGhhdCB3\nZSBnZXQgdGhlIGNvcnJlY3QgYXBwIGlkIGNsYXNzLCBldGMKICAgICAgICAK\nICAgICAgICAvLyBEaXNjcmltaW5hdG9yIHJlZmVycyB0byB0aGUgcm93IGJ1\ndCB0aGUgdmFsc1tdIG1heSBob2xkIGRhdGEgdGhhdAogICAgICAgIC8vIHJl\nZmVyIHRvIGFub3RoZXIgcm93LiBUaGVuIHRoZXJlIGlzIGxpdHRsZSBwb2lu\ndCByZWFkaW5nIHRoZSBkaXNjCiAgICAgICAgLy8gdmFsdWUKCiAgICAgICAg\nQ2xhc3NNYXBwaW5nIGRjbHMgPSBjbHM7CiAgICAgICAgaWYgKHN1YnMgJiYg\nY2FuUmVhZERpc2NyaW1pbmF0b3IpIHsKICAgICAgICAgICAgcmVzLnN0YXJ0\nRGF0YVJlcXVlc3QoY2xzLmdldERpc2NyaW1pbmF0b3IoKSk7CiAgICAgICAg\nICAgIHRyeSB7CiAgICAgICAgICAgICAgICBDbGFzcyBkdHlwZSA9IGNscy5n\nZXREaXNjcmltaW5hdG9yKCkuZ2V0Q2xhc3Moc3RvcmUsIGNscywgcmVzKTsK\nICAgICAgICAgICAgICAgIGlmIChkdHlwZSAhPSBjbHMuZ2V0RGVzY3JpYmVk\nVHlwZSgpKQogICAgICAgICAgICAgICAgICBkY2xzID0gY2xzLmdldE1hcHBp\nbmdSZXBvc2l0b3J5KCkuZ2V0TWFwcGluZyhkdHlwZSwgCiAgICAgICAgICAg\nICAgICAgICAgc3RvcmUuZ2V0Q29udGV4dCgpLmdldENsYXNzTG9hZGVyKCks\nIHRydWUpOyAKICAgICAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsK\nICAgICAgICAgICAgICAgIC8vIGludGVudGlvbmFsbHkgaWdub3JlZAogICAg\nICAgICAgICB9CiAgICAgICAgICAgIHJlcy5lbmREYXRhUmVxdWVzdCgpOyAg\nCiAgICAgICAgfQogICAgICAgIE9iamVjdCBvaWQgPSBBcHBsaWNhdGlvbklk\ncy5mcm9tUEtWYWx1ZXModmFscywgZGNscyk7CiAgICAgICAgaWYgKG9pZCBp\nbnN0YW5jZW9mIE9wZW5KUEFJZCkgewogICAgICAgICAgICAoKE9wZW5KUEFJ\nZCkgb2lkKS5zZXRNYW5hZ2VkSW5zdGFuY2VUeXBlKGRjbHMuZ2V0RGVzY3Jp\nYmVkVHlwZSgpLCAKICAgICAgICAgICAgICAgIHN1YnMpOwogICAgICAgIH0K\nICAgICAgICByZXR1cm4gb2lkOwogICAgfQogICAgCiAgICBib29sZWFuIGlz\nU2VsZlJlZmVyZW5jZShGb3JlaWduS2V5IGZrLCBDb2x1bW5bXSBjb2xzKSB7\nCiAgICAJaWYgKGZrID09IG51bGwpCiAgICAJCXJldHVybiB0cnVlOwogICAg\nCWZvciAoQ29sdW1uIGNvbCA6IGNvbHMpCiAgICAJCWlmIChmay5nZXRDb2x1\nbW4oY29sKSAhPSBjb2wpCiAgICAJCQlyZXR1cm4gZmFsc2U7CiAgICAJcmV0\ndXJuIHRydWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIGdp\ndmVuIGNvbHVtbiB2YWx1ZShzKSBmb3IgdGhlIGdpdmVuIG9iamVjdC4gVGhl\nIGdpdmVuCiAgICAgKiBjb2x1bW5zIHdpbGwgYmUgcHJpbWFyeSBrZXkgY29s\ndW1ucyBvZiB0aGlzIG1hcHBpbmcsIGJ1dCBtYXkgYmUgaW4KICAgICAqIGFu\neSBvcmRlci4gSWYgdGhlcmUgaXMgb25seSBvbmUgY29sdW1uLCByZXR1cm4g\naXRzIHZhbHVlLiBJZiB0aGVyZQogICAgICogYXJlIG11bHRpcGxlIGNvbHVt\nbnMsIHJldHVybiBhbiBvYmplY3QgYXJyYXkgb2YgdGhlaXIgdmFsdWVzLCBp\nbiB0aGUKICAgICAqIHNhbWUgb3JkZXIgdGhlIGNvbHVtbnMgYXJlIGdpdmVu\nLgogICAgICovCiAgICBwdWJsaWMgT2JqZWN0IHRvRGF0YVN0b3JlVmFsdWUo\nT2JqZWN0IG9iaiwgQ29sdW1uW10gY29scywgSkRCQ1N0b3JlIHN0b3JlKSB7\nCiAgICAgICAgT2JqZWN0IHJldCA9IChjb2xzLmxlbmd0aCA9PSAxKSA/IG51\nbGwgOiBuZXcgT2JqZWN0W2NvbHMubGVuZ3RoXTsKCiAgICAgICAgLy8gaW4g\ndGhlIHBhc3Qgd2UndmUgYmVlbiBsZW5pZW50IGFib3V0IGJlaW5nIGFibGUg\ndG8gdHJhbnNsYXRlIG9iamVjdHMKICAgICAgICAvLyBmcm9tIG90aGVyIHBl\ncnNpc3RlbmNlIGNvbnRleHRzLCBzbyB0cnkgdG8gZ2V0IHNtIGRpcmVjdGx5\nIGZyb20KICAgICAgICAvLyBpbnN0YW5jZSBiZWZvcmUgYXNraW5nIG91ciBj\nb250ZXh0CiAgICAgICAgT3BlbkpQQVN0YXRlTWFuYWdlciBzbTsKICAgICAg\nICBpZiAoSW1wbEhlbHBlci5pc01hbmFnZWFibGUob2JqKSkgewogICAgICAg\nIAlQZXJzaXN0ZW5jZUNhcGFibGUgcGMgPSBJbXBsSGVscGVyLnRvUGVyc2lz\ndGVuY2VDYXBhYmxlKG9iaiwKICAgICAgICAgICAgICAgICAgICBnZXRSZXBv\nc2l0b3J5KCkuZ2V0Q29uZmlndXJhdGlvbigpKTsKICAgICAgICAgICAgc20g\nPSAoT3BlbkpQQVN0YXRlTWFuYWdlcikgcGMucGNHZXRTdGF0ZU1hbmFnZXIo\nKTsKICAgICAgICAgICAgaWYgKHNtID09IG51bGwpIHsKICAgICAgICAgICAg\nCXJldCA9IGdldFZhbHVlRnJvbVVubWFuYWdlZEluc3RhbmNlKG9iaiwgY29s\ncywgdHJ1ZSk7CiAgICAgICAgICAgIH0gZWxzZSBpZiAoc20uaXNEZXRhY2hl\nZCgpKSB7CiAgICAgICAgICAgIAlvYmogPSBzdG9yZS5nZXRDb250ZXh0KCku\nZmluZChzbS5nZXRPYmplY3RJZCgpLCBmYWxzZSwgbnVsbCk7CiAgICAgICAg\nICAgIAlzbSA9IHN0b3JlLmdldENvbnRleHQoKS5nZXRTdGF0ZU1hbmFnZXIo\nb2JqKTsKICAgICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAg\nICAgIHNtID0gc3RvcmUuZ2V0Q29udGV4dCgpLmdldFN0YXRlTWFuYWdlcihv\nYmopOwogICAgICAgIH0KICAgICAgICBpZiAoc20gPT0gbnVsbCkKICAgICAg\nICAgICAgcmV0dXJuIHJldDsKCiAgICAgICAgT2JqZWN0IHZhbDsKICAgICAg\nICBmb3IgKGludCBpID0gMDsgaSA8IGNvbHMubGVuZ3RoOyBpKyspIHsKICAg\nICAgICAgICAgdmFsID0gYXNzZXJ0Sm9pbmFibGUoY29sc1tpXSkuZ2V0Sm9p\nblZhbHVlKHNtLCBjb2xzW2ldLCBzdG9yZSk7CiAgICAgICAgICAgIGlmIChj\nb2xzLmxlbmd0aCA9PSAxKQogICAgICAgICAgICAgICAgcmV0ID0gdmFsOwog\nICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAoKE9iamVjdFtdKSBy\nZXQpW2ldID0gdmFsOwogICAgICAgIH0KICAgICAgICByZXR1cm4gcmV0Owog\nICAgfQogICAgCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgam9pbmFibGUg\nZm9yIHRoZSBnaXZlbiBjb2x1bW4sIG9yIHRocm93IGFuIGV4Y2VwdGlvbiBp\nZgogICAgICogbm9uZSBpcyBhdmFpbGFibGUuCiAgICAgKi8KICAgIHB1Ymxp\nYyBKb2luYWJsZSBhc3NlcnRKb2luYWJsZShDb2x1bW4gY29sKSB7CiAgICAg\nICAgSm9pbmFibGUgam9pbiA9IGdldEpvaW5hYmxlKGNvbCk7CiAgICAgICAg\naWYgKGpvaW4gPT0gbnVsbCkKICAgICAgICAgICAgdGhyb3cgbmV3IE1ldGFE\nYXRhRXhjZXB0aW9uKF9sb2MuZ2V0KCJuby1qb2luYWJsZSIsCiAgICAgICAg\nICAgICAgICBjb2wuZ2V0UXVhbGlmaWVkUGF0aCgpLnRvU3RyaW5nKCkpKTsK\nICAgICAgICByZXR1cm4gam9pbjsKICAgIH0KCiAgICAvKioKICAgICAqIFJl\ndHVybiB0aGUge0BsaW5rIEpvaW5hYmxlfSBmb3IgdGhlIGdpdmVuIGNvbHVt\nbi4gQW55IGNvbHVtbiB0aGF0CiAgICAgKiBhbm90aGVyIG1hcHBpbmcgam9p\nbnMgdG8gbXVzdCBiZSBjb250cm9sbGVkIGJ5IGEgam9pbmFibGUuCiAgICAg\nKi8KICAgIHB1YmxpYyBKb2luYWJsZSBnZXRKb2luYWJsZShDb2x1bW4gY29s\nKSB7CiAgICAgICAgSm9pbmFibGUgam9pbjsKICAgICAgICBpZiAoZ2V0RW1i\nZWRkaW5nTWV0YURhdGEoKSAhPSBudWxsKSB7CiAgICAgICAgICAgIGpvaW4g\nPSBnZXRFbWJlZGRpbmdNYXBwaW5nKCkuZ2V0RmllbGRNYXBwaW5nKCkuCiAg\nICAgICAgICAgICAgICBnZXREZWZpbmluZ01hcHBpbmcoKS5nZXRKb2luYWJs\nZShjb2wpOwogICAgICAgICAgICBpZiAoam9pbiAhPSBudWxsKQogICAgICAg\nICAgICAgICAgcmV0dXJuIGpvaW47CiAgICAgICAgfQogICAgICAgIENsYXNz\nTWFwcGluZyBzdXAgPSBnZXRKb2luYWJsZVBDU3VwZXJjbGFzc01hcHBpbmco\nKTsKICAgICAgICBpZiAoc3VwICE9IG51bGwpIHsKICAgICAgICAgICAgam9p\nbiA9IHN1cC5nZXRKb2luYWJsZShjb2wpOwogICAgICAgICAgICBpZiAoam9p\nbiAhPSBudWxsKQogICAgICAgICAgICAgICAgcmV0dXJuIGpvaW47CiAgICAg\nICAgfQogICAgICAgIHJldHVybiAoSm9pbmFibGUpIF9qb2luYWJsZXMuZ2V0\nKGNvbCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBBZGQgdGhlIGdpdmVuIGNv\nbHVtbi10by1qb2luYWJsZSBtYXBwaW5nLgogICAgICovCiAgICBwdWJsaWMg\ndm9pZCBzZXRKb2luYWJsZShDb2x1bW4gY29sLCBKb2luYWJsZSBqb2luYWJs\nZSkgewogICAgICAgIC8vIGRvbid0IGxldCBub24tcGsgb3ZlcnJpZGUgcGsK\nICAgICAgICBKb2luYWJsZSBqb2luID0gKEpvaW5hYmxlKSBfam9pbmFibGVz\nLmdldChjb2wpOwogICAgICAgIGlmIChqb2luID09IG51bGwgfHwgKGpvaW4u\nZ2V0RmllbGRJbmRleCgpICE9IC0xCiAgICAgICAgICAgICYmIGdldEZpZWxk\nKGpvaW4uZ2V0RmllbGRJbmRleCgpKS5nZXRQcmltYXJ5S2V5SW5kZXgoKSA9\nPSAtMSkpCiAgICAgICAgICAgIF9qb2luYWJsZXMucHV0KGNvbCwgam9pbmFi\nbGUpOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHdoZXRoZXIgdGhl\nIGNvbHVtbnMgb2YgdGhlIGdpdmVuIGZvcmVpZ24ga2V5IHRvIHRoaXMgbWFw\ncGluZwogICAgICogY2FuIGJlIHVzZWQgdG8gY29uc3RydWN0IGFuIG9iamVj\ndCBpZCBmb3IgdGhpcyB0eXBlLiBUaGlzIGlzIGEKICAgICAqIHJlbGF0aXZl\nbHkgZXhwZW5zaXZlIG9wZXJhdGlvbjsgaXRzIHJlc3VsdHMgc2hvdWxkIGJl\nIGNhY2hlZC4KICAgICAqCiAgICAgKiBAcmV0dXJuIHtAbGluayBCb29sZWFu\nI1RSVUV9IGlmIHRoZSBmb3JlaWduIGtleSBjb250YWlucyBhbGwgb2lkCiAg\nICAgKiBjb2x1bW5zLCA8Y29kZT5udWxsPC9jb2RlPiBpZiBpdCBjb250YWlu\ncyBvbmx5IHNvbWUgY29sdW1ucywKICAgICAqIG9yIHtAbGluayBCb29sZWFu\nI0ZBTFNFfSBpZiBpdCBjb250YWlucyBub24tb2lkIGNvbHVtbnMKICAgICAq\nLwogICAgcHVibGljIEJvb2xlYW4gaXNGb3JlaWduS2V5T2JqZWN0SWQoRm9y\nZWlnbktleSBmaykgewogICAgICAgIC8vIGlmIHRoaXMgbWFwcGluZydzIHBy\naW1hcnkga2V5IGNhbid0IGNvbnN0cnVjdCBhbiBvaWQsIHRoZW4gbm8gd2F5\nCiAgICAgICAgLy8gZm9yZWlnbiBrZXkgY2FuCiAgICAgICAgaWYgKGdldElk\nZW50aXR5VHlwZSgpID09IElEX1VOS05PV04gfHwgIWlzUHJpbWFyeUtleU9i\namVjdElkKGZhbHNlKSkKICAgICAgICAgICAgcmV0dXJuIEJvb2xlYW4uRkFM\nU0U7CgogICAgICAgIC8vIHdpdGggZGF0YXN0b3JlIGlkZW50aXR5LCBpdCdz\nIGFsbCBvciBub3RoaW5nCiAgICAgICAgQ29sdW1uW10gY29scyA9IGZrLmdl\ndFByaW1hcnlLZXlDb2x1bW5zKCk7CiAgICAgICAgaWYgKGdldElkZW50aXR5\nVHlwZSgpID09IElEX0RBVEFTVE9SRSkgewogICAgICAgICAgICBpZiAoY29s\ncy5sZW5ndGggIT0gMSB8fCBjb2xzWzBdICE9IGdldFByaW1hcnlLZXlDb2x1\nbW5zKClbMF0pCiAgICAgICAgICAgICAgICByZXR1cm4gQm9vbGVhbi5GQUxT\nRTsKICAgICAgICAgICAgcmV0dXJuIEJvb2xlYW4uVFJVRTsKICAgICAgICB9\nCgogICAgICAgIC8vIGNoZWNrIHRoZSBqb2luIG1hcHBpbmcgZm9yIGVhY2gg\ncGsgY29sdW1uIHRvIHNlZSBpZiBpdCBsaW5rcyB1cCB0bwogICAgICAgIC8v\nIGEgcHJpbWFyeSBrZXkgZmllbGQKICAgICAgICBKb2luYWJsZSBqb2luOwog\nICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgY29scy5sZW5ndGg7IGkrKykg\newogICAgICAgICAgICBqb2luID0gYXNzZXJ0Sm9pbmFibGUoY29sc1tpXSk7\nCiAgICAgICAgICAgIGlmIChqb2luLmdldEZpZWxkSW5kZXgoKSAhPSAtMQog\nICAgICAgICAgICAgICAgJiYgZ2V0RmllbGQoam9pbi5nZXRGaWVsZEluZGV4\nKCkpLmdldFByaW1hcnlLZXlJbmRleCgpID09IC0xKQogICAgICAgICAgICAg\nICAgcmV0dXJuIEJvb2xlYW4uRkFMU0U7CiAgICAgICAgfQoKICAgICAgICAv\nLyBpZiBhbGwgcHJpbWFyeSBrZXkgbGlua3MsIHNlZSB3aGV0aGVyIHdlIGpv\naW4gdG8gYWxsIHBrcwogICAgICAgIGlmIChpc1ByaW1hcnlLZXlPYmplY3RJ\nZCh0cnVlKQogICAgICAgICAgICAmJiBjb2xzLmxlbmd0aCA9PSBnZXRQcmlt\nYXJ5S2V5Q29sdW1ucygpLmxlbmd0aCkKICAgICAgICAgICAgcmV0dXJuIEJv\nb2xlYW4uVFJVRTsKICAgICAgICByZXR1cm4gbnVsbDsKICAgIH0KCiAgICAv\nLy8vLy8vCiAgICAvLyBPUk0KICAgIC8vLy8vLy8KCiAgICAvKioKICAgICAq\nIFJhdyBtYXBwaW5nIGRhdGEuCiAgICAgKi8KICAgIHB1YmxpYyBDbGFzc01h\ncHBpbmdJbmZvIGdldE1hcHBpbmdJbmZvKCkgewogICAgICAgIHJldHVybiBf\naW5mbzsKICAgIH0KCiAgICAvKioKICAgICAqIFRoZSBzdHJhdGVneSB1c2Vk\nIHRvIG1hcCB0aGlzIG1hcHBpbmcuCiAgICAgKi8KICAgIHB1YmxpYyBDbGFz\nc1N0cmF0ZWd5IGdldFN0cmF0ZWd5KCkgewogICAgICAgIHJldHVybiBfc3Ry\nYXRlZ3k7CiAgICB9CgogICAgLyoqCiAgICAgKiBUaGUgc3RyYXRlZ3kgdXNl\nZCB0byBtYXAgdGhpcyBtYXBwaW5nLiBUaGUgPGNvZGU+YWRhcHQ8L2NvZGU+\nCiAgICAgKiBwYXJhbWV0ZXIgZGV0ZXJtaW5lcyB3aGV0aGVyIHRvIGFkYXB0\nIHdoZW4gbWFwcGluZyB0aGUgc3RyYXRlZ3k7CiAgICAgKiB1c2UgbnVsbCBp\nZiB0aGUgc3RyYXRlZ3kgc2hvdWxkIG5vdCBiZSBtYXBwZWQuCiAgICAgKi8K\nICAgIHB1YmxpYyB2b2lkIHNldFN0cmF0ZWd5KENsYXNzU3RyYXRlZ3kgc3Ry\nYXRlZ3ksIEJvb2xlYW4gYWRhcHQpIHsKICAgICAgICAvLyBzZXQgc3RyYXRl\nZ3kgZmlyc3Qgc28gd2UgY2FuIGFjY2VzcyBpdCBkdXJpbmcgbWFwcGluZwog\nICAgICAgIENsYXNzU3RyYXRlZ3kgb3JpZyA9IF9zdHJhdGVneTsKICAgICAg\nICBfc3RyYXRlZ3kgPSBzdHJhdGVneTsKICAgICAgICBpZiAoc3RyYXRlZ3kg\nIT0gbnVsbCkgewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAg\nc3RyYXRlZ3kuc2V0Q2xhc3NNYXBwaW5nKHRoaXMpOwogICAgICAgICAgICAg\nICAgaWYgKGFkYXB0ICE9IG51bGwpCiAgICAgICAgICAgICAgICAgICAgc3Ry\nYXRlZ3kubWFwKGFkYXB0LmJvb2xlYW5WYWx1ZSgpKTsKICAgICAgICAgICAg\nfSBjYXRjaCAoUnVudGltZUV4Y2VwdGlvbiByZSkgewogICAgICAgICAgICAg\nICAgLy8gcmVzZXQgc3RyYXRlZ3kKICAgICAgICAgICAgICAgIF9zdHJhdGVn\neSA9IG9yaWc7CiAgICAgICAgICAgICAgICB0aHJvdyByZTsKICAgICAgICAg\nICAgfQogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIFRoZSBtYXBw\naW5nJ3MgcHJpbWFyeSB0YWJsZS4KICAgICAqLwogICAgcHVibGljIFRhYmxl\nIGdldFRhYmxlKCkgewogICAgICAgIHJldHVybiBfdGFibGU7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBUaGUgbWFwcGluZydzIHByaW1hcnkgdGFibGUuCiAg\nICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldFRhYmxlKFRhYmxlIHRhYmxlKSB7\nCiAgICAgICAgX3RhYmxlID0gdGFibGU7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBUaGUgY29sdW1ucyB0aGlzIG1hcHBpbmcgdXNlcyB0byB1bmlxdWVseSBp\nZGVudGlmeSBhbiBvYmplY3QuCiAgICAgKiBUaGVzZSB3aWxsIHR5cGljYWxs\neSBiZSB0aGUgcHJpbWFyeSBrZXkgY29sdW1ucyBvciB0aGUgY29sdW1ucyB0\naGlzCiAgICAgKiBjbGFzcyB1c2VzIHRvIGxpbmsgdG8gaXRzIHN1cGVyY2xh\nc3MgdGFibGUuCiAgICAgKi8KICAgIHB1YmxpYyBDb2x1bW5bXSBnZXRQcmlt\nYXJ5S2V5Q29sdW1ucygpIHsKICAgICAgICBpZiAoZ2V0SWRlbnRpdHlUeXBl\nKCkgPT0gSURfQVBQTElDQVRJT04gJiYgaXNNYXBwZWQoKSkgewogICAgICAg\nICAgICBpZiAoX2NvbHMubGVuZ3RoID09IDApIHsKICAgICAgICAgICAgICAg\nIEZpZWxkTWFwcGluZ1tdIHBrcyA9IGdldFByaW1hcnlLZXlGaWVsZE1hcHBp\nbmdzKCk7CiAgICAgICAgICAgICAgICBDb2xsZWN0aW9uIGNvbHMgPSBuZXcg\nQXJyYXlMaXN0KHBrcy5sZW5ndGgpOwogICAgICAgICAgICAgICAgQ29sdW1u\nW10gZmllbGRDb2xzOwogICAgICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7\nIGkgPCBwa3MubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICAgICAgICBm\naWVsZENvbHMgPSBwa3NbaV0uZ2V0Q29sdW1ucygpOwogICAgICAgICAgICAg\nICAgICAgIGlmIChmaWVsZENvbHMubGVuZ3RoID09IDApIHsKICAgICAgICAg\nICAgICAgICAgICAgICAgX2NvbHMgPSBuZXcgQ29sdW1uWzBdOwogICAgICAg\nICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbHM7CiAgICAgICAgICAgICAg\nICAgICAgfQogICAgICAgICAgICAgICAgICAgIGZvciAoaW50IGogPSAwOyBq\nIDwgZmllbGRDb2xzLmxlbmd0aDsgaisrKQogICAgICAgICAgICAgICAgICAg\nICAgICBjb2xzLmFkZChmaWVsZENvbHNbal0pOwogICAgICAgICAgICAgICAg\nfQogICAgICAgICAgICAgICAgX2NvbHMgPSAoQ29sdW1uW10pIGNvbHMudG9B\ncnJheShuZXcgQ29sdW1uW2NvbHMuc2l6ZSgpXSk7CiAgICAgICAgICAgIH0K\nICAgICAgICB9CiAgICAgICAgcmV0dXJuIF9jb2xzOwogICAgfQoKICAgIC8q\nKgogICAgICogVGhlIGNvbHVtbnMgdGhpcyBtYXBwaW5nIHVzZXMgdG8gdW5p\ncXVlbHkgaWRlbnRpZnkgYW4gb2JqZWN0LgogICAgICogVGhlc2Ugd2lsbCB0\neXBpY2FsbHkgYmUgdGhlIHByaW1hcnkga2V5IGNvbHVtbnMgb3IgdGhlIGNv\nbHVtbnMgdGhpcwogICAgICogY2xhc3MgdXNlcyB0byBsaW5rIHRvIGl0cyBz\ndXBlcmNsYXNzIHRhYmxlLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRQ\ncmltYXJ5S2V5Q29sdW1ucyhDb2x1bW5bXSBjb2xzKSB7CiAgICAgICAgaWYg\nKGNvbHMgPT0gbnVsbCkKICAgICAgICAgICAgY29scyA9IFNjaGVtYXMuRU1Q\nVFlfQ09MVU1OUzsKICAgICAgICBfY29scyA9IGNvbHM7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBJL08gaW5mb3JtYXRpb24gb24gdGhlIGtleSBjb2x1bW5z\nIC8gam9pbiBrZXkuCiAgICAgKi8KICAgIHB1YmxpYyBDb2x1bW5JTyBnZXRD\nb2x1bW5JTygpIHsKICAgICAgICByZXR1cm4gKF9pbyA9PSBudWxsKSA/IENv\nbHVtbklPLlVOUkVTVFJJQ1RFRCA6IF9pbzsKICAgIH0KCiAgICAvKioKICAg\nICAqIEkvTyBpbmZvcm1hdGlvbiBvbiB0aGUga2V5IGNvbHVtbnMgLyBqb2lu\nIGtleS4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0Q29sdW1uSU8oQ29s\ndW1uSU8gaW8pIHsKICAgICAgICBfaW8gPSBpbzsKICAgIH0KCiAgICAvKioK\nICAgICAqIEZvcmVpZ24ga2V5IGxpbmtpbmcgdGhlIHByaW1hcnkga2V5IGNv\nbHVtbnMgdG8gdGhlIHN1cGVyY2xhc3MgdGFibGUsCiAgICAgKiBvciBudWxs\nIGlmIG5vbmUuCiAgICAgKi8KICAgIHB1YmxpYyBGb3JlaWduS2V5IGdldEpv\naW5Gb3JlaWduS2V5KCkgewogICAgICAgIHJldHVybiBfZms7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBGb3JlaWduIGtleSBsaW5raW5nIHRoZSBwcmltYXJ5\nIGtleSBjb2x1bW5zIHRvIHRoZSBzdXBlcmNsYXNzIHRhYmxlLAogICAgICog\nb3IgbnVsbCBpZiBub25lLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRK\nb2luRm9yZWlnbktleShGb3JlaWduS2V5IGZrKSB7CiAgICAgICAgX2ZrID0g\nZms7CiAgICB9CgogICAgcHVibGljIHZvaWQgcmVmU2NoZW1hQ29tcG9uZW50\ncygpIHsKICAgICAgICBpZiAoZ2V0RW1iZWRkaW5nTWV0YURhdGEoKSA9PSBu\ndWxsKSB7CiAgICAgICAgICAgIGlmIChfdGFibGUgIT0gbnVsbCAmJiBfdGFi\nbGUuZ2V0UHJpbWFyeUtleSgpICE9IG51bGwpCiAgICAgICAgICAgICAgICBf\ndGFibGUuZ2V0UHJpbWFyeUtleSgpLnJlZigpOwogICAgICAgICAgICBpZiAo\nX2ZrICE9IG51bGwpCiAgICAgICAgICAgICAgICBfZmsucmVmKCk7CiAgICAg\nICAgICAgIENvbHVtbltdIHBrcyA9IGdldFByaW1hcnlLZXlDb2x1bW5zKCk7\nCiAgICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgcGtzLmxlbmd0aDsg\naSsrKQogICAgICAgICAgICAgICAgcGtzW2ldLnJlZigpOwogICAgICAgIH0g\nZWxzZSB7CiAgICAgICAgICAgIEZpZWxkTWFwcGluZ1tdIGZpZWxkcyA9IGdl\ndEZpZWxkTWFwcGluZ3MoKTsKICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7\nIGkgPCBmaWVsZHMubGVuZ3RoOyBpKyspCiAgICAgICAgICAgICAgICBmaWVs\nZHNbaV0ucmVmU2NoZW1hQ29tcG9uZW50cygpOwogICAgICAgIH0KICAgIH0K\nCiAgICAvKioKICAgICAqIENsZWFyIG1hcHBpbmcgaW5mb3JtYXRpb24sIGlu\nY2x1ZGluZyBzdHJhdGVneS4KICAgICAqLwogICAgcHVibGljIHZvaWQgY2xl\nYXJNYXBwaW5nKCkgewogICAgICAgIF9zdHJhdGVneSA9IG51bGw7CiAgICAg\nICAgX2NvbHMgPSBTY2hlbWFzLkVNUFRZX0NPTFVNTlM7CiAgICAgICAgX2Zr\nID0gbnVsbDsKICAgICAgICBfdGFibGUgPSBudWxsOwogICAgICAgIF9pbmZv\nLmNsZWFyKCk7CiAgICAgICAgc2V0UmVzb2x2ZShNT0RFX01BUFBJTkcgfCBN\nT0RFX01BUFBJTkdfSU5JVCwgZmFsc2UpOwogICAgfQoKICAgIC8qKgogICAg\nICogVXBkYXRlIHtAbGluayBNYXBwaW5nSW5mb30gd2l0aCBvdXIgY3VycmVu\ndCBtYXBwaW5nIGluZm9ybWF0aW9uLgogICAgICovCiAgICBwdWJsaWMgdm9p\nZCBzeW5jTWFwcGluZ0luZm8oKSB7CiAgICAgICAgaWYgKGdldEVtYmVkZGlu\nZ01ldGFEYXRhKCkgPT0gbnVsbCkKICAgICAgICAgICAgX2luZm8uc3luY1dp\ndGgodGhpcyk7CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIF9pbmZvLmNs\nZWFyKCk7CiAgICAgICAgICAgIEZpZWxkTWFwcGluZ1tdIGZpZWxkcyA9IGdl\ndEZpZWxkTWFwcGluZ3MoKTsKICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7\nIGkgPCBmaWVsZHMubGVuZ3RoOyBpKyspCiAgICAgICAgICAgICAgICBmaWVs\nZHNbaV0uc3luY01hcHBpbmdJbmZvKCk7CiAgICAgICAgfQogICAgfQoKICAg\nIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KICAgIC8vIE1ldGFEYXRhIGludGVy\nZmFjZQogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwoKICAgIHByb3RlY3Rl\nZCB2b2lkIHNldERlc2NyaWJlZFR5cGUoQ2xhc3MgdHlwZSkgewogICAgICAg\nIHN1cGVyLnNldERlc2NyaWJlZFR5cGUodHlwZSk7CiAgICAgICAgLy8gdGhp\ncyBtZXRob2QgY2FsbGVkIGZyb20gc3VwZXJjbGFzcyBjb25zdHJ1Y3Rvciwg\nc28gX2luZm8gbm90IHlldAogICAgICAgIC8vIGluaXRpYWxpemVkCiAgICAg\nICAgaWYgKF9pbmZvICE9IG51bGwpCiAgICAgICAgICAgIF9pbmZvLnNldENs\nYXNzTmFtZSh0eXBlLmdldE5hbWUoKSk7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBUaGUgc3ViY2xhc3MgZmV0Y2ggbW9kZSwgYXMgb25lIG9mIHRoZSBlYWdl\nciBjb25zdGFudHMgaW4KICAgICAqIHtAbGluayBKREJDRmV0Y2hDb25maWd1\ncmF0aW9ufS4KICAgICAqLwogICAgcHVibGljIGludCBnZXRTdWJjbGFzc0Zl\ndGNoTW9kZSgpIHsKICAgICAgICBpZiAoX3N1YmNsYXNzTW9kZSA9PSBJbnRl\nZ2VyLk1BWF9WQUxVRSkgewogICAgICAgICAgICBpZiAoZ2V0UENTdXBlcmNs\nYXNzKCkgIT0gbnVsbCkKICAgICAgICAgICAgICAgIF9zdWJjbGFzc01vZGUg\nPSBnZXRQQ1N1cGVyY2xhc3NNYXBwaW5nKCkuCiAgICAgICAgICAgICAgICAg\nICAgZ2V0U3ViY2xhc3NGZXRjaE1vZGUoKTsKICAgICAgICAgICAgZWxzZQog\nICAgICAgICAgICAgICAgX3N1YmNsYXNzTW9kZSA9IEZldGNoQ29uZmlndXJh\ndGlvbi5ERUZBVUxUOwogICAgICAgIH0KICAgICAgICByZXR1cm4gX3N1YmNs\nYXNzTW9kZTsKICAgIH0KCiAgICAvKioKICAgICAqIFRoZSBzdWJjbGFzcyBm\nZXRjaCBtb2RlLCBhcyBvbmUgb2YgdGhlIGVhZ2VyIGNvbnN0YW50cyBpbgog\nICAgICoge0BsaW5rIEpEQkNGZXRjaENvbmZpZ3VyYXRpb259LgogICAgICov\nCiAgICBwdWJsaWMgdm9pZCBzZXRTdWJjbGFzc0ZldGNoTW9kZShpbnQgbW9k\nZSkgewogICAgICAgIF9zdWJjbGFzc01vZGUgPSBtb2RlOwogICAgfQoKICAg\nIC8qKgogICAgICogQ29udmVuaWVuY2UgbWV0aG9kIHRvIHBlcmZvcm0gY2Fz\ndCBmcm9tCiAgICAgKiB7QGxpbmsgQ2xhc3NNZXRhRGF0YSNnZXRSZXBvc2l0\nb3J5fS4KICAgICAqLwogICAgcHVibGljIE1hcHBpbmdSZXBvc2l0b3J5IGdl\ndE1hcHBpbmdSZXBvc2l0b3J5KCkgewogICAgICAgIHJldHVybiAoTWFwcGlu\nZ1JlcG9zaXRvcnkpIGdldFJlcG9zaXRvcnkoKTsKICAgIH0KCiAgICAvKioK\nICAgICAqIENvbnZlbmllbmNlIG1ldGhvZCB0byBwZXJmb3JtIGNhc3QgZnJv\nbQogICAgICoge0BsaW5rIENsYXNzTWV0YURhdGEjZ2V0RW1iZWRkaW5nTWV0\nYURhdGF9CiAgICAgKi8KICAgIHB1YmxpYyBWYWx1ZU1hcHBpbmcgZ2V0RW1i\nZWRkaW5nTWFwcGluZygpIHsKICAgICAgICByZXR1cm4gKFZhbHVlTWFwcGlu\nZykgZ2V0RW1iZWRkaW5nTWV0YURhdGEoKTsKICAgIH0KCiAgICAvKioKICAg\nICAqIFJldHVybnMgdHJ1ZSBpZiB0aGlzIGNsYXNzIGRvZXMgbm90IHVzZSB0\naGUgIm5vbmUiIHN0cmF0ZWd5IChpbmNsdWRpbmcKICAgICAqIGlmIGl0IGhh\ncyBhIG51bGwgc3RyYXRlZ3ksIGFuZCB0aGVyZWZvcmUgaXMgcHJvYmFibHkg\naW4gdGhlIHByb2Nlc3Mgb2YKICAgICAqIGJlaW5nIG1hcHBlZCkuCiAgICAg\nKi8KICAgIHB1YmxpYyBib29sZWFuIGlzTWFwcGVkKCkgewogICAgICAgIGlm\nICghc3VwZXIuaXNNYXBwZWQoKSkKICAgICAgICAgICAgcmV0dXJuIGZhbHNl\nOwogICAgICAgIGlmIChfc3RyYXRlZ3kgIT0gbnVsbCkKICAgICAgICAgICAg\ncmV0dXJuIF9zdHJhdGVneSAhPSBOb25lQ2xhc3NTdHJhdGVneS5nZXRJbnN0\nYW5jZSgpOwogICAgICAgIHJldHVybiAhTm9uZUNsYXNzU3RyYXRlZ3kuQUxJ\nQVMuZXF1YWxzKF9pbmZvLmdldFN0cmF0ZWd5KCkpOwogICAgfQoKICAgIC8q\nKgogICAgICogQ29udmVuaWVuY2UgbWV0aG9kIHRvIHBlcmZvcm0gY2FzdCBm\ncm9tCiAgICAgKiB7QGxpbmsgQ2xhc3NNZXRhRGF0YSNnZXRQQ1N1cGVyY2xh\nc3NNZXRhRGF0YX0uCiAgICAgKi8KICAgIHB1YmxpYyBDbGFzc01hcHBpbmcg\nZ2V0UENTdXBlcmNsYXNzTWFwcGluZygpIHsKICAgICAgICByZXR1cm4gKENs\nYXNzTWFwcGluZykgZ2V0UENTdXBlcmNsYXNzTWV0YURhdGEoKTsKICAgIH0K\nCiAgICAvKioKICAgICAqIENvbnZlbmllbmNlIG1ldGhvZCB0byBwZXJmb3Jt\nIGNhc3QgZnJvbQogICAgICoge0BsaW5rIENsYXNzTWV0YURhdGEjZ2V0TWFw\ncGVkUENTdXBlcmNsYXNzTWV0YURhdGF9LgogICAgICovCiAgICBwdWJsaWMg\nQ2xhc3NNYXBwaW5nIGdldE1hcHBlZFBDU3VwZXJjbGFzc01hcHBpbmcoKSB7\nCiAgICAgICAgcmV0dXJuIChDbGFzc01hcHBpbmcpIGdldE1hcHBlZFBDU3Vw\nZXJjbGFzc01ldGFEYXRhKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1\ncm4gdGhlIG5lYXJlc3QgbWFwcGVkIHN1cGVyY2xhc3MgdGhhdCBjYW4gam9p\nbiB0byB0aGlzIGNsYXNzLgogICAgICovCiAgICBwdWJsaWMgQ2xhc3NNYXBw\naW5nIGdldEpvaW5hYmxlUENTdXBlcmNsYXNzTWFwcGluZygpIHsKICAgICAg\nICBDbGFzc01hcHBpbmcgc3VwID0gZ2V0TWFwcGVkUENTdXBlcmNsYXNzTWFw\ncGluZygpOwogICAgICAgIGlmIChzdXAgPT0gbnVsbCkKICAgICAgICAgICAg\ncmV0dXJuIG51bGw7CiAgICAgICAgaWYgKF9mayAhPSBudWxsIHx8IF90YWJs\nZSA9PSBudWxsIHx8IF90YWJsZS5lcXVhbHMoc3VwLmdldFRhYmxlKCkpKQog\nICAgICAgICAgICByZXR1cm4gc3VwOwogICAgICAgIHJldHVybiBudWxsOwog\nICAgfQoKICAgIC8qKgogICAgICogQ29udmVuaWVuY2UgbWV0aG9kIHRvIHBl\ncmZvcm0gY2FzdCBmcm9tCiAgICAgKiB7QGxpbmsgQ2xhc3NNZXRhRGF0YSNn\nZXRQQ1N1YmNsYXNzTWV0YURhdGFzfS4KICAgICAqLwogICAgcHVibGljIENs\nYXNzTWFwcGluZ1tdIGdldFBDU3ViY2xhc3NNYXBwaW5ncygpIHsKICAgICAg\nICByZXR1cm4gKENsYXNzTWFwcGluZ1tdKSBnZXRQQ1N1YmNsYXNzTWV0YURh\ndGFzKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBDb252ZW5pZW5jZSBtZXRo\nb2QgdG8gcGVyZm9ybSBjYXN0IGZyb20KICAgICAqIHtAbGluayBDbGFzc01l\ndGFEYXRhI2dldE1hcHBlZFBDU3ViY2xhc3NNZXRhRGF0YXN9LgogICAgICov\nCiAgICBwdWJsaWMgQ2xhc3NNYXBwaW5nW10gZ2V0TWFwcGVkUENTdWJjbGFz\nc01hcHBpbmdzKCkgewogICAgICAgIHJldHVybiAoQ2xhc3NNYXBwaW5nW10p\nIGdldE1hcHBlZFBDU3ViY2xhc3NNZXRhRGF0YXMoKTsKICAgIH0KCiAgICAv\nKioKICAgICAqIFJldHVybiBtYXBwZWQgc3ViY2xhc3NlcyB0aGF0IGFyZSBy\nZWFjaGFibGUgdmlhIGpvaW5zLgogICAgICovCiAgICBwdWJsaWMgQ2xhc3NN\nYXBwaW5nW10gZ2V0Sm9pbmFibGVQQ1N1YmNsYXNzTWFwcGluZ3MoKSB7CiAg\nICAgICAgQ2xhc3NNYXBwaW5nW10gc3VicyA9IGdldE1hcHBlZFBDU3ViY2xh\nc3NNYXBwaW5ncygpOyAvLyBjaGVja3MgZm9yIG5ldwogICAgICAgIGlmIChf\nam9pblN1Yk1hcHMgPT0gbnVsbCkgewogICAgICAgICAgICBpZiAoc3Vicy5s\nZW5ndGggPT0gMCkKICAgICAgICAgICAgICAgIF9qb2luU3ViTWFwcyA9IHN1\nYnM7CiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgTGlzdCBq\nb2luYWJsZSA9IG5ldyBBcnJheUxpc3Qoc3Vicy5sZW5ndGgpOwogICAgICAg\nICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBzdWJzLmxlbmd0aDsgaSsr\nKQogICAgICAgICAgICAgICAgICAgIGlmIChpc1N1YkpvaW5hYmxlKHN1YnNb\naV0pKQogICAgICAgICAgICAgICAgICAgICAgICBqb2luYWJsZS5hZGQoc3Vi\nc1tpXSk7CiAgICAgICAgICAgICAgICBfam9pblN1Yk1hcHMgPSAoQ2xhc3NN\nYXBwaW5nW10pIGpvaW5hYmxlLnRvQXJyYXkKICAgICAgICAgICAgICAgICAg\nICAobmV3IENsYXNzTWFwcGluZ1tqb2luYWJsZS5zaXplKCldKTsKICAgICAg\nICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4gX2pvaW5TdWJNYXBz\nOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHdoZXRoZXIgd2UgY2Fu\nIHJlYWNoIHRoZSBnaXZlbiBzdWJjbGFzcyB2aWEgam9pbnMuCiAgICAgKi8K\nICAgIHByaXZhdGUgYm9vbGVhbiBpc1N1YkpvaW5hYmxlKENsYXNzTWFwcGlu\nZyBzdWIpIHsKICAgICAgICBpZiAoc3ViID09IG51bGwpCiAgICAgICAgICAg\nIHJldHVybiBmYWxzZTsKICAgICAgICBpZiAoc3ViID09IHRoaXMpCiAgICAg\nICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIHJldHVybiBpc1N1YkpvaW5h\nYmxlKHN1Yi5nZXRKb2luYWJsZVBDU3VwZXJjbGFzc01hcHBpbmcoKSk7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm5zIHRoZSBjbG9zZXN0LWRlcml2\nZWQgbGlzdCBvZiBub24taW50ZXItam9pbmFibGUgbWFwcGVkIHR5cGVzCiAg\nICAgKiBhc3NpZ25hYmxlIHRvIHRoaXMgdHlwZS4gTWF5IHJldHVybiB0aGlz\nIG1hcHBpbmcuCiAgICAgKi8KICAgIHB1YmxpYyBDbGFzc01hcHBpbmdbXSBn\nZXRJbmRlcGVuZGVudEFzc2lnbmFibGVNYXBwaW5ncygpIHsKICAgICAgICBD\nbGFzc01hcHBpbmdbXSBzdWJzID0gZ2V0TWFwcGVkUENTdWJjbGFzc01hcHBp\nbmdzKCk7IC8vIGNoZWNrcyBmb3IgbmV3CiAgICAgICAgaWYgKF9hc3NpZ25N\nYXBzID09IG51bGwpIHsKICAgICAgICAgICAgLy8gcmVtb3ZlIHVubWFwcGVk\nIHN1YnMKICAgICAgICAgICAgaWYgKHN1YnMubGVuZ3RoID09IDApIHsKICAg\nICAgICAgICAgICAgIGlmIChpc01hcHBlZCgpKQogICAgICAgICAgICAgICAg\nICAgIF9hc3NpZ25NYXBzID0gbmV3IENsYXNzTWFwcGluZ1tdeyB0aGlzIH07\nCiAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgX2Fz\nc2lnbk1hcHMgPSBzdWJzOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAg\nICAgICAgICAgaW50IHNpemUgPSAoaW50KSAoc3Vicy5sZW5ndGggKiAxLjMz\nICsgMik7CiAgICAgICAgICAgICAgICBTZXQgaW5kZXBlbmRlbnQgPSBuZXcg\nTGlua2VkSGFzaFNldChzaXplKTsKICAgICAgICAgICAgICAgIGlmIChpc01h\ncHBlZCgpKQogICAgICAgICAgICAgICAgICAgIGluZGVwZW5kZW50LmFkZCh0\naGlzKTsKICAgICAgICAgICAgICAgIGluZGVwZW5kZW50LmFkZEFsbChBcnJh\neXMuYXNMaXN0KHN1YnMpKTsKCiAgICAgICAgICAgICAgICAvLyByZW1vdmUg\nYWxsIG1hcHBpbmdzIHRoYXQgaGF2ZSBhIHN1cGVyY2xhc3MgbWFwcGluZyBp\nbiB0aGUgc2V0CiAgICAgICAgICAgICAgICBDbGFzc01hcHBpbmcgbWFwLCBz\ndXA7CiAgICAgICAgICAgICAgICBMaXN0IGNsZWFyID0gbnVsbDsKICAgICAg\nICAgICAgICAgIGZvciAoSXRlcmF0b3IgaXRyID0gaW5kZXBlbmRlbnQuaXRl\ncmF0b3IoKTsgaXRyLmhhc05leHQoKTspIHsKICAgICAgICAgICAgICAgICAg\nICBtYXAgPSAoQ2xhc3NNYXBwaW5nKSBpdHIubmV4dCgpOwogICAgICAgICAg\nICAgICAgICAgIHN1cCA9IG1hcC5nZXRKb2luYWJsZVBDU3VwZXJjbGFzc01h\ncHBpbmcoKTsKICAgICAgICAgICAgICAgICAgICBpZiAoc3VwICE9IG51bGwg\nJiYgaW5kZXBlbmRlbnQuY29udGFpbnMoc3VwKSkgewogICAgICAgICAgICAg\nICAgICAgICAgICBpZiAoY2xlYXIgPT0gbnVsbCkKICAgICAgICAgICAgICAg\nICAgICAgICAgICAgIGNsZWFyID0gbmV3IEFycmF5TGlzdChpbmRlcGVuZGVu\ndC5zaXplKCkgLSAxKTsKICAgICAgICAgICAgICAgICAgICAgICAgY2xlYXIu\nYWRkKG1hcCk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAg\nICAgfQogICAgICAgICAgICAgICAgaWYgKGNsZWFyICE9IG51bGwpCiAgICAg\nICAgICAgICAgICAgICAgaW5kZXBlbmRlbnQucmVtb3ZlQWxsKGNsZWFyKTsK\nCiAgICAgICAgICAgICAgICBfYXNzaWduTWFwcyA9IChDbGFzc01hcHBpbmdb\nXSkgaW5kZXBlbmRlbnQudG9BcnJheQogICAgICAgICAgICAgICAgICAgIChu\nZXcgQ2xhc3NNYXBwaW5nW2luZGVwZW5kZW50LnNpemUoKV0pOwogICAgICAg\nICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiBfYXNzaWduTWFwczsK\nICAgIH0KCiAgICAvKioKICAgICAqIENvbnZlbmllbmNlIG1ldGhvZCB0byBw\nZXJmb3JtIGNhc3QgZnJvbSB7QGxpbmsgQ2xhc3NNZXRhRGF0YSNnZXRGaWVs\nZHN9LgogICAgICovCiAgICBwdWJsaWMgRmllbGRNYXBwaW5nW10gZ2V0Rmll\nbGRNYXBwaW5ncygpIHsKICAgICAgICByZXR1cm4gKEZpZWxkTWFwcGluZ1td\nKSBnZXRGaWVsZHMoKTsKICAgIH0KCiAgICAvKioKICAgICAqIENvbnZlbmll\nbmNlIG1ldGhvZCB0byBwZXJmb3JtIGNhc3QgZnJvbQogICAgICoge0BsaW5r\nIENsYXNzTWV0YURhdGEjZ2V0RGVjbGFyZWRGaWVsZHN9LgogICAgICovCiAg\nICBwdWJsaWMgRmllbGRNYXBwaW5nW10gZ2V0RGVjbGFyZWRGaWVsZE1hcHBp\nbmdzKCkgewogICAgICAgIHJldHVybiAoRmllbGRNYXBwaW5nW10pIGdldERl\nY2xhcmVkRmllbGRzKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBDb252ZW5p\nZW5jZSBtZXRob2QgdG8gcGVyZm9ybSBjYXN0IGZyb20KICAgICAqIHtAbGlu\nayBDbGFzc01ldGFEYXRhI2dldFByaW1hcnlLZXlGaWVsZHN9LgogICAgICov\nCiAgICBwdWJsaWMgRmllbGRNYXBwaW5nW10gZ2V0UHJpbWFyeUtleUZpZWxk\nTWFwcGluZ3MoKSB7CiAgICAgICAgcmV0dXJuIChGaWVsZE1hcHBpbmdbXSkg\nZ2V0UHJpbWFyeUtleUZpZWxkcygpOwogICAgfQoKICAgIC8qKgogICAgICog\nQ29udmVuaWVuY2UgbWV0aG9kIHRvIHBlcmZvcm0gY2FzdCBmcm9tCiAgICAg\nKiB7QGxpbmsgQ2xhc3NNZXRhRGF0YSNnZXRWZXJzaW9uRmllbGR9LgogICAg\nICovCiAgICBwdWJsaWMgRmllbGRNYXBwaW5nIGdldFZlcnNpb25GaWVsZE1h\ncHBpbmcoKSB7CiAgICAgICAgcmV0dXJuIChGaWVsZE1hcHBpbmcpIGdldFZl\ncnNpb25GaWVsZCgpOwogICAgfQoKICAgIC8qKgogICAgICogQ29udmVuaWVu\nY2UgbWV0aG9kIHRvIHBlcmZvcm0gY2FzdCBmcm9tCiAgICAgKiB7QGxpbmsg\nQ2xhc3NNZXRhRGF0YSNnZXREZWZhdWx0RmV0Y2hHcm91cEZpZWxkc30uCiAg\nICAgKi8KICAgIHB1YmxpYyBGaWVsZE1hcHBpbmdbXSBnZXREZWZhdWx0RmV0\nY2hHcm91cEZpZWxkTWFwcGluZ3MoKSB7CiAgICAgICAgcmV0dXJuIChGaWVs\nZE1hcHBpbmdbXSkgZ2V0RGVmYXVsdEZldGNoR3JvdXBGaWVsZHMoKTsKICAg\nIH0KCiAgICAvKioKICAgICAqIENvbnZlbmllbmNlIG1ldGhvZCB0byBwZXJm\nb3JtIGNhc3QgZnJvbQogICAgICoge0BsaW5rIENsYXNzTWV0YURhdGEjZ2V0\nRGVmaW5lZEZpZWxkc30uCiAgICAgKi8KICAgIHB1YmxpYyBGaWVsZE1hcHBp\nbmdbXSBnZXREZWZpbmVkRmllbGRNYXBwaW5ncygpIHsKICAgICAgICByZXR1\ncm4gKEZpZWxkTWFwcGluZ1tdKSBnZXREZWZpbmVkRmllbGRzKCk7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBDb252ZW5pZW5jZSBtZXRob2QgdG8gcGVyZm9y\nbSBjYXN0IGZyb20KICAgICAqIHtAbGluayBDbGFzc01ldGFEYXRhI2dldEZp\nZWxkc0luTGlzdGluZ09yZGVyfS4KICAgICAqLwogICAgcHVibGljIEZpZWxk\nTWFwcGluZ1tdIGdldEZpZWxkTWFwcGluZ3NJbkxpc3RpbmdPcmRlcigpIHsK\nICAgICAgICByZXR1cm4gKEZpZWxkTWFwcGluZ1tdKSBnZXRGaWVsZHNJbkxp\nc3RpbmdPcmRlcigpOwogICAgfQoKICAgIC8qKgogICAgICogQ29udmVuaWVu\nY2UgbWV0aG9kIHRvIHBlcmZvcm0gY2FzdCBmcm9tCiAgICAgKiB7QGxpbmsg\nQ2xhc3NNZXRhRGF0YSNnZXREZWZpbmVkRmllbGRzSW5MaXN0aW5nT3JkZXJ9\nLgogICAgICovCiAgICBwdWJsaWMgRmllbGRNYXBwaW5nW10gZ2V0RGVmaW5l\nZEZpZWxkTWFwcGluZ3NJbkxpc3RpbmdPcmRlcigpIHsKICAgICAgICByZXR1\ncm4gKEZpZWxkTWFwcGluZ1tdKSBnZXREZWZpbmVkRmllbGRzSW5MaXN0aW5n\nT3JkZXIoKTsKICAgIH0KCiAgICAvKioKICAgICAqIENvbnZlbmllbmNlIG1l\ndGhvZCB0byBwZXJmb3JtIGNhc3QgZnJvbSB7QGxpbmsgQ2xhc3NNZXRhRGF0\nYSNnZXRGaWVsZH0uCiAgICAgKi8KICAgIHB1YmxpYyBGaWVsZE1hcHBpbmcg\nZ2V0RmllbGRNYXBwaW5nKGludCBpbmRleCkgewogICAgICAgIHJldHVybiAo\nRmllbGRNYXBwaW5nKSBnZXRGaWVsZChpbmRleCk7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBDb252ZW5pZW5jZSBtZXRob2QgdG8gcGVyZm9ybSBjYXN0IGZy\nb20KICAgICAqIHtAbGluayBDbGFzc01ldGFEYXRhI2dldERlY2xhcmVkRmll\nbGR9LgogICAgICovCiAgICBwdWJsaWMgRmllbGRNYXBwaW5nIGdldERlY2xh\ncmVkRmllbGRNYXBwaW5nKGludCBpbmRleCkgewogICAgICAgIHJldHVybiAo\nRmllbGRNYXBwaW5nKSBnZXREZWNsYXJlZEZpZWxkKGluZGV4KTsKICAgIH0K\nCiAgICAvKioKICAgICAqIENvbnZlbmllbmNlIG1ldGhvZCB0byBwZXJmb3Jt\nIGNhc3QgZnJvbSB7QGxpbmsgQ2xhc3NNZXRhRGF0YSNnZXRGaWVsZH0uCiAg\nICAgKi8KICAgIHB1YmxpYyBGaWVsZE1hcHBpbmcgZ2V0RmllbGRNYXBwaW5n\nKFN0cmluZyBuYW1lKSB7CiAgICAgICAgcmV0dXJuIChGaWVsZE1hcHBpbmcp\nIGdldEZpZWxkKG5hbWUpOwogICAgfQoKICAgIC8qKgogICAgICogQ29udmVu\naWVuY2UgbWV0aG9kIHRvIHBlcmZvcm0gY2FzdCBmcm9tCiAgICAgKiB7QGxp\nbmsgQ2xhc3NNZXRhRGF0YSNnZXREZWNsYXJlZEZpZWxkfS4KICAgICAqLwog\nICAgcHVibGljIEZpZWxkTWFwcGluZyBnZXREZWNsYXJlZEZpZWxkTWFwcGlu\nZyhTdHJpbmcgbmFtZSkgewogICAgICAgIHJldHVybiAoRmllbGRNYXBwaW5n\nKSBnZXREZWNsYXJlZEZpZWxkKG5hbWUpOwogICAgfQoKICAgIC8qKgogICAg\nICogQ29udmVuaWVuY2UgbWV0aG9kIHRvIHBlcmZvcm0gY2FzdCBmcm9tCiAg\nICAgKiB7QGxpbmsgQ2xhc3NNZXRhRGF0YSNnZXREZWNsYXJlZFVubWFuYWdl\nZEZpZWxkc30uCiAgICAgKi8KICAgIHB1YmxpYyBGaWVsZE1hcHBpbmdbXSBn\nZXREZWNsYXJlZFVubWFuYWdlZEZpZWxkTWFwcGluZ3MoKSB7CiAgICAgICAg\ncmV0dXJuIChGaWVsZE1hcHBpbmdbXSkgZ2V0RGVjbGFyZWRVbm1hbmFnZWRG\naWVsZHMoKTsKICAgIH0KCiAgICAvKioKICAgICAqIENvbnZlbmllbmNlIG1l\ndGhvZCB0byBwZXJmb3JtIGNhc3QgZnJvbQogICAgICoge0BsaW5rIENsYXNz\nTWV0YURhdGEjYWRkRGVjbGFyZWRGaWVsZH0uCiAgICAgKi8KICAgIHB1Ymxp\nYyBGaWVsZE1hcHBpbmcgYWRkRGVjbGFyZWRGaWVsZE1hcHBpbmcoU3RyaW5n\nIG5hbWUsIENsYXNzIHR5cGUpIHsKICAgICAgICByZXR1cm4gKEZpZWxkTWFw\ncGluZykgYWRkRGVjbGFyZWRGaWVsZChuYW1lLCB0eXBlKTsKICAgIH0KCiAg\nICBwcm90ZWN0ZWQgdm9pZCByZXNvbHZlTWFwcGluZyhib29sZWFuIHJ1bnRp\nbWUpIHsKICAgICAgICBzdXBlci5yZXNvbHZlTWFwcGluZyhydW50aW1lKTsK\nCiAgICAgICAgLy8gbWFwIGNsYXNzIHN0cmF0ZWd5OyBpdCBtYXkgYWxyZWFk\neSBiZSBtYXBwZWQgYnkgdGhlIHJlcG9zaXRvcnkgYmVmb3JlCiAgICAgICAg\nLy8gdGhlIHJlc29sdmUgcHJvY2VzcyBiZWdpbnMKICAgICAgICBNYXBwaW5n\nUmVwb3NpdG9yeSByZXBvcyA9IGdldE1hcHBpbmdSZXBvc2l0b3J5KCk7CiAg\nICAgICAgaWYgKF9zdHJhdGVneSA9PSBudWxsKQogICAgICAgICAgICByZXBv\ncy5nZXRTdHJhdGVneUluc3RhbGxlcigpLmluc3RhbGxTdHJhdGVneSh0aGlz\nKTsKICAgICAgICBMb2cgbG9nID0gZ2V0UmVwb3NpdG9yeSgpLmdldExvZygp\nOwogICAgICAgIGlmIChsb2cuaXNUcmFjZUVuYWJsZWQoKSkKICAgICAgICAg\nICAgbG9nLnRyYWNlKF9sb2MuZ2V0KCJzdHJhdGVneSIsIHRoaXMsIF9zdHJh\ndGVneS5nZXRBbGlhcygpKSk7CgogICAgICAgIC8vIG1ha2Ugc3VyZSB1bm1h\ncHBlZCBzdXBlcmNsYXNzIGZpZWxkcyBhcmUgZGVmaW5lZCBpZiB3ZSdyZSBt\nYXBwZWQ7CiAgICAgICAgLy8gYWxzbyBtYXkgaGF2ZSBiZWVuIGRvbmUgYnkg\ncmVwb3NpdG9yeSBhbHJlYWR5CiAgICAgICAgZGVmaW5lU3VwZXJjbGFzc0Zp\nZWxkcyhnZXRKb2luYWJsZVBDU3VwZXJjbGFzc01hcHBpbmcoKSA9PSBudWxs\nKTsKCiAgICAgICAgLy8gcmVzb2x2ZSBldmVyeXRoaW5nIHRoYXQgZG9lc24n\ndCByZWx5IG9uIGFueSByZWxhdGlvbnMgdG8gYXZvaWQKICAgICAgICAvLyBy\nZWN1cnNpb24sIHRoZW4gcmVzb2x2ZSBhbGwgZmllbGRzCiAgICAgICAgcmVz\nb2x2ZU5vblJlbGF0aW9uTWFwcGluZ3MoKTsKICAgICAgICBGaWVsZE1hcHBp\nbmdbXSBmbXMgPSBnZXRGaWVsZE1hcHBpbmdzKCk7CiAgICAgICAgZm9yIChp\nbnQgaSA9IDA7IGkgPCBmbXMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAg\naWYgKGZtc1tpXS5nZXREZWZpbmluZ01ldGFEYXRhKCkgPT0gdGhpcykgewog\nICAgICAgICAgICAgICAgYm9vbGVhbiBmaWxsID0gZ2V0TWFwcGluZ1JlcG9z\naXRvcnkoKS5nZXRNYXBwaW5nRGVmYXVsdHMoKS4KICAgICAgICAgICAgICAg\nICAgICBkZWZhdWx0TWlzc2luZ0luZm8oKTsKICAgICAgICAgICAgICAgIEZv\ncmVpZ25LZXkgZmsgPSBmbXNbaV0uZ2V0Rm9yZWlnbktleSgpOwogICAgICAg\nICAgICAgICAgaWYgKGZpbGwgJiYgZmsgIT0gbnVsbCAmJiAKICAgICAgICAg\nICAgICAgICAgICBmay5nZXRQcmltYXJ5S2V5Q29sdW1ucygpLmxlbmd0aCA9\nPSAwKSB7IAogICAgICAgICAgICAgICAgICAgIC8vIHNldCByZXNvbHZlIG1v\nZGUgdG8gZm9yY2UgdGhpcyBmaWVsZCBtYXBwaW5nIHRvIGJlIAogICAgICAg\nICAgICAgICAgICAgIC8vIHJlc29sdmVkIGFnYWluLiBUaGUgbmVlZCB0byBy\nZXNvbHZlIGFnYWluIG9jY3VycyB3aGVuIAogICAgICAgICAgICAgICAgICAg\nIC8vIGEgcHJpbWFyeSBrZXkgaXMgYSByZWxhdGlvbiBmaWVsZCB3aXRoIHRo\nZSBmb3JlaWduIGtleQogICAgICAgICAgICAgICAgICAgIC8vIGFubm90YXRp\nb24uIEluIHRoaXMgc2l0dWF0aW9uLCB0aGlzIHByaW1hcnkga2V5IGZpZWxk\nCiAgICAgICAgICAgICAgICAgICAgLy8gbWFwcGluZyBpcyByZXNvbHZlZCBk\ndXJpbmcgdGhlIGNhbGwgdG8gCiAgICAgICAgICAgICAgICAgICAgLy8gcmVz\nb2x2ZU5vblJlbGF0aW9uTWFwcGluZy4gU2luY2UgaXQgaXMgYSByZWxhdGlv\nbgogICAgICAgICAgICAgICAgICAgIC8vIGZpZWxkLCB0aGUgZm9yZWlnbiBr\nZXkgd2lsbCBiZSBjb25zdHJ1Y3RlZC4gSG93ZXZlciwgCiAgICAgICAgICAg\nICAgICAgICAgLy8gdGhlIHByaW1hcnkga2V5IG9mIHRoZSBwYXJlbnQgZW50\naXR5IG1heSBub3QgaGF2ZSBiZWVuIAogICAgICAgICAgICAgICAgICAgIC8v\nIHJlc29sdmVkIHlldCwgcmVzdWx0aW5nIGluIG1pc3NpbmcgaW5mb3JtYXRp\nb24gaW4gdGhlIGZrCiAgICAgICAgICAgICAgICAgICAgZm1zW2ldLnNldFJl\nc29sdmUoTU9ERV9NRVRBKTsgCiAgICAgICAgICAgICAgICAgICAgaWYgKGZt\nc1tpXS5nZXRTdHJhdGVneSgpICE9IG51bGwpCiAgICAgICAgICAgICAgICAg\nICAgICAgIGZtc1tpXS5nZXRTdHJhdGVneSgpLm1hcChmYWxzZSk7CiAgICAg\nICAgICAgICAgICB9ICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAg\nZm1zW2ldLnJlc29sdmUoTU9ERV9NQVBQSU5HKTsKICAgICAgICAgICAgfQog\nICAgICAgIH0KICAgICAgICBmbXMgPSBnZXREZWNsYXJlZFVubWFuYWdlZEZp\nZWxkTWFwcGluZ3MoKTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGZt\ncy5sZW5ndGg7IGkrKykKICAgICAgICAgICAgZm1zW2ldLnJlc29sdmUoTU9E\nRV9NQVBQSU5HKTsKCiAgICAgICAgLy8gbWFyayBtYXBwZWQgY29sdW1ucwog\nICAgICAgIGlmIChfY29scyAhPSBudWxsKSB7CiAgICAgICAgICAgIENvbHVt\nbklPIGlvID0gZ2V0Q29sdW1uSU8oKTsKICAgICAgICAgICAgZm9yIChpbnQg\naSA9IDA7IGkgPCBfY29scy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAg\nICAgaWYgKGlvLmlzSW5zZXJ0YWJsZShpLCBmYWxzZSkpCiAgICAgICAgICAg\nICAgICAgICAgX2NvbHNbaV0uc2V0RmxhZyhDb2x1bW4uRkxBR19ESVJFQ1Rf\nSU5TRVJULCB0cnVlKTsKICAgICAgICAgICAgICAgIGlmIChpby5pc1VwZGF0\nYWJsZShpLCBmYWxzZSkpCiAgICAgICAgICAgICAgICAgICAgX2NvbHNbaV0u\nc2V0RmxhZyhDb2x1bW4uRkxBR19ESVJFQ1RfVVBEQVRFLCB0cnVlKTsKICAg\nICAgICAgICAgfQogICAgICAgIH0KICAgICAgICAvLyBvbmNlIGNvbHVtbnMg\nYXJlIHJlc29sdmVkLCByZXNvbHZlIHVuaXF1ZSBjb25zdHJhaW50cyBhcyB0\naGV5IG5lZWQKICAgICAgICAvLyB0aGUgY29sdW1ucyBiZSByZXNvbHZlZCAK\nICAgICAgICBfaW5mby5nZXRVbmlxdWVzKHRoaXMsIHRydWUpOwogICAgfQog\nICAgCiAgICAvKioKICAgICAqIFJlc29sdmUgbm9uLXJlbGF0aW9uIGZpZWxk\nIG1hcHBpbmdzIHNvIHRoYXQgd2hlbiB3ZSBkbyByZWxhdGlvbgogICAgICog\nbWFwcGluZ3MgdGhleSBjYW4gcmVseSBvbiB0aGVtIGZvciBqb2lucy4KICAg\nICAqLwogICAgdm9pZCByZXNvbHZlTm9uUmVsYXRpb25NYXBwaW5ncygpIHsK\nICAgICAgICAvLyBtYWtlIHN1cmUgcHJpbWFyeSBrZXkgZmllbGRzIGFyZSBy\nZXNvbHZlZCBmaXJzdCBiZWNhdXNlIG90aGVyCiAgICAgICAgLy8gZmllbGRz\nIG1pZ2h0IHJlbHkgb24gdGhlbQogICAgICAgIEZpZWxkTWFwcGluZ1tdIGZt\ncyA9IGdldFByaW1hcnlLZXlGaWVsZE1hcHBpbmdzKCk7CiAgICAgICAgZm9y\nIChpbnQgaSA9IDA7IGkgPCBmbXMubGVuZ3RoOyBpKyspCiAgICAgICAgICAg\nIGZtc1tpXS5yZXNvbHZlKE1PREVfTUFQUElORyk7CgogICAgICAgIC8vIHJl\nc29sdmUgZGVmaW5lZCBmaWVsZHMgdGhhdCBhcmUgc2FmZTsgdGhhdCBkb24n\ndCByZWx5IG9uIG90aGVyIHR5cGVzCiAgICAgICAgLy8gYWxzbyBiZWluZyBy\nZXNvbHZlZC4gIGRvbid0IHVzZSBnZXREZWZpbmVkRmllbGRzIGIvYyBpdCBy\nZWxpZXMgb24KICAgICAgICAvLyB3aGV0aGVyIGZpZWxkcyBhcmUgbWFwcGVk\nLCB3aGljaCBpc24ndCBrbm93biB5ZXQKICAgICAgICBmbXMgPSBnZXRGaWVs\nZE1hcHBpbmdzKCk7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBmbXMu\nbGVuZ3RoOyBpKyspCiAgICAgICAgICAgIGlmIChmbXNbaV0uZ2V0RGVmaW5p\nbmdNZXRhRGF0YSgpID09IHRoaXMKICAgICAgICAgICAgICAgICYmICFmbXNb\naV0uaXNUeXBlUEMoKSAmJiAhZm1zW2ldLmdldEtleSgpLmlzVHlwZVBDKCkK\nICAgICAgICAgICAgICAgICYmICFmbXNbaV0uZ2V0RWxlbWVudCgpLmlzVHlw\nZVBDKCkpCiAgICAgICAgICAgICAgICBmbXNbaV0ucmVzb2x2ZShNT0RFX01B\nUFBJTkcpOwoKICAgICAgICBfZGlzY3JpbS5yZXNvbHZlKE1PREVfTUFQUElO\nRyk7CiAgICAgICAgX3ZlcnNpb24ucmVzb2x2ZShNT0RFX01BUFBJTkcpOyAg\nICAgICAgCiAgICB9CgogICAgcHJvdGVjdGVkIHZvaWQgaW5pdGlhbGl6ZU1h\ncHBpbmcoKSB7CiAgICAgICAgc3VwZXIuaW5pdGlhbGl6ZU1hcHBpbmcoKTsK\nCiAgICAgICAgRmllbGRNYXBwaW5nW10gZmllbGRzID0gZ2V0RGVmaW5lZEZp\nZWxkTWFwcGluZ3MoKTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGZp\nZWxkcy5sZW5ndGg7IGkrKykKICAgICAgICAgICAgZmllbGRzW2ldLnJlc29s\ndmUoTU9ERV9NQVBQSU5HX0lOSVQpOwogICAgICAgIF9kaXNjcmltLnJlc29s\ndmUoTU9ERV9NQVBQSU5HX0lOSVQpOwogICAgICAgIF92ZXJzaW9uLnJlc29s\ndmUoTU9ERV9NQVBQSU5HX0lOSVQpOwogICAgICAgIF9zdHJhdGVneS5pbml0\naWFsaXplKCk7CiAgICB9CgogICAgcHJvdGVjdGVkIHZvaWQgY2xlYXJEZWZp\nbmVkRmllbGRDYWNoZSgpIHsKICAgICAgICAvLyBqdXN0IG1ha2UgdGhpcyBt\nZXRob2QgYXZhaWxhYmxlIHRvIG90aGVyIGNsYXNzZXMgaW4gdGhpcyBwYWNr\nYWdlCiAgICAgICAgc3VwZXIuY2xlYXJEZWZpbmVkRmllbGRDYWNoZSgpOwog\nICAgfQoKICAgIHByb3RlY3RlZCB2b2lkIGNsZWFyU3ViY2xhc3NDYWNoZSgp\nIHsKICAgICAgICBzdXBlci5jbGVhclN1YmNsYXNzQ2FjaGUoKTsKICAgICAg\nICBfam9pblN1Yk1hcHMgPSBudWxsOwogICAgICAgIF9hc3NpZ25NYXBzID0g\nbnVsbDsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBjb3B5KENsYXNzTWV0YURh\ndGEgY2xzKSB7CiAgICAgICAgc3VwZXIuY29weShjbHMpOwogICAgICAgIGlm\nIChfc3ViY2xhc3NNb2RlID09IEludGVnZXIuTUFYX1ZBTFVFKQogICAgICAg\nICAgICBfc3ViY2xhc3NNb2RlID0gKChDbGFzc01hcHBpbmcpIGNscykuZ2V0\nU3ViY2xhc3NGZXRjaE1vZGUoKTsKICAgIH0KCiAgICBwcm90ZWN0ZWQgYm9v\nbGVhbiB2YWxpZGF0ZURhdGFTdG9yZUV4dGVuc2lvblByZWZpeChTdHJpbmcg\ncHJlZml4KSB7CiAgICAgICAgcmV0dXJuICJqZGJjLSIuZXF1YWxzKHByZWZp\neCk7CiAgICB9CgogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v\nLy8KICAgIC8vIENsYXNzU3RyYXRlZ3kgaW1wbGVtZW50YXRpb24KICAgIC8v\nLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCgogICAgcHVibGljIFN0\ncmluZyBnZXRBbGlhcygpIHsKICAgICAgICByZXR1cm4gYXNzZXJ0U3RyYXRl\nZ3koKS5nZXRBbGlhcygpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIG1hcChi\nb29sZWFuIGFkYXB0KSB7CiAgICAgICAgYXNzZXJ0U3RyYXRlZ3koKS5tYXAo\nYWRhcHQpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIGluaXRpYWxpemUoKSB7\nCiAgICAgICAgYXNzZXJ0U3RyYXRlZ3koKS5pbml0aWFsaXplKCk7CiAgICB9\nCgogICAgcHVibGljIHZvaWQgaW5zZXJ0KE9wZW5KUEFTdGF0ZU1hbmFnZXIg\nc20sIEpEQkNTdG9yZSBzdG9yZSwgUm93TWFuYWdlciBybSkKICAgICAgICB0\naHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBhc3NlcnRTdHJhdGVneSgp\nLmluc2VydChzbSwgc3RvcmUsIHJtKTsKICAgIH0KCiAgICBwdWJsaWMgdm9p\nZCB1cGRhdGUoT3BlbkpQQVN0YXRlTWFuYWdlciBzbSwgSkRCQ1N0b3JlIHN0\nb3JlLCBSb3dNYW5hZ2VyIHJtKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRp\nb24gewogICAgICAgIGFzc2VydFN0cmF0ZWd5KCkudXBkYXRlKHNtLCBzdG9y\nZSwgcm0pOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIGRlbGV0ZShPcGVuSlBB\nU3RhdGVNYW5hZ2VyIHNtLCBKREJDU3RvcmUgc3RvcmUsIFJvd01hbmFnZXIg\ncm0pCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgYXNz\nZXJ0U3RyYXRlZ3koKS5kZWxldGUoc20sIHN0b3JlLCBybSk7CiAgICB9Cgog\nICAgcHVibGljIEJvb2xlYW4gaXNDdXN0b21JbnNlcnQoT3BlbkpQQVN0YXRl\nTWFuYWdlciBzbSwgSkRCQ1N0b3JlIHN0b3JlKSB7CiAgICAgICAgcmV0dXJu\nIGFzc2VydFN0cmF0ZWd5KCkuaXNDdXN0b21JbnNlcnQoc20sIHN0b3JlKTsK\nICAgIH0KCiAgICBwdWJsaWMgQm9vbGVhbiBpc0N1c3RvbVVwZGF0ZShPcGVu\nSlBBU3RhdGVNYW5hZ2VyIHNtLCBKREJDU3RvcmUgc3RvcmUpIHsKICAgICAg\nICByZXR1cm4gYXNzZXJ0U3RyYXRlZ3koKS5pc0N1c3RvbVVwZGF0ZShzbSwg\nc3RvcmUpOwogICAgfQoKICAgIHB1YmxpYyBCb29sZWFuIGlzQ3VzdG9tRGVs\nZXRlKE9wZW5KUEFTdGF0ZU1hbmFnZXIgc20sIEpEQkNTdG9yZSBzdG9yZSkg\newogICAgICAgIHJldHVybiBhc3NlcnRTdHJhdGVneSgpLmlzQ3VzdG9tRGVs\nZXRlKHNtLCBzdG9yZSk7CiAgICB9CgogICAgcHVibGljIHZvaWQgY3VzdG9t\nSW5zZXJ0KE9wZW5KUEFTdGF0ZU1hbmFnZXIgc20sIEpEQkNTdG9yZSBzdG9y\nZSkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBhc3Nl\ncnRTdHJhdGVneSgpLmN1c3RvbUluc2VydChzbSwgc3RvcmUpOwogICAgfQoK\nICAgIHB1YmxpYyB2b2lkIGN1c3RvbVVwZGF0ZShPcGVuSlBBU3RhdGVNYW5h\nZ2VyIHNtLCBKREJDU3RvcmUgc3RvcmUpCiAgICAgICAgdGhyb3dzIFNRTEV4\nY2VwdGlvbiB7CiAgICAgICAgYXNzZXJ0U3RyYXRlZ3koKS5jdXN0b21VcGRh\ndGUoc20sIHN0b3JlKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBjdXN0b21E\nZWxldGUoT3BlbkpQQVN0YXRlTWFuYWdlciBzbSwgSkRCQ1N0b3JlIHN0b3Jl\nKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIGFzc2Vy\ndFN0cmF0ZWd5KCkuY3VzdG9tRGVsZXRlKHNtLCBzdG9yZSk7CiAgICB9Cgog\nICAgcHVibGljIHZvaWQgc2V0Q2xhc3NNYXBwaW5nKENsYXNzTWFwcGluZyBv\nd25lcikgewogICAgICAgIGFzc2VydFN0cmF0ZWd5KCkuc2V0Q2xhc3NNYXBw\naW5nKG93bmVyKTsKICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBpc1ByaW1h\ncnlLZXlPYmplY3RJZChib29sZWFuIGhhc0FsbCkgewogICAgICAgIHJldHVy\nbiBhc3NlcnRTdHJhdGVneSgpLmlzUHJpbWFyeUtleU9iamVjdElkKGhhc0Fs\nbCk7CiAgICB9CgogICAgcHVibGljIEpvaW5zIGpvaW5TdXBlcmNsYXNzKEpv\naW5zIGpvaW5zLCBib29sZWFuIHRvVGhpcykgewogICAgICAgIHJldHVybiBh\nc3NlcnRTdHJhdGVneSgpLmpvaW5TdXBlcmNsYXNzKGpvaW5zLCB0b1RoaXMp\nOwogICAgfQoKICAgIHB1YmxpYyBib29sZWFuIHN1cHBvcnRzRWFnZXJTZWxl\nY3QoU2VsZWN0IHNlbCwgT3BlbkpQQVN0YXRlTWFuYWdlciBzbSwKICAgICAg\nICBKREJDU3RvcmUgc3RvcmUsIENsYXNzTWFwcGluZyBiYXNlLCBKREJDRmV0\nY2hDb25maWd1cmF0aW9uIGZldGNoKSB7CiAgICAgICAgcmV0dXJuIGFzc2Vy\ndFN0cmF0ZWd5KCkuc3VwcG9ydHNFYWdlclNlbGVjdChzZWwsIHNtLCBzdG9y\nZSwgYmFzZSwKICAgICAgICAgICAgZmV0Y2gpOwogICAgfQoKICAgIHB1Ymxp\nYyBSZXN1bHRPYmplY3RQcm92aWRlciBjdXN0b21Mb2FkKEpEQkNTdG9yZSBz\ndG9yZSwgYm9vbGVhbiBzdWJjbGFzc2VzLAogICAgICAgIEpEQkNGZXRjaENv\nbmZpZ3VyYXRpb24gZmV0Y2gsIGxvbmcgc3RhcnRJZHgsIGxvbmcgZW5kSWR4\nKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIHJldHVy\nbiBhc3NlcnRTdHJhdGVneSgpLmN1c3RvbUxvYWQoc3RvcmUsIHN1YmNsYXNz\nZXMsIGZldGNoLAogICAgICAgICAgICBzdGFydElkeCwgZW5kSWR4KTsKICAg\nIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBjdXN0b21Mb2FkKE9wZW5KUEFTdGF0\nZU1hbmFnZXIgc20sIEpEQkNTdG9yZSBzdG9yZSwKICAgICAgICBQQ1N0YXRl\nIHN0YXRlLCBKREJDRmV0Y2hDb25maWd1cmF0aW9uIGZldGNoKQogICAgICAg\nIHRocm93cyBTUUxFeGNlcHRpb24sIENsYXNzTm90Rm91bmRFeGNlcHRpb24g\newogICAgICAgIHJldHVybiBhc3NlcnRTdHJhdGVneSgpLmN1c3RvbUxvYWQo\nc20sIHN0b3JlLCBzdGF0ZSwgZmV0Y2gpOwogICAgfQoKICAgIHB1YmxpYyBi\nb29sZWFuIGN1c3RvbUxvYWQoT3BlbkpQQVN0YXRlTWFuYWdlciBzbSwgSkRC\nQ1N0b3JlIHN0b3JlLAogICAgICAgIEpEQkNGZXRjaENvbmZpZ3VyYXRpb24g\nZmV0Y2gsIFJlc3VsdCByZXN1bHQpCiAgICAgICAgdGhyb3dzIFNRTEV4Y2Vw\ndGlvbiB7CiAgICAgICAgcmV0dXJuIGFzc2VydFN0cmF0ZWd5KCkuY3VzdG9t\nTG9hZChzbSwgc3RvcmUsIGZldGNoLCByZXN1bHQpOwogICAgfQogICAgCiAg\nICBwcml2YXRlIENsYXNzU3RyYXRlZ3kgYXNzZXJ0U3RyYXRlZ3koKSB7CiAg\nICAgICAgaWYgKF9zdHJhdGVneSA9PSBudWxsKQogICAgICAgICAgICB0aHJv\ndyBuZXcgSW50ZXJuYWxFeGNlcHRpb24oKTsKICAgICAgICByZXR1cm4gX3N0\ncmF0ZWd5OwogICAgfQogICAgCiAgICAvKioKICAgICAqIEZpbmQgdGhlIGZp\nZWxkIG1hcHBpbmdzIHRoYXQgY29ycmVzcG9uZCB0byB0aGUgZ2l2ZW4gY29s\ndW1ucy4KICAgICAqIAogICAgICogQHJldHVybiBudWxsIGlmIG5vIGNvbHVt\nbnMgYXJlIGdpdmVuIG9yIG5vIGZpZWxkIG1hcHBpbmcgdXNlcyB0aGUgZ2l2\nZW4KICAgICAqIGNvbHVtbnMuCiAgICAgKi8KICAgIHByaXZhdGUgTGlzdDxG\naWVsZE1hcHBpbmc+IGdldEZpZWxkTWFwcGluZ3MoQ29sdW1uW10gY29scywg\nYm9vbGVhbiBwcmltZSkgewogICAgCWlmIChjb2xzID09IG51bGwgfHwgY29s\ncy5sZW5ndGggPT0gMCkKICAgIAkJcmV0dXJuIG51bGw7CiAgICAJTGlzdDxG\naWVsZE1hcHBpbmc+IHJlc3VsdCA9IG51bGw7CiAgICAJZm9yIChDb2x1bW4g\nYyA6IGNvbHMpIHsKICAgIAkJTGlzdDxGaWVsZE1hcHBpbmc+IGZtcyA9IGhh\nc0NvbHVtbihjLCBwcmltZSk7CiAgICAJCWlmIChmbXMgPT0gbnVsbCkgY29u\ndGludWU7CgkJCWlmIChyZXN1bHQgPT0gbnVsbCkKCQkJCXJlc3VsdCA9IG5l\ndyBBcnJheUxpc3Q8RmllbGRNYXBwaW5nPigpOwoJCQlmb3IgKEZpZWxkTWFw\ncGluZyBmbSA6IGZtcykKCQkJCWlmICghcmVzdWx0LmNvbnRhaW5zKGZtKSkK\nCQkJCQlyZXN1bHQuYWRkKGZtKTsKICAgIAl9CiAgICAJcmV0dXJuIHJlc3Vs\ndDsKICAgIH0KICAgIAogICAgLyoqCiAgICAgKiBMb29rcyB1cCBpbiByZXZl\ncnNlIHRvIGZpbmQgdGhlIGxpc3Qgb2YgZmllbGQgbWFwcGluZ3MgdGhhdCBp\nbmNsdWRlIHRoZQogICAgICogZ2l2ZW4gY29sdW1uLiBDb3N0bHkuCiAgICAg\nKiAKICAgICAqIEByZXR1cm4gbnVsbCBpZiBubyBmaWVsZCBtYXBwaW5ncyBj\nYXJyeSB0aGlzIGNvbHVtbi4gCiAgICAgKi8KICAgIHByaXZhdGUgTGlzdDxG\naWVsZE1hcHBpbmc+IGhhc0NvbHVtbihDb2x1bW4gYywgYm9vbGVhbiBwcmlt\nZSkgewogICAgCUxpc3Q8RmllbGRNYXBwaW5nPiByZXN1bHQgPSBudWxsOwog\nICAgCUZpZWxkTWFwcGluZ1tdIGZtcyA9IChwcmltZSkgPyAKICAgIAkJZ2V0\nUHJpbWFyeUtleUZpZWxkTWFwcGluZ3MoKSA6IGdldEZpZWxkTWFwcGluZ3Mo\nKTsKICAgIAlmb3IgKEZpZWxkTWFwcGluZyBmbSA6IGZtcykgewogICAgCQlD\nb2x1bW5bXSBjb2xzID0gZm0uZ2V0Q29sdW1ucygpOwogICAgCQlpZiAoY29u\ndGFpbnMoY29scywgYykpIHsKICAgIAkJCWlmIChyZXN1bHQgPT0gbnVsbCkK\nICAgIAkJCQlyZXN1bHQgPSBuZXcgQXJyYXlMaXN0PEZpZWxkTWFwcGluZz4o\nKTsKICAgIAkJCXJlc3VsdC5hZGQoZm0pOwogICAgCQl9CiAgICAJfQogICAg\nCXJldHVybiByZXN1bHQ7CiAgICB9CiAgICAKICAgIGJvb2xlYW4gY29udGFp\nbnMoQ29sdW1uW10gY29scywgQ29sdW1uIGMpIHsKICAgIAlmb3IgKENvbHVt\nbiBjb2wgOiBjb2xzKQogICAgCQlpZiAoY29sID09IGMpCiAgICAJCQlyZXR1\ncm4gdHJ1ZTsKICAgIAlyZXR1cm4gZmFsc2U7CiAgICB9CiAgICAKICAgIC8q\nKgogICAgICogR2V0cyB0aGUgZmllbGQgdmFsdWVzIG9mIHRoZSBnaXZlbiBp\nbnN0YW5jZSBmb3IgdGhlIGdpdmVuIGNvbHVtbnMuCiAgICAgKiBUaGUgZ2l2\nZW4gY29sdW1ucyBhcmUgdXNlZCB0byBpZGVudGlmeSB0aGUgZmllbGRzIGJ5\nIGEgcmV2ZXJzZSBsb29rdXAuCiAgICAgKiAgCiAgICAgKiBAcmV0dXJuIGEg\nc2luZ2xlIG9iamVjdCBvciBhbiBhcnJheSBvZiBvYmplY3RzIGJhc2VkIG9u\nIG51bWJlciBvZiAKICAgICAqIGZpZWxkcyB0aGUgZ2l2ZW4gY29sdW1ucyBy\nZXByZXNlbnQuCiAgICAgKi8KICAgIHByaXZhdGUgT2JqZWN0IGdldFZhbHVl\nRnJvbVVubWFuYWdlZEluc3RhbmNlKE9iamVjdCBvYmosIENvbHVtbltdIGNv\nbHMsIAogICAgCQlib29sZWFuIHByaW1lKSB7CiAgICAJTGlzdDxGaWVsZE1h\ncHBpbmc+IGZtcyA9IGdldEZpZWxkTWFwcGluZ3MoY29scywgcHJpbWUpOwog\nICAgCWlmIChmbXMgPT0gbnVsbCkKICAgIAkJcmV0dXJuIG51bGw7CiAgICAJ\naWYgKGZtcy5zaXplKCkgPT0gMSkKICAgIAkJcmV0dXJuIFJlZmxlY3Rpb24u\nZ2V0VmFsdWUob2JqLCBmbXMuZ2V0KDApLmdldE5hbWUoKSwgdHJ1ZSk7CiAg\nICAJT2JqZWN0W10gcmVzdWx0ID0gbmV3IE9iamVjdFtmbXMuc2l6ZSgpXTsK\nICAgIAlpbnQgaSA9IDA7CiAgICAJZm9yIChGaWVsZE1hcHBpbmcgZm0gOiBm\nbXMpIHsKICAgIAkJcmVzdWx0W2krK10gPSBSZWZsZWN0aW9uLmdldFZhbHVl\nKG9iaiwgZm0uZ2V0TmFtZSgpLCB0cnVlKTsKICAgIAl9CiAgICAJcmV0dXJu\nIHJlc3VsdDsKICAgIH0KfQo=\n","encoding":"base64"}

