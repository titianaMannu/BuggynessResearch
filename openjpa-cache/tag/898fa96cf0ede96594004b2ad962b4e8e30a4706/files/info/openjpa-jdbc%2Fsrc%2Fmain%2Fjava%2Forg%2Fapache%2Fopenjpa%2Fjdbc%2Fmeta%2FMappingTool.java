{"sha":"9c741d7163bbe61f133a2f512c631a4c189a7737","node_id":"MDQ6QmxvYjIwNjM2NDo5Yzc0MWQ3MTYzYmJlNjFmMTMzYTJmNTEyYzYzMWE0YzE4OWE3NzM3","size":43144,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/9c741d7163bbe61f133a2f512c631a4c189a7737","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhOwoKaW1wb3J0\nIGphdmEuaW8uRmlsZTsKaW1wb3J0IGphdmEuaW8uSU9FeGNlcHRpb247Cmlt\ncG9ydCBqYXZhLmlvLlByaW50V3JpdGVyOwppbXBvcnQgamF2YS5pby5Xcml0\nZXI7CmltcG9ydCBqYXZhLnNlY3VyaXR5LkFjY2Vzc0NvbnRyb2xsZXI7Cmlt\ncG9ydCBqYXZhLnNlY3VyaXR5LlByaXZpbGVnZWRBY3Rpb25FeGNlcHRpb247\nCmltcG9ydCBqYXZhLnNxbC5TUUxFeGNlcHRpb247CmltcG9ydCBqYXZhLnV0\naWwuQXJyYXlzOwppbXBvcnQgamF2YS51dGlsLkNvbGxlY3Rpb247CmltcG9y\ndCBqYXZhLnV0aWwuSGFzaE1hcDsKaW1wb3J0IGphdmEudXRpbC5IYXNoU2V0\nOwppbXBvcnQgamF2YS51dGlsLkl0ZXJhdG9yOwppbXBvcnQgamF2YS51dGls\nLk1hcDsKaW1wb3J0IGphdmEudXRpbC5TZXQ7CgppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLmNvbmYuT3BlbkpQQUNvbmZpZ3VyYXRpb247CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEuamRiYy5jb25mLkpEQkNDb25maWd1cmF0aW9u\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuY29uZi5KREJDQ29u\nZmlndXJhdGlvbkltcGw7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRi\nYy5rZXJuZWwuSkRCQ1NlcTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5q\nZGJjLnNjaGVtYS5Db2x1bW47CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\namRiYy5zY2hlbWEuRHluYW1pY1NjaGVtYUZhY3Rvcnk7CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hlbWEuTGF6eVNjaGVtYUZhY3Rvcnk7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hlbWEuU2NoZW1h\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1hLlNjaGVt\nYUdlbmVyYXRvcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNj\naGVtYS5TY2hlbWFHcm91cDsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5q\nZGJjLnNjaGVtYS5TY2hlbWFTZXJpYWxpemVyOwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLmpkYmMuc2NoZW1hLlNjaGVtYVRvb2w7CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hlbWEuVGFibGU7CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hlbWEuWE1MU2NoZW1hU2VyaWFsaXpl\ncjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNxbC5EQkRpY3Rp\nb25hcnk7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLlNlcTsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIuY29uZi5Db25maWd1cmF0\naW9uczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIubG9nLkxvZzsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIubWV0YS5DbGFzc0FyZ1Bh\ncnNlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIubWV0YS5NZXRh\nRGF0YVNlcmlhbGl6ZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGli\nLm1ldGEuU291cmNlVHJhY2tlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3Blbmpw\nYS5saWIudXRpbC5GaWxlczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5s\naWIudXRpbC5KMkRvUHJpdkhlbHBlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5saWIudXRpbC5Mb2NhbGl6ZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEubGliLnV0aWwuT3B0aW9uczsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5saWIudXRpbC5TZXJ2aWNlczsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5tZXRhLkNsYXNzTWV0YURhdGE7CmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEubWV0YS5GaWVsZE1ldGFEYXRhOwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLm1ldGEuSmF2YVR5cGVzOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLm1ldGEuTWV0YURhdGFGYWN0b3J5OwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLm1ldGEuTWV0YURhdGFNb2RlczsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS5tZXRhLk1ldGFEYXRhUmVwb3NpdG9yeTsKaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS5tZXRhLlF1ZXJ5TWV0YURhdGE7CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEubWV0YS5TZXF1ZW5jZU1ldGFEYXRhOwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuVmFsdWVTdHJhdGVnaWVzOwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuR2VuZXJhbEV4Y2VwdGlvbjsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLkludGVybmFsRXhjZXB0\naW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuTWV0YURhdGFF\neGNlcHRpb247CgovKioKICogVG9vbCBmb3IgbWFuaXB1bGF0aW5nIGNsYXNz\nIG1hcHBpbmdzIGFuZCBhc3NvY2lhdGVkIHNjaGVtYS4KICoKICogQGF1dGhv\nciBBYmUgV2hpdGUKICovCnB1YmxpYyBjbGFzcyBNYXBwaW5nVG9vbAogICAg\naW1wbGVtZW50cyBNZXRhRGF0YU1vZGVzIHsKCiAgICBwdWJsaWMgc3RhdGlj\nIGZpbmFsIFN0cmluZyBTQ0hFTUFfQUNUSU9OX05PTkUgPSAibm9uZSI7Cgog\nICAgcHVibGljIHN0YXRpYyBmaW5hbCBTdHJpbmcgQUNUSU9OX0FERCA9ICJh\nZGQiOwogICAgcHVibGljIHN0YXRpYyBmaW5hbCBTdHJpbmcgQUNUSU9OX1JF\nRlJFU0ggPSAicmVmcmVzaCI7CiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIFN0\ncmluZyBBQ1RJT05fQlVJTERfU0NIRU1BID0gImJ1aWxkU2NoZW1hIjsKICAg\nIHB1YmxpYyBzdGF0aWMgZmluYWwgU3RyaW5nIEFDVElPTl9EUk9QID0gImRy\nb3AiOwogICAgcHVibGljIHN0YXRpYyBmaW5hbCBTdHJpbmcgQUNUSU9OX1ZB\nTElEQVRFID0gInZhbGlkYXRlIjsKICAgIHB1YmxpYyBzdGF0aWMgZmluYWwg\nU3RyaW5nIEFDVElPTl9FWFBPUlQgPSAiZXhwb3J0IjsKICAgIHB1YmxpYyBz\ndGF0aWMgZmluYWwgU3RyaW5nIEFDVElPTl9JTVBPUlQgPSAiaW1wb3J0IjsK\nCiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIFN0cmluZ1tdIEFDVElPTlMgPSBu\nZXcgU3RyaW5nW117CiAgICAgICAgQUNUSU9OX0FERCwKICAgICAgICBBQ1RJ\nT05fUkVGUkVTSCwKICAgICAgICBBQ1RJT05fQlVJTERfU0NIRU1BLAogICAg\nICAgIEFDVElPTl9EUk9QLAogICAgICAgIEFDVElPTl9WQUxJREFURSwKICAg\nICAgICBBQ1RJT05fRVhQT1JULAogICAgICAgIEFDVElPTl9JTVBPUlQsCiAg\nICB9OwoKICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIExvY2FsaXplciBfbG9j\nID0KICAgICAgICBMb2NhbGl6ZXIuZm9yUGFja2FnZShNYXBwaW5nVG9vbC5j\nbGFzcyk7CgogICAgcHJpdmF0ZSBmaW5hbCBKREJDQ29uZmlndXJhdGlvbiBf\nY29uZjsKICAgIHByaXZhdGUgZmluYWwgTG9nIF9sb2c7CiAgICBwcml2YXRl\nIGZpbmFsIFN0cmluZyBfYWN0aW9uOwogICAgcHJpdmF0ZSBmaW5hbCBib29s\nZWFuIF9tZXRhOwogICAgcHJpdmF0ZSBmaW5hbCBpbnQgX21vZGU7CiAgICBw\ncml2YXRlIGZpbmFsIERCRGljdGlvbmFyeSBfZGljdDsKCiAgICBwcml2YXRl\nIE1hcHBpbmdSZXBvc2l0b3J5IF9yZXBvcyA9IG51bGw7CiAgICBwcml2YXRl\nIFNjaGVtYUdyb3VwIF9zY2hlbWEgPSBudWxsOwogICAgcHJpdmF0ZSBTY2hl\nbWFUb29sIF9zY2hlbWFUb29sID0gbnVsbDsKICAgIHByaXZhdGUgU3RyaW5n\nIF9zY2hlbWFBY3Rpb25zID0gU2NoZW1hVG9vbC5BQ1RJT05fQUREOwogICAg\ncHJpdmF0ZSBib29sZWFuIF9yZWFkU2NoZW1hID0gZmFsc2U7CiAgICBwcml2\nYXRlIGJvb2xlYW4gX3BrcyA9IGZhbHNlOwogICAgcHJpdmF0ZSBib29sZWFu\nIF9ma3MgPSBmYWxzZTsKICAgIHByaXZhdGUgYm9vbGVhbiBfaW5kZXhlcyA9\nIGZhbHNlOwogICAgcHJpdmF0ZSBib29sZWFuIF9zZXFzID0gdHJ1ZTsKICAg\nIHByaXZhdGUgYm9vbGVhbiBfZHJvcFVudXNlZCA9IHRydWU7CiAgICBwcml2\nYXRlIGJvb2xlYW4gX2lnbm9yZUVycm9ycyA9IGZhbHNlOwogICAgcHJpdmF0\nZSBGaWxlIF9maWxlID0gbnVsbDsKICAgIHByaXZhdGUgV3JpdGVyIF9tYXBw\naW5nV3JpdGVyID0gbnVsbDsKICAgIHByaXZhdGUgV3JpdGVyIF9zY2hlbWFX\ncml0ZXIgPSBudWxsOwoKICAgIC8vIGJ1ZmZlciBtZXRhZGF0YXMgdG8gYmUg\nZHJvcHBlZAogICAgcHJpdmF0ZSBTZXQ8Q2xhc3M8Pz4+IF9kcm9wQ2xzID0g\nbnVsbDsKICAgIHByaXZhdGUgU2V0PENsYXNzTWFwcGluZz4gX2Ryb3BNYXAg\nPSBudWxsOwogICAgcHJpdmF0ZSBib29sZWFuIF9mbHVzaCA9IGZhbHNlOwog\nICAgcHJpdmF0ZSBib29sZWFuIF9mbHVzaFNjaGVtYSA9IGZhbHNlOwoKICAg\nIC8qKgogICAgICogQ29uc3RydWN0b3IuIFN1cHBseSBjb25maWd1cmF0aW9u\nIGFuZCBhY3Rpb24uCiAgICAgKi8KICAgIHB1YmxpYyBNYXBwaW5nVG9vbChK\nREJDQ29uZmlndXJhdGlvbiBjb25mLCBTdHJpbmcgYWN0aW9uLCBib29sZWFu\nIG1ldGEpIHsKICAgICAgICBfY29uZiA9IGNvbmY7CiAgICAgICAgX2xvZyA9\nIGNvbmYuZ2V0TG9nKEpEQkNDb25maWd1cmF0aW9uLkxPR19NRVRBREFUQSk7\nCiAgICAgICAgX21ldGEgPSBtZXRhOwoKICAgICAgICBpZiAoYWN0aW9uID09\nIG51bGwpCiAgICAgICAgICAgIF9hY3Rpb24gPSBBQ1RJT05fUkVGUkVTSDsK\nICAgICAgICBlbHNlIGlmICghQXJyYXlzLmFzTGlzdChBQ1RJT05TKS5jb250\nYWlucyhhY3Rpb24pKQogICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFy\nZ3VtZW50RXhjZXB0aW9uKCJhY3Rpb24gPT0gIiArIGFjdGlvbik7CiAgICAg\nICAgZWxzZQogICAgICAgICAgICBfYWN0aW9uID0gYWN0aW9uOwoKICAgICAg\nICBpZiAobWV0YSAmJiBBQ1RJT05fQURELmVxdWFscyhfYWN0aW9uKSkKICAg\nICAgICAgICAgX21vZGUgPSBNT0RFX01FVEE7CiAgICAgICAgZWxzZSBpZiAo\nbWV0YSAmJiBBQ1RJT05fRFJPUC5lcXVhbHMoX2FjdGlvbikpCiAgICAgICAg\nICAgIF9tb2RlID0gTU9ERV9NRVRBIHwgTU9ERV9NQVBQSU5HIHwgTU9ERV9R\nVUVSWTsKICAgICAgICBlbHNlCiAgICAgICAgICAgIF9tb2RlID0gTU9ERV9N\nQVBQSU5HOwoKICAgICAgICBfZGljdCA9IF9jb25mLmdldERCRGljdGlvbmFy\neUluc3RhbmNlKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBUaGUgYWN0aW9u\nIHN1cHBsaWVkIG9uIGNvbnN0cnVjdGlvbi4KICAgICAqLwogICAgcHVibGlj\nIFN0cmluZyBnZXRBY3Rpb24oKSB7CiAgICAgICAgcmV0dXJuIF9hY3Rpb247\nCiAgICB9CgogICAgLyoqCiAgICAgKiBXaGV0aGVyIHRoZSBhY3Rpb24gd29y\na3Mgb24gbWV0YWRhdGEgYXMgd2VsbCBhcyBtYXBwaW5ncy4KICAgICAqLwog\nICAgcHVibGljIGJvb2xlYW4gaXNNZXRhRGF0YUFjdGlvbigpIHsKICAgICAg\nICByZXR1cm4gX21ldGE7CiAgICB9CgogICAgLyoqCiAgICAgKiBUaGUgc2No\nZW1hIG1vZGlmaWNhdGlvbiBwb2xpY3ksIG9yIDxjb2RlPm5vbmU8L2NvZGU+\nLiBTZWUgdGhlCiAgICAgKiBBQ1RJT04gY29uc3RhbnRzIGluIHtAbGluayBT\nY2hlbWFUb29sfS4gTWF5IGJlIGEgY29tbWEtc2VwYXJhdGVkCiAgICAgKiBs\naXN0IG9mIHZhbHVlcy4gRGVmYXVsdHMgdG8ge0BsaW5rIFNjaGVtYVRvb2wj\nQUNUSU9OX0FERH0uCiAgICAgKi8KICAgIHB1YmxpYyBTdHJpbmcgZ2V0U2No\nZW1hQWN0aW9uKCkgewogICAgICAgIHJldHVybiBfc2NoZW1hQWN0aW9uczsK\nICAgIH0KCiAgICAvKioKICAgICAqIFRoZSBzY2hlbWEgbW9kaWZpY2F0aW9u\nIHBvbGljeSwgb3IgPGNvZGU+bm9uZTwvY29kZT4uIFNlZSB0aGUKICAgICAq\nIEFDVElPTiBjb25zdGFudHMgaW4ge0BsaW5rIFNjaGVtYVRvb2x9LiBNYXkg\nYmUgYSBjb21tYS1zZXBhcmF0ZWQKICAgICAqIGxpc3Qgb2YgdmFsdWVzLiBE\nZWZhdWx0cyB0byB7QGxpbmsgU2NoZW1hVG9vbCNBQ1RJT05fQUREfS4KICAg\nICAqLwogICAgcHVibGljIHZvaWQgc2V0U2NoZW1hQWN0aW9uKFN0cmluZyBz\nY2hlbWFBY3Rpb24pIHsKICAgICAgICBfc2NoZW1hQWN0aW9ucyA9IHNjaGVt\nYUFjdGlvbjsKICAgIH0KCiAgICAvKioKICAgICAqIFNldCB0byB0cnVlIHRv\nIHJlYWQgdGhlIGVudGlyZSBzY2hlbWEgYmVmb3JlIG1hcHBpbmcuCiAgICAg\nKiBMZWF2aW5nIHRoaXMgb3B0aW9uIGZhbHNlIHNhdmVzIHRpbWUsIGJ1dCBp\ncyBkYW5nZXJvdXMgd2hlbiBhZGRpbmcKICAgICAqIG5ldyBtYXBwaW5ncywg\nYmVjYXVzZSB3aXRob3V0IGZ1bGwga25vd2xlZGdlIG9mIHRoZSBleGlzdGlu\nZyBzY2hlbWEgdGhlCiAgICAgKiBtYXBwaW5nIHRvb2wgbWlnaHQgY3JlYXRl\nIHRhYmxlcyBvciBpbmRleGVzIHRoYXQgY29uZmxpY3Qgd2l0aAogICAgICog\nZXhpc3RpbmcgY29tcG9uZW50cy4KICAgICAqLwogICAgcHVibGljIGJvb2xl\nYW4gZ2V0UmVhZFNjaGVtYSgpIHsKICAgICAgICByZXR1cm4gX3JlYWRTY2hl\nbWE7CiAgICB9CgogICAgLyoqCiAgICAgKiBTZXQgdG8gdHJ1ZSB0byByZWFk\nIHRoZSBlbnRpcmUgc2NoZW1hIGJlZm9yZSBtYXBwaW5nLgogICAgICogTGVh\ndmluZyB0aGlzIG9wdGlvbiBmYWxzZSBzYXZlcyB0aW1lLCBidXQgaXMgZGFu\nZ2Vyb3VzIHdoZW4gYWRkaW5nCiAgICAgKiBuZXcgbWFwcGluZ3MsIGJlY2F1\nc2Ugd2l0aG91dCBmdWxsIGtub3dsZWRnZSBvZiB0aGUgZXhpc3Rpbmcgc2No\nZW1hIHRoZQogICAgICogbWFwcGluZyB0b29sIG1pZ2h0IGNyZWF0ZSB0YWJs\nZXMgb3IgaW5kZXhlcyB0aGF0IGNvbmZsaWN0IHdpdGgKICAgICAqIGV4aXN0\naW5nIGNvbXBvbmVudHMuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldFJl\nYWRTY2hlbWEoYm9vbGVhbiByZWFkU2NoZW1hKSB7CiAgICAgICAgX3JlYWRT\nY2hlbWEgPSByZWFkU2NoZW1hOwogICAgfQoKICAgIC8qKgogICAgICogV2hl\ndGhlciB0byBtYW5pcHVsYXRlIHNlcXVlbmNlcy4gRGVmYXVsdHMgdG8gdHJ1\nZS4KICAgICAqLwogICAgcHVibGljIGJvb2xlYW4gZ2V0U2VxdWVuY2VzKCkg\newogICAgICAgIHJldHVybiBfc2VxczsKICAgIH0KCiAgICAvKioKICAgICAq\nIFdoZXRoZXIgdG8gbWFuaXB1bGF0ZSBzZXF1ZW5jZXMuIERlZmF1bHRzIHRv\nIHRydWUuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldFNlcXVlbmNlcyhi\nb29sZWFuIHNlcXMpIHsKICAgICAgICBfc2VxcyA9IHNlcXM7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBXaGV0aGVyIGluZGV4ZXMgb24gZXhpc3RpbmcgdGFi\nbGVzIHNob3VsZCBiZSBtYW5pcHVsYXRlZC4KICAgICAqIERlZmF1bHRzIHRv\nIGZhbHNlLgogICAgICovCiAgICBwdWJsaWMgYm9vbGVhbiBnZXRJbmRleGVz\nKCkgewogICAgICAgIHJldHVybiBfaW5kZXhlczsKICAgIH0KCiAgICAvKioK\nICAgICAqIFdoZXRoZXIgaW5kZXhlcyBvbiBleGlzdGluZyB0YWJsZXMgc2hv\ndWxkIGJlIG1hbmlwdWxhdGVkLgogICAgICogRGVmYXVsdHMgdG8gZmFsc2Uu\nCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldEluZGV4ZXMoYm9vbGVhbiBp\nbmRleGVzKSB7CiAgICAgICAgX2luZGV4ZXMgPSBpbmRleGVzOwogICAgfQoK\nICAgIC8qKgogICAgICogV2hldGhlciBmb3JlaWduIGtleXMgb24gZXhpc3Rp\nbmcgdGFibGVzIHNob3VsZCBiZSBtYW5pcHVsYXRlZC4KICAgICAqIERlZmF1\nbHRzIHRvIGZhbHNlLgogICAgICovCiAgICBwdWJsaWMgYm9vbGVhbiBnZXRG\nb3JlaWduS2V5cygpIHsKICAgICAgICByZXR1cm4gX2ZrczsKICAgIH0KCiAg\nICAvKioKICAgICAqIFdoZXRoZXIgZm9yZWlnbiBrZXlzIG9uIGV4aXN0aW5n\nIHRhYmxlcyBzaG91bGQgYmUgbWFuaXB1bGF0ZWQuCiAgICAgKiBEZWZhdWx0\ncyB0byBmYWxzZS4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0Rm9yZWln\nbktleXMoYm9vbGVhbiBma3MpIHsKICAgICAgICBfZmtzID0gZmtzOwogICAg\nfQoKICAgIC8qKgogICAgICogV2hldGhlciBwcmltYXJ5IGtleXMgb24gZXhp\nc3RpbmcgdGFibGVzIHNob3VsZCBiZSBtYW5pcHVsYXRlZC4KICAgICAqIERl\nZmF1bHRzIHRvIGZhbHNlLgogICAgICovCiAgICBwdWJsaWMgYm9vbGVhbiBn\nZXRQcmltYXJ5S2V5cygpIHsKICAgICAgICByZXR1cm4gX3BrczsKICAgIH0K\nCiAgICAvKioKICAgICAqIFdoZXRoZXIgcHJpbWFyeSBrZXlzIG9uIGV4aXN0\naW5nIHRhYmxlcyBzaG91bGQgYmUgbWFuaXB1bGF0ZWQuCiAgICAgKiBEZWZh\ndWx0cyB0byBmYWxzZS4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0UHJp\nbWFyeUtleXMoYm9vbGVhbiBwa3MpIHsKICAgICAgICBfcGtzID0gcGtzOwog\nICAgfQoKICAgIC8qKgogICAgICogV2hldGhlciBzY2hlbWEgY29tcG9uZW50\ncyB0aGF0IGFyZSB1bnVzZWQgYnkgYW55IG1hcHBpbmcgd2lsbCBiZQogICAg\nICogZHJvcHBlZCBmcm9tIHRoaXMgdG9vbCdzIHtAbGluayBTY2hlbWFHcm91\ncH0sIGFuZCwgZGVwZW5kaW5nIG9uCiAgICAgKiB0aGUgc2NoZW1hIGFjdGlv\nbiwgZnJvbSB0aGUgZGF0YWJhc2UuIERlZmF1bHRzIHRvIHRydWUuCiAgICAg\nKi8KICAgIHB1YmxpYyBib29sZWFuIGdldERyb3BVbnVzZWRDb21wb25lbnRz\nKCkgewogICAgICAgIHJldHVybiBfZHJvcFVudXNlZDsKICAgIH0KCiAgICAv\nKioKICAgICAqIFdoZXRoZXIgc2NoZW1hIGNvbXBvbmVudHMgdGhhdCBhcmUg\ndW51c2VkIGJ5IGFueSBtYXBwaW5nIHdpbGwgYmUKICAgICAqIGRyb3BwZWQg\nZnJvbSB0aGlzIHRvb2wncyB7QGxpbmsgU2NoZW1hR3JvdXB9LCBhbmQsIGRl\ncGVuZGluZyBvbgogICAgICogdGhlIHNjaGVtYSBhY3Rpb24sIGZyb20gdGhl\nIGRhdGFiYXNlLiBEZWZhdWx0cyB0byB0cnVlLgogICAgICovCiAgICBwdWJs\naWMgdm9pZCBzZXREcm9wVW51c2VkQ29tcG9uZW50cyhib29sZWFuIGRyb3BV\nbnVzZWQpIHsKICAgICAgICBfZHJvcFVudXNlZCA9IGRyb3BVbnVzZWQ7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBXaGV0aGVyIGFuZCBTUUwgZXJyb3JzIHNo\nb3VsZCBjYXVzZSBhIGZhaWx1cmUgb3IganVzdCBpc3N1ZSBhIHdhcm5pbmcu\nCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldElnbm9yZUVycm9ycyhib29s\nZWFuIGlnbm9yZUVycm9ycykgewogICAgICAgIF9pZ25vcmVFcnJvcnMgPSBp\nZ25vcmVFcnJvcnM7CiAgICB9CgogICAgLyoqCiAgICAgKiBXaGV0aGVyIGFu\nZCBTUUwgZXJyb3JzIHNob3VsZCBjYXVzZSBhIGZhaWx1cmUgb3IganVzdCBp\nc3N1ZSBhIHdhcm5pbmcuCiAgICAgKi8KICAgIHB1YmxpYyBib29sZWFuIGdl\ndElnbm9yZUVycm9ycygpIHsKICAgICAgICByZXR1cm4gX2lnbm9yZUVycm9y\nczsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgc2NoZW1hIHRv\nb2wgdG8gdXNlIGZvciBzY2hlbWEgbW9kaWZpY2F0aW9uLgogICAgICovCiAg\nICBwcml2YXRlIFNjaGVtYVRvb2wgbmV3U2NoZW1hVG9vbChTdHJpbmcgYWN0\naW9uKSB7CiAgICAgICAgaWYgKFNDSEVNQV9BQ1RJT05fTk9ORS5lcXVhbHMo\nYWN0aW9uKSkKICAgICAgICAgICAgYWN0aW9uID0gbnVsbDsKICAgICAgICBT\nY2hlbWFUb29sIHRvb2wgPSBuZXcgU2NoZW1hVG9vbChfY29uZiwgYWN0aW9u\nKTsKICAgICAgICB0b29sLnNldElnbm9yZUVycm9ycyhnZXRJZ25vcmVFcnJv\ncnMoKSk7CiAgICAgICAgdG9vbC5zZXRQcmltYXJ5S2V5cyhnZXRQcmltYXJ5\nS2V5cygpKTsKICAgICAgICB0b29sLnNldEZvcmVpZ25LZXlzKGdldEZvcmVp\nZ25LZXlzKCkpOwogICAgICAgIHRvb2wuc2V0SW5kZXhlcyhnZXRJbmRleGVz\nKCkpOwogICAgICAgIHRvb2wuc2V0U2VxdWVuY2VzKGdldFNlcXVlbmNlcygp\nKTsKICAgICAgICByZXR1cm4gdG9vbDsKICAgIH0KCiAgICAvKioKICAgICAq\nIFNldCB0aGUgc2NoZW1hIHRvb2wgdG8gdXNlIGZvciBzY2hlbWEgbW9kaWZp\nY2F0aW9uLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRTY2hlbWFUb29s\nKFNjaGVtYVRvb2wgdG9vbCkgewogICAgICAgIF9zY2hlbWFUb29sID0gdG9v\nbDsKICAgIH0KCiAgICAvKioKICAgICAqIFRoZSBzdHJlYW0gdG8gZXhwb3J0\nIHRoZSBwbGFubmVkIHNjaGVtYSB0byBhcyBhbiBYTUwgZG9jdW1lbnQuCiAg\nICAgKiBJZiBub24tbnVsbCwgdGhlbiB0aGUgZGF0YWJhc2Ugc2NoZW1hIHdp\nbGwgbm90IGJlIGFsdGVyZWQuCiAgICAgKi8KICAgIHB1YmxpYyBXcml0ZXIg\nZ2V0U2NoZW1hV3JpdGVyKCkgewogICAgICAgIHJldHVybiBfc2NoZW1hV3Jp\ndGVyOwogICAgfQoKICAgIC8qKgogICAgICogVGhlIHN0cmVhbSB0byBleHBv\ncnQgdGhlIHBsYW5uZWQgc2NoZW1hIHRvIGFzIGFuIFhNTCBkb2N1bWVudC4K\nICAgICAqIElmIG5vbi1udWxsLCB0aGVuIHRoZSBkYXRhYmFzZSBzY2hlbWEg\nd2lsbCBub3QgYmUgYWx0ZXJlZC4KICAgICAqLwogICAgcHVibGljIHZvaWQg\nc2V0U2NoZW1hV3JpdGVyKFdyaXRlciBzY2hlbWFXcml0ZXIpIHsKICAgICAg\nICBfc2NoZW1hV3JpdGVyID0gc2NoZW1hV3JpdGVyOwogICAgfQoKICAgIC8q\nKgogICAgICogVGhlIHN0cmVhbSB0byBleHBvcnQgdGhlIHBsYW5uZWQgbWFw\ncGluZ3MgdG8gYXMgYW4gWE1MIGRvY3VtZW50LgogICAgICogSWYgbm9uLW51\nbGwsIHRoZW4gdGhlIG1hcHBpbmcgcmVwb3NpdG9yeSB3aWxsIG5vdCBiZSBh\nbHRlcmVkLgogICAgICovCiAgICBwdWJsaWMgV3JpdGVyIGdldE1hcHBpbmdX\ncml0ZXIoKSB7CiAgICAgICAgcmV0dXJuIF9tYXBwaW5nV3JpdGVyOwogICAg\nfQoKICAgIC8qKgogICAgICogVGhlIHN0cmVhbSB0byBleHBvcnQgdGhlIHBs\nYW5uZWQgbWFwcGluZ3MgdG8gYXMgYW4gWE1MIGRvY3VtZW50LgogICAgICog\nSWYgbm9uLW51bGwsIHRoZW4gdGhlIG1hcHBpbmcgcmVwb3NpdG9yeSB3aWxs\nIG5vdCBiZSBhbHRlcmVkLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRN\nYXBwaW5nV3JpdGVyKFdyaXRlciBtYXBwaW5nV3JpdGVyKSB7CiAgICAgICAg\nX21hcHBpbmdXcml0ZXIgPSBtYXBwaW5nV3JpdGVyOwogICAgfQoKICAgIC8q\nKgogICAgICogSWYgYWRkaW5nIG1ldGFkYXRhLCB0aGUgbWV0YWRhdGEgZmls\nZSB0byBhZGQgdG8uCiAgICAgKi8KICAgIHB1YmxpYyBGaWxlIGdldE1ldGFE\nYXRhRmlsZSgpIHsKICAgICAgICByZXR1cm4gX2ZpbGU7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBJZiBhZGRpbmcgbWV0YWRhdGEsIHRoZSBtZXRhZGF0YSBm\naWxlIHRvIGFkZCB0by4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0TWV0\nYURhdGFGaWxlKEZpbGUgZmlsZSkgewogICAgICAgIF9maWxlID0gZmlsZTsK\nICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgcmVwb3NpdG9yeSB0\nbyB1c2UgdG8gYWNjZXNzIG1hcHBpbmcgaW5mb3JtYXRpb24uCiAgICAgKiBE\nZWZhdWx0cyB0byBhIG5ldyB7QGxpbmsgTWFwcGluZ1JlcG9zaXRvcnl9Lgog\nICAgICovCiAgICBwdWJsaWMgTWFwcGluZ1JlcG9zaXRvcnkgZ2V0UmVwb3Np\ndG9yeSgpIHsKICAgICAgICBpZiAoX3JlcG9zID09IG51bGwpIHsKICAgICAg\nICAgICAgX3JlcG9zID0gX2NvbmYubmV3TWFwcGluZ1JlcG9zaXRvcnlJbnN0\nYW5jZSgpOwogICAgICAgICAgICBfcmVwb3Muc2V0U2NoZW1hR3JvdXAoZ2V0\nU2NoZW1hR3JvdXAoKSk7CiAgICAgICAgICAgIF9yZXBvcy5zZXRWYWxpZGF0\nZShNZXRhRGF0YVJlcG9zaXRvcnkuVkFMSURBVEVfVU5FTkhBTkNFRCwgZmFs\nc2UpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gX3JlcG9zOwogICAgfQoK\nICAgIC8qKgogICAgICogU2V0IHRoZSByZXBvc2l0b3J5IHRvIHVzZSB0byBh\nY2Nlc3MgbWFwcGluZyBpbmZvcm1hdGlvbi4KICAgICAqLwogICAgcHVibGlj\nIHZvaWQgc2V0UmVwb3NpdG9yeShNYXBwaW5nUmVwb3NpdG9yeSByZXBvcykg\newogICAgICAgIF9yZXBvcyA9IHJlcG9zOwogICAgfQoKICAgIC8qKgogICAg\nICogUmV0dXJuIHRoZSBzY2hlbWEgZ3JvdXAgdG8gdXNlIGluIG1hcHBpbmcu\nIElmIG5vbmUgaGFzIGJlZW4gc2V0LCB0aGUKICAgICAqIHNjaGVtYSB3aWxs\nIGJlIGdlbmVyYXRlZCBmcm9tIHRoZSBkYXRhYmFzZS4KICAgICAqLwogICAg\ncHVibGljIFNjaGVtYUdyb3VwIGdldFNjaGVtYUdyb3VwKCkgewogICAgICAg\nIGlmIChfc2NoZW1hID09IG51bGwpIHsKICAgICAgICAgICAgaWYgKF9hY3Rp\nb24uaW5kZXhPZihBQ1RJT05fQlVJTERfU0NIRU1BKSAhPSAtMSkgewogICAg\nICAgICAgICAgICAgRHluYW1pY1NjaGVtYUZhY3RvcnkgZmFjdG9yeSA9IG5l\ndyBEeW5hbWljU2NoZW1hRmFjdG9yeSgpOwogICAgICAgICAgICAgICAgZmFj\ndG9yeS5zZXRDb25maWd1cmF0aW9uKF9jb25mKTsKICAgICAgICAgICAgICAg\nIF9zY2hlbWEgPSBmYWN0b3J5OwogICAgICAgICAgICB9IGVsc2UgaWYgKF9y\nZWFkU2NoZW1hIAogICAgICAgICAgICAgICAgfHwgY29udGFpbnMoX3NjaGVt\nYUFjdGlvbnMsU2NoZW1hVG9vbC5BQ1RJT05fUkVUQUlOKQogICAgICAgICAg\nICAgICAgfHwgY29udGFpbnMoX3NjaGVtYUFjdGlvbnMsU2NoZW1hVG9vbC5B\nQ1RJT05fUkVGUkVTSCkpIHsKICAgICAgICAgICAgICAgIF9zY2hlbWEgPSAo\nU2NoZW1hR3JvdXApIG5ld1NjaGVtYVRvb2wobnVsbCkuZ2V0REJTY2hlbWFH\ncm91cCgpLgogICAgICAgICAgICAgICAgICAgIGNsb25lKCk7CiAgICAgICAg\nICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAvLyB3aXRoIHRoaXMgd2Un\nbGwganVzdCByZWFkIHRhYmxlcyBhcyBkaWZmZXJlbnQgbWFwcGluZ3MKICAg\nICAgICAgICAgICAgIC8vIGxvb2sgZm9yIHRoZW0KICAgICAgICAgICAgICAg\nIExhenlTY2hlbWFGYWN0b3J5IGZhY3RvcnkgPSBuZXcgTGF6eVNjaGVtYUZh\nY3RvcnkoKTsKICAgICAgICAgICAgICAgIGZhY3Rvcnkuc2V0Q29uZmlndXJh\ndGlvbihfY29uZik7CiAgICAgICAgICAgICAgICBmYWN0b3J5LnNldFByaW1h\ncnlLZXlzKGdldFByaW1hcnlLZXlzKCkpOwogICAgICAgICAgICAgICAgZmFj\ndG9yeS5zZXRGb3JlaWduS2V5cyhnZXRGb3JlaWduS2V5cygpKTsKICAgICAg\nICAgICAgICAgIGZhY3Rvcnkuc2V0SW5kZXhlcyhnZXRJbmRleGVzKCkpOwog\nICAgICAgICAgICAgICAgX3NjaGVtYSA9IGZhY3Rvcnk7CiAgICAgICAgICAg\nIH0KCiAgICAgICAgICAgIGlmIChfc2NoZW1hLmdldFNjaGVtYXMoKS5sZW5n\ndGggPT0gMCkKICAgICAgICAgICAgICAgIF9zY2hlbWEuYWRkU2NoZW1hKCk7\nCiAgICAgICAgfQogICAgICAgIHJldHVybiBfc2NoZW1hOwogICAgfQoKICAg\nIC8qKgogICAgICogU2V0IHRoZSBzY2hlbWEgdG8gdXNlIGluIG1hcHBpbmcu\nCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldFNjaGVtYUdyb3VwKFNjaGVt\nYUdyb3VwIHNjaGVtYSkgewogICAgICAgIF9zY2hlbWEgPSBzY2hlbWE7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBSZXNldCB0aGUgaW50ZXJuYWwgcmVwb3Np\ndG9yeS4gVGhpcyBpcyBjYWxsZWQgYXV0b21hdGljYWxseSBhZnRlcgogICAg\nICogZXZlcnkge0BsaW5rICNyZWNvcmR9LgogICAgICovCiAgICBwdWJsaWMg\ndm9pZCBjbGVhcigpIHsKICAgICAgICBfcmVwb3MgPSBudWxsOwogICAgICAg\nIF9zY2hlbWEgPSBudWxsOwogICAgICAgIF9zY2hlbWFUb29sID0gbnVsbDsK\nICAgICAgICBfZmx1c2ggPSBmYWxzZTsKICAgICAgICBfZmx1c2hTY2hlbWEg\nPSBmYWxzZTsKICAgICAgICBpZiAoX2Ryb3BDbHMgIT0gbnVsbCkKICAgICAg\nICAgICAgX2Ryb3BDbHMuY2xlYXIoKTsKICAgICAgICBpZiAoX2Ryb3BNYXAg\nIT0gbnVsbCkKICAgICAgICAgICAgX2Ryb3BNYXAuY2xlYXIoKTsKICAgIH0K\nCiAgICAvKioKICAgICAqIFJlY29yZHMgdGhlIGNoYW5nZXMgdGhhdCBoYXZl\nIGJlZW4gbWFkZSB0byBib3RoIHRoZSBtYXBwaW5ncyBhbmQgdGhlCiAgICAg\nKiBhc3NvY2lhdGVkIHNjaGVtYSwgYW5kIGNsZWFycyB0aGUgdG9vbCBmb3Ig\nZnVydGhlciB1c2UuIFRoaXMgYWxzbwogICAgICogaW52b2x2ZXMgY2xlYXJp\nbmcgdGhlIGludGVybmFsIG1hcHBpbmcgcmVwb3NpdG9yeS4KICAgICAqLwog\nICAgcHVibGljIHZvaWQgcmVjb3JkKCkgewogICAgICAgIHJlY29yZChudWxs\nKTsKICAgIH0KICAgIAogICAgcHJpdmF0ZSB2b2lkIHJlY29yZChNYXBwaW5n\nVG9vbC5GbGFncyBmbGFncykgewogICAgICAgIE1hcHBpbmdSZXBvc2l0b3J5\nIHJlcG9zID0gZ2V0UmVwb3NpdG9yeSgpOwogICAgICAgIE1ldGFEYXRhRmFj\ndG9yeSBpbyA9IHJlcG9zLmdldE1ldGFEYXRhRmFjdG9yeSgpOwogICAgICAg\nIENsYXNzTWFwcGluZ1tdIG1hcHBpbmdzOwogICAgICAgIGlmICghQUNUSU9O\nX0RST1AuZXF1YWxzKF9hY3Rpb24pKQogICAgICAgICAgICBtYXBwaW5ncyA9\nIHJlcG9zLmdldE1hcHBpbmdzKCk7CiAgICAgICAgZWxzZSBpZiAoX2Ryb3BN\nYXAgIT0gbnVsbCkKICAgICAgICAgICAgbWFwcGluZ3MgPSAoQ2xhc3NNYXBw\naW5nW10pIF9kcm9wTWFwLnRvQXJyYXkKICAgICAgICAgICAgICAgIChuZXcg\nQ2xhc3NNYXBwaW5nW19kcm9wTWFwLnNpemUoKV0pOwogICAgICAgIGVsc2UK\nICAgICAgICAgICAgbWFwcGluZ3MgPSBuZXcgQ2xhc3NNYXBwaW5nWzBdOwoK\nICAgICAgICB0cnkgewogICAgICAgICAgICBpZiAoX2Ryb3BDbHMgIT0gbnVs\nbCAmJiAhX2Ryb3BDbHMuaXNFbXB0eSgpKSB7CiAgICAgICAgICAgICAgICBD\nbGFzczw/PltdIGNscyA9IChDbGFzc1tdKSBfZHJvcENscy50b0FycmF5CiAg\nICAgICAgICAgICAgICAgICAgKG5ldyBDbGFzc1tfZHJvcENscy5zaXplKCld\nKTsKICAgICAgICAgICAgICAgIGlmICghaW8uZHJvcChjbHMsIF9tb2RlLCBu\ndWxsKSkKICAgICAgICAgICAgICAgICAgICBfbG9nLndhcm4oX2xvYy5nZXQo\nImJhZC1kcm9wIiwgX2Ryb3BDbHMpKTsKICAgICAgICAgICAgfQoKICAgICAg\nICAgICAgaWYgKF9mbHVzaFNjaGVtYSkgewogICAgICAgICAgICAgICAgLy8g\nZHJvcCBwb3J0aW9ucyBvZiB0aGUga25vd24gc2NoZW1hIHRoYXQgbm8gbWFw\ncGluZyB1c2VzLCBhbmQKICAgICAgICAgICAgICAgIC8vIGFkZCBzZXF1ZW5j\nZXMgdXNlZCBmb3IgdmFsdWUgZ2VuZXJhdGlvbgogICAgICAgICAgICAgICAg\naWYgKF9kcm9wVW51c2VkKQogICAgICAgICAgICAgICAgICAgIGRyb3BVbnVz\nZWRTY2hlbWFDb21wb25lbnRzKG1hcHBpbmdzKTsKICAgICAgICAgICAgICAg\nIGFkZFNlcXVlbmNlQ29tcG9uZW50cyhtYXBwaW5ncyk7CgogICAgICAgICAg\nICAgICAgLy8gbm93IHJ1biB0aGUgc2NoZW1hdG9vbCBhcyBsb25nIGFzIHdl\nJ3JlIGRvaW5nIHNvbWUgc2NoZW1hCiAgICAgICAgICAgICAgICAvLyBhY3Rp\nb24gYW5kIHRoZSB1c2VyIGRvZXNuJ3QganVzdCB3YW50IGFuIHhtbCBvdXRw\ndXQKICAgICAgICAgICAgICAgIFN0cmluZ1tdIHNjaGVtYUFjdGlvbnMgPSBf\nc2NoZW1hQWN0aW9ucy5zcGxpdCgiLCIpOwogICAgICAgICAgICAgICAgZm9y\nIChpbnQgaSA9IDA7IGkgPCBzY2hlbWFBY3Rpb25zLmxlbmd0aDsgaSsrKSB7\nCiAgICAgICAgICAgICAgICAgICAgaWYgKCFTQ0hFTUFfQUNUSU9OX05PTkUu\nZXF1YWxzKHNjaGVtYUFjdGlvbnNbaV0pCiAgICAgICAgICAgICAgICAgICAg\nICAgICYmIChfc2NoZW1hV3JpdGVyID09IG51bGwgfHwgKF9zY2hlbWFUb29s\nICE9IG51bGwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICYmIF9zY2hl\nbWFUb29sLmdldFdyaXRlcigpICE9IG51bGwpKSkgewogICAgICAgICAgICAg\nICAgICAgICAgICBTY2hlbWFUb29sIHRvb2wgPSBuZXdTY2hlbWFUb29sKHNj\naGVtYUFjdGlvbnNbaV0pOwoKICAgICAgICAgICAgICAgICAgICAgICAgLy8g\nY29uZmlndXJlIHRoZSB0b29sIHdpdGggYWRkaXRpb25hbCBzZXR0aW5ncwog\nICAgICAgICAgICAgICAgICAgICAgICBpZiAoZmxhZ3MgIT0gbnVsbCkgewog\nICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9vbC5zZXREcm9wVGFibGVz\nKGZsYWdzLmRyb3BUYWJsZXMpOwogICAgICAgICAgICAgICAgICAgICAgICAg\nICAgdG9vbC5zZXREcm9wU2VxdWVuY2VzKGZsYWdzLmRyb3BTZXF1ZW5jZXMp\nOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9vbC5zZXRXcml0ZXIo\nZmxhZ3Muc3FsV3JpdGVyKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAg\nIHRvb2wuc2V0T3BlbkpQQVRhYmxlcyhmbGFncy5vcGVuanBhVGFibGVzKTsK\nICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAg\nICAgICAgdG9vbC5zZXRTY2hlbWFHcm91cChnZXRTY2hlbWFHcm91cCgpKTsK\nICAgICAgICAgICAgICAgICAgICAgICAgdG9vbC5ydW4oKTsKICAgICAgICAg\nICAgICAgICAgICAgICAgdG9vbC5yZWNvcmQoKTsKICAgICAgICAgICAgICAg\nICAgICB9CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgLy8g\neG1sIG91dHB1dCBvZiBzY2hlbWE/CiAgICAgICAgICAgICAgICBpZiAoX3Nj\naGVtYVdyaXRlciAhPSBudWxsKSB7CiAgICAgICAgICAgICAgICAgICAgLy8g\nc2VyaWFsaXplIHRoZSBwbGFubmVkIHNjaGVtYSB0byB0aGUgc3RyZWFtCiAg\nICAgICAgICAgICAgICAgICAgU2NoZW1hU2VyaWFsaXplciBzZXIgPSBuZXcg\nWE1MU2NoZW1hU2VyaWFsaXplcihfY29uZik7CiAgICAgICAgICAgICAgICAg\nICAgc2VyLmFkZEFsbChnZXRTY2hlbWFHcm91cCgpKTsKICAgICAgICAgICAg\nICAgICAgICBzZXIuc2VyaWFsaXplKF9zY2hlbWFXcml0ZXIsIE1ldGFEYXRh\nU2VyaWFsaXplci5QUkVUVFkpOwogICAgICAgICAgICAgICAgICAgIF9zY2hl\nbWFXcml0ZXIuZmx1c2goKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAg\nICAgfQogICAgICAgICAgICBpZiAoIV9mbHVzaCkKICAgICAgICAgICAgICAg\nIHJldHVybjsKCiAgICAgICAgICAgIFF1ZXJ5TWV0YURhdGFbXSBxdWVyaWVz\nID0gcmVwb3MuZ2V0UXVlcnlNZXRhRGF0YXMoKTsKICAgICAgICAgICAgU2Vx\ndWVuY2VNZXRhRGF0YVtdIHNlcXMgPSByZXBvcy5nZXRTZXF1ZW5jZU1ldGFE\nYXRhcygpOwogICAgICAgICAgICBNYXA8RmlsZSwgU3RyaW5nPiBvdXRwdXQg\nPSBudWxsOwoKICAgICAgICAgICAgLy8gaWYgd2UncmUgb3V0cHV0dGluZyB0\nbyBzdHJlYW0sIHNldCBhbGwgbWV0YXMgdG8gc2FtZSBmaWxlIHNvCiAgICAg\nICAgICAgIC8vIHRoZXkgZ2V0IHBsYWNlZCBpbiBzaW5nbGUgc3RyaW5nCiAg\nICAgICAgICAgIGlmIChfbWFwcGluZ1dyaXRlciAhPSBudWxsKSB7CiAgICAg\nICAgICAgICAgICBvdXRwdXQgPSBuZXcgSGFzaE1hcDxGaWxlLCBTdHJpbmc+\nKCk7CiAgICAgICAgICAgICAgICBGaWxlIHRtcCA9IG5ldyBGaWxlKCJvcGVu\nanBhdG1wIik7CiAgICAgICAgICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8\nIG1hcHBpbmdzLmxlbmd0aDsgaSsrKQogICAgICAgICAgICAgICAgICAgIG1h\ncHBpbmdzW2ldLnNldFNvdXJjZSh0bXAsIFNvdXJjZVRyYWNrZXIuU1JDX09U\nSEVSKTsKICAgICAgICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgcXVl\ncmllcy5sZW5ndGg7IGkrKykKICAgICAgICAgICAgICAgICAgICBxdWVyaWVz\nW2ldLnNldFNvdXJjZSh0bXAsIHF1ZXJpZXNbaV0uZ2V0U291cmNlU2NvcGUo\nKSwKICAgICAgICAgICAgICAgICAgICAgICAgU291cmNlVHJhY2tlci5TUkNf\nT1RIRVIpOwogICAgICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBz\nZXFzLmxlbmd0aDsgaSsrKQogICAgICAgICAgICAgICAgICAgIHNlcXNbaV0u\nc2V0U291cmNlKHRtcCwgc2Vxc1tpXS5nZXRTb3VyY2VTY29wZSgpLAogICAg\nICAgICAgICAgICAgICAgICAgICBTb3VyY2VUcmFja2VyLlNSQ19PVEhFUik7\nCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIHN0b3JlCiAgICAgICAg\nICAgIGlmICghaW8uc3RvcmUobWFwcGluZ3MsIHF1ZXJpZXMsIHNlcXMsIF9t\nb2RlLCBvdXRwdXQpKQogICAgICAgICAgICAgICAgdGhyb3cgbmV3IE1ldGFE\nYXRhRXhjZXB0aW9uKF9sb2MuZ2V0KCJiYWQtc3RvcmUiKSk7CgogICAgICAg\nICAgICAvLyB3cml0ZSB0byBzdHJlYW0KICAgICAgICAgICAgaWYgKF9tYXBw\naW5nV3JpdGVyICE9IG51bGwpIHsKICAgICAgICAgICAgICAgIFByaW50V3Jp\ndGVyIG91dCA9IG5ldyBQcmludFdyaXRlcihfbWFwcGluZ1dyaXRlcik7CiAg\nICAgICAgICAgICAgICBmb3IgKEl0ZXJhdG9yPFN0cmluZz4gaXRyID0gb3V0\ncHV0LnZhbHVlcygpLml0ZXJhdG9yKCk7CiAgICAgICAgICAgICAgICAgICAg\naXRyLmhhc05leHQoKTspCiAgICAgICAgICAgICAgICAgICAgb3V0LnByaW50\nbG4oaXRyLm5leHQoKSk7CiAgICAgICAgICAgICAgICBvdXQuZmx1c2goKTsK\nICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBjYXRjaCAoUnVudGlt\nZUV4Y2VwdGlvbiByZSkgewogICAgICAgICAgICB0aHJvdyByZTsKICAgICAg\nICB9IGNhdGNoIChFeGNlcHRpb24gZSkgewogICAgICAgICAgICB0aHJvdyBu\nZXcgR2VuZXJhbEV4Y2VwdGlvbihlKTsKICAgICAgICB9IGZpbmFsbHkgewog\nICAgICAgICAgICBjbGVhcigpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioK\nICAgICAqIERyb3BzIHNjaGVtYSBjb21wb25lbnRzIHRoYXQgYXBwZWFyIHRv\nIGJlIHVudXNlZCBmcm9tIHRoZSBsb2NhbAogICAgICogY29weSBvZiB0aGUg\nc2NoZW1hIGdyb3VwLgogICAgICovCiAgICBwcml2YXRlIHZvaWQgZHJvcFVu\ndXNlZFNjaGVtYUNvbXBvbmVudHMoQ2xhc3NNYXBwaW5nW10gbWFwcGluZ3Mp\nIHsKICAgICAgICBGaWVsZE1hcHBpbmdbXSBmaWVsZHM7CiAgICAgICAgZm9y\nIChpbnQgaSA9IDA7IGkgPCBtYXBwaW5ncy5sZW5ndGg7IGkrKykgewogICAg\nICAgICAgICBtYXBwaW5nc1tpXS5yZWZTY2hlbWFDb21wb25lbnRzKCk7CiAg\nICAgICAgICAgIG1hcHBpbmdzW2ldLmdldERpc2NyaW1pbmF0b3IoKS5yZWZT\nY2hlbWFDb21wb25lbnRzKCk7CiAgICAgICAgICAgIG1hcHBpbmdzW2ldLmdl\ndFZlcnNpb24oKS5yZWZTY2hlbWFDb21wb25lbnRzKCk7CiAgICAgICAgICAg\nIGZpZWxkcyA9IG1hcHBpbmdzW2ldLmdldERlZmluZWRGaWVsZE1hcHBpbmdz\nKCk7CiAgICAgICAgICAgIGZvciAoaW50IGogPSAwOyBqIDwgZmllbGRzLmxl\nbmd0aDsgaisrKQogICAgICAgICAgICAgICAgZmllbGRzW2pdLnJlZlNjaGVt\nYUNvbXBvbmVudHMoKTsKICAgICAgICB9CgogICAgICAgIC8vIGFsc28gYWxs\nb3cgdGhlIGRiZGljdGlvbmFyeSB0byByZWYgYW55IHNjaGVtYSBjb21wb25l\nbnRzIHRoYXQKICAgICAgICAvLyBpdCBhZGRzIGFwYXJ0IGZyb20gbWFwcGlu\nZ3MKICAgICAgICBTY2hlbWFHcm91cCBncm91cCA9IGdldFNjaGVtYUdyb3Vw\nKCk7CiAgICAgICAgU2NoZW1hW10gc2NoZW1hcyA9IGdyb3VwLmdldFNjaGVt\nYXMoKTsKICAgICAgICBUYWJsZVtdIHRhYmxlczsKICAgICAgICBmb3IgKGlu\ndCBpID0gMDsgaSA8IHNjaGVtYXMubGVuZ3RoOyBpKyspIHsKICAgICAgICAg\nICAgdGFibGVzID0gc2NoZW1hc1tpXS5nZXRUYWJsZXMoKTsKICAgICAgICAg\nICAgZm9yIChpbnQgaiA9IDA7IGogPCB0YWJsZXMubGVuZ3RoOyBqKyspCiAg\nICAgICAgICAgICAgICBfZGljdC5yZWZTY2hlbWFDb21wb25lbnRzKHRhYmxl\nc1tqXSk7CiAgICAgICAgfQoKICAgICAgICBncm91cC5yZW1vdmVVbnVzZWRD\nb21wb25lbnRzKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBBZGQgdGFibGVz\nIHVzZWQgYnkgc2VxdWVuY2VzIHRvIHRoZSBnaXZlbiBzY2hlbWEuCiAgICAg\nKi8KICAgIHByaXZhdGUgdm9pZCBhZGRTZXF1ZW5jZUNvbXBvbmVudHMoQ2xh\nc3NNYXBwaW5nW10gbWFwcGluZ3MpIHsKICAgICAgICBTY2hlbWFHcm91cCBn\ncm91cCA9IGdldFNjaGVtYUdyb3VwKCk7CiAgICAgICAgZm9yIChpbnQgaSA9\nIDA7IGkgPCBtYXBwaW5ncy5sZW5ndGg7IGkrKykKICAgICAgICAgICAgYWRk\nU2VxdWVuY2VDb21wb25lbnRzKG1hcHBpbmdzW2ldLCBncm91cCk7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBBZGQgdGFibGVzIHVzZWQgYnkgc2VxdWVuY2Vz\nIHRvIHRoZSBnaXZlbiBzY2hlbWEuCiAgICAgKi8KICAgIHByaXZhdGUgdm9p\nZCBhZGRTZXF1ZW5jZUNvbXBvbmVudHMoQ2xhc3NNYXBwaW5nIG1hcHBpbmcs\nCiAgICAgICAgU2NoZW1hR3JvdXAgZ3JvdXApIHsKICAgICAgICBTZXF1ZW5j\nZU1ldGFEYXRhIHNtZCA9IG1hcHBpbmcuZ2V0SWRlbnRpdHlTZXF1ZW5jZU1l\ndGFEYXRhKCk7CiAgICAgICAgU2VxIHNlcSA9IG51bGw7CiAgICAgICAgaWYg\nKHNtZCAhPSBudWxsKQogICAgICAgICAgICBzZXEgPSBzbWQuZ2V0SW5zdGFu\nY2UobnVsbCk7CiAgICAgICAgZWxzZSBpZiAobWFwcGluZy5nZXRJZGVudGl0\neVN0cmF0ZWd5KCkgPT0gVmFsdWVTdHJhdGVnaWVzLk5BVElWRQogICAgICAg\nICAgICB8fCAobWFwcGluZy5nZXRJZGVudGl0eVN0cmF0ZWd5KCkgPT0gVmFs\ndWVTdHJhdGVnaWVzLk5PTkUKICAgICAgICAgICAgJiYgbWFwcGluZy5nZXRJ\nZGVudGl0eVR5cGUoKSA9PSBDbGFzc01hcHBpbmcuSURfREFUQVNUT1JFKSkK\nICAgICAgICAgICAgc2VxID0gX2NvbmYuZ2V0U2VxdWVuY2VJbnN0YW5jZSgp\nOwoKICAgICAgICBpZiAoc2VxIGluc3RhbmNlb2YgSkRCQ1NlcSkKICAgICAg\nICAgICAgKChKREJDU2VxKSBzZXEpLmFkZFNjaGVtYShtYXBwaW5nLCBncm91\ncCk7CgogICAgICAgIEZpZWxkTWFwcGluZ1tdIGZtZHM7CiAgICAgICAgaWYg\nKG1hcHBpbmcuZ2V0RW1iZWRkaW5nTWV0YURhdGEoKSA9PSBudWxsKQogICAg\nICAgICAgICBmbWRzID0gbWFwcGluZy5nZXREZWZpbmVkRmllbGRNYXBwaW5n\ncygpOwogICAgICAgIGVsc2UKICAgICAgICAgICAgZm1kcyA9IG1hcHBpbmcu\nZ2V0RmllbGRNYXBwaW5ncygpOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBp\nIDwgZm1kcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBzbWQgPSBmbWRz\nW2ldLmdldFZhbHVlU2VxdWVuY2VNZXRhRGF0YSgpOwogICAgICAgICAgICBp\nZiAoc21kICE9IG51bGwpIHsKICAgICAgICAgICAgICAgIHNlcSA9IHNtZC5n\nZXRJbnN0YW5jZShudWxsKTsKICAgICAgICAgICAgICAgIGlmIChzZXEgaW5z\ndGFuY2VvZiBKREJDU2VxKQogICAgICAgICAgICAgICAgICAgICgoSkRCQ1Nl\ncSkgc2VxKS5hZGRTY2hlbWEobWFwcGluZywgZ3JvdXApOwogICAgICAgICAg\nICB9IGVsc2UgaWYgKGZtZHNbaV0uZ2V0RW1iZWRkZWRNYXBwaW5nKCkgIT0g\nbnVsbCkKICAgICAgICAgICAgICAgIGFkZFNlcXVlbmNlQ29tcG9uZW50cyhm\nbWRzW2ldLmdldEVtYmVkZGVkTWFwcGluZygpLCBncm91cCk7CiAgICAgICAg\nfQogICAgfQoKICAgIC8vLy8vLy8vLy8vCiAgICAvLyBBY3Rpb25zCiAgICAv\nLy8vLy8vLy8vLwoKICAgIC8qKgogICAgICogUnVuIHRoZSBjb25maWd1cmVk\nIGFjdGlvbiBvbiB0aGUgZ2l2ZW4gaW5zdGFuY2UuCiAgICAgKi8KICAgIHB1\nYmxpYyB2b2lkIHJ1bihDbGFzczw/PiBjbHMpIHsKICAgICAgICBpZiAoQUNU\nSU9OX0FERC5lcXVhbHMoX2FjdGlvbikpIHsKICAgICAgICAgICAgaWYgKF9t\nZXRhKQogICAgICAgICAgICAgICAgYWRkTWV0YShjbHMpOwogICAgICAgICAg\nICBlbHNlCiAgICAgICAgICAgICAgICBhZGQoY2xzKTsKICAgICAgICB9IGVs\nc2UgaWYgKEFDVElPTl9SRUZSRVNILmVxdWFscyhfYWN0aW9uKSkKICAgICAg\nICAgICAgcmVmcmVzaChjbHMpOwogICAgICAgIGVsc2UgaWYgKEFDVElPTl9C\nVUlMRF9TQ0hFTUEuZXF1YWxzKF9hY3Rpb24pKQogICAgICAgICAgICBidWls\nZFNjaGVtYShjbHMpOwogICAgICAgIGVsc2UgaWYgKEFDVElPTl9EUk9QLmVx\ndWFscyhfYWN0aW9uKSkKICAgICAgICAgICAgZHJvcChjbHMpOwogICAgICAg\nIGVsc2UgaWYgKEFDVElPTl9WQUxJREFURS5lcXVhbHMoX2FjdGlvbikpCiAg\nICAgICAgICAgIHZhbGlkYXRlKGNscyk7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBBZGQgdGhlIG1hcHBpbmcgZm9yIHRoZSBnaXZlbiBpbnN0YW5jZS4KICAg\nICAqLwogICAgcHJpdmF0ZSB2b2lkIGFkZChDbGFzczw/PiBjbHMpIHsKICAg\nICAgICBpZiAoY2xzID09IG51bGwpCiAgICAgICAgICAgIHJldHVybjsKCiAg\nICAgICAgTWFwcGluZ1JlcG9zaXRvcnkgcmVwb3MgPSBnZXRSZXBvc2l0b3J5\nKCk7CiAgICAgICAgcmVwb3Muc2V0U3RyYXRlZ3lJbnN0YWxsZXIobmV3IE1h\ncHBpbmdTdHJhdGVneUluc3RhbGxlcihyZXBvcykpOwogICAgICAgIGlmIChn\nZXRNYXBwaW5nKHJlcG9zLCBjbHMsIHRydWUpICE9IG51bGwpIHsKICAgICAg\nICAgICAgX2ZsdXNoID0gdHJ1ZTsKICAgICAgICAgICAgX2ZsdXNoU2NoZW1h\nID0gdHJ1ZTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1\ncm4gdGhlIG1hcHBpbmcgZm9yIHRoZSBnaXZlbiB0eXBlLCBvciBudWxsIGlm\nIHRoZSB0eXBlIGlzCiAgICAgKiBwZXJzaXN0ZW5jZS1hd2FyZS4KICAgICAq\nLwogICAgcHJpdmF0ZSBzdGF0aWMgQ2xhc3NNYXBwaW5nIGdldE1hcHBpbmco\nTWFwcGluZ1JlcG9zaXRvcnkgcmVwb3MsIENsYXNzPD8+IGNscywKICAgICAg\nICBib29sZWFuIHZhbGlkYXRlKSB7CiAgICAgICAgLy8gdGhpcyB3aWxsIHBh\ncnNlIGFsbCBwb3NzaWJsZSBtZXRhZGF0YSByc3JjcyBsb29raW5nIGZvciBj\nbHMsIHNvCiAgICAgICAgLy8gd2lsbCBkZXRlY3QgaWYgcC1hd2FyZQogICAg\nICAgIENsYXNzTWFwcGluZyBtYXBwaW5nID0gcmVwb3MuZ2V0TWFwcGluZyhj\nbHMsIG51bGwsIGZhbHNlKTsKICAgICAgICBpZiAobWFwcGluZyAhPSBudWxs\nKQogICAgICAgICAgICByZXR1cm4gbWFwcGluZzsKICAgICAgICBpZiAoIXZh\nbGlkYXRlIHx8IGNscy5pc0ludGVyZmFjZSgpIAogICAgICAgICAgICB8fCBy\nZXBvcy5nZXRQZXJzaXN0ZW5jZUF3YXJlKGNscykgIT0gbnVsbCkKICAgICAg\nICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgdGhyb3cgbmV3IE1ldGFEYXRh\nRXhjZXB0aW9uKF9sb2MuZ2V0KCJuby1tZXRhIiwgY2xzLCBjbHMuZ2V0Q2xh\nc3NMb2FkZXIoKSkpOwogICAgfQoKICAgIC8qKgogICAgICogQ3JlYXRlIGEg\nbWV0YWRhdGEgZm9yIHRoZSBnaXZlbiBpbnN0YW5jZS4KICAgICAqLwogICAg\ncHJpdmF0ZSB2b2lkIGFkZE1ldGEoQ2xhc3M8Pz4gY2xzKSB7CiAgICAgICAg\naWYgKGNscyA9PSBudWxsKQogICAgICAgICAgICByZXR1cm47CgogICAgICAg\nIF9mbHVzaCA9IHRydWU7CiAgICAgICAgTWFwcGluZ1JlcG9zaXRvcnkgcmVw\nb3MgPSBnZXRSZXBvc2l0b3J5KCk7CiAgICAgICAgcmVwb3Muc2V0UmVzb2x2\nZShNT0RFX01BUFBJTkcsIGZhbHNlKTsKICAgICAgICBNZXRhRGF0YUZhY3Rv\ncnkgZmFjdG9yeSA9IHJlcG9zLmdldE1ldGFEYXRhRmFjdG9yeSgpOwogICAg\nICAgIGZhY3RvcnkuZ2V0RGVmYXVsdHMoKS5zZXRJZ25vcmVOb25QZXJzaXN0\nZW50KGZhbHNlKTsKICAgICAgICBmYWN0b3J5LnNldFN0b3JlTW9kZShNZXRh\nRGF0YUZhY3RvcnkuU1RPUkVfVkVSQk9TRSk7CgogICAgICAgIENsYXNzTWV0\nYURhdGEgbWV0YSA9IHJlcG9zLmFkZE1ldGFEYXRhKGNscyk7CiAgICAgICAg\nRmllbGRNZXRhRGF0YVtdIGZtZHMgPSBtZXRhLmdldERlY2xhcmVkRmllbGRz\nKCk7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBmbWRzLmxlbmd0aDsg\naSsrKSB7CiAgICAgICAgICAgIGlmIChmbWRzW2ldLmdldERlY2xhcmVkVHlw\nZUNvZGUoKSA9PSBKYXZhVHlwZXMuT0JKRUNUCiAgICAgICAgICAgICAgICAm\nJiBmbWRzW2ldLmdldERlY2xhcmVkVHlwZSgpICE9IE9iamVjdC5jbGFzcykK\nICAgICAgICAgICAgICAgIGZtZHNbaV0uc2V0RGVjbGFyZWRUeXBlQ29kZShK\nYXZhVHlwZXMuUEMpOwogICAgICAgIH0KICAgICAgICBtZXRhLnNldFNvdXJj\nZShfZmlsZSwgbWV0YS5nZXRTb3VyY2VUeXBlKCkpOwogICAgICAgIG1ldGEu\nc2V0UmVzb2x2ZShNT0RFX01FVEEsIHRydWUpOwogICAgfQoKICAgIC8qKgog\nICAgICogUmVmcmVzaCBvciBhZGQgdGhlIG1hcHBpbmcgZm9yIHRoZSBnaXZl\nbiBpbnN0YW5jZS4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIHJlZnJlc2go\nQ2xhc3M8Pz4gY2xzKSB7CiAgICAgICAgaWYgKGNscyA9PSBudWxsKQogICAg\nICAgICAgICByZXR1cm47CgogICAgICAgIE1hcHBpbmdSZXBvc2l0b3J5IHJl\ncG9zID0gZ2V0UmVwb3NpdG9yeSgpOwogICAgICAgIHJlcG9zLnNldFN0cmF0\nZWd5SW5zdGFsbGVyKG5ldyBSZWZyZXNoU3RyYXRlZ3lJbnN0YWxsZXIocmVw\nb3MpKTsKICAgICAgICBpZiAoZ2V0TWFwcGluZyhyZXBvcywgY2xzLCB0cnVl\nKSAhPSBudWxsKSB7CiAgICAgICAgICAgIF9mbHVzaCA9IHRydWU7CiAgICAg\nICAgICAgIF9mbHVzaFNjaGVtYSA9IHRydWU7CiAgICAgICAgfQogICAgfQoK\nICAgIC8qKgogICAgICogVmFsaWRhdGUgdGhlIG1hcHBpbmdzIGZvciB0aGUg\nZ2l2ZW4gY2xhc3MgYW5kIGl0cyBmaWVsZHMuCiAgICAgKi8KICAgIHByaXZh\ndGUgdm9pZCB2YWxpZGF0ZShDbGFzczw/PiBjbHMpIHsKICAgICAgICBpZiAo\nY2xzID09IG51bGwpCiAgICAgICAgICAgIHJldHVybjsKCiAgICAgICAgTWFw\ncGluZ1JlcG9zaXRvcnkgcmVwb3MgPSBnZXRSZXBvc2l0b3J5KCk7CiAgICAg\nICAgcmVwb3Muc2V0U3RyYXRlZ3lJbnN0YWxsZXIobmV3IFJ1bnRpbWVTdHJh\ndGVneUluc3RhbGxlcihyZXBvcykpOwogICAgICAgIGlmIChnZXRNYXBwaW5n\nKHJlcG9zLCBjbHMsIHRydWUpICE9IG51bGwpCiAgICAgICAgICAgIF9mbHVz\naFNjaGVtYSA9ICFjb250YWlucyhfc2NoZW1hQWN0aW9ucyxTQ0hFTUFfQUNU\nSU9OX05PTkUpCiAgICAgICAgICAgICAgICAmJiAhY29udGFpbnMoX3NjaGVt\nYUFjdGlvbnMsU2NoZW1hVG9vbC5BQ1RJT05fQUREKTsKICAgIH0KCiAgICAv\nKioKICAgICAqIENyZWF0ZSB0aGUgc2NoZW1hIHVzaW5nIHRoZSBtYXBwaW5n\nIGZvciB0aGUgZ2l2ZW4gaW5zdGFuY2UuCiAgICAgKi8KICAgIHByaXZhdGUg\ndm9pZCBidWlsZFNjaGVtYShDbGFzczw/PiBjbHMpIHsKICAgICAgICBpZiAo\nY2xzID09IG51bGwpCiAgICAgICAgICAgIHJldHVybjsKCiAgICAgICAgTWFw\ncGluZ1JlcG9zaXRvcnkgcmVwb3MgPSBnZXRSZXBvc2l0b3J5KCk7CiAgICAg\nICAgcmVwb3Muc2V0U3RyYXRlZ3lJbnN0YWxsZXIobmV3IFJ1bnRpbWVTdHJh\ndGVneUluc3RhbGxlcihyZXBvcykpOwogICAgICAgIGlmIChnZXRNYXBwaW5n\nKHJlcG9zLCBjbHMsIHRydWUpID09IG51bGwpCiAgICAgICAgICAgIHJldHVy\nbjsKCiAgICAgICAgLy8gc2V0IGFueSBsb2dpY2FsIHBrcyB0byBub24tbG9n\naWNhbCBzbyB0aGV5IGdldCBmbHVzaGVkCiAgICAgICAgX2ZsdXNoU2NoZW1h\nID0gdHJ1ZTsKICAgICAgICBTY2hlbWFbXSBzY2hlbWFzID0gX3NjaGVtYS5n\nZXRTY2hlbWFzKCk7CiAgICAgICAgVGFibGVbXSB0YWJsZXM7CiAgICAgICAg\nQ29sdW1uW10gY29sczsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IHNj\naGVtYXMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgdGFibGVzID0gc2No\nZW1hc1tpXS5nZXRUYWJsZXMoKTsKICAgICAgICAgICAgZm9yIChpbnQgaiA9\nIDA7IGogPCB0YWJsZXMubGVuZ3RoOyBqKyspIHsKICAgICAgICAgICAgICAg\nIGlmICh0YWJsZXNbal0uZ2V0UHJpbWFyeUtleSgpID09IG51bGwpCiAgICAg\nICAgICAgICAgICAgICAgY29udGludWU7CgogICAgICAgICAgICAgICAgdGFi\nbGVzW2pdLmdldFByaW1hcnlLZXkoKS5zZXRMb2dpY2FsKGZhbHNlKTsKICAg\nICAgICAgICAgICAgIGNvbHMgPSB0YWJsZXNbal0uZ2V0UHJpbWFyeUtleSgp\nLmdldENvbHVtbnMoKTsKICAgICAgICAgICAgICAgIGZvciAoaW50IGsgPSAw\nOyBrIDwgY29scy5sZW5ndGg7IGsrKykKICAgICAgICAgICAgICAgICAgICBj\nb2xzW2tdLnNldE5vdE51bGwodHJ1ZSk7CiAgICAgICAgICAgIH0KICAgICAg\nICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBEcm9wIG1hcHBpbmcgZm9yIGdp\ndmVuIGNsYXNzLgogICAgICovCiAgICBwcml2YXRlIHZvaWQgZHJvcChDbGFz\nczw/PiBjbHMpIHsKICAgICAgICBpZiAoY2xzID09IG51bGwpCiAgICAgICAg\nICAgIHJldHVybjsKCiAgICAgICAgaWYgKF9kcm9wQ2xzID09IG51bGwpCiAg\nICAgICAgICAgIF9kcm9wQ2xzID0gbmV3IEhhc2hTZXQ8Q2xhc3M8Pz4+KCk7\nCiAgICAgICAgX2Ryb3BDbHMuYWRkKGNscyk7CiAgICAgICAgaWYgKCFjb250\nYWlucyhfc2NoZW1hQWN0aW9ucyxTY2hlbWFUb29sLkFDVElPTl9EUk9QKSkK\nICAgICAgICAgICAgcmV0dXJuOwoKICAgICAgICBNYXBwaW5nUmVwb3NpdG9y\neSByZXBvcyA9IGdldFJlcG9zaXRvcnkoKTsKICAgICAgICByZXBvcy5zZXRT\ndHJhdGVneUluc3RhbGxlcihuZXcgUnVudGltZVN0cmF0ZWd5SW5zdGFsbGVy\nKHJlcG9zKSk7CiAgICAgICAgQ2xhc3NNYXBwaW5nIG1hcHBpbmcgPSBudWxs\nOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIG1hcHBpbmcgPSByZXBvcy5n\nZXRNYXBwaW5nKGNscywgbnVsbCwgZmFsc2UpOwogICAgICAgIH0gY2F0Y2gg\nKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgfQoKICAgICAgICBpZiAobWFwcGlu\nZyAhPSBudWxsKSB7CiAgICAgICAgICAgIF9mbHVzaFNjaGVtYSA9IHRydWU7\nCiAgICAgICAgICAgIGlmIChfZHJvcE1hcCA9PSBudWxsKQogICAgICAgICAg\nICAgICAgX2Ryb3BNYXAgPSBuZXcgSGFzaFNldDxDbGFzc01hcHBpbmc+KCk7\nCiAgICAgICAgICAgIF9kcm9wTWFwLmFkZChtYXBwaW5nKTsKICAgICAgICB9\nIGVsc2UKICAgICAgICAgICAgX2xvZy53YXJuKF9sb2MuZ2V0KCJuby1kcm9w\nLW1ldGEiLCBjbHMpKTsKICAgIH0KCiAgICAvLy8vLy8vLwogICAgLy8gTWFp\nbgogICAgLy8vLy8vLy8KCiAgICAvKioKICAgICAqIFVzYWdlOiBqYXZhIG9y\nZy5hcGFjaGUub3BlbmpwYS5qZGJjLm1ldGEuTWFwcGluZ1Rvb2wgW29wdGlv\nbl0qIAogICAgICogWy1hY3Rpb24vLWEgJmx0O3JlZnJlc2ggfCBhZGQgfCBi\ndWlsZFNjaGVtYSB8IGRyb3AgfCB2YWxpZGF0ZSB8IGltcG9ydCAKICAgICAq\nIHwgZXhwb3J0Jmd0O10gJmx0O2NsYXNzIG5hbWUgfCAuamF2YSBmaWxlIHwg\nLmNsYXNzIGZpbGUgfCAuamRvIGZpbGUmZ3Q7KgogICAgICogV2hlcmUgdGhl\nIGZvbGxvd2luZyBvcHRpb25zIGFyZSByZWNvZ25pemVkLgogICAgICogPHVs\nPgogICAgICogPGxpPjxpPi1wcm9wZXJ0aWVzLy1wICZsdDtwcm9wZXJ0aWVz\nIGZpbGUgb3IgcmVzb3VyY2UmZ3Q7PC9pPjogVGhlCiAgICAgKiBwYXRoIG9y\nIHJlc291cmNlIG5hbWUgb2YgYSBPcGVuSlBBIHByb3BlcnRpZXMgZmlsZSBj\nb250YWluaW5nCiAgICAgKiBpbmZvcm1hdGlvbiBhcyBvdXRsaW5lZCBpbiB7\nQGxpbmsgT3BlbkpQQUNvbmZpZ3VyYXRpb259LiBPcHRpb25hbC48L2xpPgog\nICAgICogPGxpPjxpPi0mbHQ7cHJvcGVydHkgbmFtZSZndDsgJmx0O3Byb3Bl\ncnR5IHZhbHVlJmd0OzwvaT46IEFsbCBiZWFuCiAgICAgKiBwcm9wZXJ0aWVz\nIG9mIHRoZSBPcGVuSlBBIHtAbGluayBKREJDQ29uZmlndXJhdGlvbn0gY2Fu\nIGJlIHNldCBieQogICAgICogdXNpbmcgdGhlaXIJbmFtZXMgYW5kIHN1cHBs\neWluZyBhIHZhbHVlLiBGb3IgZXhhbXBsZToKICAgICAqIDxjb2RlPi1saWNl\nbnNlS2V5IGFkc2xmamE4M3IzbGthZGY8L2NvZGU+PC9saT4KICAgICAqIDxs\naT48aT4tZmlsZS8tZiAmbHQ7c3Rkb3V0IHwgb3V0cHV0IGZpbGUgb3IgcmVz\nb3VyY2UmZ3Q7PC9pPjogVXNlCiAgICAgKiB0aGlzIG9wdGlvbiB0byB3cml0\nZSB0aGUgcGxhbm5lZCBtYXBwaW5ncyB0byBhbiBYTUwgZG9jdW1lbnQgcmF0\naGVyCiAgICAgKiB0aGFuIHN0b3JlIHRoZW0gaW4gdGhlIHJlcG9zaXRvcnku\nIFRoaXMgb3B0aW9uIGFsc28gc3BlY2lmaWVzIHRoZQogICAgICogbWV0YWRh\ndGEgZmlsZSB0byB3cml0ZSB0byBpZiB1c2luZyB0aGUgPGNvZGU+YWRkPC9j\nb2RlPiBhY3Rpb24gd2l0aAogICAgICogdGhlIDxjb2RlPi1tZXRhIHRydWU8\nL2NvZGU+IGZsYWcsIG9yIHRoZSBmaWxlIHRvIGR1bXAgdG8gaWYgdXNpbmcK\nICAgICAqIHRoZSA8Y29kZT5leHBvcnQ8L2NvZGU+IGFjdGlvbi48L2xpPgog\nICAgICogPGxpPjxpPi1zY2hlbWFBY3Rpb24vLXNhICZsdDtzY2hlbWEgYWN0\naW9uIHwgbm9uZSZndDs8L2k+OiBUaGUKICAgICAqIHtAbGluayBTY2hlbWFU\nb29sfSBkZWZpbmVzIHRoZSBhY3Rpb25zIHBvc3NpYmxlLiBUaGUgYWN0aW9u\ncyB3aWxsCiAgICAgKiBhcHBseSB0byBhbGwgc2NoZW1hIGNvbXBvbmVudHMg\ndXNlZCBieSB0aGUgbWFwcGluZ3MgaW52b2x2ZWQuCiAgICAgKiBVbmxlc3Mg\neW91IGFyZSBydW5uaW5nIHRoZSBtYXBwaW5nIHRvb2wgb24gYWxsIG9mIHlv\ndXIgcGVyc2lzdGVudAogICAgICogdHlwZXMgYXQgb25jZSwgYmUgY2FyZWZ1\nbCBydW5uaW5nIHNjaGVtYSBhY3Rpb25zIHRoYXQgY2FuIGRyb3AgZGF0YS4K\nICAgICAqIEl0IGlzIHBvc3NpYmxlIHRvIGFjY2lkZW50YWxseSBkcm9wIHNj\naGVtYSBjb21wb25lbnRzIHRoYXQgYXJlCiAgICAgKiB1c2VkIGJ5IGNsYXNz\nZXMgeW91IGFyZW4ndCBjdXJyZW50bHkgcnVubmluZyB0aGUgdG9vbCBvdmVy\nLiBUaGUKICAgICAqIGFjdGlvbiBkZWZhdWx0cyB0byA8Y29kZT5hZGQ8L2Nv\nZGU+LjwvbGk+CiAgICAgKiA8bGk+PGk+LXNjaGVtYUZpbGUvLXNmICZsdDtz\ndGRvdXQgfCBvdXRwdXQgZmlsZSBvciByZXNvdXJjZSZndDs8L2k+OiBVc2UK\nICAgICAqIHRoaXMgb3B0aW9uIHRvIHdyaXRlIHRoZSBwbGFubmVkIHNjaGVt\nYSB0byBhbiBYTUwgZG9jdW1lbnQgcmF0aGVyCiAgICAgKiB0aGFuIG1vZGlm\neSB0aGUgZGF0YSBzdG9yZS48L2xpPgogICAgICogPGxpPjxpPi1zcWxGaWxl\nLy1zcWwgJmx0O3N0ZG91dCB8IG91dHB1dCBmaWxlIG9yIHJlc291cmNlJmd0\nOzwvaT46IFVzZQogICAgICogdGhpcyBvcHRpb24gdG8gd3JpdGUgdGhlIHBs\nYW5uZWQgc2NoZW1hIGNoYW5nZXMgYXMgYSBTUUwKICAgICAqIHNjcmlwdCBy\nYXRoZXIgdGhhbiBtb2RpZnlpbmcgdGhlIGRhdGEgc3RvcmUuPC9saT4KICAg\nICAqIDxsaT48aT4tZHJvcFRhYmxlcy8tZHQgJmx0O3RydWUvdCB8IGZhbHNl\nL2YmZ3Q7PC9pPjogQ29ycmVzcG9uZHMgdG8gdGhlCiAgICAgKiBzYW1lLW5h\nbWVkIG9wdGlvbiBpbiB0aGUge0BsaW5rIFNjaGVtYVRvb2x9LjwvbGk+CiAg\nICAgKiA8bGk+PGk+LWRyb3BTZXF1ZW5jZXMvLWRzcSAmbHQ7dHJ1ZS90IHwg\nZmFsc2UvZiZndDs8L2k+OiBDb3JyZXNwb25kcwogICAgICogdG8gdGhlIHNh\nbWUtbmFtZWQgb3B0aW9uIGluIHRoZSB7QGxpbmsgU2NoZW1hVG9vbH0uPC9s\naT4KICAgICAqIDxsaT48aT4tb3BlbmpwYVRhYmxlcy8ta3QgJmx0O3RydWUv\ndCB8IGZhbHNlL2YmZ3Q7PC9pPjogQ29ycmVzcG9uZHMgdG8KICAgICAqIHRo\nZSBzYW1lLW5hbWVkIG9wdGlvbiBpbiB0aGUge0BsaW5rIFNjaGVtYVRvb2x9\nLjwvbGk+CiAgICAgKiA8bGk+PGk+LWlnbm9yZUVycm9ycy8taSAmbHQ7dHJ1\nZS90IHwgZmFsc2UvZiZndDs8L2k+OiBDb3JyZXNwb25kcyB0byB0aGUKICAg\nICAqIHNhbWUtbmFtZWQgb3B0aW9uIGluIHRoZSB7QGxpbmsgU2NoZW1hVG9v\nbH0uPC9saT4KICAgICAqIDxsaT48aT4tcmVhZFNjaGVtYS8tcnMgJmx0O3Ry\ndWUvdCB8IGZhbHNlL2YmZ3Q7PC9pPjogU2V0IHRoaXMgdG8gdHJ1ZQogICAg\nICogdG8gcmVhZCB0aGUgZW50aXJlIGV4aXN0aW5nIHNjaGVtYSAoZXZlbiB3\naGVuIGZhbHNlIHRoZSBwYXJ0cyBvZgogICAgICogdGhlIHNjaGVtYSB1c2Vk\nIGJ5IGNsYXNzZXMgdGhlIHRvb2wgaXMgcnVuIG9uIHdpbGwgc3RpbGwgYmUg\ncmVhZCkuCiAgICAgKiBUdXJuaW5nIG9uIHNjaGVtYSByZWFkaW5nIGNhbiBl\nbnN1cmUgdGhhdCBubyBuYW1pbmcgY29uZmxpY3RzIHdpbGwKICAgICAqIG9j\nY3VyLCBidXQgaXQgY2FuIHRha2UgYSBsb25nIHRpbWUuPC9saT4KICAgICAq\nIDxsaT48aT4tcHJpbWFyeUtleXMvLXBrICZsdDt0cnVlL3QgfCBmYWxzZS9m\nJmd0OzwvaT46IFdoZXRoZXIgcHJpbWFyeQogICAgICoga2V5cyBvbiBleGlz\ndGluZyB0YWJsZXMgYXJlIG1hbmlwdWxhdGVkLiBEZWZhdWx0cyB0byBmYWxz\nZS48L2xpPgogICAgICogPGxpPjxpPi1mb3JlaWduS2V5cy8tZmsgJmx0O3Ry\ndWUvdCB8IGZhbHNlL2YmZ3Q7PC9pPjogV2hldGhlciBmb3JlaWduCiAgICAg\nKiBrZXlzIG9uIGV4aXN0aW5nIHRhYmxlcyBhcmUgbWFuaXB1bGF0ZWQuIERl\nZmF1bHRzIHRvIGZhbHNlLjwvbGk+CiAgICAgKiA8bGk+PGk+LWluZGV4ZXMv\nLWl4ICZsdDt0cnVlL3QgfCBmYWxzZS9mJmd0OzwvaT46IFdoZXRoZXIgaW5k\nZXhlcyBvbgogICAgICogZXhpc3RpbmcgdGFibGVzIGFyZSBtYW5pcHVsYXRl\nZC4gRGVmYXVsdHMgdG8gZmFsc2UuPC9saT4KICAgICAqIDxsaT48aT4tc2Vx\ndWVuY2VzLy1zcSAmbHQ7dHJ1ZS90IHwgZmFsc2UvZiZndDs8L2k+OiBXaGV0\naGVyIHNlcXVlbmNlcwogICAgICogYXJlIG1hbmlwdWxhdGVkLiBEZWZhdWx0\ncyB0byB0cnVlLjwvbGk+CiAgICAgKiA8bGk+PGk+LXNjaGVtYXMvLXMgJmx0\nO3NjaGVtYSBhbmQgdGFibGUgbmFtZXMmZ3Q7PC9pPjogQSBsaXN0IG9mIHNj\naGVtYXMKICAgICAqIGFuZC9vciB0YWJsZXMgdG8gcmVhZC4gQ29ycmVzcG9u\nZHMgdG8gdGhlCiAgICAgKiBzYW1lLW5hbWVkIG9wdGlvbiBpbiB0aGUge0Bs\naW5rIFNjaGVtYUdlbmVyYXRvcn0uIFRoaXMgb3B0aW9uCiAgICAgKiBpcyBp\nZ25vcmVkIGlmIDxjb2RlPnJlYWRTY2hlbWE8L2NvZGU+IGlzIGZhbHNlLjwv\nbGk+CiAgICAgKiA8bGk+PGk+LW1ldGEvLW0gJmx0O3RydWUvdCB8IGZhbHNl\nL2YmZ3Q7PC9pPjogV2hldGhlciB0aGUgZ2l2ZW4gYWN0aW9uCiAgICAgKiBh\ncHBsaWVzIHRvIG1ldGFkYXRhIGFzIHdlbGwgYXMgbWFwcGluZ3MuPC9saT4K\nICAgICAqIDwvdWw+CiAgICAgKiAgVGhlIHZhcmlvdXMgYWN0aW9ucyBhcmUg\nYXMgZm9sbG93cy4KICAgICAqIDx1bD4KICAgICAqIDxsaT48aT5yZWZyZXNo\nPC9pPjogQnJpbmcgdGhlIG1hcHBpbmcgaW5mb3JtYXRpb24gdXAtdG8tZGF0\nZQogICAgICogd2l0aCB0aGUgY2xhc3MgZGVmaW5pdGlvbnMuIE9wZW5KUEEg\nd2lsbCBhdHRlbXB0IHRvIHVzZSBhbnkgcHJvdmlkZWQKICAgICAqIG1hcHBp\nbmcgaW5mb3JtYXRpb24sIGFuZCBmaWxsIGluIG1pc3NpbmcgaW5mb3JtYXRp\nb24uIElmIHRoZQogICAgICogcHJvdmlkZWQgaW5mb3JtYXRpb24gY29uZmxp\nY3RzIHdpdGggdGhlIGNsYXNzIGRlZmluaXRpb24sIHRoZQogICAgICogY29u\nZmxpY3RpbmcgaW5mb3JtYXRpb24gd2lsbCBiZSBkaXNjYXJkZWQgYW5kIHRo\nZSBjbGFzcy9maWVsZCB3aWxsCiAgICAgKiBiZSByZS1tYXBwZWQgdG8gbmV3\nIGNvbHVtbnMvdGFibGVzLiBUaGlzIGlzIHRoZSBkZWZhdWx0IGFjdGlvbi48\nL2xpPgogICAgICogPGxpPjxpPmFkZDwvaT46IElmIHVzZWQgd2l0aCB0aGUg\nPGNvZGU+LW1ldGE8L2NvZGU+IG9wdGlvbiwgYWRkcyBuZXcKICAgICAqIGRl\nZmF1bHQgbWV0YWRhdGEgZm9yIHRoZSBnaXZlbiBjbGFzcyhlcykuIE90aGVy\nd2lzZSwgYnJpbmdzIHRoZQogICAgICogbWFwcGluZyBpbmZvcm1hdGlvbiB1\ncC10by1kYXRlIHdpdGggdGhlIGNsYXNzCiAgICAgKiBkZWZpbml0aW9ucy4g\nT3BlbkpQQSB3aWxsIGF0dGVtcHQgdG8gdXNlIGFueSBwcm92aWRlZCBtYXBw\naW5nCiAgICAgKiBpbmZvcm1hdGlvbiwgYW5kIGZpbGwgaW4gbWlzc2luZyBp\nbmZvcm1hdGlvbi4gT3BlbkpQQSB3aWxsIGZhaWwgaWYKICAgICAqIHRoZSBw\ncm92aWRlZCBpbmZvcm1hdGlvbiBjb25mbGljdHMgd2l0aCB0aGUgY2xhc3Mg\nZGVmaW5pdGlvbi48L2xpPgogICAgICogPGxpPjxpPmJ1aWxkU2NoZW1hPC9p\nPjogQ3JlYXRlIHRoZSBzY2hlbWEgbWF0Y2hpbmcgdGhlIGV4aXN0aW5nCiAg\nICAgKiBtYXBwaW5ncyBmb3IgdGhlIGdpdmVuIGNsYXNzKGVzKS4gQW55IGlu\ndmFsaWQgbWFwcGluZyBpbmZvcm1hdGlvbgogICAgICogd2lsbCBjYXVzZSBh\nbiBleGNlcHRpb24uPC9saT4KICAgICAqIDxsaT48aT5kcm9wPC9pPjogRGVs\nZXRlIG1hcHBpbmdzIGZvciB0aGUgZ2l2ZW4gY2xhc3Nlcy4gSWYgdXNlZCB3\naXRoCiAgICAgKiB0aGUgPGNvZGU+LW1ldGE8L2NvZGU+IG9wdGlvbiwgYWxz\nbyBkZWxldGVzIG1ldGFkYXRhLjwvbGk+CiAgICAgKiA8bGk+PGk+dmFsaWRh\ndGU8L2k+OiBWYWxpZGF0ZSB0aGUgZ2l2ZW4gbWFwcGluZ3MuIFRoZSBtYXBw\naW5nCiAgICAgKiByZXBvc2l0b3J5IGFuZCBzY2hlbWEgd2lsbCBub3QgYmUg\nYWZmZWN0ZWQuPC9saT4KICAgICAqIDxsaT48aT5pbXBvcnQ8L2k+OiBJbXBv\ncnQgbWFwcGluZ3MgZnJvbSBhbiBYTUwgZG9jdW1lbnQgYW5kIHN0b3JlCiAg\nICAgKiB0aGVtIGFzIHRoZSBjdXJyZW50IHN5c3RlbSBtYXBwaW5ncy48L2xp\nPgogICAgICogPGxpPjxpPmV4cG9ydDwvaT46IER1bXAgdGhlIGN1cnJlbnQg\nbWFwcGluZ3MgZm9yIHRoZSBnaXZlbiBjbGFzc2VzIHRvCiAgICAgKiBhbiBY\nTUwgZG9jdW1lbnQgc3BlY2lmaWVkIGJ5IHRoZSA8Y29kZT5maWxlPC9jb2Rl\nPiBvcHRpb24uPC9saT4KICAgICAqIElmIHVzZWQgd2l0aCB0aGUgPGNvZGU+\nLW1ldGE8L2NvZGU+IG9wdGlvbiwgdGhlIG1ldGFkYXRhIHdpbGwgYmUKICAg\nICAqIGluY2x1ZGVkIGluIHRoZSBleHBvcnQuCiAgICAgKiA8L3VsPgogICAg\nICogIEVhY2ggY2xhc3Mgc3VwcGxpZWQgYXMgYW4gYXJndW1lbnQgbXVzdCBo\nYXZlIHZhbGlkIG1ldGFkYXRhLiBJZgogICAgICogbm8gY2xhc3MgYXJndW1l\nbnRzIGFyZSBnaXZlbiwgdGhlIHRvb2wgcnVucyBvbiBhbGwgbWV0YWRhdGEg\nZmlsZXMgaW4KICAgICAqIHRoZSBDTEFTU1BBVEguCiAgICAgKiAgRXhhbXBs\nZXM6CiAgICAgKiA8dWw+CiAgICAgKiA8bGk+UmVmcmVzaCB0aGUgbWFwcGlu\nZ3MgZm9yIGdpdmVuIHBhY2thZ2UsIHdpdGhvdXQgZHJvcHBpbmcgYW55CiAg\nICAgKiBzY2hlbWEgY29tcG9uZW50czo8YnIgLz4KICAgICAqIDxjb2RlPmph\ndmEgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0YS5NYXBwaW5nVG9vbCAK\nICAgICAqICAgICAgbXlwYWNrYWdlLmpkbzwvY29kZT48L2xpPgogICAgICog\nPGxpPlJlZnJlc2ggdGhlIG1hcHBpbmdzIGZvciBhbGwgcGVyc2lzdGVudCBj\nbGFzc2VzIGluIHRoZSBjbGFzc3BhdGgsCiAgICAgKiBkcm9wcGluZyBhbnkg\ndW51c2VkIGNvbHVtbnMgYW5kIGV2ZW4gdGFibGVzOjxiciAvPgogICAgICog\nPGNvZGU+amF2YSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhLk1hcHBp\nbmdUb29sIC1zYSByZWZyZXNoCiAgICAgKiAtZHQgdHJ1ZTwvY29kZT48L2xp\nPgogICAgICogPGxpPk1ha2Ugc3VyZSB0aGUgbWFwcGluZ3MgeW91J3ZlIGNy\nZWF0ZWQgYnkgaGFuZCBtYXRjaCB0aGUgb2JqZWN0CiAgICAgKiBtb2RlbCBh\nbmQgc2NoZW1hOjxiciAvPgogICAgICogPGNvZGU+amF2YSBvcmcuYXBhY2hl\nLm9wZW5qcGEuamJkYy5tZXRhLk1hcHBpbmdUb29sCiAgICAgKiAtYSB2YWxp\nZGF0ZSBQZXJzb24uamF2YTwvY29kZT48L2xpPgogICAgICogPGxpPlJlbW92\nZSB0aGUgcmVjb3JkZWQgbWFwcGluZyBmb3IgYSBnaXZlbiBjbGFzczo8YnIg\nLz4KICAgICAqIDxjb2RlPmphdmEgb3JnLmFwYWNoZS5vcGVuanBhLmpiZGMu\nbWV0YS5NYXBwaW5nVG9vbAogICAgICogLWEgZHJvcCBQZXJzb24uamF2YTwv\nY29kZT48L2xpPgogICAgICogPGxpPlJlY29yZCB0aGUgY3VycmVudCBtYXBw\naW5ncyBpbiBhbiBYTUwgZmlsZTo8YnIgLz4KICAgICAqIDxjb2RlPmphdmEg\nb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0YS5NYXBwaW5nVG9vbAogICAg\nICogLWYgbXlwYWNrYWdlLm9ybSAtYSBleHBvcnQgbXlwYWNrYWdlLmpkbzwv\nY29kZT48L2xpPgogICAgICogPC91bD4KICAgICAqLwogICAgcHVibGljIHN0\nYXRpYyB2b2lkIG1haW4oU3RyaW5nW10gYXJndW1lbnRzKQogICAgICAgIHRo\ncm93cyBJT0V4Y2VwdGlvbiwgU1FMRXhjZXB0aW9uIHsKICAgICAgICBPcHRp\nb25zIG9wdHMgPSBuZXcgT3B0aW9ucygpOwogICAgICAgIGZpbmFsIFN0cmlu\nZ1tdIGFyZ3MgPSBvcHRzLnNldEZyb21DbWRMaW5lKGFyZ3VtZW50cyk7CiAg\nICAgICAgYm9vbGVhbiByZXQgPSBDb25maWd1cmF0aW9ucy5ydW5BZ2FpbnN0\nQWxsQW5jaG9ycyhvcHRzLAogICAgICAgICAgICBuZXcgQ29uZmlndXJhdGlv\nbnMuUnVubmFibGUoKSB7CiAgICAgICAgICAgIHB1YmxpYyBib29sZWFuIHJ1\nbihPcHRpb25zIG9wdHMpIHRocm93cyBJT0V4Y2VwdGlvbiwgU1FMRXhjZXB0\naW9uIHsKICAgICAgICAgICAgICAgIEpEQkNDb25maWd1cmF0aW9uIGNvbmYg\nPSBuZXcgSkRCQ0NvbmZpZ3VyYXRpb25JbXBsKCk7CiAgICAgICAgICAgICAg\nICB0cnkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBNYXBwaW5nVG9v\nbC5ydW4oY29uZiwgYXJncywgb3B0cyk7CiAgICAgICAgICAgICAgICB9IGZp\nbmFsbHkgewogICAgICAgICAgICAgICAgICAgIGNvbmYuY2xvc2UoKTsKICAg\nICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0pOwogICAg\nICAgIGlmICghcmV0KQogICAgICAgICAgICBTeXN0ZW0uZXJyLnByaW50bG4o\nX2xvYy5nZXQoInRvb2wtdXNhZ2UiKSk7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBSdW4gdGhlIHRvb2wuIFJldHVybnMgZmFsc2UgaWYgaW52YWxpZCBvcHRp\nb25zIGFyZSBnaXZlbi4KICAgICAqCiAgICAgKiBAc2VlICNtYWluCiAgICAg\nKi8KICAgIHB1YmxpYyBzdGF0aWMgYm9vbGVhbiBydW4oSkRCQ0NvbmZpZ3Vy\nYXRpb24gY29uZiwgU3RyaW5nW10gYXJncywKICAgICAgICBPcHRpb25zIG9w\ndHMpCiAgICAgICAgdGhyb3dzIElPRXhjZXB0aW9uLCBTUUxFeGNlcHRpb24g\newogICAgICAgIC8vIGZsYWdzCiAgICAgICAgRmxhZ3MgZmxhZ3MgPSBuZXcg\nRmxhZ3MoKTsKICAgICAgICBmbGFncy5hY3Rpb24gPSBvcHRzLnJlbW92ZVBy\nb3BlcnR5KCJhY3Rpb24iLCAiYSIsIGZsYWdzLmFjdGlvbik7CiAgICAgICAg\nZmxhZ3Muc2NoZW1hQWN0aW9uID0gb3B0cy5yZW1vdmVQcm9wZXJ0eSgic2No\nZW1hQWN0aW9uIiwgInNhIiwKICAgICAgICAgICAgZmxhZ3Muc2NoZW1hQWN0\naW9uKTsKICAgICAgICBmbGFncy5kcm9wVGFibGVzID0gb3B0cy5yZW1vdmVC\nb29sZWFuUHJvcGVydHkKICAgICAgICAgICAgKCJkcm9wVGFibGVzIiwgImR0\nIiwgZmxhZ3MuZHJvcFRhYmxlcyk7CiAgICAgICAgZmxhZ3Mub3BlbmpwYVRh\nYmxlcyA9IG9wdHMucmVtb3ZlQm9vbGVhblByb3BlcnR5CiAgICAgICAgICAg\nICgib3BlbmpwYVRhYmxlcyIsICJvdCIsIGZsYWdzLm9wZW5qcGFUYWJsZXMp\nOwogICAgICAgIGZsYWdzLmRyb3BTZXF1ZW5jZXMgPSBvcHRzLnJlbW92ZUJv\nb2xlYW5Qcm9wZXJ0eQogICAgICAgICAgICAoImRyb3BTZXF1ZW5jZXMiLCAi\nZHNxIiwgZmxhZ3MuZHJvcFNlcXVlbmNlcyk7CiAgICAgICAgZmxhZ3MucmVh\nZFNjaGVtYSA9IG9wdHMucmVtb3ZlQm9vbGVhblByb3BlcnR5CiAgICAgICAg\nICAgICgicmVhZFNjaGVtYSIsICJycyIsIGZsYWdzLnJlYWRTY2hlbWEpOwog\nICAgICAgIGZsYWdzLnByaW1hcnlLZXlzID0gb3B0cy5yZW1vdmVCb29sZWFu\nUHJvcGVydHkKICAgICAgICAgICAgKCJwcmltYXJ5S2V5cyIsICJwayIsIGZs\nYWdzLnByaW1hcnlLZXlzKTsKICAgICAgICBmbGFncy5pbmRleGVzID0gb3B0\ncy5yZW1vdmVCb29sZWFuUHJvcGVydHkoImluZGV4ZXMiLCAiaXgiLAogICAg\nICAgICAgICBmbGFncy5pbmRleGVzKTsKICAgICAgICBmbGFncy5mb3JlaWdu\nS2V5cyA9IG9wdHMucmVtb3ZlQm9vbGVhblByb3BlcnR5KCJmb3JlaWduS2V5\ncyIsICJmayIsCiAgICAgICAgICAgIGZsYWdzLmZvcmVpZ25LZXlzKTsKICAg\nICAgICBmbGFncy5zZXF1ZW5jZXMgPSBvcHRzLnJlbW92ZUJvb2xlYW5Qcm9w\nZXJ0eSgic2VxdWVuY2VzIiwgInNxIiwKICAgICAgICAgICAgZmxhZ3Muc2Vx\ndWVuY2VzKTsKICAgICAgICBmbGFncy5pZ25vcmVFcnJvcnMgPSBvcHRzLnJl\nbW92ZUJvb2xlYW5Qcm9wZXJ0eQogICAgICAgICAgICAoImlnbm9yZUVycm9y\ncyIsICJpIiwgZmxhZ3MuaWdub3JlRXJyb3JzKTsKICAgICAgICBmbGFncy5t\nZXRhID0gb3B0cy5yZW1vdmVCb29sZWFuUHJvcGVydHkoIm1ldGEiLCAibSIs\nIGZsYWdzLm1ldGEpOwogICAgICAgIFN0cmluZyBmaWxlTmFtZSA9IG9wdHMu\ncmVtb3ZlUHJvcGVydHkoImZpbGUiLCAiZiIsIG51bGwpOwogICAgICAgIFN0\ncmluZyBzY2hlbWFGaWxlTmFtZSA9IG9wdHMucmVtb3ZlUHJvcGVydHkoInNj\naGVtYUZpbGUiLCAic2YiLCBudWxsKTsKICAgICAgICBTdHJpbmcgc3FsRmls\nZU5hbWUgPSBvcHRzLnJlbW92ZVByb3BlcnR5KCJzcWxGaWxlIiwgInNxbCIs\nIG51bGwpOwogICAgICAgIFN0cmluZyBzY2hlbWFzID0gb3B0cy5yZW1vdmVQ\ncm9wZXJ0eSgicyIpOwogICAgICAgIGlmIChzY2hlbWFzICE9IG51bGwpCiAg\nICAgICAgICAgIG9wdHMuc2V0UHJvcGVydHkoInNjaGVtYXMiLCBzY2hlbWFz\nKTsKCiAgICAgICAgQ29uZmlndXJhdGlvbnMucG9wdWxhdGVDb25maWd1cmF0\naW9uKGNvbmYsIG9wdHMpOwogICAgICAgIENsYXNzTG9hZGVyIGxvYWRlciA9\nIGNvbmYuZ2V0Q2xhc3NSZXNvbHZlckluc3RhbmNlKCkuCiAgICAgICAgICAg\nIGdldENsYXNzTG9hZGVyKE1hcHBpbmdUb29sLmNsYXNzLCBudWxsKTsKICAg\nICAgICBpZiAoZmxhZ3MubWV0YSAmJiBBQ1RJT05fQURELmVxdWFscyhmbGFn\ncy5hY3Rpb24pKQogICAgICAgICAgICBmbGFncy5tZXRhRGF0YUZpbGUgPSBG\naWxlcy5nZXRGaWxlKGZpbGVOYW1lLCBsb2FkZXIpOwogICAgICAgIGVsc2UK\nICAgICAgICAgICAgZmxhZ3MubWFwcGluZ1dyaXRlciA9IEZpbGVzLmdldFdy\naXRlcihmaWxlTmFtZSwgbG9hZGVyKTsKICAgICAgICBmbGFncy5zY2hlbWFX\ncml0ZXIgPSBGaWxlcy5nZXRXcml0ZXIoc2NoZW1hRmlsZU5hbWUsIGxvYWRl\ncik7CiAgICAgICAgZmxhZ3Muc3FsV3JpdGVyID0gRmlsZXMuZ2V0V3JpdGVy\nKHNxbEZpbGVOYW1lLCBsb2FkZXIpOwoKICAgICAgICByZXR1cm4gcnVuKGNv\nbmYsIGFyZ3MsIGZsYWdzLCBsb2FkZXIpOwogICAgfQoKICAgIC8qKgogICAg\nICogUnVuIHRoZSB0b29sLiBSZXR1cm4gZmFsc2UgaWYgYW4gaW52YWxpZCBv\ncHRpb24gd2FzIGdpdmVuLgogICAgICovCiAgICBwdWJsaWMgc3RhdGljIGJv\nb2xlYW4gcnVuKEpEQkNDb25maWd1cmF0aW9uIGNvbmYsIFN0cmluZ1tdIGFy\nZ3MsCiAgICAgICAgRmxhZ3MgZmxhZ3MsIENsYXNzTG9hZGVyIGxvYWRlcikK\nICAgICAgICB0aHJvd3MgSU9FeGNlcHRpb24sIFNRTEV4Y2VwdGlvbiB7CiAg\nICAgICAgLy8gZGVmYXVsdCBhY3Rpb24gYmFzZWQgb24gd2hldGhlciB0aGUg\nbWFwcGluZyBkZWZhdWx0cyBmaWxscyBpbgogICAgICAgIC8vIG1pc3Npbmcg\naW5mbwogICAgICAgIGlmIChmbGFncy5hY3Rpb24gPT0gbnVsbCkgewogICAg\nICAgICAgICBpZiAoY29uZi5nZXRNYXBwaW5nRGVmYXVsdHNJbnN0YW5jZSgp\nLmRlZmF1bHRNaXNzaW5nSW5mbygpKQogICAgICAgICAgICAgICAgZmxhZ3Mu\nYWN0aW9uID0gQUNUSU9OX0JVSUxEX1NDSEVNQTsKICAgICAgICAgICAgZWxz\nZQogICAgICAgICAgICAgICAgZmxhZ3MuYWN0aW9uID0gQUNUSU9OX1JFRlJF\nU0g7CiAgICAgICAgfQoKICAgICAgICAvLyBjb2xsZWN0IHRoZSBjbGFzc2Vz\nIHRvIGFjdCBvbgogICAgICAgIExvZyBsb2cgPSBjb25mLmdldExvZyhPcGVu\nSlBBQ29uZmlndXJhdGlvbi5MT0dfVE9PTCk7CiAgICAgICAgQ29sbGVjdGlv\nbjxDbGFzczw/Pj4gY2xhc3NlcyA9IG51bGw7CiAgICAgICAgaWYgKGFyZ3Mu\nbGVuZ3RoID09IDApIHsKICAgICAgICAgICAgaWYgKEFDVElPTl9JTVBPUlQu\nZXF1YWxzKGZsYWdzLmFjdGlvbikpCiAgICAgICAgICAgICAgICByZXR1cm4g\nZmFsc2U7CiAgICAgICAgICAgIGxvZy5pbmZvKF9sb2MuZ2V0KCJydW5uaW5n\nLWFsbC1jbGFzc2VzIikpOwogICAgICAgICAgICBjbGFzc2VzID0gY29uZi5n\nZXRNYXBwaW5nUmVwb3NpdG9yeUluc3RhbmNlKCkuCiAgICAgICAgICAgICAg\nICBsb2FkUGVyc2lzdGVudFR5cGVzKHRydWUsIGxvYWRlcik7CiAgICAgICAg\nfSBlbHNlIHsKICAgICAgICAgICAgY2xhc3NlcyA9IG5ldyBIYXNoU2V0PENs\nYXNzPD8+PigpOwogICAgICAgICAgICBDbGFzc0FyZ1BhcnNlciBjbGFzc1Bh\ncnNlciA9IGNvbmYuZ2V0TWV0YURhdGFSZXBvc2l0b3J5SW5zdGFuY2UoKS4K\nICAgICAgICAgICAgICAgIGdldE1ldGFEYXRhRmFjdG9yeSgpLm5ld0NsYXNz\nQXJnUGFyc2VyKCk7CiAgICAgICAgICAgIGNsYXNzUGFyc2VyLnNldENsYXNz\nTG9hZGVyKGxvYWRlcik7CiAgICAgICAgICAgIENsYXNzPD8+W10gcGFyc2Vk\nOwogICAgICAgICAgICBmb3IgKGludCBpID0gMDsgYXJncyAhPSBudWxsICYm\nIGkgPCBhcmdzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgICBwYXJz\nZWQgPSBjbGFzc1BhcnNlci5wYXJzZVR5cGVzKGFyZ3NbaV0pOwogICAgICAg\nICAgICAgICAgY2xhc3Nlcy5hZGRBbGwoQXJyYXlzLmFzTGlzdChwYXJzZWQp\nKTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgQ2xhc3M8Pz5b\nXSBhY3QgPSAoQ2xhc3NbXSkgY2xhc3Nlcy50b0FycmF5KG5ldyBDbGFzc1tj\nbGFzc2VzLnNpemUoKV0pOwogICAgICAgIGlmIChBQ1RJT05fRVhQT1JULmVx\ndWFscyhmbGFncy5hY3Rpb24pKSB7CiAgICAgICAgICAgIC8vIHJ1biBleHBv\ncnRzIHVudGlsIHRoZSBmaXJzdCBleHBvcnQgc3VjY2VlZHMKICAgICAgICAg\nICAgSW1wb3J0RXhwb3J0W10gaW5zdGFuY2VzID0gbmV3SW1wb3J0RXhwb3J0\ncygpOwogICAgICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGluc3RhbmNl\ncy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgaWYgKGluc3RhbmNl\nc1tpXS5leHBvcnRNYXBwaW5ncyhjb25mLCBhY3QsIGZsYWdzLm1ldGEsIGxv\nZywKICAgICAgICAgICAgICAgICAgICBmbGFncy5tYXBwaW5nV3JpdGVyKSkK\nICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAg\nfQogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQogICAgICAg\nIGlmIChBQ1RJT05fSU1QT1JULmVxdWFscyhmbGFncy5hY3Rpb24pKSB7CiAg\nICAgICAgICAgIC8vIHJ1biBleHBvcnRzIHVudGlsIHRoZSBmaXJzdCBleHBv\ncnQgc3VjY2VlZHMKICAgICAgICAgICAgSW1wb3J0RXhwb3J0W10gaW5zdGFu\nY2VzID0gbmV3SW1wb3J0RXhwb3J0cygpOwogICAgICAgICAgICBmb3IgKGlu\ndCBpID0gMDsgaSA8IGluc3RhbmNlcy5sZW5ndGg7IGkrKykgewogICAgICAg\nICAgICAgICAgaWYgKGluc3RhbmNlc1tpXS5pbXBvcnRNYXBwaW5ncyhjb25m\nLCBhY3QsIGFyZ3MsIGZsYWdzLm1ldGEsCiAgICAgICAgICAgICAgICAgICAg\nbG9nLCBsb2FkZXIpKQogICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVl\nOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAg\nICAgICB9CgogICAgICAgIE1hcHBpbmdUb29sIHRvb2w7CiAgICAgICAgdHJ5\nIHsKICAgICAgICAgICAgdG9vbCA9IG5ldyBNYXBwaW5nVG9vbChjb25mLCBm\nbGFncy5hY3Rpb24sIGZsYWdzLm1ldGEpOwogICAgICAgIH0gY2F0Y2ggKEls\nbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiBpYWUpIHsKICAgICAgICAgICAgcmV0\ndXJuIGZhbHNlOwogICAgICAgIH0KCiAgICAgICAgLy8gc2V0dXAgdGhlIHRv\nb2wKICAgICAgICB0b29sLnNldElnbm9yZUVycm9ycyhmbGFncy5pZ25vcmVF\ncnJvcnMpOwogICAgICAgIHRvb2wuc2V0TWV0YURhdGFGaWxlKGZsYWdzLm1l\ndGFEYXRhRmlsZSk7CiAgICAgICAgdG9vbC5zZXRNYXBwaW5nV3JpdGVyKGZs\nYWdzLm1hcHBpbmdXcml0ZXIpOwogICAgICAgIHRvb2wuc2V0U2NoZW1hQWN0\naW9uKGZsYWdzLnNjaGVtYUFjdGlvbik7CiAgICAgICAgdG9vbC5zZXRTY2hl\nbWFXcml0ZXIoZmxhZ3Muc2NoZW1hV3JpdGVyKTsKICAgICAgICB0b29sLnNl\ndFJlYWRTY2hlbWEoZmxhZ3MucmVhZFNjaGVtYQogICAgICAgICAgICAmJiAh\nQUNUSU9OX1ZBTElEQVRFLmVxdWFscyhmbGFncy5hY3Rpb24pKTsKICAgICAg\nICB0b29sLnNldFByaW1hcnlLZXlzKGZsYWdzLnByaW1hcnlLZXlzKTsKICAg\nICAgICB0b29sLnNldEZvcmVpZ25LZXlzKGZsYWdzLmZvcmVpZ25LZXlzKTsK\nICAgICAgICB0b29sLnNldEluZGV4ZXMoZmxhZ3MuaW5kZXhlcyk7CiAgICAg\nICAgdG9vbC5zZXRTZXF1ZW5jZXMoZmxhZ3Muc2VxdWVuY2VzIHx8IGZsYWdz\nLmRyb3BTZXF1ZW5jZXMpOwoKICAgICAgICAvLyBhbmQgcnVuIHRoZSBhY3Rp\nb24KICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGFjdC5sZW5ndGg7IGkr\nKykgewogICAgICAgICAgICBsb2cuaW5mbyhfbG9jLmdldCgidG9vbC1ydW5u\naW5nIiwgYWN0W2ldLCBmbGFncy5hY3Rpb24pKTsKICAgICAgICAgICAgaWYg\nKGkgPT0gMCAmJiBmbGFncy5yZWFkU2NoZW1hKQogICAgICAgICAgICAgICAg\nbG9nLmluZm8oX2xvYy5nZXQoInRvb2wtdGltZSIpKTsKICAgICAgICAgICAg\ndG9vbC5ydW4oYWN0W2ldKTsKICAgICAgICB9CiAgICAgICAgbG9nLmluZm8o\nX2xvYy5nZXQoInRvb2wtcmVjb3JkIikpOwogICAgICAgIHRvb2wucmVjb3Jk\nKGZsYWdzKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvKioK\nICAgICAqIENyZWF0ZSBhbiB7QGxpbmsgSW1wb3J0RXhwb3J0fSBpbnN0YW5j\nZS4KICAgICAqLwogICAgcHJpdmF0ZSBzdGF0aWMgSW1wb3J0RXhwb3J0W10g\nbmV3SW1wb3J0RXhwb3J0cygpIHsKICAgICAgICB0cnkgewogICAgICAgICAg\nICBDbGFzczw/PltdIHR5cGVzID0gU2VydmljZXMuZ2V0SW1wbGVtZW50b3JD\nbGFzc2VzKEltcG9ydEV4cG9ydC5jbGFzcyk7CiAgICAgICAgICAgIEltcG9y\ndEV4cG9ydFtdIGluc3RhbmNlcyA9IG5ldyBJbXBvcnRFeHBvcnRbdHlwZXMu\nbGVuZ3RoXTsKICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCB0eXBl\ncy5sZW5ndGg7IGkrKykKICAgICAgICAgICAgICAgIGluc3RhbmNlc1tpXSA9\nIChJbXBvcnRFeHBvcnQpIEFjY2Vzc0NvbnRyb2xsZXIuZG9Qcml2aWxlZ2Vk\nKAogICAgICAgICAgICAgICAgICAgIEoyRG9Qcml2SGVscGVyLm5ld0luc3Rh\nbmNlQWN0aW9uKHR5cGVzW2ldKSk7CiAgICAgICAgICAgIHJldHVybiBpbnN0\nYW5jZXM7CiAgICAgICAgfSBjYXRjaCAoVGhyb3dhYmxlIHQpIHsKICAgICAg\nICAgICAgaWYgKHQgaW5zdGFuY2VvZiBQcml2aWxlZ2VkQWN0aW9uRXhjZXB0\naW9uKQogICAgICAgICAgICAgICAgdCA9ICgoUHJpdmlsZWdlZEFjdGlvbkV4\nY2VwdGlvbikgdCkuZ2V0RXhjZXB0aW9uKCk7CiAgICAgICAgICAgIHRocm93\nIG5ldyBJbnRlcm5hbEV4Y2VwdGlvbihfbG9jLmdldCgiaW1wb3J0ZXhwb3J0\nLWluc3RhbnRpYXRlIiksdCk7CiAgICAgICAgfQogICAgfQogICAgCiAgICBw\ncml2YXRlIHN0YXRpYyBib29sZWFuIGNvbnRhaW5zKFN0cmluZyBsaXN0LCBT\ndHJpbmcga2V5KSB7CiAgICAJcmV0dXJuIChsaXN0ID09IG51bGwpID8gZmFs\nc2UgOiBsaXN0LmluZGV4T2Yoa2V5KSAhPSAtMTsKICAgIH0KCiAgICAvKioK\nICAgICAqIFJ1biBmbGFncy4KICAgICAqLwogICAgcHVibGljIHN0YXRpYyBj\nbGFzcyBGbGFncyB7CgogICAgICAgIHB1YmxpYyBTdHJpbmcgYWN0aW9uID0g\nbnVsbDsKICAgICAgICBwdWJsaWMgYm9vbGVhbiBtZXRhID0gZmFsc2U7CiAg\nICAgICAgcHVibGljIFN0cmluZyBzY2hlbWFBY3Rpb24gPSBTY2hlbWFUb29s\nLkFDVElPTl9BREQ7CiAgICAgICAgcHVibGljIEZpbGUgbWV0YURhdGFGaWxl\nID0gbnVsbDsKICAgICAgICBwdWJsaWMgV3JpdGVyIG1hcHBpbmdXcml0ZXIg\nPSBudWxsOwogICAgICAgIHB1YmxpYyBXcml0ZXIgc2NoZW1hV3JpdGVyID0g\nbnVsbDsKICAgICAgICBwdWJsaWMgV3JpdGVyIHNxbFdyaXRlciA9IG51bGw7\nCiAgICAgICAgcHVibGljIGJvb2xlYW4gaWdub3JlRXJyb3JzID0gZmFsc2U7\nCiAgICAgICAgcHVibGljIGJvb2xlYW4gcmVhZFNjaGVtYSA9IGZhbHNlOwog\nICAgICAgIHB1YmxpYyBib29sZWFuIGRyb3BUYWJsZXMgPSBmYWxzZTsKICAg\nICAgICBwdWJsaWMgYm9vbGVhbiBvcGVuanBhVGFibGVzID0gZmFsc2U7CiAg\nICAgICAgcHVibGljIGJvb2xlYW4gZHJvcFNlcXVlbmNlcyA9IGZhbHNlOwog\nICAgICAgIHB1YmxpYyBib29sZWFuIHNlcXVlbmNlcyA9IHRydWU7CiAgICAg\nICAgcHVibGljIGJvb2xlYW4gcHJpbWFyeUtleXMgPSBmYWxzZTsKICAgICAg\nICBwdWJsaWMgYm9vbGVhbiBmb3JlaWduS2V5cyA9IGZhbHNlOwogICAgICAg\nIHB1YmxpYyBib29sZWFuIGluZGV4ZXMgPSBmYWxzZTsKICAgIH0KCiAgICAv\nKioKICAgICAqIEhlbHBlciB1c2VkIHRvIGltcG9ydCBhbmQgZXhwb3J0IG1h\ncHBpbmcgZGF0YS4KICAgICAqLwogICAgcHVibGljIHN0YXRpYyBpbnRlcmZh\nY2UgSW1wb3J0RXhwb3J0IHsKCiAgICAgICAgLyoqCiAgICAgICAgICogSW1w\nb3J0IG1hcHBpbmdzIGZvciB0aGUgZ2l2ZW4gY2xhc3NlcyBiYXNlZCBvbiB0\naGUgZ2l2ZW4gYXJndW1lbnRzLgogICAgICAgICAqLwogICAgICAgIHB1Ymxp\nYyBib29sZWFuIGltcG9ydE1hcHBpbmdzKEpEQkNDb25maWd1cmF0aW9uIGNv\nbmYsIENsYXNzPD8+W10gYWN0LAogICAgICAgICAgICBTdHJpbmdbXSBhcmdz\nLCBib29sZWFuIG1ldGEsIExvZyBsb2csIENsYXNzTG9hZGVyIGxvYWRlcikK\nICAgICAgICAgICAgdGhyb3dzIElPRXhjZXB0aW9uOwoKICAgICAgICAvKioK\nICAgICAgICAgKiBFeHBvcnQgbWFwcGluZ3MgZm9yIHRoZSBnaXZlbiBjbGFz\nc2VzIGJhc2VkIG9uIHRoZSBnaXZlbiBhcmd1bWVudHMuCiAgICAgICAgICov\nCiAgICAgICAgcHVibGljIGJvb2xlYW4gZXhwb3J0TWFwcGluZ3MoSkRCQ0Nv\nbmZpZ3VyYXRpb24gY29uZiwgQ2xhc3M8Pz5bXSBhY3QsCiAgICAgICAgICAg\nIGJvb2xlYW4gbWV0YSwgTG9nIGxvZywgV3JpdGVyIHdyaXRlcikKICAgICAg\nICAgICAgdGhyb3dzIElPRXhjZXB0aW9uOwogICAgfQp9Cg==\n","encoding":"base64"}

