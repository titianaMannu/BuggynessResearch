{"sha":"9b9fd93f6f9bdc99eb59fc131eb8a533da61f2e2","node_id":"MDQ6QmxvYjIwNjM2NDo5YjlmZDkzZjZmOWJkYzk5ZWI1OWZjMTMxZWI4YTUzM2RhNjFmMmUy","size":80355,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/9b9fd93f6f9bdc99eb59fc131eb8a533da61f2e2","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhOwoKaW1wb3J0\nIGphdmEuaW8uQnVmZmVyZWRSZWFkZXI7CmltcG9ydCBqYXZhLmlvLkZpbGU7\nCmltcG9ydCBqYXZhLmlvLkZpbGVJbnB1dFN0cmVhbTsKaW1wb3J0IGphdmEu\naW8uRmlsZU5vdEZvdW5kRXhjZXB0aW9uOwppbXBvcnQgamF2YS5pby5JT0V4\nY2VwdGlvbjsKaW1wb3J0IGphdmEuaW8uSW5wdXRTdHJlYW07CmltcG9ydCBq\nYXZhLmlvLklucHV0U3RyZWFtUmVhZGVyOwppbXBvcnQgamF2YS5pby5TdHJp\nbmdXcml0ZXI7CmltcG9ydCBqYXZhLnNlY3VyaXR5LkFjY2Vzc0NvbnRyb2xs\nZXI7CmltcG9ydCBqYXZhLnNlY3VyaXR5LlByaXZpbGVnZWRBY3Rpb25FeGNl\ncHRpb247CmltcG9ydCBqYXZhLnNxbC5TUUxFeGNlcHRpb247CmltcG9ydCBq\nYXZhLnNxbC5UeXBlczsKaW1wb3J0IGphdmEudXRpbC5BcnJheUxpc3Q7Cmlt\ncG9ydCBqYXZhLnV0aWwuQ29sbGVjdGlvbjsKaW1wb3J0IGphdmEudXRpbC5I\nYXNoTWFwOwppbXBvcnQgamF2YS51dGlsLkhhc2hTZXQ7CmltcG9ydCBqYXZh\nLnV0aWwuSXRlcmF0b3I7CmltcG9ydCBqYXZhLnV0aWwuTGlua2VkTGlzdDsK\naW1wb3J0IGphdmEudXRpbC5MaXN0OwppbXBvcnQgamF2YS51dGlsLk1hcDsK\naW1wb3J0IGphdmEudXRpbC5Qcm9wZXJ0aWVzOwppbXBvcnQgamF2YS51dGls\nLlNldDsKaW1wb3J0IGphdmEudXRpbC5UcmVlU2V0OwoKaW1wb3J0IG9yZy5h\ncGFjaGUuY29tbW9ucy5sYW5nLlN0cmluZ1V0aWxzOwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLmNvbmYuT3BlbkpQQUNvbmZpZ3VyYXRpb247CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEuZW5oYW5jZS5BcHBsaWNhdGlvbklkVG9v\nbDsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5lbmhhbmNlLkNvZGVHZW5l\ncmF0b3I7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5jb25mLkpE\nQkNDb25maWd1cmF0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpk\nYmMuY29uZi5KREJDQ29uZmlndXJhdGlvbkltcGw7CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEuamRiYy5tZXRhLnN0cmF0cy5GdWxsQ2xhc3NTdHJhdGVn\neTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLm1ldGEuc3RyYXRz\nLkhhbmRsZXJGaWVsZFN0cmF0ZWd5OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLmpkYmMubWV0YS5zdHJhdHMuTWF4RW1iZWRkZWRCbG9iRmllbGRTdHJh\ndGVneTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLm1ldGEuc3Ry\nYXRzLk1heEVtYmVkZGVkQ2xvYkZpZWxkU3RyYXRlZ3k7CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhLnN0cmF0cy5Ob25lRGlzY3JpbWlu\nYXRvclN0cmF0ZWd5OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMu\nbWV0YS5zdHJhdHMuUHJpbWl0aXZlRmllbGRTdHJhdGVneTsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5qZGJjLm1ldGEuc3RyYXRzLgogICAgICAgIFJl\nbGF0aW9uQ29sbGVjdGlvbkludmVyc2VLZXlGaWVsZFN0cmF0ZWd5OwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0YS5zdHJhdHMuUmVsYXRp\nb25Db2xsZWN0aW9uVGFibGVGaWVsZFN0cmF0ZWd5OwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLmpkYmMubWV0YS5zdHJhdHMuUmVsYXRpb25GaWVsZFN0\ncmF0ZWd5OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0YS5z\ndHJhdHMuU3RhdGVDb21wYXJpc29uVmVyc2lvblN0cmF0ZWd5OwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0YS5zdHJhdHMuU3RyaW5nRmll\nbGRTdHJhdGVneTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLm1l\ndGEuc3RyYXRzLlN1YmNsYXNzSm9pbkRpc2NyaW1pbmF0b3JTdHJhdGVneTsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLm1ldGEuc3RyYXRzLlN1\ncGVyY2xhc3NEaXNjcmltaW5hdG9yU3RyYXRlZ3k7CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEuamRiYy5tZXRhLnN0cmF0cy5TdXBlcmNsYXNzVmVyc2lv\nblN0cmF0ZWd5OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0\nYS5zdHJhdHMuVmVydGljYWxDbGFzc1N0cmF0ZWd5OwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1hLkNvbHVtbjsKaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS5qZGJjLnNjaGVtYS5Gb3JlaWduS2V5OwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1hLkluZGV4OwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1hLlByaW1hcnlLZXk7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hlbWEuU2NoZW1hOwpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1hLlNjaGVtYUdl\nbmVyYXRvcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNjaGVt\nYS5TY2hlbWFHcm91cDsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJj\nLnNjaGVtYS5TY2hlbWFQYXJzZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEuamRiYy5zY2hlbWEuU2NoZW1hczsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5qZGJjLnNjaGVtYS5UYWJsZTsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5qZGJjLnNjaGVtYS5VbmlxdWU7CmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEuamRiYy5zY2hlbWEuWE1MU2NoZW1hUGFyc2VyOwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLmpkYmMuc3FsLlNRTEV4Y2VwdGlvbnM7CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLmNvbmYuQ29uZmlndXJhdGlvbnM7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLmxvZy5Mb2c7CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuQ29kZUZvcm1hdDsKaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIudXRpbC5GaWxlczsKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5saWIudXRpbC5KMkRvUHJpdkhlbHBlcjsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIudXRpbC5Mb2NhbGl6ZXI7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuT3B0aW9uczsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRhLkNsYXNzTWV0YURhdGE7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YS5GaWVsZE1ldGFEYXRh\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuSmF2YVR5cGVzOwpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuTWV0YURhdGFGYWN0b3J5\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuTWV0YURhdGFNb2Rl\nczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRhLk5vbmVNZXRhRGF0\nYUZhY3Rvcnk7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YS5RdWVy\neU1ldGFEYXRhOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuU2Vx\ndWVuY2VNZXRhRGF0YTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGls\nLkludGVybmFsRXhjZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLnV0aWwuTWV0YURhdGFFeGNlcHRpb247CmltcG9ydCBzZXJwLmJ5dGVjb2Rl\nLkJDQ2xhc3M7CmltcG9ydCBzZXJwLmJ5dGVjb2RlLkJDQ2xhc3NMb2FkZXI7\nCmltcG9ydCBzZXJwLmJ5dGVjb2RlLlByb2plY3Q7CmltcG9ydCBzZXJwLnV0\naWwuU3RyaW5nczsKCi8qKgogKiBSZXZlcnNlLW1hcHMgYSBzY2hlbWEgaW50\nbyBjbGFzcyBtYXBwaW5ncyBhbmQgdGhlIGFzc29jaWF0ZWQgamF2YQogKiBj\nb2RlLiBHZW5lcmF0ZXMgYSBKYXZhIGNvZGUgZmlsZXMgZm9yIHBlcnNpc3Rl\nbnQgY2xhc3NlcyBhbmQgYXNzb2NpYXRlZAogKiBpZGVudGl0eSBjbGFzc2Vz\nIGFuZCBtZXRhZGF0YS4KICoKICogQGF1dGhvciBBYmUgV2hpdGUKICovCnB1\nYmxpYyBjbGFzcyBSZXZlcnNlTWFwcGluZ1Rvb2wKICAgIGltcGxlbWVudHMg\nTWV0YURhdGFNb2RlcywgQ2xvbmVhYmxlIHsKCiAgICAvKioKICAgICAqIFVu\nbWFwcGVkIHRhYmxlLgogICAgICovCiAgICBwdWJsaWMgc3RhdGljIGZpbmFs\nIGludCBUQUJMRV9OT05FID0gMDsKCiAgICAvKioKICAgICAqIFByaW1hcnkg\ndGFibGUgZm9yIGEgbmV3IGJhc2UgY2xhc3MuCiAgICAgKi8KICAgIHB1Ymxp\nYyBzdGF0aWMgZmluYWwgaW50IFRBQkxFX0JBU0UgPSAxOwoKICAgIC8qKgog\nICAgICogU2Vjb25kYXJ5IHRhYmxlIG9mIGFuIGV4aXN0aW5nIGNsYXNzLiBU\naGVyZSBpcyBleGFjdGx5IG9uZSByb3cgaW4KICAgICAqIHRoaXMgdGFibGUg\nZm9yIGVhY2ggcm93IGluIHRoZSBwcmltYXJ5IHRhYmxlLgogICAgICovCiAg\nICBwdWJsaWMgc3RhdGljIGZpbmFsIGludCBUQUJMRV9TRUNPTkRBUlkgPSAy\nOwoKICAgIC8qKgogICAgICogU2Vjb25kYXJ5IHRhYmxlIG9mIGFuIGV4aXN0\naW5nIGNsYXNzLiBUaGVyZSBpcyB6ZXJvIG9yIG9uZSByb3cgaW4KICAgICAq\nIHRoaXMgdGFibGUgZm9yIGVhY2ggcm93IGluIHRoZSBwcmltYXJ5IHRhYmxl\nLgogICAgICovCiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIGludCBUQUJMRV9T\nRUNPTkRBUllfT1VURVIgPSAzOwoKICAgIC8qKgogICAgICogQXNzb2NpYXRp\nb24gdGFibGUuCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgaW50\nIFRBQkxFX0FTU09DSUFUSU9OID0gNDsKCiAgICAvKioKICAgICAqIFN1YmNs\nYXNzIHRhYmxlLgogICAgICovCiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIGlu\ndCBUQUJMRV9TVUJDTEFTUyA9IDU7CgogICAgcHVibGljIHN0YXRpYyBmaW5h\nbCBTdHJpbmcgTEVWRUxfTk9ORSA9ICJub25lIjsKICAgIHB1YmxpYyBzdGF0\naWMgZmluYWwgU3RyaW5nIExFVkVMX1BBQ0tBR0UgPSAicGFja2FnZSI7CiAg\nICBwdWJsaWMgc3RhdGljIGZpbmFsIFN0cmluZyBMRVZFTF9DTEFTUyA9ICJj\nbGFzcyI7CgogICAgLyoqCiAgICAgKiBBY2Nlc3MgdHlwZSBmb3IgZ2VuZXJh\ndGVkIHNvdXJjZSwgZGVmYXVsdHMgdG8gZmllbGQtYmFzZWQgYWNjZXNzLgog\nICAgICovCiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIFN0cmluZyBBQ0NFU1Nf\nVFlQRV9GSUVMRCA9ICJmaWVsZCI7CiAgICBwdWJsaWMgc3RhdGljIGZpbmFs\nIFN0cmluZyBBQ0NFU1NfVFlQRV9QUk9QRVJUWSA9ICJwcm9wZXJ0eSI7Cgog\nICAgcHJpdmF0ZSBzdGF0aWMgTG9jYWxpemVyIF9sb2MgPSBMb2NhbGl6ZXIu\nZm9yUGFja2FnZQogICAgICAgIChSZXZlcnNlTWFwcGluZ1Rvb2wuY2xhc3Mp\nOwoKICAgIC8vIG1hcCBqYXZhIGtleXdvcmRzIHRvIHJlbGF0ZWQgd29yZHMg\ndG8gdXNlIGluIHRoZWlyIHBsYWNlCiAgICBwcml2YXRlIHN0YXRpYyBmaW5h\nbCBNYXAgX2phdmFLZXl3b3JkcyA9IG5ldyBIYXNoTWFwKCk7CgogICAgc3Rh\ndGljIHsKICAgICAgICBJbnB1dFN0cmVhbSBpbiA9IFJldmVyc2VNYXBwaW5n\nVG9vbC5jbGFzcy5nZXRSZXNvdXJjZUFzU3RyZWFtCiAgICAgICAgICAgICgi\namF2YS1rZXl3b3Jkcy5yc3JjIik7CiAgICAgICAgdHJ5IHsKICAgICAgICAg\nICAgU3RyaW5nW10ga2V5d29yZHMgPSBTdHJpbmdzLnNwbGl0KG5ldyBCdWZm\nZXJlZFJlYWRlcgogICAgICAgICAgICAgICAgKG5ldyBJbnB1dFN0cmVhbVJl\nYWRlcihpbikpLnJlYWRMaW5lKCksICIsIiwgMCk7CgogICAgICAgICAgICBm\nb3IgKGludCBpID0gMDsgaSA8IGtleXdvcmRzLmxlbmd0aDsgaSArPSAyKQog\nICAgICAgICAgICAgICAgX2phdmFLZXl3b3Jkcy5wdXQoa2V5d29yZHNbaV0s\nIGtleXdvcmRzW2kgKyAxXSk7CiAgICAgICAgfSBjYXRjaCAoSU9FeGNlcHRp\nb24gaW9lKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBJbnRlcm5hbEV4Y2Vw\ndGlvbihpb2UpOwogICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgIHRy\neSB7CiAgICAgICAgICAgICAgICBpbi5jbG9zZSgpOwogICAgICAgICAgICB9\nIGNhdGNoIChJT0V4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgIH0KICAgICAg\nICB9CiAgICB9CgogICAgcHJpdmF0ZSBmaW5hbCBKREJDQ29uZmlndXJhdGlv\nbiBfY29uZjsKICAgIHByaXZhdGUgZmluYWwgTG9nIF9sb2c7CiAgICBwcml2\nYXRlIGZpbmFsIE1hcCBfdGFibGVzID0gbmV3IEhhc2hNYXAoKTsKICAgIHBy\naXZhdGUgZmluYWwgUHJvamVjdCBfcHJvamVjdCA9IG5ldyBQcm9qZWN0KCk7\nCiAgICBwcml2YXRlIGZpbmFsIEJDQ2xhc3NMb2FkZXIgX2xvYWRlciA9IEFj\nY2Vzc0NvbnRyb2xsZXIKICAgICAgICAuZG9Qcml2aWxlZ2VkKEoyRG9Qcml2\nSGVscGVyLm5ld0JDQ2xhc3NMb2FkZXJBY3Rpb24oX3Byb2plY3QpKTsKICAg\nIHByaXZhdGUgU3RyYXRlZ3lJbnN0YWxsZXIgX3N0cmF0ID0gbnVsbDsKICAg\nIHByaXZhdGUgU3RyaW5nIF9wYWNrYWdlID0gbnVsbDsKICAgIHByaXZhdGUg\nRmlsZSBfZGlyID0gbnVsbDsKICAgIHByaXZhdGUgTWFwcGluZ1JlcG9zaXRv\ncnkgX3JlcG9zID0gbnVsbDsKICAgIHByaXZhdGUgU2NoZW1hR3JvdXAgX3Nj\naGVtYSA9IG51bGw7CiAgICBwcml2YXRlIGJvb2xlYW4gX251bGxBc09iaiA9\nIGZhbHNlOwogICAgcHJpdmF0ZSBib29sZWFuIF9ibG9iQXNPYmogPSBmYWxz\nZTsKICAgIHByaXZhdGUgYm9vbGVhbiBfdXNlR2VuZXJpY0NvbGwgPSBmYWxz\nZTsKICAgIHByaXZhdGUgUHJvcGVydGllcyBfdHlwZU1hcCA9IG51bGw7CiAg\nICBwcml2YXRlIGJvb2xlYW4gX3VzZUZLID0gZmFsc2U7CiAgICBwcml2YXRl\nIGJvb2xlYW4gX3VzZVNjaGVtYSA9IGZhbHNlOwogICAgcHJpdmF0ZSBib29s\nZWFuIF9wa09uSm9pbiA9IGZhbHNlOwogICAgcHJpdmF0ZSBib29sZWFuIF9k\nYXRhc3RvcmUgPSBmYWxzZTsKICAgIHByaXZhdGUgYm9vbGVhbiBfYnVpbHRp\nbiA9IHRydWU7CiAgICBwcml2YXRlIGJvb2xlYW4gX2lubmVyID0gZmFsc2U7\nCiAgICBwcml2YXRlIFN0cmluZyBfaWRTdWZmaXggPSAiSWQiOwogICAgcHJp\ndmF0ZSBib29sZWFuIF9pbnZlcnNlID0gdHJ1ZTsKICAgIHByaXZhdGUgYm9v\nbGVhbiBfZGV0YWNoYWJsZSA9IGZhbHNlOwogICAgcHJpdmF0ZSBib29sZWFu\nIF9nZW5Bbm5vdGF0aW9ucyA9IGZhbHNlOwogICAgcHJpdmF0ZSBTdHJpbmcg\nX2FjY2Vzc1R5cGUgPSBBQ0NFU1NfVFlQRV9GSUVMRDsKICAgIHByaXZhdGUg\nQ29kZUZvcm1hdCBfZm9ybWF0ID0gbnVsbDsKICAgIHByaXZhdGUgUmV2ZXJz\nZUN1c3RvbWl6ZXIgX2N1c3RvbSA9IG51bGw7CiAgICBwcml2YXRlIFN0cmlu\nZyBfZGlzY1N0cmF0ID0gbnVsbDsKICAgIHByaXZhdGUgU3RyaW5nIF92ZXJz\nU3RyYXQgPSBudWxsOwoKICAgIC8vIHdlIGhhdmUgdG8gdHJhY2sgZmllbGQg\nbmFtZXMgdGhhdCB3ZXJlIGNyZWF0ZWQgYnV0IHRoZW4gYWJhbmRvbmVkIGJ5\nCiAgICAvLyB0aGUgY3VzdG9taXplciBzbyB0aGF0IHdlIGRvbid0IGF0dGVt\ncHQgdG8gdXNlIHRoZW0gYWdhaW47IGRvaW5nIHNvIGNhbgogICAgLy8gbWVz\ncyB1cCBjZXJ0YWluIGN1c3RvbWl6ZXJzIChidWcgODgxKQogICAgcHJpdmF0\nZSBTZXQgX2FiYW5kb25lZEZpZWxkTmFtZXMgPSBudWxsOwoKICAgIC8vIGdl\nbmVyYXRlZCBhbm5vdGF0aW9ucywga2V5ID0gbWV0YWRhdGEsIHZhbCA9IGxp\nc3Qgb2YgYW5ub3RhdGlvbnMKICAgIHByaXZhdGUgTWFwIF9hbm5vcyA9IG51\nbGw7CgogICAgLyoqCiAgICAgKiBDb25zdHJ1Y3Rvci4gU3VwcGx5IGNvbmZp\nZ3VyYXRpb24uCiAgICAgKi8KICAgIHB1YmxpYyBSZXZlcnNlTWFwcGluZ1Rv\nb2woSkRCQ0NvbmZpZ3VyYXRpb24gY29uZikgewogICAgICAgIF9jb25mID0g\nY29uZjsKICAgICAgICBfbG9nID0gY29uZi5nZXRMb2coSkRCQ0NvbmZpZ3Vy\nYXRpb24uTE9HX01FVEFEQVRBKTsKICAgIH0KCiAgICAvKioKICAgICAqIFJl\ndHVybiB0aGUgaW50ZXJuYWwgc3RyYXRlZ3kgaW5zdGFsbGVyLgogICAgICov\nCiAgICBwcml2YXRlIFN0cmF0ZWd5SW5zdGFsbGVyIGdldFN0cmF0ZWd5SW5z\ndGFsbGVyKCkgewogICAgICAgIGlmIChfc3RyYXQgPT0gbnVsbCkKICAgICAg\nICAgICAgX3N0cmF0ID0gbmV3IFJldmVyc2VTdHJhdGVneUluc3RhbGxlcihn\nZXRSZXBvc2l0b3J5KCkpOwogICAgICAgIHJldHVybiBfc3RyYXQ7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIGNvbmZpZ3VyYXRpb24gcHJv\ndmlkZWQgb24gY29uc3RydWN0aW9uLgogICAgICovCiAgICBwdWJsaWMgSkRC\nQ0NvbmZpZ3VyYXRpb24gZ2V0Q29uZmlndXJhdGlvbigpIHsKICAgICAgICBy\nZXR1cm4gX2NvbmY7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhl\nIGxvZyB0byB3cml0ZSB0by4KICAgICAqLwogICAgcHVibGljIExvZyBnZXRM\nb2coKSB7CiAgICAgICAgcmV0dXJuIF9sb2c7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBSZXR1cm4gdGhlIGRlZmF1bHQgcGFja2FnZSBmb3IgdGhlIGdlbmVy\nYXRlZCBjbGFzc2VzLCBvciBudWxsIGlmIHVuc2V0LgogICAgICovCiAgICBw\ndWJsaWMgU3RyaW5nIGdldFBhY2thZ2VOYW1lKCkgewogICAgICAgIHJldHVy\nbiBfcGFja2FnZTsKICAgIH0KCiAgICAvKioKICAgICAqIFNldCB0aGUgZGVm\nYXVsdCBwYWNrYWdlIGZvciB0aGUgZ2VuZXJhdGVkIGNsYXNzZXM7IHVzZSBu\ndWxsIHRvCiAgICAgKiBpbmRpY2F0ZSBubyBwYWNrYWdlLgogICAgICovCiAg\nICBwdWJsaWMgdm9pZCBzZXRQYWNrYWdlTmFtZShTdHJpbmcgcGFja2FnZU5h\nbWUpIHsKICAgICAgICBfcGFja2FnZSA9IFN0cmluZ1V0aWxzLnRyaW1Ub051\nbGwocGFja2FnZU5hbWUpOwogICAgfQoKICAgIC8qKgogICAgICogVGhlIGZp\nbGUgdG8gb3V0cHV0IHRoZSBnZW5lcmF0ZWQgY29kZSB0bywgb3IgbnVsbCBm\nb3IKICAgICAqIHRoZSBjdXJyZW50IGRpcmVjdG9yeS4gSWYgdGhlIGRpcmVj\ndG9yeSBtYXRjaGVzIHRoZSBwYWNrYWdlLCBpdCB3aWxsCiAgICAgKiBiZSB1\nc2VkLiBPdGhlcndpc2UsIHRoZSBwYWNrYWdlIHN0cnVjdHVyZSB3aWxsIGJl\nIGNyZWF0ZWQgdW5kZXIKICAgICAqIHRoaXMgZGlyZWN0b3J5LgogICAgICov\nCiAgICBwdWJsaWMgRmlsZSBnZXREaXJlY3RvcnkoKSB7CiAgICAgICAgcmV0\ndXJuIF9kaXI7CiAgICB9CgogICAgLyoqCiAgICAgKiBUaGUgZmlsZSB0byBv\ndXRwdXQgdGhlIGdlbmVyYXRlZCBjb2RlIHRvLCBvciBudWxsIGZvcgogICAg\nICogdGhlIGN1cnJlbnQgZGlyZWN0b3J5LiBJZiB0aGUgZGlyZWN0b3J5IG1h\ndGNoZXMgdGhlIHBhY2thZ2UsIGl0IHdpbGwKICAgICAqIGJlIHVzZWQuIE90\naGVyd2lzZSwgdGhlIHBhY2thZ2Ugc3RydWN0dXJlIHdpbGwgYmUgY3JlYXRl\nZCB1bmRlcgogICAgICogdGhpcyBkaXJlY3RvcnkuCiAgICAgKi8KICAgIHB1\nYmxpYyB2b2lkIHNldERpcmVjdG9yeShGaWxlIGRpcikgewogICAgICAgIF9k\naXIgPSBkaXI7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gdHJ1ZSBp\nZiB0aGUgc2NoZW1hIG5hbWUgd2lsbCBiZSBpbmNsdWRlZCBpbiB0aGUgZ2Vu\nZXJhdGVkCiAgICAgKiBjbGFzcyBuYW1lIGZvciBlYWNoIHRhYmxlLiBEZWZh\ndWx0cyB0byBmYWxzZS4KICAgICAqLwogICAgcHVibGljIGJvb2xlYW4gZ2V0\nVXNlU2NoZW1hTmFtZSgpIHsKICAgICAgICByZXR1cm4gX3VzZVNjaGVtYTsK\nICAgIH0KCiAgICAvKioKICAgICAqIFNldCB3aGV0aGVyIHRoZSBzY2hlbWEg\nbmFtZSB3aWxsIGJlIGluY2x1ZGVkIGluIHRoZSBnZW5lcmF0ZWQKICAgICAq\nIGNsYXNzIG5hbWUgZm9yIGVhY2ggdGFibGUuIERlZmF1bHRzIHRvIGZhbHNl\nLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRVc2VTY2hlbWFOYW1lKGJv\nb2xlYW4gdXNlU2NoZW1hKSB7CiAgICAgICAgX3VzZVNjaGVtYSA9IHVzZVNj\naGVtYTsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB3aGV0aGVyIHRo\nZSBmb3JlaWduIGtleSBuYW1lIHdpbGwgYmUgdXNlZCB0byBnZW5lcmF0ZQog\nICAgICogcmVsYXRpb24gbmFtZXMuIERlZmF1bHRzIHRvIGZhbHNlLgogICAg\nICovCiAgICBwdWJsaWMgYm9vbGVhbiBnZXRVc2VGb3JlaWduS2V5TmFtZSgp\nIHsKICAgICAgICByZXR1cm4gX3VzZUZLOwogICAgfQoKICAgIC8qKgogICAg\nICogU2V0IHdoZXRoZXIgdGhlIGZvcmVpZ24ga2V5IG5hbWUgd2lsbCBiZSB1\nc2VkIHRvIGdlbmVyYXRlCiAgICAgKiByZWxhdGlvbiBuYW1lcy4gRGVmYXVs\ndHMgdG8gZmFsc2UuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldFVzZUZv\ncmVpZ25LZXlOYW1lKGJvb2xlYW4gdXNlRkspIHsKICAgICAgICBfdXNlRksg\nPSB1c2VGSzsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB3aGV0aGVy\nIGV2ZW4gbnVsbGFibGUgY29sdW1ucyB3aWxsIGJlIG1hcHBlZCB0byB3cmFw\ncGVycwogICAgICogcmF0aGVyIHRoYW4gcHJpbWl0aXZlcy4gRGVmYXVsdHMg\ndG8gZmFsc2UuCiAgICAgKi8KICAgIHB1YmxpYyBib29sZWFuIGdldE51bGxh\nYmxlQXNPYmplY3QoKSB7CiAgICAgICAgcmV0dXJuIF9udWxsQXNPYmo7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBTZXQgd2hldGhlciBldmVuIG51bGxhYmxl\nIGNvbHVtbnMgd2lsbCBiZSBtYXBwZWQgdG8gd3JhcHBlcnMKICAgICAqIHJh\ndGhlciB0aGFuIHByaW1pdGl2ZXMuIERlZmF1bHRzIHRvIGZhbHNlLgogICAg\nICovCiAgICBwdWJsaWMgdm9pZCBzZXROdWxsYWJsZUFzT2JqZWN0KGJvb2xl\nYW4gbnVsbEFzT2JqKSB7CiAgICAgICAgX251bGxBc09iaiA9IG51bGxBc09i\najsKICAgIH0KCiAgICAvKioKICAgICAqIFdoZXRoZXIgdG8gcmV2ZXJzZS1t\nYXAgYmxvYiBjb2x1bW5zIGFzIGNvbnRhaW5pbmcgc2VyaWFsaXplZCBKYXZh\nCiAgICAgKiBvYmplY3RzLCByYXRoZXIgdGhhbiB0aGUgZGVmYXVsdCBvZiB1\nc2luZyBhIGJ5dGVbXSBmaWVsZC4KICAgICAqLwogICAgcHVibGljIGJvb2xl\nYW4gZ2V0QmxvYkFzT2JqZWN0KCkgewogICAgICAgIHJldHVybiBfYmxvYkFz\nT2JqOwogICAgfQoKICAgIC8qKgogICAgICogV2hldGhlciB0byByZXZlcnNl\nLW1hcCBibG9iIGNvbHVtbnMgYXMgY29udGFpbmluZyBzZXJpYWxpemVkIEph\ndmEKICAgICAqIG9iamVjdHMsIHJhdGhlciB0aGFuIHRoZSBkZWZhdWx0IG9m\nIHVzaW5nIGEgYnl0ZVtdIGZpZWxkLgogICAgICovCiAgICBwdWJsaWMgdm9p\nZCBzZXRCbG9iQXNPYmplY3QoYm9vbGVhbiBibG9iQXNPYmopIHsKICAgICAg\nICBfYmxvYkFzT2JqID0gYmxvYkFzT2JqOwogICAgfQoKICAgIC8qKgogICAg\nICogV2hldGhlciB0byB1c2UgZ2VuZXJpYyBjb2xsZWN0aW9ucyBvbiBvbmUt\ndG8tbWFueSBhbmQgbWFueS10by1tYW55CiAgICAgKiByZWxhdGlvbnMgaW5z\ndGVhZCBvZiB1bnR5cGVkIGNvbGxlY3Rpb25zLgogICAgICovCiAgICBwdWJs\naWMgYm9vbGVhbiBnZXRVc2VHZW5lcmljQ29sbGVjdGlvbnMoKSB7CiAgICAg\nICAgcmV0dXJuIF91c2VHZW5lcmljQ29sbDsKICAgIH0KCiAgICAvKioKICAg\nICAqIFdoZXRoZXIgdG8gdXNlIGdlbmVyaWMgY29sbGVjdGlvbnMgb24gb25l\nLXRvLW1hbnkgYW5kIG1hbnktdG8tbWFueQogICAgICogcmVsYXRpb25zIGlu\nc3RlYWQgb2YgdW50eXBlZCBjb2xsZWN0aW9ucy4KICAgICAqLwogICAgcHVi\nbGljIHZvaWQgc2V0VXNlR2VuZXJpY0NvbGxlY3Rpb25zKGJvb2xlYW4gdXNl\nR2VuZXJpY0NvbGxlY3Rpb25zKSB7CiAgICAgICAgX3VzZUdlbmVyaWNDb2xs\nID0gdXNlR2VuZXJpY0NvbGxlY3Rpb25zOyAKICAgIH0KCiAgICAvKioKICAg\nICAqIE1hcCBvZiBKREJDLW5hbWUgdG8gSmF2YS10eXBlLW5hbWUgZW50cmll\ncyB0aGF0IGFsbG93cyBjdXN0b21pemF0aW9uCiAgICAgKiBvZiByZXZlcnNl\nIG1hcHBpbmcgY29sdW1ucyB0byBmaWVsZCB0eXBlcy4KICAgICAqLwogICAg\ncHVibGljIFByb3BlcnRpZXMgZ2V0VHlwZU1hcCgpIHsKICAgICAgICByZXR1\ncm4gX3R5cGVNYXA7CiAgICB9CgogICAgLyoqCiAgICAgKiBNYXAgb2YgSkRC\nQy1uYW1lIHRvIEphdmEtdHlwZS1uYW1lIGVudHJpZXMgdGhhdCBhbGxvd3Mg\nY3VzdG9taXphdGlvbgogICAgICogb2YgcmV2ZXJzZSBtYXBwaW5nIGNvbHVt\nbnMgdG8gZmllbGQgdHlwZXMuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNl\ndFR5cGVNYXAoUHJvcGVydGllcyB0eXBlTWFwKSB7CiAgICAgICAgX3R5cGVN\nYXAgPSB0eXBlTWFwOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRy\ndWUgaWYgam9pbiB0YWJsZXMgYXJlIGFsbG93ZWQgdG8gaGF2ZSBwcmltYXJ5\nIGtleXMsIGZhbHNlCiAgICAgKiBpZiBhbGwgcHJpbWFyeSBrZXkgdGFibGVz\nIHdpbGwgYmUgbWFwcGVkIGFzIHBlcnNpc3RlbnQgY2xhc3Nlcy4KICAgICAq\nIERlZmF1bHRzIHRvIGZhbHNlLgogICAgICovCiAgICBwdWJsaWMgYm9vbGVh\nbiBnZXRQcmltYXJ5S2V5T25Kb2luKCkgewogICAgICAgIHJldHVybiBfcGtP\nbkpvaW47CiAgICB9CgogICAgLyoqCiAgICAgKiBTZXQgdG8gdHJ1ZSBpZiBq\nb2luIHRhYmxlcyBhcmUgYWxsb3dlZCB0byBoYXZlIHByaW1hcnkga2V5cywg\nZmFsc2UKICAgICAqIGlmIGFsbCBwcmltYXJ5IGtleSB0YWJsZXMgd2lsbCBi\nZSBtYXBwZWQgYXMgcGVyc2lzdGVudCBjbGFzc2VzLgogICAgICogRGVmYXVs\ndHMgdG8gZmFsc2UuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldFByaW1h\ncnlLZXlPbkpvaW4oYm9vbGVhbiBwa09uSm9pbikgewogICAgICAgIF9wa09u\nSm9pbiA9IHBrT25Kb2luOwogICAgfQoKICAgIC8qKgogICAgICogV2hldGhl\nciB0byB1c2UgZGF0YXN0b3JlIGlkZW50aXR5IHdoZW4gcG9zc2libGUuIERl\nZmF1bHRzIHRvIGZhbHNlLgogICAgICovCiAgICBwdWJsaWMgYm9vbGVhbiBn\nZXRVc2VEYXRhU3RvcmVJZGVudGl0eSgpIHsKICAgICAgICByZXR1cm4gX2Rh\ndGFzdG9yZTsKICAgIH0KCiAgICAvKioKICAgICAqIFdoZXRoZXIgdG8gdXNl\nIGRhdGFzdG9yZSBpZGVudGl0eSB3aGVuIHBvc3NpYmxlLiBEZWZhdWx0cyB0\nbyBmYWxzZS4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0VXNlRGF0YVN0\nb3JlSWRlbnRpdHkoYm9vbGVhbiBkYXRhc3RvcmUpIHsKICAgICAgICBfZGF0\nYXN0b3JlID0gZGF0YXN0b3JlOwogICAgfQoKICAgIC8qKgogICAgICogV2hl\ndGhlciB0byB1c2UgYnVpbHQgaW4gaWRlbnRpdHkgY2xhc3NlcyB3aGVuIHBv\nc3NpYmxlLiBEZWZhdWx0cyB0byB0cnVlLgogICAgICovCiAgICBwdWJsaWMg\nYm9vbGVhbiBnZXRVc2VCdWlsdGluSWRlbnRpdHlDbGFzcygpIHsKICAgICAg\nICByZXR1cm4gX2J1aWx0aW47CiAgICB9CgogICAgLyoqCiAgICAgKiBXaGV0\naGVyIHRvIHVzZSBidWlsdCBpbiBpZGVudGl0eSBjbGFzc2VzIHdoZW4gcG9z\nc2libGUuIERlZmF1bHRzIHRvIHRydWUuCiAgICAgKi8KICAgIHB1YmxpYyB2\nb2lkIHNldFVzZUJ1aWx0aW5JZGVudGl0eUNsYXNzKGJvb2xlYW4gYnVpbHRp\nbikgewogICAgICAgIF9idWlsdGluID0gYnVpbHRpbjsKICAgIH0KCiAgICAv\nKioKICAgICAqIFdoZXRoZXIgb3Igbm90IHRvIGdlbmVyYXRlIGlubmVyIGNs\nYXNzZXMgd2hlbiBjcmVhdGluZyBhcHBsaWNhdGlvbgogICAgICogaWRlbnRp\ndHkgY2xhc3Nlcy4KICAgICAqLwogICAgcHVibGljIGJvb2xlYW4gZ2V0SW5u\nZXJJZGVudGl0eUNsYXNzZXMoKSB7CiAgICAgICAgcmV0dXJuIF9pbm5lcjsK\nICAgIH0KCiAgICAvKioKICAgICAqIFdoZXRoZXIgb3Igbm90IHRvIGdlbmVy\nYXRlIGlubmVyIGNsYXNzZXMgd2hlbiBjcmVhdGluZyBhcHBsaWNhdGlvbgog\nICAgICogaWRlbnRpdHkgY2xhc3Nlcy4KICAgICAqLwogICAgcHVibGljIHZv\naWQgc2V0SW5uZXJJZGVudGl0eUNsYXNzZXMoYm9vbGVhbiBpbm5lcikgewog\nICAgICAgIF9pbm5lciA9IGlubmVyOwogICAgfQoKICAgIC8qKgogICAgICog\nU3VmZml4IHVzZWQgdG8gY3JlYXRlIGFwcGxpY2F0aW9uIGlkZW50aXR5IGNs\nYXNzIG5hbWUgZnJvbSBhIGNsYXNzIG5hbWUsCiAgICAgKiBvciBpbiB0aGUg\nY2FzZSBvZiBpbm5lciBpZGVudGl0eSBjbGFzc2VzLCB0aGUgaW5uZXIgY2xh\nc3MgbmFtZS4KICAgICAqLwogICAgcHVibGljIFN0cmluZyBnZXRJZGVudGl0\neUNsYXNzU3VmZml4KCkgewogICAgICAgIHJldHVybiBfaWRTdWZmaXg7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBTdWZmaXggdXNlZCB0byBjcmVhdGUgYXBw\nbGljYXRpb24gaWRlbnRpdHkgY2xhc3MgbmFtZSBmcm9tIGEgY2xhc3MgbmFt\nZSwKICAgICAqIG9yIGluIHRoZSBjYXNlIG9mIGlubmVyIGlkZW50aXR5IGNs\nYXNzZXMsIHRoZSBpbm5lciBjbGFzcyBuYW1lLgogICAgICovCiAgICBwdWJs\naWMgdm9pZCBzZXRJZGVudGl0eUNsYXNzU3VmZml4KFN0cmluZyBzdWZmaXgp\nIHsKICAgICAgICBfaWRTdWZmaXggPSBzdWZmaXg7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBXaGV0aGVyIHRvIGdlbmVyYXRlIGludmVyc2UgMS1tYW55LzEt\nMSByZWxhdGlvbnMgZm9yIGFsbCBtYW55LTEvMS0xCiAgICAgKiByZWxhdGlv\nbnMuIERlZmF1bHRzIHRvIHRydWUuCiAgICAgKi8KICAgIHB1YmxpYyBib29s\nZWFuIGdldEludmVyc2VSZWxhdGlvbnMoKSB7CiAgICAgICAgcmV0dXJuIF9p\nbnZlcnNlOwogICAgfQoKICAgIC8qKgogICAgICogV2hldGhlciB0byBnZW5l\ncmF0ZSBpbnZlcnNlIDEtbWFueS8xLTEgcmVsYXRpb25zIGZvciBhbGwgbWFu\neS0xLzEtMQogICAgICogcmVsYXRpb25zLiBEZWZhdWx0cyB0byB0cnVlLgog\nICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRJbnZlcnNlUmVsYXRpb25zKGJv\nb2xlYW4gaW52ZXJzZSkgewogICAgICAgIF9pbnZlcnNlID0gaW52ZXJzZTsK\nICAgIH0KCiAgICAvKioKICAgICAqIFdoZXRoZXIgdG8gbWFrZSBnZW5lcmF0\nZWQgY2xhc3NlcyBkZXRhY2hhYmxlLiBEZWZhdWx0cyB0byBmYWxzZS4KICAg\nICAqLwogICAgcHVibGljIGJvb2xlYW4gZ2V0RGV0YWNoYWJsZSgpIHsKICAg\nICAgICByZXR1cm4gX2RldGFjaGFibGU7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBXaGV0aGVyIHRvIG1ha2UgZ2VuZXJhdGVkIGNsYXNzZXMgZGV0YWNoYWJs\nZS4gRGVmYXVsdHMgdG8gZmFsc2UuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lk\nIHNldERldGFjaGFibGUoYm9vbGVhbiBkZXRhY2hhYmxlKSB7CiAgICAgICAg\nX2RldGFjaGFibGUgPSBkZXRhY2hhYmxlOwogICAgfQoKICAgIC8qKgogICAg\nICogRGVmYXVsdCBkaXNjcmltaW5hdG9yIHN0cmF0ZWd5IGZvciBiYXNlIGNs\nYXNzIG1hcHBpbmdzLgogICAgICovCiAgICBwdWJsaWMgU3RyaW5nIGdldERp\nc2NyaW1pbmF0b3JTdHJhdGVneSgpIHsKICAgICAgICByZXR1cm4gX2Rpc2NT\ndHJhdDsKICAgIH0KCiAgICAvKioKICAgICAqIERlZmF1bHQgZGlzY3JpbWlu\nYXRvciBzdHJhdGVneSBmb3IgYmFzZSBjbGFzcyBtYXBwaW5ncy4KICAgICAq\nLwogICAgcHVibGljIHZvaWQgc2V0RGlzY3JpbWluYXRvclN0cmF0ZWd5KFN0\ncmluZyBkaXNjU3RyYXQpIHsKICAgICAgICBfZGlzY1N0cmF0ID0gZGlzY1N0\ncmF0OwogICAgfQoKICAgIC8qKgogICAgICogRGVmYXVsdCB2ZXJzaW9uIHN0\ncmF0ZWd5IGZvciBiYXNlIGNsYXNzIG1hcHBpbmdzLgogICAgICovCiAgICBw\ndWJsaWMgU3RyaW5nIGdldFZlcnNpb25TdHJhdGVneSgpIHsKICAgICAgICBy\nZXR1cm4gX3ZlcnNTdHJhdDsKICAgIH0KCiAgICAvKioKICAgICAqIERlZmF1\nbHQgdmVyc2lvbiBzdHJhdGVneSBmb3IgYmFzZSBjbGFzcyBtYXBwaW5ncy4K\nICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0VmVyc2lvblN0cmF0ZWd5KFN0\ncmluZyB2ZXJzaW9uU3RyYXQpIHsKICAgICAgICBfdmVyc1N0cmF0ID0gdmVy\nc2lvblN0cmF0OwogICAgfQoKICAgIC8qKgogICAgICogV2hldGhlciB0byBn\nZW5lcmF0ZSBhbm5vdGF0aW9ucyBhbG9uZyB3aXRoIGdlbmVyYXRlZCBjb2Rl\nLiBEZWZhdWx0cwogICAgICogdG8gZmFsc2UuCiAgICAgKi8KICAgIHB1Ymxp\nYyBib29sZWFuIGdldEdlbmVyYXRlQW5ub3RhdGlvbnMoKSB7CiAgICAgICAg\ncmV0dXJuIF9nZW5Bbm5vdGF0aW9uczsKICAgIH0KCiAgICAvKioKICAgICAq\nIFdoZXRoZXIgdG8gZ2VuZXJhdGUgYW5ub3RhdGlvbnMgYWxvbmcgd2l0aCBn\nZW5lcmF0ZWQgY29kZS4gRGVmYXVsdHMKICAgICAqIHRvIGZhbHNlLgogICAg\nICovCiAgICBwdWJsaWMgdm9pZCBzZXRHZW5lcmF0ZUFubm90YXRpb25zKGJv\nb2xlYW4gZ2VuQW5ub3RhdGlvbnMpIHsKICAgICAgICBfZ2VuQW5ub3RhdGlv\nbnMgPSBnZW5Bbm5vdGF0aW9uczsKICAgIH0KCiAgICAvKioKICAgICAqIFdo\nZXRoZXIgdG8gdXNlIGZpZWxkIG9yIHByb3BlcnR5LWJhc2VkIGFjY2VzcyBv\nbiBnZW5lcmF0ZWQgY29kZS4KICAgICAqIERlZmF1bHRzIHRvIGZpZWxkLWJh\nc2VkIGFjY2Vzcy4KICAgICAqLwogICAgcHVibGljIFN0cmluZyBnZXRBY2Nl\nc3NUeXBlKCkgewogICAgICAgIHJldHVybiBfYWNjZXNzVHlwZTsKICAgIH0K\nCiAgICAvKioKICAgICAqIFdoZXRoZXIgdG8gdXNlIGZpZWxkIG9yIHByb3Bl\ncnR5LWJhc2VkIGFjY2VzcyBvbiBnZW5lcmF0ZWQgY29kZS4KICAgICAqIERl\nZmF1bHRzIHRvIGZpZWxkLWJhc2VkIGFjY2Vzcy4KICAgICAqLwogICAgcHVi\nbGljIHZvaWQgc2V0QWNjZXNzVHlwZShTdHJpbmcgYWNjZXNzVHlwZSkgewog\nICAgICAgIHRoaXMuX2FjY2Vzc1R5cGUgPSBBQ0NFU1NfVFlQRV9QUk9QRVJU\nWS5lcXVhbHNJZ25vcmVDYXNlKGFjY2Vzc1R5cGUpID8KICAgICAgICAgICAg\nQUNDRVNTX1RZUEVfUFJPUEVSVFkgOiBBQ0NFU1NfVFlQRV9GSUVMRDsKICAg\nIH0KCiAgICAvKioKICAgICAqIFRoZSBjb2RlIGZvcm1hdHRlciBmb3IgdGhl\nIGdlbmVyYXRlZCBKYXZhIGNvZGUuCiAgICAgKi8KICAgIHB1YmxpYyBDb2Rl\nRm9ybWF0IGdldENvZGVGb3JtYXQoKSB7CiAgICAgICAgcmV0dXJuIF9mb3Jt\nYXQ7CiAgICB9CgogICAgLyoqCiAgICAgKiBTZXQgdGhlIGNvZGUgZm9ybWF0\ndGVyIGZvciB0aGUgZ2VuZXJhdGVkIEphdmEgY29kZS4KICAgICAqLwogICAg\ncHVibGljIHZvaWQgc2V0Q29kZUZvcm1hdChDb2RlRm9ybWF0IGZvcm1hdCkg\newogICAgICAgIF9mb3JtYXQgPSBmb3JtYXQ7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBSZXR1cm4gdGhlIGN1c3RvbWl6ZXIgaW4gdXNlLCBvciBudWxsIGlm\nIG5vbmUuCiAgICAgKi8KICAgIHB1YmxpYyBSZXZlcnNlQ3VzdG9taXplciBn\nZXRDdXN0b21pemVyKCkgewogICAgICAgIHJldHVybiBfY3VzdG9tOwogICAg\nfQoKICAgIC8qKgogICAgICogU2V0IHRoZSBjdXN0b21pemVyLiBUaGUgY29u\nZmlndXJhdGlvbiBvbiB0aGUgY3VzdG9taXplciwgaWYgYW55LAogICAgICog\nc2hvdWxkIGFscmVhZHkgYmUgc2V0LgogICAgICovCiAgICBwdWJsaWMgdm9p\nZCBzZXRDdXN0b21pemVyKFJldmVyc2VDdXN0b21pemVyIGN1c3RvbWl6ZXIp\nIHsKICAgICAgICBpZiAoY3VzdG9taXplciAhPSBudWxsKQogICAgICAgICAg\nICBjdXN0b21pemVyLnNldFRvb2wodGhpcyk7CiAgICAgICAgX2N1c3RvbSA9\nIGN1c3RvbWl6ZXI7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhl\nIG1hcHBpbmcgcmVwb3NpdG9yeSB1c2VkIHRvIGhvbGQgZ2VuZXJhdGVkIG1h\ncHBpbmdzLiBZb3UKICAgICAqIGNhbiBhbHNvIHVzZSB0aGUgcmVwb3NpdG9y\neSB0byBzZWVkIHRoZSBzY2hlbWEgZ3JvdXAgdG8gZ2VuZXJhdGUKICAgICAq\nIGNsYXNzZXMgZnJvbS4KICAgICAqLwogICAgcHVibGljIE1hcHBpbmdSZXBv\nc2l0b3J5IGdldFJlcG9zaXRvcnkoKSB7CiAgICAgICAgaWYgKF9yZXBvcyA9\nPSBudWxsKSB7CiAgICAgICAgICAgIC8vIGNyZWF0ZSBlbXB0eSByZXBvc2l0\nb3J5CiAgICAgICAgICAgIF9yZXBvcyA9IF9jb25mLm5ld01hcHBpbmdSZXBv\nc2l0b3J5SW5zdGFuY2UoKTsKICAgICAgICAgICAgX3JlcG9zLnNldE1ldGFE\nYXRhRmFjdG9yeShOb25lTWV0YURhdGFGYWN0b3J5LmdldEluc3RhbmNlKCkp\nOwogICAgICAgICAgICBfcmVwb3Muc2V0TWFwcGluZ0RlZmF1bHRzKE5vbmVN\nYXBwaW5nRGVmYXVsdHMuZ2V0SW5zdGFuY2UoKSk7CiAgICAgICAgICAgIF9y\nZXBvcy5zZXRSZXNvbHZlKE1PREVfTk9ORSk7CiAgICAgICAgICAgIF9yZXBv\ncy5zZXRWYWxpZGF0ZShfcmVwb3MuVkFMSURBVEVfTk9ORSk7CiAgICAgICAg\nfQogICAgICAgIHJldHVybiBfcmVwb3M7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBTZXQgdGhlIHJlcG9zaXRvcnkgdG8gdXNlLgogICAgICovCiAgICBwdWJs\naWMgdm9pZCBzZXRSZXBvc2l0b3J5KE1hcHBpbmdSZXBvc2l0b3J5IHJlcG9z\nKSB7CiAgICAgICAgX3JlcG9zID0gcmVwb3M7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBSZXR1cm4gdGhlIHNjaGVtYSBncm91cCB0byByZXZlcnNlIG1hcC4g\nSWYgbm9uZSBoYXMgYmVlbiBzZXQsIHRoZQogICAgICogc2NoZW1hIHdpbGwg\nYmUgZ2VuZXJhdGVkIGZyb20gdGhlIGRhdGFiYXNlLgogICAgICovCiAgICBw\ndWJsaWMgU2NoZW1hR3JvdXAgZ2V0U2NoZW1hR3JvdXAoKSB7CiAgICAgICAg\naWYgKF9zY2hlbWEgPT0gbnVsbCkgewogICAgICAgICAgICBTY2hlbWFHZW5l\ncmF0b3IgZ2VuID0gbmV3IFNjaGVtYUdlbmVyYXRvcihfY29uZik7CiAgICAg\nICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBnZW4uZ2VuZXJhdGVTY2hl\nbWFzKCk7CiAgICAgICAgICAgIH0gY2F0Y2ggKFNRTEV4Y2VwdGlvbiBzZSkg\newogICAgICAgICAgICAgICAgdGhyb3cgU1FMRXhjZXB0aW9ucy5nZXRTdG9y\nZShzZSwKICAgICAgICAgICAgICAgICAgICBfY29uZi5nZXREQkRpY3Rpb25h\ncnlJbnN0YW5jZSgpKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBfc2No\nZW1hID0gZ2VuLmdldFNjaGVtYUdyb3VwKCk7CiAgICAgICAgfQogICAgICAg\nIHJldHVybiBfc2NoZW1hOwogICAgfQoKICAgIC8qKgogICAgICogU2V0IHRo\nZSBzY2hlbWEgdG8gcmV2ZXJzZSBtYXAuCiAgICAgKi8KICAgIHB1YmxpYyB2\nb2lkIHNldFNjaGVtYUdyb3VwKFNjaGVtYUdyb3VwIHNjaGVtYSkgewogICAg\nICAgIF9zY2hlbWEgPSBzY2hlbWE7CiAgICB9CgogICAgLyoqCiAgICAgKiBS\nZXR1cm4gdGhlIGdlbmVyYXRlZCBtYXBwaW5ncy4KICAgICAqLwogICAgcHVi\nbGljIENsYXNzTWFwcGluZ1tdIGdldE1hcHBpbmdzKCkgewogICAgICAgIHJl\ndHVybiBnZXRSZXBvc2l0b3J5KCkuZ2V0TWFwcGluZ3MoKTsKICAgIH0KCiAg\nICAvKioKICAgICAqIEdlbmVyYXRlIG1hcHBpbmdzIGFuZCBjbGFzcyBjb2Rl\nIGZvciB0aGUgY3VycmVudCBzY2hlbWEgZ3JvdXAuCiAgICAgKi8KICAgIHB1\nYmxpYyB2b2lkIHJ1bigpIHsKICAgICAgICAvLyBtYXAgYmFzZSBjbGFzc2Vz\nIGZpcnN0CiAgICAgICAgU2NoZW1hW10gc2NoZW1hcyA9IGdldFNjaGVtYUdy\nb3VwKCkuZ2V0U2NoZW1hcygpOwogICAgICAgIFRhYmxlW10gdGFibGVzOwog\nICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgc2NoZW1hcy5sZW5ndGg7IGkr\nKykgewogICAgICAgICAgICB0YWJsZXMgPSBzY2hlbWFzW2ldLmdldFRhYmxl\ncygpOwogICAgICAgICAgICBmb3IgKGludCBqID0gMDsgaiA8IHRhYmxlcy5s\nZW5ndGg7IGorKykKICAgICAgICAgICAgICAgIGlmIChpc0Jhc2VUYWJsZSh0\nYWJsZXNbal0pKQogICAgICAgICAgICAgICAgICAgIG1hcEJhc2VDbGFzcyh0\nYWJsZXNbal0pOwogICAgICAgIH0KCiAgICAgICAgLy8gbWFwIHZlcnRpY2Fs\nIHN1YmNsYXNzZXMKICAgICAgICBTZXQgc3VicyA9IG51bGw7CiAgICAgICAg\nZm9yIChpbnQgaSA9IDA7IGkgPCBzY2hlbWFzLmxlbmd0aDsgaSsrKSB7CiAg\nICAgICAgICAgIHRhYmxlcyA9IHNjaGVtYXNbaV0uZ2V0VGFibGVzKCk7CiAg\nICAgICAgICAgIGZvciAoaW50IGogPSAwOyBqIDwgdGFibGVzLmxlbmd0aDsg\naisrKSB7CiAgICAgICAgICAgICAgICBpZiAoIV90YWJsZXMuY29udGFpbnNL\nZXkodGFibGVzW2pdKQogICAgICAgICAgICAgICAgICAgICYmIGdldFNlY29u\nZGFyeVR5cGUodGFibGVzW2pdLCBmYWxzZSkgPT0gVEFCTEVfU1VCQ0xBU1Mp\nIHsKICAgICAgICAgICAgICAgICAgICBpZiAoc3VicyA9PSBudWxsKQogICAg\nICAgICAgICAgICAgICAgICAgICBzdWJzID0gbmV3IEhhc2hTZXQoKTsKICAg\nICAgICAgICAgICAgICAgICBzdWJzLmFkZCh0YWJsZXNbal0pOwogICAgICAg\nICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGlm\nIChzdWJzICE9IG51bGwpCiAgICAgICAgICAgIG1hcFN1YmNsYXNzZXMoc3Vi\ncyk7CgogICAgICAgIC8vIG1hcCBmaWVsZHMgaW4gdGhlIHByaW1hcnkgdGFi\nbGVzIG9mIHRoZSBjbGFzc2VzCiAgICAgICAgQ2xhc3NNYXBwaW5nIGNsczsK\nICAgICAgICBmb3IgKEl0ZXJhdG9yIGl0ciA9IF90YWJsZXMudmFsdWVzKCku\naXRlcmF0b3IoKTsgaXRyLmhhc05leHQoKTspIHsKICAgICAgICAgICAgY2xz\nID0gKENsYXNzTWFwcGluZykgaXRyLm5leHQoKTsKICAgICAgICAgICAgbWFw\nQ29sdW1ucyhjbHMsIGNscy5nZXRUYWJsZSgpLCBudWxsLCBmYWxzZSk7CiAg\nICAgICAgfQoKICAgICAgICAvLyBtYXAgYXNzb2NpYXRpb24gdGFibGVzLCBq\nb2luIHRhYmxlcywgYW5kIHNlY29uZGFyeSB0YWJsZXMKICAgICAgICBmb3Ig\nKGludCBpID0gMDsgaSA8IHNjaGVtYXMubGVuZ3RoOyBpKyspIHsKICAgICAg\nICAgICAgdGFibGVzID0gc2NoZW1hc1tpXS5nZXRUYWJsZXMoKTsKICAgICAg\nICAgICAgZm9yIChpbnQgaiA9IDA7IGogPCB0YWJsZXMubGVuZ3RoOyBqKysp\nCiAgICAgICAgICAgICAgICBpZiAoIV90YWJsZXMuY29udGFpbnNLZXkodGFi\nbGVzW2pdKSkKICAgICAgICAgICAgICAgICAgICBtYXBUYWJsZSh0YWJsZXNb\nal0sIGdldFNlY29uZGFyeVR5cGUodGFibGVzW2pdLCBmYWxzZSkpOwogICAg\nICAgIH0KCiAgICAgICAgLy8gbWFwIGRpc2NyaW1pbmF0b3JzIGFuZCB2ZXJz\naW9ucywgbWFrZSBzdXJlIGlkZW50aXR5IHR5cGUgaXMgY29ycmVjdCwKICAg\nICAgICAvLyBzZXQgc2ltcGxlIGZpZWxkIGNvbHVtbiBqYXZhIHR5cGVzLCBh\nbmQgcmVmIHNjaGVtYSBjb21wb25lbnRzIHNvCiAgICAgICAgLy8gd2UgY2Fu\nIHRlbGwgd2hhdCBpcyB1bm1hcHBlZAogICAgICAgIEZpZWxkTWFwcGluZ1td\nIGZpZWxkczsKICAgICAgICBmb3IgKEl0ZXJhdG9yIGl0ciA9IF90YWJsZXMu\ndmFsdWVzKCkuaXRlcmF0b3IoKTsgaXRyLmhhc05leHQoKTspIHsKICAgICAg\nICAgICAgY2xzID0gKENsYXNzTWFwcGluZykgaXRyLm5leHQoKTsKICAgICAg\nICAgICAgY2xzLnJlZlNjaGVtYUNvbXBvbmVudHMoKTsKICAgICAgICAgICAg\naWYgKGNscy5nZXREaXNjcmltaW5hdG9yKCkuZ2V0U3RyYXRlZ3koKSA9PSBu\ndWxsKQogICAgICAgICAgICAgICAgZ2V0U3RyYXRlZ3lJbnN0YWxsZXIoKS5p\nbnN0YWxsU3RyYXRlZ3kKICAgICAgICAgICAgICAgICAgICAoY2xzLmdldERp\nc2NyaW1pbmF0b3IoKSk7CiAgICAgICAgICAgIGNscy5nZXREaXNjcmltaW5h\ndG9yKCkucmVmU2NoZW1hQ29tcG9uZW50cygpOwogICAgICAgICAgICBpZiAo\nY2xzLmdldFZlcnNpb24oKS5nZXRTdHJhdGVneSgpID09IG51bGwpCiAgICAg\nICAgICAgICAgICBnZXRTdHJhdGVneUluc3RhbGxlcigpLmluc3RhbGxTdHJh\ndGVneShjbHMuZ2V0VmVyc2lvbigpKTsKICAgICAgICAgICAgY2xzLmdldFZl\ncnNpb24oKS5yZWZTY2hlbWFDb21wb25lbnRzKCk7CgogICAgICAgICAgICAv\nLyBkb3VibGUtY2hlY2sgaWRlbnRpdHkgdHlwZTsgaWYgaXQgd2FzIHNldCBm\nb3IgYnVpbHRpbiBpZGVudGl0eQogICAgICAgICAgICAvLyBpdCBtaWdodCBo\nYXZlIHRvIHN3aXRjaCB0byBzdGQgYXBwbGljYXRpb24gaWRlbnRpdHkgaWYg\ncGsgZmllbGQKICAgICAgICAgICAgLy8gbm90IGNvbXBhdGlibGUKICAgICAg\nICAgICAgaWYgKGNscy5nZXRQQ1N1cGVyY2xhc3MoKSA9PSBudWxsCiAgICAg\nICAgICAgICAgICAmJiBjbHMuZ2V0SWRlbnRpdHlUeXBlKCkgPT0gQ2xhc3NN\nYXBwaW5nLklEX0FQUExJQ0FUSU9OKSB7CiAgICAgICAgICAgICAgICBpZiAo\nY2xzLmdldFByaW1hcnlLZXlGaWVsZHMoKS5sZW5ndGggPT0gMCkKICAgICAg\nICAgICAgICAgICAgICB0aHJvdyBuZXcgTWV0YURhdGFFeGNlcHRpb24oX2xv\nYy5nZXQoIm5vLXBrLWZpZWxkcyIsIGNscykpOwogICAgICAgICAgICAgICAg\naWYgKGNscy5nZXRPYmplY3RJZFR5cGUoKSA9PSBudWxsCiAgICAgICAgICAg\nICAgICAgICAgfHwgKGNscy5pc09wZW5KUEFJZGVudGl0eSgpICYmICFpc0J1\naWx0aW5JZGVudGl0eShjbHMpKSkKICAgICAgICAgICAgICAgICAgICBzZXRP\nYmplY3RJZFR5cGUoY2xzKTsKICAgICAgICAgICAgfSBlbHNlIGlmIChjbHMu\nZ2V0SWRlbnRpdHlUeXBlKCkgPT0gQ2xhc3NNYXBwaW5nLklEX0RBVEFTVE9S\nRSkKICAgICAgICAgICAgICAgIGNscy5nZXRQcmltYXJ5S2V5Q29sdW1ucygp\nWzBdLnNldEphdmFUeXBlKEphdmFUeXBlcy5MT05HKTsKCiAgICAgICAgICAg\nIC8vIHNldCBqYXZhIHR5cGVzIGZvciBzaW1wbGUgZmllbGRzOwogICAgICAg\nICAgICBmaWVsZHMgPSBjbHMuZ2V0RGVjbGFyZWRGaWVsZE1hcHBpbmdzKCk7\nCiAgICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgZmllbGRzLmxlbmd0\naDsgaSsrKSB7CiAgICAgICAgICAgICAgICBmaWVsZHNbaV0ucmVmU2NoZW1h\nQ29tcG9uZW50cygpOwogICAgICAgICAgICAgICAgc2V0Q29sdW1uSmF2YVR5\ncGUoZmllbGRzW2ldKTsKICAgICAgICAgICAgICAgIHNldENvbHVtbkphdmFU\neXBlKGZpZWxkc1tpXS5nZXRFbGVtZW50TWFwcGluZygpKTsKICAgICAgICAg\nICAgfQogICAgICAgIH0KCiAgICAgICAgLy8gc2V0IHRoZSBqYXZhIHR5cGVz\nIG9mIGZvcmVpZ24ga2V5IGNvbHVtbnM7IHdlIGNvdWxkbid0IGRvIHRoaXMK\nICAgICAgICAvLyBlYXJsaWVyIGJlY2F1c2Ugd2UgcmVseSBvbiB0aGUgbGlu\na2VkLXRvIGNvbHVtbnMgdG8gZG8gaXQKICAgICAgICBmb3IgKEl0ZXJhdG9y\nIGl0ciA9IF90YWJsZXMudmFsdWVzKCkuaXRlcmF0b3IoKTsgaXRyLmhhc05l\neHQoKTspIHsKICAgICAgICAgICAgY2xzID0gKENsYXNzTWFwcGluZykgaXRy\nLm5leHQoKTsKICAgICAgICAgICAgc2V0Rm9yZWlnbktleUphdmFUeXBlKGNs\ncy5nZXRKb2luRm9yZWlnbktleSgpKTsKCiAgICAgICAgICAgIGZpZWxkcyA9\nIGNscy5nZXREZWNsYXJlZEZpZWxkTWFwcGluZ3MoKTsKICAgICAgICAgICAg\nZm9yIChpbnQgaSA9IDA7IGkgPCBmaWVsZHMubGVuZ3RoOyBpKyspIHsKICAg\nICAgICAgICAgICAgIHNldEZvcmVpZ25LZXlKYXZhVHlwZShmaWVsZHNbaV0u\nZ2V0Sm9pbkZvcmVpZ25LZXkoKSk7CiAgICAgICAgICAgICAgICBzZXRGb3Jl\naWduS2V5SmF2YVR5cGUoZmllbGRzW2ldLmdldEZvcmVpZ25LZXkoKSk7CiAg\nICAgICAgICAgICAgICBzZXRGb3JlaWduS2V5SmF2YVR5cGUoZmllbGRzW2ld\nLmdldEVsZW1lbnRNYXBwaW5nKCkuCiAgICAgICAgICAgICAgICAgICAgZ2V0\nRm9yZWlnbktleSgpKTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAg\nICAgLy8gYWxsb3cgY3VzdG9taXplciB0byBtYXAgdW5tYXBwZWQgdGFibGVz\nLCBhbmQgd2FybiBhYm91dCBhbnl0aGluZwogICAgICAgIC8vIHRoYXQgZW5k\ncyB1cCB1bm1hcHBlZAogICAgICAgIENvbHVtbltdIGNvbHM7CiAgICAgICAg\nQ29sbGVjdGlvbiB1bm1hcHBlZENvbHMgPSBuZXcgQXJyYXlMaXN0KDUpOwog\nICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgc2NoZW1hcy5sZW5ndGg7IGkr\nKykgewogICAgICAgICAgICB0YWJsZXMgPSBzY2hlbWFzW2ldLmdldFRhYmxl\ncygpOwogICAgICAgICAgICBmb3IgKGludCBqID0gMDsgaiA8IHRhYmxlcy5s\nZW5ndGg7IGorKykgewogICAgICAgICAgICAgICAgdW5tYXBwZWRDb2xzLmNs\nZWFyKCk7CiAgICAgICAgICAgICAgICBjb2xzID0gdGFibGVzW2pdLmdldENv\nbHVtbnMoKTsKICAgICAgICAgICAgICAgIGZvciAoaW50IGsgPSAwOyBrIDwg\nY29scy5sZW5ndGg7IGsrKykKICAgICAgICAgICAgICAgICAgICBpZiAoY29s\nc1trXS5nZXRSZWZDb3VudCgpID09IDApCiAgICAgICAgICAgICAgICAgICAg\nICAgIHVubWFwcGVkQ29scy5hZGQoY29sc1trXSk7CgogICAgICAgICAgICAg\nICAgaWYgKHVubWFwcGVkQ29scy5zaXplKCkgPT0gY29scy5sZW5ndGgpIHsK\nICAgICAgICAgICAgICAgICAgICBpZiAoX2N1c3RvbSA9PSBudWxsIHx8ICFf\nY3VzdG9tLnVubWFwcGVkVGFibGUodGFibGVzW2pdKSkKICAgICAgICAgICAg\nICAgICAgICAgICAgX2xvZy5pbmZvKF9sb2MuZ2V0KCJ1bm1hcC10YWJsZSIs\nIHRhYmxlc1tqXSkpOwogICAgICAgICAgICAgICAgfSBlbHNlIGlmICh1bm1h\ncHBlZENvbHMuc2l6ZSgpID4gMCkKICAgICAgICAgICAgICAgICAgICBfbG9n\nLmluZm8oX2xvYy5nZXQoInVubWFwLWNvbHMiLCB0YWJsZXNbal0sIHVubWFw\ncGVkQ29scykpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGlm\nIChfY3VzdG9tICE9IG51bGwpCiAgICAgICAgICAgIF9jdXN0b20uY2xvc2Uo\nKTsKCiAgICAgICAgLy8gcmVzb2x2ZSBtYXBwaW5ncwogICAgICAgIGZvciAo\nSXRlcmF0b3IgaXRyID0gX3RhYmxlcy52YWx1ZXMoKS5pdGVyYXRvcigpOyBp\ndHIuaGFzTmV4dCgpOykKICAgICAgICAgICAgKChDbGFzc01hcHBpbmcpIGl0\nci5uZXh0KCkpLnJlc29sdmUoTU9ERV9NRVRBIHwgTU9ERV9NQVBQSU5HKTsK\nICAgIH0KCiAgICAvKioKICAgICAqIE1hcCB0aGUgdGFibGUgb2YgdGhlIGdp\ndmVuIHR5cGUuCiAgICAgKi8KICAgIHByaXZhdGUgdm9pZCBtYXBUYWJsZShU\nYWJsZSB0YWJsZSwgaW50IHR5cGUpIHsKICAgICAgICBzd2l0Y2ggKHR5cGUp\nIHsKICAgICAgICAgICAgY2FzZSBUQUJMRV9TRUNPTkRBUlk6CiAgICAgICAg\nICAgIGNhc2UgVEFCTEVfU0VDT05EQVJZX09VVEVSOgogICAgICAgICAgICAg\nICAgbWFwU2Vjb25kYXJ5VGFibGUodGFibGUsIHR5cGUgIT0gVEFCTEVfU0VD\nT05EQVJZKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBj\nYXNlIFRBQkxFX0FTU09DSUFUSU9OOgogICAgICAgICAgICAgICAgbWFwQXNz\nb2NpYXRpb25UYWJsZSh0YWJsZSk7CiAgICAgICAgICAgICAgICBicmVhazsK\nICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gdHJ1ZSBp\nZiB0aGUgZ2l2ZW4gY2xhc3MgaXMgY29tcGF0aWJsZSB3aXRoIGJ1aWx0aW4g\naWRlbnRpdHkuCiAgICAgKi8KICAgIHByaXZhdGUgc3RhdGljIGJvb2xlYW4g\naXNCdWlsdGluSWRlbnRpdHkoQ2xhc3NNYXBwaW5nIGNscykgewogICAgICAg\nIEZpZWxkTWFwcGluZ1tdIGZpZWxkcyA9IGNscy5nZXRQcmltYXJ5S2V5Rmll\nbGRNYXBwaW5ncygpOwogICAgICAgIGlmIChmaWVsZHMubGVuZ3RoICE9IDEp\nCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICBzd2l0Y2ggKGZp\nZWxkc1swXS5nZXREZWNsYXJlZFR5cGVDb2RlKCkpIHsKICAgICAgICAgICAg\nY2FzZSBKYXZhVHlwZXMuQllURToKICAgICAgICAgICAgY2FzZSBKYXZhVHlw\nZXMuQ0hBUjoKICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuSU5UOgogICAg\nICAgICAgICBjYXNlIEphdmFUeXBlcy5MT05HOgogICAgICAgICAgICBjYXNl\nIEphdmFUeXBlcy5TSE9SVDoKICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMu\nQllURV9PQko6CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLkNIQVJfT0JK\nOgogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5JTlRfT0JKOgogICAgICAg\nICAgICBjYXNlIEphdmFUeXBlcy5MT05HX09CSjoKICAgICAgICAgICAgY2Fz\nZSBKYXZhVHlwZXMuU0hPUlRfT0JKOgogICAgICAgICAgICBjYXNlIEphdmFU\neXBlcy5TVFJJTkc6CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLk9JRDoK\nICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KICAgICAg\nICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgLyoqCiAgICAgKiBTZXQgdGhl\nIEphdmEgdHlwZSBvZiB0aGUgY29sdW1uIGZvciB0aGUgZ2l2ZW4gdmFsdWUu\nCiAgICAgKi8KICAgIHByaXZhdGUgc3RhdGljIHZvaWQgc2V0Q29sdW1uSmF2\nYVR5cGUoVmFsdWVNYXBwaW5nIHZtKSB7CiAgICAgICAgQ29sdW1uW10gY29s\ncyA9IHZtLmdldENvbHVtbnMoKTsKICAgICAgICBpZiAoY29scy5sZW5ndGgg\nPT0gMSkKICAgICAgICAgICAgY29sc1swXS5zZXRKYXZhVHlwZSh2bS5nZXRE\nZWNsYXJlZFR5cGVDb2RlKCkpOwogICAgfQoKICAgIC8qKgogICAgICogU2V0\nIHRoZSBKYXZhIHR5cGUgb2YgdGhlIGZvcmVpZ24ga2V5IGNvbHVtbnMuCiAg\nICAgKi8KICAgIHByaXZhdGUgc3RhdGljIHZvaWQgc2V0Rm9yZWlnbktleUph\ndmFUeXBlKEZvcmVpZ25LZXkgZmspIHsKICAgICAgICBpZiAoZmsgPT0gbnVs\nbCkKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIENvbHVtbltdIGNvbHMg\nPSBmay5nZXRDb2x1bW5zKCk7CiAgICAgICAgQ29sdW1uW10gcGtzID0gZmsu\nZ2V0UHJpbWFyeUtleUNvbHVtbnMoKTsKICAgICAgICBmb3IgKGludCBpID0g\nMDsgaSA8IGNvbHMubGVuZ3RoOyBpKyspCiAgICAgICAgICAgIGlmIChjb2xz\nW2ldLmdldEphdmFUeXBlKCkgPT0gSmF2YVR5cGVzLk9CSkVDVCkKICAgICAg\nICAgICAgICAgIGNvbHNbaV0uc2V0SmF2YVR5cGUocGtzW2ldLmdldEphdmFU\neXBlKCkpOwogICAgfQoKICAgIC8qKgogICAgICogVXNlcyB7QGxpbmsgQ29k\nZUdlbmVyYXRvcn1zIHRvIHdyaXRlIHRoZSBKYXZhIGNvZGUgZm9yIHRoZSBn\nZW5lcmF0ZWQKICAgICAqIG1hcHBpbmdzIHRvIHRoZSBwcm9wZXIgcGFja2Fn\nZXMuCiAgICAgKgogICAgICogQHJldHVybiBhIGxpc3Qgb2Yge0BsaW5rIEZp\nbGV9IGluc3RhbmNlcyB0aGF0IHdlcmUgd3JpdHRlbgogICAgICovCiAgICBw\ndWJsaWMgTGlzdCByZWNvcmRDb2RlKCkKICAgICAgICB0aHJvd3MgSU9FeGNl\ncHRpb24gewogICAgICAgIHJldHVybiByZWNvcmRDb2RlKG51bGwpOwogICAg\nfQoKICAgIC8qKgogICAgICogV3JpdGUgdGhlIGNvZGUgZm9yIHRoZSB0b29s\nLgogICAgICoKICAgICAqIEBwYXJhbSBvdXRwdXQgaWYgbnVsbCwgdGhlbiBw\nZXJmb3JtIHRoZSB3cml0ZSBkaXJlY3RseQogICAgICogdG8gdGhlIGZpbGVz\neXN0ZW07IG90aGVyd2lzZSwgcG9wdWxhdGUgdGhlCiAgICAgKiBzcGVjaWZp\nZWQgbWFwIHdpdGgga2V5cyBhcyB0aGUgZ2VuZXJhdGVkCiAgICAgKiB7QGxp\nbmsgQ2xhc3NNYXBwaW5nfSBhbmQgdmFsdWVzIGFzIGEKICAgICAqIHtAbGlu\nayBTdHJpbmd9IHRoYXQgY29udGFpbnMgdGhlIGdlbmVyYXRlZCBjb2RlCiAg\nICAgKiBAcmV0dXJuIGEgbGlzdCBvZiB7QGxpbmsgRmlsZX0gaW5zdGFuY2Vz\nIHRoYXQgd2VyZSB3cml0dGVuCiAgICAgKi8KICAgIHB1YmxpYyBMaXN0IHJl\nY29yZENvZGUoTWFwIG91dHB1dCkKICAgICAgICB0aHJvd3MgSU9FeGNlcHRp\nb24gewogICAgICAgIExpc3Qgd3JpdHRlbiA9IG5ldyBMaW5rZWRMaXN0KCk7\nCgogICAgICAgIENsYXNzTWFwcGluZ1tdIG1hcHBpbmdzID0gZ2V0TWFwcGlu\nZ3MoKTsKICAgICAgICBSZXZlcnNlQ29kZUdlbmVyYXRvciBnZW47CiAgICAg\nICAgZm9yIChpbnQgaSA9IDA7IGkgPCBtYXBwaW5ncy5sZW5ndGg7IGkrKykg\newogICAgICAgICAgICBpZiAoX2xvZy5pc0luZm9FbmFibGVkKCkpCiAgICAg\nICAgICAgICAgICBfbG9nLmluZm8oX2xvYy5nZXQoImNsYXNzLWNvZGUiLCBt\nYXBwaW5nc1tpXSkpOwoKICAgICAgICAgICAgQXBwbGljYXRpb25JZFRvb2wg\nYWlkID0gbmV3QXBwbGljYXRpb25JZFRvb2wobWFwcGluZ3NbaV0pOwogICAg\nICAgICAgICBpZiAoZ2V0R2VuZXJhdGVBbm5vdGF0aW9ucygpKQogICAgICAg\nICAgICAgICAgZ2VuID0gbmV3IEFubm90YXRlZENvZGVHZW5lcmF0b3IobWFw\ncGluZ3NbaV0sIGFpZCk7CiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAg\nICAgIGdlbiA9IG5ldyBSZXZlcnNlQ29kZUdlbmVyYXRvcihtYXBwaW5nc1tp\nXSwgYWlkKTsKCiAgICAgICAgICAgIGdlbi5nZW5lcmF0ZUNvZGUoKTsKCiAg\nICAgICAgICAgIGlmIChvdXRwdXQgPT0gbnVsbCkgewogICAgICAgICAgICAg\nICAgZ2VuLndyaXRlQ29kZSgpOwogICAgICAgICAgICAgICAgd3JpdHRlbi5h\nZGQoZ2VuLmdldEZpbGUoKSk7CiAgICAgICAgICAgICAgICBpZiAoYWlkICE9\nIG51bGwgJiYgIWFpZC5pc0lubmVyQ2xhc3MoKSkKICAgICAgICAgICAgICAg\nICAgICBhaWQucmVjb3JkKCk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAg\nICAgICAgICAgICBTdHJpbmdXcml0ZXIgd3JpdGVyID0gbmV3IFN0cmluZ1dy\naXRlcigpOwogICAgICAgICAgICAgICAgZ2VuLndyaXRlQ29kZSh3cml0ZXIp\nOwogICAgICAgICAgICAgICAgb3V0cHV0LnB1dChtYXBwaW5nc1tpXS5nZXRE\nZXNjcmliZWRUeXBlKCksIHdyaXRlci50b1N0cmluZygpKTsKCiAgICAgICAg\nICAgICAgICBpZiAoYWlkICE9IG51bGwgJiYgIWFpZC5pc0lubmVyQ2xhc3Mo\nKSkgewogICAgICAgICAgICAgICAgICAgIHdyaXRlciA9IG5ldyBTdHJpbmdX\ncml0ZXIoKTsKICAgICAgICAgICAgICAgICAgICBhaWQuc2V0V3JpdGVyKHdy\naXRlcik7CiAgICAgICAgICAgICAgICAgICAgYWlkLnJlY29yZCgpOwogICAg\nICAgICAgICAgICAgICAgIG91dHB1dC5wdXQobWFwcGluZ3NbaV0uZ2V0T2Jq\nZWN0SWRUeXBlKCksCiAgICAgICAgICAgICAgICAgICAgICAgIHdyaXRlci50\nb1N0cmluZygpKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQog\nICAgICAgIH0KICAgICAgICByZXR1cm4gd3JpdHRlbjsKICAgIH0KCiAgICAv\nKioKICAgICAqIFdyaXRlIHRoZSBnZW5lcmF0ZWQgbWV0YWRhdGEgdG8gdGhl\nIHByb3BlciBwYWNrYWdlcy4KICAgICAqCiAgICAgKiBAcmV0dXJuIHRoZSBz\nZXQgb2YgbWV0YWRhdGEge0BsaW5rIEZpbGV9cyB0aGF0IHdlcmUgd3JpdHRl\nbgogICAgICovCiAgICBwdWJsaWMgQ29sbGVjdGlvbiByZWNvcmRNZXRhRGF0\nYShib29sZWFuIHBlckNsYXNzKQogICAgICAgIHRocm93cyBJT0V4Y2VwdGlv\nbiB7CiAgICAgICAgcmV0dXJuIHJlY29yZE1ldGFEYXRhKHBlckNsYXNzLCBu\ndWxsKTsKICAgIH0KCiAgICAvKioKICAgICAqIFdyaXRlIHRoZSBjb2RlIGZv\nciB0aGUgdG9vbC4KICAgICAqCiAgICAgKiBAcGFyYW0gb3V0cHV0IGlmIG51\nbGwsIHRoZW4gcGVyZm9ybSB0aGUgd3JpdGUgZGlyZWN0bHkKICAgICAqIHRv\nIHRoZSBmaWxlc3lzdGVtOyBvdGhlcndpc2UsIHBvcHVsYXRlIHRoZQogICAg\nICogc3BlY2lmaWVkIG1hcCB3aXRoIGtleXMgYXMgdGhlIGdlbmVyYXRlZAog\nICAgICoge0BsaW5rIENsYXNzTWFwcGluZ30gYW5kIHZhbHVlcyBhcyBhCiAg\nICAgKiB7QGxpbmsgU3RyaW5nfSB0aGF0IGNvbnRhaW5zIHRoZSBnZW5lcmF0\nZWQgY29kZQogICAgICogQHJldHVybiB0aGUgc2V0IG9mIG1ldGFkYXRhIHtA\nbGluayBGaWxlfXMgdGhhdCB3ZXJlIHdyaXR0ZW4KICAgICAqLwogICAgcHVi\nbGljIENvbGxlY3Rpb24gcmVjb3JkTWV0YURhdGEoYm9vbGVhbiBwZXJDbGFz\ncywgTWFwIG91dHB1dCkKICAgICAgICB0aHJvd3MgSU9FeGNlcHRpb24gewog\nICAgICAgIC8vIHByZXRlbmQgbWFwcGluZ3MgYXJlIGFsbCByZXNvbHZlZAog\nICAgICAgIENsYXNzTWFwcGluZ1tdIG1hcHBpbmdzID0gZ2V0TWFwcGluZ3Mo\nKTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IG1hcHBpbmdzLmxlbmd0\naDsgaSsrKQogICAgICAgICAgICBtYXBwaW5nc1tpXS5zZXRSZXNvbHZlKE1P\nREVfTUVUQSB8IE1PREVfTUFQUElORywgdHJ1ZSk7CgogICAgICAgIC8vIHN0\nb3JlIGluIHVzZXIncyBjb25maWd1cmVkIElPCiAgICAgICAgTWV0YURhdGFG\nYWN0b3J5IG1kZiA9IF9jb25mLm5ld01ldGFEYXRhRmFjdG9yeUluc3RhbmNl\nKCk7CiAgICAgICAgbWRmLnNldFJlcG9zaXRvcnkoZ2V0UmVwb3NpdG9yeSgp\nKTsKICAgICAgICBtZGYuc2V0U3RvcmVEaXJlY3RvcnkoX2Rpcik7CiAgICAg\nICAgaWYgKHBlckNsYXNzKQogICAgICAgICAgICBtZGYuc2V0U3RvcmVNb2Rl\nKE1ldGFEYXRhRmFjdG9yeS5TVE9SRV9QRVJfQ0xBU1MpOwogICAgICAgIG1k\nZi5zdG9yZShtYXBwaW5ncywgbmV3IFF1ZXJ5TWV0YURhdGFbMF0sIG5ldyBT\nZXF1ZW5jZU1ldGFEYXRhWzBdLAogICAgICAgICAgICBNT0RFX01FVEEgfCBN\nT0RFX01BUFBJTkcsIG91dHB1dCk7CgogICAgICAgIFNldCBmaWxlcyA9IG5l\ndyBUcmVlU2V0KCk7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBtYXBw\naW5ncy5sZW5ndGg7IGkrKykKICAgICAgICAgICAgaWYgKG1hcHBpbmdzW2ld\nLmdldFNvdXJjZUZpbGUoKSAhPSBudWxsKQogICAgICAgICAgICAgICAgZmls\nZXMuYWRkKG1hcHBpbmdzW2ldLmdldFNvdXJjZUZpbGUoKSk7CiAgICAgICAg\ncmV0dXJuIGZpbGVzOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIGJ1aWxkQW5u\nb3RhdGlvbnMoKSB7CiAgICAgICAgTWFwIG91dHB1dCA9IG5ldyBIYXNoTWFw\nKCk7CiAgICAgICAgLy8gcHJldGVuZCBtYXBwaW5ncyBhcmUgYWxsIHJlc29s\ndmVkCiAgICAgICAgQ2xhc3NNYXBwaW5nW10gbWFwcGluZ3MgPSBnZXRNYXBw\naW5ncygpOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgbWFwcGluZ3Mu\nbGVuZ3RoOyBpKyspCiAgICAgICAgICAgIG1hcHBpbmdzW2ldLnNldFJlc29s\ndmUoTU9ERV9NRVRBIHwgTU9ERV9NQVBQSU5HLCB0cnVlKTsKCiAgICAgICAg\nLy8gc3RvcmUgaW4gdXNlcidzIGNvbmZpZ3VyZWQgSU8KICAgICAgICBNZXRh\nRGF0YUZhY3RvcnkgbWRmID0gX2NvbmYubmV3TWV0YURhdGFGYWN0b3J5SW5z\ndGFuY2UoKTsKICAgICAgICBtZGYuc2V0UmVwb3NpdG9yeShnZXRSZXBvc2l0\nb3J5KCkpOwogICAgICAgIG1kZi5zZXRTdG9yZURpcmVjdG9yeShfZGlyKTsK\nICAgICAgICBtZGYuc3RvcmUobWFwcGluZ3MsIG5ldyBRdWVyeU1ldGFEYXRh\nWzBdLCBuZXcgU2VxdWVuY2VNZXRhRGF0YVswXSwKICAgICAgICAgICAgTU9E\nRV9NRVRBIHwgTU9ERV9NQVBQSU5HIHwgTU9ERV9BTk5fTUFQUElORywgb3V0\ncHV0KTsKICAgICAgICBfYW5ub3MgPSBvdXRwdXQ7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBSZXR1cm5zIGEgbGlzdCBvZiBzdHJpbmdpZmllZCBhbm5vdGF0\naW9ucyBmb3Igc3BlY2lmaWVkIG1ldGEuCiAgICAgKi8KICAgIHByb3RlY3Rl\nZCBMaXN0IGdldEFubm90YXRpb25zRm9yTWV0YShPYmplY3QgbWV0YSkgewog\nICAgICAgIGlmIChudWxsID09IF9hbm5vcykKICAgICAgICAgICAgcmV0dXJu\nIG51bGw7CiAgICAgICAgcmV0dXJuIChMaXN0KSBfYW5ub3MuZ2V0KG1ldGEp\nOwogICAgfQoKICAgIC8qKgogICAgICogR2VuZXJhdGUgYW5kIHdyaXRlIHRo\nZSBhcHBsaWNhdGlvbiBpZGVudGl0eSBjb2RlLgogICAgICovCiAgICBwcml2\nYXRlIEFwcGxpY2F0aW9uSWRUb29sIG5ld0FwcGxpY2F0aW9uSWRUb29sKENs\nYXNzTWFwcGluZyBtYXBwaW5nKSB7CiAgICAgICAgQXBwbGljYXRpb25JZFRv\nb2wgdG9vbDsKICAgICAgICBpZiAobWFwcGluZy5nZXRJZGVudGl0eVR5cGUo\nKSA9PSBDbGFzc01hcHBpbmcuSURfQVBQTElDQVRJT04KICAgICAgICAgICAg\nJiYgIW1hcHBpbmcuaXNPcGVuSlBBSWRlbnRpdHkoKQogICAgICAgICAgICAm\nJiBtYXBwaW5nLmdldFBDU3VwZXJjbGFzcygpID09IG51bGwpIHsKICAgICAg\nICAgICAgdG9vbCA9IG5ldyBBcHBsaWNhdGlvbklkVG9vbChfY29uZiwgbWFw\ncGluZy5nZXREZXNjcmliZWRUeXBlKCksCiAgICAgICAgICAgICAgICBtYXBw\naW5nKTsKICAgICAgICAgICAgdG9vbC5zZXREaXJlY3RvcnkoX2Rpcik7CiAg\nICAgICAgICAgIHRvb2wuc2V0Q29kZUZvcm1hdChfZm9ybWF0KTsKICAgICAg\nICAgICAgaWYgKCF0b29sLnJ1bigpKQogICAgICAgICAgICAgICAgcmV0dXJu\nIG51bGw7CiAgICAgICAgICAgIHJldHVybiB0b29sOwogICAgICAgIH0KICAg\nICAgICByZXR1cm4gbnVsbDsKICAgIH0KCiAgICAvLy8vLy8vLy8vLy8vLy8v\nLy8vLy8vLy8vLy8vLy8vLy8vCiAgICAvLyBNZXRob2RzIGZvciBjdXN0b21p\nemVycyB0byB1c2UKICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v\nLy8vLy8KCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgY2xhc3MgbWFwcGlu\nZyBmb3IgdGhlIGdpdmVuIHRhYmxlLCBvciBudWxsIGlmIG5vbmUuCiAgICAg\nKi8KICAgIHB1YmxpYyBDbGFzc01hcHBpbmcgZ2V0Q2xhc3NNYXBwaW5nKFRh\nYmxlIHRhYmxlKSB7CiAgICAgICAgcmV0dXJuIChDbGFzc01hcHBpbmcpIF90\nYWJsZXMuZ2V0KHRhYmxlKTsKICAgIH0KCiAgICAvKioKICAgICAqIENyZWF0\nZSBhIG5ldyBjbGFzcyB0byBiZSBtYXBwZWQgdG8gYSB0YWJsZS4gVGhlIGNs\nYXNzIHdpbGwgc3RhcnQgb3V0CiAgICAgKiB3aXRoIGEgZGVmYXVsdCBhcHBs\naWNhdGlvbiBpZGVudGl0eSBjbGFzcyBzZXQuCiAgICAgKi8KICAgIHB1Ymxp\nYyBDbGFzc01hcHBpbmcgbmV3Q2xhc3NNYXBwaW5nKENsYXNzIGNscywgVGFi\nbGUgdGFibGUpIHsKICAgICAgICBDbGFzc01hcHBpbmcgbWFwcGluZyA9IChD\nbGFzc01hcHBpbmcpIGdldFJlcG9zaXRvcnkoKS5hZGRNZXRhRGF0YShjbHMp\nOwogICAgICAgIENsYXNzIHN1cCA9IG1hcHBpbmcuZ2V0RGVzY3JpYmVkVHlw\nZSgpLmdldFN1cGVyY2xhc3MoKTsKICAgICAgICBpZiAoc3VwID09IE9iamVj\ndC5jbGFzcykKICAgICAgICAgICAgc2V0T2JqZWN0SWRUeXBlKG1hcHBpbmcp\nOwogICAgICAgIGVsc2UKICAgICAgICAgICAgbWFwcGluZy5zZXRQQ1N1cGVy\nY2xhc3Moc3VwKTsKICAgICAgICBtYXBwaW5nLnNldFRhYmxlKHRhYmxlKTsK\nICAgICAgICBpZiAoX2RldGFjaGFibGUpCiAgICAgICAgICAgIG1hcHBpbmcu\nc2V0RGV0YWNoYWJsZSh0cnVlKTsKICAgICAgICBfdGFibGVzLnB1dCh0YWJs\nZSwgbWFwcGluZyk7CiAgICAgICAgcmV0dXJuIG1hcHBpbmc7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBTZXQgdGhlIGdpdmVuIGNsYXNzJyBvYmplY3RpZC1j\nbGFzcy4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIHNldE9iamVjdElkVHlw\nZShDbGFzc01hcHBpbmcgY2xzKSB7CiAgICAgICAgU3RyaW5nIG5hbWUgPSBj\nbHMuZ2V0RGVzY3JpYmVkVHlwZSgpLmdldE5hbWUoKTsKICAgICAgICBpZiAo\nX2lubmVyKQogICAgICAgICAgICBuYW1lICs9ICIkIjsKICAgICAgICBuYW1l\nICs9IF9pZFN1ZmZpeDsKICAgICAgICBjbHMuc2V0T2JqZWN0SWRUeXBlKGdl\nbmVyYXRlQ2xhc3MobmFtZSwgbnVsbCksIGZhbHNlKTsKICAgIH0KCiAgICAv\nKioKICAgICAqIEdlbmVyYXRlIGEgbmV3IGNsYXNzIHdpdGggdGhlIGdpdmVu\nIG5hbWUuIElmIGEgbm9uLW51bGwgcGFyZW50IGNsYXNzCiAgICAgKiBpcyBn\naXZlbiwgaXQgd2lsbCBiZSBzZXQgYXMgdGhlIHN1cGVyY2xhc3MuCiAgICAg\nKi8KICAgIHB1YmxpYyBDbGFzcyBnZW5lcmF0ZUNsYXNzKFN0cmluZyBuYW1l\nLCBDbGFzcyBwYXJlbnQpIHsKICAgICAgICBCQ0NsYXNzIGJjID0gX3Byb2pl\nY3QubG9hZENsYXNzKG5hbWUsIG51bGwpOwogICAgICAgIGlmIChwYXJlbnQg\nIT0gbnVsbCkKICAgICAgICAgICAgYmMuc2V0U3VwZXJjbGFzcyhwYXJlbnQp\nOwogICAgICAgIGJjLmFkZERlZmF1bHRDb25zdHJ1Y3RvcigpOwoKICAgICAg\nICB0cnkgewogICAgICAgICAgICByZXR1cm4gQ2xhc3MuZm9yTmFtZShuYW1l\nLCBmYWxzZSwgX2xvYWRlcik7CiAgICAgICAgfSBjYXRjaCAoQ2xhc3NOb3RG\nb3VuZEV4Y2VwdGlvbiBjbmZlKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBJ\nbnRlcm5hbEV4Y2VwdGlvbihjbmZlLnRvU3RyaW5nKCksIGNuZmUpOwogICAg\nICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB3aGV0aGVyIHRo\nZSBnaXZlbiBmb3JlaWduIGtleSBpcyB1bmlxdWUuCiAgICAgKi8KICAgIHB1\nYmxpYyBib29sZWFuIGlzVW5pcXVlKEZvcmVpZ25LZXkgZmspIHsKICAgICAg\nICBQcmltYXJ5S2V5IHBrID0gZmsuZ2V0VGFibGUoKS5nZXRQcmltYXJ5S2V5\nKCk7CiAgICAgICAgaWYgKHBrICE9IG51bGwgJiYgcGsuY29sdW1uc01hdGNo\nKGZrLmdldENvbHVtbnMoKSkpCiAgICAgICAgICAgIHJldHVybiB0cnVlOwog\nICAgICAgIEluZGV4W10gaWR4ID0gZmsuZ2V0VGFibGUoKS5nZXRJbmRleGVz\nKCk7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBpZHgubGVuZ3RoOyBp\nKyspCiAgICAgICAgICAgIGlmIChpZHhbaV0uaXNVbmlxdWUoKSAmJiBpZHhb\naV0uY29sdW1uc01hdGNoKGZrLmdldENvbHVtbnMoKSkpCiAgICAgICAgICAg\nICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICBVbmlxdWVbXSB1bnEgPSBmay5n\nZXRUYWJsZSgpLmdldFVuaXF1ZXMoKTsKICAgICAgICBmb3IgKGludCBpID0g\nMDsgaSA8IHVucS5sZW5ndGg7IGkrKykKICAgICAgICAgICAgaWYgKHVucVtp\nXS5jb2x1bW5zTWF0Y2goZmsuZ2V0Q29sdW1ucygpKSkKICAgICAgICAgICAg\nICAgIHJldHVybiB0cnVlOwogICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0K\nCiAgICAvKioKICAgICAqIElmIHRoZSBnaXZlbiB0YWJsZSBoYXMgYSBzaW5n\nbGUgdW5pcXVlIGZvcmVpZ24ga2V5IG9yIGEgZm9yZWlnbgogICAgICoga2V5\nIHRoYXQgbWF0Y2hlcyB0aGUgcHJpbWFyeSBrZXksIHJldHVybiBpdC4gRWxz\nZSByZXR1cm4gbnVsbC4KICAgICAqLwogICAgcHVibGljIEZvcmVpZ25LZXkg\nZ2V0VW5pcXVlRm9yZWlnbktleShUYWJsZSB0YWJsZSkgewogICAgICAgIEZv\ncmVpZ25LZXlbXSBma3MgPSB0YWJsZS5nZXRGb3JlaWduS2V5cygpOwogICAg\nICAgIFByaW1hcnlLZXkgcGsgPSB0YWJsZS5nZXRQcmltYXJ5S2V5KCk7CiAg\nICAgICAgRm9yZWlnbktleSB1bnEgPSBudWxsOwogICAgICAgIGludCBjb3Vu\ndCA9IDA7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBma3MubGVuZ3Ro\nOyBpKyspIHsKICAgICAgICAgICAgaWYgKHBrICE9IG51bGwgJiYgcGsuY29s\ndW1uc01hdGNoKGZrc1tpXS5nZXRDb2x1bW5zKCkpKQogICAgICAgICAgICAg\nICAgcmV0dXJuIGZrc1tpXTsKICAgICAgICAgICAgaWYgKCFpc1VuaXF1ZShm\na3NbaV0pKQogICAgICAgICAgICAgICAgY29udGludWU7CgogICAgICAgICAg\nICBjb3VudCsrOwogICAgICAgICAgICBpZiAodW5xID09IG51bGwpCiAgICAg\nICAgICAgICAgICB1bnEgPSBma3NbaV07CiAgICAgICAgfQogICAgICAgIHJl\ndHVybiAoY291bnQgPT0gMSkgPyB1bnEgOiBudWxsOwogICAgfQoKICAgIC8q\nKgogICAgICogQWRkIGV4aXN0aW5nIHVuaXF1ZSBjb25zdHJhaW50cyBhbmQg\naW5kZXhlcyB0byB0aGUgZ2l2ZW4gZmllbGQncyBqb2luLgogICAgICovCiAg\nICBwdWJsaWMgdm9pZCBhZGRKb2luQ29uc3RyYWludHMoRmllbGRNYXBwaW5n\nIGZpZWxkKSB7CiAgICAgICAgRm9yZWlnbktleSBmayA9IGZpZWxkLmdldEpv\naW5Gb3JlaWduS2V5KCk7CiAgICAgICAgaWYgKGZrID09IG51bGwpCiAgICAg\nICAgICAgIHJldHVybjsKCiAgICAgICAgSW5kZXggaWR4ID0gZmluZEluZGV4\nKGZrLmdldENvbHVtbnMoKSk7CiAgICAgICAgaWYgKGlkeCAhPSBudWxsKQog\nICAgICAgICAgICBmaWVsZC5zZXRKb2luSW5kZXgoaWR4KTsKICAgICAgICBV\nbmlxdWUgdW5xID0gZmluZFVuaXF1ZShmay5nZXRDb2x1bW5zKCkpOwogICAg\nICAgIGlmICh1bnEgIT0gbnVsbCkKICAgICAgICAgICAgZmllbGQuc2V0Sm9p\nblVuaXF1ZSh1bnEpOwogICAgfQoKICAgIC8qKgogICAgICogQWRkIGV4aXN0\naW5nIHVuaXF1ZSBjb25zdHJhaW50cyBhbmQgaW5kZXhlcyB0byB0aGUgZ2l2\nZW4gdmFsdWUuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIGFkZENvbnN0cmFp\nbnRzKFZhbHVlTWFwcGluZyB2bSkgewogICAgICAgIENvbHVtbltdIGNvbHMg\nPSAodm0uZ2V0Rm9yZWlnbktleSgpICE9IG51bGwpCiAgICAgICAgICAgID8g\ndm0uZ2V0Rm9yZWlnbktleSgpLmdldENvbHVtbnMoKSA6IHZtLmdldENvbHVt\nbnMoKTsKICAgICAgICBJbmRleCBpZHggPSBmaW5kSW5kZXgoY29scyk7CiAg\nICAgICAgaWYgKGlkeCAhPSBudWxsKQogICAgICAgICAgICB2bS5zZXRWYWx1\nZUluZGV4KGlkeCk7CiAgICAgICAgVW5pcXVlIHVucSA9IGZpbmRVbmlxdWUo\nY29scyk7CiAgICAgICAgaWYgKHVucSAhPSBudWxsKQogICAgICAgICAgICB2\nbS5zZXRWYWx1ZVVuaXF1ZSh1bnEpOwogICAgfQoKICAgIC8qKgogICAgICog\nUmV0dXJuIHRoZSBpbmRleCB3aXRoIHRoZSBnaXZlbiBjb2x1bW5zLgogICAg\nICovCiAgICBwcml2YXRlIEluZGV4IGZpbmRJbmRleChDb2x1bW5bXSBjb2xz\nKSB7CiAgICAgICAgaWYgKGNvbHMgPT0gbnVsbCB8fCBjb2xzLmxlbmd0aCA9\nPSAwKQogICAgICAgICAgICByZXR1cm4gbnVsbDsKCiAgICAgICAgVGFibGUg\ndGFibGUgPSBjb2xzWzBdLmdldFRhYmxlKCk7CiAgICAgICAgSW5kZXhbXSBp\nZHhzID0gdGFibGUuZ2V0SW5kZXhlcygpOwogICAgICAgIGZvciAoaW50IGkg\nPSAwOyBpIDwgaWR4cy5sZW5ndGg7IGkrKykKICAgICAgICAgICAgaWYgKGlk\neHNbaV0uY29sdW1uc01hdGNoKGNvbHMpKQogICAgICAgICAgICAgICAgcmV0\ndXJuIGlkeHNbaV07CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBSZXR1cm4gdGhlIHVuaXF1ZSBjb25zdHJpYW50IHdpdGgg\ndGhlIGdpdmVuIGNvbHVtbnMuCiAgICAgKi8KICAgIHByaXZhdGUgVW5pcXVl\nIGZpbmRVbmlxdWUoQ29sdW1uW10gY29scykgewogICAgICAgIGlmIChjb2xz\nID09IG51bGwgfHwgY29scy5sZW5ndGggPT0gMCkKICAgICAgICAgICAgcmV0\ndXJuIG51bGw7CgogICAgICAgIFRhYmxlIHRhYmxlID0gY29sc1swXS5nZXRU\nYWJsZSgpOwogICAgICAgIFVuaXF1ZVtdIHVucXMgPSB0YWJsZS5nZXRVbmlx\ndWVzKCk7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCB1bnFzLmxlbmd0\naDsgaSsrKQogICAgICAgICAgICBpZiAodW5xc1tpXS5jb2x1bW5zTWF0Y2go\nY29scykpCiAgICAgICAgICAgICAgICByZXR1cm4gdW5xc1tpXTsKICAgICAg\nICByZXR1cm4gbnVsbDsKICAgIH0KCiAgICAvLy8vLy8vLy8vLy8vCiAgICAv\nLyBVdGlsaXRpZXMKICAgIC8vLy8vLy8vLy8vLy8KCiAgICAvKioKICAgICAq\nIFJldHVybiB3aGV0aGVyIHRoZSBnaXZlbiB0YWJsZSBpcyBhIGJhc2UgY2xh\nc3MgdGFibGUuCiAgICAgKi8KICAgIHB1YmxpYyBib29sZWFuIGlzQmFzZVRh\nYmxlKFRhYmxlIHRhYmxlKSB7CiAgICAgICAgaWYgKHRhYmxlLmdldFByaW1h\ncnlLZXkoKSA9PSBudWxsKQogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAg\nICAgICAgaW50IHR5cGUgPSBnZXRTZWNvbmRhcnlUeXBlKHRhYmxlLCB0cnVl\nKTsKICAgICAgICBpZiAodHlwZSAhPSAtMSkKICAgICAgICAgICAgcmV0dXJu\nIHR5cGUgPT0gVEFCTEVfQkFTRTsKICAgICAgICBpZiAoX2N1c3RvbSAhPSBu\ndWxsKQogICAgICAgICAgICByZXR1cm4gX2N1c3RvbS5nZXRUYWJsZVR5cGUo\ndGFibGUsIFRBQkxFX0JBU0UpID09IFRBQkxFX0JBU0U7CiAgICAgICAgcmV0\ndXJuIHRydWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBDYWxjdWxhdGUgdGhl\nIHR5cGUgb2YgdGhlIHNlY29uZGFyeSBnaXZlbiB0YWJsZS4KICAgICAqLwog\nICAgcHJpdmF0ZSBpbnQgZ2V0U2Vjb25kYXJ5VHlwZShUYWJsZSB0YWJsZSwg\nYm9vbGVhbiBtYXliZUJhc2UpIHsKICAgICAgICBpbnQgdHlwZTsKICAgICAg\nICBGb3JlaWduS2V5W10gZmtzID0gdGFibGUuZ2V0Rm9yZWlnbktleXMoKTsK\nICAgICAgICBpZiAoZmtzLmxlbmd0aCA9PSAyCiAgICAgICAgICAgICYmICh0\nYWJsZS5nZXRQcmltYXJ5S2V5KCkgPT0gbnVsbCB8fCBfcGtPbkpvaW4pCiAg\nICAgICAgICAgICYmIGZrc1swXS5nZXRDb2x1bW5zKCkubGVuZ3RoICsgZmtz\nWzFdLmdldENvbHVtbnMoKS5sZW5ndGgKICAgICAgICAgICAgPT0gdGFibGUu\nZ2V0Q29sdW1ucygpLmxlbmd0aAogICAgICAgICAgICAmJiAoIWlzVW5pcXVl\nKGZrc1swXSkgfHwgIWlzVW5pcXVlKGZrc1sxXSkpKQogICAgICAgICAgICB0\neXBlID0gVEFCTEVfQVNTT0NJQVRJT047CiAgICAgICAgZWxzZSBpZiAobWF5\nYmVCYXNlICYmIHRhYmxlLmdldFByaW1hcnlLZXkoKSAhPSBudWxsKQogICAg\nICAgICAgICB0eXBlID0gLTE7CiAgICAgICAgZWxzZSBpZiAoZ2V0VW5pcXVl\nRm9yZWlnbktleSh0YWJsZSkgIT0gbnVsbCkKICAgICAgICAgICAgdHlwZSA9\nIFRBQkxFX1NFQ09OREFSWTsKICAgICAgICBlbHNlIGlmIChma3MubGVuZ3Ro\nID09IDEpCiAgICAgICAgICAgIHR5cGUgPSBUQUJMRV9OT05FOwogICAgICAg\nIGVsc2UKICAgICAgICAgICAgdHlwZSA9IC0xOwoKICAgICAgICBpZiAoX2N1\nc3RvbSAhPSBudWxsICYmIHR5cGUgIT0gLTEpCiAgICAgICAgICAgIHR5cGUg\nPSBfY3VzdG9tLmdldFRhYmxlVHlwZSh0YWJsZSwgdHlwZSk7CiAgICAgICAg\ncmV0dXJuIHR5cGU7CiAgICB9CgogICAgLyoqCiAgICAgKiBBdHRlbXB0IHRv\nIGNyZWF0ZSBhIGJhc2UgY2xhc3MgZnJvbSB0aGUgZ2l2ZW4gdGFibGUuCiAg\nICAgKi8KICAgIHByaXZhdGUgdm9pZCBtYXBCYXNlQ2xhc3MoVGFibGUgdGFi\nbGUpIHsKICAgICAgICBDbGFzc01hcHBpbmcgY2xzID0gbmV3Q2xhc3NNYXBw\naW5nKHRhYmxlLCBudWxsKTsKICAgICAgICBpZiAoY2xzID09IG51bGwpCiAg\nICAgICAgICAgIHJldHVybjsKCiAgICAgICAgLy8gY2hlY2sgZm9yIGRhdGFz\ndG9yZSBpZGVudGl0eSBhbmQgYnVpbHRpbiBpZGVudGl0eTsgZm9yIG5vdwog\nICAgICAgIC8vIHdlIGFzc3VtZSB0aGF0IGFueSBub24tZGF0YXN0b3JlIHNp\nbmdsZSBwcmltYXJ5IGtleSBjb2x1bW4gd2lsbCB1c2UKICAgICAgICAvLyBi\ndWlsdGluIGlkZW50aXR5OyBpZiB3ZSBkaXNjb3ZlciB0aGF0IHRoZSBwcmlt\nYXJ5IGtleSBmaWVsZCBpcwogICAgICAgIC8vIG5vdCBjb21wYXRpYmxlIHdp\ndGggYnVpbHRpbiBpZGVudGl0eSBsYXRlciwgdGhlbiB3ZSdsbCBhc3NpZ24K\nICAgICAgICAvLyBhbiBhcHBsaWNhdGlvbiBpZGVudGl0eSBjbGFzcwogICAg\nICAgIENvbHVtbltdIHBrcyA9IHRhYmxlLmdldFByaW1hcnlLZXkoKS5nZXRD\nb2x1bW5zKCk7CiAgICAgICAgY2xzLnNldFByaW1hcnlLZXlDb2x1bW5zKHBr\ncyk7CiAgICAgICAgaWYgKHBrcy5sZW5ndGggPT0gMSAmJiBfZGF0YXN0b3Jl\nCiAgICAgICAgICAgICYmIHBrc1swXS5pc0NvbXBhdGlibGUoVHlwZXMuQklH\nSU5ULCBudWxsLCAwLCAwKSkgewogICAgICAgICAgICBjbHMuc2V0T2JqZWN0\nSWRUeXBlKG51bGwsIGZhbHNlKTsKICAgICAgICAgICAgY2xzLnNldElkZW50\naXR5VHlwZShDbGFzc01hcHBpbmcuSURfREFUQVNUT1JFKTsKICAgICAgICB9\nIGVsc2UgaWYgKHBrcy5sZW5ndGggPT0gMSAmJiBfYnVpbHRpbikKICAgICAg\nICAgICAgY2xzLnNldE9iamVjdElkVHlwZShudWxsLCBmYWxzZSk7CiAgICAg\nICAgY2xzLnNldFN0cmF0ZWd5KG5ldyBGdWxsQ2xhc3NTdHJhdGVneSgpLCBu\ndWxsKTsKICAgICAgICBpZiAoX2N1c3RvbSAhPSBudWxsKQogICAgICAgICAg\nICBfY3VzdG9tLmN1c3RvbWl6ZShjbHMpOwogICAgfQoKICAgIC8qKgogICAg\nICogQXR0ZW1wdCB0byBjcmVhdGUgYSB2ZXJ0aWNhbCBzdWJjbGFzc2VzIGZy\nb20gdGhlIGdpdmVuIHRhYmxlcy4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lk\nIG1hcFN1YmNsYXNzZXMoU2V0IHRhYmxlcykgewogICAgICAgIC8vIGxvb3Ag\ndGhyb3VnaCB0YWJsZXMgdW50aWwgZWl0aGVyIGFsbCBhcmUgbWFwcGVkIG9y\nIG5vbmUgbGluayB0bwogICAgICAgIC8vIGEgbWFwcGVkIGJhc2UgY2xhc3Mg\ndGFibGUKICAgICAgICBDbGFzc01hcHBpbmcgYmFzZSwgc3ViOwogICAgICAg\nIFRhYmxlIHRhYmxlID0gbnVsbDsKICAgICAgICBGb3JlaWduS2V5IGZrID0g\nbnVsbDsKICAgICAgICB3aGlsZSAoIXRhYmxlcy5pc0VtcHR5KCkpIHsKICAg\nICAgICAgICAgLy8gZmluZCBhIHRhYmxlIHdpdGggYSBmb3JlaWduIGtleSBs\naW5raW5nIHRvIGEgbWFwcGVkIHRhYmxlCiAgICAgICAgICAgIGJhc2UgPSBu\ndWxsOwogICAgICAgICAgICBmb3IgKEl0ZXJhdG9yIGl0ciA9IHRhYmxlcy5p\ndGVyYXRvcigpOyBpdHIuaGFzTmV4dCgpOykgewogICAgICAgICAgICAgICAg\ndGFibGUgPSAoVGFibGUpIGl0ci5uZXh0KCk7CiAgICAgICAgICAgICAgICBm\nayA9IGdldFVuaXF1ZUZvcmVpZ25LZXkodGFibGUpOwogICAgICAgICAgICAg\nICAgaWYgKGZrID09IG51bGwgJiYgdGFibGUuZ2V0Rm9yZWlnbktleXMoKS5s\nZW5ndGggPT0gMSkKICAgICAgICAgICAgICAgICAgICBmayA9IHRhYmxlLmdl\ndEZvcmVpZ25LZXlzKClbMF07CiAgICAgICAgICAgICAgICBlbHNlIGlmIChm\nayA9PSBudWxsKQogICAgICAgICAgICAgICAgICAgIGl0ci5yZW1vdmUoKTsK\nICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgIGJh\nc2UgPSAoQ2xhc3NNYXBwaW5nKSBfdGFibGVzLmdldChmay5nZXRQcmltYXJ5\nS2V5VGFibGUoKSk7CiAgICAgICAgICAgICAgICAgICAgaWYgKGJhc2UgIT0g\nbnVsbCkgewogICAgICAgICAgICAgICAgICAgICAgICBpdHIucmVtb3ZlKCk7\nCiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAg\nICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAg\nICAgICAgICAvLyBpZiBubyB0YWJsZXMgbGluayB0byBhIGJhc2UgdGFibGUs\nIG5vdGhpbmcgbGVmdCB0byBkbwogICAgICAgICAgICBpZiAoYmFzZSA9PSBu\ndWxsKQogICAgICAgICAgICAgICAgcmV0dXJuOwoKICAgICAgICAgICAgc3Vi\nID0gbmV3Q2xhc3NNYXBwaW5nKHRhYmxlLCBiYXNlLmdldERlc2NyaWJlZFR5\ncGUoKSk7CiAgICAgICAgICAgIHN1Yi5zZXRKb2luRm9yZWlnbktleShmayk7\nCiAgICAgICAgICAgIHN1Yi5zZXRQcmltYXJ5S2V5Q29sdW1ucyhmay5nZXRD\nb2x1bW5zKCkpOwogICAgICAgICAgICBzdWIuc2V0SWRlbnRpdHlUeXBlKGJh\nc2UuZ2V0SWRlbnRpdHlUeXBlKCkpOwogICAgICAgICAgICBzdWIuc2V0U3Ry\nYXRlZ3kobmV3IFZlcnRpY2FsQ2xhc3NTdHJhdGVneSgpLCBudWxsKTsKICAg\nICAgICAgICAgaWYgKF9jdXN0b20gIT0gbnVsbCkKICAgICAgICAgICAgICAg\nIF9jdXN0b20uY3VzdG9taXplKHN1Yik7CiAgICAgICAgfQogICAgfQoKICAg\nIC8qKgogICAgICogQXR0ZW1wdCB0byByZXZlcnNlIG1hcCB0aGUgZ2l2ZW4g\ndGFibGUgYXMgYW4gYXNzb2NpYXRpb24gdGFibGUuCiAgICAgKi8KICAgIHBy\naXZhdGUgdm9pZCBtYXBBc3NvY2lhdGlvblRhYmxlKFRhYmxlIHRhYmxlKSB7\nCiAgICAgICAgRm9yZWlnbktleVtdIGZrcyA9IHRhYmxlLmdldEZvcmVpZ25L\nZXlzKCk7CiAgICAgICAgaWYgKGZrcy5sZW5ndGggIT0gMikKICAgICAgICAg\nICAgcmV0dXJuOwoKICAgICAgICBDbGFzc01hcHBpbmcgY2xzMSA9IChDbGFz\nc01hcHBpbmcpIF90YWJsZXMuZ2V0CiAgICAgICAgICAgIChma3NbMF0uZ2V0\nUHJpbWFyeUtleVRhYmxlKCkpOwogICAgICAgIENsYXNzTWFwcGluZyBjbHMy\nID0gKENsYXNzTWFwcGluZykgX3RhYmxlcy5nZXQKICAgICAgICAgICAgKGZr\nc1sxXS5nZXRQcmltYXJ5S2V5VGFibGUoKSk7CiAgICAgICAgaWYgKGNsczEg\nPT0gbnVsbCB8fCBjbHMyID09IG51bGwpCiAgICAgICAgICAgIHJldHVybjsK\nCiAgICAgICAgLy8gYWRkIGEgcmVsYXRpb24gZnJvbSBlYWNoIGNsYXNzIHRv\nIHRoZSBvdGhlciB0aHJvdWdoIHRoZQogICAgICAgIC8vIGFzc29jaWF0aW9u\nIHRhYmxlCiAgICAgICAgU3RyaW5nIG5hbWUgPSBnZXRSZWxhdGlvbk5hbWUo\nY2xzMi5nZXREZXNjcmliZWRUeXBlKCksIHRydWUsIGZrc1sxXSwKICAgICAg\nICAgICAgZmFsc2UsIGNsczEpOwogICAgICAgIEZpZWxkTWFwcGluZyBmaWVs\nZDEgPSBuZXdGaWVsZE1hcHBpbmcobmFtZSwgU2V0LmNsYXNzLCBudWxsLCBm\na3NbMV0sCiAgICAgICAgICAgIGNsczEpOwogICAgICAgIGlmIChmaWVsZDEg\nIT0gbnVsbCkgewogICAgICAgICAgICBmaWVsZDEuc2V0Sm9pbkZvcmVpZ25L\nZXkoZmtzWzBdKTsKICAgICAgICAgICAgYWRkSm9pbkNvbnN0cmFpbnRzKGZp\nZWxkMSk7CiAgICAgICAgICAgIFZhbHVlTWFwcGluZyB2bSA9IGZpZWxkMS5n\nZXRFbGVtZW50TWFwcGluZygpOwogICAgICAgICAgICB2bS5zZXREZWNsYXJl\nZFR5cGUoY2xzMi5nZXREZXNjcmliZWRUeXBlKCkpOwogICAgICAgICAgICB2\nbS5zZXRGb3JlaWduS2V5KGZrc1sxXSk7CiAgICAgICAgICAgIGFkZENvbnN0\ncmFpbnRzKHZtKTsKICAgICAgICAgICAgZmllbGQxLnNldFN0cmF0ZWd5KG5l\ndyBSZWxhdGlvbkNvbGxlY3Rpb25UYWJsZUZpZWxkU3RyYXRlZ3koKSwKICAg\nICAgICAgICAgICAgIG51bGwpOwogICAgICAgICAgICBpZiAoX2N1c3RvbSAh\nPSBudWxsKQogICAgICAgICAgICAgICAgX2N1c3RvbS5jdXN0b21pemUoZmll\nbGQxKTsKICAgICAgICB9CgogICAgICAgIG5hbWUgPSBnZXRSZWxhdGlvbk5h\nbWUoY2xzMS5nZXREZXNjcmliZWRUeXBlKCksIHRydWUsIGZrc1swXSwKICAg\nICAgICAgICAgZmFsc2UsIGNsczIpOwogICAgICAgIEZpZWxkTWFwcGluZyBm\naWVsZDIgPSBuZXdGaWVsZE1hcHBpbmcobmFtZSwgU2V0LmNsYXNzLCBudWxs\nLCBma3NbMF0sCiAgICAgICAgICAgIGNsczIpOwogICAgICAgIGlmIChmaWVs\nZDIgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuOwoKICAgICAgICBmaWVs\nZDIuc2V0Sm9pbkZvcmVpZ25LZXkoZmtzWzFdKTsKICAgICAgICBhZGRKb2lu\nQ29uc3RyYWludHMoZmllbGQyKTsKICAgICAgICBWYWx1ZU1hcHBpbmcgdm0g\nPSBmaWVsZDIuZ2V0RWxlbWVudE1hcHBpbmcoKTsKICAgICAgICB2bS5zZXRE\nZWNsYXJlZFR5cGUoY2xzMS5nZXREZXNjcmliZWRUeXBlKCkpOwogICAgICAg\nIHZtLnNldEZvcmVpZ25LZXkoZmtzWzBdKTsKICAgICAgICBhZGRDb25zdHJh\naW50cyh2bSk7CiAgICAgICAgaWYgKGZpZWxkMSAhPSBudWxsICYmIGZpZWxk\nMS5nZXRNYXBwZWRCeSgpID09IG51bGwpCiAgICAgICAgICAgIGZpZWxkMi5z\nZXRNYXBwZWRCeShmaWVsZDEuZ2V0TmFtZSgpKTsKICAgICAgICBmaWVsZDIu\nc2V0U3RyYXRlZ3kobmV3IFJlbGF0aW9uQ29sbGVjdGlvblRhYmxlRmllbGRT\ndHJhdGVneSgpLCBudWxsKTsKICAgICAgICBpZiAoX2N1c3RvbSAhPSBudWxs\nKQogICAgICAgICAgICBfY3VzdG9tLmN1c3RvbWl6ZShmaWVsZDIpOwogICAg\nfQoKICAgIC8qKgogICAgICogQXR0ZW1wdCB0byByZXZlcnNlIG1hcCB0aGUg\nZ2l2ZW4gdGFibGUgYXMgYSBzZWNvbmRhcnkgdGFibGUuCiAgICAgKi8KICAg\nIHByaXZhdGUgdm9pZCBtYXBTZWNvbmRhcnlUYWJsZShUYWJsZSB0YWJsZSwg\nYm9vbGVhbiBvdXRlcikgewogICAgICAgIEZvcmVpZ25LZXkgZmsgPSBnZXRV\nbmlxdWVGb3JlaWduS2V5KHRhYmxlKTsKICAgICAgICBpZiAoZmsgPT0gbnVs\nbCAmJiB0YWJsZS5nZXRGb3JlaWduS2V5cygpLmxlbmd0aCA9PSAxKQogICAg\nICAgICAgICBmayA9IHRhYmxlLmdldEZvcmVpZ25LZXlzKClbMF07CiAgICAg\nICAgZWxzZSBpZiAoZmsgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuOwog\nICAgICAgIENsYXNzTWFwcGluZyBjbHMgPSAoQ2xhc3NNYXBwaW5nKSBfdGFi\nbGVzLmdldChmay5nZXRQcmltYXJ5S2V5VGFibGUoKSk7CiAgICAgICAgaWYg\nKGNscyA9PSBudWxsKQogICAgICAgICAgICByZXR1cm47CiAgICAgICAgbWFw\nQ29sdW1ucyhjbHMsIHRhYmxlLCBmaywgb3V0ZXIpOwogICAgfQoKICAgIC8q\nKgogICAgICogTWFwIHRoZSBjb2x1bW5zIG9mIHRoZSBnaXZlbiB0YWJsZSB0\nbyBmaWVsZHMgb2YgdGhlIGdpdmVuIHR5cGUuCiAgICAgKi8KICAgIHByaXZh\ndGUgdm9pZCBtYXBDb2x1bW5zKENsYXNzTWFwcGluZyBjbHMsIFRhYmxlIHRh\nYmxlLCBGb3JlaWduS2V5IGpvaW4sCiAgICAgICAgYm9vbGVhbiBvdXRlcikg\newogICAgICAgIC8vIGZpcnN0IG1hcCBmb3JlaWduIGtleXMgdG8gcmVsYXRp\nb25zCiAgICAgICAgRm9yZWlnbktleVtdIGZrcyA9IHRhYmxlLmdldEZvcmVp\nZ25LZXlzKCk7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBma3MubGVu\nZ3RoOyBpKyspCiAgICAgICAgICAgIGlmIChma3NbaV0gIT0gam9pbiAmJiBm\na3NbaV0gIT0gY2xzLmdldEpvaW5Gb3JlaWduS2V5KCkpCiAgICAgICAgICAg\nICAgICBtYXBGb3JlaWduS2V5KGNscywgZmtzW2ldLCBqb2luLCBvdXRlcik7\nCgogICAgICAgIC8vIG1hcCBhbnkgY29sdW1ucyBub3QgY29udHJvbGxlZCBi\neSBmb3JlaWduIGtleXM7IGFsc28gZm9yY2UgcHJpbWFyeQogICAgICAgIC8v\nIGtleSBjb2xzIHRvIGdldCBtYXBwZWQgdG8gc2ltcGxlIGZpZWxkcyBldmVu\nIGlmIHRoZSBjb2x1bW5zIGFyZQogICAgICAgIC8vIGFsc28gZm9yZWlnbiBr\nZXkgY29sdW1ucwogICAgICAgIFByaW1hcnlLZXkgcGsgPSAoam9pbiAhPSBu\ndWxsKSA/IG51bGwgOiB0YWJsZS5nZXRQcmltYXJ5S2V5KCk7CiAgICAgICAg\nYm9vbGVhbiBwa2NvbDsKICAgICAgICBDb2x1bW5bXSBjb2xzID0gdGFibGUu\nZ2V0Q29sdW1ucygpOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgY29s\ncy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBwa2NvbCA9IHBrICE9IG51\nbGwgJiYgcGsuY29udGFpbnNDb2x1bW4oY29sc1tpXSk7CiAgICAgICAgICAg\nIGlmIChwa2NvbCAmJiBjbHMuZ2V0SWRlbnRpdHlUeXBlKCkgPT0gQ2xhc3NN\nYXBwaW5nLklEX0RBVEFTVE9SRSkKICAgICAgICAgICAgICAgIGNvbnRpbnVl\nOwogICAgICAgICAgICBpZiAoKGNscy5nZXRQQ1N1cGVyY2xhc3MoKSA9PSBu\ndWxsICYmIHBrY29sKQogICAgICAgICAgICAgICAgfHwgIWlzRm9yZWlnbktl\neUNvbHVtbihjb2xzW2ldKSkKICAgICAgICAgICAgICAgIG1hcENvbHVtbihj\nbHMsIGNvbHNbaV0sIGpvaW4sIG91dGVyKTsKICAgICAgICB9CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBXaGV0aGVyIHRoZSBnaXZlbiBjb2x1bW4gYXBwZWFy\ncyBpbiBhbnkgZm9yZWlnbiBrZXlzLgogICAgICovCiAgICBwcml2YXRlIHN0\nYXRpYyBib29sZWFuIGlzRm9yZWlnbktleUNvbHVtbihDb2x1bW4gY29sKSB7\nCiAgICAgICAgRm9yZWlnbktleVtdIGZrcyA9IGNvbC5nZXRUYWJsZSgpLmdl\ndEZvcmVpZ25LZXlzKCk7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBm\na3MubGVuZ3RoOyBpKyspCiAgICAgICAgICAgIGlmIChma3NbaV0uY29udGFp\nbnNDb2x1bW4oY29sKSkKICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwog\nICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICAvKioKICAgICAqIE1h\ncCBhIGZvcmVpZ24ga2V5IHRvIGEgcmVsYXRpb24uCiAgICAgKi8KICAgIHBy\naXZhdGUgdm9pZCBtYXBGb3JlaWduS2V5KENsYXNzTWFwcGluZyBjbHMsIEZv\ncmVpZ25LZXkgZmssCiAgICAgICAgRm9yZWlnbktleSBqb2luLCBib29sZWFu\nIG91dGVyKSB7CiAgICAgICAgQ2xhc3NNYXBwaW5nIHJlbCA9IChDbGFzc01h\ncHBpbmcpIF90YWJsZXMuZ2V0KGZrLmdldFByaW1hcnlLZXlUYWJsZSgpKTsK\nICAgICAgICBpZiAocmVsID09IG51bGwpCiAgICAgICAgICAgIHJldHVybjsK\nCiAgICAgICAgU3RyaW5nIG5hbWUgPSBnZXRSZWxhdGlvbk5hbWUocmVsLmdl\ndERlc2NyaWJlZFR5cGUoKSwgZmFsc2UsIGZrLAogICAgICAgICAgICBmYWxz\nZSwgY2xzKTsKICAgICAgICBGaWVsZE1hcHBpbmcgZmllbGQxID0gbmV3Rmll\nbGRNYXBwaW5nKG5hbWUsIHJlbC5nZXREZXNjcmliZWRUeXBlKCksCiAgICAg\nICAgICAgIG51bGwsIGZrLCBjbHMpOwogICAgICAgIGlmIChmaWVsZDEgIT0g\nbnVsbCkgewogICAgICAgICAgICBmaWVsZDEuc2V0Sm9pbkZvcmVpZ25LZXko\nam9pbik7CiAgICAgICAgICAgIGZpZWxkMS5zZXRKb2luT3V0ZXIob3V0ZXIp\nOwogICAgICAgICAgICBhZGRKb2luQ29uc3RyYWludHMoZmllbGQxKTsKICAg\nICAgICAgICAgZmllbGQxLnNldEZvcmVpZ25LZXkoZmspOwogICAgICAgICAg\nICBhZGRDb25zdHJhaW50cyhmaWVsZDEpOwogICAgICAgICAgICBmaWVsZDEu\nc2V0U3RyYXRlZ3kobmV3IFJlbGF0aW9uRmllbGRTdHJhdGVneSgpLCBudWxs\nKTsKICAgICAgICAgICAgaWYgKF9jdXN0b20gIT0gbnVsbCkKICAgICAgICAg\nICAgICAgIF9jdXN0b20uY3VzdG9taXplKGZpZWxkMSk7CiAgICAgICAgfQog\nICAgICAgIGlmICghX2ludmVyc2UgfHwgam9pbiAhPSBudWxsKQogICAgICAg\nICAgICByZXR1cm47CgogICAgICAgIC8vIGNyZWF0ZSBpbnZlcnNlIHJlbGF0\naW9uCiAgICAgICAgYm9vbGVhbiB1bnEgPSBpc1VuaXF1ZShmayk7CiAgICAg\nICAgbmFtZSA9IGdldFJlbGF0aW9uTmFtZShjbHMuZ2V0RGVzY3JpYmVkVHlw\nZSgpLCAhdW5xLCBmaywgdHJ1ZSwgcmVsKTsKICAgICAgICBDbGFzcyB0eXBl\nID0gKHVucSkgPyBjbHMuZ2V0RGVzY3JpYmVkVHlwZSgpIDogU2V0LmNsYXNz\nOwogICAgICAgIEZpZWxkTWFwcGluZyBmaWVsZDIgPSBuZXdGaWVsZE1hcHBp\nbmcobmFtZSwgdHlwZSwgbnVsbCwgZmssIHJlbCk7CiAgICAgICAgaWYgKGZp\nZWxkMiA9PSBudWxsKQogICAgICAgICAgICByZXR1cm47CiAgICAgICAgaWYg\nKGZpZWxkMSAhPSBudWxsKQogICAgICAgICAgICBmaWVsZDIuc2V0TWFwcGVk\nQnkoZmllbGQxLmdldE5hbWUoKSk7CiAgICAgICAgaWYgKHVucSkgewogICAg\nICAgICAgICBmaWVsZDIuc2V0Rm9yZWlnbktleShmayk7CiAgICAgICAgICAg\nIGZpZWxkMi5zZXRKb2luRGlyZWN0aW9uKGZpZWxkMi5KT0lOX0lOVkVSU0Up\nOwogICAgICAgICAgICBmaWVsZDIuc2V0U3RyYXRlZ3kobmV3IFJlbGF0aW9u\nRmllbGRTdHJhdGVneSgpLCBudWxsKTsKICAgICAgICB9IGVsc2UgewogICAg\nICAgICAgICBWYWx1ZU1hcHBpbmcgdm0gPSBmaWVsZDIuZ2V0RWxlbWVudE1h\ncHBpbmcoKTsKICAgICAgICAgICAgdm0uc2V0RGVjbGFyZWRUeXBlKGNscy5n\nZXREZXNjcmliZWRUeXBlKCkpOwogICAgICAgICAgICB2bS5zZXRGb3JlaWdu\nS2V5KGZrKTsKICAgICAgICAgICAgdm0uc2V0Sm9pbkRpcmVjdGlvbih2bS5K\nT0lOX0VYUEVDVEVEX0lOVkVSU0UpOwogICAgICAgICAgICBmaWVsZDIuc2V0\nU3RyYXRlZ3kobmV3IFJlbGF0aW9uQ29sbGVjdGlvbkludmVyc2VLZXlGaWVs\nZFN0cmF0ZWd5KCksCiAgICAgICAgICAgICAgICBudWxsKTsKICAgICAgICB9\nCiAgICAgICAgaWYgKF9jdXN0b20gIT0gbnVsbCkKICAgICAgICAgICAgX2N1\nc3RvbS5jdXN0b21pemUoZmllbGQyKTsKICAgIH0KCiAgICAvKioKICAgICAq\nIE1hcCBhIGNvbHVtbiB0byBhIHNpbXBsZSBmaWVsZC4KICAgICAqLwogICAg\ncHJpdmF0ZSB2b2lkIG1hcENvbHVtbihDbGFzc01hcHBpbmcgY2xzLCBDb2x1\nbW4gY29sLCBGb3JlaWduS2V5IGpvaW4sCiAgICAgICAgYm9vbGVhbiBvdXRl\ncikgewogICAgICAgIFN0cmluZyBuYW1lID0gZ2V0RmllbGROYW1lKGNvbC5n\nZXROYW1lKCksIGNscyk7CiAgICAgICAgQ2xhc3MgdHlwZSA9IGdldEZpZWxk\nVHlwZShjb2wsIGZhbHNlKTsKICAgICAgICBGaWVsZE1hcHBpbmcgZmllbGQg\nPSBuZXdGaWVsZE1hcHBpbmcobmFtZSwgdHlwZSwgY29sLCBudWxsLCBjbHMp\nOwogICAgICAgIGZpZWxkLnNldFNlcmlhbGl6ZWQodHlwZSA9PSBPYmplY3Qu\nY2xhc3MpOwogICAgICAgIGZpZWxkLnNldEpvaW5Gb3JlaWduS2V5KGpvaW4p\nOwogICAgICAgIGZpZWxkLnNldEpvaW5PdXRlcihvdXRlcik7CiAgICAgICAg\nYWRkSm9pbkNvbnN0cmFpbnRzKGZpZWxkKTsKICAgICAgICBmaWVsZC5zZXRD\nb2x1bW5zKG5ldyBDb2x1bW5bXXsgY29sIH0pOwogICAgICAgIGFkZENvbnN0\ncmFpbnRzKGZpZWxkKTsKICAgICAgICBpZiAoY29sLmlzUHJpbWFyeUtleSgp\nCiAgICAgICAgICAgICYmIGNscy5nZXRJZGVudGl0eVR5cGUoKSAhPSBDbGFz\nc01hcHBpbmcuSURfREFUQVNUT1JFKQogICAgICAgICAgICBmaWVsZC5zZXRQ\ncmltYXJ5S2V5KHRydWUpOwoKICAgICAgICBGaWVsZFN0cmF0ZWd5IHN0cmF0\nOwogICAgICAgIGlmICh0eXBlLmlzUHJpbWl0aXZlKCkpCiAgICAgICAgICAg\nIHN0cmF0ID0gbmV3IFByaW1pdGl2ZUZpZWxkU3RyYXRlZ3koKTsKICAgICAg\nICBlbHNlIGlmIChjb2wuZ2V0VHlwZSgpID09IFR5cGVzLkNMT0IKICAgICAg\nICAgICAgJiYgX2NvbmYuZ2V0REJEaWN0aW9uYXJ5SW5zdGFuY2UoKS5tYXhF\nbWJlZGRlZENsb2JTaXplICE9IC0xKQogICAgICAgICAgICBzdHJhdCA9IG5l\ndyBNYXhFbWJlZGRlZENsb2JGaWVsZFN0cmF0ZWd5KCk7CiAgICAgICAgZWxz\nZSBpZiAoY29sLmlzTG9iKCkKICAgICAgICAgICAgJiYgX2NvbmYuZ2V0REJE\naWN0aW9uYXJ5SW5zdGFuY2UoKS5tYXhFbWJlZGRlZEJsb2JTaXplICE9IC0x\nKQogICAgICAgICAgICBzdHJhdCA9IG5ldyBNYXhFbWJlZGRlZEJsb2JGaWVs\nZFN0cmF0ZWd5KCk7CiAgICAgICAgZWxzZSBpZiAodHlwZSA9PSBTdHJpbmcu\nY2xhc3MpCiAgICAgICAgICAgIHN0cmF0ID0gbmV3IFN0cmluZ0ZpZWxkU3Ry\nYXRlZ3koKTsKICAgICAgICBlbHNlCiAgICAgICAgICAgIHN0cmF0ID0gbmV3\nIEhhbmRsZXJGaWVsZFN0cmF0ZWd5KCk7CiAgICAgICAgZmllbGQuc2V0U3Ry\nYXRlZ3koc3RyYXQsIG51bGwpOwogICAgICAgIGlmIChfY3VzdG9tICE9IG51\nbGwpCiAgICAgICAgICAgIF9jdXN0b20uY3VzdG9taXplKGZpZWxkKTsKICAg\nIH0KCiAgICAvKioKICAgICAqIENyZWF0ZSBhIGNsYXNzIG1hcHBpbmcgZm9y\nIHRoZSBnaXZlbiB0YWJsZSwgb3IgcmV0dXJuIG51bGwgaWYKICAgICAqIGN1\nc3RvbWl6ZXIgcmVqZWN0cy4KICAgICAqLwogICAgcHJpdmF0ZSBDbGFzc01h\ncHBpbmcgbmV3Q2xhc3NNYXBwaW5nKFRhYmxlIHRhYmxlLCBDbGFzcyBwYXJl\nbnQpIHsKICAgICAgICBTdHJpbmcgbmFtZSA9IGdldENsYXNzTmFtZSh0YWJs\nZSk7CiAgICAgICAgaWYgKF9jdXN0b20gIT0gbnVsbCkKICAgICAgICAgICAg\nbmFtZSA9IF9jdXN0b20uZ2V0Q2xhc3NOYW1lKHRhYmxlLCBuYW1lKTsKICAg\nICAgICBpZiAobmFtZSA9PSBudWxsKQogICAgICAgICAgICByZXR1cm4gbnVs\nbDsKICAgICAgICByZXR1cm4gbmV3Q2xhc3NNYXBwaW5nKGdlbmVyYXRlQ2xh\nc3MobmFtZSwgcGFyZW50KSwgdGFibGUpOwogICAgfQoKICAgIC8qKgogICAg\nICogQ3JlYXRlIGEgZmllbGQgbWFwcGluZyBmb3IgdGhlIGdpdmVuIGluZm8s\nIG9yIHJldHVybiBudWxsIGlmCiAgICAgKiBjdXN0b21pemVyIHJlamVjdHMu\nCiAgICAgKi8KICAgIHB1YmxpYyBGaWVsZE1hcHBpbmcgbmV3RmllbGRNYXBw\naW5nKFN0cmluZyBuYW1lLCBDbGFzcyB0eXBlLCBDb2x1bW4gY29sLAogICAg\nICAgIEZvcmVpZ25LZXkgZmssIENsYXNzTWFwcGluZyBkZWMpIHsKICAgICAg\nICBpZiAoX2N1c3RvbSAhPSBudWxsKSB7CiAgICAgICAgICAgIENvbHVtbltd\nIGNvbHMgPSAoZmsgPT0gbnVsbCkgPyBuZXcgQ29sdW1uW117IGNvbCB9CiAg\nICAgICAgICAgICAgICA6IGZrLmdldENvbHVtbnMoKTsKICAgICAgICAgICAg\nU3RyaW5nIG5ld05hbWUgPSBfY3VzdG9tLmdldEZpZWxkTmFtZShkZWMsIGNv\nbHMsIGZrLCBuYW1lKTsKICAgICAgICAgICAgaWYgKG5ld05hbWUgPT0gbnVs\nbCB8fCAhbmV3TmFtZS5lcXVhbHMobmFtZSkpIHsKICAgICAgICAgICAgICAg\nIGlmIChfYWJhbmRvbmVkRmllbGROYW1lcyA9PSBudWxsKQogICAgICAgICAg\nICAgICAgICAgIF9hYmFuZG9uZWRGaWVsZE5hbWVzID0gbmV3IEhhc2hTZXQo\nKTsKICAgICAgICAgICAgICAgIF9hYmFuZG9uZWRGaWVsZE5hbWVzLmFkZChk\nZWMuZ2V0RGVzY3JpYmVkVHlwZSgpLmdldE5hbWUoKQogICAgICAgICAgICAg\nICAgICAgICsgIi4iICsgbmFtZSk7CiAgICAgICAgICAgICAgICBpZiAobmV3\nTmFtZSA9PSBudWxsKQogICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxs\nOwogICAgICAgICAgICAgICAgbmFtZSA9IG5ld05hbWU7CiAgICAgICAgICAg\nIH0KICAgICAgICB9CgogICAgICAgIEZpZWxkTWFwcGluZyBmaWVsZCA9IGRl\nYy5hZGREZWNsYXJlZEZpZWxkTWFwcGluZyhuYW1lLCB0eXBlKTsKICAgICAg\nICBmaWVsZC5zZXRFeHBsaWNpdCh0cnVlKTsKICAgICAgICByZXR1cm4gZmll\nbGQ7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gYSBKYXZhIGlkZW50\naWZpZXItZm9ybWF0dGVkIG5hbWUgZm9yIHRoZSBnaXZlbiB0YWJsZQogICAg\nICogbmFtZSwgdXNpbmcgdGhlIGRlZmF1bHQgcGFja2FnZS4KICAgICAqLwog\nICAgcHJpdmF0ZSBTdHJpbmcgZ2V0Q2xhc3NOYW1lKFRhYmxlIHRhYmxlKSB7\nCiAgICAgICAgU3RyaW5nQnVpbGRlciBidWYgPSBuZXcgU3RyaW5nQnVpbGRl\ncigpOwogICAgICAgIGlmIChnZXRQYWNrYWdlTmFtZSgpICE9IG51bGwpCiAg\nICAgICAgICAgIGJ1Zi5hcHBlbmQoZ2V0UGFja2FnZU5hbWUoKSkuYXBwZW5k\nKCIuIik7CgogICAgICAgIFN0cmluZ1tdIHN1YnM7CiAgICAgICAgU3RyaW5n\nIG5hbWUgPSByZXBsYWNlSW52YWxpZENoYXJhY3RlcnModGFibGUuZ2V0U2No\nZW1hTmFtZSgpKTsKICAgICAgICBpZiAoX3VzZVNjaGVtYSAmJiBuYW1lICE9\nIG51bGwpIHsKICAgICAgICAgICAgaWYgKGFsbFVwcGVyQ2FzZShuYW1lKSkK\nICAgICAgICAgICAgICAgIG5hbWUgPSBuYW1lLnRvTG93ZXJDYXNlKCk7CiAg\nICAgICAgICAgIHN1YnMgPSBTdHJpbmdzLnNwbGl0KG5hbWUsICJfIiwgMCk7\nCiAgICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgc3Vicy5sZW5ndGg7\nIGkrKykKICAgICAgICAgICAgICAgIGJ1Zi5hcHBlbmQoU3RyaW5nVXRpbHMu\nY2FwaXRhbGlzZShzdWJzW2ldKSk7CiAgICAgICAgfQoKICAgICAgICBuYW1l\nID0gcmVwbGFjZUludmFsaWRDaGFyYWN0ZXJzKHRhYmxlLmdldE5hbWUoKSk7\nCiAgICAgICAgaWYgKGFsbFVwcGVyQ2FzZShuYW1lKSkKICAgICAgICAgICAg\nbmFtZSA9IG5hbWUudG9Mb3dlckNhc2UoKTsKICAgICAgICBzdWJzID0gU3Ry\naW5ncy5zcGxpdChuYW1lLCAiXyIsIDApOwogICAgICAgIGZvciAoaW50IGkg\nPSAwOyBpIDwgc3Vicy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAvLyBt\nYWtlIHN1cmUgdGhlIG5hbWUgY2FuJ3QgY29uZmxpY3Qgd2l0aCBnZW5lcmF0\nZWQgaWQgY2xhc3MgbmFtZXM7CiAgICAgICAgICAgIC8vIGlmIHRoZSBuYW1l\nIHdvdWxkIGVuZCBpbiAnSWQnLCBtYWtlIGl0IGVuZCBpbiAnSWRlbnQnCiAg\nICAgICAgICAgIGlmIChpID09IHN1YnMubGVuZ3RoIC0gMSAmJiBzdWJzW2ld\nLmVxdWFsc0lnbm9yZUNhc2UoImlkIikpCiAgICAgICAgICAgICAgICBzdWJz\nW2ldID0gImlkZW50IjsKICAgICAgICAgICAgYnVmLmFwcGVuZChTdHJpbmdV\ndGlscy5jYXBpdGFsaXNlKHN1YnNbaV0pKTsKICAgICAgICB9CgogICAgICAg\nIHJldHVybiBidWYudG9TdHJpbmcoKTsKICAgIH0KCiAgICAvKioKICAgICAq\nIFJldHVybiBhIGRlZmF1bHQgSmF2YSBpZGVudGlmaWVyLWZvcm1hdHRlZCBu\nYW1lIGZvciB0aGUgZ2l2ZW4KICAgICAqIGNvbHVtbi90YWJsZSBuYW1lLgog\nICAgICovCiAgICBwdWJsaWMgU3RyaW5nIGdldEZpZWxkTmFtZShTdHJpbmcg\nbmFtZSwgQ2xhc3NNYXBwaW5nIGRlYykgewogICAgICAgIG5hbWUgPSByZXBs\nYWNlSW52YWxpZENoYXJhY3RlcnMobmFtZSk7CiAgICAgICAgaWYgKGFsbFVw\ncGVyQ2FzZShuYW1lKSkKICAgICAgICAgICAgbmFtZSA9IG5hbWUudG9Mb3dl\nckNhc2UoKTsKICAgICAgICBlbHNlCiAgICAgICAgICAgIG5hbWUgPSBDaGFy\nYWN0ZXIudG9Mb3dlckNhc2UobmFtZS5jaGFyQXQoMCkpICsgbmFtZS5zdWJz\ndHJpbmcoMSk7CgogICAgICAgIFN0cmluZ0J1aWxkZXIgYnVmID0gbmV3IFN0\ncmluZ0J1aWxkZXIoKTsKICAgICAgICBTdHJpbmdbXSBzdWJzID0gU3RyaW5n\ncy5zcGxpdChuYW1lLCAiXyIsIDApOwogICAgICAgIGZvciAoaW50IGkgPSAw\nOyBpIDwgc3Vicy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBpZiAoaSA+\nIDApCiAgICAgICAgICAgICAgICBzdWJzW2ldID0gU3RyaW5nVXRpbHMuY2Fw\naXRhbGlzZShzdWJzW2ldKTsKICAgICAgICAgICAgYnVmLmFwcGVuZChzdWJz\nW2ldKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGdldFVuaXF1ZU5hbWUo\nYnVmLnRvU3RyaW5nKCksIGRlYyk7CiAgICB9CgogICAgLyoqCiAgICAgKiBS\nZXR1cm4gYSBkZWZhdWx0IGphdmEgaWRlbnRpZmllci1mb3JtYXR0ZWQgZmll\nbGQgcmVsYXRpb24gbmFtZQogICAgICogZm9yIHRoZSBnaXZlbiBjbGFzcyBu\nYW1lLgogICAgICovCiAgICBwcml2YXRlIFN0cmluZyBnZXRSZWxhdGlvbk5h\nbWUoQ2xhc3MgZmllbGRUeXBlLCBib29sZWFuIGNvbGwsCiAgICAgICAgRm9y\nZWlnbktleSBmaywgYm9vbGVhbiBpbnZlcnNlLCBDbGFzc01hcHBpbmcgZGVj\nKSB7CiAgICAgICAgaWYgKF91c2VGSyAmJiBmay5nZXROYW1lKCkgIT0gbnVs\nbCkgewogICAgICAgICAgICBTdHJpbmcgbmFtZSA9IGdldEZpZWxkTmFtZShm\nay5nZXROYW1lKCksIGRlYyk7CiAgICAgICAgICAgIGlmIChpbnZlcnNlICYm\nIGNvbGwpCiAgICAgICAgICAgICAgICBuYW1lID0gbmFtZSArICJJbnZlcnNl\ncyI7CiAgICAgICAgICAgIGVsc2UgaWYgKGludmVyc2UpCiAgICAgICAgICAg\nICAgICBuYW1lID0gbmFtZSArICJJbnZlcnNlIjsKICAgICAgICAgICAgcmV0\ndXJuIGdldFVuaXF1ZU5hbWUobmFtZSwgZGVjKTsKICAgICAgICB9CgogICAg\nICAgIC8vIGdldCBqdXN0IHRoZSBjbGFzcyBuYW1lLCB3L28gcGFja2FnZQog\nICAgICAgIFN0cmluZyBuYW1lID0gZmllbGRUeXBlLmdldE5hbWUoKTsKICAg\nICAgICBuYW1lID0gbmFtZS5zdWJzdHJpbmcobmFtZS5sYXN0SW5kZXhPZign\nLicpICsgMSk7CgogICAgICAgIC8vIG1ha2UgdGhlIGZpcnN0IGNoYXJhY3Rl\nciBsb3dlcmNhc2UgYW5kIHBsdXJhbGl6ZSBpZiBhIGNvbGxlY3Rpb24KICAg\nICAgICBuYW1lID0gQ2hhcmFjdGVyLnRvTG93ZXJDYXNlKG5hbWUuY2hhckF0\nKDApKSArIG5hbWUuc3Vic3RyaW5nKDEpOwogICAgICAgIGlmIChjb2xsICYm\nICFuYW1lLmVuZHNXaXRoKCJzIikpCiAgICAgICAgICAgIG5hbWUgKz0gInMi\nOwoKICAgICAgICByZXR1cm4gZ2V0VW5pcXVlTmFtZShuYW1lLCBkZWMpOwog\nICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRydWUgaWYgdGhlIGdpdmVu\nIHN0cmluZyBpcyBhbGwgdXBwZXJjYXNlIGxldHRlcnMuCiAgICAgKi8KICAg\nIHByaXZhdGUgc3RhdGljIGJvb2xlYW4gYWxsVXBwZXJDYXNlKFN0cmluZyBz\ndHIpIHsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IHN0ci5sZW5ndGgo\nKTsgaSsrKSB7CiAgICAgICAgICAgIGlmIChDaGFyYWN0ZXIuaXNMZXR0ZXIo\nc3RyLmNoYXJBdChpKSkKICAgICAgICAgICAgICAgICYmICFDaGFyYWN0ZXIu\naXNVcHBlckNhc2Uoc3RyLmNoYXJBdChpKSkpCiAgICAgICAgICAgICAgICBy\nZXR1cm4gZmFsc2U7CiAgICAgICAgfQogICAgICAgIHJldHVybiB0cnVlOwog\nICAgfQoKICAgIC8qKgogICAgICogUmVwbGFjZSBjaGFyYWN0ZXJzIG5vdCBh\nbGxvd2VkIGluIEphdmEgbmFtZXMgd2l0aCBhbiB1bmRlcnNjb3JlOwogICAg\nICogcGFja2FnZS1wcml2YXRlIGZvciB0ZXN0aW5nLgogICAgICovCiAgICBz\ndGF0aWMgU3RyaW5nIHJlcGxhY2VJbnZhbGlkQ2hhcmFjdGVycyhTdHJpbmcg\nc3RyKSB7CiAgICAgICAgaWYgKFN0cmluZ1V0aWxzLmlzRW1wdHkoc3RyKSkK\nICAgICAgICAgICAgcmV0dXJuIHN0cjsKCiAgICAgICAgU3RyaW5nQnVpbGRl\nciBidWYgPSBuZXcgU3RyaW5nQnVpbGRlcihzdHIpOwogICAgICAgIGNoYXIg\nYzsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGJ1Zi5sZW5ndGgoKTsg\naSsrKSB7CiAgICAgICAgICAgIGMgPSBidWYuY2hhckF0KGkpOwogICAgICAg\nICAgICBpZiAoYyA9PSAnJCcgfHwgIUNoYXJhY3Rlci5pc0phdmFJZGVudGlm\naWVyUGFydChzdHIuY2hhckF0KGkpKSkKICAgICAgICAgICAgICAgIGJ1Zi5z\nZXRDaGFyQXQoaSwgJ18nKTsKICAgICAgICB9CgogICAgICAgIC8vIHN0cmlw\nIGxlYWRpbmcgYW5kIHRyYWlsaW5nIHVuZGVyc2NvcmVzCiAgICAgICAgaW50\nIHN0YXJ0ID0gMDsKICAgICAgICB3aGlsZSAoc3RhcnQgPCBidWYubGVuZ3Ro\nKCkgJiYgYnVmLmNoYXJBdChzdGFydCkgPT0gJ18nKQogICAgICAgICAgICBz\ndGFydCsrOwogICAgICAgIGludCBlbmQgPSBidWYubGVuZ3RoKCkgLSAxOwog\nICAgICAgIHdoaWxlIChlbmQgPj0gMCAmJiBidWYuY2hhckF0KGVuZCkgPT0g\nJ18nKQogICAgICAgICAgICBlbmQtLTsKCiAgICAgICAgLy8gcG9zc2libGUg\ndGhhdCBhbGwgY2hhcnMgaW4gbmFtZSBhcmUgaW52YWxpZAogICAgICAgIGlm\nIChzdGFydCA+IGVuZCkKICAgICAgICAgICAgcmV0dXJuICJ4IjsKICAgICAg\nICByZXR1cm4gYnVmLnN1YnN0cmluZyhzdGFydCwgZW5kICsgMSk7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBNb2RpZmllcyB0aGUgZ2l2ZW4gbmFtZSBhcyBu\nZWNlc3NhcnkgdG8gZW5zdXJlIHRoYXQgaXQgaXNuJ3QgYWxyZWFkeQogICAg\nICogdGFrZW4gYnkgYSBmaWVsZCBpbiB0aGUgZ2l2ZW4gcGFyZW50LgogICAg\nICovCiAgICBwcml2YXRlIFN0cmluZyBnZXRVbmlxdWVOYW1lKFN0cmluZyBu\nYW1lLCBDbGFzc01hcHBpbmcgZGVjKSB7CiAgICAgICAgLy8gbWFrZSBzdXJl\nIHRoZSBuYW1lIGlzbid0IGEga2V5d29yZAogICAgICAgIGlmIChfamF2YUtl\neXdvcmRzLmNvbnRhaW5zS2V5KG5hbWUpKQogICAgICAgICAgICBuYW1lID0g\nKFN0cmluZykgX2phdmFLZXl3b3Jkcy5nZXQobmFtZSk7CgogICAgICAgIC8v\nIHRoaXMgaXMgdGhlIHNhbWUgYWxnb3JpdGhtIHVzZWQgaW4gREJEaWN0aW9u\nYXJ5IHRvIGdldCB1bmlxdWUgbmFtZXMKICAgICAgICBTdHJpbmcgcHJlZml4\nID0gZGVjLmdldERlc2NyaWJlZFR5cGUoKS5nZXROYW1lKCkgKyAiLiI7CiAg\nICAgICAgZm9yIChpbnQgdmVyc2lvbiA9IDIsIGNoYXJzID0gMTsKICAgICAg\nICAgICAgZGVjLmdldERlY2xhcmVkRmllbGQobmFtZSkgIT0gbnVsbAogICAg\nICAgICAgICAgICAgfHwgKF9hYmFuZG9uZWRGaWVsZE5hbWVzICE9IG51bGwK\nICAgICAgICAgICAgICAgICYmIF9hYmFuZG9uZWRGaWVsZE5hbWVzLmNvbnRh\naW5zKHByZWZpeCArIG5hbWUpKTsgdmVyc2lvbisrKSB7CiAgICAgICAgICAg\nIGlmICh2ZXJzaW9uID4gMikKICAgICAgICAgICAgICAgIG5hbWUgPSBuYW1l\nLnN1YnN0cmluZygwLCBuYW1lLmxlbmd0aCgpIC0gY2hhcnMpOwogICAgICAg\nICAgICBpZiAodmVyc2lvbiA+PSBNYXRoLnBvdygxMCwgY2hhcnMpKQogICAg\nICAgICAgICAgICAgY2hhcnMrKzsKICAgICAgICAgICAgbmFtZSA9IG5hbWUg\nKyB2ZXJzaW9uOwogICAgICAgIH0KICAgICAgICByZXR1cm4gbmFtZTsKICAg\nIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgZGVmYXVsdCBmaWVsZCB0\neXBlIGZvciB0aGUgZ2l2ZW4gY29sdW1uLgogICAgICovCiAgICBwdWJsaWMg\nQ2xhc3MgZ2V0RmllbGRUeXBlKENvbHVtbiBjb2wsIGJvb2xlYW4gZm9yY2VP\nYmplY3QpIHsKICAgICAgICAvLyBjaGVjayB0aGUgY3VzdG9tIHR5cGUgbWFw\nIHRvIHNlZSBpZiB3ZSd2ZSBvdmVycmlkZGVuIHRoZQogICAgICAgIC8vIGRl\nZmF1bHQgdHlwZSB0byBjcmVhdGUgZm9yIGEgcmF3IFNRTCB0eXBlIG5hbWUK\nICAgICAgICBDbGFzcyB0eXBlID0gbnVsbDsKICAgICAgICBpZiAoX3R5cGVN\nYXAgIT0gbnVsbCkgewogICAgICAgICAgICAvLyBmaXJzdCB0cnkgIlRZUEUo\nU0laRSxERUNJTUFMUykiLCB0aGVuICJUWVBFKFNJWkUpLCB0aGVuICJUWVBF\nIgogICAgICAgICAgICBTdHJpbmdbXSBwcm9wTmFtZXMgPSBuZXcgU3RyaW5n\nW117CiAgICAgICAgICAgICAgICBjb2wuZ2V0VHlwZU5hbWUoKSArICIoIiAr\nIGNvbC5nZXRTaXplKCkgKyAiLCIKICAgICAgICAgICAgICAgICAgICArIGNv\nbC5nZXREZWNpbWFsRGlnaXRzKCkgKyAiKSIsCiAgICAgICAgICAgICAgICBj\nb2wuZ2V0VHlwZU5hbWUoKSArICIoIiArIGNvbC5nZXRTaXplKCkgKyAiKSIs\nCiAgICAgICAgICAgICAgICBjb2wuZ2V0VHlwZU5hbWUoKQogICAgICAgICAg\nICB9OwoKICAgICAgICAgICAgU3RyaW5nIHR5cGVOYW1lID0gbnVsbDsKICAg\nICAgICAgICAgU3RyaW5nIHR5cGVTcGVjID0gbnVsbDsKICAgICAgICAgICAg\naW50IG5hbWVJZHggPSAwOwogICAgICAgICAgICBmb3IgKDsgdHlwZVNwZWMg\nPT0gbnVsbCAmJiBuYW1lSWR4IDwgcHJvcE5hbWVzLmxlbmd0aDsgbmFtZUlk\neCsrKSB7CiAgICAgICAgICAgICAgICBpZiAocHJvcE5hbWVzW25hbWVJZHhd\nID09IG51bGwpCiAgICAgICAgICAgICAgICAgICAgY29udGludWU7CgogICAg\nICAgICAgICAgICAgdHlwZVNwZWMgPSBTdHJpbmdVdGlscy50cmltVG9OdWxs\nKF90eXBlTWFwLmdldFByb3BlcnR5CiAgICAgICAgICAgICAgICAgICAgKHBy\nb3BOYW1lc1tuYW1lSWR4XSkpOwogICAgICAgICAgICAgICAgaWYgKHR5cGVT\ncGVjICE9IG51bGwpIAogICAgICAgICAgICAgICAgICAgIHR5cGVOYW1lID0g\ncHJvcE5hbWVzW25hbWVJZHhdOwogICAgICAgICAgICB9CiAgICAgICAgICAg\nIGlmICh0eXBlU3BlYyAhPSBudWxsKQogICAgICAgICAgICAgICAgX2xvZy5p\nbmZvKF9sb2MuZ2V0KCJyZXZlcnNlLXR5cGUiLCB0eXBlTmFtZSwgdHlwZVNw\nZWMpKTsKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgX2xvZy50\ncmFjZShfbG9jLmdldCgibm8tcmV2ZXJzZS10eXBlIiwKICAgICAgICAgICAg\nICAgICAgICBwcm9wTmFtZXNbcHJvcE5hbWVzLmxlbmd0aCAtIDFdKSk7Cgog\nICAgICAgICAgICBpZiAodHlwZVNwZWMgIT0gbnVsbCkKICAgICAgICAgICAg\nICAgIHR5cGUgPSBTdHJpbmdzLnRvQ2xhc3ModHlwZVNwZWMsIF9jb25mLgog\nICAgICAgICAgICAgICAgICAgIGdldENsYXNzUmVzb2x2ZXJJbnN0YW5jZSgp\nLmdldENsYXNzTG9hZGVyCiAgICAgICAgICAgICAgICAgICAgKFJldmVyc2VN\nYXBwaW5nVG9vbC5jbGFzcywgbnVsbCkpOwogICAgICAgIH0KCiAgICAgICAg\naWYgKHR5cGUgPT0gbnVsbCkKICAgICAgICAgICAgdHlwZSA9IFNjaGVtYXMu\nZ2V0SmF2YVR5cGUoY29sLmdldFR5cGUoKSwgY29sLmdldFNpemUoKSwKICAg\nICAgICAgICAgICAgIGNvbC5nZXREZWNpbWFsRGlnaXRzKCkpOwogICAgICAg\nIGlmICh0eXBlID09IE9iamVjdC5jbGFzcykgewogICAgICAgICAgICBpZiAo\nIV9ibG9iQXNPYmopCiAgICAgICAgICAgICAgICByZXR1cm4gYnl0ZVtdLmNs\nYXNzOwogICAgICAgICAgICByZXR1cm4gdHlwZTsKICAgICAgICB9CgogICAg\nICAgIC8vIHRyZWF0IGNoYXJzIHNwZWNpYWxseTsgaWYgdGhlIGRpY3Rpb25h\ncnkgaGFzIHN0b3JlQ2hhcnNBc051bWJlcnMKICAgICAgICAvLyBzZXQsIHRo\nZW4gd2UgY2FuJ3QgcmV2ZXJzZSBtYXAgaW50byBhIGNoYXI7IHVzZSBhIHN0\ncmluZyBhbmQgdGVsbAogICAgICAgIC8vIHRoZSB1c2VyIHdoeSB3ZSBhcmUg\nZG9pbmcgc28KICAgICAgICBpZiAodHlwZSA9PSBjaGFyLmNsYXNzCiAgICAg\nICAgICAgICYmIF9jb25mLmdldERCRGljdGlvbmFyeUluc3RhbmNlKCkuc3Rv\ncmVDaGFyc0FzTnVtYmVycykgewogICAgICAgICAgICB0eXBlID0gU3RyaW5n\nLmNsYXNzOwogICAgICAgICAgICBpZiAoX2xvZy5pc1dhcm5FbmFibGVkKCkp\nCiAgICAgICAgICAgICAgICBfbG9nLndhcm4oX2xvYy5nZXQoImNhbnQtdXNl\nLWNoYXIiLCBjb2wuZ2V0RnVsbE5hbWUoKSkpOwogICAgICAgIH0KCiAgICAg\nICAgaWYgKCF0eXBlLmlzUHJpbWl0aXZlKCkpCiAgICAgICAgICAgIHJldHVy\nbiB0eXBlOwogICAgICAgIGlmICghZm9yY2VPYmplY3QgJiYgKGNvbC5pc05v\ndE51bGwoKSB8fCAhX251bGxBc09iaikpCiAgICAgICAgICAgIHJldHVybiB0\neXBlOwoKICAgICAgICAvLyBjb252ZXJ0IHRoZSB0eXBlIGludG8gdGhlIGFw\ncHJvcHJpYXRlIHdyYXBwZXIgY2xhc3MKICAgICAgICBzd2l0Y2ggKHR5cGUu\nZ2V0TmFtZSgpLmNoYXJBdCgwKSkgewogICAgICAgICAgICBjYXNlJ2InOgog\nICAgICAgICAgICAgICAgaWYgKHR5cGUgPT0gYm9vbGVhbi5jbGFzcykKICAg\nICAgICAgICAgICAgICAgICByZXR1cm4gQm9vbGVhbi5jbGFzczsKICAgICAg\nICAgICAgICAgIHJldHVybiBCeXRlLmNsYXNzOwogICAgICAgICAgICBjYXNl\nJ2MnOgogICAgICAgICAgICAgICAgcmV0dXJuIENoYXJhY3Rlci5jbGFzczsK\nICAgICAgICAgICAgY2FzZSdkJzoKICAgICAgICAgICAgICAgIHJldHVybiBE\nb3VibGUuY2xhc3M7CiAgICAgICAgICAgIGNhc2UnZic6CiAgICAgICAgICAg\nICAgICByZXR1cm4gRmxvYXQuY2xhc3M7CiAgICAgICAgICAgIGNhc2UnaSc6\nCiAgICAgICAgICAgICAgICByZXR1cm4gSW50ZWdlci5jbGFzczsKICAgICAg\nICAgICAgY2FzZSdsJzoKICAgICAgICAgICAgICAgIHJldHVybiBMb25nLmNs\nYXNzOwogICAgICAgICAgICBjYXNlJ3MnOgogICAgICAgICAgICAgICAgcmV0\ndXJuIFNob3J0LmNsYXNzOwogICAgICAgICAgICBkZWZhdWx0OgogICAgICAg\nICAgICAgICAgdGhyb3cgbmV3IEludGVybmFsRXhjZXB0aW9uKCk7CiAgICAg\nICAgfQogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIGEgbmV3IHRvb2wg\nd2l0aCB0aGUgc2FtZSBzZXR0aW5ncyBhcyB0aGlzIG9uZS4gVXNlZCBpbiB3\nb3JrYmVuY2guCiAgICAgKi8KICAgIHB1YmxpYyBPYmplY3QgY2xvbmUoKSB7\nCiAgICAgICAgUmV2ZXJzZU1hcHBpbmdUb29sIHRvb2wgPSBuZXcgUmV2ZXJz\nZU1hcHBpbmdUb29sKF9jb25mKTsKICAgICAgICB0b29sLnNldFNjaGVtYUdy\nb3VwKGdldFNjaGVtYUdyb3VwKCkpOwogICAgICAgIHRvb2wuc2V0UGFja2Fn\nZU5hbWUoZ2V0UGFja2FnZU5hbWUoKSk7CiAgICAgICAgdG9vbC5zZXREaXJl\nY3RvcnkoZ2V0RGlyZWN0b3J5KCkpOwogICAgICAgIHRvb2wuc2V0VXNlU2No\nZW1hTmFtZShnZXRVc2VTY2hlbWFOYW1lKCkpOwogICAgICAgIHRvb2wuc2V0\nVXNlRm9yZWlnbktleU5hbWUoZ2V0VXNlRm9yZWlnbktleU5hbWUoKSk7CiAg\nICAgICAgdG9vbC5zZXROdWxsYWJsZUFzT2JqZWN0KGdldE51bGxhYmxlQXNP\nYmplY3QoKSk7CiAgICAgICAgdG9vbC5zZXRCbG9iQXNPYmplY3QoZ2V0Qmxv\nYkFzT2JqZWN0KCkpOwogICAgICAgIHRvb2wuc2V0VXNlR2VuZXJpY0NvbGxl\nY3Rpb25zKGdldFVzZUdlbmVyaWNDb2xsZWN0aW9ucygpKTsKICAgICAgICB0\nb29sLnNldFByaW1hcnlLZXlPbkpvaW4oZ2V0UHJpbWFyeUtleU9uSm9pbigp\nKTsKICAgICAgICB0b29sLnNldFVzZURhdGFTdG9yZUlkZW50aXR5KGdldFVz\nZURhdGFTdG9yZUlkZW50aXR5KCkpOwogICAgICAgIHRvb2wuc2V0VXNlQnVp\nbHRpbklkZW50aXR5Q2xhc3MoZ2V0VXNlQnVpbHRpbklkZW50aXR5Q2xhc3Mo\nKSk7CiAgICAgICAgdG9vbC5zZXRJbm5lcklkZW50aXR5Q2xhc3NlcyhnZXRJ\nbm5lcklkZW50aXR5Q2xhc3NlcygpKTsKICAgICAgICB0b29sLnNldElkZW50\naXR5Q2xhc3NTdWZmaXgoZ2V0SWRlbnRpdHlDbGFzc1N1ZmZpeCgpKTsKICAg\nICAgICB0b29sLnNldEludmVyc2VSZWxhdGlvbnMoZ2V0SW52ZXJzZVJlbGF0\naW9ucygpKTsKICAgICAgICB0b29sLnNldERldGFjaGFibGUoZ2V0RGV0YWNo\nYWJsZSgpKTsKICAgICAgICB0b29sLnNldEdlbmVyYXRlQW5ub3RhdGlvbnMo\nZ2V0R2VuZXJhdGVBbm5vdGF0aW9ucygpKTsKICAgICAgICB0b29sLnNldEN1\nc3RvbWl6ZXIoZ2V0Q3VzdG9taXplcigpKTsKICAgICAgICB0b29sLnNldENv\nZGVGb3JtYXQoZ2V0Q29kZUZvcm1hdCgpKTsKICAgICAgICByZXR1cm4gdG9v\nbDsKICAgIH0KCiAgICAvLy8vLy8vLwogICAgLy8gTWFpbgogICAgLy8vLy8v\nLy8KCiAgICAvKioKICAgICAqIFVzYWdlOiBqYXZhIG9yZy5hcGFjaGUub3Bl\nbmpwYS5qZGJjLm1ldGEuUmV2ZXJzZU1hcHBpbmdUb29sCiAgICAgKiBbb3B0\naW9uXSogJmx0Oy5zY2hlbWEgZmlsZSBvciByZXNvdXJjZSZndDsqCiAgICAg\nKiAgV2hlcmUgdGhlIGZvbGxvd2luZyBvcHRpb25zIGFyZSByZWNvZ25pemVk\nLgogICAgICogPHVsPgogICAgICogPGxpPjxpPi1wcm9wZXJ0aWVzLy1wICZs\ndDtwcm9wZXJ0aWVzIGZpbGUgb3IgcmVzb3VyY2UmZ3Q7PC9pPjogVGhlCiAg\nICAgKiBwYXRoIG9yIHJlc291cmNlIG5hbWUgb2YgYSBPcGVuSlBBIHByb3Bl\ncnRpZXMgZmlsZSBjb250YWluaW5nCiAgICAgKiBpbmZvcm1hdGlvbiBzdWNo\nIGFzIHRoZSBsaWNlbnNlIGtleQlkYXRhIGFzIG91dGxpbmVkIGluCiAgICAg\nKiB7QGxpbmsgT3BlbkpQQUNvbmZpZ3VyYXRpb259LiBPcHRpb25hbC48L2xp\nPgogICAgICogPGxpPjxpPi0mbHQ7cHJvcGVydHkgbmFtZSZndDsgJmx0O3By\nb3BlcnR5IHZhbHVlJmd0OzwvaT46IEFsbCBiZWFuCiAgICAgKiBwcm9wZXJ0\naWVzIG9mIHRoZSBPcGVuSlBBIHtAbGluayBKREJDQ29uZmlndXJhdGlvbn0g\nY2FuIGJlIHNldCBieQogICAgICogdXNpbmcgdGhlaXIJbmFtZXMgYW5kIHN1\ncHBseWluZyBhIHZhbHVlLiBGb3IgZXhhbXBsZToKICAgICAqIDxjb2RlPi1s\naWNlbnNlS2V5IGFkc2xmamE4M3IzbGthZGY8L2NvZGU+PC9saT4KICAgICAq\nIDxsaT48aT4tc2NoZW1hcy8tcyAmbHQ7c2NoZW1hcyBhbmQgdGFibGVzJmd0\nOzwvaT46IENvbW1hLXNlcGFyYXRlZAogICAgICogbGlzdCBvZiBzY2hlbWFz\nIGFuZCB0YWJsZXMgdG8gcmV2ZXJzZS1tYXAuPC9saT4KICAgICAqIDxsaT48\naT4tcGFja2FnZS8tcGtnICZsdDtwYWNrYWdlIG5hbWUmZ3Q7PC9pPjogVGhl\nIG5hbWUgb2YgdGhlIHBhY2thZ2UKICAgICAqIGZvciBhbGwgZ2VuZXJhdGVk\nIGNsYXNzZXMuIERlZmF1bHRzIHRvIG5vIHBhY2thZ2UuPC9saT4KICAgICAq\nIDxsaT48aT4tZGlyZWN0b3J5Ly1kICZsdDtvdXRwdXQgZGlyZWN0b3J5Jmd0\nOzwvaT46IFRoZSBkaXJlY3Rvcnkgd2hlcmUKICAgICAqIGFsbCBnZW5lcmF0\nZWQgY29kZSBzaG91bGQgYmUgcGxhY2VkLiBEZWZhdWx0cyB0byB0aGUgY3Vy\ncmVudAogICAgICogZGlyZWN0b3J5LjwvbGk+CiAgICAgKiA8bGk+PGk+LXVz\nZVNjaGVtYU5hbWUvLXNuICZsdDt0cnVlL3QgfCBmYWxzZS9mJmd0OzwvaT46\nIFNldCB0aGlzIGZsYWcgdG8KICAgICAqIHRydWUgdG8gaW5jbHVkZSB0aGUg\nc2NoZW1hIG5hbWUgYXMgcGFydCBvZiB0aGUgZ2VuZXJhdGVkIGNsYXNzIG5h\nbWUKICAgICAqIGZvciBlYWNoIHRhYmxlLjwvbGk+CiAgICAgKiA8bGk+PGk+\nLXVzZUZvcmVpZ25LZXlOYW1lLy1ma24gJmx0O3RydWUvdCB8IGZhbHNlL2Ym\nZ3Q7PC9pPjogU2V0IHRoaXMKICAgICAqIGZsYWcgdG8gdHJ1ZSB0byB1c2Ug\ndGhlIGZvcmVpZ24ga2V5IG5hbWUgdG8gZ2VuZXJhdGUgZmllbGRzCiAgICAg\nKiByZXByZXNlbnRpbmcgcmVsYXRpb25zIGJldHdlZW4gY2xhc3Nlcy48L2xp\nPgogICAgICogPGxpPjxpPi1udWxsYWJsZUFzT2JqZWN0Ly1ubyAmbHQ7dHJ1\nZS90IHwgZmFsc2UvZiZndDs8L2k+OiBTZXQgdG8gdHJ1ZQogICAgICogdG8g\nbWFrZSBhbGwgbnVsbGFibGUgY29sdW1ucyBtYXAgdG8gb2JqZWN0IHR5cGVz\nOyBjb2x1bW5zIHRoYXQgd291bGQKICAgICAqIG5vcm1hbGx5IG1hcCB0byBh\nIHByaW1pdGl2ZSB3aWxsIG1hcCB0byB0aGUgYXBwcm9wcmlhdGUgd3JhcHBl\ncgogICAgICogdHlwZSBpbnN0ZWFkLjwvbGk+CiAgICAgKiA8bGk+PGk+LWJs\nb2JBc09iamVjdC8tYm8gJmx0O3RydWUvdCB8IGZhbHNlL2YmZ3Q7PC9pPjog\nU2V0IHRvIHRydWUKICAgICAqIHRvIG1ha2UgYWxsIGJpbmFyeSBjb2x1bW5z\nIG1hcCB0byBPYmplY3QgcmF0aGVyIHRoYW4gYnl0ZVtdLjwvbGk+CiAgICAg\nKiA8bGk+PGk+LXVzZUdlbmVyaWNDb2xsZWN0aW9ucy8tZ2MgJmx0O3RydWUv\ndCB8IGZhbHNlL2YmZ3Q7PC9pPjogU2V0IHRvCiAgICAgKiB0cnVlIHRvIHVz\nZSBnZW5lcmljIGNvbGxlY3Rpb25zIG9uIE9uZVRvTWFueSBhbmQgTWFueVRv\nTWFueSByZWxhdGlvbnMKICAgICAqIChyZXF1aXJlcyBKREsgMS41IG9yIGhp\nZ2hlcikuPC9saT4KICAgICAqIDxsaT48aT4tdHlwZU1hcC8tdHlwICZsdDt0\neXBlcyZndDs8L2k+OiBEZWZhdWx0IG1hcHBpbmcgb2YgU1FMIHR5cGUKICAg\nICAqIG5hbWVzIHRvIEphdmEgY2xhc3Nlcy48L2xpPgogICAgICogPGxpPjxp\nPi1wcmltYXJ5S2V5T25Kb2luLy1wa2ogJmx0O3RydWUvdCB8IGZhbHNlL2Ym\nZ3Q7PC9pPjogU2V0IHRvIHRydWUKICAgICAqIHRvIGFsbG93IHByaW1hcnkg\na2V5cyBvbiBqb2luIHRhYmxlcy48L2xpPgogICAgICogPGxpPjxpPi11c2VE\nYXRhc3RvcmVJZGVudGl0eS8tZHMgJmx0O3RydWUvdCB8IGZhbHNlL2YmZ3Q7\nPC9pPjogU2V0IHRvCiAgICAgKiB0cnVlIHRvIHVzZSBkYXRhc3RvcmUgaWRl\nbnRpdHkgd2hlcmUgcG9zc2libGUuPC9saT4KICAgICAqIDxsaT48aT4tdXNl\nQnVpbHRpbklkZW50aXR5Q2xhc3MvLWJpYyAmbHQ7dHJ1ZS90IHwgZmFsc2Uv\nZiZndDs8L2k+OiBTZXQKICAgICAqIHRvIGZhbHNlIHRvIG5ldmVyIHVzZSBP\ncGVuSlBBJ3MgYnVpbHRpbiBhcHBsaWNhdGlvbiBpZGVudGl0eQogICAgICog\nY2xhc3Nlcy48L2xpPgogICAgICogPGxpPjxpPi1pbm5lcklkZW50aXR5Q2xh\nc3Nlcy8taW5uICZsdDt0cnVlL3QgfCBmYWxzZS9mJmd0OzwvaT46IFNldCB0\nbwogICAgICogdHJ1ZSB0byBnZW5lcmF0ZSB0aGUgYXBwbGljYXRpb24gaWRl\nbnRpdHkgY2xhc3NlcyBhcyBpbm5lciBjbGFzc2VzLjwvbGk+CiAgICAgKiA8\nbGk+PGk+LWlkZW50aXR5Q2xhc3NTdWZmaXgvLWlzICZsdDtzdWZmaXgmZ3Q7\nPC9pPjogU3VmZml4IHRvIGFwcGVuZAogICAgICogdG8gY2xhc3MgbmFtZXMg\ndG8gY3JlYXRlIGlkZW50aXR5IGNsYXNzIG5hbWUsIG9yIGZvciBpbm5lciBp\nZGVudGl0eQogICAgICogY2xhc3NlcywgdGhlIGlubmVyIGNsYXNzIG5hbWUu\nPC9saT4KICAgICAqIDxsaT48aT4taW52ZXJzZVJlbGF0aW9ucy8taXIgJmx0\nO3RydWUvdCB8IGZhbHNlL2YmZ3Q7PC9pPjogU2V0IHRvCiAgICAgKiBmYWxz\nZSB0byBwcmV2ZW50IHRoZSBjcmVhdGlvbiBvZiBpbnZlcnNlIDEtbWFueS8x\nLTEgcmVsYXRpb25zIGZvcgogICAgICogZWFjaCBlbmNvdW50ZXJlZCBtYW55\nLTEvMS0xIHJlbGF0aW9uLjwvbGk+CiAgICAgKiA8bGk+PGk+LWRldGFjaGFi\nbGUvLWRldCAmbHQ7dHJ1ZS90IHwgZmFsc2UvZiZndDs8L2k+OiBTZXQgdG8K\nICAgICAqIHRydWUgdG8gbWFrZSBnZW5lcmF0ZWQgY2xhc3NlcyBkZXRhY2hh\nYmxlLjwvbGk+CiAgICAgKiA8bGk+PGk+LWRpc2NyaW1pbmF0b3JTdHJhdGVn\neS8tZHMgJmx0O3N0cmF0ZWd5Jmd0OzwvaT46IFRoZSBkZWZhdWx0CiAgICAg\nKiBkaXNjcmltaW5hdG9yIHN0cmF0ZWd5IHRvIHBsYWNlIG9uIGJhc2UgY2xh\nc3Nlcy48L2xpPgogICAgICogPGxpPjxpPi12ZXJzaW9uU3RyYXRlZ3kvLXZz\nICZsdDtzdHJhdGVneSZndDs8L2k+OiBUaGUgZGVmYXVsdAogICAgICogdmVy\nc2lvbiBzdHJhdGVneSB0byBwbGFjZSBvbiBiYXNlIGNsYXNzZXMuPC9saT4K\nICAgICAqIDxsaT48aT4tbWV0YWRhdGEvLW1kICZsdDtjbGFzcyB8IHBhY2th\nZ2UgfCBub25lJmd0OzwvaT46IFNwZWNpZnkgdGhlCiAgICAgKiBsZXZlbCB0\naGUgbWV0YWRhdGEgc2hvdWxkIGJlIGdlbmVyYXRlZCBhdC4gRGVmYXVsdHMg\ndG8gZ2VuZXJhdGluZyBhCiAgICAgKiBzaW5nbGUgcGFja2FnZS1sZXZlbCBt\nZXRhZGF0YSBmaWxlLjwvbGk+CiAgICAgKiA8bGk+PGk+LWFubm90YXRpb25z\nLy1hbm4gJmx0O3RydWUvdCB8IGZhbHNlL2YmZ3Q7PC9pPjogU2V0IHRvIHRy\ndWUgdG8KICAgICAqIGdlbmVyYXRlIEpQQSBhbm5vdGF0aW9ucyBpbiBnZW5l\ncmF0ZWQgY29kZS48L2xpPgogICAgICogPGxpPjxpPi1hY2Nlc3NUeXBlLy1h\nY2Nlc3MgJmx0O2ZpZWxkIHwgcHJvcGVydHkmZ3Q7PC9pPjogQ2hhbmdlIGFj\nY2VzcwogICAgICogdHlwZSBmb3IgZ2VuZXJhdGVkIGFubm90YXRpb25zLiBE\nZWZhdWx0cyB0byBmaWVsZCBhY2Nlc3MuPC9saT4KICAgICAqIDxsaT48aT4t\nY3VzdG9taXplckNsYXNzLy1jYyAmbHQ7Y2xhc3MgbmFtZSZndDs8L2k+OiBU\naGUgZnVsbCBjbGFzcwogICAgICogbmFtZSBvZiBhIHtAbGluayBSZXZlcnNl\nQ3VzdG9taXplcn0gaW1wbGVtZW50YXRpb24gdG8gdXNlIHRvCiAgICAgKiBj\ndXN0b21pemUgdGhlIHJldmVyc2UgbWFwcGluZyBwcm9jZXNzLiBPcHRpb25h\nbC48L2xpPgogICAgICogPGxpPjxpPi1jdXN0b21pemVyUHJvcGVydGllcy8t\nY3AgJmx0O3Byb3BlcnRpZXMgZmlsZSBvciByZXNvdXJjZSZndDs8L2k+CiAg\nICAgKiA6IFRoZSBwYXRoIG9yIHJlc291cmNlIG5hbWUgb2YgYSBwcm9wZXJ0\naWVzIGZpbGUgdGhhdCB3aWxsIGJlCiAgICAgKiBwYXNzZWQgdG8gdGhlIHJl\ndmVyc2UgY3VzdG9taXplciBvbiBpbml0aWFsaXphdGlvbi4gT3B0aW9uYWwu\nPC9saT4KICAgICAqIDxsaT48aT4tY3VzdG9taXplci8tYy4mbHQ7cHJvcGVy\ndHkgbmFtZSZndDsgJmx0OyBwcm9wZXJ0eSB2YWx1ZSZndDs8L2k+CiAgICAg\nKiA6IEFyZ3VtZW50cyBsaWtlIHRoaXMgd2lsbCBiZSB1c2VkIHRvIGNvbmZp\nZ3VyZSB0aGUgYmVhbgogICAgICogcHJvcGVydGllcyBvZiB0aGUge0BsaW5r\nIFJldmVyc2VDdXN0b21pemVyfS48L2xpPgogICAgICogPGxpPjxpPi1jb2Rl\nRm9ybWF0Ly1jZi4mbHQ7cHJvcGVydHkgbmFtZSZndDsgJmx0OyBwcm9wZXJ0\neSB2YWx1ZSZndDs8L2k+CiAgICAgKiA6IEFyZ3VtZW50cyBsaWtlIHRoaXMg\nd2lsbCBiZSB1c2VkIHRvIGNvbmZpZ3VyZSB0aGUgYmVhbgogICAgICogcHJv\ncGVydGllcyBvZiB0aGUgaW50ZXJuYWwge0BsaW5rIENvZGVGb3JtYXR9Ljwv\nbGk+CiAgICAgKiA8L3VsPgogICAgICogIEVhY2ggc2NoZW1hIGdpdmVuIGFz\nIGFuIGFyZ3VtZW50IHdpbGwgYmUgcmV2ZXJzZS1tYXBwZWQgaW50bwogICAg\nICogcGVyc2lzdGVudCBjbGFzc2VzIGFuZCBhc3NvY2lhdGVkIG1ldGFkYXRh\nLiBJZiBubyBhcmd1bWVudHMgYXJlIGdpdmVuLAogICAgICogdGhlIGRhdGFi\nYXNlIHNjaGVtYXMgZGVmaW5lZCBieSB0aGUgc3lzdGVtIGNvbmZpZ3VyYXRp\nb24gd2lsbCBiZQogICAgICogcmV2ZXJzZS1tYXBwZWQuCiAgICAgKi8KICAg\nIHB1YmxpYyBzdGF0aWMgdm9pZCBtYWluKFN0cmluZ1tdIGFyZ3MpCiAgICAg\nICAgdGhyb3dzIElPRXhjZXB0aW9uLCBTUUxFeGNlcHRpb24gewogICAgICAg\nIE9wdGlvbnMgb3B0cyA9IG5ldyBPcHRpb25zKCk7CiAgICAgICAgZmluYWwg\nU3RyaW5nW10gYXJndW1lbnRzID0gb3B0cy5zZXRGcm9tQ21kTGluZShhcmdz\nKTsKICAgICAgICBib29sZWFuIHJldCA9IENvbmZpZ3VyYXRpb25zLnJ1bkFn\nYWluc3RBbGxBbmNob3JzKG9wdHMsCiAgICAgICAgICAgIG5ldyBDb25maWd1\ncmF0aW9ucy5SdW5uYWJsZSgpIHsKICAgICAgICAgICAgcHVibGljIGJvb2xl\nYW4gcnVuKE9wdGlvbnMgb3B0cykgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAg\nICAgICAgICAgICBKREJDQ29uZmlndXJhdGlvbiBjb25mID0gbmV3IEpEQkND\nb25maWd1cmF0aW9uSW1wbCgpOwogICAgICAgICAgICAgICAgdHJ5IHsKICAg\nICAgICAgICAgICAgICAgICByZXR1cm4gUmV2ZXJzZU1hcHBpbmdUb29sLnJ1\nbihjb25mLCBhcmd1bWVudHMsIG9wdHMpOwogICAgICAgICAgICAgICAgfSBm\naW5hbGx5IHsKICAgICAgICAgICAgICAgICAgICBjb25mLmNsb3NlKCk7CiAg\nICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9KTsKICAg\nICAgICBpZiAoIXJldCkKICAgICAgICAgICAgU3lzdGVtLm91dC5wcmludGxu\nKF9sb2MuZ2V0KCJyZXZ0b29sLXVzYWdlIikpOwogICAgfQoKICAgIC8qKgog\nICAgICogUnVuIHRoZSB0b29sLiBSZXR1cm5zIGZhbHNlIGlmIGludmFsaWQg\nb3B0aW9ucyB3ZXJlIGdpdmVuLgogICAgICoKICAgICAqIEBzZWUgI21haW4K\nICAgICAqLwogICAgcHVibGljIHN0YXRpYyBib29sZWFuIHJ1bihKREJDQ29u\nZmlndXJhdGlvbiBjb25mLCBTdHJpbmdbXSBhcmdzLAogICAgICAgIE9wdGlv\nbnMgb3B0cykKICAgICAgICB0aHJvd3MgSU9FeGNlcHRpb24sIFNRTEV4Y2Vw\ndGlvbiB7CiAgICAgICAgLy8gZmxhZ3MKICAgICAgICBGbGFncyBmbGFncyA9\nIG5ldyBGbGFncygpOwogICAgICAgIGZsYWdzLnBhY2thZ2VOYW1lID0gb3B0\ncy5yZW1vdmVQcm9wZXJ0eQogICAgICAgICAgICAoInBhY2thZ2UiLCAicGtn\nIiwgZmxhZ3MucGFja2FnZU5hbWUpOwogICAgICAgIGZsYWdzLmRpcmVjdG9y\neSA9IEZpbGVzLmdldEZpbGUKICAgICAgICAgICAgKG9wdHMucmVtb3ZlUHJv\ncGVydHkoImRpcmVjdG9yeSIsICJkIiwgbnVsbCksIG51bGwpOwogICAgICAg\nIGZsYWdzLnVzZVNjaGVtYU5hbWUgPSBvcHRzLnJlbW92ZUJvb2xlYW5Qcm9w\nZXJ0eQogICAgICAgICAgICAoInVzZVNjaGVtYU5hbWUiLCAic24iLCBmbGFn\ncy51c2VTY2hlbWFOYW1lKTsKICAgICAgICBmbGFncy51c2VGb3JlaWduS2V5\nTmFtZSA9IG9wdHMucmVtb3ZlQm9vbGVhblByb3BlcnR5CiAgICAgICAgICAg\nICgidXNlRm9yZWlnbktleU5hbWUiLCAiZmtuIiwgZmxhZ3MudXNlRm9yZWln\nbktleU5hbWUpOwogICAgICAgIGZsYWdzLm51bGxhYmxlQXNPYmplY3QgPSBv\ncHRzLnJlbW92ZUJvb2xlYW5Qcm9wZXJ0eQogICAgICAgICAgICAoIm51bGxh\nYmxlQXNPYmplY3QiLCAibm8iLCBmbGFncy5udWxsYWJsZUFzT2JqZWN0KTsK\nICAgICAgICBmbGFncy5ibG9iQXNPYmplY3QgPSBvcHRzLnJlbW92ZUJvb2xl\nYW5Qcm9wZXJ0eQogICAgICAgICAgICAoImJsb2JBc09iamVjdCIsICJibyIs\nIGZsYWdzLmJsb2JBc09iamVjdCk7CiAgICAgICAgZmxhZ3MudXNlR2VuZXJp\nY0NvbGxlY3Rpb25zID0gb3B0cy5yZW1vdmVCb29sZWFuUHJvcGVydHkKICAg\nICAgICAgICAgKCJ1c2VHZW5lcmljQ29sbGVjdGlvbnMiLCAiZ2MiLCBmbGFn\ncy51c2VHZW5lcmljQ29sbGVjdGlvbnMpOwogICAgICAgIGZsYWdzLnByaW1h\ncnlLZXlPbkpvaW4gPSBvcHRzLnJlbW92ZUJvb2xlYW5Qcm9wZXJ0eQogICAg\nICAgICAgICAoInByaW1hcnlLZXlPbkpvaW4iLCAicGtqIiwgZmxhZ3MucHJp\nbWFyeUtleU9uSm9pbik7CiAgICAgICAgZmxhZ3MudXNlRGF0YVN0b3JlSWRl\nbnRpdHkgPSBvcHRzLnJlbW92ZUJvb2xlYW5Qcm9wZXJ0eQogICAgICAgICAg\nICAoInVzZURhdGFzdG9yZUlkZW50aXR5IiwgImRzIiwgZmxhZ3MudXNlRGF0\nYVN0b3JlSWRlbnRpdHkpOwogICAgICAgIGZsYWdzLnVzZUJ1aWx0aW5JZGVu\ndGl0eUNsYXNzID0gb3B0cy5yZW1vdmVCb29sZWFuUHJvcGVydHkKICAgICAg\nICAgICAgKCJ1c2VCdWlsdGluSWRlbnRpdHlDbGFzcyIsICJiaWMiLCBmbGFn\ncy51c2VCdWlsdGluSWRlbnRpdHlDbGFzcyk7CiAgICAgICAgZmxhZ3MuaW5u\nZXJJZGVudGl0eUNsYXNzZXMgPSBvcHRzLnJlbW92ZUJvb2xlYW5Qcm9wZXJ0\neQogICAgICAgICAgICAoImlubmVySWRlbnRpdHlDbGFzc2VzIiwgImlubiIs\nIGZsYWdzLmlubmVySWRlbnRpdHlDbGFzc2VzKTsKICAgICAgICBmbGFncy5p\nZGVudGl0eUNsYXNzU3VmZml4ID0gb3B0cy5yZW1vdmVQcm9wZXJ0eQogICAg\nICAgICAgICAoImlkZW50aXR5Q2xhc3NTdWZmaXgiLCAiaXMiLCBmbGFncy5p\nZGVudGl0eUNsYXNzU3VmZml4KTsKICAgICAgICBmbGFncy5pbnZlcnNlUmVs\nYXRpb25zID0gb3B0cy5yZW1vdmVCb29sZWFuUHJvcGVydHkKICAgICAgICAg\nICAgKCJpbnZlcnNlUmVsYXRpb25zIiwgImlyIiwgZmxhZ3MuaW52ZXJzZVJl\nbGF0aW9ucyk7CiAgICAgICAgZmxhZ3MuZGV0YWNoYWJsZSA9IG9wdHMucmVt\nb3ZlQm9vbGVhblByb3BlcnR5CiAgICAgICAgICAgICgiZGV0YWNoYWJsZSIs\nICJkZXQiLCBmbGFncy5kZXRhY2hhYmxlKTsKICAgICAgICBmbGFncy5kaXNj\ncmltaW5hdG9yU3RyYXRlZ3kgPSBvcHRzLnJlbW92ZVByb3BlcnR5CiAgICAg\nICAgICAgICgiZGlzY3JpbWluYXRvclN0cmF0ZWd5IiwgImRzIiwgZmxhZ3Mu\nZGlzY3JpbWluYXRvclN0cmF0ZWd5KTsKICAgICAgICBmbGFncy52ZXJzaW9u\nU3RyYXRlZ3kgPSBvcHRzLnJlbW92ZVByb3BlcnR5CiAgICAgICAgICAgICgi\ndmVyc2lvblN0cmF0ZWd5IiwgInZzIiwgZmxhZ3MudmVyc2lvblN0cmF0ZWd5\nKTsKICAgICAgICBmbGFncy5tZXRhRGF0YUxldmVsID0gb3B0cy5yZW1vdmVQ\ncm9wZXJ0eQogICAgICAgICAgICAoIm1ldGFkYXRhIiwgIm1kIiwgZmxhZ3Mu\nbWV0YURhdGFMZXZlbCk7ICAgICAgICAKICAgICAgICBmbGFncy5nZW5lcmF0\nZUFubm90YXRpb25zID0gb3B0cy5yZW1vdmVCb29sZWFuUHJvcGVydHkKICAg\nICAgICAgICAgKCJhbm5vdGF0aW9ucyIsICJhbm4iLCBmbGFncy5nZW5lcmF0\nZUFubm90YXRpb25zKTsKICAgICAgICBmbGFncy5hY2Nlc3NUeXBlID0gb3B0\ncy5yZW1vdmVQcm9wZXJ0eQogICAgICAgICAgICAoImFjY2Vzc1R5cGUiLCAi\nYWNjZXNzIiwgZmxhZ3MuYWNjZXNzVHlwZSk7CgogICAgICAgIFN0cmluZyB0\neXBlTWFwID0gb3B0cy5yZW1vdmVQcm9wZXJ0eSgidHlwZU1hcCIsICJ0eXAi\nLCBudWxsKTsKICAgICAgICBpZiAodHlwZU1hcCAhPSBudWxsKQogICAgICAg\nICAgICBmbGFncy50eXBlTWFwID0gQ29uZmlndXJhdGlvbnMucGFyc2VQcm9w\nZXJ0aWVzKHR5cGVNYXApOwoKICAgICAgICAvLyByZW1hcCB0aGUgLXMgc2hv\ncnRjdXQgdG8gdGhlICJzY2hlbWFzIiBwcm9wZXJ0eSBuYW1lIHNvIHRoYXQg\naXQKICAgICAgICAvLyBnZXRzIHNldCBpbnRvIHRoZSBjb25maWd1cmF0aW9u\nCiAgICAgICAgaWYgKG9wdHMuY29udGFpbnNLZXkoInMiKSkKICAgICAgICAg\nICAgb3B0cy5wdXQoInNjaGVtYXMiLCBvcHRzLmdldCgicyIpKTsKCiAgICAg\nICAgLy8gY3VzdG9taXplcgogICAgICAgIFN0cmluZyBjdXN0b21DbHMgPSBv\ncHRzLnJlbW92ZVByb3BlcnR5KCJjdXN0b21pemVyQ2xhc3MiLCAiY2MiLAog\nICAgICAgICAgICBQcm9wZXJ0aWVzUmV2ZXJzZUN1c3RvbWl6ZXIuY2xhc3Mu\nZ2V0TmFtZSgpKTsKICAgICAgICBGaWxlIGN1c3RvbUZpbGUgPSBGaWxlcy5n\nZXRGaWxlCiAgICAgICAgICAgIChvcHRzLnJlbW92ZVByb3BlcnR5KCJjdXN0\nb21pemVyUHJvcGVydGllcyIsICJjcCIsIG51bGwpLCBudWxsKTsKICAgICAg\nICBQcm9wZXJ0aWVzIGN1c3RvbVByb3BzID0gbmV3IFByb3BlcnRpZXMoKTsK\nICAgICAgICBpZiAoY3VzdG9tRmlsZSAhPSBudWxsICYmIChBY2Nlc3NDb250\ncm9sbGVyLmRvUHJpdmlsZWdlZCgKICAgICAgICAgICAgSjJEb1ByaXZIZWxw\nZXIuZXhpc3RzQWN0aW9uKGN1c3RvbUZpbGUpKSkuYm9vbGVhblZhbHVlKCkp\nIHsKICAgICAgICAgICAgRmlsZUlucHV0U3RyZWFtIGZpcyA9IG51bGw7CiAg\nICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBmaXMgPSBBY2Nlc3ND\nb250cm9sbGVyLmRvUHJpdmlsZWdlZCgKICAgICAgICAgICAgICAgICAgICBK\nMkRvUHJpdkhlbHBlci5uZXdGaWxlSW5wdXRTdHJlYW1BY3Rpb24oY3VzdG9t\nRmlsZSkpOwogICAgICAgICAgICB9IGNhdGNoIChQcml2aWxlZ2VkQWN0aW9u\nRXhjZXB0aW9uIHBhZSkgewogICAgICAgICAgICAgICAgIHRocm93IChGaWxl\nTm90Rm91bmRFeGNlcHRpb24pIHBhZS5nZXRFeGNlcHRpb24oKTsKICAgICAg\nICAgICAgfQogICAgICAgICAgICBjdXN0b21Qcm9wcy5sb2FkKGZpcyk7CiAg\nICAgICAgfQogICAgICAgIAogICAgICAgIC8vIHNlcGFyYXRlIHRoZSBwcm9w\nZXJ0aWVzIGZvciB0aGUgY3VzdG9taXplciBhbmQgY29kZSBmb3JtYXQKICAg\nICAgICBPcHRpb25zIGN1c3RvbU9wdHMgPSBuZXcgT3B0aW9ucygpOwogICAg\nICAgIE9wdGlvbnMgZm9ybWF0T3B0cyA9IG5ldyBPcHRpb25zKCk7CiAgICAg\nICAgTWFwLkVudHJ5IGVudHJ5OwogICAgICAgIFN0cmluZyBrZXk7CiAgICAg\nICAgZm9yIChJdGVyYXRvciBpdHIgPSBvcHRzLmVudHJ5U2V0KCkuaXRlcmF0\nb3IoKTsgaXRyLmhhc05leHQoKTspIHsKICAgICAgICAgICAgZW50cnkgPSAo\nTWFwLkVudHJ5KSBpdHIubmV4dCgpOwogICAgICAgICAgICBrZXkgPSAoU3Ry\naW5nKSBlbnRyeS5nZXRLZXkoKTsKICAgICAgICAgICAgaWYgKGtleS5zdGFy\ndHNXaXRoKCJjdXN0b21pemVyLiIpKSB7CiAgICAgICAgICAgICAgICBjdXN0\nb21PcHRzLnB1dChrZXkuc3Vic3RyaW5nKDExKSwgZW50cnkuZ2V0VmFsdWUo\nKSk7CiAgICAgICAgICAgICAgICBpdHIucmVtb3ZlKCk7CiAgICAgICAgICAg\nIH0gZWxzZSBpZiAoa2V5LnN0YXJ0c1dpdGgoImMuIikpIHsKICAgICAgICAg\nICAgICAgIGN1c3RvbU9wdHMucHV0KGtleS5zdWJzdHJpbmcoMiksIGVudHJ5\nLmdldFZhbHVlKCkpOwogICAgICAgICAgICAgICAgaXRyLnJlbW92ZSgpOwog\nICAgICAgICAgICB9IGVsc2UgaWYgKGtleS5zdGFydHNXaXRoKCJjb2RlRm9y\nbWF0LiIpKSB7CiAgICAgICAgICAgICAgICBmb3JtYXRPcHRzLnB1dChrZXku\nc3Vic3RyaW5nKDExKSwgZW50cnkuZ2V0VmFsdWUoKSk7CiAgICAgICAgICAg\nICAgICBpdHIucmVtb3ZlKCk7CiAgICAgICAgICAgIH0gZWxzZSBpZiAoa2V5\nLnN0YXJ0c1dpdGgoImNmLiIpKSB7CiAgICAgICAgICAgICAgICBmb3JtYXRP\ncHRzLnB1dChrZXkuc3Vic3RyaW5nKDMpLCBlbnRyeS5nZXRWYWx1ZSgpKTsK\nICAgICAgICAgICAgICAgIGl0ci5yZW1vdmUoKTsKICAgICAgICAgICAgfQog\nICAgICAgIH0KCiAgICAgICAgLy8gY29kZSBmb3JtYXQKICAgICAgICBpZiAo\nIWZvcm1hdE9wdHMuaXNFbXB0eSgpKSB7CiAgICAgICAgICAgIGZsYWdzLmZv\ncm1hdCA9IG5ldyBDb2RlRm9ybWF0KCk7CiAgICAgICAgICAgIGZvcm1hdE9w\ndHMuc2V0SW50byhmbGFncy5mb3JtYXQpOwogICAgICAgIH0KCiAgICAgICAg\nLy8gc2V0dXAgYSBjb25maWd1cmF0aW9uIGluc3RhbmNlIHdpdGggY21kLWxp\nbmUgaW5mbwogICAgICAgIENvbmZpZ3VyYXRpb25zLnBvcHVsYXRlQ29uZmln\ndXJhdGlvbihjb25mLCBvcHRzKTsKICAgICAgICBDbGFzc0xvYWRlciBsb2Fk\nZXIgPSBjb25mLmdldENsYXNzUmVzb2x2ZXJJbnN0YW5jZSgpLgogICAgICAg\nICAgICBnZXRDbGFzc0xvYWRlcihSZXZlcnNlTWFwcGluZ1Rvb2wuY2xhc3Ms\nIG51bGwpOwoKICAgICAgICAvLyBjdXN0b21pemVyCiAgICAgICAgZmxhZ3Mu\nY3VzdG9taXplciA9IChSZXZlcnNlQ3VzdG9taXplcikgQ29uZmlndXJhdGlv\nbnMuCiAgICAgICAgICAgIG5ld0luc3RhbmNlKGN1c3RvbUNscywgbG9hZGVy\nKTsKICAgICAgICBpZiAoZmxhZ3MuY3VzdG9taXplciAhPSBudWxsKSB7CiAg\nICAgICAgICAgIENvbmZpZ3VyYXRpb25zLmNvbmZpZ3VyZUluc3RhbmNlKGZs\nYWdzLmN1c3RvbWl6ZXIsIGNvbmYsCiAgICAgICAgICAgICAgICBjdXN0b21P\ncHRzKTsKICAgICAgICAgICAgZmxhZ3MuY3VzdG9taXplci5zZXRDb25maWd1\ncmF0aW9uKGN1c3RvbVByb3BzKTsKICAgICAgICB9CgogICAgICAgIHJ1bihj\nb25mLCBhcmdzLCBmbGFncywgbG9hZGVyKTsKICAgICAgICByZXR1cm4gdHJ1\nZTsKICAgIH0KCiAgICAvKioKICAgICAqIFJ1biB0aGUgdG9vbC4KICAgICAq\nLwogICAgcHVibGljIHN0YXRpYyB2b2lkIHJ1bihKREJDQ29uZmlndXJhdGlv\nbiBjb25mLCBTdHJpbmdbXSBhcmdzLAogICAgICAgIEZsYWdzIGZsYWdzLCBD\nbGFzc0xvYWRlciBsb2FkZXIpCiAgICAgICAgdGhyb3dzIElPRXhjZXB0aW9u\nLCBTUUxFeGNlcHRpb24gewogICAgICAgIC8vIHBhcnNlIHRoZSBzY2hlbWEg\ndG8gcmV2ZXJzZS1tYXAKICAgICAgICBMb2cgbG9nID0gY29uZi5nZXRMb2co\nT3BlbkpQQUNvbmZpZ3VyYXRpb24uTE9HX1RPT0wpOwogICAgICAgIFNjaGVt\nYUdyb3VwIHNjaGVtYTsKICAgICAgICBpZiAoYXJncy5sZW5ndGggPT0gMCkg\newogICAgICAgICAgICBsb2cuaW5mbyhfbG9jLmdldCgicmV2dG9vbC1ydW5u\naW5nIikpOwogICAgICAgICAgICBTY2hlbWFHZW5lcmF0b3IgZ2VuID0gbmV3\nIFNjaGVtYUdlbmVyYXRvcihjb25mKTsKICAgICAgICAgICAgZ2VuLmdlbmVy\nYXRlU2NoZW1hcygpOwogICAgICAgICAgICBzY2hlbWEgPSBnZW4uZ2V0U2No\nZW1hR3JvdXAoKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBTY2hl\nbWFQYXJzZXIgcGFyc2VyID0gbmV3IFhNTFNjaGVtYVBhcnNlcihjb25mKTsK\nICAgICAgICAgICAgRmlsZSBmaWxlOwogICAgICAgICAgICBmb3IgKGludCBp\nID0gMDsgaSA8IGFyZ3MubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICAg\nIGZpbGUgPSBGaWxlcy5nZXRGaWxlKGFyZ3NbaV0sIGxvYWRlcik7CiAgICAg\nICAgICAgICAgICBsb2cuaW5mbyhfbG9jLmdldCgicmV2dG9vbC1ydW5uaW5n\nLWZpbGUiLCBmaWxlKSk7CiAgICAgICAgICAgICAgICBwYXJzZXIucGFyc2Uo\nZmlsZSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgc2NoZW1hID0gcGFy\nc2VyLmdldFNjaGVtYUdyb3VwKCk7CiAgICAgICAgfQoKICAgICAgICAvLyBm\nbGFncwogICAgICAgIFJldmVyc2VNYXBwaW5nVG9vbCB0b29sID0gbmV3IFJl\ndmVyc2VNYXBwaW5nVG9vbChjb25mKTsKICAgICAgICB0b29sLnNldFNjaGVt\nYUdyb3VwKHNjaGVtYSk7CiAgICAgICAgdG9vbC5zZXRQYWNrYWdlTmFtZShm\nbGFncy5wYWNrYWdlTmFtZSk7CiAgICAgICAgdG9vbC5zZXREaXJlY3Rvcnko\nZmxhZ3MuZGlyZWN0b3J5KTsKICAgICAgICB0b29sLnNldFVzZVNjaGVtYU5h\nbWUoZmxhZ3MudXNlU2NoZW1hTmFtZSk7CiAgICAgICAgdG9vbC5zZXRVc2VG\nb3JlaWduS2V5TmFtZShmbGFncy51c2VGb3JlaWduS2V5TmFtZSk7CiAgICAg\nICAgdG9vbC5zZXROdWxsYWJsZUFzT2JqZWN0KGZsYWdzLm51bGxhYmxlQXNP\nYmplY3QpOwogICAgICAgIHRvb2wuc2V0QmxvYkFzT2JqZWN0KGZsYWdzLmJs\nb2JBc09iamVjdCk7CiAgICAgICAgdG9vbC5zZXRVc2VHZW5lcmljQ29sbGVj\ndGlvbnMoZmxhZ3MudXNlR2VuZXJpY0NvbGxlY3Rpb25zKTsKICAgICAgICB0\nb29sLnNldFR5cGVNYXAoZmxhZ3MudHlwZU1hcCk7CiAgICAgICAgdG9vbC5z\nZXRQcmltYXJ5S2V5T25Kb2luKGZsYWdzLnByaW1hcnlLZXlPbkpvaW4pOwog\nICAgICAgIHRvb2wuc2V0VXNlRGF0YVN0b3JlSWRlbnRpdHkoZmxhZ3MudXNl\nRGF0YVN0b3JlSWRlbnRpdHkpOwogICAgICAgIHRvb2wuc2V0VXNlQnVpbHRp\nbklkZW50aXR5Q2xhc3MoZmxhZ3MudXNlQnVpbHRpbklkZW50aXR5Q2xhc3Mp\nOwogICAgICAgIHRvb2wuc2V0SW5uZXJJZGVudGl0eUNsYXNzZXMoZmxhZ3Mu\naW5uZXJJZGVudGl0eUNsYXNzZXMpOwogICAgICAgIHRvb2wuc2V0SWRlbnRp\ndHlDbGFzc1N1ZmZpeChmbGFncy5pZGVudGl0eUNsYXNzU3VmZml4KTsKICAg\nICAgICB0b29sLnNldEludmVyc2VSZWxhdGlvbnMoZmxhZ3MuaW52ZXJzZVJl\nbGF0aW9ucyk7CiAgICAgICAgdG9vbC5zZXREZXRhY2hhYmxlKGZsYWdzLmRl\ndGFjaGFibGUpOwogICAgICAgIHRvb2wuc2V0R2VuZXJhdGVBbm5vdGF0aW9u\ncyhmbGFncy5nZW5lcmF0ZUFubm90YXRpb25zKTsKICAgICAgICB0b29sLnNl\ndEFjY2Vzc1R5cGUoZmxhZ3MuYWNjZXNzVHlwZSk7CiAgICAgICAgdG9vbC5z\nZXRDdXN0b21pemVyKGZsYWdzLmN1c3RvbWl6ZXIpOwogICAgICAgIHRvb2wu\nc2V0Q29kZUZvcm1hdChmbGFncy5mb3JtYXQpOwoKICAgICAgICAvLyBydW4K\nICAgICAgICBsb2cuaW5mbyhfbG9jLmdldCgicmV2dG9vbC1tYXAiKSk7CiAg\nICAgICAgdG9vbC5ydW4oKTsKICAgICAgICBpZiAoZmxhZ3MuZ2VuZXJhdGVB\nbm5vdGF0aW9ucykgewogICAgICAgICAgICBsb2cuaW5mbyhfbG9jLmdldCgi\ncmV2dG9vbC1nZW4tYW5ub3MiKSk7CiAgICAgICAgICAgIHRvb2wuYnVpbGRB\nbm5vdGF0aW9ucygpOwogICAgICAgIH0KICAgICAgICBsb2cuaW5mbyhfbG9j\nLmdldCgicmV2dG9vbC13cml0ZS1jb2RlIikpOwogICAgICAgIHRvb2wucmVj\nb3JkQ29kZSgpOwogICAgICAgIGlmICghTEVWRUxfTk9ORS5lcXVhbHMoZmxh\nZ3MubWV0YURhdGFMZXZlbCkpIHsKICAgICAgICAgICAgbG9nLmluZm8oX2xv\nYy5nZXQoInJldnRvb2wtd3JpdGUtbWV0YWRhdGEiKSk7CiAgICAgICAgICAg\nIHRvb2wucmVjb3JkTWV0YURhdGEoTEVWRUxfQ0xBU1MuZXF1YWxzKGZsYWdz\nLm1ldGFEYXRhTGV2ZWwpKTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAg\nICAgKiBIb2xkZXIgZm9yIHJ1biBmbGFncy4KICAgICAqLwogICAgcHVibGlj\nIHN0YXRpYyBjbGFzcyBGbGFncyB7CgogICAgICAgIHB1YmxpYyBTdHJpbmcg\ncGFja2FnZU5hbWUgPSBudWxsOwogICAgICAgIHB1YmxpYyBGaWxlIGRpcmVj\ndG9yeSA9IG51bGw7CiAgICAgICAgcHVibGljIGJvb2xlYW4gdXNlU2NoZW1h\nTmFtZSA9IGZhbHNlOwogICAgICAgIHB1YmxpYyBib29sZWFuIHVzZUZvcmVp\nZ25LZXlOYW1lID0gZmFsc2U7CiAgICAgICAgcHVibGljIGJvb2xlYW4gbnVs\nbGFibGVBc09iamVjdCA9IGZhbHNlOwogICAgICAgIHB1YmxpYyBib29sZWFu\nIGJsb2JBc09iamVjdCA9IGZhbHNlOwogICAgICAgIHB1YmxpYyBib29sZWFu\nIHVzZUdlbmVyaWNDb2xsZWN0aW9ucyA9IGZhbHNlOwogICAgICAgIHB1Ymxp\nYyBQcm9wZXJ0aWVzIHR5cGVNYXAgPSBudWxsOwogICAgICAgIHB1YmxpYyBi\nb29sZWFuIHByaW1hcnlLZXlPbkpvaW4gPSBmYWxzZTsKICAgICAgICBwdWJs\naWMgYm9vbGVhbiB1c2VEYXRhU3RvcmVJZGVudGl0eSA9IGZhbHNlOwogICAg\nICAgIHB1YmxpYyBib29sZWFuIHVzZUJ1aWx0aW5JZGVudGl0eUNsYXNzID0g\ndHJ1ZTsKICAgICAgICBwdWJsaWMgYm9vbGVhbiBpbm5lcklkZW50aXR5Q2xh\nc3NlcyA9IGZhbHNlOwogICAgICAgIHB1YmxpYyBTdHJpbmcgaWRlbnRpdHlD\nbGFzc1N1ZmZpeCA9ICJJZCI7CiAgICAgICAgcHVibGljIGJvb2xlYW4gaW52\nZXJzZVJlbGF0aW9ucyA9IHRydWU7CiAgICAgICAgcHVibGljIGJvb2xlYW4g\nZGV0YWNoYWJsZSA9IGZhbHNlOwogICAgICAgIHB1YmxpYyBib29sZWFuIGdl\nbmVyYXRlQW5ub3RhdGlvbnMgPSBmYWxzZTsKICAgICAgICBwdWJsaWMgU3Ry\naW5nIGFjY2Vzc1R5cGUgPSBBQ0NFU1NfVFlQRV9GSUVMRDsKICAgICAgICBw\ndWJsaWMgU3RyaW5nIG1ldGFEYXRhTGV2ZWwgPSBMRVZFTF9QQUNLQUdFOwog\nICAgICAgIHB1YmxpYyBTdHJpbmcgZGlzY3JpbWluYXRvclN0cmF0ZWd5ID0g\nbnVsbDsKICAgICAgICBwdWJsaWMgU3RyaW5nIHZlcnNpb25TdHJhdGVneSA9\nIG51bGw7CiAgICAgICAgcHVibGljIFJldmVyc2VDdXN0b21pemVyIGN1c3Rv\nbWl6ZXIgPSBudWxsOwogICAgICAgIHB1YmxpYyBDb2RlRm9ybWF0IGZvcm1h\ndCA9IG51bGw7CiAgICB9CgogICAgLyoqCiAgICAgKiBVc2VkIHRvIGluc3Rh\nbGwgZGlzY3JpbWluYXRvciBhbmQgdmVyc2lvbiBzdHJhdGVnaWVzIG9uCiAg\nICAgKiByZXZlcnNlLW1hcHBlZCBjbGFzc2VzLgogICAgICovCiAgICBwcml2\nYXRlIGNsYXNzIFJldmVyc2VTdHJhdGVneUluc3RhbGxlcgogICAgICAgIGV4\ndGVuZHMgU3RyYXRlZ3lJbnN0YWxsZXIgewoKICAgICAgICBwdWJsaWMgUmV2\nZXJzZVN0cmF0ZWd5SW5zdGFsbGVyKE1hcHBpbmdSZXBvc2l0b3J5IHJlcG9z\nKSB7CiAgICAgICAgICAgIHN1cGVyKHJlcG9zKTsKICAgICAgICB9CgogICAg\nICAgIHB1YmxpYyB2b2lkIGluc3RhbGxTdHJhdGVneShDbGFzc01hcHBpbmcg\nY2xzKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBJbnRlcm5hbEV4Y2VwdGlv\nbigpOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIHZvaWQgaW5zdGFsbFN0\ncmF0ZWd5KEZpZWxkTWFwcGluZyBmaWVsZCkgewogICAgICAgICAgICB0aHJv\ndyBuZXcgSW50ZXJuYWxFeGNlcHRpb24oKTsKICAgICAgICB9CgogICAgICAg\nIHB1YmxpYyB2b2lkIGluc3RhbGxTdHJhdGVneShWZXJzaW9uIHZlcnNpb24p\nIHsKICAgICAgICAgICAgQ2xhc3NNYXBwaW5nIGNscyA9IHZlcnNpb24uZ2V0\nQ2xhc3NNYXBwaW5nKCk7CiAgICAgICAgICAgIGlmIChjbHMuZ2V0UENTdXBl\ncmNsYXNzKCkgIT0gbnVsbCkKICAgICAgICAgICAgICAgIHZlcnNpb24uc2V0\nU3RyYXRlZ3kobmV3IFN1cGVyY2xhc3NWZXJzaW9uU3RyYXRlZ3koKSwgbnVs\nbCk7CiAgICAgICAgICAgIGVsc2UgaWYgKF92ZXJzU3RyYXQgIT0gbnVsbCkg\newogICAgICAgICAgICAgICAgVmVyc2lvblN0cmF0ZWd5IHN0cmF0ID0gcmVw\nb3MuaW5zdGFudGlhdGVWZXJzaW9uU3RyYXRlZ3kKICAgICAgICAgICAgICAg\nICAgICAoX3ZlcnNTdHJhdCwgdmVyc2lvbik7CiAgICAgICAgICAgICAgICB2\nZXJzaW9uLnNldFN0cmF0ZWd5KHN0cmF0LCBudWxsKTsKICAgICAgICAgICAg\nfSBlbHNlCiAgICAgICAgICAgICAgICB2ZXJzaW9uLnNldFN0cmF0ZWd5KG5l\ndyBTdGF0ZUNvbXBhcmlzb25WZXJzaW9uU3RyYXRlZ3koKSwKICAgICAgICAg\nICAgICAgICAgICBudWxsKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyB2\nb2lkIGluc3RhbGxTdHJhdGVneShEaXNjcmltaW5hdG9yIGRpc2NyaW0pIHsK\nICAgICAgICAgICAgQ2xhc3NNYXBwaW5nIGNscyA9IGRpc2NyaW0uZ2V0Q2xh\nc3NNYXBwaW5nKCk7CiAgICAgICAgICAgIGlmIChjbHMuZ2V0UENTdXBlcmNs\nYXNzKCkgIT0gbnVsbCkgewogICAgICAgICAgICAgICAgZGlzY3JpbS5zZXRT\ndHJhdGVneShuZXcgU3VwZXJjbGFzc0Rpc2NyaW1pbmF0b3JTdHJhdGVneSgp\nLAogICAgICAgICAgICAgICAgICAgIG51bGwpOwogICAgICAgICAgICB9IGVs\nc2UgaWYgKCFoYXNTdWJjbGFzc2VzKGNscykpIHsKICAgICAgICAgICAgICAg\nIGRpc2NyaW0uc2V0U3RyYXRlZ3koTm9uZURpc2NyaW1pbmF0b3JTdHJhdGVn\neS5nZXRJbnN0YW5jZSgpLAogICAgICAgICAgICAgICAgICAgIG51bGwpOwog\nICAgICAgICAgICB9IGVsc2UgaWYgKF9kaXNjU3RyYXQgIT0gbnVsbCkgewog\nICAgICAgICAgICAgICAgRGlzY3JpbWluYXRvclN0cmF0ZWd5IHN0cmF0ID0g\ncmVwb3MuCiAgICAgICAgICAgICAgICAgICAgaW5zdGFudGlhdGVEaXNjcmlt\naW5hdG9yU3RyYXRlZ3koX2Rpc2NTdHJhdCwgZGlzY3JpbSk7CiAgICAgICAg\nICAgICAgICBkaXNjcmltLnNldFN0cmF0ZWd5KHN0cmF0LCBudWxsKTsKICAg\nICAgICAgICAgfSBlbHNlCiAgICAgICAgICAgICAgICBkaXNjcmltLnNldFN0\ncmF0ZWd5KG5ldyBTdWJjbGFzc0pvaW5EaXNjcmltaW5hdG9yU3RyYXRlZ3ko\nKSwKICAgICAgICAgICAgICAgICAgICBudWxsKTsKICAgICAgICB9CgogICAg\nICAgIC8qKgogICAgICAgICAqIFJldHVybiB3aGV0aGVyIHRoZSBnaXZlbiBj\nbGFzcyBoYXMgYW55IG1hcHBlZCBwZXJzaXN0ZW50IHN1YmNsYXNzZXMuCiAg\nICAgICAgICovCiAgICAgICAgcHJpdmF0ZSBib29sZWFuIGhhc1N1YmNsYXNz\nZXMoQ2xhc3NNYXBwaW5nIGNscykgewogICAgICAgICAgICBDbGFzc01ldGFE\nYXRhW10gbWV0YXMgPSByZXBvcy5nZXRNZXRhRGF0YXMoKTsKICAgICAgICAg\nICAgZm9yIChpbnQgaSA9IDA7IGkgPCBtZXRhcy5sZW5ndGg7IGkrKykKICAg\nICAgICAgICAgICAgIGlmIChtZXRhc1tpXS5nZXRQQ1N1cGVyY2xhc3MoKSA9\nPSBjbHMuZ2V0RGVzY3JpYmVkVHlwZSgpKQogICAgICAgICAgICAgICAgICAg\nIHJldHVybiB0cnVlOwogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAg\nICAgfQogICAgfQoKICAgIC8qKgogICAgICogRXh0ZW5zaW9uIG9mIHRoZSB7\nQGxpbmsgQ29kZUdlbmVyYXRvcn0gdG8gYWxsb3cgdXNlcnMgdG8gY3VzdG9t\naXplCiAgICAgKiB0aGUgZm9ybWF0dGluZyBvZiB0aGVpciBnZW5lcmF0ZWQg\nY2xhc3Nlcy4KICAgICAqLwogICAgcHJpdmF0ZSBjbGFzcyBSZXZlcnNlQ29k\nZUdlbmVyYXRvcgogICAgICAgIGV4dGVuZHMgQ29kZUdlbmVyYXRvciB7Cgog\nICAgICAgIHByb3RlY3RlZCBmaW5hbCBDbGFzc01hcHBpbmcgX21hcHBpbmc7\nCiAgICAgICAgcHJvdGVjdGVkIGZpbmFsIEFwcGxpY2F0aW9uSWRUb29sIF9h\ncHBpZDsKCiAgICAgICAgcHVibGljIFJldmVyc2VDb2RlR2VuZXJhdG9yKENs\nYXNzTWFwcGluZyBtYXBwaW5nLAogICAgICAgICAgICBBcHBsaWNhdGlvbklk\nVG9vbCBhaWQpIHsKICAgICAgICAgICAgc3VwZXIobWFwcGluZyk7CiAgICAg\nICAgICAgIHN1cGVyLnNldERpcmVjdG9yeShfZGlyKTsKICAgICAgICAgICAg\nc3VwZXIuc2V0Q29kZUZvcm1hdChfZm9ybWF0KTsKCiAgICAgICAgICAgIF9t\nYXBwaW5nID0gbWFwcGluZzsKICAgICAgICAgICAgaWYgKGFpZCAhPSBudWxs\nICYmIGFpZC5pc0lubmVyQ2xhc3MoKSkKICAgICAgICAgICAgICAgIF9hcHBp\nZCA9IGFpZDsKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgX2Fw\ncGlkID0gbnVsbDsKICAgICAgICB9CgogICAgICAgIC8qKgogICAgICAgICAq\nIElmIHRoZXJlIGlzIGFuIGlubmVyIGFwcGxpY2F0aW9uIGlkZW50aXR5IGNs\nYXNzLCB0aGVuCiAgICAgICAgICogYWRkIGl0IHRvIHRoZSBib3R0b20gb2Yg\ndGhlIGNsYXNzIGNvZGUuCiAgICAgICAgICovCiAgICAgICAgcHJvdGVjdGVk\nIHZvaWQgY2xvc2VDbGFzc0JyYWNlKENvZGVGb3JtYXQgY29kZSkgewogICAg\nICAgICAgICBpZiAoX2FwcGlkICE9IG51bGwpIHsKICAgICAgICAgICAgICAg\nIGNvZGUuYWZ0ZXJTZWN0aW9uKCk7CiAgICAgICAgICAgICAgICBjb2RlLmFw\ncGVuZChfYXBwaWQuZ2V0Q29kZSgpKTsKICAgICAgICAgICAgICAgIGNvZGUu\nZW5kbCgpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBzdXBlci5jbG9z\nZUNsYXNzQnJhY2UoY29kZSk7CiAgICAgICAgfQoKICAgICAgICAvKioKICAg\nICAgICAgKiBBZGQgdGhlIGxpc3Qgb2YgaW1wb3J0cyBmb3IgYW55IGlubmVy\nIGFwcCBpZCBjbGFzc2VzCiAgICAgICAgICoKICAgICAgICAgKiBAcmV0dXJu\nCiAgICAgICAgICovCiAgICAgICAgcHVibGljIFNldCBnZXRJbXBvcnRQYWNr\nYWdlcygpIHsKICAgICAgICAgICAgU2V0IHBrZ3MgPSBzdXBlci5nZXRJbXBv\ncnRQYWNrYWdlcygpOwogICAgICAgICAgICBpZiAoX2FwcGlkICE9IG51bGwp\nCiAgICAgICAgICAgICAgICBwa2dzLmFkZEFsbChfYXBwaWQuZ2V0SW1wb3J0\nUGFja2FnZXMoKSk7CiAgICAgICAgICAgIHJldHVybiBwa2dzOwogICAgICAg\nIH0KCiAgICAgICAgcHJvdGVjdGVkIFN0cmluZyBnZXRDbGFzc0NvZGUoKSB7\nCiAgICAgICAgICAgIHJldHVybiAoX2N1c3RvbSA9PSBudWxsKSA/IG51bGwg\nOiBfY3VzdG9tLmdldENsYXNzQ29kZShfbWFwcGluZyk7CiAgICAgICAgfQoK\nICAgICAgICBwcm90ZWN0ZWQgU3RyaW5nIGdldEluaXRpYWxWYWx1ZShGaWVs\nZE1ldGFEYXRhIGZpZWxkKSB7CiAgICAgICAgICAgIGlmIChfY3VzdG9tID09\nIG51bGwpCiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICAg\nICAgcmV0dXJuIF9jdXN0b20uZ2V0SW5pdGlhbFZhbHVlKChGaWVsZE1hcHBp\nbmcpIGZpZWxkKTsKICAgICAgICB9CgogICAgICAgIHByb3RlY3RlZCBTdHJp\nbmcgZ2V0RGVjbGFyYXRpb24oRmllbGRNZXRhRGF0YSBmaWVsZCkgewogICAg\nICAgICAgICBpZiAoX2N1c3RvbSA9PSBudWxsKQogICAgICAgICAgICAgICAg\ncmV0dXJuIG51bGw7CiAgICAgICAgICAgIHJldHVybiBfY3VzdG9tLmdldERl\nY2xhcmF0aW9uKChGaWVsZE1hcHBpbmcpIGZpZWxkKTsKICAgICAgICB9Cgog\nICAgICAgIHByb3RlY3RlZCBTdHJpbmcgZ2V0RmllbGRDb2RlKEZpZWxkTWV0\nYURhdGEgZmllbGQpIHsKICAgICAgICAgICAgaWYgKF9jdXN0b20gPT0gbnVs\nbCkKICAgICAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgICAgICBy\nZXR1cm4gX2N1c3RvbS5nZXRGaWVsZENvZGUoKEZpZWxkTWFwcGluZykgZmll\nbGQpOwogICAgICAgIH0KCiAgICAgICAgcHJvdGVjdGVkIGJvb2xlYW4gdXNl\nR2VuZXJpY0NvbGxlY3Rpb25zKCkgewogICAgICAgICAgICByZXR1cm4gX3Vz\nZUdlbmVyaWNDb2xsOwogICAgICAgIH0KICAgIH0KCiAgICBwcml2YXRlIGNs\nYXNzIEFubm90YXRlZENvZGVHZW5lcmF0b3IKICAgICAgICBleHRlbmRzIFJl\ndmVyc2VDb2RlR2VuZXJhdG9yIHsKCiAgICAgICAgcHVibGljIEFubm90YXRl\nZENvZGVHZW5lcmF0b3IgKENsYXNzTWFwcGluZyBtYXBwaW5nLAogICAgICAg\nICAgICBBcHBsaWNhdGlvbklkVG9vbCBhaWQpIHsKICAgICAgICAgICAgc3Vw\nZXIgKG1hcHBpbmcsIGFpZCk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMg\nU2V0IGdldEltcG9ydFBhY2thZ2VzKCkgewogICAgICAgICAgICBTZXQgcGtn\ncyA9IHN1cGVyLmdldEltcG9ydFBhY2thZ2VzKCk7CiAgICAgICAgICAgIHBr\nZ3MuYWRkKCJqYXZheC5wZXJzaXN0ZW5jZSIpOwogICAgICAgICAgICByZXR1\ncm4gcGtnczsKICAgICAgICB9CgogICAgICAgIHByb3RlY3RlZCBMaXN0IGdl\ndENsYXNzQW5ub3RhdGlvbnMoKSB7CiAgICAgICAgICAgIHJldHVybiBnZXRB\nbm5vdGF0aW9uc0Zvck1ldGEoX21hcHBpbmcpOwogICAgICAgIH0KCiAgICAg\nICAgcHJvdGVjdGVkIExpc3QgZ2V0RmllbGRBbm5vdGF0aW9ucyhGaWVsZE1l\ndGFEYXRhIGZpZWxkKSB7CiAgICAgICAgICAgIHJldHVybiBnZXRBbm5vdGF0\naW9uc0Zvck1ldGEoZmllbGQpOwogICAgICAgIH0KCiAgICAgICAgcHJvdGVj\ndGVkIGJvb2xlYW4gdXNlUHJvcGVydHlCYXNlZEFjY2VzcyAoKSB7CiAgICAg\nICAgICAgIHJldHVybiBBQ0NFU1NfVFlQRV9QUk9QRVJUWS5lcXVhbHMoX2Fj\nY2Vzc1R5cGUpOwogICAgICAgIH0KCiAgICB9Cn0K\n","encoding":"base64"}

