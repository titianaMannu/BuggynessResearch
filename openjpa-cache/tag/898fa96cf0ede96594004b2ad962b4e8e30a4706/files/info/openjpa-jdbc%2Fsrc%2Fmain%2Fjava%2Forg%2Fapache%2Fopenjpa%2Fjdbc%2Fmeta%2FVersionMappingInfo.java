{"sha":"60f9e840a04eaf341aeb4bf69f81e0c7c7ab0d6b","node_id":"MDQ6QmxvYjIwNjM2NDo2MGY5ZTg0MGEwNGVhZjM0MWFlYjRiZjY5ZjgxZTBjN2M3YWIwZDZi","size":6472,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/60f9e840a04eaf341aeb4bf69f81e0c7c7ab0d6b","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhOwoKaW1wb3J0\nIGphdmEudXRpbC5BcnJheUxpc3Q7CmltcG9ydCBqYXZhLnV0aWwuQXJyYXlz\nOwppbXBvcnQgamF2YS51dGlsLkhhc2hTZXQ7CmltcG9ydCBqYXZhLnV0aWwu\nTGlua2VkSGFzaE1hcDsKaW1wb3J0IGphdmEudXRpbC5MaXN0OwppbXBvcnQg\namF2YS51dGlsLk1hcDsKaW1wb3J0IGphdmEudXRpbC5TZXQ7CgppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuaWRlbnRpZmllci5EQklkZW50aWZp\nZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhLnN0cmF0\ncy5Ob25lVmVyc2lvblN0cmF0ZWd5OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLmpkYmMubWV0YS5zdHJhdHMuU3VwZXJjbGFzc1ZlcnNpb25TdHJhdGVn\neTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNjaGVtYS5Db2x1\nbW47CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hlbWEuSW5k\nZXg7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hlbWEuU2No\nZW1hR3JvdXA7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hl\nbWEuVGFibGU7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwu\nTG9jYWxpemVyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuVXNl\nckV4Y2VwdGlvbjsKCi8qKgogKiBJbmZvcm1hdGlvbiBhYm91dCB0aGUgbWFw\ncGluZyBmcm9tIGEgdmVyc2lvbiBpbmRpY2F0b3IgdG8gdGhlIHNjaGVtYSwg\naW4KICogcmF3IGZvcm0uIFRoZSBjb2x1bW5zIGFuZCB0YWJsZXMgdXNlZCBp\nbiBtYXBwaW5nIGluZm8gd2lsbCBub3QgYmUgcGFydCBvZgogKiB0aGUge0Bs\naW5rIFNjaGVtYUdyb3VwfSB1c2VkIGF0IHJ1bnRpbWUuIFJhdGhlciwgdGhl\neSB3aWxsIGJlIHN0cnVjdHMKICogd2l0aCB0aGUgcmVsZXZhbnQgcGllY2Vz\nIG9mIGluZm9ybWF0aW9uIGZpbGxlZCBpbi4KICoKICogQGF1dGhvciBBYmUg\nV2hpdGUKICovCnB1YmxpYyBjbGFzcyBWZXJzaW9uTWFwcGluZ0luZm8KICAg\nIGV4dGVuZHMgTWFwcGluZ0luZm8gewoKICAgIHByaXZhdGUgc3RhdGljIGZp\nbmFsIExvY2FsaXplciBfbG9jID0gTG9jYWxpemVyLmZvclBhY2thZ2UKICAg\nIAkoVmVyc2lvbk1hcHBpbmdJbmZvLmNsYXNzKTsKICAgIC8qKgogICAgICog\nUmV0dXJuIHRoZSBjb2x1bW5zIHNldCBmb3IgdGhpcyB2ZXJzaW9uLCBiYXNl\nZCBvbiB0aGUgZ2l2ZW4gdGVtcGxhdGVzLgogICAgICovCiAgICBwdWJsaWMg\nQ29sdW1uW10gZ2V0Q29sdW1ucyhWZXJzaW9uIHZlcnNpb24sIENvbHVtbltd\nIHRlbXBsYXRlcywKICAgICAgICBib29sZWFuIGFkYXB0KSB7CiAgICAJaWYg\nKHNwYW5zTXVsdGlwbGVUYWJsZXModGVtcGxhdGVzKSkKICAgIAkJcmV0dXJu\nIGdldE11bHRpVGFibGVDb2x1bW5zKHZlcnNpb24sIHRlbXBsYXRlcywgYWRh\ncHQpOwogICAgICAgIFRhYmxlIHRhYmxlID0gZ2V0U2luZ2xlVGFibGUodmVy\nc2lvbiwgdGVtcGxhdGVzKTsKICAgICAgICB2ZXJzaW9uLmdldE1hcHBpbmdS\nZXBvc2l0b3J5KCkuZ2V0TWFwcGluZ0RlZmF1bHRzKCkucG9wdWxhdGVDb2x1\nbW5zCiAgICAgICAgICAgICh2ZXJzaW9uLCB0YWJsZSwgdGVtcGxhdGVzKTsK\nICAgICAgICByZXR1cm4gY3JlYXRlQ29sdW1ucyh2ZXJzaW9uLCBudWxsLCB0\nZW1wbGF0ZXMsIHRhYmxlLCBhZGFwdCk7CiAgICB9CiAgICAKICAgIC8qKgog\nICAgICogUmV0dXJuIHRoZSBjb2x1bW5zIHNldCBmb3IgdGhpcyB2ZXJzaW9u\nIHdoZW4gdGhlIGNvbHVtbnMgYXJlIHNwcmVhZCAKICAgICAqIGFjcm9zcyBt\ndWx0aXBsZSB0YWJsZXMuCiAgICAgKi8KICAgIHB1YmxpYyBDb2x1bW5bXSBn\nZXRNdWx0aVRhYmxlQ29sdW1ucyhWZXJzaW9uIHZlcnMsIENvbHVtbltdIHRl\nbXBsYXRlcywKICAgICAgICAgICAgYm9vbGVhbiBhZGFwdCkgewogICAgCVRh\nYmxlIHByaW1hcnlUYWJsZSA9IHZlcnMuZ2V0Q2xhc3NNYXBwaW5nKCkuZ2V0\nVGFibGUoKTsKICAgIAlMaXN0PERCSWRlbnRpZmllcj4gc2Vjb25kYXJ5VGFi\nbGVOYW1lcyA9IEFycmF5cy5hc0xpc3QodmVycwogICAgICAgICAgICAgICAg\nLmdldENsYXNzTWFwcGluZygpLmdldE1hcHBpbmdJbmZvKCkuZ2V0U2Vjb25k\nYXJ5VGFibGVJZGVudGlmaWVycygpKTsKICAgICAgICBNYXA8VGFibGUsIExp\nc3Q8Q29sdW1uPj4gYXNzaWduID0gbmV3IExpbmtlZEhhc2hNYXA8VGFibGUs\nCiAgICAgICAgICAgICAgICBMaXN0PENvbHVtbj4+KCk7CiAgICAJZm9yIChD\nb2x1bW4gY29sIDogdGVtcGxhdGVzKSB7CiAgICAJICAgIERCSWRlbnRpZmll\nciB0YWJsZU5hbWUgPSBjb2wuZ2V0VGFibGVJZGVudGlmaWVyKCk7CiAgICAJ\nICAgIFRhYmxlIHRhYmxlOwogICAgCQlpZiAoREJJZGVudGlmaWVyLmlzRW1w\ndHkodGFibGVOYW1lKSAKICAgIAkJICB8fCB0YWJsZU5hbWUuZXF1YWxzKHBy\naW1hcnlUYWJsZS5nZXRJZGVudGlmaWVyKCkpKSB7CiAgICAJCQl0YWJsZSA9\nIHByaW1hcnlUYWJsZTsKICAgIAkJfSBlbHNlIGlmIChzZWNvbmRhcnlUYWJs\nZU5hbWVzLmNvbnRhaW5zKHRhYmxlTmFtZSkpIHsKICAgIAkJCXRhYmxlID0g\ncHJpbWFyeVRhYmxlLmdldFNjaGVtYSgpLmdldFRhYmxlKHRhYmxlTmFtZSk7\nCiAgICAJCX0gZWxzZSB7CiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgVXNl\nckV4Y2VwdGlvbihfbG9jLmdldCgiYmFkLXZlcnNpb24tY29sdW1uLXRhYmxl\nIiwKICAgIAkJCQkJY29sLmdldElkZW50aWZpZXIoKS50b1N0cmluZygpLCB0\nYWJsZU5hbWUpKTsKICAgIAkJfQogICAgCQlpZiAoIWFzc2lnbi5jb250YWlu\nc0tleSh0YWJsZSkpCiAgICAJCQlhc3NpZ24ucHV0KHRhYmxlLCBuZXcgQXJy\nYXlMaXN0PENvbHVtbj4oKSk7CiAgICAJCWFzc2lnbi5nZXQodGFibGUpLmFk\nZChjb2wpOwogICAgCX0KICAgIAlNYXBwaW5nRGVmYXVsdHMgZGVmID0gdmVy\ncy5nZXRNYXBwaW5nUmVwb3NpdG9yeSgpLmdldE1hcHBpbmdEZWZhdWx0cygp\nOwogICAgCUxpc3Q8Q29sdW1uPiByZXN1bHQgPSBuZXcgQXJyYXlMaXN0PENv\nbHVtbj4oKTsKICAgIAlmb3IgKFRhYmxlIHRhYmxlIDogYXNzaWduLmtleVNl\ndCgpKSB7CiAgICAJCUxpc3Q8Q29sdW1uPiBjb2xzID0gYXNzaWduLmdldCh0\nYWJsZSk7CiAgICAJCUNvbHVtbltdIHBhcnRUZW1wbGF0ZXMgPSBjb2xzLnRv\nQXJyYXkobmV3IENvbHVtbltjb2xzLnNpemUoKV0pOwogICAgCQlkZWYucG9w\ndWxhdGVDb2x1bW5zKHZlcnMsIHRhYmxlLCBwYXJ0VGVtcGxhdGVzKTsKICAg\nICAgICAgICAgcmVzdWx0LmFkZEFsbChBcnJheXMuYXNMaXN0KGNyZWF0ZUNv\nbHVtbnModmVycywgbnVsbCwgcGFydFRlbXBsYXRlcywKICAgIAkJCQl0YWJs\nZSwgYWRhcHQpKSk7CiAgICAJfQogICAgCXJldHVybiByZXN1bHQudG9BcnJh\neShuZXcgQ29sdW1uW3Jlc3VsdC5zaXplKCldKTsKICAgIH0KICAgIAogICAg\nLyoqCiAgICAgKiBSZXR1cm4gdGhlIGluZGV4IHRvIHNldCBvbiB0aGUgdmVy\nc2lvbiBjb2x1bW5zLCBvciBudWxsIGlmIG5vbmUuCiAgICAgKi8KICAgIHB1\nYmxpYyBJbmRleCBnZXRJbmRleChWZXJzaW9uIHZlcnNpb24sIENvbHVtbltd\nIGNvbHMsIGJvb2xlYW4gYWRhcHQpIHsKICAgICAgICBJbmRleCBpZHggPSBu\ndWxsOwogICAgICAgIGlmIChjb2xzLmxlbmd0aCA+IDApCiAgICAgICAgICAg\nIGlkeCA9IHZlcnNpb24uZ2V0TWFwcGluZ1JlcG9zaXRvcnkoKS5nZXRNYXBw\naW5nRGVmYXVsdHMoKS4KICAgICAgICAgICAgICAgIGdldEluZGV4KHZlcnNp\nb24sIGNvbHNbMF0uZ2V0VGFibGUoKSwgY29scyk7CiAgICAgICAgcmV0dXJu\nIGNyZWF0ZUluZGV4KHZlcnNpb24sIG51bGwsIGlkeCwgY29scywgYWRhcHQp\nOwogICAgfQoKICAgIC8qKgogICAgICogU3luY2hyb25pemUgaW50ZXJuYWwg\naW5mb3JtYXRpb24gd2l0aCB0aGUgbWFwcGluZyBkYXRhIGZvciB0aGUgZ2l2\nZW4KICAgICAqIHZlcnNpb24uCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHN5\nbmNXaXRoKFZlcnNpb24gdmVyc2lvbikgewogICAgICAgIGNsZWFyKGZhbHNl\nKTsKCiAgICAgICAgQ2xhc3NNYXBwaW5nIGNscyA9IHZlcnNpb24uZ2V0Q2xh\nc3NNYXBwaW5nKCk7CiAgICAgICAgQ29sdW1uW10gY29scyA9IHZlcnNpb24u\nZ2V0Q29sdW1ucygpOwoKICAgICAgICBzZXRDb2x1bW5JTyh2ZXJzaW9uLmdl\ndENvbHVtbklPKCkpOwogICAgICAgIHN5bmNDb2x1bW5zKHZlcnNpb24sIGNv\nbHMsIGZhbHNlKTsKICAgICAgICBzeW5jSW5kZXgodmVyc2lvbiwgdmVyc2lv\nbi5nZXRJbmRleCgpKTsKCiAgICAgICAgaWYgKHZlcnNpb24uZ2V0U3RyYXRl\nZ3koKSA9PSBudWxsCiAgICAgICAgICAgIHx8IHZlcnNpb24uZ2V0U3RyYXRl\nZ3koKSBpbnN0YW5jZW9mIFN1cGVyY2xhc3NWZXJzaW9uU3RyYXRlZ3kpCiAg\nICAgICAgICAgIHJldHVybjsKCiAgICAgICAgLy8gZXhwbGljaXQgdmVyc2lv\nbiBzdHJhdGVneSBpZjoKICAgICAgICAvLyAtIHVubWFwcGVkIGNsYXNzIGFu\nZCB2ZXJzaW9uIG1hcHBlZAogICAgICAgIC8vIC0gbWFwcGVkIGJhc2UgY2xh\nc3MKICAgICAgICAvLyAtIG1hcHBlZCBzdWJjbGFzcyB0aGF0IGRvZXNuJ3Qg\ncmVseSBvbiBzdXBlcmNsYXNzIHZlcnNpb24KICAgICAgICBTdHJpbmcgc3Ry\nYXQgPSB2ZXJzaW9uLmdldFN0cmF0ZWd5KCkuZ2V0QWxpYXMoKTsKICAgICAg\nICBpZiAoKCFjbHMuaXNNYXBwZWQoKSAmJiAhTm9uZVZlcnNpb25TdHJhdGVn\neS5BTElBUy5lcXVhbHMoc3RyYXQpKQogICAgICAgICAgICB8fCAoY2xzLmlz\nTWFwcGVkKCkKICAgICAgICAgICAgJiYgY2xzLmdldEpvaW5hYmxlUENTdXBl\ncmNsYXNzTWFwcGluZygpID09IG51bGwpKQogICAgICAgICAgICBzZXRTdHJh\ndGVneShzdHJhdCk7CiAgICB9CiAgICAKICAgIC8qKgogICAgICogQWZmaXJt\ncyBpZiB0aGUgZ2l2ZW4gY29sdW1ucyBiZWxvbmcgdG8gbW9yZSB0aGFuIG9u\nZSB0YWJsZXMuCiAgICAgKi8KICAgIGJvb2xlYW4gc3BhbnNNdWx0aXBsZVRh\nYmxlcyhDb2x1bW5bXSBjb2xzKSB7CiAgICAJaWYgKGNvbHMgPT0gbnVsbCB8\nfCBjb2xzLmxlbmd0aCA8PSAxKSAKICAgIAkJcmV0dXJuIGZhbHNlOwogICAg\nCVNldDxEQklkZW50aWZpZXI+IHRhYmxlcyA9IG5ldyBIYXNoU2V0PERCSWRl\nbnRpZmllcj4oKTsKICAgIAlmb3IgKENvbHVtbiBjb2wgOiBjb2xzKQogICAg\nCQlpZiAodGFibGVzLmFkZChjb2wuZ2V0VGFibGVJZGVudGlmaWVyKCkpICYm\nIHRhYmxlcy5zaXplKCkgPiAxKQogICAgCQkJcmV0dXJuIHRydWU7CiAgICAJ\ncmV0dXJuIGZhbHNlOwogICAgfQogICAgCiAgICAvKioKICAgICAqIEdldHMg\ndGhlIHRhYmxlIHdoZXJlIHRoaXMgdmVyc2lvbiBjb2x1bW5zIGFyZSBtYXBw\nZWQuCiAgICAgKi8KICAgIHByaXZhdGUgVGFibGUgZ2V0U2luZ2xlVGFibGUo\nVmVyc2lvbiB2ZXJzaW9uLCBDb2x1bW5bXSBjb2xzKSB7CiAgICAJaWYgKGNv\nbHMgPT0gbnVsbCB8fCBjb2xzLmxlbmd0aCA9PSAwIAogICAgCSB8fCBEQklk\nZW50aWZpZXIuaXNFbXB0eShjb2xzWzBdLmdldFRhYmxlSWRlbnRpZmllcigp\nKSkKICAgIAkJcmV0dXJuIHZlcnNpb24uZ2V0Q2xhc3NNYXBwaW5nKCkuZ2V0\nVGFibGUoKTsKICAgIAlyZXR1cm4gdmVyc2lvbi5nZXRDbGFzc01hcHBpbmco\nKS5nZXRUYWJsZSgpLmdldFNjaGVtYSgpCiAgICAJCS5nZXRUYWJsZShjb2xz\nWzBdLmdldFRhYmxlSWRlbnRpZmllcigpKTsKICAgIH0KCgp9Cg==\n","encoding":"base64"}

