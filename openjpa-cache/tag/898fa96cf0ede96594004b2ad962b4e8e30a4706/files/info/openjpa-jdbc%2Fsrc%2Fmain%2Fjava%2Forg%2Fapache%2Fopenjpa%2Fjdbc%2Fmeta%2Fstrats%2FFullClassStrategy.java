{"sha":"e7f75822e67b3068659916033f53be4a6a01f643","node_id":"MDQ6QmxvYjIwNjM2NDplN2Y3NTgyMmU2N2IzMDY4NjU5OTE2MDMzZjUzYmU0YTZhMDFmNjQz","size":5325,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/e7f75822e67b3068659916033f53be4a6a01f643","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhLnN0cmF0czsK\nCmltcG9ydCBqYXZhLnNxbC5TUUxFeGNlcHRpb247CgppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLmpkYmMuaWRlbnRpZmllci5EQklkZW50aWZpZXI7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5rZXJuZWwuSkRCQ0ZldGNo\nQ29uZmlndXJhdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJj\nLmtlcm5lbC5KREJDU3RvcmU7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\namRiYy5tZXRhLkNsYXNzTWFwcGluZzsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5qZGJjLm1ldGEuQ2xhc3NNYXBwaW5nSW5mbzsKaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS5qZGJjLnNjaGVtYS5Db2x1bW47CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hlbWEuUHJpbWFyeUtleTsKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNjaGVtYS5UYWJsZTsKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNxbC5EQkRpY3Rpb25hcnk7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zcWwuUm93OwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc3FsLlJvd01hbmFnZXI7CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zcWwuU2VsZWN0OwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5PcGVuSlBBU3RhdGVNYW5hZ2Vy\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51dGlsLkxvY2FsaXpl\ncjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRhLkphdmFUeXBlczsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRhLlZhbHVlU3RyYXRlZ2ll\nczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLk1ldGFEYXRhRXhj\nZXB0aW9uOwoKLyoqCiAqIE1hcHBpbmcgZm9yIHdoZW4gdGhlIGNsYXNzIG1h\ncHMgYWxsIGZpZWxkcyB0byBpdHMgb3duIHRhYmxlLgogKgogKiBAYXV0aG9y\nIEFiZSBXaGl0ZQogKi8KcHVibGljIGNsYXNzIEZ1bGxDbGFzc1N0cmF0ZWd5\nCiAgICBleHRlbmRzIEFic3RyYWN0Q2xhc3NTdHJhdGVneSB7CgogICAgcHVi\nbGljIHN0YXRpYyBmaW5hbCBTdHJpbmcgQUxJQVMgPSAiZnVsbCI7CgogICAg\ncHJpdmF0ZSBzdGF0aWMgZmluYWwgTG9jYWxpemVyIF9sb2MgPSBMb2NhbGl6\nZXIuZm9yUGFja2FnZQogICAgICAgIChGdWxsQ2xhc3NTdHJhdGVneS5jbGFz\ncyk7CgogICAgcHVibGljIFN0cmluZyBnZXRBbGlhcygpIHsKICAgICAgICBy\nZXR1cm4gQUxJQVM7CiAgICB9CgogICAgcHVibGljIHZvaWQgbWFwKGJvb2xl\nYW4gYWRhcHQpIHsKICAgICAgICBpZiAoY2xzLmdldEVtYmVkZGluZ01ldGFE\nYXRhKCkgIT0gbnVsbCkKICAgICAgICAgICAgdGhyb3cgbmV3IE1ldGFEYXRh\nRXhjZXB0aW9uKF9sb2MuZ2V0KCJub3QtZnVsbCIsIGNscykpOwoKICAgICAg\nICBDbGFzc01hcHBpbmcgc3VwID0gY2xzLmdldE1hcHBlZFBDU3VwZXJjbGFz\nc01hcHBpbmcoKTsKICAgICAgICBDbGFzc01hcHBpbmdJbmZvIGluZm8gPSBj\nbHMuZ2V0TWFwcGluZ0luZm8oKTsKICAgICAgICBpZiAoc3VwICE9IG51bGwg\nJiYgaW5mby5pc0pvaW5lZFN1YmNsYXNzKCkpCiAgICAgICAgICAgIHRocm93\nIG5ldyBNZXRhRGF0YUV4Y2VwdGlvbihfbG9jLmdldCgibm90LWZ1bGwiLCBj\nbHMpKTsKCiAgICAgICAgaW5mby5hc3NlcnROb0pvaW4oY2xzLCB0cnVlKTsK\nICAgICAgICBpbmZvLmFzc2VydE5vRm9yZWlnbktleShjbHMsICFhZGFwdCk7\nCiAgICAgICAgaW5mby5hc3NlcnROb0luZGV4KGNscywgZmFsc2UpOwogICAg\nICAgIGluZm8uYXNzZXJ0Tm9VbmlxdWUoY2xzLCBmYWxzZSk7CgogICAgICAg\nIC8vIGZpbmQgY2xhc3MgdGFibGUKICAgICAgICBUYWJsZSB0YWJsZSA9IGlu\nZm8uZ2V0VGFibGUoY2xzLCBhZGFwdCk7CgogICAgICAgIC8vIGZpbmQgcHJp\nbWFyeSBrZXkgY29sdW1uCiAgICAgICAgQ29sdW1uW10gcGtDb2xzID0gbnVs\nbDsKICAgICAgICBpZiAoY2xzLmdldElkZW50aXR5VHlwZSgpID09IGNscy5J\nRF9EQVRBU1RPUkUpIHsKICAgICAgICAgICAgQ29sdW1uIGlkID0gbmV3IENv\nbHVtbigpOwogICAgICAgICAgICBEQkRpY3Rpb25hcnkgZGljdCA9IGNscy5n\nZXRNYXBwaW5nUmVwb3NpdG9yeSgpLmdldERCRGljdGlvbmFyeSgpOwogICAg\nICAgICAgICBEQklkZW50aWZpZXIgaWROYW1lID0gREJJZGVudGlmaWVyLm5l\nd0NvbHVtbigiaWQiLCBkaWN0ICE9IG51bGwgPyBkaWN0LmRlbGltaXRBbGwo\nKSA6IGZhbHNlKTsKICAgICAgICAgICAgaWQuc2V0SWRlbnRpZmllcihpZE5h\nbWUpOwogICAgICAgICAgICBpZC5zZXRKYXZhVHlwZShKYXZhVHlwZXMuTE9O\nRyk7CiAgICAgICAgICAgIGlkLnNldENvbW1lbnQoImRhdGFzdG9yZSBpZCIp\nOwogICAgICAgICAgICBpZiAoY2xzLmdldElkZW50aXR5U3RyYXRlZ3koKSA9\nPSBWYWx1ZVN0cmF0ZWdpZXMuQVVUT0FTU0lHTikKICAgICAgICAgICAgICAg\nIGlkLnNldEF1dG9Bc3NpZ25lZCh0cnVlKTsKICAgICAgICAgICAgaWQuc2V0\nTm90TnVsbCh0cnVlKTsKICAgICAgICAgICAgcGtDb2xzID0gaW5mby5nZXRE\nYXRhU3RvcmVJZENvbHVtbnMoY2xzLCBuZXcgQ29sdW1uW117IGlkIH0sCiAg\nICAgICAgICAgICAgICB0YWJsZSwgYWRhcHQpOwogICAgICAgICAgICBjbHMu\nc2V0UHJpbWFyeUtleUNvbHVtbnMocGtDb2xzKTsKICAgICAgICAgICAgY2xz\nLnNldENvbHVtbklPKGluZm8uZ2V0Q29sdW1uSU8oKSk7CiAgICAgICAgfQog\nICAgICAgIGNscy5zZXRUYWJsZSh0YWJsZSk7CgogICAgICAgIC8vIGFkZCBh\nIHByaW1hcnkga2V5IGlmIHdlIGRvbid0IGhhdmUgb25lIGFscmVhZHkKICAg\nICAgICBQcmltYXJ5S2V5IHBrID0gdGFibGUuZ2V0UHJpbWFyeUtleSgpOwog\nICAgICAgIGlmIChwayA9PSBudWxsKSB7CiAgICAgICAgICAgIERCSWRlbnRp\nZmllciBwa25hbWUgPSBEQklkZW50aWZpZXIuTlVMTDsKICAgICAgICAgICAg\naWYgKGFkYXB0KQogICAgICAgICAgICAgICAgcGtuYW1lID0gY2xzLmdldE1h\ncHBpbmdSZXBvc2l0b3J5KCkuZ2V0TWFwcGluZ0RlZmF1bHRzKCkuCiAgICAg\nICAgICAgICAgICAgICAgZ2V0UHJpbWFyeUtleUlkZW50aWZpZXIoY2xzLCB0\nYWJsZSk7CiAgICAgICAgICAgIHBrID0gdGFibGUuYWRkUHJpbWFyeUtleShw\na25hbWUpOwogICAgICAgICAgICBway5zZXRMb2dpY2FsKCFhZGFwdCk7CiAg\nICAgICAgICAgIGlmIChwa0NvbHMgIT0gbnVsbCkKICAgICAgICAgICAgICAg\nIHBrLnNldENvbHVtbnMocGtDb2xzKTsKICAgICAgICB9CgogICAgICAgIC8v\nIHNldCBqb2luYWJsZQogICAgICAgIGlmIChjbHMuZ2V0SWRlbnRpdHlUeXBl\nKCkgPT0gQ2xhc3NNYXBwaW5nLklEX0RBVEFTVE9SRSkKICAgICAgICAgICAg\nY2xzLnNldEpvaW5hYmxlKGNscy5nZXRQcmltYXJ5S2V5Q29sdW1ucygpWzBd\nLAogICAgICAgICAgICAgICAgbmV3IElkZW50aXR5Sm9pbmFibGUoY2xzKSk7\nCiAgICB9CgogICAgcHVibGljIGJvb2xlYW4gc3VwcG9ydHNFYWdlclNlbGVj\ndChTZWxlY3Qgc2VsLCBPcGVuSlBBU3RhdGVNYW5hZ2VyIHNtLAogICAgICAg\nIEpEQkNTdG9yZSBzdG9yZSwgQ2xhc3NNYXBwaW5nIGJhc2UsIEpEQkNGZXRj\naENvbmZpZ3VyYXRpb24gZmV0Y2gpIHsKICAgICAgICByZXR1cm4gZmFsc2U7\nCiAgICB9CgogICAgcHVibGljIHZvaWQgaW5zZXJ0KE9wZW5KUEFTdGF0ZU1h\nbmFnZXIgc20sIEpEQkNTdG9yZSBzdG9yZSwgUm93TWFuYWdlciBybSkKICAg\nICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBSb3cgcm93ID0g\ncm0uZ2V0Um93KGNscy5nZXRUYWJsZSgpLCBSb3cuQUNUSU9OX0lOU0VSVCwg\nc20sIHRydWUpOwogICAgICAgIGlmIChjbHMuZ2V0SWRlbnRpdHlUeXBlKCkg\nPT0gY2xzLklEX0RBVEFTVE9SRSkKICAgICAgICAgICAgcm93LnNldFByaW1h\ncnlLZXkoY2xzLmdldENvbHVtbklPKCksIHNtKTsKICAgIH0KCiAgICBwdWJs\naWMgdm9pZCB1cGRhdGUoT3BlbkpQQVN0YXRlTWFuYWdlciBzbSwgSkRCQ1N0\nb3JlIHN0b3JlLCBSb3dNYW5hZ2VyIHJtKQogICAgICAgIHRocm93cyBTUUxF\neGNlcHRpb24gewogICAgICAgIFJvdyByb3cgPSBybS5nZXRSb3coY2xzLmdl\ndFRhYmxlKCksIFJvdy5BQ1RJT05fVVBEQVRFLCBzbSwgZmFsc2UpOwogICAg\nICAgIGlmIChyb3cgIT0gbnVsbCkKICAgICAgICAgICAgcm93LndoZXJlUHJp\nbWFyeUtleShzbSk7CiAgICB9CgogICAgcHVibGljIHZvaWQgZGVsZXRlKE9w\nZW5KUEFTdGF0ZU1hbmFnZXIgc20sIEpEQkNTdG9yZSBzdG9yZSwgUm93TWFu\nYWdlciBybSkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAg\nICBSb3cgcm93ID0gcm0uZ2V0Um93KGNscy5nZXRUYWJsZSgpLCBSb3cuQUNU\nSU9OX0RFTEVURSwgc20sIHRydWUpOwogICAgICAgIHJvdy53aGVyZVByaW1h\ncnlLZXkoc20pOwogICAgfQoKICAgIHB1YmxpYyBib29sZWFuIGlzUHJpbWFy\neUtleU9iamVjdElkKGJvb2xlYW4gaGFzQWxsKSB7CiAgICAgICAgcmV0dXJu\nIHRydWU7CiAgICB9Cn0K\n","encoding":"base64"}

