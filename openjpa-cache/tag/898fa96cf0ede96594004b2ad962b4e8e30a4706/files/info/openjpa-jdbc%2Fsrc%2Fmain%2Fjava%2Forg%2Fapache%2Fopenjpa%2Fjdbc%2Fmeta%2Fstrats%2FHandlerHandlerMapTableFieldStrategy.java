{"sha":"9dd20858362d65148431489f5975f1bed20753d8","node_id":"MDQ6QmxvYjIwNjM2NDo5ZGQyMDg1ODM2MmQ2NTE0ODQzMTQ4OWY1OTc1ZjFiZWQyMDc1M2Q4","size":9135,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/9dd20858362d65148431489f5975f1bed20753d8","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNr\nYWdlIG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLm1ldGEuc3RyYXRzOwoKaW1w\nb3J0IGphdmEuc3FsLio7CmltcG9ydCBqYXZhLnV0aWwuKjsKCmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEuamRiYy5pZGVudGlmaWVyLkRCSWRlbnRpZmll\ncjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLmtlcm5lbC4qOwpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0YS4qOwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1hLio7CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEuamRiYy5zcWwuKjsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS5rZXJuZWwuKjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5s\naWIudXRpbC4qOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuKjsK\nCi8qKgogKiBNYXBwaW5nIGZvciBhIG1hcCBvZiBrZXlzIGFuZCB2YWx1ZXMg\nYm90aCBjb250cm9sbGVkIGJ5CiAqIHtAbGluayBWYWx1ZUhhbmRsZXJ9cy4K\nICoKICogQGF1dGhvciBBYmUgV2hpdGUKICogQHNpbmNlIDAuNC4wLCAxLjEu\nMAogKi8KcHVibGljIGNsYXNzIEhhbmRsZXJIYW5kbGVyTWFwVGFibGVGaWVs\nZFN0cmF0ZWd5CiAgICBleHRlbmRzIE1hcFRhYmxlRmllbGRTdHJhdGVneSB7\nCgogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgTG9jYWxpemVyIF9sb2MgPSBM\nb2NhbGl6ZXIuZm9yUGFja2FnZQogICAgICAgIChIYW5kbGVySGFuZGxlck1h\ncFRhYmxlRmllbGRTdHJhdGVneS5jbGFzcyk7CgogICAgcHJpdmF0ZSBDb2x1\nbW5bXSBfa2NvbHMgPSBudWxsOwogICAgcHJpdmF0ZSBDb2x1bW5JTyBfa2lv\nID0gbnVsbDsKICAgIHByaXZhdGUgYm9vbGVhbiBfa2xvYWQgPSBmYWxzZTsK\nICAgIHByaXZhdGUgQ29sdW1uW10gX3Zjb2xzID0gbnVsbDsKICAgIHByaXZh\ndGUgQ29sdW1uSU8gX3ZpbyA9IG51bGw7CiAgICBwcml2YXRlIGJvb2xlYW4g\nX3Zsb2FkID0gZmFsc2U7CgogICAgcHVibGljIENvbHVtbltdIGdldEtleUNv\nbHVtbnMoQ2xhc3NNYXBwaW5nIGNscykgewogICAgICAgIHJldHVybiBfa2Nv\nbHM7CiAgICB9CgogICAgcHVibGljIENvbHVtbltdIGdldFZhbHVlQ29sdW1u\ncyhDbGFzc01hcHBpbmcgY2xzKSB7CiAgICAgICAgcmV0dXJuIF92Y29sczsK\nICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZWxlY3RLZXkoU2VsZWN0IHNlbCwg\nQ2xhc3NNYXBwaW5nIGNscywgT3BlbkpQQVN0YXRlTWFuYWdlciBzbSwKICAg\nICAgICBKREJDU3RvcmUgc3RvcmUsIEpEQkNGZXRjaENvbmZpZ3VyYXRpb24g\nZmV0Y2gsIEpvaW5zIGpvaW5zKSB7CiAgICAgICAgc2VsLnNlbGVjdChfa2Nv\nbHMsIGpvaW5zKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZWxlY3RWYWx1\nZShTZWxlY3Qgc2VsLCBDbGFzc01hcHBpbmcgY2xzLAogICAgICAgIE9wZW5K\nUEFTdGF0ZU1hbmFnZXIgc20sCiAgICAgICAgSkRCQ1N0b3JlIHN0b3JlLCBK\nREJDRmV0Y2hDb25maWd1cmF0aW9uIGZldGNoLCBKb2lucyBqb2lucykgewog\nICAgICAgIHNlbC5zZWxlY3QoX3Zjb2xzLCBqb2lucyk7CiAgICB9CgogICAg\ncHVibGljIFJlc3VsdFtdIGdldFJlc3VsdHMoT3BlbkpQQVN0YXRlTWFuYWdl\nciBzbSwgSkRCQ1N0b3JlIHN0b3JlLAogICAgICAgIEpEQkNGZXRjaENvbmZp\nZ3VyYXRpb24gZmV0Y2gsIGludCBlYWdlck1vZGUsIEpvaW5zW10gam9pbnMs\nIGJvb2xlYW4gbHJzKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewog\nICAgICAgIFNlbGVjdCBzZWwgPSBzdG9yZS5nZXRTUUxGYWN0b3J5KCkubmV3\nU2VsZWN0KCk7CiAgICAgICAgc2VsLnNldExSUyhscnMpOwogICAgICAgIHNl\nbC5zZWxlY3QoX2tjb2xzKTsKICAgICAgICBzZWwuc2VsZWN0KF92Y29scyk7\nCiAgICAgICAgc2VsLndoZXJlRm9yZWlnbktleShmaWVsZC5nZXRKb2luRm9y\nZWlnbktleSgpLCBzbS5nZXRPYmplY3RJZCgpLAogICAgICAgICAgICBmaWVs\nZC5nZXREZWZpbmluZ01hcHBpbmcoKSwgc3RvcmUpOwogICAgICAgIFJlc3Vs\ndCByZXMgPSBzZWwuZXhlY3V0ZShzdG9yZSwgZmV0Y2gpOwogICAgICAgIHJl\ndHVybiBuZXcgUmVzdWx0W117IHJlcywgcmVzIH07CiAgICB9CgogICAgcHVi\nbGljIE9iamVjdCBsb2FkS2V5KE9wZW5KUEFTdGF0ZU1hbmFnZXIgc20sIEpE\nQkNTdG9yZSBzdG9yZSwKICAgICAgICBKREJDRmV0Y2hDb25maWd1cmF0aW9u\nIGZldGNoLCBSZXN1bHQgcmVzLCBKb2lucyBqb2lucykKICAgICAgICB0aHJv\nd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICByZXR1cm4gSGFuZGxlclN0cmF0\nZWdpZXMubG9hZE9iamVjdChmaWVsZC5nZXRLZXlNYXBwaW5nKCksCiAgICAg\nICAgICAgIHNtLCBzdG9yZSwgZmV0Y2gsIHJlcywgam9pbnMsIF9rY29scywg\nX2tsb2FkKTsKICAgIH0KCiAgICBwdWJsaWMgT2JqZWN0IGxvYWRWYWx1ZShP\ncGVuSlBBU3RhdGVNYW5hZ2VyIHNtLCBKREJDU3RvcmUgc3RvcmUsCiAgICAg\nICAgSkRCQ0ZldGNoQ29uZmlndXJhdGlvbiBmZXRjaCwgUmVzdWx0IHJlcywg\nSm9pbnMgam9pbnMpCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAg\nICAgICAgcmV0dXJuIEhhbmRsZXJTdHJhdGVnaWVzLmxvYWRPYmplY3QoZmll\nbGQuZ2V0RWxlbWVudE1hcHBpbmcoKSwKICAgICAgICAgICAgc20sIHN0b3Jl\nLCBmZXRjaCwgcmVzLCBqb2lucywgX3Zjb2xzLCBfdmxvYWQpOwogICAgfQoK\nICAgIHB1YmxpYyB2b2lkIG1hcChib29sZWFuIGFkYXB0KSB7CiAgICAgICAg\nc3VwZXIubWFwKGFkYXB0KTsKCiAgICAgICAgVmFsdWVNYXBwaW5nIGtleSA9\nIGZpZWxkLmdldEtleU1hcHBpbmcoKTsKICAgICAgICBpZiAoa2V5LmdldEhh\nbmRsZXIoKSA9PSBudWxsKQogICAgICAgICAgICB0aHJvdyBuZXcgTWV0YURh\ndGFFeGNlcHRpb24oX2xvYy5nZXQoIm5vLWhhbmRsZXIiLCBrZXkpKTsKICAg\nICAgICBWYWx1ZU1hcHBpbmcgdmFsID0gZmllbGQuZ2V0RWxlbWVudE1hcHBp\nbmcoKTsKICAgICAgICBpZiAodmFsLmdldEhhbmRsZXIoKSA9PSBudWxsKQog\nICAgICAgICAgICB0aHJvdyBuZXcgTWV0YURhdGFFeGNlcHRpb24oX2xvYy5n\nZXQoIm5vLWhhbmRsZXIiLCB2YWwpKTsKICAgICAgICBhc3NlcnROb3RNYXBw\nZWRCeSgpOwoKICAgICAgICBmaWVsZC5tYXBKb2luKGFkYXB0LCB0cnVlKTsK\nICAgICAgICBfa2lvID0gbmV3IENvbHVtbklPKCk7CiAgICAgICAgTGlzdCBj\nb2x1bW5zID0ga2V5LmdldFZhbHVlSW5mbygpLmdldENvbHVtbnMoKTsgCiAg\nICAgICAgREJEaWN0aW9uYXJ5IGRpY3QgPSBmaWVsZC5nZXRNYXBwaW5nUmVw\nb3NpdG9yeSgpLmdldERCRGljdGlvbmFyeSgpOwogICAgICAgIERCSWRlbnRp\nZmllciBjb2xOYW1lID0gZGljdC5nZXRWYWxpZENvbHVtbk5hbWUoREJJZGVu\ndGlmaWVyLm5ld0NvbHVtbigia2V5IiksIGZpZWxkLmdldFRhYmxlKCkpOwog\nICAgICAgIF9rY29scyA9IEhhbmRsZXJTdHJhdGVnaWVzLm1hcChrZXksIGNv\nbE5hbWUuZ2V0TmFtZSgpLCBfa2lvLCBhZGFwdCk7CgogICAgICAgIF92aW8g\nPSBuZXcgQ29sdW1uSU8oKTsKICAgICAgICBfdmNvbHMgPSBIYW5kbGVyU3Ry\nYXRlZ2llcy5tYXAodmFsLCAidmFsdWUiLCBfdmlvLCBhZGFwdCk7CiAgICAg\nICAgZmllbGQubWFwUHJpbWFyeUtleShhZGFwdCk7CiAgICB9CgogICAgcHVi\nbGljIHZvaWQgaW5pdGlhbGl6ZSgpIHsKICAgICAgICBfa2xvYWQgPSBmaWVs\nZC5nZXRLZXlNYXBwaW5nKCkuZ2V0SGFuZGxlcigpLgogICAgICAgICAgICBv\nYmplY3RWYWx1ZVJlcXVpcmVzTG9hZChmaWVsZC5nZXRLZXlNYXBwaW5nKCkp\nOwogICAgICAgIF92bG9hZCA9IGZpZWxkLmdldEVsZW1lbnRNYXBwaW5nKCku\nZ2V0SGFuZGxlcigpLgogICAgICAgICAgICBvYmplY3RWYWx1ZVJlcXVpcmVz\nTG9hZChmaWVsZC5nZXRFbGVtZW50TWFwcGluZygpKTsKICAgIH0KCiAgICBw\ndWJsaWMgdm9pZCBpbnNlcnQoT3BlbkpQQVN0YXRlTWFuYWdlciBzbSwgSkRC\nQ1N0b3JlIHN0b3JlLCBSb3dNYW5hZ2VyIHJtKQogICAgICAgIHRocm93cyBT\nUUxFeGNlcHRpb24gewogICAgICAgIGluc2VydChzbSwgc3RvcmUsIHJtLCAo\nTWFwKSBzbS5mZXRjaE9iamVjdChmaWVsZC5nZXRJbmRleCgpKSk7CiAgICB9\nCgogICAgcHJpdmF0ZSB2b2lkIGluc2VydChPcGVuSlBBU3RhdGVNYW5hZ2Vy\nIHNtLCBKREJDU3RvcmUgc3RvcmUsIFJvd01hbmFnZXIgcm0sCiAgICAgICAg\nTWFwIG1hcCkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAg\nICBpZiAobWFwID09IG51bGwgfHwgbWFwLmlzRW1wdHkoKSkKICAgICAgICAg\nICAgcmV0dXJuOwoKICAgICAgICBSb3cgcm93ID0gcm0uZ2V0U2Vjb25kYXJ5\nUm93KGZpZWxkLmdldFRhYmxlKCksIFJvdy5BQ1RJT05fSU5TRVJUKTsKICAg\nICAgICByb3cuc2V0Rm9yZWlnbktleShmaWVsZC5nZXRKb2luRm9yZWlnbktl\neSgpLCBmaWVsZC5nZXRKb2luQ29sdW1uSU8oKSwKICAgICAgICAgICAgc20p\nOwoKICAgICAgICBWYWx1ZU1hcHBpbmcga2V5ID0gZmllbGQuZ2V0S2V5TWFw\ncGluZygpOwogICAgICAgIFZhbHVlTWFwcGluZyB2YWwgPSBmaWVsZC5nZXRF\nbGVtZW50TWFwcGluZygpOwogICAgICAgIE1hcC5FbnRyeSBlbnRyeTsKICAg\nICAgICBmb3IgKEl0ZXJhdG9yIGl0ciA9IG1hcC5lbnRyeVNldCgpLml0ZXJh\ndG9yKCk7IGl0ci5oYXNOZXh0KCk7KSB7CiAgICAgICAgICAgIGVudHJ5ID0g\nKE1hcC5FbnRyeSkgaXRyLm5leHQoKTsKICAgICAgICAgICAgSGFuZGxlclN0\ncmF0ZWdpZXMuc2V0KGtleSwgZW50cnkuZ2V0S2V5KCksIHN0b3JlLCByb3cs\nIF9rY29scywKICAgICAgICAgICAgICAgIF9raW8sIHRydWUpOwogICAgICAg\nICAgICBIYW5kbGVyU3RyYXRlZ2llcy5zZXQodmFsLCBlbnRyeS5nZXRWYWx1\nZSgpLCBzdG9yZSwgcm93LCBfdmNvbHMsCiAgICAgICAgICAgICAgICBfdmlv\nLCB0cnVlKTsKICAgICAgICAgICAgcm0uZmx1c2hTZWNvbmRhcnlSb3cocm93\nKTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGljIHZvaWQgdXBkYXRlKE9w\nZW5KUEFTdGF0ZU1hbmFnZXIgc20sIEpEQkNTdG9yZSBzdG9yZSwgUm93TWFu\nYWdlciBybSkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAg\nICBNYXAgbWFwID0gKE1hcCkgc20uZmV0Y2hPYmplY3QoZmllbGQuZ2V0SW5k\nZXgoKSk7CiAgICAgICAgQ2hhbmdlVHJhY2tlciBjdCA9IG51bGw7CiAgICAg\nICAgaWYgKG1hcCBpbnN0YW5jZW9mIFByb3h5KSB7CiAgICAgICAgICAgIFBy\nb3h5IHByb3h5ID0gKFByb3h5KSBtYXA7CiAgICAgICAgICAgIGlmIChQcm94\naWVzLmlzT3duZXIocHJveHksIHNtLCBmaWVsZC5nZXRJbmRleCgpKSkKICAg\nICAgICAgICAgICAgIGN0ID0gcHJveHkuZ2V0Q2hhbmdlVHJhY2tlcigpOwog\nICAgICAgIH0KCiAgICAgICAgLy8gaWYgbm8gZmluZS1ncmFpbmVkIGNoYW5n\nZSB0cmFja2luZyB0aGVuIGp1c3QgZGVsZXRlIGFuZCByZWluc2VydAogICAg\nICAgIGlmIChjdCA9PSBudWxsIHx8ICFjdC5pc1RyYWNraW5nKCkpIHsKICAg\nICAgICAgICAgZGVsZXRlKHNtLCBzdG9yZSwgcm0pOwogICAgICAgICAgICBp\nbnNlcnQoc20sIHN0b3JlLCBybSwgbWFwKTsKICAgICAgICAgICAgcmV0dXJu\nOwogICAgICAgIH0KCiAgICAgICAgLy8gZGVsZXRlIHRoZSByZW1vdmVzCiAg\nICAgICAgVmFsdWVNYXBwaW5nIGtleSA9IGZpZWxkLmdldEtleU1hcHBpbmco\nKTsKICAgICAgICBDb2xsZWN0aW9uIHJlbSA9IGN0LmdldFJlbW92ZWQoKTsK\nICAgICAgICBpZiAoIXJlbS5pc0VtcHR5KCkpIHsKICAgICAgICAgICAgUm93\nIGRlbFJvdyA9IHJtLmdldFNlY29uZGFyeVJvdyhmaWVsZC5nZXRUYWJsZSgp\nLAogICAgICAgICAgICAgICAgUm93LkFDVElPTl9ERUxFVEUpOwogICAgICAg\nICAgICBkZWxSb3cud2hlcmVGb3JlaWduS2V5KGZpZWxkLmdldEpvaW5Gb3Jl\naWduS2V5KCksIHNtKTsKICAgICAgICAgICAgZm9yIChJdGVyYXRvciBpdHIg\nPSByZW0uaXRlcmF0b3IoKTsgaXRyLmhhc05leHQoKTspIHsKICAgICAgICAg\nICAgICAgIEhhbmRsZXJTdHJhdGVnaWVzLndoZXJlKGtleSwgaXRyLm5leHQo\nKSwgc3RvcmUsIGRlbFJvdywKICAgICAgICAgICAgICAgICAgICBfa2NvbHMp\nOwogICAgICAgICAgICAgICAgcm0uZmx1c2hTZWNvbmRhcnlSb3coZGVsUm93\nKTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgLy8gaW5zZXJ0\nIHRoZSBhZGRzCiAgICAgICAgVmFsdWVNYXBwaW5nIHZhbCA9IGZpZWxkLmdl\ndEVsZW1lbnRNYXBwaW5nKCk7CiAgICAgICAgQ29sbGVjdGlvbiBhZGQgPSBj\ndC5nZXRBZGRlZCgpOwogICAgICAgIE9iamVjdCBta2V5OwogICAgICAgIGlm\nICghYWRkLmlzRW1wdHkoKSkgewogICAgICAgICAgICBSb3cgYWRkUm93ID0g\ncm0uZ2V0U2Vjb25kYXJ5Um93KGZpZWxkLmdldFRhYmxlKCksCiAgICAgICAg\nICAgICAgICBSb3cuQUNUSU9OX0lOU0VSVCk7CiAgICAgICAgICAgIGFkZFJv\ndy5zZXRGb3JlaWduS2V5KGZpZWxkLmdldEpvaW5Gb3JlaWduS2V5KCksCiAg\nICAgICAgICAgICAgICBmaWVsZC5nZXRKb2luQ29sdW1uSU8oKSwgc20pOwoK\nICAgICAgICAgICAgZm9yIChJdGVyYXRvciBpdHIgPSBhZGQuaXRlcmF0b3Io\nKTsgaXRyLmhhc05leHQoKTspIHsKICAgICAgICAgICAgICAgIG1rZXkgPSBp\ndHIubmV4dCgpOwogICAgICAgICAgICAgICAgSGFuZGxlclN0cmF0ZWdpZXMu\nc2V0KGtleSwgbWtleSwgc3RvcmUsIGFkZFJvdywgX2tjb2xzLAogICAgICAg\nICAgICAgICAgICAgIF9raW8sIHRydWUpOwogICAgICAgICAgICAgICAgSGFu\nZGxlclN0cmF0ZWdpZXMuc2V0KHZhbCwgbWFwLmdldChta2V5KSwgc3RvcmUs\nIGFkZFJvdywKICAgICAgICAgICAgICAgICAgICBfdmNvbHMsIF92aW8sIHRy\ndWUpOwogICAgICAgICAgICAgICAgcm0uZmx1c2hTZWNvbmRhcnlSb3coYWRk\nUm93KTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgLy8gdXBk\nYXRlIHRoZSBjaGFuZ2VzCiAgICAgICAgQ29sbGVjdGlvbiBjaGFuZ2UgPSBj\ndC5nZXRDaGFuZ2VkKCk7CiAgICAgICAgaWYgKCFjaGFuZ2UuaXNFbXB0eSgp\nKSB7CiAgICAgICAgICAgIFJvdyBjaGFuZ2VSb3cgPSBybS5nZXRTZWNvbmRh\ncnlSb3coZmllbGQuZ2V0VGFibGUoKSwKICAgICAgICAgICAgICAgIFJvdy5B\nQ1RJT05fVVBEQVRFKTsKICAgICAgICAgICAgY2hhbmdlUm93LndoZXJlRm9y\nZWlnbktleShmaWVsZC5nZXRKb2luRm9yZWlnbktleSgpLCBzbSk7CgogICAg\nICAgICAgICBmb3IgKEl0ZXJhdG9yIGl0ciA9IGNoYW5nZS5pdGVyYXRvcigp\nOyBpdHIuaGFzTmV4dCgpOykgewogICAgICAgICAgICAgICAgbWtleSA9IGl0\nci5uZXh0KCk7CiAgICAgICAgICAgICAgICBIYW5kbGVyU3RyYXRlZ2llcy53\naGVyZShrZXksIG1rZXksIHN0b3JlLCBjaGFuZ2VSb3csIF9rY29scyk7CiAg\nICAgICAgICAgICAgICBIYW5kbGVyU3RyYXRlZ2llcy5zZXQodmFsLCBtYXAu\nZ2V0KG1rZXkpLCBzdG9yZSwgY2hhbmdlUm93LAogICAgICAgICAgICAgICAg\nICAgIF92Y29scywgX3ZpbywgdHJ1ZSk7CiAgICAgICAgICAgICAgICBybS5m\nbHVzaFNlY29uZGFyeVJvdyhjaGFuZ2VSb3cpOwogICAgICAgICAgICB9CiAg\nICAgICAgfQogICAgfQoKICAgIHB1YmxpYyBPYmplY3QgdG9EYXRhU3RvcmVW\nYWx1ZShPYmplY3QgdmFsLCBKREJDU3RvcmUgc3RvcmUpIHsKICAgICAgICBy\nZXR1cm4gSGFuZGxlclN0cmF0ZWdpZXMudG9EYXRhU3RvcmVWYWx1ZShmaWVs\nZC5nZXRFbGVtZW50TWFwcGluZygpLAogICAgICAgICAgICB2YWwsIF92Y29s\ncywgc3RvcmUpOwogICAgfQoKICAgIHB1YmxpYyBPYmplY3QgdG9LZXlEYXRh\nU3RvcmVWYWx1ZShPYmplY3QgdmFsLCBKREJDU3RvcmUgc3RvcmUpIHsKICAg\nICAgICByZXR1cm4gSGFuZGxlclN0cmF0ZWdpZXMudG9EYXRhU3RvcmVWYWx1\nZShmaWVsZC5nZXRLZXlNYXBwaW5nKCksIHZhbCwKICAgICAgICAgICAgX2tj\nb2xzLCBzdG9yZSk7CiAgICB9CgogICAgcHVibGljIEpvaW5zIGpvaW5SZWxh\ndGlvbihKb2lucyBqb2lucywgYm9vbGVhbiBmb3JjZU91dGVyLAogICAgICAg\nIGJvb2xlYW4gdHJhdmVyc2UpIHsKICAgICAgICBpZiAodHJhdmVyc2UpCiAg\nICAgICAgICAgIEhhbmRsZXJTdHJhdGVnaWVzLmFzc2VydEpvaW5hYmxlKGZp\nZWxkLmdldEVsZW1lbnRNYXBwaW5nKCkpOwogICAgICAgIHJldHVybiBqb2lu\nczsKICAgIH0KCiAgICBwdWJsaWMgSm9pbnMgam9pbktleVJlbGF0aW9uKEpv\naW5zIGpvaW5zLCBib29sZWFuIGZvcmNlT3V0ZXIsCiAgICAgICAgYm9vbGVh\nbiB0cmF2ZXJzZSkgewogICAgICAgIGlmICh0cmF2ZXJzZSkKICAgICAgICAg\nICAgSGFuZGxlclN0cmF0ZWdpZXMuYXNzZXJ0Sm9pbmFibGUoZmllbGQuZ2V0\nS2V5TWFwcGluZygpKTsKICAgICAgICByZXR1cm4gam9pbnM7CiAgICB9Cn0K\n","encoding":"base64"}

