{"sha":"10c86032fa757df15ae0acc5ce2f9bf325f43669","node_id":"MDQ6QmxvYjIwNjM2NDoxMGM4NjAzMmZhNzU3ZGYxNWFlMGFjYzVjZTJmOWJmMzI1ZjQzNjY5","size":10185,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/10c86032fa757df15ae0acc5ce2f9bf325f43669","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhLnN0cmF0czsK\nCmltcG9ydCBqYXZhLnNxbC5TUUxFeGNlcHRpb247CgppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLmpkYmMuaWRlbnRpZmllci5EQklkZW50aWZpZXI7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5rZXJuZWwuSkRCQ0ZldGNo\nQ29uZmlndXJhdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJj\nLmtlcm5lbC5KREJDU3RvcmU7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\namRiYy5tZXRhLkNsYXNzTWFwcGluZzsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5qZGJjLm1ldGEuUmVsYXRpb25JZDsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS5qZGJjLm1ldGEuVmFsdWVIYW5kbGVyOwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLmpkYmMubWV0YS5WYWx1ZU1hcHBpbmc7CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhLlZhbHVlTWFwcGluZ0luZm87\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hlbWEuQ29sdW1u\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1hLkNvbHVt\nbklPOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc3FsLkRCRGlj\ndGlvbmFyeTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNxbC5K\nb2luczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNxbC5SZXN1\nbHQ7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zcWwuUm93Owpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5PcGVuSlBBU3RhdGVN\nYW5hZ2VyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51dGlsLkxv\nY2FsaXplcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLkludmFs\naWRTdGF0ZUV4Y2VwdGlvbjsKCi8qKgogKiBVdGlsaXR5IG1ldGhvZHMgZm9y\nIHN0cmF0ZWdpZXMgdXNpbmcgdmFsdWUgaGFuZGxlcnMuCiAqCiAqIEBhdXRo\nb3IgQWJlIFdoaXRlCiAqIEBzaW5jZSAwLjQuMAogKi8KcHVibGljIGNsYXNz\nIEhhbmRsZXJTdHJhdGVnaWVzIHsKCiAgICBwcml2YXRlIHN0YXRpYyBmaW5h\nbCBMb2NhbGl6ZXIgX2xvYyA9IExvY2FsaXplci5mb3JQYWNrYWdlCiAgICAg\nICAgKEhhbmRsZXJTdHJhdGVnaWVzLmNsYXNzKTsKCiAgICAvKioKICAgICAq\nIE1hcCB0aGUgZ2l2ZW4gdmFsdWUuCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0\naWMgQ29sdW1uW10gbWFwKFZhbHVlTWFwcGluZyB2bSwgU3RyaW5nIG5hbWUs\nIENvbHVtbklPIGlvLAogICAgICAgIGJvb2xlYW4gYWRhcHQpIHsKICAgICAg\nICBWYWx1ZU1hcHBpbmdJbmZvIHZpbmZvID0gdm0uZ2V0VmFsdWVJbmZvKCk7\nCiAgICAgICAgdmluZm8uYXNzZXJ0Tm9Kb2luKHZtLCB0cnVlKTsKICAgICAg\nICB2aW5mby5hc3NlcnROb0ZvcmVpZ25LZXkodm0sICFhZGFwdCk7CgogICAg\nICAgIERCRGljdGlvbmFyeSBkaWN0ID0gdm0uZ2V0TWFwcGluZ1JlcG9zaXRv\ncnkoKS5nZXREQkRpY3Rpb25hcnkoKTsKICAgICAgICBEQklkZW50aWZpZXIg\nY29sTmFtZSA9IERCSWRlbnRpZmllci5uZXdDb2x1bW4obmFtZSwgZGljdCAh\nPSBudWxsID8gZGljdC5kZWxpbWl0QWxsKCkgOiBmYWxzZSk7CiAgICAgICAg\nQ29sdW1uW10gY29scyA9IHZtLmdldEhhbmRsZXIoKS5tYXAodm0sIGNvbE5h\nbWUuZ2V0TmFtZSgpLCBpbywgYWRhcHQpOwogICAgICAgIGlmIChjb2xzLmxl\nbmd0aCA+IDAgJiYgY29sc1swXS5nZXRUYWJsZSgpID09IG51bGwpIHsKICAg\nICAgICAgICAgY29scyA9IHZpbmZvLmdldENvbHVtbnModm0sIGNvbE5hbWUs\nIGNvbHMsCiAgICAgICAgICAgICAgICB2bS5nZXRGaWVsZE1hcHBpbmcoKS5n\nZXRUYWJsZSgpLCBhZGFwdCk7CiAgICAgICAgICAgIGlmICh2aW5mby5pc0lt\ncGxpY2l0UmVsYXRpb24oKSkKICAgICAgICAgICAgCWZvciAoaW50IGkgPSAw\nOyBpIDwgY29scy5sZW5ndGg7IGkrKykKICAgICAgICAgICAgCQljb2xzW2ld\nLnNldEltcGxpY2l0UmVsYXRpb24odHJ1ZSk7CiAgICAgICAgICAgIENvbHVt\nbklPIG1hcHBlZElPID0gdmluZm8uZ2V0Q29sdW1uSU8oKTsKICAgICAgICAg\nICAgdm0uc2V0Q29sdW1ucyhjb2xzKTsKICAgICAgICAgICAgdm0uc2V0Q29s\ndW1uSU8obWFwcGVkSU8pOwogICAgICAgICAgICBpZiAobWFwcGVkSU8gIT0g\nbnVsbCkgewogICAgICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBj\nb2xzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgICAgICAgaW8uc2V0\nSW5zZXJ0YWJsZShpLCBtYXBwZWRJTy5pc0luc2VydGFibGUoaSwgZmFsc2Up\nKTsKICAgICAgICAgICAgICAgICAgICBpby5zZXROdWxsSW5zZXJ0YWJsZShp\nLCBtYXBwZWRJTy5pc0luc2VydGFibGUoaSwgdHJ1ZSkpOwogICAgICAgICAg\nICAgICAgICAgIGlvLnNldFVwZGF0YWJsZShpLCBtYXBwZWRJTy5pc1VwZGF0\nYWJsZShpLCBmYWxzZSkpOwogICAgICAgICAgICAgICAgICAgIGlvLnNldE51\nbGxVcGRhdGFibGUoaSwgbWFwcGVkSU8uaXNVcGRhdGFibGUoaSwgdHJ1ZSkp\nOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQog\nICAgICAgIHZtLm1hcENvbnN0cmFpbnRzKGNvbE5hbWUsIGFkYXB0KTsKICAg\nICAgICByZXR1cm4gY29sczsKICAgIH0KCiAgICAvKioKICAgICAqIFNldCB0\naGUgZ2l2ZW4gdmFsdWUgaW50byB0aGUgZ2l2ZW4gcm93LgogICAgICogUmV0\ndXJuIGZhbHNlIGlmIHRoZSBnaXZlbiB2YWx1ZSBjYW4gbm90IGJlIHNldCwg\nZm9yIGV4YW1wbGUsIGR1ZSB0byAKICAgICAqIG51bGwgY29uc3RyYWludHMg\nb24gdGhlIGNvbHVtbnMuIAogICAgICovCiAgICBwdWJsaWMgc3RhdGljIGJv\nb2xlYW4gc2V0KFZhbHVlTWFwcGluZyB2bSwgT2JqZWN0IHZhbCwgSkRCQ1N0\nb3JlIHN0b3JlLAogICAgICAgIFJvdyByb3csIENvbHVtbltdIGNvbHMsIENv\nbHVtbklPIGlvLCBib29sZWFuIG51bGxOb25lKQogICAgICAgIHRocm93cyBT\nUUxFeGNlcHRpb24gewogICAgICAgIGlmICghY2FuU2V0QW55KHJvdywgaW8s\nIGNvbHMpKQogICAgICAgICAgICByZXR1cm4gZmFsc2U7CgogICAgICAgIFZh\nbHVlSGFuZGxlciBoYW5kbGVyID0gdm0uZ2V0SGFuZGxlcigpOwogICAgICAg\nIHZhbCA9IGhhbmRsZXIudG9EYXRhU3RvcmVWYWx1ZSh2bSwgdmFsLCBzdG9y\nZSk7CiAgICAgICAgYm9vbGVhbiBpc1NldCA9IGZhbHNlOwogICAgICAgIGlm\nICh2YWwgPT0gbnVsbCkgewogICAgICAgICAgICBmb3IgKGludCBpID0gMDsg\naSA8IGNvbHMubGVuZ3RoOyBpKyspCiAgICAgICAgICAgICAgICBpZiAoY2Fu\nU2V0KHJvdywgaW8sIGksIHRydWUpKSB7CiAgICAgICAgICAgICAgICAgICAg\naXNTZXQgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgIHNldChyb3csIGNv\nbHNbaV0sIG51bGwsIGhhbmRsZXIsIG51bGxOb25lKTsKICAgICAgICAgICAg\nICAgIH0KICAgICAgICB9IGVsc2UgaWYgKGNvbHMubGVuZ3RoID09IDEpIHsK\nICAgICAgICAgICAgaWYgKGNhblNldChyb3csIGlvLCAwLCB2YWwgPT0gbnVs\nbCkpIHsKICAgICAgICAgICAgICAgIGlzU2V0ID0gdHJ1ZTsKICAgICAgICAg\nICAgICAgIHNldChyb3csIGNvbHNbMF0sIHZhbCwgaGFuZGxlciwgbnVsbE5v\nbmUpOwogICAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAg\nICAgT2JqZWN0W10gdmFscyA9IChPYmplY3RbXSkgdmFsOwogICAgICAgICAg\nICBmb3IgKGludCBpID0gMDsgaSA8IHZhbHMubGVuZ3RoOyBpKyspCiAgICAg\nICAgICAgICAgICBpZiAoY2FuU2V0KHJvdywgaW8sIGksIHZhbHNbaV0gPT0g\nbnVsbCkpIHsKICAgICAgICAgICAgICAgICAgICBpc1NldCA9IHRydWU7CiAg\nICAgICAgICAgICAgICAgICAgc2V0KHJvdywgY29sc1tpXSwgdmFsc1tpXSwg\naGFuZGxlciwgbnVsbE5vbmUpOwogICAgICAgICAgICAgICAgfQogICAgICAg\nIH0KICAgICAgICByZXR1cm4gaXNTZXQ7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBSZXR1cm4gdHJ1ZSBpZiB0aGUgZ2l2ZW4gY29sdW1uIGluZGV4IGlzIHNl\ndHRhYmxlLgogICAgICovCiAgICBwcml2YXRlIHN0YXRpYyBib29sZWFuIGNh\nblNldChSb3cgcm93LCBDb2x1bW5JTyBpbywgaW50IGksCiAgICAgICAgYm9v\nbGVhbiBudWxsVmFsdWUpIHsKICAgICAgICBpZiAocm93LmdldEFjdGlvbigp\nID09IFJvdy5BQ1RJT05fSU5TRVJUKQogICAgICAgIAlyZXR1cm4gaW8uaXNJ\nbnNlcnRhYmxlKGksIG51bGxWYWx1ZSk7CiAgICAgICAgaWYgKHJvdy5nZXRB\nY3Rpb24oKSA9PSBSb3cuQUNUSU9OX1VQREFURSkKICAgICAgICAJcmV0dXJu\nIGlvLmlzVXBkYXRhYmxlKGksIG51bGxWYWx1ZSk7CiAgICAgICAgcmV0dXJu\nIHRydWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gdHJ1ZSBpZiB0\naGUgYW55IGNvbHVtbiB1cCB0byB0aGUgZ2l2ZW4gaW5kZXggaXMgc2V0dGFi\nbGUuCiAgICAgKi8KICAgIHByaXZhdGUgc3RhdGljIGJvb2xlYW4gY2FuU2V0\nQW55KFJvdyByb3csIENvbHVtbklPIGlvLCBDb2x1bW5bXSBjb2xzKSB7CiAg\nICAgICAgaWYgKHJvdy5nZXRBY3Rpb24oKSA9PSBSb3cuQUNUSU9OX0lOU0VS\nVCkKICAgICAgICAgICAgcmV0dXJuIGlvLmlzQW55SW5zZXJ0YWJsZShjb2xz\nLCBmYWxzZSk7CiAgICAgICAgaWYgKHJvdy5nZXRBY3Rpb24oKSA9PSBSb3cu\nQUNUSU9OX1VQREFURSkKICAgICAgICAgICAgcmV0dXJuIGlvLmlzQW55VXBk\nYXRhYmxlKGNvbHMsIGZhbHNlKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAg\nIH0KCiAgICAvKioKICAgICAqIFNldCBhIHZhbHVlIGludG8gYSByb3csIHRh\na2luZyBjYXJlIG5vdCB0byBvdmVycmlkZSBjb2x1bW4gZGVmYXVsdHMKICAg\nICAqIHdpdGggbnVsbHMgdW5sZXNzIHRoZSB1c2VyIHdhbnRzIHVzIHRvLgog\nICAgICovCiAgICBwcml2YXRlIHN0YXRpYyB2b2lkIHNldChSb3cgcm93LCBD\nb2x1bW4gY29sLCBPYmplY3QgdmFsLAogICAgICAgIFZhbHVlSGFuZGxlciBo\nYW5kbGVyLCBib29sZWFuIG51bGxOb25lKQogICAgICAgIHRocm93cyBTUUxF\neGNlcHRpb24gewogICAgICAgIGlmICh2YWwgPT0gbnVsbCkKICAgICAgICAg\nICAgcm93LnNldE51bGwoY29sLCBudWxsTm9uZSk7CiAgICAgICAgZWxzZSBp\nZiAoY29sLmlzUmVsYXRpb25JZCgpICYmIGhhbmRsZXIgaW5zdGFuY2VvZiBS\nZWxhdGlvbklkKQogICAgICAgICAgICByb3cuc2V0UmVsYXRpb25JZChjb2ws\nIChPcGVuSlBBU3RhdGVNYW5hZ2VyKSB2YWwsCiAgICAgICAgICAgICAgICAo\nUmVsYXRpb25JZCkgaGFuZGxlcik7CiAgICAgICAgZWxzZQogICAgICAgICAg\nICByb3cuc2V0T2JqZWN0KGNvbCwgdmFsKTsKICAgIH0KCiAgICAvKioKICAg\nICAqIEFkZCB3aGVyZSBjb25kaXRpb25zIHRvIHRoZSBnaXZlbiByb3cuCiAg\nICAgKi8KICAgIHB1YmxpYyBzdGF0aWMgdm9pZCB3aGVyZShWYWx1ZU1hcHBp\nbmcgdm0sIE9iamVjdCB2YWwsIEpEQkNTdG9yZSBzdG9yZSwKICAgICAgICBS\nb3cgcm93LCBDb2x1bW5bXSBjb2xzKQogICAgICAgIHRocm93cyBTUUxFeGNl\ncHRpb24gewogICAgICAgIGlmIChjb2xzLmxlbmd0aCA9PSAwKQogICAgICAg\nICAgICByZXR1cm47CgogICAgICAgIHZhbCA9IHRvRGF0YVN0b3JlVmFsdWUo\ndm0sIHZhbCwgY29scywgc3RvcmUpOwogICAgICAgIGlmICh2YWwgPT0gbnVs\nbCkKICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBjb2xzLmxlbmd0\naDsgaSsrKQogICAgICAgICAgICAgICAgcm93LndoZXJlTnVsbChjb2xzW2ld\nKTsKICAgICAgICBlbHNlIGlmIChjb2xzLmxlbmd0aCA9PSAxKQogICAgICAg\nICAgICB3aGVyZShyb3csIGNvbHNbMF0sIHZhbCk7CiAgICAgICAgZWxzZSB7\nCiAgICAgICAgICAgIE9iamVjdFtdIHZhbHMgPSAoT2JqZWN0W10pIHZhbDsK\nICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCB2YWxzLmxlbmd0aDsg\naSsrKQogICAgICAgICAgICAgICAgd2hlcmUocm93LCBjb2xzW2ldLCB2YWxz\nW2ldKTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBTZXQgYSB3\naGVyZSBjb25kaXRpb24gb24gdGhlIGdpdmVuIHJvdy4KICAgICAqLwogICAg\ncHJpdmF0ZSBzdGF0aWMgdm9pZCB3aGVyZShSb3cgcm93LCBDb2x1bW4gY29s\nLCBPYmplY3QgdmFsKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewog\nICAgICAgIGlmICh2YWwgPT0gbnVsbCkKICAgICAgICAgICAgcm93LndoZXJl\nTnVsbChjb2wpOwogICAgICAgIGVsc2UKICAgICAgICAgICAgcm93LndoZXJl\nT2JqZWN0KGNvbCwgdmFsKTsKICAgIH0KCiAgICAvKioKICAgICAqIExvYWQg\ndGhlIE9iamVjdCB2YWx1ZSBmcm9tIHRoZSBnaXZlbiByZXN1bHQuCiAgICAg\nKi8KICAgIHB1YmxpYyBzdGF0aWMgT2JqZWN0IGxvYWRPYmplY3QoVmFsdWVN\nYXBwaW5nIHZtLCBPcGVuSlBBU3RhdGVNYW5hZ2VyIHNtLAogICAgICAgIEpE\nQkNTdG9yZSBzdG9yZSwgSkRCQ0ZldGNoQ29uZmlndXJhdGlvbiBmZXRjaCwg\nUmVzdWx0IHJlcywKICAgICAgICBKb2lucyBqb2lucywgQ29sdW1uW10gY29s\ncywgYm9vbGVhbiBvYmplY3RWYWx1ZVJlcXVpcmVzTG9hZCkKICAgICAgICB0\naHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBpZiAoY29scy5sZW5ndGgg\nPT0gMCkKICAgICAgICAgICAgdGhyb3cgbmV3IEludmFsaWRTdGF0ZUV4Y2Vw\ndGlvbihfbG9jLmdldCgiY2FudC1wcm9qZWN0LW93bmVkIiwKICAgICAgICAg\nICAgICAgIHZtKSk7CgogICAgICAgIE9iamVjdCB2YWwgPSBsb2FkRGF0YVN0\nb3JlKHZtLCByZXMsIGpvaW5zLCBjb2xzKTsKICAgICAgICBpZiAob2JqZWN0\nVmFsdWVSZXF1aXJlc0xvYWQpCiAgICAgICAgICAgIHJldHVybiB2bS5nZXRI\nYW5kbGVyKCkudG9PYmplY3RWYWx1ZSh2bSwgdmFsLCBzbSwgc3RvcmUsIGZl\ndGNoKTsKICAgICAgICByZXR1cm4gdm0uZ2V0SGFuZGxlcigpLnRvT2JqZWN0\nVmFsdWUodm0sIHZhbCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBMb2FkIHRo\nZSBkYXRhc3RvcmUgdmFsdWUgZnJvbSB0aGUgZ2l2ZW4gcmVzdWx0LiBUaGlz\nIG1ldGhvZCBkb2VzCiAgICAgKiA8Yj5ub3Q8L2I+IHByb2Nlc3MgdGhlIGxv\nYWRlZCB2YWx1ZSB0aHJvdWdoCiAgICAgKiB7QGxpbmsgVmFsdWVIYW5kbGVy\nI3RvT2JqZWN0VmFsdWV9LgogICAgICovCiAgICBwdWJsaWMgc3RhdGljIE9i\namVjdCBsb2FkRGF0YVN0b3JlKFZhbHVlTWFwcGluZyB2bSwgUmVzdWx0IHJl\ncywKICAgICAgICBKb2lucyBqb2lucywgQ29sdW1uW10gY29scykKICAgICAg\nICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBpZiAoY29scy5sZW5n\ndGggPT0gMCkKICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgaWYg\nKGNvbHMubGVuZ3RoID09IDEpCiAgICAgICAgICAgIHJldHVybiByZXMuZ2V0\nT2JqZWN0KGNvbHNbMF0sIHZtLmdldEhhbmRsZXIoKS4KICAgICAgICAgICAg\nICAgIGdldFJlc3VsdEFyZ3VtZW50KHZtKSwgam9pbnMpOwoKICAgICAgICBP\nYmplY3RbXSB2YWxzID0gbmV3IE9iamVjdFtjb2xzLmxlbmd0aF07CiAgICAg\nICAgT2JqZWN0W10gYXJncyA9IChPYmplY3RbXSkgdm0uZ2V0SGFuZGxlcigp\nLmdldFJlc3VsdEFyZ3VtZW50KHZtKTsKICAgICAgICBmb3IgKGludCBpID0g\nMDsgaSA8IGNvbHMubGVuZ3RoOyBpKyspCiAgICAgICAgICAgIHZhbHNbaV0g\nPSByZXMuZ2V0T2JqZWN0KGNvbHNbaV0sIChhcmdzID09IG51bGwpID8gbnVs\nbCA6IGFyZ3NbaV0sCiAgICAgICAgICAgICAgICBqb2lucyk7CiAgICAgICAg\ncmV0dXJuIHZhbHM7CiAgICB9CgogICAgLyoqCiAgICAgKiBDb252ZXJ0IHRo\nZSBnaXZlbiBvYmplY3QgdG8gaXRzIGRhdGFzdG9yZSB2YWx1ZShzKS4gUmVs\nYXRpb24gaWRzIGFyZQogICAgICogY29udmVydGVkIHRvIHRoZWlyIGZpbmFs\nIHZhbHVlcyBpbW1lZGlhdGVseS4KICAgICAqLwogICAgcHVibGljIHN0YXRp\nYyBPYmplY3QgdG9EYXRhU3RvcmVWYWx1ZShWYWx1ZU1hcHBpbmcgdm0sIE9i\namVjdCB2YWwsCiAgICAgICAgQ29sdW1uW10gY29scywgSkRCQ1N0b3JlIHN0\nb3JlKSB7CiAgICAgICAgVmFsdWVIYW5kbGVyIGhhbmRsZXIgPSB2bS5nZXRI\nYW5kbGVyKCk7CiAgICAgICAgdmFsID0gaGFuZGxlci50b0RhdGFTdG9yZVZh\nbHVlKHZtLCB2YWwsIHN0b3JlKTsKICAgICAgICBpZiAodmFsID09IG51bGwp\nIHsKICAgICAgICAgICAgaWYgKGNvbHMubGVuZ3RoID4gMSkKICAgICAgICAg\nICAgICAgIHJldHVybiBuZXcgT2JqZWN0W2NvbHMubGVuZ3RoXTsKICAgICAg\nICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgfQoKICAgICAgICAvLyByZWxh\ndGlvbiBpZHMgYXJlIHJldHVybmVkIGFzIHN0YXRlIG1hbmFnZXJzOyByZXNv\nbHZlIHRoZSBmaW5hbAogICAgICAgIC8vIGRhdGFzdG9yZSB2YWx1ZSBpbW1l\nZGlhdGVseQogICAgICAgIE9iamVjdFtdIHZhbHM7CiAgICAgICAgZm9yIChp\nbnQgaSA9IDA7IGkgPCBjb2xzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAg\nIGlmICghY29sc1tpXS5pc1JlbGF0aW9uSWQoKSkKICAgICAgICAgICAgICAg\nIGNvbnRpbnVlOwogICAgICAgICAgICBpZiAoIShoYW5kbGVyIGluc3RhbmNl\nb2YgUmVsYXRpb25JZCkpCiAgICAgICAgICAgICAgICBicmVhazsKICAgICAg\nICAgICAgaWYgKGNvbHMubGVuZ3RoID09IDEpIHsKICAgICAgICAgICAgICAg\nIHZhbCA9ICgoUmVsYXRpb25JZCkgaGFuZGxlcikudG9SZWxhdGlvbkRhdGFT\ndG9yZVZhbHVlCiAgICAgICAgICAgICAgICAgICAgKChPcGVuSlBBU3RhdGVN\nYW5hZ2VyKSB2YWwsIGNvbHNbaV0pOwogICAgICAgICAgICB9IGVsc2Ugewog\nICAgICAgICAgICAgICAgdmFscyA9IChPYmplY3RbXSkgdmFsOwogICAgICAg\nICAgICAgICAgdmFsc1tpXSA9ICgoUmVsYXRpb25JZCkgaGFuZGxlcikudG9S\nZWxhdGlvbkRhdGFTdG9yZVZhbHVlCiAgICAgICAgICAgICAgICAgICAgKChP\ncGVuSlBBU3RhdGVNYW5hZ2VyKSB2YWxzW2ldLCBjb2xzW2ldKTsKICAgICAg\nICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4gdmFsOwogICAgfQoK\nICAgIC8qKgogICAgICogVGhyb3cgdGhlIHByb3BlciBleGNlcHRpb24gaWYg\ndGhlIGdpdmVuIGhhbmRsZXItY29udHJvbGxlZCB2YWx1ZQogICAgICogcmVw\ncmVzZW50cyBhbiB1bmpvaW5hYmxlIHJlbGF0aW9uLgogICAgICovCiAgICBw\ndWJsaWMgc3RhdGljIHZvaWQgYXNzZXJ0Sm9pbmFibGUoVmFsdWVNYXBwaW5n\nIHZtKSB7CiAgICAgICAgQ2xhc3NNYXBwaW5nIHJlbCA9IHZtLmdldFR5cGVN\nYXBwaW5nKCk7CiAgICAgICAgaWYgKHJlbCAhPSBudWxsICYmIChyZWwuZ2V0\nVGFibGUoKSA9PSBudWxsCiAgICAgICAgICAgIHx8ICFyZWwuZ2V0VGFibGUo\nKS5lcXVhbHModm0uZ2V0RmllbGRNYXBwaW5nKCkuZ2V0VGFibGUoKSkpKQog\nICAgICAgICAgICB0aHJvdyBSZWxhdGlvblN0cmF0ZWdpZXMudW5qb2luYWJs\nZSh2bSk7CiAgICB9Cn0K\n","encoding":"base64"}

