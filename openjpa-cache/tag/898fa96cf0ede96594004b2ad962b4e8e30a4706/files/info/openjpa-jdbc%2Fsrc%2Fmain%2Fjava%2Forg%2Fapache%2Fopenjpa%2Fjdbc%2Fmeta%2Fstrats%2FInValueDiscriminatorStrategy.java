{"sha":"3dbf4a88aa8716eed51542285eaf261eb681a889","node_id":"MDQ6QmxvYjIwNjM2NDozZGJmNGE4OGFhODcxNmVlZDUxNTQyMjg1ZWFmMjYxZWI2ODFhODg5","size":6487,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/3dbf4a88aa8716eed51542285eaf261eb681a889","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhLnN0cmF0czsK\nCmltcG9ydCBqYXZhLnNxbC5TUUxFeGNlcHRpb247CgppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLmpkYmMuaWRlbnRpZmllci5EQklkZW50aWZpZXI7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5rZXJuZWwuSkRCQ1N0b3Jl\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0YS5DbGFzc01h\ncHBpbmc7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhLkRp\nc2NyaW1pbmF0b3JNYXBwaW5nSW5mbzsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5qZGJjLnNjaGVtYS5Db2x1bW47CmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEuamRiYy5zY2hlbWEuSW5kZXg7CmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEuamRiYy5zcWwuREJEaWN0aW9uYXJ5OwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLmpkYmMuc3FsLkpvaW5zOwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLmpkYmMuc3FsLlJlc3VsdDsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5qZGJjLnNxbC5Sb3c7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\namRiYy5zcWwuUm93TWFuYWdlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3Blbmpw\nYS5qZGJjLnNxbC5TUUxCdWZmZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEuamRiYy5zcWwuU2VsZWN0OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLmtlcm5lbC5PcGVuSlBBU3RhdGVNYW5hZ2VyOwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLmxpYi51dGlsLkxvY2FsaXplcjsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5tZXRhLkphdmFUeXBlczsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS51dGlsLk1ldGFEYXRhRXhjZXB0aW9uOwoKLyoqCiAqIEJhc2Ug\nZGlzY3JpbWluYXRvciBzdHJhdGVneSB0aGF0IGRldGVybWluZXMgdGhlIGNs\nYXNzIG9mIGRhdGFiYXNlCiAqIHJlY29yZHMgdXNpbmcgYSBjb2x1bW4gaG9s\nZGluZyBhIHZhbHVlIG1hcHBlZCB0byBhIGNsYXNzLCBhbmQgbGltaXRzCiAq\nIFNFTEVDVHMgdXNpbmcgYW4gSU4gKC4uLikgc3RhdGVtZW50LgogKgogKiBA\nYXV0aG9yIEFiZSBXaGl0ZQogKi8KcHVibGljIGFic3RyYWN0IGNsYXNzIElu\nVmFsdWVEaXNjcmltaW5hdG9yU3RyYXRlZ3kKICAgIGV4dGVuZHMgQWJzdHJh\nY3REaXNjcmltaW5hdG9yU3RyYXRlZ3kgewoKICAgIHByaXZhdGUgc3RhdGlj\nIGZpbmFsIExvY2FsaXplciBfbG9jID0gTG9jYWxpemVyLmZvclBhY2thZ2UK\nICAgICAgICAoSW5WYWx1ZURpc2NyaW1pbmF0b3JTdHJhdGVneS5jbGFzcyk7\nCgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIEphdmEgdHlwZSBjb2RlIGZy\nb20ge0BsaW5rIEphdmFUeXBlc30gZm9yIHRoZSBkaXNjcmltaW5hdG9yCiAg\nICAgKiB2YWx1ZXMuIFRoaXMgbWV0aG9kIGlzIG9ubHkgdXNlZCBkdXJpbmcg\nbWFwcGluZyBpbnN0YWxsYXRpb24uCiAgICAgKi8KICAgIHByb3RlY3RlZCBh\nYnN0cmFjdCBpbnQgZ2V0SmF2YVR5cGUoKTsKCiAgICAvKioKICAgICAqIFJl\ndHVybiB0aGUgZGlzY3JpbWluYXRvciB2YWx1ZSBmb3IgdGhlIGdpdmVuIHR5\ncGUuCiAgICAgKi8KICAgIHByb3RlY3RlZCBhYnN0cmFjdCBPYmplY3QgZ2V0\nRGlzY3JpbWluYXRvclZhbHVlKENsYXNzTWFwcGluZyBjbHMpOwoKICAgIC8q\nKgogICAgICogQ29udmVydCB0aGUgZ2l2ZW4gZGlzY3JpbWluYXRvciB2YWx1\nZSB0byB0aGUgY29ycmVzcG9uZGluZyBjbGFzcy4KICAgICAqLwogICAgcHJv\ndGVjdGVkIGFic3RyYWN0IENsYXNzIGdldENsYXNzKE9iamVjdCB2YWwsIEpE\nQkNTdG9yZSBzdG9yZSkKICAgICAgICB0aHJvd3MgQ2xhc3NOb3RGb3VuZEV4\nY2VwdGlvbjsKCiAgICBwdWJsaWMgdm9pZCBtYXAoYm9vbGVhbiBhZGFwdCkg\newogICAgICAgIENsYXNzTWFwcGluZyBjbHMgPSBkaXNjLmdldENsYXNzTWFw\ncGluZygpOwogICAgICAgIGlmIChjbHMuZ2V0Sm9pbmFibGVQQ1N1cGVyY2xh\nc3NNYXBwaW5nKCkgIT0gbnVsbAogICAgICAgICAgICB8fCBjbHMuZ2V0RW1i\nZWRkaW5nTWV0YURhdGEoKSAhPSBudWxsKQogICAgICAgICAgICB0aHJvdyBu\nZXcgTWV0YURhdGFFeGNlcHRpb24oX2xvYy5nZXQoIm5vdC1iYXNlLWRpc2Mi\nLCBjbHMpKTsKCiAgICAgICAgRGlzY3JpbWluYXRvck1hcHBpbmdJbmZvIGlu\nZm8gPSBkaXNjLmdldE1hcHBpbmdJbmZvKCk7CiAgICAgICAgaW5mby5hc3Nl\ncnROb0pvaW4oZGlzYywgdHJ1ZSk7CiAgICAgICAgaW5mby5hc3NlcnROb0Zv\ncmVpZ25LZXkoZGlzYywgIWFkYXB0KTsKICAgICAgICBpbmZvLmFzc2VydE5v\nVW5pcXVlKGRpc2MsIGZhbHNlKTsKCiAgICAgICAgQ29sdW1uIHRtcGxhdGUg\nPSBuZXcgQ29sdW1uKCk7CiAgICAgICAgdG1wbGF0ZS5zZXRKYXZhVHlwZShn\nZXRKYXZhVHlwZSgpKTsKICAgICAgICBEQkRpY3Rpb25hcnkgZGljdCA9IGNs\ncy5nZXRNYXBwaW5nUmVwb3NpdG9yeSgpLmdldERCRGljdGlvbmFyeSgpOwog\nICAgICAgIERCSWRlbnRpZmllciB0eXBOYW1lID0gREJJZGVudGlmaWVyLm5l\nd0NvbHVtbigidHlwIiwgZGljdCAhPSBudWxsID8gZGljdC5kZWxpbWl0QWxs\nKCkgOiBmYWxzZSk7CiAgICAgICAgdG1wbGF0ZS5zZXRJZGVudGlmaWVyKHR5\ncE5hbWUpOwoKICAgICAgICBDb2x1bW5bXSBjb2xzID0gaW5mby5nZXRDb2x1\nbW5zKGRpc2MsIG5ldyBDb2x1bW5bXXsgdG1wbGF0ZSB9LCBhZGFwdCk7CiAg\nICAgICAgZGlzYy5zZXRDb2x1bW5zKGNvbHMpOwogICAgICAgIGRpc2Muc2V0\nQ29sdW1uSU8oaW5mby5nZXRDb2x1bW5JTygpKTsKCiAgICAgICAgSW5kZXgg\naWR4ID0gaW5mby5nZXRJbmRleChkaXNjLCBjb2xzLCBhZGFwdCk7CiAgICAg\nICAgZGlzYy5zZXRJbmRleChpZHgpOwogICAgfQoKICAgIHB1YmxpYyB2b2lk\nIGluc2VydChPcGVuSlBBU3RhdGVNYW5hZ2VyIHNtLCBKREJDU3RvcmUgc3Rv\ncmUsIFJvd01hbmFnZXIgcm0pCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlv\nbiB7CiAgICAgICAgUm93IHJvdyA9IHJtLmdldFJvdyhkaXNjLmdldENsYXNz\nTWFwcGluZygpLmdldFRhYmxlKCksCiAgICAgICAgICAgIFJvdy5BQ1RJT05f\nSU5TRVJULCBzbSwgdHJ1ZSk7CiAgICAgICAgT2JqZWN0IGNscyA9IGdldERp\nc2NyaW1pbmF0b3JWYWx1ZSgoQ2xhc3NNYXBwaW5nKSBzbS5nZXRNZXRhRGF0\nYSgpKTsKICAgICAgICBpZiAoZGlzYy5nZXRDb2x1bW5JTygpLmlzSW5zZXJ0\nYWJsZSgwLCBjbHMgPT0gbnVsbCkpCiAgICAgICAgICAgIHJvdy5zZXRPYmpl\nY3QoZGlzYy5nZXRDb2x1bW5zKClbMF0sIGNscyk7CiAgICB9CgogICAgcHVi\nbGljIGJvb2xlYW4gc2VsZWN0KFNlbGVjdCBzZWwsIENsYXNzTWFwcGluZyBt\nYXBwaW5nKSB7CiAgICAgICAgaWYgKGlzRmluYWwpCiAgICAgICAgICAgIHJl\ndHVybiBmYWxzZTsKICAgICAgICBzZWwuc2VsZWN0KGRpc2MuZ2V0Q29sdW1u\ncygpKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBwdWJsaWMg\nQ2xhc3MgZ2V0Q2xhc3MoSkRCQ1N0b3JlIHN0b3JlLCBDbGFzc01hcHBpbmcg\nYmFzZSwgUmVzdWx0IHJlcykKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9u\nLCBDbGFzc05vdEZvdW5kRXhjZXB0aW9uIHsKICAgICAgICBpZiAoaXNGaW5h\nbCB8fCAhcmVzLmNvbnRhaW5zKGRpc2MuZ2V0Q29sdW1ucygpWzBdKQogICAg\nICAgICAgICB8fCAoYmFzZS5nZXRQQ1N1cGVyY2xhc3MoKSA9PSBudWxsCiAg\nICAgICAgICAgICYmIGJhc2UuZ2V0Sm9pbmFibGVQQ1N1YmNsYXNzTWFwcGlu\nZ3MoKS5sZW5ndGggPT0gMCkpCiAgICAgICAgICAgIHJldHVybiBiYXNlLmdl\ndERlc2NyaWJlZFR5cGUoKTsKCiAgICAgICAgT2JqZWN0IGNscyA9CiAgICAg\nICAgICAgICAgICByZXMuZ2V0T2JqZWN0KGRpc2MuZ2V0Q29sdW1ucygpWzBd\nLCBkaXNjLmdldEphdmFUeXBlKCksIG51bGwpOwogICAgICAgIHJldHVybiBn\nZXRDbGFzcyhjbHMsIHN0b3JlKTsKICAgIH0KCiAgICBwdWJsaWMgYm9vbGVh\nbiBoYXNDbGFzc0NvbmRpdGlvbnMoQ2xhc3NNYXBwaW5nIGJhc2UsIGJvb2xl\nYW4gc3ViY2xhc3NlcykgewogICAgICAgIC8vIGlmIHNlbGVjdGluZyB0aGUg\nZmlyc3QgbWFwcGVkIGNsYXNzIGFuZCBhbGwgc3ViY2xhc3Nlcywgbm8gbmVl\nZAogICAgICAgIC8vIHRvIGxpbWl0IHRoZSBxdWVyeQogICAgICAgIGlmIChp\nc0ZpbmFsIHx8IChiYXNlLmdldEpvaW5hYmxlUENTdXBlcmNsYXNzTWFwcGlu\nZygpID09IG51bGwKICAgICAgICAgICAgJiYgc3ViY2xhc3NlcykpCiAgICAg\nICAgICAgIHJldHVybiBmYWxzZTsKCiAgICAgICAgLy8gaWYgbm8gc3ViY2xh\nc3NlcyBvciBzdXBlcmNsYXNzLCBubyBuZWVkIGZvciBjb25kaXRpb25zCiAg\nICAgICAgQ2xhc3NNYXBwaW5nW10gc3VicyA9IGJhc2UuZ2V0Sm9pbmFibGVQ\nQ1N1YmNsYXNzTWFwcGluZ3MoKTsKICAgICAgICBpZiAoc3Vicy5sZW5ndGgg\nPT0gMCAmJiBiYXNlLmdldEpvaW5hYmxlUENTdXBlcmNsYXNzTWFwcGluZygp\nID09IG51bGwpCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCiAgICAgICAg\ncmV0dXJuIHRydWU7CiAgICB9CgogICAgcHVibGljIFNRTEJ1ZmZlciBnZXRD\nbGFzc0NvbmRpdGlvbnMoU2VsZWN0IHNlbCwgSm9pbnMgam9pbnMsIAogICAg\nICAgIENsYXNzTWFwcGluZyBiYXNlLCBib29sZWFuIHN1YmNsYXNzZXMpIHsK\nICAgICAgICBDb2x1bW4gY29sID0gZGlzYy5nZXRDb2x1bW5zKClbMF07CiAg\nICAgICAgU1FMQnVmZmVyIHNxbCA9IG5ldyBTUUxCdWZmZXIoc2VsLmdldENv\nbmZpZ3VyYXRpb24oKS4KICAgICAgICAgICAgZ2V0REJEaWN0aW9uYXJ5SW5z\ndGFuY2UoKSk7CiAgICAgICAgYm9vbGVhbiBvdXRlciA9IGpvaW5zICE9IG51\nbGwgJiYgam9pbnMuaXNPdXRlcigpOwogICAgICAgIGlmIChvdXRlcikKICAg\nICAgICAgICAgc3FsLmFwcGVuZCgiKCIpOwogICAgICAgIFN0cmluZyBhbGlh\ncyA9IHNlbC5nZXRDb2x1bW5BbGlhcyhjb2wsIGpvaW5zKTsKICAgICAgICBz\ncWwuYXBwZW5kKGFsaWFzKTsKCiAgICAgICAgLy8gaWYgbm90IHNlbGVjdGlu\nZyBzdWJjbGFzc2VzLCBsaW1pdCB0byBqdXN0IHRoZSBnaXZlbiBjbGFzcwog\nICAgICAgIENsYXNzTWFwcGluZ1tdIHN1YnMgPSBiYXNlLmdldEpvaW5hYmxl\nUENTdWJjbGFzc01hcHBpbmdzKCk7CiAgICAgICAgaWYgKCFvdXRlciAmJiAo\nIXN1YmNsYXNzZXMgfHwgc3Vicy5sZW5ndGggPT0gMCkpCiAgICAgICAgICAg\nIHJldHVybiBzcWwuYXBwZW5kKCIgPSAiKS5hcHBlbmRWYWx1ZShnZXREaXNj\ncmltaW5hdG9yVmFsdWUoYmFzZSksCiAgICAgICAgICAgICAgICBjb2wpOwoK\nICAgICAgICBpZiAob3V0ZXIpCiAgICAgICAgICAgIHNxbC5hcHBlbmQoIiBJ\nUyAiKS5hcHBlbmRWYWx1ZShudWxsKS5hcHBlbmQoIiBPUiAiKS5hcHBlbmQo\nYWxpYXMpOwogICAgICAgIHNxbC5hcHBlbmQoIiBJTiAoIik7CiAgICAgICAg\nc3FsLmFwcGVuZFZhbHVlKGdldERpc2NyaW1pbmF0b3JWYWx1ZShiYXNlKSwg\nY29sKTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IHN1YnMubGVuZ3Ro\nOyBpKyspCiAgICAgICAgICAgIHNxbC5hcHBlbmQoIiwgIikuYXBwZW5kVmFs\ndWUoZ2V0RGlzY3JpbWluYXRvclZhbHVlKHN1YnNbaV0pLCBjb2wpOwogICAg\nICAgIHNxbC5hcHBlbmQoIikiKTsKICAgICAgICBpZiAob3V0ZXIpCiAgICAg\nICAgICAgIHNxbC5hcHBlbmQoIikiKTsKICAgICAgICByZXR1cm4gc3FsOwog\nICAgfQp9Cg==\n","encoding":"base64"}

