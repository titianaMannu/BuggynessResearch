{"sha":"8f1551951ccb42aed58fbb28b27e79ed0007934f","node_id":"MDQ6QmxvYjIwNjM2NDo4ZjE1NTE5NTFjY2I0MmFlZDU4ZmJiMjhiMjdlNzllZDAwMDc5MzRm","size":12113,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/8f1551951ccb42aed58fbb28b27e79ed0007934f","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhLnN0cmF0czsK\nCmltcG9ydCBqYXZhLnNxbC5TUUxFeGNlcHRpb247CmltcG9ydCBqYXZhLnV0\naWwuQml0U2V0OwppbXBvcnQgamF2YS51dGlsLkNvbGxlY3Rpb247CgppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuaWRlbnRpZmllci5Ob3JtYWxp\nemVyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMua2VybmVsLkpE\nQkNTdG9yZTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLm1ldGEu\nQ2xhc3NNYXBwaW5nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMu\nbWV0YS5GaWVsZE1hcHBpbmc7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\namRiYy5zY2hlbWEuQ29sdW1uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLmpkYmMuc2NoZW1hLlRhYmxlOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLmpkYmMuc3FsLkRCRGljdGlvbmFyeTsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5qZGJjLnNxbC5Sb3c7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\namRiYy5zcWwuUm93SW1wbDsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5q\nZGJjLnNxbC5Sb3dNYW5hZ2VyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLmtlcm5lbC5PcGVuSlBBU3RhdGVNYW5hZ2VyOwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLmtlcm5lbC5TdG9yZU1hbmFnZXI7CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEubGliLmlkZW50aWZpZXIuSWRlbnRpZmllckNvbmZpZ3Vy\nYXRpb247CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuTG9j\nYWxpemVyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuQXJyYXlT\ndGF0ZUltYWdlOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuSW50\nZXJuYWxFeGNlcHRpb247CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRp\nbC5NZXRhRGF0YUV4Y2VwdGlvbjsKCi8qKgogKiBVc2VzIGEgc3RhdGUgaW1h\nZ2UgdG8gZGV0ZXJtaW5lIHdoZXRoZXIgY29uY3VycmVuY3kgdmlvbGF0aW9u\ncyB0YWtlIHBsYWNlLgogKgogKiBAYXV0aG9yIEFiZSBXaGl0ZQogKi8KcHVi\nbGljIGNsYXNzIFN0YXRlQ29tcGFyaXNvblZlcnNpb25TdHJhdGVneQogICAg\nZXh0ZW5kcyBBYnN0cmFjdFZlcnNpb25TdHJhdGVneSB7CgogICAgcHVibGlj\nIHN0YXRpYyBmaW5hbCBTdHJpbmcgQUxJQVMgPSAic3RhdGUtY29tcGFyaXNv\nbiI7CgogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgTG9jYWxpemVyIF9sb2Mg\nPSBMb2NhbGl6ZXIuZm9yUGFja2FnZQogICAgICAgIChTdGF0ZUNvbXBhcmlz\nb25WZXJzaW9uU3RyYXRlZ3kuY2xhc3MpOwoKICAgIHB1YmxpYyBTdHJpbmcg\nZ2V0QWxpYXMoKSB7CiAgICAgICAgcmV0dXJuIEFMSUFTOwogICAgfQoKICAg\nIHB1YmxpYyB2b2lkIG1hcChib29sZWFuIGFkYXB0KSB7CiAgICAgICAgQ2xh\nc3NNYXBwaW5nIGNscyA9IHZlcnMuZ2V0Q2xhc3NNYXBwaW5nKCk7CiAgICAg\nICAgaWYgKGNscy5nZXRKb2luYWJsZVBDU3VwZXJjbGFzc01hcHBpbmcoKSAh\nPSBudWxsCiAgICAgICAgICAgIHx8IGNscy5nZXRFbWJlZGRpbmdNZXRhRGF0\nYSgpICE9IG51bGwpCiAgICAgICAgICAgIHRocm93IG5ldyBNZXRhRGF0YUV4\nY2VwdGlvbihfbG9jLmdldCgibm90LWJhc2UtdmVycyIsIGNscykpOwoKICAg\nICAgICB2ZXJzLmdldE1hcHBpbmdJbmZvKCkuYXNzZXJ0Tm9TY2hlbWFDb21w\nb25lbnRzKHZlcnMsIHRydWUpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIGlu\nc2VydChPcGVuSlBBU3RhdGVNYW5hZ2VyIHNtLCBKREJDU3RvcmUgc3RvcmUs\nIFJvd01hbmFnZXIgcm0pCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7\nCiAgICAgICAgRmllbGRNYXBwaW5nW10gZmllbGRzID0gKEZpZWxkTWFwcGlu\nZ1tdKSBzbS5nZXRNZXRhRGF0YSgpLmdldEZpZWxkcygpOwogICAgICAgIE9i\namVjdFtdIHN0YXRlID0gQXJyYXlTdGF0ZUltYWdlLm5ld0ltYWdlKGZpZWxk\ncy5sZW5ndGgpOwogICAgICAgIEJpdFNldCBsb2FkZWQgPSBBcnJheVN0YXRl\nSW1hZ2UuZ2V0TG9hZGVkKHN0YXRlKTsKCiAgICAgICAgLy8gdGFrZSBhIHNu\nYXBzaG90IG9mIGFsbCB2ZXJzaW9uYWJsZSBmaWVsZCB2YWx1ZXMKICAgICAg\nICBmb3IgKGludCBpID0gMDsgaSA8IGZpZWxkcy5sZW5ndGg7IGkrKykgewog\nICAgICAgICAgICBpZiAoIWZpZWxkc1tpXS5pc1ByaW1hcnlLZXkoKSAmJiBm\naWVsZHNbaV0uaXNWZXJzaW9uYWJsZSgpKSB7CiAgICAgICAgICAgICAgICBs\nb2FkZWQuc2V0KGkpOwogICAgICAgICAgICAgICAgc3RhdGVbaV0gPSBzbS5m\nZXRjaChmaWVsZHNbaV0uZ2V0SW5kZXgoKSk7CiAgICAgICAgICAgIH0KICAg\nICAgICB9CiAgICAgICAgc20uc2V0TmV4dFZlcnNpb24oc3RhdGUpOwogICAg\nfQoKICAgIC8qKgogICAgICogVGhpcyBtZXRob2QgaXMgZm9yIGNsYXNzIG1h\ncHBpbmdzIHRoYXQgdGFrZSBvdmVyIHRoZSBpbnNlcnQKICAgICAqIHByb2Nl\nc3MsIGJ1dCBzdGlsbCB3YW50IHRvIHVzZSB0aGlzIGluZGljYXRvciBmb3Ig\nb3B0aW1pc3RpYyBsb2NraW5nLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBj\ndXN0b21JbnNlcnQoT3BlbkpQQVN0YXRlTWFuYWdlciBzbSwgSkRCQ1N0b3Jl\nIHN0b3JlKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAg\nIGluc2VydChzbSwgc3RvcmUsIG51bGwpOwogICAgfQoKICAgIHB1YmxpYyB2\nb2lkIHVwZGF0ZShPcGVuSlBBU3RhdGVNYW5hZ2VyIHNtLCBKREJDU3RvcmUg\nc3RvcmUsIFJvd01hbmFnZXIgcm0pCiAgICAgICAgdGhyb3dzIFNRTEV4Y2Vw\ndGlvbiB7CiAgICAgICAgLy8gaWYgdGhlcmUgaXMgbm8gcmVjb3JkZWQgc3Rh\ndGUgKGZvciBleGFtcGxlLCBtb2RpZmljYXRpb24gbWFkZSB0bwogICAgICAg\nIC8vIGhvbGxvdyBpbnN0YW5jZSBhbmQgbm8gZmllbGRzIGV2ZXJ5IGxvYWRl\nZCksIGNhbid0IGRvIGFueXRoaW5nCiAgICAgICAgT2JqZWN0W10gc3RhdGUg\nPSAoT2JqZWN0W10pIHNtLmdldFZlcnNpb24oKTsKICAgICAgICBpZiAoc3Rh\ndGUgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuOwoKICAgICAgICBCaXRT\nZXQgbG9hZGVkID0gQXJyYXlTdGF0ZUltYWdlLmdldExvYWRlZChzdGF0ZSk7\nCiAgICAgICAgT2JqZWN0W10gbmV4dFN0YXRlID0gQXJyYXlTdGF0ZUltYWdl\nLmNsb25lKHN0YXRlKTsKCiAgICAgICAgLy8gbG9vcCB0aHJvdWdoIGZpZWxk\ncyBhbmQgdXBkYXRlIGNoYW5naW5nIHZhbHVlcyBmb3IgdGhlIG5leHQgc3Rh\ndGUKICAgICAgICAvLyBpbWFnZSwgcGx1cyBhZGQgV0hFUkUgY29uZGl0aW9u\ncyBvbiB1cGRhdGVzIHRvIG1ha2Ugc3VyZSB0aGF0CiAgICAgICAgLy8gZGIg\ndmFsdWVzIG1hdGNoIG91ciBwcmV2aW91cyBpbWFnZQogICAgICAgIEZpZWxk\nTWFwcGluZ1tdIGZpZWxkcyA9IChGaWVsZE1hcHBpbmdbXSkgc20uZ2V0TWV0\nYURhdGEoKS5nZXRGaWVsZHMoKTsKICAgICAgICBSb3cgcm93OwogICAgICAg\nIGlmIChzbS5pc1ZlcnNpb25DaGVja1JlcXVpcmVkKCkpIHsKICAgICAgICAg\nICAgZm9yIChpbnQgaSA9IDAsIG1heCA9IGxvYWRlZC5sZW5ndGgoKTsgaSA8\nIG1heDsgaSsrKSB7CiAgICAgICAgICAgICAgICBpZiAoIWxvYWRlZC5nZXQo\naSkpCiAgICAgICAgICAgICAgICAgICAgY29udGludWU7CgogICAgICAgICAg\nICAgICAgLy8gdXBkYXRlIG91ciBuZXh0IHN0YXRlIGltYWdlIHdpdGggdGhl\nIG5ldyBmaWVsZCB2YWx1ZQogICAgICAgICAgICAgICAgaWYgKHNtLmdldERp\ncnR5KCkuZ2V0KGkpICYmICFzbS5nZXRGbHVzaGVkKCkuZ2V0KGkpKQogICAg\nICAgICAgICAgICAgICAgIG5leHRTdGF0ZVtpXSA9IHNtLmZldGNoKGZpZWxk\nc1tpXS5nZXRJbmRleCgpKTsKCiAgICAgICAgICAgICAgICAvLyBmZXRjaCB0\naGUgcm93IGZvciB0aGlzIGZpZWxkOyBpZiBubyByb3cgZXhpc3RzLCB0aGVu\nIHdlIGNhbid0CiAgICAgICAgICAgICAgICAvLyBhZGQgb25lIGJlY2F1c2Ug\nd2UgaGF2ZSBubyB1cGRhdGVzIHRvIHBlcmZvcm07IHRoYXQgbWVhbnMgd2UK\nICAgICAgICAgICAgICAgIC8vIHdvbid0IGRldGVjdCBPTCBleGNlcHRpb25z\nIHdoZW4gYW5vdGhlciB0cmFuc2FjdGlvbiBjaGFuZ2VzCiAgICAgICAgICAg\nICAgICAvLyBmaWVsZHMgdGhhdCBhcmVuJ3QgaW4gYW55IG9mIHRoZSBzYW1l\nIHRhYmxlcyBhcyBmaWVsZHMgdGhhdAogICAgICAgICAgICAgICAgLy8gdGhp\ncyB0cmFuc2FjdGlvbiBjaGFuZ2VkCiAgICAgICAgICAgICAgICByb3cgPSBy\nbS5nZXRSb3coZmllbGRzW2ldLmdldFRhYmxlKCksIFJvdy5BQ1RJT05fVVBE\nQVRFLAogICAgICAgICAgICAgICAgICAgIHNtLCBmYWxzZSk7CiAgICAgICAg\nICAgICAgICBpZiAocm93ID09IG51bGwpCiAgICAgICAgICAgICAgICAgICAg\nY29udGludWU7CgogICAgICAgICAgICAgICAgLy8gc2V0IFdIRVJFIGNyaXRl\ncmlhIG1hdGNoaW5nIHRoZSBwcmV2aW91cyBzdGF0ZSBpbWFnZSBzbyB0aGUK\nICAgICAgICAgICAgICAgIC8vIHVwZGF0ZSB3aWxsIGZhaWwgZm9yIGFueSBj\naGFuZ2VzIG1hZGUgYnkgYW5vdGhlciB0cmFuc2FjdGlvbgogICAgICAgICAg\nICAgICAgZmllbGRzW2ldLndoZXJlKHNtLCBzdG9yZSwgcm0sIHN0YXRlW2ld\nKTsKICAgICAgICAgICAgICAgIHJvdy5zZXRGYWlsZWRPYmplY3Qoc20uZ2V0\nTWFuYWdlZEluc3RhbmNlKCkpOwogICAgICAgICAgICB9CiAgICAgICAgfQog\nICAgICAgIHNtLnNldE5leHRWZXJzaW9uKG5leHRTdGF0ZSk7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBUaGlzIG1ldGhvZCBpcyBmb3IgY2xhc3MgbWFwcGlu\nZ3MgdGhhdCB0YWtlIG92ZXIgdGhlIHVwZGF0ZQogICAgICogcHJvY2Vzcywg\nYnV0IHN0aWxsIHdhbnQgdG8gdXNlIHRoaXMgaW5kaWNhdG9yIGZvciBvcHRp\nbWlzdGljIGxvY2tpbmcuCiAgICAgKgogICAgICogQHBhcmFtIHNtIHRoZSBp\nbnN0YW5jZSB0byB0ZXN0CiAgICAgKiBAcGFyYW0gc3RvcmUgc3RvcmUgbWFu\nYWdlciBjb250ZXh0CiAgICAgKiBAcGFyYW0gdGFibGUgb25seSBzdGF0ZSBp\nbWFnZSB2YWx1ZXMgaW4gdGhpcyB0YWJsZSB3aWxsIGJlIHRlc3RlZDsKICAg\nICAqIGlmIHRoZSBjdXN0b20gbWFwcGluZyB1c2VzIGRpZmZlcmVudCB1cGRh\ndGVzIGZvcgogICAgICogZGlmZmVyZW50IHRhYmxlcywgdGhpcyBtZXRob2Qg\nY2FuIGJlIGNhbGxlZCBtdWx0aXBsZQogICAgICogdGltZXMgZm9yIHRoZSBt\ndWx0aXBsZSB0YWJsZXMKICAgICAqIEBwYXJhbSByZWNvcmQgc2V0IHRoaXMg\ncGFyYW1ldGVyIHRvIHRydWUgdGhlIGxhc3QgdGltZSB5b3UgY2FsbAogICAg\nICogdGhpcyBtZXRob2QsIHNvIHRoZSBpbmRpY2F0b3IgY2FuIHNldHVwIHRo\nZSBuZXh0CiAgICAgKiB2ZXJzaW9uIG9mIHRoZSBnaXZlbiBzdGF0ZSBtYW5h\nZ2VyCiAgICAgKiBAcmV0dXJuIGEge0BsaW5rIEN1c3RvbVVwZGF0ZX0gd2hv\nc2UgZ2V0U1FMIG1ldGhvZCB5aWVsZHMgYQogICAgICogYm9vbGVhbiBTUUwg\nZXhwcmVzc2lvbiB0aGF0IHRlc3RzIHdoZXRoZXIgdGhlIGN1cnJlbnQKICAg\nICAqIHJlY29yZCBpcyBlcXVhbCB0byBvdXIgcmVjb3JkZWQgc3RhdGUgaW1h\nZ2UsIGFuZCB3aG9zZQogICAgICogc2V0UGFyYW1ldGVycyBtZXRob2QgcGFy\nYW1ldGVyaXplcyB0aGUgZ2l2ZW4gcHJlcGFyZWQKICAgICAqIHN0YXRlbWVu\ndCB3aXRoIHRoZSB2YWx1ZXMgdXNlZCBpbiB0aGUgYWJvdmUgYm9vbGVhbiBl\neHByZXNzaW9uCiAgICAgKi8KICAgIHB1YmxpYyBDdXN0b21VcGRhdGUgY3Vz\ndG9tVXBkYXRlKE9wZW5KUEFTdGF0ZU1hbmFnZXIgc20sIEpEQkNTdG9yZSBz\ndG9yZSwKICAgICAgICBUYWJsZSB0YWJsZSwgYm9vbGVhbiByZWNvcmQpCiAg\nICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgQ3VzdG9tVXBk\nYXRlIGN1c3RvbSA9IG5ldyBDdXN0b21VcGRhdGUodGFibGUpOwogICAgICAg\nIE9iamVjdFtdIHN0YXRlID0gKE9iamVjdFtdKSBzbS5nZXRWZXJzaW9uKCk7\nCiAgICAgICAgaWYgKHN0YXRlID09IG51bGwpCiAgICAgICAgICAgIHJldHVy\nbiBjdXN0b207CgogICAgICAgIEJpdFNldCBsb2FkZWQgPSBBcnJheVN0YXRl\nSW1hZ2UuZ2V0TG9hZGVkKHN0YXRlKTsKICAgICAgICBPYmplY3RbXSBuZXh0\nU3RhdGUgPSBudWxsOwogICAgICAgIGlmIChyZWNvcmQpCiAgICAgICAgICAg\nIG5leHRTdGF0ZSA9IEFycmF5U3RhdGVJbWFnZS5jbG9uZShzdGF0ZSk7Cgog\nICAgICAgIEZpZWxkTWFwcGluZ1tdIGZpZWxkcyA9IChGaWVsZE1hcHBpbmdb\nXSkgc20uZ2V0TWV0YURhdGEoKS5nZXRGaWVsZHMoKTsKICAgICAgICBmb3Ig\nKGludCBpID0gMCwgbWF4ID0gbG9hZGVkLmxlbmd0aCgpOyBpIDwgbWF4OyBp\nKyspIHsKICAgICAgICAgICAgaWYgKCFsb2FkZWQuZ2V0KGkpKQogICAgICAg\nICAgICAgICAgY29udGludWU7CgogICAgICAgICAgICBpZiAocmVjb3JkICYm\nIHNtLmdldERpcnR5KCkuZ2V0KGkpICYmICFzbS5nZXRGbHVzaGVkKCkuZ2V0\nKGkpKQogICAgICAgICAgICAgICAgbmV4dFN0YXRlW2ldID0gc20uZmV0Y2go\nZmllbGRzW2ldLmdldEluZGV4KCkpOwogICAgICAgICAgICBpZiAoZmllbGRz\nW2ldLmdldFRhYmxlKCkgPT0gdGFibGUpCiAgICAgICAgICAgICAgICBmaWVs\nZHNbaV0ud2hlcmUoc20sIHN0b3JlLCBjdXN0b20sIHN0YXRlW2ldKTsKICAg\nICAgICB9CiAgICAgICAgaWYgKHJlY29yZCkKICAgICAgICAgICAgc20uc2V0\nTmV4dFZlcnNpb24obmV4dFN0YXRlKTsKCiAgICAgICAgcmV0dXJuIGN1c3Rv\nbTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBhZnRlckxvYWQoT3BlbkpQQVN0\nYXRlTWFuYWdlciBzbSwgSkRCQ1N0b3JlIHN0b3JlKSB7CiAgICAgICAgRmll\nbGRNYXBwaW5nW10gZmllbGRzID0gKEZpZWxkTWFwcGluZ1tdKSBzbS5nZXRN\nZXRhRGF0YSgpLmdldEZpZWxkcygpOwoKICAgICAgICBPYmplY3RbXSBzdGF0\nZSA9IChPYmplY3RbXSkgc20uZ2V0VmVyc2lvbigpOwogICAgICAgIGlmIChz\ndGF0ZSA9PSBudWxsKQogICAgICAgICAgICBzdGF0ZSA9IEFycmF5U3RhdGVJ\nbWFnZS5uZXdJbWFnZShmaWVsZHMubGVuZ3RoKTsKICAgICAgICBCaXRTZXQg\nbG9hZGVkID0gQXJyYXlTdGF0ZUltYWdlLmdldExvYWRlZChzdGF0ZSk7Cgog\nICAgICAgIC8vIHRha2UgYSBzbmFwc2hvdCBvZiBhbGwgdmVyc2lvbmFibGUg\nZmllbGQgdmFsdWVzIHRoYXQgd2VyZSBsb2FkZWQKICAgICAgICBmb3IgKGlu\ndCBpID0gMDsgaSA8IGZpZWxkcy5sZW5ndGg7IGkrKykgewogICAgICAgICAg\nICBpZiAoIWZpZWxkc1tpXS5pc1ByaW1hcnlLZXkoKQogICAgICAgICAgICAg\nICAgJiYgZmllbGRzW2ldLmlzVmVyc2lvbmFibGUoKQogICAgICAgICAgICAg\nICAgJiYgc20uZ2V0TG9hZGVkKCkuZ2V0KGZpZWxkc1tpXS5nZXRJbmRleCgp\nKQogICAgICAgICAgICAgICAgJiYgIWxvYWRlZC5nZXQoaSkKICAgICAgICAg\nICAgICAgICYmICFzbS5nZXREaXJ0eSgpLmdldChmaWVsZHNbaV0uZ2V0SW5k\nZXgoKSkpIHsKICAgICAgICAgICAgICAgIGxvYWRlZC5zZXQoaSk7CiAgICAg\nICAgICAgICAgICBzdGF0ZVtpXSA9IHNtLmZldGNoKGZpZWxkc1tpXS5nZXRJ\nbmRleCgpKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBzbS5z\nZXRWZXJzaW9uKHN0YXRlKTsKICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBj\naGVja1ZlcnNpb24oT3BlbkpQQVN0YXRlTWFuYWdlciBzbSwgSkRCQ1N0b3Jl\nIHN0b3JlLAogICAgICAgIGJvb2xlYW4gdXBkYXRlVmVyc2lvbikKICAgICAg\nICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBpZiAodXBkYXRlVmVy\nc2lvbikKICAgICAgICAgICAgc20uc2V0VmVyc2lvbihudWxsKTsKICAgICAg\nICByZXR1cm4gIXVwZGF0ZVZlcnNpb247CiAgICB9CgogICAgcHVibGljIGlu\ndCBjb21wYXJlVmVyc2lvbihPYmplY3QgdjEsIE9iamVjdCB2MikgewogICAg\nICAgIHJldHVybiAoQXJyYXlTdGF0ZUltYWdlLnNhbWVWZXJzaW9uKChPYmpl\nY3RbXSkgdjEsIChPYmplY3RbXSkgdjIpKQogICAgICAgICAgICA/IFN0b3Jl\nTWFuYWdlci5WRVJTSU9OX1NBTUUgOiBTdG9yZU1hbmFnZXIuVkVSU0lPTl9E\nSUZGRVJFTlQ7CiAgICB9CgogICAgLyoqCiAgICAgKiBSb3cgaW1wbGVtZW50\nYXRpb24gd2UgdXNlIHRvIHBhc3MgdG8gdmVyc2lvbmFibGUgbWFwcGluZ3Mg\nc28gdGhleQogICAgICogY2FuIHNldCB1cCB0aGUgd2hlcmUgY29uZGl0aW9u\ncyB3ZSBuZWVkIHRvIGFkZCB0byB1cGRhdGUgc3RhdGVtZW50cy4KICAgICAq\nCiAgICAgKiBAYXV0aG9yIEFiZSBXaGl0ZQogICAgICovCiAgICBwdWJsaWMg\nc3RhdGljIGNsYXNzIEN1c3RvbVVwZGF0ZQogICAgICAgIGV4dGVuZHMgUm93\nSW1wbAogICAgICAgIGltcGxlbWVudHMgUm93TWFuYWdlciB7CgogICAgICAg\nIHByaXZhdGUgQ3VzdG9tVXBkYXRlKFRhYmxlIHRhYmxlKSB7CiAgICAgICAg\nICAgIHRoaXModGFibGUuZ2V0Q29sdW1ucygpKTsKICAgICAgICB9CgogICAg\nICAgIHByaXZhdGUgQ3VzdG9tVXBkYXRlKENvbHVtbltdIGNvbHMpIHsKICAg\nICAgICAgICAgc3VwZXIoY29scywgUm93LkFDVElPTl9VUERBVEUpOwogICAg\nICAgIH0KCiAgICAgICAgLyoqCiAgICAgICAgICogUmV0dXJuIGEgYm9vbGVh\nbiBTUUwgZXhwcmVzc2lvbiB0aGF0IHNob3VsZCBiZSBhZGRlZCB0byB0aGUK\nICAgICAgICAgKiBXSEVSRSBjbGF1c2Ugb2YgYW4gVVBEQVRFIHRvIHRlc3Qg\nd2hldGhlciB0aGUgY3VycmVudCBkYXRhYmFzZQogICAgICAgICAqIHJlY29y\nZCBtYXRjaGVzIG91ciBzdG9yZWQgdmVyc2lvbi4KICAgICAgICAgKi8KICAg\nICAgICBwdWJsaWMgU3RyaW5nIGdldFNRTChEQkRpY3Rpb25hcnkgZGljdCkg\newogICAgICAgICAgICBDb2x1bW5bXSBjb2xzID0gZ2V0VGFibGUoKS5nZXRD\nb2x1bW5zKCk7CiAgICAgICAgICAgIFN0cmluZ0J1aWxkZXIgYnVmID0gbmV3\nIFN0cmluZ0J1aWxkZXIoKTsKICAgICAgICAgICAgYm9vbGVhbiBoYXNXaGVy\nZSA9IGZhbHNlOwogICAgICAgICAgICBPYmplY3QgdmFsOwogICAgICAgICAg\nICBmb3IgKGludCBpID0gMDsgaSA8IGNvbHMubGVuZ3RoOyBpKyspIHsKICAg\nICAgICAgICAgICAgIHZhbCA9IGdldFdoZXJlKGNvbHNbaV0pOwogICAgICAg\nICAgICAgICAgaWYgKHZhbCA9PSBudWxsKQogICAgICAgICAgICAgICAgICAg\nIGNvbnRpbnVlOwoKICAgICAgICAgICAgICAgIGlmIChoYXNXaGVyZSkKICAg\nICAgICAgICAgICAgICAgICBidWYuYXBwZW5kKCIgQU5EICIpOwogICAgICAg\nICAgICAgICAgaWYgKHZhbCA9PSBOVUxMKQogICAgICAgICAgICAgICAgICAg\nIGJ1Zi5hcHBlbmQoZGljdC5nZXRDb2x1bW5EQk5hbWUoY29sc1tpXSkgKyAi\nIElTIE5VTEwiKTsKICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAg\nICAgICAgICBidWYuYXBwZW5kKGRpY3QuZ2V0Q29sdW1uREJOYW1lKGNvbHNb\naV0pICsgIiA9ID8iKTsKICAgICAgICAgICAgICAgIGhhc1doZXJlID0gdHJ1\nZTsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gYnVmLnRvU3Ry\naW5nKCk7CiAgICAgICAgfQoKICAgICAgICBwcm90ZWN0ZWQgUm93SW1wbCBu\nZXdJbnN0YW5jZShDb2x1bW5bXSBjb2xzLCBpbnQgYWN0aW9uKSB7CiAgICAg\nICAgICAgIHJldHVybiBuZXcgQ3VzdG9tVXBkYXRlKGNvbHMpOwogICAgICAg\nIH0KCiAgICAgICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KICAg\nICAgICAvLyBSb3dNYW5hZ2VyIGltcGxlbWVudGF0aW9uCiAgICAgICAgLy8v\nLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KCiAgICAgICAgcHVibGljIGJv\nb2xlYW4gaGFzQXV0b0Fzc2lnbkNvbnN0cmFpbnRzKCkgewogICAgICAgICAg\nICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgQ29s\nbGVjdGlvbiBnZXRJbnNlcnRzKCkgewogICAgICAgICAgICB0aHJvdyBuZXcg\nSW50ZXJuYWxFeGNlcHRpb24oKTsKICAgICAgICB9CgogICAgICAgIHB1Ymxp\nYyBDb2xsZWN0aW9uIGdldFVwZGF0ZXMoKSB7CiAgICAgICAgICAgIHRocm93\nIG5ldyBJbnRlcm5hbEV4Y2VwdGlvbigpOwogICAgICAgIH0KCiAgICAgICAg\ncHVibGljIENvbGxlY3Rpb24gZ2V0RGVsZXRlcygpIHsKICAgICAgICAgICAg\ndGhyb3cgbmV3IEludGVybmFsRXhjZXB0aW9uKCk7CiAgICAgICAgfQoKICAg\nICAgICBwdWJsaWMgQ29sbGVjdGlvbiBnZXRTZWNvbmRhcnlVcGRhdGVzKCkg\newogICAgICAgICAgICB0aHJvdyBuZXcgSW50ZXJuYWxFeGNlcHRpb24oKTsK\nICAgICAgICB9CgogICAgICAgIHB1YmxpYyBDb2xsZWN0aW9uIGdldFNlY29u\nZGFyeURlbGV0ZXMoKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBJbnRlcm5h\nbEV4Y2VwdGlvbigpOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIENvbGxl\nY3Rpb24gZ2V0QWxsUm93VXBkYXRlcygpIHsKICAgICAgICAgICAgdGhyb3cg\nbmV3IEludGVybmFsRXhjZXB0aW9uKCk7CiAgICAgICAgfQoKICAgICAgICBw\ndWJsaWMgQ29sbGVjdGlvbiBnZXRBbGxSb3dEZWxldGVzKCkgewogICAgICAg\nICAgICB0aHJvdyBuZXcgSW50ZXJuYWxFeGNlcHRpb24oKTsKICAgICAgICB9\nCgogICAgICAgIHB1YmxpYyBSb3cgZ2V0Um93KFRhYmxlIHRhYmxlLCBpbnQg\nYWN0aW9uLCBPcGVuSlBBU3RhdGVNYW5hZ2VyIHNtLAogICAgICAgICAgICBi\nb29sZWFuIGNyZWF0ZSkgewogICAgICAgICAgICAvLyB2ZXJpb25hYmxlIG1h\ncHBpbmdzIHdpbGwgbmV2ZXIgd2FudCB0byBjcmVhdGUgcm93cywgc28gd2UK\nICAgICAgICAgICAgLy8gY2FuIGFsd2F5cyBzYWZlbHkgcmV0dXJuIG51bGwK\nICAgICAgICAgICAgaWYgKHRhYmxlICE9IGdldFRhYmxlKCkpCiAgICAgICAg\nICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICAgICAgcmV0dXJuIHRoaXM7\nCiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgUm93IGdldFNlY29uZGFyeVJv\ndyhUYWJsZSB0YWJsZSwgaW50IGFjdGlvbikgewogICAgICAgICAgICB0aHJv\ndyBuZXcgSW50ZXJuYWxFeGNlcHRpb24oKTsKICAgICAgICB9CgogICAgICAg\nIHB1YmxpYyB2b2lkIGZsdXNoU2Vjb25kYXJ5Um93KFJvdyByb3cpIHsKICAg\nICAgICB9CgogICAgICAgIHB1YmxpYyBSb3cgZ2V0QWxsUm93cyhUYWJsZSB0\nYWJsZSwgaW50IGFjdGlvbikgewogICAgICAgICAgICB0aHJvdyBuZXcgSW50\nZXJuYWxFeGNlcHRpb24oKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyB2\nb2lkIGZsdXNoQWxsUm93cyhSb3cgcm93KSB7CiAgICAgICAgfQoKICAgICAg\nICBwdWJsaWMgdm9pZCBzZXRPYmplY3QoQ29sdW1uIGNvbCwgT2JqZWN0IHZh\nbCkKICAgICAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAg\nICAgIHRocm93IG5ldyBJbnRlcm5hbEV4Y2VwdGlvbigpOwogICAgICAgIH0K\nICAgIH0KfQo=\n","encoding":"base64"}

