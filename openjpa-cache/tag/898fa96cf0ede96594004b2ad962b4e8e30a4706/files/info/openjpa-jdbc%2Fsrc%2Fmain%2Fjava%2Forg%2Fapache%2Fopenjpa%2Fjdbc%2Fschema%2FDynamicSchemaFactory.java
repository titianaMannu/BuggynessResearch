{"sha":"c29401d999edb6ab2cccaf4c0176c0b4c8e4509a","node_id":"MDQ6QmxvYjIwNjM2NDpjMjk0MDFkOTk5ZWRiNmFiMmNjY2FmNGMwMTc2YzBiNGM4ZTQ1MDlh","size":6982,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/c29401d999edb6ab2cccaf4c0176c0b4c8e4509a","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hlbWE7CgppbXBv\ncnQgamF2YS5zcWwuVHlwZXM7CgppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLmpkYmMuY29uZi5KREJDQ29uZmlndXJhdGlvbjsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5qZGJjLmlkZW50aWZpZXIuTm9ybWFsaXplcjsKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLmlkZW50aWZpZXIuREJJZGVudGlm\naWVyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuaWRlbnRpZmll\nci5RdWFsaWZpZWREQklkZW50aWZpZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEuamRiYy5zcWwuREJEaWN0aW9uYXJ5OwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLmxpYi5jb25mLkNvbmZpZ3VyYWJsZTsKaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS5saWIuY29uZi5Db25maWd1cmF0aW9uOwoKLyoqCiAq\nIEZhY3Rvcnkgd2hvc2Ugc2NoZW1hIGdyb3VwIGR5bmFtaWNhbGx5IGZpbGxz\nIGl0c2VsZiB3aXRoIGluZm9ybWF0aW9uCiAqIGFzIG1hcHBpbmdzIHZhbGlk\nYXRlIHRoZW1zZWx2ZXMgaW4gdGhlaXIgPGNvZGU+bWFwPC9jb2RlPiBtZXRo\nb2QuCiAqIFRhYmxlcyBhcmUgYWRkZWQgd2hlbiB7QGxpbmsgU2NoZW1hR3Jv\ndXAjZmluZFRhYmxlfSBpcyBjYWxsZWQuIENvbHVtbnMKICogYXJlIGFkZGVk\nIHRvIHRhYmxlcyB3aGVuIHtAbGluayBUYWJsZSNnZXRDb2x1bW59IGlzIGNh\nbGxlZC4gQW5kIHRoZQogKiBjb2x1bW4gdHlwZXMgYXJlIHNldCB3aGVuIHtA\nbGluayBDb2x1bW4jaXNDb21wYXRpYmxlfSBpcyBjYWxsZWQuCiAqCiAqIEBh\ndXRob3IgQWJlIFdoaXRlCiAqLwpAU3VwcHJlc3NXYXJuaW5ncygic2VyaWFs\nIikKcHVibGljIGNsYXNzIER5bmFtaWNTY2hlbWFGYWN0b3J5CiAgICBleHRl\nbmRzIFNjaGVtYUdyb3VwCiAgICBpbXBsZW1lbnRzIFNjaGVtYUZhY3Rvcnks\nIENvbmZpZ3VyYWJsZSB7CgogICAgcHJpdmF0ZSB0cmFuc2llbnQgREJEaWN0\naW9uYXJ5IF9kaWN0ID0gbnVsbDsKICAgIHByaXZhdGUgREJJZGVudGlmaWVy\nIF9zY2hlbWEgPSBEQklkZW50aWZpZXIuTlVMTDsKCiAgICBwdWJsaWMgdm9p\nZCBzZXRDb25maWd1cmF0aW9uKENvbmZpZ3VyYXRpb24gY29uZikgewogICAg\nICAgIEpEQkNDb25maWd1cmF0aW9uIGpjb25mID0gKEpEQkNDb25maWd1cmF0\naW9uKSBjb25mOwogICAgICAgIF9kaWN0ID0gamNvbmYuZ2V0REJEaWN0aW9u\nYXJ5SW5zdGFuY2UoKTsKICAgICAgICBfc2NoZW1hID0gREJJZGVudGlmaWVy\nLm5ld1NjaGVtYShqY29uZi5nZXRTY2hlbWEoKSk7CiAgICB9CgogICAgcHVi\nbGljIHZvaWQgc3RhcnRDb25maWd1cmF0aW9uKCkgewogICAgfQoKICAgIHB1\nYmxpYyB2b2lkIGVuZENvbmZpZ3VyYXRpb24oKSB7CiAgICB9CiAgICAKICAg\nIHB1YmxpYyBTY2hlbWFHcm91cCByZWFkU2NoZW1hKCkgewogICAgICAgIHJl\ndHVybiB0aGlzOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHN0b3JlU2NoZW1h\nKFNjaGVtYUdyb3VwIHNjaGVtYSkgewogICAgICAgIC8vIG5vdGhpbmcgdG8g\nZG8KICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBpc0tub3duVGFibGUoVGFi\nbGUgdGFibGUpIHsKICAgICAgICByZXR1cm4gc3VwZXIuZmluZFRhYmxlKHRh\nYmxlKSAhPSBudWxsOwogICAgfQoKICAgIHB1YmxpYyBib29sZWFuIGlzS25v\nd25UYWJsZShTdHJpbmcgbmFtZSkgewogICAgICAgIHJldHVybiBzdXBlci5m\naW5kVGFibGUobmFtZSkgIT0gbnVsbDsKICAgIH0KCiAgICBwdWJsaWMgYm9v\nbGVhbiBpc0tub3duVGFibGUoUXVhbGlmaWVkREJJZGVudGlmaWVyIHBhdGgp\nIHsKICAgICAgICByZXR1cm4gc3VwZXIuZmluZFRhYmxlKHBhdGgpICE9IG51\nbGw7CiAgICB9CgogICAgcHVibGljIFRhYmxlIGZpbmRUYWJsZShTdHJpbmcg\nbmFtZSkgewogICAgICAgIHJldHVybiBzdXBlci5maW5kVGFibGUobmFtZSk7\nCiAgICB9CgogICAgcHVibGljIFRhYmxlIGZpbmRUYWJsZShEQklkZW50aWZp\nZXIgbmFtZSkgewogICAgICAgIGlmIChuYW1lID09IG51bGwpCiAgICAgICAg\nICAgIHJldHVybiBudWxsOwoKICAgICAgICBRdWFsaWZpZWREQklkZW50aWZp\nZXIgcGF0aCA9IFF1YWxpZmllZERCSWRlbnRpZmllci5nZXRQYXRoKG5hbWUp\nOwogICAgICAgIHJldHVybiBmaW5kVGFibGUocGF0aCk7CiAgICB9CgogICAg\ncHVibGljIFRhYmxlIGZpbmRUYWJsZShRdWFsaWZpZWREQklkZW50aWZpZXIg\ncGF0aCkgewogICAgICAgIGlmIChEQklkZW50aWZpZXIuaXNOdWxsKHBhdGgp\nKQogICAgICAgICAgICByZXR1cm4gbnVsbDsKCiAgICAgICAgVGFibGUgdGFi\nbGUgPSBzdXBlci5maW5kVGFibGUocGF0aCk7CiAgICAgICAgaWYgKHRhYmxl\nICE9IG51bGwpCiAgICAgICAgICAgIHJldHVybiB0YWJsZTsKCiAgICAgICAg\nLy8gaWYgZnVsbCBuYW1lLCBzcGxpdAogICAgICAgIERCSWRlbnRpZmllciBz\nY2hlbWFOYW1lID0gREJJZGVudGlmaWVyLk5VTEw7CiAgICAgICAgREJJZGVu\ndGlmaWVyIHRhYmxlTmFtZSA9IHBhdGguZ2V0VW5xdWFsaWZpZWROYW1lKCk7\nCiAgICAgICAgaWYgKCFEQklkZW50aWZpZXIuaXNOdWxsKHBhdGguZ2V0U2No\nZW1hTmFtZSgpKSkgewogICAgICAgICAgICBzY2hlbWFOYW1lID0gcGF0aC5n\nZXRTY2hlbWFOYW1lKCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAg\nc2NoZW1hTmFtZSA9IF9zY2hlbWE7CiAgICAgICAgfQoKICAgICAgICBTY2hl\nbWEgc2NoZW1hID0gZ2V0U2NoZW1hKHNjaGVtYU5hbWUpOwogICAgICAgIGlm\nIChzY2hlbWEgPT0gbnVsbCkgewogICAgICAgICAgICBzY2hlbWEgPSBhZGRT\nY2hlbWEoc2NoZW1hTmFtZSk7CiAgICAgICAgfQoKICAgICAgICAvLyBFbnN1\ncmUgb25seSB2YWxpZCB0YWJsZSBuYW1lKHMpIGFyZSBhZGRlZCB0byB0aGUg\nc2NoZW1hCiAgICAgICAgaWYgKHRhYmxlTmFtZS5nZXROYW1lKCkubGVuZ3Ro\nKCkgPiBfZGljdC5tYXhUYWJsZU5hbWVMZW5ndGgpIHsKICAgICAgICAgICAg\ncmV0dXJuIHNjaGVtYS5hZGRUYWJsZSh0YWJsZU5hbWUsIAogICAgICAgICAg\nICAgICAgX2RpY3QuZ2V0VmFsaWRUYWJsZU5hbWUodGFibGVOYW1lLCBnZXRT\nY2hlbWEoc2NoZW1hTmFtZSkpKTsKICAgICAgICB9CgogICAgICAgIHJldHVy\nbiBzY2hlbWEuYWRkVGFibGUodGFibGVOYW1lKTsKICAgIH0KICAgIAogICAg\nCi8vICAgIHByb3RlY3RlZCBUYWJsZSBuZXdUYWJsZShTdHJpbmcgbmFtZSwg\nU2NoZW1hIHNjaGVtYSkgewovLyAgICAgICAgcmV0dXJuIG5ldyBEeW5hbWlj\nVGFibGUobmFtZSwgc2NoZW1hKTsKLy8gICAgfQoKICAgIHByb3RlY3RlZCBU\nYWJsZSBuZXdUYWJsZShEQklkZW50aWZpZXIgbmFtZSwgU2NoZW1hIHNjaGVt\nYSkgewogICAgICAgIHJldHVybiBuZXcgRHluYW1pY1RhYmxlKG5hbWUsIHNj\naGVtYSk7CiAgICB9CgovLyAgICBwcm90ZWN0ZWQgQ29sdW1uIG5ld0NvbHVt\nbihTdHJpbmcgbmFtZSwgVGFibGUgdGFibGUpIHsKLy8gICAgICAgIHJldHVy\nbiBuZXcgRHluYW1pY0NvbHVtbihuYW1lLCB0YWJsZSk7Ci8vICAgIH0KCiAg\nICBwcm90ZWN0ZWQgQ29sdW1uIG5ld0NvbHVtbihEQklkZW50aWZpZXIgbmFt\nZSwgVGFibGUgdGFibGUpIHsKICAgICAgICByZXR1cm4gbmV3IER5bmFtaWND\nb2x1bW4obmFtZSwgdGFibGUpOwogICAgfQoKICAgIC8qKgogICAgICogVGFi\nbGUgdHlwZSB0aGF0IGFkZHMgY29sdW1ucyB3aGVuIHtAbGluayAjZ2V0Q29s\ndW1ufSBpcyBjYWxsZWQuCiAgICAgKi8KICAgIHByaXZhdGUgY2xhc3MgRHlu\nYW1pY1RhYmxlCiAgICAgICAgZXh0ZW5kcyBUYWJsZSB7CgogICAgICAgIHB1\nYmxpYyBEeW5hbWljVGFibGUoU3RyaW5nIG5hbWUsIFNjaGVtYSBzY2hlbWEp\nIHsKICAgICAgICAgICAgc3VwZXIobmFtZSwgc2NoZW1hKTsKICAgICAgICB9\nCgogICAgICAgIHB1YmxpYyBEeW5hbWljVGFibGUoREJJZGVudGlmaWVyIG5h\nbWUsIFNjaGVtYSBzY2hlbWEpIHsKICAgICAgICAgICAgc3VwZXIobmFtZSwg\nc2NoZW1hKTsKICAgICAgICB9CgogICAgICAgIC8qKgogICAgICAgICAqIEBk\nZXByZWNhdGVkCiAgICAgICAgICovCiAgICAgICAgcHVibGljIENvbHVtbiBn\nZXRDb2x1bW4oU3RyaW5nIG5hbWUpIHsKICAgICAgICAgICAgcmV0dXJuIGdl\ndENvbHVtbihuYW1lLCBudWxsKTsKICAgICAgICB9CgogICAgICAgIHB1Ymxp\nYyBDb2x1bW4gZ2V0Q29sdW1uKERCSWRlbnRpZmllciBuYW1lKSB7CiAgICAg\nICAgICAgIHJldHVybiBnZXRDb2x1bW4obmFtZSwgbnVsbCk7CiAgICAgICAg\nfQoKICAgICAgICAvKioKICAgICAgICAgKiBAZGVwcmVjYXRlZAogICAgICAg\nICAqLwogICAgICAgIHB1YmxpYyBDb2x1bW4gZ2V0Q29sdW1uKFN0cmluZyBu\nYW1lLCBEQkRpY3Rpb25hcnkgZGljdCkgewogICAgICAgICAgICBpZiAobmFt\nZSA9PSBudWxsKQogICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAg\nICAgICAgIHJldHVybiBnZXRDb2x1bW4oREJJZGVudGlmaWVyLm5ld0NvbHVt\nbihuYW1lKSwgZGljdCk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgQ29s\ndW1uIGdldENvbHVtbihEQklkZW50aWZpZXIgbmFtZSwgREJEaWN0aW9uYXJ5\nIGRpY3QpIHsKICAgICAgICAgICAgaWYgKERCSWRlbnRpZmllci5pc051bGwo\nbmFtZSkpCiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDsKCiAgICAgICAg\nICAgIENvbHVtbiBjb2wgPSBzdXBlci5nZXRDb2x1bW4obmFtZSk7CiAgICAg\nICAgICAgIGlmIChjb2wgIT0gbnVsbCkKICAgICAgICAgICAgICAgIHJldHVy\nbiBjb2w7CgogICAgICAgICAgICAvLyBFbnN1cmUgb25seSB2YWxpZCBjb2x1\nbW4gbmFtZShzKSBhcmUgYWRkZWQgdG8gdGhlIHRhYmxlCiAgICAgICAgICAg\nIGlmICgobmFtZS5nZXROYW1lKCkubGVuZ3RoKCkgPiBfZGljdC5tYXhDb2x1\nbW5OYW1lTGVuZ3RoKSB8fAogICAgICAgICAgICAgICAgX2RpY3QuZ2V0SW52\nYWxpZENvbHVtbldvcmRTZXQoKS5jb250YWlucygKICAgICAgICAgICAgICAg\nICAgICBEQklkZW50aWZpZXIudG9VcHBlcihuYW1lKS5nZXROYW1lKCkpKSB7\nCiAgICAgICAgICAgICAgICByZXR1cm4gYWRkQ29sdW1uKG5hbWUsIAogICAg\nICAgICAgICAgICAgICAgIF9kaWN0LmdldFZhbGlkQ29sdW1uTmFtZShuYW1l\nLCB0aGlzKSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHJldHVybiBh\nZGRDb2x1bW4obmFtZSk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAg\nICogQ29sdW1uIHR5cGUgdGhhdCBzZXRzIGl0cyB0eXBlIHdoZW4ge0BsaW5r\nICNpc0NvbXBhdGlibGV9IGlzIGNhbGxlZC4KICAgICAqLwogICAgcHJpdmF0\nZSBjbGFzcyBEeW5hbWljQ29sdW1uCiAgICAgICAgZXh0ZW5kcyBDb2x1bW4g\newoKICAgICAgICAvKioKICAgICAgICAgKiBAZGVwcmVjYXRlZAogICAgICAg\nICAqLwogICAgICAgIHB1YmxpYyBEeW5hbWljQ29sdW1uKFN0cmluZyBuYW1l\nLCBUYWJsZSB0YWJsZSkgewogICAgICAgICAgICBzdXBlcihuYW1lLCB0YWJs\nZSk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgRHluYW1pY0NvbHVtbihE\nQklkZW50aWZpZXIgbmFtZSwgVGFibGUgdGFibGUpIHsKICAgICAgICAgICAg\nc3VwZXIobmFtZSwgdGFibGUpOwogICAgICAgIH0KCiAgICAgICAgcHVibGlj\nIGJvb2xlYW4gaXNDb21wYXRpYmxlKGludCB0eXBlLCBTdHJpbmcgdHlwZU5h\nbWUsIGludCBzaXplLAogICAgICAgICAgICBpbnQgZGVjaW1hbHMpIHsKICAg\nICAgICAgICAgaWYgKGdldFR5cGUoKSAhPSBUeXBlcy5PVEhFUikKICAgICAg\nICAgICAgICAgIHJldHVybiBzdXBlci5pc0NvbXBhdGlibGUodHlwZSwgdHlw\nZU5hbWUsIHNpemUsIGRlY2ltYWxzKTsKCiAgICAgICAgICAgIGlmICh0eXBl\nID09IFR5cGVzLlZBUkNIQVIgJiYgc2l6ZSA8PSAwKQogICAgICAgICAgICAg\nICAgc2l6ZSA9IF9kaWN0LmNoYXJhY3RlckNvbHVtblNpemU7CiAgICAgICAg\nICAgIHNldFR5cGUodHlwZSk7CiAgICAgICAgICAgIHNldFNpemUoc2l6ZSk7\nCiAgICAgICAgICAgIGlmICh0eXBlTmFtZSAhPSBudWxsKQogICAgICAgICAg\nICAgICAgc2V0VHlwZUlkZW50aWZpZXIoREJJZGVudGlmaWVyLm5ld0NvbHVt\nbkRlZmluaXRpb24odHlwZU5hbWUpKTsKICAgICAgICAgICAgaWYgKGRlY2lt\nYWxzID49IDApCiAgICAgICAgICAgICAgICBzZXREZWNpbWFsRGlnaXRzKGRl\nY2ltYWxzKTsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQog\nICAgfQp9Cg==\n","encoding":"base64"}

