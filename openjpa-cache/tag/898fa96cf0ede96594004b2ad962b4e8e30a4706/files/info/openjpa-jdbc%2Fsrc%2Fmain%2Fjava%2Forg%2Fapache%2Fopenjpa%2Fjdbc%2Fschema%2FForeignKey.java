{"sha":"60ed28cb4138b1151649ed52ed39f2f15ab766f3","node_id":"MDQ6QmxvYjIwNjM2NDo2MGVkMjhjYjQxMzhiMTE1MTY0OWVkNTJlZDM5ZjJmMTVhYjc2NmYz","size":31457,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/60ed28cb4138b1151649ed52ed39f2f15ab766f3","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hlbWE7CgppbXBv\ncnQgamF2YS5zcWwuQ29ubmVjdGlvbjsKaW1wb3J0IGphdmEuc3FsLkRhdGFi\nYXNlTWV0YURhdGE7CmltcG9ydCBqYXZhLnV0aWwuQXJyYXlMaXN0OwppbXBv\ncnQgamF2YS51dGlsLkFycmF5czsKaW1wb3J0IGphdmEudXRpbC5MaW5rZWRI\nYXNoTWFwOwppbXBvcnQgamF2YS51dGlsLkxpc3Q7CgppbXBvcnQgb3JnLmFw\nYWNoZS5jb21tb25zLmxhbmcuT2JqZWN0VXRpbHM7CmltcG9ydCBvcmcuYXBh\nY2hlLmNvbW1vbnMubGFuZy5TdHJpbmdVdGlsczsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5qZGJjLmlkZW50aWZpZXIuTm9ybWFsaXplcjsKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLmlkZW50aWZpZXIuREJJZGVudGlm\naWVyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc3FsLkRCRGlj\ndGlvbmFyeTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIubG9nLkxv\nZzsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIudXRpbC5Mb2NhbGl6\nZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuU3RyaW5n\nRGlzdGFuY2U7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5JbnZh\nbGlkU3RhdGVFeGNlcHRpb247CgovKioKICogUmVwcmVzZW50cyBhIGRhdGFi\nYXNlIGZvcmVpZ24ga2V5OyBtYXkgYmUgYSBsb2dpY2FsIGtleSB3aXRoIG5v\nCiAqIGRhdGFiYXNlIHJlcHJlc2VudGF0aW9uLiBUaGlzIGNsYXNzIGNhbiBh\nbHNvIHJlcHJlc2VudCBhIHBhcnRpYWwga2V5LAogKiBhbGlnbmluZyB3aXRo\nIHtAbGluayBEYXRhYmFzZU1ldGFEYXRhfS4KICoKICogQGF1dGhvciBBYmUg\nV2hpdGUKICovCkBTdXBwcmVzc1dhcm5pbmdzKCJzZXJpYWwiKQpwdWJsaWMg\nY2xhc3MgRm9yZWlnbktleQogICAgZXh0ZW5kcyBDb25zdHJhaW50IHsKCiAg\nICAvKioKICAgICAqIExvZ2ljYWwgZm9yZWlnbiBrZXk7IGxpbmtzIGNvbHVt\nbnMsIGJ1dCBkb2VzIG5vdCBwZXJmb3JtIGFueSBhY3Rpb24KICAgICAqIHdo\nZW4gdGhlIGpvaW5lZCBwcmltYXJ5IGtleSBjb2x1bW5zIGFyZSBtb2RpZmll\nZC4KICAgICAqLwogICAgcHVibGljIHN0YXRpYyBmaW5hbCBpbnQgQUNUSU9O\nX05PTkUgPSAxOwoKICAgIC8qKgogICAgICogVGhyb3cgYW4gZXhjZXB0aW9u\nIGlmIGpvaW5lZCBwcmltYXJ5IGtleSBjb2x1bW5zIGFyZSBtb2RpZmllZC4K\nICAgICAqLwogICAgcHVibGljIHN0YXRpYyBmaW5hbCBpbnQgQUNUSU9OX1JF\nU1RSSUNUID0gMjsKCiAgICAvKioKICAgICAqIENhc2NhZGUgYW55IG1vZGlm\naWNhdGlvbiBvZiB0aGUgam9pbmVkIHByaW1hcnkga2V5IGNvbHVtbnMgdG8K\nICAgICAqIHRoaXMgdGFibGUuIElmIHRoZSBqb2luZWQgcHJpbWFyeSBrZXkg\ncm93IGlzIGRlbGV0ZWQsIHRoZSByb3cgaW4gdGhpcwogICAgICogdGFibGUg\nd2lsbCBhbHNvIGJlIGRlbGV0ZWQuCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0\naWMgZmluYWwgaW50IEFDVElPTl9DQVNDQURFID0gMzsKCiAgICAvKioKICAg\nICAqIE51bGwgdGhlIGxvY2FsIGNvbHVtbnMgaWYgdGhlIGpvaW5lZCBwcmlt\nYXJ5IGtleSBjb2x1bW5zIGFyZSBtb2RpZmllZC4KICAgICAqLwogICAgcHVi\nbGljIHN0YXRpYyBmaW5hbCBpbnQgQUNUSU9OX05VTEwgPSA0OwoKICAgIC8q\nKgogICAgICogU2V0IHRoZSBsb2NhbCBjb2x1bW5zIHRvIHRoZWlyIGRlZmF1\nbHQgdmFsdWVzIGlmIHRoZSBwcmltYXJ5IGtleQogICAgICogY29sdW1ucyBh\ncmUgbW9kaWZpZWQuCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0aWMgZmluYWwg\naW50IEFDVElPTl9ERUZBVUxUID0gNTsKCiAgICBwcml2YXRlIHN0YXRpYyBm\naW5hbCBMb2NhbGl6ZXIgX2xvYyA9IAogICAgICAgIExvY2FsaXplci5mb3JQ\nYWNrYWdlKEZvcmVpZ25LZXkuY2xhc3MpOwoKICAgIHByaXZhdGUgREJJZGVu\ndGlmaWVyIF9wa1RhYmxlTmFtZSA9IERCSWRlbnRpZmllci5OVUxMOwogICAg\ncHJpdmF0ZSBEQklkZW50aWZpZXIgX3BrU2NoZW1hTmFtZSA9IERCSWRlbnRp\nZmllci5OVUxMOwogICAgcHJpdmF0ZSBEQklkZW50aWZpZXIgX3BrQ29sdW1u\nTmFtZSA9IERCSWRlbnRpZmllci5OVUxMOwogICAgcHJpdmF0ZSBpbnQgX3Nl\ncSA9IDA7CgogICAgcHJpdmF0ZSBMaW5rZWRIYXNoTWFwIF9qb2lucyA9IG51\nbGw7CiAgICBwcml2YXRlIExpbmtlZEhhc2hNYXAgX2pvaW5zUEsgPSBudWxs\nOwogICAgcHJpdmF0ZSBMaW5rZWRIYXNoTWFwIF9jb25zdHMgPSBudWxsOwog\nICAgcHJpdmF0ZSBMaW5rZWRIYXNoTWFwIF9jb25zdHNQSyA9IG51bGw7CiAg\nICBwcml2YXRlIGludCBfZGVsQWN0aW9uID0gQUNUSU9OX05PTkU7CiAgICBw\ncml2YXRlIGludCBfdXBBY3Rpb24gPSBBQ1RJT05fTk9ORTsKICAgIHByaXZh\ndGUgaW50IF9pbmRleCA9IDA7CgogICAgLy8gY2FjaGVkIGl0ZW1zCiAgICBw\ncml2YXRlIENvbHVtbltdIF9sb2NhbHMgPSBudWxsOwogICAgcHJpdmF0ZSBD\nb2x1bW5bXSBfcGtzID0gbnVsbDsKICAgIHByaXZhdGUgT2JqZWN0W10gX2Nv\nbnN0VmFscyA9IG51bGw7CiAgICBwcml2YXRlIENvbHVtbltdIF9jb25zdENv\nbHMgPSBudWxsOwogICAgcHJpdmF0ZSBPYmplY3RbXSBfY29uc3RWYWxzUEsg\nPSBudWxsOwogICAgcHJpdmF0ZSBDb2x1bW5bXSBfY29uc3RDb2xzUEsgPSBu\ndWxsOwogICAgcHJpdmF0ZSBUYWJsZSBfcGtUYWJsZSA9IG51bGw7CiAgICBw\ncml2YXRlIEJvb2xlYW4gX2F1dG9Bc3NpZ24gPSBudWxsOwoKICAgIC8qKgog\nICAgICogUmV0dXJuIHRoZSBmb3JlaWduIGtleSBhY3Rpb24gY29uc3RhbnQg\nZm9yIHRoZSBnaXZlbiBhY3Rpb24gbmFtZS4KICAgICAqLwogICAgcHVibGlj\nIHN0YXRpYyBpbnQgZ2V0QWN0aW9uKFN0cmluZyBuYW1lKSB7CiAgICAgICAg\naWYgKG5hbWUgPT0gbnVsbCB8fCAibm9uZSIuZXF1YWxzSWdub3JlQ2FzZShu\nYW1lKSkKICAgICAgICAgICAgcmV0dXJuIEFDVElPTl9OT05FOwogICAgICAg\nIGlmICgiY2FzY2FkZSIuZXF1YWxzSWdub3JlQ2FzZShuYW1lKSkKICAgICAg\nICAgICAgcmV0dXJuIEFDVElPTl9DQVNDQURFOwogICAgICAgIGlmICgiZGVm\nYXVsdCIuZXF1YWxzSWdub3JlQ2FzZShuYW1lKSkKICAgICAgICAgICAgcmV0\ndXJuIEFDVElPTl9ERUZBVUxUOwogICAgICAgIGlmICgicmVzdHJpY3QiLmVx\ndWFsc0lnbm9yZUNhc2UobmFtZSkKICAgICAgICAgICAgfHwgImV4Y2VwdGlv\nbiIuZXF1YWxzSWdub3JlQ2FzZShuYW1lKSkKICAgICAgICAgICAgcmV0dXJu\nIEFDVElPTl9SRVNUUklDVDsKICAgICAgICBpZiAoIm51bGwiLmVxdWFsc0ln\nbm9yZUNhc2UobmFtZSkpCiAgICAgICAgICAgIHJldHVybiBBQ1RJT05fTlVM\nTDsKCiAgICAgICAgLy8gbm90IGEgcmVjb2duaXplZCBhY3Rpb247IGNoZWNr\nIGZvciB0eXBvCiAgICAgICAgTGlzdCByZWNvZ25pemVkID0gQXJyYXlzLmFz\nTGlzdChuZXcgU3RyaW5nW117ICJub25lIiwgImV4Y2VwdGlvbiIsCiAgICAg\nICAgICAgICJyZXN0cmljdCIsICJjYXNjYWRlIiwgIm51bGwiLCAiZGVmYXVs\ndCIsIH0pOwogICAgICAgIFN0cmluZyBjbG9zZXN0ID0gU3RyaW5nRGlzdGFu\nY2UuZ2V0Q2xvc2VzdExldmVuc2h0ZWluRGlzdGFuY2UobmFtZSwKICAgICAg\nICAgICAgcmVjb2duaXplZCwgLjVGKTsKCiAgICAgICAgU3RyaW5nIG1zZzsK\nICAgICAgICBpZiAoY2xvc2VzdCAhPSBudWxsKQogICAgICAgICAgICBtc2cg\nPSBfbG9jLmdldCgiYmFkLWZrLWFjdGlvbi1oaW50IiwgbmFtZSwgY2xvc2Vz\ndCwgcmVjb2duaXplZCkKICAgICAgICAgICAgICAgIC5nZXRNZXNzYWdlKCk7\nCiAgICAgICAgZWxzZQogICAgICAgICAgICBtc2cgPSBfbG9jLmdldCgiYmFk\nLWZrLWFjdGlvbiIsIG5hbWUsIHJlY29nbml6ZWQpLmdldE1lc3NhZ2UoKTsK\nICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uKG1z\nZyk7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIGZvcmVpZ24g\na2V5IGFjdGlvbiBuYW1lIGZvciB0aGUgZ2l2ZW4gYWN0aW9uIGNvbnN0YW50\nLgogICAgICovCiAgICBwdWJsaWMgc3RhdGljIFN0cmluZyBnZXRBY3Rpb25O\nYW1lKGludCBhY3Rpb24pIHsKICAgICAgICBzd2l0Y2ggKGFjdGlvbikgewog\nICAgICAgICAgICBjYXNlIEFDVElPTl9OT05FOgogICAgICAgICAgICAgICAg\ncmV0dXJuICJub25lIjsKICAgICAgICAgICAgY2FzZSBBQ1RJT05fUkVTVFJJ\nQ1Q6CiAgICAgICAgICAgICAgICByZXR1cm4gInJlc3RyaWN0IjsKICAgICAg\nICAgICAgY2FzZSBBQ1RJT05fQ0FTQ0FERToKICAgICAgICAgICAgICAgIHJl\ndHVybiAiY2FzY2FkZSI7CiAgICAgICAgICAgIGNhc2UgQUNUSU9OX0RFRkFV\nTFQ6CiAgICAgICAgICAgICAgICByZXR1cm4gImRlZmF1bHQiOwogICAgICAg\nICAgICBjYXNlIEFDVElPTl9OVUxMOgogICAgICAgICAgICAgICAgcmV0dXJu\nICJudWxsIjsKICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAg\nIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24oU3RyaW5nLnZh\nbHVlT2YoYWN0aW9uKSk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAg\nICogRGVmYXVsdCBjb25zdHJ1Y3Rvci4KICAgICAqLwogICAgcHVibGljIEZv\ncmVpZ25LZXkoKSB7CiAgICB9CgogICAgLyoqCiAgICAgKiBDb25zdHJ1Y3Rv\nci4KICAgICAqCiAgICAgKiBAcGFyYW0gbmFtZSB0aGUgZm9yZWlnbiBrZXkg\nbmFtZSwgaWYgYW55CiAgICAgKiBAcGFyYW0gdGFibGUgdGhlIGxvY2FsIHRh\nYmxlIG9mIHRoZSBmb3JlaWduIGtleQogICAgICogQGRlcHJlY2F0ZWQKICAg\nICAqLwogICAgcHVibGljIEZvcmVpZ25LZXkoU3RyaW5nIG5hbWUsIFRhYmxl\nIHRhYmxlKSB7CiAgICAgICAgc3VwZXIobmFtZSwgdGFibGUpOwogICAgfQoK\nICAgIHB1YmxpYyBGb3JlaWduS2V5KERCSWRlbnRpZmllciBuYW1lLCBUYWJs\nZSB0YWJsZSkgewogICAgICAgIHN1cGVyKG5hbWUsIHRhYmxlKTsKICAgIH0K\nCiAgICBwdWJsaWMgYm9vbGVhbiBpc0xvZ2ljYWwoKSB7CiAgICAgICAgcmV0\ndXJuIF9kZWxBY3Rpb24gPT0gQUNUSU9OX05PTkU7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBXaGV0aGVyIHRoZSBwcmltYXJ5IGtleSBjb2x1bW5zIG9mIHRo\naXMga2V5IGFyZSBhdXRvLWluY3JlbWVudGluZywgb3IKICAgICAqIHdoZXRo\nZXIgdGhleSB0aGVtc2VsdmVzIGFyZSBtZW1iZXJzIG9mIGEgZm9yZWlnbiBr\nZXkgd2hvJ3MgcHJpbWFyeSBrZXkKICAgICAqIGlzIGF1dG8taW5jcmVtZW50\naW5nIChyZWN1cnNpbmcgdG8gYXJiaXRyYXJ5IGRlcHRoKS4KICAgICAqLwog\nICAgcHVibGljIGJvb2xlYW4gaXNQcmltYXJ5S2V5QXV0b0Fzc2lnbmVkKCkg\newogICAgICAgIGlmIChfYXV0b0Fzc2lnbiAhPSBudWxsKQogICAgICAgICAg\nICByZXR1cm4gX2F1dG9Bc3NpZ24uYm9vbGVhblZhbHVlKCk7CiAgICAgICAg\ncmV0dXJuIGlzUHJpbWFyeUtleUF1dG9Bc3NpZ25lZChuZXcgQXJyYXlMaXN0\nKDMpKTsKICAgIH0KCiAgICAvKioKICAgICAqIEhlbHBlciB0byBjYWxjdWxh\ndGUgd2hldGhlciB0aGlzIGZvcmVpZ24ga2V5IGRlcGVuZHMgb24gYXV0by1h\nc3NpZ25lZCAKICAgICAqIGNvbHVtbnMuICBSZWN1cnNlcyBhcHByb3ByaWF0\nZWx5IGlmIHRoZSBwcmltYXJ5IGtleSBjb2x1bW5zIHRoaXMga2V5CiAgICAg\nKiBqb2lucyB0byBhcmUgdGhlbXNlbHZlcyBtZW1iZXJzIG9mIGEgZm9yZWln\nbiBrZXkgdGhhdCBpcyBkZXBlbmRlbnQgb24KICAgICAqIGF1dG8tYXNzaWdu\nZWQgY29sdW1ucy4gIENhY2hlcyBjYWxjdWxhdGVkIGF1dG8tYXNzaWduIHZh\nbHVlIGFzIGEgc2lkZSAKICAgICAqIGVmZmVjdC4KICAgICAqCiAgICAgKiBA\ncGFyYW0gc2VlbiB0cmFjayBzZWVuIGZvcmVpZ24ga2V5cyB0byBwcmV2ZW50\nIGluZmluaXRlIHJlY3Vyc2lvbiBpbgogICAgICogdGhlIGNhc2Ugb2YgZm9y\nZWlnbiBrZXkgY3ljbGVzCiAgICAgKi8KICAgIHByaXZhdGUgYm9vbGVhbiBp\nc1ByaW1hcnlLZXlBdXRvQXNzaWduZWQoTGlzdCBzZWVuKSB7CiAgICAgICAg\naWYgKF9hdXRvQXNzaWduICE9IG51bGwpIAogICAgICAgICAgICByZXR1cm4g\nX2F1dG9Bc3NpZ24uYm9vbGVhblZhbHVlKCk7CgogICAgICAgIENvbHVtbltd\nIGNvbHMgPSBnZXRQcmltYXJ5S2V5Q29sdW1ucygpOwogICAgICAgIGlmIChj\nb2xzLmxlbmd0aCA9PSAwKSB7CiAgICAgICAgICAgIF9hdXRvQXNzaWduID0g\nQm9vbGVhbi5GQUxTRTsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAg\nICAgIH0KCiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBjb2xzLmxlbmd0\naDsgaSsrKSB7CiAgICAgICAgICAgIGlmIChjb2xzW2ldLmlzQXV0b0Fzc2ln\nbmVkKCkpIHsKICAgICAgICAgICAgICAgIF9hdXRvQXNzaWduID0gQm9vbGVh\nbi5UUlVFOwogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAg\nICAgIH0KICAgICAgICB9CgogICAgICAgIEZvcmVpZ25LZXlbXSBma3MgPSBf\ncGtUYWJsZS5nZXRGb3JlaWduS2V5cygpOwogICAgICAgIHNlZW4uYWRkKHRo\naXMpOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgY29scy5sZW5ndGg7\nIGkrKykgewogICAgICAgICAgICBmb3IgKGludCBqID0gMDsgaiA8IGZrcy5s\nZW5ndGg7IGorKykgewogICAgICAgICAgICAgICAgaWYgKCFma3Nbal0uY29u\ndGFpbnNDb2x1bW4oY29sc1tpXSkpCiAgICAgICAgICAgICAgICAgICAgY29u\ndGludWU7CiAgICAgICAgICAgICAgICBpZiAoIXNlZW4uY29udGFpbnMoZmtz\nW2pdKQogICAgICAgICAgICAgICAgICAgICYmIGZrc1tqXS5pc1ByaW1hcnlL\nZXlBdXRvQXNzaWduZWQoc2VlbikpIHsKICAgICAgICAgICAgICAgICAgICBf\nYXV0b0Fzc2lnbiA9IEJvb2xlYW4uVFJVRTsKICAgICAgICAgICAgICAgICAg\nICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAg\nfQogICAgICAgIH0KCiAgICAgICAgX2F1dG9Bc3NpZ24gPSBCb29sZWFuLkZB\nTFNFOwogICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICAvKioKICAg\nICAqIFRoZSBuYW1lIG9mIHRoZSBwcmltYXJ5IGtleSB0YWJsZS4KICAgICAq\nIEBkZXByZWNhdGVkCiAgICAgKi8KICAgIHB1YmxpYyBTdHJpbmcgZ2V0UHJp\nbWFyeUtleVRhYmxlTmFtZSgpIHsKICAgICAgICByZXR1cm4gZ2V0UHJpbWFy\neUtleVRhYmxlSWRlbnRpZmllcigpLmdldE5hbWUoKTsKICAgIH0KCiAgICBw\ndWJsaWMgREJJZGVudGlmaWVyIGdldFByaW1hcnlLZXlUYWJsZUlkZW50aWZp\nZXIoKSB7CiAgICAgICAgVGFibGUgdGFibGUgPSBnZXRQcmltYXJ5S2V5VGFi\nbGUoKTsKICAgICAgICBpZiAodGFibGUgIT0gbnVsbCkKICAgICAgICAgICAg\ncmV0dXJuIHRhYmxlLmdldElkZW50aWZpZXIoKTsKICAgICAgICByZXR1cm4g\nX3BrVGFibGVOYW1lID09IG51bGwgPyBEQklkZW50aWZpZXIuTlVMTCA6IF9w\na1RhYmxlTmFtZTsKICAgIH0KCiAgICAvKioKICAgICAqIFRoZSBuYW1lIG9m\nIHRoZSBwcmltYXJ5IGtleSB0YWJsZS4gWW91IGNhbiBvbmx5IHNldCB0aGUg\ncHJpbWFyeQogICAgICoga2V5IHRhYmxlIG5hbWUgb24gZm9yZWlnbiBrZXlz\nIHRoYXQgaGF2ZSBub3QgYWxyZWFkeSBiZWVuIGpvaW5lZC4KICAgICAqIEBk\nZXByZWNhdGVkCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldFByaW1hcnlL\nZXlUYWJsZU5hbWUoU3RyaW5nIHBrVGFibGVOYW1lKSB7CiAgICAgICAgc2V0\nUHJpbWFyeUtleVRhYmxlSWRlbnRpZmllcihEQklkZW50aWZpZXIubmV3VGFi\nbGUocGtUYWJsZU5hbWUpKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRQ\ncmltYXJ5S2V5VGFibGVJZGVudGlmaWVyKERCSWRlbnRpZmllciBwa1RhYmxl\nTmFtZSkgewogICAgICAgIGlmIChnZXRQcmltYXJ5S2V5VGFibGUoKSAhPSBu\ndWxsKQogICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbFN0YXRlRXhjZXB0\naW9uKCk7CiAgICAgICAgX3BrVGFibGVOYW1lID0gcGtUYWJsZU5hbWU7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBUaGUgbmFtZSBvZiB0aGUgcHJpbWFyeSBr\nZXkgdGFibGUncyBzY2hlbWEuCiAgICAgKiBAZGVwcmVjYXRlZAogICAgICov\nCiAgICBwdWJsaWMgU3RyaW5nIGdldFByaW1hcnlLZXlTY2hlbWFOYW1lKCkg\newogICAgICAgIHJldHVybiBnZXRQcmltYXJ5S2V5U2NoZW1hSWRlbnRpZmll\ncigpLmdldE5hbWUoKTsKICAgIH0KCiAgICBwdWJsaWMgREJJZGVudGlmaWVy\nIGdldFByaW1hcnlLZXlTY2hlbWFJZGVudGlmaWVyKCkgewogICAgICAgIFRh\nYmxlIHRhYmxlID0gZ2V0UHJpbWFyeUtleVRhYmxlKCk7CiAgICAgICAgaWYg\nKHRhYmxlICE9IG51bGwpCiAgICAgICAgICAgIHJldHVybiB0YWJsZS5nZXRT\nY2hlbWFJZGVudGlmaWVyKCk7CiAgICAgICAgcmV0dXJuIF9wa1NjaGVtYU5h\nbWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBUaGUgbmFtZSBvZiB0aGUgcHJp\nbWFyeSBrZXkgdGFibGUncyBzY2hlbWEuIFlvdSBjYW4gb25seSBzZXQgdGhl\nCiAgICAgKiBwcmltYXJ5IGtleSBzY2hlbWEgbmFtZSBvbiBmb3JlaWduIGtl\neXMgdGhhdCBoYXZlIG5vdCBhbHJlYWR5IGJlZW4KICAgICAqIGpvaW5lZC4K\nICAgICAqIEBkZXByZWNhdGVkCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNl\ndFByaW1hcnlLZXlTY2hlbWFOYW1lKFN0cmluZyBwa1NjaGVtYU5hbWUpIHsK\nICAgICAgICBzZXRQcmltYXJ5S2V5U2NoZW1hSWRlbnRpZmllcihEQklkZW50\naWZpZXIubmV3U2NoZW1hKHBrU2NoZW1hTmFtZSkpOwogICAgfQoKICAgIHB1\nYmxpYyB2b2lkIHNldFByaW1hcnlLZXlTY2hlbWFJZGVudGlmaWVyKERCSWRl\nbnRpZmllciBwa1NjaGVtYU5hbWUpIHsKICAgICAgICBpZiAoZ2V0UHJpbWFy\neUtleVRhYmxlKCkgIT0gbnVsbCkKICAgICAgICAgICAgdGhyb3cgbmV3IEls\nbGVnYWxTdGF0ZUV4Y2VwdGlvbigpOwogICAgICAgIF9wa1NjaGVtYU5hbWUg\nPSBwa1NjaGVtYU5hbWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBUaGUgbmFt\nZSBvZiB0aGUgcHJpbWFyeSBrZXkgY29sdW1uLgogICAgICogQGRlcHJlY2F0\nZWQKICAgICAqLwogICAgcHVibGljIFN0cmluZyBnZXRQcmltYXJ5S2V5Q29s\ndW1uTmFtZSgpIHsKICAgICAgICByZXR1cm4gZ2V0UHJpbWFyeUtleUNvbHVt\nbklkZW50aWZpZXIoKS5nZXROYW1lKCk7CiAgICB9CgogICAgcHVibGljIERC\nSWRlbnRpZmllciBnZXRQcmltYXJ5S2V5Q29sdW1uSWRlbnRpZmllcigpIHsK\nICAgICAgICByZXR1cm4gX3BrQ29sdW1uTmFtZSA9PSBudWxsID8gREJJZGVu\ndGlmaWVyLk5VTEwgOiBfcGtDb2x1bW5OYW1lOwogICAgfQoKICAgIC8qKgog\nICAgICogVGhlIG5hbWUgb2YgdGhlIHByaW1hcnkga2V5IGNvbHVtbi4gWW91\nIGNhbiBvbmx5IHNldCB0aGUKICAgICAqIHByaW1hcnkga2V5IGNvbHVtbiBu\nYW1lIG9uIGZvcmVpZ24ga2V5cyB0aGF0IGhhdmUgbm90IGFscmVhZHkgYmVl\nbgogICAgICogam9pbmVkLgogICAgICogQGRlcHJlY2F0ZWQKICAgICAqLwog\nICAgcHVibGljIHZvaWQgc2V0UHJpbWFyeUtleUNvbHVtbk5hbWUoU3RyaW5n\nIHBrQ29sdW1uTmFtZSkgewogICAgICAgIHNldFByaW1hcnlLZXlDb2x1bW5J\nZGVudGlmaWVyKERCSWRlbnRpZmllci5uZXdDb2x1bW4ocGtDb2x1bW5OYW1l\nKSk7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0UHJpbWFyeUtleUNvbHVt\nbklkZW50aWZpZXIoREJJZGVudGlmaWVyIHBrQ29sdW1uTmFtZSkgewogICAg\nICAgIGlmIChnZXRQcmltYXJ5S2V5VGFibGUoKSAhPSBudWxsKQogICAgICAg\nICAgICB0aHJvdyBuZXcgSWxsZWdhbFN0YXRlRXhjZXB0aW9uKCk7CiAgICAg\nICAgX3BrQ29sdW1uTmFtZSA9IHBrQ29sdW1uTmFtZTsKICAgIH0KCiAgICAv\nKioKICAgICAqIFRoZSBzZXF1ZW5jZSBvZiB0aGlzIGpvaW4gaW4gdGhlIGZv\ncmVpZ24ga2V5LgogICAgICovCiAgICBwdWJsaWMgaW50IGdldEtleVNlcXVl\nbmNlKCkgewogICAgICAgIHJldHVybiBfc2VxOwogICAgfQoKICAgIC8qKgog\nICAgICogVGhlIHNlcXVlbmNlIG9mIHRoaXMgam9pbiBpbiB0aGUgZm9yZWln\nbiBrZXkuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldEtleVNlcXVlbmNl\nKGludCBzZXEpIHsKICAgICAgICBfc2VxID0gc2VxOwogICAgfQoKICAgIC8q\nKgogICAgICogUmV0dXJuIHRoZSBkZWxldGUgYWN0aW9uIGZvciB0aGUga2V5\nLiBXaWxsIGJlIG9uZSBvZjoKICAgICAqIHtAbGluayAjQUNUSU9OX05PTkV9\nLCB7QGxpbmsgI0FDVElPTl9SRVNUUklDVH0sCiAgICAgKiB7QGxpbmsgI0FD\nVElPTl9DQVNDQURFfSwge0BsaW5rICNBQ1RJT05fTlVMTH0sIHtAbGluayAj\nQUNUSU9OX0RFRkFVTFR9LgogICAgICovCiAgICBwdWJsaWMgaW50IGdldERl\nbGV0ZUFjdGlvbigpIHsKICAgICAgICByZXR1cm4gX2RlbEFjdGlvbjsKICAg\nIH0KCiAgICAvKioKICAgICAqIFNldCB0aGUgZGVsZXRlIGFjdGlvbiBmb3Ig\ndGhlIGtleS4gTXVzdCBiZSBvbmUgb2Y6CiAgICAgKiB7QGxpbmsgI0FDVElP\nTl9OT05FfSwge0BsaW5rICNBQ1RJT05fUkVTVFJJQ1R9LAogICAgICoge0Bs\naW5rICNBQ1RJT05fQ0FTQ0FERX0sIHtAbGluayAjQUNUSU9OX05VTEx9LCB7\nQGxpbmsgI0FDVElPTl9ERUZBVUxUfS4KICAgICAqLwogICAgcHVibGljIHZv\naWQgc2V0RGVsZXRlQWN0aW9uKGludCBhY3Rpb24pIHsKICAgICAgICBfZGVs\nQWN0aW9uID0gYWN0aW9uOwogICAgICAgIGlmIChhY3Rpb24gPT0gQUNUSU9O\nX05PTkUpCiAgICAgICAgICAgIF91cEFjdGlvbiA9IEFDVElPTl9OT05FOwog\nICAgICAgIGVsc2UgaWYgKF91cEFjdGlvbiA9PSBBQ1RJT05fTk9ORSkKICAg\nICAgICAgICAgX3VwQWN0aW9uID0gQUNUSU9OX1JFU1RSSUNUOwogICAgfQoK\nICAgIC8qKgogICAgICogUmV0dXJuIHRoZSB1cGRhdGUgYWN0aW9uIGZvciB0\naGUga2V5LiBXaWxsIGJlIG9uZSBvZjoKICAgICAqIHtAbGluayAjQUNUSU9O\nX05PTkV9LCB7QGxpbmsgI0FDVElPTl9SRVNUUklDVH0sCiAgICAgKiB7QGxp\nbmsgI0FDVElPTl9DQVNDQURFfSwge0BsaW5rICNBQ1RJT05fTlVMTH0sIHtA\nbGluayAjQUNUSU9OX0RFRkFVTFR9LgogICAgICovCiAgICBwdWJsaWMgaW50\nIGdldFVwZGF0ZUFjdGlvbigpIHsKICAgICAgICByZXR1cm4gX3VwQWN0aW9u\nOwogICAgfQoKICAgIC8qKgogICAgICogU2V0IHRoZSB1cGRhdGUgYWN0aW9u\nIGZvciB0aGUga2V5LiBNdXN0IGJlIG9uZSBvZjoKICAgICAqIHtAbGluayAj\nQUNUSU9OX05PTkV9LCB7QGxpbmsgI0FDVElPTl9SRVNUUklDVH0sCiAgICAg\nKiB7QGxpbmsgI0FDVElPTl9DQVNDQURFfSwge0BsaW5rICNBQ1RJT05fTlVM\nTH0sIHtAbGluayAjQUNUSU9OX0RFRkFVTFR9LgogICAgICovCiAgICBwdWJs\naWMgdm9pZCBzZXRVcGRhdGVBY3Rpb24oaW50IGFjdGlvbikgewogICAgICAg\nIF91cEFjdGlvbiA9IGFjdGlvbjsKICAgICAgICBpZiAoYWN0aW9uID09IEFD\nVElPTl9OT05FKQogICAgICAgICAgICBfZGVsQWN0aW9uID0gQUNUSU9OX05P\nTkU7CiAgICAgICAgZWxzZSBpZiAoX2RlbEFjdGlvbiA9PSBBQ1RJT05fTk9O\nRSkKICAgICAgICAgICAgX2RlbEFjdGlvbiA9IEFDVElPTl9SRVNUUklDVDsK\nICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgZm9yZWlnbiBrZXkn\ncyAwLWJhc2VkIGluZGV4IGluIHRoZSBvd25pbmcgdGFibGUuCiAgICAgKi8K\nICAgIHB1YmxpYyBpbnQgZ2V0SW5kZXgoKSB7CiAgICAgICAgVGFibGUgdGFi\nbGUgPSBnZXRUYWJsZSgpOwogICAgICAgIGlmICh0YWJsZSAhPSBudWxsKQog\nICAgICAgICAgICB0YWJsZS5pbmRleEZvcmVpZ25LZXlzKCk7CiAgICAgICAg\ncmV0dXJuIF9pbmRleDsKICAgIH0KCiAgICAvKioKICAgICAqIFNldCB0aGUg\nZm9yZWlnbiBrZXkncyAwLWJhc2VkIGluZGV4IGluIHRoZSBvd25pbmcgdGFi\nbGUuCiAgICAgKi8KICAgIHZvaWQgc2V0SW5kZXgoaW50IGluZGV4KSB7CiAg\nICAgICAgX2luZGV4ID0gaW5kZXg7CiAgICB9CgogICAgLyoqCiAgICAgKiBS\nZXR1cm4gdGhlIHByaW1hcnkga2V5IGNvbHVtbiBqb2luZWQgdG8gdGhlIGdp\ndmVuIGxvY2FsIGNvbHVtbi4KICAgICAqLwogICAgcHVibGljIENvbHVtbiBn\nZXRQcmltYXJ5S2V5Q29sdW1uKENvbHVtbiBsb2NhbCkgewogICAgICAgIHJl\ndHVybiAoX2pvaW5zID09IG51bGwpID8gbnVsbCA6IChDb2x1bW4pIF9qb2lu\ncy5nZXQobG9jYWwpOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRo\nZSBsb2NhbCBjb2x1bW4gam9pbmVkIHRvIHRoZSBnaXZlbiBwcmltYXJ5IGtl\neSBjb2x1bW4uCiAgICAgKi8KICAgIHB1YmxpYyBDb2x1bW4gZ2V0Q29sdW1u\nKENvbHVtbiBwaykgewogICAgICAgIHJldHVybiAoX2pvaW5zUEsgPT0gbnVs\nbCkgPyBudWxsIDogKENvbHVtbikgX2pvaW5zUEsuZ2V0KHBrKTsKICAgIH0K\nCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgY29uc3RhbnQgdmFsdWUgYXNz\naWduZWQgdG8gdGhlIGdpdmVuIGxvY2FsIGNvbHVtbi4KICAgICAqLwogICAg\ncHVibGljIE9iamVjdCBnZXRDb25zdGFudChDb2x1bW4gbG9jYWwpIHsKICAg\nICAgICByZXR1cm4gKF9jb25zdHMgPT0gbnVsbCkgPyBudWxsIDogX2NvbnN0\ncy5nZXQobG9jYWwpOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRo\nZSBjb25zdGFudCB2YWx1ZSBhc3NpZ25lZCB0byB0aGUgZ2l2ZW4gcHJpbWFy\neSBrZXkgY29sdW1uLgogICAgICovCiAgICBwdWJsaWMgT2JqZWN0IGdldFBy\naW1hcnlLZXlDb25zdGFudChDb2x1bW4gcGspIHsKICAgICAgICByZXR1cm4g\nKF9jb25zdHNQSyA9PSBudWxsKSA/IG51bGwgOiBfY29uc3RzUEsuZ2V0KHBr\nKTsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgbG9jYWwgY29s\ndW1ucyBpbiB0aGUgZm9yZWlnbiBrZXkgbG9jYWwgdGFibGUgb3JkZXIuCiAg\nICAgKi8KICAgIHB1YmxpYyBDb2x1bW5bXSBnZXRDb2x1bW5zKCkgewogICAg\nICAgIGlmIChfbG9jYWxzID09IG51bGwpCiAgICAgICAgICAgIF9sb2NhbHMg\nPSAoX2pvaW5zID09IG51bGwpID8gU2NoZW1hcy5FTVBUWV9DT0xVTU5TIDog\nKENvbHVtbltdKQogICAgICAgICAgICAgICAgX2pvaW5zLmtleVNldCgpLnRv\nQXJyYXkobmV3IENvbHVtbltfam9pbnMuc2l6ZSgpXSk7CiAgICAgICAgcmV0\ndXJuIF9sb2NhbHM7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhl\nIGNvbnN0YW50IHZhbHVlcyBhc3NpZ25lZCB0byB0aGUgbG9jYWwgY29sdW1u\ncwogICAgICogcmV0dXJuZWQgYnkge0BsaW5rICNnZXRDb25zdGFudENvbHVt\nbnN9LgogICAgICovCiAgICBwdWJsaWMgT2JqZWN0W10gZ2V0Q29uc3RhbnRz\nKCkgewogICAgICAgIGlmIChfY29uc3RWYWxzID09IG51bGwpCiAgICAgICAg\nICAgIF9jb25zdFZhbHMgPSAoX2NvbnN0cyA9PSBudWxsKSA/IFNjaGVtYXMu\nRU1QVFlfVkFMVUVTCiAgICAgICAgICAgICAgICA6IF9jb25zdHMudmFsdWVz\nKCkudG9BcnJheSgpOwogICAgICAgIHJldHVybiBfY29uc3RWYWxzOwogICAg\nfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRoZSBjb25zdGFudCB2YWx1ZXMg\nYXNzaWduZWQgdG8gdGhlIHByaW1hcnkga2V5IGNvbHVtbnMKICAgICAqIHJl\ndHVybmVkIGJ5IHtAbGluayAjZ2V0Q29uc3RhbnRQcmltYXJ5S2V5Q29sdW1u\nc30uCiAgICAgKi8KICAgIHB1YmxpYyBPYmplY3RbXSBnZXRQcmltYXJ5S2V5\nQ29uc3RhbnRzKCkgewogICAgICAgIGlmIChfY29uc3RWYWxzUEsgPT0gbnVs\nbCkKICAgICAgICAgICAgX2NvbnN0VmFsc1BLID0gKF9jb25zdHNQSyA9PSBu\ndWxsKSA/IFNjaGVtYXMuRU1QVFlfVkFMVUVTCiAgICAgICAgICAgICAgICA6\nIF9jb25zdHNQSy52YWx1ZXMoKS50b0FycmF5KCk7CiAgICAgICAgcmV0dXJu\nIF9jb25zdFZhbHNQSzsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0\ncnVlIGlmIHRoZSBmayBpbmNsdWRlcyB0aGUgZ2l2ZW4gbG9jYWwgY29sdW1u\nLgogICAgICovCiAgICBwdWJsaWMgYm9vbGVhbiBjb250YWluc0NvbHVtbihD\nb2x1bW4gY29sKSB7CiAgICAgICAgcmV0dXJuIF9qb2lucyAhPSBudWxsICYm\nIF9qb2lucy5jb250YWluc0tleShjb2wpOwogICAgfQoKICAgIC8qKgogICAg\nICogUmV0dXJuIHRydWUgaWYgdGhlIGZrIGluY2x1ZGVzIHRoZSBnaXZlbiBw\ncmltYXJ5IGtleSBjb2x1bW4uCiAgICAgKi8KICAgIHB1YmxpYyBib29sZWFu\nIGNvbnRhaW5zUHJpbWFyeUtleUNvbHVtbihDb2x1bW4gY29sKSB7CiAgICAg\nICAgcmV0dXJuIF9qb2luc1BLICE9IG51bGwgJiYgX2pvaW5zUEsuY29udGFp\nbnNLZXkoY29sKTsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0cnVl\nIGlmIHRoZSBmayBpbmNsdWRlcyB0aGUgZ2l2ZW4gbG9jYWwgY29sdW1uLgog\nICAgICovCiAgICBwdWJsaWMgYm9vbGVhbiBjb250YWluc0NvbnN0YW50Q29s\ndW1uKENvbHVtbiBjb2wpIHsKICAgICAgICByZXR1cm4gX2NvbnN0cyAhPSBu\ndWxsICYmIF9jb25zdHMuY29udGFpbnNLZXkoY29sKTsKICAgIH0KCiAgICAv\nKioKICAgICAqIFJldHVybiB0cnVlIGlmIHRoZSBmayBpbmNsdWRlcyB0aGUg\nZ2l2ZW4gcHJpbWFyeSBrZXkgY29sdW1uLgogICAgICovCiAgICBwdWJsaWMg\nYm9vbGVhbiBjb250YWluc0NvbnN0YW50UHJpbWFyeUtleUNvbHVtbihDb2x1\nbW4gY29sKSB7CiAgICAgICAgcmV0dXJuIF9jb25zdHNQSyAhPSBudWxsICYm\nIF9jb25zdHNQSy5jb250YWluc0tleShjb2wpOwogICAgfQoKICAgIC8qKgog\nICAgICogUmV0dXJuIHRoZSBmb3JlaWduIGNvbHVtbnMgaW4gdGhlIGZvcmVp\nZ24ga2V5LCBpbiBqb2luLW9yZGVyIHdpdGgKICAgICAqIHRoZSByZXN1bHQg\nb2Yge0BsaW5rICNnZXRDb2x1bW5zfS4KICAgICAqLwogICAgcHVibGljIENv\nbHVtbltdIGdldFByaW1hcnlLZXlDb2x1bW5zKCkgewogICAgICAgIGlmIChf\ncGtzID09IG51bGwpCiAgICAgICAgICAgIF9wa3MgPSAoX2pvaW5zID09IG51\nbGwpID8gU2NoZW1hcy5FTVBUWV9DT0xVTU5TIDogKENvbHVtbltdKQogICAg\nICAgICAgICAgICAgX2pvaW5zLnZhbHVlcygpLnRvQXJyYXkobmV3IENvbHVt\nbltfam9pbnMuc2l6ZSgpXSk7CiAgICAgICAgcmV0dXJuIF9wa3M7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIGxvY2FsIGNvbHVtbnMgdGhh\ndCB3ZSBsaW5rIHRvIHVzaW5nIGNvbnN0YW50IHZhbHVlcy4KICAgICAqLwog\nICAgcHVibGljIENvbHVtbltdIGdldENvbnN0YW50Q29sdW1ucygpIHsKICAg\nICAgICBpZiAoX2NvbnN0Q29scyA9PSBudWxsKQogICAgICAgICAgICBfY29u\nc3RDb2xzID0gKF9jb25zdHMgPT0gbnVsbCkgPyBTY2hlbWFzLkVNUFRZX0NP\nTFVNTlMgOiAoQ29sdW1uW10pCiAgICAgICAgICAgICAgICBfY29uc3RzLmtl\neVNldCgpLnRvQXJyYXkobmV3IENvbHVtbltfY29uc3RzLnNpemUoKV0pOwog\nICAgICAgIHJldHVybiBfY29uc3RDb2xzOwogICAgfQoKICAgIC8qKgogICAg\nICogUmV0dXJuIHRoZSBwcmltYXJ5IGtleSBjb2x1bW5zIHRoYXQgd2UgbGlu\nayB0byB1c2luZyBjb25zdGFudCB2YWx1ZXMuCiAgICAgKi8KICAgIHB1Ymxp\nYyBDb2x1bW5bXSBnZXRDb25zdGFudFByaW1hcnlLZXlDb2x1bW5zKCkgewog\nICAgICAgIGlmIChfY29uc3RDb2xzUEsgPT0gbnVsbCkKICAgICAgICAgICAg\nX2NvbnN0Q29sc1BLID0gKF9jb25zdHNQSyA9PSBudWxsKSA/IFNjaGVtYXMu\nRU1QVFlfQ09MVU1OUyA6CiAgICAgICAgICAgICAgICAoQ29sdW1uW10pIF9j\nb25zdHNQSy5rZXlTZXQoKS50b0FycmF5CiAgICAgICAgICAgICAgICAgICAg\nKG5ldyBDb2x1bW5bX2NvbnN0c1BLLnNpemUoKV0pOwogICAgICAgIHJldHVy\nbiBfY29uc3RDb2xzUEs7CiAgICB9CgogICAgLyoqCiAgICAgKiBTZXQgdGhl\nIGZvcmVpZ24ga2V5J3Mgam9pbnMuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lk\nIHNldEpvaW5zKENvbHVtbltdIGNvbHMsIENvbHVtbltdIHBrQ29scykgewog\nICAgICAgIENvbHVtbltdIGN1ciA9IGdldENvbHVtbnMoKTsKICAgICAgICBm\nb3IgKGludCBpID0gMDsgaSA8IGN1ci5sZW5ndGg7IGkrKykKICAgICAgICAg\nICAgcmVtb3ZlSm9pbihjdXJbaV0pOwoKICAgICAgICBpZiAoY29scyAhPSBu\ndWxsKQogICAgICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGNvbHMubGVu\nZ3RoOyBpKyspCiAgICAgICAgICAgICAgICBqb2luKGNvbHNbaV0sIHBrQ29s\nc1tpXSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBTZXQgdGhlIGZvcmVpZ24g\na2V5J3MgY29uc3RhbnQgam9pbnMuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lk\nIHNldENvbnN0YW50Sm9pbnMoT2JqZWN0W10gY29uc3RzLCBDb2x1bW5bXSBw\na0NvbHMpIHsKICAgICAgICBDb2x1bW5bXSBjdXIgPSBnZXRDb25zdGFudFBy\naW1hcnlLZXlDb2x1bW5zKCk7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkg\nPCBjdXIubGVuZ3RoOyBpKyspCiAgICAgICAgICAgIHJlbW92ZUpvaW4oY3Vy\nW2ldKTsKCiAgICAgICAgaWYgKGNvbnN0cyAhPSBudWxsKQogICAgICAgICAg\nICBmb3IgKGludCBpID0gMDsgaSA8IGNvbnN0cy5sZW5ndGg7IGkrKykKICAg\nICAgICAgICAgICAgIGpvaW5Db25zdGFudChjb25zdHNbaV0sIHBrQ29sc1tp\nXSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBTZXQgdGhlIGZvcmVpZ24ga2V5\nJ3MgY29uc3RhbnQgam9pbnMuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNl\ndENvbnN0YW50Sm9pbnMoQ29sdW1uW10gY29scywgT2JqZWN0W10gY29uc3Rz\nKSB7CiAgICAgICAgQ29sdW1uW10gY3VyID0gZ2V0Q29uc3RhbnRDb2x1bW5z\nKCk7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBjdXIubGVuZ3RoOyBp\nKyspCiAgICAgICAgICAgIHJlbW92ZUpvaW4oY3VyW2ldKTsKCiAgICAgICAg\naWYgKGNvbnN0cyAhPSBudWxsKQogICAgICAgICAgICBmb3IgKGludCBpID0g\nMDsgaSA8IGNvbnN0cy5sZW5ndGg7IGkrKykKICAgICAgICAgICAgICAgIGpv\naW5Db25zdGFudChjb2xzW2ldLCBjb25zdHNbaV0pOwogICAgfQoKICAgIC8q\nKgogICAgICogSm9pbiBhIGxvY2FsIGNvbHVtbiB0byBhIHByaW1hcnkga2V5\nIGNvbHVtbiBvZiBhbm90aGVyIHRhYmxlLgogICAgICovCiAgICBwdWJsaWMg\ndm9pZCBqb2luKENvbHVtbiBsb2NhbCwgQ29sdW1uIHRvUEspIHsKICAgICAg\nICBpZiAoIU9iamVjdFV0aWxzLmVxdWFscyhsb2NhbC5nZXRUYWJsZSgpLCBn\nZXRUYWJsZSgpKSkKICAgICAgICAgICAgdGhyb3cgbmV3IEludmFsaWRTdGF0\nZUV4Y2VwdGlvbihfbG9jLmdldCgidGFibGUtbWlzbWF0Y2giLAogICAgICAg\nICAgICAgICAgbG9jYWwuZ2V0VGFibGUoKSwgZ2V0VGFibGUoKSkpOwoKICAg\nICAgICBUYWJsZSBwa1RhYmxlID0gdG9QSy5nZXRUYWJsZSgpOwogICAgICAg\nIGlmIChfcGtUYWJsZSAhPSBudWxsICYmICFfcGtUYWJsZS5lcXVhbHMocGtU\nYWJsZSkpCiAgICAgICAgICAgIHRocm93IG5ldyBJbnZhbGlkU3RhdGVFeGNl\ncHRpb24oX2xvYy5nZXQoImZrLW1pc21hdGNoIiwKICAgICAgICAgICAgICAg\nIHBrVGFibGUsIF9wa1RhYmxlKSk7CgogICAgICAgIF9wa1RhYmxlID0gcGtU\nYWJsZTsKICAgICAgICBpZiAoX2pvaW5zID09IG51bGwpCiAgICAgICAgICAg\nIF9qb2lucyA9IG5ldyBMaW5rZWRIYXNoTWFwKCk7CiAgICAgICAgX2pvaW5z\nLnB1dChsb2NhbCwgdG9QSyk7CiAgICAgICAgaWYgKF9qb2luc1BLID09IG51\nbGwpCiAgICAgICAgICAgIF9qb2luc1BLID0gbmV3IExpbmtlZEhhc2hNYXAo\nKTsKICAgICAgICBfam9pbnNQSy5wdXQodG9QSywgbG9jYWwpOwoKICAgICAg\nICAvLyBmb3JjZSByZS1jYWNoZQogICAgICAgIF9sb2NhbHMgPSBudWxsOwog\nICAgICAgIF9wa3MgPSBudWxsOwogICAgICAgIGlmIChfYXV0b0Fzc2lnbiA9\nPSBCb29sZWFuLkZBTFNFKQogICAgICAgICAgICBfYXV0b0Fzc2lnbiA9IG51\nbGw7CiAgICB9CgogICAgLyoqCiAgICAgKiBKb2luIGEgY29uc3RhbnQgdmFs\ndWUgdG8gYSBwcmltYXJ5IGtleSBjb2x1bW4gb2YgYW5vdGhlciB0YWJsZS4g\nVGhlCiAgICAgKiBjb25zdGFudCBtdXN0IGJlIGVpdGhlciBhIHN0cmluZyBv\nciBhIG51bWJlci4KICAgICAqLwogICAgcHVibGljIHZvaWQgam9pbkNvbnN0\nYW50KE9iamVjdCB2YWwsIENvbHVtbiB0b1BLKSB7CiAgICAgICAgVGFibGUg\ncGtUYWJsZSA9IHRvUEsuZ2V0VGFibGUoKTsKICAgICAgICBpZiAoX3BrVGFi\nbGUgIT0gbnVsbCAmJiAhX3BrVGFibGUuZXF1YWxzKHBrVGFibGUpKQogICAg\nICAgICAgICB0aHJvdyBuZXcgSW52YWxpZFN0YXRlRXhjZXB0aW9uKF9sb2Mu\nZ2V0KCJmay1taXNtYXRjaCIsCiAgICAgICAgICAgICAgICBwa1RhYmxlLCBf\ncGtUYWJsZSkpOwoKICAgICAgICBfcGtUYWJsZSA9IHBrVGFibGU7CiAgICAg\nICAgaWYgKF9jb25zdHNQSyA9PSBudWxsKQogICAgICAgICAgICBfY29uc3Rz\nUEsgPSBuZXcgTGlua2VkSGFzaE1hcCgpOwogICAgICAgIF9jb25zdHNQSy5w\ndXQodG9QSywgdmFsKTsKCiAgICAgICAgLy8gZm9yY2UgcmUtY2FjaGUKICAg\nICAgICBfY29uc3RWYWxzUEsgPSBudWxsOwogICAgICAgIF9jb25zdENvbHNQ\nSyA9IG51bGw7CiAgICB9CgogICAgLyoqCiAgICAgKiBKb2luIGEgY29uc3Rh\nbnQgdmFsdWUgdG8gYSBsb2NhbCBjb2x1bW4gb2YgdGhpcyB0YWJsZS4gVGhl\nCiAgICAgKiBjb25zdGFudCBtdXN0IGJlIGVpdGhlciBhIHN0cmluZyBvciBh\nIG51bWJlci4KICAgICAqLwogICAgcHVibGljIHZvaWQgam9pbkNvbnN0YW50\nKENvbHVtbiBjb2wsIE9iamVjdCB2YWwpIHsKICAgICAgICBpZiAoX2NvbnN0\ncyA9PSBudWxsKQogICAgICAgICAgICBfY29uc3RzID0gbmV3IExpbmtlZEhh\nc2hNYXAoKTsKICAgICAgICBfY29uc3RzLnB1dChjb2wsIHZhbCk7CgogICAg\nICAgIC8vIGZvcmNlIHJlLWNhY2hlCiAgICAgICAgX2NvbnN0VmFscyA9IG51\nbGw7CiAgICAgICAgX2NvbnN0Q29scyA9IG51bGw7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBSZW1vdmUgYW55IGpvaW5zIGlub2x2aW5nIHRoZSBnaXZlbiBj\nb2x1bW4uCiAgICAgKgogICAgICogQHJldHVybiB0cnVlIGlmIHRoZSBqb2lu\nIHdhcyByZW1vdmVkLCBmYWxzZSBpZiBub3QgcGFydCBvZiB0aGUga2V5CiAg\nICAgKi8KICAgIHB1YmxpYyBib29sZWFuIHJlbW92ZUpvaW4oQ29sdW1uIGNv\nbCkgewogICAgICAgIGJvb2xlYW4gcmVtZCA9IGZhbHNlOwogICAgICAgIE9i\namVjdCByZW07CgogICAgICAgIGlmIChfam9pbnMgIT0gbnVsbCkgewogICAg\nICAgICAgICByZW0gPSBfam9pbnMucmVtb3ZlKGNvbCk7CiAgICAgICAgICAg\nIGlmIChyZW0gIT0gbnVsbCkgewogICAgICAgICAgICAgICAgX2xvY2FscyA9\nIG51bGw7CiAgICAgICAgICAgICAgICBfcGtzID0gbnVsbDsKICAgICAgICAg\nICAgICAgIF9qb2luc1BLLnJlbW92ZShyZW0pOwogICAgICAgICAgICAgICAg\ncmVtZCA9IHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAg\nIGlmIChfam9pbnNQSyAhPSBudWxsKSB7CiAgICAgICAgICAgIHJlbSA9IF9q\nb2luc1BLLnJlbW92ZShjb2wpOwogICAgICAgICAgICBpZiAocmVtICE9IG51\nbGwpIHsKICAgICAgICAgICAgICAgIF9sb2NhbHMgPSBudWxsOwogICAgICAg\nICAgICAgICAgX3BrcyA9IG51bGw7CiAgICAgICAgICAgICAgICBfam9pbnMu\ncmVtb3ZlKHJlbSk7CiAgICAgICAgICAgICAgICByZW1kID0gdHJ1ZTsKICAg\nICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgKF9jb25zdHMgIT0g\nbnVsbCkgewogICAgICAgICAgICBpZiAoX2NvbnN0cy5yZW1vdmUoY29sKSAh\nPSBudWxsKSB7CiAgICAgICAgICAgICAgICBfY29uc3RWYWxzID0gbnVsbDsK\nICAgICAgICAgICAgICAgIF9jb25zdENvbHMgPSBudWxsOwogICAgICAgICAg\nICAgICAgcmVtZCA9IHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICB9Cgog\nICAgICAgIGlmIChfY29uc3RzUEsgIT0gbnVsbCkgewogICAgICAgICAgICBp\nZiAoX2NvbnN0c1BLLmNvbnRhaW5zS2V5KGNvbCkpIHsKICAgICAgICAgICAg\nICAgIF9jb25zdHNQSy5yZW1vdmUoY29sKTsKICAgICAgICAgICAgICAgIF9j\nb25zdFZhbHNQSyA9IG51bGw7CiAgICAgICAgICAgICAgICBfY29uc3RDb2xz\nUEsgPSBudWxsOwogICAgICAgICAgICAgICAgcmVtZCA9IHRydWU7CiAgICAg\nICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGlmICgoX2pvaW5zID09IG51\nbGwgfHwgX2pvaW5zLmlzRW1wdHkoKSkKICAgICAgICAgICAgJiYgKF9jb25z\ndHNQSyA9PSBudWxsIHx8IF9jb25zdHNQSy5pc0VtcHR5KCkpKQogICAgICAg\nICAgICBfcGtUYWJsZSA9IG51bGw7CiAgICAgICAgaWYgKHJlbWQgJiYgX2F1\ndG9Bc3NpZ24gPT0gQm9vbGVhbi5UUlVFKQogICAgICAgICAgICBfYXV0b0Fz\nc2lnbiA9IG51bGw7CiAgICAgICAgcmV0dXJuIHJlbWQ7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBSZXR1cm5zIHRoZSB0YWJsZSB0aGlzIGZvcmVpZ24ga2V5\nIGlzIGxpbmtpbmcgdG8sIGlmIGl0IGlzIGtub3duIHlldC4KICAgICAqLwog\nICAgcHVibGljIFRhYmxlIGdldFByaW1hcnlLZXlUYWJsZSgpIHsKICAgICAg\nICByZXR1cm4gX3BrVGFibGU7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZWYg\nYWxsIGNvbHVtbnMgaW4gdGhpcyBrZXkuCiAgICAgKi8KICAgIHB1YmxpYyB2\nb2lkIHJlZkNvbHVtbnMoKSB7CiAgICAgICAgQ29sdW1uW10gY29scyA9IGdl\ndENvbHVtbnMoKTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGNvbHMu\nbGVuZ3RoOyBpKyspCiAgICAgICAgICAgIGNvbHNbaV0ucmVmKCk7CiAgICAg\nICAgY29scyA9IGdldENvbnN0YW50Q29sdW1ucygpOwogICAgICAgIGZvciAo\naW50IGkgPSAwOyBpIDwgY29scy5sZW5ndGg7IGkrKykKICAgICAgICAgICAg\nY29sc1tpXS5yZWYoKTsKICAgIH0KCiAgICAvKioKICAgICAqIERlcmVmIGFs\nbCBjb2x1bW5zIGluIHRoaXMga2V5LgogICAgICovCiAgICBwdWJsaWMgdm9p\nZCBkZXJlZkNvbHVtbnMoKSB7CiAgICAgICAgQ29sdW1uW10gY29scyA9IGdl\ndENvbHVtbnMoKTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGNvbHMu\nbGVuZ3RoOyBpKyspCiAgICAgICAgICAgIGNvbHNbaV0uZGVyZWYoKTsKICAg\nICAgICBjb2xzID0gZ2V0Q29uc3RhbnRDb2x1bW5zKCk7CiAgICAgICAgZm9y\nIChpbnQgaSA9IDA7IGkgPCBjb2xzLmxlbmd0aDsgaSsrKQogICAgICAgICAg\nICBjb2xzW2ldLmRlcmVmKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBGb3Jl\naWduIGtleXMgYXJlIGVxdWFsIGlmIHRoZSBzYXRpc2Z5IHRoZSBlcXVhbGl0\neSBjb25zdHJhaW50cyBvZgogICAgICoge0BsaW5rIENvbnN0cmFpbnR9IGFu\nZCB0aGV5IGhhdmUgdGhlIHNhbWUgbG9jYWwgYW5kIHByaW1hcnkga2V5CiAg\nICAgKiBjb2x1bW5zIGFuZCBhY3Rpb24uCiAgICAgKi8KICAgIHB1YmxpYyBi\nb29sZWFuIGVxdWFsc0ZvcmVpZ25LZXkoRm9yZWlnbktleSBmaykgewogICAg\nICAgIGlmIChmayA9PSB0aGlzKQogICAgICAgICAgICByZXR1cm4gdHJ1ZTsK\nICAgICAgICBpZiAoZmsgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIGZh\nbHNlOwoKICAgICAgICBpZiAoZ2V0RGVsZXRlQWN0aW9uKCkgIT0gZmsuZ2V0\nRGVsZXRlQWN0aW9uKCkpCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAg\nICAgICBpZiAoaXNEZWZlcnJlZCgpICE9IGZrLmlzRGVmZXJyZWQoKSkKICAg\nICAgICAgICAgcmV0dXJuIGZhbHNlOwoKICAgICAgICBpZiAoIWNvbHVtbnNN\nYXRjaChmay5nZXRDb2x1bW5zKCksIGZrLmdldFByaW1hcnlLZXlDb2x1bW5z\nKCkpKQogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgaWYgKCFt\nYXRjaChnZXRDb25zdGFudENvbHVtbnMoKSwgZmsuZ2V0Q29uc3RhbnRDb2x1\nbW5zKCkpKQogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgaWYg\nKCFtYXRjaChnZXRDb25zdGFudHMoKSwgZmsuZ2V0Q29uc3RhbnRzKCkpKQog\nICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgaWYgKCFtYXRjaChn\nZXRDb25zdGFudFByaW1hcnlLZXlDb2x1bW5zKCksCiAgICAgICAgICAgIGZr\nLmdldENvbnN0YW50UHJpbWFyeUtleUNvbHVtbnMoKSkpCiAgICAgICAgICAg\nIHJldHVybiBmYWxzZTsKICAgICAgICBpZiAoIW1hdGNoKGdldFByaW1hcnlL\nZXlDb25zdGFudHMoKSwgZmsuZ2V0UHJpbWFyeUtleUNvbnN0YW50cygpKSkK\nICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIHJldHVybiB0cnVl\nOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRydWUgaWYgdGhlIGdp\ndmVuIGxvY2FsIGFuZCBmb3JlaWduIGNvbHVtbnMgbWF0Y2ggdGhvc2UKICAg\nICAqIG9uIHRoaXMga2V5LiBUaGlzIGNhbiBiZSB1c2VkIHRvIGZpbmQgZm9y\nZWlnbiBrZXlzIGdpdmVuIG9ubHkKICAgICAqIGNvbHVtbiBsaW5raW5nIGlu\nZm9ybWF0aW9uLgogICAgICovCiAgICBwdWJsaWMgYm9vbGVhbiBjb2x1bW5z\nTWF0Y2goQ29sdW1uW10gZmtDb2xzLCBDb2x1bW5bXSBma1BLQ29scykgewog\nICAgICAgIHJldHVybiBtYXRjaChnZXRDb2x1bW5zKCksIGZrQ29scykKICAg\nICAgICAgICAgJiYgbWF0Y2goZ2V0UHJpbWFyeUtleUNvbHVtbnMoKSwgZmtQ\nS0NvbHMpOwogICAgfQoKICAgIC8qKgogICAgICogQ2hlY2tzIGZvciBub24t\nbnVsbGFibGUgbG9jYWwgY29sdW1ucy4KICAgICAqLwogICAgcHVibGljIGJv\nb2xlYW4gaGFzTm90TnVsbENvbHVtbnMoKSB7CiAgICAgIENvbHVtbltdIGNv\nbHVtbnMgPSBnZXRDb2x1bW5zKCk7CiAgICAgIGZvciAoaW50IGogPSAwOyBq\nIDwgY29sdW1ucy5sZW5ndGg7IGorKykgewogICAgICAgICAgaWYgKGNvbHVt\nbnNbal0uaXNOb3ROdWxsKCkpIHsKICAgICAgICAgICAgICByZXR1cm4gdHJ1\nZTsKICAgICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gZmFsc2U7CiAg\nICB9CiAgICAKICAgIHByaXZhdGUgc3RhdGljIGJvb2xlYW4gbWF0Y2goQ29s\ndW1uW10gY29scywgQ29sdW1uW10gZmtDb2xzKSB7CiAgICAgICAgaWYgKGNv\nbHMubGVuZ3RoICE9IGZrQ29scy5sZW5ndGgpCiAgICAgICAgICAgIHJldHVy\nbiBmYWxzZTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGZrQ29scy5s\nZW5ndGg7IGkrKykKICAgICAgICAgICAgaWYgKCFoYXNDb2x1bW4oY29scywg\nZmtDb2xzW2ldKSkKICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAg\nICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBwcml2YXRlIHN0YXRpYyBi\nb29sZWFuIGhhc0NvbHVtbihDb2x1bW5bXSBjb2xzLCBDb2x1bW4gY29sKSB7\nCiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBjb2xzLmxlbmd0aDsgaSsr\nKQogICAgICAgICAgICBpZiAoY29sc1tpXS5nZXRRdWFsaWZpZWRQYXRoKCku\nZXF1YWxzKGNvbC5nZXRRdWFsaWZpZWRQYXRoKCkpKQogICAgICAgICAgICAg\nICAgcmV0dXJuIHRydWU7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoK\nICAgIHByaXZhdGUgc3RhdGljIGJvb2xlYW4gbWF0Y2goT2JqZWN0W10gdmFs\ncywgT2JqZWN0W10gZmtWYWxzKSB7CiAgICAgICAgaWYgKHZhbHMubGVuZ3Ro\nICE9IGZrVmFscy5sZW5ndGgpCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsK\nICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IHZhbHMubGVuZ3RoOyBpKysp\nCiAgICAgICAgICAgIGlmICghT2JqZWN0VXRpbHMuZXF1YWxzKHZhbHNbaV0s\nIGZrVmFsc1tpXSkpCiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAg\nICAgICAgcmV0dXJuIHRydWU7CiAgICB9CiAgICAKICAgIC8qKgogICAgICog\nUmV0dXJuIHRoZSBuYW1lIG9mIHRoZSBmb3JlaWdua2V5IGNvbnN0cmFpbnQg\nYXMgZGVmaW5lZCBpbiB0aGUgZGF0YWJhc2UuCiAgICAgKiBAZGVwcmVjYXRl\nZAogICAgICovCiAgICBwdWJsaWMgU3RyaW5nIGxvYWROYW1lRnJvbURCKERC\nRGljdGlvbmFyeSBkYmRpY3QsIENvbm5lY3Rpb24gY29ubikgewogICAgICAg\nIHJldHVybiBsb2FkSWRlbnRpZmllckZyb21EQihkYmRpY3QsIGNvbm4pLmdl\ndE5hbWUoKTsKICAgIH0KCiAgICBwdWJsaWMgREJJZGVudGlmaWVyIGxvYWRJ\nZGVudGlmaWVyRnJvbURCKERCRGljdGlvbmFyeSBkYmRpY3QsIENvbm5lY3Rp\nb24gY29ubikgewogICAgICAgIGlmKCBpc0xvZ2ljYWwoKSB8fCBnZXRUYWJs\nZSgpID09IG51bGwpCiAgICAgICAgICAgIHJldHVybiBEQklkZW50aWZpZXIu\nTlVMTDsKICAgICAgICBEQklkZW50aWZpZXIgcmV0VmFsID0gREJJZGVudGlm\naWVyLk5VTEw7CiAgICAgICAgdHJ5ewogICAgICAgICAgICBTY2hlbWEgc2No\nZW1hID0gZ2V0VGFibGUoKS5nZXRTY2hlbWEoKTsKICAgICAgICAgICAgRm9y\nZWlnbktleVtdIGZrcyA9IGRiZGljdC5nZXRJbXBvcnRlZEtleXMoY29ubi5n\nZXRNZXRhRGF0YSgpLCAKICAgICAgICAgICAgICAgIERCSWRlbnRpZmllci5u\nZXdDYXRhbG9nKGNvbm4uZ2V0Q2F0YWxvZygpKSwgc2NoZW1hLmdldElkZW50\naWZpZXIoKSwgCiAgICAgICAgICAgICAgICBnZXRUYWJsZSgpLmdldElkZW50\naWZpZXIoKSwgY29ubiwgZmFsc2UpOwogICAgICAgICAgICBmb3IgKCBpbnQg\naT0wOyBpPCBma3MubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICAgIFRh\nYmxlIGxvY2FsdGFibGUgPSBzY2hlbWEuZ2V0VGFibGUoZmtzW2ldLmdldFRh\nYmxlSWRlbnRpZmllcigpKTsKICAgICAgICAgICAgICAgIFRhYmxlIHBrVGFi\nbGUgPSBzY2hlbWEuZ2V0VGFibGUoCiAgICAgICAgICAgICAgICAgICAgZmtz\nW2ldLmdldFByaW1hcnlLZXlUYWJsZUlkZW50aWZpZXIoKSk7CiAgICAgICAg\nICAgICAgICBib29sZWFuIGFkZEZLID0gZmFsc2U7CiAgICAgICAgICAgICAg\nICBGb3JlaWduS2V5IGZrVGVtcCA9IGxvY2FsdGFibGUuZ2V0Rm9yZWlnbktl\neSgKICAgICAgICAgICAgICAgICAgICBma3NbaV0uZ2V0SWRlbnRpZmllcigp\nKTsKICAgICAgICAgICAgICAgIGlmKCBma1RlbXAgPT0gbnVsbCkgewogICAg\nICAgICAgICAgICAgICAgIGFkZEZLPXRydWU7CiAgICAgICAgICAgICAgICAg\nICAgZmtUZW1wID0gbG9jYWx0YWJsZS5hZGRGb3JlaWduS2V5KAogICAgICAg\nICAgICAgICAgICAgICAgICBma3NbaV0uZ2V0SWRlbnRpZmllcigpKTsKICAg\nICAgICAgICAgICAgICAgICBma1RlbXAuc2V0RGVmZXJyZWQoZmtzW2ldLmlz\nRGVmZXJyZWQoKSk7CiAgICAgICAgICAgICAgICAgICAgZmtUZW1wLnNldERl\nbGV0ZUFjdGlvbihma3NbaV0uZ2V0RGVsZXRlQWN0aW9uKCkpOwogICAgICAg\nICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKGZrc1tpXS5nZXRDb2x1\nbW5zKCkgPT0gbnVsbCB8fCBma3NbaV0uZ2V0Q29sdW1ucygpLmxlbmd0aCA9\nPSAwKSB7CiAgICAgICAgICAgICAgICAgICAgLy8gU2luZ3VsYXIgY29sdW1u\nIGZvcmVpZ24ga2V5IAogICAgICAgICAgICAgICAgICAgIGlmKCAhIGZrVGVt\ncC5jb250YWluc0NvbHVtbigKICAgICAgICAgICAgICAgICAgICAgICAgbG9j\nYWx0YWJsZS5nZXRDb2x1bW4oZmtzW2ldLmdldENvbHVtbklkZW50aWZpZXIo\nKSkpKQogICAgICAgICAgICAgICAgICAgIGZrVGVtcC5qb2luKGxvY2FsdGFi\nbGUuZ2V0Q29sdW1uKGZrc1tpXS5nZXRDb2x1bW5JZGVudGlmaWVyKCkpLCAK\nICAgICAgICAgICAgICAgICAgICAgICAgcGtUYWJsZS5nZXRDb2x1bW4oZmtz\nW2ldLmdldFByaW1hcnlLZXlDb2x1bW5JZGVudGlmaWVyKCkpKTsKICAgICAg\nICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgLy8gQWRk\nIHRoZSBtdWx0aS1jb2x1bW4gZm9yZWlnbiBrZXksIGpvaW5pbmcgbG9jYWwg\nYW5kIHBrIGNvbHVtbnMgaW4KICAgICAgICAgICAgICAgICAgICAvLyB0aGUg\ndGVtcG9yYXJ5IGtleQogICAgICAgICAgICAgICAgICAgIENvbHVtbltdIGxv\nY0NvbHMgPSBma3NbaV0uZ2V0Q29sdW1ucygpOwogICAgICAgICAgICAgICAg\nICAgIENvbHVtbltdIHBrQ29scyA9IGZrc1tpXS5nZXRQcmltYXJ5S2V5Q29s\ndW1ucygpOwogICAgICAgICAgICAgICAgICAgIC8vIENvbHVtbiBjb3VudHMg\nbXVzdCBtYXRjaAogICAgICAgICAgICAgICAgICAgIGlmIChsb2NDb2xzICE9\nIG51bGwgJiYgcGtDb2xzICE9IG51bGwgJiAKICAgICAgICAgICAgICAgICAg\nICAgICAgbG9jQ29scy5sZW5ndGggIT0gcGtDb2xzLmxlbmd0aCkgewogICAg\nICAgICAgICAgICAgICAgICAgICBMb2cgbG9nID0gZGJkaWN0LmdldExvZygp\nOwogICAgICAgICAgICAgICAgICAgICAgICBpZiAobG9nLmlzVHJhY2VFbmFi\nbGVkKCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvZy50cmFj\nZShfbG9jLmdldCgiZmstY29sdW1uLW1pc21hdGNoIikpOwogICAgICAgICAg\nICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAg\nICAgICAgICAgICAgIGZvciAoaW50IGogPSAwOyBqIDwgbG9jQ29scy5sZW5n\ndGg7IGorKykgewogICAgICAgICAgICAgICAgICAgICAgICBpZiggISBma1Rl\nbXAuY29udGFpbnNDb2x1bW4oCiAgICAgICAgICAgICAgICAgICAgICAgICAg\nICBsb2NhbHRhYmxlLmdldENvbHVtbihsb2NDb2xzW2pdLmdldElkZW50aWZp\nZXIoKSkpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBma1RlbXAu\nam9pbihsb2NhbHRhYmxlLmdldENvbHVtbihsb2NDb2xzW2pdLmdldElkZW50\naWZpZXIoKSksIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBr\nVGFibGUuZ2V0Q29sdW1uKHBrQ29sc1tqXS5nZXRJZGVudGlmaWVyKCkpKTsK\nICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAg\nIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmKCBlcXVh\nbHNGb3JlaWduS2V5KGZrVGVtcCkpCiAgICAgICAgICAgICAgICB7CiAgICAg\nICAgICAgICAgICAgICAgaWYoYWRkRkspCiAgICAgICAgICAgICAgICAgICAg\nICAgIGxvY2FsdGFibGUucmVtb3ZlRm9yZWlnbktleShma1RlbXApOwogICAg\nICAgICAgICAgICAgICAgIHJldFZhbCA9IGZrc1tpXS5nZXRJZGVudGlmaWVy\nKCk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAg\nICB9CiAgICAgICAgICAgICAgICBpZihhZGRGSykKICAgICAgICAgICAgICAg\nICAgICBsb2NhbHRhYmxlLnJlbW92ZUZvcmVpZ25LZXkoZmtUZW1wKTsKICAg\nICAgICAgICAgfQogICAgICAgIH0gY2F0Y2goRXhjZXB0aW9uIGV4KXsKICAg\nICAgICAgICAgTG9nIGxvZyA9IGRiZGljdC5nZXRMb2coKTsKICAgICAgICAg\nICAgaWYgKGxvZy5pc1RyYWNlRW5hYmxlZCgpKSB7CiAgICAgICAgICAgICAg\nICBsb2cudHJhY2UoX2xvYy5nZXQoImV4Y2VwdC1yZWFkLWZrLW5hbWUiKSwg\nZXgpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiBy\nZXRWYWw7CiAgICB9CgogICAgLyoqCiAgICAgKiBKb2lucyB0aGUgY29sdW1u\nIG9mIGEgc2luZ2xlIGNvbHVtbiBGSyB0byB0aGlzIEZLLgogICAgICogQHBh\ncmFtIGZrCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIGFkZENvbHVtbihGb3Jl\naWduS2V5IGZrKSB7CiAgICAgICAgLy8gQ29udmVydCBzaW1wbGUgbmFtZSBi\nYXNlZCBmayB0byBhIG11bHRpLWNvbHVtbiBGSyBpZiBuZWNlc3NhcnkuCiAg\nICAgICAgaWYgKGdldENvbHVtbnMoKSA9PSBudWxsIHx8IGdldENvbHVtbnMo\nKS5sZW5ndGggPT0gMCkgewogICAgICAgICAgICAvLyBJZiB0aGlzIEZLIGlz\nIHNpbmdsZSBjb2x1bW4ga2V5LCBjb3ZlcnQgdG8gYSBtdWx0aS1jb2x1bW4g\na2V5CiAgICAgICAgICAgIENvbHVtbltdIGtleUNvbHMgPSBjcmVhdGVLZXlD\nb2x1bW5zKHRoaXMpOwogICAgICAgICAgICBpZiAoa2V5Q29sc1swXSAhPSBu\ndWxsICYmIGtleUNvbHNbMV0gIT0gbnVsbCkgewogICAgICAgICAgICAgICAg\nc2V0UHJpbWFyeUtleUNvbHVtbklkZW50aWZpZXIoREJJZGVudGlmaWVyLk5V\nTEwpOwogICAgICAgICAgICAgICAgc2V0Q29sdW1uSWRlbnRpZmllcihEQklk\nZW50aWZpZXIuTlVMTCk7CiAgICAgICAgICAgICAgICBqb2luKGtleUNvbHNb\nMF0sIGtleUNvbHNbMV0pOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAg\nICAgIC8vIENyZWF0ZSB0aGUgbG9jYWwgYW5kIHByaW1hcnkga2V5IGNvbHVt\nbnMgZnJvbSB0aGUgZmsgYW5kIGFkZCB0aGVtCiAgICAgICAgLy8gdG8gdGhp\ncyBmay4KICAgICAgICBDb2x1bW5bXSBrZXlDb2xzID0gY3JlYXRlS2V5Q29s\ndW1ucyhmayk7CiAgICAgICAgaWYgKGtleUNvbHNbMF0gIT0gbnVsbCAmJiBr\nZXlDb2xzWzFdICE9IG51bGwpIHsKICAgICAgICAgICAgam9pbihrZXlDb2xz\nWzBdLCBrZXlDb2xzWzFdKTsKICAgICAgICB9CiAgICB9CiAgICAKICAgIC8q\nCiAgICAgKiBDcmVhdGVzIHRoZSBsb2NhbCBhbmQgcHJpbWFyeSBrZXkgY29s\ndW1ucyBmb3IgYSBuYW1lLWJhc2VkIGZrLiAKICAgICAqIEByZXR1cm4gQ29s\ndW1uW10gZWxlbWVudCAwIGlzIGxvY2FsIGNvbHVtbgogICAgICogICAgICAg\nICAgICAgICAgICBlbGVtZW50IDEgaXMgdGhlIHByaW1hcnkga2V5IGluIGFu\nb3RoZXIgdGFibGUuCiAgICAgKi8KICAgIHByaXZhdGUgc3RhdGljIENvbHVt\nbltdIGNyZWF0ZUtleUNvbHVtbnMoRm9yZWlnbktleSBmaykgewogICAgICAg\nIENvbHVtbiBma0NvbCA9IG51bGw7CiAgICAgICAgaWYgKCFEQklkZW50aWZp\nZXIuaXNFbXB0eShmay5nZXRDb2x1bW5JZGVudGlmaWVyKCkpKSB7CiAgICAg\nICAgICAgIGZrQ29sID0gbmV3IENvbHVtbigpOwogICAgICAgICAgICBma0Nv\nbC5zZXRJZGVudGlmaWVyKGZrLmdldENvbHVtbklkZW50aWZpZXIoKSk7CiAg\nICAgICAgICAgIGZrQ29sLnNldFRhYmxlSWRlbnRpZmllcihmay5nZXRUYWJs\nZUlkZW50aWZpZXIoKSk7CiAgICAgICAgICAgIGZrQ29sLnNldFNjaGVtYUlk\nZW50aWZpZXIoZmsuZ2V0U2NoZW1hSWRlbnRpZmllcigpKTsKICAgICAgICB9\nCiAgICAgICAgCiAgICAgICAgQ29sdW1uIHBrQ29sID0gbnVsbDsKICAgICAg\nICBpZiAoIURCSWRlbnRpZmllci5pc0VtcHR5KGZrLmdldFByaW1hcnlLZXlD\nb2x1bW5JZGVudGlmaWVyKCkpKSB7CiAgICAgICAgICAgIHBrQ29sID0gbmV3\nIENvbHVtbigpOwogICAgICAgICAgICBwa0NvbC5zZXRJZGVudGlmaWVyKGZr\nLmdldFByaW1hcnlLZXlDb2x1bW5JZGVudGlmaWVyKCkpOwogICAgICAgICAg\nICBwa0NvbC5zZXRUYWJsZUlkZW50aWZpZXIoZmsuZ2V0UHJpbWFyeUtleVRh\nYmxlSWRlbnRpZmllcigpKTsKICAgICAgICAgICAgcGtDb2wuc2V0U2NoZW1h\nSWRlbnRpZmllcihmay5nZXRQcmltYXJ5S2V5U2NoZW1hSWRlbnRpZmllcigp\nKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIG5ldyBDb2x1bW5bXSB7IGZr\nQ29sLCBwa0NvbCB9OwogICAgfQogICAgCiAgICAvKgogICAgICogRm9yZWln\nbktleSB1dGlsaXR5IGNsYXNzIHdoaWNoIGRldGVybWluZXMgZXF1YWxpdHkg\nYmFzZWQgdXBvbiB0aGUgCiAgICAgKiBub24tY29sdW1uIHN0YXRlIG9mIHRo\nZSBrZXlzLiAgCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0aWMgY2xhc3MgRktN\nYXBLZXkgewogICAgICAgIAogICAgICAgIHByaXZhdGUgRm9yZWlnbktleSBf\nZms7CgogICAgICAgIHB1YmxpYyBGS01hcEtleShGb3JlaWduS2V5IGZrKSB7\nCiAgICAgICAgICAgIF9mayA9IGZrOwogICAgICAgIH0KICAgICAgICBwdWJs\naWMgRm9yZWlnbktleSBnZXRGaygpIHsKICAgICAgICAgICAgcmV0dXJuIF9m\nazsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBpbnQgaGFzaENvZGUoKSB7\nCiAgICAgICAgICAgIHJldHVybiBnZXRGaygpLmdldElkZW50aWZpZXIoKSAh\nPSBudWxsID8gZ2V0RmsoKS5nZXRJZGVudGlmaWVyKCkuaGFzaENvZGUoKSA6\nIGdldEZrKCkuaGFzaENvZGUoKTsKICAgICAgICB9CiAgICAgICAgCiAgICAg\nICAgcHVibGljIGJvb2xlYW4gZXF1YWxzKE9iamVjdCBma09iaikgewogICAg\nICAgICAgICBpZiAoZmtPYmogPT0gdGhpcykgewogICAgICAgICAgICAgICAg\ncmV0dXJuIHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKGZr\nT2JqID09IG51bGwgfHwgIShma09iaiBpbnN0YW5jZW9mIEZLTWFwS2V5KSkg\newogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICB9\nCiAgICAgICAgICAgIEZvcmVpZ25LZXkgZmsgPSAoKEZLTWFwS2V5KWZrT2Jq\nKS5nZXRGaygpOwogICAgICAgICAgICBpZiAoZ2V0RmsoKS5nZXREZWxldGVB\nY3Rpb24oKSAhPSBmay5nZXREZWxldGVBY3Rpb24oKSkKICAgICAgICAgICAg\nICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgaWYgKGdldEZrKCkuaXNE\nZWZlcnJlZCgpICE9IGZrLmlzRGVmZXJyZWQoKSkKICAgICAgICAgICAgICAg\nIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgaWYgKCFnZXRGaygpLmdldElk\nZW50aWZpZXIoKS5lcXVhbHMoZmsuZ2V0SWRlbnRpZmllcigpKSkgewogICAg\nICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICB9CiAgICAg\nICAgICAgIC8vIEFzc2VydCBQSyB0YWJsZSBuYW1lIGFuZCBzY2hlbWEKICAg\nICAgICAgICAgaWYgKCFnZXRGaygpLmdldFByaW1hcnlLZXlTY2hlbWFJZGVu\ndGlmaWVyKCkuZXF1YWxzKGZrLmdldFByaW1hcnlLZXlTY2hlbWFJZGVudGlm\naWVyKCkpIHx8CiAgICAgICAgICAgICAgICAhZ2V0RmsoKS5nZXRQcmltYXJ5\nS2V5VGFibGVJZGVudGlmaWVyKCkuZXF1YWxzKGZrLmdldFByaW1hcnlLZXlU\nYWJsZUlkZW50aWZpZXIoKSkgfHwKICAgICAgICAgICAgICAgICFnZXRGaygp\nLmdldFNjaGVtYUlkZW50aWZpZXIoKS5lcXVhbHMoZmsuZ2V0U2NoZW1hSWRl\nbnRpZmllcigpKSB8fAogICAgICAgICAgICAgICAgIWdldEZrKCkuZ2V0VGFi\nbGVJZGVudGlmaWVyKCkuZXF1YWxzKGZrLmdldFRhYmxlSWRlbnRpZmllcigp\nKSkgewogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAg\nICB9CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KICAgIH0K\nfQo=\n","encoding":"base64"}

