{"sha":"9126bef1698140a32fb4061ab251c8f6016638e8","node_id":"MDQ6QmxvYjIwNjM2NDo5MTI2YmVmMTY5ODE0MGEzMmZiNDA2MWFiMjUxYzhmNjAxNjYzOGU4","size":5463,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/9126bef1698140a32fb4061ab251c8f6016638e8","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hlbWE7CgppbXBv\ncnQgamF2YS51dGlsLkFycmF5TGlzdDsKaW1wb3J0IGphdmEudXRpbC5MaXN0\nOwoKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLmlkZW50aWZpZXIu\nREJJZGVudGlmaWVyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51\ndGlsLkxvY2FsaXplcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGls\nLkludmFsaWRTdGF0ZUV4Y2VwdGlvbjsKCi8qKgogKiBDb25zdHJhaW50IG92\nZXIgbG9jYWwgdGFibGUgY29sdW1ucywgYXMgb3Bwb3NlZCB0byBhIGZvcmVp\nZ24ga2V5IHdoaWNoCiAqIHNwYW5zIHRhYmxlcy4gQ29sdW1uIEFQSXMgY2Fu\nIHJlcHJlc2VudCBhIGZ1bGwgY29uc3RyYWludCBvciBhIHBhcnRpYWwKICog\nY29uc3RyYWludCwgYWxpZ25pbmcgd2l0aCB7QGxpbmsgamF2YS5zcWwuRGF0\nYWJhc2VNZXRhRGF0YX0uCiAqCiAqIEBhdXRob3IgQWJlIFdoaXRlCiAqLwpA\nU3VwcHJlc3NXYXJuaW5ncygic2VyaWFsIikKcHVibGljIGFic3RyYWN0IGNs\nYXNzIExvY2FsQ29uc3RyYWludAogICAgZXh0ZW5kcyBDb25zdHJhaW50IHsK\nCiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBMb2NhbGl6ZXIgX2xvYyA9IExv\nY2FsaXplci5mb3JQYWNrYWdlCiAgICAgICAgKExvY2FsQ29uc3RyYWludC5j\nbGFzcyk7CgogICAgcHJpdmF0ZSBMaXN0PENvbHVtbj4gX2NvbExpc3QgPSBu\ndWxsOwogICAgcHJpdmF0ZSBDb2x1bW5bXSBfY29scyA9IG51bGw7CgogICAg\nLyoqCiAgICAgKiBEZWZhdWx0IGNvbnN0cnVjdG9yLgogICAgICovCiAgICBw\ndWJsaWMgTG9jYWxDb25zdHJhaW50KCkgewogICAgfQoKICAgIC8qKgogICAg\nICogQ29uc3RydWN0b3IuCiAgICAgKgogICAgICogQHBhcmFtIG5hbWUgdGhl\nIG5hbWUgb2YgdGhlIGNvbnN0cmFpbnQsIGlmIGFueQogICAgICogQHBhcmFt\nIHRhYmxlIHRoZSB0YWJsZSBvZiB0aGUgY29uc3RyYWludAogICAgICogQGRl\ncHJlY2F0ZWQKICAgICAqLwogICAgcHVibGljIExvY2FsQ29uc3RyYWludChT\ndHJpbmcgbmFtZSwgVGFibGUgdGFibGUpIHsKICAgICAgICBzdXBlcihuYW1l\nLCB0YWJsZSk7CiAgICB9CgogICAgcHVibGljIExvY2FsQ29uc3RyYWludChE\nQklkZW50aWZpZXIgbmFtZSwgVGFibGUgdGFibGUpIHsKICAgICAgICBzdXBl\ncihuYW1lLCB0YWJsZSk7CiAgICB9Ci8qKgogICAgICogQ2FsbGVkIHdoZW4g\ndGhlIGNvbnN0cmFpbnQgaXMgcmVtb3ZlZCBmcm9tIGl0cyB0YWJsZS4KICAg\nICAqLwogICAgdm9pZCByZW1vdmUoKSB7CiAgICAgICAgLy8gcmVtb3ZlIGFs\nbCBjb2x1bW5zCiAgICAgICAgc2V0Q29sdW1ucyhudWxsKTsKICAgICAgICBz\ndXBlci5yZW1vdmUoKTsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiBh\nbGwgdGhlIGNvbHVtbnMgdGhlIGNvbnN0cmFpbnQgc3BhbnMuCiAgICAgKi8K\nICAgIHB1YmxpYyBDb2x1bW5bXSBnZXRDb2x1bW5zKCkgewogICAgICAgIGlm\nIChfY29scyA9PSBudWxsKQogICAgICAgICAgICBfY29scyA9IChfY29sTGlz\ndCA9PSBudWxsKSA/IFNjaGVtYXMuRU1QVFlfQ09MVU1OUwogICAgICAgICAg\nICAgICAgOiAoQ29sdW1uW10pIF9jb2xMaXN0LnRvQXJyYXkobmV3IENvbHVt\nbltfY29sTGlzdC5zaXplKCldKTsKICAgICAgICByZXR1cm4gX2NvbHM7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBTZXQgdGhlIGNvbHVtbnMgdGhlIGNvbnN0\ncmFpbnQgc3BhbnMuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldENvbHVt\nbnMoQ29sdW1uW10gY29scykgewogICAgICAgIENvbHVtbltdIGN1ciA9IGdl\ndENvbHVtbnMoKTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGN1ci5s\nZW5ndGg7IGkrKykKICAgICAgICAgICAgcmVtb3ZlQ29sdW1uKGN1cltpXSk7\nCgogICAgICAgIGlmIChjb2xzICE9IG51bGwpCiAgICAgICAgICAgIGZvciAo\naW50IGkgPSAwOyBpIDwgY29scy5sZW5ndGg7IGkrKykKICAgICAgICAgICAg\nICAgIGFkZENvbHVtbihjb2xzW2ldKTsKICAgIH0KCiAgICAvKioKICAgICAq\nIEFkZCBhIGNvbHVtbiB0byB0aGUgY29uc3RyYWludC4KICAgICAqLwogICAg\ncHVibGljIHZvaWQgYWRkQ29sdW1uKENvbHVtbiBjb2wpIHsKICAgIAlpZiAo\nY29sID09IG51bGwpCiAgICAgICAgICAgIHRocm93IG5ldyBJbnZhbGlkU3Rh\ndGVFeGNlcHRpb24oX2xvYy5nZXQoInRhYmxlLW1pc21hdGNoIiwKICAgICAg\nICAgICAgICAgIGNvbCA9PSBudWxsID8gbnVsbCA6IGNvbC5nZXRUYWJsZSgp\nLAogICAgICAgICAgICAgICAgY29sID09IG51bGwgPyBudWxsIDogZ2V0VGFi\nbGUoKSkpOwogICAgCQogICAgICAgIGlmIChfY29sTGlzdCA9PSBudWxsKQog\nICAgICAgICAgICBfY29sTGlzdCA9IG5ldyBBcnJheUxpc3Q8Q29sdW1uPigz\nKTsKICAgICAgICBlbHNlIGlmIChfY29sTGlzdC5jb250YWlucyhjb2wpKQog\nICAgICAgICAgICByZXR1cm47CgogICAgICAgIF9jb2xMaXN0LmFkZChjb2wp\nOwogICAgICAgIF9jb2xzID0gbnVsbDsKICAgIH0KCiAgICAvKioKICAgICAq\nIFJlbW92ZSBhIGNvbHVtbiBmcm9tIHRoZSBjb25zdHJhaW50LgogICAgICoK\nICAgICAqIEByZXR1cm4gdHJ1ZSBpZiB0aGUgY29sdW1uIHdhcyByZW1vdmVk\nLCBmYWxzZSBpZiBub3QgcGFydCBvZiB0aGUKICAgICAqIHByaW1hcnkga2V5\nCiAgICAgKi8KICAgIHB1YmxpYyBib29sZWFuIHJlbW92ZUNvbHVtbihDb2x1\nbW4gY29sKSB7CiAgICAgICAgaWYgKGNvbCA9PSBudWxsIHx8IF9jb2xMaXN0\nID09IG51bGwpCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICBp\nZiAoX2NvbExpc3QucmVtb3ZlKGNvbCkpIHsKICAgICAgICAgICAgX2NvbHMg\nPSBudWxsOwogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAg\nICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIC8qKgogICAgICogUmV0\ndXJuIHRydWUgaWYgdGhlIHBrIGluY2x1ZGVzIHRoZSBnaXZlbiBjb2x1bW4u\nCiAgICAgKi8KICAgIHB1YmxpYyBib29sZWFuIGNvbnRhaW5zQ29sdW1uKENv\nbHVtbiBjb2wpIHsKICAgICAgICBpZiAoY29sID09IG51bGwgfHwgX2NvbExp\nc3QgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAg\nIHJldHVybiBfY29sTGlzdC5jb250YWlucyhjb2wpOwogICAgfQoKICAgIC8q\nKgogICAgICogUmVmIGFsbCBjb2x1bW5zIGluIHRoaXMgY29uc3RyYWludC4K\nICAgICAqLwogICAgcHVibGljIHZvaWQgcmVmQ29sdW1ucygpIHsKICAgICAg\nICBDb2x1bW5bXSBjb2xzID0gZ2V0Q29sdW1ucygpOwogICAgICAgIGZvciAo\naW50IGkgPSAwOyBpIDwgY29scy5sZW5ndGg7IGkrKykKICAgICAgICAgICAg\nY29sc1tpXS5yZWYoKTsKICAgIH0KCiAgICAvKioKICAgICAqIERlcmVmIGFs\nbCBjb2x1bW5zIGluIHRoaXMgY29uc3RyYWludC4KICAgICAqLwogICAgcHVi\nbGljIHZvaWQgZGVyZWZDb2x1bW5zKCkgewogICAgICAgIENvbHVtbltdIGNv\nbHMgPSBnZXRDb2x1bW5zKCk7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkg\nPCBjb2xzLmxlbmd0aDsgaSsrKQogICAgICAgICAgICBjb2xzW2ldLmRlcmVm\nKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gdHJ1ZSBpZiB0aGUg\nZ2l2ZW4gY29sdW1ucyBtYXRjaCB0aGUgY29sdW1ucyBvZiB0aGlzIGNvbnN0\ncmFpbnQuCiAgICAgKi8KICAgIHB1YmxpYyBib29sZWFuIGNvbHVtbnNNYXRj\naChDb2x1bW5bXSBvY29scykgewogICAgICAgIENvbHVtbltdIGNvbHMgPSBn\nZXRDb2x1bW5zKCk7CiAgICAgICAgaWYgKGNvbHMubGVuZ3RoICE9IG9jb2xz\nLmxlbmd0aCkKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIGZv\nciAoaW50IGkgPSAwOyBpIDwgb2NvbHMubGVuZ3RoOyBpKyspCiAgICAgICAg\nICAgIGlmICghaGFzQ29sdW1uKGNvbHMsIG9jb2xzW2ldKSkKICAgICAgICAg\nICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAg\nIH0KCiAgICAvKioKICAgICAqIFJldHVybiB3aGV0aGVyIHRoZSBnaXZlbiBj\nb2x1bW4gZXhpc3RzIGluIHRoZSBhcnJheS4KICAgICAqLwogICAgcHJpdmF0\nZSBzdGF0aWMgYm9vbGVhbiBoYXNDb2x1bW4oQ29sdW1uW10gY29scywgQ29s\ndW1uIGNvbCkgewogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgY29scy5s\nZW5ndGg7IGkrKykKICAgICAgICAgICAgaWYgKGNvbHNbaV0uZ2V0UXVhbGlm\naWVkUGF0aCgpLmVxdWFscyhjb2wuZ2V0UXVhbGlmaWVkUGF0aCgpKSkKICAg\nICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIHJldHVybiBmYWxz\nZTsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0cnVlIGlmIHRoZSBj\nb2x1bW5zIG9mIHRoaXMgY29uc3RyYWludCBtYXRjaGVzIHRoYXQgb2YKICAg\nICAqIHRoZSBnaXZlbiBvbmUuIFRoZSBjb25zdHJhaW50cyBhcmUgbm90IGNv\nbXBhcmVkIG9uIG5hbWUuCiAgICAgKi8KICAgIHByb3RlY3RlZCBib29sZWFu\nIGVxdWFsc0xvY2FsQ29uc3RyYWludChMb2NhbENvbnN0cmFpbnQgbGMpIHsK\nICAgICAgICBpZiAobGMgPT0gdGhpcykKICAgICAgICAgICAgcmV0dXJuIHRy\ndWU7CiAgICAgICAgaWYgKGxjID09IG51bGwpCiAgICAgICAgICAgIHJldHVy\nbiBmYWxzZTsKICAgICAgICByZXR1cm4gY29sdW1uc01hdGNoKGxjLmdldENv\nbHVtbnMoKSk7CiAgICB9Cn0K\n","encoding":"base64"}

