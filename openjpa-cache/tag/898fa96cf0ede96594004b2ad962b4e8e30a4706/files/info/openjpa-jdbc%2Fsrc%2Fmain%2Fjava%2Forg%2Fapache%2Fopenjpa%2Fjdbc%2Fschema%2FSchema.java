{"sha":"f59b07064b035e36cf722b1239d406da7a0d9851","node_id":"MDQ6QmxvYjIwNjM2NDpmNTliMDcwNjRiMDM1ZTM2Y2Y3MjJiMTIzOWQ0MDZkYTdhMGQ5ODUx","size":10050,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/f59b07064b035e36cf722b1239d406da7a0d9851","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hlbWE7CgppbXBv\ncnQgamF2YS5pby5TZXJpYWxpemFibGU7CmltcG9ydCBqYXZhLnV0aWwuTWFw\nOwppbXBvcnQgamF2YS51dGlsLlRyZWVNYXA7CgppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLmpkYmMuaWRlbnRpZmllci5EQklkZW50aWZpZXI7CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5pZGVudGlmaWVyLkRCSWRlbnRp\nZmllci5EQklkZW50aWZpZXJUeXBlOwoKLyoqCiAqIFJlcHJlc2VudHMgYSBk\nYXRhYmFzZSBzY2hlbWEuCiAqCiAqIEBhdXRob3IgQWJlIFdoaXRlCiAqLwpA\nU3VwcHJlc3NXYXJuaW5ncygic2VyaWFsIikKcHVibGljIGNsYXNzIFNjaGVt\nYQogICAgaW1wbGVtZW50cyBDb21wYXJhYmxlPFNjaGVtYT4sIFNlcmlhbGl6\nYWJsZSB7CgogICAgcHJpdmF0ZSBEQklkZW50aWZpZXIgX25hbWUgPSBEQklk\nZW50aWZpZXIuTlVMTDsKICAgIHByaXZhdGUgU2NoZW1hR3JvdXAgX2dyb3Vw\nID0gbnVsbDsKICAgIHByaXZhdGUgTWFwPERCSWRlbnRpZmllciwgVGFibGU+\nIF90YWJsZU1hcCA9IG51bGw7CiAgICBwcml2YXRlIE1hcDxEQklkZW50aWZp\nZXIsIFNlcXVlbmNlPiBfc2VxTWFwID0gbnVsbDsKCiAgICAvLyBjYWNoZQog\nICAgcHJpdmF0ZSBUYWJsZVtdIF90YWJsZXMgPSBudWxsOwogICAgcHJpdmF0\nZSBTZXF1ZW5jZVtdIF9zZXFzID0gbnVsbDsKCiAgICAvKioKICAgICAqIERl\nZmF1bHQgY29uc3RydWN0b3IuCiAgICAgKi8KICAgIHB1YmxpYyBTY2hlbWEo\nKSB7CiAgICB9CgogICAgLyoqCiAgICAgKiBDb25zdHJ1Y3Rvci4KICAgICAq\nCiAgICAgKiBAcGFyYW0gbmFtZSB0aGUgc2NoZW1hIG5hbWUsIGlmIGFueQog\nICAgICogQHBhcmFtIGdyb3VwIHRoZSBzY2hlbWEncyBvd25pbmcgZ3JvdXAK\nICAgICAqIEBkZXByZWNhdGVkCiAgICAgKi8KICAgIHB1YmxpYyBTY2hlbWEo\nU3RyaW5nIG5hbWUsIFNjaGVtYUdyb3VwIGdyb3VwKSB7CiAgICAgICAgdGhp\ncyhEQklkZW50aWZpZXIubmV3U2NoZW1hKG5hbWUpLCBncm91cCk7CiAgICB9\nCgogICAgcHVibGljIFNjaGVtYShEQklkZW50aWZpZXIgbmFtZSwgU2NoZW1h\nR3JvdXAgZ3JvdXApIHsKICAgICAgICBzZXRJZGVudGlmaWVyKG5hbWUpOwog\nICAgICAgIF9ncm91cCA9IGdyb3VwOwogICAgfQoKICAgIC8qKgogICAgICog\nQ2FsbGVkIHdoZW4gdGhlIHNjaGVtYSBpcyByZW1vdmVkIGZyb20gaXRzIGdy\nb3VwLiBJbnZhbGlkYXRlcyB0aGUKICAgICAqIHNjaGVtYSBhbmQgcmVtb3Zl\ncyBhbGwgaXRzIG1lbWJlciB0YWJsZXMuCiAgICAgKi8KICAgIHZvaWQgcmVt\nb3ZlKCkgewogICAgICAgIFRhYmxlW10gdGFicyA9IGdldFRhYmxlcygpOwog\nICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgdGFicy5sZW5ndGg7IGkrKykK\nICAgICAgICAgICAgcmVtb3ZlVGFibGUodGFic1tpXSk7CiAgICAgICAgU2Vx\ndWVuY2VbXSBzZXFzID0gZ2V0U2VxdWVuY2VzKCk7CiAgICAgICAgZm9yIChp\nbnQgaSA9IDA7IGkgPCBzZXFzLmxlbmd0aDsgaSsrKQogICAgICAgICAgICBy\nZW1vdmVTZXF1ZW5jZShzZXFzW2ldKTsKICAgICAgICBfZ3JvdXAgPSBudWxs\nOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRoZSBzY2hlbWEncyBn\ncm91cC4KICAgICAqLwogICAgcHVibGljIFNjaGVtYUdyb3VwIGdldFNjaGVt\nYUdyb3VwKCkgewogICAgICAgIHJldHVybiBfZ3JvdXA7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBSZXR1cm4gdGhlIG5hbWUgb2YgdGhlIHNjaGVtYSwgb3Ig\nbnVsbCBpZiBub25lLgogICAgICogQGRlcHJlY2F0ZWQKICAgICAqLwogICAg\ncHVibGljIFN0cmluZyBnZXROYW1lKCkgewogICAgICAgIHJldHVybiBnZXRJ\nZGVudGlmaWVyKCkuZ2V0TmFtZSgpOwogICAgfQoKICAgIHB1YmxpYyBEQklk\nZW50aWZpZXIgZ2V0SWRlbnRpZmllcigpIHsKICAgICAgICByZXR1cm4gX25h\nbWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBTZXQgdGhlIG5hbWUgb2YgdGhl\nIHNjaGVtYS4gVGhpcyBtZXRob2QgY2FuIG9ubHkgYmUgdXNlZCBmb3Igc2No\nZW1hcwogICAgICogbm90IGF0dGFjaGVkIHRvIGEgZ3JvdXAuCiAgICAgKiBA\nZGVwcmVjYXRlZAogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXROYW1lKFN0\ncmluZyBuYW1lKSB7CiAgICAgICAgc2V0SWRlbnRpZmllcihEQklkZW50aWZp\nZXIudHJpbVRvTnVsbChEQklkZW50aWZpZXIubmV3U2NoZW1hKG5hbWUpKSk7\nCiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0SWRlbnRpZmllcihEQklkZW50\naWZpZXIgbmFtZSkgewogICAgICAgIGlmIChnZXRTY2hlbWFHcm91cCgpICE9\nIG51bGwpCiAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsU3RhdGVFeGNl\ncHRpb24oKTsKICAgICAgICBfbmFtZSA9IERCSWRlbnRpZmllci50cmltVG9O\ndWxsKG5hbWUpOwogICAgfQogICAgCiAgICAvKioKICAgICAqIFJldHVybiB0\naGUgc2NoZW1hJ3MgdGFibGVzLgogICAgICovCiAgICBwdWJsaWMgVGFibGVb\nXSBnZXRUYWJsZXMoKSB7CiAgICAgICAgaWYgKF90YWJsZXMgPT0gbnVsbCkK\nICAgICAgICAgICAgX3RhYmxlcyA9IChfdGFibGVNYXAgPT0gbnVsbCkgPyBu\nZXcgVGFibGVbMF0gOiAoVGFibGVbXSkKICAgICAgICAgICAgICAgIF90YWJs\nZU1hcC52YWx1ZXMoKS50b0FycmF5KG5ldyBUYWJsZVtfdGFibGVNYXAuc2l6\nZSgpXSk7CiAgICAgICAgcmV0dXJuIF90YWJsZXM7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBSZXR1cm4gdGhlIHRhYmxlIHdpdGggdGhlIGdpdmVuIG5hbWUs\nIG9yIG51bGwgaWYgbm9uZS4KICAgICAqIEBkZXByZWNhdGVkCiAgICAgKi8K\nICAgIHB1YmxpYyBUYWJsZSBnZXRUYWJsZShTdHJpbmcgbmFtZSkgewogICAg\nICAgIGlmIChuYW1lID09IG51bGwgfHwgX3RhYmxlTWFwID09IG51bGwpCiAg\nICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgIHJldHVybiBnZXRUYWJs\nZShEQklkZW50aWZpZXIubmV3SWRlbnRpZmllcihuYW1lLCBEQklkZW50aWZp\nZXJUeXBlLlRBQkxFLCB0cnVlKSk7CiAgICB9CgogICAgcHVibGljIFRhYmxl\nIGdldFRhYmxlKERCSWRlbnRpZmllciBuYW1lKSB7CiAgICAgICAgaWYgKERC\nSWRlbnRpZmllci5pc051bGwobmFtZSkgfHwgX3RhYmxlTWFwID09IG51bGwp\nCiAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgIERCSWRlbnRpZmll\nciBzTmFtZSA9IERCSWRlbnRpZmllci50b1VwcGVyKG5hbWUpOwogICAgICAg\nIHJldHVybiAoVGFibGUpIF90YWJsZU1hcC5nZXQoc05hbWUpOwogICAgfQoK\nICAgIC8qKgogICAgICogQWRkIGEgdGFibGUgdG8gdGhlIHNjaGVtYS4KICAg\nICAqIEBkZXByZWNhdGVkCiAgICAgKi8KICAgIHB1YmxpYyBUYWJsZSBhZGRU\nYWJsZShTdHJpbmcgbmFtZSkgewogICAgICAgIHJldHVybiBhZGRUYWJsZShE\nQklkZW50aWZpZXIubmV3VGFibGUobmFtZSkpOwogICAgfQogICAgCiAgICBw\ndWJsaWMgVGFibGUgYWRkVGFibGUoREJJZGVudGlmaWVyIG5hbWUpIHsKICAg\nICAgICBTY2hlbWFHcm91cCBncm91cCA9IGdldFNjaGVtYUdyb3VwKCk7CiAg\nICAgICAgVGFibGUgdGFiOwogICAgICAgIG5hbWUgPSBuYW1lLmdldFVucXVh\nbGlmaWVkTmFtZSgpOwogICAgICAgIGlmIChncm91cCAhPSBudWxsKSB7CiAg\nICAgICAgICAgIGdyb3VwLmFkZE5hbWUobmFtZSwgdHJ1ZSk7CiAgICAgICAg\nICAgIHRhYiA9IGdyb3VwLm5ld1RhYmxlKG5hbWUsIHRoaXMpOwogICAgICAg\nIH0gZWxzZQogICAgICAgICAgICB0YWIgPSBuZXcgVGFibGUobmFtZSwgdGhp\ncyk7CiAgICAgICAgaWYgKF90YWJsZU1hcCA9PSBudWxsKQogICAgICAgICAg\nICBfdGFibGVNYXAgPSBuZXcgVHJlZU1hcDxEQklkZW50aWZpZXIsIFRhYmxl\nPigpOwogICAgICAgIERCSWRlbnRpZmllciBzTmFtZSA9IERCSWRlbnRpZmll\nci50b1VwcGVyKG5hbWUpOwogICAgICAgIF90YWJsZU1hcC5wdXQoc05hbWUs\nIHRhYik7CiAgICAgICAgX3RhYmxlcyA9IG51bGw7CiAgICAgICAgcmV0dXJu\nIHRhYjsKICAgIH0KICAgIAoKICAgIC8qKgogICAgICogQWRkIGEgdGFibGUg\nd2l0aCBhIHNob3J0ZW5lZCAoaS5lLiwgdmFsaWRhdGVkKSBuYW1lIHRvIHRo\nZSBzY2hlbWEKICAgICAqIEBkZXByZWNhdGVkCiAgICAgKi8KICAgIHB1Ymxp\nYyBUYWJsZSBhZGRUYWJsZShTdHJpbmcgbmFtZSwgU3RyaW5nIHZhbGlkTmFt\nZSkgewogICAgICAgIHJldHVybiBhZGRUYWJsZShEQklkZW50aWZpZXIubmV3\nVGFibGUobmFtZSksIERCSWRlbnRpZmllci5uZXdUYWJsZSh2YWxpZE5hbWUp\nKTsKICAgIH0KCiAgICBwdWJsaWMgVGFibGUgYWRkVGFibGUoREJJZGVudGlm\naWVyIG5hbWUsIERCSWRlbnRpZmllciB2YWxpZE5hbWUpIHsKICAgICAgICBT\nY2hlbWFHcm91cCBncm91cCA9IGdldFNjaGVtYUdyb3VwKCk7CiAgICAgICAg\nVGFibGUgdGFiOwogICAgICAgIGlmIChncm91cCAhPSBudWxsKSB7CiAgICAg\nICAgICAgIGdyb3VwLmFkZE5hbWUodmFsaWROYW1lLCB0cnVlKTsKICAgICAg\nICAgICAgdGFiID0gZ3JvdXAubmV3VGFibGUodmFsaWROYW1lLCB0aGlzKTsK\nICAgICAgICB9IGVsc2UKICAgICAgICAgICAgdGFiID0gbmV3IFRhYmxlKHZh\nbGlkTmFtZSwgdGhpcyk7CiAgICAgICAgaWYgKF90YWJsZU1hcCA9PSBudWxs\nKQogICAgICAgICAgICBfdGFibGVNYXAgPSBuZXcgVHJlZU1hcDxEQklkZW50\naWZpZXIsIFRhYmxlPigpOwogICAgICAgIERCSWRlbnRpZmllciBzTmFtZSA9\nIERCSWRlbnRpZmllci50b1VwcGVyKG5hbWUpOwogICAgICAgIF90YWJsZU1h\ncC5wdXQoc05hbWUsIHRhYik7CiAgICAgICAgX3RhYmxlcyA9IG51bGw7CiAg\nICAgICAgcmV0dXJuIHRhYjsKICAgIH0KCiAgICAvKioKICAgICAqIFJlbW92\nZSB0aGUgZ2l2ZW4gdGFibGUgZnJvbSB0aGUgc2NoZW1hLgogICAgICoKICAg\nICAqIEByZXR1cm4gdHJ1ZSBpZiB0aGUgdGFibGUgd2FzIHJlbW92ZWQsIGZh\nbHNlIGlmIG5vdCBpbiB0aGUgc2NoZW1hCiAgICAgKi8KICAgIHB1YmxpYyBi\nb29sZWFuIHJlbW92ZVRhYmxlKFRhYmxlIHRhYikgewogICAgICAgIGlmICh0\nYWIgPT0gbnVsbCB8fCBfdGFibGVNYXAgPT0gbnVsbCkKICAgICAgICAgICAg\ncmV0dXJuIGZhbHNlOwoKICAgICAgICBEQklkZW50aWZpZXIgc05hbWUgPSBE\nQklkZW50aWZpZXIudG9VcHBlcih0YWIuZ2V0SWRlbnRpZmllcigpKTsKICAg\nICAgICBUYWJsZSBjdXIgPSAoVGFibGUpIF90YWJsZU1hcC5nZXQoc05hbWUp\nOwogICAgICAgIGlmICghY3VyLmVxdWFscyh0YWIpKQogICAgICAgICAgICBy\nZXR1cm4gZmFsc2U7CgogICAgICAgIF90YWJsZU1hcC5yZW1vdmUoc05hbWUp\nOwogICAgICAgIF90YWJsZXMgPSBudWxsOwogICAgICAgIFNjaGVtYUdyb3Vw\nIGdyb3VwID0gZ2V0U2NoZW1hR3JvdXAoKTsKICAgICAgICBpZiAoZ3JvdXAg\nIT0gbnVsbCkKICAgICAgICAgICAgZ3JvdXAucmVtb3ZlTmFtZSh0YWIuZ2V0\nSWRlbnRpZmllcigpKTsKICAgICAgICB0YWIucmVtb3ZlKCk7CiAgICAgICAg\ncmV0dXJuIHRydWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBJbXBvcnQgYSB0\nYWJsZSBmcm9tIGFub3RoZXIgc2NoZW1hLgkgTm90ZSB0aGF0IHRoaXMgbWV0\naG9kIGRvZXMKICAgICAqIDxzdHJvbmc+bm90PC9zdHJvbmc+IGltcG9ydCBm\nb3JlaWduIGtleXMsIGluZGV4ZXMsIG9yIHVuaXF1ZSBjb25zdHJhaW50cy4K\nICAgICAqLwogICAgcHVibGljIFRhYmxlIGltcG9ydFRhYmxlKFRhYmxlIHRh\nYmxlKSB7CiAgICAgICAgaWYgKHRhYmxlID09IG51bGwpCiAgICAgICAgICAg\nIHJldHVybiBudWxsOwoKICAgICAgICBUYWJsZSBjb3B5ID0gYWRkVGFibGUo\ndGFibGUuZ2V0SWRlbnRpZmllcigpKTsKICAgICAgICBDb2x1bW5bXSBjb2xz\nID0gdGFibGUuZ2V0Q29sdW1ucygpOwogICAgICAgIGZvciAoaW50IGkgPSAw\nOyBpIDwgY29scy5sZW5ndGg7IGkrKykKICAgICAgICAgICAgY29weS5pbXBv\ncnRDb2x1bW4oY29sc1tpXSk7CgogICAgICAgIGNvcHkuaW1wb3J0UHJpbWFy\neUtleSh0YWJsZS5nZXRQcmltYXJ5S2V5KCkpOwogICAgICAgIHJldHVybiBj\nb3B5OwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRoZSBzY2hlbWEn\ncyBzZXF1ZW5jZXMuCiAgICAgKi8KICAgIHB1YmxpYyBTZXF1ZW5jZVtdIGdl\ndFNlcXVlbmNlcygpIHsKICAgICAgICBpZiAoX3NlcXMgPT0gbnVsbCkKICAg\nICAgICAgICAgX3NlcXMgPSAoX3NlcU1hcCA9PSBudWxsKSA/IG5ldyBTZXF1\nZW5jZVswXSA6IChTZXF1ZW5jZVtdKQogICAgICAgICAgICAgICAgX3NlcU1h\ncC52YWx1ZXMoKS50b0FycmF5KG5ldyBTZXF1ZW5jZVtfc2VxTWFwLnNpemUo\nKV0pOwogICAgICAgIHJldHVybiBfc2VxczsKICAgIH0KCiAgICAvKioKICAg\nICAqIFJldHVybiB0aGUgc2VxdWVuY2Ugd2l0aCB0aGUgZ2l2ZW4gbmFtZSwg\nb3IgbnVsbCBpZiBub25lLgogICAgICogQGRlcHJlY2F0ZWQKICAgICAqLwog\nICAgcHVibGljIFNlcXVlbmNlIGdldFNlcXVlbmNlKFN0cmluZyBuYW1lKSB7\nCiAgICAgICAgaWYgKG5hbWUgPT0gbnVsbCB8fCBfc2VxTWFwID09IG51bGwp\nCiAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgIHJldHVybiBnZXRT\nZXF1ZW5jZShEQklkZW50aWZpZXIubmV3SWRlbnRpZmllcihuYW1lLCBEQklk\nZW50aWZpZXJUeXBlLlNFUVVFTkNFLCB0cnVlKSk7CiAgICB9CgogICAgcHVi\nbGljIFNlcXVlbmNlIGdldFNlcXVlbmNlKERCSWRlbnRpZmllciBuYW1lKSB7\nCiAgICAgICAgaWYgKERCSWRlbnRpZmllci5pc051bGwobmFtZSkgfHwgX3Nl\ncU1hcCA9PSBudWxsKQogICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAg\nICAKICAgICAgICBEQklkZW50aWZpZXIgc05hbWUgPSBEQklkZW50aWZpZXIu\ndG9VcHBlcihuYW1lKTsKICAgICAgICBTZXF1ZW5jZSBzZXEgPSAoU2VxdWVu\nY2UpIF9zZXFNYXAuZ2V0KHNOYW1lKTsKICAgICAgICByZXR1cm4gc2VxOwog\nICAgfQoKICAgIC8qKgogICAgICogQWRkIGEgc2VxdWVuY2UgdG8gdGhlIHNj\naGVtYS4KICAgICAqIEBkZXByZWNhdGVkCiAgICAgKi8KICAgIHB1YmxpYyBT\nZXF1ZW5jZSBhZGRTZXF1ZW5jZShTdHJpbmcgbmFtZSkgewogICAgICAgIHJl\ndHVybiBhZGRTZXF1ZW5jZShEQklkZW50aWZpZXIubmV3SWRlbnRpZmllcihu\nYW1lLCBEQklkZW50aWZpZXJUeXBlLlNFUVVFTkNFLCB0cnVlKSk7CiAgICB9\nCgogICAgcHVibGljIFNlcXVlbmNlIGFkZFNlcXVlbmNlKERCSWRlbnRpZmll\nciBuYW1lKSB7CiAgICAgICAgU2NoZW1hR3JvdXAgZ3JvdXAgPSBnZXRTY2hl\nbWFHcm91cCgpOwogICAgICAgIFNlcXVlbmNlIHNlcTsKICAgICAgICBpZiAo\nZ3JvdXAgIT0gbnVsbCkgewogICAgICAgICAgICBncm91cC5hZGROYW1lKG5h\nbWUsIHRydWUpOwogICAgICAgICAgICBzZXEgPSBncm91cC5uZXdTZXF1ZW5j\nZShuYW1lLCB0aGlzKTsKICAgICAgICB9IGVsc2UKICAgICAgICAgICAgc2Vx\nID0gbmV3IFNlcXVlbmNlKG5hbWUsIHRoaXMpOwogICAgICAgIGlmIChfc2Vx\nTWFwID09IG51bGwpCiAgICAgICAgICAgIF9zZXFNYXAgPSBuZXcgVHJlZU1h\ncDxEQklkZW50aWZpZXIsIFNlcXVlbmNlPigpOwogICAgICAgIAogICAgICAg\nIERCSWRlbnRpZmllciBzTmFtZSA9IERCSWRlbnRpZmllci50b1VwcGVyKG5h\nbWUpOwogICAgICAgIF9zZXFNYXAucHV0KHNOYW1lLCBzZXEpOwogICAgICAg\nIF9zZXFzID0gbnVsbDsKICAgICAgICByZXR1cm4gc2VxOwogICAgfQoKICAg\nIC8qKgogICAgICogUmVtb3ZlIHRoZSBnaXZlbiBzZXF1ZW5jZSBmcm9tIHRo\nZSBzY2hlbWEuCiAgICAgKgogICAgICogQHJldHVybiB0cnVlIGlmIHRoZSBz\nZXF1ZW5jZSB3YXMgcmVtb3ZlZCwgZmFsc2UgaWYgbm90IGluIHRoZSBzY2hl\nbWEKICAgICAqLwogICAgcHVibGljIGJvb2xlYW4gcmVtb3ZlU2VxdWVuY2Uo\nU2VxdWVuY2Ugc2VxKSB7CiAgICAgICAgaWYgKHNlcSA9PSBudWxsIHx8IF9z\nZXFNYXAgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoKICAg\nICAgICBEQklkZW50aWZpZXIgc05hbWUgPSBEQklkZW50aWZpZXIudG9VcHBl\ncihzZXEuZ2V0SWRlbnRpZmllcigpKTsKICAgICAgICBTZXF1ZW5jZSBjdXIg\nPSAoU2VxdWVuY2UpIF9zZXFNYXAuZ2V0KHNOYW1lKTsKICAgICAgICBpZiAo\nIWN1ci5lcXVhbHMoc2VxKSkKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoK\nICAgICAgICBfc2VxTWFwLnJlbW92ZShzTmFtZSk7CiAgICAgICAgX3NlcXMg\nPSBudWxsOwogICAgICAgIFNjaGVtYUdyb3VwIGdyb3VwID0gZ2V0U2NoZW1h\nR3JvdXAoKTsKICAgICAgICBpZiAoZ3JvdXAgIT0gbnVsbCkKICAgICAgICAg\nICAgZ3JvdXAucmVtb3ZlTmFtZShzZXEuZ2V0SWRlbnRpZmllcigpKTsKICAg\nICAgICBzZXEucmVtb3ZlKCk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBJbXBvcnQgYSBzZXF1ZW5jZSBmcm9tIGFub3Ro\nZXIgc2NoZW1hLgogICAgICovCiAgICBwdWJsaWMgU2VxdWVuY2UgaW1wb3J0\nU2VxdWVuY2UoU2VxdWVuY2Ugc2VxKSB7CiAgICAgICAgaWYgKHNlcSA9PSBu\ndWxsKQogICAgICAgICAgICByZXR1cm4gbnVsbDsKCiAgICAgICAgU2VxdWVu\nY2UgY29weSA9IGFkZFNlcXVlbmNlKHNlcS5nZXRJZGVudGlmaWVyKCkpOwog\nICAgICAgIGNvcHkuc2V0SW5pdGlhbFZhbHVlKHNlcS5nZXRJbml0aWFsVmFs\ndWUoKSk7CiAgICAgICAgY29weS5zZXRJbmNyZW1lbnQoc2VxLmdldEluY3Jl\nbWVudCgpKTsKICAgICAgICBjb3B5LnNldEFsbG9jYXRlKHNlcS5nZXRBbGxv\nY2F0ZSgpKTsKICAgICAgICByZXR1cm4gY29weTsKICAgIH0KCiAgICBwdWJs\naWMgaW50IGNvbXBhcmVUbyhTY2hlbWEgb3RoZXIpIHsKICAgICAgICBEQklk\nZW50aWZpZXIgbmFtZSA9IGdldElkZW50aWZpZXIoKTsKICAgICAgICBEQklk\nZW50aWZpZXIgb3RoZXJOYW1lID0gKChTY2hlbWEpIG90aGVyKS5nZXRJZGVu\ndGlmaWVyKCk7CiAgICAgICAgaWYgKERCSWRlbnRpZmllci5pc051bGwobmFt\nZSkgJiYgREJJZGVudGlmaWVyLmlzTnVsbChvdGhlck5hbWUpKSB7CiAgICAg\nICAgICAgIHJldHVybiAwOwogICAgICAgIH0KICAgICAgICBpZiAoREJJZGVu\ndGlmaWVyLmlzTnVsbChuYW1lKSkKICAgICAgICAgICAgcmV0dXJuIDE7CiAg\nICAgICAgaWYgKERCSWRlbnRpZmllci5pc051bGwob3RoZXJOYW1lKSkKICAg\nICAgICAgICAgcmV0dXJuIC0xOwogICAgICAgIHJldHVybiBuYW1lLmNvbXBh\ncmVUbyhvdGhlck5hbWUpOwogICAgfQoKICAgIHB1YmxpYyBTdHJpbmcgdG9T\ndHJpbmcoKSB7CiAgICAgICAgcmV0dXJuIGdldElkZW50aWZpZXIoKS5nZXRO\nYW1lKCk7CiAgICB9Cn0K\n","encoding":"base64"}

