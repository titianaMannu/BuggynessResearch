{"sha":"8c90933dcca85282f268dc0483aa0071e9ca1ada","node_id":"MDQ6QmxvYjIwNjM2NDo4YzkwOTMzZGNjYTg1MjgyZjI2OGRjMDQ4M2FhMDA3MWU5Y2ExYWRh","size":55492,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/8c90933dcca85282f268dc0483aa0071e9ca1ada","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hlbWE7CgppbXBv\ncnQgamF2YS5pby5GaWxlOwppbXBvcnQgamF2YS5pby5JT0V4Y2VwdGlvbjsK\naW1wb3J0IGphdmEuaW8uUHJpbnRXcml0ZXI7CmltcG9ydCBqYXZhLmlvLldy\naXRlcjsKaW1wb3J0IGphdmEuc3FsLkNvbm5lY3Rpb247CmltcG9ydCBqYXZh\nLnNxbC5EYXRhYmFzZU1ldGFEYXRhOwppbXBvcnQgamF2YS5zcWwuU1FMRXhj\nZXB0aW9uOwppbXBvcnQgamF2YS5zcWwuU3RhdGVtZW50OwppbXBvcnQgamF2\nYS51dGlsLkFycmF5czsKaW1wb3J0IGphdmEudXRpbC5Db2xsZWN0aW9uOwpp\nbXBvcnQgamF2YS51dGlsLkhhc2hTZXQ7CmltcG9ydCBqYXZhLnV0aWwuSXRl\ncmF0b3I7CmltcG9ydCBqYXZhLnV0aWwuTGlua2VkSGFzaFNldDsKaW1wb3J0\nIGphdmEudXRpbC5MaW5rZWRMaXN0OwppbXBvcnQgamF2YS51dGlsLlNldDsK\naW1wb3J0IGphdmF4LnNxbC5EYXRhU291cmNlOwoKaW1wb3J0IG9yZy5hcGFj\naGUuY29tbW9ucy5sYW5nLlN0cmluZ1V0aWxzOwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLmNvbmYuT3BlbkpQQUNvbmZpZ3VyYXRpb247CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEuamRiYy5jb25mLkpEQkNDb25maWd1cmF0aW9u\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuY29uZi5KREJDQ29u\nZmlndXJhdGlvbkltcGw7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRi\nYy5pZGVudGlmaWVyLkRCSWRlbnRpZmllcjsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS5qZGJjLnNxbC5EQkRpY3Rpb25hcnk7CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEuamRiYy5zcWwuU1FMRXhjZXB0aW9uczsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5saWIuY29uZi5Db25maWd1cmF0aW9uczsKaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIuaWRlbnRpZmllci5JZGVudGlm\naWVyVXRpbDsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIubG9nLkxv\nZzsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIubWV0YS5NZXRhRGF0\nYVNlcmlhbGl6ZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0\naWwuRmlsZXM7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwu\nTG9jYWxpemVyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51dGls\nLk9wdGlvbnM7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5JbnZh\nbGlkU3RhdGVFeGNlcHRpb247CgovKioKICogVGhlIFNjaGVtYVRvb2wgaXMg\ndXNlZCB0byBtYW5hZ2UgdGhlIGRhdGFiYXNlIHNjaGVtYS4gTm90ZSB0aGF0\nIHRoZQogKiB0b29sIG5ldmVyIGFkZHMgb3IgZHJvcHMgdW5pcXVlIGNvbnN0\ncmFpbnRzIGZyb20gZXhpc3RpbmcgdGFibGVzLCBiZWNhdXNlCiAqIEpEQkMg\ne0BsaW5rIERhdGFiYXNlTWV0YURhdGF9IGRvZXMgbm90IGluY2x1ZGUgaW5m\nb3JtYXRpb24gb24gdGhlc2UKICogY29uc3RyYWludHMuCiAqCiAqIEBhdXRo\nb3IgQWJlIFdoaXRlCiAqIEBhdXRob3IgUGF0cmljayBMaW5za2V5CiAqLwpw\ndWJsaWMgY2xhc3MgU2NoZW1hVG9vbCB7CgogICAgcHVibGljIHN0YXRpYyBm\naW5hbCBTdHJpbmcgQUNUSU9OX0FERCA9ICJhZGQiOwogICAgcHVibGljIHN0\nYXRpYyBmaW5hbCBTdHJpbmcgQUNUSU9OX0RST1AgPSAiZHJvcCI7CiAgICBw\ndWJsaWMgc3RhdGljIGZpbmFsIFN0cmluZyBBQ1RJT05fUkVUQUlOID0gInJl\ndGFpbiI7CiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIFN0cmluZyBBQ1RJT05f\nUkVGUkVTSCA9ICJyZWZyZXNoIjsKICAgIHB1YmxpYyBzdGF0aWMgZmluYWwg\nU3RyaW5nIEFDVElPTl9CVUlMRCA9ICJidWlsZCI7CiAgICBwdWJsaWMgc3Rh\ndGljIGZpbmFsIFN0cmluZyBBQ1RJT05fUkVGTEVDVCA9ICJyZWZsZWN0IjsK\nICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgU3RyaW5nIEFDVElPTl9DUkVBVEVE\nQiA9ICJjcmVhdGVEQiI7CiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIFN0cmlu\nZyBBQ1RJT05fRFJPUERCID0gImRyb3BEQiI7CiAgICBwdWJsaWMgc3RhdGlj\nIGZpbmFsIFN0cmluZyBBQ1RJT05fSU1QT1JUID0gImltcG9ydCI7CiAgICBw\ndWJsaWMgc3RhdGljIGZpbmFsIFN0cmluZyBBQ1RJT05fRVhQT1JUID0gImV4\ncG9ydCI7CiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIFN0cmluZyBBQ1RJT05f\nREVMRVRFX1RBQkxFX0NPTlRFTlRTID0gCiAgICAgICAgImRlbGV0ZVRhYmxl\nQ29udGVudHMiOwoKICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgU3RyaW5nW10g\nQUNUSU9OUyA9IG5ldyBTdHJpbmdbXXsKICAgICAgICBBQ1RJT05fQURELAog\nICAgICAgIEFDVElPTl9EUk9QLAogICAgICAgIEFDVElPTl9SRVRBSU4sCiAg\nICAgICAgQUNUSU9OX1JFRlJFU0gsCiAgICAgICAgQUNUSU9OX0JVSUxELAog\nICAgICAgIEFDVElPTl9SRUZMRUNULAogICAgICAgIEFDVElPTl9DUkVBVEVE\nQiwKICAgICAgICBBQ1RJT05fRFJPUERCLAogICAgICAgIEFDVElPTl9JTVBP\nUlQsCiAgICAgICAgQUNUSU9OX0VYUE9SVCwKICAgICAgICBBQ1RJT05fREVM\nRVRFX1RBQkxFX0NPTlRFTlRTLAogICAgfTsKCiAgICBwcml2YXRlIHN0YXRp\nYyBmaW5hbCBMb2NhbGl6ZXIgX2xvYyA9IExvY2FsaXplci5mb3JQYWNrYWdl\nCiAgICAgICAgKFNjaGVtYVRvb2wuY2xhc3MpOwoKICAgIHByaXZhdGUgZmlu\nYWwgSkRCQ0NvbmZpZ3VyYXRpb24gX2NvbmY7CiAgICBwcml2YXRlIGZpbmFs\nIERhdGFTb3VyY2UgX2RzOwogICAgcHJpdmF0ZSBmaW5hbCBMb2cgX2xvZzsK\nICAgIHByaXZhdGUgZmluYWwgREJEaWN0aW9uYXJ5IF9kaWN0OwogICAgcHJp\ndmF0ZSBmaW5hbCBTdHJpbmcgX2FjdGlvbjsKICAgIHByaXZhdGUgYm9vbGVh\nbiBfaWdub3JlRXJycyA9IGZhbHNlOwogICAgcHJpdmF0ZSBib29sZWFuIF9v\ncGVuanBhVGFibGVzID0gZmFsc2U7CiAgICBwcml2YXRlIGJvb2xlYW4gX2Ry\nb3BUYWJsZXMgPSB0cnVlOwogICAgcHJpdmF0ZSBib29sZWFuIF9kcm9wU2Vx\ncyA9IHRydWU7CiAgICBwcml2YXRlIGJvb2xlYW4gX3BrcyA9IHRydWU7CiAg\nICBwcml2YXRlIGJvb2xlYW4gX2ZrcyA9IHRydWU7CiAgICBwcml2YXRlIGJv\nb2xlYW4gX2luZGV4ZXMgPSB0cnVlOwogICAgcHJpdmF0ZSBib29sZWFuIF9z\nZXFzID0gdHJ1ZTsKICAgIHByaXZhdGUgUHJpbnRXcml0ZXIgX3dyaXRlciA9\nIG51bGw7CiAgICBwcml2YXRlIFNjaGVtYUdyb3VwIF9ncm91cCA9IG51bGw7\nCiAgICBwcml2YXRlIFNjaGVtYUdyb3VwIF9kYiA9IG51bGw7CiAgICBwcml2\nYXRlIGJvb2xlYW4gX2Z1bGxEQiA9IGZhbHNlOwoKICAgIC8qKgogICAgICog\nRGVmYXVsdCBjb25zdHJ1Y3Rvci4gVG9vbHMgY29uc3RydWN0ZWQgdGhpcyB3\nYXkgd2lsbCBub3QgaGF2ZSBhbgogICAgICogYWN0aW9uLCBzbyB0aGUge0Bs\naW5rICNydW4oKX0gbWV0aG9kIHdpbGwgYmUgYSBuby1vcC4KICAgICAqLwog\nICAgcHVibGljIFNjaGVtYVRvb2woSkRCQ0NvbmZpZ3VyYXRpb24gY29uZikg\newogICAgICAgIHRoaXMoY29uZiwgbnVsbCk7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBDb25zdHJ1Y3QgYSB0b29sIHRvIHBlcmZvcm0gdGhlIGdpdmVuIGFj\ndGlvbi4KICAgICAqLwogICAgcHVibGljIFNjaGVtYVRvb2woSkRCQ0NvbmZp\nZ3VyYXRpb24gY29uZiwgU3RyaW5nIGFjdGlvbikgewogICAgICAgIGlmIChh\nY3Rpb24gIT0gbnVsbCAmJiAhQXJyYXlzLmFzTGlzdChBQ1RJT05TKS5jb250\nYWlucyhhY3Rpb24pKSB7CiAgICAgICAgICAgIENvbmZpZ3VyYXRpb25zLmNv\nbmZpZ3VyZUluc3RhbmNlKHRoaXMsIGNvbmYsIGFjdGlvbiwgYWN0aW9uKTsK\nICAgICAgICB9CgogICAgICAgIF9jb25mID0gY29uZjsKICAgICAgICBfYWN0\naW9uID0gYWN0aW9uOwogICAgICAgIF9kcyA9IEFDVElPTl9CVUlMRC5lcXVh\nbHMoYWN0aW9uKSA/IG51bGwgOiBjb25mLmdldERhdGFTb3VyY2UyKG51bGwp\nOwogICAgICAgIF9sb2cgPSBjb25mLmdldExvZyhKREJDQ29uZmlndXJhdGlv\nbi5MT0dfU0NIRU1BKTsKCiAgICAgICAgLy8gaW5pdGlhbGl6ZSB0aGlzIHVw\nLWZyb250OyBvdGhlcndpc2UgdGhlIGRiZGljdGlvbmFyeWZhY3RvcnkgbWln\naHQKICAgICAgICAvLyB0cnkgdG8gdGFrZSBhIGNvbm5lY3Rpb24gdG8gaW5p\ndGlhbGl6ZSB3aGVuIHdlJ3ZlIGFscmVhZHkgZ290IG9uZToKICAgICAgICAv\nLyBiYWQgbmV3cyBpZiB0aGUgbWF4IHBvb2wgaXMgMQogICAgICAgIF9kaWN0\nID0gX2NvbmYuZ2V0REJEaWN0aW9uYXJ5SW5zdGFuY2UoKTsKICAgIH0KCiAg\nICAvKioKICAgICAqIFRoZSBhY3Rpb24gc3VwcGxpZWQgb24gY29uc3RydWN0\naW9uLgogICAgICovCiAgICBwdWJsaWMgU3RyaW5nIGdldEFjdGlvbigpIHsK\nICAgICAgICByZXR1cm4gX2FjdGlvbjsKICAgIH0KCiAgICAvKioKICAgICAq\nIElmIHRydWUsIFNRTEV4Y2VwdGlvbnMgdGhyb3duIGR1cmluZyBzY2hlbWEg\nbWFuaXB1bGF0aW9uIHdpbGwgYmUKICAgICAqIHByaW50ZWQgYnV0IGlnbm9y\nZWQuCiAgICAgKi8KICAgIHB1YmxpYyBib29sZWFuIGdldElnbm9yZUVycm9y\ncygpIHsKICAgICAgICByZXR1cm4gX2lnbm9yZUVycnM7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBJZiB0cnVlLCBTUUxFeGNlcHRpb25zIHRocm93biBkdXJp\nbmcgc2NoZW1hIG1hbmlwdWxhdGlvbiB3aWxsIGJlCiAgICAgKiBwcmludGVk\nIGJ1dCBpZ25vcmVkLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRJZ25v\ncmVFcnJvcnMoYm9vbGVhbiBpZ25vcmVFcnJzKSB7CiAgICAgICAgX2lnbm9y\nZUVycnMgPSBpZ25vcmVFcnJzOwogICAgfQoKICAgIC8qKgogICAgICogV2hl\ndGhlciB0byBhY3Qgb24gc3BlY2lhbCB0YWJsZXMgdXNlZCBieSBPcGVuSlBB\nIGNvbXBvbmVudHMKICAgICAqIGZvciBib29ra2VlcGluZy4KICAgICAqLwog\nICAgcHVibGljIGJvb2xlYW4gZ2V0T3BlbkpQQVRhYmxlcygpIHsKICAgICAg\nICByZXR1cm4gX29wZW5qcGFUYWJsZXM7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBXaGV0aGVyIHRvIGFjdCBvbiBzcGVjaWFsIHRhYmxlcyB1c2VkIGJ5IE9w\nZW5KUEEgY29tcG9uZW50cwogICAgICogZm9yIGJvb2trZWVwaW5nLgogICAg\nICovCiAgICBwdWJsaWMgdm9pZCBzZXRPcGVuSlBBVGFibGVzKGJvb2xlYW4g\nb3BlbmpwYVRhYmxlcykgewogICAgICAgIF9vcGVuanBhVGFibGVzID0gb3Bl\nbmpwYVRhYmxlczsKICAgIH0KCiAgICAvKioKICAgICAqIElmIHRydWUsIHRh\nYmxlcyB0aGF0IGFwcGVhciB0byBiZSB1bnVzZWQgd2lsbCBiZSBkcm9wcGVk\nLiBEZWZhdWx0cyB0bwogICAgICogdHJ1ZS4KICAgICAqLwogICAgcHVibGlj\nIGJvb2xlYW4gZ2V0RHJvcFRhYmxlcygpIHsKICAgICAgICByZXR1cm4gX2Ry\nb3BUYWJsZXM7CiAgICB9CgogICAgLyoqCiAgICAgKiBJZiB0cnVlLCB0YWJs\nZXMgdGhhdCBhcHBlYXIgdG8gYmUgdW51c2VkIHdpbGwgYmUgZHJvcHBlZC4g\nRGVmYXVsdHMgdG8KICAgICAqIHRydWUuCiAgICAgKi8KICAgIHB1YmxpYyB2\nb2lkIHNldERyb3BUYWJsZXMoYm9vbGVhbiBkcm9wVGFibGVzKSB7CiAgICAg\nICAgX2Ryb3BUYWJsZXMgPSBkcm9wVGFibGVzOwogICAgfQoKICAgIC8qKgog\nICAgICogSWYgdHJ1ZSwgc2VxdWVuY2VzIHRoYXQgYXBwZWFyIHRvIGJlIHVu\ndXNlZCB3aWxsIGJlIGRyb3BwZWQuIERlZmF1bHRzCiAgICAgKiB0byB0cnVl\nLgogICAgICovCiAgICBwdWJsaWMgYm9vbGVhbiBnZXREcm9wU2VxdWVuY2Vz\nKCkgewogICAgICAgIHJldHVybiBfZHJvcFNlcXM7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBJZiB0cnVlLCBzZXF1ZW5jZXMgdGhhdCBhcHBlYXIgdG8gYmUg\ndW51c2VkIHdpbGwgYmUgZHJvcHBlZC4gRGVmYXVsdHMKICAgICAqIHRvIHRy\ndWUuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldERyb3BTZXF1ZW5jZXMo\nYm9vbGVhbiBkcm9wU2VxcykgewogICAgICAgIF9kcm9wU2VxcyA9IGRyb3BT\nZXFzOwogICAgICAgIGlmIChkcm9wU2VxcykKICAgICAgICAgICAgc2V0U2Vx\ndWVuY2VzKHRydWUpOwogICAgfQoKICAgIC8qKgogICAgICogV2hldGhlciBz\nZXF1ZW5jZXMgc2hvdWxkIGJlIG1hbmlwdWxhdGVkLiBEZWZhdWx0cyB0byB0\ncnVlLgogICAgICovCiAgICBwdWJsaWMgYm9vbGVhbiBnZXRTZXF1ZW5jZXMo\nKSB7CiAgICAgICAgcmV0dXJuIF9zZXFzOwogICAgfQoKICAgIC8qKgogICAg\nICogV2hldGhlciBzZXF1ZW5jZXMgc2hvdWxkIGJlIG1hbmlwdWxhdGVkLiBE\nZWZhdWx0cyB0byB0cnVlLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRT\nZXF1ZW5jZXMoYm9vbGVhbiBzZXFzKSB7CiAgICAgICAgX3NlcXMgPSBzZXFz\nOwogICAgfQoKICAgIC8qKgogICAgICogV2hldGhlciBpbmRleGVzIG9uIGV4\naXN0aW5nIHRhYmxlcyBzaG91bGQgYmUgbWFuaXB1bGF0ZWQuCiAgICAgKiBE\nZWZhdWx0cyB0byB0cnVlLgogICAgICovCiAgICBwdWJsaWMgYm9vbGVhbiBn\nZXRJbmRleGVzKCkgewogICAgICAgIHJldHVybiBfaW5kZXhlczsKICAgIH0K\nCiAgICAvKioKICAgICAqIFdoZXRoZXIgaW5kZXhlcyBvbiBleGlzdGluZyB0\nYWJsZXMgc2hvdWxkIGJlIG1hbmlwdWxhdGVkLgogICAgICogRGVmYXVsdHMg\ndG8gdHJ1ZS4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0SW5kZXhlcyhi\nb29sZWFuIGluZGV4ZXMpIHsKICAgICAgICBfaW5kZXhlcyA9IGluZGV4ZXM7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBXaGV0aGVyIGZvcmVpZ24ga2V5cyBv\nbiBleGlzdGluZyB0YWJsZXMgc2hvdWxkIGJlIG1hbmlwdWxhdGVkLgogICAg\nICogRGVmYXVsdHMgdG8gdHJ1ZS4KICAgICAqLwogICAgcHVibGljIGJvb2xl\nYW4gZ2V0Rm9yZWlnbktleXMoKSB7CiAgICAgICAgcmV0dXJuIF9ma3M7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBXaGV0aGVyIGZvcmVpZ24ga2V5cyBvbiBl\neGlzdGluZyB0YWJsZXMgc2hvdWxkIGJlIG1hbmlwdWxhdGVkLgogICAgICog\nRGVmYXVsdHMgdG8gdHJ1ZS4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0\nRm9yZWlnbktleXMoYm9vbGVhbiBma3MpIHsKICAgICAgICBfZmtzID0gZmtz\nOwogICAgfQoKICAgIC8qKgogICAgICogV2hldGhlciBwcmltYXJ5IGtleXMg\nb24gZXhpc3RpbmcgdGFibGVzIHNob3VsZCBiZSBtYW5pcHVsYXRlZC4KICAg\nICAqIERlZmF1bHRzIHRvIHRydWUuCiAgICAgKi8KICAgIHB1YmxpYyBib29s\nZWFuIGdldFByaW1hcnlLZXlzKCkgewogICAgICAgIHJldHVybiBfcGtzOwog\nICAgfQoKICAgIC8qKgogICAgICogV2hldGhlciBwcmltYXJ5IGtleXMgb24g\nZXhpc3RpbmcgdGFibGVzIHNob3VsZCBiZSBtYW5pcHVsYXRlZC4KICAgICAq\nIERlZmF1bHRzIHRvIHRydWUuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNl\ndFByaW1hcnlLZXlzKGJvb2xlYW4gcGtzKSB7CiAgICAgICAgX3BrcyA9IHBr\nczsKICAgIH0KCiAgICAvKioKICAgICAqIFRoZSBzdHJlYW0gdG8gd3JpdGUg\ndG8gZm9yIHRoZSBjcmVhdGlvbiBvZiBTUUwgc2NyaXB0cy4gSWYgdGhlCiAg\nICAgKiBzdHJlYW0gaXMgbm9uLW51bGwsIGFsbCBTUUwgd2lsbCBiZSB3cml0\ndGVuIHRvIHRoaXMgc3RyZWFtIHJhdGhlciB0aGFuCiAgICAgKiBleGVjdXRl\nZCBhZ2FpbnN0IHRoZSBkYXRhYmFzZS4KICAgICAqLwogICAgcHVibGljIFdy\naXRlciBnZXRXcml0ZXIoKSB7CiAgICAgICAgcmV0dXJuIF93cml0ZXI7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBUaGUgc3RyZWFtIHRvIHdyaXRlIHRvIGZv\nciB0aGUgY3JlYXRpb24gb2YgU1FMIHNjcmlwdHMuIElmIHRoZQogICAgICog\nc3RyZWFtIGlzIG5vbi1udWxsLCBhbGwgU1FMIHdpbGwgYmUgd3JpdHRlbiB0\nbyB0aGlzIHN0cmVhbSByYXRoZXIgdGhhbgogICAgICogZXhlY3V0ZWQgYWdh\naW5zdCB0aGUgZGF0YWJhc2UuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNl\ndFdyaXRlcihXcml0ZXIgd3JpdGVyKSB7CiAgICAgICAgaWYgKHdyaXRlciA9\nPSBudWxsKQogICAgICAgICAgICBfd3JpdGVyID0gbnVsbDsKICAgICAgICBl\nbHNlIGlmICh3cml0ZXIgaW5zdGFuY2VvZiBQcmludFdyaXRlcikKICAgICAg\nICAgICAgX3dyaXRlciA9IChQcmludFdyaXRlcikgd3JpdGVyOwogICAgICAg\nIGVsc2UKICAgICAgICAgICAgX3dyaXRlciA9IG5ldyBQcmludFdyaXRlcih3\ncml0ZXIpOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRoZSBzY2hl\nbWEgZ3JvdXAgdGhlIHRvb2wgd2lsbCBhY3Qgb24uCiAgICAgKi8KICAgIHB1\nYmxpYyBTY2hlbWFHcm91cCBnZXRTY2hlbWFHcm91cCgpIHsKICAgICAgICBy\nZXR1cm4gX2dyb3VwOwogICAgfQoKICAgIC8qKgogICAgICogU2V0IHRoZSBz\nY2hlbWEgZ3JvdXAgdGhlIHRvb2wgd2lsbCBhY3Qgb24uCiAgICAgKi8KICAg\nIHB1YmxpYyB2b2lkIHNldFNjaGVtYUdyb3VwKFNjaGVtYUdyb3VwIGdyb3Vw\nKSB7CiAgICAgICAgX2dyb3VwID0gZ3JvdXA7CiAgICB9CgogICAgLy8vLy8v\nLy8vLy8KICAgIC8vIEFjdGlvbnMKICAgIC8vLy8vLy8vLy8vCgogICAgLyoq\nCiAgICAgKiBSdW4gdGhlIHRvb2wgYWN0aW9uLgogICAgICovCiAgICBwdWJs\naWMgdm9pZCBydW4oKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewog\nICAgICAgIGlmIChfYWN0aW9uID09IG51bGwpCiAgICAgICAgICAgIHJldHVy\nbjsKCiAgICAgICAgaWYgKEFDVElPTl9BREQuZXF1YWxzKF9hY3Rpb24pKQog\nICAgICAgICAgICBhZGQoKTsKICAgICAgICBlbHNlIGlmIChBQ1RJT05fRFJP\nUC5lcXVhbHMoX2FjdGlvbikpCiAgICAgICAgICAgIGRyb3AoKTsKICAgICAg\nICBlbHNlIGlmIChBQ1RJT05fUkVUQUlOLmVxdWFscyhfYWN0aW9uKSkKICAg\nICAgICAgICAgcmV0YWluKCk7CiAgICAgICAgZWxzZSBpZiAoQUNUSU9OX1JF\nRlJFU0guZXF1YWxzKF9hY3Rpb24pKQogICAgICAgICAgICByZWZyZXNoKCk7\nCiAgICAgICAgZWxzZSBpZiAoQUNUSU9OX0JVSUxELmVxdWFscyhfYWN0aW9u\nKSkKICAgICAgICAgICAgYnVpbGQoKTsKICAgICAgICBlbHNlIGlmIChBQ1RJ\nT05fQ1JFQVRFREIuZXF1YWxzKF9hY3Rpb24pKQogICAgICAgICAgICBjcmVh\ndGVEQigpOwogICAgICAgIGVsc2UgaWYgKEFDVElPTl9EUk9QREIuZXF1YWxz\nKF9hY3Rpb24pKQogICAgICAgICAgICBkcm9wREIoKTsKICAgICAgICBlbHNl\nIGlmIChBQ1RJT05fREVMRVRFX1RBQkxFX0NPTlRFTlRTLmVxdWFscyhfYWN0\naW9uKSkKICAgICAgICAgICAgZGVsZXRlVGFibGVDb250ZW50cygpOwogICAg\nfQoKICAgIC8qKgogICAgICogQWRkcyBhbnkgY29tcG9uZW50cyBwcmVzZW50\nIGluIHRoZSBzY2hlbWEgcmVwb3NpdG9yeSBidXQgYWJzZW50IGZyb20KICAg\nICAqIHRoZSBkYXRhYmFzZS4gUGFja2FnZS1wcml2YXRlIGZvciB0ZXN0aW5n\nLgogICAgICovCiAgICB2b2lkIGFkZCgpCiAgICAgICAgdGhyb3dzIFNRTEV4\nY2VwdGlvbiB7CiAgICAgICAgYWRkKGdldERCU2NoZW1hR3JvdXAoZmFsc2Up\nLCBhc3NlcnRTY2hlbWFHcm91cCgpKTsKICAgIH0KCiAgICAvKioKICAgICAq\nIERyb3BzIGFsbCBzY2hlbWEgY29tcG9uZW50cyBpbiB0aGUgc2NoZW1hIHJl\ncG9zaXRvcnkgdGhhdCBhbHNvIGV4aXN0CiAgICAgKiBpbiB0aGUgZGF0YWJh\nc2UuIFBhY2thZ2UtcHJpdmF0ZSBmb3IgdGVzdGluZy4KICAgICAqLwogICAg\ndm9pZCBkcm9wKCkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAg\nICAgICBkcm9wKGdldERCU2NoZW1hR3JvdXAoZmFsc2UpLCBhc3NlcnRTY2hl\nbWFHcm91cCgpKTsKICAgIH0KCiAgICAvKioKICAgICAqIERyb3BzIGRhdGFi\nYXNlIGNvbXBvbmVudHMgdGhhdCBhcmUgbm90IG1lbnRpb25lZCBpbiB0aGUg\nc2NoZW1hCiAgICAgKiByZXBvc2l0b3J5LiBQYWNrYWdlLXByaXZhdGUgZm9y\nIHRlc3RpbmcuCiAgICAgKi8KICAgIHZvaWQgcmV0YWluKCkKICAgICAgICB0\naHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICByZXRhaW4oZ2V0REJTY2hl\nbWFHcm91cCh0cnVlKSwgYXNzZXJ0U2NoZW1hR3JvdXAoKSwKICAgICAgICAg\nICAgZ2V0RHJvcFRhYmxlcygpLCBnZXREcm9wU2VxdWVuY2VzKCkpOwogICAg\nfQoKICAgIC8qKgogICAgICogQWRkcyBhbnkgY29tcG9uZW50cyBwcmVzZW50\nIGluIHRoZSBzY2hlbWEgcmVwb3NpdG9yeSBidXQgYWJzZW50IGZyb20KICAg\nICAqIHRoZSBkYXRhYmFzZSwgYW5kIGRyb3BzIHVudXNlZCBkYXRhYmFzZSBj\nb21wb25lbnRzLgogICAgICogUGFja2FnZS1wcml2YXRlIGZvciB0ZXN0aW5n\nLgogICAgICovCiAgICB2b2lkIHJlZnJlc2goKQogICAgICAgIHRocm93cyBT\nUUxFeGNlcHRpb24gewogICAgICAgIFNjaGVtYUdyb3VwIGxvY2FsID0gYXNz\nZXJ0U2NoZW1hR3JvdXAoKTsKICAgICAgICBTY2hlbWFHcm91cCBkYiA9IGdl\ndERCU2NoZW1hR3JvdXAodHJ1ZSk7CiAgICAgICAgcmV0YWluKGRiLCBsb2Nh\nbCwgZ2V0RHJvcFRhYmxlcygpLCBnZXREcm9wU2VxdWVuY2VzKCkpOwogICAg\nICAgIGFkZChkYiwgbG9jYWwpOwogICAgfQoKICAgIC8qKgogICAgICogUmUt\nZXhlY3V0ZSBhbGwgU1FMIHVzZWQgZm9yIHRoZSBjcmVhdGlvbiBvZiB0aGUg\nY3VycmVudCBkYXRhYmFzZTsKICAgICAqIHRoaXMgYWN0aW9uIGlzIHVzdWFs\nbHkgdXNlZCB3aGVuIGNyZWF0aW5nIFNRTCBzY3JpcHRzLgogICAgICogUGFj\na2FnZS1wcml2YXRlIGZvciB0ZXN0aW5nLgogICAgICovCiAgICB2b2lkIGNy\nZWF0ZURCKCkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAg\nICBTY2hlbWFHcm91cCBncm91cCA9IG5ldyBTY2hlbWFHcm91cCgpOwogICAg\nICAgIGdyb3VwLmFkZFNjaGVtYSgpOwogICAgICAgIGFkZChncm91cCwgZ2V0\nREJTY2hlbWFHcm91cCh0cnVlKSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBS\nZS1leGVjdXRlIGFsbCBTUUwgdXNlZCBmb3IgdGhlIGNyZWF0aW9uIG9mIHRo\nZSBjdXJyZW50IGRhdGFiYXNlOwogICAgICogdGhpcyBhY3Rpb24gaXMgdXN1\nYWxseSB1c2VkIHdoZW4gY3JlYXRpbmcgU1FMIHNjcmlwdHMuCiAgICAgKiBQ\nYWNrYWdlLXByaXZhdGUgZm9yIHRlc3RpbmcuCiAgICAgKi8KICAgIHZvaWQg\nYnVpbGQoKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAg\nIFNjaGVtYUdyb3VwIGdyb3VwID0gbmV3IFNjaGVtYUdyb3VwKCk7CiAgICAg\nICAgZ3JvdXAuYWRkU2NoZW1hKCk7CiAgICAgICAgYWRkKGdyb3VwLCBhc3Nl\ncnRTY2hlbWFHcm91cCgpKTsKICAgIH0KCiAgICAvKioKICAgICAqIERyb3Ag\ndGhlIGN1cnJlbnQgZGF0YWJhc2UuIFBhY2thZ2UtcHJpdmF0ZSBmb3IgdGVz\ndGluZy4KICAgICAqLwogICAgdm9pZCBkcm9wREIoKQogICAgICAgIHRocm93\ncyBTUUxFeGNlcHRpb24gewogICAgICAgIHJldGFpbihnZXREQlNjaGVtYUdy\nb3VwKHRydWUpLCBuZXcgU2NoZW1hR3JvdXAoKSwgdHJ1ZSwgdHJ1ZSk7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBJc3N1ZSBERUxFVEUgc3RhdGVtZW50IGFn\nYWluc3QgYWxsIGtub3duIHRhYmxlcy4KICAgICAqLwogICAgcHJpdmF0ZSB2\nb2lkIGRlbGV0ZVRhYmxlQ29udGVudHMoKSAKICAgICAgICB0aHJvd3MgU1FM\nRXhjZXB0aW9uIHsKICAgICAgICBTY2hlbWFHcm91cCBncm91cCA9IGdldFNj\naGVtYUdyb3VwKCk7CiAgICAgICAgU2NoZW1hW10gc2NoZW1hcyA9IGdyb3Vw\nLmdldFNjaGVtYXMoKTsKICAgICAgICBDb2xsZWN0aW9uPFRhYmxlPiB0YWJs\nZXMgPSBuZXcgTGlua2VkSGFzaFNldDxUYWJsZT4oKTsKICAgICAgICBmb3Ig\nKGludCBpID0gMDsgaSA8IHNjaGVtYXMubGVuZ3RoOyBpKyspIHsKICAgICAg\nICAgICAgVGFibGVbXSB0cyA9IHNjaGVtYXNbaV0uZ2V0VGFibGVzKCk7CiAg\nICAgICAgICAgIGZvciAoaW50IGogPSAwOyBqIDwgdHMubGVuZ3RoOyBqKysp\nCiAgICAgICAgICAgICAgICB0YWJsZXMuYWRkKHRzW2pdKTsKICAgICAgICB9\nCiAgICAgICAgVGFibGVbXSB0YWJsZUFycmF5ID0gKFRhYmxlW10pIHRhYmxl\ncy50b0FycmF5KG5ldyBUYWJsZVt0YWJsZXMuc2l6ZSgpXSk7CiAgICAgICAg\nU3RyaW5nW10gc3FsID0gX2NvbmYuZ2V0REJEaWN0aW9uYXJ5SW5zdGFuY2Uo\nKQogICAgICAgICAgICAuZ2V0RGVsZXRlVGFibGVDb250ZW50c1NRTCh0YWJs\nZUFycmF5LF9kcy5nZXRDb25uZWN0aW9uKCkpOwogICAgICAgIGlmICghZXhl\nY3V0ZVNRTChzcWwpKQogICAgICAgICAgICBfbG9nLndhcm4oX2xvYy5nZXQo\nImRlbGV0ZS10YWJsZS1jb250ZW50cyIpKTsKICAgIH0KCiAgICAvKioKICAg\nICAqIFJlY29yZCB0aGUgY2hhbmdlcyBtYWRlIHRvIHRoZSBEQiBpbiB0aGUg\nY3VycmVudCB7QGxpbmsgU2NoZW1hRmFjdG9yeX0uCiAgICAgKi8KICAgIHB1\nYmxpYyB2b2lkIHJlY29yZCgpIHsKICAgICAgICBpZiAoX2RiICE9IG51bGwg\nJiYgX3dyaXRlciA9PSBudWxsKQogICAgICAgICAgICBfY29uZi5nZXRTY2hl\nbWFGYWN0b3J5SW5zdGFuY2UoKS5zdG9yZVNjaGVtYShfZGIpOwogICAgfQoK\nICAgIC8qKgogICAgICogQWRkcyBhbGwgZGF0YWJhc2UgY29tcG9uZW50cyBp\nbiB0aGUgcmVwb3NpdG9yeSBzY2hlbWEgdGhhdCBhcmUgbm90CiAgICAgKiBw\ncmVzZW50IGluIHRoZSBnaXZlbiBkYXRhYmFzZSBzY2hlbWEgdG8gdGhlIGRh\ndGFiYXNlLgogICAgICovCiAgICBwcml2YXRlIHZvaWQgYWRkKFNjaGVtYUdy\nb3VwIGRiLCBTY2hlbWFHcm91cCByZXBvcykKICAgICAgICB0aHJvd3MgU1FM\nRXhjZXB0aW9uIHsKICAgICAgICAvLyBhZGQgc2VxdWVuY2VzCiAgICAgICAg\nU2NoZW1hW10gc2NoZW1hcyA9IHJlcG9zLmdldFNjaGVtYXMoKTsKICAgICAg\nICBTY2hlbWEgc2NoZW1hOwogICAgICAgIGlmIChfc2VxcykgewogICAgICAg\nICAgICBTZXF1ZW5jZVtdIHNlcXM7CiAgICAgICAgICAgIGZvciAoaW50IGkg\nPSAwOyBpIDwgc2NoZW1hcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAg\nICAgc2VxcyA9IHNjaGVtYXNbaV0uZ2V0U2VxdWVuY2VzKCk7CiAgICAgICAg\nICAgICAgICBmb3IgKGludCBqID0gMDsgaiA8IHNlcXMubGVuZ3RoOyBqKysp\nIHsKICAgICAgICAgICAgICAgICAgICBpZiAoZGIuZmluZFNlcXVlbmNlKHNj\naGVtYXNbaV0sIHNlcXNbal0uZ2V0UXVhbGlmaWVkUGF0aCgpKSAhPQogICAg\nICAgICAgICAgICAgICAgICAgICAgICAgbnVsbCkKICAgICAgICAgICAgICAg\nICAgICAgICAgY29udGludWU7CgogICAgICAgICAgICAgICAgICAgIGlmIChj\ncmVhdGVTZXF1ZW5jZShzZXFzW2pdKSkgewogICAgICAgICAgICAgICAgICAg\nICAgICBzY2hlbWEgPSBkYi5nZXRTY2hlbWEoc2Vxc1tqXS5nZXRTY2hlbWFJ\nZGVudGlmaWVyKCkpOwogICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2No\nZW1hID09IG51bGwpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY2hl\nbWEgPSBkYi5hZGRTY2hlbWEoc2Vxc1tqXS5nZXRTY2hlbWFJZGVudGlmaWVy\nKCkpOwogICAgICAgICAgICAgICAgICAgICAgICBzY2hlbWEuaW1wb3J0U2Vx\ndWVuY2Uoc2Vxc1tqXSk7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlCiAg\nICAgICAgICAgICAgICAgICAgICAgIF9sb2cud2FybihfbG9jLmdldCgiYWRk\nLXNlcSIsIHNlcXNbal0pKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAg\nICAgfQogICAgICAgIH0KCiAgICAgICAgLy8gb3JkZXIgaXMgaW1wb3J0YW50\nIGluIHRoaXMgbWV0aG9kOyBzdGFydCB3aXRoIGNvbHVtbnMKICAgICAgICBU\nYWJsZVtdIHRhYnM7CiAgICAgICAgVGFibGUgZGJUYWJsZTsKICAgICAgICBD\nb2x1bW5bXSBjb2xzOwogICAgICAgIENvbHVtbiBjb2w7CiAgICAgICAgREJJ\nZGVudGlmaWVyIGRlZmF1bHRTY2hlbWFOYW1lID0gREJJZGVudGlmaWVyLm5l\nd1NjaGVtYShfZGljdC5nZXREZWZhdWx0U2NoZW1hTmFtZSgpKTsKICAgICAg\nICBmb3IgKGludCBpID0gMDsgaSA8IHNjaGVtYXMubGVuZ3RoOyBpKyspIHsK\nICAgICAgICAgICAgdGFicyA9IHNjaGVtYXNbaV0uZ2V0VGFibGVzKCk7CiAg\nICAgICAgICAgIGZvciAoaW50IGogPSAwOyBqIDwgdGFicy5sZW5ndGg7IGor\nKykgewogICAgICAgICAgICAgICAgY29scyA9IHRhYnNbal0uZ2V0Q29sdW1u\ncygpOwogICAgICAgICAgICAgICAgZGJUYWJsZSA9IGRiLmZpbmRUYWJsZShz\nY2hlbWFzW2ldLCB0YWJzW2pdLmdldFF1YWxpZmllZFBhdGgoKSwgZGVmYXVs\ndFNjaGVtYU5hbWUpOwogICAgICAgICAgICAgICAgZm9yIChpbnQgayA9IDA7\nIGsgPCBjb2xzLmxlbmd0aDsgaysrKSB7CiAgICAgICAgICAgICAgICAgICAg\naWYgKGRiVGFibGUgIT0gbnVsbCkgewogICAgICAgICAgICAgICAgICAgICAg\nICBEQklkZW50aWZpZXIgY29sTmFtZSA9IGNvbHNba10uZ2V0SWRlbnRpZmll\ncigpOwogICAgICAgICAgICAgICAgICAgICAgICBjb2wgPSBkYlRhYmxlLmdl\ndENvbHVtbihjb2xOYW1lKTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYg\nKGNvbCA9PSBudWxsKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBp\nZiAoYWRkQ29sdW1uKGNvbHNba10pKQogICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgIGRiVGFibGUuaW1wb3J0Q29sdW1uKGNvbHNba10pOwogICAg\nICAgICAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgIF9sb2cud2FybihfbG9jLmdldCgiYWRkLWNvbCIs\nIGNvbHNba10sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nIHRhYnNbal0pKTsKICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlm\nICghY29sc1trXS5lcXVhbHNDb2x1bW4oY29sKSkgewogICAgICAgICAgICAg\nICAgICAgICAgICAgICAgX2xvZy53YXJuKF9sb2MuZ2V0KCJiYWQtY29sIiwg\nbmV3IE9iamVjdFtdewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nIGNvbCwgZGJUYWJsZSwgY29sLmdldERlc2NyaXB0aW9uKCksCiAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgY29sc1trXS5nZXREZXNjcmlwdGlv\nbigpIH0pKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAg\nICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQog\nICAgICAgIH0KCiAgICAgICAgLy8gcHJpbWFyeSBrZXlzCiAgICAgICAgaWYg\nKF9wa3MpIHsKICAgICAgICAgICAgUHJpbWFyeUtleSBwazsKICAgICAgICAg\nICAgZm9yIChpbnQgaSA9IDA7IGkgPCBzY2hlbWFzLmxlbmd0aDsgaSsrKSB7\nCiAgICAgICAgICAgICAgICB0YWJzID0gc2NoZW1hc1tpXS5nZXRUYWJsZXMo\nKTsKICAgICAgICAgICAgICAgIGZvciAoaW50IGogPSAwOyBqIDwgdGFicy5s\nZW5ndGg7IGorKykgewogICAgICAgICAgICAgICAgICAgIHBrID0gdGFic1tq\nXS5nZXRQcmltYXJ5S2V5KCk7CiAgICAgICAgICAgICAgICAgICAgZGJUYWJs\nZSA9IGRiLmZpbmRUYWJsZShzY2hlbWFzW2ldLCB0YWJzW2pdLmdldFF1YWxp\nZmllZFBhdGgoKSk7CiAgICAgICAgICAgICAgICAgICAgaWYgKHBrICE9IG51\nbGwgJiYgIXBrLmlzTG9naWNhbCgpICYmIGRiVGFibGUgIT0gbnVsbCkgewog\nICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGJUYWJsZS5nZXRQcmltYXJ5\nS2V5KCkgPT0gbnVsbAogICAgICAgICAgICAgICAgICAgICAgICAgICAgJiYg\nYWRkUHJpbWFyeUtleShwaykpCiAgICAgICAgICAgICAgICAgICAgICAgICAg\nICBkYlRhYmxlLmltcG9ydFByaW1hcnlLZXkocGspOwogICAgICAgICAgICAg\nICAgICAgICAgICBlbHNlIGlmIChkYlRhYmxlLmdldFByaW1hcnlLZXkoKSA9\nPSBudWxsKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgX2xvZy53YXJu\nKF9sb2MuZ2V0KCJhZGQtcGsiLCBwaywgdGFic1tqXSkpOwogICAgICAgICAg\nICAgICAgICAgICAgICBlbHNlIGlmICghcGsuZXF1YWxzUHJpbWFyeUtleShk\nYlRhYmxlLmdldFByaW1hcnlLZXkoKSkpCiAgICAgICAgICAgICAgICAgICAg\nICAgICAgICBfbG9nLndhcm4oX2xvYy5nZXQoImJhZC1wayIsCiAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgZGJUYWJsZS5nZXRQcmltYXJ5S2V5\nKCksIGRiVGFibGUpKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAg\nICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIC8v\nIHRhYmxlcwogICAgICAgIFNldDxUYWJsZT4gbmV3VGFibGVzID0gbmV3IEhh\nc2hTZXQ8VGFibGU+KCk7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBz\nY2hlbWFzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIHRhYnMgPSBzY2hl\nbWFzW2ldLmdldFRhYmxlcygpOwogICAgICAgICAgICBmb3IgKGludCBqID0g\nMDsgaiA8IHRhYnMubGVuZ3RoOyBqKyspIHsKICAgICAgICAgICAgICAgIGlm\nIChkYi5maW5kVGFibGUoc2NoZW1hc1tpXSwgdGFic1tqXS5nZXRRdWFsaWZp\nZWRQYXRoKCkpICE9IG51bGwpCiAgICAgICAgICAgICAgICAgICAgY29udGlu\ndWU7CgogICAgICAgICAgICAgICAgaWYgKGNyZWF0ZVRhYmxlKHRhYnNbal0p\nKSB7CiAgICAgICAgICAgICAgICAgICAgbmV3VGFibGVzLmFkZCh0YWJzW2pd\nKTsKICAgICAgICAgICAgICAgICAgICBzY2hlbWEgPSBkYi5nZXRTY2hlbWEo\ndGFic1tqXS5nZXRTY2hlbWFJZGVudGlmaWVyKCkpOwogICAgICAgICAgICAg\nICAgICAgIGlmIChzY2hlbWEgPT0gbnVsbCkKICAgICAgICAgICAgICAgICAg\nICAgICAgc2NoZW1hID0gZGIuYWRkU2NoZW1hKHRhYnNbal0uZ2V0U2NoZW1h\nSWRlbnRpZmllcigpKTsKICAgICAgICAgICAgICAgICAgICBzY2hlbWEuaW1w\nb3J0VGFibGUodGFic1tqXSk7CiAgICAgICAgICAgICAgICB9IGVsc2UKICAg\nICAgICAgICAgICAgICAgICBfbG9nLndhcm4oX2xvYy5nZXQoImFkZC10YWJs\nZSIsIHRhYnNbal0pKTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAg\nICAgLy8gaW5kZXhlcwogICAgICAgIEluZGV4W10gaWR4czsKICAgICAgICBJ\nbmRleCBpZHg7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBzY2hlbWFz\nLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIHRhYnMgPSBzY2hlbWFzW2ld\nLmdldFRhYmxlcygpOwogICAgICAgICAgICBmb3IgKGludCBqID0gMDsgaiA8\nIHRhYnMubGVuZ3RoOyBqKyspIHsKICAgICAgICAgICAgICAgIC8vIGNyZWF0\nZSBpbmRleGVzIG9uIG5ldyB0YWJsZXMgZXZlbiBpZiBpbmRleGVzCiAgICAg\nICAgICAgICAgICAvLyBoYXZlIGJlZW4gdHVybmVkIG9mZgogICAgICAgICAg\nICAgICAgaWYgKCFfaW5kZXhlcyAmJiAhbmV3VGFibGVzLmNvbnRhaW5zKHRh\nYnNbal0pKQogICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOwoKICAgICAg\nICAgICAgICAgIGlkeHMgPSB0YWJzW2pdLmdldEluZGV4ZXMoKTsKICAgICAg\nICAgICAgICAgIGRiVGFibGUgPSBkYi5maW5kVGFibGUoc2NoZW1hc1tpXSwg\ndGFic1tqXS5nZXRRdWFsaWZpZWRQYXRoKCkpOwogICAgICAgICAgICAgICAg\nZm9yIChpbnQgayA9IDA7IGsgPCBpZHhzLmxlbmd0aDsgaysrKSB7CiAgICAg\nICAgICAgICAgICAgICAgaWYgKGRiVGFibGUgIT0gbnVsbCkgewogICAgICAg\nICAgICAgICAgICAgICAgICBpZHggPSBmaW5kSW5kZXgoZGJUYWJsZSwgaWR4\nc1trXSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpZHggPT0gbnVs\nbCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNyZWF0ZUlu\nZGV4KGlkeHNba10sIGRiVGFibGUpKQogICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgIGRiVGFibGUuaW1wb3J0SW5kZXgoaWR4c1trXSk7CiAgICAg\nICAgICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgX2xvZy53YXJuKF9sb2MuZ2V0KCJhZGQtaW5kZXgi\nLCBpZHhzW2tdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICB0YWJzW2pdKSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBp\nZiAoIWlkeHNba10uZXF1YWxzSW5kZXgoaWR4KSkKICAgICAgICAgICAgICAg\nICAgICAgICAgICAgIF9sb2cud2FybihfbG9jLmdldCgiYmFkLWluZGV4Iiwg\naWR4LCBkYlRhYmxlKSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAg\nICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAv\nLyBVbmlxdWUgQ29uc3RyYWludHMgb24gZ3JvdXAgb2YgY29sdW1ucwogICAg\nICAgIFVuaXF1ZVtdIHVuaXF1ZXM7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7\nIGkgPCBzY2hlbWFzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIHRhYnMg\nPSBzY2hlbWFzW2ldLmdldFRhYmxlcygpOwogICAgICAgICAgICBmb3IgKGlu\ndCBqID0gMDsgaiA8IHRhYnMubGVuZ3RoOyBqKyspIHsKICAgICAgICAgICAg\nICAgIC8vIGNyZWF0ZSB1bmlxdWUgY29uc3RyYWludHMgb25seSBvbiBuZXcg\ndGFibGVzIAogICAgICAgICAgICAgICAgaWYgKCFuZXdUYWJsZXMuY29udGFp\nbnModGFic1tqXSkpCiAgICAgICAgICAgICAgICAgICAgY29udGludWU7Cgog\nICAgICAgICAgICAgICAgdW5pcXVlcyA9IHRhYnNbal0uZ2V0VW5pcXVlcygp\nOwogICAgICAgICAgICAgICAgaWYgKHVuaXF1ZXMgPT0gbnVsbCB8fCB1bmlx\ndWVzLmxlbmd0aCA9PSAwKQogICAgICAgICAgICAgICAgICAgIGNvbnRpbnVl\nOwogICAgICAgICAgICAgICAgZGJUYWJsZSA9IGRiLmZpbmRUYWJsZSh0YWJz\nW2pdKTsKICAgICAgICAgICAgICAgIGlmIChkYlRhYmxlID09IG51bGwpCiAg\nICAgICAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgICAgICBm\nb3IgKGludCBrID0gMDsgayA8IHVuaXF1ZXMubGVuZ3RoOyBrKyspIHsKICAg\nICAgICAgICAgICAgICAgICBkYlRhYmxlLmltcG9ydFVuaXF1ZSh1bmlxdWVz\nW2tdKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAg\nIH0KICAgICAgICAKICAgICAgICAvLyBmb3JlaWduIGtleXMKICAgICAgICBG\nb3JlaWduS2V5W10gZmtzOwogICAgICAgIEZvcmVpZ25LZXkgZms7CiAgICAg\nICAgZm9yIChpbnQgaSA9IDA7IGkgPCBzY2hlbWFzLmxlbmd0aDsgaSsrKSB7\nCiAgICAgICAgICAgIHRhYnMgPSBzY2hlbWFzW2ldLmdldFRhYmxlcygpOwog\nICAgICAgICAgICBmb3IgKGludCBqID0gMDsgaiA8IHRhYnMubGVuZ3RoOyBq\nKyspIHsKICAgICAgICAgICAgICAgIC8vIGNyZWF0ZSBmb3JlaWduIGtleXMg\nb24gbmV3IHRhYmxlcyBldmVuIGlmIGZrcwogICAgICAgICAgICAgICAgLy8g\naGF2ZSBiZWVuIHR1cm5lZCBvZmYKICAgICAgICAgICAgICAgIGlmICghX2Zr\ncyAmJiAhbmV3VGFibGVzLmNvbnRhaW5zKHRhYnNbal0pKQogICAgICAgICAg\nICAgICAgICAgIGNvbnRpbnVlOwoKICAgICAgICAgICAgICAgIGZrcyA9IHRh\nYnNbal0uZ2V0Rm9yZWlnbktleXMoKTsKICAgICAgICAgICAgICAgIGRiVGFi\nbGUgPSBkYi5maW5kVGFibGUoc2NoZW1hc1tpXSx0YWJzW2pdLmdldFF1YWxp\nZmllZFBhdGgoKSk7CiAgICAgICAgICAgICAgICBmb3IgKGludCBrID0gMDsg\nayA8IGZrcy5sZW5ndGg7IGsrKykgewogICAgICAgICAgICAgICAgICAgIGlm\nICghZmtzW2tdLmlzTG9naWNhbCgpICYmIGRiVGFibGUgIT0gbnVsbCkgewog\nICAgICAgICAgICAgICAgICAgICAgICBmayA9IGZpbmRGb3JlaWduS2V5KGRi\nVGFibGUsIGZrc1trXSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChm\nayA9PSBudWxsKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAo\nYWRkRm9yZWlnbktleShma3Nba10pKQogICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgIGRiVGFibGUuaW1wb3J0Rm9yZWlnbktleShma3Nba10pOwog\nICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgIF9sb2cud2FybihfbG9jLmdldCgiYWRkLWZr\nIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmtzW2td\nLCB0YWJzW2pdKSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBp\nZiAoIWZrc1trXS5lcXVhbHNGb3JlaWduS2V5KGZrKSkKICAgICAgICAgICAg\nICAgICAgICAgICAgICAgIF9sb2cud2FybihfbG9jLmdldCgiYmFkLWZrIiwg\nZmssIGRiVGFibGUpKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAg\nICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAg\nLyoqCiAgICAgKiBEcm9wcyBhbGwgZGF0YWJhc2UgY29tcG9uZW50cyB0aGF0\nIGFyZSBpbiB0aGUgZ2l2ZW4gZGF0YWJhc2Ugc2NoZW1hCiAgICAgKiBidXQg\nbm90IGluIHRoZSByZXBvc2l0b3J5IHNjaGVtYS4KICAgICAqLwogICAgcHJp\ndmF0ZSB2b2lkIHJldGFpbihTY2hlbWFHcm91cCBkYiwgU2NoZW1hR3JvdXAg\ncmVwb3MsIGJvb2xlYW4gdGFibGVzLAogICAgICAgIGJvb2xlYW4gc2VxdWVu\nY2VzKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIFNj\naGVtYVtdIHNjaGVtYXMgPSBkYi5nZXRTY2hlbWFzKCk7CiAgICAgICAgaWYg\nKF9zZXFzICYmIHNlcXVlbmNlcykgewogICAgICAgICAgICBTZXF1ZW5jZVtd\nIHNlcXM7CiAgICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgc2NoZW1h\ncy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgc2VxcyA9IHNjaGVt\nYXNbaV0uZ2V0U2VxdWVuY2VzKCk7CiAgICAgICAgICAgICAgICBmb3IgKGlu\ndCBqID0gMDsgaiA8IHNlcXMubGVuZ3RoOyBqKyspIHsKICAgICAgICAgICAg\nICAgICAgICBpZiAoIWlzRHJvcHBhYmxlKHNlcXNbal0pKQogICAgICAgICAg\nICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgICAgICAgICBp\nZiAocmVwb3MuZmluZFNlcXVlbmNlKHNlcXNbal0pID09IG51bGwpIHsKICAg\nICAgICAgICAgICAgICAgICAgICAgaWYgKGRyb3BTZXF1ZW5jZShzZXFzW2pd\nKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjaGVtYXNbaV0ucmVt\nb3ZlU2VxdWVuY2Uoc2Vxc1tqXSk7CiAgICAgICAgICAgICAgICAgICAgICAg\nIGVsc2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9sb2cud2Fybihf\nbG9jLmdldCgiZHJvcC1zZXEiLCBzZXFzW2pdKSk7CiAgICAgICAgICAgICAg\nICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAg\nICAgfQoKICAgICAgICAvLyBvcmRlciBpcyBpbXBvcnRhbnQgaW4gdGhpcyBt\nZXRob2Q7IHN0YXJ0IHdpdGggZm9yZWlnbiBrZXlzCiAgICAgICAgVGFibGVb\nXSB0YWJzOwogICAgICAgIFRhYmxlIHJlcG9zVGFibGU7CiAgICAgICAgaWYg\nKF9ma3MpIHsKICAgICAgICAgICAgRm9yZWlnbktleVtdIGZrczsKICAgICAg\nICAgICAgRm9yZWlnbktleSBmazsKICAgICAgICAgICAgZm9yIChpbnQgaSA9\nIDA7IGkgPCBzY2hlbWFzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAg\nICB0YWJzID0gc2NoZW1hc1tpXS5nZXRUYWJsZXMoKTsKICAgICAgICAgICAg\nICAgIGZvciAoaW50IGogPSAwOyBqIDwgdGFicy5sZW5ndGg7IGorKykgewog\nICAgICAgICAgICAgICAgICAgIGlmICghaXNEcm9wcGFibGUodGFic1tqXSkp\nCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAg\nICAgICAgICAgIGZrcyA9IHRhYnNbal0uZ2V0Rm9yZWlnbktleXMoKTsKICAg\nICAgICAgICAgICAgICAgICByZXBvc1RhYmxlID0gcmVwb3MuZmluZFRhYmxl\nKHRhYnNbal0pOwogICAgICAgICAgICAgICAgICAgIGlmICghdGFibGVzICYm\nIHJlcG9zVGFibGUgPT0gbnVsbCkKICAgICAgICAgICAgICAgICAgICAgICAg\nY29udGludWU7CgogICAgICAgICAgICAgICAgICAgIGZvciAoaW50IGsgPSAw\nOyBrIDwgZmtzLmxlbmd0aDsgaysrKSB7CiAgICAgICAgICAgICAgICAgICAg\nICAgIGlmIChma3Nba10uaXNMb2dpY2FsKCkpCiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICBjb250aW51ZTsKCiAgICAgICAgICAgICAgICAgICAgICAg\nIGZrID0gbnVsbDsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlcG9z\nVGFibGUgIT0gbnVsbCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZr\nID0gZmluZEZvcmVpZ25LZXkocmVwb3NUYWJsZSwgZmtzW2tdKTsKICAgICAg\nICAgICAgICAgICAgICAgICAgaWYgKHJlcG9zVGFibGUgPT0gbnVsbCB8fCBm\nayA9PSBudWxsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB8fCAhZmtz\nW2tdLmVxdWFsc0ZvcmVpZ25LZXkoZmspKSB7CiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICBpZiAoZHJvcEZvcmVpZ25LZXkoZmtzW2tdKSkKICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICB0YWJzW2pdLnJlbW92ZUZvcmVp\nZ25LZXkoZmtzW2tdKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVs\nc2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfbG9nLndhcm4o\nX2xvYy5nZXQoImRyb3AtZmsiLCBma3Nba10sCiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgIHRhYnNbal0pKTsKICAgICAgICAgICAgICAg\nICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAg\nICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgLy8gcHJp\nbWFyeSBrZXlzCiAgICAgICAgaWYgKF9wa3MpIHsKICAgICAgICAgICAgUHJp\nbWFyeUtleSBwazsKICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBz\nY2hlbWFzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgICB0YWJzID0g\nc2NoZW1hc1tpXS5nZXRUYWJsZXMoKTsKICAgICAgICAgICAgICAgIGZvciAo\naW50IGogPSAwOyBqIDwgdGFicy5sZW5ndGg7IGorKykgewogICAgICAgICAg\nICAgICAgICAgIGlmICghaXNEcm9wcGFibGUodGFic1tqXSkpCiAgICAgICAg\nICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICAgICAgICAg\nIHBrID0gdGFic1tqXS5nZXRQcmltYXJ5S2V5KCk7CiAgICAgICAgICAgICAg\nICAgICAgaWYgKHBrICE9IG51bGwgJiYgcGsuaXNMb2dpY2FsKCkpCiAgICAg\nICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOwoKICAgICAgICAgICAgICAg\nICAgICByZXBvc1RhYmxlID0gcmVwb3MuZmluZFRhYmxlKHRhYnNbal0pOwog\nICAgICAgICAgICAgICAgICAgIGlmIChwayAhPSBudWxsICYmIHJlcG9zVGFi\nbGUgIT0gbnVsbAogICAgICAgICAgICAgICAgICAgICAgICAmJiAocmVwb3NU\nYWJsZS5nZXRQcmltYXJ5S2V5KCkgPT0gbnVsbAogICAgICAgICAgICAgICAg\nICAgICAgICB8fCAhcGsuZXF1YWxzUHJpbWFyeUtleShyZXBvc1RhYmxlLmdl\ndFByaW1hcnlLZXkoKSkpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlm\nIChkcm9wUHJpbWFyeUtleShwaykpCiAgICAgICAgICAgICAgICAgICAgICAg\nICAgICB0YWJzW2pdLnJlbW92ZVByaW1hcnlLZXkoKTsKICAgICAgICAgICAg\nICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgICAgICAgICAg\nX2xvZy53YXJuKF9sb2MuZ2V0KCJkcm9wLXBrIiwgcGssIHRhYnNbal0pKTsK\nICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAg\nICAgICAgIH0KICAgICAgICB9CgogICAgICAgIC8vIGNvbHVtbnMKICAgICAg\nICBDb2x1bW5bXSBjb2xzOwogICAgICAgIENvbHVtbiBjb2w7CiAgICAgICAg\nQ29sbGVjdGlvbjxUYWJsZT4gZHJvcHMgPSBuZXcgTGlua2VkTGlzdDxUYWJs\nZT4oKTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IHNjaGVtYXMubGVu\nZ3RoOyBpKyspIHsKICAgICAgICAgICAgdGFicyA9IHNjaGVtYXNbaV0uZ2V0\nVGFibGVzKCk7CiAgICAgICAgICAgIGZvciAoaW50IGogPSAwOyBqIDwgdGFi\ncy5sZW5ndGg7IGorKykgewogICAgICAgICAgICAgICAgaWYgKCFpc0Ryb3Bw\nYWJsZSh0YWJzW2pdKSkKICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsK\nICAgICAgICAgICAgICAgIGNvbHMgPSB0YWJzW2pdLmdldENvbHVtbnMoKTsK\nICAgICAgICAgICAgICAgIHJlcG9zVGFibGUgPSByZXBvcy5maW5kVGFibGUo\ndGFic1tqXSk7CiAgICAgICAgICAgICAgICBpZiAocmVwb3NUYWJsZSAhPSBu\ndWxsKSB7CiAgICAgICAgICAgICAgICAgICAgZm9yIChpbnQgayA9IDA7IGsg\nPCBjb2xzLmxlbmd0aDsgaysrKSB7CiAgICAgICAgICAgICAgICAgICAgICAg\nIGNvbCA9IHJlcG9zVGFibGUuZ2V0Q29sdW1uKGNvbHNba10uZ2V0SWRlbnRp\nZmllcigpKTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvbCA9PSBu\ndWxsIHx8ICFjb2xzW2tdLmVxdWFsc0NvbHVtbihjb2wpKSB7CiAgICAgICAg\nICAgICAgICAgICAgICAgICAgICBpZiAodGFic1tqXS5nZXRDb2x1bW5zKCku\nbGVuZ3RoID09IDEpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nZHJvcHMuYWRkKHRhYnNbal0pOwogICAgICAgICAgICAgICAgICAgICAgICAg\nICAgZWxzZSBpZiAoZHJvcENvbHVtbihjb2xzW2tdKSkKICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICB0YWJzW2pdLnJlbW92ZUNvbHVtbihjb2xz\nW2tdKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICBfbG9nLndhcm4oX2xvYy5nZXQo\nImRyb3AtY29sIiwgY29sc1trXSwKICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgdGFic1tqXSkpOwogICAgICAgICAgICAgICAgICAgICAg\nICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQog\nICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAvLyBub3cgdGFibGVz\nCiAgICAgICAgaWYgKHRhYmxlcykgewogICAgICAgICAgICBmb3IgKGludCBp\nID0gMDsgaSA8IHNjaGVtYXMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAg\nICAgIHRhYnMgPSBzY2hlbWFzW2ldLmdldFRhYmxlcygpOwogICAgICAgICAg\nICAgICAgZm9yIChpbnQgaiA9IDA7IGogPCB0YWJzLmxlbmd0aDsgaisrKQog\nICAgICAgICAgICAgICAgICAgIGlmICghIWlzRHJvcHBhYmxlKHRhYnNbal0p\nCiAgICAgICAgICAgICAgICAgICAgICAgICYmIHJlcG9zLmZpbmRUYWJsZSh0\nYWJzW2pdKSA9PSBudWxsKQogICAgICAgICAgICAgICAgICAgICAgICBkcm9w\ncy5hZGQodGFic1tqXSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAg\nICAgZHJvcFRhYmxlcyhkcm9wcywgZGIpOwogICAgfQoKICAgIC8qKgogICAg\nICogRHJvcHMgYWxsIGRhdGFiYXNlIGNvbXBvbmVudHMgaW4gdGhlIGdpdmVu\nIHJlcG9zaXRvcnkgc2NoZW1hLgogICAgICovCiAgICBwcml2YXRlIHZvaWQg\nZHJvcChTY2hlbWFHcm91cCBkYiwgU2NoZW1hR3JvdXAgcmVwb3MpCiAgICAg\nICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgLy8gZHJvcCBzZXF1\nZW5jZXMKICAgICAgICBTY2hlbWFbXSBzY2hlbWFzID0gcmVwb3MuZ2V0U2No\nZW1hcygpOwogICAgICAgIGlmIChfc2VxcykgewogICAgICAgICAgICBTZXF1\nZW5jZVtdIHNlcXM7CiAgICAgICAgICAgIFNlcXVlbmNlIGRiU2VxOwogICAg\nICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IHNjaGVtYXMubGVuZ3RoOyBp\nKyspIHsKICAgICAgICAgICAgICAgIHNlcXMgPSBzY2hlbWFzW2ldLmdldFNl\ncXVlbmNlcygpOwogICAgICAgICAgICAgICAgZm9yIChpbnQgaiA9IDA7IGog\nPCBzZXFzLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICAgICAgICAgICAgaWYg\nKCFpc0Ryb3BwYWJsZShzZXFzW2pdKSkKICAgICAgICAgICAgICAgICAgICAg\nICAgY29udGludWU7CiAgICAgICAgICAgICAgICAgICAgZGJTZXEgPSBkYi5m\naW5kU2VxdWVuY2Uoc2Vxc1tqXSk7CiAgICAgICAgICAgICAgICAgICAgaWYg\nKGRiU2VxICE9IG51bGwpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYg\nKGRyb3BTZXF1ZW5jZShzZXFzW2pdKSkKICAgICAgICAgICAgICAgICAgICAg\nICAgICAgIGRiU2VxLmdldFNjaGVtYSgpLnJlbW92ZVNlcXVlbmNlKGRiU2Vx\nKTsKICAgICAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAg\nICAgICAgICAgICAgICAgX2xvZy53YXJuKF9sb2MuZ2V0KCJkcm9wLXNlcSIs\nIHNlcXNbal0pKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAg\nICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIC8vIGNh\nbGN1bGF0ZSB0YWJsZXMgdG8gZHJvcDsgd2UgY2FuIG9ubHkgZHJvcCB0YWJs\nZXMgaWYgd2UncmUgc3VyZQogICAgICAgIC8vIHRoZSB1c2VyIGxpc3RlZCB0\naGUgZW50aXJlIHRhYmxlIGRlZmluaXRpb24gaW4gdGhlIHN0dWZmIHRoZXkg\nd2FudAogICAgICAgIC8vIGRyb3BwZWQ7IGVsc2UgdGhleSBtaWdodCBqdXN0\nIHdhbnQgdG8gZHJvcCBhIGZldyBjb2x1bW5zCiAgICAgICAgQ29sbGVjdGlv\nbjxUYWJsZT4gZHJvcHMgPSBuZXcgTGlua2VkTGlzdDxUYWJsZT4oKTsKICAg\nICAgICBUYWJsZVtdIHRhYnM7CiAgICAgICAgVGFibGUgZGJUYWJsZTsKICAg\nICAgICBDb2x1bW5bXSBkYkNvbHM7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7\nIGkgPCBzY2hlbWFzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIHRhYnMg\nPSBzY2hlbWFzW2ldLmdldFRhYmxlcygpOwogICAgICAgICAgICB0YWJsZXM6\nCiAgICAgICAgICAgIGZvciAoaW50IGogPSAwOyBqIDwgdGFicy5sZW5ndGg7\nIGorKykgewogICAgICAgICAgICAgICAgaWYgKCFpc0Ryb3BwYWJsZSh0YWJz\nW2pdKSkKICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAg\nICAgICAgIGRiVGFibGUgPSBkYi5maW5kVGFibGUodGFic1tqXSk7CiAgICAg\nICAgICAgICAgICBpZiAoZGJUYWJsZSA9PSBudWxsKQogICAgICAgICAgICAg\nICAgICAgIGNvbnRpbnVlOwoKICAgICAgICAgICAgICAgIGRiQ29scyA9IGRi\nVGFibGUuZ2V0Q29sdW1ucygpOwogICAgICAgICAgICAgICAgZm9yIChpbnQg\nayA9IDA7IGsgPCBkYkNvbHMubGVuZ3RoOyBrKyspCiAgICAgICAgICAgICAg\nICAgICAgaWYgKHRhYnNbal0uZ2V0Q29sdW1uKGRiQ29sc1trXS5nZXRJZGVu\ndGlmaWVyKCkpID09IG51bGwpCiAgICAgICAgICAgICAgICAgICAgICAgIGNv\nbnRpbnVlIHRhYmxlczsKCiAgICAgICAgICAgICAgICBkcm9wcy5hZGQodGFi\nc1tqXSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIC8vIG9y\nZGVyIGlzIGltcG9ydGFudCBpbiB0aGlzIG1ldGhvZDsgc3RhcnQgd2l0aCBm\nb3JlaWduIGtleXMgbWVudGlvbmVkCiAgICAgICAgLy8gaW4gdGhlIGRyb3Ag\nc2NoZW1hCiAgICAgICAgaWYgKF9ma3MpIHsKICAgICAgICAgICAgRm9yZWln\nbktleVtdIGZrczsKICAgICAgICAgICAgRm9yZWlnbktleSBmazsKICAgICAg\nICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBzY2hlbWFzLmxlbmd0aDsgaSsr\nKSB7CiAgICAgICAgICAgICAgICB0YWJzID0gc2NoZW1hc1tpXS5nZXRUYWJs\nZXMoKTsKICAgICAgICAgICAgICAgIGZvciAoaW50IGogPSAwOyBqIDwgdGFi\ncy5sZW5ndGg7IGorKykgewogICAgICAgICAgICAgICAgICAgIGlmICghaXNE\ncm9wcGFibGUodGFic1tqXSkpCiAgICAgICAgICAgICAgICAgICAgICAgIGNv\nbnRpbnVlOwogICAgICAgICAgICAgICAgICAgIGZrcyA9IHRhYnNbal0uZ2V0\nRm9yZWlnbktleXMoKTsKICAgICAgICAgICAgICAgICAgICBkYlRhYmxlID0g\nZGIuZmluZFRhYmxlKHRhYnNbal0pOwogICAgICAgICAgICAgICAgICAgIGZv\nciAoaW50IGsgPSAwOyBrIDwgZmtzLmxlbmd0aDsgaysrKSB7CiAgICAgICAg\nICAgICAgICAgICAgICAgIGlmIChma3Nba10uaXNMb2dpY2FsKCkpCiAgICAg\nICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsKCiAgICAgICAgICAg\nICAgICAgICAgICAgIGZrID0gbnVsbDsKICAgICAgICAgICAgICAgICAgICAg\nICAgaWYgKGRiVGFibGUgIT0gbnVsbCkKICAgICAgICAgICAgICAgICAgICAg\nICAgICAgIGZrID0gZmluZEZvcmVpZ25LZXkoZGJUYWJsZSwgZmtzW2tdKTsK\nICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRiVGFibGUgPT0gbnVsbCB8\nfCBmayA9PSBudWxsKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29u\ndGludWU7CgogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZHJvcEZvcmVp\nZ25LZXkoZmtzW2tdKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlm\nIChkYlRhYmxlICE9IG51bGwpCiAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgZGJUYWJsZS5yZW1vdmVGb3JlaWduS2V5KGZrKTsKICAgICAgICAg\nICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICBfbG9nLndhcm4oX2xvYy5nZXQoImRyb3AtZmsiLCBma3Nb\na10sIHRhYnNbal0pKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAg\nICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIGFsc28g\nZHJvcCBpbXBvcnRlZCBmb3JlaWduIGtleXMgZm9yIHRhYmxlcyB0aGF0IHdp\nbGwgYmUgZHJvcHBlZAogICAgICAgICAgICBUYWJsZSB0YWI7CiAgICAgICAg\nICAgIGZvciAoSXRlcmF0b3I8VGFibGU+IGl0ciA9IGRyb3BzLml0ZXJhdG9y\nKCk7IGl0ci5oYXNOZXh0KCk7KSB7CiAgICAgICAgICAgICAgICB0YWIgPSBp\ndHIubmV4dCgpOwogICAgICAgICAgICAgICAgZGJUYWJsZSA9IGRiLmZpbmRU\nYWJsZSh0YWIpOwogICAgICAgICAgICAgICAgaWYgKGRiVGFibGUgPT0gbnVs\nbCkKICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsKCiAgICAgICAgICAg\nICAgICBma3MgPSBkYi5maW5kRXhwb3J0ZWRGb3JlaWduS2V5cyhkYlRhYmxl\nLmdldFByaW1hcnlLZXkoKSk7CiAgICAgICAgICAgICAgICBmb3IgKGludCBp\nID0gMDsgaSA8IGZrcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAg\nICAgIGlmIChkcm9wRm9yZWlnbktleShma3NbaV0pKQogICAgICAgICAgICAg\nICAgICAgICAgICBkYlRhYmxlLnJlbW92ZUZvcmVpZ25LZXkoZmtzW2ldKTsK\nICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAg\nICAgIF9sb2cud2FybihfbG9jLmdldCgiZHJvcC1mayIsIGZrc1tpXSwgZGJU\nYWJsZSkpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAg\nICAgfQoKICAgICAgICAvLyBkcm9wIHRoZSB0YWJsZXMgd2UgY2FsY3VsYXRl\nZCBhYm92ZQogICAgICAgIGRyb3BUYWJsZXMoZHJvcHMsIGRiKTsKCiAgICAg\nICAgLy8gY29sdW1ucwogICAgICAgIENvbHVtbltdIGNvbHM7CiAgICAgICAg\nQ29sdW1uIGNvbDsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IHNjaGVt\nYXMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgdGFicyA9IHNjaGVtYXNb\naV0uZ2V0VGFibGVzKCk7CiAgICAgICAgICAgIGZvciAoaW50IGogPSAwOyBq\nIDwgdGFicy5sZW5ndGg7IGorKykgewogICAgICAgICAgICAgICAgaWYgKCFp\nc0Ryb3BwYWJsZSh0YWJzW2pdKSkKICAgICAgICAgICAgICAgICAgICBjb250\naW51ZTsKICAgICAgICAgICAgICAgIGNvbHMgPSB0YWJzW2pdLmdldENvbHVt\nbnMoKTsKICAgICAgICAgICAgICAgIGRiVGFibGUgPSBkYi5maW5kVGFibGUo\ndGFic1tqXSk7CiAgICAgICAgICAgICAgICBmb3IgKGludCBrID0gMDsgayA8\nIGNvbHMubGVuZ3RoOyBrKyspIHsKICAgICAgICAgICAgICAgICAgICBjb2wg\nPSBudWxsOwogICAgICAgICAgICAgICAgICAgIGlmIChkYlRhYmxlICE9IG51\nbGwpCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbCA9IGRiVGFibGUuZ2V0\nQ29sdW1uKGNvbHNba10uZ2V0SWRlbnRpZmllcigpKTsKICAgICAgICAgICAg\nICAgICAgICBpZiAoZGJUYWJsZSA9PSBudWxsIHx8IGNvbCA9PSBudWxsKQog\nICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsKCiAgICAgICAgICAg\nICAgICAgICAgaWYgKGRyb3BDb2x1bW4oY29sc1trXSkpIHsKICAgICAgICAg\nICAgICAgICAgICAgICAgaWYgKGRiVGFibGUgIT0gbnVsbCkKICAgICAgICAg\nICAgICAgICAgICAgICAgICAgIGRiVGFibGUucmVtb3ZlQ29sdW1uKGNvbCk7\nCiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAg\nICAgICAgICAgICAgIF9sb2cud2FybihfbG9jLmdldCgiZHJvcC1jb2wiLCBj\nb2xzW2tdLCB0YWJzW2pdKSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAg\nICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQoK\nICAgIC8qKgogICAgICogUmV0dXJuIHRydWUgaWYgdGhlIHRhYmxlIGlzIGRy\nb3BwYWJsZS4KICAgICAqLwogICAgcHJpdmF0ZSBib29sZWFuIGlzRHJvcHBh\nYmxlKFRhYmxlIHRhYmxlKSB7CiAgICAgICAgcmV0dXJuIF9vcGVuanBhVGFi\nbGVzCiAgICAgICAgICAgIHx8ICghREJJZGVudGlmaWVyLnRvVXBwZXIodGFi\nbGUuZ2V0SWRlbnRpZmllcigpKS5nZXROYW1lKCkuc3RhcnRzV2l0aCgiT1BF\nTkpQQV8iKQogICAgICAgICAgICAmJiAhREJJZGVudGlmaWVyLnRvVXBwZXIo\ndGFibGUuZ2V0SWRlbnRpZmllcigpKS5nZXROYW1lKCkuc3RhcnRzV2l0aCgi\nSkRPXyIpKTsgLy8gbGVnYWN5CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1\ncm4gdHJ1ZSBpZiB0aGUgc2VxdWVuY2UgaXMgZHJvcHBhYmxlLgogICAgICov\nCiAgICBwcml2YXRlIGJvb2xlYW4gaXNEcm9wcGFibGUoU2VxdWVuY2Ugc2Vx\nKSB7CiAgICAgICAgcmV0dXJuIF9vcGVuanBhVGFibGVzCiAgICAgICAgICAg\nIHx8ICghREJJZGVudGlmaWVyLnRvVXBwZXIoc2VxLmdldElkZW50aWZpZXIo\nKSkuZ2V0TmFtZSgpLnN0YXJ0c1dpdGgoIk9QRU5KUEFfIikKICAgICAgICAg\nICAgJiYgIURCSWRlbnRpZmllci50b1VwcGVyKHNlcS5nZXRJZGVudGlmaWVy\nKCkpLmdldE5hbWUoKS5zdGFydHNXaXRoKCJKRE9fIikpOyAvLyBsZWdhY3kK\nICAgIH0KCiAgICAvKioKICAgICAqIEZpbmQgYW4gaW5kZXggaW4gdGhlIGdp\ndmVuIHRhYmxlIHRoYXQgbWF0Y2hlcyB0aGUgZ2l2ZW4gb25lLgogICAgICov\nCiAgICBwcml2YXRlIEluZGV4IGZpbmRJbmRleChUYWJsZSBkYlRhYmxlLCBJ\nbmRleCBpZHgpIHsKICAgICAgICBJbmRleFtdIGlkeHMgPSBkYlRhYmxlLmdl\ndEluZGV4ZXMoKTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGlkeHMu\nbGVuZ3RoOyBpKyspCiAgICAgICAgICAgIGlmIChpZHguY29sdW1uc01hdGNo\nKGlkeHNbaV0uZ2V0Q29sdW1ucygpKSkKICAgICAgICAgICAgICAgIHJldHVy\nbiBpZHhzW2ldOwogICAgICAgIHJldHVybiBudWxsOwogICAgfQoKICAgIC8q\nKgogICAgICogRmluZCBhIGZvcmVpZ24ga2V5IGluIHRoZSBnaXZlbiB0YWJs\nZSB0aGF0IG1hdGNoZXMgdGhlIGdpdmVuIG9uZS4KICAgICAqLwogICAgcHJp\ndmF0ZSBGb3JlaWduS2V5IGZpbmRGb3JlaWduS2V5KFRhYmxlIGRiVGFibGUs\nIEZvcmVpZ25LZXkgZmspIHsKICAgICAgICBpZiAoZmsuZ2V0Q29uc3RhbnRD\nb2x1bW5zKCkubGVuZ3RoID4gMAogICAgICAgICAgICB8fCBmay5nZXRDb25z\ndGFudFByaW1hcnlLZXlDb2x1bW5zKCkubGVuZ3RoID4gMCkKICAgICAgICAg\nICAgcmV0dXJuIG51bGw7CiAgICAgICAgRm9yZWlnbktleVtdIGZrcyA9IGRi\nVGFibGUuZ2V0Rm9yZWlnbktleXMoKTsKICAgICAgICBmb3IgKGludCBpID0g\nMDsgaSA8IGZrcy5sZW5ndGg7IGkrKykKICAgICAgICAgICAgaWYgKGZrLmNv\nbHVtbnNNYXRjaChma3NbaV0uZ2V0Q29sdW1ucygpLAogICAgICAgICAgICAg\nICAgZmtzW2ldLmdldFByaW1hcnlLZXlDb2x1bW5zKCkpKQogICAgICAgICAg\nICAgICAgcmV0dXJuIGZrc1tpXTsKICAgICAgICByZXR1cm4gbnVsbDsKICAg\nIH0KCiAgICAvKioKICAgICAqIFJlbW92ZSB0aGUgZ2l2ZW4gY29sbGVjdGlv\nbiBvZiB0YWJsZXMgZnJvbSB0aGUgZGF0YWJhc2Ugc2NoZW1hLiBPcmRlcnMK\nICAgICAqIHRoZSByZW1vdmFscyBhY2NvcmRpbmcgdG8gZm9yZWlnbiBrZXkg\nY29uc3RyYWludHMgb24gdGhlIHRhYmxlcy4KICAgICAqLwogICAgcHJpdmF0\nZSB2b2lkIGRyb3BUYWJsZXMoQ29sbGVjdGlvbjxUYWJsZT4gdGFibGVzLCBT\nY2hlbWFHcm91cCBjaGFuZ2UpCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlv\nbiB7CiAgICAgICAgaWYgKHRhYmxlcy5pc0VtcHR5KCkpCiAgICAgICAgICAg\nIHJldHVybjsKCiAgICAgICAgVGFibGUgdGFibGU7CiAgICAgICAgVGFibGUg\nY2hhbmdlVGFibGU7CiAgICAgICAgZm9yIChJdGVyYXRvcjxUYWJsZT4gaXRy\nID0gdGFibGVzLml0ZXJhdG9yKCk7IGl0ci5oYXNOZXh0KCk7KSB7CiAgICAg\nICAgICAgIHRhYmxlID0gaXRyLm5leHQoKTsKICAgICAgICAgICAgaWYgKGRy\nb3BUYWJsZSh0YWJsZSkpIHsKICAgICAgICAgICAgICAgIGNoYW5nZVRhYmxl\nID0gY2hhbmdlLmZpbmRUYWJsZSh0YWJsZSk7CiAgICAgICAgICAgICAgICBp\nZiAoY2hhbmdlVGFibGUgIT0gbnVsbCkKICAgICAgICAgICAgICAgICAgICBj\naGFuZ2VUYWJsZS5nZXRTY2hlbWEoKS5yZW1vdmVUYWJsZShjaGFuZ2VUYWJs\nZSk7CiAgICAgICAgICAgIH0gZWxzZQogICAgICAgICAgICAgICAgX2xvZy53\nYXJuKF9sb2MuZ2V0KCJkcm9wLXRhYmxlIiwgdGFibGUpKTsKICAgICAgICB9\nCiAgICB9CgogICAgLyoqCiAgICAgKiBBZGQgdGhlIGdpdmVuIHRhYmxlIHRv\nIHRoZSBkYXRhYmFzZSBzY2hlbWEuCiAgICAgKgogICAgICogQHJldHVybiB0\ncnVlIGlmIHRoZSBvcGVyYXRpb24gd2FzIHN1Y2Nlc3NmdWwsIGZhbHNlIG90\naGVyd2lzZQogICAgICovCiAgICBwdWJsaWMgYm9vbGVhbiBjcmVhdGVUYWJs\nZShUYWJsZSB0YWJsZSkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsK\nICAgICAgICByZXR1cm4gZXhlY3V0ZVNRTChfZGljdC5nZXRDcmVhdGVUYWJs\nZVNRTCh0YWJsZSkpOwogICAgfQoKICAgIC8qKgogICAgICogRHJvcCB0aGUg\nZ2l2ZW4gdGFibGUgZnJvbSB0aGUgZGF0YWJhc2Ugc2NoZW1hLgogICAgICoK\nICAgICAqIEByZXR1cm4gdHJ1ZSBpZiB0aGUgb3BlcmF0aW9uIHdhcyBzdWNj\nZXNzZnVsLCBmYWxzZSBvdGhlcndpc2UKICAgICAqLwogICAgcHVibGljIGJv\nb2xlYW4gZHJvcFRhYmxlKFRhYmxlIHRhYmxlKQogICAgICAgIHRocm93cyBT\nUUxFeGNlcHRpb24gewogICAgICAgIHJldHVybiBleGVjdXRlU1FMKF9kaWN0\nLmdldERyb3BUYWJsZVNRTCh0YWJsZSkpOwogICAgfQoKICAgIC8qKgogICAg\nICogQWRkIHRoZSBnaXZlbiBzZXF1ZW5jZSB0byB0aGUgZGF0YWJhc2Ugc2No\nZW1hLgogICAgICoKICAgICAqIEByZXR1cm4gdHJ1ZSBpZiB0aGUgb3BlcmF0\naW9uIHdhcyBzdWNjZXNzZnVsLCBmYWxzZSBvdGhlcndpc2UKICAgICAqLwog\nICAgcHVibGljIGJvb2xlYW4gY3JlYXRlU2VxdWVuY2UoU2VxdWVuY2Ugc2Vx\nKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIHJldHVy\nbiBleGVjdXRlU1FMKF9kaWN0LmdldENyZWF0ZVNlcXVlbmNlU1FMKHNlcSkp\nOwogICAgfQoKICAgIC8qKgogICAgICogRHJvcCB0aGUgZ2l2ZW4gc2VxdWVu\nY2UgZnJvbSB0aGUgZGF0YWJhc2Ugc2NoZW1hLgogICAgICoKICAgICAqIEBy\nZXR1cm4gdHJ1ZSBpZiB0aGUgb3BlcmF0aW9uIHdhcyBzdWNjZXNzZnVsLCBm\nYWxzZSBvdGhlcndpc2UKICAgICAqLwogICAgcHVibGljIGJvb2xlYW4gZHJv\ncFNlcXVlbmNlKFNlcXVlbmNlIHNlcSkKICAgICAgICB0aHJvd3MgU1FMRXhj\nZXB0aW9uIHsKICAgICAgICByZXR1cm4gZXhlY3V0ZVNRTChfZGljdC5nZXRE\ncm9wU2VxdWVuY2VTUUwoc2VxKSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBB\nZGQgdGhlIGdpdmVuIGluZGV4IHRvIHRoZSBkYXRhYmFzZSBzY2hlbWEuCiAg\nICAgKgogICAgICogQHJldHVybiB0cnVlIGlmIHRoZSBvcGVyYXRpb24gd2Fz\nIHN1Y2Nlc3NmdWwsIGZhbHNlIG90aGVyd2lzZQogICAgICovCiAgICBwdWJs\naWMgYm9vbGVhbiBjcmVhdGVJbmRleChJbmRleCBpZHgsIFRhYmxlIHRhYmxl\nKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIC8vIElu\nZm9ybWl4IHdpbGwgYXV0b21hdGljYWxseSBjcmVhdGUgYSB1bmlxdWUgaW5k\nZXggZm9yIHRoZSAKICAgICAgICAvLyBwcmltYXJ5IGtleSwgc28gZG9uJ3Qg\nY3JlYXRlIGFub3RoZXIgaW5kZXggYWdhaW4KCiAgICAgICAgaWYgKCFfZGlj\ndC5uZWVkc1RvQ3JlYXRlSW5kZXgoaWR4LHRhYmxlKSkKICAgICAgICAgICAg\ncmV0dXJuIGZhbHNlOwoKICAgICAgICBpbnQgbWF4ID0gX2RpY3QubWF4SW5k\nZXhlc1BlclRhYmxlOwoKICAgICAgICBpbnQgbGVuID0gdGFibGUuZ2V0SW5k\nZXhlcygpLmxlbmd0aDsKICAgICAgICBpZiAodGFibGUuZ2V0UHJpbWFyeUtl\neSgpICE9IG51bGwpCiAgICAgICAgICAgIGxlbiArPSB0YWJsZS5nZXRQcmlt\nYXJ5S2V5KCkuZ2V0Q29sdW1ucygpLmxlbmd0aDsKCiAgICAgICAgaWYgKGxl\nbiA+PSBtYXgpIHsKICAgICAgICAgICAgX2xvZy53YXJuKF9sb2MuZ2V0KCJ0\nb28tbWFueS1pbmRleGVzIiwgaWR4LCB0YWJsZSwgbWF4ICsgIiIpKTsKICAg\nICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KCiAgICAgICAgcmV0\ndXJuIGV4ZWN1dGVTUUwoX2RpY3QuZ2V0Q3JlYXRlSW5kZXhTUUwoaWR4KSk7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBEcm9wIHRoZSBnaXZlbiBpbmRleCBm\ncm9tIHRoZSBkYXRhYmFzZSBzY2hlbWEuCiAgICAgKgogICAgICogQHJldHVy\nbiB0cnVlIGlmIHRoZSBvcGVyYXRpb24gd2FzIHN1Y2Nlc3NmdWwsIGZhbHNl\nIG90aGVyd2lzZQogICAgICovCiAgICBwdWJsaWMgYm9vbGVhbiBkcm9wSW5k\nZXgoSW5kZXggaWR4KQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewog\nICAgICAgIHJldHVybiBleGVjdXRlU1FMKF9kaWN0LmdldERyb3BJbmRleFNR\nTChpZHgpKTsKICAgIH0KCiAgICAvKioKICAgICAqIEFkZCB0aGUgZ2l2ZW4g\nY29sdW1uIHRvIHRoZSBkYXRhYmFzZSBzY2hlbWEuCiAgICAgKgogICAgICog\nQHJldHVybiB0cnVlIGlmIHRoZSBvcGVyYXRpb24gd2FzIHN1Y2Nlc3NmdWws\nIGZhbHNlIG90aGVyd2lzZQogICAgICovCiAgICBwdWJsaWMgYm9vbGVhbiBh\nZGRDb2x1bW4oQ29sdW1uIGNvbCkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0\naW9uIHsKICAgICAgICByZXR1cm4gZXhlY3V0ZVNRTChfZGljdC5nZXRBZGRD\nb2x1bW5TUUwoY29sKSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBEcm9wIHRo\nZSBnaXZlbiBjb2x1bW4gZnJvbSB0aGUgZGF0YWJhc2Ugc2NoZW1hLgogICAg\nICoKICAgICAqIEByZXR1cm4gdHJ1ZSBpZiB0aGUgb3BlcmF0aW9uIHdhcyBz\ndWNjZXNzZnVsLCBmYWxzZSBvdGhlcndpc2UKICAgICAqLwogICAgcHVibGlj\nIGJvb2xlYW4gZHJvcENvbHVtbihDb2x1bW4gY29sKQogICAgICAgIHRocm93\ncyBTUUxFeGNlcHRpb24gewogICAgICAgIHJldHVybiBleGVjdXRlU1FMKF9k\naWN0LmdldERyb3BDb2x1bW5TUUwoY29sKSk7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBBZGQgdGhlIGdpdmVuIHByaW1hcnkga2V5IHRvIHRoZSBkYXRhYmFz\nZSBzY2hlbWEuCiAgICAgKgogICAgICogQHJldHVybiB0cnVlIGlmIHRoZSBv\ncGVyYXRpb24gd2FzIHN1Y2Nlc3NmdWwsIGZhbHNlIG90aGVyd2lzZQogICAg\nICovCiAgICBwdWJsaWMgYm9vbGVhbiBhZGRQcmltYXJ5S2V5KFByaW1hcnlL\nZXkgcGspCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAg\ncmV0dXJuIGV4ZWN1dGVTUUwoX2RpY3QuZ2V0QWRkUHJpbWFyeUtleVNRTChw\naykpOwogICAgfQoKICAgIC8qKgogICAgICogRHJvcCB0aGUgZ2l2ZW4gcHJp\nbWFyeSBrZXkgZnJvbSB0aGUgZGF0YWJhc2Ugc2NoZW1hLgogICAgICoKICAg\nICAqIEByZXR1cm4gdHJ1ZSBpZiB0aGUgb3BlcmF0aW9uIHdhcyBzdWNjZXNz\nZnVsLCBmYWxzZSBvdGhlcndpc2UKICAgICAqLwogICAgcHVibGljIGJvb2xl\nYW4gZHJvcFByaW1hcnlLZXkoUHJpbWFyeUtleSBwaykKICAgICAgICB0aHJv\nd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICByZXR1cm4gZXhlY3V0ZVNRTChf\nZGljdC5nZXREcm9wUHJpbWFyeUtleVNRTChwaykpOwogICAgfQoKICAgIC8q\nKgogICAgICogQWRkIHRoZSBnaXZlbiBmb3JlaWduIGtleSB0byB0aGUgZGF0\nYWJhc2Ugc2NoZW1hLgogICAgICoKICAgICAqIEByZXR1cm4gdHJ1ZSBpZiB0\naGUgb3BlcmF0aW9uIHdhcyBzdWNjZXNzZnVsLCBmYWxzZSBvdGhlcndpc2UK\nICAgICAqLwogICAgcHVibGljIGJvb2xlYW4gYWRkRm9yZWlnbktleShGb3Jl\naWduS2V5IGZrKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAg\nICAgIHJldHVybiBleGVjdXRlU1FMKF9kaWN0LmdldEFkZEZvcmVpZ25LZXlT\nUUwoZmspKTsKICAgIH0KCiAgICAvKioKICAgICAqIERyb3AgdGhlIGdpdmVu\nIGZvcmVpZ24ga2V5IGZyb20gdGhlIGRhdGFiYXNlIHNjaGVtYS4KICAgICAq\nCiAgICAgKiBAcmV0dXJuIHRydWUgaWYgdGhlIG9wZXJhdGlvbiB3YXMgc3Vj\nY2Vzc2Z1bCwgZmFsc2Ugb3RoZXJ3aXNlCiAgICAgKi8KICAgIHB1YmxpYyBi\nb29sZWFuIGRyb3BGb3JlaWduS2V5KEZvcmVpZ25LZXkgZmspCiAgICAgICAg\ndGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgcmV0dXJuIGV4ZWN1dGVT\nUUwoX2RpY3QuZ2V0RHJvcEZvcmVpZ25LZXlTUUwoZmssX2RzLmdldENvbm5l\nY3Rpb24oKSkpOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRoZSBk\nYXRhYmFzZSBzY2hlbWEuCiAgICAgKi8KICAgIHB1YmxpYyBTY2hlbWFHcm91\ncCBnZXREQlNjaGVtYUdyb3VwKCkgewogICAgICAgIHRyeSB7CiAgICAgICAg\nICAgIHJldHVybiBnZXREQlNjaGVtYUdyb3VwKHRydWUpOwogICAgICAgIH0g\nY2F0Y2ggKFNRTEV4Y2VwdGlvbiBzZSkgewogICAgICAgICAgICB0aHJvdyBT\nUUxFeGNlcHRpb25zLmdldFN0b3JlKHNlLCBfZGljdCk7CiAgICAgICAgfQog\nICAgfQoKICAgIC8qKgogICAgICogU2V0IHRoZSBkYXRhYmFzZSBzY2hlbWEu\nCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldERCU2NoZW1hR3JvdXAoU2No\nZW1hR3JvdXAgZGIpIHsKICAgICAgICBfZGIgPSBkYjsKICAgICAgICBpZiAo\nZGIgIT0gbnVsbCkKICAgICAgICAgICAgX2Z1bGxEQiA9IHRydWU7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIGRhdGFiYXNlIHNjaGVtYS4K\nICAgICAqCiAgICAgKiBAcGFyYW0gZnVsbCBpZiBmYWxzZSwgb25seSB0aGUg\ndGFibGVzIG5hbWVkIGluIHRoZSBzZXQgc2NoZW1hCiAgICAgKiByZXBvc2l0\nb3J5IHdpbGwgYmUgZ2VuZXJhdGVkCiAgICAgKi8KICAgIHByaXZhdGUgU2No\nZW1hR3JvdXAgZ2V0REJTY2hlbWFHcm91cChib29sZWFuIGZ1bGwpCiAgICAg\nICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgaWYgKF9kYiA9PSBu\ndWxsIHx8IChmdWxsICYmICFfZnVsbERCKSkgewogICAgICAgICAgICBTY2hl\nbWFHZW5lcmF0b3IgZ2VuID0gbmV3IFNjaGVtYUdlbmVyYXRvcihfY29uZik7\nCiAgICAgICAgICAgIGdlbi5zZXRQcmltYXJ5S2V5cyhfcGtzKTsKICAgICAg\nICAgICAgZ2VuLnNldEZvcmVpZ25LZXlzKF9ma3MpOwogICAgICAgICAgICBn\nZW4uc2V0SW5kZXhlcyhfaW5kZXhlcyk7CiAgICAgICAgICAgIGlmIChmdWxs\nKQogICAgICAgICAgICAgICAgZ2VuLmdlbmVyYXRlU2NoZW1hcygpOwogICAg\nICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgIC8vIGdlbmVyYXRlIG9u\nbHkgdGhlIHRhYmxlcyBpbiB0aGUgZ2l2ZW4gcmVwb3NpdG9yeQogICAgICAg\nICAgICAgICAgLy8gZ3JvdXA7IHNvbWUgbWF5IG5vdCBleGlzdCB5ZXQsIHdo\naWNoIGlzIE9LOyB3ZSBqdXN0IG5lZWQKICAgICAgICAgICAgICAgIC8vIHRv\nIG1ha2Ugc3VyZSB3ZSBjYW4gZGV0ZWN0IHRoZSBjaGFuZ2VzIHRvIHRoZSBv\nbmVzIHRoYXQKICAgICAgICAgICAgICAgIC8vIGRvIGV4aXN0CiAgICAgICAg\nICAgICAgICBDb2xsZWN0aW9uPERCSWRlbnRpZmllcj4gdGFibGVzID0gbmV3\nIExpbmtlZExpc3Q8REJJZGVudGlmaWVyPigpOwogICAgICAgICAgICAgICAg\nU2NoZW1hR3JvdXAgZ3JvdXAgPSBhc3NlcnRTY2hlbWFHcm91cCgpOwogICAg\nICAgICAgICAgICAgU2NoZW1hW10gc2NoZW1hcyA9IGdyb3VwLmdldFNjaGVt\nYXMoKTsKICAgICAgICAgICAgICAgIFRhYmxlW10gdGFiczsKICAgICAgICAg\nICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgc2NoZW1hcy5sZW5ndGg7IGkr\nKykgewogICAgICAgICAgICAgICAgICAgIHRhYnMgPSBzY2hlbWFzW2ldLmdl\ndFRhYmxlcygpOwogICAgICAgICAgICAgICAgICAgIGZvciAoaW50IGogPSAw\nOyBqIDwgdGFicy5sZW5ndGg7IGorKykgewogICAgICAgICAgICAgICAgICAg\nICAgICBpZiAoREJJZGVudGlmaWVyLmlzTnVsbCh0YWJzW2pdLmdldFNjaGVt\nYUlkZW50aWZpZXIoKSkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAg\nIHRhYmxlcy5hZGQodGFic1tqXS5nZXRJZGVudGlmaWVyKCkpOwogICAgICAg\nICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAg\nICAgICAgICAgREJJZGVudGlmaWVyIHNOYW1lID0gdGFic1tqXS5nZXRGdWxs\nSWRlbnRpZmllcigpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFi\nbGVzLmFkZChzTmFtZSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAg\nICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAg\nICAgICAgICBpZiAoIXRhYmxlcy5pc0VtcHR5KCkpCiAgICAgICAgICAgICAg\nICAgICAgZ2VuLmdlbmVyYXRlU2NoZW1hcygoREJJZGVudGlmaWVyW10pIHRh\nYmxlcy50b0FycmF5CiAgICAgICAgICAgICAgICAgICAgICAgIChuZXcgREJJ\nZGVudGlmaWVyW3RhYmxlcy5zaXplKCldKSk7CiAgICAgICAgICAgIH0KICAg\nICAgICAgICAgX2RiID0gZ2VuLmdldFNjaGVtYUdyb3VwKCk7CiAgICAgICAg\nfQogICAgICAgIHJldHVybiBfZGI7CiAgICB9CgogICAgcHJpdmF0ZSBTY2hl\nbWFHcm91cCBhc3NlcnRTY2hlbWFHcm91cCgpIHsKICAgICAgICBTY2hlbWFH\ncm91cCBsb2NhbCA9IGdldFNjaGVtYUdyb3VwKCk7CiAgICAgICAgaWYgKGxv\nY2FsID09IG51bGwpCiAgICAgICAgICAgIHRocm93IG5ldyBJbnZhbGlkU3Rh\ndGVFeGNlcHRpb24oX2xvYy5nZXQoInRvb2wtbm9yZXBvcyIpKTsKICAgICAg\nICByZXR1cm4gbG9jYWw7CiAgICB9CgogICAgLy8vLy8vLy8vLy8vLwogICAg\nLy8gVXRpbGl0aWVzCiAgICAvLy8vLy8vLy8vLy8vCgogICAgLyoqCiAgICAg\nKiBFeGVjdXRlcyB0aGUgZ2l2ZW4gYXJyYXkgb2Ygbm9uLXNlbGVjdGluZyBT\nUUwgc3RhdGVtZW50cywgY29ycmVjdGx5CiAgICAgKiBsb2dnaW5nIHRoZSBT\nUUwgY2FsbHMgYW5kIG9wdGlvbmFsbHkgaWdub3JpbmcgZXJyb3JzLgogICAg\nICoKICAgICAqIEByZXR1cm4gdHJ1ZSBpZiB0aGVyZSB3YXMgU1FMIHRvIGV4\nZWN1dGUgYW5kIHRoZSBjYWxscyB3ZXJlCiAgICAgKiBzdWNjZXNzZnVsLCBm\nYWxzZSBvdGhlcndpc2UKICAgICAqLwogICAgcHJpdmF0ZSBib29sZWFuIGV4\nZWN1dGVTUUwoU3RyaW5nW10gc3FsKQogICAgICAgIHRocm93cyBTUUxFeGNl\ncHRpb24gewogICAgICAgIC8vIGlmIG5vIHNxbCwgcHJvYmFibHkgYi9jIGRp\nY3Rpb25hcnkgZG9lc24ndCBzdXBwb3J0IG9wZXJhdGlvbgogICAgICAgIGlm\nIChzcWwubGVuZ3RoID09IDApCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsK\nCiAgICAgICAgYm9vbGVhbiBlcnIgPSBmYWxzZTsKICAgICAgICBpZiAoX3dy\naXRlciA9PSBudWxsKSB7CiAgICAgICAgICAgIC8vIHRoaXMgaXMgb3V0c2lk\nZSB0aGUgdHJ5LWNhdGNoIGJlY2F1c2UgYSBmYWlsdXJlIGhlcmUgaXMKICAg\nICAgICAgICAgLy8gcmVhbGx5IGJhZCwgYW5kIHNob3VsZCBub3QgYmUgaWdu\nb3JlZC4KICAgICAgICAgICAgQ29ubmVjdGlvbiBjb25uID0gX2RzLmdldENv\nbm5lY3Rpb24oKTsKICAgICAgICAgICAgU3RhdGVtZW50IHN0YXRlbWVudCA9\nIG51bGw7CiAgICAgICAgICAgIGJvb2xlYW4gd2FzQXV0byA9IHRydWU7CiAg\nICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICB3YXNBdXRvID0gY29u\nbi5nZXRBdXRvQ29tbWl0KCk7CiAgICAgICAgICAgICAgICBpZiAoIXdhc0F1\ndG8pCiAgICAgICAgICAgICAgICAgICAgY29ubi5zZXRBdXRvQ29tbWl0KHRy\ndWUpOwogICAgICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBzcWwu\nbGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICAgICAgICB0cnkgewogICAg\nICAgICAgICAgICAgICAgICAgICAvLyBzb21lIGNvbm5lY3Rpb25zIHJlcXVp\ncmUgdGhhdCByb2xsYmFjayBiZQogICAgICAgICAgICAgICAgICAgICAgICAv\nLyBjYWxsZWQgb24gdGhlIGNvbm5lY3Rpb24gYmVmb3JlIGFueSBEREwgc3Rh\ndGVtZW50cwogICAgICAgICAgICAgICAgICAgICAgICAvLyBjYW4gYmUgcnVu\nIG9uIGl0LCBldmVuIHdoZW4gYXV0b2NvbW1pdCBpcyBvbi4KICAgICAgICAg\nICAgICAgICAgICAgICAgLy8gVGhpcyBpcyBzb21ldGltZXMgYmVjYXVzZSB0\naGUgY29ubmVjdGlvbiBkb2VzIG5vdAogICAgICAgICAgICAgICAgICAgICAg\nICAvLyBhbGxvdyBEREwgc3RhdGVtZW50cyB3aGVuIHRoZXJlIGFyZSBtdWx0\naXBsZQogICAgICAgICAgICAgICAgICAgICAgICAvLyBjb21tYW5kcyBpc3N1\nZWQgb24gdGhlIGNvbm5lY3Rpb24sIGFuZCB0aGUKICAgICAgICAgICAgICAg\nICAgICAgICAgLy8gY29ubmVjdGlvbiBwb29sIG1heSBoYXZlIGlzc3VlZCBz\nb21lIHZhbGlkYXRpb24gU1FMLgogICAgICAgICAgICAgICAgICAgICAgICB0\ncnkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29ubi5yb2xsYmFj\naygpOwogICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChFeGNlcHRp\nb24gZSkgewogICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAg\nICAgICAgICAgICAgICBzdGF0ZW1lbnQgPSBjb25uLmNyZWF0ZVN0YXRlbWVu\ndCgpOwogICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZW1lbnQuZXhlY3V0\nZVVwZGF0ZShzcWxbaV0pOwoKICAgICAgICAgICAgICAgICAgICAgICAgLy8g\nc29tZSBjb25uZWN0aW9ucyBzZWVtIHRvIHJlcXVpcmUgYW4gZXhwbGljaXQK\nICAgICAgICAgICAgICAgICAgICAgICAgLy8gY29tbWl0IGZvciBEREwgc3Rh\ndGVtZW50cywgZXZlbiB3aGVuIGF1dG9jb21taXQKICAgICAgICAgICAgICAg\nICAgICAgICAgLy8gaXMgb24uIFRoZSBEYXRhRGlyZWN0IGRyaXZlcnMgc2Vl\nbSB0byBzdWZmZXIgZnJvbQogICAgICAgICAgICAgICAgICAgICAgICAvLyB0\naGlzIGxpbWl0YXRpb24uCiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7\nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25uLmNvbW1pdCgpOwog\nICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkg\newogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAg\nICAgfQogICAgICAgICAgICAgICAgICAgIGNhdGNoIChTUUxFeGNlcHRpb24g\nc2UpIHsKICAgICAgICAgICAgICAgICAgICAgICAgZXJyID0gdHJ1ZTsKICAg\nICAgICAgICAgICAgICAgICAgICAgaGFuZGxlRXhjZXB0aW9uKHNlKTsKICAg\nICAgICAgICAgICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICAgICAg\nICAgICAgICBpZiAoc3RhdGVtZW50ICE9IG51bGwpCiAgICAgICAgICAgICAg\nICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgIHN0YXRlbWVudC5jbG9zZSgpOwogICAgICAgICAgICAgICAgICAg\nICAgICAgICAgfSBjYXRjaCAoU1FMRXhjZXB0aW9uIHNlKSB7CiAgICAgICAg\nICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQog\nICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGZp\nbmFsbHkgewogICAgICAgICAgICAgICAgaWYgKCF3YXNBdXRvKQogICAgICAg\nICAgICAgICAgICAgIGNvbm4uc2V0QXV0b0NvbW1pdChmYWxzZSk7CiAgICAg\nICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgIGNvbm4uY2xv\nc2UoKTsKICAgICAgICAgICAgICAgIH0gY2F0Y2ggKFNRTEV4Y2VwdGlvbiBz\nZSkgewogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAg\nfSBlbHNlIHsKICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBzcWwu\nbGVuZ3RoOyBpKyspCiAgICAgICAgICAgICAgICBfd3JpdGVyLnByaW50bG4o\nc3FsW2ldICsgIjsiKTsKICAgICAgICAgICAgX3dyaXRlci5mbHVzaCgpOwog\nICAgICAgIH0KCiAgICAgICAgcmV0dXJuICFlcnI7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBIYW5kbGUgdGhlIGdpdmVuIGV4Y2VwdGlvbiwgbG9nZ2luZyBp\ndCBhbmQgb3B0aW9uYWxseSBpZ25vcmluZyBpdCwKICAgICAqIGRlcGVuZGlu\nZyBvbiB0aGUgZmxhZ3MgdGhpcyBTY2hlbWFUb29sIHdhcyBjcmVhdGVkIHdp\ndGguCiAgICAgKi8KICAgIHByaXZhdGUgdm9pZCBoYW5kbGVFeGNlcHRpb24o\nU1FMRXhjZXB0aW9uIHNxbCkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9u\nIHsKICAgICAgICBpZiAoIV9pZ25vcmVFcnJzKQogICAgICAgICAgICB0aHJv\ndyBzcWw7CiAgICAgICAgX2xvZy53YXJuKHNxbC5nZXRNZXNzYWdlKCksIHNx\nbCk7CiAgICB9CgogICAgLy8vLy8vLy8KICAgIC8vIE1haW4KICAgIC8vLy8v\nLy8vCgogICAgLyoqCiAgICAgKiBVc2FnZTogamF2YSBvcmcuYXBhY2hlLm9w\nZW5qcGEuamRiYy5zY2hlbWEuU2NoZW1hVG9vbCBbb3B0aW9uXSoKICAgICAq\nIFstYWN0aW9uLy1hICZsdDthZGQgfCByZXRhaW4gfCBkcm9wIHwgcmVmcmVz\naCB8IGNyZWF0ZURCIHwgZHJvcERCCiAgICAgKiB8IGJ1aWxkIHwgcmVmbGVj\ndCB8IGltcG9ydCB8IGV4cG9ydCZndDtdCiAgICAgKiAmbHQ7LnNjaGVtYSBm\naWxlIG9yIHJlc291cmNlJmd0OyoKICAgICAqICBXaGVyZSB0aGUgZm9sbG93\naW5nIG9wdGlvbnMgYXJlIHJlY29nbml6ZWQuCiAgICAgKiA8dWw+CiAgICAg\nKiA8bGk+PGk+LXByb3BlcnRpZXMvLXAgJmx0O3Byb3BlcnRpZXMgZmlsZSBv\nciByZXNvdXJjZSZndDs8L2k+OiBUaGUKICAgICAqIHBhdGggb3IgcmVzb3Vy\nY2UgbmFtZSBvZiBhIE9wZW5KUEEgcHJvcGVydGllcyBmaWxlIGNvbnRhaW5p\nbmcKICAgICAqIGluZm9ybWF0aW9uIHN1Y2ggYXMgdGhlIGxpY2Vuc2Uga2V5\nCWFuZCBjb25uZWN0aW9uIGRhdGEgYXMKICAgICAqIG91dGxpbmVkIGluIHtA\nbGluayBKREJDQ29uZmlndXJhdGlvbn0uIE9wdGlvbmFsLjwvbGk+CiAgICAg\nKiA8bGk+PGk+LSZsdDtwcm9wZXJ0eSBuYW1lJmd0OyAmbHQ7cHJvcGVydHkg\ndmFsdWUmZ3Q7PC9pPjogQWxsIGJlYW4KICAgICAqIHByb3BlcnRpZXMgb2Yg\ndGhlIE9wZW5KUEEge0BsaW5rIEpEQkNDb25maWd1cmF0aW9ufSBjYW4gYmUg\nc2V0IGJ5CiAgICAgKiB1c2luZyB0aGVpcgluYW1lcyBhbmQgc3VwcGx5aW5n\nIGEgdmFsdWUuIEZvciBleGFtcGxlOgogICAgICogPGNvZGU+LWxpY2Vuc2VL\nZXkgYWRzbGZqYTgzcjNsa2FkZjwvY29kZT48L2xpPgogICAgICogPGxpPjxp\nPi1pZ25vcmVFcnJvcnMvLWkgJmx0O3RydWUvdCB8IGZhbHNlL2YmZ3Q7PC9p\nPjogSWYgZmFsc2UsIGFuCiAgICAgKiBleGNlcHRpb24gd2lsbCB3aWxsIGJl\nIHRocm93biBpZiB0aGUgdG9vbCBlbmNvdW50ZXJzIGFueSBkYXRhYmFzZQog\nICAgICogZXhjZXB0aW9uczsgZGVmYXVsdHMgdG8gPGNvZGU+ZmFsc2U8L2Nv\nZGU+LjwvbGk+CiAgICAgKiA8bGk+PGk+LWZpbGUvLWYgJmx0O3N0ZG91dCB8\nIG91dHB1dCBmaWxlIG9yIHJlc291cmNlJmd0OzwvaT46IFVzZSB0aGlzCiAg\nICAgKiBvcHRpb24gdG8gd3JpdGUgYSBTUUwgc2NyaXB0IGZvciB0aGUgcGxh\nbm5lZCBzY2hlbWEgbW9kaWZpY2F0aW9ucywKICAgICAqIHJhdGhlciB0aGFu\nIGNvbW1pdHRpbmcgdGhlbSB0byB0aGUgZGF0YWJhc2UuIFRoaXMgb3B0aW9u\nIGFsc28KICAgICAqIGFwcGxpZXMgdG8gdGhlIDxjb2RlPmV4cG9ydDwvY29k\nZT4gYW5kIDxjb2RlPnJlZmxlY3Q8L2NvZGU+IGFjdGlvbnMuPC9saT4KICAg\nICAqIDxsaT48aT4tb3BlbmpwYVRhYmxlcy8ta3QgJmx0O3RydWUvdCB8IGZh\nbHNlL2YmZ3Q7PC9pPjogVW5kZXIgdGhlCiAgICAgKiA8Y29kZT5yZWZsZWN0\nPC9jb2RlPiBhY3Rpb24sIHdoZXRoZXIgdG8gcmVmbGVjdCBvbiB0YWJsZXMg\nd2l0aAogICAgICogdGhlIG5hbWUgPGNvZGU+T1BFTkpQQV8qPC9jb2RlPi4g\nVW5kZXIgb3RoZXIgYWN0aW9ucywgd2hldGhlciB0bwogICAgICogZHJvcCBz\ndWNoIHRhYmxlcy4gRGVmYXVsdHMgdG8gPGNvZGU+ZmFsc2U8L2NvZGU+Ljwv\nbGk+CiAgICAgKiA8bGk+PGk+LWRyb3BUYWJsZXMvLWR0ICZsdDt0cnVlL3Qg\nfCBmYWxzZS9mJmd0OzwvaT46IFNldCB0aGlzIG9wdGlvbiB0bwogICAgICog\ndHJ1ZSB0byBkcm9wIHRhYmxlcyB0aGF0IGFwcGVhciB0byBiZSB1bnVzZWQg\nZHVyaW5nCiAgICAgKiA8Y29kZT5yZXRhaW48L2NvZGU+CWFuZCA8Y29kZT5y\nZWZyZXNoPC9jb2RlPiBhY3Rpb25zLiBEZWZhdWx0cyB0bwogICAgICogPGNv\nZGU+dHJ1ZTwvY29kZT4uPC9saT4KICAgICAqIDxsaT48aT4tZHJvcFNlcXVl\nbmNlcy8tZHNxICZsdDt0cnVlL3QgfCBmYWxzZS9mJmd0OzwvaT46IFNldCB0\naGlzIG9wdGlvbgogICAgICogdG8gdHJ1ZSB0byBkcm9wIHNlcXVlbmNlcyB0\naGF0IGFwcGVhciB0byBiZSB1bnVzZWQgZHVyaW5nCiAgICAgKiA8Y29kZT5y\nZXRhaW48L2NvZGU+CWFuZCA8Y29kZT5yZWZyZXNoPC9jb2RlPiBhY3Rpb25z\nLiBEZWZhdWx0cyB0bwogICAgICogPGNvZGU+dHJ1ZTwvY29kZT4uPC9saT4K\nICAgICAqIDxsaT48aT4tcHJpbWFyeUtleXMvLXBrICZsdDt0cnVlL3QgfCBm\nYWxzZS9mJmd0OzwvaT46IFdoZXRoZXIgcHJpbWFyeQogICAgICoga2V5cyBv\nbiBleGlzdGluZyB0YWJsZXMgYXJlIG1hbmlwdWxhdGVkLiBEZWZhdWx0cyB0\nbyB0cnVlLjwvbGk+CiAgICAgKiA8bGk+PGk+LWZvcmVpZ25LZXlzLy1mayAm\nbHQ7dHJ1ZS90IHwgZmFsc2UvZiZndDs8L2k+OiBXaGV0aGVyIGZvcmVpZ24K\nICAgICAqIGtleXMgb24gZXhpc3RpbmcgdGFibGVzIGFyZSBtYW5pcHVsYXRl\nZC4gRGVmYXVsdHMgdG8gdHJ1ZS48L2xpPgogICAgICogPGxpPjxpPi1pbmRl\neGVzLy1peCAmbHQ7dHJ1ZS90IHwgZmFsc2UvZiZndDs8L2k+OiBXaGV0aGVy\nIGluZGV4ZXMKICAgICAqIG9uIGV4aXN0aW5nIHRhYmxlcyBhcmUgbWFuaXB1\nbGF0ZWQuIERlZmF1bHRzIHRvIHRydWUuPC9saT4KICAgICAqIDxsaT48aT4t\nc2VxdWVuY2VzLy1zcSAmbHQ7dHJ1ZS90IHwgZmFsc2UvZiZndDs8L2k+OiBX\naGV0aGVyIHRvCiAgICAgKiBtYW5pcHVsYXRlIHNlcXVlbmNlcy4gRGVmYXVs\ndHMgdG8gdHJ1ZS48L2xpPgogICAgICogPGxpPjxpPi1yZWNvcmQvLXIgJmx0\nO3RydWUvdCB8IGZhbHNlL2YmZ3Q7PC9pPjogU2V0IHRoaXMgb3B0aW9uIHRv\nCiAgICAgKiA8Y29kZT5mYWxzZTwvY29kZT4gdG8gcHJldmVudCB3cml0aW5n\nIHRoZSBzY2hlbWEgY2hhbmdlcyB0byB0aGUKICAgICAqIGN1cnJlbnQge0Bs\naW5rIFNjaGVtYUZhY3Rvcnl9LjwvbGk+CiAgICAgKiA8L3VsPgogICAgICog\nIEFjdGlvbnMgY2FuIGJlIGNvbXBvc2VkIGluIGEgY29tbWEtc2VwYXJhdGVk\nIGxpc3QuIFRoZSB2YXJpb3VzIGFjdGlvbnMgCiAgICAgKiAgYXJlIGFzIGZv\nbGxvd3MuCiAgICAgKiA8dWw+CiAgICAgKiA8bGk+PGk+YWRkPC9pPjogQnJp\nbmcgdGhlIHNjaGVtYSB1cC10by1kYXRlIHdpdGggdGhlIGxhdGVzdAogICAg\nICogY2hhbmdlcyB0byB0aGUgc2NoZW1hIFhNTCBkYXRhIGJ5IGFkZGluZyB0\nYWJsZXMsIGNvbHVtbnMsCiAgICAgKiBpbmRleGVzLCBldGMuIFRoaXMgYWN0\naW9uIG5ldmVyIGRyb3BzIGFueSBkYXRhLiBUaGlzIGlzIHRoZQogICAgICog\nZGVmYXVsdCBhY3Rpb24uPC9saT4KICAgICAqIDxsaT48aT5yZXRhaW48L2k+\nOiBLZWVwIGFsbCBzY2hlbWEgY29tcG9uZW50cyBpbiB0aGUgc2NoZW1hIFhN\nTCwgYnV0CiAgICAgKiBkcm9wIHRoZSByZXN0IGZyb20gdGhlIGRhdGFiYXNl\nLiBUaGlzIGFjdGlvbiBuZXZlciBhZGRzIGFueSBkYXRhLjwvbGk+CiAgICAg\nKiA8bGk+PGk+ZHJvcDwvaT46IERyb3AgYWxsIHRoZSBzY2hlbWEgY29tcG9u\nZW50cyBpbiB0aGUgc2NoZW1hIFhNTC48L2xpPgogICAgICogPGxpPjxpPnJl\nZnJlc2g8L2k+OiBFcXVpdmFsZW50IHRvIHJldGFpbiwgdGhlbiBhZGQuPC9s\naT4KICAgICAqIDxsaT48aT5jcmVhdGVEQjwvaT46IEV4ZWN1dGUgU1FMIHRv\nIHJlLWNyZWF0ZSB0aGUgY3VycmVudCBkYXRhYmFzZS4KICAgICAqIFRoaXMg\nYWN0aW9uIGlzIHR5cGljYWxseSB1c2VkIGluIGNvbmp1Y3Rpb24gd2l0aCB0\naGUKICAgICAqIDxjb2RlPmZpbGU8L2NvZGU+IG9wdGlvbi48L2xpPgogICAg\nICogPGxpPjxpPmJ1aWxkPC9pPjogRXhlY3V0ZSBTUUwgdG8gYnVpbGQgdGhl\nIHNjaGVtYSBkZWZpbmVkIGluIHRoZSBYTUwuCiAgICAgKiBCZWNhdXNlIGl0\nIGRvZXNuJ3QgdGFrZSB0aGUgY3VycmVudCBkYXRhYmFzZSBzY2hlbWEgaW50\nbyBhY2NvdW50LAogICAgICogdGhpcyBhY3Rpb24gaXMgdHlwaWNhbGx5IHVz\nZWQgaW4gY29uanVjdGlvbiB3aXRoIHRoZQogICAgICogPGNvZGU+ZmlsZTwv\nY29kZT4gb3B0aW9uLjwvbGk+CiAgICAgKiA8bGk+PGk+cmVmbGVjdDwvaT46\nIFJlZmxlY3Qgb24gdGhlIGN1cnJlbnQgZGF0YWJhc2Ugc2NoZW1hLiBXcml0\nZSB0aGUKICAgICAqIHNjaGVtYSdzIFhNTCByZXByZXNlbnRhdGlvbiB0byB0\naGUgZmlsZSBzcGVjaWZpZWQgd2l0aCB0aGUKICAgICAqIDxjb2RlPmZpbGU8\nL2NvZGU+IG9wdGlvbiwgb3IgdG8gc3Rkb3V0IGlmIG5vIGZpbGUgaXMgZ2l2\nZW4uPC9saT4KICAgICAqIDxsaT48aT5kcm9wREI8L2k+OiBFeGVjdXRlIFNR\nTCB0byBkcm9wIHRoZSBjdXJyZW50IGRhdGFiYXNlLiBUaGlzCiAgICAgKiBh\nY3Rpb24gaW1wbGllcyA8Y29kZT5kcm9wVGFibGVzPC9jb2RlPi48L2xpPgog\nICAgICogPGxpPjxpPmRlbGV0ZVRhYmxlQ29udGVudHM8L2k+OiBFeGVjdXRl\nIFNRTCB0byBkZWxldGUgYWxsIHJvd3MgZnJvbSAKICAgICAqIGFsbCB0YWJs\nZXMgdGhhdCBPcGVuSlBBIGtub3dzIGFib3V0LjwvbGk+CiAgICAgKiA8bGk+\nPGk+aW1wb3J0PC9pPjogSW1wb3J0IHRoZSBnaXZlbiBYTUwgc2NoZW1hIGRl\nZmluaXRpb24gaW50byB0aGUKICAgICAqIGN1cnJlbnQge0BsaW5rIFNjaGVt\nYUZhY3Rvcnl9LjwvbGk+CiAgICAgKiA8bGk+PGk+ZXhwb3J0PC9pPjogRXhw\nb3J0IHRoZSBjdXJyZW50IHtAbGluayBTY2hlbWFGYWN0b3J5fSdzIHJlY29y\nZGVkCiAgICAgKiBzY2hlbWEgdG8gYW4gWE1MIHNjaGVtYSBkZWZpbml0aW9u\nIGZpbGUuPC9saT4KICAgICAqIDwvdWw+CiAgICAgKiAgRXhhbXBsZXM6CiAg\nICAgKiA8dWw+CiAgICAgKiA8bGk+V3JpdGUgYSBzY3JpcHQgdG8gc3Rkb3V0\nIHRvIHJlLWNyZWF0ZSB0aGUgY3VycmVudCBkYXRhYmFzZQogICAgICogc2No\nZW1hOjxiciAvPgogICAgICogPGNvZGU+amF2YSBvcmcuYXBhY2hlLm9wZW5q\ncGEuamRiYy5zY2hlbWEuU2NoZW1hVG9vbCAtZiBzdGRvdXQgCiAgICAgKiAt\nYSBjcmVhdGVEQjwvY29kZT48L2xpPgogICAgICogPGxpPkRyb3AgdGhlIGN1\ncnJlbnQgZGF0YWJhc2Ugc2NoZW1hOjxiciAvPgogICAgICogPGNvZGU+amF2\nYSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hlbWEuU2NoZW1hVG9vbCAK\nICAgICAqIC1hIGRyb3BEQjwvY29kZT48L2xpPgogICAgICogPGxpPlJlZnJl\nc2ggdGhlIHNjaGVtYSBhbmQgZGVsZXRlIGFsbCByZWNvcmRzIGluIGFsbCB0\nYWJsZXM6PGJyIC8+CiAgICAgKiA8Y29kZT5qYXZhIG9yZy5hcGFjaGUub3Bl\nbmpwYS5qZGJjLnNjaGVtYS5TY2hlbWFUb29sIAogICAgICogLWEgcmVmcmVz\naCxkZWxldGVUYWJsZUNvbnRlbnRzPC9jb2RlPjwvbGk+CiAgICAgKiA8bGk+\nQ3JlYXRlIGEgc2NoZW1hIGJhc2VkIG9uIGFuIFhNTCBzY2hlbWEgZGVmaW5p\ndGlvbiBmaWxlOjxiciAvPgogICAgICogPGNvZGU+amF2YSBvcmcuYXBhY2hl\nLm9wZW5qcGEuamRiYy5zY2hlbWEuU2NoZW1hVG9vbCAKICAgICAqIG15c2No\nZW1hLnhtbDwvY29kZT48L2xpPgogICAgICogPC91bD4KICAgICAqLwogICAg\ncHVibGljIHN0YXRpYyB2b2lkIG1haW4oU3RyaW5nW10gYXJncykKICAgICAg\nICB0aHJvd3MgSU9FeGNlcHRpb24sIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAg\nT3B0aW9ucyBvcHRzID0gbmV3IE9wdGlvbnMoKTsKICAgICAgICBmaW5hbCBT\ndHJpbmdbXSBhcmd1bWVudHMgPSBvcHRzLnNldEZyb21DbWRMaW5lKGFyZ3Mp\nOwogICAgICAgIGJvb2xlYW4gcmV0ID0gQ29uZmlndXJhdGlvbnMucnVuQWdh\naW5zdEFsbEFuY2hvcnMob3B0cywKICAgICAgICAgICAgbmV3IENvbmZpZ3Vy\nYXRpb25zLlJ1bm5hYmxlKCkgewogICAgICAgICAgICBwdWJsaWMgYm9vbGVh\nbiBydW4oT3B0aW9ucyBvcHRzKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAg\nICAgICAgICAgIEpEQkNDb25maWd1cmF0aW9uIGNvbmYgPSBuZXcgSkRCQ0Nv\nbmZpZ3VyYXRpb25JbXBsKCk7CiAgICAgICAgICAgICAgICB0cnkgewogICAg\nICAgICAgICAgICAgICAgIHJldHVybiBTY2hlbWFUb29sLnJ1bihjb25mLCBh\ncmd1bWVudHMsIG9wdHMpOwogICAgICAgICAgICAgICAgfSBmaW5hbGx5IHsK\nICAgICAgICAgICAgICAgICAgICBjb25mLmNsb3NlKCk7CiAgICAgICAgICAg\nICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgICBpZiAo\nIXJldCkKICAgICAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKF9sb2MuZ2V0\nKCJ0b29sLXVzYWdlIikpOwogICAgfQoKICAgIC8qKgogICAgICogUnVuIHRo\nZSB0b29sLiBSZXR1cm5zIGZhbHNlIGlmIGFueSBpbnZhbGlkIG9wdGlvbnMg\nd2VyZSBnaXZlbi4KICAgICAqCiAgICAgKiBAc2VlICNtYWluCiAgICAgKi8K\nICAgIHB1YmxpYyBzdGF0aWMgYm9vbGVhbiBydW4oSkRCQ0NvbmZpZ3VyYXRp\nb24gY29uZiwgU3RyaW5nW10gYXJncywKICAgICAgICBPcHRpb25zIG9wdHMp\nCiAgICAgICAgdGhyb3dzIElPRXhjZXB0aW9uLCBTUUxFeGNlcHRpb24gewog\nICAgICAgIEZsYWdzIGZsYWdzID0gbmV3IEZsYWdzKCk7CiAgICAgICAgZmxh\nZ3MuZHJvcFRhYmxlcyA9IG9wdHMucmVtb3ZlQm9vbGVhblByb3BlcnR5CiAg\nICAgICAgICAgICgiZHJvcFRhYmxlcyIsICJkdCIsIGZsYWdzLmRyb3BUYWJs\nZXMpOwogICAgICAgIGZsYWdzLmRyb3BTZXF1ZW5jZXMgPSBvcHRzLnJlbW92\nZUJvb2xlYW5Qcm9wZXJ0eQogICAgICAgICAgICAoImRyb3BTZXF1ZW5jZXMi\nLCAiZHNxIiwgZmxhZ3MuZHJvcFNlcXVlbmNlcyk7CiAgICAgICAgZmxhZ3Mu\naWdub3JlRXJyb3JzID0gb3B0cy5yZW1vdmVCb29sZWFuUHJvcGVydHkKICAg\nICAgICAgICAgKCJpZ25vcmVFcnJvcnMiLCAiaSIsIGZsYWdzLmlnbm9yZUVy\ncm9ycyk7CiAgICAgICAgZmxhZ3Mub3BlbmpwYVRhYmxlcyA9IG9wdHMucmVt\nb3ZlQm9vbGVhblByb3BlcnR5CiAgICAgICAgICAgICgib3BlbmpwYVRhYmxl\ncyIsICJvdCIsIGZsYWdzLm9wZW5qcGFUYWJsZXMpOwogICAgICAgIGZsYWdz\nLnByaW1hcnlLZXlzID0gb3B0cy5yZW1vdmVCb29sZWFuUHJvcGVydHkKICAg\nICAgICAgICAgKCJwcmltYXJ5S2V5cyIsICJwayIsIGZsYWdzLnByaW1hcnlL\nZXlzKTsKICAgICAgICBmbGFncy5mb3JlaWduS2V5cyA9IG9wdHMucmVtb3Zl\nQm9vbGVhblByb3BlcnR5CiAgICAgICAgICAgICgiZm9yZWlnbktleXMiLCAi\nZmtzIiwgZmxhZ3MuZm9yZWlnbktleXMpOwogICAgICAgIGZsYWdzLmluZGV4\nZXMgPSBvcHRzLnJlbW92ZUJvb2xlYW5Qcm9wZXJ0eQogICAgICAgICAgICAo\nImluZGV4ZXMiLCAiaXgiLCBmbGFncy5pbmRleGVzKTsKICAgICAgICBmbGFn\ncy5zZXF1ZW5jZXMgPSBvcHRzLnJlbW92ZUJvb2xlYW5Qcm9wZXJ0eQogICAg\nICAgICAgICAoInNlcXVlbmNlcyIsICJzcSIsIGZsYWdzLnNlcXVlbmNlcyk7\nCiAgICAgICAgZmxhZ3MucmVjb3JkID0gb3B0cy5yZW1vdmVCb29sZWFuUHJv\ncGVydHkoInJlY29yZCIsICJyIiwgZmxhZ3MucmVjb3JkKTsKICAgICAgICBT\ndHJpbmcgZmlsZU5hbWUgPSBvcHRzLnJlbW92ZVByb3BlcnR5KCJmaWxlIiwg\nImYiLCBudWxsKTsKICAgICAgICBTdHJpbmcgc2NoZW1hcyA9IG9wdHMucmVt\nb3ZlUHJvcGVydHkoInMiKTsKICAgICAgICBpZiAoc2NoZW1hcyAhPSBudWxs\nKQogICAgICAgICAgICBvcHRzLnNldFByb3BlcnR5KCJzY2hlbWFzIiwgc2No\nZW1hcyk7CgogICAgICAgIFN0cmluZ1tdIGFjdGlvbnMgPSBvcHRzLnJlbW92\nZVByb3BlcnR5KCJhY3Rpb24iLCAiYSIsIGZsYWdzLmFjdGlvbikKICAgICAg\nICAgICAgLnNwbGl0KCIsIik7CiAgICAgICAgCiAgICAgICAgLy8gc2V0dXAg\nYSBjb25maWd1cmF0aW9uIGluc3RhbmNlIHdpdGggY21kLWxpbmUgaW5mbwog\nICAgICAgIENvbmZpZ3VyYXRpb25zLnBvcHVsYXRlQ29uZmlndXJhdGlvbihj\nb25mLCBvcHRzKTsKCiAgICAgICAgLy8gY3JlYXRlIHNjcmlwdCB3cml0ZXIK\nICAgICAgICBDbGFzc0xvYWRlciBsb2FkZXIgPSBjb25mLmdldENsYXNzUmVz\nb2x2ZXJJbnN0YW5jZSgpLgogICAgICAgICAgICBnZXRDbGFzc0xvYWRlcihT\nY2hlbWFUb29sLmNsYXNzLCBudWxsKTsKICAgICAgICBmbGFncy53cml0ZXIg\nPSBGaWxlcy5nZXRXcml0ZXIoZmlsZU5hbWUsIGxvYWRlcik7CgogICAgICAg\nIGJvb2xlYW4gcmV0dXJuVmFsdWUgPSB0cnVlOwogICAgICAgIGZvciAoaW50\nIGkgPSAwOyBpIDwgYWN0aW9ucy5sZW5ndGg7IGkrKykgewogICAgICAgICAg\nICBmbGFncy5hY3Rpb24gPSBhY3Rpb25zW2ldOwogICAgICAgICAgICByZXR1\ncm5WYWx1ZSAmPSBydW4oY29uZiwgYXJncywgZmxhZ3MsIGxvYWRlcik7CiAg\nICAgICAgfQogICAgICAgIAogICAgICAgIHJldHVybiByZXR1cm5WYWx1ZTsK\nICAgIH0KCiAgICAvKioKICAgICAqIFJ1biB0aGUgdG9vbC4gUmV0dXJuIGZh\nbHNlIGlmIGludmFsaWQgb3B0aW9ucyB3ZXJlIGdpdmVuLgogICAgICovCiAg\nICBwdWJsaWMgc3RhdGljIGJvb2xlYW4gcnVuKEpEQkNDb25maWd1cmF0aW9u\nIGNvbmYsIFN0cmluZ1tdIGFyZ3MsCiAgICAgICAgRmxhZ3MgZmxhZ3MsIENs\nYXNzTG9hZGVyIGxvYWRlcikKICAgICAgICB0aHJvd3MgSU9FeGNlcHRpb24s\nIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgTG9nIGxvZyA9IGNvbmYuZ2V0TG9n\nKE9wZW5KUEFDb25maWd1cmF0aW9uLkxPR19UT09MKTsKICAgICAgICBpZiAo\nQUNUSU9OX1JFRkxFQ1QuZXF1YWxzKGZsYWdzLmFjdGlvbikpIHsKICAgICAg\nICAgICAgaWYgKGFyZ3MubGVuZ3RoID4gMCkKICAgICAgICAgICAgICAgIHJl\ndHVybiBmYWxzZTsKICAgICAgICAgICAgaWYgKGZsYWdzLndyaXRlciA9PSBu\ndWxsKQogICAgICAgICAgICAgICAgZmxhZ3Mud3JpdGVyID0gbmV3IFByaW50\nV3JpdGVyKFN5c3RlbS5vdXQpOwoKICAgICAgICAgICAgU2NoZW1hR2VuZXJh\ndG9yIGdlbiA9IG5ldyBTY2hlbWFHZW5lcmF0b3IoY29uZik7CiAgICAgICAg\nICAgIGdlbi5zZXRQcmltYXJ5S2V5cyhmbGFncy5wcmltYXJ5S2V5cyk7CiAg\nICAgICAgICAgIGdlbi5zZXRJbmRleGVzKGZsYWdzLmluZGV4ZXMpOwogICAg\nICAgICAgICBnZW4uc2V0Rm9yZWlnbktleXMoZmxhZ3MuZm9yZWlnbktleXMp\nOwogICAgICAgICAgICBnZW4uc2V0U2VxdWVuY2VzKGZsYWdzLnNlcXVlbmNl\ncyk7CiAgICAgICAgICAgIGdlbi5zZXRPcGVuSlBBVGFibGVzKGZsYWdzLm9w\nZW5qcGFUYWJsZXMpOwoKICAgICAgICAgICAgU3RyaW5nIHNjaGVtYXMgPSBj\nb25mLmdldFNjaGVtYXMoKTsKICAgICAgICAgICAgaWYgKFN0cmluZ1V0aWxz\nLmlzRW1wdHkoc2NoZW1hcykpCiAgICAgICAgICAgICAgICBzY2hlbWFzID0g\nImFsbCI7CiAgICAgICAgICAgIGxvZy5pbmZvKF9sb2MuZ2V0KCJzY2gtcmVm\nbGVjdCIsIHNjaGVtYXMpKTsKICAgICAgICAgICAgZ2VuLmdlbmVyYXRlU2No\nZW1hcygpOwoKICAgICAgICAgICAgLy8gcmVjb3JkIHRoZSBzY2hlbWEKICAg\nICAgICAgICAgbG9nLmluZm8oX2xvYy5nZXQoInNjaC1yZWZsZWN0LXdyaXRl\nIikpOwogICAgICAgICAgICBTY2hlbWFTZXJpYWxpemVyIHNlciA9IG5ldyBY\nTUxTY2hlbWFTZXJpYWxpemVyKGNvbmYpOwogICAgICAgICAgICBzZXIuYWRk\nQWxsKGdlbi5nZXRTY2hlbWFHcm91cCgpKTsKICAgICAgICAgICAgc2VyLnNl\ncmlhbGl6ZShmbGFncy53cml0ZXIsIE1ldGFEYXRhU2VyaWFsaXplci5QUkVU\nVFkpOwogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CgogICAg\nICAgIGlmIChhcmdzLmxlbmd0aCA9PSAwCiAgICAgICAgICAgICYmICFBQ1RJ\nT05fQ1JFQVRFREIuZXF1YWxzKGZsYWdzLmFjdGlvbikKICAgICAgICAgICAg\nJiYgIUFDVElPTl9EUk9QREIuZXF1YWxzKGZsYWdzLmFjdGlvbikKICAgICAg\nICAgICAgJiYgIUFDVElPTl9FWFBPUlQuZXF1YWxzKGZsYWdzLmFjdGlvbikK\nICAgICAgICAgICAgJiYgIUFDVElPTl9ERUxFVEVfVEFCTEVfQ09OVEVOVFMu\nZXF1YWxzKGZsYWdzLmFjdGlvbikpCiAgICAgICAgICAgIHJldHVybiBmYWxz\nZTsKCiAgICAgICAgLy8gcGFyc2UgaW4gdGhlIGFyZ3VtZW50cwogICAgICAg\nIFNjaGVtYVBhcnNlciBwYXJzZXIgPSBuZXcgWE1MU2NoZW1hUGFyc2VyKGNv\nbmYpOwogICAgICAgIHBhcnNlci5zZXREZWxheUNvbnN0cmFpbnRSZXNvbHZl\nKHRydWUpOwogICAgICAgIEZpbGUgZmlsZTsKICAgICAgICBmb3IgKGludCBp\nID0gMDsgaSA8IGFyZ3MubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgZmls\nZSA9IEZpbGVzLmdldEZpbGUoYXJnc1tpXSwgbG9hZGVyKTsKICAgICAgICAg\nICAgbG9nLmluZm8oX2xvYy5nZXQoInRvb2wtcnVubmluZyIsIGZpbGUpKTsK\nICAgICAgICAgICAgcGFyc2VyLnBhcnNlKGZpbGUpOwogICAgICAgIH0KICAg\nICAgICBwYXJzZXIucmVzb2x2ZUNvbnN0cmFpbnRzKCk7CgogICAgICAgIGlm\nIChBQ1RJT05fSU1QT1JULmVxdWFscyhmbGFncy5hY3Rpb24pKSB7CiAgICAg\nICAgICAgIGxvZy5pbmZvKF9sb2MuZ2V0KCJ0b29sLWltcG9ydC1zdG9yZSIp\nKTsKICAgICAgICAgICAgU2NoZW1hR3JvdXAgc2NoZW1hID0gcGFyc2VyLmdl\ndFNjaGVtYUdyb3VwKCk7CiAgICAgICAgICAgIGNvbmYuZ2V0U2NoZW1hRmFj\ndG9yeUluc3RhbmNlKCkuc3RvcmVTY2hlbWEoc2NoZW1hKTsKICAgICAgICAg\nICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQogICAgICAgIGlmIChBQ1RJT05f\nRVhQT1JULmVxdWFscyhmbGFncy5hY3Rpb24pKSB7CiAgICAgICAgICAgIGlm\nIChmbGFncy53cml0ZXIgPT0gbnVsbCkKICAgICAgICAgICAgICAgIGZsYWdz\nLndyaXRlciA9IG5ldyBQcmludFdyaXRlcihTeXN0ZW0ub3V0KTsKCiAgICAg\nICAgICAgIGxvZy5pbmZvKF9sb2MuZ2V0KCJ0b29sLWV4cG9ydC1nZW4iKSk7\nCiAgICAgICAgICAgIFNjaGVtYUdyb3VwIHNjaGVtYSA9IGNvbmYuZ2V0U2No\nZW1hRmFjdG9yeUluc3RhbmNlKCkucmVhZFNjaGVtYSgpOwoKICAgICAgICAg\nICAgbG9nLmluZm8oX2xvYy5nZXQoInRvb2wtZXhwb3J0LXdyaXRlIikpOwog\nICAgICAgICAgICBTY2hlbWFTZXJpYWxpemVyIHNlciA9IG5ldyBYTUxTY2hl\nbWFTZXJpYWxpemVyKGNvbmYpOwogICAgICAgICAgICBzZXIuYWRkQWxsKHNj\naGVtYSk7CiAgICAgICAgICAgIHNlci5zZXJpYWxpemUoZmxhZ3Mud3JpdGVy\nLCBNZXRhRGF0YVNlcmlhbGl6ZXIuUFJFVFRZKTsKICAgICAgICAgICAgcmV0\ndXJuIHRydWU7CiAgICAgICAgfQoKICAgICAgICBTY2hlbWFUb29sIHRvb2wg\nPSBuZXcgU2NoZW1hVG9vbChjb25mLCBmbGFncy5hY3Rpb24pOwogICAgICAg\nIHRvb2wuc2V0SWdub3JlRXJyb3JzKGZsYWdzLmlnbm9yZUVycm9ycyk7CiAg\nICAgICAgdG9vbC5zZXREcm9wVGFibGVzKGZsYWdzLmRyb3BUYWJsZXMpOwog\nICAgICAgIHRvb2wuc2V0U2VxdWVuY2VzKGZsYWdzLnNlcXVlbmNlcyk7IC8v\nIHNldCBiZWZvcmUgZHJvcHNlcXMKICAgICAgICB0b29sLnNldERyb3BTZXF1\nZW5jZXMoZmxhZ3MuZHJvcFNlcXVlbmNlcyk7CiAgICAgICAgdG9vbC5zZXRQ\ncmltYXJ5S2V5cyhmbGFncy5wcmltYXJ5S2V5cyk7CiAgICAgICAgdG9vbC5z\nZXRGb3JlaWduS2V5cyhmbGFncy5mb3JlaWduS2V5cyk7CiAgICAgICAgdG9v\nbC5zZXRJbmRleGVzKGZsYWdzLmluZGV4ZXMpOwogICAgICAgIHRvb2wuc2V0\nT3BlbkpQQVRhYmxlcyhmbGFncy5vcGVuanBhVGFibGVzKTsKICAgICAgICBp\nZiAoYXJncy5sZW5ndGggPiAwKQogICAgICAgICAgICB0b29sLnNldFNjaGVt\nYUdyb3VwKHBhcnNlci5nZXRTY2hlbWFHcm91cCgpKTsKICAgICAgICBpZiAo\nZmxhZ3Mud3JpdGVyICE9IG51bGwpCiAgICAgICAgICAgIHRvb2wuc2V0V3Jp\ndGVyKGZsYWdzLndyaXRlcik7CgogICAgICAgIGxvZy5pbmZvKF9sb2MuZ2V0\nKCJ0b29sLWFjdGlvbiIsIGZsYWdzLmFjdGlvbikpOwogICAgICAgIHRyeSB7\nCiAgICAgICAgICAgIHRvb2wucnVuKCk7CiAgICAgICAgfSBmaW5hbGx5IHsK\nICAgICAgICAgICAgaWYgKGZsYWdzLnJlY29yZCkgewogICAgICAgICAgICAg\nICAgbG9nLmluZm8oX2xvYy5nZXQoInRvb2wtcmVjb3JkIikpOwogICAgICAg\nICAgICAgICAgdG9vbC5yZWNvcmQoKTsKICAgICAgICAgICAgfQogICAgICAg\nIH0KICAgICAgICBpZiAoZmxhZ3Mud3JpdGVyICE9IG51bGwpCiAgICAgICAg\nICAgIGZsYWdzLndyaXRlci5mbHVzaCgpOwoKICAgICAgICByZXR1cm4gdHJ1\nZTsKICAgIH0KCiAgICAvKioKICAgICAqIFJ1biBmbGFncy4KICAgICAqLwog\nICAgcHVibGljIHN0YXRpYyBjbGFzcyBGbGFncyB7CgogICAgICAgIHB1Ymxp\nYyBTdHJpbmcgYWN0aW9uID0gQUNUSU9OX0FERDsKICAgICAgICBwdWJsaWMg\nV3JpdGVyIHdyaXRlciA9IG51bGw7CiAgICAgICAgcHVibGljIGJvb2xlYW4g\nZHJvcFRhYmxlcyA9IHRydWU7CiAgICAgICAgcHVibGljIGJvb2xlYW4gZHJv\ncFNlcXVlbmNlcyA9IHRydWU7CiAgICAgICAgcHVibGljIGJvb2xlYW4gaWdu\nb3JlRXJyb3JzID0gZmFsc2U7CiAgICAgICAgcHVibGljIGJvb2xlYW4gb3Bl\nbmpwYVRhYmxlcyA9IGZhbHNlOwogICAgICAgIHB1YmxpYyBib29sZWFuIHBy\naW1hcnlLZXlzID0gdHJ1ZTsKICAgICAgICBwdWJsaWMgYm9vbGVhbiBmb3Jl\naWduS2V5cyA9IHRydWU7CiAgICAgICAgcHVibGljIGJvb2xlYW4gaW5kZXhl\ncyA9IHRydWU7CiAgICAgICAgcHVibGljIGJvb2xlYW4gc2VxdWVuY2VzID0g\ndHJ1ZTsKICAgICAgICBwdWJsaWMgYm9vbGVhbiByZWNvcmQgPSB0cnVlOwog\nICAgfQp9Cg==\n","encoding":"base64"}

