{"sha":"ecf913d9b881400c7d05384322d87b645bfec4e0","node_id":"MDQ6QmxvYjIwNjM2NDplY2Y5MTNkOWI4ODE0MDBjN2QwNTM4NDMyMmQ4N2I2NDViZmVjNGUw","size":27089,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/ecf913d9b881400c7d05384322d87b645bfec4e0","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hlbWE7CgppbXBv\ncnQgamF2YS5pby5GaWxlOwppbXBvcnQgamF2YS51dGlsLkFycmF5TGlzdDsK\naW1wb3J0IGphdmEudXRpbC5Db2xsZWN0aW9uOwppbXBvcnQgamF2YS51dGls\nLkl0ZXJhdG9yOwppbXBvcnQgamF2YS51dGlsLk1hcDsKaW1wb3J0IGphdmEu\ndXRpbC5UcmVlTWFwOwppbXBvcnQgamF2YS51dGlsLkxpbmtlZEhhc2hNYXA7\nCgppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuaWRlbnRpZmllci5O\nb3JtYWxpemVyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuaWRl\nbnRpZmllci5EQklkZW50aWZpZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEuamRiYy5pZGVudGlmaWVyLkRCSWRlbnRpZmllclV0aWxJbXBsOwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuaWRlbnRpZmllci5RdWFsaWZp\nZWREQklkZW50aWZpZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRi\nYy5pZGVudGlmaWVyLkRCSWRlbnRpZmllci5EQklkZW50aWZpZXJUeXBlOwpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc3FsLkRCRGljdGlvbmFy\neTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIuaWRlbnRpZmllci5J\nZGVudGlmaWVyVXRpbDsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIu\nbWV0YS5Tb3VyY2VUcmFja2VyOwoKLyoqCiAqIFJlcHJlc2VudHMgYSBkYXRh\nYmFzZSB0YWJsZS4KICoKICogQGF1dGhvciBBYmUgV2hpdGUKICogQGF1dGhv\nciBTdGVwaGVuIEtpbQogKi8KQFN1cHByZXNzV2FybmluZ3MoInNlcmlhbCIp\nCnB1YmxpYyBjbGFzcyBUYWJsZQogICAgZXh0ZW5kcyBOYW1lU2V0CiAgICBp\nbXBsZW1lbnRzIENvbXBhcmFibGU8T2JqZWN0PiwgU291cmNlVHJhY2tlciB7\nCgogICAgcHJpdmF0ZSBEQklkZW50aWZpZXIgX25hbWUgPSBEQklkZW50aWZp\nZXIuTlVMTDsKICAgIHByaXZhdGUgREJJZGVudGlmaWVyIF9zY2hlbWFOYW1l\nID0gREJJZGVudGlmaWVyLk5VTEw7CiAgICBwcml2YXRlIE1hcDxEQklkZW50\naWZpZXIsIENvbHVtbj4gX2NvbE1hcCA9IG51bGw7CiAgICBwcml2YXRlIE1h\ncDxEQklkZW50aWZpZXIsIEluZGV4PiBfaWR4TWFwID0gbnVsbDsKICAgIHBy\naXZhdGUgQ29sbGVjdGlvbjxGb3JlaWduS2V5PiBfZmtMaXN0ID0gbnVsbDsK\nICAgIHByaXZhdGUgQ29sbGVjdGlvbjxVbmlxdWU+IF91bnFMaXN0ID0gbnVs\nbDsKICAgIHByaXZhdGUgU2NoZW1hIF9zY2hlbWEgPSBudWxsOwogICAgcHJp\ndmF0ZSBQcmltYXJ5S2V5IF9wayA9IG51bGw7CgogICAgLy8ga2VlcCB0cmFj\nayBvZiBzb3VyY2UKICAgIHByaXZhdGUgRmlsZSBfc291cmNlID0gbnVsbDsK\nICAgIHByaXZhdGUgaW50IF9zcmNUeXBlID0gU1JDX09USEVSOwoKICAgIC8v\nIGNhY2hlCiAgICBwcml2YXRlIENvbHVtbltdIF9jb2xzID0gbnVsbDsKICAg\nIHByaXZhdGUgQ29sdW1uW10gX2F1dG9Bc3NpZ24gPSBudWxsOwogICAgcHJp\ndmF0ZSBDb2x1bW5bXSBfcmVscyA9IG51bGw7CiAgICBwcml2YXRlIEZvcmVp\nZ25LZXlbXSBfZmtzID0gbnVsbDsKICAgIHByaXZhdGUgSW5kZXhbXSBfaWR4\ncyA9IG51bGw7CiAgICBwcml2YXRlIFVuaXF1ZVtdIF91bnFzID0gbnVsbDsK\nICAgIHByaXZhdGUgU3RyaW5nIF9jb21tZW50ID0gbnVsbDsKICAgIHByaXZh\ndGUgaW50IF9saW5lTnVtID0gMDsgIAogICAgcHJpdmF0ZSBpbnQgX2NvbE51\nbSA9IDA7CiAgICBwcml2YXRlIGJvb2xlYW4gX2lzQXNzb2NpYXRpb24gPSBm\nYWxzZTsKICAgIHByaXZhdGUgUXVhbGlmaWVkREJJZGVudGlmaWVyIF9mdWxs\nUGF0aCA9IG51bGw7CgogICAgLyoqCiAgICAgKiBEZWZhdWx0IGNvbnN0cnVj\ndG9yLgogICAgICovCiAgICBwdWJsaWMgVGFibGUoKSB7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBDb25zdHJ1Y3Rvci4KICAgICAqCiAgICAgKiBAcGFyYW0g\nbmFtZSB0aGUgdGFibGUgbmFtZQogICAgICogQHBhcmFtIHNjaGVtYSB0aGUg\ndGFibGUgc2NoZW1hCiAgICAgKiBAZGVwcmVjYXRlZAogICAgICovCiAgICBw\ndWJsaWMgVGFibGUoU3RyaW5nIG5hbWUsIFNjaGVtYSBzY2hlbWEpIHsKICAg\nICAgICB0aGlzKERCSWRlbnRpZmllci5uZXdUYWJsZShuYW1lKSwgc2NoZW1h\nKTsKICAgIH0KCiAgICBwdWJsaWMgVGFibGUoREJJZGVudGlmaWVyIG5hbWUs\nIFNjaGVtYSBzY2hlbWEpIHsKICAgICAgICBzZXRJZGVudGlmaWVyKG5hbWUp\nOwogICAgICAgIGFkZE5hbWUobmFtZSwgdHJ1ZSk7CiAgICAgICAgaWYgKHNj\naGVtYSAhPSBudWxsKQogICAgICAgICAgICBzZXRTY2hlbWFJZGVudGlmaWVy\nKHNjaGVtYS5nZXRJZGVudGlmaWVyKCkpOwogICAgICAgIF9zY2hlbWEgPSBz\nY2hlbWE7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0QXNzb2NpYXRpb24o\nKSB7CiAgICAgICAgX2lzQXNzb2NpYXRpb24gPSB0cnVlOwogICAgfQoKICAg\nIHB1YmxpYyBib29sZWFuIGlzQXNzb2NpYXRpb24oKSB7CiAgICAgICAgcmV0\ndXJuIF9pc0Fzc29jaWF0aW9uOwogICAgfQoKICAgIC8qKgogICAgICogQ2Fs\nbGVkIHdoZW4gdGhlIHRhYmxlIGlzIHJlbW92ZWQgZnJvbSBpdHMgc2NoZW1h\nLiBSZW1vdmVzIGFsbCB0YWJsZQogICAgICogbWVtYmVycywgYW5kIGludmFs\naWRhdGVzIHRoZSB0YWJsZS4KICAgICAqLwogICAgdm9pZCByZW1vdmUoKSB7\nCiAgICAgICAgRm9yZWlnbktleVtdIGZrcyA9IGdldEZvcmVpZ25LZXlzKCk7\nCiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBma3MubGVuZ3RoOyBpKysp\nCiAgICAgICAgICAgIHJlbW92ZUZvcmVpZ25LZXkoZmtzW2ldKTsKICAgICAg\nICBJbmRleFtdIGlkeHMgPSBnZXRJbmRleGVzKCk7CiAgICAgICAgZm9yIChp\nbnQgaSA9IDA7IGkgPCBpZHhzLmxlbmd0aDsgaSsrKQogICAgICAgICAgICBy\nZW1vdmVJbmRleChpZHhzW2ldKTsKICAgICAgICBVbmlxdWVbXSB1bnFzID0g\nZ2V0VW5pcXVlcygpOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgdW5x\ncy5sZW5ndGg7IGkrKykKICAgICAgICAgICAgcmVtb3ZlVW5pcXVlKHVucXNb\naV0pOwogICAgICAgIHJlbW92ZVByaW1hcnlLZXkoKTsKICAgICAgICBDb2x1\nbW5bXSBjb2xzID0gZ2V0Q29sdW1ucygpOwogICAgICAgIGZvciAoaW50IGkg\nPSAwOyBpIDwgY29scy5sZW5ndGg7IGkrKykKICAgICAgICAgICAgcmVtb3Zl\nQ29sdW1uKGNvbHNbaV0pOwogICAgICAgIF9zY2hlbWEgPSBudWxsOwogICAg\nICAgIF9zY2hlbWFOYW1lID0gREJJZGVudGlmaWVyLk5VTEw7CiAgICAgICAg\nX2Z1bGxQYXRoID0gbnVsbDsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVy\nbiB0aGUgc2NoZW1hIGZvciB0aGUgdGFibGUuCiAgICAgKi8KICAgIHB1Ymxp\nYyBTY2hlbWEgZ2V0U2NoZW1hKCkgewogICAgICAgIHJldHVybiBfc2NoZW1h\nOwogICAgfQoKICAgIC8qKgogICAgICogVGhlIHRhYmxlJ3Mgc2NoZW1hIG5h\nbWUuCiAgICAgKiBAZGVwcmVjYXRlZAogICAgICovCiAgICBwdWJsaWMgU3Ry\naW5nIGdldFNjaGVtYU5hbWUoKSB7CiAgICAgICAgcmV0dXJuIGdldFNjaGVt\nYUlkZW50aWZpZXIoKS5nZXROYW1lKCk7CiAgICB9CgogICAgcHVibGljIERC\nSWRlbnRpZmllciBnZXRTY2hlbWFJZGVudGlmaWVyKCkgewogICAgICAgIHJl\ndHVybiBfc2NoZW1hTmFtZSA9PSBudWxsID8gREJJZGVudGlmaWVyLk5VTEwg\nOiBfc2NoZW1hTmFtZTsKICAgIH0KCiAgICAvKioKICAgICAqIFRoZSB0YWJs\nZSdzIHNjaGVtYSBuYW1lLiBZb3UgY2FuIG9ubHkgY2FsbCB0aGlzIG1ldGhv\nZCBvbiB0YWJsZXMKICAgICAqIHdob3NlIHNjaGVtYSBvYmplY3QgaXMgbm90\nIHNldC4KICAgICAqIEBkZXByZWNhdGVkCiAgICAgKi8KICAgIHB1YmxpYyB2\nb2lkIHNldFNjaGVtYU5hbWUoU3RyaW5nIG5hbWUpIHsKICAgICAgICBzZXRT\nY2hlbWFJZGVudGlmaWVyKERCSWRlbnRpZmllci5uZXdTY2hlbWEobmFtZSkp\nOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldFNjaGVtYUlkZW50aWZpZXIo\nREJJZGVudGlmaWVyIG5hbWUpIHsKICAgICAgICBpZiAoZ2V0U2NoZW1hKCkg\nIT0gbnVsbCkKICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxTdGF0ZUV4\nY2VwdGlvbigpOwogICAgICAgIF9zY2hlbWFOYW1lID0gbmFtZTsKICAgICAg\nICBfZnVsbFBhdGggPSBudWxsOwogICAgfQoKICAgIC8qKgogICAgICogUmV0\ndXJuIHRoZSBuYW1lIG9mIHRoZSB0YWJsZS4KICAgICAqIEBkZXByZWNhdGVk\nCiAgICAgKi8KICAgIHB1YmxpYyBTdHJpbmcgZ2V0TmFtZSgpIHsKICAgICAg\nICByZXR1cm4gZ2V0SWRlbnRpZmllcigpLmdldE5hbWUoKTsKICAgIH0KICAg\nIAogICAgcHVibGljIERCSWRlbnRpZmllciBnZXRJZGVudGlmaWVyKCkgewog\nICAgICAgIHJldHVybiBfbmFtZSA9PSBudWxsID8gREJJZGVudGlmaWVyLk5V\nTEwgOiBfbmFtZTsKICAgIH0KCiAgICAvKioKICAgICAqIFNldCB0aGUgbmFt\nZSBvZiB0aGUgdGFibGUuIFRoaXMgbWV0aG9kIGNhbiBvbmx5IGJlIGNhbGxl\nZCBvbiB0YWJsZXMKICAgICAqIHRoYXQgYXJlIG5vdCBwYXJ0IG9mIGEgc2No\nZW1hLgogICAgICogQGRlcHJlY2F0ZWQKICAgICAqLwogICAgcHVibGljIHZv\naWQgc2V0TmFtZShTdHJpbmcgbmFtZSkgewogICAgICAgIHNldElkZW50aWZp\nZXIoREJJZGVudGlmaWVyLm5ld1RhYmxlKG5hbWUpKTsKICAgIH0KCiAgICBw\ndWJsaWMgdm9pZCBzZXRJZGVudGlmaWVyKERCSWRlbnRpZmllciBuYW1lKSB7\nCiAgICAgICAgaWYgKGdldFNjaGVtYSgpICE9IG51bGwpCiAgICAgICAgICAg\nIHRocm93IG5ldyBJbGxlZ2FsU3RhdGVFeGNlcHRpb24oKTsKICAgICAgICBf\nbmFtZSA9IG5hbWU7CiAgICAgICAgX2Z1bGxQYXRoID0gbnVsbDsKICAgIH0K\nCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgdGFibGUgbmFtZSwgaW5jbHVk\naW5nIHNjaGVtYSwgdXNpbmcgJy4nIGFzIHRoZQogICAgICogY2F0YWxvZyBz\nZXBhcmF0b3IuCiAgICAgKiBAZGVwcmVjYXRlZAogICAgICovCiAgICBwdWJs\naWMgU3RyaW5nIGdldEZ1bGxOYW1lKCkgewogICAgICAgIHJldHVybiBnZXRG\ndWxsSWRlbnRpZmllcigpLmdldE5hbWUoKTsKICAgIH0KICAgIAogICAgcHVi\nbGljIFF1YWxpZmllZERCSWRlbnRpZmllciBnZXRRdWFsaWZpZWRQYXRoKCkg\newogICAgICAgIGlmIChfZnVsbFBhdGggID09IG51bGwpIHsKICAgICAgICAg\nICAgX2Z1bGxQYXRoID0gUXVhbGlmaWVkREJJZGVudGlmaWVyLm5ld1BhdGgo\nX3NjaGVtYU5hbWUsIF9uYW1lICk7CiAgICAgICAgfQogICAgICAgIHJldHVy\nbiBfZnVsbFBhdGg7CiAgICB9CiAgICAKICAgIHB1YmxpYyBEQklkZW50aWZp\nZXIgZ2V0RnVsbElkZW50aWZpZXIoKSB7CiAgICAgICAgcmV0dXJuIGdldFF1\nYWxpZmllZFBhdGgoKS5nZXRJZGVudGlmaWVyKCk7CiAgICB9CgogICAgcHVi\nbGljIEZpbGUgZ2V0U291cmNlRmlsZSgpIHsKICAgICAgICByZXR1cm4gX3Nv\ndXJjZTsKICAgIH0KCiAgICBwdWJsaWMgT2JqZWN0IGdldFNvdXJjZVNjb3Bl\nKCkgewogICAgICAgIHJldHVybiBudWxsOwogICAgfQoKICAgIHB1YmxpYyBp\nbnQgZ2V0U291cmNlVHlwZSgpIHsKICAgICAgICByZXR1cm4gX3NyY1R5cGU7\nCiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0U291cmNlKEZpbGUgc291cmNl\nLCBpbnQgc3JjVHlwZSkgewogICAgICAgIF9zb3VyY2UgPSBzb3VyY2U7CiAg\nICAgICAgX3NyY1R5cGUgPSBzcmNUeXBlOwogICAgfQoKICAgIHB1YmxpYyBT\ndHJpbmcgZ2V0UmVzb3VyY2VOYW1lKCkgewogICAgICAgIHJldHVybiBnZXRG\ndWxsSWRlbnRpZmllcigpLmdldE5hbWUoKTsKICAgIH0KCiAgICAvKioKICAg\nICAqIFJldHVybiB0aGUgdGFibGUncyBjb2x1bW5zLCBpbiBhbHBoYWJldGlj\nYWwgb3JkZXIuCiAgICAgKi8KICAgIHB1YmxpYyBDb2x1bW5bXSBnZXRDb2x1\nbW5zKCkgewogICAgICAgIGlmIChfY29scyA9PSBudWxsKSB7CiAgICAgICAg\nICAgIGlmIChfY29sTWFwID09IG51bGwpCiAgICAgICAgICAgICAgICBfY29s\ncyA9IFNjaGVtYXMuRU1QVFlfQ09MVU1OUzsKICAgICAgICAgICAgZWxzZSB7\nCiAgICAgICAgICAgICAgICBDb2x1bW5bXSBjb2xzID0gbmV3IENvbHVtbltf\nY29sTWFwLnNpemUoKV07CiAgICAgICAgICAgICAgICBJdGVyYXRvcjxDb2x1\nbW4+IGl0ciA9IF9jb2xNYXAudmFsdWVzKCkuaXRlcmF0b3IoKTsKICAgICAg\nICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBpdHIuaGFzTmV4dCgpOyBpKysp\nIHsKICAgICAgICAgICAgICAgICAgICBjb2xzW2ldID0gKENvbHVtbikgaXRy\nLm5leHQoKTsKICAgICAgICAgICAgICAgICAgICBjb2xzW2ldLnNldEluZGV4\nKGkpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgX2NvbHMg\nPSBjb2xzOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVy\nbiBfY29sczsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0aGlzIHRh\nYmxlJ3MgYXV0by1hc3NpZ25lZCBjb2x1bW5zLgogICAgICovCiAgICBwdWJs\naWMgQ29sdW1uW10gZ2V0QXV0b0Fzc2lnbmVkQ29sdW1ucygpIHsKICAgICAg\nICBpZiAoX2F1dG9Bc3NpZ24gPT0gbnVsbCkgewogICAgICAgICAgICBpZiAo\nX2NvbE1hcCA9PSBudWxsKQogICAgICAgICAgICAgICAgX2F1dG9Bc3NpZ24g\nPSBTY2hlbWFzLkVNUFRZX0NPTFVNTlM7CiAgICAgICAgICAgIGVsc2Ugewog\nICAgICAgICAgICAgICAgQ29sbGVjdGlvbjxDb2x1bW4+IGF1dG9zID0gbnVs\nbDsKICAgICAgICAgICAgICAgIENvbHVtbltdIGNvbHMgPSBnZXRDb2x1bW5z\nKCk7CiAgICAgICAgICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGNvbHMu\nbGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICAgICAgICBpZiAoY29sc1tp\nXS5pc0F1dG9Bc3NpZ25lZCgpKSB7CiAgICAgICAgICAgICAgICAgICAgICAg\nIGlmIChhdXRvcyA9PSBudWxsKQogICAgICAgICAgICAgICAgICAgICAgICAg\nICAgYXV0b3MgPSBuZXcgQXJyYXlMaXN0PENvbHVtbj4oMyk7CiAgICAgICAg\nICAgICAgICAgICAgICAgIGF1dG9zLmFkZChjb2xzW2ldKTsKICAgICAgICAg\nICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAg\nICBfYXV0b0Fzc2lnbiA9IChhdXRvcyA9PSBudWxsKSA/IFNjaGVtYXMuRU1Q\nVFlfQ09MVU1OUwogICAgICAgICAgICAgICAgICAgIDogKENvbHVtbltdKSBh\ndXRvcy50b0FycmF5KG5ldyBDb2x1bW5bYXV0b3Muc2l6ZSgpXSk7CiAgICAg\nICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIF9hdXRvQXNzaWdu\nOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRoaXMgdGFibGUncyBy\nZWxhdGlvbiBpZCBjb2x1bW5zLgogICAgICovCiAgICBwdWJsaWMgQ29sdW1u\nW10gZ2V0UmVsYXRpb25JZENvbHVtbnMoKSB7CiAgICAgICAgaWYgKF9yZWxz\nID09IG51bGwpIHsKICAgICAgICAgICAgaWYgKF9jb2xNYXAgPT0gbnVsbCkK\nICAgICAgICAgICAgICAgIF9yZWxzID0gU2NoZW1hcy5FTVBUWV9DT0xVTU5T\nOwogICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgIENvbGxlY3Rp\nb248Q29sdW1uPiByZWxzID0gbnVsbDsKICAgICAgICAgICAgICAgIENvbHVt\nbltdIGNvbHMgPSBnZXRDb2x1bW5zKCk7CiAgICAgICAgICAgICAgICBmb3Ig\nKGludCBpID0gMDsgaSA8IGNvbHMubGVuZ3RoOyBpKyspIHsKICAgICAgICAg\nICAgICAgICAgICBpZiAoY29sc1tpXS5pc1JlbGF0aW9uSWQoKSkgewogICAg\nICAgICAgICAgICAgICAgICAgICBpZiAocmVscyA9PSBudWxsKQogICAgICAg\nICAgICAgICAgICAgICAgICAgICAgcmVscyA9IG5ldyBBcnJheUxpc3Q8Q29s\ndW1uPigzKTsKICAgICAgICAgICAgICAgICAgICAgICAgcmVscy5hZGQoY29s\nc1tpXSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAg\nfQogICAgICAgICAgICAgICAgX3JlbHMgPSAocmVscyA9PSBudWxsKSA/IFNj\naGVtYXMuRU1QVFlfQ09MVU1OUwogICAgICAgICAgICAgICAgICAgIDogKENv\nbHVtbltdKSByZWxzLnRvQXJyYXkobmV3IENvbHVtbltyZWxzLnNpemUoKV0p\nOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiBfcmVs\nczsKICAgIH0KCiAgICBwdWJsaWMgU3RyaW5nW10gZ2V0Q29sdW1uTmFtZXMo\nKSB7CiAgICAgICAgaWYgKF9jb2xNYXAgPT0gbnVsbCkgewogICAgICAgICAg\nICByZXR1cm4gbmV3IFN0cmluZ1swXTsKICAgICAgICB9CiAgICAgICAgREJJ\nZGVudGlmaWVyW10gc05hbWVzID0gKERCSWRlbnRpZmllcltdKV9jb2xNYXAu\na2V5U2V0KCkudG9BcnJheShuZXcgREJJZGVudGlmaWVyW19jb2xNYXAuc2l6\nZSgpXSk7IAogICAgICAgIHJldHVybiBEQklkZW50aWZpZXIudG9TdHJpbmdB\ncnJheShzTmFtZXMpOwogICAgfQogICAgCiAgICAvKioKICAgICAqIFJldHVy\nbiB0aGUgY29sdW1uIHdpdGggdGhlIGdpdmVuIG5hbWUsIG9yIG51bGwgaWYg\nbm9uZS4KICAgICAqIEBkZXByZWNhdGVkCiAgICAgKi8KICAgIHB1YmxpYyBD\nb2x1bW4gZ2V0Q29sdW1uKFN0cmluZyBuYW1lKSB7CiAgICAgICAgcmV0dXJu\nIGdldENvbHVtbihEQklkZW50aWZpZXIubmV3SWRlbnRpZmllcihuYW1lLCBE\nQklkZW50aWZpZXJUeXBlLkNPTFVNTiwgdHJ1ZSkpOwogICAgfQoKICAgIHB1\nYmxpYyBDb2x1bW4gZ2V0Q29sdW1uKERCSWRlbnRpZmllciBuYW1lKSB7CiAg\nICAgICAgaWYgKERCSWRlbnRpZmllci5pc051bGwobmFtZSkgfHwgX2NvbE1h\ncCA9PSBudWxsKQogICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICBy\nZXR1cm4gX2NvbE1hcC5nZXQoREJJZGVudGlmaWVyLnRvVXBwZXIobmFtZSkp\nOwogICAgfQoKICAgIAogICAgLyoqCiAgICAgKiBBZmZpcm1zIGlmIHRoaXMg\ndGFibGUgY29udGFpbnMgdGhlIGNvbHVtbiBvZiB0aGUgZ2l2ZW4gbmFtZSB3\naXRob3V0IGFueSAKICAgICAqIHNpZGUtZWZmZWN0LiAKICAgICAqIEBzZWUg\nVGFibGUjZ2V0Q29sdW1uKFN0cmluZykgY2FuIGhhdmUgc2lkZS1lZmZlY3Qg\nb2YgY3JlYXRpbmcgYSBjb2x1bW4KICAgICAqIGZvciBkeW5hbWljIHRhYmxl\nIGltcGxlbWVudGF0aW9uLgogICAgICogQGRlcHJlY2F0ZWQKICAgICAqLwog\nICAgcHVibGljIGJvb2xlYW4gY29udGFpbnNDb2x1bW4oU3RyaW5nIG5hbWUp\nIHsKICAgICAgICByZXR1cm4gY29udGFpbnNDb2x1bW4oREJJZGVudGlmaWVy\nLm5ld0NvbHVtbihuYW1lKSwgbnVsbCk7CiAgICB9CiAgICAKICAgIHB1Ymxp\nYyBib29sZWFuIGNvbnRhaW5zQ29sdW1uKERCSWRlbnRpZmllciBuYW1lKSB7\nCiAgICAgICAgcmV0dXJuIGNvbnRhaW5zQ29sdW1uKG5hbWUsIG51bGwpOwog\nICAgfQoKICAgIC8qKgogICAgICogQWZmaXJtcyBpZiB0aGlzIHRhYmxlIGNv\nbnRhaW5zIHRoZSBjb2x1bW4gb2YgdGhlIGdpdmVuIG5hbWUgd2l0aG91dCBh\nbnkgCiAgICAgKiBzaWRlLWVmZmVjdC4gCiAgICAgKiBAcGFyYW0gZGljdCB0\naGUgY3VycmVudCBkYXRhYmFzZSBkaWN0aW9uYXJ5IG9yIG51bGwuCiAgICAg\nKiBAc2VlIFRhYmxlI2dldENvbHVtbihTdHJpbmcpIGNhbiBoYXZlIHNpZGUt\nZWZmZWN0IG9mIGNyZWF0aW5nIGEgY29sdW1uCiAgICAgKiBmb3IgZHluYW1p\nYyB0YWJsZSBpbXBsZW1lbnRhdGlvbi4KICAgICAqIEBkZXByZWNhdGVkCiAg\nICAgKi8KICAgIHB1YmxpYyBib29sZWFuIGNvbnRhaW5zQ29sdW1uKFN0cmlu\nZyBuYW1lLCBEQkRpY3Rpb25hcnkgZGljdCkgewogICAgICAgIGlmIChuYW1l\nID09IG51bGwgfHwgX2NvbE1hcCA9PSBudWxsKSB7CiAgICAgICAgICAgIHJl\ndHVybiBmYWxzZTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGNvbnRhaW5z\nQ29sdW1uKERCSWRlbnRpZmllci5uZXdJZGVudGlmaWVyKG5hbWUsIERCSWRl\nbnRpZmllclR5cGUuQ09MVU1OLCB0cnVlKSk7CiAgICB9CgogICAgcHVibGlj\nIGJvb2xlYW4gY29udGFpbnNDb2x1bW4oREJJZGVudGlmaWVyIG5hbWUsIERC\nRGljdGlvbmFyeSBkaWN0KSB7CiAgICAgICAgaWYgKERCSWRlbnRpZmllci5p\nc051bGwobmFtZSkgfHwgX2NvbE1hcCA9PSBudWxsKSB7CiAgICAgICAgICAg\nIHJldHVybiBmYWxzZTsKICAgICAgICB9CiAgICAgICAgREJJZGVudGlmaWVy\nIHNOYW1lID0gREJJZGVudGlmaWVyLnRvVXBwZXIobmFtZSk7CiAgICAgICAg\ncmV0dXJuIF9jb2xNYXAuY29udGFpbnNLZXkoc05hbWUpOwogICAgfQoKICAg\nIC8qKgogICAgICogQWRkIGEgY29sdW1uIHRvIHRoZSB0YWJsZS4KICAgICAq\nIEBkZXByZWNhdGVkCiAgICAgKi8KICAgIHB1YmxpYyBDb2x1bW4gYWRkQ29s\ndW1uKFN0cmluZyBuYW1lKSB7CiAgICAgICAgcmV0dXJuIGFkZENvbHVtbihE\nQklkZW50aWZpZXIubmV3Q29sdW1uKG5hbWUpKTsKICAgIH0KCiAgICBwdWJs\naWMgQ29sdW1uIGFkZENvbHVtbihEQklkZW50aWZpZXIgbmFtZSkgewogICAg\nICAgIGFkZE5hbWUobmFtZSwgdHJ1ZSk7CiAgICAgICAgU2NoZW1hIHNjaGVt\nYSA9IGdldFNjaGVtYSgpOwogICAgICAgIENvbHVtbiBjb2w7CiAgICAgICAg\naWYgKHNjaGVtYSAhPSBudWxsICYmIHNjaGVtYS5nZXRTY2hlbWFHcm91cCgp\nICE9IG51bGwpIHsKICAgICAgICAgICAgY29sID0gc2NoZW1hLmdldFNjaGVt\nYUdyb3VwKCkubmV3Q29sdW1uKG5hbWUsIHRoaXMpOwogICAgICAgIH0gZWxz\nZSB7CiAgICAgICAgICAgIGNvbCA9IG5ldyBDb2x1bW4obmFtZSwgdGhpcyk7\nCiAgICAgICAgfQogICAgICAgIGlmIChfY29sTWFwID09IG51bGwpCiAgICAg\nICAgICAgIF9jb2xNYXAgPSBuZXcgTGlua2VkSGFzaE1hcDxEQklkZW50aWZp\nZXIsIENvbHVtbj4oKTsKICAgICAgICBEQklkZW50aWZpZXIgc05hbWUgPSBE\nQklkZW50aWZpZXIudG9VcHBlcihuYW1lKTsKICAgICAgICBfY29sTWFwLnB1\ndChzTmFtZSwgY29sKTsKICAgICAgICBfY29scyA9IG51bGw7CiAgICAgICAg\ncmV0dXJuIGNvbDsKICAgIH0KCgogICAgLyoqCiAgICAgKiBBZGQgYSBjb2x1\nbW4gd2l0aCBhIHNob3J0ZW5lZCAoaS5lLiwgdmFsaWRhdGVkKSBuYW1lIHRv\nIHRoZSB0YWJsZQogICAgICogQGRlcHJlY2F0ZWQKICAgICAqLwogICAgcHVi\nbGljIENvbHVtbiBhZGRDb2x1bW4oU3RyaW5nIG5hbWUsIFN0cmluZyB2YWxp\nZE5hbWUpIHsKICAgICAgICByZXR1cm4gYWRkQ29sdW1uKERCSWRlbnRpZmll\nci5uZXdDb2x1bW4obmFtZSksIERCSWRlbnRpZmllci5uZXdDb2x1bW4odmFs\naWROYW1lKSk7CiAgICB9CgogICAgcHVibGljIENvbHVtbiBhZGRDb2x1bW4o\nREJJZGVudGlmaWVyIG5hbWUsIERCSWRlbnRpZmllciB2YWxpZE5hbWUpIHsK\nICAgICAgICBhZGROYW1lKG5hbWUsIHRydWUpOwogICAgICAgIFNjaGVtYSBz\nY2hlbWEgPSBnZXRTY2hlbWEoKTsKICAgICAgICBDb2x1bW4gY29sOwogICAg\nICAgIGlmIChzY2hlbWEgIT0gbnVsbCAmJiBzY2hlbWEuZ2V0U2NoZW1hR3Jv\ndXAoKSAhPSBudWxsKQogICAgICAgICAgICBjb2wgPSBzY2hlbWEuZ2V0U2No\nZW1hR3JvdXAoKS5uZXdDb2x1bW4odmFsaWROYW1lLCB0aGlzKTsKICAgICAg\nICBlbHNlCiAgICAgICAgICAgIGNvbCA9IG5ldyBDb2x1bW4odmFsaWROYW1l\nLCB0aGlzKTsKICAgICAgICBpZiAoX2NvbE1hcCA9PSBudWxsKQogICAgICAg\nICAgICBfY29sTWFwID0gbmV3IExpbmtlZEhhc2hNYXA8REJJZGVudGlmaWVy\nLCBDb2x1bW4+KCk7CiAgICAgICAgREJJZGVudGlmaWVyIHNOYW1lID0gREJJ\nZGVudGlmaWVyLnRvVXBwZXIobmFtZSk7CiAgICAgICAgX2NvbE1hcC5wdXQo\nc05hbWUsIGNvbCk7CiAgICAgICAgX2NvbHMgPSBudWxsOwogICAgICAgIHJl\ndHVybiBjb2w7CiAgICB9CgogICAgLyoqCiAgICAgKiBBZGQgYSBuYW1lIHRv\nIHRoaXMgTmFtZVNldAogICAgICogQGRlcHJlY2F0ZWQKICAgICAqLwogICAg\ncHVibGljIHZvaWQgYWRkQ29ycmVjdGVkQ29sdW1uTmFtZShTdHJpbmcgbmFt\nZSwgYm9vbGVhbiB2YWxpZGF0ZSkgewogICAgICAgIGFkZE5hbWUoREJJZGVu\ndGlmaWVyLm5ld0NvbHVtbihuYW1lKSwgdmFsaWRhdGUpOwogICAgfQoKICAg\nIHB1YmxpYyB2b2lkIGFkZENvcnJlY3RlZENvbHVtbk5hbWUoREJJZGVudGlm\naWVyIG5hbWUsIGJvb2xlYW4gdmFsaWRhdGUpIHsKICAgICAgICBhZGROYW1l\nKG5hbWUsIHZhbGlkYXRlKTsKICAgIH0KCgogICAgLyoqCiAgICAgKiBSZW1v\ndmUgdGhlIGdpdmVuIGNvbHVtbiBmcm9tIHRoZSB0YWJsZS4KICAgICAqCiAg\nICAgKiBAcmV0dXJuIHRydWUgaWYgdGhlIGNvbHVtbiB3YXMgcmVtb3ZlZCwg\nZmFsc2UgaWYgbm90IGluIHRoZSB0YWJsZQogICAgICovCiAgICBwdWJsaWMg\nYm9vbGVhbiByZW1vdmVDb2x1bW4oQ29sdW1uIGNvbCkgewogICAgICAgIGlm\nIChjb2wgPT0gbnVsbCB8fCBfY29sTWFwID09IG51bGwpCiAgICAgICAgICAg\nIHJldHVybiBmYWxzZTsKCiAgICAgICAgREJJZGVudGlmaWVyIHNOYW1lID0g\nREJJZGVudGlmaWVyLnRvVXBwZXIoY29sLmdldElkZW50aWZpZXIoKSk7CiAg\nICAgICAgQ29sdW1uIGN1ciA9IChDb2x1bW4pIF9jb2xNYXAuZ2V0KHNOYW1l\nKTsKICAgICAgICBpZiAoIWNvbC5lcXVhbHMoY3VyKSkKICAgICAgICAgICAg\ncmV0dXJuIGZhbHNlOwoKICAgICAgICByZW1vdmVOYW1lKHNOYW1lKTsKICAg\nICAgICBfY29sTWFwLnJlbW92ZShzTmFtZSk7CiAgICAgICAgX2NvbHMgPSBu\ndWxsOwogICAgICAgIGlmIChjb2wuaXNBdXRvQXNzaWduZWQoKSkKICAgICAg\nICAgICAgX2F1dG9Bc3NpZ24gPSBudWxsOwogICAgICAgIGlmIChjb2wuaXNS\nZWxhdGlvbklkKCkpCiAgICAgICAgICAgIF9yZWxzID0gbnVsbDsKICAgICAg\nICBjb2wucmVtb3ZlKCk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBJbXBvcnQgYSBjb2x1bW4gZnJvbSBhbm90aGVyIHRh\nYmxlLgogICAgICovCiAgICBwdWJsaWMgQ29sdW1uIGltcG9ydENvbHVtbihD\nb2x1bW4gY29sKSB7CiAgICAgICAgaWYgKGNvbCA9PSBudWxsKQogICAgICAg\nICAgICByZXR1cm4gbnVsbDsKCiAgICAgICAgQ29sdW1uIGNvcHkgPSBhZGRD\nb2x1bW4oY29sLmdldElkZW50aWZpZXIoKSk7CiAgICAgICAgY29weS5zZXRU\neXBlKGNvbC5nZXRUeXBlKCkpOwogICAgICAgIGNvcHkuc2V0VHlwZUlkZW50\naWZpZXIoY29sLmdldFR5cGVJZGVudGlmaWVyKCkpOwogICAgICAgIGNvcHku\nc2V0SmF2YVR5cGUoY29sLmdldEphdmFUeXBlKCkpOwogICAgICAgIGNvcHku\nc2V0Tm90TnVsbChjb2wuaXNOb3ROdWxsKCkpOwogICAgICAgIGNvcHkuc2V0\nRGVmYXVsdFN0cmluZyhjb2wuZ2V0RGVmYXVsdFN0cmluZygpKTsKICAgICAg\nICBjb3B5LnNldFNpemUoY29sLmdldFNpemUoKSk7CiAgICAgICAgY29weS5z\nZXREZWNpbWFsRGlnaXRzKGNvbC5nZXREZWNpbWFsRGlnaXRzKCkpOwogICAg\nICAgIGNvcHkuc2V0QXV0b0Fzc2lnbmVkKGNvbC5pc0F1dG9Bc3NpZ25lZCgp\nKTsKICAgICAgICByZXR1cm4gY29weTsKICAgIH0KCiAgICAvKioKICAgICAq\nIFJldHVybiB0aGUgcHJpbWFyeSBrZXkgZm9yIHRoZSB0YWJsZSwgaWYgYW55\nLgogICAgICovCiAgICBwdWJsaWMgUHJpbWFyeUtleSBnZXRQcmltYXJ5S2V5\nKCkgewogICAgICAgIHJldHVybiBfcGs7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBTZXQgdGhlIHByaW1hcnkga2V5IGZvciB0aGUgdGFibGUuCiAgICAgKi8K\nICAgIHB1YmxpYyBQcmltYXJ5S2V5IGFkZFByaW1hcnlLZXkoKSB7CiAgICAg\nICAgcmV0dXJuIGFkZFByaW1hcnlLZXkoREJJZGVudGlmaWVyLk5VTEwpOwog\nICAgfQoKICAgIC8qKgogICAgICogU2V0IHRoZSBwcmltYXJ5IGtleSBmb3Ig\ndGhlIHRhYmxlLgogICAgICogQGRlcHJlY2F0ZWQKICAgICAqLwogICAgcHVi\nbGljIFByaW1hcnlLZXkgYWRkUHJpbWFyeUtleShTdHJpbmcgbmFtZSkgewog\nICAgICAgIHJldHVybiBhZGRQcmltYXJ5S2V5KERCSWRlbnRpZmllci5uZXdD\nb25zdHJhaW50KG5hbWUpKTsKICAgIH0KCiAgICBwdWJsaWMgUHJpbWFyeUtl\neSBhZGRQcmltYXJ5S2V5KERCSWRlbnRpZmllciBuYW1lKSB7CiAgICAgICAg\nU2NoZW1hIHNjaGVtYSA9IGdldFNjaGVtYSgpOwogICAgICAgIGlmIChzY2hl\nbWEgIT0gbnVsbCAmJiBzY2hlbWEuZ2V0U2NoZW1hR3JvdXAoKSAhPSBudWxs\nKSB7CiAgICAgICAgICAgIHNjaGVtYS5nZXRTY2hlbWFHcm91cCgpLmFkZE5h\nbWUobmFtZSwgZmFsc2UpOwogICAgICAgICAgICBfcGsgPSBzY2hlbWEuZ2V0\nU2NoZW1hR3JvdXAoKS5uZXdQcmltYXJ5S2V5KG5hbWUsIHRoaXMpOwogICAg\nICAgIH0gZWxzZQogICAgICAgICAgICBfcGsgPSBuZXcgUHJpbWFyeUtleShu\nYW1lLCB0aGlzKTsKICAgICAgICByZXR1cm4gX3BrOwogICAgfQoKICAgIC8q\nKgogICAgICogUmVtb3ZlIHRoZSBwcmltYXJ5IGtleSBmcm9tIHRoaXMgdGFi\nbGUuCiAgICAgKgogICAgICogQHJldHVybiB0cnVlIGlmIHRoZXJlIHdhcyBh\nIHBrIHRvIHJlbW92ZSwgZmFsc2Ugb3RoZXJ3aXNlCiAgICAgKi8KICAgIHB1\nYmxpYyBib29sZWFuIHJlbW92ZVByaW1hcnlLZXkoKSB7CiAgICAgICAgYm9v\nbGVhbiByZW0gPSBfcGsgIT0gbnVsbDsKICAgICAgICBpZiAocmVtKSB7CiAg\nICAgICAgICAgIFNjaGVtYSBzY2hlbWEgPSBnZXRTY2hlbWEoKTsKICAgICAg\nICAgICAgaWYgKHNjaGVtYSAhPSBudWxsICYmIHNjaGVtYS5nZXRTY2hlbWFH\ncm91cCgpICE9IG51bGwpCiAgICAgICAgICAgICAgICBzY2hlbWEuZ2V0U2No\nZW1hR3JvdXAoKS5yZW1vdmVOYW1lKF9way5nZXRJZGVudGlmaWVyKCkpOwog\nICAgICAgICAgICBfcGsucmVtb3ZlKCk7CiAgICAgICAgfQogICAgICAgIF9w\nayA9IG51bGw7CiAgICAgICAgcmV0dXJuIHJlbTsKICAgIH0KCiAgICAvKioK\nICAgICAqIEltcG9ydCBhIHByaW1hcnkga2V5OyBjb2x1bW4gbmFtZXMgbXVz\ndCBtYXRjaCBjb2x1bW5zIG9mIHRoaXMgdGFibGUuCiAgICAgKi8KICAgIHB1\nYmxpYyBQcmltYXJ5S2V5IGltcG9ydFByaW1hcnlLZXkoUHJpbWFyeUtleSBw\naykgewogICAgICAgIGlmIChwayA9PSBudWxsKQogICAgICAgICAgICByZXR1\ncm4gbnVsbDsKCiAgICAgICAgUHJpbWFyeUtleSBjb3B5ID0gYWRkUHJpbWFy\neUtleShway5nZXRJZGVudGlmaWVyKCkpOwogICAgICAgIGNvcHkuc2V0TG9n\naWNhbChway5pc0xvZ2ljYWwoKSk7CiAgICAgICAgQ29sdW1uW10gY29scyA9\nIHBrLmdldENvbHVtbnMoKTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8\nIGNvbHMubGVuZ3RoOyBpKyspCiAgICAgICAgICAgIGNvcHkuYWRkQ29sdW1u\nKGdldENvbHVtbihjb2xzW2ldLmdldElkZW50aWZpZXIoKSkpOwogICAgICAg\nIHJldHVybiBjb3B5OwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRo\nZSBmb3JlaWduIGtleSB3aXRoIHRoZSBnaXZlbiBuYW1lLiBJZiBtdWx0aXBs\nZSBmb3JlaWduIGtleXMKICAgICAqIGhhdmUgdGhlIG5hbWUsIHRoZSBmaXJz\ndCBtYXRjaCBpcyByZXR1cm5lZC4KICAgICAqIEBkZXByZWNhdGVkCiAgICAg\nKi8KICAgIHB1YmxpYyBGb3JlaWduS2V5IGdldEZvcmVpZ25LZXkoU3RyaW5n\nIG5hbWUpIHsKICAgICAgICByZXR1cm4gZ2V0Rm9yZWlnbktleShEQklkZW50\naWZpZXIubmV3Rm9yZWlnbktleShuYW1lKSk7CiAgICB9CgogICAgcHVibGlj\nIEZvcmVpZ25LZXkgZ2V0Rm9yZWlnbktleShEQklkZW50aWZpZXIgbmFtZSkg\newogICAgICAgIEZvcmVpZ25LZXlbXSBma3MgPSBnZXRGb3JlaWduS2V5cygp\nOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgZmtzLmxlbmd0aDsgaSsr\nKSB7CiAgICAgICAgICAgIGlmIChuYW1lLmVxdWFscyhma3NbaV0uZ2V0SWRl\nbnRpZmllcigpKSkgewogICAgICAgICAgICAgICAgcmV0dXJuIGZrc1tpXTsK\nICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4gbnVsbDsK\nICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiBhbGwgZm9yZWlnbiBrZXlz\nIGZvciB0aGUgdGFibGUuCiAgICAgKi8KICAgIHB1YmxpYyBGb3JlaWduS2V5\nW10gZ2V0Rm9yZWlnbktleXMoKSB7CiAgICAgICAgaWYgKF9ma3MgPT0gbnVs\nbCkgewogICAgICAgICAgICBpZiAoX2ZrTGlzdCA9PSBudWxsKQogICAgICAg\nICAgICAgICAgX2ZrcyA9IFNjaGVtYXMuRU1QVFlfRk9SRUlHTl9LRVlTOwog\nICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgIEZvcmVpZ25LZXlb\nXSBma3MgPSBuZXcgRm9yZWlnbktleVtfZmtMaXN0LnNpemUoKV07CiAgICAg\nICAgICAgICAgICBJdGVyYXRvcjxGb3JlaWduS2V5PiBpdHIgPSBfZmtMaXN0\nLml0ZXJhdG9yKCk7CiAgICAgICAgICAgICAgICBmb3IgKGludCBpID0gMDsg\naXRyLmhhc05leHQoKTsgaSsrKSB7CiAgICAgICAgICAgICAgICAgICAgZmtz\nW2ldID0gKEZvcmVpZ25LZXkpIGl0ci5uZXh0KCk7CiAgICAgICAgICAgICAg\nICAgICAgZmtzW2ldLnNldEluZGV4KGkpOwogICAgICAgICAgICAgICAgfQog\nICAgICAgICAgICAgICAgX2ZrcyA9IGZrczsKICAgICAgICAgICAgfQogICAg\nICAgIH0KICAgICAgICByZXR1cm4gX2ZrczsKICAgIH0KCiAgICAvKioKICAg\nICAqIEFkZCBhIGZvcmVpZ24ga2V5IHRvIHRoZSB0YWJsZS4KICAgICAqLwog\nICAgcHVibGljIEZvcmVpZ25LZXkgYWRkRm9yZWlnbktleSgpIHsKICAgICAg\nICByZXR1cm4gYWRkRm9yZWlnbktleShEQklkZW50aWZpZXIuTlVMTCk7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBBZGQgYSBmb3JlaWduIGtleSB0byB0aGUg\ndGFibGUuIER1cGxpY2F0ZSBrZXkgbmFtZXMgYXJlIG5vdCBhbGxvd2VkLgog\nICAgICogQGRlcHJlY2F0ZWQKICAgICAqLwogICAgcHVibGljIEZvcmVpZ25L\nZXkgYWRkRm9yZWlnbktleShTdHJpbmcgbmFtZSkgewogICAgICAgIHJldHVy\nbiBhZGRGb3JlaWduS2V5KERCSWRlbnRpZmllci5uZXdGb3JlaWduS2V5KG5h\nbWUpKTsKICAgIH0KCiAgICBwdWJsaWMgRm9yZWlnbktleSBhZGRGb3JlaWdu\nS2V5KERCSWRlbnRpZmllciBuYW1lKSB7CiAgICAgICAgU2NoZW1hIHNjaGVt\nYSA9IGdldFNjaGVtYSgpOwogICAgICAgIEZvcmVpZ25LZXkgZms7CiAgICAg\nICAgaWYgKHNjaGVtYSAhPSBudWxsICYmIHNjaGVtYS5nZXRTY2hlbWFHcm91\ncCgpICE9IG51bGwpIHsKICAgICAgICAgICAgc2NoZW1hLmdldFNjaGVtYUdy\nb3VwKCkuYWRkTmFtZShuYW1lLCBmYWxzZSk7CiAgICAgICAgICAgIGZrID0g\nc2NoZW1hLmdldFNjaGVtYUdyb3VwKCkubmV3Rm9yZWlnbktleShuYW1lLCB0\naGlzKTsKICAgICAgICB9IGVsc2UKICAgICAgICAgICAgZmsgPSBuZXcgRm9y\nZWlnbktleShuYW1lLCB0aGlzKTsKICAgICAgICBpZiAoX2ZrTGlzdCA9PSBu\ndWxsKQogICAgICAgICAgICBfZmtMaXN0ID0gbmV3IEFycmF5TGlzdDxGb3Jl\naWduS2V5PigzKTsKICAgICAgICBfZmtMaXN0LmFkZChmayk7CiAgICAgICAg\nX2ZrcyA9IG51bGw7CiAgICAgICAgcmV0dXJuIGZrOwogICAgfQoKICAgIC8q\nKgogICAgICogUmVtb3ZlIHRoZSBnaXZlbiBmb3JlaWduIGtleSBmcm9tIHRo\nZSB0YWJsZS4KICAgICAqCiAgICAgKiBAcmV0dXJuIHRydWUgaWYgdGhlIGtl\neSB3YXMgcmVtb3ZlZCwgZmFsc2UgaWYgbm90IGluIHRoZSB0YWJsZQogICAg\nICovCiAgICBwdWJsaWMgYm9vbGVhbiByZW1vdmVGb3JlaWduS2V5KEZvcmVp\nZ25LZXkgZmspIHsKICAgICAgICBpZiAoZmsgPT0gbnVsbCB8fCBfZmtMaXN0\nID09IG51bGwpCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCiAgICAgICAg\naWYgKCFfZmtMaXN0LnJlbW92ZShmaykpCiAgICAgICAgICAgIHJldHVybiBm\nYWxzZTsKCiAgICAgICAgU2NoZW1hIHNjaGVtYSA9IGdldFNjaGVtYSgpOwog\nICAgICAgIGlmIChzY2hlbWEgIT0gbnVsbCAmJiBzY2hlbWEuZ2V0U2NoZW1h\nR3JvdXAoKSAhPSBudWxsKQogICAgICAgICAgICBzY2hlbWEuZ2V0U2NoZW1h\nR3JvdXAoKS5yZW1vdmVOYW1lKGZrLmdldElkZW50aWZpZXIoKSk7CiAgICAg\nICAgX2ZrcyA9IG51bGw7CiAgICAgICAgZmsucmVtb3ZlKCk7CiAgICAgICAg\ncmV0dXJuIHRydWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBJbXBvcnQgYSBm\nb3JlaWduIGtleTsgY29sdW1uIG5hbWVzIG11c3QgbWF0Y2ggY29sdW1ucyBv\nZiB0aGlzIHRhYmxlLgogICAgICovCiAgICBwdWJsaWMgRm9yZWlnbktleSBp\nbXBvcnRGb3JlaWduS2V5KEZvcmVpZ25LZXkgZmspIHsKICAgICAgICBpZiAo\nZmsgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIG51bGw7CgogICAgICAg\nIEZvcmVpZ25LZXkgY29weSA9IGFkZEZvcmVpZ25LZXkoZmsuZ2V0SWRlbnRp\nZmllcigpKTsKICAgICAgICBjb3B5LnNldERlbGV0ZUFjdGlvbihmay5nZXRE\nZWxldGVBY3Rpb24oKSk7CgogICAgICAgIFNjaGVtYSBzY2hlbWEgPSBnZXRT\nY2hlbWEoKTsKICAgICAgICBpZiAoc2NoZW1hICE9IG51bGwgJiYgc2NoZW1h\nLmdldFNjaGVtYUdyb3VwKCkgIT0gbnVsbCkgewogICAgICAgICAgICBDb2x1\nbW5bXSBwa3MgPSBmay5nZXRQcmltYXJ5S2V5Q29sdW1ucygpOwogICAgICAg\nICAgICBUYWJsZSBqb2luZWQgPSBudWxsOwogICAgICAgICAgICBpZiAocGtz\nLmxlbmd0aCA+IDApCiAgICAgICAgICAgICAgICBqb2luZWQgPSBzY2hlbWEu\nZ2V0U2NoZW1hR3JvdXAoKS5maW5kVGFibGUocGtzWzBdLmdldFRhYmxlKCkp\nOwoKICAgICAgICAgICAgQ29sdW1uW10gY29scyA9IGZrLmdldENvbHVtbnMo\nKTsKICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBjb2xzLmxlbmd0\naDsgaSsrKQogICAgICAgICAgICAgICAgY29weS5qb2luKGdldENvbHVtbihj\nb2xzW2ldLmdldElkZW50aWZpZXIoKSksCiAgICAgICAgICAgICAgICAgICAg\nam9pbmVkLmdldENvbHVtbihwa3NbaV0uZ2V0SWRlbnRpZmllcigpKSk7Cgog\nICAgICAgICAgICBjb2xzID0gZmsuZ2V0Q29uc3RhbnRDb2x1bW5zKCk7CiAg\nICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgY29scy5sZW5ndGg7IGkr\nKykKICAgICAgICAgICAgICAgIGNvcHkuam9pbkNvbnN0YW50KGdldENvbHVt\nbihjb2xzW2ldLmdldElkZW50aWZpZXIoKSksCiAgICAgICAgICAgICAgICAg\nICAgZmsuZ2V0UHJpbWFyeUtleUNvbnN0YW50KGNvbHNbaV0pKTsKCiAgICAg\nICAgICAgIHBrcyA9IGZrLmdldENvbnN0YW50UHJpbWFyeUtleUNvbHVtbnMo\nKTsKICAgICAgICAgICAgaWYgKGpvaW5lZCA9PSBudWxsICYmIHBrcy5sZW5n\ndGggPiAwKQogICAgICAgICAgICAgICAgam9pbmVkID0gc2NoZW1hLmdldFNj\naGVtYUdyb3VwKCkuZmluZFRhYmxlKHBrc1swXS5nZXRUYWJsZSgpKTsKICAg\nICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBwa3MubGVuZ3RoOyBpKysp\nCiAgICAgICAgICAgICAgICBjb3B5LmpvaW5Db25zdGFudChmay5nZXRDb25z\ndGFudChwa3NbaV0pLAogICAgICAgICAgICAgICAgICAgIGpvaW5lZC5nZXRD\nb2x1bW4ocGtzW2ldLmdldElkZW50aWZpZXIoKSkpOwogICAgICAgIH0KICAg\nICAgICByZXR1cm4gY29weTsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVy\nbiB0aGUgdGFibGUncyBpbmRleGVzLgogICAgICovCiAgICBwdWJsaWMgSW5k\nZXhbXSBnZXRJbmRleGVzKCkgewogICAgICAgIGlmIChfaWR4cyA9PSBudWxs\nIHx8IF9pZHhzLmxlbmd0aCA9PSAwKQogICAgICAgICAgICBfaWR4cyA9IChf\naWR4TWFwID09IG51bGwpID8gU2NoZW1hcy5FTVBUWV9JTkRFWEVTIDogKElu\nZGV4W10pCiAgICAgICAgICAgICAgICBfaWR4TWFwLnZhbHVlcygpLnRvQXJy\nYXkobmV3IEluZGV4W19pZHhNYXAuc2l6ZSgpXSk7CiAgICAgICAgcmV0dXJu\nIF9pZHhzOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRoZSBpbmRl\neCB3aXRoIHRoZSBnaXZlbiBuYW1lLCBvciBudWxsIGlmIG5vbmUuCiAgICAg\nKiBAZGVwcmVjYXRlZAogICAgICovCiAgICBwdWJsaWMgSW5kZXggZ2V0SW5k\nZXgoU3RyaW5nIG5hbWUpIHsKICAgICAgICBpZiAobmFtZSA9PSBudWxsIHx8\nIF9pZHhNYXAgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAg\nICAgICAgcmV0dXJuIGdldEluZGV4KERCSWRlbnRpZmllci5uZXdJZGVudGlm\naWVyKG5hbWUsIERCSWRlbnRpZmllclR5cGUuSU5ERVgsIHRydWUpKTsKICAg\nIH0KCiAgICBwdWJsaWMgSW5kZXggZ2V0SW5kZXgoREJJZGVudGlmaWVyIG5h\nbWUpIHsKICAgICAgICBpZiAobmFtZSA9PSBudWxsIHx8IF9pZHhNYXAgPT0g\nbnVsbCkKICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgCiAgICAg\nICAgREJJZGVudGlmaWVyIHNOYW1lID0gREJJZGVudGlmaWVyLnRvVXBwZXIo\nbmFtZSk7CiAgICAgICAgcmV0dXJuIChJbmRleCkgX2lkeE1hcC5nZXQoc05h\nbWUpOwogICAgfQoKICAgIC8qKgogICAgICogQWRkIGFuIGluZGV4IHRvIHRo\nZSB0YWJsZS4KICAgICAqIEBkZXByZWNhdGVkCiAgICAgKi8KICAgIHB1Ymxp\nYyBJbmRleCBhZGRJbmRleChTdHJpbmcgbmFtZSkgewogICAgICAgIHJldHVy\nbiBhZGRJbmRleChEQklkZW50aWZpZXIubmV3SW5kZXgobmFtZSkpOwogICAg\nfQoKICAgIHB1YmxpYyBJbmRleCBhZGRJbmRleChEQklkZW50aWZpZXIgbmFt\nZSkgewogICAgICAgIFNjaGVtYSBzY2hlbWEgPSBnZXRTY2hlbWEoKTsKICAg\nICAgICBJbmRleCBpZHg7CiAgICAgICAgaWYgKHNjaGVtYSAhPSBudWxsICYm\nIHNjaGVtYS5nZXRTY2hlbWFHcm91cCgpICE9IG51bGwpIHsKICAgICAgICAg\nICAgc2NoZW1hLmdldFNjaGVtYUdyb3VwKCkuYWRkTmFtZShuYW1lLCB0cnVl\nKTsKICAgICAgICAgICAgaWR4ID0gc2NoZW1hLmdldFNjaGVtYUdyb3VwKCku\nbmV3SW5kZXgobmFtZSwgdGhpcyk7CiAgICAgICAgfSBlbHNlCiAgICAgICAg\nICAgIGlkeCA9IG5ldyBJbmRleChuYW1lLCB0aGlzKTsKICAgICAgICBpZiAo\nX2lkeE1hcCA9PSBudWxsKQogICAgICAgICAgICBfaWR4TWFwID0gbmV3IFRy\nZWVNYXA8REJJZGVudGlmaWVyLCBJbmRleD4oKTsKICAgICAgICBEQklkZW50\naWZpZXIgc05hbWUgPSBEQklkZW50aWZpZXIudG9VcHBlcihuYW1lKTsKICAg\nICAgICBfaWR4TWFwLnB1dChzTmFtZSwgaWR4KTsKICAgICAgICBfaWR4cyA9\nIG51bGw7CiAgICAgICAgcmV0dXJuIGlkeDsKICAgIH0KCiAgICAvKioKICAg\nICAqIFJlbW92ZSB0aGUgZ2l2ZW4gaW5kZXggZnJvbSB0aGUgdGFibGUuCiAg\nICAgKgogICAgICogQHJldHVybiB0cnVlIGlmIHRoZSBpbmRleCB3YXMgcmVt\nb3ZlZCwgZmFsc2UgaWYgbm90IGluIHRoZSB0YWJsZQogICAgICovCiAgICBw\ndWJsaWMgYm9vbGVhbiByZW1vdmVJbmRleChJbmRleCBpZHgpIHsKICAgICAg\nICBpZiAoaWR4ID09IG51bGwgfHwgX2lkeE1hcCA9PSBudWxsKQogICAgICAg\nICAgICByZXR1cm4gZmFsc2U7CgogICAgICAgIERCSWRlbnRpZmllciBzTmFt\nZSA9IERCSWRlbnRpZmllci50b1VwcGVyKGlkeC5nZXRJZGVudGlmaWVyKCkp\nOwogICAgICAgIEluZGV4IGN1ciA9IChJbmRleCkgX2lkeE1hcC5nZXQoc05h\nbWUpOwogICAgICAgIGlmICghaWR4LmVxdWFscyhjdXIpKQogICAgICAgICAg\nICByZXR1cm4gZmFsc2U7CgogICAgICAgIF9pZHhNYXAucmVtb3ZlKHNOYW1l\nKTsKICAgICAgICBTY2hlbWEgc2NoZW1hID0gZ2V0U2NoZW1hKCk7CiAgICAg\nICAgaWYgKHNjaGVtYSAhPSBudWxsICYmIHNjaGVtYS5nZXRTY2hlbWFHcm91\ncCgpICE9IG51bGwpCiAgICAgICAgICAgIHNjaGVtYS5nZXRTY2hlbWFHcm91\ncCgpLnJlbW92ZU5hbWUoaWR4LmdldElkZW50aWZpZXIoKSk7CiAgICAgICAg\naWR4LnJlbW92ZSgpOwogICAgICAgIF9pZHhzID0gbnVsbDsKICAgICAgICBy\nZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvKioKICAgICAqIEltcG9ydCBhbiBp\nbmRleDsgY29sdW1uIG5hbWVzIG11c3QgbWF0Y2ggY29sdW1ucyBvZiB0aGlz\nIHRhYmxlLgogICAgICovCiAgICBwdWJsaWMgSW5kZXggaW1wb3J0SW5kZXgo\nSW5kZXggaWR4KSB7CiAgICAgICAgaWYgKGlkeCA9PSBudWxsKQogICAgICAg\nICAgICByZXR1cm4gbnVsbDsKCiAgICAgICAgSW5kZXggY29weSA9IGFkZElu\nZGV4KGlkeC5nZXRJZGVudGlmaWVyKCkpOwogICAgICAgIGNvcHkuc2V0VW5p\ncXVlKGlkeC5pc1VuaXF1ZSgpKTsKCiAgICAgICAgQ29sdW1uW10gY29scyA9\nIGlkeC5nZXRDb2x1bW5zKCk7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkg\nPCBjb2xzLmxlbmd0aDsgaSsrKQogICAgICAgICAgICBjb3B5LmFkZENvbHVt\nbihnZXRDb2x1bW4oY29sc1tpXS5nZXRJZGVudGlmaWVyKCkpKTsKICAgICAg\nICByZXR1cm4gY29weTsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0\naGUgdGFibGUncyB1bmlxdWUgY29uc3RyYWludHMuCiAgICAgKi8KICAgIHB1\nYmxpYyBVbmlxdWVbXSBnZXRVbmlxdWVzKCkgewogICAgICAgIGlmIChfdW5x\ncyA9PSBudWxsKQogICAgICAgICAgICBfdW5xcyA9IChfdW5xTGlzdCA9PSBu\ndWxsKSA/IFNjaGVtYXMuRU1QVFlfVU5JUVVFUyA6IChVbmlxdWVbXSkKICAg\nICAgICAgICAgICAgIF91bnFMaXN0LnRvQXJyYXkobmV3IFVuaXF1ZVtfdW5x\nTGlzdC5zaXplKCldKTsKICAgICAgICByZXR1cm4gX3VucXM7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIHVuaXF1ZSBjb25zdHJhaW50IHdp\ndGggdGhlIGdpdmVuIG5hbWUsIG9yIG51bGwgaWYgbm9uZS4KICAgICAqIEBk\nZXByZWNhdGVkCiAgICAgKi8KICAgIHB1YmxpYyBVbmlxdWUgZ2V0VW5pcXVl\nKFN0cmluZyBuYW1lKSB7CiAgICAgICAgcmV0dXJuIGdldFVuaXF1ZShEQklk\nZW50aWZpZXIubmV3Q29uc3RyYWludChuYW1lKSk7CiAgICB9CgogICAgcHVi\nbGljIFVuaXF1ZSBnZXRVbmlxdWUoREJJZGVudGlmaWVyIG5hbWUpIHsKICAg\nICAgICBVbmlxdWVbXSB1bnFzID0gZ2V0VW5pcXVlcygpOwogICAgICAgIGZv\nciAoaW50IGkgPSAwOyBpIDwgdW5xcy5sZW5ndGg7IGkrKykKICAgICAgICAg\nICAgaWYgKERCSWRlbnRpZmllci5lcXVhbChuYW1lLCB1bnFzW2ldLmdldElk\nZW50aWZpZXIoKSkpCiAgICAgICAgICAgICAgICByZXR1cm4gdW5xc1tpXTsK\nICAgICAgICByZXR1cm4gbnVsbDsKICAgIH0KCiAgICAvKioKICAgICAqIEFk\nZCBhIHVuaXF1ZSBjb25zdHJhaW50IHRvIHRoZSB0YWJsZS4KICAgICAqIEBk\nZXByZWNhdGVkCiAgICAgKi8KICAgIHB1YmxpYyBVbmlxdWUgYWRkVW5pcXVl\nKFN0cmluZyBuYW1lKSB7CiAgICAgICAgcmV0dXJuIGFkZFVuaXF1ZShEQklk\nZW50aWZpZXIubmV3Q29uc3RyYWludChuYW1lKSk7CiAgICB9CgogICAgcHVi\nbGljIFVuaXF1ZSBhZGRVbmlxdWUoREJJZGVudGlmaWVyIG5hbWUpIHsKICAg\nICAgICBTY2hlbWEgc2NoZW1hID0gZ2V0U2NoZW1hKCk7CiAgICAgICAgVW5p\ncXVlIHVucTsKICAgICAgICBpZiAoc2NoZW1hICE9IG51bGwgJiYgc2NoZW1h\nLmdldFNjaGVtYUdyb3VwKCkgIT0gbnVsbCkgewogICAgICAgICAgICBzY2hl\nbWEuZ2V0U2NoZW1hR3JvdXAoKS5hZGROYW1lKG5hbWUsIGZhbHNlKTsKICAg\nICAgICAgICAgdW5xID0gc2NoZW1hLmdldFNjaGVtYUdyb3VwKCkubmV3VW5p\ncXVlKG5hbWUsIHRoaXMpOwogICAgICAgIH0gZWxzZQogICAgICAgICAgICB1\nbnEgPSBuZXcgVW5pcXVlKG5hbWUsIHRoaXMpOwogICAgICAgIGlmIChfdW5x\nTGlzdCA9PSBudWxsKQogICAgICAgICAgICBfdW5xTGlzdCA9IG5ldyBBcnJh\neUxpc3Q8VW5pcXVlPigzKTsKICAgICAgICBfdW5xTGlzdC5hZGQodW5xKTsK\nICAgICAgICBfdW5xcyA9IG51bGw7CiAgICAgICAgcmV0dXJuIHVucTsKICAg\nIH0KCiAgICAvKioKICAgICAqIFJlbW92ZSB0aGUgZ2l2ZW4gdW5pcXVlIGNv\nbnN0cmFpbnQgZnJvbSB0aGUgdGFibGUuCiAgICAgKgogICAgICogQHJldHVy\nbiB0cnVlIGlmIHRoZSBjb25zdHJhaW50IHdhcyByZW1vdmVkLCBmYWxzZSBp\nZiBub3QgaW4gdGhlIHRhYmxlCiAgICAgKi8KICAgIHB1YmxpYyBib29sZWFu\nIHJlbW92ZVVuaXF1ZShVbmlxdWUgdW5xKSB7CiAgICAgICAgaWYgKHVucSA9\nPSBudWxsIHx8IF91bnFMaXN0ID09IG51bGwpCiAgICAgICAgICAgIHJldHVy\nbiBmYWxzZTsKCiAgICAgICAgaWYgKCFfdW5xTGlzdC5yZW1vdmUodW5xKSkK\nICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoKICAgICAgICBTY2hlbWEgc2No\nZW1hID0gZ2V0U2NoZW1hKCk7CiAgICAgICAgaWYgKHNjaGVtYSAhPSBudWxs\nICYmIHNjaGVtYS5nZXRTY2hlbWFHcm91cCgpICE9IG51bGwpCiAgICAgICAg\nICAgIHNjaGVtYS5nZXRTY2hlbWFHcm91cCgpLnJlbW92ZU5hbWUodW5xLmdl\ndElkZW50aWZpZXIoKSk7CiAgICAgICAgX3VucXMgPSBudWxsOwogICAgICAg\nIHVucS5yZW1vdmUoKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAg\nICAvKioKICAgICAqIEltcG9ydCBhIGNvbnN0cmFpbnQ7IGNvbHVtbiBuYW1l\ncyBtdXN0IG1hdGNoIGNvbHVtbnMgb2YgdGhpcyB0YWJsZS4KICAgICAqLwog\nICAgcHVibGljIFVuaXF1ZSBpbXBvcnRVbmlxdWUoVW5pcXVlIHVucSkgewog\nICAgICAgIGlmICh1bnEgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIG51\nbGw7CgogICAgICAgIFVuaXF1ZSBjb3B5ID0gYWRkVW5pcXVlKHVucS5nZXRJ\nZGVudGlmaWVyKCkpOwogICAgICAgIGNvcHkuc2V0RGVmZXJyZWQodW5xLmlz\nRGVmZXJyZWQoKSk7CgogICAgICAgIENvbHVtbltdIGNvbHMgPSB1bnEuZ2V0\nQ29sdW1ucygpOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgY29scy5s\nZW5ndGg7IGkrKykKICAgICAgICAgICAgY29weS5hZGRDb2x1bW4oZ2V0Q29s\ndW1uKGNvbHNbaV0uZ2V0SWRlbnRpZmllcigpKSk7CiAgICAgICAgcmV0dXJu\nIGNvcHk7CiAgICB9CgogICAgLyoqCiAgICAgKiBDYWxsZWQgYnkgY29sdW1u\ncyB0byBlbnN1cmUgdGhhdCBhbGwgY29sdW1ucyBhcmUgcHJvcGVybHkgaW5k\nZXhlZAogICAgICogYmVmb3JlIHJldHVybmluZyB0aGF0IGluZm9ybWF0aW9u\nIHRvIHRoZSB1c2VyLgogICAgICovCiAgICB2b2lkIGluZGV4Q29sdW1ucygp\nIHsKICAgICAgICBnZXRDb2x1bW5zKCk7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBDYWxsZWQgYnkgZm9yZWlnbiBrZXlzIHRvIGVuc3VyZSB0aGF0IGFsbCBm\na3MgYXJlIHByb3Blcmx5IGluZGV4ZWQKICAgICAqIGJlZm9yZSByZXR1cm5p\nbmcgdGhhdCBpbmZvcm1hdGlvbiB0byB0aGUgdXNlci4KICAgICAqLwogICAg\ndm9pZCBpbmRleEZvcmVpZ25LZXlzKCkgewogICAgICAgIGdldEZvcmVpZ25L\nZXlzKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBDYWxsZWQgYnkgY29sdW1u\ncyB3aGVuIHRoZWlyIGF1dG8gaW5jcmVtZW50IHN0YXR1cyBjaGFuZ2VzLgog\nICAgICovCiAgICB2b2lkIGNoYW5nZUF1dG9Bc3NpZ25lZChDb2x1bW4gY29s\nKSB7CiAgICAgICAgX2F1dG9Bc3NpZ24gPSBudWxsOwogICAgfQoKICAgIC8q\nKgogICAgICogQ2FsbGVkIGJ5IGNvbHVtbnMgd2hlbiB0aGVpciByZWxhdGlv\nbiBpZCBzdGF0dXMgY2hhbmdlcy4KICAgICAqLwogICAgdm9pZCBjaGFuZ2VS\nZWxhdGlvbklkKENvbHVtbiBjb2wpIHsKICAgICAgICBfcmVscyA9IG51bGw7\nCiAgICB9CgogICAgcHVibGljIGludCBjb21wYXJlVG8oT2JqZWN0IG90aGVy\nKSB7CiAgICAgICAgREJJZGVudGlmaWVyIG5hbWUgPSBnZXRGdWxsSWRlbnRp\nZmllcigpOwogICAgICAgIERCSWRlbnRpZmllciBvdGhlck5hbWUgPSAoKFRh\nYmxlKSBvdGhlcikuZ2V0RnVsbElkZW50aWZpZXIoKTsKICAgICAgICBpZiAo\nREJJZGVudGlmaWVyLmlzTnVsbChuYW1lKSAmJiBEQklkZW50aWZpZXIuaXNO\ndWxsKG90aGVyTmFtZSkpCiAgICAgICAgICAgIHJldHVybiAwOwogICAgICAg\nIGlmIChEQklkZW50aWZpZXIuaXNOdWxsKG5hbWUpKQogICAgICAgICAgICBy\nZXR1cm4gMTsKICAgICAgICBpZiAoREJJZGVudGlmaWVyLmlzTnVsbChvdGhl\nck5hbWUpKQogICAgICAgICAgICByZXR1cm4gLTE7CiAgICAgICAgcmV0dXJu\nIG5hbWUuY29tcGFyZVRvKG90aGVyTmFtZSk7CiAgICB9CgogICAgcHVibGlj\nIFN0cmluZyB0b1N0cmluZygpIHsKICAgICAgICByZXR1cm4gZ2V0RnVsbElk\nZW50aWZpZXIoKS5nZXROYW1lKCk7CiAgICB9CgogICAgcHVibGljIGJvb2xl\nYW4gaGFzQ29tbWVudCgpIHsKICAgICAgICByZXR1cm4gX2NvbW1lbnQgIT0g\nbnVsbCAmJiAhX2NvbW1lbnQuZXF1YWxzSWdub3JlQ2FzZShfbmFtZS5nZXRO\nYW1lKCkpOwogICAgfQoKICAgIHB1YmxpYyBTdHJpbmcgZ2V0Q29tbWVudCgp\nIHsKICAgICAgICByZXR1cm4gX2NvbW1lbnQ7CiAgICB9CgogICAgcHVibGlj\nIHZvaWQgc2V0Q29tbWVudChTdHJpbmcgY29tbWVudCkgewogICAgICAgIF9j\nb21tZW50ID0gY29tbWVudDsKICAgIH0KICAgIAogICAgcHVibGljIGludCBn\nZXRMaW5lTnVtYmVyKCkgewogICAgICAgIHJldHVybiBfbGluZU51bTsKICAg\nIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRMaW5lTnVtYmVyKGludCBsaW5lTnVt\nKSB7CiAgICAgICAgX2xpbmVOdW0gPSBsaW5lTnVtOwogICAgfQoKICAgIHB1\nYmxpYyBpbnQgZ2V0Q29sTnVtYmVyKCkgewogICAgICAgIHJldHVybiBfY29s\nTnVtOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldENvbE51bWJlcihpbnQg\nY29sTnVtKSB7CiAgICAgICAgX2NvbE51bSA9IGNvbE51bTsKICAgIH0KfQo=\n","encoding":"base64"}

