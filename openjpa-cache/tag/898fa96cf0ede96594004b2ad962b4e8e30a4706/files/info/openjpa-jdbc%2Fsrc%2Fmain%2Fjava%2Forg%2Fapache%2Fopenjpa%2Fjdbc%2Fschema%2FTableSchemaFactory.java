{"sha":"182a47d19fc5e962a57ae8716f89cbbeb59f3bba","node_id":"MDQ6QmxvYjIwNjM2NDoxODJhNDdkMTlmYzVlOTYyYTU3YWU4NzE2Zjg5Y2JiZWI1OWYzYmJh","size":17648,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/182a47d19fc5e962a57ae8716f89cbbeb59f3bba","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hlbWE7CgppbXBv\ncnQgamF2YS5pby5JT0V4Y2VwdGlvbjsKaW1wb3J0IGphdmEuaW8uU3RyaW5n\nUmVhZGVyOwppbXBvcnQgamF2YS5pby5TdHJpbmdXcml0ZXI7CmltcG9ydCBq\nYXZhLmlvLldyaXRlcjsKaW1wb3J0IGphdmEuc3FsLkNvbm5lY3Rpb247Cmlt\ncG9ydCBqYXZhLnNxbC5QcmVwYXJlZFN0YXRlbWVudDsKaW1wb3J0IGphdmEu\nc3FsLlJlc3VsdFNldDsKaW1wb3J0IGphdmEuc3FsLlNRTEV4Y2VwdGlvbjsK\naW1wb3J0IGphdmEuc3FsLlR5cGVzOwoKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5qZGJjLmNvbmYuSkRCQ0NvbmZpZ3VyYXRpb247CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEuamRiYy5jb25mLkpEQkNDb25maWd1cmF0aW9uSW1w\nbDsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLmlkZW50aWZpZXIu\nTm9ybWFsaXplcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLmlk\nZW50aWZpZXIuREJJZGVudGlmaWVyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLmpkYmMuaWRlbnRpZmllci5RdWFsaWZpZWREQklkZW50aWZpZXI7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zcWwuREJEaWN0aW9uYXJ5\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc3FsLlNRTEJ1ZmZl\ncjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNxbC5TUUxFeGNl\ncHRpb25zOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi5jb25mLkNv\nbmZpZ3VyYWJsZTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIuY29u\nZi5Db25maWd1cmF0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxp\nYi5jb25mLkNvbmZpZ3VyYXRpb25zOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLmxpYi5sb2cuTG9nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxp\nYi5tZXRhLk1ldGFEYXRhU2VyaWFsaXplcjsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS5saWIudXRpbC5Mb2NhbGl6ZXI7CmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEubGliLnV0aWwuT3B0aW9uczsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS5tZXRhLkphdmFUeXBlczsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS51dGlsLkdlbmVyYWxFeGNlcHRpb247CmltcG9ydCBzZXJwLnV0aWwu\nTnVtYmVyczsKaW1wb3J0IHNlcnAudXRpbC5TdHJpbmdzOwoKLyoqCiAqIEZh\nY3RvcnkgdGhhdCB1c2VzIGFuIFhNTCBzY2hlbWEgZGVmaW5pdGlvbiBzdG9y\nZWQgaW4gYSBkYXRhYmFzZSB0YWJsZQogKiB0byByZWNvcmQgdGhlIHN5c3Rl\nbSBzY2hlbWEuCiAqCiAqIEBhdXRob3IgQWJlIFdoaXRlCiAqLwpwdWJsaWMg\nY2xhc3MgVGFibGVTY2hlbWFGYWN0b3J5CiAgICBpbXBsZW1lbnRzIFNjaGVt\nYUZhY3RvcnksIENvbmZpZ3VyYWJsZSB7CgogICAgcHVibGljIHN0YXRpYyBm\naW5hbCBTdHJpbmcgQUNUSU9OX0FERCA9ICJhZGQiOwogICAgcHVibGljIHN0\nYXRpYyBmaW5hbCBTdHJpbmcgQUNUSU9OX0RST1AgPSAiZHJvcCI7CgogICAg\ncHJpdmF0ZSBzdGF0aWMgZmluYWwgTG9jYWxpemVyIF9sb2MgPSBMb2NhbGl6\nZXIuZm9yUGFja2FnZQogICAgICAgIChUYWJsZVNjaGVtYUZhY3RvcnkuY2xh\nc3MpOwogICAgcHJpdmF0ZSBzdGF0aWMgYm9vbGVhbiBfcmVmcmVzaGVkVGFi\nbGUgPSBmYWxzZTsKCiAgICBwcml2YXRlIEpEQkNDb25maWd1cmF0aW9uIF9j\nb25mID0gbnVsbDsKICAgIHByaXZhdGUgTG9nIF9sb2cgPSBudWxsOwogICAg\ncHJpdmF0ZSBEQklkZW50aWZpZXIgX3RhYmxlID0gREJJZGVudGlmaWVyLm5l\nd1RhYmxlKCJPUEVOSlBBX1NDSEVNQSIpOwogICAgcHJpdmF0ZSBEQklkZW50\naWZpZXIgX3BrQ29sdW1uTmFtZSA9IERCSWRlbnRpZmllci5uZXdDb2x1bW4o\nIklEIik7CiAgICBwcml2YXRlIERCSWRlbnRpZmllciBfc2NoZW1hQ29sdW1u\nTmFtZSA9IERCSWRlbnRpZmllci5uZXdDb2x1bW4oIlNDSEVNQV9ERUYiKTsK\nICAgIHByaXZhdGUgQ29sdW1uIF9wa0NvbHVtbiA9IG51bGw7CiAgICBwcml2\nYXRlIENvbHVtbiBfc2NoZW1hQ29sdW1uID0gbnVsbDsKCiAgICAvKioKICAg\nICAqIFRoZSBuYW1lIG9mIHRoZSBzY2hlbWEgZGVmaW5pdGlvbiB0YWJsZS4g\nRGVmYXVsdHMgdG8KICAgICAqIDxjb2RlPk9QRU5KUEFfU0NIRU1BPC9jb2Rl\nPi4KICAgICAqLwogICAgcHVibGljIFN0cmluZyBnZXRUYWJsZSgpIHsKICAg\nICAgICByZXR1cm4gX3RhYmxlLmdldE5hbWUoKTsKICAgIH0KCiAgICAvKioK\nICAgICAqIFRoZSBuYW1lIG9mIHRoZSBzY2hlbWEgZGVmaW5pdGlvbiB0YWJs\nZS4gRGVmYXVsdHMgdG8KICAgICAqIDxjb2RlPk9QRU5KUEFfU0NIRU1BPC9j\nb2RlPi4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0VGFibGUoU3RyaW5n\nIG5hbWUpIHsKICAgICAgICBfdGFibGUgPSBEQklkZW50aWZpZXIubmV3VGFi\nbGUobmFtZSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBAZGVwcmVjYXRlZCBV\nc2Uge0BsaW5rICNzZXRUYWJsZX0uIFJldGFpbmVkIGZvcgogICAgICogYmFj\na3dhcmRzLWNvbXBhdGlibGUgYXV0by1jb25maWd1cmF0aW9uLgogICAgICov\nCiAgICBwdWJsaWMgdm9pZCBzZXRUYWJsZU5hbWUoU3RyaW5nIG5hbWUpIHsK\nICAgICAgICBzZXRUYWJsZShuYW1lKTsKICAgIH0KCiAgICAvKioKICAgICAq\nIFRoZSBuYW1lIG9mIHRoZSBwcmltYXJ5IGtleSBjb2x1bW4gb24gdGhlIHNj\naGVtYSBkZWZpbml0aW9uIHRhYmxlLgogICAgICogRGVmYXVsdHMgdG8gPGNv\nZGU+SUQ8L2NvZGU+LgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRQcmlt\nYXJ5S2V5Q29sdW1uKFN0cmluZyBuYW1lKSB7CiAgICAgICAgX3BrQ29sdW1u\nTmFtZSA9IERCSWRlbnRpZmllci5uZXdDb2x1bW4obmFtZSk7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBUaGUgbmFtZSBvZiB0aGUgcHJpbWFyeSBrZXkgY29s\ndW1uIG9uIHRoZSBzY2hlbWEgZGVmaW5pdGlvbiB0YWJsZS4KICAgICAqIERl\nZmF1bHRzIHRvIDxjb2RlPklEPC9jb2RlPi4KICAgICAqLwogICAgcHVibGlj\nIFN0cmluZyBnZXRQcmltYXJ5S2V5Q29sdW1uKCkgewogICAgICAgIHJldHVy\nbiBfcGtDb2x1bW5OYW1lLmdldE5hbWUoKTsKICAgIH0KCiAgICAvKioKICAg\nICAqIFRoZSBuYW1lIG9mIHRoZSBzY2hlbWEgY29sdW1uIG9uIHRoZSBzY2hl\nbWEgZGVmaW5pdGlvbiB0YWJsZS4KICAgICAqIERlZmF1bHRzIHRvIDxjb2Rl\nPlNDSEVNQV9ERUY8L2NvZGU+LgogICAgICovCiAgICBwdWJsaWMgdm9pZCBz\nZXRTY2hlbWFDb2x1bW4oU3RyaW5nIG5hbWUpIHsKICAgICAgICBfc2NoZW1h\nQ29sdW1uTmFtZSA9IERCSWRlbnRpZmllci5uZXdDb2x1bW4obmFtZSk7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBUaGUgbmFtZSBvZiB0aGUgc2NoZW1hIGNv\nbHVtbiBvbiB0aGUgc2NoZW1hIGRlZmluaXRpb24gdGFibGUuCiAgICAgKiBE\nZWZhdWx0cyB0byA8Y29kZT5TQ0hFTUFfREVGPC9jb2RlPi4KICAgICAqLwog\nICAgcHVibGljIFN0cmluZyBnZXRTY2hlbWFDb2x1bW4oKSB7CiAgICAgICAg\ncmV0dXJuIF9zY2hlbWFDb2x1bW5OYW1lLmdldE5hbWUoKTsKICAgIH0KCiAg\nICBwdWJsaWMgSkRCQ0NvbmZpZ3VyYXRpb24gZ2V0Q29uZmlndXJhdGlvbigp\nIHsKICAgICAgICByZXR1cm4gX2NvbmY7CiAgICB9CgogICAgcHVibGljIHZv\naWQgc2V0Q29uZmlndXJhdGlvbihDb25maWd1cmF0aW9uIGNvbmYpIHsKICAg\nICAgICBfY29uZiA9IChKREJDQ29uZmlndXJhdGlvbikgY29uZjsKICAgICAg\nICBfbG9nID0gX2NvbmYuZ2V0TG9nKEpEQkNDb25maWd1cmF0aW9uLkxPR19T\nQ0hFTUEpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHN0YXJ0Q29uZmlndXJh\ndGlvbigpIHsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBlbmRDb25maWd1cmF0\naW9uKCkgewogICAgICAgIGJ1aWxkVGFibGUoKTsKICAgIH0KICAgIAogICAg\ncHVibGljIHN5bmNocm9uaXplZCBTY2hlbWFHcm91cCByZWFkU2NoZW1hKCkg\newogICAgICAgIFN0cmluZyBzY2hlbWEgPSBudWxsOwogICAgICAgIHRyeSB7\nCiAgICAgICAgICAgIHNjaGVtYSA9IHJlYWRTY2hlbWFDb2x1bW4oKTsKICAg\nICAgICB9IGNhdGNoIChTUUxFeGNlcHRpb24gc2UpIHsKICAgICAgICAgICAg\naWYgKF9sb2cuaXNXYXJuRW5hYmxlZCgpKQogICAgICAgICAgICAgICAgX2xv\nZy53YXJuKF9sb2MuZ2V0KCJiYWQtc2NoLXJlYWQiLCBzZSkpOwogICAgICAg\nIH0KICAgICAgICBpZiAoc2NoZW1hID09IG51bGwpCiAgICAgICAgICAgIHJl\ndHVybiBuZXcgU2NoZW1hR3JvdXAoKTsKCiAgICAgICAgWE1MU2NoZW1hUGFy\nc2VyIHBhcnNlciA9IG5ldyBYTUxTY2hlbWFQYXJzZXIoX2NvbmYpOwogICAg\nICAgIHRyeSB7CiAgICAgICAgICAgIHBhcnNlci5wYXJzZShuZXcgU3RyaW5n\nUmVhZGVyKHNjaGVtYSksCiAgICAgICAgICAgICAgICBfc2NoZW1hQ29sdW1u\nLmdldFF1YWxpZmllZFBhdGgoKS50b1N0cmluZygpKTsKICAgICAgICB9IGNh\ndGNoIChJT0V4Y2VwdGlvbiBpb2UpIHsKICAgICAgICAgICAgdGhyb3cgbmV3\nIEdlbmVyYWxFeGNlcHRpb24oaW9lKTsKICAgICAgICB9CiAgICAgICAgcmV0\ndXJuIHBhcnNlci5nZXRTY2hlbWFHcm91cCgpOwogICAgfQoKICAgIHB1Ymxp\nYyB2b2lkIHN0b3JlU2NoZW1hKFNjaGVtYUdyb3VwIHNjaGVtYSkgewogICAg\nICAgIFhNTFNjaGVtYVNlcmlhbGl6ZXIgc2VyID0gbmV3IFhNTFNjaGVtYVNl\ncmlhbGl6ZXIoX2NvbmYpOwogICAgICAgIHNlci5hZGRBbGwoc2NoZW1hKTsK\nICAgICAgICBXcml0ZXIgd3JpdGVyID0gbmV3IFN0cmluZ1dyaXRlcigpOwog\nICAgICAgIHRyeSB7CiAgICAgICAgICAgIHNlci5zZXJpYWxpemUod3JpdGVy\nLCBNZXRhRGF0YVNlcmlhbGl6ZXIuQ09NUEFDVCk7CiAgICAgICAgfSBjYXRj\naCAoSU9FeGNlcHRpb24gaW9lKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBH\nZW5lcmFsRXhjZXB0aW9uKGlvZSk7CiAgICAgICAgfQoKICAgICAgICBTdHJp\nbmcgc2NoZW1hU3RyID0gd3JpdGVyLnRvU3RyaW5nKCk7CiAgICAgICAgdHJ5\nIHsKICAgICAgICAgICAgd3JpdGVTY2hlbWFDb2x1bW4oc2NoZW1hU3RyKTsK\nICAgICAgICB9IGNhdGNoIChTUUxFeGNlcHRpb24gc2UpIHsKICAgICAgICAg\nICAgaWYgKF9sb2cuaXNXYXJuRW5hYmxlZCgpKQogICAgICAgICAgICAgICAg\nX2xvZy53YXJuKF9sb2MuZ2V0KCJiYWQtc2NoLXdyaXRlLTEiLCBzZSkpOwoK\nICAgICAgICAgICAgLy8gbWF5YmUgdGhlIHVwZGF0ZSBmYWlsZWQgYi9jIHRo\nZSBzZXF1ZW5jZSB0YWJsZSBkb2Vzbid0CiAgICAgICAgICAgIC8vIGV4aXN0\nIHlldDsgY3JlYXRlIGl0IG5vdzsgbm90ZSB0aGF0IHRob3VnaCB3ZSBzeW5j\naHJvbml6ZQogICAgICAgICAgICAvLyBoZXJlLCBvdGhlciBKVk1zIGNhbiBz\ndGlsbCBiZSB0cnlpbmcgdG8gY3JlYXRlIHRoZSB0YWJsZSBhdAogICAgICAg\nICAgICAvLyB0aGUgc2FtZSB0aW1lICh1bmxpa2VseSwgc2luY2UgdGhpcyBp\ncyBhIGRldi10b29sIG9wKQogICAgICAgICAgICBzeW5jaHJvbml6ZWQgKFRh\nYmxlU2NoZW1hRmFjdG9yeS5jbGFzcykgewogICAgICAgICAgICAgICAgaWYg\nKCFfcmVmcmVzaGVkVGFibGUpIHsKICAgICAgICAgICAgICAgICAgICBfcmVm\ncmVzaGVkVGFibGUgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgIHRyeSB7\nCiAgICAgICAgICAgICAgICAgICAgICAgIHJlZnJlc2hUYWJsZSgpOwogICAg\nICAgICAgICAgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAg\nICAgICAgICAgICAgICAgICAgIGlmIChfbG9nLmlzV2FybkVuYWJsZWQoKSkK\nICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9sb2cud2FybihfbG9jLmdl\ndCgiYmFkLXNjaC1yZWYiLCBlKSk7CiAgICAgICAgICAgICAgICAgICAgfQog\nICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHRyeSB7CiAgICAg\nICAgICAgICAgICAgICAgd3JpdGVTY2hlbWFDb2x1bW4oc2NoZW1hU3RyKTsK\nICAgICAgICAgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAg\nICAgICAgICAgICAgICAgaWYgKF9sb2cuaXNXYXJuRW5hYmxlZCgpKQogICAg\nICAgICAgICAgICAgICAgICAgICBfbG9nLndhcm4oX2xvYy5nZXQoImJhZC1z\nY2gtd3JpdGUtMiIpKTsKCiAgICAgICAgICAgICAgICAgICAgLy8gdGhyb3cg\nb3JpZ2luYWwgZXhjZXB0aW9uCiAgICAgICAgICAgICAgICAgICAgdGhyb3cg\nU1FMRXhjZXB0aW9ucy5nZXRTdG9yZShzZSwKICAgICAgICAgICAgICAgICAg\nICAgICAgX2NvbmYuZ2V0REJEaWN0aW9uYXJ5SW5zdGFuY2UoKSk7CiAgICAg\nICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBDcmVhdGVzIHRoZSBzY2hlbWEgdGFibGUgaW4gdGhl\nIERCLgogICAgICovCiAgICBwdWJsaWMgdm9pZCByZWZyZXNoVGFibGUoKQog\nICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIGlmIChfbG9n\nLmlzSW5mb0VuYWJsZWQoKSkKICAgICAgICAgICAgX2xvZy5pbmZvKF9sb2Mu\nZ2V0KCJtYWtlLXNjaC10YWJsZSIpKTsKCiAgICAgICAgLy8gY3JlYXRlIHRo\nZSB0YWJsZQogICAgICAgIFNjaGVtYVRvb2wgdG9vbCA9IG5ldyBTY2hlbWFU\nb29sKF9jb25mKTsKICAgICAgICB0b29sLnNldElnbm9yZUVycm9ycyh0cnVl\nKTsKICAgICAgICB0b29sLmNyZWF0ZVRhYmxlKF9wa0NvbHVtbi5nZXRUYWJs\nZSgpKTsKCiAgICAgICAgLy8gaW5zZXJ0IGFuIGVtcHR5IHNjaGVtYQogICAg\nICAgIENvbm5lY3Rpb24gY29ubiA9IGdldENvbm5lY3Rpb24oKTsKICAgICAg\nICBQcmVwYXJlZFN0YXRlbWVudCBzdG1udCA9IG51bGw7CiAgICAgICAgYm9v\nbGVhbiB3YXNBdXRvID0gdHJ1ZTsKICAgICAgICB0cnkgewogICAgICAgICAg\nICB3YXNBdXRvID0gY29ubi5nZXRBdXRvQ29tbWl0KCk7CiAgICAgICAgICAg\nIGlmICghd2FzQXV0bykKICAgICAgICAgICAgICAgIGNvbm4uc2V0QXV0b0Nv\nbW1pdCh0cnVlKTsKCiAgICAgICAgICAgIERCRGljdGlvbmFyeSBkaWN0ID0g\nX2NvbmYuZ2V0REJEaWN0aW9uYXJ5SW5zdGFuY2UoKTsKICAgICAgICAgICAg\nc3RtbnQgPSBjb25uLnByZXBhcmVTdGF0ZW1lbnQoIklOU0VSVCBJTlRPICIK\nICAgICAgICAgICAgICAgICsgZGljdC5nZXRGdWxsTmFtZShfcGtDb2x1bW4u\nZ2V0VGFibGUoKSwgZmFsc2UpCiAgICAgICAgICAgICAgICArICIgKCIgKyBk\naWN0LmdldENvbHVtbkRCTmFtZShfcGtDb2x1bW4pICsgIiwgIiArIAogICAg\nICAgICAgICAgICAgZGljdC5nZXRDb2x1bW5EQk5hbWUoX3NjaGVtYUNvbHVt\nbikgKyAiKSBWQUxVRVMgKD8sID8pIik7CiAgICAgICAgICAgIGRpY3Quc2V0\nSW50KHN0bW50LCAxLCAxLCBfcGtDb2x1bW4pOwogICAgICAgICAgICBkaWN0\nLnNldE51bGwoc3RtbnQsIDIsIF9zY2hlbWFDb2x1bW4uZ2V0VHlwZSgpLCBf\nc2NoZW1hQ29sdW1uKTsKICAgICAgICAgICAgZGljdC5zZXRUaW1lb3V0cyhz\ndG1udCwgX2NvbmYsIHRydWUpOwogICAgICAgICAgICBzdG1udC5leGVjdXRl\nVXBkYXRlKCk7CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgaWYg\nKHN0bW50ICE9IG51bGwpCiAgICAgICAgICAgICAgICB0cnkgewogICAgICAg\nICAgICAgICAgICAgIHN0bW50LmNsb3NlKCk7CiAgICAgICAgICAgICAgICB9\nIGNhdGNoIChTUUxFeGNlcHRpb24gc2UpIHsKICAgICAgICAgICAgICAgIH0K\nICAgICAgICAgICAgaWYgKCF3YXNBdXRvKQogICAgICAgICAgICAgICAgY29u\nbi5zZXRBdXRvQ29tbWl0KGZhbHNlKTsKICAgICAgICAgICAgdHJ5IHsKICAg\nICAgICAgICAgICAgIGNvbm4uY2xvc2UoKTsKICAgICAgICAgICAgfSBjYXRj\naCAoU1FMRXhjZXB0aW9uIHNlKSB7CiAgICAgICAgICAgIH0KICAgICAgICB9\nCiAgICB9CgogICAgLyoqCiAgICAgKiBEcm9wcyB0aGUgc2VxdWVuY2UgdGFi\nbGUgaW4gdGhlIERCLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBkcm9wVGFi\nbGUoKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIGlm\nIChfbG9nLmlzSW5mb0VuYWJsZWQoKSkKICAgICAgICAgICAgX2xvZy5pbmZv\nKF9sb2MuZ2V0KCJkcm9wLXNjaC10YWJsZSIpKTsKCiAgICAgICAgLy8gZHJv\ncCB0aGUgdGFibGUKICAgICAgICBTY2hlbWFUb29sIHRvb2wgPSBuZXcgU2No\nZW1hVG9vbChfY29uZik7CiAgICAgICAgdG9vbC5zZXRJZ25vcmVFcnJvcnMo\ndHJ1ZSk7CiAgICAgICAgdG9vbC5kcm9wVGFibGUoX3BrQ29sdW1uLmdldFRh\nYmxlKCkpOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJucyB0aGUgc2No\nZW1hIGFzIGFuIFhNTCBzdHJpbmcuCiAgICAgKi8KICAgIHB1YmxpYyBTdHJp\nbmcgcmVhZFNjaGVtYUNvbHVtbigpCiAgICAgICAgdGhyb3dzIFNRTEV4Y2Vw\ndGlvbiB7CiAgICAgICAgREJEaWN0aW9uYXJ5IGRpY3QgPSBfY29uZi5nZXRE\nQkRpY3Rpb25hcnlJbnN0YW5jZSgpOwogICAgICAgIFNRTEJ1ZmZlciBzZWwg\nPSBuZXcgU1FMQnVmZmVyKGRpY3QpLmFwcGVuZChfc2NoZW1hQ29sdW1uKTsK\nICAgICAgICBTUUxCdWZmZXIgd2hlcmUgPSBuZXcgU1FMQnVmZmVyKGRpY3Qp\nLmFwcGVuZChfcGtDb2x1bW4pLmFwcGVuZCgiID0gIikuCiAgICAgICAgICAg\nIGFwcGVuZFZhbHVlKE51bWJlcnMudmFsdWVPZigxKSwgX3BrQ29sdW1uKTsK\nICAgICAgICBTUUxCdWZmZXIgdGFibGVzID0gbmV3IFNRTEJ1ZmZlcihkaWN0\nKS5hcHBlbmQoX3BrQ29sdW1uLmdldFRhYmxlKCkpOwoKICAgICAgICBTUUxC\ndWZmZXIgc2VsZWN0ID0gZGljdC50b1NlbGVjdChzZWwsIG51bGwsIHRhYmxl\ncywgd2hlcmUsIG51bGwsCiAgICAgICAgICAgIG51bGwsIG51bGwsIGZhbHNl\nLCBmYWxzZSwgMCwgTG9uZy5NQVhfVkFMVUUpOwoKICAgICAgICBDb25uZWN0\naW9uIGNvbm4gPSBnZXRDb25uZWN0aW9uKCk7CiAgICAgICAgUHJlcGFyZWRT\ndGF0ZW1lbnQgc3RtbnQgPSBudWxsOwogICAgICAgIFJlc3VsdFNldCBycyA9\nIG51bGw7CiAgICAgICAgYm9vbGVhbiB3YXNBdXRvID0gdHJ1ZTsKICAgICAg\nICB0cnkgewogICAgICAgICAgICB3YXNBdXRvID0gY29ubi5nZXRBdXRvQ29t\nbWl0KCk7CiAgICAgICAgICAgIGlmICghd2FzQXV0bykKICAgICAgICAgICAg\nICAgIGNvbm4uc2V0QXV0b0NvbW1pdCh0cnVlKTsKCiAgICAgICAgICAgIHN0\nbW50ID0gc2VsZWN0LnByZXBhcmVTdGF0ZW1lbnQoY29ubik7CiAgICAgICAg\nICAgIGRpY3Quc2V0UXVlcnlUaW1lb3V0KHN0bW50LCBfY29uZi5nZXRRdWVy\neVRpbWVvdXQoKSk7CiAgICAgICAgICAgIHJzID0gc3RtbnQuZXhlY3V0ZVF1\nZXJ5KCk7CiAgICAgICAgICAgIHJzLm5leHQoKTsKICAgICAgICAgICAgU3Ry\naW5nIHNjaGVtYSA9IChfc2NoZW1hQ29sdW1uLmdldFR5cGUoKSA9PSBUeXBl\ncy5DTE9CKSA/CiAgICAgICAgICAgICAgICBkaWN0LmdldENsb2JTdHJpbmco\ncnMsIDEpIDogZGljdC5nZXRTdHJpbmcocnMsIDEpOwogICAgICAgICAgICBy\nZXR1cm4gc2NoZW1hOwogICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAg\nIGlmIChycyAhPSBudWxsKQogICAgICAgICAgICAgICAgdHJ5IHsKICAgICAg\nICAgICAgICAgICAgICBycy5jbG9zZSgpOwogICAgICAgICAgICAgICAgfSBj\nYXRjaCAoU1FMRXhjZXB0aW9uIHNlKSB7CiAgICAgICAgICAgICAgICB9CiAg\nICAgICAgICAgIGlmIChzdG1udCAhPSBudWxsKQogICAgICAgICAgICAgICAg\ndHJ5IHsKICAgICAgICAgICAgICAgICAgICBzdG1udC5jbG9zZSgpOwogICAg\nICAgICAgICAgICAgfSBjYXRjaCAoU1FMRXhjZXB0aW9uIHNlKSB7CiAgICAg\nICAgICAgICAgICB9CiAgICAgICAgICAgIGlmICghd2FzQXV0bykKICAgICAg\nICAgICAgICAgIGNvbm4uc2V0QXV0b0NvbW1pdChmYWxzZSk7CiAgICAgICAg\nICAgIHRyeSB7CiAgICAgICAgICAgICAgICBjb25uLmNsb3NlKCk7CiAgICAg\nICAgICAgIH0gY2F0Y2ggKFNRTEV4Y2VwdGlvbiBzZSkgewogICAgICAgICAg\nICB9CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogV3JpdGVzIHRo\nZSBzY2hlbWEgYXMgYSBzdHJpbmcgdG8gdGhlIGRhdGFiYXNlLgogICAgICov\nCiAgICBwdWJsaWMgdm9pZCB3cml0ZVNjaGVtYUNvbHVtbihTdHJpbmcgc2No\nZW1hKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIC8v\nIGFsd2F5cyB1c2Ugc3BlY2lhbCBjbG9iIGhhbmRsaW5nIHdoZW4gZGljdCBo\nYXMgbWF4IGVtYmVkZGVkIHNpemU7CiAgICAgICAgLy8gZm9yIHNvbWUgcmVh\nc29uIG9wdGltaXppbmcgZm9yIHN0cmluZyBsZW5ndGggY2F1c2VzIGVycm9y\ncwogICAgICAgIERCRGljdGlvbmFyeSBkaWN0ID0gX2NvbmYuZ2V0REJEaWN0\naW9uYXJ5SW5zdGFuY2UoKTsKICAgICAgICBib29sZWFuIGVtYmVkZGVkID0g\nZGljdC5tYXhFbWJlZGRlZENsb2JTaXplID09IC0xOwogICAgICAgIFN0cmlu\nZyB1cGRhdGU7CiAgICAgICAgaWYgKGVtYmVkZGVkKQogICAgICAgICAgICB1\ncGRhdGUgPSAiVVBEQVRFICIgKyBkaWN0LmdldEZ1bGxOYW1lKF9wa0NvbHVt\nbi5nZXRUYWJsZSgpLCBmYWxzZSkKICAgICAgICAgICAgICAgICsgIiBTRVQg\nIiArIGRpY3QuZ2V0Q29sdW1uREJOYW1lKF9zY2hlbWFDb2x1bW4pICsgIiA9\nID8gIFdIRVJFICIgKwogICAgICAgICAgICAgICAgZGljdC5nZXRDb2x1bW5J\nZGVudGlmaWVyKF9wa0NvbHVtbikgKyAiID0gPyI7CiAgICAgICAgZWxzZQog\nICAgICAgICAgICB1cGRhdGUgPSAiU0VMRUNUICIgKyBkaWN0LmdldENvbHVt\nbkRCTmFtZShfc2NoZW1hQ29sdW1uKSArICIgRlJPTSAiCiAgICAgICAgICAg\nICAgICArIGRpY3QuZ2V0RnVsbE5hbWUoX3BrQ29sdW1uLmdldFRhYmxlKCks\nIGZhbHNlKQogICAgICAgICAgICAgICAgKyAiIFdIRVJFICIgKyBkaWN0Lmdl\ndENvbHVtbkRCTmFtZShfcGtDb2x1bW4pICsgIiA9ID8iOwoKICAgICAgICBD\nb25uZWN0aW9uIGNvbm4gPSBnZXRDb25uZWN0aW9uKCk7CiAgICAgICAgUHJl\ncGFyZWRTdGF0ZW1lbnQgc3RtbnQgPSBudWxsOwogICAgICAgIFJlc3VsdFNl\ndCBycyA9IG51bGw7CiAgICAgICAgYm9vbGVhbiB3YXNBdXRvID0gdHJ1ZTsK\nICAgICAgICB0cnkgewogICAgICAgICAgICAvLyBpZiBlbWJlZGRlZCB3ZSB3\nYW50IGF1dG9jb21taXQgdHJ1ZSwgZWxzZSBmYWxzZQogICAgICAgICAgICB3\nYXNBdXRvID0gY29ubi5nZXRBdXRvQ29tbWl0KCk7CiAgICAgICAgICAgIGlm\nICh3YXNBdXRvICE9IGVtYmVkZGVkKQogICAgICAgICAgICAgICAgY29ubi5z\nZXRBdXRvQ29tbWl0KGVtYmVkZGVkKTsKCiAgICAgICAgICAgIGlmIChlbWJl\nZGRlZCkgewogICAgICAgICAgICAgICAgc3RtbnQgPSBjb25uLnByZXBhcmVT\ndGF0ZW1lbnQodXBkYXRlKTsKICAgICAgICAgICAgICAgIGlmIChzY2hlbWEg\nPT0gbnVsbCkKICAgICAgICAgICAgICAgICAgICBkaWN0LnNldE51bGwoc3Rt\nbnQsIDEsIF9zY2hlbWFDb2x1bW4uZ2V0VHlwZSgpLAogICAgICAgICAgICAg\nICAgICAgICAgICBfc2NoZW1hQ29sdW1uKTsKICAgICAgICAgICAgICAgIGVs\nc2UgaWYgKF9zY2hlbWFDb2x1bW4uZ2V0VHlwZSgpID09IFR5cGVzLkNMT0Ip\nCiAgICAgICAgICAgICAgICAgICAgZGljdC5zZXRDbG9iU3RyaW5nKHN0bW50\nLCAxLCBzY2hlbWEsIF9zY2hlbWFDb2x1bW4pOwogICAgICAgICAgICAgICAg\nZWxzZQogICAgICAgICAgICAgICAgICAgIGRpY3Quc2V0U3RyaW5nKHN0bW50\nLCAxLCBzY2hlbWEsIF9zY2hlbWFDb2x1bW4pOwogICAgICAgICAgICAgICAg\nZGljdC5zZXRJbnQoc3RtbnQsIDIsIDEsIF9wa0NvbHVtbik7CiAgICAgICAg\nICAgICAgICBkaWN0LnNldFRpbWVvdXRzKHN0bW50LCBfY29uZiwgdHJ1ZSk7\nCiAgICAgICAgICAgICAgICBzdG1udC5leGVjdXRlVXBkYXRlKCk7CiAgICAg\nICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBzdG1udCA9IGNvbm4u\ncHJlcGFyZVN0YXRlbWVudCh1cGRhdGUsCiAgICAgICAgICAgICAgICAgICAg\nUmVzdWx0U2V0LlRZUEVfU0NST0xMX0lOU0VOU0lUSVZFLAogICAgICAgICAg\nICAgICAgICAgIFJlc3VsdFNldC5DT05DVVJfVVBEQVRBQkxFKTsKICAgICAg\nICAgICAgICAgIGRpY3Quc2V0SW50KHN0bW50LCAxLCAxLCBfcGtDb2x1bW4p\nOwogICAgICAgICAgICAgICAgZGljdC5zZXRUaW1lb3V0cyhzdG1udCwgX2Nv\nbmYsIHRydWUpOwogICAgICAgICAgICAgICAgcnMgPSBzdG1udC5leGVjdXRl\nUXVlcnkoKTsKICAgICAgICAgICAgICAgIHJzLm5leHQoKTsKICAgICAgICAg\nICAgICAgIGRpY3QucHV0U3RyaW5nKHJzLmdldENsb2IoMSksIHNjaGVtYSk7\nCiAgICAgICAgICAgICAgICBjb25uLmNvbW1pdCgpOwogICAgICAgICAgICB9\nCiAgICAgICAgfQogICAgICAgIGZpbmFsbHkgewogICAgICAgICAgICBpZiAo\ncnMgIT0gbnVsbCkKICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAg\nICAgICAgICAgcnMuY2xvc2UoKTsKICAgICAgICAgICAgICAgIH0gY2F0Y2gg\nKFNRTEV4Y2VwdGlvbiBzZSkgewogICAgICAgICAgICAgICAgfQogICAgICAg\nICAgICBpZiAoc3RtbnQgIT0gbnVsbCkKICAgICAgICAgICAgICAgIHRyeSB7\nCiAgICAgICAgICAgICAgICAgICAgc3RtbnQuY2xvc2UoKTsKICAgICAgICAg\nICAgICAgIH0gY2F0Y2ggKFNRTEV4Y2VwdGlvbiBzZSkgewogICAgICAgICAg\nICAgICAgfQogICAgICAgICAgICBpZiAod2FzQXV0byAhPSBlbWJlZGRlZCkK\nICAgICAgICAgICAgICAgIGNvbm4uc2V0QXV0b0NvbW1pdCh3YXNBdXRvKTsK\nICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIGNvbm4uY2xvc2Uo\nKTsKICAgICAgICAgICAgfSBjYXRjaCAoU1FMRXhjZXB0aW9uIHNlKSB7CiAg\nICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBD\ncmVhdGVzIHRoZSBvYmplY3QtbGV2ZWwgcmVwcmVzZW50YXRpb24gb2YgdGhl\nIHNlcXVlbmNlIHRhYmxlLgogICAgICovCiAgICBwcml2YXRlIHZvaWQgYnVp\nbGRUYWJsZSgpIHsKICAgICAgICBRdWFsaWZpZWREQklkZW50aWZpZXIgcGF0\naCA9IFF1YWxpZmllZERCSWRlbnRpZmllci5nZXRQYXRoKF90YWJsZSk7CiAg\nICAgICAgREJJZGVudGlmaWVyIHRhYmxlTmFtZSA9IHBhdGguZ2V0SWRlbnRp\nZmllcigpOwogICAgICAgIERCSWRlbnRpZmllciBzY2hlbWFOYW1lID0gcGF0\naC5nZXRTY2hlbWFOYW1lKCk7CiAgICAgICAgaWYgKERCSWRlbnRpZmllci5p\nc0VtcHR5KHNjaGVtYU5hbWUpKQogICAgICAgICAgICBzY2hlbWFOYW1lID0g\nU2NoZW1hcy5nZXROZXdUYWJsZVNjaGVtYUlkZW50aWZpZXIoX2NvbmYpOwoK\nICAgICAgICAvLyBidWlsZCB0aGUgdGFibGUgaW4gb25lIG9mIHRoZSBkZXNp\nZ25hdGVkIHNjaGVtYXMKICAgICAgICBTY2hlbWFHcm91cCBncm91cCA9IG5l\ndyBTY2hlbWFHcm91cCgpOwogICAgICAgIFNjaGVtYSBzY2hlbWEgPSBncm91\ncC5hZGRTY2hlbWEoc2NoZW1hTmFtZSk7CgogICAgICAgIFRhYmxlIHRhYmxl\nID0gc2NoZW1hLmFkZFRhYmxlKHRhYmxlTmFtZSk7CiAgICAgICAgUHJpbWFy\neUtleSBwayA9IHRhYmxlLmFkZFByaW1hcnlLZXkoKTsKCiAgICAgICAgREJE\naWN0aW9uYXJ5IGRpY3QgPSBfY29uZi5nZXREQkRpY3Rpb25hcnlJbnN0YW5j\nZSgpOwogICAgICAgIF9wa0NvbHVtbiA9IHRhYmxlLmFkZENvbHVtbihkaWN0\nLmdldFZhbGlkQ29sdW1uTmFtZQogICAgICAgICAgICAoX3BrQ29sdW1uTmFt\nZSwgdGFibGUpKTsKICAgICAgICBfcGtDb2x1bW4uc2V0VHlwZShkaWN0Lmdl\ndFByZWZlcnJlZFR5cGUoVHlwZXMuVElOWUlOVCkpOwogICAgICAgIF9wa0Nv\nbHVtbi5zZXRKYXZhVHlwZShKYXZhVHlwZXMuSU5UKTsKICAgICAgICBway5h\nZGRDb2x1bW4oX3BrQ29sdW1uKTsKCiAgICAgICAgX3NjaGVtYUNvbHVtbiA9\nIHRhYmxlLmFkZENvbHVtbihkaWN0LmdldFZhbGlkQ29sdW1uTmFtZQogICAg\nICAgICAgICAoX3NjaGVtYUNvbHVtbk5hbWUsIHRhYmxlKSk7CiAgICAgICAg\nX3NjaGVtYUNvbHVtbi5zZXRUeXBlKGRpY3QuZ2V0UHJlZmVycmVkVHlwZShU\neXBlcy5DTE9CKSk7CiAgICAgICAgX3NjaGVtYUNvbHVtbi5zZXRKYXZhVHlw\nZShKYXZhVHlwZXMuU1RSSU5HKTsKICAgIH0KCiAgICAvKioKICAgICAqIFJl\ndHVybiBhIGNvbm5lY3Rpb24gdG8gdXNlLgogICAgICovCiAgICBwcml2YXRl\nIENvbm5lY3Rpb24gZ2V0Q29ubmVjdGlvbigpCiAgICAgICAgdGhyb3dzIFNR\nTEV4Y2VwdGlvbiB7CiAgICAgICAgcmV0dXJuIF9jb25mLmdldERhdGFTb3Vy\nY2UyKG51bGwpLmdldENvbm5lY3Rpb24oKTsKICAgIH0KCiAgICAvLy8vLy8v\nLy8KICAgIC8vIE1haW4KICAgIC8vLy8vLy8vLwoKICAgIC8qKgogICAgICog\nVXNhZ2U6IGphdmEgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1hLlRh\nYmxlU2NoZW1hRmFjdG9yeQogICAgICogW29wdGlvbl0qIC1hY3Rpb24vLWEg\nJmx0O2FkZCB8IGRyb3AmZ3Q7CiAgICAgKiAgV2hlcmUgdGhlIGZvbGxvd2lu\nZyBvcHRpb25zIGFyZSByZWNvZ25pemVkLgogICAgICogPHVsPgogICAgICog\nPGxpPjxpPi1wcm9wZXJ0aWVzLy1wICZsdDtwcm9wZXJ0aWVzIGZpbGUgb3Ig\ncmVzb3VyY2UmZ3Q7PC9pPjogVGhlCiAgICAgKiBwYXRoIG9yIHJlc291cmNl\nIG5hbWUgb2YgYSBPcGVuSlBBIHByb3BlcnRpZXMgZmlsZSBjb250YWluaW5n\nCiAgICAgKiBpbmZvcm1hdGlvbiBzdWNoIGFzIHRoZSBsaWNlbnNlIGtleQlh\nbmQgY29ubmVjdGlvbiBkYXRhIGFzCiAgICAgKiBvdXRsaW5lZCBpbiB7QGxp\nbmsgSkRCQ0NvbmZpZ3VyYXRpb259LiBPcHRpb25hbC48L2xpPgogICAgICog\nPGxpPjxpPi0mbHQ7cHJvcGVydHkgbmFtZSZndDsgJmx0O3Byb3BlcnR5IHZh\nbHVlJmd0OzwvaT46IEFsbCBiZWFuCiAgICAgKiBwcm9wZXJ0aWVzIG9mIHRo\nZSBPcGVuSlBBIHtAbGluayBKREJDQ29uZmlndXJhdGlvbn0gY2FuIGJlIHNl\ndCBieQogICAgICogdXNpbmcgdGhlaXIJbmFtZXMgYW5kIHN1cHBseWluZyBh\nIHZhbHVlLiBGb3IgZXhhbXBsZToKICAgICAqIDxjb2RlPi1saWNlbnNlS2V5\nIGFkc2xmamE4M3IzbGthZGY8L2NvZGU+PC9saT4KICAgICAqIDwvdWw+CiAg\nICAgKiAgVGhlIHZhcmlvdXMgYWN0aW9ucyBhcmUgYXMgZm9sbG93cy4KICAg\nICAqIDx1bD4KICAgICAqIDxsaT48aT5hZGQ8L2k+OiBDcmVhdGUgdGhlIHNj\naGVtYSB0YWJsZS48L2xpPgogICAgICogPGxpPjxpPmRyb3A8L2k+OiBEcm9w\nIHRoZSBzY2hlbWEgdGFibGUuPC9saT4KICAgICAqIDwvdWw+CiAgICAgKi8K\nICAgIHB1YmxpYyBzdGF0aWMgdm9pZCBtYWluKFN0cmluZ1tdIGFyZ3MpCiAg\nICAgICAgdGhyb3dzIElPRXhjZXB0aW9uLCBTUUxFeGNlcHRpb24gewogICAg\nICAgIE9wdGlvbnMgb3B0cyA9IG5ldyBPcHRpb25zKCk7CiAgICAgICAgZmlu\nYWwgU3RyaW5nW10gYXJndW1lbnRzID0gb3B0cy5zZXRGcm9tQ21kTGluZShh\ncmdzKTsKICAgICAgICBib29sZWFuIHJldCA9IENvbmZpZ3VyYXRpb25zLnJ1\nbkFnYWluc3RBbGxBbmNob3JzKG9wdHMsCiAgICAgICAgICAgIG5ldyBDb25m\naWd1cmF0aW9ucy5SdW5uYWJsZSgpIHsKICAgICAgICAgICAgcHVibGljIGJv\nb2xlYW4gcnVuKE9wdGlvbnMgb3B0cykgdGhyb3dzIEV4Y2VwdGlvbiB7CiAg\nICAgICAgICAgICAgICBKREJDQ29uZmlndXJhdGlvbiBjb25mID0gbmV3IEpE\nQkNDb25maWd1cmF0aW9uSW1wbCgpOwogICAgICAgICAgICAgICAgdHJ5IHsK\nICAgICAgICAgICAgICAgICAgICByZXR1cm4gVGFibGVTY2hlbWFGYWN0b3J5\nLnJ1bihjb25mLCBhcmd1bWVudHMsIG9wdHMpOwogICAgICAgICAgICAgICAg\nfSBmaW5hbGx5IHsKICAgICAgICAgICAgICAgICAgICBjb25mLmNsb3NlKCk7\nCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9KTsK\nICAgICAgICBpZiAoIXJldCkKICAgICAgICAgICAgU3lzdGVtLm91dC5wcmlu\ndGxuKF9sb2MuZ2V0KCJzY2gtdXNhZ2UiKSk7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBSdW4gdGhlIHRvb2wuIFJldHVybnMgZmFsc2UgaWYgaW52YWxpZCBv\ncHRpb25zIHdlcmUgZ2l2ZW4uCiAgICAgKgogICAgICogQHNlZSAjbWFpbgog\nICAgICovCiAgICBwdWJsaWMgc3RhdGljIGJvb2xlYW4gcnVuKEpEQkNDb25m\naWd1cmF0aW9uIGNvbmYsIFN0cmluZ1tdIGFyZ3MsCiAgICAgICAgT3B0aW9u\ncyBvcHRzKQogICAgICAgIHRocm93cyBJT0V4Y2VwdGlvbiwgU1FMRXhjZXB0\naW9uIHsKICAgICAgICBTdHJpbmcgYWN0aW9uID0gb3B0cy5yZW1vdmVQcm9w\nZXJ0eSgiYWN0aW9uIiwgImEiLCBudWxsKTsKICAgICAgICBDb25maWd1cmF0\naW9ucy5wb3B1bGF0ZUNvbmZpZ3VyYXRpb24oY29uZiwgb3B0cyk7CiAgICAg\nICAgcmV0dXJuIHJ1bihjb25mLCBhY3Rpb24pOwogICAgfQoKICAgIC8qKgog\nICAgICogUnVuIHRoZSB0b29sLgogICAgICovCiAgICBwdWJsaWMgc3RhdGlj\nIGJvb2xlYW4gcnVuKEpEQkNDb25maWd1cmF0aW9uIGNvbmYsIFN0cmluZyBh\nY3Rpb24pCiAgICAgICAgdGhyb3dzIElPRXhjZXB0aW9uLCBTUUxFeGNlcHRp\nb24gewogICAgICAgIC8vIHJ1biB0aGUgYWN0aW9uCiAgICAgICAgVGFibGVT\nY2hlbWFGYWN0b3J5IGZhY3RvcnkgPSBuZXcgVGFibGVTY2hlbWFGYWN0b3J5\nKCk7CiAgICAgICAgU3RyaW5nIHByb3BzID0gQ29uZmlndXJhdGlvbnMuZ2V0\nUHJvcGVydGllcyhjb25mLmdldFNjaGVtYUZhY3RvcnkoKSk7CiAgICAgICAg\nQ29uZmlndXJhdGlvbnMuY29uZmlndXJlSW5zdGFuY2UoZmFjdG9yeSwgY29u\nZiwgcHJvcHMpOwoKICAgICAgICBpZiAoQUNUSU9OX0RST1AuZXF1YWxzKGFj\ndGlvbikpCiAgICAgICAgICAgIGZhY3RvcnkuZHJvcFRhYmxlKCk7CiAgICAg\nICAgZWxzZSBpZiAoQUNUSU9OX0FERC5lcXVhbHMoYWN0aW9uKSkKICAgICAg\nICAgICAgZmFjdG9yeS5yZWZyZXNoVGFibGUoKTsKICAgICAgICBlbHNlCiAg\nICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICByZXR1cm4gdHJ1ZTsK\nICAgIH0KfQo=\n","encoding":"base64"}

