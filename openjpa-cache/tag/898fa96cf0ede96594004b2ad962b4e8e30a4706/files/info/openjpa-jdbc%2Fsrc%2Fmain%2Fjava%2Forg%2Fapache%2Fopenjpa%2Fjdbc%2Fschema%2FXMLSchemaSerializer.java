{"sha":"b45e9e75cc1b052c14b69f222e1002475c69834b","node_id":"MDQ6QmxvYjIwNjM2NDpiNDVlOWU3NWNjMWIwNTJjMTRiNjlmMjIyZTEwMDI0NzVjNjk4MzRi","size":13888,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/b45e9e75cc1b052c14b69f222e1002475c69834b","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hlbWE7CgppbXBv\ncnQgamF2YS51dGlsLkFycmF5TGlzdDsKaW1wb3J0IGphdmEudXRpbC5Db2xs\nZWN0aW9uOwppbXBvcnQgamF2YS51dGlsLkhhc2hNYXA7CmltcG9ydCBqYXZh\nLnV0aWwuSXRlcmF0b3I7CmltcG9ydCBqYXZhLnV0aWwuTGlua2VkTGlzdDsK\naW1wb3J0IGphdmEudXRpbC5MaXN0OwppbXBvcnQgamF2YS51dGlsLk1hcDsK\naW1wb3J0IGphdmEudXRpbC5UcmVlU2V0OwoKaW1wb3J0IG9yZy5hcGFjaGUu\nY29tbW9ucy5sYW5nLlN0cmluZ1V0aWxzOwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLmpkYmMuY29uZi5KREJDQ29uZmlndXJhdGlvbjsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5saWIubWV0YS5YTUxNZXRhRGF0YVNlcmlhbGl6\nZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuTG9jYWxp\nemVyOwppbXBvcnQgb3JnLnhtbC5zYXguU0FYRXhjZXB0aW9uOwoKLyoqCiAq\nIFNlcmlhbGl6ZXMge0BsaW5rIFNjaGVtYX1zIHRvIFhNTCBtYXRjaGluZyB0\naGUgZG9jdW1lbnQKICogdHlwZSBkZWZpbml0aW9uIGRlZmluZWQgYnkgdGhl\nIHtAbGluayBYTUxTY2hlbWFQYXJzZXJ9LiBUaGUgc2VyaWFsaXplcgogKiBh\nY3R1YWxseSB3b3JrcyBhdCB0aGUgZmluZS1ncmFpbmVkIHRhYmxlIGxldmVs\nIHRvIGFsbG93IHlvdSB0byBzcGxpdAogKiBzY2hlbWFzIGFtb25nIG11bHRp\ncGxlIGZpbGVzLgogKiAgU2VyaWFsaXplcnMgYXJlIG5vdCB0aHJlYWQgc2Fm\nZS4KICoKICogQGF1dGhvciBBYmUgV2hpdGUKICogQG5vamF2YWRvYwogKi8K\ncHVibGljIGNsYXNzIFhNTFNjaGVtYVNlcmlhbGl6ZXIKICAgIGV4dGVuZHMg\nWE1MTWV0YURhdGFTZXJpYWxpemVyCiAgICBpbXBsZW1lbnRzIFNjaGVtYVNl\ncmlhbGl6ZXIgewoKICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIExvY2FsaXpl\nciBfbG9jID0gTG9jYWxpemVyLmZvclBhY2thZ2UKICAgICAgICAoWE1MU2No\nZW1hU2VyaWFsaXplci5jbGFzcyk7CgogICAgcHJpdmF0ZSBmaW5hbCBDb2xs\nZWN0aW9uPFRhYmxlPiBfdGFibGVzID0gbmV3IFRyZWVTZXQ8VGFibGU+KCk7\nCiAgICBwcml2YXRlIGZpbmFsIENvbGxlY3Rpb248U2VxdWVuY2U+IF9zZXFz\nID0gbmV3IFRyZWVTZXQ8U2VxdWVuY2U+KCk7CgogICAgLyoqCiAgICAgKiBD\nb25zdHJ1Y3Rvci4gU3VwcGx5IGNvbmZpZ3VyYXRpb24uCiAgICAgKi8KICAg\nIHB1YmxpYyBYTUxTY2hlbWFTZXJpYWxpemVyKEpEQkNDb25maWd1cmF0aW9u\nIGNvbmYpIHsKICAgICAgICBzZXRMb2coY29uZi5nZXRMb2coSkRCQ0NvbmZp\nZ3VyYXRpb24uTE9HX1NDSEVNQSkpOwogICAgfQoKICAgIHB1YmxpYyBUYWJs\nZVtdIGdldFRhYmxlcygpIHsKICAgICAgICByZXR1cm4gKFRhYmxlW10pIF90\nYWJsZXMudG9BcnJheShuZXcgVGFibGVbX3RhYmxlcy5zaXplKCldKTsKICAg\nIH0KCiAgICBwdWJsaWMgdm9pZCBhZGRUYWJsZShUYWJsZSB0YWJsZSkgewog\nICAgICAgIGlmICh0YWJsZSAhPSBudWxsKQogICAgICAgICAgICBfdGFibGVz\nLmFkZCh0YWJsZSk7CiAgICB9CgogICAgcHVibGljIGJvb2xlYW4gcmVtb3Zl\nVGFibGUoVGFibGUgdGFibGUpIHsKICAgICAgICByZXR1cm4gX3RhYmxlcy5y\nZW1vdmUodGFibGUpOwogICAgfQoKICAgIHB1YmxpYyBTZXF1ZW5jZVtdIGdl\ndFNlcXVlbmNlcygpIHsKICAgICAgICByZXR1cm4gKFNlcXVlbmNlW10pIF9z\nZXFzLnRvQXJyYXkobmV3IFNlcXVlbmNlW19zZXFzLnNpemUoKV0pOwogICAg\nfQoKICAgIHB1YmxpYyB2b2lkIGFkZFNlcXVlbmNlKFNlcXVlbmNlIHNlcSkg\newogICAgICAgIGlmIChzZXEgIT0gbnVsbCkKICAgICAgICAgICAgX3NlcXMu\nYWRkKHNlcSk7CiAgICB9CgogICAgcHVibGljIGJvb2xlYW4gcmVtb3ZlU2Vx\ndWVuY2UoU2VxdWVuY2Ugc2VxKSB7CiAgICAgICAgcmV0dXJuIF9zZXFzLnJl\nbW92ZShzZXEpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIGFkZEFsbChTY2hl\nbWEgc2NoZW1hKSB7CiAgICAgICAgaWYgKHNjaGVtYSA9PSBudWxsKQogICAg\nICAgICAgICByZXR1cm47CiAgICAgICAgVGFibGVbXSB0YWJsZXMgPSBzY2hl\nbWEuZ2V0VGFibGVzKCk7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCB0\nYWJsZXMubGVuZ3RoOyBpKyspCiAgICAgICAgICAgIGFkZFRhYmxlKHRhYmxl\nc1tpXSk7CiAgICAgICAgU2VxdWVuY2VbXSBzZXFzID0gc2NoZW1hLmdldFNl\ncXVlbmNlcygpOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgc2Vxcy5s\nZW5ndGg7IGkrKykKICAgICAgICAgICAgYWRkU2VxdWVuY2Uoc2Vxc1tpXSk7\nCiAgICB9CgogICAgcHVibGljIHZvaWQgYWRkQWxsKFNjaGVtYUdyb3VwIGdy\nb3VwKSB7CiAgICAgICAgaWYgKGdyb3VwID09IG51bGwpCiAgICAgICAgICAg\nIHJldHVybjsKICAgICAgICBTY2hlbWFbXSBzY2hlbWFzID0gZ3JvdXAuZ2V0\nU2NoZW1hcygpOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgc2NoZW1h\ncy5sZW5ndGg7IGkrKykKICAgICAgICAgICAgYWRkQWxsKHNjaGVtYXNbaV0p\nOwogICAgfQoKICAgIHB1YmxpYyBib29sZWFuIHJlbW92ZUFsbChTY2hlbWEg\nc2NoZW1hKSB7CiAgICAgICAgaWYgKHNjaGVtYSA9PSBudWxsKQogICAgICAg\nICAgICByZXR1cm4gZmFsc2U7CgogICAgICAgIGJvb2xlYW4gcmVtb3ZlZCA9\nIGZhbHNlOwogICAgICAgIFRhYmxlW10gdGFibGVzID0gc2NoZW1hLmdldFRh\nYmxlcygpOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgdGFibGVzLmxl\nbmd0aDsgaSsrKQogICAgICAgICAgICByZW1vdmVkIHw9IHJlbW92ZVRhYmxl\nKHRhYmxlc1tpXSk7CiAgICAgICAgU2VxdWVuY2VbXSBzZXFzID0gc2NoZW1h\nLmdldFNlcXVlbmNlcygpOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwg\nc2Vxcy5sZW5ndGg7IGkrKykKICAgICAgICAgICAgcmVtb3ZlZCB8PSByZW1v\ndmVTZXF1ZW5jZShzZXFzW2ldKTsKICAgICAgICByZXR1cm4gcmVtb3ZlZDsK\nICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiByZW1vdmVBbGwoU2NoZW1hR3Jv\ndXAgZ3JvdXApIHsKICAgICAgICBpZiAoZ3JvdXAgPT0gbnVsbCkKICAgICAg\nICAgICAgcmV0dXJuIGZhbHNlOwoKICAgICAgICBib29sZWFuIHJlbW92ZWQg\nPSBmYWxzZTsKICAgICAgICBTY2hlbWFbXSBzY2hlbWFzID0gZ3JvdXAuZ2V0\nU2NoZW1hcygpOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgc2NoZW1h\ncy5sZW5ndGg7IGkrKykKICAgICAgICAgICAgcmVtb3ZlZCB8PSByZW1vdmVB\nbGwoc2NoZW1hc1tpXSk7CiAgICAgICAgcmV0dXJuIHJlbW92ZWQ7CiAgICB9\nCgogICAgcHVibGljIHZvaWQgY2xlYXIoKSB7CiAgICAgICAgX3RhYmxlcy5j\nbGVhcigpOwogICAgICAgIF9zZXFzLmNsZWFyKCk7CiAgICB9CgogICAgcHJv\ndGVjdGVkIENvbGxlY3Rpb24gZ2V0T2JqZWN0cygpIHsKICAgICAgICBpZiAo\nX3NlcXMuaXNFbXB0eSgpKQogICAgICAgICAgICByZXR1cm4gX3RhYmxlczsK\nICAgICAgICBpZiAoX3RhYmxlcy5pc0VtcHR5KCkpCiAgICAgICAgICAgIHJl\ndHVybiBfc2VxczsKICAgICAgICBMaXN0PE9iamVjdD4gYWxsID0gbmV3IEFy\ncmF5TGlzdDxPYmplY3Q+KF9zZXFzLnNpemUoKSArIF90YWJsZXMuc2l6ZSgp\nKTsKICAgICAgICBhbGwuYWRkQWxsKF9zZXFzKTsKICAgICAgICBhbGwuYWRk\nQWxsKF90YWJsZXMpOwogICAgICAgIHJldHVybiBhbGw7CiAgICB9CgogICAg\ncHJvdGVjdGVkIHZvaWQgc2VyaWFsaXplKENvbGxlY3Rpb24gb2JqcykKICAg\nICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICAvLyBncm91cCB0\naGUgb2JqZWN0cyBieSBzY2hlbWEKICAgICAgICBNYXAgc2NoZW1hcyA9IG5l\ndyBIYXNoTWFwKCk7CiAgICAgICAgU3RyaW5nIHNjaGVtYU5hbWU7CiAgICAg\nICAgQ29sbGVjdGlvbiBzY2hlbWFPYmpzOwogICAgICAgIE9iamVjdCBvYmo7\nCiAgICAgICAgZm9yIChJdGVyYXRvciBpdHIgPSBvYmpzLml0ZXJhdG9yKCk7\nIGl0ci5oYXNOZXh0KCk7KSB7CiAgICAgICAgICAgIG9iaiA9IGl0ci5uZXh0\nKCk7CiAgICAgICAgICAgIGlmIChvYmogaW5zdGFuY2VvZiBUYWJsZSkKICAg\nICAgICAgICAgICAgIHNjaGVtYU5hbWUgPSAoKFRhYmxlKSBvYmopLmdldFNj\naGVtYU5hbWUoKTsKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAg\nc2NoZW1hTmFtZSA9ICgoU2VxdWVuY2UpIG9iaikuZ2V0U2NoZW1hTmFtZSgp\nOwogICAgICAgICAgICBzY2hlbWFPYmpzID0gKENvbGxlY3Rpb24pIHNjaGVt\nYXMuZ2V0KHNjaGVtYU5hbWUpOwogICAgICAgICAgICBpZiAoc2NoZW1hT2Jq\ncyA9PSBudWxsKSB7CiAgICAgICAgICAgICAgICBzY2hlbWFPYmpzID0gbmV3\nIExpbmtlZExpc3QoKTsKICAgICAgICAgICAgICAgIHNjaGVtYXMucHV0KHNj\naGVtYU5hbWUsIHNjaGVtYU9ianMpOwogICAgICAgICAgICB9CiAgICAgICAg\nICAgIHNjaGVtYU9ianMuYWRkKG9iaik7CiAgICAgICAgfQoKICAgICAgICBz\ndGFydEVsZW1lbnQoInNjaGVtYXMiKTsKICAgICAgICBNYXAuRW50cnkgZW50\ncnk7CiAgICAgICAgZm9yIChJdGVyYXRvciBpdHIgPSBzY2hlbWFzLmVudHJ5\nU2V0KCkuaXRlcmF0b3IoKTsgaXRyLmhhc05leHQoKTspIHsKICAgICAgICAg\nICAgZW50cnkgPSAoTWFwLkVudHJ5KSBpdHIubmV4dCgpOwogICAgICAgICAg\nICBzZXJpYWxpemVTY2hlbWEoKFN0cmluZykgZW50cnkuZ2V0S2V5KCksIChD\nb2xsZWN0aW9uKQogICAgICAgICAgICAgICAgZW50cnkuZ2V0VmFsdWUoKSk7\nCiAgICAgICAgfQogICAgICAgIGVuZEVsZW1lbnQoInNjaGVtYXMiKTsKICAg\nIH0KCiAgICAvKioKICAgICAqIFNlcmlhbGl6ZXMgdGhlIGdpdmVuIG9iamVj\ndHMgdG9nZXRoZXIgaW50byB0aGUgY3VycmVudCBzY2hlbWEuCiAgICAgKi8K\nICAgIHByaXZhdGUgdm9pZCBzZXJpYWxpemVTY2hlbWEoU3RyaW5nIG5hbWUs\nIENvbGxlY3Rpb248Pz4gb2JqcykKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0\naW9uIHsKICAgICAgICBpZiAob2Jqcy5pc0VtcHR5KCkpCiAgICAgICAgICAg\nIHJldHVybjsKCiAgICAgICAgaWYgKGdldExvZygpLmlzVHJhY2VFbmFibGVk\nKCkpCiAgICAgICAgICAgIGdldExvZygpLnRyYWNlKF9sb2MuZ2V0KCJzZXIt\nc2NoZW1hIiwgbmFtZSkpOwoKICAgICAgICBpZiAobmFtZSAhPSBudWxsKQog\nICAgICAgICAgICBhZGRBdHRyaWJ1dGUoIm5hbWUiLCBuYW1lKTsKICAgICAg\nICBzdGFydEVsZW1lbnQoInNjaGVtYSIpOwoKICAgICAgICAvLyB0YWJsZXMg\nYW5kIHNlcXMKICAgICAgICBPYmplY3Qgb2JqOwogICAgICAgIGZvciAoSXRl\ncmF0b3I8Pz4gaXRyID0gb2Jqcy5pdGVyYXRvcigpOyBpdHIuaGFzTmV4dCgp\nOykgewogICAgICAgICAgICBvYmogPSBpdHIubmV4dCgpOwogICAgICAgICAg\nICBpZiAob2JqIGluc3RhbmNlb2YgVGFibGUpCiAgICAgICAgICAgICAgICBz\nZXJpYWxpemVUYWJsZSgoVGFibGUpIG9iaik7CiAgICAgICAgICAgIGVsc2UK\nICAgICAgICAgICAgICAgIHNlcmlhbGl6ZVNlcXVlbmNlKChTZXF1ZW5jZSkg\nb2JqKTsKICAgICAgICB9CgogICAgICAgIGVuZEVsZW1lbnQoInNjaGVtYSIp\nOwogICAgfQoKICAgIC8qKgogICAgICogU2VyaWFsaXplIHRoZSBnaXZlbiBz\nZXF1ZW5jZS4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIHNlcmlhbGl6ZVNl\ncXVlbmNlKFNlcXVlbmNlIHNlcSkKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0\naW9uIHsKICAgICAgICBhZGRBdHRyaWJ1dGUoIm5hbWUiLCBzZXEuZ2V0TmFt\nZSgpKTsKICAgICAgICBpZiAoc2VxLmdldEluaXRpYWxWYWx1ZSgpICE9IDEp\nCiAgICAgICAgICAgIGFkZEF0dHJpYnV0ZSgiaW5pdGlhbC12YWx1ZSIsCiAg\nICAgICAgICAgICAgICBTdHJpbmcudmFsdWVPZihzZXEuZ2V0SW5pdGlhbFZh\nbHVlKCkpKTsKICAgICAgICBpZiAoc2VxLmdldEluY3JlbWVudCgpID4gMSkK\nICAgICAgICAgICAgYWRkQXR0cmlidXRlKCJpbmNyZW1lbnQiLCBTdHJpbmcu\ndmFsdWVPZihzZXEuZ2V0SW5jcmVtZW50KCkpKTsKICAgICAgICBpZiAoc2Vx\nLmdldEFsbG9jYXRlKCkgPiAxKQogICAgICAgICAgICBhZGRBdHRyaWJ1dGUo\nImFsbG9jYXRlIiwgU3RyaW5nLnZhbHVlT2Yoc2VxLmdldEFsbG9jYXRlKCkp\nKTsKICAgICAgICBzdGFydEVsZW1lbnQoInNlcXVlbmNlIik7CiAgICAgICAg\nZW5kRWxlbWVudCgic2VxdWVuY2UiKTsKICAgIH0KCiAgICAvKioKICAgICAq\nIFNlcmlhbGl6ZXMgdGhlIGdpdmVuIHRhYmxlLgogICAgICovCiAgICBwcml2\nYXRlIHZvaWQgc2VyaWFsaXplVGFibGUoVGFibGUgdGFibGUpCiAgICAgICAg\ndGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgYWRkQXR0cmlidXRlKCJu\nYW1lIiwgdGFibGUuZ2V0TmFtZSgpKTsKICAgICAgICBzdGFydEVsZW1lbnQo\nInRhYmxlIik7CgogICAgICAgIC8vIHByaW1hcnkga2V5CiAgICAgICAgUHJp\nbWFyeUtleSBwayA9IHRhYmxlLmdldFByaW1hcnlLZXkoKTsKICAgICAgICBp\nZiAocGsgIT0gbnVsbCkKICAgICAgICAgICAgc2VyaWFsaXplUHJpbWFyeUtl\neShwayk7CgogICAgICAgIC8vIGNvbHVtbnMKICAgICAgICBDb2x1bW5bXSBj\nb2xzID0gdGFibGUuZ2V0Q29sdW1ucygpOwogICAgICAgIGZvciAoaW50IGkg\nPSAwOyBpIDwgY29scy5sZW5ndGg7IGkrKykKICAgICAgICAgICAgc2VyaWFs\naXplQ29sdW1uKGNvbHNbaV0pOwoKICAgICAgICAvLyBmb3JlaWduIGtleXMK\nICAgICAgICBGb3JlaWduS2V5W10gZmtzID0gdGFibGUuZ2V0Rm9yZWlnbktl\neXMoKTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGZrcy5sZW5ndGg7\nIGkrKykKICAgICAgICAgICAgc2VyaWFsaXplRm9yZWlnbktleShma3NbaV0p\nOwoKICAgICAgICAvLyBpbmRleGVzCiAgICAgICAgSW5kZXhbXSBpZHhzID0g\ndGFibGUuZ2V0SW5kZXhlcygpOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBp\nIDwgaWR4cy5sZW5ndGg7IGkrKykKICAgICAgICAgICAgc2VyaWFsaXplSW5k\nZXgoaWR4c1tpXSk7CgogICAgICAgIC8vIHVuaXF1ZSBjb25zdHJhaW50cwog\nICAgICAgIFVuaXF1ZVtdIHVucXMgPSB0YWJsZS5nZXRVbmlxdWVzKCk7CiAg\nICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCB1bnFzLmxlbmd0aDsgaSsrKQog\nICAgICAgICAgICBzZXJpYWxpemVVbmlxdWUodW5xc1tpXSk7CgogICAgICAg\nIGVuZEVsZW1lbnQoInRhYmxlIik7CiAgICB9CgogICAgLyoqCiAgICAgKiBT\nZXJpYWxpemVzIHRoZSBnaXZlbiBjb2x1bW4uCiAgICAgKi8KICAgIHByaXZh\ndGUgdm9pZCBzZXJpYWxpemVDb2x1bW4oQ29sdW1uIGNvbCkKICAgICAgICB0\naHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICBhZGRBdHRyaWJ1dGUoIm5h\nbWUiLCBjb2wuZ2V0TmFtZSgpKTsKICAgICAgICBhZGRBdHRyaWJ1dGUoInR5\ncGUiLCBTY2hlbWFzLmdldEpEQkNOYW1lKGNvbC5nZXRUeXBlKCkpKTsKICAg\nICAgICBpZiAoIVN0cmluZ1V0aWxzLmlzRW1wdHkoY29sLmdldFR5cGVOYW1l\nKCkpCiAgICAgICAgICAgICYmICFjb2wuZ2V0VHlwZU5hbWUoKS5lcXVhbHNJ\nZ25vcmVDYXNlCiAgICAgICAgICAgIChTY2hlbWFzLmdldEpEQkNOYW1lKGNv\nbC5nZXRUeXBlKCkpKSkKICAgICAgICAgICAgYWRkQXR0cmlidXRlKCJ0eXBl\nLW5hbWUiLCBjb2wuZ2V0VHlwZU5hbWUoKSk7CiAgICAgICAgaWYgKGNvbC5p\nc05vdE51bGwoKSkKICAgICAgICAgICAgYWRkQXR0cmlidXRlKCJub3QtbnVs\nbCIsICJ0cnVlIik7CiAgICAgICAgaWYgKGNvbC5pc0F1dG9Bc3NpZ25lZCgp\nKQogICAgICAgICAgICBhZGRBdHRyaWJ1dGUoImF1dG8tYXNzaWduIiwgInRy\ndWUiKTsKICAgICAgICBpZiAoY29sLmdldERlZmF1bHRTdHJpbmcoKSAhPSBu\ndWxsKQogICAgICAgICAgICBhZGRBdHRyaWJ1dGUoImRlZmF1bHQiLCBjb2wu\nZ2V0RGVmYXVsdFN0cmluZygpKTsKICAgICAgICBpZiAoY29sLmdldFNpemUo\nKSAhPSAwKQogICAgICAgICAgICBhZGRBdHRyaWJ1dGUoInNpemUiLCBTdHJp\nbmcudmFsdWVPZihjb2wuZ2V0U2l6ZSgpKSk7CiAgICAgICAgaWYgKGNvbC5n\nZXREZWNpbWFsRGlnaXRzKCkgIT0gMCkKICAgICAgICAgICAgYWRkQXR0cmli\ndXRlKCJkZWNpbWFsLWRpZ2l0cyIsIFN0cmluZy52YWx1ZU9mCiAgICAgICAg\nICAgICAgICAoY29sLmdldERlY2ltYWxEaWdpdHMoKSkpOwogICAgICAgIHN0\nYXJ0RWxlbWVudCgiY29sdW1uIik7CiAgICAgICAgZW5kRWxlbWVudCgiY29s\ndW1uIik7CiAgICB9CgogICAgLyoqCiAgICAgKiBTZXJpYWxpemVzIHRoZSBn\naXZlbiBwcmltYXJ5IGtleS4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIHNl\ncmlhbGl6ZVByaW1hcnlLZXkoUHJpbWFyeUtleSBwaykKICAgICAgICB0aHJv\nd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICBpZiAocGsuZ2V0TmFtZSgpICE9\nIG51bGwpCiAgICAgICAgICAgIGFkZEF0dHJpYnV0ZSgibmFtZSIsIHBrLmdl\ndE5hbWUoKSk7CiAgICAgICAgaWYgKHBrLmlzTG9naWNhbCgpKQogICAgICAg\nICAgICBhZGRBdHRyaWJ1dGUoImxvZ2ljYWwiLCAidHJ1ZSIpOwoKICAgICAg\nICBDb2x1bW5bXSBjb2xzID0gcGsuZ2V0Q29sdW1ucygpOwogICAgICAgIGlm\nIChjb2xzLmxlbmd0aCA9PSAxKQogICAgICAgICAgICBhZGRBdHRyaWJ1dGUo\nImNvbHVtbiIsIGNvbHNbMF0uZ2V0TmFtZSgpKTsKICAgICAgICBzdGFydEVs\nZW1lbnQoInBrIik7CgogICAgICAgIC8vIGNvbHVtbnMKICAgICAgICBpZiAo\nY29scy5sZW5ndGggPiAxKQogICAgICAgICAgICBmb3IgKGludCBpID0gMDsg\naSA8IGNvbHMubGVuZ3RoOyBpKyspCiAgICAgICAgICAgICAgICBzZXJpYWxp\nemVPbihjb2xzW2ldKTsKCiAgICAgICAgZW5kRWxlbWVudCgicGsiKTsKICAg\nIH0KCiAgICAvKioKICAgICAqIFNlcmlhbGl6ZXMgdGhlIGdpdmVuIGluZGV4\nLgogICAgICovCiAgICBwcml2YXRlIHZvaWQgc2VyaWFsaXplSW5kZXgoSW5k\nZXggaWR4KQogICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24gewogICAgICAg\nIGFkZEF0dHJpYnV0ZSgibmFtZSIsIGlkeC5nZXROYW1lKCkpOwogICAgICAg\nIGlmIChpZHguaXNVbmlxdWUoKSkKICAgICAgICAgICAgYWRkQXR0cmlidXRl\nKCJ1bmlxdWUiLCAidHJ1ZSIpOwogICAgICAgIENvbHVtbltdIGNvbHMgPSBp\nZHguZ2V0Q29sdW1ucygpOwogICAgICAgIGlmIChjb2xzLmxlbmd0aCA9PSAx\nKQogICAgICAgICAgICBhZGRBdHRyaWJ1dGUoImNvbHVtbiIsIGNvbHNbMF0u\nZ2V0TmFtZSgpKTsKICAgICAgICBzdGFydEVsZW1lbnQoImluZGV4Iik7Cgog\nICAgICAgIC8vIGNvbHVtbnMKICAgICAgICBpZiAoY29scy5sZW5ndGggPiAx\nKQogICAgICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGNvbHMubGVuZ3Ro\nOyBpKyspCiAgICAgICAgICAgICAgICBzZXJpYWxpemVPbihjb2xzW2ldKTsK\nCiAgICAgICAgZW5kRWxlbWVudCgiaW5kZXgiKTsKICAgIH0KCiAgICAvKioK\nICAgICAqIFNlcmlhbGl6ZXMgdGhlIGdpdmVuIGNvbnN0cmFpbnQuCiAgICAg\nKi8KICAgIHByaXZhdGUgdm9pZCBzZXJpYWxpemVVbmlxdWUoVW5pcXVlIHVu\ncSkKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICBpZiAo\ndW5xLmdldE5hbWUoKSAhPSBudWxsKQogICAgICAgICAgICBhZGRBdHRyaWJ1\ndGUoIm5hbWUiLCB1bnEuZ2V0TmFtZSgpKTsKICAgICAgICBpZiAodW5xLmlz\nRGVmZXJyZWQoKSkKICAgICAgICAgICAgYWRkQXR0cmlidXRlKCJkZWZlcnJl\nZCIsICJ0cnVlIik7CiAgICAgICAgQ29sdW1uW10gY29scyA9IHVucS5nZXRD\nb2x1bW5zKCk7CiAgICAgICAgaWYgKGNvbHMubGVuZ3RoID09IDEpCiAgICAg\nICAgICAgIGFkZEF0dHJpYnV0ZSgiY29sdW1uIiwgY29sc1swXS5nZXROYW1l\nKCkpOwogICAgICAgIHN0YXJ0RWxlbWVudCgidW5pcXVlIik7CgogICAgICAg\nIC8vIGNvbHVtbnMKICAgICAgICBpZiAoY29scy5sZW5ndGggPiAxKQogICAg\nICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGNvbHMubGVuZ3RoOyBpKysp\nCiAgICAgICAgICAgICAgICBzZXJpYWxpemVPbihjb2xzW2ldKTsKCiAgICAg\nICAgZW5kRWxlbWVudCgidW5pcXVlIik7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBTZXJpYWxpemVzIHRoZSBnaXZlbiBmb3JlaWduIGtleS4KICAgICAqLwog\nICAgcHJpdmF0ZSB2b2lkIHNlcmlhbGl6ZUZvcmVpZ25LZXkoRm9yZWlnbktl\neSBmaykKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICBp\nZiAoZmsuZ2V0TmFtZSgpICE9IG51bGwpCiAgICAgICAgICAgIGFkZEF0dHJp\nYnV0ZSgibmFtZSIsIGZrLmdldE5hbWUoKSk7CgogICAgICAgIGlmIChmay5p\nc0RlZmVycmVkKCkpCiAgICAgICAgICAgIGFkZEF0dHJpYnV0ZSgiZGVmZXJy\nZWQiLCAidHJ1ZSIpOwoKICAgICAgICBpZiAoZmsuZ2V0RGVsZXRlQWN0aW9u\nKCkgIT0gRm9yZWlnbktleS5BQ1RJT05fTk9ORSkKICAgICAgICAgICAgYWRk\nQXR0cmlidXRlKCJkZWxldGUtYWN0aW9uIiwgRm9yZWlnbktleS5nZXRBY3Rp\nb25OYW1lCiAgICAgICAgICAgICAgICAoZmsuZ2V0RGVsZXRlQWN0aW9uKCkp\nKTsKICAgICAgICBpZiAoZmsuZ2V0VXBkYXRlQWN0aW9uKCkgIT0gRm9yZWln\nbktleS5BQ1RJT05fTk9ORQogICAgICAgICAgICAmJiBmay5nZXRVcGRhdGVB\nY3Rpb24oKSAhPSBGb3JlaWduS2V5LkFDVElPTl9SRVNUUklDVCkKICAgICAg\nICAgICAgYWRkQXR0cmlidXRlKCJ1cGRhdGUtYWN0aW9uIiwgRm9yZWlnbktl\neS5nZXRBY3Rpb25OYW1lCiAgICAgICAgICAgICAgICAoZmsuZ2V0VXBkYXRl\nQWN0aW9uKCkpKTsKCiAgICAgICAgQ29sdW1uW10gY29scyA9IGZrLmdldENv\nbHVtbnMoKTsKICAgICAgICBDb2x1bW5bXSBwa3MgPSBmay5nZXRQcmltYXJ5\nS2V5Q29sdW1ucygpOwogICAgICAgIENvbHVtbltdIGNvbnN0cyA9IGZrLmdl\ndENvbnN0YW50Q29sdW1ucygpOwogICAgICAgIENvbHVtbltdIGNvbnN0c1BL\nID0gZmsuZ2V0Q29uc3RhbnRQcmltYXJ5S2V5Q29sdW1ucygpOwogICAgICAg\nIGFkZEF0dHJpYnV0ZSgidG8tdGFibGUiLCBmay5nZXRQcmltYXJ5S2V5VGFi\nbGUoKS5nZXRGdWxsTmFtZSgpKTsKICAgICAgICBpZiAoY29scy5sZW5ndGgg\nPT0gMSAmJiBjb25zdHMubGVuZ3RoID09IDAgJiYgY29uc3RzUEsubGVuZ3Ro\nID09IDApCiAgICAgICAgICAgIGFkZEF0dHJpYnV0ZSgiY29sdW1uIiwgY29s\nc1swXS5nZXROYW1lKCkpOwogICAgICAgIHN0YXJ0RWxlbWVudCgiZmsiKTsK\nCiAgICAgICAgLy8gY29sdW1ucwogICAgICAgIGlmIChjb2xzLmxlbmd0aCA+\nIDEgfHwgY29uc3RzLmxlbmd0aCA+IDAgfHwgY29uc3RzUEsubGVuZ3RoID4g\nMCkKICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBjb2xzLmxlbmd0\naDsgaSsrKQogICAgICAgICAgICAgICAgc2VyaWFsaXplSm9pbihjb2xzW2ld\nLCBwa3NbaV0pOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgY29uc3Rz\nLmxlbmd0aDsgaSsrKQogICAgICAgICAgICBzZXJpYWxpemVKb2luKGNvbnN0\nc1tpXSwgZmsuZ2V0Q29uc3RhbnQoY29uc3RzW2ldKSk7CiAgICAgICAgZm9y\nIChpbnQgaSA9IDA7IGkgPCBjb25zdHNQSy5sZW5ndGg7IGkrKykKICAgICAg\nICAgICAgc2VyaWFsaXplSm9pbihmay5nZXRQcmltYXJ5S2V5Q29uc3RhbnQo\nY29uc3RzUEtbaV0pLCBjb25zdHNQS1tpXSk7CgogICAgICAgIGVuZEVsZW1l\nbnQoImZrIik7CiAgICB9CgogICAgLyoqCiAgICAgKiBTZXJpYWxpemVzIHRo\nZSBnaXZlbiBjb2x1bW4gdG8gYW4gJ29uJyBlbGVtZW50LgogICAgICovCiAg\nICBwcml2YXRlIHZvaWQgc2VyaWFsaXplT24oQ29sdW1uIGNvbCkKICAgICAg\nICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICBhZGRBdHRyaWJ1dGUo\nImNvbHVtbiIsIGNvbC5nZXROYW1lKCkpOwogICAgICAgIHN0YXJ0RWxlbWVu\ndCgib24iKTsKICAgICAgICBlbmRFbGVtZW50KCJvbiIpOwogICAgfQoKICAg\nIC8qKgogICAgICogU2VyaWFsaXplcyB0aGUgZ2l2ZW4gY29sdW1ucyB0byBh\nICdqb2luJyBlbGVtZW50LgogICAgICovCiAgICBwcml2YXRlIHZvaWQgc2Vy\naWFsaXplSm9pbihDb2x1bW4gY29sLCBDb2x1bW4gcGspCiAgICAgICAgdGhy\nb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgYWRkQXR0cmlidXRlKCJjb2x1\nbW4iLCBjb2wuZ2V0TmFtZSgpKTsKICAgICAgICBhZGRBdHRyaWJ1dGUoInRv\nLWNvbHVtbiIsIHBrLmdldE5hbWUoKSk7CiAgICAgICAgc3RhcnRFbGVtZW50\nKCJqb2luIik7CiAgICAgICAgZW5kRWxlbWVudCgiam9pbiIpOwogICAgfQoK\nICAgIC8qKgogICAgICogU2VyaWFsaXplcyB0aGUgZ2l2ZW4gdmFsdWVzIHRv\nIGEgJ2pvaW4nIGVsZW1lbnQuCiAgICAgKi8KICAgIHByaXZhdGUgdm9pZCBz\nZXJpYWxpemVKb2luKE9iamVjdCB2YWwsIENvbHVtbiBwaykKICAgICAgICB0\naHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICBhZGRBdHRyaWJ1dGUoInZh\nbHVlIiwgc3RyaW5naWZ5Q29uc3RhbnQodmFsKSk7CiAgICAgICAgYWRkQXR0\ncmlidXRlKCJ0by1jb2x1bW4iLCBway5nZXROYW1lKCkpOwogICAgICAgIHN0\nYXJ0RWxlbWVudCgiam9pbiIpOwogICAgICAgIGVuZEVsZW1lbnQoImpvaW4i\nKTsKICAgIH0KCiAgICAvKioKICAgICAqIFNlcmlhbGl6ZXMgdGhlIGdpdmVu\nIHZhbHVlcyB0byBhICdqb2luJyBlbGVtZW50LgogICAgICovCiAgICBwcml2\nYXRlIHZvaWQgc2VyaWFsaXplSm9pbihDb2x1bW4gY29sLCBPYmplY3QgdmFs\nKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24gewogICAgICAgIGFkZEF0\ndHJpYnV0ZSgiY29sdW1uIiwgY29sLmdldE5hbWUoKSk7CiAgICAgICAgYWRk\nQXR0cmlidXRlKCJ2YWx1ZSIsIHN0cmluZ2lmeUNvbnN0YW50KHZhbCkpOwog\nICAgICAgIHN0YXJ0RWxlbWVudCgiam9pbiIpOwogICAgICAgIGVuZEVsZW1l\nbnQoImpvaW4iKTsKICAgIH0KCiAgICAvKioKICAgICAqIFN0cmluZ2lmeSB0\naGUgZ2l2ZW4gY29uc3RhbnQgdmFsdWUuCiAgICAgKi8KICAgIHByaXZhdGUg\nc3RhdGljIFN0cmluZyBzdHJpbmdpZnlDb25zdGFudChPYmplY3QgdmFsKSB7\nCiAgICAgICAgaWYgKHZhbCA9PSBudWxsKQogICAgICAgICAgICByZXR1cm4g\nIm51bGwiOwogICAgICAgIGlmICh2YWwgaW5zdGFuY2VvZiBTdHJpbmcpCiAg\nICAgICAgICAgIHJldHVybiAiJyIgKyB2YWwgKyAiJyI7CiAgICAgICAgcmV0\ndXJuIHZhbC50b1N0cmluZygpOwogICAgfQp9Cg==\n","encoding":"base64"}

