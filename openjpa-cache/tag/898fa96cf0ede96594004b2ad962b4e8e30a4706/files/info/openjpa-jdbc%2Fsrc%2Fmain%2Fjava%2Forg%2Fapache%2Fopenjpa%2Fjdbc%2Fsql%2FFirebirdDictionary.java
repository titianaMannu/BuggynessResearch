{"sha":"4eebd4cf6bd7d3c71172cae2634afaa78d6f7fb2","node_id":"MDQ6QmxvYjIwNjM2NDo0ZWViZDRjZjZiZDdkM2M3MTE3MmNhZTI2MzRhZmFhNzhkNmY3ZmIy","size":19276,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/4eebd4cf6bd7d3c71172cae2634afaa78d6f7fb2","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zcWw7CgppbXBvcnQg\namF2YS5zcWwuQ29ubmVjdGlvbjsKaW1wb3J0IGphdmEuc3FsLkRhdGFiYXNl\nTWV0YURhdGE7CmltcG9ydCBqYXZhLnNxbC5SZXN1bHRTZXQ7CmltcG9ydCBq\nYXZhLnNxbC5TUUxFeGNlcHRpb247CmltcG9ydCBqYXZhLnNxbC5UeXBlczsK\naW1wb3J0IGphdmEudGV4dC5NZXNzYWdlRm9ybWF0OwppbXBvcnQgamF2YS51\ndGlsLkFycmF5czsKaW1wb3J0IGphdmEudXRpbC5TZXQ7CmltcG9ydCBqYXZh\nLnV0aWwucmVnZXguTWF0Y2hlcjsKaW1wb3J0IGphdmEudXRpbC5yZWdleC5Q\nYXR0ZXJuOwoKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLmlkZW50\naWZpZXIuREJJZGVudGlmaWVyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLmpkYmMua2VybmVsLmV4cHMuRmlsdGVyVmFsdWU7CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEuamRiYy5zY2hlbWEuQ29sdW1uOwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1hLkZvcmVpZ25LZXk7CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hlbWEuSW5kZXg7CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hlbWEuU2VxdWVuY2U7CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hlbWEuVW5pcXVlOwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi5pZGVudGlmaWVyLklkZW50aWZp\nZXJVdGlsOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51dGlsLkxv\nY2FsaXplcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLlVuc3Vw\ncG9ydGVkRXhjZXB0aW9uOwoKLyoqCiAqIERpY3Rpb25hcnkgZm9yIEZpcmVi\naXJkLiBTdXBwb3J0cyBGaXJlYmlyZCB2ZXJzaW9ucyAxLjUsIDIuMCBhbmQg\nMi4xLgogKi8KcHVibGljIGNsYXNzIEZpcmViaXJkRGljdGlvbmFyeQogICAg\nZXh0ZW5kcyBEQkRpY3Rpb25hcnkgewoKICAgIHB1YmxpYyBpbnQgZmlyZWJp\ncmRWZXJzaW9uID0gMDsKICAgIHB1YmxpYyBpbnQgaW5kZXhlZFZhcmNoYXJN\nYXhTaXplRkIxNSA9IDI1MjsKICAgIHB1YmxpYyBTdHJpbmcgcmFuZ2VTeW50\nYXggPSBudWxsOwogICAgcHJvdGVjdGVkIGxvbmcgbWF4Um93TnVtYmVySW5S\nYW5nZSA9IDE2MDAwMDAwMDAwTDsKCiAgICBwcm90ZWN0ZWQgU3RyaW5nIGFs\ndGVyU2VxdWVuY2VTUUxGQjE1ID0gIlNFVCBHRU5FUkFUT1IgezB9IFRPIHsx\nfSI7CiAgICBwcm90ZWN0ZWQgU3RyaW5nIGFsdGVyU2VxdWVuY2VTUUxGQjIw\nID0KICAgICAgICAiQUxURVIgU0VRVUVOQ0UgezB9IFJFU1RBUlQgV0lUSCB7\nMX0iOwogICAgcHJvdGVjdGVkIFN0cmluZyBjcmVhdGVTZXF1ZW5jZVNRTEZC\nMTUgPSAiQ1JFQVRFIEdFTkVSQVRPUiB7MH0iOwogICAgcHJvdGVjdGVkIFN0\ncmluZyBjcmVhdGVTZXF1ZW5jZVNRTEZCMjAgPSAiQ1JFQVRFIFNFUVVFTkNF\nIHswfSI7CiAgICBwcm90ZWN0ZWQgU3RyaW5nIGRyb3BTZXF1ZW5jZVNRTEZC\nMTUgPSAiRFJPUCBHRU5FUkFUT1IgIjsKICAgIHByb3RlY3RlZCBTdHJpbmcg\nbmV4dFNlcXVlbmNlUXVlcnlGQjE1ID0KICAgICAgICAiU0VMRUNUIEdFTl9J\nRCh7MH0sIDEpIEZST00gUkRCJERBVEFCQVNFIjsKICAgIHByb3RlY3RlZCBT\ndHJpbmcgbmV4dFNlcXVlbmNlUXVlcnlGQjIwID0KICAgICAgICAiU0VMRUNU\nIE5FWFQgVkFMVUUgRk9SIHswfSBGUk9NIFJEQiREQVRBQkFTRSI7CgogICAg\ncHJvdGVjdGVkIFN0cmluZyBhbHRlclNlcXVlbmNlU1FMID0gYWx0ZXJTZXF1\nZW5jZVNRTEZCMjA7CiAgICBwcm90ZWN0ZWQgU3RyaW5nIGNyZWF0ZVNlcXVl\nbmNlU1FMID0gY3JlYXRlU2VxdWVuY2VTUUxGQjIwOwoKICAgIHB1YmxpYyBz\ndGF0aWMgZmluYWwgaW50IEZCX1ZFUlNJT05fMTUgPSAxNTsKICAgIHB1Ymxp\nYyBzdGF0aWMgZmluYWwgaW50IEZCX1ZFUlNJT05fMjAgPSAyMDsKICAgIHB1\nYmxpYyBzdGF0aWMgZmluYWwgaW50IEZCX1ZFUlNJT05fMjEgPSAyMTsKCiAg\nICBwdWJsaWMgc3RhdGljIGZpbmFsIFN0cmluZyBSQU5HRV9TWU5UQVhfRklS\nU1RfU0tJUCA9ICJmaXJzdHNraXAiOwogICAgcHVibGljIHN0YXRpYyBmaW5h\nbCBTdHJpbmcgUkFOR0VfU1lOVEFYX1JPV1MgPSAicm93cyI7CgogICAgcHJp\ndmF0ZSBzdGF0aWMgZmluYWwgTG9jYWxpemVyIF9sb2MgPQogICAgICAgIExv\nY2FsaXplci5mb3JQYWNrYWdlKEZpcmViaXJkRGljdGlvbmFyeS5jbGFzcyk7\nCgogICAgQFN1cHByZXNzV2FybmluZ3MoInVuY2hlY2tlZCIpCiAgICBwdWJs\naWMgRmlyZWJpcmREaWN0aW9uYXJ5KCkgewogICAgICAgIHBsYXRmb3JtID0g\nIkZpcmViaXJkIjsKICAgICAgICB2YWxpZGF0aW9uU1FMID0gIlNFTEVDVCAx\nIEZST00gUkRCJERBVEFCQVNFIjsKICAgICAgICBzdXBwb3J0c0RlZmVycmVk\nQ29uc3RyYWludHMgPSBmYWxzZTsKCiAgICAgICAgdXNlR2V0U3RyaW5nRm9y\nQ2xvYnMgPSB0cnVlOwogICAgICAgIHVzZVNldFN0cmluZ0ZvckNsb2JzID0g\ndHJ1ZTsKICAgICAgICB1c2VHZXRCeXRlc0ZvckJsb2JzID0gdHJ1ZTsKICAg\nICAgICB1c2VTZXRCeXRlc0ZvckJsb2JzID0gdHJ1ZTsKCiAgICAgICAgbWF4\nVGFibGVOYW1lTGVuZ3RoID0gMzE7CiAgICAgICAgbWF4Q29sdW1uTmFtZUxl\nbmd0aCA9IDMxOwogICAgICAgIG1heENvbnN0cmFpbnROYW1lTGVuZ3RoID0g\nMzE7CiAgICAgICAgbWF4SW5kZXhOYW1lTGVuZ3RoID0gMzE7CgogICAgICAg\nIHN1cHBvcnRzU2VsZWN0U3RhcnRJbmRleCA9IHRydWU7CiAgICAgICAgc3Vw\ncG9ydHNTZWxlY3RFbmRJbmRleCA9IHRydWU7CgogICAgICAgIHN1cHBvcnRz\nTXVsdGlwbGVOb250cmFuc2FjdGlvbmFsUmVzdWx0U2V0cyA9IGZhbHNlOwoK\nICAgICAgICBuZXh0U2VxdWVuY2VRdWVyeSA9IG5leHRTZXF1ZW5jZVF1ZXJ5\nRkIyMDsKICAgICAgICBzZXF1ZW5jZVNRTCA9CiAgICAgICAgICAgICJTRUxF\nQ1QgTlVMTCBBUyBTRVFVRU5DRV9TQ0hFTUEsIFJEQiRHRU5FUkFUT1JfTkFN\nRSAiCiAgICAgICAgICAgICAgICArICJBUyBTRVFVRU5DRV9OQU1FIEZST00g\nUkRCJEdFTkVSQVRPUlMgIgogICAgICAgICAgICAgICAgKyAiV0hFUkUgKFJE\nQiRTWVNURU1fRkxBRyBJUyBOVUxMIE9SIFJEQiRTWVNURU1fRkxBRyA9IDAp\nICI7CiAgICAgICAgc2VxdWVuY2VOYW1lU1FMID0gIkFORCBSREIkR0VORVJB\nVE9SX05BTUUgPSA/IjsKCiAgICAgICAgLy8gQSByb3VnaCBzdW0gb2YgcmVz\nZXJ2ZWQgd29yZHMgaW4gRmlyZWJpcmQgMS4wIC0gMi4xLgogICAgICAgIHJl\nc2VydmVkV29yZFNldC5hZGRBbGwoQXJyYXlzLmFzTGlzdChuZXcgU3RyaW5n\nW10geyAiQUNUSVZFIiwgIkFETUlOIiwKICAgICAgICAgICAgIkFGVEVSIiwg\nIkFTQ0VORElORyIsICJBVVRPIiwgIkFVVE9EREwiLCAiQkFTRUQiLCAiQkFT\nRU5BTUUiLAogICAgICAgICAgICAiQkFTRV9OQU1FIiwgIkJFRk9SRSIsICJC\nSUdJTlQiLCAiQkxPQiIsICJCTE9CRURJVCIsICJCVUZGRVIiLAogICAgICAg\nICAgICAiQ0FDSEUiLCAiQ0hFQ0tfUE9JTlRfTEVOIiwgIkNIRUNLX1BPSU5U\nX0xFTkdUSCIsICJDT01QSUxFVElNRSIsCiAgICAgICAgICAgICJDT01QVVRF\nRCIsICJDTE9TRSIsICJDT05ESVRJT05BTCIsICJDT05UQUlOSU5HIiwgIkNT\nVFJJTkciLAogICAgICAgICAgICAiQ1VSUkVOVF9DT05ORUNUSU9OIiwgIkNV\nUlJFTlRfUk9MRSIsICJDVVJSRU5UX1RSQU5TQUNUSU9OIiwKICAgICAgICAg\nICAgIkRBVEFCQVNFIiwgIkRCX0tFWSIsICJERUJVRyIsICJERVNDRU5ESU5H\nIiwgIkRPIiwgIkVDSE8iLCAiRURJVCIsCiAgICAgICAgICAgICJFTlRSWV9Q\nT0lOVCIsICJFVkVOVCIsICJFWElUIiwgIkVYVEVSTiIsICJGSUxFIiwgIkZJ\nTFRFUiIsCiAgICAgICAgICAgICJGUkVFX0lUIiwgIkZVTkNUSU9OIiwgIkdE\nU0NPREUiLCAiR0VORVJBVE9SIiwgIkdFTl9JRCIsICJHTE9CQUwiLAogICAg\nICAgICAgICAiR09UTyIsICJHUk9VUF9DT01NSVRfV0FJVCIsICJHUk9VUF9D\nT01NSVRfV0FJVF9USU1FIiwgIkhFTFAiLAogICAgICAgICAgICAiSUYiLCAi\nSU5BQ1RJVkUiLCAiSU5ERVgiLCAiSU5JVCIsICJJTlBVVF9UWVBFIiwgIklT\nUUwiLAogICAgICAgICAgICAiTENfTUVTU0FHRVMiLCAiTENfVFlQRSIsICJM\nRVYiLCAiTE9HRklMRSIsICJMT0dfQlVGRkVSX1NJWkUiLAogICAgICAgICAg\nICAiTE9HX0JVRl9TSVpFIiwgIkxPTkciLCAiTUFOVUFMIiwgIk1BWElNVU0i\nLCAiTUFYSU1VTV9TRUdNRU5UIiwKICAgICAgICAgICAgIk1BWF9TRUdNRU5U\nIiwgIk1FUkdFIiwgIk1FU1NBR0UiLCAiTUlOVVRFIiwgIk1PRFVMRV9OQU1F\nIiwKICAgICAgICAgICAgIk5PQVVUTyIsICJOVU1fTE9HX0JVRlMiLCAiTlVN\nX0xPR19CVUZGRVJTIiwgIk9VVFBVVF9UWVBFIiwKICAgICAgICAgICAgIk9W\nRVJGTE9XIiwgIlBBR0UiLCAiUEFHRUxFTkdUSCIsICJQQUdFUyIsICJQQUdF\nX1NJWkUiLAogICAgICAgICAgICAiUEFSQU1FVEVSIiwgIlBBU1NXT1JEIiwg\nIlBMQU4iLCAiUE9TVF9FVkVOVCIsICJQUk9DRURVUkUiLAogICAgICAgICAg\nICAiUFJPVEVDVEVEIiwgIlFVSVQiLCAiUkFXX1BBUlRJVElPTlMiLCAiUkRC\nJERCX0tFWSIsCiAgICAgICAgICAgICJSRUNPUkRfVkVSU0lPTiIsICJSRUNS\nRUFURSIsICJSRUxFQVNFIiwgIlJFU0VSViIsICJSRVNFUlZJTkciLAogICAg\nICAgICAgICAiUkVUQUlOIiwgIlJFVFVSTiIsICJSRVRVUk5JTkdfVkFMVUVT\nIiwgIlJFVFVSTlMiLCAiUk9MRSIsCiAgICAgICAgICAgICJSVU5USU1FIiwg\nIlNBVkVQT0lOVCIsICJTRUdNRU5UIiwgIlNIQURPVyIsICJTSEFSRUQiLCAi\nU0hFTEwiLAogICAgICAgICAgICAiU0hPVyIsICJTSU5HVUxBUiIsICJTTkFQ\nU0hPVCIsICJTT1JUIiwgIlNRTFdBUk5JTkciLCAiU1RBQklMSVRZIiwKICAg\nICAgICAgICAgIlNUQVJUIiwgIlNUQVJUSU5HIiwgIlNUQVJUUyIsICJTVEFU\nRU1FTlQiLCAiU1RBVElDIiwgIlNUQVRJU1RJQ1MiLAogICAgICAgICAgICAi\nU1VCX1RZUEUiLCAiU1VTUEVORCIsICJURVJNSU5BVE9SIiwgIlRSSUdHRVIi\nLCAiVkFSSUFCTEUiLAogICAgICAgICAgICAiVkVSU0lPTiIsICJXQUlUIiwg\nIldFRUtEQVkiLCAiV0hJTEUiIH0pKTsKCiAgICAgICAgYmluYXJ5VHlwZU5h\nbWUgPSAiQkxPQiI7CiAgICAgICAgYml0VHlwZU5hbWUgPSAiU01BTExJTlQi\nOwogICAgICAgIGNoYXJUeXBlTmFtZSA9ICJDSEFSKDEpIjsKICAgICAgICBj\nbG9iVHlwZU5hbWUgPSAiQkxPQiBTVUJfVFlQRSAxIjsKICAgICAgICBkb3Vi\nbGVUeXBlTmFtZSA9ICJET1VCTEUgUFJFQ0lTSU9OIjsKICAgICAgICBmbG9h\ndFR5cGVOYW1lID0gIkRPVUJMRSBQUkVDSVNJT04iOwogICAgICAgIGxvbmdW\nYXJiaW5hcnlUeXBlTmFtZSA9ICJCTE9CIjsKICAgICAgICBsb25nVmFyY2hh\nclR5cGVOYW1lID0gIkJMT0IgU1VCX1RZUEUgMSI7CiAgICAgICAgcmVhbFR5\ncGVOYW1lID0gIkZMT0FUIjsKICAgICAgICBzbWFsbGludFR5cGVOYW1lID0g\nIlNNQUxMSU5UIjsKICAgICAgICB0aW55aW50VHlwZU5hbWUgPSAiU01BTExJ\nTlQiOwogICAgICAgIHZhcmJpbmFyeVR5cGVOYW1lID0gIkJMT0IiOwoKICAg\nICAgICBzdXBwb3J0c0xvY2tpbmdXaXRoRGlzdGluY3RDbGF1c2UgPSBmYWxz\nZTsKICAgICAgICBzdXBwb3J0c0xvY2tpbmdXaXRoTXVsdGlwbGVUYWJsZXMg\nPSBmYWxzZTsKICAgICAgICBzdXBwb3J0c0xvY2tpbmdXaXRoT3V0ZXJKb2lu\nID0gZmFsc2U7CiAgICAgICAgc3VwcG9ydHNMb2NraW5nV2l0aElubmVySm9p\nbiA9IGZhbHNlOwogICAgICAgIGZvclVwZGF0ZUNsYXVzZSA9ICJGT1IgVVBE\nQVRFIFdJVEggTE9DSyI7CiAgICAgICAgc3VwcG9ydHNRdWVyeVRpbWVvdXQg\nPSBmYWxzZTsKICAgIH0KCiAgICAvKioKICAgICAqIERldGVybWluZSBGaXJl\nYmlyZCB2ZXJzaW9uIGFuZCBjb25maWd1cmUgaXRzZWxmIGFjY29yZGluZ2x5\nLgogICAgICovCiAgICBAU3VwcHJlc3NXYXJuaW5ncygidW5jaGVja2VkIikK\nICAgIEBPdmVycmlkZQogICAgcHVibGljIHZvaWQgY29ubmVjdGVkQ29uZmln\ndXJhdGlvbihDb25uZWN0aW9uIGNvbm4pIHRocm93cyBTUUxFeGNlcHRpb24g\newogICAgICAgIHN1cGVyLmNvbm5lY3RlZENvbmZpZ3VyYXRpb24oY29ubik7\nCiAgICAgICAgZmlyZWJpcmRWZXJzaW9uID0gZGV0ZXJtaW5lRmlyZWJpcmRW\nZXJzaW9uKGNvbm4pOwogICAgICAgIGRldGVybWluZVJhbmdlU3ludGF4KCk7\nCgogICAgICAgIGlmIChmaXJlYmlyZFZlcnNpb24gPT0gRkJfVkVSU0lPTl8y\nMSkKICAgICAgICAgICAgc2VsZWN0V29yZFNldC5hZGQoIldJVEgiKTsKICAg\nICAgICBpZiAoIShmaXJlYmlyZFZlcnNpb24gPT0gRkJfVkVSU0lPTl8yMSkp\nIHsKICAgICAgICAgICAgY3Jvc3NKb2luQ2xhdXNlID0gIkpPSU4iOwogICAg\nICAgICAgICByZXF1aXJlc0NvbmRpdGlvbkZvckNyb3NzSm9pbiA9IHRydWU7\nCiAgICAgICAgfQogICAgICAgIGlmIChmaXJlYmlyZFZlcnNpb24gPT0gRkJf\nVkVSU0lPTl8xNSkgewogICAgICAgICAgICBzdHJpbmdMZW5ndGhGdW5jdGlv\nbiA9ICJTVFJMRU4oezB9KSI7CiAgICAgICAgICAgIHRyaW1MZWFkaW5nRnVu\nY3Rpb24gPSAiTFRSSU0oezB9KSI7CiAgICAgICAgICAgIHRyaW1UcmFpbGlu\nZ0Z1bmN0aW9uID0gIlJUUklNKHswfSkiOwogICAgICAgICAgICB0cmltQm90\naEZ1bmN0aW9uID0gIkxUUklNKFJUUklNKHswfSkpIjsKICAgICAgICAgICAg\nYWx0ZXJTZXF1ZW5jZVNRTCA9IGFsdGVyU2VxdWVuY2VTUUxGQjE1OwogICAg\nICAgICAgICBjcmVhdGVTZXF1ZW5jZVNRTCA9IGNyZWF0ZVNlcXVlbmNlU1FM\nRkIxNTsKICAgICAgICAgICAgbmV4dFNlcXVlbmNlUXVlcnkgPSBuZXh0U2Vx\ndWVuY2VRdWVyeUZCMTU7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAg\nICogVXNlIGVpdGhlciA8Y29kZT5GSVJTVCAmbHQ7cCZndDsgU0tJUCAmbHQ7\ncSZndDs8L2NvZGU+IG9yCiAgICAgKiA8Y29kZT5ST1dTICZsdDttJmd0OyBU\nTyAmbHQ7biZndDs8L2NvZGU+IHN5bnRheC4gSWYgPGNvZGU+Uk9XUzwvY29k\nZT4KICAgICAqIHZhcmlhbnQgaXMgdXNlZCBhbmQgPGNvZGU+ZW5kPC9jb2Rl\nPiBlcXVhbHMge0BsaW5rIExvbmcjTUFYX1ZBTFVFfSwgYQogICAgICogY29u\nc3RhbnQgaXMgdXNlZCBhcyA8Y29kZT4mbHQ7biZndDs8L2NvZGU+IHZhbHVl\nLgogICAgICovCiAgICBAT3ZlcnJpZGUKICAgIHByb3RlY3RlZCB2b2lkIGFw\ncGVuZFNlbGVjdFJhbmdlKFNRTEJ1ZmZlciBidWYsIGxvbmcgc3RhcnQsIGxv\nbmcgZW5kLAogICAgICAgIGJvb2xlYW4gc3Vic2VsZWN0KSB7CiAgICAgICAg\naWYgKFJBTkdFX1NZTlRBWF9GSVJTVF9TS0lQLmVxdWFscyhyYW5nZVN5bnRh\neCkpIHsKICAgICAgICAgICAgaWYgKGVuZCAhPSBMb25nLk1BWF9WQUxVRSkK\nICAgICAgICAgICAgICAgIGJ1Zi5hcHBlbmQoIiBGSVJTVCAiKS5hcHBlbmRW\nYWx1ZShlbmQgLSBzdGFydCk7CiAgICAgICAgICAgIGlmIChzdGFydCAhPSAw\nKQogICAgICAgICAgICAgICAgYnVmLmFwcGVuZCgiIFNLSVAgIikuYXBwZW5k\nVmFsdWUoc3RhcnQpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoK\nICAgICAgICBidWYuYXBwZW5kKCIgUk9XUyAiKTsKICAgICAgICBpZiAoc3Rh\ncnQgPT0gMCkgewogICAgICAgICAgICBidWYuYXBwZW5kVmFsdWUoZW5kKTsK\nICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgYnVmLmFw\ncGVuZFZhbHVlKHN0YXJ0ICsgMSkuYXBwZW5kKCIgVE8gIik7CiAgICAgICAg\naWYgKGVuZCA9PSBMb25nLk1BWF9WQUxVRSkKICAgICAgICAgICAgYnVmLmFw\ncGVuZFZhbHVlKG1heFJvd051bWJlckluUmFuZ2UpOwogICAgICAgIGVsc2UK\nICAgICAgICAgICAgYnVmLmFwcGVuZFZhbHVlKGVuZCk7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBEZXRlcm1pbmUgRmlyZWJpcmQgdmVyc2lvbiBlaXRoZXIg\nYnkgdXNpbmcgSkRCQyAzIG1ldGhvZHMgb3IsIGlmIHRoZXkKICAgICAqIGFy\nZSBub3QgYXZhaWxhYmxlLCBieSBwYXJzaW5nIHRoZSB2YWx1ZSByZXR1cm5l\nZCBieQogICAgICoge0BsaW5rcGxhaW4gRGF0YWJhc2VNZXRhRGF0YSNnZXRE\nYXRhYmFzZVByb2R1Y3RWZXJzaW9uKCl9LiBVc2VyIGNhbgogICAgICogb3Zl\ncnJpZGUgRmlyZWJpcmQgdmVyc2lvbi4KICAgICAqLwogICAgcHJvdGVjdGVk\nIGludCBkZXRlcm1pbmVGaXJlYmlyZFZlcnNpb24oQ29ubmVjdGlvbiBjb24p\nCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgLy8gTGV0\nIHVzZXIgb3ZlcnJpZGUgZmlyZWJpcmRWZXJzaW9uLgogICAgICAgIGlmIChm\naXJlYmlyZFZlcnNpb24gIT0gMCkKICAgICAgICAgICAgcmV0dXJuIGZpcmVi\naXJkVmVyc2lvbjsKCiAgICAgICAgRGF0YWJhc2VNZXRhRGF0YSBtZXRhRGF0\nYSA9IGNvbi5nZXRNZXRhRGF0YSgpOwogICAgICAgIGludCBtYWogPSAwOwog\nICAgICAgIGludCBtaW4gPSAwOwogICAgICAgIGlmIChpc0pEQkMzKSB7CiAg\nICAgICAgICAgIG1haiA9IG1ldGFEYXRhLmdldERhdGFiYXNlTWFqb3JWZXJz\naW9uKCk7CiAgICAgICAgICAgIG1pbiA9IG1ldGFEYXRhLmdldERhdGFiYXNl\nTWlub3JWZXJzaW9uKCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAg\ndHJ5IHsKICAgICAgICAgICAgICAgIC8vIFRoZSBwcm9kdWN0IHZlcnNpb24g\nbG9va3MgbGlrZQogICAgICAgICAgICAgICAgLy8gIkxJLVYyLjEuMS4xNzkx\nMCBGaXJlYmlyZCAyLjEsTEktVjIuMS4xLjE3OTEwIEZpcmViaXJkCiAgICAg\nICAgICAgICAgICAvLyAyLjEvdGNwIChob3N0bmFtZSkvUDEwIiBvcgogICAg\nICAgICAgICAgICAgLy8gIldJLVYxLjUuNS40OTI2IEZpcmViaXJkIDEuNTJX\nSS1WMS41LjUuNDkyNiBGaXJlYmlyZCAxLjUvdGNwCiAgICAgICAgICAgICAg\nICAvLyAoaG9zdG5hbWUpL1AxMCIKICAgICAgICAgICAgICAgIFN0cmluZyBw\ncm9kdWN0VmVyc2lvbiA9IG1ldGFEYXRhLmdldERhdGFiYXNlUHJvZHVjdFZl\ncnNpb24oKTsKICAgICAgICAgICAgICAgIFBhdHRlcm4gcCA9IFBhdHRlcm4u\nY29tcGlsZSgiLiotVihcXGQpXFwuKFxcZClcXC4uKiIsCiAgICAgICAgICAg\nICAgICAgICAgUGF0dGVybi5DQVNFX0lOU0VOU0lUSVZFKTsKICAgICAgICAg\nICAgICAgIE1hdGNoZXIgbSA9IHAubWF0Y2hlcihwcm9kdWN0VmVyc2lvbik7\nCiAgICAgICAgICAgICAgICBtLm1hdGNoZXMoKTsKICAgICAgICAgICAgICAg\nIFN0cmluZyBtYWpTdHJpbmcgPSBtLmdyb3VwKDEpOwogICAgICAgICAgICAg\nICAgU3RyaW5nIG1pblN0cmluZyA9IG0uZ3JvdXAoMik7CiAgICAgICAgICAg\nICAgICBtYWogPSBJbnRlZ2VyLnBhcnNlSW50KG1halN0cmluZyk7CiAgICAg\nICAgICAgICAgICBtaW4gPSBJbnRlZ2VyLnBhcnNlSW50KG1pblN0cmluZyk7\nCiAgICAgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAg\nICAgICAgICAvLyBXZSBkb24ndCB1bmRlcnN0YW5kIHRoZSB2ZXJzaW9uIGZv\ncm1hdC4KICAgICAgICAgICAgICAgIGlmIChsb2cuaXNXYXJuRW5hYmxlZCgp\nKQogICAgICAgICAgICAgICAgICAgIGxvZy53YXJuKGUudG9TdHJpbmcoKSwg\nZSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgaWYgKG1haiA8\nIDIpCiAgICAgICAgICAgIHJldHVybiBGQl9WRVJTSU9OXzE1OwogICAgICAg\nIGlmIChtYWogPT0gMiAmJiBtaW4gPT0gMCkKICAgICAgICAgICAgcmV0dXJu\nIEZCX1ZFUlNJT05fMjA7CiAgICAgICAgcmV0dXJuIEZCX1ZFUlNJT05fMjE7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBEZXRlcm1pbmUgcmFuZ2Ugc3ludGF4\nIHRvIGJlIHVzZWQgZGVwZW5kaW5nIG9uIEZpcmViaXJkIHZlcnNpb24uCiAg\nICAgKiBVc2VyIGNhbiBvdmVycmlkZSByYW5nZSBzeW50YXguCiAgICAgKi8K\nICAgIHByb3RlY3RlZCB2b2lkIGRldGVybWluZVJhbmdlU3ludGF4KCkgewog\nICAgICAgIC8vIExldCB1c2VyIG92ZXJyaWRlIHJhbmdlU3ludGF4LgogICAg\nICAgIGlmIChyYW5nZVN5bnRheCA9PSBudWxsKQogICAgICAgICAgICByYW5n\nZVN5bnRheCA9CiAgICAgICAgICAgICAgICAoZmlyZWJpcmRWZXJzaW9uID09\nIEZCX1ZFUlNJT05fMTUpID8gUkFOR0VfU1lOVEFYX0ZJUlNUX1NLSVAKICAg\nICAgICAgICAgICAgICAgICA6IFJBTkdFX1NZTlRBWF9ST1dTOwoKICAgICAg\nICBpZiAoUkFOR0VfU1lOVEFYX0ZJUlNUX1NLSVAuZXF1YWxzKHJhbmdlU3lu\ndGF4KSkKICAgICAgICAgICAgcmFuZ2VQb3NpdGlvbiA9IFJBTkdFX1BSRV9E\nSVNUSU5DVDsKICAgICAgICBlbHNlCiAgICAgICAgICAgIHJhbmdlUG9zaXRp\nb24gPSBSQU5HRV9QT1NUX1NFTEVDVDsKICAgIH0KCiAgICAvKioKICAgICAq\nIFJldHVybiA8Y29kZT4mbHQ7dmFsdWUmZ3Q7IEFTICZsdDt0eXBlJmd0Ozwv\nY29kZT4uCiAgICAgKi8KICAgIEBPdmVycmlkZQogICAgcHVibGljIFN0cmlu\nZyBnZXRQbGFjZWhvbGRlclZhbHVlU3RyaW5nKENvbHVtbiBjb2wpIHsKICAg\nICAgICByZXR1cm4gc3VwZXIuZ2V0UGxhY2Vob2xkZXJWYWx1ZVN0cmluZyhj\nb2wpICsgIiBBUyAiCiAgICAgICAgICAgICsgZ2V0VHlwZU5hbWUoY29sKTsK\nICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiA8Y29kZT4lPC9jb2RlPiBp\nZiA8Y29kZT50YWJsZU5hbWU8L2NvZGU+IGlzIDxjb2RlPm51bGw8L2NvZGU+\nLAogICAgICogb3RoZXJ3aXNlIGRlbGVnYXRlIHRvIHN1cGVyIGltcGxlbWVu\ndGF0aW9uLgogICAgICovCiAgICBAT3ZlcnJpZGUKICAgIHByb3RlY3RlZCBT\ndHJpbmcgZ2V0VGFibGVOYW1lRm9yTWV0YWRhdGEoU3RyaW5nIHRhYmxlTmFt\nZSkgewogICAgICAgIHJldHVybiAodGFibGVOYW1lID09IG51bGwpID8gSWRl\nbnRpZmllclV0aWwuUEVSQ0VOVCA6IAogICAgICAgICAgICBnZXRUYWJsZU5h\nbWVGb3JNZXRhZGF0YShEQklkZW50aWZpZXIubmV3VGFibGUodGFibGVOYW1l\nKSk7CiAgICB9CgogICAgcHJvdGVjdGVkIFN0cmluZyBnZXRUYWJsZU5hbWVG\nb3JNZXRhZGF0YShEQklkZW50aWZpZXIgdGFibGVOYW1lKSB7CiAgICAgICAg\naWYgKERCSWRlbnRpZmllci5pc051bGwodGFibGVOYW1lKSkgewogICAgICAg\nICAgICByZXR1cm4gSWRlbnRpZmllclV0aWwuUEVSQ0VOVDsKICAgICAgICB9\nCiAgICAgICAgcmV0dXJuIHN1cGVyLmdldFRhYmxlTmFtZUZvck1ldGFkYXRh\nKHRhYmxlTmFtZSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gPGNv\nZGU+JTwvY29kZT4gaWYgPGNvZGU+Y29sdW1uTmFtZTwvY29kZT4gaXMgPGNv\nZGU+bnVsbDwvY29kZT4sCiAgICAgKiBvdGhlcndpc2UgZGVsZWdhdGUgdG8g\nc3VwZXIgaW1wbGVtZW50YXRpb24uCiAgICAgKi8KICAgIEBPdmVycmlkZQog\nICAgcHJvdGVjdGVkIFN0cmluZyBnZXRDb2x1bW5OYW1lRm9yTWV0YWRhdGEo\nU3RyaW5nIGNvbHVtbk5hbWUpIHsKICAgICAgICByZXR1cm4gKGNvbHVtbk5h\nbWUgPT0gbnVsbCkgPyAiJSIgOiBzdXBlcgogICAgICAgICAgICAuZ2V0Q29s\ndW1uTmFtZUZvck1ldGFkYXRhKGNvbHVtbk5hbWUpOwogICAgfQoKICAgIC8q\nKgogICAgICogUmV0dXJuCiAgICAgKiA8Y29kZT5BTFRFUiBUQUJMRSAmbHQ7\ndGFibGUgbmFtZSZndDsgRFJPUCAmbHQ7Y29sIG5hbWUmZ3Q7PC9jb2RlPi4K\nICAgICAqLwogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgU3RyaW5nW10gZ2V0\nRHJvcENvbHVtblNRTChDb2x1bW4gY29sdW1uKSB7CiAgICAgICAgcmV0dXJu\nIG5ldyBTdHJpbmdbXSB7ICJBTFRFUiBUQUJMRSAiCiAgICAgICAgICAgICsg\nZ2V0RnVsbE5hbWUoY29sdW1uLmdldFRhYmxlKCksIGZhbHNlKSArICIgRFJP\nUCAiICsgZ2V0Q29sdW1uREJOYW1lKGNvbHVtbikgfTsKICAgIH0KCiAgICAv\nKioKICAgICAqIFJldHVybiBlaXRoZXIKICAgICAqIDxjb2RlPkNSRUFURSBT\nRVFVRU5DRSAmbHQ7c2VxdWVuY2UgbmFtZSZndDs8L2NvZGU+IG9yCiAgICAg\nKiA8Y29kZT5DUkVBVEUgR0VORVJBVE9SICZsdDtzZXF1ZW5jZSBuYW1lJmd0\nOzwvY29kZT4uCiAgICAgKiBJZiBpbml0aWFsIHZhbHVlIG9mIHNlcXVlbmNl\nIGlzIHNldCwgcmV0dXJuIGFsc28KICAgICAqIGFuIGFwcHJvcHJpYXRlIDxj\nb2RlPkFMVEVSPC9jb2RlPiBzdGF0ZW1lbnQuCiAgICAgKi8KICAgIEBPdmVy\ncmlkZQogICAgcHVibGljIFN0cmluZ1tdIGdldENyZWF0ZVNlcXVlbmNlU1FM\nKFNlcXVlbmNlIHNlcSkgewogICAgICAgIFN0cmluZyBzZXFOYW1lID0KICAg\nICAgICAgICAgY2hlY2tOYW1lTGVuZ3RoKGdldEZ1bGxOYW1lKHNlcSksIG1h\neFRhYmxlTmFtZUxlbmd0aCwKICAgICAgICAgICAgICAgICJsb25nLXNlcS1u\nYW1lIik7CiAgICAgICAgU3RyaW5nIGNyZWF0ZVNlcSA9CiAgICAgICAgICAg\nIE1lc3NhZ2VGb3JtYXQuZm9ybWF0KGNyZWF0ZVNlcXVlbmNlU1FMLCBuZXcg\nT2JqZWN0W10geyBzZXFOYW1lIH0pOwogICAgICAgIGlmIChzZXEuZ2V0SW5p\ndGlhbFZhbHVlKCkgPT0gMCkKICAgICAgICAgICAgcmV0dXJuIG5ldyBTdHJp\nbmdbXSB7IGNyZWF0ZVNlcSB9OwoKICAgICAgICAvLyBVc2UgU3RyaW5nLnZh\nbHVlT2YgdG8gZ2V0IHJpZCBvZiBwb3NzaWJsZSBudW1iZXIgZm9ybWF0dGlu\nZy4KICAgICAgICBTdHJpbmcgYWx0ZXJTZXEgPQogICAgICAgICAgICBNZXNz\nYWdlRm9ybWF0LmZvcm1hdChhbHRlclNlcXVlbmNlU1FMLCBuZXcgT2JqZWN0\nW10geyBzZXFOYW1lLAogICAgICAgICAgICAgICAgU3RyaW5nLnZhbHVlT2Yo\nc2VxLmdldEluaXRpYWxWYWx1ZSgpKSB9KTsKICAgICAgICByZXR1cm4gbmV3\nIFN0cmluZ1tdIHsgY3JlYXRlU2VxLCBhbHRlclNlcSB9OwogICAgfQoKICAg\nIC8qKgogICAgICogUmV0dXJuIEZpcmViaXJkLXNwZWNpZmljIHN0YXRlbWVu\ndCB0byBzZWxlY3QgdGhlIGxpc3Qgb2Ygc2VxdWVuY2VzLgogICAgICovCiAg\nICBAT3ZlcnJpZGUKICAgIHByb3RlY3RlZCBTdHJpbmcgZ2V0U2VxdWVuY2Vz\nU1FMKFN0cmluZyBzY2hlbWFOYW1lLCBTdHJpbmcgc2VxdWVuY2VOYW1lKSB7\nCiAgICAgICAgcmV0dXJuIGdldFNlcXVlbmNlc1NRTChEQklkZW50aWZpZXIu\nbmV3U2NoZW1hKHNjaGVtYU5hbWUpLCBEQklkZW50aWZpZXIubmV3U2VxdWVu\nY2Uoc2VxdWVuY2VOYW1lKSk7CiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBw\ncm90ZWN0ZWQgU3RyaW5nIGdldFNlcXVlbmNlc1NRTChEQklkZW50aWZpZXIg\nc2NoZW1hTmFtZSwgREJJZGVudGlmaWVyIHNlcXVlbmNlTmFtZSkgewogICAg\nICAgIFN0cmluZ0J1aWxkZXIgYnVmID0gbmV3IFN0cmluZ0J1aWxkZXIoc2Vx\ndWVuY2VTUUwpOwogICAgICAgIGlmIChzZXF1ZW5jZU5hbWUgIT0gbnVsbCkK\nICAgICAgICAgICAgYnVmLmFwcGVuZChzZXF1ZW5jZU5hbWVTUUwpOwogICAg\nICAgIHJldHVybiBidWYudG9TdHJpbmcoKTsKICAgIH0KCiAgICAvKioKICAg\nICAqIENhbGwgc3VwZXIgaW1wbGVtZW50YXRpb24gYW5kIHRyaW0gc2VxdWVu\nY2UgbmFtZS4gVGhpcyBpcyBiZWNhdXNlIG9mCiAgICAgKiB0cmFpbGluZyBz\ncGFjZXMgcHJvYmxlbTogPGNvZGU+UkRCJEdFTkVSQVRPUlMuUkRCJEdFTkVS\nQVRPUl9OQU1FPC9jb2RlPgogICAgICogaXMgPGNvZGU+Q0hBUigzMSk8L2Nv\nZGU+IGFuZCB1c2luZyA8Y29kZT5SVFJJTTwvY29kZT4gVURGIGZ1bmN0aW9u\nIG9uCiAgICAgKiBGaXJlYmlyZCAxLjUgc3VycHJpc2luZ2x5IHJldHVybnMg\nYSBzdHJpbmcgcmlnaHQtcGFkZGVkIHdpdGggc3BhY2VzIHVwCiAgICAgKiB0\nbyB0aGUgbGVuZ3RoIG9mIDI1NS4KICAgICAqLwogICAgQE92ZXJyaWRlCiAg\nICBwcm90ZWN0ZWQgU2VxdWVuY2UgbmV3U2VxdWVuY2UoUmVzdWx0U2V0IHNl\ncXVlbmNlTWV0YSkgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgU2Vx\ndWVuY2Ugc2VxID0gc3VwZXIubmV3U2VxdWVuY2Uoc2VxdWVuY2VNZXRhKTsK\nICAgICAgICBzZXEuc2V0SWRlbnRpZmllcihEQklkZW50aWZpZXIudHJpbShz\nZXEuZ2V0SWRlbnRpZmllcigpKSk7CiAgICAgICAgcmV0dXJuIHNlcTsKICAg\nIH0KCiAgICAvKioKICAgICAqIE9uIEZpcmViaXJkIDEuNSByZXR1cm4KICAg\nICAqIDxjb2RlPkRST1AgR0VORVJBVE9SICZsdDtzZXF1ZW5jZSBuYW1lJmd0\nOzwvY29kZT4uCiAgICAgKiBPbiBGaXJlYmlyZCAyLjAgYW5kIGxhdGVyIGRl\nbGVnYXRlIHRvIHRoZSBzdXBlciBpbXBsZW1lbnRhdGlvbi4KICAgICAqLwog\nICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgU3RyaW5nW10gZ2V0RHJvcFNlcXVl\nbmNlU1FMKFNlcXVlbmNlIHNlcSkgewogICAgICAgIGlmIChmaXJlYmlyZFZl\ncnNpb24gPT0gRkJfVkVSU0lPTl8xNSkKICAgICAgICAgICAgcmV0dXJuIG5l\ndyBTdHJpbmdbXSB7IGRyb3BTZXF1ZW5jZVNRTEZCMTUgKyBnZXRGdWxsTmFt\nZShzZXEpIH07CiAgICAgICAgcmV0dXJuIHN1cGVyLmdldERyb3BTZXF1ZW5j\nZVNRTChzZXEpOwogICAgfQoKICAgIC8qKgogICAgICogVGhyb3cge0BsaW5r\nIFVuc3VwcG9ydGVkRXhjZXB0aW9ufS4gRmlyZWJpcmQgaW4gdmVyc2lvbiBl\nYXJsaWVyIHRoYW4gMi4xCiAgICAgKiBoYXMgbm8gc3VpdGFibGUgZnVuY3Rp\nb24uIEZpcmViaXJkIDIuMSBoYXMgdGhlIDxjb2RlPlBPU0lUSU9OPC9jb2Rl\nPgogICAgICogZnVuY3Rpb24gYnV0IHVzaW5nIGl0IGhlcmUgcmVzdWx0cyBp\nbiBlcnJvcnMgbGlrZSAiZGF0YSB0eXBlIHVua25vd24iIG9yCiAgICAgKiAi\nZXhwcmVzc2lvbiBldmFsdWF0aW9uIG5vdCBzdXBwb3J0ZWQiLgogICAgICov\nCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyB2b2lkIGluZGV4T2YoU1FMQnVm\nZmVyIGJ1ZiwgRmlsdGVyVmFsdWUgc3RyLCBGaWx0ZXJWYWx1ZSBmaW5kLAog\nICAgICAgIEZpbHRlclZhbHVlIHN0YXJ0KSB7CiAgICAgICAgdGhyb3cgbmV3\nIFVuc3VwcG9ydGVkRXhjZXB0aW9uKF9sb2MuZ2V0KCJmdW5jdGlvbi1ub3Qt\nc3VwcG9ydGVkIiwKICAgICAgICAgICAgZ2V0Q2xhc3MoKSwgIkxPQ0FURSIp\nKTsKICAgIH0KCiAgICAvKioKICAgICAqIFVzZQogICAgICogPGNvZGU+U1VC\nU1RSSU5HKCZsdDtjb2wgbmFtZSZndDsgRlJPTSAmbHQ7bSZndDsgRk9SICZs\ndDtuJmd0Oyk8L2NvZGU+LgogICAgICogUGFyYW1ldGVycyBhcmUgaW5saW5l\nZCBiZWNhdXNlIG5laXRoZXIgcGFyYW1ldGVyIGJpbmRpbmcgbm9yIGV4cHJl\nc3Npb25zCiAgICAgKiBhcmUgYWNjZXB0ZWQgYnkgRmlyZWJpcmQgaGVyZS4g\nQXMgYSByZXN1bHQsIGFuCiAgICAgKiB7QGxpbmsgVW5zdXBwb3J0ZWRFeGNl\ncHRpb259IGlzIHRocm93biB3aGVuIHNvbWV0aGluZyBlbHNlIHRoYW4gYQog\nICAgICogY29uc3RhbnQgaXMgdXNlZCBpbiA8Y29kZT5zdGFydDwvY29kZT4g\nb3IgPGNvZGU+ZW5kPC9jb2RlPi4KICAgICAqLwogICAgQE92ZXJyaWRlCiAg\nICBwdWJsaWMgdm9pZCBzdWJzdHJpbmcoU1FMQnVmZmVyIGJ1ZiwgRmlsdGVy\nVmFsdWUgc3RyLCBGaWx0ZXJWYWx1ZSBzdGFydCwKICAgICAgICBGaWx0ZXJW\nYWx1ZSBlbmQpIHsKICAgICAgICBidWYuYXBwZW5kKHN1YnN0cmluZ0Z1bmN0\naW9uTmFtZSkuYXBwZW5kKCIoIik7CiAgICAgICAgc3RyLmFwcGVuZFRvKGJ1\nZik7CiAgICAgICAgYnVmLmFwcGVuZCgiIEZST00gIik7CiAgICAgICAgaWYg\nKHN0YXJ0LmdldFZhbHVlKCkgaW5zdGFuY2VvZiBOdW1iZXIpIHsKICAgICAg\nICAgICAgbG9uZyBzdGFydExvbmcgPSB0b0xvbmcoc3RhcnQpOwogICAgICAg\nICAgICBidWYuYXBwZW5kKExvbmcudG9TdHJpbmcoc3RhcnRMb25nICsgMSkp\nOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHRocm93IG5ldyBVbnN1\ncHBvcnRlZEV4Y2VwdGlvbihfbG9jLmdldCgiZnVuY3Rpb24tbm90LXN1cHBv\ncnRlZCIsCiAgICAgICAgICAgICAgICBnZXRDbGFzcygpLCBzdWJzdHJpbmdG\ndW5jdGlvbk5hbWUgKyAiIHdpdGggbm9uLWNvbnN0YW50cyIpKTsKICAgICAg\nICB9CiAgICAgICAgaWYgKGVuZCAhPSBudWxsKSB7CiAgICAgICAgICAgIGJ1\nZi5hcHBlbmQoIiBGT1IgIik7CiAgICAgICAgICAgIGlmIChzdGFydC5nZXRW\nYWx1ZSgpIGluc3RhbmNlb2YgTnVtYmVyCiAgICAgICAgICAgICAgICAmJiBl\nbmQuZ2V0VmFsdWUoKSBpbnN0YW5jZW9mIE51bWJlcikgewogICAgICAgICAg\nICAgICAgbG9uZyBzdGFydExvbmcgPSB0b0xvbmcoc3RhcnQpOwogICAgICAg\nICAgICAgICAgbG9uZyBlbmRMb25nID0gdG9Mb25nKGVuZCk7CiAgICAgICAg\nICAgICAgICBidWYuYXBwZW5kKExvbmcudG9TdHJpbmcoZW5kTG9uZyAtIHN0\nYXJ0TG9uZykpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAg\nICAgdGhyb3cgbmV3IFVuc3VwcG9ydGVkRXhjZXB0aW9uKF9sb2MuZ2V0KAog\nICAgICAgICAgICAgICAgICAgICJmdW5jdGlvbi1ub3Qtc3VwcG9ydGVkIiwg\nZ2V0Q2xhc3MoKSwgc3Vic3RyaW5nRnVuY3Rpb25OYW1lCiAgICAgICAgICAg\nICAgICAgICAgICAgICsgIiB3aXRoIG5vbi1jb25zdGFudHMiKSk7CiAgICAg\nICAgICAgIH0KICAgICAgICB9CiAgICAgICAgYnVmLmFwcGVuZCgiKSIpOwog\nICAgfQoKICAgIC8qKgogICAgICogT24gRmlyZWJpcmQgMS41IHJlZHVjZSB0\naGUgc2l6ZSBvZiBpbmRleGVkIDxjb2RlPlZBUkNIQVI8L2NvZGU+IGNvbHVt\nbgogICAgICogdG8gMjUyIG9yIGEgdmFsdWUgc3BlY2lmaWVkIGJ5IHVzZXIu\nIDI1MiBpcyB0aGUgbWF4aW11bSBGaXJlYmlyZCAxLjUgY2FuCiAgICAgKiBo\nYW5kbGUgZm9yIG9uZS1jb2x1bW4gaW5kZXhlcy4gT24gRmlyZWJpcmQgMi4w\nIGFuZCBsYXRlciBkZWxlZ2F0ZSB0byB0aGUKICAgICAqIHN1cGVyIGltcGxl\nbWVudGF0aW9uLgogICAgICovCiAgICBAT3ZlcnJpZGUKICAgIHByb3RlY3Rl\nZCBTdHJpbmcgYXBwZW5kU2l6ZShDb2x1bW4gY29sLCBTdHJpbmcgdHlwZU5h\nbWUpIHsKICAgICAgICBpZiAoZmlyZWJpcmRWZXJzaW9uICE9IEZCX1ZFUlNJ\nT05fMTUpCiAgICAgICAgICAgIHJldHVybiBzdXBlci5hcHBlbmRTaXplKGNv\nbCwgdHlwZU5hbWUpOwoKICAgICAgICBpZiAoY29sLmdldFR5cGUoKSA9PSBU\neXBlcy5WQVJDSEFSCiAgICAgICAgICAgICYmIGNvbC5nZXRTaXplKCkgPiBp\nbmRleGVkVmFyY2hhck1heFNpemVGQjE1CiAgICAgICAgICAgICYmIGNvbC5n\nZXRUYWJsZSgpICE9IG51bGwpIHsKCiAgICAgICAgICAgIGlmIChjb2wuaXNQ\ncmltYXJ5S2V5KCkpIHsKICAgICAgICAgICAgICAgIGNvbC5zZXRTaXplKGlu\nZGV4ZWRWYXJjaGFyTWF4U2l6ZUZCMTUpOwogICAgICAgICAgICAgICAgcmV0\ndXJuIHN1cGVyLmFwcGVuZFNpemUoY29sLCB0eXBlTmFtZSk7CiAgICAgICAg\nICAgIH0KICAgICAgICAgICAgSW5kZXhbXSBpbmRleGVzID0gY29sLmdldFRh\nYmxlKCkuZ2V0SW5kZXhlcygpOwogICAgICAgICAgICBmb3IgKEluZGV4IGlu\nZGV4IDogaW5kZXhlcykgewogICAgICAgICAgICAgICAgaWYgKGluZGV4LmNv\nbnRhaW5zQ29sdW1uKGNvbCkpIHsKICAgICAgICAgICAgICAgICAgICBjb2wu\nc2V0U2l6ZShpbmRleGVkVmFyY2hhck1heFNpemVGQjE1KTsKICAgICAgICAg\nICAgICAgICAgICByZXR1cm4gc3VwZXIuYXBwZW5kU2l6ZShjb2wsIHR5cGVO\nYW1lKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAg\nICAgICBVbmlxdWVbXSB1bmlxdWVzID0gY29sLmdldFRhYmxlKCkuZ2V0VW5p\ncXVlcygpOwogICAgICAgICAgICBmb3IgKFVuaXF1ZSB1bmlxdWUgOiB1bmlx\ndWVzKSB7CiAgICAgICAgICAgICAgICBpZiAodW5pcXVlLmNvbnRhaW5zQ29s\ndW1uKGNvbCkpIHsKICAgICAgICAgICAgICAgICAgICBjb2wuc2V0U2l6ZShp\nbmRleGVkVmFyY2hhck1heFNpemVGQjE1KTsKICAgICAgICAgICAgICAgICAg\nICByZXR1cm4gc3VwZXIuYXBwZW5kU2l6ZShjb2wsIHR5cGVOYW1lKTsKICAg\nICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBGb3Jl\naWduS2V5W10gZm9yZWlnbktleXMgPSBjb2wuZ2V0VGFibGUoKS5nZXRGb3Jl\naWduS2V5cygpOwogICAgICAgICAgICBmb3IgKEZvcmVpZ25LZXkgZm9yZWln\nbktleSA6IGZvcmVpZ25LZXlzKSB7CiAgICAgICAgICAgICAgICBpZiAoZm9y\nZWlnbktleS5jb250YWluc0NvbHVtbihjb2wpKSB7CiAgICAgICAgICAgICAg\nICAgICAgY29sLnNldFNpemUoaW5kZXhlZFZhcmNoYXJNYXhTaXplRkIxNSk7\nCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmFwcGVuZFNpemUo\nY29sLCB0eXBlTmFtZSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAg\nIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIHN1cGVyLmFwcGVuZFNpemUo\nY29sLCB0eXBlTmFtZSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBVc2UgZXJy\nb3IgY29kZSBhcyBTUUwgc3RhdGUgcmV0dXJuZWQgYnkgRmlyZWJpcmQgaXMg\nYW1iaWd1b3VzLgogICAgICovCiAgICBAT3ZlcnJpZGUKICAgIHByb3RlY3Rl\nZCBCb29sZWFuIG1hdGNoRXJyb3JTdGF0ZShpbnQgc3VidHlwZSwgU2V0PFN0\ncmluZz4gZXJyb3JTdGF0ZXMsCiAgICAgICAgU1FMRXhjZXB0aW9uIGV4KSB7\nCiAgICAgICAgaW50IGVycm9yQ29kZSA9IGV4LmdldEVycm9yQ29kZSgpOwog\nICAgICAgIHJldHVybiBlcnJvclN0YXRlcy5jb250YWlucyhTdHJpbmcudmFs\ndWVPZihlcnJvckNvZGUpKSA/IEJvb2xlYW4uRkFMU0UKICAgICAgICAgICAg\nOiBudWxsOwogICAgfQp9Cg==\n","encoding":"base64"}

