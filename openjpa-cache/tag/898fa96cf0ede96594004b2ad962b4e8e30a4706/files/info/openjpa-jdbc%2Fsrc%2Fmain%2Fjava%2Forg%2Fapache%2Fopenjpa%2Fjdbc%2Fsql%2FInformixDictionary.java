{"sha":"9722fe408142c6e87adbef98b88ac17a2895a010","node_id":"MDQ6QmxvYjIwNjM2NDo5NzIyZmU0MDgxNDJjNmU4N2FkYmVmOThiODhhYzE3YTI4OTVhMDEw","size":13302,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/9722fe408142c6e87adbef98b88ac17a2895a010","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zcWw7CgppbXBvcnQg\namF2YS5zcWwuQ29ubmVjdGlvbjsKaW1wb3J0IGphdmEuc3FsLkRhdGFiYXNl\nTWV0YURhdGE7CmltcG9ydCBqYXZhLnNxbC5QcmVwYXJlZFN0YXRlbWVudDsK\naW1wb3J0IGphdmEuc3FsLlJlc3VsdFNldDsKaW1wb3J0IGphdmEuc3FsLlNR\nTEV4Y2VwdGlvbjsKaW1wb3J0IGphdmEuc3FsLlN0YXRlbWVudDsKaW1wb3J0\nIGphdmEuc3FsLlR5cGVzOwppbXBvcnQgamF2YS51dGlsLkFycmF5czsKaW1w\nb3J0IGphdmEudXRpbC5Db2xsZWN0aW9uOwppbXBvcnQgamF2YS51dGlsLlNl\ndDsKCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5pZGVudGlmaWVy\nLkRCSWRlbnRpZmllci5EQklkZW50aWZpZXJUeXBlOwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLmpkYmMua2VybmVsLmV4cHMuRmlsdGVyVmFsdWU7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hlbWEuQ29sdW1uOwpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1hLkZvcmVpZ25L\nZXk7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hlbWEuSW5k\nZXg7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hlbWEuUHJp\nbWFyeUtleTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNjaGVt\nYS5UYWJsZTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIudXRpbC5M\nb2NhbGl6ZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwu\nUmVmZXJlbmNlSGFzaFNldDsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51\ndGlsLlN0b3JlRXhjZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLnV0aWwuVW5zdXBwb3J0ZWRFeGNlcHRpb247CgovKioKICogRGljdGlvbmFy\neSBmb3IgSW5mb3JtaXggZGF0YWJhc2UuIE5vdGFibGUgZmVhdHVyZXM6CiAq\nIDx1bD4KICogPGxpPkluZm9ybWl4IGRvZXMgbm90IGFsbG93IHBlc3NpbWlz\ndGljIGxvY2tpbmcgb24gc2Nyb2xsYWJsZSByZXN1bHQKICogc2V0cy48L2xp\nPgogKiA8bGk+U0VUIExPQ0sgTU9ERSBUTyBXQUlUIE4gc3RhdGVtZW50cyBh\ncmUgaXNzdWVkIHRvIHdhaXQgb24gbG9ja3MuIFNlZQogKiB7QGxpbmsgI2xv\nY2tXYWl0U2Vjb25kc30gYW5kIHtAbGluayAjbG9ja01vZGVFbmFibGVkfS48\nL2xpPgogKiA8bGk+TE9DSyBNT0RFIFJPVyBpcyB1c2VkIGJ5IGRlZmF1bHQg\nZm9yIHRhYmxlIGNyZWF0aW9uIHRvIGFsbG93IHRoZQogKiBtYXhpbXVtIGNv\nbmN1cnJlbmN5LjwvbGk+CiAqIDwvdWw+CiAqLwpwdWJsaWMgY2xhc3MgSW5m\nb3JtaXhEaWN0aW9uYXJ5CiAgICBleHRlbmRzIERCRGljdGlvbmFyeSB7Cgog\nICAgcHVibGljIHN0YXRpYyBmaW5hbCBTdHJpbmcgVkVORE9SX0lCTSA9ICJp\nYm0iOwoKICAgIC8qKgogICAgICogSWYgdHJ1ZSwgdGhlbiB3ZSB3aWxsIGlz\nc3VlIGEgIlNFVCBMT0NLIE1PREUgVE8gV0FJVCBOIgogICAgICogc3RhdGVt\nZW50IHdoZW5ldmVyIHdlIGNyZWF0ZSBhIHtAbGluayBDb25uZWN0aW9ufSwg\naW4gb3JkZXIKICAgICAqIGFsbG93IHdhaXRpbmcgb24gbG9ja3MuCiAgICAg\nKi8KICAgIHB1YmxpYyBib29sZWFuIGxvY2tNb2RlRW5hYmxlZCA9IGZhbHNl\nOwoKICAgIC8qKgogICAgICogSWYge0BsaW5rICNsb2NrTW9kZUVuYWJsZWR9\nIGlzIDxjb2RlPnRydWU8L2NvZGU+LCB0aGVuIHRoaXMKICAgICAqIHBhcmFt\nZXRlciBzcGVjaWZpZXMgdGhlIG51bWJlciBvZiBzZWNvbmRzIHdlIHdpbGwg\nd2FpdCB0bwogICAgICogb2J0YWluIGEgbG9jayBmb3IgaW5zZXJ0cyBhbmQg\ncGVzc2ltaXN0aWMgbG9ja2luZy4KICAgICAqLwogICAgcHVibGljIGludCBs\nb2NrV2FpdFNlY29uZHMgPSAzMDsKCiAgICAvKioKICAgICAqIEluZm9ybWl4\nIEpEQkMgbWV0YWRhdGEgZm9yIGFsbCBrbm93biBkcml2ZXJzIHJldHVybnMg\nd2l0aCB0aGUKICAgICAqIHRhYmxlIGNhdGFsb2cgYW5kIHRoZSB0YWJsZSBz\nY2hlbWEgbmFtZSBzd2FwcGVkLiBBIDxjb2RlPnRydWU8L2NvZGU+CiAgICAg\nKiB2YWx1ZSBmb3IgdGhpcyBwcm9wZXJ0eSBpbmRpY2F0ZXMgdGhhdCB0aGV5\nIHNob3VsZCBiZSByZXZlcnNlZC4KICAgICAqLwogICAgcHVibGljIGJvb2xl\nYW4gc3dhcFNjaGVtYUFuZENhdGFsb2cgPSB0cnVlOwoKICAgIHByb3RlY3Rl\nZCBib29sZWFuIHVzZUpDQyA9IGZhbHNlOwogICAgLy8gd2VhayBzZXQgb2Yg\nY29ubmVjdGlvbnMgd2UndmUgYWxyZWFkeSBleGVjdXRlZCBsb2NrIG1vZGUg\nc3FsIG9uCiAgICBwcml2YXRlIGZpbmFsIENvbGxlY3Rpb24gX3NlZW5Db25u\nZWN0aW9ucyA9IG5ldyBSZWZlcmVuY2VIYXNoU2V0CiAgICAgICAgKFJlZmVy\nZW5jZUhhc2hTZXQuV0VBSyk7CgogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwg\nTG9jYWxpemVyIF9sb2MgPSBMb2NhbGl6ZXIuZm9yUGFja2FnZQogICAgICAg\nIChJbmZvcm1peERpY3Rpb25hcnkuY2xhc3MpOwoKICAgIHB1YmxpYyBJbmZv\ncm1peERpY3Rpb25hcnkoKSB7CiAgICAgICAgcGxhdGZvcm0gPSAiSW5mb3Jt\naXgiOwogICAgICAgIHZhbGlkYXRpb25TUUwgPSAiU0VMRUNUIEZJUlNUIDEg\nQ1VSUkVOVCBUSU1FU1RBTVAgIgogICAgICAgICAgICArICJGUk9NIGluZm9y\nbWl4LnN5c3RhYmxlcyI7CgogICAgICAgIHN1cHBvcnRzQXV0b0Fzc2lnbiA9\nIHRydWU7CiAgICAgICAgYXV0b0Fzc2lnblR5cGVOYW1lID0gInNlcmlhbCI7\nCiAgICAgICAgbGFzdEdlbmVyYXRlZEtleVF1ZXJ5ID0gIlNFTEVDVCBGSVJT\nVCAxIERCSU5GTygnc3FsY2Euc3FsZXJyZDEnKSAiCiAgICAgICAgICAgICsg\nIkZST00gaW5mb3JtaXguc3lzdGFibGVzIjsKCiAgICAgICAgLy8gaW5mb3Jt\naXggYWN0dWFsbHkgZG9lcyBzdXBwb3J0IGRlZmVycmVkIGNvbnN0cmFpbnRz\nLCBidXQgbm90CiAgICAgICAgLy8gaW4gdGhlIHRhYmxlIGRlZmluaXRpb247\nIGRlZmVycmVkIGNvbnN0cmFpbnRzIGNhbiBiZSBhY3RpdmF0ZWQgYnkKICAg\nICAgICAvLyBpbnZva2luZyAic2V0IGNvbnN0cmFpbnRzIGFsbCBkZWZlcnJl\nZCIgb24gdGhlIGNvbm5lY3Rpb24sIHdoaWNoCiAgICAgICAgLy8gd2UgZG9u\nJ3QgZG8geWV0CiAgICAgICAgc3VwcG9ydHNEZWZlcnJlZENvbnN0cmFpbnRz\nID0gZmFsc2U7CiAgICAgICAgY29uc3RyYWludE5hbWVNb2RlID0gQ09OU19O\nQU1FX0FGVEVSOwoKICAgICAgICAvLyBpbmZvcm1peCBzdXBwb3J0cyAiQ0xP\nQiIgdHlwZSwgYnV0IGFueSBhdHRlbXB0IHRvIGluc2VydAogICAgICAgIC8v\nIGludG8gdGhlbSByYWlzZXM6ICJqYXZhLnNxbC5TUUxFeGNlcHRpb246IENh\nbid0IGNvbnZlcnQgZnJvbW51bGwiCiAgICAgICAgdXNlR2V0U3RyaW5nRm9y\nQ2xvYnMgPSB0cnVlOwogICAgICAgIGxvbmdWYXJjaGFyVHlwZU5hbWUgPSAi\nVEVYVCI7CiAgICAgICAgY2xvYlR5cGVOYW1lID0gIlRFWFQiOwogICAgICAg\nIHNtYWxsaW50VHlwZU5hbWUgPSAiSU5UOCI7CiAgICAgICAgdGlueWludFR5\ncGVOYW1lID0gIklOVDgiOwogICAgICAgIGZsb2F0VHlwZU5hbWUgPSAiRkxP\nQVQiOwogICAgICAgIGJpdFR5cGVOYW1lID0gIkJPT0xFQU4iOwogICAgICAg\nIGJsb2JUeXBlTmFtZSA9ICJCWVRFIjsKICAgICAgICBkb3VibGVUeXBlTmFt\nZSA9ICJOVU1FUklDKDMyLDIwKSI7CiAgICAgICAgZGF0ZVR5cGVOYW1lID0g\nIkRBVEUiOwogICAgICAgIHRpbWVUeXBlTmFtZSA9ICJEQVRFVElNRSBIT1VS\nIFRPIFNFQ09ORCI7CiAgICAgICAgdGltZXN0YW1wVHlwZU5hbWUgPSAiREFU\nRVRJTUUgWUVBUiBUTyBGUkFDVElPTigzKSI7CiAgICAgICAgZG91YmxlVHlw\nZU5hbWUgPSAiTlVNRVJJQygzMiwyMCkiOwogICAgICAgIGZsb2F0VHlwZU5h\nbWUgPSAiUkVBTCI7CiAgICAgICAgYmlnaW50VHlwZU5hbWUgPSAiTlVNRVJJ\nQygzMiwwKSI7CiAgICAgICAgZG91YmxlVHlwZU5hbWUgPSAiRE9VQkxFIFBS\nRUNJU0lPTiI7CiAgICAgICAgZml4ZWRTaXplVHlwZU5hbWVTZXQuYWRkQWxs\nKEFycmF5cy5hc0xpc3QobmV3IFN0cmluZ1tdewogICAgICAgICAgICAiQllU\nRSIsICJET1VCTEUgUFJFQ0lTSU9OIiwgIklOVEVSVkFMIiwgIlNNQUxMRkxP\nQVQiLCAiVEVYVCIsCiAgICAgICAgICAgICJJTlQ4IiwKICAgICAgICB9KSk7\nCgogICAgICAgIHN1cHBvcnRzTG9ja2luZ1dpdGhEaXN0aW5jdENsYXVzZSA9\nIGZhbHNlOwogICAgICAgIHN1cHBvcnRzTG9ja2luZ1dpdGhNdWx0aXBsZVRh\nYmxlcyA9IGZhbHNlOwogICAgICAgIHN1cHBvcnRzTG9ja2luZ1dpdGhPcmRl\nckNsYXVzZSA9IGZhbHNlOwoKICAgICAgICAvLyB0aGUgaW5mb3JtaXggSkRC\nQyBkcml2ZXJzIGhhdmUgcHJvYmxlbXMgd2l0aCB1c2luZyB0aGUKICAgICAg\nICAvLyBzY2hlbWEgbmFtZSBpbiByZWZsZWN0aW9uIG9uIGNvbHVtbnMgYW5k\nIHRhYmxlcwogICAgICAgIHN1cHBvcnRzU2NoZW1hRm9yR2V0Q29sdW1ucyA9\nIGZhbHNlOwogICAgICAgIHN1cHBvcnRzU2NoZW1hRm9yR2V0VGFibGVzID0g\nZmFsc2U7CgogICAgICAgIC8vIEluZm9ybWl4IGRvZXNuJ3Qgc3VwcG9ydCBh\nbGlhc2VzIGluIGRlbGV0ZXMgaWYgdGhlIHRhYmxlIGhhcyBhbiBpbmRleAog\nICAgICAgIGFsbG93c0FsaWFzSW5CdWxrQ2xhdXNlID0gZmFsc2U7CiAgICAg\nICAgCiAgICAgICAgLy8gSW5mb3JtaXggZG9lc24ndCB1bmRlcnN0YW5kICJY\nIENST1NTIEpPSU4gWSIsIGJ1dCBpdCBkb2VzIHVuZGVyc3RhbmQKICAgICAg\nICAvLyB0aGUgZXF1aXZhbGVudCAiWCBKT0lOIFkgT04gMSA9IDEiCiAgICAg\nICAgY3Jvc3NKb2luQ2xhdXNlID0gIkpPSU4iOwogICAgICAgIHJlcXVpcmVz\nQ29uZGl0aW9uRm9yQ3Jvc3NKb2luID0gdHJ1ZTsKCiAgICAgICAgY29uY2F0\nZW5hdGVGdW5jdGlvbiA9ICJDT05DQVQoezB9LHsxfSkiOwogICAgICAgIG5l\neHRTZXF1ZW5jZVF1ZXJ5ID0gIlNFTEVDVCB7MH0uTkVYVFZBTCBGUk9NIFNZ\nU1RBQkxFUyBXSEVSRSBUQUJJRD0xIjsKICAgICAgICBzdXBwb3J0c0NvcnJl\nbGF0ZWRTdWJzZWxlY3QgPSBmYWxzZTsKICAgICAgICBzd2FwU2NoZW1hQW5k\nQ2F0YWxvZyA9IGZhbHNlOwogICAgICAgIAogICAgICAgIC8vIEluZm9ybWl4\nIGRvZXMgbm90IHN1cHBvcnQgZm9yZWlnbiBrZXkgZGVsZXRlIGFjdGlvbiBO\nVUxMIG9yIERFRkFVTFQKICAgICAgICBzdXBwb3J0c051bGxEZWxldGVBY3Rp\nb24gPSBmYWxzZTsKICAgICAgICBzdXBwb3J0c0RlZmF1bHREZWxldGVBY3Rp\nb24gPSBmYWxzZTsKICAgICAgICAKICAgICAgICB0cmltU2NoZW1hTmFtZSA9\nIHRydWU7CiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgdm9pZCBj\nb25uZWN0ZWRDb25maWd1cmF0aW9uKENvbm5lY3Rpb24gY29ubikKICAgICAg\nICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBzdXBlci5jb25uZWN0\nZWRDb25maWd1cmF0aW9uKGNvbm4pOwoKICAgICAgICBEYXRhYmFzZU1ldGFE\nYXRhIG1ldGEgPSBjb25uLmdldE1ldGFEYXRhKCk7CiAgICAgICAgU3RyaW5n\nIGRyaXZlck5hbWUgPSBtZXRhLmdldERyaXZlck5hbWUoKTsKICAgICAgICBp\nZiAoZHJpdmVyTmFtZSAhPSBudWxsKSB7CiAgICAgICAgICAgIGlmIChkcml2\nZXJOYW1lLmVxdWFscygiSUJNIERCMiBKREJDIFVuaXZlcnNhbCBEcml2ZXIg\nQXJjaGl0ZWN0dXJlIikpCiAgICAgICAgICAgIHsgCiAgICAgICAgICAgICAg\nICBkcml2ZXJWZW5kb3IgPSBWRU5ET1JfSUJNOwogICAgICAgICAgICAgICAg\ndXNlSkNDID0gdHJ1ZTsKICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAg\nICAgICAgICAgICAgaWYgKG1ldGEuc3RvcmVzTG93ZXJDYXNlSWRlbnRpZmll\ncnMoKSkgCiAgICAgICAgICAgICAgICAgICAgICAgIHNjaGVtYUNhc2UgPSBT\nQ0hFTUFfQ0FTRV9MT1dFUjsKICAgICAgICAgICAgICAgIH0gY2F0Y2ggKFNR\nTEV4Y2VwdGlvbiBlKSB7fQogICAgICAgICAgICB9IGVsc2UgaWYgKCJJbmZv\ncm1peCIuZXF1YWxzSWdub3JlQ2FzZShkcml2ZXJOYW1lKSkKICAgICAgICAg\nICAgICAgIGRyaXZlclZlbmRvciA9IFZFTkRPUl9EQVRBRElSRUNUOwogICAg\nICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICBkcml2ZXJWZW5kb3IgPSBW\nRU5ET1JfT1RIRVI7CiAgICAgICAgfSBlbHNlCiAgICAgICAgICAgIGRyaXZl\nclZlbmRvciA9IFZFTkRPUl9PVEhFUjsKCiAgICAgICAgaWYgKGlzSkRCQzMp\nIHsKICAgICAgICAgICAgY29ubi5zZXRIb2xkYWJpbGl0eShSZXN1bHRTZXQu\nSE9MRF9DVVJTT1JTX09WRVJfQ09NTUlUKTsKICAgICAgICAgICAgaWYgKGxv\nZy5pc1RyYWNlRW5hYmxlZCgpKQogICAgICAgICAgICAgICAgbG9nLnRyYWNl\nKF9sb2MuZ2V0KCJjb25uZWN0aW9uLWRlZmF1bHRzIiwgbmV3IE9iamVjdFtd\newogICAgICAgICAgICAgICAgICAgIGNvbm4uZ2V0QXV0b0NvbW1pdCgpLCBj\nb25uLmdldEhvbGRhYmlsaXR5KCksCiAgICAgICAgICAgICAgICAgICAgY29u\nbi5nZXRUcmFuc2FjdGlvbklzb2xhdGlvbigpfSkpOwogICAgICAgIH0KICAg\nIH0KCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyBDb2x1bW5bXSBnZXRDb2x1\nbW5zKERhdGFiYXNlTWV0YURhdGEgbWV0YSwgU3RyaW5nIGNhdGFsb2csCiAg\nICAgICAgU3RyaW5nIHNjaGVtYU5hbWUsIFN0cmluZyB0YWJsZU5hbWUsIFN0\ncmluZyBjb2x1bW5OYW1lLCBDb25uZWN0aW9uIGNvbm4pCiAgICAgICAgdGhy\nb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgQ29sdW1uW10gY29scyA9IHN1\ncGVyLmdldENvbHVtbnMobWV0YSwgY2F0YWxvZywgc2NoZW1hTmFtZSwgdGFi\nbGVOYW1lLAogICAgICAgICAgICBjb2x1bW5OYW1lLCBjb25uKTsKCiAgICAg\nICAgLy8gdHJlYXQgbG9ndmFyY2hhciBhcyBjbG9iCiAgICAgICAgZm9yIChp\nbnQgaSA9IDA7IGNvbHMgIT0gbnVsbCAmJiBpIDwgY29scy5sZW5ndGg7IGkr\nKykKICAgICAgICAgICAgaWYgKGNvbHNbaV0uZ2V0VHlwZSgpID09IFR5cGVz\nLkxPTkdWQVJDSEFSKQogICAgICAgICAgICAgICAgY29sc1tpXS5zZXRUeXBl\nKFR5cGVzLkNMT0IpOwogICAgICAgIHJldHVybiBjb2xzOwogICAgfQoKICAg\nIEBPdmVycmlkZQogICAgcHVibGljIENvbHVtbiBuZXdDb2x1bW4oUmVzdWx0\nU2V0IGNvbE1ldGEpCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAg\nICAgICAgQ29sdW1uIGNvbCA9IHN1cGVyLm5ld0NvbHVtbihjb2xNZXRhKTsK\nICAgICAgICBpZiAoc3dhcFNjaGVtYUFuZENhdGFsb2cpCiAgICAgICAgICAg\nIGNvbC5zZXRTY2hlbWFJZGVudGlmaWVyKGZyb21EQk5hbWUoY29sTWV0YS5n\nZXRTdHJpbmcoIlRBQkxFX0NBVCIpLCBEQklkZW50aWZpZXJUeXBlLkNBVEFM\nT0cpKTsKICAgICAgICByZXR1cm4gY29sOwogICAgfQoKICAgIEBPdmVycmlk\nZQogICAgcHVibGljIFByaW1hcnlLZXkgbmV3UHJpbWFyeUtleShSZXN1bHRT\nZXQgcGtNZXRhKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAg\nICAgIFByaW1hcnlLZXkgcGsgPSBzdXBlci5uZXdQcmltYXJ5S2V5KHBrTWV0\nYSk7CiAgICAgICAgaWYgKHN3YXBTY2hlbWFBbmRDYXRhbG9nKQogICAgICAg\nICAgICBway5zZXRTY2hlbWFJZGVudGlmaWVyKGZyb21EQk5hbWUocGtNZXRh\nLmdldFN0cmluZygiVEFCTEVfQ0FUIiksIERCSWRlbnRpZmllclR5cGUuQ0FU\nQUxPRykpOwogICAgICAgIHJldHVybiBwazsKICAgIH0KCiAgICBAT3ZlcnJp\nZGUKICAgIHB1YmxpYyBJbmRleCBuZXdJbmRleChSZXN1bHRTZXQgaWR4TWV0\nYSkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBJbmRl\neCBpZHggPSBzdXBlci5uZXdJbmRleChpZHhNZXRhKTsKICAgICAgICBpZiAo\nc3dhcFNjaGVtYUFuZENhdGFsb2cpCiAgICAgICAgICAgIGlkeC5zZXRTY2hl\nbWFJZGVudGlmaWVyKGZyb21EQk5hbWUoaWR4TWV0YS5nZXRTdHJpbmcoIlRB\nQkxFX0NBVCIpLCBEQklkZW50aWZpZXJUeXBlLkNBVEFMT0cpKTsKICAgICAg\nICByZXR1cm4gaWR4OwogICAgfQoKICAgIEBPdmVycmlkZQogICAgcHVibGlj\nIHZvaWQgc2V0Qm9vbGVhbihQcmVwYXJlZFN0YXRlbWVudCBzdG1udCwgaW50\nIGlkeCwgYm9vbGVhbiB2YWwsCiAgICAgICAgQ29sdW1uIGNvbCkKICAgICAg\nICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAvLyBpbmZvcm1peCBh\nY3R1YWxseSByZXF1aXJlcyB0aGF0IGEgYm9vbGVhbiBiZSBzZXQ6IGl0IGNh\nbm5vdAogICAgICAgIC8vIGhhbmRsZSBhIG51bWVyaWMgYXJndW1lbnQKICAg\nICAgICBzdG1udC5zZXRTdHJpbmcoaWR4LCB2YWwgPyAidCIgOiAiZiIpOwog\nICAgfQoKICAgIEBPdmVycmlkZQogICAgcHVibGljIFN0cmluZ1tdIGdldENy\nZWF0ZVRhYmxlU1FMKFRhYmxlIHRhYmxlKSB7CiAgICAgICAgU3RyaW5nW10g\nY3JlYXRlID0gc3VwZXIuZ2V0Q3JlYXRlVGFibGVTUUwodGFibGUpOwogICAg\nICAgIGNyZWF0ZVswXSA9IGNyZWF0ZVswXSArICIgTE9DSyBNT0RFIFJPVyI7\nCiAgICAgICAgcmV0dXJuIGNyZWF0ZTsKICAgIH0KCiAgICBAT3ZlcnJpZGUK\nICAgIHB1YmxpYyBTdHJpbmdbXSBnZXRBZGRQcmltYXJ5S2V5U1FMKFByaW1h\ncnlLZXkgcGspIHsKICAgICAgICBTdHJpbmcgcGtzcWwgPSBnZXRQcmltYXJ5\nS2V5Q29uc3RyYWludFNRTChwayk7CiAgICAgICAgaWYgKHBrc3FsID09IG51\nbGwpCiAgICAgICAgICAgIHJldHVybiBuZXcgU3RyaW5nWzBdOwogICAgICAg\nIHJldHVybiBuZXcgU3RyaW5nW117ICJBTFRFUiBUQUJMRSAiCiAgICAgICAg\nICAgICsgZ2V0RnVsbE5hbWUocGsuZ2V0VGFibGUoKSwgZmFsc2UpICsgIiBB\nREQgQ09OU1RSQUlOVCAiICsgcGtzcWwgfTsKICAgIH0KCiAgICBAT3ZlcnJp\nZGUKICAgIHB1YmxpYyBTdHJpbmdbXSBnZXRBZGRGb3JlaWduS2V5U1FMKEZv\ncmVpZ25LZXkgZmspIHsKICAgICAgICBTdHJpbmcgZmtzcWwgPSBnZXRGb3Jl\naWduS2V5Q29uc3RyYWludFNRTChmayk7CiAgICAgICAgaWYgKGZrc3FsID09\nIG51bGwpCiAgICAgICAgICAgIHJldHVybiBuZXcgU3RyaW5nWzBdOwogICAg\nICAgIHJldHVybiBuZXcgU3RyaW5nW117ICJBTFRFUiBUQUJMRSAiCiAgICAg\nICAgICAgICsgZ2V0RnVsbE5hbWUoZmsuZ2V0VGFibGUoKSwgZmFsc2UpICsg\nIiBBREQgQ09OU1RSQUlOVCAiICsgZmtzcWwgfTsKICAgIH0KCiAgICBAT3Zl\ncnJpZGUKICAgIHB1YmxpYyBib29sZWFuIHN1cHBvcnRzUmFuZG9tQWNjZXNz\nUmVzdWx0U2V0KFNlbGVjdCBzZWwsCiAgICAgICAgYm9vbGVhbiBmb3JVcGRh\ndGUpIHsKICAgICAgICByZXR1cm4gIWZvclVwZGF0ZSAmJiAhc2VsLmlzTG9i\nKCkKICAgICAgICAgICAgJiYgc3VwZXIuc3VwcG9ydHNSYW5kb21BY2Nlc3NS\nZXN1bHRTZXQoc2VsLCBmb3JVcGRhdGUpOwogICAgfQoKICAgIEBPdmVycmlk\nZQogICAgcHVibGljIENvbm5lY3Rpb24gZGVjb3JhdGUoQ29ubmVjdGlvbiBj\nb25uKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIGNv\nbm4gPSBzdXBlci5kZWNvcmF0ZShjb25uKTsKICAgICAgICBpZiAoaXNKREJD\nMyAmJiBjb25uLmdldEhvbGRhYmlsaXR5KCkgIT0gCiAgICAgICAgICAgIFJl\nc3VsdFNldC5IT0xEX0NVUlNPUlNfT1ZFUl9DT01NSVQpIHsKICAgICAgICAg\nICAgY29ubi5zZXRIb2xkYWJpbGl0eShSZXN1bHRTZXQuSE9MRF9DVVJTT1JT\nX09WRVJfQ09NTUlUKTsKICAgICAgICAgICAgaWYgKGxvZy5pc1RyYWNlRW5h\nYmxlZCgpKSB7ICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAg\nIGxvZy50cmFjZShfbG9jLmdldCgiY29ubmVjdGlvbi1kZWZhdWx0cyIsIG5l\ndyBPYmplY3RbXXsKICAgICAgICAgICAgICAgICAgICBjb25uLmdldEF1dG9D\nb21taXQoKSwgY29ubi5nZXRIb2xkYWJpbGl0eSgpLAogICAgICAgICAgICAg\nICAgICAgIGNvbm4uZ2V0VHJhbnNhY3Rpb25Jc29sYXRpb24oKX0pKTsKICAg\nICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgLy8gaWYgd2UgaGF2ZW4n\ndCBhbHJlYWR5IGRvbmUgc28sIGluaXRpYWxpemUgdGhlIGxvY2sgbW9kZSBv\nZiB0aGUKICAgICAgICAvLyBjb25uZWN0aW9uCiAgICAgICAgaWYgKGxvY2tN\nb2RlRW5hYmxlZCAmJiBfc2VlbkNvbm5lY3Rpb25zLmFkZChjb25uKSkgewog\nICAgICAgICAgICBTdHJpbmcgc3FsID0gIlNFVCBMT0NLIE1PREUgVE8gV0FJ\nVCI7CiAgICAgICAgICAgIGlmIChsb2NrV2FpdFNlY29uZHMgPiAwKQogICAg\nICAgICAgICAgICAgc3FsID0gc3FsICsgIiAiICsgbG9ja1dhaXRTZWNvbmRz\nOwoKICAgICAgICAgICAgU3RhdGVtZW50IHN0bW50ID0gbnVsbDsKICAgICAg\nICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIHN0bW50ID0gY29ubi5jcmVh\ndGVTdGF0ZW1lbnQoKTsKICAgICAgICAgICAgICAgIHN0bW50LmV4ZWN1dGVV\ncGRhdGUoc3FsKTsKICAgICAgICAgICAgfSBjYXRjaCAoU1FMRXhjZXB0aW9u\nIHNlKSB7CiAgICAgICAgICAgICAgICB0aHJvdyBTUUxFeGNlcHRpb25zLmdl\ndFN0b3JlKHNlLCB0aGlzKTsKICAgICAgICAgICAgfSBmaW5hbGx5IHsKICAg\nICAgICAgICAgICAgIGlmIChzdG1udCAhPSBudWxsKQogICAgICAgICAgICAg\nICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHN0bW50LmNs\nb3NlKCk7CiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoU1FMRXhjZXB0\naW9uIHNlKSB7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9\nCiAgICAgICAgfQoKICAgICAgICAvLyB0aGUgZGF0YWRpcmVjdCBkcml2ZXIg\ncmVxdWlyZXMgdGhhdCB3ZSBpc3N1ZSBhIHJvbGxiYWNrIGJlZm9yZSB1c2lu\nZwogICAgICAgIC8vIGVhY2ggY29ubmVjdGlvbgogICAgICAgIGlmIChWRU5E\nT1JfREFUQURJUkVDVC5lcXVhbHNJZ25vcmVDYXNlKGRyaXZlclZlbmRvcikp\nCiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBjb25uLnJvbGxi\nYWNrKCk7CiAgICAgICAgICAgIH0gY2F0Y2ggKFNRTEV4Y2VwdGlvbiBzZSkg\newogICAgICAgICAgICB9CiAgICAgICAgcmV0dXJuIGNvbm47CiAgICB9Cgog\nICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgdm9pZCBpbmRleE9mKFNRTEJ1ZmZl\nciBidWYsIEZpbHRlclZhbHVlIHN0ciwgRmlsdGVyVmFsdWUgZmluZCwKICAg\nICAgICBGaWx0ZXJWYWx1ZSBzdGFydCkgewogICAgICAgIHRocm93IG5ldyBV\nbnN1cHBvcnRlZEV4Y2VwdGlvbihfbG9jLmdldCgiZnVuY3Rpb24tbm90LXN1\ncHBvcnRlZCIsCiAgICAgICAgICAgICAgICBnZXRDbGFzcygpLCAiTE9DQVRF\nIikpOwogICAgfQoKICAgIEBPdmVycmlkZQogICAgcHVibGljIGJvb2xlYW4g\nbmVlZHNUb0NyZWF0ZUluZGV4KEluZGV4IGlkeCwgVGFibGUgdGFibGUpIHsK\nICAgICAgIC8vIEluZm9ybWl4IHdpbGwgYXV0b21hdGljYWxseSBjcmVhdGUg\nYSB1bmlxdWUgaW5kZXggZm9yIHRoZSAKICAgICAgIC8vIHByaW1hcnkga2V5\nLCBzbyBkb24ndCBjcmVhdGUgYW5vdGhlciBpbmRleCBhZ2FpbgogICAgICAg\nUHJpbWFyeUtleSBwayA9IHRhYmxlLmdldFByaW1hcnlLZXkoKTsKICAgICAg\nIGlmIChwayAhPSBudWxsICYmIGlkeC5jb2x1bW5zTWF0Y2gocGsuZ2V0Q29s\ndW1ucygpKSkKICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICByZXR1\ncm4gdHJ1ZTsKICAgIH0KICAgIAogICAgcHVibGljIGJvb2xlYW4gdXNlSkND\nKCkgewogICAgICAgIHJldHVybiB1c2VKQ0M7CiAgICB9CiAgICAKICAgIC8q\nKgogICAgICogUmV0dXJuIERCIHNwZWNpZmljIHNjaGVtYUNhc2UgCiAgICAg\nKi8KICAgIEBPdmVycmlkZQogICAgcHVibGljIFN0cmluZyBnZXRTY2hlbWFD\nYXNlKCl7CiAgICAgICAgcmV0dXJuIHNjaGVtYUNhc2U7CiAgICB9CiAgICAg\nICAgCiAgICBAT3ZlcnJpZGUKICAgIHByb3RlY3RlZCBCb29sZWFuIG1hdGNo\nRXJyb3JTdGF0ZShpbnQgc3VidHlwZSwgU2V0PFN0cmluZz4gZXJyb3JTdGF0\nZXMsCiAgICAgICAgU1FMRXhjZXB0aW9uIGV4KSB7CiAgICAgICAgQm9vbGVh\nbiByZWNvdmVyYWJsZSA9IG51bGw7CiAgICAgICAgU3RyaW5nIGVycm9yU3Rh\ndGUgPSBleC5nZXRTUUxTdGF0ZSgpOwogICAgICAgIGlmIChlcnJvclN0YXRl\ncy5jb250YWlucyhlcnJvclN0YXRlKSkgewogICAgICAgICAgICAvLyBTUUwg\nU3RhdGUgb2YgSVgwMDAgaXMgYSBnZW5lcmFsIHB1cnBvc2UgSW5mb3JtaXgg\nZXJyb3IgY29kZQogICAgICAgICAgICAvLyBjYXRlZ29yeSwgc28gb25seSBy\nZXR1cm4gQm9vbGVhbi5UUlVFIGlmIHdlIG1hdGNoIFNRTCBDb2RlcwogICAg\nICAgICAgICAvLyByZWNvdmVyYWJsZSA9IEJvb2xlYW4uRkFMU0U7CiAgICAg\nICAgICAgIGlmIChzdWJ0eXBlID09IFN0b3JlRXhjZXB0aW9uLkxPQ0sgJiYK\nICAgICAgICAgICAgICAgIGV4LmdldEVycm9yQ29kZSgpID09IC0xNTQpIHsK\nICAgICAgICAgICAgICAgIHJlY292ZXJhYmxlID0gQm9vbGVhbi5UUlVFOwog\nICAgICAgICAgICB9IGVsc2UgaWYgKHN1YnR5cGUgPT0gU3RvcmVFeGNlcHRp\nb24uUVVFUlkgJiYKICAgICAgICAgICAgICAgIGV4LmdldEVycm9yQ29kZSgp\nID09IC0yMTMpIHsKICAgICAgICAgICAgICAgIHJlY292ZXJhYmxlID0gQm9v\nbGVhbi5UUlVFOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJl\ndHVybiByZWNvdmVyYWJsZTsKICAgIH0KfQoK\n","encoding":"base64"}

