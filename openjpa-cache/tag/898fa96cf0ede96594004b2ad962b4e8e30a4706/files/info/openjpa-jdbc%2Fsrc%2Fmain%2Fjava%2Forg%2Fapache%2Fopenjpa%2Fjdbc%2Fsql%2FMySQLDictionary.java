{"sha":"be1e160134de74cf6fe8068058dc5285c323d7eb","node_id":"MDQ6QmxvYjIwNjM2NDpiZTFlMTYwMTM0ZGU3NGNmNmZlODA2ODA1OGRjNTI4NWMzMjNkN2Vi","size":15582,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/be1e160134de74cf6fe8068058dc5285c323d7eb","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zcWw7CgppbXBvcnQg\namF2YS5zcWwuQ29ubmVjdGlvbjsKaW1wb3J0IGphdmEuc3FsLkRhdGFiYXNl\nTWV0YURhdGE7CmltcG9ydCBqYXZhLnNxbC5SZXN1bHRTZXQ7CmltcG9ydCBq\nYXZhLnNxbC5TUUxFeGNlcHRpb247CmltcG9ydCBqYXZhLnNxbC5UeXBlczsK\naW1wb3J0IGphdmEudXRpbC5BcnJheXM7CmltcG9ydCBqYXZhLnV0aWwuQ29s\nbGVjdGlvbjsKaW1wb3J0IGphdmEudXRpbC5IYXNoU2V0OwppbXBvcnQgamF2\nYS51dGlsLkxpc3Q7CmltcG9ydCBqYXZhLnV0aWwuU2V0OwoKaW1wb3J0IG9y\nZy5hcGFjaGUuY29tbW9ucy5sYW5nLlN0cmluZ1V0aWxzOwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLmpkYmMuaWRlbnRpZmllci5EQklkZW50aWZpZXI7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5rZXJuZWwuSkRCQ0Zl\ndGNoQ29uZmlndXJhdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5q\nZGJjLmtlcm5lbC5KREJDU3RvcmU7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEuamRiYy5rZXJuZWwuZXhwcy5GaWx0ZXJWYWx1ZTsKaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS5qZGJjLnNjaGVtYS5Db2x1bW47CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hlbWEuRm9yZWlnbktleTsKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNjaGVtYS5JbmRleDsKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNjaGVtYS5QcmltYXJ5S2V5Owpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1hLlRhYmxlOwoK\nLyoqCiAqIERpY3Rpb25hcnkgZm9yIE15U1FMLgogKi8KcHVibGljIGNsYXNz\nIE15U1FMRGljdGlvbmFyeQogICAgZXh0ZW5kcyBEQkRpY3Rpb25hcnkgewoK\nICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgU3RyaW5nIFNFTEVDVF9ISU5UID0g\nIm9wZW5qcGEuaGludC5NeVNRTFNlbGVjdEhpbnQiOwoKICAgIHB1YmxpYyBz\ndGF0aWMgZmluYWwgU3RyaW5nIERFTElNSVRFUl9CQUNLX1RJQ0sgPSAiYCI7\nCiAgICAKICAgIC8qKgogICAgICogVGhlIE15U1FMIHRhYmxlIHR5cGUgdG8g\ndXNlIHdoZW4gY3JlYXRpbmcgdGFibGVzOyBkZWZhdWx0cyB0byBpbm5vZGIu\nCiAgICAgKi8KICAgIHB1YmxpYyBTdHJpbmcgdGFibGVUeXBlID0gImlubm9k\nYiI7CgogICAgLyoqCiAgICAgKiBXaGV0aGVyIHRvIHVzZSBjbG9iczsgZGVm\nYXVsdHMgdG8gdHJ1ZS4gU2V0IHRoaXMgdG8gZmFsc2UgaWYgeW91IGhhdmUg\nYW4KICAgICAqIG9sZCB2ZXJzaW9uIG9mIE15U1FMIHdoaWNoIGRvZXMgbm90\nIGhhbmRsZSBjbG9icyBwcm9wZXJseS4KICAgICAqLwogICAgcHVibGljIGJv\nb2xlYW4gdXNlQ2xvYnMgPSB0cnVlOwoKICAgIC8qKgogICAgICogV2hldGhl\nciB0aGUgZHJpdmVyIGF1dG9tYXRpY2FsbHkgZGVzZXJpYWxpemVzIGJsb2Jz\nLgogICAgICovCiAgICBwdWJsaWMgYm9vbGVhbiBkcml2ZXJEZXNlcmlhbGl6\nZXNCbG9icyA9IGZhbHNlOwoKICAgIC8qKgogICAgICogV2hldGhlciB0byBp\nbmxpbmUgbXVsdGktdGFibGUgYnVsay1kZWxldGUgb3BlcmF0aW9ucyBpbnRv\nIE15U1FMJ3MgCiAgICAgKiBjb21iaW5lZCA8Y29kZT5ERUxFVEUgRlJPTSBm\nb28sIGJhciwgYmF6PC9jb2RlPiBzeW50YXguIAogICAgICogRGVmYXVsdHMg\ndG8gZmFsc2UsIHNpbmNlIHRoaXMgbWF5IGZhaWwgaW4gdGhlIHByZXNlbmNl\nIG9mIElubm9EQiB0YWJsZXMKICAgICAqIHdpdGggZm9yZWlnbiBrZXlzLgog\nICAgICogQHNlZSBodHRwOi8vZGV2Lm15c3FsLmNvbS9kb2MvcmVmbWFuLzUu\nMC9lbi9kZWxldGUuaHRtbAogICAgICovCiAgICBwdWJsaWMgYm9vbGVhbiBv\ncHRpbWl6ZU11bHRpVGFibGVEZWxldGVzID0gZmFsc2U7CgogICAgcHVibGlj\nIE15U1FMRGljdGlvbmFyeSgpIHsKICAgICAgICBwbGF0Zm9ybSA9ICJNeVNR\nTCI7CiAgICAgICAgdmFsaWRhdGlvblNRTCA9ICJTRUxFQ1QgTk9XKCkiOwog\nICAgICAgIGRpc3RpbmN0Q291bnRDb2x1bW5TZXBhcmF0b3IgPSAiLCI7Cgog\nICAgICAgIHN1cHBvcnRzRGVmZXJyZWRDb25zdHJhaW50cyA9IGZhbHNlOwog\nICAgICAgIGNvbnN0cmFpbnROYW1lTW9kZSA9IENPTlNfTkFNRV9NSUQ7CiAg\nICAgICAgc3VwcG9ydHNNdWx0aXBsZU5vbnRyYW5zYWN0aW9uYWxSZXN1bHRT\nZXRzID0gZmFsc2U7CiAgICAgICAgcmVxdWlyZXNBbGlhc0ZvclN1YnNlbGVj\ndCA9IHRydWU7IC8vIG5ldyB2ZXJzaW9ucwogICAgICAgIHJlcXVpcmVzVGFy\nZ2V0Rm9yRGVsZXRlID0gdHJ1ZTsKICAgICAgICBzdXBwb3J0c1NlbGVjdFN0\nYXJ0SW5kZXggPSB0cnVlOwogICAgICAgIHN1cHBvcnRzU2VsZWN0RW5kSW5k\nZXggPSB0cnVlOwoKICAgICAgICBjb25jYXRlbmF0ZUZ1bmN0aW9uID0gIkNP\nTkNBVCh7MH0sezF9KSI7CgogICAgICAgIG1heFRhYmxlTmFtZUxlbmd0aCA9\nIDY0OwogICAgICAgIG1heENvbHVtbk5hbWVMZW5ndGggPSA2NDsKICAgICAg\nICBtYXhJbmRleE5hbWVMZW5ndGggPSA2NDsKICAgICAgICBtYXhDb25zdHJh\naW50TmFtZUxlbmd0aCA9IDY0OwogICAgICAgIG1heEluZGV4ZXNQZXJUYWJs\nZSA9IDMyOwogICAgICAgIHNjaGVtYUNhc2UgPSBTQ0hFTUFfQ0FTRV9QUkVT\nRVJWRTsKCiAgICAgICAgc3VwcG9ydHNBdXRvQXNzaWduID0gdHJ1ZTsKICAg\nICAgICBsYXN0R2VuZXJhdGVkS2V5UXVlcnkgPSAiU0VMRUNUIExBU1RfSU5T\nRVJUX0lEKCkiOwogICAgICAgIGF1dG9Bc3NpZ25DbGF1c2UgPSAiQVVUT19J\nTkNSRU1FTlQiOwoKICAgICAgICBjbG9iVHlwZU5hbWUgPSAiVEVYVCI7CiAg\nICAgICAgbG9uZ1ZhcmNoYXJUeXBlTmFtZSA9ICJURVhUIjsKICAgICAgICBs\nb25nVmFyYmluYXJ5VHlwZU5hbWUgPSAiTE9ORyBWQVJCSU5BUlkiOwogICAg\nICAgIHRpbWVzdGFtcFR5cGVOYW1lID0gIkRBVEVUSU1FIjsKICAgICAgICB4\nbWxUeXBlTmFtZSA9ICJURVhUIjsKICAgICAgICBmaXhlZFNpemVUeXBlTmFt\nZVNldC5hZGRBbGwoQXJyYXlzLmFzTGlzdChuZXcgU3RyaW5nW117CiAgICAg\nICAgICAgICJCT09MIiwgIkxPTkcgVkFSQklOQVJZIiwgIk1FRElVTUJMT0Ii\nLCAiTE9OR0JMT0IiLAogICAgICAgICAgICAiVElOWUJMT0IiLCAiTE9ORyBW\nQVJDSEFSIiwgIk1FRElVTVRFWFQiLCAiTE9OR1RFWFQiLCAiVEVYVCIsCiAg\nICAgICAgICAgICJUSU5ZVEVYVCIsICJET1VCTEUgUFJFQ0lTSU9OIiwgIkVO\nVU0iLCAiU0VUIiwgIkRBVEVUSU1FIiwKICAgICAgICB9KSk7CiAgICAgICAg\ncmVzZXJ2ZWRXb3JkU2V0LmFkZEFsbChBcnJheXMuYXNMaXN0KG5ldyBTdHJp\nbmdbXXsKICAgICAgICAgICAgIkFVVE9fSU5DUkVNRU5UIiwgIkJJTkFSWSIs\nICJCTE9CIiwgIkNIQU5HRSIsICJFTlVNIiwgIklORklMRSIsCiAgICAgICAg\nICAgICJJTlQxIiwgIklOVDIiLCAiSU5UNCIsICJGTE9BVDEiLCAiRkxPQVQy\nIiwgIkZMT0FUNCIsICJMT0FEIiwKICAgICAgICAgICAgIk1FRElVTUlOVCIs\nICJPVVRGSUxFIiwgIlJFUExBQ0UiLCAiU1RBUlRJTkciLCAiVEVYVCIsICJV\nTlNJR05FRCIsIAogICAgICAgICAgICAiWkVST0ZJTEwiLAogICAgICAgIH0p\nKTsKCiAgICAgICAgLy8gcmVzZXJ2ZWRXb3JkU2V0IHN1YnNldCB0aGF0IENB\nTk5PVCBiZSB1c2VkIGFzIHZhbGlkIGNvbHVtbiBuYW1lcwogICAgICAgIC8v\nIChpLmUuLCB3aXRob3V0IHN1cnJvdW5kaW5nIHRoZW0gd2l0aCBkb3VibGUt\ncXVvdGVzKQogICAgICAgIGludmFsaWRDb2x1bW5Xb3JkU2V0LmFkZEFsbChB\ncnJheXMuYXNMaXN0KG5ldyBTdHJpbmdbXXsKICAgICAgICAgICAgIkFERCIs\nICJBTEwiLCAiQUxURVIiLCAiQU5EIiwgIkFTIiwgIkFTQyIsICJCRVRXRUVO\nIiwgIkJJTkFSWSIsCiAgICAgICAgICAgICJCTE9CIiwgIkJPVEgiLCAiQlki\nLCAiQ0FTQ0FERSIsICJDQVNFIiwgIkNIQU5HRSIsICJDSEFSIiwgCiAgICAg\nICAgICAgICJDSEFSQUNURVIiLCAiQ0hFQ0siLCAiQ09MTEFURSIsICJDT0xV\nTU4iLCAiQ09OU1RSQUlOVCIsICJDT05USU5VRSIsCiAgICAgICAgICAgICJD\nT05WRVJUIiwgIkNSRUFURSIsICJDUk9TUyIsICJDVVJSRU5UX0RBVEUiLCAi\nQ1VSUkVOVF9USU1FIiwKICAgICAgICAgICAgIkNVUlJFTlRfVElNRVNUQU1Q\nIiwgIkNVUlJFTlRfVVNFUiIsICJDVVJTT1IiLCAiREVDIiwgIkRFQ0lNQUwi\nLAogICAgICAgICAgICAiREVDTEFSRSIsICJERUZBVUxUIiwgIkRFTEVURSIs\nICJERVNDIiwgIkRFU0NSSUJFIiwgIkRJU1RJTkNUIiwKICAgICAgICAgICAg\nIkRPVUJMRSIsICJEUk9QIiwgIkVMU0UiLCAiRU5ELUVYRUMiLCAiRVhJU1RT\nIiwgIkZBTFNFIiwgIkZFVENIIiwKICAgICAgICAgICAgIkZMT0FUIiwgIkZM\nT0FUNCIsICJGT1IiLCAiRk9SRUlHTiIsICJGUk9NIiwgIkdSQU5UIiwgIkdS\nT1VQIiwKICAgICAgICAgICAgIkhBVklORyIsICJJTiIsICJJTkZJTEUiLCAi\nSU5ORVIiLCAiSU5TRU5TSVRJVkUiLCAiSU5TRVJUIiwgIklOVCIsCiAgICAg\nICAgICAgICJJTlQxIiwgIklOVDIiLCAiSU5UNCIsICJJTlRFR0VSIiwgIklO\nVEVSVkFMIiwgIklOVE8iLCAiSVMiLCAiSk9JTiIsCiAgICAgICAgICAgICJL\nRVkiLCAiTEVBRElORyIsICJMRUZUIiwgIkxJS0UiLCAiTE9BRCIsICJNQVRD\nSCIsICJNRURJVU1JTlQiLAogICAgICAgICAgICAiTkFUVVJBTCIsICJOT1Qi\nLCAiTlVMTCIsICJOVU1FUklDIiwgIk9OIiwgIk9QVElPTiIsICJPUiIsICJP\nUkRFUiIsCiAgICAgICAgICAgICJPVVRFUiIsICJPVVRGSUxFIiwgIlBSRUNJ\nU0lPTiIsICJQUklNQVJZIiwgIlBST0NFRFVSRSIsICJSRUFEIiwKICAgICAg\nICAgICAgIlJFQUwiLCAiUkVGRVJFTkNFUyIsICJSRVBMQUNFIiwgIlJFU1RS\nSUNUIiwgIlJFVk9LRSIsICJSSUdIVCIsCiAgICAgICAgICAgICJTQ0hFTUEi\nLCAiU0VMRUNUIiwgIlNFVCIsICJTTUFMTElOVCIsICJTUUwiLCAiU1FMU1RB\nVEUiLAogICAgICAgICAgICAiU1RBUlRJTkciLCAiVEFCTEUiLCAiVEhFTiIs\nICJUTyIsICJUUkFJTElORyIsICJUUlVFIiwgIlVOSU9OIiwKICAgICAgICAg\nICAgIlVOSVFVRSIsICJVTlNJR05FRCIsICJVUERBVEUiLCAiVVNBR0UiLCAi\nVVNJTkciLCAiVkFMVUVTIiwKICAgICAgICAgICAgIlZBUkNIQVIiLCAiVkFS\nWUlORyIsICJXSEVOIiwgIldIRVJFIiwgIldJVEgiLCAiV1JJVEUiLCAiWkVS\nT0ZJTEwiLAogICAgICAgIH0pKTsKCiAgICAgICAgLy8gTXlTUUwgcmVxdWly\nZXMgZG91YmxlLWVzY2FwZSBmb3Igc3RyaW5ncwogICAgICAgIHNlYXJjaFN0\ncmluZ0VzY2FwZSA9ICJcXFxcIjsKCiAgICAgICAgdHlwZU1vZGlmaWVyU2V0\nLmFkZEFsbChBcnJheXMuYXNMaXN0KG5ldyBTdHJpbmdbXSB7ICJVTlNJR05F\nRCIsCiAgICAgICAgICAgICJaRVJPRklMTCIgfSkpOwoKICAgICAgICBzZXRM\nZWFkaW5nRGVsaW1pdGVyKERFTElNSVRFUl9CQUNLX1RJQ0spOwogICAgICAg\nIHNldFRyYWlsaW5nRGVsaW1pdGVyKERFTElNSVRFUl9CQUNLX1RJQ0spOwog\nICAgICAgIAogICAgICAgIGZpeGVkU2l6ZVR5cGVOYW1lU2V0LnJlbW92ZSgi\nTlVNRVJJQyIpOwogICAgfQoKICAgIEBPdmVycmlkZQogICAgcHVibGljIHZv\naWQgY29ubmVjdGVkQ29uZmlndXJhdGlvbihDb25uZWN0aW9uIGNvbm4pIHRo\ncm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIHN1cGVyLmNvbm5lY3RlZENv\nbmZpZ3VyYXRpb24oY29ubik7CgogICAgICAgIERhdGFiYXNlTWV0YURhdGEg\nbWV0YURhdGEgPSBjb25uLmdldE1ldGFEYXRhKCk7CiAgICAgICAgaW50IG1h\naiA9IDA7CiAgICAgICAgaW50IG1pbiA9IDA7CiAgICAgICAgaWYgKGlzSkRC\nQzMpIHsKICAgICAgICAgICAgbWFqID0gbWV0YURhdGEuZ2V0RGF0YWJhc2VN\nYWpvclZlcnNpb24oKTsKICAgICAgICAgICAgbWluID0gbWV0YURhdGEuZ2V0\nRGF0YWJhc2VNaW5vclZlcnNpb24oKTsKICAgICAgICB9IGVsc2UgewogICAg\nICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgLy8gVGhlIHByb2R1Y3Qg\ndmVyc2lvbiBsb29rcyBsaWtlIDQuMS4zLW50IG9yIDUuMS4zMAogICAgICAg\nICAgICAgICAgU3RyaW5nIHByb2R1Y3RWZXJzaW9uID0gbWV0YURhdGEuZ2V0\nRGF0YWJhc2VQcm9kdWN0VmVyc2lvbigpOwogICAgICAgICAgICAgICAgaW50\nW10gdmVyc2lvbnMgPSBnZXRNYWpvck1pbm9yVmVyc2lvbnMocHJvZHVjdFZl\ncnNpb24pOwogICAgICAgICAgICAgICAgbWFqID0gdmVyc2lvbnNbMF07CiAg\nICAgICAgICAgICAgICBtaW4gPSB2ZXJzaW9uc1sxXTsKICAgICAgICAgICAg\nfSBjYXRjaCAoSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uIGUpIHsKICAgICAg\nICAgICAgICAgIC8vIHdlIGRvbid0IHVuZGVyc3RhbmQgdGhlIHZlcnNpb24g\nZm9ybWF0LgogICAgICAgICAgICAgICAgLy8gVGhhdCBpcyBvay4gV2UganVz\ndCB0YWtlIHRoZSBkZWZhdWx0IHZhbHVlcy4KICAgICAgICAgICAgICAgIGlm\nIChsb2cuaXNXYXJuRW5hYmxlZCgpKQogICAgICAgICAgICAgICAgICAgIGxv\nZy53YXJuKGUudG9TdHJpbmcoKSwgZSk7CiAgICAgICAgICAgIH0KICAgICAg\nICB9CiAgICAgICAgaWYgKG1haiA8IDQgfHwgKG1haiA9PSA0ICYmIG1pbiA8\nIDEpKSB7CiAgICAgICAgICAgIHN1cHBvcnRzU3Vic2VsZWN0ID0gZmFsc2U7\nCiAgICAgICAgICAgIGFsbG93c0FsaWFzSW5CdWxrQ2xhdXNlID0gZmFsc2U7\nCiAgICAgICAgICAgIHN1cHBvcnRzRm9yZWlnbktleXNDb21wb3NpdGUgPSBm\nYWxzZTsKICAgICAgICB9CiAgICAgICAgaWYgKG1haiA+IDUgfHwgKG1haiA9\nPSA1ICYmIG1pbiA+PSAxKSkKICAgICAgICAgICAgc3VwcG9ydHNYTUxDb2x1\nbW4gPSB0cnVlOwoKICAgICAgICBpZiAobWV0YURhdGEuZ2V0RHJpdmVyTWFq\nb3JWZXJzaW9uKCkgPCA1KQogICAgICAgICAgICBkcml2ZXJEZXNlcmlhbGl6\nZXNCbG9icyA9IHRydWU7CiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwdWJs\naWMgQ29ubmVjdGlvbiBkZWNvcmF0ZShDb25uZWN0aW9uIGNvbm4pICB0aHJv\nd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBjb25uID0gc3VwZXIuZGVjb3Jh\ndGUoY29ubik7CiAgICAgICAgU3RyaW5nIGRyaXZlciA9IGNvbmYuZ2V0Q29u\nbmVjdGlvbkRyaXZlck5hbWUoKTsKICAgICAgICBpZiAoImNvbS5teXNxbC5q\nZGJjLlJlcGxpY2F0aW9uRHJpdmVyIi5lcXVhbHMoZHJpdmVyKSkKICAgICAg\nICAgICAgY29ubi5zZXRSZWFkT25seSh0cnVlKTsKICAgICAgICByZXR1cm4g\nY29ubjsKICAgIH0KICAgIAogICAgcHJpdmF0ZSBzdGF0aWMgaW50W10gZ2V0\nTWFqb3JNaW5vclZlcnNpb25zKFN0cmluZyB2ZXJzaW9uU3RyKQogICAgICAg\nIHRocm93cyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24gewogICAgICAgIGlu\ndCBiZWdpbkluZGV4ID0gMDsKCiAgICAgICAgdmVyc2lvblN0ciA9IHZlcnNp\nb25TdHIudHJpbSgpOwogICAgICAgIGNoYXJbXSBjaGFyQXJyID0gdmVyc2lv\nblN0ci50b0NoYXJBcnJheSgpOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBp\nIDwgY2hhckFyci5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBpZiAoQ2hh\ncmFjdGVyLmlzRGlnaXQoY2hhckFycltpXSkpIHsKICAgICAgICAgICAgICAg\nIGJlZ2luSW5kZXggPSBpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAg\nICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGludCBlbmRJbmRleCA9IGNo\nYXJBcnIubGVuZ3RoOwogICAgICAgIGZvciAoaW50IGkgPSBiZWdpbkluZGV4\nKzE7IGkgPCBjaGFyQXJyLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGlm\nIChjaGFyQXJyW2ldICE9ICcuJyAmJiAhQ2hhcmFjdGVyLmlzRGlnaXQoY2hh\nckFycltpXSkpIHsKICAgICAgICAgICAgICAgIGVuZEluZGV4ID0gaTsKICAg\nICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgfQoK\nICAgICAgICBTdHJpbmdbXSBhcnIgPSB2ZXJzaW9uU3RyLnN1YnN0cmluZyhi\nZWdpbkluZGV4LCBlbmRJbmRleCkuc3BsaXQoIlxcLiIpOwogICAgICAgIGlm\nIChhcnIubGVuZ3RoIDwgMikKICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVn\nYWxBcmd1bWVudEV4Y2VwdGlvbigpOwoKICAgICAgICBpbnQgbWFqID0gSW50\nZWdlci5wYXJzZUludChhcnJbMF0pOwogICAgICAgIGludCBtaW4gPSBJbnRl\nZ2VyLnBhcnNlSW50KGFyclsxXSk7CiAgICAgICAgcmV0dXJuIG5ldyBpbnRb\nXXttYWosIG1pbn07CiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMg\nU3RyaW5nW10gZ2V0Q3JlYXRlVGFibGVTUUwoVGFibGUgdGFibGUpIHsKICAg\nICAgICBTdHJpbmdbXSBzcWwgPSBzdXBlci5nZXRDcmVhdGVUYWJsZVNRTCh0\nYWJsZSk7CiAgICAgICAgaWYgKCFTdHJpbmdVdGlscy5pc0VtcHR5KHRhYmxl\nVHlwZSkpCiAgICAgICAgICAgIHNxbFswXSA9IHNxbFswXSArICIgVFlQRSA9\nICIgKyB0YWJsZVR5cGU7CiAgICAgICAgcmV0dXJuIHNxbDsKICAgIH0KCiAg\nICBAT3ZlcnJpZGUKICAgIHB1YmxpYyBTdHJpbmdbXSBnZXREcm9wSW5kZXhT\nUUwoSW5kZXggaW5kZXgpIHsKICAgICAgICByZXR1cm4gbmV3IFN0cmluZ1td\neyAiRFJPUCBJTkRFWCAiICsgZ2V0RnVsbE5hbWUoaW5kZXgpICsgIiBPTiAi\nCiAgICAgICAgICAgICsgZ2V0RnVsbE5hbWUoaW5kZXguZ2V0VGFibGUoKSwg\nZmFsc2UpIH07CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gPGNvZGU+\nQUxURVIgVEFCTEUgJmx0O3RhYmxlIG5hbWUmZ3Q7IERST1AgUFJJTUFSWSBL\nRVk8L2NvZGU+LgogICAgICovCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyBT\ndHJpbmdbXSBnZXREcm9wUHJpbWFyeUtleVNRTChQcmltYXJ5S2V5IHBrKSB7\nCiAgICAgICAgaWYgKERCSWRlbnRpZmllci5pc051bGwocGsuZ2V0SWRlbnRp\nZmllcigpKSkKICAgICAgICAgICAgcmV0dXJuIG5ldyBTdHJpbmdbMF07CiAg\nICAgICAgcmV0dXJuIG5ldyBTdHJpbmdbXXsgIkFMVEVSIFRBQkxFICIKICAg\nICAgICAgICAgKyBnZXRGdWxsTmFtZShway5nZXRUYWJsZSgpLCBmYWxzZSkK\nICAgICAgICAgICAgKyAiIERST1AgUFJJTUFSWSBLRVkiIH07CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBSZXR1cm4gPGNvZGU+QUxURVIgVEFCTEUgJmx0O3Rh\nYmxlIG5hbWUmZ3Q7IERST1AgRk9SRUlHTiBLRVkKICAgICAqICZsdDtmayBu\nYW1lJmd0OzwvY29kZT4uCiAgICAgKi8KICAgIEBPdmVycmlkZQogICAgcHVi\nbGljIFN0cmluZ1tdIGdldERyb3BGb3JlaWduS2V5U1FMKEZvcmVpZ25LZXkg\nZmssIENvbm5lY3Rpb24gY29ubikgewogICAgICAgIGlmIChEQklkZW50aWZp\nZXIuaXNOdWxsKGZrLmdldElkZW50aWZpZXIoKSkpIHsKICAgICAgICAgICAg\nREJJZGVudGlmaWVyIGZrTmFtZSA9IGZrLmxvYWRJZGVudGlmaWVyRnJvbURC\nKHRoaXMsY29ubik7CiAgICAgICAgICAgIFN0cmluZ1tdIHJldFZhbCA9IChm\na05hbWUgPT0gbnVsbCkgPyAgbmV3IFN0cmluZ1swXSA6CiAgICAgICAgICAg\nICAgICBuZXcgU3RyaW5nW117ICJBTFRFUiBUQUJMRSAiCiAgICAgICAgICAg\nICAgICArIGdldEZ1bGxOYW1lKGZrLmdldFRhYmxlKCksIGZhbHNlKQogICAg\nICAgICAgICAgICAgKyAiIERST1AgRk9SRUlHTiBLRVkgIiArIHRvREJOYW1l\nKGZrTmFtZSkgfTsKICAgICAgICAgICAgcmV0dXJuIHJldFZhbDsgICAKICAg\nICAgICB9CiAgICAgICAgcmV0dXJuIG5ldyBTdHJpbmdbXXsgIkFMVEVSIFRB\nQkxFICIKICAgICAgICAgICAgKyBnZXRGdWxsTmFtZShmay5nZXRUYWJsZSgp\nLCBmYWxzZSkKICAgICAgICAgICAgKyAiIERST1AgRk9SRUlHTiBLRVkgIiAr\nIHRvREJOYW1lKGZrLmdldElkZW50aWZpZXIoKSkgfTsKICAgIH0KCiAgICBA\nT3ZlcnJpZGUKICAgIHB1YmxpYyBTdHJpbmdbXSBnZXRBZGRQcmltYXJ5S2V5\nU1FMKFByaW1hcnlLZXkgcGspIHsKICAgICAgICBTdHJpbmdbXSBzcWwgPSBz\ndXBlci5nZXRBZGRQcmltYXJ5S2V5U1FMKHBrKTsKCiAgICAgICAgLy8gbXlz\ncWwgcmVxdWlyZXMgdGhhdCBhIGNvbHVtbiBiZSBkZWNsYXJlZCBOT1QgTlVM\nTCBiZWZvcmUKICAgICAgICAvLyBpdCBjYW4gYmUgbWFkZSBhIHByaW1hcnkg\na2V5LgogICAgICAgIENvbHVtbltdIGNvbHMgPSBway5nZXRDb2x1bW5zKCk7\nCiAgICAgICAgU3RyaW5nW10gcmV0ID0gbmV3IFN0cmluZ1tjb2xzLmxlbmd0\naCArIHNxbC5sZW5ndGhdOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwg\nY29scy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICByZXRbaV0gPSAiQUxU\nRVIgVEFCTEUgIiArIGdldEZ1bGxOYW1lKGNvbHNbaV0uZ2V0VGFibGUoKSwg\nZmFsc2UpCiAgICAgICAgICAgICAgICArICIgQ0hBTkdFICIgKyB0b0RCTmFt\nZShjb2xzW2ldLmdldElkZW50aWZpZXIoKSkKICAgICAgICAgICAgICAgICsg\nIiAiICsgdG9EQk5hbWUoY29sc1tpXS5nZXRJZGVudGlmaWVyKCkpIC8vIG5h\nbWUgdHdpY2UKICAgICAgICAgICAgICAgICsgIiAiICsgZ2V0VHlwZU5hbWUo\nY29sc1tpXSkgKyAiIE5PVCBOVUxMIjsKICAgICAgICB9CgogICAgICAgIFN5\nc3RlbS5hcnJheWNvcHkoc3FsLCAwLCByZXQsIGNvbHMubGVuZ3RoLCBzcWwu\nbGVuZ3RoKTsKICAgICAgICByZXR1cm4gcmV0OwogICAgfQogICAgCiAgICBA\nT3ZlcnJpZGUKICAgIHB1YmxpYyBTdHJpbmdbXSBnZXREZWxldGVUYWJsZUNv\nbnRlbnRzU1FMKFRhYmxlW10gdGFibGVzLENvbm5lY3Rpb24gY29ubikgewog\nICAgICAgIC8vIG15c3FsID49IDQgc3VwcG9ydHMgbW9yZS1vcHRpbWFsIGRl\nbGV0ZSBzeW50YXgKICAgICAgICBpZiAoIW9wdGltaXplTXVsdGlUYWJsZURl\nbGV0ZXMpCiAgICAgICAgICAgIHJldHVybiBzdXBlci5nZXREZWxldGVUYWJs\nZUNvbnRlbnRzU1FMKHRhYmxlcyxjb25uKTsKICAgICAgICBlbHNlIHsKICAg\nICAgICAgICAgU3RyaW5nQnVpbGRlciBidWYgPSBuZXcgU3RyaW5nQnVpbGRl\ncih0YWJsZXMubGVuZ3RoICogOCk7CiAgICAgICAgICAgIGJ1Zi5hcHBlbmQo\nIkRFTEVURSBGUk9NICIpOwogICAgICAgICAgICBmb3IgKGludCBpID0gMDsg\naSA8IHRhYmxlcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgYnVm\nLmFwcGVuZCh0b0RCTmFtZSh0YWJsZXNbaV0uZ2V0RnVsbElkZW50aWZpZXIo\nKSkpOwogICAgICAgICAgICAgICAgaWYgKGkgPCB0YWJsZXMubGVuZ3RoIC0g\nMSkKICAgICAgICAgICAgICAgICAgICBidWYuYXBwZW5kKCIsICIpOwogICAg\nICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiBuZXcgU3RyaW5nW10geyBi\ndWYudG9TdHJpbmcoKSB9OwogICAgICAgIH0KICAgIH0KCiAgICBAT3ZlcnJp\nZGUKICAgIHByb3RlY3RlZCB2b2lkIGFwcGVuZFNlbGVjdFJhbmdlKFNRTEJ1\nZmZlciBidWYsIGxvbmcgc3RhcnQsIGxvbmcgZW5kLAogICAgICAgIGJvb2xl\nYW4gc3Vic2VsZWN0KSB7CiAgICAgICAgYnVmLmFwcGVuZCgiIExJTUlUICIp\nLmFwcGVuZFZhbHVlKHN0YXJ0KS5hcHBlbmQoIiwgIik7CiAgICAgICAgaWYg\nKGVuZCA9PSBMb25nLk1BWF9WQUxVRSkKICAgICAgICAgICAgYnVmLmFwcGVu\nZFZhbHVlKExvbmcuTUFYX1ZBTFVFKTsKICAgICAgICBlbHNlCiAgICAgICAg\nICAgIGJ1Zi5hcHBlbmRWYWx1ZShlbmQgLSBzdGFydCk7CiAgICB9CgogICAg\nQE92ZXJyaWRlCiAgICBwcm90ZWN0ZWQgQ29sdW1uIG5ld0NvbHVtbihSZXN1\nbHRTZXQgY29sTWV0YSkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsK\nICAgICAgICBDb2x1bW4gY29sID0gc3VwZXIubmV3Q29sdW1uKGNvbE1ldGEp\nOwogICAgICAgIGlmIChjb2wuaXNOb3ROdWxsKCkgJiYgIjAiLmVxdWFscyhj\nb2wuZ2V0RGVmYXVsdFN0cmluZygpKSkKICAgICAgICAgICAgY29sLnNldERl\nZmF1bHRTdHJpbmcobnVsbCk7CiAgICAgICAgcmV0dXJuIGNvbDsKICAgIH0K\nCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyBPYmplY3QgZ2V0QmxvYk9iamVj\ndChSZXN1bHRTZXQgcnMsIGludCBjb2x1bW4sIEpEQkNTdG9yZSBzdG9yZSkK\nICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAvLyBpZiB0\naGUgdXNlciBoYXMgc2V0IGEgZ2V0LWJsb2Igc3RyYXRlZ3kgZXhwbGljaXRs\neSBvciB0aGUgZHJpdmVyCiAgICAgICAgLy8gZG9lcyBub3QgYXV0b21hdGlj\nYWxseSBkZXNlcmlhbGl6ZSwgZGVsZWdhdGUgdG8gc3VwZXIKICAgICAgICBp\nZiAodXNlR2V0Qnl0ZXNGb3JCbG9icyB8fCB1c2VHZXRPYmplY3RGb3JCbG9i\ncwogICAgICAgICAgICB8fCAhZHJpdmVyRGVzZXJpYWxpemVzQmxvYnMpCiAg\nICAgICAgICAgIHJldHVybiBzdXBlci5nZXRCbG9iT2JqZWN0KHJzLCBjb2x1\nbW4sIHN0b3JlKTsKCiAgICAgICAgLy8gbW9zdCBteXNxbCBkcml2ZXJzIGRl\nc2VyaWFsaXplIG9uIGdldE9iamVjdAogICAgICAgIHJldHVybiBycy5nZXRP\nYmplY3QoY29sdW1uKTsKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHB1Ymxp\nYyBpbnQgZ2V0UHJlZmVycmVkVHlwZShpbnQgdHlwZSkgewogICAgICAgIGlm\nICh0eXBlID09IFR5cGVzLkNMT0IgJiYgIXVzZUNsb2JzKQogICAgICAgICAg\nICByZXR1cm4gVHlwZXMuTE9OR1ZBUkNIQVI7CiAgICAgICAgcmV0dXJuIHN1\ncGVyLmdldFByZWZlcnJlZFR5cGUodHlwZSk7CiAgICB9CiAgICAKICAgIC8q\nKgogICAgICogQXBwZW5kIFhNTCBjb21wYXJpc29uLgogICAgICogCiAgICAg\nKiBAcGFyYW0gYnVmIHRoZSBTUUwgYnVmZmVyIHRvIHdyaXRlIHRoZSBjb21w\nYXJpc29uCiAgICAgKiBAcGFyYW0gb3AgdGhlIGNvbXBhcmlzb24gb3BlcmF0\naW9uIHRvIHBlcmZvcm0KICAgICAqIEBwYXJhbSBsaHMgdGhlIGxlZnQgaGFu\nZCBzaWRlIG9mIHRoZSBjb21wYXJpc29uCiAgICAgKiBAcGFyYW0gcmhzIHRo\nZSByaWdodCBoYW5kIHNpZGUgb2YgdGhlIGNvbXBhcmlzb24KICAgICAqIEBw\nYXJhbSBsaHN4bWwgaW5kaWNhdGVzIHdoZXRoZXIgdGhlIGxlZnQgb3BlcmFu\nZCBtYXBzIHRvIFhNTAogICAgICogQHBhcmFtIHJoc3htbCBpbmRpY2F0ZXMg\nd2hldGhlciB0aGUgcmlnaHQgb3BlcmFuZCBtYXBzIHRvIFhNTAogICAgICov\nCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyB2b2lkIGFwcGVuZFhtbENvbXBh\ncmlzb24oU1FMQnVmZmVyIGJ1ZiwgU3RyaW5nIG9wLCBGaWx0ZXJWYWx1ZSBs\naHMsCiAgICAgICAgRmlsdGVyVmFsdWUgcmhzLCBib29sZWFuIGxoc3htbCwg\nYm9vbGVhbiByaHN4bWwpIHsKICAgICAgICBzdXBlci5hcHBlbmRYbWxDb21w\nYXJpc29uKGJ1Ziwgb3AsIGxocywgcmhzLCBsaHN4bWwsIHJoc3htbCk7CiAg\nICAgICAgaWYgKGxoc3htbCkKICAgICAgICAgICAgYXBwZW5kWG1sVmFsdWUo\nYnVmLCBsaHMpOwogICAgICAgIGVsc2UKICAgICAgICAgICAgbGhzLmFwcGVu\nZFRvKGJ1Zik7CiAgICAgICAgYnVmLmFwcGVuZCgiICIpLmFwcGVuZChvcCku\nYXBwZW5kKCIgIik7CiAgICAgICAgaWYgKHJoc3htbCkKICAgICAgICAgICAg\nYXBwZW5kWG1sVmFsdWUoYnVmLCByaHMpOwogICAgICAgIGVsc2UKICAgICAg\nICAgICAgcmhzLmFwcGVuZFRvKGJ1Zik7CiAgICB9CiAgICAKICAgIC8qKgog\nICAgICogQXBwZW5kIFhNTCBjb2x1bW4gdmFsdWUgc28gdGhhdCBpdCBjYW4g\nYmUgdXNlZCBpbiBjb21wYXJpc29ucy4KICAgICAqIAogICAgICogQHBhcmFt\nIGJ1ZiB0aGUgU1FMIGJ1ZmZlciB0byB3cml0ZSB0aGUgdmFsdWUKICAgICAq\nIEBwYXJhbSB2YWwgdGhlIHZhbHVlIHRvIGJlIHdyaXR0ZW4KICAgICAqLwog\nICAgcHJpdmF0ZSB2b2lkIGFwcGVuZFhtbFZhbHVlKFNRTEJ1ZmZlciBidWYs\nIEZpbHRlclZhbHVlIHZhbCkgewogICAgICAgIGJ1Zi5hcHBlbmQoIkV4dHJh\nY3RWYWx1ZSgiKS4KICAgICAgICAgICAgYXBwZW5kKHZhbC5nZXRDb2x1bW5B\nbGlhcyh2YWwuZ2V0RmllbGRNYXBwaW5nKCkuZ2V0Q29sdW1ucygpWzBdKSku\nCiAgICAgICAgICAgIGFwcGVuZCgiLCcvKi8iKTsKICAgICAgICB2YWwuYXBw\nZW5kVG8oYnVmKTsKICAgICAgICBidWYuYXBwZW5kKCInKSIpOwogICAgfQog\nICAgCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyBpbnQgZ2V0QmF0Y2hGZXRj\naFNpemUoaW50IGJhdGNoRmV0Y2hTaXplKSB7CiAgICAgICAgcmV0dXJuIElu\ndGVnZXIuTUlOX1ZBTFVFOwogICAgfQoKICAgIC8qKgogICAgICogQ2hlY2sg\ndG8gc2VlIGlmIHdlIGhhdmUgc2V0IHRoZSB7QGxpbmsgI1NFTEVDVF9ISU5U\nfSBpbiB0aGUKICAgICAqIGZldGNoIGNvbmZpZ3VyYXRpb24sIGFuZCBpZiBz\nbywgYXBwZW5kIHRoZSBNeVNRTCBoaW50IGFmdGVyIHRoZQogICAgICogIlNF\nTEVDVCIgcGFydCBvZiB0aGUgcXVlcnkuCiAgICAgKi8KICAgIEBPdmVycmlk\nZQogICAgcHVibGljIFN0cmluZyBnZXRTZWxlY3RPcGVyYXRpb24oSkRCQ0Zl\ndGNoQ29uZmlndXJhdGlvbiBmZXRjaCkgewogICAgICAgIE9iamVjdCBoaW50\nID0gZmV0Y2ggPT0gbnVsbCA/IG51bGwgOiBmZXRjaC5nZXRIaW50KFNFTEVD\nVF9ISU5UKTsKICAgICAgICBTdHJpbmcgc2VsZWN0ID0gIlNFTEVDVCI7CiAg\nICAgICAgaWYgKGhpbnQgIT0gbnVsbCkKICAgICAgICAgICAgc2VsZWN0ICs9\nICIgIiArIGhpbnQ7CiAgICAgICAgcmV0dXJuIHNlbGVjdDsKICAgIH0KICAg\nIAogICAgQE92ZXJyaWRlCiAgICBwcm90ZWN0ZWQgQ29sbGVjdGlvbjxTdHJp\nbmc+IGdldFNlbGVjdFRhYmxlQWxpYXNlcyhTZWxlY3Qgc2VsKSB7CiAgICAg\nICAgU2V0PFN0cmluZz4gcmVzdWx0ID0gbmV3IEhhc2hTZXQ8U3RyaW5nPigp\nOwogICAgICAgIExpc3Q8U3RyaW5nPiBzZWxlY3RzID0gc2VsLmdldElkZW50\naWZpZXJBbGlhc2VzKCk7CiAgICAgICAgZm9yIChTdHJpbmcgcyA6IHNlbGVj\ndHMpIHsKICAgICAgICAgICAgU3RyaW5nIHRhYmxlQWxpYXMgPSBzLnN1YnN0\ncmluZygwLCBzLmluZGV4T2YoJy4nKSk7CiAgICAgICAgICAgIHJlc3VsdC5h\nZGQodGFibGVBbGlhcyk7CiAgICAgICAgfQogICAgICAgIHJldHVybiByZXN1\nbHQ7CiAgICB9Cn0K\n","encoding":"base64"}

