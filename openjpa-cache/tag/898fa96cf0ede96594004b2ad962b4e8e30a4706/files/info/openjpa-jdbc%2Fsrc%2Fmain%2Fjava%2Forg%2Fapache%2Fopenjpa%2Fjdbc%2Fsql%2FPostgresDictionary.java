{"sha":"a3cd9394185f51cc38070acf964926ba5ae85829","node_id":"MDQ6QmxvYjIwNjM2NDphM2NkOTM5NDE4NWY1MWNjMzgwNzBhY2Y5NjQ5MjZiYTVhZTg1ODI5","size":32840,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/a3cd9394185f51cc38070acf964926ba5ae85829","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zcWw7CgppbXBvcnQg\namF2YS5pby5JT0V4Y2VwdGlvbjsKaW1wb3J0IGphdmEuaW8uSW5wdXRTdHJl\nYW07CmltcG9ydCBqYXZhLmlvLk91dHB1dFN0cmVhbTsKaW1wb3J0IGphdmEu\nbGFuZy5yZWZsZWN0LkNvbnN0cnVjdG9yOwppbXBvcnQgamF2YS5sYW5nLnJl\nZmxlY3QuSW52b2NhdGlvblRhcmdldEV4Y2VwdGlvbjsKaW1wb3J0IGphdmEu\nbGFuZy5yZWZsZWN0Lk1ldGhvZDsKaW1wb3J0IGphdmEuc2VjdXJpdHkuQWNj\nZXNzQ29udHJvbGxlcjsKaW1wb3J0IGphdmEuc3FsLkNvbm5lY3Rpb247Cmlt\ncG9ydCBqYXZhLnNxbC5EYXRhYmFzZU1ldGFEYXRhOwppbXBvcnQgamF2YS5z\ncWwuUHJlcGFyZWRTdGF0ZW1lbnQ7CmltcG9ydCBqYXZhLnNxbC5SZXN1bHRT\nZXQ7CmltcG9ydCBqYXZhLnNxbC5TUUxFeGNlcHRpb247CmltcG9ydCBqYXZh\nLnNxbC5TdGF0ZW1lbnQ7CmltcG9ydCBqYXZhLnNxbC5UeXBlczsKaW1wb3J0\nIGphdmEudGV4dC5QYXJzZUV4Y2VwdGlvbjsKaW1wb3J0IGphdmEudGV4dC5T\naW1wbGVEYXRlRm9ybWF0OwppbXBvcnQgamF2YS51dGlsLkFycmF5czsKaW1w\nb3J0IGphdmEudXRpbC5EYXRlOwppbXBvcnQgamF2YS51dGlsLk1hcDsKCmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5pZGVudGlmaWVyLkRCSWRl\nbnRpZmllcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLmtlcm5l\nbC5KREJDRmV0Y2hDb25maWd1cmF0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLmpkYmMua2VybmVsLkpEQkNTdG9yZTsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5qZGJjLmtlcm5lbC5leHBzLkZpbHRlclZhbHVlOwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1hLkNvbHVtbjsKaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNjaGVtYS5TZXF1ZW5jZTsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNjaGVtYS5UYWJsZTsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuRmlsdGVyczsKaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIuamRiYy5EZWxlZ2F0aW5nQ29u\nbmVjdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIuamRiYy5E\nZWxlZ2F0aW5nUHJlcGFyZWRTdGF0ZW1lbnQ7CmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEubGliLnV0aWwuQ29uY3JldGVDbGFzc0dlbmVyYXRvcjsKaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIudXRpbC5KMkRvUHJpdkhlbHBl\ncjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIudXRpbC5Mb2NhbGl6\nZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YS5KYXZhVHlwZXM7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5JbnRlcm5hbEV4Y2Vw\ndGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLlN0b3JlRXhj\nZXB0aW9uOwppbXBvcnQgb3JnLnBvc3RncmVzcWwuUEdDb25uZWN0aW9uOwpp\nbXBvcnQgb3JnLnBvc3RncmVzcWwubGFyZ2VvYmplY3QuTGFyZ2VPYmplY3Q7\nCmltcG9ydCBvcmcucG9zdGdyZXNxbC5sYXJnZW9iamVjdC5MYXJnZU9iamVj\ndE1hbmFnZXI7CgovKioKICogRGljdGlvbmFyeSBmb3IgUG9zdGdyZVNRTC4K\nICovCnB1YmxpYyBjbGFzcyBQb3N0Z3Jlc0RpY3Rpb25hcnkKICAgIGV4dGVu\nZHMgREJEaWN0aW9uYXJ5IHsKCiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBM\nb2NhbGl6ZXIgX2xvYyA9IExvY2FsaXplci5mb3JQYWNrYWdlCiAgICAgICAg\nKFBvc3RncmVzRGljdGlvbmFyeS5jbGFzcyk7CgogICAgcHJpdmF0ZSBzdGF0\naWMgQ29uc3RydWN0b3I8UG9zdGdyZXNDb25uZWN0aW9uPiBwb3N0Z3Jlc0Nv\nbm5lY3Rpb25JbXBsOwogICAgcHJpdmF0ZSBzdGF0aWMgQ29uc3RydWN0b3I8\nUG9zdGdyZXNQcmVwYXJlZFN0YXRlbWVudD4gcG9zdGdyZXNQcmVwYXJlZFN0\nYXRlbWVudEltcGw7CgogICAgcHJpdmF0ZSBNZXRob2QgZGJjcEdldERlbGVn\nYXRlOwogICAgcHJpdmF0ZSBNZXRob2QgY29ubmVjdGlvblVud3JhcDsKCiAg\nICBzdGF0aWMgewogICAgICAgIHRyeSB7CiAgICAgICAgICAgIHBvc3RncmVz\nQ29ubmVjdGlvbkltcGwgPSBDb25jcmV0ZUNsYXNzR2VuZXJhdG9yLmdldENv\nbmNyZXRlQ29uc3RydWN0b3IoCiAgICAgICAgICAgICAgICAgICAgUG9zdGdy\nZXNDb25uZWN0aW9uLmNsYXNzLAogICAgICAgICAgICAgICAgICAgIENvbm5l\nY3Rpb24uY2xhc3MsIAogICAgICAgICAgICAgICAgICAgIFBvc3RncmVzRGlj\ndGlvbmFyeS5jbGFzcyk7CiAgICAgICAgICAgIHBvc3RncmVzUHJlcGFyZWRT\ndGF0ZW1lbnRJbXBsID0gQ29uY3JldGVDbGFzc0dlbmVyYXRvci5nZXRDb25j\ncmV0ZUNvbnN0cnVjdG9yKAogICAgICAgICAgICAgICAgICAgIFBvc3RncmVz\nUHJlcGFyZWRTdGF0ZW1lbnQuY2xhc3MsCiAgICAgICAgICAgICAgICAgICAg\nUHJlcGFyZWRTdGF0ZW1lbnQuY2xhc3MsIAogICAgICAgICAgICAgICAgICAg\nIENvbm5lY3Rpb24uY2xhc3MsIAogICAgICAgICAgICAgICAgICAgIFBvc3Rn\ncmVzRGljdGlvbmFyeS5jbGFzcyk7CiAgICAgICAgfSBjYXRjaCAoRXhjZXB0\naW9uIGUpIHsKICAgICAgICAgICAgdGhyb3cgbmV3IEV4Y2VwdGlvbkluSW5p\ndGlhbGl6ZXJFcnJvcihlKTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAg\nICAgKiBTUUwgc3RhdGVtZW50IHRvIGxvYWQgYWxsIHNlcXVlbmNlIHNjaGVt\nYSxuYW1lIHBhaXJzIGZyb20gYWxsIHNjaGVtYXMuCiAgICAgKi8KICAgIHB1\nYmxpYyBTdHJpbmcgYWxsU2VxdWVuY2VzU1FMID0gIlNFTEVDVCBOVUxMIEFT\nIFNFUVVFTkNFX1NDSEVNQSwgcmVsbmFtZSAiICsKICAgICAgICAiQVMgU0VR\nVUVOQ0VfTkFNRSBGUk9NIHBnX2NsYXNzIFdIRVJFIHJlbGtpbmQ9J1MnIjsK\nCiAgICAvKioKICAgICAqIFNRTCBzdGF0ZW1lbnQgdG8gbG9hZCBzY2hlbWEs\nbmFtZSBwYWlycyBmb3IgYWxsIHNlcXVlbmNlcyB3aXRoIGEKICAgICAqIGNl\ncnRhaW4gbmFtZSBmcm9tIGFsbCBzY2hlbWFzLgogICAgICovCiAgICBwdWJs\naWMgU3RyaW5nIG5hbWVkU2VxdWVuY2VzRnJvbUFsbFNjaGVtYXNTUUwgPSAi\nU0VMRUNUIE5VTEwgQVMgIiArCiAgICAgICAgIlNFUVVFTkNFX1NDSEVNQSwg\ncmVsbmFtZSBBUyBTRVFVRU5DRV9OQU1FIEZST00gcGdfY2xhc3MgIiArCiAg\nICAgICAgIldIRVJFIHJlbGtpbmQ9J1MnIEFORCByZWxuYW1lID0gPyI7Cgog\nICAgLyoqCiAgICAgKiBTUUwgc3RhdGVtZW50IHRvIGxvYWQgc2NoZW1hLG5h\nbWUgcGFpcnMgZnJvbSBhIG5hbWVkIHNjaGVtYS4KICAgICAqLwogICAgcHVi\nbGljIFN0cmluZyBhbGxTZXF1ZW5jZXNGcm9tT25lU2NoZW1hU1FMID0gIlNF\nTEVDVCBOVUxMIEFTICIgKwogICAgICAgICJTRVFVRU5DRV9TQ0hFTUEsIHJl\nbG5hbWUgQVMgU0VRVUVOQ0VfTkFNRSBGUk9NIHBnX2NsYXNzLCAiICsKICAg\nICAgICAicGdfbmFtZXNwYWNlIFdIRVJFIHJlbGtpbmQ9J1MnIEFORCBwZ19j\nbGFzcy5yZWxuYW1lc3BhY2UgPSAiICsKICAgICAgICAicGdfbmFtZXNwYWNl\nLm9pZCBBTkQgbnNwbmFtZSA9ID8iOwoKICAgIC8qKgogICAgICogU1FMIHN0\nYXRlbWVudCB0byBsb2FkIGEgc2VxdWVuY2UncyBzY2hlbWEsbmFtZSBwYWly\nIGZyb20gb25lIHNjaGVtYS4KICAgICAqLwogICAgcHVibGljIFN0cmluZyBu\nYW1lZFNlcXVlbmNlRnJvbU9uZVNjaGVtYVNRTCA9ICJTRUxFQ1QgTlVMTCBB\nUyAiICsKICAgICAgICAiU0VRVUVOQ0VfU0NIRU1BLCByZWxuYW1lIEFTIFNF\nUVVFTkNFX05BTUUgRlJPTSBwZ19jbGFzcywgIiArCiAgICAgICAgInBnX25h\nbWVzcGFjZSBXSEVSRSByZWxraW5kPSdTJyBBTkQgcGdfY2xhc3MucmVsbmFt\nZXNwYWNlID0gIiArCiAgICAgICAgInBnX25hbWVzcGFjZS5vaWQgQU5EIHJl\nbG5hbWUgPSA/IEFORCBuc3BuYW1lID0gPyI7CgogICAgLyoqCiAgICAgKiBT\nb21lIFBvc3RncmVzIGRyaXZlcnMgZG8gbm90IHN1cHBvcnQgdGhlIHtAbGlu\nayBTdGF0ZW1lbnQjc2V0RmV0Y2hTaXplfQogICAgICogbWV0aG9kLgogICAg\nICovCiAgICBwdWJsaWMgYm9vbGVhbiBzdXBwb3J0c1NldEZldGNoU2l6ZSA9\nIHRydWU7CgogICAgcHVibGljIFBvc3RncmVzRGljdGlvbmFyeSgpIHsKICAg\nICAgICBwbGF0Zm9ybSA9ICJQb3N0Z3JlU1FMIjsKICAgICAgICB2YWxpZGF0\naW9uU1FMID0gIlNFTEVDVCBOT1coKSI7CiAgICAgICAgZGF0ZVByZWNpc2lv\nbiA9IENFTlRJOwogICAgICAgIHN1cHBvcnRzQWx0ZXJUYWJsZVdpdGhEcm9w\nQ29sdW1uID0gZmFsc2U7CiAgICAgICAgc3VwcG9ydHNEZWZlcnJlZENvbnN0\ncmFpbnRzID0gdHJ1ZTsKICAgICAgICBzdXBwb3J0c1NlbGVjdFN0YXJ0SW5k\nZXggPSB0cnVlOwogICAgICAgIHN1cHBvcnRzU2VsZWN0RW5kSW5kZXggPSB0\ncnVlOwoKICAgICAgICAvLyBQb3N0Z3JlU1FMIHJlcXVpcmVzIGRvdWJsZS1l\nc2NhcGUgZm9yIHN0cmluZ3MKICAgICAgICBzZWFyY2hTdHJpbmdFc2NhcGUg\nPSAiXFxcXCI7CgogICAgICAgIG1heFRhYmxlTmFtZUxlbmd0aCA9IDYzOwog\nICAgICAgIG1heENvbHVtbk5hbWVMZW5ndGggPSA2MzsKICAgICAgICBtYXhJ\nbmRleE5hbWVMZW5ndGggPSA2MzsKICAgICAgICBtYXhDb25zdHJhaW50TmFt\nZUxlbmd0aCA9IDYzOwogICAgICAgIG1heEF1dG9Bc3NpZ25OYW1lTGVuZ3Ro\nID0gNjM7CiAgICAgICAgc2NoZW1hQ2FzZSA9IFNDSEVNQV9DQVNFX0xPV0VS\nOwogICAgICAgIHJhbmdlUG9zaXRpb24gPSBSQU5HRV9QT1NUX0xPQ0s7CiAg\nICAgICAgcmVxdWlyZXNBbGlhc0ZvclN1YnNlbGVjdCA9IHRydWU7CiAgICAg\nICAgYWxsb3dzQWxpYXNJbkJ1bGtDbGF1c2UgPSBmYWxzZTsKCiAgICAgICAg\nLy8gc2luZ2xlLXF1b3RlIGVzY2FwZSB3aWxsIHJlc3VsdCBpbiBTRUxFQ1Qg\nQ1VSVkFMKCdteXNlcXVlbmNlJykKICAgICAgICBsYXN0R2VuZXJhdGVkS2V5\nUXVlcnkgPSAiU0VMRUNUIENVUlJWQUwoJyd7MX1fezB9X3NlcScnKSI7CiAg\nICAgICAgc3VwcG9ydHNBdXRvQXNzaWduID0gdHJ1ZTsKICAgICAgICBhdXRv\nQXNzaWduVHlwZU5hbWUgPSAiQklHU0VSSUFMIjsKICAgICAgICBuZXh0U2Vx\ndWVuY2VRdWVyeSA9ICJTRUxFQ1QgTkVYVFZBTCgnJ3swfScnKSI7CgogICAg\nICAgIHVzZUdldEJ5dGVzRm9yQmxvYnMgPSB0cnVlOwogICAgICAgIHVzZVNl\ndEJ5dGVzRm9yQmxvYnMgPSB0cnVlOwogICAgICAgIHVzZUdldFN0cmluZ0Zv\nckNsb2JzID0gdHJ1ZTsKICAgICAgICB1c2VTZXRTdHJpbmdGb3JDbG9icyA9\nIHRydWU7CiAgICAgICAgYml0VHlwZU5hbWUgPSAiQk9PTCI7CiAgICAgICAg\nc21hbGxpbnRUeXBlTmFtZSA9ICJTTUFMTElOVCI7CiAgICAgICAgcmVhbFR5\ncGVOYW1lID0gIkZMT0FUOCI7CiAgICAgICAgdGlueWludFR5cGVOYW1lID0g\nIlNNQUxMSU5UIjsKICAgICAgICBiaW5hcnlUeXBlTmFtZSA9ICJCWVRFQSI7\nCiAgICAgICAgYmxvYlR5cGVOYW1lID0gIkJZVEVBIjsKICAgICAgICBsb25n\nVmFyYmluYXJ5VHlwZU5hbWUgPSAiQllURUEiOwogICAgICAgIHZhcmJpbmFy\neVR5cGVOYW1lID0gIkJZVEVBIjsKICAgICAgICBjbG9iVHlwZU5hbWUgPSAi\nVEVYVCI7CiAgICAgICAgbG9uZ1ZhcmNoYXJUeXBlTmFtZSA9ICJURVhUIjsK\nICAgICAgICBkb3VibGVUeXBlTmFtZSA9ICJET1VCTEUgUFJFQ0lTSU9OIjsK\nICAgICAgICB0aW1lc3RhbXBUeXBlTmFtZSA9ICJBQlNUSU1FIjsKICAgICAg\nICBmaXhlZFNpemVUeXBlTmFtZVNldC5hZGRBbGwoQXJyYXlzLmFzTGlzdChu\nZXcgU3RyaW5nW117CiAgICAgICAgICAgICJCT09MIiwgIkJZVEVBIiwgIk5B\nTUUiLCAiSU5UOCIsICJJTlQyIiwgIklOVDJWRUNUT1IiLCAiSU5UNCIsCiAg\nICAgICAgICAgICJSRUdQUk9DIiwgIlRFWFQiLCAiT0lEIiwgIlRJRCIsICJY\nSUQiLCAiQ0lEIiwgIk9JRFZFQ1RPUiIsCiAgICAgICAgICAgICJTRVQiLCAi\nRkxPQVQ0IiwgIkZMT0FUOCIsICJBQlNUSU1FIiwgIlJFTFRJTUUiLCAiVElO\nVEVSVkFMIiwKICAgICAgICAgICAgIk1PTkVZIiwKICAgICAgICB9KSk7Cgog\nICAgICAgIHN1cHBvcnRzTG9ja2luZ1dpdGhEaXN0aW5jdENsYXVzZSA9IGZh\nbHNlOwogICAgICAgIHN1cHBvcnRzUXVlcnlUaW1lb3V0ID0gZmFsc2U7CiAg\nICAgICAgc3VwcG9ydHNMb2NraW5nV2l0aE91dGVySm9pbiA9IGZhbHNlOwog\nICAgICAgIHN1cHBvcnRzTnVsbFRhYmxlRm9yR2V0SW1wb3J0ZWRLZXlzID0g\ndHJ1ZTsKCiAgICAgICAgcmVzZXJ2ZWRXb3JkU2V0LmFkZEFsbChBcnJheXMu\nYXNMaXN0KG5ldyBTdHJpbmdbXXsKICAgICAgICAgICAgIkFCT1JUIiwgIkFD\nTCIsICJBR0dSRUdBVEUiLCAiQVBQRU5EIiwgIkFSQ0hJVkUiLCAiQVJDSF9T\nVE9SRSIsCiAgICAgICAgICAgICJCQUNLV0FSRCIsICJCSU5BUlkiLCAiQ0hB\nTkdFIiwgIkNMVVNURVIiLCAiQ09QWSIsICJEQVRBQkFTRSIsCiAgICAgICAg\nICAgICJERUxJTUlURVIiLCAiREVMSU1JVEVSUyIsICJETyIsICJFWFBMQUlO\nIiwgIkVYVEVORCIsCiAgICAgICAgICAgICJGT1JXQVJEIiwgIkhFQVZZIiwg\nIklOREVYIiwgIklOSEVSSVRTIiwgIklTTlVMTCIsICJMSUdIVCIsCiAgICAg\nICAgICAgICJMSVNURU4iLCAiTE9BRCIsICJNRVJHRSIsICJOT1RISU5HIiwg\nIk5PVElGWSIsICJOT1ROVUxMIiwKICAgICAgICAgICAgIk9JRCIsICJPSURT\nIiwgIlBVUkdFIiwgIlJFQ0lQRSIsICJSRU5BTUUiLCAiUkVQTEFDRSIsCiAg\nICAgICAgICAgICJSRVRSSUVWRSIsICJSRVRVUk5TIiwgIlJVTEUiLCAiU0VU\nT0YiLCAiU1RESU4iLCAiU1RET1VUIiwKICAgICAgICAgICAgIlNUT1JFIiwg\nIlZBQ1VVTSIsICJWRVJCT1NFIiwgIlZFUlNJT04iLAogICAgICAgIH0pKTsK\nCiAgICAgICAgLy8gcmVzZXJ2ZWRXb3JkU2V0IHN1YnNldCB0aGF0IENBTk5P\nVCBiZSB1c2VkIGFzIHZhbGlkIGNvbHVtbiBuYW1lcwogICAgICAgIC8vIChp\nLmUuLCB3aXRob3V0IHN1cnJvdW5kaW5nIHRoZW0gd2l0aCBkb3VibGUtcXVv\ndGVzKQogICAgICAgIGludmFsaWRDb2x1bW5Xb3JkU2V0LmFkZEFsbChBcnJh\neXMuYXNMaXN0KG5ldyBTdHJpbmdbXSB7CiAgICAgICAgICAgICJBTEwiLCAi\nQU5EIiwgIkFOWSIsICJBUyIsICJBU0MiLCAiQVVUSE9SSVpBVElPTiIsICJC\nRVRXRUVOIiwgCiAgICAgICAgICAgICJCSU5BUlkiLCAiQk9USCIsICJDQVNF\nIiwgIkNBU1QiLCAiQ0hFQ0siLCAiQ09MTEFURSIsICJDT0xVTU4iLAogICAg\nICAgICAgICAiQ09OU1RSQUlOVCIsICJDUkVBVEUiLCAiQ1JPU1MiLCAiQ1VS\nUkVOVF9EQVRFIiwgIkNVUlJFTlRfVElNRSIsCiAgICAgICAgICAgICJDVVJS\nRU5UX1RJTUVTVEFNUCIsICJDVVJSRU5UX1VTRVIiLCAiREVGQVVMVCIsICJE\nRUZFUlJBQkxFIiwgCiAgICAgICAgICAgICJERVNDIiwgIkRJU1RJTkNUIiwg\nIkRPIiwgIkVMU0UiLCAiRU5EIiwgIkVORCIsICJFWENFUFQiLCAiRkFMU0Ui\nLAogICAgICAgICAgICAiRk9SIiwgIkZPUkVJR04iLCAiRlJPTSIsICJGVUxM\nIiwgIkdSQU5UIiwgIkdST1VQIiwgIkhBVklORyIsICJJTiIsCiAgICAgICAg\nICAgICJJTklUSUFMTFkiLCAiSU5ORVIiLCAiSU5URVJTRUNUIiwgIklOVE8i\nLCAiSVMiLCAiSVNOVUxMIiwgIkpPSU4iLAogICAgICAgICAgICAiTEVBRElO\nRyIsICJMRUZUIiwgIkxJS0UiLCAiTkFUVVJBTCIsICJOT1QiLCAiTk9UTlVM\nTCIsICJOVUxMIiwgCiAgICAgICAgICAgICJPTiIsICJPTkxZIiwgIk9SIiwg\nIk9SREVSIiwgIk9VVEVSIiwgIk9WRVJMQVBTIiwgIlBSSU1BUlkiLAogICAg\nICAgICAgICAiUkVGRVJFTkNFUyIsICJSSUdIVCIsICJTRUxFQ1QiLCAiU0VT\nU0lPTl9VU0VSIiwgIlNPTUUiLCAiVEFCTEUiLAogICAgICAgICAgICAiVEhF\nTiIsICJUTyIsICJUUkFJTElORyIsICJUUlVFIiwgIlVOSU9OIiwgIlVOSVFV\nRSIsICJVU0VSIiwgCiAgICAgICAgICAgICJVU0lORyIsICJWRVJCT1NFIiwg\nIldIRU4iLCAiV0hFUkUiLAogICAgICAgIH0pKTsKICAgIH0KCiAgICBAT3Zl\ncnJpZGUKICAgIHB1YmxpYyBEYXRlIGdldERhdGUoUmVzdWx0U2V0IHJzLCBp\nbnQgY29sdW1uKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAg\nICAgIHRyeSB7CiAgICAgICAgICAgIHJldHVybiBzdXBlci5nZXREYXRlKHJz\nLCBjb2x1bW4pOwogICAgICAgIH0gY2F0Y2ggKFN0cmluZ0luZGV4T3V0T2ZC\nb3VuZHNFeGNlcHRpb24gc2lvb2JlKSB7CiAgICAgICAgICAgIC8vIHRoZXJl\nIGlzIGEgYnVnIGluIHNvbWUgdmVyc2lvbnMgb2YgdGhlIHBvc3RncmVzIEpE\nQkMKICAgICAgICAgICAgLy8gZHJpdmVyIHN1Y2ggdGhhdCBhIGRhdGUgd2l0\naCBub3QgZW5vdWdoIG51bWJlcnMgaW4gaXQKICAgICAgICAgICAgLy8gd2ls\nbCB0aHJvdyBhIHBhcnNpbmcgZXhjZXB0aW9uOiB0aGlzIHRyaWVzIHRvIHdv\ncmsKICAgICAgICAgICAgLy8gYXJvdW5kIGl0LiBUaGUgYnVnIG9ubHkgb2Nj\ndXJzIHdoZW4gdGhlcmUgaXMgYSB0cmFpbGluZwogICAgICAgICAgICAvLyBt\naWxsaXNlY29uZCBtaXNzaW5nIGZyb20gdGhlIGVuZC4gRS5nLiwgd2hlbiB0\naGUgZGF0ZSBpcwogICAgICAgICAgICAvLyBsaWtlOgogICAgICAgICAgICAv\nLyAyMDY2LTEwLTE5IDIyOjA4OjMyLjgzCiAgICAgICAgICAgIC8vIHJhdGhl\nciB0aGFuIHdoYXQgdGhlIGRyaXZlciBleHBlY3RzOgogICAgICAgICAgICAv\nLyAyMDY2LTEwLTE5IDIyOjA4OjMyLjgzMAogICAgICAgICAgICBTdHJpbmcg\nZGF0ZVN0ciA9IHJzLmdldFN0cmluZyhjb2x1bW4pOwogICAgICAgICAgICBT\naW1wbGVEYXRlRm9ybWF0IGZtdCA9IG5ldyBTaW1wbGVEYXRlRm9ybWF0KAog\nICAgICAgICAgICAgICAgInl5eXktTU0tZGQgaGg6bW06c3MuU1MiKTsKICAg\nICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIHJldHVybiBmbXQucGFy\nc2UoZGF0ZVN0cik7CiAgICAgICAgICAgIH0gY2F0Y2ggKFBhcnNlRXhjZXB0\naW9uIHBlKSB7CiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgU1FMRXhjZXB0\naW9uKHBlLnRvU3RyaW5nKCkpOwogICAgICAgICAgICB9CiAgICAgICAgfQog\nICAgfQoKICAgIEBPdmVycmlkZQogICAgcHVibGljIGJ5dGUgZ2V0Qnl0ZShS\nZXN1bHRTZXQgcnMsIGludCBjb2x1bW4pCiAgICAgICAgdGhyb3dzIFNRTEV4\nY2VwdGlvbiB7CiAgICAgICAgLy8gcG9zdGdyZXMgZG9lcyBub3QgcGVyZm9y\nbSBhdXRvbWF0aWMgY29udmVyc2lvbnMsIHNvIGF0dGVtcHRpbmcgdG8KICAg\nICAgICAvLyBnZXQgYSB3aG9sZSBudW1iZXIgb3V0IG9mIGEgZGVjaW1hbCB3\naWxsIHRocm93IGFuIGV4Y2VwdGlvbi4KICAgICAgICAvLyBmYWxsIGJhY2sg\ndG8gcGVyZm9ybWluZyBtYW51YWwgY29udmVyc2lvbiBpZiB0aGUgaW5pdGlh\nbCBnZXQgZmFpbHMKICAgICAgICB0cnkgewogICAgICAgICAgICByZXR1cm4g\nc3VwZXIuZ2V0Qnl0ZShycywgY29sdW1uKTsKICAgICAgICB9IGNhdGNoIChT\nUUxFeGNlcHRpb24gc3FsZSkgewogICAgICAgICAgICByZXR1cm4gc3VwZXIu\nZ2V0QmlnRGVjaW1hbChycywgY29sdW1uKS5ieXRlVmFsdWUoKTsKICAgICAg\nICB9CiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgc2hvcnQgZ2V0\nU2hvcnQoUmVzdWx0U2V0IHJzLCBpbnQgY29sdW1uKQogICAgICAgIHRocm93\ncyBTUUxFeGNlcHRpb24gewogICAgICAgIC8vIHBvc3RncmVzIGRvZXMgbm90\nIHBlcmZvcm0gYXV0b21hdGljIGNvbnZlcnNpb25zLCBzbyBhdHRlbXB0aW5n\nIHRvCiAgICAgICAgLy8gZ2V0IGEgd2hvbGUgbnVtYmVyIG91dCBvZiBhIGRl\nY2ltYWwgd2lsbCB0aHJvdyBhbiBleGNlcHRpb24uCiAgICAgICAgLy8gZmFs\nbCBiYWNrIHRvIHBlcmZvcm1pbmcgbWFudWFsIGNvbnZlcnNpb24gaWYgdGhl\nIGluaXRpYWwgZ2V0IGZhaWxzCiAgICAgICAgdHJ5IHsKICAgICAgICAgICAg\ncmV0dXJuIHN1cGVyLmdldFNob3J0KHJzLCBjb2x1bW4pOwogICAgICAgIH0g\nY2F0Y2ggKFNRTEV4Y2VwdGlvbiBzcWxlKSB7CiAgICAgICAgICAgIHJldHVy\nbiBzdXBlci5nZXRCaWdEZWNpbWFsKHJzLCBjb2x1bW4pLnNob3J0VmFsdWUo\nKTsKICAgICAgICB9CiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMg\naW50IGdldEludChSZXN1bHRTZXQgcnMsIGludCBjb2x1bW4pCiAgICAgICAg\ndGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgLy8gcG9zdGdyZXMgZG9l\ncyBub3QgcGVyZm9ybSBhdXRvbWF0aWMgY29udmVyc2lvbnMsIHNvIGF0dGVt\ncHRpbmcgdG8KICAgICAgICAvLyBnZXQgYSB3aG9sZSBudW1iZXIgb3V0IG9m\nIGEgZGVjaW1hbCB3aWxsIHRocm93IGFuIGV4Y2VwdGlvbi4KICAgICAgICAv\nLyBmYWxsIGJhY2sgdG8gcGVyZm9ybWluZyBtYW51YWwgY29udmVyc2lvbiBp\nZiB0aGUgaW5pdGlhbCBnZXQgZmFpbHMKICAgICAgICB0cnkgewogICAgICAg\nICAgICByZXR1cm4gc3VwZXIuZ2V0SW50KHJzLCBjb2x1bW4pOwogICAgICAg\nIH0gY2F0Y2ggKFNRTEV4Y2VwdGlvbiBzcWxlKSB7CiAgICAgICAgICAgIHJl\ndHVybiBzdXBlci5nZXRCaWdEZWNpbWFsKHJzLCBjb2x1bW4pLmludFZhbHVl\nKCk7CiAgICAgICAgfQogICAgfQoKICAgIEBPdmVycmlkZQogICAgcHVibGlj\nIGxvbmcgZ2V0TG9uZyhSZXN1bHRTZXQgcnMsIGludCBjb2x1bW4pCiAgICAg\nICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgLy8gcG9zdGdyZXMg\nZG9lcyBub3QgcGVyZm9ybSBhdXRvbWF0aWMgY29udmVyc2lvbnMsIHNvIGF0\ndGVtcHRpbmcgdG8KICAgICAgICAvLyBnZXQgYSB3aG9sZSBudW1iZXIgb3V0\nIG9mIGEgZGVjaW1hbCB3aWxsIHRocm93IGFuIGV4Y2VwdGlvbi4KICAgICAg\nICAvLyBmYWxsIGJhY2sgdG8gcGVyZm9ybWluZyBtYW51YWwgY29udmVyc2lv\nbiBpZiB0aGUgaW5pdGlhbCBnZXQgZmFpbHMKICAgICAgICB0cnkgewogICAg\nICAgICAgICByZXR1cm4gc3VwZXIuZ2V0TG9uZyhycywgY29sdW1uKTsKICAg\nICAgICB9IGNhdGNoIChTUUxFeGNlcHRpb24gc3FsZSkgewogICAgICAgICAg\nICByZXR1cm4gc3VwZXIuZ2V0QmlnRGVjaW1hbChycywgY29sdW1uKS5sb25n\nVmFsdWUoKTsKICAgICAgICB9CiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBw\ndWJsaWMgdm9pZCBzZXRCb29sZWFuKFByZXBhcmVkU3RhdGVtZW50IHN0bW50\nLCBpbnQgaWR4LCBib29sZWFuIHZhbCwKICAgICAgICBDb2x1bW4gY29sKQog\nICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIC8vIHBvc3Rn\ncmVzIGFjdHVhbGx5IHJlcXVpcmVzIHRoYXQgYSBib29sZWFuIGJlIHNldDog\naXQgY2Fubm90CiAgICAgICAgLy8gaGFuZGxlIGEgbnVtZXJpYyBhcmd1bWVu\ndC4KICAgICAgICBzdG1udC5zZXRCb29sZWFuKGlkeCwgdmFsKTsKICAgIH0K\nCiAgICAvKioKICAgICAqIEhhbmRsZSBYTUwgYW5kIGJ5dGVhL29pZCBjb2x1\nbW5zIGluIGEgUG9zdGdyZVNRTCB3YXkuCiAgICAgKi8KICAgIEBPdmVycmlk\nZQogICAgcHVibGljIHZvaWQgc2V0TnVsbChQcmVwYXJlZFN0YXRlbWVudCBz\ndG1udCwgaW50IGlkeCwgaW50IGNvbFR5cGUsCiAgICAgICAgQ29sdW1uIGNv\nbCkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBpZiAo\nY29sICE9IG51bGwgJiYgY29sLmlzWE1MKCkpIHsKICAgICAgICAgICAgc3Rt\nbnQuc2V0TnVsbChpZHgsIFR5cGVzLk9USEVSKTsKICAgICAgICAgICAgcmV0\ndXJuOwogICAgICAgIH0KCiAgICAgICAgLy8gT1BFTkpQQS0zMDgKICAgICAg\nICBpZiAoY29sVHlwZSA9PSBUeXBlcy5CTE9CKQogICAgICAgICAgICBjb2xU\neXBlID0gVHlwZXMuQklOQVJZOwogICAgICAgIHN0bW50LnNldE51bGwoaWR4\nLCBjb2xUeXBlKTsKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHByb3RlY3Rl\nZCB2b2lkIGFwcGVuZFNlbGVjdFJhbmdlKFNRTEJ1ZmZlciBidWYsIGxvbmcg\nc3RhcnQsIGxvbmcgZW5kLAogICAgICAgIGJvb2xlYW4gc3Vic2VsZWN0KSB7\nCiAgICAgICAgaWYgKGVuZCAhPSBMb25nLk1BWF9WQUxVRSkKICAgICAgICAg\nICAgYnVmLmFwcGVuZCgiIExJTUlUICIpLmFwcGVuZFZhbHVlKGVuZCAtIHN0\nYXJ0KTsKICAgICAgICBpZiAoc3RhcnQgIT0gMCkKICAgICAgICAgICAgYnVm\nLmFwcGVuZCgiIE9GRlNFVCAiKS5hcHBlbmRWYWx1ZShzdGFydCk7CiAgICB9\nCgogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgdm9pZCBpbmRleE9mKFNRTEJ1\nZmZlciBidWYsIEZpbHRlclZhbHVlIHN0ciwgRmlsdGVyVmFsdWUgZmluZCwK\nICAgICAgICBGaWx0ZXJWYWx1ZSBzdGFydCkgewogICAgICAgIGJ1Zi5hcHBl\nbmQoIihQT1NJVElPTigiKTsKICAgICAgICBmaW5kLmFwcGVuZFRvKGJ1Zik7\nCiAgICAgICAgYnVmLmFwcGVuZCgiIElOICIpOwogICAgICAgIGlmIChzdGFy\ndCAhPSBudWxsKQogICAgICAgICAgICBzdWJzdHJpbmcoYnVmLCBzdHIsIHN0\nYXJ0LCBudWxsKTsKICAgICAgICBlbHNlCiAgICAgICAgICAgIHN0ci5hcHBl\nbmRUbyhidWYpOwogICAgICAgIGJ1Zi5hcHBlbmQoIikgLSAxIik7CiAgICAg\nICAgaWYgKHN0YXJ0ICE9IG51bGwpIHsKICAgICAgICAgICAgYnVmLmFwcGVu\nZCgiICsgIik7CiAgICAgICAgICAgIHN0YXJ0LmFwcGVuZFRvKGJ1Zik7CiAg\nICAgICAgfQogICAgICAgIGJ1Zi5hcHBlbmQoIikiKTsKICAgIH0KCiAgICBA\nT3ZlcnJpZGUKICAgIHB1YmxpYyBTdHJpbmdbXSBnZXRDcmVhdGVTZXF1ZW5j\nZVNRTChTZXF1ZW5jZSBzZXEpIHsKICAgICAgICBTdHJpbmdbXSBzcWwgPSBz\ndXBlci5nZXRDcmVhdGVTZXF1ZW5jZVNRTChzZXEpOwogICAgICAgIGlmIChz\nZXEuZ2V0QWxsb2NhdGUoKSA+IDEpCiAgICAgICAgICAgIHNxbFswXSArPSAi\nIENBQ0hFICIgKyBzZXEuZ2V0QWxsb2NhdGUoKTsKICAgICAgICByZXR1cm4g\nc3FsOwogICAgfQoKICAgIEBPdmVycmlkZQogICAgcHJvdGVjdGVkIGJvb2xl\nYW4gc3VwcG9ydHNEZWZlcnJlZFVuaXF1ZUNvbnN0cmFpbnRzKCkgewogICAg\nICAgIC8vIFBvc3RncmVzIG9ubHkgc3VwcG9ydHMgZGVmZXJyZWQgZm9yZWln\nbiBrZXkgY29uc3RyYWludHMuCiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAg\nfQoKICAgIHByb3RlY3RlZCBTdHJpbmcgZ2V0U2VxdWVuY2VzU1FMKFN0cmlu\nZyBzY2hlbWFOYW1lLCBTdHJpbmcgc2VxdWVuY2VOYW1lKSB7CiAgICAgICAg\ncmV0dXJuIGdldFNlcXVlbmNlc1NRTChEQklkZW50aWZpZXIubmV3U2NoZW1h\nKHNjaGVtYU5hbWUpLCBEQklkZW50aWZpZXIubmV3U2VxdWVuY2Uoc2VxdWVu\nY2VOYW1lKSk7CiAgICB9CgogICAgcHJvdGVjdGVkIFN0cmluZyBnZXRTZXF1\nZW5jZXNTUUwoREJJZGVudGlmaWVyIHNjaGVtYU5hbWUsIERCSWRlbnRpZmll\nciBzZXF1ZW5jZU5hbWUpIHsKICAgICAgICBpZiAoREJJZGVudGlmaWVyLmlz\nTnVsbChzY2hlbWFOYW1lKSAmJiBEQklkZW50aWZpZXIuaXNOdWxsKHNlcXVl\nbmNlTmFtZSkpCiAgICAgICAgICAgIHJldHVybiBhbGxTZXF1ZW5jZXNTUUw7\nCiAgICAgICAgZWxzZSBpZiAoREJJZGVudGlmaWVyLmlzTnVsbChzY2hlbWFO\nYW1lKSkKICAgICAgICAgICAgcmV0dXJuIG5hbWVkU2VxdWVuY2VzRnJvbUFs\nbFNjaGVtYXNTUUw7CiAgICAgICAgZWxzZSBpZiAoREJJZGVudGlmaWVyLmlz\nTnVsbChzZXF1ZW5jZU5hbWUpKQogICAgICAgICAgICByZXR1cm4gYWxsU2Vx\ndWVuY2VzRnJvbU9uZVNjaGVtYVNRTDsKICAgICAgICBlbHNlCiAgICAgICAg\nICAgIHJldHVybiBuYW1lZFNlcXVlbmNlRnJvbU9uZVNjaGVtYVNRTDsKICAg\nIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBpc1N5c3RlbVNlcXVlbmNlKFN0cmlu\nZyBuYW1lLCBTdHJpbmcgc2NoZW1hLAogICAgICAgIGJvb2xlYW4gdGFyZ2V0\nU2NoZW1hKSB7CiAgICAgICAgcmV0dXJuIGlzU3lzdGVtU2VxdWVuY2UoREJJ\nZGVudGlmaWVyLm5ld1RhYmxlKG5hbWUpLCBEQklkZW50aWZpZXIubmV3U2No\nZW1hKHNjaGVtYSksIHRhcmdldFNjaGVtYSk7CiAgICB9CgogICAgcHVibGlj\nIGJvb2xlYW4gaXNTeXN0ZW1TZXF1ZW5jZShEQklkZW50aWZpZXIgbmFtZSwg\nREJJZGVudGlmaWVyIHNjaGVtYSwKICAgICAgICBib29sZWFuIHRhcmdldFNj\naGVtYSkgewogICAgICAgIGlmIChzdXBlci5pc1N5c3RlbVNlcXVlbmNlKG5h\nbWUsIHNjaGVtYSwgdGFyZ2V0U2NoZW1hKSkKICAgICAgICAgICAgcmV0dXJu\nIHRydWU7CgogICAgICAgIC8vIGZpbHRlciBvdXQgZ2VuZXJhdGVkIHNlcXVl\nbmNlcyB1c2VkIGZvciBiaWdzZXJpYWwgY29scywgd2hpY2ggYXJlCiAgICAg\nICAgLy8gb2YgdGhlIGZvcm0gPHRhYmxlPl88Y29sPl9zZXEKICAgICAgICBT\ndHJpbmcgc3RyTmFtZSA9IERCSWRlbnRpZmllci5pc051bGwobmFtZSkgPyBu\ndWxsIDogbmFtZS5nZXROYW1lKCk7CiAgICAgICAgaW50IGlkeCA9IHN0ck5h\nbWUuaW5kZXhPZignXycpOwogICAgICAgIHJldHVybiBpZHggIT0gLTEgJiYg\naWR4ICE9IHN0ck5hbWUubGVuZ3RoKCkgLSA0CiAgICAgICAgICAgICYmIHN0\nck5hbWUudG9VcHBlckNhc2UoKS5lbmRzV2l0aCgiX1NFUSIpOwogICAgfQoK\nICAgIHB1YmxpYyBib29sZWFuIGlzU3lzdGVtVGFibGUoU3RyaW5nIG5hbWUs\nIFN0cmluZyBzY2hlbWEsCiAgICAgICAgYm9vbGVhbiB0YXJnZXRTY2hlbWEp\nIHsKICAgICAgICByZXR1cm4gaXNTeXN0ZW1UYWJsZShEQklkZW50aWZpZXIu\nbmV3VGFibGUobmFtZSksIERCSWRlbnRpZmllci5uZXdTY2hlbWEoc2NoZW1h\nKSwgdGFyZ2V0U2NoZW1hKTsKICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBp\nc1N5c3RlbVRhYmxlKERCSWRlbnRpZmllciBuYW1lLCBEQklkZW50aWZpZXIg\nc2NoZW1hLAogICAgICAgIGJvb2xlYW4gdGFyZ2V0U2NoZW1hKSB7CiAgICAg\nICAgLy8gbmFtZXMgc3RhcnRpbmcgd2l0aCAicGdfIiBhcmUgcmVzZXJ2ZWQg\nZm9yIFBvc3RncmVzcWwgaW50ZXJuYWwgdXNlCiAgICAgICAgU3RyaW5nIHN0\nck5hbWUgPSBEQklkZW50aWZpZXIuaXNOdWxsKG5hbWUpID8gbnVsbCA6IG5h\nbWUuZ2V0TmFtZSgpOwogICAgICAgIHJldHVybiBzdXBlci5pc1N5c3RlbVRh\nYmxlKG5hbWUsIHNjaGVtYSwgdGFyZ2V0U2NoZW1hKQogICAgICAgICAgICB8\nfCAoc3RyTmFtZSAhPSBudWxsICYmIHN0ck5hbWUudG9Mb3dlckNhc2UoKS5z\ndGFydHNXaXRoKCJwZ18iKSk7CiAgICB9CgogICAgcHVibGljIGJvb2xlYW4g\naXNTeXN0ZW1JbmRleChTdHJpbmcgbmFtZSwgVGFibGUgdGFibGUpIHsKICAg\nICAgICByZXR1cm4gaXNTeXN0ZW1JbmRleChEQklkZW50aWZpZXIubmV3SW5k\nZXgobmFtZSksIHRhYmxlKTsKICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBp\nc1N5c3RlbUluZGV4KERCSWRlbnRpZmllciBuYW1lLCBUYWJsZSB0YWJsZSkg\newogICAgICAgIC8vIG5hbWVzIHN0YXJ0aW5nIHdpdGggInBnXyIgYXJlIHJl\nc2VydmVkIGZvciBQb3N0Z3Jlc3FsIGludGVybmFsIHVzZQogICAgICAgIFN0\ncmluZyBzdHJOYW1lID0gREJJZGVudGlmaWVyLmlzTnVsbChuYW1lKSA/IG51\nbGwgOiBuYW1lLmdldE5hbWUoKTsKICAgICAgICByZXR1cm4gc3VwZXIuaXNT\neXN0ZW1JbmRleChuYW1lLCB0YWJsZSkKICAgICAgICAgICAgfHwgKHN0ck5h\nbWUgIT0gbnVsbCAmJiBzdHJOYW1lLnRvTG93ZXJDYXNlKCkuc3RhcnRzV2l0\naCgicGdfIikpOwogICAgfQoKICAgIHB1YmxpYyBDb25uZWN0aW9uIGRlY29y\nYXRlKENvbm5lY3Rpb24gY29ubikKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0\naW9uIHsKICAgICAgICByZXR1cm4gQ29uY3JldGVDbGFzc0dlbmVyYXRvci5u\nZXdJbnN0YW5jZShwb3N0Z3Jlc0Nvbm5lY3Rpb25JbXBsLCBzdXBlci5kZWNv\ncmF0ZShjb25uKSwgdGhpcyk7CiAgICB9CgogICAgcHVibGljIElucHV0U3Ry\nZWFtIGdldExPQlN0cmVhbShKREJDU3RvcmUgc3RvcmUsIFJlc3VsdFNldCBy\ncywKICAgICAgICBpbnQgY29sdW1uKSB0aHJvd3MgU1FMRXhjZXB0aW9uIHsK\nICAgICAgICBEZWxlZ2F0aW5nQ29ubmVjdGlvbiBjb25uID0gKERlbGVnYXRp\nbmdDb25uZWN0aW9uKXN0b3JlCiAgICAgICAgICAgIC5nZXRDb25uZWN0aW9u\nKCk7CiAgICAgICAgY29ubi5zZXRBdXRvQ29tbWl0KGZhbHNlKTsKICAgICAg\nICBMYXJnZU9iamVjdE1hbmFnZXIgbG9tID0gZ2V0TGFyZ2VPYmplY3RNYW5h\nZ2VyKGNvbm4pOwogICAgICAgIGlmIChycy5nZXRJbnQoY29sdW1uKSAhPSAt\nMSkgewogICAgICAgICAgICBMYXJnZU9iamVjdCBsbyA9IGxvbS5vcGVuKHJz\nLmdldEludChjb2x1bW4pKTsKICAgICAgICAgICAgcmV0dXJuIGxvLmdldElu\ncHV0U3RyZWFtKCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmV0\ndXJuIG51bGw7CiAgICAgICAgfQogICAgfQoKICAgIHB1YmxpYyB2b2lkIGlu\nc2VydEJsb2JGb3JTdHJlYW1pbmdMb2FkKFJvdyByb3csIENvbHVtbiBjb2ws\nIAogICAgICAgIEpEQkNTdG9yZSBzdG9yZSwgT2JqZWN0IG9iLCBTZWxlY3Qg\nc2VsKSB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBpZiAocm93Lmdl\ndEFjdGlvbigpID09IFJvdy5BQ1RJT05fSU5TRVJUKSB7CiAgICAgICAgICAg\nIGluc2VydFBvc3RncmVzQmxvYihyb3csIGNvbCwgc3RvcmUsIG9iKTsKICAg\nICAgICB9IGVsc2UgaWYgKHJvdy5nZXRBY3Rpb24oKSA9PSBSb3cuQUNUSU9O\nX1VQREFURSkgewogICAgICAgICAgICB1cGRhdGVQb3N0Z3Jlc0Jsb2Iocm93\nLCBjb2wsIHN0b3JlLCBvYiwgc2VsKTsKICAgICAgICB9CiAgICB9CgogICAg\ncHJpdmF0ZSB2b2lkIGluc2VydFBvc3RncmVzQmxvYihSb3cgcm93LCBDb2x1\nbW4gY29sLCBKREJDU3RvcmUgc3RvcmUsCiAgICAgICAgT2JqZWN0IG9iKSB0\naHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBpZiAob2IgIT0gbnVsbCkg\newogICAgICAgICAgICBjb2wuc2V0VHlwZShUeXBlcy5JTlRFR0VSKTsKICAg\nICAgICAgICAgRGVsZWdhdGluZ0Nvbm5lY3Rpb24gY29ubiA9IChEZWxlZ2F0\naW5nQ29ubmVjdGlvbilzdG9yZQogICAgICAgICAgICAuZ2V0Q29ubmVjdGlv\nbigpOwogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgY29ubi5z\nZXRBdXRvQ29tbWl0KGZhbHNlKTsKICAgICAgICAgICAgICAgIExhcmdlT2Jq\nZWN0TWFuYWdlciBsb20gPSBnZXRMYXJnZU9iamVjdE1hbmFnZXIoY29ubik7\nCiAgICAgICAgICAgICAgICAvLyBUaGUgY3JlYXRlIG1ldGhvZCBpcyB2YWxp\nZCBpbiB2ZXJzaW9ucyBwcmV2aW91cyB0byA4LjMKICAgICAgICAgICAgICAg\nIC8vIGluIDguMyB0aGlzIG1ldGhvZCBpcyBkZXByZWNhdGVkLCB1c2UgY3Jl\nYXRlTE8KICAgICAgICAgICAgICAgIGludCBvaWQgPSBsb20uY3JlYXRlKCk7\nCiAgICAgICAgICAgICAgICBMYXJnZU9iamVjdCBsbyA9IGxvbS5vcGVuKG9p\nZCwgTGFyZ2VPYmplY3RNYW5hZ2VyLldSSVRFKTsKICAgICAgICAgICAgICAg\nIE91dHB1dFN0cmVhbSBvcyA9IGxvLmdldE91dHB1dFN0cmVhbSgpOwogICAg\nICAgICAgICAgICAgY29weSgoSW5wdXRTdHJlYW0pb2IsIG9zKTsKICAgICAg\nICAgICAgICAgIGxvLmNsb3NlKCk7CiAgICAgICAgICAgICAgICByb3cuc2V0\nSW50KGNvbCwgb2lkKTsKICAgICAgICAgICAgfSBjYXRjaCAoSU9FeGNlcHRp\nb24gaW9lKSB7CiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgU3RvcmVFeGNl\ncHRpb24oaW9lKTsKICAgICAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAg\nICAgICAgIGNvbm4uY2xvc2UoKTsKICAgICAgICAgICAgfQogICAgICAgIH0g\nZWxzZSB7CiAgICAgICAgICAgIHJvdy5zZXRJbnQoY29sLCAtMSk7CiAgICAg\nICAgfQogICAgfQogICAgCiAgICBwcml2YXRlIHZvaWQgdXBkYXRlUG9zdGdy\nZXNCbG9iKFJvdyByb3csIENvbHVtbiBjb2wsIEpEQkNTdG9yZSBzdG9yZSwK\nICAgICAgICBPYmplY3Qgb2IsIFNlbGVjdCBzZWwpIHRocm93cyBTUUxFeGNl\ncHRpb24gewogICAgICAgIEpEQkNGZXRjaENvbmZpZ3VyYXRpb24gZmV0Y2gg\nPSBzdG9yZS5nZXRGZXRjaENvbmZpZ3VyYXRpb24oKTsKICAgICAgICBTUUxC\ndWZmZXIgc3FsID0gc2VsLnRvU2VsZWN0KHRydWUsIGZldGNoKTsKICAgICAg\nICBSZXN1bHRTZXQgcmVzID0gbnVsbDsKICAgICAgICBEZWxlZ2F0aW5nQ29u\nbmVjdGlvbiBjb25uID0gCiAgICAgICAgICAgIChEZWxlZ2F0aW5nQ29ubmVj\ndGlvbikgc3RvcmUuZ2V0Q29ubmVjdGlvbigpOwogICAgICAgIFByZXBhcmVk\nU3RhdGVtZW50IHN0bW50ID0gbnVsbDsKICAgICAgICB0cnkgewogICAgICAg\nICAgICBzdG1udCA9IHNxbC5wcmVwYXJlU3RhdGVtZW50KGNvbm4sIGZldGNo\nLAogICAgICAgICAgICAgICAgUmVzdWx0U2V0LlRZUEVfU0NST0xMX1NFTlNJ\nVElWRSwgUmVzdWx0U2V0LkNPTkNVUl9VUERBVEFCTEUpOwogICAgICAgICAg\nICBzZXRUaW1lb3V0cyhzdG1udCwgZmV0Y2gsIHRydWUpOwogICAgICAgICAg\nICByZXMgPSBzdG1udC5leGVjdXRlUXVlcnkoKTsKICAgICAgICAgICAgaWYg\nKCFyZXMubmV4dCgpKSB7CiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgSW50\nZXJuYWxFeGNlcHRpb24oX2xvYy5nZXQoInN0cmVhbS1leGNlcHRpb24iKSk7\nCiAgICAgICAgICAgIH0KICAgICAgICAgICAgaW50IG9pZCA9IHJlcy5nZXRJ\nbnQoMSk7CiAgICAgICAgICAgIGlmIChvaWQgIT0gLTEpIHsKICAgICAgICAg\nICAgICAgIGNvbm4uc2V0QXV0b0NvbW1pdChmYWxzZSk7CiAgICAgICAgICAg\nICAgICBMYXJnZU9iamVjdE1hbmFnZXIgbG9tID0gZ2V0TGFyZ2VPYmplY3RN\nYW5hZ2VyKGNvbm4pOwogICAgICAgICAgICAgICAgaWYgKG9iICE9IG51bGwp\nIHsKICAgICAgICAgICAgICAgICAgICBMYXJnZU9iamVjdCBsbyA9IGxvbS5v\ncGVuKG9pZCwgTGFyZ2VPYmplY3RNYW5hZ2VyLldSSVRFKTsKICAgICAgICAg\nICAgICAgICAgICBPdXRwdXRTdHJlYW0gb3MgPSBsby5nZXRPdXRwdXRTdHJl\nYW0oKTsKICAgICAgICAgICAgICAgICAgICBsb25nIHNpemUgPSBjb3B5KChJ\nbnB1dFN0cmVhbSkgb2IsIG9zKTsKICAgICAgICAgICAgICAgICAgICBsby50\ncnVuY2F0ZSgoaW50KSBzaXplKTsKICAgICAgICAgICAgICAgICAgICBsby5j\nbG9zZSgpOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAg\nICAgICAgICBsb20uZGVsZXRlKG9pZCk7CiAgICAgICAgICAgICAgICAgICAg\ncm93LnNldEludChjb2wsIC0xKTsKICAgICAgICAgICAgICAgIH0KICAgICAg\nICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGlmIChvYiAhPSBudWxs\nKSB7CiAgICAgICAgICAgICAgICAgICAgY29ubi5zZXRBdXRvQ29tbWl0KGZh\nbHNlKTsKICAgICAgICAgICAgICAgICAgICBMYXJnZU9iamVjdE1hbmFnZXIg\nbG9tID0gZ2V0TGFyZ2VPYmplY3RNYW5hZ2VyKGNvbm4pOwogICAgICAgICAg\nICAgICAgICAgIG9pZCA9IGxvbS5jcmVhdGUoKTsKICAgICAgICAgICAgICAg\nICAgICBMYXJnZU9iamVjdCBsbyA9IGxvbS5vcGVuKG9pZCwgTGFyZ2VPYmpl\nY3RNYW5hZ2VyLldSSVRFKTsKICAgICAgICAgICAgICAgICAgICBPdXRwdXRT\ndHJlYW0gb3MgPSBsby5nZXRPdXRwdXRTdHJlYW0oKTsKICAgICAgICAgICAg\nICAgICAgICBjb3B5KChJbnB1dFN0cmVhbSlvYiwgb3MpOwogICAgICAgICAg\nICAgICAgICAgIGxvLmNsb3NlKCk7CiAgICAgICAgICAgICAgICAgICAgcm93\nLnNldEludChjb2wsIG9pZCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAg\nICAgIH0KCiAgICAgICAgfSBjYXRjaCAoSU9FeGNlcHRpb24gaW9lKSB7CiAg\nICAgICAgICAgIHRocm93IG5ldyBTdG9yZUV4Y2VwdGlvbihpb2UpOwogICAg\nICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgIGlmIChyZXMgIT0gbnVsbCkK\nICAgICAgICAgICAgICAgIHRyeSB7IHJlcy5jbG9zZSAoKTsgfSBjYXRjaCAo\nU1FMRXhjZXB0aW9uIGUpIHt9CiAgICAgICAgICAgIGlmIChzdG1udCAhPSBu\ndWxsKQogICAgICAgICAgICAgICAgdHJ5IHsgc3RtbnQuY2xvc2UgKCk7IH0g\nY2F0Y2ggKFNRTEV4Y2VwdGlvbiBlKSB7fQogICAgICAgICAgICBpZiAoY29u\nbiAhPSBudWxsKQogICAgICAgICAgICAgICAgdHJ5IHsgY29ubi5jbG9zZSAo\nKTsgfSBjYXRjaCAoU1FMRXhjZXB0aW9uIGUpIHt9CiAgICAgICAgfQoKICAg\nIH0KICAgIAogICAgcHVibGljIHZvaWQgdXBkYXRlQmxvYihTZWxlY3Qgc2Vs\nLCBKREJDU3RvcmUgc3RvcmUsIElucHV0U3RyZWFtIGlzKQogICAgICAgIHRo\ncm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIC8vRG8gbm90aGluZwogICAg\nfQoKICAgIHB1YmxpYyB2b2lkIGRlbGV0ZVN0cmVhbShKREJDU3RvcmUgc3Rv\ncmUsIFNlbGVjdCBzZWwpIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAg\nIEpEQkNGZXRjaENvbmZpZ3VyYXRpb24gZmV0Y2ggPSBzdG9yZS5nZXRGZXRj\naENvbmZpZ3VyYXRpb24oKTsKICAgICAgICBTUUxCdWZmZXIgc3FsID0gc2Vs\nLnRvU2VsZWN0KHRydWUsIGZldGNoKTsKICAgICAgICBSZXN1bHRTZXQgcmVz\nID0gbnVsbDsKICAgICAgICBEZWxlZ2F0aW5nQ29ubmVjdGlvbiBjb25uID0g\nCiAgICAgICAgICAgIChEZWxlZ2F0aW5nQ29ubmVjdGlvbikgc3RvcmUuZ2V0\nQ29ubmVjdGlvbigpOwogICAgICAgIFByZXBhcmVkU3RhdGVtZW50IHN0bW50\nID0gbnVsbDsKICAgICAgICB0cnkgewogICAgICAgICAgICBzdG1udCA9IHNx\nbC5wcmVwYXJlU3RhdGVtZW50KGNvbm4sIGZldGNoLAogICAgICAgICAgICAg\nICAgUmVzdWx0U2V0LlRZUEVfU0NST0xMX1NFTlNJVElWRSwgUmVzdWx0U2V0\nLkNPTkNVUl9VUERBVEFCTEUpOwogICAgICAgICAgICBzZXRUaW1lb3V0cyhz\ndG1udCwgZmV0Y2gsIHRydWUpOwogICAgICAgICAgICByZXMgPSBzdG1udC5l\neGVjdXRlUXVlcnkoKTsKICAgICAgICAgICAgaWYgKCFyZXMubmV4dCgpKSB7\nCiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgSW50ZXJuYWxFeGNlcHRpb24o\nX2xvYy5nZXQoInN0cmVhbS1leGNlcHRpb24iKSk7CiAgICAgICAgICAgIH0K\nICAgICAgICAgICAgaW50IG9pZCA9IHJlcy5nZXRJbnQoMSk7CiAgICAgICAg\nICAgIGlmIChvaWQgIT0gLTEpIHsKICAgICAgICAgICAgICAgIGNvbm4uc2V0\nQXV0b0NvbW1pdChmYWxzZSk7CiAgICAgICAgICAgICAgICBMYXJnZU9iamVj\ndE1hbmFnZXIgbG9tID0gZ2V0TGFyZ2VPYmplY3RNYW5hZ2VyKGNvbm4pOwog\nICAgICAgICAgICAgICAgbG9tLmRlbGV0ZShvaWQpOwogICAgICAgICAgICB9\nCiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgaWYgKHJlcyAhPSBu\ndWxsKQogICAgICAgICAgICAgICAgdHJ5IHsgcmVzLmNsb3NlICgpOyB9IGNh\ndGNoIChTUUxFeGNlcHRpb24gZSkge30KICAgICAgICAgICAgaWYgKHN0bW50\nICE9IG51bGwpCiAgICAgICAgICAgICAgICB0cnkgeyBzdG1udC5jbG9zZSAo\nKTsgfSBjYXRjaCAoU1FMRXhjZXB0aW9uIGUpIHt9CiAgICAgICAgICAgIGlm\nIChjb25uICE9IG51bGwpCiAgICAgICAgICAgICAgICB0cnkgeyBjb25uLmNs\nb3NlICgpOyB9IGNhdGNoIChTUUxFeGNlcHRpb24gZSkge30KICAgICAgICB9\nCiAgICB9CgogICAgLyoqCiAgICAgKiBEZXRlcm1pbmUgd2hldGhlciBYTUwg\nY29sdW1uIGlzIHN1cHBvcnRlZC4KICAgICAqLwogICAgcHVibGljIHZvaWQg\nY29ubmVjdGVkQ29uZmlndXJhdGlvbihDb25uZWN0aW9uIGNvbm4pIHRocm93\ncyBTUUxFeGNlcHRpb24gewogICAgICAgIHN1cGVyLmNvbm5lY3RlZENvbmZp\nZ3VyYXRpb24oY29ubik7CiAgICAgICAgCiAgICAgICAgRGF0YWJhc2VNZXRh\nRGF0YSBtZXRhRGF0YSA9IGNvbm4uZ2V0TWV0YURhdGEoKTsKICAgICAgICBp\nbnQgbWFqID0gMDsKICAgICAgICBpbnQgbWluID0gMDsKICAgICAgICBpZiAo\naXNKREJDMykgewogICAgICAgICAgICBtYWogPSBtZXRhRGF0YS5nZXREYXRh\nYmFzZU1ham9yVmVyc2lvbigpOwogICAgICAgICAgICBtaW4gPSBtZXRhRGF0\nYS5nZXREYXRhYmFzZU1pbm9yVmVyc2lvbigpOwogICAgICAgIH0gZWxzZSB7\nCiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAvLyBUaGUgcHJv\nZHVjdCB2ZXJzaW9uIGxvb2tzIGxpa2UgIjguMy41Ii4KICAgICAgICAgICAg\nICAgIFN0cmluZyBwcm9kdWN0VmVyc2lvbiA9IG1ldGFEYXRhLmdldERhdGFi\nYXNlUHJvZHVjdFZlcnNpb24oKTsKICAgICAgICAgICAgICAgIFN0cmluZyBt\nYWpNaW5bXSA9IHByb2R1Y3RWZXJzaW9uLnNwbGl0KCJcXC4iKTsKICAgICAg\nICAgICAgICAgIG1haiA9IEludGVnZXIucGFyc2VJbnQobWFqTWluWzBdKTsK\nICAgICAgICAgICAgICAgIG1pbiA9IEludGVnZXIucGFyc2VJbnQobWFqTWlu\nWzFdKTsKICAgICAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAg\nICAgICAgICAgICAgIC8vIFdlIGRvbid0IHVuZGVyc3RhbmQgdGhlIHZlcnNp\nb24gZm9ybWF0LgogICAgICAgICAgICAgICAgaWYgKGxvZy5pc1dhcm5FbmFi\nbGVkKCkpCiAgICAgICAgICAgICAgICAgICAgbG9nLndhcm4oZS50b1N0cmlu\nZygpLGUpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIAogICAg\nICAgIGlmICgobWFqID49IDkgfHwgKG1haiA9PSA4ICYmIG1pbiA+PSAzKSkp\nIHsKICAgICAgICAgICAgc3VwcG9ydHNYTUxDb2x1bW4gPSB0cnVlOwogICAg\nICAgIH0KICAgIH0KIAogICAgLyoqCiAgICAgKiBJZiBjb2x1bW4gaXMgYW4g\nWE1MIGNvbHVtbiwgUG9zdGdyZVNRTCByZXF1aXJlcyB0aGF0IGl0cyB2YWx1\nZSBpcyBzZXQKICAgICAqIGJ5IHVzaW5nIHtAbGluayBQcmVwYXJlZFN0YXRl\nbWVudCNzZXRPYmplY3QoaW50LCBPYmplY3QsIGludCl9CiAgICAgKiB3aXRo\nIHtAbGluayBUeXBlcyNPVEhFUn0gYXMgdGhlIHRoaXJkIGFyZ3VtZW50Lgog\nICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRDbG9iU3RyaW5nKFByZXBhcmVk\nU3RhdGVtZW50IHN0bW50LCBpbnQgaWR4LCBTdHJpbmcgdmFsLAogICAgICAg\nIENvbHVtbiBjb2wpIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIGlm\nIChjb2wgIT0gbnVsbCAmJiBjb2wuaXNYTUwoKSkKICAgICAgICAgICAgc3Rt\nbnQuc2V0T2JqZWN0KGlkeCwgdmFsLCBUeXBlcy5PVEhFUik7CiAgICAgICAg\nZWxzZQogICAgICAgICAgICBzdXBlci5zZXRDbG9iU3RyaW5nKHN0bW50LCBp\nZHgsIHZhbCwgY29sKTsKICAgIH0KICAgIAogICAgLyoqCiAgICAgKiBPdmVy\ncmlkZSB0aGUgZ2V0T2piZWN0KCkgbWV0aG9kIHRvIGhhbmRsZSB0aGUgY2Fz\nZSB3aGVyZSB0aGUgbGF0ZXN0CiAgICAgKiBQb3N0Z3JlcyBKREJDIGRyaXZl\nciByZXR1cm5zIGEgb3JnLnBvc3RncmVzcWwudXRpbC5QR29iamVjdCBpbnN0\nZWFkIG9mIGEKICAgICAqIGphdmEuc3FsLlRpbWVzdGFtcAogICAgICogCiAg\nICAgKiBAcGFyYW0gcnMKICAgICAqIEBwYXJhbSBjb2x1bW4KICAgICAqIEBw\nYXJhbSBtYXAKICAgICAqIAogICAgICogQHJldHVybgogICAgICogQGV4Y2Vw\ndGlvbiBTUUxFeGNlcHRpb24KICAgICAqLwogICAgcHVibGljIE9iamVjdCBn\nZXRPYmplY3QoUmVzdWx0U2V0IHJzLCBpbnQgY29sdW1uLCBNYXAgbWFwKQog\nICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIE9iamVjdCBv\nYmogPSBzdXBlci5nZXRPYmplY3QocnMsIGNvbHVtbiwgbWFwKTsKCiAgICAg\nICAgaWYgKG9iaiA9PSBudWxsKSB7CiAgICAgICAgICAgIHJldHVybiBudWxs\nOwogICAgICAgIH0KICAgICAgICBpZiAob2JqLmdldENsYXNzKCkuZ2V0TmFt\nZSgpLmVxdWFscygib3JnLnBvc3RncmVzcWwudXRpbC5QR29iamVjdCIpKSB7\nCiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBNZXRob2QgbSA9\nIG9iai5nZXRDbGFzcygpLmdldE1ldGhvZCgiZ2V0VHlwZSIsIChDbGFzc1td\nKSBudWxsKTsKICAgICAgICAgICAgICAgIE9iamVjdCB0eXBlID0gbS5pbnZv\na2Uob2JqLCAoT2JqZWN0W10pIG51bGwpOwogICAgICAgICAgICAgICAgaWYg\nKCgoU3RyaW5nKSB0eXBlKS5lcXVhbHNJZ25vcmVDYXNlKHRpbWVzdGFtcFR5\ncGVOYW1lKSkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBycy5nZXRU\naW1lc3RhbXAoY29sdW1uKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAg\nICAgfSBjYXRjaCAoVGhyb3dhYmxlIHQpIHsKICAgICAgICAgICAgICAgIGlm\nICh0IGluc3RhbmNlb2YgSW52b2NhdGlvblRhcmdldEV4Y2VwdGlvbikKICAg\nICAgICAgICAgICAgICAgICB0ID0gKChJbnZvY2F0aW9uVGFyZ2V0RXhjZXB0\naW9uKSB0KS5nZXRUYXJnZXRFeGNlcHRpb24oKTsKICAgICAgICAgICAgICAg\nIGlmICh0IGluc3RhbmNlb2YgU1FMRXhjZXB0aW9uKQogICAgICAgICAgICAg\nICAgICAgIHRocm93IChTUUxFeGNlcHRpb24pIHQ7CiAgICAgICAgICAgICAg\nICB0aHJvdyBuZXcgU1FMRXhjZXB0aW9uKHQuZ2V0TWVzc2FnZSgpKTsKICAg\nICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4gb2JqOwogICAg\nfQoKICAgIC8qKgogICAgICogQXBwZW5kIFhNTCBjb21wYXJpc29uLgogICAg\nICogCiAgICAgKiBAcGFyYW0gYnVmCiAgICAgKiAgICAgICAgICAgIHRoZSBT\nUUwgYnVmZmVyIHRvIHdyaXRlIHRoZSBjb21wYXJpc29uCiAgICAgKiBAcGFy\nYW0gb3AKICAgICAqICAgICAgICAgICAgdGhlIGNvbXBhcmlzb24gb3BlcmF0\naW9uIHRvIHBlcmZvcm0KICAgICAqIEBwYXJhbSBsaHMKICAgICAqICAgICAg\nICAgICAgdGhlIGxlZnQgaGFuZCBzaWRlIG9mIHRoZSBjb21wYXJpc29uCiAg\nICAgKiBAcGFyYW0gcmhzCiAgICAgKiAgICAgICAgICAgIHRoZSByaWdodCBo\nYW5kIHNpZGUgb2YgdGhlIGNvbXBhcmlzb24KICAgICAqIEBwYXJhbSBsaHN4\nbWwKICAgICAqICAgICAgICAgICAgaW5kaWNhdGVzIHdoZXRoZXIgdGhlIGxl\nZnQgb3BlcmFuZCBtYXBzIHRvIFhNTAogICAgICogQHBhcmFtIHJoc3htbAog\nICAgICogICAgICAgICAgICBpbmRpY2F0ZXMgd2hldGhlciB0aGUgcmlnaHQg\nb3BlcmFuZCBtYXBzIHRvIFhNTAogICAgICovCiAgICBwdWJsaWMgdm9pZCBh\ncHBlbmRYbWxDb21wYXJpc29uKFNRTEJ1ZmZlciBidWYsIFN0cmluZyBvcCwg\nRmlsdGVyVmFsdWUgbGhzLAogICAgICAgIEZpbHRlclZhbHVlIHJocywgYm9v\nbGVhbiBsaHN4bWwsIGJvb2xlYW4gcmhzeG1sKSB7CiAgICAgICAgc3VwZXIu\nYXBwZW5kWG1sQ29tcGFyaXNvbihidWYsIG9wLCBsaHMsIHJocywgbGhzeG1s\nLCByaHN4bWwpOwogICAgICAgIGlmIChsaHN4bWwpCiAgICAgICAgICAgIGFw\ncGVuZFhtbFZhbHVlKGJ1ZiwgbGhzKTsKICAgICAgICBlbHNlCiAgICAgICAg\nICAgIGxocy5hcHBlbmRUbyhidWYpOwogICAgICAgIGJ1Zi5hcHBlbmQoIiAi\nKS5hcHBlbmQob3ApLmFwcGVuZCgiICIpOwogICAgICAgIGlmIChyaHN4bWwp\nCiAgICAgICAgICAgIGFwcGVuZFhtbFZhbHVlKGJ1ZiwgcmhzKTsKICAgICAg\nICBlbHNlCiAgICAgICAgICAgIHJocy5hcHBlbmRUbyhidWYpOwogICAgfQog\nICAgCiAgICAvKioKICAgICAqIEFwcGVuZCBYTUwgY29sdW1uIHZhbHVlIHNv\nIHRoYXQgaXQgY2FuIGJlIHVzZWQgaW4gY29tcGFyaXNvbnMuCiAgICAgKiAK\nICAgICAqIEBwYXJhbSBidWYKICAgICAqICAgICAgICAgICAgdGhlIFNRTCBi\ndWZmZXIgdG8gd3JpdGUgdGhlIHZhbHVlCiAgICAgKiBAcGFyYW0gdmFsCiAg\nICAgKiAgICAgICAgICAgIHRoZSB2YWx1ZSB0byBiZSB3cml0dGVuCiAgICAg\nKi8KICAgIHByaXZhdGUgdm9pZCBhcHBlbmRYbWxWYWx1ZShTUUxCdWZmZXIg\nYnVmLCBGaWx0ZXJWYWx1ZSB2YWwpIHsKICAgICAgICBDbGFzcyByYyA9IEZp\nbHRlcnMud3JhcCh2YWwuZ2V0VHlwZSgpKTsKICAgICAgICBpbnQgdHlwZSA9\nIGdldEpEQkNUeXBlKEphdmFUeXBlcy5nZXRUeXBlQ29kZShyYyksIGZhbHNl\nKTsKICAgICAgICBib29sZWFuIGlzWG1sQXR0cmlidXRlID0gKHZhbC5nZXRY\nbWxNYXBwaW5nKCkgPT0gbnVsbCkgPyBmYWxzZQogICAgICAgICAgICAgICAg\nOiB2YWwuZ2V0WG1sTWFwcGluZygpLmlzWG1sQXR0cmlidXRlKCk7CiAgICAg\nICAgU1FMQnVmZmVyIG5ld0J1ZmVyID0gbmV3IFNRTEJ1ZmZlcih0aGlzKTsK\nICAgICAgICBuZXdCdWZlci5hcHBlbmQoIih4cGF0aCgnLyovIik7CiAgICAg\nICAgdmFsLmFwcGVuZFRvKG5ld0J1ZmVyKTsKICAgICAgICBpZiAoIWlzWG1s\nQXR0cmlidXRlKQogICAgICAgICAgICBuZXdCdWZlci5hcHBlbmQoIi90ZXh0\nKCkiKTsKICAgICAgICBuZXdCdWZlci5hcHBlbmQoIicsIikuCiAgICAgICAg\nICAgIGFwcGVuZCh2YWwuZ2V0Q29sdW1uQWxpYXModmFsLmdldEZpZWxkTWFw\ncGluZygpLmdldENvbHVtbnMoKVswXSkpLgogICAgICAgICAgICBhcHBlbmQo\nIikpWzFdIik7CiAgICAgICAgYXBwZW5kQ2FzdChidWYsIG5ld0J1ZmVyLCB0\neXBlKTsKICAgIH0KCgogICAgLyoqCiAgICAgKiBSZXR1cm4gYSBTUUwgc3Ry\naW5nIHRvIGFjdCBhcyBhIHBsYWNlaG9sZGVyIGZvciB0aGUgZ2l2ZW4gY29s\ndW1uLgogICAgICovCiAgICBwdWJsaWMgU3RyaW5nIGdldFBsYWNlaG9sZGVy\nVmFsdWVTdHJpbmcoQ29sdW1uIGNvbCkgewogICAgICAgIGlmIChjb2wuZ2V0\nVHlwZSgpID09IFR5cGVzLkJJVCkgewogICAgICAgICAgICByZXR1cm4gImZh\nbHNlIjsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXR1cm4gc3Vw\nZXIuZ2V0UGxhY2Vob2xkZXJWYWx1ZVN0cmluZyhjb2wpOwogICAgICAgIH0K\nICAgIH0KCiAgICAvKioKICAgICAqIEdldCB0aGUgbmF0aXZlIFBvc3RncmVT\nUUwgTGFyZ2UgT2JqZWN0IE1hbmFnZXIgdXNlZCBmb3IgTE9CIGhhbmRsaW5n\nLgogICAgICovCiAgICBwcm90ZWN0ZWQgTGFyZ2VPYmplY3RNYW5hZ2VyIGdl\ndExhcmdlT2JqZWN0TWFuYWdlcihEZWxlZ2F0aW5nQ29ubmVjdGlvbiBjb25u\nKSB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICByZXR1cm4gZ2V0UEdD\nb25uZWN0aW9uKGNvbm4pLmdldExhcmdlT2JqZWN0QVBJKCk7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBHZXQgdGhlIG5hdGl2ZSBQb3N0Z3JlU1FMIGNvbm5l\nY3Rpb24gZnJvbSB0aGUgZ2l2ZW4gY29ubmVjdGlvbi4KICAgICAqIFZhcmlv\ndXMgYXR0ZW1wdHMgb2YgdW53cmFwcGluZyBhcmUgYmVpbmcgcGVyZm9ybWVk\nLgogICAgICovCiAgICBwcm90ZWN0ZWQgUEdDb25uZWN0aW9uIGdldFBHQ29u\nbmVjdGlvbihEZWxlZ2F0aW5nQ29ubmVjdGlvbiBjb25uKSB7CiAgICAgICAg\nQ29ubmVjdGlvbiBpbm5lckNvbm4gPSBjb25uLmdldElubmVybW9zdERlbGVn\nYXRlKCk7CiAgICAgICAgaWYgKGlubmVyQ29ubiBpbnN0YW5jZW9mIFBHQ29u\nbmVjdGlvbikgewogICAgICAgICAgICByZXR1cm4gKFBHQ29ubmVjdGlvbikg\naW5uZXJDb25uOwogICAgICAgIH0KICAgICAgICBpZiAoaW5uZXJDb25uLmdl\ndENsYXNzKCkuZ2V0TmFtZSgpLnN0YXJ0c1dpdGgoIm9yZy5hcGFjaGUuY29t\nbW9ucy5kYmNwIikpIHsKICAgICAgICAgICAgcmV0dXJuIChQR0Nvbm5lY3Rp\nb24pIGdldERiY3BEZWxlZ2F0ZShpbm5lckNvbm4pOwogICAgICAgIH0KICAg\nICAgICByZXR1cm4gKFBHQ29ubmVjdGlvbikgdW53cmFwQ29ubmVjdGlvbihj\nb25uLCBQR0Nvbm5lY3Rpb24uY2xhc3MpOwogICAgfQoKICAgIC8qKgogICAg\nICogR2V0IHRoZSBkZWxlZ2F0ZWQgY29ubmVjdGlvbiBmcm9tIHRoZSBnaXZl\nbiBEQkNQIGNvbm5lY3Rpb24uCiAgICAgKiAKICAgICAqIEBwYXJhbSBjb25u\nIG11c3QgYmUgYSBEQkNQIGNvbm5lY3Rpb24KICAgICAqIEByZXR1cm4gY29u\nbmVjdGlvbiB0aGUgREJDUCBjb25uZWN0aW9uIGRlbGVnYXRlcyB0bwogICAg\nICovCiAgICBwcm90ZWN0ZWQgQ29ubmVjdGlvbiBnZXREYmNwRGVsZWdhdGUo\nQ29ubmVjdGlvbiBjb25uKSB7CiAgICAgICAgQ29ubmVjdGlvbiBkZWxlZ2F0\nZSA9IG51bGw7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgaWYgKGRiY3BH\nZXREZWxlZ2F0ZSA9PSBudWxsKSB7CiAgICAgICAgICAgICAgICBDbGFzczw/\nPiBkYmNwQ29ubmVjdGlvbkNsYXNzID0KICAgICAgICAgICAgICAgICAgICBD\nbGFzcy5mb3JOYW1lKCJvcmcuYXBhY2hlLmNvbW1vbnMuZGJjcC5EZWxlZ2F0\naW5nQ29ubmVjdGlvbiIsIHRydWUsIEFjY2Vzc0NvbnRyb2xsZXIKICAgICAg\nICAgICAgICAgICAgICAgICAgLmRvUHJpdmlsZWdlZChKMkRvUHJpdkhlbHBl\nci5nZXRDb250ZXh0Q2xhc3NMb2FkZXJBY3Rpb24oKSkpOwogICAgICAgICAg\nICAgICAgCiAgICAgICAgICAgICAgICBkYmNwR2V0RGVsZWdhdGUgPSBkYmNw\nQ29ubmVjdGlvbkNsYXNzLmdldE1ldGhvZCgiZ2V0SW5uZXJtb3N0RGVsZWdh\ndGUiKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBkZWxlZ2F0ZSA9IChD\nb25uZWN0aW9uKSBkYmNwR2V0RGVsZWdhdGUuaW52b2tlKGNvbm4pOwogICAg\nICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgIHRocm93\nIG5ldyBJbnRlcm5hbEV4Y2VwdGlvbihfbG9jLmdldCgiZGJjcC11bndyYXAt\nZmFpbGVkIiksIGUpOwogICAgICAgIH0KICAgICAgICBpZiAoZGVsZWdhdGUg\nPT0gbnVsbCkgewogICAgICAgICAgICB0aHJvdyBuZXcgSW50ZXJuYWxFeGNl\ncHRpb24oX2xvYy5nZXQoImRiY3AtdW53cmFwLWZhaWxlZCIpKTsKICAgICAg\nICB9CiAgICAgICAgcmV0dXJuIGRlbGVnYXRlOwogICAgfQoKICAgIC8qKgog\nICAgICogR2V0ICh1bndyYXApIHRoZSBkZWxlZ2F0ZWQgY29ubmVjdGlvbiBm\ncm9tIHRoZSBnaXZlbiBjb25uZWN0aW9uLgogICAgICogVXNlIHJlZmxlY3Rp\nb24gdG8gYXR0ZW1wdCB0byB1bndyYXAgYSBjb25uZWN0aW9uLgogICAgICog\nTm90ZTogVGhpcyBpcyBhIEpEQkMgNCBvcGVyYXRpb24sIHNvIGl0IHJlcXVp\ncmVzIGEgSmF2YSA2IGVudmlyb25tZW50IAogICAgICogd2l0aCBhIEpEQkMg\nNCBkcml2ZXIgb3IgZGF0YSBzb3VyY2UgdG8gaGF2ZSBhbnkgY2hhbmNlIG9m\nIHN1Y2Nlc3MuCiAgICAgKiAKICAgICAqIEBwYXJhbSBjb25uIGEgZGVsZWdh\ndGluZyBjb25uZWN0aW9uCiAgICAgKiBAcGFyYW0gY29ubmVjdGlvbkNsYXNz\nIHRoZSBleHBlY3RlZCB0eXBlIG9mIGRlbGVnYXRlZCBjb25uZWN0aW9uCiAg\nICAgKiBAcmV0dXJuIGNvbm5lY3Rpb24gdGhlIGdpdmVuIGNvbm5lY3Rpb24g\nZGVsZWdhdGVzIHRvCiAgICAgKi8KICAgIHByaXZhdGUgQ29ubmVjdGlvbiB1\nbndyYXBDb25uZWN0aW9uKENvbm5lY3Rpb24gY29ubiwgQ2xhc3M8Pz4gY29u\nbmVjdGlvbkNsYXNzKSB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgaWYg\nKGNvbm5lY3Rpb25VbndyYXAgPT0gbnVsbCkgewogICAgICAgICAgICAgICAg\nY29ubmVjdGlvblVud3JhcCA9IENvbm5lY3Rpb24uY2xhc3MuZ2V0TWV0aG9k\nKCJ1bndyYXAiLCBDbGFzcy5jbGFzcyk7CiAgICAgICAgICAgIH0KICAgICAg\nICAgICAgcmV0dXJuIChDb25uZWN0aW9uKSBjb25uZWN0aW9uVW53cmFwLmlu\ndm9rZShjb25uLCBjb25uZWN0aW9uQ2xhc3MpOwogICAgICAgIH0gY2F0Y2gg\nKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBJbnRlcm5h\nbEV4Y2VwdGlvbihfbG9jLmdldCgiY29ubmVjdGlvbi11bndyYXAtZmFpbGVk\nIiksIGUpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIENvbm5l\nY3Rpb24gd3JhcHBlciB0byB3b3JrIGFyb3VuZCB0aGUgcG9zdGdyZXMgZW1w\ndHkgcmVzdWx0IHNldCBidWcuCiAgICAgKi8KICAgIHByb3RlY3RlZCBhYnN0\ncmFjdCBzdGF0aWMgY2xhc3MgUG9zdGdyZXNDb25uZWN0aW9uCiAgICAgICAg\nZXh0ZW5kcyBEZWxlZ2F0aW5nQ29ubmVjdGlvbiB7CgogICAgICAgIHByaXZh\ndGUgZmluYWwgUG9zdGdyZXNEaWN0aW9uYXJ5IF9kaWN0OwoKICAgICAgICBw\ndWJsaWMgUG9zdGdyZXNDb25uZWN0aW9uKENvbm5lY3Rpb24gY29ubiwgUG9z\ndGdyZXNEaWN0aW9uYXJ5IGRpY3QpIHsKICAgICAgICAgICAgc3VwZXIoY29u\nbik7CiAgICAgICAgICAgIF9kaWN0ID0gZGljdDsKICAgICAgICB9CgogICAg\nICAgIHByb3RlY3RlZCBQcmVwYXJlZFN0YXRlbWVudCBwcmVwYXJlU3RhdGVt\nZW50KFN0cmluZyBzcWwsIGJvb2xlYW4gd3JhcCkKICAgICAgICAgICAgdGhy\nb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgICAgcmV0dXJuIENvbmNyZXRl\nQ2xhc3NHZW5lcmF0b3IubmV3SW5zdGFuY2UocG9zdGdyZXNQcmVwYXJlZFN0\nYXRlbWVudEltcGwsIAogICAgICAgICAgICAgICAgICAgc3VwZXIucHJlcGFy\nZVN0YXRlbWVudChzcWwsIGZhbHNlKSwgUG9zdGdyZXNDb25uZWN0aW9uLnRo\naXMsIF9kaWN0KTsKICAgICAgICB9CgogICAgICAgIHByb3RlY3RlZCBQcmVw\nYXJlZFN0YXRlbWVudCBwcmVwYXJlU3RhdGVtZW50KFN0cmluZyBzcWwsIGlu\ndCByc1R5cGUsCiAgICAgICAgICAgIGludCByc0NvbmN1ciwgYm9vbGVhbiB3\ncmFwKQogICAgICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAg\nICAgICAgcmV0dXJuIENvbmNyZXRlQ2xhc3NHZW5lcmF0b3IuCiAgICAgICAg\nICAgICAgICBuZXdJbnN0YW5jZShwb3N0Z3Jlc1ByZXBhcmVkU3RhdGVtZW50\nSW1wbCwKICAgICAgICAgICAgICAgICAgICBzdXBlci5wcmVwYXJlU3RhdGVt\nZW50KHNxbCwgcnNUeXBlLCByc0NvbmN1ciwgZmFsc2UpLAogICAgICAgICAg\nICAgICAgICAgIFBvc3RncmVzQ29ubmVjdGlvbi50aGlzLAogICAgICAgICAg\nICAgICAgICAgIF9kaWN0KTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAg\nICAgKiBTdGF0ZW1lbnQgd3JhcHBlciB0byB3b3JrIGFyb3VuZCB0aGUgcG9z\ndGdyZXMgZW1wdHkgcmVzdWx0IHNldCBidWcuCiAgICAgKi8KICAgIHByb3Rl\nY3RlZCBhYnN0cmFjdCBzdGF0aWMgY2xhc3MgUG9zdGdyZXNQcmVwYXJlZFN0\nYXRlbWVudAogICAgICAgIGV4dGVuZHMgRGVsZWdhdGluZ1ByZXBhcmVkU3Rh\ndGVtZW50IHsKCiAgICAgICAgcHJpdmF0ZSBmaW5hbCBQb3N0Z3Jlc0RpY3Rp\nb25hcnkgX2RpY3Q7CgogICAgICAgIHB1YmxpYyBQb3N0Z3Jlc1ByZXBhcmVk\nU3RhdGVtZW50KFByZXBhcmVkU3RhdGVtZW50IHBzLAogICAgICAgICAgICBD\nb25uZWN0aW9uIGNvbm4sIFBvc3RncmVzRGljdGlvbmFyeSBkaWN0KSB7CiAg\nICAgICAgICAgIHN1cGVyKHBzLCBjb25uKTsKICAgICAgICAgICAgX2RpY3Qg\nPSBkaWN0OwogICAgICAgIH0KCiAgICAgICAgcHJvdGVjdGVkIFJlc3VsdFNl\ndCBleGVjdXRlUXVlcnkoYm9vbGVhbiB3cmFwKQogICAgICAgICAgICB0aHJv\nd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAg\nICAgICAgIHJldHVybiBzdXBlci5leGVjdXRlUXVlcnkod3JhcCk7CiAgICAg\nICAgICAgIH0gY2F0Y2ggKFNRTEV4Y2VwdGlvbiBzZSkgewogICAgICAgICAg\nICAgICAgLy8gd2UgbmVlZCB0byBtYWtlIG91ciBiZXN0IGd1ZXNzIHdoZXRo\nZXIgdGhpcyBpcyB0aGUgZW1wdHkKICAgICAgICAgICAgICAgIC8vIFJlc3Vs\ndFNldCBidWcsIHNpbmNlIHRoaXMgZXhjZXB0aW9uIGNvdWxkIG9jY3VyCiAg\nICAgICAgICAgICAgICAvLyBmb3Igb3RoZXIgcmVhc29ucyAobGlrZSBhbiBp\nbnZhbGlkIHF1ZXJ5IHN0cmluZykuIE5vdGUKICAgICAgICAgICAgICAgIC8v\nIHRoYXQgUG9zdGdyZXMgZXJyb3IgbWVzc2FnZXMgYXJlIGxvY2FsaXplZCwg\nc28gd2UKICAgICAgICAgICAgICAgIC8vIGNhbm5vdCBqdXN0IHBhcnNlIHRo\nZSBleGNlcHRpb24gU3RyaW5nLgogICAgICAgICAgICAgICAgUmVzdWx0U2V0\nIHJzID0gZ2V0UmVzdWx0U2V0KHdyYXApOwoKICAgICAgICAgICAgICAgIC8v\nIFJlc3VsdFNldCBzaG91bGQgYmUgZW1wdHk6IGlmIG5vdCwgdGhlbiBtYXli\nZSBhbgogICAgICAgICAgICAgICAgLy8gYWN0dWFsIGVycm9yIG9jY3VycmVk\nCiAgICAgICAgICAgICAgICBpZiAocnMgPT0gbnVsbCkKICAgICAgICAgICAg\nICAgICAgICB0aHJvdyBzZTsKCiAgICAgICAgICAgICAgICByZXR1cm4gcnM7\nCiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHB1YmxpYyB2b2lk\nIHNldEZldGNoU2l6ZShpbnQgaSkKICAgICAgICAgICAgdGhyb3dzIFNRTEV4\nY2VwdGlvbiB7CiAgICAgICAgICAgIC8vIHNvbWUgcG9zdGdyZXMgZHJpdmVy\ncyBkbyBub3Qgc3VwcG9ydCB0aGUgc2V0RmV0Y2hTaXplIG1ldGhvZAogICAg\nICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgaWYgKF9kaWN0LnN1cHBv\ncnRzU2V0RmV0Y2hTaXplKQogICAgICAgICAgICAgICAgICAgIHN1cGVyLnNl\ndEZldGNoU2l6ZShpKTsKICAgICAgICAgICAgfSBjYXRjaCAoU1FMRXhjZXB0\naW9uIGUpIHsKICAgICAgICAgICAgICAgIF9kaWN0LnN1cHBvcnRzU2V0RmV0\nY2hTaXplID0gZmFsc2U7CiAgICAgICAgICAgICAgICBpZiAoX2RpY3QubG9n\nLmlzV2FybkVuYWJsZWQoKSkKICAgICAgICAgICAgICAgICAgICBfZGljdC5s\nb2cud2FybihfbG9jLmdldCgicHNxbC1uby1zZXQtZmV0Y2gtc2l6ZSIpLCBl\nKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KfQo=\n","encoding":"base64"}

