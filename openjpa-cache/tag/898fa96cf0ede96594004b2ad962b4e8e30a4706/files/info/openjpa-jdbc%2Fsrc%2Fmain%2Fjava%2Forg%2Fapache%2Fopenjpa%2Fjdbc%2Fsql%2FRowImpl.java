{"sha":"576974f3255d0299c85dbe2b656645d0525c82a6","node_id":"MDQ6QmxvYjIwNjM2NDo1NzY5NzRmMzI1NWQwMjk5Yzg1ZGJlMmI2NTY2NDVkMDUyNWM4MmE2","size":29782,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/576974f3255d0299c85dbe2b656645d0525c82a6","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zcWw7CgppbXBvcnQg\namF2YS5pby5JbnB1dFN0cmVhbTsKaW1wb3J0IGphdmEuaW8uUmVhZGVyOwpp\nbXBvcnQgamF2YS5tYXRoLkJpZ0RlY2ltYWw7CmltcG9ydCBqYXZhLm1hdGgu\nQmlnSW50ZWdlcjsKaW1wb3J0IGphdmEuc3FsLkFycmF5OwppbXBvcnQgamF2\nYS5zcWwuQmxvYjsKaW1wb3J0IGphdmEuc3FsLkNsb2I7CmltcG9ydCBqYXZh\nLnNxbC5QcmVwYXJlZFN0YXRlbWVudDsKaW1wb3J0IGphdmEuc3FsLlNRTEV4\nY2VwdGlvbjsKaW1wb3J0IGphdmEuc3FsLlRpbWU7CmltcG9ydCBqYXZhLnNx\nbC5UaW1lc3RhbXA7CmltcG9ydCBqYXZhLnV0aWwuQ2FsZW5kYXI7CmltcG9y\ndCBqYXZhLnV0aWwuRGF0ZTsKaW1wb3J0IGphdmEudXRpbC5Mb2NhbGU7Cgpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMua2VybmVsLkpEQkNTdG9y\nZTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLm1ldGEuQ2xhc3NN\nYXBwaW5nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0YS5K\nYXZhU1FMVHlwZXM7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5t\nZXRhLkpvaW5hYmxlOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMu\nbWV0YS5SZWxhdGlvbklkOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpk\nYmMuc2NoZW1hLkNvbHVtbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5q\nZGJjLnNjaGVtYS5Db2x1bW5JTzsKaW1wb3J0IG9yZy5hcGFjaGUub3Blbmpw\nYS5qZGJjLnNjaGVtYS5Gb3JlaWduS2V5OwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLmpkYmMuc2NoZW1hLlRhYmxlOwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLmtlcm5lbC5PcGVuSlBBU3RhdGVNYW5hZ2VyOwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLm1ldGEuSmF2YVR5cGVzOwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLnV0aWwuSW50ZXJuYWxFeGNlcHRpb247CmltcG9ydCBz\nZXJwLnV0aWwuTnVtYmVyczsKCi8qKgogKiBCYXNpYyB7QGxpbmsgUm93fSBp\nbXBsZW1lbnRhdGlvbi4KICoKICogQGF1dGhvciBBYmUgV2hpdGUKICogQG5v\namF2YWRvYwogKi8KcHVibGljIGNsYXNzIFJvd0ltcGwKICAgIGltcGxlbWVu\ndHMgUm93LCBDbG9uZWFibGUgewoKICAgIHB1YmxpYyBzdGF0aWMgZmluYWwg\nT2JqZWN0IE5VTEwgPSBuZXcgT2JqZWN0KCk7CiAgICBwcm90ZWN0ZWQgc3Rh\ndGljIGZpbmFsIGludCBWQUxJRCA9IDIgPDwgMDsKCiAgICBwdWJsaWMgc3Rh\ndGljIGZpbmFsIGludCBSQVcgPSBJbnRlZ2VyLk1JTl9WQUxVRTsKCiAgICBw\ncm90ZWN0ZWQgYnl0ZSBmbGFncyA9IDA7CiAgICBwcml2YXRlIGZpbmFsIENv\nbHVtbltdIF9jb2xzOwogICAgcHJpdmF0ZSBmaW5hbCBpbnQgX2FjdGlvbjsK\nICAgIHByaXZhdGUgZmluYWwgT2JqZWN0W10gX3ZhbHM7CiAgICBwcml2YXRl\nIGZpbmFsIGludFtdIF90eXBlczsKCiAgICBwcml2YXRlIFN0cmluZyBfc3Fs\nID0gbnVsbDsKICAgIHByaXZhdGUgYm9vbGVhbiBfaXNGbHVzaGVkID0gZmFs\nc2U7CgogICAgLyoqCiAgICAgKiBDb25zdHJ1Y3Rvci4KICAgICAqCiAgICAg\nKiBAcGFyYW0gdGFibGUgdGhlIHRhYmxlIHRoZSByb3cgaXMgYSBwYXJ0IG9m\nCiAgICAgKiBAcGFyYW0gYWN0aW9uIHRoZSBhY3Rpb24gb24gdGhlIHJvdwog\nICAgICovCiAgICBwdWJsaWMgUm93SW1wbChUYWJsZSB0YWJsZSwgaW50IGFj\ndGlvbikgewogICAgICAgIHRoaXModGFibGUuZ2V0Q29sdW1ucygpLCBhY3Rp\nb24pOwogICAgfQoKICAgIHByb3RlY3RlZCBSb3dJbXBsKENvbHVtbltdIGNv\nbHMsIGludCBhY3Rpb24pIHsKICAgICAgICBfY29scyA9IGNvbHM7CiAgICAg\nICAgX2FjdGlvbiA9IGFjdGlvbjsKCiAgICAgICAgLy8gd2UgbmVlZCByb29t\nIGZvciB2YWx1ZXMgYW5kIHR5cGVzIGZvciBhbGwgY29sdW1uczsgaWYgYW4g\ndXBkYXRlIG9yCiAgICAgICAgLy8gZGVsZXRlLCB0aGVuIHdlIG5lZWQgdG8g\nZG91YmxlIHRoYXQgZm9yIHdoZXJlIGNvbHVtbiBjb25kaXRpb25zCiAgICAg\nICAgaW50IGxlbiA9IF9jb2xzLmxlbmd0aDsKICAgICAgICBpZiAoYWN0aW9u\nICE9IEFDVElPTl9JTlNFUlQpCiAgICAgICAgICAgIGxlbiAqPSAyOwogICAg\nICAgIF92YWxzID0gbmV3IE9iamVjdFtsZW5dOwogICAgICAgIF90eXBlcyA9\nIG5ldyBpbnRbbGVuXTsKICAgIH0KCiAgICBwdWJsaWMgVGFibGUgZ2V0VGFi\nbGUoKSB7CiAgICAgICAgcmV0dXJuIF9jb2xzWzBdLmdldFRhYmxlKCk7CiAg\nICB9CgogICAgcHVibGljIENvbHVtbltdIGdldENvbHVtbnMoKSB7CiAgICAg\nICAgcmV0dXJuIF9jb2xzOwogICAgfQoKICAgIHB1YmxpYyBpbnQgZ2V0QWN0\naW9uKCkgewogICAgICAgIHJldHVybiBfYWN0aW9uOwogICAgfQoKICAgIHB1\nYmxpYyBib29sZWFuIGlzVmFsaWQoKSB7CiAgICAgICAgcmV0dXJuIChmbGFn\ncyAmIFZBTElEKSAhPSAwOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldFZh\nbGlkKGJvb2xlYW4gdmFsaWQpIHsKICAgICAgICBpZiAodmFsaWQpCiAgICAg\nICAgICAgIGZsYWdzIHw9IFZBTElEOwogICAgICAgIGVsc2UKICAgICAgICAg\nICAgZmxhZ3MgJj0gflZBTElEOwogICAgfQoKICAgIC8qKgogICAgICogVGhp\ncyBpbXBsZW1lbnRhdGlvbiBkb2VzIG5vdCB0cmFjayBwcmltYXJ5IGtleXMu\nCiAgICAgKi8KICAgIHB1YmxpYyBPcGVuSlBBU3RhdGVNYW5hZ2VyIGdldFBy\naW1hcnlLZXkoKSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBUaGlzIGltcGxlbWVudGF0aW9uIGRvZXMgbm90IHRyYWNr\nIGZhaWxlZCBvYmplY3RzLgogICAgICovCiAgICBwdWJsaWMgT2JqZWN0IGdl\ndEZhaWxlZE9iamVjdCgpIHsKICAgICAgICByZXR1cm4gbnVsbDsKICAgIH0K\nCiAgICAvKioKICAgICAqIFRoaXMgaW1wbGVtZW50YXRpb24gZG9lcyBub3Qg\ndHJhY2sgZmFpbGVkIG9iamVjdHMuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lk\nIHNldEZhaWxlZE9iamVjdChPYmplY3QgZmFpbGVkKSB7CiAgICAgICAgdGhy\nb3cgbmV3IEludGVybmFsRXhjZXB0aW9uKCk7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBTZWNvbmRhcnkgcm93cyBjYW5ub3QgYmUgZGVwZW5kZW50LgogICAg\nICovCiAgICBwdWJsaWMgYm9vbGVhbiBpc0RlcGVuZGVudCgpIHsKICAgICAg\nICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4g\ndGhlIHZhbHVlIHNldCBmb3IgdXBkYXRlIG9uIHRoZSBnaXZlbiBjb2x1bW4u\nCiAgICAgKi8KICAgIHB1YmxpYyBPYmplY3QgZ2V0U2V0KENvbHVtbiBjb2wp\nIHsKICAgICAgICByZXR1cm4gX3ZhbHNbZ2V0U2V0SW5kZXgoY29sKV07CiAg\nICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIHZhbHVlIHNldCBmb3Ig\nd2hlcmUgb24gdGhlIGdpdmVuIGNvbHVtbi4KICAgICAqLwogICAgcHVibGlj\nIE9iamVjdCBnZXRXaGVyZShDb2x1bW4gY29sKSB7CiAgICAgICAgcmV0dXJu\nIF92YWxzW2dldFdoZXJlSW5kZXgoY29sKV07CiAgICB9CgogICAgcHVibGlj\nIHZvaWQgc2V0UHJpbWFyeUtleShPcGVuSlBBU3RhdGVNYW5hZ2VyIHNtKQog\nICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIHNldFByaW1h\ncnlLZXkobnVsbCwgc20pOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldFBy\naW1hcnlLZXkoQ29sdW1uSU8gaW8sIE9wZW5KUEFTdGF0ZU1hbmFnZXIgc20p\nCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgZmx1c2hQ\ncmltYXJ5S2V5KHNtLCBpbywgdHJ1ZSk7CiAgICB9CgogICAgcHVibGljIHZv\naWQgd2hlcmVQcmltYXJ5S2V5KE9wZW5KUEFTdGF0ZU1hbmFnZXIgc20pCiAg\nICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgZmx1c2hQcmlt\nYXJ5S2V5KHNtLCBudWxsLCBmYWxzZSk7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBGbHVzaCB0aGUgcHJpbWFyeSBrZXkgdmFsdWVzLgogICAgICovCiAgICBw\ncml2YXRlIHZvaWQgZmx1c2hQcmltYXJ5S2V5KE9wZW5KUEFTdGF0ZU1hbmFn\nZXIgc20sIENvbHVtbklPIGlvLAogICAgICAgIGJvb2xlYW4gc2V0KQogICAg\nICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIENsYXNzTWFwcGlu\nZyBtYXBwaW5nID0gKENsYXNzTWFwcGluZykgc20uZ2V0TWV0YURhdGEoKTsK\nICAgICAgICB3aGlsZSAobWFwcGluZy5nZXRUYWJsZSgpICE9IGdldFRhYmxl\nKCkpCiAgICAgICAgICAgIG1hcHBpbmcgPSBtYXBwaW5nLmdldFBDU3VwZXJj\nbGFzc01hcHBpbmcoKTsKICAgICAgICBDb2x1bW5bXSBjb2xzID0gbWFwcGlu\nZy5nZXRQcmltYXJ5S2V5Q29sdW1ucygpOwogICAgICAgIE9iamVjdCBvaWQg\nPSBtYXBwaW5nLnVzZUlkQ2xhc3NGcm9tUGFyZW50KCkgPyBzbS5nZXRPYmpl\nY3RJZCgpIDogbnVsbDsKICAgICAgICBmbHVzaEpvaW5WYWx1ZXMoc20sIG9p\nZCwgY29scywgY29scywgaW8sIHNldCk7CiAgICB9CgogICAgcHVibGljIHZv\naWQgc2V0Rm9yZWlnbktleShGb3JlaWduS2V5IGZrLCBPcGVuSlBBU3RhdGVN\nYW5hZ2VyIHNtKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAg\nICAgIHNldEZvcmVpZ25LZXkoZmssIG51bGwsIHNtKTsKICAgIH0KCiAgICBw\ndWJsaWMgdm9pZCBzZXRGb3JlaWduS2V5KEZvcmVpZ25LZXkgZmssIENvbHVt\nbklPIGlvLAogICAgICAgIE9wZW5KUEFTdGF0ZU1hbmFnZXIgc20pCiAgICAg\nICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgZmx1c2hGb3JlaWdu\nS2V5KGZrLCBpbywgc20sIHRydWUpOwogICAgfQoKICAgIHB1YmxpYyB2b2lk\nIHdoZXJlRm9yZWlnbktleShGb3JlaWduS2V5IGZrLCBPcGVuSlBBU3RhdGVN\nYW5hZ2VyIHNtKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAg\nICAgIGZsdXNoRm9yZWlnbktleShmaywgbnVsbCwgc20sIGZhbHNlKTsKICAg\nIH0KCiAgICAvKioKICAgICAqIENsZWFyIGEgY2lyY3VsYXIgZm9yZWlnbiBr\nZXkuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIGNsZWFyRm9yZWlnbktleShG\nb3JlaWduS2V5IGZrKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewog\nICAgICAgIF9zcWwgPSBudWxsOwogICAgICAgIENvbHVtbltdIGNvbHMgPSBm\nay5nZXRDb2x1bW5zKCk7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBj\nb2xzLmxlbmd0aDsgaSsrKQogICAgICAgICAgICBfdmFsc1tnZXRTZXRJbmRl\neChjb2xzW2ldKV0gPSBudWxsOwogICAgfQoKICAgIC8qKgogICAgICogRmx1\nc2ggdGhlIGZvcmVpZ24ga2V5IHZhbHVlcy4KICAgICAqLwogICAgcHJpdmF0\nZSB2b2lkIGZsdXNoRm9yZWlnbktleShGb3JlaWduS2V5IGZrLCBDb2x1bW5J\nTyBpbywKICAgICAgICBPcGVuSlBBU3RhdGVNYW5hZ2VyIHNtLCBib29sZWFu\nIHNldCkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBm\nbHVzaEpvaW5WYWx1ZXMoc20sIG51bGwsIGZrLmdldFByaW1hcnlLZXlDb2x1\nbW5zKCksIGZrLmdldENvbHVtbnMoKSwKICAgICAgICAgICAgaW8sIHNldCk7\nCiAgICAgICAgaWYgKHNtICE9IG51bGwpIHsKICAgICAgICAgICAgQ29sdW1u\nW10gY29scyA9IGZrLmdldENvbnN0YW50Q29sdW1ucygpOwogICAgICAgICAg\nICBpbnQgbGVuID0gZmsuZ2V0Q29sdW1ucygpLmxlbmd0aDsKICAgICAgICAg\nICAgT2JqZWN0IG9iajsKICAgICAgICAgICAgaW50IHR5cGU7CiAgICAgICAg\nICAgIGZvciAoaW50IGkgPSAwOyBpIDwgY29scy5sZW5ndGg7IGkrKykgewog\nICAgICAgICAgICAgICAgb2JqID0gZmsuZ2V0Q29uc3RhbnQoY29sc1tpXSk7\nCiAgICAgICAgICAgICAgICB0eXBlID0gY29sc1tpXS5nZXRKYXZhVHlwZSgp\nOwogICAgICAgICAgICAgICAgaWYgKHNldCAmJiBjYW5TZXQoaW8sIGkgKyBs\nZW4sIG9iaiA9PSBudWxsKSkKICAgICAgICAgICAgICAgICAgICBzZXRPYmpl\nY3QoY29sc1tpXSwgb2JqLCB0eXBlLCBmYWxzZSk7CiAgICAgICAgICAgICAg\nICBlbHNlIGlmICghc2V0KQogICAgICAgICAgICAgICAgICAgIHdoZXJlT2Jq\nZWN0KGNvbHNbaV0sIG9iaiwgdHlwZSk7CiAgICAgICAgICAgIH0KICAgICAg\nICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBGbHVzaCB0aGUgZ2l2ZW4gaW5z\ndGFuY2UgdmFsdWUgdG8gdGhlIGdpdmVuIGNvbHVtbnMuIE5vdGUgdGhhdAog\nICAgICogZm9yZWlnbiBrZXlzIG1heSBpbmNsdWRlIGNvbHVtbnMgYWxzbyBt\nYXBwZWQgYnkgc2ltcGxlIHZhbHVlcy4gV2UKICAgICAqIHVzZSBhIHByaW9y\naXR5IG1lY2hhbmlzbSB0byBlbnN1cmUgdGhhdCB3ZSBkbyBub3QgbGV0IHRo\nZSBudWxsaW5nCiAgICAgKiBvZiBhIGZvcmVpZ24ga2V5IG51bGwgY29sdW1u\ncyBhbHNvIG93bmVkIGJ5IHNpbXBsZSB2YWx1ZXMuCiAgICAgKgogICAgICog\nQHBhcmFtIHRvIHRoZSBpbnN0YW5jZSBiZWluZyBqb2luZWQgdG8KICAgICAq\nIEBwYXJhbSB0b0NvbHMgdGhlIGNvbHVtbnMgYmVpbmcgam9pbmVkIHRvCiAg\nICAgKiBAcGFyYW0gZnJvbUNvbHMgdGhlIGNvbHVtbnMgYmVpbmcgam9pbmVk\nIGZyb20KICAgICAqIEBwYXJhbSBpbyBpbmZvcm1hdGlvbiBhYm91dCBJL08g\nY2FwYWJpbGl0aWVzIGluIHRoaXMgY29udGV4dAogICAgICogQHBhcmFtIHNl\ndCB3aGV0aGVyIHRoaXMgc2hvdWxkIGJlIGZsdXNoZWQgYXMgYW4gdXBkYXRl\nIG9yCiAgICAgKiBhcyBhIHdoZXJlIGNvbmRpdGlvbgogICAgICovCiAgICBw\ncml2YXRlIHZvaWQgZmx1c2hKb2luVmFsdWVzKE9wZW5KUEFTdGF0ZU1hbmFn\nZXIgdG8sIE9iamVjdCBvaWQsIENvbHVtbltdIHRvQ29scywKICAgICAgICBD\nb2x1bW5bXSBmcm9tQ29scywgQ29sdW1uSU8gaW8sIGJvb2xlYW4gc2V0KQog\nICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIGlmICh0byA9\nPSBudWxsKSB7CiAgICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgZnJv\nbUNvbHMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICAgIGlmIChzZXQg\nJiYgY2FuU2V0KGlvLCBpLCB0cnVlKSkKICAgICAgICAgICAgICAgICAgICBz\nZXROdWxsKGZyb21Db2xzW2ldKTsKICAgICAgICAgICAgICAgIGVsc2UgaWYg\nKCFzZXQpCiAgICAgICAgICAgICAgICAgICAgd2hlcmVOdWxsKGZyb21Db2xz\nW2ldKTsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm47CiAgICAg\nICAgfQogICAgICAgIGlmIChzZXQgJiYgIWNhblNldEFueShpbywgZnJvbUNv\nbHMubGVuZ3RoLCBmYWxzZSkpCiAgICAgICAgICAgIHJldHVybjsKCiAgICAg\nICAgQ2xhc3NNYXBwaW5nIHRvTWFwcGluZyA9IChDbGFzc01hcHBpbmcpIHRv\nLmdldE1ldGFEYXRhKCk7CiAgICAgICAgSm9pbmFibGUgam9pbjsKICAgICAg\nICBPYmplY3QgdmFsOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgdG9D\nb2xzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIC8vIGRvbid0IGV2ZW4g\ndHJhbnNsYXRlIGpvaW4gdmFsdWUgaWYgdW5zZXR0YWJsZQogICAgICAgICAg\nICBpZiAoc2V0KSB7CiAgICAgICAgICAgICAgICBpZiAoX2FjdGlvbiA9PSBB\nQ1RJT05fSU5TRVJUICYmIGZyb21Db2xzW2ldLmlzQXV0b0Fzc2lnbmVkKCkp\nCiAgICAgICAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgICAg\nICBpZiAoIWNhblNldChpbywgaSwgZmFsc2UpKQogICAgICAgICAgICAgICAg\nICAgIGNvbnRpbnVlOwogICAgICAgICAgICB9CgogICAgICAgICAgICBqb2lu\nID0gdG9NYXBwaW5nLmFzc2VydEpvaW5hYmxlKHRvQ29sc1tpXSk7CiAgICAg\nICAgICAgIGlmIChvaWQgIT0gbnVsbCkKICAgICAgICAgICAgICAgIHZhbCA9\nIGpvaW4uZ2V0Sm9pblZhbHVlKG9pZCwgdG9Db2xzW2ldLCAoSkRCQ1N0b3Jl\nKSB0by4KICAgICAgICAgICAgICAgICAgICBnZXRDb250ZXh0KCkuZ2V0U3Rv\ncmVNYW5hZ2VyKCkuZ2V0SW5uZXJtb3N0RGVsZWdhdGUoKSk7CiAgICAgICAg\nICAgIGVsc2UKICAgICAgICAgICAgICAgIHZhbCA9IGpvaW4uZ2V0Sm9pblZh\nbHVlKHRvLCB0b0NvbHNbaV0sIChKREJDU3RvcmUpIHRvLgogICAgICAgICAg\nICAgICAgICAgIGdldENvbnRleHQoKS5nZXRTdG9yZU1hbmFnZXIoKS5nZXRJ\nbm5lcm1vc3REZWxlZ2F0ZSgpKTsKICAgICAgICAgICAgICAgIAogICAgICAg\nICAgICBpZiAoc2V0ICYmIHZhbCA9PSBudWxsKSB7CiAgICAgICAgICAgICAg\nICBpZiAoY2FuU2V0KGlvLCBpLCB0cnVlKSkKICAgICAgICAgICAgICAgICAg\nICBzZXROdWxsKGZyb21Db2xzW2ldKTsKICAgICAgICAgICAgfSBlbHNlIGlm\nIChzZXQgJiYgdmFsIGluc3RhbmNlb2YgUmF3KQogICAgICAgICAgICAgICAg\nc2V0UmF3KGZyb21Db2xzW2ldLCB2YWwudG9TdHJpbmcoKSk7CiAgICAgICAg\nICAgIGVsc2UgaWYgKHNldCkKICAgICAgICAgICAgICAgIHNldE9iamVjdChm\ncm9tQ29sc1tpXSwgdmFsLCB0b0NvbHNbaV0uZ2V0SmF2YVR5cGUoKSwgZmFs\nc2UpOwogICAgICAgICAgICBlbHNlIGlmICh2YWwgPT0gbnVsbCkKICAgICAg\nICAgICAgICAgIHdoZXJlTnVsbChmcm9tQ29sc1tpXSk7CiAgICAgICAgICAg\nIGVsc2UgaWYgKHZhbCBpbnN0YW5jZW9mIFJhdykKICAgICAgICAgICAgICAg\nIHdoZXJlUmF3KGZyb21Db2xzW2ldLCB2YWwudG9TdHJpbmcoKSk7CiAgICAg\nICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIHdoZXJlT2JqZWN0KGZyb21D\nb2xzW2ldLCB2YWwsIHRvQ29sc1tpXS5nZXRKYXZhVHlwZSgpKTsKICAgICAg\nICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gdHJ1ZSBpZiBhbnkg\nb2YgdGhlIGdpdmVuIGNvbHVtbiBpbmRleGVzIGFyZSBzZXR0YWJsZS4KICAg\nICAqLwogICAgcHJvdGVjdGVkIGJvb2xlYW4gY2FuU2V0QW55KENvbHVtbklP\nIGlvLCBpbnQgaSwgYm9vbGVhbiBudWxsVmFsdWUpIHsKICAgICAgICBpZiAo\naW8gPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAg\naWYgKF9hY3Rpb24gPT0gQUNUSU9OX0lOU0VSVCkKICAgICAgICAgICAgcmV0\ndXJuIGlvLmlzQW55SW5zZXJ0YWJsZShpLCBudWxsVmFsdWUpOwogICAgICAg\nIGlmIChfYWN0aW9uID09IEFDVElPTl9VUERBVEUpCiAgICAgICAgICAgIHJl\ndHVybiBpby5pc0FueVVwZGF0YWJsZShpLCBudWxsVmFsdWUpOwogICAgICAg\nIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRy\ndWUgaWYgdGhlIGdpdmVuIGNvbHVtbiBpbmRleCBpcyBzZXR0YWJsZS4KICAg\nICAqLwogICAgcHJvdGVjdGVkIGJvb2xlYW4gY2FuU2V0KENvbHVtbklPIGlv\nLCBpbnQgaSwgYm9vbGVhbiBudWxsVmFsdWUpIHsKICAgICAgICBpZiAoaW8g\nPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgaWYg\nKF9hY3Rpb24gPT0gQUNUSU9OX0lOU0VSVCkKICAgICAgICAgICAgcmV0dXJu\nIGlvLmlzSW5zZXJ0YWJsZShpLCBudWxsVmFsdWUpOwogICAgICAgIGlmIChf\nYWN0aW9uID09IEFDVElPTl9VUERBVEUpCiAgICAgICAgICAgIHJldHVybiBp\nby5pc1VwZGF0YWJsZShpLCBudWxsVmFsdWUpOwogICAgICAgIHJldHVybiB0\ncnVlOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldFJlbGF0aW9uSWQoQ29s\ndW1uIGNvbCwgT3BlbkpQQVN0YXRlTWFuYWdlciBzbSwKICAgICAgICBSZWxh\ndGlvbklkIHJlbCkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAg\nICAgICBzZXRPYmplY3QoY29sLCByZWwudG9SZWxhdGlvbkRhdGFTdG9yZVZh\nbHVlKHNtLCBjb2wpLAogICAgICAgICAgICBjb2wuZ2V0SmF2YVR5cGUoKSwg\nZmFsc2UpOwogICAgfQoKICAgIC8qKgogICAgICogQ2xlYXIgYSBjaXJjdWxh\nciByZWxhdGlvbiBpZC4KICAgICAqLwogICAgcHVibGljIHZvaWQgY2xlYXJS\nZWxhdGlvbklkKENvbHVtbiBjb2wpCiAgICAgICAgdGhyb3dzIFNRTEV4Y2Vw\ndGlvbiB7CiAgICAgICAgX3NxbCA9IG51bGw7CiAgICAgICAgX3ZhbHNbZ2V0\nU2V0SW5kZXgoY29sKV0gPSBudWxsOwogICAgfQoKICAgIHB1YmxpYyB2b2lk\nIHNldEFycmF5KENvbHVtbiBjb2wsIEFycmF5IHZhbCkKICAgICAgICB0aHJv\nd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBzZXRPYmplY3QoY29sLCB2YWws\nIEphdmFTUUxUeXBlcy5BUlJBWSwgZmFsc2UpOwogICAgfQoKICAgIHB1Ymxp\nYyB2b2lkIHNldEFzY2lpU3RyZWFtKENvbHVtbiBjb2wsIElucHV0U3RyZWFt\nIHZhbCwgaW50IGxlbmd0aCkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9u\nIHsKICAgICAgICBzZXRPYmplY3QoY29sLCAodmFsID09IG51bGwpID8gbnVs\nbCA6IG5ldyBTaXplZCh2YWwsIGxlbmd0aCksCiAgICAgICAgICAgIEphdmFT\nUUxUeXBlcy5BU0NJSV9TVFJFQU0sIGZhbHNlKTsKICAgIH0KCiAgICBwdWJs\naWMgdm9pZCBzZXRCaWdEZWNpbWFsKENvbHVtbiBjb2wsIEJpZ0RlY2ltYWwg\ndmFsKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIHNl\ndE9iamVjdChjb2wsIHZhbCwgSmF2YVR5cGVzLkJJR0RFQ0lNQUwsIGZhbHNl\nKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRCaWdJbnRlZ2VyKENvbHVt\nbiBjb2wsIEJpZ0ludGVnZXIgdmFsKQogICAgICAgIHRocm93cyBTUUxFeGNl\ncHRpb24gewogICAgICAgIHNldE9iamVjdChjb2wsIHZhbCwgSmF2YVR5cGVz\nLkJJR0lOVEVHRVIsIGZhbHNlKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBz\nZXRCaW5hcnlTdHJlYW0oQ29sdW1uIGNvbCwgSW5wdXRTdHJlYW0gdmFsLCBp\nbnQgbGVuZ3RoKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAg\nICAgIHNldE9iamVjdChjb2wsICh2YWwgPT0gbnVsbCkgPyBudWxsIDogbmV3\nIFNpemVkKHZhbCwgbGVuZ3RoKSwKICAgICAgICAgICAgSmF2YVNRTFR5cGVz\nLkJJTkFSWV9TVFJFQU0sIGZhbHNlKTsKICAgIH0KCiAgICBwdWJsaWMgdm9p\nZCBzZXRCbG9iKENvbHVtbiBjb2wsIEJsb2IgdmFsKQogICAgICAgIHRocm93\ncyBTUUxFeGNlcHRpb24gewogICAgICAgIHNldE9iamVjdChjb2wsIHZhbCwg\nSmF2YVNRTFR5cGVzLkJMT0IsIGZhbHNlKTsKICAgIH0KCiAgICBwdWJsaWMg\ndm9pZCBzZXRCb29sZWFuKENvbHVtbiBjb2wsIGJvb2xlYW4gdmFsKQogICAg\nICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIHNldE9iamVjdChj\nb2wsICgodmFsKSA/IEJvb2xlYW4uVFJVRSA6IEJvb2xlYW4uRkFMU0UpLAog\nICAgICAgICAgICBKYXZhVHlwZXMuQk9PTEVBTiwgZmFsc2UpOwogICAgfQoK\nICAgIHB1YmxpYyB2b2lkIHNldEJ5dGUoQ29sdW1uIGNvbCwgYnl0ZSB2YWwp\nCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgc2V0T2Jq\nZWN0KGNvbCwgbmV3IEJ5dGUodmFsKSwgSmF2YVR5cGVzLkJZVEUsIGZhbHNl\nKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRCeXRlcyhDb2x1bW4gY29s\nLCBieXRlW10gdmFsKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewog\nICAgICAgIHNldE9iamVjdChjb2wsIHZhbCwgSmF2YVNRTFR5cGVzLkJZVEVT\nLCBmYWxzZSk7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0Q2FsZW5kYXIo\nQ29sdW1uIGNvbCwgQ2FsZW5kYXIgdmFsKQogICAgICAgIHRocm93cyBTUUxF\neGNlcHRpb24gewogICAgICAgIHNldE9iamVjdChjb2wsIHZhbCwgSmF2YVR5\ncGVzLkNBTEVOREFSLCBmYWxzZSk7CiAgICB9CgogICAgcHVibGljIHZvaWQg\nc2V0Q2hhcihDb2x1bW4gY29sLCBjaGFyIHZhbCkKICAgICAgICB0aHJvd3Mg\nU1FMRXhjZXB0aW9uIHsKICAgICAgICBzZXRPYmplY3QoY29sLCBuZXcgQ2hh\ncmFjdGVyKHZhbCksIEphdmFUeXBlcy5DSEFSLCBmYWxzZSk7CiAgICB9Cgog\nICAgcHVibGljIHZvaWQgc2V0Q2hhcmFjdGVyU3RyZWFtKENvbHVtbiBjb2ws\nIFJlYWRlciB2YWwsIGludCBsZW5ndGgpCiAgICAgICAgdGhyb3dzIFNRTEV4\nY2VwdGlvbiB7CiAgICAgICAgc2V0T2JqZWN0KGNvbCwgKHZhbCA9PSBudWxs\nKSA/IG51bGwgOiBuZXcgU2l6ZWQodmFsLCBsZW5ndGgpLAogICAgICAgICAg\nICBKYXZhU1FMVHlwZXMuQ0hBUl9TVFJFQU0sIGZhbHNlKTsKICAgIH0KCiAg\nICBwdWJsaWMgdm9pZCBzZXRDbG9iKENvbHVtbiBjb2wsIENsb2IgdmFsKQog\nICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIHNldE9iamVj\ndChjb2wsIHZhbCwgSmF2YVNRTFR5cGVzLkNMT0IsIGZhbHNlKTsKICAgIH0K\nCiAgICBwdWJsaWMgdm9pZCBzZXREYXRlKENvbHVtbiBjb2wsIERhdGUgdmFs\nKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIHNldE9i\namVjdChjb2wsIHZhbCwgSmF2YVR5cGVzLkRBVEUsIGZhbHNlKTsKICAgIH0K\nCiAgICBwdWJsaWMgdm9pZCBzZXREYXRlKENvbHVtbiBjb2wsIGphdmEuc3Fs\nLkRhdGUgdmFsLCBDYWxlbmRhciBjYWwpCiAgICAgICAgdGhyb3dzIFNRTEV4\nY2VwdGlvbiB7CiAgICAgICAgT2JqZWN0IG9iajsKICAgICAgICBpZiAodmFs\nID09IG51bGwgfHwgY2FsID09IG51bGwpCiAgICAgICAgICAgIG9iaiA9IHZh\nbDsKICAgICAgICBlbHNlCiAgICAgICAgICAgIG9iaiA9IG5ldyBDYWxlbmRh\ncmQodmFsLCBjYWwpOwogICAgICAgIHNldE9iamVjdChjb2wsIG9iaiwgSmF2\nYVNRTFR5cGVzLlNRTF9EQVRFLCBmYWxzZSk7CiAgICB9CgogICAgcHVibGlj\nIHZvaWQgc2V0RG91YmxlKENvbHVtbiBjb2wsIGRvdWJsZSB2YWwpCiAgICAg\nICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgc2V0T2JqZWN0KGNv\nbCwgbmV3IERvdWJsZSh2YWwpLCBKYXZhVHlwZXMuRE9VQkxFLCBmYWxzZSk7\nCiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0RmxvYXQoQ29sdW1uIGNvbCwg\nZmxvYXQgdmFsKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAg\nICAgIHNldE9iamVjdChjb2wsIG5ldyBGbG9hdCh2YWwpLCBKYXZhVHlwZXMu\nRkxPQVQsIGZhbHNlKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRJbnQo\nQ29sdW1uIGNvbCwgaW50IHZhbCkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0\naW9uIHsKICAgICAgICBzZXRPYmplY3QoY29sLCBOdW1iZXJzLnZhbHVlT2Yo\ndmFsKSwgSmF2YVR5cGVzLklOVCwgZmFsc2UpOwogICAgfQoKICAgIHB1Ymxp\nYyB2b2lkIHNldExvbmcoQ29sdW1uIGNvbCwgbG9uZyB2YWwpCiAgICAgICAg\ndGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgc2V0T2JqZWN0KGNvbCwg\nTnVtYmVycy52YWx1ZU9mKHZhbCksIEphdmFUeXBlcy5MT05HLCBmYWxzZSk7\nCiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0TG9jYWxlKENvbHVtbiBjb2ws\nIExvY2FsZSB2YWwpCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAg\nICAgICAgc2V0T2JqZWN0KGNvbCwgdmFsLCBKYXZhVHlwZXMuTE9DQUxFLCBm\nYWxzZSk7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0TnVsbChDb2x1bW4g\nY29sKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIHNl\ndE51bGwoY29sLCBmYWxzZSk7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0\nTnVsbChDb2x1bW4gY29sLCBib29sZWFuIG92ZXJyaWRlRGVmYXVsdCkKICAg\nICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBzZXRPYmplY3Qo\nY29sLCBudWxsLCBjb2wuZ2V0SmF2YVR5cGUoKSwgb3ZlcnJpZGVEZWZhdWx0\nKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZXROdW1iZXIoQ29sdW1uIGNv\nbCwgTnVtYmVyIHZhbCkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsK\nICAgICAgICBzZXRPYmplY3QoY29sLCB2YWwsIEphdmFUeXBlcy5OVU1CRVIs\nIGZhbHNlKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRSYXcoQ29sdW1u\nIGNvbCwgU3RyaW5nIHZhbCkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9u\nIHsKICAgICAgICBzZXRPYmplY3QoY29sLCB2YWwsIFJBVywgZmFsc2UpOwog\nICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldFNob3J0KENvbHVtbiBjb2wsIHNo\nb3J0IHZhbCkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAg\nICBzZXRPYmplY3QoY29sLCBuZXcgU2hvcnQodmFsKSwgSmF2YVR5cGVzLlNI\nT1JULCBmYWxzZSk7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0U3RyaW5n\nKENvbHVtbiBjb2wsIFN0cmluZyB2YWwpCiAgICAgICAgdGhyb3dzIFNRTEV4\nY2VwdGlvbiB7CiAgICAgICAgc2V0T2JqZWN0KGNvbCwgdmFsLCBKYXZhVHlw\nZXMuU1RSSU5HLCBmYWxzZSk7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0\nVGltZShDb2x1bW4gY29sLCBUaW1lIHZhbCwgQ2FsZW5kYXIgY2FsKQogICAg\nICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIE9iamVjdCBvYmo7\nCiAgICAgICAgaWYgKHZhbCA9PSBudWxsIHx8IGNhbCA9PSBudWxsKQogICAg\nICAgICAgICBvYmogPSB2YWw7CiAgICAgICAgZWxzZQogICAgICAgICAgICBv\nYmogPSBuZXcgQ2FsZW5kYXJkKHZhbCwgY2FsKTsKICAgICAgICBzZXRPYmpl\nY3QoY29sLCBvYmosIEphdmFTUUxUeXBlcy5USU1FLCBmYWxzZSk7CiAgICB9\nCgogICAgcHVibGljIHZvaWQgc2V0VGltZXN0YW1wKENvbHVtbiBjb2wsIFRp\nbWVzdGFtcCB2YWwsIENhbGVuZGFyIGNhbCkKICAgICAgICB0aHJvd3MgU1FM\nRXhjZXB0aW9uIHsKICAgICAgICBPYmplY3Qgb2JqOwogICAgICAgIGlmICh2\nYWwgPT0gbnVsbCB8fCBjYWwgPT0gbnVsbCkKICAgICAgICAgICAgb2JqID0g\ndmFsOwogICAgICAgIGVsc2UKICAgICAgICAgICAgb2JqID0gbmV3IENhbGVu\nZGFyZCh2YWwsIGNhbCk7CiAgICAgICAgc2V0T2JqZWN0KGNvbCwgb2JqLCBK\nYXZhU1FMVHlwZXMuVElNRVNUQU1QLCBmYWxzZSk7CiAgICB9CgogICAgcHVi\nbGljIHZvaWQgc2V0T2JqZWN0KENvbHVtbiBjb2wsIE9iamVjdCB2YWwpCiAg\nICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgaWYgKHZhbCBp\nbnN0YW5jZW9mIFJhdykKICAgICAgICAgICAgc2V0T2JqZWN0KGNvbCwgdmFs\nLCBSQVcsIGZhbHNlKTsKICAgICAgICBlbHNlCiAgICAgICAgICAgIHNldE9i\namVjdChjb2wsIHZhbCwgY29sLmdldEphdmFUeXBlKCksIGZhbHNlKTsKICAg\nIH0KCiAgICBwdWJsaWMgdm9pZCB3aGVyZUFycmF5KENvbHVtbiBjb2wsIEFy\ncmF5IHZhbCkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAg\nICB3aGVyZU9iamVjdChjb2wsIHZhbCwgSmF2YVNRTFR5cGVzLlNRTF9BUlJB\nWSk7CiAgICB9CgogICAgcHVibGljIHZvaWQgd2hlcmVBc2NpaVN0cmVhbShD\nb2x1bW4gY29sLCBJbnB1dFN0cmVhbSB2YWwsIGludCBsZW5ndGgpCiAgICAg\nICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgd2hlcmVPYmplY3Qo\nY29sLCAodmFsID09IG51bGwpID8gbnVsbCA6IG5ldyBTaXplZCh2YWwsIGxl\nbmd0aCksCiAgICAgICAgICAgIEphdmFTUUxUeXBlcy5BU0NJSV9TVFJFQU0p\nOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHdoZXJlQmlnRGVjaW1hbChDb2x1\nbW4gY29sLCBCaWdEZWNpbWFsIHZhbCkKICAgICAgICB0aHJvd3MgU1FMRXhj\nZXB0aW9uIHsKICAgICAgICB3aGVyZU9iamVjdChjb2wsIHZhbCwgSmF2YVR5\ncGVzLkJJR0RFQ0lNQUwpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHdoZXJl\nQmlnSW50ZWdlcihDb2x1bW4gY29sLCBCaWdJbnRlZ2VyIHZhbCkKICAgICAg\nICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICB3aGVyZU9iamVjdChj\nb2wsIHZhbCwgSmF2YVR5cGVzLkJJR0lOVEVHRVIpOwogICAgfQoKICAgIHB1\nYmxpYyB2b2lkIHdoZXJlQmluYXJ5U3RyZWFtKENvbHVtbiBjb2wsIElucHV0\nU3RyZWFtIHZhbCwgaW50IGxlbmd0aCkKICAgICAgICB0aHJvd3MgU1FMRXhj\nZXB0aW9uIHsKICAgICAgICB3aGVyZU9iamVjdChjb2wsICh2YWwgPT0gbnVs\nbCkgPyBudWxsIDogbmV3IFNpemVkKHZhbCwgbGVuZ3RoKSwKICAgICAgICAg\nICAgSmF2YVNRTFR5cGVzLkJJTkFSWV9TVFJFQU0pOwogICAgfQoKICAgIHB1\nYmxpYyB2b2lkIHdoZXJlQmxvYihDb2x1bW4gY29sLCBCbG9iIHZhbCkKICAg\nICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICB3aGVyZU9iamVj\ndChjb2wsIHZhbCwgSmF2YVNRTFR5cGVzLkJMT0IpOwogICAgfQoKICAgIHB1\nYmxpYyB2b2lkIHdoZXJlQm9vbGVhbihDb2x1bW4gY29sLCBib29sZWFuIHZh\nbCkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICB3aGVy\nZU9iamVjdChjb2wsICgodmFsKSA/IEJvb2xlYW4uVFJVRSA6IEJvb2xlYW4u\nRkFMU0UpLAogICAgICAgICAgICBKYXZhVHlwZXMuQk9PTEVBTik7CiAgICB9\nCgogICAgcHVibGljIHZvaWQgd2hlcmVCeXRlKENvbHVtbiBjb2wsIGJ5dGUg\ndmFsKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIHdo\nZXJlT2JqZWN0KGNvbCwgbmV3IEJ5dGUodmFsKSwgSmF2YVR5cGVzLkJZVEUp\nOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHdoZXJlQnl0ZXMoQ29sdW1uIGNv\nbCwgYnl0ZVtdIHZhbCkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsK\nICAgICAgICB3aGVyZU9iamVjdChjb2wsIHZhbCwgSmF2YVNRTFR5cGVzLkJZ\nVEVTKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCB3aGVyZUNhbGVuZGFyKENv\nbHVtbiBjb2wsIENhbGVuZGFyIHZhbCkKICAgICAgICB0aHJvd3MgU1FMRXhj\nZXB0aW9uIHsKICAgICAgICB3aGVyZU9iamVjdChjb2wsIHZhbCwgSmF2YVR5\ncGVzLkNBTEVOREFSKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCB3aGVyZUNo\nYXIoQ29sdW1uIGNvbCwgY2hhciB2YWwpCiAgICAgICAgdGhyb3dzIFNRTEV4\nY2VwdGlvbiB7CiAgICAgICAgd2hlcmVPYmplY3QoY29sLCBuZXcgQ2hhcmFj\ndGVyKHZhbCksIEphdmFUeXBlcy5DSEFSKTsKICAgIH0KCiAgICBwdWJsaWMg\ndm9pZCB3aGVyZUNoYXJhY3RlclN0cmVhbShDb2x1bW4gY29sLCBSZWFkZXIg\ndmFsLCBpbnQgbGVuZ3RoKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24g\newogICAgICAgIHdoZXJlT2JqZWN0KGNvbCwgKHZhbCA9PSBudWxsKSA/IG51\nbGwgOiBuZXcgU2l6ZWQodmFsLCBsZW5ndGgpLAogICAgICAgICAgICBKYXZh\nU1FMVHlwZXMuQ0hBUl9TVFJFQU0pOwogICAgfQoKICAgIHB1YmxpYyB2b2lk\nIHdoZXJlQ2xvYihDb2x1bW4gY29sLCBDbG9iIHZhbCkKICAgICAgICB0aHJv\nd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICB3aGVyZU9iamVjdChjb2wsIHZh\nbCwgSmF2YVNRTFR5cGVzLkNMT0IpOwogICAgfQoKICAgIHB1YmxpYyB2b2lk\nIHdoZXJlRGF0ZShDb2x1bW4gY29sLCBEYXRlIHZhbCkKICAgICAgICB0aHJv\nd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICB3aGVyZU9iamVjdChjb2wsIHZh\nbCwgSmF2YVR5cGVzLkRBVEUpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHdo\nZXJlRGF0ZShDb2x1bW4gY29sLCBqYXZhLnNxbC5EYXRlIHZhbCwgQ2FsZW5k\nYXIgY2FsKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAg\nIE9iamVjdCBvYmo7CiAgICAgICAgaWYgKHZhbCA9PSBudWxsIHx8IGNhbCA9\nPSBudWxsKQogICAgICAgICAgICBvYmogPSB2YWw7CiAgICAgICAgZWxzZQog\nICAgICAgICAgICBvYmogPSBuZXcgQ2FsZW5kYXJkKHZhbCwgY2FsKTsKICAg\nICAgICB3aGVyZU9iamVjdChjb2wsIG9iaiwgSmF2YVNRTFR5cGVzLlNRTF9E\nQVRFKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCB3aGVyZURvdWJsZShDb2x1\nbW4gY29sLCBkb3VibGUgdmFsKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRp\nb24gewogICAgICAgIHdoZXJlT2JqZWN0KGNvbCwgbmV3IERvdWJsZSh2YWwp\nLCBKYXZhVHlwZXMuRE9VQkxFKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCB3\naGVyZUZsb2F0KENvbHVtbiBjb2wsIGZsb2F0IHZhbCkKICAgICAgICB0aHJv\nd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICB3aGVyZU9iamVjdChjb2wsIG5l\ndyBGbG9hdCh2YWwpLCBKYXZhVHlwZXMuRkxPQVQpOwogICAgfQoKICAgIHB1\nYmxpYyB2b2lkIHdoZXJlSW50KENvbHVtbiBjb2wsIGludCB2YWwpCiAgICAg\nICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgd2hlcmVPYmplY3Qo\nY29sLCBOdW1iZXJzLnZhbHVlT2YodmFsKSwgSmF2YVR5cGVzLklOVCk7CiAg\nICB9CgogICAgcHVibGljIHZvaWQgd2hlcmVMb25nKENvbHVtbiBjb2wsIGxv\nbmcgdmFsKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAg\nIHdoZXJlT2JqZWN0KGNvbCwgTnVtYmVycy52YWx1ZU9mKHZhbCksIEphdmFU\neXBlcy5MT05HKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCB3aGVyZUxvY2Fs\nZShDb2x1bW4gY29sLCBMb2NhbGUgdmFsKQogICAgICAgIHRocm93cyBTUUxF\neGNlcHRpb24gewogICAgICAgIHdoZXJlT2JqZWN0KGNvbCwgdmFsLCBKYXZh\nVHlwZXMuTE9DQUxFKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCB3aGVyZU51\nbGwoQ29sdW1uIGNvbCkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsK\nICAgICAgICB3aGVyZU9iamVjdChjb2wsIG51bGwsIGNvbC5nZXRKYXZhVHlw\nZSgpKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCB3aGVyZU51bWJlcihDb2x1\nbW4gY29sLCBOdW1iZXIgdmFsKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRp\nb24gewogICAgICAgIHdoZXJlT2JqZWN0KGNvbCwgdmFsLCBKYXZhVHlwZXMu\nTlVNQkVSKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCB3aGVyZVJhdyhDb2x1\nbW4gY29sLCBTdHJpbmcgdmFsKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRp\nb24gewogICAgICAgIHdoZXJlT2JqZWN0KGNvbCwgdmFsLCBSQVcpOwogICAg\nfQoKICAgIHB1YmxpYyB2b2lkIHdoZXJlU2hvcnQoQ29sdW1uIGNvbCwgc2hv\ncnQgdmFsKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAg\nIHdoZXJlT2JqZWN0KGNvbCwgbmV3IFNob3J0KHZhbCksIEphdmFUeXBlcy5T\nSE9SVCk7CiAgICB9CgogICAgcHVibGljIHZvaWQgd2hlcmVTdHJpbmcoQ29s\ndW1uIGNvbCwgU3RyaW5nIHZhbCkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0\naW9uIHsKICAgICAgICB3aGVyZU9iamVjdChjb2wsIHZhbCwgSmF2YVR5cGVz\nLlNUUklORyk7CiAgICB9CgogICAgcHVibGljIHZvaWQgd2hlcmVUaW1lKENv\nbHVtbiBjb2wsIFRpbWUgdmFsLCBDYWxlbmRhciBjYWwpCiAgICAgICAgdGhy\nb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgT2JqZWN0IG9iajsKICAgICAg\nICBpZiAodmFsID09IG51bGwgfHwgY2FsID09IG51bGwpCiAgICAgICAgICAg\nIG9iaiA9IHZhbDsKICAgICAgICBlbHNlCiAgICAgICAgICAgIG9iaiA9IG5l\ndyBDYWxlbmRhcmQodmFsLCBjYWwpOwogICAgICAgIHdoZXJlT2JqZWN0KGNv\nbCwgb2JqLCBKYXZhU1FMVHlwZXMuVElNRSk7CiAgICB9CgogICAgcHVibGlj\nIHZvaWQgd2hlcmVUaW1lc3RhbXAoQ29sdW1uIGNvbCwgVGltZXN0YW1wIHZh\nbCwgQ2FsZW5kYXIgY2FsKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24g\newogICAgICAgIE9iamVjdCBvYmo7CiAgICAgICAgaWYgKHZhbCA9PSBudWxs\nIHx8IGNhbCA9PSBudWxsKQogICAgICAgICAgICBvYmogPSB2YWw7CiAgICAg\nICAgZWxzZQogICAgICAgICAgICBvYmogPSBuZXcgQ2FsZW5kYXJkKHZhbCwg\nY2FsKTsKICAgICAgICB3aGVyZU9iamVjdChjb2wsIG9iaiwgSmF2YVNRTFR5\ncGVzLlRJTUVTVEFNUCk7CiAgICB9CgogICAgcHVibGljIHZvaWQgd2hlcmVP\nYmplY3QoQ29sdW1uIGNvbCwgT2JqZWN0IHZhbCkKICAgICAgICB0aHJvd3Mg\nU1FMRXhjZXB0aW9uIHsKICAgICAgICBpZiAodmFsIGluc3RhbmNlb2YgUmF3\nKQogICAgICAgICAgICB3aGVyZU9iamVjdChjb2wsIHZhbCwgUkFXKTsKICAg\nICAgICBlbHNlCiAgICAgICAgICAgIHdoZXJlT2JqZWN0KGNvbCwgdmFsLCBj\nb2wuZ2V0SmF2YVR5cGUoKSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBBbGwg\nc2V0IGNvbHVtbiBtZXRob2RzIGRlbGVnYXRlIHRvIHRoaXMgb25lLiBTZXQg\ndGhlIGdpdmVuIG9iamVjdAogICAgICogdW5sZXNzIHRoaXMgaXMgYW4gaW5z\nZXJ0IGFuZCB0aGUgZ2l2ZW4gY29sdW1uIGlzIGF1dG8tYXNzaWduZWQuCiAg\nICAgKi8KICAgIHByb3RlY3RlZCB2b2lkIHNldE9iamVjdChDb2x1bW4gY29s\nLCBPYmplY3QgdmFsLCBpbnQgbWV0YVR5cGUsCiAgICAgICAgYm9vbGVhbiBv\ndmVycmlkZURlZmF1bHQpCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7\nCiAgICAgICAgLy8gbmV2ZXIgc2V0IGF1dG8gaW5jcmVtZW50IGNvbHVtbnMg\nYW5kIGhvbm9yIGNvbHVtbiBkZWZhdWx0cwogICAgICAgIGlmIChfYWN0aW9u\nID09IEFDVElPTl9JTlNFUlQpIHsKICAgICAgICAgICAgaWYgKGNvbC5pc0F1\ndG9Bc3NpZ25lZCgpKSB7CiAgICAgICAgICAgIAkvLyBPUEVOSlBBLTM0OTog\ndmFsaWRhdGUgYmVjYXVzZSB0aGlzIGNhbiBiZSB0aGUgb25seSBjb2x1bW4K\nICAgICAgICAgICAgCXNldFZhbGlkKHRydWUpOwogICAgICAgICAgICAgICAg\ncmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmICghb3ZlcnJp\nZGVEZWZhdWx0ICYmIHZhbCA9PSBudWxsIAogICAgICAgICAgICAgICAgJiYg\nY29sLmdldERlZmF1bHRTdHJpbmcoKSAhPSBudWxsKQogICAgICAgICAgICAg\nICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICBpZiAodmFsID09IG51bGwg\nJiYgY29sLmlzTm90TnVsbCgpKQogICAgICAgICAgICB2YWwgPSBKYXZhU1FM\nVHlwZXMuZ2V0RW1wdHlWYWx1ZShjb2wuZ2V0SmF2YVR5cGUoKSk7CiAgICAg\nICAgZmx1c2goY29sLCB2YWwsIG1ldGFUeXBlLCB0cnVlKTsKICAgIH0KCiAg\nICAvKioKICAgICAqIEFsbCB3aGVyZSBjb2x1bW4gbWV0aG9kcyBkZWxlZ2F0\nZSB0byB0aGlzIG9uZS4KICAgICAqLwogICAgcHJvdGVjdGVkIHZvaWQgd2hl\ncmVPYmplY3QoQ29sdW1uIGNvbCwgT2JqZWN0IHZhbCwgaW50IG1ldGFUeXBl\nKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIGZsdXNo\nKGNvbCwgdmFsLCBtZXRhVHlwZSwgZmFsc2UpOwogICAgfQoKICAgIC8qKgog\nICAgICogRmx1c2ggdGhlIGdpdmVuIHZhbHVlIGFzIGEgc2V0IG9yIHdoZXJl\nIGNvbmRpdGlvbi4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIGZsdXNoKENv\nbHVtbiBjb2wsIE9iamVjdCB2YWwsIGludCBtZXRhVHlwZSwgYm9vbGVhbiBz\nZXQpIHsKICAgICAgICBpbnQgaWR4ID0gKHNldCkgPyBnZXRTZXRJbmRleChj\nb2wpIDogZ2V0V2hlcmVJbmRleChjb2wpOwogICAgICAgIF90eXBlc1tpZHhd\nID0gbWV0YVR5cGU7CiAgICAgICAgaWYgKHZhbCA9PSBudWxsKQogICAgICAg\nICAgICBfdmFsc1tpZHhdID0gTlVMTDsKICAgICAgICBlbHNlCiAgICAgICAg\nICAgIF92YWxzW2lkeF0gPSB2YWw7CiAgICAgICAgaWYgKHNldCB8fCBfYWN0\naW9uID09IEFDVElPTl9ERUxFVEUpCiAgICAgICAgICAgIHNldFZhbGlkKHRy\ndWUpOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRoZSBTUUwgZm9y\nIHRoZSBvcGVyYXRpb24gb24gdGhpcyByb3cuCiAgICAgKi8KICAgIHB1Ymxp\nYyBTdHJpbmcgZ2V0U1FMKERCRGljdGlvbmFyeSBkaWN0KSB7CiAgICAgICAg\naWYgKCFpc1ZhbGlkKCkpCiAgICAgICAgICAgIHJldHVybiAiIjsKICAgICAg\nICBpZiAoX3NxbCA9PSBudWxsKQogICAgICAgICAgICBfc3FsID0gZ2VuZXJh\ndGVTUUwoZGljdCk7CiAgICAgICAgcmV0dXJuIF9zcWw7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBHZW5lcmF0ZSB0aGUgU1FMIGZvciB0aGlzIHJvdzsgdGhl\nIHJlc3VsdCBvZiB0aGlzIG1ldGhvZCBpcyBjYWNoZWQuCiAgICAgKi8KICAg\nIHByb3RlY3RlZCBTdHJpbmcgZ2VuZXJhdGVTUUwoREJEaWN0aW9uYXJ5IGRp\nY3QpIHsKICAgICAgICBzd2l0Y2ggKGdldEFjdGlvbigpKSB7CiAgICAgICAg\nICAgIGNhc2UgQUNUSU9OX1VQREFURToKICAgICAgICAgICAgICAgIHJldHVy\nbiBnZXRVcGRhdGVTUUwoZGljdCk7CiAgICAgICAgICAgIGNhc2UgQUNUSU9O\nX0lOU0VSVDoKICAgICAgICAgICAgICAgIHJldHVybiBnZXRJbnNlcnRTUUwo\nZGljdCk7CiAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgICBy\nZXR1cm4gZ2V0RGVsZXRlU1FMKGRpY3QpOwogICAgICAgIH0KICAgIH0KCiAg\nICAvKioKICAgICAqIFJldHVybiB0aGUgU1FMIGZvciBhIHByZXBhcmVkIHN0\nYXRlbWVudCB1cGRhdGUgb24gdGhpcyByb3cuCiAgICAgKi8KICAgIHByaXZh\ndGUgU3RyaW5nIGdldFVwZGF0ZVNRTChEQkRpY3Rpb25hcnkgZGljdCkgewog\nICAgICAgIFN0cmluZ0J1aWxkZXIgYnVmID0gbmV3IFN0cmluZ0J1aWxkZXIo\nKTsKICAgICAgICBidWYuYXBwZW5kKCJVUERBVEUgIikuYXBwZW5kKGRpY3Qu\nZ2V0RnVsbE5hbWUoZ2V0VGFibGUoKSwgZmFsc2UpKS4KICAgICAgICAgICAg\nYXBwZW5kKCIgU0VUICIpOwoKICAgICAgICBib29sZWFuIGhhc1ZhbCA9IGZh\nbHNlOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgX2NvbHMubGVuZ3Ro\nOyBpKyspIHsKICAgICAgICAgICAgaWYgKF92YWxzW2ldID09IG51bGwpCiAg\nICAgICAgICAgICAgICBjb250aW51ZTsKCiAgICAgICAgICAgIGlmIChoYXNW\nYWwpCiAgICAgICAgICAgICAgICBidWYuYXBwZW5kKCIsICIpOwogICAgICAg\nICAgICBidWYuYXBwZW5kKGRpY3QuZ2V0Q29sdW1uREJOYW1lKF9jb2xzW2ld\nKSk7CiAgICAgICAgICAgIGlmIChfdHlwZXNbaV0gPT0gUkFXKQogICAgICAg\nICAgICAgICAgYnVmLmFwcGVuZCgiID0gIikuYXBwZW5kKF92YWxzW2ldKTsK\nICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgYnVmLmFwcGVuZCgi\nID0gPyIpOwogICAgICAgICAgICBoYXNWYWwgPSB0cnVlOwogICAgICAgIH0K\nCiAgICAgICAgYXBwZW5kV2hlcmUoYnVmLCBkaWN0KTsKICAgICAgICByZXR1\ncm4gYnVmLnRvU3RyaW5nKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1\ncm4gdGhlIFNRTCBmb3IgYSBwcmVwYXJlZCBzdGF0ZW1lbnQgaW5zZXJ0IG9u\nIHRoaXMgcm93LgogICAgICovCiAgICBwcml2YXRlIFN0cmluZyBnZXRJbnNl\ncnRTUUwoREJEaWN0aW9uYXJ5IGRpY3QpIHsKICAgICAgICBTdHJpbmdCdWls\nZGVyIGJ1ZiA9IG5ldyBTdHJpbmdCdWlsZGVyKCk7CiAgICAgICAgU3RyaW5n\nQnVpbGRlciB2YWxzID0gbmV3IFN0cmluZ0J1aWxkZXIoKTsKICAgICAgICBi\ndWYuYXBwZW5kKCJJTlNFUlQgSU5UTyAiKS4KICAgICAgICAgICAgYXBwZW5k\nKGRpY3QuZ2V0RnVsbE5hbWUoZ2V0VGFibGUoKSwgZmFsc2UpKS5hcHBlbmQo\nIiAoIik7CgogICAgICAgIGJvb2xlYW4gaGFzVmFsID0gZmFsc2U7CiAgICAg\nICAgZm9yIChpbnQgaSA9IDA7IGkgPCBfY29scy5sZW5ndGg7IGkrKykgewog\nICAgICAgICAgICBpZiAoX3ZhbHNbaV0gPT0gbnVsbCkKICAgICAgICAgICAg\nICAgIGNvbnRpbnVlOwoKICAgICAgICAgICAgaWYgKGhhc1ZhbCkgewogICAg\nICAgICAgICAgICAgYnVmLmFwcGVuZCgiLCAiKTsKICAgICAgICAgICAgICAg\nIHZhbHMuYXBwZW5kKCIsICIpOwogICAgICAgICAgICB9CiAgICAgICAgICAg\nIGJ1Zi5hcHBlbmQoZGljdC5nZXRDb2x1bW5EQk5hbWUoX2NvbHNbaV0pKTsK\nICAgICAgICAgICAgaWYgKF90eXBlc1tpXSA9PSBSQVcpCiAgICAgICAgICAg\nICAgICB2YWxzLmFwcGVuZChfdmFsc1tpXSk7CiAgICAgICAgICAgIGVsc2UK\nICAgICAgICAgICAgICAgIHZhbHMuYXBwZW5kKCI/Iik7CiAgICAgICAgICAg\nIGhhc1ZhbCA9IHRydWU7CiAgICAgICAgfQoKICAgICAgICBidWYuYXBwZW5k\nKCIpIFZBTFVFUyAoIikuYXBwZW5kKHZhbHMudG9TdHJpbmcoKSkuYXBwZW5k\nKCIpIik7CiAgICAgICAgcmV0dXJuIGJ1Zi50b1N0cmluZygpOwogICAgfQoK\nICAgIC8qKgogICAgICogUmV0dXJuIHRoZSBTUUwgZm9yIGEgcHJlcGFyZWQg\nc3RhdGVtZW50IGRlbGV0ZSBvbiB0aGlzIHJvdy4KICAgICAqLwogICAgcHJp\ndmF0ZSBTdHJpbmcgZ2V0RGVsZXRlU1FMKERCRGljdGlvbmFyeSBkaWN0KSB7\nCiAgICAgICAgU3RyaW5nQnVpbGRlciBidWYgPSBuZXcgU3RyaW5nQnVpbGRl\ncigpOwogICAgICAgIGJ1Zi5hcHBlbmQoIkRFTEVURSBGUk9NICIpLgogICAg\nICAgICAgICBhcHBlbmQoZGljdC5nZXRGdWxsTmFtZShnZXRUYWJsZSgpLCBm\nYWxzZSkpOwogICAgICAgIGFwcGVuZFdoZXJlKGJ1ZiwgZGljdCk7CiAgICAg\nICAgcmV0dXJuIGJ1Zi50b1N0cmluZygpOwogICAgfQoKICAgIC8qKgogICAg\nICogQXBwZW5kcyB0aGUgd2hlcmUgY2xhdXNlIG9udG8gdGhlIGdpdmVuIHNx\nbCBidWZmZXIuCiAgICAgKi8KICAgIHByaXZhdGUgdm9pZCBhcHBlbmRXaGVy\nZShTdHJpbmdCdWlsZGVyIGJ1ZiwgREJEaWN0aW9uYXJ5IGRpY3QpIHsKICAg\nICAgICBib29sZWFuIGhhc1doZXJlID0gZmFsc2U7CiAgICAgICAgZm9yIChp\nbnQgaSA9IDA7IGkgPCBfY29scy5sZW5ndGg7IGkrKykgewogICAgICAgICAg\nICBpZiAoX3ZhbHNbZ2V0V2hlcmVJbmRleChfY29sc1tpXSldID09IG51bGwp\nCiAgICAgICAgICAgICAgICBjb250aW51ZTsKCiAgICAgICAgICAgIGlmICgh\naGFzV2hlcmUpCiAgICAgICAgICAgICAgICBidWYuYXBwZW5kKCIgV0hFUkUg\nIik7CiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIGJ1Zi5hcHBl\nbmQoIiBBTkQgIik7CgogICAgICAgICAgICAvLyBHZXQgcGxhdGZvcm0gc3Bl\nY2lmaWMgdmVyc2lvbiBjb2x1bW4gbmFtZQogICAgICAgICAgICBpZiAoX2Nv\nbHNbaV0uZ2V0VmVyc2lvblN0cmF0ZWd5KCkgIT0gbnVsbCkKICAgICAgICAg\nICAgICAgYnVmLmFwcGVuZChkaWN0LnRvREJOYW1lKGRpY3QuZ2V0VmVyc2lv\nbkNvbHVtbihfY29sc1tpXSwgX2NvbHNbaV0KICAgICAgICAgICAgICAgICAg\nIC5nZXRUYWJsZUlkZW50aWZpZXIoKSkpKS5hcHBlbmQoIiA9ID8iKTsKICAg\nICAgICAgICAgLy8gc3Fsc2VydmVyIHNlZW1zIHRvIGhhdmUgcHJvYmxlbXMg\ndXNpbmcgbnVsbCBwYXJhbWV0ZXJzIGluIHRoZQogICAgICAgICAgICAvLyB3\naGVyZSBjbGF1c2UKICAgICAgICAgICAgZWxzZSBpZiAoX3ZhbHNbZ2V0V2hl\ncmVJbmRleChfY29sc1tpXSldID09IE5VTEwpCiAgICAgICAgICAgICAgICBi\ndWYuYXBwZW5kKGRpY3QuZ2V0Q29sdW1uREJOYW1lKF9jb2xzW2ldKSkuYXBw\nZW5kKCIgSVMgTlVMTCIpOwogICAgICAgICAgICBlbHNlIGlmIChfdHlwZXNb\naV0gPT0gUkFXKQogICAgICAgICAgICAgICAgYnVmLmFwcGVuZChkaWN0Lmdl\ndENvbHVtbkRCTmFtZShfY29sc1tpXSkpLmFwcGVuZCgiID0gIikuYXBwZW5k\nKF92YWxzW2ldKTsKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAg\nYnVmLmFwcGVuZChkaWN0LmdldENvbHVtbkRCTmFtZShfY29sc1tpXSkpLmFw\ncGVuZCgiID0gPyIpOwogICAgICAgICAgICBoYXNXaGVyZSA9IHRydWU7CiAg\nICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogVGhlIG51bWJlciBvZiBw\nYXJhbWV0ZXJzIHRoYXQgd2lsbCBiZSBzZXQgZm9yIHRoaXMgcm93LgogICAg\nICovCiAgICBwdWJsaWMgaW50IGdldFBhcmFtZXRlckNvdW50KCkgewogICAg\nICAgIHJldHVybiBfdmFscy5sZW5ndGg7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBGbHVzaCB0aGUgcm93J3MgdmFsdWVzIHRvIHRoZSBnaXZlbiBwcmVwYXJl\nZCBzdGF0ZW1lbnQuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIGZsdXNoKFBy\nZXBhcmVkU3RhdGVtZW50IHN0bW50LCBEQkRpY3Rpb25hcnkgZGljdCwKICAg\nICAgICBKREJDU3RvcmUgc3RvcmUpCiAgICAgICAgdGhyb3dzIFNRTEV4Y2Vw\ndGlvbiB7CiAgICAgICAgZmx1c2goc3RtbnQsIDEsIGRpY3QsIHN0b3JlKTsK\nICAgIH0KCiAgICAvKioKICAgICAqIEZsdXNoIHRoZSByb3cncyB2YWx1ZXMg\ndG8gdGhlIGdpdmVuIHByZXBhcmVkIHN0YXRlbWVudC4KICAgICAqLwogICAg\ncHVibGljIHZvaWQgZmx1c2goUHJlcGFyZWRTdGF0ZW1lbnQgc3RtbnQsIGlu\ndCBpZHgsIERCRGljdGlvbmFyeSBkaWN0LAogICAgICAgIEpEQkNTdG9yZSBz\ndG9yZSkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKCiAgICAgICAg\nLy8gdGhpcyBzaW1wbGUgbWV0aG9kIHdvcmtzIGJlY2F1c2UgdGhlIFNRTCBp\ncyBhbHdheXMgcHJlcGFyZWQKICAgICAgICAvLyBiYXNlZCBvbiB0aGUgaW5k\nZXhpbmcgb2YgdGhlIGNvbHVtbnMgaW4gdGhlIHRhYmxlIG9iamVjdCAtLSB0\naGUKICAgICAgICAvLyBzYW1lIG9yZGVyaW5nIHdlIHVzZSB3aGVuIHN0b3Jp\nbmcgdmFsdWVzIGFuZCBtZXRhIHR5cGVzLiBza2lwCiAgICAgICAgLy8gdXBk\nYXRlcyB3aGVuIHNldHRpbmcgcGFyYW1zIGZvciBERUxFVEVzOyB0aGUgdXBk\nYXRlcyBhcmUganVzdCB0aGVyZQogICAgICAgIC8vIHRvIGxldCB1cyBldmFs\nIGZrIGNvbnN0cmFpbnRzCiAgICAgICAgaW50IGkgPSAoZ2V0QWN0aW9uKCkg\nPT0gQUNUSU9OX0RFTEVURSkgPyBfY29scy5sZW5ndGg6IDA7CiAgICAgICAg\nQ29sdW1uIGNvbDsKICAgICAgICBPYmplY3QgdmFsOwogICAgICAgIGludCBo\nYWxmID0gX3ZhbHMubGVuZ3RoIC8gMjsKICAgICAgICBmb3IgKDsgaSA8IF92\nYWxzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGlmIChfdmFsc1tpXSA9\nPSBudWxsKQogICAgICAgICAgICAgICAgY29udGludWU7CgogICAgICAgICAg\nICAvLyB3ZSBkb24ndCBzZXQgbnVsbCBwYXJhbXMgaW4gdGhlIFdIRVJFIGNs\nYXVzZTsgd2UgdXNlIHRoZSBOVUxMCiAgICAgICAgICAgIC8vIGtleXdvcmQg\naW5zdGVhZCB0byBzYXRpc2Z5IHNxbHNlcnZlcgogICAgICAgICAgICBpZiAo\nX3ZhbHNbaV0gPT0gTlVMTCAmJiBnZXRBY3Rpb24oKSAhPSBBQ1RJT05fSU5T\nRVJUICYmIGkgPj0gaGFsZikKICAgICAgICAgICAgICAgIGNvbnRpbnVlOwoK\nICAgICAgICAgICAgLy8gaWYgdGhpcyBpcyBhbiB1cGRhdGUgdGhlIHZhbHMg\nYXJyYXkgd2lsbCBiZSAyIHggdGhlIGNvbHMKICAgICAgICAgICAgLy8gYXJy\nYXkgbGVuZ3RoOyBpdCByZXBlYXRzIGZvciB3aGVyZSB2YWx1ZXMKICAgICAg\nICAgICAgaWYgKGkgPCBfY29scy5sZW5ndGgpCiAgICAgICAgICAgICAgICBj\nb2wgPSBfY29sc1tpXTsKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAg\nICAgY29sID0gX2NvbHNbaSAtIF9jb2xzLmxlbmd0aF07CgogICAgICAgICAg\nICB2YWwgPSBfdmFsc1tpXTsKICAgICAgICAgICAgaWYgKHZhbCA9PSBOVUxM\nKQogICAgICAgICAgICAgICAgdmFsID0gbnVsbDsKCiAgICAgICAgICAgIGlm\nICh2YWwgPT0gbnVsbCB8fCBfdHlwZXNbaV0gIT0gUkFXKSB7CiAgICAgICAg\nICAgICAgICBkaWN0LnNldFR5cGVkKHN0bW50LCBpZHgsIHZhbCwgY29sLCBf\ndHlwZXNbaV0sIHN0b3JlKTsKICAgICAgICAgICAgICAgIGlkeCsrOwogICAg\nICAgICAgICB9CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogVGhl\nIGFycmF5IHZhbHVlIGFycmF5IGluZGV4IGZvciB0aGUgZ2l2ZW4gY29sdW1u\nJ3MgdmFsdWUuCiAgICAgKi8KICAgIHByaXZhdGUgaW50IGdldFNldEluZGV4\nKENvbHVtbiBjb2wpIHsKICAgICAgICByZXR1cm4gY29sLmdldEluZGV4KCk7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBUaGUgYXJyYXkgdmFsdWUgYXJyYXkg\naW5kZXggZm9yIHRoZSBnaXZlbiBjb2x1bW4ncyB2YWx1ZS4KICAgICAqLwog\nICAgcHJpdmF0ZSBpbnQgZ2V0V2hlcmVJbmRleChDb2x1bW4gY29sKSB7CiAg\nICAgICAgcmV0dXJuIGNvbC5nZXRJbmRleCgpICsgX2NvbHMubGVuZ3RoOwog\nICAgfQoKICAgIC8qKgogICAgICogUGVyZm9ybXMgYSBwcm9wZXIgZGVlcCBj\nbG9uZS4KICAgICAqLwogICAgcHVibGljIE9iamVjdCBjbG9uZSgpIHsKICAg\nICAgICBSb3dJbXBsIGNsb25lID0gbmV3SW5zdGFuY2UoZ2V0Q29sdW1ucygp\nLCBnZXRBY3Rpb24oKSk7CiAgICAgICAgY29weUludG8oY2xvbmUsIGZhbHNl\nKTsKICAgICAgICByZXR1cm4gY2xvbmU7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBSZXR1cm4gYSBuZXcgcm93LgogICAgICovCiAgICBwcm90ZWN0ZWQgUm93\nSW1wbCBuZXdJbnN0YW5jZShDb2x1bW5bXSBjb2xzLCBpbnQgYWN0aW9uKSB7\nCiAgICAgICAgcmV0dXJuIG5ldyBSb3dJbXBsKGNvbHMsIGFjdGlvbik7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBDb3B5IGFsbCB2YWx1ZXMgZnJvbSB0aGlz\nIHJvdyBpbnRvIHRoZSBnaXZlbiBvbmUuCiAgICAgKgogICAgICogQHBhcmFt\nIHdoZXJlT25seSBpZiB0cnVlLCBvbmx5IGNvcHkgd2hlcmUgY29uZGl0aW9u\ncwogICAgICovCiAgICBwdWJsaWMgdm9pZCBjb3B5SW50byhSb3dJbXBsIHJv\ndywgYm9vbGVhbiB3aGVyZU9ubHkpIHsKICAgICAgICBpbnQgYWN0aW9uID0g\nZ2V0QWN0aW9uKCk7CiAgICAgICAgaW50IHJvd0FjdGlvbiA9IHJvdy5nZXRB\nY3Rpb24oKTsKCiAgICAgICAgaW50IHN0YXJ0OwogICAgICAgIGludCBsZW47\nCiAgICAgICAgaWYgKHdoZXJlT25seSkgewogICAgICAgICAgICBpZiAoYWN0\naW9uID09IEFDVElPTl9JTlNFUlQgfHwgcm93QWN0aW9uID09IEFDVElPTl9J\nTlNFUlQpCiAgICAgICAgICAgICAgICBzdGFydCA9IGxlbiA9IDA7CiAgICAg\nICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIHN0YXJ0ID0gbGVuID0gX3Zh\nbHMubGVuZ3RoIC8gMjsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBz\ndGFydCA9IDA7CiAgICAgICAgICAgIGlmIChyb3dBY3Rpb24gPT0gQUNUSU9O\nX0lOU0VSVCAmJiBhY3Rpb24gIT0gQUNUSU9OX0lOU0VSVCkKICAgICAgICAg\nICAgICAgIGxlbiA9IF92YWxzLmxlbmd0aCAvIDI7CiAgICAgICAgICAgIGVs\nc2UKICAgICAgICAgICAgICAgIGxlbiA9IF92YWxzLmxlbmd0aDsKICAgICAg\nICB9CgogICAgICAgIFN5c3RlbS5hcnJheWNvcHkoX3ZhbHMsIHN0YXJ0LCBy\nb3cuX3ZhbHMsIHN0YXJ0LCBsZW4pOwogICAgICAgIFN5c3RlbS5hcnJheWNv\ncHkoX3R5cGVzLCBzdGFydCwgcm93Ll90eXBlcywgc3RhcnQsIGxlbik7CiAg\nICAgICAgaWYgKGlzVmFsaWQoKSkKICAgICAgICAgICAgcm93LnNldFZhbGlk\nKHRydWUpOwogICAgfQogICAgCiAgICBwdWJsaWMgT2JqZWN0W10gZ2V0VmFs\ncygpIHsKICAgICAgICByZXR1cm4gX3ZhbHM7CiAgICB9CiAgICAKICAgIHB1\nYmxpYyBpbnRbXSBnZXRUeXBlcygpIHsKICAgICAgICByZXR1cm4gX3R5cGVz\nOwogICAgfQogICAgCiAgICBwdWJsaWMgYm9vbGVhbiBpc0ZsdXNoZWQoKSB7\nCiAgICAgICAgcmV0dXJuIF9pc0ZsdXNoZWQ7CiAgICB9CiAgICAKICAgIHB1\nYmxpYyB2b2lkIHNldEZsdXNoZWQoYm9vbGVhbiBpc0ZsdXNoZWQpIHsKICAg\nICAgICBfaXNGbHVzaGVkID0gaXNGbHVzaGVkOwogICAgfQp9Cg==\n","encoding":"base64"}

