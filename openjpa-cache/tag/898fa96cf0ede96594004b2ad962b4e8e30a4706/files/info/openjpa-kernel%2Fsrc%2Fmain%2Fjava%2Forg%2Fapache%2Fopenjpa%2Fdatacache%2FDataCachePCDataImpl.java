{"sha":"69e830bf012dee43315068fc7ae1de844db92e42","node_id":"MDQ6QmxvYjIwNjM2NDo2OWU4MzBiZjAxMmRlZTQzMzE1MDY4ZmM3YWUxZGU4NDRkYjkyZTQy","size":6971,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/69e830bf012dee43315068fc7ae1de844db92e42","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuZGF0YWNhY2hlOwoKaW1wb3J0\nIGphdmEudXRpbC5CaXRTZXQ7CgppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLmtlcm5lbC5BYnN0cmFjdFBDRGF0YTsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5rZXJuZWwuT3BlbkpQQVN0YXRlTWFuYWdlcjsKaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS5rZXJuZWwuUENEYXRhOwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLmtlcm5lbC5QQ0RhdGFJbXBsOwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLmtlcm5lbC5QQ1N0YXRlOwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLmtlcm5lbC5TdG9yZUNvbnRleHQ7CmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEubWV0YS5DbGFzc01ldGFEYXRhOwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLm1ldGEuRmllbGRNZXRhRGF0YTsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5tZXRhLkphdmFUeXBlczsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS5tZXRhLlZhbHVlTWV0YURhdGE7CgovKioKICogU3BlY2lhbGl6\nZWQge0BsaW5rIFBDRGF0YX0gaW1wbGVtZW50YXRpb24gZm9yIGRhdGEgY2Fj\naGluZy4gVGhpcwogKiBpbXBsZW1lbnRhdGlvbiBpcyBwcm9wZXJseSBzeW5j\naHJvbml6ZWQuCiAqCiAqIEBhdXRob3IgUGF0cmljayBMaW5za2V5CiAqLwpA\nU3VwcHJlc3NXYXJuaW5ncygic2VyaWFsIikKcHVibGljIGNsYXNzIERhdGFD\nYWNoZVBDRGF0YUltcGwKICAgIGV4dGVuZHMgUENEYXRhSW1wbAogICAgaW1w\nbGVtZW50cyBEYXRhQ2FjaGVQQ0RhdGEgewoKICAgIHByaXZhdGUgZmluYWwg\nbG9uZyBfZXhwOwoKICAgIHB1YmxpYyBEYXRhQ2FjaGVQQ0RhdGFJbXBsKE9i\namVjdCBvaWQsIENsYXNzTWV0YURhdGEgbWV0YSkgewogICAgICAgIHRoaXMo\nb2lkLCBtZXRhLCBEYXRhQ2FjaGUuTkFNRV9ERUZBVUxUKTsKICAgIH0KICAg\nIAogICAgLyoqCiAgICAgKiBDb25zdHJ1Y3Rvci4KICAgICAqLwogICAgcHVi\nbGljIERhdGFDYWNoZVBDRGF0YUltcGwoT2JqZWN0IG9pZCwgQ2xhc3NNZXRh\nRGF0YSBtZXRhLCBTdHJpbmcgbmFtZSkgewogICAgICAgIHN1cGVyKG9pZCwg\nbWV0YSwgbmFtZSk7CgogICAgICAgIGludCB0aW1lb3V0ID0gbWV0YS5nZXRE\nYXRhQ2FjaGVUaW1lb3V0KCk7CiAgICAgICAgaWYgKHRpbWVvdXQgPiAwKQog\nICAgICAgICAgICBfZXhwID0gU3lzdGVtLmN1cnJlbnRUaW1lTWlsbGlzKCkg\nKyB0aW1lb3V0OwogICAgICAgIGVsc2UKICAgICAgICAgICAgX2V4cCA9IC0x\nOwogICAgfQoKICAgIHB1YmxpYyBib29sZWFuIGlzVGltZWRPdXQoKSB7CiAg\nICAgICAgcmV0dXJuIF9leHAgIT0gLTEgJiYgX2V4cCA8IFN5c3RlbS5jdXJy\nZW50VGltZU1pbGxpcygpOwogICAgfQogICAgCiAgICBwdWJsaWMgbG9uZyBn\nZXRUaW1lT3V0KCkgewogICAgICAgIHJldHVybiBfZXhwOwogICAgfQoKICAg\nIHB1YmxpYyBzeW5jaHJvbml6ZWQgT2JqZWN0IGdldERhdGEoaW50IGluZGV4\nKSB7CiAgICAgICAgcmV0dXJuIHN1cGVyLmdldERhdGEoaW5kZXgpOwogICAg\nfQoKICAgIHB1YmxpYyBzeW5jaHJvbml6ZWQgdm9pZCBzZXREYXRhKGludCBp\nbmRleCwgT2JqZWN0IHZhbCkgewogICAgICAgIHN1cGVyLnNldERhdGEoaW5k\nZXgsIHZhbCk7CiAgICB9CgogICAgcHVibGljIHN5bmNocm9uaXplZCB2b2lk\nIGNsZWFyRGF0YShpbnQgaW5kZXgpIHsKICAgICAgICBzdXBlci5jbGVhckRh\ndGEoaW5kZXgpOwogICAgfQoKICAgIHB1YmxpYyBzeW5jaHJvbml6ZWQgT2Jq\nZWN0IGdldEltcGxEYXRhKCkgewogICAgICAgIHJldHVybiBzdXBlci5nZXRJ\nbXBsRGF0YSgpOwogICAgfQoKICAgIHB1YmxpYyBzeW5jaHJvbml6ZWQgdm9p\nZCBzZXRJbXBsRGF0YShPYmplY3QgdmFsKSB7CiAgICAgICAgc3VwZXIuc2V0\nSW1wbERhdGEodmFsKTsKICAgIH0KCiAgICBwdWJsaWMgc3luY2hyb25pemVk\nIE9iamVjdCBnZXRJbXBsRGF0YShpbnQgaW5kZXgpIHsKICAgICAgICByZXR1\ncm4gc3VwZXIuZ2V0SW1wbERhdGEoaW5kZXgpOwogICAgfQoKICAgIHB1Ymxp\nYyBzeW5jaHJvbml6ZWQgdm9pZCBzZXRJbXBsRGF0YShpbnQgaW5kZXgsIE9i\namVjdCB2YWwpIHsKICAgICAgICBzdXBlci5zZXRJbXBsRGF0YShpbmRleCwg\ndmFsKTsKICAgIH0KCiAgICBwdWJsaWMgc3luY2hyb25pemVkIE9iamVjdCBn\nZXRJbnRlcm1lZGlhdGUoaW50IGluZGV4KSB7CiAgICAgICAgcmV0dXJuIHN1\ncGVyLmdldEludGVybWVkaWF0ZShpbmRleCk7CiAgICB9CgogICAgcHVibGlj\nIHN5bmNocm9uaXplZCB2b2lkIHNldEludGVybWVkaWF0ZShpbnQgaW5kZXgs\nIE9iamVjdCB2YWwpIHsKICAgICAgICBzdXBlci5zZXRJbnRlcm1lZGlhdGUo\naW5kZXgsIHZhbCk7CiAgICB9CgogICAgcHVibGljIHN5bmNocm9uaXplZCBi\nb29sZWFuIGlzTG9hZGVkKGludCBpbmRleCkgewogICAgICAgIHJldHVybiBz\ndXBlci5pc0xvYWRlZChpbmRleCk7CiAgICB9CgogICAgcHVibGljIHN5bmNo\ncm9uaXplZCB2b2lkIHNldExvYWRlZChpbnQgaW5kZXgsIGJvb2xlYW4gbG9h\nZGVkKSB7CiAgICAgICAgc3VwZXIuc2V0TG9hZGVkKGluZGV4LCBsb2FkZWQp\nOwogICAgfQoKICAgIHB1YmxpYyBzeW5jaHJvbml6ZWQgT2JqZWN0IGdldFZl\ncnNpb24oKSB7CiAgICAgICAgcmV0dXJuIHN1cGVyLmdldFZlcnNpb24oKTsK\nICAgIH0KCiAgICBwdWJsaWMgc3luY2hyb25pemVkIHZvaWQgc2V0VmVyc2lv\nbihPYmplY3QgdmVyc2lvbikgewogICAgICAgIHN1cGVyLnNldFZlcnNpb24o\ndmVyc2lvbik7CiAgICB9CgogICAgcHVibGljIHN5bmNocm9uaXplZCB2b2lk\nIHN0b3JlKE9wZW5KUEFTdGF0ZU1hbmFnZXIgc20pIHsKICAgICAgICBzdXBl\nci5zdG9yZShzbSk7CiAgICB9CgogICAgcHVibGljIHN5bmNocm9uaXplZCB2\nb2lkIHN0b3JlKE9wZW5KUEFTdGF0ZU1hbmFnZXIgc20sIEJpdFNldCBmaWVs\nZHMpIHsKICAgICAgICBzdXBlci5zdG9yZShzbSwgZmllbGRzKTsKICAgIH0K\nCiAgICAvKioKICAgICAqIFN0b3JlIGZpZWxkLWxldmVsIGluZm9ybWF0aW9u\nIGZyb20gdGhlIGdpdmVuIHN0YXRlIG1hbmFnZXIuCiAgICAgKiBTcGVjaWFs\nIHByb2Nlc3Mgb2YgY2hlY2tpbmcgaWYgdGhlIGNhY2hlZCBjb2xsZWN0aW9u\nIGRhdGEgaXMgb3V0IG9mCiAgICAgKiBvcmRlci4KICAgICAqLwogICAgcHJv\ndGVjdGVkIHZvaWQgc3RvcmVGaWVsZChPcGVuSlBBU3RhdGVNYW5hZ2VyIHNt\nLCBGaWVsZE1ldGFEYXRhIGZtZCkgewogICAgICAgIGlmIChmbWQuZ2V0TWFu\nYWdlbWVudCgpICE9IEZpZWxkTWV0YURhdGEuTUFOQUdFX1BFUlNJU1RFTlQp\nCiAgICAgICAgICAgIHJldHVybjsKICAgICAgICBpbnQgaW5kZXggPSBmbWQu\nZ2V0SW5kZXgoKTsKCiAgICAgICAgLy8gaWYgdGhlIGZpZWxkIGlzIGEgY29s\nbGVjdGlvbiBhbmQgaGFzICJvcmRlciBieSIgc2V0LCBkb24ndCBjYWNoZQog\nICAgICAgIC8vIGl0IGlmIHRoaXMgc3RvcmUgaXMgY29taW5nIGZyb20gYSBj\ncmVhdGUgb3IgdXBkYXRlIChpLmUuLCBvbmx5CiAgICAgICAgLy8gZW5saXN0\nIGluIGNhY2hlIGlmIHRoaXMgaXMgY29taW5nIGZyb20gYSBkYXRhYmFzZSBy\nZWFkKS4KICAgICAgICBpZiAoZm1kLmdldE9yZGVycygpLmxlbmd0aCA+IDAp\nIHsKICAgICAgICAgICAgaWYgKHNtLmdldFBDU3RhdGUoKSA9PSBQQ1N0YXRl\nLlBORVcpCiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIGlm\nIChzbS5nZXRQQ1N0YXRlKCkgPT0gUENTdGF0ZS5QRElSVFkpIHsKICAgICAg\nICAgICAgICAgIGNsZWFyRGF0YShpbmRleCk7CiAgICAgICAgICAgICAgICBy\nZXR1cm47CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHN1cGVy\nLnN0b3JlRmllbGQoc20sIGZtZCk7CgogICAgICAgIC8vIElmIHRoaXMgZmll\nbGQgaXMgdXNlZCBpbiAib3JkZXIgYnkiLCB3ZSBuZWVkIHRvIGludmFsaWRh\ndGUgY2FjaGUKICAgICAgICAvLyBmb3IgdGhlIGNvbGxlY3Rpb24gdGhhdCBy\nZWZlciB0byB0aGlzIGZpZWxkLgogICAgICAgIGlmICgoc20uZ2V0UENTdGF0\nZSgpID09IFBDU3RhdGUuUERJUlRZKSAmJiBmbWQuaXNVc2VkSW5PcmRlckJ5\nKCkpIHsKICAgICAgICAgICAgY2xlYXJJbnZlcnNlUmVsYXRpb25DYWNoZShz\nbSwgZm1kKTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBDaGVj\nayBpZiB0aGlzIGZpZWxkIGlzIGluIHVzZSBvZiAib3JkZXIgYnkiIGJ5IG90\naGVyIGZpZWxkIGNvbGxlY3Rpb25zCiAgICAgKiBpbiBpbnZlcnNlIHJlbGF0\naW9uLiBJZiBpdCBpcywgY2xlYXIgdGhlIG90aGVyIGZpZWxkIGNhY2hlIGJl\nY2F1c2UgaXQKICAgICAqIGNvdWxkIGJlIG91dCBvZiBvcmRlci4KICAgICAq\nLwogICAgcHJvdGVjdGVkIHZvaWQgY2xlYXJJbnZlcnNlUmVsYXRpb25DYWNo\nZShPcGVuSlBBU3RhdGVNYW5hZ2VyIHNtLCBGaWVsZE1ldGFEYXRhIGZtZCkg\newogICAgICAgIERhdGFDYWNoZSBjYWNoZSA9IHNtLmdldE1ldGFEYXRhKCku\nZ2V0RGF0YUNhY2hlKCk7CiAgICAgICAgaWYgKGNhY2hlID09IG51bGwpCiAg\nICAgICAgICAgIHJldHVybjsKICAgICAgICBDbGFzc01ldGFEYXRhIGNtZCA9\nIHNtLmdldE1ldGFEYXRhKCk7CiAgICAgICAgRmllbGRNZXRhRGF0YVtdIGZp\nZWxkcyA9IGNtZC5nZXRGaWVsZHMoKTsKICAgICAgICBmb3IgKGludCBpID0g\nMDsgaSA8IGZpZWxkcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBGaWVs\nZE1ldGFEYXRhW10gaW52ZXJzZXMgPSBmaWVsZHNbaV0uZ2V0SW52ZXJzZU1l\ndGFEYXRhcygpOwogICAgICAgICAgICBpZiAoaW52ZXJzZXMubGVuZ3RoID09\nIDApCiAgICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgZm9y\nIChGaWVsZE1ldGFEYXRhIGludmVyc2UgOiBpbnZlcnNlcykgewogICAgICAg\nICAgICAgICAgaWYgKGludmVyc2UuZ2V0T3JkZXJEZWNsYXJhdGlvbigpLmlu\nZGV4T2YoZm1kLmdldE5hbWUoKSkgIT0gLTEpIHsKICAgICAgICAgICAgICAg\nICAgICBPYmplY3Qgb2lkID0gc20uZ2V0Q29udGV4dCgpLmdldE9iamVjdElk\nKHNtLmZldGNoKGkpKTsKICAgICAgICAgICAgICAgICAgICBEYXRhQ2FjaGVQ\nQ0RhdGEgZGF0YSA9IGNhY2hlLmdldChvaWQpOwogICAgICAgICAgICAgICAg\nICAgIGlmIChkYXRhIGluc3RhbmNlb2YgRGF0YUNhY2hlUENEYXRhSW1wbCkg\newogICAgICAgICAgICAgICAgICAgICAgICAoKERhdGFDYWNoZVBDRGF0YUlt\ncGwpIGRhdGEpLmNsZWFyRGF0YShpbnZlcnNlLmdldEluZGV4KCkpOwogICAg\nICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAg\nICAgfQogICAgICAgIH0KICAgIH0KCiAgICBwcm90ZWN0ZWQgT2JqZWN0IHRv\nRGF0YShGaWVsZE1ldGFEYXRhIGZtZCwgT2JqZWN0IHZhbCwgU3RvcmVDb250\nZXh0IGN0eCkgewogICAgICAgIC8vIGF2b2lkIGNhY2hpbmcgbGFyZ2UgcmVz\ndWx0IHNldCBmaWVsZHMKICAgICAgICBpZiAoZm1kLmlzTFJTKCkgfHwgZm1k\nLmlzU3RyZWFtKCkpCiAgICAgICAgICAgIHJldHVybiBOVUxMOwogICAgICAg\nIHJldHVybiBzdXBlci50b0RhdGEoZm1kLCB2YWwsIGN0eCk7CiAgICB9Cgog\nICAgcHJvdGVjdGVkIE9iamVjdCB0b05lc3RlZERhdGEoVmFsdWVNZXRhRGF0\nYSB2bWQsIE9iamVjdCB2YWwsCiAgICAgICAgU3RvcmVDb250ZXh0IGN0eCkg\newogICAgICAgIGlmICh2YWwgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJu\nIG51bGw7CgogICAgICAgIC8vIGRvbid0IHRyeSB0byBjYWNoZSBuZXN0ZWQg\nY29udGFpbmVycwogICAgICAgIHN3aXRjaCAodm1kLmdldERlY2xhcmVkVHlw\nZUNvZGUoKSkgewogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5DT0xMRUNU\nSU9OOgogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5NQVA6CiAgICAgICAg\nICAgIGNhc2UgSmF2YVR5cGVzLkFSUkFZOgogICAgICAgICAgICAgICAgcmV0\ndXJuIE5VTEw7CiAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAg\nICByZXR1cm4gc3VwZXIudG9OZXN0ZWREYXRhKHZtZCwgdmFsLCBjdHgpOwog\nICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMgQWJzdHJhY3RQQ0RhdGEgbmV3\nRW1iZWRkZWRQQ0RhdGEoT3BlbkpQQVN0YXRlTWFuYWdlciBzbSkgewogICAg\nICAgIHJldHVybiBuZXcgRGF0YUNhY2hlUENEYXRhSW1wbChzbS5nZXRJZCgp\nLCBzbS5nZXRNZXRhRGF0YSgpLCBnZXRDYWNoZSgpKTsKICAgIH0KfQo=\n","encoding":"base64"}

