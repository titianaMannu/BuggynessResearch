{"sha":"f798f6e187c04c2e53526e6fc36b9379cf651384","node_id":"MDQ6QmxvYjIwNjM2NDpmNzk4ZjZlMTg3YzA0YzJlNTM1MjZlNmZjMzZiOTM3OWNmNjUxMzg0","size":57732,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/f798f6e187c04c2e53526e6fc36b9379cf651384","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuZW5oYW5jZTsKCmltcG9ydCBq\nYXZhLmlvLkZpbGU7CmltcG9ydCBqYXZhLmlvLkZpbGVXcml0ZXI7CmltcG9y\ndCBqYXZhLmlvLklPRXhjZXB0aW9uOwppbXBvcnQgamF2YS5pby5QcmludFdy\naXRlcjsKaW1wb3J0IGphdmEuaW8uV3JpdGVyOwppbXBvcnQgamF2YS5sYW5n\nLnJlZmxlY3QuTW9kaWZpZXI7CmltcG9ydCBqYXZhLnNlY3VyaXR5LkFjY2Vz\nc0NvbnRyb2xsZXI7CmltcG9ydCBqYXZhLnV0aWwuQXJyYXlMaXN0OwppbXBv\ncnQgamF2YS51dGlsLkFycmF5czsKaW1wb3J0IGphdmEudXRpbC5Db2xsZWN0\naW9uOwppbXBvcnQgamF2YS51dGlsLkRhdGU7CmltcG9ydCBqYXZhLnV0aWwu\nSGFzaFNldDsKaW1wb3J0IGphdmEudXRpbC5JdGVyYXRvcjsKaW1wb3J0IGph\ndmEudXRpbC5MaXN0OwppbXBvcnQgamF2YS51dGlsLk1hcDsKaW1wb3J0IGph\ndmEudXRpbC5TZXQ7CmltcG9ydCBqYXZhLnV0aWwuVHJlZVNldDsKCmltcG9y\ndCBvcmcuYXBhY2hlLmNvbW1vbnMubGFuZy5TdHJpbmdVdGlsczsKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5jb25mLk9wZW5KUEFDb25maWd1cmF0aW9u\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmNvbmYuT3BlbkpQQUNvbmZp\nZ3VyYXRpb25JbXBsOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi5j\nb25mLkNvbmZpZ3VyYXRpb247CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\nbGliLmNvbmYuQ29uZmlndXJhdGlvbnM7CmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEubGliLmxvZy5Mb2c7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\nbGliLm1ldGEuQ2xhc3NBcmdQYXJzZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEubGliLnV0aWwuQ29kZUZvcm1hdDsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS5saWIudXRpbC5GaWxlczsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5saWIudXRpbC5KMkRvUHJpdkhlbHBlcjsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5saWIudXRpbC5KYXZhVmVyc2lvbnM7CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuTG9jYWxpemVyOwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLmxpYi51dGlsLk9wdGlvbnM7CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEubWV0YS5BY2Nlc3NDb2RlOwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLm1ldGEuQ2xhc3NNZXRhRGF0YTsKaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS5tZXRhLkRlbGVnYXRpbmdNZXRhRGF0YUZhY3Rvcnk7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YS5GaWVsZE1ldGFEYXRh\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuSmF2YVR5cGVzOwpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuTWV0YURhdGFGYWN0b3J5\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuTWV0YURhdGFSZXBv\nc2l0b3J5OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuSW52YWxp\nZFN0YXRlRXhjZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0\naWwuVXNlckV4Y2VwdGlvbjsKaW1wb3J0IHNlcnAuYnl0ZWNvZGUuQkNDbGFz\nczsKaW1wb3J0IHNlcnAuYnl0ZWNvZGUuQkNDbGFzc0xvYWRlcjsKaW1wb3J0\nIHNlcnAuYnl0ZWNvZGUuUHJvamVjdDsKaW1wb3J0IHNlcnAudXRpbC5TdHJp\nbmdzOwoKLyoqCiAqIEdlbmVyYXRlcyBhIGNsYXNzIGFwcHJvcHJpYXRlIGZv\nciB1c2UgYXMgYW4gYXBwbGljYXRpb24gaWRlbnRpdHkgY2xhc3MuCiAqCiAq\nIEBhdXRob3IgUGF0cmljayBMaW5za2V5CiAqIEBhdXRob3IgQWJlIFdoaXRl\nCiAqLwpwdWJsaWMgY2xhc3MgQXBwbGljYXRpb25JZFRvb2wgewoKICAgIHB1\nYmxpYyBzdGF0aWMgZmluYWwgU3RyaW5nIFRPS0VOX0RFRkFVTFQgPSAiOjoi\nOwoKICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIFN0cmluZyBUT0tFTklaRVJf\nQ1VTVE9NID0gIlRva2VuaXplciI7CiAgICBwcml2YXRlIHN0YXRpYyBmaW5h\nbCBTdHJpbmcgVE9LRU5JWkVSX1NURCA9ICJTdHJpbmdUb2tlbml6ZXIiOwoK\nICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIExvY2FsaXplciBfbG9jID0gTG9j\nYWxpemVyLmZvclBhY2thZ2UKICAgICAgICAoQXBwbGljYXRpb25JZFRvb2wu\nY2xhc3MpOwoKICAgIHByaXZhdGUgZmluYWwgTG9nIF9sb2c7CiAgICBwcml2\nYXRlIGZpbmFsIENsYXNzIF90eXBlOwogICAgcHJpdmF0ZSBmaW5hbCBDbGFz\nc01ldGFEYXRhIF9tZXRhOwogICAgcHJpdmF0ZSBib29sZWFuIF9hYnN0cmFj\ndCA9IGZhbHNlOwogICAgcHJpdmF0ZSBGaWVsZE1ldGFEYXRhW10gX2ZpZWxk\ncyA9IG51bGw7CiAgICBwcml2YXRlIGJvb2xlYW4gX2lnbm9yZSA9IHRydWU7\nCiAgICBwcml2YXRlIEZpbGUgX2RpciA9IG51bGw7CiAgICBwcml2YXRlIFdy\naXRlciBfd3JpdGVyID0gbnVsbDsKICAgIHByaXZhdGUgU3RyaW5nIF9jb2Rl\nID0gbnVsbDsKICAgIHByaXZhdGUgU3RyaW5nIF90b2tlbiA9IFRPS0VOX0RF\nRkFVTFQ7CiAgICBwcml2YXRlIENvZGVGb3JtYXQgX2Zvcm1hdCA9IG51bGw7\nCgogICAgLyoqCiAgICAgKiBDb25zdHJ1Y3RzIGEgbmV3IEFwcGxpY2F0aW9u\nSWRUb29sIGNhcGFibGUgb2YgZ2VuZXJhdGluZyBhbgogICAgICogb2JqZWN0\nIGlkIGNsYXNzIGZvciA8Y29kZT50eXBlPC9jb2RlPi4KICAgICAqLwogICAg\ncHVibGljIEFwcGxpY2F0aW9uSWRUb29sKE9wZW5KUEFDb25maWd1cmF0aW9u\nIGNvbmYsIENsYXNzIHR5cGUpIHsKICAgICAgICBfbG9nID0gY29uZi5nZXRM\nb2coT3BlbkpQQUNvbmZpZ3VyYXRpb24uTE9HX0VOSEFOQ0UpOwogICAgICAg\nIF90eXBlID0gdHlwZTsKCiAgICAgICAgTWV0YURhdGFSZXBvc2l0b3J5IHJl\ncG9zID0gY29uZi5uZXdNZXRhRGF0YVJlcG9zaXRvcnlJbnN0YW5jZSgpOwog\nICAgICAgIHJlcG9zLnNldFZhbGlkYXRlKHJlcG9zLlZBTElEQVRFX05PTkUp\nOwogICAgICAgIHJlcG9zLnNldFNvdXJjZU1vZGUocmVwb3MuTU9ERV9NQVBQ\nSU5HLCBmYWxzZSk7CiAgICAgICAgbG9hZE9iamVjdElkcyhyZXBvcywgdHJ1\nZSk7CiAgICAgICAgX21ldGEgPSByZXBvcy5nZXRNZXRhRGF0YSh0eXBlLCBu\ndWxsLCBmYWxzZSk7CiAgICAgICAgaWYgKF9tZXRhICE9IG51bGwpIHsKICAg\nICAgICAgICAgX2Fic3RyYWN0ID0gTW9kaWZpZXIuaXNBYnN0cmFjdChfbWV0\nYS5nZXREZXNjcmliZWRUeXBlKCkuCiAgICAgICAgICAgICAgICBnZXRNb2Rp\nZmllcnMoKSk7CiAgICAgICAgICAgIF9maWVsZHMgPSBnZXREZWNsYXJlZFBy\naW1hcnlLZXlGaWVsZHMoX21ldGEpOwogICAgICAgIH0KICAgIH0KCiAgICAv\nKioKICAgICAqIENvbnN0cnVjdHMgYSBuZXcgdG9vbCBpbnN0YW5jZSBjYXBh\nYmxlIG9mIGdlbmVyYXRpbmcgYW4KICAgICAqIG9iamVjdCBpZCBjbGFzcyBm\nb3IgPGNvZGU+bWV0YTwvY29kZT4uCiAgICAgKi8KICAgIHB1YmxpYyBBcHBs\naWNhdGlvbklkVG9vbChPcGVuSlBBQ29uZmlndXJhdGlvbiBjb25mLCBDbGFz\ncyB0eXBlLAogICAgICAgIENsYXNzTWV0YURhdGEgbWV0YSkgewogICAgICAg\nIF9sb2cgPSBjb25mLmdldExvZyhPcGVuSlBBQ29uZmlndXJhdGlvbi5MT0df\nRU5IQU5DRSk7CgogICAgICAgIF90eXBlID0gdHlwZTsKICAgICAgICBfbWV0\nYSA9IG1ldGE7CiAgICAgICAgaWYgKF9tZXRhICE9IG51bGwpIHsKICAgICAg\nICAgICAgX2Fic3RyYWN0ID0gTW9kaWZpZXIuaXNBYnN0cmFjdChfbWV0YS5n\nZXREZXNjcmliZWRUeXBlKCkuCiAgICAgICAgICAgICAgICBnZXRNb2RpZmll\ncnMoKSk7CiAgICAgICAgICAgIF9maWVsZHMgPSBnZXREZWNsYXJlZFByaW1h\ncnlLZXlGaWVsZHMoX21ldGEpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioK\nICAgICAqIFJldHVybiBtZXRhZGF0YSBmb3IgcHJpbWFyeSBrZXkgZmllbGRz\nIGRlY2xhcmVkIGluIHRoZSBnaXZlbiBjbGFzcy4KICAgICAqLwogICAgcHJp\ndmF0ZSBzdGF0aWMgRmllbGRNZXRhRGF0YVtdIGdldERlY2xhcmVkUHJpbWFy\neUtleUZpZWxkcwogICAgICAgIChDbGFzc01ldGFEYXRhIG1ldGEpIHsKICAg\nICAgICBpZiAobWV0YS5nZXRQQ1N1cGVyY2xhc3MoKSA9PSBudWxsKQogICAg\nICAgICAgICByZXR1cm4gbWV0YS5nZXRQcmltYXJ5S2V5RmllbGRzKCk7Cgog\nICAgICAgIC8vIHJlbW92ZSB0aGUgcHJpbWFyeSBrZXkgZmllbGRzIHRoYXQg\nYXJlIG5vdCBkZWNsYXJlZAogICAgICAgIC8vIGluIHRoZSBjdXJyZW50IGNs\nYXNzCiAgICAgICAgRmllbGRNZXRhRGF0YVtdIGZpZWxkcyA9IG1ldGEuZ2V0\nUHJpbWFyeUtleUZpZWxkcygpOwogICAgICAgIExpc3QgZGVjcyA9IG5ldyBB\ncnJheUxpc3QoZmllbGRzLmxlbmd0aCk7CiAgICAgICAgZm9yIChpbnQgaSA9\nIDA7IGkgPCBmaWVsZHMubGVuZ3RoOyBpKyspCiAgICAgICAgICAgIGlmIChm\naWVsZHNbaV0uZ2V0RGVjbGFyaW5nVHlwZSgpID09IG1ldGEuZ2V0RGVzY3Jp\nYmVkVHlwZSgpKQogICAgICAgICAgICAgICAgZGVjcy5hZGQoZmllbGRzW2ld\nKTsKICAgICAgICByZXR1cm4gKEZpZWxkTWV0YURhdGFbXSkgZGVjcy50b0Fy\ncmF5KG5ldyBGaWVsZE1ldGFEYXRhW2RlY3Muc2l6ZSgpXSk7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBSZXR1cm4gZmFsc2UgaWYgdGhpcyB0b29sIGlzIGNv\nbmZpZ3VyZWQgdG8gdGhyb3cgYW4gZXhjZXB0aW9uIG9uCiAgICAgKiBhbiBh\ndHRlbXB0IHRvIGdlbmVyYXRlIGFuIGlkIGNsYXNzIGZvciBhIHR5cGUgdGhh\ndCBkb2VzIG5vdCB1c2UKICAgICAqIGFwcGxpY2F0aW9uIGlkZW50aXR5Lgog\nICAgICovCiAgICBwdWJsaWMgYm9vbGVhbiBnZXRJZ25vcmVFcnJvcnMoKSB7\nCiAgICAgICAgcmV0dXJuIF9pZ25vcmU7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBTZXQgdG8gZmFsc2UgaWYgdGhpcyB0b29sIHNob3VsZCB0aHJvdyBhbiBl\neGNlcHRpb24gb24KICAgICAqIGFuIGF0dGVtcHQgdG8gZ2VuZXJhdGUgYW4g\naWQgY2xhc3MgZm9yIGEgdHlwZSB0aGF0IGRvZXMgbm90IHVzZQogICAgICog\nYXBwbGljYXRpb24gaWRlbnRpdHkuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lk\nIHNldElnbm9yZUVycm9ycyhib29sZWFuIGlnbm9yZSkgewogICAgICAgIF9p\nZ25vcmUgPSBpZ25vcmU7CiAgICB9CgogICAgLyoqCiAgICAgKiBUaGUgY29k\nZSBmb3JtYXR0ZXIgZm9yIHRoZSBnZW5lcmF0ZWQgSmF2YSBjb2RlLgogICAg\nICovCiAgICBwdWJsaWMgQ29kZUZvcm1hdCBnZXRDb2RlRm9ybWF0KCkgewog\nICAgICAgIHJldHVybiBfZm9ybWF0OwogICAgfQoKICAgIC8qKgogICAgICog\nU2V0IHRoZSBjb2RlIGZvcm1hdHRlciBmb3IgdGhlIGdlbmVyYXRlZCBKYXZh\nIGNvZGUuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldENvZGVGb3JtYXQo\nQ29kZUZvcm1hdCBmb3JtYXQpIHsKICAgICAgICBfZm9ybWF0ID0gZm9ybWF0\nOwogICAgfQoKICAgIC8qKgogICAgICogVGhlIGRpcmVjdG9yeSB0byB3cml0\nZSBzb3VyY2UgdG8uIERlZmF1bHRzIHRvIHRoZSBkaXJlY3RvcnkKICAgICAq\nIG9mIHRoZSBKYXZhIGZpbGUgZm9yIHRoZSBzZXQgdHlwZS4gSWYgdGhlIGdp\ndmVuIGRpcmVjdG9yeSBkb2VzIG5vdAogICAgICogbWF0Y2ggdGhlIHBhY2th\nZ2Ugb2YgdGhlIG9iamVjdCBpZCwgdGhlIHBhY2thZ2Ugc3RydWN0dXJlIHdp\nbGwgYmUKICAgICAqIGNyZWF0ZWQgYmVsb3cgdGhlIGRpcmVjdG9yeS4KICAg\nICAqLwogICAgcHVibGljIEZpbGUgZ2V0RGlyZWN0b3J5KCkgewogICAgICAg\nIHJldHVybiBfZGlyOwogICAgfQoKICAgIC8qKgogICAgICogVGhlIGRpcmVj\ndG9yeSB0byB3cml0ZSBzb3VyY2UgdG8uIERlZmF1bHRzIHRvIHRoZSBkaXJl\nY3RvcnkKICAgICAqIG9mIHRoZSBKYXZhIGZpbGUgZm9yIHRoZSBzZXQgdHlw\nZS4gSWYgdGhlIGdpdmVuIGRpcmVjdG9yeSBkb2VzIG5vdAogICAgICogbWF0\nY2ggdGhlIHBhY2thZ2Ugb2YgdGhlIG9iamVjdCBpZCwgdGhlIHBhY2thZ2Ug\nc3RydWN0dXJlIHdpbGwgYmUKICAgICAqIGNyZWF0ZWQgYmVsb3cgdGhlIGRp\ncmVjdG9yeS4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0RGlyZWN0b3J5\nKEZpbGUgZGlyKSB7CiAgICAgICAgX2RpciA9IGRpcjsKICAgIH0KCiAgICAv\nKioKICAgICAqIFRoZSB0b2tlbiB0byB1c2UgdG8gc2VwYXJhdGUgc3RyaW5n\naWZpZWQgcHJpbWFyeSBrZXkgZmllbGQgdmFsdWVzLgogICAgICovCiAgICBw\ndWJsaWMgU3RyaW5nIGdldFRva2VuKCkgewogICAgICAgIHJldHVybiBfdG9r\nZW47CiAgICB9CgogICAgLyoqCiAgICAgKiBUaGUgdG9rZW4gdG8gdXNlIHRv\nIHNlcGFyYXRlIHN0cmluZ2lmaWVkIHByaW1hcnkga2V5IGZpZWxkIHZhbHVl\ncy4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0VG9rZW4oU3RyaW5nIHRv\na2VuKSB7CiAgICAgICAgX3Rva2VuID0gdG9rZW47CiAgICB9CgogICAgLyoq\nCiAgICAgKiBUaGUgd3JpdGVyIHRvIHdyaXRlIHNvdXJjZSB0bywgb3IgbnVs\nbCB0byB3cml0ZSB0byBkZWZhdWx0IGZpbGUuCiAgICAgKi8KICAgIHB1Ymxp\nYyBXcml0ZXIgZ2V0V3JpdGVyKCkgewogICAgICAgIHJldHVybiBfd3JpdGVy\nOwogICAgfQoKICAgIC8qKgogICAgICogVGhlIHdyaXRlciB0byB3cml0ZSBz\nb3VyY2UgdG8sIG9yIG51bGwgdG8gd3JpdGUgdG8gZGVmYXVsdCBmaWxlLgog\nICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRXcml0ZXIoV3JpdGVyIHdyaXRl\ncikgewogICAgICAgIF93cml0ZXIgPSB3cml0ZXI7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBSZXR1cm4gdGhlIHR5cGUgd2UgYXJlIGdlbmVyYXRpbmcgYW4g\nYXBwbGljYXRpb24gaWQgZm9yLgogICAgICovCiAgICBwdWJsaWMgQ2xhc3Mg\nZ2V0VHlwZSgpIHsKICAgICAgICByZXR1cm4gX3R5cGU7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBSZXR1cm4gbWV0YWRhdGEgZm9yIHRoZSB0eXBlIHdlIGFy\nZSBnZW5lcmF0aW5nIGFuIGFwcGxpY2F0aW9uIGlkIGZvci4KICAgICAqLwog\nICAgcHVibGljIENsYXNzTWV0YURhdGEgZ2V0TWV0YURhdGEoKSB7CiAgICAg\nICAgcmV0dXJuIF9tZXRhOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJu\nIHRoZSBjb2RlIGdlbmVyYXRlZCBmb3IgdGhlIGFwcGxpY2F0aW9uIGlkLCBv\nciBudWxsCiAgICAgKiBpZiBpbnZhbGlkIGNsYXNzIG9yIHRoZSB7QGxpbmsg\nI3J1bn0gbWV0aG9kIGhhcyBub3QgYmVlbiBjYWxsZWQuCiAgICAgKi8KICAg\nIHB1YmxpYyBTdHJpbmcgZ2V0Q29kZSgpIHsKICAgICAgICByZXR1cm4gX2Nv\nZGU7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm5zIHRydWUgaWYgdGhl\nIGFwcGxpY2F0aW9uIGlkZW50aXR5IGNsYXNzIHNob3VsZCBiZSBhbiBpbm5l\nciBjbGFzcy4KICAgICAqLwogICAgcHVibGljIGJvb2xlYW4gaXNJbm5lckNs\nYXNzKCkgewogICAgICAgIENsYXNzIG9pZENsYXNzID0gX21ldGEuZ2V0T2Jq\nZWN0SWRUeXBlKCk7CiAgICAgICAgcmV0dXJuIG9pZENsYXNzLmdldE5hbWUo\nKS5pbmRleE9mKCckJykgIT0gLTE7CiAgICB9CgogICAgLyoqCiAgICAgKiBS\nZXR1cm5zIHRoZSBzaG9ydCBjbGFzcyBuYW1lIGZvciB0aGUgb2JqZWN0IGlk\nIGNsYXNzLgogICAgICovCiAgICBwcml2YXRlIFN0cmluZyBnZXRDbGFzc05h\nbWUoKSB7CiAgICAgICAgaWYgKF9tZXRhLmlzT3BlbkpQQUlkZW50aXR5KCkp\nCiAgICAgICAgICAgIHJldHVybiBudWxsOwoKICAgICAgICAvLyBjb252ZXJ0\nIGZyb20gU29tZUNsYXNzJElEIHRvIElECiAgICAgICAgU3RyaW5nIGNsYXNz\nTmFtZSA9IFN0cmluZ3MuZ2V0Q2xhc3NOYW1lKF9tZXRhLmdldE9iamVjdElk\nVHlwZSgpKTsKICAgICAgICBpZiAoaXNJbm5lckNsYXNzKCkpCiAgICAgICAg\nICAgIGNsYXNzTmFtZSA9IGNsYXNzTmFtZS5zdWJzdHJpbmcoY2xhc3NOYW1l\nLmxhc3RJbmRleE9mKCckJykgKyAxKTsKICAgICAgICByZXR1cm4gY2xhc3NO\nYW1lOwogICAgfQoKICAgIC8qKgogICAgICogR2VuZXJhdGVzIHRoZSBzb3Vy\nY2Vjb2RlIGZvciB0aGUgYXBwbGljYXRpb24gaWQgY2xhc3M7IHJldHVybnMK\nICAgICAqIGZhbHNlIGlmIHRoZSBjbGFzcyBpcyBpbnZhbGlkLgogICAgICov\nCiAgICBwdWJsaWMgYm9vbGVhbiBydW4oKSB7CiAgICAgICAgaWYgKF9sb2cu\naXNJbmZvRW5hYmxlZCgpKQogICAgICAgICAgICBfbG9nLmluZm8oX2xvYy5n\nZXQoImFwcGlkLXN0YXJ0IiwgX3R5cGUpKTsKCiAgICAgICAgLy8gZW5zdXJl\nIHRoYXQgdGhpcyB0eXBlIGlzIGEgY2FuZGlkYXRlIGZvciBhcHBsaWNhdGlv\nbiBpZGVudGl0eQogICAgICAgIGlmIChfbWV0YSA9PSBudWxsCiAgICAgICAg\nICAgIHx8IF9tZXRhLmdldElkZW50aXR5VHlwZSgpICE9IENsYXNzTWV0YURh\ndGEuSURfQVBQTElDQVRJT04KICAgICAgICAgICAgfHwgX21ldGEuaXNPcGVu\nSlBBSWRlbnRpdHkoKSkgewogICAgICAgICAgICBpZiAoIV9pZ25vcmUpCiAg\nICAgICAgICAgICAgICB0aHJvdyBuZXcgVXNlckV4Y2VwdGlvbihfbG9jLmdl\ndCgiYXBwaWQtaW52YWxpZCIsIF90eXBlKSk7CgogICAgICAgICAgICAvLyBl\nbHNlIGp1c3Qgd2FybgogICAgICAgICAgICBpZiAoX2xvZy5pc1dhcm5FbmFi\nbGVkKCkpCiAgICAgICAgICAgICAgICBfbG9nLndhcm4oX2xvYy5nZXQoImFw\ncGlkLXdhcm4iLCBfdHlwZSkpOwogICAgICAgICAgICByZXR1cm4gZmFsc2U7\nCiAgICAgICAgfQoKICAgICAgICBDbGFzcyBvaWRDbGFzcyA9IF9tZXRhLmdl\ndE9iamVjdElkVHlwZSgpOwogICAgICAgIENsYXNzIHN1cGVyT2lkQ2xhc3Mg\nPSBudWxsOwoKICAgICAgICAvLyBhbGxvdyBkaWZmIG9pZCBjbGFzcyBpbiBz\ndWJjbGFzcyAoaG9yaXpvbnRhbCkKICAgICAgICBpZiAoX21ldGEuZ2V0UENT\ndXBlcmNsYXNzKCkgIT0gbnVsbCkgewogICAgICAgICAgICBzdXBlck9pZENs\nYXNzID0gX21ldGEuZ2V0UENTdXBlcmNsYXNzTWV0YURhdGEoKS5nZXRPYmpl\nY3RJZFR5cGUoKTsKICAgICAgICAgICAgaWYgKG9pZENsYXNzID09IG51bGwg\nfHwgb2lkQ2xhc3MuZXF1YWxzKHN1cGVyT2lkQ2xhc3MpKSB7CiAgICAgICAg\nICAgICAgICAvLyBqdXN0IHdhcm4KICAgICAgICAgICAgICAgIGlmIChfbG9n\nLmlzV2FybkVuYWJsZWQoKSkKICAgICAgICAgICAgICAgICAgICBfbG9nLndh\ncm4oX2xvYy5nZXQoImFwcGlkLXdhcm4iLCBfdHlwZSkpOwogICAgICAgICAg\nICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICB9CiAgICAgICAgfQoK\nICAgICAgICAvLyBlbnN1cmUgdGhhdCBhbiBpZCBjbGFzcyBpcyBkZWNsYXJl\nZAogICAgICAgIGlmIChvaWRDbGFzcyA9PSBudWxsKQogICAgICAgICAgICB0\naHJvdyBuZXcgVXNlckV4Y2VwdGlvbihfbG9jLmdldCgibm8taWQtY2xhc3Mi\nLCBfdHlwZSkpLgogICAgICAgICAgICAgICAgc2V0RmF0YWwodHJ1ZSk7Cgog\nICAgICAgIC8vIGVuc3VyZSB0aGVyZSBpcyBhdCBsZWFzdCBvbmUgcGsgZmll\nbGQgaWYgd2UgYXJlCiAgICAgICAgLy8gbm9uLWFic3JhY3QsIGFuZCBzZWUg\naWYgd2UgaGF2ZSBhbnkgYnl0ZVtdCiAgICAgICAgYm9vbGVhbiBieXRlcyA9\nIGZhbHNlOwogICAgICAgIGZvciAoaW50IGkgPSAwOyAhYnl0ZXMgJiYgaSA8\nIF9maWVsZHMubGVuZ3RoOyBpKyspCiAgICAgICAgICAgIGJ5dGVzID0gX2Zp\nZWxkc1tpXS5nZXREZWNsYXJlZFR5cGUoKSA9PSBieXRlW10uY2xhc3M7Cgog\nICAgICAgIC8vIGNvbGxlY3QgaW5mbyBvbiBpZCB0eXBlCiAgICAgICAgU3Ry\naW5nIGNsYXNzTmFtZSA9IGdldENsYXNzTmFtZSgpOwogICAgICAgIFN0cmlu\nZyBwYWNrYWdlTmFtZSA9IFN0cmluZ3MuZ2V0UGFja2FnZU5hbWUob2lkQ2xh\nc3MpOwogICAgICAgIFN0cmluZyBwYWNrYWdlRGVjID0gIiI7CiAgICAgICAg\naWYgKHBhY2thZ2VOYW1lLmxlbmd0aCgpID4gMCkKICAgICAgICAgICAgcGFj\na2FnZURlYyA9ICJwYWNrYWdlICIgKyBwYWNrYWdlTmFtZSArICI7IjsKCiAg\nICAgICAgU3RyaW5nIGltcG9ydHMgPSBnZXRJbXBvcnRzKCk7CiAgICAgICAg\nU3RyaW5nIGZpZWxkRGVjcyA9IGdldEZpZWxkRGVjbGFyYXRpb25zKCk7CiAg\nICAgICAgU3RyaW5nIGNvbnN0cnVjdG9yID0gZ2V0Q29uc3RydWN0b3Ioc3Vw\nZXJPaWRDbGFzcyAhPSBudWxsKTsKICAgICAgICBTdHJpbmcgcHJvcGVydGll\ncyA9IGdldFByb3BlcnRpZXMoKTsKICAgICAgICBTdHJpbmcgZnJvbVN0cmlu\nZ0NvZGUgPSBnZXRGcm9tU3RyaW5nQ29kZShzdXBlck9pZENsYXNzICE9IG51\nbGwpOwogICAgICAgIFN0cmluZyB0b1N0cmluZ0NvZGUgPSBnZXRUb1N0cmlu\nZ0NvZGUoc3VwZXJPaWRDbGFzcyAhPSBudWxsKTsKICAgICAgICBTdHJpbmcg\nZXF1YWxzQ29kZSA9IGdldEVxdWFsc0NvZGUoc3VwZXJPaWRDbGFzcyAhPSBu\ndWxsKTsKICAgICAgICBTdHJpbmcgaGFzaENvZGVDb2RlID0gZ2V0SGFzaENv\nZGVDb2RlKHN1cGVyT2lkQ2xhc3MgIT0gbnVsbCk7CgogICAgICAgIC8vIGJ1\naWxkIHRoZSBqYXZhIGNvZGUKICAgICAgICBDb2RlRm9ybWF0IGNvZGUgPSBu\nZXdDb2RlRm9ybWF0KCk7CiAgICAgICAgaWYgKCFpc0lubmVyQ2xhc3MoKSAm\nJiBwYWNrYWdlRGVjLmxlbmd0aCgpID4gMCkKICAgICAgICAgICAgY29kZS5h\ncHBlbmQocGFja2FnZURlYykuYWZ0ZXJTZWN0aW9uKCk7CgogICAgICAgIGlm\nICghaXNJbm5lckNsYXNzKCkgJiYgaW1wb3J0cy5sZW5ndGgoKSA+IDApCiAg\nICAgICAgICAgIGNvZGUuYXBwZW5kKGltcG9ydHMpLmFmdGVyU2VjdGlvbigp\nOwoKICAgICAgICBjb2RlLmFwcGVuZCgiLyoqIikuZW5kbCgpLgogICAgICAg\nICAgICBhcHBlbmQoIiAqICIpLgogICAgICAgICAgICBhcHBlbmQoX2xvYy5n\nZXQoImFwcGlkLWNvbW1lbnQtZm9yIiwgX3R5cGUuZ2V0TmFtZSgpKSkuCiAg\nICAgICAgICAgIGVuZGwoKS4KICAgICAgICAgICAgYXBwZW5kKCIgKiIpLmVu\nZGwoKS4KICAgICAgICAgICAgYXBwZW5kKCIgKiAiKS5hcHBlbmQoX2xvYy5n\nZXQoImFwcGlkLWNvbW1lbnQtZ2VuIikpLmVuZGwoKS4KICAgICAgICAgICAg\nYXBwZW5kKCIgKiAiKS5hcHBlbmQoZ2V0Q2xhc3MoKS5nZXROYW1lKCkpLmVu\nZGwoKS4KICAgICAgICAgICAgYXBwZW5kKCIgKi8iKS5lbmRsKCk7CiAgICAg\nICAgY29kZS5hcHBlbmQoInB1YmxpYyAiKTsKICAgICAgICBpZiAoaXNJbm5l\nckNsYXNzKCkpCiAgICAgICAgICAgIGNvZGUuYXBwZW5kKCJzdGF0aWMgIik7\nCiAgICAgICAgY29kZS5hcHBlbmQoImNsYXNzICIpLmFwcGVuZChjbGFzc05h\nbWUpOwogICAgICAgIGlmIChjb2RlLmdldEJyYWNlT25TYW1lTGluZSgpKQog\nICAgICAgICAgICBjb2RlLmFwcGVuZCgiICIpOwogICAgICAgIGVsc2UKICAg\nICAgICAgICAgY29kZS5lbmRsKCkudGFiKCk7CgogICAgICAgIGlmIChzdXBl\nck9pZENsYXNzICE9IG51bGwpIHsKICAgICAgICAgICAgY29kZS5hcHBlbmQo\nImV4dGVuZHMgIiArIFN0cmluZ3MuZ2V0Q2xhc3NOYW1lKHN1cGVyT2lkQ2xh\nc3MpKTsKICAgICAgICAgICAgaWYgKGNvZGUuZ2V0QnJhY2VPblNhbWVMaW5l\nKCkpCiAgICAgICAgICAgICAgICBjb2RlLmFwcGVuZCgiICIpOwogICAgICAg\nICAgICBlbHNlCiAgICAgICAgICAgICAgICBjb2RlLmVuZGwoKS50YWIoKTsK\nICAgICAgICB9CiAgICAgICAgY29kZS5hcHBlbmQoImltcGxlbWVudHMgU2Vy\naWFsaXphYmxlIikub3BlbkJyYWNlKDEpLmVuZGwoKTsKCiAgICAgICAgLy8g\naWYgd2UgdXNlIGEgYnl0ZSBhcnJheSB3ZSBuZWVkIGEgc3RhdGljIGFycmF5\nIGZvciBlbmNvZGluZyB0byBzdHJpbmcKICAgICAgICBpZiAoYnl0ZXMpIHsK\nICAgICAgICAgICAgY29kZS50YWIoKS5hcHBlbmQoInByaXZhdGUgc3RhdGlj\nIGZpbmFsIGNoYXJbXSBIRVggPSAiKS4KICAgICAgICAgICAgICAgIGFwcGVu\nZCgibmV3IGNoYXJbXSB7IikuZW5kbCgpOwogICAgICAgICAgICBjb2RlLnRh\nYigyKS5hcHBlbmQoIicwJywgJzEnLCAnMicsICczJywgJzQnLCAnNScsICc2\nJywgJzcnLCIpLgogICAgICAgICAgICAgICAgZW5kbCgpOwogICAgICAgICAg\nICBjb2RlLnRhYigyKS5hcHBlbmQoIic4JywgJzknLCAnQScsICdCJywgJ0Mn\nLCAnRCcsICdFJywgJ0YnIikuCiAgICAgICAgICAgICAgICBlbmRsKCk7CiAg\nICAgICAgICAgIGNvZGUudGFiKCkuYXBwZW5kKCJ9OyIpLmVuZGwoMik7CiAg\nICAgICAgfQoKICAgICAgICAvLyBzdGF0aWMgYmxvY2sgdG8gcmVnaXN0ZXIg\nY2xhc3MKICAgICAgICBjb2RlLnRhYigpLmFwcGVuZCgic3RhdGljIikub3Bl\nbkJyYWNlKDIpLmVuZGwoKTsKICAgICAgICBjb2RlLnRhYigyKS5hcHBlbmQo\nIi8vIHJlZ2lzdGVyIHBlcnNpc3RlbnQgY2xhc3MgaW4gSlZNIikuZW5kbCgp\nOwogICAgICAgIGlmIChKYXZhVmVyc2lvbnMuVkVSU0lPTiA+PSA1KSB7CiAg\nICAgICAgICAgIGNvZGUudGFiKDIpLmFwcGVuZCgidHJ5IHsgQ2xhc3MuZm9y\nTmFtZSIpLm9wZW5QYXJlbih0cnVlKS4KICAgICAgICAgICAgICAgIGFwcGVu\nZCgiXCIiKS5hcHBlbmQoX3R5cGUuZ2V0TmFtZSgpKS5hcHBlbmQoIlwiIiku\nCiAgICAgICAgICAgICAgICBjbG9zZVBhcmVuKCkuYXBwZW5kKCI7IikuYXBw\nZW5kKCIgfSIpLmVuZGwoKTsKICAgICAgICAgICAgY29kZS50YWIoMikuYXBw\nZW5kKCJjYXRjaCIpLm9wZW5QYXJlbih0cnVlKS4KICAgICAgICAgICAgICAg\nIGFwcGVuZCgiRXhjZXB0aW9uIGUiKS5jbG9zZVBhcmVuKCkuYXBwZW5kKCIg\ne30iKS5lbmRsKCk7CiAgICAgICAgfSBlbHNlCiAgICAgICAgICAgIGNvZGUu\ndGFiKDIpLmFwcGVuZCgiQ2xhc3MgYyA9ICIpLmFwcGVuZChfdHlwZS5nZXRO\nYW1lKCkpLgogICAgICAgICAgICAgICAgYXBwZW5kKCIuY2xhc3M7IikuZW5k\nbCgpOwogICAgICAgIGNvZGUuY2xvc2VCcmFjZSgyKTsKCiAgICAgICAgLy8g\nZmllbGQgZGVjbGFyYXRpb25zCiAgICAgICAgaWYgKGZpZWxkRGVjcy5sZW5n\ndGgoKSA+IDApCiAgICAgICAgICAgIGNvZGUuZW5kbCgyKS5hcHBlbmQoZmll\nbGREZWNzKTsKCiAgICAgICAgLy8gZGVmYXVsdCBjb25zdHJ1Y3RvcgogICAg\nICAgIGNvZGUuYWZ0ZXJTZWN0aW9uKCkudGFiKCkuYXBwZW5kKCJwdWJsaWMg\nIikuYXBwZW5kKGNsYXNzTmFtZSkuCiAgICAgICAgICAgIHBhcmVucygpLm9w\nZW5CcmFjZSgyKS5lbmRsKCk7CiAgICAgICAgY29kZS5jbG9zZUJyYWNlKDIp\nOwoKICAgICAgICAvLyBzdHJpbmcgY29uc3RydWN0b3IKICAgICAgICBjb2Rl\nLmFmdGVyU2VjdGlvbigpLmFwcGVuZChjb25zdHJ1Y3Rvcik7CgogICAgICAg\nIC8vIHByb3BlcnRpZXMKICAgICAgICBpZiAocHJvcGVydGllcy5sZW5ndGgo\nKSA+IDApCiAgICAgICAgICAgIGNvZGUuYWZ0ZXJTZWN0aW9uKCkuYXBwZW5k\nKHByb3BlcnRpZXMpOwoKICAgICAgICAvLyB0b1N0cmluZywgZXF1YWxzLCBo\nYXNoQ29kZSBtZXRob2RzCiAgICAgICAgaWYgKHRvU3RyaW5nQ29kZS5sZW5n\ndGgoKSA+IDApCiAgICAgICAgICAgIGNvZGUuYWZ0ZXJTZWN0aW9uKCkuYXBw\nZW5kKHRvU3RyaW5nQ29kZSk7CiAgICAgICAgaWYgKGhhc2hDb2RlQ29kZS5s\nZW5ndGgoKSA+IDApCiAgICAgICAgICAgIGNvZGUuYWZ0ZXJTZWN0aW9uKCku\nYXBwZW5kKGhhc2hDb2RlQ29kZSk7CiAgICAgICAgaWYgKGVxdWFsc0NvZGUu\nbGVuZ3RoKCkgPiAwKQogICAgICAgICAgICBjb2RlLmFmdGVyU2VjdGlvbigp\nLmFwcGVuZChlcXVhbHNDb2RlKTsKICAgICAgICBpZiAoZnJvbVN0cmluZ0Nv\nZGUubGVuZ3RoKCkgPiAwKQogICAgICAgICAgICBjb2RlLmFmdGVyU2VjdGlv\nbigpLmFwcGVuZChmcm9tU3RyaW5nQ29kZSk7CgogICAgICAgIC8vIGlmIHdl\nIGhhdmUgYW55IGJ5dGUgYXJyYXkgZmllbGRzLCB3ZSBoYXZlIHRvIGFkZCB0\naGUgZXh0cmEKICAgICAgICAvLyBtZXRob2RzIGZvciBoYW5kbGluZyBieXRl\nIGFycmF5cwogICAgICAgIGlmIChieXRlcykgewogICAgICAgICAgICBjb2Rl\nLmFmdGVyU2VjdGlvbigpLmFwcGVuZChnZXRUb0J5dGVzQnl0ZUFycmF5Q29k\nZSgpKTsKICAgICAgICAgICAgY29kZS5hZnRlclNlY3Rpb24oKS5hcHBlbmQo\nZ2V0VG9TdHJpbmdCeXRlQXJyYXlDb2RlKCkpOwogICAgICAgICAgICBjb2Rl\nLmFmdGVyU2VjdGlvbigpLmFwcGVuZChnZXRFcXVhbHNCeXRlQXJyYXlDb2Rl\nKCkpOwogICAgICAgICAgICBjb2RlLmFmdGVyU2VjdGlvbigpLmFwcGVuZChn\nZXRIYXNoQ29kZUJ5dGVBcnJheUNvZGUoKSk7CiAgICAgICAgfQoKICAgICAg\nICAvLyBiYXNlIGNsYXNzZXMgbWlnaHQgbmVlZCB0byBkZWZpbmUgYSBjdXN0\nb20gdG9rZW5pemVyCiAgICAgICAgaWYgKHN1cGVyT2lkQ2xhc3MgPT0gbnVs\nbCAmJiBnZXRUb2tlbml6ZXIoZmFsc2UpID09IFRPS0VOSVpFUl9DVVNUT00p\nCiAgICAgICAgICAgIGNvZGUuYWZ0ZXJTZWN0aW9uKCkuYXBwZW5kKGdldEN1\nc3RvbVRva2VuaXplckNsYXNzKCkpOwoKICAgICAgICBjb2RlLmVuZGwoKTsK\nICAgICAgICBjb2RlLmNsb3NlQnJhY2UoMSk7CgogICAgICAgIF9jb2RlID0g\nY29kZS50b1N0cmluZygpOwoKICAgICAgICAvLyBpZiB0aGlzIGlzIGFuIGlu\nbmVyIGNsYXNzLCB0aGVuIGluZGVudCB0aGUgZW50aXJlCiAgICAgICAgLy8g\nY29kZSB1bml0IG9uZSB0YWIgbGV2ZWwKICAgICAgICBpZiAoaXNJbm5lckNs\nYXNzKCkpIHsKICAgICAgICAgICAgLy8gaW5kZW50IHRoZSBlbnRpcmUgY29k\nZSBibG9jayBvbmUgbGV2ZWwgdG8gbWFrZSBpdAogICAgICAgICAgICAvLyBh\nIHByb3BlcnRseSBpbmRlbnRlZCBpbm5kZXIgY2xhc3MKICAgICAgICAgICAg\nX2NvZGUgPSBjb2RlLmdldFRhYigpICsgU3RyaW5ncy5yZXBsYWNlKF9jb2Rl\nLAogICAgICAgICAgICAgICAgSjJEb1ByaXZIZWxwZXIuZ2V0TGluZVNlcGFy\nYXRvcigpLAogICAgICAgICAgICAgICAgSjJEb1ByaXZIZWxwZXIuZ2V0TGlu\nZVNlcGFyYXRvcigpICsgY29kZS5nZXRUYWIoKSk7CiAgICAgICAgfQoKICAg\nICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvKioKICAgICAqIFdyaXRl\ncyB0aGUgZ2VuZXJhdGVkIGNvZGUgdG8gdGhlIHByb3BlciBmaWxlLgogICAg\nICovCiAgICBwdWJsaWMgdm9pZCByZWNvcmQoKQogICAgICAgIHRocm93cyBJ\nT0V4Y2VwdGlvbiB7CiAgICAgICAgaWYgKF9jb2RlID09IG51bGwpCiAgICAg\nICAgICAgIHJldHVybjsKCiAgICAgICAgV3JpdGVyIHdyaXRlciA9IF93cml0\nZXI7CiAgICAgICAgaWYgKHdyaXRlciA9PSBudWxsKSB7CiAgICAgICAgICAg\nIEZpbGUgZmlsZSA9IGdldEZpbGUoKTsKICAgICAgICAgICAgRmlsZXMuYmFj\na3VwKGZpbGUsIGZhbHNlKTsKICAgICAgICAgICAgd3JpdGVyID0gbmV3IEZp\nbGVXcml0ZXIoZmlsZSk7CiAgICAgICAgfQoKICAgICAgICBQcmludFdyaXRl\nciBwcmludGVyID0gbmV3IFByaW50V3JpdGVyKHdyaXRlcik7CiAgICAgICAg\ncHJpbnRlci5wcmludChfY29kZSk7CiAgICAgICAgcHJpbnRlci5mbHVzaCgp\nOwoKICAgICAgICBpZiAoX3dyaXRlciA9PSBudWxsKQogICAgICAgICAgICB3\ncml0ZXIuY2xvc2UoKTsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0\naGUgbmVjZXNzYXJ5IGltcG9ydHMgZm9yIHRoZSBjbGFzcy4KICAgICAqLwog\nICAgcHJpdmF0ZSBTdHJpbmcgZ2V0SW1wb3J0cygpIHsKICAgICAgICBTZXQg\ncGtncyA9IGdldEltcG9ydFBhY2thZ2VzKCk7CgogICAgICAgIENvZGVGb3Jt\nYXQgaW1wb3J0cyA9IG5ld0NvZGVGb3JtYXQoKTsKICAgICAgICBTdHJpbmcg\nYmFzZSA9IFN0cmluZ3MuZ2V0UGFja2FnZU5hbWUoX21ldGEuZ2V0T2JqZWN0\nSWRUeXBlKCkpOwogICAgICAgIFN0cmluZyBwa2c7CiAgICAgICAgZm9yIChJ\ndGVyYXRvciBpdHIgPSBwa2dzLml0ZXJhdG9yKCk7IGl0ci5oYXNOZXh0KCk7\nKSB7CiAgICAgICAgICAgIHBrZyA9IChTdHJpbmcpIGl0ci5uZXh0KCk7CiAg\nICAgICAgICAgIGlmIChwa2cubGVuZ3RoKCkgPiAwICYmICEiamF2YS5sYW5n\nIi5lcXVhbHMocGtnKQogICAgICAgICAgICAgICAgJiYgIWJhc2UuZXF1YWxz\nKHBrZykpIHsKICAgICAgICAgICAgICAgIGlmIChpbXBvcnRzLmxlbmd0aCgp\nID4gMCkKICAgICAgICAgICAgICAgICAgICBpbXBvcnRzLmVuZGwoKTsKICAg\nICAgICAgICAgICAgIGltcG9ydHMuYXBwZW5kKCJpbXBvcnQgIikuYXBwZW5k\nKHBrZykuYXBwZW5kKCIuKjsiKTsKICAgICAgICAgICAgfQogICAgICAgIH0K\nICAgICAgICByZXR1cm4gaW1wb3J0cy50b1N0cmluZygpOwogICAgfQoKICAg\nIC8qKgogICAgICogUmV0dXJucyB0aGUgY29sbGVjdGlvbiBvZiBwYWNrYWdl\ncyB0aGF0IG5lZWQgdG8gYmUgaW1wb3J0ZWQuCiAgICAgKi8KICAgIHB1Ymxp\nYyBTZXQgZ2V0SW1wb3J0UGFja2FnZXMoKSB7CiAgICAgICAgU2V0IHBrZ3Mg\nPSBuZXcgVHJlZVNldCgpOwogICAgICAgIHBrZ3MuYWRkKFN0cmluZ3MuZ2V0\nUGFja2FnZU5hbWUoX3R5cGUpKTsKCiAgICAgICAgQ2xhc3Mgc3VwZXJPaWRD\nbGFzcyA9IG51bGw7CiAgICAgICAgaWYgKF9tZXRhICE9IG51bGwgJiYgX21l\ndGEuZ2V0UENTdXBlcmNsYXNzTWV0YURhdGEoKSAhPSBudWxsKQogICAgICAg\nICAgICBzdXBlck9pZENsYXNzID0gX21ldGEuZ2V0UENTdXBlcmNsYXNzTWV0\nYURhdGEoKS5nZXRPYmplY3RJZFR5cGUoKTsKICAgICAgICBpZiAoc3VwZXJP\naWRDbGFzcyAhPSBudWxsKQogICAgICAgICAgICBwa2dzLmFkZChTdHJpbmdz\nLmdldFBhY2thZ2VOYW1lKHN1cGVyT2lkQ2xhc3MpKTsKCiAgICAgICAgcGtn\ncy5hZGQoImphdmEuaW8iKTsKICAgICAgICBwa2dzLmFkZCgiamF2YS51dGls\nIik7CiAgICAgICAgQ2xhc3MgdHlwZTsKICAgICAgICBmb3IgKGludCBpID0g\nMDsgaSA8IF9maWVsZHMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgdHlw\nZSA9IF9maWVsZHNbaV0uZ2V0T2JqZWN0SWRGaWVsZFR5cGUoKTsKICAgICAg\nICAgICAgaWYgKHR5cGUgIT0gYnl0ZVtdLmNsYXNzICYmIHR5cGUgIT0gY2hh\ncltdLmNsYXNzCiAgICAgICAgICAgICAgICAmJiAhdHlwZS5nZXROYW1lKCku\nc3RhcnRzV2l0aCgiamF2YS5zcWwuIikpIHsKICAgICAgICAgICAgICAgIHBr\nZ3MuYWRkKFN0cmluZ3MuZ2V0UGFja2FnZU5hbWUodHlwZSkpOwogICAgICAg\nICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiBwa2dzOwogICAgfQoK\nICAgIC8qKgogICAgICogUmV0dXJuIHRoZSBjb2RlIHRvIGRlY2xhcmUgYWxs\nIHByaW1hcnkga2V5IGZpZWxkcy4KICAgICAqLwogICAgcHJpdmF0ZSBTdHJp\nbmcgZ2V0RmllbGREZWNsYXJhdGlvbnMoKSB7CiAgICAgICAgQ29kZUZvcm1h\ndCBjb2RlID0gbmV3Q29kZUZvcm1hdCgpOwogICAgICAgIGZvciAoaW50IGkg\nPSAwOyBpIDwgX2ZpZWxkcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBp\nZiAoaSA+IDApCiAgICAgICAgICAgICAgICBjb2RlLmVuZGwoKTsKICAgICAg\nICAgICAgY29kZS50YWIoKS5hcHBlbmQoInB1YmxpYyAiKS5hcHBlbmQoZ2V0\nVHlwZU5hbWUoX2ZpZWxkc1tpXSkpLgogICAgICAgICAgICAgICAgYXBwZW5k\nKCIgIikuYXBwZW5kKF9maWVsZHNbaV0uZ2V0TmFtZSgpKS5hcHBlbmQoIjsi\nKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGNvZGUudG9TdHJpbmcoKTsK\nICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgdHlwZSBuYW1lIHRv\nIGRlY2xhcmUgdGhlIGdpdmVuIGZpZWxkIGFzLgogICAgICovCiAgICBwcml2\nYXRlIFN0cmluZyBnZXRUeXBlTmFtZShGaWVsZE1ldGFEYXRhIGZtZCkgewog\nICAgICAgIENsYXNzIHR5cGUgPSBmbWQuZ2V0T2JqZWN0SWRGaWVsZFR5cGUo\nKTsKICAgICAgICBpZiAodHlwZSA9PSBieXRlW10uY2xhc3MpCiAgICAgICAg\nICAgIHJldHVybiAiYnl0ZVtdIjsKICAgICAgICBpZiAodHlwZSA9PSBjaGFy\nW10uY2xhc3MpCiAgICAgICAgICAgIHJldHVybiAiY2hhcltdIjsKICAgICAg\nICBpZiAodHlwZS5nZXROYW1lKCkuc3RhcnRzV2l0aCgiamF2YS5zcWwuIikp\nCiAgICAgICAgICAgIHJldHVybiB0eXBlLmdldE5hbWUoKTsKICAgICAgICBy\nZXR1cm4gU3RyaW5ncy5nZXRDbGFzc05hbWUodHlwZSk7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBSZXR1cm4gdGhlIGdldHRlcnMgYW5kIHNldHRlcnMgZm9y\nIGFsbCBwcmltYXJ5IGtleSBmaWVsZHMuCiAgICAgKi8KICAgIHByaXZhdGUg\nU3RyaW5nIGdldFByb3BlcnRpZXMoKSB7CiAgICAgICAgaWYgKEFjY2Vzc0Nv\nZGUuaXNFeHBsaWNpdChfbWV0YS5nZXRBY2Nlc3NUeXBlKCkpIAogICAgICAg\nICAmJiBBY2Nlc3NDb2RlLmlzRmllbGQoX21ldGEuZ2V0QWNjZXNzVHlwZSgp\nKSkKICAgICAgICAgICAgcmV0dXJuICIiOwoKICAgICAgICBDb2RlRm9ybWF0\nIGNvZGUgPSBuZXdDb2RlRm9ybWF0KCk7CiAgICAgICAgU3RyaW5nIHByb3BO\nYW1lOwogICAgICAgIFN0cmluZyB0eXBlTmFtZTsKICAgICAgICBmb3IgKGlu\ndCBpID0gMDsgaSA8IF9maWVsZHMubGVuZ3RoOyBpKyspIHsKICAgICAgICAg\nICAgaWYgKGkgPiAwKQogICAgICAgICAgICAgICAgY29kZS5hZnRlclNlY3Rp\nb24oKTsKICAgICAgICAgICAgdHlwZU5hbWUgPSBnZXRUeXBlTmFtZShfZmll\nbGRzW2ldKTsKICAgICAgICAgICAgcHJvcE5hbWUgPSBTdHJpbmdVdGlscy5j\nYXBpdGFsaXplKF9maWVsZHNbaV0uZ2V0TmFtZSgpKTsKCiAgICAgICAgICAg\nIGNvZGUudGFiKCkuYXBwZW5kKCJwdWJsaWMgIikuYXBwZW5kKHR5cGVOYW1l\nKS5hcHBlbmQoIiAiKTsKICAgICAgICAgICAgaWYgKF9maWVsZHNbaV0uZ2V0\nRGVjbGFyZWRUeXBlQ29kZSgpID09IEphdmFUeXBlcy5CT09MRUFOCiAgICAg\nICAgICAgICAgICB8fCBfZmllbGRzW2ldLmdldERlY2xhcmVkVHlwZUNvZGUo\nKSA9PSBKYXZhVHlwZXMuQk9PTEVBTl9PQkopCiAgICAgICAgICAgICAgICBj\nb2RlLmFwcGVuZCgiaXMiKTsKICAgICAgICAgICAgZWxzZQogICAgICAgICAg\nICAgICAgY29kZS5hcHBlbmQoImdldCIpOwogICAgICAgICAgICBjb2RlLmFw\ncGVuZChwcm9wTmFtZSkucGFyZW5zKCkub3BlbkJyYWNlKDIpLmVuZGwoKTsK\nICAgICAgICAgICAgY29kZS50YWIoMikuYXBwZW5kKCJyZXR1cm4gIikuYXBw\nZW5kKF9maWVsZHNbaV0uZ2V0TmFtZSgpKS4KICAgICAgICAgICAgICAgIGFw\ncGVuZCgiOyIpLmVuZGwoKTsKICAgICAgICAgICAgY29kZS5jbG9zZUJyYWNl\nKDIpOwogICAgICAgICAgICBjb2RlLmFmdGVyU2VjdGlvbigpOwoKICAgICAg\nICAgICAgY29kZS50YWIoKS5hcHBlbmQoInB1YmxpYyB2b2lkIHNldCIpLmFw\ncGVuZChwcm9wTmFtZSk7CiAgICAgICAgICAgIGNvZGUub3BlblBhcmVuKHRy\ndWUpLmFwcGVuZCh0eXBlTmFtZSkuYXBwZW5kKCIgIikuCiAgICAgICAgICAg\nICAgICBhcHBlbmQoX2ZpZWxkc1tpXS5nZXROYW1lKCkpLmNsb3NlUGFyZW4o\nKTsKICAgICAgICAgICAgY29kZS5vcGVuQnJhY2UoMikuZW5kbCgpOwogICAg\nICAgICAgICBjb2RlLnRhYigyKS5hcHBlbmQoInRoaXMuIikuYXBwZW5kKF9m\naWVsZHNbaV0uZ2V0TmFtZSgpKS4KICAgICAgICAgICAgICAgIGFwcGVuZCgi\nID0gIikuYXBwZW5kKF9maWVsZHNbaV0uZ2V0TmFtZSgpKS5hcHBlbmQoIjsi\nKS4KICAgICAgICAgICAgICAgIGVuZGwoKTsKICAgICAgICAgICAgY29kZS5j\nbG9zZUJyYWNlKDIpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gY29kZS50\nb1N0cmluZygpOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRoZSBz\ndHJpbmcgY29uc3RydWN0b3IgY29kZS4KICAgICAqLwogICAgcHJpdmF0ZSBT\ndHJpbmcgZ2V0Q29uc3RydWN0b3IoYm9vbGVhbiBoYXNTdXBlcmNsYXNzKSB7\nCiAgICAgICAgQ29kZUZvcm1hdCBjb2RlID0gbmV3Q29kZUZvcm1hdCgpOwog\nICAgICAgIGNvZGUudGFiKCkuYXBwZW5kKCJwdWJsaWMgIik7CiAgICAgICAg\nY29kZS5hcHBlbmQoZ2V0Q2xhc3NOYW1lKCkpOwogICAgICAgIGNvZGUub3Bl\nblBhcmVuKHRydWUpLmFwcGVuZCgiU3RyaW5nIHN0ciIpLmNsb3NlUGFyZW4o\nKTsKICAgICAgICBjb2RlLm9wZW5CcmFjZSgyKS5lbmRsKCk7CgogICAgICAg\nIGlmIChfZmllbGRzLmxlbmd0aCAhPSAwIHx8IChoYXNTdXBlcmNsYXNzCiAg\nICAgICAgICAgICYmIF9tZXRhLmdldFByaW1hcnlLZXlGaWVsZHMoKS5sZW5n\ndGggPiAwKSkgewogICAgICAgICAgICBjb2RlLnRhYigyKS5hcHBlbmQoImZy\nb21TdHJpbmciKS5vcGVuUGFyZW4odHJ1ZSkuCiAgICAgICAgICAgICAgICBh\ncHBlbmQoInN0ciIpLmNsb3NlUGFyZW4oKS5hcHBlbmQoIjsiKS5lbmRsKCk7\nCiAgICAgICAgfQoKICAgICAgICBjb2RlLmNsb3NlQnJhY2UoMik7CiAgICAg\nICAgcmV0dXJuIGNvZGUudG9TdHJpbmcoKTsKICAgIH0KCiAgICAvKioKICAg\nICAqIENyZWF0ZSB0aGUgZnJvbVN0cmluZyBtZXRob2QgdGhhdCBwYXJzZXMg\ndGhlIHJlc3VsdCBvZiBvdXIgdG9TdHJpbmcKICAgICAqIG1ldGhvZC4gSWYg\nd2UgaGF2ZSBzdXBlcmNsYXNzZXMgd2l0aCBpZCBmaWVsZHMsIHRoaXMgd2ls\nbCBjYWxsCiAgICAgKiBzdXBlci5mcm9tU3RyaW5nKCkgc28gdGhhdCB0aGUg\ncGFyZW50IGNsYXNzIGNhbiBwYXJzZSBpdHMgb3duIGZpZWxkcy4KICAgICAq\nLwogICAgcHJpdmF0ZSBTdHJpbmcgZ2V0RnJvbVN0cmluZ0NvZGUoYm9vbGVh\nbiBoYXNTdXBlcmNsYXNzKSB7CiAgICAgICAgLy8gaWYgd2UgYXJlIGJlbG93\nIGEgY29uY3JldGUgY2xhc3MgdGhlbiB3ZSBjYW5ub3QgZGVjbGFyZSBhbnkK\nICAgICAgICAvLyBtb3JlIHByaW1hcnkga2V5IGZpZWxkczsgdGh1cywganVz\ndCB1c2UgdGhlIHBhcmVudCBpbnZvY2F0aW9uCiAgICAgICAgaWYgKGhhc0Nv\nbmNyZXRlU3VwZXJjbGFzcygpKQogICAgICAgICAgICByZXR1cm4gIiI7CiAg\nICAgICAgaWYgKF9maWVsZHMubGVuZ3RoID09IDApCiAgICAgICAgICAgIHJl\ndHVybiAiIjsKICAgICAgICBoYXNTdXBlcmNsYXNzID0gaGFzU3VwZXJjbGFz\ncyAmJiBnZXREZWNsYXJlZFByaW1hcnlLZXlGaWVsZHMKICAgICAgICAgICAg\nKF9tZXRhLmdldFBDU3VwZXJjbGFzc01ldGFEYXRhKCkpLmxlbmd0aCA+IDA7\nCgogICAgICAgIFN0cmluZyB0b2tlID0gZ2V0VG9rZW5pemVyKGhhc1N1cGVy\nY2xhc3MpOwogICAgICAgIENvZGVGb3JtYXQgY29kZSA9IG5ld0NvZGVGb3Jt\nYXQoKTsKICAgICAgICBpZiAoX2Fic3RyYWN0IHx8IGhhc1N1cGVyY2xhc3Mp\nCiAgICAgICAgICAgIGNvZGUudGFiKCkuYXBwZW5kKCJwcm90ZWN0ZWQgIiku\nYXBwZW5kKHRva2UpLgogICAgICAgICAgICAgICAgYXBwZW5kKCIgZnJvbVN0\ncmluZyIpOwogICAgICAgIGVsc2UKICAgICAgICAgICAgY29kZS50YWIoKS5h\ncHBlbmQoInByaXZhdGUgdm9pZCBmcm9tU3RyaW5nIik7CiAgICAgICAgY29k\nZS5vcGVuUGFyZW4odHJ1ZSkuYXBwZW5kKCJTdHJpbmcgc3RyIikuY2xvc2VQ\nYXJlbigpOwogICAgICAgIGNvZGUub3BlbkJyYWNlKDIpLmVuZGwoKTsKCiAg\nICAgICAgLy8gaWYgd2UgaGF2ZSBhbnkgT2JqZWN0LXR5cGUgZmllbGRzLCBk\naWUgaW1tZWRpYXRlbHkgCiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBf\nZmllbGRzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGlmIChfZmllbGRz\nW2ldLmdldE9iamVjdElkRmllbGRUeXBlKCkgIT0gT2JqZWN0LmNsYXNzKQog\nICAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgIGNvZGUudGFi\nKDIpLmFwcGVuZCgidGhyb3cgbmV3IFVuc3VwcG9ydGVkT3BlcmF0aW9uRXhj\nZXB0aW9uIikuCiAgICAgICAgICAgICAgICBwYXJlbnMoKS5hcHBlbmQoIjsi\nKS5lbmRsKCk7CiAgICAgICAgICAgIGNvZGUuY2xvc2VCcmFjZSgyKTsgCiAg\nICAgICAgICAgIHJldHVybiBjb2RlLnRvU3RyaW5nKCk7CiAgICAgICAgfSAK\nCiAgICAgICAgaWYgKHRva2UgIT0gbnVsbCkgewogICAgICAgICAgICBjb2Rl\nLnRhYigyKS5hcHBlbmQodG9rZSkuYXBwZW5kKCIgdG9rZSA9ICIpOwogICAg\nICAgICAgICBpZiAoaGFzU3VwZXJjbGFzcykgewogICAgICAgICAgICAgICAg\nLy8gY2FsbCBzdXBlci5mcm9tU3RyaW5nKHN0cikgdG8gZ2V0IHRoZSB0b2tl\nbml6ZXIgdGhhdCB3YXMKICAgICAgICAgICAgICAgIC8vIHVzZWQgdG8gcGFy\nc2UgdGhlIHN1cGVyY2xhc3MKICAgICAgICAgICAgICAgIGNvZGUuYXBwZW5k\nKCJzdXBlci5mcm9tU3RyaW5nIikub3BlblBhcmVuKHRydWUpLgogICAgICAg\nICAgICAgICAgICAgIGFwcGVuZCgic3RyIikuY2xvc2VQYXJlbigpOwogICAg\nICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgLy8gb3RoZXJ3aXNl\nIGNvbnN0cnVjdCBhIG5ldyB0b2tlbml6ZXIgd2l0aCB0aGUgc3RyaW5nCiAg\nICAgICAgICAgICAgICBjb2RlLmFwcGVuZCgibmV3ICIpLmFwcGVuZCh0b2tl\nKS5vcGVuUGFyZW4odHJ1ZSkuCiAgICAgICAgICAgICAgICAgICAgYXBwZW5k\nKCJzdHIiKTsKICAgICAgICAgICAgICAgIGlmICh0b2tlID09IFRPS0VOSVpF\nUl9TVEQpCiAgICAgICAgICAgICAgICAgICAgY29kZS5hcHBlbmQoIiwgXCIi\nKS5hcHBlbmQoX3Rva2VuKS5hcHBlbmQoIlwiIik7CiAgICAgICAgICAgICAg\nICBjb2RlLmNsb3NlUGFyZW4oKTsKICAgICAgICAgICAgfQogICAgICAgICAg\nICBjb2RlLmFwcGVuZCgiOyIpLmVuZGwoKTsKICAgICAgICB9CgogICAgICAg\nIGZvciAoaW50IGkgPSAwOyBpIDwgX2ZpZWxkcy5sZW5ndGg7IGkrKykgewog\nICAgICAgICAgICBpZiAodG9rZSAhPSBudWxsKSB7CiAgICAgICAgICAgICAg\nICBjb2RlLnRhYigyKS5hcHBlbmQoInN0ciA9IHRva2UubmV4dFRva2VuIiku\ncGFyZW5zKCkuCiAgICAgICAgICAgICAgICAgICAgYXBwZW5kKCI7IikuZW5k\nbCgpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGNvZGUudGFiKDIpLmFw\ncGVuZChnZXRDb252ZXJzaW9uQ29kZShfZmllbGRzW2ldLCAic3RyIikpLmVu\nZGwoKTsKICAgICAgICB9CiAgICAgICAgaWYgKF9hYnN0cmFjdCB8fCBoYXNT\ndXBlcmNsYXNzKQogICAgICAgICAgICBjb2RlLnRhYigyKS5hcHBlbmQoInJl\ndHVybiB0b2tlOyIpLmVuZGwoKTsKICAgICAgICBjb2RlLmNsb3NlQnJhY2Uo\nMik7CiAgICAgICAgcmV0dXJuIGNvZGUudG9TdHJpbmcoKTsKICAgIH0KCiAg\nICAvKioKICAgICAqIFJldHVybnMgdGhlIHR5cGUgb2YgdG9rZW5pemVyIHRv\nIHVzZSwgb3IgbnVsbCBpZiBub25lLgogICAgICovCiAgICBwcml2YXRlIFN0\ncmluZyBnZXRUb2tlbml6ZXIoYm9vbGVhbiBoYXNTdXBlcmNsYXNzKSB7CiAg\nICAgICAgaWYgKCFfYWJzdHJhY3QgJiYgIWhhc1N1cGVyY2xhc3MgJiYgX2Zp\nZWxkcy5sZW5ndGggPT0gMSkKICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAg\nICAgICAgaWYgKF90b2tlbi5sZW5ndGgoKSA9PSAxKQogICAgICAgICAgICBy\nZXR1cm4gVE9LRU5JWkVSX1NURDsKICAgICAgICByZXR1cm4gVE9LRU5JWkVS\nX0NVU1RPTTsKICAgIH0KCiAgICAvKioKICAgICAqIEdldCBwYXJzaW5nIGNv\nZGUgZm9yIHRoZSBnaXZlbiBmaWVsZC4KICAgICAqLwogICAgcHJpdmF0ZSBT\ndHJpbmcgZ2V0Q29udmVyc2lvbkNvZGUoRmllbGRNZXRhRGF0YSBmaWVsZCwg\nU3RyaW5nIHZhcikgewogICAgICAgIENvZGVGb3JtYXQgcGFyc2UgPSBuZXdD\nb2RlRm9ybWF0KCk7CiAgICAgICAgaWYgKGZpZWxkLmdldE5hbWUoKS5lcXVh\nbHModmFyKSkKICAgICAgICAgICAgcGFyc2UuYXBwZW5kKCJ0aGlzLiIpOwog\nICAgICAgIHBhcnNlLmFwcGVuZChmaWVsZC5nZXROYW1lKCkpLmFwcGVuZCgi\nID0gIik7CgogICAgICAgIENsYXNzIHR5cGUgPSBmaWVsZC5nZXRPYmplY3RJ\nZEZpZWxkVHlwZSgpOwogICAgICAgIGlmICh0eXBlID09IERhdGUuY2xhc3Mp\nIHsKICAgICAgICAgICAgcGFyc2UuYXBwZW5kKCJuZXcgRGF0ZSIpLm9wZW5Q\nYXJlbih0cnVlKS4KICAgICAgICAgICAgICAgIGFwcGVuZCgiTG9uZy5wYXJz\nZUxvbmciKS5vcGVuUGFyZW4odHJ1ZSkuCiAgICAgICAgICAgICAgICBhcHBl\nbmQodmFyKS5jbG9zZVBhcmVuKCkuY2xvc2VQYXJlbigpOwogICAgICAgIH0g\nZWxzZSBpZiAodHlwZSA9PSBqYXZhLnNxbC5EYXRlLmNsYXNzCiAgICAgICAg\nICAgIHx8IHR5cGUgPT0gamF2YS5zcWwuVGltZXN0YW1wLmNsYXNzCiAgICAg\nICAgICAgIHx8IHR5cGUgPT0gamF2YS5zcWwuVGltZS5jbGFzcykgewogICAg\nICAgICAgICBwYXJzZS5hcHBlbmQodHlwZS5nZXROYW1lKCkpLmFwcGVuZCgi\nLnZhbHVlT2YiKS5vcGVuUGFyZW4odHJ1ZSkuCiAgICAgICAgICAgICAgICBh\ncHBlbmQodmFyKS5jbG9zZVBhcmVuKCk7CiAgICAgICAgfSBlbHNlIGlmICh0\neXBlID09IFN0cmluZy5jbGFzcykKICAgICAgICAgICAgcGFyc2UuYXBwZW5k\nKHZhcik7CiAgICAgICAgZWxzZSBpZiAodHlwZSA9PSBDaGFyYWN0ZXIuY2xh\nc3MpIHsKICAgICAgICAgICAgcGFyc2UuYXBwZW5kKCJuZXcgQ2hhcmFjdGVy\nIikub3BlblBhcmVuKHRydWUpLmFwcGVuZCh2YXIpLgogICAgICAgICAgICAg\nICAgYXBwZW5kKCIuY2hhckF0Iikub3BlblBhcmVuKHRydWUpLmFwcGVuZCgw\nKS4KICAgICAgICAgICAgICAgIGNsb3NlUGFyZW4oKS5jbG9zZVBhcmVuKCk7\nCiAgICAgICAgfSBlbHNlIGlmICh0eXBlID09IGJ5dGVbXS5jbGFzcykKICAg\nICAgICAgICAgcGFyc2UuYXBwZW5kKCJ0b0J5dGVzIikub3BlblBhcmVuKHRy\ndWUpLmFwcGVuZCh2YXIpLmNsb3NlUGFyZW4oKTsKICAgICAgICBlbHNlIGlm\nICh0eXBlID09IGNoYXJbXS5jbGFzcykKICAgICAgICAgICAgcGFyc2UuYXBw\nZW5kKHZhcikuYXBwZW5kKCIudG9DaGFyQXJyYXkiKS5wYXJlbnMoKTsKICAg\nICAgICBlbHNlIGlmICghdHlwZS5pc1ByaW1pdGl2ZSgpKSB7CiAgICAgICAg\nICAgIHBhcnNlLmFwcGVuZCgibmV3ICIpLmFwcGVuZChTdHJpbmdzLmdldENs\nYXNzTmFtZSh0eXBlKSkuCiAgICAgICAgICAgICAgICBvcGVuUGFyZW4odHJ1\nZSkuYXBwZW5kKHZhcikuY2xvc2VQYXJlbigpOwogICAgICAgIH0gZWxzZSAv\nLyBwcmltaXRpdmUKICAgICAgICB7CiAgICAgICAgICAgIHN3aXRjaCAodHlw\nZS5nZXROYW1lKCkuY2hhckF0KDApKSB7CiAgICAgICAgICAgICAgICBjYXNl\nICdiJzoKICAgICAgICAgICAgICAgICAgICBpZiAodHlwZSA9PSBib29sZWFu\nLmNsYXNzKQogICAgICAgICAgICAgICAgICAgICAgICBwYXJzZS5hcHBlbmQo\nIlwidHJ1ZVwiLmVxdWFscyIpLm9wZW5QYXJlbih0cnVlKS4KICAgICAgICAg\nICAgICAgICAgICAgICAgICAgIGFwcGVuZCh2YXIpLmNsb3NlUGFyZW4oKTsK\nICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAg\nICAgIHBhcnNlLmFwcGVuZCgiQnl0ZS5wYXJzZUJ5dGUiKS5vcGVuUGFyZW4o\ndHJ1ZSkuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcHBlbmQodmFy\nKS5jbG9zZVBhcmVuKCk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAg\nICAgICAgICAgICAgICBjYXNlICdjJzoKICAgICAgICAgICAgICAgICAgICBw\nYXJzZS5hcHBlbmQodmFyKS5hcHBlbmQoIi5jaGFyQXQiKS5vcGVuUGFyZW4o\ndHJ1ZSkuCiAgICAgICAgICAgICAgICAgICAgICAgIGFwcGVuZCgwKS5jbG9z\nZVBhcmVuKCk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAg\nICAgICAgICBjYXNlICdkJzoKICAgICAgICAgICAgICAgICAgICBwYXJzZS5h\ncHBlbmQoIkRvdWJsZS5wYXJzZURvdWJsZSIpLm9wZW5QYXJlbih0cnVlKS4K\nICAgICAgICAgICAgICAgICAgICAgICAgYXBwZW5kKHZhcikuY2xvc2VQYXJl\nbigpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAg\nICAgY2FzZSAnZic6CiAgICAgICAgICAgICAgICAgICAgcGFyc2UuYXBwZW5k\nKCJGbG9hdC5wYXJzZUZsb2F0Iikub3BlblBhcmVuKHRydWUpLgogICAgICAg\nICAgICAgICAgICAgICAgICBhcHBlbmQodmFyKS5jbG9zZVBhcmVuKCk7CiAg\nICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNl\nICdpJzoKICAgICAgICAgICAgICAgICAgICBwYXJzZS5hcHBlbmQoIkludGVn\nZXIucGFyc2VJbnQiKS5vcGVuUGFyZW4odHJ1ZSkuCiAgICAgICAgICAgICAg\nICAgICAgICAgIGFwcGVuZCh2YXIpLmNsb3NlUGFyZW4oKTsKICAgICAgICAg\nICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgJ2wnOgog\nICAgICAgICAgICAgICAgICAgIHBhcnNlLmFwcGVuZCgiTG9uZy5wYXJzZUxv\nbmciKS5vcGVuUGFyZW4odHJ1ZSkuCiAgICAgICAgICAgICAgICAgICAgICAg\nIGFwcGVuZCh2YXIpLmNsb3NlUGFyZW4oKTsKICAgICAgICAgICAgICAgICAg\nICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgJ3MnOgogICAgICAgICAg\nICAgICAgICAgIHBhcnNlLmFwcGVuZCgiU2hvcnQucGFyc2VTaG9ydCIpLm9w\nZW5QYXJlbih0cnVlKS4KICAgICAgICAgICAgICAgICAgICAgICAgYXBwZW5k\nKHZhcikuY2xvc2VQYXJlbigpOwogICAgICAgICAgICAgICAgICAgIGJyZWFr\nOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAoIXR5cGUu\naXNQcmltaXRpdmUoKSAmJiB0eXBlICE9IGJ5dGVbXS5jbGFzcykgewogICAg\nICAgICAgICBDb2RlRm9ybWF0IGlzTnVsbCA9IG5ld0NvZGVGb3JtYXQoKTsK\nICAgICAgICAgICAgaXNOdWxsLmFwcGVuZCgiaWYiKS5vcGVuUGFyZW4odHJ1\nZSkuYXBwZW5kKCJcIm51bGxcIi5lcXVhbHMiKS4KICAgICAgICAgICAgICAg\nIG9wZW5QYXJlbih0cnVlKS5hcHBlbmQodmFyKS5jbG9zZVBhcmVuKCkuY2xv\nc2VQYXJlbigpLgogICAgICAgICAgICAgICAgZW5kbCgpLnRhYigzKTsKICAg\nICAgICAgICAgaWYgKGZpZWxkLmdldE5hbWUoKS5lcXVhbHModmFyKSkKICAg\nICAgICAgICAgICAgIGlzTnVsbC5hcHBlbmQoInRoaXMuIik7CiAgICAgICAg\nICAgIGlzTnVsbC5hcHBlbmQoZmllbGQuZ2V0TmFtZSgpKS5hcHBlbmQoIiA9\nIG51bGw7IikuZW5kbCgpOwogICAgICAgICAgICBpc051bGwudGFiKDIpLmFw\ncGVuZCgiZWxzZSIpLmVuZGwoKTsKICAgICAgICAgICAgaXNOdWxsLnRhYigz\nKS5hcHBlbmQocGFyc2UpOwogICAgICAgICAgICBwYXJzZSA9IGlzTnVsbDsK\nICAgICAgICB9CgogICAgICAgIHJldHVybiBwYXJzZS5hcHBlbmQoIjsiKS50\nb1N0cmluZygpOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIGFuIGVx\ndWFsaXR5IG1ldGhvZCB0aGF0IGNvbXBhcmVzIGFsbCBwayB2YXJpYWJsZXMu\nCiAgICAgKiBNdXN0IGRlYWwgY29ycmVjdGx5IHdpdGggYm90aCBwcmltaXRp\ndmVzIGFuZCBvYmplY3RzLgogICAgICovCiAgICBwcml2YXRlIFN0cmluZyBn\nZXRFcXVhbHNDb2RlKGJvb2xlYW4gaGFzU3VwZXJjbGFzcykgewogICAgICAg\nIC8vIGlmIHdlIGFyZSBiZWxvdyBhIGNvbmNyZXRlIGNsYXNzIHRoZW4gd2Ug\nY2Fubm90IGRlY2xhcmUgYW55CiAgICAgICAgLy8gbW9yZSBwcmltYXJ5IGtl\neSBmaWVsZHM7IHRodXMsIGp1c3QgdXNlIHRoZSBwYXJlbnQgaW52b2NhdGlv\nbgogICAgICAgIGlmIChoYXNDb25jcmV0ZVN1cGVyY2xhc3MoKSB8fCAoaGFz\nU3VwZXJjbGFzcyAmJiBfZmllbGRzLmxlbmd0aCA9PSAwKSkKICAgICAgICAg\nICAgcmV0dXJuICIiOwoKICAgICAgICBDb2RlRm9ybWF0IGNvZGUgPSBuZXdD\nb2RlRm9ybWF0KCk7CiAgICAgICAgY29kZS50YWIoKS5hcHBlbmQoInB1Ymxp\nYyBib29sZWFuIGVxdWFscyIpLm9wZW5QYXJlbih0cnVlKS4KICAgICAgICAg\nICAgYXBwZW5kKCJPYmplY3Qgb2JqIikuY2xvc2VQYXJlbigpLm9wZW5CcmFj\nZSgyKS5lbmRsKCk7CgogICAgICAgIGNvZGUudGFiKDIpLmFwcGVuZCgiaWYi\nKS5vcGVuUGFyZW4odHJ1ZSkuCiAgICAgICAgICAgIGFwcGVuZCgidGhpcyA9\nPSBvYmoiKS5jbG9zZVBhcmVuKCkuZW5kbCgpOwogICAgICAgIGNvZGUudGFi\nKDMpLmFwcGVuZCgicmV0dXJuIHRydWU7IikuZW5kbCgpOwoKICAgICAgICAv\nLyBjYWxsIHN1cGVyLmVxdWFscygpIGlmIHdlIGhhdmUgYSBzdXBlcmNsYXNz\nCiAgICAgICAgU3RyaW5nIGNsYXNzTmFtZSA9IGdldENsYXNzTmFtZSgpOwog\nICAgICAgIGlmIChoYXNTdXBlcmNsYXNzKSB7CiAgICAgICAgICAgIGNvZGUu\ndGFiKDIpLmFwcGVuZCgiaWYiKS5vcGVuUGFyZW4odHJ1ZSkuCiAgICAgICAg\nICAgICAgICBhcHBlbmQoIiFzdXBlci5lcXVhbHMiKS5vcGVuUGFyZW4odHJ1\nZSkuCiAgICAgICAgICAgICAgICBhcHBlbmQoIm9iaiIpLmNsb3NlUGFyZW4o\nKS5jbG9zZVBhcmVuKCkuZW5kbCgpOwogICAgICAgICAgICBjb2RlLnRhYigz\nKS5hcHBlbmQoInJldHVybiBmYWxzZTsiKS5lbmRsKCk7CiAgICAgICAgfSBl\nbHNlIHsKICAgICAgICAgICAgY29kZS50YWIoMikuYXBwZW5kKCJpZiIpLm9w\nZW5QYXJlbih0cnVlKS4KICAgICAgICAgICAgICAgIGFwcGVuZCgib2JqID09\nIG51bGwgfHwgb2JqLmdldENsYXNzIikucGFyZW5zKCkuCiAgICAgICAgICAg\nICAgICBhcHBlbmQoIiAhPSAiKS5hcHBlbmQoImdldENsYXNzIikucGFyZW5z\nKCkuCiAgICAgICAgICAgICAgICBjbG9zZVBhcmVuKCkuZW5kbCgpOwogICAg\nICAgICAgICBjb2RlLnRhYigzKS5hcHBlbmQoInJldHVybiBmYWxzZTsiKS5l\nbmRsKCk7CiAgICAgICAgfQoKICAgICAgICBTdHJpbmcgbmFtZTsKICAgICAg\nICBDbGFzcyB0eXBlOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgX2Zp\nZWxkcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBpZiAoaSA9PSAwKSB7\nCiAgICAgICAgICAgICAgICBjb2RlLmVuZGwoKS50YWIoMikuYXBwZW5kKGNs\nYXNzTmFtZSkuYXBwZW5kKCIgb3RoZXIgPSAiKS4KICAgICAgICAgICAgICAg\nICAgICBvcGVuUGFyZW4oZmFsc2UpLmFwcGVuZChjbGFzc05hbWUpLmNsb3Nl\nUGFyZW4oKS4KICAgICAgICAgICAgICAgICAgICBhcHBlbmQoIiBvYmo7Iiku\nZW5kbCgpOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBpZiB0aGlz\nIGlzIG5vdCB0aGUgZmlyc3QgZmllbGQsIGFkZCBhbiAmJgogICAgICAgICAg\nICBpZiAoaSA9PSAwKQogICAgICAgICAgICAgICAgY29kZS50YWIoMikuYXBw\nZW5kKCJyZXR1cm4gIik7CiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAg\nICAgIGNvZGUuZW5kbCgpLnRhYigzKS5hcHBlbmQoIiYmICIpOwoKICAgICAg\nICAgICAgbmFtZSA9IF9maWVsZHNbaV0uZ2V0TmFtZSgpOwogICAgICAgICAg\nICB0eXBlID0gX2ZpZWxkc1tpXS5nZXRPYmplY3RJZEZpZWxkVHlwZSgpOwog\nICAgICAgICAgICBpZiAodHlwZS5pc1ByaW1pdGl2ZSgpKSB7CiAgICAgICAg\nICAgICAgICBjb2RlLm9wZW5QYXJlbihmYWxzZSkuYXBwZW5kKG5hbWUpLmFw\ncGVuZCgiID09ICIpLgogICAgICAgICAgICAgICAgICAgIGFwcGVuZCgib3Ro\nZXIuIikuYXBwZW5kKG5hbWUpLmNsb3NlUGFyZW4oKTsKICAgICAgICAgICAg\nfSBlbHNlIGlmICh0eXBlID09IGJ5dGVbXS5jbGFzcykgewogICAgICAgICAg\nICAgICAgY29kZS5vcGVuUGFyZW4oZmFsc2UpLmFwcGVuZCgiZXF1YWxzIiku\nb3BlblBhcmVuKHRydWUpLgogICAgICAgICAgICAgICAgICAgIGFwcGVuZChu\nYW1lKS5hcHBlbmQoIiwgIikuYXBwZW5kKCJvdGhlci4iKS4KICAgICAgICAg\nICAgICAgICAgICBhcHBlbmQobmFtZSkuY2xvc2VQYXJlbigpLmNsb3NlUGFy\nZW4oKTsKICAgICAgICAgICAgfSBlbHNlIGlmICh0eXBlID09IGNoYXJbXS5j\nbGFzcykgewogICAgICAgICAgICAgICAgLy8gKChuYW1lID09IG51bGwgJiYg\nb3RoZXIubmFtZSA9PSBudWxsKQogICAgICAgICAgICAgICAgLy8JfHwgKG5h\nbWUgIT0gbnVsbCAmJiBTdHJpbmcudmFsdWVPZiAobmFtZSkuCiAgICAgICAg\nICAgICAgICAvLwllcXVhbHMgKFN0cmluZy52YWx1ZU9mIChvdGhlci5uYW1l\nKSkpKQogICAgICAgICAgICAgICAgY29kZS5hcHBlbmQoIigiKS5vcGVuUGFy\nZW4oZmFsc2UpLmFwcGVuZChuYW1lKS4KICAgICAgICAgICAgICAgICAgICBh\ncHBlbmQoIiA9PSBudWxsICYmIG90aGVyLiIpLmFwcGVuZChuYW1lKS4KICAg\nICAgICAgICAgICAgICAgICBhcHBlbmQoIiA9PSBudWxsIikuY2xvc2VQYXJl\nbigpLmVuZGwoKTsKICAgICAgICAgICAgICAgIGNvZGUudGFiKDMpLmFwcGVu\nZCgifHwgIik7CiAgICAgICAgICAgICAgICBjb2RlLm9wZW5QYXJlbihmYWxz\nZSkuYXBwZW5kKG5hbWUpLmFwcGVuZCgiICE9IG51bGwgIikuCiAgICAgICAg\nICAgICAgICAgICAgYXBwZW5kKCImJiBTdHJpbmcudmFsdWVPZiIpLm9wZW5Q\nYXJlbih0cnVlKS5hcHBlbmQobmFtZSkuCiAgICAgICAgICAgICAgICAgICAg\nY2xvc2VQYXJlbigpLmFwcGVuZCgiLiIpLmVuZGwoKTsKICAgICAgICAgICAg\nICAgIGNvZGUudGFiKDMpLmFwcGVuZCgiZXF1YWxzIikub3BlblBhcmVuKHRy\ndWUpLgogICAgICAgICAgICAgICAgICAgIGFwcGVuZCgiU3RyaW5nLnZhbHVl\nT2YiKS5vcGVuUGFyZW4odHJ1ZSkuCiAgICAgICAgICAgICAgICAgICAgYXBw\nZW5kKCJvdGhlci4iKS5hcHBlbmQobmFtZSkuY2xvc2VQYXJlbigpLmNsb3Nl\nUGFyZW4oKS4KICAgICAgICAgICAgICAgICAgICBjbG9zZVBhcmVuKCkuYXBw\nZW5kKCIpIik7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAg\nICAvLyAoKG5hbWUgPT0gbnVsbCAmJiBvdGhlci5uYW1lID09IG51bGwpCiAg\nICAgICAgICAgICAgICAvLwl8fCAobmFtZSAhPSBudWxsICYmIG5hbWUuZXF1\nYWxzIChvdGhlci5uYW1lKSkpCiAgICAgICAgICAgICAgICBjb2RlLmFwcGVu\nZCgiKCIpLm9wZW5QYXJlbihmYWxzZSkuYXBwZW5kKG5hbWUpLgogICAgICAg\nICAgICAgICAgICAgIGFwcGVuZCgiID09IG51bGwgJiYgb3RoZXIuIikuYXBw\nZW5kKG5hbWUpLgogICAgICAgICAgICAgICAgICAgIGFwcGVuZCgiID09IG51\nbGwiKS5jbG9zZVBhcmVuKCkuZW5kbCgpOwogICAgICAgICAgICAgICAgY29k\nZS50YWIoMykuYXBwZW5kKCJ8fCAiKTsKICAgICAgICAgICAgICAgIGNvZGUu\nb3BlblBhcmVuKGZhbHNlKS5hcHBlbmQobmFtZSkuYXBwZW5kKCIgIT0gbnVs\nbCAiKS4KICAgICAgICAgICAgICAgICAgICBhcHBlbmQoIiYmICIpLmFwcGVu\nZChuYW1lKS5hcHBlbmQoIi5lcXVhbHMiKS4KICAgICAgICAgICAgICAgICAg\nICBvcGVuUGFyZW4odHJ1ZSkuYXBwZW5kKCJvdGhlci4iKS5hcHBlbmQobmFt\nZSkuCiAgICAgICAgICAgICAgICAgICAgY2xvc2VQYXJlbigpLmNsb3NlUGFy\nZW4oKS5hcHBlbmQoIikiKTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAg\nICAgICAgLy8gbm8gX2ZpZWxkczoganVzdCByZXR1cm4gdHJ1ZSBhZnRlciBj\naGVja2luZyBpbnN0YW5jZW9mCiAgICAgICAgaWYgKF9maWVsZHMubGVuZ3Ro\nID09IDApCiAgICAgICAgICAgIGNvZGUudGFiKDIpLmFwcGVuZCgicmV0dXJu\nIHRydWU7IikuZW5kbCgpOwogICAgICAgIGVsc2UKICAgICAgICAgICAgY29k\nZS5hcHBlbmQoIjsiKS5lbmRsKCk7CgogICAgICAgIGNvZGUuY2xvc2VCcmFj\nZSgyKTsKICAgICAgICByZXR1cm4gY29kZS50b1N0cmluZygpOwogICAgfQoK\nICAgIC8qKgogICAgICogUmV0dXJuIGEgaGFzaENvZGUgbWV0aG9kIHRoYXQg\ndGFrZXMgaW50byBhY2NvdW50IGFsbAogICAgICogcHJpbWFyeSBrZXkgdmFs\ndWVzLiBNdXN0IGRlYWwgY29ycmVjdGx5IHdpdGggYm90aCBwcmltaXRpdmVz\nIGFuZCBvYmplY3RzLgogICAgICovCiAgICBwcml2YXRlIFN0cmluZyBnZXRI\nYXNoQ29kZUNvZGUoYm9vbGVhbiBoYXNTdXBlcmNsYXNzKSB7CiAgICAgICAg\nLy8gaWYgd2UgYXJlIGJlbG93IGEgY29uY3JldGUgY2xhc3MgdGhlbiB3ZSBj\nYW5ub3QgZGVjbGFyZSBhbnkKICAgICAgICAvLyBtb3JlIHByaW1hcnkga2V5\nIGZpZWxkczsgdGh1cywganVzdCB1c2UgdGhlIHBhcmVudCBpbnZvY2F0aW9u\nCiAgICAgICAgaWYgKGhhc0NvbmNyZXRlU3VwZXJjbGFzcygpIHx8IChoYXNT\ndXBlcmNsYXNzICYmIF9maWVsZHMubGVuZ3RoID09IDApKQogICAgICAgICAg\nICByZXR1cm4gIiI7CgogICAgICAgIENvZGVGb3JtYXQgY29kZSA9IG5ld0Nv\nZGVGb3JtYXQoKTsKICAgICAgICBjb2RlLnRhYigpLmFwcGVuZCgicHVibGlj\nIGludCBoYXNoQ29kZSIpLnBhcmVucygpLgogICAgICAgICAgICBvcGVuQnJh\nY2UoMikuZW5kbCgpOwoKICAgICAgICBpZiAoX2ZpZWxkcy5sZW5ndGggPT0g\nMCkKICAgICAgICAgICAgY29kZS50YWIoMikuYXBwZW5kKCJyZXR1cm4gMTc7\nIikuZW5kbCgpOwogICAgICAgIGVsc2UgaWYgKF9maWVsZHMubGVuZ3RoID09\nIDEgJiYgIWhhc1N1cGVyY2xhc3MpIHsKICAgICAgICAgICAgY29kZS50YWIo\nMikuYXBwZW5kKCJyZXR1cm4gIik7CiAgICAgICAgICAgIGFwcGVuZEhhc2hD\nb2RlQ29kZShfZmllbGRzWzBdLCBjb2RlKTsKICAgICAgICAgICAgY29kZS5h\ncHBlbmQoIjsiKS5lbmRsKCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAg\nICAgY29kZS50YWIoMikuYXBwZW5kKCJpbnQgcnMgPSAiKTsKICAgICAgICAg\nICAgaWYgKGhhc1N1cGVyY2xhc3MpIHsKICAgICAgICAgICAgICAgIC8vIGNh\nbGwgc3VwZXIuaGFzaENvZGUoKSBpZiB3ZSBoYXZlIGEgc3VwZXJjbGFzcwog\nICAgICAgICAgICAgICAgY29kZS5hcHBlbmQoInN1cGVyLmhhc2hDb2RlIiku\nb3BlblBhcmVuKHRydWUpLgogICAgICAgICAgICAgICAgICAgIGNsb3NlUGFy\nZW4oKS5hcHBlbmQoIjsiKTsKICAgICAgICAgICAgfSBlbHNlCiAgICAgICAg\nICAgICAgICBjb2RlLmFwcGVuZCgiMTc7Iik7CiAgICAgICAgICAgIGNvZGUu\nZW5kbCgpOwoKICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBfZmll\nbGRzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgICBjb2RlLnRhYigy\nKS5hcHBlbmQoInJzID0gcnMgKiAzNyArICIpOwogICAgICAgICAgICAgICAg\nYXBwZW5kSGFzaENvZGVDb2RlKF9maWVsZHNbaV0sIGNvZGUpOwogICAgICAg\nICAgICAgICAgY29kZS5hcHBlbmQoIjsiKS5lbmRsKCk7CiAgICAgICAgICAg\nIH0KICAgICAgICAgICAgY29kZS50YWIoMikuYXBwZW5kKCJyZXR1cm4gcnM7\nIikuZW5kbCgpOwogICAgICAgIH0KICAgICAgICBjb2RlLmNsb3NlQnJhY2Uo\nMik7CiAgICAgICAgcmV0dXJuIGNvZGUudG9TdHJpbmcoKTsKICAgIH0KCiAg\nICAvKioKICAgICAqIFJldHVybiB0cnVlIGlmIHRoaXMgY2xhc3MgaGFzIGEg\nY29uY3JldGUgc3VwZXJjbGFzcy4KICAgICAqLwogICAgcHJpdmF0ZSBib29s\nZWFuIGhhc0NvbmNyZXRlU3VwZXJjbGFzcygpIHsKICAgICAgICBmb3IgKENs\nYXNzTWV0YURhdGEgc3VwID0gX21ldGEuZ2V0UENTdXBlcmNsYXNzTWV0YURh\ndGEoKTsKICAgICAgICAgICAgc3VwICE9IG51bGw7IHN1cCA9IHN1cC5nZXRQ\nQ1N1cGVyY2xhc3NNZXRhRGF0YSgpKSB7CiAgICAgICAgICAgIGlmICghTW9k\naWZpZXIuaXNBYnN0cmFjdChzdXAuZ2V0RGVzY3JpYmVkVHlwZSgpLmdldE1v\nZGlmaWVycygpKSkKICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAg\nICAgIH0KICAgICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBBcHBlbmQgY29kZSBjYWxjdWxhdGluZyB0aGUgaGFzaGNvZGUgZm9y\nIHRoZSBnaXZlbiBmaWVsZC4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIGFw\ncGVuZEhhc2hDb2RlQ29kZShGaWVsZE1ldGFEYXRhIGZpZWxkLCBDb2RlRm9y\nbWF0IGNvZGUpIHsKICAgICAgICBTdHJpbmcgbmFtZSA9IGZpZWxkLmdldE5h\nbWUoKTsKICAgICAgICBpZiAoInJzIi5lcXVhbHMobmFtZSkpCiAgICAgICAg\nICAgIG5hbWUgPSAidGhpcy4iICsgbmFtZTsKICAgICAgICBDbGFzcyB0eXBl\nID0gZmllbGQuZ2V0T2JqZWN0SWRGaWVsZFR5cGUoKTsKICAgICAgICBpZiAo\ndHlwZS5pc1ByaW1pdGl2ZSgpKSB7CiAgICAgICAgICAgIGlmICh0eXBlID09\nIGJvb2xlYW4uY2xhc3MpIHsKICAgICAgICAgICAgICAgIC8vICgobmFtZSkg\nPyAxIDogMCkKICAgICAgICAgICAgICAgIGNvZGUuYXBwZW5kKCIoIikub3Bl\nblBhcmVuKGZhbHNlKS5hcHBlbmQobmFtZSkuY2xvc2VQYXJlbigpLgogICAg\nICAgICAgICAgICAgICAgIGFwcGVuZCgiID8gMSA6IDAiKS5hcHBlbmQoIiki\nKTsKICAgICAgICAgICAgfSBlbHNlIGlmICh0eXBlID09IGxvbmcuY2xhc3Mp\nIHsKICAgICAgICAgICAgICAgIC8vIChpbnQpIChuYW1lIF4gKG5hbWUgPj4+\nIDMyKSkKICAgICAgICAgICAgICAgIGNvZGUub3BlblBhcmVuKGZhbHNlKS5h\ncHBlbmQoImludCIpLmNsb3NlUGFyZW4oKS4KICAgICAgICAgICAgICAgICAg\nICBhcHBlbmQoIiAiKS5vcGVuUGFyZW4oZmFsc2UpLmFwcGVuZChuYW1lKS4K\nICAgICAgICAgICAgICAgICAgICBhcHBlbmQoIiBeICIpLm9wZW5QYXJlbihm\nYWxzZSkuYXBwZW5kKG5hbWUpLgogICAgICAgICAgICAgICAgICAgIGFwcGVu\nZCgiID4+PiAzMiIpLmNsb3NlUGFyZW4oKS5jbG9zZVBhcmVuKCk7CiAgICAg\nICAgICAgIH0gZWxzZSBpZiAodHlwZSA9PSBkb3VibGUuY2xhc3MpIHsKICAg\nICAgICAgICAgICAgIC8vIChpbnQpIChEb3VibGUuZG91YmxlVG9Mb25nQml0\ncyAobmFtZSkKICAgICAgICAgICAgICAgIC8vICAgICBeIChEb3VibGUuZG91\nYmxlVG9Mb25nQml0cyAobmFtZSkgPj4+IDMyKSkKICAgICAgICAgICAgICAg\nIGNvZGUub3BlblBhcmVuKGZhbHNlKS5hcHBlbmQoImludCIpLmNsb3NlUGFy\nZW4oKS4KICAgICAgICAgICAgICAgICAgICBhcHBlbmQoIiAiKS5vcGVuUGFy\nZW4oZmFsc2UpLgogICAgICAgICAgICAgICAgICAgIGFwcGVuZCgiRG91Ymxl\nLmRvdWJsZVRvTG9uZ0JpdHMiKS5vcGVuUGFyZW4odHJ1ZSkuCiAgICAgICAg\nICAgICAgICAgICAgYXBwZW5kKG5hbWUpLmNsb3NlUGFyZW4oKS5lbmRsKCk7\nCiAgICAgICAgICAgICAgICBjb2RlLnRhYigzKS5hcHBlbmQoIl4gIikub3Bl\nblBhcmVuKGZhbHNlKS4KICAgICAgICAgICAgICAgICAgICBhcHBlbmQoIkRv\ndWJsZS5kb3VibGVUb0xvbmdCaXRzIikub3BlblBhcmVuKHRydWUpLgogICAg\nICAgICAgICAgICAgICAgIGFwcGVuZChuYW1lKS5jbG9zZVBhcmVuKCkuYXBw\nZW5kKCIgPj4+IDMyIikuCiAgICAgICAgICAgICAgICAgICAgY2xvc2VQYXJl\nbigpLmNsb3NlUGFyZW4oKTsKICAgICAgICAgICAgfSBlbHNlIGlmICh0eXBl\nID09IGZsb2F0LmNsYXNzKSB7CiAgICAgICAgICAgICAgICAvLyBGbG9hdC5m\nbG9hdFRvSW50Qml0cyAobmFtZSkKICAgICAgICAgICAgICAgIGNvZGUuYXBw\nZW5kKCJGbG9hdC5mbG9hdFRvSW50Qml0cyIpLm9wZW5QYXJlbih0cnVlKS4K\nICAgICAgICAgICAgICAgICAgICBhcHBlbmQobmFtZSkuY2xvc2VQYXJlbigp\nOwogICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGUgPT0gaW50LmNsYXNzKQog\nICAgICAgICAgICAgICAgY29kZS5hcHBlbmQobmFtZSk7CiAgICAgICAgICAg\nIGVsc2UgewogICAgICAgICAgICAgICAgLy8gKGludCkgbmFtZQogICAgICAg\nICAgICAgICAgY29kZS5vcGVuUGFyZW4oZmFsc2UpLmFwcGVuZCgiaW50Iiku\nY2xvc2VQYXJlbigpLgogICAgICAgICAgICAgICAgICAgIGFwcGVuZCgiICIp\nLmFwcGVuZChuYW1lKTsKICAgICAgICAgICAgfQogICAgICAgIH0gZWxzZSBp\nZiAodHlwZSA9PSBieXRlW10uY2xhc3MpIHsKICAgICAgICAgICAgLy8gaGFz\naENvZGUgKG5hbWUpOwogICAgICAgICAgICBjb2RlLmFwcGVuZCgiaGFzaENv\nZGUiKS5vcGVuUGFyZW4odHJ1ZSkuYXBwZW5kKG5hbWUpLgogICAgICAgICAg\nICAgICAgY2xvc2VQYXJlbigpOwogICAgICAgIH0gZWxzZSBpZiAodHlwZSA9\nPSBjaGFyW10uY2xhc3MpIHsKICAgICAgICAgICAgLy8gKChuYW1lID09IG51\nbGwpID8gMCA6IFN0cmluZy52YWx1ZU9mIChuYW1lKS5oYXNoQ29kZSAoKSkK\nICAgICAgICAgICAgY29kZS5hcHBlbmQoIigiKS5vcGVuUGFyZW4oZmFsc2Up\nLmFwcGVuZChuYW1lKS4KICAgICAgICAgICAgICAgIGFwcGVuZCgiID09IG51\nbGwiKS5jbG9zZVBhcmVuKCkuYXBwZW5kKCIgPyAwIDogIikuCiAgICAgICAg\nICAgICAgICBhcHBlbmQoIlN0cmluZy52YWx1ZU9mIikub3BlblBhcmVuKHRy\ndWUpLmFwcGVuZChuYW1lKS4KICAgICAgICAgICAgICAgIGNsb3NlUGFyZW4o\nKS5hcHBlbmQoIi5oYXNoQ29kZSIpLnBhcmVucygpLmFwcGVuZCgiKSIpOwog\nICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIC8vICgobmFtZSA9PSBudWxs\nKSA/IDAgOiBuYW1lLmhhc2hDb2RlICgpKQogICAgICAgICAgICBjb2RlLmFw\ncGVuZCgiKCIpLm9wZW5QYXJlbihmYWxzZSkuYXBwZW5kKG5hbWUpLgogICAg\nICAgICAgICAgICAgYXBwZW5kKCIgPT0gbnVsbCIpLmNsb3NlUGFyZW4oKS5h\ncHBlbmQoIiA/IDAgOiAiKS4KICAgICAgICAgICAgICAgIGFwcGVuZChuYW1l\nKS5hcHBlbmQoIi5oYXNoQ29kZSIpLnBhcmVucygpLmFwcGVuZCgiKSIpOwog\nICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiBhIG1ldGhv\nZCB0byBjcmVhdGUgYSBzdHJpbmcgY29udGFpbmluZyB0aGUgcHJpbWFyeSBr\nZXkKICAgICAqIHZhbHVlcyB0aGF0IGRlZmluZSB0aGUgYXBwbGljYXRpb24g\naWQgb2JqZWN0LgogICAgICovCiAgICBwcml2YXRlIFN0cmluZyBnZXRUb1N0\ncmluZ0NvZGUoYm9vbGVhbiBoYXNTdXBlcmNsYXNzKSB7CiAgICAgICAgLy8g\naWYgd2UgYXJlIGJlbG93IGEgY29uY3JldGUgY2xhc3MgdGhlbiB3ZSBjYW5u\nb3QgZGVjbGFyZSBhbnkKICAgICAgICAvLyBtb3JlIHByaW1hcnkga2V5IGZp\nZWxkczsgdGh1cywganVzdCB1c2UgdGhlIHBhcmVudCBpbnZvY2F0aW9uCiAg\nICAgICAgaWYgKGhhc0NvbmNyZXRlU3VwZXJjbGFzcygpIHx8IChoYXNTdXBl\ncmNsYXNzICYmIF9maWVsZHMubGVuZ3RoID09IDApKQogICAgICAgICAgICBy\nZXR1cm4gIiI7CgogICAgICAgIENvZGVGb3JtYXQgY29kZSA9IG5ld0NvZGVG\nb3JtYXQoKTsKICAgICAgICBjb2RlLnRhYigpLmFwcGVuZCgicHVibGljIFN0\ncmluZyB0b1N0cmluZyIpLnBhcmVucygpLgogICAgICAgICAgICBvcGVuQnJh\nY2UoMikuZW5kbCgpOwoKICAgICAgICBTdHJpbmcgbmFtZTsKICAgICAgICBD\nbGFzcyB0eXBlOwogICAgICAgIFN0cmluZyBhcHBlbmREZWxpbWl0ZXIgPSAi\nKyBcIiIgKyBfdG9rZW4gKyAiXCIgKyAiOwogICAgICAgIGZvciAoaW50IGkg\nPSAwOyBpIDwgX2ZpZWxkcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAv\nLyBpZiB0aGlzIGlzIG5vdCB0aGUgZmlyc3QgZmllbGQsIGFkZCBhICsKICAg\nICAgICAgICAgaWYgKGkgPT0gMCkgewogICAgICAgICAgICAgICAgY29kZS50\nYWIoMikuYXBwZW5kKCJyZXR1cm4gIik7CgogICAgICAgICAgICAgICAgLy8g\nYWRkIGluIHRoZSBzdXBlci50b1N0cmluZygpIGlmIHdlIGhhdmUgYSBwYXJl\nbnQKICAgICAgICAgICAgICAgIGlmIChoYXNTdXBlcmNsYXNzICYmIGdldERl\nY2xhcmVkUHJpbWFyeUtleUZpZWxkcwogICAgICAgICAgICAgICAgICAgIChf\nbWV0YS5nZXRQQ1N1cGVyY2xhc3NNZXRhRGF0YSgpKS5sZW5ndGggPiAwKSB7\nCiAgICAgICAgICAgICAgICAgICAgY29kZS5hcHBlbmQoInN1cGVyLnRvU3Ry\naW5nIikucGFyZW5zKCk7CiAgICAgICAgICAgICAgICAgICAgY29kZS5lbmRs\nKCkudGFiKDMpLmFwcGVuZChhcHBlbmREZWxpbWl0ZXIpOwogICAgICAgICAg\nICAgICAgfQogICAgICAgICAgICB9IGVsc2UKICAgICAgICAgICAgICAgIGNv\nZGUuZW5kbCgpLnRhYigzKS5hcHBlbmQoYXBwZW5kRGVsaW1pdGVyKTsKCiAg\nICAgICAgICAgIG5hbWUgPSBfZmllbGRzW2ldLmdldE5hbWUoKTsKICAgICAg\nICAgICAgdHlwZSA9IF9maWVsZHNbaV0uZ2V0T2JqZWN0SWRGaWVsZFR5cGUo\nKTsKICAgICAgICAgICAgaWYgKHR5cGUgPT0gU3RyaW5nLmNsYXNzKQogICAg\nICAgICAgICAgICAgY29kZS5hcHBlbmQobmFtZSk7CiAgICAgICAgICAgIGVs\nc2UgaWYgKHR5cGUgPT0gYnl0ZVtdLmNsYXNzKQogICAgICAgICAgICAgICAg\nY29kZS5hcHBlbmQoInRvU3RyaW5nIikub3BlblBhcmVuKHRydWUpLgogICAg\nICAgICAgICAgICAgICAgIGFwcGVuZChuYW1lKS5jbG9zZVBhcmVuKCk7CiAg\nICAgICAgICAgIGVsc2UgaWYgKHR5cGUgPT0gY2hhcltdLmNsYXNzKQogICAg\nICAgICAgICAgICAgY29kZS5vcGVuUGFyZW4odHJ1ZSkub3BlblBhcmVuKHRy\ndWUpLmFwcGVuZChuYW1lKS4KICAgICAgICAgICAgICAgICAgICBhcHBlbmQo\nIiA9PSBudWxsIikuY2xvc2VQYXJlbigpLmFwcGVuZCgiID8gXCJudWxsXCIi\nKS4KICAgICAgICAgICAgICAgICAgICBhcHBlbmQoIjogU3RyaW5nLnZhbHVl\nT2YiKS5vcGVuUGFyZW4odHJ1ZSkuCiAgICAgICAgICAgICAgICAgICAgYXBw\nZW5kKG5hbWUpLmNsb3NlUGFyZW4oKS5jbG9zZVBhcmVuKCk7CiAgICAgICAg\nICAgIGVsc2UgaWYgKHR5cGUgPT0gRGF0ZS5jbGFzcykKICAgICAgICAgICAg\nICAgIGNvZGUub3BlblBhcmVuKHRydWUpLm9wZW5QYXJlbih0cnVlKS5hcHBl\nbmQobmFtZSkuCiAgICAgICAgICAgICAgICAgICAgYXBwZW5kKCIgPT0gbnVs\nbCIpLmNsb3NlUGFyZW4oKS5hcHBlbmQoIiA/IFwibnVsbFwiIikuCiAgICAg\nICAgICAgICAgICAgICAgZW5kbCgpLnRhYig0KS5hcHBlbmQoIjogU3RyaW5n\nLnZhbHVlT2YiKS4KICAgICAgICAgICAgICAgICAgICBvcGVuUGFyZW4odHJ1\nZSkuYXBwZW5kKG5hbWUpLmFwcGVuZCgiLmdldFRpbWUiKS4KICAgICAgICAg\nICAgICAgICAgICBwYXJlbnMoKS5jbG9zZVBhcmVuKCkuY2xvc2VQYXJlbigp\nOwogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICBjb2RlLmFwcGVu\nZCgiU3RyaW5nLnZhbHVlT2YiKS5vcGVuUGFyZW4odHJ1ZSkuCiAgICAgICAg\nICAgICAgICAgICAgYXBwZW5kKG5hbWUpLmNsb3NlUGFyZW4oKTsKICAgICAg\nICB9CgogICAgICAgIC8vIG5vIGZpZWxkczsganVzdCB1c2UgIiIKICAgICAg\nICBpZiAoX2ZpZWxkcy5sZW5ndGggPT0gMCkKICAgICAgICAgICAgY29kZS50\nYWIoMikuYXBwZW5kKCJyZXR1cm4gXCJcIiIpOwogICAgICAgIGNvZGUuYXBw\nZW5kKCI7IikuZW5kbCgpOwogICAgICAgIGNvZGUuY2xvc2VCcmFjZSgyKTsK\nICAgICAgICByZXR1cm4gY29kZS50b1N0cmluZygpOwogICAgfQoKICAgIC8q\nKgogICAgICogQ29kZSB0byBjb252ZXJ0IGEgc3RyaW5nIHRvIGEgYnl0ZSBh\ncnJheS4KICAgICAqCiAgICAgKiBAc2VlIG9yZy5hcGFjaGUub3BlbmpwYS5s\naWIudXRpbC5CYXNlMTZFbmNvZGVyI2RlY29kZQogICAgICovCiAgICBwcml2\nYXRlIFN0cmluZyBnZXRUb0J5dGVzQnl0ZUFycmF5Q29kZSgpIHsKICAgICAg\nICBDb2RlRm9ybWF0IGNvZGUgPSBuZXdDb2RlRm9ybWF0KCk7CiAgICAgICAg\nY29kZS50YWIoKS5hcHBlbmQoInByaXZhdGUgc3RhdGljIGJ5dGVbXSB0b0J5\ndGVzIikub3BlblBhcmVuKHRydWUpLgogICAgICAgICAgICBhcHBlbmQoIlN0\ncmluZyBzIikuY2xvc2VQYXJlbigpLm9wZW5CcmFjZSgyKS5lbmRsKCk7Cgog\nICAgICAgIGNvZGUudGFiKDIpLmFwcGVuZCgiaWYiKS5vcGVuUGFyZW4odHJ1\nZSkuYXBwZW5kKCJcIm51bGxcIi5lcXVhbHMiKS4KICAgICAgICAgICAgb3Bl\nblBhcmVuKHRydWUpLmFwcGVuZCgicyIpLmNsb3NlUGFyZW4oKS5jbG9zZVBh\ncmVuKCkuZW5kbCgpOwogICAgICAgIGNvZGUudGFiKDMpLmFwcGVuZCgicmV0\ndXJuIG51bGw7IikuZW5kbCgyKTsKCiAgICAgICAgY29kZS50YWIoMikuYXBw\nZW5kKCJpbnQgbGVuID0gcy5sZW5ndGgiKS5wYXJlbnMoKS4KICAgICAgICAg\nICAgYXBwZW5kKCI7IikuZW5kbCgpOwogICAgICAgIGNvZGUudGFiKDIpLmFw\ncGVuZCgiYnl0ZVtdIHIgPSBuZXcgYnl0ZVtsZW4gLyAyXTsiKS5lbmRsKCk7\nCiAgICAgICAgY29kZS50YWIoMikuYXBwZW5kKCJmb3IiKS5vcGVuUGFyZW4o\ndHJ1ZSkuCiAgICAgICAgICAgIGFwcGVuZCgiaW50IGkgPSAwOyBpIDwgci5s\nZW5ndGg7IGkrKyIpLmNsb3NlUGFyZW4oKS4KICAgICAgICAgICAgb3BlbkJy\nYWNlKDMpLmVuZGwoKTsKICAgICAgICBjb2RlLnRhYigzKS5hcHBlbmQoImlu\ndCBkaWdpdDEgPSBzLmNoYXJBdCIpLm9wZW5QYXJlbih0cnVlKS4KICAgICAg\nICAgICAgYXBwZW5kKCJpICogMiIpLmNsb3NlUGFyZW4oKS5hcHBlbmQoIiwg\nIikuCiAgICAgICAgICAgIGFwcGVuZCgiZGlnaXQyID0gcy5jaGFyQXQiKS5v\ncGVuUGFyZW4odHJ1ZSkuCiAgICAgICAgICAgIGFwcGVuZCgiaSAqIDIgKyAx\nIikuY2xvc2VQYXJlbigpLmFwcGVuZCgiOyIpLmVuZGwoKTsKICAgICAgICBj\nb2RlLnRhYigzKS5hcHBlbmQoImlmIikub3BlblBhcmVuKHRydWUpLgogICAg\nICAgICAgICBhcHBlbmQoImRpZ2l0MSA+PSAnMCcgJiYgZGlnaXQxIDw9ICc5\nJyIpLmNsb3NlUGFyZW4oKS5lbmRsKCk7CiAgICAgICAgY29kZS50YWIoNCku\nYXBwZW5kKCJkaWdpdDEgLT0gJzAnOyIpLmVuZGwoKTsKICAgICAgICBjb2Rl\nLnRhYigzKS5hcHBlbmQoImVsc2UgaWYiKS5vcGVuUGFyZW4odHJ1ZSkuCiAg\nICAgICAgICAgIGFwcGVuZCgiZGlnaXQxID49ICdBJyAmJiBkaWdpdDEgPD0g\nJ0YnIikuY2xvc2VQYXJlbigpLmVuZGwoKTsKICAgICAgICBjb2RlLnRhYig0\nKS5hcHBlbmQoImRpZ2l0MSAtPSAnQScgLSAxMDsiKS5lbmRsKCk7CiAgICAg\nICAgY29kZS50YWIoMykuYXBwZW5kKCJpZiIpLm9wZW5QYXJlbih0cnVlKS4K\nICAgICAgICAgICAgYXBwZW5kKCJkaWdpdDIgPj0gJzAnICYmIGRpZ2l0MiA8\nPSAnOSciKS5jbG9zZVBhcmVuKCkuZW5kbCgpOwogICAgICAgIGNvZGUudGFi\nKDQpLmFwcGVuZCgiZGlnaXQyIC09ICcwJzsiKS5lbmRsKCk7CiAgICAgICAg\nY29kZS50YWIoMykuYXBwZW5kKCJlbHNlIGlmIikub3BlblBhcmVuKHRydWUp\nLgogICAgICAgICAgICBhcHBlbmQoImRpZ2l0MiA+PSAnQScgJiYgZGlnaXQy\nIDw9ICdGJyIpLmNsb3NlUGFyZW4oKS5lbmRsKCk7CiAgICAgICAgY29kZS50\nYWIoNCkuYXBwZW5kKCJkaWdpdDIgLT0gJ0EnIC0gMTA7IikuZW5kbCgyKTsK\nICAgICAgICBjb2RlLnRhYigzKS5hcHBlbmQoInJbaV0gPSAoYnl0ZSkgIiku\nb3BlblBhcmVuKGZhbHNlKS4KICAgICAgICAgICAgb3BlblBhcmVuKGZhbHNl\nKS5hcHBlbmQoImRpZ2l0MSA8PCA0IikuY2xvc2VQYXJlbigpLgogICAgICAg\nICAgICBhcHBlbmQoIiArIGRpZ2l0MiIpLmNsb3NlUGFyZW4oKS5hcHBlbmQo\nIjsiKS5lbmRsKCk7CiAgICAgICAgY29kZS5jbG9zZUJyYWNlKDMpLmVuZGwo\nKTsKICAgICAgICBjb2RlLnRhYigyKS5hcHBlbmQoInJldHVybiByOyIpLmVu\nZGwoKTsKCiAgICAgICAgY29kZS5jbG9zZUJyYWNlKDIpOwogICAgICAgIHJl\ndHVybiBjb2RlLnRvU3RyaW5nKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBD\nb2RlIHRvIGNvbnZlcnQgYSBieXRlIGFycmF5IHRvIGEgc3RyaW5nLgogICAg\nICoKICAgICAqIEBzZWUgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51dGlsLkJh\nc2UxNkVuY29kZXIjZW5jb2RlCiAgICAgKi8KICAgIHByaXZhdGUgU3RyaW5n\nIGdldFRvU3RyaW5nQnl0ZUFycmF5Q29kZSgpIHsKICAgICAgICBDb2RlRm9y\nbWF0IGNvZGUgPSBuZXdDb2RlRm9ybWF0KCk7CiAgICAgICAgY29kZS50YWIo\nKS5hcHBlbmQoInByaXZhdGUgc3RhdGljIFN0cmluZyB0b1N0cmluZyIpLm9w\nZW5QYXJlbih0cnVlKS4KICAgICAgICAgICAgYXBwZW5kKCJieXRlW10gYiIp\nLmNsb3NlUGFyZW4oKS5vcGVuQnJhY2UoMikuZW5kbCgpOwoKICAgICAgICBj\nb2RlLnRhYigyKS5hcHBlbmQoImlmIikub3BlblBhcmVuKHRydWUpLgogICAg\nICAgICAgICBhcHBlbmQoImIgPT0gbnVsbCIpLmNsb3NlUGFyZW4oKS5lbmRs\nKCk7CiAgICAgICAgY29kZS50YWIoMykuYXBwZW5kKCJyZXR1cm4gXCJudWxs\nXCI7IikuZW5kbCgyKTsKCiAgICAgICAgY29kZS50YWIoMikuYXBwZW5kKCJT\ndHJpbmdCdWlsZGVyIHIgPSBuZXcgU3RyaW5nQnVpbGRlciIpLgogICAgICAg\nICAgICBvcGVuUGFyZW4odHJ1ZSkuYXBwZW5kKCJiLmxlbmd0aCAqIDIiKS5j\nbG9zZVBhcmVuKCkuCiAgICAgICAgICAgIGFwcGVuZCgiOyIpLmVuZGwoKTsK\nICAgICAgICBjb2RlLnRhYigyKS5hcHBlbmQoImZvciIpLm9wZW5QYXJlbih0\ncnVlKS4KICAgICAgICAgICAgYXBwZW5kKCJpbnQgaSA9IDA7IGkgPCBiLmxl\nbmd0aDsgaSsrIikuY2xvc2VQYXJlbigpLmVuZGwoKTsKICAgICAgICBjb2Rl\nLnRhYigzKS5hcHBlbmQoImZvciIpLm9wZW5QYXJlbih0cnVlKS4KICAgICAg\nICAgICAgYXBwZW5kKCJpbnQgaiA9IDE7IGogPj0gMDsgai0tIikuY2xvc2VQ\nYXJlbigpLmVuZGwoKTsKICAgICAgICBjb2RlLnRhYig0KS5hcHBlbmQoInIu\nYXBwZW5kIikub3BlblBhcmVuKHRydWUpLgogICAgICAgICAgICBhcHBlbmQo\nIkhFWFsiKS5vcGVuUGFyZW4oZmFsc2UpLmFwcGVuZCgiYltpXSA+PiAiKS4K\nICAgICAgICAgICAgb3BlblBhcmVuKGZhbHNlKS5hcHBlbmQoImogKiA0Iiku\nY2xvc2VQYXJlbigpLmNsb3NlUGFyZW4oKS4KICAgICAgICAgICAgYXBwZW5k\nKCIgJiAweEZdIikuY2xvc2VQYXJlbigpLmFwcGVuZCgiOyIpLmVuZGwoKTsK\nICAgICAgICBjb2RlLnRhYigyKS5hcHBlbmQoInJldHVybiByLnRvU3RyaW5n\nIikucGFyZW5zKCkuCiAgICAgICAgICAgIGFwcGVuZCgiOyIpLmVuZGwoKTsK\nCiAgICAgICAgY29kZS5jbG9zZUJyYWNlKDIpOwogICAgICAgIHJldHVybiBj\nb2RlLnRvU3RyaW5nKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBDb2RlIHRv\nIHRlc3QgaWYgdHdvIGJ5dGUgYXJyYXlzIGFyZSBlcXVhbC4KICAgICAqLwog\nICAgcHJpdmF0ZSBTdHJpbmcgZ2V0RXF1YWxzQnl0ZUFycmF5Q29kZSgpIHsK\nICAgICAgICBDb2RlRm9ybWF0IGNvZGUgPSBuZXdDb2RlRm9ybWF0KCk7CiAg\nICAgICAgY29kZS50YWIoKS5hcHBlbmQoInByaXZhdGUgc3RhdGljIGJvb2xl\nYW4gZXF1YWxzIikub3BlblBhcmVuKHRydWUpLgogICAgICAgICAgICBhcHBl\nbmQoImJ5dGVbXSBiMSwgYnl0ZVtdIGIyIikuY2xvc2VQYXJlbigpLm9wZW5C\ncmFjZSgyKS5lbmRsKCk7CgogICAgICAgIGNvZGUudGFiKDIpLmFwcGVuZCgi\naWYiKS5vcGVuUGFyZW4odHJ1ZSkuCiAgICAgICAgICAgIGFwcGVuZCgiYjEg\nPT0gbnVsbCAmJiBiMiA9PSBudWxsIikuY2xvc2VQYXJlbigpLmVuZGwoKTsK\nICAgICAgICBjb2RlLnRhYigzKS5hcHBlbmQoInJldHVybiB0cnVlOyIpLmVu\nZGwoKTsKICAgICAgICBjb2RlLnRhYigyKS5hcHBlbmQoImlmIikub3BlblBh\ncmVuKHRydWUpLgogICAgICAgICAgICBhcHBlbmQoImIxID09IG51bGwgfHwg\nYjIgPT0gbnVsbCIpLmNsb3NlUGFyZW4oKS5lbmRsKCk7CiAgICAgICAgY29k\nZS50YWIoMykuYXBwZW5kKCJyZXR1cm4gZmFsc2U7IikuZW5kbCgpOwogICAg\nICAgIGNvZGUudGFiKDIpLmFwcGVuZCgiaWYiKS5vcGVuUGFyZW4odHJ1ZSku\nCiAgICAgICAgICAgIGFwcGVuZCgiYjEubGVuZ3RoICE9IGIyLmxlbmd0aCIp\nLmNsb3NlUGFyZW4oKS5lbmRsKCk7CiAgICAgICAgY29kZS50YWIoMykuYXBw\nZW5kKCJyZXR1cm4gZmFsc2U7IikuZW5kbCgpOwogICAgICAgIGNvZGUudGFi\nKDIpLmFwcGVuZCgiZm9yIikub3BlblBhcmVuKHRydWUpLgogICAgICAgICAg\nICBhcHBlbmQoImludCBpID0gMDsgaSA8IGIxLmxlbmd0aDsgaSsrIikuY2xv\nc2VQYXJlbigpLmVuZGwoKTsKICAgICAgICBjb2RlLnRhYigzKS5hcHBlbmQo\nImlmIikub3BlblBhcmVuKHRydWUpLgogICAgICAgICAgICBhcHBlbmQoImIx\nW2ldICE9IGIyW2ldIikuY2xvc2VQYXJlbigpLmVuZGwoKTsKICAgICAgICBj\nb2RlLnRhYig0KS5hcHBlbmQoInJldHVybiBmYWxzZTsiKS5lbmRsKCk7CiAg\nICAgICAgY29kZS50YWIoMikuYXBwZW5kKCJyZXR1cm4gdHJ1ZTsiKS5lbmRs\nKCk7CgogICAgICAgIGNvZGUuY2xvc2VCcmFjZSgyKTsKICAgICAgICByZXR1\ncm4gY29kZS50b1N0cmluZygpOwogICAgfQoKICAgIHByaXZhdGUgU3RyaW5n\nIGdldEhhc2hDb2RlQnl0ZUFycmF5Q29kZSgpIHsKICAgICAgICBDb2RlRm9y\nbWF0IGNvZGUgPSBuZXdDb2RlRm9ybWF0KCk7CiAgICAgICAgY29kZS50YWIo\nKS5hcHBlbmQoInByaXZhdGUgc3RhdGljIGludCBoYXNoQ29kZSIpLm9wZW5Q\nYXJlbih0cnVlKS4KICAgICAgICAgICAgYXBwZW5kKCJieXRlW10gYiIpLmNs\nb3NlUGFyZW4oKS5vcGVuQnJhY2UoMikuZW5kbCgpOwoKICAgICAgICBjb2Rl\nLnRhYigyKS5hcHBlbmQoImlmIikub3BlblBhcmVuKHRydWUpLmFwcGVuZCgi\nYiA9PSBudWxsIikuCiAgICAgICAgICAgIGNsb3NlUGFyZW4oKS5lbmRsKCk7\nCiAgICAgICAgY29kZS50YWIoMykuYXBwZW5kKCJyZXR1cm4gMDsiKS5lbmRs\nKCk7CiAgICAgICAgY29kZS50YWIoMikuYXBwZW5kKCJpbnQgc3VtID0gMDsi\nKS5lbmRsKCk7CiAgICAgICAgY29kZS50YWIoMikuYXBwZW5kKCJmb3IiKS5v\ncGVuUGFyZW4odHJ1ZSkuCiAgICAgICAgICAgIGFwcGVuZCgiaW50IGkgPSAw\nOyBpIDwgYi5sZW5ndGg7IGkrKyIpLmNsb3NlUGFyZW4oKS5lbmRsKCk7CiAg\nICAgICAgY29kZS50YWIoMykuYXBwZW5kKCJzdW0gKz0gYltpXTsiKS5lbmRs\nKCk7CiAgICAgICAgY29kZS50YWIoMikuYXBwZW5kKCJyZXR1cm4gc3VtOyIp\nLmVuZGwoKTsKCiAgICAgICAgY29kZS5jbG9zZUJyYWNlKDIpOwogICAgICAg\nIHJldHVybiBjb2RlLnRvU3RyaW5nKCk7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBDb2RlIGRlZmluaW5nIGEgdG9rZW5pemVyIGNsYXNzLgogICAgICovCiAg\nICBwcml2YXRlIFN0cmluZyBnZXRDdXN0b21Ub2tlbml6ZXJDbGFzcygpIHsK\nICAgICAgICBDb2RlRm9ybWF0IGNvZGUgPSBuZXdDb2RlRm9ybWF0KCk7CiAg\nICAgICAgY29kZS50YWIoKS5hcHBlbmQoInByb3RlY3RlZCBzdGF0aWMgY2xh\nc3MgIikuCiAgICAgICAgICAgIGFwcGVuZChUT0tFTklaRVJfQ1VTVE9NKS5v\ncGVuQnJhY2UoMikuZW5kbCgpOwoKICAgICAgICBjb2RlLnRhYigyKS5hcHBl\nbmQoInByaXZhdGUgZmluYWwgU3RyaW5nIHN0cjsiKS5lbmRsKCk7CiAgICAg\nICAgY29kZS50YWIoMikuYXBwZW5kKCJwcml2YXRlIGludCBsYXN0OyIpLmFm\ndGVyU2VjdGlvbigpOwoKICAgICAgICBjb2RlLnRhYigyKS5hcHBlbmQoInB1\nYmxpYyBUb2tlbml6ZXIgKFN0cmluZyBzdHIpIikuCiAgICAgICAgICAgIG9w\nZW5CcmFjZSgzKS5lbmRsKCk7CiAgICAgICAgY29kZS50YWIoMykuYXBwZW5k\nKCJ0aGlzLnN0ciA9IHN0cjsiKS5lbmRsKCk7CiAgICAgICAgY29kZS5jbG9z\nZUJyYWNlKDMpLmFmdGVyU2VjdGlvbigpOwoKICAgICAgICBjb2RlLnRhYigy\nKS5hcHBlbmQoInB1YmxpYyBTdHJpbmcgbmV4dFRva2VuICgpIikuCiAgICAg\nICAgICAgIG9wZW5CcmFjZSgzKS5lbmRsKCk7CiAgICAgICAgY29kZS50YWIo\nMykuYXBwZW5kKCJpbnQgbmV4dCA9IHN0ci5pbmRleE9mIikub3BlblBhcmVu\nKHRydWUpLgogICAgICAgICAgICBhcHBlbmQoIlwiIikuYXBwZW5kKF90b2tl\nbikuYXBwZW5kKCJcIiwgbGFzdCIpLmNsb3NlUGFyZW4oKS4KICAgICAgICAg\nICAgYXBwZW5kKCI7IikuZW5kbCgpOwogICAgICAgIGNvZGUudGFiKDMpLmFw\ncGVuZCgiU3RyaW5nIHBhcnQ7IikuZW5kbCgpOwogICAgICAgIGNvZGUudGFi\nKDMpLmFwcGVuZCgiaWYiKS5vcGVuUGFyZW4odHJ1ZSkuYXBwZW5kKCJuZXh0\nID09IC0xIikuCiAgICAgICAgICAgIGNsb3NlUGFyZW4oKS5vcGVuQnJhY2Uo\nNCkuZW5kbCgpOwogICAgICAgIGNvZGUudGFiKDQpLmFwcGVuZCgicGFydCA9\nIHN0ci5zdWJzdHJpbmciKS5vcGVuUGFyZW4odHJ1ZSkuCiAgICAgICAgICAg\nIGFwcGVuZCgibGFzdCIpLmNsb3NlUGFyZW4oKS5hcHBlbmQoIjsiKS5lbmRs\nKCk7CiAgICAgICAgY29kZS50YWIoNCkuYXBwZW5kKCJsYXN0ID0gc3RyLmxl\nbmd0aCIpLnBhcmVucygpLmFwcGVuZCgiOyIpLgogICAgICAgICAgICBlbmRs\nKCkuY2xvc2VCcmFjZSg0KTsKICAgICAgICBpZiAoIWNvZGUuZ2V0QnJhY2VP\nblNhbWVMaW5lKCkpCiAgICAgICAgICAgIGNvZGUuZW5kbCgpLnRhYigzKTsK\nICAgICAgICBlbHNlCiAgICAgICAgICAgIGNvZGUuYXBwZW5kKCIgIik7CiAg\nICAgICAgY29kZS5hcHBlbmQoImVsc2UiKS5vcGVuQnJhY2UoNCkuZW5kbCgp\nOwogICAgICAgIGNvZGUudGFiKDQpLmFwcGVuZCgicGFydCA9IHN0ci5zdWJz\ndHJpbmciKS5vcGVuUGFyZW4odHJ1ZSkuCiAgICAgICAgICAgIGFwcGVuZCgi\nbGFzdCwgbmV4dCIpLmNsb3NlUGFyZW4oKS5hcHBlbmQoIjsiKS5lbmRsKCk7\nCiAgICAgICAgY29kZS50YWIoNCkuYXBwZW5kKCJsYXN0ID0gbmV4dCArICIp\nLmFwcGVuZChfdG9rZW4ubGVuZ3RoKCkpLgogICAgICAgICAgICBhcHBlbmQo\nIjsiKS5lbmRsKCkuY2xvc2VCcmFjZSg0KS5lbmRsKCk7CgogICAgICAgIGNv\nZGUudGFiKDMpLmFwcGVuZCgicmV0dXJuIHBhcnQ7IikuZW5kbCgpOwogICAg\nICAgIGNvZGUuY2xvc2VCcmFjZSgzKTsKICAgICAgICBjb2RlLmVuZGwoKS5j\nbG9zZUJyYWNlKDIpOwogICAgICAgIHJldHVybiBjb2RlLnRvU3RyaW5nKCk7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIGZpbGUgdGhhdCB0\naGlzIHRvb2wgc2hvdWxkIG91dHB1dCB0by4KICAgICAqLwogICAgcHJpdmF0\nZSBGaWxlIGdldEZpbGUoKSB7CiAgICAgICAgaWYgKF9tZXRhID09IG51bGwp\nCiAgICAgICAgICAgIHJldHVybiBudWxsOwoKICAgICAgICBTdHJpbmcgcGFj\na2FnZU5hbWUgPSBTdHJpbmdzLmdldFBhY2thZ2VOYW1lKF9tZXRhLmdldE9i\namVjdElkVHlwZSgpKTsKICAgICAgICBTdHJpbmcgZmlsZU5hbWUgPSBTdHJp\nbmdzLmdldENsYXNzTmFtZShfbWV0YS5nZXRPYmplY3RJZFR5cGUoKSkKICAg\nICAgICAgICAgKyAiLmphdmEiOwoKICAgICAgICAvLyBpZiBwYyBjbGFzcyBp\nbiBzYW1lIHBhY2thZ2UgYXMgb2lkIGNsYXNzLCB0cnkgdG8gZmluZCBwYyAu\namF2YSBmaWxlCiAgICAgICAgRmlsZSBkaXIgPSBudWxsOwogICAgICAgIGlm\nIChfZGlyID09IG51bGwgJiYgU3RyaW5ncy5nZXRQYWNrYWdlTmFtZShfdHlw\nZSkuZXF1YWxzKHBhY2thZ2VOYW1lKSkgewogICAgICAgICAgICBkaXIgPSBG\naWxlcy5nZXRTb3VyY2VGaWxlKF90eXBlKTsKICAgICAgICAgICAgaWYgKGRp\nciAhPSBudWxsKQogICAgICAgICAgICAgICAgZGlyID0gZGlyLmdldFBhcmVu\ndEZpbGUoKTsKICAgICAgICB9CiAgICAgICAgaWYgKGRpciA9PSBudWxsKQog\nICAgICAgICAgICBkaXIgPSBGaWxlcy5nZXRQYWNrYWdlRmlsZShfZGlyLCBw\nYWNrYWdlTmFtZSwgdHJ1ZSk7CiAgICAgICAgcmV0dXJuIG5ldyBGaWxlKGRp\nciwgZmlsZU5hbWUpOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIGEg\nY29weSBvZiB0aGUgY29ycmVjdCBjb2RlIGZvcm1hdC4KICAgICAqLwogICAg\ncHJpdmF0ZSBDb2RlRm9ybWF0IG5ld0NvZGVGb3JtYXQoKSB7CiAgICAgICAg\ncmV0dXJuIChfZm9ybWF0ID09IG51bGwpID8gbmV3IENvZGVGb3JtYXQoKQog\nICAgICAgICAgICA6IChDb2RlRm9ybWF0KSBfZm9ybWF0LmNsb25lKCk7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBVc2FnZTogamF2YSBvcmcuYXBhY2hlLm9w\nZW5qcGEuZW5oYW5jZS5BcHBsaWNhdGlvbklkVG9vbCBbb3B0aW9uXSoKICAg\nICAqICZsdDtjbGFzcyBuYW1lIHwgLmphdmEgZmlsZSB8IC5jbGFzcyBmaWxl\nIHwgLmpkbyBmaWxlJmd0OysKICAgICAqICBXaGVyZSB0aGUgZm9sbG93aW5n\nIG9wdGlvbnMgYXJlIHJlY29nbml6ZWQuCiAgICAgKiA8dWw+CiAgICAgKiA8\nbGk+PGk+LXByb3BlcnRpZXMvLXAgJmx0O3Byb3BlcnRpZXMgZmlsZSZndDs8\nL2k+OiBUaGUgcGF0aCB0byBhIE9wZW5KUEEKICAgICAqIHByb3BlcnRpZXMg\nZmlsZSBjb250YWluaW5nIGluZm9ybWF0aW9uIGFzIG91dGxpbmVkIGluCiAg\nICAgKiB7QGxpbmsgQ29uZmlndXJhdGlvbn07IG9wdGlvbmFsLjwvbGk+CiAg\nICAgKiA8bGk+PGk+LSZsdDtwcm9wZXJ0eSBuYW1lJmd0OyAmbHQ7cHJvcGVy\ndHkgdmFsdWUmZ3Q7PC9pPjogQWxsIGJlYW4KICAgICAqIHByb3BlcnRpZXMg\nb2YgdGhlIHN0YW5kYXJkIE9wZW5KUEEge0BsaW5rIE9wZW5KUEFDb25maWd1\ncmF0aW9ufSBjYW4gYmUKICAgICAqIHNldCBieSB1c2luZyB0aGVpciBuYW1l\ncyBhbmQgc3VwcGx5aW5nIGEgdmFsdWUuPC9saT4KICAgICAqIDxsaT48aT4t\nZGlyZWN0b3J5Ly1kICZsdDtvdXRwdXQgZGlyZWN0b3J5Jmd0OzwvaT46IFBh\ndGggdG8gdGhlIGJhc2UKICAgICAqIHNvdXJjZSBkaXJlY3RvcnkuIFRoZSBw\nYWNrYWdlIHN0cnVjdHVyZSB3aWxsIGJlIGNyZWF0ZWQgYmVuZWF0aAogICAg\nICogdGhpcyBkaXJlY3RvcnkgaWYgbmVjZXNzYXJ5LiBJZiBub3Qgc3BlY2lm\naWVkLCB0aGUgdG9vbCB3aWxsIHRyeQogICAgICogdG8gbG9jYXRlIHRoZSAu\namF2YSBmaWxlIGluIHRoZSBDTEFTU1BBVEggYW5kIG91dHB1dCB0byB0aGUg\nc2FtZQogICAgICogZGlyZWN0b3J5OyBmYWlsaW5nIHRoYXQsIGl0IHdpbGwg\ndXNlIHRoZSBjdXJyZW50IGRpcmVjdG9yeSBhcwogICAgICogdGhlIGJhc2Ug\nZGlyZWN0b3J5LgogICAgICogPGxpPjxpPi1pZ25vcmVFcnJvcnMvLWkgJmx0\nO3RydWUvdCB8IGZhbHNlL2YmZ3Q7PC9pPjogSWYgZmFsc2UsIGFuCiAgICAg\nKiBleGNlcHRpb24gd2lsbCBiZSB0aHJvd24gaWYgdGhlIHRvb2wgZW5jb3Vu\ndGVycyBhbnkgY2xhc3MgdGhhdAogICAgICogZG9lcyBub3QgdXNlIGFwcGxp\nY2F0aW9uIGlkZW50aXR5IG9yIHVzZXMgdGhlIGlkZW50aXR5IGNsYXNzIG9m\nCiAgICAgKiBpdHMgc3VwZXJjbGFzczsgZGVmYXVsdHMgdG8gdHJ1ZS48L2xp\nPgogICAgICogPGxpPjxpPi10b2tlbi8tdCAmbHQ7dG9rZW4mZ3Q7PC9pPjog\nVGhlIHRva2VuIHRvIHVzZSB0byBzZXBhcmF0ZQogICAgICogc3RpbmdpZmll\nZCBwcmltYXJ5IGtleSBmaWVsZCB2YWx1ZXMgaW4gdGhlIHN0cmluZ2lmaWVk\nIG9pZC48L2xpPgogICAgICogPGxpPjxpPi1uYW1lLy1uICZsdDtpZCBjbGFz\ncyBuYW1lJmd0OzwvaT46IFRoZSBuYW1lIG9mIHRoZSBpZGVudGl0eQogICAg\nICogY2xhc3MgdG8gZ2VuZXJhdGUuIElmIHRoaXMgb3B0aW9uIGlzIHNwZWNp\nZmllZCwgeW91IG11c3Qgb25seQogICAgICogZ2l2ZSBhIHNpbmdsZSBjbGFz\ncyBhcmd1bWVudC4gSWYgdGhlIGNsYXNzIG1ldGFkYXRhIG5hbWVzIGFuIG9i\namVjdAogICAgICogaWQgY2xhc3MsIHRoaXMgYXJndW1lbnQgaXMgaWdub3Jl\nZC48L2xpPgogICAgICogPGxpPjxpPi1zdWZmaXgvLXMgJmx0O2lkIGNsYXNz\nIHN1ZmZpeCZndDs8L2k+OiBBIHN0cmluZyB0byBzdWZmaXggZWFjaAogICAg\nICogcGVyc2lzdGVudCBjbGFzcyB3aXRoIHRvIGNyZWF0ZSB0aGUgaWRlbnRp\ndHkgY2xhc3MgbmFtZS4gVGhpcyBpcwogICAgICogb3ZlcnJpZGRlbiBieSA8\nY29kZT4tbmFtZTwvY29kZT4gb3IgYnkgYW55IGlkZW50aXR5IGNsYXNzIG5h\nbWUKICAgICAqIHNwZWNpZmllZCBpbiBtZXRhZGF0YS48L2xpPgogICAgICog\nPGxpPjxpPi1jb2RlRm9ybWF0Ly1jZi4mbHQ7cHJvcGVydHkgbmFtZSZndDsg\nJmx0OyBwcm9wZXJ0eSB2YWx1ZSZndDs8L2k+CiAgICAgKiA6IEFyZ3VtZW50\ncyBsaWtlIHRoaXMgd2lsbCBiZSB1c2VkIHRvIGNvbmZpZ3VyZSB0aGUgYmVh\nbgogICAgICogcHJvcGVydGllcyBvZiB0aGUgaW50ZXJuYWwge0BsaW5rIENv\nZGVGb3JtYXR9LjwvbGk+CiAgICAgKiA8L3VsPgogICAgICogIEVhY2ggYWRk\naXRpb25hbCBhcmd1bWVudCBjYW4gYmUgZWl0aGVyIHRoZSBmdWxsIGNsYXNz\nIG5hbWUgb2YgdGhlCiAgICAgKiB0eXBlIHRvIGNyZWF0ZSBhbiBpZCBjbGFz\ncyBmb3IsIHRoZSBwYXRoIHRvIHRoZSAuamF2YSBmaWxlIGZvciB0aGUgdHlw\nZSwKICAgICAqIHRoZSBwYXRoIHRvIHRoZSAuY2xhc3MgZmlsZSBmb3IgdGhl\nIHR5cGUsIG9yIHRoZSBwYXRoIHRvIGEgLmpkbyBmaWxlCiAgICAgKiBsaXN0\naW5nIG9uZSBvciBtb3JlIHR5cGVzLiBJZiBhIC5qYXZhIGZpbGUgYWxyZWFk\neSBleGlzdHMgZm9yIGFuCiAgICAgKiBhcHBsaWNhdGlvbiBpZCwgaXQgd2ls\nbCBiZSBiYWNrZWQgdXAgdG8gYSBmaWxlIG5hbWVkCiAgICAgKiAmbHQ7b3Jp\nZyBmaWxlIG5hbWUmZ3Q7fi4KICAgICAqLwogICAgcHVibGljIHN0YXRpYyB2\nb2lkIG1haW4oU3RyaW5nW10gYXJncykKICAgICAgICB0aHJvd3MgSU9FeGNl\ncHRpb24sIENsYXNzTm90Rm91bmRFeGNlcHRpb24gewogICAgICAgIE9wdGlv\nbnMgb3B0cyA9IG5ldyBPcHRpb25zKCk7CiAgICAgICAgZmluYWwgU3RyaW5n\nW10gYXJndW1lbnRzID0gb3B0cy5zZXRGcm9tQ21kTGluZShhcmdzKTsKICAg\nICAgICBib29sZWFuIHJldCA9IENvbmZpZ3VyYXRpb25zLnJ1bkFnYWluc3RB\nbGxBbmNob3JzKG9wdHMsCiAgICAgICAgICAgIG5ldyBDb25maWd1cmF0aW9u\ncy5SdW5uYWJsZSgpIHsKICAgICAgICAgICAgcHVibGljIGJvb2xlYW4gcnVu\nKE9wdGlvbnMgb3B0cykKICAgICAgICAgICAgICAgIHRocm93cyBDbGFzc05v\ndEZvdW5kRXhjZXB0aW9uLCBJT0V4Y2VwdGlvbiB7CiAgICAgICAgICAgICAg\nICBPcGVuSlBBQ29uZmlndXJhdGlvbiBjb25mID0gbmV3IE9wZW5KUEFDb25m\naWd1cmF0aW9uSW1wbCgpOwogICAgICAgICAgICAgICAgdHJ5IHsKICAgICAg\nICAgICAgICAgICAgICByZXR1cm4gQXBwbGljYXRpb25JZFRvb2wucnVuKGNv\nbmYsIGFyZ3VtZW50cywgb3B0cyk7CiAgICAgICAgICAgICAgICB9IGZpbmFs\nbHkgewogICAgICAgICAgICAgICAgICAgIGNvbmYuY2xvc2UoKTsKICAgICAg\nICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0pOwogICAgICAg\nIGlmICghcmV0KQogICAgICAgICAgICBTeXN0ZW0uZXJyLnByaW50bG4oX2xv\nYy5nZXQoImFwcGlkLXVzYWdlIikpOwogICAgfQoKICAgIC8qKgogICAgICog\nUnVuIHRoZSBhcHBsaWNhdGlvbiBpZCB0b29sIHdpdGggdGhlIGdpdmVuIGNv\nbW1hbmQtbGluZSBhbmQKICAgICAqIGdpdmVuIGNvbmZpZ3VyYXRpb24uIFJl\ndHVybnMgZmFsc2UgaWYgaW52YWxpZCBvcHRpb25zIHdlcmUgZ2l2ZW4uCiAg\nICAgKi8KICAgIHB1YmxpYyBzdGF0aWMgYm9vbGVhbiBydW4oT3BlbkpQQUNv\nbmZpZ3VyYXRpb24gY29uZiwgU3RyaW5nW10gYXJncywKICAgICAgICBPcHRp\nb25zIG9wdHMpCiAgICAgICAgdGhyb3dzIElPRXhjZXB0aW9uLCBDbGFzc05v\ndEZvdW5kRXhjZXB0aW9uIHsKICAgICAgICBGbGFncyBmbGFncyA9IG5ldyBG\nbGFncygpOwogICAgICAgIGZsYWdzLmlnbm9yZUVycm9ycyA9IG9wdHMucmVt\nb3ZlQm9vbGVhblByb3BlcnR5CiAgICAgICAgICAgICgiaWdub3JlRXJyb3Jz\nIiwgImkiLCBmbGFncy5pZ25vcmVFcnJvcnMpOwogICAgICAgIGZsYWdzLmRp\ncmVjdG9yeSA9IEZpbGVzLmdldEZpbGUob3B0cy5yZW1vdmVQcm9wZXJ0eSgi\nZGlyZWN0b3J5IiwgImQiLAogICAgICAgICAgICBudWxsKSwgbnVsbCk7CiAg\nICAgICAgZmxhZ3MudG9rZW4gPSBvcHRzLnJlbW92ZVByb3BlcnR5KCJ0b2tl\nbiIsICJ0IiwgZmxhZ3MudG9rZW4pOwogICAgICAgIGZsYWdzLm5hbWUgPSBv\ncHRzLnJlbW92ZVByb3BlcnR5KCJuYW1lIiwgIm4iLCBmbGFncy5uYW1lKTsK\nICAgICAgICBmbGFncy5zdWZmaXggPSBvcHRzLnJlbW92ZVByb3BlcnR5KCJz\ndWZmaXgiLCAicyIsIGZsYWdzLnN1ZmZpeCk7CgogICAgICAgIC8vIHNlcGFy\nYXRlIHRoZSBwcm9wZXJ0aWVzIGZvciB0aGUgY3VzdG9taXplciBhbmQgY29k\nZSBmb3JtYXQKICAgICAgICBPcHRpb25zIGZvcm1hdE9wdHMgPSBuZXcgT3B0\naW9ucygpOwogICAgICAgIE1hcC5FbnRyeSBlbnRyeTsKICAgICAgICBTdHJp\nbmcga2V5OwogICAgICAgIGZvciAoSXRlcmF0b3IgaXRyID0gb3B0cy5lbnRy\neVNldCgpLml0ZXJhdG9yKCk7IGl0ci5oYXNOZXh0KCk7KSB7CiAgICAgICAg\nICAgIGVudHJ5ID0gKE1hcC5FbnRyeSkgaXRyLm5leHQoKTsKICAgICAgICAg\nICAga2V5ID0gKFN0cmluZykgZW50cnkuZ2V0S2V5KCk7CiAgICAgICAgICAg\nIGlmIChrZXkuc3RhcnRzV2l0aCgiY29kZUZvcm1hdC4iKSkgewogICAgICAg\nICAgICAgICAgZm9ybWF0T3B0cy5wdXQoa2V5LnN1YnN0cmluZygxMSksIGVu\ndHJ5LmdldFZhbHVlKCkpOwogICAgICAgICAgICAgICAgaXRyLnJlbW92ZSgp\nOwogICAgICAgICAgICB9IGVsc2UgaWYgKGtleS5zdGFydHNXaXRoKCJjZi4i\nKSkgewogICAgICAgICAgICAgICAgZm9ybWF0T3B0cy5wdXQoa2V5LnN1YnN0\ncmluZygzKSwgZW50cnkuZ2V0VmFsdWUoKSk7CiAgICAgICAgICAgICAgICBp\ndHIucmVtb3ZlKCk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAg\naWYgKCFmb3JtYXRPcHRzLmlzRW1wdHkoKSkgewogICAgICAgICAgICBmbGFn\ncy5mb3JtYXQgPSBuZXcgQ29kZUZvcm1hdCgpOwogICAgICAgICAgICBmb3Jt\nYXRPcHRzLnNldEludG8oZmxhZ3MuZm9ybWF0KTsKICAgICAgICB9CgogICAg\nICAgIENvbmZpZ3VyYXRpb25zLnBvcHVsYXRlQ29uZmlndXJhdGlvbihjb25m\nLCBvcHRzKTsKICAgICAgICBDbGFzc0xvYWRlciBsb2FkZXIgPSBjb25mLmdl\ndENsYXNzUmVzb2x2ZXJJbnN0YW5jZSgpLgogICAgICAgICAgICBnZXRDbGFz\nc0xvYWRlcihBcHBsaWNhdGlvbklkVG9vbC5jbGFzcywgbnVsbCk7CiAgICAg\nICAgcmV0dXJuIHJ1bihjb25mLCBhcmdzLCBmbGFncywgbG9hZGVyKTsKICAg\nIH0KCiAgICAvKioKICAgICAqIFJ1biB0aGUgdG9vbC4gUmV0dXJucyBmYWxz\nZSBpZiBpbnZhbGlkIG9wdGlvbnMgd2VyZSBnaXZlbi4KICAgICAqLwogICAg\ncHVibGljIHN0YXRpYyBib29sZWFuIHJ1bihPcGVuSlBBQ29uZmlndXJhdGlv\nbiBjb25mLCBTdHJpbmdbXSBhcmdzLAogICAgICAgIEZsYWdzIGZsYWdzLCBD\nbGFzc0xvYWRlciBsb2FkZXIpCiAgICAgICAgdGhyb3dzIElPRXhjZXB0aW9u\nLCBDbGFzc05vdEZvdW5kRXhjZXB0aW9uIHsKICAgICAgICBNZXRhRGF0YVJl\ncG9zaXRvcnkgcmVwb3MgPSBjb25mLm5ld01ldGFEYXRhUmVwb3NpdG9yeUlu\nc3RhbmNlKCk7CiAgICAgICAgcmVwb3Muc2V0VmFsaWRhdGUocmVwb3MuVkFM\nSURBVEVfTk9ORSwgdHJ1ZSk7CiAgICAgICAgbG9hZE9iamVjdElkcyhyZXBv\ncywgZmxhZ3MubmFtZSA9PSBudWxsICYmIGZsYWdzLnN1ZmZpeCA9PSBudWxs\nKTsKCiAgICAgICAgTG9nIGxvZyA9IGNvbmYuZ2V0TG9nKE9wZW5KUEFDb25m\naWd1cmF0aW9uLkxPR19UT09MKTsKICAgICAgICBDb2xsZWN0aW9uIGNsYXNz\nZXM7CiAgICAgICAgaWYgKGFyZ3MubGVuZ3RoID09IDApIHsKICAgICAgICAg\nICAgbG9nLmluZm8oX2xvYy5nZXQoInJ1bm5pbmctYWxsLWNsYXNzZXMiKSk7\nCiAgICAgICAgICAgIGNsYXNzZXMgPSByZXBvcy5sb2FkUGVyc2lzdGVudFR5\ncGVzKHRydWUsIGxvYWRlcik7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAg\nICAgQ2xhc3NBcmdQYXJzZXIgY2FwID0gY29uZi5nZXRNZXRhRGF0YVJlcG9z\naXRvcnlJbnN0YW5jZSgpLgogICAgICAgICAgICAgICAgZ2V0TWV0YURhdGFG\nYWN0b3J5KCkubmV3Q2xhc3NBcmdQYXJzZXIoKTsKICAgICAgICAgICAgY2Fw\nLnNldENsYXNzTG9hZGVyKGxvYWRlcik7CiAgICAgICAgICAgIGNsYXNzZXMg\nPSBuZXcgSGFzaFNldCgpOwogICAgICAgICAgICBmb3IgKGludCBpID0gMDsg\naSA8IGFyZ3MubGVuZ3RoOyBpKyspCiAgICAgICAgICAgICAgICBjbGFzc2Vz\nLmFkZEFsbChBcnJheXMuYXNMaXN0KGNhcC5wYXJzZVR5cGVzKGFyZ3NbaV0p\nKSk7CiAgICAgICAgfQogICAgICAgIGlmIChmbGFncy5uYW1lICE9IG51bGwg\nJiYgY2xhc3Nlcy5zaXplKCkgPiAxKQogICAgICAgICAgICB0aHJvdyBuZXcg\nVXNlckV4Y2VwdGlvbihfbG9jLmdldCgibmFtZS1tdWx0LWFyZ3MiLCBjbGFz\nc2VzKSk7CgogICAgICAgIEFwcGxpY2F0aW9uSWRUb29sIHRvb2w7CiAgICAg\nICAgQ2xhc3MgY2xzOwogICAgICAgIENsYXNzTWV0YURhdGEgbWV0YTsKICAg\nICAgICBCQ0NsYXNzTG9hZGVyIGJjID0gQWNjZXNzQ29udHJvbGxlcgogICAg\nICAgICAgICAuZG9Qcml2aWxlZ2VkKEoyRG9Qcml2SGVscGVyLm5ld0JDQ2xh\nc3NMb2FkZXJBY3Rpb24obmV3IFByb2plY3QoKSkpOwogICAgICAgIGZvciAo\nSXRlcmF0b3IgaXRyID0gY2xhc3Nlcy5pdGVyYXRvcigpOyBpdHIuaGFzTmV4\ndCgpOykgewogICAgICAgICAgICBjbHMgPSAoQ2xhc3MpIGl0ci5uZXh0KCk7\nCiAgICAgICAgICAgIGxvZy5pbmZvKF9sb2MuZ2V0KCJhcHBpZC1ydW5uaW5n\nIiwgY2xzKSk7CgogICAgICAgICAgICBtZXRhID0gcmVwb3MuZ2V0TWV0YURh\ndGEoY2xzLCBudWxsLCBmYWxzZSk7CiAgICAgICAgICAgIHNldE9iamVjdElk\nVHlwZShtZXRhLCBmbGFncywgYmMpOwoKICAgICAgICAgICAgdG9vbCA9IG5l\ndyBBcHBsaWNhdGlvbklkVG9vbChjb25mLCBjbHMsIG1ldGEpOwogICAgICAg\nICAgICB0b29sLnNldERpcmVjdG9yeShmbGFncy5kaXJlY3RvcnkpOwogICAg\nICAgICAgICB0b29sLnNldElnbm9yZUVycm9ycyhmbGFncy5pZ25vcmVFcnJv\ncnMpOwogICAgICAgICAgICB0b29sLnNldFRva2VuKGZsYWdzLnRva2VuKTsK\nICAgICAgICAgICAgdG9vbC5zZXRDb2RlRm9ybWF0KGZsYWdzLmZvcm1hdCk7\nCiAgICAgICAgICAgIGlmICh0b29sLnJ1bigpKSB7CiAgICAgICAgICAgICAg\nICBsb2cuaW5mbyhfbG9jLmdldCgiYXBwaWQtb3V0cHV0IiwgdG9vbC5nZXRG\naWxlKCkpKTsKICAgICAgICAgICAgICAgIHRvb2wucmVjb3JkKCk7CiAgICAg\nICAgICAgIH0gZWxzZQogICAgICAgICAgICAgICAgbG9nLmluZm8oX2xvYy5n\nZXQoImFwcGlkLW5vcnVuIikpOwogICAgICAgIH0KICAgICAgICBiYy5nZXRQ\ncm9qZWN0KCkuY2xlYXIoKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0K\nCiAgICAvKioKICAgICAqIFNldCB0aGUgb2JqZWN0IGlkIHR5cGUgb2YgdGhl\nIGdpdmVuIG1ldGFkYXRhLgogICAgICovCiAgICBwcml2YXRlIHN0YXRpYyB2\nb2lkIHNldE9iamVjdElkVHlwZShDbGFzc01ldGFEYXRhIG1ldGEsIEZsYWdz\nIGZsYWdzLAogICAgICAgIEJDQ2xhc3NMb2FkZXIgYmMpCiAgICAgICAgdGhy\nb3dzIENsYXNzTm90Rm91bmRFeGNlcHRpb24gewogICAgICAgIGlmIChtZXRh\nID09IG51bGwgfHwgKG1ldGEuZ2V0T2JqZWN0SWRUeXBlKCkgIT0gbnVsbAog\nICAgICAgICAgICAmJiAoIW1ldGEuaXNPcGVuSlBBSWRlbnRpdHkoKSB8fCBm\nbGFncy5uYW1lID09IG51bGwpKQogICAgICAgICAgICB8fCBnZXREZWNsYXJl\nZFByaW1hcnlLZXlGaWVsZHMobWV0YSkubGVuZ3RoID09IDApCiAgICAgICAg\nICAgIHJldHVybjsKCiAgICAgICAgQ2xhc3MgZGVzYyA9IG1ldGEuZ2V0RGVz\nY3JpYmVkVHlwZSgpOwogICAgICAgIENsYXNzIGNscyA9IG51bGw7CiAgICAg\nICAgaWYgKGZsYWdzLm5hbWUgIT0gbnVsbCkKICAgICAgICAgICAgY2xzID0g\nbG9hZENsYXNzKGRlc2MsIGZsYWdzLm5hbWUsIGJjKTsKICAgICAgICBlbHNl\nIGlmIChmbGFncy5zdWZmaXggIT0gbnVsbCkKICAgICAgICAgICAgY2xzID0g\nbG9hZENsYXNzKGRlc2MsIGRlc2MuZ2V0TmFtZSgpICsgZmxhZ3Muc3VmZml4\nLCBiYyk7CiAgICAgICAgbWV0YS5zZXRPYmplY3RJZFR5cGUoY2xzLCBmYWxz\nZSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBMb2FkIHRoZSBnaXZlbiBjbGFz\ncyBuYW1lIGV2ZW4gaWYgaXQgZG9lcyBub3QgZXhpc3QuCiAgICAgKi8KICAg\nIHByaXZhdGUgc3RhdGljIENsYXNzIGxvYWRDbGFzcyhDbGFzcyBjb250ZXh0\nLCBTdHJpbmcgbmFtZSwKICAgICAgICBCQ0NsYXNzTG9hZGVyIGJjKQogICAg\nICAgIHRocm93cyBDbGFzc05vdEZvdW5kRXhjZXB0aW9uIHsKICAgICAgICBp\nZiAobmFtZS5pbmRleE9mKCcuJykgPT0gLTEgJiYgY29udGV4dC5nZXROYW1l\nKCkuaW5kZXhPZignLicpICE9IC0xKQogICAgICAgICAgICBuYW1lID0gU3Ry\naW5ncy5nZXRQYWNrYWdlTmFtZShjb250ZXh0KSArICIuIiArIG5hbWU7Cgog\nICAgICAgIC8vIGZpcnN0IHRyeSB3aXRoIHJlZ3VsYXIgY2xhc3MgbG9hZGVy\nCiAgICAgICAgQ2xhc3NMb2FkZXIgbG9hZGVyID0gQWNjZXNzQ29udHJvbGxl\nci5kb1ByaXZpbGVnZWQoCiAgICAgICAgICAgIEoyRG9Qcml2SGVscGVyLmdl\ndENsYXNzTG9hZGVyQWN0aW9uKGNvbnRleHQpKTsgCiAgICAgICAgaWYgKGxv\nYWRlciA9PSBudWxsKQogICAgICAgICAgICBsb2FkZXIgPSBBY2Nlc3NDb250\ncm9sbGVyLmRvUHJpdmlsZWdlZCgKICAgICAgICAgICAgICAgIEoyRG9Qcml2\nSGVscGVyLmdldENvbnRleHRDbGFzc0xvYWRlckFjdGlvbigpKTsgCiAgICAg\nICAgdHJ5IHsKICAgICAgICAgICAgcmV0dXJuIENsYXNzLmZvck5hbWUobmFt\nZSwgZmFsc2UsIGxvYWRlcik7CiAgICAgICAgfSBjYXRjaCAoVGhyb3dhYmxl\nIHQpIHsKICAgICAgICB9CgogICAgICAgIC8vIGNyZWF0ZSBjbGFzcwogICAg\nICAgIEJDQ2xhc3Mgb2lkID0gYmMuZ2V0UHJvamVjdCgpLmxvYWRDbGFzcyhu\nYW1lLCBudWxsKTsKICAgICAgICBvaWQuYWRkRGVmYXVsdENvbnN0cnVjdG9y\nKCk7CiAgICAgICAgcmV0dXJuIENsYXNzLmZvck5hbWUobmFtZSwgZmFsc2Us\nIGJjKTsKICAgIH0KCiAgICAvKioKICAgICAqIFRlbGwgdGhlIG1ldGFkYXRh\nIGZhY3RvcnkgdG8gbG9hZCBvYmplY3QgaWQgY2xhc3NlcyBldmVuIGlmIHRo\nZXkgZG9uJ3QKICAgICAqIGV4aXN0LgogICAgICovCiAgICBwcml2YXRlIHN0\nYXRpYyB2b2lkIGxvYWRPYmplY3RJZHMoTWV0YURhdGFSZXBvc2l0b3J5IHJl\ncG9zLCBib29sZWFuIGZhdGFsKSB7CiAgICAgICAgTWV0YURhdGFGYWN0b3J5\nIG1kZiA9IHJlcG9zLmdldE1ldGFEYXRhRmFjdG9yeSgpOwogICAgICAgIGlm\nIChtZGYgaW5zdGFuY2VvZiBEZWxlZ2F0aW5nTWV0YURhdGFGYWN0b3J5KQog\nICAgICAgICAgICBtZGYgPSAoKERlbGVnYXRpbmdNZXRhRGF0YUZhY3Rvcnkp\nIG1kZikuZ2V0SW5uZXJtb3N0RGVsZWdhdGUoKTsKICAgICAgICBpZiAobWRm\nIGluc3RhbmNlb2YgT2JqZWN0SWRMb2FkZXIpCiAgICAgICAgICAgICgoT2Jq\nZWN0SWRMb2FkZXIpIG1kZikuc2V0TG9hZE9iamVjdElkcygpOwogICAgICAg\nIGVsc2UgaWYgKGZhdGFsKQogICAgICAgICAgICB0aHJvdyBuZXcgSW52YWxp\nZFN0YXRlRXhjZXB0aW9uKF9sb2MuZ2V0KCJmYWN0b3J5LW5vdC1vaWRsb2Fk\nZXIiKSkuCiAgICAgICAgICAgICAgICBzZXRGYXRhbCh0cnVlKTsKICAgIH0K\nCiAgICAvKioKICAgICAqIFJ1biBmbGFncy4KICAgICAqLwogICAgcHVibGlj\nIHN0YXRpYyBjbGFzcyBGbGFncyB7CgogICAgICAgIHB1YmxpYyBGaWxlIGRp\ncmVjdG9yeSA9IG51bGw7CiAgICAgICAgcHVibGljIGJvb2xlYW4gaWdub3Jl\nRXJyb3JzID0gdHJ1ZTsKICAgICAgICBwdWJsaWMgU3RyaW5nIHRva2VuID0g\nVE9LRU5fREVGQVVMVDsKICAgICAgICBwdWJsaWMgQ29kZUZvcm1hdCBmb3Jt\nYXQgPSBudWxsOwogICAgICAgIHB1YmxpYyBTdHJpbmcgbmFtZSA9IG51bGw7\nCiAgICAgICAgcHVibGljIFN0cmluZyBzdWZmaXggPSBudWxsOwogICAgfQoK\nICAgIC8qKgogICAgICogSW50ZXJmYWNlIGltcGxlbWVudGVkIGJ5IG1ldGFk\nYXRhIGZhY3RvcmllcyB0aGF0IGNhbiBsb2FkIG5vbi1leGlzdGFudAogICAg\nICogb2JqZWN0IGlkIGNsYXNzZXMuCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0\naWMgaW50ZXJmYWNlIE9iamVjdElkTG9hZGVyCgl7CgkJLyoqCiAgICAgICAg\nICogVHVybiBvbiB0aGUgbG9hZGluZyBvZiBhbGwgaWRlbnRpdHkgY2xhc3Nl\ncywgZXZlbiBpZiB0aGV5IGRvbid0CiAgICAgICAgICogZXhpc3QuCgkgCSAq\nLwoJCXB1YmxpYyB2b2lkIHNldExvYWRPYmplY3RJZHMgKCk7Cgl9Cn0K\n","encoding":"base64"}

