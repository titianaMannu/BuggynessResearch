{"sha":"bf696e944c7d717a9f8b5a864cd40b4f19a56c49","node_id":"MDQ6QmxvYjIwNjM2NDpiZjY5NmU5NDRjN2Q3MTdhOWY4YjVhODY0Y2Q0MGI0ZjE5YTU2YzQ5","size":29588,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/bf696e944c7d717a9f8b5a864cd40b4f19a56c49","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsOwoKaW1wb3J0IGph\ndmEuaW8uT2JqZWN0U3RyZWFtRXhjZXB0aW9uOwppbXBvcnQgamF2YS51dGls\nLkFycmF5TGlzdDsKaW1wb3J0IGphdmEudXRpbC5Db2xsZWN0aW9uOwppbXBv\ncnQgamF2YS51dGlsLkNvbGxlY3Rpb25zOwppbXBvcnQgamF2YS51dGlsLkhh\nc2hNYXA7CmltcG9ydCBqYXZhLnV0aWwuSXRlcmF0b3I7CmltcG9ydCBqYXZh\nLnV0aWwuTGlua2VkTGlzdDsKaW1wb3J0IGphdmEudXRpbC5MaXN0OwppbXBv\ncnQgamF2YS51dGlsLk1hcDsKaW1wb3J0IGphdmEudXRpbC5TZXQ7CmltcG9y\ndCBqYXZhLnV0aWwuY29uY3VycmVudC5Db25jdXJyZW50SGFzaE1hcDsKaW1w\nb3J0IGphdmEudXRpbC5jb25jdXJyZW50LmxvY2tzLlJlZW50cmFudExvY2s7\nCgppbXBvcnQgamF2YXgudHJhbnNhY3Rpb24uU3RhdHVzOwppbXBvcnQgamF2\nYXgudHJhbnNhY3Rpb24uU3luY2hyb25pemF0aW9uOwppbXBvcnQgamF2YXgu\ndHJhbnNhY3Rpb24uVHJhbnNhY3Rpb247CmltcG9ydCBqYXZheC50cmFuc2Fj\ndGlvbi5UcmFuc2FjdGlvbk1hbmFnZXI7CgppbXBvcnQgb3JnLmFwYWNoZS5j\nb21tb25zLmNvbGxlY3Rpb25zLnNldC5NYXBCYWNrZWRTZXQ7CmltcG9ydCBv\ncmcuYXBhY2hlLmNvbW1vbnMubGFuZy5TdHJpbmdVdGlsczsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5jb25mLkJyb2tlclZhbHVlOwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLmNvbmYuTWV0YURhdGFSZXBvc2l0b3J5VmFsdWU7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuY29uZi5PcGVuSlBBQ29uZmln\ndXJhdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5jb25mLk9wZW5K\nUEFDb25maWd1cmF0aW9uSW1wbDsKaW1wb3J0IG9yZy5hcGFjaGUub3Blbmpw\nYS5jb25mLk9wZW5KUEFWZXJzaW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLmRhdGFjYWNoZS5EYXRhQ2FjaGVTdG9yZU1hbmFnZXI7CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEuZWUuTWFuYWdlZFJ1bnRpbWU7CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEuZW5oYW5jZS5NYW5hZ2VkQ2xhc3NTdWJjbGFz\nc2VyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmVuaGFuY2UuUENSZWdp\nc3RyeTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5lbmhhbmNlLlBlcnNp\nc3RlbmNlQ2FwYWJsZTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5ldmVu\ndC5Ccm9rZXJGYWN0b3J5RXZlbnQ7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEuZXZlbnQuUmVtb3RlQ29tbWl0RXZlbnRNYW5hZ2VyOwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLmxpYi5jb25mLkNvbmZpZ3VyYXRpb247CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLmNvbmYuQ29uZmlndXJhdGlvbnM7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLmxvZy5Mb2c7CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuSjJEb1ByaXZIZWxwZXI7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuTG9jYWxpemVy\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51dGlsLmNvbmN1cnJl\nbnQuQ29uY3VycmVudFJlZmVyZW5jZUhhc2hTZXQ7CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEubWV0YS5NZXRhRGF0YU1vZGVzOwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLm1ldGEuTWV0YURhdGFSZXBvc2l0b3J5OwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuR2VuZXJhbEV4Y2VwdGlvbjsKaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLkludmFsaWRTdGF0ZUV4Y2Vw\ndGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLk1ldGFEYXRh\nRXhjZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuT3Bl\nbkpQQUV4Y2VwdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGls\nLlVzZXJFeGNlcHRpb247CgovKioKICogQWJzdHJhY3QgaW1wbGVtZW50YXRp\nb24gb2YgdGhlIHtAbGluayBCcm9rZXJGYWN0b3J5fQogKiB0aGF0IG11c3Qg\nYmUgc3ViY2xhc3NlZCBmb3IgYSBzcGVjaWZpYyBydW50aW1lLgogKgogKiBA\nYXV0aG9yIEFiZSBXaGl0ZQogKi8KQFN1cHByZXNzV2FybmluZ3MoInNlcmlh\nbCIpCnB1YmxpYyBhYnN0cmFjdCBjbGFzcyBBYnN0cmFjdEJyb2tlckZhY3Rv\ncnkKICAgIGltcGxlbWVudHMgQnJva2VyRmFjdG9yeSB7CgogICAgcHJpdmF0\nZSBzdGF0aWMgZmluYWwgTG9jYWxpemVyIF9sb2MgPSBMb2NhbGl6ZXIuZm9y\nUGFja2FnZShBYnN0cmFjdEJyb2tlckZhY3RvcnkuY2xhc3MpOwoKICAgIC8v\nIHN0YXRpYyBtYXBwaW5nIG9mIGNvbmZpZ3VyYXRpb25zIHRvIHBvb2xlZCBi\ncm9rZXIgZmFjdG9yaWVzCiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBNYXA8\nT2JqZWN0LEFic3RyYWN0QnJva2VyRmFjdG9yeT4gX3Bvb2wgPSAKICAgICAg\nIENvbGxlY3Rpb25zLnN5bmNocm9uaXplZE1hcChuZXcgSGFzaE1hcDxPYmpl\nY3QsQWJzdHJhY3RCcm9rZXJGYWN0b3J5PigpKTsKCiAgICAvLyBjb25maWd1\ncmF0aW9uCiAgICBwcml2YXRlIGZpbmFsIE9wZW5KUEFDb25maWd1cmF0aW9u\nIF9jb25mOwogICAgcHJpdmF0ZSB0cmFuc2llbnQgYm9vbGVhbiBfcmVhZE9u\nbHkgPSBmYWxzZTsKICAgIHByaXZhdGUgdHJhbnNpZW50IGJvb2xlYW4gX2Ns\nb3NlZCA9IGZhbHNlOwogICAgcHJpdmF0ZSB0cmFuc2llbnQgUnVudGltZUV4\nY2VwdGlvbiBfY2xvc2VkRXhjZXB0aW9uID0gbnVsbDsKICAgIHByaXZhdGUg\nTWFwPE9iamVjdCxPYmplY3Q+IF91c2VyT2JqZWN0cyA9IG51bGw7CgogICAg\nLy8gaW50ZXJuYWwgbG9jazogc3BlYyBmb3JiaWRzIHN5bmNocm9uaXphdGlv\nbiBvbiB0aGlzIG9iamVjdAogICAgcHJpdmF0ZSBmaW5hbCBSZWVudHJhbnRM\nb2NrIF9sb2NrID0gbmV3IFJlZW50cmFudExvY2soKTsKCiAgICAvLyBtYXBz\nIGdsb2JhbCB0cmFuc2FjdGlvbnMgdG8gYXNzb2NpYXRlZCBicm9rZXJzCiAg\nICBwcml2YXRlIHRyYW5zaWVudCBDb25jdXJyZW50SGFzaE1hcDxPYmplY3Qs\nQ29sbGVjdGlvbjxCcm9rZXI+PiAKICAgICAgICBfdHJhbnNhY3Rpb25hbCA9\nIG5ldyBDb25jdXJyZW50SGFzaE1hcDxPYmplY3QsQ29sbGVjdGlvbjxCcm9r\nZXI+PigpOwoKICAgIC8vIHdlYWstcmVmIHRyYWNraW5nIG9mIG9wZW4gYnJv\na2VycwogICAgcHJpdmF0ZSB0cmFuc2llbnQgU2V0PEJyb2tlcj4gX2Jyb2tl\ncnM7CgogICAgLy8gY2FjaGUgdGhlIGNsYXNzIG5hbWVzIGxvYWRlZCBmcm9t\nIHRoZSBwZXJzaXN0ZW50IGNsYXNzZXMgcHJvcGVydHkgc28KICAgIC8vIHRo\nYXQgd2UgY2FuIHJlLWxvYWQgdGhlbSBmb3IgZWFjaCBuZXcgYnJva2VyCiAg\nICBwcml2YXRlIHRyYW5zaWVudCBDb2xsZWN0aW9uPFN0cmluZz4gX3BjQ2xh\nc3NOYW1lcyA9IG51bGw7CiAgICBwcml2YXRlIHRyYW5zaWVudCBDb2xsZWN0\naW9uPENsYXNzTG9hZGVyPiBfcGNDbGFzc0xvYWRlcnMgPSBudWxsOwogICAg\ncHJpdmF0ZSB0cmFuc2llbnQgYm9vbGVhbiBfcGVyc2lzdGVudFR5cGVzTG9h\nZGVkID0gZmFsc2U7CgogICAgLy8gbGlmZWN5Y2xlIGxpc3RlbmVycyB0byBw\nYXNzIHRvIGVhY2ggYnJva2VyCiAgICBwcml2YXRlIHRyYW5zaWVudCBNYXA8\nT2JqZWN0LCBDbGFzczw/PltdPiBfbGlmZWN5Y2xlTGlzdGVuZXJzID0gbnVs\nbDsKCiAgICAvLyB0cmFuc2FjdGlvbiBsaXN0ZW5lcnMgdG8gcGFzcyB0byBl\nYWNoIGJyb2tlcgogICAgcHJpdmF0ZSB0cmFuc2llbnQgTGlzdDxPYmplY3Q+\nIF90cmFuc2FjdGlvbkxpc3RlbmVycyA9IG51bGw7CgogICAgLy8ga2V5IHVu\nZGVyIHdoaWNoIHRoaXMgaW5zdGFuY2UgY2FuIGJlIHN0b3JlZCBpbiB0aGUg\nYnJva2VyIHBvb2wKICAgIC8vIGFuZCBsYXRlciBpZGVudGlmaWVkCiAgICBw\ncml2YXRlIE9iamVjdCBfcG9vbEtleTsgICAKICAgIAogICAgLyoqCiAgICAg\nKiBSZXR1cm4gYW4gaW50ZXJuYWwgZmFjdG9yeSBwb29sIGtleSBmb3IgdGhl\nIGdpdmVuIGNvbmZpZ3VyYXRpb24uCiAgICAgKgogICAgICogQHNpbmNlIDEu\nMS4wCiAgICAgKi8KICAgIHByb3RlY3RlZCBzdGF0aWMgT2JqZWN0IHRvUG9v\nbEtleShNYXA8U3RyaW5nLE9iamVjdD4gbWFwKSB7CiAgICAgICAgT2JqZWN0\nIGtleSA9IENvbmZpZ3VyYXRpb25zLmdldFByb3BlcnR5KCJJZCIsIG1hcCk7\nCiAgICAgICAgcmV0dXJuICgga2V5ICE9IG51bGwpID8ga2V5IDogbWFwOwog\nICAgfQoKICAgIC8qKgogICAgICogUmVnaXN0ZXIgPGNvZGU+ZmFjdG9yeTwv\nY29kZT4gaW4gdGhlIHBvb2wgdW5kZXIgPGNvZGU+a2V5PC9jb2RlPi4KICAg\nICAqCiAgICAgKiBAc2luY2UgMS4xLjAKICAgICAqLwogICAgcHJvdGVjdGVk\nIHN0YXRpYyB2b2lkIHBvb2woT2JqZWN0IGtleSwgQWJzdHJhY3RCcm9rZXJG\nYWN0b3J5IGZhY3RvcnkpIHsKICAgICAgICBzeW5jaHJvbml6ZWQoX3Bvb2wp\nIHsKICAgICAgICAgICAgX3Bvb2wucHV0KGtleSwgZmFjdG9yeSk7CiAgICAg\nICAgICAgIGZhY3Rvcnkuc2V0UG9vbEtleShrZXkpOwogICAgICAgICAgICBm\nYWN0b3J5Lm1ha2VSZWFkT25seSgpOwogICAgICAgIH0KICAgIH0KCiAgICAv\nKioKICAgICAqIFJldHVybiB0aGUgcG9vbGVkIGZhY3RvcnkgbWF0Y2hpbmcg\ndGhlIGdpdmVuIGtleSwgb3IgbnVsbAogICAgICogaWYgbm9uZS4gVGhlIGtl\neSBtdXN0IGJlIG9mIHRoZSBmb3JtIGNyZWF0ZWQgYnkge0BsaW5rICNnZXRQ\nb29sS2V5fS4KICAgICAqLwogICAgcHVibGljIHN0YXRpYyBBYnN0cmFjdEJy\nb2tlckZhY3RvcnkgZ2V0UG9vbGVkRmFjdG9yeUZvcktleShPYmplY3Qga2V5\nKSB7CiAgICAgICAgcmV0dXJuIChBYnN0cmFjdEJyb2tlckZhY3RvcnkpIF9w\nb29sLmdldChrZXkpOwogICAgfQoKICAgIC8qKgogICAgICogQ29uc3RydWN0\nb3IuIENvbmZpZ3VyYXRpb24gbXVzdCBiZSBwcm92aWRlZCBvbiBjb25zdHJ1\nY3Rpb24uCiAgICAgKi8KICAgIHByb3RlY3RlZCBBYnN0cmFjdEJyb2tlckZh\nY3RvcnkoT3BlbkpQQUNvbmZpZ3VyYXRpb24gY29uZmlnKSB7CiAgICAgICAg\nX2NvbmYgPSBjb25maWc7CiAgICAgICAgX2Jyb2tlcnMgPSBuZXdCcm9rZXJT\nZXQoKTsKICAgICAgICBnZXRQY0NsYXNzTG9hZGVycygpOwogICAgICAgIGlm\nIChjb25maWcuaXNJbml0aWFsaXplRWFnZXJseSgpKSB7CiAgICAgICAgICAg\nIG5ld0Jyb2tlcihfY29uZi5nZXRDb25uZWN0aW9uVXNlck5hbWUoKSwgCiAg\nICAgICAgICAgIAlfY29uZi5nZXRDb25uZWN0aW9uUGFzc3dvcmQoKSwgCiAg\nICAgICAgICAgIAlfY29uZi5pc0Nvbm5lY3Rpb25GYWN0b3J5TW9kZU1hbmFn\nZWQoKSwKICAgICAgICAgICAgICAgIF9jb25mLmdldENvbm5lY3Rpb25SZXRh\naW5Nb2RlQ29uc3RhbnQoKSwgZmFsc2UpLmNsb3NlKCk7IAogICAgICAgIH0K\nICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgY29uZmlndXJhdGlv\nbiBmb3IgdGhpcyBmYWN0b3J5LgogICAgICovCiAgICBwdWJsaWMgT3BlbkpQ\nQUNvbmZpZ3VyYXRpb24gZ2V0Q29uZmlndXJhdGlvbigpIHsKICAgICAgICBy\nZXR1cm4gX2NvbmY7CiAgICB9CgogICAgcHVibGljIEJyb2tlciBuZXdCcm9r\nZXIoKSB7CiAgICAgICAgcmV0dXJuIG5ld0Jyb2tlcihfY29uZi5nZXRDb25u\nZWN0aW9uVXNlck5hbWUoKSwgX2NvbmYuZ2V0Q29ubmVjdGlvblBhc3N3b3Jk\nKCkpOwogICAgfQoKICAgIHB1YmxpYyBCcm9rZXIgbmV3QnJva2VyKFN0cmlu\nZyB1c2VyLCBTdHJpbmcgcGFzcykgewogICAgICAgIHJldHVybiBuZXdCcm9r\nZXIodXNlciwgcGFzcywgX2NvbmYuaXNUcmFuc2FjdGlvbk1vZGVNYW5hZ2Vk\nKCksIF9jb25mLmdldENvbm5lY3Rpb25SZXRhaW5Nb2RlQ29uc3RhbnQoKSk7\nCiAgICB9CgogICAgcHVibGljIEJyb2tlciBuZXdCcm9rZXIoYm9vbGVhbiBt\nYW5hZ2VkLCBpbnQgY29ublJldGFpbk1vZGUpIHsKICAgICAgICByZXR1cm4g\nbmV3QnJva2VyKF9jb25mLmdldENvbm5lY3Rpb25Vc2VyTmFtZSgpLCBfY29u\nZi5nZXRDb25uZWN0aW9uUGFzc3dvcmQoKSwgbWFuYWdlZCwgY29ublJldGFp\nbk1vZGUpOwogICAgfQoKICAgIHB1YmxpYyBCcm9rZXIgbmV3QnJva2VyKFN0\ncmluZyB1c2VyLCBTdHJpbmcgcGFzcywgYm9vbGVhbiBtYW5hZ2VkLCBpbnQg\nY29ublJldGFpbk1vZGUpIHsKICAgICAgICByZXR1cm4gbmV3QnJva2VyKHVz\nZXIsIHBhc3MsIG1hbmFnZWQsIGNvbm5SZXRhaW5Nb2RlLCB0cnVlKTsKICAg\nIH0KICAgIAogICAgcHVibGljIEJyb2tlciBuZXdCcm9rZXIoU3RyaW5nIHVz\nZXIsIFN0cmluZyBwYXNzLCBib29sZWFuIG1hbmFnZWQsIGludCBjb25uUmV0\nYWluTW9kZSwgYm9vbGVhbiBmaW5kRXhpc3RpbmcpIHsKICAgICAgICB0cnkg\newogICAgICAgICAgICBhc3NlcnRPcGVuKCk7CiAgICAgICAgICAgIG1ha2VS\nZWFkT25seSgpOwoKICAgICAgICAgICAgQnJva2VyIGJyb2tlciA9IG51bGw7\nCiAgICAgICAgICAgIGlmIChmaW5kRXhpc3RpbmcpCiAgICAgICAgICAgICAg\nICBicm9rZXIgPSBmaW5kQnJva2VyKHVzZXIsIHBhc3MsIG1hbmFnZWQpOwog\nICAgICAgICAgICBpZiAoYnJva2VyID09IG51bGwpIHsKICAgICAgICAgICAg\nICAgIGJyb2tlciA9IG5ld0Jyb2tlckltcGwodXNlciwgcGFzcyk7CiAgICAg\nICAgICAgICAgICBpbml0aWFsaXplQnJva2VyKG1hbmFnZWQsIGNvbm5SZXRh\naW5Nb2RlLCBicm9rZXIsIGZhbHNlKTsKICAgICAgICAgICAgfQogICAgICAg\nICAgICByZXR1cm4gYnJva2VyOwogICAgICAgIH0gY2F0Y2ggKE9wZW5KUEFF\neGNlcHRpb24ga2UpIHsKICAgICAgICAgICAgdGhyb3cga2U7CiAgICAgICAg\nfSBjYXRjaCAoUnVudGltZUV4Y2VwdGlvbiByZSkgewogICAgICAgICAgICB0\naHJvdyBuZXcgR2VuZXJhbEV4Y2VwdGlvbihyZSk7CiAgICAgICAgfQogICAg\nfQoKICAgIHZvaWQgaW5pdGlhbGl6ZUJyb2tlcihib29sZWFuIG1hbmFnZWQs\nIGludCBjb25uUmV0YWluTW9kZSwgQnJva2VyIGJyb2tlciwgYm9vbGVhbiBm\ncm9tRGVzZXJpYWxpemF0aW9uKSB7CiAgICAgICAgYXNzZXJ0T3BlbigpOwog\nICAgICAgIG1ha2VSZWFkT25seSgpOwogICAgICAgIAogICAgICAgIERlbGVn\nYXRpbmdTdG9yZU1hbmFnZXIgZHNtID0gY3JlYXRlRGVsZWdhdGluZ1N0b3Jl\nTWFuYWdlcigpOwoKICAgICAgICAoKEJyb2tlckltcGwpIGJyb2tlcikuaW5p\ndGlhbGl6ZSh0aGlzLCBkc20sIG1hbmFnZWQsIGNvbm5SZXRhaW5Nb2RlLCBm\ncm9tRGVzZXJpYWxpemF0aW9uKTsKICAgICAgICBpZiAoIWZyb21EZXNlcmlh\nbGl6YXRpb24pCiAgICAgICAgICAgIGFkZExpc3RlbmVycyhicm9rZXIpOwoK\nICAgICAgICAvLyBpZiB3ZSdyZSB1c2luZyByZW1vdGUgZXZlbnRzLCByZWdp\nc3RlciB0aGUgZXZlbnQgbWFuYWdlciBzbwogICAgICAgIC8vIHRoYXQgaXQg\nY2FuIGJyb2FkY2FzdCBjb21taXQgbm90aWZpY2F0aW9ucyBmcm9tIHRoZSBi\ncm9rZXIKICAgICAgICBSZW1vdGVDb21taXRFdmVudE1hbmFnZXIgcmVtb3Rl\nID0gX2NvbmYuZ2V0UmVtb3RlQ29tbWl0RXZlbnRNYW5hZ2VyKCk7CiAgICAg\nICAgaWYgKHJlbW90ZS5hcmVSZW1vdGVFdmVudHNFbmFibGVkKCkpCiAgICAg\nICAgICAgIGJyb2tlci5hZGRUcmFuc2FjdGlvbkxpc3RlbmVyKHJlbW90ZSk7\nCgogICAgICAgIGxvYWRQZXJzaXN0ZW50VHlwZXMoYnJva2VyLmdldENsYXNz\nTG9hZGVyKCkpOwogICAgICAgIF9icm9rZXJzLmFkZChicm9rZXIpOwogICAg\nICAgIF9jb25mLnNldFJlYWRPbmx5KENvbmZpZ3VyYXRpb24uSU5JVF9TVEFU\nRV9GUk9aRU4pOwogICAgfQoKICAgIC8qKgogICAgICogQWRkIGZhY3Rvcnkt\ncmVnaXN0ZXJlZCBsaWZlY3ljbGUgbGlzdGVuZXJzIHRvIHRoZSBicm9rZXIu\nCiAgICAgKi8KICAgIHByb3RlY3RlZCB2b2lkIGFkZExpc3RlbmVycyhCcm9r\nZXIgYnJva2VyKSB7CiAgICAgICAgaWYgKF9saWZlY3ljbGVMaXN0ZW5lcnMg\nIT0gbnVsbCAmJiAhX2xpZmVjeWNsZUxpc3RlbmVycy5pc0VtcHR5KCkpIHsK\nICAgICAgICAgICAgZm9yIChNYXAuRW50cnk8T2JqZWN0LENsYXNzPD8+W10+\nIGVudHJ5IDogX2xpZmVjeWNsZUxpc3RlbmVycy5lbnRyeVNldCgpKSB7CiAg\nICAgICAgICAgICAgICBicm9rZXIuYWRkTGlmZWN5Y2xlTGlzdGVuZXIoZW50\ncnkuZ2V0S2V5KCksIGVudHJ5LmdldFZhbHVlKCkpOwogICAgICAgICAgICB9\nCiAgICAgICAgfQoKICAgICAgICBpZiAoX3RyYW5zYWN0aW9uTGlzdGVuZXJz\nICE9IG51bGwgJiYgIV90cmFuc2FjdGlvbkxpc3RlbmVycy5pc0VtcHR5KCkp\nIHsKICAgICAgICAgICAgZm9yIChJdGVyYXRvcjxPYmplY3Q+IGl0ciA9IF90\ncmFuc2FjdGlvbkxpc3RlbmVycy5pdGVyYXRvcigpOwogICAgICAgICAgICAg\nICAgaXRyLmhhc05leHQoKTsgKSB7CiAgICAgICAgICAgICAgICBicm9rZXIu\nYWRkVHJhbnNhY3Rpb25MaXN0ZW5lcihpdHIubmV4dCgpKTsKICAgICAgICAg\nICAgfQogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIExvYWQgdGhl\nIGNvbmZpZ3VyZWQgcGVyc2lzdGVudCBjbGFzc2VzIGxpc3QuIFBlcmZvcm1l\nZCBhdXRvbWF0aWNhbGx5CiAgICAgKiB3aGVuZXZlciBhIGJyb2tlciBpcyBj\ncmVhdGVkLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBsb2FkUGVyc2lzdGVu\ndFR5cGVzKENsYXNzTG9hZGVyIGVudkxvYWRlcikgewogICAgICAgIC8vIGlm\nIHdlJ3ZlIGxvYWRlZCB0aGUgcGVyc2lzdGVudCB0eXBlcyBhbmQgdGhlIGNs\nYXNzIG5hbWUgbGlzdAogICAgICAgIC8vIGlzIGVtcHR5LCB0aGVuIHdlIGNh\nbiBzaW1wbHkgcmV0dXJuLiBOb3RlIHRoYXQgdGhlcmUgaXMgYQogICAgICAg\nIC8vIHBvdGVudGlhbCB0aHJlYWRpbmcgc2NlbmFyaW8gaW4gd2hpY2ggX3Bl\ncnNpc3RlbnRUeXBlc0xvYWRlZCBpcwogICAgICAgIC8vIGZhbHNlIHdoZW4g\ncmVhZCwgYnV0IHRoZSB3b3JrIHRvIHBvcHVsYXRlIF9wY0NsYXNzTmFtZXMg\naGFzCiAgICAgICAgLy8gYWxyZWFkeSBiZWVuIGRvbmUuIFRoaXMgaXMgb2s7\nIF9wY0NsYXNzTmFtZXMgY2FuIHRvbGVyYXRlCiAgICAgICAgLy8gY29uY3Vy\ncmVudCBhY2Nlc3MsIHNvIHRoZSB3b3JzdCBjYXNlIGlzIHRoYXQgdGhlIGxp\nc3QgaXMKICAgICAgICAvLyBwZXJzaXN0ZW50IHR5cGUgZGF0YSBpcyBwcm9j\nZXNzZWQgbXVsdGlwbGUgdGltZXMsIHdoaWNoIHRoaXMKICAgICAgICAvLyBh\nbGdvcml0aG0gdGFrZXMgaW50byBhY2NvdW50LgogICAgICAgIGlmIChfcGVy\nc2lzdGVudFR5cGVzTG9hZGVkICYmIF9wY0NsYXNzTmFtZXMuaXNFbXB0eSgp\nKQogICAgICAgICAgICByZXR1cm47CgogICAgICAgIC8vIGNhY2hlIHBlcnNp\nc3RlbnQgdHlwZSBuYW1lcyBpZiBub3QgYWxyZWFkeQogICAgICAgIENsYXNz\nTG9hZGVyIGxvYWRlciA9IF9jb25mLmdldENsYXNzUmVzb2x2ZXJJbnN0YW5j\nZSgpLgogICAgICAgICAgICBnZXRDbGFzc0xvYWRlcihnZXRDbGFzcygpLCBl\nbnZMb2FkZXIpOwogICAgICAgIENvbGxlY3Rpb248Q2xhc3M8Pz4+IHRvUmVk\nZWZpbmUgPSBuZXcgQXJyYXlMaXN0PENsYXNzPD8+PigpOwogICAgICAgIGlm\nICghX3BlcnNpc3RlbnRUeXBlc0xvYWRlZCkgewogICAgICAgICAgICBDb2xs\nZWN0aW9uPENsYXNzPD8+PiBjbHNzID0gX2NvbmYuZ2V0TWV0YURhdGFSZXBv\nc2l0b3J5SW5zdGFuY2UoKS4KICAgICAgICAgICAgICAgIGxvYWRQZXJzaXN0\nZW50VHlwZXMoZmFsc2UsIGxvYWRlciwgX2NvbmYuaXNJbml0aWFsaXplRWFn\nZXJseSgpKTsKICAgICAgICAgICAgaWYgKGNsc3MuaXNFbXB0eSgpKQogICAg\nICAgICAgICAgICAgX3BjQ2xhc3NOYW1lcyA9IENvbGxlY3Rpb25zLmVtcHR5\nTGlzdCgpOwogICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgIENv\nbGxlY3Rpb248U3RyaW5nPiBjID0gbmV3IEFycmF5TGlzdDxTdHJpbmc+KGNs\nc3Muc2l6ZSgpKTsKICAgICAgICAgICAgICAgIGZvciAoSXRlcmF0b3I8Q2xh\nc3M8Pz4+IGl0ciA9IGNsc3MuaXRlcmF0b3IoKTsgaXRyLmhhc05leHQoKTsp\nIHsKICAgICAgICAgICAgICAgICAgICBDbGFzczw/PiBjbHMgPSBpdHIubmV4\ndCgpOwogICAgICAgICAgICAgICAgICAgIGMuYWRkKGNscy5nZXROYW1lKCkp\nOwogICAgICAgICAgICAgICAgICAgIGlmIChuZWVkc1N1YihjbHMpKQogICAg\nICAgICAgICAgICAgICAgICAgICB0b1JlZGVmaW5lLmFkZChjbHMpOwogICAg\nICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZ2V0UGNDbGFzc0xvYWRl\ncnMoKS5hZGQobG9hZGVyKTsKICAgICAgICAgICAgICAgIF9wY0NsYXNzTmFt\nZXMgPSBjOwogICAgICAgICAgICB9CiAgICAgICAgICAgIF9wZXJzaXN0ZW50\nVHlwZXNMb2FkZWQgPSB0cnVlOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAg\nICAgIC8vIHJlbG9hZCB3aXRoIHRoaXMgbG9hZGVyCiAgICAgICAgICAgIGlm\nIChnZXRQY0NsYXNzTG9hZGVycygpLmFkZChsb2FkZXIpKSB7CiAgICAgICAg\nICAgICAgICBmb3IgKFN0cmluZyBjbHNOYW1lIDogX3BjQ2xhc3NOYW1lcykg\newogICAgICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAg\nICAgICAgIENsYXNzPD8+IGNscyA9IENsYXNzLmZvck5hbWUoY2xzTmFtZSwg\ndHJ1ZSwgbG9hZGVyKTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5l\nZWRzU3ViKGNscykpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b1Jl\nZGVmaW5lLmFkZChjbHMpOwogICAgICAgICAgICAgICAgICAgIH0gY2F0Y2gg\nKFRocm93YWJsZSB0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIF9jb25m\nLmdldExvZyhPcGVuSlBBQ29uZmlndXJhdGlvbi5MT0dfUlVOVElNRSkud2Fy\nbihudWxsLCB0KTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAg\nICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIC8vIGdl\ndCB0aGUgTWFuYWdlZENsYXNzU3ViY2xhc3NlciBpbnRvIHRoZSBsb29wCiAg\nICAgICAgTWFuYWdlZENsYXNzU3ViY2xhc3Nlci5wcmVwYXJlVW5lbmhhbmNl\nZENsYXNzZXMoX2NvbmYsIHRvUmVkZWZpbmUsIGVudkxvYWRlcik7CiAgICB9\nCgogICAgcHJpdmF0ZSBib29sZWFuIG5lZWRzU3ViKENsYXNzPD8+IGNscykg\newogICAgICAgIHJldHVybiAhY2xzLmlzSW50ZXJmYWNlKCkKICAgICAgICAg\nICAgJiYgIVBlcnNpc3RlbmNlQ2FwYWJsZS5jbGFzcy5pc0Fzc2lnbmFibGVG\ncm9tKGNscyk7CiAgICB9CgogICAgcHVibGljIHZvaWQgYWRkTGlmZWN5Y2xl\nTGlzdGVuZXIoT2JqZWN0IGxpc3RlbmVyLCBDbGFzczw/PltdIGNsYXNzZXMp\nIHsKICAgICAgICBsb2NrKCk7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAg\nYXNzZXJ0T3BlbigpOwogICAgICAgICAgICBpZiAoX2xpZmVjeWNsZUxpc3Rl\nbmVycyA9PSBudWxsKQogICAgICAgICAgICAgICAgX2xpZmVjeWNsZUxpc3Rl\nbmVycyA9IG5ldyBIYXNoTWFwPE9iamVjdCwgQ2xhc3M8Pz5bXT4oNyk7CiAg\nICAgICAgICAgIF9saWZlY3ljbGVMaXN0ZW5lcnMucHV0KGxpc3RlbmVyLCBj\nbGFzc2VzKTsKICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICB1bmxv\nY2soKTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGljIHZvaWQgcmVtb3Zl\nTGlmZWN5Y2xlTGlzdGVuZXIoT2JqZWN0IGxpc3RlbmVyKSB7CiAgICAgICAg\nbG9jaygpOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIGFzc2VydE9wZW4o\nKTsKICAgICAgICAgICAgaWYgKF9saWZlY3ljbGVMaXN0ZW5lcnMgIT0gbnVs\nbCkKICAgICAgICAgICAgICAgIF9saWZlY3ljbGVMaXN0ZW5lcnMucmVtb3Zl\nKGxpc3RlbmVyKTsKICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICB1\nbmxvY2soKTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGljIHZvaWQgYWRk\nVHJhbnNhY3Rpb25MaXN0ZW5lcihPYmplY3QgbGlzdGVuZXIpIHsKICAgICAg\nICBsb2NrKCk7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgYXNzZXJ0T3Bl\nbigpOwogICAgICAgICAgICBpZiAoX3RyYW5zYWN0aW9uTGlzdGVuZXJzID09\nIG51bGwpCiAgICAgICAgICAgICAgICBfdHJhbnNhY3Rpb25MaXN0ZW5lcnMg\nPSBuZXcgTGlua2VkTGlzdDxPYmplY3Q+KCk7CiAgICAgICAgICAgIF90cmFu\nc2FjdGlvbkxpc3RlbmVycy5hZGQobGlzdGVuZXIpOwogICAgICAgIH0gZmlu\nYWxseSB7CiAgICAgICAgICAgIHVubG9jaygpOwogICAgICAgIH0KICAgIH0K\nCiAgICBwdWJsaWMgdm9pZCByZW1vdmVUcmFuc2FjdGlvbkxpc3RlbmVyKE9i\namVjdCBsaXN0ZW5lcikgewogICAgICAgIGxvY2soKTsKICAgICAgICB0cnkg\newogICAgICAgICAgICBhc3NlcnRPcGVuKCk7CiAgICAgICAgICAgIGlmIChf\ndHJhbnNhY3Rpb25MaXN0ZW5lcnMgIT0gbnVsbCkKICAgICAgICAgICAgICAg\nIF90cmFuc2FjdGlvbkxpc3RlbmVycy5yZW1vdmUobGlzdGVuZXIpOwogICAg\nICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgIHVubG9jaygpOwogICAgICAg\nIH0KICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybnMgdHJ1ZSBpZiB0aGlz\nIGJyb2tlciBmYWN0b3J5IGlzIGNsb3NlZC4KICAgICAqLwogICAgcHVibGlj\nIGJvb2xlYW4gaXNDbG9zZWQoKSB7CiAgICAgICAgcmV0dXJuIF9jbG9zZWQ7\nCiAgICB9CgogICAgcHVibGljIHZvaWQgY2xvc2UoKSB7CiAgICAgICAgbG9j\naygpOwoKICAgICAgICB0cnkgewogICAgICAgICAgICBhc3NlcnRPcGVuKCk7\nCiAgICAgICAgICAgIGFzc2VydE5vQWN0aXZlVHJhbnNhY3Rpb24oKTsKCiAg\nICAgICAgICAgIC8vIHJlbW92ZSBmcm9tIGZhY3RvcnkgcG9vbAogICAgICAg\nICAgICBzeW5jaHJvbml6ZWQgKF9wb29sKSB7CiAgICAgICAgICAgICAgICBp\nZiAoX3Bvb2wuZ2V0KF9wb29sS2V5KSA9PSB0aGlzKQogICAgICAgICAgICAg\nICAgICAgIF9wb29sLnJlbW92ZShfcG9vbEtleSk7CiAgICAgICAgICAgIH0K\nCiAgICAgICAgICAgIC8vIGNsb3NlIGFsbCBicm9rZXJzCiAgICAgICAgICAg\nIGZvciAoQnJva2VyIGJyb2tlciA6IF9icm9rZXJzKSB7CiAgICAgICAgICAg\nICAgICAvLyBDaGVjayBmb3IgbnVsbCBiZWNhdXNlIF9icm9rZXJzIG1heSBj\nb250YWluIHdlYWsgcmVmZXJlbmNlcwogICAgICAgICAgICAgICAgaWYgKChi\ncm9rZXIgIT0gbnVsbCkgJiYgKCFicm9rZXIuaXNDbG9zZWQoKSkpCiAgICAg\nICAgICAgICAgICAgICAgYnJva2VyLmNsb3NlKCk7CiAgICAgICAgICAgIH0K\nCiAgICAgICAgICAgIGlmKF9jb25mLm1ldGFEYXRhUmVwb3NpdG9yeUF2YWls\nYWJsZSgpKSB7CiAgICAgICAgICAgICAgICAvLyByZW1vdmUgbWV0YWRhdGEg\ncmVwb3NpdG9yeSBmcm9tIGxpc3RlbmVyIGxpc3QKICAgICAgICAgICAgICAg\nIFBDUmVnaXN0cnkucmVtb3ZlUmVnaXN0ZXJDbGFzc0xpc3RlbmVyCiAgICAg\nICAgICAgICAgICAgICAgKF9jb25mLmdldE1ldGFEYXRhUmVwb3NpdG9yeUlu\nc3RhbmNlKCkpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBfY29uZi5j\nbG9zZSgpOwogICAgICAgICAgICBfY2xvc2VkID0gdHJ1ZTsKICAgICAgICAg\nICAgTG9nIGxvZyA9IF9jb25mLmdldExvZyhPcGVuSlBBQ29uZmlndXJhdGlv\nbi5MT0dfUlVOVElNRSk7CiAgICAgICAgICAgIGlmIChsb2cuaXNUcmFjZUVu\nYWJsZWQoKSkKICAgICAgICAgICAgICAgIF9jbG9zZWRFeGNlcHRpb24gPSBu\nZXcgSWxsZWdhbFN0YXRlRXhjZXB0aW9uKCk7CiAgICAgICAgfSBmaW5hbGx5\nIHsKICAgICAgICAgICAgdW5sb2NrKCk7CiAgICAgICAgfQogICAgfQoKICAg\nIC8qKgogICAgICogU3ViY2xhc3NlcyBzaG91bGQgb3ZlcnJpZGUgdGhpcyBt\nZXRob2QgdG8gYWRkIGEgPGNvZGU+UGxhdGZvcm08L2NvZGU+CiAgICAgKiBw\ncm9wZXJ0eSBsaXN0aW5nIHRoZSBydW50aW1lIHBsYXRmb3JtLCBzdWNoIGFz\nOgogICAgICogPGNvZGU+T3BlbkpQQSBKREJDIEVkaXRpb246IE9yYWNsZSBE\nYXRhYmFzZTwvY29kZT4KICAgICAqLwogICAgcHVibGljIE1hcDxTdHJpbmcs\nT2JqZWN0PiBnZXRQcm9wZXJ0aWVzKCkgewogICAgICAgIC8vIHJlcXVpcmVk\nIHByb3BzIGFyZSBWZW5kb3JOYW1lIGFuZCBWZXJzaW9uTnVtYmVyCiAgICAg\nICAgTWFwPFN0cmluZyxPYmplY3Q+IHByb3BzID0gX2NvbmYudG9Qcm9wZXJ0\naWVzKHRydWUpOwogICAgICAgIHByb3BzLnB1dCgiVmVuZG9yTmFtZSIsIE9w\nZW5KUEFWZXJzaW9uLlZFTkRPUl9OQU1FKTsKICAgICAgICBwcm9wcy5wdXQo\nIlZlcnNpb25OdW1iZXIiLCBPcGVuSlBBVmVyc2lvbi5WRVJTSU9OX05VTUJF\nUik7CiAgICAgICAgcHJvcHMucHV0KCJWZXJzaW9uSWQiLCBPcGVuSlBBVmVy\nc2lvbi5WRVJTSU9OX0lEKTsKICAgICAgICByZXR1cm4gcHJvcHM7CiAgICB9\nCgogICAgcHVibGljIFNldDxTdHJpbmc+IGdldFN1cHBvcnRlZFByb3BlcnRp\nZXMoKSB7CiAgICAgICAgcmV0dXJuIF9jb25mLmdldFByb3BlcnR5S2V5cygp\nOwogICAgfQoKICAgIHB1YmxpYyBPYmplY3QgZ2V0VXNlck9iamVjdChPYmpl\nY3Qga2V5KSB7CiAgICAgICAgbG9jaygpOwogICAgICAgIHRyeSB7CiAgICAg\nICAgICAgIGFzc2VydE9wZW4oKTsKICAgICAgICAgICAgcmV0dXJuIChfdXNl\nck9iamVjdHMgPT0gbnVsbCkgPyBudWxsIDogX3VzZXJPYmplY3RzLmdldChr\nZXkpOwogICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgIHVubG9jaygp\nOwogICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMgT2JqZWN0IHB1dFVzZXJP\nYmplY3QoT2JqZWN0IGtleSwgT2JqZWN0IHZhbCkgewogICAgICAgIGxvY2so\nKTsKICAgICAgICB0cnkgewogICAgICAgICAgICBhc3NlcnRPcGVuKCk7CiAg\nICAgICAgICAgIGlmICh2YWwgPT0gbnVsbCkKICAgICAgICAgICAgICAgIHJl\ndHVybiAoX3VzZXJPYmplY3RzID09IG51bGwpID8gbnVsbCA6IF91c2VyT2Jq\nZWN0cy5yZW1vdmUoa2V5KTsKCiAgICAgICAgICAgIGlmIChfdXNlck9iamVj\ndHMgPT0gbnVsbCkKICAgICAgICAgICAgICAgIF91c2VyT2JqZWN0cyA9IG5l\ndyBIYXNoTWFwPE9iamVjdCxPYmplY3Q+KCk7CiAgICAgICAgICAgIHJldHVy\nbiBfdXNlck9iamVjdHMucHV0KGtleSwgdmFsKTsKICAgICAgICB9IGZpbmFs\nbHkgewogICAgICAgICAgICB1bmxvY2soKTsKICAgICAgICB9CiAgICB9Cgog\nICAgcHVibGljIHZvaWQgbG9jaygpIHsKICAgICAgICBfbG9jay5sb2NrKCk7\nCiAgICB9CgogICAgcHVibGljIHZvaWQgdW5sb2NrKCkgewogICAgICAgIF9s\nb2NrLnVubG9jaygpOwogICAgfQoKICAgIC8qKgogICAgICogUmVwbGFjZXMg\ndGhlIGZhY3Rvcnkgd2l0aCB0aGlzIEpWTXMgcG9vbGVkIHZlcnNpb24gaWYg\naXQgZXhpc3RzLiBBbHNvCiAgICAgKiBmcmVlemVzIHRoZSBmYWN0b3J5Lgog\nICAgICovCiAgICBwcm90ZWN0ZWQgT2JqZWN0IHJlYWRSZXNvbHZlKCkKICAg\nICAgICB0aHJvd3MgT2JqZWN0U3RyZWFtRXhjZXB0aW9uIHsKICAgICAgICBB\nYnN0cmFjdEJyb2tlckZhY3RvcnkgZmFjdG9yeSA9IGdldFBvb2xlZEZhY3Rv\ncnlGb3JLZXkoX3Bvb2xLZXkpOwogICAgICAgIGlmIChmYWN0b3J5ICE9IG51\nbGwpCiAgICAgICAgICAgIHJldHVybiBmYWN0b3J5OwoKICAgICAgICAvLyBy\nZXNldCB0aGVzZSB0cmFuc2llbnQgZmllbGRzIHRvIGVtcHR5IHZhbHVlcwog\nICAgICAgIF90cmFuc2FjdGlvbmFsID0gbmV3IENvbmN1cnJlbnRIYXNoTWFw\nPE9iamVjdCxDb2xsZWN0aW9uPEJyb2tlcj4+KCk7CiAgICAgICAgX2Jyb2tl\ncnMgPSBuZXdCcm9rZXJTZXQoKTsKCiAgICAgICAgbWFrZVJlYWRPbmx5KCk7\nCiAgICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CgogICAgcHJpdmF0ZSBTZXQ8\nQnJva2VyPiBuZXdCcm9rZXJTZXQoKSB7CiAgICAgICAgQnJva2VyVmFsdWUg\nYnY7CiAgICAgICAgaWYgKF9jb25mIGluc3RhbmNlb2YgT3BlbkpQQUNvbmZp\nZ3VyYXRpb25JbXBsKQogICAgICAgICAgICBidiA9ICgoT3BlbkpQQUNvbmZp\nZ3VyYXRpb25JbXBsKSBfY29uZikuYnJva2VyUGx1Z2luOwogICAgICAgIGVs\nc2UKICAgICAgICAgICAgYnYgPSAoQnJva2VyVmFsdWUpIF9jb25mLmdldFZh\nbHVlKEJyb2tlclZhbHVlLktFWSk7CgogICAgICAgIGlmIChGaW5hbGl6aW5n\nQnJva2VySW1wbC5jbGFzcy5pc0Fzc2lnbmFibGVGcm9tKAogICAgICAgICAg\nICBidi5nZXRUZW1wbGF0ZUJyb2tlclR5cGUoX2NvbmYpKSkgewogICAgICAg\nICAgICByZXR1cm4gTWFwQmFja2VkU2V0LmRlY29yYXRlKG5ldyBDb25jdXJy\nZW50SGFzaE1hcCgpLCBuZXcgT2JqZWN0KCkgeyB9KTsKICAgICAgICB9IGVs\nc2UgewogICAgICAgICAgICByZXR1cm4gbmV3IENvbmN1cnJlbnRSZWZlcmVu\nY2VIYXNoU2V0PEJyb2tlcj4oQ29uY3VycmVudFJlZmVyZW5jZUhhc2hTZXQu\nV0VBSyk7CiAgICAgICAgfQogICAgfQoKICAgIC8vLy8vLy8vLy8vLy8vLy8v\nLy8vLy8vLwogICAgLy8gTWV0aG9kcyBmb3IgT3ZlcnJpZGUKICAgIC8vLy8v\nLy8vLy8vLy8vLy8vLy8vLy8vLwoKICAgIC8qKgogICAgICogUmV0dXJuIGEg\nbmV3IFN0b3JlTWFuYWdlciBmb3IgdGhpcyBydW50aW1lLiBOb3RlIHRoYXQg\ndGhlIGluc3RhbmNlCiAgICAgKiByZXR1cm5lZCBoZXJlIG1heSBiZSB3cmFw\ncGVkIGJlZm9yZSBiZWluZyBwYXNzZWQgdG8gdGhlCiAgICAgKiB7QGxpbmsg\nI25ld0Jyb2tlcn0gbWV0aG9kLgogICAgICovCiAgICBwcm90ZWN0ZWQgYWJz\ndHJhY3QgU3RvcmVNYW5hZ2VyIG5ld1N0b3JlTWFuYWdlcigpOwoKICAgIC8q\nKgogICAgICogRmluZCBhIHBvb2xlZCBicm9rZXIsIG9yIHJldHVybiBudWxs\nIGlmIG5vbmUuIElmIHVzaW5nCiAgICAgKiBtYW5hZ2VkIHRyYW5zYWN0aW9u\ncywgbG9va3MgZm9yIGEgdHJhbnNhY3Rpb25hbCBicm9rZXI7CiAgICAgKiBv\ndGhlcndpc2UgcmV0dXJucyBudWxsIGJ5IGRlZmF1bHQuIFRoaXMgbWV0aG9k\nIHdpbGwgYmUgY2FsbGVkIGJlZm9yZQogICAgICoge0BsaW5rICNuZXdTdG9y\nZU1hbmFnZXJ9IHNvIHRoYXQgZmFjdG9yeSBzdWJjbGFzc2VzIGltcGxlbWVu\ndGluZwogICAgICogcG9vbGluZyBjYW4gcmV0dXJuIGEgbWF0Y2hpbmcgbWFu\nYWdlciBiZWZvcmUgYSBuZXcge0BsaW5rIFN0b3JlTWFuYWdlcn0KICAgICAq\nIGlzIGNyZWF0ZWQuCiAgICAgKi8KICAgIHByb3RlY3RlZCBCcm9rZXIgZmlu\nZEJyb2tlcihTdHJpbmcgdXNlciwgU3RyaW5nIHBhc3MsIGJvb2xlYW4gbWFu\nYWdlZCkgewogICAgICAgIGlmIChtYW5hZ2VkKQogICAgICAgICAgICByZXR1\ncm4gZmluZFRyYW5zYWN0aW9uYWxCcm9rZXIodXNlciwgcGFzcyk7CiAgICAg\nICAgcmV0dXJuIG51bGw7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4g\nYSBicm9rZXIgY29uZmlndXJlZCB3aXRoIHRoZSBwcm9wZXIgc2V0dGluZ3Mu\nCiAgICAgKiBCeSBkZWZhdWx0LCB0aGlzIG1ldGhvZCBjb25zdHJ1Y3RzIGEg\nbmV3CiAgICAgKiBCcm9rZXJJbXBsIG9mIHRoZSBjbGFzcyBzZXQgZm9yIHRo\naXMgZmFjdG9yeS4KICAgICAqLwogICAgcHJvdGVjdGVkIEJyb2tlckltcGwg\nbmV3QnJva2VySW1wbChTdHJpbmcgdXNlciwgU3RyaW5nIHBhc3MpIHsKICAg\nICAgICBCcm9rZXJJbXBsIGJyb2tlciA9IF9jb25mLm5ld0Jyb2tlckluc3Rh\nbmNlKHVzZXIsIHBhc3MpOwogICAgICAgIGlmIChicm9rZXIgPT0gbnVsbCkK\nICAgICAgICAgICAgdGhyb3cgbmV3IFVzZXJFeGNlcHRpb24oX2xvYy5nZXQo\nIm5vLWJyb2tlci1jbGFzcyIsCiAgICAgICAgICAgICAgICBfY29uZi5nZXRC\ncm9rZXJJbXBsKCkpKTsKCiAgICAgICAgcmV0dXJuIGJyb2tlcjsKICAgIH0K\nCiAgICAvKioKICAgICAqIFNldHVwIHRyYW5zaWVudCBzdGF0ZSB1c2VkIGJ5\nIHRoaXMgZmFjdG9yeSBiYXNlZCBvbiB0aGUKICAgICAqIGN1cnJlbnQgY29u\nZmlndXJhdGlvbiwgd2hpY2ggd2lsbCBzdWJzZXF1ZW50bHkgYmUgbG9ja2Vk\nIGRvd24uIFRoaXMKICAgICAqIG1ldGhvZCB3aWxsIGJlIGNhbGxlZCBiZWZv\ncmUgdGhlIGZpcnN0IGJyb2tlciBpcyByZXF1ZXN0ZWQsCiAgICAgKiBhbmQg\nd2lsbCBiZSByZS1jYWxsZWQgZWFjaCB0aW1lIHRoZSBmYWN0b3J5IGlzIGRl\nc2VyaWFsaXplZCBpbnRvIGEgSlZNCiAgICAgKiB0aGF0IGhhcyBubyBjb25m\naWd1cmF0aW9uIGZvciB0aGlzIGRhdGEgc3RvcmUuCiAgICAgKi8KICAgIHBy\nb3RlY3RlZCB2b2lkIHNldHVwKCkgewogICAgfQoKICAgIC8vLy8vLy8vLy8v\nLy8KICAgIC8vIFV0aWxpdGllcwogICAgLy8vLy8vLy8vLy8vLwoKICAgIC8q\nKgogICAgICogRmluZCBhIG1hbmFnZWQgcnVudGltZSBicm9rZXIgYXNzb2Np\nYXRlZCB3aXRoIHRoZQogICAgICogY3VycmVudCB0cmFuc2FjdGlvbiwgb3Ig\ncmV0dXJucyBudWxsIGlmIG5vbmUuCiAgICAgKi8KICAgIHByb3RlY3RlZCBC\ncm9rZXIgZmluZFRyYW5zYWN0aW9uYWxCcm9rZXIoU3RyaW5nIHVzZXIsIFN0\ncmluZyBwYXNzKSB7CiAgICAgICAgVHJhbnNhY3Rpb24gdHJhbnM7CiAgICAg\nICAgTWFuYWdlZFJ1bnRpbWUgbXIgPSBfY29uZi5nZXRNYW5hZ2VkUnVudGlt\nZUluc3RhbmNlKCk7CiAgICAgICAgT2JqZWN0IHR4S2V5OwogICAgICAgIHRy\neSB7CiAgICAgICAgICAgIHRyYW5zID0gbXIuZ2V0VHJhbnNhY3Rpb25NYW5h\nZ2VyKCkuCiAgICAgICAgICAgICAgICBnZXRUcmFuc2FjdGlvbigpOwogICAg\nICAgICAgICB0eEtleSA9IG1yLmdldFRyYW5zYWN0aW9uS2V5KCk7CgogICAg\nICAgICAgICBpZiAodHJhbnMgPT0gbnVsbAogICAgICAgICAgICAgICAgfHwg\ndHJhbnMuZ2V0U3RhdHVzKCkgPT0gU3RhdHVzLlNUQVRVU19OT19UUkFOU0FD\nVElPTgogICAgICAgICAgICAgICAgfHwgdHJhbnMuZ2V0U3RhdHVzKCkgPT0g\nU3RhdHVzLlNUQVRVU19VTktOT1dOKQogICAgICAgICAgICAgICAgcmV0dXJu\nIG51bGw7CiAgICAgICAgfSBjYXRjaCAoT3BlbkpQQUV4Y2VwdGlvbiBrZSkg\newogICAgICAgICAgICB0aHJvdyBrZTsKICAgICAgICB9IGNhdGNoIChFeGNl\ncHRpb24gZSkgewogICAgICAgICAgICB0aHJvdyBuZXcgR2VuZXJhbEV4Y2Vw\ndGlvbihlKTsKICAgICAgICB9CgogICAgICAgIENvbGxlY3Rpb248QnJva2Vy\nPiBicm9rZXJzID0gX3RyYW5zYWN0aW9uYWwuZ2V0KHR4S2V5KTsKICAgICAg\nICBpZiAoYnJva2VycyAhPSBudWxsKSB7CiAgICAgICAgICAgIC8vIHdlIGRv\nbid0IG5lZWQgdG8gc3luY2hyb25pemUgb24gYnJva2VycyBzaW5jZSBvbmUg\nSlRBIHRyYW5zYWN0aW9uCiAgICAgICAgICAgIC8vIGNhbiBuZXZlciBiZSBh\nY3RpdmUgb24gbXVsdGlwbGUgY29uY3VycmVudCB0aHJlYWRzLgogICAgICAg\nICAgICBmb3IgKEJyb2tlciBicm9rZXIgOiBicm9rZXJzKSB7CiAgICAgICAg\nICAgICAgICBpZiAoU3RyaW5nVXRpbHMuZXF1YWxzKGJyb2tlci5nZXRDb25u\nZWN0aW9uVXNlck5hbWUoKSwgdXNlcikgCiAgICAgICAgICAgICAgICAgJiYg\nU3RyaW5nVXRpbHMuZXF1YWxzKGJyb2tlci5nZXRDb25uZWN0aW9uUGFzc3dv\ncmQoKSwgcGFzcykpCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGJyb2tl\ncjsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4gbnVs\nbDsKICAgIH0KCiAgICAvKioKICAgICAqIENvbmZpZ3VyZXMgdGhlIGdpdmVu\nIGJyb2tlciB3aXRoIHRoZSBjdXJyZW50IGZhY3Rvcnkgb3B0aW9uIHNldHRp\nbmdzLgogICAgICovCiAgICBwcm90ZWN0ZWQgdm9pZCBjb25maWd1cmVCcm9r\nZXIoQnJva2VySW1wbCBicm9rZXIpIHsKICAgICAgICBicm9rZXIuc2V0T3B0\naW1pc3RpYyhfY29uZi5nZXRPcHRpbWlzdGljKCkpOwogICAgICAgIGJyb2tl\nci5zZXROb250cmFuc2FjdGlvbmFsUmVhZChfY29uZi5nZXROb250cmFuc2Fj\ndGlvbmFsUmVhZCgpKTsKICAgICAgICBicm9rZXIuc2V0Tm9udHJhbnNhY3Rp\nb25hbFdyaXRlKF9jb25mLmdldE5vbnRyYW5zYWN0aW9uYWxXcml0ZSgpKTsK\nICAgICAgICBicm9rZXIuc2V0UmV0YWluU3RhdGUoX2NvbmYuZ2V0UmV0YWlu\nU3RhdGUoKSk7CiAgICAgICAgYnJva2VyLnNldFJlc3RvcmVTdGF0ZShfY29u\nZi5nZXRSZXN0b3JlU3RhdGVDb25zdGFudCgpKTsKICAgICAgICBicm9rZXIu\nc2V0QXV0b0NsZWFyKF9jb25mLmdldEF1dG9DbGVhckNvbnN0YW50KCkpOwog\nICAgICAgIGJyb2tlci5zZXRJZ25vcmVDaGFuZ2VzKF9jb25mLmdldElnbm9y\nZUNoYW5nZXMoKSk7CiAgICAgICAgYnJva2VyLnNldE11bHRpdGhyZWFkZWQo\nX2NvbmYuZ2V0TXVsdGl0aHJlYWRlZCgpKTsKICAgICAgICBicm9rZXIuc2V0\nQXV0b0RldGFjaChfY29uZi5nZXRBdXRvRGV0YWNoQ29uc3RhbnQoKSk7CiAg\nICAgICAgYnJva2VyLnNldERldGFjaFN0YXRlKF9jb25mLmdldERldGFjaFN0\nYXRlSW5zdGFuY2UoKS5nZXREZXRhY2hTdGF0ZSgpKTsKICAgIH0KCiAgICAv\nKioKICAgICAqIEZyZWV6ZXMgdGhlIGNvbmZpZ3VyYXRpb24gb2YgdGhpcyBm\nYWN0b3J5LgogICAgICovCiAgICBwdWJsaWMgdm9pZCBtYWtlUmVhZE9ubHko\nKSB7CiAgICAgICAgaWYgKF9yZWFkT25seSkKICAgICAgICAgICAgcmV0dXJu\nOwoKICAgICAgICBsb2NrKCk7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAg\nLy8gY2hlY2sgYWdhaW4KICAgICAgICAgICAgaWYgKF9yZWFkT25seSkKICAg\nICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgX3JlYWRPbmx5ID0g\ndHJ1ZTsKCiAgICAgICAgICAgIExvZyBsb2cgPSBfY29uZi5nZXRMb2coT3Bl\nbkpQQUNvbmZpZ3VyYXRpb24uTE9HX1JVTlRJTUUpOwogICAgICAgICAgICBp\nZiAobG9nLmlzSW5mb0VuYWJsZWQoKSkKICAgICAgICAgICAgICAgIGxvZy5p\nbmZvKGdldEZhY3RvcnlJbml0aWFsaXphdGlvbkJhbm5lcigpKTsKICAgICAg\nICAgICAgaWYgKGxvZy5pc1RyYWNlRW5hYmxlZCgpKSB7CiAgICAgICAgICAg\nICAgICBNYXA8U3RyaW5nLE9iamVjdD4gcHJvcHMgPSBfY29uZi50b1Byb3Bl\ncnRpZXModHJ1ZSk7CiAgICAgICAgICAgICAgICBTdHJpbmcgbGluZVNlcCA9\nIEoyRG9Qcml2SGVscGVyLmdldExpbmVTZXBhcmF0b3IoKTsKICAgICAgICAg\nICAgICAgIFN0cmluZ0J1aWxkZXIgYnVmID0gbmV3IFN0cmluZ0J1aWxkZXIo\nKTsKICAgICAgICAgICAgICAgIE1hcC5FbnRyeTw/LD8+IGVudHJ5OwogICAg\nICAgICAgICAgICAgZm9yIChJdGVyYXRvcjxNYXAuRW50cnk8U3RyaW5nLE9i\namVjdD4+IGl0ciA9IHByb3BzLmVudHJ5U2V0KCkuaXRlcmF0b3IoKTsgaXRy\nLmhhc05leHQoKTspIHsKICAgICAgICAgICAgICAgICAgICBlbnRyeSA9IGl0\nci5uZXh0KCk7CiAgICAgICAgICAgICAgICAgICAgYnVmLmFwcGVuZChlbnRy\neS5nZXRLZXkoKSkuYXBwZW5kKCI6ICIpLmFwcGVuZChlbnRyeS5nZXRWYWx1\nZSgpKTsKICAgICAgICAgICAgICAgICAgICBpZiAoaXRyLmhhc05leHQoKSkK\nICAgICAgICAgICAgICAgICAgICAgICAgYnVmLmFwcGVuZChsaW5lU2VwKTsK\nICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGxvZy50cmFjZShf\nbG9jLmdldCgiZmFjdG9yeS1wcm9wZXJ0aWVzIiwgYnVmLnRvU3RyaW5nKCkp\nKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gc2V0dXAgdHJhbnNp\nZW50IHN0YXRlCiAgICAgICAgICAgIHNldHVwKCk7CgogICAgICAgICAgICAv\nLyByZWdpc3RlciB0aGUgbWV0ZGF0YSByZXBvc2l0b3J5IHRvIGF1dG8tbG9h\nZCBwZXJzaXN0ZW50IHR5cGVzCiAgICAgICAgICAgIC8vIGFuZCBtYWtlIHN1\ncmUgdHlwZXMgYXJlIGVuaGFuY2VkCiAgICAgICAgICAgIE1ldGFEYXRhUmVw\nb3NpdG9yeSByZXBvcyA9IF9jb25mLmdldE1ldGFEYXRhUmVwb3NpdG9yeUlu\nc3RhbmNlKCk7CiAgICAgICAgICAgIHJlcG9zLnNldFZhbGlkYXRlKE1ldGFE\nYXRhUmVwb3NpdG9yeS5WQUxJREFURV9SVU5USU1FLCB0cnVlKTsKICAgICAg\nICAgICAgcmVwb3Muc2V0UmVzb2x2ZShNZXRhRGF0YU1vZGVzLk1PREVfTUFQ\nUElOR19JTklULCB0cnVlKTsKICAgICAgICAgICAgUENSZWdpc3RyeS5hZGRS\nZWdpc3RlckNsYXNzTGlzdGVuZXIocmVwb3MpOwoKICAgICAgICAgICAgLy8g\nZnJlZXplIHVuZGVybHlpbmcgY29uZmlndXJhdGlvbiBhbmQgZWFnZXJseSBp\nbml0aWFsaXplIHRvCiAgICAgICAgICAgIC8vIGF2b2lkIHN5bmNocm9uaXph\ndGlvbgogICAgICAgICAgICBfY29uZi5zZXRSZWFkT25seShDb25maWd1cmF0\naW9uLklOSVRfU1RBVEVfRlJFRVpJTkcpOwogICAgICAgICAgICBfY29uZi5p\nbnN0YW50aWF0ZUFsbCgpOwogICAgICAgICAgICBpZiAoX2NvbmYuaXNJbml0\naWFsaXplRWFnZXJseSgpKQogICAgICAgICAgICAJX2NvbmYuc2V0UmVhZE9u\nbHkoQ29uZmlndXJhdGlvbi5JTklUX1NUQVRFX0ZST1pFTik7CiAgICAgICAg\nICAgIC8vIGZpcmUgYW4gZXZlbnQgZm9yIGFsbCB0aGUgYnJva2VyIGZhY3Rv\ncnkgbGlzdGVuZXJzCiAgICAgICAgICAgIC8vIHJlZ2lzdGVyZWQgb24gdGhl\nIGNvbmZpZ3VyYXRpb24uCiAgICAgICAgICAgIF9jb25mLmdldEJyb2tlckZh\nY3RvcnlFdmVudE1hbmFnZXIoKS5maXJlRXZlbnQoCiAgICAgICAgICAgICAg\nICBuZXcgQnJva2VyRmFjdG9yeUV2ZW50KHRoaXMsCiAgICAgICAgICAgICAg\nICAgICAgQnJva2VyRmFjdG9yeUV2ZW50LkJST0tFUl9GQUNUT1JZX0NSRUFU\nRUQpKTsKICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICB1bmxvY2so\nKTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gYW4g\nb2JqZWN0IHRvIGJlIHdyaXR0ZW4gdG8gdGhlIGxvZyB3aGVuIHRoaXMgYnJv\na2VyIGZhY3RvcnkKICAgICAqIGluaXRpYWxpemVzLiBUaGlzIGhhcHBlbnMg\nYWZ0ZXIgdGhlIGNvbmZpZ3VyYXRpb24gaXMgZnVsbHkgbG9hZGVkLgogICAg\nICovCiAgICBwcm90ZWN0ZWQgT2JqZWN0IGdldEZhY3RvcnlJbml0aWFsaXph\ndGlvbkJhbm5lcigpIHsKICAgICAgICByZXR1cm4gX2xvYy5nZXQoImZhY3Rv\ncnktaW5pdCIsIE9wZW5KUEFWZXJzaW9uLlZFUlNJT05fTlVNQkVSKTsKICAg\nIH0KCiAgICAvKioKICAgICAqIFRocm93IGFuIGV4Y2VwdGlvbiBpZiB0aGUg\nZmFjdG9yeSBpcyBjbG9zZWQuICBUaGUgZXhhY3QgbWVzc2FnZSBhbmQKICAg\nICAqIGNvbnRlbnQgb2YgdGhlIGV4Y2VwdGlvbiB2YXJpZXMgd2hldGhlciBU\nUkFDRSBpcyBlbmFibGVkIG9yIG5vdC4KICAgICAqLwogICAgcHJpdmF0ZSB2\nb2lkIGFzc2VydE9wZW4oKSB7CiAgICAgICAgaWYgKF9jbG9zZWQpIHsKICAg\nICAgICAgICAgaWYgKF9jbG9zZWRFeGNlcHRpb24gPT0gbnVsbCkgIC8vIFRS\nQUNFIG5vdCBlbmFibGVkCiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgSW52\nYWxpZFN0YXRlRXhjZXB0aW9uKF9sb2MKICAgICAgICAgICAgICAgICAgICAg\nICAgLmdldCgiY2xvc2VkLWZhY3Rvcnktbm90cmFjZSIpKTsKICAgICAgICAg\nICAgZWxzZQogICAgICAgICAgICAgICAgdGhyb3cgbmV3IEludmFsaWRTdGF0\nZUV4Y2VwdGlvbihfbG9jLmdldCgiY2xvc2VkLWZhY3RvcnkiKSkKICAgICAg\nICAgICAgICAgICAgICAgICAgLnNldENhdXNlKF9jbG9zZWRFeGNlcHRpb24p\nOwogICAgICAgIH0KICAgIH0KCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLwog\nICAgLy8gQnJva2VyIHV0aWxpdGllcwogICAgLy8vLy8vLy8vLy8vLy8vLy8v\nLy8KCiAgICAvKioKICAgICAqIFRocm93cyBhIHtAbGluayBVc2VyRXhjZXB0\naW9ufSBpZiBhIHRyYW5zYWN0aW9uIGlzIGFjdGl2ZS4gVGhlIHRocm93bgog\nICAgICogZXhjZXB0aW9uIHdpbGwgY29udGFpbiBhbGwgdGhlIEJyb2tlcnMg\nd2l0aCBhY3RpdmUgdHJhbnNhY3Rpb25zIGFzCiAgICAgKiBmYWlsZWQgb2Jq\nZWN0cyBpbiB0aGUgbmVzdGVkIGV4Y2VwdGlvbnMuCiAgICAgKi8KICAgIHBy\naXZhdGUgdm9pZCBhc3NlcnROb0FjdGl2ZVRyYW5zYWN0aW9uKCkgewogICAg\nICAgIENvbGxlY3Rpb248VGhyb3dhYmxlPiBleGNzOwogICAgICAgIGlmIChf\ndHJhbnNhY3Rpb25hbC5pc0VtcHR5KCkpCiAgICAgICAgICAgIHJldHVybjsK\nCiAgICAgICAgZXhjcyA9IG5ldyBBcnJheUxpc3Q8VGhyb3dhYmxlPihfdHJh\nbnNhY3Rpb25hbC5zaXplKCkpOwogICAgICAgIGZvciAoQ29sbGVjdGlvbjxC\ncm9rZXI+IGJyb2tlcnMgOiBfdHJhbnNhY3Rpb25hbC52YWx1ZXMoKSkgewog\nICAgICAgICAgICBmb3IgKEJyb2tlciBicm9rZXIgOiBicm9rZXJzKSB7CiAg\nICAgICAgICAgICAgICBleGNzLmFkZChuZXcgSW52YWxpZFN0YXRlRXhjZXB0\naW9uKF9sb2MuZ2V0KCJhY3RpdmUiKSkuc2V0RmFpbGVkT2JqZWN0KGJyb2tl\ncikpOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAoIWV4\nY3MuaXNFbXB0eSgpKQogICAgICAgICAgICB0aHJvdyBuZXcgSW52YWxpZFN0\nYXRlRXhjZXB0aW9uKF9sb2MuZ2V0KCJuZXN0ZWQtZXhjZXBzIikpLgogICAg\nICAgICAgICAgICAgc2V0TmVzdGVkVGhyb3dhYmxlcygoVGhyb3dhYmxlW10p\nIGV4Y3MudG9BcnJheShuZXcgVGhyb3dhYmxlW2V4Y3Muc2l6ZSgpXSkpOwog\nICAgfQoKICAgIC8qKgogICAgICogU3luY2hyb25pemUgdGhlIGdpdmVuIGJy\nb2tlciB3aXRoIGEgbWFuYWdlZCB0cmFuc2FjdGlvbiwKICAgICAqIG9wdGlv\nbmFsbHkgc3RhcnRpbmcgb25lIGlmIG5vbmUgaXMgaW4gcHJvZ3Jlc3MuCiAg\nICAgKgogICAgICogQHJldHVybiB0cnVlIGlmIHN5bmNoZWQgd2l0aCB0cmFu\nc2FjdGlvbiwgZmFsc2Ugb3RoZXJ3aXNlCiAgICAgKi8KICAgIGJvb2xlYW4g\nc3luY1dpdGhNYW5hZ2VkVHJhbnNhY3Rpb24oQnJva2VySW1wbCBicm9rZXIs\nIGJvb2xlYW4gYmVnaW4pIHsKICAgICAgICBUcmFuc2FjdGlvbiB0cmFuczsK\nICAgICAgICB0cnkgewogICAgICAgICAgICBNYW5hZ2VkUnVudGltZSBtciA9\nIGJyb2tlci5nZXRNYW5hZ2VkUnVudGltZSgpOwogICAgICAgICAgICBUcmFu\nc2FjdGlvbk1hbmFnZXIgdG0gPSBtci5nZXRUcmFuc2FjdGlvbk1hbmFnZXIo\nKTsKICAgICAgICAgICAgdHJhbnMgPSB0bS5nZXRUcmFuc2FjdGlvbigpOwog\nICAgICAgICAgICBpZiAodHJhbnMgIT0gbnVsbAogICAgICAgICAgICAgICAg\nJiYgKHRyYW5zLmdldFN0YXR1cygpID09IFN0YXR1cy5TVEFUVVNfTk9fVFJB\nTlNBQ1RJT04KICAgICAgICAgICAgICAgIHx8IHRyYW5zLmdldFN0YXR1cygp\nID09IFN0YXR1cy5TVEFUVVNfVU5LTk9XTikpCiAgICAgICAgICAgICAgICB0\ncmFucyA9IG51bGw7CgogICAgICAgICAgICBpZiAodHJhbnMgPT0gbnVsbCAm\nJiBiZWdpbikgewogICAgICAgICAgICAgICAgdG0uYmVnaW4oKTsKICAgICAg\nICAgICAgICAgIHRyYW5zID0gdG0uZ2V0VHJhbnNhY3Rpb24oKTsKICAgICAg\nICAgICAgfSBlbHNlIGlmICh0cmFucyA9PSBudWxsKQogICAgICAgICAgICAg\nICAgcmV0dXJuIGZhbHNlOwoKICAgICAgICAgICAgLy8gc3luY2ggYnJva2Vy\nIGFuZCB0cmFucwogICAgICAgICAgICB0cmFucy5yZWdpc3RlclN5bmNocm9u\naXphdGlvbihicm9rZXIpOwoKICAgICAgICAgICAgLy8gd2UgZG9uJ3QgbmVl\nZCB0byBzeW5jaHJvbml6ZSBvbiBicm9rZXJzIG9yIGd1YXJkIGFnYWluc3Qg\nbXVsdGlwbGUKICAgICAgICAgICAgLy8gdGhyZWFkcyB1c2luZyB0aGUgc2Ft\nZSB0cmFucyBzaW5jZSBvbmUgSlRBIHRyYW5zYWN0aW9uIGNhbiBuZXZlcgog\nICAgICAgICAgICAvLyBiZSBhY3RpdmUgb24gbXVsdGlwbGUgY29uY3VycmVu\ndCB0aHJlYWRzLgogICAgICAgICAgICBPYmplY3QgdHhLZXkgPSBtci5nZXRU\ncmFuc2FjdGlvbktleSgpOwogICAgICAgICAgICBDb2xsZWN0aW9uPEJyb2tl\ncj4gYnJva2VycyA9IF90cmFuc2FjdGlvbmFsLmdldCh0eEtleSk7CiAgICAg\nICAgICAgIAogICAgICAgICAgICBpZiAoYnJva2VycyA9PSBudWxsKSB7CiAg\nICAgICAgICAgICAgICBicm9rZXJzID0gbmV3IEFycmF5TGlzdDxCcm9rZXI+\nKDIpOwogICAgICAgICAgICAgICAgX3RyYW5zYWN0aW9uYWwucHV0KHR4S2V5\nLCBicm9rZXJzKTsKICAgICAgICAgICAgICAgIHRyYW5zLnJlZ2lzdGVyU3lu\nY2hyb25pemF0aW9uKG5ldyBSZW1vdmVUcmFuc2FjdGlvblN5bmModHhLZXkp\nKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBicm9rZXJzLmFkZChicm9r\nZXIpOwogICAgICAgICAgICAKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAg\nICAgICAgfSBjYXRjaCAoT3BlbkpQQUV4Y2VwdGlvbiBrZSkgewogICAgICAg\nICAgICB0aHJvdyBrZTsKICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkg\newogICAgICAgICAgICB0aHJvdyBuZXcgR2VuZXJhbEV4Y2VwdGlvbihlKTsK\nICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm5zIGEgc2V0\nIG9mIGFsbCB0aGUgb3BlbiBicm9rZXJzIGFzc29jaWF0ZWQgd2l0aCB0aGlz\nIGZhY3RvcnkuIFRoZQogICAgICogcmV0dXJuZWQgc2V0IGlzIHVubW9kaWZp\nYWJsZSwgYW5kIG1heSBjb250YWluIG51bGwgcmVmZXJlbmNlcy4KICAgICAq\nLwogICAgcHVibGljIENvbGxlY3Rpb248QnJva2VyPiBnZXRPcGVuQnJva2Vy\ncygpIHsKICAgICAgICByZXR1cm4gQ29sbGVjdGlvbnMudW5tb2RpZmlhYmxl\nQ29sbGVjdGlvbihfYnJva2Vycyk7CiAgICB9CgogICAgLyoqCiAgICAgKiBS\nZWxlYXNlIDxjb2RlPmJyb2tlcjwvY29kZT4gZnJvbSBhbnkgaW50ZXJuYWwg\nZGF0YSBzdHJ1Y3R1cmVzLiBUaGlzCiAgICAgKiBpcyBpbnZva2VkIGJ5IDxj\nb2RlPmJyb2tlcjwvY29kZT4gYWZ0ZXIgdGhlIGJyb2tlciBpcyBmdWxseSBj\nbG9zZWQuCiAgICAgKgogICAgICogQHNpbmNlIDEuMS4wCiAgICAgKi8KICAg\nIHByb3RlY3RlZCB2b2lkIHJlbGVhc2VCcm9rZXIoQnJva2VySW1wbCBicm9r\nZXIpIHsKICAgICAgICBfYnJva2Vycy5yZW1vdmUoYnJva2VyKTsKICAgIH0K\nCiAgICAvKioKICAgICAqIEByZXR1cm4gYSBrZXkgdGhhdCBjYW4gYmUgdXNl\nZCB0byBvYnRhaW4gdGhpcyBicm9rZXIgZmFjdG9yeSBmcm9tIHRoZQogICAg\nICogcG9vbCBhdCBhIGxhdGVyIHRpbWUuCiAgICAgKgogICAgICogQHNpbmNl\nIDEuMS4wCiAgICAgKi8KICAgIHB1YmxpYyBPYmplY3QgZ2V0UG9vbEtleSgp\nIHsKICAgICAgICByZXR1cm4gX3Bvb2xLZXk7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBTZXQgYSBrZXkgdGhhdCBjYW4gYmUgdXNlZCB0byBvYnRhaW4gdGhp\ncyBicm9rZXIgZmFjdG9yeSBmcm9tIHRoZQogICAgICogcG9vbCBhdCBhIGxh\ndGVyIHRpbWUuCiAgICAgKgogICAgICogQHNpbmNlIDEuMS4wCiAgICAgKi8K\nICAgIHZvaWQgc2V0UG9vbEtleShPYmplY3Qga2V5KSB7CiAgICAgICAgX3Bv\nb2xLZXkgPSBrZXk7CiAgICB9CgogICAgLyoqCiAgICAgKiBTaW1wbGUgc3lu\nY2hyb25pemF0aW9uIGxpc3RlbmVyIHRvIHJlbW92ZSBjb21wbGV0ZWQgdHJh\nbnNhY3Rpb25zCiAgICAgKiBmcm9tIG91ciBjYWNoZS4KICAgICAqLwogICAg\ncHJpdmF0ZSBjbGFzcyBSZW1vdmVUcmFuc2FjdGlvblN5bmMKICAgICAgICBp\nbXBsZW1lbnRzIFN5bmNocm9uaXphdGlvbiB7CgogICAgICAgIHByaXZhdGUg\nZmluYWwgT2JqZWN0IF90cmFuczsKCiAgICAgICAgcHVibGljIFJlbW92ZVRy\nYW5zYWN0aW9uU3luYyhPYmplY3QgdHJhbnMpIHsKICAgICAgICAgICAgX3Ry\nYW5zID0gdHJhbnM7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgdm9pZCBi\nZWZvcmVDb21wbGV0aW9uKCkgewogICAgICAgIH0KCiAgICAgICAgcHVibGlj\nIHZvaWQgYWZ0ZXJDb21wbGV0aW9uKGludCBzdGF0dXMpIHsKICAgICAgICAg\nICAgX3RyYW5zYWN0aW9uYWwucmVtb3ZlIChfdHJhbnMpOwoJCX0KCX0KICAg\nIAogICAgLyoqCiAgICAgKiBNZXRob2QgaW5zdXJlcyB0aGF0IGRlc2VyaWFs\naXplZCBFTUYgaGFzIHRoaXMgcmVmZXJlbmNlIHJlLWluc3RhbnRpYXRlZAog\nICAgICovCiAgICBwcml2YXRlIENvbGxlY3Rpb248Q2xhc3NMb2FkZXI+IGdl\ndFBjQ2xhc3NMb2FkZXJzKCkgewogICAgICAgaWYgKF9wY0NsYXNzTG9hZGVy\ncyA9PSBudWxsKQogICAgICAgICBfcGNDbGFzc0xvYWRlcnMgPSBuZXcgQ29u\nY3VycmVudFJlZmVyZW5jZUhhc2hTZXQ8Q2xhc3NMb2FkZXI+KENvbmN1cnJl\nbnRSZWZlcmVuY2VIYXNoU2V0LldFQUspOwogICAgICAgICAgCiAgICAgICBy\nZXR1cm4gX3BjQ2xhc3NMb2FkZXJzOwogICAgfQoKICAgIC8qKgogICAgICog\nPFA+CiAgICAgKiBDcmVhdGUgYSBEZWxlZ2F0aW5nU3RvcmVNYW5hZ2VyIGZv\nciB1c2Ugd2l0aCBhIEJyb2tlciBjcmVhdGVkIGJ5IHRoaXMgZmFjdG9yeS4K\nICAgICAqIElmIGEgRGF0YUNhY2hlIGhhcyBiZWVuIGVuYWJsZWQgYSBEYXRh\nQ2FjaGVTdG9yZU1hbmFnZXIgd2lsbCBiZSByZXR1cm5lZC4KICAgICAqIDwv\nUD4KICAgICAqIDxQPgogICAgICogSWYgbm8gRGF0YUNhY2hlIGlzIGluIHVz\nZSBhbiBST1BTdG9yZU1hbmFnZXIgd2lsbCBiZSByZXR1cm5lZC4gCiAgICAg\nKiA8L1A+CiAgICAgKiAKICAgICAqIEByZXR1cm4gQSBkZWxlZ2F0aW5nIHN0\nb3JlIG1hbmFnZXIgc3VpdGFibGUgZm9yIHRoZSBjdXJyZW50CiAgICAgKiAg\nICAgICAgIGNvbmZpZ3VyYXRpb24uCiAgICAgKi8KICAgIHByb3RlY3RlZCBE\nZWxlZ2F0aW5nU3RvcmVNYW5hZ2VyIGNyZWF0ZURlbGVnYXRpbmdTdG9yZU1h\nbmFnZXIoKSB7IAogICAgICAgIC8vIGRlY29yYXRlIHRoZSBzdG9yZSBtYW5h\nZ2VyIGZvciBkYXRhIGNhY2hpbmcgYW5kIGN1c3RvbQogICAgICAgIC8vIHJl\nc3VsdCBvYmplY3QgcHJvdmlkZXJzOyBhbHdheXMgbWFrZSBzdXJlIGl0J3Mg\nYSBkZWxlZ2F0aW5nCiAgICAgICAgLy8gc3RvcmUgbWFuYWdlciwgYmVjYXVz\nZSBpdCdzIGVhc2llciBmb3IgdXNlcnMgdG8gZGVhbCB3aXRoCiAgICAgICAg\nLy8gdGhhdCB3YXkKICAgICAgICBTdG9yZU1hbmFnZXIgc20gPSBuZXdTdG9y\nZU1hbmFnZXIoKTsKICAgICAgICBEZWxlZ2F0aW5nU3RvcmVNYW5hZ2VyIGRz\nbSA9IG51bGw7CiAgICAgICAgaWYgKF9jb25mLmdldERhdGFDYWNoZU1hbmFn\nZXJJbnN0YW5jZSgpLmdldFN5c3RlbURhdGFDYWNoZSgpICE9IG51bGwpIHsK\nICAgICAgICAgICAgZHNtID0gbmV3IERhdGFDYWNoZVN0b3JlTWFuYWdlcihz\nbSk7CiAgICAgICAgfQogICAgICAgIGRzbSA9IG5ldyBST1BTdG9yZU1hbmFn\nZXIoKGRzbSA9PSBudWxsKSA/IHNtIDogZHNtKTsKICAgICAgICAKICAgICAg\nICByZXR1cm4gZHNtOwogICAgfQp9Cgo=\n","encoding":"base64"}

