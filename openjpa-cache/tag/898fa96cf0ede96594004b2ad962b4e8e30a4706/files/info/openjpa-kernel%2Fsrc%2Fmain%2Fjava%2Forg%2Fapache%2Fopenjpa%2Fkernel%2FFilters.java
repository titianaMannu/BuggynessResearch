{"sha":"592fcdd1477baa521fc041c9c82cd1f527da9bac","node_id":"MDQ6QmxvYjIwNjM2NDo1OTJmY2RkMTQ3N2JhYTUyMWZjMDQxYzljODJjZDFmNTI3ZGE5YmFj","size":35139,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/592fcdd1477baa521fc041c9c82cd1f527da9bac","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsOwoKaW1wb3J0IGph\ndmEubGFuZy5yZWZsZWN0Lk1ldGhvZDsKaW1wb3J0IGphdmEubWF0aC5CaWdE\nZWNpbWFsOwppbXBvcnQgamF2YS5tYXRoLkJpZ0ludGVnZXI7CmltcG9ydCBq\nYXZhLnNlY3VyaXR5LkFjY2Vzc0NvbnRyb2xsZXI7CmltcG9ydCBqYXZhLnNl\nY3VyaXR5LlByaXZpbGVnZWRBY3Rpb25FeGNlcHRpb247CmltcG9ydCBqYXZh\nLnNxbC5UaW1lOwppbXBvcnQgamF2YS5zcWwuVGltZXN0YW1wOwppbXBvcnQg\namF2YS51dGlsLkFycmF5TGlzdDsKaW1wb3J0IGphdmEudXRpbC5DYWxlbmRh\ncjsKaW1wb3J0IGphdmEudXRpbC5Db2xsZWN0aW9uOwppbXBvcnQgamF2YS51\ndGlsLkNvbGxlY3Rpb25zOwppbXBvcnQgamF2YS51dGlsLkRhdGU7CmltcG9y\ndCBqYXZhLnV0aWwuTGlzdDsKCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\nZW5oYW5jZS5SZWZsZWN0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLmtlcm5lbC5leHBzLkFnZ3JlZ2F0ZUxpc3RlbmVyOwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLmtlcm5lbC5leHBzLkZpbHRlckxpc3RlbmVyOwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51dGlsLkoyRG9Qcml2SGVscGVy\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51dGlsLkxvY2FsaXpl\ncjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRhLkNsYXNzTWV0YURh\ndGE7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YS5KYXZhVHlwZXM7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5JbnRlcm5hbEV4Y2Vw\ndGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLlVzZXJFeGNl\ncHRpb247CmltcG9ydCBzZXJwLnV0aWwuTnVtYmVyczsKaW1wb3J0IHNlcnAu\ndXRpbC5TdHJpbmdzOwoKLyoqCiAqIEhlbHBlciBtZXRob2RzIGZvciBkZWFs\naW5nIHdpdGggcXVlcnkgZmlsdGVycy4KICoKICogQGF1dGhvciBBYmUgV2hp\ndGUKICogQG5vamF2YWRvYwogKi8KcHVibGljIGNsYXNzIEZpbHRlcnMgewoK\nICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIEJpZ0RlY2ltYWwgWkVST19CSUdE\nRUNJTUFMID0gbmV3IEJpZ0RlY2ltYWwoMEQpOwogICAgcHJpdmF0ZSBzdGF0\naWMgZmluYWwgQmlnSW50ZWdlciBaRVJPX0JJR0lOVEVHRVIgPSBuZXcgQmln\nSW50ZWdlcigiMCIpOwoKICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIGludCBP\nUF9BREQgPSAwOwogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgaW50IE9QX1NV\nQlRSQUNUID0gMTsKICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIGludCBPUF9N\nVUxUSVBMWSA9IDI7CiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBpbnQgT1Bf\nRElWSURFID0gMzsKICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIGludCBPUF9N\nT0QgPSA0OwoKICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIExvY2FsaXplciBf\nbG9jID0gTG9jYWxpemVyLmZvclBhY2thZ2UoRmlsdGVycy5jbGFzcyk7Cgog\nICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIGNvcnJlY3Qgd3JhcHBlciB0eXBl\nIGZvciB0aGUgZ2l2ZW4gY2xhc3MuCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0\naWMgQ2xhc3M8Pz4gd3JhcChDbGFzczw/PiBjKSB7CiAgICAgICAgaWYgKCFj\nLmlzUHJpbWl0aXZlKCkpCiAgICAgICAgICAgIHJldHVybiBjOwogICAgICAg\nIGlmIChjID09IGludC5jbGFzcykKICAgICAgICAgICAgcmV0dXJuIEludGVn\nZXIuY2xhc3M7CiAgICAgICAgaWYgKGMgPT0gZmxvYXQuY2xhc3MpCiAgICAg\nICAgICAgIHJldHVybiBGbG9hdC5jbGFzczsKICAgICAgICBpZiAoYyA9PSBk\nb3VibGUuY2xhc3MpCiAgICAgICAgICAgIHJldHVybiBEb3VibGUuY2xhc3M7\nCiAgICAgICAgaWYgKGMgPT0gbG9uZy5jbGFzcykKICAgICAgICAgICAgcmV0\ndXJuIExvbmcuY2xhc3M7CiAgICAgICAgaWYgKGMgPT0gYm9vbGVhbi5jbGFz\ncykKICAgICAgICAgICAgcmV0dXJuIEJvb2xlYW4uY2xhc3M7CiAgICAgICAg\naWYgKGMgPT0gc2hvcnQuY2xhc3MpCiAgICAgICAgICAgIHJldHVybiBTaG9y\ndC5jbGFzczsKICAgICAgICBpZiAoYyA9PSBieXRlLmNsYXNzKQogICAgICAg\nICAgICByZXR1cm4gQnl0ZS5jbGFzczsKICAgICAgICBpZiAoYyA9PSBjaGFy\nLmNsYXNzKQogICAgICAgICAgICByZXR1cm4gQ2hhcmFjdGVyLmNsYXNzOwog\nICAgICAgIHJldHVybiBjOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJu\nIHRoZSBjb3JyZWN0IHByaW1pdGl2ZSB0eXBlIGZvciB0aGUgZ2l2ZW4gY2xh\nc3MsIGlmIGl0IGlzIGEKICAgICAqIHdyYXBwZXIuCiAgICAgKi8KICAgIHB1\nYmxpYyBzdGF0aWMgQ2xhc3M8Pz4gdW53cmFwKENsYXNzPD8+IGMpIHsKICAg\nICAgICBpZiAoYy5pc1ByaW1pdGl2ZSgpIHx8IGMgPT0gU3RyaW5nLmNsYXNz\nKQogICAgICAgICAgICByZXR1cm4gYzsKICAgICAgICBpZiAoYyA9PSBJbnRl\nZ2VyLmNsYXNzKQogICAgICAgICAgICByZXR1cm4gaW50LmNsYXNzOwogICAg\nICAgIGlmIChjID09IEZsb2F0LmNsYXNzKQogICAgICAgICAgICByZXR1cm4g\nZmxvYXQuY2xhc3M7CiAgICAgICAgaWYgKGMgPT0gRG91YmxlLmNsYXNzKQog\nICAgICAgICAgICByZXR1cm4gZG91YmxlLmNsYXNzOwogICAgICAgIGlmIChj\nID09IExvbmcuY2xhc3MpCiAgICAgICAgICAgIHJldHVybiBsb25nLmNsYXNz\nOwogICAgICAgIGlmIChjID09IEJvb2xlYW4uY2xhc3MpCiAgICAgICAgICAg\nIHJldHVybiBib29sZWFuLmNsYXNzOwogICAgICAgIGlmIChjID09IFNob3J0\nLmNsYXNzKQogICAgICAgICAgICByZXR1cm4gc2hvcnQuY2xhc3M7CiAgICAg\nICAgaWYgKGMgPT0gQnl0ZS5jbGFzcykKICAgICAgICAgICAgcmV0dXJuIGJ5\ndGUuY2xhc3M7CiAgICAgICAgaWYgKGMgPT0gQ2hhcmFjdGVyLmNsYXNzKQog\nICAgICAgICAgICByZXR1cm4gY2hhci5jbGFzczsKICAgICAgICByZXR1cm4g\nYzsKICAgIH0KCiAgICAvKioKICAgICAqIEdpdmVuIHR3byB0eXBlcywgcmV0\ndXJuIHR5cGUgdGhleSBzaG91bGQgYm90aCBiZSBjb252ZXJ0ZWQKICAgICAq\nIHRvIGJlZm9yZSBwZXJmb3JtaW5nIGFueSBvcGVyYXRpb25zIGJldHdlZW4g\ndGhlbS4KICAgICAqLwogICAgcHVibGljIHN0YXRpYyBDbGFzczw/PiBwcm9t\nb3RlKENsYXNzPD8+IGMxLCBDbGFzczw/PiBjMikgewogICAgICAgIGlmIChj\nMSA9PSBjMikKICAgICAgICAgICAgcmV0dXJuIHVud3JhcChjMSk7CiAgICAg\nICAgQ2xhc3M8Pz4gdzEgPSB3cmFwKGMxKTsKICAgICAgICBDbGFzczw/PiB3\nMiA9IHdyYXAoYzIpOwogICAgICAgIGlmICh3MSA9PSB3MikKICAgICAgICAg\nICAgcmV0dXJuIHVud3JhcChjMSk7CgogICAgICAgIC8vIG5vdCBudW1iZXJz\nPwogICAgICAgIGJvb2xlYW4gdzFOdW1iZXIgPSBOdW1iZXIuY2xhc3MuaXNB\nc3NpZ25hYmxlRnJvbSh3MSk7CiAgICAgICAgYm9vbGVhbiB3Mk51bWJlciA9\nIE51bWJlci5jbGFzcy5pc0Fzc2lnbmFibGVGcm9tKHcyKTsKICAgICAgICBp\nZiAoIXcxTnVtYmVyIHx8ICF3Mk51bWJlcikgewogICAgICAgICAgICAvLyB0\naGUgb25seSBub24tbnVtZXJpYyBwcm9tb3Rpb24gd2UgZG8gaXMgc3RyaW5n\nIHRvIGNoYXIsCiAgICAgICAgICAgIC8vIG9yIGZyb20gY2hhci9zdHJpbmcg\ndG8gbnVtYmVyCiAgICAgICAgICAgIGlmICghdzFOdW1iZXIpIHsKICAgICAg\nICAgICAgICAgIGlmICh3Mk51bWJlciAmJiAodzEgPT0gQ2hhcmFjdGVyLmNs\nYXNzIHx8IHcxID09IFN0cmluZy5jbGFzcykpCiAgICAgICAgICAgICAgICAg\nICAgcmV0dXJuICh3MiA9PSBCeXRlLmNsYXNzIHx8IHcyID09IFNob3J0LmNs\nYXNzKQogICAgICAgICAgICAgICAgICAgICAgICA/IEludGVnZXIuY2xhc3Mg\nOiB1bndyYXAoYzIpOwogICAgICAgICAgICAgICAgaWYgKCF3Mk51bWJlciAm\nJiB3MSA9PSBDaGFyYWN0ZXIuY2xhc3MgJiYgdzIgPT0gU3RyaW5nLmNsYXNz\nKQogICAgICAgICAgICAgICAgICAgIHJldHVybiBTdHJpbmcuY2xhc3M7CiAg\nICAgICAgICAgICAgICBpZiAodzJOdW1iZXIpCiAgICAgICAgICAgICAgICAg\nICAgcmV0dXJuIHVud3JhcChjMik7CiAgICAgICAgICAgIH0KICAgICAgICAg\nICAgaWYgKCF3Mk51bWJlcikgewogICAgICAgICAgICAgICAgaWYgKHcxTnVt\nYmVyICYmICh3MiA9PSBDaGFyYWN0ZXIuY2xhc3MgfHwgdzIgPT0gU3RyaW5n\nLmNsYXNzKSkKICAgICAgICAgICAgICAgICAgICByZXR1cm4gKHcxID09IEJ5\ndGUuY2xhc3MgfHwgdzEgPT0gU2hvcnQuY2xhc3MpCiAgICAgICAgICAgICAg\nICAgICAgICAgID8gSW50ZWdlci5jbGFzcyA6IHVud3JhcChjMSk7CiAgICAg\nICAgICAgICAgICBpZiAoIXcxTnVtYmVyICYmIHcyID09IENoYXJhY3Rlci5j\nbGFzcyAmJiB3MSA9PSBTdHJpbmcuY2xhc3MpCiAgICAgICAgICAgICAgICAg\nICAgcmV0dXJuIFN0cmluZy5jbGFzczsKICAgICAgICAgICAgICAgIGlmICh3\nMU51bWJlcikKICAgICAgICAgICAgICAgICAgICByZXR1cm4gdW53cmFwKGMx\nKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gaWYgbmVpdGhlciBh\ncmUgbnVtYmVycywgdXNlIGxlYXN0LWRlcml2ZWQgb2YgdGhlIHR3by4gIGlm\nIG5laXRoZXIKICAgICAgICAgICAgLy8gaXMgYXNzaWduYWJsZSBmcm9tIHRo\nZSBvdGhlciBidXQgb25lIGlzIGEgc3RhbmRhcmQgdHlwZSwgYXNzdW1lCiAg\nICAgICAgICAgIC8vIHRoZSBvdGhlciBjYW4gYmUgY29udmVydGVkIHRvIHRo\nYXQgc3RhbmRhcmQgdHlwZQogICAgICAgICAgICBpZiAoIXcxTnVtYmVyICYm\nICF3Mk51bWJlcikgewogICAgICAgICAgICAgICAgaWYgKHcxID09IE9iamVj\ndC5jbGFzcykKICAgICAgICAgICAgICAgICAgICByZXR1cm4gdW53cmFwKGMy\nKTsKICAgICAgICAgICAgICAgIGlmICh3MiA9PSBPYmplY3QuY2xhc3MpCiAg\nICAgICAgICAgICAgICAgICAgcmV0dXJuIHVud3JhcChjMSk7CiAgICAgICAg\nICAgICAgICBpZiAodzEuaXNBc3NpZ25hYmxlRnJvbSh3MikpCiAgICAgICAg\nICAgICAgICAgICAgcmV0dXJuIHVud3JhcChjMSk7CiAgICAgICAgICAgICAg\nICBpZiAodzIuaXNBc3NpZ25hYmxlRnJvbSh3MSkpCiAgICAgICAgICAgICAg\nICAgICAgcmV0dXJuIHVud3JhcChjMik7CiAgICAgICAgICAgICAgICBpZiAo\naXNOb25zdGFuZGFyZFR5cGUodzEpKQogICAgICAgICAgICAgICAgICAgIHJl\ndHVybiAoaXNOb25zdGFuZGFyZFR5cGUodzIpKSA/IE9iamVjdC5jbGFzcyA6\nIHVud3JhcChjMik7CiAgICAgICAgICAgICAgICBpZiAoaXNOb25zdGFuZGFy\nZFR5cGUodzIpKQogICAgICAgICAgICAgICAgICAgIHJldHVybiAoaXNOb25z\ndGFuZGFyZFR5cGUodzEpKSA/IE9iamVjdC5jbGFzcyA6IHVud3JhcChjMSk7\nCiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIE9iamVjdC5jbGFz\nczsKICAgICAgICB9CgogICAgICAgIGlmICh3MSA9PSBCaWdEZWNpbWFsLmNs\nYXNzIHx8IHcyID09IEJpZ0RlY2ltYWwuY2xhc3MpCiAgICAgICAgICAgIHJl\ndHVybiBCaWdEZWNpbWFsLmNsYXNzOwogICAgICAgIGlmICh3MSA9PSBCaWdJ\nbnRlZ2VyLmNsYXNzKSB7CiAgICAgICAgICAgIGlmICh3MiA9PSBGbG9hdC5j\nbGFzcyB8fCB3MiA9PSBEb3VibGUuY2xhc3MpCiAgICAgICAgICAgICAgICBy\nZXR1cm4gQmlnRGVjaW1hbC5jbGFzczsKICAgICAgICAgICAgcmV0dXJuIEJp\nZ0ludGVnZXIuY2xhc3M7CiAgICAgICAgfQogICAgICAgIGlmICh3MiA9PSBC\naWdJbnRlZ2VyLmNsYXNzKSB7CiAgICAgICAgICAgIGlmICh3MSA9PSBGbG9h\ndC5jbGFzcyB8fCB3MSA9PSBEb3VibGUuY2xhc3MpCiAgICAgICAgICAgICAg\nICByZXR1cm4gQmlnRGVjaW1hbC5jbGFzczsKICAgICAgICAgICAgcmV0dXJu\nIEJpZ0ludGVnZXIuY2xhc3M7CiAgICAgICAgfQogICAgICAgIGlmICh3MSA9\nPSBEb3VibGUuY2xhc3MgfHwgdzIgPT0gRG91YmxlLmNsYXNzKQogICAgICAg\nICAgICByZXR1cm4gZG91YmxlLmNsYXNzOwogICAgICAgIGlmICh3MSA9PSBG\nbG9hdC5jbGFzcyB8fCB3MiA9PSBGbG9hdC5jbGFzcykKICAgICAgICAgICAg\ncmV0dXJuIGZsb2F0LmNsYXNzOwogICAgICAgIGlmICh3MSA9PSBMb25nLmNs\nYXNzIHx8IHcyID09IExvbmcuY2xhc3MpCiAgICAgICAgICAgIHJldHVybiBs\nb25nLmNsYXNzOwogICAgICAgIHJldHVybiBpbnQuY2xhc3M7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBSZXR1cm4gd2hldGhlciB0aGUgZ2l2ZW4gdHlwZSBp\ncyBub3QgYSBzdGFuZGFyZCBwZXJzaXN0ZW50IHR5cGUuCiAgICAgKi8KICAg\nIHByaXZhdGUgc3RhdGljIGJvb2xlYW4gaXNOb25zdGFuZGFyZFR5cGUoQ2xh\nc3M8Pz4gYykgewogICAgICAgIHN3aXRjaCAoSmF2YVR5cGVzLmdldFR5cGVD\nb2RlKGMpKQogICAgICAgIHsKICAgICAgICBjYXNlIEphdmFUeXBlcy5BUlJB\nWToKICAgICAgICBjYXNlIEphdmFUeXBlcy5DT0xMRUNUSU9OOgogICAgICAg\nIGNhc2UgSmF2YVR5cGVzLk1BUDoKICAgICAgICBjYXNlIEphdmFUeXBlcy5Q\nQzoKICAgICAgICBjYXNlIEphdmFUeXBlcy5QQ19VTlRZUEVEOgogICAgICAg\nIGNhc2UgSmF2YVR5cGVzLk9JRDoKICAgICAgICBjYXNlIEphdmFUeXBlcy5P\nQkpFQ1Q6CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIGRlZmF1\nbHQ6CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CiAgICB9\nCgogICAgLyoqCiAgICAgKiBSZXR1cm4gd2hldGhlciBhbiBpbnN0YW5jZSBv\nZiB0aGUgZmlyc3QgY2xhc3MgY2FuIGJlIGNvbnZlcnRlZCB0bwogICAgICog\nYW4gaW5zdGFuY2Ugb2YgdGhlIHNlY29uZC4KICAgICAqLwogICAgcHVibGlj\nIHN0YXRpYyBib29sZWFuIGNhbkNvbnZlcnQoQ2xhc3M8Pz4gYzEsIENsYXNz\nPD8+IGMyLCBib29sZWFuIHN0cmljdCkgewogICAgICAgIGlmIChjMSA9PSBj\nMikKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgYzEgPSB3cmFw\nKGMxKTsKICAgICAgICBjMiA9IHdyYXAoYzIpOwogICAgICAgIGlmIChjMi5p\nc0Fzc2lnbmFibGVGcm9tKGMxKSkKICAgICAgICAgICAgcmV0dXJuIHRydWU7\nCgogICAgICAgIGJvb2xlYW4gYzFOdW1iZXIgPSBOdW1iZXIuY2xhc3MuaXNB\nc3NpZ25hYmxlRnJvbShjMSk7CiAgICAgICAgYm9vbGVhbiBjMk51bWJlciA9\nIE51bWJlci5jbGFzcy5pc0Fzc2lnbmFibGVGcm9tKGMyKTsKICAgICAgICBp\nZiAoYzFOdW1iZXIgJiYgYzJOdW1iZXIpCiAgICAgICAgICAgIHJldHVybiB0\ncnVlOwogICAgICAgIGlmICgoYzFOdW1iZXIgJiYgKGMyID09IENoYXJhY3Rl\nci5jbGFzcwogICAgICAgICAgICB8fCAoIXN0cmljdCAmJiBjMiA9PSBTdHJp\nbmcuY2xhc3MpKSkKICAgICAgICAgICAgfHwgKGMyTnVtYmVyICYmIChjMSA9\nPSBDaGFyYWN0ZXIuY2xhc3MKICAgICAgICAgICAgfHwgKCFzdHJpY3QgJiYg\nYzEgPT0gU3RyaW5nLmNsYXNzKSkpKQogICAgICAgICAgICByZXR1cm4gdHJ1\nZTsKICAgICAgICBpZiAoYzEgPT0gU3RyaW5nLmNsYXNzICYmIGMyID09IENo\nYXJhY3Rlci5jbGFzcykKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAg\nICAgaWYgKGMyID09IFN0cmluZy5jbGFzcykKICAgICAgICAgICAgcmV0dXJu\nICFzdHJpY3Q7CiAgICAgICAgaWYgKGMxID09IFN0cmluZy5jbGFzcyAmJiBp\nc1RlbXBvcmFsVHlwZShjMikpCiAgICAgICAgICAgIHJldHVybiB0cnVlOwog\nICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICAvKioKICAgICAqIENv\nbnZlcnQgdGhlIGdpdmVuIHZhbHVlIHRvIHRoZSBnaXZlbiB0eXBlLgogICAg\nICovCiAgICBwdWJsaWMgc3RhdGljIE9iamVjdCBjb252ZXJ0KE9iamVjdCBv\nLCBDbGFzczw/PiB0eXBlKSB7CiAgICAgICAgaWYgKG8gPT0gbnVsbCkKICAg\nICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgaWYgKG8uZ2V0Q2xhc3Mo\nKSA9PSB0eXBlKQogICAgICAgICAgICByZXR1cm4gbzsKCiAgICAgICAgdHlw\nZSA9IHdyYXAodHlwZSk7CiAgICAgICAgaWYgKHR5cGUuaXNBc3NpZ25hYmxl\nRnJvbShvLmdldENsYXNzKCkpKQogICAgICAgICAgICByZXR1cm4gbzsKCiAg\nICAgICAgLy8gdGhlIG5vbi1udW1lcmljIGNvbnZlcnNpb25zIHdlIGRvIGFy\nZSB0byBzdHJpbmcsIG9yIGZyb20KICAgICAgICAvLyBzdHJpbmcvY2hhciB0\nbyBudW1iZXIsIG9yIGNhbGVuZGFyL2RhdGUKICAgICAgICAvLyBTdHJpbmcg\ndG8gQm9vbGVhbgogICAgICAgIC8vIFN0cmluZyB0byBJbnRlZ2VyCiAgICAg\nICAgYm9vbGVhbiBudW0gPSBvIGluc3RhbmNlb2YgTnVtYmVyOwogICAgICAg\nIGlmICghbnVtKSB7CiAgICAgICAgICAgIGlmICh0eXBlID09IFN0cmluZy5j\nbGFzcykKICAgICAgICAgICAgICAgIHJldHVybiBvLnRvU3RyaW5nKCk7CiAg\nICAgICAgICAgIGVsc2UgaWYgKHR5cGUgPT0gQm9vbGVhbi5jbGFzcyAmJiBv\nIGluc3RhbmNlb2YgU3RyaW5nKSAKICAgICAgICAgICAgICAgIHJldHVybiBC\nb29sZWFuLnZhbHVlT2Yoby50b1N0cmluZygpKTsKICAgICAgICAgICAgZWxz\nZSBpZiAodHlwZSA9PSBJbnRlZ2VyLmNsYXNzICYmIG8gaW5zdGFuY2VvZiBT\ndHJpbmcpCiAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAg\nICAgIHJldHVybiBuZXcgSW50ZWdlcihvLnRvU3RyaW5nKCkpOwogICAgICAg\nICAgICAgICAgfSBjYXRjaCAoTnVtYmVyRm9ybWF0RXhjZXB0aW9uIGUpIHsK\nICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgQ2xhc3NDYXN0RXhjZXB0\naW9uKF9sb2MuZ2V0KCJjYW50LWNvbnZlcnQiLCBvLAogICAgICAgICAgICAg\nICAgICAgICAgICBvLmdldENsYXNzKCksIHR5cGUpLmdldE1lc3NhZ2UoKSk7\nCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgaWYgKHR5cGUg\nPT0gQ2hhcmFjdGVyLmNsYXNzKSB7CiAgICAgICAgICAgICAgICBTdHJpbmcg\nc3RyID0gby50b1N0cmluZygpOwogICAgICAgICAgICAgICAgaWYgKHN0ciAh\nPSBudWxsICYmIHN0ci5sZW5ndGgoKSA9PSAxKQogICAgICAgICAgICAgICAg\nICAgIHJldHVybiBuZXcgQ2hhcmFjdGVyKHN0ci5jaGFyQXQoMCkpOwogICAg\nICAgICAgICB9IGVsc2UgaWYgKENhbGVuZGFyLmNsYXNzLmlzQXNzaWduYWJs\nZUZyb20odHlwZSkgJiYKICAgICAgICAgICAgICAgIG8gaW5zdGFuY2VvZiBE\nYXRlKSB7CiAgICAgICAgICAgICAgICBDYWxlbmRhciBjYWwgPSBDYWxlbmRh\nci5nZXRJbnN0YW5jZSgpOwogICAgICAgICAgICAgICAgY2FsLnNldFRpbWUo\nKERhdGUpIG8pOwogICAgICAgICAgICAgICAgcmV0dXJuIGNhbDsKICAgICAg\nICAgICAgfSBlbHNlIGlmIChEYXRlLmNsYXNzLmlzQXNzaWduYWJsZUZyb20o\ndHlwZSkgJiYKICAgICAgICAgICAgICAgIG8gaW5zdGFuY2VvZiBDYWxlbmRh\ncikgewogICAgICAgICAgICAgICAgcmV0dXJuICgoQ2FsZW5kYXIpIG8pLmdl\ndFRpbWUoKTsKICAgICAgICAgICAgfSBlbHNlIGlmIChOdW1iZXIuY2xhc3Mu\naXNBc3NpZ25hYmxlRnJvbSh0eXBlKSkgewogICAgICAgICAgICAgICAgSW50\nZWdlciBpID0gbnVsbDsKICAgICAgICAgICAgICAgIGlmIChvIGluc3RhbmNl\nb2YgQ2hhcmFjdGVyKQogICAgICAgICAgICAgICAgICAgIGkgPSBOdW1iZXJz\nLnZhbHVlT2YoKChDaGFyYWN0ZXIpIG8pLmNoYXJWYWx1ZSgpKTsKICAgICAg\nICAgICAgICAgIGVsc2UgaWYgKG8gaW5zdGFuY2VvZiBTdHJpbmcgJiYgKChT\ndHJpbmcpIG8pLmxlbmd0aCgpID09IDEpCiAgICAgICAgICAgICAgICAgICAg\naSA9IE51bWJlcnMudmFsdWVPZigoKFN0cmluZykgbykuY2hhckF0KDApKTsK\nCiAgICAgICAgICAgICAgICBpZiAoaSAhPSBudWxsKSB7CiAgICAgICAgICAg\nICAgICAgICAgaWYgKHR5cGUgPT0gSW50ZWdlci5jbGFzcykKICAgICAgICAg\nICAgICAgICAgICAgICAgcmV0dXJuIGk7CiAgICAgICAgICAgICAgICAgICAg\nbnVtID0gdHJ1ZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBl\nbHNlIGlmIChvIGluc3RhbmNlb2YgU3RyaW5nICYmIGlzSkRCQ1RlbXBvcmFs\nU3ludGF4KG8udG9TdHJpbmcoKSkpIHsKICAgICAgICAgICAgICAgIHRyeSB7\nCiAgICAgICAgICAgICAgICAgICAgT2JqZWN0IHRlbXBvcmFsID0gcGFyc2VK\nREJDVGVtcG9yYWxTeW50YXgoby50b1N0cmluZygpKTsKICAgICAgICAgICAg\nICAgICAgICBpZiAodGVtcG9yYWwgIT0gbnVsbCAmJiB0eXBlLmlzQXNzaWdu\nYWJsZUZyb20odGVtcG9yYWwuZ2V0Q2xhc3MoKSkpCiAgICAgICAgICAgICAg\nICAgICAgICAgIHJldHVybiB0ZW1wb3JhbDsKICAgICAgICAgICAgICAgIH0g\nY2F0Y2ggKElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiBlKSB7CiAgICAgICAg\nICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0K\nICAgICAgICB9CiAgICAgICAgaWYgKCFudW0pCiAgICAgICAgICAgIHRocm93\nIG5ldyBDbGFzc0Nhc3RFeGNlcHRpb24oX2xvYy5nZXQoImNhbnQtY29udmVy\ndCIsIG8sCiAgICAgICAgICAgICAgICBvLmdldENsYXNzKCksIHR5cGUpLmdl\ndE1lc3NhZ2UoKSk7CgogICAgICAgIGlmICh0eXBlID09IEludGVnZXIuY2xh\nc3MpIHsKICAgICAgICAgICAgcmV0dXJuIE51bWJlcnMudmFsdWVPZigoKE51\nbWJlcikgbykuaW50VmFsdWUoKSk7CiAgICAgICAgfSBlbHNlIGlmICh0eXBl\nID09IEZsb2F0LmNsYXNzKSB7CiAgICAgICAgICAgIHJldHVybiBuZXcgRmxv\nYXQoKChOdW1iZXIpIG8pLmZsb2F0VmFsdWUoKSk7CiAgICAgICAgfSBlbHNl\nIGlmICh0eXBlID09IERvdWJsZS5jbGFzcykgewogICAgICAgICAgICByZXR1\ncm4gbmV3IERvdWJsZSgoKE51bWJlcikgbykuZG91YmxlVmFsdWUoKSk7CiAg\nICAgICAgfSBlbHNlIGlmICh0eXBlID09IExvbmcuY2xhc3MpIHsKICAgICAg\nICAgICAgcmV0dXJuIE51bWJlcnMudmFsdWVPZigoKE51bWJlcikgbykubG9u\nZ1ZhbHVlKCkpOwogICAgICAgIH0gZWxzZSBpZiAodHlwZSA9PSBCaWdEZWNp\nbWFsLmNsYXNzKSB7CiAgICAgICAgICAgIC8vIHRoZSBCaWdEZWNpbWFsIGNv\nbnN0cnVjdG9yIGRvZXNuJ3QgaGFuZGxlIHRoZQogICAgICAgICAgICAvLyAi\nTmFOIiBzdHJpbmcgdmVyc2lvbiBvZiBEb3VibGUuTmFOIGFuZCBGbG9hdC5O\nYU4sIG5vcgogICAgICAgICAgICAvLyBkb2VzIGl0IGhhbmRsZSBpbmZpbml0\neTsgd2UgbmVlZCB0byBpbnN0ZWFkIHVzZSB0aGUgRG91YmxlCiAgICAgICAg\nICAgIC8vIGFuZCBGbG9hdCB2ZXJzaW9ucywgZGVzcGl0ZSB3YW50aW5nIHRv\nIGNhc3QgaXQgdG8gQmlnRGVjaW1hbAogICAgICAgICAgICBkb3VibGUgZHZh\nbCA9ICgoTnVtYmVyKSBvKS5kb3VibGVWYWx1ZSgpOwogICAgICAgICAgICBp\nZiAoRG91YmxlLmlzTmFOKGR2YWwpIHx8IERvdWJsZS5pc0luZmluaXRlKGR2\nYWwpKQogICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBEb3VibGUoZHZhbCk7\nCgogICAgICAgICAgICBmbG9hdCBmdmFsID0gKChOdW1iZXIpIG8pLmZsb2F0\nVmFsdWUoKTsKICAgICAgICAgICAgaWYgKEZsb2F0LmlzTmFOKGZ2YWwpIHx8\nIEZsb2F0LmlzSW5maW5pdGUoZnZhbCkpCiAgICAgICAgICAgICAgICByZXR1\ncm4gbmV3IEZsb2F0KGZ2YWwpOwoKICAgICAgICAgICAgcmV0dXJuIG5ldyBC\naWdEZWNpbWFsKG8udG9TdHJpbmcoKSk7CiAgICAgICAgfSBlbHNlIGlmICh0\neXBlID09IEJpZ0ludGVnZXIuY2xhc3MpIHsKICAgICAgICAgICAgcmV0dXJu\nIG5ldyBCaWdJbnRlZ2VyKG8udG9TdHJpbmcoKSk7CiAgICAgICAgfSBlbHNl\nIGlmICh0eXBlID09IFNob3J0LmNsYXNzKSB7CiAgICAgICAgICAgIHJldHVy\nbiBuZXcgU2hvcnQoKChOdW1iZXIpIG8pLnNob3J0VmFsdWUoKSk7CiAgICAg\nICAgfSBlbHNlIGlmICh0eXBlID09IEJ5dGUuY2xhc3MpIHsKICAgICAgICAg\nICAgcmV0dXJuIG5ldyBCeXRlKCgoTnVtYmVyKSBvKS5ieXRlVmFsdWUoKSk7\nCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmV0dXJuIE51bWJlcnMu\ndmFsdWVPZigoKE51bWJlcikgbykuaW50VmFsdWUoKSk7CiAgICAgICAgfQog\nICAgfQoKICAgIC8qKgogICAgICogQWRkIHRoZSBnaXZlbiB2YWx1ZXMuCiAg\nICAgKi8KICAgIHB1YmxpYyBzdGF0aWMgT2JqZWN0IGFkZChPYmplY3QgbzEs\nIENsYXNzPD8+IGMxLCBPYmplY3QgbzIsIENsYXNzPD8+IGMyKSB7CiAgICAg\nICAgcmV0dXJuIG9wKG8xLCBjMSwgbzIsIGMyLCBPUF9BREQpOwogICAgfQoK\nICAgIC8qKgogICAgICogU3VidHJhY3QgdGhlIGdpdmVuIHZhbHVlcy4KICAg\nICAqLwogICAgcHVibGljIHN0YXRpYyBPYmplY3Qgc3VidHJhY3QoT2JqZWN0\nIG8xLCBDbGFzczw/PiBjMSwgT2JqZWN0IG8yLCBDbGFzczw/PiBjMikgewog\nICAgICAgIHJldHVybiBvcChvMSwgYzEsIG8yLCBjMiwgT1BfU1VCVFJBQ1Qp\nOwogICAgfQoKICAgIC8qKgogICAgICogTXVsdGlwbHkgdGhlIGdpdmVuIHZh\nbHVlcy4KICAgICAqLwogICAgcHVibGljIHN0YXRpYyBPYmplY3QgbXVsdGlw\nbHkoT2JqZWN0IG8xLCBDbGFzczw/PiBjMSwgT2JqZWN0IG8yLCBDbGFzczw/\nPiBjMikgewogICAgICAgIHJldHVybiBvcChvMSwgYzEsIG8yLCBjMiwgT1Bf\nTVVMVElQTFkpOwogICAgfQoKICAgIC8qKgogICAgICogRGl2aWRlIHRoZSBn\naXZlbiB2YWx1ZXMuCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0aWMgT2JqZWN0\nIGRpdmlkZShPYmplY3QgbzEsIENsYXNzPD8+IGMxLCBPYmplY3QgbzIsIENs\nYXNzPD8+IGMyKSB7CiAgICAgICAgcmV0dXJuIG9wKG8xLCBjMSwgbzIsIGMy\nLCBPUF9ESVZJREUpOwogICAgfQoKICAgIC8qKgogICAgICogTW9kIHRoZSBn\naXZlbiB2YWx1ZXMuCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0aWMgT2JqZWN0\nIG1vZChPYmplY3QgbzEsIENsYXNzPD8+IGMxLCBPYmplY3QgbzIsIENsYXNz\nPD8+IGMyKSB7CiAgICAgICAgcmV0dXJuIG9wKG8xLCBjMSwgbzIsIGMyLCBP\nUF9NT0QpOwogICAgfQoKICAgIC8qKgogICAgICogUGVyZm9ybSB0aGUgZ2l2\nZW4gb3BlcmF0aW9uIG9uIHR3byBudW1iZXJzLgogICAgICovCiAgICBwcml2\nYXRlIHN0YXRpYyBPYmplY3Qgb3AoT2JqZWN0IG8xLCBDbGFzczw/PiBjMSwg\nT2JqZWN0IG8yLCBDbGFzczw/PiBjMiwgaW50IG9wKSB7CiAgICAgICAgQ2xh\nc3M8Pz4gcHJvbW90ZSA9IHByb21vdGUoYzEsIGMyKTsKICAgICAgICBpZiAo\ncHJvbW90ZSA9PSBpbnQuY2xhc3MpIHsKICAgICAgICAgICAgaW50IG4xID0g\nKG8xID09IG51bGwpID8gMCA6ICgoTnVtYmVyKSBvMSkuaW50VmFsdWUoKTsK\nICAgICAgICAgICAgaW50IG4yID0gKG8yID09IG51bGwpID8gMCA6ICgoTnVt\nYmVyKSBvMikuaW50VmFsdWUoKTsKICAgICAgICAgICAgcmV0dXJuIG9wKG4x\nLCBuMiwgb3ApOwogICAgICAgIH0KICAgICAgICBpZiAocHJvbW90ZSA9PSBm\nbG9hdC5jbGFzcykgewogICAgICAgICAgICBmbG9hdCBuMSA9IChvMSA9PSBu\ndWxsKSA/IDBGIDogKChOdW1iZXIpIG8xKS5mbG9hdFZhbHVlKCk7CiAgICAg\nICAgICAgIGZsb2F0IG4yID0gKG8yID09IG51bGwpID8gMEYgOiAoKE51bWJl\ncikgbzIpLmZsb2F0VmFsdWUoKTsKICAgICAgICAgICAgcmV0dXJuIG9wKG4x\nLCBuMiwgb3ApOwogICAgICAgIH0KICAgICAgICBpZiAocHJvbW90ZSA9PSBk\nb3VibGUuY2xhc3MpIHsKICAgICAgICAgICAgZG91YmxlIG4xID0gKG8xID09\nIG51bGwpID8gMEQgOiAoKE51bWJlcikgbzEpLmRvdWJsZVZhbHVlKCk7CiAg\nICAgICAgICAgIGRvdWJsZSBuMiA9IChvMiA9PSBudWxsKSA/IDBEIDogKChO\ndW1iZXIpIG8yKS5kb3VibGVWYWx1ZSgpOwogICAgICAgICAgICByZXR1cm4g\nb3AobjEsIG4yLCBvcCk7CiAgICAgICAgfQogICAgICAgIGlmIChwcm9tb3Rl\nID09IGxvbmcuY2xhc3MpIHsKICAgICAgICAgICAgbG9uZyBuMSA9IChvMSA9\nPSBudWxsKSA/IDBMIDogKChOdW1iZXIpIG8xKS5sb25nVmFsdWUoKTsKICAg\nICAgICAgICAgbG9uZyBuMiA9IChvMiA9PSBudWxsKSA/IDBMIDogKChOdW1i\nZXIpIG8yKS5sb25nVmFsdWUoKTsKICAgICAgICAgICAgcmV0dXJuIG9wKG4x\nLCBuMiwgb3ApOwogICAgICAgIH0KICAgICAgICBpZiAocHJvbW90ZSA9PSBC\naWdEZWNpbWFsLmNsYXNzKSB7CiAgICAgICAgICAgIEJpZ0RlY2ltYWwgbjEg\nPSAobzEgPT0gbnVsbCkgPyBaRVJPX0JJR0RFQ0lNQUwKICAgICAgICAgICAg\nICAgIDogKEJpZ0RlY2ltYWwpIGNvbnZlcnQobzEsIHByb21vdGUpOwogICAg\nICAgICAgICBCaWdEZWNpbWFsIG4yID0gKG8yID09IG51bGwpID8gWkVST19C\nSUdERUNJTUFMCiAgICAgICAgICAgICAgICA6IChCaWdEZWNpbWFsKSBjb252\nZXJ0KG8yLCBwcm9tb3RlKTsKICAgICAgICAgICAgcmV0dXJuIG9wKG4xLCBu\nMiwgb3ApOwogICAgICAgIH0KICAgICAgICBpZiAocHJvbW90ZSA9PSBCaWdJ\nbnRlZ2VyLmNsYXNzKSB7CiAgICAgICAgICAgIEJpZ0ludGVnZXIgbjEgPSAo\nbzEgPT0gbnVsbCkgPyBaRVJPX0JJR0lOVEVHRVIKICAgICAgICAgICAgICAg\nIDogKEJpZ0ludGVnZXIpIGNvbnZlcnQobzEsIHByb21vdGUpOwogICAgICAg\nICAgICBCaWdJbnRlZ2VyIG4yID0gKG8yID09IG51bGwpID8gWkVST19CSUdJ\nTlRFR0VSCiAgICAgICAgICAgICAgICA6IChCaWdJbnRlZ2VyKSBjb252ZXJ0\nKG8yLCBwcm9tb3RlKTsKICAgICAgICAgICAgcmV0dXJuIG9wKG4xLCBuMiwg\nb3ApOwogICAgICAgIH0KICAgICAgICAvLyBkZWZhdWx0IHRvIGludAogICAg\nICAgIGludCBuMSA9IChvMSA9PSBudWxsKSA/IDAgOiAoKE51bWJlcikgbzEp\nLmludFZhbHVlKCk7CiAgICAgICAgaW50IG4yID0gKG8yID09IG51bGwpID8g\nMCA6ICgoTnVtYmVyKSBvMikuaW50VmFsdWUoKTsKICAgICAgICByZXR1cm4g\nb3AobjEsIG4yLCBvcCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4g\ndGhlIHJlc3VsdCBvZiBhIG1hdGhlbWF0aWNhbCBvcGVyYXRpb24uCiAgICAg\nKi8KICAgIHByaXZhdGUgc3RhdGljIE9iamVjdCBvcChpbnQgbjEsIGludCBu\nMiwgaW50IG9wKSB7CiAgICAgICAgaW50IHRvdDsKICAgICAgICBzd2l0Y2gg\nKG9wKSB7CiAgICAgICAgICAgIGNhc2UgT1BfQUREOgogICAgICAgICAgICAg\nICAgdG90ID0gbjEgKyBuMjsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAg\nICAgICAgICBjYXNlIE9QX1NVQlRSQUNUOgogICAgICAgICAgICAgICAgdG90\nID0gbjEgLSBuMjsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAg\nICBjYXNlIE9QX01VTFRJUExZOgogICAgICAgICAgICAgICAgdG90ID0gbjEg\nKiBuMjsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNl\nIE9QX0RJVklERToKICAgICAgICAgICAgICAgIHRvdCA9IG4xIC8gbjI7CiAg\nICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSBPUF9NT0Q6\nCiAgICAgICAgICAgICAgICB0b3QgPSBuMSAlIG4yOwogICAgICAgICAgICAg\nICAgYnJlYWs7CiAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAg\nICB0aHJvdyBuZXcgSW50ZXJuYWxFeGNlcHRpb24oKTsKICAgICAgICB9CiAg\nICAgICAgcmV0dXJuIE51bWJlcnMudmFsdWVPZih0b3QpOwogICAgfQoKICAg\nIC8qKgogICAgICogUmV0dXJuIHRoZSByZXN1bHQgb2YgYSBtYXRoZW1hdGlj\nYWwgb3BlcmF0aW9uLgogICAgICovCiAgICBwcml2YXRlIHN0YXRpYyBPYmpl\nY3Qgb3AoZmxvYXQgbjEsIGZsb2F0IG4yLCBpbnQgb3ApIHsKICAgICAgICBm\nbG9hdCB0b3Q7CiAgICAgICAgc3dpdGNoIChvcCkgewogICAgICAgICAgICBj\nYXNlIE9QX0FERDoKICAgICAgICAgICAgICAgIHRvdCA9IG4xICsgbjI7CiAg\nICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSBPUF9TVUJU\nUkFDVDoKICAgICAgICAgICAgICAgIHRvdCA9IG4xIC0gbjI7CiAgICAgICAg\nICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSBPUF9NVUxUSVBMWToK\nICAgICAgICAgICAgICAgIHRvdCA9IG4xICogbjI7CiAgICAgICAgICAgICAg\nICBicmVhazsKICAgICAgICAgICAgY2FzZSBPUF9ESVZJREU6CiAgICAgICAg\nICAgICAgICB0b3QgPSBuMSAvIG4yOwogICAgICAgICAgICAgICAgYnJlYWs7\nCiAgICAgICAgICAgIGNhc2UgT1BfTU9EOgogICAgICAgICAgICAgICAgdG90\nID0gbjEgJSBuMjsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAg\nICBkZWZhdWx0OgogICAgICAgICAgICAgICAgdGhyb3cgbmV3IEludGVybmFs\nRXhjZXB0aW9uKCk7CiAgICAgICAgfQogICAgICAgIHJldHVybiBuZXcgRmxv\nYXQodG90KTsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgcmVz\ndWx0IG9mIGEgbWF0aGVtYXRpY2FsIG9wZXJhdGlvbi4KICAgICAqLwogICAg\ncHJpdmF0ZSBzdGF0aWMgT2JqZWN0IG9wKGRvdWJsZSBuMSwgZG91YmxlIG4y\nLCBpbnQgb3ApIHsKICAgICAgICBkb3VibGUgdG90OwogICAgICAgIHN3aXRj\naCAob3ApIHsKICAgICAgICAgICAgY2FzZSBPUF9BREQ6CiAgICAgICAgICAg\nICAgICB0b3QgPSBuMSArIG4yOwogICAgICAgICAgICAgICAgYnJlYWs7CiAg\nICAgICAgICAgIGNhc2UgT1BfU1VCVFJBQ1Q6CiAgICAgICAgICAgICAgICB0\nb3QgPSBuMSAtIG4yOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAg\nICAgIGNhc2UgT1BfTVVMVElQTFk6CiAgICAgICAgICAgICAgICB0b3QgPSBu\nMSAqIG4yOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNh\nc2UgT1BfRElWSURFOgogICAgICAgICAgICAgICAgdG90ID0gbjEgLyBuMjsK\nICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIE9QX01P\nRDoKICAgICAgICAgICAgICAgIHRvdCA9IG4xICUgbjI7CiAgICAgICAgICAg\nICAgICBicmVhazsKICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAg\nICAgIHRocm93IG5ldyBJbnRlcm5hbEV4Y2VwdGlvbigpOwogICAgICAgIH0K\nICAgICAgICByZXR1cm4gbmV3IERvdWJsZSh0b3QpOwogICAgfQoKICAgIC8q\nKgogICAgICogUmV0dXJuIHRoZSByZXN1bHQgb2YgYSBtYXRoZW1hdGljYWwg\nb3BlcmF0aW9uLgogICAgICovCiAgICBwcml2YXRlIHN0YXRpYyBPYmplY3Qg\nb3AobG9uZyBuMSwgbG9uZyBuMiwgaW50IG9wKSB7CiAgICAgICAgbG9uZyB0\nb3Q7CiAgICAgICAgc3dpdGNoIChvcCkgewogICAgICAgICAgICBjYXNlIE9Q\nX0FERDoKICAgICAgICAgICAgICAgIHRvdCA9IG4xICsgbjI7CiAgICAgICAg\nICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSBPUF9TVUJUUkFDVDoK\nICAgICAgICAgICAgICAgIHRvdCA9IG4xIC0gbjI7CiAgICAgICAgICAgICAg\nICBicmVhazsKICAgICAgICAgICAgY2FzZSBPUF9NVUxUSVBMWToKICAgICAg\nICAgICAgICAgIHRvdCA9IG4xICogbjI7CiAgICAgICAgICAgICAgICBicmVh\nazsKICAgICAgICAgICAgY2FzZSBPUF9ESVZJREU6CiAgICAgICAgICAgICAg\nICB0b3QgPSBuMSAvIG4yOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAg\nICAgICAgIGNhc2UgT1BfTU9EOgogICAgICAgICAgICAgICAgdG90ID0gbjEg\nJSBuMjsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBkZWZh\ndWx0OgogICAgICAgICAgICAgICAgdGhyb3cgbmV3IEludGVybmFsRXhjZXB0\naW9uKCk7CiAgICAgICAgfQogICAgICAgIHJldHVybiBOdW1iZXJzLnZhbHVl\nT2YodG90KTsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgcmVz\ndWx0IG9mIGEgbWF0aGVtYXRpY2FsIG9wZXJhdGlvbi4KICAgICAqLwogICAg\ncHJpdmF0ZSBzdGF0aWMgT2JqZWN0IG9wKEJpZ0RlY2ltYWwgbjEsIEJpZ0Rl\nY2ltYWwgbjIsIGludCBvcCkgewogICAgICAgIHN3aXRjaCAob3ApIHsKICAg\nICAgICAgICAgY2FzZSBPUF9BREQ6CiAgICAgICAgICAgICAgICByZXR1cm4g\nbjEuYWRkKG4yKTsKICAgICAgICAgICAgY2FzZSBPUF9TVUJUUkFDVDoKICAg\nICAgICAgICAgICAgIHJldHVybiBuMS5zdWJ0cmFjdChuMik7CiAgICAgICAg\nICAgIGNhc2UgT1BfTVVMVElQTFk6CiAgICAgICAgICAgICAgICByZXR1cm4g\nbjEubXVsdGlwbHkobjIpOwogICAgICAgICAgICBjYXNlIE9QX0RJVklERToK\nICAgICAgICAgICAgICAgIGludCBzY2FsZSA9IE1hdGgubWF4KG4xLnNjYWxl\nKCksIG4yLnNjYWxlKCkpOwogICAgICAgICAgICAgICAgcmV0dXJuIG4xLmRp\ndmlkZShuMiwgc2NhbGUsIEJpZ0RlY2ltYWwuUk9VTkRfSEFMRl9VUCk7CiAg\nICAgICAgICAgIGNhc2UgT1BfTU9EOgogICAgICAgICAgICAgICAgdGhyb3cg\nbmV3IFVzZXJFeGNlcHRpb24oX2xvYy5nZXQoIm1vZC1iaWdkZWNpbWFsIikp\nOwogICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgICAgdGhyb3cg\nbmV3IEludGVybmFsRXhjZXB0aW9uKCk7CiAgICAgICAgfQogICAgfQoKICAg\nIC8qKgogICAgICogUmV0dXJuIHRoZSByZXN1bHQgb2YgYSBtYXRoZW1hdGlj\nYWwgb3BlcmF0aW9uLgogICAgICovCiAgICBwcml2YXRlIHN0YXRpYyBPYmpl\nY3Qgb3AoQmlnSW50ZWdlciBuMSwgQmlnSW50ZWdlciBuMiwgaW50IG9wKSB7\nCiAgICAgICAgc3dpdGNoIChvcCkgewogICAgICAgICAgICBjYXNlIE9QX0FE\nRDoKICAgICAgICAgICAgICAgIHJldHVybiBuMS5hZGQobjIpOwogICAgICAg\nICAgICBjYXNlIE9QX1NVQlRSQUNUOgogICAgICAgICAgICAgICAgcmV0dXJu\nIG4xLnN1YnRyYWN0KG4yKTsKICAgICAgICAgICAgY2FzZSBPUF9NVUxUSVBM\nWToKICAgICAgICAgICAgICAgIHJldHVybiBuMS5tdWx0aXBseShuMik7CiAg\nICAgICAgICAgIGNhc2UgT1BfRElWSURFOgogICAgICAgICAgICAgICAgcmV0\ndXJuIG4xLmRpdmlkZShuMik7CiAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAg\nICAgICAgICAgICB0aHJvdyBuZXcgSW50ZXJuYWxFeGNlcHRpb24oKTsKICAg\nICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBQYXJzZXMgdGhlIGdpdmVu\nIGRlY2xhcmF0aW9ucyBpbnRvIGEgbGlzdCBvZiB0eXBlLCBuYW1lLCB0eXBl\nLCBuYW1lLi4uCiAgICAgKiBSZXR1cm5zIG51bGwgaWYgbm8gZGVjbGFyYXRp\nb25zLiBBc3N1bWVzIGRlY2xhcmF0aW9uIGlzIG5vdCBhbiBlbXB0eQogICAg\nICogc3RyaW5nIGFuZCBpcyBhbHJlYWR5IHRyaW1tZWQgKHZhbGlkIGFzc3Vt\ncHRpb25zIGdpdmVuIHRoZSBjaGVja3MgbWFkZQogICAgICogaW4gb3VyIHNl\ndHRlcnMpLgogICAgICoKICAgICAqIEBwYXJhbSBkZWNUeXBlIHRoZSB0eXBl\nIG9mIGRlY2xhcmF0aW9uIGJlaW5nIHBhcnNlZCwgZm9yIHVzZSBpbgogICAg\nICogZXJyb3IgbWVzc2FnZXMKICAgICAqLwogICAgcHVibGljIHN0YXRpYyBM\naXN0PFN0cmluZz4gcGFyc2VEZWNsYXJhdGlvbihTdHJpbmcgZGVjLCBjaGFy\nIHNwbGl0LCBTdHJpbmcgZGVjVHlwZSkgewogICAgICAgIGlmIChkZWMgPT0g\nbnVsbCkKICAgICAgICAgICAgcmV0dXJuIG51bGw7CgogICAgICAgIC8vIHdh\ndGNoIGZvciBjb21tb24gbWl4dXBzIGJldHdlZW4gY29tbWFzIGFuZCBzZW1p\ncwogICAgICAgIGNoYXIgYmFkID0gKGNoYXIpIDA7CiAgICAgICAgaWYgKHNw\nbGl0ID09ICcsJykKICAgICAgICAgICAgYmFkID0gJzsnOwogICAgICAgIGVs\nc2UgaWYgKHNwbGl0ID09ICc7JykKICAgICAgICAgICAgYmFkID0gJywnOwoK\nICAgICAgICBjaGFyIHNlbnRpbmFsID0gJyAnOwogICAgICAgIGNoYXIgY3Vy\nOwogICAgICAgIGludCBzdGFydCA9IDA7CiAgICAgICAgYm9vbGVhbiBza2lw\nU3BhY2UgPSBmYWxzZTsKICAgICAgICBMaXN0PFN0cmluZz4gcmVzdWx0cyA9\nIG5ldyBBcnJheUxpc3Q8U3RyaW5nPig2KTsKICAgICAgICBmb3IgKGludCBp\nID0gMDsgaSA8IGRlYy5sZW5ndGgoKTsgaSsrKSB7CiAgICAgICAgICAgIGN1\nciA9IGRlYy5jaGFyQXQoaSk7CiAgICAgICAgICAgIGlmIChjdXIgPT0gYmFk\nKQogICAgICAgICAgICAgICAgdGhyb3cgbmV3IFVzZXJFeGNlcHRpb24oX2xv\nYy5nZXQoImJhZC1kZWMiLCBkZWMsIGRlY1R5cGUpKTsKICAgICAgICAgICAg\naWYgKGN1ciA9PSAnICcgJiYgc2tpcFNwYWNlKSB7CiAgICAgICAgICAgICAg\nICBzdGFydCsrOwogICAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAg\nICAgIH0KCiAgICAgICAgICAgIHNraXBTcGFjZSA9IGZhbHNlOwogICAgICAg\nICAgICBpZiAoY3VyICE9IHNlbnRpbmFsKQogICAgICAgICAgICAgICAgY29u\ndGludWU7CgogICAgICAgICAgICAvLyBpZiBsb29raW5nIGZvciBzcGFjZXMs\nIGxvb2sgZm9yIHNwbGl0IGNoYXIsIG9yIHZpY2UgdmVyc2EKICAgICAgICAg\nICAgc2VudGluYWwgPSAoc2VudGluYWwgPT0gJyAnKSA/IHNwbGl0IDogJyAn\nOwogICAgICAgICAgICByZXN1bHRzLmFkZChkZWMuc3Vic3RyaW5nKHN0YXJ0\nLCBpKS50cmltKCkpOwogICAgICAgICAgICBzdGFydCA9IGkgKyAxOwogICAg\nICAgICAgICBza2lwU3BhY2UgPSB0cnVlOwogICAgICAgIH0KCiAgICAgICAg\nLy8gYWRkIGxhc3QgdG9rZW4sIGlmIGFueQogICAgICAgIGlmIChzdGFydCA8\nIGRlYy5sZW5ndGgoKSkKICAgICAgICAgICAgcmVzdWx0cy5hZGQoZGVjLnN1\nYnN0cmluZyhzdGFydCkpOwoKICAgICAgICAvLyBpZiBub3QgYW4gZXZlbiBu\ndW1iZXIgb2YgZWxlbWVudHMsIHNvbWV0aGluZyBpcyB3cm9uZwogICAgICAg\nIGlmIChyZXN1bHRzLmlzRW1wdHkoKSB8fCByZXN1bHRzLnNpemUoKSAlIDIg\nIT0gMCkKICAgICAgICAgICAgdGhyb3cgbmV3IFVzZXJFeGNlcHRpb24oX2xv\nYy5nZXQoImJhZC1kZWMiLCBkZWMsIGRlY1R5cGUpKTsKCiAgICAgICAgcmV0\ndXJuIHJlc3VsdHM7CiAgICB9CgogICAgLyoqCiAgICAgKiBTcGxpdCB0aGUg\nZ2l2ZW4gZXhwcmVzc2lvbiBsaXN0IGludG8gZGlzdGluY3QgZXhwcmVzc2lv\nbnMuIEFzc3VtZXMgdGhlCiAgICAgKiBnaXZlbiBzdHJpbmcgaXMgbm90IG51\nbGwgb3Igb2YgemVybyBsZW5ndGggYW5kIGlzIGFscmVhZHkgdHJpbW1lZAog\nICAgICogKHZhbGlkIGFzc3VtcHRpb25zIGdpdmVuIHRoZSBjaGVja3MgaW4g\nb3VyIHNldHRlcnMgYW5kIGJlZm9yZQogICAgICogdGhpcyBtZXRob2QgY2Fs\nbCkuCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0aWMgTGlzdDxTdHJpbmc+IHNw\nbGl0RXhwcmVzc2lvbnMoU3RyaW5nIHN0ciwgY2hhciBzcGxpdCwgaW50IGV4\ncGVjdGVkKSB7CiAgICAgICAgaWYgKHN0ciA9PSBudWxsKQogICAgICAgICAg\nICByZXR1cm4gbnVsbDsKCiAgICAgICAgTGlzdDxTdHJpbmc+IGV4cHMgPSBu\ndWxsOwogICAgICAgIGludCBwYXJlbkRlcHRoID0gMDsKICAgICAgICBpbnQg\nYmVnaW4gPSAwLCBwb3MgPSAwOwogICAgICAgIGJvb2xlYW4gZXNjYXBlID0g\nZmFsc2U7CiAgICAgICAgYm9vbGVhbiBzdHJpbmcgPSBmYWxzZTsKICAgICAg\nICBib29sZWFuIG5vbnNwYWNlID0gZmFsc2U7CiAgICAgICAgY2hhciBxdW90\nZSA9IDA7CiAgICAgICAgZm9yIChjaGFyIGM7IHBvcyA8IHN0ci5sZW5ndGgo\nKTsgcG9zKyspIHsKICAgICAgICAgICAgYyA9IHN0ci5jaGFyQXQocG9zKTsK\nICAgICAgICAgICAgaWYgKGMgPT0gJ1xcJykgewogICAgICAgICAgICAgICAg\nZXNjYXBlID0gIWVzY2FwZTsKICAgICAgICAgICAgICAgIGNvbnRpbnVlOwog\nICAgICAgICAgICB9CiAgICAgICAgICAgIGlmIChlc2NhcGUpIHsKICAgICAg\nICAgICAgICAgIGVzY2FwZSA9IGZhbHNlOwogICAgICAgICAgICAgICAgY29u\ndGludWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHN3aXRjaCAoYykg\newogICAgICAgICAgICAgICAgY2FzZSAnXCcnOgogICAgICAgICAgICAgICAg\nY2FzZSAnIic6CiAgICAgICAgICAgICAgICAgICAgaWYgKHN0cmluZyAmJiBx\ndW90ZSA9PSBjKQogICAgICAgICAgICAgICAgICAgICAgICBzdHJpbmcgPSBm\nYWxzZTsKICAgICAgICAgICAgICAgICAgICBlbHNlIGlmICghc3RyaW5nKSB7\nCiAgICAgICAgICAgICAgICAgICAgICAgIHF1b3RlID0gYzsKICAgICAgICAg\nICAgICAgICAgICAgICAgc3RyaW5nID0gdHJ1ZTsKICAgICAgICAgICAgICAg\nICAgICB9CiAgICAgICAgICAgICAgICAgICAgbm9uc3BhY2UgPSB0cnVlOwog\nICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2Fz\nZSAnKCc6CiAgICAgICAgICAgICAgICAgICAgaWYgKCFzdHJpbmcpCiAgICAg\nICAgICAgICAgICAgICAgICAgIHBhcmVuRGVwdGgrKzsKICAgICAgICAgICAg\nICAgICAgICBub25zcGFjZSA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAg\nYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlICcpJzoKICAgICAgICAgICAg\nICAgICAgICBpZiAoIXN0cmluZykKICAgICAgICAgICAgICAgICAgICAgICAg\ncGFyZW5EZXB0aC0tOwogICAgICAgICAgICAgICAgICAgIG5vbnNwYWNlID0g\ndHJ1ZTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAg\nICAgIGNhc2UgJyAnOgogICAgICAgICAgICAgICAgY2FzZSAnXHQnOgogICAg\nICAgICAgICAgICAgY2FzZSAnXG4nOgogICAgICAgICAgICAgICAgY2FzZSAn\nXHInOgogICAgICAgICAgICAgICAgICAgIGlmIChjID09IHNwbGl0ICYmICFz\ndHJpbmcgJiYgcGFyZW5EZXB0aCA9PSAwICYmIG5vbnNwYWNlKSB7CiAgICAg\nICAgICAgICAgICAgICAgICAgIGlmIChleHBzID09IG51bGwpCiAgICAgICAg\nICAgICAgICAgICAgICAgICAgICBleHBzID0gbmV3IEFycmF5TGlzdDxTdHJp\nbmc+KGV4cGVjdGVkKTsKICAgICAgICAgICAgICAgICAgICAgICAgZXhwcy5h\nZGQoc3RyLnN1YnN0cmluZyhiZWdpbiwgcG9zKS50cmltKCkpOwogICAgICAg\nICAgICAgICAgICAgICAgICBiZWdpbiA9IHBvcyArIDE7CiAgICAgICAgICAg\nICAgICAgICAgICAgIG5vbnNwYWNlID0gZmFsc2U7CiAgICAgICAgICAgICAg\nICAgICAgfQogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAg\nICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAgICAgICBpZiAoYyA9PSBz\ncGxpdCAmJiAhc3RyaW5nICYmIHBhcmVuRGVwdGggPT0gMCkgewogICAgICAg\nICAgICAgICAgICAgICAgICBpZiAoZXhwcyA9PSBudWxsKQogICAgICAgICAg\nICAgICAgICAgICAgICAgICAgZXhwcyA9IG5ldyBBcnJheUxpc3Q8U3RyaW5n\nPihleHBlY3RlZCk7CiAgICAgICAgICAgICAgICAgICAgICAgIGV4cHMuYWRk\nKHN0ci5zdWJzdHJpbmcoYmVnaW4sIHBvcykudHJpbSgpKTsKICAgICAgICAg\nICAgICAgICAgICAgICAgYmVnaW4gPSBwb3MgKyAxOwogICAgICAgICAgICAg\nICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBub25zcGFjZSA9IHRydWU7\nCiAgICAgICAgICAgIH0KICAgICAgICAgICAgZXNjYXBlID0gZmFsc2U7CiAg\nICAgICAgfQoKICAgICAgICBpZiAoZXhwcyA9PSBudWxsKSB7CiAgICAgICAg\nICAgIGV4cHMgPSBDb2xsZWN0aW9ucy5zaW5nbGV0b25MaXN0KHN0cik7CiAg\nICAgICAgICAgIHJldHVybiBleHBzOwogICAgICAgIH0KCiAgICAgICAgLy8g\nYWRkIGxhc3QgZXhwcmVzc2lvbiBhbmQgcmV0dXJuIGFycmF5CiAgICAgICAg\nU3RyaW5nIGxhc3QgPSBzdHIuc3Vic3RyaW5nKGJlZ2luKS50cmltKCk7CiAg\nICAgICAgaWYgKGxhc3QubGVuZ3RoKCkgPiAwKQogICAgICAgICAgICBleHBz\nLmFkZChsYXN0KTsKICAgICAgICByZXR1cm4gZXhwczsKICAgIH0KCiAgICAv\nKioKICAgICAqIEFkZCB0aGUgZ2l2ZW4gYWNjZXNzIHBhdGggbWV0YWRhdGFz\nIHRvIHRoZSBmdWxsIHBhdGggbGlzdCwgbWFraW5nIHN1cmUKICAgICAqIHRv\nIG1haW50YWluIG9ubHkgYmFzZSBtZXRhZGF0YXMgaW4gdGhlIGxpc3QuIFRo\nZSBnaXZlbiBsaXN0IG1heSBiZSBudWxsLgogICAgICovCiAgICBwdWJsaWMg\nc3RhdGljIExpc3Q8Q2xhc3NNZXRhRGF0YT4gYWRkQWNjZXNzUGF0aE1ldGFE\nYXRhcyhMaXN0PENsYXNzTWV0YURhdGE+IG1ldGFzLCBDbGFzc01ldGFEYXRh\nW10gcGF0aCkgewogICAgICAgIGlmIChwYXRoID09IG51bGwgfHwgcGF0aC5s\nZW5ndGggPT0gMCkKICAgICAgICAgICAgcmV0dXJuIG1ldGFzOwoKICAgICAg\nICAvLyBjcmVhdGUgc2V0IG9mIGJhc2UgY2xhc3MgbWV0YWRhdGFzIGluIGFj\nY2VzcyBwYXRoCiAgICAgICAgaWYgKG1ldGFzID09IG51bGwpCiAgICAgICAg\nICAgIG1ldGFzID0gbmV3IEFycmF5TGlzdDxDbGFzc01ldGFEYXRhPigpOwog\nICAgICAgIGludCBsYXN0ID0gbWV0YXMuc2l6ZSgpOwoKICAgICAgICAvLyBm\nb3IgZXZlcnkgZWxlbWVudCBpbiB0aGUgcGF0aCBvZiB0aGlzIGV4ZWN1dG9y\nLCBjb21wYXJlIGl0CiAgICAgICAgLy8gdG8gYWxyZWFkeS1nYXRoZXJlZCBl\nbGVtZW50cyB0byBzZWUgaWYgaXQgc2hvdWxkIHJlcGxhY2UKICAgICAgICAv\nLyBhIHN1YmNsYXNzIGluIHRoZSBsaXN0IG9yIHNob3VsZCBiZSBhZGRlZCBh\ncyBhIG5ldyBiYXNlOwogICAgICAgIC8vIGF0IGxlYXN0IGl0J3Mgbl4yIG9m\nIGEgc21hbGwgbi4uLgogICAgICAgIENsYXNzTWV0YURhdGEgbWV0YTsKICAg\nICAgICBib29sZWFuIGFkZDsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8\nIHBhdGgubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgYWRkID0gdHJ1ZTsK\nICAgICAgICAgICAgZm9yIChpbnQgaiA9IDA7IGFkZCAmJiBqIDwgbGFzdDsg\naisrKSB7CiAgICAgICAgICAgICAgICBtZXRhID0gbWV0YXMuZ2V0KGopOwoK\nICAgICAgICAgICAgICAgIGlmIChtZXRhLmdldERlc2NyaWJlZFR5cGUoKS5p\nc0Fzc2lnbmFibGVGcm9tKHBhdGhbaV0uZ2V0RGVzY3JpYmVkVHlwZSgpKSkg\newogICAgICAgICAgICAgICAgICAgIC8vIGxpc3QgYWxyZWFkeSBjb250YWlu\ncyBiYXNlIGNsYXNzCiAgICAgICAgICAgICAgICAgICAgYWRkID0gZmFsc2U7\nCiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHBhdGhbaV0uZ2V0RGVzY3Jp\nYmVkVHlwZSgpLmlzQXNzaWduYWJsZUZyb20obWV0YS5nZXREZXNjcmliZWRU\neXBlKCkpKSB7CiAgICAgICAgICAgICAgICAgICAgLy8gdGhpcyBlbGVtZW50\nIHJlcGxhY2VzIGl0cyBzdWJjbGFzcwogICAgICAgICAgICAgICAgICAgIGFk\nZCA9IGZhbHNlOwogICAgICAgICAgICAgICAgICAgIG1ldGFzLnNldChqLCBw\nYXRoW2ldKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAg\nICAgICAgICAgLy8gaWYgbm8gYmFzZSBjbGFzcyBvZiBjdXJyZW50IHBhdGgg\nZWxlbWVudCBhbHJlYWR5IGluCiAgICAgICAgICAgIC8vIGxpc3QgYW5kIHBh\ndGggZWxlbWVudCBkaWRuJ3QgcmVwbGFjZSBhIHN1YmNsYXNzIGluIHRoZQog\nICAgICAgICAgICAvLyBsaXN0LCB0aGVuIGFkZCBpdCBub3cgYXMgYSBuZXcg\nYmFzZQogICAgICAgICAgICBpZiAoYWRkKQogICAgICAgICAgICAgICAgbWV0\nYXMuYWRkKHBhdGhbaV0pOwogICAgICAgIH0KICAgICAgICByZXR1cm4gbWV0\nYXM7CiAgICB9CgogICAgLyoqCiAgICAgKiBDb252ZXJ0IHRoZSB1c2VyLWdp\ndmVuIGhpbnQgdmFsdWUgdG8gYW4gYWdncmVnYXRlIGxpc3RlbmVyLgogICAg\nICogVGhlIGhpbnQgY2FuIGJlIGFuIGFnZ3JlZ2F0ZSBsaXN0ZW5lciBpbnN0\nYW5jZSBvciBjbGFzcyBuYW1lLgogICAgICovCiAgICBwdWJsaWMgc3RhdGlj\nIEFnZ3JlZ2F0ZUxpc3RlbmVyIGhpbnRUb0FnZ3JlZ2F0ZUxpc3RlbmVyKE9i\namVjdCBoaW50LCBDbGFzc0xvYWRlciBsb2FkZXIpIHsKICAgICAgICBpZiAo\naGludCA9PSBudWxsKQogICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAg\nICBpZiAoaGludCBpbnN0YW5jZW9mIEFnZ3JlZ2F0ZUxpc3RlbmVyKQogICAg\nICAgICAgICByZXR1cm4gKEFnZ3JlZ2F0ZUxpc3RlbmVyKSBoaW50OwoKICAg\nICAgICBFeGNlcHRpb24gY2F1c2UgPSBudWxsOwogICAgICAgIGlmIChoaW50\nIGluc3RhbmNlb2YgU3RyaW5nKSB7CiAgICAgICAgICAgIHRyeSB7CiAgICAg\nICAgICAgICAgICByZXR1cm4gKEFnZ3JlZ2F0ZUxpc3RlbmVyKSBBY2Nlc3ND\nb250cm9sbGVyLmRvUHJpdmlsZWdlZCgKICAgICAgICAgICAgICAgICAgICBK\nMkRvUHJpdkhlbHBlci5uZXdJbnN0YW5jZUFjdGlvbihDbGFzcy5mb3JOYW1l\nKChTdHJpbmcpIGhpbnQsIHRydWUsIGxvYWRlcikpKTsKICAgICAgICAgICAg\nfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgICAgIGlmIChl\nIGluc3RhbmNlb2YgUHJpdmlsZWdlZEFjdGlvbkV4Y2VwdGlvbikKICAgICAg\nICAgICAgICAgICAgICBlID0gKChQcml2aWxlZ2VkQWN0aW9uRXhjZXB0aW9u\nKSBlKS5nZXRFeGNlcHRpb24oKTsKICAgICAgICAgICAgICAgIGNhdXNlID0g\nZTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICB0aHJvdyBuZXcg\nVXNlckV4Y2VwdGlvbihfbG9jLmdldCgiYmFkLWFnZy1saXN0ZW5lci1oaW50\nIiwgaGludCwKICAgICAgICAgICAgaGludC5nZXRDbGFzcygpKSkuc2V0Q2F1\nc2UoY2F1c2UpOwogICAgfQoKICAgIC8qKgogICAgICogQ29udmVydCB0aGUg\ndXNlci1naXZlbiBoaW50IHZhbHVlIHRvIGFuIGFycmF5IG9mIGFnZ3JlZ2F0\nZSBsaXN0ZW5lcnMuCiAgICAgKiBUaGUgaGludCBjYW4gYmUgYW4gYWdncmVn\nYXRlIGxpc3RlbmVyLCBhZ2dyZWdhdGUgbGlzdGVuZXIgYXJyYXksCiAgICAg\nKiBjb2xsZWN0aW9uLCBvciBjb21tYS1zZXBhcmF0ZWQgY2xhc3MgbmFtZXMu\nCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0aWMgQWdncmVnYXRlTGlzdGVuZXJb\nXSBoaW50VG9BZ2dyZWdhdGVMaXN0ZW5lcnMoT2JqZWN0IGhpbnQsIENsYXNz\nTG9hZGVyIGxvYWRlcikgewogICAgICAgIGlmIChoaW50ID09IG51bGwpCiAg\nICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgIGlmIChoaW50IGluc3Rh\nbmNlb2YgQWdncmVnYXRlTGlzdGVuZXJbXSkKICAgICAgICAgICAgcmV0dXJu\nIChBZ2dyZWdhdGVMaXN0ZW5lcltdKSBoaW50OwogICAgICAgIGlmIChoaW50\nIGluc3RhbmNlb2YgQWdncmVnYXRlTGlzdGVuZXIpCiAgICAgICAgICAgIHJl\ndHVybiBuZXcgQWdncmVnYXRlTGlzdGVuZXJbXXsgKEFnZ3JlZ2F0ZUxpc3Rl\nbmVyKSBoaW50IH07CiAgICAgICAgaWYgKGhpbnQgaW5zdGFuY2VvZiBDb2xs\nZWN0aW9uKSB7CiAgICAgICAgICAgIENvbGxlY3Rpb248QWdncmVnYXRlTGlz\ndGVuZXI+IGMgPSAoQ29sbGVjdGlvbjxBZ2dyZWdhdGVMaXN0ZW5lcj4pIGhp\nbnQ7CiAgICAgICAgICAgIHJldHVybiBjLnRvQXJyYXkobmV3IEFnZ3JlZ2F0\nZUxpc3RlbmVyW2Muc2l6ZSgpXSk7CiAgICAgICAgfQoKICAgICAgICBFeGNl\ncHRpb24gY2F1c2UgPSBudWxsOwogICAgICAgIGlmIChoaW50IGluc3RhbmNl\nb2YgU3RyaW5nKSB7CiAgICAgICAgICAgIFN0cmluZ1tdIGNsc3MgPSBTdHJp\nbmdzLnNwbGl0KChTdHJpbmcpIGhpbnQsICIsIiwgMCk7CiAgICAgICAgICAg\nIEFnZ3JlZ2F0ZUxpc3RlbmVyW10gYWdncyA9IG5ldyBBZ2dyZWdhdGVMaXN0\nZW5lcltjbHNzLmxlbmd0aF07CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAg\nICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGNsc3MubGVuZ3RoOyBpKysp\nCiAgICAgICAgICAgICAgICAgICAgYWdnc1tpXSA9IChBZ2dyZWdhdGVMaXN0\nZW5lcikgQWNjZXNzQ29udHJvbGxlci5kb1ByaXZpbGVnZWQoCiAgICAgICAg\nICAgICAgICAgICAgICAgIEoyRG9Qcml2SGVscGVyLm5ld0luc3RhbmNlQWN0\naW9uKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgQ2xhc3MuZm9yTmFt\nZShjbHNzW2ldLCB0cnVlLCBsb2FkZXIpKSk7IAogICAgICAgICAgICAgICAg\ncmV0dXJuIGFnZ3M7CiAgICAgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBl\nKSB7CiAgICAgICAgICAgICAgICBpZiAoZSBpbnN0YW5jZW9mIFByaXZpbGVn\nZWRBY3Rpb25FeGNlcHRpb24pCiAgICAgICAgICAgICAgICAgICAgZSA9ICgo\nUHJpdmlsZWdlZEFjdGlvbkV4Y2VwdGlvbikgZSkuZ2V0RXhjZXB0aW9uKCk7\nCiAgICAgICAgICAgICAgICBjYXVzZSA9IGU7CiAgICAgICAgICAgIH0KICAg\nICAgICB9CiAgICAgICAgdGhyb3cgbmV3IFVzZXJFeGNlcHRpb24oX2xvYy5n\nZXQoImJhZC1hZ2ctbGlzdGVuZXItaGludCIsIGhpbnQsCiAgICAgICAgICAg\nIGhpbnQuZ2V0Q2xhc3MoKSkpLnNldENhdXNlKGNhdXNlKTsKICAgIH0KCiAg\nICAvKioKICAgICAqIENvbnZlcnQgdGhlIHVzZXItZ2l2ZW4gaGludCB2YWx1\nZSB0byBhIGZpbHRlciBsaXN0ZW5lci4KICAgICAqIFRoZSBoaW50IGNhbiBi\nZSBhIGZpbHRlciBsaXN0ZW5lciBpbnN0YW5jZSBvciBjbGFzcyBuYW1lLgog\nICAgICovCiAgICBwdWJsaWMgc3RhdGljIEZpbHRlckxpc3RlbmVyIGhpbnRU\nb0ZpbHRlckxpc3RlbmVyKE9iamVjdCBoaW50LCBDbGFzc0xvYWRlciBsb2Fk\nZXIpIHsKICAgICAgICBpZiAoaGludCA9PSBudWxsKQogICAgICAgICAgICBy\nZXR1cm4gbnVsbDsKICAgICAgICBpZiAoaGludCBpbnN0YW5jZW9mIEZpbHRl\nckxpc3RlbmVyKQogICAgICAgICAgICByZXR1cm4gKEZpbHRlckxpc3RlbmVy\nKSBoaW50OwoKICAgICAgICBFeGNlcHRpb24gY2F1c2UgPSBudWxsOwogICAg\nICAgIGlmIChoaW50IGluc3RhbmNlb2YgU3RyaW5nKSB7CiAgICAgICAgICAg\nIHRyeSB7CiAgICAgICAgICAgICAgICByZXR1cm4gKEZpbHRlckxpc3RlbmVy\nKSBBY2Nlc3NDb250cm9sbGVyLmRvUHJpdmlsZWdlZCgKICAgICAgICAgICAg\nICAgICAgICBKMkRvUHJpdkhlbHBlci5uZXdJbnN0YW5jZUFjdGlvbigKICAg\nICAgICAgICAgICAgICAgICAgICAgQ2xhc3MuZm9yTmFtZSgoU3RyaW5nKSBo\naW50LCB0cnVlLCBsb2FkZXIpKSk7IAogICAgICAgICAgICB9IGNhdGNoIChF\neGNlcHRpb24gZSkgewogICAgICAgICAgICAgICAgaWYgKGUgaW5zdGFuY2Vv\nZiBQcml2aWxlZ2VkQWN0aW9uRXhjZXB0aW9uKQogICAgICAgICAgICAgICAg\nICAgIGUgPSAoKFByaXZpbGVnZWRBY3Rpb25FeGNlcHRpb24pIGUpLmdldEV4\nY2VwdGlvbigpOwogICAgICAgICAgICAgICAgY2F1c2UgPSBlOwogICAgICAg\nICAgICB9CiAgICAgICAgfQogICAgICAgIHRocm93IG5ldyBVc2VyRXhjZXB0\naW9uKF9sb2MuZ2V0KCJiYWQtZmlsdGVyLWxpc3RlbmVyLWhpbnQiLCBoaW50\nLAogICAgICAgICAgICBoaW50LmdldENsYXNzKCkpKS5zZXRDYXVzZShjYXVz\nZSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBDb252ZXJ0IHRoZSB1c2VyLWdp\ndmVuIGhpbnQgdmFsdWUgdG8gYW4gYXJyYXkgb2YgZmlsdGVyIGxpc3RlbmVy\ncy4KICAgICAqIFRoZSBoaW50IGNhbiBiZSBhIGZpbHRlciBsaXN0ZW5lciwg\nZmlsdGVyIGxpc3RlbmVyIGFycmF5LAogICAgICogY29sbGVjdGlvbiwgb3Ig\nY29tbWEtc2VwYXJhdGVkIGNsYXNzIG5hbWVzLgogICAgICovCiAgICBwdWJs\naWMgc3RhdGljIEZpbHRlckxpc3RlbmVyW10gaGludFRvRmlsdGVyTGlzdGVu\nZXJzKE9iamVjdCBoaW50LCBDbGFzc0xvYWRlciBsb2FkZXIpIHsKICAgICAg\nICBpZiAoaGludCA9PSBudWxsKQogICAgICAgICAgICByZXR1cm4gbnVsbDsK\nICAgICAgICBpZiAoaGludCBpbnN0YW5jZW9mIEZpbHRlckxpc3RlbmVyW10p\nCiAgICAgICAgICAgIHJldHVybiAoRmlsdGVyTGlzdGVuZXJbXSkgaGludDsK\nICAgICAgICBpZiAoaGludCBpbnN0YW5jZW9mIEZpbHRlckxpc3RlbmVyKQog\nICAgICAgICAgICByZXR1cm4gbmV3IEZpbHRlckxpc3RlbmVyW117IChGaWx0\nZXJMaXN0ZW5lcikgaGludCB9OwogICAgICAgIGlmIChoaW50IGluc3RhbmNl\nb2YgQ29sbGVjdGlvbikgewogICAgICAgICAgICBDb2xsZWN0aW9uPEZpbHRl\nckxpc3RlbmVyPiBjID0gKENvbGxlY3Rpb248RmlsdGVyTGlzdGVuZXI+KSBo\naW50OwogICAgICAgICAgICByZXR1cm4gYy50b0FycmF5KG5ldyBGaWx0ZXJM\naXN0ZW5lcltjLnNpemUoKV0pOwogICAgICAgIH0KCiAgICAgICAgRXhjZXB0\naW9uIGNhdXNlID0gbnVsbDsKICAgICAgICBpZiAoaGludCBpbnN0YW5jZW9m\nIFN0cmluZykgewogICAgICAgICAgICBTdHJpbmdbXSBjbHNzID0gU3RyaW5n\ncy5zcGxpdCgoU3RyaW5nKSBoaW50LCAiLCIsIDApOwogICAgICAgICAgICBG\naWx0ZXJMaXN0ZW5lcltdIGZpbHRzID0gbmV3IEZpbHRlckxpc3RlbmVyW2Ns\nc3MubGVuZ3RoXTsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAg\nIGZvciAoaW50IGkgPSAwOyBpIDwgY2xzcy5sZW5ndGg7IGkrKykKICAgICAg\nICAgICAgICAgICAgICBmaWx0c1tpXSA9IChGaWx0ZXJMaXN0ZW5lcikgQWNj\nZXNzQ29udHJvbGxlci5kb1ByaXZpbGVnZWQoCiAgICAgICAgICAgICAgICAg\nICAgICAgIEoyRG9Qcml2SGVscGVyLm5ld0luc3RhbmNlQWN0aW9uKAogICAg\nICAgICAgICAgICAgICAgICAgICAgICAgQ2xhc3MuZm9yTmFtZShjbHNzW2ld\nLCB0cnVlLCBsb2FkZXIpKSk7CiAgICAgICAgICAgICAgICByZXR1cm4gZmls\ndHM7CiAgICAgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAg\nICAgICAgICAgICBpZiAoZSBpbnN0YW5jZW9mIFByaXZpbGVnZWRBY3Rpb25F\neGNlcHRpb24pCiAgICAgICAgICAgICAgICAgICAgZSA9ICgoUHJpdmlsZWdl\nZEFjdGlvbkV4Y2VwdGlvbikgZSkuZ2V0RXhjZXB0aW9uKCk7CiAgICAgICAg\nICAgICAgICBjYXVzZSA9IGU7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAg\nICAgICAgdGhyb3cgbmV3IFVzZXJFeGNlcHRpb24oX2xvYy5nZXQoImJhZC1m\naWx0ZXItbGlzdGVuZXItaGludCIsIGhpbnQsCiAgICAgICAgICAgIGhpbnQu\nZ2V0Q2xhc3MoKSkpLnNldENhdXNlKGNhdXNlKTsKICAgIH0KCiAgICAvKioK\nICAgICAqIFJldHVybiB0aGUgdmFsdWUgb2YgdGhlIHByb3BlcnR5IG5hbWVk\nIGJ5IHRoZSBoaW50IGtleS4KICAgICAqLwogICAgcHVibGljIHN0YXRpYyBP\nYmplY3QgaGludFRvR2V0dGVyKE9iamVjdCB0YXJnZXQsIFN0cmluZyBoaW50\nS2V5KSB7CiAgICAgICAgaWYgKHRhcmdldCA9PSBudWxsIHx8IGhpbnRLZXkg\nPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIG51bGw7CgogICAgICAgIE1l\ndGhvZCBnZXR0ZXIgPSBSZWZsZWN0aW9uLmZpbmRHZXR0ZXIodGFyZ2V0Lmdl\ndENsYXNzKCksIGhpbnRLZXksIHRydWUpOwogICAgICAgIHJldHVybiBSZWZs\nZWN0aW9uLmdldCh0YXJnZXQsIGdldHRlcik7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBTZXQgdGhlIHZhbHVlIG9mIHRoZSBwcm9wZXJ0eSBuYW1lZCBieSB0\naGUgaGludCBrZXkuCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0aWMgdm9pZCBo\naW50VG9TZXR0ZXIoT2JqZWN0IHRhcmdldCwgU3RyaW5nIGhpbnRLZXksCiAg\nICAgICAgT2JqZWN0IHZhbHVlKSB7CiAgICAgICAgaWYgKHRhcmdldCA9PSBu\ndWxsIHx8IGhpbnRLZXkgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuOwoK\nICAgICAgICBNZXRob2Qgc2V0dGVyID0gUmVmbGVjdGlvbi5maW5kU2V0dGVy\nKHRhcmdldC5nZXRDbGFzcygpLCBoaW50S2V5LCB0cnVlKTsKICAgICAgICBp\nZiAodmFsdWUgaW5zdGFuY2VvZiBTdHJpbmcpIHsKICAgICAgICAgICAgaWYg\nKCJudWxsIi5lcXVhbHModmFsdWUpKQogICAgICAgICAgICAgICAgdmFsdWUg\nPSBudWxsOwogICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgIHRy\neSB7CiAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBTdHJpbmdzLnBhcnNl\nKChTdHJpbmcpIHZhbHVlLAogICAgICAgICAgICAgICAgICAgICAgICBzZXR0\nZXIuZ2V0UGFyYW1ldGVyVHlwZXMoKVswXSk7CiAgICAgICAgICAgICAgICB9\nIGNhdGNoIChFeGNlcHRpb24gZSkgewogICAgICAgICAgICAgICAgICAgIHRo\ncm93IG5ldyBVc2VyRXhjZXB0aW9uKF9sb2MuZ2V0KCJiYWQtc2V0dGVyLWhp\nbnQtYXJnIiwKICAgICAgICAgICAgICAgICAgICAgICAgaGludEtleSwgdmFs\ndWUsIHNldHRlci5nZXRQYXJhbWV0ZXJUeXBlcygpWzBdKSkuCiAgICAgICAg\nICAgICAgICAgICAgICAgIHNldENhdXNlKGUpOwogICAgICAgICAgICAgICAg\nfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIFJlZmxlY3Rpb24u\nc2V0KHRhcmdldCwgc2V0dGVyLCB2YWx1ZSk7Cgl9CiAgICAKICAgIC8qKgog\nICAgICogUGFyc2VzIHRoZSBnaXZlbiBzdHJpbmcgYXNzdW1pbmcgaXQgaXMg\nYSBKREJDIGtleSBleHByZXNzaW9uLiBFeHRyYWN0cyB0aGUgCiAgICAgKiBk\nYXRhIHBvcnRpb24gYW5kIGJhc2VkIG9uIHRoZSBrZXksIGNhbGxzIHN0YXRp\nYyBqYXZhLnNxbC5EYXRlL1RpbWUvVGltZXN0YW1wLnZhbHVlT2YoU3RyaW5n\nKQogICAgICogbWV0aG9kIHRvIGNvbnZlcnQgdG8gYSBqYXZhLnNxbC5EYXRl\nL1RpbWUvVGltZXN0YW1wIGluc3RhbmNlLgogICAgICovCiAgICBwdWJsaWMg\nc3RhdGljIE9iamVjdCBwYXJzZUpEQkNUZW1wb3JhbFN5bnRheChTdHJpbmcg\ncykgewogICAgICAgIHMgPSBjbGlwKHMudHJpbSgpLCAieyIsICJ9IiwgdHJ1\nZSk7CiAgICAgICAgaWYgKHMuc3RhcnRzV2l0aCgidHMiKSkgewogICAgICAg\nICAgICByZXR1cm4gamF2YS5zcWwuVGltZXN0YW1wLnZhbHVlT2YoY2xpcChz\nLnN1YnN0cmluZygyKS50cmltKCksICInIiwgIiciLCBmYWxzZSkpOwogICAg\nICAgIH0gZWxzZSBpZiAocy5zdGFydHNXaXRoKCJkIikpIHsKICAgICAgICAg\nICAgcmV0dXJuIGphdmEuc3FsLkRhdGUudmFsdWVPZihjbGlwKHMuc3Vic3Ry\naW5nKDEpLnRyaW0oKSwgIiciLCAiJyIsIGZhbHNlKSk7CiAgICAgICAgfSBl\nbHNlIGlmIChzLnN0YXJ0c1dpdGgoInQiKSkgewogICAgICAgICAgICByZXR1\ncm4gamF2YS5zcWwuVGltZS52YWx1ZU9mKGNsaXAocy5zdWJzdHJpbmcoMiku\ndHJpbSgpLCAiJyIsICInIiwgZmFsc2UpKTsKICAgICAgICB9IGVsc2Ugewog\nICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICB9CiAgICB9CiAgICAK\nICAgIC8qKgogICAgICogQWZmaXJtcyBpZiB0aGUgZ2l2ZW4gU3RyaW5nIGlz\nIGVuY2xvc2VkIGluIHt9LgogICAgICogCiAgICAgKi8KICAgIHB1YmxpYyBz\ndGF0aWMgYm9vbGVhbiBpc0pEQkNUZW1wb3JhbFN5bnRheChTdHJpbmcgcykg\newogICAgICAgIGlmIChzICE9IG51bGwpIHsKICAgICAgICAgICAgcyA9IHMu\ndHJpbSgpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gcyAhPSBudWxsICYm\nIHMuc3RhcnRzV2l0aCgieyIpICYmIHMuZW5kc1dpdGgoIn0iKTsKICAgIH0K\nICAgIAogICAgLyoqCiAgICAgKiBSZW1vdmVzIHRoZSBmaXJzdCBhbmQgbGFz\ndCBzdHJpbmcgaWYgdGhleSBhcmUgdGhlIHRlcm1pbmFsIHNlcXVlbmNlIGlu\nIHRoZSBnaXZlbiBzdHJpbmcuCiAgICAgKiAKICAgICAqIEBwYXJhbSBzIGEg\nc3RyaW5nIHRvIGJlIGV4YW1pbmVkCiAgICAgKiBAcGFyYW0gZmlyc3QgdGhl\nIGNoYXJhY3RlcnMgaW4gdGhlIGJlZ2lubmluZyBvZiB0aGUgZ2l2ZW4gc3Ry\naW5nCiAgICAgKiBAcGFyYW0gbGFzdCB0aGUgY2hhcmFjdGVycyBpbiB0aGUg\nZW5kIG9mIHRoZSBnaXZlbiBzdHJpbmcKICAgICAqIEBwYXJhbSBmYWlsIGlm\nIHRydWUgdGhyb3dzIGV4Y2VwdGlvbiBpZiB0aGUgZ2l2ZW4gc3RyaW5nIGRv\nZXMgbm90IGhhdmUgdGhlIGdpdmVuIHRlcm1pbmFsIHNlcXVlbmNlcy4KICAg\nICAqIEByZXR1cm4gdGhlIHN0cmluZyB3aXRoIHRlcm1pbmFsIHNlcXVlbmNl\ncyByZW1vdmVkLgogICAgICovCiAgICBwdWJsaWMgc3RhdGljIFN0cmluZyBj\nbGlwKFN0cmluZyBzLCBTdHJpbmcgZmlyc3QsIFN0cmluZyBsYXN0LCBib29s\nZWFuIGZhaWwpIHsKICAgICAgICBpZiAocyA9PSBudWxsKQogICAgICAgICAg\nICByZXR1cm4gczsKICAgICAgICBpZiAocy5zdGFydHNXaXRoKGZpcnN0KSAm\nJiBzLmVuZHNXaXRoKGxhc3QpKSB7CiAgICAgICAgICAgIHJldHVybiBzLnN1\nYnN0cmluZyhmaXJzdC5sZW5ndGgoKSwgcy5sZW5ndGgoKS1sYXN0Lmxlbmd0\naCgpKS50cmltKCk7CiAgICAgICAgfQogICAgICAgIGlmIChmYWlsKSB7CiAg\nICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24o\ncyArICIgaXMgbm90IHZhbGlkIGVzY2FwZSBzeW50YXggZm9yIEpEQkMiKTsK\nICAgICAgICB9CiAgICAgICAgcmV0dXJuIHM7CiAgICB9CiAgICAKICAgIC8q\nKgogICAgICogQWZmaXJtcyBpZiB0aGUgZ2l2ZW4gY2xhc3MgaXMgRGF0YSwg\nVGltZSBvciBUaW1lc3RhbXAuCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0aWMg\nYm9vbGVhbiBpc1RlbXBvcmFsVHlwZShDbGFzczw/PiBjKSB7CiAgICAgICAg\ncmV0dXJuIGMgIT0gbnVsbCAKICAgICAgICAgICAgJiYgKERhdGUuY2xhc3Mu\naXNBc3NpZ25hYmxlRnJvbShjKSAKICAgICAgICAgICAgIHx8IFRpbWUuY2xh\nc3MuaXNBc3NpZ25hYmxlRnJvbShjKSAKICAgICAgICAgICAgIHx8IFRpbWVz\ndGFtcC5jbGFzcy5pc0Fzc2lnbmFibGVGcm9tKGMpKTsKICAgIH0KICAgIAog\nICAgcHVibGljIHN0YXRpYyBPYmplY3QgZ2V0RGVmYXVsdEZvck51bGwoQ2xh\nc3M8Pz4gblR5cGUpIHsKICAgICAgICBpZiAoblR5cGUgPT0gTG9uZy5jbGFz\ncykgCiAgICAgICAgICAgIHJldHVybiBuZXcgTG9uZygwKTsKICAgICAgICBp\nZiAoblR5cGUgPT0gSW50ZWdlci5jbGFzcykKICAgICAgICAgICAgcmV0dXJu\nIG5ldyBJbnRlZ2VyKDApOwogICAgICAgIGlmIChuVHlwZSA9PSBEb3VibGUu\nY2xhc3MpIAogICAgICAgICAgICByZXR1cm4gbmV3IERvdWJsZSgwLjApOwog\nICAgICAgIGlmIChuVHlwZSA9PSBGbG9hdC5jbGFzcykgCiAgICAgICAgICAg\nIHJldHVybiBuZXcgRmxvYXQoMC4wKTsKICAgICAgICBpZiAoblR5cGUgPT0g\nU2hvcnQuY2xhc3MpIAogICAgICAgICAgICByZXR1cm4gbmV3IFNob3J0KChz\naG9ydCkwKTsKICAgICAgICByZXR1cm4gbnVsbDsKICAgIH0KCn0K\n","encoding":"base64"}

