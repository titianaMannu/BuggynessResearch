{"sha":"819a91c3cb5d2f27f7f055182f10200ee6af125e","node_id":"MDQ6QmxvYjIwNjM2NDo4MTlhOTFjM2NiNWQyZjI3ZjdmMDU1MTgyZjEwMjAwZWU2YWYxMjVl","size":75060,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/819a91c3cb5d2f27f7f055182f10200ee6af125e","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsOwoKaW1wb3J0IGph\ndmEuaW8uU2VyaWFsaXphYmxlOwppbXBvcnQgamF2YS5zZWN1cml0eS5BY2Nl\nc3NDb250cm9sbGVyOwppbXBvcnQgamF2YS51dGlsLkFycmF5TGlzdDsKaW1w\nb3J0IGphdmEudXRpbC5BcnJheXM7CmltcG9ydCBqYXZhLnV0aWwuQ29sbGVj\ndGlvbjsKaW1wb3J0IGphdmEudXRpbC5Db2xsZWN0aW9uczsKaW1wb3J0IGph\ndmEudXRpbC5IYXNoTWFwOwppbXBvcnQgamF2YS51dGlsLkl0ZXJhdG9yOwpp\nbXBvcnQgamF2YS51dGlsLkxpc3Q7CmltcG9ydCBqYXZhLnV0aWwuTGlzdEl0\nZXJhdG9yOwppbXBvcnQgamF2YS51dGlsLk1hcDsKaW1wb3J0IGphdmEudXRp\nbC5jb25jdXJyZW50LmxvY2tzLlJlZW50cmFudExvY2s7CgppbXBvcnQgb3Jn\nLmFwYWNoZS5jb21tb25zLmNvbGxlY3Rpb25zLm1hcC5MaW5rZWRNYXA7Cmlt\ncG9ydCBvcmcuYXBhY2hlLmNvbW1vbnMubGFuZy5PYmplY3RVdGlsczsKaW1w\nb3J0IG9yZy5hcGFjaGUuY29tbW9ucy5sYW5nLlN0cmluZ1V0aWxzOwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLmNvbmYuT3BlbkpQQUNvbmZpZ3VyYXRp\nb247CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuZW5oYW5jZS5QZXJzaXN0\nZW5jZUNhcGFibGU7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVs\nLmV4cHMuQWdncmVnYXRlTGlzdGVuZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEua2VybmVsLmV4cHMuQ29uc3RhbnQ7CmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEua2VybmVsLmV4cHMuRmlsdGVyTGlzdGVuZXI7CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLmV4cHMuTGl0ZXJhbDsKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuZXhwcy5QYXRoOwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5leHBzLlF1ZXJ5RXhwcmVzc2lv\nbnM7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLmV4cHMuVmFs\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi5sb2cuTG9nOwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi5yb3AuRWFnZXJSZXN1bHRMaXN0\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi5yb3AuTWVyZ2VkUmVz\ndWx0T2JqZWN0UHJvdmlkZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\nbGliLnJvcC5SYW5nZVJlc3VsdE9iamVjdFByb3ZpZGVyOwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLmxpYi5yb3AuUmVzdWx0TGlzdDsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5saWIucm9wLlJlc3VsdE9iamVjdFByb3ZpZGVy\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51dGlsLkoyRG9Qcml2\nSGVscGVyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51dGlsLkxv\nY2FsaXplcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIudXRpbC5P\ncmRlcmVkTWFwOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51dGls\nLlJlZmVyZW5jZUhhc2hTZXQ7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\nbWV0YS5DbGFzc01ldGFEYXRhOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLm1ldGEuRmllbGRNZXRhRGF0YTsKaW1wb3J0IG9yZy5hcGFjaGUub3Blbmpw\nYS5tZXRhLkphdmFUeXBlczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5t\nZXRhLk1ldGFEYXRhUmVwb3NpdG9yeTsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS51dGlsLkdlbmVyYWxFeGNlcHRpb247CmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEudXRpbC5JbXBsSGVscGVyOwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLnV0aWwuSW52YWxpZFN0YXRlRXhjZXB0aW9uOwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLnV0aWwuTm9SZXN1bHRFeGNlcHRpb247CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5Ob25VbmlxdWVSZXN1bHRFeGNl\ncHRpb247CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5PcGVuSlBB\nRXhjZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuVW5z\ndXBwb3J0ZWRFeGNlcHRpb247CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\ndXRpbC5Vc2VyRXhjZXB0aW9uOwoKaW1wb3J0IHNlcnAudXRpbC5OdW1iZXJz\nOwppbXBvcnQgc2VycC51dGlsLlN0cmluZ3M7CgovKioKICogSW1wbGVtZW50\nYXRpb24gb2YgdGhlIHtAbGluayBRdWVyeX0gaW50ZXJmYWNlLgogKgogKiBA\nYXV0aG9yIEFiZSBXaGl0ZQogKiBAbm9qYXZhZG9jCiAqLwpAU3VwcHJlc3NX\nYXJuaW5ncygic2VyaWFsIikKcHVibGljIGNsYXNzIFF1ZXJ5SW1wbAogICAg\naW1wbGVtZW50cyBRdWVyeSB7CgogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwg\nTG9jYWxpemVyIF9sb2MgPSBMb2NhbGl6ZXIuZm9yUGFja2FnZShRdWVyeUlt\ncGwuY2xhc3MpOwoKICAgIHByaXZhdGUgZmluYWwgU3RyaW5nIF9sYW5ndWFn\nZTsKICAgIHByaXZhdGUgZmluYWwgU3RvcmVRdWVyeSBfc3RvcmVRdWVyeTsK\nICAgIHByaXZhdGUgdHJhbnNpZW50IGZpbmFsIEJyb2tlckltcGwgX2Jyb2tl\ncjsKICAgIHByaXZhdGUgdHJhbnNpZW50IGZpbmFsIExvZyBfbG9nOwogICAg\ncHJpdmF0ZSB0cmFuc2llbnQgQ2xhc3NMb2FkZXIgX2xvYWRlciA9IG51bGw7\nCgogICAgLy8gcXVlcnkgaGFzIGl0cyBvd24gaW50ZXJuYWwgbG9jawogICAg\ncHJpdmF0ZSBSZWVudHJhbnRMb2NrIF9sb2NrOwoKICAgIC8vIHVucGFyc2Vk\nIHN0YXRlCiAgICBwcml2YXRlIENsYXNzPD8+IF9jbGFzcyA9IG51bGw7CiAg\nICBwcml2YXRlIGJvb2xlYW4gX3N1YmNsYXNzZXMgPSB0cnVlOwogICAgcHJp\ndmF0ZSBib29sZWFuIF9yZWFkT25seSA9IGZhbHNlOwogICAgcHJpdmF0ZSBT\ndHJpbmcgX3F1ZXJ5ID0gbnVsbDsKICAgIHByaXZhdGUgU3RyaW5nIF9wYXJh\nbXMgPSBudWxsOwoKICAgIC8vIHBhcnNlZCBzdGF0ZQogICAgcHJpdmF0ZSB0\ncmFuc2llbnQgQ29tcGlsYXRpb24gX2NvbXBpbGVkID0gbnVsbDsKICAgIHBy\naXZhdGUgdHJhbnNpZW50IGJvb2xlYW4gX2NvbXBpbGluZyA9IGZhbHNlOwog\nICAgcHJpdmF0ZSB0cmFuc2llbnQgUmVzdWx0UGFja2VyIF9wYWNrZXIgPSBu\ndWxsOwoKICAgIC8vIGNhbmRpZGF0ZXMKICAgIHByaXZhdGUgdHJhbnNpZW50\nIENvbGxlY3Rpb248Pz4gX2NvbGxlY3Rpb24gPSBudWxsOwogICAgcHJpdmF0\nZSB0cmFuc2llbnQgRXh0ZW50IF9leHRlbnQgPSBudWxsOwoKICAgIC8vIGxp\nc3RlbmVycwogICAgcHJpdmF0ZSBNYXA8U3RyaW5nLEZpbHRlckxpc3RlbmVy\nPiBfZmlsdExpc3RlbmVycyA9IG51bGw7CiAgICBwcml2YXRlIE1hcDxTdHJp\nbmcsQWdncmVnYXRlTGlzdGVuZXI+IF9hZ2dMaXN0ZW5lcnMgPSBudWxsOwoK\nICAgIC8vIGNvbmZpZ3VyYXRpb24gZm9yIGxvYWRpbmcgb2JqZWN0cwogICAg\ncHJpdmF0ZSBGZXRjaENvbmZpZ3VyYXRpb24gX2ZjID0gbnVsbDsKICAgIHBy\naXZhdGUgYm9vbGVhbiBfaWdub3JlQ2hhbmdlcyA9IGZhbHNlOwogICAgcHJp\ndmF0ZSBDbGFzczw/PiBfcmVzdWx0TWFwcGluZ1Njb3BlID0gbnVsbDsKICAg\nIHByaXZhdGUgU3RyaW5nIF9yZXN1bHRNYXBwaW5nTmFtZSA9IG51bGw7Cgog\nICAgLy8gdGhlc2UgZmllbGRzIHNob3VsZCBvbmx5IGJlIHVzZWQgZGlyZWN0\nbHkgYWZ0ZXIgd2UgaGF2ZSBhIGNvbXBpbGF0aW9uLAogICAgLy8gYmVjYXVz\nZSB0aGVpciB2YWx1ZXMgbWF5IGJlIGVuY29kZWQgaW4gdGhlIHF1ZXJ5IHN0\ncmluZwogICAgcHJpdmF0ZSBCb29sZWFuIF91bmlxdWUgPSBudWxsOwogICAg\ncHJpdmF0ZSBDbGFzczw/PiBfcmVzdWx0Q2xhc3MgPSBudWxsOwogICAgcHJp\ndmF0ZSB0cmFuc2llbnQgbG9uZyBfc3RhcnRJZHggPSAwOwogICAgcHJpdmF0\nZSB0cmFuc2llbnQgbG9uZyBfZW5kSWR4ID0gTG9uZy5NQVhfVkFMVUU7CiAg\nICBwcml2YXRlIHRyYW5zaWVudCBib29sZWFuIF9yYW5nZVNldCA9IGZhbHNl\nOwoKICAgIC8vIHJlbWVtYmVyIHRoZSBsaXN0IG9mIGFsbCB0aGUgcmVzdWx0\ncyB3ZSBoYXZlIHJldHVybmVkIHNvIHdlCiAgICAvLyBjYW4gZnJlZSB0aGVp\nciByZXNvdXJjZXMgd2hlbiBjbG9zZSBvciBjbG9zZUFsbCBpcyBjYWxsZWQK\nICAgIHByaXZhdGUgdHJhbnNpZW50IGZpbmFsIENvbGxlY3Rpb248UmVtb3Zl\nT25DbG9zZVJlc3VsdExpc3Q+IF9yZXN1bHRMaXN0cyA9IAogICAgICAgIG5l\ndyBSZWZlcmVuY2VIYXNoU2V0KFJlZmVyZW5jZUhhc2hTZXQuV0VBSyk7Cgog\nICAgLyoqCiAgICAgKiBDb25zdHJ1Y3QgYSBxdWVyeSBtYW5hZ2VkIGJ5IHRo\nZSBnaXZlbiBicm9rZXIuCiAgICAgKi8KICAgIHB1YmxpYyBRdWVyeUltcGwo\nQnJva2VyIGJyb2tlciwgU3RyaW5nIGxhbmd1YWdlLCBTdG9yZVF1ZXJ5IHN0\nb3JlUXVlcnkpIHsKICAgICAgICBfYnJva2VyID0gKEJyb2tlckltcGwpIGJy\nb2tlcjsKICAgICAgICBfbGFuZ3VhZ2UgPSBsYW5ndWFnZTsKICAgICAgICBf\nc3RvcmVRdWVyeSA9IHN0b3JlUXVlcnk7CiAgICAgICAgX2ZjID0gKEZldGNo\nQ29uZmlndXJhdGlvbikgYnJva2VyLmdldEZldGNoQ29uZmlndXJhdGlvbigp\nLmNsb25lKCk7CiAgICAgICAgX2xvZyA9IGJyb2tlci5nZXRDb25maWd1cmF0\naW9uKCkuZ2V0TG9nKE9wZW5KUEFDb25maWd1cmF0aW9uLkxPR19RVUVSWSk7\nCiAgICAgICAgX3N0b3JlUXVlcnkuc2V0Q29udGV4dCh0aGlzKTsKCiAgICAg\nICAgaWYgKF9icm9rZXIgIT0gbnVsbCAmJiBfYnJva2VyLmdldE11bHRpdGhy\nZWFkZWQoKSkKICAgICAgICAgICAgX2xvY2sgPSBuZXcgUmVlbnRyYW50TG9j\naygpOwogICAgfQoKICAgIC8qKgogICAgICogSW50ZXJuYWwgc3RvcmUgcXVl\ncnkuCiAgICAgKi8KICAgIHB1YmxpYyBTdG9yZVF1ZXJ5IGdldFN0b3JlUXVl\ncnkoKSB7CiAgICAgICAgcmV0dXJuIF9zdG9yZVF1ZXJ5OwogICAgfQoKICAg\nIHB1YmxpYyBCcm9rZXIgZ2V0QnJva2VyKCkgewogICAgICAgIHJldHVybiBf\nYnJva2VyOwogICAgfQoKICAgIHB1YmxpYyBRdWVyeSBnZXRRdWVyeSgpIHsK\nICAgICAgICByZXR1cm4gdGhpczsKICAgIH0KCiAgICBwdWJsaWMgU3RvcmVD\nb250ZXh0IGdldFN0b3JlQ29udGV4dCgpIHsKICAgICAgICByZXR1cm4gX2Jy\nb2tlcjsKICAgIH0KCiAgICBwdWJsaWMgU3RyaW5nIGdldExhbmd1YWdlKCkg\newogICAgICAgIHJldHVybiBfbGFuZ3VhZ2U7CiAgICB9CgogICAgcHVibGlj\nIEZldGNoQ29uZmlndXJhdGlvbiBnZXRGZXRjaENvbmZpZ3VyYXRpb24oKSB7\nCiAgICAgICAgcmV0dXJuIF9mYzsKICAgIH0KCiAgICBwdWJsaWMgU3RyaW5n\nIGdldFF1ZXJ5U3RyaW5nKCkgewogICAgICAgIHJldHVybiBfcXVlcnk7CiAg\nICB9CgogICAgcHVibGljIGJvb2xlYW4gZ2V0SWdub3JlQ2hhbmdlcygpIHsK\nICAgICAgICBhc3NlcnRPcGVuKCk7CiAgICAgICAgcmV0dXJuIF9pZ25vcmVD\naGFuZ2VzOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldElnbm9yZUNoYW5n\nZXMoYm9vbGVhbiBmbGFnKSB7CiAgICAgICAgbG9jaygpOwogICAgICAgIHRy\neSB7CiAgICAgICAgICAgIGFzc2VydE9wZW4oKTsKICAgICAgICAgICAgLy8g\nYWxsb3dlZCBtb2RpZmljYXRpb246IG5vIHJlYWQtb25seSBjaGVjawogICAg\nICAgICAgICBfaWdub3JlQ2hhbmdlcyA9IGZsYWc7CiAgICAgICAgfSBmaW5h\nbGx5IHsKICAgICAgICAgICAgdW5sb2NrKCk7CiAgICAgICAgfQogICAgfQoK\nICAgIHB1YmxpYyBib29sZWFuIGlzUmVhZE9ubHkoKSB7CiAgICAgICAgYXNz\nZXJ0T3BlbigpOwogICAgICAgIHJldHVybiBfcmVhZE9ubHk7CiAgICB9Cgog\nICAgcHVibGljIHZvaWQgc2V0UmVhZE9ubHkoYm9vbGVhbiBmbGFnKSB7CiAg\nICAgICAgbG9jaygpOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIGFzc2Vy\ndE9wZW4oKTsKICAgICAgICAgICAgX3JlYWRPbmx5ID0gZmxhZzsKICAgICAg\nICB9IGZpbmFsbHkgewogICAgICAgICAgICB1bmxvY2soKTsKICAgICAgICB9\nCiAgICB9CgogICAgcHVibGljIHZvaWQgYWRkRmlsdGVyTGlzdGVuZXIoRmls\ndGVyTGlzdGVuZXIgbGlzdGVuZXIpIHsKICAgICAgICBsb2NrKCk7CiAgICAg\nICAgdHJ5IHsKICAgICAgICAgICAgYXNzZXJ0T3BlbigpOwogICAgICAgICAg\nICBhc3NlcnROb3RSZWFkT25seSgpOwogICAgICAgICAgICBpZiAoX2ZpbHRM\naXN0ZW5lcnMgPT0gbnVsbCkKICAgICAgICAgICAgICAgIF9maWx0TGlzdGVu\nZXJzID0gbmV3IEhhc2hNYXA8U3RyaW5nLEZpbHRlckxpc3RlbmVyPig1KTsK\nICAgICAgICAgICAgX2ZpbHRMaXN0ZW5lcnMucHV0KGxpc3RlbmVyLmdldFRh\nZygpLCBsaXN0ZW5lcik7CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAg\nICAgdW5sb2NrKCk7CiAgICAgICAgfQogICAgfQoKICAgIHB1YmxpYyB2b2lk\nIHJlbW92ZUZpbHRlckxpc3RlbmVyKEZpbHRlckxpc3RlbmVyIGxpc3RlbmVy\nKSB7CiAgICAgICAgbG9jaygpOwogICAgICAgIHRyeSB7CiAgICAgICAgICAg\nIGFzc2VydE9wZW4oKTsKICAgICAgICAgICAgYXNzZXJ0Tm90UmVhZE9ubHko\nKTsKICAgICAgICAgICAgaWYgKF9maWx0TGlzdGVuZXJzICE9IG51bGwpCiAg\nICAgICAgICAgICAgICBfZmlsdExpc3RlbmVycy5yZW1vdmUobGlzdGVuZXIu\nZ2V0VGFnKCkpOwogICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgIHVu\nbG9jaygpOwogICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMgQ29sbGVjdGlv\nbjxGaWx0ZXJMaXN0ZW5lcj4gZ2V0RmlsdGVyTGlzdGVuZXJzKCkgewogICAg\nICAgIGlmIChfZmlsdExpc3RlbmVycyA9PSBudWxsKSAKICAgICAgICAgICAg\ncmV0dXJuIENvbGxlY3Rpb25zLmVtcHR5TGlzdCgpOwogICAgICAgIGVsc2UK\nICAgICAgICAgICAgcmV0dXJuIF9maWx0TGlzdGVuZXJzLnZhbHVlcygpOwog\nICAgfQoKICAgIHB1YmxpYyBGaWx0ZXJMaXN0ZW5lciBnZXRGaWx0ZXJMaXN0\nZW5lcihTdHJpbmcgdGFnKSB7CiAgICAgICAgLy8gZmlyc3QgY2hlY2sgbGlz\ndGVuZXJzIGZvciB0aGlzIHF1ZXJ5CiAgICAgICAgaWYgKF9maWx0TGlzdGVu\nZXJzICE9IG51bGwpIHsKICAgICAgICAgICAgRmlsdGVyTGlzdGVuZXIgbGlz\ndGVuID0gKEZpbHRlckxpc3RlbmVyKSBfZmlsdExpc3RlbmVycy5nZXQodGFn\nKTsKICAgICAgICAgICAgaWYgKGxpc3RlbiAhPSBudWxsKQogICAgICAgICAg\nICAgICAgcmV0dXJuIGxpc3RlbjsKICAgICAgICB9CgogICAgICAgIC8vIGNo\nZWNrIHVzZXItZGVmaW5lZCBsaXN0ZW5lcnMgZnJvbSBjb25maWd1cmF0aW9u\nCiAgICAgICAgRmlsdGVyTGlzdGVuZXJbXSBjb25mTGlzdGVuZXJzID0gX2Jy\nb2tlci5nZXRDb25maWd1cmF0aW9uKCkuCiAgICAgICAgICAgIGdldEZpbHRl\nckxpc3RlbmVySW5zdGFuY2VzKCk7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7\nIGkgPCBjb25mTGlzdGVuZXJzLmxlbmd0aDsgaSsrKQogICAgICAgICAgICBp\nZiAoY29uZkxpc3RlbmVyc1tpXS5nZXRUYWcoKS5lcXVhbHModGFnKSkKICAg\nICAgICAgICAgICAgIHJldHVybiBjb25mTGlzdGVuZXJzW2ldOwoKICAgICAg\nICAvLyBjaGVjayBzdG9yZSBsaXN0ZW5lcnMKICAgICAgICByZXR1cm4gX3N0\nb3JlUXVlcnkuZ2V0RmlsdGVyTGlzdGVuZXIodGFnKTsKICAgIH0KCiAgICBw\ndWJsaWMgdm9pZCBhZGRBZ2dyZWdhdGVMaXN0ZW5lcihBZ2dyZWdhdGVMaXN0\nZW5lciBsaXN0ZW5lcikgewogICAgICAgIGxvY2soKTsKICAgICAgICB0cnkg\newogICAgICAgICAgICBhc3NlcnRPcGVuKCk7CiAgICAgICAgICAgIGFzc2Vy\ndE5vdFJlYWRPbmx5KCk7CiAgICAgICAgICAgIGlmIChfYWdnTGlzdGVuZXJz\nID09IG51bGwpCiAgICAgICAgICAgICAgICBfYWdnTGlzdGVuZXJzID0gbmV3\nIEhhc2hNYXA8U3RyaW5nLEFnZ3JlZ2F0ZUxpc3RlbmVyPig1KTsKICAgICAg\nICAgICAgX2FnZ0xpc3RlbmVycy5wdXQobGlzdGVuZXIuZ2V0VGFnKCksIGxp\nc3RlbmVyKTsKICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICB1bmxv\nY2soKTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGljIHZvaWQgcmVtb3Zl\nQWdncmVnYXRlTGlzdGVuZXIoQWdncmVnYXRlTGlzdGVuZXIgbGlzdGVuZXIp\nIHsKICAgICAgICBsb2NrKCk7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAg\nYXNzZXJ0T3BlbigpOwogICAgICAgICAgICBhc3NlcnROb3RSZWFkT25seSgp\nOwogICAgICAgICAgICBpZiAoX2FnZ0xpc3RlbmVycyAhPSBudWxsKQogICAg\nICAgICAgICAgICAgX2FnZ0xpc3RlbmVycy5yZW1vdmUobGlzdGVuZXIuZ2V0\nVGFnKCkpOwogICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgIHVubG9j\naygpOwogICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMgQ29sbGVjdGlvbjxB\nZ2dyZWdhdGVMaXN0ZW5lcj4gZ2V0QWdncmVnYXRlTGlzdGVuZXJzKCkgewog\nICAgICAgIGlmIChfYWdnTGlzdGVuZXJzID09IG51bGwpIAogICAgICAgICAg\nICByZXR1cm4gQ29sbGVjdGlvbnMuZW1wdHlMaXN0KCk7CiAgICAgICAgZWxz\nZQogICAgICAgICAgICByZXR1cm4gX2FnZ0xpc3RlbmVycy52YWx1ZXMoKTsK\nICAgIH0KCiAgICBwdWJsaWMgQWdncmVnYXRlTGlzdGVuZXIgZ2V0QWdncmVn\nYXRlTGlzdGVuZXIoU3RyaW5nIHRhZykgewogICAgICAgIC8vIGZpcnN0IGNo\nZWNrIGxpc3RlbmVycyBmb3IgdGhpcyBxdWVyeQogICAgICAgIGlmIChfYWdn\nTGlzdGVuZXJzICE9IG51bGwpIHsKICAgICAgICAgICAgQWdncmVnYXRlTGlz\ndGVuZXIgbGlzdGVuID0gKEFnZ3JlZ2F0ZUxpc3RlbmVyKSBfYWdnTGlzdGVu\nZXJzLgogICAgICAgICAgICAgICAgZ2V0KHRhZyk7CiAgICAgICAgICAgIGlm\nIChsaXN0ZW4gIT0gbnVsbCkKICAgICAgICAgICAgICAgIHJldHVybiBsaXN0\nZW47CiAgICAgICAgfQoKICAgICAgICAvLyBjaGVjayB1c2VyLWRlZmluZWQg\nbGlzdGVuZXJzIGZyb20gY29uZmlndXJhdGlvbgogICAgICAgIEFnZ3JlZ2F0\nZUxpc3RlbmVyW10gY29uZkxpc3RlbmVycyA9IF9icm9rZXIuZ2V0Q29uZmln\ndXJhdGlvbigpLgogICAgICAgICAgICBnZXRBZ2dyZWdhdGVMaXN0ZW5lcklu\nc3RhbmNlcygpOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgY29uZkxp\nc3RlbmVycy5sZW5ndGg7IGkrKykKICAgICAgICAgICAgaWYgKGNvbmZMaXN0\nZW5lcnNbaV0uZ2V0VGFnKCkuZXF1YWxzKHRhZykpCiAgICAgICAgICAgICAg\nICByZXR1cm4gY29uZkxpc3RlbmVyc1tpXTsKCiAgICAgICAgLy8gY2hlY2sg\nc3RvcmUgbGlzdGVuZXJzCiAgICAgICAgcmV0dXJuIF9zdG9yZVF1ZXJ5Lmdl\ndEFnZ3JlZ2F0ZUxpc3RlbmVyKHRhZyk7CiAgICB9CgogICAgcHVibGljIEV4\ndGVudCBnZXRDYW5kaWRhdGVFeHRlbnQoKSB7CiAgICAgICAgLy8gaWYganVz\ndCB0aGUgY2xhc3MgaXMgc2V0LCBmZXRjaCB0aGUgY29ycmVzcG9uZGluZyBl\neHRlbnQ7IGlmIHRoZQogICAgICAgIC8vIGV4dGVudCBpcyBhbHJlYWR5IHNl\ndCBidXQgaXRzIGlnbm9yZSBjYWNoZSBzZXR0aW5nIGlzIHdyb25nLAogICAg\nICAgIC8vIGdldCBhIG5ldyBleHRlbnQgd2l0aCB0aGUgY29ycmVjdCBzZXR0\naW5nIChkb24ndCBtb2RpZnkgb3JpZyBleHRlbnQKICAgICAgICAvLyBpbiBj\nYXNlIHRoZSB1c2VyIGhhcyBhIHJlZmVyZW5jZSB0byBpdCBhbmQgbWlnaHQg\ndXNlIGl0KQogICAgICAgIGxvY2soKTsKICAgICAgICB0cnkgewogICAgICAg\nICAgICBDbGFzczw/PiBjbHMgPSBnZXRDYW5kaWRhdGVUeXBlKCk7CiAgICAg\nICAgICAgIGlmIChfZXh0ZW50ID09IG51bGwgJiYgX2NvbGxlY3Rpb24gPT0g\nbnVsbCAmJiBfYnJva2VyICE9IG51bGwKICAgICAgICAgICAgICAgICYmIGNs\ncyAhPSBudWxsKSB7CiAgICAgICAgICAgICAgICBfZXh0ZW50ID0gX2Jyb2tl\nci5uZXdFeHRlbnQoY2xzLCBfc3ViY2xhc3Nlcyk7CiAgICAgICAgICAgICAg\nICBfZXh0ZW50LnNldElnbm9yZUNoYW5nZXMoX2lnbm9yZUNoYW5nZXMpOwog\nICAgICAgICAgICB9IGVsc2UgaWYgKF9leHRlbnQgIT0gbnVsbAogICAgICAg\nICAgICAgICAgJiYgX2V4dGVudC5nZXRJZ25vcmVDaGFuZ2VzKCkgIT0gX2ln\nbm9yZUNoYW5nZXMgJiYgY2xzICE9IG51bGwpewogICAgICAgICAgICAgICAg\nX2V4dGVudCA9IF9icm9rZXIubmV3RXh0ZW50KGNscywgX2V4dGVudC5oYXNT\ndWJjbGFzc2VzKCkpOwogICAgICAgICAgICAgICAgX2V4dGVudC5zZXRJZ25v\ncmVDaGFuZ2VzKF9pZ25vcmVDaGFuZ2VzKTsKICAgICAgICAgICAgfQogICAg\nICAgICAgICByZXR1cm4gX2V4dGVudDsKICAgICAgICB9IGZpbmFsbHkgewog\nICAgICAgICAgICB1bmxvY2soKTsKICAgICAgICB9CiAgICB9CgogICAgcHVi\nbGljIHZvaWQgc2V0Q2FuZGlkYXRlRXh0ZW50KEV4dGVudCBjYW5kaWRhdGVF\neHRlbnQpIHsKICAgICAgICBsb2NrKCk7CiAgICAgICAgdHJ5IHsKICAgICAg\nICAgICAgYXNzZXJ0T3BlbigpOwogICAgICAgICAgICBhc3NlcnROb3RSZWFk\nT25seSgpOwoKICAgICAgICAgICAgaWYgKGNhbmRpZGF0ZUV4dGVudCA9PSBf\nZXh0ZW50KQogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICBp\nZiAoY2FuZGlkYXRlRXh0ZW50ID09IG51bGwpIHsKICAgICAgICAgICAgICAg\nIF9leHRlbnQgPSBudWxsOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAg\nICAgICAgICB9CgogICAgICAgICAgICAvLyBpZiBleHRlbnQgdGhlbiBub3Qg\nY29sbGVjdGlvbgogICAgICAgICAgICBfZXh0ZW50ID0gY2FuZGlkYXRlRXh0\nZW50OwogICAgICAgICAgICBfY29sbGVjdGlvbiA9IG51bGw7CgogICAgICAg\nICAgICBib29sZWFuIGludmFsaWRhdGUgPSBmYWxzZTsKICAgICAgICAgICAg\naWYgKF9leHRlbnQuZ2V0RWxlbWVudFR5cGUoKSAhPSBfY2xhc3MpIHsKICAg\nICAgICAgICAgICAgIF9jbGFzcyA9IF9leHRlbnQuZ2V0RWxlbWVudFR5cGUo\nKTsKICAgICAgICAgICAgICAgIF9sb2FkZXIgPSBudWxsOwogICAgICAgICAg\nICAgICAgaW52YWxpZGF0ZSA9IHRydWU7CiAgICAgICAgICAgIH0KICAgICAg\nICAgICAgaWYgKF9leHRlbnQuaGFzU3ViY2xhc3NlcygpICE9IF9zdWJjbGFz\nc2VzKSB7CiAgICAgICAgICAgICAgICBfc3ViY2xhc3NlcyA9IF9leHRlbnQu\naGFzU3ViY2xhc3NlcygpOwogICAgICAgICAgICAgICAgaW52YWxpZGF0ZSA9\nIHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKGludmFsaWRh\ndGUpCiAgICAgICAgICAgICAgICBpbnZhbGlkYXRlQ29tcGlsYXRpb24oKTsK\nICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICB1bmxvY2soKTsKICAg\nICAgICB9CiAgICB9CgogICAgcHVibGljIENvbGxlY3Rpb248Pz4gZ2V0Q2Fu\nZGlkYXRlQ29sbGVjdGlvbigpIHsKICAgICAgICBhc3NlcnRPcGVuKCk7CiAg\nICAgICAgcmV0dXJuIF9jb2xsZWN0aW9uOwogICAgfQoKICAgIHB1YmxpYyB2\nb2lkIHNldENhbmRpZGF0ZUNvbGxlY3Rpb24oQ29sbGVjdGlvbjw/PiBjYW5k\naWRhdGVDb2xsZWN0aW9uKSB7CiAgICAgICAgaWYgKCFfc3RvcmVRdWVyeS5z\ndXBwb3J0c0luTWVtb3J5RXhlY3V0aW9uKCkpCiAgICAgICAgICAgIHRocm93\nIG5ldyBVbnN1cHBvcnRlZEV4Y2VwdGlvbihfbG9jLmdldCgicXVlcnktbm9z\ndXBwb3J0IiwKICAgICAgICAgICAgICAgIF9sYW5ndWFnZSkpOwoKICAgICAg\nICBsb2NrKCk7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgYXNzZXJ0T3Bl\nbigpOwoKICAgICAgICAgICAgLy8gaWYgY29sbGVjdGlvbiB0aGVuIG5vdCBl\neHRlbnQKICAgICAgICAgICAgX2NvbGxlY3Rpb24gPSBjYW5kaWRhdGVDb2xs\nZWN0aW9uOwogICAgICAgICAgICBpZiAoX2NvbGxlY3Rpb24gIT0gbnVsbCkK\nICAgICAgICAgICAgICAgIF9leHRlbnQgPSBudWxsOwogICAgICAgIH0gZmlu\nYWxseSB7CiAgICAgICAgICAgIHVubG9jaygpOwogICAgICAgIH0KICAgIH0K\nCiAgICBwdWJsaWMgQ2xhc3MgZ2V0Q2FuZGlkYXRlVHlwZSgpIHsKICAgICAg\nICBsb2NrKCk7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgYXNzZXJ0T3Bl\nbigpOwogICAgICAgICAgICBpZiAoX2NsYXNzICE9IG51bGwgfHwgX2NvbXBp\nbGVkICE9IG51bGwgfHwgX3F1ZXJ5ID09IG51bGwKICAgICAgICAgICAgICAg\nIHx8IF9icm9rZXIgPT0gbnVsbCkKICAgICAgICAgICAgICAgIHJldHVybiBf\nY2xhc3M7CgogICAgICAgICAgICAvLyBjaGVjayBhZ2FpbiBhZnRlciBjb21w\naWxhdGlvbjsgbWF5YmUgZW5jb2RlZCBpbiBzdHJpbmcKICAgICAgICAgICAg\nY29tcGlsZUZvckNvbXBpbGF0aW9uKCk7CiAgICAgICAgICAgIHJldHVybiBf\nY2xhc3M7CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgdW5sb2Nr\nKCk7CiAgICAgICAgfQogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldENhbmRp\nZGF0ZVR5cGUoQ2xhc3MgY2FuZGlkYXRlQ2xhc3MsIGJvb2xlYW4gc3Vicykg\newogICAgICAgIGxvY2soKTsKICAgICAgICB0cnkgewogICAgICAgICAgICBh\nc3NlcnRPcGVuKCk7CiAgICAgICAgICAgIGFzc2VydE5vdFJlYWRPbmx5KCk7\nCiAgICAgICAgICAgIF9jbGFzcyA9IGNhbmRpZGF0ZUNsYXNzOwogICAgICAg\nICAgICBfc3ViY2xhc3NlcyA9IHN1YnM7CiAgICAgICAgICAgIF9sb2FkZXIg\nPSBudWxsOwogICAgICAgICAgICBpbnZhbGlkYXRlQ29tcGlsYXRpb24oKTsK\nICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICB1bmxvY2soKTsKICAg\nICAgICB9CiAgICB9CgogICAgcHVibGljIGJvb2xlYW4gaGFzU3ViY2xhc3Nl\ncygpIHsKICAgICAgICByZXR1cm4gX3N1YmNsYXNzZXM7CiAgICB9CgogICAg\ncHVibGljIFN0cmluZyBnZXRSZXN1bHRNYXBwaW5nTmFtZSgpIHsKICAgICAg\nICBhc3NlcnRPcGVuKCk7CiAgICAgICAgcmV0dXJuIF9yZXN1bHRNYXBwaW5n\nTmFtZTsKICAgIH0KCiAgICBwdWJsaWMgQ2xhc3MgZ2V0UmVzdWx0TWFwcGlu\nZ1Njb3BlKCkgewogICAgICAgIGFzc2VydE9wZW4oKTsKICAgICAgICByZXR1\ncm4gX3Jlc3VsdE1hcHBpbmdTY29wZTsKICAgIH0KCiAgICBwdWJsaWMgdm9p\nZCBzZXRSZXN1bHRNYXBwaW5nKENsYXNzPD8+IHNjb3BlLCBTdHJpbmcgbmFt\nZSkgewogICAgICAgIGxvY2soKTsKICAgICAgICB0cnkgewogICAgICAgICAg\nICBhc3NlcnRPcGVuKCk7CiAgICAgICAgICAgIF9yZXN1bHRNYXBwaW5nU2Nv\ncGUgPSBzY29wZTsKICAgICAgICAgICAgX3Jlc3VsdE1hcHBpbmdOYW1lID0g\nbmFtZTsKICAgICAgICAgICAgX3BhY2tlciA9IG51bGw7CiAgICAgICAgfSBm\naW5hbGx5IHsKICAgICAgICAgICAgdW5sb2NrKCk7CiAgICAgICAgfQogICAg\nfQoKICAgIHB1YmxpYyBib29sZWFuIGlzVW5pcXVlKCkgewogICAgICAgIGxv\nY2soKTsKICAgICAgICB0cnkgewogICAgICAgICAgICBhc3NlcnRPcGVuKCk7\nCiAgICAgICAgICAgIGlmIChfdW5pcXVlICE9IG51bGwpCiAgICAgICAgICAg\nICAgICByZXR1cm4gX3VuaXF1ZS5ib29sZWFuVmFsdWUoKTsKICAgICAgICAg\nICAgaWYgKChfcXVlcnkgPT0gbnVsbCAmJiBfbGFuZ3VhZ2UuZW5kc1dpdGgo\nIkpQUUwiKSkgfHwgX2NvbXBpbGluZyB8fCBfYnJva2VyID09IG51bGwpCiAg\nICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgogICAgICAgICAgICAvLyBj\naGVjayBhZ2FpbiBhZnRlciBjb21waWxhdGlvbjsgbWF5YmUgZW5jb2RlZCBp\nbiBzdHJpbmcKICAgICAgICAgICAgaWYgKF9jb21waWxlZCA9PSBudWxsKSB7\nCiAgICAgICAgICAgICAgICBjb21waWxlRm9yQ29tcGlsYXRpb24oKTsKICAg\nICAgICAgICAgICAgIGlmIChfdW5pcXVlICE9IG51bGwpCiAgICAgICAgICAg\nICAgICAgICAgcmV0dXJuIF91bmlxdWUuYm9vbGVhblZhbHVlKCk7CiAgICAg\nICAgICAgIH0KCiAgICAgICAgICAgIC8vIG5vIGV4cGxpY2l0IHNldHRpbmc7\nIGRlZmF1bHQKICAgICAgICAgICAgU3RvcmVRdWVyeS5FeGVjdXRvciBleCA9\nIGNvbXBpbGVGb3JFeGVjdXRvcigpOwogICAgICAgICAgICBpZiAoIWV4Lmlz\nQWdncmVnYXRlKF9zdG9yZVF1ZXJ5KSkKICAgICAgICAgICAgICAgIHJldHVy\nbiBmYWxzZTsKICAgICAgICAgICAgcmV0dXJuICFleC5oYXNHcm91cGluZyhf\nc3RvcmVRdWVyeSk7CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAg\ndW5sb2NrKCk7CiAgICAgICAgfQogICAgfQogICAgCiAgICAvKioKICAgICAq\nIEFmZmlybXMgaWYgdGhpcyBxdWVyeSBoYXMgb3JpZ2luYXRlZCBieSBwYXJz\naW5nIGEgc3RyaW5nLWJhc2VkIHF1ZXJ5LgogICAgICovCiAgICBwdWJsaWMg\nYm9vbGVhbiBpc1BhcnNlZFF1ZXJ5KCkgewogICAgICAgIHJldHVybiBnZXRR\ndWVyeVN0cmluZygpICE9IG51bGw7CiAgICB9CgogICAgcHVibGljIHZvaWQg\nc2V0VW5pcXVlKGJvb2xlYW4gdW5pcXVlKSB7CiAgICAgICAgbG9jaygpOwog\nICAgICAgIHRyeSB7CiAgICAgICAgICAgIGFzc2VydE9wZW4oKTsKICAgICAg\nICAgICAgYXNzZXJ0Tm90UmVhZE9ubHkoKTsKICAgICAgICAgICAgX3VuaXF1\nZSA9ICh1bmlxdWUpID8gQm9vbGVhbi5UUlVFIDogQm9vbGVhbi5GQUxTRTsK\nICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICB1bmxvY2soKTsKICAg\nICAgICB9CiAgICB9CgogICAgcHVibGljIENsYXNzIGdldFJlc3VsdFR5cGUo\nKSB7CiAgICAgICAgbG9jaygpOwogICAgICAgIHRyeSB7CiAgICAgICAgICAg\nIGFzc2VydE9wZW4oKTsKICAgICAgICAgICAgaWYgKF9yZXN1bHRDbGFzcyAh\nPSBudWxsIHx8IF9jb21waWxlZCAhPSBudWxsIHx8IF9xdWVyeSA9PSBudWxs\nCiAgICAgICAgICAgICAgICB8fCBfYnJva2VyID09IG51bGwpCiAgICAgICAg\nICAgICAgICByZXR1cm4gX3Jlc3VsdENsYXNzOwoKICAgICAgICAgICAgLy8g\nY2hlY2sgYWdhaW4gYWZ0ZXIgY29tcGlsYXRpb247IG1heWJlIGVuY29kZWQg\naW4gc3RyaW5nCiAgICAgICAgICAgIGNvbXBpbGVGb3JDb21waWxhdGlvbigp\nOwogICAgICAgICAgICByZXR1cm4gX3Jlc3VsdENsYXNzOwogICAgICAgIH0g\nZmluYWxseSB7CiAgICAgICAgICAgIHVubG9jaygpOwogICAgICAgIH0KICAg\nIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRSZXN1bHRUeXBlKENsYXNzIGNscykg\newogICAgICAgIGxvY2soKTsKICAgICAgICB0cnkgewogICAgICAgICAgICBh\nc3NlcnRPcGVuKCk7CiAgICAgICAgICAgIC8vIGFsbG93ZWQgbW9kaWZpY2F0\naW9uOiBubyByZWFkLW9ubHkgY2hlY2sKICAgICAgICAgICAgX3Jlc3VsdENs\nYXNzID0gY2xzOwogICAgICAgICAgICBfcGFja2VyID0gbnVsbDsKICAgICAg\nICB9IGZpbmFsbHkgewogICAgICAgICAgICB1bmxvY2soKTsKICAgICAgICB9\nCiAgICB9CgogICAgcHVibGljIGxvbmcgZ2V0U3RhcnRSYW5nZSgpIHsKICAg\nICAgICBhc3NlcnRPcGVuKCk7CiAgICAgICAgcmV0dXJuIF9zdGFydElkeDsK\nICAgIH0KCiAgICBwdWJsaWMgbG9uZyBnZXRFbmRSYW5nZSgpIHsKICAgICAg\nICBhc3NlcnRPcGVuKCk7CiAgICAgICAgcmV0dXJuIF9lbmRJZHg7CiAgICB9\nCgogICAgcHVibGljIHZvaWQgc2V0UmFuZ2UobG9uZyBzdGFydCwgbG9uZyBl\nbmQpIHsKICAgICAgICBpZiAoc3RhcnQgPCAwIHx8IGVuZCA8IDApCiAgICAg\nICAgICAgIHRocm93IG5ldyBVc2VyRXhjZXB0aW9uKF9sb2MuZ2V0KCJpbnZh\nbGlkLXJhbmdlIiwKICAgICAgICAgICAgICAgIFN0cmluZy52YWx1ZU9mKHN0\nYXJ0KSwgU3RyaW5nLnZhbHVlT2YoZW5kKSkpOwoKICAgICAgICBpZiAoZW5k\nIC0gc3RhcnQgPiBJbnRlZ2VyLk1BWF9WQUxVRSAmJiBlbmQgIT0gTG9uZy5N\nQVhfVkFMVUUpCiAgICAgICAgICAgIHRocm93IG5ldyBVc2VyRXhjZXB0aW9u\nKF9sb2MuZ2V0KCJyYW5nZS10b28tYmlnIiwKICAgICAgICAgICAgICAgIFN0\ncmluZy52YWx1ZU9mKHN0YXJ0KSwgU3RyaW5nLnZhbHVlT2YoZW5kKSkpOwoK\nICAgICAgICBsb2NrKCk7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgYXNz\nZXJ0T3BlbigpOwogICAgICAgICAgICAvLyBhbGxvd2VkIG1vZGlmaWNhdGlv\nbjogbm8gcmVhZC1vbmx5IGNoZWNrCiAgICAgICAgICAgIF9zdGFydElkeCA9\nIHN0YXJ0OwogICAgICAgICAgICBfZW5kSWR4ID0gZW5kOwogICAgICAgICAg\nICBfcmFuZ2VTZXQgPSB0cnVlOwogICAgICAgIH0gZmluYWxseSB7CiAgICAg\nICAgICAgIHVubG9jaygpOwogICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMg\nU3RyaW5nIGdldFBhcmFtZXRlckRlY2xhcmF0aW9uKCkgewogICAgICAgIGxv\nY2soKTsKICAgICAgICB0cnkgewogICAgICAgICAgICBhc3NlcnRPcGVuKCk7\nCiAgICAgICAgICAgIGlmIChfcGFyYW1zICE9IG51bGwgfHwgX2NvbXBpbGVk\nICE9IG51bGwgfHwgX2NvbXBpbGluZwogICAgICAgICAgICAgICAgfHwgX2Jy\nb2tlciA9PSBudWxsKQogICAgICAgICAgICAgICAgcmV0dXJuIF9wYXJhbXM7\nCgogICAgICAgICAgICAvLyBjaGVjayBhZ2FpbiBhZnRlciBjb21waWxhdGlv\nbjsgbWF5YmUgZW5jb2RlZCBpbiBzdHJpbmcKICAgICAgICAgICAgY29tcGls\nZUZvckNvbXBpbGF0aW9uKCk7CiAgICAgICAgICAgIHJldHVybiBfcGFyYW1z\nOwogICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgIHVubG9jaygpOwog\nICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMgdm9pZCBkZWNsYXJlUGFyYW1l\ndGVycyhTdHJpbmcgcGFyYW1zKSB7CiAgICAgICAgaWYgKCFfc3RvcmVRdWVy\neS5zdXBwb3J0c1BhcmFtZXRlckRlY2xhcmF0aW9ucygpKQogICAgICAgICAg\nICB0aHJvdyBuZXcgVW5zdXBwb3J0ZWRFeGNlcHRpb24oX2xvYy5nZXQoInF1\nZXJ5LW5vc3VwcG9ydCIsCiAgICAgICAgICAgICAgICBfbGFuZ3VhZ2UpKTsK\nCiAgICAgICAgbG9jaygpOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIGFz\nc2VydE9wZW4oKTsKICAgICAgICAgICAgYXNzZXJ0Tm90UmVhZE9ubHkoKTsK\nICAgICAgICAgICAgX3BhcmFtcyA9IFN0cmluZ1V0aWxzLnRyaW1Ub051bGwo\ncGFyYW1zKTsKICAgICAgICAgICAgaW52YWxpZGF0ZUNvbXBpbGF0aW9uKCk7\nCiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgdW5sb2NrKCk7CiAg\nICAgICAgfQogICAgfQoKICAgIHB1YmxpYyB2b2lkIGNvbXBpbGUoKSB7CiAg\nICAgICAgbG9jaygpOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIGFzc2Vy\ndE9wZW4oKTsKICAgICAgICAgICAgU3RvcmVRdWVyeS5FeGVjdXRvciBleCA9\nIGNvbXBpbGVGb3JFeGVjdXRvcigpOwogICAgICAgICAgICBnZXRSZXN1bHRQ\nYWNrZXIoX3N0b3JlUXVlcnksIGV4KTsKICAgICAgICAgICAgZXgudmFsaWRh\ndGUoX3N0b3JlUXVlcnkpOwogICAgICAgIH0gZmluYWxseSB7CiAgICAgICAg\nICAgIHVubG9jaygpOwogICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMgT2Jq\nZWN0IGdldENvbXBpbGF0aW9uKCkgewogICAgICAgIGxvY2soKTsKICAgICAg\nICB0cnkgewogICAgICAgICAgICByZXR1cm4gY29tcGlsZUZvckNvbXBpbGF0\naW9uKCkuc3RvcmVEYXRhOwogICAgICAgIH0gZmluYWxseSB7CiAgICAgICAg\nICAgIHVubG9jaygpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAq\nIENvbXBpbGUgcXVlcnkgcHJvcGVydGllcy4KICAgICAqLwogICAgcHJpdmF0\nZSBDb21waWxhdGlvbiBjb21waWxlRm9yQ29tcGlsYXRpb24oKSB7CiAgICAg\nICAgaWYgKF9jb21waWxlZCAhPSBudWxsIHx8IF9jb21waWxpbmcpCiAgICAg\nICAgICAgIHJldHVybiBfY29tcGlsZWQ7CgogICAgICAgIGFzc2VydE5vdFNl\ncmlhbGl6ZWQoKTsKICAgICAgICBhc3NlcnRPcGVuKCk7CgogICAgICAgIGJv\nb2xlYW4gcmVhZE9ubHkgPSBfcmVhZE9ubHk7CiAgICAgICAgX3JlYWRPbmx5\nID0gZmFsc2U7CiAgICAgICAgX2NvbXBpbGluZyA9IHRydWU7CiAgICAgICAg\ndHJ5IHsKICAgICAgICAgICAgX2NvbXBpbGVkID0gY29tcGlsYXRpb25Gcm9t\nQ2FjaGUoKTsKICAgICAgICAgICAgcmV0dXJuIF9jb21waWxlZDsKICAgICAg\nICB9IGNhdGNoIChPcGVuSlBBRXhjZXB0aW9uIGtlKSB7CiAgICAgICAgICAg\nIHRocm93IGtlOwogICAgICAgIH0gY2F0Y2ggKFJ1bnRpbWVFeGNlcHRpb24g\ncmUpIHsKICAgICAgICAgICAgdGhyb3cgbmV3IEdlbmVyYWxFeGNlcHRpb24o\ncmUpOwogICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgIF9jb21waWxp\nbmcgPSBmYWxzZTsKICAgICAgICAgICAgX3JlYWRPbmx5ID0gcmVhZE9ubHk7\nCiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogRmluZCB0aGUgY2Fj\naGVkIGNvbXBpbGF0aW9uIGZvciB0aGUgY3VycmVudCBxdWVyeSwgY3JlYXRp\nbmcgb25lIGlmIGl0CiAgICAgKiBkb2VzIG5vdCBleGlzdC4KICAgICAqLwog\nICAgcHJvdGVjdGVkIENvbXBpbGF0aW9uIGNvbXBpbGF0aW9uRnJvbUNhY2hl\nKCkgewogICAgICAgIE1hcCBjb21wQ2FjaGUgPQogICAgICAgICAgICBfYnJv\na2VyLmdldENvbmZpZ3VyYXRpb24oKS5nZXRRdWVyeUNvbXBpbGF0aW9uQ2Fj\naGVJbnN0YW5jZSgpOwogICAgICAgIGlmIChjb21wQ2FjaGUgPT0gbnVsbCB8\nfCAhaXNQYXJzZWRRdWVyeSgpKSB7CiAgICAgICAgICAgIHJldHVybiBuZXdD\nb21waWxhdGlvbigpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIENv\nbXBpbGF0aW9uS2V5IGtleSA9IG5ldyBDb21waWxhdGlvbktleSgpOwogICAg\nICAgICAgICBrZXkucXVlcnlUeXBlID0gX3N0b3JlUXVlcnkuZ2V0Q2xhc3Mo\nKTsKICAgICAgICAgICAga2V5LmNhbmRpZGF0ZVR5cGUgPSBnZXRDYW5kaWRh\ndGVUeXBlKCk7CiAgICAgICAgICAgIGtleS5zdWJjbGFzc2VzID0gaGFzU3Vi\nY2xhc3NlcygpOwogICAgICAgICAgICBrZXkucXVlcnkgPSBnZXRRdWVyeVN0\ncmluZygpOwogICAgICAgICAgICBrZXkubGFuZ3VhZ2UgPSBnZXRMYW5ndWFn\nZSgpOwogICAgICAgICAgICBrZXkuc3RvcmVLZXkgPSBfc3RvcmVRdWVyeS5u\nZXdDb21waWxhdGlvbktleSgpOwogICAgICAgICAgICBDb21waWxhdGlvbiBj\nb21wID0gKENvbXBpbGF0aW9uKSBjb21wQ2FjaGUuZ2V0KGtleSk7CgogICAg\nICAgICAgICAvLyBwYXJzZSBkZWNsYXJhdGlvbnMgaWYgbmVlZGVkCiAgICAg\nICAgICAgIGJvb2xlYW4gY2FjaGUgPSBmYWxzZTsKICAgICAgICAgICAgaWYg\nKGNvbXAgPT0gbnVsbCkgewogICAgICAgICAgICAgICAgY29tcCA9IG5ld0Nv\nbXBpbGF0aW9uKCk7CiAgICAgICAgICAgICAgICAvLyBvbmx5IGNhY2hlIHRo\nb3NlIHF1ZXJpZXMgdGhhdCBjYW4gYmUgY29tcGlsZWQKICAgICAgICAgICAg\nICAgIGNhY2hlID0gY29tcC5zdG9yZURhdGEgIT0gbnVsbDsKICAgICAgICAg\nICAgfSBlbHNlCiAgICAgICAgICAgICAgICBfc3RvcmVRdWVyeS5wb3B1bGF0\nZUZyb21Db21waWxhdGlvbihjb21wLnN0b3JlRGF0YSk7CgogICAgICAgICAg\nICAvLyBjYWNoZSBwYXJzZWQgc3RhdGUgaWYgbmVlZGVkCiAgICAgICAgICAg\nIGlmIChjYWNoZSkKICAgICAgICAgICAgICAgIGNvbXBDYWNoZS5wdXQoa2V5\nLCBjb21wKTsKICAgICAgICAgICAgcmV0dXJuIGNvbXA7CiAgICAgICAgfQog\nICAgfQogICAgCiAgICAvKioKICAgICAqIENyZWF0ZSBhbmQgcG9wdWxhdGUg\nYSBuZXcgY29tcGlsYXRpb24uCiAgICAgKi8KICAgIHByaXZhdGUgQ29tcGls\nYXRpb24gbmV3Q29tcGlsYXRpb24oKSB7CiAgICAgICAgQ29tcGlsYXRpb24g\nY29tcCA9IG5ldyBDb21waWxhdGlvbigpOwogICAgICAgIGNvbXAuc3RvcmVE\nYXRhID0gX3N0b3JlUXVlcnkubmV3Q29tcGlsYXRpb24oKTsKICAgICAgICBf\nc3RvcmVRdWVyeS5wb3B1bGF0ZUZyb21Db21waWxhdGlvbihjb21wLnN0b3Jl\nRGF0YSk7CiAgICAgICAgcmV0dXJuIGNvbXA7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBDb21waWxlIGZvciBleGVjdXRpb24sIGNob29zaW5nIGJldHdlZW4g\nZGF0YXN0b3JlIGFuZCBpbi1tZW0KICAgICAqIGNvbXBpbGF0aW9uIGJhc2Vk\nIG9uIHdoYXQgd2Ugc3VwcG9ydCBhbmQgb3VyIHNldHRpbmdzLgogICAgICov\nCiAgICBwcml2YXRlIFN0b3JlUXVlcnkuRXhlY3V0b3IgY29tcGlsZUZvckV4\nZWN1dG9yKCkgewogICAgICAgIENvbXBpbGF0aW9uIGNvbXAgPSBjb21waWxl\nRm9yQ29tcGlsYXRpb24oKTsKICAgICAgICBpZiAoX2NvbGxlY3Rpb24gPT0g\nbnVsbCkgewogICAgICAgICAgICBpZiAoY29tcC5kYXRhc3RvcmUgIT0gbnVs\nbCkKICAgICAgICAgICAgICAgIHJldHVybiBjb21wLmRhdGFzdG9yZTsKICAg\nICAgICAgICAgaWYgKGNvbXAubWVtb3J5ICE9IG51bGwpCiAgICAgICAgICAg\nICAgICByZXR1cm4gY29tcC5tZW1vcnk7CiAgICAgICAgICAgIGlmIChfc3Rv\ncmVRdWVyeS5zdXBwb3J0c0RhdGFTdG9yZUV4ZWN1dGlvbigpKQogICAgICAg\nICAgICAgICAgcmV0dXJuIGNvbXBpbGVGb3JEYXRhU3RvcmUoY29tcCk7CiAg\nICAgICAgICAgIHJldHVybiBjb21waWxlRm9ySW5NZW1vcnkoY29tcCk7CiAg\nICAgICAgfQoKICAgICAgICBpZiAoY29tcC5tZW1vcnkgIT0gbnVsbCkKICAg\nICAgICAgICAgcmV0dXJuIGNvbXAubWVtb3J5OwogICAgICAgIGlmIChjb21w\nLmRhdGFzdG9yZSAhPSBudWxsKQogICAgICAgICAgICByZXR1cm4gY29tcC5k\nYXRhc3RvcmU7CiAgICAgICAgaWYgKF9zdG9yZVF1ZXJ5LnN1cHBvcnRzSW5N\nZW1vcnlFeGVjdXRpb24oKSkKICAgICAgICAgICAgcmV0dXJuIGNvbXBpbGVG\nb3JJbk1lbW9yeShjb21wKTsKICAgICAgICByZXR1cm4gY29tcGlsZUZvckRh\ndGFTdG9yZShjb21wKTsKICAgIH0KCiAgICAvKioKICAgICAqIENyZWF0ZSBh\nbiBleHByZXNzaW9uIHRyZWUgZm9yIGRhdGFzdG9yZSBleGVjdXRpb24uCiAg\nICAgKi8KICAgIHByaXZhdGUgU3RvcmVRdWVyeS5FeGVjdXRvciBjb21waWxl\nRm9yRGF0YVN0b3JlKENvbXBpbGF0aW9uIGNvbXApIHsKICAgICAgICBpZiAo\nY29tcC5kYXRhc3RvcmUgPT0gbnVsbCkKICAgICAgICAgICAgY29tcC5kYXRh\nc3RvcmUgPSBjcmVhdGVFeGVjdXRvcihmYWxzZSk7CiAgICAgICAgcmV0dXJu\nIGNvbXAuZGF0YXN0b3JlOwogICAgfQoKICAgIC8qKgogICAgICogQ3JlYXRl\nIGFuIGV4cHJlc3Npb24gdHJlZSBmb3IgaW4tbWVtb3J5IGV4ZWN1dGlvbi4K\nICAgICAqLwogICAgcHJpdmF0ZSBTdG9yZVF1ZXJ5LkV4ZWN1dG9yIGNvbXBp\nbGVGb3JJbk1lbW9yeShDb21waWxhdGlvbiBjb21wKSB7CiAgICAgICAgaWYg\nKGNvbXAubWVtb3J5ID09IG51bGwpCiAgICAgICAgICAgIGNvbXAubWVtb3J5\nID0gY3JlYXRlRXhlY3V0b3IodHJ1ZSk7CiAgICAgICAgcmV0dXJuIGNvbXAu\nbWVtb3J5OwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIGEgcXVlcnkg\nZXhlY3V0b3Igb2YgdGhlIHByb3BlciB0eXBlLgogICAgICovCiAgICBwcml2\nYXRlIFN0b3JlUXVlcnkuRXhlY3V0b3IgY3JlYXRlRXhlY3V0b3IoYm9vbGVh\nbiBpbk1lbSkgewogICAgICAgIGFzc2VydENhbmRpZGF0ZVR5cGUoKTsKCiAg\nICAgICAgTWV0YURhdGFSZXBvc2l0b3J5IHJlcG9zID0gX2Jyb2tlci5nZXRD\nb25maWd1cmF0aW9uKCkuCiAgICAgICAgICAgIGdldE1ldGFEYXRhUmVwb3Np\ndG9yeUluc3RhbmNlKCk7CiAgICAgICAgQ2xhc3NNZXRhRGF0YSBtZXRhID0g\ncmVwb3MuZ2V0TWV0YURhdGEoX2NsYXNzLAogICAgICAgICAgICBfYnJva2Vy\nLmdldENsYXNzTG9hZGVyKCksIGZhbHNlKTsKCiAgICAgICAgQ2xhc3NNZXRh\nRGF0YVtdIG1ldGFzOwogICAgICAgIGlmIChfY2xhc3MgPT0gbnVsbCB8fCBf\nc3RvcmVRdWVyeS5zdXBwb3J0c0Fic3RyYWN0RXhlY3V0b3JzKCkpCiAgICAg\nICAgICAgIG1ldGFzID0gbmV3IENsYXNzTWV0YURhdGFbXXsgbWV0YSB9Owog\nICAgICAgIGVsc2UgaWYgKF9zdWJjbGFzc2VzICYmIChtZXRhID09IG51bGwg\nfHwgbWV0YS5pc01hbmFnZWRJbnRlcmZhY2UoKSkpCiAgICAgICAgICAgIG1l\ndGFzID0gcmVwb3MuZ2V0SW1wbGVtZW50b3JNZXRhRGF0YXMoX2NsYXNzLAog\nICAgICAgICAgICAgICAgX2Jyb2tlci5nZXRDbGFzc0xvYWRlcigpLCB0cnVl\nKTsKICAgICAgICBlbHNlIGlmIChtZXRhICE9IG51bGwgJiYgKF9zdWJjbGFz\nc2VzIHx8IG1ldGEuaXNNYXBwZWQoKSkpCiAgICAgICAgICAgIG1ldGFzID0g\nbmV3IENsYXNzTWV0YURhdGFbXXsgbWV0YSB9OwogICAgICAgIGVsc2UKICAg\nICAgICAgICAgbWV0YXMgPSBTdG9yZVF1ZXJ5LkVNUFRZX01FVEFTOwoKICAg\nICAgICBpZiAobWV0YXMubGVuZ3RoID09IDApCiAgICAgICAgICAgIHRocm93\nIG5ldyBVc2VyRXhjZXB0aW9uKF9sb2MuZ2V0KCJuby1pbXBscyIsIF9jbGFz\ncykpOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIGlmIChtZXRhcy5sZW5n\ndGggPT0gMSkgewogICAgICAgICAgICAgICAgaWYgKGluTWVtKQogICAgICAg\nICAgICAgICAgICAgIHJldHVybiBfc3RvcmVRdWVyeS5uZXdJbk1lbW9yeUV4\nZWN1dG9yKG1ldGFzWzBdLAogICAgICAgICAgICAgICAgICAgICAgICBfc3Vi\nY2xhc3Nlcyk7CiAgICAgICAgICAgICAgICByZXR1cm4gX3N0b3JlUXVlcnku\nbmV3RGF0YVN0b3JlRXhlY3V0b3IobWV0YXNbMF0sIF9zdWJjbGFzc2VzKTsK\nICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gbXVsdGlwbGUgaW1wbGVt\nZW50b3JzCiAgICAgICAgICAgIFN0b3JlUXVlcnkuRXhlY3V0b3JbXSBlcyA9\nIG5ldyBTdG9yZVF1ZXJ5LkV4ZWN1dG9yW21ldGFzLmxlbmd0aF07CiAgICAg\nICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgZXMubGVuZ3RoOyBpKyspIHsK\nICAgICAgICAgICAgICAgIGlmIChpbk1lbSkKICAgICAgICAgICAgICAgICAg\nICBlc1tpXSA9IF9zdG9yZVF1ZXJ5Lm5ld0luTWVtb3J5RXhlY3V0b3IobWV0\nYXNbaV0sIHRydWUpOwogICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAg\nICAgICAgICAgIGVzW2ldID0gX3N0b3JlUXVlcnkubmV3RGF0YVN0b3JlRXhl\nY3V0b3IobWV0YXNbaV0sIHRydWUpOwogICAgICAgICAgICB9CiAgICAgICAg\nICAgIHJldHVybiBuZXcgTWVyZ2VkRXhlY3V0b3IoZXMpOwogICAgICAgIH0g\nY2F0Y2ggKE9wZW5KUEFFeGNlcHRpb24ga2UpIHsKICAgICAgICAgICAgdGhy\nb3cga2U7CiAgICAgICAgfSBjYXRjaCAoUnVudGltZUV4Y2VwdGlvbiByZSkg\newogICAgICAgICAgICB0aHJvdyBuZXcgR2VuZXJhbEV4Y2VwdGlvbihyZSk7\nCiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogQ2xlYXIgYW55IGNv\nbXBpbGF0aW9uLCBmb3JjaW5nIHRoaXMgcXVlcnkgdG8gYmUgcmVjb21waWxl\nZAogICAgICogbmV4dCB0aW1lIGl0J3MgZXhlY3V0ZWQuIFRoaXMgc2hvdWxk\nIGJlIGludm9rZWQgd2hlbmV2ZXIgYW55CiAgICAgKiBzdGF0ZSBjaGFuZ2Vz\nIHRoYXQgd291bGQgY2F1c2UgdGhlIHVuZGVybHlpbmcgcXVlcnkKICAgICAq\nIHJlcHJlc2VudGF0aW9uIHRvIGNoYW5nZS4KICAgICAqCiAgICAgKiBAc2lu\nY2UgMC4zLjAKICAgICAqLwogICAgcHJpdmF0ZSBib29sZWFuIGludmFsaWRh\ndGVDb21waWxhdGlvbigpIHsKICAgICAgICBpZiAoX2NvbXBpbGluZykKICAg\nICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIF9zdG9yZVF1ZXJ5Lmlu\ndmFsaWRhdGVDb21waWxhdGlvbigpOwogICAgICAgIF9jb21waWxlZCA9IG51\nbGw7CiAgICAgICAgX3BhY2tlciA9IG51bGw7CiAgICAgICAgcmV0dXJuIHRy\ndWU7CiAgICB9CgogICAgcHVibGljIE9iamVjdCBleGVjdXRlKCkgewogICAg\nICAgIHJldHVybiBleGVjdXRlKChPYmplY3RbXSkgbnVsbCk7CiAgICB9Cgog\nICAgcHVibGljIE9iamVjdCBleGVjdXRlKE9iamVjdFtdIHBhcmFtcykgewog\nICAgICAgIHJldHVybiBleGVjdXRlKE9QX1NFTEVDVCwgcGFyYW1zKTsKICAg\nIH0KCiAgICBwdWJsaWMgT2JqZWN0IGV4ZWN1dGUoTWFwIHBhcmFtcykgewog\nICAgICAgIHJldHVybiBleGVjdXRlKE9QX1NFTEVDVCwgcGFyYW1zKTsKICAg\nIH0KCiAgICBwcml2YXRlIE9iamVjdCBleGVjdXRlKGludCBvcGVyYXRpb24s\nIE9iamVjdFtdIHBhcmFtcykgewogICAgICAgIGlmIChwYXJhbXMgPT0gbnVs\nbCkKICAgICAgICAgICAgcGFyYW1zID0gU3RvcmVRdWVyeS5FTVBUWV9PQkpF\nQ1RTOwoKICAgICAgICBsb2NrKCk7CiAgICAgICAgdHJ5IHsKICAgICAgICAg\nICAgYXNzZXJ0Tm90U2VyaWFsaXplZCgpOwogICAgICAgICAgICBfYnJva2Vy\nLmJlZ2luT3BlcmF0aW9uKHRydWUpOwogICAgICAgICAgICB0cnkgewogICAg\nICAgICAgICAgICAgYXNzZXJ0T3BlbigpOwogICAgICAgICAgICAgICAgX2Jy\nb2tlci5hc3NlcnROb250cmFuc2FjdGlvbmFsUmVhZCgpOwoKICAgICAgICAg\nICAgICAgIC8vIGdldCBleGVjdXRvcgogICAgICAgICAgICAgICAgQ29tcGls\nYXRpb24gY29tcCA9IGNvbXBpbGVGb3JDb21waWxhdGlvbigpOwogICAgICAg\nICAgICAgICAgU3RvcmVRdWVyeS5FeGVjdXRvciBleCA9IChpc0luTWVtb3J5\nKG9wZXJhdGlvbikpCiAgICAgICAgICAgICAgICAgICAgPyBjb21waWxlRm9y\nSW5NZW1vcnkoY29tcCkgOiBjb21waWxlRm9yRGF0YVN0b3JlKGNvbXApOwoK\nICAgICAgICAgICAgICAgIGFzc2VydFBhcmFtZXRlcnMoX3N0b3JlUXVlcnks\nIGV4LCBwYXJhbXMpOwogICAgICAgICAgICAgICAgaWYgKF9sb2cuaXNUcmFj\nZUVuYWJsZWQoKSkKICAgICAgICAgICAgICAgICAgICBsb2dFeGVjdXRpb24o\nb3BlcmF0aW9uLCBleC5nZXRPcmRlcmVkUGFyYW1ldGVyVHlwZXMoX3N0b3Jl\nUXVlcnkpLAogICAgICAgICAgICAgICAgICAgICAgICBwYXJhbXMpOwoKICAg\nICAgICAgICAgICAgIGlmIChvcGVyYXRpb24gPT0gT1BfU0VMRUNUKQogICAg\nICAgICAgICAgICAgICAgIHJldHVybiBleGVjdXRlKF9zdG9yZVF1ZXJ5LCBl\neCwgcGFyYW1zKTsKICAgICAgICAgICAgICAgIGlmIChvcGVyYXRpb24gPT0g\nT1BfREVMRVRFKQogICAgICAgICAgICAgICAgICAgIHJldHVybiBkZWxldGUo\nX3N0b3JlUXVlcnksIGV4LCBwYXJhbXMpOwogICAgICAgICAgICAgICAgaWYg\nKG9wZXJhdGlvbiA9PSBPUF9VUERBVEUpCiAgICAgICAgICAgICAgICAgICAg\ncmV0dXJuIHVwZGF0ZShfc3RvcmVRdWVyeSwgZXgsIHBhcmFtcyk7CiAgICAg\nICAgICAgICAgICB0aHJvdyBuZXcgVW5zdXBwb3J0ZWRFeGNlcHRpb24oKTsK\nICAgICAgICAgICAgfSBjYXRjaCAoT3BlbkpQQUV4Y2VwdGlvbiBrZSkgewog\nICAgICAgICAgICAgICAgdGhyb3cga2U7CiAgICAgICAgICAgIH0gY2F0Y2gg\nKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgVXNl\nckV4Y2VwdGlvbihlKTsKICAgICAgICAgICAgfSBmaW5hbGx5IHsKICAgICAg\nICAgICAgICAgIF9icm9rZXIuZW5kT3BlcmF0aW9uKCk7CiAgICAgICAgICAg\nIH0KICAgICAgICB9CiAgICAgICAgZmluYWxseSB7CiAgICAgICAgICAgIHVu\nbG9jaygpOwogICAgICAgIH0KICAgIH0KCiAgICBwcml2YXRlIE9iamVjdCBl\neGVjdXRlKGludCBvcGVyYXRpb24sIE1hcCBwYXJhbXMpIHsKICAgICAgICBp\nZiAocGFyYW1zID09IG51bGwpCiAgICAgICAgICAgIHBhcmFtcyA9IENvbGxl\nY3Rpb25zLkVNUFRZX01BUDsKCiAgICAgICAgbG9jaygpOwogICAgICAgIHRy\neSB7CiAgICAgICAgICAgIF9icm9rZXIuYmVnaW5PcGVyYXRpb24odHJ1ZSk7\nCiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBhc3NlcnROb3RT\nZXJpYWxpemVkKCk7CiAgICAgICAgICAgICAgICBhc3NlcnRPcGVuKCk7CiAg\nICAgICAgICAgICAgICBfYnJva2VyLmFzc2VydE5vbnRyYW5zYWN0aW9uYWxS\nZWFkKCk7CgogICAgICAgICAgICAgICAgLy8gZ2V0IGV4ZWN1dG9yCiAgICAg\nICAgICAgICAgICBDb21waWxhdGlvbiBjb21wID0gY29tcGlsZUZvckNvbXBp\nbGF0aW9uKCk7CiAgICAgICAgICAgICAgICBTdG9yZVF1ZXJ5LkV4ZWN1dG9y\nIGV4ID0gKGlzSW5NZW1vcnkob3BlcmF0aW9uKSkKICAgICAgICAgICAgICAg\nICAgICA/IGNvbXBpbGVGb3JJbk1lbW9yeShjb21wKSA6IGNvbXBpbGVGb3JE\nYXRhU3RvcmUoY29tcCk7CgogICAgICAgICAgICAgICAgYXNzZXJ0UGFyYW1l\ndGVycyhfc3RvcmVRdWVyeSwgZXgsIHBhcmFtcyk7CiAgICAgICAgICAgICAg\nICBPYmplY3RbXSBhcnIgPSAocGFyYW1zLmlzRW1wdHkoKSkgPyBTdG9yZVF1\nZXJ5LkVNUFRZX09CSkVDVFMgOgogICAgICAgICAgICAgICAgICAgIGV4LnRv\nUGFyYW1ldGVyQXJyYXkoX3N0b3JlUXVlcnksIHBhcmFtcyk7CiAgICAgICAg\nICAgICAgICBpZiAoX2xvZy5pc1RyYWNlRW5hYmxlZCgpKQogICAgICAgICAg\nICAgICAgICAgIGxvZ0V4ZWN1dGlvbihvcGVyYXRpb24sIHBhcmFtcyk7Cgog\nICAgICAgICAgICAgICAgaWYgKG9wZXJhdGlvbiA9PSBPUF9TRUxFQ1QpCiAg\nICAgICAgICAgICAgICAgICAgcmV0dXJuIGV4ZWN1dGUoX3N0b3JlUXVlcnks\nIGV4LCBhcnIpOwogICAgICAgICAgICAgICAgaWYgKG9wZXJhdGlvbiA9PSBP\nUF9ERUxFVEUpCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRlbGV0ZShf\nc3RvcmVRdWVyeSwgZXgsIGFycik7CiAgICAgICAgICAgICAgICBpZiAob3Bl\ncmF0aW9uID09IE9QX1VQREFURSkKICAgICAgICAgICAgICAgICAgICByZXR1\ncm4gdXBkYXRlKF9zdG9yZVF1ZXJ5LCBleCwgYXJyKTsKICAgICAgICAgICAg\nICAgIHRocm93IG5ldyBVbnN1cHBvcnRlZEV4Y2VwdGlvbigpOwogICAgICAg\nICAgICB9IGNhdGNoIChPcGVuSlBBRXhjZXB0aW9uIGtlKSB7CiAgICAgICAg\nICAgICAgICB0aHJvdyBrZTsKICAgICAgICAgICAgfSBjYXRjaCAoRXhjZXB0\naW9uIGUpIHsKICAgICAgICAgICAgICAgIHRocm93IG5ldyBVc2VyRXhjZXB0\naW9uKF9sb2MuZ2V0KCJxdWVyeS1leGVjdXRpb24tZXJyb3IiLCAKICAgICAg\nICAgICAgICAgIAkJX3F1ZXJ5KSwgZSk7CiAgICAgICAgICAgIH0gZmluYWxs\neSB7CiAgICAgICAgICAgICAgICBfYnJva2VyLmVuZE9wZXJhdGlvbigpOwog\nICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGZpbmFsbHkgewogICAg\nICAgICAgICB1bmxvY2soKTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGlj\nIGxvbmcgZGVsZXRlQWxsKCkgewogICAgICAgIHJldHVybiBkZWxldGVBbGwo\nKE9iamVjdFtdKSBudWxsKTsKICAgIH0KCiAgICBwdWJsaWMgbG9uZyBkZWxl\ndGVBbGwoT2JqZWN0W10gcGFyYW1zKSB7CiAgICAgICAgcmV0dXJuICgoTnVt\nYmVyKSBleGVjdXRlKE9QX0RFTEVURSwgcGFyYW1zKSkubG9uZ1ZhbHVlKCk7\nCiAgICB9CgogICAgcHVibGljIGxvbmcgZGVsZXRlQWxsKE1hcCBwYXJhbXMp\nIHsKICAgICAgICByZXR1cm4gKChOdW1iZXIpIGV4ZWN1dGUoT1BfREVMRVRF\nLCBwYXJhbXMpKS5sb25nVmFsdWUoKTsKICAgIH0KCiAgICBwdWJsaWMgbG9u\nZyB1cGRhdGVBbGwoKSB7CiAgICAgICAgcmV0dXJuIHVwZGF0ZUFsbCgoT2Jq\nZWN0W10pIG51bGwpOwogICAgfQoKICAgIHB1YmxpYyBsb25nIHVwZGF0ZUFs\nbChPYmplY3RbXSBwYXJhbXMpIHsKICAgICAgICByZXR1cm4gKChOdW1iZXIp\nIGV4ZWN1dGUoT1BfVVBEQVRFLCBwYXJhbXMpKS5sb25nVmFsdWUoKTsKICAg\nIH0KCiAgICBwdWJsaWMgbG9uZyB1cGRhdGVBbGwoTWFwIHBhcmFtcykgewog\nICAgICAgIHJldHVybiAoKE51bWJlcikgZXhlY3V0ZShPUF9VUERBVEUsIHBh\ncmFtcykpLmxvbmdWYWx1ZSgpOwogICAgfQoKICAgIC8qKgogICAgICogQ29u\ndmVydHMgdGhlIHZhbHVlcyBvZiBnaXZlbiA8Y29kZT5wYXJhbXM8L2NvZGU+\nIE1hcCBpbnRvIGFuIGFycmF5IGluCiAgICAgKiBjb25zdWx0YXRpb24gb2Yg\ndGhlIDxjb2RlPnBhcmFtVHlwZXM8L2NvZGU+IE1hcC4KICAgICAqIAogICAg\nICogVGhlIGluZGV4aW5nIG9mIHRoZSByZXN1bHRhbnQgYXJyYXkgaXMgc2ln\nbmlmaWNhbnQgZm9yIGZvbGxvd2luZyAKICAgICAqIGludGVycmVsYXRlZCBi\ndXQgdGFjaXQgYXNzdW1wdGlvbnM6CiAgICAgKiBUaGUgdmFsdWVzIGluIHRo\nZSByZXR1cm5lZCBPYmplY3RbXSBpcyBjb25zdW1lZCBieSB7QGxpbmsgUGFy\nYW1ldGVyfQogICAgICogZXhwcmVzc2lvbnMuIFF1ZXJ5IHBhcnNpbmcgY3Jl\nYXRlcyB0aGVzZSBQYXJhbWV0ZXJzIGFuZCBzZXRzIHRoZWlyCiAgICAgKiBr\nZXkgYW5kIGluZGV4LiBUaGUgaW5kZXggc2V0IG9uIHRoZSBQYXJhbWV0ZXIg\nYnkgdGhlIHBhcnNlciBpcyB0aGUKICAgICAqIHNhbWUgaW5kZXggdXNlZCB0\nbyBhY2Nlc3MgdGhlIE9iamVjdFtdIGVsZW1lbnRzIHJldHVybmVkIGJ5IHRo\naXMgbWV0aG9kLgogICAgICogCiAgICAgKiB7QGxpbmsgSlBRTEV4cHJlc3Np\nb25CdWlsZGVyfSBjcmVhdGVzIGFuZCBwb3B1bGF0ZXMgcGFyYW1ldGVycyBh\ncwogICAgICogZm9sbG93czogCiAgICAgKiBUaGUgcGFyYW1ldGVyIGtleSBp\ncyBub3QgdGhlIHRva2VuIGVuY291bnRlcmVkIGJ5IHRoZSBwYXJzZXIsIGJ1\ndCAKICAgICAqIGNvbnZlcnRlZCB0byBJbnRlZ2VyIG9yIFN0cmluZyBiYXNl\nZCBvbiB0aGUgY29udGV4dCBpbiB3aGljaCB0aGUgdG9rZW4gCiAgICAgKiBh\ncHBlYXJlZC4gCiAgICAgKiBUaGUgaW5kZXggZm9yIHBvc2l0aW9uYWwgKElu\ndGVnZXIpIHBhcmFtZXRlciBpcyB0aGUgdmFsdWUgb2YgdGhlIGtleSAgIAog\nICAgICogbWludXMgMS4gCiAgICAgKiBUaGUgaW5kZXggZm9yIG5hbWVkIChT\ndHJpbmcpIHBhcmFtZXRlciBpcyB0aGUgb3JkZXIgaW4gd2hpY2ggdGhlICAK\nICAgICAqIHRva2VuIGFwcGVhcmVkIHRvIHBhcnNlciBkdXJpbmcgc2Nhbm5p\nbmcuIAogICAgICogCiAgICAgKiAKICAgICAqIFRoZSBmaXJzdCBMaW5rZWRN\nYXAgYXJndW1lbnQgdG8gdGhpcyBtZXRob2QgaXMgdGhlIHJlc3VsdCBvZiBw\nYXJzaW5nLgogICAgICogVGhpcyBMaW5rZWRNYXAgY29udGFpbnMgdGhlIHBh\ncmFtZXRlciBrZXkgYW5kIHRoZWlyIGV4cGVjdGVkIAogICAgICogKGlmIGRl\ndGVybWluYWJsZSkgdmFsdWUgdHlwZXMuIFRoYXQgaXQgaXMgYSBMaW5rZWRN\nYXAgcG9pbnRzIHRvIHRoZSAKICAgICAqIGZhY3QgdGhhdCBhbiBvcmRlcmlu\nZyBpcyBpbXBsaWNpdC4gVGhlIG9yZGVyaW5nIG9mIHRoZSBrZXlzIGluIHRo\naXMgTWFwIAogICAgICogaXMgdGhlIHNhbWUgYXMgdGhlIG9yZGVyIGluIHdo\naWNoIHBhcnNlciBlbmNvdW50ZXJlZCB0aGUgcGFyYW1ldGVyCiAgICAgKiB0\nb2tlbnMuCiAgICAgKiAKICAgICAqIEZvciBleGFtcGxlLCBwYXJzaW5nIHJl\nc3VsdCBvZiB0aGUgZm9sbG93aW5nIHR3byBKUFFMIHF1ZXJpZXMKICAgICAq\nICAgYSkgVVBEQVRFIENvbXBVc2VyIGUgU0VUIGUubmFtZT0gPzEsIGUuYWdl\nID0gPzIgV0hFUkUgZS51c2VyaWQgPSA/MwogICAgICogICBiKSBVUERBVEUg\nQ29tcFVzZXIgZSBTRVQgZS5uYW1lPSA6bmFtZSwgZS5hZ2UgPSA6YWdlIFdI\nRVJFIGUudXNlcmlkID0KICAgICAqICAgICAgICAgIDppZAogICAgICogVGhl\nIHBhcmFtZXRlciBrZXlzIHdpbGwgYXBwZWFyIGluIHRoZSBvcmRlciAoMywy\nLDEpIG9yICg6aWQsIDpuYW1lLCA6YWdlKQogICAgICogaW4gdGhlIGdpdmVu\nIExpbmtlZE1hcCBiZWNhdXNlIFdIRVJFIGNsYXVzZSBpcyBwYXJzZWQgYmVm\nb3JlIFNFVCBjbGF1c2UuCiAgICAgKiBUaGUgY29ycmVzcG9uZGluZyBQYXJh\nbWV0ZXIgRXhwcmVzc2lvbnMgY3JlYXRlZCBieSB0aGUgcGFyc2VyIHdpbGwg\naGF2ZQogICAgICogZm9sbG93aW5nIGtleSBhbmQgaW5kZXg6CiAgICAgKiAg\nICBhKSAxOjAsIDI6MSwgMzoyCiAgICAgKiAgICBiKSBuYW1lOjEsIGFnZToy\nLCBpZDowCiAgICAgKiAgICAKICAgICAqIFRoZSBwdXJwb3NlIG9mIHRoaXMg\nbWV0aG9kIGlzIHRvIHByb2R1Y2UgYW4gT2JqZWN0W10gd2l0aCBhbiBpbmRl\neGluZwogICAgICogc2NoZW1lIHRoYXQgbWF0Y2hlcyB0aGUgaW5kZXhpbmcg\nb2YgdGhlIFBhcmFtZXRlciBFeHByZXNzaW9uLgogICAgICogVGhlIHVzZXIg\nbWFwICh0aGUgc2Vjb25kIGFyZ3VtZW50KSBzaG91bGQgcHJvZHVjZSB0aGUg\nZm9sbG93aW5nIE9iamVjdFtdCiAgICAgKiBpbiB0d28gYWJvdmUtbWVudGlv\nbmVkIGNhc2VzCiAgICAgKiAgIGEpIHsxOiJTaGFubm9uIiwyOjI5LDM6NTAz\nMn0gLS0+IFsiU2hhbm5vbiIsIDI5LCA1MDMyXQogICAgICogICBiKSB7Im5h\nbWUiOiJTaGFubm9uIiwgImFnZSI6MjksICJpZCI6NTAzMn0gLS0+IFs1MDMy\nLCAiU2hhbm5vbiIsIDI5XQogICAgICogICAKICAgICAqLwoKICAgIC8qKgog\nICAgICogUmV0dXJuIHdoZXRoZXIgd2Ugc2hvdWxkIGV4ZWN1dGUgdGhpcyBx\ndWVyeSBpbiBtZW1vcnkuCiAgICAgKi8KICAgIHByaXZhdGUgYm9vbGVhbiBp\nc0luTWVtb3J5KGludCBvcGVyYXRpb24pIHsKICAgICAgICAvLyBpZiB0aGVy\nZSBhcmUgYW55IGRpcnR5IGluc3RhbmNlcyBpbiB0aGUgY3VycmVudCB0cmFu\ncyB0aGF0IGFyZQogICAgICAgIC8vIGludm9sdmVkIGluIHRoaXMgcXVlcnks\nIHdlIGhhdmUgdG8gZXhlY3V0ZSBpbiBtZW1vcnkgb3IgZmx1c2gKICAgICAg\nICBib29sZWFuIGluTWVtID0gIV9zdG9yZVF1ZXJ5LnN1cHBvcnRzRGF0YVN0\nb3JlRXhlY3V0aW9uKCkKICAgICAgICAgICAgfHwgX2NvbGxlY3Rpb24gIT0g\nbnVsbDsKICAgICAgICBpZiAoIWluTWVtICYmICghX2lnbm9yZUNoYW5nZXMg\nfHwgb3BlcmF0aW9uICE9IE9QX1NFTEVDVCkKICAgICAgICAgICAgJiYgX2Jy\nb2tlci5pc0FjdGl2ZSgpICYmIGlzQWNjZXNzUGF0aERpcnR5KCkpIHsKICAg\nICAgICAgICAgaW50IGZsdXNoID0gX2ZjLmdldEZsdXNoQmVmb3JlUXVlcmll\ncygpOwogICAgICAgICAgICBpZiAoKGZsdXNoID09IEZMVVNIX1RSVUUKICAg\nICAgICAgICAgICAgIHx8IChmbHVzaCA9PSBGTFVTSF9XSVRIX0NPTk5FQ1RJ\nT04gJiYgX2Jyb2tlci5oYXNDb25uZWN0aW9uKCkpCiAgICAgICAgICAgICAg\nICB8fCBvcGVyYXRpb24gIT0gT1BfU0VMRUNUCiAgICAgICAgICAgICAgICB8\nfCAhX3N0b3JlUXVlcnkuc3VwcG9ydHNJbk1lbW9yeUV4ZWN1dGlvbigpKQog\nICAgICAgICAgICAgICAgJiYgX2Jyb2tlci5nZXRDb25maWd1cmF0aW9uKCku\nc3VwcG9ydGVkT3B0aW9ucygpLgogICAgICAgICAgICAgICAgY29udGFpbnMo\nT3BlbkpQQUNvbmZpZ3VyYXRpb24uT1BUSU9OX0lOQ19GTFVTSCkpIHsKICAg\nICAgICAgICAgICAgIF9icm9rZXIuZmx1c2goKTsKICAgICAgICAgICAgfSBl\nbHNlIHsKICAgICAgICAgICAgICAgIGlmIChfbG9nLmlzSW5mb0VuYWJsZWQo\nKSkKICAgICAgICAgICAgICAgICAgICBfbG9nLmluZm8oX2xvYy5nZXQoImZv\ncmNlLWluLW1lbSIsIF9jbGFzcykpOwogICAgICAgICAgICAgICAgaW5NZW0g\nPSB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAo\naW5NZW0gJiYgIV9zdG9yZVF1ZXJ5LnN1cHBvcnRzSW5NZW1vcnlFeGVjdXRp\nb24oKSkKICAgICAgICAgICAgdGhyb3cgbmV3IEludmFsaWRTdGF0ZUV4Y2Vw\ndGlvbihfbG9jLmdldCgiY2FudC1leGVjLWlubWVtIiwKICAgICAgICAgICAg\nICAgIF9sYW5ndWFnZSkpOwogICAgICAgIHJldHVybiBpbk1lbTsKICAgIH0K\nCiAgICAvKioKICAgICAqIEV4ZWN1dGUgdGhlIHF1ZXJ5IHVzaW5nIHRoZSBn\naXZlbiBjb21waWxhdGlvbiwgZXhlY3V0b3IsIGFuZCBwYXJhbWV0ZXIKICAg\nICAqIHZhbHVlcy4gQWxsIG90aGVyIGV4ZWN1dGUgbWV0aG9kcyBkZWxlZ2F0\nZSB0byB0aGlzIG9uZSBvciB0bwogICAgICoge0BsaW5rICNleGVjdXRlKFN0\nb3JlUXVlcnkuRXhlY3V0b3IsTWFwKX0gYWZ0ZXIgdmFsaWRhdGlvbiBhbmQg\nbG9ja2luZy4KICAgICAqLwogICAgcHJpdmF0ZSBPYmplY3QgZXhlY3V0ZShT\ndG9yZVF1ZXJ5IHEsIFN0b3JlUXVlcnkuRXhlY3V0b3IgZXgsIAogICAgICAg\nIE9iamVjdFtdIHBhcmFtcykKICAgICAgICB0aHJvd3MgRXhjZXB0aW9uIHsK\nICAgICAgICAvLyBpZiB0aGlzIGlzIGFuIGltcG9zc2libGUgcmVzdWx0IHJh\nbmdlLCByZXR1cm4gbnVsbCAvIGVtcHR5IGxpc3QKICAgICAgICBTdG9yZVF1\nZXJ5LlJhbmdlIHJhbmdlID0gbmV3IFN0b3JlUXVlcnkuUmFuZ2UoX3N0YXJ0\nSWR4LCBfZW5kSWR4KTsKICAgICAgICBpZiAoIV9yYW5nZVNldCkKICAgICAg\nICAgICAgZXguZ2V0UmFuZ2UocSwgcGFyYW1zLCByYW5nZSk7CiAgICAgICAg\naWYgKHJhbmdlLnN0YXJ0ID49IHJhbmdlLmVuZCkKICAgICAgICAgICAgcmV0\ndXJuIGVtcHR5UmVzdWx0KHEsIGV4KTsKCiAgICAgICAgLy8gZXhlY3V0ZTsg\naWYgd2UgaGF2ZSBhIHJlc3VsdCBjbGFzcyBvciB3ZSBoYXZlIG9ubHkgb25l\nIHJlc3VsdAogICAgICAgIC8vIGFuZCBzbyBuZWVkIHRvIHJlbW92ZSBpdCBm\ncm9tIGl0cyBhcnJheSwgd3JhcCBpbiBhIHBhY2tpbmcgcm9wCiAgICAgICAg\ncmFuZ2UubHJzID0gaXNMUlMocmFuZ2Uuc3RhcnQsIHJhbmdlLmVuZCk7CiAg\nICAgICAgUmVzdWx0T2JqZWN0UHJvdmlkZXIgcm9wID0gZXguZXhlY3V0ZVF1\nZXJ5KHEsIHBhcmFtcywgcmFuZ2UpOwogICAgICAgIHRyeSB7CiAgICAgICAg\nICAgIHJldHVybiB0b1Jlc3VsdChxLCBleCwgcm9wLCByYW5nZSk7CiAgICAg\nICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgaWYgKHJv\ncCAhPSBudWxsKQogICAgICAgICAgICAgICAgdHJ5IHsgcm9wLmNsb3NlKCk7\nIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlMikge30KICAgICAgICAgICAgdGhyb3cg\nZTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBEZWxldGUgdGhl\nIHF1ZXJ5IHVzaW5nIHRoZSBnaXZlbiBleGVjdXRvciwgYW5kIHBhcmFtZXRl\ncgogICAgICogdmFsdWVzLiBBbGwgb3RoZXIgZXhlY3V0ZSBtZXRob2RzIGRl\nbGVnYXRlIHRvIHRoaXMgb25lIG9yIHRvCiAgICAgKiB7QGxpbmsgI2RlbGV0\nZShTdG9yZVF1ZXJ5LkV4ZWN1dG9yLE1hcCl9IGFmdGVyIHZhbGlkYXRpb24g\nYW5kIGxvY2tpbmcuCiAgICAgKiBUaGUgcmV0dXJuIHZhbHVlIHdpbGwgYmUg\nYSBOdW1iZXIgaW5kaWNhdGluZyB0aGUgbnVtYmVyIG9mCiAgICAgKiBpbnN0\nYW5jZXMgZGVsZXRlZC4KICAgICAqLwogICAgcHJpdmF0ZSBOdW1iZXIgZGVs\nZXRlKFN0b3JlUXVlcnkgcSwgU3RvcmVRdWVyeS5FeGVjdXRvciBleCwgT2Jq\nZWN0W10gcGFyYW1zKQogICAgICAgIHRocm93cyBFeGNlcHRpb24gewogICAg\nICAgIGFzc2VydEJ1bGtNb2RpZnkocSwgZXgsIHBhcmFtcyk7CiAgICAgICAg\ncmV0dXJuIGV4LmV4ZWN1dGVEZWxldGUocSwgcGFyYW1zKTsKICAgIH0KCiAg\nICBwdWJsaWMgTnVtYmVyIGRlbGV0ZUluTWVtb3J5KFN0b3JlUXVlcnkgcSwg\nU3RvcmVRdWVyeS5FeGVjdXRvciBleGVjdXRvciwKICAgICAgICBPYmplY3Rb\nXSBwYXJhbXMpIHsKICAgICAgICB0cnkgewogICAgICAgICAgICBPYmplY3Qg\nbyA9IGV4ZWN1dGUocSwgZXhlY3V0b3IsIHBhcmFtcyk7CiAgICAgICAgICAg\nIGlmICghKG8gaW5zdGFuY2VvZiBDb2xsZWN0aW9uKSkKICAgICAgICAgICAg\nICAgIG8gPSBDb2xsZWN0aW9ucy5zaW5nbGV0b24obyk7CgogICAgICAgICAg\nICBpbnQgc2l6ZSA9IDA7CiAgICAgICAgICAgIGZvciAoSXRlcmF0b3IgaSA9\nICgoQ29sbGVjdGlvbikgbykuaXRlcmF0b3IoKTsgaS5oYXNOZXh0KCk7IHNp\nemUrKykKICAgICAgICAgICAgICAgIF9icm9rZXIuZGVsZXRlKGkubmV4dCgp\nLCBudWxsKTsKICAgICAgICAgICAgcmV0dXJuIE51bWJlcnMudmFsdWVPZihz\naXplKTsKICAgICAgICB9IGNhdGNoIChPcGVuSlBBRXhjZXB0aW9uIGtlKSB7\nCiAgICAgICAgICAgIHRocm93IGtlOwogICAgICAgIH0gY2F0Y2ggKEV4Y2Vw\ndGlvbiBlKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBVc2VyRXhjZXB0aW9u\nKGUpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIFVwZGF0ZSB0\naGUgcXVlcnkgdXNpbmcgdGhlIGdpdmVuIGNvbXBpbGF0aW9uLCBleGVjdXRv\nciwgYW5kIHBhcmFtZXRlcgogICAgICogdmFsdWVzLiBBbGwgb3RoZXIgZXhl\nY3V0ZSBtZXRob2RzIGRlbGVnYXRlIHRvIHRoaXMgb25lIG9yIHRvCiAgICAg\nKiB7QGxpbmsgI3VwZGF0ZShTdG9yZVF1ZXJ5LkV4ZWN1dG9yLE1hcCl9IGFm\ndGVyIHZhbGlkYXRpb24gYW5kIGxvY2tpbmcuCiAgICAgKiBUaGUgcmV0dXJu\nIHZhbHVlIHdpbGwgYmUgYSBOdW1iZXIgaW5kaWNhdGluZyB0aGUgbnVtYmVy\nIG9mCiAgICAgKiBpbnN0YW5jZXMgdXBkYXRlZC4KICAgICAqLwogICAgcHJp\ndmF0ZSBOdW1iZXIgdXBkYXRlKFN0b3JlUXVlcnkgcSwgU3RvcmVRdWVyeS5F\neGVjdXRvciBleCwgT2JqZWN0W10gcGFyYW1zKQogICAgICAgIHRocm93cyBF\neGNlcHRpb24gewogICAgICAgIGFzc2VydEJ1bGtNb2RpZnkocSwgZXgsIHBh\ncmFtcyk7CiAgICAgICAgcmV0dXJuIGV4LmV4ZWN1dGVVcGRhdGUocSwgcGFy\nYW1zKTsKICAgIH0KCiAgICBwdWJsaWMgTnVtYmVyIHVwZGF0ZUluTWVtb3J5\nKFN0b3JlUXVlcnkgcSwgU3RvcmVRdWVyeS5FeGVjdXRvciBleGVjdXRvciwK\nICAgICAgICBPYmplY3RbXSBwYXJhbXMpIHsKICAgICAgICB0cnkgewogICAg\nICAgICAgICBPYmplY3QgbyA9IGV4ZWN1dGUocSwgZXhlY3V0b3IsIHBhcmFt\ncyk7CiAgICAgICAgICAgIGlmICghKG8gaW5zdGFuY2VvZiBDb2xsZWN0aW9u\nKSkKICAgICAgICAgICAgICAgIG8gPSBDb2xsZWN0aW9ucy5zaW5nbGV0b24o\nbyk7CgogICAgICAgICAgICBpbnQgc2l6ZSA9IDA7CiAgICAgICAgICAgIGZv\nciAoSXRlcmF0b3IgaSA9ICgoQ29sbGVjdGlvbikgbykuaXRlcmF0b3IoKTsg\naS5oYXNOZXh0KCk7IHNpemUrKykKICAgICAgICAgICAgICAgIHVwZGF0ZUlu\nTWVtb3J5KGkubmV4dCgpLCBwYXJhbXMsIHEpOwogICAgICAgICAgICByZXR1\ncm4gTnVtYmVycy52YWx1ZU9mKHNpemUpOwogICAgICAgIH0gY2F0Y2ggKE9w\nZW5KUEFFeGNlcHRpb24ga2UpIHsKICAgICAgICAgICAgdGhyb3cga2U7CiAg\nICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgdGhy\nb3cgbmV3IFVzZXJFeGNlcHRpb24oZSk7CiAgICAgICAgfQogICAgfQoKICAg\nIC8qKgogICAgICogU2V0IHRoZSB2YWx1ZXMgZm9yIHRoZSB1cGRhdGVzIGlu\nIG1lbW9yeS4KICAgICAqCiAgICAgKiBAcGFyYW0gb2IgdGhlIHBlcnNpc3Rl\nbnQgaW5zdGFuY2UgdG8gY2hhbmdlCiAgICAgKiBAcGFyYW0gcGFyYW1zIHRo\nZSBwYXJhbWV0ZXJzIHBhc3NlZCB0byB0aGUgcXVlcnkKICAgICAqLwogICAg\ncHJpdmF0ZSB2b2lkIHVwZGF0ZUluTWVtb3J5KE9iamVjdCBvYiwgT2JqZWN0\nW10gcGFyYW1zLCBTdG9yZVF1ZXJ5IHEpIHsKICAgICAgICBmb3IgKEl0ZXJh\ndG9yIGl0ID0gZ2V0VXBkYXRlcygpLmVudHJ5U2V0KCkuaXRlcmF0b3IoKTsK\nICAgICAgICAgICAgaXQuaGFzTmV4dCgpOykgewogICAgICAgICAgICBNYXAu\nRW50cnkgZSA9IChNYXAuRW50cnkpIGl0Lm5leHQoKTsKICAgICAgICAgICAg\nUGF0aCBwYXRoID0gKFBhdGgpIGUuZ2V0S2V5KCk7CiAgICAgICAgICAgIEZp\nZWxkTWV0YURhdGEgZm1kID0gKEZpZWxkTWV0YURhdGEpIHBhdGgubGFzdCgp\nOwogICAgICAgICAgICBPcGVuSlBBU3RhdGVNYW5hZ2VyIHNtID0gX2Jyb2tl\nci5nZXRTdGF0ZU1hbmFnZXIob2IpOwoKICAgICAgICAgICAgT2JqZWN0IHZh\nbDsKICAgICAgICAgICAgT2JqZWN0IHZhbHVlID0gZS5nZXRWYWx1ZSgpOwog\nICAgICAgICAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiBWYWwpIHsKICAgICAg\nICAgICAgICAgIHZhbCA9ICgoVmFsKSB2YWx1ZSkuCiAgICAgICAgICAgICAg\nICAgICAgZXZhbHVhdGUob2IsIG51bGwsIGdldFN0b3JlQ29udGV4dCgpLCBw\nYXJhbXMpOwogICAgICAgICAgICB9IGVsc2UgaWYgKHZhbHVlIGluc3RhbmNl\nb2YgTGl0ZXJhbCkgewogICAgICAgICAgICAgICAgdmFsID0gKChMaXRlcmFs\nKSB2YWx1ZSkuZ2V0VmFsdWUoKTsKICAgICAgICAgICAgfSBlbHNlIGlmICh2\nYWx1ZSBpbnN0YW5jZW9mIENvbnN0YW50KSB7CiAgICAgICAgICAgICAgICB2\nYWwgPSAoKENvbnN0YW50KSB2YWx1ZSkuZ2V0VmFsdWUocGFyYW1zKTsKICAg\nICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHRyeSB7CiAgICAg\nICAgICAgICAgICAgICAgdmFsID0gcS5ldmFsdWF0ZSh2YWx1ZSwgb2IsIHBh\ncmFtcywgc20pOwogICAgICAgICAgICAgICAgfSBjYXRjaCAoVW5zdXBwb3J0\nZWRFeGNlcHRpb24gZTEpIHsKICAgICAgICAgICAgICAgICAgICB0aHJvdyBu\nZXcgVXNlckV4Y2VwdGlvbigKICAgICAgICAgICAgICAgICAgICAgICAgICAg\nIF9sb2MuZ2V0KCJmYWlsLXRvLWdldC11cGRhdGUtdmFsdWUiKSk7CiAgICAg\nICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGludCBp\nID0gZm1kLmdldEluZGV4KCk7CiAgICAgICAgICAgIFBlcnNpc3RlbmNlQ2Fw\nYWJsZSBpbnRvID0gSW1wbEhlbHBlci50b1BlcnNpc3RlbmNlQ2FwYWJsZShv\nYiwKICAgICAgICAgICAgICAgIF9icm9rZXIuZ2V0Q29uZmlndXJhdGlvbigp\nKTsKCiAgICAgICAgICAgIC8vIHNldCB0aGUgYWN0dWFsIGZpZWxkIGluIHRo\nZSBpbnN0YW5jZQogICAgICAgICAgICBpbnQgc2V0ID0gT3BlbkpQQVN0YXRl\nTWFuYWdlci5TRVRfVVNFUjsKICAgICAgICAgICAgc3dpdGNoIChmbWQuZ2V0\nRGVjbGFyZWRUeXBlQ29kZSgpKSB7CiAgICAgICAgICAgICAgICBjYXNlIEph\ndmFUeXBlcy5CT09MRUFOOgogICAgICAgICAgICAgICAgICAgIHNtLnNldHRp\nbmdCb29sZWFuRmllbGQoaW50bywgaSwgc20uZmV0Y2hCb29sZWFuRmllbGQo\naSksCiAgICAgICAgICAgICAgICAgICAgICAgIHZhbCA9PSBudWxsID8gZmFs\nc2UgOiAoKEJvb2xlYW4pIHZhbCkuYm9vbGVhblZhbHVlKCksCiAgICAgICAg\nICAgICAgICAgICAgICAgIHNldCk7CiAgICAgICAgICAgICAgICAgICAgYnJl\nYWs7CiAgICAgICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5CWVRFOgogICAg\nICAgICAgICAgICAgICAgIHNtLnNldHRpbmdCeXRlRmllbGQoaW50bywgaSwg\nc20uZmV0Y2hCeXRlRmllbGQoaSksCiAgICAgICAgICAgICAgICAgICAgICAg\nIHZhbCA9PSBudWxsID8gMCA6ICgoTnVtYmVyKSB2YWwpLmJ5dGVWYWx1ZSgp\nLCBzZXQpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAg\nICAgICAgY2FzZSBKYXZhVHlwZXMuQ0hBUjoKICAgICAgICAgICAgICAgICAg\nICBzbS5zZXR0aW5nQ2hhckZpZWxkKGludG8sIGksIHNtLmZldGNoQ2hhckZp\nZWxkKGkpLAogICAgICAgICAgICAgICAgICAgICAgICB2YWwgPT0gbnVsbCA/\nIDAgOiB2YWwudG9TdHJpbmcoKS5jaGFyQXQoMCksIHNldCk7CiAgICAgICAg\nICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIEphdmFU\neXBlcy5ET1VCTEU6CiAgICAgICAgICAgICAgICAgICAgc20uc2V0dGluZ0Rv\ndWJsZUZpZWxkKGludG8sIGksIHNtLmZldGNoRG91YmxlRmllbGQoaSksCiAg\nICAgICAgICAgICAgICAgICAgICAgIHZhbCA9PSBudWxsID8gMCA6ICgoTnVt\nYmVyKSB2YWwpLmRvdWJsZVZhbHVlKCksIHNldCk7CiAgICAgICAgICAgICAg\nICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5G\nTE9BVDoKICAgICAgICAgICAgICAgICAgICBzbS5zZXR0aW5nRmxvYXRGaWVs\nZChpbnRvLCBpLCBzbS5mZXRjaEZsb2F0RmllbGQoaSksCiAgICAgICAgICAg\nICAgICAgICAgICAgIHZhbCA9PSBudWxsID8gMCA6ICgoTnVtYmVyKSB2YWwp\nLmZsb2F0VmFsdWUoKSwgc2V0KTsKICAgICAgICAgICAgICAgICAgICBicmVh\nazsKICAgICAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLklOVDoKICAgICAg\nICAgICAgICAgICAgICBzbS5zZXR0aW5nSW50RmllbGQoaW50bywgaSwgc20u\nZmV0Y2hJbnRGaWVsZChpKSwKICAgICAgICAgICAgICAgICAgICAgICAgdmFs\nID09IG51bGwgPyAwIDogKChOdW1iZXIpIHZhbCkuaW50VmFsdWUoKSwgc2V0\nKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAg\nIGNhc2UgSmF2YVR5cGVzLkxPTkc6CiAgICAgICAgICAgICAgICAgICAgc20u\nc2V0dGluZ0xvbmdGaWVsZChpbnRvLCBpLCBzbS5mZXRjaExvbmdGaWVsZChp\nKSwKICAgICAgICAgICAgICAgICAgICAgICAgdmFsID09IG51bGwgPyAwIDog\nKChOdW1iZXIpIHZhbCkubG9uZ1ZhbHVlKCksIHNldCk7CiAgICAgICAgICAg\nICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIEphdmFUeXBl\ncy5TSE9SVDoKICAgICAgICAgICAgICAgICAgICBzbS5zZXR0aW5nU2hvcnRG\naWVsZChpbnRvLCBpLCBzbS5mZXRjaFNob3J0RmllbGQoaSksCiAgICAgICAg\nICAgICAgICAgICAgICAgIHZhbCA9PSBudWxsID8gMCA6ICgoTnVtYmVyKSB2\nYWwpLnNob3J0VmFsdWUoKSwgc2V0KTsKICAgICAgICAgICAgICAgICAgICBi\ncmVhazsKICAgICAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLlNUUklORzoK\nICAgICAgICAgICAgICAgICAgICBzbS5zZXR0aW5nU3RyaW5nRmllbGQoaW50\nbywgaSwgc20uZmV0Y2hTdHJpbmdGaWVsZChpKSwKICAgICAgICAgICAgICAg\nICAgICAgICAgdmFsID09IG51bGwgPyBudWxsIDogdmFsLnRvU3RyaW5nKCks\nIHNldCk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAg\nICAgICBjYXNlIEphdmFUeXBlcy5EQVRFOgogICAgICAgICAgICAgICAgY2Fz\nZSBKYXZhVHlwZXMuTlVNQkVSOgogICAgICAgICAgICAgICAgY2FzZSBKYXZh\nVHlwZXMuQk9PTEVBTl9PQko6CiAgICAgICAgICAgICAgICBjYXNlIEphdmFU\neXBlcy5CWVRFX09CSjoKICAgICAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVz\nLkNIQVJfT0JKOgogICAgICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuRE9V\nQkxFX09CSjoKICAgICAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLkZMT0FU\nX09CSjoKICAgICAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLklOVF9PQko6\nCiAgICAgICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5MT05HX09CSjoKICAg\nICAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLlNIT1JUX09CSjoKICAgICAg\nICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLkJJR0RFQ0lNQUw6CiAgICAgICAg\nICAgICAgICBjYXNlIEphdmFUeXBlcy5CSUdJTlRFR0VSOgogICAgICAgICAg\nICAgICAgY2FzZSBKYXZhVHlwZXMuTE9DQUxFOgogICAgICAgICAgICAgICAg\nY2FzZSBKYXZhVHlwZXMuT0JKRUNUOgogICAgICAgICAgICAgICAgY2FzZSBK\nYXZhVHlwZXMuT0lEOgogICAgICAgICAgICAgICAgICAgIHNtLnNldHRpbmdP\nYmplY3RGaWVsZChpbnRvLCBpLCBzbS5mZXRjaE9iamVjdEZpZWxkKGkpLCB2\nYWwsCiAgICAgICAgICAgICAgICAgICAgICAgIHNldCk7CiAgICAgICAgICAg\nICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBkZWZhdWx0OgogICAg\nICAgICAgICAgICAgICAgIHRocm93IG5ldyBVc2VyRXhjZXB0aW9uKF9sb2Mu\nZ2V0KCJvbmx5LXVwZGF0ZS1wcmltaXRpdmVzIikpOwogICAgICAgICAgICB9\nCiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogVHJhY2UgbG9nIHRo\nYXQgdGhlIHF1ZXJ5IGlzIGV4ZWN1dGluZy4KICAgICAqLwogICAgcHJpdmF0\nZSB2b2lkIGxvZ0V4ZWN1dGlvbihpbnQgb3AsIE9yZGVyZWRNYXA8T2JqZWN0\nLCBDbGFzczw/Pj4gdHlwZXMsIE9iamVjdFtdIHBhcmFtcykgewogICAgICAg\nIE9yZGVyZWRNYXA8T2JqZWN0LCBPYmplY3Q+IHBtYXAgPSBuZXcgT3JkZXJl\nZE1hcDxPYmplY3QsIE9iamVjdD4oKTsKICAgICAgICBpZiAocGFyYW1zLmxl\nbmd0aCA+IDApIHsKICAgICAgICAgICAgaWYgKHR5cGVzICE9IG51bGwgJiYg\ndHlwZXMuc2l6ZSgpID09IHBhcmFtcy5sZW5ndGgpIHsKICAgICAgICAgICAg\nICAgIGludCBpID0gMDsKICAgICAgICAgICAgICAgIGZvciAoSXRlcmF0b3I8\nT2JqZWN0PiBpdHIgPSB0eXBlcy5rZXlTZXQoKS5pdGVyYXRvcigpOyBpdHIu\naGFzTmV4dCgpOykKICAgICAgICAgICAgICAgICAgICBwbWFwLnB1dChpdHIu\nbmV4dCgpLCBwYXJhbXNbaSsrXSk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAg\nICAgICAgICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IHBhcmFtcy5sZW5n\ndGg7IGkrKykKICAgICAgICAgICAgICAgICAgICBwbWFwLnB1dChTdHJpbmcu\ndmFsdWVPZihpKSwgcGFyYW1zW2ldKTsKICAgICAgICAgICAgfQogICAgICAg\nIH0KICAgICAgICBsb2dFeGVjdXRpb24ob3AsIHBtYXApOwogICAgfQoKICAg\nIC8qKgogICAgICogVHJhY2UgbG9nIHRoYXQgdGhlIHF1ZXJ5IGlzIGV4ZWN1\ndGluZy4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIGxvZ0V4ZWN1dGlvbihp\nbnQgb3AsIE1hcDw/LCA/PiBwYXJhbXMpIHsKICAgICAgICBTdHJpbmcgcyA9\nIF9xdWVyeTsKICAgICAgICBpZiAoU3RyaW5nVXRpbHMuaXNFbXB0eShzKSkK\nICAgICAgICAgICAgcyA9IHRvU3RyaW5nKCk7CgogICAgICAgIFN0cmluZyBt\nc2cgPSAiZXhlY3V0aW5nLXF1ZXJ5IjsKICAgICAgICBpZiAoIXBhcmFtcy5p\nc0VtcHR5KCkpCiAgICAgICAgICAgIG1zZyArPSAiLXdpdGgtcGFyYW1zIjsK\nCiAgICAgICAgX2xvZy50cmFjZShfbG9jLmdldChtc2csIHMsIHBhcmFtcykp\nOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHdoZXRoZXIgdGhpcyBz\naG91bGQgYmUgdHJlYXRlZCBhcyBhIHBvdGVudGlhbCBsYXJnZSByZXN1bHQg\nc2V0LgogICAgICovCiAgICBwcml2YXRlIGJvb2xlYW4gaXNMUlMobG9uZyBz\ndGFydCwgbG9uZyBlbmQpIHsKICAgICAgICBsb25nIHJhbmdlID0gZW5kIC0g\nc3RhcnQ7CiAgICAgICAgcmV0dXJuIF9mYy5nZXRGZXRjaEJhdGNoU2l6ZSgp\nID49IDAKICAgICAgICAgICAgJiYgIShyYW5nZSA8PSBfZmMuZ2V0RmV0Y2hC\nYXRjaFNpemUoKQogICAgICAgICAgICB8fCAoX2ZjLmdldEZldGNoQmF0Y2hT\naXplKCkgPT0gMCAmJiByYW5nZSA8PSA1MCkpOwogICAgfQoKICAgIC8qKgog\nICAgICogUmV0dXJuIHRoZSBxdWVyeSByZXN1bHQgZm9yIHRoZSBnaXZlbiBy\nZXN1bHQgb2JqZWN0IHByb3ZpZGVyLgogICAgICovCiAgICBwcm90ZWN0ZWQg\nT2JqZWN0IHRvUmVzdWx0KFN0b3JlUXVlcnkgcSwgU3RvcmVRdWVyeS5FeGVj\ndXRvciBleCwgCiAgICAgICAgUmVzdWx0T2JqZWN0UHJvdmlkZXIgcm9wLCBT\ndG9yZVF1ZXJ5LlJhbmdlIHJhbmdlKQogICAgICAgIHRocm93cyBFeGNlcHRp\nb24gewogICAgICAgIC8vIHBhY2sgcHJvamVjdGlvbnMgaWYgbmVjZXNzYXJ5\nCiAgICAgICAgU3RyaW5nW10gYWxpYXNlcyA9IGV4LmdldFByb2plY3Rpb25B\nbGlhc2VzKHEpOwogICAgICAgIGlmICghZXguaXNQYWNraW5nKHEpKSB7CiAg\nICAgICAgICAgIFJlc3VsdFBhY2tlciBwYWNrZXIgPSBnZXRSZXN1bHRQYWNr\nZXIocSwgZXgpOwogICAgICAgICAgICBpZiAocGFja2VyICE9IG51bGwgfHwg\nYWxpYXNlcy5sZW5ndGggPT0gMSkKICAgICAgICAgICAgICAgIHJvcCA9IG5l\ndyBQYWNraW5nUmVzdWx0T2JqZWN0UHJvdmlkZXIocm9wLCBwYWNrZXIsCiAg\nICAgICAgICAgICAgICAgICAgYWxpYXNlcy5sZW5ndGgpOwogICAgICAgIH0K\nCiAgICAgICAgLy8gaWYgc2luZ2xlIHJlc3VsdCwgZXh0cmFjdCBpdAogICAg\nICAgIGlmIChfdW5pcXVlID09IEJvb2xlYW4uVFJVRSB8fCAoYWxpYXNlcy5s\nZW5ndGggPiAwCiAgICAgICAgICAgICYmICFleC5oYXNHcm91cGluZyhxKSAm\nJiBleC5pc0FnZ3JlZ2F0ZShxKSkpCiAgICAgICAgICAgIHJldHVybiBzaW5n\nbGVSZXN1bHQocm9wLCByYW5nZSk7CgogICAgICAgIC8vIG5vdyB0aGF0IHdl\nJ3ZlIGV4ZWN1dGVkIHRoZSBxdWVyeSwgd2UgY2FuIGNhbGwgaXNBZ2dyZWdh\ndGUgYW5kCiAgICAgICAgLy8gaGFzR3JvdXBpbmcgZWZmaWNpZW50bHkKICAg\nICAgICBib29sZWFuIGRldGFjaCA9IChfYnJva2VyLmdldEF1dG9EZXRhY2go\nKSAmCiAgICAgICAgICAgIEF1dG9EZXRhY2guREVUQUNIX05PTlRYUkVBRCkg\nPiAwICYmICFfYnJva2VyLmlzQWN0aXZlKCk7CiAgICAgICAgYm9vbGVhbiBs\ncnMgPSByYW5nZS5scnMgJiYgIWV4LmlzQWdncmVnYXRlKHEpICYmICFleC5o\nYXNHcm91cGluZyhxKTsKICAgICAgICBSZXN1bHRMaXN0PD8+IHJlcyA9ICgh\nZGV0YWNoICYmIGxycykgPyBfZmMubmV3UmVzdWx0TGlzdChyb3ApCiAgICAg\nICAgICAgIDogbmV3IEVhZ2VyUmVzdWx0TGlzdChyb3ApOwogICAgICAgIHJl\ncy5zZXRVc2VyT2JqZWN0KG5ldyBPYmplY3RbXXtyb3AsZXh9KTsKICAgICAg\nICBfcmVzdWx0TGlzdHMuYWRkKGRlY29yYXRlUmVzdWx0TGlzdChyZXMpKTsK\nICAgICAgICByZXR1cm4gcmVzOwogICAgfQoKICAgIC8qKgogICAgICogT3B0\naW9uYWxseSBkZWNvcmF0ZSB0aGUgbmF0aXZlIHJlc3VsdC4KICAgICAqLwog\nICAgcHJvdGVjdGVkIFJlbW92ZU9uQ2xvc2VSZXN1bHRMaXN0IGRlY29yYXRl\nUmVzdWx0TGlzdChSZXN1bHRMaXN0PD8+IHJlcykgewogICAgICAgIHJldHVy\nbiBuZXcgUmVtb3ZlT25DbG9zZVJlc3VsdExpc3QocmVzKTsKICAgIH0KCiAg\nICAvKioKICAgICAqIFJldHVybiBhIHJlc3VsdCBwYWNrZXIgZm9yIHRoaXMg\ncHJvamVjdGlvbiwgb3IgbnVsbC4KICAgICAqLwogICAgcHJpdmF0ZSBSZXN1\nbHRQYWNrZXIgZ2V0UmVzdWx0UGFja2VyKFN0b3JlUXVlcnkgcSwgU3RvcmVR\ndWVyeS5FeGVjdXRvciBleCkgewogICAgICAgIGlmIChfcGFja2VyICE9IG51\nbGwpCiAgICAgICAgICAgIHJldHVybiBfcGFja2VyOwoKICAgICAgICBDbGFz\nczw/PiByZXN1bHRDbGFzcyA9IChfcmVzdWx0Q2xhc3MgIT0gbnVsbCkgPyBf\ncmVzdWx0Q2xhc3MKICAgICAgICAgICAgOiBleC5nZXRSZXN1bHRDbGFzcyhx\nKTsKICAgICAgICBpZiAocmVzdWx0Q2xhc3MgPT0gbnVsbCkKICAgICAgICAg\nICAgcmV0dXJuIG51bGw7CgogICAgICAgIFN0cmluZ1tdIGFsaWFzZXMgPSBl\neC5nZXRQcm9qZWN0aW9uQWxpYXNlcyhxKTsKICAgICAgICBSZXN1bHRTaGFw\nZTw/PiBzaGFwZSA9IGV4LmdldFJlc3VsdFNoYXBlKHEpOwogICAgICAgIGlm\nIChzaGFwZSAhPSBudWxsKSB7IC8vIHVzaW5nIEpQQTIuMCBzdHlsZSByZXN1\nbHQgc2hhcGUgZm9yIHBhY2tpbmcKICAgICAgICAgICAgaWYgKGFsaWFzZXMu\nbGVuZ3RoID09IDApIHsKICAgICAgICAgICAgICAgIF9wYWNrZXIgPSBuZXcg\nUmVzdWx0U2hhcGVQYWNrZXIobmV3IENsYXNzW117X2NsYXNzfSwgbmV3IFN0\ncmluZ1tdeyIifSwgcmVzdWx0Q2xhc3MsIHNoYXBlKTsKICAgICAgICAgICAg\nfSBlbHNlIHsKICAgICAgICAgICAgICAgIF9wYWNrZXIgPSBuZXcgUmVzdWx0\nU2hhcGVQYWNrZXIoZXguZ2V0UHJvamVjdGlvblR5cGVzKHEpLCBhbGlhc2Vz\nLCByZXN1bHRDbGFzcywgc2hhcGUpOwogICAgICAgICAgICB9CiAgICAgICAg\nfSBlbHNlIHsKICAgICAgICAgICAgaWYgKGFsaWFzZXMubGVuZ3RoID09IDAp\nIHsKICAgICAgICAgICAgICAgIC8vIHJlc3VsdCBjbGFzcyBidXQgbm8gcmVz\ndWx0OyBtZWFucyBjYW5kaWRhdGUgaXMgYmVpbmcgc2V0CiAgICAgICAgICAg\nICAgICAvLyBpbnRvIHNvbWUgcmVzdWx0IGNsYXNzCiAgICAgICAgICAgICAg\nICBfcGFja2VyID0gbmV3IFJlc3VsdFBhY2tlcihfY2xhc3MsIGdldEFsaWFz\nKCksIHJlc3VsdENsYXNzKTsKICAgICAgICAgICAgfSBlbHNlIGlmIChyZXN1\nbHRDbGFzcyAhPSBudWxsKSB7IC8vIHByb2plY3Rpb24KICAgICAgICAgICAg\nICAgIENsYXNzPD8+W10gdHlwZXMgPSBleC5nZXRQcm9qZWN0aW9uVHlwZXMo\ncSk7CiAgICAgICAgICAgICAgICBfcGFja2VyID0gbmV3IFJlc3VsdFBhY2tl\ncih0eXBlcywgYWxpYXNlcywgcmVzdWx0Q2xhc3MpOwogICAgICAgICAgICB9\nCiAgICAgICAgfQogICAgICAgIHJldHVybiBfcGFja2VyOwogICAgfQoKICAg\nIC8qKgogICAgICogQ3JlYXRlIGFuIGVtcHR5IHJlc3VsdCBmb3IgdGhpcyBx\ndWVyeS4KICAgICAqLwogICAgcHJpdmF0ZSBPYmplY3QgZW1wdHlSZXN1bHQo\nU3RvcmVRdWVyeSBxLCBTdG9yZVF1ZXJ5LkV4ZWN1dG9yIGV4KSB7CiAgICAg\nICAgaWYgKF91bmlxdWUgPT0gQm9vbGVhbi5UUlVFIHx8IChfdW5pcXVlID09\nIG51bGwKICAgICAgICAgICAgJiYgIWV4Lmhhc0dyb3VwaW5nKHEpICYmIGV4\nLmlzQWdncmVnYXRlKHEpKSkKICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAg\nICAgICAgcmV0dXJuIENvbGxlY3Rpb25zLkVNUFRZX0xJU1Q7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBFeHRyYWN0IGFuIGV4cGVjdGVkIHNpbmdsZSByZXN1\nbHQgZnJvbSB0aGUgZ2l2ZW4gcHJvdmlkZXIuIFVzZWQgd2hlbgogICAgICog\ndGhlIHJlc3VsdCBpcyBhbiB1bmdyb3VwZWQgYWdncmVnYXRlIG9yIHRoZSB1\nbmlxdWUgZmxhZyBpcyBzZXQgdG8gdHJ1ZS4KICAgICAqLwogICAgcHJpdmF0\nZSBPYmplY3Qgc2luZ2xlUmVzdWx0KFJlc3VsdE9iamVjdFByb3ZpZGVyIHJv\ncCwgCiAgICAgICAgU3RvcmVRdWVyeS5SYW5nZSByYW5nZSkKICAgICAgICB0\naHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICByb3Aub3BlbigpOwogICAgICAg\nIHRyeSB7CiAgICAgICAgICAgIC8vIG1vdmUgdG8gZXhwZWN0ZWQgcmVzdWx0\nCiAgICAgICAgICAgIGJvb2xlYW4gbmV4dCA9IHJvcC5uZXh0KCk7CgogICAg\nICAgICAgICAvLyBleHRyYWN0IHNpbmdsZSByZXN1bHQ7IHRocm93IGFuIGV4\nY2VwdGlvbiBpZiBtdWx0aXBsZSByZXN1bHRzCiAgICAgICAgICAgIC8vIG1h\ndGNoIGFuZCBub3QgY29uc3RyYWludGVkIGJ5IHJhbmdlLCBvciBpZiBhIHVu\naXF1ZSBxdWVyeSB3aXRoCiAgICAgICAgICAgIC8vIG5vIHJlc3VsdHMKICAg\nICAgICAgICAgT2JqZWN0IHNpbmdsZSA9IG51bGw7CiAgICAgICAgICAgIGlm\nIChuZXh0KSB7CiAgICAgICAgICAgICAgICBzaW5nbGUgPSByb3AuZ2V0UmVz\ndWx0T2JqZWN0KCk7CiAgICAgICAgICAgICAgICBpZiAocmFuZ2UuZW5kICE9\nIHJhbmdlLnN0YXJ0ICsgMSAmJiByb3AubmV4dCgpKQogICAgICAgICAgICAg\nICAgICAgIHRocm93IG5ldyBOb25VbmlxdWVSZXN1bHRFeGNlcHRpb24oX2xv\nYy5nZXQoIm5vdC11bmlxdWUiLAogICAgICAgICAgICAgICAgICAgICAgICBf\nY2xhc3MsIF9xdWVyeSkpOwogICAgICAgICAgICB9IGVsc2UgaWYgKF91bmlx\ndWUgPT0gQm9vbGVhbi5UUlVFKQogICAgICAgICAgICAgICAgdGhyb3cgbmV3\nIE5vUmVzdWx0RXhjZXB0aW9uKF9sb2MuZ2V0KCJuby1yZXN1bHQiLCAKICAg\nICAgICAgICAgICAgICAgICBfY2xhc3MsIF9xdWVyeSkpOwoKICAgICAgICAg\nICAgLy8gaWYgdW5pcXVlIHNldCB0byBmYWxzZSwgdXNlIGNvbGxlY3Rpb24K\nICAgICAgICAgICAgaWYgKF91bmlxdWUgPT0gQm9vbGVhbi5GQUxTRSkgewog\nICAgICAgICAgICAgICAgaWYgKCFuZXh0KQogICAgICAgICAgICAgICAgICAg\nIHJldHVybiBDb2xsZWN0aW9ucy5FTVBUWV9MSVNUOwogICAgICAgICAgICAg\nICAgLy8gQ29sbGVjdGlvbnMuc2luZ2xldG9uTGlzdCBpcyBKREsgMS4zLCBz\nby4uLgogICAgICAgICAgICAgICAgcmV0dXJuIEFycmF5cy5hc0xpc3QobmV3\nIE9iamVjdFtdeyBzaW5nbGUgfSk7CiAgICAgICAgICAgIH0KICAgICAgICAg\nICAgCiAgICAgICAgICAgIC8vIHJldHVybiBzaW5nbGUgcmVzdWx0CiAgICAg\nICAgICAgIHJldHVybiBzaW5nbGU7CiAgICAgICAgfSBmaW5hbGx5IHsKICAg\nICAgICAgICAgcm9wLmNsb3NlKCk7CiAgICAgICAgfQogICAgfQoKICAgIC8q\nKgogICAgICogQ2FsY3VsYXRlcyB3aGV0aGVyIHRoZSBhY2Nlc3MgcGF0aCBv\nZiB0aGlzIHF1ZXJ5IGludGVyc2VjdHMgd2l0aAogICAgICogYW55IGRpcnR5\nIG9iamVjdHMgaW4gdGhlIHRyYW5zYWN0aW9uLgogICAgICovCiAgICBwcml2\nYXRlIGJvb2xlYW4gaXNBY2Nlc3NQYXRoRGlydHkoKSB7CiAgICAgICAgcmV0\ndXJuIGlzQWNjZXNzUGF0aERpcnR5KF9icm9rZXIsIGdldEFjY2Vzc1BhdGhN\nZXRhRGF0YXMoKSk7CiAgICB9CgogICAgcHVibGljIHN0YXRpYyBib29sZWFu\nIGlzQWNjZXNzUGF0aERpcnR5KEJyb2tlciBicm9rZXIsCiAgICAgICAgQ2xh\nc3NNZXRhRGF0YVtdIGFjY2Vzc01ldGFzKSB7CiAgICAgICAgQ29sbGVjdGlv\nbjxDbGFzczw/Pj4gcGVyc2lzdGVkID0gYnJva2VyLmdldFBlcnNpc3RlZFR5\ncGVzKCk7CiAgICAgICAgQ29sbGVjdGlvbjxDbGFzczw/Pj4gdXBkYXRlZCA9\nIGJyb2tlci5nZXRVcGRhdGVkVHlwZXMoKTsKICAgICAgICBDb2xsZWN0aW9u\nPENsYXNzPD8+PiBkZWxldGVkID0gYnJva2VyLmdldERlbGV0ZWRUeXBlcygp\nOwogICAgICAgIGlmIChwZXJzaXN0ZWQuaXNFbXB0eSgpICYmIHVwZGF0ZWQu\naXNFbXB0eSgpICYmIGRlbGV0ZWQuaXNFbXB0eSgpKQogICAgICAgICAgICBy\nZXR1cm4gZmFsc2U7CgogICAgICAgIC8vIGlmIG5vIGFjY2VzcyBtZXRhcywg\nYXNzdW1lIGV2ZXJ5IGRpcnR5IG9iamVjdCBhZmZlY3RzIHBhdGgganVzdAog\nICAgICAgIC8vIHRvIGJlIHNhZmUKICAgICAgICBpZiAoYWNjZXNzTWV0YXMu\nbGVuZ3RoID09IDApCiAgICAgICAgICAgIHJldHVybiB0cnVlOwoKICAgICAg\nICAvLyBjb21wYXJlIGRpcnR5IGNsYXNzZXMgdG8gdGhlIGFjY2VzcyBwYXRo\nIGNsYXNzZXMKICAgICAgICBDbGFzczw/PiBhY2NDbGFzczsKICAgICAgICBm\nb3IgKGludCBpID0gMDsgaSA8IGFjY2Vzc01ldGFzLmxlbmd0aDsgaSsrKSB7\nCiAgICAgICAgICAgIGlmIChhY2Nlc3NNZXRhc1tpXSA9PSBudWxsKQogICAg\nICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgIC8vIHNob3J0Y3V0\nIGlmIGFjdHVhbCBjbGFzcyBpcyBkaXJ0eQogICAgICAgICAgICBhY2NDbGFz\ncyA9IGFjY2Vzc01ldGFzW2ldLmdldERlc2NyaWJlZFR5cGUoKTsKICAgICAg\nICAgICAgaWYgKHBlcnNpc3RlZC5jb250YWlucyhhY2NDbGFzcykgfHwgdXBk\nYXRlZC5jb250YWlucyhhY2NDbGFzcykKICAgICAgICAgICAgICAgIHx8IGRl\nbGV0ZWQuY29udGFpbnMoYWNjQ2xhc3MpKQogICAgICAgICAgICAgICAgcmV0\ndXJuIHRydWU7CgogICAgICAgICAgICAvLyBjaGVjayBmb3IgZGlydHkgc3Vi\nY2xhc3MKICAgICAgICAgICAgZm9yIChJdGVyYXRvcjxDbGFzczw/Pj4gZGly\ndHkgPSBwZXJzaXN0ZWQuaXRlcmF0b3IoKTsgZGlydHkuaGFzTmV4dCgpOykK\nICAgICAgICAgICAgICAgIGlmIChhY2NDbGFzcy5pc0Fzc2lnbmFibGVGcm9t\nKGRpcnR5Lm5leHQoKSkpCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRy\ndWU7CiAgICAgICAgICAgIGZvciAoSXRlcmF0b3I8Q2xhc3M8Pz4+IGRpcnR5\nID0gdXBkYXRlZC5pdGVyYXRvcigpOyBkaXJ0eS5oYXNOZXh0KCk7KQogICAg\nICAgICAgICAgICAgaWYgKGFjY0NsYXNzLmlzQXNzaWduYWJsZUZyb20oZGly\ndHkubmV4dCgpKSkKICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsK\nICAgICAgICAgICAgZm9yIChJdGVyYXRvcjxDbGFzczw/Pj4gZGlydHkgPSBk\nZWxldGVkLml0ZXJhdG9yKCk7IGRpcnR5Lmhhc05leHQoKTspCiAgICAgICAg\nICAgICAgICBpZiAoYWNjQ2xhc3MuaXNBc3NpZ25hYmxlRnJvbShkaXJ0eS5u\nZXh0KCkpKQogICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAg\nICAgIH0KCiAgICAgICAgLy8gbm8gaW50ZXJzZWN0aW9uCiAgICAgICAgcmV0\ndXJuIGZhbHNlOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIGNsb3NlQWxsKCkg\newogICAgICAgIGNsb3NlUmVzdWx0cyh0cnVlKTsKICAgIH0KCiAgICBwdWJs\naWMgdm9pZCBjbG9zZVJlc291cmNlcygpIHsKICAgICAgICBjbG9zZVJlc3Vs\ndHMoZmFsc2UpOwogICAgfQoKICAgIC8qKgogICAgICogQ2xvc2Ugb3BlbiBy\nZXN1bHRzLgogICAgICovCiAgICBwcml2YXRlIHZvaWQgY2xvc2VSZXN1bHRz\nKGJvb2xlYW4gZm9yY2UpIHsKICAgICAgICBsb2NrKCk7CiAgICAgICAgdHJ5\nIHsKICAgICAgICAgICAgYXNzZXJ0T3BlbigpOwoKICAgICAgICAgICAgUmVt\nb3ZlT25DbG9zZVJlc3VsdExpc3QgcmVzOwogICAgICAgICAgICBmb3IgKEl0\nZXJhdG9yPFJlbW92ZU9uQ2xvc2VSZXN1bHRMaXN0PiBpdHIgPSBfcmVzdWx0\nTGlzdHMuaXRlcmF0b3IoKTsgaXRyLmhhc05leHQoKTspIHsKICAgICAgICAg\nICAgICAgIHJlcyA9IGl0ci5uZXh0KCk7CiAgICAgICAgICAgICAgICBpZiAo\nZm9yY2UgfHwgcmVzLmlzUHJvdmlkZXJPcGVuKCkpCiAgICAgICAgICAgICAg\nICAgICAgcmVzLmNsb3NlKGZhbHNlKTsKICAgICAgICAgICAgfQogICAgICAg\nICAgICBfcmVzdWx0TGlzdHMuY2xlYXIoKTsKICAgICAgICB9IGZpbmFsbHkg\newogICAgICAgICAgICB1bmxvY2soKTsKICAgICAgICB9CiAgICB9CgogICAg\ncHVibGljIFN0cmluZ1tdIGdldERhdGFTdG9yZUFjdGlvbnMoTWFwIHBhcmFt\ncykgewogICAgICAgIGlmIChwYXJhbXMgPT0gbnVsbCkKICAgICAgICAgICAg\ncGFyYW1zID0gQ29sbGVjdGlvbnMuRU1QVFlfTUFQOwoKICAgICAgICBsb2Nr\nKCk7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgYXNzZXJ0Tm90U2VyaWFs\naXplZCgpOwogICAgICAgICAgICBhc3NlcnRPcGVuKCk7CgogICAgICAgICAg\nICBTdG9yZVF1ZXJ5LkV4ZWN1dG9yIGV4ID0gY29tcGlsZUZvckV4ZWN1dG9y\nKCk7CiAgICAgICAgICAgIGFzc2VydFBhcmFtZXRlcnMoX3N0b3JlUXVlcnks\nIGV4LCBwYXJhbXMpOwogICAgICAgICAgICBPYmplY3RbXSBhcnIgPSBleC50\nb1BhcmFtZXRlckFycmF5KF9zdG9yZVF1ZXJ5LCBwYXJhbXMpOwogICAgICAg\nICAgICBTdG9yZVF1ZXJ5LlJhbmdlIHJhbmdlID0gbmV3IFN0b3JlUXVlcnku\nUmFuZ2UoX3N0YXJ0SWR4LCBfZW5kSWR4KTsKICAgICAgICAgICAgaWYgKCFf\ncmFuZ2VTZXQpCiAgICAgICAgICAgICAgICBleC5nZXRSYW5nZShfc3RvcmVR\ndWVyeSwgYXJyLCByYW5nZSk7CiAgICAgICAgICAgIHJldHVybiBleC5nZXRE\nYXRhU3RvcmVBY3Rpb25zKF9zdG9yZVF1ZXJ5LCBhcnIsIHJhbmdlKTsKICAg\nICAgICB9IGNhdGNoIChPcGVuSlBBRXhjZXB0aW9uIGtlKSB7CiAgICAgICAg\nICAgIHRocm93IGtlOwogICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7\nCiAgICAgICAgICAgIHRocm93IG5ldyBVc2VyRXhjZXB0aW9uKGUpOwogICAg\nICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgIHVubG9jaygpOwogICAgICAg\nIH0KICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBzZXRRdWVyeShPYmplY3Qg\ncXVlcnkpIHsKICAgICAgICBsb2NrKCk7CiAgICAgICAgdHJ5IHsKICAgICAg\nICAgICAgYXNzZXJ0T3BlbigpOwogICAgICAgICAgICBhc3NlcnROb3RSZWFk\nT25seSgpOwoKICAgICAgICAgICAgaWYgKHF1ZXJ5ID09IG51bGwgfHwgcXVl\ncnkgaW5zdGFuY2VvZiBTdHJpbmcpIHsKICAgICAgICAgICAgICAgIGludmFs\naWRhdGVDb21waWxhdGlvbigpOwogICAgICAgICAgICAgICAgX3F1ZXJ5ID0g\nKFN0cmluZykgcXVlcnk7CiAgICAgICAgICAgICAgICBpZiAoX3F1ZXJ5ICE9\nIG51bGwpCiAgICAgICAgICAgICAgICAgICAgX3F1ZXJ5ID0gX3F1ZXJ5LnRy\naW0oKTsKICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAg\nICB9CiAgICAgICAgICAgIGlmICghKHF1ZXJ5IGluc3RhbmNlb2YgUXVlcnlJ\nbXBsKSkKICAgICAgICAgICAgICAgIHJldHVybiBfc3RvcmVRdWVyeS5zZXRR\ndWVyeShxdWVyeSk7CgogICAgICAgICAgICAvLyBjb3B5IGFsbCBub24tdHJh\nbnNpZW50IHN0YXRlIGZyb20gdGhlIGdpdmVuIHF1ZXJ5CiAgICAgICAgICAg\nIGludmFsaWRhdGVDb21waWxhdGlvbigpOwogICAgICAgICAgICBRdWVyeUlt\ncGwgcSA9IChRdWVyeUltcGwpIHF1ZXJ5OwogICAgICAgICAgICBfY2xhc3Mg\nPSBxLl9jbGFzczsKICAgICAgICAgICAgX3N1YmNsYXNzZXMgPSBxLl9zdWJj\nbGFzc2VzOwogICAgICAgICAgICBfcXVlcnkgPSBxLl9xdWVyeTsKICAgICAg\nICAgICAgX2lnbm9yZUNoYW5nZXMgPSBxLl9pZ25vcmVDaGFuZ2VzOwogICAg\nICAgICAgICBfdW5pcXVlID0gcS5fdW5pcXVlOwogICAgICAgICAgICBfcmVz\ndWx0Q2xhc3MgPSBxLl9yZXN1bHRDbGFzczsKICAgICAgICAgICAgX3BhcmFt\ncyA9IHEuX3BhcmFtczsKICAgICAgICAgICAgX3Jlc3VsdE1hcHBpbmdTY29w\nZSA9IHEuX3Jlc3VsdE1hcHBpbmdTY29wZTsKICAgICAgICAgICAgX3Jlc3Vs\ndE1hcHBpbmdOYW1lID0gcS5fcmVzdWx0TWFwcGluZ05hbWU7CiAgICAgICAg\nICAgIF9yZWFkT25seSA9IHEuX3JlYWRPbmx5OwoKICAgICAgICAgICAgLy8g\nZG9uJ3Qgc2hhcmUgbXV0YWJsZSBvYmplY3RzCiAgICAgICAgICAgIF9mYy5j\nb3B5KHEuX2ZjKTsKICAgICAgICAgICAgaWYgKHEuX2ZpbHRMaXN0ZW5lcnMg\nIT0gbnVsbCkKICAgICAgICAgICAgICAgIF9maWx0TGlzdGVuZXJzID0gbmV3\nIEhhc2hNYXA8U3RyaW5nLEZpbHRlckxpc3RlbmVyPihxLl9maWx0TGlzdGVu\nZXJzKTsKICAgICAgICAgICAgaWYgKHEuX2FnZ0xpc3RlbmVycyAhPSBudWxs\nKQogICAgICAgICAgICAgICAgX2FnZ0xpc3RlbmVycyA9IG5ldyBIYXNoTWFw\nPFN0cmluZyxBZ2dyZWdhdGVMaXN0ZW5lcj4ocS5fYWdnTGlzdGVuZXJzKTsK\nICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfSBmaW5hbGx5IHsK\nICAgICAgICAgICAgdW5sb2NrKCk7CiAgICAgICAgfQogICAgfQoKICAgIHB1\nYmxpYyBTdHJpbmcgZ2V0QWxpYXMoKSB7CiAgICAgICAgbG9jaygpOwogICAg\nICAgIHRyeSB7CiAgICAgICAgICAgIFN0cmluZyBhbGlhcyA9IGNvbXBpbGVG\nb3JFeGVjdXRvcigpLmdldEFsaWFzKF9zdG9yZVF1ZXJ5KTsKICAgICAgICAg\nICAgaWYgKGFsaWFzID09IG51bGwpCiAgICAgICAgICAgICAgICBhbGlhcyA9\nIFN0cmluZ3MuZ2V0Q2xhc3NOYW1lKF9jbGFzcyk7CiAgICAgICAgICAgIHJl\ndHVybiBhbGlhczsKICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICB1\nbmxvY2soKTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGljIFN0cmluZ1td\nIGdldFByb2plY3Rpb25BbGlhc2VzKCkgewogICAgICAgIGxvY2soKTsKICAg\nICAgICB0cnkgewogICAgICAgICAgICByZXR1cm4gY29tcGlsZUZvckV4ZWN1\ndG9yKCkuZ2V0UHJvamVjdGlvbkFsaWFzZXMoX3N0b3JlUXVlcnkpOwogICAg\nICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgIHVubG9jaygpOwogICAgICAg\nIH0KICAgIH0KCiAgICBwdWJsaWMgQ2xhc3M8Pz5bXSBnZXRQcm9qZWN0aW9u\nVHlwZXMoKSB7CiAgICAgICAgbG9jaygpOwogICAgICAgIHRyeSB7CiAgICAg\nICAgICAgIHJldHVybiBjb21waWxlRm9yRXhlY3V0b3IoKS5nZXRQcm9qZWN0\naW9uVHlwZXMoX3N0b3JlUXVlcnkpOwogICAgICAgIH0gZmluYWxseSB7CiAg\nICAgICAgICAgIHVubG9jaygpOwogICAgICAgIH0KICAgIH0KCiAgICBwdWJs\naWMgaW50IGdldE9wZXJhdGlvbigpIHsKICAgICAgICBsb2NrKCk7CiAgICAg\nICAgdHJ5IHsKICAgICAgICAgICAgcmV0dXJuIGNvbXBpbGVGb3JFeGVjdXRv\ncigpLmdldE9wZXJhdGlvbihfc3RvcmVRdWVyeSk7CiAgICAgICAgfSBmaW5h\nbGx5IHsKICAgICAgICAgICAgdW5sb2NrKCk7CiAgICAgICAgfQogICAgfQoK\nICAgIHB1YmxpYyBib29sZWFuIGlzQWdncmVnYXRlKCkgewogICAgICAgIGxv\nY2soKTsKICAgICAgICB0cnkgewogICAgICAgICAgICByZXR1cm4gY29tcGls\nZUZvckV4ZWN1dG9yKCkuaXNBZ2dyZWdhdGUoX3N0b3JlUXVlcnkpOwogICAg\nICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgIHVubG9jaygpOwogICAgICAg\nIH0KICAgIH0KICAgIAogICAgcHVibGljIGJvb2xlYW4gaXNEaXN0aW5jdCgp\nIHsKICAgICAgICBsb2NrKCk7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAg\ncmV0dXJuIGNvbXBpbGVGb3JFeGVjdXRvcigpLmlzRGlzdGluY3QoX3N0b3Jl\nUXVlcnkpOwogICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgIHVubG9j\naygpOwogICAgICAgIH0KICAgIH0KCgogICAgcHVibGljIGJvb2xlYW4gaGFz\nR3JvdXBpbmcoKSB7CiAgICAgICAgbG9jaygpOwogICAgICAgIHRyeSB7CiAg\nICAgICAgICAgIHJldHVybiBjb21waWxlRm9yRXhlY3V0b3IoKS5oYXNHcm91\ncGluZyhfc3RvcmVRdWVyeSk7CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAg\nICAgICAgdW5sb2NrKCk7CiAgICAgICAgfQogICAgfQoKICAgIHB1YmxpYyBD\nbGFzc01ldGFEYXRhW10gZ2V0QWNjZXNzUGF0aE1ldGFEYXRhcygpIHsKICAg\nICAgICBsb2NrKCk7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgQ2xhc3NN\nZXRhRGF0YVtdIG1ldGFzID0gY29tcGlsZUZvckV4ZWN1dG9yKCkuCiAgICAg\nICAgICAgICAgICBnZXRBY2Nlc3NQYXRoTWV0YURhdGFzKF9zdG9yZVF1ZXJ5\nKTsKICAgICAgICAgICAgcmV0dXJuIChtZXRhcyA9PSBudWxsKSA/IFN0b3Jl\nUXVlcnkuRU1QVFlfTUVUQVMgOiBtZXRhczsKICAgICAgICB9IGZpbmFsbHkg\newogICAgICAgICAgICB1bmxvY2soKTsKICAgICAgICB9CiAgICB9CgogICAg\ncHVibGljIE9yZGVyZWRNYXA8T2JqZWN0LENsYXNzPD8+PiBnZXRPcmRlcmVk\nUGFyYW1ldGVyVHlwZXMoKSB7CiAgICAgICAgbG9jaygpOwogICAgICAgIHRy\neSB7CiAgICAgICAgICAgIHJldHVybiBjb21waWxlRm9yRXhlY3V0b3IoKS5n\nZXRPcmRlcmVkUGFyYW1ldGVyVHlwZXMoX3N0b3JlUXVlcnkpOwogICAgICAg\nIH0gZmluYWxseSB7CiAgICAgICAgICAgIHVubG9jaygpOwogICAgICAgIH0K\nICAgIH0KICAgIAogICAgcHVibGljIExpbmtlZE1hcCBnZXRQYXJhbWV0ZXJU\neXBlcygpIHsKICAgICAgICBsb2NrKCk7CiAgICAgICAgdHJ5IHsKICAgICAg\nICAgICAgTGlua2VkTWFwIHdyYXAgPSBuZXcgTGlua2VkTWFwKCk7CiAgICAg\nICAgICAgIHdyYXAucHV0QWxsKGNvbXBpbGVGb3JFeGVjdXRvcigpLmdldE9y\nZGVyZWRQYXJhbWV0ZXJUeXBlcyhfc3RvcmVRdWVyeSkpOwogICAgICAgICAg\nICByZXR1cm4gd3JhcDsKICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAg\nICB1bmxvY2soKTsKICAgICAgICB9CiAgICB9CgoKICAgIHB1YmxpYyBNYXAg\nZ2V0VXBkYXRlcygpIHsKICAgICAgICBsb2NrKCk7CiAgICAgICAgdHJ5IHsK\nICAgICAgICAgICAgcmV0dXJuIGNvbXBpbGVGb3JFeGVjdXRvcigpLmdldFVw\nZGF0ZXMoX3N0b3JlUXVlcnkpOwogICAgICAgIH0gZmluYWxseSB7CiAgICAg\nICAgICAgIHVubG9jaygpOwogICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMg\ndm9pZCBsb2NrKCkgewogICAgICAgIGlmIChfbG9jayAhPSBudWxsKQogICAg\nICAgICAgICBfbG9jay5sb2NrKCk7CiAgICB9CgogICAgcHVibGljIHZvaWQg\ndW5sb2NrKCkgewogICAgICAgIGlmIChfbG9jayAhPSBudWxsKQogICAgICAg\nICAgICBfbG9jay51bmxvY2soKTsKICAgIH0KICAgIAogICAgcHVibGljIHN5\nbmNocm9uaXplZCB2b2lkIHN0YXJ0TG9ja2luZygpIHsKICAgIAlpZiAoX2xv\nY2sgPT0gbnVsbCkgewogICAgCQlfbG9jayA9IG5ldyBSZWVudHJhbnRMb2Nr\nKCk7CiAgICAJfQogICAgfQogICAgCiAgICBwdWJsaWMgc3luY2hyb25pemVk\nIHZvaWQgc3RvcExvY2tpbmcoKSB7CiAgICAJaWYgKF9sb2NrICE9IG51bGwg\nJiYgIV9icm9rZXIuZ2V0TXVsdGl0aHJlYWRlZCgpKQogICAgCQlfbG9jayA9\nIG51bGw7CiAgICB9CiAgICAKICAgIAoKICAgIC8vLy8vLy8vLwogICAgLy8g\nVXRpbHMKICAgIC8vLy8vLy8vLwoKICAgIHB1YmxpYyBDbGFzcyBjbGFzc0Zv\nck5hbWUoU3RyaW5nIG5hbWUsIFN0cmluZ1tdIGltcG9ydHMpIHsKICAgICAg\nICAvLyBmdWxsIGNsYXNzIG5hbWUgb3IgcHJpbWl0aXZlIHR5cGU/CiAgICAg\nICAgQ2xhc3MgdHlwZSA9IHRvQ2xhc3MobmFtZSk7CiAgICAgICAgaWYgKHR5\ncGUgIT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIHR5cGU7CgogICAgICAg\nIC8vIGZpcnN0IGNoZWNrIHRoZSBhbGlhc2VzIG1hcCBpbiB0aGUgTWV0YURh\ndGFSZXBvc2l0b3J5CiAgICAgICAgQ2xhc3NMb2FkZXIgbG9hZGVyID0gKF9j\nbGFzcyA9PSBudWxsKSA/IF9sb2FkZXIKICAgICAgICAgICAgOiBBY2Nlc3ND\nb250cm9sbGVyLmRvUHJpdmlsZWdlZCgKICAgICAgICAgICAgICAgIEoyRG9Q\ncml2SGVscGVyLmdldENsYXNzTG9hZGVyQWN0aW9uKF9jbGFzcykpOyAKICAg\nICAgICBDbGFzc01ldGFEYXRhIG1ldGEgPSBfYnJva2VyLmdldENvbmZpZ3Vy\nYXRpb24oKS4KICAgICAgICAgICAgZ2V0TWV0YURhdGFSZXBvc2l0b3J5SW5z\ndGFuY2UoKS5nZXRNZXRhRGF0YShuYW1lLCBsb2FkZXIsIGZhbHNlKTsKICAg\nICAgICBpZiAobWV0YSAhPSBudWxsKQogICAgICAgICAgICByZXR1cm4gbWV0\nYS5nZXREZXNjcmliZWRUeXBlKCk7CgogICAgICAgIC8vIHRyeSB0aGUgbmFt\nZSBpbiB0aGUgcGFja2FnZSBvZiB0aGUgY2FuZGlkYXRlIGNsYXNzCiAgICAg\nICAgaWYgKF9jbGFzcyAhPSBudWxsKSB7CiAgICAgICAgICAgIFN0cmluZyBm\ndWxsTmFtZSA9IF9jbGFzcy5nZXROYW1lKCkuc3Vic3RyaW5nCiAgICAgICAg\nICAgICAgICAoMCwgX2NsYXNzLmdldE5hbWUoKS5sYXN0SW5kZXhPZignLicp\nICsgMSkgKyBuYW1lOwogICAgICAgICAgICB0eXBlID0gdG9DbGFzcyhmdWxs\nTmFtZSk7CiAgICAgICAgICAgIGlmICh0eXBlICE9IG51bGwpCiAgICAgICAg\nICAgICAgICByZXR1cm4gdHlwZTsKICAgICAgICB9CgogICAgICAgIC8vIHRy\neSBqYXZhLmxhbmcKICAgICAgICB0eXBlID0gdG9DbGFzcygiamF2YS5sYW5n\nLiIgKyBuYW1lKTsKICAgICAgICBpZiAodHlwZSAhPSBudWxsKQogICAgICAg\nICAgICByZXR1cm4gdHlwZTsKCiAgICAgICAgLy8gdHJ5IGVhY2ggaW1wb3J0\nCiAgICAgICAgaWYgKGltcG9ydHMgIT0gbnVsbCAmJiBpbXBvcnRzLmxlbmd0\naCA+IDApIHsKICAgICAgICAgICAgU3RyaW5nIGRvdE5hbWUgPSAiLiIgKyBu\nYW1lOwogICAgICAgICAgICBTdHJpbmcgaW1wb3J0TmFtZTsKICAgICAgICAg\nICAgZm9yIChpbnQgaSA9IDA7IGkgPCBpbXBvcnRzLmxlbmd0aDsgaSsrKSB7\nCiAgICAgICAgICAgICAgICBpbXBvcnROYW1lID0gaW1wb3J0c1tpXTsKCiAg\nICAgICAgICAgICAgICAvLyBmdWxsIGNsYXNzIG5hbWUgaW1wb3J0CiAgICAg\nICAgICAgICAgICBpZiAoaW1wb3J0TmFtZS5lbmRzV2l0aChkb3ROYW1lKSkK\nICAgICAgICAgICAgICAgICAgICB0eXBlID0gdG9DbGFzcyhpbXBvcnROYW1l\nKTsKICAgICAgICAgICAgICAgICAgICAvLyB3aWxkY2FyZDsgc3RyaXAgdG8g\ncGFja2FnZQogICAgICAgICAgICAgICAgZWxzZSBpZiAoaW1wb3J0TmFtZS5l\nbmRzV2l0aCgiLioiKSkgewogICAgICAgICAgICAgICAgICAgIGltcG9ydE5h\nbWUgPSBpbXBvcnROYW1lLnN1YnN0cmluZwogICAgICAgICAgICAgICAgICAg\nICAgICAoMCwgaW1wb3J0TmFtZS5sZW5ndGgoKSAtIDEpOwogICAgICAgICAg\nICAgICAgICAgIHR5cGUgPSB0b0NsYXNzKGltcG9ydE5hbWUgKyBuYW1lKTsK\nICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmICh0eXBlICE9\nIG51bGwpCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHR5cGU7CiAgICAg\nICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIHtAbGluayBDbGFzc30gZm9y\nIHRoZSBnaXZlbiBuYW1lLCBvciBudWxsIGlmIG5hbWUgbm90IHZhbGlkLgog\nICAgICovCiAgICBwcml2YXRlIENsYXNzIHRvQ2xhc3MoU3RyaW5nIG5hbWUp\nIHsKICAgICAgICBpZiAoX2xvYWRlciA9PSBudWxsKQogICAgICAgICAgICBf\nbG9hZGVyID0gX2Jyb2tlci5nZXRDb25maWd1cmF0aW9uKCkuZ2V0Q2xhc3NS\nZXNvbHZlckluc3RhbmNlKCkuCiAgICAgICAgICAgICAgICBnZXRDbGFzc0xv\nYWRlcihfY2xhc3MsIF9icm9rZXIuZ2V0Q2xhc3NMb2FkZXIoKSk7CiAgICAg\nICAgdHJ5IHsKICAgICAgICAgICAgcmV0dXJuIFN0cmluZ3MudG9DbGFzcyhu\nYW1lLCBfbG9hZGVyKTsKICAgICAgICB9IGNhdGNoIChSdW50aW1lRXhjZXB0\naW9uIHJlKSB7CiAgICAgICAgfSBjYXRjaCAoTm9DbGFzc0RlZkZvdW5kRXJy\nb3IgbmNkZmUpIHsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIG51bGw7CiAg\nICB9CgogICAgcHVibGljIHZvaWQgYXNzZXJ0T3BlbigpIHsKICAgICAgICBp\nZiAoX2Jyb2tlciAhPSBudWxsKQogICAgICAgICAgICBfYnJva2VyLmFzc2Vy\ndE9wZW4oKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBhc3NlcnROb3RSZWFk\nT25seSgpIHsKICAgICAgICBpZiAoX3JlYWRPbmx5KQogICAgICAgICAgICB0\naHJvdyBuZXcgSW52YWxpZFN0YXRlRXhjZXB0aW9uKF9sb2MuZ2V0KCJyZWFk\nLW9ubHkiKSk7CiAgICB9CgogICAgcHVibGljIHZvaWQgYXNzZXJ0Tm90U2Vy\naWFsaXplZCgpIHsKICAgICAgICBpZiAoX2Jyb2tlciA9PSBudWxsKQogICAg\nICAgICAgICB0aHJvdyBuZXcgSW52YWxpZFN0YXRlRXhjZXB0aW9uKF9sb2Mu\nZ2V0KCJzZXJpYWxpemVkIikpOwogICAgfQoKICAgIC8qKgogICAgICogQ2hl\nY2sgdGhhdCBhIGNhbmRpZGF0ZSBjbGFzcyBoYXMgYmVlbiBzZXQgZm9yIHRo\nZSBxdWVyeS4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIGFzc2VydENhbmRp\nZGF0ZVR5cGUoKSB7CiAgICAgICAgaWYgKF9jbGFzcyA9PSBudWxsICYmIF9z\ndG9yZVF1ZXJ5LnJlcXVpcmVzQ2FuZGlkYXRlVHlwZSgpKQogICAgICAgICAg\nICB0aHJvdyBuZXcgSW52YWxpZFN0YXRlRXhjZXB0aW9uKF9sb2MuZ2V0KCJu\nby1jbGFzcyIpKTsKICAgIH0KCiAgICAvKioKICAgICAqIENoZWNrIHRoYXQg\nd2UgYXJlIGluIGEgc3RhdGUgdG8gYmUgYWJsZSB0byBwZXJmb3JtIGEgYnVs\nayBvcGVyYXRpb247CiAgICAgKiBhbHNvIGZsdXNoIHRoZSBjdXJyZW50IG1v\nZGZpY2F0aW9ucyBpZiBhbnkgZWxlbWVudHMgYXJlIGN1cnJlbnRseSBkaXJ0\neS4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIGFzc2VydEJ1bGtNb2RpZnko\nU3RvcmVRdWVyeSBxLCBTdG9yZVF1ZXJ5LkV4ZWN1dG9yIGV4LCAKICAgICAg\nICBPYmplY3RbXSBwYXJhbXMpIHsKICAgICAgICBfYnJva2VyLmFzc2VydEFj\ndGl2ZVRyYW5zYWN0aW9uKCk7CiAgICAgICAgaWYgKF9zdGFydElkeCAhPSAw\nIHx8IF9lbmRJZHggIT0gTG9uZy5NQVhfVkFMVUUpCiAgICAgICAgICAgIHRo\ncm93IG5ldyBVc2VyRXhjZXB0aW9uKF9sb2MuZ2V0KCJuby1tb2RpZnktcmFu\nZ2UiKSk7CiAgICAgICAgaWYgKF9yZXN1bHRDbGFzcyAhPSBudWxsKQogICAg\nICAgICAgICB0aHJvdyBuZXcgVXNlckV4Y2VwdGlvbihfbG9jLmdldCgibm8t\nbW9kaWZ5LXJlc3VsdGNsYXNzIikpOwogICAgICAgIFN0b3JlUXVlcnkuUmFu\nZ2UgcmFuZ2UgPSBuZXcgU3RvcmVRdWVyeS5SYW5nZSgpOwogICAgICAgIGV4\nLmdldFJhbmdlKHEsIHBhcmFtcywgcmFuZ2UpOwogICAgICAgIGlmIChyYW5n\nZS5zdGFydCAhPSAwIHx8IHJhbmdlLmVuZCAhPSBMb25nLk1BWF9WQUxVRSkK\nICAgICAgICAgICAgdGhyb3cgbmV3IFVzZXJFeGNlcHRpb24oX2xvYy5nZXQo\nIm5vLW1vZGlmeS1yYW5nZSIpKTsKICAgIH0KCiAgICAvKioKICAgICAqIENo\nZWNrcyB0aGF0IHRoZSBwYXNzZWQgcGFyYW1ldGVycyBtYXRjaCB0aGUgZGVj\nbGFyYXRpb25zLgogICAgICovCiAgICBwcm90ZWN0ZWQgdm9pZCBhc3NlcnRQ\nYXJhbWV0ZXJzKFN0b3JlUXVlcnkgcSwgU3RvcmVRdWVyeS5FeGVjdXRvciBl\neCwgCiAgICAgICAgT2JqZWN0W10gcGFyYW1zKSB7CiAgICAgICAgaWYgKCFx\nLnJlcXVpcmVzUGFyYW1ldGVyRGVjbGFyYXRpb25zKCkgfHwgIWlzUGFyc2Vk\nUXVlcnkoKSkKICAgICAgICAgICAgcmV0dXJuOwoKICAgICAgICBPcmRlcmVk\nTWFwPE9iamVjdCxDbGFzczw/Pj4gcGFyYW1UeXBlcyA9IGV4LmdldE9yZGVy\nZWRQYXJhbWV0ZXJUeXBlcyhxKTsKICAgICAgICBpbnQgdHlwZUNvdW50ID0g\ncGFyYW1UeXBlcy5zaXplKCk7CiAgICAgICAgaWYgKHR5cGVDb3VudCA+IHBh\ncmFtcy5sZW5ndGgpCiAgICAgICAgICAgIHRocm93IG5ldyBVc2VyRXhjZXB0\naW9uKF9sb2MuZ2V0KCJ1bmJvdW5kLXBhcmFtcyIsCiAgICAgICAgICAgICAg\nICBwYXJhbVR5cGVzLmtleVNldCgpKSk7CgogICAgICAgIEl0ZXJhdG9yPE1h\ncC5FbnRyeTxPYmplY3QsQ2xhc3M8Pz4+PiBpdHIgPSBwYXJhbVR5cGVzLmVu\ndHJ5U2V0KCkuaXRlcmF0b3IoKTsKICAgICAgICBNYXAuRW50cnk8T2JqZWN0\nLENsYXNzPD8+PiBlbnRyeTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaXRy\nLmhhc05leHQoKTsgaSsrKSB7CiAgICAgICAgICAgIGVudHJ5ID0gaXRyLm5l\neHQoKTsKICAgICAgICAgICAgaWYgKGVudHJ5LmdldFZhbHVlKCkuaXNQcmlt\naXRpdmUoKSAmJiBwYXJhbXNbaV0gPT0gbnVsbCkKICAgICAgICAgICAgICAg\nIHRocm93IG5ldyBVc2VyRXhjZXB0aW9uKF9sb2MuZ2V0KCJudWxsLXByaW1p\ndGl2ZS1wYXJhbSIsIGVudHJ5LmdldEtleSgpKSk7CiAgICAgICAgfQogICAg\nfQogICAgCiAgICBwcm90ZWN0ZWQgdm9pZCBhc3NlcnRQYXJhbWV0ZXJzKFN0\nb3JlUXVlcnkgcSwgU3RvcmVRdWVyeS5FeGVjdXRvciBleCwgTWFwIHBhcmFt\ncykgewogICAgICAgIGlmICghcS5yZXF1aXJlc1BhcmFtZXRlckRlY2xhcmF0\naW9ucygpKQogICAgICAgICAgICByZXR1cm47CgogICAgICAgIE9yZGVyZWRN\nYXA8T2JqZWN0LENsYXNzPD8+PiBwYXJhbVR5cGVzID0gZXguZ2V0T3JkZXJl\nZFBhcmFtZXRlclR5cGVzKHEpOwogICAgICAgIGZvciAoT2JqZWN0IGFjdHVh\nbCA6IHBhcmFtcy5rZXlTZXQoKSkgewogICAgICAgICAgICBpZiAoIXBhcmFt\nVHlwZXMuY29udGFpbnNLZXkoYWN0dWFsKSkKICAgICAgICAgICAgdGhyb3cg\nbmV3IFVzZXJFeGNlcHRpb24oX2xvYy5nZXQoInVuYm91bmQtcGFyYW1zIiwK\nICAgICAgICAgICAgICAgIGFjdHVhbCwgcGFyYW1UeXBlcy5rZXlTZXQoKSkp\nOwogICAgICAgIH0KICAgICAgICBmb3IgKE9iamVjdCBleHBlY3RlZCA6IHBh\ncmFtVHlwZXMua2V5U2V0KCkpIHsKICAgICAgICAgICAgaWYgKCFwYXJhbXMu\nY29udGFpbnNLZXkoZXhwZWN0ZWQpKQogICAgICAgICAgICB0aHJvdyBuZXcg\nVXNlckV4Y2VwdGlvbihfbG9jLmdldCgidW5ib3VuZC1wYXJhbXMiLAogICAg\nICAgICAgICAgICAgZXhwZWN0ZWQsIHBhcmFtcy5rZXlTZXQoKSkpOwogICAg\nICAgIH0KCiAgICAgICAgSXRlcmF0b3I8TWFwLkVudHJ5PE9iamVjdCwgQ2xh\nc3M8Pz4+PiBpdHIgPSBwYXJhbVR5cGVzLmVudHJ5U2V0KCkuaXRlcmF0b3Io\nKTsKICAgICAgICBNYXAuRW50cnk8T2JqZWN0LCBDbGFzczw/Pj4gZW50cnk7\nCiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGl0ci5oYXNOZXh0KCk7IGkrKykg\newogICAgICAgICAgICBlbnRyeSA9IGl0ci5uZXh0KCk7CiAgICAgICAgICAg\nIGlmIChlbnRyeS5nZXRWYWx1ZSgpLmlzUHJpbWl0aXZlKCkgCiAgICAgICAg\nICAgICAgICAmJiBwYXJhbXMuZ2V0KGVudHJ5LmdldEtleSgpKSA9PSBudWxs\nKQogICAgICAgICAgICAgICAgdGhyb3cgbmV3IFVzZXJFeGNlcHRpb24oX2xv\nYy5nZXQoIm51bGwtcHJpbWl0aXZlLXBhcmFtIiwgZW50cnkuZ2V0S2V5KCkp\nKTsKICAgICAgICB9CiAgICB9CgoKICAgIHB1YmxpYyBTdHJpbmcgdG9TdHJp\nbmcoKSB7CiAgICAgICAgU3RyaW5nQnVpbGRlciBidWYgPSBuZXcgU3RyaW5n\nQnVpbGRlcigyNTUpOwogICAgICAgIGJ1Zi5hcHBlbmQoIlF1ZXJ5OiAiKS5h\ncHBlbmQoc3VwZXIudG9TdHJpbmcoKSk7CiAgICAgICAgYnVmLmFwcGVuZCgi\nOyBjYW5kaWRhdGUgY2xhc3M6ICIpLmFwcGVuZChfY2xhc3MpOwogICAgICAg\nIGJ1Zi5hcHBlbmQoIjsgcXVlcnk6ICIpLmFwcGVuZChfcXVlcnkpOwogICAg\nICAgIHJldHVybiBidWYudG9TdHJpbmcoKTsKICAgIH0KCiAgICAvKioKICAg\nICAqIFN0cnVjdCBvZiBjb21waWxlZCBxdWVyeSBwcm9wZXJ0aWVzLgogICAg\nICovCiAgICBwcm90ZWN0ZWQgc3RhdGljIGNsYXNzIENvbXBpbGF0aW9uCiAg\nICAgICAgaW1wbGVtZW50cyBTZXJpYWxpemFibGUgewoKICAgICAgICBwdWJs\naWMgU3RvcmVRdWVyeS5FeGVjdXRvciBtZW1vcnkgPSBudWxsOwogICAgICAg\nIHB1YmxpYyBTdG9yZVF1ZXJ5LkV4ZWN1dG9yIGRhdGFzdG9yZSA9IG51bGw7\nCiAgICAgICAgcHVibGljIE9iamVjdCBzdG9yZURhdGEgPSBudWxsOwogICAg\nfQoKICAgIC8qKgogICAgICogU3RydWN0IHRvIGhvbGQgdGhlIHVucGFyc2Vk\nIHByb3BlcnRpZXMgYXNzb2NpYXRlZCB3aXRoIGEgcXVlcnkuCiAgICAgKi8K\nICAgIHByaXZhdGUgc3RhdGljIGNsYXNzIENvbXBpbGF0aW9uS2V5CiAgICAg\nICAgaW1wbGVtZW50cyBTZXJpYWxpemFibGUgewoKICAgICAgICBwdWJsaWMg\nQ2xhc3MgcXVlcnlUeXBlID0gbnVsbDsKICAgICAgICBwdWJsaWMgQ2xhc3Mg\nY2FuZGlkYXRlVHlwZSA9IG51bGw7CiAgICAgICAgcHVibGljIGJvb2xlYW4g\nc3ViY2xhc3NlcyA9IHRydWU7CiAgICAgICAgcHVibGljIFN0cmluZyBxdWVy\neSA9IG51bGw7CiAgICAgICAgcHVibGljIFN0cmluZyBsYW5ndWFnZSA9IG51\nbGw7CiAgICAgICAgcHVibGljIE9iamVjdCBzdG9yZUtleSA9IG51bGw7Cgog\nICAgICAgIHB1YmxpYyBpbnQgaGFzaENvZGUoKSB7CiAgICAgICAgICAgIGlu\ndCBycyA9IDE3OwogICAgICAgICAgICBycyA9IDM3ICogcnMgKyAoKHF1ZXJ5\nVHlwZSA9PSBudWxsKSA/IDAgOiBxdWVyeVR5cGUuaGFzaENvZGUoKSk7CiAg\nICAgICAgICAgIHJzID0gMzcgKiBycyArICgocXVlcnkgPT0gbnVsbCkgPyAw\nIDogcXVlcnkuaGFzaENvZGUoKSk7CiAgICAgICAgICAgIHJzID0gMzcgKiBy\ncyArICgobGFuZ3VhZ2UgPT0gbnVsbCkgPyAwIDogbGFuZ3VhZ2UuaGFzaENv\nZGUoKSk7CiAgICAgICAgICAgIHJzID0gMzcgKiBycyArICgoc3RvcmVLZXkg\nPT0gbnVsbCkgPyAwIDogc3RvcmVLZXkuaGFzaENvZGUoKSk7CiAgICAgICAg\nICAgIGlmIChzdWJjbGFzc2VzKQogICAgICAgICAgICAgIHJzKys7CiAgICAg\nICAgICAgIHJldHVybiByczsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBi\nb29sZWFuIGVxdWFscyhPYmplY3Qgb3RoZXIpIHsKICAgICAgICAgICAgaWYg\nKG90aGVyID09IHRoaXMpCiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsK\nICAgICAgICAgICAgaWYgKG90aGVyID09IG51bGwgfHwgb3RoZXIuZ2V0Q2xh\nc3MoKSAhPSBnZXRDbGFzcygpKQogICAgICAgICAgICAgICAgcmV0dXJuIGZh\nbHNlOwoKICAgICAgICAgICAgQ29tcGlsYXRpb25LZXkga2V5ID0gKENvbXBp\nbGF0aW9uS2V5KSBvdGhlcjsKICAgICAgICAgICAgaWYgKGtleS5xdWVyeVR5\ncGUgIT0gcXVlcnlUeXBlCiAgICAgICAgICAgICAgICB8fCAhU3RyaW5nVXRp\nbHMuZXF1YWxzKGtleS5xdWVyeSwgcXVlcnkpCiAgICAgICAgICAgICAgICB8\nfCAhU3RyaW5nVXRpbHMuZXF1YWxzKGtleS5sYW5ndWFnZSwgbGFuZ3VhZ2Up\nKQogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICBp\nZiAoa2V5LnN1YmNsYXNzZXMgIT0gc3ViY2xhc3NlcykKICAgICAgICAgICAg\nICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgaWYgKCFPYmplY3RVdGls\ncy5lcXVhbHMoa2V5LnN0b3JlS2V5LCBzdG9yZUtleSkpCiAgICAgICAgICAg\nICAgICByZXR1cm4gZmFsc2U7CgogICAgICAgICAgICAvLyBhbGxvdyBlaXRo\nZXIgY2FuZGlkYXRlIHR5cGUgdG8gYmUgbnVsbCBiZWNhdXNlIGl0IG1pZ2h0\nIGJlCiAgICAgICAgICAgIC8vIGVuY29kZWQgaW4gdGhlIHF1ZXJ5IHN0cmlu\nZywgYnV0IGlmIGJvdGggYXJlIHNldCB0aGVuIHRoZXkKICAgICAgICAgICAg\nLy8gbXVzdCBiZSBlcXVhbAogICAgICAgICAgICByZXR1cm4ga2V5LmNhbmRp\nZGF0ZVR5cGUgPT0gbnVsbCB8fCBjYW5kaWRhdGVUeXBlID09IG51bGwKICAg\nICAgICAgICAgICAgIHx8IGtleS5jYW5kaWRhdGVUeXBlID09IGNhbmRpZGF0\nZVR5cGU7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogQSBtZXJn\nZWQgZXhlY3V0b3IgZXhlY3V0ZXMgbXVsdGlwbGUgUXVlcmllcyBhbmQgcmV0\ndXJucwogICAgICogYSBtZXJnZWQgcmVzdWx0IGxpc3Qgd2l0aCB0aGUgYXBw\ncm9wcmlhdGUgb3JkZXJpbmcgKGlmIG1vcmUgdGhhbgogICAgICogb25lIHF1\nZXJ5IG5lZWRzIHRvIGJlIGV4ZWN1dGVkKS4gVGhpcyBleGVjdXRvciBoYXMg\ndGhlIGZvbGxvd2luZwogICAgICogbGltaXRhdGlvbnM6CiAgICAgKiA8dWw+\nCiAgICAgKiA8bGk+SXQgY2Fubm90IGNvbWJpbmUgYWdncmVnYXRlcy4KICAg\nICAqIDxsaT5JdCBjYW5ub3QgY29sbGF0ZSB0aGUgcmVzdWx0IGxpc3RzIGlm\nIG9yZGVyaW5nIGlzIHNwZWNpZmllZCBhbmQKICAgICAqIGEgcmVzdWx0IHN0\ncmluZyBpcyBnaXZlbiwgYnV0IGRvZXMgbm90IGluY2x1ZGUgdGhlIG9yZGVy\naW5nCiAgICAgKiBjcml0ZXJpYS48L2xpPgogICAgICogPGxpPkl0IGNhbm5v\ndCBmaWx0ZXIgZHVwbGljYXRlIHJlc3VsdHMgZnJvbSBkaWZmZXJlbnQgcmVz\ndWx0IGxpc3RzIGlmCiAgICAgKiB0aGUgcmVzdWx0IGlzIG1hcmtlZCBkaXN0\naW5jdC4gVGhpcyB3b3VsZCByZXF1aXJlIHRyYWNraW5nIGFsbAogICAgICog\ncHJldmlvdXMgcmVzdWx0cywgd2hpY2ggd291bGQgaW50ZXJmZXJlIHdpdGgg\nbGFyZ2UgcmVzdWx0IHNldAogICAgICogaGFuZGxpbmcuPC9saT4KICAgICAq\nIDwvdWw+CiAgICAgKgogICAgICogQGF1dGhvciBNYXJjIFBydWQnaG9tbWVh\ndXgKICAgICAqIEBub2phdmFkb2MKICAgICAqLwogICAgcHJpdmF0ZSBzdGF0\naWMgY2xhc3MgTWVyZ2VkRXhlY3V0b3IKICAgICAgICBpbXBsZW1lbnRzIFN0\nb3JlUXVlcnkuRXhlY3V0b3IgewoKICAgICAgICBwcml2YXRlIGZpbmFsIFN0\nb3JlUXVlcnkuRXhlY3V0b3JbXSBfZXhlY3V0b3JzOwoKICAgICAgICBwdWJs\naWMgTWVyZ2VkRXhlY3V0b3IoU3RvcmVRdWVyeS5FeGVjdXRvcltdIGV4ZWN1\ndG9ycykgewogICAgICAgICAgICBfZXhlY3V0b3JzID0gZXhlY3V0b3JzOwog\nICAgICAgIH0KICAgICAgICAKICAgICAgICBwdWJsaWMgUXVlcnlFeHByZXNz\naW9uc1tdIGdldFF1ZXJ5RXhwcmVzc2lvbnMoKSB7CiAgICAgICAgICAgIHJl\ndHVybiBfZXhlY3V0b3JzWzBdLmdldFF1ZXJ5RXhwcmVzc2lvbnMoKTsKICAg\nICAgICB9CgogICAgICAgIHB1YmxpYyBSZXN1bHRPYmplY3RQcm92aWRlciBl\neGVjdXRlUXVlcnkoU3RvcmVRdWVyeSBxLAogICAgICAgICAgICBPYmplY3Rb\nXSBwYXJhbXMsIFN0b3JlUXVlcnkuUmFuZ2UgcmFuZ2UpIHsKICAgICAgICAg\nICAgaWYgKF9leGVjdXRvcnMubGVuZ3RoID09IDEpCiAgICAgICAgICAgICAg\nICByZXR1cm4gX2V4ZWN1dG9yc1swXS5leGVjdXRlUXVlcnkocSwgcGFyYW1z\nLCByYW5nZSk7CgogICAgICAgICAgICAvLyB1c2UgbHJzIHNldHRpbmdzIGlm\nIHdlIGNvdWxkbid0IHRha2UgYWR2YW50YWdlIG9mIHRoZSBzdGFydCBpbmRl\neAogICAgICAgICAgICAvLyBzbyB0aGF0IGhvcGVmdWxseSB0aGUgc2tpcCB0\nbyB0aGUgc3RhcnQgd2lsbCBiZSBlZmZpY2llbnQKICAgICAgICAgICAgU3Rv\ncmVRdWVyeS5SYW5nZSByb3BSYW5nZSA9IG5ldyBTdG9yZVF1ZXJ5LlJhbmdl\nKDAsIHJhbmdlLmVuZCk7CiAgICAgICAgICAgIHJvcFJhbmdlLmxycyA9IHJh\nbmdlLmxycyB8fCAocmFuZ2Uuc3RhcnQgPiAwICYmIHEuZ2V0Q29udGV4dCgp\nLgogICAgICAgICAgICAgICAgZ2V0RmV0Y2hDb25maWd1cmF0aW9uKCkuZ2V0\nRmV0Y2hCYXRjaFNpemUoKSA+PSAwKTsKCiAgICAgICAgICAgIC8vIGV4ZWN1\ndGUgdGhlIHF1ZXJ5OyB3ZSBjYW5ub3QgdXNlIHRoZSBsb3dlciBib3VuZCBv\nZiB0aGUgcmVzdWx0CiAgICAgICAgICAgIC8vIHJhbmdlLCBidXQgd2UgY2Fu\nIHRha2UgYWR2YW50YWdlIG9mIHRoZSB1cHBlciBib3VuZAogICAgICAgICAg\nICBSZXN1bHRPYmplY3RQcm92aWRlcltdIHJvcHMgPQogICAgICAgICAgICAg\nICAgbmV3IFJlc3VsdE9iamVjdFByb3ZpZGVyW19leGVjdXRvcnMubGVuZ3Ro\nXTsKICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBfZXhlY3V0b3Jz\nLmxlbmd0aDsgaSsrKQogICAgICAgICAgICAgICAgcm9wc1tpXSA9IF9leGVj\ndXRvcnNbaV0uZXhlY3V0ZVF1ZXJ5KHEsIHBhcmFtcywgcm9wUmFuZ2UpOwoK\nICAgICAgICAgICAgYm9vbGVhbltdIGFzYyA9IF9leGVjdXRvcnNbMF0uZ2V0\nQXNjZW5kaW5nKHEpOwogICAgICAgICAgICBSZXN1bHRPYmplY3RQcm92aWRl\nciByb3A7CiAgICAgICAgICAgIGlmIChhc2MubGVuZ3RoID09IDApCiAgICAg\nICAgICAgICAgICByb3AgPSBuZXcgTWVyZ2VkUmVzdWx0T2JqZWN0UHJvdmlk\nZXIocm9wcyk7CiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIHJv\ncCA9IG5ldyBPcmRlcmluZ01lcmdlZFJlc3VsdE9iamVjdFByb3ZpZGVyKHJv\ncHMsIGFzYywKICAgICAgICAgICAgICAgICAgICBfZXhlY3V0b3JzLCBxLCBw\nYXJhbXMpOwoKICAgICAgICAgICAgLy8gaWYgdGhlcmUgaXMgYSBsb3dlciBi\nb3VuZCwgd3JhcCBpbiByYW5nZSByb3AKICAgICAgICAgICAgaWYgKHJhbmdl\nLnN0YXJ0ICE9IDApCiAgICAgICAgICAgICAgICByb3AgPSBuZXcgUmFuZ2VS\nZXN1bHRPYmplY3RQcm92aWRlcihyb3AsIHJhbmdlLnN0YXJ0LCAKICAgICAg\nICAgICAgICAgICAgICByYW5nZS5lbmQpOwogICAgICAgICAgICByZXR1cm4g\ncm9wOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIE51bWJlciBleGVjdXRl\nRGVsZXRlKFN0b3JlUXVlcnkgcSwgT2JqZWN0W10gcGFyYW1zKSB7CiAgICAg\nICAgICAgIGxvbmcgbnVtID0gMDsKICAgICAgICAgICAgZm9yIChpbnQgaSA9\nIDA7IGkgPCBfZXhlY3V0b3JzLmxlbmd0aDsgaSsrKQogICAgICAgICAgICAg\nICAgbnVtICs9IF9leGVjdXRvcnNbaV0uZXhlY3V0ZURlbGV0ZShxLCBwYXJh\nbXMpLmxvbmdWYWx1ZSgpOwogICAgICAgICAgICByZXR1cm4gTnVtYmVycy52\nYWx1ZU9mKG51bSk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgTnVtYmVy\nIGV4ZWN1dGVVcGRhdGUoU3RvcmVRdWVyeSBxLCBPYmplY3RbXSBwYXJhbXMp\nIHsKICAgICAgICAgICAgbG9uZyBudW0gPSAwOwogICAgICAgICAgICBmb3Ig\nKGludCBpID0gMDsgaSA8IF9leGVjdXRvcnMubGVuZ3RoOyBpKyspCiAgICAg\nICAgICAgICAgICBudW0gKz0gX2V4ZWN1dG9yc1tpXS5leGVjdXRlVXBkYXRl\nKHEsIHBhcmFtcykubG9uZ1ZhbHVlKCk7CiAgICAgICAgICAgIHJldHVybiBO\ndW1iZXJzLnZhbHVlT2YobnVtKTsKICAgICAgICB9CgogICAgICAgIHB1Ymxp\nYyBTdHJpbmdbXSBnZXREYXRhU3RvcmVBY3Rpb25zKFN0b3JlUXVlcnkgcSwg\nT2JqZWN0W10gcGFyYW1zLAogICAgICAgICAgICBTdG9yZVF1ZXJ5LlJhbmdl\nIHJhbmdlKSB7CiAgICAgICAgICAgIGlmIChfZXhlY3V0b3JzLmxlbmd0aCA9\nPSAxKQogICAgICAgICAgICAgICAgcmV0dXJuIF9leGVjdXRvcnNbMF0uZ2V0\nRGF0YVN0b3JlQWN0aW9ucyhxLCBwYXJhbXMsIHJhbmdlKTsKCiAgICAgICAg\nICAgIExpc3QgcmVzdWx0cyA9IG5ldyBBcnJheUxpc3QoX2V4ZWN1dG9ycy5s\nZW5ndGgpOwogICAgICAgICAgICBTdG9yZVF1ZXJ5LlJhbmdlIHJvcFJhbmdl\nID0gbmV3IFN0b3JlUXVlcnkuUmFuZ2UoMEwsIHJhbmdlLmVuZCk7CiAgICAg\nICAgICAgIFN0cmluZ1tdIGFjdGlvbnM7CiAgICAgICAgICAgIGZvciAoaW50\nIGkgPSAwOyBpIDwgX2V4ZWN1dG9ycy5sZW5ndGg7IGkrKykgewogICAgICAg\nICAgICAgICAgYWN0aW9ucyA9IF9leGVjdXRvcnNbaV0uZ2V0RGF0YVN0b3Jl\nQWN0aW9ucyhxLCBwYXJhbXMscm9wUmFuZ2UpOwogICAgICAgICAgICAgICAg\naWYgKGFjdGlvbnMgIT0gbnVsbCAmJiBhY3Rpb25zLmxlbmd0aCA+IDApCiAg\nICAgICAgICAgICAgICAgICAgcmVzdWx0cy5hZGRBbGwoQXJyYXlzLmFzTGlz\ndChhY3Rpb25zKSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJu\nIChTdHJpbmdbXSkgcmVzdWx0cy50b0FycmF5KG5ldyBTdHJpbmdbcmVzdWx0\ncy5zaXplKCldKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyB2b2lkIHZh\nbGlkYXRlKFN0b3JlUXVlcnkgcSkgewogICAgICAgICAgICBfZXhlY3V0b3Jz\nWzBdLnZhbGlkYXRlKHEpOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIHZv\naWQgZ2V0UmFuZ2UoU3RvcmVRdWVyeSBxLCBPYmplY3RbXSBwYXJhbXMsIAog\nICAgICAgICAgICBTdG9yZVF1ZXJ5LlJhbmdlIHJhbmdlKSB7CiAgICAgICAg\nICAgIF9leGVjdXRvcnNbMF0uZ2V0UmFuZ2UocSwgcGFyYW1zLCByYW5nZSk7\nCiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgT2JqZWN0IGdldE9yZGVyaW5n\nVmFsdWUoU3RvcmVRdWVyeSBxLCBPYmplY3RbXSBwYXJhbXMsCiAgICAgICAg\nICAgIE9iamVjdCByZXN1bHRPYmplY3QsIGludCBpZHgpIHsKICAgICAgICAg\nICAgLy8gdW5mb3J0dW5hdGVseSwgYXQgdGhpcyBwb2ludCAobXVzdCBiZSBh\nIG1lcmdlZCByb3AgY29udGFpbmluZwogICAgICAgICAgICAvLyBvdGhlciBt\nZXJnZWQgcm9wcykgd2UgaGF2ZSBubyBpZGVhIHdoaWNoIGV4ZWN1dG9yIHRv\nIGV4dHJhY3QKICAgICAgICAgICAgLy8gdGhlIHZhbHVlIGZyb20KICAgICAg\nICAgICAgcmV0dXJuIF9leGVjdXRvcnNbMF0uZ2V0T3JkZXJpbmdWYWx1ZShx\nLCBwYXJhbXMsIHJlc3VsdE9iamVjdCwgaWR4KTsKICAgICAgICB9CgogICAg\nICAgIHB1YmxpYyBib29sZWFuW10gZ2V0QXNjZW5kaW5nKFN0b3JlUXVlcnkg\ncSkgewogICAgICAgICAgICByZXR1cm4gX2V4ZWN1dG9yc1swXS5nZXRBc2Nl\nbmRpbmcocSk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgU3RyaW5nIGdl\ndEFsaWFzKFN0b3JlUXVlcnkgcSkgewogICAgICAgICAgICByZXR1cm4gX2V4\nZWN1dG9yc1swXS5nZXRBbGlhcyhxKTsKICAgICAgICB9CgogICAgICAgIHB1\nYmxpYyBTdHJpbmdbXSBnZXRQcm9qZWN0aW9uQWxpYXNlcyhTdG9yZVF1ZXJ5\nIHEpIHsKICAgICAgICAgICAgcmV0dXJuIF9leGVjdXRvcnNbMF0uZ2V0UHJv\namVjdGlvbkFsaWFzZXMocSk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMg\nQ2xhc3MgZ2V0UmVzdWx0Q2xhc3MoU3RvcmVRdWVyeSBxKSB7CiAgICAgICAg\nICAgIHJldHVybiBfZXhlY3V0b3JzWzBdLmdldFJlc3VsdENsYXNzKHEpOwog\nICAgICAgIH0KCiAgICAgICAgcHVibGljIFJlc3VsdFNoYXBlPD8+IGdldFJl\nc3VsdFNoYXBlKFN0b3JlUXVlcnkgcSkgewogICAgICAgICAgICByZXR1cm4g\nX2V4ZWN1dG9yc1swXS5nZXRSZXN1bHRTaGFwZShxKTsKICAgICAgICB9CiAg\nICAgICAgCiAgICAgICAgcHVibGljIENsYXNzW10gZ2V0UHJvamVjdGlvblR5\ncGVzKFN0b3JlUXVlcnkgcSkgewogICAgICAgICAgICByZXR1cm4gX2V4ZWN1\ndG9yc1swXS5nZXRQcm9qZWN0aW9uVHlwZXMocSk7CiAgICAgICAgfQoKICAg\nICAgICBwdWJsaWMgYm9vbGVhbiBpc1BhY2tpbmcoU3RvcmVRdWVyeSBxKSB7\nCiAgICAgICAgICAgIHJldHVybiBfZXhlY3V0b3JzWzBdLmlzUGFja2luZyhx\nKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBDbGFzc01ldGFEYXRhW10g\nZ2V0QWNjZXNzUGF0aE1ldGFEYXRhcyhTdG9yZVF1ZXJ5IHEpIHsKICAgICAg\nICAgICAgaWYgKF9leGVjdXRvcnMubGVuZ3RoID09IDEpCiAgICAgICAgICAg\nICAgICByZXR1cm4gX2V4ZWN1dG9yc1swXS5nZXRBY2Nlc3NQYXRoTWV0YURh\ndGFzKHEpOwoKICAgICAgICAgICAgLy8gY3JlYXRlIHNldCBvZiBiYXNlIGNs\nYXNzIG1ldGFkYXRhcyBpbiBhY2Nlc3MgcGF0aAogICAgICAgICAgICBMaXN0\nIG1ldGFzID0gbnVsbDsKICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkg\nPCBfZXhlY3V0b3JzLmxlbmd0aDsgaSsrKQogICAgICAgICAgICAgICAgbWV0\nYXMgPSBGaWx0ZXJzLmFkZEFjY2Vzc1BhdGhNZXRhRGF0YXMobWV0YXMsIF9l\neGVjdXRvcnNbaV0uCiAgICAgICAgICAgICAgICAgICAgZ2V0QWNjZXNzUGF0\naE1ldGFEYXRhcyhxKSk7CiAgICAgICAgICAgIGlmIChtZXRhcyA9PSBudWxs\nKQogICAgICAgICAgICAgICAgcmV0dXJuIFN0b3JlUXVlcnkuRU1QVFlfTUVU\nQVM7CiAgICAgICAgICAgIHJldHVybiAoQ2xhc3NNZXRhRGF0YVtdKSBtZXRh\ncy50b0FycmF5CiAgICAgICAgICAgICAgICAobmV3IENsYXNzTWV0YURhdGFb\nbWV0YXMuc2l6ZSgpXSk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgYm9v\nbGVhbiBpc0FnZ3JlZ2F0ZShTdG9yZVF1ZXJ5IHEpIHsKICAgICAgICAgICAg\naWYgKCFfZXhlY3V0b3JzWzBdLmlzQWdncmVnYXRlKHEpKQogICAgICAgICAg\nICAgICAgcmV0dXJuIGZhbHNlOwoKICAgICAgICAgICAgLy8gd2UgY2FuJ3Qg\nbWVyZ2UgYWdncmVnYXRlcwogICAgICAgICAgICB0aHJvdyBuZXcgVW5zdXBw\nb3J0ZWRFeGNlcHRpb24oX2xvYy5nZXQoIm1lcmdlZC1hZ2dyZWdhdGUiLAog\nICAgICAgICAgICAgICAgcS5nZXRDb250ZXh0KCkuZ2V0Q2FuZGlkYXRlVHlw\nZSgpLAogICAgICAgICAgICAgICAgcS5nZXRDb250ZXh0KCkuZ2V0UXVlcnlT\ndHJpbmcoKSkpOwogICAgICAgIH0KICAgICAgICAKICAgICAgICBwdWJsaWMg\nYm9vbGVhbiBpc0Rpc3RpbmN0KFN0b3JlUXVlcnkgcSkgewogICAgICAgICAg\nICByZXR1cm4gX2V4ZWN1dG9yc1swXS5pc0Rpc3RpbmN0KHEpOwogICAgICAg\nIH0KCiAgICAgICAgcHVibGljIGludCBnZXRPcGVyYXRpb24oU3RvcmVRdWVy\neSBxKSB7CiAgICAgICAgICAgIHJldHVybiBfZXhlY3V0b3JzWzBdLmdldE9w\nZXJhdGlvbihxKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBib29sZWFu\nIGhhc0dyb3VwaW5nKFN0b3JlUXVlcnkgcSkgewogICAgICAgICAgICByZXR1\ncm4gX2V4ZWN1dG9yc1swXS5oYXNHcm91cGluZyhxKTsKICAgICAgICB9Cgog\nICAgICAgIHB1YmxpYyBPcmRlcmVkTWFwPE9iamVjdCxDbGFzczw/Pj4gZ2V0\nT3JkZXJlZFBhcmFtZXRlclR5cGVzKFN0b3JlUXVlcnkgcSkgewogICAgICAg\nICAgICByZXR1cm4gX2V4ZWN1dG9yc1swXS5nZXRPcmRlcmVkUGFyYW1ldGVy\nVHlwZXMocSk7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIHB1YmxpYyBM\naW5rZWRNYXAgZ2V0UGFyYW1ldGVyVHlwZXMoU3RvcmVRdWVyeSBxKSB7CiAg\nICAgICAgICAgIHJldHVybiBfZXhlY3V0b3JzWzBdLmdldFBhcmFtZXRlclR5\ncGVzKHEpOwogICAgICAgIH0KICAgICAgICAKICAgICAgICBwdWJsaWMgT2Jq\nZWN0W10gdG9QYXJhbWV0ZXJBcnJheShTdG9yZVF1ZXJ5IHEsIE1hcCB1c2Vy\nUGFyYW1zKSB7CiAgICAgICAgICAgIHJldHVybiBfZXhlY3V0b3JzWzBdLnRv\nUGFyYW1ldGVyQXJyYXkocSwgdXNlclBhcmFtcyk7CiAgICAgICAgfQoKCiAg\nICAgICAgcHVibGljIE1hcCBnZXRVcGRhdGVzKFN0b3JlUXVlcnkgcSkgewog\nICAgICAgICAgICByZXR1cm4gX2V4ZWN1dG9yc1swXS5nZXRVcGRhdGVzKHEp\nOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIFJlc3VsdCBvYmpl\nY3QgcHJvdmlkZXIgdGhhdCBwYWNrcyByZXN1bHRzIGJlZm9yZSByZXR1cm5p\nbmcgdGhlbS4KICAgICAqLwogICAgcHVibGljIHN0YXRpYyBjbGFzcyBQYWNr\naW5nUmVzdWx0T2JqZWN0UHJvdmlkZXIKICAgICAgICBpbXBsZW1lbnRzIFJl\nc3VsdE9iamVjdFByb3ZpZGVyIHsKCiAgICAgICAgcHJpdmF0ZSBmaW5hbCBS\nZXN1bHRPYmplY3RQcm92aWRlciBfZGVsZWdhdGU7CiAgICAgICAgcHJpdmF0\nZSBmaW5hbCBSZXN1bHRQYWNrZXIgX3BhY2tlcjsKICAgICAgICBwcml2YXRl\nIGZpbmFsIGludCBfbGVuOwoKICAgICAgICBwdWJsaWMgUGFja2luZ1Jlc3Vs\ndE9iamVjdFByb3ZpZGVyKFJlc3VsdE9iamVjdFByb3ZpZGVyIGRlbGVnYXRl\nLAogICAgICAgICAgICBSZXN1bHRQYWNrZXIgcGFja2VyLCBpbnQgcmVzdWx0\nTGVuZ3RoKSB7CiAgICAgICAgICAgIF9kZWxlZ2F0ZSA9IGRlbGVnYXRlOwog\nICAgICAgICAgICBfcGFja2VyID0gcGFja2VyOwogICAgICAgICAgICBfbGVu\nID0gcmVzdWx0TGVuZ3RoOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIGJv\nb2xlYW4gc3VwcG9ydHNSYW5kb21BY2Nlc3MoKSB7CiAgICAgICAgICAgIHJl\ndHVybiBfZGVsZWdhdGUuc3VwcG9ydHNSYW5kb21BY2Nlc3MoKTsKICAgICAg\nICB9CgogICAgICAgIHB1YmxpYyB2b2lkIG9wZW4oKQogICAgICAgICAgICB0\naHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICAgICAgX2RlbGVnYXRlLm9wZW4o\nKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBPYmplY3QgZ2V0UmVzdWx0\nT2JqZWN0KCkKICAgICAgICAgICAgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAg\nICAgICAgIE9iamVjdCBvYiA9IF9kZWxlZ2F0ZS5nZXRSZXN1bHRPYmplY3Qo\nKTsKICAgICAgICAgICAgaWYgKF9wYWNrZXIgPT0gbnVsbCAmJiBfbGVuID09\nIDEpCiAgICAgICAgICAgICAgICByZXR1cm4gKChPYmplY3RbXSkgb2IpWzBd\nOwogICAgICAgICAgICBpZiAoX3BhY2tlciA9PSBudWxsKQogICAgICAgICAg\nICAgICAgcmV0dXJuIG9iOwogICAgICAgICAgICBpZiAoX2xlbiA9PSAwKQog\nICAgICAgICAgICAgICAgcmV0dXJuIF9wYWNrZXIucGFjayhvYik7CiAgICAg\nICAgICAgIHJldHVybiBfcGFja2VyLnBhY2soKE9iamVjdFtdKSBvYik7CiAg\nICAgICAgfQoKICAgICAgICBwdWJsaWMgYm9vbGVhbiBuZXh0KCkKICAgICAg\nICAgICAgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgICAgIHJldHVybiBf\nZGVsZWdhdGUubmV4dCgpOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIGJv\nb2xlYW4gYWJzb2x1dGUoaW50IHBvcykKICAgICAgICAgICAgdGhyb3dzIEV4\nY2VwdGlvbiB7CiAgICAgICAgICAgIHJldHVybiBfZGVsZWdhdGUuYWJzb2x1\ndGUocG9zKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBpbnQgc2l6ZSgp\nCiAgICAgICAgICAgIHRocm93cyBFeGNlcHRpb24gewogICAgICAgICAgICBy\nZXR1cm4gX2RlbGVnYXRlLnNpemUoKTsKICAgICAgICB9CgogICAgICAgIHB1\nYmxpYyB2b2lkIHJlc2V0KCkKICAgICAgICAgICAgdGhyb3dzIEV4Y2VwdGlv\nbiB7CiAgICAgICAgICAgIF9kZWxlZ2F0ZS5yZXNldCgpOwogICAgICAgIH0K\nCiAgICAgICAgcHVibGljIHZvaWQgY2xvc2UoKQogICAgICAgICAgICB0aHJv\nd3MgRXhjZXB0aW9uIHsKICAgICAgICAgICAgX2RlbGVnYXRlLmNsb3NlKCk7\nCiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgdm9pZCBoYW5kbGVDaGVja2Vk\nRXhjZXB0aW9uKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgIF9kZWxlZ2F0\nZS5oYW5kbGVDaGVja2VkRXhjZXB0aW9uKGUpOwogICAgICAgIH0KICAgICAg\nICAKICAgICAgICBwdWJsaWMgUmVzdWx0T2JqZWN0UHJvdmlkZXIgZ2V0RGVs\nZWdhdGUoKSB7CiAgICAgICAgICAgIHJldHVybiBfZGVsZWdhdGU7CiAgICAg\nICAgfQogICAgfQoKICAgIC8qKgogICAgICogUmVzdWx0IGxpc3QgdGhhdCBy\nZW1vdmVzIGl0c2VsZiBmcm9tIHRoZSBxdWVyeSdzIG9wZW4gcmVzdWx0IGxp\nc3QKICAgICAqIHdoZW4gaXQgaXMgY2xvc2VkLiBQdWJsaWMgZm9yIHRlc3Rp\nbmcuCiAgICAgKi8KICAgIHB1YmxpYyBjbGFzcyBSZW1vdmVPbkNsb3NlUmVz\ndWx0TGlzdAogICAgICAgIGltcGxlbWVudHMgUmVzdWx0TGlzdCB7CgogICAg\nICAgIHByaXZhdGUgZmluYWwgUmVzdWx0TGlzdCBfcmVzOwoKICAgICAgICBw\ndWJsaWMgUmVtb3ZlT25DbG9zZVJlc3VsdExpc3QoUmVzdWx0TGlzdCByZXMp\nIHsKICAgICAgICAgICAgX3JlcyA9IHJlczsKICAgICAgICB9CgogICAgICAg\nIHB1YmxpYyBSZXN1bHRMaXN0IGdldERlbGVnYXRlKCkgewogICAgICAgICAg\nICByZXR1cm4gX3JlczsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBib29s\nZWFuIGlzUHJvdmlkZXJPcGVuKCkgewogICAgICAgICAgICByZXR1cm4gX3Jl\ncy5pc1Byb3ZpZGVyT3BlbigpOwogICAgICAgIH0KICAgICAgICAKICAgICAg\nICBwdWJsaWMgT2JqZWN0IGdldFVzZXJPYmplY3QoKSB7CiAgICAgICAgICAg\nIHJldHVybiBfcmVzLmdldFVzZXJPYmplY3QoKTsKICAgICAgICB9CiAgICAg\nICAgCiAgICAgICAgcHVibGljIHZvaWQgc2V0VXNlck9iamVjdChPYmplY3Qg\nb3BhcXVlKSB7CiAgICAgICAgICAgIF9yZXMuc2V0VXNlck9iamVjdChvcGFx\ndWUpOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIGJvb2xlYW4gaXNDbG9z\nZWQoKSB7CiAgICAgICAgICAgIHJldHVybiBfcmVzLmlzQ2xvc2VkKCk7CiAg\nICAgICAgfQoKICAgICAgICBwdWJsaWMgdm9pZCBjbG9zZSgpIHsKICAgICAg\nICAgICAgY2xvc2UodHJ1ZSk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMg\ndm9pZCBjbG9zZShib29sZWFuIHJlbW92ZSkgewogICAgICAgICAgICBpZiAo\naXNDbG9zZWQoKSkKICAgICAgICAgICAgICAgIHJldHVybjsKCiAgICAgICAg\nICAgIF9yZXMuY2xvc2UoKTsKICAgICAgICAgICAgaWYgKCFyZW1vdmUpCiAg\nICAgICAgICAgICAgICByZXR1cm47CgogICAgICAgICAgICBsb2NrKCk7CiAg\nICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAvLyBkb24ndCB1c2Ug\nc3RhbmRhcmQgX3Jlc3VsdExpc3RzLnJlbW92ZSBtZXRob2QgYi9jIHJlbGll\ncyBvbgogICAgICAgICAgICAgICAgLy8gY29sbGVjdGlvbiBlcXVhbGl0eSwg\nd2hpY2ggcmVsaWVzIG9uIGVsZW1lbnQgZXF1YWxpdHksIHdoaWNoCiAgICAg\nICAgICAgICAgICAvLyBtZWFucyB3ZSBlbmQgdXAgdHJhdmVyc2luZyBlbnRp\ncmUgcmVzdWx0IGxpc3RzIQogICAgICAgICAgICAgICAgZm9yIChJdGVyYXRv\nciBpdHIgPSBfcmVzdWx0TGlzdHMuaXRlcmF0b3IoKTsgaXRyLmhhc05leHQo\nKTspIHsKICAgICAgICAgICAgICAgICAgICBpZiAoaXRyLm5leHQoKSA9PSB0\naGlzKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGl0ci5yZW1vdmUoKTsK\nICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAg\nICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGZpbmFs\nbHkgewogICAgICAgICAgICAgICAgdW5sb2NrKCk7CiAgICAgICAgICAgIH0K\nICAgICAgICB9CgogICAgICAgIHB1YmxpYyBpbnQgc2l6ZSgpIHsKICAgICAg\nICAgICAgcmV0dXJuIF9yZXMuc2l6ZSgpOwogICAgICAgIH0KCiAgICAgICAg\ncHVibGljIGJvb2xlYW4gaXNFbXB0eSgpIHsKICAgICAgICAgICAgcmV0dXJu\nIF9yZXMuaXNFbXB0eSgpOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIGJv\nb2xlYW4gY29udGFpbnMoT2JqZWN0IG8pIHsKICAgICAgICAgICAgcmV0dXJu\nIF9yZXMuY29udGFpbnMobyk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMg\nSXRlcmF0b3IgaXRlcmF0b3IoKSB7CiAgICAgICAgICAgIHJldHVybiBfcmVz\nLml0ZXJhdG9yKCk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgT2JqZWN0\nW10gdG9BcnJheSgpIHsKICAgICAgICAgICAgcmV0dXJuIF9yZXMudG9BcnJh\neSgpOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIE9iamVjdFtdIHRvQXJy\nYXkoT2JqZWN0W10gYSkgewogICAgICAgICAgICByZXR1cm4gX3Jlcy50b0Fy\ncmF5KGEpOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIGJvb2xlYW4gYWRk\nKE9iamVjdCBvKSB7CiAgICAgICAgICAgIHJldHVybiBfcmVzLmFkZChvKTsK\nICAgICAgICB9CgogICAgICAgIHB1YmxpYyBib29sZWFuIHJlbW92ZShPYmpl\nY3QgbykgewogICAgICAgICAgICByZXR1cm4gX3Jlcy5yZW1vdmUobyk7CiAg\nICAgICAgfQoKICAgICAgICBwdWJsaWMgYm9vbGVhbiBjb250YWluc0FsbChD\nb2xsZWN0aW9uIGMpIHsKICAgICAgICAgICAgcmV0dXJuIF9yZXMuY29udGFp\nbnNBbGwoYyk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgYm9vbGVhbiBh\nZGRBbGwoQ29sbGVjdGlvbiBjKSB7CiAgICAgICAgICAgIHJldHVybiBfcmVz\nLmFkZEFsbChjKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBib29sZWFu\nIGFkZEFsbChpbnQgaWR4LCBDb2xsZWN0aW9uIGMpIHsKICAgICAgICAgICAg\ncmV0dXJuIF9yZXMuYWRkQWxsKGlkeCwgYyk7CiAgICAgICAgfQoKICAgICAg\nICBwdWJsaWMgYm9vbGVhbiByZW1vdmVBbGwoQ29sbGVjdGlvbiBjKSB7CiAg\nICAgICAgICAgIHJldHVybiBfcmVzLnJlbW92ZUFsbChjKTsKICAgICAgICB9\nCgogICAgICAgIHB1YmxpYyBib29sZWFuIHJldGFpbkFsbChDb2xsZWN0aW9u\nIGMpIHsKICAgICAgICAgICAgcmV0dXJuIF9yZXMucmV0YWluQWxsKGMpOwog\nICAgICAgIH0KCiAgICAgICAgcHVibGljIHZvaWQgY2xlYXIoKSB7CiAgICAg\nICAgICAgIF9yZXMuY2xlYXIoKTsKICAgICAgICB9CgogICAgICAgIHB1Ymxp\nYyBPYmplY3QgZ2V0KGludCBpZHgpIHsKICAgICAgICAgICAgcmV0dXJuIF9y\nZXMuZ2V0KGlkeCk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgT2JqZWN0\nIHNldChpbnQgaWR4LCBPYmplY3QgbykgewogICAgICAgICAgICByZXR1cm4g\nX3Jlcy5zZXQoaWR4LCBvKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyB2\nb2lkIGFkZChpbnQgaWR4LCBPYmplY3QgbykgewogICAgICAgICAgICBfcmVz\nLmFkZChpZHgsIG8pOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIE9iamVj\ndCByZW1vdmUoaW50IGlkeCkgewogICAgICAgICAgICByZXR1cm4gX3Jlcy5y\nZW1vdmUoaWR4KTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBpbnQgaW5k\nZXhPZihPYmplY3QgbykgewogICAgICAgICAgICByZXR1cm4gX3Jlcy5pbmRl\neE9mKG8pOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIGludCBsYXN0SW5k\nZXhPZihPYmplY3QgbykgewogICAgICAgICAgICByZXR1cm4gX3Jlcy5sYXN0\nSW5kZXhPZihvKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBMaXN0SXRl\ncmF0b3IgbGlzdEl0ZXJhdG9yKCkgewogICAgICAgICAgICByZXR1cm4gX3Jl\ncy5saXN0SXRlcmF0b3IoKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBM\naXN0SXRlcmF0b3IgbGlzdEl0ZXJhdG9yKGludCBpZHgpIHsKICAgICAgICAg\nICAgcmV0dXJuIF9yZXMubGlzdEl0ZXJhdG9yKGlkeCk7CiAgICAgICAgfQoK\nICAgICAgICBwdWJsaWMgTGlzdCBzdWJMaXN0KGludCBzdGFydCwgaW50IGVu\nZCkgewogICAgICAgICAgICByZXR1cm4gX3Jlcy5zdWJMaXN0KHN0YXJ0LCBl\nbmQpOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIGJvb2xlYW4gZXF1YWxz\nKE9iamVjdCBvKSB7CiAgICAgICAgICAgIHJldHVybiBfcmVzLmVxdWFscyhv\nKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBpbnQgaGFzaENvZGUoKSB7\nCiAgICAgICAgICAgIHJldHVybiBfcmVzLmhhc2hDb2RlKCk7CiAgICAgICAg\nfQoKICAgICAgICBwdWJsaWMgU3RyaW5nIHRvU3RyaW5nICgpCgkJewoJCQly\nZXR1cm4gX3Jlcy50b1N0cmluZyAoKTsKCQl9CgoJCXB1YmxpYyBPYmplY3Qg\nd3JpdGVSZXBsYWNlICgpCgkJewoJCQlyZXR1cm4gX3JlczsKCQl9Cgl9Cn0K\n","encoding":"base64"}

