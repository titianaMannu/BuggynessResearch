{"sha":"6363126ec065bd551a929b829ecea05edfde1745","node_id":"MDQ6QmxvYjIwNjM2NDo2MzYzMTI2ZWMwNjViZDU1MWE5MjliODI5ZWNlYTA1ZWRmZGUxNzQ1","size":25854,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/6363126ec065bd551a929b829ecea05edfde1745","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLmV4cHM7CgppbXBv\ncnQgamF2YS51dGlsLkFycmF5TGlzdDsKaW1wb3J0IGphdmEudXRpbC5BcnJh\neXM7CmltcG9ydCBqYXZhLnV0aWwuQ29sbGVjdGlvbjsKaW1wb3J0IGphdmEu\ndXRpbC5Db2xsZWN0aW9uczsKaW1wb3J0IGphdmEudXRpbC5Db21wYXJhdG9y\nOwppbXBvcnQgamF2YS51dGlsLkRhdGU7CmltcG9ydCBqYXZhLnV0aWwuSGFz\naFNldDsKaW1wb3J0IGphdmEudXRpbC5JdGVyYXRvcjsKaW1wb3J0IGphdmEu\ndXRpbC5MaXN0OwppbXBvcnQgamF2YS51dGlsLkxpc3RJdGVyYXRvcjsKaW1w\nb3J0IGphdmEudXRpbC5TZXQ7CgppbXBvcnQgb3JnLmFwYWNoZS5jb21tb25z\nLmxhbmcuT2JqZWN0VXRpbHM7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\na2VybmVsLkV4dGVudDsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJu\nZWwuU3RvcmVDb250ZXh0OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxp\nYi51dGlsLkxvY2FsaXplcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5t\nZXRhLkNsYXNzTWV0YURhdGE7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\ndXRpbC5JbXBsSGVscGVyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0\naWwuVW5zdXBwb3J0ZWRFeGNlcHRpb247CmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEudXRpbC5Vc2VyRXhjZXB0aW9uOwoKLyoqCiAqIEV4cHJlc3Npb24g\nZmFjdG9yeSBpbXBsZW1lbnRhdGlvbiB0aGF0IGNhbiBiZSB1c2VkIHRvIGV4\nZWN1dGUgcXVlcmllcwogKiBpbiBtZW1vcnkuCiAqCiAqIEBhdXRob3IgQWJl\nIFdoaXRlCiAqIEBub2phdmFkb2MKICovCnB1YmxpYyBjbGFzcyBJbk1lbW9y\neUV4cHJlc3Npb25GYWN0b3J5CiAgICBpbXBsZW1lbnRzIEV4cHJlc3Npb25G\nYWN0b3J5IHsKCiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBWYWx1ZSBOVUxM\nID0gbmV3IE51bGwoKTsKICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIE9iamVj\ndCBVTklRVUUgPSBuZXcgT2JqZWN0KCk7CgogICAgLy8gbGlzdCBvZiB1bmJv\ndW5kIHZhcmlhYmxlcyBpbiB0aGlzIHF1ZXJ5CiAgICBwcml2YXRlIExpc3Qg\nX3VuYm91bmRzID0gbnVsbDsKCiAgICAvKioKICAgICAqIFRlc3RzIHdoZXRo\nZXIgdGhlIGdpdmVuIGNhbmRpZGF0ZSBtYXRjaGVzIHRoZSBnaXZlbiB0eXBl\nIGFuZCB0aGlzCiAgICAgKiBleHByZXNzaW9uLgogICAgICovCiAgICBwdWJs\naWMgYm9vbGVhbiBtYXRjaGVzKFF1ZXJ5RXhwcmVzc2lvbnMgZXhwcywgQ2xh\nc3NNZXRhRGF0YSB0eXBlLAogICAgICAgIGJvb2xlYW4gc3VicywgT2JqZWN0\nIGNhbmRpZGF0ZSwgU3RvcmVDb250ZXh0IGN0eCwgT2JqZWN0W10gcGFyYW1z\nKSB7CiAgICAgICAgLy8gaWdub3JlIGNhbmRpZGF0ZXMgb2YgdGhlIHdyb25n\nIHR5cGUKICAgICAgICBpZiAoY2FuZGlkYXRlID09IG51bGwpCiAgICAgICAg\nICAgIHJldHVybiBmYWxzZTsKICAgICAgICBpZiAoIXN1YnMgJiYgY2FuZGlk\nYXRlLmdldENsYXNzKCkgIT0gdHlwZS5nZXREZXNjcmliZWRUeXBlKCkpCiAg\nICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICBpZiAoc3VicyAmJiAh\ndHlwZS5nZXREZXNjcmliZWRUeXBlKCkuaXNBc3NpZ25hYmxlRnJvbQogICAg\nICAgICAgICAoY2FuZGlkYXRlLmdldENsYXNzKCkpKQogICAgICAgICAgICBy\nZXR1cm4gZmFsc2U7CgogICAgICAgIC8vIGV2YWx1YXRlIHRoZSBleHByZXNz\naW9uIGZvciBhbGwgcG9zc2libGUgY29tYmluYXRpb25zIG9mIHZhbHVlcwog\nICAgICAgIC8vIG9mIHRoZSB1bmJvdW5kIHZhcmlhYmxlczsgdGhlIGNhbmRp\nZGF0ZSBtYXRjaGVzIGlmIGFueSBjb21iaW5hdGlvbgogICAgICAgIC8vIG1h\ndGNoZXMKICAgICAgICByZXR1cm4gbWF0Y2hlcygoRXhwKSBleHBzLmZpbHRl\nciwgY2FuZGlkYXRlLCBjdHgsIHBhcmFtcywgMCk7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBSZWN1cnNpdmUgbWV0aG9kIHRvIGV2YWx1YXRlIHRoZSBleHBy\nZXNzaW9uIGZvciBhbGwgcG9zc2libGUKICAgICAqIGNvbWJpbmF0aW9ucyBv\nZiB1bmJvdW5kIHZhcmlhYmxlcy4gVGhpcyBtZXRob2Qgc2ltdWxhdGVzIGEg\nc2VxdWVuY2UKICAgICAqIG9mIGVtYmVkZGVkIHByb2NlZHVyYWwgbG9vcHMg\nb3ZlciB0aGUgZXh0ZW50cyBvZiBhbGwgdmFyaWFibGVzIGluIHRoZQogICAg\nICogdW5ib3VuZHMgbGlzdC4KICAgICAqLwogICAgcHJpdmF0ZSBib29sZWFu\nIG1hdGNoZXMoRXhwIGV4cCwgT2JqZWN0IGNhbmRpZGF0ZSwgU3RvcmVDb250\nZXh0IGN0eCwKICAgICAgICBPYmplY3RbXSBwYXJhbXMsIGludCBpKSB7CiAg\nICAgICAgLy8gYmFzZSBjYXNlOiBhbGwgdmFyaWFibGVzIGhhdmUgYmVlbiBh\nbGlhc2VkOyBldmFsdWF0ZSBmb3IgY3VycmVudAogICAgICAgIC8vIHZhbHVl\ncwogICAgICAgIGlmIChfdW5ib3VuZHMgPT0gbnVsbCB8fCBpID09IF91bmJv\ndW5kcy5zaXplKCkpCiAgICAgICAgICAgIHJldHVybiBleHAuZXZhbHVhdGUo\nY2FuZGlkYXRlLCBjYW5kaWRhdGUsIGN0eCwgcGFyYW1zKTsKCiAgICAgICAg\nLy8gZ3JhYiB0aGUgZXh0ZW50IGZvciB0aGlzIHZhcmlhYmxlCiAgICAgICAg\nVW5ib3VuZFZhcmlhYmxlIHZhciA9IChVbmJvdW5kVmFyaWFibGUpIF91bmJv\ndW5kcy5nZXQoaSk7CiAgICAgICAgSXRlcmF0b3IgaXRyID0gY3R4LmV4dGVu\ndEl0ZXJhdG9yKHZhci5nZXRUeXBlKCksIHRydWUsIG51bGwsIGZhbHNlKTsK\nICAgICAgICB0cnkgewogICAgICAgICAgICAvLyBpZiB0aGUgZXh0ZW50IHdh\ncyBlbXB0eSwgdGhlbiBhbGlhcyB0aGUgdmFyaWFibGUgdG8gbnVsbAogICAg\nICAgICAgICBpZiAoIWl0ci5oYXNOZXh0KCkpIHsKICAgICAgICAgICAgICAg\nIHZhci5zZXRWYWx1ZShudWxsKTsKICAgICAgICAgICAgICAgIHJldHVybiBt\nYXRjaGVzKGV4cCwgY2FuZGlkYXRlLCBjdHgsIHBhcmFtcywgaSArIDEpOwog\nICAgICAgICAgICB9CgogICAgICAgICAgICAvLyB0cnkgZXZlcnkgdmFsdWUs\nIHNob3J0LWNpcmN1aXRpbmcgb24gbWF0Y2gKICAgICAgICAgICAgd2hpbGUg\nKGl0ci5oYXNOZXh0KCkpIHsKICAgICAgICAgICAgICAgIC8vIHNldCB0aGUg\ndmFyaWFibGUgdG8gZWFjaCBleHRlbnQgdmFsdWUgYW5kIHJlY3Vyc2UKICAg\nICAgICAgICAgICAgIHZhci5zZXRWYWx1ZShpdHIubmV4dCgpKTsKICAgICAg\nICAgICAgICAgIGlmIChtYXRjaGVzKGV4cCwgY2FuZGlkYXRlLCBjdHgsIHBh\ncmFtcywgaSArIDEpKQogICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVl\nOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBubyBtYXRjaAogICAg\nICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfSBmaW5hbGx5IHsKICAg\nICAgICAgICAgSW1wbEhlbHBlci5jbG9zZShpdHIpOwogICAgICAgIH0KICAg\nIH0KCiAgICAvKioKICAgICAqIEdyb3VwIHRoZSBsaXN0IG9mIG1hdGNoZXMg\naW50byBhIGxpc3Qgb2YgbGlzdHMuCiAgICAgKi8KICAgIHB1YmxpYyBMaXN0\nIGdyb3VwKFF1ZXJ5RXhwcmVzc2lvbnMgZXhwcywgTGlzdCBtYXRjaGVzLAog\nICAgICAgIFN0b3JlQ29udGV4dCBjdHgsIE9iamVjdFtdIHBhcmFtcykgewog\nICAgICAgIGlmIChtYXRjaGVzID09IG51bGwgfHwgbWF0Y2hlcy5pc0VtcHR5\nKCkgfHwgZXhwcy5ncm91cGluZy5sZW5ndGggPT0gMCkKICAgICAgICAgICAg\ncmV0dXJuIG1hdGNoZXM7CgogICAgICAgIC8vIHRvIGZvcm0gZ3JvdXBzIHdl\nIGZpcnN0IG9yZGVyIG9uIHRoZSBncm91cGluZyBjcml0ZXJpYQogICAgICAg\nIG1hdGNoZXMgPSBvcmRlcihleHBzLCBleHBzLmdyb3VwaW5nLCBmYWxzZSwg\nbWF0Y2hlcywgY3R4LCBwYXJhbXMpOwoKICAgICAgICAvLyBub3cgd2UgY29t\nYmluZSBhbGwgcmVzdWx0cyB3aG9zZSB2YWx1ZXMgZm9yIGVhY2ggZ3JvdXBp\nbmcgY2xhdXNlCiAgICAgICAgLy8gYXJlIHRoZSBzYW1lLCByZWx5aW5nIG9u\nIHRoZSBmYWN0IHRoYXQgdGhlc2UgdmFsdWVzIHdpbGwgYWxyZWFkeSBiZQog\nICAgICAgIC8vIHRvZ2V0aGVyIGR1ZSB0byB0aGUgc29ydGluZwogICAgICAg\nIE9iamVjdFtdIHByZXZzID0gbmV3IE9iamVjdFtleHBzLmdyb3VwaW5nLmxl\nbmd0aF07CiAgICAgICAgQXJyYXlzLmZpbGwocHJldnMsIFVOSVFVRSk7CiAg\nICAgICAgT2JqZWN0W10gY3VycyA9IG5ldyBPYmplY3RbZXhwcy5ncm91cGlu\nZy5sZW5ndGhdOwogICAgICAgIExpc3QgZ3JvdXBlZCA9IG5ldyBBcnJheUxp\nc3QoKTsKICAgICAgICBMaXN0IGdyb3VwID0gbnVsbDsKICAgICAgICBPYmpl\nY3QgcGM7CiAgICAgICAgYm9vbGVhbiBlcTsKICAgICAgICBmb3IgKEl0ZXJh\ndG9yIGl0ciA9IG1hdGNoZXMuaXRlcmF0b3IoKTsgaXRyLmhhc05leHQoKTsp\nIHsKICAgICAgICAgICAgcGMgPSBpdHIubmV4dCgpOwogICAgICAgICAgICBl\ncSA9IHRydWU7CiAgICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgZXhw\ncy5ncm91cGluZy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgY3Vy\nc1tpXSA9ICgoVmFsKSBleHBzLmdyb3VwaW5nW2ldKS5ldmFsdWF0ZShwYywg\ncGMsIGN0eCwKICAgICAgICAgICAgICAgICAgICBwYXJhbXMpOwogICAgICAg\nICAgICAgICAgZXEgPSBlcSAmJiBPYmplY3RVdGlscy5lcXVhbHMocHJldnNb\naV0sIGN1cnNbaV0pOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBp\nZiB0aGlzIG9iamVjdCdzIGdyb3VwaW5nIHZhbHVlcyBkaWZmZXIgZnJvbSB0\naGUgcHJldiwKICAgICAgICAgICAgLy8gc3RhcnQgYSBuZXcgZ3JvdXAKICAg\nICAgICAgICAgaWYgKCFlcSkgewogICAgICAgICAgICAgICAgaWYgKGdyb3Vw\nICE9IG51bGwpCiAgICAgICAgICAgICAgICAgICAgZ3JvdXBlZC5hZGQoZ3Jv\ndXApOwogICAgICAgICAgICAgICAgZ3JvdXAgPSBuZXcgQXJyYXlMaXN0KCk7\nCiAgICAgICAgICAgIH0KICAgICAgICAgICAgZ3JvdXAuYWRkKHBjKTsKICAg\nICAgICAgICAgU3lzdGVtLmFycmF5Y29weShjdXJzLCAwLCBwcmV2cywgMCwg\nY3Vycy5sZW5ndGgpOwogICAgICAgIH0KICAgICAgICAvLyBhZGQgdGhlIGxh\nc3QgZ3JvdXAgZm9ybWVkCiAgICAgICAgaWYgKGdyb3VwICE9IG51bGwpCiAg\nICAgICAgICAgIGdyb3VwZWQuYWRkKGdyb3VwKTsKCiAgICAgICAgcmV0dXJu\nIGdyb3VwZWQ7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gdHJ1ZSBp\nZiB0aGUgZ2l2ZW4gZ3JvdXAgbWF0Y2hlcyB0aGUgaGF2aW5nIGV4cHJlc3Np\nb24uCiAgICAgKi8KICAgIHB1YmxpYyBib29sZWFuIG1hdGNoZXMoUXVlcnlF\neHByZXNzaW9ucyBleHBzLCBDb2xsZWN0aW9uIGdyb3VwLAogICAgICAgIFN0\nb3JlQ29udGV4dCBjdHgsIE9iamVjdFtdIHBhcmFtcykgewogICAgICAgIGlm\nIChncm91cCA9PSBudWxsIHx8IGdyb3VwLmlzRW1wdHkoKSkKICAgICAgICAg\nICAgcmV0dXJuIGZhbHNlOwogICAgICAgIGlmIChleHBzLmhhdmluZyA9PSBu\ndWxsKQogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKCiAgICAgICAgLy8gZXZh\nbHVhdGUgdGhlIGV4cHJlc3Npb24gZm9yIGFsbCBwb3NzaWJsZSBjb21iaW5h\ndGlvbnMgb2YgdmFsdWVzCiAgICAgICAgLy8gb2YgdGhlIHVuYm91bmQgdmFy\naWFibGVzOyB0aGUgZ3JvdXAgbWF0Y2hlcyBpZiBhbnkgY29tYmluYXRpb24K\nICAgICAgICAvLyBtYXRjaGVzCiAgICAgICAgcmV0dXJuIG1hdGNoZXMoKEV4\ncCkgZXhwcy5oYXZpbmcsIGdyb3VwLCBjdHgsIHBhcmFtcywgMCk7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBSZWN1cnNpdmUgbWV0aG9kIHRvIGV2YWx1YXRl\nIHRoZSBleHByZXNzaW9uIGZvciBhbGwgcG9zc2libGUKICAgICAqIGNvbWJp\nbmF0aW9ucyBvZiB1bmJvdW5kIHZhcmlhYmxlcy4gVGhpcyBtZXRob2Qgc2lt\ndWxhdGVzIGEgc2VxdWVuY2UKICAgICAqIG9mIGVtYmVkZGVkIHByb2NlZHVy\nYWwgbG9vcHMgb3ZlciB0aGUgZXh0ZW50cyBvZiBhbGwgdmFyaWFibGVzIGlu\nIHRoZQogICAgICogdW5ib3VuZHMgbGlzdC4KICAgICAqLwogICAgcHJpdmF0\nZSBib29sZWFuIG1hdGNoZXMoRXhwIGV4cCwgQ29sbGVjdGlvbiBncm91cCwg\nU3RvcmVDb250ZXh0IGN0eCwKICAgICAgICBPYmplY3RbXSBwYXJhbXMsIGlu\ndCBpKSB7CiAgICAgICAgLy8gYmFzZSBjYXNlOiBhbGwgdmFyaWFibGVzIGhh\ndmUgYmVlbiBhbGlhc2VkOyBldmFsdWF0ZSBmb3IgY3VycmVudAogICAgICAg\nIC8vIHZhbHVlcwogICAgICAgIGlmIChfdW5ib3VuZHMgPT0gbnVsbCB8fCBp\nID09IF91bmJvdW5kcy5zaXplKCkpCiAgICAgICAgICAgIHJldHVybiBleHAu\nZXZhbHVhdGUoZ3JvdXAsIGN0eCwgcGFyYW1zKTsKCiAgICAgICAgLy8gZ3Jh\nYiB0aGUgZXh0ZW50IGZvciB0aGlzIHZhcmlhYmxlCiAgICAgICAgVW5ib3Vu\nZFZhcmlhYmxlIHZhciA9IChVbmJvdW5kVmFyaWFibGUpIF91bmJvdW5kcy5n\nZXQoaSk7CiAgICAgICAgRXh0ZW50IGV4dGVudCA9IGN0eC5nZXRCcm9rZXIo\nKS5uZXdFeHRlbnQodmFyLmdldFR5cGUoKSwgdHJ1ZSk7CiAgICAgICAgSXRl\ncmF0b3IgaXRyID0gZXh0ZW50Lml0ZXJhdG9yKCk7CiAgICAgICAgdHJ5IHsK\nICAgICAgICAgICAgLy8gaWYgdGhlIGV4dGVudCB3YXMgZW1wdHksIHRoZW4g\nYWxpYXMgdGhlIHZhcmlhYmxlIHRvIG51bGwKICAgICAgICAgICAgaWYgKCFp\ndHIuaGFzTmV4dCgpKSB7CiAgICAgICAgICAgICAgICB2YXIuc2V0VmFsdWUo\nbnVsbCk7CiAgICAgICAgICAgICAgICByZXR1cm4gbWF0Y2hlcyhleHAsIGdy\nb3VwLCBjdHgsIHBhcmFtcywgaSArIDEpOwogICAgICAgICAgICB9CgogICAg\nICAgICAgICAvLyB0cnkgZXZlcnkgdmFsdWUsIHNob3J0LWNpcmN1aXRpbmcg\nb24gbWF0Y2gKICAgICAgICAgICAgd2hpbGUgKGl0ci5oYXNOZXh0KCkpIHsK\nICAgICAgICAgICAgICAgIC8vIHNldCB0aGUgdmFyaWFibGUgdG8gZWFjaCBl\neHRlbnQgdmFsdWUgYW5kIHJlY3Vyc2UKICAgICAgICAgICAgICAgIHZhci5z\nZXRWYWx1ZShpdHIubmV4dCgpKTsKICAgICAgICAgICAgICAgIGlmIChtYXRj\naGVzKGV4cCwgZ3JvdXAsIGN0eCwgcGFyYW1zLCBpICsgMSkpCiAgICAgICAg\nICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgIH0KCiAgICAg\nICAgICAgIC8vIG5vIG1hdGNoCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsK\nICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICBJbXBsSGVscGVyLmNs\nb3NlKGl0cik7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogQ3Jl\nYXRlIHRoZSBwcm9qZWN0aW9ucyBmb3IgdGhlIGdpdmVuIHJlc3VsdHMuCiAg\nICAgKi8KICAgIHB1YmxpYyBMaXN0IHByb2plY3QoUXVlcnlFeHByZXNzaW9u\ncyBleHBzLCBMaXN0IG1hdGNoZXMsCiAgICAgICAgU3RvcmVDb250ZXh0IGN0\neCwgT2JqZWN0W10gcGFyYW1zKSB7CiAgICAgICAgaWYgKGV4cHMucHJvamVj\ndGlvbnMubGVuZ3RoID09IDApCiAgICAgICAgICAgIHJldHVybiBtYXRjaGVz\nOwoKICAgICAgICAvLyBpZiBhbiB1bmdyb3VwZWQgYWdncmVnYXRlLCBldmFs\ndWF0ZSB0aGUgd2hvbGUgbWF0Y2hlcyBsaXN0CiAgICAgICAgaWYgKGV4cHMu\nZ3JvdXBpbmcubGVuZ3RoID09IDAgJiYgZXhwcy5pc0FnZ3JlZ2F0ZSgpKSB7\nCiAgICAgICAgICAgIE9iamVjdFtdIHByb2plY3Rpb24gPSBwcm9qZWN0KG1h\ndGNoZXMsIGV4cHMsIHRydWUsIGN0eCwgcGFyYW1zKTsKICAgICAgICAgICAg\ncmV0dXJuIEFycmF5cy5hc0xpc3QobmV3IE9iamVjdFtdeyBwcm9qZWN0aW9u\nIH0pOwogICAgICAgIH0KCiAgICAgICAgLy8gZXZhbHVhdGUgZWFjaCBjYW5k\naWRhdGUKICAgICAgICBMaXN0IHByb2plY3RlZCA9IG5ldyBBcnJheUxpc3Qo\nbWF0Y2hlcy5zaXplKCkpOwogICAgICAgIGZvciAoSXRlcmF0b3IgaXRyID0g\nbWF0Y2hlcy5pdGVyYXRvcigpOyBpdHIuaGFzTmV4dCgpOykKICAgICAgICAg\nICAgcHJvamVjdGVkLmFkZChwcm9qZWN0KGl0ci5uZXh0KCksIGV4cHMsIGV4\ncHMuZ3JvdXBpbmcubGVuZ3RoID4gMCwKICAgICAgICAgICAgICAgIGN0eCwg\ncGFyYW1zKSk7CiAgICAgICAgcmV0dXJuIHByb2plY3RlZDsKICAgIH0KCiAg\nICAvKioKICAgICAqIEdlbmVyYXRlIGEgcHJvamVjdGlvbiBvbiB0aGUgZ2l2\nZW4gY2FuZGlkYXRlLgogICAgICovCiAgICBwcml2YXRlIE9iamVjdFtdIHBy\nb2plY3QoT2JqZWN0IGNhbmRpZGF0ZSwgUXVlcnlFeHByZXNzaW9ucyBleHBz\nLAogICAgICAgIGJvb2xlYW4gYWdnLCBTdG9yZUNvbnRleHQgY3R4LCBPYmpl\nY3RbXSBwYXJhbXMpIHsKICAgICAgICBPYmplY3RbXSBwcm9qZWN0aW9uID0g\nbmV3IE9iamVjdFtleHBzLnByb2plY3Rpb25zLmxlbmd0aAogICAgICAgICAg\nICArIGV4cHMub3JkZXJpbmcubGVuZ3RoXTsKCiAgICAgICAgLy8gY2FsY3Vh\nbHRlIHJlc3VsdCB2YWx1ZXMKICAgICAgICBPYmplY3QgcmVzdWx0ID0gbnVs\nbDsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGV4cHMucHJvamVjdGlv\nbnMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgaWYgKGFnZykKICAgICAg\nICAgICAgICAgIHJlc3VsdCA9ICgoVmFsKSBleHBzLnByb2plY3Rpb25zW2ld\nKS5ldmFsdWF0ZSgoQ29sbGVjdGlvbikKICAgICAgICAgICAgICAgICAgICBj\nYW5kaWRhdGUsIG51bGwsIGN0eCwgcGFyYW1zKTsKICAgICAgICAgICAgZWxz\nZQogICAgICAgICAgICAgICAgcmVzdWx0ID0gKChWYWwpIGV4cHMucHJvamVj\ndGlvbnNbaV0pLmV2YWx1YXRlKGNhbmRpZGF0ZSwKICAgICAgICAgICAgICAg\nICAgICBjYW5kaWRhdGUsIGN0eCwgcGFyYW1zKTsKICAgICAgICAgICAgcHJv\namVjdGlvbltpXSA9IHJlc3VsdDsKICAgICAgICB9CgogICAgICAgIC8vIHRh\nY2sgb24gb3JkZXJpbmcgdmFsdWVzCiAgICAgICAgYm9vbGVhbiByZXBlYXQ7\nCiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBleHBzLm9yZGVyaW5nLmxl\nbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIC8vIGFscmVhZHkgc2VsZWN0ZWQg\nYXMgYSByZXN1bHQ/CiAgICAgICAgICAgIHJlcGVhdCA9IGZhbHNlOwogICAg\nICAgICAgICBmb3IgKGludCBqID0gMDsgIXJlcGVhdCAmJiBqIDwgZXhwcy5w\ncm9qZWN0aW9ucy5sZW5ndGg7IGorKykgewogICAgICAgICAgICAgICAgaWYg\nKGV4cHMub3JkZXJpbmdDbGF1c2VzW2ldLmVxdWFscyhleHBzLnByb2plY3Rp\nb25DbGF1c2VzW2pdKSkgewogICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9\nIHByb2plY3Rpb25bal07CiAgICAgICAgICAgICAgICAgICAgcmVwZWF0ID0g\ndHJ1ZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAg\nICAgICAgLy8gbm90IHNlbGVjdGVkIGFzIHJlc3VsdDsgY2FsY3VsYXRlIHZh\nbHVlCiAgICAgICAgICAgIGlmICghcmVwZWF0KSB7CiAgICAgICAgICAgICAg\nICBpZiAoYWdnKQogICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9ICgoVmFs\nKSBleHBzLm9yZGVyaW5nW2ldKS5ldmFsdWF0ZSgoQ29sbGVjdGlvbikKICAg\nICAgICAgICAgICAgICAgICAgICAgY2FuZGlkYXRlLCBudWxsLCBjdHgsIHBh\ncmFtcyk7CiAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAg\nICAgcmVzdWx0ID0gKChWYWwpIGV4cHMub3JkZXJpbmdbaV0pLmV2YWx1YXRl\nKGNhbmRpZGF0ZSwKICAgICAgICAgICAgICAgICAgICAgICAgY2FuZGlkYXRl\nLCBjdHgsIHBhcmFtcyk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHBy\nb2plY3Rpb25baSArIGV4cHMucHJvamVjdGlvbnMubGVuZ3RoXSA9IHJlc3Vs\ndDsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHByb2plY3Rpb247CiAgICB9\nCgogICAgLyoqCiAgICAgKiBPcmRlciB0aGUgZ2l2ZW4gbGlzdCBvZiBtYXRj\naGVzIG9uIHRoZSBnaXZlbiB2YWx1ZS4KICAgICAqLwogICAgcHVibGljIExp\nc3Qgb3JkZXIoUXVlcnlFeHByZXNzaW9ucyBleHBzLCBMaXN0IG1hdGNoZXMs\nCiAgICAgICAgU3RvcmVDb250ZXh0IGN0eCwgT2JqZWN0W10gcGFyYW1zKSB7\nCiAgICAgICAgcmV0dXJuIG9yZGVyKGV4cHMsIGV4cHMub3JkZXJpbmcsIHRy\ndWUsIG1hdGNoZXMsIGN0eCwgcGFyYW1zKTsKICAgIH0KCiAgICAvKioKICAg\nICAqIE9yZGVyIHRoZSBnaXZlbiBsaXN0IG9mIG1hdGNoZXMgb24gdGhlIGdp\ndmVuIHZhbHVlLgogICAgICoKICAgICAqIEBwYXJhbSBwcm9qZWN0ZWQgd2hl\ndGhlciBwcm9qZWN0aW9ucyBoYXZlIGJlZW4gYXBwbGllZCB0byB0aGUgbWF0\nY2hlcyB5ZXQKICAgICAqLwogICAgcHJpdmF0ZSBMaXN0IG9yZGVyKFF1ZXJ5\nRXhwcmVzc2lvbnMgZXhwcywgVmFsdWVbXSBvcmRlclZhbHVlcywKICAgICAg\nICBib29sZWFuIHByb2plY3RlZCwgTGlzdCBtYXRjaGVzLCBTdG9yZUNvbnRl\neHQgY3R4LCBPYmplY3RbXSBwYXJhbXMpIHsKICAgICAgICBpZiAobWF0Y2hl\ncyA9PSBudWxsIHx8IG1hdGNoZXMuaXNFbXB0eSgpCiAgICAgICAgICAgIHx8\nIG9yZGVyVmFsdWVzID09IG51bGwgfHwgb3JkZXJWYWx1ZXMubGVuZ3RoID09\nIDApCiAgICAgICAgICAgIHJldHVybiBtYXRjaGVzOwoKICAgICAgICBpbnQg\ncmVzdWx0cyA9IChwcm9qZWN0ZWQpID8gZXhwcy5wcm9qZWN0aW9ucy5sZW5n\ndGggOiAwOwogICAgICAgIGJvb2xlYW5bXSBhc2MgPSAocHJvamVjdGVkKSA/\nIGV4cHMuYXNjZW5kaW5nIDogbnVsbDsKICAgICAgICBpbnQgaWR4OwogICAg\nICAgIGZvciAoaW50IGkgPSBvcmRlclZhbHVlcy5sZW5ndGggLSAxOyBpID49\nIDA7IGktLSkgewogICAgICAgICAgICAvLyBpZiB0aGlzIGlzIGEgcHJvamVj\ndGlvbiwgdGhlbiBpbiBwcm9qZWN0KCkgd2UgbXVzdCBoYXZlIHNlbGVjdGVk\nCiAgICAgICAgICAgIC8vIHRoZSBvcmRlcmluZyB2YWx1ZSBhbHJlYWR5IGFm\ndGVyIHRoZSBwcm9qZWN0aW9uIHZhbHVlcwogICAgICAgICAgICBpZHggPSAo\ncmVzdWx0cyA+IDApID8gcmVzdWx0cyArIGkgOiAtMTsKICAgICAgICAgICAg\nQ29sbGVjdGlvbnMuc29ydChtYXRjaGVzLAogICAgICAgICAgICAgICAgbmV3\nIE9yZGVyVmFsdWVDb21wYXJhdG9yKChWYWwpIG9yZGVyVmFsdWVzW2ldLAog\nICAgICAgICAgICAgICAgICAgIGFzYyA9PSBudWxsIHx8IGFzY1tpXSwgaWR4\nLCBjdHgsIHBhcmFtcykpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gbWF0\nY2hlczsKICAgIH0KCiAgICAvKioKICAgICAqIEZpbHRlciB0aGUgZ2l2ZW4g\nbGlzdCBvZiBtYXRjaGVzLCByZW1vdmluZyBkdXBsaWNhdGUgZW50cmllcy4K\nICAgICAqLwogICAgcHVibGljIExpc3QgZGlzdGluY3QoUXVlcnlFeHByZXNz\naW9ucyBleHBzLCBib29sZWFuIGZyb21FeHRlbnQsCiAgICAgICAgTGlzdCBt\nYXRjaGVzKSB7CiAgICAgICAgaWYgKG1hdGNoZXMgPT0gbnVsbCB8fCBtYXRj\naGVzLmlzRW1wdHkoKSkKICAgICAgICAgICAgcmV0dXJuIG1hdGNoZXM7Cgog\nICAgICAgIC8vIG5vIG5lZWQgdG8gZG8gZGlzdGluY3QgaWYgbm90IGluc3Ry\ndWN0ZWQgdG8sIG9yIGlmIHRoZXNlIGFyZQogICAgICAgIC8vIGNhbmRpZGF0\nZSBvYmplY3RzIGZyb20gYW4gZXh0ZW50CiAgICAgICAgaW50IGxlbiA9IGV4\ncHMucHJvamVjdGlvbnMubGVuZ3RoOwogICAgICAgIGlmICgoZXhwcy5kaXN0\naW5jdCAmIGV4cHMuRElTVElOQ1RfVFJVRSkgPT0gMAogICAgICAgICAgICB8\nfCAoZnJvbUV4dGVudCAmJiBsZW4gPT0gMCkpCiAgICAgICAgICAgIHJldHVy\nbiBtYXRjaGVzOwoKICAgICAgICBTZXQgc2VlbiA9IG5ldyBIYXNoU2V0KG1h\ndGNoZXMuc2l6ZSgpKTsKICAgICAgICBMaXN0IGRpc3RpbmN0ID0gbnVsbDsK\nICAgICAgICBPYmplY3QgY3VyOwogICAgICAgIE9iamVjdCBrZXk7CiAgICAg\nICAgZm9yIChMaXN0SXRlcmF0b3IgbGkgPSBtYXRjaGVzLmxpc3RJdGVyYXRv\ncigpOyBsaS5oYXNOZXh0KCk7KSB7CiAgICAgICAgICAgIGN1ciA9IGxpLm5l\neHQoKTsKICAgICAgICAgICAga2V5ID0gKGxlbiA+IDAgJiYgY3VyICE9IG51\nbGwpID8gbmV3IEFycmF5S2V5KChPYmplY3RbXSkgY3VyKSA6IGN1cjsKCiAg\nICAgICAgICAgIGlmIChzZWVuLmFkZChrZXkpKSB7CiAgICAgICAgICAgICAg\nICAvLyBrZXkgaGFzbid0IGJlZW4gc2VlbiBiZWZvcmU7IGlmIHdlJ3ZlIGNy\nZWF0ZWQgYSBkaXN0aW5jdAogICAgICAgICAgICAgICAgLy8gbGlzdCwga2Vl\ncCBhZGRpbmcgdG8gaXQKICAgICAgICAgICAgICAgIGlmIChkaXN0aW5jdCAh\nPSBudWxsKQogICAgICAgICAgICAgICAgICAgIGRpc3RpbmN0LmFkZChjdXIp\nOwogICAgICAgICAgICB9IGVsc2UgaWYgKGRpc3RpbmN0ID09IG51bGwpIHsK\nICAgICAgICAgICAgICAgIC8vIHdlIG5lZWQgdG8gY29weSB0aGUgbWF0Y2hl\ncyBsaXN0IGJlY2F1c2UgdGhlIGRpc3RpbmN0IGxpc3QKICAgICAgICAgICAg\nICAgIC8vIHdpbGwgYmUgZGlmZmVyZW50ICh3ZSd2ZSBjb21lIGFjcm9zcyBh\nIG5vbi11bmlxdWUga2V5KTsgYWRkCiAgICAgICAgICAgICAgICAvLyBhbGwg\ndGhlIGVsZW1lbnRzIHdlJ3ZlIHNraXBwZWQgb3ZlciBzbyBmYXIKICAgICAg\nICAgICAgICAgIGRpc3RpbmN0ID0gbmV3IEFycmF5TGlzdChtYXRjaGVzLnNp\nemUoKSk7CiAgICAgICAgICAgICAgICBkaXN0aW5jdC5hZGRBbGwobWF0Y2hl\ncy5zdWJMaXN0KDAsIGxpLnByZXZpb3VzSW5kZXgoKSkpOwogICAgICAgICAg\nICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiAoZGlzdGluY3QgPT0gbnVs\nbCkgPyBtYXRjaGVzIDogZGlzdGluY3Q7CiAgICB9CgogICAgcHVibGljIEV4\ncHJlc3Npb24gZW1wdHlFeHByZXNzaW9uKCkgewogICAgICAgIHJldHVybiBu\nZXcgRXhwKCk7CiAgICB9CgogICAgcHVibGljIEV4cHJlc3Npb24gYXNFeHBy\nZXNzaW9uKFZhbHVlIHYpIHsKICAgICAgICByZXR1cm4gbmV3IFZhbEV4cHJl\nc3Npb24oKFZhbCkgdik7CiAgICB9CgogICAgcHVibGljIEV4cHJlc3Npb24g\nZXF1YWwoVmFsdWUgdjEsIFZhbHVlIHYyKSB7CiAgICAgICAgcmV0dXJuIG5l\ndyBFcXVhbEV4cHJlc3Npb24oKFZhbCkgdjEsIChWYWwpIHYyKTsKICAgIH0K\nCiAgICBwdWJsaWMgRXhwcmVzc2lvbiBub3RFcXVhbChWYWx1ZSB2MSwgVmFs\ndWUgdjIpIHsKICAgICAgICByZXR1cm4gbmV3IE5vdEVxdWFsRXhwcmVzc2lv\nbigoVmFsKSB2MSwgKFZhbCkgdjIpOwogICAgfQoKICAgIHB1YmxpYyBFeHBy\nZXNzaW9uIGxlc3NUaGFuKFZhbHVlIHYxLCBWYWx1ZSB2MikgewogICAgICAg\nIHJldHVybiBuZXcgTGVzc1RoYW5FeHByZXNzaW9uKChWYWwpIHYxLCAoVmFs\nKSB2Mik7CiAgICB9CgogICAgcHVibGljIEV4cHJlc3Npb24gZ3JlYXRlclRo\nYW4oVmFsdWUgdjEsIFZhbHVlIHYyKSB7CiAgICAgICAgcmV0dXJuIG5ldyBH\ncmVhdGVyVGhhbkV4cHJlc3Npb24oKFZhbCkgdjEsIChWYWwpIHYyKTsKICAg\nIH0KCiAgICBwdWJsaWMgRXhwcmVzc2lvbiBsZXNzVGhhbkVxdWFsKFZhbHVl\nIHYxLCBWYWx1ZSB2MikgewogICAgICAgIHJldHVybiBuZXcgTGVzc1RoYW5F\ncXVhbEV4cHJlc3Npb24oKFZhbCkgdjEsIChWYWwpIHYyKTsKICAgIH0KCiAg\nICBwdWJsaWMgRXhwcmVzc2lvbiBncmVhdGVyVGhhbkVxdWFsKFZhbHVlIHYx\nLCBWYWx1ZSB2MikgewogICAgICAgIHJldHVybiBuZXcgR3JlYXRlclRoYW5F\ncXVhbEV4cHJlc3Npb24oKFZhbCkgdjEsIChWYWwpIHYyKTsKICAgIH0KCiAg\nICBwdWJsaWMgRXhwcmVzc2lvbiBpc0VtcHR5KFZhbHVlIHYxKSB7CiAgICAg\nICAgcmV0dXJuIG5ldyBJc0VtcHR5RXhwcmVzc2lvbigoVmFsKSB2MSk7CiAg\nICB9CgogICAgcHVibGljIEV4cHJlc3Npb24gaXNOb3RFbXB0eShWYWx1ZSB2\nMSkgewogICAgICAgIHJldHVybiBub3QoaXNFbXB0eSh2MSkpOwogICAgfQoK\nICAgIHB1YmxpYyBFeHByZXNzaW9uIGNvbnRhaW5zKFZhbHVlIHYxLCBWYWx1\nZSB2MikgewogICAgICAgIHJldHVybiBuZXcgQ29udGFpbnNFeHByZXNzaW9u\nKChWYWwpIHYxLCAoVmFsKSB2Mik7CiAgICB9CgogICAgcHVibGljIEV4cHJl\nc3Npb24gY29udGFpbnNLZXkoVmFsdWUgdjEsIFZhbHVlIHYyKSB7CiAgICAg\nICAgcmV0dXJuIG5ldyBDb250YWluc0tleUV4cHJlc3Npb24oKFZhbCkgdjEs\nIChWYWwpIHYyKTsKICAgIH0KCiAgICBwdWJsaWMgRXhwcmVzc2lvbiBjb250\nYWluc1ZhbHVlKFZhbHVlIHYxLCBWYWx1ZSB2MikgewogICAgICAgIHJldHVy\nbiBuZXcgQ29udGFpbnNWYWx1ZUV4cHJlc3Npb24oKFZhbCkgdjEsIChWYWwp\nIHYyKTsKICAgIH0KCiAgICBwdWJsaWMgVmFsdWUgZ2V0TWFwVmFsdWUoVmFs\ndWUgbWFwLCBWYWx1ZSBhcmcpIHsKICAgICAgICByZXR1cm4gbmV3IEdldE1h\ncFZhbHVlKChWYWwpIG1hcCwgKFZhbCkgYXJnKTsKICAgIH0KCiAgICBwdWJs\naWMgRXhwcmVzc2lvbiBpc0luc3RhbmNlKFZhbHVlIHYxLCBDbGFzcyBjKSB7\nCiAgICAgICAgcmV0dXJuIG5ldyBJbnN0YW5jZW9mRXhwcmVzc2lvbigoVmFs\nKSB2MSwgYyk7CiAgICB9CgogICAgcHVibGljIEV4cHJlc3Npb24gYW5kKEV4\ncHJlc3Npb24gZXhwMSwgRXhwcmVzc2lvbiBleHAyKSB7CiAgICAgICAgaWYg\nKGV4cDEgaW5zdGFuY2VvZiBCaW5kVmFyaWFibGVFeHByZXNzaW9uKQogICAg\nICAgICAgICByZXR1cm4gbmV3IEJpbmRWYXJpYWJsZUFuZEV4cHJlc3Npb24o\nKEJpbmRWYXJpYWJsZUV4cHJlc3Npb24pIGV4cDEsCiAgICAgICAgICAgICAg\nICAoRXhwKSBleHAyKTsKICAgICAgICByZXR1cm4gbmV3IEFuZEV4cHJlc3Np\nb24oKEV4cCkgZXhwMSwgKEV4cCkgZXhwMik7CiAgICB9CgogICAgcHVibGlj\nIEV4cHJlc3Npb24gb3IoRXhwcmVzc2lvbiBleHAxLCBFeHByZXNzaW9uIGV4\ncDIpIHsKICAgICAgICByZXR1cm4gbmV3IE9yRXhwcmVzc2lvbigoRXhwKSBl\neHAxLCAoRXhwKSBleHAyKTsKICAgIH0KCiAgICBwdWJsaWMgRXhwcmVzc2lv\nbiBub3QoRXhwcmVzc2lvbiBleHApIHsKICAgICAgICByZXR1cm4gbmV3IE5v\ndEV4cHJlc3Npb24oKEV4cCkgZXhwKTsKICAgIH0KCiAgICBwdWJsaWMgRXhw\ncmVzc2lvbiBiaW5kVmFyaWFibGUoVmFsdWUgdmFyLCBWYWx1ZSB2YWwpIHsK\nICAgICAgICByZXR1cm4gbmV3IEJpbmRWYXJpYWJsZUV4cHJlc3Npb24oKEJv\ndW5kVmFyaWFibGUpIHZhciwgKFZhbCkgdmFsKTsKICAgIH0KCiAgICBwdWJs\naWMgRXhwcmVzc2lvbiBiaW5kS2V5VmFyaWFibGUoVmFsdWUgdmFyLCBWYWx1\nZSB2YWwpIHsKICAgICAgICByZXR1cm4gbmV3IEJpbmRLZXlWYXJpYWJsZUV4\ncHJlc3Npb24oKEJvdW5kVmFyaWFibGUpIHZhciwgKFZhbCkgdmFsKTsKICAg\nIH0KCiAgICBwdWJsaWMgRXhwcmVzc2lvbiBiaW5kVmFsdWVWYXJpYWJsZShW\nYWx1ZSB2YXIsIFZhbHVlIHZhbCkgewogICAgICAgIHJldHVybiBuZXcgQmlu\nZFZhbHVlVmFyaWFibGVFeHByZXNzaW9uKChCb3VuZFZhcmlhYmxlKSB2YXIs\nIChWYWwpIHZhbCk7CiAgICB9CgogICAgcHVibGljIEV4cHJlc3Npb24gZW5k\nc1dpdGgoVmFsdWUgdjEsIFZhbHVlIHYyKSB7CiAgICAgICAgcmV0dXJuIG5l\ndyBFbmRzV2l0aEV4cHJlc3Npb24oKFZhbCkgdjEsIChWYWwpIHYyKTsKICAg\nIH0KCiAgICBwdWJsaWMgRXhwcmVzc2lvbiBtYXRjaGVzKFZhbHVlIHYxLCBW\nYWx1ZSB2MiwKICAgICAgICBTdHJpbmcgc2luZ2xlLCBTdHJpbmcgbXVsdGks\nIFN0cmluZyBlc2MpIHsKICAgICAgICByZXR1cm4gbmV3IE1hdGNoZXNFeHBy\nZXNzaW9uKChWYWwpIHYxLCAoVmFsKSB2Miwgc2luZ2xlLCBtdWx0aSwgZXNj\nLAogICAgICAgICAgICB0cnVlKTsKICAgIH0KCiAgICBwdWJsaWMgRXhwcmVz\nc2lvbiBub3RNYXRjaGVzKFZhbHVlIHYxLCBWYWx1ZSB2MiwKICAgICAgICBT\ndHJpbmcgc2luZ2xlLCBTdHJpbmcgbXVsdGksIFN0cmluZyBlc2MpIHsKICAg\nICAgICByZXR1cm4gbmV3IE1hdGNoZXNFeHByZXNzaW9uKChWYWwpIHYxLCAo\nVmFsKSB2Miwgc2luZ2xlLCBtdWx0aSwgZXNjLAogICAgICAgICAgICBmYWxz\nZSk7CiAgICB9CgogICAgcHVibGljIEV4cHJlc3Npb24gc3RhcnRzV2l0aChW\nYWx1ZSB2MSwgVmFsdWUgdjIpIHsKICAgICAgICByZXR1cm4gbmV3IFN0YXJ0\nc1dpdGhFeHByZXNzaW9uKChWYWwpIHYxLCAoVmFsKSB2Mik7CiAgICB9Cgog\nICAgcHVibGljIFN1YnF1ZXJ5IG5ld1N1YnF1ZXJ5KENsYXNzTWV0YURhdGEg\nY2FuZGlkYXRlLCBib29sZWFuIHN1YnMsCiAgICAgICAgU3RyaW5nIGFsaWFz\nKSB7CiAgICAgICAgcmV0dXJuIG5ldyBTdWJRKGFsaWFzKTsKICAgIH0KCiAg\nICBwdWJsaWMgUGF0aCBuZXdQYXRoKCkgewogICAgICAgIHJldHVybiBuZXcg\nQ2FuZGlkYXRlUGF0aCgpOwogICAgfQoKICAgIHB1YmxpYyBQYXRoIG5ld1Bh\ndGgoVmFsdWUgdmFsKSB7CiAgICAgICAgcmV0dXJuIG5ldyBWYWx1ZVBhdGgo\nKFZhbCkgdmFsKTsKICAgIH0KCiAgICBwdWJsaWMgTGl0ZXJhbCBuZXdMaXRl\ncmFsKE9iamVjdCB2YWwsIGludCBwYXJzZVR5cGUpIHsKICAgICAgICByZXR1\ncm4gbmV3IExpdCh2YWwsIHBhcnNlVHlwZSk7CiAgICB9CgogICAgcHVibGlj\nIExpdGVyYWwgbmV3VHlwZUxpdGVyYWwoT2JqZWN0IHZhbCwgaW50IHBhcnNl\nVHlwZSkgewogICAgICAgIHJldHVybiBuZXcgVHlwZUxpdCh2YWwsIHBhcnNl\nVHlwZSk7CiAgICB9CgogICAgcHVibGljIFZhbHVlIGdldFRoaXMoKSB7CiAg\nICAgICAgcmV0dXJuIG5ldyBUaGlzKCk7CiAgICB9CgogICAgcHVibGljIFZh\nbHVlIGdldE51bGwoKSB7CiAgICAgICAgcmV0dXJuIE5VTEw7CiAgICB9Cgog\nICAgcHVibGljIDxUIGV4dGVuZHMgRGF0ZT4gVmFsdWUgZ2V0Q3VycmVudERh\ndGUoQ2xhc3M8VD4gZGF0ZVR5cGUpIHsKICAgICAgICByZXR1cm4gbmV3IEN1\ncnJlbnREYXRlKGRhdGVUeXBlKTsKICAgIH0KCiAgICBwdWJsaWMgIDxUIGV4\ndGVuZHMgRGF0ZT4gVmFsdWUgZ2V0Q3VycmVudFRpbWUoQ2xhc3M8VD4gZGF0\nZVR5cGUpIHsKICAgICAgICByZXR1cm4gbmV3IEN1cnJlbnREYXRlKGRhdGVU\neXBlKTsKICAgIH0KCiAgICBwdWJsaWMgPFQgZXh0ZW5kcyBEYXRlPiBWYWx1\nZSBnZXRDdXJyZW50VGltZXN0YW1wKENsYXNzPFQ+IGRhdGVUeXBlKSB7CiAg\nICAgICAgcmV0dXJuIG5ldyBDdXJyZW50RGF0ZShkYXRlVHlwZSk7CiAgICB9\nCgogICAgcHVibGljIFBhcmFtZXRlciBuZXdQYXJhbWV0ZXIoT2JqZWN0IG5h\nbWUsIENsYXNzIHR5cGUpIHsKICAgICAgICByZXR1cm4gbmV3IFBhcmFtKG5h\nbWUsIHR5cGUpOwogICAgfQoKICAgIHB1YmxpYyBQYXJhbWV0ZXIgbmV3Q29s\nbGVjdGlvblZhbHVlZFBhcmFtZXRlcihPYmplY3QgbmFtZSwgQ2xhc3MgdHlw\nZSkgewogICAgICAgIHJldHVybiBuZXcgQ29sbGVjdGlvblBhcmFtKG5hbWUs\nIHR5cGUpOwogICAgfQoKICAgIHB1YmxpYyBWYWx1ZSBuZXdFeHRlbnNpb24o\nRmlsdGVyTGlzdGVuZXIgbGlzdGVuZXIsIFZhbHVlIHRhcmdldCwKICAgICAg\nICBWYWx1ZSBhcmcpIHsKICAgICAgICByZXR1cm4gbmV3IEV4dGVuc2lvbihs\naXN0ZW5lciwgKFZhbCkgdGFyZ2V0LCAoVmFsKSBhcmcpOwogICAgfQoKICAg\nIHB1YmxpYyBWYWx1ZSBuZXdBZ2dyZWdhdGUoQWdncmVnYXRlTGlzdGVuZXIg\nbGlzdGVuZXIsIFZhbHVlIGFyZykgewogICAgICAgIHJldHVybiBuZXcgQWdn\ncmVnYXRlKGxpc3RlbmVyLCAoVmFsKSBhcmcpOwogICAgfQoKICAgIHB1Ymxp\nYyBBcmd1bWVudHMgbmV3QXJndW1lbnRMaXN0KFZhbHVlIHZhbDEsIFZhbHVl\nIHZhbDIpIHsKICAgICAgICByZXR1cm4gbmV3IEFyZ3ModmFsMSwgdmFsMik7\nCiAgICB9CiAgICAKICAgIHB1YmxpYyBBcmd1bWVudHMgbmV3QXJndW1lbnRM\naXN0KFZhbHVlLi4uIHZhbHVlcykgewogICAgICAgIHJldHVybiBuZXcgQXJn\ncyh2YWx1ZXMpOwogICAgfQoKICAgIHB1YmxpYyBWYWx1ZSBuZXdVbmJvdW5k\nVmFyaWFibGUoU3RyaW5nIG5hbWUsIENsYXNzIHR5cGUpIHsKICAgICAgICBV\nbmJvdW5kVmFyaWFibGUgdmFyID0gbmV3IFVuYm91bmRWYXJpYWJsZSh0eXBl\nKTsKICAgICAgICBpZiAoX3VuYm91bmRzID09IG51bGwpCiAgICAgICAgICAg\nIF91bmJvdW5kcyA9IG5ldyBBcnJheUxpc3QoMyk7CiAgICAgICAgX3VuYm91\nbmRzLmFkZCh2YXIpOwogICAgICAgIHJldHVybiB2YXI7CiAgICB9CgogICAg\ncHVibGljIFZhbHVlIG5ld0JvdW5kVmFyaWFibGUoU3RyaW5nIG5hbWUsIENs\nYXNzIHR5cGUpIHsKICAgICAgICByZXR1cm4gbmV3IEJvdW5kVmFyaWFibGUo\ndHlwZSk7CiAgICB9CgogICAgcHVibGljIFZhbHVlIGNhc3QoVmFsdWUgdmFs\nLCBDbGFzcyBjbHMpIHsKICAgICAgICBpZiAodmFsIGluc3RhbmNlb2YgQ2Fu\nZGlkYXRlUGF0aCkKICAgICAgICAgICAgKChDYW5kaWRhdGVQYXRoKSB2YWwp\nLmNhc3RUbyhjbHMpOwogICAgICAgIGVsc2UgaWYgKHZhbCBpbnN0YW5jZW9m\nIEJvdW5kVmFyaWFibGUpCiAgICAgICAgICAgICgoQm91bmRWYXJpYWJsZSkg\ndmFsKS5jYXN0VG8oY2xzKTsKICAgICAgICBlbHNlCiAgICAgICAgICAgIHZh\nbCA9IG5ldyBDYXN0KChWYWwpIHZhbCwgY2xzKTsKICAgICAgICByZXR1cm4g\ndmFsOwogICAgfQoKICAgIHB1YmxpYyBWYWx1ZSBhZGQoVmFsdWUgdmFsMSwg\nVmFsdWUgdmFsMikgewogICAgICAgIHJldHVybiBuZXcgQWRkKChWYWwpIHZh\nbDEsIChWYWwpIHZhbDIpOwogICAgfQoKICAgIHB1YmxpYyBWYWx1ZSBzdWJ0\ncmFjdChWYWx1ZSB2YWwxLCBWYWx1ZSB2YWwyKSB7CiAgICAgICAgcmV0dXJu\nIG5ldyBTdWJ0cmFjdCgoVmFsKSB2YWwxLCAoVmFsKSB2YWwyKTsKICAgIH0K\nCiAgICBwdWJsaWMgVmFsdWUgbXVsdGlwbHkoVmFsdWUgdmFsMSwgVmFsdWUg\ndmFsMikgewogICAgICAgIHJldHVybiBuZXcgTXVsdGlwbHkoKFZhbCkgdmFs\nMSwgKFZhbCkgdmFsMik7CiAgICB9CgogICAgcHVibGljIFZhbHVlIGRpdmlk\nZShWYWx1ZSB2YWwxLCBWYWx1ZSB2YWwyKSB7CiAgICAgICAgcmV0dXJuIG5l\ndyBEaXZpZGUoKFZhbCkgdmFsMSwgKFZhbCkgdmFsMik7CiAgICB9CgogICAg\ncHVibGljIFZhbHVlIG1vZChWYWx1ZSB2YWwxLCBWYWx1ZSB2YWwyKSB7CiAg\nICAgICAgcmV0dXJuIG5ldyBNb2QoKFZhbCkgdmFsMSwgKFZhbCkgdmFsMik7\nCiAgICB9CgogICAgcHVibGljIFZhbHVlIGFicyhWYWx1ZSB2YWwpIHsKICAg\nICAgICByZXR1cm4gbmV3IEFicygoVmFsKSB2YWwpOwogICAgfQoKICAgIHB1\nYmxpYyBWYWx1ZSBpbmRleE9mKFZhbHVlIHZhbDEsIFZhbHVlIHZhbDIpIHsK\nICAgICAgICByZXR1cm4gbmV3IEluZGV4T2YoKFZhbCkgdmFsMSwgKFZhbCkg\ndmFsMik7CiAgICB9CgogICAgcHVibGljIFZhbHVlIGNvbmNhdChWYWx1ZSB2\nYWwxLCBWYWx1ZSB2YWwyKSB7CiAgICAgICAgcmV0dXJuIG5ldyBDb25jYXQo\nKFZhbCkgdmFsMSwgKFZhbCkgdmFsMik7CiAgICB9CgogICAgcHVibGljIFZh\nbHVlIHN0cmluZ0xlbmd0aChWYWx1ZSBzdHIpIHsKICAgICAgICByZXR1cm4g\nbmV3IFN0cmluZ0xlbmd0aCgoVmFsKSBzdHIpOwogICAgfQoKICAgIHB1Ymxp\nYyBWYWx1ZSB0cmltKFZhbHVlIHN0ciwgVmFsdWUgdHJpbUNoYXIsIEJvb2xl\nYW4gd2hlcmUpIHsKICAgICAgICByZXR1cm4gbmV3IFRyaW0oKFZhbCkgc3Ry\nLCAoVmFsKSB0cmltQ2hhciwgd2hlcmUpOwogICAgfQoKICAgIHB1YmxpYyBW\nYWx1ZSBzcXJ0KFZhbHVlIHZhbCkgewogICAgICAgIHJldHVybiBuZXcgU3Fy\ndCgoVmFsKSB2YWwpOwogICAgfQoKICAgIHB1YmxpYyBWYWx1ZSBzdWJzdHJp\nbmcoVmFsdWUgdmFsMSwgVmFsdWUgdmFsMikgewogICAgICAgIHJldHVybiBu\nZXcgU3Vic3RyaW5nKChWYWwpIHZhbDEsIChWYWwpIHZhbDIpOwogICAgfQoK\nICAgIHB1YmxpYyBWYWx1ZSB0b1VwcGVyQ2FzZShWYWx1ZSB2YWwpIHsKICAg\nICAgICByZXR1cm4gbmV3IFRvVXBwZXJDYXNlKChWYWwpIHZhbCk7CiAgICB9\nCgogICAgcHVibGljIFZhbHVlIHRvTG93ZXJDYXNlKFZhbHVlIHZhbCkgewog\nICAgICAgIHJldHVybiBuZXcgVG9Mb3dlckNhc2UoKFZhbCkgdmFsKTsKICAg\nIH0KCiAgICBwdWJsaWMgVmFsdWUgYXZnKFZhbHVlIHZhbCkgewogICAgICAg\nIHJldHVybiBuZXcgQXZnKChWYWwpIHZhbCk7CiAgICB9CgogICAgcHVibGlj\nIFZhbHVlIGNvdW50KFZhbHVlIHZhbCkgewogICAgICAgIHJldHVybiBuZXcg\nQ291bnQoKFZhbCkgdmFsKTsKICAgIH0KCiAgICBwdWJsaWMgVmFsdWUgZGlz\ndGluY3QoVmFsdWUgdmFsKSB7CiAgICAgICAgcmV0dXJuIG5ldyBEaXN0aW5j\ndCgoVmFsKSB2YWwpOwogICAgfQoKICAgIHB1YmxpYyBWYWx1ZSBtYXgoVmFs\ndWUgdmFsKSB7CiAgICAgICAgcmV0dXJuIG5ldyBNYXgoKFZhbCkgdmFsKTsK\nICAgIH0KCiAgICBwdWJsaWMgVmFsdWUgbWluKFZhbHVlIHZhbCkgewogICAg\nICAgIHJldHVybiBuZXcgTWluKChWYWwpIHZhbCk7CiAgICB9CgogICAgcHVi\nbGljIFZhbHVlIHN1bShWYWx1ZSB2YWwpIHsKICAgICAgICByZXR1cm4gbmV3\nIFN1bSgoVmFsKSB2YWwpOwogICAgfQoKICAgIHB1YmxpYyBWYWx1ZSBhbnko\nVmFsdWUgdmFsKSB7CiAgICAgICAgcmV0dXJuIG5ldyBBbnkoKFZhbCkgdmFs\nKTsKICAgIH0KCiAgICBwdWJsaWMgVmFsdWUgYWxsKFZhbHVlIHZhbCkgewog\nICAgICAgIHJldHVybiBuZXcgQWxsKChWYWwpIHZhbCk7CiAgICB9CgogICAg\ncHVibGljIFZhbHVlIHNpemUoVmFsdWUgdmFsKSB7CiAgICAgICAgcmV0dXJu\nIG5ldyBTaXplKChWYWwpIHZhbCk7CiAgICB9CgogICAgcHVibGljIFZhbHVl\nIGluZGV4KFZhbHVlIHZhbCkgewogICAgICAgIHJldHVybiBuZXcgSW5kZXgo\nKFZhbCkgdmFsKTsKICAgIH0KCiAgICBwdWJsaWMgVmFsdWUgdHlwZShWYWx1\nZSB2YWwpIHsKICAgICAgICByZXR1cm4gbmV3IFR5cGUoKFZhbCkgdmFsKTsK\nICAgIH0KCiAgICBwdWJsaWMgVmFsdWUgbWFwRW50cnkoVmFsdWUga2V5LCBW\nYWx1ZSB2YWwpIHsKICAgICAgICB0aHJvdyBuZXcgVW5zdXBwb3J0ZWRFeGNl\ncHRpb24oIm5vdCBpbXBsZW1lbnRlZCB5ZXQiKTsKICAgIH0KCiAgICBwdWJs\naWMgVmFsdWUgbWFwS2V5KFZhbHVlIGtleSwgVmFsdWUgdmFsKSB7CiAgICAg\nICAgdGhyb3cgbmV3IFVuc3VwcG9ydGVkRXhjZXB0aW9uKCJub3QgaW1wbGVt\nZW50ZWQgeWV0Iik7CiAgICB9CgogICAgcHVibGljIFZhbHVlIGdldEtleShW\nYWx1ZSB2YWwpIHsKICAgICAgICB0aHJvdyBuZXcgVW5zdXBwb3J0ZWRFeGNl\ncHRpb24oIm5vdCBpbXBsZW1lbnRlZCB5ZXQiKTsKICAgIH0KICAgIAogICAg\ncHVibGljIFZhbHVlIGdldE9iamVjdElkKFZhbHVlIHZhbCkgewogICAgICAg\nIHJldHVybiBuZXcgR2V0T2JqZWN0SWQoKFZhbCkgdmFsKTsKICAgIH0KCiAg\nICAvKioKICAgICAqIEtleSB0aGF0IGltcGxlbWVudHMgaGFzaENvZGUgYW5k\nIGVxdWFscyBtZXRob2RzIGZvciBvYmplY3QgYXJyYXlzLgogICAgICovCiAg\nICBwcml2YXRlIHN0YXRpYyBjbGFzcyBBcnJheUtleSB7CgogICAgICAgIHBy\naXZhdGUgZmluYWwgT2JqZWN0W10gX2FycjsKCiAgICAgICAgcHVibGljIEFy\ncmF5S2V5KE9iamVjdFtdIGFycikgewogICAgICAgICAgICBfYXJyID0gYXJy\nOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIGludCBoYXNoQ29kZSgpIHsK\nICAgICAgICAgICAgaW50IHJzID0gMTc7CiAgICAgICAgICAgIGZvciAoaW50\nIGkgPSAwOyBpIDwgX2Fyci5sZW5ndGg7IGkrKykKICAgICAgICAgICAgICAg\nIHJzID0gMzcgKiBycyArICgoX2FycltpXSA9PSBudWxsKSA/IDAgOiBfYXJy\nW2ldLmhhc2hDb2RlKCkpOwogICAgICAgICAgICByZXR1cm4gcnM7CiAgICAg\nICAgfQoKICAgICAgICBwdWJsaWMgYm9vbGVhbiBlcXVhbHMoT2JqZWN0IG90\naGVyKSB7CiAgICAgICAgICAgIGlmIChvdGhlciA9PSB0aGlzKQogICAgICAg\nICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgIGlmIChvdGhlciA9\nPSBudWxsKQogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoKICAgICAg\nICAgICAgT2JqZWN0W10gYXJyID0gKChBcnJheUtleSkgb3RoZXIpLl9hcnI7\nCiAgICAgICAgICAgIGlmIChfYXJyLmxlbmd0aCAhPSBhcnIubGVuZ3RoKQog\nICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICBmb3Ig\nKGludCBpID0gMDsgaSA8IF9hcnIubGVuZ3RoOyBpKyspCiAgICAgICAgICAg\nICAgICBpZiAoIU9iamVjdFV0aWxzLmVxdWFscyhfYXJyW2ldLCBhcnJbaV0p\nKQogICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAg\nICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAg\nICogQ29tcGFyYXRvciB0aGF0IHVzZXMgdGhlIHJlc3VsdCBvZiBldmFsJ2lu\nZyBhIFZhbHVlIHRvIHNvcnQgb24uIE51bGwKICAgICAqIHZhbHVlcyBhcmUg\ncGxhY2VkIGxhc3QgaWYgc29ydGluZyBpbiBhc2NlbmRpbmcgb3JkZXIsIGZp\ncnN0IGlmCiAgICAgKiBkZXNjZW5kaW5nLgogICAgICovCiAgICBwcml2YXRl\nIHN0YXRpYyBjbGFzcyBPcmRlclZhbHVlQ29tcGFyYXRvcgogICAgICAgIGlt\ncGxlbWVudHMgQ29tcGFyYXRvciB7CgogICAgICAgIHByaXZhdGUgZmluYWwg\nU3RvcmVDb250ZXh0IF9jdHg7CiAgICAgICAgcHJpdmF0ZSBmaW5hbCBWYWwg\nX3ZhbDsKICAgICAgICBwcml2YXRlIGZpbmFsIGJvb2xlYW4gX2FzYzsKICAg\nICAgICBwcml2YXRlIGZpbmFsIGludCBfaWR4OwogICAgICAgIHByaXZhdGUg\nZmluYWwgT2JqZWN0W10gX3BhcmFtczsKCiAgICAgICAgcHJpdmF0ZSBPcmRl\nclZhbHVlQ29tcGFyYXRvcihWYWwgdmFsLCBib29sZWFuIGFzYywgaW50IGlk\neCwKICAgICAgICAgICAgU3RvcmVDb250ZXh0IGN0eCwgT2JqZWN0W10gcGFy\nYW1zKSB7CiAgICAgICAgICAgIF9jdHggPSBjdHg7CiAgICAgICAgICAgIF92\nYWwgPSB2YWw7CiAgICAgICAgICAgIF9hc2MgPSBhc2M7CiAgICAgICAgICAg\nIF9pZHggPSBpZHg7CiAgICAgICAgICAgIF9wYXJhbXMgPSBwYXJhbXM7CiAg\nICAgICAgfQoKICAgICAgICBwdWJsaWMgaW50IGNvbXBhcmUoT2JqZWN0IG8x\nLCBPYmplY3QgbzIpIHsKICAgICAgICAgICAgaWYgKF9pZHggIT0gLTEpIHsK\nICAgICAgICAgICAgICAgIG8xID0gKChPYmplY3RbXSkgbzEpW19pZHhdOwog\nICAgICAgICAgICAgICAgbzIgPSAoKE9iamVjdFtdKSBvMilbX2lkeF07CiAg\nICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBvMSA9IF92YWwu\nZXZhbHVhdGUobzEsIG8xLCBfY3R4LCBfcGFyYW1zKTsKICAgICAgICAgICAg\nICAgIG8yID0gX3ZhbC5ldmFsdWF0ZShvMiwgbzIsIF9jdHgsIF9wYXJhbXMp\nOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAobzEgPT0gbnVsbCAm\nJiBvMiA9PSBudWxsKQogICAgICAgICAgICAgICAgcmV0dXJuIDA7CiAgICAg\nICAgICAgIGlmIChvMSA9PSBudWxsKQogICAgICAgICAgICAgICAgcmV0dXJu\nIChfYXNjKSA/IDEgOiAtMTsKICAgICAgICAgICAgaWYgKG8yID09IG51bGwp\nCiAgICAgICAgICAgICAgICByZXR1cm4gKF9hc2MpID8gLTEgOiAxOwoKICAg\nICAgICAgICAgaWYgKG8xIGluc3RhbmNlb2YgQm9vbGVhbiAmJiBvMiBpbnN0\nYW5jZW9mIEJvb2xlYW4pIHsKICAgICAgICAgICAgICAgIGludCBpMSA9ICgo\nQm9vbGVhbikgbzEpLmJvb2xlYW5WYWx1ZSgpID8gMSA6IDA7CiAgICAgICAg\nICAgICAgICBpbnQgaTIgPSAoKEJvb2xlYW4pIG8yKS5ib29sZWFuVmFsdWUo\nKSA/IDEgOiAwOwogICAgICAgICAgICAgICAgcmV0dXJuIGkxIC0gaTI7CiAg\nICAgICAgICAgIH0KCiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAg\nICBpZiAoX2FzYykKICAgICAgICAgICAgICAgICAgICByZXR1cm4gKChDb21w\nYXJhYmxlKSBvMSkuY29tcGFyZVRvKG8yKTsKICAgICAgICAgICAgICAgIHJl\ndHVybiAoKENvbXBhcmFibGUpIG8yKS5jb21wYXJlVG8obzEpOwogICAgICAg\nICAgICB9IGNhdGNoIChDbGFzc0Nhc3RFeGNlcHRpb24gY2NlKSB7CiAgICAg\nICAgICAgICAgICBMb2NhbGl6ZXIgbG9jID0gTG9jYWxpemVyLmZvclBhY2th\nZ2UKICAgICAgICAgICAgICAgICAgICAoSW5NZW1vcnlFeHByZXNzaW9uRmFj\ndG9yeS5jbGFzcyk7CiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgVXNlckV4\nY2VwdGlvbihsb2MuZ2V0KCJub3QtY29tcCIsIG8xLCBvMikpOwoJCQl9CgkJ\nfQoJfQoKICAgIHB1YmxpYyBWYWx1ZSBnZW5lcmFsQ2FzZUV4cHJlc3Npb24o\nRXhwcmVzc2lvbltdIGV4cCwgVmFsdWUgdmFsKSB7CiAgICAgICAgRXhwW10g\nZXhwcyA9IG5ldyBFeHBbZXhwLmxlbmd0aF07CiAgICAgICAgZm9yIChpbnQg\naSA9IDA7IGkgPCBleHAubGVuZ3RoOyBpKyspCiAgICAgICAgICAgIGV4cHNb\naV0gPSAoRXhwKSBleHBbaV07CiAgICAgICAgcmV0dXJuIG5ldyBHZW5lcmFs\nQ2FzZShleHBzLCAoVmFsKSB2YWwpOwogICAgfQoKICAgIHB1YmxpYyBWYWx1\nZSBzaW1wbGVDYXNlRXhwcmVzc2lvbihWYWx1ZSBjYXNlT3BlcmFuZCwgRXhw\ncmVzc2lvbltdIGV4cCwKICAgICAgICBWYWx1ZSB2YWwpIHsKICAgICAgICAg\nICAgRXhwW10gZXhwcyA9IG5ldyBFeHBbZXhwLmxlbmd0aF07CiAgICAgICAg\nICAgIGZvciAoaW50IGkgPSAwOyBpIDwgZXhwLmxlbmd0aDsgaSsrKQogICAg\nICAgICAgICAgICAgZXhwc1tpXSA9IChFeHApIGV4cFtpXTsKICAgICAgICAg\nICAgcmV0dXJuIG5ldyBTaW1wbGVDYXNlKChWYWwpIGNhc2VPcGVyYW5kLCBl\neHBzLCAoVmFsKSB2YWwpOwogICAgfQoKICAgIHB1YmxpYyBFeHByZXNzaW9u\nIHdoZW5Db25kaXRpb24oRXhwcmVzc2lvbiBleHAsIFZhbHVlIHZhbCkgewog\nICAgICAgIHJldHVybiBuZXcgV2hlbkNvbmRpdGlvbigoRXhwKSBleHAsIChW\nYWwpIHZhbCk7CiAgICB9CgogICAgcHVibGljIEV4cHJlc3Npb24gd2hlblNj\nYWxhcihWYWx1ZSB2YWwxLCBWYWx1ZSB2YWwyKSB7CiAgICAgICAgcmV0dXJu\nIG5ldyBXaGVuU2NhbGFyKChWYWwpIHZhbDEsIChWYWwpIHZhbDIpOwogICAg\nfQoKICAgIHB1YmxpYyBWYWx1ZSBjb2FsZXNjZUV4cHJlc3Npb24oVmFsdWVb\nXSB2YWwpIHsKICAgICAgICBWYWxbXSB2YWxzID0gbmV3IFZhbFt2YWwubGVu\nZ3RoXTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IHZhbC5sZW5ndGg7\nIGkrKykKICAgICAgICAgICAgdmFsc1tpXSA9IChWYWwpIHZhbFtpXTsKICAg\nICAgICByZXR1cm4gbmV3IENvYWxlc2NlKHZhbHMpOwogICAgfQoKICAgIHB1\nYmxpYyBWYWx1ZSBudWxsSWZFeHByZXNzaW9uKFZhbHVlIHZhbDEsIFZhbHVl\nIHZhbDIpIHsKICAgICAgICByZXR1cm4gbmV3IE51bGxJZigoVmFsKSB2YWwx\nLCAoVmFsKSB2YWwyKTsKICAgIH0KCiAgICBwdWJsaWMgVmFsdWUgbmV3RnVu\nY3Rpb24oU3RyaW5nIGZ1bmN0aW9uTmFtZSwgQ2xhc3M8Pz4gcmVzdWx0VHlw\nZSwgVmFsdWUuLi4gYXJncykgewogICAgICAgIHRocm93IG5ldyBBYnN0cmFj\ndE1ldGhvZEVycm9yKCk7CiAgICB9Cn0K\n","encoding":"base64"}

