{"sha":"c17f4408ad673612133379bc0e0af0839c3ea086","node_id":"MDQ6QmxvYjIwNjM2NDpjMTdmNDQwOGFkNjczNjEyMTMzMzc5YmMwZTBhZjA4MzljM2VhMDg2","size":14293,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/c17f4408ad673612133379bc0e0af0839c3ea086","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YTsKCmltcG9ydCBqYXZh\nLmxhbmcucmVmbGVjdC5GaWVsZDsKaW1wb3J0IGphdmEubGFuZy5yZWZsZWN0\nLk1lbWJlcjsKaW1wb3J0IGphdmEubGFuZy5yZWZsZWN0Lk1ldGhvZDsKaW1w\nb3J0IGphdmEubGFuZy5yZWZsZWN0Lk1vZGlmaWVyOwppbXBvcnQgamF2YS5z\nZWN1cml0eS5BY2Nlc3NDb250cm9sbGVyOwppbXBvcnQgamF2YS5zZWN1cml0\neS5Qcml2aWxlZ2VkQWN0aW9uRXhjZXB0aW9uOwppbXBvcnQgamF2YS51dGls\nLkFycmF5TGlzdDsKaW1wb3J0IGphdmEudXRpbC5MaXN0OwoKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5lbmhhbmNlLlBDUmVnaXN0cnk7CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEuZW5oYW5jZS5SZWZsZWN0aW9uOwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLmxpYi5sb2cuTG9nOwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLmxpYi51dGlsLkoyRG9Qcml2SGVscGVyOwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51dGlsLkxvY2FsaXplcjsKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLkludGVybmFsRXhjZXB0aW9uOwpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuT3BlbkpQQUV4Y2VwdGlv\nbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLlVzZXJFeGNlcHRp\nb247CgovKioKICogQWJzdHJhY3QgaW1wbGVtZW50YXRpb24gcHJvdmlkZXMg\nYSBzZXQgb2YgZ2VuZXJpYyB1dGlsaXRpZXMgZm9yIGRldGVjdGluZwogKiBw\nZXJzaXN0ZW5jZSBtZXRhLWRhdGEgb2YgRmllbGQvTWVtYmVyLiBBbHNvIHBy\nb3ZpZGVzIGJlYW4tc3R5bGUgcHJvcGVydGllcyAKICogc3VjaCBhcyBhY2Nl\nc3Mgc3R5bGUgb3IgaWRlbnRpdHkgdHlwZSB0byBiZSB1c2VkIGJ5IGRlZmF1\nbHQgd2hlbiBzdWNoIAogKiBpbmZvcm1hdGlvbiBpcyBub3QgZGVyaXZhYmxl\nIGZyb20gYXZhaWxhYmxlIG1ldGEtZGF0YS4KICoKICogQGF1dGhvciBBYmUg\nV2hpdGUKICogQGF1dGhvciBQaW5ha2kgUG9kZGFyCiAqLwpwdWJsaWMgYWJz\ndHJhY3QgY2xhc3MgQWJzdHJhY3RNZXRhRGF0YURlZmF1bHRzCiAgICBpbXBs\nZW1lbnRzIE1ldGFEYXRhRGVmYXVsdHMgewoKICAgIHByaXZhdGUgc3RhdGlj\nIGZpbmFsIExvY2FsaXplciBfbG9jID0gTG9jYWxpemVyLmZvclBhY2thZ2UK\nICAgICAgICAoQWJzdHJhY3RNZXRhRGF0YURlZmF1bHRzLmNsYXNzKTsKCiAg\nICBwcml2YXRlIGludCBfYWNjZXNzID0gQWNjZXNzQ29kZS5GSUVMRDsKICAg\nIHByaXZhdGUgaW50IF9pZGVudGl0eSA9IENsYXNzTWV0YURhdGEuSURfVU5L\nTk9XTjsKICAgIHByaXZhdGUgYm9vbGVhbiBfaWdub3JlID0gdHJ1ZTsKICAg\nIHByaXZhdGUgYm9vbGVhbiBfaW50ZXJmYWNlID0gdHJ1ZTsKICAgIHByaXZh\ndGUgYm9vbGVhbiBfcGNSZWdpc3RyeSA9IHRydWU7CiAgICBwcml2YXRlIGlu\ndCBfY2FsbGJhY2sgPSBDQUxMQkFDS19SRVRIUk9XOwogICAgcHJpdmF0ZSBi\nb29sZWFuIF91bndyYXBwZWQgPSBmYWxzZTsKCiAgICAvKioKICAgICAqIFdo\nZXRoZXIgdG8gYXR0ZW1wdCB0byB1c2UgdGhlIGluZm9ybWF0aW9uIGZyb20g\ncmVnaXN0ZXJlZCBjbGFzc2VzCiAgICAgKiB0byBwb3B1bGF0ZSBtZXRhZGF0\nYSBkZWZhdWx0cy4gRGVmYXVsdHMgdG8gdHJ1ZS4KICAgICAqLwogICAgcHVi\nbGljIGJvb2xlYW4gZ2V0VXNlUENSZWdpc3RyeSgpIHsKICAgICAgICByZXR1\ncm4gX3BjUmVnaXN0cnk7CiAgICB9CgogICAgLyoqCiAgICAgKiBXaGV0aGVy\nIHRvIGF0dGVtcHQgdG8gdXNlIHRoZSBpbmZvcm1hdGlvbiBmcm9tIHJlZ2lz\ndGVyZWQgY2xhc3NlcwogICAgICogdG8gcG9wdWxhdGUgbWV0YWRhdGEgZGVm\nYXVsdHMuIERlZmF1bHRzIHRvIHRydWUuCiAgICAgKi8KICAgIHB1YmxpYyB2\nb2lkIHNldFVzZVBDUmVnaXN0cnkoYm9vbGVhbiBwY1JlZ2lzdHJ5KSB7CiAg\nICAgICAgX3BjUmVnaXN0cnkgPSBwY1JlZ2lzdHJ5OwogICAgfQoKICAgIC8q\nKgogICAgICogVGhlIGRlZmF1bHQgYWNjZXNzIHR5cGUgZm9yIGJhc2UgY2xh\nc3NlcyB3aXRoIEFDQ0VTU19VTktOT1dOLgogICAgICogQUNDRVNTX0ZJRUxE\nIGJ5IGRlZmF1bHQuCiAgICAgKi8KICAgIHB1YmxpYyBpbnQgZ2V0RGVmYXVs\ndEFjY2Vzc1R5cGUoKSB7CiAgICAgICAgcmV0dXJuIF9hY2Nlc3M7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBUaGUgZGVmYXVsdCBhY2Nlc3MgdHlwZSBmb3Ig\nYmFzZSBjbGFzc2VzIHdpdGggQUNDRVNTX1VOS05PV04uCiAgICAgKiBBQ0NF\nU1NfRklFTEQgYnkgZGVmYXVsdC4KICAgICAqLwogICAgcHVibGljIHZvaWQg\nc2V0RGVmYXVsdEFjY2Vzc1R5cGUoaW50IGFjY2VzcykgewogICAgICAgIF9h\nY2Nlc3MgPSBhY2Nlc3M7CiAgICB9CgogICAgLyoqCiAgICAgKiBUaGUgZGVm\nYXVsdCBpZGVudGl0eSB0eXBlIGZvciB1bm1hcHBlZCBjbGFzc2VzIHdpdGhv\ndXQgcHJpbWFyeSAKICAgICAqIGtleSBmaWVsZHMuIElEX1VOS05PV04gYnkg\nZGVmYXVsdC4KICAgICAqLwogICAgcHVibGljIGludCBnZXREZWZhdWx0SWRl\nbnRpdHlUeXBlKCkgewogICAgICAgIHJldHVybiBfaWRlbnRpdHk7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBUaGUgZGVmYXVsdCBpZGVudGl0eSB0eXBlIGZv\nciB1bm1hcHBlZCBjbGFzc2VzIHdpdGhvdXQgcHJpbWFyeSAKICAgICAqIGtl\neSBmaWVsZHMuIElEX1VOS05PV04gYnkgZGVmYXVsdC4KICAgICAqLwogICAg\ncHVibGljIHZvaWQgc2V0RGVmYXVsdElkZW50aXR5VHlwZShpbnQgaWRlbnRp\ndHkpIHsKICAgICAgICBfaWRlbnRpdHkgPSBpZGVudGl0eTsKICAgIH0KCiAg\nICBwdWJsaWMgaW50IGdldENhbGxiYWNrTW9kZSgpIHsKICAgICAgICByZXR1\ncm4gX2NhbGxiYWNrOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldENhbGxi\nYWNrTW9kZShpbnQgbW9kZSkgewogICAgICAgIF9jYWxsYmFjayA9IG1vZGU7\nCiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0Q2FsbGJhY2tNb2RlKGludCBt\nb2RlLCBib29sZWFuIG9uKSB7CiAgICAgICAgaWYgKG9uKQogICAgICAgICAg\nICBfY2FsbGJhY2sgfD0gbW9kZTsKICAgICAgICBlbHNlCiAgICAgICAgICAg\nIF9jYWxsYmFjayAmPSB+bW9kZTsKICAgIH0KCiAgICBwdWJsaWMgYm9vbGVh\nbiBnZXRDYWxsYmFja3NCZWZvcmVMaXN0ZW5lcnMoaW50IHR5cGUpIHsKICAg\nICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgcHVibGljIGJvb2xlYW4g\naXNEZWNsYXJlZEludGVyZmFjZVBlcnNpc3RlbnQoKSB7CiAgICAgICAgcmV0\ndXJuIF9pbnRlcmZhY2U7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0RGVj\nbGFyZWRJbnRlcmZhY2VQZXJzaXN0ZW50KGJvb2xlYW4gcGVycykgewogICAg\nICAgIF9pbnRlcmZhY2UgPSBwZXJzOwogICAgfQoKICAgIHB1YmxpYyBib29s\nZWFuIGlzRGF0YVN0b3JlT2JqZWN0SWRGaWVsZFVud3JhcHBlZCgpIHsKICAg\nICAgICByZXR1cm4gX3Vud3JhcHBlZDsKICAgIH0KCiAgICBwdWJsaWMgdm9p\nZCBzZXREYXRhU3RvcmVPYmplY3RJZEZpZWxkVW53cmFwcGVkKGJvb2xlYW4g\ndW53cmFwcGVkKSB7CiAgICAgICAgX3Vud3JhcHBlZCA9IHVud3JhcHBlZDsK\nICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBnZXRJZ25vcmVOb25QZXJzaXN0\nZW50KCkgewogICAgICAgIHJldHVybiBfaWdub3JlOwogICAgfQoKICAgIHB1\nYmxpYyB2b2lkIHNldElnbm9yZU5vblBlcnNpc3RlbnQoYm9vbGVhbiBpZ25v\ncmUpIHsKICAgICAgICBfaWdub3JlID0gaWdub3JlOwogICAgfQoKICAgIHB1\nYmxpYyB2b2lkIHBvcHVsYXRlKENsYXNzTWV0YURhdGEgbWV0YSwgaW50IGFj\nY2VzcykgewogICAgICAgIHBvcHVsYXRlKG1ldGEsIGFjY2VzcywgZmFsc2Up\nOwogICAgfQogICAgCiAgICBwdWJsaWMgdm9pZCBwb3B1bGF0ZShDbGFzc01l\ndGFEYXRhIG1ldGEsIGludCBhY2Nlc3MsIGJvb2xlYW4gaWdub3JlVHJhbnNp\nZW50KSB7CiAgICAgICAgaWYgKG1ldGEuZ2V0RGVzY3JpYmVkVHlwZSgpID09\nIE9iamVjdC5jbGFzcykKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIG1l\ndGEuc2V0QWNjZXNzVHlwZShhY2Nlc3MpOwoKICAgICAgICBMb2cgbG9nID0g\nbWV0YS5nZXRSZXBvc2l0b3J5KCkuZ2V0TG9nKCk7CiAgICAgICAgaWYgKGxv\nZy5pc1RyYWNlRW5hYmxlZCgpKQogICAgICAgICAgICBsb2cudHJhY2UoX2xv\nYy5nZXQoImdlbi1tZXRhIiwgbWV0YSkpOwogICAgICAgIGlmICghX3BjUmVn\naXN0cnkgfHwgIXBvcHVsYXRlRnJvbVBDUmVnaXN0cnkobWV0YSkpIHsKICAg\nICAgICAgICAgaWYgKGxvZy5pc1RyYWNlRW5hYmxlZCgpKQogICAgICAgICAg\nICAgICAgbG9nLnRyYWNlKF9sb2MuZ2V0KCJtZXRhLXJlZmxlY3QiKSk7CiAg\nICAgICAgICAgIHBvcHVsYXRlRnJvbVJlZmxlY3Rpb24obWV0YSwgaWdub3Jl\nVHJhbnNpZW50KTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBQ\nb3B1bGF0ZSB0aGUgZ2l2ZW4gbWV0YWRhdGEgdXNpbmcgdGhlIHtAbGluayBQ\nQ1JlZ2lzdHJ5fS4KICAgICAqLwogICAgcHJpdmF0ZSBib29sZWFuIHBvcHVs\nYXRlRnJvbVBDUmVnaXN0cnkoQ2xhc3NNZXRhRGF0YSBtZXRhKSB7CiAgICAg\nICAgQ2xhc3M8Pz4gY2xzID0gbWV0YS5nZXREZXNjcmliZWRUeXBlKCk7CiAg\nICAgICAgaWYgKCFQQ1JlZ2lzdHJ5LmlzUmVnaXN0ZXJlZChjbHMpKQogICAg\nICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgdHJ5IHsKICAgICAgICAg\nICAgU3RyaW5nW10gZmllbGROYW1lcyA9IFBDUmVnaXN0cnkuZ2V0RmllbGRO\nYW1lcyhjbHMpOwogICAgICAgICAgICBDbGFzczw/PltdIGZpZWxkVHlwZXMg\nPSBQQ1JlZ2lzdHJ5LmdldEZpZWxkVHlwZXMoY2xzKTsKICAgICAgICAgICAg\nTWVtYmVyIG1lbWJlcjsKICAgICAgICAgICAgRmllbGRNZXRhRGF0YSBmbWQ7\nCiAgICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgZmllbGROYW1lcy5s\nZW5ndGg7IGkgKyspIHsKICAgICAgICAgICAgCVN0cmluZyBwcm9wZXJ0eSA9\nIGZpZWxkTmFtZXNbaV07CiAgICAgICAgICAgICAgICBtZW1iZXIgPSBnZXRN\nZW1iZXJCeVByb3BlcnR5KG1ldGEsIHByb3BlcnR5LAogICAgICAgICAgICAg\nICAgCUFjY2Vzc0NvZGUuVU5LTk9XTiwgdHJ1ZSk7CiAgICAgICAgICAgICAg\nICBpZiAobWVtYmVyID09IG51bGwpIC8vIHRyYW5zaWVudCBvciBpbmRldGVy\nbWluYWJsZSBhY2Nlc3MKICAgICAgICAgICAgICAgIAljb250aW51ZTsKICAg\nICAgICAgICAgICAgIGZtZCA9IG1ldGEuYWRkRGVjbGFyZWRGaWVsZChwcm9w\nZXJ0eSwgZmllbGRUeXBlc1tpXSk7CiAgICAgICAgICAgICAgICBmbWQuYmFj\na2luZ01lbWJlcihtZW1iZXIpOwogICAgICAgICAgICAgICAgcG9wdWxhdGUo\nZm1kKTsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gdHJ1ZTsK\nICAgICAgICB9IGNhdGNoIChPcGVuSlBBRXhjZXB0aW9uIGtlKSB7CiAgICAg\nICAgICAgIHRocm93IGtlOwogICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBl\nKSB7CiAgICAgICAgICAgIGlmIChlIGluc3RhbmNlb2YgUHJpdmlsZWdlZEFj\ndGlvbkV4Y2VwdGlvbikKICAgICAgICAgICAgICAgIGUgPSAoKFByaXZpbGVn\nZWRBY3Rpb25FeGNlcHRpb24pIGUpLmdldEV4Y2VwdGlvbigpOwogICAgICAg\nICAgICB0aHJvdyBuZXcgVXNlckV4Y2VwdGlvbihlKTsKICAgICAgICB9CiAg\nICB9CgogICAgcHJvdGVjdGVkIGFic3RyYWN0IExpc3Q8TWVtYmVyPiBnZXRQ\nZXJzaXN0ZW50TWVtYmVycyhDbGFzc01ldGFEYXRhIG1ldGEsIGJvb2xlYW4g\naWdub3JlVHJhbnNpZW50KTsKICAgIC8qKgogICAgICogR2VuZXJhdGUgdGhl\nIGdpdmVuIG1ldGEtZGF0YSB1c2luZyByZWZsZWN0aW9uLgogICAgICogQWRk\ncyBGaWVsZE1ldGFEYXRhIGZvciBlYWNoIHBlcnNpc3RlbnQgc3RhdGUuCiAg\nICAgKiBEZWxlZ2F0ZSB0byBjb25jcmV0ZSBpbXBsZW1lbnRhdGlvbiB0byBk\nZXRlcm1pbmUgdGhlIHBlcnNpc3RlbnQKICAgICAqIG1lbWJlcnMuCiAgICAg\nKi8KICAgIHByaXZhdGUgdm9pZCBwb3B1bGF0ZUZyb21SZWZsZWN0aW9uKENs\nYXNzTWV0YURhdGEgbWV0YSwgYm9vbGVhbiBpZ25vcmVUcmFuc2llbnQpIHsK\nICAgICAgICBMaXN0PE1lbWJlcj4gbWVtYmVycyA9IGdldFBlcnNpc3RlbnRN\nZW1iZXJzKG1ldGEsIGlnbm9yZVRyYW5zaWVudCk7CiAgICAgICAgYm9vbGVh\nbiBpZmFjZSA9IG1ldGEuZ2V0RGVzY3JpYmVkVHlwZSgpLmlzSW50ZXJmYWNl\nKCk7CiAgICAgICAgLy8gSWYgYWNjZXNzIGlzIG1peGVkIG9yIGlmIHRoZSBk\nZWZhdWx0IGlzIGN1cnJlbnRseSB1bmtub3duLCAKICAgICAgICAvLyBwcm9j\nZXNzIGFsbCBmaWVsZHMsIG90aGVyd2lzZSBvbmx5IHByb2Nlc3MgbWVtYmVy\ncyBvZiB0aGUgY2xhc3MgIAogICAgICAgIC8vIGxldmVsIGRlZmF1bHQgYWNj\nZXNzIHR5cGUuIAogICAgICAgIAogICAgICAgIFN0cmluZyBuYW1lOwogICAg\nICAgIGJvb2xlYW4gZGVmOwogICAgICAgIEZpZWxkTWV0YURhdGEgZm1kOwog\nICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgbWVtYmVycy5zaXplKCk7IGkr\nKykgewogICAgICAgICAgICBNZW1iZXIgbWVtYmVyID0gbWVtYmVycy5nZXQo\naSk7CiAgICAgICAgICAgIG5hbWUgPSBnZXRGaWVsZE5hbWUobWVtYmVyKTsK\nICAgICAgICAgICAgaWYgKG5hbWUgPT0gbnVsbCB8fCBpc1Jlc2VydmVkRmll\nbGROYW1lKG5hbWUpKQogICAgICAgICAgICAgICAgY29udGludWU7CgogICAg\nICAgICAgICBkZWYgPSBpc0RlZmF1bHRQZXJzaXN0ZW50KG1ldGEsIG1lbWJl\nciwgbmFtZSwgaWdub3JlVHJhbnNpZW50KTsKICAgICAgICAgICAgaWYgKCFk\nZWYgJiYgX2lnbm9yZSkKICAgICAgICAgICAgICAgIGNvbnRpbnVlOwoKICAg\nICAgICAgICAgLy8gcGFzc2VkIHRoZSB0ZXN0czsgcGVyc2lzdGVudCB0eXBl\nIC0tIHdlIGNvbnN0cnVjdCB3aXRoCiAgICAgICAgICAgIC8vIE9iamVjdC5j\nbGFzcyBiZWNhdXNlIHNldHRpbmcgYmFja2luZyBtZW1iZXIgd2lsbCBzZXQg\ncHJvcGVyCiAgICAgICAgICAgIC8vIHR5cGUgYW55d2F5CiAgICAgICAgICAg\nIGZtZCA9IG1ldGEuYWRkRGVjbGFyZWRGaWVsZChuYW1lLCBPYmplY3QuY2xh\nc3MpOwogICAgICAgICAgICBmbWQuYmFja2luZ01lbWJlcihtZW1iZXIpOwog\nICAgICAgICAgICBpZiAoIWRlZikgewogICAgICAgICAgICAgICAgZm1kLnNl\ndEV4cGxpY2l0KHRydWUpOwogICAgICAgICAgICAgICAgZm1kLnNldE1hbmFn\nZW1lbnQoRmllbGRNZXRhRGF0YS5NQU5BR0VfTk9ORSk7CiAgICAgICAgICAg\nIH0KICAgICAgICAgICAgcG9wdWxhdGUoZm1kKTsKICAgICAgICB9CiAgICB9\nCgogICAgcHJvdGVjdGVkIHZvaWQgcG9wdWxhdGUoRmllbGRNZXRhRGF0YSBm\nbWQpIHsKICAgIAkKICAgIH0KICAgIAogICAgLyoqCiAgICAgKiBSZXR1cm4g\ndGhlIGxpc3Qgb2YgZmllbGRzIGluIDxjb2RlPm1ldGE8L2NvZGU+IHRoYXQg\ndXNlIGZpZWxkIGFjY2VzcywKICAgICAqIG9yIDxjb2RlPm51bGw8L2NvZGU+\nIGlmIGEgbGlzdCBvZiBmaWVsZHMgaXMgdW5vYnRhaW5hYmxlLiBBbiBlbXB0\neSBsaXN0CiAgICAgKiBzaG91bGQgYmUgcmV0dXJuZWQgaWYgdGhlIGxpc3Qg\nb2YgZmllbGRzIGlzIG9idGFpbmFibGUsIGJ1dCB0aGVyZQogICAgICogaGFw\ncGVucyB0byBiZSBubyBmaWVsZCBhY2Nlc3MgaW4gPGNvZGU+bWV0YTwvY29k\nZT4uCiAgICAgKgogICAgICogVGhpcyBpcyB1c2VkIGZvciBlcnJvciByZXBv\ncnRpbmcgcHVycG9zZXMgb25seSwgc28gbmVlZCBub3QgYmUgZWZmaWNpZW50\nLgogICAgICoKICAgICAqIFRoaXMgaW1wbGVtZW50YXRpb24gcmV0dXJucyA8\nY29kZT5udWxsPC9jb2RlPi4KICAgICAqLwogICAgcHJvdGVjdGVkIExpc3Q8\nU3RyaW5nPiBnZXRGaWVsZEFjY2Vzc05hbWVzKENsYXNzTWV0YURhdGEgbWV0\nYSkgewogICAgICAgIHJldHVybiBudWxsOwogICAgfQoKICAgIC8qKgogICAg\nICogUmV0dXJuIHRoZSBsaXN0IG9mIG1ldGhvZHMgaW4gPGNvZGU+bWV0YTwv\nY29kZT4gdGhhdCB1c2UgcHJvcGVydHkgYWNjZXNzLAogICAgICogb3IgPGNv\nZGU+bnVsbDwvY29kZT4gaWYgYSBsaXN0IG9mIG1ldGhvZHMgaXMgdW5vYnRh\naW5hYmxlLiBBbiBlbXB0eSBsaXN0CiAgICAgKiBzaG91bGQgYmUgcmV0dXJu\nZWQgaWYgdGhlIGxpc3Qgb2YgbWV0aG9kcyBpcyBvYnRhaW5hYmxlLCBidXQg\ndGhlcmUKICAgICAqIGhhcHBlbnMgdG8gYmUgbm8gcHJvcGVydHkgYWNjZXNz\nIGluIDxjb2RlPm1ldGE8L2NvZGU+LgogICAgICoKICAgICAqIFRoaXMgaXMg\ndXNlZCBmb3IgZXJyb3IgcmVwb3J0aW5nIHB1cnBvc2VzIG9ubHksIHNvIG5l\nZWQgbm90IGJlIGVmZmljaWVudC4KICAgICAqCiAgICAgKiBUaGlzIGltcGxl\nbWVudGF0aW9uIHJldHVybnMgPGNvZGU+bnVsbDwvY29kZT4uCiAgICAgKi8K\nICAgIHByb3RlY3RlZCBMaXN0PFN0cmluZz4gZ2V0UHJvcGVydHlBY2Nlc3NO\nYW1lcyhDbGFzc01ldGFEYXRhIG1ldGEpIHsKICAgICAgICByZXR1cm4gbnVs\nbDsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgZmllbGQgbmFt\nZSBmb3IgdGhlIGdpdmVuIG1lbWJlci4gVGhpcyB3aWxsIG9ubHkgYmUgaW52\nb2tlZAogICAgICogb24gbWVtYmVycyBvZiB0aGUgcmlnaHQgdHlwZSAoZmll\nbGQgdnMuIG1ldGhvZCkuIFJldHVybiBudWxsIGlmIHRoZQogICAgICogbWVt\nYmVyIGNhbm5vdCBiZSBtYW5hZ2VkLiBEZWZhdWx0IGJlaGF2aW9yOiBGb3Ig\nZmllbGRzLCByZXR1cm5zIHRoZQogICAgICogZmllbGQgbmFtZS4gRm9yIGdl\ndHRlciBtZXRob2RzLCByZXR1cm5zIHRoZSBtaW51cyAiZ2V0IiBvciAiaXMi\nIHdpdGgKICAgICAqIHRoZSBuZXh0IGxldHRlciBsb3dlci1jYXNlZC4gRm9y\nIG90aGVyIG1ldGhvZHMsIHJldHVybnMgbnVsbC4KICAgICAqLwogICAgcHVi\nbGljIHN0YXRpYyBTdHJpbmcgZ2V0RmllbGROYW1lKE1lbWJlciBtZW1iZXIp\nIHsKICAgICAgICBpZiAobWVtYmVyIGluc3RhbmNlb2YgRmllbGQpCiAgICAg\nICAgICAgIHJldHVybiBtZW1iZXIuZ2V0TmFtZSgpOwogICAgICAgIGlmICht\nZW1iZXIgaW5zdGFuY2VvZiBNZXRob2QgPT0gZmFsc2UpCiAgICAgICAgCXJl\ndHVybiBudWxsOwogICAgICAgIE1ldGhvZCBtZXRob2QgPSAoTWV0aG9kKSBt\nZW1iZXI7CiAgICAgICAgU3RyaW5nIG5hbWUgPSBtZXRob2QuZ2V0TmFtZSgp\nOwogICAgICAgIGlmIChpc05vcm1hbEdldHRlcihtZXRob2QpKQogICAgICAg\nIAluYW1lID0gbmFtZS5zdWJzdHJpbmcoImdldCIubGVuZ3RoKCkpOwogICAg\nICAgIGVsc2UgaWYgKGlzQm9vbGVhbkdldHRlcihtZXRob2QpKQogICAgICAg\nIAluYW1lID0gbmFtZS5zdWJzdHJpbmcoImlzIi5sZW5ndGgoKSk7CiAgICAg\nICAgZWxzZQogICAgICAgICAgICByZXR1cm4gbnVsbDsKCiAgICAgICAgaWYg\nKG5hbWUubGVuZ3RoKCkgPT0gMSkKICAgICAgICAgICAgcmV0dXJuIG5hbWUu\ndG9Mb3dlckNhc2UoKTsKICAgICAgICByZXR1cm4gQ2hhcmFjdGVyLnRvTG93\nZXJDYXNlKG5hbWUuY2hhckF0KDApKSArIG5hbWUuc3Vic3RyaW5nKDEpOwog\nICAgfQoKICAgIC8qKgogICAgICogUmV0dXJucyB0cnVlIGlmIHRoZSBnaXZl\nbiBmaWVsZCBuYW1lIGlzIHJlc2VydmVkIGZvciB1bm1hbmFnZWQgZmllbGRz\nLgogICAgICovCiAgICBwcm90ZWN0ZWQgYm9vbGVhbiBpc1Jlc2VydmVkRmll\nbGROYW1lKFN0cmluZyBuYW1lKSB7CiAgICAgICAgLy8gbmFtZXMgdXNlZCBi\neSBlbmhhbmNlcnMKICAgICAgICByZXR1cm4gbmFtZS5zdGFydHNXaXRoKCJv\ncGVuanBhIikgfHwgbmFtZS5zdGFydHNXaXRoKCJqZG8iKTsKICAgIH0KCiAg\nICAvKioKICAgICAqIFJldHVybiB0cnVlIGlmIHRoZSBnaXZlbiBtZW1iZXIg\naXMgcGVyc2lzdGVudCBieSBkZWZhdWx0LiBUaGlzIHdpbGwKICAgICAqIG9u\nbHkgYmUgaW52b2tlZCBvbiBtZW1iZXJzIG9mIHRoZSByaWdodCB0eXBlIChm\naWVsZCB2cy4gbWV0aG9kKS4KICAgICAqIFJldHVybnMgZmFsc2UgaWYgbWVt\nYmVyIGlzIHN0YXRpYyBvciBmaW5hbCBieSBkZWZhdWx0LgogICAgICoKICAg\nICAqIEBwYXJhbSBuYW1lIHRoZSBmaWVsZCBuYW1lIGZyb20ge0BsaW5rICNn\nZXRGaWVsZE5hbWV9CiAgICAgKi8KICAgIHByb3RlY3RlZCBhYnN0cmFjdCBi\nb29sZWFuIGlzRGVmYXVsdFBlcnNpc3RlbnQoQ2xhc3NNZXRhRGF0YSBtZXRh\nLAogICAgICAgIE1lbWJlciBtZW1iZXIsIFN0cmluZyBuYW1lLCBib29sZWFu\nIGlnbm9yZVRyYW5zaWVudCk7CgogICAgLyoqCiAgICAgKiBHZXRzIHRoZSBi\nYWNraW5nIG1lbWJlciBvZiB0aGUgZ2l2ZW4gZmllbGQuIElmIHRoZSBmaWVs\nZCBoYXMgbm90IGJlZW4KICAgICAqIGFzc2lnbmVkIGEgYmFja2luZyBtZW1i\nZXIgdGhlbiBnZXQgZWl0aGVyIHRoZSBpbnN0YW5jZSBmaWVsZCBvciB0aGUK\nICAgICAqIGdldHRlciBtZXRob2QgZGVwZW5kaW5nIHVwb24gdGhlIGFjY2Vz\ncyBzdHlsZSBvZiB0aGUgZGVmaW5pbmcgY2xhc3MuCiAgICAgKiA8YnI+CiAg\nICAgKiBEZWZpbmluZyBjbGFzcyBpcyB1c2VkIGluc3RlYWQgb2YgZGVjbGFy\naW5nIGNsYXNzIGJlY2F1c2UgdGhpcyBtZXRob2QKICAgICAqIG1heSBiZSBp\nbnZva2VkIGR1cmluZyBwYXJzaW5nIHBoYXNlIHdoZW4gZGVjbGFyaW5nIG1l\ndGFkYXRhIG1heSBub3QgYmUKICAgICAqIGF2YWlsYWJsZS4gIAogICAgICov\nCiAgICBwdWJsaWMgTWVtYmVyIGdldEJhY2tpbmdNZW1iZXIoRmllbGRNZXRh\nRGF0YSBmbWQpIHsKICAgICAgICBpZiAoZm1kID09IG51bGwpCiAgICAgICAg\nICAgIHJldHVybiBudWxsOwogICAgICAgIGlmIChmbWQuZ2V0QmFja2luZ01l\nbWJlcigpICE9IG51bGwpCiAgICAgICAgCXJldHVybiBmbWQuZ2V0QmFja2lu\nZ01lbWJlcigpOwogICAgICAgIHJldHVybiBnZXRNZW1iZXJCeVByb3BlcnR5\nKGZtZC5nZXREZWNsYXJpbmdNZXRhRGF0YSgpLCBmbWQuZ2V0TmFtZSgpLAog\nICAgICAgICAgICBmbWQuZ2V0QWNjZXNzVHlwZSgpLCB0cnVlKTsKICAgIH0K\nICAgIAogICAgcHVibGljIENsYXNzPD8+IGdldFVuaW1wbGVtZW50ZWRFeGNl\ncHRpb25UeXBlKCkgewogICAgICAgIHJldHVybiBVbnN1cHBvcnRlZE9wZXJh\ndGlvbkV4Y2VwdGlvbi5jbGFzczsKICAgIH0KCiAgICAvKioKICAgICAqIEhl\nbHBlciBtZXRob2Q7IHJldHVybnMgdHJ1ZSBpZiB0aGUgZ2l2ZW4gY2xhc3Mg\nYXBwZWFycyB0byBiZQogICAgICogdXNlci1kZWZpbmVkLgogICAgICovCiAg\nICBwcm90ZWN0ZWQgc3RhdGljIGJvb2xlYW4gaXNVc2VyRGVmaW5lZChDbGFz\nczw/PiBjbHMpIHsKICAgICAgICByZXR1cm4gY2xzICE9IG51bGwgJiYgIWNs\ncy5nZXROYW1lKCkuc3RhcnRzV2l0aCgiamF2YS4iKQogICAgICAgICAgICAm\nJiAhY2xzLmdldE5hbWUoKS5zdGFydHNXaXRoICgiamF2YXguIik7Cgl9CiAg\nICAKICAgIC8qKgogICAgICogQWZmaXJtcyBpZiB0aGUgZ2l2ZW4gbWV0aG9k\nIG1hdGNoZXMgdGhlIGZvbGxvd2luZyBzaWduYXR1cmUKICAgICAqIDxjb2Rl\nPiBwdWJsaWMgVCBnZXRYWFgoKSA8L2NvZGU+CiAgICAgKiB3aGVyZSBUIGlz\nIGFueSBub24tdm9pZCB0eXBlLgogICAgICovCiAgICBwdWJsaWMgc3RhdGlj\nIGJvb2xlYW4gaXNOb3JtYWxHZXR0ZXIoTWV0aG9kIG1ldGhvZCkgewogICAg\nCVN0cmluZyBtZXRob2ROYW1lID0gbWV0aG9kLmdldE5hbWUoKTsKICAgIAly\nZXR1cm4gc3RhcnRzV2l0aChtZXRob2ROYW1lLCAiZ2V0IikgCiAgICAJICAg\nICYmIG1ldGhvZC5nZXRQYXJhbWV0ZXJUeXBlcygpLmxlbmd0aCA9PSAwCiAg\nICAJICAgICYmIG1ldGhvZC5nZXRSZXR1cm5UeXBlKCkgIT0gdm9pZC5jbGFz\nczsKICAgIH0KICAgIAogICAgLyoqCiAgICAgKiBBZmZpcm1zIGlmIHRoZSBn\naXZlbiBtZXRob2QgbWF0Y2hlcyB0aGUgZm9sbG93aW5nIHNpZ25hdHVyZQog\nICAgICogPGNvZGU+IHB1YmxpYyBib29sZWFuIGlzWFhYKCkgPC9jb2RlPgog\nICAgICogPGNvZGU+IHB1YmxpYyBCb29sZWFuIGlzWFhYKCkgPC9jb2RlPgog\nICAgICovCiAgICBwdWJsaWMgc3RhdGljIGJvb2xlYW4gaXNCb29sZWFuR2V0\ndGVyKE1ldGhvZCBtZXRob2QpIHsKICAgIAlTdHJpbmcgbWV0aG9kTmFtZSA9\nIG1ldGhvZC5nZXROYW1lKCk7CiAgICAJcmV0dXJuIHN0YXJ0c1dpdGgobWV0\naG9kTmFtZSwgImlzIikgCiAgICAJICAgICYmIG1ldGhvZC5nZXRQYXJhbWV0\nZXJUeXBlcygpLmxlbmd0aCA9PSAwCiAgICAJICAgICYmIGlzQm9vbGVhbiht\nZXRob2QuZ2V0UmV0dXJuVHlwZSgpKTsKICAgIH0KCiAgICAvKioKICAgICAq\nIEFmZmlybXMgaWYgdGhlIGdpdmVuIG1ldGhvZCBzaWduYXR1cmUgbWF0Y2hl\ncyBiZWFuLXN0eWxlIGdldHRlciBtZXRob2QKICAgICAqIHNpZ25hdHVyZS48\nYnI+CiAgICAgKiA8Y29kZT4gcHVibGljIFQgZ2V0WFhYKCk8L2NvZGU+IHdo\nZXJlIFQgaXMgYW55IG5vbi12b2lkIHR5cGUuPGJyPgogICAgICogb3I8YnI+\nCiAgICAgKiA8Y29kZT4gcHVibGljIFQgaXNYWFgoKTwvY29kZT4gd2hlcmUg\nVCBpcyBib29sZWFuIG9yIEJvb2xlYW4uPGJyPgogICAgICovCiAgICBwdWJs\naWMgc3RhdGljIGJvb2xlYW4gaXNHZXR0ZXIoTWV0aG9kIG1ldGhvZCwgYm9v\nbGVhbiBpbmNsdWRlUHJpdmF0ZSkgewogICAgCWlmIChtZXRob2QgPT0gbnVs\nbCkKICAgIAkJcmV0dXJuIGZhbHNlOwogICAgCWludCBtb2RzID0gbWV0aG9k\nLmdldE1vZGlmaWVycygpOwogICAgCWlmICghKE1vZGlmaWVyLmlzUHVibGlj\nKG1vZHMpIAogICAgCSAgICAgIHx8IE1vZGlmaWVyLmlzUHJvdGVjdGVkKG1v\nZHMpCiAgICAJICAgICAgfHwgKE1vZGlmaWVyLmlzUHJpdmF0ZShtb2RzKSAm\nJiBpbmNsdWRlUHJpdmF0ZSkpCiAgICAJIHx8IE1vZGlmaWVyLmlzTmF0aXZl\nKG1vZHMpIAogICAgCSB8fCBNb2RpZmllci5pc1N0YXRpYyhtb2RzKSkKICAg\nIAkJcmV0dXJuIGZhbHNlOwogICAgCXJldHVybiBpc05vcm1hbEdldHRlciht\nZXRob2QpIHx8IGlzQm9vbGVhbkdldHRlcihtZXRob2QpOwogICAgfQogICAg\nCiAgICAvKioKICAgICAqIEFmZmlybXMgaWYgdGhlIGdpdmVuIGZ1bGwgc3Ry\naW5nIHN0YXJ0cyB3aXRoIHRoZSBnaXZlbiBoZWFkLgogICAgICovCiAgICBw\ndWJsaWMgc3RhdGljIGJvb2xlYW4gc3RhcnRzV2l0aChTdHJpbmcgZnVsbCwg\nU3RyaW5nIGhlYWQpIHsKICAgICAgICByZXR1cm4gZnVsbCAhPSBudWxsICYm\nIGhlYWQgIT0gbnVsbCAmJiBmdWxsLnN0YXJ0c1dpdGgoaGVhZCkgCiAgICAg\nICAgICAgICYmIGZ1bGwubGVuZ3RoKCkgPiBoZWFkLmxlbmd0aCgpOwogICAg\nfQogICAgCiAgICBwdWJsaWMgc3RhdGljIGJvb2xlYW4gaXNCb29sZWFuKENs\nYXNzPD8+IGNscykgewogICAgCXJldHVybiBjbHMgPT0gYm9vbGVhbi5jbGFz\ncyB8fCBjbHMgPT0gQm9vbGVhbi5jbGFzczsKICAgIH0KICAgIAogICAgcHVi\nbGljIHN0YXRpYyBMaXN0PFN0cmluZz4gdG9OYW1lcyhMaXN0PD8gZXh0ZW5k\ncyBNZW1iZXI+IG1lbWJlcnMpIHsKICAgIAlMaXN0PFN0cmluZz4gcmVzdWx0\nID0gbmV3IEFycmF5TGlzdDxTdHJpbmc+KCk7CiAgICAJZm9yIChNZW1iZXIg\nbSA6IG1lbWJlcnMpCiAgICAJCXJlc3VsdC5hZGQobS5nZXROYW1lKCkpOwog\nICAgCXJldHVybiByZXN1bHQ7CiAgICB9Cgp9Cg==\n","encoding":"base64"}

