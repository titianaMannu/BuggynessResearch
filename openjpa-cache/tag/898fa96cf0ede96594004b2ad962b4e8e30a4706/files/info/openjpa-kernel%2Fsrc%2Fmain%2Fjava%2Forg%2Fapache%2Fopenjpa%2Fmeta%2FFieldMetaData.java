{"sha":"95cc81a8ad248ba1000c92ae38c9162a733f7be6","node_id":"MDQ6QmxvYjIwNjM2NDo5NWNjODFhOGFkMjQ4YmExMDAwYzkyYWUzOGM5MTYyYTczM2Y3YmU2","size":72949,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/95cc81a8ad248ba1000c92ae38c9162a733f7be6","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YTsKCmltcG9ydCBqYXZh\nLmlvLkV4dGVybmFsaXphYmxlOwppbXBvcnQgamF2YS5pby5JT0V4Y2VwdGlv\nbjsKaW1wb3J0IGphdmEuaW8uT2JqZWN0SW5wdXQ7CmltcG9ydCBqYXZhLmlv\nLk9iamVjdE91dHB1dDsKaW1wb3J0IGphdmEuaW8uU2VyaWFsaXphYmxlOwpp\nbXBvcnQgamF2YS5sYW5nLnJlZmxlY3QuQ29uc3RydWN0b3I7CmltcG9ydCBq\nYXZhLmxhbmcucmVmbGVjdC5GaWVsZDsKaW1wb3J0IGphdmEubGFuZy5yZWZs\nZWN0Lkludm9jYXRpb25UYXJnZXRFeGNlcHRpb247CmltcG9ydCBqYXZhLmxh\nbmcucmVmbGVjdC5NZW1iZXI7CmltcG9ydCBqYXZhLmxhbmcucmVmbGVjdC5N\nZXRob2Q7CmltcG9ydCBqYXZhLmxhbmcucmVmbGVjdC5Nb2RpZmllcjsKaW1w\nb3J0IGphdmEuc2VjdXJpdHkuQWNjZXNzQ29udHJvbGxlcjsKaW1wb3J0IGph\ndmEuc2VjdXJpdHkuUHJpdmlsZWdlZEFjdGlvbkV4Y2VwdGlvbjsKaW1wb3J0\nIGphdmEudXRpbC5BcnJheUxpc3Q7CmltcG9ydCBqYXZhLnV0aWwuQ2FsZW5k\nYXI7CmltcG9ydCBqYXZhLnV0aWwuQ29sbGVjdGlvbjsKaW1wb3J0IGphdmEu\ndXRpbC5Db2xsZWN0aW9uczsKaW1wb3J0IGphdmEudXRpbC5Db21wYXJhdG9y\nOwppbXBvcnQgamF2YS51dGlsLkhhc2hNYXA7CmltcG9ydCBqYXZhLnV0aWwu\nSGFzaFNldDsKaW1wb3J0IGphdmEudXRpbC5JdGVyYXRvcjsKaW1wb3J0IGph\ndmEudXRpbC5MaXN0OwppbXBvcnQgamF2YS51dGlsLk1hcDsKaW1wb3J0IGph\ndmEudXRpbC5Qcm9wZXJ0aWVzOwppbXBvcnQgamF2YS51dGlsLlNldDsKaW1w\nb3J0IGphdmEudXRpbC5UaW1lWm9uZTsKCmltcG9ydCBvcmcuYXBhY2hlLmNv\nbW1vbnMuY29sbGVjdGlvbnMuY29tcGFyYXRvcnMuQ29tcGFyYXRvckNoYWlu\nOwppbXBvcnQgb3JnLmFwYWNoZS5jb21tb25zLmxhbmcuU3RyaW5nVXRpbHM7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuY29uZi5PcGVuSlBBQ29uZmln\ndXJhdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuT3Bl\nbkpQQVN0YXRlTWFuYWdlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5r\nZXJuZWwuU3RvcmVDb250ZXh0OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLmxpYi5jb25mLkNvbmZpZ3VyYXRpb25zOwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLmxpYi5sb2cuTG9nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLmxpYi51dGlsLkoyRG9Qcml2SGVscGVyOwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLmxpYi51dGlsLkphdmFWZXJzaW9uczsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5saWIudXRpbC5Mb2NhbGl6ZXI7CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEubGliLnV0aWwuT3B0aW9uczsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5saWIueG1sLkNvbW1lbnRhYmxlOwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLnV0aWwuRXhjZXB0aW9uczsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS51dGlsLkludGVybmFsRXhjZXB0aW9uOwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLnV0aWwuTWV0YURhdGFFeGNlcHRpb247CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5PcGVuSlBBRXhjZXB0aW9uOwpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuVW5zdXBwb3J0ZWRFeGNl\ncHRpb247CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5JbXBsSGVs\ncGVyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuVXNlckV4Y2Vw\ndGlvbjsKCmltcG9ydCBzZXJwLnV0aWwuU3RyaW5nczsKCi8qKgogKiBNZXRh\nZGF0YSBmb3IgYSBtYW5hZ2VkIGNsYXNzIGZpZWxkLgogKgogKiBAYXV0aG9y\nIEFiZSBXaGl0ZQogKi8KQFN1cHByZXNzV2FybmluZ3MoInNlcmlhbCIpCnB1\nYmxpYyBjbGFzcyBGaWVsZE1ldGFEYXRhCiAgICBleHRlbmRzIEV4dGVuc2lv\nbnMKICAgIGltcGxlbWVudHMgVmFsdWVNZXRhRGF0YSwgTWV0YURhdGFDb250\nZXh0LCBNZXRhRGF0YU1vZGVzLCBDb21tZW50YWJsZSB7CiAgICAKICAgIC8q\nKgogICAgICogQ29uc3RhbnQgc3BlY2lmeWluZyB0aGF0IG5vIG51bGwtdmFs\ndWUgd2FzIGdpdmVuLgogICAgICovCiAgICBwdWJsaWMgc3RhdGljIGZpbmFs\nIGludCBOVUxMX1VOU0VUID0gLTE7CgogICAgLyoqCiAgICAgKiBDb25zdGFu\ndCBzcGVjaWZ5aW5nIHRvIHVzZSBhIGRhdGFzdG9yZSBudWxsIHRvIHBlcnNp\nc3QgbnVsbCB2YWx1ZXMKICAgICAqIGluIG9iamVjdCBmaWVsZHMuCiAgICAg\nKi8KICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgaW50IE5VTExfTk9ORSA9IDA7\nCgogICAgLyoqCiAgICAgKiBDb25zdGFudCBzcGVjaWZ5aW5nIHRvIHVzZSBh\nIGRhdGFzdG9yZSBkZWZhdWx0IHZhbHVlIHRvIHBlcnNpc3QgbnVsbAogICAg\nICogdmFsdWVzIGluIG9iamVjdCBmaWVsZHMuCiAgICAgKi8KICAgIHB1Ymxp\nYyBzdGF0aWMgZmluYWwgaW50IE5VTExfREVGQVVMVCA9IDE7CgogICAgLyoq\nCiAgICAgKiBDb25zdGFudCBzcGVjaWZ5aW5nIHRvIHRocm93IGFuIGV4Y2Vw\ndGlvbiB3aGVuIGF0dGVtcHRpbmcgdG8gcGVyc2lzdAogICAgICogbnVsbCB2\nYWx1ZXMgaW4gb2JqZWN0IGZpZWxkcy4KICAgICAqLwogICAgcHVibGljIHN0\nYXRpYyBmaW5hbCBpbnQgTlVMTF9FWENFUFRJT04gPSAyOwoKICAgIC8qKgog\nICAgICogQ29uc3RhbnQgc3BlY2lmeWluZyB0aGUgbWFuYWdlbWVudCBsZXZl\nbCBvZiBhIGZpZWxkLgogICAgICovCiAgICBwdWJsaWMgc3RhdGljIGZpbmFs\nIGludCBNQU5BR0VfUEVSU0lTVEVOVCA9IDM7CgogICAgLyoqCiAgICAgKiBD\nb25zdGFudCBzcGVjaWZ5aW5nIHRoZSBtYW5hZ2VtZW50IGxldmVsIG9mIGEg\nZmllbGQuCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgaW50IE1B\nTkFHRV9UUkFOU0FDVElPTkFMID0gMTsKCiAgICAvKioKICAgICAqIENvbnN0\nYW50IHNwZWNpZnlpbmcgdGhlIG1hbmFnZW1lbnQgbGV2ZWwgb2YgYSBmaWVs\nZC4KICAgICAqLwogICAgcHVibGljIHN0YXRpYyBmaW5hbCBpbnQgTUFOQUdF\nX05PTkUgPSAwOwogICAgCiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIGludCBP\nTkVfVE9fT05FID0gMTsKICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgaW50IE9O\nRV9UT19NQU5ZID0gMjsKICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgaW50IE1B\nTllfVE9fT05FID0gMzsKICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgaW50IE1B\nTllfVE9fTUFOWSA9IDQ7CgogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgTG9j\nYWxpemVyIF9sb2MgPSBMb2NhbGl6ZXIuZm9yUGFja2FnZQogICAgICAgIChG\naWVsZE1ldGFEYXRhLmNsYXNzKTsKCiAgICBwcml2YXRlIHN0YXRpYyBmaW5h\nbCBpbnQgREZHX0ZBTFNFID0gMTsKICAgIHByaXZhdGUgc3RhdGljIGZpbmFs\nIGludCBERkdfVFJVRSA9IDI7CiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBp\nbnQgREZHX0VYUExJQ0lUID0gNDsKCiAgICBwcml2YXRlIHN0YXRpYyBmaW5h\nbCBNZXRob2QgREVGQVVMVF9NRVRIT0Q7CiAgICBzdGF0aWMgewogICAgICAg\nIHRyeSB7CiAgICAgICAgICAgIERFRkFVTFRfTUVUSE9EID0gT2JqZWN0LmNs\nYXNzLmdldE1ldGhvZCgid2FpdCIsIChDbGFzc1tdKSBudWxsKTsKICAgICAg\nICB9IGNhdGNoIChFeGNlcHRpb24gZSkgewogICAgICAgICAgICAvLyBzaG91\nbGRuJ3QgZXZlciBoYXBwZW4KICAgICAgICAgICAgdGhyb3cgbmV3IEludGVy\nbmFsRXhjZXB0aW9uKGUpOwogICAgICAgIH0KICAgIH0KCiAgICAvLyBuYW1l\nIGFuZCB0eXBlCiAgICBwcml2YXRlIGZpbmFsIFZhbHVlTWV0YURhdGEgX3Zh\nbDsKICAgIHByaXZhdGUgZmluYWwgVmFsdWVNZXRhRGF0YSBfa2V5OwogICAg\ncHJpdmF0ZSBmaW5hbCBWYWx1ZU1ldGFEYXRhIF9lbGVtOwogICAgcHJpdmF0\nZSBmaW5hbCBDbGFzc01ldGFEYXRhIF9vd25lcjsKICAgIHByaXZhdGUgZmlu\nYWwgU3RyaW5nIF9uYW1lOwogICAgcHJpdmF0ZSBDbGFzczw/PiBfZGVjID0g\nbnVsbDsKICAgIHByaXZhdGUgQ2xhc3NNZXRhRGF0YSBfZGVjTWV0YSA9IG51\nbGw7CiAgICBwcml2YXRlIFN0cmluZyBfZnVsbE5hbWUgPSBudWxsOwogICAg\ncHJpdmF0ZSBTdHJpbmcgX2VtYmVkRnVsbE5hbWUgPSBudWxsOwogICAgcHJp\ndmF0ZSBpbnQgX3Jlc01vZGUgPSBNT0RFX05PTkU7CiAgICBwcml2YXRlIFN0\ncmluZyBfbWFwcGVkQnlJZFZhbHVlID0gbnVsbDsKICAgIHByaXZhdGUgaW50\nIF9hY2Nlc3MgPSBBY2Nlc3NDb2RlLlVOS05PV047CgogICAgLy8gbG9hZC9z\ndG9yZSBpbmZvCiAgICBwcml2YXRlIFN0cmluZ1tdIF9jb21tZW50cyA9IG51\nbGw7CiAgICBwcml2YXRlIGludCBfbGlzdEluZGV4ID0gLTE7CgogICAgLy8v\nLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v\nLy8vLy8vLy8vLy8vLy8vLy8vLy8KICAgIC8vIE5vdGU6IGlmIHlvdSBhZGQg\nYWRkaXRpb25hbCBzdGF0ZSwgbWFrZSBzdXJlIHRvIGFkZCBpdCB0byBjb3B5\nKCkKICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v\nLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCgogICAgLy8gbWlzYyBp\nbmZvCiAgICBwcml2YXRlIENsYXNzPD8+IF9wcm94eUNsYXNzID0gbnVsbDsK\nICAgIHByaXZhdGUgT2JqZWN0IF9pbml0aWFsaXplciA9IG51bGw7CiAgICBw\ncml2YXRlIGJvb2xlYW4gX3RyYW5zaWVudCA9IGZhbHNlOwogICAgcHJpdmF0\nZSBib29sZWFuIF9wcmltS2V5ID0gZmFsc2U7CiAgICBwcml2YXRlIEJvb2xl\nYW4gX3ZlcnNpb24gPSBudWxsOwogICAgcHJpdmF0ZSBpbnQgX251bGxWYWx1\nZSA9IE5VTExfVU5TRVQ7CiAgICBwcml2YXRlIGludCBfbWFuYWdlID0gTUFO\nQUdFX1BFUlNJU1RFTlQ7CiAgICBwcml2YXRlIGludCBfaW5kZXggPSAtMTsK\nICAgIHByaXZhdGUgaW50IF9kZWNJbmRleCA9IC0xOwogICAgcHJpdmF0ZSBp\nbnQgX3BrSW5kZXggPSAtMTsKICAgIHByaXZhdGUgYm9vbGVhbiBfZXhwbGlj\naXQgPSBmYWxzZTsKICAgIHByaXZhdGUgaW50IF9kZmcgPSAwOwogICAgcHJp\ndmF0ZSBTZXQ8U3RyaW5nPiBfZmdTZXQgPSBudWxsOwogICAgcHJpdmF0ZSBT\ndHJpbmdbXSBfZmdzID0gbnVsbDsKICAgIHByaXZhdGUgU3RyaW5nICAgX2xm\nZyA9IG51bGw7CiAgICBwcml2YXRlIEJvb2xlYW4gX2xycyA9IG51bGw7CiAg\nICBwcml2YXRlIEJvb2xlYW4gX3N0cmVhbSA9IG51bGw7CiAgICBwcml2YXRl\nIFN0cmluZyBfZXh0TmFtZSA9IG51bGw7CiAgICBwcml2YXRlIFN0cmluZyBf\nZmFjdE5hbWUgPSBudWxsOwogICAgcHJpdmF0ZSBTdHJpbmcgX2V4dFN0cmlu\nZyA9IG51bGw7CiAgICBwcml2YXRlIE1hcCBfZXh0VmFsdWVzID0gQ29sbGVj\ndGlvbnMuRU1QVFlfTUFQOwogICAgcHJpdmF0ZSBNYXAgX2ZpZWxkVmFsdWVz\nID0gQ29sbGVjdGlvbnMuRU1QVFlfTUFQOwogICAgcHJpdmF0ZSBCb29sZWFu\nIF9lbnVtRmllbGQgPSBudWxsOwogICAgcHJpdmF0ZSBCb29sZWFuIF9sb2JG\naWVsZCA9IG51bGw7CiAgICBwcml2YXRlIEJvb2xlYW4gX3NlcmlhbGl6YWJs\nZUZpZWxkID0gbnVsbDsKICAgIHByaXZhdGUgYm9vbGVhbiBfZ2VuZXJhdGVk\nID0gZmFsc2U7CgogICAgLy8gTWVtYmVycyBhcmVuJ3Qgc2VyaWFsaXphYmxl\nLiBVc2UgYSBwcm94eSB0aGF0IGNhbiBwcm92aWRlIGEgTWVtYmVyCiAgICAv\nLyB0byBhdm9pZCB3cml0aW5nIHRoZSBmdWxsIEV4dGVybmFsaXphYmxlIGlt\ncGxlbWVudGF0aW9uLgogICAgcHJpdmF0ZSBNZW1iZXJQcm92aWRlciBfYmFj\na2luZ01lbWJlciA9IG51bGw7CgogICAgLy8gTWVtYmVycyBhcmVuJ3Qgc2Vy\naWFsaXphYmxlLiBJbml0aWFsaXppbmcgX2V4dE1ldGhvZCBhbmQgX2ZhY3RN\nZXRob2QgdG8KICAgIC8vIERFRkFVTFRfTUVUSE9EIGlzIHN1ZmZpY2llbnQg\ndG8gdHJpZ2dlciBsYXp5IHBvcHVsYXRpb24gb2YgdGhlc2UgZmllbGRzLgog\nICAgcHJpdmF0ZSB0cmFuc2llbnQgTWV0aG9kIF9leHRNZXRob2QgPSBERUZB\nVUxUX01FVEhPRDsKICAgIHByaXZhdGUgdHJhbnNpZW50IE1lbWJlciBfZmFj\ndE1ldGhvZCA9IERFRkFVTFRfTUVUSE9EOwoKICAgIC8vIGludGVybWVkaWF0\nZSBhbmQgaW1wbCBkYXRhCiAgICBwcml2YXRlIGJvb2xlYW4gX2ludGVybWVk\naWF0ZSA9IHRydWU7CiAgICBwcml2YXRlIEJvb2xlYW4gX2ltcGxEYXRhID0g\nQm9vbGVhbi5UUlVFOwoKICAgIC8vIHZhbHVlIGdlbmVyYXRpb24KICAgIHBy\naXZhdGUgaW50IF92YWxTdHJhdGVneSA9IC0xOwogICAgcHJpdmF0ZSBpbnQg\nX3VwU3RyYXRlZ3kgPSAtMTsKICAgIHByaXZhdGUgU3RyaW5nIF9zZXFOYW1l\nID0gQ2xhc3NNZXRhRGF0YS5ERUZBVUxUX1NUUklORzsKICAgIHByaXZhdGUg\nU2VxdWVuY2VNZXRhRGF0YSBfc2VxTWV0YSA9IG51bGw7CgogICAgLy8gaW52\nZXJzZXMKICAgIHByaXZhdGUgU3RyaW5nIF9tYXBwZWRCeSA9IG51bGw7CiAg\nICBwcml2YXRlIEZpZWxkTWV0YURhdGEgX21hcHBlZEJ5TWV0YSA9IG51bGw7\nCiAgICBwcml2YXRlIEZpZWxkTWV0YURhdGFbXSBfaW52ZXJzZXMgPSBudWxs\nOwogICAgcHJpdmF0ZSBTdHJpbmcgX2ludmVyc2UgPSBDbGFzc01ldGFEYXRh\nLkRFRkFVTFRfU1RSSU5HOwoKICAgIC8vIG9yZGVyaW5nIG9uIGxvYWQKICAg\nIHByaXZhdGUgT3JkZXJbXSBfb3JkZXJzID0gbnVsbDsKICAgIHByaXZhdGUg\nU3RyaW5nIF9vcmRlckRlYyA9IG51bGw7CiAgICAvLyBpbmRpY2F0ZSBpZiB0\naGlzIGZpZWxkIGlzIHVzZWQgYnkgb3RoZXIgZmllbGQgYXMgIm9yZGVyIGJ5\nIiB2YWx1ZSAKICAgIHByaXZhdGUgYm9vbGVhbiBfdXNlZEluT3JkZXJCeSA9\nIGZhbHNlOwogICAgcHJpdmF0ZSBib29sZWFuIF9pc0VsZW1lbnRDb2xsZWN0\naW9uID0gZmFsc2U7CiAgICBwcml2YXRlIGludCBfYXNzb2NpYXRpb25UeXBl\nOwoKICAgIC8qKgogICAgICogQ29uc3RydWN0b3IuCiAgICAgKgogICAgICog\nQHBhcmFtIG5hbWUgdGhlIGZpZWxkIG5hbWUKICAgICAqIEBwYXJhbSB0eXBl\nIHRoZSBmaWVsZCB0eXBlCiAgICAgKiBAcGFyYW0gb3duZXIgdGhlIG93bmlu\nZyBjbGFzcyBtZXRhZGF0YQogICAgICovCiAgICBwcm90ZWN0ZWQgRmllbGRN\nZXRhRGF0YShTdHJpbmcgbmFtZSwgQ2xhc3M8Pz4gdHlwZSwgQ2xhc3NNZXRh\nRGF0YSBvd25lcikgewogICAgICAgIF9uYW1lID0gbmFtZTsKICAgICAgICBf\nb3duZXIgPSBvd25lcjsKICAgICAgICBfZGVjID0gbnVsbDsKICAgICAgICBf\nZGVjTWV0YSA9IG51bGw7CiAgICAgICAgX3ZhbCA9IG93bmVyLmdldFJlcG9z\naXRvcnkoKS5uZXdWYWx1ZU1ldGFEYXRhKHRoaXMpOwogICAgICAgIF9rZXkg\nPSBvd25lci5nZXRSZXBvc2l0b3J5KCkubmV3VmFsdWVNZXRhRGF0YSh0aGlz\nKTsKICAgICAgICBfZWxlbSA9IG93bmVyLmdldFJlcG9zaXRvcnkoKS5uZXdW\nYWx1ZU1ldGFEYXRhKHRoaXMpOwoKICAgICAgICBzZXREZWNsYXJlZFR5cGUo\ndHlwZSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBTdXBwbHkgdGhlIGJhY2tp\nbmcgbWVtYmVyIG9iamVjdDsgdGhpcyBhbGxvd3MgdXMgdG8gdXRpbGl6ZQog\nICAgICogcGFyYW1ldGVyaXplZCB0eXBlIGluZm9ybWF0aW9uIGlmIGF2YWls\nYWJsZS4KICAgICAqIFNldHMgdGhlIGFjY2VzcyBzdHlsZSBvZiB0aGlzIHJl\nY2VpdmVyIGJhc2VkIG9uIHdoZXRoZXIgdGhlIGdpdmVuIAogICAgICogbWVt\nYmVyIHJlcHJlc2VudHMgYSBmaWVsZCBvciBnZXR0ZXIgbWV0aG9kLgogICAg\nICovCiAgICBwdWJsaWMgdm9pZCBiYWNraW5nTWVtYmVyKE1lbWJlciBtZW1i\nZXIpIHsKICAgICAgICBpZiAobWVtYmVyID09IG51bGwpCiAgICAgICAgICAg\nIHJldHVybjsKICAgICAgICBpZiAoTW9kaWZpZXIuaXNUcmFuc2llbnQobWVt\nYmVyLmdldE1vZGlmaWVycygpKSkKICAgICAgICAgICAgX3RyYW5zaWVudCA9\nIHRydWU7CgogICAgICAgIF9iYWNraW5nTWVtYmVyID0gbmV3IE1lbWJlclBy\nb3ZpZGVyKG1lbWJlcik7CgogICAgICAgIENsYXNzPD8+IHR5cGU7CiAgICAg\nICAgQ2xhc3M8Pz5bXSB0eXBlczsKICAgICAgICBpZiAobWVtYmVyIGluc3Rh\nbmNlb2YgRmllbGQpIHsKICAgICAgICAgICAgRmllbGQgZiA9IChGaWVsZCkg\nbWVtYmVyOwogICAgICAgICAgICB0eXBlID0gZi5nZXRUeXBlKCk7CiAgICAg\nICAgICAgIHR5cGVzID0gSmF2YVZlcnNpb25zLmdldFBhcmFtZXRlcml6ZWRU\neXBlcyhmKTsKICAgICAgICAgICAgc2V0QWNjZXNzVHlwZShBY2Nlc3NDb2Rl\nLkZJRUxEKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBNZXRob2Qg\nbWV0aCA9IChNZXRob2QpIG1lbWJlcjsKICAgICAgICAgICAgdHlwZSA9IG1l\ndGguZ2V0UmV0dXJuVHlwZSgpOwogICAgICAgICAgICB0eXBlcyA9IEphdmFW\nZXJzaW9ucy5nZXRQYXJhbWV0ZXJpemVkVHlwZXMobWV0aCk7CiAgICAgICAg\nICAgIHNldEFjY2Vzc1R5cGUoQWNjZXNzQ29kZS5QUk9QRVJUWSk7CiAgICAg\nICAgfQoKICAgICAgICBzZXREZWNsYXJlZFR5cGUodHlwZSk7CiAgICAgICAg\naWYgKENvbGxlY3Rpb24uY2xhc3MuaXNBc3NpZ25hYmxlRnJvbSh0eXBlKQog\nICAgICAgICAgICAmJiBfZWxlbS5nZXREZWNsYXJlZFR5cGUoKSA9PSBPYmpl\nY3QuY2xhc3MKICAgICAgICAgICAgJiYgdHlwZXMubGVuZ3RoID09IDEpIHsK\nICAgICAgICAgICAgX2VsZW0uc2V0RGVjbGFyZWRUeXBlKHR5cGVzWzBdKTsK\nICAgICAgICB9IGVsc2UgaWYgKE1hcC5jbGFzcy5pc0Fzc2lnbmFibGVGcm9t\nKHR5cGUpCiAgICAgICAgICAgICYmIHR5cGVzLmxlbmd0aCA9PSAyKSB7CiAg\nICAgICAgICAgIGlmIChfa2V5LmdldERlY2xhcmVkVHlwZSgpID09IE9iamVj\ndC5jbGFzcykKICAgICAgICAgICAgICAgIF9rZXkuc2V0RGVjbGFyZWRUeXBl\nKHR5cGVzWzBdKTsKICAgICAgICAgICAgaWYgKF9lbGVtLmdldERlY2xhcmVk\nVHlwZSgpID09IE9iamVjdC5jbGFzcykKICAgICAgICAgICAgICAgIF9lbGVt\nLnNldERlY2xhcmVkVHlwZSh0eXBlc1sxXSk7CiAgICAgICAgfQogICAgfQoK\nICAgIC8qKgogICAgICogUmV0dXJuIHRoZSBiYWNraW5nIG1lbWJlciBzdXBw\nbGllZCBpbiB7QGxpbmsgI2JhY2tpbmdNZW1iZXJ9LgogICAgICovCiAgICBw\ndWJsaWMgTWVtYmVyIGdldEJhY2tpbmdNZW1iZXIoKSB7CiAgICAgICAgcmV0\ndXJuIChfYmFja2luZ01lbWJlciA9PSBudWxsKSA/IG51bGwgOiBfYmFja2lu\nZ01lbWJlci5nZXRNZW1iZXIoKTsKICAgIH0KCiAgICAvKioKICAgICAqIFRo\nZSBtZXRhZGF0YSByZXBvc2l0b3J5LgogICAgICovCiAgICBwdWJsaWMgTWV0\nYURhdGFSZXBvc2l0b3J5IGdldFJlcG9zaXRvcnkoKSB7CiAgICAgICAgcmV0\ndXJuIF9vd25lci5nZXRSZXBvc2l0b3J5KCk7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBUaGUgY2xhc3MgdGhhdCBkZWZpbmVzIHRoZSBtZXRhZGF0YSBmb3Ig\ndGhpcyBmaWVsZC4KICAgICAqLwogICAgcHVibGljIENsYXNzTWV0YURhdGEg\nZ2V0RGVmaW5pbmdNZXRhRGF0YSgpIHsKICAgICAgICByZXR1cm4gX293bmVy\nOwogICAgfQoKICAgIC8qKgogICAgICogVGhlIGRlY2xhcmluZyBjbGFzcy4K\nICAgICAqLwogICAgcHVibGljIENsYXNzIGdldERlY2xhcmluZ1R5cGUoKSB7\nCiAgICAgICAgcmV0dXJuIChfZGVjID09IG51bGwpID8gX293bmVyLmdldERl\nc2NyaWJlZFR5cGUoKSA6IF9kZWM7CiAgICB9CgogICAgLyoqCiAgICAgKiBU\naGUgZGVjbGFyaW5nIGNsYXNzLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBz\nZXREZWNsYXJpbmdUeXBlKENsYXNzPD8+IGNscykgewogICAgICAgIF9kZWMg\nPSBjbHM7CiAgICAgICAgX2RlY01ldGEgPSBudWxsOwogICAgICAgIF9mdWxs\nTmFtZSA9IG51bGw7CiAgICAgICAgX2VtYmVkRnVsbE5hbWUgPSBudWxsOwog\nICAgfQoKICAgIC8qKgogICAgICogVGhlIGRlY2xhcmluZyBjbGFzcy4KICAg\nICAqLwogICAgcHVibGljIENsYXNzTWV0YURhdGEgZ2V0RGVjbGFyaW5nTWV0\nYURhdGEoKSB7CiAgICAgICAgaWYgKF9kZWMgPT0gbnVsbCkKICAgICAgICAg\nICAgcmV0dXJuIF9vd25lcjsKICAgICAgICBpZiAoX2RlY01ldGEgPT0gbnVs\nbCkKICAgICAgICAgICAgX2RlY01ldGEgPSBnZXRSZXBvc2l0b3J5KCkuZ2V0\nTWV0YURhdGEoX2RlYywKICAgICAgICAgICAgICAgIF9vd25lci5nZXRFbnZD\nbGFzc0xvYWRlcigpLCB0cnVlKTsKICAgICAgICByZXR1cm4gX2RlY01ldGE7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBUaGUgZmllbGQgbmFtZS4KICAgICAq\nLwogICAgcHVibGljIFN0cmluZyBnZXROYW1lKCkgewogICAgICAgIHJldHVy\nbiBfbmFtZTsKICAgIH0KCiAgICAvKioKICAgICAqIFRoZSBmaWVsZCBuYW1l\nLCBxdWFsaWZpZWQgYnkgdGhlIG93bmluZyBjbGFzcy4KICAgICAqIEBkZXBy\nZWNhdGVkIFVzZSBnZXRGdWxsTmFtZShib29sZWFuKSBpbnN0ZWFkLgogICAg\nICovCiAgICBwdWJsaWMgU3RyaW5nIGdldEZ1bGxOYW1lKCkgewogICAgICAg\nIHJldHVybiBnZXRGdWxsTmFtZShmYWxzZSk7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBUaGUgZmllbGQgbmFtZSwgcXVhbGlmaWVkIGJ5IHRoZSBvd25pbmcg\nY2xhc3MgYW5kIG9wdGlvbmFsbHkgdGhlCiAgICAgKiBlbWJlZGRpbmcgb3du\nZXIncyBuYW1lIChpZiBhbnkpLgogICAgICovCiAgICBwdWJsaWMgU3RyaW5n\nIGdldEZ1bGxOYW1lKGJvb2xlYW4gZW1iZWRPd25lcikgewogICAgICAgIGlm\nIChfZnVsbE5hbWUgPT0gbnVsbCkKICAgICAgICAgICAgX2Z1bGxOYW1lID0g\nZ2V0RGVjbGFyaW5nVHlwZSgpLmdldE5hbWUoKSArICIuIiArIF9uYW1lOwog\nICAgICAgIGlmIChlbWJlZE93bmVyICYmIF9lbWJlZEZ1bGxOYW1lID09IG51\nbGwpIHsKICAgICAgICAgICAgaWYgKF9vd25lci5nZXRFbWJlZGRpbmdNZXRh\nRGF0YSgpID09IG51bGwpCiAgICAgICAgICAgICAgICBfZW1iZWRGdWxsTmFt\nZSA9IF9mdWxsTmFtZTsKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAg\nICAgX2VtYmVkRnVsbE5hbWUgPSBfb3duZXIuZ2V0RW1iZWRkaW5nTWV0YURh\ndGEoKS4KICAgICAgICAgICAgICAgICAgICBnZXRGaWVsZE1ldGFEYXRhKCku\nZ2V0RnVsbE5hbWUodHJ1ZSkgKyAiLiIgKyBfZnVsbE5hbWU7CiAgICAgICAg\nfQogICAgICAgIHJldHVybiAoZW1iZWRPd25lcikgPyBfZW1iZWRGdWxsTmFt\nZSA6IF9mdWxsTmFtZTsKICAgIH0KCiAgICAvKioKICAgICAqIFRoZSBmaWVs\nZCBuYW1lLCBxdWFsaWZpZWQgYnkgdGhlIGRlZmluaW5nIGNsYXNzLgogICAg\nICovCiAgICBwdWJsaWMgU3RyaW5nIGdldFJlYWxOYW1lKCkgewogICAgCS8v\nIEFkZGVkIHRvIHN1cHBvcnQgT1BFTkpQQS03MDQKICAgICAgICByZXR1cm4g\nZ2V0RGVmaW5pbmdNZXRhRGF0YSgpLmdldERlc2NyaWJlZFR5cGUoKS5nZXRO\nYW1lKCkgKyAiLiIgKyBfbmFtZTsKICAgIH0KCiAgICAvKioKICAgICAqIE1l\ndGFEYXRhIGFib3V0IHRoZSBmaWVsZCB2YWx1ZS4KICAgICAqLwogICAgcHVi\nbGljIFZhbHVlTWV0YURhdGEgZ2V0VmFsdWUoKSB7CiAgICAgICAgcmV0dXJu\nIF92YWw7CiAgICB9CgogICAgLyoqCiAgICAgKiBNZXRhZGF0YSBhYm91dCB0\naGUga2V5IHZhbHVlLgogICAgICovCiAgICBwdWJsaWMgVmFsdWVNZXRhRGF0\nYSBnZXRLZXkoKSB7CiAgICAgICAgcmV0dXJuIF9rZXk7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBNZXRhZGF0YSBhYm91dCB0aGUgZWxlbWVudCB2YWx1ZS4K\nICAgICAqLwogICAgcHVibGljIFZhbHVlTWV0YURhdGEgZ2V0RWxlbWVudCgp\nIHsKICAgICAgICByZXR1cm4gX2VsZW07CiAgICB9CgogICAgLyoqCiAgICAg\nKiBSZXR1cm4gd2hldGhlciB0aGlzIGZpZWxkIGlzIG1hcHBlZCB0byB0aGUg\nZGF0YXN0b3JlLiBCeSBkZWZhdWx0LAogICAgICogcmV0dXJucyB0cnVlIGZv\nciBhbGwgcGVyc2lzdGVudCBmaWVsZHMgd2hvc2UgZGVmaW5pbmcgY2xhc3Mg\naXMgbWFwcGVkLgogICAgICovCiAgICBwdWJsaWMgYm9vbGVhbiBpc01hcHBl\nZCgpIHsKICAgICAgICByZXR1cm4gX21hbmFnZSA9PSBNQU5BR0VfUEVSU0lT\nVEVOVCAmJiBfb3duZXIuaXNNYXBwZWQoKTsKICAgIH0KCiAgICAvKioKICAg\nICAqIFRoZSB0eXBlIHRoaXMgZmllbGQgd2FzIGluaXRpYWxpemVkIHdpdGgs\nIGFuZCB0aGVyZWZvcmUgdGhlCiAgICAgKiB0eXBlIHRvIHVzZSBmb3IgcHJv\neGllcyB3aGVuIGxvYWRpbmcgZGF0YSBpbnRvIHRoaXMgZmllbGQuCiAgICAg\nKi8KICAgIHB1YmxpYyBDbGFzczw/PiBnZXRQcm94eVR5cGUoKSB7CiAgICAg\nICAgcmV0dXJuIChfcHJveHlDbGFzcyA9PSBudWxsKSA/IGdldERlY2xhcmVk\nVHlwZSgpIDogX3Byb3h5Q2xhc3M7CiAgICB9CgogICAgLyoqCiAgICAgKiBU\naGUgdHlwZSB0aGlzIGZpZWxkIHdhcyBpbml0aWFsaXplZCB3aXRoLCBhbmQg\ndGhlcmVmb3JlIHRoZQogICAgICogdHlwZSB0byB1c2UgZm9yIHByb3hpZXMg\nd2hlbiBsb2FkaW5nIGRhdGEgaW50byB0aGlzIGZpZWxkLgogICAgICovCiAg\nICBwdWJsaWMgdm9pZCBzZXRQcm94eVR5cGUoQ2xhc3M8Pz4gdHlwZSkgewog\nICAgICAgIF9wcm94eUNsYXNzID0gdHlwZTsKICAgIH0KCiAgICAvKioKICAg\nICAqIFRoZSBpbml0aWFsaXplciB1c2VkIGJ5IHRoZSBmaWVsZCwgb3IgbnVs\nbCBpZiBub25lLiBUaGlzCiAgICAgKiBpcyBhZGRpdGlvbmFsIGluZm9ybWF0\naW9uIGZvciBpbml0aWFsaXppbmcgdGhlIGZpZWxkLCBzdWNoIGFzCiAgICAg\nKiBhIGN1c3RvbSB7QGxpbmsgQ29tcGFyYXRvcn0gdXNlZCBieSBhIHtAbGlu\nayBTZXR9IG9yCiAgICAgKiBhIHtAbGluayBUaW1lWm9uZX0gdXNlZCBieSBh\nIHtAbGluayBDYWxlbmRhcn0uCiAgICAgKi8KICAgIHB1YmxpYyBPYmplY3Qg\nZ2V0SW5pdGlhbGl6ZXIoKSB7CiAgICAgICAgcmV0dXJuIF9pbml0aWFsaXpl\ncjsKICAgIH0KCiAgICAvKioKICAgICAqIFRoZSBpbml0aWFsaXplciB1c2Vk\nIGJ5IHRoZSBmaWVsZCwgb3IgbnVsbCBpZiBub25lLiBUaGlzCiAgICAgKiBp\ncyBhZGRpdGlvbmFsIGluZm9ybWF0aW9uIGZvciBpbml0aWFsaXppbmcgdGhl\nIGZpZWxkLCBzdWNoIGFzCiAgICAgKiBhIGN1c3RvbSB7QGxpbmsgQ29tcGFy\nYXRvcn0gdXNlZCBieSBhIHtAbGluayBTZXR9IG9yCiAgICAgKiBhIHtAbGlu\nayBUaW1lWm9uZX0gdXNlZCBieSBhIHtAbGluayBDYWxlbmRhcn0uCiAgICAg\nKi8KICAgIHB1YmxpYyB2b2lkIHNldEluaXRpYWxpemVyKE9iamVjdCBpbml0\naWFsaXplcikgewogICAgICAgIF9pbml0aWFsaXplciA9IGluaXRpYWxpemVy\nOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHdoZXRoZXIgdGhpcyBp\ncyBhIHRyYW5zaWVudCBmaWVsZC4KICAgICAqLwogICAgcHVibGljIGJvb2xl\nYW4gaXNUcmFuc2llbnQoKSB7CiAgICAgICAgcmV0dXJuIF90cmFuc2llbnQ7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gd2hldGhlciB0aGlzIGlz\nIGEgdHJhbnNpZW50IGZpZWxkLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBz\nZXRUcmFuc2llbnQoYm9vbGVhbiB0cmFucykgewogICAgICAgIF90cmFuc2ll\nbnQgPSB0cmFuczsKICAgIH0KCiAgICAvKioKICAgICAqIFRoZSBhYnNvbHV0\nZSBpbmRleCBvZiB0aGlzIHBlcnNpc3RlbnQvdHJhbnNhY3Rpb25hbCBmaWVs\nZC4KICAgICAqLwogICAgcHVibGljIGludCBnZXRJbmRleCgpIHsKICAgICAg\nICByZXR1cm4gX2luZGV4OwogICAgfQoKICAgIC8qKgogICAgICogVGhlIGFi\nc29sdXRlIGluZGV4IG9mIHRoaXMgcGVyc2lzdGVudC90cmFuc2FjdGlvbmFs\nIGZpZWxkLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRJbmRleChpbnQg\naW5kZXgpIHsKICAgICAgICBfaW5kZXggPSBpbmRleDsKICAgIH0KCiAgICAv\nKioKICAgICAqIFRoZSByZWxhdGl2ZSBpbmRleCBvZiB0aGlzIHBlcnNpc3Rl\nbnQvdHJhbnNhY3Rpb25hbCBmaWVsZC4KICAgICAqLwogICAgcHVibGljIGlu\ndCBnZXREZWNsYXJlZEluZGV4KCkgewogICAgICAgIHJldHVybiBfZGVjSW5k\nZXg7CiAgICB9CgogICAgLyoqCiAgICAgKiBUaGUgcmVsYXRpdmUgaW5kZXgg\nb2YgdGhpcyBwZXJzaXN0ZW50L3RyYW5zYWN0aW9uYWwgZmllbGQuCiAgICAg\nKi8KICAgIHB1YmxpYyB2b2lkIHNldERlY2xhcmVkSW5kZXgoaW50IGluZGV4\nKSB7CiAgICAgICAgX2RlY0luZGV4ID0gaW5kZXg7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBUaGUgaW5kZXggaW4gd2hpY2ggdGhpcyBmaWVsZCB3YXMgbGlz\ndGVkIGluIHRoZSBtZXRhZGF0YS4gRGVmYXVsdHMgdG8KICAgICAqIDxjb2Rl\nPi0xPC9jb2RlPiBpZiB0aGlzIGZpZWxkIHdhcyBub3QgbGlzdGVkIGluIHRo\nZSBtZXRhZGF0YS4KICAgICAqLwogICAgcHVibGljIGludCBnZXRMaXN0aW5n\nSW5kZXgoKSB7CiAgICAgICAgcmV0dXJuIF9saXN0SW5kZXg7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBUaGUgaW5kZXggaW4gd2hpY2ggdGhpcyBmaWVsZCB3\nYXMgbGlzdGVkIGluIHRoZSBtZXRhZGF0YS4gRGVmYXVsdHMgdG8KICAgICAq\nIDxjb2RlPi0xPC9jb2RlPiBpZiB0aGlzIGZpZWxkIHdhcyBub3QgbGlzdGVk\nIGluIHRoZSBtZXRhZGF0YS4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0\nTGlzdGluZ0luZGV4KGludCBpbmRleCkgewogICAgICAgIF9saXN0SW5kZXgg\nPSBpbmRleDsKICAgIH0KCiAgICAvKioKICAgICAqIFRoZSBhYnNvbHV0ZSBw\ncmltYXJ5IGtleSBpbmRleCBmb3IgdGhpcyBmaWVsZCwgb3IgLTEgaWYgbm90\nIGEgcHJpbWFyeQogICAgICoga2V5LiBUaGUgZmlyc3QgcHJpbWFyeSBrZXkg\nZmllbGQgaGFzIGluZGV4IDAsIHRoZSBzZWNvbmQgaW5kZXggMSwgZXRjLgog\nICAgICovCiAgICBwdWJsaWMgaW50IGdldFByaW1hcnlLZXlJbmRleCgpIHsK\nICAgICAgICByZXR1cm4gX3BrSW5kZXg7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBUaGUgYWJzb2x1dGUgcHJpbWFyeSBrZXkgaW5kZXggZm9yIHRoaXMgZmll\nbGQsIG9yIC0xIGlmIG5vdCBhIHByaW1hcnkKICAgICAqIGtleS4gVGhlIGZp\ncnN0IHByaW1hcnkga2V5IGZpZWxkIGhhcyBpbmRleCAwLCB0aGUgc2Vjb25k\nIGluZGV4IDEsIGV0Yy4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0UHJp\nbWFyeUtleUluZGV4KGludCBpbmRleCkgewogICAgICAgIF9wa0luZGV4ID0g\naW5kZXg7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIG1hbmFn\nZW1lbnQgbGV2ZWwgZm9yIHRoZSBmaWVsZC4gV2lsbCBiZSBvbmUgb2Y6CiAg\nICAgKiA8dWw+CiAgICAgKiA8bGk+e0BsaW5rICNNQU5BR0VfUEVSU0lTVEVO\nVH06IHRoZSBmaWVsZCBpcyBwZXJzaXN0ZW50PC9saT4KICAgICAqIDxsaT57\nQGxpbmsgI01BTkFHRV9UUkFOU0FDVElPTkFMfTogdGhlIGZpZWxkIGlzIHRy\nYW5zYWN0aW9uYWwgYnV0IG5vdAogICAgICogcGVyc2lzdGVudDwvbGk+CiAg\nICAgKiA8bGk+e0BsaW5rICNNQU5BR0VfTk9ORX06IHRoZSBmaWVsZCBpcyBu\nb3QgbWFuYWdlZDwvbGk+CiAgICAgKiA8L3VsPiBEZWZhdWx0cyB0byB7QGxp\nbmsgI01BTkFHRV9QRVJTSVNURU5UfS4KICAgICAqLwogICAgcHVibGljIGlu\ndCBnZXRNYW5hZ2VtZW50KCkgewogICAgICAgIHJldHVybiBfbWFuYWdlOwog\nICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRoZSBtYW5hZ2VtZW50IGxl\ndmVsIGZvciB0aGUgZmllbGQuIFdpbGwgYmUgb25lIG9mOgogICAgICogPHVs\nPgogICAgICogPGxpPntAbGluayAjTUFOQUdFX1BFUlNJU1RFTlR9OiB0aGUg\nZmllbGQgaXMgcGVyc2lzdGVudDwvbGk+CiAgICAgKiA8bGk+e0BsaW5rICNN\nQU5BR0VfVFJBTlNBQ1RJT05BTH06IHRoZSBmaWVsZCBpcyB0cmFuc2FjdGlv\nbmFsIGJ1dCBub3QKICAgICAqIHBlcnNpc3RlbnQ8L2xpPgogICAgICogPGxp\nPntAbGluayAjTUFOQUdFX05PTkV9OiB0aGUgZmllbGQgaXMgbm90IG1hbmFn\nZWQ8L2xpPgogICAgICogPC91bD4gCiAgICAgKiBEZWZhdWx0cyB0byB7QGxp\nbmsgI01BTkFHRV9QRVJTSVNURU5UfS4KICAgICAqLwogICAgcHVibGljIHZv\naWQgc2V0TWFuYWdlbWVudChpbnQgbWFuYWdlKSB7CiAgICAgICAgaWYgKChf\nbWFuYWdlID09IE1BTkFHRV9OT05FKSAhPSAobWFuYWdlID09IE1BTkFHRV9O\nT05FKSkKICAgICAgICAgICAgX293bmVyLmNsZWFyRmllbGRDYWNoZSgpOwog\nICAgICAgIF9tYW5hZ2UgPSBtYW5hZ2U7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBXaGV0aGVyIHRoaXMgaXMgYSBwcmltYXJ5IGtleSBmaWVsZC4KICAgICAq\nLwogICAgcHVibGljIGJvb2xlYW4gaXNQcmltYXJ5S2V5KCkgewogICAgICAg\nIHJldHVybiBfcHJpbUtleTsKICAgIH0KCiAgICAvKioKICAgICAqIFdoZXRo\nZXIgdGhpcyBpcyBhIHByaW1hcnkga2V5IGZpZWxkLgogICAgICovCiAgICBw\ndWJsaWMgdm9pZCBzZXRQcmltYXJ5S2V5KGJvb2xlYW4gcHJpbUtleSkgewog\nICAgICAgIF9wcmltS2V5ID0gcHJpbUtleTsKICAgIH0KCiAgICAvKioKICAg\nICAqIEZvciBhIHByaW1hcnkga2V5IGZpZWxkLCByZXR1cm4gdGhlIHR5cGUg\nb2YgdGhlIGNvcnJlc3BvbmRpbmcgb2JqZWN0IGlkIAogICAgICogY2xhc3Mg\nZmllbGQuCiAgICAgKi8KICAgIHB1YmxpYyBpbnQgZ2V0T2JqZWN0SWRGaWVs\nZFR5cGVDb2RlKCkgewogICAgICAgIENsYXNzTWV0YURhdGEgcmVsbWV0YSA9\nIGdldERlY2xhcmVkVHlwZU1ldGFEYXRhKCk7CiAgICAgICAgaWYgKHJlbG1l\ndGEgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIGdldERlY2xhcmVkVHlw\nZUNvZGUoKTsKICAgICAgICBpZiAocmVsbWV0YS5nZXRJZGVudGl0eVR5cGUo\nKSA9PSBDbGFzc01ldGFEYXRhLklEX0RBVEFTVE9SRSkgewogICAgICAgICAg\nICBib29sZWFuIHVud3JhcCA9IGdldFJlcG9zaXRvcnkoKS5nZXRNZXRhRGF0\nYUZhY3RvcnkoKS5nZXREZWZhdWx0cygpLgogICAgICAgICAgICAgICAgaXNE\nYXRhU3RvcmVPYmplY3RJZEZpZWxkVW53cmFwcGVkKCk7CiAgICAgICAgICAg\nIHJldHVybiAodW53cmFwKSA/IEphdmFUeXBlcy5MT05HIDogSmF2YVR5cGVz\nLk9CSkVDVDsKICAgICAgICB9CiAgICAgICAgaWYgKHJlbG1ldGEuaXNPcGVu\nSlBBSWRlbnRpdHkoKSkKICAgICAgICAgICAgcmV0dXJuIHJlbG1ldGEuZ2V0\nUHJpbWFyeUtleUZpZWxkcygpWzBdLmdldE9iamVjdElkRmllbGRUeXBlQ29k\nZSgpOwogICAgICAgIHJldHVybiBKYXZhVHlwZXMuT0JKRUNUOwogICAgfQoK\nICAgIC8qKgogICAgICogRm9yIGEgcHJpbWFyeSBrZXkgZmllbGQsIHJldHVy\nbiB0aGUgdHlwZSBvZiB0aGUgY29ycmVzcG9uZGluZyBvYmplY3QgaWQgCiAg\nICAgKiBjbGFzcyBmaWVsZC4KICAgICAqLwogICAgcHVibGljIENsYXNzPD8+\nIGdldE9iamVjdElkRmllbGRUeXBlKCkgewogICAgICAgIENsYXNzTWV0YURh\ndGEgcmVsbWV0YSA9IGdldERlY2xhcmVkVHlwZU1ldGFEYXRhKCk7CiAgICAg\nICAgaWYgKHJlbG1ldGEgPT0gbnVsbCB8fCBnZXRWYWx1ZSgpLmlzRW1iZWRk\nZWQoKSkKICAgICAgICAgICAgcmV0dXJuIGdldERlY2xhcmVkVHlwZSgpOwog\nICAgICAgIHN3aXRjaCAocmVsbWV0YS5nZXRJZGVudGl0eVR5cGUoKSkgewog\nICAgICAgICAgICBjYXNlIENsYXNzTWV0YURhdGEuSURfREFUQVNUT1JFOgog\nICAgICAgICAgICAgICAgYm9vbGVhbiB1bndyYXAgPSBnZXRSZXBvc2l0b3J5\nKCkuZ2V0TWV0YURhdGFGYWN0b3J5KCkuCiAgICAgICAgICAgICAgICAgICAg\nZ2V0RGVmYXVsdHMoKS5pc0RhdGFTdG9yZU9iamVjdElkRmllbGRVbndyYXBw\nZWQoKTsKICAgICAgICAgICAgICAgIHJldHVybiAodW53cmFwKSA/IGxvbmcu\nY2xhc3MgOiBPYmplY3QuY2xhc3M7CiAgICAgICAgICAgIGNhc2UgQ2xhc3NN\nZXRhRGF0YS5JRF9BUFBMSUNBVElPTjoKICAgICAgICAgICAgICAgIGlmIChy\nZWxtZXRhLmlzT3BlbkpQQUlkZW50aXR5KCkpCiAgICAgICAgICAgICAgICAg\nICAgcmV0dXJuIHJlbG1ldGEuZ2V0UHJpbWFyeUtleUZpZWxkcygpWzBdLgog\nICAgICAgICAgICAgICAgICAgICAgICBnZXRPYmplY3RJZEZpZWxkVHlwZSgp\nOwogICAgICAgICAgICAgICAgcmV0dXJuIChyZWxtZXRhLmdldE9iamVjdElk\nVHlwZSgpID09IG51bGwpID8gT2JqZWN0LmNsYXNzCiAgICAgICAgICAgICAg\nICAgICAgOiByZWxtZXRhLmdldE9iamVjdElkVHlwZSgpOwogICAgICAgICAg\nICBkZWZhdWx0OgogICAgICAgICAgICAgICAgcmV0dXJuIE9iamVjdC5jbGFz\nczsKICAgICAgICB9IAogICAgfQoKICAgIC8qKgogICAgICogV2hldGhlciB0\naGlzIGZpZWxkIGhvbGRzIG9wdGltaXN0aWMgdmVyc2lvbiBpbmZvcm1hdGlv\nbi4KICAgICAqLwogICAgcHVibGljIGJvb2xlYW4gaXNWZXJzaW9uKCkgewog\nICAgICAgIHJldHVybiBfdmVyc2lvbiA9PSBCb29sZWFuLlRSVUU7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBXaGV0aGVyIHRoaXMgZmllbGQgaG9sZHMgb3B0\naW1pc3RpYyB2ZXJzaW9uIGluZm9ybWF0aW9uLgogICAgICovCiAgICBwdWJs\naWMgdm9pZCBzZXRWZXJzaW9uKGJvb2xlYW4gdmVyc2lvbikgewogICAgICAg\nIF92ZXJzaW9uID0gKHZlcnNpb24pID8gQm9vbGVhbi5UUlVFIDogQm9vbGVh\nbi5GQUxTRTsKICAgIH0KCiAgICAvKioKICAgICAqIFdoZXRoZXIgdGhpcyBm\naWVsZCBpcyBpbiB0aGUgZGVmYXVsdCBmZXRjaCBncm91cC4KICAgICAqLwog\nICAgcHVibGljIGJvb2xlYW4gaXNJbkRlZmF1bHRGZXRjaEdyb3VwKCkgewog\nICAgICAgIGlmIChfZGZnID09IDApIHsKICAgICAgICAgICAgaWYgKF9tYW5h\nZ2UgIT0gTUFOQUdFX1BFUlNJU1RFTlQgfHwgaXNQcmltYXJ5S2V5KCkgfHwg\naXNWZXJzaW9uKCkpCiAgICAgICAgICAgICAgICBfZGZnID0gREZHX0ZBTFNF\nOwogICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgIC8vIGZpZWxk\nIGxlZnQgYXMgZGVmYXVsdDsgZGZnIHNldHRpbmcgZGVwZW5kcyBvbiB0eXBl\nCiAgICAgICAgICAgICAgICBzd2l0Y2ggKGdldFR5cGVDb2RlKCkpIHsKICAg\nICAgICAgICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5PQkpFQ1Q6CiAgICAg\nICAgICAgICAgICAgICAgICAgIGlmIChpc1NlcmlhbGl6YWJsZSgpIHx8IGlz\nRW51bSgpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgX2RmZyA9IERG\nR19UUlVFOwogICAgICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAg\nICAgICAgICAgICAgICAgICAgICBfZGZnID0gREZHX0ZBTFNFOwogICAgICAg\nICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICBj\nYXNlIEphdmFUeXBlcy5BUlJBWToKICAgICAgICAgICAgICAgICAgICAgICAg\naWYgKGlzTG9iQXJyYXkoKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAg\nIF9kZmcgPSBERkdfVFJVRTsKICAgICAgICAgICAgICAgICAgICAgICAgZWxz\nZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgX2RmZyA9IERGR19GQUxT\nRTsKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAg\nICAgICAgICAgY2FzZSBKYXZhVHlwZXMuQ09MTEVDVElPTjoKICAgICAgICAg\nICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5NQVA6CiAgICAgICAgICAgICAg\nICAgICAgY2FzZSBKYXZhVHlwZXMuUEM6CiAgICAgICAgICAgICAgICAgICAg\nY2FzZSBKYXZhVHlwZXMuUENfVU5UWVBFRDoKICAgICAgICAgICAgICAgICAg\nICAgICAgX2RmZyA9IERGR19GQUxTRTsKICAgICAgICAgICAgICAgICAgICAg\nICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDoKICAgICAg\nICAgICAgICAgICAgICAgICAgX2RmZyA9IERGR19UUlVFOwogICAgICAgICAg\nICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVy\nbiAoX2RmZyAmIERGR19UUlVFKSA+IDA7CiAgICB9CgogICAgcHJpdmF0ZSBi\nb29sZWFuIGlzRW51bSgpIHsKICAgICAgICBpZiAoX2VudW1GaWVsZCA9PSBu\ndWxsKSB7CiAgICAgICAgICAgIENsYXNzPD8+IGRlY2wgPSBnZXREZWNsYXJl\nZFR5cGUoKTsKICAgICAgICAgICAgX2VudW1GaWVsZCA9IEphdmFWZXJzaW9u\ncy5pc0VudW1lcmF0aW9uKGRlY2wpCiAgICAgICAgICAgICAgICA/IEJvb2xl\nYW4uVFJVRSA6IEJvb2xlYW4uRkFMU0U7CiAgICAgICAgfQogICAgICAgIHJl\ndHVybiBfZW51bUZpZWxkLmJvb2xlYW5WYWx1ZSgpOwogICAgfQoKICAgIHBy\naXZhdGUgYm9vbGVhbiBpc1NlcmlhbGl6YWJsZSgpIHsKICAgICAgICBpZiAo\nX3NlcmlhbGl6YWJsZUZpZWxkID09IG51bGwpIHsKICAgICAgICAgICAgQ2xh\nc3M8Pz4gZGVjbCA9IGdldERlY2xhcmVkVHlwZSgpOwogICAgICAgICAgICBp\nZiAoU2VyaWFsaXphYmxlLmNsYXNzLmlzQXNzaWduYWJsZUZyb20oZGVjbCkp\nCiAgICAgICAgICAgICAgICBfc2VyaWFsaXphYmxlRmllbGQgPSBCb29sZWFu\nLlRSVUU7CiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIF9zZXJp\nYWxpemFibGVGaWVsZCA9IEJvb2xlYW4uRkFMU0U7CiAgICAgICAgfQogICAg\nICAgIHJldHVybiBfc2VyaWFsaXphYmxlRmllbGQuYm9vbGVhblZhbHVlKCk7\nCiAgICB9CgogICAgcHJpdmF0ZSBib29sZWFuIGlzTG9iQXJyYXkoKSB7CiAg\nICAgICAgLy8gY2hlY2sgZm9yIGJ5dGVbXSwgQnl0ZVtdLCBjaGFyW10sIENo\nYXJhY3RlcltdCiAgICAgICAgaWYgKF9sb2JGaWVsZCA9PSBudWxsKSB7CiAg\nICAgICAgICAgIENsYXNzPD8+IGRlY2wgPSBnZXREZWNsYXJlZFR5cGUoKTsK\nICAgICAgICAgICAgaWYgKGRlY2wgPT0gYnl0ZVtdLmNsYXNzIHx8IGRlY2wg\nPT0gQnl0ZVtdLmNsYXNzIHx8CiAgICAgICAgICAgICAgICBkZWNsID09IGNo\nYXJbXS5jbGFzcyB8fCBkZWNsID09IENoYXJhY3RlcltdLmNsYXNzKQogICAg\nICAgICAgICAgICAgX2xvYkZpZWxkID0gQm9vbGVhbi5UUlVFOwogICAgICAg\nICAgICBlbHNlCiAgICAgICAgICAgICAgICBfbG9iRmllbGQgPSBCb29sZWFu\nLkZBTFNFOwogICAgICAgIH0KICAgICAgICByZXR1cm4gX2xvYkZpZWxkLmJv\nb2xlYW5WYWx1ZSgpOwogICAgfQoKICAgIC8qKgogICAgICogV2hldGhlciB0\naGlzIGZpZWxkIGlzIGluIHRoZSBkZWZhdWx0IGZldGNoIGdyb3VwLgogICAg\nICovCiAgICBwdWJsaWMgdm9pZCBzZXRJbkRlZmF1bHRGZXRjaEdyb3VwKGJv\nb2xlYW4gZGZnKSB7CiAgICAgICAgaWYgKGRmZykKICAgICAgICAgICAgX2Rm\nZyA9IERGR19UUlVFOwogICAgICAgIGVsc2UKICAgICAgICAgICAgX2RmZyA9\nIERGR19GQUxTRTsKICAgICAgICBfZGZnIHw9IERGR19FWFBMSUNJVDsKICAg\nIH0KCiAgICAvKioKICAgICAqIFdoZXRoZXIgdGhlIGRlZmF1bHQgZmV0Y2gg\nZ3JvdXAgc2V0dGluZyBpcyBleHBsaWNpdC4KICAgICAqLwogICAgcHVibGlj\nIGJvb2xlYW4gaXNEZWZhdWx0RmV0Y2hHcm91cEV4cGxpY2l0KCkgewogICAg\nICAgIHJldHVybiAoX2RmZyAmIERGR19FWFBMSUNJVCkgPiAwOwogICAgfQoK\nICAgIC8qKgogICAgICogV2hldGhlciB0aGUgZGVmYXVsdCBmZXRjaCBncm91\ncCBzZXR0aW5nIGlzIGV4cGxpY2l0LiBBbGxvdyBzZXR0aW5nCiAgICAgKiBm\nb3IgdGVzdGluZy4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0RGVmYXVs\ndEZldGNoR3JvdXBFeHBsaWNpdChib29sZWFuIGV4cGxpY2l0KSB7CiAgICAg\nICAgaWYgKGV4cGxpY2l0KQogICAgICAgICAgICBfZGZnIHw9IERGR19FWFBM\nSUNJVDsKICAgICAgICBlbHNlCiAgICAgICAgICAgIF9kZmcgJj0gfkRGR19F\nWFBMSUNJVDsKICAgIH0KCiAgICAvKioKICAgICAqIEdldHMgdGhlIG5hbWUg\nb2YgdGhlIGN1c3RvbSBmZXRjaCBncm91cHMgdGhvc2UgYXJlIGFzc29jaWF0\nZWQgdG8gdGhpcyAKICAgICAqIHJlY2VpdmVyLiAgVGhpcyBkb2VzIG5vdCBp\nbmNsdWRlIHRoZSAiZGVmYXVsdCIgYW5kICJhbGwiIGZldGNoIGdyb3Vwcy4K\nICAgICAqCiAgICAgKiBAcmV0dXJuIHRoZSBzZXQgb2YgZmV0Y2ggZ3JvdXAg\nbmFtZXMsIG5vdCBpbmNsdWRpbmcgdGhlIGRlZmF1bHQgYW5kCiAgICAgKiBh\nbGwgZmV0Y2ggZ3JvdXBzLgogICAgICovCiAgICBwdWJsaWMgU3RyaW5nW10g\nZ2V0Q3VzdG9tRmV0Y2hHcm91cHMoKSB7CiAgICAgICAgaWYgKF9mZ3MgPT0g\nbnVsbCkgewogICAgICAgICAgICBpZiAoX2ZnU2V0ID09IG51bGwgfHwgX21h\nbmFnZSAhPSBNQU5BR0VfUEVSU0lTVEVOVCAKICAgICAgICAgICAgICAgIHx8\nIGlzUHJpbWFyeUtleSgpIHx8IGlzVmVyc2lvbigpKQogICAgICAgICAgICAg\nICAgX2ZncyA9IG5ldyBTdHJpbmdbMF07CiAgICAgICAgICAgIGVsc2UKICAg\nICAgICAgICAgICAgIF9mZ3MgPSAoU3RyaW5nW10pIF9mZ1NldC50b0FycmF5\nKG5ldyBTdHJpbmdbX2ZnU2V0LnNpemUoKV0pOwogICAgICAgIH0KICAgICAg\nICByZXR1cm4gX2ZnczsKICAgIH0KCiAgICAvKioKICAgICAqIFRoZSBmZXRj\naCBncm91cCB0aGF0IGlzIHRvIGJlIGxvYWRlZCB3aGVuIHRoaXMgcmVjZWl2\nZXIgaXMgbG9hZGVkLCBvcgogICAgICogbnVsbCBpZiBub25lIHNldC4KICAg\nICAqLwogICAgcHVibGljIFN0cmluZyBnZXRMb2FkRmV0Y2hHcm91cCAoKSB7\nCiAgICAJcmV0dXJuIF9sZmc7CiAgICB9CiAgICAKICAgIC8qKgogICAgICog\nVGhlIGZldGNoIGdyb3VwIHRoYXQgaXMgdG8gYmUgbG9hZGVkIHdoZW4gdGhp\ncyByZWNlaXZlciBpcyBsb2FkZWQsIG9yCiAgICAgKiBudWxsIGlmIG5vbmUg\nc2V0LgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRMb2FkRmV0Y2hHcm91\ncCAoU3RyaW5nIGxmZykgewogICAgICAgIGlmICgiIi5lcXVhbHMobGZnKSkK\nICAgICAgICAgICAgbGZnID0gbnVsbDsKICAgIAlfbGZnID0gbGZnOwogICAg\nfQoKICAgIC8qKgogICAgICogV2hldGhlciB0aGlzIGZpZWxkIGlzIGluIHRo\nZSBnaXZlbiBmZXRjaCBncm91cC4KICAgICAqLwogICAgcHVibGljIGJvb2xl\nYW4gaXNJbkZldGNoR3JvdXAoU3RyaW5nIGZnKSB7CiAgICAgICAgaWYgKF9t\nYW5hZ2UgIT0gTUFOQUdFX1BFUlNJU1RFTlQgfHwgaXNQcmltYXJ5S2V5KCkg\nfHwgaXNWZXJzaW9uKCkpCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAg\nICAgICBpZiAoRmV0Y2hHcm91cC5OQU1FX0FMTC5lcXVhbHMoZmcpKQogICAg\nICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICBpZiAoRmV0Y2hHcm91cC5O\nQU1FX0RFRkFVTFQuZXF1YWxzKGZnKSkKICAgICAgICAgICAgcmV0dXJuIGlz\nSW5EZWZhdWx0RmV0Y2hHcm91cCgpOwogICAgICAgIHJldHVybiBfZmdTZXQg\nIT0gbnVsbCAmJiBfZmdTZXQuY29udGFpbnMoZmcpOwogICAgfQoKICAgIC8q\nKgogICAgICogU2V0IHdoZXRoZXIgdGhpcyBmaWVsZCBpcyBpbiB0aGUgZ2l2\nZW4gZmV0Y2ggZ3JvdXAuCiAgICAgKgogICAgICogQHBhcmFtIGZnIGlzIHRo\nZSBuYW1lIG9mIGEgZmV0Y2ggZ3JvdXAgdGhhdCBtdXN0IGJlIHByZXNlbnQg\naW4gdGhlCiAgICAgKiBjbGFzcyB0aGF0IGRlY2xhcmVkIHRoaXMgZmllbGQg\nb3IgYW55IG9mIGl0cyBwZXJzaXN0ZW50IHN1cGVyY2xhc3Nlcy4KICAgICAq\nLwogICAgcHVibGljIHZvaWQgc2V0SW5GZXRjaEdyb3VwKFN0cmluZyBmZywg\nYm9vbGVhbiBpbikgewogICAgICAgIGlmIChTdHJpbmdVdGlscy5pc0VtcHR5\nKGZnKSkKICAgICAgICAgICAgdGhyb3cgbmV3IE1ldGFEYXRhRXhjZXB0aW9u\nKF9sb2MuZ2V0KCJlbXB0eS1mZy1uYW1lIiwgdGhpcykpOwogICAgICAgIGlm\nIChmZy5lcXVhbHMoRmV0Y2hHcm91cC5OQU1FX0FMTCkpCiAgICAgICAgICAg\nIHJldHVybjsKICAgICAgICBpZiAoZmcuZXF1YWxzKEZldGNoR3JvdXAuTkFN\nRV9ERUZBVUxUKSkgewogICAgICAgICAgICBzZXRJbkRlZmF1bHRGZXRjaEdy\nb3VwKGluKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAg\nICBpZiAoX293bmVyLmdldEZldGNoR3JvdXAoZmcpID09IG51bGwpCiAgICAg\nICAgICAgIHRocm93IG5ldyBNZXRhRGF0YUV4Y2VwdGlvbihfbG9jLmdldCgi\ndW5rbm93bi1mZyIsIGZnLCB0aGlzKSk7CiAgICAgICAgaWYgKGluICYmIF9m\nZ1NldCA9PSBudWxsKQogICAgICAgICAgICBfZmdTZXQgPSBuZXcgSGFzaFNl\ndDxTdHJpbmc+KCk7CiAgICAgICAgaWYgKChpbiAmJiBfZmdTZXQuYWRkKGZn\nKSkKICAgICAgICAgICAgfHwgKCFpbiAmJiBfZmdTZXQgIT0gbnVsbCAmJiBf\nZmdTZXQucmVtb3ZlKGZnKSkpCiAgICAgICAgICAgIF9mZ3MgPSBudWxsOwog\nICAgfQogICAgCiAgICAvKioKICAgICAqIEhvdyB0aGUgZGF0YSBzdG9yZSBz\naG91bGQgdHJlYXQgbnVsbCB2YWx1ZXMgZm9yIHRoaXMgZmllbGQ6CiAgICAg\nKiA8dWw+CiAgICAgKiA8bGk+e0BsaW5rICNOVUxMX1VOU0VUfTogbm8gdmFs\ndWUgc3VwcGxpZWQ8L2xpPgogICAgICogPGxpPntAbGluayAjTlVMTF9OT05F\nfTogbGVhdmUgbnVsbCB2YWx1ZXMgYXMgbnVsbCBpbiB0aGUgZGF0YSBzdG9y\nZTwvbGk+CiAgICAgKiA8bGk+e0BsaW5rICNOVUxMX0VYQ0VQVElPTn06IHRo\ncm93IGFuIGV4Y2VwdGlvbiBpZiB0aGlzIGZpZWxkIGlzIG51bGwKICAgICAq\nIGF0IGNvbW1pdDwvbGk+CiAgICAgKiA8bGk+e0BsaW5rICNOVUxMX0RFRkFV\nTFR9OiB1c2UgdGhlIGRhdGFiYXNlIGRlZmF1bHQgaWYgdGhpcyBmaWVsZCBp\ncwogICAgICogbnVsbCBhdCBjb21taXQ8L2xpPgogICAgICogPC91bD4gRGVm\nYXVsdHMgdG8ge0BsaW5rICNOVUxMX1VOU0VUfS4KICAgICAqLwogICAgcHVi\nbGljIGludCBnZXROdWxsVmFsdWUoKSB7CiAgICAgICAgcmV0dXJuIF9udWxs\nVmFsdWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBIb3cgdGhlIGRhdGEgc3Rv\ncmUgc2hvdWxkIHRyZWF0IG51bGwgdmFsdWVzIGZvciB0aGlzIGZpZWxkOgog\nICAgICogPHVsPgogICAgICogPGxpPntAbGluayAjTlVMTF9VTlNFVH06IG5v\nIHZhbHVlIHN1cHBsaWVkPC9saT4KICAgICAqIDxsaT57QGxpbmsgI05VTExf\nTk9ORX06IGxlYXZlIG51bGwgdmFsdWVzIGFzIG51bGwgaW4gdGhlIGRhdGEg\nc3RvcmU8L2xpPgogICAgICogPGxpPntAbGluayAjTlVMTF9FWENFUFRJT059\nOiB0aHJvdyBhbiBleGNlcHRpb24gaWYgdGhpcyBmaWVsZCBpcyBudWxsCiAg\nICAgKiBhdCBjb21taXQ8L2xpPgogICAgICogPGxpPntAbGluayAjTlVMTF9E\nRUZBVUxUfTogdXNlIHRoZSBkYXRhYmFzZSBkZWZhdWx0IGlmIHRoaXMgZmll\nbGQgaXMKICAgICAqIG51bGwgYXQgY29tbWl0PC9saT4KICAgICAqIDwvdWw+\nIERlZmF1bHRzIHRvIHtAbGluayAjTlVMTF9VTlNFVH0uCiAgICAgKi8KICAg\nIHB1YmxpYyB2b2lkIHNldE51bGxWYWx1ZShpbnQgbnVsbFZhbHVlKSB7CiAg\nICAgICAgX251bGxWYWx1ZSA9IG51bGxWYWx1ZTsKICAgIH0KCiAgICAvKioK\nICAgICAqIFdoZXRoZXIgdGhpcyBmaWVsZCBpcyBleHBsaWNpdGx5IGRlY2xh\ncmVkIGluIHRoZSBtZXRhZGF0YS4KICAgICAqLwogICAgcHVibGljIGJvb2xl\nYW4gaXNFeHBsaWNpdCgpIHsKICAgICAgICByZXR1cm4gX2V4cGxpY2l0Owog\nICAgfQoKICAgIC8qKgogICAgICogV2hldGhlciB0aGlzIGZpZWxkIGlzIGV4\ncGxpY2l0bHkgZGVjbGFyZWQgaW4gdGhlIG1ldGFkYXRhLgogICAgICovCiAg\nICBwdWJsaWMgdm9pZCBzZXRFeHBsaWNpdChib29sZWFuIGV4cGxpY2l0KSB7\nCiAgICAgICAgX2V4cGxpY2l0ID0gZXhwbGljaXQ7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBUaGUgZmllbGQgdGhhdCB0aGlzIGZpZWxkIHNoYXJlcyBhIG1h\ncHBpbmcgd2l0aC4KICAgICAqLwogICAgcHVibGljIFN0cmluZyBnZXRNYXBw\nZWRCeSgpIHsKICAgICAgICByZXR1cm4gX21hcHBlZEJ5OwogICAgfQoKICAg\nIC8qKgogICAgICogVGhlIGZpZWxkIHRoYXQgdGhpcyBmaWVsZCBzaGFyZXMg\nYSBtYXBwaW5nIHdpdGguCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldE1h\ncHBlZEJ5KFN0cmluZyBtYXBwZWQpIHsKICAgICAgICBfbWFwcGVkQnkgPSBt\nYXBwZWQ7CiAgICAgICAgX21hcHBlZEJ5TWV0YSA9IG51bGw7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBUaGUgZmllbGQgdGhhdCB0aGlzIGZpZWxkIHNoYXJl\ncyBhIG1hcHBpbmcgd2l0aC4KICAgICAqLwogICAgcHVibGljIEZpZWxkTWV0\nYURhdGEgZ2V0TWFwcGVkQnlNZXRhRGF0YSgpIHsKICAgICAgICBpZiAoX21h\ncHBlZEJ5ICE9IG51bGwgJiYgX21hcHBlZEJ5TWV0YSA9PSBudWxsKSB7CiAg\nICAgICAgICAgIENsYXNzTWV0YURhdGEgbWV0YSA9IG51bGw7CiAgICAgICAg\nICAgIHN3aXRjaCAoZ2V0VHlwZUNvZGUoKSkgewogICAgICAgICAgICAgICAg\nY2FzZSBKYXZhVHlwZXMuUEM6CiAgICAgICAgICAgICAgICAgICAgbWV0YSA9\nIGdldFR5cGVNZXRhRGF0YSgpOwogICAgICAgICAgICAgICAgICAgIGJyZWFr\nOwogICAgICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuQVJSQVk6CiAgICAg\nICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5DT0xMRUNUSU9OOgogICAgICAg\nICAgICAgICAgY2FzZSBKYXZhVHlwZXMuTUFQOgogICAgICAgICAgICAgICAg\nICAgIG1ldGEgPSBfZWxlbS5nZXRUeXBlTWV0YURhdGEoKTsKICAgICAgICAg\nICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQoKICAgICAgICAgICAg\nRmllbGRNZXRhRGF0YSBmaWVsZCA9IChtZXRhID09IG51bGwpID8gbnVsbAog\nICAgICAgICAgICAgICAgOiBnZXRNYXBwZWRCeUZpZWxkKG1ldGEsIF9tYXBw\nZWRCeSk7CiAgICAgICAgICAgIGlmIChmaWVsZCA9PSBudWxsKQogICAgICAg\nICAgICAgICAgdGhyb3cgbmV3IE1ldGFEYXRhRXhjZXB0aW9uKF9sb2MuZ2V0\nKCJuby1tYXBwZWQtYnkiLCB0aGlzLAogICAgICAgICAgICAgICAgICAgIF9t\nYXBwZWRCeSkpOwogICAgICAgICAgICBpZiAoZmllbGQuZ2V0TWFwcGVkQnko\nKSAhPSBudWxsKQogICAgICAgICAgICAgICAgdGhyb3cgbmV3IE1ldGFEYXRh\nRXhjZXB0aW9uKF9sb2MuZ2V0KCJjaXJjLW1hcHBlZC1ieSIsIHRoaXMsCiAg\nICAgICAgICAgICAgICAgICAgX21hcHBlZEJ5KSk7CiAgICAgICAgICAgIE9w\nZW5KUEFDb25maWd1cmF0aW9uIGNvbmYgPSBnZXRSZXBvc2l0b3J5KCkuZ2V0\nQ29uZmlndXJhdGlvbigpOwogICAgICAgICAgICBib29sZWFuIGlzQWJzdHJh\nY3RNYXBwaW5nVW5pRGlyZWN0aW9uYWwgPSBnZXRSZXBvc2l0b3J5KCkuZ2V0\nTWV0YURhdGFGYWN0b3J5KCkuCiAgICAgICAgICAgICAgICAgICAgZ2V0RGVm\nYXVsdHMoKS5pc0Fic3RyYWN0TWFwcGluZ1VuaURpcmVjdGlvbmFsKGNvbmYp\nOwogICAgICAgICAgICBpZiAoaXNBYnN0cmFjdE1hcHBpbmdVbmlEaXJlY3Rp\nb25hbCkgewogICAgICAgICAgICAgICAgaWYgKGZpZWxkLmdldERlY2xhcmlu\nZ01ldGFEYXRhKCkuaXNBYnN0cmFjdCgpKQogICAgICAgICAgICAgICAgICAg\nIHRocm93IG5ldyBNZXRhRGF0YUV4Y2VwdGlvbihfbG9jLmdldCgibm8tbWFw\ncGVkLWJ5LWluLW1hcHBlZC1zdXBlciIsIGZpZWxkLAogICAgICAgICAgICAg\nICAgICAgICAgICAgICAgZmllbGQuZ2V0RGVjbGFyaW5nTWV0YURhdGEoKSkp\nOwoKICAgICAgICAgICAgICAgIGlmICh0aGlzLmdldERlY2xhcmluZ01ldGFE\nYXRhKCkuaXNBYnN0cmFjdCgpKQogICAgICAgICAgICAgICAgICAgIHRocm93\nIG5ldyBNZXRhRGF0YUV4Y2VwdGlvbihfbG9jLmdldCgibm8tbWFwcGVkLWJ5\nLWluLW1hcHBlZC1zdXBlciIsIHRoaXMsCiAgICAgICAgICAgICAgICAgICAg\nICAgICAgICB0aGlzLmdldERlY2xhcmluZ01ldGFEYXRhKCkpKTsKICAgICAg\nICAgICAgfQogICAgICAgICAgICBfbWFwcGVkQnlNZXRhID0gZmllbGQ7CiAg\nICAgICAgfQogICAgICAgIHJldHVybiBfbWFwcGVkQnlNZXRhOwogICAgfQoK\nICAgIHB1YmxpYyBGaWVsZE1ldGFEYXRhIGdldE1hcHBlZEJ5RmllbGQoQ2xh\nc3NNZXRhRGF0YSBtZXRhLCBTdHJpbmcgbWFwcGVkQnkpIHsKICAgICAgICBG\naWVsZE1ldGFEYXRhIGZpZWxkID0gbWV0YS5nZXRGaWVsZChtYXBwZWRCeSk7\nCiAgICAgICAgaWYgKGZpZWxkICE9IG51bGwpCiAgICAgICAgICAgIHJldHVy\nbiBmaWVsZDsKICAgICAgICBpbnQgZG90SWR4ID0gbWFwcGVkQnkuaW5kZXhP\nZigiLiIpOyAKICAgICAgICBpZiAoIGRvdElkeCA9PSAtMSkKICAgICAgICAg\nICAgcmV0dXJuIG51bGw7CiAgICAgICAgU3RyaW5nIGZpZWxkTmFtZSA9IG1h\ncHBlZEJ5LnN1YnN0cmluZygwLCBkb3RJZHgpOwogICAgICAgIEZpZWxkTWV0\nYURhdGEgZmllbGQxID0gbWV0YS5nZXRGaWVsZChmaWVsZE5hbWUpOwogICAg\nICAgIGlmIChmaWVsZDEgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIG51\nbGw7CiAgICAgICAgQ2xhc3NNZXRhRGF0YSBtZXRhMSA9IGZpZWxkMS5nZXRF\nbWJlZGRlZE1ldGFEYXRhKCk7CiAgICAgICAgaWYgKG1ldGExID09IG51bGwp\nCiAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgIFN0cmluZyBtYXBw\nZWRCeTEgPSBtYXBwZWRCeS5zdWJzdHJpbmcoZG90SWR4ICsgMSk7CiAgICAg\nICAgcmV0dXJuIGdldE1hcHBlZEJ5RmllbGQobWV0YTEsIG1hcHBlZEJ5MSk7\nCiAgICB9CiAgICAKICAgIAogICAgLyoqCiAgICAgKiBMb2dpY2FsIGludmVy\nc2UgZmllbGQuCiAgICAgKi8KICAgIHB1YmxpYyBTdHJpbmcgZ2V0SW52ZXJz\nZSgpIHsKICAgICAgICBpZiAoQ2xhc3NNZXRhRGF0YS5ERUZBVUxUX1NUUklO\nRy5lcXVhbHMoX2ludmVyc2UpKQogICAgICAgICAgICBfaW52ZXJzZSA9IG51\nbGw7CiAgICAgICAgcmV0dXJuIF9pbnZlcnNlOwogICAgfQoKICAgIC8qKgog\nICAgICogTG9naWNhbCBpbnZlcnNlIGZpZWxkLgogICAgICovCiAgICBwdWJs\naWMgdm9pZCBzZXRJbnZlcnNlKFN0cmluZyBpbnZlcnNlKSB7CiAgICAgICAg\nX2ludmVyc2VzID0gbnVsbDsKICAgICAgICBfaW52ZXJzZSA9IGludmVyc2U7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gYWxsIGludmVyc2VzIG9m\nIHRoaXMgZmllbGQuCiAgICAgKi8KICAgIHB1YmxpYyBGaWVsZE1ldGFEYXRh\nW10gZ2V0SW52ZXJzZU1ldGFEYXRhcygpIHsKICAgICAgICBpZiAoX2ludmVy\nc2VzID09IG51bGwpIHsKICAgICAgICAgICAgLy8gY2FuJ3QgZGVjbGFyZSBi\nb3RoIGFuIGludmVyc2Ugb3duZXIgYW5kIGEgbG9naWNhbCBpbnZlcnNlCiAg\nICAgICAgICAgIFN0cmluZyBpbnYgPSBnZXRJbnZlcnNlKCk7CiAgICAgICAg\nICAgIGlmIChfbWFwcGVkQnkgIT0gbnVsbCAmJiBpbnYgIT0gbnVsbCAmJiAh\nX21hcHBlZEJ5LmVxdWFscyhpbnYpKQogICAgICAgICAgICAgICAgdGhyb3cg\nbmV3IE1ldGFEYXRhRXhjZXB0aW9uKF9sb2MuZ2V0KCJtYXBwZWQtbm90LWlu\ndmVyc2UiLAogICAgICAgICAgICAgICAgICAgIHRoaXMpKTsKCiAgICAgICAg\nICAgIC8vIGdldCB0aGUgbWV0YWRhdGEgZm9yIHRoZSB0eXBlIG9uIHRoZSBv\ndGhlciBzaWRlIG9mIHRoaXMgcmVsYXRpb24KICAgICAgICAgICAgQ2xhc3NN\nZXRhRGF0YSBtZXRhID0gbnVsbDsKICAgICAgICAgICAgc3dpdGNoIChnZXRU\neXBlQ29kZSgpKSB7CiAgICAgICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5Q\nQzoKICAgICAgICAgICAgICAgICAgICBtZXRhID0gZ2V0VHlwZU1ldGFEYXRh\nKCk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAg\nICBjYXNlIEphdmFUeXBlcy5BUlJBWToKICAgICAgICAgICAgICAgIGNhc2Ug\nSmF2YVR5cGVzLkNPTExFQ1RJT046CiAgICAgICAgICAgICAgICBjYXNlIEph\ndmFUeXBlcy5NQVA6CiAgICAgICAgICAgICAgICAgICAgbWV0YSA9IF9lbGVt\nLmdldFR5cGVNZXRhRGF0YSgpOwogICAgICAgICAgICAgICAgICAgIGJyZWFr\nOwogICAgICAgICAgICB9CgogICAgICAgICAgICBDb2xsZWN0aW9uPEZpZWxk\nTWV0YURhdGE+IGludmVyc2VzID0gbnVsbDsKICAgICAgICAgICAgaWYgKG1l\ndGEgIT0gbnVsbCkgewogICAgICAgICAgICAgICAgLy8gYWRkIG1hcHBlZCBi\neSBhbmQgbmFtZWQgaW52ZXJzZSwgaWYgYW55CiAgICAgICAgICAgICAgICBG\naWVsZE1ldGFEYXRhIGZpZWxkID0gZ2V0TWFwcGVkQnlNZXRhRGF0YSgpOwog\nICAgICAgICAgICAgICAgaWYgKGZpZWxkICE9IG51bGwpIHsKICAgICAgICAg\nICAgICAgICAgICAvLyBtYXBwZWQgYnkgZmllbGQgaXNuJ3QgbmVjZXNzYXJp\nbHkgYSBwYyB0eXBlLCBidXQgYWxsCiAgICAgICAgICAgICAgICAgICAgLy8g\naW52ZXJzZXMgbXVzdCBiZQogICAgICAgICAgICAgICAgICAgIGlmIChmaWVs\nZC5nZXRUeXBlQ29kZSgpID09IEphdmFUeXBlcy5QQwogICAgICAgICAgICAg\nICAgICAgICAgICB8fCBmaWVsZC5nZXRFbGVtZW50KCkuZ2V0VHlwZUNvZGUo\nKSA9PSBKYXZhVHlwZXMuUEMpIHsKICAgICAgICAgICAgICAgICAgICAgICAg\naW52ZXJzZXMgPSBuZXcgQXJyYXlMaXN0PEZpZWxkTWV0YURhdGE+KDMpOwog\nICAgICAgICAgICAgICAgICAgICAgICBpbnZlcnNlcy5hZGQoZmllbGQpOwog\nICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0gZWxzZSBp\nZiAoaW52ICE9IG51bGwpIHsKICAgICAgICAgICAgICAgICAgICBmaWVsZCA9\nIG1ldGEuZ2V0RmllbGQoaW52KTsKICAgICAgICAgICAgICAgICAgICBpZiAo\nZmllbGQgPT0gbnVsbCkKICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cg\nbmV3IE1ldGFEYXRhRXhjZXB0aW9uKF9sb2MuZ2V0KCJuby1pbnZlcnNlIiwK\nICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMsIGludikpOwogICAg\nICAgICAgICAgICAgICAgIGludmVyc2VzID0gbmV3IEFycmF5TGlzdDxGaWVs\nZE1ldGFEYXRhPigzKTsKICAgICAgICAgICAgICAgICAgICBpbnZlcnNlcy5h\nZGQoZmllbGQpOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAg\nIC8vIHNjYW4gcmVsIHR5cGUgZm9yIGZpZWxkcyB0aGF0IG5hbWUgdGhpcyBm\naWVsZCBhcyBhbiBpbnZlcnNlCiAgICAgICAgICAgICAgICBGaWVsZE1ldGFE\nYXRhW10gZmllbGRzID0gbWV0YS5nZXRGaWVsZHMoKTsKICAgICAgICAgICAg\nICAgIENsYXNzPD8+IHR5cGUgPSBnZXREZWNsYXJpbmdNZXRhRGF0YSgpLmdl\ndERlc2NyaWJlZFR5cGUoKTsKICAgICAgICAgICAgICAgIGZvciAoaW50IGkg\nPSAwOyBpIDwgZmllbGRzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAg\nICAgICAgLy8gc2tpcCBmaWVsZHMgdGhhdCBhcmVuJ3QgY29tcGF0aWJsZSB3\naXRoIG91ciBvd25pbmcgY2xhc3MKICAgICAgICAgICAgICAgICAgICBzd2l0\nY2ggKGZpZWxkc1tpXS5nZXRUeXBlQ29kZSgpKSB7CiAgICAgICAgICAgICAg\nICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLlBDOgogICAgICAgICAgICAgICAg\nICAgICAgICAgICAgaWYgKCF0eXBlLmlzQXNzaWduYWJsZUZyb20oZmllbGRz\nW2ldLmdldFR5cGUoKSkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgY29udGludWU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVh\nazsKICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuQ09M\nTEVDVElPTjoKICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBKYXZhVHlw\nZXMuQVJSQVk6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXR5\ncGUuaXNBc3NpZ25hYmxlRnJvbShmaWVsZHNbaV0uCiAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgZ2V0RWxlbWVudCgpLmdldFR5cGUoKSkpCiAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7CiAgICAg\nICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAg\nICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAgICAgICAgICAgICAg\nIGNvbnRpbnVlOwogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAg\nICAgICAgICAgLy8gaWYgdGhlIGZpZWxkIGRlY2xhcmVzIHVzIGFzIGl0cyBp\nbnZlcnNlIGFuZCB3ZSBoYXZlbid0CiAgICAgICAgICAgICAgICAgICAgLy8g\nYWxyZWFkeSBhZGRlZCBpdCAod2UgbWlnaHQgaGF2ZSBpZiB3ZSBhbHNvIGRl\nY2xhcmVkIGl0CiAgICAgICAgICAgICAgICAgICAgLy8gYXMgb3VyIGludmVy\nc2UpLCBhZGQgaXQgbm93CiAgICAgICAgICAgICAgICAgICAgaWYgKF9uYW1l\nLmVxdWFscyhmaWVsZHNbaV0uZ2V0TWFwcGVkQnkoKSkKICAgICAgICAgICAg\nICAgICAgICAgICAgfHwgX25hbWUuZXF1YWxzKGZpZWxkc1tpXS5nZXRJbnZl\ncnNlKCkpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpbnZlcnNl\ncyA9PSBudWxsKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaW52ZXJz\nZXMgPSBuZXcgQXJyYXlMaXN0PEZpZWxkTWV0YURhdGE+KDMpOwogICAgICAg\nICAgICAgICAgICAgICAgICBpZiAoIWludmVyc2VzLmNvbnRhaW5zKGZpZWxk\nc1tpXSkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnZlcnNlcy5h\nZGQoZmllbGRzW2ldKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAg\nICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIE1ldGFEYXRh\nUmVwb3NpdG9yeSByZXBvcyA9IGdldFJlcG9zaXRvcnkoKTsKICAgICAgICAg\nICAgaWYgKGludmVyc2VzID09IG51bGwpCiAgICAgICAgICAgICAgICBfaW52\nZXJzZXMgPSByZXBvcy5FTVBUWV9GSUVMRFM7CiAgICAgICAgICAgIGVsc2UK\nICAgICAgICAgICAgICAgIF9pbnZlcnNlcyA9IGludmVyc2VzLnRvQXJyYXkK\nICAgICAgICAgICAgICAgICAgICAocmVwb3MubmV3RmllbGRNZXRhRGF0YUFy\ncmF5KGludmVyc2VzLnNpemUoKSkpOwogICAgICAgIH0KICAgICAgICByZXR1\ncm4gX2ludmVyc2VzOwogICAgfQoKICAgIC8qKgogICAgICogVGhlIHN0cmF0\nZWd5IHRvIHVzZSBmb3IgaW5zZXJ0IHZhbHVlIGdlbmVyYXRpb24uCiAgICAg\nKiBPbmUgb2YgdGhlIGNvbnN0YW50cyBmcm9tIHtAbGluayBWYWx1ZVN0cmF0\nZWdpZXN9LgogICAgICovCiAgICBwdWJsaWMgaW50IGdldFZhbHVlU3RyYXRl\nZ3koKSB7CiAgICAgICAgaWYgKF92YWxTdHJhdGVneSA9PSAtMSkKICAgICAg\nICAgICAgX3ZhbFN0cmF0ZWd5ID0gVmFsdWVTdHJhdGVnaWVzLk5PTkU7CiAg\nICAgICAgcmV0dXJuIF92YWxTdHJhdGVneTsKICAgIH0KCiAgICAvKioKICAg\nICAqIFRoZSBzdHJhdGVneSB0byB1c2UgZm9yIGluc2VydCB2YWx1ZSBnZW5l\ncmF0aW9uLgogICAgICogT25lIG9mIHRoZSBjb25zdGFudHMgZnJvbSB7QGxp\nbmsgVmFsdWVTdHJhdGVnaWVzfS4KICAgICAqLwogICAgcHVibGljIHZvaWQg\nc2V0VmFsdWVTdHJhdGVneShpbnQgc3RyYXRlZ3kpIHsKICAgICAgICBfdmFs\nU3RyYXRlZ3kgPSBzdHJhdGVneTsKICAgICAgICBpZiAoc3RyYXRlZ3kgIT0g\nVmFsdWVTdHJhdGVnaWVzLlNFUVVFTkNFKQogICAgICAgICAgICBzZXRWYWx1\nZVNlcXVlbmNlTmFtZShudWxsKTsKICAgIH0KCiAgICAvKioKICAgICAqIFRo\nZSB2YWx1ZSBzZXF1ZW5jZSBuYW1lLCBvciBudWxsIGZvciBub25lLgogICAg\nICovCiAgICBwdWJsaWMgU3RyaW5nIGdldFZhbHVlU2VxdWVuY2VOYW1lKCkg\newogICAgICAgIGlmIChDbGFzc01ldGFEYXRhLkRFRkFVTFRfU1RSSU5HLmVx\ndWFscyhfc2VxTmFtZSkpCiAgICAgICAgICAgIF9zZXFOYW1lID0gbnVsbDsK\nICAgICAgICByZXR1cm4gX3NlcU5hbWU7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBUaGUgdmFsdWUgc2VxdWVuY2UgbmFtZSwgb3IgbnVsbCBmb3Igbm9uZS4K\nICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0VmFsdWVTZXF1ZW5jZU5hbWUo\nU3RyaW5nIHNlcU5hbWUpIHsKICAgICAgICBfc2VxTmFtZSA9IHNlcU5hbWU7\nCiAgICAgICAgX3NlcU1ldGEgPSBudWxsOwogICAgICAgIGlmIChzZXFOYW1l\nICE9IG51bGwpCiAgICAgICAgICAgIHNldFZhbHVlU3RyYXRlZ3koVmFsdWVT\ndHJhdGVnaWVzLlNFUVVFTkNFKTsKICAgIH0KCiAgICAvKioKICAgICAqIE1l\ndGFkYXRhIGZvciB0aGUgdmFsdWUgc2VxdWVuY2UuCiAgICAgKi8KICAgIHB1\nYmxpYyBTZXF1ZW5jZU1ldGFEYXRhIGdldFZhbHVlU2VxdWVuY2VNZXRhRGF0\nYSgpIHsKICAgICAgICBpZiAoX3NlcU1ldGEgPT0gbnVsbCAmJiBnZXRWYWx1\nZVNlcXVlbmNlTmFtZSgpICE9IG51bGwpCiAgICAgICAgICAgIF9zZXFNZXRh\nID0gZ2V0UmVwb3NpdG9yeSgpLmdldFNlcXVlbmNlTWV0YURhdGEoX293bmVy\nLAogICAgICAgICAgICAgICAgZ2V0VmFsdWVTZXF1ZW5jZU5hbWUoKSwgdHJ1\nZSk7CiAgICAgICAgcmV0dXJuIF9zZXFNZXRhOwogICAgfQoKICAgIC8qKgog\nICAgICogVGhlIHN0cmF0ZWd5IHRvIHVzZSB3aGVuIHVwZGF0aW5nIHRoZSBm\naWVsZC4KICAgICAqLwogICAgcHVibGljIGludCBnZXRVcGRhdGVTdHJhdGVn\neSgpIHsKICAgICAgICBpZiAoaXNWZXJzaW9uKCkpCiAgICAgICAgICAgIHJl\ndHVybiBVcGRhdGVTdHJhdGVnaWVzLlJFU1RSSUNUOwogICAgICAgIGlmIChf\ndXBTdHJhdGVneSA9PSAtMSkKICAgICAgICAgICAgX3VwU3RyYXRlZ3kgPSBV\ncGRhdGVTdHJhdGVnaWVzLk5PTkU7CiAgICAgICAgcmV0dXJuIF91cFN0cmF0\nZWd5OwogICAgfQoKICAgIC8qKgogICAgICogU2V0IHRoZSB1cGRhdGUgc3Ry\nYXRlZ3kuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldFVwZGF0ZVN0cmF0\nZWd5KGludCBzdHJhdGVneSkgewogICAgICAgIF91cFN0cmF0ZWd5ID0gc3Ry\nYXRlZ3k7CiAgICB9CgogICAgLyoqCiAgICAgKiBXaGV0aGVyIHRoaXMgZmll\nbGQgaXMgYmFja2VkIGJ5IGEgbGFyZ2UgcmVzdWx0IHNldC4KICAgICAqLwog\nICAgcHVibGljIGJvb2xlYW4gaXNMUlMoKSB7CiAgICAgICAgcmV0dXJuIF9s\ncnMgPT0gQm9vbGVhbi5UUlVFICYmIF9tYW5hZ2UgPT0gTUFOQUdFX1BFUlNJ\nU1RFTlQ7CiAgICB9CgogICAgLyoqCiAgICAgKiBXaGV0aGVyIHRoaXMgZmll\nbGQgaXMgYmFja2VkIGJ5IGEgbGFyZ2UgcmVzdWx0IHNldC4KICAgICAqLwog\nICAgcHVibGljIHZvaWQgc2V0TFJTKGJvb2xlYW4gbHJzKSB7CiAgICAgICAg\nX2xycyA9IChscnMpID8gQm9vbGVhbi5UUlVFIDogQm9vbGVhbi5GQUxTRTsK\nICAgIH0KCiAgICAvKioKICAgICAqIFdoZXRoZXIgdGhpcyBmaWVsZCBpcyBi\nYWNrZWQgYnkgYSBzdHJlYW0uCiAgICAgKgogICAgICogQHNpbmNlIDEuMS4w\nCiAgICAgKi8KICAgIHB1YmxpYyBib29sZWFuIGlzU3RyZWFtKCkgewogICAg\nICAgIHJldHVybiBfc3RyZWFtID09IEJvb2xlYW4uVFJVRSAmJiBfbWFuYWdl\nID09IE1BTkFHRV9QRVJTSVNURU5UOwogICAgfQogICAgCiAgICAvKioKICAg\nICAqIFdoZXRoZXIgdGhpcyBmaWVsZCBpcyBiYWNrZWQgYnkgYSBzdHJlYW0u\nCiAgICAgKgogICAgICogQHNpbmNlIDEuMS4wCiAgICAgKi8KICAgIHB1Ymxp\nYyB2b2lkIHNldFN0cmVhbShib29sZWFuIHN0cmVhbSkgewogICAgICAgIF9z\ndHJlYW0gPSAoc3RyZWFtKSA/IEJvb2xlYW4uVFJVRSA6IEJvb2xlYW4uRkFM\nU0U7CiAgICB9CiAgICAKICAgIC8qKgogICAgICogV2hldGhlciB0aGlzIGZp\nZWxkIHVzZXMgaW50ZXJtZWRpYXRlIGRhdGEgd2hlbiBsb2FkaW5nL3N0b3Jp\nbmcKICAgICAqIGluZm9ybWF0aW9uIHRocm91Z2ggYSB7QGxpbmsgT3BlbkpQ\nQVN0YXRlTWFuYWdlcn0uIERlZmF1bHRzIHRvIHRydWUuCiAgICAgKgogICAg\nICogQHNlZSBPcGVuSlBBU3RhdGVNYW5hZ2VyI3NldEludGVybWVkaWF0ZShp\nbnQsT2JqZWN0KQogICAgICovCiAgICBwdWJsaWMgYm9vbGVhbiB1c2VzSW50\nZXJtZWRpYXRlKCkgewogICAgICAgIHJldHVybiBfaW50ZXJtZWRpYXRlOwog\nICAgfQoKICAgIC8qKgogICAgICogV2hldGhlciB0aGlzIGZpZWxkIHVzZXMg\naW50ZXJtZWRpYXRlIGRhdGEgd2hlbiBsb2FkaW5nL3N0b3JpbmcKICAgICAq\nIGluZm9ybWF0aW9uIHRocm91Z2ggYSB7QGxpbmsgT3BlbkpQQVN0YXRlTWFu\nYWdlcn0uIERlZmF1bHRzIHRvIHRydWUuCiAgICAgKgogICAgICogQHNlZSBP\ncGVuSlBBU3RhdGVNYW5hZ2VyI3NldEludGVybWVkaWF0ZShpbnQsT2JqZWN0\nKQogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRVc2VzSW50ZXJtZWRpYXRl\nKGJvb2xlYW4gaW50ZXJtZWRpYXRlKSB7CiAgICAgICAgX2ludGVybWVkaWF0\nZSA9IGludGVybWVkaWF0ZTsKICAgICAgICBfb3duZXIuY2xlYXJFeHRyYUZp\nZWxkRGF0YVRhYmxlKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBXaGV0aGVy\nIHRoaXMgZmllbGQgdXNlcyBpbXBsIGRhdGEgaW4gY29uanVuY3Rpb24gd2l0\naCBzdGFuZGFyZAogICAgICogZmllbGQgZGF0YSB3aGVuIGFjdGluZyBvbiBh\nIHtAbGluayBPcGVuSlBBU3RhdGVNYW5hZ2VyfS4KICAgICAqIERlZmF1bHRz\nIHRvIHtAbGluayBCb29sZWFuI1RSVUV9IChub24tY2FjaGFibGUgaW1wbCBk\nYXRhKS4KICAgICAqCiAgICAgKiBAcmV0dXJuIHtAbGluayBCb29sZWFuI0ZB\nTFNFfSBpZiB0aGlzIGZpZWxkIGRvZXMgbm90IHVzZSBpbXBsIGRhdGEsCiAg\nICAgKiB7QGxpbmsgQm9vbGVhbiNUUlVFfSBpZiB0aGlzIGZpZWxkIHVzZXMg\nbm9uLWNhY2hhYmxlIGltcGwKICAgICAqIGRhdGEsIG9yIDxjb2RlPm51bGw8\nL2NvZGU+IGlmIHRoaXMgZmllbGQgdXNlcyBpbXBsIGRhdGEgdGhhdAogICAg\nICogc2hvdWxkIGJlIGNhY2hlZCBhY3Jvc3MgaW5zdGFuY2VzCiAgICAgKiBA\nc2VlIE9wZW5KUEFTdGF0ZU1hbmFnZXIjc2V0SW1wbERhdGEoaW50LE9iamVj\ndCkKICAgICAqLwogICAgcHVibGljIEJvb2xlYW4gdXNlc0ltcGxEYXRhKCkg\newogICAgICAgIHJldHVybiBfaW1wbERhdGE7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBXaGV0aGVyIHRoaXMgZmllbGQgdXNlcyBpbXBsIGRhdGEgaW4gY29u\nanVuY3Rpb24gd2l0aCBzdGFuZGFyZAogICAgICogZmllbGQgZGF0YSB3aGVu\nIGFjdGluZyBvbiBhIHtAbGluayBPcGVuSlBBU3RhdGVNYW5hZ2VyfS4KICAg\nICAqCiAgICAgKiBAc2VlIE9wZW5KUEFTdGF0ZU1hbmFnZXIjc2V0SW1wbERh\ndGEoaW50LE9iamVjdCkKICAgICAqIEBzZWUgI3VzZXNJbXBsRGF0YQogICAg\nICovCiAgICBwdWJsaWMgdm9pZCBzZXRVc2VzSW1wbERhdGEoQm9vbGVhbiBp\nbXBsRGF0YSkgewogICAgICAgIF9pbXBsRGF0YSA9IGltcGxEYXRhOwogICAg\nICAgIF9vd25lci5jbGVhckV4dHJhRmllbGREYXRhVGFibGUoKTsKICAgIH0K\nCiAgICAvKioKICAgICAqIFRoZSBvcmRlcmluZ3MgZm9yIHRoaXMgZmllbGQg\ndG8gYmUgYXBwbGllZCBvbiBsb2FkLCBvciBlbXB0eSBhcnJheS4KICAgICAq\nLwogICAgcHVibGljIE9yZGVyW10gZ2V0T3JkZXJzKCkgewogICAgICAgIGlm\nIChfb3JkZXJzID09IG51bGwpIHsKICAgICAgICAgICAgaWYgKF9vcmRlckRl\nYyA9PSBudWxsKQogICAgICAgICAgICAgICAgX29yZGVycyA9IGdldFJlcG9z\naXRvcnkoKS5FTVBUWV9PUkRFUlM7CiAgICAgICAgICAgIGVsc2UgewogICAg\nICAgICAgICAgICAgU3RyaW5nW10gZGVjcyA9IFN0cmluZ3Muc3BsaXQoX29y\nZGVyRGVjLCAiLCIsIDApOwogICAgICAgICAgICAgICAgT3JkZXJbXSBvcmRl\ncnMgPSBnZXRSZXBvc2l0b3J5KCkubmV3T3JkZXJBcnJheShkZWNzLmxlbmd0\naCk7CiAgICAgICAgICAgICAgICBpbnQgc3BjOwogICAgICAgICAgICAgICAg\nYm9vbGVhbiBhc2M7CiAgICAgICAgICAgICAgICBmb3IgKGludCBpID0gMDsg\naSA8IGRlY3MubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICAgICAgICBk\nZWNzW2ldID0gZGVjc1tpXS50cmltKCk7CiAgICAgICAgICAgICAgICAgICAg\nc3BjID0gZGVjc1tpXS5pbmRleE9mKCcgJyk7CiAgICAgICAgICAgICAgICAg\nICAgaWYgKHNwYyA9PSAtMSkKICAgICAgICAgICAgICAgICAgICAgICAgYXNj\nID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAg\nICAgICAgICAgICAgICAgYXNjID0gZGVjc1tpXS5zdWJzdHJpbmcoc3BjICsg\nMSkudHJpbSgpLgogICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9Mb3dl\nckNhc2UoKS5zdGFydHNXaXRoKCJhc2MiKTsKICAgICAgICAgICAgICAgICAg\nICAgICAgZGVjc1tpXSA9IGRlY3NbaV0uc3Vic3RyaW5nKDAsIHNwYyk7CiAg\nICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIG9yZGVy\nc1tpXSA9IGdldFJlcG9zaXRvcnkoKS5uZXdPcmRlcih0aGlzLCBkZWNzW2ld\nLCBhc2MpOwogICAgICAgICAgICAgICAgICAgIC8vc2V0ICJpc1VzZWRJbk9y\nZGVyQnkiIHRvIHRoZSBmaWVsZAogICAgICAgICAgICAgICAgICAgIENsYXNz\nTWV0YURhdGEgZWxlbUNscyA9IGdldEVsZW1lbnQoKQogICAgICAgICAgICAg\nICAgICAgICAgICAuZ2V0RGVjbGFyZWRUeXBlTWV0YURhdGEoKTsKICAgICAg\nICAgICAgICAgICAgICBpZiAoZWxlbUNscyAhPSBudWxsKSB7CiAgICAgICAg\nICAgICAgICAgICAgICBGaWVsZE1ldGFEYXRhIGZtZCA9IGVsZW1DbHMuZ2V0\nRGVjbGFyZWRGaWVsZChkZWNzW2ldKTsKICAgICAgICAgICAgICAgICAgICAg\nIGlmIChmbWQgIT0gbnVsbCkKICAgICAgICAgICAgICAgICAgICAgICAgZm1k\nLnNldFVzZWRJbk9yZGVyQnkodHJ1ZSk7ICAgICAgICAgICAgICAgICAgICAg\nIAogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAg\nICAgICAgICAgICAgIF9vcmRlcnMgPSBvcmRlcnM7CiAgICAgICAgICAgIH0K\nICAgICAgICB9CiAgICAgICAgcmV0dXJuIF9vcmRlcnM7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBUaGUgb3JkZXJpbmdzIGZvciB0aGlzIGZpZWxkIHRvIGJl\nIGFwcGxpZWQgb24gbG9hZC4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0\nT3JkZXJzKE9yZGVyW10gb3JkZXJzKSB7CiAgICAgICAgX29yZGVyRGVjID0g\nbnVsbDsKICAgICAgICBfb3JkZXJzID0gb3JkZXJzOwogICAgfQoKICAgIC8q\nKgogICAgICogU3RyaW5nIGRlY2xhcmluZyB0aGUgb3JkZXJpbmdzIGZvciB0\naGlzIGZpZWxkIHRvIGJlIGFwcGxpZWQgb24gbG9hZCwKICAgICAqIG9yIG51\nbGwuIFRoZSBzdHJpbmcgaXMgb2YgdGhlIGZvcm06PGJyIC8+CiAgICAgKiA8\nY29kZT5vcmRlcmFibGVbIGFzY3xkZXNjXVssIC4uLl08L2NvZGU+PGJyIC8+\nCiAgICAgKiBUaGUgb3JkZXJhYmxlIDxjb2RlPiNlbGVtZW50PC9jb2RlPiBp\ncyB1c2VkIHRvIGRlbm90ZSB0aGUgdmFsdWUgb2YKICAgICAqIHRoZSBmaWVs\nZCdzIGVsZW1lbnRzLgogICAgICovCiAgICBwdWJsaWMgU3RyaW5nIGdldE9y\nZGVyRGVjbGFyYXRpb24oKSB7CiAgICAgICAgaWYgKF9vcmRlckRlYyA9PSBu\ndWxsICYmIF9vcmRlcnMgIT0gbnVsbCkgewogICAgICAgICAgICBTdHJpbmdC\ndWlsZGVyIGJ1ZiA9IG5ldyBTdHJpbmdCdWlsZGVyKCk7CiAgICAgICAgICAg\nIGZvciAoaW50IGkgPSAwOyBpIDwgX29yZGVycy5sZW5ndGg7IGkrKykgewog\nICAgICAgICAgICAgICAgaWYgKGkgPiAwKQogICAgICAgICAgICAgICAgICAg\nIGJ1Zi5hcHBlbmQoIiwgIik7CiAgICAgICAgICAgICAgICBidWYuYXBwZW5k\nKF9vcmRlcnNbaV0uZ2V0TmFtZSgpKS5hcHBlbmQoIiAiKTsKICAgICAgICAg\nICAgICAgIGJ1Zi5hcHBlbmQoKF9vcmRlcnNbaV0uaXNBc2NlbmRpbmcoKSkg\nPyAiYXNjIiA6ICJkZXNjIik7CiAgICAgICAgICAgIH0KICAgICAgICAgICAg\nX29yZGVyRGVjID0gYnVmLnRvU3RyaW5nKCk7CiAgICAgICAgfQogICAgICAg\nIHJldHVybiBfb3JkZXJEZWM7CiAgICB9CgogICAgLyoqCiAgICAgKiBTdHJp\nbmcgZGVjbGFyaW5nIHRoZSBvcmRlcmluZ3MgZm9yIHRoaXMgZmllbGQgdG8g\nYmUgYXBwbGllZCBvbiBsb2FkLAogICAgICogb3IgbnVsbC4gVGhlIHN0cmlu\nZyBpcyBvZiB0aGUgZm9ybTo8YnIgLz4KICAgICAqIDxjb2RlPm9yZGVyYWJs\nZVsgYXNjfGRlc2NdWywgLi4uXTwvY29kZT48YnIgLz4KICAgICAqIFRoZSBv\ncmRlcmFibGUgPGNvZGU+I2VsZW1lbnQ8L2NvZGU+IGlzIHVzZWQgdG8gZGVu\nb3RlIHRoZSB2YWx1ZSBvZgogICAgICogdGhlIGZpZWxkJ3MgZWxlbWVudHMu\nCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldE9yZGVyRGVjbGFyYXRpb24o\nU3RyaW5nIGRlYykgewogICAgICAgIF9vcmRlckRlYyA9IFN0cmluZ1V0aWxz\nLnRyaW1Ub051bGwoZGVjKTsKICAgICAgICBfb3JkZXJzID0gbnVsbDsKICAg\nIH0KCiAgICAvKioKICAgICAqIE9yZGVyIHRoaXMgZmllbGQgdmFsdWUgd2hl\nbiBpdCBpcyBsb2FkZWQuCiAgICAgKi8KICAgIHB1YmxpYyBPYmplY3Qgb3Jk\nZXIoT2JqZWN0IHZhbCkgewogICAgICAgIGlmICh2YWwgPT0gbnVsbCkKICAg\nICAgICAgICAgcmV0dXJuIG51bGw7CgogICAgICAgIE9yZGVyW10gb3JkZXJz\nID0gZ2V0T3JkZXJzKCk7CiAgICAgICAgaWYgKG9yZGVycy5sZW5ndGggPT0g\nMCkKICAgICAgICAgICAgcmV0dXJuIHZhbDsKCiAgICAgICAgLy8gY3JlYXRl\nIGEgY29tcGFyYXRvciBmb3IgdGhlIGVsZW1lbnRzIG9mIHRoZSB2YWx1ZQog\nICAgICAgIENvbXBhcmF0b3I8Pz4gY29tcDsKICAgICAgICBpZiAob3JkZXJz\nLmxlbmd0aCA9PSAxKQogICAgICAgICAgICBjb21wID0gb3JkZXJzWzBdLmdl\ndENvbXBhcmF0b3IoKTsKICAgICAgICBlbHNlIHsKICAgICAgICAgICAgTGlz\ndDxDb21wYXJhdG9yPD8+PiBjb21wcyA9IG51bGw7CiAgICAgICAgICAgIENv\nbXBhcmF0b3I8Pz4gY3VyQ29tcDsKICAgICAgICAgICAgZm9yIChpbnQgaSA9\nIDA7IGkgPCBvcmRlcnMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICAg\nIGN1ckNvbXAgPSBvcmRlcnNbaV0uZ2V0Q29tcGFyYXRvcigpOwogICAgICAg\nICAgICAgICAgaWYgKGN1ckNvbXAgIT0gbnVsbCkgewogICAgICAgICAgICAg\nICAgICAgIGlmIChjb21wcyA9PSBudWxsKQogICAgICAgICAgICAgICAgICAg\nICAgICBjb21wcyA9IG5ldyBBcnJheUxpc3Q8Q29tcGFyYXRvcjw/Pj4ob3Jk\nZXJzLmxlbmd0aCk7CiAgICAgICAgICAgICAgICAgICAgaWYgKGkgIT0gY29t\ncHMuc2l6ZSgpKQogICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcg\nTWV0YURhdGFFeGNlcHRpb24oX2xvYy5nZXQKICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICgibWl4ZWQtaW5tZW0tb3JkZXJpbmciLCB0aGlzKSk7CiAg\nICAgICAgICAgICAgICAgICAgY29tcHMuYWRkKGN1ckNvbXApOwogICAgICAg\nICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmIChjb21w\ncyA9PSBudWxsKQogICAgICAgICAgICAgICAgY29tcCA9IG51bGw7CiAgICAg\nICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIGNvbXAgPSBuZXcgQ29tcGFy\nYXRvckNoYWluKGNvbXBzKTsKICAgICAgICB9CgogICAgICAgIGlmIChjb21w\nID09IG51bGwpCiAgICAgICAgICAgIHJldHVybiB2YWw7CgogICAgICAgIC8v\nIHNvcnQKICAgICAgICBzd2l0Y2ggKGdldFR5cGVDb2RlKCkpIHsKICAgICAg\nICAgICAgY2FzZSBKYXZhVHlwZXMuQVJSQVk6CiAgICAgICAgICAgICAgICBM\naXN0IGwgPSBKYXZhVHlwZXMudG9MaXN0KHZhbCwgX2VsZW0uZ2V0VHlwZSgp\nLCB0cnVlKTsKICAgICAgICAgICAgICAgIENvbGxlY3Rpb25zLnNvcnQobCwg\nKENvbXBhcmF0b3I8PyBzdXBlciBPcmRlcj4pIGNvbXApOwogICAgICAgICAg\nICAgICAgcmV0dXJuIEphdmFUeXBlcy50b0FycmF5KGwsIF9lbGVtLmdldFR5\ncGUoKSk7CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLkNPTExFQ1RJT046\nCiAgICAgICAgICAgICAgICBpZiAodmFsIGluc3RhbmNlb2YgTGlzdCkKICAg\nICAgICAgICAgICAgICAgICBDb2xsZWN0aW9ucy5zb3J0KChMaXN0KSB2YWws\nIChDb21wYXJhdG9yPD8gc3VwZXIgT3JkZXI+KSBjb21wKTsKICAgICAgICAg\nICAgICAgIHJldHVybiB2YWw7CiAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAg\nICAgICAgICAgICB0aHJvdyBuZXcgTWV0YURhdGFFeGNlcHRpb24oX2xvYy5n\nZXQoImNhbnQtb3JkZXIiLCB0aGlzKSk7CiAgICAgICAgfQogICAgfQoKICAg\nIC8qKgogICAgICogV2hldGhlciB0aGUgZmllbGQgaXMgZXh0ZXJuYWxpemVk\nLgogICAgICovCiAgICBwdWJsaWMgYm9vbGVhbiBpc0V4dGVybmFsaXplZCgp\nIHsKICAgICAgICByZXR1cm4gZ2V0RXh0ZXJuYWxpemVyTWV0aG9kKCkgIT0g\nbnVsbAogICAgICAgICAgICB8fCBnZXRFeHRlcm5hbFZhbHVlTWFwKCkgIT0g\nbnVsbDsKICAgIH0KCiAgICAvKioKICAgICAqIENvbnZlcnQgdGhlIGdpdmVu\nIGZpZWxkIHZhbHVlIHRvIGl0cyBleHRlcm5hbCB2YWx1ZSB0aHJvdWdoIHRo\nZQogICAgICogcHJvdmlkZWQgZXh0ZXJuYWxpemVyLCBvciByZXR1cm4gdGhl\nIHZhbHVlIGFzLWlzIGlmIG5vIGV4dGVybmFsaXplci4KICAgICAqLwogICAg\ncHVibGljIE9iamVjdCBnZXRFeHRlcm5hbFZhbHVlKE9iamVjdCB2YWwsIFN0\nb3JlQ29udGV4dCBjdHgpIHsKICAgICAgICBNYXAgZXh0VmFsdWVzID0gZ2V0\nRXh0ZXJuYWxWYWx1ZU1hcCgpOwogICAgICAgIGlmIChleHRWYWx1ZXMgIT0g\nbnVsbCkgewogICAgICAgICAgICBPYmplY3QgZm91bmRWYWwgPSBleHRWYWx1\nZXMuZ2V0KHZhbCk7CiAgICAgICAgICAgIGlmIChmb3VuZFZhbCA9PSBudWxs\nKSB7CiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgVXNlckV4Y2VwdGlvbihf\nbG9jLmdldCgiYmFkLWV4dGVybmFsaXplZC12YWx1ZSIsCiAgICAgICAgICAg\nICAgICAgICAgICAgIG5ldyBPYmplY3RbXSB7IHZhbCwgZXh0VmFsdWVzLmtl\neVNldCgpLCB0aGlzIH0pKQogICAgICAgICAgICAgICAgICAgICAgICAuc2V0\nRmF0YWwodHJ1ZSkuc2V0RmFpbGVkT2JqZWN0KHZhbCk7CiAgICAgICAgICAg\nIH0gZWxzZSB7CiAgICAgICAgICAgICAgICByZXR1cm4gZm91bmRWYWw7CiAg\nICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIE1ldGhvZCBleHRlcm5h\nbGl6ZXIgPSBnZXRFeHRlcm5hbGl6ZXJNZXRob2QoKTsKICAgICAgICBpZiAo\nZXh0ZXJuYWxpemVyID09IG51bGwpCiAgICAgICAgICAgIHJldHVybiB2YWw7\nCgogICAgICAgIC8vIHNwZWNpYWwgY2FzZSBmb3IgcXVlcmllczogYWxsb3cg\ndGhlIGdpdmVuIHZhbHVlIHRvIHBhc3MgdGhyb3VnaAogICAgICAgIC8vIGFz\nLWlzIGlmIGl0IGlzIGFscmVhZHkgaW4gZXh0ZXJuYWxpemVkIGZvcm0KICAg\nICAgICBpZiAodmFsICE9IG51bGwgJiYgZ2V0VHlwZSgpLmlzSW5zdGFuY2Uo\ndmFsKQogICAgICAgICAgICAmJiAoIWdldERlY2xhcmVkVHlwZSgpLmlzSW5z\ndGFuY2UodmFsKQogICAgICAgICAgICB8fCBnZXREZWNsYXJlZFR5cGUoKSA9\nPSBPYmplY3QuY2xhc3MpKQogICAgICAgICAgICByZXR1cm4gdmFsOwoKICAg\nICAgICB0cnkgewogICAgICAgICAgICAvLyBlaXRoZXIgaW52b2tlIHRoZSBz\ndGF0aWMgdG9FeHRlcm5hbCh2YWxbLCBjdHhdKSBtZXRob2QsIG9yIHRoZQog\nICAgICAgICAgICAvLyBub24tc3RhdGljIHZhbC50b0V4dGVybmFsKFtjdHhd\nKSBtZXRob2QKICAgICAgICAgICAgaWYgKE1vZGlmaWVyLmlzU3RhdGljKGV4\ndGVybmFsaXplci5nZXRNb2RpZmllcnMoKSkpIHsKICAgICAgICAgICAgICAg\nIGlmIChleHRlcm5hbGl6ZXIuZ2V0UGFyYW1ldGVyVHlwZXMoKS5sZW5ndGgg\nPT0gMSkKICAgICAgICAgICAgICAgICAgICByZXR1cm4gZXh0ZXJuYWxpemVy\nLmludm9rZShudWxsLCBuZXcgT2JqZWN0W117IHZhbCB9KTsKICAgICAgICAg\nICAgICAgIHJldHVybiBleHRlcm5hbGl6ZXIuaW52b2tlKG51bGwsIG5ldyBP\nYmplY3RbXXsgdmFsLCBjdHggfSk7CiAgICAgICAgICAgIH0KICAgICAgICAg\nICAgaWYgKHZhbCA9PSBudWxsKQogICAgICAgICAgICAgICAgcmV0dXJuIG51\nbGw7CiAgICAgICAgICAgIGlmIChleHRlcm5hbGl6ZXIuZ2V0UGFyYW1ldGVy\nVHlwZXMoKS5sZW5ndGggPT0gMCkKICAgICAgICAgICAgICAgIHJldHVybiBl\neHRlcm5hbGl6ZXIuaW52b2tlKHZhbCwgKE9iamVjdFtdKSBudWxsKTsKICAg\nICAgICAgICAgcmV0dXJuIGV4dGVybmFsaXplci5pbnZva2UodmFsLCBuZXcg\nT2JqZWN0W117IGN0eCB9KTsKICAgICAgICB9IGNhdGNoIChPcGVuSlBBRXhj\nZXB0aW9uIGtlKSB7CiAgICAgICAgICAgIHRocm93IGtlOwogICAgICAgIH0g\nY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBN\nZXRhRGF0YUV4Y2VwdGlvbihfbG9jLmdldCgiZXh0ZXJuYWxpemVyLWVyciIs\nIHRoaXMsCiAgICAgICAgICAgICAgICBFeGNlcHRpb25zLnRvU3RyaW5nKHZh\nbCksIGUudG9TdHJpbmcoKSkpLnNldENhdXNlKGUpOwogICAgICAgIH0KICAg\nIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgcmVzdWx0IG9mIHBhc3Np\nbmcgdGhlIGdpdmVuIGV4dGVybmFsIHZhbHVlIHRocm91Z2ggdGhlCiAgICAg\nKiBmYWN0b3J5IHRvIGdldCB0aGUgZmllbGQgdmFsdWUuIElmIG5vIGZhY3Rv\ncnkgaXMgcHJlc2VudCwKICAgICAqIHRoZSBnaXZlbiB2YWx1ZSBpcyByZXR1\ncm5lZCBhcy1pcy4KICAgICAqLwogICAgcHVibGljIE9iamVjdCBnZXRGaWVs\nZFZhbHVlKE9iamVjdCB2YWwsIFN0b3JlQ29udGV4dCBjdHgpIHsKICAgICAg\nICBNYXAgZmllbGRWYWx1ZXMgPSBnZXRGaWVsZFZhbHVlTWFwKCk7CiAgICAg\nICAgaWYgKGZpZWxkVmFsdWVzICE9IG51bGwpCiAgICAgICAgICAgIHJldHVy\nbiBmaWVsZFZhbHVlcy5nZXQodmFsKTsKCiAgICAgICAgTWVtYmVyIGZhY3Rv\ncnkgPSBnZXRGYWN0b3J5TWV0aG9kKCk7CiAgICAgICAgaWYgKGZhY3Rvcnkg\nPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIHZhbDsKCiAgICAgICAgdHJ5\nIHsKICAgICAgICAgICAgaWYgKHZhbCA9PSBudWxsICYmIGdldE51bGxWYWx1\nZSgpID09IE5VTExfREVGQVVMVCkKICAgICAgICAgICAgICAgIHJldHVybiBB\nY2Nlc3NDb250cm9sbGVyLmRvUHJpdmlsZWdlZCgKICAgICAgICAgICAgICAg\nICAgICBKMkRvUHJpdkhlbHBlci5uZXdJbnN0YW5jZUFjdGlvbihnZXREZWNs\nYXJlZFR5cGUoKSkpOyAKCiAgICAgICAgICAgIC8vIGludm9rZSBlaXRoZXIg\ndGhlIGNvbnN0cnVjdG9yIGZvciB0aGUgZmllbGQgdHlwZSwKICAgICAgICAg\nICAgLy8gb3IgdGhlIHN0YXRpYyB0eXBlLnRvRmllbGQodmFsWywgY3R4XSkg\nbWV0aG9kCiAgICAgICAgICAgIGlmIChmYWN0b3J5IGluc3RhbmNlb2YgQ29u\nc3RydWN0b3IpIHsKICAgICAgICAgICAgICAgIGlmICh2YWwgPT0gbnVsbCkK\nICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICAgICAg\nICAgIHJldHVybiAoKENvbnN0cnVjdG9yKSBmYWN0b3J5KS5uZXdJbnN0YW5j\nZQogICAgICAgICAgICAgICAgICAgIChuZXcgT2JqZWN0W117IHZhbCB9KTsK\nICAgICAgICAgICAgfQoKICAgICAgICAgICAgTWV0aG9kIG1ldGggPSAoTWV0\naG9kKSBmYWN0b3J5OwogICAgICAgICAgICBpZiAobWV0aC5nZXRQYXJhbWV0\nZXJUeXBlcygpLmxlbmd0aCA9PSAxKQogICAgICAgICAgICAgICAgcmV0dXJu\nIG1ldGguaW52b2tlKG51bGwsIG5ldyBPYmplY3RbXXsgdmFsIH0pOwogICAg\nICAgICAgICByZXR1cm4gbWV0aC5pbnZva2UobnVsbCwgbmV3IE9iamVjdFtd\neyB2YWwsIGN0eCB9KTsKICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkg\newogICAgICAgICAgICAvLyB1bndyYXAgY2F1c2UKICAgICAgICAgICAgaWYg\nKGUgaW5zdGFuY2VvZiBJbnZvY2F0aW9uVGFyZ2V0RXhjZXB0aW9uKSB7CiAg\nICAgICAgICAgICAgICBUaHJvd2FibGUgdCA9ICgoSW52b2NhdGlvblRhcmdl\ndEV4Y2VwdGlvbikgZSkuCiAgICAgICAgICAgICAgICAgICAgZ2V0VGFyZ2V0\nRXhjZXB0aW9uKCk7CiAgICAgICAgICAgICAgICBpZiAodCBpbnN0YW5jZW9m\nIEVycm9yKQogICAgICAgICAgICAgICAgICAgIHRocm93IChFcnJvcikgdDsK\nICAgICAgICAgICAgICAgIGUgPSAoRXhjZXB0aW9uKSB0OwoKICAgICAgICAg\nICAgICAgIC8vIGFsbG93IG51bGwgdmFsdWVzIHRvIGNhdXNlIE5QRXMgYW5k\nIGlsbGVnYWwgYXJnIGV4Y2VwdGlvbnMKICAgICAgICAgICAgICAgIC8vIHdp\ndGhvdXQgZXJyb3IKICAgICAgICAgICAgICAgIGlmICh2YWwgPT0gbnVsbCAm\nJiAoZSBpbnN0YW5jZW9mIE51bGxQb2ludGVyRXhjZXB0aW9uCiAgICAgICAg\nICAgICAgICAgICAgfHwgZSBpbnN0YW5jZW9mIElsbGVnYWxBcmd1bWVudEV4\nY2VwdGlvbikpCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAg\nICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmIChlIGluc3RhbmNlb2YgT3Bl\nbkpQQUV4Y2VwdGlvbikKICAgICAgICAgICAgICAgIHRocm93IChPcGVuSlBB\nRXhjZXB0aW9uKSBlOwogICAgICAgICAgICBpZiAoZSBpbnN0YW5jZW9mIFBy\naXZpbGVnZWRBY3Rpb25FeGNlcHRpb24pCiAgICAgICAgICAgICAgICBlID0g\nKChQcml2aWxlZ2VkQWN0aW9uRXhjZXB0aW9uKSBlKS5nZXRFeGNlcHRpb24o\nKTsKICAgICAgICAgICAgdGhyb3cgbmV3IE1ldGFEYXRhRXhjZXB0aW9uKF9s\nb2MuZ2V0KCJmYWN0b3J5LWVyciIsIHRoaXMsCiAgICAgICAgICAgICAgICBF\neGNlcHRpb25zLnRvU3RyaW5nKHZhbCksIGUudG9TdHJpbmcoKSkpLnNldENh\ndXNlKGUpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIFRoZSBu\nYW1lIG9mIHRoaXMgZmllbGQncyBleHRlcm5hbGl6ZXIsIG9yIG51bGwgaWYg\nbm9uZS4KICAgICAqLwogICAgcHVibGljIFN0cmluZyBnZXRFeHRlcm5hbGl6\nZXIoKSB7CiAgICAgICAgcmV0dXJuIF9leHROYW1lOwogICAgfQoKICAgIC8q\nKgogICAgICogVGhlIG5hbWUgb2YgdGhpcyBmaWVsZCdzIGV4dGVybmFsaXpl\nciwgb3IgbnVsbCBpZiBub25lLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBz\nZXRFeHRlcm5hbGl6ZXIoU3RyaW5nIGV4dGVybmFsaXplcikgewogICAgICAg\nIF9leHROYW1lID0gZXh0ZXJuYWxpemVyOwogICAgICAgIF9leHRNZXRob2Qg\nPSBERUZBVUxUX01FVEhPRDsKICAgIH0KCiAgICAvKioKICAgICAqIFRoZSBu\nYW1lIG9mIHRoaXMgZmllbGQncyBmYWN0b3J5LCBvciBudWxsIGlmIG5vbmUu\nCiAgICAgKi8KICAgIHB1YmxpYyBTdHJpbmcgZ2V0RmFjdG9yeSgpIHsKICAg\nICAgICByZXR1cm4gX2ZhY3ROYW1lOwogICAgfQoKICAgIC8qKgogICAgICog\nVGhlIG5hbWUgb2YgdGhpcyBmaWVsZCdzIGZhY3RvcnksIG9yIG51bGwgaWYg\nbm9uZS4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0RmFjdG9yeShTdHJp\nbmcgZmFjdG9yeSkgewogICAgICAgIF9mYWN0TmFtZSA9IGZhY3Rvcnk7CiAg\nICAgICAgX2ZhY3RNZXRob2QgPSBERUZBVUxUX01FVEhPRDsKICAgIH0KCiAg\nICAvKioKICAgICAqIFByb3BlcnRpZXMgc3RyaW5nIG1hcHBpbmcgZmllbGQg\ndmFsdWVzIHRvIGV4dGVybmFsIHZhbHVlcy4KICAgICAqLwogICAgcHVibGlj\nIFN0cmluZyBnZXRFeHRlcm5hbFZhbHVlcygpIHsKICAgICAgICByZXR1cm4g\nX2V4dFN0cmluZzsKICAgIH0KCiAgICAvKioKICAgICAqIFByb3BlcnRpZXMg\nc3RyaW5nIG1hcHBpbmcgZmllbGQgdmFsdWVzIHRvIGV4dGVybmFsIHZhbHVl\ncy4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0RXh0ZXJuYWxWYWx1ZXMo\nU3RyaW5nIHZhbHVlcykgewogICAgICAgIF9leHRTdHJpbmcgPSB2YWx1ZXM7\nCiAgICAgICAgX2V4dFZhbHVlcyA9IG51bGw7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBSZXR1cm4gdGhlIG1hcHBpbmcgb2YgZmllbGQgdmFsdWVzIHRvIGV4\ndGVybmFsIHZhbHVlcy4KICAgICAqLwogICAgcHVibGljIE1hcCBnZXRFeHRl\ncm5hbFZhbHVlTWFwKCkgewogICAgICAgIHBhcnNlRXh0ZXJuYWxWYWx1ZXMo\nKTsKICAgICAgICByZXR1cm4gX2V4dFZhbHVlczsKICAgIH0KCiAgICAvKioK\nICAgICAqIFJldHVybiB0aGUgbWFwcGluZyBvZiBleHRlcm5hbCB2YWx1ZXMg\ndG8gZmllbGQgdmFsdWVzLgogICAgICovCiAgICBwdWJsaWMgTWFwIGdldEZp\nZWxkVmFsdWVNYXAoKSB7CiAgICAgICAgcGFyc2VFeHRlcm5hbFZhbHVlcygp\nOwogICAgICAgIHJldHVybiBfZmllbGRWYWx1ZXM7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBQYXJzZSBleHRlcm5hbCB2YWx1ZXMgaW50byBtYXBzLgogICAg\nICovCiAgICBwcml2YXRlIHZvaWQgcGFyc2VFeHRlcm5hbFZhbHVlcygpIHsK\nICAgICAgICBpZiAoX2V4dFZhbHVlcyAhPSBDb2xsZWN0aW9ucy5FTVBUWV9N\nQVAKICAgICAgICAgICAgJiYgX2ZpZWxkVmFsdWVzICE9IENvbGxlY3Rpb25z\nLkVNUFRZX01BUCkKICAgICAgICAgICAgcmV0dXJuOwoKICAgICAgICBpZiAo\nX2V4dFN0cmluZyA9PSBudWxsKSB7CiAgICAgICAgICAgIF9leHRWYWx1ZXMg\nPSBudWxsOwogICAgICAgICAgICBfZmllbGRWYWx1ZXMgPSBudWxsOwogICAg\nICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICAvLyBwYXJzZSBz\ndHJpbmcgaW50byBvcHRpb25zOyB0aGlzIHRha2VzIGNhcmUgb2YgcHJvcGVy\nIHRyaW1taW5nIGV0YwogICAgICAgIE9wdGlvbnMgdmFsdWVzID0gQ29uZmln\ndXJhdGlvbnMucGFyc2VQcm9wZXJ0aWVzKF9leHRTdHJpbmcpOwogICAgICAg\nIGlmICh2YWx1ZXMuaXNFbXB0eSgpKQogICAgICAgICAgICB0aHJvdyBuZXcg\nTWV0YURhdGFFeGNlcHRpb24oX2xvYy5nZXQoIm5vLWV4dGVybmFsLXZhbHVl\ncyIsIHRoaXMsCiAgICAgICAgICAgICAgICBfZXh0U3RyaW5nKSk7CgogICAg\nICAgIE1hcCBleHRWYWx1ZXMgPSBuZXcgSGFzaE1hcCgoaW50KSAodmFsdWVz\nLnNpemUoKSAqIDEuMzMgKyAxKSk7CiAgICAgICAgTWFwIGZpZWxkVmFsdWVz\nID0gbmV3IEhhc2hNYXAoKGludCkgKHZhbHVlcy5zaXplKCkgKiAxLjMzICsg\nMSkpOwogICAgICAgIE1hcC5FbnRyeSBlbnRyeTsKICAgICAgICBPYmplY3Qg\nZXh0VmFsdWUsIGZpZWxkVmFsdWU7CiAgICAgICAgZm9yIChJdGVyYXRvciBp\ndHIgPSB2YWx1ZXMuZW50cnlTZXQoKS5pdGVyYXRvcigpOyBpdHIuaGFzTmV4\ndCgpOykgewogICAgICAgICAgICBlbnRyeSA9IChNYXAuRW50cnkpIGl0ci5u\nZXh0KCk7CiAgICAgICAgICAgIGZpZWxkVmFsdWUgPSB0cmFuc2Zvcm0oKFN0\ncmluZykgZW50cnkuZ2V0S2V5KCksCiAgICAgICAgICAgICAgICBnZXREZWNs\nYXJlZFR5cGVDb2RlKCkpOwogICAgICAgICAgICBleHRWYWx1ZSA9IHRyYW5z\nZm9ybSgoU3RyaW5nKSBlbnRyeS5nZXRWYWx1ZSgpLCBnZXRUeXBlQ29kZSgp\nKTsKCiAgICAgICAgICAgIGV4dFZhbHVlcy5wdXQoZmllbGRWYWx1ZSwgZXh0\nVmFsdWUpOwogICAgICAgICAgICBmaWVsZFZhbHVlcy5wdXQoZXh0VmFsdWUs\nIGZpZWxkVmFsdWUpOwogICAgICAgIH0KCiAgICAgICAgX2V4dFZhbHVlcyA9\nIGV4dFZhbHVlczsKICAgICAgICBfZmllbGRWYWx1ZXMgPSBmaWVsZFZhbHVl\nczsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgc3RyaW5nIHZh\nbHVlIGNvbnZlcnRlZCB0byB0aGUgZ2l2ZW4gdHlwZSBjb2RlLiBUaGUgc3Ry\naW5nCiAgICAgKiBtdXN0IGJlIG5vbi1udWxsIGFuZCB0cmltbWVkLgogICAg\nICovCiAgICBwcml2YXRlIE9iamVjdCB0cmFuc2Zvcm0oU3RyaW5nIHZhbCwg\naW50IHR5cGVDb2RlKSB7CiAgICAgICAgaWYgKCJudWxsIi5lcXVhbHModmFs\nKSkKICAgICAgICAgICAgcmV0dXJuIG51bGw7CgogICAgICAgIHN3aXRjaCAo\ndHlwZUNvZGUpIHsKICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuQk9PTEVB\nTjoKICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuQk9PTEVBTl9PQko6CiAg\nICAgICAgICAgICAgICByZXR1cm4gQm9vbGVhbi52YWx1ZU9mKHZhbCk7CiAg\nICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLkJZVEU6CiAgICAgICAgICAgIGNh\nc2UgSmF2YVR5cGVzLkJZVEVfT0JKOgogICAgICAgICAgICAgICAgcmV0dXJu\nIEJ5dGUudmFsdWVPZih2YWwpOwogICAgICAgICAgICBjYXNlIEphdmFUeXBl\ncy5JTlQ6CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLklOVF9PQko6CiAg\nICAgICAgICAgICAgICByZXR1cm4gSW50ZWdlci52YWx1ZU9mKHZhbCk7CiAg\nICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLkxPTkc6CiAgICAgICAgICAgIGNh\nc2UgSmF2YVR5cGVzLkxPTkdfT0JKOgogICAgICAgICAgICAgICAgcmV0dXJu\nIExvbmcudmFsdWVPZih2YWwpOwogICAgICAgICAgICBjYXNlIEphdmFUeXBl\ncy5TSE9SVDoKICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuU0hPUlRfT0JK\nOgogICAgICAgICAgICAgICAgcmV0dXJuIFNob3J0LnZhbHVlT2YodmFsKTsK\nICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuRE9VQkxFOgogICAgICAgICAg\nICBjYXNlIEphdmFUeXBlcy5ET1VCTEVfT0JKOgogICAgICAgICAgICAgICAg\ncmV0dXJuIERvdWJsZS52YWx1ZU9mKHZhbCk7CiAgICAgICAgICAgIGNhc2Ug\nSmF2YVR5cGVzLkZMT0FUOgogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5G\nTE9BVF9PQko6CiAgICAgICAgICAgICAgICByZXR1cm4gRmxvYXQudmFsdWVP\nZih2YWwpOwogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5DSEFSOgogICAg\nICAgICAgICBjYXNlIEphdmFUeXBlcy5DSEFSX09CSjoKICAgICAgICAgICAg\nICAgIHJldHVybiBuZXcgQ2hhcmFjdGVyKHZhbC5jaGFyQXQoMCkpOwogICAg\nICAgICAgICBjYXNlIEphdmFUeXBlcy5TVFJJTkc6CiAgICAgICAgICAgICAg\nICByZXR1cm4gdmFsOwogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5FTlVN\nOgogICAgICAgICAgICAgICAgcmV0dXJuIEVudW0udmFsdWVPZigoQ2xhc3M8\nPyBleHRlbmRzIEVudW0+KWdldERlY2xhcmVkVHlwZSgpLCB2YWwpOwogICAg\nICAgIH0KICAgICAgICB0aHJvdyBuZXcgTWV0YURhdGFFeGNlcHRpb24oX2xv\nYy5nZXQoImJhZC1leHRlcm5hbC10eXBlIiwgdGhpcykpOwogICAgfQoKICAg\nIC8qKgogICAgICogVGhlIGV4dGVybmFsaXplciBtZXRob2QuCiAgICAgKi8K\nICAgIHB1YmxpYyBNZXRob2QgZ2V0RXh0ZXJuYWxpemVyTWV0aG9kKCkgewog\nICAgICAgIGlmIChfbWFuYWdlICE9IE1BTkFHRV9QRVJTSVNURU5UKQogICAg\nICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICBpZiAoX2V4dE1ldGhvZCA9\nPSBERUZBVUxUX01FVEhPRCkgewogICAgICAgICAgICBpZiAoX2V4dE5hbWUg\nIT0gbnVsbCkgewogICAgICAgICAgICAgICAgX2V4dE1ldGhvZCA9IGZpbmRN\nZXRob2QoX2V4dE5hbWUpOwogICAgICAgICAgICAgICAgaWYgKF9leHRNZXRo\nb2QgPT0gbnVsbCkKICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgTWV0\nYURhdGFFeGNlcHRpb24oX2xvYy5nZXQoImJhZC1leHRlcm5hbGl6ZXIiLAog\nICAgICAgICAgICAgICAgICAgICAgICB0aGlzLCBfZXh0TmFtZSkpOwogICAg\nICAgICAgICB9IGVsc2UKICAgICAgICAgICAgICAgIF9leHRNZXRob2QgPSBu\ndWxsOwogICAgICAgIH0KICAgICAgICByZXR1cm4gX2V4dE1ldGhvZDsKICAg\nIH0KCiAgICAvKioKICAgICAqIFRoZSBmYWN0b3J5IG1ldGhvZCBvciBjb25z\ndHJ1Y3Rvci4KICAgICAqLwogICAgcHVibGljIE1lbWJlciBnZXRGYWN0b3J5\nTWV0aG9kKCkgewogICAgICAgIGlmIChfbWFuYWdlICE9IE1BTkFHRV9QRVJT\nSVNURU5UKQogICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICBpZiAo\nX2ZhY3RNZXRob2QgPT0gREVGQVVMVF9NRVRIT0QpIHsKICAgICAgICAgICAg\naWYgKGdldEV4dGVybmFsaXplck1ldGhvZCgpID09IG51bGwpCiAgICAgICAg\nICAgICAgICBfZmFjdE1ldGhvZCA9IG51bGw7CiAgICAgICAgICAgIGVsc2Ug\newogICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICBp\nZiAoX2ZhY3ROYW1lID09IG51bGwpCiAgICAgICAgICAgICAgICAgICAgICAg\nIF9mYWN0TWV0aG9kID0gZ2V0RGVjbGFyZWRUeXBlKCkuZ2V0Q29uc3RydWN0\nb3IKICAgICAgICAgICAgICAgICAgICAgICAgICAgIChuZXcgQ2xhc3NbXXsg\nZ2V0VHlwZSgpIH0pOwogICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAg\nICAgICAgICAgICAgICAgICAgX2ZhY3RNZXRob2QgPSBmaW5kTWV0aG9kKF9m\nYWN0TmFtZSk7CiAgICAgICAgICAgICAgICB9IGNhdGNoIChPcGVuSlBBRXhj\nZXB0aW9uIGtlKSB7CiAgICAgICAgICAgICAgICAgICAgdGhyb3cga2U7CiAg\nICAgICAgICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkgewogICAgICAg\nICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGlmICghKF9mYWN0TWV0aG9k\nIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpCiAgICAgICAgICAgICAgICAgICAg\nJiYgIShfZmFjdE1ldGhvZCBpbnN0YW5jZW9mIE1ldGhvZCkpCiAgICAgICAg\nICAgICAgICAgICAgdGhyb3cgbmV3IE1ldGFEYXRhRXhjZXB0aW9uKF9sb2Mu\nZ2V0KCJiYWQtZmFjdG9yeSIsIHRoaXMpKTsKICAgICAgICAgICAgfQogICAg\nICAgIH0KICAgICAgICByZXR1cm4gX2ZhY3RNZXRob2Q7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBGaW5kIHRoZSBtZXRob2QgZm9yIHRoZSBzcGVjaWZpZWQg\nbmFtZS4gUG9zc2libGUgZm9ybXMgYXJlOgogICAgICogPHVsPgogICAgICog\nPGxpPnRvRXh0ZXJuYWxTdHJpbmc8L2xpPgogICAgICogPGxpPk15RmFjdG9y\neUNsYXNzLnRvRXh0ZXJuYWxTdHJpbmc8L2xpPgogICAgICogPGxpPmNvbS5j\nb21wYW55Lk15RmFjdG9yeUNsYXNzLnRvRXh0ZXJuYWxTdHJpbmc8L2xpPgog\nICAgICogPC91bD4KICAgICAqCiAgICAgKiBAcGFyYW0gbWV0aG9kIHRoZSBu\nYW1lIG9mIHRoZSBtZXRob2QgdG8gbG9jYXRlCiAgICAgKiBAcmV0dXJuIHRo\nZSBtZXRob2QgZm9yIGludm9jYXRpb24KICAgICAqLwogICAgcHJpdmF0ZSBN\nZXRob2QgZmluZE1ldGhvZChTdHJpbmcgbWV0aG9kKSB7CiAgICAgICAgaWYg\nKFN0cmluZ1V0aWxzLmlzRW1wdHkobWV0aG9kKSkKICAgICAgICAgICAgcmV0\ndXJuIG51bGw7CgogICAgICAgIC8vIGdldCBjbGFzcyBuYW1lIGFuZCBnZXQg\ncGFja2FnZSBuYW1lIGRpdmlkZSBvbiB0aGUgbGFzdCAnLicsIHNvIHRoZQog\nICAgICAgIC8vIG5hbWVzIGRvbid0IGFwcGx5IGluIHRoaXMgY2FzZSwgYnV0\nIHRoZSBtZXRob2RzIGRvIHdoYXQgd2Ugd2FudAogICAgICAgIFN0cmluZyBt\nZXRob2ROYW1lID0gU3RyaW5ncy5nZXRDbGFzc05hbWUobWV0aG9kKTsKICAg\nICAgICBTdHJpbmcgY2xzTmFtZSA9IFN0cmluZ3MuZ2V0UGFja2FnZU5hbWUo\nbWV0aG9kKTsKCiAgICAgICAgQ2xhc3M8Pz4gY2xzID0gbnVsbDsKICAgICAg\nICBDbGFzczw/PiBvd25lciA9IF9vd25lci5nZXREZXNjcmliZWRUeXBlKCk7\nCgogICAgICAgIGlmIChjbHNOYW1lLmxlbmd0aCgpID09IDApCiAgICAgICAg\nICAgIGNscyA9IGdldERlY2xhcmVkVHlwZSgpOwogICAgICAgIGVsc2UgaWYg\nKGNsc05hbWUuZXF1YWxzKG93bmVyLmdldE5hbWUoKSkKICAgICAgICAgICAg\nfHwgY2xzTmFtZS5lcXVhbHMoU3RyaW5ncy5nZXRDbGFzc05hbWUob3duZXIp\nKSkKICAgICAgICAgICAgY2xzID0gb3duZXI7CiAgICAgICAgZWxzZQogICAg\nICAgICAgICBjbHMgPSBKYXZhVHlwZXMuY2xhc3NGb3JOYW1lKGNsc05hbWUs\nIHRoaXMpOwoKICAgICAgICAvLyBmaW5kIHRoZSBuYW1lZCBtZXRob2QKICAg\nICAgICBNZXRob2RbXSBtZXRob2RzID0gY2xzLmdldE1ldGhvZHMoKTsKICAg\nICAgICBDbGFzczw/PltdIHBhcmFtczsKICAgICAgICBmb3IgKGludCBpID0g\nMDsgaSA8IG1ldGhvZHMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgaWYg\nKG1ldGhvZHNbaV0uZ2V0TmFtZSgpLmVxdWFscyhtZXRob2ROYW1lKSkgewog\nICAgICAgICAgICAgICAgcGFyYW1zID0gbWV0aG9kc1tpXS5nZXRQYXJhbWV0\nZXJUeXBlcygpOwoKICAgICAgICAgICAgICAgIC8vIHN0YXRpYyBmYWN0b3J5\nIG1ldGhvZHMgcmVxdWlyZSBvbmUgYXJndW1lbnQgb3Igb25lIGFyZ3VtZW50\nCiAgICAgICAgICAgICAgICAvLyBwbHVzIGEgY29udGV4dDsgbm9uLXN0YXRp\nYyBtZXRob2RzIHJlcXVpcmUgemVybyBhcmd1bWVudHMgb3IKICAgICAgICAg\nICAgICAgIC8vIGp1c3QgYSBjb250ZXh0CiAgICAgICAgICAgICAgICBpZiAo\nTW9kaWZpZXIuaXNTdGF0aWMobWV0aG9kc1tpXS5nZXRNb2RpZmllcnMoKSkK\nICAgICAgICAgICAgICAgICAgICAmJiAocGFyYW1zLmxlbmd0aCA9PSAxIHx8\nIChwYXJhbXMubGVuZ3RoID09IDIKICAgICAgICAgICAgICAgICAgICAmJiBp\nc1N0b3JlQ29udGV4dFBhcmFtZXRlcihwYXJhbXNbMV0pKSkpCiAgICAgICAg\nICAgICAgICAgICAgcmV0dXJuIG1ldGhvZHNbaV07CiAgICAgICAgICAgICAg\nICBpZiAoIU1vZGlmaWVyLmlzU3RhdGljKG1ldGhvZHNbaV0uZ2V0TW9kaWZp\nZXJzKCkpCiAgICAgICAgICAgICAgICAgICAgJiYgKHBhcmFtcy5sZW5ndGgg\nPT0gMCB8fCAocGFyYW1zLmxlbmd0aCA9PSAxCiAgICAgICAgICAgICAgICAg\nICAgJiYgaXNTdG9yZUNvbnRleHRQYXJhbWV0ZXIocGFyYW1zWzBdKSkpKQog\nICAgICAgICAgICAgICAgICAgIHJldHVybiBtZXRob2RzW2ldOwogICAgICAg\nICAgICB9CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gbnVsbDsKICAgIH0K\nCiAgICAvKioKICAgICAqIFJldHVybiB0cnVlIGlmIHRoZSBnaXZlbiB0eXBl\nIGlzIGEgc3RvcmUgY29udGV4dCB0eXBlOyB3ZSBjYW4ndAogICAgICogdXNl\nIHRoZSBzdGFuZGFyZCA8Y29kZT5pc0Fzc2lnbmFibGVGcm9tPC9jb2RlPiBi\nZWNhdXNlIG9mIGNsYXNzbG9hZGVyCiAgICAgKiBvZGRuZXNzLgogICAgICov\nCiAgICBwcml2YXRlIHN0YXRpYyBib29sZWFuIGlzU3RvcmVDb250ZXh0UGFy\nYW1ldGVyKENsYXNzPD8+IHR5cGUpIHsKICAgICAgICByZXR1cm4gU3RvcmVD\nb250ZXh0LmNsYXNzLmdldE5hbWUoKS5lcXVhbHModHlwZS5nZXROYW1lKCkp\nOwogICAgfQoKICAgIHB1YmxpYyBib29sZWFuIGVxdWFscyhPYmplY3Qgb3Ro\nZXIpIHsKICAgICAgICBpZiAob3RoZXIgPT0gdGhpcykKICAgICAgICAgICAg\ncmV0dXJuIHRydWU7CiAgICAgICAgaWYgKCEob3RoZXIgaW5zdGFuY2VvZiBG\naWVsZE1ldGFEYXRhKSkKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAg\nICAgIHJldHVybiBnZXRGdWxsTmFtZSh0cnVlKS5lcXVhbHMoKChGaWVsZE1l\ndGFEYXRhKSBvdGhlcikuCiAgICAgICAgICAgIGdldEZ1bGxOYW1lKHRydWUp\nKTsKICAgIH0KCiAgICBwdWJsaWMgaW50IGhhc2hDb2RlKCkgewogICAgICAg\nIHJldHVybiBnZXRGdWxsTmFtZSh0cnVlKS5oYXNoQ29kZSgpOwogICAgfQoK\nICAgIHB1YmxpYyBpbnQgY29tcGFyZVRvKE9iamVjdCBvdGhlcikgewogICAg\nICAgIGlmIChvdGhlciA9PSBudWxsKQogICAgICAgICAgICByZXR1cm4gMTsK\nICAgICAgICByZXR1cm4gZ2V0RnVsbE5hbWUodHJ1ZSkuY29tcGFyZVRvKCgo\nRmllbGRNZXRhRGF0YSkgb3RoZXIpLgogICAgICAgICAgICBnZXRGdWxsTmFt\nZSh0cnVlKSk7CiAgICB9CgogICAgcHVibGljIFN0cmluZyB0b1N0cmluZygp\nIHsKICAgICAgICByZXR1cm4gZ2V0RnVsbE5hbWUodHJ1ZSk7CiAgICB9Cgog\nICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgICAvLyBSZXNvbHZlIGFu\nZCB2YWxpZGF0ZQogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCgogICAg\nLyoqCiAgICAgKiBSZXNvbHZlIG1vZGUgZm9yIHRoaXMgZmllbGQuCiAgICAg\nKi8KICAgIHB1YmxpYyBpbnQgZ2V0UmVzb2x2ZSgpIHsKICAgICAgICByZXR1\ncm4gX3Jlc01vZGU7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXNvbHZlIG1v\nZGUgZm9yIHRoaXMgZmllbGQuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNl\ndFJlc29sdmUoaW50IG1vZGUpIHsKICAgICAgICBfcmVzTW9kZSA9IG1vZGU7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBSZXNvbHZlIG1vZGUgZm9yIHRoaXMg\nZmllbGQuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldFJlc29sdmUoaW50\nIG1vZGUsIGJvb2xlYW4gb24pIHsKICAgICAgICBpZiAobW9kZSA9PSBNT0RF\nX05PTkUpCiAgICAgICAgICAgIF9yZXNNb2RlID0gbW9kZTsKICAgICAgICBl\nbHNlIGlmIChvbikKICAgICAgICAgICAgX3Jlc01vZGUgfD0gbW9kZTsKICAg\nICAgICBlbHNlCiAgICAgICAgICAgIF9yZXNNb2RlICY9IH5tb2RlOwogICAg\nfQoKICAgIC8qKgogICAgICogUmVzb2x2ZSBhbmQgdmFsaWRhdGUgbWV0YWRh\ndGEuIFJldHVybiB0cnVlIGlmIGFscmVhZHkgcmVzb2x2ZWQuCiAgICAgKi8K\nICAgIHB1YmxpYyBib29sZWFuIHJlc29sdmUoaW50IG1vZGUpIHsKICAgICAg\nICBpZiAoKF9yZXNNb2RlICYgbW9kZSkgPT0gbW9kZSkKICAgICAgICAgICAg\ncmV0dXJuIHRydWU7CiAgICAgICAgaW50IGN1ciA9IF9yZXNNb2RlOwogICAg\nICAgIF9yZXNNb2RlIHw9IG1vZGU7CgogICAgICAgIExvZyBsb2cgPSBnZXRS\nZXBvc2l0b3J5KCkuZ2V0TG9nKCk7CiAgICAgICAgaWYgKGxvZy5pc1RyYWNl\nRW5hYmxlZCgpKQogICAgICAgICAgICBsb2cudHJhY2UoX2xvYy5nZXQoInJl\nc29sdmUtZmllbGQiLCBfb3duZXIgKyAiQCIKICAgICAgICAgICAgICAgICsg\nU3lzdGVtLmlkZW50aXR5SGFzaENvZGUoX293bmVyKSArICIuIiArIF9uYW1l\nKSk7CgogICAgICAgIC8vIHdlIG9ubHkgcGVyZm9ybSBhY3Rpb25zIGZvciBt\nZXRhZGF0YSBtb2RlCiAgICAgICAgaWYgKChtb2RlICYgTU9ERV9NRVRBKSA9\nPSAwIHx8IChjdXIgJiBNT0RFX01FVEEpICE9IDApCiAgICAgICAgICAgIHJl\ndHVybiBmYWxzZTsKCiAgICAgICAgTWV0aG9kIGV4dGVybmFsaXplciA9IGdl\ndEV4dGVybmFsaXplck1ldGhvZCgpOwogICAgICAgIGlmIChleHRlcm5hbGl6\nZXIgIT0gbnVsbCkKICAgICAgICAgICAgc2V0VHlwZShleHRlcm5hbGl6ZXIu\nZ2V0UmV0dXJuVHlwZSgpKTsKCiAgICAgICAgLy8gb25seSBwYXNzIG9uIG1l\ndGFkYXRhIHJlc29sdmUgbW9kZSBzbyB0aGF0IG1ldGFkYXRhIGlzIGFsd2F5\ncwogICAgICAgIC8vIHJlc29sdmVkIGJlZm9yZSBhbnkgb3RoZXIgcmVzb2x2\nZSBtb2RlcyBvdXIgc3ViY2xhc3NlcyBwYXNzIGFsb25nCiAgICAgICAgX3Zh\nbC5yZXNvbHZlKE1PREVfTUVUQSk7CiAgICAgICAgX2tleS5yZXNvbHZlKE1P\nREVfTUVUQSk7CiAgICAgICAgX2VsZW0ucmVzb2x2ZShNT0RFX01FVEEpOwoK\nICAgICAgICBNZXRhRGF0YVJlcG9zaXRvcnkgcmVwb3MgPSBnZXRSZXBvc2l0\nb3J5KCk7CiAgICAgICAgaW50IHZhbGlkYXRlID0gcmVwb3MuZ2V0VmFsaWRh\ndGUoKTsKICAgICAgICBpZiAoKHZhbGlkYXRlICYgTWV0YURhdGFSZXBvc2l0\nb3J5LlZBTElEQVRFX01FVEEpICE9IDAKICAgICAgICAgICAgJiYgKCFJbXBs\nSGVscGVyLmlzTWFuYWdlZFR5cGUocmVwb3MuZ2V0Q29uZmlndXJhdGlvbigp\nLAogICAgICAgICAgICAgICAgX293bmVyLmdldERlc2NyaWJlZFR5cGUoKSkK\nICAgICAgICAgICAgfHwgKHZhbGlkYXRlICYgTWV0YURhdGFSZXBvc2l0b3J5\nLlZBTElEQVRFX1VORU5IQU5DRUQpID09IDApKSB7CiAgICAgICAgICAgIHZh\nbGlkYXRlTFJTKCk7CiAgICAgICAgICAgIGlmICgodmFsaWRhdGUgJiBNZXRh\nRGF0YVJlcG9zaXRvcnkuVkFMSURBVEVfUlVOVElNRSkgPT0gMCkKICAgICAg\nICAgICAgICAgIHZhbGlkYXRlU3VwcG9ydGVkVHlwZSgpOwogICAgICAgICAg\nICB2YWxpZGF0ZVZhbHVlKCk7CiAgICAgICAgICAgIHZhbGlkYXRlRXh0ZW5z\naW9uS2V5cygpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gZmFsc2U7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBWYWxpZGF0ZSB0aGF0IHRoaXMgZmllbGQg\nY2FuIGJlIHVzZWQgZm9yIExSUy4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lk\nIHZhbGlkYXRlTFJTKCkgewogICAgICAgIGlmICghaXNMUlMoKSkKICAgICAg\nICAgICAgcmV0dXJuOwoKICAgICAgICAvLyBjYW4ndCB1c2UgbHJzIGZvciBh\ncnJheXMKICAgICAgICBpZiAoZ2V0VHlwZUNvZGUoKSA9PSBKYXZhVHlwZXMu\nQVJSQVkpCiAgICAgICAgICAgIHRocm93IG5ldyBNZXRhRGF0YUV4Y2VwdGlv\nbihfbG9jLmdldCgiYmFkLWxycy1hcnJheSIsIHRoaXMpKTsKCiAgICAgICAg\nLy8gY2FuJ3QgdXNlIGxycyBmb3IgZXh0ZXJuYWxpemVkIHZhbHMKICAgICAg\nICBpZiAoZ2V0RXh0ZXJuYWxpemVyTWV0aG9kKCkgIT0gbnVsbCkKICAgICAg\nICAgICAgdGhyb3cgbmV3IE1ldGFEYXRhRXhjZXB0aW9uKF9sb2MuZ2V0KCJi\nYWQtbHJzLWV4dGVybiIsIHRoaXMpKTsKCiAgICAgICAgLy8gY2FuJ3QgdXNl\nIGxycyBmb3IgY29uY3JldGUgdHlwZXMKICAgICAgICBpZiAoZ2V0VHlwZSgp\nICE9IENvbGxlY3Rpb24uY2xhc3MgJiYgZ2V0VHlwZSgpICE9IE1hcC5jbGFz\ncwogICAgICAgICAgICAmJiBnZXRUeXBlKCkgIT0gU2V0LmNsYXNzKQogICAg\nICAgICAgICB0aHJvdyBuZXcgTWV0YURhdGFFeGNlcHRpb24oX2xvYy5nZXQo\nImJhZC1scnMtY29uY3JldGUiLCB0aGlzKSk7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBWYWxpZGF0ZSB0aGF0IHRoaXMgZmllbGQgaXMgc3VwcG9ydGVkIGJ5\nIHRoZSBydW50aW1lLgogICAgICovCiAgICBwcml2YXRlIHZvaWQgdmFsaWRh\ndGVTdXBwb3J0ZWRUeXBlKCkgewogICAgICAgIC8vIGxvZyB3YXJuaW5ncyBh\nYm91dCB0aGluZ3Mgd2UgZG9uJ3QgaGFuZGxlCiAgICAgICAgT3BlbkpQQUNv\nbmZpZ3VyYXRpb24gY29uZiA9IGdldFJlcG9zaXRvcnkoKS5nZXRDb25maWd1\ncmF0aW9uKCk7CiAgICAgICAgQ29sbGVjdGlvbjxTdHJpbmc+IG9wdHMgPSBj\nb25mLnN1cHBvcnRlZE9wdGlvbnMoKTsKICAgICAgICBMb2cgbG9nID0gY29u\nZi5nZXRMb2coT3BlbkpQQUNvbmZpZ3VyYXRpb24uTE9HX01FVEFEQVRBKTsK\nICAgICAgICBzd2l0Y2ggKGdldFR5cGVDb2RlKCkpIHsKICAgICAgICAgICAg\nY2FzZSBKYXZhVHlwZXMuUEM6CiAgICAgICAgICAgICAgICBpZiAoaXNFbWJl\nZGRlZCgpICYmICFvcHRzLmNvbnRhaW5zKAogICAgICAgICAgICAgICAgCU9w\nZW5KUEFDb25maWd1cmF0aW9uLk9QVElPTl9FTUJFRERFRF9SRUxBVElPTikp\nIHsKICAgICAgICAgICAgICAgICAgICBzZXRFbWJlZGRlZChmYWxzZSk7CiAg\nICAgICAgICAgICAgICAgICAgaWYgKGxvZy5pc1dhcm5FbmFibGVkKCkpCiAg\nICAgICAgICAgICAgICAgICAgICAgIGxvZy53YXJuKF9sb2MuZ2V0KCJjYW50\nLWVtYmVkIiwgdGhpcykpOwogICAgICAgICAgICAgICAgfSBlbHNlCiAgICAg\nICAgICAgICAgICBpZiAoaXNFbWJlZGRlZCgpICYmIGdldERlY2xhcmVkVHlw\nZUNvZGUoKSAhPSBKYXZhVHlwZXMuUEMpIHsKICAgICAgICAgICAgICAgICAg\nICBzZXRFbWJlZGRlZChmYWxzZSk7CiAgICAgICAgICAgICAgICAgICAgaWYg\nKGxvZy5pc1dhcm5FbmFibGVkKCkpCiAgICAgICAgICAgICAgICAgICAgICAg\nIGxvZy53YXJuKF9sb2MuZ2V0KCJjYW50LWVtYmVkLWV4dGVybiIsIHRoaXMp\nKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGJyZWFrOwog\nICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5DT0xMRUNUSU9OOgogICAgICAg\nICAgICAgICAgaWYgKCFvcHRzLmNvbnRhaW5zKE9wZW5KUEFDb25maWd1cmF0\naW9uLk9QVElPTl9UWVBFX0NPTExFQ1RJT04pKQogICAgICAgICAgICAgICAg\nICAgIHRocm93IG5ldyBVbnN1cHBvcnRlZEV4Y2VwdGlvbigKICAgICAgICAg\nICAgICAgICAgICAgICAgX2xvYy5nZXQoInR5cGUtbm90LXN1cHBvcnRlZCIs\nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiQ29sbGVjdGlvbiIsIHRo\naXMpKTsKICAgICAgICAgICAgICAgIGlmIChfZWxlbS5pc0VtYmVkZGVkUEMo\nKSAmJiAhb3B0cy5jb250YWlucygKICAgICAgICAgICAgICAgICAgICBPcGVu\nSlBBQ29uZmlndXJhdGlvbi5PUFRJT05fRU1CRURERURfQ09MTEVDVElPTl9S\nRUxBVElPTikpewogICAgICAgICAgICAgICAgICAgIF9lbGVtLnNldEVtYmVk\nZGVkKGZhbHNlKTsKICAgICAgICAgICAgICAgICAgICBpZiAobG9nLmlzV2Fy\nbkVuYWJsZWQoKSkKICAgICAgICAgICAgICAgICAgICAgICAgbG9nLndhcm4o\nX2xvYy5nZXQoImNhbnQtZW1iZWQtZWxlbWVudCIsIHRoaXMpKTsKICAgICAg\nICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAg\nICBjYXNlIEphdmFUeXBlcy5BUlJBWToKICAgICAgICAgICAgICAgIGlmICgh\nb3B0cy5jb250YWlucyhPcGVuSlBBQ29uZmlndXJhdGlvbi5PUFRJT05fVFlQ\nRV9BUlJBWSkpCiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IFVuc3Vw\ncG9ydGVkRXhjZXB0aW9uKAogICAgICAgICAgICAgICAgICAgICAgICBfbG9j\nLmdldCgidHlwZS1ub3Qtc3VwcG9ydGVkIiwKICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICJBcnJheSIsIHRoaXMpKTsKICAgICAgICAgICAgICAgIGlm\nIChfZWxlbS5pc0VtYmVkZGVkUEMoKSAmJiAhb3B0cy5jb250YWlucygKICAg\nICAgICAgICAgICAgICAgICBPcGVuSlBBQ29uZmlndXJhdGlvbi5PUFRJT05f\nRU1CRURERURfQ09MTEVDVElPTl9SRUxBVElPTikpIHsKICAgICAgICAgICAg\nICAgICAgICBfZWxlbS5zZXRFbWJlZGRlZChmYWxzZSk7CiAgICAgICAgICAg\nICAgICAgICAgaWYgKGxvZy5pc1dhcm5FbmFibGVkKCkpCiAgICAgICAgICAg\nICAgICAgICAgICAgIGxvZy53YXJuKF9sb2MuZ2V0KCJjYW50LWVtYmVkLWVs\nZW1lbnQiLCB0aGlzKSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAg\nICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuTUFQOgog\nICAgICAgICAgICAgICAgaWYgKCFvcHRzLmNvbnRhaW5zKE9wZW5KUEFDb25m\naWd1cmF0aW9uLk9QVElPTl9UWVBFX01BUCkpCiAgICAgICAgICAgICAgICAg\nICAgdGhyb3cgbmV3IFVuc3VwcG9ydGVkRXhjZXB0aW9uKAogICAgICAgICAg\nICAgICAgICAgICAgICBfbG9jLmdldCgidHlwZS1ub3Qtc3VwcG9ydGVkIiwK\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICJNYXAiLCB0aGlzKSk7CiAg\nICAgICAgICAgICAgICBpZiAoX2VsZW0uaXNFbWJlZGRlZFBDKCkgJiYgIW9w\ndHMuY29udGFpbnMoCiAgICAgICAgICAgICAgICAJT3BlbkpQQUNvbmZpZ3Vy\nYXRpb24uT1BUSU9OX0VNQkVEREVEX01BUF9SRUxBVElPTikpIHsKICAgICAg\nICAgICAgICAgICAgICBfZWxlbS5zZXRFbWJlZGRlZChmYWxzZSk7CiAgICAg\nICAgICAgICAgICAgICAgaWYgKGxvZy5pc1dhcm5FbmFibGVkKCkpCiAgICAg\nICAgICAgICAgICAgICAgICAgIGxvZy53YXJuKF9sb2MuZ2V0KCJjYW50LWVt\nYmVkLWVsZW1lbnQiLCB0aGlzKSk7CiAgICAgICAgICAgICAgICB9CiAgICAg\nICAgICAgICAgICBpZiAoX2tleS5pc0VtYmVkZGVkUEMoKSAmJiAhb3B0cy5j\nb250YWlucygKICAgICAgICAgICAgICAgIAlPcGVuSlBBQ29uZmlndXJhdGlv\nbi5PUFRJT05fRU1CRURERURfTUFQX1JFTEFUSU9OKSkgewogICAgICAgICAg\nICAgICAgICAgIF9rZXkuc2V0RW1iZWRkZWQoZmFsc2UpOwogICAgICAgICAg\nICAgICAgICAgIGlmIChsb2cuaXNXYXJuRW5hYmxlZCgpKQogICAgICAgICAg\nICAgICAgICAgICAgICBsb2cud2FybihfbG9jLmdldCgiY2FudC1lbWJlZC1r\nZXkiLCB0aGlzKSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAg\nICBicmVhazsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBWYWxp\nZGF0ZSBvdXIgdmFsdWUgc3RyYXRlZ3kuCiAgICAgKi8KICAgIHByaXZhdGUg\ndm9pZCB2YWxpZGF0ZVZhbHVlKCkgewogICAgICAgIGlmIChnZXRFeHRlcm5h\nbGl6ZXJNZXRob2QoKSAhPSBudWxsICYmIGdldEV4dGVybmFsVmFsdWVNYXAo\nKSAhPSBudWxsKQogICAgICAgICAgICB0aHJvdyBuZXcgTWV0YURhdGFFeGNl\ncHRpb24oX2xvYy5nZXQoImV4dGVybi1leHRlcm52YWx1ZXMiLCB0aGlzKSk7\nCiAgICAgICAgaWYgKGdldFZhbHVlU3RyYXRlZ3koKSA9PSBWYWx1ZVN0cmF0\nZWdpZXMuU0VRVUVOQ0UKICAgICAgICAgICAgJiYgZ2V0VmFsdWVTZXF1ZW5j\nZU5hbWUoKSA9PSBudWxsKQogICAgICAgICAgICB0aHJvdyBuZXcgTWV0YURh\ndGFFeGNlcHRpb24oX2xvYy5nZXQoIm5vLXNlcS1uYW1lIiwgdGhpcykpOwog\nICAgICAgIFZhbHVlU3RyYXRlZ2llcy5hc3NlcnRTdXBwb3J0ZWQoZ2V0VmFs\ndWVTdHJhdGVneSgpLCB0aGlzLAogICAgICAgICAgICAidmFsdWUgc3RyYXRl\nZ3kiKTsKICAgIH0KCiAgICAvKioKICAgICAqIENvcHkgc3RhdGUgZnJvbSB0\naGUgZ2l2ZW4gZmllbGQgdG8gdGhpcyBvbmUuIERvIG5vdCBjb3B5IG1hcHBp\nbmcKICAgICAqIGluZm9ybWF0aW9uLgogICAgICovCiAgICBwdWJsaWMgdm9p\nZCBjb3B5KEZpZWxkTWV0YURhdGEgZmllbGQpIHsKICAgICAgICBzdXBlci5j\nb3B5KGZpZWxkKTsKCiAgICAgICAgX2ludGVybWVkaWF0ZSA9IGZpZWxkLnVz\nZXNJbnRlcm1lZGlhdGUoKTsKICAgICAgICBfaW1wbERhdGEgPSBmaWVsZC51\nc2VzSW1wbERhdGEoKTsKCiAgICAgICAgLy8gY29weSBmaWVsZC1sZXZlbCBp\nbmZvOyB1c2UgZ2V0IG1ldGhvZHMgdG8gZm9yY2UgcmVzb2x1dGlvbiBvZgog\nICAgICAgIC8vIGxhenkgZGF0YQogICAgICAgIF9wcm94eUNsYXNzID0gZmll\nbGQuZ2V0UHJveHlUeXBlKCk7CiAgICAgICAgX2luaXRpYWxpemVyID0gZmll\nbGQuZ2V0SW5pdGlhbGl6ZXIoKTsKICAgICAgICBfdHJhbnNpZW50ID0gZmll\nbGQuaXNUcmFuc2llbnQoKTsKICAgICAgICBfbnVsbFZhbHVlID0gZmllbGQu\nZ2V0TnVsbFZhbHVlKCk7CiAgICAgICAgX21hbmFnZSA9IGZpZWxkLmdldE1h\nbmFnZW1lbnQoKTsKICAgICAgICBfZXhwbGljaXQgPSBmaWVsZC5pc0V4cGxp\nY2l0KCk7CiAgICAgICAgX2V4dE5hbWUgPSBmaWVsZC5nZXRFeHRlcm5hbGl6\nZXIoKTsKICAgICAgICBfZXh0TWV0aG9kID0gREVGQVVMVF9NRVRIT0Q7CiAg\nICAgICAgX2ZhY3ROYW1lID0gZmllbGQuZ2V0RmFjdG9yeSgpOwogICAgICAg\nIF9mYWN0TWV0aG9kID0gREVGQVVMVF9NRVRIT0Q7CiAgICAgICAgX2V4dFN0\ncmluZyA9IGZpZWxkLmdldEV4dGVybmFsVmFsdWVzKCk7CiAgICAgICAgX2V4\ndFZhbHVlcyA9IENvbGxlY3Rpb25zLkVNUFRZX01BUDsKICAgICAgICBfZmll\nbGRWYWx1ZXMgPSBDb2xsZWN0aW9ucy5FTVBUWV9NQVA7CiAgICAgICAgX3By\naW1LZXkgPSBmaWVsZC5pc1ByaW1hcnlLZXkoKTsKICAgICAgICBfYmFja2lu\nZ01lbWJlciA9IGZpZWxkLl9iYWNraW5nTWVtYmVyOwogICAgICAgIF9lbnVt\nRmllbGQgPSBmaWVsZC5fZW51bUZpZWxkOwogICAgICAgIF9sb2JGaWVsZCA9\nIGZpZWxkLl9sb2JGaWVsZDsKICAgICAgICBfc2VyaWFsaXphYmxlRmllbGQg\nPSBmaWVsZC5fc2VyaWFsaXphYmxlRmllbGQ7CiAgICAgICAgX2dlbmVyYXRl\nZCA9IGZpZWxkLl9nZW5lcmF0ZWQ7CiAgICAgICAgX21hcHBlZEJ5SWRWYWx1\nZSA9IGZpZWxkLl9tYXBwZWRCeUlkVmFsdWU7CiAgICAgICAgX2lzRWxlbWVu\ndENvbGxlY3Rpb24gPSBmaWVsZC5faXNFbGVtZW50Q29sbGVjdGlvbjsKICAg\nICAgICBfYWNjZXNzID0gZmllbGQuX2FjY2VzczsKICAgICAgICBfb3JkZXJE\nZWMgPSBmaWVsZC5fb3JkZXJEZWM7CgogICAgICAgIC8vIGVtYmVkZGVkIGZp\nZWxkcyBjYW4ndCBiZSB2ZXJzaW9ucwogICAgICAgIGlmIChfb3duZXIuZ2V0\nRW1iZWRkaW5nTWV0YURhdGEoKSA9PSBudWxsICYmIF92ZXJzaW9uID09IG51\nbGwpCiAgICAgICAgICAgIF92ZXJzaW9uID0gKGZpZWxkLmlzVmVyc2lvbigp\nKSA/IEJvb2xlYW4uVFJVRSA6IEJvb2xlYW4uRkFMU0U7CgogICAgICAgIC8v\nIG9ubHkgY29weSB0aGlzIGRhdGEgaWYgbm90IGFscmVhZHkgc2V0IGV4cGxp\nY2l0bHkgaW4gdGhpcyBpbnN0YW5jZQogICAgICAgIGlmIChfZGZnID09IDAp\nIHsKICAgICAgICAgICAgX2RmZyA9IChmaWVsZC5pc0luRGVmYXVsdEZldGNo\nR3JvdXAoKSkgPyBERkdfVFJVRSA6IERGR19GQUxTRTsKICAgICAgICAgICAg\naWYgKGZpZWxkLmlzRGVmYXVsdEZldGNoR3JvdXBFeHBsaWNpdCgpKQogICAg\nICAgICAgICAgICAgX2RmZyB8PSBERkdfRVhQTElDSVQ7CiAgICAgICAgfQog\nICAgICAgIGlmIChfZmdTZXQgPT0gbnVsbCAmJiBmaWVsZC5fZmdTZXQgIT0g\nbnVsbCkKICAgICAgICAgICAgX2ZnU2V0ID0gbmV3IEhhc2hTZXQoZmllbGQu\nX2ZnU2V0KTsKICAgICAgICBpZiAoX2xmZyA9PSBudWxsKQogICAgICAgICAg\nICBfbGZnID0gZmllbGQuZ2V0TG9hZEZldGNoR3JvdXAoKTsKICAgICAgICBp\nZiAoX2xycyA9PSBudWxsKQogICAgICAgICAgICBfbHJzID0gKGZpZWxkLmlz\nTFJTKCkpID8gQm9vbGVhbi5UUlVFIDogQm9vbGVhbi5GQUxTRTsKICAgICAg\nICBpZiAoX3ZhbFN0cmF0ZWd5ID09IC0xKQogICAgICAgICAgICBfdmFsU3Ry\nYXRlZ3kgPSBmaWVsZC5nZXRWYWx1ZVN0cmF0ZWd5KCk7CiAgICAgICAgaWYg\nKF91cFN0cmF0ZWd5ID09IC0xKQogICAgICAgICAgICBfdXBTdHJhdGVneSA9\nIGZpZWxkLmdldFVwZGF0ZVN0cmF0ZWd5KCk7CiAgICAgICAgaWYgKENsYXNz\nTWV0YURhdGEuREVGQVVMVF9TVFJJTkcuZXF1YWxzKF9zZXFOYW1lKSkgewog\nICAgICAgICAgICBfc2VxTmFtZSA9IGZpZWxkLmdldFZhbHVlU2VxdWVuY2VO\nYW1lKCk7CiAgICAgICAgICAgIF9zZXFNZXRhID0gbnVsbDsKICAgICAgICB9\nCiAgICAgICAgaWYgKENsYXNzTWV0YURhdGEuREVGQVVMVF9TVFJJTkcuZXF1\nYWxzKF9pbnZlcnNlKSkKICAgICAgICAgICAgX2ludmVyc2UgPSBmaWVsZC5n\nZXRJbnZlcnNlKCk7CgogICAgICAgIC8vIGNvcHkgdmFsdWUgbWV0YWRhdGEK\nICAgICAgICBfdmFsLmNvcHkoZmllbGQpOwogICAgICAgIF9rZXkuY29weShm\naWVsZC5nZXRLZXkoKSk7CiAgICAgICAgX2VsZW0uY29weShmaWVsZC5nZXRF\nbGVtZW50KCkpOwogICAgfQoKICAgIHByb3RlY3RlZCB2b2lkIGFkZEV4dGVu\nc2lvbktleXMoQ29sbGVjdGlvbiBleHRzKSB7CiAgICAgICAgZ2V0UmVwb3Np\ndG9yeSgpLmdldE1ldGFEYXRhRmFjdG9yeSgpLmFkZEZpZWxkRXh0ZW5zaW9u\nS2V5cyhleHRzKTsKICAgIH0KCiAgICAvLy8vLy8vLy8vLy8vLy8KICAgIC8v\nIENvbW1lbnRhYmxlCiAgICAvLy8vLy8vLy8vLy8vLy8KCiAgICBwdWJsaWMg\nU3RyaW5nW10gZ2V0Q29tbWVudHMoKSB7CiAgICAgICAgcmV0dXJuIChfY29t\nbWVudHMgPT0gbnVsbCkgPyBFTVBUWV9DT01NRU5UUyA6IF9jb21tZW50czsK\nICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRDb21tZW50cyhTdHJpbmdbXSBj\nb21tZW50cykgewogICAgICAgIF9jb21tZW50cyA9IGNvbW1lbnRzOwogICAg\nfQoKICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgICAv\nLyBWYWx1ZU1ldGFEYXRhIGltcGxlbWVudGF0aW9uCiAgICAvLy8vLy8vLy8v\nLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwoKICAgIHB1YmxpYyBGaWVsZE1ldGFE\nYXRhIGdldEZpZWxkTWV0YURhdGEoKSB7CiAgICAgICAgcmV0dXJuIHRoaXM7\nCiAgICB9CgogICAgcHVibGljIENsYXNzIGdldFR5cGUoKSB7CiAgICAgICAg\ncmV0dXJuIF92YWwuZ2V0VHlwZSgpOwogICAgfQoKICAgIHB1YmxpYyB2b2lk\nIHNldFR5cGUoQ2xhc3MgdHlwZSkgewogICAgICAgIF92YWwuc2V0VHlwZSh0\neXBlKTsKICAgICAgICBpZiAodHlwZS5pc0FycmF5KCkpCiAgICAgICAgICAg\nIF9lbGVtLnNldFR5cGUodHlwZS5nZXRDb21wb25lbnRUeXBlKCkpOwogICAg\nICAgIGVsc2UgaWYgKHR5cGUgPT0gUHJvcGVydGllcy5jbGFzcykgewogICAg\nICAgICAgICBfa2V5LnNldFR5cGUoU3RyaW5nLmNsYXNzKTsKICAgICAgICAg\nICAgX2VsZW0uc2V0VHlwZShTdHJpbmcuY2xhc3MpOwogICAgICAgIH0KICAg\nIH0KCiAgICBwdWJsaWMgaW50IGdldFR5cGVDb2RlKCkgewogICAgICAgIHJl\ndHVybiBfdmFsLmdldFR5cGVDb2RlKCk7CiAgICB9CgogICAgcHVibGljIHZv\naWQgc2V0VHlwZUNvZGUoaW50IGNvZGUpIHsKICAgICAgICBfdmFsLnNldFR5\ncGVDb2RlKGNvZGUpOwogICAgfQoKICAgIHB1YmxpYyBib29sZWFuIGlzVHlw\nZVBDKCkgewogICAgICAgIHJldHVybiBfdmFsLmlzVHlwZVBDKCk7CiAgICB9\nCgogICAgcHVibGljIENsYXNzTWV0YURhdGEgZ2V0VHlwZU1ldGFEYXRhKCkg\newogICAgICAgIHJldHVybiBfdmFsLmdldFR5cGVNZXRhRGF0YSgpOwogICAg\nfQoKICAgIHB1YmxpYyBDbGFzcyBnZXREZWNsYXJlZFR5cGUoKSB7CiAgICAg\nICAgcmV0dXJuIF92YWwuZ2V0RGVjbGFyZWRUeXBlKCk7CiAgICB9CgogICAg\ncHVibGljIHZvaWQgc2V0RGVjbGFyZWRUeXBlKENsYXNzIHR5cGUpIHsKICAg\nICAgICBfdmFsLnNldERlY2xhcmVkVHlwZSh0eXBlKTsKICAgICAgICBpZiAo\ndHlwZS5pc0FycmF5KCkpCiAgICAgICAgICAgIF9lbGVtLnNldERlY2xhcmVk\nVHlwZSh0eXBlLmdldENvbXBvbmVudFR5cGUoKSk7CiAgICAgICAgZWxzZSBp\nZiAodHlwZSA9PSBQcm9wZXJ0aWVzLmNsYXNzKSB7CiAgICAgICAgICAgIF9r\nZXkuc2V0RGVjbGFyZWRUeXBlKFN0cmluZy5jbGFzcyk7CiAgICAgICAgICAg\nIF9lbGVtLnNldERlY2xhcmVkVHlwZShTdHJpbmcuY2xhc3MpOwogICAgICAg\nIH0KICAgIH0KCiAgICBwdWJsaWMgaW50IGdldERlY2xhcmVkVHlwZUNvZGUo\nKSB7CiAgICAgICAgcmV0dXJuIF92YWwuZ2V0RGVjbGFyZWRUeXBlQ29kZSgp\nOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldERlY2xhcmVkVHlwZUNvZGUo\naW50IHR5cGUpIHsKICAgICAgICBfdmFsLnNldERlY2xhcmVkVHlwZUNvZGUo\ndHlwZSk7CiAgICB9CgogICAgcHVibGljIGJvb2xlYW4gaXNEZWNsYXJlZFR5\ncGVQQygpIHsKICAgICAgICByZXR1cm4gX3ZhbC5pc0RlY2xhcmVkVHlwZVBD\nKCk7CiAgICB9CgogICAgcHVibGljIENsYXNzTWV0YURhdGEgZ2V0RGVjbGFy\nZWRUeXBlTWV0YURhdGEoKSB7CiAgICAgICAgcmV0dXJuIF92YWwuZ2V0RGVj\nbGFyZWRUeXBlTWV0YURhdGEoKTsKICAgIH0KCiAgICBwdWJsaWMgYm9vbGVh\nbiBpc0VtYmVkZGVkKCkgewogICAgICAgIHJldHVybiBfdmFsLmlzRW1iZWRk\nZWQoKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRFbWJlZGRlZChib29s\nZWFuIGVtYmVkZGVkKSB7CiAgICAgICAgX3ZhbC5zZXRFbWJlZGRlZChlbWJl\nZGRlZCk7CiAgICB9CgogICAgcHVibGljIGJvb2xlYW4gaXNFbWJlZGRlZFBD\nKCkgewogICAgICAgIHJldHVybiBfdmFsLmlzRW1iZWRkZWRQQygpOwogICAg\nfQoKICAgIHB1YmxpYyBDbGFzc01ldGFEYXRhIGdldEVtYmVkZGVkTWV0YURh\ndGEoKSB7CiAgICAgICAgcmV0dXJuIF92YWwuZ2V0RW1iZWRkZWRNZXRhRGF0\nYSgpOwogICAgfQoKICAgIHB1YmxpYyBDbGFzc01ldGFEYXRhIGFkZEVtYmVk\nZGVkTWV0YURhdGEoaW50IGFjY2VzcykgewogICAgICAgIHJldHVybiBfdmFs\nLmFkZEVtYmVkZGVkTWV0YURhdGEoYWNjZXNzKTsKICAgIH0KICAgIHB1Ymxp\nYyBDbGFzc01ldGFEYXRhIGFkZEVtYmVkZGVkTWV0YURhdGEoKSB7CiAgICAg\nICAgcmV0dXJuIF92YWwuYWRkRW1iZWRkZWRNZXRhRGF0YSgpOwogICAgfQoK\nICAgIHB1YmxpYyBpbnQgZ2V0Q2FzY2FkZURlbGV0ZSgpIHsKICAgICAgICBy\nZXR1cm4gX3ZhbC5nZXRDYXNjYWRlRGVsZXRlKCk7CiAgICB9CgogICAgcHVi\nbGljIHZvaWQgc2V0Q2FzY2FkZURlbGV0ZShpbnQgZGVsZXRlKSB7CiAgICAg\nICAgX3ZhbC5zZXRDYXNjYWRlRGVsZXRlKGRlbGV0ZSk7CiAgICB9CgogICAg\ncHVibGljIGludCBnZXRDYXNjYWRlUGVyc2lzdCgpIHsKICAgICAgICByZXR1\ncm4gX3ZhbC5nZXRDYXNjYWRlUGVyc2lzdCgpOwogICAgfQoKICAgIHB1Ymxp\nYyB2b2lkIHNldENhc2NhZGVQZXJzaXN0KGludCBwZXJzaXN0KSB7CiAgICAg\nICAgX3ZhbC5zZXRDYXNjYWRlUGVyc2lzdChwZXJzaXN0KTsKICAgIH0KCiAg\nICBwdWJsaWMgaW50IGdldENhc2NhZGVBdHRhY2goKSB7CiAgICAgICAgcmV0\ndXJuIF92YWwuZ2V0Q2FzY2FkZUF0dGFjaCgpOwogICAgfQoKICAgIHB1Ymxp\nYyB2b2lkIHNldENhc2NhZGVBdHRhY2goaW50IGF0dGFjaCkgewogICAgICAg\nIF92YWwuc2V0Q2FzY2FkZUF0dGFjaChhdHRhY2gpOwogICAgfQogICAgCiAg\nICBwdWJsaWMgaW50IGdldENhc2NhZGVEZXRhY2goKSB7CiAgICAgICAgcmV0\ndXJuIF92YWwuZ2V0Q2FzY2FkZURldGFjaCgpOwogICAgfQoKICAgIHB1Ymxp\nYyB2b2lkIHNldENhc2NhZGVEZXRhY2goaW50IGRldGFjaCkgewogICAgICAg\nIF92YWwuc2V0Q2FzY2FkZURldGFjaChkZXRhY2gpOwogICAgfQoKICAgIHB1\nYmxpYyBpbnQgZ2V0Q2FzY2FkZVJlZnJlc2goKSB7CiAgICAgICAgcmV0dXJu\nIF92YWwuZ2V0Q2FzY2FkZVJlZnJlc2goKTsKICAgIH0KCiAgICBwdWJsaWMg\ndm9pZCBzZXRDYXNjYWRlUmVmcmVzaChpbnQgcmVmcmVzaCkgewogICAgICAg\nIF92YWwuc2V0Q2FzY2FkZVJlZnJlc2gocmVmcmVzaCk7CiAgICB9CgogICAg\ncHVibGljIGJvb2xlYW4gaXNTZXJpYWxpemVkKCkgewogICAgICAgIHJldHVy\nbiBfdmFsLmlzU2VyaWFsaXplZCgpOwogICAgfQoKICAgIHB1YmxpYyB2b2lk\nIHNldFNlcmlhbGl6ZWQoYm9vbGVhbiBzZXJpYWxpemVkKSB7CiAgICAgICAg\nX3ZhbC5zZXRTZXJpYWxpemVkKHNlcmlhbGl6ZWQpOwogICAgfQoKICAgIHB1\nYmxpYyBTdHJpbmcgZ2V0VmFsdWVNYXBwZWRCeSgpIHsKICAgICAgICByZXR1\ncm4gX3ZhbC5nZXRWYWx1ZU1hcHBlZEJ5KCk7CiAgICB9CgogICAgcHVibGlj\nIHZvaWQgc2V0VmFsdWVNYXBwZWRCeShTdHJpbmcgbWFwcGVkKSB7CiAgICAg\nICAgX3ZhbC5zZXRWYWx1ZU1hcHBlZEJ5KG1hcHBlZCk7CiAgICB9CgogICAg\ncHVibGljIEZpZWxkTWV0YURhdGEgZ2V0VmFsdWVNYXBwZWRCeU1ldGFEYXRh\nICgpIHsKCQlyZXR1cm4gX3ZhbC5nZXRWYWx1ZU1hcHBlZEJ5TWV0YURhdGEg\nKCk7Cgl9CgoJcHVibGljIENsYXNzPD8+IGdldFR5cGVPdmVycmlkZSAoKSB7\nCgkJcmV0dXJuIF92YWwuZ2V0VHlwZU92ZXJyaWRlICgpOwoJfQoKCXB1Ymxp\nYyB2b2lkIHNldFR5cGVPdmVycmlkZShDbGFzcyB0eXBlKSB7CgkJX3ZhbC5z\nZXRUeXBlT3ZlcnJpZGUgKHR5cGUpOwoJfQoKCXB1YmxpYyB2b2lkIGNvcHkg\nKFZhbHVlTWV0YURhdGEgdm1kKSB7CgkJX3ZhbC5jb3B5ICh2bWQpOwoJfQoK\nICAgIC8qKgogICAgICogQ2hlY2sgaWYgdGhpcyBmaWVsZCBpcyB1c2VkIGJ5\nIG90aGVyIGZpZWxkIGFzICJvcmRlciBieSIgdmFsdWUuCiAgICAgKgogICAg\nICogQHNpbmNlIDEuMS4wCiAgICAgKi8KICAgIHB1YmxpYyBib29sZWFuIGlz\nVXNlZEluT3JkZXJCeSgpIHsKICAgIAlyZXR1cm4gX3VzZWRJbk9yZGVyQnk7\nCiAgICB9CiAgICAKICAgIC8qKgogICAgICogV2hldGhlciB0aGlzIGZpZWxk\nIGlzIHVzZWQgYnkgb3RoZXIgZmllbGQgYXMgIm9yZGVyIGJ5IiB2YWx1ZSAu\nCiAgICAgKgogICAgICogQHNpbmNlIDEuMS4wCiAgICAgKi8KICAgIHB1Ymxp\nYyB2b2lkIHNldFVzZWRJbk9yZGVyQnkoYm9vbGVhbiBpc1VzZWQpIHsKICAg\nIAlfdXNlZEluT3JkZXJCeSA9IGlzVXNlZDsKICAgIH0KICAgIAogICAgLyoq\nCiAgICAgKiBTZXJpYWxpemFibGUgd3JhcHBlciBhcm91bmQgYSB7QGxpbmsg\nTWV0aG9kfSBvciB7QGxpbmsgRmllbGR9LiBGb3IgCiAgICAgKiBzcGFjZSBj\nb25zaWRlcmF0aW9ucywgdGhpcyBkb2VzIG5vdCBzdXBwb3J0IHtAbGluayBD\nb25zdHJ1Y3Rvcn1zLgogICAgICovCglwdWJsaWMgc3RhdGljIGNsYXNzIE1l\nbWJlclByb3ZpZGVyCiAgICAgICAgaW1wbGVtZW50cyBFeHRlcm5hbGl6YWJs\nZSB7CgogICAgICAgIHByaXZhdGUgdHJhbnNpZW50IE1lbWJlciBfbWVtYmVy\nOwoKICAgICAgICBwdWJsaWMgTWVtYmVyUHJvdmlkZXIoKSB7CiAgICAgICAg\nICAgIC8vIGZvciBleHRlcm5hbGl6YXRpb24KICAgICAgICB9CgogICAgICAg\nIE1lbWJlclByb3ZpZGVyKE1lbWJlciBtZW1iZXIpIHsKICAgICAgICAgICAg\naWYgKG1lbWJlciBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKQogICAgICAgICAg\nICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbigpOwoK\nICAgICAgICAgICAgX21lbWJlciA9IG1lbWJlcjsKICAgICAgICB9CgogICAg\nICAgIHB1YmxpYyBNZW1iZXIgZ2V0TWVtYmVyKCkgewogICAgICAgICAgICBy\nZXR1cm4gX21lbWJlcjsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyB2b2lk\nIHJlYWRFeHRlcm5hbChPYmplY3RJbnB1dCBpbikKICAgICAgICAgICAgdGhy\nb3dzIElPRXhjZXB0aW9uLCBDbGFzc05vdEZvdW5kRXhjZXB0aW9uIHsKICAg\nICAgICAgICAgYm9vbGVhbiBpc0ZpZWxkID0gaW4ucmVhZEJvb2xlYW4oKTsK\nICAgICAgICAgICAgQ2xhc3M8Pz4gY2xzID0gKENsYXNzPD8+KSBpbi5yZWFk\nT2JqZWN0KCk7CiAgICAgICAgICAgIFN0cmluZyBtZW1iZXJOYW1lID0gKFN0\ncmluZykgaW4ucmVhZE9iamVjdCgpOwogICAgICAgICAgICB0cnkgewogICAg\nICAgICAgICAgICAgaWYgKGlzRmllbGQpCiAgICAgICAgICAgICAgICAgICAg\nX21lbWJlciA9IEFjY2Vzc0NvbnRyb2xsZXIuZG9Qcml2aWxlZ2VkKAogICAg\nICAgICAgICAgICAgICAgICAgICBKMkRvUHJpdkhlbHBlci5nZXREZWNsYXJl\nZEZpZWxkQWN0aW9uKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xz\nLCBtZW1iZXJOYW1lKSk7IAogICAgICAgICAgICAgICAgZWxzZSB7CiAgICAg\nICAgICAgICAgICAgICAgQ2xhc3M8Pz5bXSBwYXJhbWV0ZXJUeXBlcyA9IChD\nbGFzc1tdKSBpbi5yZWFkT2JqZWN0KCk7CiAgICAgICAgICAgICAgICAgICAg\nX21lbWJlciA9IEFjY2Vzc0NvbnRyb2xsZXIuZG9Qcml2aWxlZ2VkKAogICAg\nICAgICAgICAgICAgICAgICAgICBKMkRvUHJpdkhlbHBlci5nZXREZWNsYXJl\nZE1ldGhvZEFjdGlvbigKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNs\ncywgbWVtYmVyTmFtZSwgcGFyYW1ldGVyVHlwZXMpKTsKICAgICAgICAgICAg\nICAgIH0KICAgICAgICAgICAgfSBjYXRjaCAoU2VjdXJpdHlFeGNlcHRpb24g\nZSkgewogICAgICAgICAgICAgICAgSU9FeGNlcHRpb24gaW9lID0gbmV3IElP\nRXhjZXB0aW9uKGUuZ2V0TWVzc2FnZSgpKTsKICAgICAgICAgICAgICAgIGlv\nZS5pbml0Q2F1c2UoZSk7CiAgICAgICAgICAgICAgICB0aHJvdyBpb2U7CiAg\nICAgICAgICAgIH0gY2F0Y2ggKFByaXZpbGVnZWRBY3Rpb25FeGNlcHRpb24g\ncGFlKSB7CiAgICAgICAgICAgICAgICBJT0V4Y2VwdGlvbiBpb2UgPSBuZXcg\nSU9FeGNlcHRpb24oCiAgICAgICAgICAgICAgICAgICAgcGFlLmdldEV4Y2Vw\ndGlvbigpLmdldE1lc3NhZ2UoKSk7CiAgICAgICAgICAgICAgICBpb2UuaW5p\ndENhdXNlKHBhZSk7CiAgICAgICAgICAgICAgICB0aHJvdyBpb2U7CiAgICAg\nICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHB1YmxpYyB2b2lkIHdyaXRl\nRXh0ZXJuYWwoT2JqZWN0T3V0cHV0IG91dCkKICAgICAgICAgICAgdGhyb3dz\nIElPRXhjZXB0aW9uIHsKICAgICAgICAgICAgYm9vbGVhbiBpc0ZpZWxkID0g\nX21lbWJlciBpbnN0YW5jZW9mIEZpZWxkOwogICAgICAgICAgICBvdXQud3Jp\ndGVCb29sZWFuKGlzRmllbGQpOwogICAgICAgICAgICBvdXQud3JpdGVPYmpl\nY3QoX21lbWJlci5nZXREZWNsYXJpbmdDbGFzcygpKTsKICAgICAgICAgICAg\nb3V0LndyaXRlT2JqZWN0KF9tZW1iZXIuZ2V0TmFtZSgpKTsKICAgICAgICAg\nICAgaWYgKCFpc0ZpZWxkKQogICAgICAgICAgICAgICAgb3V0LndyaXRlT2Jq\nZWN0KCgoTWV0aG9kKSBfbWVtYmVyKS5nZXRQYXJhbWV0ZXJUeXBlcygpKTsK\nICAgICAgICB9CiAgICB9CgogICAgcHVibGljIGJvb2xlYW4gaXNWYWx1ZUdl\nbmVyYXRlZCgpIHsKICAgICAgICByZXR1cm4gX2dlbmVyYXRlZDsKICAgIH0K\nCiAgICBwdWJsaWMgdm9pZCBzZXRWYWx1ZUdlbmVyYXRlZChib29sZWFuIGdl\nbmVyYXRlZCkgewogICAgICAgIHRoaXMuX2dlbmVyYXRlZCA9IGdlbmVyYXRl\nZDsKICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBpc0VsZW1lbnRDb2xsZWN0\naW9uKCkgewogICAgICAgIHJldHVybiBfaXNFbGVtZW50Q29sbGVjdGlvbjsK\nICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRFbGVtZW50Q29sbGVjdGlvbihi\nb29sZWFuIGlzRWxlbWVudENvbGxlY3Rpb24pIHsKICAgICAgICB0aGlzLl9p\nc0VsZW1lbnRDb2xsZWN0aW9uID0gaXNFbGVtZW50Q29sbGVjdGlvbjsKICAg\nIH0KCiAgICBwdWJsaWMgU3RyaW5nIGdldE1hcHBlZEJ5SWRWYWx1ZSgpIHsK\nICAgICAgICByZXR1cm4gX21hcHBlZEJ5SWRWYWx1ZTsKICAgIH0KCiAgICBw\ndWJsaWMgdm9pZCBzZXRNYXBwZWRCeUlkVmFsdWUoU3RyaW5nIG1hcHBlZEJ5\nSWRWYWx1ZSkgewogICAgICAgIHRoaXMuX21hcHBlZEJ5SWRWYWx1ZSA9IG1h\ncHBlZEJ5SWRWYWx1ZTsKICAgIH0KICAgIAogICAgcHVibGljIGJvb2xlYW4g\naXNNYXBwZWRCeUlkKCkgewogICAgCXJldHVybiAoX21hcHBlZEJ5SWRWYWx1\nZSAhPSBudWxsKTsKICAgIH0KICAgIAogICAgLyoqCiAgICAgKiBHZXRzIHRo\nZSBhY2Nlc3MgdHlwZSB1c2VkIGJ5IHRoaXMgZmllbGQuIElmIG5vIGFjY2Vz\ncyB0eXBlIGlzIHNldCBmb3IKICAgICAqIHRoaXMgZmllbGQgdGhlbiByZXR1\ncm4gdGhlIGFjY2VzcyB0eXBlIHVzZWQgYnkgdGhlIGRlY2xhcmluZyBjbGFz\ncy4KICAgICAqLwogICAgcHVibGljIGludCBnZXRBY2Nlc3NUeXBlKCkgewog\nICAgICAgIGlmIChBY2Nlc3NDb2RlLmlzVW5rbm93bihfYWNjZXNzKSkgewog\nICAgICAgIAlpbnQgZkNvZGUgPSBBY2Nlc3NDb2RlLnRvRmllbGRDb2RlKGdl\ndERlY2xhcmluZ01ldGFEYXRhKCkKICAgICAgICAJCQkuZ2V0QWNjZXNzVHlw\nZSgpKTsKICAgICAgICAJcmV0dXJuIGZDb2RlOwogICAgICAgIH0KICAgICAg\nICByZXR1cm4gX2FjY2VzczsKICAgIH0KICAgIAogICAgLyoqCiAgICAgKiBT\nZXRzIGFjY2VzcyB0eXBlIG9mIHRoaXMgZmllbGQuIFRoZSBhY2Nlc3MgY29k\nZSBpcyB2ZXJpZmllZCBmb3IgdmFsaWRpdHkKICAgICAqIGFzIHdlbGwgYXMg\nYWdhaW5zdCB0aGUgYWNjZXNzIHN0eWxlIHVzZWQgYnkgdGhlIGRlY2xhcmlu\nZyBjbGFzcy4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0QWNjZXNzVHlw\nZShpbnQgZkNvZGUpIHsKICAgIAlDbGFzc01ldGFEYXRhIG93bmVyID0gZ2V0\nRGVjbGFyaW5nTWV0YURhdGEoKTsKICAgIAlvd25lci5tZXJnZUZpZWxkQWNj\nZXNzKHRoaXMsIGZDb2RlKTsKICAgICAgICBfYWNjZXNzID0gZkNvZGU7CiAg\nICB9CiAgICAKICAgIHB1YmxpYyBpbnQgZ2V0QXNzb2NpYXRpb25UeXBlKCkg\newogICAgICAgIHJldHVybiBfYXNzb2NpYXRpb25UeXBlOwogICAgfQogICAg\nCiAgICBwdWJsaWMgdm9pZCBzZXRBc3NvY2lhdGlvblR5cGUoaW50IHR5cGUp\nIHsKICAgICAgICBfYXNzb2NpYXRpb25UeXBlID0gdHlwZTsKICAgIH0KICAg\nIAp9Cg==\n","encoding":"base64"}

