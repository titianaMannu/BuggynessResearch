{"sha":"61e353b8e83519b190550b08e1ed118d75942cb3","node_id":"MDQ6QmxvYjIwNjM2NDo2MWUzNTNiOGU4MzUxOWIxOTA1NTBiMDhlMWVkMTE4ZDc1OTQyY2Iz","size":18750,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/61e353b8e83519b190550b08e1ed118d75942cb3","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEubGliLmNvbmY7CgppbXBvcnQg\namF2YS5pby5GaWxlOwppbXBvcnQgamF2YS5zZWN1cml0eS5BY2Nlc3NDb250\ncm9sbGVyOwppbXBvcnQgamF2YS5zZWN1cml0eS5Qcml2aWxlZ2VkQWN0aW9u\nRXhjZXB0aW9uOwppbXBvcnQgamF2YS51dGlsLkFycmF5TGlzdDsKaW1wb3J0\nIGphdmEudXRpbC5Db2xsZWN0aW9uOwppbXBvcnQgamF2YS51dGlsLkNvbGxl\nY3Rpb25zOwppbXBvcnQgamF2YS51dGlsLkNvbXBhcmF0b3I7CmltcG9ydCBq\nYXZhLnV0aWwuSXRlcmF0b3I7CmltcG9ydCBqYXZhLnV0aWwuTGlzdDsKaW1w\nb3J0IGphdmEudXRpbC5NYXA7CmltcG9ydCBqYXZhLnV0aWwuTWlzc2luZ1Jl\nc291cmNlRXhjZXB0aW9uOwppbXBvcnQgamF2YS51dGlsLlNldDsKaW1wb3J0\nIGphdmEudXRpbC5UcmVlU2V0OwoKaW1wb3J0IG9yZy5hcGFjaGUuY29tbW9u\ncy5sYW5nLlN0cmluZ1V0aWxzOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLmxpYi51dGlsLkoyRG9Qcml2SGVscGVyOwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLmxpYi51dGlsLkphdmFWZXJzaW9uczsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5saWIudXRpbC5Mb2NhbGl6ZXI7CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEubGliLnV0aWwuTXVsdGlDbGFzc0xvYWRlcjsKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5saWIudXRpbC5TZXJ2aWNlczsKCi8qKgog\nKiBVdGlsaXRpZXMgZm9yIHJ1bm5pbmcgcHJvZHVjdCBkZXJpdmF0aW9ucy4K\nICoKICogQGF1dGhvciBBYmUgV2hpdGUKICogQGF1dGhvciBQaW5ha2kgUG9k\nZGFyCiAqIEBub2phdmFkb2MKICovCnB1YmxpYyBjbGFzcyBQcm9kdWN0RGVy\naXZhdGlvbnMgewoKICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIExvY2FsaXpl\nciBfbG9jID0gTG9jYWxpemVyLmZvclBhY2thZ2UKICAgICAgICAoUHJvZHVj\ndERlcml2YXRpb25zLmNsYXNzKTsKCiAgICBwcml2YXRlIHN0YXRpYyBmaW5h\nbCBQcm9kdWN0RGVyaXZhdGlvbltdIF9kZXJpdmF0aW9uczsKICAgIHByaXZh\ndGUgc3RhdGljIGZpbmFsIFN0cmluZ1tdIF9kZXJpdmF0aW9uTmFtZXM7CiAg\nICBwcml2YXRlIHN0YXRpYyBmaW5hbCBUaHJvd2FibGVbXSBfZGVyaXZhdGlv\nbkVycm9yczsKICAgIHByaXZhdGUgc3RhdGljIFN0cmluZ1tdIF9wcmVmaXhl\nczsKICAgIHN0YXRpYyB7CiAgICAgICAgTXVsdGlDbGFzc0xvYWRlciBsID0g\nQWNjZXNzQ29udHJvbGxlci5kb1ByaXZpbGVnZWQoSjJEb1ByaXZIZWxwZXIu\nbmV3TXVsdGlDbGFzc0xvYWRlckFjdGlvbigpKTsKICAgICAgICBsLmFkZENs\nYXNzTG9hZGVyKDAsIEFjY2Vzc0NvbnRyb2xsZXIKICAgICAgICAgICAgLmRv\nUHJpdmlsZWdlZChKMkRvUHJpdkhlbHBlci5nZXRDbGFzc0xvYWRlckFjdGlv\nbihQcm9kdWN0RGVyaXZhdGlvbnMuY2xhc3MpKSk7CiAgICAgICAgbC5hZGRD\nbGFzc0xvYWRlcigxLCBBY2Nlc3NDb250cm9sbGVyLmRvUHJpdmlsZWdlZChK\nMkRvUHJpdkhlbHBlci5nZXRDb250ZXh0Q2xhc3NMb2FkZXJBY3Rpb24oKSkp\nOwogICAgICAgIF9kZXJpdmF0aW9uTmFtZXMgPSBTZXJ2aWNlcy5nZXRJbXBs\nZW1lbnRvcnMoUHJvZHVjdERlcml2YXRpb24uY2xhc3MsIGwpOwogICAgICAg\nIF9kZXJpdmF0aW9uRXJyb3JzID0gbmV3IFRocm93YWJsZVtfZGVyaXZhdGlv\nbk5hbWVzLmxlbmd0aF07CiAgICAgICAgTGlzdDxQcm9kdWN0RGVyaXZhdGlv\nbj4gZGVyaXZhdGlvbnMgPQogICAgICAgICAgICBuZXcgQXJyYXlMaXN0PFBy\nb2R1Y3REZXJpdmF0aW9uPihfZGVyaXZhdGlvbk5hbWVzLmxlbmd0aCk7CiAg\nICAgICAgYm9vbGVhbiBlcnJvcnMgPSBmYWxzZTsgCiAgICAgICAgZm9yIChp\nbnQgaSA9IDA7IGkgPCBfZGVyaXZhdGlvbk5hbWVzLmxlbmd0aDsgaSsrKSB7\nCiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBQcm9kdWN0RGVy\naXZhdGlvbiBkID0gKFByb2R1Y3REZXJpdmF0aW9uKQogICAgICAgICAgICAg\nICAgICAgIEFjY2Vzc0NvbnRyb2xsZXIuZG9Qcml2aWxlZ2VkKAogICAgICAg\nICAgICAgICAgICAgICAgICBKMkRvUHJpdkhlbHBlci5uZXdJbnN0YW5jZUFj\ndGlvbigKICAgICAgICAgICAgICAgICAgICAgICAgICAgIENsYXNzLmZvck5h\nbWUoX2Rlcml2YXRpb25OYW1lc1tpXSwgdHJ1ZSwgbCkpKTsKICAgICAgICAg\nICAgICAgIGQudmFsaWRhdGUoKTsKICAgICAgICAgICAgICAgIGRlcml2YXRp\nb25zLmFkZChkKTsKICAgICAgICAgICAgfSBjYXRjaCAoVGhyb3dhYmxlIHQp\nIHsKICAgICAgICAgICAgICAgIGlmICh0IGluc3RhbmNlb2YgUHJpdmlsZWdl\nZEFjdGlvbkV4Y2VwdGlvbikKICAgICAgICAgICAgICAgICAgICB0ID0gKChQ\ncml2aWxlZ2VkQWN0aW9uRXhjZXB0aW9uKSB0KS5nZXRFeGNlcHRpb24oKTsK\nICAgICAgICAgICAgICAgIF9kZXJpdmF0aW9uRXJyb3JzW2ldID0gdDsKICAg\nICAgICAgICAgICAgIGVycm9ycyA9IHRydWU7CiAgICAgICAgICAgIH0KICAg\nICAgICB9CgogICAgICAgIC8vIG11c3QgYmUgYXQgbGVhc3Qgb25lIHByb2R1\nY3QgZGVyaXZhdGlvbiB0byBkZWZpbmUgbWV0YWRhdGEgZmFjdG9yaWVzLAog\nICAgICAgIC8vIGV0Yy4gCiAgICAgICAgaWYgKGRlcml2YXRpb25zLmlzRW1w\ndHkoKSkgewogICAgICAgICAgICB0aHJvdyBuZXcgTWlzc2luZ1Jlc291cmNl\nRXhjZXB0aW9uKF9sb2MuZ2V0CiAgICAgICAgICAgICAgICAoIm5vLXByb2R1\nY3QtZGVyaXZhdGlvbnMiLCBQcm9kdWN0RGVyaXZhdGlvbi5jbGFzcy5nZXRO\nYW1lKCksCiAgICAgICAgICAgICAgICBkZXJpdmF0aW9uRXJyb3JzVG9TdHJp\nbmcoKSkuZ2V0TWVzc2FnZSgpLCAKICAgICAgICAgICAgICAgIFByb2R1Y3RE\nZXJpdmF0aW9ucy5jbGFzcy5nZXROYW1lKCksImRlcml2YXRpb25zIik7CiAg\nICAgICAgfQoKICAgICAgICAvLyBpZiBzb21lIGRlcml2YXRpb25zIHdlcmVu\nJ3QgaW5zdGFudGlhYmxlLCB3YXJuCiAgICAgICAgaWYgKGVycm9ycykKICAg\nICAgICAgICAgU3lzdGVtLmVyci5wcmludGxuKF9sb2MuZ2V0KCJiYWQtcHJv\nZHVjdC1kZXJpdmF0aW9ucyIsCiAgICAgICAgICAgICAgICBQcm9kdWN0RGVy\naXZhdGlvbnMuY2xhc3MuZ2V0TmFtZSgpKSk7CiAgICAgICAgZm9yIChpbnQg\naSA9IDA7IGkgPCBfZGVyaXZhdGlvbkVycm9ycy5sZW5ndGg7IGkrKykgewog\nICAgICAgICAgICBpZiAoX2Rlcml2YXRpb25FcnJvcnNbaV0gPT0gbnVsbCkK\nICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICBTeXN0ZW0u\nZXJyLnByaW50bG4oX2Rlcml2YXRpb25OYW1lc1tpXSArICI6IiArCiAgICAg\nICAgICAgICAgICAgICAgX2Rlcml2YXRpb25FcnJvcnNbaV0pOwogICAgICAg\nICAgICBicmVhazsKICAgICAgICB9CgogICAgICAgIENvbGxlY3Rpb25zLnNv\ncnQoZGVyaXZhdGlvbnMsIG5ldyBQcm9kdWN0RGVyaXZhdGlvbkNvbXBhcmF0\nb3IoKSk7CiAgICAgICAgX2Rlcml2YXRpb25zID0KICAgICAgICAgICAgZGVy\naXZhdGlvbnMudG9BcnJheShuZXcgUHJvZHVjdERlcml2YXRpb25bZGVyaXZh\ndGlvbnMuc2l6ZSgpXSk7CgogICAgICAgIExpc3Q8U3RyaW5nPiBwcmVmaXhl\ncyA9IG5ldyBBcnJheUxpc3Q8U3RyaW5nPigyKTsKICAgICAgICBwcmVmaXhl\ncy5hZGQoIm9wZW5qcGEiKTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8\nIF9kZXJpdmF0aW9ucy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBTdHJp\nbmcgcHJlZml4ID0gX2Rlcml2YXRpb25zW2ldLmdldENvbmZpZ3VyYXRpb25Q\ncmVmaXgoKTsKICAgICAgICAgICAgaWYgKHByZWZpeCAhPSBudWxsICYmICEi\nb3BlbmpwYSIuZXF1YWxzKHByZWZpeCkpCiAgICAgICAgICAgICAgICBwcmVm\naXhlcy5hZGQocHJlZml4KTsKICAgICAgICB9CiAgICAgICAgX3ByZWZpeGVz\nID0gcHJlZml4ZXMudG9BcnJheShuZXcgU3RyaW5nW3ByZWZpeGVzLnNpemUo\nKV0pOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIGFsbCB0aGUgcHJv\nZHVjdCBkZXJpdmF0aW9ucyByZWdpc3RlcmVkIGluIHRoZSBjdXJyZW50IGNs\nYXNzbG9hZGVyCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0aWMgUHJvZHVjdERl\ncml2YXRpb25bXSBnZXRQcm9kdWN0RGVyaXZhdGlvbnMoKSB7CiAgICAgICAg\ncmV0dXJuIF9kZXJpdmF0aW9uczsKICAgIH0KCiAgICAvKioKICAgICAqIFJl\ndHVybiB0aGUgcmVjb2duaXplZCBwcmVmaXhlcyBmb3IgY29uZmlndXJhdGlv\nbiBwcm9wZXJ0aWVzLgogICAgICovCiAgICBwdWJsaWMgc3RhdGljIFN0cmlu\nZ1tdIGdldENvbmZpZ3VyYXRpb25QcmVmaXhlcygpIHsKICAgICAgICByZXR1\ncm4gX3ByZWZpeGVzOwogICAgfQoKICAgIC8qKgogICAgICogU2V0IHRoZSBj\nb25maWd1cmF0aW9uIHByZWZpeCBhcnJheS4gVGhpcyBpcyBwYWNrYWdlLXZp\nc2libGUgZm9yIAogICAgICogdGVzdGluZyBwdXJwb3Nlcy4KICAgICAqIAog\nICAgICogQHNpbmNlIDAuOS43CiAgICAgKi8KICAgIHN0YXRpYyB2b2lkIHNl\ndENvbmZpZ3VyYXRpb25QcmVmaXhlcyhTdHJpbmdbXSBwcmVmaXhlcykgewog\nICAgICAgIF9wcmVmaXhlcyA9IHByZWZpeGVzOwogICAgfQogICAgCiAgICAv\nKioKICAgICAqIERldGVybWluZSB0aGUgZnVsbCBrZXkgbmFtZSBmb3IgPGNv\nZGU+cGFydGlhbEtleTwvY29kZT4sIGdpdmVuIHRoZSAKICAgICAqIHJlZ2lz\ndGVyZWQgcHJlZml4ZXMgYW5kIHRoZSBlbnRyaWVzIGluIDxjb2RlPm1hcDwv\nY29kZT4uIFRoaXMgbWV0aG9kCiAgICAgKiBjb21wdXRlcyB0aGUgYXBwcm9w\ncmlhdGUgY29uZmlndXJhdGlvbiBwcmVmaXggdG8gdXNlIGJ5IGxvb2tpbmcg\nCiAgICAgKiB0aHJvdWdoIDxjb2RlPm1hcDwvY29kZT4gZm9yIGEga2V5IHN0\nYXJ0aW5nIHdpdGggYW55IG9mIHRoZSBrbm93bgogICAgICogY29uZmlndXJh\ndGlvbiBwcmVmaXhlcyBhbmQgZW5kaW5nIHdpdGggPGNvZGU+cGFydGlhbEtl\neTwvY29kZT4gYW5kLCBpZiBhCiAgICAgKiB2YWx1ZSBpcyBmb3VuZCwgdXNp\nbmcgdGhlIHByZWZpeCBvZiB0aGF0IGtleS4gT3RoZXJ3aXNlLCBpdCB1c2Vz\nCiAgICAgKiB0aGUgZmlyc3QgcmVnaXN0ZXJlZCBwcmVmaXguIAogICAgICog\nCiAgICAgKiBUaGUgZ2l2ZW4gPGNvZGU+cGFydGlhbEtleTwvY29kZT4gaXMg\nZmlyc3QgdGVzdGVkIGZvciBjb250YWlubWVudCBpbiB0aGUKICAgICAqIGdp\ndmVuIG1hcCB3aXRob3V0IGFueSBwcmVmaXguCiAgICAgKiAgCiAgICAgKiBA\nc2luY2UgMC45LjcKICAgICAqLwogICAgcHVibGljIHN0YXRpYyBTdHJpbmcg\nZ2V0Q29uZmlndXJhdGlvbktleShTdHJpbmcgcGFydGlhbEtleSwgTWFwIG1h\ncCkgewogICAgICAgIFN0cmluZyBmaXJzdEtleSA9IChtYXAgIT0gbnVsbCAm\nJiBtYXAuY29udGFpbnNLZXkocGFydGlhbEtleSkpIAogICAgICAgICAgICA/\nIHBhcnRpYWxLZXkgOiBudWxsOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBt\nYXAgIT0gbnVsbCAmJiBpIDwgX3ByZWZpeGVzLmxlbmd0aDsgaSsrKSB7CiAg\nICAgICAgICAgIFN0cmluZyBmdWxsS2V5ID0gX3ByZWZpeGVzW2ldICsgIi4i\nICsgcGFydGlhbEtleTsKICAgICAgICAgICAgaWYgKG1hcC5jb250YWluc0tl\neShmdWxsS2V5KSkgewogICAgICAgICAgICAgICAgaWYgKGZpcnN0S2V5ID09\nIG51bGwpIAogICAgICAgICAgICAgICAgICAgIGZpcnN0S2V5ID0gZnVsbEtl\neTsKICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAg\nIC8vIGlmIHdlJ3ZlIGFscmVhZHkgZm91bmQgYSBwcm9wZXJ0eSB3aXRoIGEg\ncHJldmlvdXMgCiAgICAgICAgICAgICAgICAgICAgLy8gcHJlZml4LCB0aGVu\nIHRoaXMgaXMgYSBjb2xsaXNpb24uCiAgICAgICAgICAgICAgICAgICAgdGhy\nb3cgbmV3IElsbGVnYWxTdGF0ZUV4Y2VwdGlvbihfbG9jLmdldCgKICAgICAg\nICAgICAgICAgICAgICAgICAgImR1cC13aXRoLWRpZmZlcmVudC1wcmVmaXhl\ncyIsIGZpcnN0S2V5LCBmdWxsS2V5KQogICAgICAgICAgICAgICAgICAgICAg\nICAuZ2V0TWVzc2FnZSgpKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAg\nICAgfQogICAgICAgIH0KICAgICAgICAKICAgICAgICBpZiAoZmlyc3RLZXkg\nPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIF9wcmVmaXhlc1swXSArICIu\nIiArIHBhcnRpYWxLZXk7CiAgICAgICAgZWxzZQogICAgICAgICAgICByZXR1\ncm4gZmlyc3RLZXk7CiAgICB9CgogICAgLyoqCiAgICAgKiBBcHBseSB7QGxp\nbmsgUHJvZHVjdERlcml2YXRpb24jYmVmb3JlQ29uZmlndXJhdGlvbkNvbnN0\ncnVjdH0gY2FsbGJhY2tzCiAgICAgKiB0byB0aGUgdGhlIGdpdmVuIGluc3Rh\nbmNlLiBFeGNlcHRpb25zIG90aGVyIHRoYW4gZmF0YWwKICAgICAqIHtAbGlu\nayBCb290c3RyYXBFeGNlcHRpb259IGFyZSBzd2FsbG93ZWQuCiAgICAgKi8K\nICAgIHB1YmxpYyBzdGF0aWMgdm9pZCBiZWZvcmVDb25maWd1cmF0aW9uQ29u\nc3RydWN0KENvbmZpZ3VyYXRpb25Qcm92aWRlciBjcCkgewogICAgICAgIGZv\nciAoaW50IGkgPSAwOyBpIDwgX2Rlcml2YXRpb25zLmxlbmd0aDsgaSsrKSB7\nCiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBfZGVyaXZhdGlv\nbnNbaV0uYmVmb3JlQ29uZmlndXJhdGlvbkNvbnN0cnVjdChjcCk7CiAgICAg\nICAgICAgIH0gY2F0Y2ggKEJvb3RzdHJhcEV4Y2VwdGlvbiBiZSkgewogICAg\nICAgICAgICAJaWYgKGJlLmlzRmF0YWwoKSkKICAgICAgICAgICAgCQl0aHJv\ndyBiZTsKICAgICAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAg\nICAgICAgICAgICAgIC8vIGNhbid0IGxvZzsgbm8gY29uZmlndXJhdGlvbiB5\nZXQKICAgICAgICAgICAgICAgIGUucHJpbnRTdGFja1RyYWNlKCk7CiAgICAg\nICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBBcHBs\neSB7QGxpbmsgUHJvZHVjdERlcml2YXRpb24jYmVmb3JlQ29uZmlndXJhdGlv\nbkxvYWR9IGNhbGxiYWNrcwogICAgICogdG8gdGhlIHRoZSBnaXZlbiBpbnN0\nYW5jZS4gRXhjZXB0aW9ucyBvdGhlciB0aGFuIGZhdGFsCiAgICAgKiB7QGxp\nbmsgQm9vdHN0cmFwRXhjZXB0aW9ufSBhcmUgc3dhbGxvd2VkLgogICAgICov\nCiAgICBwdWJsaWMgc3RhdGljIHZvaWQgYmVmb3JlQ29uZmlndXJhdGlvbkxv\nYWQoQ29uZmlndXJhdGlvbiBjb25mKSB7CiAgICAgICAgZm9yIChpbnQgaSA9\nIDA7IGkgPCBfZGVyaXZhdGlvbnMubGVuZ3RoOyBpKyspIHsKICAgICAgICAg\nICAgdHJ5IHsKICAgICAgICAgICAgICAgIF9kZXJpdmF0aW9uc1tpXS5iZWZv\ncmVDb25maWd1cmF0aW9uTG9hZChjb25mKTsKICAgICAgICAgICAgfSBjYXRj\naCAoQm9vdHN0cmFwRXhjZXB0aW9uIGJlKSB7CiAgICAgICAgICAgIAlpZiAo\nYmUuaXNGYXRhbCgpKQogICAgICAgICAgICAJCXRocm93IGJlOwogICAgICAg\nICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkgewogICAgICAgICAgICAgICAg\nLy8gbG9nZ2luZyBub3QgY29uZmlndXJlZCB5ZXQKICAgICAgICAgICAgICAg\nIGUucHJpbnRTdGFja1RyYWNlKCk7CiAgICAgICAgICAgIH0KICAgICAgICB9\nCiAgICB9CgogICAgLyoqCiAgICAgKiBBcHBseSB7QGxpbmsgUHJvZHVjdERl\ncml2YXRpb24jYWZ0ZXJTcGVjaWZpY2F0aW9uU2V0fSBjYWxsYmFja3MKICAg\nICAqIHRvIHRoZSB0aGUgZ2l2ZW4gaW5zdGFuY2UuIEV4Y2VwdGlvbnMgb3Ro\nZXIgdGhhbiBmYXRhbAogICAgICoge0BsaW5rIEJvb3RzdHJhcEV4Y2VwdGlv\nbn0gYXJlIHN3YWxsb3dlZC4KICAgICAqLwogICAgcHVibGljIHN0YXRpYyB2\nb2lkIGFmdGVyU3BlY2lmaWNhdGlvblNldChDb25maWd1cmF0aW9uIGNvbmYp\nIHsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IF9kZXJpdmF0aW9ucy5s\nZW5ndGg7IGkrKykgewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAg\nICAgX2Rlcml2YXRpb25zW2ldLmFmdGVyU3BlY2lmaWNhdGlvblNldChjb25m\nKTsKICAgICAgICAgICAgfSBjYXRjaCAoQm9vdHN0cmFwRXhjZXB0aW9uIGJl\nKSB7CiAgICAgICAgICAgIAlpZiAoYmUuaXNGYXRhbCgpKQogICAgICAgICAg\nICAJCXRocm93IGJlOwogICAgICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24g\nZSkgewogICAgICAgICAgICAgICAgLy8gbG9nZ2luZyBub3QgY29uZmlndXJl\nZCB5ZXQKICAgICAgICAgICAgICAgIGUucHJpbnRTdGFja1RyYWNlKCk7CiAg\nICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBD\nYWxsZWQgYXMgdGhlIGZpcnN0IHN0ZXAgb2YgYSBDb25maWd1cmF0aW9uJ3Mg\nY2xvc2UoKSBtZXRob2QuIAogICAgICogRXhjZXB0aW9ucyBhcmUgc3dhbGxv\nd2VkLgogICAgICogCiAgICAgKiBAc2luY2UgMC45LjcKICAgICAqLwogICAg\ncHVibGljIHN0YXRpYyB2b2lkIGJlZm9yZUNsb3NlKENvbmZpZ3VyYXRpb24g\nY29uZikgewogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgX2Rlcml2YXRp\nb25zLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAg\nICAgICAgICBfZGVyaXZhdGlvbnNbaV0uYmVmb3JlQ29uZmlndXJhdGlvbkNs\nb3NlKGNvbmYpOwogICAgICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkg\newogICAgICAgICAgICAgICAgY29uZi5nZXRDb25maWd1cmF0aW9uTG9nKCku\nd2FybihfbG9jLmdldCgiYmVmb3JlLWNsb3NlLWV4IiksIGUpOwogICAgICAg\nICAgICB9CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogTG9hZCB0\naGUgZ2l2ZW4gZ2l2ZW4gcmVzb3VyY2UsIG9yIHJldHVybiBmYWxzZSBpZiBp\ndCBpcyBub3QgYSByZXNvdXJjZQogICAgICogdGhpcyBwcm92aWRlciB1bmRl\ncnN0YW5kcy4gVGhlIGdpdmVuIGNsYXNzIGxvYWRlciBtYXkgYmUgbnVsbC4K\nICAgICAqCiAgICAgKiBAcGFyYW0gYW5jaG9yIG9wdGlvbmFsIG5hbWVkIGFu\nY2hvciB3aXRoaW4gYSBtdWx0aXBsZS1jb25maWd1cmF0aW9uCiAgICAgKiBy\nZXNvdXJjZQogICAgICovCiAgICBwdWJsaWMgc3RhdGljIENvbmZpZ3VyYXRp\nb25Qcm92aWRlciBsb2FkKFN0cmluZyByZXNvdXJjZSwgU3RyaW5nIGFuY2hv\nciwgCiAgICAgICAgQ2xhc3NMb2FkZXIgbG9hZGVyKSB7CiAgICAgICAgaWYg\nKFN0cmluZ1V0aWxzLmlzRW1wdHkocmVzb3VyY2UpKQogICAgICAgICAgICBy\nZXR1cm4gbnVsbDsKICAgICAgICBpZiAobG9hZGVyID09IG51bGwpCiAgICAg\nICAgICAgIGxvYWRlciA9IEFjY2Vzc0NvbnRyb2xsZXIuZG9Qcml2aWxlZ2Vk\nKAogICAgICAgICAgICAgICAgSjJEb1ByaXZIZWxwZXIuZ2V0Q29udGV4dENs\nYXNzTG9hZGVyQWN0aW9uKCkpOwogICAgICAgIENvbmZpZ3VyYXRpb25Qcm92\naWRlciBwcm92aWRlciA9IG51bGw7CiAgICAgICAgU3RyaW5nQnVpbGRlciBl\ncnJzID0gbnVsbDsKICAgICAgICAvLyBtb3N0IHNwZWNpZmljIHRvIGxlYXN0\nCiAgICAgICAgVGhyb3dhYmxlIGVyciA9IG51bGw7CiAgICAgICAgZm9yIChp\nbnQgaSA9IF9kZXJpdmF0aW9ucy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkg\newogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgcHJvdmlkZXIg\nPSBfZGVyaXZhdGlvbnNbaV0ubG9hZChyZXNvdXJjZSwgYW5jaG9yLCBsb2Fk\nZXIpOwogICAgICAgICAgICAgICAgaWYgKHByb3ZpZGVyICE9IG51bGwpCiAg\nICAgICAgICAgICAgICAgICAgcmV0dXJuIHByb3ZpZGVyOwogICAgICAgICAg\nICB9IGNhdGNoIChUaHJvd2FibGUgdCkgewogICAgICAgICAgICAgICAgZXJy\nID0gdDsKICAgICAgICAgICAgICAgIGVycnMgPSAoZXJycyA9PSBudWxsKSA/\nIG5ldyBTdHJpbmdCdWlsZGVyKCkgOiBlcnJzLmFwcGVuZCgiXG4iKTsKICAg\nICAgICAgICAgICAgIGVycnMuYXBwZW5kKF9kZXJpdmF0aW9uc1tpXS5nZXRD\nbGFzcygpLmdldE5hbWUoKSArICI6IiArIHQpOwogICAgICAgICAgICB9CiAg\nICAgICAgfQogICAgICAgIHJlcG9ydEVycm9ycyhlcnJzLCByZXNvdXJjZSwg\nZXJyKTsKICAgICAgICBTdHJpbmcgcnNyYyA9IHJlc291cmNlICsgIiMiICsg\nYW5jaG9yOwogICAgICAgIHRocm93IChNaXNzaW5nUmVzb3VyY2VFeGNlcHRp\nb24pIEphdmFWZXJzaW9ucy5pbml0Q2F1c2UKICAgICAgICAgICAgKG5ldyBN\naXNzaW5nUmVzb3VyY2VFeGNlcHRpb24ocnNyYywKICAgICAgICAgICAgICAg\nIFByb2R1Y3REZXJpdmF0aW9ucy5jbGFzcy5nZXROYW1lKCksIHJzcmMpLCBl\ncnIpOwogICAgfQoKICAgIC8qKgogICAgICogTG9hZCBnaXZlbiBmaWxlLCBv\nciByZXR1cm4gZmFsc2UgaWYgaXQgaXMgbm90IGEgZmlsZSB0aGlzIHByb3Zp\nZGVyCiAgICAgKiB1bmRlcnN0YW5kcy4KICAgICAqCiAgICAgKiBAcGFyYW0g\nYW5jaG9yIG9wdGlvbmFsIG5hbWVkIGFuY2hvciB3aXRoaW4gYSBtdWx0aXBs\nZS1jb25maWd1cmF0aW9uIGZpbGUKICAgICAqLwogICAgcHVibGljIHN0YXRp\nYyBDb25maWd1cmF0aW9uUHJvdmlkZXIgbG9hZChGaWxlIGZpbGUsIFN0cmlu\nZyBhbmNob3IsIAogICAgICAgIENsYXNzTG9hZGVyIGxvYWRlcikgewogICAg\nICAgIGlmIChmaWxlID09IG51bGwpCiAgICAgICAgICAgIHJldHVybiBudWxs\nOwogICAgICAgIGlmIChsb2FkZXIgPT0gbnVsbCkKICAgICAgICAgICAgbG9h\nZGVyID0gQWNjZXNzQ29udHJvbGxlci5kb1ByaXZpbGVnZWQoCiAgICAgICAg\nICAgICAgICBKMkRvUHJpdkhlbHBlci5nZXRDb250ZXh0Q2xhc3NMb2FkZXJB\nY3Rpb24oKSk7CiAgICAgICAgQ29uZmlndXJhdGlvblByb3ZpZGVyIHByb3Zp\nZGVyID0gbnVsbDsKICAgICAgICBTdHJpbmdCdWlsZGVyIGVycnMgPSBudWxs\nOwogICAgICAgIFRocm93YWJsZSBlcnIgPSBudWxsOwogICAgICAgIC8vIG1v\nc3Qgc3BlY2lmaWMgdG8gbGVhc3QKICAgICAgICBmb3IgKGludCBpID0gX2Rl\ncml2YXRpb25zLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7CiAgICAgICAg\nICAgIHRyeSB7CiAgICAgICAgICAgICAgICBwcm92aWRlciA9IF9kZXJpdmF0\naW9uc1tpXS5sb2FkKGZpbGUsIGFuY2hvcik7CiAgICAgICAgICAgICAgICBp\nZiAocHJvdmlkZXIgIT0gbnVsbCkKICAgICAgICAgICAgICAgICAgICByZXR1\ncm4gcHJvdmlkZXI7CiAgICAgICAgICAgIH0gY2F0Y2ggKFRocm93YWJsZSB0\nKSB7CiAgICAgICAgICAgICAgICBlcnIgPSB0OwogICAgICAgICAgICAgICAg\nZXJycyA9IChlcnJzID09IG51bGwpID8gbmV3IFN0cmluZ0J1aWxkZXIoKSA6\nIGVycnMuYXBwZW5kKCJcbiIpOwogICAgICAgICAgICAgICAgZXJycy5hcHBl\nbmQoX2Rlcml2YXRpb25zW2ldLmdldENsYXNzKCkuZ2V0TmFtZSgpICsgIjoi\nICsgdCk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgU3RyaW5n\nIGFQYXRoID0gQWNjZXNzQ29udHJvbGxlci5kb1ByaXZpbGVnZWQoCiAgICAg\nICAgICAgIEoyRG9Qcml2SGVscGVyLmdldEFic29sdXRlUGF0aEFjdGlvbihm\naWxlKSk7CiAgICAgICAgcmVwb3J0RXJyb3JzKGVycnMsIGFQYXRoLCBlcnIp\nOwogICAgICAgIFN0cmluZyByc3JjID0gYVBhdGggKyAiIyIgKyBhbmNob3I7\nCiAgICAgICAgdGhyb3cgKE1pc3NpbmdSZXNvdXJjZUV4Y2VwdGlvbikgSmF2\nYVZlcnNpb25zLmluaXRDYXVzZQogICAgICAgICAgICAobmV3IE1pc3NpbmdS\nZXNvdXJjZUV4Y2VwdGlvbihyc3JjLAogICAgICAgICAgICAgICAgUHJvZHVj\ndERlcml2YXRpb25zLmNsYXNzLmdldE5hbWUoKSwgcnNyYyksIGVycik7CiAg\nICB9CiAgIAogICAgLyoqCiAgICAgKiBSZXR1cm4gYSB7QGxpbmsgQ29uZmln\ndXJhdGlvblByb3ZpZGVyfSB0aGF0IGhhcyBwYXJzZWQgc3lzdGVtIGRlZmF1\nbHRzLgogICAgICovCiAgICBwdWJsaWMgc3RhdGljIENvbmZpZ3VyYXRpb25Q\ncm92aWRlciBsb2FkRGVmYXVsdHMoQ2xhc3NMb2FkZXIgbG9hZGVyKSB7CiAg\nICAgICAgcmV0dXJuIGxvYWQobG9hZGVyLCBmYWxzZSk7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBSZXR1cm4gYSB7QGxpbmsgQ29uZmlndXJhdGlvblByb3Zp\nZGVyfSB0aGF0IGhhcyBwYXJzZWQgc3lzdGVtIGdsb2JhbHMuCiAgICAgKi8K\nICAgIHB1YmxpYyBzdGF0aWMgQ29uZmlndXJhdGlvblByb3ZpZGVyIGxvYWRH\nbG9iYWxzKENsYXNzTG9hZGVyIGxvYWRlcikgewogICAgICAgIHJldHVybiBs\nb2FkKGxvYWRlciwgdHJ1ZSk7CiAgICB9CiAgICAgICAgICAgIAogICAgLyoq\nCiAgICAgKiBMb2FkIGEgYnVpbHQtaW4gcmVzb3VyY2UgbG9jYXRpb24uCiAg\nICAgKi8KICAgIHByaXZhdGUgc3RhdGljIENvbmZpZ3VyYXRpb25Qcm92aWRl\nciBsb2FkKENsYXNzTG9hZGVyIGxvYWRlciwgCiAgICAgICBib29sZWFuIGds\nb2JhbHMpIHsKICAgICAgICBpZiAobG9hZGVyID09IG51bGwpCiAgICAgICAg\nICAgIGxvYWRlciA9IEFjY2Vzc0NvbnRyb2xsZXIuZG9Qcml2aWxlZ2VkKAog\nICAgICAgICAgICAgICAgSjJEb1ByaXZIZWxwZXIuZ2V0Q29udGV4dENsYXNz\nTG9hZGVyQWN0aW9uKCkpOwogICAgICAgIAogICAgICAgIENvbmZpZ3VyYXRp\nb25Qcm92aWRlciBwcm92aWRlciA9IG51bGw7CiAgICAgICAgU3RyaW5nQnVp\nbGRlciBlcnJzID0gbnVsbDsKICAgICAgICBTdHJpbmcgdHlwZSA9IChnbG9i\nYWxzKSA/ICJnbG9iYWxzIiA6ICJkZWZhdWx0cyI7CiAgICAgICAgVGhyb3dh\nYmxlIGVyciA9IG51bGw7CiAgICAgICAgLy8gbW9zdCBzcGVjaWZpYyB0byBs\nZWFzdAogICAgICAgIGZvciAoaW50IGkgPSBfZGVyaXZhdGlvbnMubGVuZ3Ro\nIC0gMTsgaSA+PSAwOyBpLS0pIHsKICAgICAgICAgICAgdHJ5IHsKICAgICAg\nICAgICAgICAgIHByb3ZpZGVyID0gKGdsb2JhbHMpID8gX2Rlcml2YXRpb25z\nW2ldLmxvYWRHbG9iYWxzKGxvYWRlcikgCiAgICAgICAgICAgICAgICAgICAg\nOiBfZGVyaXZhdGlvbnNbaV0ubG9hZERlZmF1bHRzKGxvYWRlcik7CiAgICAg\nICAgICAgICAgICBpZiAocHJvdmlkZXIgIT0gbnVsbCkKICAgICAgICAgICAg\nICAgICAgIHJldHVybiBwcm92aWRlcjsKICAgICAgICAgICAgfSBjYXRjaCAo\nVGhyb3dhYmxlIHQpIHsKICAgICAgICAgICAgICAgIGVyciA9IHQ7CiAgICAg\nICAgICAgICAgICBlcnJzID0gKGVycnMgPT0gbnVsbCkgPyBuZXcgU3RyaW5n\nQnVpbGRlcigpIDogZXJycy5hcHBlbmQoIlxuIik7CiAgICAgICAgICAgICAg\nICBlcnJzLmFwcGVuZChfZGVyaXZhdGlvbnNbaV0uZ2V0Q2xhc3MoKS5nZXRO\nYW1lKCkgKyAiOiIgKyB0KTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAg\nICAgICByZXBvcnRFcnJvcnMoZXJycywgdHlwZSwgZXJyKTsKICAgICAgICBy\nZXR1cm4gbnVsbDsKICAgIH0KIAogICAgLyoqCiAgICAgKiBUaHJvd24gcHJv\ncGVyIGV4Y2VwdGlvbiBmb3IgZ2l2ZW4gZXJyb3JzLgogICAgICovCiAgICBw\ncml2YXRlIHN0YXRpYyB2b2lkIHJlcG9ydEVycm9ycyhTdHJpbmdCdWlsZGVy\nIGVycnMsIFN0cmluZyByZXNvdXJjZSwKICAgICAgICBUaHJvd2FibGUgbmVz\ndGVkKSB7CiAgICAgICAgaWYgKGVycnMgPT0gbnVsbCkKICAgICAgICAgICAg\ncmV0dXJuOwogICAgICAgIHRocm93IChNaXNzaW5nUmVzb3VyY2VFeGNlcHRp\nb24pIEphdmFWZXJzaW9ucy5pbml0Q2F1c2UKICAgICAgICAgICAgKG5ldyBN\naXNzaW5nUmVzb3VyY2VFeGNlcHRpb24oZXJycy50b1N0cmluZygpLAogICAg\nICAgICAgICAgICAgUHJvZHVjdERlcml2YXRpb25zLmNsYXNzLmdldE5hbWUo\nKSwgcmVzb3VyY2UpLCBuZXN0ZWQpOwogICAgfQoKICAgIC8qKgogICAgICog\nUmV0dXJuIGEgTGlzdDxTdHJpbmc+IG9mIGFsbCB0aGUgZnVsbHktcXVhbGlm\naWVkIGFuY2hvcnMgc3BlY2lmaWVkIGluCiAgICAgKiA8Y29kZT5wcm9wZXJ0\naWVzTG9jYXRpb248L2NvZGU+LiBUaGUgcmV0dXJuIHZhbHVlcyBtdXN0IGJl\nIHVzZWQgaW4KICAgICAqIGNvbmp1bmN0aW9uIHdpdGggPGNvZGU+cHJvcGVy\ndGllc0xvY2F0aW9uPC9jb2RlPi4gSWYgdGhlcmUgYXJlIG5vCiAgICAgKiBw\ncm9kdWN0IGRlcml2YXRpb25zIG9yIGlmIG5vIHByb2R1Y3QgZGVyaXZhdGlv\nbnMgY291bGQgZmluZCBhbmNob3JzLAogICAgICogdGhpcyByZXR1cm5zIGFu\nIGVtcHR5IGxpc3QuCiAgICAgKgogICAgICogQHNpbmNlIDEuMS4wCiAgICAg\nKi8KICAgIHB1YmxpYyBzdGF0aWMgTGlzdDxTdHJpbmc+IGdldEZ1bGx5UXVh\nbGlmaWVkQW5jaG9yc0luUHJvcGVydGllc0xvY2F0aW9uKAogICAgICAgIGZp\nbmFsIFN0cmluZyBwcm9wZXJ0aWVzTG9jYXRpb24pIHsKICAgICAgICBMaXN0\nPFN0cmluZz4gZnFBbmNob3JzID0gbmV3IEFycmF5TGlzdDxTdHJpbmc+KCk7\nCiAgICAgICAgU3RyaW5nQnVpbGRlciBlcnJzID0gbnVsbDsKICAgICAgICBU\naHJvd2FibGUgZXJyID0gbnVsbDsKICAgICAgICBmb3IgKGludCBpID0gX2Rl\ncml2YXRpb25zLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7CiAgICAgICAg\nICAgIHRyeSB7CiAgICAgICAgICAgICAgICBpZiAocHJvcGVydGllc0xvY2F0\naW9uID09IG51bGwpIHsKICAgICAgICAgICAgICAgICAgICBTdHJpbmcgbG9j\nID0gX2Rlcml2YXRpb25zW2ldLmdldERlZmF1bHRSZXNvdXJjZUxvY2F0aW9u\nKCk7CiAgICAgICAgICAgICAgICAgICAgYWRkQWxsKGZxQW5jaG9ycywgbG9j\nLAogICAgICAgICAgICAgICAgICAgICAgICBfZGVyaXZhdGlvbnNbaV0uZ2V0\nQW5jaG9yc0luUmVzb3VyY2UobG9jKSk7CiAgICAgICAgICAgICAgICAgICAg\nY29udGludWU7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAg\nRmlsZSBmID0gbmV3IEZpbGUocHJvcGVydGllc0xvY2F0aW9uKTsKICAgICAg\nICAgICAgICAgIGlmICgoKEJvb2xlYW4pIEoyRG9Qcml2SGVscGVyLmlzRmls\nZUFjdGlvbihmKS5ydW4oKSkKICAgICAgICAgICAgICAgICAgICAuYm9vbGVh\nblZhbHVlKCkpIHsKICAgICAgICAgICAgICAgICAgICBhZGRBbGwoZnFBbmNo\nb3JzLCBwcm9wZXJ0aWVzTG9jYXRpb24sCiAgICAgICAgICAgICAgICAgICAg\nICAgIF9kZXJpdmF0aW9uc1tpXS5nZXRBbmNob3JzSW5GaWxlKGYpKTsKICAg\nICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgZiA9\nIG5ldyBGaWxlKCJNRVRBLUlORiIgKyBGaWxlLnNlcGFyYXRvckNoYXIKICAg\nICAgICAgICAgICAgICAgICAgICAgKyBwcm9wZXJ0aWVzTG9jYXRpb24pOwog\nICAgICAgICAgICAgICAgICAgIGlmICgoKEJvb2xlYW4pIEoyRG9Qcml2SGVs\ncGVyLmlzRmlsZUFjdGlvbihmKS5ydW4oKSkKICAgICAgICAgICAgICAgICAg\nICAgICAgLmJvb2xlYW5WYWx1ZSgpKSB7CiAgICAgICAgICAgICAgICAgICAg\nICAgIGFkZEFsbChmcUFuY2hvcnMsIHByb3BlcnRpZXNMb2NhdGlvbiwKICAg\nICAgICAgICAgICAgICAgICAgICAgICAgIF9kZXJpdmF0aW9uc1tpXS5nZXRB\nbmNob3JzSW5GaWxlKGYpKTsKICAgICAgICAgICAgICAgICAgICB9IGVsc2Ug\newogICAgICAgICAgICAgICAgICAgICAgICBhZGRBbGwoZnFBbmNob3JzLCBw\ncm9wZXJ0aWVzTG9jYXRpb24sCiAgICAgICAgICAgICAgICAgICAgICAgICAg\nICBfZGVyaXZhdGlvbnNbaV0uZ2V0QW5jaG9yc0luUmVzb3VyY2UoCiAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvcGVydGllc0xvY2F0aW9u\nKSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQog\nICAgICAgICAgICB9IGNhdGNoIChUaHJvd2FibGUgdCkgewogICAgICAgICAg\nICAgICAgZXJyID0gdDsKICAgICAgICAgICAgICAgIGVycnMgPSAoZXJycyA9\nPSBudWxsKSA/IG5ldyBTdHJpbmdCdWlsZGVyKCkgOiBlcnJzLmFwcGVuZCgi\nXG4iKTsKICAgICAgICAgICAgICAgIGVycnMuYXBwZW5kKF9kZXJpdmF0aW9u\nc1tpXS5nZXRDbGFzcygpLmdldE5hbWUoKSArICI6IiArIHQpOwogICAgICAg\nICAgICB9CiAgICAgICAgfQogICAgICAgIHJlcG9ydEVycm9ycyhlcnJzLCBw\ncm9wZXJ0aWVzTG9jYXRpb24sIGVycik7CiAgICAgICAgcmV0dXJuIGZxQW5j\naG9yczsKICAgIH0KCiAgICBwcml2YXRlIHN0YXRpYyB2b2lkIGFkZEFsbChD\nb2xsZWN0aW9uIGNvbGxlY3Rpb24sIFN0cmluZyBiYXNlLAogICAgICAgIENv\nbGxlY3Rpb24gbmV3TWVtYmVycykgewogICAgICAgIGlmIChuZXdNZW1iZXJz\nID09IG51bGwgfHwgY29sbGVjdGlvbiA9PSBudWxsKQogICAgICAgICAgICBy\nZXR1cm47CiAgICAgICAgZm9yIChJdGVyYXRvciBpdGVyID0gbmV3TWVtYmVy\ncy5pdGVyYXRvcigpOyBpdGVyLmhhc05leHQoKTsgKSB7CiAgICAgICAgICAg\nIFN0cmluZyBmcUxvYyA9IGJhc2UgKyAiIyIgKyBpdGVyLm5leHQoKTsKICAg\nICAgICAgICAgaWYgKCFjb2xsZWN0aW9uLmNvbnRhaW5zKGZxTG9jKSkKICAg\nICAgICAgICAgICAgIGNvbGxlY3Rpb24uYWRkKGZxTG9jKTsKICAgICAgICB9\nCiAgICB9CiAgICAKICAgIAogICAgcHVibGljIHN0YXRpYyBTZXQ8U3RyaW5n\nPiBnZXRTdXBwb3J0ZWRRdWVyeUhpbnRzKCkgewogICAgICAgIFNldDxTdHJp\nbmc+IHJlc3VsdCA9IG5ldyBUcmVlU2V0PFN0cmluZz4oKTsKICAgICAgICAv\nLyBtb3N0IHNwZWNpZmljIHRvIGxlYXN0CiAgICAgICAgZm9yIChpbnQgaSA9\nIF9kZXJpdmF0aW9ucy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkgewogICAg\nICAgICAgICBTZXQ8U3RyaW5nPiBtZW1iZXJzID0gX2Rlcml2YXRpb25zW2ld\nLmdldFN1cHBvcnRlZFF1ZXJ5SGludHMoKTsKICAgICAgICAgICAgaWYgKG1l\nbWJlcnMgIT0gbnVsbCB8fCAhbWVtYmVycy5pc0VtcHR5KCkpCiAgICAgICAg\nICAgICAgICByZXN1bHQuYWRkQWxsKG1lbWJlcnMpOwogICAgICAgIH0KICAg\nICAgICByZXR1cm4gcmVzdWx0OwogICAgfQoKCiAgICAvKioKICAgICAqIENv\nbXBhcmUge0BsaW5rIFByb2R1Y3REZXJpdmF0aW9ufXMuCiAgICAgKi8KICAg\nIHByaXZhdGUgc3RhdGljIGNsYXNzIFByb2R1Y3REZXJpdmF0aW9uQ29tcGFy\nYXRvcgogICAgICAgIGltcGxlbWVudHMgQ29tcGFyYXRvcjxQcm9kdWN0RGVy\naXZhdGlvbj4gewoKICAgICAgICBwdWJsaWMgaW50IGNvbXBhcmUoUHJvZHVj\ndERlcml2YXRpb24gbzEsIFByb2R1Y3REZXJpdmF0aW9uIG8yKSB7CiAgICAg\nICAgICAgIGludCB0eXBlMSA9IG8xLmdldFR5cGUoKTsKICAgICAgICAgICAg\naW50IHR5cGUyID0gbzIuZ2V0VHlwZSgpOwogICAgICAgICAgICBpZiAodHlw\nZTEgIT0gdHlwZTIpCiAgICAgICAgICAgICAgICByZXR1cm4gdHlwZTEgLSB0\neXBlMjsKCiAgICAgICAgICAgIC8vIGFyYml0cmFyeSBidXQgY29uc2lzdGVu\ndCBvcmRlcgogICAgICAgICAgICByZXR1cm4gbzEuZ2V0Q2xhc3MoKS5nZXRO\nYW1lKCkuY29tcGFyZVRvKG8yLmdldENsYXNzKCkuCiAgICAgICAgICAgICAg\nICBnZXROYW1lKCkpOwoJCX0KCX0KCiAgICAvKioKICAgICAqIFByaW50cyBw\ncm9kdWN0IGRlcml2YXRpb24gaW5mb3JtYXRpb24uCiAgICAgKi8KICAgIHB1\nYmxpYyBzdGF0aWMgdm9pZCBtYWluKFN0cmluZ1tdIGFyZ3MpIHsKICAgICAg\nICBTeXN0ZW0uZXJyLnByaW50bG4oZGVyaXZhdGlvbkVycm9yc1RvU3RyaW5n\nKCkpOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIGEgbWVzc2FnZSBh\nYm91dCB0aGUgc3RhdHVzIG9mIGVhY2ggcHJvZHVjdCBkZXJpdmF0aW9uLgog\nICAgICovCiAgICBwcml2YXRlIHN0YXRpYyBTdHJpbmcgZGVyaXZhdGlvbkVy\ncm9yc1RvU3RyaW5nKCkgewogICAgICAgIFN0cmluZ0J1aWxkZXIgYnVmID0g\nbmV3IFN0cmluZ0J1aWxkZXIoKTsKICAgICAgICBidWYuYXBwZW5kKCJQcm9k\ndWN0RGVyaXZhdGlvbnM6ICIpLmFwcGVuZChfZGVyaXZhdGlvbk5hbWVzLmxl\nbmd0aCk7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBfZGVyaXZhdGlv\nbk5hbWVzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGJ1Zi5hcHBlbmQo\nIlxuIikuYXBwZW5kKGkgKyAxKS5hcHBlbmQoIi4gIikuCiAgICAgICAgICAg\nICAgICBhcHBlbmQoX2Rlcml2YXRpb25OYW1lc1tpXSkuYXBwZW5kKCI6ICIp\nOwogICAgICAgICAgICBpZiAoX2Rlcml2YXRpb25FcnJvcnNbaV0gPT0gbnVs\nbCkKICAgICAgICAgICAgICAgIGJ1Zi5hcHBlbmQoIk9LIik7CiAgICAgICAg\nICAgIGVsc2UKICAgICAgICAgICAgICAgIGJ1Zi5hcHBlbmQoX2Rlcml2YXRp\nb25FcnJvcnNbaV0udG9TdHJpbmcoKSk7CiAgICAgICAgfQogICAgICAgIHJl\ndHVybiBidWYudG9TdHJpbmcoKTsKICAgIH0KfQoK\n","encoding":"base64"}

