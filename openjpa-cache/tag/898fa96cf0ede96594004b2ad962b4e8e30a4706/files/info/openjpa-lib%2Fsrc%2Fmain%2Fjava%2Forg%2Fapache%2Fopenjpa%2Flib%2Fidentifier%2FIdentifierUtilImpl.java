{"sha":"f2b4764c96ed94a93ba2d77a64d277a2b6f06c82","node_id":"MDQ6QmxvYjIwNjM2NDpmMmI0NzY0Yzk2ZWQ5NGE5M2JhMmQ3N2E2NGQyNzdhMmI2ZjA2Yzgy","size":20325,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/f2b4764c96ed94a93ba2d77a64d277a2b6f06c82","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEubGliLmlkZW50aWZpZXI7Cgpp\nbXBvcnQgamF2YS51dGlsLkFycmF5TGlzdDsKCmltcG9ydCBvcmcuYXBhY2hl\nLmNvbW1vbnMubGFuZy5TdHJpbmdVdGlsczsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS5saWIuY29uZi5Db25maWd1cmFibGU7CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEubGliLmNvbmYuQ29uZmlndXJhdGlvbjsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5saWIudXRpbC5Mb2NhbGl6ZXI7CgovKioKICog\nSW1wbGVtZW50YXRpb24gY2xhc3MgZm9yIHRoZSBiYXNlIGlkZW50aWZpZXIg\naW1wbC4KICoKICovCnB1YmxpYyBjbGFzcyBJZGVudGlmaWVyVXRpbEltcGwg\naW1wbGVtZW50cyBJZGVudGlmaWVyVXRpbCwgQ29uZmlndXJhYmxlIHsKICAg\nICAgICAKICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIExvY2FsaXplciBfbG9j\nID0gTG9jYWxpemVyLmZvclBhY2thZ2UKICAgICAgICAoSWRlbnRpZmllclV0\naWxJbXBsLmNsYXNzKTsKICAgIAogICAgcHJpdmF0ZSBJZGVudGlmaWVyQ29u\nZmlndXJhdGlvbiBfY29uZmlnID0gbnVsbDsKICAgIAogICAgcHVibGljIElk\nZW50aWZpZXJVdGlsSW1wbCgpIHsKICAgICAgICAKICAgIH0KICAgIAogICAg\ncHVibGljIElkZW50aWZpZXJVdGlsSW1wbChJZGVudGlmaWVyQ29uZmlndXJh\ndGlvbiBjb25maWcpIHsKICAgICAgICBfY29uZmlnID0gY29uZmlnOwogICAg\nfQoKICAgIHB1YmxpYyB2b2lkIHNldElkZW50aWZpZXJDb25maWd1cmF0aW9u\nKElkZW50aWZpZXJDb25maWd1cmF0aW9uIGNvbmZpZykgewogICAgICAgIF9j\nb25maWcgPSBjb25maWc7CiAgICB9ICAgIAoKICAgIHB1YmxpYyBJZGVudGlm\naWVyQ29uZmlndXJhdGlvbiBnZXRJZGVudGlmaWVyQ29uZmlndXJhdGlvbigp\nIHsKICAgICAgICByZXR1cm4gX2NvbmZpZzsKICAgIH0gICAgCgogICAgcHVi\nbGljIFN0cmluZyBjb21iaW5lTmFtZXMoU3RyaW5nIHJ1bGUsIFN0cmluZyBu\nYW1lMSwgU3RyaW5nIG5hbWUyKSB7CiAgICAgICAgcmV0dXJuIGNvbWJpbmVO\nYW1lcyhnZXROYW1pbmdSdWxlKHJ1bGUpLCBuYW1lMSwgbmFtZTIpOwogICAg\nfQoKICAgIHB1YmxpYyBTdHJpbmcgY29tYmluZU5hbWVzKFN0cmluZyBydWxl\nLCBTdHJpbmdbXSBuYW1lcykgewogICAgICAgIHJldHVybiBjb21iaW5lTmFt\nZXMoZ2V0TmFtaW5nUnVsZShydWxlKSwgbmFtZXMpOwogICAgfQoKICAgIHB1\nYmxpYyBTdHJpbmcgY29tYmluZU5hbWVzKElkZW50aWZpZXJDb25maWd1cmF0\naW9uIGNvbmZpZywgU3RyaW5nIHJ1bGUsIFN0cmluZ1tdIG5hbWVzKSB7CiAg\nICAgICAgcmV0dXJuIGNvbWJpbmVOYW1lcyhjb25maWcsIGdldE5hbWluZ1J1\nbGUocnVsZSksIG5hbWVzKTsKICAgIH0KCiAgICBwdWJsaWMgU3RyaW5nIGNv\nbWJpbmVOYW1lcyhJZGVudGlmaWVyUnVsZSBydWxlLCAKICAgICAgICBJZGVu\ndGlmaWVyUnVsZVtdIHJ1bGVzLCBTdHJpbmdbXSBuYW1lcykgewogICAgICAg\nIHJldHVybiBjb21iaW5lTmFtZXMoX2NvbmZpZywgcnVsZSwgcnVsZXMsIG5h\nbWVzKTsKICAgIH0KCiAgICBwdWJsaWMgU3RyaW5nIGNvbWJpbmVOYW1lcyhJ\nZGVudGlmaWVyQ29uZmlndXJhdGlvbiBjb25maWcsIElkZW50aWZpZXJSdWxl\nIHJ1bGUsIAogICAgICAgIElkZW50aWZpZXJSdWxlW10gcnVsZXMsIFN0cmlu\nZ1tdIG5hbWVzKSB7CiAgICAgICAgYm9vbGVhbiBkZWxpbWl0ZWQgPSBmYWxz\nZTsKICAgICAgICBTdHJpbmcgY29tYmluZWQgPSBudWxsOwogICAgICAgIGZv\nciAoaW50IGkgPSAwOyBpIDwgbmFtZXMubGVuZ3RoOyBpKyspIHsKICAgICAg\nICAgICAgU3RyaW5nIG5hbWUgPSBuYW1lc1tpXTsKICAgICAgICAgICAgaWYg\nKGlzRGVsaW1pdGVkKHJ1bGVzW2ldLCBuYW1lKSkgewogICAgICAgICAgICAg\nICAgZGVsaW1pdGVkID0gdHJ1ZTsKICAgICAgICAgICAgICAgIG5hbWUgPSBy\nZW1vdmVEZWxpbWl0ZXJzKGNvbmZpZywgcnVsZXNbaV0sIG5hbWUpOwogICAg\nICAgICAgICB9CiAgICAgICAgICAgIGlmIChpID09IDApIHsKICAgICAgICAg\nICAgICAgIGNvbWJpbmVkID0gbmFtZTsKICAgICAgICAgICAgfQogICAgICAg\nICAgICBlbHNlIHsKICAgICAgICAgICAgICAgIGNvbWJpbmVkID0gY29tYmlu\nZWQgKyBjb25maWcuZ2V0SWRlbnRpZmllckNvbmNhdGVuYXRvcigpICsgbmFt\nZTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICAKICAgICAgICBp\nZiAoZGVsaW1pdGVkKSB7CiAgICAgICAgICAgIGNvbWJpbmVkID0gZGVsaW1p\ndChjb25maWcsIHJ1bGUsIGNvbWJpbmVkLnRvU3RyaW5nKCkpLnRvU3RyaW5n\nKCk7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIHJldHVybiBjb21iaW5l\nZDsKICAgIH0KICAgIAogICAgcHVibGljIFN0cmluZyBjb21iaW5lTmFtZXMo\nSWRlbnRpZmllckNvbmZpZ3VyYXRpb24gY29uZmlnLCBJZGVudGlmaWVyUnVs\nZSBydWxlLCBTdHJpbmcgbmFtZTEsIFN0cmluZyBuYW1lMikgewogICAgICAg\nIGJvb2xlYW4gZGVsaW1pdCA9IGZhbHNlOwogICAgICAgIGlmIChpc0RlbGlt\naXRlZChydWxlLCBuYW1lMSkpIHsKICAgICAgICAgICAgbmFtZTEgPSByZW1v\ndmVEZWxpbWl0ZXJzKGNvbmZpZywgcnVsZSwgbmFtZTEpOwogICAgICAgICAg\nICBkZWxpbWl0ID0gdHJ1ZTsKICAgICAgICB9CiAgICAgICAgaWYgKGlzRGVs\naW1pdGVkKHJ1bGUsIG5hbWUyKSkgewogICAgICAgICAgICBuYW1lMiA9IHJl\nbW92ZURlbGltaXRlcnMoY29uZmlnLCBydWxlLCBuYW1lMik7CiAgICAgICAg\nICAgIGRlbGltaXQgPSB0cnVlOwogICAgICAgIH0KICAgICAgICBTdHJpbmcg\nbmFtZSA9IG5hbWUxICsgY29uZmlnLmdldElkZW50aWZpZXJDb25jYXRlbmF0\nb3IoKSArIG5hbWUyOwogICAgICAgIHJldHVybiBkZWxpbWl0KGNvbmZpZywg\ncnVsZSwgbmFtZSwgZGVsaW1pdCkudG9TdHJpbmcoKTsKICAgIH0KCiAgICBw\ndWJsaWMgU3RyaW5nIGNvbWJpbmVOYW1lcyhJZGVudGlmaWVyQ29uZmlndXJh\ndGlvbiBjb25maWcsIElkZW50aWZpZXJSdWxlIG5hbWluZ1J1bGUsIFN0cmlu\nZ1tdIG5hbWVzKSB7CiAgICAgICAgYm9vbGVhbiBkZWxpbWl0ZWQgPSBmYWxz\nZTsKICAgICAgICBTdHJpbmcgY29tYmluZWQgPSBudWxsOwogICAgICAgIGZv\nciAoaW50IGkgPSAwOyBpIDwgbmFtZXMubGVuZ3RoOyBpKyspIHsKICAgICAg\nICAgICAgU3RyaW5nIG5hbWUgPSBuYW1lc1tpXTsKICAgICAgICAgICAgaWYg\nKGlzRGVsaW1pdGVkKGNvbmZpZywgbmFtaW5nUnVsZSwgbmFtZSkpIHsKICAg\nICAgICAgICAgICAgIGRlbGltaXRlZCA9IHRydWU7CiAgICAgICAgICAgICAg\nICBuYW1lID0gcmVtb3ZlRGVsaW1pdGVycyhjb25maWcsIG5hbWluZ1J1bGUs\nIG5hbWUpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmIChpID09IDAp\nIHsKICAgICAgICAgICAgICAgIGNvbWJpbmVkID0gbmFtZTsKICAgICAgICAg\nICAgfQogICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgIGNvbWJp\nbmVkID0gY29tYmluZWQgKyBjb25maWcuZ2V0SWRlbnRpZmllckNvbmNhdGVu\nYXRvcigpICsgbmFtZTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAg\nICBpZiAoZGVsaW1pdGVkKSB7CiAgICAgICAgICAgIGNvbWJpbmVkID0gZGVs\naW1pdChjb25maWcsIG5hbWluZ1J1bGUsIGNvbWJpbmVkLnRvU3RyaW5nKCkp\nLnRvU3RyaW5nKCk7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIHJldHVy\nbiBjb21iaW5lZDsKICAgIH0KCiAgICBwdWJsaWMgU3RyaW5nIGFwcGVuZE5h\nbWVzKElkZW50aWZpZXJSdWxlIHJ1bGUsIFN0cmluZyBuYW1lMSwgU3RyaW5n\nIG5hbWUyKSB7CiAgICAgICAgaWYgKGlzRGVsaW1pdGVkKHJ1bGUsIG5hbWUx\nKSkgewogICAgICAgICAgICBuYW1lMSA9IHJlbW92ZURlbGltaXRlcnMocnVs\nZSwgbmFtZTEpOwogICAgICAgIH0KICAgICAgICBpZiAoaXNEZWxpbWl0ZWQo\ncnVsZSwgbmFtZTIpKSB7CiAgICAgICAgICAgIG5hbWUyID0gcmVtb3ZlRGVs\naW1pdGVycyhydWxlLCBuYW1lMik7CiAgICAgICAgfQogICAgICAgIGlmIChu\nYW1lMSA9PSBudWxsKSB7CiAgICAgICAgICAgIG5hbWUxID0gSWRlbnRpZmll\nclV0aWwuRU1QVFk7CiAgICAgICAgfQogICAgICAgIGlmIChuYW1lMiA9PSBu\ndWxsKSB7CiAgICAgICAgICAgIG5hbWUyID0gSWRlbnRpZmllclV0aWwuRU1Q\nVFk7CiAgICAgICAgfQogICAgICAgIFN0cmluZyBuYW1lID0gbmFtZTEgKyBu\nYW1lMjsKICAgICAgICByZXR1cm4gZGVsaW1pdChydWxlLCBuYW1lKS50b1N0\ncmluZygpOwogICAgfQoKICAgIC8qKgogICAgICogSm9pbnMgbXVsdGlwbGUg\nbmFtZXMgdG9nZXRoZXIgdXNpbmcgdGhlIHN0YW5kYXJkIGRlbGltaXRpbmcg\ncnVsZXMKICAgICAqIGV4LiAoIHsicyIsICJ0IiwgImMifSAtLT4gInMiLiJ0\nIi4iYyIgfQogICAgICovCiAgICBwdWJsaWMgU3RyaW5nIGpvaW5OYW1lcyhJ\nZGVudGlmaWVyUnVsZVtdIHJ1bGVzLCBTdHJpbmdbXSBuYW1lcykgewogICAg\nICAgIAogICAgICAgIGlmIChuYW1lcyA9PSBudWxsIHx8IG5hbWVzLmxlbmd0\naCA9PSAwKSB7CiAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgIH0K\nICAgICAgICBTdHJpbmdCdWlsZGVyIGNvbWJpbmVkTmFtZSA9IG5ldyBTdHJp\nbmdCdWlsZGVyKCk7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBuYW1l\ncy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBjb21iaW5lZE5hbWUuYXBw\nZW5kKGRlbGltaXQocnVsZXNbaV0sIG5hbWVzW2ldKSk7CiAgICAgICAgICAg\nIGlmIChpIDwgKG5hbWVzLmxlbmd0aCAtMSkpIHsKICAgICAgICAgICAgICAg\nIGNvbWJpbmVkTmFtZS5hcHBlbmQoX2NvbmZpZy5nZXRJZGVudGlmaWVyRGVs\naW1pdGVyKCkpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJl\ndHVybiBjb21iaW5lZE5hbWUudG9TdHJpbmcoKTsKICAgIH0KCiAgICBwdWJs\naWMgU3RyaW5nIGpvaW5OYW1lcyhTdHJpbmcgcnVsZSwgU3RyaW5nW10gbmFt\nZXMpIHsKICAgICAgICByZXR1cm4gam9pbk5hbWVzKF9jb25maWcsIGdldE5h\nbWluZ1J1bGUocnVsZSksIG5hbWVzLCBfY29uZmlnLmdldElkZW50aWZpZXJE\nZWxpbWl0ZXIoKSk7CiAgICB9CgogICAgcHVibGljIFN0cmluZyBqb2luTmFt\nZXMoSWRlbnRpZmllclJ1bGUgcnVsZSwgU3RyaW5nW10gbmFtZXMpIHsKICAg\nICAgICByZXR1cm4gam9pbk5hbWVzKF9jb25maWcsIHJ1bGUsIG5hbWVzLCBf\nY29uZmlnLmdldElkZW50aWZpZXJEZWxpbWl0ZXIoKSk7CiAgICB9CgogICAg\ncHVibGljIFN0cmluZyBqb2luTmFtZXMoSWRlbnRpZmllclJ1bGUgcnVsZSwg\nU3RyaW5nW10gbmFtZXMsIFN0cmluZyBkZWxpbWl0ZXIpIHsKICAgICAgICBy\nZXR1cm4gam9pbk5hbWVzKF9jb25maWcsIHJ1bGUsIG5hbWVzLCBkZWxpbWl0\nZXIpOwogICAgfQoKICAgIHB1YmxpYyBTdHJpbmcgam9pbk5hbWVzKFN0cmlu\nZyBydWxlLCBTdHJpbmdbXSBuYW1lcywgU3RyaW5nIGRlbGltaXRlcikgewog\nICAgICAgIHJldHVybiBqb2luTmFtZXMoX2NvbmZpZywgZ2V0TmFtaW5nUnVs\nZShydWxlKSwgbmFtZXMsIGRlbGltaXRlcik7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBKb2luIG5hbWVzIHVzaW5nIGEgc2luZ2xlIG5hbWluZyBydWxlIGFu\nZCBzcGVjaWZpZWQgZGVsaW1pdGVyCiAgICAgKiBAcGFyYW0gcnVsZQogICAg\nICogQHBhcmFtIG5hbWVzCiAgICAgKiBAcmV0dXJuCiAgICAgKi8KICAgIHB1\nYmxpYyBTdHJpbmcgam9pbk5hbWVzKElkZW50aWZpZXJDb25maWd1cmF0aW9u\nIGNvbmZpZywgSWRlbnRpZmllclJ1bGUgcnVsZSwgU3RyaW5nW10gbmFtZXMs\nIFN0cmluZyBkZWxpbWl0ZXIpIHsKICAgICAgICAKICAgICAgICBpZiAobmFt\nZXMgPT0gbnVsbCB8fCBuYW1lcy5sZW5ndGggPT0gMCkgewogICAgICAgICAg\nICByZXR1cm4gbnVsbDsKICAgICAgICB9CiAgICAgICAgU3RyaW5nQnVpbGRl\nciBjb21iaW5lZE5hbWUgPSBuZXcgU3RyaW5nQnVpbGRlcigpOwogICAgICAg\nIGZvciAoaW50IGkgPSAwOyBpIDwgbmFtZXMubGVuZ3RoOyBpKyspIHsKICAg\nICAgICAgICAgaWYgKG5hbWVzW2ldICE9IG51bGwpIHsKICAgICAgICAgICAg\nICAgIGNvbWJpbmVkTmFtZS5hcHBlbmQoZGVsaW1pdChjb25maWcsIHJ1bGUs\nIG5hbWVzW2ldLCBmYWxzZSkpOwogICAgICAgICAgICAgICAgaWYgKGkgPCAo\nbmFtZXMubGVuZ3RoIC0xKSkgewogICAgICAgICAgICAgICAgICAgIGNvbWJp\nbmVkTmFtZS5hcHBlbmQoZGVsaW1pdGVyKTsKICAgICAgICAgICAgICAgIH0K\nICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4gY29tYmlu\nZWROYW1lLnRvU3RyaW5nKCk7CiAgICB9CgogICAgcHVibGljIFN0cmluZ1td\nIHNwbGl0TmFtZShJZGVudGlmaWVyQ29uZmlndXJhdGlvbiBjb25maWcsIElk\nZW50aWZpZXJSdWxlIG5ydWxlLCBTdHJpbmcgbmFtZSkgewogICAgICAgIHJl\ndHVybiBzcGxpdE5hbWUobnJ1bGUsIG5hbWUsIGNvbmZpZy5nZXRJZGVudGlm\naWVyRGVsaW1pdGVyKCkpOwogICAgfQoKICAgIHB1YmxpYyBTdHJpbmdbXSBz\ncGxpdE5hbWUoSWRlbnRpZmllclJ1bGUgbnJ1bGUsIFN0cmluZyBuYW1lKSB7\nCiAgICAgICAgcmV0dXJuIHNwbGl0TmFtZShucnVsZSwgbmFtZSwgX2NvbmZp\nZy5nZXRJZGVudGlmaWVyRGVsaW1pdGVyKCkpOwogICAgfQoKICAgIAogICAg\nLyoqCiAgICAgKiBTcGxpdHMgbmFtZXMgdXNpbmcgc2luZ2xlIG5hbWluZyBy\ndWxlIGFuZCBhcHByb3ByaWF0ZSBzZXBhcmF0b3JzCiAgICAgKiBAcGFyYW0g\nbmFtZSAgdGhlIG11bHRpLXZhbHVlIG5hbWUKICAgICAqIEByZXR1cm4gaW5k\naXZpZHVhbCBjb21wb25lbnRzIG9mIHRoZSBuYW1lCiAgICAgKiAgICAgICAg\nIGV4LiBzY2hlbWEudGFibGUgLS0+IHsgc2NoZW1hLCB0YWJsZSB9CiAgICAg\nKi8gICAgCiAgICBwdWJsaWMgU3RyaW5nW10gc3BsaXROYW1lKElkZW50aWZp\nZXJSdWxlIG5ydWxlLCBTdHJpbmcgbmFtZSwgU3RyaW5nIG5hbWVEZWxpbSkg\newogICAgICAgIGlmICghY2FuU3BsaXQobnJ1bGUsIG5hbWUsIG5hbWVEZWxp\nbSkgfHwgU3RyaW5nVXRpbHMuaXNFbXB0eShuYW1lKSkgewogICAgICAgICAg\nICByZXR1cm4gbmV3IFN0cmluZ1tdIHtuYW1lfTsKICAgICAgICB9CiAgICAg\nICAgLy8gInNjaGVtYSIuInRhYmxlIgogICAgICAgIC8vICJzY2gubWEiLiJ0\nYWJsZSIKICAgICAgICAvLyAic2NoIiJtYSIudGFibGUKICAgICAgICAKICAg\nICAgICAvLyBTcGxpdCBuYW1lcyBieSBvYmplY3QgZGVsaW1pdGVyIG5vdCBi\nZXR3ZWVuIG5hbWUgZGVsaW1pdGVycwogICAgICAgIEFycmF5TGlzdDxTdHJp\nbmc+IG5hbWVzID0gbmV3IEFycmF5TGlzdDxTdHJpbmc+KDIpOwogICAgICAg\nIFN0cmluZyBwbmFtZSA9IG5hbWU7CgogICAgICAgIC8vIGZvciBlYWNoIG5h\nbWUKICAgICAgICBpbnQgbmRMZW4gPSBuYW1lRGVsaW0ubGVuZ3RoKCk7CiAg\nICAgICAgd2hpbGUgKCFTdHJpbmdVdGlscy5pc0VtcHR5KG5hbWUpKSB7CiAg\nICAgICAgICAgIHBuYW1lID0gc3BsaXROYW1lQ2hhckRlbGltaXRlcnMobmFt\nZSwgbmFtZURlbGltKTsKICAgICAgICAgICAgbmFtZXMuYWRkKHBuYW1lKTsK\nICAgICAgICAgICAgaWYgKChwbmFtZS5sZW5ndGgoKSArIG5kTGVuKSA+PSBu\nYW1lLmxlbmd0aCgpKSB7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAg\nICAgICAgfQogICAgICAgICAgICBuYW1lID0gbmFtZS5zdWJzdHJpbmcocG5h\nbWUubGVuZ3RoKCkgKyBuZExlbik7IAogICAgICAgIH0KICAgICAgICByZXR1\ncm4gbmFtZXMudG9BcnJheShuZXcgU3RyaW5nW25hbWVzLnNpemUoKV0pOwog\nICAgfQoKICAgIC8qKgogICAgICogR2V0cyB0aGUgZmlyc3QgcGFydCBvZiBh\nIG5hbWUgd2hlbiBzaW5nbGUgY2hhcmFjdGVyIGRlbGltaXRlcnMgYXJlCiAg\nICAgKiBpbiB1c2UuCiAgICAgKiBAcGFyYW0gcG5hbWUKICAgICAqIEByZXR1\ncm4KICAgICAqLwogICAgcHJpdmF0ZSBTdHJpbmcgc3BsaXROYW1lQ2hhckRl\nbGltaXRlcnMoU3RyaW5nIG5hbWUsIFN0cmluZyBuYW1lRGVsaW0pIHsKICAg\nICAgICBTdHJpbmdCdWlsZGVyIHNuYW1lID0gbmV3IFN0cmluZ0J1aWxkZXIo\nIiIpOwogICAgICAgIGNoYXIgbGQgPSBfY29uZmlnLmdldExlYWRpbmdEZWxp\nbWl0ZXIoKS5jaGFyQXQoMCk7CiAgICAgICAgY2hhciB0ZCA9IF9jb25maWcu\nZ2V0VHJhaWxpbmdEZWxpbWl0ZXIoKS5jaGFyQXQoMCk7CiAgICAgICAgY2hh\nciBuZCA9IG5hbWVEZWxpbS5jaGFyQXQoMCk7CiAgICAgICAgaW50IGRsdmwg\nPSAwOwogICAgICAgIGJvb2xlYW4gd2FzTGQgPSBmYWxzZTsKICAgICAgICBm\nb3IgKGludCBpID0gMDsgaSA8IG5hbWUubGVuZ3RoKCk7IGkrKykgewogICAg\nICAgICAgICBjaGFyIGMgPSBuYW1lLmNoYXJBdChpKTsKICAgICAgICAgICAg\naWYgKGMgPT0gbGQpIHsKICAgICAgICAgICAgICAgIC8vIEhhbmRsZSBjYXNl\nIHdoZXJlIGRlbGltaXRlcnMgYXJlIHRoZSBzYW1lCiAgICAgICAgICAgICAg\nICBpZiAodGQgPT0gbGQgJiYgd2FzTGQpIHsKICAgICAgICAgICAgICAgICAg\nICBkbHZsLS07CiAgICAgICAgICAgICAgICAgICAgd2FzTGQgPSBmYWxzZTsK\nICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAg\nd2FzTGQgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgIGRsdmwrKzsKICAg\nICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBlbHNlIGlmIChjID09IHRk\nKSB7CiAgICAgICAgICAgICAgICBkbHZsLS07CiAgICAgICAgICAgIH0gZWxz\nZSBpZiAoYyA9PSBuZCkgewogICAgICAgICAgICAgICAgaWYgKGRsdmwgPT0g\nMCAgJiYgc25hbWUubGVuZ3RoKCkgPiAwKSB7CiAgICAgICAgICAgICAgICAg\nICAgcmV0dXJuIHNuYW1lLnRvU3RyaW5nKCk7CiAgICAgICAgICAgICAgICB9\nCiAgICAgICAgICAgIH0KICAgICAgICAgICAgc25hbWUuYXBwZW5kKGMpOwog\nICAgICAgIH0KICAgICAgICByZXR1cm4gc25hbWUudG9TdHJpbmcoKTsKICAg\nIH0KCiAgICAvKioKICAgICAqIFJldHVybnMgd2hldGhlciBhIG5hbWUgaXMg\nZG91YmxlIHF1b3RlZAogICAgICogQHJldHVybgogICAgICovCiAgICBwdWJs\naWMgc3RhdGljIGJvb2xlYW4gaXNEb3VibGVRdW90ZWQoU3RyaW5nIG5hbWUp\nIHsKICAgICAgICBpZiAobmFtZSA9PSBudWxsIHx8IG5hbWUubGVuZ3RoKCkg\nPCAzKSB7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CiAg\nICAgICAgcmV0dXJuIG5hbWUuc3RhcnRzV2l0aChET1VCTEVfUVVPVEUpICYm\nIAogICAgICAgICAgICAgICBuYW1lLmVuZHNXaXRoKERPVUJMRV9RVU9URSk7\nCiAgICB9CgogICAgcHVibGljIFN0cmluZyBkZWxpbWl0KElkZW50aWZpZXJD\nb25maWd1cmF0aW9uIGNvbmZpZywgSWRlbnRpZmllclJ1bGUgcnVsZSwgU3Ry\naW5nIG5hbWUpIHsKICAgICAgICByZXR1cm4gZGVsaW1pdChjb25maWcsIHJ1\nbGUsIG5hbWUsIGZhbHNlKTsKICAgIH0KCiAgICAKICAgIHB1YmxpYyBTdHJp\nbmcgZGVsaW1pdChJZGVudGlmaWVyUnVsZSBydWxlLCBTdHJpbmcgbmFtZSkg\newogICAgICAgIHJldHVybiBkZWxpbWl0KF9jb25maWcsIHJ1bGUsIG5hbWUs\nIGZhbHNlKTsKICAgIH0KCiAgICBwdWJsaWMgU3RyaW5nIGRlbGltaXQoSWRl\nbnRpZmllclJ1bGUgcnVsZSwgU3RyaW5nIG5hbWUsIGJvb2xlYW4gZm9yY2Up\nIHsKICAgICAgICByZXR1cm4gZGVsaW1pdChfY29uZmlnLCBydWxlLCBuYW1l\nLCBmb3JjZSk7CiAgICB9CiAgICAKICAgIHB1YmxpYyBTdHJpbmcgZGVsaW1p\ndChJZGVudGlmaWVyQ29uZmlndXJhdGlvbiBjb25maWcsIElkZW50aWZpZXJS\ndWxlIHJ1bGUsIFN0cmluZyBuYW1lLCBib29sZWFuIGZvcmNlKSB7CiAgICAg\nICAgaWYgKCFydWxlLmdldENhbkRlbGltaXQoKSB8fCBTdHJpbmdVdGlscy5p\nc0VtcHR5KG5hbWUpKSB7CiAgICAgICAgICAgIHJldHVybiBuYW1lOwogICAg\nICAgIH0KCiAgICAgICAgaWYgKChmb3JjZSAmJiAhaXNEZWxpbWl0ZWQoY29u\nZmlnLCBydWxlLCBuYW1lKSkgfHwgcmVxdWlyZXNEZWxpbWl0ZXJzKGNvbmZp\nZywgcnVsZSwgbmFtZSkpIHsKICAgICAgICAgICAgcmV0dXJuIGNvbmZpZy5n\nZXRMZWFkaW5nRGVsaW1pdGVyKCkgKyBuYW1lICsgY29uZmlnLmdldFRyYWls\naW5nRGVsaW1pdGVyKCk7CiAgICAgICAgfQogICAgICAgIHJldHVybiBuYW1l\nOwogICAgfQoKICAgIHB1YmxpYyBib29sZWFuIGlzRGVsaW1pdGVkKElkZW50\naWZpZXJSdWxlIHJ1bGUsIFN0cmluZyBuYW1lKSB7CiAgICAgICAgcmV0dXJu\nIGlzRGVsaW1pdGVkKF9jb25maWcsIHJ1bGUsIG5hbWUpOwogICAgfQoKICAg\nIHB1YmxpYyBib29sZWFuIGlzRGVsaW1pdGVkKElkZW50aWZpZXJDb25maWd1\ncmF0aW9uIGNvbmZpZywgSWRlbnRpZmllclJ1bGUgcnVsZSwgU3RyaW5nIG5h\nbWUpIHsKICAgICAgICBpZiAobmFtZSA9PSBudWxsIHx8IG5hbWUubGVuZ3Ro\nKCkgPD0gMykgewogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAg\nfQogICAgICAgIHJldHVybiBuYW1lLnN0YXJ0c1dpdGgoY29uZmlnLmdldExl\nYWRpbmdEZWxpbWl0ZXIoKSkgJiYKICAgICAgICAgICAgbmFtZS5lbmRzV2l0\naChjb25maWcuZ2V0VHJhaWxpbmdEZWxpbWl0ZXIoKSk7CiAgICB9CgogICAg\ncHVibGljIFN0cmluZyByZW1vdmVEZWxpbWl0ZXJzKElkZW50aWZpZXJDb25m\naWd1cmF0aW9uIGNvbmZpZywgU3RyaW5nIHJ1bGUsCiAgICAgICAgU3RyaW5n\nIG5hbWUpIHsKICAgICAgICByZXR1cm4gcmVtb3ZlRGVsaW1pdGVycyhfY29u\nZmlnLCBnZXROYW1pbmdSdWxlKHJ1bGUpLCBuYW1lLCBfY29uZmlnLmdldExl\nYWRpbmdEZWxpbWl0ZXIoKSwKICAgICAgICAgICAgX2NvbmZpZy5nZXRUcmFp\nbGluZ0RlbGltaXRlcigpKTsKICAgIH0KCiAgICBwdWJsaWMgU3RyaW5nIHJl\nbW92ZURlbGltaXRlcnMoSWRlbnRpZmllclJ1bGUgcnVsZSwgU3RyaW5nIG5h\nbWUpIHsKICAgICAgICByZXR1cm4gcmVtb3ZlRGVsaW1pdGVycyhfY29uZmln\nLCBydWxlLCBuYW1lLCBfY29uZmlnLmdldExlYWRpbmdEZWxpbWl0ZXIoKSwK\nICAgICAgICAgICAgX2NvbmZpZy5nZXRUcmFpbGluZ0RlbGltaXRlcigpKTsK\nICAgIH0KCiAgICBwdWJsaWMgU3RyaW5nIHJlbW92ZURlbGltaXRlcnMoSWRl\nbnRpZmllckNvbmZpZ3VyYXRpb24gY29uZmlnLCBJZGVudGlmaWVyUnVsZSBy\ndWxlLCBTdHJpbmcgbmFtZSkgewogICAgICAgIHJldHVybiByZW1vdmVEZWxp\nbWl0ZXJzKGNvbmZpZywgcnVsZSwgbmFtZSwgX2NvbmZpZy5nZXRMZWFkaW5n\nRGVsaW1pdGVyKCksCiAgICAgICAgICAgIF9jb25maWcuZ2V0VHJhaWxpbmdE\nZWxpbWl0ZXIoKSk7CiAgICB9CgogICAgcHVibGljIGJvb2xlYW4gcmVxdWly\nZXNEZWxpbWl0ZXJzKElkZW50aWZpZXJSdWxlIHJ1bGUsIFN0cmluZyBuYW1l\nKSB7CiAgICAgICAgcmV0dXJuIHJlcXVpcmVzRGVsaW1pdGVycyhfY29uZmln\nLCBydWxlLCBuYW1lKTsKICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiByZXF1\naXJlc0RlbGltaXRlcnMoSWRlbnRpZmllckNvbmZpZ3VyYXRpb24gY29uZmln\nLCBJZGVudGlmaWVyUnVsZSBydWxlLCBTdHJpbmcgbmFtZSkgewogICAgICAg\nIGlmIChydWxlID09IG51bGwpIHsKICAgICAgICAgICAgdGhyb3cgbmV3IEls\nbGVnYWxBcmd1bWVudEV4Y2VwdGlvbihfbG9jLmdldCgibm8tcnVsZXMtcHJv\ndmlkZWQiKS5nZXRNZXNzYWdlKCkpOwogICAgICAgIH0KICAgICAgICBpZiAo\ncnVsZS5nZXRDYW5EZWxpbWl0KCkgJiYgIWlzRGVsaW1pdGVkKGNvbmZpZywg\ncnVsZSwgbmFtZSkgJiYgcnVsZS5yZXF1aXJlc0RlbGltaXRlcnMobmFtZSkp\nIHsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQogICAgICAg\nIHJldHVybiBmYWxzZTsKICAgIH0KICAgIAogICAgLyoqCiAgICAgKiBSZXR1\ncm5zIHdoZXRoZXIgYSBuYW1lIGlzIGNvbnNpZGVyZWQgYSByZXNlcnZlZCB3\nb3JkLgogICAgICovCiAgICBwdWJsaWMgYm9vbGVhbiBpc1Jlc2VydmVkV29y\nZChJZGVudGlmaWVyUnVsZSBydWxlLCBTdHJpbmcgbmFtZSkgewogICAgICAg\nIGlmIChydWxlID09IG51bGwpIHsKICAgICAgICAgICAgU3lzdGVtLm91dC5w\ncmludGxuKCJOQW1pbmdDb25maWc6ICIgKyBfY29uZmlnLmdldENsYXNzKCku\nZ2V0TmFtZSgpKTsKICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1\nbWVudEV4Y2VwdGlvbigiTmFtaW5nIHJ1bGUgaXMgbnVsbCEiKTsKICAgICAg\nICB9CiAgICAgICAgaWYgKHJ1bGUuZ2V0UmVzZXJ2ZWRXb3JkcygpID09IG51\nbGwpIHsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAg\nICAgICBpZiAoIWlzRGVsaW1pdGVkKHJ1bGUsIG5hbWUpKSB7CiAgICAgICAg\nICAgIG5hbWUgPSBuYW1lLnRvVXBwZXJDYXNlKCk7CiAgICAgICAgfQogICAg\nICAgIHJldHVybiBydWxlLmdldFJlc2VydmVkV29yZHMoKS5jb250YWlucyhu\nYW1lKTsKICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBpc1Jlc2VydmVkV29y\nZChTdHJpbmcgcnVsZSwgU3RyaW5nIG5hbWUpIHsKICAgICAgICByZXR1cm4g\naXNSZXNlcnZlZFdvcmQoX2NvbmZpZy5nZXRJZGVudGlmaWVyUnVsZShydWxl\nKSwgbmFtZSk7CiAgICB9CiAgICAKCiAgICBwcm90ZWN0ZWQgU3RyaW5nIHJl\nbW92ZURlbGltaXRlcnMoSWRlbnRpZmllckNvbmZpZ3VyYXRpb24gY29uZmln\nLCBJZGVudGlmaWVyUnVsZSBydWxlLCBTdHJpbmcgbmFtZSwgU3RyaW5nIGxl\nYWRpbmcsCiAgICAgICAgU3RyaW5nIHRyYWlsaW5nKSB7CiAgICAgICAgaWYg\nKG5hbWUgPT0gbnVsbCkgewogICAgICAgICAgICByZXR1cm4gbnVsbDsKICAg\nICAgICB9CiAgICAgICAgaWYgKGlzRGVsaW1pdGVkKGNvbmZpZywgcnVsZSwg\nbmFtZSkpIHsKICAgICAgICAgICAgU3RyaW5nIGlkID0gbmFtZS5zdWJzdHJp\nbmcobGVhZGluZy5sZW5ndGgoKSwKICAgICAgICAgICAgICAgIChuYW1lLmxl\nbmd0aCgpIC0gdHJhaWxpbmcubGVuZ3RoKCkpKTsKICAgICAgICAgICAgcmV0\ndXJuIGlkOwogICAgICAgIH0KICAgICAgICByZXR1cm4gbmFtZTsKICAgIH0K\nICAgIAogICAgcHVibGljIFN0cmluZyBjb21iaW5lTmFtZXMoU3RyaW5nIHJ1\nbGUsIFN0cmluZ1tdIHJ1bGVzLCBTdHJpbmdbXSBuYW1lcykgewogICAgICAg\nIHJldHVybiBjb21iaW5lTmFtZXMoZ2V0TmFtaW5nUnVsZShydWxlKSwgZ2V0\nTmFtaW5nUnVsZXMocnVsZXMpLCBuYW1lcyk7CiAgICB9CgogICAgcHVibGlj\nIFN0cmluZyB0cnVuY2F0ZU5hbWUoU3RyaW5nIHJ1bGUsIFN0cmluZyBuYW1l\nLCBpbnQgbGVuZ3RoKSB7CiAgICAgICAgcmV0dXJuIHRydW5jYXRlTmFtZShn\nZXROYW1pbmdSdWxlKHJ1bGUpLCBuYW1lLCBsZW5ndGgpOwogICAgfQoKICAg\nIHB1YmxpYyBTdHJpbmcgdHJ1bmNhdGVOYW1lKElkZW50aWZpZXJSdWxlIG5h\nbWluZ1J1bGUsIFN0cmluZyBuYW1lLCBpbnQgbGVuZ3RoKSB7CiAgICAgICAg\nU3RyaW5nIHROYW1lID0gbmFtZTsKICAgICAgICBib29sZWFuIGRlbGltaXRl\nZCA9IGlzRGVsaW1pdGVkKG5hbWluZ1J1bGUsIG5hbWUpOwogICAgICAgIGlm\nIChkZWxpbWl0ZWQpIHsKICAgICAgICAgICAgdE5hbWUgPSByZW1vdmVEZWxp\nbWl0ZXJzKG5hbWluZ1J1bGUsIG5hbWUpOwogICAgICAgIH0KICAgICAgICBp\nZiAodE5hbWUubGVuZ3RoKCkgPD0gbGVuZ3RoKSB7CiAgICAgICAgICAgIHJl\ndHVybiBuYW1lOwogICAgICAgIH0KICAgICAgICB0TmFtZSA9IHROYW1lLnN1\nYnN0cmluZygwLCB0TmFtZS5sZW5ndGgoKSAtIGxlbmd0aCk7CiAgICAgICAg\naWYgKGRlbGltaXRlZCkgewogICAgICAgICAgICB0TmFtZSA9IGRlbGltaXQo\nbmFtaW5nUnVsZSwgdE5hbWUpLnRvU3RyaW5nKCk7CiAgICAgICAgfQogICAg\nICAgIHJldHVybiB0TmFtZTsKICAgIH0KCiAgICBwdWJsaWMgU3RyaW5nIGRl\nbGltaXQoU3RyaW5nIHJ1bGUsIFN0cmluZyBuYW1lKSB7CiAgICAgICAgcmV0\ndXJuIGRlbGltaXQoZ2V0TmFtaW5nUnVsZShydWxlKSwgbmFtZSk7CiAgICB9\nCgogICAgcHVibGljIFN0cmluZyBkZWxpbWl0KFN0cmluZyBydWxlLCBTdHJp\nbmcgbmFtZSwgYm9vbGVhbiBmb3JjZSkgewogICAgICAgIHJldHVybiBkZWxp\nbWl0KGdldE5hbWluZ1J1bGUocnVsZSksIG5hbWUsIGZvcmNlKTsKICAgIH0K\nCiAgICBwdWJsaWMgYm9vbGVhbiBpc0RlbGltaXRlZChTdHJpbmcgcnVsZSwg\nU3RyaW5nIG5hbWUpIHsKICAgICAgICByZXR1cm4gaXNEZWxpbWl0ZWQoZ2V0\nTmFtaW5nUnVsZShydWxlKSwgbmFtZSk7CiAgICB9CgogICAgcHVibGljIFN0\ncmluZyByZW1vdmVEZWxpbWl0ZXJzKFN0cmluZyBydWxlLCBTdHJpbmcgbmFt\nZSkgewogICAgICAgIHJldHVybiByZW1vdmVEZWxpbWl0ZXJzKGdldE5hbWlu\nZ1J1bGUocnVsZSksIG5hbWUpOwogICAgfQoKICAgIHB1YmxpYyBib29sZWFu\nIHJlcXVpcmVzRGVsaW1pdGVycyhTdHJpbmcgcnVsZSwgU3RyaW5nIG5hbWUp\nIHsKICAgICAgICByZXR1cm4gcmVxdWlyZXNEZWxpbWl0ZXJzKGdldE5hbWlu\nZ1J1bGUocnVsZSksIG5hbWUpOwogICAgfQoKICAgIHB1YmxpYyBTdHJpbmdb\nXSBzcGxpdE5hbWUoSWRlbnRpZmllckNvbmZpZ3VyYXRpb24gY29uZmlnLCBT\ndHJpbmcgcnVsZSwgU3RyaW5nIG5hbWUpIHsKICAgICAgICByZXR1cm4gc3Bs\naXROYW1lKGNvbmZpZywgZ2V0TmFtaW5nUnVsZShydWxlKSwgbmFtZSk7CiAg\nICB9CgogICAgcHVibGljIFN0cmluZ1tdIHNwbGl0TmFtZShTdHJpbmcgcnVs\nZSwgU3RyaW5nIG5hbWUpIHsKICAgICAgICByZXR1cm4gc3BsaXROYW1lKF9j\nb25maWcsIGdldE5hbWluZ1J1bGUocnVsZSksIG5hbWUpOwogICAgfQoKICAg\nIHB1YmxpYyBTdHJpbmcgam9pbk5hbWVzKFN0cmluZ1tdIHJ1bGVzLCBTdHJp\nbmdbXSBuYW1lcykgewogICAgICAgIHJldHVybiBqb2luTmFtZXMoZ2V0TmFt\naW5nUnVsZXMocnVsZXMpLCBuYW1lcyk7CiAgICB9CiAgICAKICAgIHByaXZh\ndGUgSWRlbnRpZmllclJ1bGUgZ2V0TmFtaW5nUnVsZShTdHJpbmcgcnVsZSkg\newogICAgICAgIHJldHVybiBfY29uZmlnLmdldElkZW50aWZpZXJSdWxlKHJ1\nbGUpOwogICAgfQogICAgCiAgICBwdWJsaWMgU3RyaW5nIGFwcGVuZE5hbWVz\nKFN0cmluZyBydWxlLCBTdHJpbmcgbmFtZTEsIFN0cmluZyBuYW1lMikgewog\nICAgICAgIHJldHVybiBhcHBlbmROYW1lcyhnZXROYW1pbmdSdWxlKHJ1bGUp\nLCBuYW1lMSwgbmFtZTIpOwogICAgfQoKICAgIHB1YmxpYyBTdHJpbmcgcmVt\nb3ZlSHVuZ2FyaWFuTm90YXRpb24oSWRlbnRpZmllclJ1bGUgcnVsZSwgU3Ry\naW5nIG5hbWUpIHsKICAgICAgICBib29sZWFuIGRlbGltaXRlZCA9IGlzRGVs\naW1pdGVkKHJ1bGUsIG5hbWUpOwogICAgICAgIGlmIChkZWxpbWl0ZWQpIHsK\nICAgICAgICAgICAgbmFtZSA9IHJlbW92ZURlbGltaXRlcnMocnVsZSwgbmFt\nZSk7CiAgICAgICAgfQogICAgICAgIGNoYXJbXSBjaG5hbWUgPSBuYW1lLnRv\nQ2hhckFycmF5KCk7CiAgICAgICAgaW50IG5ld1N0YXJ0ID0gMDsKCiAgICAg\nICAgZm9yIChpbnQgaSA9IDA7IGkgPCBjaG5hbWUubGVuZ3RoOyBpKyspIHsK\nICAgICAgICAgICAgaWYgKENoYXJhY3Rlci5pc1VwcGVyQ2FzZShjaG5hbWVb\naV0pKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBuZXdTdGFydCA9\nIGk7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAg\nICAgIH0KCiAgICAgICAgbmFtZSA9IG5hbWUuc3Vic3RyaW5nKG5ld1N0YXJ0\nKTsKICAgICAgICBpZiAoZGVsaW1pdGVkKSB7CiAgICAgICAgICAgIG5hbWUg\nPSBkZWxpbWl0KHJ1bGUsIG5hbWUpLnRvU3RyaW5nKCk7CiAgICAgICAgfQog\nICAgICAgIHJldHVybiBuYW1lOwogICAgfQoKICAgIHB1YmxpYyBTdHJpbmcg\ncmVtb3ZlSHVuZ2FyaWFuTm90YXRpb24oU3RyaW5nIHJ1bGUsIFN0cmluZyBu\nYW1lKSB7CiAgICAgICAgcmV0dXJuIHJlbW92ZUh1bmdhcmlhbk5vdGF0aW9u\nKGdldE5hbWluZ1J1bGUocnVsZSksIG5hbWUpOwogICAgfQogICAgCiAgICBw\ndWJsaWMgU3RyaW5nW10gc3BsaXROYW1lKFN0cmluZyBucnVsZSwgU3RyaW5n\nIG5hbWUsIFN0cmluZyBuYW1lRGVsaW0pIHsKICAgICAgICByZXR1cm4gc3Bs\naXROYW1lKGdldE5hbWluZ1J1bGUobnJ1bGUpLCBuYW1lLCBuYW1lRGVsaW0p\nOwogICAgfQoKICAgIHB1YmxpYyBTdHJpbmcgY29udmVydChJZGVudGlmaWVy\nQ29uZmlndXJhdGlvbiBjb25maWcsIFN0cmluZyBydWxlLCBTdHJpbmcgbmFt\nZSkgewogICAgICAgIC8vIEFscmVhZHkgdXNpbmcgc2FtZSBkZWxpbWl0ZXIs\nIG5vIG5lZWQgdG8gY29udmVydAogICAgICAgIGlmICghbmVlZHNDb252ZXJz\naW9uKGNvbmZpZykpIHsKICAgICAgICAgICAgcmV0dXJuIG5hbWU7CiAgICAg\nICAgfQogICAgICAgIC8vIE90aGVyd2lzZSwgcmVtb3ZlIGRlbGltaXRlcnMg\nYW5kIGFkZCBhcHByb3ByaWF0ZSBkZWxpbWl0ZXJzCiAgICAgICAgSWRlbnRp\nZmllclJ1bGUgb3J1bGUgPSBnZXRJZGVudGlmaWVyQ29uZmlndXJhdGlvbigp\nLmdldElkZW50aWZpZXJSdWxlKHJ1bGUpOwogICAgICAgIElkZW50aWZpZXJS\ndWxlIG5ydWxlID0gY29uZmlnLmdldElkZW50aWZpZXJSdWxlKHJ1bGUpOwog\nICAgICAgIGJvb2xlYW4gZGVsaW1pdCA9IGlzRGVsaW1pdGVkKGNvbmZpZywg\nb3J1bGUsIG5hbWUpOwogICAgICAgIGlmIChkZWxpbWl0KSB7CiAgICAgICAg\nICAgIG5hbWUgPSByZW1vdmVEZWxpbWl0ZXJzKGNvbmZpZywgb3J1bGUsIG5h\nbWUsIGNvbmZpZy5nZXRMZWFkaW5nRGVsaW1pdGVyKCksIAogICAgICAgICAg\nICAgICAgY29uZmlnLmdldFRyYWlsaW5nRGVsaW1pdGVyKCkpOwogICAgICAg\nICAgICByZXR1cm4gZGVsaW1pdChnZXRJZGVudGlmaWVyQ29uZmlndXJhdGlv\nbigpLCBucnVsZSwgbmFtZSwgZGVsaW1pdCkudG9TdHJpbmcoKTsKICAgICAg\nICB9CiAgICAgICAgcmV0dXJuIG5hbWU7CiAgICB9CgogICAgcHVibGljIFN0\ncmluZyBjb252ZXJ0RnVsbChJZGVudGlmaWVyQ29uZmlndXJhdGlvbiBjb25m\naWcsIFN0cmluZyBydWxlLCBTdHJpbmcgZnVsbE5hbWUpIHsKICAgICAgICBp\nZiAoIW5lZWRzQ29udmVyc2lvbihjb25maWcpKSB7CiAgICAgICAgICAgIHJl\ndHVybiBmdWxsTmFtZTsKICAgICAgICB9CiAgICAgICAgLy8gU3BsaXQKICAg\nICAgICBTdHJpbmdbXSBuYW1lcyA9IHNwbGl0TmFtZShjb25maWcsIHJ1bGUs\nIGZ1bGxOYW1lKTsKICAgICAgICAvLyBDb252ZXJ0CiAgICAgICAgZm9yIChp\nbnQgaSA9IDA7IGkgPCBuYW1lcy5sZW5ndGg7IGkrKykgewogICAgICAgICAg\nICBuYW1lc1tpXSA9IGNvbnZlcnQoY29uZmlnLCBydWxlLCBuYW1lc1tpXSk7\nCiAgICAgICAgfQogICAgICAgIC8vIElmIGEgc2luZ2xlIHBhcnQgbmFtZSwg\ncmV0dXJuIGl0LgogICAgICAgIGlmIChuYW1lcy5sZW5ndGggPT0gMSkgewog\nICAgICAgICAgICByZXR1cm4gbmFtZXNbMF07CiAgICAgICAgfQogICAgICAg\nIC8vIEpvaW4gaWYgbXVsdGlwbGUgbmFtZXMKICAgICAgICByZXR1cm4gam9p\nbk5hbWVzKGdldElkZW50aWZpZXJDb25maWd1cmF0aW9uKCksIGNvbmZpZy5n\nZXRJZGVudGlmaWVyUnVsZShydWxlKSwgbmFtZXMsIAogICAgICAgICAgICBn\nZXRJZGVudGlmaWVyQ29uZmlndXJhdGlvbigpLmdldElkZW50aWZpZXJEZWxp\nbWl0ZXIoKSk7CiAgICB9ICAgIAoKICAgIHB1YmxpYyBTdHJpbmcgY29tYmlu\nZUZ1bGwoSWRlbnRpZmllckNvbmZpZ3VyYXRpb24gY29uZmlnLCBTdHJpbmcg\ncnVsZSwgU3RyaW5nIGZ1bGxOYW1lKSB7CiAgICAgICAgaWYgKCFuZWVkc0Nv\nbnZlcnNpb24oY29uZmlnKSkgewogICAgICAgICAgICByZXR1cm4gZnVsbE5h\nbWU7CiAgICAgICAgfQogICAgICAgIC8vIFNwbGl0CiAgICAgICAgU3RyaW5n\nW10gbmFtZXMgPSBzcGxpdE5hbWUoY29uZmlnLCBydWxlLCBmdWxsTmFtZSk7\nCiAgICAgICAgLy8gQ29udmVydAogICAgICAgIGZvciAoaW50IGkgPSAwOyBp\nIDwgbmFtZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgbmFtZXNbaV0g\nPSBjb252ZXJ0KGNvbmZpZywgcnVsZSwgbmFtZXNbaV0pOwogICAgICAgIH0K\nICAgICAgICAvLyBKb2luCiAgICAgICAgcmV0dXJuIGpvaW5OYW1lcyhjb25m\naWcsIGNvbmZpZy5nZXRJZGVudGlmaWVyUnVsZShydWxlKSwgbmFtZXMsIGNv\nbmZpZy5nZXRJZGVudGlmaWVyRGVsaW1pdGVyKCkpOwogICAgfSAgICAKCgog\nICAgcHJvdGVjdGVkIGJvb2xlYW4gbmVlZHNDb252ZXJzaW9uKElkZW50aWZp\nZXJDb25maWd1cmF0aW9uIGNvbmZpZykgewogICAgICAgIHJldHVybiAhKGNv\nbmZpZy5nZXRDb252ZXJzaW9uS2V5KCkuZXF1YWxzKGdldElkZW50aWZpZXJD\nb25maWd1cmF0aW9uKCkuZ2V0Q29udmVyc2lvbktleSgpKSk7CiAgICB9Cgog\nICAgcHJpdmF0ZSBJZGVudGlmaWVyUnVsZVtdIGdldE5hbWluZ1J1bGVzKFN0\ncmluZ1tdIHJ1bGVzKSB7CiAgICAgICAgSWRlbnRpZmllclJ1bGVbXSBucnVs\nZXMgPSBuZXcgSWRlbnRpZmllclJ1bGVbcnVsZXMubGVuZ3RoXTsKICAgICAg\nICBmb3IgKGludCBpID0gMDsgaSA8IHJ1bGVzLmxlbmd0aDsgaSsrKSB7CiAg\nICAgICAgICAgIG5ydWxlc1tpXSA9IF9jb25maWcuZ2V0SWRlbnRpZmllclJ1\nbGUocnVsZXNbaV0pOwogICAgICAgIH0KICAgICAgICByZXR1cm4gbnJ1bGVz\nOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIGVuZENvbmZpZ3VyYXRpb24oKSB7\nCiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0Q29uZmlndXJhdGlvbihDb25m\naWd1cmF0aW9uIGNvbmYpIHsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzdGFy\ndENvbmZpZ3VyYXRpb24oKSB7CiAgICB9CgogICAgcHVibGljIGJvb2xlYW4g\nY2FuU3BsaXQoU3RyaW5nIHJ1bGUsIFN0cmluZyBuYW1lKSB7CiAgICAgICAg\ncmV0dXJuIGNhblNwbGl0KGdldE5hbWluZ1J1bGUocnVsZSksIG5hbWUsIF9j\nb25maWcuZ2V0SWRlbnRpZmllckRlbGltaXRlcigpKTsKICAgIH0KCiAgICBw\ndWJsaWMgYm9vbGVhbiBjYW5TcGxpdChJZGVudGlmaWVyUnVsZSBydWxlLCBT\ndHJpbmcgbmFtZSkgewogICAgICAgIHJldHVybiBjYW5TcGxpdChydWxlLCBu\nYW1lLCBfY29uZmlnLmdldElkZW50aWZpZXJEZWxpbWl0ZXIoKSk7CiAgICB9\nCgogICAgcHVibGljIGJvb2xlYW4gY2FuU3BsaXQoU3RyaW5nIHJ1bGUsIFN0\ncmluZyBuYW1lLCBTdHJpbmcgZGVsaW0pIHsKICAgICAgICByZXR1cm4gY2Fu\nU3BsaXQoZ2V0TmFtaW5nUnVsZShydWxlKSwgbmFtZSk7CiAgICB9CgogICAg\ncHVibGljIGJvb2xlYW4gY2FuU3BsaXQoSWRlbnRpZmllclJ1bGUgcnVsZSwg\nU3RyaW5nIG5hbWUsIFN0cmluZyBkZWxpbSkgewogICAgICAgIGlmIChuYW1l\nID09IG51bGwgfHwgbmFtZS5sZW5ndGgoKSA9PSAwKSB7CiAgICAgICAgICAg\nIHJldHVybiBmYWxzZTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIG5hbWUu\nY29udGFpbnMoZGVsaW0pOwogICAgfQoKICAgIHB1YmxpYyBTdHJpbmcgY29t\nYmluZU5hbWVzKElkZW50aWZpZXJSdWxlIHJ1bGUsIFN0cmluZ1tdIG5hbWVz\nKSB7CiAgICAgICAgcmV0dXJuIGNvbWJpbmVOYW1lcyhfY29uZmlnLCBydWxl\nLCBuYW1lcyk7CiAgICB9CgogICAgcHVibGljIFN0cmluZyBjb21iaW5lTmFt\nZXMoSWRlbnRpZmllclJ1bGUgcnVsZSwgU3RyaW5nIG5hbWUxLCBTdHJpbmcg\nbmFtZTIpIHsKICAgICAgICByZXR1cm4gY29tYmluZU5hbWVzKF9jb25maWcs\nIHJ1bGUsIG5hbWUxLCBuYW1lMik7CiAgICB9Cn0K\n","encoding":"base64"}

