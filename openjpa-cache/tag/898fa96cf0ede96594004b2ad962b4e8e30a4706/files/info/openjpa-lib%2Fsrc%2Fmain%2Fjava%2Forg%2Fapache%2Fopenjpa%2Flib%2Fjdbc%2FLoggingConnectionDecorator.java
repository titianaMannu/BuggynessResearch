{"sha":"29308f2c5099c8d909f5c9f21e8e4f422194d936","node_id":"MDQ6QmxvYjIwNjM2NDoyOTMwOGYyYzUwOTljOGQ5MDlmNWM5ZjIxZThlNGY0MjIxOTRkOTM2","size":76471,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/29308f2c5099c8d909f5c9f21e8e4f422194d936","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEubGliLmpkYmM7CgppbXBvcnQg\namF2YS5pby5JbnB1dFN0cmVhbTsKaW1wb3J0IGphdmEuaW8uUmVhZGVyOwpp\nbXBvcnQgamF2YS5sYW5nLnJlZmxlY3QuQ29uc3RydWN0b3I7CmltcG9ydCBq\nYXZhLm1hdGguQmlnRGVjaW1hbDsKaW1wb3J0IGphdmEuc3FsLkFycmF5Owpp\nbXBvcnQgamF2YS5zcWwuQmF0Y2hVcGRhdGVFeGNlcHRpb247CmltcG9ydCBq\nYXZhLnNxbC5CbG9iOwppbXBvcnQgamF2YS5zcWwuQ2FsbGFibGVTdGF0ZW1l\nbnQ7CmltcG9ydCBqYXZhLnNxbC5DbG9iOwppbXBvcnQgamF2YS5zcWwuQ29u\nbmVjdGlvbjsKaW1wb3J0IGphdmEuc3FsLkRhdGFiYXNlTWV0YURhdGE7Cmlt\ncG9ydCBqYXZhLnNxbC5EYXRlOwppbXBvcnQgamF2YS5zcWwuUHJlcGFyZWRT\ndGF0ZW1lbnQ7CmltcG9ydCBqYXZhLnNxbC5SZWY7CmltcG9ydCBqYXZhLnNx\nbC5SZXN1bHRTZXQ7CmltcG9ydCBqYXZhLnNxbC5SZXN1bHRTZXRNZXRhRGF0\nYTsKaW1wb3J0IGphdmEuc3FsLlNRTEV4Y2VwdGlvbjsKaW1wb3J0IGphdmEu\nc3FsLlNRTFdhcm5pbmc7CmltcG9ydCBqYXZhLnNxbC5TYXZlcG9pbnQ7Cmlt\ncG9ydCBqYXZhLnNxbC5TdGF0ZW1lbnQ7CmltcG9ydCBqYXZhLnNxbC5UaW1l\nOwppbXBvcnQgamF2YS5zcWwuVGltZXN0YW1wOwppbXBvcnQgamF2YS51dGls\nLkFycmF5TGlzdDsKaW1wb3J0IGphdmEudXRpbC5BcnJheXM7CmltcG9ydCBq\nYXZhLnV0aWwuQ2FsZW5kYXI7CmltcG9ydCBqYXZhLnV0aWwuSXRlcmF0b3I7\nCmltcG9ydCBqYXZhLnV0aWwuTGlzdDsKCmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEubGliLmpkYmMuTG9nZ2luZ0Nvbm5lY3Rpb25EZWNvcmF0b3IuTG9n\nZ2luZ0Nvbm5lY3Rpb24uCiAgICAgICAgTG9nZ2luZ0NhbGxhYmxlU3RhdGVt\nZW50OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi5qZGJjLkxvZ2dp\nbmdDb25uZWN0aW9uRGVjb3JhdG9yLkxvZ2dpbmdDb25uZWN0aW9uLgogICAg\nICAgIExvZ2dpbmdEYXRhYmFzZU1ldGFEYXRhOwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLmxpYi5qZGJjLkxvZ2dpbmdDb25uZWN0aW9uRGVjb3JhdG9y\nLkxvZ2dpbmdDb25uZWN0aW9uLgogICAgICAgIExvZ2dpbmdQcmVwYXJlZFN0\nYXRlbWVudDsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIuamRiYy5M\nb2dnaW5nQ29ubmVjdGlvbkRlY29yYXRvci5Mb2dnaW5nQ29ubmVjdGlvbi4K\nICAgICAgICBMb2dnaW5nUmVzdWx0U2V0OwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLmxpYi5qZGJjLkxvZ2dpbmdDb25uZWN0aW9uRGVjb3JhdG9yLkxv\nZ2dpbmdDb25uZWN0aW9uLgogICAgICAgIExvZ2dpbmdTdGF0ZW1lbnQ7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLmxvZy5Mb2c7CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuQ29uY3JldGVDbGFzc0dlbmVy\nYXRvcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIudXRpbC5KMkRv\nUHJpdkhlbHBlcjsKCi8qKgogKiBBIHtAbGluayBDb25uZWN0aW9uRGVjb3Jh\ndG9yfSB0aGF0IGNyZWF0ZXMgbG9nZ2luZyBjb25uZWN0aW9ucyBhbmQKICog\ne0BsaW5rIFJlcG9ydGluZ1NRTEV4Y2VwdGlvbn1zLgogKgogKiBAYXV0aG9y\nIE1hcmMgUHJ1ZCdob21tZWF1eAogKiBAbm9qYXZhZG9jCiAqLwpwdWJsaWMg\nY2xhc3MgTG9nZ2luZ0Nvbm5lY3Rpb25EZWNvcmF0b3IgaW1wbGVtZW50cyBD\nb25uZWN0aW9uRGVjb3JhdG9yIHsKCiAgICBwcml2YXRlIHN0YXRpYyBmaW5h\nbCBTdHJpbmcgU0VQID0gSjJEb1ByaXZIZWxwZXIuZ2V0TGluZVNlcGFyYXRv\ncigpOwogICAgc3RhdGljIGZpbmFsIENvbnN0cnVjdG9yPExvZ2dpbmdDb25u\nZWN0aW9uPiBsb2dnaW5nQ29ubmVjdGlvbkltcGw7CiAgICBzdGF0aWMgZmlu\nYWwgQ29uc3RydWN0b3I8TG9nZ2luZ1Jlc3VsdFNldD4gbG9nZ2luZ1Jlc3Vs\ndFNldEltcGw7CiAgICBzdGF0aWMgZmluYWwgQ29uc3RydWN0b3I8TG9nZ2lu\nZ1N0YXRlbWVudD4gbG9nZ2luZ1N0YXRlbWVudEltcGw7CiAgICBzdGF0aWMg\nZmluYWwgQ29uc3RydWN0b3I8TG9nZ2luZ1ByZXBhcmVkU3RhdGVtZW50PiBs\nb2dnaW5nUHJlcGFyZWRTdGF0ZW1lbnRJbXBsOwogICAgc3RhdGljIGZpbmFs\nIENvbnN0cnVjdG9yPExvZ2dpbmdDYWxsYWJsZVN0YXRlbWVudD4gbG9nZ2lu\nZ0NhbGxhYmxlU3RhdGVtZW50SW1wbDsKICAgIHN0YXRpYyBmaW5hbCBDb25z\ndHJ1Y3RvcjxMb2dnaW5nRGF0YWJhc2VNZXRhRGF0YT4gbG9nZ2luZ0RhdGFi\nYXNlTWV0YURhdGFJbXBsOwoKICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIGlu\ndCBXQVJOX0lHTk9SRSA9IDA7CiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBp\nbnQgV0FSTl9MT0dfVFJBQ0UgPSAxOwogICAgcHJpdmF0ZSBzdGF0aWMgZmlu\nYWwgaW50IFdBUk5fTE9HX0lORk8gPSAyOwogICAgcHJpdmF0ZSBzdGF0aWMg\nZmluYWwgaW50IFdBUk5fTE9HX1dBUk4gPSAzOwogICAgcHJpdmF0ZSBzdGF0\naWMgZmluYWwgaW50IFdBUk5fTE9HX0VSUk9SID0gNDsKICAgIHByaXZhdGUg\nc3RhdGljIGZpbmFsIGludCBXQVJOX1RIUk9XID0gNTsKICAgIHByaXZhdGUg\nc3RhdGljIGZpbmFsIGludCBXQVJOX0hBTkRMRSA9IDY7CiAgICBwcml2YXRl\nIHN0YXRpYyBmaW5hbCBTdHJpbmdbXSBXQVJOSU5HX0FDVElPTlMgPSBuZXcg\nU3RyaW5nWzddOwoKICAgIHN0YXRpYyB7CiAgICAgICAgV0FSTklOR19BQ1RJ\nT05TW1dBUk5fSUdOT1JFXSA9ICJpZ25vcmUiOwogICAgICAgIFdBUk5JTkdf\nQUNUSU9OU1tXQVJOX0xPR19UUkFDRV0gPSAidHJhY2UiOwogICAgICAgIFdB\nUk5JTkdfQUNUSU9OU1tXQVJOX0xPR19JTkZPXSA9ICJpbmZvIjsKICAgICAg\nICBXQVJOSU5HX0FDVElPTlNbV0FSTl9MT0dfV0FSTl0gPSAid2FybiI7CiAg\nICAgICAgV0FSTklOR19BQ1RJT05TW1dBUk5fTE9HX0VSUk9SXSA9ICJlcnJv\nciI7CiAgICAgICAgV0FSTklOR19BQ1RJT05TW1dBUk5fVEhST1ddID0gInRo\ncm93IjsKICAgICAgICBXQVJOSU5HX0FDVElPTlNbV0FSTl9IQU5ETEVdID0g\nImhhbmRsZSI7CgogICAgICAgIHRyeSB7CiAgICAgICAgICAgIGxvZ2dpbmdD\nb25uZWN0aW9uSW1wbCA9IENvbmNyZXRlQ2xhc3NHZW5lcmF0b3IuZ2V0Q29u\nY3JldGVDb25zdHJ1Y3RvcihMb2dnaW5nQ29ubmVjdGlvbi5jbGFzcywKICAg\nICAgICAgICAgICAgIExvZ2dpbmdDb25uZWN0aW9uRGVjb3JhdG9yLmNsYXNz\nLCBDb25uZWN0aW9uLmNsYXNzKTsKICAgICAgICAgICAgbG9nZ2luZ1Jlc3Vs\ndFNldEltcGwgPSBDb25jcmV0ZUNsYXNzR2VuZXJhdG9yLmdldENvbmNyZXRl\nQ29uc3RydWN0b3IoCiAgICAgICAgICAgICAgICBMb2dnaW5nQ29ubmVjdGlv\nbi5Mb2dnaW5nUmVzdWx0U2V0LmNsYXNzLCAKICAgICAgICAgICAgICAgIExv\nZ2dpbmdDb25uZWN0aW9uLmNsYXNzLCBSZXN1bHRTZXQuY2xhc3MsIFN0YXRl\nbWVudC5jbGFzcyk7CiAgICAgICAgICAgIGxvZ2dpbmdTdGF0ZW1lbnRJbXBs\nID0gQ29uY3JldGVDbGFzc0dlbmVyYXRvci5nZXRDb25jcmV0ZUNvbnN0cnVj\ndG9yKAogICAgICAgICAgICAgICAgTG9nZ2luZ0Nvbm5lY3Rpb24uTG9nZ2lu\nZ1N0YXRlbWVudC5jbGFzcywKICAgICAgICAgICAgICAgIExvZ2dpbmdDb25u\nZWN0aW9uLmNsYXNzLCBTdGF0ZW1lbnQuY2xhc3MpOwogICAgICAgICAgICBs\nb2dnaW5nUHJlcGFyZWRTdGF0ZW1lbnRJbXBsID0gQ29uY3JldGVDbGFzc0dl\nbmVyYXRvci5nZXRDb25jcmV0ZUNvbnN0cnVjdG9yKAogICAgICAgICAgICAg\nICAgTG9nZ2luZ0Nvbm5lY3Rpb24uTG9nZ2luZ1ByZXBhcmVkU3RhdGVtZW50\nLmNsYXNzLCAKICAgICAgICAgICAgICAgIExvZ2dpbmdDb25uZWN0aW9uLmNs\nYXNzLCBQcmVwYXJlZFN0YXRlbWVudC5jbGFzcywgU3RyaW5nLmNsYXNzKTsK\nICAgICAgICAgICAgbG9nZ2luZ0NhbGxhYmxlU3RhdGVtZW50SW1wbCA9IENv\nbmNyZXRlQ2xhc3NHZW5lcmF0b3IuZ2V0Q29uY3JldGVDb25zdHJ1Y3RvcigK\nICAgICAgICAgICAgICAgIExvZ2dpbmdDb25uZWN0aW9uLkxvZ2dpbmdDYWxs\nYWJsZVN0YXRlbWVudC5jbGFzcywKICAgICAgICAgICAgICAgIExvZ2dpbmdD\nb25uZWN0aW9uLmNsYXNzLCBDYWxsYWJsZVN0YXRlbWVudC5jbGFzcywgU3Ry\naW5nLmNsYXNzKTsKICAgICAgICAgICAgbG9nZ2luZ0RhdGFiYXNlTWV0YURh\ndGFJbXBsID0gQ29uY3JldGVDbGFzc0dlbmVyYXRvci5nZXRDb25jcmV0ZUNv\nbnN0cnVjdG9yKAogICAgICAgICAgICAgICAgTG9nZ2luZ0Nvbm5lY3Rpb24u\nTG9nZ2luZ0RhdGFiYXNlTWV0YURhdGEuY2xhc3MsCiAgICAgICAgICAgICAg\nICBMb2dnaW5nQ29ubmVjdGlvbi5jbGFzcywgRGF0YWJhc2VNZXRhRGF0YS5j\nbGFzcyk7CiAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAgICAg\nICAgICAgdGhyb3cgbmV3IEV4Y2VwdGlvbkluSW5pdGlhbGl6ZXJFcnJvcihl\nKTsKICAgICAgICB9CiAgICB9CgogICAgcHJpdmF0ZSBmaW5hbCBEYXRhU291\ncmNlTG9ncyBfbG9ncyA9IG5ldyBEYXRhU291cmNlTG9ncygpOwogICAgcHJp\ndmF0ZSBTUUxGb3JtYXR0ZXIgX2Zvcm1hdHRlcjsKICAgIHByaXZhdGUgYm9v\nbGVhbiBfcHJldHR5UHJpbnQ7CiAgICBwcml2YXRlIGludCBfcHJldHR5UHJp\nbnRMaW5lTGVuZ3RoID0gNjA7CiAgICBwcml2YXRlIGludCBfd2FybmluZ0Fj\ndGlvbiA9IFdBUk5fSUdOT1JFOwogICAgcHJpdmF0ZSBTUUxXYXJuaW5nSGFu\nZGxlciBfd2FybmluZ0hhbmRsZXI7CiAgICBwcml2YXRlIGJvb2xlYW4gX3Ry\nYWNrUGFyYW1ldGVycyA9IHRydWU7CgogICAgLyoqCiAgICAgKiBJZiBzZXQg\ndG8gPGNvZGU+dHJ1ZTwvY29kZT4sIHByZXR0eS1wcmludCBTUUwgYnkgcnVu\nbmluZyBpdAogICAgICogdGhyb3VnaCB7QGxpbmsgU1FMRm9ybWF0dGVyI3By\nZXR0eVByaW50fS4gSWYKICAgICAqIDxjb2RlPmZhbHNlPC9jb2RlPiwgZG9u\nJ3QgcHJldHR5LXByaW50LCBhbmQgb3V0cHV0IFNRTCBsb2dzIGluCiAgICAg\nKiBhIHNpbmdsZSBsaW5lLiBQcmV0dHktcHJpbnRlZCBTUUwgY2FuIGJlIGVh\nc2llciBmb3IgYSBodW1hbiB0bwogICAgICogcmVhZCwgYnV0IGlzIGhhcmRl\nciB0byBwYXJzZSB3aXRoIHRvb2xzIGxpa2UgZ3JlcC4KICAgICAqLwogICAg\ncHVibGljIHZvaWQgc2V0UHJldHR5UHJpbnQoYm9vbGVhbiBwcmV0dHlQcmlu\ndCkgewogICAgICAgIF9wcmV0dHlQcmludCA9IHByZXR0eVByaW50OwogICAg\nICAgIGlmIChfZm9ybWF0dGVyID09IG51bGwgJiYgX3ByZXR0eVByaW50KSB7\nCiAgICAgICAgICAgIF9mb3JtYXR0ZXIgPSBuZXcgU1FMRm9ybWF0dGVyKCk7\nCiAgICAgICAgICAgIF9mb3JtYXR0ZXIuc2V0TGluZUxlbmd0aChfcHJldHR5\nUHJpbnRMaW5lTGVuZ3RoKTsKICAgICAgICB9IGVsc2UgaWYgKCFfcHJldHR5\nUHJpbnQpCiAgICAgICAgICAgIF9mb3JtYXR0ZXIgPSBudWxsOwogICAgfQoK\nICAgIC8qKgogICAgICogQHNlZSAjc2V0UHJldHR5UHJpbnQKICAgICAqLwog\nICAgcHVibGljIGJvb2xlYW4gZ2V0UHJldHR5UHJpbnQoKSB7CiAgICAgICAg\ncmV0dXJuIF9wcmV0dHlQcmludDsKICAgIH0KCiAgICAvKioKICAgICAqIFRo\nZSBudW1iZXIgb2YgY2hhcmFjdGVycyB0byBwcmludCBwZXIgbGluZSB3aGVu\nCiAgICAgKiBwcmV0dHktcHJpbnRpbmcgb2YgU1FMIGlzIGVuYWJsZWQuIERl\nZmF1bHRzIHRvIDYwIHRvIHByb3ZpZGUKICAgICAqIHNvbWUgc3BhY2UgZm9y\nIGFueSBhbnQtcmVsYXRlZCBjaGFyYWN0ZXJzIG9uIHRoZSBsZWZ0IG9mIGEK\nICAgICAqIHN0YW5kYXJkIDgwLWNoYXJhY3RlciBkaXNwbGF5LgogICAgICov\nCiAgICBwdWJsaWMgdm9pZCBzZXRQcmV0dHlQcmludExpbmVMZW5ndGgoaW50\nIGxlbmd0aCkgewogICAgICAgIF9wcmV0dHlQcmludExpbmVMZW5ndGggPSBs\nZW5ndGg7CiAgICAgICAgaWYgKF9mb3JtYXR0ZXIgIT0gbnVsbCkKICAgICAg\nICAgICAgX2Zvcm1hdHRlci5zZXRMaW5lTGVuZ3RoKGxlbmd0aCk7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBAc2VlICNzZXRQcmV0dHlQcmludExpbmVMZW5n\ndGgKICAgICAqLwogICAgcHVibGljIGludCBnZXRQcmV0dHlQcmludExpbmVM\nZW5ndGgoKSB7CiAgICAgICAgcmV0dXJuIF9wcmV0dHlQcmludExpbmVMZW5n\ndGg7CiAgICB9CgogICAgLyoqCiAgICAgKiBXaGV0aGVyIHRvIHRyYWNrIHBh\ncmFtZXRlcnMgZm9yIHRoZSBwdXJwb3NlcyBvZiByZXBvcnRpbmcgZXhjZXB0\naW9ucy4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0VHJhY2tQYXJhbWV0\nZXJzKGJvb2xlYW4gdHJhY2tQYXJhbWV0ZXJzKSB7CiAgICAgICAgX3RyYWNr\nUGFyYW1ldGVycyA9IHRyYWNrUGFyYW1ldGVyczsKICAgIH0KCiAgICAvKioK\nICAgICAqIFdoZXRoZXIgdG8gdHJhY2sgcGFyYW1ldGVycyBmb3IgdGhlIHB1\ncnBvc2VzIG9mIHJlcG9ydGluZyBleGNlcHRpb25zLgogICAgICovCiAgICBw\ndWJsaWMgYm9vbGVhbiBnZXRUcmFja1BhcmFtZXRlcnMoKSB7CiAgICAgICAg\ncmV0dXJuIF90cmFja1BhcmFtZXRlcnM7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBXaGF0IHRvIGRvIHdpdGggU1FMIHdhcm5pbmdzLgogICAgICovCiAgICBw\ndWJsaWMgdm9pZCBzZXRXYXJuaW5nQWN0aW9uKFN0cmluZyB3YXJuaW5nQWN0\naW9uKSB7CiAgICAgICAgaW50IGluZGV4ID0gQXJyYXlzLmFzTGlzdChXQVJO\nSU5HX0FDVElPTlMpLmluZGV4T2Yod2FybmluZ0FjdGlvbik7CiAgICAgICAg\naWYgKGluZGV4IDwgMCkKICAgICAgICAgICAgaW5kZXggPSBXQVJOX0lHTk9S\nRTsKICAgICAgICBfd2FybmluZ0FjdGlvbiA9IGluZGV4OwogICAgfQoKICAg\nIC8qKgogICAgICogV2hhdCB0byBkbyB3aXRoIFNRTCB3YXJuaW5ncy4KICAg\nICAqLwogICAgcHVibGljIFN0cmluZyBnZXRXYXJuaW5nQWN0aW9uKCkgewog\nICAgICAgIHJldHVybiBXQVJOSU5HX0FDVElPTlNbX3dhcm5pbmdBY3Rpb25d\nOwogICAgfQoKICAgIC8qKgogICAgICogV2hhdCB0byBkbyB3aXRoIFNRTCB3\nYXJuaW5ncy4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0V2FybmluZ0hh\nbmRsZXIoU1FMV2FybmluZ0hhbmRsZXIgd2FybmluZ0hhbmRsZXIpIHsKICAg\nICAgICBfd2FybmluZ0hhbmRsZXIgPSB3YXJuaW5nSGFuZGxlcjsKICAgIH0K\nCiAgICAvKioKICAgICAqIFdoYXQgdG8gZG8gd2l0aCBTUUwgd2FybmluZ3Mu\nCiAgICAgKi8KICAgIHB1YmxpYyBTUUxXYXJuaW5nSGFuZGxlciBnZXRXYXJu\naW5nSGFuZGxlcigpIHsKICAgICAgICByZXR1cm4gX3dhcm5pbmdIYW5kbGVy\nOwogICAgfQoKICAgIC8qKgogICAgICogVGhlIGxvZyB0byB3cml0ZSB0by4K\nICAgICAqLwogICAgcHVibGljIERhdGFTb3VyY2VMb2dzIGdldExvZ3MoKSB7\nCiAgICAgICAgcmV0dXJuIF9sb2dzOwogICAgfQoKICAgIHB1YmxpYyBDb25u\nZWN0aW9uIGRlY29yYXRlKENvbm5lY3Rpb24gY29ubikgdGhyb3dzIFNRTEV4\nY2VwdGlvbiB7CiAgICAgICAgcmV0dXJuIG5ld0xvZ2dpbmdDb25uZWN0aW9u\nKGNvbm4pOwogICAgfQogICAgICAgICAKICAgIHByaXZhdGUgTG9nZ2luZ0Nv\nbm5lY3Rpb24gbmV3TG9nZ2luZ0Nvbm5lY3Rpb24oQ29ubmVjdGlvbiBjb25u\nKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIHJldHVy\nbiBDb25jcmV0ZUNsYXNzR2VuZXJhdG9yLm5ld0luc3RhbmNlKGxvZ2dpbmdD\nb25uZWN0aW9uSW1wbCwgTG9nZ2luZ0Nvbm5lY3Rpb25EZWNvcmF0b3IudGhp\ncywgY29ubik7CiAgICB9CgoKICAgIC8qKgogICAgICogSW5jbHVkZSBTUUwg\naW4gZXhjZXB0aW9uLgogICAgICovCiAgICBwcml2YXRlIFNRTEV4Y2VwdGlv\nbiB3cmFwKFNRTEV4Y2VwdGlvbiBzcWxlLCBTdGF0ZW1lbnQgc3RtbnQpIHsK\nICAgICAgICBpZiAoc3FsZSBpbnN0YW5jZW9mIFJlcG9ydGluZ1NRTEV4Y2Vw\ndGlvbikKICAgICAgICAgICAgcmV0dXJuIChSZXBvcnRpbmdTUUxFeGNlcHRp\nb24pIHNxbGU7CiAgICAgICAgcmV0dXJuIG5ldyBSZXBvcnRpbmdTUUxFeGNl\ncHRpb24oc3FsZSwgc3RtbnQsIG51bGwpOwogICAgfQoKICAgIC8qKgogICAg\nICogSW5jbHVkZSBTUUwgaW4gZXhjZXB0aW9uLgogICAgICovCiAgICBwcml2\nYXRlIFNRTEV4Y2VwdGlvbiB3cmFwKFNRTEV4Y2VwdGlvbiBzcWxlLCBTdHJp\nbmcgc3FsKSB7CiAgICAgICAgaWYgKHNxbGUgaW5zdGFuY2VvZiBSZXBvcnRp\nbmdTUUxFeGNlcHRpb24pCiAgICAgICAgICAgIHJldHVybiAoUmVwb3J0aW5n\nU1FMRXhjZXB0aW9uKSBzcWxlOwogICAgICAgIHJldHVybiBuZXcgUmVwb3J0\naW5nU1FMRXhjZXB0aW9uKHNxbGUsIG51bGwsIHNxbCk7CiAgICB9CiAgICAK\nICAgIHByaXZhdGUgU1FMRXhjZXB0aW9uIHdyYXAoU1FMRXhjZXB0aW9uIHNx\nbGUsIFN0YXRlbWVudCBzdG1udCwgU3RyaW5nIHNxbCkgewogICAgICAgIGlm\nIChzcWxlIGluc3RhbmNlb2YgUmVwb3J0aW5nU1FMRXhjZXB0aW9uKQogICAg\nICAgICAgICByZXR1cm4gKFJlcG9ydGluZ1NRTEV4Y2VwdGlvbikgc3FsZTsK\nICAgICAgICByZXR1cm4gbmV3IFJlcG9ydGluZ1NRTEV4Y2VwdGlvbihzcWxl\nLCBzdG1udCwgc3FsKTsKICAgIH0KCiAgICAvKioKICAgICAqIEludGVyZmFj\nZSB0aGF0IGFsbG93cyBjdXN0b21pemF0aW9uIG9mIHdoYXQgdG8gZG8gd2hl\nbgogICAgICoge0BsaW5rIFNRTFdhcm5pbmd9cyBvY2N1ci4KICAgICAqLwog\nICAgcHVibGljIHN0YXRpYyBpbnRlcmZhY2UgU1FMV2FybmluZ0hhbmRsZXIg\newoKICAgICAgICBwdWJsaWMgdm9pZCBoYW5kbGVXYXJuaW5nKFNRTFdhcm5p\nbmcgd2FybmluZykgdGhyb3dzIFNRTEV4Y2VwdGlvbjsKICAgIH0KCiAgICAv\nKioKICAgICAqIExvZ2dpbmcgY29ubmVjdGlvbi4KICAgICAqLwogICAgcHJv\ndGVjdGVkIGFic3RyYWN0IGNsYXNzIExvZ2dpbmdDb25uZWN0aW9uIGV4dGVu\nZHMgRGVsZWdhdGluZ0Nvbm5lY3Rpb24gewoKICAgICAgICBwdWJsaWMgTG9n\nZ2luZ0Nvbm5lY3Rpb24oQ29ubmVjdGlvbiBjb25uKSB0aHJvd3MgU1FMRXhj\nZXB0aW9uIHsKICAgICAgICAgICAgc3VwZXIoY29ubik7CiAgICAgICAgfQoK\nICAgICAgICBwcm90ZWN0ZWQgUHJlcGFyZWRTdGF0ZW1lbnQgcHJlcGFyZVN0\nYXRlbWVudChTdHJpbmcgc3FsLCBib29sZWFuIHdyYXApCiAgICAgICAgICAg\nIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgICAgICBTUUxFeGNlcHRp\nb24gZXJyID0gbnVsbDsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAg\nICAgIFByZXBhcmVkU3RhdGVtZW50IHN0bW50ID0gc3VwZXIucHJlcGFyZVN0\nYXRlbWVudChzcWwsIGZhbHNlKTsKICAgICAgICAgICAgICAgIHJldHVybiBu\nZXdMb2dnaW5nUHJlcGFyZWRTdGF0ZW1lbnQoc3RtbnQsIHNxbCk7CiAgICAg\nICAgICAgIH0gY2F0Y2ggKFNRTEV4Y2VwdGlvbiBzZSkgewogICAgICAgICAg\nICAgICAgZXJyID0gd3JhcChzZSwgc3FsKTsKICAgICAgICAgICAgICAgIHRo\ncm93IGVycjsKICAgICAgICAgICAgfSAgZmluYWxseSB7CiAgICAgICAgICAg\nICAgICBoYW5kbGVTUUxFcnJvcnMoZXJyKTsKICAgICAgICAgICAgfQogICAg\nICAgIH0KCiAgICAgICAgcHJvdGVjdGVkIFByZXBhcmVkU3RhdGVtZW50IHBy\nZXBhcmVTdGF0ZW1lbnQoU3RyaW5nIHNxbCwgaW50IHJzVHlwZSwKICAgICAg\nICAgICAgaW50IHJzQ29uY3VyLCBib29sZWFuIHdyYXApIHRocm93cyBTUUxF\neGNlcHRpb24gewogICAgICAgICAgICBTUUxFeGNlcHRpb24gZXJyID0gbnVs\nbDsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIFByZXBhcmVk\nU3RhdGVtZW50IHN0bW50ID0gc3VwZXIucHJlcGFyZVN0YXRlbWVudAogICAg\nICAgICAgICAgICAgICAgIChzcWwsIHJzVHlwZSwgcnNDb25jdXIsIGZhbHNl\nKTsKICAgICAgICAgICAgICAgIHJldHVybiBuZXdMb2dnaW5nUHJlcGFyZWRT\ndGF0ZW1lbnQoc3RtbnQsIHNxbCk7CiAgICAgICAgICAgIH0gY2F0Y2ggKFNR\nTEV4Y2VwdGlvbiBzZSkgewogICAgICAgICAgICAgICAgZXJyID0gIHdyYXAo\nc2UsIHNxbCk7CiAgICAgICAgICAgICAgICB0aHJvdyBlcnI7CiAgICAgICAg\nICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgICAgICBoYW5kbGVTUUxFcnJv\ncnMoZXJyKTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgcHJv\ndGVjdGVkIFN0YXRlbWVudCBjcmVhdGVTdGF0ZW1lbnQoYm9vbGVhbiB3cmFw\nKSB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAgICAgU1FMRXhjZXB0\naW9uIGVyciA9IG51bGw7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAg\nICAgICBTdGF0ZW1lbnQgc3RtbnQgPSBzdXBlci5jcmVhdGVTdGF0ZW1lbnQo\nZmFsc2UpOwogICAgICAgICAgICAgICAgcmV0dXJuIG5ld0xvZ2dpbmdTdGF0\nZW1lbnQoc3RtbnQpOwogICAgICAgICAgICB9Y2F0Y2ggKFNRTEV4Y2VwdGlv\nbiBzZSkgewogICAgICAgICAgICAgICAgZXJyID0gc2U7CiAgICAgICAgICAg\nICAgICB0aHJvdyBzZTsKICAgICAgICAgICAgfSBmaW5hbGx5IHsKICAgICAg\nICAgICAgICAgIGhhbmRsZVNRTEVycm9ycyhlcnIpOwogICAgICAgICAgICB9\nCiAgICAgICAgfQoKICAgICAgICBwcm90ZWN0ZWQgU3RhdGVtZW50IGNyZWF0\nZVN0YXRlbWVudChpbnQgdHlwZSwgaW50IGNvbmN1cnJlbmN5LAogICAgICAg\nICAgICBib29sZWFuIHdyYXApIHRocm93cyBTUUxFeGNlcHRpb24gewogICAg\nICAgICAgICBTUUxFeGNlcHRpb24gZXJyID0gbnVsbDsKICAgICAgICAgICAg\ndHJ5IHsKICAgICAgICAgICAgICAgIFN0YXRlbWVudCBzdG1udCA9IHN1cGVy\nLmNyZWF0ZVN0YXRlbWVudCh0eXBlLCBjb25jdXJyZW5jeSwgCiAgICAgICAg\nICAgICAgICAgICAgZmFsc2UpOwogICAgICAgICAgICAgICAgcmV0dXJuIG5l\nd0xvZ2dpbmdTdGF0ZW1lbnQoc3RtbnQpOwogICAgICAgICAgICB9IGNhdGNo\nIChTUUxFeGNlcHRpb24gc2UpIHsKICAgICAgICAgICAgICAgIGVyciA9IHNl\nOwogICAgICAgICAgICAgICAgdGhyb3cgc2U7CiAgICAgICAgICAgIH0gZmlu\nYWxseSB7CiAgICAgICAgICAgICAgICBoYW5kbGVTUUxFcnJvcnMoZXJyKTsK\nICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICAKICAgICAgICBwcm90\nZWN0ZWQgQ2FsbGFibGVTdGF0ZW1lbnQgcHJlcGFyZUNhbGwoU3RyaW5nIHNx\nbCwgYm9vbGVhbiB3cmFwKSAKICAgICAgICAgICAgdGhyb3dzIFNRTEV4Y2Vw\ndGlvbiB7CiAgICAgICAgICAgIFNRTEV4Y2VwdGlvbiBlcnIgPSBudWxsOwog\nICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgQ2FsbGFibGVTdGF0\nZW1lbnQgc3RtdCA9IHN1cGVyLnByZXBhcmVDYWxsKHNxbCwgd3JhcCk7CiAg\nICAgICAgICAgICAgICByZXR1cm4gbmV3TG9nZ2luZ0NhbGxhYmxlU3RhdGVt\nZW50KHN0bXQsIHNxbCk7CiAgICAgICAgICAgIH0gY2F0Y2ggKFNRTEV4Y2Vw\ndGlvbiBzZSkgewogICAgICAgICAgICAgICAgZXJyID0gd3JhcChzZSwgc3Fs\nKTsKICAgICAgICAgICAgICAgIHRocm93IGVycjsKICAgICAgICAgICAgfSBm\naW5hbGx5IHsKICAgICAgICAgICAgICAgIGhhbmRsZVNRTEVycm9ycyhlcnIp\nOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBwcml2YXRlIExv\nZ2dpbmdQcmVwYXJlZFN0YXRlbWVudCBuZXdMb2dnaW5nUHJlcGFyZWRTdGF0\nZW1lbnQKICAgICAgICAgICAgKFByZXBhcmVkU3RhdGVtZW50IHN0bW50LCBT\ndHJpbmcgc3FsKSB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAgICAg\ncmV0dXJuIENvbmNyZXRlQ2xhc3NHZW5lcmF0b3IubmV3SW5zdGFuY2UobG9n\nZ2luZ1ByZXBhcmVkU3RhdGVtZW50SW1wbCwgTG9nZ2luZ0Nvbm5lY3Rpb24u\ndGhpcywgc3RtbnQsIHNxbCk7CiAgICAgICAgfQogICAgICAgIAogICAgICAg\nIHByaXZhdGUgQ2FsbGFibGVTdGF0ZW1lbnQgbmV3TG9nZ2luZ0NhbGxhYmxl\nU3RhdGVtZW50KENhbGxhYmxlU3RhdGVtZW50IHN0bW50LCBTdHJpbmcgc3Fs\nKSB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAgICAgcmV0dXJuIENv\nbmNyZXRlQ2xhc3NHZW5lcmF0b3IubmV3SW5zdGFuY2UobG9nZ2luZ0NhbGxh\nYmxlU3RhdGVtZW50SW1wbCwgTG9nZ2luZ0Nvbm5lY3Rpb24udGhpcywgc3Rt\nbnQsIHNxbCk7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIHByaXZhdGUg\nTG9nZ2luZ1N0YXRlbWVudCBuZXdMb2dnaW5nU3RhdGVtZW50KFN0YXRlbWVu\ndCBzdG1udCkKICAgICAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAg\nICAgICAgICAgIHJldHVybiBDb25jcmV0ZUNsYXNzR2VuZXJhdG9yLm5ld0lu\nc3RhbmNlKGxvZ2dpbmdTdGF0ZW1lbnRJbXBsLCBMb2dnaW5nQ29ubmVjdGlv\nbi50aGlzLCBzdG1udCk7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIHBy\naXZhdGUgTG9nZ2luZ0RhdGFiYXNlTWV0YURhdGEgbmV3TG9nZ2luZ0RhdGFi\nYXNlTWV0YURhdGEKICAgICAgICAgICAgKERhdGFiYXNlTWV0YURhdGEgbWV0\nYSkgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgICAgIHJldHVybiBD\nb25jcmV0ZUNsYXNzR2VuZXJhdG9yLm5ld0luc3RhbmNlKGxvZ2dpbmdEYXRh\nYmFzZU1ldGFEYXRhSW1wbCwgTG9nZ2luZ0Nvbm5lY3Rpb24udGhpcywgbWV0\nYSk7CiAgICAgICAgfQoKCgogICAgICAgIHB1YmxpYyB2b2lkIGNvbW1pdCgp\nIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgICAgICBsb25nIHN0YXJ0\nID0gU3lzdGVtLmN1cnJlbnRUaW1lTWlsbGlzKCk7CiAgICAgICAgICAgIFNR\nTEV4Y2VwdGlvbiBlcnIgPSBudWxsOyAgICAgICAgICAgIAogICAgICAgICAg\nICB0cnkgewogICAgICAgICAgICAgICAgc3VwZXIuY29tbWl0KCk7CiAgICAg\nICAgICAgIH0gY2F0Y2ggKFNRTEV4Y2VwdGlvbiBzZSkgewogICAgICAgICAg\nICAgICAgZXJyID0gc2U7CiAgICAgICAgICAgICAgICB0aHJvdyBzZTsKICAg\nICAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgICAgIGlmIChfbG9n\ncy5pc0pEQkNFbmFibGVkKCkpCiAgICAgICAgICAgICAgICAgICAgX2xvZ3Mu\nbG9nSkRCQygiY29tbWl0Iiwgc3RhcnQsIHRoaXMpOwogICAgICAgICAgICAg\nICAgaGFuZGxlU1FMRXJyb3JzKGVycik7CiAgICAgICAgICAgIH0KICAgICAg\nICB9CgogICAgICAgIHB1YmxpYyB2b2lkIHJvbGxiYWNrKCkgdGhyb3dzIFNR\nTEV4Y2VwdGlvbiB7CiAgICAgICAgICAgIGxvbmcgc3RhcnQgPSBTeXN0ZW0u\nY3VycmVudFRpbWVNaWxsaXMoKTsKICAgICAgICAgICAgU1FMRXhjZXB0aW9u\nIGVyciA9IG51bGw7ICAgICAgICAgICAgCiAgICAgICAgICAgIHRyeSB7CiAg\nICAgICAgICAgICAgICBzdXBlci5yb2xsYmFjaygpOwogICAgICAgICAgICB9\nIGNhdGNoIChTUUxFeGNlcHRpb24gc2UpIHsKICAgICAgICAgICAgICAgIGVy\nciA9IHNlOwogICAgICAgICAgICAgICAgdGhyb3cgc2U7CiAgICAgICAgICAg\nIH0gZmluYWxseSB7CiAgICAgICAgICAgICAgICBpZiAoX2xvZ3MuaXNKREJD\nRW5hYmxlZCgpKQogICAgICAgICAgICAgICAgICAgIF9sb2dzLmxvZ0pEQkMo\nInJvbGxiYWNrIiwgc3RhcnQsIHRoaXMpOwogICAgICAgICAgICAgICAgaGFu\nZGxlU1FMRXJyb3JzKGVycik7CiAgICAgICAgICAgIH0KICAgICAgICB9Cgog\nICAgICAgIHB1YmxpYyB2b2lkIGNsb3NlKCkgdGhyb3dzIFNRTEV4Y2VwdGlv\nbiB7CiAgICAgICAgICAgIGxvbmcgc3RhcnQgPSBTeXN0ZW0uY3VycmVudFRp\nbWVNaWxsaXMoKTsgICAgICAgCiAgICAgICAgICAgIHRyeSB7CiAgICAgICAg\nICAgICAgICBzdXBlci5jbG9zZSgpOwogICAgICAgICAgICB9IGZpbmFsbHkg\newogICAgICAgICAgICAgICAgaWYgKF9sb2dzLmlzSkRCQ0VuYWJsZWQoKSkK\nICAgICAgICAgICAgICAgICAgICBfbG9ncy5sb2dKREJDKCJjbG9zZSIsIHN0\nYXJ0LCB0aGlzKTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAg\ncHVibGljIFNhdmVwb2ludCBzZXRTYXZlcG9pbnQoKSB0aHJvd3MgU1FMRXhj\nZXB0aW9uIHsKICAgICAgICAgICAgbG9uZyBzdGFydCA9IFN5c3RlbS5jdXJy\nZW50VGltZU1pbGxpcygpOwogICAgICAgICAgICBTUUxFeGNlcHRpb24gZXJy\nID0gbnVsbDsgICAgICAgICAgICAKICAgICAgICAgICAgdHJ5IHsKICAgICAg\nICAgICAgICAgIHJldHVybiBzdXBlci5zZXRTYXZlcG9pbnQoKTsKICAgICAg\nICAgICAgfSBjYXRjaCAoU1FMRXhjZXB0aW9uIHNlKSB7CiAgICAgICAgICAg\nICAgICBlcnIgPSBzZTsKICAgICAgICAgICAgICAgIHRocm93IHNlOwogICAg\nICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICAgICAgaWYgKF9sb2dz\nLmlzSkRCQ0VuYWJsZWQoKSkKICAgICAgICAgICAgICAgICAgICBfbG9ncy5s\nb2dKREJDKCJzYXZlcG9pbnQiLCBzdGFydCwgdGhpcyk7CiAgICAgICAgICAg\nICAgICBoYW5kbGVTUUxFcnJvcnMoZXJyKTsKICAgICAgICAgICAgfQogICAg\nICAgIH0KCiAgICAgICAgcHVibGljIFNhdmVwb2ludCBzZXRTYXZlcG9pbnQo\nU3RyaW5nIG5hbWUpIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgICAg\nICBsb25nIHN0YXJ0ID0gU3lzdGVtLmN1cnJlbnRUaW1lTWlsbGlzKCk7CiAg\nICAgICAgICAgIFNRTEV4Y2VwdGlvbiBlcnIgPSBudWxsOyAgICAgICAgICAg\nIAogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgcmV0dXJuIHN1\ncGVyLnNldFNhdmVwb2ludChuYW1lKTsKICAgICAgICAgICAgfSBjYXRjaCAo\nU1FMRXhjZXB0aW9uIHNlKSB7CiAgICAgICAgICAgICAgICBlcnIgPSBzZTsK\nICAgICAgICAgICAgICAgIHRocm93IHNlOwogICAgICAgICAgICB9IGZpbmFs\nbHkgewogICAgICAgICAgICAgICAgaWYgKF9sb2dzLmlzSkRCQ0VuYWJsZWQo\nKSkKICAgICAgICAgICAgICAgICAgICBfbG9ncy5sb2dKREJDKCJzYXZlcG9p\nbnQ6ICIgKyBuYW1lLCBzdGFydCwgdGhpcyk7CiAgICAgICAgICAgICAgICBo\nYW5kbGVTUUxFcnJvcnMoZXJyKTsKICAgICAgICAgICAgfQogICAgICAgIH0K\nCiAgICAgICAgcHVibGljIHZvaWQgcm9sbGJhY2soU2F2ZXBvaW50IHNhdmVw\nb2ludCkgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgICAgIGxvbmcg\nc3RhcnQgPSBTeXN0ZW0uY3VycmVudFRpbWVNaWxsaXMoKTsKICAgICAgICAg\nICAgU1FMRXhjZXB0aW9uIGVyciA9IG51bGw7ICAgICAgICAgICAgCiAgICAg\nICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBzdXBlci5yb2xsYmFjayhz\nYXZlcG9pbnQpOwogICAgICAgICAgICB9IGNhdGNoIChTUUxFeGNlcHRpb24g\nc2UpIHsKICAgICAgICAgICAgICAgIGVyciA9IHNlOwogICAgICAgICAgICAg\nICAgdGhyb3cgc2U7CiAgICAgICAgICAgIH0gZmluYWxseSB7CiAgICAgICAg\nICAgICAgICBpZiAoX2xvZ3MuaXNKREJDRW5hYmxlZCgpKSB7CiAgICAgICAg\nICAgICAgICAgICAgU3RyaW5nIG5hbWUgPSBudWxsOwogICAgICAgICAgICAg\nICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWUgPSBz\nYXZlcG9pbnQuZ2V0U2F2ZXBvaW50TmFtZSgpOwogICAgICAgICAgICAgICAg\nICAgIH0gY2F0Y2ggKFNRTEV4Y2VwdGlvbiBzcWUpIHsKICAgICAgICAgICAg\nICAgICAgICAgICAgbmFtZSA9IFN0cmluZy52YWx1ZU9mKHNhdmVwb2ludC5n\nZXRTYXZlcG9pbnRJZCgpKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAg\nICAgICAgICAgICAgICAgX2xvZ3MubG9nSkRCQygicm9sbGJhY2s6ICIgKyBu\nYW1lLCBzdGFydCwgdGhpcyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAg\nICAgICAgICBoYW5kbGVTUUxFcnJvcnMoZXJyKTsKICAgICAgICAgICAgfQog\nICAgICAgIH0KCiAgICAgICAgcHVibGljIHZvaWQgcmVsZWFzZVNhdmVwb2lu\ndChTYXZlcG9pbnQgc2F2ZXBvaW50KSB0aHJvd3MgU1FMRXhjZXB0aW9uIHsK\nICAgICAgICAgICAgbG9uZyBzdGFydCA9IFN5c3RlbS5jdXJyZW50VGltZU1p\nbGxpcygpOwogICAgICAgICAgICBTUUxFeGNlcHRpb24gZXJyID0gbnVsbDsg\nICAgICAgICAgICAKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAg\nIHN1cGVyLnJlbGVhc2VTYXZlcG9pbnQoc2F2ZXBvaW50KTsKICAgICAgICAg\nICAgfSBjYXRjaCAoU1FMRXhjZXB0aW9uIHNlKSB7CiAgICAgICAgICAgICAg\nICBlcnIgPSBzZTsKICAgICAgICAgICAgICAgIHRocm93IHNlOwogICAgICAg\nICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICAgICAgaWYgKF9sb2dzLmlz\nSkRCQ0VuYWJsZWQoKSkgewogICAgICAgICAgICAgICAgICAgIFN0cmluZyBu\nYW1lID0gbnVsbDsKICAgICAgICAgICAgICAgICAgICB0cnkgewogICAgICAg\nICAgICAgICAgICAgICAgICBuYW1lID0gc2F2ZXBvaW50LmdldFNhdmVwb2lu\ndE5hbWUoKTsKICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChTUUxFeGNl\ncHRpb24gc3FlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWUgPSBT\ndHJpbmcudmFsdWVPZihzYXZlcG9pbnQuZ2V0U2F2ZXBvaW50SWQoKSk7CiAg\nICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIF9sb2dz\nLmxvZ0pEQkMoInJlbGVhc2U6ICIgKyBuYW1lLCBzdGFydCwgdGhpcyk7CiAg\nICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBoYW5kbGVTUUxFcnJv\ncnMoZXJyKTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgcHJv\ndGVjdGVkIFN0YXRlbWVudCBjcmVhdGVTdGF0ZW1lbnQoaW50IHJlc3VsdFNl\ndFR5cGUsCiAgICAgICAgICAgIGludCByZXN1bHRTZXRDb25jdXJyZW5jeSwg\naW50IHJlc3VsdFNldEhvbGRhYmlsaXR5LCBib29sZWFuIHdyYXApCiAgICAg\nICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgICAgICBTUUxF\neGNlcHRpb24gZXJyID0gbnVsbDsKICAgICAgICAgICAgdHJ5IHsKICAgICAg\nICAgICAgICAgIFN0YXRlbWVudCBzdG1udCA9IHN1cGVyLmNyZWF0ZVN0YXRl\nbWVudChyZXN1bHRTZXRUeXBlLAogICAgICAgICAgICAgICAgICAgIHJlc3Vs\ndFNldENvbmN1cnJlbmN5LCByZXN1bHRTZXRIb2xkYWJpbGl0eSwgZmFsc2Up\nOwogICAgICAgICAgICAgICAgcmV0dXJuIG5ld0xvZ2dpbmdTdGF0ZW1lbnQo\nc3RtbnQpOwogICAgICAgICAgICB9Y2F0Y2ggKFNRTEV4Y2VwdGlvbiBzZSkg\newogICAgICAgICAgICAgICAgZXJyID0gc2U7CiAgICAgICAgICAgICAgICB0\naHJvdyBzZTsKICAgICAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAg\nICAgIGhhbmRsZVNRTEVycm9ycyhlcnIpOwogICAgICAgICAgICB9CiAgICAg\nICAgfQoKICAgICAgICBwcm90ZWN0ZWQgUHJlcGFyZWRTdGF0ZW1lbnQgcHJl\ncGFyZVN0YXRlbWVudChTdHJpbmcgc3FsLAogICAgICAgICAgICBpbnQgcmVz\ndWx0U2V0VHlwZSwgaW50IHJlc3VsdFNldENvbmN1cnJlbmN5LAogICAgICAg\nICAgICBpbnQgcmVzdWx0U2V0SG9sZGFiaWxpdHksIGJvb2xlYW4gd3JhcCkg\ndGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgICAgIFNRTEV4Y2VwdGlv\nbiBlcnIgPSBudWxsOwogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAg\nICAgUHJlcGFyZWRTdGF0ZW1lbnQgc3RtbnQgPSBzdXBlci5wcmVwYXJlU3Rh\ndGVtZW50CiAgICAgICAgICAgICAgICAgICAgKHNxbCwgcmVzdWx0U2V0VHlw\nZSwgcmVzdWx0U2V0Q29uY3VycmVuY3ksCiAgICAgICAgICAgICAgICAgICAg\nICAgIHJlc3VsdFNldEhvbGRhYmlsaXR5LCBmYWxzZSk7CiAgICAgICAgICAg\nICAgICByZXR1cm4gbmV3TG9nZ2luZ1ByZXBhcmVkU3RhdGVtZW50KHN0bW50\nLCBzcWwpOwogICAgICAgICAgICB9IGNhdGNoIChTUUxFeGNlcHRpb24gc2Up\nIHsKICAgICAgICAgICAgICAgIGVyciA9IHdyYXAoc2UsIHNxbCk7CiAgICAg\nICAgICAgICAgICB0aHJvdyBlcnI7CiAgICAgICAgICAgIH0gZmluYWxseSB7\nCiAgICAgICAgICAgICAgICBoYW5kbGVTUUxFcnJvcnMoZXJyKTsKICAgICAg\nICAgICAgfQogICAgICAgIH0KCiAgICAgICAgcHJvdGVjdGVkIFByZXBhcmVk\nU3RhdGVtZW50IHByZXBhcmVTdGF0ZW1lbnQoU3RyaW5nIHNxbCwKICAgICAg\nICAgICAgaW50IGF1dG9HZW5lcmF0ZWRLZXlzLCBib29sZWFuIHdyYXApIHRo\ncm93cyBTUUxFeGNlcHRpb24gewogICAgICAgICAgICBTUUxFeGNlcHRpb24g\nZXJyID0gbnVsbDsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAg\nIFByZXBhcmVkU3RhdGVtZW50IHN0bW50ID0gc3VwZXIucHJlcGFyZVN0YXRl\nbWVudAogICAgICAgICAgICAgICAgICAgIChzcWwsIGF1dG9HZW5lcmF0ZWRL\nZXlzLCBmYWxzZSk7CiAgICAgICAgICAgICAgICByZXR1cm4gbmV3TG9nZ2lu\nZ1ByZXBhcmVkU3RhdGVtZW50KHN0bW50LCBzcWwpOwogICAgICAgICAgICB9\nIGNhdGNoIChTUUxFeGNlcHRpb24gc2UpIHsKICAgICAgICAgICAgICAgIGVy\nciA9IHdyYXAoc2UsIHNxbCk7CiAgICAgICAgICAgICAgICB0aHJvdyBlcnI7\nCiAgICAgICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgICAgICBoYW5k\nbGVTUUxFcnJvcnMoZXJyKTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAg\nICAgICAgcHJvdGVjdGVkIFByZXBhcmVkU3RhdGVtZW50IHByZXBhcmVTdGF0\nZW1lbnQoU3RyaW5nIHNxbCwKICAgICAgICAgICAgaW50W10gY29sdW1uSW5k\nZXhlcywgYm9vbGVhbiB3cmFwKSB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAg\nICAgICAgICAgU1FMRXhjZXB0aW9uIGVyciA9IG51bGw7CiAgICAgICAgICAg\nIHRyeSB7CiAgICAgICAgICAgICAgICBQcmVwYXJlZFN0YXRlbWVudCBzdG1u\ndCA9IHN1cGVyLnByZXBhcmVTdGF0ZW1lbnQKICAgICAgICAgICAgICAgICAg\nICAoc3FsLCBjb2x1bW5JbmRleGVzLCBmYWxzZSk7CiAgICAgICAgICAgICAg\nICByZXR1cm4gbmV3TG9nZ2luZ1ByZXBhcmVkU3RhdGVtZW50KHN0bW50LCBz\ncWwpOwogICAgICAgICAgICB9IGNhdGNoIChTUUxFeGNlcHRpb24gc2UpIHsK\nICAgICAgICAgICAgICAgIGVyciA9IHdyYXAoc2UsIHNxbCk7CiAgICAgICAg\nICAgICAgICB0aHJvdyBlcnI7CiAgICAgICAgICAgIH0gZmluYWxseSB7CiAg\nICAgICAgICAgICAgICBoYW5kbGVTUUxFcnJvcnMoZXJyKTsKICAgICAgICAg\nICAgfQogICAgICAgIH0KCiAgICAgICAgcHJvdGVjdGVkIFByZXBhcmVkU3Rh\ndGVtZW50IHByZXBhcmVTdGF0ZW1lbnQoU3RyaW5nIHNxbCwKICAgICAgICAg\nICAgU3RyaW5nW10gY29sdW1uTmFtZXMsIGJvb2xlYW4gd3JhcCkgdGhyb3dz\nIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgICAgIFNRTEV4Y2VwdGlvbiBlcnIg\nPSBudWxsOwogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgUHJl\ncGFyZWRTdGF0ZW1lbnQgc3RtbnQgPSBzdXBlci5wcmVwYXJlU3RhdGVtZW50\nCiAgICAgICAgICAgICAgICAgICAgKHNxbCwgY29sdW1uTmFtZXMsIGZhbHNl\nKTsKICAgICAgICAgICAgICAgIHJldHVybiBuZXdMb2dnaW5nUHJlcGFyZWRT\ndGF0ZW1lbnQoc3RtbnQsIHNxbCk7CiAgICAgICAgICAgIH0gY2F0Y2ggKFNR\nTEV4Y2VwdGlvbiBzZSkgewogICAgICAgICAgICAgICAgZXJyID0gd3JhcChz\nZSwgc3FsKTsKICAgICAgICAgICAgICAgIHRocm93IGVycjsKICAgICAgICAg\nICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgICAgIGhhbmRsZVNRTEVycm9y\ncyhlcnIpOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBwcm90\nZWN0ZWQgRGF0YWJhc2VNZXRhRGF0YSBnZXRNZXRhRGF0YShib29sZWFuIHdy\nYXApCiAgICAgICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAg\nICAgICByZXR1cm4gbmV3TG9nZ2luZ0RhdGFiYXNlTWV0YURhdGEoc3VwZXIu\nZ2V0TWV0YURhdGEoZmFsc2UpKTsKICAgICAgICB9CgogICAgICAgIC8qKgog\nICAgICAgICAqIExvZyB0aW1lIGVsYXBzZWQgc2luY2UgZ2l2ZW4gc3RhcnQu\nCiAgICAgICAgICovCiAgICAgICAgcHJpdmF0ZSB2b2lkIGxvZ1RpbWUobG9u\nZyBzdGFydFRpbWUpIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgICAg\nICBpZiAoX2xvZ3MuaXNTUUxFbmFibGVkKCkpCiAgICAgICAgICAgICAgICBf\nbG9ncy5sb2dTUUwoInNwZW50Iiwgc3RhcnRUaW1lLCB0aGlzKTsgCiAgICAg\nICAgfQoKICAgICAgICAvKioKICAgICAgICAgKiBMb2cgdGltZSBlbGFwc2Vk\nIHNpbmNlIGdpdmVuIHN0YXJ0LgogICAgICAgICAqLwogICAgICAgIHByaXZh\ndGUgdm9pZCBsb2dTUUwoU3RhdGVtZW50IHN0bW50KSB0aHJvd3MgU1FMRXhj\nZXB0aW9uIHsKICAgICAgICAgICAgaWYgKF9sb2dzLmlzU1FMRW5hYmxlZCgp\nKQogICAgICAgICAgICAgICAgX2xvZ3MubG9nU1FMKCJleGVjdXRpbmcgIiAr\nIHN0bW50LCB0aGlzKTsKICAgICAgICB9CgogICAgICAgIC8qKgogICAgICAg\nICAqIExvZyB0aW1lIGVsYXBzZWQgc2luY2UgZ2l2ZW4gc3RhcnQuCiAgICAg\nICAgICovCiAgICAgICAgcHJpdmF0ZSB2b2lkIGxvZ0JhdGNoU1FMKFN0YXRl\nbWVudCBzdG1udCkgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgICAg\nIGlmIChfbG9ncy5pc1NRTEVuYWJsZWQoKSkKICAgICAgICAgICAgICAgIF9s\nb2dzLmxvZ1NRTCgiZXhlY3V0aW5nIGJhdGNoICIgKyBzdG1udCwgdGhpcyk7\nCiAgICAgICAgfQogICAgICAgIAogICAgICAgIC8qKgogICAgICAgICAqIEhh\nbmRsZSBhbnkge0BsaW5rIFNRTFdhcm5pbmd9cyBvbiB0aGUgY3VycmVudCB7\nQGxpbmsgQ29ubmVjdGlvbn0uCiAgICAgICAgICogQ2hhaW4gdGhyb3dlZCBT\nUUxXYXJuaW5ncyB0byBTUUxFeGNlcHRpb24uCiAgICAgICAgICogQHNlZSAj\naGFuZGxlU1FMV2FybmluZyhTUUxXYXJuaW5nKQogICAgICAgICAqLwogICAg\nICAgIHByaXZhdGUgdm9pZCBoYW5kbGVTUUxFcnJvcnMoU1FMRXhjZXB0aW9u\nIGVycikgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgICAgIGlmIChf\nd2FybmluZ0FjdGlvbiA9PSBXQVJOX0lHTk9SRSkKICAgICAgICAgICAgICAg\nIHJldHVybjsKCiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBo\nYW5kbGVTUUxXYXJuaW5nKGdldFdhcm5pbmdzKCkpOwogICAgICAgICAgICB9\nIGNhdGNoIChTUUxFeGNlcHRpb24gd2FybmluZykgewogICAgICAgICAgICAg\nICAgaWYgKGVyciAhPSBudWxsKQogICAgICAgICAgICAgICAgICAgIGVyci5z\nZXROZXh0RXhjZXB0aW9uKHdhcm5pbmcpOwogICAgICAgICAgICAgICAgZWxz\nZQogICAgICAgICAgICAgICAgICAgIHRocm93IHdhcm5pbmc7CiAgICAgICAg\nICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgICAgICBjbGVhcldhcm5pbmdz\nKCk7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIC8qKgogICAg\nICAgICAqIEhhbmRsZSBhbnkge0BsaW5rIFNRTFdhcm5pbmd9cyBvbiB0aGUg\nc3BlY2lmaWVkIHtAbGluayBTdGF0ZW1lbnR9LgogICAgICAgICAqIENoYWlu\nIHRocm93ZWQgU1FMV2FybmluZ3MgdG8gU1FMRXhjZXB0aW9uLgogICAgICAg\nICAqCiAgICAgICAgICogQHNlZSAjaGFuZGxlU1FMV2FybmluZyhTUUxXYXJu\naW5nKQogICAgICAgICAqLwogICAgICAgIHByaXZhdGUgdm9pZCBoYW5kbGVT\nUUxFcnJvcnMoU3RhdGVtZW50IHN0bW50LCBTUUxFeGNlcHRpb24gZXJyKSAK\nICAgICAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgICAg\nIGlmIChfd2FybmluZ0FjdGlvbiA9PSBXQVJOX0lHTk9SRSkKICAgICAgICAg\nICAgICAgIHJldHVybjsgCiAgICAgICAgICAgIAogICAgICAgICAgICB0cnkg\newogICAgICAgICAgICAgICAgaGFuZGxlU1FMV2FybmluZyhzdG1udC5nZXRX\nYXJuaW5ncygpKTsKICAgICAgICAgICAgfSBjYXRjaCAoU1FMRXhjZXB0aW9u\nIHdhcm5pbmcpIHsKICAgICAgICAgICAgICAgIGlmIChlcnIgIT0gbnVsbCkK\nICAgICAgICAgICAgICAgICAgICBlcnIuc2V0TmV4dEV4Y2VwdGlvbih3YXJu\naW5nKTsKICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAg\nICB0aHJvdyB3YXJuaW5nOwogICAgICAgICAgICB9IGZpbmFsbHkgewogICAg\nICAgICAgICAgICAgc3RtbnQuY2xlYXJXYXJuaW5ncygpOwogICAgICAgICAg\nICB9CiAgICAgICAgfSAgICAgICAgCiAgICAgICAgCiAgICAgICAgLyoqCiAg\nICAgICAgICogSGFuZGxlIGFueSB7QGxpbmsgU1FMV2FybmluZ31zIG9uIHRo\nZSBzcGVjaWZpZWQge0BsaW5rIFJlc3VsdFNldH0uCiAgICAgICAgICogQ2hh\naW4gdGhyb3dlZCBTUUxXYXJuaW5ncyB0byBTUUxFeGNlcHRpb24uCiAgICAg\nICAgICogCiAgICAgICAgICogQHNlZSAjaGFuZGxlU1FMV2FybmluZyhTUUxX\nYXJuaW5nKQogICAgICAgICAqLwogICAgICAgIHByaXZhdGUgdm9pZCBoYW5k\nbGVTUUxFcnJvcnMoUmVzdWx0U2V0IHJzLCBTUUxFeGNlcHRpb24gZXJyKSAK\nICAgICAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgICAg\nIGlmIChfd2FybmluZ0FjdGlvbiA9PSBXQVJOX0lHTk9SRSkKICAgICAgICAg\nICAgICAgIHJldHVybjsKICAgICAgICAgICAgCiAgICAgICAgICAgIHRyeSB7\nCiAgICAgICAgICAgICAgICBoYW5kbGVTUUxXYXJuaW5nKHJzLmdldFdhcm5p\nbmdzKCkpOwogICAgICAgICAgICB9IGNhdGNoIChTUUxFeGNlcHRpb24gd2Fy\nbmluZyl7CiAgICAgICAgICAgICAgICBpZiAoZXJyICE9IG51bGwpCiAgICAg\nICAgICAgICAgICAgICAgZXJyLnNldE5leHRFeGNlcHRpb24od2FybmluZyk7\nCiAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgdGhy\nb3cgd2FybmluZzsKICAgICAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAg\nICAgICAgIHJzLmNsZWFyV2FybmluZ3MoKTsKICAgICAgICAgICAgfQogICAg\nICAgIH0KICAgICAgICAKICAgICAgICAvKioKICAgICAgICAgKiBIYW5kbGUg\ndGhlIHNwZWNpZmllZCB7QGxpbmsgU1FMV2FybmluZ30gZGVwZW5kaW5nIG9u\nIHRoZQogICAgICAgICAqIHNldHRpbmcgb2YgdGhlIHtAbGluayAjc2V0V2Fy\nbmluZ0FjdGlvbn0gYXR0cmlidXRlLgogICAgICAgICAqCiAgICAgICAgICog\nQHBhcmFtIHdhcm5pbmcgdGhlIHdhcm5pbmcgdG8gaGFuZGxlCiAgICAgICAg\nICovCiAgICAgICAgcHJpdmF0ZSB2b2lkIGhhbmRsZVNRTFdhcm5pbmcoU1FM\nV2FybmluZyB3YXJuaW5nKSB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAg\nICAgICAgaWYgKHdhcm5pbmcgPT0gbnVsbCkKICAgICAgICAgICAgICAgIHJl\ndHVybjsKICAgICAgICAgICAgaWYgKF93YXJuaW5nQWN0aW9uID09IFdBUk5f\nSUdOT1JFKQogICAgICAgICAgICAgICAgcmV0dXJuOwoKICAgICAgICAgICAg\nTG9nIGxvZyA9IF9sb2dzLmdldEpEQkNMb2coKTsKICAgICAgICAgICAgZm9y\nICg7IHdhcm5pbmcgIT0gbnVsbDsgd2FybmluZyA9IHdhcm5pbmcuZ2V0TmV4\ndFdhcm5pbmcoKSkgewogICAgICAgICAgICAgICAgc3dpdGNoIChfd2Fybmlu\nZ0FjdGlvbikgewogICAgICAgICAgICAgICAgICAgIGNhc2UgV0FSTl9MT0df\nVFJBQ0U6CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChsb2cuaXNUcmFj\nZUVuYWJsZWQoKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvZy50\ncmFjZSh3YXJuaW5nKTsKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7\nCiAgICAgICAgICAgICAgICAgICAgY2FzZSBXQVJOX0xPR19JTkZPOgogICAg\nICAgICAgICAgICAgICAgICAgICBpZiAobG9nLmlzSW5mb0VuYWJsZWQoKSkK\nICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvZy5pbmZvKHdhcm5pbmcp\nOwogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAg\nICAgICAgICBjYXNlIFdBUk5fTE9HX1dBUk46CiAgICAgICAgICAgICAgICAg\nICAgICAgIGlmIChsb2cuaXNXYXJuRW5hYmxlZCgpKQogICAgICAgICAgICAg\nICAgICAgICAgICAgICAgbG9nLndhcm4od2FybmluZyk7CiAgICAgICAgICAg\nICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIGNhc2Ug\nV0FSTl9MT0dfRVJST1I6CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChs\nb2cuaXNFcnJvckVuYWJsZWQoKSkKICAgICAgICAgICAgICAgICAgICAgICAg\nICAgIGxvZy5lcnJvcih3YXJuaW5nKTsKICAgICAgICAgICAgICAgICAgICAg\nICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgY2FzZSBXQVJOX1RIUk9X\nOgogICAgICAgICAgICAgICAgICAgICAgICAvLyBqdXN0IHRocm93IGl0IGFz\nIGlmIGl0IHdlcmUgYSBTUUxFeGNlcHRpb24KICAgICAgICAgICAgICAgICAg\nICAgICAgdGhyb3cgd2FybmluZzsKICAgICAgICAgICAgICAgICAgICBjYXNl\nIFdBUk5fSEFORExFOgogICAgICAgICAgICAgICAgICAgICAgICBpZiAoX3dh\ncm5pbmdIYW5kbGVyICE9IG51bGwpCiAgICAgICAgICAgICAgICAgICAgICAg\nICAgICBfd2FybmluZ0hhbmRsZXIuaGFuZGxlV2FybmluZyh3YXJuaW5nKTsK\nICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAg\nICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAgICAgICAgICAgLy8gaWdu\nb3JlCiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAg\nICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAvKioK\nICAgICAgICAgKiBNZXRhZGF0YSB3cmFwcGVyIHRoYXQgbG9ncyBhY3Rpb25z\nLgogICAgICAgICAqLwogICAgICAgIHByb3RlY3RlZCBhYnN0cmFjdCBjbGFz\ncyBMb2dnaW5nRGF0YWJhc2VNZXRhRGF0YQogICAgICAgICAgICBleHRlbmRz\nIERlbGVnYXRpbmdEYXRhYmFzZU1ldGFEYXRhIHsKCiAgICAgICAgICAgIHB1\nYmxpYyBMb2dnaW5nRGF0YWJhc2VNZXRhRGF0YShEYXRhYmFzZU1ldGFEYXRh\nIG1ldGEpIHsKICAgICAgICAgICAgICAgIHN1cGVyKG1ldGEsIExvZ2dpbmdD\nb25uZWN0aW9uLnRoaXMpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBw\ndWJsaWMgUmVzdWx0U2V0IGdldEJlc3RSb3dJZGVudGlmaWVyKFN0cmluZyBj\nYXRhbG9nLAogICAgICAgICAgICAgICAgU3RyaW5nIHNjaGVtYSwgU3RyaW5n\nIHRhYmxlLCBpbnQgc2NvcGUsIGJvb2xlYW4gbnVsbGFibGUpCiAgICAgICAg\nICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAgICAgICAg\nIGlmIChfbG9ncy5pc0pEQkNFbmFibGVkKCkpCiAgICAgICAgICAgICAgICAg\nICAgX2xvZ3MubG9nSkRCQygiZ2V0QmVzdFJvd0lkZW50aWZpZXI6ICIKICAg\nICAgICAgICAgICAgICAgICAgICAgKyBjYXRhbG9nICsgIiwgIiArIHNjaGVt\nYSArICIsICIgKyB0YWJsZSwKICAgICAgICAgICAgICAgICAgICAgICAgTG9n\nZ2luZ0Nvbm5lY3Rpb24udGhpcyk7CiAgICAgICAgICAgICAgICByZXR1cm4g\nc3VwZXIuZ2V0QmVzdFJvd0lkZW50aWZpZXIoY2F0YWxvZywgc2NoZW1hLAog\nICAgICAgICAgICAgICAgICAgIHRhYmxlLCBzY29wZSwgbnVsbGFibGUpOwog\nICAgICAgICAgICB9CgogICAgICAgICAgICBwdWJsaWMgUmVzdWx0U2V0IGdl\ndENhdGFsb2dzKCkgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgICAg\nICAgICBpZiAoX2xvZ3MuaXNKREJDRW5hYmxlZCgpKQogICAgICAgICAgICAg\nICAgICAgIF9sb2dzLmxvZ0pEQkMoImdldENhdGFsb2dzIiwgTG9nZ2luZ0Nv\nbm5lY3Rpb24udGhpcyk7CiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIu\nZ2V0Q2F0YWxvZ3MoKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHVi\nbGljIFJlc3VsdFNldCBnZXRDb2x1bW5Qcml2aWxlZ2VzKFN0cmluZyBjYXRh\nbG9nLCBTdHJpbmcgc2NoZW1hLAogICAgICAgICAgICAgICAgU3RyaW5nIHRh\nYmxlLCBTdHJpbmcgY29sdW1uTmFtZVBhdHRlcm4pIHRocm93cyBTUUxFeGNl\ncHRpb24gewogICAgICAgICAgICAgICAgaWYgKF9sb2dzLmlzSkRCQ0VuYWJs\nZWQoKSkKICAgICAgICAgICAgICAgICAgICBfbG9ncy5sb2dKREJDKCJnZXRD\nb2x1bW5Qcml2aWxlZ2VzOiAiCiAgICAgICAgICAgICAgICAgICAgICAgICsg\nY2F0YWxvZyArICIsICIgKyBzY2hlbWEgKyAiLCAiICsgdGFibGUsCiAgICAg\nICAgICAgICAgICAgICAgICAgIExvZ2dpbmdDb25uZWN0aW9uLnRoaXMpOwog\nICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmdldENvbHVtblByaXZpbGVn\nZXMoY2F0YWxvZywgc2NoZW1hLAogICAgICAgICAgICAgICAgICAgIHRhYmxl\nLCBjb2x1bW5OYW1lUGF0dGVybik7CiAgICAgICAgICAgIH0KCiAgICAgICAg\nICAgIHB1YmxpYyBSZXN1bHRTZXQgZ2V0Q29sdW1ucyhTdHJpbmcgY2F0YWxv\nZywgU3RyaW5nIHNjaGVtYVBhdHRlcm4sCiAgICAgICAgICAgICAgICBTdHJp\nbmcgdGFibGVOYW1lUGF0dGVybiwgU3RyaW5nIGNvbHVtbk5hbWVQYXR0ZXJu\nKQogICAgICAgICAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAg\nICAgICAgICAgICBpZiAoX2xvZ3MuaXNKREJDRW5hYmxlZCgpKQogICAgICAg\nICAgICAgICAgICAgIF9sb2dzLmxvZ0pEQkMoImdldENvbHVtbnM6ICIKICAg\nICAgICAgICAgICAgICAgICAgICAgKyBjYXRhbG9nICsgIiwgIiArIHNjaGVt\nYVBhdHRlcm4gKyAiLCAiCiAgICAgICAgICAgICAgICAgICAgICAgICsgdGFi\nbGVOYW1lUGF0dGVybiArICIsICIgKyBjb2x1bW5OYW1lUGF0dGVybiwKICAg\nICAgICAgICAgICAgICAgICAgICAgTG9nZ2luZ0Nvbm5lY3Rpb24udGhpcyk7\nCiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZ2V0Q29sdW1ucyhjYXRh\nbG9nLCBzY2hlbWFQYXR0ZXJuLAogICAgICAgICAgICAgICAgICAgIHRhYmxl\nTmFtZVBhdHRlcm4sIGNvbHVtbk5hbWVQYXR0ZXJuKTsKICAgICAgICAgICAg\nfQoKICAgICAgICAgICAgcHVibGljIFJlc3VsdFNldCBnZXRDcm9zc1JlZmVy\nZW5jZShTdHJpbmcgcHJpbWFyeUNhdGFsb2csCiAgICAgICAgICAgICAgICBT\ndHJpbmcgcHJpbWFyeVNjaGVtYSwgU3RyaW5nIHByaW1hcnlUYWJsZSwKICAg\nICAgICAgICAgICAgIFN0cmluZyBmb3JlaWduQ2F0YWxvZywgU3RyaW5nIGZv\ncmVpZ25TY2hlbWEsCiAgICAgICAgICAgICAgICBTdHJpbmcgZm9yZWlnblRh\nYmxlKSB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAgICAgICAgIGlm\nIChfbG9ncy5pc0pEQkNFbmFibGVkKCkpCiAgICAgICAgICAgICAgICAgICAg\nX2xvZ3MubG9nSkRCQygiZ2V0Q3Jvc3NSZWZlcmVuY2U6ICIKICAgICAgICAg\nICAgICAgICAgICAgICAgKyBwcmltYXJ5Q2F0YWxvZyArICIsICIgKyBwcmlt\nYXJ5U2NoZW1hICsgIiwgIgogICAgICAgICAgICAgICAgICAgICAgICArIHBy\naW1hcnlUYWJsZSArICIsICIgKyBmb3JlaWduQ2F0YWxvZyArICIsICIKICAg\nICAgICAgICAgICAgICAgICAgICAgKyBmb3JlaWduU2NoZW1hICsgIiwgIiAr\nIGZvcmVpZ25TY2hlbWEsCiAgICAgICAgICAgICAgICAgICAgICAgIExvZ2dp\nbmdDb25uZWN0aW9uLnRoaXMpOwogICAgICAgICAgICAgICAgcmV0dXJuIHN1\ncGVyLmdldENyb3NzUmVmZXJlbmNlKHByaW1hcnlDYXRhbG9nLCBwcmltYXJ5\nU2NoZW1hLAogICAgICAgICAgICAgICAgICAgIHByaW1hcnlUYWJsZSwgZm9y\nZWlnbkNhdGFsb2csIGZvcmVpZ25TY2hlbWEsIGZvcmVpZ25UYWJsZSk7CiAg\nICAgICAgICAgIH0KCiAgICAgICAgICAgIHB1YmxpYyBSZXN1bHRTZXQgZ2V0\nRXhwb3J0ZWRLZXlzKFN0cmluZyBjYXRhbG9nLCBTdHJpbmcgc2NoZW1hLAog\nICAgICAgICAgICAgICAgU3RyaW5nIHRhYmxlKSB0aHJvd3MgU1FMRXhjZXB0\naW9uIHsKICAgICAgICAgICAgICAgIGlmIChfbG9ncy5pc0pEQkNFbmFibGVk\nKCkpCiAgICAgICAgICAgICAgICAgICAgX2xvZ3MubG9nSkRCQygiZ2V0RXhw\nb3J0ZWRLZXlzOiAiCiAgICAgICAgICAgICAgICAgICAgICAgICsgY2F0YWxv\nZyArICIsICIgKyBzY2hlbWEgKyAiLCAiICsgdGFibGUsCiAgICAgICAgICAg\nICAgICAgICAgICAgIExvZ2dpbmdDb25uZWN0aW9uLnRoaXMpOwogICAgICAg\nICAgICAgICAgcmV0dXJuIHN1cGVyLmdldEV4cG9ydGVkS2V5cyhjYXRhbG9n\nLCBzY2hlbWEsIHRhYmxlKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAg\ncHVibGljIFJlc3VsdFNldCBnZXRJbXBvcnRlZEtleXMoU3RyaW5nIGNhdGFs\nb2csIFN0cmluZyBzY2hlbWEsCiAgICAgICAgICAgICAgICBTdHJpbmcgdGFi\nbGUpIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgICAgICAgICAgaWYg\nKF9sb2dzLmlzSkRCQ0VuYWJsZWQoKSkKICAgICAgICAgICAgICAgICAgICBf\nbG9ncy5sb2dKREJDKCJnZXRJbXBvcnRlZEtleXM6ICIKICAgICAgICAgICAg\nICAgICAgICAgICAgKyBjYXRhbG9nICsgIiwgIiArIHNjaGVtYSArICIsICIg\nKyB0YWJsZSwKICAgICAgICAgICAgICAgICAgICAgICAgTG9nZ2luZ0Nvbm5l\nY3Rpb24udGhpcyk7CiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZ2V0\nSW1wb3J0ZWRLZXlzKGNhdGFsb2csIHNjaGVtYSwgdGFibGUpOwogICAgICAg\nICAgICB9CgogICAgICAgICAgICBwdWJsaWMgUmVzdWx0U2V0IGdldEluZGV4\nSW5mbyhTdHJpbmcgY2F0YWxvZywgU3RyaW5nIHNjaGVtYSwKICAgICAgICAg\nICAgICAgIFN0cmluZyB0YWJsZSwgYm9vbGVhbiB1bmlxdWUsIGJvb2xlYW4g\nYXBwcm94aW1hdGUpCiAgICAgICAgICAgICAgICB0aHJvd3MgU1FMRXhjZXB0\naW9uIHsKICAgICAgICAgICAgICAgIGlmIChfbG9ncy5pc0pEQkNFbmFibGVk\nKCkpCiAgICAgICAgICAgICAgICAgICAgX2xvZ3MubG9nSkRCQygiZ2V0SW5k\nZXhJbmZvOiAiCiAgICAgICAgICAgICAgICAgICAgICAgICsgY2F0YWxvZyAr\nICIsICIgKyBzY2hlbWEgKyAiLCAiICsgdGFibGUsCiAgICAgICAgICAgICAg\nICAgICAgICAgIExvZ2dpbmdDb25uZWN0aW9uLnRoaXMpOwogICAgICAgICAg\nICAgICAgcmV0dXJuIHN1cGVyLmdldEluZGV4SW5mbyhjYXRhbG9nLCBzY2hl\nbWEsIHRhYmxlLCB1bmlxdWUsCiAgICAgICAgICAgICAgICAgICAgYXBwcm94\naW1hdGUpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBwdWJsaWMgUmVz\ndWx0U2V0IGdldFByaW1hcnlLZXlzKFN0cmluZyBjYXRhbG9nLCBTdHJpbmcg\nc2NoZW1hLAogICAgICAgICAgICAgICAgU3RyaW5nIHRhYmxlKSB0aHJvd3Mg\nU1FMRXhjZXB0aW9uIHsKICAgICAgICAgICAgICAgIGlmIChfbG9ncy5pc0pE\nQkNFbmFibGVkKCkpCiAgICAgICAgICAgICAgICAgICAgX2xvZ3MubG9nSkRC\nQygiZ2V0UHJpbWFyeUtleXM6ICIKICAgICAgICAgICAgICAgICAgICAgICAg\nKyBjYXRhbG9nICsgIiwgIiArIHNjaGVtYSArICIsICIgKyB0YWJsZSwKICAg\nICAgICAgICAgICAgICAgICAgICAgTG9nZ2luZ0Nvbm5lY3Rpb24udGhpcyk7\nCiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZ2V0UHJpbWFyeUtleXMo\nY2F0YWxvZywgc2NoZW1hLCB0YWJsZSk7CiAgICAgICAgICAgIH0KCiAgICAg\nICAgICAgIHB1YmxpYyBSZXN1bHRTZXQgZ2V0UHJvY2VkdXJlQ29sdW1ucyhT\ndHJpbmcgY2F0YWxvZywKICAgICAgICAgICAgICAgIFN0cmluZyBzY2hlbWFQ\nYXR0ZXJuLCBTdHJpbmcgcHJvY2VkdXJlTmFtZVBhdHRlcm4sCiAgICAgICAg\nICAgICAgICBTdHJpbmcgY29sdW1uTmFtZVBhdHRlcm4pIHRocm93cyBTUUxF\neGNlcHRpb24gewogICAgICAgICAgICAgICAgaWYgKF9sb2dzLmlzSkRCQ0Vu\nYWJsZWQoKSkKICAgICAgICAgICAgICAgICAgICBfbG9ncy5sb2dKREJDKCJn\nZXRQcm9jZWR1cmVDb2x1bW5zOiAiCiAgICAgICAgICAgICAgICAgICAgICAg\nICsgY2F0YWxvZyArICIsICIgKyBzY2hlbWFQYXR0ZXJuICsgIiwgIgogICAg\nICAgICAgICAgICAgICAgICAgICArIHByb2NlZHVyZU5hbWVQYXR0ZXJuICsg\nIiwgIiArIGNvbHVtbk5hbWVQYXR0ZXJuLAogICAgICAgICAgICAgICAgICAg\nICAgICBMb2dnaW5nQ29ubmVjdGlvbi50aGlzKTsKICAgICAgICAgICAgICAg\nIHJldHVybiBzdXBlci5nZXRQcm9jZWR1cmVDb2x1bW5zKGNhdGFsb2csIHNj\naGVtYVBhdHRlcm4sCiAgICAgICAgICAgICAgICAgICAgcHJvY2VkdXJlTmFt\nZVBhdHRlcm4sIGNvbHVtbk5hbWVQYXR0ZXJuKTsKICAgICAgICAgICAgfQoK\nICAgICAgICAgICAgcHVibGljIFJlc3VsdFNldCBnZXRQcm9jZWR1cmVzKFN0\ncmluZyBjYXRhbG9nLAogICAgICAgICAgICAgICAgU3RyaW5nIHNjaGVtYVBh\ndHRlcm4sIFN0cmluZyBwcm9jZWR1cmVOYW1lUGF0dGVybikKICAgICAgICAg\nICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgICAgICAgICAg\naWYgKF9sb2dzLmlzSkRCQ0VuYWJsZWQoKSkKICAgICAgICAgICAgICAgICAg\nICBfbG9ncy5sb2dKREJDKCJnZXRQcm9jZWR1cmVzOiAiCiAgICAgICAgICAg\nICAgICAgICAgICAgICsgY2F0YWxvZyArICIsICIgKyBzY2hlbWFQYXR0ZXJu\nICsgIiwgIgogICAgICAgICAgICAgICAgICAgICAgICArIHByb2NlZHVyZU5h\nbWVQYXR0ZXJuLCBMb2dnaW5nQ29ubmVjdGlvbi50aGlzKTsKICAgICAgICAg\nICAgICAgIHJldHVybiBzdXBlci5nZXRQcm9jZWR1cmVzKGNhdGFsb2csIHNj\naGVtYVBhdHRlcm4sCiAgICAgICAgICAgICAgICAgICAgcHJvY2VkdXJlTmFt\nZVBhdHRlcm4pOwogICAgICAgICAgICB9CgogICAgICAgICAgICBwdWJsaWMg\nUmVzdWx0U2V0IGdldFNjaGVtYXMoKSB0aHJvd3MgU1FMRXhjZXB0aW9uIHsK\nICAgICAgICAgICAgICAgIGlmIChfbG9ncy5pc0pEQkNFbmFibGVkKCkpCiAg\nICAgICAgICAgICAgICAgICAgX2xvZ3MubG9nSkRCQygiZ2V0U2NoZW1hcyIs\nIExvZ2dpbmdDb25uZWN0aW9uLnRoaXMpOwogICAgICAgICAgICAgICAgcmV0\ndXJuIHN1cGVyLmdldFNjaGVtYXMoKTsKICAgICAgICAgICAgfQoKICAgICAg\nICAgICAgcHVibGljIFJlc3VsdFNldCBnZXRUYWJsZVByaXZpbGVnZXMoU3Ry\naW5nIGNhdGFsb2csCiAgICAgICAgICAgICAgICBTdHJpbmcgc2NoZW1hUGF0\ndGVybiwgU3RyaW5nIHRhYmxlTmFtZVBhdHRlcm4pCiAgICAgICAgICAgICAg\nICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAgICAgICAgIGlmIChf\nbG9ncy5pc0pEQkNFbmFibGVkKCkpCiAgICAgICAgICAgICAgICAgICAgX2xv\nZ3MubG9nSkRCQygiZ2V0VGFibGVQcml2aWxlZ2VzIiwgTG9nZ2luZ0Nvbm5l\nY3Rpb24udGhpcyk7CiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZ2V0\nVGFibGVQcml2aWxlZ2VzKGNhdGFsb2csIHNjaGVtYVBhdHRlcm4sCiAgICAg\nICAgICAgICAgICAgICAgdGFibGVOYW1lUGF0dGVybik7CiAgICAgICAgICAg\nIH0KCiAgICAgICAgICAgIHB1YmxpYyBSZXN1bHRTZXQgZ2V0VGFibGVzKFN0\ncmluZyBjYXRhbG9nLCBTdHJpbmcgc2NoZW1hUGF0dGVybiwKICAgICAgICAg\nICAgICAgIFN0cmluZyB0YWJsZU5hbWVQYXR0ZXJuLCBTdHJpbmdbXSB0eXBl\ncykgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgICAgICAgICBpZiAo\nX2xvZ3MuaXNKREJDRW5hYmxlZCgpKQogICAgICAgICAgICAgICAgICAgIF9s\nb2dzLmxvZ0pEQkMoImdldFRhYmxlczogIgogICAgICAgICAgICAgICAgICAg\nICAgICArIGNhdGFsb2cgKyAiLCAiICsgc2NoZW1hUGF0dGVybiArICIsICIK\nICAgICAgICAgICAgICAgICAgICAgICAgKyB0YWJsZU5hbWVQYXR0ZXJuLCBM\nb2dnaW5nQ29ubmVjdGlvbi50aGlzKTsKICAgICAgICAgICAgICAgIHJldHVy\nbiBzdXBlci5nZXRUYWJsZXMoY2F0YWxvZywgc2NoZW1hUGF0dGVybiwKICAg\nICAgICAgICAgICAgICAgICB0YWJsZU5hbWVQYXR0ZXJuLCB0eXBlcyk7CiAg\nICAgICAgICAgIH0KCiAgICAgICAgICAgIHB1YmxpYyBSZXN1bHRTZXQgZ2V0\nVGFibGVUeXBlcygpIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgICAg\nICAgICAgaWYgKF9sb2dzLmlzSkRCQ0VuYWJsZWQoKSkKICAgICAgICAgICAg\nICAgICAgICBfbG9ncy5sb2dKREJDKCJnZXRUYWJsZVR5cGVzIiwgTG9nZ2lu\nZ0Nvbm5lY3Rpb24udGhpcyk7CiAgICAgICAgICAgICAgICByZXR1cm4gc3Vw\nZXIuZ2V0VGFibGVUeXBlcygpOwogICAgICAgICAgICB9CgogICAgICAgICAg\nICBwdWJsaWMgUmVzdWx0U2V0IGdldFR5cGVJbmZvKCkgdGhyb3dzIFNRTEV4\nY2VwdGlvbiB7CiAgICAgICAgICAgICAgICBpZiAoX2xvZ3MuaXNKREJDRW5h\nYmxlZCgpKQogICAgICAgICAgICAgICAgICAgIF9sb2dzLmxvZ0pEQkMoImdl\ndFR5cGVJbmZvIiwgTG9nZ2luZ0Nvbm5lY3Rpb24udGhpcyk7CiAgICAgICAg\nICAgICAgICByZXR1cm4gc3VwZXIuZ2V0VHlwZUluZm8oKTsKICAgICAgICAg\nICAgfQoKICAgICAgICAgICAgcHVibGljIFJlc3VsdFNldCBnZXRVRFRzKFN0\ncmluZyBjYXRhbG9nLCBTdHJpbmcgc2NoZW1hUGF0dGVybiwKICAgICAgICAg\nICAgICAgIFN0cmluZyB0eXBlTmFtZVBhdHRlcm4sIGludFtdIHR5cGVzKSB0\naHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAgICAgICAgIGlmIChfbG9n\ncy5pc0pEQkNFbmFibGVkKCkpCiAgICAgICAgICAgICAgICAgICAgX2xvZ3Mu\nbG9nSkRCQygiZ2V0VURUcyIsIExvZ2dpbmdDb25uZWN0aW9uLnRoaXMpOwog\nICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmdldFVEVHMoY2F0YWxvZywg\nc2NoZW1hUGF0dGVybiwKICAgICAgICAgICAgICAgICAgICB0eXBlTmFtZVBh\ndHRlcm4sIHR5cGVzKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHVi\nbGljIFJlc3VsdFNldCBnZXRWZXJzaW9uQ29sdW1ucyhTdHJpbmcgY2F0YWxv\nZywKICAgICAgICAgICAgICAgIFN0cmluZyBzY2hlbWEsIFN0cmluZyB0YWJs\nZSkgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgICAgICAgICBpZiAo\nX2xvZ3MuaXNKREJDRW5hYmxlZCgpKQogICAgICAgICAgICAgICAgICAgIF9s\nb2dzLmxvZ0pEQkMoImdldFZlcnNpb25Db2x1bW5zOiAiCiAgICAgICAgICAg\nICAgICAgICAgICAgICsgY2F0YWxvZyArICIsICIgKyBzY2hlbWEgKyAiLCAi\nICsgdGFibGUsCiAgICAgICAgICAgICAgICAgICAgICAgIExvZ2dpbmdDb25u\nZWN0aW9uLnRoaXMpOwogICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmdl\ndFZlcnNpb25Db2x1bW5zKGNhdGFsb2csIHNjaGVtYSwgdGFibGUpOwogICAg\nICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAvKioKICAgICAgICAgKiBT\ndGF0ZW1lbnQgd3JhcHBlciB0aGF0IGxvZ3MgU1FMIHRvIHRoZSBwYXJlbnQg\nZGF0YSBzb3VyY2UgYW5kCiAgICAgICAgICogcmVtZW1iZXJzIHRoZSBsYXN0\nIHBpZWNlIG9mIFNRTCB0byBiZSBleGVjdXRlZCBvbiBpdC4KICAgICAgICAg\nKi8KICAgICAgICBwcm90ZWN0ZWQgYWJzdHJhY3QgY2xhc3MgTG9nZ2luZ1N0\nYXRlbWVudCBleHRlbmRzIERlbGVnYXRpbmdTdGF0ZW1lbnQgewoKICAgICAg\nICAgICAgcHJpdmF0ZSBTdHJpbmcgX3NxbCA9IG51bGw7CgogICAgICAgICAg\nICBwdWJsaWMgTG9nZ2luZ1N0YXRlbWVudChTdGF0ZW1lbnQgc3RtbnQpIHRo\ncm93cyBTUUxFeGNlcHRpb24gewogICAgICAgICAgICAgICAgc3VwZXIoc3Rt\nbnQsIExvZ2dpbmdDb25uZWN0aW9uLnRoaXMpOwogICAgICAgICAgICB9Cgog\nICAgICAgICAgICBwcml2YXRlIExvZ2dpbmdSZXN1bHRTZXQgbmV3TG9nZ2lu\nZ1Jlc3VsdFNldChSZXN1bHRTZXQgcnMsIFN0YXRlbWVudCBzdG1udCkgewog\nICAgICAgICAgICAgICAgcmV0dXJuIENvbmNyZXRlQ2xhc3NHZW5lcmF0b3Iu\nbmV3SW5zdGFuY2UobG9nZ2luZ1Jlc3VsdFNldEltcGwsIExvZ2dpbmdDb25u\nZWN0aW9uLnRoaXMsIHJzLCBzdG1udCk7CiAgICAgICAgICAgIH0KCiAgICAg\nICAgICAgIHB1YmxpYyB2b2lkIGFwcGVuZEluZm8oU3RyaW5nQnVmZmVyIGJ1\nZikgewogICAgICAgICAgICAgICAgaWYgKF9zcWwgIT0gbnVsbCkgewogICAg\nICAgICAgICAgICAgICAgIGJ1Zi5hcHBlbmQoIiAiKTsKICAgICAgICAgICAg\nICAgICAgICBpZiAoX2Zvcm1hdHRlciAhPSBudWxsKSB7CiAgICAgICAgICAg\nICAgICAgICAgICAgIGJ1Zi5hcHBlbmQoU0VQKTsKICAgICAgICAgICAgICAg\nICAgICAgICAgYnVmLmFwcGVuZChfZm9ybWF0dGVyLnByZXR0eVByaW50KF9z\ncWwpKTsKICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAg\nICAgICAgICAgICAgICBidWYuYXBwZW5kKF9zcWwpOwogICAgICAgICAgICAg\nICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAg\nICAgICAgICAgcHJvdGVjdGVkIFJlc3VsdFNldCB3cmFwUmVzdWx0KFJlc3Vs\ndFNldCBycywgYm9vbGVhbiB3cmFwKSB7CiAgICAgICAgICAgICAgICBpZiAo\nIXdyYXAgfHwgcnMgPT0gbnVsbCkKICAgICAgICAgICAgICAgICAgICByZXR1\ncm4gc3VwZXIud3JhcFJlc3VsdChycywgd3JhcCk7CiAgICAgICAgICAgICAg\nICByZXR1cm4gbmV3TG9nZ2luZ1Jlc3VsdFNldChycywgdGhpcyk7CiAgICAg\nICAgICAgIH0KCiAgICAgICAgICAgIHB1YmxpYyB2b2lkIGNhbmNlbCgpIHRo\ncm93cyBTUUxFeGNlcHRpb24gewogICAgICAgICAgICAgICAgaWYgKF9sb2dz\nLmlzSkRCQ0VuYWJsZWQoKSkKICAgICAgICAgICAgICAgICAgICBfbG9ncy5s\nb2dKREJDKCJjYW5jZWwgIiArIHRoaXMsIExvZ2dpbmdDb25uZWN0aW9uLnRo\naXMpOwogICAgICAgICAgICAgICAgc3VwZXIuY2FuY2VsKCk7CiAgICAgICAg\nICAgIH0KCiAgICAgICAgICAgIHByb3RlY3RlZCBSZXN1bHRTZXQgZXhlY3V0\nZVF1ZXJ5KFN0cmluZyBzcWwsIGJvb2xlYW4gd3JhcCkKICAgICAgICAgICAg\nICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgICAgICAgICAgX3Nx\nbCA9IHNxbDsKICAgICAgICAgICAgICAgIGxvZ1NRTCh0aGlzKTsKICAgICAg\nICAgICAgICAgIGxvbmcgc3RhcnQgPSBTeXN0ZW0uY3VycmVudFRpbWVNaWxs\naXMoKTsKICAgICAgICAgICAgICAgIFNRTEV4Y2VwdGlvbiBlcnIgPSBudWxs\nOwogICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICBy\nZXR1cm4gc3VwZXIuZXhlY3V0ZVF1ZXJ5KHNxbCwgd3JhcCk7CiAgICAgICAg\nICAgICAgICB9IGNhdGNoIChTUUxFeGNlcHRpb24gc2UpIHsgICAgICAgICAg\nICAgICAJCiAgICAgICAgICAgICAgICAgICAgZXJyID0gd3JhcChzZSwgTG9n\nZ2luZ1N0YXRlbWVudC50aGlzLCBzcWwpOwogICAgICAgICAgICAgICAgICAg\nIHRocm93IGVycjsKICAgICAgICAgICAgICAgIH0gZmluYWxseSB7CiAgICAg\nICAgICAgICAgICAgICAgbG9nVGltZShzdGFydCk7CiAgICAgICAgICAgICAg\nICAgICAgaGFuZGxlU1FMRXJyb3JzKExvZ2dpbmdTdGF0ZW1lbnQudGhpcywg\nZXJyKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAg\nICAgICAgcHVibGljIGludCBleGVjdXRlVXBkYXRlKFN0cmluZyBzcWwpIHRo\ncm93cyBTUUxFeGNlcHRpb24gewogICAgICAgICAgICAgICAgX3NxbCA9IHNx\nbDsKICAgICAgICAgICAgICAgIGxvZ1NRTCh0aGlzKTsKICAgICAgICAgICAg\nICAgIGxvbmcgc3RhcnQgPSBTeXN0ZW0uY3VycmVudFRpbWVNaWxsaXMoKTsK\nICAgICAgICAgICAgICAgIFNRTEV4Y2VwdGlvbiBlcnIgPSBudWxsOwogICAg\nICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4g\nc3VwZXIuZXhlY3V0ZVVwZGF0ZShzcWwpOwogICAgICAgICAgICAgICAgfSBj\nYXRjaCAoU1FMRXhjZXB0aW9uIHNlKSB7ICAgICAgICAgICAgICAgIAkKICAg\nICAgICAgICAgICAgICAgICBlcnIgPSB3cmFwKHNlLCBMb2dnaW5nU3RhdGVt\nZW50LnRoaXMsIHNxbCk7CiAgICAgICAgICAgICAgICAgICAgdGhyb3cgZXJy\nOwogICAgICAgICAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgICAg\nICAgICBsb2dUaW1lKHN0YXJ0KTsKICAgICAgICAgICAgICAgICAgICBoYW5k\nbGVTUUxFcnJvcnMoTG9nZ2luZ1N0YXRlbWVudC50aGlzLCBlcnIpOwogICAg\nICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICBwdWJs\naWMgYm9vbGVhbiBleGVjdXRlKFN0cmluZyBzcWwpIHRocm93cyBTUUxFeGNl\ncHRpb24gewogICAgICAgICAgICAgICAgX3NxbCA9IHNxbDsKICAgICAgICAg\nICAgICAgIGxvZ1NRTCh0aGlzKTsKICAgICAgICAgICAgICAgIGxvbmcgc3Rh\ncnQgPSBTeXN0ZW0uY3VycmVudFRpbWVNaWxsaXMoKTsKICAgICAgICAgICAg\nICAgIFNRTEV4Y2VwdGlvbiBlcnIgPSBudWxsOwogICAgICAgICAgICAgICAg\ndHJ5IHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZXhlY3V0\nZShzcWwpOwogICAgICAgICAgICAgICAgfSBjYXRjaCAoU1FMRXhjZXB0aW9u\nIHNlKSB7CiAgICAgICAgICAgICAgICAgICAgZXJyID0gd3JhcChzZSwgTG9n\nZ2luZ1N0YXRlbWVudC50aGlzLCBzcWwpOwogICAgICAgICAgICAgICAgICAg\nIHRocm93IGVycjsKICAgICAgICAgICAgICAgIH0gZmluYWxseSB7CiAgICAg\nICAgICAgICAgICAgICAgbG9nVGltZShzdGFydCk7CiAgICAgICAgICAgICAg\nICAgICAgaGFuZGxlU1FMRXJyb3JzKExvZ2dpbmdTdGF0ZW1lbnQudGhpcywg\nZXJyKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAg\nIH0KCiAgICAgICAgcHJvdGVjdGVkIGFic3RyYWN0IGNsYXNzIExvZ2dpbmdQ\ncmVwYXJlZFN0YXRlbWVudAogICAgICAgICAgICBleHRlbmRzIERlbGVnYXRp\nbmdQcmVwYXJlZFN0YXRlbWVudCB7CgogICAgICAgICAgICBwcml2YXRlIGZp\nbmFsIFN0cmluZyBfc3FsOwogICAgICAgICAgICBwcml2YXRlIExpc3Q8U3Ry\naW5nPiBfcGFyYW1zID0gbnVsbDsKICAgICAgICAgICAgcHJpdmF0ZSBMaXN0\nPExpc3Q8U3RyaW5nPj4gX3BhcmFtQmF0Y2ggPSBudWxsOwoKICAgICAgICAg\nICAgcHVibGljIExvZ2dpbmdQcmVwYXJlZFN0YXRlbWVudChQcmVwYXJlZFN0\nYXRlbWVudCBzdG1udCwgU3RyaW5nIHNxbCkKICAgICAgICAgICAgICAgIHRo\ncm93cyBTUUxFeGNlcHRpb24gewogICAgICAgICAgICAgICAgc3VwZXIoc3Rt\nbnQsIExvZ2dpbmdDb25uZWN0aW9uLnRoaXMpOwogICAgICAgICAgICAgICAg\nX3NxbCA9IHNxbDsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHJpdmF0\nZSBMb2dnaW5nUmVzdWx0U2V0IG5ld0xvZ2dpbmdSZXN1bHRTZXQoUmVzdWx0\nU2V0IHJzLAogICAgICAgICAgICAgICAgUHJlcGFyZWRTdGF0ZW1lbnQgc3Rt\nbnQpIHsKICAgICAgICAgICAgICAgIHJldHVybiBDb25jcmV0ZUNsYXNzR2Vu\nZXJhdG9yLgogICAgICAgICAgICAgICAgICAgIG5ld0luc3RhbmNlKGxvZ2dp\nbmdSZXN1bHRTZXRJbXBsLAogICAgICAgICAgICAgICAgICAgIExvZ2dpbmdD\nb25uZWN0aW9uLmNsYXNzLCBMb2dnaW5nQ29ubmVjdGlvbi50aGlzLAogICAg\nICAgICAgICAgICAgICAgIFJlc3VsdFNldC5jbGFzcywgcnMsCiAgICAgICAg\nICAgICAgICAgICAgUHJlcGFyZWRTdGF0ZW1lbnQuY2xhc3MsIHN0bW50KTsK\nICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHJvdGVjdGVkIFJlc3VsdFNl\ndCB3cmFwUmVzdWx0KFJlc3VsdFNldCBycywgYm9vbGVhbiB3cmFwKSB7CiAg\nICAgICAgICAgICAgICBpZiAoIXdyYXAgfHwgcnMgPT0gbnVsbCkKICAgICAg\nICAgICAgICAgICAgICByZXR1cm4gc3VwZXIud3JhcFJlc3VsdChycywgd3Jh\ncCk7CiAgICAgICAgICAgICAgICByZXR1cm4gbmV3TG9nZ2luZ1Jlc3VsdFNl\ndChycywgdGhpcyk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHByb3Rl\nY3RlZCBSZXN1bHRTZXQgZXhlY3V0ZVF1ZXJ5KFN0cmluZyBzcWwsIGJvb2xl\nYW4gd3JhcCkKICAgICAgICAgICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24g\newogICAgICAgICAgICAgICAgbG9nU1FMKHRoaXMpOwogICAgICAgICAgICAg\nICAgbG9uZyBzdGFydCA9IFN5c3RlbS5jdXJyZW50VGltZU1pbGxpcygpOwog\nICAgICAgICAgICAgICAgU1FMRXhjZXB0aW9uIGVyciA9IG51bGw7CiAgICAg\nICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBz\ndXBlci5leGVjdXRlUXVlcnkoc3FsLCB3cmFwKTsKICAgICAgICAgICAgICAg\nIH0gY2F0Y2ggKFNRTEV4Y2VwdGlvbiBzZSkgewogICAgICAgICAgICAgICAg\nICAgIGVyciA9IHdyYXAoc2UsIExvZ2dpbmdQcmVwYXJlZFN0YXRlbWVudC50\naGlzLCBzcWwpOwogICAgICAgICAgICAgICAgICAgIHRocm93IGVycjsKICAg\nICAgICAgICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgICAgICAgICAg\nbG9nVGltZShzdGFydCk7CiAgICAgICAgICAgICAgICAgICAgY2xlYXJMb2dQ\nYXJhbWV0ZXJzKHRydWUpOwogICAgICAgICAgICAgICAgICAgIGhhbmRsZVNR\nTEVycm9ycyhMb2dnaW5nUHJlcGFyZWRTdGF0ZW1lbnQudGhpcywgZXJyKTsK\nICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAg\ncHVibGljIGludCBleGVjdXRlVXBkYXRlKFN0cmluZyBzcWwpIHRocm93cyBT\nUUxFeGNlcHRpb24gewogICAgICAgICAgICAgICAgbG9nU1FMKHRoaXMpOwog\nICAgICAgICAgICAgICAgbG9uZyBzdGFydCA9IFN5c3RlbS5jdXJyZW50VGlt\nZU1pbGxpcygpOwogICAgICAgICAgICAgICAgU1FMRXhjZXB0aW9uIGVyciA9\nIG51bGw7CiAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAg\nICAgIHJldHVybiBzdXBlci5leGVjdXRlVXBkYXRlKHNxbCk7CiAgICAgICAg\nICAgICAgICB9IGNhdGNoIChTUUxFeGNlcHRpb24gc2UpIHsKICAgICAgICAg\nICAgICAgICAgICBlcnIgPSAgd3JhcChzZSwgTG9nZ2luZ1ByZXBhcmVkU3Rh\ndGVtZW50LnRoaXMsIHNxbCk7CiAgICAgICAgICAgICAgICAgICAgdGhyb3cg\nZXJyOwogICAgICAgICAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAg\nICAgICAgICBsb2dUaW1lKHN0YXJ0KTsKICAgICAgICAgICAgICAgICAgICBj\nbGVhckxvZ1BhcmFtZXRlcnModHJ1ZSk7CiAgICAgICAgICAgICAgICAgICAg\naGFuZGxlU1FMRXJyb3JzKExvZ2dpbmdQcmVwYXJlZFN0YXRlbWVudC50aGlz\nLCBlcnIpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAg\nICAgICAgICBwdWJsaWMgYm9vbGVhbiBleGVjdXRlKFN0cmluZyBzcWwpIHRo\ncm93cyBTUUxFeGNlcHRpb24gewogICAgICAgICAgICAgICAgbG9nU1FMKHRo\naXMpOwogICAgICAgICAgICAgICAgbG9uZyBzdGFydCA9IFN5c3RlbS5jdXJy\nZW50VGltZU1pbGxpcygpOwogICAgICAgICAgICAgICAgU1FMRXhjZXB0aW9u\nIGVyciA9IG51bGw7CiAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAg\nICAgICAgICAgIHJldHVybiBzdXBlci5leGVjdXRlKHNxbCk7CiAgICAgICAg\nICAgICAgICB9IGNhdGNoIChTUUxFeGNlcHRpb24gc2UpIHsKICAgICAgICAg\nICAgICAgICAgICBlcnIgPSB3cmFwKHNlLCBMb2dnaW5nUHJlcGFyZWRTdGF0\nZW1lbnQudGhpcywgc3FsKTsKICAgICAgICAgICAgICAgICAgICB0aHJvdyBl\ncnI7CiAgICAgICAgICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICAg\nICAgICAgIGxvZ1RpbWUoc3RhcnQpOwogICAgICAgICAgICAgICAgICAgIGNs\nZWFyTG9nUGFyYW1ldGVycyh0cnVlKTsKICAgICAgICAgICAgICAgICAgICBo\nYW5kbGVTUUxFcnJvcnMoTG9nZ2luZ1ByZXBhcmVkU3RhdGVtZW50LnRoaXMs\nIGVycik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAg\nICAgICAgIHByb3RlY3RlZCBSZXN1bHRTZXQgZXhlY3V0ZVF1ZXJ5KGJvb2xl\nYW4gd3JhcCkgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgICAgICAg\nICBsb2dTUUwodGhpcyk7CiAgICAgICAgICAgICAgICBsb25nIHN0YXJ0ID0g\nU3lzdGVtLmN1cnJlbnRUaW1lTWlsbGlzKCk7CiAgICAgICAgICAgICAgICBT\nUUxFeGNlcHRpb24gZXJyID0gbnVsbDsKICAgICAgICAgICAgICAgIHRyeSB7\nCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmV4ZWN1dGVRdWVy\neSh3cmFwKTsKICAgICAgICAgICAgICAgIH0gY2F0Y2ggKFNRTEV4Y2VwdGlv\nbiBzZSkgewogICAgICAgICAgICAgICAgICAgIGVyciA9IHdyYXAoc2UsIExv\nZ2dpbmdQcmVwYXJlZFN0YXRlbWVudC50aGlzLCBfc3FsKTsKICAgICAgICAg\nICAgICAgICAgICB0aHJvdyBlcnI7CiAgICAgICAgICAgICAgICB9IGZpbmFs\nbHkgewogICAgICAgICAgICAgICAgICAgIGxvZ1RpbWUoc3RhcnQpOwogICAg\nICAgICAgICAgICAgICAgIGNsZWFyTG9nUGFyYW1ldGVycyh0cnVlKTsKICAg\nICAgICAgICAgICAgICAgICBoYW5kbGVTUUxFcnJvcnMoTG9nZ2luZ1ByZXBh\ncmVkU3RhdGVtZW50LnRoaXMsIGVycik7CiAgICAgICAgICAgICAgICB9CiAg\nICAgICAgICAgIH0KCiAgICAgICAgICAgIHB1YmxpYyBpbnQgZXhlY3V0ZVVw\nZGF0ZSgpIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgICAgICAgICAg\nbG9nU1FMKHRoaXMpOwogICAgICAgICAgICAgICAgbG9uZyBzdGFydCA9IFN5\nc3RlbS5jdXJyZW50VGltZU1pbGxpcygpOwogICAgICAgICAgICAgICAgU1FM\nRXhjZXB0aW9uIGVyciA9IG51bGw7CiAgICAgICAgICAgICAgICB0cnkgewog\nICAgICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5leGVjdXRlVXBkYXRl\nKCk7CiAgICAgICAgICAgICAgICB9IGNhdGNoIChTUUxFeGNlcHRpb24gc2Up\nIHsKICAgICAgICAgICAgICAgICAgICBlcnIgPSB3cmFwKHNlLCBMb2dnaW5n\nUHJlcGFyZWRTdGF0ZW1lbnQudGhpcyk7CiAgICAgICAgICAgICAgICAgICAg\ndGhyb3cgZXJyOwogICAgICAgICAgICAgICAgfSBmaW5hbGx5IHsKICAgICAg\nICAgICAgICAgICAgICBsb2dUaW1lKHN0YXJ0KTsKICAgICAgICAgICAgICAg\nICAgICBjbGVhckxvZ1BhcmFtZXRlcnModHJ1ZSk7CiAgICAgICAgICAgICAg\nICAgICAgaGFuZGxlU1FMRXJyb3JzKExvZ2dpbmdQcmVwYXJlZFN0YXRlbWVu\ndC50aGlzLCBlcnIpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9\nCgogICAgICAgICAgICBwdWJsaWMgaW50W10gZXhlY3V0ZUJhdGNoKCkgdGhy\nb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgICAgICAgICBsb2dCYXRjaFNR\nTCh0aGlzKTsKICAgICAgICAgICAgICAgIGxvbmcgc3RhcnQgPSBTeXN0ZW0u\nY3VycmVudFRpbWVNaWxsaXMoKTsKICAgICAgICAgICAgICAgIFNRTEV4Y2Vw\ndGlvbiBlcnIgPSBudWxsOwogICAgICAgICAgICAgICAgdHJ5IHsKICAgICAg\nICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZXhlY3V0ZUJhdGNoKCk7CiAg\nICAgICAgICAgICAgICB9IGNhdGNoIChTUUxFeGNlcHRpb24gc2UpIHsKICAg\nICAgICAgICAgICAgICAgICAvLyBpZiB0aGUgZXhjZXB0aW9uIGlzIGEgQmF0\nY2hVcGRhdGVFeGNlcHRpb24sIGFuZAogICAgICAgICAgICAgICAgICAgIC8v\nIHdlIGFyZSB0cmFja2luZyBwYXJhbWV0ZXJzLCB0aGVuIHNldCB0aGUgY3Vy\ncmVudAogICAgICAgICAgICAgICAgICAgIC8vIHBhcmFtZXRlciBzZXQgdG8g\nYmUgdGhlIGluZGV4IG9mIHRoZSBmYWlsZWQKICAgICAgICAgICAgICAgICAg\nICAvLyBzdGF0ZW1lbnQgc28gdGhhdCB0aGUgUmVwb3J0aW5nU1FMRXhjZXB0\naW9uIHdpbGwKICAgICAgICAgICAgICAgICAgICAvLyBzaG93IHRoZSBjb3Jy\nZWN0IHBhcmFtCiAgICAgICAgICAgICAgICAgICAgaWYgKHNlIGluc3RhbmNl\nb2YgQmF0Y2hVcGRhdGVFeGNlcHRpb24KICAgICAgICAgICAgICAgICAgICAg\nICAgJiYgX3BhcmFtQmF0Y2ggIT0gbnVsbCAmJiBzaG91bGRUcmFja1BhcmFt\nZXRlcnMoKSkgewogICAgICAgICAgICAgICAgICAgICAgICBpbnRbXSBjb3Vu\ndCA9ICgoQmF0Y2hVcGRhdGVFeGNlcHRpb24pIHNlKS4KICAgICAgICAgICAg\nICAgICAgICAgICAgICAgIGdldFVwZGF0ZUNvdW50cygpOwogICAgICAgICAg\nICAgICAgICAgICAgICBpZiAoY291bnQgIT0gbnVsbCAmJiBjb3VudC5sZW5n\ndGggPD0gX3BhcmFtQmF0Y2guc2l6ZSgpKQogICAgICAgICAgICAgICAgICAg\nICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnQgaW5kZXgg\nPSAtMTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoaW50IGkg\nPSAwOyBpIDwgY291bnQubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAvLyAtMyBpcyBTdGF0ZW1lbnQuU1RBVEVNRU5U\nX0ZBSUxFRCwgYnV0IGlzCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgLy8gb25seSBhdmFpbGFibGUgaW4gSkRLIDEuNCsKICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICBpZiAoY291bnRbaV0gPT0gU3RhdGVtZW50\nLkVYRUNVVEVfRkFJTEVEKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgIGluZGV4ID0gaTsKICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAg\nICAgICAgICAgICAgICAgICAgICAgIC8vIG5vIC0zIGVsZW1lbnQ6IGl0IG1h\neSBiZSB0aGF0IHRoZSBzZXJ2ZXIgc3RvcHBlZAogICAgICAgICAgICAgICAg\nICAgICAgICAgICAgLy8gcHJvY2Vzc2luZywgc28gdGhlIHNpemUgb2YgdGhl\nIGNvdW50IHdpbGwgYmUKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8v\nIHRoZSBpbmRleAogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlu\nZGV4ID09IC0xKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlu\nZGV4ID0gY291bnQubGVuZ3RoICsgMTsKCiAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAvLyBzZXQgdGhlIGN1cnJlbnQgcGFyYW1zIHRvIHRoZSBzYXZl\nZCB2YWx1ZXMKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpbmRl\neCA8IF9wYXJhbUJhdGNoLnNpemUoKSkKICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICBfcGFyYW1zID0gKExpc3Q8U3RyaW5nPikgX3BhcmFtQmF0\nY2guZ2V0KGluZGV4KTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAg\nICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBlcnIgPSB3\ncmFwKHNlLCBMb2dnaW5nUHJlcGFyZWRTdGF0ZW1lbnQudGhpcyk7CiAgICAg\nICAgICAgICAgICAgICAgdGhyb3cgZXJyOwogICAgICAgICAgICAgICAgfSBm\naW5hbGx5IHsKICAgICAgICAgICAgICAgICAgICBsb2dUaW1lKHN0YXJ0KTsK\nICAgICAgICAgICAgICAgICAgICBjbGVhckxvZ1BhcmFtZXRlcnModHJ1ZSk7\nCiAgICAgICAgICAgICAgICAgICAgaGFuZGxlU1FMRXJyb3JzKExvZ2dpbmdQ\ncmVwYXJlZFN0YXRlbWVudC50aGlzLCBlcnIpOwogICAgICAgICAgICAgICAg\nfQogICAgICAgICAgICB9CgogICAgICAgICAgICBwdWJsaWMgYm9vbGVhbiBl\neGVjdXRlKCkgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgICAgICAg\nICBsb2dTUUwodGhpcyk7CiAgICAgICAgICAgICAgICBsb25nIHN0YXJ0ID0g\nU3lzdGVtLmN1cnJlbnRUaW1lTWlsbGlzKCk7CiAgICAgICAgICAgICAgICBT\nUUxFeGNlcHRpb24gZXJyID0gbnVsbDsKICAgICAgICAgICAgICAgIHRyeSB7\nCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmV4ZWN1dGUoKTsK\nICAgICAgICAgICAgICAgIH0gY2F0Y2ggKFNRTEV4Y2VwdGlvbiBzZSkgewog\nICAgICAgICAgICAgICAgICAgIGVyciA9IHdyYXAoc2UsIExvZ2dpbmdQcmVw\nYXJlZFN0YXRlbWVudC50aGlzKTsKICAgICAgICAgICAgICAgICAgICB0aHJv\ndyBlcnI7CiAgICAgICAgICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAg\nICAgICAgICAgIGxvZ1RpbWUoc3RhcnQpOwogICAgICAgICAgICAgICAgICAg\nIGNsZWFyTG9nUGFyYW1ldGVycyh0cnVlKTsKICAgICAgICAgICAgICAgICAg\nICBoYW5kbGVTUUxFcnJvcnMoTG9nZ2luZ1ByZXBhcmVkU3RhdGVtZW50LnRo\naXMsIGVycik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAg\nICAgICAgICAgIHB1YmxpYyB2b2lkIGNhbmNlbCgpIHRocm93cyBTUUxFeGNl\ncHRpb24gewogICAgICAgICAgICAgICAgaWYgKF9sb2dzLmlzSkRCQ0VuYWJs\nZWQoKSkKICAgICAgICAgICAgICAgICAgICBfbG9ncy5sb2dKREJDKCJjYW5j\nZWwgIiArIHRoaXMgKyAiOiAiICsgX3NxbCwKICAgICAgICAgICAgICAgICAg\nICAgICAgTG9nZ2luZ0Nvbm5lY3Rpb24udGhpcyk7CgogICAgICAgICAgICAg\nICAgc3VwZXIuY2FuY2VsKCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAg\nIHB1YmxpYyB2b2lkIHNldE51bGwoaW50IGkxLCBpbnQgaTIpIHRocm93cyBT\nUUxFeGNlcHRpb24gewogICAgICAgICAgICAgICAgc2V0TG9nUGFyYW1ldGVy\nKGkxLCAibnVsbCIsIG51bGwpOwogICAgICAgICAgICAgICAgc3VwZXIuc2V0\nTnVsbChpMSwgaTIpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBwdWJs\naWMgdm9pZCBzZXRCb29sZWFuKGludCBpLCBib29sZWFuIGIpIHRocm93cyBT\nUUxFeGNlcHRpb24gewogICAgICAgICAgICAgICAgc2V0TG9nUGFyYW1ldGVy\nKGksIGIpOwogICAgICAgICAgICAgICAgc3VwZXIuc2V0Qm9vbGVhbihpLCBi\nKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHVibGljIHZvaWQgc2V0\nQnl0ZShpbnQgaSwgYnl0ZSBiKSB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAg\nICAgICAgICAgICAgIHNldExvZ1BhcmFtZXRlcihpLCBiKTsKICAgICAgICAg\nICAgICAgIHN1cGVyLnNldEJ5dGUoaSwgYik7CiAgICAgICAgICAgIH0KCiAg\nICAgICAgICAgIHB1YmxpYyB2b2lkIHNldFNob3J0KGludCBpLCBzaG9ydCBz\nKSB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAgICAgICAgIHNldExv\nZ1BhcmFtZXRlcihpLCBzKTsKICAgICAgICAgICAgICAgIHN1cGVyLnNldFNo\nb3J0KGksIHMpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBwdWJsaWMg\ndm9pZCBzZXRJbnQoaW50IGkxLCBpbnQgaTIpIHRocm93cyBTUUxFeGNlcHRp\nb24gewogICAgICAgICAgICAgICAgc2V0TG9nUGFyYW1ldGVyKGkxLCBpMik7\nCiAgICAgICAgICAgICAgICBzdXBlci5zZXRJbnQoaTEsIGkyKTsKICAgICAg\nICAgICAgfQoKICAgICAgICAgICAgcHVibGljIHZvaWQgc2V0TG9uZyhpbnQg\naSwgbG9uZyBsKSB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAgICAg\nICAgIHNldExvZ1BhcmFtZXRlcihpLCBsKTsKICAgICAgICAgICAgICAgIHN1\ncGVyLnNldExvbmcoaSwgbCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAg\nIHB1YmxpYyB2b2lkIHNldEZsb2F0KGludCBpLCBmbG9hdCBmKSB0aHJvd3Mg\nU1FMRXhjZXB0aW9uIHsKICAgICAgICAgICAgICAgIHNldExvZ1BhcmFtZXRl\ncihpLCBmKTsKICAgICAgICAgICAgICAgIHN1cGVyLnNldEZsb2F0KGksIGYp\nOwogICAgICAgICAgICB9CgogICAgICAgICAgICBwdWJsaWMgdm9pZCBzZXRE\nb3VibGUoaW50IGksIGRvdWJsZSBkKSB0aHJvd3MgU1FMRXhjZXB0aW9uIHsK\nICAgICAgICAgICAgICAgIHNldExvZ1BhcmFtZXRlcihpLCBkKTsKICAgICAg\nICAgICAgICAgIHN1cGVyLnNldERvdWJsZShpLCBkKTsKICAgICAgICAgICAg\nfQoKICAgICAgICAgICAgcHVibGljIHZvaWQgc2V0QmlnRGVjaW1hbChpbnQg\naSwgQmlnRGVjaW1hbCBiZCkKICAgICAgICAgICAgICAgIHRocm93cyBTUUxF\neGNlcHRpb24gewogICAgICAgICAgICAgICAgc2V0TG9nUGFyYW1ldGVyKGks\nICJCaWdEZWNpbWFsIiwgYmQpOwogICAgICAgICAgICAgICAgc3VwZXIuc2V0\nQmlnRGVjaW1hbChpLCBiZCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAg\nIHB1YmxpYyB2b2lkIHNldFN0cmluZyhpbnQgaSwgU3RyaW5nIHMpIHRocm93\ncyBTUUxFeGNlcHRpb24gewogICAgICAgICAgICAgICAgc2V0TG9nUGFyYW1l\ndGVyKGksICJTdHJpbmciLCBzKTsKICAgICAgICAgICAgICAgIHN1cGVyLnNl\ndFN0cmluZyhpLCBzKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHVi\nbGljIHZvaWQgc2V0Qnl0ZXMoaW50IGksIGJ5dGVbXSBiKSB0aHJvd3MgU1FM\nRXhjZXB0aW9uIHsKICAgICAgICAgICAgICAgIHNldExvZ1BhcmFtZXRlcihp\nLCAiYnl0ZVtdIiwgYik7CiAgICAgICAgICAgICAgICBzdXBlci5zZXRCeXRl\ncyhpLCBiKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHVibGljIHZv\naWQgc2V0RGF0ZShpbnQgaSwgRGF0ZSBkKSB0aHJvd3MgU1FMRXhjZXB0aW9u\nIHsKICAgICAgICAgICAgICAgIHNldExvZ1BhcmFtZXRlcihpLCAiRGF0ZSIs\nIGQpOwogICAgICAgICAgICAgICAgc3VwZXIuc2V0RGF0ZShpLCBkKTsKICAg\nICAgICAgICAgfQoKICAgICAgICAgICAgcHVibGljIHZvaWQgc2V0VGltZShp\nbnQgaSwgVGltZSB0KSB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAg\nICAgICAgIHNldExvZ1BhcmFtZXRlcihpLCAiVGltZSIsIHQpOwogICAgICAg\nICAgICAgICAgc3VwZXIuc2V0VGltZShpLCB0KTsKICAgICAgICAgICAgfQoK\nICAgICAgICAgICAgcHVibGljIHZvaWQgc2V0VGltZXN0YW1wKGludCBpLCBU\naW1lc3RhbXAgdCkgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgICAg\nICAgICBzZXRMb2dQYXJhbWV0ZXIoaSwgIlRpbWVzdGFtcCIsIHQpOwogICAg\nICAgICAgICAgICAgc3VwZXIuc2V0VGltZXN0YW1wKGksIHQpOwogICAgICAg\nICAgICB9CgogICAgICAgICAgICBwdWJsaWMgdm9pZCBzZXRBc2NpaVN0cmVh\nbShpbnQgaTEsIElucHV0U3RyZWFtIGlzLCBpbnQgaTIpCiAgICAgICAgICAg\nICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAgICAgICAgIHNl\ndExvZ1BhcmFtZXRlcihpMSwgIklucHV0U3RyZWFtIiwgaXMpOwogICAgICAg\nICAgICAgICAgc3VwZXIuc2V0QXNjaWlTdHJlYW0oaTEsIGlzLCBpMik7CiAg\nICAgICAgICAgIH0KCiAgICAgICAgICAgIEBEZXByZWNhdGVkCiAgICAgICAg\nICAgIHB1YmxpYyB2b2lkIHNldFVuaWNvZGVTdHJlYW0oaW50IGkxLCBJbnB1\ndFN0cmVhbSBpcywgaW50IGkyKQogICAgICAgICAgICAgICAgdGhyb3dzIFNR\nTEV4Y2VwdGlvbiB7CiAgICAgICAgICAgICAgICBzZXRMb2dQYXJhbWV0ZXIo\naTEsICJJbnB1dFN0cmVhbSIsIGlzKTsKICAgICAgICAgICAgICAgIHN1cGVy\nLnNldFVuaWNvZGVTdHJlYW0oaTIsIGlzLCBpMik7CiAgICAgICAgICAgIH0K\nCiAgICAgICAgICAgIHB1YmxpYyB2b2lkIHNldEJpbmFyeVN0cmVhbShpbnQg\naTEsIElucHV0U3RyZWFtIGlzLCBpbnQgaTIpCiAgICAgICAgICAgICAgICB0\naHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAgICAgICAgIHNldExvZ1Bh\ncmFtZXRlcihpMSwgIklucHV0U3RyZWFtIiwgaXMpOwogICAgICAgICAgICAg\nICAgc3VwZXIuc2V0QmluYXJ5U3RyZWFtKGkxLCBpcywgaTIpOwogICAgICAg\nICAgICB9CgogICAgICAgICAgICBwdWJsaWMgdm9pZCBjbGVhclBhcmFtZXRl\ncnMoKSB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAgICAgICAgIGNs\nZWFyTG9nUGFyYW1ldGVycyhmYWxzZSk7CiAgICAgICAgICAgICAgICBzdXBl\nci5jbGVhclBhcmFtZXRlcnMoKTsKICAgICAgICAgICAgfQoKICAgICAgICAg\nICAgcHVibGljIHZvaWQgc2V0T2JqZWN0KGludCBpMSwgT2JqZWN0IG8sIGlu\ndCBpMiwgaW50IGkzKQogICAgICAgICAgICAgICAgdGhyb3dzIFNRTEV4Y2Vw\ndGlvbiB7CiAgICAgICAgICAgICAgICBzZXRMb2dQYXJhbWV0ZXIoaTEsICJP\nYmplY3QiLCBvKTsKICAgICAgICAgICAgICAgIHN1cGVyLnNldE9iamVjdChp\nMSwgbywgaTIsIGkzKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHVi\nbGljIHZvaWQgc2V0T2JqZWN0KGludCBpMSwgT2JqZWN0IG8sIGludCBpMikK\nICAgICAgICAgICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAg\nICAgICAgICAgc2V0TG9nUGFyYW1ldGVyKGkxLCAiT2JqZWN0Iiwgbyk7CiAg\nICAgICAgICAgICAgICBzdXBlci5zZXRPYmplY3QoaTEsIG8sIGkyKTsKICAg\nICAgICAgICAgfQoKICAgICAgICAgICAgcHVibGljIHZvaWQgc2V0T2JqZWN0\nKGludCBpLCBPYmplY3QgbykgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAg\nICAgICAgICAgICBzZXRMb2dQYXJhbWV0ZXIoaSwgIk9iamVjdCIsIG8pOwog\nICAgICAgICAgICAgICAgc3VwZXIuc2V0T2JqZWN0KGksIG8pOwogICAgICAg\nICAgICB9CgogICAgICAgICAgICBwdWJsaWMgdm9pZCBhZGRCYXRjaCgpIHRo\ncm93cyBTUUxFeGNlcHRpb24gewogICAgICAgICAgICAgICAgaWYgKF9sb2dz\nLmlzU1FMRW5hYmxlZCgpKQogICAgICAgICAgICAgICAgICAgIF9sb2dzLmxv\nZ1NRTCgiYmF0Y2hpbmcgIiArIHRoaXMsIExvZ2dpbmdDb25uZWN0aW9uLnRo\naXMpOwogICAgICAgICAgICAgICAgbG9uZyBzdGFydCA9IFN5c3RlbS5jdXJy\nZW50VGltZU1pbGxpcygpOwogICAgICAgICAgICAgICAgdHJ5IHsKICAgICAg\nICAgICAgICAgICAgICBzdXBlci5hZGRCYXRjaCgpOwogICAgICAgICAgICAg\nICAgICAgIGlmIChzaG91bGRUcmFja1BhcmFtZXRlcnMoKSkgewogICAgICAg\nICAgICAgICAgICAgICAgICAvLyBtYWtlIHN1cmUgb3VyIGxpc3QgaXMgaW5p\ndGlhbGl6ZWQKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKF9wYXJhbUJh\ndGNoID09IG51bGwpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfcGFy\nYW1CYXRjaCA9IG5ldyBBcnJheUxpc3Q8TGlzdDxTdHJpbmc+PigpOwogICAg\nICAgICAgICAgICAgICAgICAgICAvLyBjb3B5IHBhcmFtZXRlcnMgc2luY2Ug\ndGhleSB3aWxsIGJlIHJlLXVzZWQKICAgICAgICAgICAgICAgICAgICAgICAg\naWYgKF9wYXJhbXMgIT0gbnVsbCkgewogICAgICAgICAgICAgICAgICAgICAg\nICAgICAgTGlzdDxTdHJpbmc+IGNvcHlQYXJtcyA9CiAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgIG5ldyBBcnJheUxpc3Q8U3RyaW5nPihf\ncGFyYW1zKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9wYXJhbUJh\ndGNoLmFkZChjb3B5UGFybXMpOwogICAgICAgICAgICAgICAgICAgICAgICB9\nCiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAg\nICAgICAgICAgICAgIF9wYXJhbUJhdGNoLmFkZChudWxsKTsKICAgICAgICAg\nICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAg\nICBmaW5hbGx5IHsKICAgICAgICAgICAgICAgICAgICBsb2dUaW1lKHN0YXJ0\nKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAg\nICAgcHVibGljIHZvaWQgc2V0Q2hhcmFjdGVyU3RyZWFtKGludCBpMSwgUmVh\nZGVyIHIsIGludCBpMikKICAgICAgICAgICAgICAgIHRocm93cyBTUUxFeGNl\ncHRpb24gewogICAgICAgICAgICAgICAgc2V0TG9nUGFyYW1ldGVyKGkxLCAi\nUmVhZGVyIiwgcik7CiAgICAgICAgICAgICAgICBzdXBlci5zZXRDaGFyYWN0\nZXJTdHJlYW0oaTEsIHIsIGkyKTsKICAgICAgICAgICAgfQoKICAgICAgICAg\nICAgcHVibGljIHZvaWQgc2V0UmVmKGludCBpLCBSZWYgcikgdGhyb3dzIFNR\nTEV4Y2VwdGlvbiB7CiAgICAgICAgICAgICAgICBzZXRMb2dQYXJhbWV0ZXIo\naSwgIlJlZiIsIHIpOwogICAgICAgICAgICAgICAgc3VwZXIuc2V0UmVmKGks\nIHIpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBwdWJsaWMgdm9pZCBz\nZXRCbG9iKGludCBpLCBCbG9iIGIpIHRocm93cyBTUUxFeGNlcHRpb24gewog\nICAgICAgICAgICAgICAgc2V0TG9nUGFyYW1ldGVyKGksICJCbG9iIiwgYik7\nCiAgICAgICAgICAgICAgICBzdXBlci5zZXRCbG9iKGksIGIpOwogICAgICAg\nICAgICB9CgogICAgICAgICAgICBwdWJsaWMgdm9pZCBzZXRDbG9iKGludCBp\nLCBDbG9iIGMpIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgICAgICAg\nICAgc2V0TG9nUGFyYW1ldGVyKGksICJDbG9iIiwgYyk7CiAgICAgICAgICAg\nICAgICBzdXBlci5zZXRDbG9iKGksIGMpOwogICAgICAgICAgICB9CgogICAg\nICAgICAgICBwdWJsaWMgdm9pZCBzZXRBcnJheShpbnQgaSwgQXJyYXkgYSkg\ndGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgICAgICAgICBzZXRMb2dQ\nYXJhbWV0ZXIoaSwgIkFycmF5IiwgYSk7CiAgICAgICAgICAgICAgICBzdXBl\nci5zZXRBcnJheShpLCBhKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAg\ncHVibGljIFJlc3VsdFNldE1ldGFEYXRhIGdldE1ldGFEYXRhKCkgdGhyb3dz\nIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIu\nZ2V0TWV0YURhdGEoKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHVi\nbGljIHZvaWQgc2V0RGF0ZShpbnQgaSwgRGF0ZSBkLCBDYWxlbmRhciBjKSB0\naHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAgICAgICAgIHNldExvZ1Bh\ncmFtZXRlcihpLCAiRGF0ZSIsIGQpOwogICAgICAgICAgICAgICAgc3VwZXIu\nc2V0RGF0ZShpLCBkLCBjKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAg\ncHVibGljIHZvaWQgc2V0VGltZShpbnQgaSwgVGltZSB0LCBDYWxlbmRhciBj\nKSB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAgICAgICAgIHNldExv\nZ1BhcmFtZXRlcihpLCAiVGltZSIsIHQpOwogICAgICAgICAgICAgICAgc3Vw\nZXIuc2V0VGltZShpLCB0LCBjKTsKICAgICAgICAgICAgfQoKICAgICAgICAg\nICAgcHVibGljIHZvaWQgc2V0VGltZXN0YW1wKGludCBpLCBUaW1lc3RhbXAg\ndCwgQ2FsZW5kYXIgYykKICAgICAgICAgICAgICAgIHRocm93cyBTUUxFeGNl\ncHRpb24gewogICAgICAgICAgICAgICAgc2V0TG9nUGFyYW1ldGVyKGksICJU\naW1lc3RhbXAiLCB0KTsKICAgICAgICAgICAgICAgIHN1cGVyLnNldFRpbWVz\ndGFtcChpLCB0LCBjKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHVi\nbGljIHZvaWQgc2V0TnVsbChpbnQgaTEsIGludCBpMiwgU3RyaW5nIHMpIHRo\ncm93cyBTUUxFeGNlcHRpb24gewogICAgICAgICAgICAgICAgc2V0TG9nUGFy\nYW1ldGVyKGkxLCAibnVsbCIsIG51bGwpOwogICAgICAgICAgICAgICAgc3Vw\nZXIuc2V0TnVsbChpMSwgaTIsIHMpOwogICAgICAgICAgICB9CgogICAgICAg\nICAgICBwcm90ZWN0ZWQgdm9pZCBhcHBlbmRJbmZvKFN0cmluZ0J1ZmZlciBi\ndWYpIHsKICAgICAgICAgICAgICAgIGJ1Zi5hcHBlbmQoIiAiKTsKICAgICAg\nICAgICAgICAgIGlmIChfZm9ybWF0dGVyICE9IG51bGwpIHsKICAgICAgICAg\nICAgICAgICAgICBidWYuYXBwZW5kKFNFUCk7CiAgICAgICAgICAgICAgICAg\nICAgYnVmLmFwcGVuZChfZm9ybWF0dGVyLnByZXR0eVByaW50KF9zcWwpKTsK\nICAgICAgICAgICAgICAgICAgICBidWYuYXBwZW5kKFNFUCk7CiAgICAgICAg\nICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIGJ1Zi5hcHBl\nbmQoX3NxbCk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAg\nU3RyaW5nQnVpbGRlciBwYXJhbUJ1ZiA9IG51bGw7CiAgICAgICAgICAgICAg\nICBpZiAoX3BhcmFtcyAhPSBudWxsICYmICFfcGFyYW1zLmlzRW1wdHkoKSkg\newogICAgICAgICAgICAgICAgICAgIHBhcmFtQnVmID0gbmV3IFN0cmluZ0J1\naWxkZXIoKTsKICAgICAgICAgICAgICAgICAgICBmb3IgKEl0ZXJhdG9yPFN0\ncmluZz4gaXRyID0gX3BhcmFtcy5pdGVyYXRvcigpOyBpdHIKICAgICAgICAg\nICAgICAgICAgICAgICAgLmhhc05leHQoKTspIHsKICAgICAgICAgICAgICAg\nICAgICAgICAgcGFyYW1CdWYuYXBwZW5kKGl0ci5uZXh0KCkpOwogICAgICAg\nICAgICAgICAgICAgICAgICBpZiAoaXRyLmhhc05leHQoKSkKICAgICAgICAg\nICAgICAgICAgICAgICAgICAgIHBhcmFtQnVmLmFwcGVuZCgiLCAiKTsKICAg\nICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CgogICAgICAg\nICAgICAgICAgaWYgKHBhcmFtQnVmICE9IG51bGwpIHsKICAgICAgICAgICAg\nICAgICAgICBpZiAoIV9wcmV0dHlQcmludCkKICAgICAgICAgICAgICAgICAg\nICAgICAgYnVmLmFwcGVuZCgiICIpOwogICAgICAgICAgICAgICAgICAgIGJ1\nZi5hcHBlbmQoIltwYXJhbXM9IikuCiAgICAgICAgICAgICAgICAgICAgICAg\nIGFwcGVuZChwYXJhbUJ1Zi50b1N0cmluZygpKS5hcHBlbmQoIl0iKTsKICAg\nICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHN1cGVyLmFwcGVuZElu\nZm8oYnVmKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHJpdmF0ZSB2\nb2lkIGNsZWFyTG9nUGFyYW1ldGVycyhib29sZWFuIGJhdGNoKSB7CiAgICAg\nICAgICAgICAgICBpZiAoX3BhcmFtcyAhPSBudWxsKQogICAgICAgICAgICAg\nICAgICAgIF9wYXJhbXMuY2xlYXIoKTsKICAgICAgICAgICAgICAgIGlmIChi\nYXRjaCAmJiBfcGFyYW1CYXRjaCAhPSBudWxsKQogICAgICAgICAgICAgICAg\nICAgIF9wYXJhbUJhdGNoLmNsZWFyKCk7CiAgICAgICAgICAgIH0KCiAgICAg\nICAgICAgIHByaXZhdGUgYm9vbGVhbiBzaG91bGRUcmFja1BhcmFtZXRlcnMo\nKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gX3RyYWNrUGFyYW1ldGVycyB8\nfCBfbG9ncy5pc1NRTEVuYWJsZWQoKTsKICAgICAgICAgICAgfQoKICAgICAg\nICAgICAgcHJpdmF0ZSB2b2lkIHNldExvZ1BhcmFtZXRlcihpbnQgaW5kZXgs\nIGJvb2xlYW4gdmFsKSB7CiAgICAgICAgICAgICAgICBpZiAoc2hvdWxkVHJh\nY2tQYXJhbWV0ZXJzKCkpCiAgICAgICAgICAgICAgICAgICAgc2V0TG9nUGFy\nYW1ldGVyKGluZGV4LCAiKGJvb2xlYW4pICIgKyB2YWwpOwogICAgICAgICAg\nICB9CgogICAgICAgICAgICBwcml2YXRlIHZvaWQgc2V0TG9nUGFyYW1ldGVy\nKGludCBpbmRleCwgYnl0ZSB2YWwpIHsKICAgICAgICAgICAgICAgIGlmIChz\naG91bGRUcmFja1BhcmFtZXRlcnMoKSkKICAgICAgICAgICAgICAgICAgICBz\nZXRMb2dQYXJhbWV0ZXIoaW5kZXgsICIoYnl0ZSkgIiArIHZhbCk7CiAgICAg\nICAgICAgIH0KCiAgICAgICAgICAgIHByaXZhdGUgdm9pZCBzZXRMb2dQYXJh\nbWV0ZXIoaW50IGluZGV4LCBkb3VibGUgdmFsKSB7CiAgICAgICAgICAgICAg\nICBpZiAoc2hvdWxkVHJhY2tQYXJhbWV0ZXJzKCkpCiAgICAgICAgICAgICAg\nICAgICAgc2V0TG9nUGFyYW1ldGVyKGluZGV4LCAiKGRvdWJsZSkgIiArIHZh\nbCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHByaXZhdGUgdm9pZCBz\nZXRMb2dQYXJhbWV0ZXIoaW50IGluZGV4LCBmbG9hdCB2YWwpIHsKICAgICAg\nICAgICAgICAgIGlmIChzaG91bGRUcmFja1BhcmFtZXRlcnMoKSkKICAgICAg\nICAgICAgICAgICAgICBzZXRMb2dQYXJhbWV0ZXIoaW5kZXgsICIoZmxvYXQp\nICIgKyB2YWwpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBwcml2YXRl\nIHZvaWQgc2V0TG9nUGFyYW1ldGVyKGludCBpbmRleCwgaW50IHZhbCkgewog\nICAgICAgICAgICAgICAgaWYgKHNob3VsZFRyYWNrUGFyYW1ldGVycygpKQog\nICAgICAgICAgICAgICAgICAgIHNldExvZ1BhcmFtZXRlcihpbmRleCwgIihp\nbnQpICIgKyB2YWwpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBwcml2\nYXRlIHZvaWQgc2V0TG9nUGFyYW1ldGVyKGludCBpbmRleCwgbG9uZyB2YWwp\nIHsKICAgICAgICAgICAgICAgIGlmIChzaG91bGRUcmFja1BhcmFtZXRlcnMo\nKSkKICAgICAgICAgICAgICAgICAgICBzZXRMb2dQYXJhbWV0ZXIoaW5kZXgs\nICIobG9uZykgIiArIHZhbCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAg\nIHByaXZhdGUgdm9pZCBzZXRMb2dQYXJhbWV0ZXIoaW50IGluZGV4LCBzaG9y\ndCB2YWwpIHsKICAgICAgICAgICAgICAgIGlmIChzaG91bGRUcmFja1BhcmFt\nZXRlcnMoKSkKICAgICAgICAgICAgICAgICAgICBzZXRMb2dQYXJhbWV0ZXIo\naW5kZXgsICIoc2hvcnQpICIgKyB2YWwpOwogICAgICAgICAgICB9CgogICAg\nICAgICAgICBwcml2YXRlIHZvaWQgc2V0TG9nUGFyYW1ldGVyKGludCBpbmRl\neCwgU3RyaW5nIHR5cGUsIE9iamVjdCB2YWwpIHsKICAgICAgICAgICAgICAg\nIGlmIChzaG91bGRUcmFja1BhcmFtZXRlcnMoKSkKICAgICAgICAgICAgICAg\nICAgICBzZXRMb2dQYXJhbWV0ZXIoaW5kZXgsICIoIiArIHR5cGUgKyAiKSAi\nICsgdmFsKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHJpdmF0ZSB2\nb2lkIHNldExvZ1BhcmFtZXRlcihpbnQgaW5kZXgsIFN0cmluZyB2YWwpIHsK\nICAgICAgICAgICAgICAgIGlmIChfcGFyYW1zID09IG51bGwpCiAgICAgICAg\nICAgICAgICAgICAgX3BhcmFtcyA9IG5ldyBBcnJheUxpc3Q8U3RyaW5nPigp\nOwogICAgICAgICAgICAgICAgd2hpbGUgKF9wYXJhbXMuc2l6ZSgpIDwgaW5k\nZXgpCiAgICAgICAgICAgICAgICAgICAgX3BhcmFtcy5hZGQobnVsbCk7CiAg\nICAgICAgICAgICAgICBpZiAodmFsLmxlbmd0aCgpID4gODApCiAgICAgICAg\nICAgICAgICAgICAgdmFsID0gdmFsLnN1YnN0cmluZygwLCA3NykgKyAiLi4u\nIjsKICAgICAgICAgICAgICAgIF9wYXJhbXMuc2V0KGluZGV4IC0gMSwgdmFs\nKTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgLyoqCiAgICAg\nICAgICogV2FybmluZy1oYW5kbGluZyByZXN1bHQgc2V0LgogICAgICAgICAq\nLwogICAgICAgIHByb3RlY3RlZCBhYnN0cmFjdCBjbGFzcyBMb2dnaW5nUmVz\ndWx0U2V0IGV4dGVuZHMgRGVsZWdhdGluZ1Jlc3VsdFNldCB7CgogICAgICAg\nICAgICBwdWJsaWMgTG9nZ2luZ1Jlc3VsdFNldChSZXN1bHRTZXQgcnMsIFN0\nYXRlbWVudCBzdG1udCkgewogICAgICAgICAgICAgICAgc3VwZXIocnMsIHN0\nbW50KTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHVibGljIGJvb2xl\nYW4gbmV4dCgpIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgICAgICAg\nICAgU1FMRXhjZXB0aW9uIGVyciA9IG51bGw7CiAgICAgICAgICAgICAgICB0\ncnkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5uZXh0KCk7\nCiAgICAgICAgICAgICAgICB9IGNhdGNoIChTUUxFeGNlcHRpb24gc2UpIHsK\nICAgICAgICAgICAgICAgICAgICBlcnIgPSBzZTsKICAgICAgICAgICAgICAg\nICAgICB0aHJvdyBzZTsKICAgICAgICAgICAgICAgIH0gZmluYWxseSB7CiAg\nICAgICAgICAgICAgICAgICAgaGFuZGxlU1FMRXJyb3JzKExvZ2dpbmdSZXN1\nbHRTZXQudGhpcywgZXJyKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAg\nICAgfQoKICAgICAgICAgICAgcHVibGljIHZvaWQgY2xvc2UoKSB0aHJvd3Mg\nU1FMRXhjZXB0aW9uIHsKICAgICAgICAgICAgICAgIFNRTEV4Y2VwdGlvbiBl\ncnIgPSBudWxsOyAgICAgICAgICAgIAkKICAgICAgICAgICAgICAgIHRyeSB7\nCiAgICAgICAgICAgICAgICAgICAgc3VwZXIuY2xvc2UoKTsKICAgICAgICAg\nICAgICAgIH0gY2F0Y2ggKFNRTEV4Y2VwdGlvbiBzZSkgewogICAgICAgICAg\nICAgICAgICAgIGVyciA9IHNlOwogICAgICAgICAgICAgICAgICAgIHRocm93\nIHNlOwogICAgICAgICAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAg\nICAgICAgICBoYW5kbGVTUUxFcnJvcnMoTG9nZ2luZ1Jlc3VsdFNldC50aGlz\nLCBlcnIpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAg\nICAgICAgICBwdWJsaWMgdm9pZCBiZWZvcmVGaXJzdCgpIHRocm93cyBTUUxF\neGNlcHRpb24gewogICAgICAgICAgICAgICAgU1FMRXhjZXB0aW9uIGVyciA9\nIG51bGw7ICAgICAgICAgICAgCQogICAgICAgICAgICAgICAgdHJ5IHsKICAg\nICAgICAgICAgICAgICAgICBzdXBlci5iZWZvcmVGaXJzdCgpOwogICAgICAg\nICAgICAgICAgfSBjYXRjaCAoU1FMRXhjZXB0aW9uIHNlKSB7CiAgICAgICAg\nICAgICAgICAgICAgZXJyID0gc2U7CiAgICAgICAgICAgICAgICAgICAgdGhy\nb3cgc2U7CiAgICAgICAgICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAg\nICAgICAgICAgIGhhbmRsZVNRTEVycm9ycyhMb2dnaW5nUmVzdWx0U2V0LnRo\naXMsIGVycik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAg\nICAgICAgICAgIHB1YmxpYyB2b2lkIGFmdGVyTGFzdCgpIHRocm93cyBTUUxF\neGNlcHRpb24gewogICAgICAgICAgICAgICAgU1FMRXhjZXB0aW9uIGVyciA9\nIG51bGw7ICAgICAgICAgICAgCQogICAgICAgICAgICAgICAgdHJ5IHsKICAg\nICAgICAgICAgICAgICAgICBzdXBlci5hZnRlckxhc3QoKTsKICAgICAgICAg\nICAgICAgIH0gY2F0Y2ggKFNRTEV4Y2VwdGlvbiBzZSkgewogICAgICAgICAg\nICAgICAgICAgIGVyciA9IHNlOwogICAgICAgICAgICAgICAgICAgIHRocm93\nIHNlOwogICAgICAgICAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAg\nICAgICAgICBoYW5kbGVTUUxFcnJvcnMoTG9nZ2luZ1Jlc3VsdFNldC50aGlz\nLCBlcnIpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAg\nICAgICAgICBwdWJsaWMgYm9vbGVhbiBmaXJzdCgpIHRocm93cyBTUUxFeGNl\ncHRpb24gewogICAgICAgICAgICAgICAgU1FMRXhjZXB0aW9uIGVyciA9IG51\nbGw7ICAgICAgICAgICAgCQogICAgICAgICAgICAgICAgdHJ5IHsKICAgICAg\nICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZmlyc3QoKTsKICAgICAgICAg\nICAgICAgIH0gY2F0Y2ggKFNRTEV4Y2VwdGlvbiBzZSkgewogICAgICAgICAg\nICAgICAgICAgIGVyciA9IHNlOwogICAgICAgICAgICAgICAgICAgIHRocm93\nIHNlOwogICAgICAgICAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAg\nICAgICAgICBoYW5kbGVTUUxFcnJvcnMoTG9nZ2luZ1Jlc3VsdFNldC50aGlz\nLCBlcnIpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAg\nICAgICAgICBwdWJsaWMgYm9vbGVhbiBsYXN0KCkgdGhyb3dzIFNRTEV4Y2Vw\ndGlvbiB7CiAgICAgICAgICAgICAgICBTUUxFeGNlcHRpb24gZXJyID0gbnVs\nbDsgICAgICAgICAgICAJCiAgICAgICAgICAgICAgICB0cnkgewogICAgICAg\nICAgICAgICAgICAgIHJldHVybiBzdXBlci5sYXN0KCk7CiAgICAgICAgICAg\nICAgICB9IGNhdGNoIChTUUxFeGNlcHRpb24gc2UpIHsKICAgICAgICAgICAg\nICAgICAgICBlcnIgPSBzZTsKICAgICAgICAgICAgICAgICAgICB0aHJvdyBz\nZTsKICAgICAgICAgICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgICAg\nICAgICAgaGFuZGxlU1FMRXJyb3JzKExvZ2dpbmdSZXN1bHRTZXQudGhpcywg\nZXJyKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAg\nICAgICAgcHVibGljIGJvb2xlYW4gYWJzb2x1dGUoaW50IGEpIHRocm93cyBT\nUUxFeGNlcHRpb24gewogICAgICAgICAgICAgICAgU1FMRXhjZXB0aW9uIGVy\nciA9IG51bGw7ICAgICAgICAgICAgCQogICAgICAgICAgICAgICAgdHJ5IHsK\nICAgICAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuYWJzb2x1dGUoYSk7\nCiAgICAgICAgICAgICAgICB9IGNhdGNoIChTUUxFeGNlcHRpb24gc2UpIHsK\nICAgICAgICAgICAgICAgICAgICBlcnIgPSBzZTsKICAgICAgICAgICAgICAg\nICAgICB0aHJvdyBzZTsKICAgICAgICAgICAgICAgIH0gZmluYWxseSB7CiAg\nICAgICAgICAgICAgICAgICAgaGFuZGxlU1FMRXJyb3JzKExvZ2dpbmdSZXN1\nbHRTZXQudGhpcywgZXJyKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAg\nICAgfQoKICAgICAgICAgICAgcHVibGljIGJvb2xlYW4gcmVsYXRpdmUoaW50\nIGEpIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgICAgICAgICAgU1FM\nRXhjZXB0aW9uIGVyciA9IG51bGw7ICAgICAgICAgICAgCQogICAgICAgICAg\nICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIu\ncmVsYXRpdmUoYSk7CiAgICAgICAgICAgICAgICB9IGNhdGNoIChTUUxFeGNl\ncHRpb24gc2UpIHsKICAgICAgICAgICAgICAgICAgICBlcnIgPSBzZTsKICAg\nICAgICAgICAgICAgICAgICB0aHJvdyBzZTsKICAgICAgICAgICAgICAgIH0g\nZmluYWxseSB7CiAgICAgICAgICAgICAgICAgICAgaGFuZGxlU1FMRXJyb3Jz\nKExvZ2dpbmdSZXN1bHRTZXQudGhpcywgZXJyKTsKICAgICAgICAgICAgICAg\nIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHVibGljIGJvb2xlYW4g\ncHJldmlvdXMoKSB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAgICAg\nICAgIFNRTEV4Y2VwdGlvbiBlcnIgPSBudWxsOyAgICAgICAgICAgIAkKICAg\nICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJu\nIHN1cGVyLnByZXZpb3VzKCk7CiAgICAgICAgICAgICAgICB9IGNhdGNoIChT\nUUxFeGNlcHRpb24gc2UpIHsKICAgICAgICAgICAgICAgICAgICBlcnIgPSBz\nZTsKICAgICAgICAgICAgICAgICAgICB0aHJvdyBzZTsKICAgICAgICAgICAg\nICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgICAgICAgICAgaGFuZGxlU1FM\nRXJyb3JzKExvZ2dpbmdSZXN1bHRTZXQudGhpcywgZXJyKTsKICAgICAgICAg\nICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICAKICAg\nICAgICAvKioKICAgICAgICAgKiBDYWxsYWJsZVN0YXRlbWVudCBkZWNvcmF0\nZWQgd2l0aCBsb2dnaW5nLgogICAgICAgICAqIFNpbWlsYXIgdG8ge0BsaW5r\nIExvZ2dpbmdQcmVwYXJlZFN0YXRlbWVudH0gYnV0IGNhbiBub3QgYmUgZXh0\nZW5kZWQKICAgICAgICAgKiBkdWUgdG8gdGhlIGV4aXN0aW5nIGRlbGVnYXRp\nb24gaGllcmFyY2h5LgogICAgICAgICAqLwogICAgICAgIHByb3RlY3RlZCBh\nYnN0cmFjdCBjbGFzcyBMb2dnaW5nQ2FsbGFibGVTdGF0ZW1lbnQgZXh0ZW5k\ncyAKICAgICAgICAgICAgRGVsZWdhdGluZ0NhbGxhYmxlU3RhdGVtZW50IHsK\nICAgICAgICAgICAgcHJpdmF0ZSBmaW5hbCBTdHJpbmcgX3NxbDsKICAgICAg\nICAgICAgcHJpdmF0ZSBMaXN0PFN0cmluZz4gX3BhcmFtcyA9IG51bGw7CiAg\nICAgICAgICAgIHByaXZhdGUgTGlzdDxMaXN0PFN0cmluZz4+IF9wYXJhbUJh\ndGNoID0gbnVsbDsKCiAgICAgICAgICAgIHB1YmxpYyBMb2dnaW5nQ2FsbGFi\nbGVTdGF0ZW1lbnQoQ2FsbGFibGVTdGF0ZW1lbnQgc3RtdCwgU3RyaW5nIHNx\nbCkgCiAgICAgICAgICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAg\nICAgICAJCXN1cGVyKHN0bXQsIExvZ2dpbmdDb25uZWN0aW9uLnRoaXMpOwog\nICAgICAgIAkJX3NxbCA9IHNxbDsKICAgICAgICAJfQogICAgICAgIAkKICAg\nICAgICAgICAgcHJpdmF0ZSBMb2dnaW5nUmVzdWx0U2V0IG5ld0xvZ2dpbmdS\nZXN1bHRTZXQoUmVzdWx0U2V0IHJzLAogICAgICAgICAgICAgICAgQ2FsbGFi\nbGVTdGF0ZW1lbnQgc3RtbnQpIHsKICAgICAgICAgICAgICAgIHJldHVybiBD\nb25jcmV0ZUNsYXNzR2VuZXJhdG9yLgogICAgICAgICAgICAgICAgICAgIG5l\nd0luc3RhbmNlKGxvZ2dpbmdSZXN1bHRTZXRJbXBsLAogICAgICAgICAgICAg\nICAgICAgIExvZ2dpbmdDb25uZWN0aW9uLmNsYXNzLCBMb2dnaW5nQ29ubmVj\ndGlvbi50aGlzLAogICAgICAgICAgICAgICAgICAgIFJlc3VsdFNldC5jbGFz\ncywgcnMsCiAgICAgICAgICAgICAgICAgICAgQ2FsbGFibGVTdGF0ZW1lbnQu\nY2xhc3MsIHN0bW50KTsKICAgICAgICAgICAgfQogICAgICAgICAgICAKICAg\nICAgICAgICAgcHJvdGVjdGVkIFJlc3VsdFNldCB3cmFwUmVzdWx0KFJlc3Vs\ndFNldCBycywgYm9vbGVhbiB3cmFwKSB7CiAgICAgICAgICAgICAgICBpZiAo\nIXdyYXAgfHwgcnMgPT0gbnVsbCkKICAgICAgICAgICAgICAgICAgICByZXR1\ncm4gc3VwZXIud3JhcFJlc3VsdCh3cmFwLCBycyk7CiAgICAgICAgICAgICAg\nICByZXR1cm4gbmV3TG9nZ2luZ1Jlc3VsdFNldChycywgdGhpcyk7CiAgICAg\nICAgICAgIH0KCiAgICAgICAgICAgIHByb3RlY3RlZCBSZXN1bHRTZXQgZXhl\nY3V0ZVF1ZXJ5KFN0cmluZyBzcWwsIGJvb2xlYW4gd3JhcCkKICAgICAgICAg\nICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgICAgICAgICAg\nbG9nU1FMKHRoaXMpOwogICAgICAgICAgICAgICAgbG9uZyBzdGFydCA9IFN5\nc3RlbS5jdXJyZW50VGltZU1pbGxpcygpOwogICAgICAgICAgICAgICAgU1FM\nRXhjZXB0aW9uIGVyciA9IG51bGw7CiAgICAgICAgICAgICAgICB0cnkgewog\nICAgICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5leGVjdXRlUXVlcnko\nc3FsLCB3cmFwKTsKICAgICAgICAgICAgICAgIH0gY2F0Y2ggKFNRTEV4Y2Vw\ndGlvbiBzZSkgewogICAgICAgICAgICAgICAgICAgIGVyciA9IHdyYXAoc2Us\nIExvZ2dpbmdDYWxsYWJsZVN0YXRlbWVudC50aGlzLCBzcWwpOwogICAgICAg\nICAgICAgICAgICAgIHRocm93IGVycjsKICAgICAgICAgICAgICAgIH0gZmlu\nYWxseSB7CiAgICAgICAgICAgICAgICAgICAgbG9nVGltZShzdGFydCk7CiAg\nICAgICAgICAgICAgICAgICAgY2xlYXJMb2dQYXJhbWV0ZXJzKHRydWUpOwog\nICAgICAgICAgICAgICAgICAgIGhhbmRsZVNRTEVycm9ycyhMb2dnaW5nQ2Fs\nbGFibGVTdGF0ZW1lbnQudGhpcywgZXJyKTsKICAgICAgICAgICAgICAgIH0K\nICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHVibGljIGludCBleGVjdXRl\nVXBkYXRlKFN0cmluZyBzcWwpIHRocm93cyBTUUxFeGNlcHRpb24gewogICAg\nICAgICAgICAgICAgbG9nU1FMKHRoaXMpOwogICAgICAgICAgICAgICAgbG9u\nZyBzdGFydCA9IFN5c3RlbS5jdXJyZW50VGltZU1pbGxpcygpOwogICAgICAg\nICAgICAgICAgU1FMRXhjZXB0aW9uIGVyciA9IG51bGw7CiAgICAgICAgICAg\nICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5l\neGVjdXRlVXBkYXRlKHNxbCk7CiAgICAgICAgICAgICAgICB9IGNhdGNoIChT\nUUxFeGNlcHRpb24gc2UpIHsKICAgICAgICAgICAgICAgICAgICBlcnIgPSB3\ncmFwKHNlLCBMb2dnaW5nQ2FsbGFibGVTdGF0ZW1lbnQudGhpcywgc3FsKTsK\nICAgICAgICAgICAgICAgICAgICB0aHJvdyBlcnI7CiAgICAgICAgICAgICAg\nICB9IGZpbmFsbHkgewogICAgICAgICAgICAgICAgICAgIGxvZ1RpbWUoc3Rh\ncnQpOwogICAgICAgICAgICAgICAgICAgIGNsZWFyTG9nUGFyYW1ldGVycyh0\ncnVlKTsKICAgICAgICAgICAgICAgICAgICBoYW5kbGVTUUxFcnJvcnMoTG9n\nZ2luZ0NhbGxhYmxlU3RhdGVtZW50LnRoaXMsIGVycik7CiAgICAgICAgICAg\nICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHB1YmxpYyBib29s\nZWFuIGV4ZWN1dGUoU3RyaW5nIHNxbCkgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7\nCiAgICAgICAgICAgICAgICBsb2dTUUwodGhpcyk7CiAgICAgICAgICAgICAg\nICBsb25nIHN0YXJ0ID0gU3lzdGVtLmN1cnJlbnRUaW1lTWlsbGlzKCk7CiAg\nICAgICAgICAgICAgICBTUUxFeGNlcHRpb24gZXJyID0gbnVsbDsKICAgICAg\nICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHN1\ncGVyLmV4ZWN1dGUoc3FsKTsKICAgICAgICAgICAgICAgIH0gY2F0Y2ggKFNR\nTEV4Y2VwdGlvbiBzZSkgewogICAgICAgICAgICAgICAgICAgIGVyciA9IHdy\nYXAoc2UsIExvZ2dpbmdDYWxsYWJsZVN0YXRlbWVudC50aGlzLCBzcWwpOwog\nICAgICAgICAgICAgICAgICAgIHRocm93IGVycjsKICAgICAgICAgICAgICAg\nIH0gZmluYWxseSB7CiAgICAgICAgICAgICAgICAgICAgbG9nVGltZShzdGFy\ndCk7CiAgICAgICAgICAgICAgICAgICAgY2xlYXJMb2dQYXJhbWV0ZXJzKHRy\ndWUpOwogICAgICAgICAgICAgICAgICAgIGhhbmRsZVNRTEVycm9ycyhMb2dn\naW5nQ2FsbGFibGVTdGF0ZW1lbnQudGhpcywgZXJyKTsKICAgICAgICAgICAg\nICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHJvdGVjdGVkIFJl\nc3VsdFNldCBleGVjdXRlUXVlcnkoYm9vbGVhbiB3cmFwKSB0aHJvd3MgU1FM\nRXhjZXB0aW9uIHsKICAgICAgICAgICAgICAgIGxvZ1NRTCh0aGlzKTsKICAg\nICAgICAgICAgICAgIGxvbmcgc3RhcnQgPSBTeXN0ZW0uY3VycmVudFRpbWVN\naWxsaXMoKTsKICAgICAgICAgICAgICAgIFNRTEV4Y2VwdGlvbiBlcnIgPSBu\ndWxsOwogICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAg\nICByZXR1cm4gc3VwZXIuZXhlY3V0ZVF1ZXJ5KHdyYXApOwogICAgICAgICAg\nICAgICAgfSBjYXRjaCAoU1FMRXhjZXB0aW9uIHNlKSB7CiAgICAgICAgICAg\nICAgICAgICAgZXJyID0gd3JhcChzZSwgTG9nZ2luZ0NhbGxhYmxlU3RhdGVt\nZW50LnRoaXMpOwogICAgICAgICAgICAgICAgICAgIHRocm93IGVycjsKICAg\nICAgICAgICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgICAgICAgICAg\nbG9nVGltZShzdGFydCk7CiAgICAgICAgICAgICAgICAgICAgY2xlYXJMb2dQ\nYXJhbWV0ZXJzKHRydWUpOwogICAgICAgICAgICAgICAgICAgIGhhbmRsZVNR\nTEVycm9ycyhMb2dnaW5nQ2FsbGFibGVTdGF0ZW1lbnQudGhpcywgZXJyKTsK\nICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAg\ncHVibGljIGludCBleGVjdXRlVXBkYXRlKCkgdGhyb3dzIFNRTEV4Y2VwdGlv\nbiB7CiAgICAgICAgICAgICAgICBsb2dTUUwodGhpcyk7CiAgICAgICAgICAg\nICAgICBsb25nIHN0YXJ0ID0gU3lzdGVtLmN1cnJlbnRUaW1lTWlsbGlzKCk7\nCiAgICAgICAgICAgICAgICBTUUxFeGNlcHRpb24gZXJyID0gbnVsbDsgICAg\nICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAg\nICAgICAgICAgIHJldHVybiBzdXBlci5leGVjdXRlVXBkYXRlKCk7CiAgICAg\nICAgICAgICAgICB9IGNhdGNoIChTUUxFeGNlcHRpb24gc2UpIHsKICAgICAg\nICAgICAgICAgICAgICBlcnIgPSB3cmFwKHNlLCBMb2dnaW5nQ2FsbGFibGVT\ndGF0ZW1lbnQudGhpcyk7CiAgICAgICAgICAgICAgICAgICAgdGhyb3cgZXJy\nOwogICAgICAgICAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgICAg\nICAgICBsb2dUaW1lKHN0YXJ0KTsKICAgICAgICAgICAgICAgICAgICBjbGVh\nckxvZ1BhcmFtZXRlcnModHJ1ZSk7CiAgICAgICAgICAgICAgICAgICAgaGFu\nZGxlU1FMRXJyb3JzKExvZ2dpbmdDYWxsYWJsZVN0YXRlbWVudC50aGlzLCBl\ncnIpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAg\nICAgICBwdWJsaWMgaW50W10gZXhlY3V0ZUJhdGNoKCkgdGhyb3dzIFNRTEV4\nY2VwdGlvbiB7CiAgICAgICAgICAgICAgICBsb2dCYXRjaFNRTCh0aGlzKTsK\nICAgICAgICAgICAgICAgIGxvbmcgc3RhcnQgPSBTeXN0ZW0uY3VycmVudFRp\nbWVNaWxsaXMoKTsKICAgICAgICAgICAgICAgIFNRTEV4Y2VwdGlvbiBlcnIg\nPSBudWxsOyAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIHRyeSB7\nCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmV4ZWN1dGVCYXRj\naCgpOwogICAgICAgICAgICAgICAgfSBjYXRjaCAoU1FMRXhjZXB0aW9uIHNl\nKSB7CiAgICAgICAgICAgICAgICAgICAgLy8gaWYgdGhlIGV4Y2VwdGlvbiBp\ncyBhIEJhdGNoVXBkYXRlRXhjZXB0aW9uLCBhbmQKICAgICAgICAgICAgICAg\nICAgICAvLyB3ZSBhcmUgdHJhY2tpbmcgcGFyYW1ldGVycywgdGhlbiBzZXQg\ndGhlIGN1cnJlbnQKICAgICAgICAgICAgICAgICAgICAvLyBwYXJhbWV0ZXIg\nc2V0IHRvIGJlIHRoZSBpbmRleCBvZiB0aGUgZmFpbGVkCiAgICAgICAgICAg\nICAgICAgICAgLy8gc3RhdGVtZW50IHNvIHRoYXQgdGhlIFJlcG9ydGluZ1NR\nTEV4Y2VwdGlvbiB3aWxsCiAgICAgICAgICAgICAgICAgICAgLy8gc2hvdyB0\naGUgY29ycmVjdCBwYXJhbQogICAgICAgICAgICAgICAgICAgIGlmIChzZSBp\nbnN0YW5jZW9mIEJhdGNoVXBkYXRlRXhjZXB0aW9uCiAgICAgICAgICAgICAg\nICAgICAgICAgICYmIF9wYXJhbUJhdGNoICE9IG51bGwgJiYgc2hvdWxkVHJh\nY2tQYXJhbWV0ZXJzKCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaW50\nW10gY291bnQgPSAoKEJhdGNoVXBkYXRlRXhjZXB0aW9uKSBzZSkuCiAgICAg\nICAgICAgICAgICAgICAgICAgICAgICBnZXRVcGRhdGVDb3VudHMoKTsKICAg\nICAgICAgICAgICAgICAgICAgICAgaWYgKGNvdW50ICE9IG51bGwgJiYgY291\nbnQubGVuZ3RoIDw9IF9wYXJhbUJhdGNoLnNpemUoKSkKICAgICAgICAgICAg\nICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaW50\nIGluZGV4ID0gLTE7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3Ig\nKGludCBpID0gMDsgaSA8IGNvdW50Lmxlbmd0aDsgaSsrKSB7CiAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgLy8gLTMgaXMgU3RhdGVtZW50LlNU\nQVRFTUVOVF9GQUlMRUQsIGJ1dCBpcwogICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgIC8vIG9ubHkgYXZhaWxhYmxlIGluIEpESyAxLjQrCiAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvdW50W2ldID09IFN0\nYXRlbWVudC5FWEVDVVRFX0ZBSUxFRCkgewogICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICBpbmRleCA9IGk7CiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0K\nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBubyAtMyBlbGVtZW50\nOiBpdCBtYXkgYmUgdGhhdCB0aGUgc2VydmVyIHN0b3BwZWQKICAgICAgICAg\nICAgICAgICAgICAgICAgICAgIC8vIHByb2Nlc3NpbmcsIHNvIHRoZSBzaXpl\nIG9mIHRoZSBjb3VudCB3aWxsIGJlCiAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAvLyB0aGUgaW5kZXgKICAgICAgICAgICAgICAgICAgICAgICAgICAg\nIGlmIChpbmRleCA9PSAtMSkKICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICBpbmRleCA9IGNvdW50Lmxlbmd0aCArIDE7CgogICAgICAgICAgICAg\nICAgICAgICAgICAgICAgLy8gc2V0IHRoZSBjdXJyZW50IHBhcmFtcyB0byB0\naGUgc2F2ZWQgdmFsdWVzCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBp\nZiAoaW5kZXggPCBfcGFyYW1CYXRjaC5zaXplKCkpCiAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgX3BhcmFtcyA9IChMaXN0PFN0cmluZz4pIF9w\nYXJhbUJhdGNoLmdldChpbmRleCk7CiAgICAgICAgICAgICAgICAgICAgICAg\nIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAg\nZXJyID0gd3JhcChzZSwgTG9nZ2luZ0NhbGxhYmxlU3RhdGVtZW50LnRoaXMp\nOwogICAgICAgICAgICAgICAgICAgIHRocm93IGVycjsKICAgICAgICAgICAg\nICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgICAgICAgICAgbG9nVGltZShz\ndGFydCk7CiAgICAgICAgICAgICAgICAgICAgY2xlYXJMb2dQYXJhbWV0ZXJz\nKHRydWUpOwogICAgICAgICAgICAgICAgICAgIGhhbmRsZVNRTEVycm9ycyhM\nb2dnaW5nQ2FsbGFibGVTdGF0ZW1lbnQudGhpcywgZXJyKTsKICAgICAgICAg\nICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHVibGljIGJv\nb2xlYW4gZXhlY3V0ZSgpIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAg\nICAgICAgICAgbG9nU1FMKHRoaXMpOwogICAgICAgICAgICAgICAgbG9uZyBz\ndGFydCA9IFN5c3RlbS5jdXJyZW50VGltZU1pbGxpcygpOwogICAgICAgICAg\nICAgICAgU1FMRXhjZXB0aW9uIGVyciA9IG51bGw7ICAgICAgICAgICAgICAg\nIAogICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICBy\nZXR1cm4gc3VwZXIuZXhlY3V0ZSgpOwogICAgICAgICAgICAgICAgfSBjYXRj\naCAoU1FMRXhjZXB0aW9uIHNlKSB7CiAgICAgICAgICAgICAgICAgICAgZXJy\nID0gd3JhcChzZSwgTG9nZ2luZ0NhbGxhYmxlU3RhdGVtZW50LnRoaXMpOwog\nICAgICAgICAgICAgICAgICAgIHRocm93IGVycjsKICAgICAgICAgICAgICAg\nIH0gZmluYWxseSB7CiAgICAgICAgICAgICAgICAgICAgbG9nVGltZShzdGFy\ndCk7CiAgICAgICAgICAgICAgICAgICAgY2xlYXJMb2dQYXJhbWV0ZXJzKHRy\ndWUpOwogICAgICAgICAgICAgICAgICAgIGhhbmRsZVNRTEVycm9ycyhMb2dn\naW5nQ2FsbGFibGVTdGF0ZW1lbnQudGhpcywgZXJyKTsKICAgICAgICAgICAg\nICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHVibGljIHZvaWQg\nY2FuY2VsKCkgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgICAgICAg\nICBpZiAoX2xvZ3MuaXNKREJDRW5hYmxlZCgpKQogICAgICAgICAgICAgICAg\nICAgIF9sb2dzLmxvZ0pEQkMoImNhbmNlbCAiICsgdGhpcyArICI6ICIgKyBf\nc3FsLAogICAgICAgICAgICAgICAgICAgICAgICBMb2dnaW5nQ29ubmVjdGlv\nbi50aGlzKTsKCiAgICAgICAgICAgICAgICBzdXBlci5jYW5jZWwoKTsKICAg\nICAgICAgICAgfQoKICAgICAgICAgICAgcHVibGljIHZvaWQgc2V0TnVsbChp\nbnQgaTEsIGludCBpMikgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAg\nICAgICAgICBzZXRMb2dQYXJhbWV0ZXIoaTEsICJudWxsIiwgbnVsbCk7CiAg\nICAgICAgICAgICAgICBzdXBlci5zZXROdWxsKGkxLCBpMik7CiAgICAgICAg\nICAgIH0KCiAgICAgICAgICAgIHB1YmxpYyB2b2lkIHNldEJvb2xlYW4oaW50\nIGksIGJvb2xlYW4gYikgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAg\nICAgICAgICBzZXRMb2dQYXJhbWV0ZXIoaSwgYik7CiAgICAgICAgICAgICAg\nICBzdXBlci5zZXRCb29sZWFuKGksIGIpOwogICAgICAgICAgICB9CgogICAg\nICAgICAgICBwdWJsaWMgdm9pZCBzZXRCeXRlKGludCBpLCBieXRlIGIpIHRo\ncm93cyBTUUxFeGNlcHRpb24gewogICAgICAgICAgICAgICAgc2V0TG9nUGFy\nYW1ldGVyKGksIGIpOwogICAgICAgICAgICAgICAgc3VwZXIuc2V0Qnl0ZShp\nLCBiKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHVibGljIHZvaWQg\nc2V0U2hvcnQoaW50IGksIHNob3J0IHMpIHRocm93cyBTUUxFeGNlcHRpb24g\newogICAgICAgICAgICAgICAgc2V0TG9nUGFyYW1ldGVyKGksIHMpOwogICAg\nICAgICAgICAgICAgc3VwZXIuc2V0U2hvcnQoaSwgcyk7CiAgICAgICAgICAg\nIH0KCiAgICAgICAgICAgIHB1YmxpYyB2b2lkIHNldEludChpbnQgaTEsIGlu\ndCBpMikgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgICAgICAgICBz\nZXRMb2dQYXJhbWV0ZXIoaTEsIGkyKTsKICAgICAgICAgICAgICAgIHN1cGVy\nLnNldEludChpMSwgaTIpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBw\ndWJsaWMgdm9pZCBzZXRMb25nKGludCBpLCBsb25nIGwpIHRocm93cyBTUUxF\neGNlcHRpb24gewogICAgICAgICAgICAgICAgc2V0TG9nUGFyYW1ldGVyKGks\nIGwpOwogICAgICAgICAgICAgICAgc3VwZXIuc2V0TG9uZyhpLCBsKTsKICAg\nICAgICAgICAgfQoKICAgICAgICAgICAgcHVibGljIHZvaWQgc2V0RmxvYXQo\naW50IGksIGZsb2F0IGYpIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAg\nICAgICAgICAgc2V0TG9nUGFyYW1ldGVyKGksIGYpOwogICAgICAgICAgICAg\nICAgc3VwZXIuc2V0RmxvYXQoaSwgZik7CiAgICAgICAgICAgIH0KCiAgICAg\nICAgICAgIHB1YmxpYyB2b2lkIHNldERvdWJsZShpbnQgaSwgZG91YmxlIGQp\nIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgICAgICAgICAgc2V0TG9n\nUGFyYW1ldGVyKGksIGQpOwogICAgICAgICAgICAgICAgc3VwZXIuc2V0RG91\nYmxlKGksIGQpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBwdWJsaWMg\ndm9pZCBzZXRCaWdEZWNpbWFsKGludCBpLCBCaWdEZWNpbWFsIGJkKQogICAg\nICAgICAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgICAg\nICAgICBzZXRMb2dQYXJhbWV0ZXIoaSwgIkJpZ0RlY2ltYWwiLCBiZCk7CiAg\nICAgICAgICAgICAgICBzdXBlci5zZXRCaWdEZWNpbWFsKGksIGJkKTsKICAg\nICAgICAgICAgfQoKICAgICAgICAgICAgcHVibGljIHZvaWQgc2V0U3RyaW5n\nKGludCBpLCBTdHJpbmcgcykgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAg\nICAgICAgICAgICBzZXRMb2dQYXJhbWV0ZXIoaSwgIlN0cmluZyIsIHMpOwog\nICAgICAgICAgICAgICAgc3VwZXIuc2V0U3RyaW5nKGksIHMpOwogICAgICAg\nICAgICB9CgogICAgICAgICAgICBwdWJsaWMgdm9pZCBzZXRCeXRlcyhpbnQg\naSwgYnl0ZVtdIGIpIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgICAg\nICAgICAgc2V0TG9nUGFyYW1ldGVyKGksICJieXRlW10iLCBiKTsKICAgICAg\nICAgICAgICAgIHN1cGVyLnNldEJ5dGVzKGksIGIpOwogICAgICAgICAgICB9\nCgogICAgICAgICAgICBwdWJsaWMgdm9pZCBzZXREYXRlKGludCBpLCBEYXRl\nIGQpIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgICAgICAgICAgc2V0\nTG9nUGFyYW1ldGVyKGksICJEYXRlIiwgZCk7CiAgICAgICAgICAgICAgICBz\ndXBlci5zZXREYXRlKGksIGQpOwogICAgICAgICAgICB9CgogICAgICAgICAg\nICBwdWJsaWMgdm9pZCBzZXRUaW1lKGludCBpLCBUaW1lIHQpIHRocm93cyBT\nUUxFeGNlcHRpb24gewogICAgICAgICAgICAgICAgc2V0TG9nUGFyYW1ldGVy\nKGksICJUaW1lIiwgdCk7CiAgICAgICAgICAgICAgICBzdXBlci5zZXRUaW1l\nKGksIHQpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBwdWJsaWMgdm9p\nZCBzZXRUaW1lc3RhbXAoaW50IGksIFRpbWVzdGFtcCB0KSB0aHJvd3MgU1FM\nRXhjZXB0aW9uIHsKICAgICAgICAgICAgICAgIHNldExvZ1BhcmFtZXRlcihp\nLCAiVGltZXN0YW1wIiwgdCk7CiAgICAgICAgICAgICAgICBzdXBlci5zZXRU\naW1lc3RhbXAoaSwgdCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHB1\nYmxpYyB2b2lkIHNldEFzY2lpU3RyZWFtKGludCBpMSwgSW5wdXRTdHJlYW0g\naXMsIGludCBpMikKICAgICAgICAgICAgICAgIHRocm93cyBTUUxFeGNlcHRp\nb24gewogICAgICAgICAgICAgICAgc2V0TG9nUGFyYW1ldGVyKGkxLCAiSW5w\ndXRTdHJlYW0iLCBpcyk7CiAgICAgICAgICAgICAgICBzdXBlci5zZXRBc2Np\naVN0cmVhbShpMSwgaXMsIGkyKTsKICAgICAgICAgICAgfQoKICAgICAgICAg\nICAgQERlcHJlY2F0ZWQKICAgICAgICAgICAgcHVibGljIHZvaWQgc2V0VW5p\nY29kZVN0cmVhbShpbnQgaTEsIElucHV0U3RyZWFtIGlzLCBpbnQgaTIpCiAg\nICAgICAgICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAg\nICAgICAgIHNldExvZ1BhcmFtZXRlcihpMSwgIklucHV0U3RyZWFtIiwgaXMp\nOwogICAgICAgICAgICAgICAgc3VwZXIuc2V0VW5pY29kZVN0cmVhbShpMiwg\naXMsIGkyKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHVibGljIHZv\naWQgc2V0QmluYXJ5U3RyZWFtKGludCBpMSwgSW5wdXRTdHJlYW0gaXMsIGlu\ndCBpMikKICAgICAgICAgICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewog\nICAgICAgICAgICAgICAgc2V0TG9nUGFyYW1ldGVyKGkxLCAiSW5wdXRTdHJl\nYW0iLCBpcyk7CiAgICAgICAgICAgICAgICBzdXBlci5zZXRCaW5hcnlTdHJl\nYW0oaTEsIGlzLCBpMik7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHB1\nYmxpYyB2b2lkIGNsZWFyUGFyYW1ldGVycygpIHRocm93cyBTUUxFeGNlcHRp\nb24gewogICAgICAgICAgICAgICAgY2xlYXJMb2dQYXJhbWV0ZXJzKGZhbHNl\nKTsKICAgICAgICAgICAgICAgIHN1cGVyLmNsZWFyUGFyYW1ldGVycygpOwog\nICAgICAgICAgICB9CgogICAgICAgICAgICBwdWJsaWMgdm9pZCBzZXRPYmpl\nY3QoaW50IGkxLCBPYmplY3QgbywgaW50IGkyLCBpbnQgaTMpCiAgICAgICAg\nICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAgICAgICAg\nIHNldExvZ1BhcmFtZXRlcihpMSwgIk9iamVjdCIsIG8pOwogICAgICAgICAg\nICAgICAgc3VwZXIuc2V0T2JqZWN0KGkxLCBvLCBpMiwgaTMpOwogICAgICAg\nICAgICB9CgogICAgICAgICAgICBwdWJsaWMgdm9pZCBzZXRPYmplY3QoaW50\nIGkxLCBPYmplY3QgbywgaW50IGkyKQogICAgICAgICAgICAgICAgdGhyb3dz\nIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgICAgICAgICBzZXRMb2dQYXJhbWV0\nZXIoaTEsICJPYmplY3QiLCBvKTsKICAgICAgICAgICAgICAgIHN1cGVyLnNl\ndE9iamVjdChpMSwgbywgaTIpOwogICAgICAgICAgICB9CgogICAgICAgICAg\nICBwdWJsaWMgdm9pZCBzZXRPYmplY3QoaW50IGksIE9iamVjdCBvKSB0aHJv\nd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAgICAgICAgIHNldExvZ1BhcmFt\nZXRlcihpLCAiT2JqZWN0Iiwgbyk7CiAgICAgICAgICAgICAgICBzdXBlci5z\nZXRPYmplY3QoaSwgbyk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHB1\nYmxpYyB2b2lkIGFkZEJhdGNoKCkgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAg\nICAgICAgICAgICAgICBpZiAoX2xvZ3MuaXNTUUxFbmFibGVkKCkpCiAgICAg\nICAgICAgICAgICAgICAgX2xvZ3MubG9nU1FMKCJiYXRjaGluZyAiICsgdGhp\ncywgTG9nZ2luZ0Nvbm5lY3Rpb24udGhpcyk7CiAgICAgICAgICAgICAgICBs\nb25nIHN0YXJ0ID0gU3lzdGVtLmN1cnJlbnRUaW1lTWlsbGlzKCk7CiAgICAg\nICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgIHN1cGVyLmFk\nZEJhdGNoKCk7CiAgICAgICAgICAgICAgICAgICAgaWYgKHNob3VsZFRyYWNr\nUGFyYW1ldGVycygpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIC8vIG1h\na2Ugc3VyZSBvdXIgbGlzdCBpcyBpbml0aWFsaXplZAogICAgICAgICAgICAg\nICAgICAgICAgICBpZiAoX3BhcmFtQmF0Y2ggPT0gbnVsbCkKICAgICAgICAg\nICAgICAgICAgICAgICAgICAgIF9wYXJhbUJhdGNoID0gbmV3IEFycmF5TGlz\ndDxMaXN0PFN0cmluZz4+KCk7CiAgICAgICAgICAgICAgICAgICAgICAgIC8v\nIGNvcHkgcGFyYW1ldGVycyBzaW5jZSB0aGV5IHdpbGwgYmUgcmUtdXNlZAog\nICAgICAgICAgICAgICAgICAgICAgICBpZiAoX3BhcmFtcyAhPSBudWxsKSB7\nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBMaXN0PFN0cmluZz4gY29w\neVBhcmFtcyA9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3\nIEFycmF5TGlzdDxTdHJpbmc+KF9wYXJhbXMpOwogICAgICAgICAgICAgICAg\nICAgICAgICAgICAgX3BhcmFtQmF0Y2guYWRkKGNvcHlQYXJhbXMpOwogICAg\nICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAg\nIGVsc2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9wYXJhbUJhdGNo\nLmFkZChudWxsKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAg\nICAgICB9CiAgICAgICAgICAgICAgICBmaW5hbGx5IHsKICAgICAgICAgICAg\nICAgICAgICBsb2dUaW1lKHN0YXJ0KTsKICAgICAgICAgICAgICAgIH0KICAg\nICAgICAgICAgfQoKICAgICAgICAgICAgcHVibGljIHZvaWQgc2V0Q2hhcmFj\ndGVyU3RyZWFtKGludCBpMSwgUmVhZGVyIHIsIGludCBpMikKICAgICAgICAg\nICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgICAgICAgICAg\nc2V0TG9nUGFyYW1ldGVyKGkxLCAiUmVhZGVyIiwgcik7CiAgICAgICAgICAg\nICAgICBzdXBlci5zZXRDaGFyYWN0ZXJTdHJlYW0oaTEsIHIsIGkyKTsKICAg\nICAgICAgICAgfQoKICAgICAgICAgICAgcHVibGljIHZvaWQgc2V0UmVmKGlu\ndCBpLCBSZWYgcikgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgICAg\nICAgICBzZXRMb2dQYXJhbWV0ZXIoaSwgIlJlZiIsIHIpOwogICAgICAgICAg\nICAgICAgc3VwZXIuc2V0UmVmKGksIHIpOwogICAgICAgICAgICB9CgogICAg\nICAgICAgICBwdWJsaWMgdm9pZCBzZXRCbG9iKGludCBpLCBCbG9iIGIpIHRo\ncm93cyBTUUxFeGNlcHRpb24gewogICAgICAgICAgICAgICAgc2V0TG9nUGFy\nYW1ldGVyKGksICJCbG9iIiwgYik7CiAgICAgICAgICAgICAgICBzdXBlci5z\nZXRCbG9iKGksIGIpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBwdWJs\naWMgdm9pZCBzZXRDbG9iKGludCBpLCBDbG9iIGMpIHRocm93cyBTUUxFeGNl\ncHRpb24gewogICAgICAgICAgICAgICAgc2V0TG9nUGFyYW1ldGVyKGksICJD\nbG9iIiwgYyk7CiAgICAgICAgICAgICAgICBzdXBlci5zZXRDbG9iKGksIGMp\nOwogICAgICAgICAgICB9CgogICAgICAgICAgICBwdWJsaWMgdm9pZCBzZXRB\ncnJheShpbnQgaSwgQXJyYXkgYSkgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAg\nICAgICAgICAgICAgICBzZXRMb2dQYXJhbWV0ZXIoaSwgIkFycmF5IiwgYSk7\nCiAgICAgICAgICAgICAgICBzdXBlci5zZXRBcnJheShpLCBhKTsKICAgICAg\nICAgICAgfQoKICAgICAgICAgICAgcHVibGljIFJlc3VsdFNldE1ldGFEYXRh\nIGdldE1ldGFEYXRhKCkgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAg\nICAgICAgICByZXR1cm4gc3VwZXIuZ2V0TWV0YURhdGEoKTsKICAgICAgICAg\nICAgfQoKICAgICAgICAgICAgcHVibGljIHZvaWQgc2V0RGF0ZShpbnQgaSwg\nRGF0ZSBkLCBDYWxlbmRhciBjKSB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAg\nICAgICAgICAgICAgIHNldExvZ1BhcmFtZXRlcihpLCAiRGF0ZSIsIGQpOwog\nICAgICAgICAgICAgICAgc3VwZXIuc2V0RGF0ZShpLCBkLCBjKTsKICAgICAg\nICAgICAgfQoKICAgICAgICAgICAgcHVibGljIHZvaWQgc2V0VGltZShpbnQg\naSwgVGltZSB0LCBDYWxlbmRhciBjKSB0aHJvd3MgU1FMRXhjZXB0aW9uIHsK\nICAgICAgICAgICAgICAgIHNldExvZ1BhcmFtZXRlcihpLCAiVGltZSIsIHQp\nOwogICAgICAgICAgICAgICAgc3VwZXIuc2V0VGltZShpLCB0LCBjKTsKICAg\nICAgICAgICAgfQoKICAgICAgICAgICAgcHVibGljIHZvaWQgc2V0VGltZXN0\nYW1wKGludCBpLCBUaW1lc3RhbXAgdCwgQ2FsZW5kYXIgYykKICAgICAgICAg\nICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgICAgICAgICAg\nc2V0TG9nUGFyYW1ldGVyKGksICJUaW1lc3RhbXAiLCB0KTsKICAgICAgICAg\nICAgICAgIHN1cGVyLnNldFRpbWVzdGFtcChpLCB0LCBjKTsKICAgICAgICAg\nICAgfQoKICAgICAgICAgICAgcHVibGljIHZvaWQgc2V0TnVsbChpbnQgaTEs\nIGludCBpMiwgU3RyaW5nIHMpIHRocm93cyBTUUxFeGNlcHRpb24gewogICAg\nICAgICAgICAgICAgc2V0TG9nUGFyYW1ldGVyKGkxLCAibnVsbCIsIG51bGwp\nOwogICAgICAgICAgICAgICAgc3VwZXIuc2V0TnVsbChpMSwgaTIsIHMpOwog\nICAgICAgICAgICB9CgogICAgICAgICAgICBwcm90ZWN0ZWQgdm9pZCBhcHBl\nbmRJbmZvKFN0cmluZ0J1ZmZlciBidWYpIHsKICAgICAgICAgICAgICAgIGJ1\nZi5hcHBlbmQoIiAiKTsKICAgICAgICAgICAgICAgIGlmIChfZm9ybWF0dGVy\nICE9IG51bGwpIHsKICAgICAgICAgICAgICAgICAgICBidWYuYXBwZW5kKFNF\nUCk7CiAgICAgICAgICAgICAgICAgICAgYnVmLmFwcGVuZChfZm9ybWF0dGVy\nLnByZXR0eVByaW50KF9zcWwpKTsKICAgICAgICAgICAgICAgICAgICBidWYu\nYXBwZW5kKFNFUCk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAg\nICAgICAgICAgICAgIGJ1Zi5hcHBlbmQoX3NxbCk7CiAgICAgICAgICAgICAg\nICB9CgogICAgICAgICAgICAgICAgU3RyaW5nQnVpbGRlciBwYXJhbUJ1ZiA9\nIG51bGw7CiAgICAgICAgICAgICAgICBpZiAoX3BhcmFtcyAhPSBudWxsICYm\nICFfcGFyYW1zLmlzRW1wdHkoKSkgewogICAgICAgICAgICAgICAgICAgIHBh\ncmFtQnVmID0gbmV3IFN0cmluZ0J1aWxkZXIoKTsKICAgICAgICAgICAgICAg\nICAgICBmb3IgKEl0ZXJhdG9yPFN0cmluZz4gaXRyID0gX3BhcmFtcy5pdGVy\nYXRvcigpOyBpdHIKICAgICAgICAgICAgICAgICAgICAgICAgLmhhc05leHQo\nKTspIHsKICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1CdWYuYXBwZW5k\nKGl0ci5uZXh0KCkpOwogICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXRy\nLmhhc05leHQoKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFt\nQnVmLmFwcGVuZCgiLCAiKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAg\nICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgaWYgKHBhcmFtQnVmICE9\nIG51bGwpIHsKICAgICAgICAgICAgICAgICAgICBpZiAoIV9wcmV0dHlQcmlu\ndCkKICAgICAgICAgICAgICAgICAgICAgICAgYnVmLmFwcGVuZCgiICIpOwog\nICAgICAgICAgICAgICAgICAgIGJ1Zi5hcHBlbmQoIltwYXJhbXM9IikuCiAg\nICAgICAgICAgICAgICAgICAgICAgIGFwcGVuZChwYXJhbUJ1Zi50b1N0cmlu\nZygpKS5hcHBlbmQoIl0iKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAg\nICAgICAgIHN1cGVyLmFwcGVuZEluZm8oYnVmKTsKICAgICAgICAgICAgfQoK\nICAgICAgICAgICAgcHJvdGVjdGVkIHZvaWQgY2xlYXJMb2dQYXJhbWV0ZXJz\nKGJvb2xlYW4gYmF0Y2gpIHsKICAgICAgICAgICAgICAgIGlmIChfcGFyYW1z\nICE9IG51bGwpCiAgICAgICAgICAgICAgICAgICAgX3BhcmFtcy5jbGVhcigp\nOwogICAgICAgICAgICAgICAgaWYgKGJhdGNoICYmIF9wYXJhbUJhdGNoICE9\nIG51bGwpCiAgICAgICAgICAgICAgICAgICAgX3BhcmFtQmF0Y2guY2xlYXIo\nKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHJpdmF0ZSBib29sZWFu\nIHNob3VsZFRyYWNrUGFyYW1ldGVycygpIHsKICAgICAgICAgICAgICAgIHJl\ndHVybiBfdHJhY2tQYXJhbWV0ZXJzIHx8IF9sb2dzLmlzU1FMRW5hYmxlZCgp\nOwogICAgICAgICAgICB9CgogICAgICAgICAgICBwcml2YXRlIHZvaWQgc2V0\nTG9nUGFyYW1ldGVyKGludCBpbmRleCwgYm9vbGVhbiB2YWwpIHsKICAgICAg\nICAgICAgICAgIGlmIChzaG91bGRUcmFja1BhcmFtZXRlcnMoKSkKICAgICAg\nICAgICAgICAgICAgICBzZXRMb2dQYXJhbWV0ZXIoaW5kZXgsICIoYm9vbGVh\nbikgIiArIHZhbCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHByaXZh\ndGUgdm9pZCBzZXRMb2dQYXJhbWV0ZXIoaW50IGluZGV4LCBieXRlIHZhbCkg\newogICAgICAgICAgICAgICAgaWYgKHNob3VsZFRyYWNrUGFyYW1ldGVycygp\nKQogICAgICAgICAgICAgICAgICAgIHNldExvZ1BhcmFtZXRlcihpbmRleCwg\nIihieXRlKSAiICsgdmFsKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAg\ncHJpdmF0ZSB2b2lkIHNldExvZ1BhcmFtZXRlcihpbnQgaW5kZXgsIGRvdWJs\nZSB2YWwpIHsKICAgICAgICAgICAgICAgIGlmIChzaG91bGRUcmFja1BhcmFt\nZXRlcnMoKSkKICAgICAgICAgICAgICAgICAgICBzZXRMb2dQYXJhbWV0ZXIo\naW5kZXgsICIoZG91YmxlKSAiICsgdmFsKTsKICAgICAgICAgICAgfQoKICAg\nICAgICAgICAgcHJpdmF0ZSB2b2lkIHNldExvZ1BhcmFtZXRlcihpbnQgaW5k\nZXgsIGZsb2F0IHZhbCkgewogICAgICAgICAgICAgICAgaWYgKHNob3VsZFRy\nYWNrUGFyYW1ldGVycygpKQogICAgICAgICAgICAgICAgICAgIHNldExvZ1Bh\ncmFtZXRlcihpbmRleCwgIihmbG9hdCkgIiArIHZhbCk7CiAgICAgICAgICAg\nIH0KCiAgICAgICAgICAgIHByaXZhdGUgdm9pZCBzZXRMb2dQYXJhbWV0ZXIo\naW50IGluZGV4LCBpbnQgdmFsKSB7CiAgICAgICAgICAgICAgICBpZiAoc2hv\ndWxkVHJhY2tQYXJhbWV0ZXJzKCkpCiAgICAgICAgICAgICAgICAgICAgc2V0\nTG9nUGFyYW1ldGVyKGluZGV4LCAiKGludCkgIiArIHZhbCk7CiAgICAgICAg\nICAgIH0KCiAgICAgICAgICAgIHByaXZhdGUgdm9pZCBzZXRMb2dQYXJhbWV0\nZXIoaW50IGluZGV4LCBsb25nIHZhbCkgewogICAgICAgICAgICAgICAgaWYg\nKHNob3VsZFRyYWNrUGFyYW1ldGVycygpKQogICAgICAgICAgICAgICAgICAg\nIHNldExvZ1BhcmFtZXRlcihpbmRleCwgIihsb25nKSAiICsgdmFsKTsKICAg\nICAgICAgICAgfQoKICAgICAgICAgICAgcHJpdmF0ZSB2b2lkIHNldExvZ1Bh\ncmFtZXRlcihpbnQgaW5kZXgsIHNob3J0IHZhbCkgewogICAgICAgICAgICAg\nICAgaWYgKHNob3VsZFRyYWNrUGFyYW1ldGVycygpKQogICAgICAgICAgICAg\nICAgICAgIHNldExvZ1BhcmFtZXRlcihpbmRleCwgIihzaG9ydCkgIiArIHZh\nbCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHByaXZhdGUgdm9pZCBz\nZXRMb2dQYXJhbWV0ZXIoaW50IGluZGV4LCBTdHJpbmcgdHlwZSwgT2JqZWN0\nIHZhbCkgewogICAgICAgICAgICAgICAgaWYgKHNob3VsZFRyYWNrUGFyYW1l\ndGVycygpKQogICAgICAgICAgICAgICAgICAgIHNldExvZ1BhcmFtZXRlcihp\nbmRleCwgIigiICsgdHlwZSArICIpICIgKyB2YWwpOwogICAgICAgICAgICB9\nCgogICAgICAgICAgICBwcml2YXRlIHZvaWQgc2V0TG9nUGFyYW1ldGVyKGlu\ndCBpbmRleCwgU3RyaW5nIHZhbCkgewogICAgICAgICAgICAgICAgaWYgKF9w\nYXJhbXMgPT0gbnVsbCkKICAgICAgICAgICAgICAgICAgICBfcGFyYW1zID0g\nbmV3IEFycmF5TGlzdDxTdHJpbmc+KCk7CiAgICAgICAgICAgICAgICB3aGls\nZSAoX3BhcmFtcy5zaXplKCkgPCBpbmRleCkKICAgICAgICAgICAgICAgICAg\nICBfcGFyYW1zLmFkZChudWxsKTsKICAgICAgICAgICAgICAgIGlmICh2YWwu\nbGVuZ3RoKCkgPiA4MCkKICAgICAgICAgICAgICAgICAgICB2YWwgPSB2YWwu\nc3Vic3RyaW5nKDAsIDc3KSArICIuLi4iOwogICAgICAgICAgICAgICAgX3Bh\ncmFtcy5zZXQoaW5kZXggLSAxLCB2YWwpOwogICAgICAgICAgICB9CiAgICAg\nICAgfQogICAgfSAgIAp9Cg==\n","encoding":"base64"}

