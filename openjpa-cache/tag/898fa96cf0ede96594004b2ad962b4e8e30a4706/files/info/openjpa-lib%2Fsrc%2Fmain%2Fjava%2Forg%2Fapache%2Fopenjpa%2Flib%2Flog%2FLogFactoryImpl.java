{"sha":"25769170d1132762a1130475fdd515f919c50564","node_id":"MDQ6QmxvYjIwNjM2NDoyNTc2OTE3MGQxMTMyNzYyYTExMzA0NzVmZGQ1MTVmOTE5YzUwNTY0","size":11931,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/25769170d1132762a1130475fdd515f919c50564","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEubGliLmxvZzsKCmltcG9ydCBq\nYXZhLmlvLkZpbGU7CmltcG9ydCBqYXZhLmlvLkZpbGVPdXRwdXRTdHJlYW07\nCmltcG9ydCBqYXZhLmlvLklPRXhjZXB0aW9uOwppbXBvcnQgamF2YS5pby5Q\ncmludFN0cmVhbTsKaW1wb3J0IGphdmEuaW8uUHJpbnRXcml0ZXI7CmltcG9y\ndCBqYXZhLmlvLlN0cmluZ1dyaXRlcjsKaW1wb3J0IGphdmEuc2VjdXJpdHku\nQWNjZXNzQ29udHJvbGxlcjsKaW1wb3J0IGphdmEuc2VjdXJpdHkuUHJpdmls\nZWdlZEFjdGlvbkV4Y2VwdGlvbjsKaW1wb3J0IGphdmEudXRpbC5IYXNoTWFw\nOwppbXBvcnQgamF2YS51dGlsLkl0ZXJhdG9yOwppbXBvcnQgamF2YS51dGls\nLkxvY2FsZTsKaW1wb3J0IGphdmEudXRpbC5NYXA7CgppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLmxpYi5jb25mLkNvbmZpZ3VyYWJsZTsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5saWIuY29uZi5Db25maWd1cmF0aW9uOwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi5jb25mLkdlbmVyaWNDb25maWd1\ncmFibGU7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuRmls\nZXM7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuSjJEb1By\naXZIZWxwZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwu\nTG9jYWxpemVyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51dGls\nLk9wdGlvbnM7CmltcG9ydCBqYXZhLnV0aWwuY29uY3VycmVudC5Db25jdXJy\nZW50SGFzaE1hcDsKCi8qKgogKiBEZWZhdWx0IHtAbGluayBMb2dGYWN0b3J5\nfSBpbXBsZW1lbnRhdGlvbi4gRm9yIGVhc2Ugb2YgYXV0b21hdGljCiAqIGNv\nbmZpZ3VyYXRpb24sIHRoaXMgaW1wbGVtZW50YXRpb24ga2V5cyBvbiBvbmx5\nIHRoZSBsYXN0IGRvdC1zZXBhcmF0ZWQKICogdG9rZW4gb2YgdGhlIGxvZyBj\naGFubmVsIG5hbWUuCiAqCiAqIEBhdXRob3IgUGF0cmljayBMaW5za2V5CiAq\nLwpwdWJsaWMgY2xhc3MgTG9nRmFjdG9yeUltcGwgCiAgICBpbXBsZW1lbnRz\nIExvZ0ZhY3RvcnksIEdlbmVyaWNDb25maWd1cmFibGUsIENvbmZpZ3VyYWJs\nZSB7CgogICAgcHJpdmF0ZSBzdGF0aWMgTG9jYWxpemVyIF9sb2MgPSBMb2Nh\nbGl6ZXIuZm9yUGFja2FnZShMb2dGYWN0b3J5SW1wbC5jbGFzcyk7CiAgICBw\ncml2YXRlIHN0YXRpYyBMb2NhbGl6ZXIgX2xvY0VuID0gTG9jYWxpemVyLmZv\nclBhY2thZ2UoCiAgICAgICAgTG9nRmFjdG9yeUltcGwuY2xhc3MsIExvY2Fs\nZS5FTkdMSVNIKTsKCiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIFN0cmluZyBU\nUkFDRV9TVFIgPSBfbG9jRW4uZ2V0KCJsb2ctdHJhY2UiKS5nZXRNZXNzYWdl\nKCk7CiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIFN0cmluZyBJTkZPX1NUUiA9\nIF9sb2NFbi5nZXQoImxvZy1pbmZvIikuZ2V0TWVzc2FnZSgpOwogICAgcHVi\nbGljIHN0YXRpYyBmaW5hbCBTdHJpbmcgV0FSTl9TVFIgPSBfbG9jRW4uZ2V0\nKCJsb2ctd2FybiIpLmdldE1lc3NhZ2UoKTsKICAgIHB1YmxpYyBzdGF0aWMg\nZmluYWwgU3RyaW5nIEVSUk9SX1NUUiA9IF9sb2NFbi5nZXQoImxvZy1lcnJv\nciIpLmdldE1lc3NhZ2UoKTsKICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgU3Ry\naW5nIEZBVEFMX1NUUiA9IF9sb2NFbi5nZXQoImxvZy1mYXRhbCIpLmdldE1l\nc3NhZ2UoKTsKCiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIFN0cmluZyBTVERP\nVVQgPSAic3Rkb3V0IjsKICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgU3RyaW5n\nIFNUREVSUiA9ICJzdGRlcnIiOwoKICAgIHByaXZhdGUgc3RhdGljIGZpbmFs\nIFN0cmluZyBORVdMSU5FID0gSjJEb1ByaXZIZWxwZXIuZ2V0TGluZVNlcGFy\nYXRvcigpOwoKICAgIC8qKgogICAgICogVGhlIHRpbWUgYXQgd2hpY2ggdGhp\ncyBmYWN0b3J5IHdhcyBpbml0aWFsaXplZC4KICAgICAqLwogICAgcHJvdGVj\ndGVkIGZpbmFsIGxvbmcgaW5pdGlhbGl6YXRpb25NaWxsaXM7CgogICAgLyoq\nCiAgICAgKiBUaGUge0BsaW5rIExvZ31zIHRoYXQgdGhpcyBmYWN0b3J5IG1h\nbmFnZXMsIGtleWVkIGJ5IGxvZyBjaGFubmVsIG5hbWUuCiAgICAgKi8KICAg\nIHByaXZhdGUgTWFwPFN0cmluZywgTG9nSW1wbD4gX2xvZ3MgPQogICAgICAg\nIG5ldyBDb25jdXJyZW50SGFzaE1hcDxTdHJpbmcsIExvZ0ltcGw+KCk7IAoK\nICAgIC8qKgogICAgICogVGhlIGRlZmF1bHQgbG9nZ2luZyBsZXZlbC4KICAg\nICAqLwogICAgcHJpdmF0ZSBzaG9ydCBfZGVmYXVsdExvZ0xldmVsID0gTG9n\nLklORk87CgogICAgLyoqCiAgICAgKiBTdG9yYWdlIGZvciBsb2dnaW5nIGxl\ndmVsIGNvbmZpZ3VyYXRpb24gc3BlY2lmaWVkIGF0IGNvbmZpZ3VyYXRpb24g\ndGltZS4KICAgICAqLwogICAgcHJpdmF0ZSBNYXA8U3RyaW5nLCBTaG9ydD4g\nX2NvbmZpZ3VyZWRMZXZlbHMgPQogICAgICAgIG5ldyBIYXNoTWFwPFN0cmlu\nZywgU2hvcnQ+KCk7IAoKICAgIC8qKgogICAgICogVGhlIHN0cmVhbSB0byB3\ncml0ZSB0by4gRGVmYXVsdHMgdG8gU3lzdGVtLmVyci4KICAgICAqLwogICAg\ncHJpdmF0ZSBQcmludFN0cmVhbSBfb3V0ID0gU3lzdGVtLmVycjsKCiAgICAv\nKioKICAgICAqIEEgdG9rZW4gdG8gYWRkIHRvIGFsbCBsb2cgbWVzc2FnZXMu\nIElmIDxjb2RlPm51bGw8L2NvZGU+LCB0aGUgCiAgICAgKiBjb25maWd1cmF0\naW9uJ3MgaWQgd2lsbCBiZSB1c2VkLgogICAgICovCiAgICBwcml2YXRlIFN0\ncmluZyBfZGlhZ0NvbnRleHQgPSBudWxsOwogICAgcHJpdmF0ZSBib29sZWFu\nIF9kaWFnQ29udGV4dENvbXB1dGVkID0gZmFsc2U7CiAgICAKICAgIHByaXZh\ndGUgQ29uZmlndXJhdGlvbiBfY29uZjsKCgogICAgcHVibGljIExvZ0ZhY3Rv\ncnlJbXBsKCkgewogICAgICAgIGluaXRpYWxpemF0aW9uTWlsbGlzID0gU3lz\ndGVtLmN1cnJlbnRUaW1lTWlsbGlzKCk7CiAgICB9CgogICAgcHVibGljIExv\nZyBnZXRMb2coU3RyaW5nIGNoYW5uZWwpIHsKICAgICAgICAvLyBubyBsb2Nr\naW5nOyBvayBpZiBzYW1lIGxvZyBjcmVhdGVkIG11bHRpcGxlIHRpbWVzCiAg\nICAgICAgTG9nSW1wbCBsID0gX2xvZ3MuZ2V0KGNoYW5uZWwpOwogICAgICAg\nIGlmIChsID09IG51bGwpIHsKICAgICAgICAgICAgbCA9IG5ld0xvZ0ltcGwo\nKTsKICAgICAgICAgICAgbC5zZXRDaGFubmVsKGNoYW5uZWwpOyAgLy8gVE9E\nTyBhZGQgdG8gaW50ZXJmYWNlPwogICAgICAgICAgICBTaG9ydCBsdmwgPSBf\nY29uZmlndXJlZExldmVscy5nZXQoc2hvcnRlbihjaGFubmVsKSk7CiAgICAg\nICAgICAgIGwuc2V0TGV2ZWwobHZsID09IG51bGwgPyBfZGVmYXVsdExvZ0xl\ndmVsIDogbHZsLnNob3J0VmFsdWUoKSk7CiAgICAgICAgICAgIF9sb2dzLnB1\ndChjaGFubmVsLCBsKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGw7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBDcmVhdGUgYSBuZXcgbG9nLiBUaGUgbG9n\nIHdpbGwgYmUgY2FjaGVkLgogICAgICovCiAgICBwcm90ZWN0ZWQgTG9nSW1w\nbCBuZXdMb2dJbXBsKCkgewogICAgICAgIHJldHVybiBuZXcgTG9nSW1wbCgp\nOwogICAgfQoKICAgIC8qKgogICAgICogVGhlIHN0cmluZyBuYW1lIG9mIHRo\nZSBkZWZhdWx0IGxldmVsIGZvciB1bmNvbmZpZ3VyZWQgbG9nIGNoYW5uZWxz\nOwogICAgICogdXNlZCBmb3IgYXV0b21hdGljIGNvbmZpZ3VyYXRpb24uCiAg\nICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldERlZmF1bHRMZXZlbChTdHJpbmcg\nbGV2ZWwpIHsKICAgICAgICBfZGVmYXVsdExvZ0xldmVsID0gZ2V0TGV2ZWwo\nbGV2ZWwpOwogICAgfQoKICAgIC8qKgogICAgICogVGhlIGRlZmF1bHQgbGV2\nZWwgZm9yIHVuY29uZmlndXJlZCBsb2cgY2hhbm5lbHMuCiAgICAgKi8KICAg\nIHB1YmxpYyBzaG9ydCBnZXREZWZhdWx0TGV2ZWwoKSB7CiAgICAgICAgcmV0\ndXJuIF9kZWZhdWx0TG9nTGV2ZWw7CiAgICB9CgogICAgLyoqCiAgICAgKiBU\naGUgZGVmYXVsdCBsZXZlbCBmb3IgdW5jb25maWd1cmVkIGxvZyBjaGFubmVs\ncy4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0RGVmYXVsdExldmVsKHNo\nb3J0IGxldmVsKSB7CiAgICAgICAgX2RlZmF1bHRMb2dMZXZlbCA9IGxldmVs\nOwogICAgfQoKICAgIC8qKgogICAgICogQSBzdHJpbmcgdG8gcHJlZml4IGFs\nbCBsb2cgbWVzc2FnZXMgd2l0aC4gU2V0IHRvCiAgICAgKiA8Y29kZT5udWxs\nPC9jb2RlPiB0byB1c2UgdGhlIGNvbmZpZ3VyYXRpb24ncyBJZCBwcm9wZXJ0\neSBzZXR0aW5nLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXREaWFnbm9z\ndGljQ29udGV4dChTdHJpbmcgdmFsKSB7CiAgICAgICAgX2RpYWdDb250ZXh0\nID0gdmFsOwogICAgfQoKICAgIC8qKgogICAgICogQSBzdHJpbmcgdG8gcHJl\nZml4IGFsbCBsb2cgbWVzc2FnZXMgd2l0aC4gU2V0IHRvCiAgICAgKiA8Y29k\nZT5udWxsPC9jb2RlPiB0byB1c2UgdGhlIGNvbmZpZ3VyYXRpb24ncyBJZCBw\ncm9wZXJ0eSBzZXR0aW5nLgogICAgICovCiAgICBwdWJsaWMgU3RyaW5nIGdl\ndERpYWdub3N0aWNDb250ZXh0KCkgewogICAgICAgIGlmICghX2RpYWdDb250\nZXh0Q29tcHV0ZWQpIHsKICAgICAgICAgICAgLy8gdGhpcyBpbml0aWFsaXph\ndGlvbiBoYXMgdG8gaGFwcGVuIGxhemlseSBiZWNhdXNlIHRoZXJlIGlzIG5v\nCiAgICAgICAgICAgIC8vIGd1YXJhbnRlZSB0aGF0IGNvbmYuZ2V0SWQoKSB3\naWxsIGJlIHBvcHVsYXRlZCBieSB0aGUgdGltZSB0aGF0CiAgICAgICAgICAg\nIC8vIGVuZENvbmZpZ3VyYXRpb24oKSBpcyBjYWxsZWQuCiAgICAgICAgICAg\nIGlmIChfZGlhZ0NvbnRleHQgPT0gbnVsbCAmJiBfY29uZiAhPSBudWxsKSB7\nCiAgICAgICAgICAgICAgICBfZGlhZ0NvbnRleHQgPSBfY29uZi5nZXRJZCgp\nOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmICgiIi5lcXVhbHMoX2Rp\nYWdDb250ZXh0KSkKICAgICAgICAgICAgICAgIF9kaWFnQ29udGV4dCA9IG51\nbGw7CiAgICAgICAgICAgIF9kaWFnQ29udGV4dENvbXB1dGVkID0gdHJ1ZTsK\nICAgICAgICB9CiAgICAgICAgcmV0dXJuIF9kaWFnQ29udGV4dDsKICAgIH0K\nCiAgICAvKioKICAgICAqIFRoZSBzdHJlYW0gdG8gd3JpdGUgdG8uIFJlY29n\nbml6ZWQgdmFsdWVzIGFyZTogPGNvZGU+c3Rkb3V0PC9jb2RlPgogICAgICog\nYW5kIDxjb2RlPnN0ZGVycjwvY29kZT4uIEFueSBvdGhlciB2YWx1ZSB3aWxs\nIGJlIGNvbnNpZGVyZWQgYSBmaWxlIG5hbWUuCiAgICAgKi8KICAgIHB1Ymxp\nYyB2b2lkIHNldEZpbGUoU3RyaW5nIGZpbGUpIHsKICAgICAgICBpZiAoU1RE\nT1VULmVxdWFscyhmaWxlKSkKICAgICAgICAgICAgX291dCA9IFN5c3RlbS5v\ndXQ7CiAgICAgICAgZWxzZSBpZiAoU1RERVJSLmVxdWFscyhmaWxlKSkKICAg\nICAgICAgICAgX291dCA9IFN5c3RlbS5lcnI7CiAgICAgICAgZWxzZSB7CiAg\nICAgICAgICAgIEZpbGUgZiA9IEZpbGVzLmdldEZpbGUoZmlsZSwgbnVsbCk7\nCiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBfb3V0ID0gbmV3\nIFByaW50U3RyZWFtKChGaWxlT3V0cHV0U3RyZWFtKQogICAgICAgICAgICAg\nICAgICAgIEFjY2Vzc0NvbnRyb2xsZXIuZG9Qcml2aWxlZ2VkKAogICAgICAg\nICAgICAgICAgICAgICAgICBKMkRvUHJpdkhlbHBlci5uZXdGaWxlT3V0cHV0\nU3RyZWFtQWN0aW9uKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgQWNj\nZXNzQ29udHJvbGxlci5kb1ByaXZpbGVnZWQoCiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgSjJEb1ByaXZIZWxwZXIuZ2V0Q2Fub25pY2FsUGF0\naEFjdGlvbihmKSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnVl\nKSkpOwogICAgICAgICAgICB9IGNhdGNoIChQcml2aWxlZ2VkQWN0aW9uRXhj\nZXB0aW9uIHBhZSkgewogICAgICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVn\nYWxBcmd1bWVudEV4Y2VwdGlvbihfbG9jLmdldCgibG9nLWJhZC1maWxlIiwK\nICAgICAgICAgICAgICAgICAgICAgICAgZmlsZSkgKyAiICIgKyBwYWUuZ2V0\nRXhjZXB0aW9uKCkpOwogICAgICAgICAgICB9IGNhdGNoIChJT0V4Y2VwdGlv\nbiBpb2UpIHsKICAgICAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJn\ndW1lbnRFeGNlcHRpb24oX2xvYy5nZXQoImxvZy1iYWQtZmlsZSIsCiAgICAg\nICAgICAgICAgICAgICAgZmlsZSkgKyAiICIgKyBpb2UudG9TdHJpbmcoKSk7\nCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAg\nKiBUaGUgc3RyZWFtIHRvIHdyaXRlIHRvLgogICAgICovCiAgICBwdWJsaWMg\nUHJpbnRTdHJlYW0gZ2V0U3RyZWFtKCkgewogICAgICAgIHJldHVybiBfb3V0\nOwogICAgfQoKICAgIC8qKgogICAgICogVGhlIHN0cmVhbSB0byB3cml0ZSB0\nby4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0U3RyZWFtKFByaW50U3Ry\nZWFtIHN0cmVhbSkgewogICAgICAgIGlmIChzdHJlYW0gPT0gbnVsbCkKICAg\nICAgICAgICAgdGhyb3cgbmV3IE51bGxQb2ludGVyRXhjZXB0aW9uKCJzdHJl\nYW0gPT0gbnVsbCIpOwogICAgICAgIF9vdXQgPSBzdHJlYW07CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBSZXR1cm5zIGEgc3RyaW5nIHJlcHJlc2VudGF0aW9u\nIG9mIHRoZSBzcGVjaWZpZWQgbG9nIGxldmVsIGNvbnN0YW50LgogICAgICov\nCiAgICBwdWJsaWMgc3RhdGljIFN0cmluZyBnZXRMZXZlbE5hbWUoc2hvcnQg\nbGV2ZWwpIHsKICAgICAgICBzd2l0Y2ggKGxldmVsKSB7CiAgICAgICAgICAg\nIGNhc2UgTG9nLlRSQUNFOgogICAgICAgICAgICAgICAgcmV0dXJuIFRSQUNF\nX1NUUjsKICAgICAgICAgICAgY2FzZSBMb2cuSU5GTzoKICAgICAgICAgICAg\nICAgIHJldHVybiBJTkZPX1NUUjsKICAgICAgICAgICAgY2FzZSBMb2cuV0FS\nTjoKICAgICAgICAgICAgICAgIHJldHVybiBXQVJOX1NUUjsKICAgICAgICAg\nICAgY2FzZSBMb2cuRVJST1I6CiAgICAgICAgICAgICAgICByZXR1cm4gRVJS\nT1JfU1RSOwogICAgICAgICAgICBjYXNlIExvZy5GQVRBTDoKICAgICAgICAg\nICAgICAgIHJldHVybiBGQVRBTF9TVFI7CiAgICAgICAgICAgIGRlZmF1bHQ6\nCiAgICAgICAgICAgICAgICByZXR1cm4gX2xvY0VuLmdldCgibG9nLXVua25v\nd24iKS5nZXRNZXNzYWdlKCk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgog\nICAgICogUmV0dXJucyBhIHN5bWJvbGljIGNvbnN0YW50IGZvciB0aGUgc3Bl\nY2lmaWVkIHN0cmluZyBsZXZlbC4KICAgICAqLwogICAgcHVibGljIHN0YXRp\nYyBzaG9ydCBnZXRMZXZlbChTdHJpbmcgc3RyKSB7CiAgICAgICAgc3RyID0g\nc3RyLnRvVXBwZXJDYXNlKExvY2FsZS5FTkdMSVNIKS50cmltKCk7CiAgICAg\nICAgc2hvcnQgdmFsID0gVFJBQ0VfU1RSLmVxdWFscyhzdHIpID8gTG9nLlRS\nQUNFIDoKICAgICAgICAgICAgSU5GT19TVFIuZXF1YWxzKHN0cikgPyBMb2cu\nSU5GTyA6CiAgICAgICAgICAgICAgICBXQVJOX1NUUi5lcXVhbHMoc3RyKSA/\nIExvZy5XQVJOIDoKICAgICAgICAgICAgICAgICAgICBFUlJPUl9TVFIuZXF1\nYWxzKHN0cikgPyBMb2cuRVJST1IgOgogICAgICAgICAgICAgICAgICAgICAg\nICBGQVRBTF9TVFIuZXF1YWxzKHN0cikgPyBMb2cuRkFUQUwgOiAtMTsKCiAg\nICAgICAgaWYgKHZhbCA9PSAtMSkKICAgICAgICAgICAgdGhyb3cgbmV3IEls\nbGVnYWxBcmd1bWVudEV4Y2VwdGlvbgogICAgICAgICAgICAgICAgKF9sb2Mu\nZ2V0KCJsb2ctYmFkLWNvbnN0YW50Iiwgc3RyKS5nZXRNZXNzYWdlKCkpOwoK\nICAgICAgICByZXR1cm4gdmFsOwogICAgfQoKICAgIC8vIC0tLS0tLS0tLS0g\nQ29uZmlndXJhYmxlIGltcGxlbWVudGF0aW9uIC0tLS0tLS0tLS0KICAgIAog\nICAgcHVibGljIHZvaWQgc2V0Q29uZmlndXJhdGlvbihDb25maWd1cmF0aW9u\nIGNvbmYpIHsKICAgICAgICBfY29uZiA9IGNvbmY7CiAgICB9CiAgICAKICAg\nIHB1YmxpYyB2b2lkIHN0YXJ0Q29uZmlndXJhdGlvbigpIHsKICAgIH0KCiAg\nICBwdWJsaWMgdm9pZCBlbmRDb25maWd1cmF0aW9uKCkgewogICAgfQoKICAg\nIC8vIC0tLS0tLS0tLS0gR2VuZXJpY0NvbmZpZ3VyYWJsZSBpbXBsZW1lbnRh\ndGlvbiAtLS0tLS0tLS0tCgogICAgcHVibGljIHZvaWQgc2V0SW50byhPcHRp\nb25zIG9wdHMpIHsKICAgICAgICBpZiAoIW9wdHMuaXNFbXB0eSgpKSB7CiAg\nICAgICAgICAgIE1hcC5FbnRyeTxPYmplY3QsIE9iamVjdD4gZTsKICAgICAg\nICAgICAgZm9yIChJdGVyYXRvcjxNYXAuRW50cnk8T2JqZWN0LCBPYmplY3Q+\nPiBpdGVyID0KICAgICAgICAgICAgICAgIG9wdHMuZW50cnlTZXQoKS5pdGVy\nYXRvcigpOyBpdGVyLmhhc05leHQoKTspIHsKICAgICAgICAgICAgICAgIGUg\nPSBpdGVyLm5leHQoKTsKICAgICAgICAgICAgICAgIF9jb25maWd1cmVkTGV2\nZWxzLnB1dChzaG9ydGVuKChTdHJpbmcpIGUuZ2V0S2V5KCkpLCBuZXcgU2hv\ncnQoCiAgICAgICAgICAgICAgICAgICAgZ2V0TGV2ZWwoKFN0cmluZykgZS5n\nZXRWYWx1ZSgpKSkpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIG9wdHMu\nY2xlYXIoKTsKICAgICAgICB9CiAgICB9CgogICAgcHJpdmF0ZSBzdGF0aWMg\nU3RyaW5nIHNob3J0ZW4oU3RyaW5nIGNoYW5uZWwpIHsKICAgICAgICByZXR1\ncm4gY2hhbm5lbC5zdWJzdHJpbmcoY2hhbm5lbC5sYXN0SW5kZXhPZignLicp\nICsgMSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBBIHNpbXBsZSBpbXBsZW1l\nbnRhdGlvbiBvZiB0aGUge0BsaW5rIExvZ30gaW50ZXJmYWNlLiBXcml0ZXMK\nICAgICAqIG91dHB1dCB0byBzdGRlcnIuCiAgICAgKi8KICAgIHB1YmxpYyBj\nbGFzcyBMb2dJbXBsIGV4dGVuZHMgQWJzdHJhY3RMb2cgewoKICAgICAgICBw\ncml2YXRlIHNob3J0IF9sZXZlbCA9IElORk87CiAgICAgICAgcHJpdmF0ZSBT\ndHJpbmcgX2NoYW5uZWw7CgogICAgICAgIHByb3RlY3RlZCBib29sZWFuIGlz\nRW5hYmxlZChzaG9ydCBsZXZlbCkgewogICAgICAgICAgICByZXR1cm4gbGV2\nZWwgPj0gX2xldmVsOwogICAgICAgIH0KCiAgICAgICAgcHJvdGVjdGVkIHZv\naWQgbG9nKHNob3J0IGxldmVsLCBTdHJpbmcgbWVzc2FnZSwgVGhyb3dhYmxl\nIHQpIHsKICAgICAgICAgICAgU3RyaW5nIG1zZyA9IGZvcm1hdE1lc3NhZ2Uo\nbGV2ZWwsIG1lc3NhZ2UsIHQpOwogICAgICAgICAgICBzeW5jaHJvbml6ZWQg\nKF9vdXQpIHsKICAgICAgICAgICAgICAgIF9vdXQucHJpbnQobXNnKTsKICAg\nICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgLyoqCiAgICAgICAgICog\nQ29udmVydCA8Y29kZT5tZXNzYWdlPC9jb2RlPiBpbnRvIGEgc3RyaW5nIHJl\nYWR5IHRvIGJlIHdyaXR0ZW4gdG8KICAgICAgICAgKiB0aGUgbG9nLiBUaGUg\nc3RyaW5nIHNob3VsZCBpbmNsdWRlIHRoZSB0ZXJtaW5hdGluZyBuZXdsaW5l\nLgogICAgICAgICAqCiAgICAgICAgICogQHBhcmFtIHQgbWF5IGJlIG51bGwK\nICAgICAgICAgKi8KICAgICAgICBwcm90ZWN0ZWQgU3RyaW5nIGZvcm1hdE1l\nc3NhZ2Uoc2hvcnQgbGV2ZWwsIFN0cmluZyBtZXNzYWdlLAogICAgICAgICAg\nICBUaHJvd2FibGUgdCkgewogICAgICAgICAgICAvLyB3ZSB3cml0ZSB0byBh\nIFN0cmluZ0J1aWxkZXIgYW5kIHRoZW4gZmx1c2ggaXQgYWxsIGF0CiAgICAg\nICAgICAgIC8vIG9uY2UgYXMgYSBzaW5nbGUgbGluZSwgc2luY2Ugc29tZSBl\nbnZpcm9ubWVudHMoZS5nLiwgSkJvc3MpCiAgICAgICAgICAgIC8vIG92ZXJy\naWRlIHRoZSBTeXN0ZW0gb3V0cHV0IHN0cmVhbSB0byBmbHVzaCBhbnkgY2Fs\nbHMKICAgICAgICAgICAgLy8gdG8gd3JpdGUgd2l0aG91dCByZWdhcmQgdG8g\nbGluZSBicmVha3MsIG1ha2luZyB0aGUKICAgICAgICAgICAgLy8gb3V0cHV0\nIGluY29tcHJlaGVuc2liZS4KICAgICAgICAgICAgU3RyaW5nQnVpbGRlciBi\ndWYgPSBuZXcgU3RyaW5nQnVpbGRlcigpOwoKICAgICAgICAgICAgYnVmLmFw\ncGVuZChnZXRPZmZzZXQoKSk7CiAgICAgICAgICAgIGJ1Zi5hcHBlbmQoIiAg\nIik7CiAgICAgICAgICAgIGlmIChnZXREaWFnbm9zdGljQ29udGV4dCgpICE9\nIG51bGwpCiAgICAgICAgICAgICAgICBidWYuYXBwZW5kKGdldERpYWdub3N0\naWNDb250ZXh0KCkpLmFwcGVuZCgiICAiKTsKICAgICAgICAgICAgYnVmLmFw\ncGVuZChnZXRMZXZlbE5hbWUobGV2ZWwpKTsKICAgICAgICAgICAgaWYgKGxl\ndmVsID09IElORk8gfHwgbGV2ZWwgPT0gV0FSTikKICAgICAgICAgICAgICAg\nIGJ1Zi5hcHBlbmQoIiAiKTsKICAgICAgICAgICAgYnVmLmFwcGVuZCgiICBb\nIik7CiAgICAgICAgICAgIGJ1Zi5hcHBlbmQoVGhyZWFkLmN1cnJlbnRUaHJl\nYWQoKS5nZXROYW1lKCkpOwogICAgICAgICAgICBidWYuYXBwZW5kKCJdICIp\nOwogICAgICAgICAgICBidWYuYXBwZW5kKF9jaGFubmVsKTsKICAgICAgICAg\nICAgYnVmLmFwcGVuZCgiIC0gIik7CiAgICAgICAgICAgIGJ1Zi5hcHBlbmQo\nbWVzc2FnZSk7CiAgICAgICAgICAgIGJ1Zi5hcHBlbmQoTkVXTElORSk7Cgog\nICAgICAgICAgICBpZiAodCAhPSBudWxsKSB7CiAgICAgICAgICAgICAgICBT\ndHJpbmdXcml0ZXIgc3dyaXRlciA9IG5ldyBTdHJpbmdXcml0ZXIoKTsKICAg\nICAgICAgICAgICAgIFByaW50V3JpdGVyIHB3cml0ZXIgPSBuZXcgUHJpbnRX\ncml0ZXIoc3dyaXRlcik7CiAgICAgICAgICAgICAgICB0LnByaW50U3RhY2tU\ncmFjZShwd3JpdGVyKTsKICAgICAgICAgICAgICAgIHB3cml0ZXIuZmx1c2go\nKTsKICAgICAgICAgICAgICAgIGJ1Zi5hcHBlbmQoc3dyaXRlci50b1N0cmlu\nZygpKTsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gYnVmLnRv\nU3RyaW5nKCk7CiAgICAgICAgfQoKICAgICAgICBwcml2YXRlIGxvbmcgZ2V0\nT2Zmc2V0KCkgewogICAgICAgICAgICByZXR1cm4gU3lzdGVtLmN1cnJlbnRU\naW1lTWlsbGlzKCkgLSBpbml0aWFsaXphdGlvbk1pbGxpczsKICAgICAgICB9\nCgogICAgICAgIHB1YmxpYyB2b2lkIHNldENoYW5uZWwoU3RyaW5nIHZhbCkg\newogICAgICAgICAgICBfY2hhbm5lbCA9IHZhbDsKICAgICAgICB9CgogICAg\nICAgIHB1YmxpYyBTdHJpbmcgZ2V0Q2hhbm5lbCgpIHsKICAgICAgICAgICAg\ncmV0dXJuIF9jaGFubmVsOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIHZv\naWQgc2V0TGV2ZWwoc2hvcnQgdmFsKSB7CiAgICAgICAgICAgIF9sZXZlbCA9\nIHZhbDsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBzaG9ydCBnZXRMZXZl\nbCgpIHsKICAgICAgICAgICAgcmV0dXJuIF9sZXZlbDsKICAgICAgICB9CiAg\nICB9Cn0K\n","encoding":"base64"}

