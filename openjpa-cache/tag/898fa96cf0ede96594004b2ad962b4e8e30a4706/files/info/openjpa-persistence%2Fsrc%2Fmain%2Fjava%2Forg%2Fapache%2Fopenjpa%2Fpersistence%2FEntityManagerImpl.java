{"sha":"357a6e7447a9b0c37f4364a287bfc7653ddc6b72","node_id":"MDQ6QmxvYjIwNjM2NDozNTdhNmU3NDQ3YTliMGMzN2Y0MzY0YTI4N2JmYzc2NTNkZGM2Yjcy","size":58684,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/357a6e7447a9b0c37f4364a287bfc7653ddc6b72","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2U7CgppbXBv\ncnQgamF2YS5pby5CeXRlQXJyYXlJbnB1dFN0cmVhbTsKaW1wb3J0IGphdmEu\naW8uQnl0ZUFycmF5T3V0cHV0U3RyZWFtOwppbXBvcnQgamF2YS5pby5FeHRl\ncm5hbGl6YWJsZTsKaW1wb3J0IGphdmEuaW8uSU9FeGNlcHRpb247CmltcG9y\ndCBqYXZhLmlvLk9iamVjdElucHV0OwppbXBvcnQgamF2YS5pby5PYmplY3RJ\nbnB1dFN0cmVhbTsKaW1wb3J0IGphdmEuaW8uT2JqZWN0T3V0cHV0OwppbXBv\ncnQgamF2YS5pby5PYmplY3RPdXRwdXRTdHJlYW07CmltcG9ydCBqYXZhLmlv\nLk9iamVjdFN0cmVhbUNsYXNzOwppbXBvcnQgamF2YS5sYW5nLnJlZmxlY3Qu\nQXJyYXk7CmltcG9ydCBqYXZhLmxhbmcucmVmbGVjdC5GaWVsZDsKaW1wb3J0\nIGphdmEubGFuZy5yZWZsZWN0Lk1ldGhvZDsKaW1wb3J0IGphdmEudXRpbC5B\ncnJheXM7CmltcG9ydCBqYXZhLnV0aWwuQ29sbGVjdGlvbjsKaW1wb3J0IGph\ndmEudXRpbC5FbnVtU2V0OwppbXBvcnQgamF2YS51dGlsLklkZW50aXR5SGFz\naE1hcDsKaW1wb3J0IGphdmEudXRpbC5NYXA7CmltcG9ydCBqYXZhLnV0aWwu\nU2V0OwoKaW1wb3J0IGphdmF4LnBlcnNpc3RlbmNlLkNhY2hlUmV0cmlldmVN\nb2RlOwppbXBvcnQgamF2YXgucGVyc2lzdGVuY2UuQ2FjaGVTdG9yZU1vZGU7\nCmltcG9ydCBqYXZheC5wZXJzaXN0ZW5jZS5FbnRpdHlNYW5hZ2VyOwppbXBv\ncnQgamF2YXgucGVyc2lzdGVuY2UuRmx1c2hNb2RlVHlwZTsKaW1wb3J0IGph\ndmF4LnBlcnNpc3RlbmNlLkxvY2tNb2RlVHlwZTsKaW1wb3J0IGphdmF4LnBl\ncnNpc3RlbmNlLlF1ZXJ5OwppbXBvcnQgamF2YXgucGVyc2lzdGVuY2UuVHlw\nZWRRdWVyeTsKaW1wb3J0IGphdmF4LnBlcnNpc3RlbmNlLmNyaXRlcmlhLkNy\naXRlcmlhUXVlcnk7CmltcG9ydCBqYXZheC5wZXJzaXN0ZW5jZS5jcml0ZXJp\nYS5QYXJhbWV0ZXJFeHByZXNzaW9uOwppbXBvcnQgamF2YXgucGVyc2lzdGVu\nY2UubWV0YW1vZGVsLk1ldGFtb2RlbDsKCmltcG9ydCBvcmcuYXBhY2hlLmNv\nbW1vbnMubGFuZy5TdHJpbmdVdGlsczsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5jb25mLkNvbXBhdGliaWxpdHk7CmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEuY29uZi5PcGVuSlBBQ29uZmlndXJhdGlvbjsKaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS5lZS5NYW5hZ2VkUnVudGltZTsKaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS5lbmhhbmNlLlBDRW5oYW5jZXI7CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEuZW5oYW5jZS5QQ1JlZ2lzdHJ5OwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLmVuaGFuY2UuUmVmbGVjdGlvbjsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuQWJzdHJhY3RCcm9rZXJGYWN0b3J5\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5Ccm9rZXI7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLkRhdGFDYWNoZVJldHJp\nZXZlTW9kZTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuRGF0\nYUNhY2hlU3RvcmVNb2RlOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmtl\ncm5lbC5EZWxlZ2F0aW5nQnJva2VyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLmtlcm5lbC5GZXRjaENvbmZpZ3VyYXRpb247CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEua2VybmVsLkZpbmRDYWxsYmFja3M7CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEua2VybmVsLk9wQ2FsbGJhY2tzOwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5PcGVuSlBBU3RhdGVNYW5hZ2VyOwpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5QcmVwYXJlZFF1ZXJ5\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5QcmVwYXJlZFF1\nZXJ5Q2FjaGU7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLlF1\nZXJ5Rmx1c2hNb2RlczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJu\nZWwuUXVlcnlMYW5ndWFnZXM7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\na2VybmVsLlNlcTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwu\nanBxbC5KUFFMUGFyc2VyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxp\nYi5sb2cuTG9nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51dGls\nLkNsb3NlYWJsZTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIudXRp\nbC5Mb2NhbGl6ZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YS5D\nbGFzc01ldGFEYXRhOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEu\nRmllbGRNZXRhRGF0YTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRh\nLlF1ZXJ5TWV0YURhdGE7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0\nYS5TZXF1ZW5jZU1ldGFEYXRhOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLnBlcnNpc3RlbmNlLmNyaXRlcmlhLkNyaXRlcmlhQnVpbGRlckltcGw7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuY3JpdGVyaWEu\nT3BlbkpQQUNyaXRlcmlhQnVpbGRlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5wZXJzaXN0ZW5jZS5jcml0ZXJpYS5PcGVuSlBBQ3JpdGVyaWFRdWVy\neTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS52YWxp\nZGF0aW9uLlZhbGlkYXRpb25VdGlsczsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS51dGlsLkV4Y2VwdGlvbnM7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEudXRpbC5JbXBsSGVscGVyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLnV0aWwuUnVudGltZUV4Y2VwdGlvblRyYW5zbGF0b3I7CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEudXRpbC5Vc2VyRXhjZXB0aW9uOwoKaW1wb3J0IHNl\ncnAudXRpbC5TdHJpbmdzOwoKLyoqCiAqIEltcGxlbWVudGF0aW9uIG9mIHtA\nbGluayBFbnRpdHlNYW5hZ2VyfSBpbnRlcmZhY2UuCiAqCiAqIEBhdXRob3Ig\nUGF0cmljayBMaW5za2V5CiAqIEBhdXRob3IgQWJlIFdoaXRlCiAqIEBub2ph\ndmFkb2MKICovCnB1YmxpYyBjbGFzcyBFbnRpdHlNYW5hZ2VySW1wbAogICAg\naW1wbGVtZW50cyBPcGVuSlBBRW50aXR5TWFuYWdlclNQSSwgRXh0ZXJuYWxp\nemFibGUsCiAgICBGaW5kQ2FsbGJhY2tzLCBPcENhbGxiYWNrcywgQ2xvc2Vh\nYmxlLCBPcGVuSlBBRW50aXR5VHJhbnNhY3Rpb24gewoKICAgIHByaXZhdGUg\nc3RhdGljIGZpbmFsIExvY2FsaXplciBfbG9jID0gTG9jYWxpemVyLmZvclBh\nY2thZ2UoRW50aXR5TWFuYWdlckltcGwuY2xhc3MpOwogICAgcHJpdmF0ZSBz\ndGF0aWMgZmluYWwgT2JqZWN0W10gRU1QVFlfT0JKRUNUUyA9IG5ldyBPYmpl\nY3RbMF07CgogICAgcHJpdmF0ZSBEZWxlZ2F0aW5nQnJva2VyIF9icm9rZXI7\nCiAgICBwcml2YXRlIEVudGl0eU1hbmFnZXJGYWN0b3J5SW1wbCBfZW1mOwog\nICAgcHJpdmF0ZSBNYXA8RmV0Y2hDb25maWd1cmF0aW9uLEZldGNoUGxhbj4g\nX3BsYW5zID0gbmV3IElkZW50aXR5SGFzaE1hcDxGZXRjaENvbmZpZ3VyYXRp\nb24sRmV0Y2hQbGFuPigxKTsKICAgIHByaXZhdGUgUnVudGltZUV4Y2VwdGlv\nblRyYW5zbGF0b3IgX3JldCA9IFBlcnNpc3RlbmNlRXhjZXB0aW9ucy5nZXRS\nb2xsYmFja1RyYW5zbGF0b3IodGhpcyk7CgogICAgcHVibGljIEVudGl0eU1h\nbmFnZXJJbXBsKCkgewogICAgICAgIC8vIGZvciBFeHRlcm5hbGl6YWJsZQog\nICAgfQoKICAgIC8qKgogICAgICogQ29uc3RydWN0b3I7IHN1cHBseSBmYWN0\nb3J5IGFuZCBkZWxlZ2F0ZS4KICAgICAqLwogICAgcHVibGljIEVudGl0eU1h\nbmFnZXJJbXBsKEVudGl0eU1hbmFnZXJGYWN0b3J5SW1wbCBmYWN0b3J5LCBC\ncm9rZXIgYnJva2VyKSB7CiAgICAgICAgaW5pdGlhbGl6ZShmYWN0b3J5LCBi\ncm9rZXIpOwogICAgfQoKICAgIHByaXZhdGUgdm9pZCBpbml0aWFsaXplKEVu\ndGl0eU1hbmFnZXJGYWN0b3J5SW1wbCBmYWN0b3J5LCBCcm9rZXIgYnJva2Vy\nKSB7CiAgICAgICAgX2VtZiA9IGZhY3Rvcnk7CiAgICAgICAgX2Jyb2tlciA9\nIG5ldyBEZWxlZ2F0aW5nQnJva2VyKGJyb2tlciwgX3JldCk7CiAgICAgICAg\nX2Jyb2tlci5zZXRJbXBsaWNpdEJlaGF2aW9yKHRoaXMsIF9yZXQpOwogICAg\nfQoKICAgIC8qKgogICAgICogQnJva2VyIGRlbGVnYXRlLgogICAgICovCiAg\nICBwdWJsaWMgQnJva2VyIGdldEJyb2tlcigpIHsKICAgICAgICByZXR1cm4g\nX2Jyb2tlci5nZXREZWxlZ2F0ZSgpOwogICAgfQoKICAgIHB1YmxpYyBPcGVu\nSlBBRW50aXR5TWFuYWdlckZhY3RvcnkgZ2V0RW50aXR5TWFuYWdlckZhY3Rv\ncnkoKSB7CiAgICAgICAgcmV0dXJuIF9lbWY7CiAgICB9CgogICAgcHVibGlj\nIE9wZW5KUEFDb25maWd1cmF0aW9uIGdldENvbmZpZ3VyYXRpb24oKSB7CiAg\nICAgICAgcmV0dXJuIF9icm9rZXIuZ2V0Q29uZmlndXJhdGlvbigpOwogICAg\nfQoKICAgIHB1YmxpYyBGZXRjaFBsYW4gZ2V0RmV0Y2hQbGFuKCkgewogICAg\nICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIF9icm9rZXIu\nbG9jaygpOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIEZldGNoQ29uZmln\ndXJhdGlvbiBmYyA9IF9icm9rZXIuZ2V0RmV0Y2hDb25maWd1cmF0aW9uKCk7\nCiAgICAgICAgICAgIEZldGNoUGxhbiBmcCA9IF9wbGFucy5nZXQoZmMpOwog\nICAgICAgICAgICBpZiAoZnAgPT0gbnVsbCkgewogICAgICAgICAgICAgICAg\nZnAgPSBfZW1mLnRvRmV0Y2hQbGFuKF9icm9rZXIsIGZjKTsKICAgICAgICAg\nICAgICAgIF9wbGFucy5wdXQoZmMsIGZwKTsKICAgICAgICAgICAgfQogICAg\nICAgICAgICByZXR1cm4gZnA7CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAg\nICAgICAgX2Jyb2tlci51bmxvY2soKTsKICAgICAgICB9CiAgICB9CgogICAg\ncHVibGljIEZldGNoUGxhbiBwdXNoRmV0Y2hQbGFuKCkgewogICAgICAgIGFz\nc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIF9icm9rZXIubG9jaygp\nOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIF9icm9rZXIucHVzaEZldGNo\nQ29uZmlndXJhdGlvbigpOwogICAgICAgICAgICByZXR1cm4gZ2V0RmV0Y2hQ\nbGFuKCk7CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgX2Jyb2tl\nci51bmxvY2soKTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGljIHZvaWQg\ncG9wRmV0Y2hQbGFuKCkgewogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tl\nZCgpOwogICAgICAgIF9icm9rZXIubG9jaygpOwogICAgICAgIHRyeSB7CiAg\nICAgICAgICAgIF9icm9rZXIucG9wRmV0Y2hDb25maWd1cmF0aW9uKCk7CiAg\nICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgX2Jyb2tlci51bmxvY2so\nKTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGljIENvbm5lY3Rpb25SZXRh\naW5Nb2RlIGdldENvbm5lY3Rpb25SZXRhaW5Nb2RlKCkgewogICAgICAgIHJl\ndHVybiBDb25uZWN0aW9uUmV0YWluTW9kZS5mcm9tS2VybmVsQ29uc3RhbnQo\nCiAgICAgICAgICAgIF9icm9rZXIuZ2V0Q29ubmVjdGlvblJldGFpbk1vZGUo\nKSk7CiAgICB9CgogICAgcHVibGljIGJvb2xlYW4gaXNUcmFuc2FjdGlvbk1h\nbmFnZWQoKSB7CiAgICAgICAgcmV0dXJuIF9icm9rZXIuaXNNYW5hZ2VkKCk7\nCiAgICB9CgogICAgcHVibGljIGJvb2xlYW4gaXNNYW5hZ2VkKCkgewogICAg\nICAgIHJldHVybiBfYnJva2VyLmlzTWFuYWdlZCgpOwogICAgfQoKICAgIHB1\nYmxpYyBNYW5hZ2VkUnVudGltZSBnZXRNYW5hZ2VkUnVudGltZSgpIHsKICAg\nICAgICByZXR1cm4gX2Jyb2tlci5nZXRNYW5hZ2VkUnVudGltZSgpOwogICAg\nfQoKICAgIHB1YmxpYyBib29sZWFuIGdldFN5bmNXaXRoTWFuYWdlZFRyYW5z\nYWN0aW9ucygpIHsKICAgICAgICByZXR1cm4gX2Jyb2tlci5nZXRTeW5jV2l0\naE1hbmFnZWRUcmFuc2FjdGlvbnMoKTsKICAgIH0KCiAgICBwdWJsaWMgdm9p\nZCBzZXRTeW5jV2l0aE1hbmFnZWRUcmFuc2FjdGlvbnMoYm9vbGVhbiBzeW5j\nKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAg\nX2Jyb2tlci5zZXRTeW5jV2l0aE1hbmFnZWRUcmFuc2FjdGlvbnMoc3luYyk7\nCiAgICB9CgogICAgcHVibGljIENsYXNzTG9hZGVyIGdldENsYXNzTG9hZGVy\nKCkgewogICAgICAgIHJldHVybiBfYnJva2VyLmdldENsYXNzTG9hZGVyKCk7\nCiAgICB9CgogICAgcHVibGljIFN0cmluZyBnZXRDb25uZWN0aW9uVXNlck5h\nbWUoKSB7CiAgICAgICAgcmV0dXJuIF9icm9rZXIuZ2V0Q29ubmVjdGlvblVz\nZXJOYW1lKCk7CiAgICB9CgogICAgcHVibGljIFN0cmluZyBnZXRDb25uZWN0\naW9uUGFzc3dvcmQoKSB7CiAgICAgICAgcmV0dXJuIF9icm9rZXIuZ2V0Q29u\nbmVjdGlvblBhc3N3b3JkKCk7CiAgICB9CgogICAgcHVibGljIGJvb2xlYW4g\nZ2V0TXVsdGl0aHJlYWRlZCgpIHsKICAgICAgICByZXR1cm4gX2Jyb2tlci5n\nZXRNdWx0aXRocmVhZGVkKCk7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0\nTXVsdGl0aHJlYWRlZChib29sZWFuIG11bHRpdGhyZWFkZWQpIHsKICAgICAg\nICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICBfYnJva2VyLnNl\ndE11bHRpdGhyZWFkZWQobXVsdGl0aHJlYWRlZCk7CiAgICB9CgogICAgcHVi\nbGljIGJvb2xlYW4gZ2V0SWdub3JlQ2hhbmdlcygpIHsKICAgICAgICByZXR1\ncm4gX2Jyb2tlci5nZXRJZ25vcmVDaGFuZ2VzKCk7CiAgICB9CgogICAgcHVi\nbGljIHZvaWQgc2V0SWdub3JlQ2hhbmdlcyhib29sZWFuIHZhbCkgewogICAg\nICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIF9icm9rZXIu\nc2V0SWdub3JlQ2hhbmdlcyh2YWwpOwogICAgfQoKICAgIHB1YmxpYyBib29s\nZWFuIGdldE5vbnRyYW5zYWN0aW9uYWxSZWFkKCkgewogICAgICAgIHJldHVy\nbiBfYnJva2VyLmdldE5vbnRyYW5zYWN0aW9uYWxSZWFkKCk7CiAgICB9Cgog\nICAgcHVibGljIHZvaWQgc2V0Tm9udHJhbnNhY3Rpb25hbFJlYWQoYm9vbGVh\nbiB2YWwpIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAg\nICAgICBfYnJva2VyLnNldE5vbnRyYW5zYWN0aW9uYWxSZWFkKHZhbCk7CiAg\nICB9CgogICAgcHVibGljIGJvb2xlYW4gZ2V0Tm9udHJhbnNhY3Rpb25hbFdy\naXRlKCkgewogICAgICAgIHJldHVybiBfYnJva2VyLmdldE5vbnRyYW5zYWN0\naW9uYWxXcml0ZSgpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldE5vbnRy\nYW5zYWN0aW9uYWxXcml0ZShib29sZWFuIHZhbCkgewogICAgICAgIGFzc2Vy\ndE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIF9icm9rZXIuc2V0Tm9udHJh\nbnNhY3Rpb25hbFdyaXRlKHZhbCk7CiAgICB9CgogICAgcHVibGljIGJvb2xl\nYW4gZ2V0T3B0aW1pc3RpYygpIHsKICAgICAgICByZXR1cm4gX2Jyb2tlci5n\nZXRPcHRpbWlzdGljKCk7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0T3B0\naW1pc3RpYyhib29sZWFuIHZhbCkgewogICAgICAgIGFzc2VydE5vdENsb3Nl\nSW52b2tlZCgpOwogICAgICAgIF9icm9rZXIuc2V0T3B0aW1pc3RpYyh2YWwp\nOwogICAgfQoKICAgIHB1YmxpYyBSZXN0b3JlU3RhdGVUeXBlIGdldFJlc3Rv\ncmVTdGF0ZSgpIHsKICAgICAgICByZXR1cm4gUmVzdG9yZVN0YXRlVHlwZS5m\ncm9tS2VybmVsQ29uc3RhbnQoX2Jyb2tlci5nZXRSZXN0b3JlU3RhdGUoKSk7\nCiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0UmVzdG9yZVN0YXRlKFJlc3Rv\ncmVTdGF0ZVR5cGUgdmFsKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZv\na2VkKCk7CiAgICAgICAgX2Jyb2tlci5zZXRSZXN0b3JlU3RhdGUodmFsLnRv\nS2VybmVsQ29uc3RhbnQoKSk7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0\nUmVzdG9yZVN0YXRlKGludCByZXN0b3JlKSB7CiAgICAgICAgYXNzZXJ0Tm90\nQ2xvc2VJbnZva2VkKCk7CiAgICAgICAgX2Jyb2tlci5zZXRSZXN0b3JlU3Rh\ndGUocmVzdG9yZSk7CiAgICB9CgogICAgcHVibGljIGJvb2xlYW4gZ2V0UmV0\nYWluU3RhdGUoKSB7CiAgICAgICAgcmV0dXJuIF9icm9rZXIuZ2V0UmV0YWlu\nU3RhdGUoKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRSZXRhaW5TdGF0\nZShib29sZWFuIHZhbCkgewogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tl\nZCgpOwogICAgICAgIF9icm9rZXIuc2V0UmV0YWluU3RhdGUodmFsKTsKICAg\nIH0KCiAgICBwdWJsaWMgQXV0b0NsZWFyVHlwZSBnZXRBdXRvQ2xlYXIoKSB7\nCiAgICAgICAgcmV0dXJuIEF1dG9DbGVhclR5cGUuZnJvbUtlcm5lbENvbnN0\nYW50KF9icm9rZXIuZ2V0QXV0b0NsZWFyKCkpOwogICAgfQoKICAgIHB1Ymxp\nYyB2b2lkIHNldEF1dG9DbGVhcihBdXRvQ2xlYXJUeXBlIHZhbCkgewogICAg\nICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIF9icm9rZXIu\nc2V0QXV0b0NsZWFyKHZhbC50b0tlcm5lbENvbnN0YW50KCkpOwogICAgfQoK\nICAgIHB1YmxpYyB2b2lkIHNldEF1dG9DbGVhcihpbnQgYXV0b0NsZWFyKSB7\nCiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAgX2Jy\nb2tlci5zZXRBdXRvQ2xlYXIoYXV0b0NsZWFyKTsKICAgIH0KCiAgICBwdWJs\naWMgRGV0YWNoU3RhdGVUeXBlIGdldERldGFjaFN0YXRlKCkgewogICAgICAg\nIHJldHVybiBEZXRhY2hTdGF0ZVR5cGUuZnJvbUtlcm5lbENvbnN0YW50KF9i\ncm9rZXIuZ2V0RGV0YWNoU3RhdGUoKSk7CiAgICB9CgogICAgcHVibGljIHZv\naWQgc2V0RGV0YWNoU3RhdGUoRGV0YWNoU3RhdGVUeXBlIHR5cGUpIHsKICAg\nICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICBfYnJva2Vy\nLnNldERldGFjaFN0YXRlKHR5cGUudG9LZXJuZWxDb25zdGFudCgpKTsKICAg\nIH0KCiAgICBwdWJsaWMgdm9pZCBzZXREZXRhY2hTdGF0ZShpbnQgZGV0YWNo\nKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAg\nX2Jyb2tlci5zZXREZXRhY2hTdGF0ZShkZXRhY2gpOwogICAgfQoKICAgIHB1\nYmxpYyBFbnVtU2V0PEF1dG9EZXRhY2hUeXBlPiBnZXRBdXRvRGV0YWNoKCkg\newogICAgICAgIHJldHVybiBBdXRvRGV0YWNoVHlwZS50b0VudW1TZXQoX2Jy\nb2tlci5nZXRBdXRvRGV0YWNoKCkpOwogICAgfQoKICAgIHB1YmxpYyB2b2lk\nIHNldEF1dG9EZXRhY2goQXV0b0RldGFjaFR5cGUgZmxhZykgewogICAgICAg\nIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIF9icm9rZXIuc2V0\nQXV0b0RldGFjaChBdXRvRGV0YWNoVHlwZS5mcm9tRW51bVNldChFbnVtU2V0\nLm9mKGZsYWcpKSk7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0QXV0b0Rl\ndGFjaChFbnVtU2V0PEF1dG9EZXRhY2hUeXBlPiBmbGFncykgewogICAgICAg\nIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIF9icm9rZXIuc2V0\nQXV0b0RldGFjaChBdXRvRGV0YWNoVHlwZS5mcm9tRW51bVNldChmbGFncykp\nOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldEF1dG9EZXRhY2goaW50IGF1\ndG9EZXRhY2hGbGFncykgewogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tl\nZCgpOwogICAgICAgIF9icm9rZXIuc2V0QXV0b0RldGFjaChhdXRvRGV0YWNo\nRmxhZ3MpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldEF1dG9EZXRhY2go\nQXV0b0RldGFjaFR5cGUgdmFsdWUsIGJvb2xlYW4gb24pIHsKICAgICAgICBh\nc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICBfYnJva2VyLnNldEF1\ndG9EZXRhY2goQXV0b0RldGFjaFR5cGUuZnJvbUVudW1TZXQoRW51bVNldC5v\nZih2YWx1ZSkpLG9uKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRBdXRv\nRGV0YWNoKGludCBmbGFnLCBib29sZWFuIG9uKSB7CiAgICAgICAgYXNzZXJ0\nTm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAgX2Jyb2tlci5zZXRBdXRvRGV0\nYWNoKGZsYWcsIG9uKTsKICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBnZXRF\ndmljdEZyb21TdG9yZUNhY2hlKCkgewogICAgICAgIHJldHVybiBfYnJva2Vy\nLmdldEV2aWN0RnJvbURhdGFDYWNoZSgpOwogICAgfQoKICAgIHB1YmxpYyB2\nb2lkIHNldEV2aWN0RnJvbVN0b3JlQ2FjaGUoYm9vbGVhbiBldmljdCkgewog\nICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIF9icm9r\nZXIuc2V0RXZpY3RGcm9tRGF0YUNhY2hlKGV2aWN0KTsKICAgIH0KCiAgICBw\ndWJsaWMgYm9vbGVhbiBnZXRQb3B1bGF0ZVN0b3JlQ2FjaGUoKSB7CiAgICAg\nICAgcmV0dXJuIF9icm9rZXIuZ2V0UG9wdWxhdGVEYXRhQ2FjaGUoKTsKICAg\nIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRQb3B1bGF0ZVN0b3JlQ2FjaGUoYm9v\nbGVhbiBjYWNoZSkgewogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgp\nOwogICAgICAgIF9icm9rZXIuc2V0UG9wdWxhdGVEYXRhQ2FjaGUoY2FjaGUp\nOwogICAgfQoKICAgIHB1YmxpYyBib29sZWFuIGlzVHJhY2tDaGFuZ2VzQnlU\neXBlKCkgewogICAgICAgIHJldHVybiBfYnJva2VyLmlzVHJhY2tDaGFuZ2Vz\nQnlUeXBlKCk7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0VHJhY2tDaGFu\nZ2VzQnlUeXBlKGJvb2xlYW4gdHJhY2tCeVR5cGUpIHsKICAgICAgICBhc3Nl\ncnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICBfYnJva2VyLnNldFRyYWNr\nQ2hhbmdlc0J5VHlwZSh0cmFja0J5VHlwZSk7CiAgICB9CgogICAgcHVibGlj\nIGJvb2xlYW4gaXNMYXJnZVRyYW5zYWN0aW9uKCkgewogICAgICAgIHJldHVy\nbiBpc1RyYWNrQ2hhbmdlc0J5VHlwZSgpOwogICAgfQoKICAgIHB1YmxpYyB2\nb2lkIHNldExhcmdlVHJhbnNhY3Rpb24oYm9vbGVhbiB2YWx1ZSkgewogICAg\nICAgIHNldFRyYWNrQ2hhbmdlc0J5VHlwZSh2YWx1ZSk7CiAgICB9CgogICAg\ncHVibGljIE9iamVjdCBnZXRVc2VyT2JqZWN0KE9iamVjdCBrZXkpIHsKICAg\nICAgICByZXR1cm4gX2Jyb2tlci5nZXRVc2VyT2JqZWN0KGtleSk7CiAgICB9\nCgogICAgcHVibGljIE9iamVjdCBwdXRVc2VyT2JqZWN0KE9iamVjdCBrZXks\nIE9iamVjdCB2YWwpIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQo\nKTsKICAgICAgICByZXR1cm4gX2Jyb2tlci5wdXRVc2VyT2JqZWN0KGtleSwg\ndmFsKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBhZGRUcmFuc2FjdGlvbkxp\nc3RlbmVyKE9iamVjdCBsaXN0ZW5lcikgewogICAgICAgIGFzc2VydE5vdENs\nb3NlSW52b2tlZCgpOwogICAgICAgIF9icm9rZXIuYWRkVHJhbnNhY3Rpb25M\naXN0ZW5lcihsaXN0ZW5lcik7CiAgICB9CgogICAgcHVibGljIHZvaWQgcmVt\nb3ZlVHJhbnNhY3Rpb25MaXN0ZW5lcihPYmplY3QgbGlzdGVuZXIpIHsKICAg\nICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICBfYnJva2Vy\nLnJlbW92ZVRyYW5zYWN0aW9uTGlzdGVuZXIobGlzdGVuZXIpOwogICAgfQoK\nICAgIHB1YmxpYyBFbnVtU2V0PENhbGxiYWNrTW9kZT4gZ2V0VHJhbnNhY3Rp\nb25MaXN0ZW5lckNhbGxiYWNrTW9kZXMoKSB7CiAgICAgICAgcmV0dXJuIENh\nbGxiYWNrTW9kZS50b0VudW1TZXQoCiAgICAgICAgICAgIF9icm9rZXIuZ2V0\nVHJhbnNhY3Rpb25MaXN0ZW5lckNhbGxiYWNrTW9kZSgpKTsKICAgIH0KCiAg\nICBwdWJsaWMgdm9pZCBzZXRUcmFuc2FjdGlvbkxpc3RlbmVyQ2FsbGJhY2tN\nb2RlKENhbGxiYWNrTW9kZSBtb2RlKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xv\nc2VJbnZva2VkKCk7CiAgICAgICAgX2Jyb2tlci5zZXRUcmFuc2FjdGlvbkxp\nc3RlbmVyQ2FsbGJhY2tNb2RlKAogICAgICAgICAgICBDYWxsYmFja01vZGUu\nZnJvbUVudW1TZXQoRW51bVNldC5vZihtb2RlKSkpOwogICAgfQoKICAgIHB1\nYmxpYyB2b2lkIHNldFRyYW5zYWN0aW9uTGlzdGVuZXJDYWxsYmFja01vZGUo\nRW51bVNldDxDYWxsYmFja01vZGU+IG1vZGVzKXsKICAgICAgICBhc3NlcnRO\nb3RDbG9zZUludm9rZWQoKTsKICAgICAgICBfYnJva2VyLnNldFRyYW5zYWN0\naW9uTGlzdGVuZXJDYWxsYmFja01vZGUoCiAgICAgICAgICAgIENhbGxiYWNr\nTW9kZS5mcm9tRW51bVNldChtb2RlcykpOwogICAgfQoKICAgIHB1YmxpYyBp\nbnQgZ2V0VHJhbnNhY3Rpb25MaXN0ZW5lckNhbGxiYWNrTW9kZSgpIHsKICAg\nICAgICByZXR1cm4gX2Jyb2tlci5nZXRUcmFuc2FjdGlvbkxpc3RlbmVyQ2Fs\nbGJhY2tNb2RlKCk7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0VHJhbnNh\nY3Rpb25MaXN0ZW5lckNhbGxiYWNrTW9kZShpbnQgY2FsbGJhY2tNb2RlKSB7\nCiAgICAgICAgdGhyb3cgbmV3IFVuc3VwcG9ydGVkT3BlcmF0aW9uRXhjZXB0\naW9uKCk7CiAgICB9CgogICAgcHVibGljIHZvaWQgYWRkTGlmZWN5Y2xlTGlz\ndGVuZXIoT2JqZWN0IGxpc3RlbmVyLCBDbGFzcy4uLiBjbGFzc2VzKSB7CiAg\nICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAgX2Jyb2tl\nci5hZGRMaWZlY3ljbGVMaXN0ZW5lcihsaXN0ZW5lciwgY2xhc3Nlcyk7CiAg\nICB9CgogICAgcHVibGljIHZvaWQgcmVtb3ZlTGlmZWN5Y2xlTGlzdGVuZXIo\nT2JqZWN0IGxpc3RlbmVyKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZv\na2VkKCk7CiAgICAgICAgX2Jyb2tlci5yZW1vdmVMaWZlY3ljbGVMaXN0ZW5l\ncihsaXN0ZW5lcik7CiAgICB9CgogICAgcHVibGljIEVudW1TZXQ8Q2FsbGJh\nY2tNb2RlPiBnZXRMaWZlY3ljbGVMaXN0ZW5lckNhbGxiYWNrTW9kZXMoKSB7\nCiAgICAgICAgcmV0dXJuIENhbGxiYWNrTW9kZS50b0VudW1TZXQoCiAgICAg\nICAgICAgIF9icm9rZXIuZ2V0TGlmZWN5Y2xlTGlzdGVuZXJDYWxsYmFja01v\nZGUoKSk7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0TGlmZWN5Y2xlTGlz\ndGVuZXJDYWxsYmFja01vZGUoQ2FsbGJhY2tNb2RlIG1vZGUpIHsKICAgICAg\nICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICBfYnJva2VyLnNl\ndExpZmVjeWNsZUxpc3RlbmVyQ2FsbGJhY2tNb2RlKAogICAgICAgICAgICBD\nYWxsYmFja01vZGUuZnJvbUVudW1TZXQoRW51bVNldC5vZihtb2RlKSkpOwog\nICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldExpZmVjeWNsZUxpc3RlbmVyQ2Fs\nbGJhY2tNb2RlKEVudW1TZXQ8Q2FsbGJhY2tNb2RlPiBtb2RlcykgewogICAg\nICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIF9icm9rZXIu\nc2V0TGlmZWN5Y2xlTGlzdGVuZXJDYWxsYmFja01vZGUoCiAgICAgICAgICAg\nIENhbGxiYWNrTW9kZS5mcm9tRW51bVNldChtb2RlcykpOwogICAgfQoKICAg\nIHB1YmxpYyBpbnQgZ2V0TGlmZWN5Y2xlTGlzdGVuZXJDYWxsYmFja01vZGUo\nKSB7CiAgICAgICAgcmV0dXJuIF9icm9rZXIuZ2V0TGlmZWN5Y2xlTGlzdGVu\nZXJDYWxsYmFja01vZGUoKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRM\naWZlY3ljbGVMaXN0ZW5lckNhbGxiYWNrTW9kZShpbnQgY2FsbGJhY2tNb2Rl\nKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAg\nX2Jyb2tlci5zZXRMaWZlY3ljbGVMaXN0ZW5lckNhbGxiYWNrTW9kZShjYWxs\nYmFja01vZGUpOwogICAgfQoKICAgIEBTdXBwcmVzc1dhcm5pbmdzKCJ1bmNo\nZWNrZWQiKQogICAgcHVibGljIDxUPiBUIGdldFJlZmVyZW5jZShDbGFzczxU\nPiBjbHMsIE9iamVjdCBvaWQpIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUlu\ndm9rZWQoKTsKICAgICAgICBvaWQgPSBfYnJva2VyLm5ld09iamVjdElkKGNs\ncywgb2lkKTsKICAgICAgICByZXR1cm4gKFQpIF9icm9rZXIuZmluZChvaWQs\nIGZhbHNlLCB0aGlzKTsKICAgIH0KCiAgICBAU3VwcHJlc3NXYXJuaW5ncygi\ndW5jaGVja2VkIikKICAgIHB1YmxpYyA8VD4gVCBmaW5kKENsYXNzPFQ+IGNs\ncywgT2JqZWN0IG9pZCkgewogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tl\nZCgpOwogICAgICAgIGlmIChvaWQgPT0gbnVsbCkKICAgICAgICAJcmV0dXJu\nIG51bGw7CiAgICAgICAgb2lkID0gX2Jyb2tlci5uZXdPYmplY3RJZChjbHMs\nIG9pZCk7CiAgICAgICAgcmV0dXJuIChUKSBfYnJva2VyLmZpbmQob2lkLCB0\ncnVlLCB0aGlzKTsKICAgIH0KCiAgICBwdWJsaWMgPFQ+IFQgZmluZChDbGFz\nczxUPiBjbHMsIE9iamVjdCBvaWQsIExvY2tNb2RlVHlwZSBtb2RlKSB7CiAg\nICAgICAgcmV0dXJuIGZpbmQoY2xzLCBvaWQsIG1vZGUsIG51bGwpOwogICAg\nfQoKICAgIHB1YmxpYyA8VD4gVCBmaW5kKENsYXNzPFQ+IGNscywgT2JqZWN0\nIG9pZCwgCiAgICAgICAgTWFwPFN0cmluZywgT2JqZWN0PiBwcm9wZXJ0aWVz\nKXsKICAgICAgICByZXR1cm4gZmluZChjbHMsIG9pZCwgbnVsbCwgcHJvcGVy\ndGllcyk7CiAgICB9CgogICAgQFN1cHByZXNzV2FybmluZ3MoInVuY2hlY2tl\nZCIpCiAgICBwdWJsaWMgPFQ+IFQgZmluZChDbGFzczxUPiBjbHMsIE9iamVj\ndCBvaWQsIExvY2tNb2RlVHlwZSBtb2RlLCBNYXA8U3RyaW5nLCBPYmplY3Q+\nIHByb3BlcnRpZXMpIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQo\nKTsKICAgICAgICBjb25maWd1cmVDdXJyZW50RmV0Y2hQbGFuKHB1c2hGZXRj\naFBsYW4oKSwgcHJvcGVydGllcywgbW9kZSwgdHJ1ZSk7CiAgICAgICAgdHJ5\nIHsKICAgICAgICAgICAgb2lkID0gX2Jyb2tlci5uZXdPYmplY3RJZChjbHMs\nIG9pZCk7CiAgICAgICAgICAgIHJldHVybiAoVCkgX2Jyb2tlci5maW5kKG9p\nZCwgdHJ1ZSwgdGhpcyk7CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAg\nICAgcG9wRmV0Y2hQbGFuKCk7CiAgICAgICAgfQogICAgfQoKICAgIEBTdXBw\ncmVzc1dhcm5pbmdzKCJ1bmNoZWNrZWQiKQogICAgcHVibGljIDxUPiBUW10g\nZmluZEFsbChDbGFzczxUPiBjbHMsIE9iamVjdC4uLiBvaWRzKSB7CiAgICAg\nICAgaWYgKG9pZHMubGVuZ3RoID09IDApCiAgICAgICAgICAgIHJldHVybiAo\nVFtdKSBBcnJheS5uZXdJbnN0YW5jZShjbHMsIDApOwogICAgICAgIENvbGxl\nY3Rpb248VD4gcmV0ID0gZmluZEFsbChjbHMsIEFycmF5cy5hc0xpc3Qob2lk\ncykpOwogICAgICAgIHJldHVybiByZXQudG9BcnJheSgoVFtdKSBBcnJheS5u\nZXdJbnN0YW5jZShjbHMsIHJldC5zaXplKCkpKTsKICAgIH0KCiAgICBAU3Vw\ncHJlc3NXYXJuaW5ncygidW5jaGVja2VkIikKICAgIHB1YmxpYyA8VD4gQ29s\nbGVjdGlvbjxUPiBmaW5kQWxsKGZpbmFsIENsYXNzPFQ+IGNscywgQ29sbGVj\ndGlvbiBvaWRzKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7\nCiAgICAgICAgT2JqZWN0W10gb2JqcyA9IF9icm9rZXIuZmluZEFsbChvaWRz\nLCB0cnVlLCBuZXcgRmluZENhbGxiYWNrcygpIHsKICAgICAgICAgICAgcHVi\nbGljIE9iamVjdCBwcm9jZXNzQXJndW1lbnQoT2JqZWN0IG9pZCkgewogICAg\nICAgICAgICAgICAgcmV0dXJuIF9icm9rZXIubmV3T2JqZWN0SWQoY2xzLCBv\naWQpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBwdWJsaWMgT2JqZWN0\nIHByb2Nlc3NSZXR1cm4oT2JqZWN0IG9pZCwgT3BlbkpQQVN0YXRlTWFuYWdl\nciBzbSkgewogICAgICAgICAgICAgICAgcmV0dXJuIEVudGl0eU1hbmFnZXJJ\nbXBsLnRoaXMucHJvY2Vzc1JldHVybihvaWQsIHNtKTsKICAgICAgICAgICAg\nfQogICAgICAgIH0pOwogICAgICAgIHJldHVybiAoQ29sbGVjdGlvbjxUPikg\nQXJyYXlzLmFzTGlzdChvYmpzKTsKICAgIH0KCiAgICBAU3VwcHJlc3NXYXJu\naW5ncygidW5jaGVja2VkIikKICAgIHB1YmxpYyA8VD4gVCBmaW5kQ2FjaGVk\nKENsYXNzPFQ+IGNscywgT2JqZWN0IG9pZCkgewogICAgICAgIGFzc2VydE5v\ndENsb3NlSW52b2tlZCgpOwogICAgICAgIHJldHVybiAoVCkgX2Jyb2tlci5m\naW5kQ2FjaGVkKF9icm9rZXIubmV3T2JqZWN0SWQoY2xzLCBvaWQpLCB0aGlz\nKTsKICAgIH0KCiAgICBwdWJsaWMgQ2xhc3MgZ2V0T2JqZWN0SWRDbGFzcyhD\nbGFzcyBjbHMpIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsK\nICAgICAgICBpZiAoY2xzID09IG51bGwpCiAgICAgICAgICAgIHJldHVybiBu\ndWxsOwogICAgICAgIHJldHVybiBKUEFGYWNhZGVIZWxwZXIuZnJvbU9wZW5K\nUEFPYmplY3RJZENsYXNzCiAgICAgICAgICAgICAgICAoX2Jyb2tlci5nZXRP\nYmplY3RJZFR5cGUoY2xzKSk7CiAgICB9CgogICAgcHVibGljIE9wZW5KUEFF\nbnRpdHlUcmFuc2FjdGlvbiBnZXRUcmFuc2FjdGlvbigpIHsKICAgICAgICBp\nZiAoX2Jyb2tlci5pc01hbmFnZWQoKSkKICAgICAgICAgICAgdGhyb3cgbmV3\nIEludmFsaWRTdGF0ZUV4Y2VwdGlvbihfbG9jLmdldCgiZ2V0LW1hbmFnZWQt\ndHJhbnMiKSwKICAgICAgICAgICAgICAgIG51bGwsIG51bGwsIGZhbHNlKTsK\nICAgICAgICByZXR1cm4gdGhpczsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBq\nb2luVHJhbnNhY3Rpb24oKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZv\na2VkKCk7CiAgICAgICAgaWYgKCFfYnJva2VyLnN5bmNXaXRoTWFuYWdlZFRy\nYW5zYWN0aW9uKCkpCiAgICAgICAgICAgIHRocm93IG5ldyBUcmFuc2FjdGlv\nblJlcXVpcmVkRXhjZXB0aW9uKF9sb2MuZ2V0CiAgICAgICAgICAgICAgICAo\nIm5vLW1hbmFnZWQtdHJhbnMiKSwgbnVsbCwgbnVsbCwgZmFsc2UpOwogICAg\nfQoKICAgIHB1YmxpYyB2b2lkIGJlZ2luKCkgewogICAgICAgIF9icm9rZXIu\nYmVnaW4oKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBjb21taXQoKSB7CiAg\nICAgICAgdHJ5IHsKICAgICAgICAgICAgX2Jyb2tlci5jb21taXQoKTsKICAg\nICAgICB9IGNhdGNoIChSb2xsYmFja0V4Y2VwdGlvbiBlKSB7CiAgICAgICAg\nICAgIHRocm93IGU7CiAgICAgICAgfSBjYXRjaCAoSWxsZWdhbFN0YXRlRXhj\nZXB0aW9uIGUpIHsKICAgICAgICAgICAgdGhyb3cgZTsKICAgICAgICB9IGNh\ndGNoIChFeGNlcHRpb24gZSkgewogICAgICAgIAkvLyBQZXIgSlBBIDIuMCBz\ncGVjLCBpZiB0aGUgZXhjZXB0aW9uIHdhcyBkdWUgdG8gYSBKU1ItMzAzIAog\nICAgICAgICAgICAvLyBjb25zdHJhaW50IHZpb2xhdGlvbiwgdGhlIENvbnN0\ncmFpbnRWaW9sYXRpb25FeGNlcHRpb24gc2hvdWxkIGJlIAogICAgICAgICAg\nICAvLyB0aHJvd24uICBTaW5jZSBKU1ItMzAzIGlzIG9wdGlvbmFsLCB0aGUg\nY2FzdCB0byBSdW50aW1lRXhjZXB0aW9uIAogICAgICAgICAgICAvLyBwcmV2\nZW50cyB0aGUgaW50cm9kdWN0aW9uIG9mIGEgcnVudGltZSBkZXBlbmRlbmN5\nIG9uIHRoZSBCViBBUEkuCiAgICAgICAgICAgIGlmIChWYWxpZGF0aW9uVXRp\nbHMuaXNDb25zdHJhaW50VmlvbGF0aW9uRXhjZXB0aW9uKGUpKQogICAgICAg\nICAgICAgICAgdGhyb3cgKFJ1bnRpbWVFeGNlcHRpb24pZTsKICAgICAgICAg\nICAgLy8gUm9sbGJhY2tFeGNlcHRpb25zIGFyZSBzcGVjaWFsIGFuZCBhcmVu\nJ3QgaGFuZGxlZCBieSB0aGUKICAgICAgICAgICAgLy8gbm9ybWFsIGV4Y2Vw\ndGlvbiB0cmFuc2xhdG9yLCBzaW5jZSB0aGUgc3BlYyBzYXlzIHRoZXkKICAg\nICAgICAgICAgLy8gc2hvdWxkIGJlIHRocm93biB3aGVuZXZlciB0aGUgY29t\nbWl0IGZhaWxzIGZvciBhbnkgcmVhc29uIGF0CiAgICAgICAgICAgIC8vIGFs\nbCwgd2hlcmFzIHRoZSBleGNlcHRpb24gdHJhbnNsYXRvciBoYW5kbGVzIGV4\nY2VwdGlvbnMgdGhhdAogICAgICAgICAgICAvLyBhcmUgY2F1c2VkIGZvciBz\ncGVjaWZpYyByZWFzb25zCiAgICAgICAgICAgIHRocm93IG5ldyBSb2xsYmFj\na0V4Y2VwdGlvbihlKTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGljIHZv\naWQgcm9sbGJhY2soKSB7CiAgICAgICAgX2Jyb2tlci5yb2xsYmFjaygpOwog\nICAgfQoKICAgIHB1YmxpYyB2b2lkIGNvbW1pdEFuZFJlc3VtZSgpIHsKICAg\nICAgICBfYnJva2VyLmNvbW1pdEFuZFJlc3VtZSgpOwogICAgfQoKICAgIHB1\nYmxpYyB2b2lkIHJvbGxiYWNrQW5kUmVzdW1lKCkgewogICAgICAgIF9icm9r\nZXIucm9sbGJhY2tBbmRSZXN1bWUoKTsKICAgIH0KCiAgICBwdWJsaWMgVGhy\nb3dhYmxlIGdldFJvbGxiYWNrQ2F1c2UoKSB7CiAgICAgICAgaWYgKCFpc0Fj\ndGl2ZSgpKQogICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbFN0YXRlRXhj\nZXB0aW9uKF9sb2MuZ2V0KCJuby10cmFuc2FjdGlvbiIpCiAgICAgICAgICAg\nICAgICAuZ2V0TWVzc2FnZSgpKTsKCiAgICAgICAgcmV0dXJuIF9icm9rZXIu\nZ2V0Um9sbGJhY2tDYXVzZSgpOwogICAgfQoKICAgIHB1YmxpYyBib29sZWFu\nIGdldFJvbGxiYWNrT25seSgpIHsKICAgICAgICBpZiAoIWlzQWN0aXZlKCkp\nCiAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsU3RhdGVFeGNlcHRpb24o\nX2xvYy5nZXQoIm5vLXRyYW5zYWN0aW9uIikKICAgICAgICAgICAgICAgIC5n\nZXRNZXNzYWdlKCkpOwoKICAgICAgICByZXR1cm4gX2Jyb2tlci5nZXRSb2xs\nYmFja09ubHkoKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRSb2xsYmFj\na09ubHkoKSB7CiAgICAgICAgX2Jyb2tlci5zZXRSb2xsYmFja09ubHkoKTsK\nICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRSb2xsYmFja09ubHkoVGhyb3dh\nYmxlIGNhdXNlKSB7CiAgICAgICAgX2Jyb2tlci5zZXRSb2xsYmFja09ubHko\nY2F1c2UpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldFNhdmVwb2ludChT\ndHJpbmcgbmFtZSkgewogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgp\nOwogICAgICAgIF9icm9rZXIuc2V0U2F2ZXBvaW50KG5hbWUpOwogICAgfQoK\nICAgIHB1YmxpYyB2b2lkIHJvbGxiYWNrVG9TYXZlcG9pbnQoKSB7CiAgICAg\nICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAgX2Jyb2tlci5y\nb2xsYmFja1RvU2F2ZXBvaW50KCk7CiAgICB9CgogICAgcHVibGljIHZvaWQg\ncm9sbGJhY2tUb1NhdmVwb2ludChTdHJpbmcgbmFtZSkgewogICAgICAgIGFz\nc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIF9icm9rZXIucm9sbGJh\nY2tUb1NhdmVwb2ludChuYW1lKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBy\nZWxlYXNlU2F2ZXBvaW50KCkgewogICAgICAgIGFzc2VydE5vdENsb3NlSW52\nb2tlZCgpOwogICAgICAgIF9icm9rZXIucmVsZWFzZVNhdmVwb2ludCgpOwog\nICAgfQoKICAgIHB1YmxpYyB2b2lkIHJlbGVhc2VTYXZlcG9pbnQoU3RyaW5n\nIG5hbWUpIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAg\nICAgICBfYnJva2VyLnJlbGVhc2VTYXZlcG9pbnQobmFtZSk7CiAgICB9Cgog\nICAgcHVibGljIHZvaWQgZmx1c2goKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xv\nc2VJbnZva2VkKCk7CiAgICAgICAgX2Jyb2tlci5hc3NlcnRPcGVuKCk7CiAg\nICAgICAgX2Jyb2tlci5hc3NlcnRBY3RpdmVUcmFuc2FjdGlvbigpOwogICAg\nICAgIF9icm9rZXIuZmx1c2goKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBw\ncmVGbHVzaCgpIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsK\nICAgICAgICBfYnJva2VyLnByZUZsdXNoKCk7CiAgICB9CgogICAgcHVibGlj\nIHZvaWQgdmFsaWRhdGVDaGFuZ2VzKCkgewogICAgICAgIGFzc2VydE5vdENs\nb3NlSW52b2tlZCgpOwogICAgICAgIF9icm9rZXIudmFsaWRhdGVDaGFuZ2Vz\nKCk7CiAgICB9CgogICAgcHVibGljIGJvb2xlYW4gaXNBY3RpdmUoKSB7CiAg\nICAgICAgcmV0dXJuIGlzT3BlbigpICYmIF9icm9rZXIuaXNBY3RpdmUoKTsK\nICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBpc1N0b3JlQWN0aXZlKCkgewog\nICAgICAgIHJldHVybiBfYnJva2VyLmlzU3RvcmVBY3RpdmUoKTsKICAgIH0K\nCiAgICBwdWJsaWMgdm9pZCBiZWdpblN0b3JlKCkgewogICAgICAgIF9icm9r\nZXIuYmVnaW5TdG9yZSgpOwogICAgfQoKICAgIHB1YmxpYyBib29sZWFuIGNv\nbnRhaW5zKE9iamVjdCBlbnRpdHkpIHsKICAgICAgICBhc3NlcnROb3RDbG9z\nZUludm9rZWQoKTsKICAgICAgICBpZiAoZW50aXR5ID09IG51bGwpCiAgICAg\nICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICBPcGVuSlBBU3RhdGVNYW5h\nZ2VyIHNtID0gX2Jyb2tlci5nZXRTdGF0ZU1hbmFnZXIoZW50aXR5KTsKICAg\nICAgICBpZiAoc20gPT0gbnVsbAogICAgICAgICAgICAmJiAhSW1wbEhlbHBl\nci5pc01hbmFnZWRUeXBlKGdldENvbmZpZ3VyYXRpb24oKSwgZW50aXR5Lmdl\ndENsYXNzKCkpKQogICAgICAgICAgICB0aHJvdyBuZXcgQXJndW1lbnRFeGNl\ncHRpb24oX2xvYy5nZXQoIm5vdC1lbnRpdHkiLAogICAgICAgICAgICAgICAg\nZW50aXR5LmdldENsYXNzKCkpLCBudWxsLCBudWxsLCB0cnVlKTsKICAgICAg\nICByZXR1cm4gc20gIT0gbnVsbCAmJiAhc20uaXNEZWxldGVkKCk7CiAgICB9\nCgogICAgcHVibGljIGJvb2xlYW4gY29udGFpbnNBbGwoT2JqZWN0Li4uIGVu\ndGl0aWVzKSB7CiAgICAgICAgZm9yIChPYmplY3QgZW50aXR5IDogZW50aXRp\nZXMpCiAgICAgICAgICAgIGlmICghY29udGFpbnMoZW50aXR5KSkKICAgICAg\nICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICByZXR1cm4gdHJ1ZTsK\nICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBjb250YWluc0FsbChDb2xsZWN0\naW9uIGVudGl0aWVzKSB7CiAgICAgICAgZm9yIChPYmplY3QgZW50aXR5IDog\nZW50aXRpZXMpCiAgICAgICAgICAgIGlmICghY29udGFpbnMoZW50aXR5KSkK\nICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICByZXR1cm4g\ndHJ1ZTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBwZXJzaXN0KE9iamVjdCBl\nbnRpdHkpIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAg\nICAgICBfYnJva2VyLnBlcnNpc3QoZW50aXR5LCB0aGlzKTsKICAgIH0KCiAg\nICBwdWJsaWMgdm9pZCBwZXJzaXN0QWxsKE9iamVjdC4uLiBlbnRpdGllcykg\newogICAgICAgIHBlcnNpc3RBbGwoQXJyYXlzLmFzTGlzdChlbnRpdGllcykp\nOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHBlcnNpc3RBbGwoQ29sbGVjdGlv\nbiBlbnRpdGllcykgewogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgp\nOwogICAgICAgIF9icm9rZXIucGVyc2lzdEFsbChlbnRpdGllcywgdGhpcyk7\nCiAgICB9CgogICAgcHVibGljIHZvaWQgcmVtb3ZlKE9iamVjdCBlbnRpdHkp\nIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICBf\nYnJva2VyLmRlbGV0ZShlbnRpdHksIHRoaXMpOwogICAgfQoKICAgIHB1Ymxp\nYyB2b2lkIHJlbW92ZUFsbChPYmplY3QuLi4gZW50aXRpZXMpIHsKICAgICAg\nICByZW1vdmVBbGwoQXJyYXlzLmFzTGlzdChlbnRpdGllcykpOwogICAgfQoK\nICAgIHB1YmxpYyB2b2lkIHJlbW92ZUFsbChDb2xsZWN0aW9uIGVudGl0aWVz\nKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAg\nX2Jyb2tlci5kZWxldGVBbGwoZW50aXRpZXMsIHRoaXMpOwogICAgfQoKICAg\nIHB1YmxpYyB2b2lkIHJlbGVhc2UoT2JqZWN0IGVudGl0eSkgewogICAgICAg\nIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIF9icm9rZXIucmVs\nZWFzZShlbnRpdHksIHRoaXMpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHJl\nbGVhc2VBbGwoQ29sbGVjdGlvbiBlbnRpdGllcykgewogICAgICAgIGFzc2Vy\ndE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIF9icm9rZXIucmVsZWFzZUFs\nbChlbnRpdGllcywgdGhpcyk7CiAgICB9CgogICAgcHVibGljIHZvaWQgcmVs\nZWFzZUFsbChPYmplY3QuLi4gZW50aXRpZXMpIHsKICAgICAgICByZWxlYXNl\nQWxsKEFycmF5cy5hc0xpc3QoZW50aXRpZXMpKTsKICAgIH0KCiAgICBwdWJs\naWMgdm9pZCByZWZyZXNoKE9iamVjdCBlbnRpdHkpIHsKICAgICAgICByZWZy\nZXNoKGVudGl0eSwgbnVsbCwgbnVsbCk7CiAgICB9CgogICAgcHVibGljIHZv\naWQgcmVmcmVzaChPYmplY3QgZW50aXR5LCBMb2NrTW9kZVR5cGUgbW9kZSkg\newogICAgICAgIHJlZnJlc2goZW50aXR5LCBtb2RlLCBudWxsKTsKICAgIH0K\nCiAgICBwdWJsaWMgdm9pZCByZWZyZXNoKE9iamVjdCBlbnRpdHksIE1hcDxT\ndHJpbmcsIE9iamVjdD4gcHJvcGVydGllcykgewogICAgICAgIHJlZnJlc2go\nZW50aXR5LCBudWxsLCBwcm9wZXJ0aWVzKTsKICAgIH0KCiAgICBwdWJsaWMg\ndm9pZCByZWZyZXNoKE9iamVjdCBlbnRpdHksIExvY2tNb2RlVHlwZSBtb2Rl\nLCBNYXA8U3RyaW5nLCBPYmplY3Q+IHByb3BlcnRpZXMpIHsKICAgICAgICBh\nc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICBhc3NlcnRWYWxpZEF0\ndGNoZWRFbnRpdHkoInJlZnJlc2giLCBlbnRpdHkpOwoKICAgICAgICBfYnJv\na2VyLmFzc2VydFdyaXRlT3BlcmF0aW9uKCk7CiAgICAgICAgY29uZmlndXJl\nQ3VycmVudEZldGNoUGxhbihwdXNoRmV0Y2hQbGFuKCksIHByb3BlcnRpZXMs\nIG1vZGUsIHRydWUpOwogICAgICAgIERhdGFDYWNoZVJldHJpZXZlTW9kZSBy\nbW9kZSA9IGdldEZldGNoUGxhbigpLmdldENhY2hlUmV0cmlldmVNb2RlKCk7\nCiAgICAgICAgaWYgKERhdGFDYWNoZVJldHJpZXZlTW9kZS5VU0UuZXF1YWxz\nKHJtb2RlKSB8fCBybW9kZSA9PSBudWxsKSB7CiAgICAgICAgICAgIGdldEZl\ndGNoUGxhbigpLnNldENhY2hlUmV0cmlldmVNb2RlKERhdGFDYWNoZVJldHJp\nZXZlTW9kZS5CWVBBU1MpOwogICAgICAgICAgICBpZiAocm1vZGUgIT0gbnVs\nbCkgewogICAgICAgICAgICAgICAgTG9nIGxvZyA9IF9icm9rZXIuZ2V0Q29u\nZmlndXJhdGlvbigpLmdldENvbmZpZ3VyYXRpb25Mb2coKTsKICAgICAgICAg\nICAgICAgIGxvZy53YXJuKF9sb2MuZ2V0KCJjYWNoZS1yZXRyaWV2ZS1vdmVy\ncmlkZSIsIEV4Y2VwdGlvbnMudG9TdHJpbmcoZW50aXR5KSkpOwogICAgICAg\nICAgICB9CiAgICAgICAgICAgICAgICAKICAgICAgICB9CiAgICAgICAgdHJ5\nIHsKICAgICAgICAgICAgX2Jyb2tlci5yZWZyZXNoKGVudGl0eSwgdGhpcyk7\nCiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgcG9wRmV0Y2hQbGFu\nKCk7CiAgICAgICAgfQogICAgfQoKICAgIHB1YmxpYyB2b2lkIHJlZnJlc2hB\nbGwoKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAg\nICAgX2Jyb2tlci5hc3NlcnRXcml0ZU9wZXJhdGlvbigpOwogICAgICAgIF9i\ncm9rZXIucmVmcmVzaEFsbChfYnJva2VyLmdldFRyYW5zYWN0aW9uYWxPYmpl\nY3RzKCksIHRoaXMpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHJlZnJlc2hB\nbGwoQ29sbGVjdGlvbiBlbnRpdGllcykgewogICAgICAgIGFzc2VydE5vdENs\nb3NlSW52b2tlZCgpOwogICAgICAgIF9icm9rZXIuYXNzZXJ0V3JpdGVPcGVy\nYXRpb24oKTsKICAgICAgICBfYnJva2VyLnJlZnJlc2hBbGwoZW50aXRpZXMs\nIHRoaXMpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHJlZnJlc2hBbGwoT2Jq\nZWN0Li4uIGVudGl0aWVzKSB7CiAgICAgICAgcmVmcmVzaEFsbChBcnJheXMu\nYXNMaXN0KGVudGl0aWVzKSk7CiAgICB9CgogICAgcHVibGljIHZvaWQgcmV0\ncmlldmUoT2JqZWN0IGVudGl0eSkgewogICAgICAgIGFzc2VydE5vdENsb3Nl\nSW52b2tlZCgpOwogICAgICAgIF9icm9rZXIucmV0cmlldmUoZW50aXR5LCB0\ncnVlLCB0aGlzKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCByZXRyaWV2ZUFs\nbChDb2xsZWN0aW9uIGVudGl0aWVzKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xv\nc2VJbnZva2VkKCk7CiAgICAgICAgX2Jyb2tlci5yZXRyaWV2ZUFsbChlbnRp\ndGllcywgdHJ1ZSwgdGhpcyk7CiAgICB9CgogICAgcHVibGljIHZvaWQgcmV0\ncmlldmVBbGwoT2JqZWN0Li4uIGVudGl0aWVzKSB7CiAgICAgICAgcmV0cmll\ndmVBbGwoQXJyYXlzLmFzTGlzdChlbnRpdGllcykpOwogICAgfQoKICAgIHB1\nYmxpYyB2b2lkIGV2aWN0KE9iamVjdCBlbnRpdHkpIHsKICAgICAgICBhc3Nl\ncnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICBfYnJva2VyLmV2aWN0KGVu\ndGl0eSwgdGhpcyk7CiAgICB9CgogICAgcHVibGljIHZvaWQgZXZpY3RBbGwo\nQ29sbGVjdGlvbiBlbnRpdGllcykgewogICAgICAgIGFzc2VydE5vdENsb3Nl\nSW52b2tlZCgpOwogICAgICAgIF9icm9rZXIuZXZpY3RBbGwoZW50aXRpZXMs\nIHRoaXMpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIGV2aWN0QWxsKE9iamVj\ndC4uLiBlbnRpdGllcykgewogICAgICAgIGV2aWN0QWxsKEFycmF5cy5hc0xp\nc3QoZW50aXRpZXMpKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBldmljdEFs\nbCgpIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAgICAg\nICBfYnJva2VyLmV2aWN0QWxsKHRoaXMpOwogICAgfQoKICAgIHB1YmxpYyB2\nb2lkIGV2aWN0QWxsKENsYXNzIGNscykgewogICAgICAgIGFzc2VydE5vdENs\nb3NlSW52b2tlZCgpOwogICAgICAgIF9icm9rZXIuZXZpY3RBbGwoX2Jyb2tl\nci5uZXdFeHRlbnQoY2xzLCB0cnVlKSwgdGhpcyk7CiAgICB9CgogICAgcHVi\nbGljIHZvaWQgZXZpY3RBbGwoRXh0ZW50IGV4dGVudCkgewogICAgICAgIGFz\nc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIF9icm9rZXIuZXZpY3RB\nbGwoKChFeHRlbnRJbXBsKSBleHRlbnQpLmdldERlbGVnYXRlKCksIHRoaXMp\nOwogICAgfQoKICAgIEBTdXBwcmVzc1dhcm5pbmdzKCJ1bmNoZWNrZWQiKQog\nICAgcHVibGljIDxUPiBUIGRldGFjaENvcHkoVCBlbnRpdHkpIHsKICAgICAg\nICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICBDb21wYXRpYmls\naXR5IGNvbXBhdCA9IHRoaXMuZ2V0Q29uZmlndXJhdGlvbigpLgogICAgICAg\nICAgICBnZXRDb21wYXRpYmlsaXR5SW5zdGFuY2UoKTsKICAgICAgICBib29s\nZWFuIGNvcHlPbkRldGFjaCA9IGNvbXBhdC5nZXRDb3B5T25EZXRhY2goKTsK\nICAgICAgICBib29sZWFuIGNhc2NhZGVXaXRoRGV0YWNoID0gY29tcGF0Lmdl\ndENhc2NhZGVXaXRoRGV0YWNoKCk7CiAgICAgICAgLy8gU2V0IGNvbXBhdGli\naWxpdHkgb3B0aW9ucyB0byBnZXQgMS54IGRldGFjaCBiZWhhdmlvcgogICAg\nICAgIGNvbXBhdC5zZXRDb3B5T25EZXRhY2godHJ1ZSk7CiAgICAgICAgY29t\ncGF0LnNldENhc2NhZGVXaXRoRGV0YWNoKHRydWUpOwogICAgICAgIHRyeSB7\nCiAgICAgICAgICAgIFQgdCA9IChUKV9icm9rZXIuZGV0YWNoKGVudGl0eSwg\ndGhpcyk7CiAgICAgICAgICAgIHJldHVybiB0OwogICAgICAgIH0gZmluYWxs\neSB7CiAgICAgICAgICAgIC8vIFJlc2V0IGNvbXBhdGliaWxpdHkgb3B0aW9u\ncwogICAgICAgICAgICBjb21wYXQuc2V0Q29weU9uRGV0YWNoKGNvcHlPbkRl\ndGFjaCk7CiAgICAgICAgICAgIGNvbXBhdC5zZXRDYXNjYWRlV2l0aERldGFj\naChjYXNjYWRlV2l0aERldGFjaCk7CiAgICAgICAgfSAgICAgICAgCiAgICB9\nCgogICAgcHVibGljIE9iamVjdFtdIGRldGFjaEFsbChPYmplY3QuLi4gZW50\naXRpZXMpIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAg\nICAgICByZXR1cm4gX2Jyb2tlci5kZXRhY2hBbGwoQXJyYXlzLmFzTGlzdChl\nbnRpdGllcyksIHRoaXMpOwogICAgfQoKICAgIHB1YmxpYyBDb2xsZWN0aW9u\nIGRldGFjaEFsbChDb2xsZWN0aW9uIGVudGl0aWVzKSB7CiAgICAgICAgYXNz\nZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAgcmV0dXJuIEFycmF5cy5h\nc0xpc3QoX2Jyb2tlci5kZXRhY2hBbGwoZW50aXRpZXMsIHRoaXMpKTsKICAg\nIH0KCiAgICBAU3VwcHJlc3NXYXJuaW5ncygidW5jaGVja2VkIikKICAgIHB1\nYmxpYyA8VD4gVCBtZXJnZShUIGVudGl0eSkgewogICAgICAgIGFzc2VydE5v\ndENsb3NlSW52b2tlZCgpOwogICAgICAgIHJldHVybiAoVCkgX2Jyb2tlci5h\ndHRhY2goZW50aXR5LCB0cnVlLCB0aGlzKTsKICAgIH0KCiAgICBwdWJsaWMg\nT2JqZWN0W10gbWVyZ2VBbGwoT2JqZWN0Li4uIGVudGl0aWVzKSB7CiAgICAg\nICAgaWYgKGVudGl0aWVzLmxlbmd0aCA9PSAwKQogICAgICAgICAgICByZXR1\ncm4gRU1QVFlfT0JKRUNUUzsKICAgICAgICByZXR1cm4gbWVyZ2VBbGwoQXJy\nYXlzLmFzTGlzdChlbnRpdGllcykpLnRvQXJyYXkoKTsKICAgIH0KCiAgICBw\ndWJsaWMgQ29sbGVjdGlvbiBtZXJnZUFsbChDb2xsZWN0aW9uIGVudGl0aWVz\nKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAg\ncmV0dXJuIEFycmF5cy5hc0xpc3QoX2Jyb2tlci5hdHRhY2hBbGwoZW50aXRp\nZXMsIHRydWUsIHRoaXMpKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCB0cmFu\nc2FjdGlvbmFsKE9iamVjdCBlbnRpdHksIGJvb2xlYW4gdXBkYXRlVmVyc2lv\nbikgewogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAgICAg\nIF9icm9rZXIudHJhbnNhY3Rpb25hbChlbnRpdHksIHVwZGF0ZVZlcnNpb24s\nIHRoaXMpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHRyYW5zYWN0aW9uYWxB\nbGwoQ29sbGVjdGlvbiBvYmpzLCBib29sZWFuIHVwZGF0ZVZlcnNpb24pIHsK\nICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICBfYnJv\na2VyLnRyYW5zYWN0aW9uYWxBbGwob2JqcywgdXBkYXRlVmVyc2lvbiwgdGhp\ncyk7CiAgICB9CgogICAgcHVibGljIHZvaWQgdHJhbnNhY3Rpb25hbEFsbChP\nYmplY3RbXSBvYmpzLCBib29sZWFuIHVwZGF0ZVZlcnNpb24pIHsKICAgICAg\nICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICBfYnJva2VyLnRy\nYW5zYWN0aW9uYWxBbGwoQXJyYXlzLmFzTGlzdChvYmpzKSwgdXBkYXRlVmVy\nc2lvbiwgdGhpcyk7CiAgICB9CgogICAgcHVibGljIHZvaWQgbm9udHJhbnNh\nY3Rpb25hbChPYmplY3QgZW50aXR5KSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xv\nc2VJbnZva2VkKCk7CiAgICAgICAgX2Jyb2tlci5ub250cmFuc2FjdGlvbmFs\nKGVudGl0eSwgdGhpcyk7CiAgICB9CgogICAgcHVibGljIHZvaWQgbm9udHJh\nbnNhY3Rpb25hbEFsbChDb2xsZWN0aW9uIG9ianMpIHsKICAgICAgICBhc3Nl\ncnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICBfYnJva2VyLm5vbnRyYW5z\nYWN0aW9uYWxBbGwob2JqcywgdGhpcyk7CiAgICB9CgogICAgcHVibGljIHZv\naWQgbm9udHJhbnNhY3Rpb25hbEFsbChPYmplY3RbXSBvYmpzKSB7CiAgICAg\nICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAgX2Jyb2tlci5u\nb250cmFuc2FjdGlvbmFsQWxsKEFycmF5cy5hc0xpc3Qob2JqcyksIHRoaXMp\nOwogICAgfQoKICAgIHB1YmxpYyBHZW5lcmF0b3IgZ2V0TmFtZWRHZW5lcmF0\nb3IoU3RyaW5nIG5hbWUpIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUludm9r\nZWQoKTsKICAgICAgICB0cnkgewogICAgICAgICAgICBTZXF1ZW5jZU1ldGFE\nYXRhIG1ldGEgPSBfYnJva2VyLmdldENvbmZpZ3VyYXRpb24oKS4KICAgICAg\nICAgICAgICAgIGdldE1ldGFEYXRhUmVwb3NpdG9yeUluc3RhbmNlKCkuZ2V0\nU2VxdWVuY2VNZXRhRGF0YShuYW1lLAogICAgICAgICAgICAgICAgX2Jyb2tl\nci5nZXRDbGFzc0xvYWRlcigpLCB0cnVlKTsKICAgICAgICAgICAgU2VxIHNl\ncSA9IG1ldGEuZ2V0SW5zdGFuY2UoX2Jyb2tlci5nZXRDbGFzc0xvYWRlcigp\nKTsKICAgICAgICAgICAgcmV0dXJuIG5ldyBHZW5lcmF0b3JJbXBsKHNlcSwg\nbmFtZSwgX2Jyb2tlciwgbnVsbCk7CiAgICAgICAgfSBjYXRjaCAoUnVudGlt\nZUV4Y2VwdGlvbiByZSkgewogICAgICAgICAgICB0aHJvdyBQZXJzaXN0ZW5j\nZUV4Y2VwdGlvbnMudG9QZXJzaXN0ZW5jZUV4Y2VwdGlvbihyZSk7CiAgICAg\nICAgfQogICAgfQoKICAgIHB1YmxpYyBHZW5lcmF0b3IgZ2V0SWRHZW5lcmF0\nb3IoQ2xhc3MgZm9yQ2xhc3MpIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUlu\ndm9rZWQoKTsKICAgICAgICB0cnkgewogICAgICAgICAgICBDbGFzc01ldGFE\nYXRhIG1ldGEgPSBfYnJva2VyLmdldENvbmZpZ3VyYXRpb24oKS4KICAgICAg\nICAgICAgICAgIGdldE1ldGFEYXRhUmVwb3NpdG9yeUluc3RhbmNlKCkuZ2V0\nTWV0YURhdGEoZm9yQ2xhc3MsCiAgICAgICAgICAgICAgICBfYnJva2VyLmdl\ndENsYXNzTG9hZGVyKCksIHRydWUpOwogICAgICAgICAgICBTZXEgc2VxID0g\nX2Jyb2tlci5nZXRJZGVudGl0eVNlcXVlbmNlKG1ldGEpOwogICAgICAgICAg\nICByZXR1cm4gKHNlcSA9PSBudWxsKSA/IG51bGwgOiBuZXcgR2VuZXJhdG9y\nSW1wbChzZXEsIG51bGwsIF9icm9rZXIsCiAgICAgICAgICAgICAgICBtZXRh\nKTsKICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkgewogICAgICAgICAg\nICB0aHJvdyBQZXJzaXN0ZW5jZUV4Y2VwdGlvbnMudG9QZXJzaXN0ZW5jZUV4\nY2VwdGlvbihlKTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGljIEdlbmVy\nYXRvciBnZXRGaWVsZEdlbmVyYXRvcihDbGFzcyBmb3JDbGFzcywgU3RyaW5n\nIGZpZWxkTmFtZSkgewogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgp\nOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIENsYXNzTWV0YURhdGEgbWV0\nYSA9IF9icm9rZXIuZ2V0Q29uZmlndXJhdGlvbigpLgogICAgICAgICAgICAg\nICAgZ2V0TWV0YURhdGFSZXBvc2l0b3J5SW5zdGFuY2UoKS5nZXRNZXRhRGF0\nYShmb3JDbGFzcywKICAgICAgICAgICAgICAgIF9icm9rZXIuZ2V0Q2xhc3NM\nb2FkZXIoKSwgdHJ1ZSk7CiAgICAgICAgICAgIEZpZWxkTWV0YURhdGEgZm1k\nID0gbWV0YS5nZXRGaWVsZChmaWVsZE5hbWUpOwogICAgICAgICAgICBpZiAo\nZm1kID09IG51bGwpCiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgQXJndW1l\nbnRFeGNlcHRpb24oX2xvYy5nZXQoIm5vLW5hbWVkLWZpZWxkIiwKICAgICAg\nICAgICAgICAgICAgICBmb3JDbGFzcywgZmllbGROYW1lKSwgbnVsbCwgbnVs\nbCwgZmFsc2UpOwoKICAgICAgICAgICAgU2VxIHNlcSA9IF9icm9rZXIuZ2V0\nVmFsdWVTZXF1ZW5jZShmbWQpOwogICAgICAgICAgICByZXR1cm4gKHNlcSA9\nPSBudWxsKSA/IG51bGwgOiBuZXcgR2VuZXJhdG9ySW1wbChzZXEsIG51bGws\nIF9icm9rZXIsCiAgICAgICAgICAgICAgICBtZXRhKTsKICAgICAgICB9IGNh\ndGNoIChFeGNlcHRpb24gZSkgewogICAgICAgICAgICB0aHJvdyBQZXJzaXN0\nZW5jZUV4Y2VwdGlvbnMudG9QZXJzaXN0ZW5jZUV4Y2VwdGlvbihlKTsKICAg\nICAgICB9CiAgICB9CgogICAgcHVibGljIDxUPiBFeHRlbnQ8VD4gY3JlYXRl\nRXh0ZW50KENsYXNzPFQ+IGNscywgYm9vbGVhbiBzdWJjbGFzc2VzKSB7CiAg\nICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAgcmV0dXJu\nIG5ldyBFeHRlbnRJbXBsPFQ+KHRoaXMsIF9icm9rZXIubmV3RXh0ZW50KGNs\ncywgc3ViY2xhc3NlcykpOwogICAgfQoKICAgIEBTdXBwcmVzc1dhcm5pbmdz\nKCJ1bmNoZWNrZWQiKQogICAgcHVibGljIDxUPiBUeXBlZFF1ZXJ5PFQ+IGNy\nZWF0ZVF1ZXJ5KFN0cmluZyBxdWVyeSwgQ2xhc3M8VD4gcmVzdWx0Q2xhc3Mp\nIHsKICAgICAgICByZXR1cm4gY3JlYXRlUXVlcnkocXVlcnkpLnNldFJlc3Vs\ndENsYXNzKHJlc3VsdENsYXNzKTsKICAgIH0KICAgIAogICAgcHVibGljIE9w\nZW5KUEFRdWVyeSBjcmVhdGVRdWVyeShTdHJpbmcgcXVlcnkpIHsKICAgICAg\nICByZXR1cm4gY3JlYXRlUXVlcnkoSlBRTFBhcnNlci5MQU5HX0pQUUwsIHF1\nZXJ5KTsKICAgIH0KCiAgICBwdWJsaWMgT3BlbkpQQVF1ZXJ5IGNyZWF0ZVF1\nZXJ5KFN0cmluZyBsYW5ndWFnZSwgU3RyaW5nIHF1ZXJ5KSB7CiAgICAgICAg\nYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAgdHJ5IHsKICAgICAg\nICAgICAgU3RyaW5nIHFpZCA9IHF1ZXJ5OwogICAgICAgICAgICBQcmVwYXJl\nZFF1ZXJ5IHBxID0gSlBRTFBhcnNlci5MQU5HX0pQUUwuZXF1YWxzKGxhbmd1\nYWdlKQogICAgICAgICAgICAgICAgPyBnZXRQcmVwYXJlZFF1ZXJ5KHFpZCkg\nOiBudWxsOwogICAgICAgICAgICBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVs\nLlF1ZXJ5IHEgPSAocHEgPT0gbnVsbCB8fCAhcHEuaXNJbml0aWFsaXplZCgp\nKQogICAgICAgICAgICAgICAgPyBfYnJva2VyLm5ld1F1ZXJ5KGxhbmd1YWdl\nLCBxdWVyeSkKICAgICAgICAgICAgICAgIDogX2Jyb2tlci5uZXdRdWVyeShw\ncS5nZXRMYW5ndWFnZSgpLCBwcSk7CiAgICAgICAgICAgIC8vIGhhdmUgdG8g\ndmFsaWRhdGUgSlBRTCBhY2NvcmRpbmcgdG8gc3BlYwogICAgICAgICAgICBp\nZiAocHEgPT0gbnVsbCAmJiBKUFFMUGFyc2VyLkxBTkdfSlBRTC5lcXVhbHMo\nbGFuZ3VhZ2UpKQogICAgICAgICAgICAgICAgcS5jb21waWxlKCk7IAogICAg\nICAgICAgICBpZiAocHEgIT0gbnVsbCkgewogICAgICAgICAgICAgICAgcHEu\nc2V0SW50byhxKTsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4g\nbmV3IFF1ZXJ5SW1wbCh0aGlzLCBfcmV0LCBxKS5zZXRJZChxaWQpOwogICAg\nICAgIH0gY2F0Y2ggKFJ1bnRpbWVFeGNlcHRpb24gcmUpIHsKICAgICAgICAg\nICAgdGhyb3cgUGVyc2lzdGVuY2VFeGNlcHRpb25zLnRvUGVyc2lzdGVuY2VF\neGNlcHRpb24ocmUpOwogICAgICAgIH0KICAgIH0KICAgIAogICAgcHVibGlj\nIE9wZW5KUEFRdWVyeSBjcmVhdGVRdWVyeShRdWVyeSBxdWVyeSkgewogICAg\nICAgIGlmIChxdWVyeSA9PSBudWxsKQogICAgICAgICAgICByZXR1cm4gY3Jl\nYXRlUXVlcnkoKFN0cmluZykgbnVsbCk7CiAgICAgICAgYXNzZXJ0Tm90Q2xv\nc2VJbnZva2VkKCk7CiAgICAgICAgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5l\nbC5RdWVyeSBxID0gKChRdWVyeUltcGwpIHF1ZXJ5KS5nZXREZWxlZ2F0ZSgp\nOwogICAgICAgIHJldHVybiBuZXcgUXVlcnlJbXBsKHRoaXMsIF9yZXQsIF9i\ncm9rZXIubmV3UXVlcnkocS5nZXRMYW5ndWFnZSgpLAogICAgICAgICAgICBx\nKSk7CiAgICB9CiAgICAKICAgIEBTdXBwcmVzc1dhcm5pbmdzKCJ1bmNoZWNr\nZWQiKQogICAgcHVibGljIDxUPiBUeXBlZFF1ZXJ5PFQ+IGNyZWF0ZU5hbWVk\nUXVlcnkoU3RyaW5nIG5hbWUsIENsYXNzPFQ+IHJlc3VsdENsYXNzKSB7CiAg\nICAgICAgcmV0dXJuIGNyZWF0ZU5hbWVkUXVlcnkobmFtZSkuc2V0UmVzdWx0\nQ2xhc3MocmVzdWx0Q2xhc3MpOwogICAgfQoKICAgIHB1YmxpYyBPcGVuSlBB\nUXVlcnkgY3JlYXRlTmFtZWRRdWVyeShTdHJpbmcgbmFtZSkgewogICAgICAg\nIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIF9icm9rZXIuYXNz\nZXJ0T3BlbigpOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIFF1ZXJ5TWV0\nYURhdGEgbWV0YSA9IF9icm9rZXIuZ2V0Q29uZmlndXJhdGlvbigpLgogICAg\nICAgICAgICAgICAgZ2V0TWV0YURhdGFSZXBvc2l0b3J5SW5zdGFuY2UoKS5n\nZXRRdWVyeU1ldGFEYXRhKG51bGwsIG5hbWUsCiAgICAgICAgICAgICAgICBf\nYnJva2VyLmdldENsYXNzTG9hZGVyKCksIHRydWUpOwogICAgICAgICAgICBT\ndHJpbmcgcWlkID0gbWV0YS5nZXRRdWVyeVN0cmluZygpOwogICAgICAgICAg\nICAKICAgICAgICAgICAgUHJlcGFyZWRRdWVyeSBwcSA9IEpQUUxQYXJzZXIu\nTEFOR19KUFFMLmVxdWFscyhtZXRhLmdldExhbmd1YWdlKCkpCiAgICAgICAg\nICAgICAgICA/IGdldFByZXBhcmVkUXVlcnkocWlkKSA6IG51bGw7CiAgICAg\nICAgICAgIG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuUXVlcnkgZGVsID0g\nKHBxID09IG51bGwgfHwgIXBxLmlzSW5pdGlhbGl6ZWQoKSkKICAgICAgICAg\nICAgICAgID8gX2Jyb2tlci5uZXdRdWVyeShtZXRhLmdldExhbmd1YWdlKCks\nIG1ldGEuZ2V0UXVlcnlTdHJpbmcoKSkKICAgICAgICAgICAgICAgIDogX2Jy\nb2tlci5uZXdRdWVyeShwcS5nZXRMYW5ndWFnZSgpLCBwcSk7CiAgICAgICAg\nICAgIAogICAgICAgICAgICBpZiAocHEgIT0gbnVsbCkgewogICAgICAgICAg\nICAgICAgcHEuc2V0SW50byhkZWwpOwogICAgICAgICAgICB9IGVsc2Ugewog\nICAgICAgICAgICAgICAgbWV0YS5zZXRJbnRvKGRlbCk7CiAgICAgICAgICAg\nICAgICBkZWwuY29tcGlsZSgpOwogICAgICAgICAgICB9CiAgICAgICAgICAg\nIAogICAgICAgICAgICBPcGVuSlBBUXVlcnkgcSA9IG5ldyBRdWVyeUltcGwo\ndGhpcywgX3JldCwgZGVsKS5zZXRJZChxaWQpOwogICAgICAgICAgICBTdHJp\nbmdbXSBoaW50cyA9IG1ldGEuZ2V0SGludEtleXMoKTsKICAgICAgICAgICAg\nT2JqZWN0W10gdmFsdWVzID0gbWV0YS5nZXRIaW50VmFsdWVzKCk7CiAgICAg\nICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgaGludHMubGVuZ3RoOyBpKysp\nCiAgICAgICAgICAgICAgICBxLnNldEhpbnQoaGludHNbaV0sIHZhbHVlc1tp\nXSk7CiAgICAgICAgICAgIHJldHVybiBxOwogICAgICAgIH0gY2F0Y2ggKFJ1\nbnRpbWVFeGNlcHRpb24gcmUpIHsKICAgICAgICAgICAgdGhyb3cgUGVyc2lz\ndGVuY2VFeGNlcHRpb25zLnRvUGVyc2lzdGVuY2VFeGNlcHRpb24ocmUpOwog\nICAgICAgIH0KICAgIH0gICAgCgogICAgcHVibGljIE9wZW5KUEFRdWVyeSBj\ncmVhdGVOYXRpdmVRdWVyeShTdHJpbmcgcXVlcnkpIHsKICAgICAgICB2YWxp\nZGF0ZVNRTChxdWVyeSk7CiAgICAgICAgcmV0dXJuIGNyZWF0ZVF1ZXJ5KFF1\nZXJ5TGFuZ3VhZ2VzLkxBTkdfU1FMLCBxdWVyeSk7CiAgICB9CgogICAgcHVi\nbGljIE9wZW5KUEFRdWVyeSBjcmVhdGVOYXRpdmVRdWVyeShTdHJpbmcgcXVl\ncnksIENsYXNzIGNscykgewogICAgICAgIHJldHVybiBjcmVhdGVOYXRpdmVR\ndWVyeShxdWVyeSkuc2V0UmVzdWx0Q2xhc3MoY2xzKTsKICAgIH0KCiAgICBw\ndWJsaWMgT3BlbkpQQVF1ZXJ5IGNyZWF0ZU5hdGl2ZVF1ZXJ5KFN0cmluZyBx\ndWVyeSwgU3RyaW5nIG1hcHBpbmdOYW1lKSB7CiAgICAgICAgYXNzZXJ0Tm90\nQ2xvc2VJbnZva2VkKCk7CiAgICAgICAgdmFsaWRhdGVTUUwocXVlcnkpOwog\nICAgICAgIG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuUXVlcnkga2VybmVs\nUXVlcnkgPSBfYnJva2VyLm5ld1F1ZXJ5KAogICAgICAgICAgICBRdWVyeUxh\nbmd1YWdlcy5MQU5HX1NRTCwgcXVlcnkpOwogICAgICAgIGtlcm5lbFF1ZXJ5\nLnNldFJlc3VsdE1hcHBpbmcobnVsbCwgbWFwcGluZ05hbWUpOwogICAgICAg\nIHJldHVybiBuZXcgUXVlcnlJbXBsKHRoaXMsIF9yZXQsIGtlcm5lbFF1ZXJ5\nKTsKICAgIH0KCiAgICAvKioKICAgICAqIFZhbGlkYXRlIHRoYXQgdGhlIHVz\nZXIgcHJvdmlkZWQgU1FMLgogICAgICovCiAgICBwcml2YXRlIHN0YXRpYyB2\nb2lkIHZhbGlkYXRlU1FMKFN0cmluZyBxdWVyeSkgewogICAgICAgIGlmIChT\ndHJpbmdVdGlscy50cmltVG9OdWxsKHF1ZXJ5KSA9PSBudWxsKQogICAgICAg\nICAgICB0aHJvdyBuZXcgQXJndW1lbnRFeGNlcHRpb24oX2xvYy5nZXQoIm5v\nLXNxbCIpLCBudWxsLCBudWxsLCBmYWxzZSk7CiAgICB9CiAgICAKICAgIFBy\nZXBhcmVkUXVlcnlDYWNoZSBnZXRQcmVwYXJlZFF1ZXJ5Q2FjaGUoKSB7CiAg\nICAgICAgcmV0dXJuIF9icm9rZXIuZ2V0Q2FjaGVQcmVwYXJlZFF1ZXJ5KCkg\nPwogICAgICAgICAgICBnZXRDb25maWd1cmF0aW9uKCkuZ2V0UXVlcnlTUUxD\nYWNoZUluc3RhbmNlKCkgOiBudWxsOwogICAgfQogICAgCiAgICAvKioKICAg\nICAqIEdldHMgdGhlIHByZXBhcmVkIHF1ZXJ5IGNhY2hlZCBieSB0aGUgZ2l2\nZW4ga2V5LiAKICAgICAqIAogICAgICogQHJldHVybiB0aGUgY2FjaGVkIFBy\nZXBhcmVkUXVlcnkgb3IgbnVsbCBpZiBub25lIGV4aXN0cy4KICAgICAqLwog\nICAgUHJlcGFyZWRRdWVyeSBnZXRQcmVwYXJlZFF1ZXJ5KFN0cmluZyBpZCkg\newogICAgICAgIFByZXBhcmVkUXVlcnlDYWNoZSBjYWNoZSA9IGdldFByZXBh\ncmVkUXVlcnlDYWNoZSgpOwogICAgICAgIHJldHVybiAoY2FjaGUgPT0gbnVs\nbCkgPyBudWxsIDogY2FjaGUuZ2V0KGlkKTsKICAgIH0KCiAgICBwdWJsaWMg\ndm9pZCBzZXRGbHVzaE1vZGUoRmx1c2hNb2RlVHlwZSBmbHVzaE1vZGUpIHsK\nICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICBfYnJv\na2VyLmFzc2VydE9wZW4oKTsKICAgICAgICBfYnJva2VyLmdldEZldGNoQ29u\nZmlndXJhdGlvbigpLnNldEZsdXNoQmVmb3JlUXVlcmllcwogICAgICAgICAg\nICAodG9GbHVzaEJlZm9yZVF1ZXJpZXMoZmx1c2hNb2RlKSk7CiAgICB9Cgog\nICAgcHVibGljIEZsdXNoTW9kZVR5cGUgZ2V0Rmx1c2hNb2RlKCkgewogICAg\nICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIF9icm9rZXIu\nYXNzZXJ0T3BlbigpOwogICAgICAgIHJldHVybiBmcm9tRmx1c2hCZWZvcmVR\ndWVyaWVzKF9icm9rZXIuZ2V0RmV0Y2hDb25maWd1cmF0aW9uKCkuCiAgICAg\nICAgICAgIGdldEZsdXNoQmVmb3JlUXVlcmllcygpKTsKICAgIH0KCiAgICAv\nKioKICAgICAqIFRyYW5zbGF0ZSBvdXIgaW50ZXJuYWwgZmx1c2ggY29uc3Rh\nbnQgdG8gYSBmbHVzaCBtb2RlIGVudW0gdmFsdWUuCiAgICAgKi8KICAgIHN0\nYXRpYyBGbHVzaE1vZGVUeXBlIGZyb21GbHVzaEJlZm9yZVF1ZXJpZXMoaW50\nIGZsdXNoKSB7CiAgICAgICAgc3dpdGNoIChmbHVzaCkgewogICAgICAgICAg\nICBjYXNlIFF1ZXJ5Rmx1c2hNb2Rlcy5GTFVTSF9UUlVFOgogICAgICAgICAg\nICAgICAgcmV0dXJuIEZsdXNoTW9kZVR5cGUuQVVUTzsKICAgICAgICAgICAg\nY2FzZSBRdWVyeUZsdXNoTW9kZXMuRkxVU0hfRkFMU0U6CiAgICAgICAgICAg\nICAgICByZXR1cm4gRmx1c2hNb2RlVHlwZS5DT01NSVQ7CiAgICAgICAgICAg\nIGRlZmF1bHQ6CiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAg\nICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBUcmFuc2xhdGUgYSBmbHVzaCBt\nb2RlIGVudW0gdmFsdWUgdG8gb3VyIGludGVybmFsIGZsdXNoIGNvbnN0YW50\nLgogICAgICovCiAgICBzdGF0aWMgaW50IHRvRmx1c2hCZWZvcmVRdWVyaWVz\nKEZsdXNoTW9kZVR5cGUgZmx1c2hNb2RlKSB7CiAgICAgICAgLy8gY2hvb3Nl\nIGRlZmF1bHQgZm9yIG51bGwKICAgICAgICBpZiAoZmx1c2hNb2RlID09IG51\nbGwpCiAgICAgICAgICAgIHJldHVybiBRdWVyeUZsdXNoTW9kZXMuRkxVU0hf\nV0lUSF9DT05ORUNUSU9OOwogICAgICAgIGlmIChmbHVzaE1vZGUgPT0gRmx1\nc2hNb2RlVHlwZS5BVVRPKQogICAgICAgICAgICByZXR1cm4gUXVlcnlGbHVz\naE1vZGVzLkZMVVNIX1RSVUU7CiAgICAgICAgaWYgKGZsdXNoTW9kZSA9PSBG\nbHVzaE1vZGVUeXBlLkNPTU1JVCkKICAgICAgICAgICAgcmV0dXJuIFF1ZXJ5\nRmx1c2hNb2Rlcy5GTFVTSF9GQUxTRTsKICAgICAgICB0aHJvdyBuZXcgQXJn\ndW1lbnRFeGNlcHRpb24oZmx1c2hNb2RlLnRvU3RyaW5nKCksIG51bGwsIG51\nbGwsIGZhbHNlKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBjbGVhcigpIHsK\nICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICBfYnJv\na2VyLmRldGFjaEFsbCh0aGlzLCBmYWxzZSk7CiAgICAgICAgX3BsYW5zLmNs\nZWFyKCk7CiAgICB9CgogICAgcHVibGljIE9iamVjdCBnZXREZWxlZ2F0ZSgp\nIHsKICAgICAgICBfYnJva2VyLmFzc2VydE9wZW4oKTsKICAgICAgICBhc3Nl\ncnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICByZXR1cm4gdGhpczsKICAg\nIH0KCiAgICBwdWJsaWMgTG9ja01vZGVUeXBlIGdldExvY2tNb2RlKE9iamVj\ndCBlbnRpdHkpIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsK\nICAgICAgICBfYnJva2VyLmFzc2VydEFjdGl2ZVRyYW5zYWN0aW9uKCk7CiAg\nICAgICAgYXNzZXJ0VmFsaWRBdHRjaGVkRW50aXR5KCJnZXRMb2NrTW9kZSIs\nIGVudGl0eSk7CiAgICAgICAgcmV0dXJuIE1peGVkTG9ja0xldmVsc0hlbHBl\nci5mcm9tTG9ja0xldmVsKAogICAgICAgICAgICBfYnJva2VyLmdldExvY2tM\nZXZlbChlbnRpdHkpKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBsb2NrKE9i\namVjdCBlbnRpdHksIExvY2tNb2RlVHlwZSBtb2RlKSB7CiAgICAgICAgbG9j\nayhlbnRpdHksIG1vZGUsIC0xKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBs\nb2NrKE9iamVjdCBlbnRpdHkpIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUlu\ndm9rZWQoKTsKICAgICAgICBhc3NlcnRWYWxpZEF0dGNoZWRFbnRpdHkoImxv\nY2siLCBlbnRpdHkpOwogICAgICAgIF9icm9rZXIubG9jayhlbnRpdHksIHRo\naXMpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIGxvY2soT2JqZWN0IGVudGl0\neSwgTG9ja01vZGVUeXBlIG1vZGUsIGludCB0aW1lb3V0KSB7CiAgICAgICAg\nYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAgYXNzZXJ0VmFsaWRB\ndHRjaGVkRW50aXR5KCJsb2NrIiwgZW50aXR5KTsKCiAgICAgICAgY29uZmln\ndXJlQ3VycmVudEZldGNoUGxhbihwdXNoRmV0Y2hQbGFuKCksIG51bGwsIG1v\nZGUsIGZhbHNlKTsKICAgICAgICB0cnkgewogICAgICAgICAgICBfYnJva2Vy\nLmxvY2soZW50aXR5LCBNaXhlZExvY2tMZXZlbHNIZWxwZXIudG9Mb2NrTGV2\nZWwobW9kZSksICB0aW1lb3V0LCB0aGlzKTsKICAgICAgICB9IGZpbmFsbHkg\newogICAgICAgICAgICBwb3BGZXRjaFBsYW4oKTsKICAgICAgICB9CiAgICB9\nCgogICAgcHVibGljIHZvaWQgbG9jayhPYmplY3QgZW50aXR5LCBMb2NrTW9k\nZVR5cGUgbW9kZSwgTWFwPFN0cmluZywgT2JqZWN0PiBwcm9wZXJ0aWVzKSB7\nCiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAgYXNz\nZXJ0VmFsaWRBdHRjaGVkRW50aXR5KCJsb2NrIiwgZW50aXR5KTsKICAgICAg\nICBfYnJva2VyLmFzc2VydEFjdGl2ZVRyYW5zYWN0aW9uKCk7CgogICAgICAg\nIGNvbmZpZ3VyZUN1cnJlbnRGZXRjaFBsYW4ocHVzaEZldGNoUGxhbigpLCBw\ncm9wZXJ0aWVzLCBtb2RlLCBmYWxzZSk7CiAgICAgICAgdHJ5IHsKICAgICAg\nICAgICAgX2Jyb2tlci5sb2NrKGVudGl0eSwgTWl4ZWRMb2NrTGV2ZWxzSGVs\ncGVyLnRvTG9ja0xldmVsKG1vZGUpLAogICAgICAgICAgICAgICAgX2Jyb2tl\nci5nZXRGZXRjaENvbmZpZ3VyYXRpb24oKS5nZXRMb2NrVGltZW91dCgpLCB0\naGlzKTsKICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICBwb3BGZXRj\naFBsYW4oKTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGljIHZvaWQgbG9j\na0FsbChDb2xsZWN0aW9uIGVudGl0aWVzKSB7CiAgICAgICAgYXNzZXJ0Tm90\nQ2xvc2VJbnZva2VkKCk7CiAgICAgICAgX2Jyb2tlci5sb2NrQWxsKGVudGl0\naWVzLCB0aGlzKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBsb2NrQWxsKENv\nbGxlY3Rpb24gZW50aXRpZXMsIExvY2tNb2RlVHlwZSBtb2RlLCBpbnQgdGlt\nZW91dCkgewogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAg\nICAgIF9icm9rZXIubG9ja0FsbChlbnRpdGllcywgTWl4ZWRMb2NrTGV2ZWxz\nSGVscGVyLnRvTG9ja0xldmVsKG1vZGUpLAogICAgICAgICAgICB0aW1lb3V0\nLCB0aGlzKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBsb2NrQWxsKE9iamVj\ndC4uLiBlbnRpdGllcykgewogICAgICAgIGxvY2tBbGwoQXJyYXlzLmFzTGlz\ndChlbnRpdGllcykpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIGxvY2tBbGwo\nT2JqZWN0W10gZW50aXRpZXMsIExvY2tNb2RlVHlwZSBtb2RlLCBpbnQgdGlt\nZW91dCkgewogICAgICAgIGxvY2tBbGwoQXJyYXlzLmFzTGlzdChlbnRpdGll\ncyksIG1vZGUsIHRpbWVvdXQpOwogICAgfQoKICAgIHB1YmxpYyBib29sZWFu\nIGNhbmNlbEFsbCgpIHsKICAgICAgICByZXR1cm4gX2Jyb2tlci5jYW5jZWxB\nbGwoKTsKICAgIH0KCiAgICBwdWJsaWMgT2JqZWN0IGdldENvbm5lY3Rpb24o\nKSB7CiAgICAgICAgcmV0dXJuIF9icm9rZXIuZ2V0Q29ubmVjdGlvbigpOwog\nICAgfQoKICAgIHB1YmxpYyBDb2xsZWN0aW9uIGdldE1hbmFnZWRPYmplY3Rz\nKCkgewogICAgICAgIHJldHVybiBfYnJva2VyLmdldE1hbmFnZWRPYmplY3Rz\nKCk7CiAgICB9CgogICAgcHVibGljIENvbGxlY3Rpb24gZ2V0VHJhbnNhY3Rp\nb25hbE9iamVjdHMoKSB7CiAgICAgICAgcmV0dXJuIF9icm9rZXIuZ2V0VHJh\nbnNhY3Rpb25hbE9iamVjdHMoKTsKICAgIH0KCiAgICBwdWJsaWMgQ29sbGVj\ndGlvbiBnZXRQZW5kaW5nVHJhbnNhY3Rpb25hbE9iamVjdHMoKSB7CiAgICAg\nICAgcmV0dXJuIF9icm9rZXIuZ2V0UGVuZGluZ1RyYW5zYWN0aW9uYWxPYmpl\nY3RzKCk7CiAgICB9CgogICAgcHVibGljIENvbGxlY3Rpb24gZ2V0RGlydHlP\nYmplY3RzKCkgewogICAgICAgIHJldHVybiBfYnJva2VyLmdldERpcnR5T2Jq\nZWN0cygpOwogICAgfQoKICAgIHB1YmxpYyBib29sZWFuIGdldE9yZGVyRGly\ndHlPYmplY3RzKCkgewogICAgICAgIHJldHVybiBfYnJva2VyLmdldE9yZGVy\nRGlydHlPYmplY3RzKCk7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0T3Jk\nZXJEaXJ0eU9iamVjdHMoYm9vbGVhbiBvcmRlcikgewogICAgICAgIGFzc2Vy\ndE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIF9icm9rZXIuc2V0T3JkZXJE\naXJ0eU9iamVjdHMob3JkZXIpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIGRp\ncnR5Q2xhc3MoQ2xhc3MgY2xzKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJ\nbnZva2VkKCk7CiAgICAgICAgX2Jyb2tlci5kaXJ0eVR5cGUoY2xzKTsKICAg\nIH0KCiAgICBAU3VwcHJlc3NXYXJuaW5ncygidW5jaGVja2VkIikKICAgIHB1\nYmxpYyBDb2xsZWN0aW9uPENsYXNzPiBnZXRQZXJzaXN0ZWRDbGFzc2VzKCkg\newogICAgICAgIHJldHVybiAoQ29sbGVjdGlvbjxDbGFzcz4pIF9icm9rZXIu\nZ2V0UGVyc2lzdGVkVHlwZXMoKTsKICAgIH0KCiAgICBAU3VwcHJlc3NXYXJu\naW5ncygidW5jaGVja2VkIikKICAgIHB1YmxpYyBDb2xsZWN0aW9uPENsYXNz\nPiBnZXRVcGRhdGVkQ2xhc3NlcygpIHsKICAgICAgICByZXR1cm4gKENvbGxl\nY3Rpb248Q2xhc3M+KSBfYnJva2VyLmdldFVwZGF0ZWRUeXBlcygpOwogICAg\nfQoKICAgIEBTdXBwcmVzc1dhcm5pbmdzKCJ1bmNoZWNrZWQiKQogICAgcHVi\nbGljIENvbGxlY3Rpb248Q2xhc3M+IGdldFJlbW92ZWRDbGFzc2VzKCkgewog\nICAgICAgIHJldHVybiAoQ29sbGVjdGlvbjxDbGFzcz4pIF9icm9rZXIuZ2V0\nRGVsZXRlZFR5cGVzKCk7CiAgICB9CgogICAgcHVibGljIDxUPiBUIGNyZWF0\nZUluc3RhbmNlKENsYXNzPFQ+IGNscykgewogICAgICAgIGFzc2VydE5vdENs\nb3NlSW52b2tlZCgpOwogICAgICAgIHJldHVybiAoVCkgX2Jyb2tlci5uZXdJ\nbnN0YW5jZShjbHMpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIGNsb3NlKCkg\newogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIF9i\ncm9rZXIuY2xvc2UoKTsKICAgICAgICBfcGxhbnMuY2xlYXIoKTsKICAgIH0K\nCiAgICBwdWJsaWMgYm9vbGVhbiBpc09wZW4oKSB7CiAgICAgICAgcmV0dXJu\nICFfYnJva2VyLmlzQ2xvc2VJbnZva2VkKCk7CiAgICB9CgogICAgcHVibGlj\nIHZvaWQgZGlydHkoT2JqZWN0IG8sIFN0cmluZyBmaWVsZCkgewogICAgICAg\nIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIE9wZW5KUEFTdGF0\nZU1hbmFnZXIgc20gPSBfYnJva2VyLmdldFN0YXRlTWFuYWdlcihvKTsKICAg\nICAgICB0cnkgewogICAgICAgICAgICBpZiAoc20gIT0gbnVsbCkKICAgICAg\nICAgICAgICAgIHNtLmRpcnR5KGZpZWxkKTsKICAgICAgICB9IGNhdGNoIChF\neGNlcHRpb24gZSkgewogICAgICAgICAgICB0aHJvdyBQZXJzaXN0ZW5jZUV4\nY2VwdGlvbnMudG9QZXJzaXN0ZW5jZUV4Y2VwdGlvbihlKTsKICAgICAgICB9\nCiAgICB9CgogICAgcHVibGljIE9iamVjdCBnZXRPYmplY3RJZChPYmplY3Qg\nbykgewogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAgICAg\nIHJldHVybiBKUEFGYWNhZGVIZWxwZXIuZnJvbU9wZW5KUEFPYmplY3RJZChf\nYnJva2VyLmdldE9iamVjdElkKG8pKTsKICAgIH0KCiAgICBwdWJsaWMgYm9v\nbGVhbiBpc0RpcnR5KE9iamVjdCBvKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xv\nc2VJbnZva2VkKCk7CiAgICAgICAgcmV0dXJuIF9icm9rZXIuaXNEaXJ0eShv\nKTsKICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBpc1RyYW5zYWN0aW9uYWwo\nT2JqZWN0IG8pIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsK\nICAgICAgICByZXR1cm4gX2Jyb2tlci5pc1RyYW5zYWN0aW9uYWwobyk7CiAg\nICB9CgogICAgcHVibGljIGJvb2xlYW4gaXNQZXJzaXN0ZW50KE9iamVjdCBv\nKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAg\ncmV0dXJuIF9icm9rZXIuaXNQZXJzaXN0ZW50KG8pOwogICAgfQoKICAgIHB1\nYmxpYyBib29sZWFuIGlzTmV3bHlQZXJzaXN0ZW50KE9iamVjdCBvKSB7CiAg\nICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAgcmV0dXJu\nIF9icm9rZXIuaXNOZXcobyk7CiAgICB9CgogICAgcHVibGljIGJvb2xlYW4g\naXNSZW1vdmVkKE9iamVjdCBvKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJ\nbnZva2VkKCk7CiAgICAgICAgcmV0dXJuIF9icm9rZXIuaXNEZWxldGVkKG8p\nOwogICAgfQoKICAgIHB1YmxpYyBib29sZWFuIGlzRGV0YWNoZWQoT2JqZWN0\nIGVudGl0eSkgewogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwog\nICAgICAgIHJldHVybiBfYnJva2VyLmlzRGV0YWNoZWQoZW50aXR5KTsKICAg\nIH0KCiAgICBwdWJsaWMgT2JqZWN0IGdldFZlcnNpb24oT2JqZWN0IG8pIHsK\nICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICByZXR1\ncm4gX2Jyb2tlci5nZXRWZXJzaW9uKG8pOwogICAgfQoKICAgIC8qKgogICAg\nICogVGhyb3cgYXBwcm9wcmlhdGUgZXhjZXB0aW9uIGlmIGNsb3NlIGhhcyBi\nZWVuIGludm9rZWQgYnV0IHRoZSBicm9rZXIKICAgICAqIGlzIHN0aWxsIG9w\nZW4uICBXZSB0ZXN0IG9ubHkgZm9yIHRoaXMgYmVjYXVzZSBpZiB0aGUgYnJv\na2VyIGlzIGFscmVhZHkKICAgICAqIGNsb3NlZCwgaXQgd2lsbCB0aHJvdyBp\ndHMgb3duIG1vcmUgaW5mb3JtYXRpdmUgZXhjZXB0aW9uIHdoZW4gd2UgCiAg\nICAgKiBkZWxlZ2F0ZSB0aGUgcGVuZGluZyBvcGVyYXRpb24gdG8gaXQuCiAg\nICAgKi8KICAgIHZvaWQgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCkgewogICAg\nICAgIGlmICghX2Jyb2tlci5pc0Nsb3NlZCgpICYmIF9icm9rZXIuaXNDbG9z\nZUludm9rZWQoKSkKICAgICAgICAgICAgdGhyb3cgbmV3IEludmFsaWRTdGF0\nZUV4Y2VwdGlvbihfbG9jLmdldCgiY2xvc2UtaW52b2tlZCIpLCBudWxsLAog\nICAgICAgICAgICAgICAgbnVsbCwgdHJ1ZSk7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBUaHJvdyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25pZiBpZiBlbnRp\ndHkgaXMgbm90IGEgdmFsaWQgZW50aXR5IG9yCiAgICAgKiBpZiBpdCBpcyBk\nZXRhY2hlZC4KICAgICAqLwogICAgdm9pZCBhc3NlcnRWYWxpZEF0dGNoZWRF\nbnRpdHkoU3RyaW5nIGNhbGwsIE9iamVjdCBlbnRpdHkpIHsKICAgICAgICBP\ncGVuSlBBU3RhdGVNYW5hZ2VyIHNtID0gX2Jyb2tlci5nZXRTdGF0ZU1hbmFn\nZXIoZW50aXR5KTsKICAgICAgICBpZiAoc20gPT0gbnVsbCB8fCAhc20uaXNQ\nZXJzaXN0ZW50KCkgfHwgc20uaXNEZXRhY2hlZCgpKSB7CiAgICAgICAgICAg\nIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24oX2xvYy5nZXQo\nImludmFsaWRfZW50aXR5X2FyZ3VtZW50IiwgCiAgICAgICAgICAgICAgICBj\nYWxsLCBlbnRpdHkgPT0gbnVsbCA/ICJudWxsIiA6IEV4Y2VwdGlvbnMudG9T\ndHJpbmcoZW50aXR5KSkuZ2V0TWVzc2FnZSgpKTsKICAgICAgICB9CiAgICB9\nCgogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KICAgIC8v\nIEZpbmRDYWxsYmFja3MgaW1wbGVtZW50YXRpb24KICAgIC8vLy8vLy8vLy8v\nLy8vLy8vLy8vLy8vLy8vLy8vLy8vCgogICAgcHVibGljIE9iamVjdCBwcm9j\nZXNzQXJndW1lbnQoT2JqZWN0IGFyZykgewogICAgICAgIHJldHVybiBhcmc7\nCiAgICB9CgogICAgcHVibGljIE9iamVjdCBwcm9jZXNzUmV0dXJuKE9iamVj\ndCBvaWQsIE9wZW5KUEFTdGF0ZU1hbmFnZXIgc20pIHsKICAgICAgICByZXR1\ncm4gKHNtID09IG51bGwgfHwgc20uaXNEZWxldGVkKCkpID8gbnVsbCA6IHNt\nLmdldE1hbmFnZWRJbnN0YW5jZSgpOwogICAgfQoKICAgIC8vLy8vLy8vLy8v\nLy8vLy8vLy8vLy8vLy8vLy8vLwogICAgLy8gT3BDYWxsYmFja3MgaW1wbGVt\nZW50YXRpb24KICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwoK\nICAgIHB1YmxpYyBpbnQgcHJvY2Vzc0FyZ3VtZW50KGludCBvcCwgT2JqZWN0\nIG9iaiwgT3BlbkpQQVN0YXRlTWFuYWdlciBzbSkgewogICAgICAgIHN3aXRj\naCAob3ApIHsKICAgICAgICAgICAgY2FzZSBPUF9ERUxFVEU6CiAgICAgICAg\nICAgICAgICAvLyBjYXNjYWRlIHRocm91Z2ggbm9uLXBlcnNpc3RlbnQgbm9u\nLWRldGFjaGVkIGluc3RhbmNlcwogICAgICAgICAgICAgICAgaWYgKHNtID09\nIG51bGwgJiYgIV9icm9rZXIuaXNEZXRhY2hlZChvYmopKQogICAgICAgICAg\nICAgICAgICAgIHJldHVybiBBQ1RfQ0FTQ0FERTsKICAgICAgICAgICAgICAg\nIGlmIChzbSAhPSBudWxsICYmICFzbS5pc0RldGFjaGVkKCkgJiYgIXNtLmlz\nUGVyc2lzdGVudCgpKQogICAgICAgICAgICAgICAgICAgIHJldHVybiBBQ1Rf\nQ0FTQ0FERTsKICAgICAgICAgICAgICAgIC8vIGlnbm9yZSBkZWxldGVkIGlu\nc3RhbmNlcwogICAgICAgICAgICAgICAgaWYgKHNtICE9IG51bGwgJiYgc20u\naXNEZWxldGVkKCkpCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIEFDVF9O\nT05FOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2Ug\nT1BfQVRUQUNIOgogICAgICAgICAgICAgICAgLy8gZGllIG9uIHJlbW92ZWQK\nICAgICAgICAgICAgICAgIGlmIChzbSAhPSBudWxsICYmIHNtLmlzRGVsZXRl\nZCgpKQogICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBVc2VyRXhjZXB0\naW9uKF9sb2MuZ2V0KCJyZW1vdmVkIiwKICAgICAgICAgICAgICAgICAgICAg\nICAgRXhjZXB0aW9ucy50b1N0cmluZyhvYmopKSkuc2V0RmFpbGVkT2JqZWN0\nKG9iaik7CiAgICAgICAgICAgICAgICAvLyBjYXNjYWRlIHRocm91Z2ggbWFu\nYWdlZCBpbnN0YW5jZXMKICAgICAgICAgICAgICAgIGlmIChzbSAhPSBudWxs\nICYmICFzbS5pc0RldGFjaGVkKCkpCiAgICAgICAgICAgICAgICAgICAgcmV0\ndXJuIEFDVF9DQVNDQURFOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAg\nICAgICAgIGNhc2UgT1BfUkVGUkVTSDoKICAgICAgICAgICAgICAgIC8vIGRp\nZSBvbiB1bm1hbmFnZWQgaW5zdGFuY2VzCiAgICAgICAgICAgICAgICBpZiAo\nc20gPT0gbnVsbCkKICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgVXNl\nckV4Y2VwdGlvbihfbG9jLmdldCgibm90LW1hbmFnZWQiLAogICAgICAgICAg\nICAgICAgICAgICAgICBFeGNlcHRpb25zLnRvU3RyaW5nKG9iaikpKS5zZXRG\nYWlsZWRPYmplY3Qob2JqKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAg\nICAgICAgICBjYXNlIE9QX0RFVEFDSDoKICAgICAgICAgICAgICAgIGlmIChz\nbSA9PSBudWxsIHx8ICFzbS5pc1BlcnNpc3RlbnQoKSB8fCBzbS5pc0RldGFj\naGVkKCkpCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIEFDVF9OT05FOwog\nICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICAgIHJldHVy\nbiBBQ1RfUlVOIHwgQUNUX0NBU0NBREU7CiAgICB9CgogICAgcHVibGljIGlu\ndCBoYXNoQ29kZSgpIHsKICAgICAgICByZXR1cm4gKF9icm9rZXIgPT0gbnVs\nbCkgPyAwIDogX2Jyb2tlci5oYXNoQ29kZSgpOwogICAgfQoKICAgIHB1Ymxp\nYyBib29sZWFuIGVxdWFscyhPYmplY3Qgb3RoZXIpIHsKICAgICAgICBpZiAo\nb3RoZXIgPT0gdGhpcykKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAg\nICAgaWYgKChvdGhlciA9PSBudWxsKSB8fCAob3RoZXIuZ2V0Q2xhc3MoKSAh\nPSB0aGlzLmdldENsYXNzKCkpKQogICAgICAgICAgICByZXR1cm4gZmFsc2U7\nCiAgICAgICAgaWYgKF9icm9rZXIgPT0gbnVsbCkKICAgICAgICAgICAgcmV0\ndXJuIGZhbHNlOwogICAgICAgIHJldHVybiBfYnJva2VyLmVxdWFscygoKEVu\ndGl0eU1hbmFnZXJJbXBsKSBvdGhlcikuX2Jyb2tlcik7CiAgICB9CgogICAg\ncHVibGljIHZvaWQgcmVhZEV4dGVybmFsKE9iamVjdElucHV0IGluKQogICAg\nICAgIHRocm93cyBJT0V4Y2VwdGlvbiwgQ2xhc3NOb3RGb3VuZEV4Y2VwdGlv\nbiB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgX3JldCA9IFBlcnNpc3Rl\nbmNlRXhjZXB0aW9ucy5nZXRSb2xsYmFja1RyYW5zbGF0b3IodGhpcyk7Cgog\nICAgICAgICAgICAvLyB0aGlzIGFzc3VtZXMgdGhhdCBzZXJpYWxpemVkIEJy\nb2tlcnMgYXJlIGZyb20gc29tZXRoaW5nCiAgICAgICAgICAgIC8vIHRoYXQg\nZXh0ZW5kcyBBYnN0cmFjdEJyb2tlckZhY3RvcnkuCiAgICAgICAgICAgIE9i\namVjdCBmYWN0b3J5S2V5ID0gaW4ucmVhZE9iamVjdCgpOwogICAgICAgICAg\nICBBYnN0cmFjdEJyb2tlckZhY3RvcnkgZmFjdG9yeSA9CiAgICAgICAgICAg\nICAgICBBYnN0cmFjdEJyb2tlckZhY3RvcnkuZ2V0UG9vbGVkRmFjdG9yeUZv\ncktleShmYWN0b3J5S2V5KTsKICAgICAgICAgICAgYnl0ZVtdIGJyb2tlckJ5\ndGVzID0gKGJ5dGVbXSkgaW4ucmVhZE9iamVjdCgpOwogICAgICAgICAgICBP\nYmplY3RJbnB1dFN0cmVhbSBpbm5lckluID0gbmV3IEJyb2tlckJ5dGVzSW5w\ndXRTdHJlYW0oYnJva2VyQnl0ZXMsCiAgICAgICAgICAgICAgICBmYWN0b3J5\nLmdldENvbmZpZ3VyYXRpb24oKSk7CgogICAgICAgICAgICBCcm9rZXIgYnJv\na2VyID0gKEJyb2tlcikgaW5uZXJJbi5yZWFkT2JqZWN0KCk7CiAgICAgICAg\nICAgIEVudGl0eU1hbmFnZXJGYWN0b3J5SW1wbCBlbWYgPSAoRW50aXR5TWFu\nYWdlckZhY3RvcnlJbXBsKQogICAgICAgICAgICAgICAgSlBBRmFjYWRlSGVs\ncGVyLnRvRW50aXR5TWFuYWdlckZhY3RvcnkoCiAgICAgICAgICAgICAgICAg\nICAgYnJva2VyLmdldEJyb2tlckZhY3RvcnkoKSk7CiAgICAgICAgICAgIGJy\nb2tlci5wdXRVc2VyT2JqZWN0KEpQQUZhY2FkZUhlbHBlci5FTV9LRVksIHRo\naXMpOwogICAgICAgICAgICBpbml0aWFsaXplKGVtZiwgYnJva2VyKTsKICAg\nICAgICB9IGNhdGNoIChSdW50aW1lRXhjZXB0aW9uIHJlKSB7CiAgICAgICAg\nICAgIHRyeSB7CiAgICAgICAgICAgICAgICByZSA9IF9yZXQudHJhbnNsYXRl\nKHJlKTsKICAgICAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAg\nICAgICAgICAgICAgIC8vIGlnbm9yZQogICAgICAgICAgICB9CiAgICAgICAg\nICAgIHRocm93IHJlOwogICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMgdm9p\nZCB3cml0ZUV4dGVybmFsKE9iamVjdE91dHB1dCBvdXQpIHRocm93cyBJT0V4\nY2VwdGlvbiB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgLy8gdGhpcyBy\nZXF1aXJlcyB0aGF0IG9ubHkgQWJzdHJhY3RCcm9rZXJGYWN0b3J5LXNvdXJj\nZWQKICAgICAgICAgICAgLy8gYnJva2VycyBjYW4gYmUgc2VyaWFsaXplZAog\nICAgICAgICAgICBPYmplY3QgZmFjdG9yeUtleSA9ICgoQWJzdHJhY3RCcm9r\nZXJGYWN0b3J5KSBfYnJva2VyCiAgICAgICAgICAgICAgICAuZ2V0QnJva2Vy\nRmFjdG9yeSgpKS5nZXRQb29sS2V5KCk7CiAgICAgICAgICAgIG91dC53cml0\nZU9iamVjdChmYWN0b3J5S2V5KTsKICAgICAgICAgICAgQnl0ZUFycmF5T3V0\ncHV0U3RyZWFtIGJhb3MgPSBuZXcgQnl0ZUFycmF5T3V0cHV0U3RyZWFtKCk7\nCiAgICAgICAgICAgIE9iamVjdE91dHB1dFN0cmVhbSBpbm5lck91dCA9IG5l\ndyBPYmplY3RPdXRwdXRTdHJlYW0oYmFvcyk7CiAgICAgICAgICAgIGlubmVy\nT3V0LndyaXRlT2JqZWN0KF9icm9rZXIuZ2V0RGVsZWdhdGUoKSk7CiAgICAg\nICAgICAgIGlubmVyT3V0LmZsdXNoKCk7CiAgICAgICAgICAgIG91dC53cml0\nZU9iamVjdChiYW9zLnRvQnl0ZUFycmF5KCkpOwogICAgICAgIH0gY2F0Y2gg\nKFJ1bnRpbWVFeGNlcHRpb24gcmUpIHsKICAgICAgICAgICAgdHJ5IHsKICAg\nICAgICAgICAgICAgIHJlID0gX3JldC50cmFuc2xhdGUocmUpOwogICAgICAg\nICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkgewogICAgICAgICAgICAgICAg\nLy8gaWdub3JlCiAgICAgICAgICAgIH0KICAgICAgICAgICAgdGhyb3cgcmU7\nCiAgICAgICAgfQogICAgfQoKICAgIHByaXZhdGUgc3RhdGljIGNsYXNzIEJy\nb2tlckJ5dGVzSW5wdXRTdHJlYW0gZXh0ZW5kcyBPYmplY3RJbnB1dFN0cmVh\nbSB7CgogICAgICAgIHByaXZhdGUgT3BlbkpQQUNvbmZpZ3VyYXRpb24gY29u\nZjsKCiAgICAgICAgQnJva2VyQnl0ZXNJbnB1dFN0cmVhbShieXRlW10gYnl0\nZXMsIE9wZW5KUEFDb25maWd1cmF0aW9uIGNvbmYpCiAgICAgICAgICAgIHRo\ncm93cyBJT0V4Y2VwdGlvbiB7CiAgICAgICAgICAgIHN1cGVyKG5ldyBCeXRl\nQXJyYXlJbnB1dFN0cmVhbShieXRlcykpOwogICAgICAgICAgICBpZiAoY29u\nZiA9PSBudWxsKQogICAgICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxB\ncmd1bWVudEV4Y2VwdGlvbigKICAgICAgICAgICAgICAgICAgICAiSWxsZWdh\nbCBudWxsIGFyZ3VtZW50IHRvIE9iamVjdElucHV0U3RyZWFtV2l0aExvYWRl\nciIpOwogICAgICAgICAgICB0aGlzLmNvbmYgPSBjb25mOwogICAgICAgIH0K\nCiAgICAgICAgLyoqCiAgICAgICAgICogTWFrZSBhIHByaW1pdGl2ZSBhcnJh\neSBjbGFzcwogICAgICAgICAqLwogICAgICAgIHByaXZhdGUgQ2xhc3MgcHJp\nbWl0aXZlVHlwZShjaGFyIHR5cGUpIHsKICAgICAgICAgICAgc3dpdGNoICh0\neXBlKSB7CiAgICAgICAgICAgICAgICBjYXNlICdCJzogcmV0dXJuIGJ5dGUu\nY2xhc3M7CiAgICAgICAgICAgICAgICBjYXNlICdDJzogcmV0dXJuIGNoYXIu\nY2xhc3M7CiAgICAgICAgICAgICAgICBjYXNlICdEJzogcmV0dXJuIGRvdWJs\nZS5jbGFzczsKICAgICAgICAgICAgICAgIGNhc2UgJ0YnOiByZXR1cm4gZmxv\nYXQuY2xhc3M7CiAgICAgICAgICAgICAgICBjYXNlICdJJzogcmV0dXJuIGlu\ndC5jbGFzczsKICAgICAgICAgICAgICAgIGNhc2UgJ0onOiByZXR1cm4gbG9u\nZy5jbGFzczsKICAgICAgICAgICAgICAgIGNhc2UgJ1MnOiByZXR1cm4gc2hv\ncnQuY2xhc3M7CiAgICAgICAgICAgICAgICBjYXNlICdaJzogcmV0dXJuIGJv\nb2xlYW4uY2xhc3M7CiAgICAgICAgICAgICAgICBkZWZhdWx0OiByZXR1cm4g\nbnVsbDsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgcHJvdGVj\ndGVkIENsYXNzPD8+IHJlc29sdmVDbGFzcyhPYmplY3RTdHJlYW1DbGFzcyBj\nbGFzc0Rlc2MpCiAgICAgICAgICAgIHRocm93cyBJT0V4Y2VwdGlvbiwgQ2xh\nc3NOb3RGb3VuZEV4Y2VwdGlvbiB7CgogICAgICAgICAgICBTdHJpbmcgY25h\nbWUgPSBjbGFzc0Rlc2MuZ2V0TmFtZSgpOwogICAgICAgICAgICBpZiAoY25h\nbWUuc3RhcnRzV2l0aCgiWyIpKSB7CiAgICAgICAgICAgICAgICAvLyBBbiBh\ncnJheQogICAgICAgICAgICAgICAgQ2xhc3M8Pz4gY29tcG9uZW50OwkJLy8g\nY29tcG9uZW50IGNsYXNzCiAgICAgICAgICAgICAgICBpbnQgZGNvdW50OwkJ\nCSAgICAvLyBkaW1lbnNpb24KICAgICAgICAgICAgICAgIGZvciAoZGNvdW50\nPTE7IGNuYW1lLmNoYXJBdChkY291bnQpPT0nWyc7IGRjb3VudCsrKSA7CiAg\nICAgICAgICAgICAgICBpZiAoY25hbWUuY2hhckF0KGRjb3VudCkgPT0gJ0wn\nKSB7CiAgICAgICAgICAgICAgICAgICAgY29tcG9uZW50ID0gbG9va3VwQ2xh\nc3MoY25hbWUuc3Vic3RyaW5nKGRjb3VudCsxLAogICAgICAgICAgICAgICAg\nICAgICAgICBjbmFtZS5sZW5ndGgoKS0xKSk7CiAgICAgICAgICAgICAgICB9\nIGVsc2UgewogICAgICAgICAgICAgICAgICAgIGlmIChjbmFtZS5sZW5ndGgo\nKSAhPSBkY291bnQrMSkgewogICAgICAgICAgICAgICAgICAgICAgICB0aHJv\ndyBuZXcgQ2xhc3NOb3RGb3VuZEV4Y2VwdGlvbihjbmFtZSk7Ly8gbWFsZm9y\nbWVkCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAg\nIGNvbXBvbmVudCA9IHByaW1pdGl2ZVR5cGUoY25hbWUuY2hhckF0KGRjb3Vu\ndCkpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaW50IGRp\nbVtdID0gbmV3IGludFtkY291bnRdOwogICAgICAgICAgICAgICAgZm9yIChp\nbnQgaT0wOyBpPGRjb3VudDsgaSsrKSB7CiAgICAgICAgICAgICAgICAgICAg\nZGltW2ldPTA7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBy\nZXR1cm4gQXJyYXkubmV3SW5zdGFuY2UoY29tcG9uZW50LCBkaW0pLmdldENs\nYXNzKCk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBy\nZXR1cm4gbG9va3VwQ2xhc3MoY25hbWUpOwogICAgICAgICAgICB9CiAgICAg\nICAgfQoKICAgICAgICAvKioKICAgICAgICAgKiBJZiB0aGlzIGlzIGEgZ2Vu\nZXJhdGVkIHN1YmNsYXNzLCBsb29rIHVwIHRoZSBjb3JyZXNwb25kaW5nIENs\nYXNzCiAgICAgICAgICogb2JqZWN0IHZpYSBtZXRhZGF0YS4KICAgICAgICAg\nKi8KICAgICAgICBwcml2YXRlIENsYXNzPD8+IGxvb2t1cENsYXNzKFN0cmlu\nZyBjbGFzc05hbWUpCiAgICAgICAgICAgIHRocm93cyBDbGFzc05vdEZvdW5k\nRXhjZXB0aW9uIHsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAg\nIHJldHVybiBDbGFzcy5mb3JOYW1lKGNsYXNzTmFtZSk7CiAgICAgICAgICAg\nIH0gY2F0Y2ggKENsYXNzTm90Rm91bmRFeGNlcHRpb24gZSkgewogICAgICAg\nICAgICAgICAgaWYgKFBDRW5oYW5jZXIuaXNQQ1N1YmNsYXNzTmFtZShjbGFz\nc05hbWUpKSB7CiAgICAgICAgICAgICAgICAgICAgU3RyaW5nIHN1cGVyTmFt\nZSA9IFBDRW5oYW5jZXIudG9NYW5hZ2VkVHlwZU5hbWUoY2xhc3NOYW1lKTsK\nICAgICAgICAgICAgICAgICAgICBDbGFzc01ldGFEYXRhW10gbWV0YXMgPSBj\nb25mLmdldE1ldGFEYXRhUmVwb3NpdG9yeUluc3RhbmNlKCkKICAgICAgICAg\nICAgICAgICAgICAgICAgLmdldE1ldGFEYXRhcygpOwogICAgICAgICAgICAg\nICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgbWV0YXMubGVuZ3RoOyBpKysp\nIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN1cGVyTmFtZS5lcXVh\nbHMoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXRhc1tpXS5nZXRE\nZXNjcmliZWRUeXBlKCkuZ2V0TmFtZSgpKSkgewogICAgICAgICAgICAgICAg\nICAgICAgICAgICAgcmV0dXJuIFBDUmVnaXN0cnkuZ2V0UENUeXBlKAogICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1ldGFzW2ldLmdldERlc2Ny\naWJlZFR5cGUoKSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAg\nICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIC8vIGlmIGl0\nJ3Mgbm90IGZvdW5kLCB0cnkgdG8gbG9vayBmb3IgaXQgYW55d2F5cwogICAg\nICAgICAgICAgICAgICAgIHJldHVybiBDbGFzcy5mb3JOYW1lKGNsYXNzTmFt\nZSk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAg\nICAgIHRocm93IGU7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0K\nICAgICAgICB9CiAgICB9CgogICAgcHVibGljIHZvaWQgZGV0YWNoKE9iamVj\ndCBlbnRpdHkpIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsK\nICAgICAgICBfYnJva2VyLmRldGFjaChlbnRpdHksIHRoaXMpOwogICAgfQoK\nICAgIC8qKgogICAgICogQ3JlYXRlIGEgcXVlcnkgZnJvbSB0aGUgZ2l2ZW4g\nQ3JpdHJpYVF1ZXJ5LgogICAgICogQ29tcGlsZSB0byByZWdpc3RlciB0aGUg\ncGFyYW1ldGVycyBpbiB0aGlzIHF1ZXJ5LgogICAgICovCiAgICBwdWJsaWMg\nPFQ+IFR5cGVkUXVlcnk8VD4gY3JlYXRlUXVlcnkoQ3JpdGVyaWFRdWVyeTxU\nPiBjcml0ZXJpYVF1ZXJ5KSB7CiAgICAgICAgKChPcGVuSlBBQ3JpdGVyaWFR\ndWVyeTxUPiljcml0ZXJpYVF1ZXJ5KS5jb21waWxlKCk7IAogICAgICAgIAog\nICAgICAgIG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuUXVlcnkga2VybmVs\nUXVlcnkgPV9icm9rZXIubmV3UXVlcnkoQ3JpdGVyaWFCdWlsZGVySW1wbC5M\nQU5HX0NSSVRFUklBLCBjcml0ZXJpYVF1ZXJ5KTsKICAgICAgICAKICAgICAg\nICBRdWVyeUltcGw8VD4gZmFjYWRlUXVlcnkgPSBuZXcgUXVlcnlJbXBsPFQ+\nKHRoaXMsIF9yZXQsIGtlcm5lbFF1ZXJ5KTsKICAgICAgICBTZXQ8UGFyYW1l\ndGVyRXhwcmVzc2lvbjw/Pj4gcGFyYW1zID0gY3JpdGVyaWFRdWVyeS5nZXRQ\nYXJhbWV0ZXJzKCk7CiAgICAgICAgCiAgICAgICAgZm9yIChQYXJhbWV0ZXJF\neHByZXNzaW9uPD8+IHBhcmFtIDogcGFyYW1zKSB7CiAgICAgICAgICAgIGZh\nY2FkZVF1ZXJ5LmRlY2xhcmVQYXJhbWV0ZXIocGFyYW0sIHBhcmFtKTsKICAg\nICAgICB9CiAgICAgICAgcmV0dXJuIGZhY2FkZVF1ZXJ5OwogICAgfQogICAg\nCiAgICBwdWJsaWMgT3BlbkpQQVF1ZXJ5IGNyZWF0ZUR5bmFtaWNRdWVyeSgK\nICAgICAgICBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UucXVlcnku\nUXVlcnlEZWZpbml0aW9uIHFkZWYpIHsKICAgICAgICBTdHJpbmcganBxbCA9\nIF9lbWYuZ2V0RHluYW1pY1F1ZXJ5QnVpbGRlcigpLnRvSlBRTChxZGVmKTsK\nICAgICAgICByZXR1cm4gY3JlYXRlUXVlcnkoanBxbCk7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBHZXQgdGhlIHByb3BlcnRpZXMgdXNlZCBjdXJyZW50bHkg\nYnkgdGhpcyBlbnRpdHkgbWFuYWdlci4KICAgICAqIFRoZSBwcm9wZXJ0eSBr\nZXlzIGFuZCB0aGVpciB2YWx1ZXMgYXJlIGhhcnZlc3RlZCBmcm9tIGtlcm5l\nbCBhcnRpZmFjdHMgbmFtZWx5CiAgICAgKiB0aGUgQnJva2VyIGFuZCBGZXRj\naFBsYW4gYnkgcmVmbGVjdGlvbi4KICAgICAqIFRoZXNlIHByb3BlcnR5IGtl\neXMgYW5kIHZhbHVlcyB0aGF0IGRlbm90ZSB0aGUgYmVhbiBwcm9wZXJ0aWVz\nL3ZhbHVlcyBvZiB0aGUga2VybmVsIGFydGlmYWN0cwogICAgICogYXJlIGNv\nbnZlcnRlZCB0byB0aGUgb3JpZ2luYWwga2V5cy92YWx1ZXMgdGhhdCB1c2Vy\nIHVzZWQgdG8gc2V0IHRoZSBwcm9wZXJ0aWVzLgogICAgICogICAgCiAgICAg\nKi8KICAgIHB1YmxpYyBNYXA8U3RyaW5nLCBPYmplY3Q+IGdldFByb3BlcnRp\nZXMoKSB7CiAgICAgICAgTWFwPFN0cmluZyxPYmplY3Q+IHByb3BzID0gX2Jy\nb2tlci5nZXRQcm9wZXJ0aWVzKCk7CiAgICAgICAgZm9yIChTdHJpbmcgcyA6\nIF9icm9rZXIuZ2V0U3VwcG9ydGVkUHJvcGVydGllcygpKSB7CiAgICAgICAg\nICAgIFN0cmluZyBrZXJuZWxLZXkgPSBnZXRCZWFuUHJvcGVydHlOYW1lKHMp\nOwogICAgICAgICAgICBNZXRob2QgZ2V0dGVyID0gUmVmbGVjdGlvbi5maW5k\nR2V0dGVyKHRoaXMuZ2V0Q2xhc3MoKSwga2VybmVsS2V5LCBmYWxzZSk7CiAg\nICAgICAgICAgIGlmIChnZXR0ZXIgIT0gbnVsbCkgewogICAgICAgICAgICAg\nICAgU3RyaW5nIHVzZXJLZXkgPSBKUEFQcm9wZXJ0aWVzLmdldFVzZXJOYW1l\nKGtlcm5lbEtleSk7CiAgICAgICAgICAgICAgICBPYmplY3Qga3ZhbHVlICA9\nIFJlZmxlY3Rpb24uZ2V0KHRoaXMsIGdldHRlcik7CiAgICAgICAgICAgICAg\nICBwcm9wcy5wdXQodXNlcktleS5lcXVhbHMoa2VybmVsS2V5KSA/IHMgOiB1\nc2VyS2V5LCBKUEFQcm9wZXJ0aWVzLmNvbnZlcnRUb1VzZXJWYWx1ZSh1c2Vy\nS2V5LCBrdmFsdWUpKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAg\nICBGZXRjaFBsYW4gZmV0Y2ggPSBnZXRGZXRjaFBsYW4oKTsKICAgICAgICBD\nbGFzczw/PiBmZXRjaFR5cGUgPSBmZXRjaC5nZXRDbGFzcygpOwogICAgICAg\nIFNldDxTdHJpbmc+IGZQcm9wZXJ0aWVzID0gUmVmbGVjdGlvbi5nZXRCZWFu\nU3R5bGVQcm9wZXJ0eU5hbWVzKGZldGNoVHlwZSk7CiAgICAgICAgZm9yIChT\ndHJpbmcgcyA6IGZQcm9wZXJ0aWVzKSB7CiAgICAgICAgICAgIFN0cmluZyBr\nZXJuZWxLZXkgPSBnZXRCZWFuUHJvcGVydHlOYW1lKHMpOwogICAgICAgICAg\nICBNZXRob2QgZ2V0dGVyID0gUmVmbGVjdGlvbi5maW5kR2V0dGVyKGZldGNo\nVHlwZSwga2VybmVsS2V5LCBmYWxzZSk7CiAgICAgICAgICAgIGlmIChnZXR0\nZXIgIT0gbnVsbCkgewogICAgICAgICAgICAgICAgU3RyaW5nIHVzZXJLZXkg\nPSBKUEFQcm9wZXJ0aWVzLmdldFVzZXJOYW1lKGtlcm5lbEtleSk7CiAgICAg\nICAgICAgICAgICBPYmplY3Qga3ZhbHVlICA9IFJlZmxlY3Rpb24uZ2V0KGZl\ndGNoLCBnZXR0ZXIpOwogICAgICAgICAgICAgICAgcHJvcHMucHV0KHVzZXJL\nZXkuZXF1YWxzKGtlcm5lbEtleSkgPyBzIDogdXNlcktleSwgSlBBUHJvcGVy\ndGllcy5jb252ZXJ0VG9Vc2VyVmFsdWUodXNlcktleSwga3ZhbHVlKSk7CiAg\nICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIHByb3BzOwog\nICAgfQoKICAgIHB1YmxpYyBPcGVuSlBBQ3JpdGVyaWFCdWlsZGVyIGdldENy\naXRlcmlhQnVpbGRlcigpIHsKICAgICAgICByZXR1cm4gX2VtZi5nZXRDcml0\nZXJpYUJ1aWxkZXIoKTsKICAgIH0KCiAgICBwdWJsaWMgU2V0PFN0cmluZz4g\nZ2V0U3VwcG9ydGVkUHJvcGVydGllcygpIHsKICAgICAgICByZXR1cm4gX2Jy\nb2tlci5nZXRTdXBwb3J0ZWRQcm9wZXJ0aWVzKCk7CiAgICB9CgogICAgcHVi\nbGljIDxUPiBUIHVud3JhcChDbGFzczxUPiBjbHMpIHsKICAgICAgICBPYmpl\nY3RbXSBkZWxlZ2F0ZXMgPSBuZXcgT2JqZWN0W117X2Jyb2tlci5nZXRJbm5l\ncm1vc3REZWxlZ2F0ZSgpLAogICAgICAgICAgICBfYnJva2VyLmdldERlbGVn\nYXRlKCksIF9icm9rZXIsIHRoaXN9OwogICAgICAgIGZvciAoT2JqZWN0IG8g\nOiBkZWxlZ2F0ZXMpIHsKICAgICAgICAgICAgaWYgKGNscy5pc0luc3RhbmNl\nKG8pKQogICAgICAgICAgICAgICAgcmV0dXJuIChUKW87CiAgICAgICAgfQog\nICAgICAgIHRocm93IG5ldyBQZXJzaXN0ZW5jZUV4Y2VwdGlvbihfbG9jLmdl\ndCgidW53cmFwLWVtLWludmFsaWQiLCBjbHMpCiAgICAgICAgICAgIC50b1N0\ncmluZygpLCBudWxsLCB0aGlzLCBmYWxzZSk7CiAgICB9CgogICAgcHVibGlj\nIHZvaWQgc2V0UXVlcnlTUUxDYWNoZShib29sZWFuIGZsYWcpIHsKICAgICAg\nICBfYnJva2VyLnNldENhY2hlUHJlcGFyZWRRdWVyeShmbGFnKTsKICAgIH0K\nICAgIAogICAgcHVibGljIGJvb2xlYW4gZ2V0UXVlcnlTUUxDYWNoZSgpIHsK\nICAgICAgICByZXR1cm4gX2Jyb2tlci5nZXRDYWNoZVByZXBhcmVkUXVlcnko\nKTsKICAgIH0KICAgIAogICAgUnVudGltZUV4Y2VwdGlvblRyYW5zbGF0b3Ig\nZ2V0RXhjZXB0aW9uVHJhbnNsYXRvcigpIHsKICAgICAgICByZXR1cm4gX3Jl\ndDsKICAgIH0KCiAgICAvKioKICAgICAqIFBvcHVsYXRlIHRoZSBnaXZlbiBG\nZXRjaFBsYW4gd2l0aCB0aGUgZ2l2ZW4gcHJvcGVydGllcy4gCiAgICAgKiBP\ncHRpb25hbGx5IG92ZXJyaWRlcyB0aGUgZ2l2ZW4gbG9jayBtb2RlLgogICAg\nICovCiAgICBwcml2YXRlIHZvaWQgY29uZmlndXJlQ3VycmVudEZldGNoUGxh\nbihGZXRjaFBsYW4gZmV0Y2gsIE1hcDxTdHJpbmcsIE9iamVjdD4gcHJvcGVy\ndGllcywgCiAgICAgICAgICAgIExvY2tNb2RlVHlwZSBsb2NrLCBib29sZWFu\nIHJlcXVpcmVzVHhuKSB7CiAgICAgICAgLy8gaGFuZGxlIHByb3BlcnRpZXMg\naW4gbWFwIGZpcnN0CiAgICAgICAgY29uZmlndXJlQ3VycmVudENhY2hlTW9k\nZXMoZmV0Y2gsIHByb3BlcnRpZXMpOwogICAgICAgIGlmIChwcm9wZXJ0aWVz\nICE9IG51bGwpIHsKICAgICAgICAgICAgZm9yIChNYXAuRW50cnk8U3RyaW5n\nLCBPYmplY3Q+IGVudHJ5IDogcHJvcGVydGllcy5lbnRyeVNldCgpKQogICAg\nICAgICAgICAgICAgZmV0Y2guc2V0SGludChlbnRyeS5nZXRLZXkoKSwgZW50\ncnkuZ2V0VmFsdWUoKSk7CiAgICAgICAgfQogICAgICAgIC8vIG92ZXJyaWRl\nIHdpdGggdGhlIHNwZWNpZmljIGxvY2tNb2RlLCBpZiBuZWVkZWQuCiAgICAg\nICAgaWYgKGxvY2sgIT0gbnVsbCAmJiBsb2NrICE9IExvY2tNb2RlVHlwZS5O\nT05FKSB7CiAgICAgICAgICAgIGlmIChyZXF1aXJlc1R4bikgewogICAgICAg\nICAgICAgICAgX2Jyb2tlci5hc3NlcnRBY3RpdmVUcmFuc2FjdGlvbigpOwog\nICAgICAgICAgICB9CiAgICAgICAgICAgIC8vIE92ZXJyaWRlIHJlYWQgbG9j\nayBsZXZlbAogICAgICAgICAgICBMb2NrTW9kZVR5cGUgY3VyUmVhZExvY2tN\nb2RlID0gZmV0Y2guZ2V0UmVhZExvY2tNb2RlKCk7CiAgICAgICAgICAgIGlm\nIChsb2NrICE9IGN1clJlYWRMb2NrTW9kZSkKICAgICAgICAgICAgICAgIGZl\ndGNoLnNldFJlYWRMb2NrTW9kZShsb2NrKTsKICAgICAgICB9CiAgICB9CiAg\nICAKICAgIHByaXZhdGUgdm9pZCBjb25maWd1cmVDdXJyZW50Q2FjaGVNb2Rl\ncyhGZXRjaFBsYW4gZmV0Y2gsIE1hcDxTdHJpbmcsIE9iamVjdD4gcHJvcGVy\ndGllcykgewogICAgICAgIGlmIChwcm9wZXJ0aWVzID09IG51bGwpCiAgICAg\nICAgICAgIHJldHVybjsKICAgICAgICBDYWNoZVJldHJpZXZlTW9kZSByTW9k\nZSA9IEpQQVByb3BlcnRpZXMuZ2V0RW51bVZhbHVlKENhY2hlUmV0cmlldmVN\nb2RlLmNsYXNzLCAKICAgICAgICAgICAgICAgIEpQQVByb3BlcnRpZXMuQ0FD\nSEVfUkVUUklFVkVfTU9ERSwgcHJvcGVydGllcyk7CiAgICAgICAgaWYgKHJN\nb2RlICE9IG51bGwpIHsKICAgICAgICAgICAgZmV0Y2guc2V0Q2FjaGVSZXRy\naWV2ZU1vZGUoSlBBUHJvcGVydGllcy5jb252ZXJ0VG9LZW5lbFZhbHVlKERh\ndGFDYWNoZVJldHJpZXZlTW9kZS5jbGFzcywgCiAgICAgICAgICAgICAgICAg\nICAgSlBBUHJvcGVydGllcy5DQUNIRV9SRVRSSUVWRV9NT0RFLCByTW9kZSkp\nOwogICAgICAgICAgICBwcm9wZXJ0aWVzLnJlbW92ZShKUEFQcm9wZXJ0aWVz\nLkNBQ0hFX1JFVFJJRVZFX01PREUpOwogICAgICAgIH0KICAgICAgICBDYWNo\nZVN0b3JlTW9kZSBzTW9kZSA9IEpQQVByb3BlcnRpZXMuZ2V0RW51bVZhbHVl\nKENhY2hlU3RvcmVNb2RlLmNsYXNzLCAKICAgICAgICAgICAgICAgIEpQQVBy\nb3BlcnRpZXMuQ0FDSEVfU1RPUkVfTU9ERSwgcHJvcGVydGllcyk7CiAgICAg\nICAgaWYgKHNNb2RlICE9IG51bGwpIHsKICAgICAgICAgICAgZmV0Y2guc2V0\nQ2FjaGVTdG9yZU1vZGUoSlBBUHJvcGVydGllcy5jb252ZXJ0VG9LZW5lbFZh\nbHVlKERhdGFDYWNoZVN0b3JlTW9kZS5jbGFzcywgCiAgICAgICAgICAgICAg\nICAgICAgSlBBUHJvcGVydGllcy5DQUNIRV9TVE9SRV9NT0RFLCBzTW9kZSkp\nOwogICAgICAgICAgICBwcm9wZXJ0aWVzLnJlbW92ZShKUEFQcm9wZXJ0aWVz\nLkNBQ0hFX1NUT1JFX01PREUpOwogICAgICAgIH0KICAgIH0KCiAgICBwdWJs\naWMgTWV0YW1vZGVsIGdldE1ldGFtb2RlbCgpIHsKICAgICAgICByZXR1cm4g\nX2VtZi5nZXRNZXRhbW9kZWwoKTsKICAgIH0KCiAgICAvKioKICAgICAqIFNl\ndHMgdGhlIGdpdmVuIHByb3BlcnR5IHRvIHRoZSBnaXZlbiB2YWx1ZSwgcmVm\nbGVjdGl2ZWx5LgogICAgICogCiAgICAgKiBUaGUgcHJvcGVydHkga2V5IGlz\nIHRyYW5zcG9zZWQgdG8gYSBiZWFuLXN0eWxlIHByb3BlcnR5LgogICAgICog\nVGhlIHZhbHVlIGlzIGNvbnZlcnRlZCB0byBhIHR5cGUgY29uc3VtYWJsZSBi\neSB0aGUga2VybmVsLgogICAgICogQWZ0ZXIgcmVxdWlzaXRlIHRyYW5zZm9y\nbWF0aW9uLCBpZiB0aGUgdmFsdWUgY2FuIG5vdCBiZSBzZXQKICAgICAqIG9u\nIGVpdGhlciB0aGlzIGluc3RhbmNlIG9yIGl0cyBmZXRjaCBwbGFuIGJ5IHJl\nZmxlY3Rpb24sCiAgICAgKiB0aGVuIGFuIHdhcm5pbmcgbWVzc2FnZSAobm90\nIGFuIGV4Y2VwdGlvbiBhcyBwZXIgSlBBIHNwZWNpZmljYXRpb24pIGlzIGlz\nc3VlZC4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0UHJvcGVydHkoU3Ry\naW5nIHByb3AsIE9iamVjdCB2YWx1ZSkgewogICAgICAgIGlmICghc2V0S2Vy\nbmVsUHJvcGVydHkodGhpcywgcHJvcCwgdmFsdWUpKSB7CiAgICAgICAgICAg\nIGlmICghc2V0S2VybmVsUHJvcGVydHkodGhpcy5nZXRGZXRjaFBsYW4oKSwg\ncHJvcCwgdmFsdWUpKSB7CiAgICAgICAgICAgICAgICBMb2cgbG9nID0gZ2V0\nQ29uZmlndXJhdGlvbigpLmdldExvZyhPcGVuSlBBQ29uZmlndXJhdGlvbi5M\nT0dfUlVOVElNRSk7CiAgICAgICAgICAgICAgICBpZiAobG9nLmlzV2FybkVu\nYWJsZWQoKSkgewogICAgICAgICAgICAgICAgICAgIGxvZy53YXJuKF9sb2Mu\nZ2V0KCJiYWQtZW0tcHJvcCIsIHByb3AsIHZhbHVlID09IG51bGwgPyAiIiA6\nIHZhbHVlLmdldENsYXNzKCkrIjoiICsgdmFsdWUpKTsKICAgICAgICAgICAg\nICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CiAgICAKICAg\nIC8qKgogICAgICogQXR0ZW1wdCB0byBzZXQgdGhlIGdpdmVuIHByb3BlcnR5\nIGFuZCB2YWx1ZSB0byB0aGUgZ2l2ZW4gdGFyZ2V0IGluc3RhbmNlLgogICAg\nICogVGhlIG9yaWdpbmFsIHByb3BlcnR5IGlzIHRyYW5zcG9zZWQgdG8gYSBi\nZWFuLXN0eWxlIHByb3BlcnR5IG5hbWUuCiAgICAgKiBUaGUgb3JpZ2luYWwg\ndmFsdWUgaXMgdHJhbnNmb3JtZWQgdG8gYSB0eXBlIGNvbnN1bWFibGUgYnkg\ndGhlIHRhcmdldC4KICAgICAqICAKICAgICAqIEByZXR1cm4gaWYgdGhlIHBy\nb3BlcnR5IGNhbiBiZSBzZXQgdG8gdGhlIGdpdmVuIHRhcmdldC4KICAgICAq\nLwogICAgcHJpdmF0ZSBib29sZWFuIHNldEtlcm5lbFByb3BlcnR5KE9iamVj\ndCB0YXJnZXQsIFN0cmluZyBvcmlnaW5hbCwgT2JqZWN0IHZhbHVlKSB7CiAg\nICAgICAgU3RyaW5nIGJlYW5Qcm9wID0gZ2V0QmVhblByb3BlcnR5TmFtZShv\ncmlnaW5hbCk7CiAgICAgICAgSlBBUHJvcGVydGllcy5yZWNvcmQoYmVhblBy\nb3AsIG9yaWdpbmFsKTsKICAgICAgICBDbGFzczw/PiBrVHlwZSAgPSBudWxs\nOwogICAgICAgIE9iamVjdCAgIGtWYWx1ZSA9IG51bGw7CiAgICAgICAgTWV0\naG9kIHNldHRlciA9IFJlZmxlY3Rpb24uZmluZFNldHRlcih0YXJnZXQuZ2V0\nQ2xhc3MoKSwgYmVhblByb3AsIGZhbHNlKTsKICAgICAgICBpZiAoc2V0dGVy\nICE9IG51bGwpIHsKICAgICAgICAgICAga1R5cGUgID0gc2V0dGVyLmdldFBh\ncmFtZXRlclR5cGVzKClbMF07CiAgICAgICAgICAgIGtWYWx1ZSA9IGNvbnZl\ncnRVc2VyVmFsdWUob3JpZ2luYWwsIHZhbHVlLCBrVHlwZSk7CiAgICAgICAg\nICAgIFJlZmxlY3Rpb24uc2V0KHRhcmdldCwgc2V0dGVyLCBrVmFsdWUpOwog\nICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9IGVsc2UgewogICAg\nICAgICAgICBGaWVsZCBmaWVsZCA9IFJlZmxlY3Rpb24uZmluZEZpZWxkKHRh\ncmdldC5nZXRDbGFzcygpLCBiZWFuUHJvcCwgZmFsc2UpOwogICAgICAgICAg\nICBpZiAoZmllbGQgIT0gbnVsbCkgewogICAgICAgICAgICAgICAga1R5cGUg\nID0gZmllbGQuZ2V0VHlwZSgpOwogICAgICAgICAgICAgICAga1ZhbHVlID0g\nY29udmVydFVzZXJWYWx1ZShvcmlnaW5hbCwgdmFsdWUsIGtUeXBlKTsKICAg\nICAgICAgICAgICAgIFJlZmxlY3Rpb24uc2V0KHRhcmdldCwgZmllbGQsIGtW\nYWx1ZSk7CiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAg\nICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAg\nICAKICAgIC8qKgogICAgICogRXh0cmFjdCBhIGJlYW4tc3R5bGUgcHJvcGVy\ndHkgbmFtZSBmcm9tIHRoZSBnaXZlbiBzdHJpbmcuCiAgICAgKiBJZiB0aGUg\nZ2l2ZW4gc3RyaW5nIGlzIDxjb2RlPiJhLmIueHl6IjwvY29kZT4gdGhlbiBy\nZXR1cm5zIDxjb2RlPiJ4eXoiPC9jb2RlPiAKICAgICAqLwogICAgU3RyaW5n\nIGdldEJlYW5Qcm9wZXJ0eU5hbWUoU3RyaW5nIHVzZXIpIHsKICAgICAgICBT\ndHJpbmcgcmVzdWx0ID0gdXNlcjsKICAgICAgICBpZiAoSlBBUHJvcGVydGll\ncy5pc1ZhbGlkS2V5KHVzZXIpKSB7CiAgICAgICAgICAgIHJlc3VsdCA9IEpQ\nQVByb3BlcnRpZXMuZ2V0QmVhblByb3BlcnR5KHVzZXIpOwogICAgICAgIH0g\nZWxzZSB7CiAgICAgICAgICAgIGludCBkb3QgPSB1c2VyLmxhc3RJbmRleE9m\nKCcuJyk7CiAgICAgICAgICAgIGlmIChkb3QgIT0gLTEpCiAgICAgICAgICAg\nICAgICByZXN1bHQgPSB1c2VyLnN1YnN0cmluZyhkb3QrMSk7CiAgICAgICAg\nfQogICAgICAgIHJldHVybiByZXN1bHQ7IAogICAgfQogICAgCiAgICAKICAg\nIC8qKgogICAgICogQ29udmVydCB0aGUgZ2l2ZW4gdmFsdWUgdG8gYSB2YWx1\nZSBjb25zdW1hYmxlIGJ5IE9wZW5KUEEga2VybmVsIGNvbnN0cnVjdHMuCiAg\nICAgKi8KICAgIE9iamVjdCBjb252ZXJ0VXNlclZhbHVlKFN0cmluZyBrZXks\nIE9iamVjdCB2YWx1ZSwgQ2xhc3M8Pz4gdGFyZ2V0VHlwZSkgewogICAgICAg\nIGlmIChKUEFQcm9wZXJ0aWVzLmlzVmFsaWRLZXkoa2V5KSkgCiAgICAgICAg\nICAgIHJldHVybiBKUEFQcm9wZXJ0aWVzLmNvbnZlcnRUb0tlbmVsVmFsdWUo\ndGFyZ2V0VHlwZSwga2V5LCB2YWx1ZSk7CiAgICAgICAgaWYgKHZhbHVlIGlu\nc3RhbmNlb2YgU3RyaW5nKSB7CiAgICAgICAgICAgIGlmICgibnVsbCIuZXF1\nYWxzKHZhbHVlKSkgewogICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAg\nICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICByZXR1cm4gU3Ry\naW5ncy5wYXJzZSgoU3RyaW5nKSB2YWx1ZSwgdGFyZ2V0VHlwZSk7CiAgICAg\nICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIHZhbHVlOwogICAg\nfQp9Cg==\n","encoding":"base64"}

