{"sha":"2f3c3bb0ff9b4c04d8d63c7aedd7b755178219b9","node_id":"MDQ6QmxvYjIwNjM2NDoyZjNjM2JiMGZmOWI0YzA0ZDhkNjNjN2FlZGQ3Yjc1NTE3ODIxOWI5","size":11073,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/2f3c3bb0ff9b4c04d8d63c7aedd7b755178219b9","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2U7CgppbXBv\ncnQgamF2YS51dGlsLkNvbGxlY3Rpb25zOwppbXBvcnQgamF2YS51dGlsLkhh\nc2hTZXQ7CmltcG9ydCBqYXZhLnV0aWwuTGlzdDsKaW1wb3J0IGphdmEudXRp\nbC5NYXA7CmltcG9ydCBqYXZhLnV0aWwuU2V0OwppbXBvcnQgamF2YS51dGls\nLlRyZWVNYXA7CgppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmNvbmYuT3Bl\nbkpQQUNvbmZpZ3VyYXRpb247CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\nZW5oYW5jZS5SZWZsZWN0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLmtlcm5lbC5GZXRjaENvbmZpZ3VyYXRpb247CmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEua2VybmVsLkZpbHRlcnM7CmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEua2VybmVsLlF1ZXJ5SGludHM7CmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEua2VybmVsLmV4cHMuQWdncmVnYXRlTGlzdGVuZXI7CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLmV4cHMuRmlsdGVyTGlzdGVuZXI7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLmNvbmYuUHJvZHVjdERl\ncml2YXRpb247CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLmNvbmYu\nUHJvZHVjdERlcml2YXRpb25zOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLmxpYi5sb2cuTG9nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51\ndGlsLkxvY2FsaXplcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIu\ndXRpbC5TdHJpbmdEaXN0YW5jZTsKCi8qKgogKiBNYW5hZ2VzIHF1ZXJ5IGhp\nbnQga2V5cyBhbmQgaGFuZGxlcyB0aGVpciB2YWx1ZXMgb24gYmVoYWxmIG9m\nIGEgb3duaW5nCiAqIHtAbGluayBRdWVyeUltcGx9LiBVc2VzIHNwZWNpZmlj\nIGtub3dsZWRnZSBvZiBoaW50IGtleXMgZGVjbGFyZWQgaW4KICogZGlmZmVy\nZW50IHBhcnRzIG9mIHRoZSBzeXN0ZW0uCiAqIAogKiBUaGlzIHJlY2VpdmVy\nIGNvbGxlY3RzIGhpbnQga2V5cyBmcm9tIGRpZmZlcmVudCBwYXJ0cyBvZiB0\naGUgc3lzdGVtLiBUaGUKICoga2V5cyBhcmUgaW1wbGljaXRseSBvciBleHBs\naWNpdGx5IGRlY2xhcmVkIGJ5IHNldmVyYWwgZGlmZmVyZW50IG1lY2hhbmlj\ncy4KICogVGhpcyByZWNlaXZlciBzZXRzIHRoZSB2YWx1ZXMgb24gYmVoYWxm\nIG9mIGEgb3duaW5nIHtAbGluayBRdWVyeUltcGx9CiAqIGJhc2VkIG9uIHRo\nZSBpdHMgc3BlY2lmaWMga25vd2xlZGdlIG9mIHRoZXNlIGtleXMuCiAqIAog\nKiBUaGUgaGludCBrZXlzIGZyb20gZm9sbG93aW5nIHNvdXJjZXMgYXJlIGNv\nbGxlY3RlZCBhbmQgaGFuZGxlZDogCiAqIAogKiAxLiB7QGxpbmsgb3JnLmFw\nYWNoZS5vcGVuanBhLmtlcm5lbC5RdWVyeUhpbnRzfSBpbnRlcmZhY2UgZGVj\nbGFyZXMgaGludCBrZXlzCiAqICAgIGFzIHB1YmxpYyBzdGF0aWMgZmluYWwg\nZmllbGRzLiBUaGVzZSBmaWVsZHMgYXJlIGNvbGxlY3RlZCBieSByZWZsZWN0\naW9uLgogKiAgICBUaGUgdmFsdWVzIGFyZSBoYW5kbGVkIGJ5IGludm9raW5n\nIG1ldGhvZHMgb24gdGhlIG93bmluZyB7QGxpbmsgUXVlcnlJbXBsfQogKiAg\nICAKICogMi4gU29tZSBoaW50IGtleXMgYXJlIGNvbGxlY3RlZCBmcm9tIGJl\nYW4tc3R5bGUgcHJvcGVydHkgbmFtZXMgb2Yge0BsaW5rIAogKiAgICBKREJD\nRmV0Y2hQbGFufSBieSB7QGxpbmsgUmVmbGVjdGlvbiNnZXRCZWFuU3R5bGVQ\ncm9wZXJ0eU5hbWVzKENsYXNzKSAKICogICAgcmVmbGVjdGlvbn0gYW5kIHBy\nZWZpeGVkIHdpdGggPGNvZGU+b3BlbmpwYS5GZXRjaFBsYW48L2NvZGU+LiAK\nICogICAgVGhlaXIgdmFsdWVzIGFyZSB1c2VkIHRvIHNldCB0aGUgY29ycmVz\ncG9uZGluZyBwcm9wZXJ0eSBvZiB7QGxpbmsgCiAqICAgIEZldGNoUGxhbn0g\ndmlhIHtAbGluayAjaGludFRvU2V0dGVyKEZldGNoUGxhbiwgU3RyaW5nLCBP\nYmplY3QpIHJlZmxlY3Rpb259CiAqICAgICAgCiAqIDMuIEN1cnJlbnRseSBk\nZWZpbmVkIDxjb2RlPmphdmF4LnBlcnNpc3RlbmNlLio8L2NvZGU+IGhpbnQg\na2V5cyBoYXZlICAKICogICAgYSBlcXVpdmFsZW50IGNvdW50ZXJwYXJ0IHRv\nIG9uZSBvZiB0aGVzZSBGZXRjaFBsYW4ga2V5cy4gCiAqICAgIFRoZSBKUEEg\na2V5cyBhcmUgbWFwcGVkIHRvIGVxdWl2YWxlbnQgRmV0Y2hQbGFuIGhpbnQg\na2V5cy4KICogICAgCiAqIDQuIFNvbWUga2V5cyBkaXJlY3RseSBpbnZva2Ug\nc2V0dGVycyBvciBhZGQgbGlzdGVuZXJzIHRvIHRoZSBvd25pbmcgCiAqICAg\nIHtAbGluayBRdWVyeUltcGx9LiBUaGVzZSBoaW50IGtleXMgYXJlIHN0YXRp\nY2FsbHkgZGVjbGFyZWQgaW4gCiAqICAgIHRoaXMgcmVjZWl2ZXIgaXRzZWxm\nLiAKICogICAgCiAqIDUuIFByb2R1Y3REZXJpdmF0aW9uIG1heSBpbnRyb2R1\nY2UgdGhlaXIgb3duIHF1ZXJ5IGhpbnQga2V5cyB2aWEge0BsaW5rIAogKiAg\nICBQcm9kdWN0RGVyaXZhdGlvbiNnZXRTdXBwb3J0ZWRRdWVyeUhpbnRzKCl9\nLiBUaGVpciB2YWx1ZXMgYXJlIHNldCBpbiB0aGUgCiAqICAgIHtAbGluayBG\nZXRjaENvbmZpZ3VyYXRpb24jc2V0SGludChTdHJpbmcsIE9iamVjdCl9CiAq\nICAgICAKICogIEEgaGludCBrZXkgaXMgY2xhc3NpZmllZCBpbnRvIG9uZSBv\nZiB0aGUgZm9sbG93aW5nIHRocmVlIGNhdGVnb3JpZXM6CiAqICAKICogIDEu\nIFN1cHBvcnRlZDogQSBrZXkgaXMga25vd24gdG8gdGhpcyByZWNlaXZlciBh\ncyBjb2xsZWN0ZWQgZnJvbSBkaWZmZXJlbnQgCiAqICAgICBwYXJ0cyBvZiB0\naGUgc3lzdGVtLiBUaGUgdmFsdWUgb2YgYSBzdXBwb3J0ZWQga2V5IGlzIHJl\nY29yZGVkIGFuZCAKICogICAgIGF2YWlsYWJsZSB2aWEge0BsaW5rICNnZXRI\naW50cygpfSBtZXRob2QuIAogKiAgMi4gUmVjb2duaXplZDogQSBrZXkgaXMg\nbm90IGtub3duIHRvIHRoaXMgcmVjZWl2ZXIgYnV0IGhhcyBhIHByZWZpeCB3\naGljaAogKiAgICAgaXMga25vd24gdG8gdGhpcyByZWNlaXZlci4gVGhlIHZh\nbHVlIG9mIGEgcmVjb2duaXplZCBrZXkgaXMgbm90IHJlY29yZGVkIAogKiAg\nICAgYnV0IGl0cyB2YWx1ZSBpcyBhdmFpbGFibGUgdmlhIHtAbGluayBGZXRj\naENvbmZpZ3VyYXRpb24jZ2V0SGludChTdHJpbmcpfQogKiAgMy4gVW5yZWNv\nZ25pemVkOiBBIGtleSBpcyBuZWl0aGVyIHN1cHBvcnRlZCBub3IgcmVjb2du\naXplZC4gVGhlIHZhbHVlIG9mIGEgCiAqICAgICB1bnJlY29nbml6ZWQga2V5\nIGlzIG5laXRoZXIgcmVjb3JkZWQgbm9yIHNldCBhbnl3aGVyZS4KICogIAog\nKiAgSWYgYW4gaW5jb21wYXRpYmxlIHZhbHVlIGlzIHN1cHBsaWVkIGZvciBh\nIHN1cHBvcnRlZCBrZXksIGEgbm9uLWZhdGFsCiAqICB7QGxpbmsgQXJndW1l\nbnRFeGNlcHRpb259IGlzIHJhaXNlZC4KICogIAogKiBAYXV0aG9yIFBpbmFr\naSBQb2RkYXIKICoKICogQHNpbmNlIDIuMC4wCiAqIAogKiBAbm9qYXZhZG9j\nCiAqLwpwdWJsaWMgY2xhc3MgSGludEhhbmRsZXIgIHsKICBwcm90ZWN0ZWQg\nZmluYWwgUXVlcnlJbXBsPD8+IG93bmVyOwoKICAgIHByaXZhdGUgc3RhdGlj\nIGZpbmFsIExvY2FsaXplciBfbG9jID0gTG9jYWxpemVyLmZvclBhY2thZ2Uo\nSGludEhhbmRsZXIuY2xhc3MpOwogICAgcHJvdGVjdGVkIHN0YXRpYyBTZXQ8\nU3RyaW5nPiBfc3VwcG9ydGVkSGludHMgPSBQcm9kdWN0RGVyaXZhdGlvbnMu\nZ2V0U3VwcG9ydGVkUXVlcnlIaW50cygpOwoKICAgIHByb3RlY3RlZCBzdGF0\naWMgZmluYWwgU3RyaW5nIFBSRUZJWF9PUEVOSlBBID0gIm9wZW5qcGEuIjsK\nICAgIHByb3RlY3RlZCBzdGF0aWMgZmluYWwgU3RyaW5nIFBSRUZJWF9KREJD\nID0gUFJFRklYX09QRU5KUEEgKyAiamRiYy4iOwogICAgcHJvdGVjdGVkIHN0\nYXRpYyBmaW5hbCBTdHJpbmcgUFJFRklYX0ZFVENIUExBTiA9IFBSRUZJWF9P\nUEVOSlBBICsgIkZldGNoUGxhbi4iOwogICAgcHJpdmF0ZSBNYXA8U3RyaW5n\nLCBPYmplY3Q+IF9oaW50czsKCiAgICAKICAgIEhpbnRIYW5kbGVyKFF1ZXJ5\nSW1wbDw/PiBpbXBsKSB7CiAgICAgICAgc3VwZXIoKTsKICAgICAgICBvd25l\nciA9IGltcGw7CiAgICB9CiAgICAKICAgIC8qKgogICAgICogUmVjb3JkIGEg\na2V5LXZhbHVlIHBhaXIgb25seSBvbmx5IGlmIHRoZSBnaXZlbiBrZXkgaXMg\nc3VwcG9ydGVkLgogICAgICogCiAgICAgKiBAcmV0dXJuIEZBTFNFIGlmIHRo\nZSBrZXkgaXMgdW5yZWNvZ25pemVkLiAKICAgICAqICAgICAgICAgbnVsbCAo\naS5lLiBNQVkgQkUpIGlmIHRoZSBrZXkgaXMgcmVjb2duaXplZCwgYnV0IG5v\ndCBzdXBwb3J0ZWQuCiAgICAgKiAgICAgICAgIFRSVUUgaWYgdGhlIGtleSBp\ncyBzdXBwb3J0ZWQuCiAgICAgKi8KICAgIHByb3RlY3RlZCBCb29sZWFuIHJl\nY29yZChTdHJpbmcgaGludCwgT2JqZWN0IHZhbHVlKSB7CiAgICAgICAgaWYg\nKGhpbnQgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIEJvb2xlYW4uRkFM\nU0U7CiAgICAgICAgaWYgKF9zdXBwb3J0ZWRIaW50cy5jb250YWlucyhoaW50\nKSkgewogICAgICAgICAgICBpZiAoX2hpbnRzID09IG51bGwpCiAgICAgICAg\nICAgICAgICBfaGludHMgPSBuZXcgVHJlZU1hcDxTdHJpbmcsIE9iamVjdD4o\nKTsKICAgICAgICAgICAgX2hpbnRzLnB1dChoaW50LCB2YWx1ZSk7CiAgICAg\nICAgICAgIHJldHVybiBCb29sZWFuLlRSVUU7CiAgICAgICAgfQogICAgICAg\nIGlmIChpc0tub3duUHJlZml4KGhpbnQpKSB7CiAgICAgICAgICAgIExvZyBs\nb2cgPSBvd25lci5nZXREZWxlZ2F0ZSgpLmdldEJyb2tlcigpLmdldENvbmZp\nZ3VyYXRpb24oKS5nZXRMb2coT3BlbkpQQUNvbmZpZ3VyYXRpb24uTE9HX1JV\nTlRJTUUpOwogICAgICAgICAgICBTdHJpbmcgcG9zc2libGUgPSBTdHJpbmdE\naXN0YW5jZS5nZXRDbG9zZXN0TGV2ZW5zaHRlaW5EaXN0YW5jZShoaW50LCBn\nZXRTdXBwb3J0ZWRIaW50cygpKTsKICAgICAgICAgICAgaWYgKGxvZy5pc1dh\ncm5FbmFibGVkKCkpCiAgICAgICAgICAgICAgICBsb2cud2FybihfbG9jLmdl\ndCgiYmFkLXF1ZXJ5LWhpbnQiLCBoaW50LCBwb3NzaWJsZSkpOwogICAgICAg\nICAgICByZXR1cm4gbnVsbDsgLy8gcG9zc2libGUgYnV0IG5vdCByZWdpc3Rl\ncmVkCiAgICAgICAgfQogICAgICAgIHJldHVybiBCb29sZWFuLkZBTFNFOyAv\nLyBub3QgcG9zc2libGUKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRIaW50\nKFN0cmluZyBrZXksIE9iamVjdCB2YWx1ZSkgewogICAgICAgIEJvb2xlYW4g\nc3RhdHVzID0gcmVjb3JkKGtleSwgdmFsdWUpOwogICAgICAgIGlmIChCb29s\nZWFuLkZBTFNFLmVxdWFscyhzdGF0dXMpKQogICAgICAgICAgICByZXR1cm47\nCiAgICAgICAgRmV0Y2hQbGFuIHBsYW4gPSBvd25lci5nZXRGZXRjaFBsYW4o\nKTsKICAgICAgICBpZiAoc3RhdHVzID09IG51bGwpIHsKICAgICAgICAgICAg\ncGxhbi5zZXRIaW50KGtleSwgdmFsdWUpOwogICAgICAgICAgICByZXR1cm47\nCiAgICAgICAgfQogICAgICAgIAogICAgICAgIENsYXNzTG9hZGVyIGxvYWRl\nciA9IG93bmVyLmdldERlbGVnYXRlKCkuZ2V0QnJva2VyKCkuZ2V0Q2xhc3NM\nb2FkZXIoKTsKICAgICAgICBpZiAoUXVlcnlIaW50cy5ISU5UX1NVQkNMQVNT\nRVMuZXF1YWxzKGtleSkpIHsKICAgICAgICAgICAgaWYgKHZhbHVlIGluc3Rh\nbmNlb2YgU3RyaW5nKQogICAgICAgICAgICAgICAgdmFsdWUgPSBCb29sZWFu\nLnZhbHVlT2YoKFN0cmluZykgdmFsdWUpOwogICAgICAgICAgICBvd25lci5z\nZXRTdWJjbGFzc2VzKCgoQm9vbGVhbikgdmFsdWUpLmJvb2xlYW5WYWx1ZSgp\nKTsKICAgICAgICB9IGVsc2UgaWYgKFF1ZXJ5SGludHMuSElOVF9GSUxURVJf\nTElTVEVORVIuZXF1YWxzKGtleSkpIHsKICAgICAgICAgICAgb3duZXIuYWRk\nRmlsdGVyTGlzdGVuZXIoRmlsdGVycy5oaW50VG9GaWx0ZXJMaXN0ZW5lcih2\nYWx1ZSwgbG9hZGVyKSk7CiAgICAgICAgfSBlbHNlIGlmIChRdWVyeUhpbnRz\nLkhJTlRfRklMVEVSX0xJU1RFTkVSUy5lcXVhbHMoa2V5KSkgewogICAgICAg\nICAgICBGaWx0ZXJMaXN0ZW5lcltdIGFyciA9IEZpbHRlcnMuaGludFRvRmls\ndGVyTGlzdGVuZXJzKHZhbHVlLCBsb2FkZXIpOwogICAgICAgICAgICBmb3Ig\nKGludCBpID0gMDsgaSA8IGFyci5sZW5ndGg7IGkrKykKICAgICAgICAgICAg\nICAgIG93bmVyLmFkZEZpbHRlckxpc3RlbmVyKGFycltpXSk7CiAgICAgICAg\nfSBlbHNlIGlmIChRdWVyeUhpbnRzLkhJTlRfQUdHUkVHQVRFX0xJU1RFTkVS\nLmVxdWFscyhrZXkpKSB7CiAgICAgICAgICAgIG93bmVyLmFkZEFnZ3JlZ2F0\nZUxpc3RlbmVyKEZpbHRlcnMuaGludFRvQWdncmVnYXRlTGlzdGVuZXIodmFs\ndWUsIGxvYWRlcikpOwogICAgICAgIH0gZWxzZSBpZiAoUXVlcnlIaW50cy5I\nSU5UX0FHR1JFR0FURV9MSVNURU5FUlMuZXF1YWxzKGtleSkpIHsKICAgICAg\nICAgICAgQWdncmVnYXRlTGlzdGVuZXJbXSBhcnIgPSBGaWx0ZXJzLmhpbnRU\nb0FnZ3JlZ2F0ZUxpc3RlbmVycyh2YWx1ZSwgbG9hZGVyKTsKICAgICAgICAg\nICAgZm9yIChpbnQgaSA9IDA7IGkgPCBhcnIubGVuZ3RoOyBpKyspIHsKICAg\nICAgICAgICAgICAgIG93bmVyLmFkZEFnZ3JlZ2F0ZUxpc3RlbmVyKGFycltp\nXSk7CiAgICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgaWYgKFF1ZXJ5SGlu\ndHMuSElOVF9SRVNVTFRfQ09VTlQuZXF1YWxzKGtleSkpIHsKICAgICAgICAg\nICAgaW50IHYgPSAoSW50ZWdlcikgRmlsdGVycy5jb252ZXJ0KHZhbHVlLCBJ\nbnRlZ2VyLmNsYXNzKTsKICAgICAgICAgICAgaWYgKHYgPCAwKSB7CiAgICAg\nICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9u\nKF9sb2MuZ2V0KCJiYWQtcXVlcnktaGludC12YWx1ZSIsIGtleSwgdmFsdWUp\nLnRvU3RyaW5nKCkpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHBsYW4u\nc2V0SGludChrZXksIHYpOwogICAgICAgIH0gZWxzZSBpZiAoUXVlcnlIaW50\ncy5ISU5UX0lOVkFMSURBVEVfUFJFUEFSRURfUVVFUlkuZXF1YWxzKGtleSkp\nIHsKICAgICAgICAgICAgcGxhbi5zZXRIaW50KGtleSwgRmlsdGVycy5jb252\nZXJ0KHZhbHVlLCBCb29sZWFuLmNsYXNzKSk7CiAgICAgICAgICAgIG93bmVy\nLmludmFsaWRhdGVQcmVwYXJlZFF1ZXJ5KCk7CiAgICAgICAgfSBlbHNlIGlm\nIChRdWVyeUhpbnRzLkhJTlRfSUdOT1JFX1BSRVBBUkVEX1FVRVJZLmVxdWFs\ncyhrZXkpKSB7CiAgICAgICAgICAgIHBsYW4uc2V0SGludChrZXksIEZpbHRl\ncnMuY29udmVydCh2YWx1ZSwgQm9vbGVhbi5jbGFzcykpOwogICAgICAgICAg\nICBvd25lci5pZ25vcmVQcmVwYXJlZFF1ZXJ5KCk7CiAgICAgICAgfSBlbHNl\nIHsgLy8gZGVmYXVsdCAKICAgICAgICAgICAgcGxhbi5zZXRIaW50KGtleSwg\ndmFsdWUpOwogICAgICAgIH0KICAgIH0KICAgIAogICAgLyoqCiAgICAgKiBB\nZmZpcm1zIGlmIHRoZSBnaXZlbiBrZXkgc3RhcnRzIHdpdGggYW55IG9mIHRo\nZSBrbm93biBwcmVmaXguCiAgICAgKiBAcGFyYW0ga2V5CiAgICAgKiBAcmV0\ndXJuCiAgICAgKi8KICAgIHByb3RlY3RlZCBib29sZWFuIGlzS25vd25QcmVm\naXgoU3RyaW5nIGtleSkgewogICAgICAgIGlmIChrZXkgPT0gbnVsbCkKICAg\nICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIGZvciAoU3RyaW5nIHBy\nZWZpeCA6IFByb2R1Y3REZXJpdmF0aW9ucy5nZXRDb25maWd1cmF0aW9uUHJl\nZml4ZXMoKSkgewogICAgICAgICAgICBpZiAoa2V5LnN0YXJ0c1dpdGgocHJl\nZml4KSkKICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0K\nICAgICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgCiAgICAKLy8gICAg\ncHJvdGVjdGVkIGJvb2xlYW4gaGFzUHJlY2VkZW50KFN0cmluZyBrZXkpIHsK\nLy8gICAgICAgIGJvb2xlYW4gaGFzUHJlY2VkZW50ID0gdHJ1ZTsKLy8gICAg\nICAgIFN0cmluZ1tdIGxpc3QgPSBwcmVjZWRlbmNlTWFwLmdldChrZXkpOwov\nLyAgICAgICAgaWYgKGxpc3QgIT0gbnVsbCkgewovLyAgICAgICAgICAgIGZv\nciAoU3RyaW5nIGhpbnQgOiBsaXN0KSB7Ci8vICAgICAgICAgICAgICAgIGlm\nIChoaW50LmVxdWFscyhrZXkpKQovLyAgICAgICAgICAgICAgICAgICAgYnJl\nYWs7Ci8vICAgICAgICAgICAgICAgIC8vIHN0b3AgaWYgYSBoaWdoZXIgcHJl\nY2VkZW5jZSBoaW50IGhhcyBhbHJlYWR5IGRlZmluZWQgCi8vICAgICAgICAg\nICAgICAgIGlmIChnZXRIaW50cygpLmNvbnRhaW5zS2V5KGhpbnQpKSB7Ci8v\nICAgICAgICAgICAgICAgICAgICBoYXNQcmVjZWRlbnQgPSBmYWxzZTsKLy8g\nICAgICAgICAgICAgICAgICAgIGJyZWFrOwovLyAgICAgICAgICAgICAgICB9\nCi8vICAgICAgICAgICAgfQovLyAgICAgICAgfQovLyAgICAgICAgcmV0dXJu\nIGhhc1ByZWNlZGVudDsKLy8gICAgfQoKLy8gICAgcHJpdmF0ZSBJbnRlZ2Vy\nIHRvTG9ja0xldmVsKE9iamVjdCB2YWx1ZSkgewovLyAgICAgICAgT2JqZWN0\nIG9yaWdWYWx1ZSA9IHZhbHVlOwovLyAgICAgICAgaWYgKHZhbHVlIGluc3Rh\nbmNlb2YgU3RyaW5nKSB7Ci8vICAgICAgICAgICAgLy8gdG8gYWNjb21tb2Rh\ndGUgYWxpYXMgbmFtZSBpbnB1dCBpbiByZWxhdGlvbnNoaXAgd2l0aCBlbnVt\nIHZhbHVlcwovLyAgICAgICAgICAgIC8vICBlLmcuICJvcHRpbWlzdGljLWZv\ncmNlLWluY3JlbWVudCIgPT0gTG9ja01vZGVUeXBlLk9QVElNSVNUSUNfRk9S\nQ0VfSU5DUkVNRU5UCi8vICAgICAgICAgICAgU3RyaW5nIHN0clZhbHVlID0g\nKChTdHJpbmcpIHZhbHVlKS50b1VwcGVyQ2FzZSgpLnJlcGxhY2UoJy0nLCAn\nXycpOwovLyAgICAgICAgICAgIHZhbHVlID0gRW51bS52YWx1ZU9mKExvY2tN\nb2RlVHlwZS5jbGFzcywgc3RyVmFsdWUpOwovLyAgICAgICAgfQovLyAgICAg\nICAgaWYgKHZhbHVlIGluc3RhbmNlb2YgTG9ja01vZGVUeXBlKQovLyAgICAg\nICAgICAgIHZhbHVlID0gTWl4ZWRMb2NrTGV2ZWxzSGVscGVyLnRvTG9ja0xl\ndmVsKChMb2NrTW9kZVR5cGUpIHZhbHVlKTsKLy8KLy8gICAgICAgIEludGVn\nZXIgaW50VmFsdWUgPSBudWxsOwovLyAgICAgICAgaWYgKHZhbHVlIGluc3Rh\nbmNlb2YgSW50ZWdlcikKLy8gICAgICAgICAgICBpbnRWYWx1ZSA9IChJbnRl\nZ2VyKSB2YWx1ZTsKLy8gICAgICAgIGlmIChpbnRWYWx1ZSA9PSBudWxsCi8v\nICAgICAgICAgICAgfHwgKGludFZhbHVlICE9IE1peGVkTG9ja0xldmVscy5M\nT0NLX05PTkUKLy8gICAgICAgICAgICAgICAgJiYgaW50VmFsdWUgIT0gTWl4\nZWRMb2NrTGV2ZWxzLkxPQ0tfUkVBRAovLyAgICAgICAgICAgICAgICAmJiBp\nbnRWYWx1ZSAhPSBNaXhlZExvY2tMZXZlbHMuTE9DS19PUFRJTUlTVElDCi8v\nICAgICAgICAgICAgICAgICYmIGludFZhbHVlICE9IE1peGVkTG9ja0xldmVs\ncy5MT0NLX1dSSVRFCi8vICAgICAgICAgICAgICAgICYmIGludFZhbHVlICE9\nIE1peGVkTG9ja0xldmVscy5MT0NLX09QVElNSVNUSUNfRk9SQ0VfSU5DUkVN\nRU5UCi8vICAgICAgICAgICAgICAgICYmIGludFZhbHVlICE9IE1peGVkTG9j\na0xldmVscy5MT0NLX1BFU1NJTUlTVElDX1JFQUQKLy8gICAgICAgICAgICAg\nICAgJiYgaW50VmFsdWUgIT0gTWl4ZWRMb2NrTGV2ZWxzLkxPQ0tfUEVTU0lN\nSVNUSUNfV1JJVEUKLy8gICAgICAgICAgICAgICAgJiYgaW50VmFsdWUgIT0g\nTWl4ZWRMb2NrTGV2ZWxzLkxPQ0tfUEVTU0lNSVNUSUNfRk9SQ0VfSU5DUkVN\nRU5UKQovLyAgICAgICAgICAgICAgICApCi8vICAgICAgICAgICAgdGhyb3cg\nbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbihfbG9jLmdldCgiYmFkLWxv\nY2stbGV2ZWwiLCBvcmlnVmFsdWUpLmdldE1lc3NhZ2UoKSk7Ci8vICAgICAg\nICByZXR1cm4gaW50VmFsdWU7Ci8vICAgIH0KICAgIAogICAgLyoqCiAgICAg\nKiBHZXRzIGFsbCB0aGUgc3VwcG9ydGVkIGhpbnQga2V5cy4gVGhlIHNldCBv\nZiBzdXBwb3J0ZWQgaGludCBrZXlzIGlzCiAgICAgKiBzdGF0aWNhbGx5IGRl\ndGVybWluZWQgYnkgY29sbGVjdGluZyBoaW50IGtleXMgZnJvbSB0aGUgUHJv\nZHVjdERlcml2YXRpb25zLgogICAgICovCiAgICBwdWJsaWMgU2V0PFN0cmlu\nZz4gZ2V0U3VwcG9ydGVkSGludHMoKSB7CiAgICAgICAgcmV0dXJuIF9zdXBw\nb3J0ZWRIaW50czsKICAgIH0KICAgIAogICAgLyoqCiAgICAgKiBHZXRzIGFs\nbCB0aGUgcmVjb3JkZWQgaGludCBrZXlzIGFuZCB0aGVpciB2YWx1ZXMuCiAg\nICAgKi8KICAgIHB1YmxpYyBNYXA8U3RyaW5nLCBPYmplY3Q+IGdldEhpbnRz\nKCkgewogICAgICAgIGlmIChfaGludHMgPT0gbnVsbCkKICAgICAgICAgICAg\ncmV0dXJuIENvbGxlY3Rpb25zLmVtcHR5TWFwKCk7CiAgICAgICAgcmV0dXJu\nIENvbGxlY3Rpb25zLnVubW9kaWZpYWJsZU1hcChfaGludHMpOwogICAgfQoK\nfQoK\n","encoding":"base64"}

