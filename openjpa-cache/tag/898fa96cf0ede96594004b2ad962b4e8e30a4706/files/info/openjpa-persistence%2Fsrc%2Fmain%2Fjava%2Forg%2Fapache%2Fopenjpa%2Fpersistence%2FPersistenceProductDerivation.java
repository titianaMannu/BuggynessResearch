{"sha":"3c37a2caa1735002547399b70be03979e2286911","node_id":"MDQ6QmxvYjIwNjM2NDozYzM3YTJjYWExNzM1MDAyNTQ3Mzk5YjcwYmUwMzk3OWUyMjg2OTEx","size":37978,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/3c37a2caa1735002547399b70be03979e2286911","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2U7CgppbXBv\ncnQgamF2YS5pby5GaWxlOwppbXBvcnQgamF2YS5pby5JT0V4Y2VwdGlvbjsK\naW1wb3J0IGphdmEubWF0aC5CaWdEZWNpbWFsOwppbXBvcnQgamF2YS5uZXQu\nTWFsZm9ybWVkVVJMRXhjZXB0aW9uOwppbXBvcnQgamF2YS5uZXQuVVJMOwpp\nbXBvcnQgamF2YS5zZWN1cml0eS5BY2Nlc3NDb250cm9sbGVyOwppbXBvcnQg\namF2YS5zZWN1cml0eS5Qcml2aWxlZ2VkQWN0aW9uRXhjZXB0aW9uOwppbXBv\ncnQgamF2YS51dGlsLkFycmF5TGlzdDsKaW1wb3J0IGphdmEudXRpbC5Db2xs\nZWN0aW9uczsKaW1wb3J0IGphdmEudXRpbC5FbnVtZXJhdGlvbjsKaW1wb3J0\nIGphdmEudXRpbC5IYXNoTWFwOwppbXBvcnQgamF2YS51dGlsLkhhc2hTZXQ7\nCmltcG9ydCBqYXZhLnV0aWwuTGlua2VkSGFzaFNldDsKaW1wb3J0IGphdmEu\ndXRpbC5MaXN0OwppbXBvcnQgamF2YS51dGlsLk1hcDsKaW1wb3J0IGphdmEu\ndXRpbC5NaXNzaW5nUmVzb3VyY2VFeGNlcHRpb247CmltcG9ydCBqYXZhLnV0\naWwuU2V0OwoKaW1wb3J0IGphdmF4LnBlcnNpc3RlbmNlLlNoYXJlZENhY2hl\nTW9kZTsKaW1wb3J0IGphdmF4LnBlcnNpc3RlbmNlLlZhbGlkYXRpb25Nb2Rl\nOwppbXBvcnQgamF2YXgucGVyc2lzdGVuY2Uuc3BpLlBlcnNpc3RlbmNlVW5p\ndEluZm87CmltcG9ydCBqYXZheC5wZXJzaXN0ZW5jZS5zcGkuUGVyc2lzdGVu\nY2VVbml0VHJhbnNhY3Rpb25UeXBlOwoKaW1wb3J0IG9yZy5hcGFjaGUuY29t\nbW9ucy5sYW5nLlN0cmluZ1V0aWxzOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLmNvbmYuQ29tcGF0aWJpbGl0eTsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5jb25mLk9wZW5KUEFDb25maWd1cmF0aW9uOwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLmNvbmYuT3BlbkpQQUNvbmZpZ3VyYXRpb25JbXBsOwpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmNvbmYuT3BlbkpQQVByb2R1Y3RE\nZXJpdmF0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmNvbmYuU3Bl\nY2lmaWNhdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5kYXRhY2Fj\naGUuRGF0YUNhY2hlTW9kZTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5r\nZXJuZWwuTWl4ZWRMb2NrTGV2ZWxzOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLmtlcm5lbC5RdWVyeUhpbnRzOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLmxpYi5jb25mLkFic3RyYWN0UHJvZHVjdERlcml2YXRpb247CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLmNvbmYuQ29uZmlndXJhdGlvbjsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIuY29uZi5Db25maWd1cmF0\naW9uUHJvdmlkZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLmNv\nbmYuQ29uZmlndXJhdGlvbnM7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\nbGliLmNvbmYuTWFwQ29uZmlndXJhdGlvblByb3ZpZGVyOwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLmxpYi5jb25mLlByb2R1Y3REZXJpdmF0aW9uczsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIubG9nLkxvZzsKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5saWIubWV0YS5YTUxNZXRhRGF0YVBhcnNl\ncjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIubWV0YS5YTUxWZXJz\naW9uUGFyc2VyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51dGls\nLkoyRG9Qcml2SGVscGVyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxp\nYi51dGlsLkxvY2FsaXplcjsKaW1wb3J0IG9yZy54bWwuc2F4LkF0dHJpYnV0\nZXM7CmltcG9ydCBvcmcueG1sLnNheC5TQVhFeGNlcHRpb247CgoKLyoqCiAq\nIFNldHMgSlBBIHNwZWNpZmljYXRpb24gZGVmYXVsdHMgYW5kIHBhcnNlcyBK\nUEEgc3BlY2lmaWNhdGlvbiBYTUwgZmlsZXMuCiAqIAogKiBGb3IgZ2xvYmFs\ncywgbG9va3MgaW4gPGNvZGU+b3BlbmpwYS5wcm9wZXJ0aWVzPC9jb2RlPiBz\neXN0ZW0gcHJvcGVydHkgZm9yCiAqIHRoZSBsb2NhdGlvbiBvZiBhIGZpbGUg\ndG8gcGFyc2UuIElmIG5vIHN5c3RlbSBwcm9wZXJ0eSBpcyBkZWZpbmVkLCB0\naGUKICogZGVmYXVsdCByZXNvdXJjZSBsb2NhdGlvbiBvZiA8Y29kZT5NRVRB\nLUlORi9vcGVuanBhLnhtbDwvY29kZT4gaXMgdXNlZC4KICoKICogRm9yIGRl\nZmF1bHRzLCBsb29rcyBmb3IgPGNvZGU+TUVUQS1JTkYvcGVyc2lzdGVuY2Uu\neG1sPC9jb2RlPi4KICogV2l0aGluIDxjb2RlPnBlcnNpc3RlbmNlLnhtbDwv\nY29kZT4sIGxvb2sgZm9yIHRoZSBuYW1lZCBwZXJzaXN0ZW5jZSB1bml0LCBv\ncgogKiBpZiBubyBuYW1lIGdpdmVuLCBhbiBPcGVuSlBBIHVuaXQgKHByZWZl\ncnJpbmcgYW4gdW5uYW1lZCBPcGVuSlBBIHVuaXQgdG8gCiAqIGEgbmFtZWQg\nb25lKS4KICoKICogQGF1dGhvciBBYmUgV2hpdGUKICogQG5vamF2YWRvYwog\nKi8KcHVibGljIGNsYXNzIFBlcnNpc3RlbmNlUHJvZHVjdERlcml2YXRpb24g\nCiAgICBleHRlbmRzIEFic3RyYWN0UHJvZHVjdERlcml2YXRpb24KICAgIGlt\ncGxlbWVudHMgT3BlbkpQQVByb2R1Y3REZXJpdmF0aW9uIHsKCiAgICBwdWJs\naWMgc3RhdGljIGZpbmFsIFNwZWNpZmljYXRpb24gU1BFQ19KUEEgPSBuZXcg\nU3BlY2lmaWNhdGlvbigianBhIDIiKTsKICAgIHB1YmxpYyBzdGF0aWMgZmlu\nYWwgU3BlY2lmaWNhdGlvbiBBTElBU19FSkIgPSBuZXcgU3BlY2lmaWNhdGlv\nbigiZWpiIDMiKTsKICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgU3RyaW5nIFJT\nUkNfR0xPQkFMID0gIk1FVEEtSU5GL29wZW5qcGEueG1sIjsKICAgIHB1Ymxp\nYyBzdGF0aWMgZmluYWwgU3RyaW5nIFJTUkNfREVGQVVMVCA9ICJNRVRBLUlO\nRi9wZXJzaXN0ZW5jZS54bWwiOwogICAgcHVibGljIHN0YXRpYyBmaW5hbCBC\naWdEZWNpbWFsIFZFUlNJT05fMV8wID0gQmlnRGVjaW1hbC52YWx1ZU9mKDEu\nMCk7CgogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgTG9jYWxpemVyIF9sb2Mg\nPSBMb2NhbGl6ZXIuZm9yUGFja2FnZQogICAgICAgIChQZXJzaXN0ZW5jZVBy\nb2R1Y3REZXJpdmF0aW9uLmNsYXNzKTsKCiAgICBwcml2YXRlIEhhc2hNYXA8\nU3RyaW5nLCBQVU5hbWVDb2xsaXNpb24+IF9wdU5hbWVDb2xsaXNpb25zCiAg\nICAgICAgPSBuZXcgSGFzaE1hcDxTdHJpbmcsUFVOYW1lQ29sbGlzaW9uPigp\nOwogICAgCiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIFN0cmluZyBQUkVGSVgg\nPSAiamF2YXgucGVyc2lzdGVuY2UiOyAKICAgIAogICAgcHJpdmF0ZSBzdGF0\naWMgU2V0PFN0cmluZz4gX2hpbnRzID0gbmV3IEhhc2hTZXQ8U3RyaW5nPigp\nOwogICAgCiAgICAvLyBQcm92aWRlciBuYW1lIHRvIGZpbHRlciBvdXQgUFVz\nIHRoYXQgZG9uJ3QgYmVsb25nIHRvIHRoaXMgZGVyaXZhdGlvbi4KICAgIHBy\nb3RlY3RlZCBTdHJpbmcgX3Byb3ZpZGVySW1wbE5hbWU7CgogICAgc3RhdGlj\nIHsKICAgICAgICBfaGludHMuYWRkKCJqYXZheC5wZXJzaXN0ZW5jZS5sb2Nr\nLnRpbWVvdXQiKTsKICAgICAgICBfaGludHMuYWRkKCJqYXZheC5wZXJzaXN0\nZW5jZS5xdWVyeS50aW1lb3V0Iik7CiAgICAgICAgCiAgICAgICAgX2hpbnRz\nLmFkZCgib3BlbmpwYS5GZXRjaFBsYW4uRXh0ZW5kZWRQYXRoTG9va3VwIik7\nCiAgICAgICAgX2hpbnRzLmFkZCgib3BlbmpwYS5GZXRjaEJhdGNoU2l6ZSIp\nOyAKICAgICAgICBfaGludHMuYWRkKCJvcGVuanBhLkZldGNoUGxhbi5GZXRj\naEJhdGNoU2l6ZSIpOwogICAgICAgIF9oaW50cy5hZGQoIm9wZW5qcGEuTWF4\nRmV0Y2hEZXB0aCIpOyAKICAgICAgICBfaGludHMuYWRkKCJvcGVuanBhLkZl\ndGNoUGxhbi5NYXhGZXRjaERlcHRoIik7CiAgICAgICAgX2hpbnRzLmFkZCgi\nb3BlbmpwYS5Mb2NrVGltZW91dCIpOwogICAgICAgIF9oaW50cy5hZGQoIm9w\nZW5qcGEuRmV0Y2hQbGFuLkxvY2tUaW1lb3V0Iik7CiAgICAgICAgX2hpbnRz\nLmFkZCgib3BlbmpwYS5RdWVyeVRpbWVvdXQiKTsKICAgICAgICBfaGludHMu\nYWRkKCJvcGVuanBhLkZldGNoUGxhbi5RdWVyeVRpbWVvdXQiKTsKICAgICAg\nICBfaGludHMuYWRkKCJvcGVuanBhLkZsdXNoQmVmb3JlUXVlcmllcyIpOwog\nICAgICAgIF9oaW50cy5hZGQoIm9wZW5qcGEuRmV0Y2hQbGFuLkZsdXNoQmVm\nb3JlUXVlcmllcyIpOwogICAgICAgIF9oaW50cy5hZGQoIm9wZW5qcGEuUmVh\nZExvY2tMZXZlbCIpOwogICAgICAgIF9oaW50cy5hZGQoIm9wZW5qcGEuRmV0\nY2hQbGFuLlJlYWRMb2NrTGV2ZWwiKTsKICAgICAgICBfaGludHMuYWRkKCJv\ncGVuanBhLldyaXRlTG9ja0xldmVsIik7CiAgICAgICAgX2hpbnRzLmFkZCgi\nb3BlbmpwYS5GZXRjaFBsYW4uV3JpdGVMb2NrTGV2ZWwiKTsKICAgICAgICBf\naGludHMuYWRkKCJvcGVuanBhLkZldGNoUGxhbi5GZXRjaEJhdGNoU2l6ZSIp\nOwogICAgICAgIF9oaW50cy5hZGQoIm9wZW5qcGEuRmV0Y2hQbGFuLkxvY2tT\nY29wZSIpOwogICAgICAgIF9oaW50cy5hZGQoIm9wZW5qcGEuRmV0Y2hQbGFu\nLkxvY2tUaW1lb3V0Iik7CiAgICAgICAgX2hpbnRzLmFkZCgib3BlbmpwYS5G\nZXRjaFBsYW4uTWF4RmV0Y2hEZXB0aCIpOwogICAgICAgIF9oaW50cy5hZGQo\nIm9wZW5qcGEuRmV0Y2hQbGFuLlF1ZXJ5VGltZW91dCIpOwogICAgICAgIF9o\naW50cy5hZGQoIm9wZW5qcGEuRmV0Y2hQbGFuLlJlYWRMb2NrTW9kZSIpOwog\nICAgICAgIF9oaW50cy5hZGQoIm9wZW5qcGEuRmV0Y2hQbGFuLldyaXRlTG9j\na01vZGUiKTsKICAgICAgICBfaGludHMuYWRkKFF1ZXJ5SGludHMuSElOVF9B\nR0dSRUdBVEVfTElTVEVORVIpOwogICAgICAgIF9oaW50cy5hZGQoUXVlcnlI\naW50cy5ISU5UX0FHR1JFR0FURV9MSVNURU5FUlMpOwogICAgICAgIF9oaW50\ncy5hZGQoUXVlcnlIaW50cy5ISU5UX0ZJTFRFUl9MSVNURU5FUik7CiAgICAg\nICAgX2hpbnRzLmFkZChRdWVyeUhpbnRzLkhJTlRfRklMVEVSX0xJU1RFTkVS\nUyk7CiAgICAgICAgX2hpbnRzLmFkZChRdWVyeUhpbnRzLkhJTlRfSUdOT1JF\nX0ZJTkRFUik7CiAgICAgICAgX2hpbnRzLmFkZChRdWVyeUhpbnRzLkhJTlRf\nSUdOT1JFX1BSRVBBUkVEX1FVRVJZKTsKICAgICAgICBfaGludHMuYWRkKFF1\nZXJ5SGludHMuSElOVF9JTlZBTElEQVRFX0ZJTkRFUik7CiAgICAgICAgX2hp\nbnRzLmFkZChRdWVyeUhpbnRzLkhJTlRfSU5WQUxJREFURV9QUkVQQVJFRF9R\nVUVSWSk7CiAgICAgICAgX2hpbnRzLmFkZChRdWVyeUhpbnRzLkhJTlRfUEFS\nQU1fTUFSS0VSX0lOX1FVRVJZKTsKICAgICAgICBfaGludHMuYWRkKFF1ZXJ5\nSGludHMuSElOVF9SRUNBQ0hFX0ZJTkRFUik7CiAgICAgICAgX2hpbnRzLmFk\nZChRdWVyeUhpbnRzLkhJTlRfUkVTVUxUX0NPVU5UKTsKICAgICAgICBfaGlu\ndHMuYWRkKFF1ZXJ5SGludHMuSElOVF9TVUJDTEFTU0VTKTsKCiAgICAgICAg\nX2hpbnRzID0gQ29sbGVjdGlvbnMudW5tb2RpZmlhYmxlU2V0KF9oaW50cyk7\nCiAgICB9CiAgICAKCXB1YmxpYyBQZXJzaXN0ZW5jZVByb2R1Y3REZXJpdmF0\naW9uKCkgewoJCV9wcm92aWRlckltcGxOYW1lID0gUGVyc2lzdGVuY2VQcm92\naWRlckltcGwuY2xhc3MuZ2V0TmFtZSgpOwoJfQogICAgCiAgICBwdWJsaWMg\ndm9pZCBwdXRCcm9rZXJGYWN0b3J5QWxpYXNlcyhNYXAgbSkgewogICAgfQoK\nICAgIHB1YmxpYyBpbnQgZ2V0VHlwZSgpIHsKICAgICAgICByZXR1cm4gVFlQ\nRV9TUEVDOwogICAgfQogICAgCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyBT\ndHJpbmcgZ2V0Q29uZmlndXJhdGlvblByZWZpeCgpIHsKICAgICAgICByZXR1\ncm4gUFJFRklYOwogICAgfQogICAgCiAgICBAT3ZlcnJpZGUKICAgIHB1Ymxp\nYyBTZXQ8U3RyaW5nPiBnZXRTdXBwb3J0ZWRRdWVyeUhpbnRzKCkgewogICAg\nICAgIHJldHVybiBfaGludHM7CiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBw\ndWJsaWMgdm9pZCB2YWxpZGF0ZSgpCiAgICAgICAgdGhyb3dzIEV4Y2VwdGlv\nbiB7CiAgICAgICAgLy8gbWFrZSBzdXJlIEpQQSBpcyBhdmFpbGFibGUKICAg\nICAgICBBY2Nlc3NDb250cm9sbGVyLmRvUHJpdmlsZWdlZChKMkRvUHJpdkhl\nbHBlci5nZXRDbGFzc0xvYWRlckFjdGlvbigKICAgICAgICAgICAgamF2YXgu\ncGVyc2lzdGVuY2UuRW50aXR5TWFuYWdlckZhY3RvcnkuY2xhc3MpKTsKICAg\nIH0KICAgIAogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgYm9vbGVhbiBiZWZv\ncmVDb25maWd1cmF0aW9uTG9hZChDb25maWd1cmF0aW9uIGMpIHsKICAgICAg\nICBpZiAoIShjIGluc3RhbmNlb2YgT3BlbkpQQUNvbmZpZ3VyYXRpb25JbXBs\nKSkKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIAogICAgICAg\nIE9wZW5KUEFDb25maWd1cmF0aW9uSW1wbCBjb25mID0gKE9wZW5KUEFDb25m\naWd1cmF0aW9uSW1wbCkgYzsKICAgICAgICBjb25mLm1ldGFGYWN0b3J5UGx1\nZ2luLnNldEFsaWFzKEFMSUFTX0VKQi5nZXROYW1lKCksIFBlcnNpc3RlbmNl\nTWV0YURhdGFGYWN0b3J5LmNsYXNzLmdldE5hbWUoKSk7CiAgICAgICAgY29u\nZi5tZXRhRmFjdG9yeVBsdWdpbi5zZXRBbGlhcyhTUEVDX0pQQS5nZXROYW1l\nKCksICBQZXJzaXN0ZW5jZU1ldGFEYXRhRmFjdG9yeS5jbGFzcy5nZXROYW1l\nKCkpOwogICAgICAgIAogICAgICAgIGNvbmYuYWRkVmFsdWUobmV3IEVudGl0\neU1hbmFnZXJGYWN0b3J5VmFsdWUoKSk7CiAgICAgICAgCiAgICAgICAgY29u\nZi5yZWFkTG9ja0xldmVsLnNldEFsaWFzKCJvcHRpbWlzdGljIiwgU3RyaW5n\nLnZhbHVlT2YoTWl4ZWRMb2NrTGV2ZWxzLkxPQ0tfT1BUSU1JU1RJQykpOwog\nICAgICAgIGNvbmYucmVhZExvY2tMZXZlbC5zZXRBbGlhcygib3B0aW1pc3Rp\nYy1mb3JjZS1pbmNyZW1lbnQiLCBTdHJpbmcKICAgICAgICAgICAgLnZhbHVl\nT2YoTWl4ZWRMb2NrTGV2ZWxzLkxPQ0tfT1BUSU1JU1RJQ19GT1JDRV9JTkNS\nRU1FTlQpKTsKICAgICAgICBjb25mLnJlYWRMb2NrTGV2ZWwuc2V0QWxpYXMo\nInBlc3NpbWlzdGljLXJlYWQiLCBTdHJpbmcKICAgICAgICAgICAgLnZhbHVl\nT2YoTWl4ZWRMb2NrTGV2ZWxzLkxPQ0tfUEVTU0lNSVNUSUNfUkVBRCkpOwog\nICAgICAgIGNvbmYucmVhZExvY2tMZXZlbC5zZXRBbGlhcygicGVzc2ltaXN0\naWMtd3JpdGUiLCBTdHJpbmcKICAgICAgICAgICAgLnZhbHVlT2YoTWl4ZWRM\nb2NrTGV2ZWxzLkxPQ0tfUEVTU0lNSVNUSUNfV1JJVEUpKTsKICAgICAgICBj\nb25mLnJlYWRMb2NrTGV2ZWwuc2V0QWxpYXMoInBlc3NpbWlzdGljLWZvcmNl\nLWluY3JlbWVudCIsIFN0cmluZwogICAgICAgICAgICAudmFsdWVPZihNaXhl\nZExvY2tMZXZlbHMuTE9DS19QRVNTSU1JU1RJQ19GT1JDRV9JTkNSRU1FTlQp\nKTsKCiAgICAgICAgY29uZi53cml0ZUxvY2tMZXZlbC5zZXRBbGlhcygib3B0\naW1pc3RpYyIsIFN0cmluZwogICAgICAgICAgICAudmFsdWVPZihNaXhlZExv\nY2tMZXZlbHMuTE9DS19PUFRJTUlTVElDKSk7CiAgICAgICAgY29uZi53cml0\nZUxvY2tMZXZlbC5zZXRBbGlhcygib3B0aW1pc3RpYy1mb3JjZS1pbmNyZW1l\nbnQiLCBTdHJpbmcKICAgICAgICAgICAgLnZhbHVlT2YoTWl4ZWRMb2NrTGV2\nZWxzLkxPQ0tfT1BUSU1JU1RJQ19GT1JDRV9JTkNSRU1FTlQpKTsKICAgICAg\nICBjb25mLndyaXRlTG9ja0xldmVsLnNldEFsaWFzKCJwZXNzaW1pc3RpYy1y\nZWFkIiwgU3RyaW5nCiAgICAgICAgICAgIC52YWx1ZU9mKE1peGVkTG9ja0xl\ndmVscy5MT0NLX1BFU1NJTUlTVElDX1JFQUQpKTsKICAgICAgICBjb25mLndy\naXRlTG9ja0xldmVsLnNldEFsaWFzKCJwZXNzaW1pc3RpYy13cml0ZSIsIFN0\ncmluZwogICAgICAgICAgICAudmFsdWVPZihNaXhlZExvY2tMZXZlbHMuTE9D\nS19QRVNTSU1JU1RJQ19XUklURSkpOwogICAgICAgIGNvbmYud3JpdGVMb2Nr\nTGV2ZWwuc2V0QWxpYXMoInBlc3NpbWlzdGljLWZvcmNlLWluY3JlbWVudCIs\nIFN0cmluZwogICAgICAgICAgICAudmFsdWVPZihNaXhlZExvY2tMZXZlbHMu\nTE9DS19QRVNTSU1JU1RJQ19GT1JDRV9JTkNSRU1FTlQpKTsKCiAgICAgICAg\nY29uZi5sb2NrTWFuYWdlclBsdWdpbi5zZXRBbGlhcygibWl4ZWQiLCAib3Jn\nLmFwYWNoZS5vcGVuanBhLmpkYmMua2VybmVsLk1peGVkTG9ja01hbmFnZXIi\nKTsKCiAgICAgICAgY29uZmlndXJlQmVhblZhbGlkYXRpb24oY29uZik7CiAg\nICAgICAgCiAgICAgICAgY29uZi5kYXRhQ2FjaGVNb2RlID0gY29uZi5hZGRT\ndHJpbmcoSlBBUHJvcGVydGllcy5DQUNIRV9NT0RFKTsKICAgICAgICBjb25m\nLmRhdGFDYWNoZU1vZGUuc2V0RGVmYXVsdChEYXRhQ2FjaGVNb2RlLlVOU1BF\nQ0lGSUVELnRvU3RyaW5nKCkpOwogICAgICAgIGNvbmYuZGF0YUNhY2hlTW9k\nZS5zZXQoRGF0YUNhY2hlTW9kZS5VTlNQRUNJRklFRC50b1N0cmluZygpKTsK\nCiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CiAgICAKICAgIC8qKgogICAg\nICogQmVhbiBWYWxpZGF0aW9uIGNvbmZpZ3VyYXRpb24gaXMgdW51c3VhbCBi\nZWNhdXNlIGl0cyB1c2FnZSBvZiBlbnVtcyBhbmQga2V5cyB0aGF0CiAgICAg\nKiBkbyBub3QgaGF2ZSBjb3VudGVycGFydHMgaW4ga2VybmVsLgogICAgICog\nSGVuY2UgdGhlIHBsdWdpbnMgYXJlIGRlZmluZWQgaW4gcHJvZHVjdCBkZXJp\ndmF0aW9uIGluc3RlYWQgb2YgdGhlIGtlcm5lbCdzCiAgICAgKiBjb3JlIGNv\nbmZpZ3VyYXRpb24uCiAgICAgKiAKICAgICAqIEBwYXJhbSBjb25mCiAgICAg\nKi8KICAgIHByaXZhdGUgdm9pZCBjb25maWd1cmVCZWFuVmFsaWRhdGlvbihP\ncGVuSlBBQ29uZmlndXJhdGlvbkltcGwgY29uZikgewogICAgICAgIC8vIFZh\nbGlkYXRpb24gZGVmaW5lcy9hZGRzIHRoZSBmb2xsb3dpbmcgcGx1Z2lucyB0\nbyBPcGVuSlBBIENvbmZpZ3VyYXRpb24KICAgICAgICBjb25mLnZhbGlkYXRp\nb25GYWN0b3J5ICAgICAgICAgPSBjb25mLmFkZE9iamVjdChKUEFQcm9wZXJ0\naWVzLlZBTElEQVRFX0ZBQ1RPUlkpOyAKICAgICAgICBjb25mLnZhbGlkYXRv\nciAgICAgICAgICAgICAgICAgPSBjb25mLmFkZE9iamVjdCgiVmFsaWRhdG9y\nIik7CiAgICAgICAgY29uZi52YWxpZGF0aW9uTW9kZSAgICAgICAgICAgID0g\nY29uZi5hZGRTdHJpbmcoSlBBUHJvcGVydGllcy5WQUxJREFURV9NT0RFKTsK\nICAgICAgICBjb25mLnZhbGlkYXRpb25Hcm91cFByZVBlcnNpc3QgPSBjb25m\nLmFkZFN0cmluZyhKUEFQcm9wZXJ0aWVzLlZBTElEQVRFX1BSRV9QRVJTSVNU\nKTsKICAgICAgICBjb25mLnZhbGlkYXRpb25Hcm91cFByZVVwZGF0ZSAgPSBj\nb25mLmFkZFN0cmluZyhKUEFQcm9wZXJ0aWVzLlZBTElEQVRFX1BSRV9VUERB\nVEUpOwogICAgICAgIGNvbmYudmFsaWRhdGlvbkdyb3VwUHJlUmVtb3ZlICA9\nIGNvbmYuYWRkU3RyaW5nKEpQQVByb3BlcnRpZXMuVkFMSURBVEVfUFJFX1JF\nTU9WRSk7CiAgICAgICAgCiAgICAgICAgY29uZi52YWxpZGF0aW9uTW9kZS5z\nZXREeW5hbWljKHRydWUpOwogICAgICAgIFN0cmluZ1tdIGFsaWFzZXMgPSBu\nZXcgU3RyaW5nW10gewogICAgICAgICAgICAgICAgU3RyaW5nLnZhbHVlT2Yo\nVmFsaWRhdGlvbk1vZGUuQVVUTyksCiAgICAgICAgICAgICAgICBTdHJpbmcu\ndmFsdWVPZihWYWxpZGF0aW9uTW9kZS5BVVRPKS50b0xvd2VyQ2FzZSgpLAog\nICAgICAgICAgICAgICAgU3RyaW5nLnZhbHVlT2YoVmFsaWRhdGlvbk1vZGUu\nQ0FMTEJBQ0spLAogICAgICAgICAgICAgICAgU3RyaW5nLnZhbHVlT2YoVmFs\naWRhdGlvbk1vZGUuQ0FMTEJBQ0spLnRvTG93ZXJDYXNlKCksCiAgICAgICAg\nICAgICAgICBTdHJpbmcudmFsdWVPZihWYWxpZGF0aW9uTW9kZS5OT05FKSwK\nICAgICAgICAgICAgICAgIFN0cmluZy52YWx1ZU9mKFZhbGlkYXRpb25Nb2Rl\nLk5PTkUpLnRvTG93ZXJDYXNlKCkKICAgICAgICB9OwogICAgICAgIGNvbmYu\ndmFsaWRhdGlvbk1vZGUuc2V0QWxpYXNlcyhhbGlhc2VzKTsKICAgICAgICBj\nb25mLnZhbGlkYXRpb25Nb2RlLnNldEFsaWFzTGlzdENvbXByZWhlbnNpdmUo\ndHJ1ZSk7CiAgICAgICAgY29uZi52YWxpZGF0aW9uTW9kZS5zZXREZWZhdWx0\nKGFsaWFzZXNbMF0pOwoKICAgICAgICBjb25mLnZhbGlkYXRpb25Hcm91cFBy\nZVBlcnNpc3Quc2V0U3RyaW5nKEpQQVByb3BlcnRpZXMuVkFMSURBVEVfR1JP\nVVBfREVGQVVMVCk7CiAgICAgICAgY29uZi52YWxpZGF0aW9uR3JvdXBQcmVQ\nZXJzaXN0LnNldERlZmF1bHQoIiIpOwogICAgICAgIGNvbmYudmFsaWRhdGlv\nbkdyb3VwUHJlUGVyc2lzdC5zZXREeW5hbWljKHRydWUpOwoKICAgICAgICBj\nb25mLnZhbGlkYXRpb25Hcm91cFByZVVwZGF0ZS5zZXRTdHJpbmcoSlBBUHJv\ncGVydGllcy5WQUxJREFURV9HUk9VUF9ERUZBVUxUKTsKICAgICAgICBjb25m\nLnZhbGlkYXRpb25Hcm91cFByZVVwZGF0ZS5zZXREZWZhdWx0KCIiKTsKICAg\nICAgICBjb25mLnZhbGlkYXRpb25Hcm91cFByZVVwZGF0ZS5zZXREeW5hbWlj\nKHRydWUpOwoKICAgICAgICBjb25mLnZhbGlkYXRpb25Hcm91cFByZVJlbW92\nZS5zZXREZWZhdWx0KCIiKTsKICAgICAgICBjb25mLnZhbGlkYXRpb25Hcm91\ncFByZVJlbW92ZS5zZXREeW5hbWljKHRydWUpOwoKICAgICAgICBjb25mLnZh\nbGlkYXRpb25GYWN0b3J5LnNldEluc3RhbnRpYXRpbmdHZXR0ZXIoImdldFZh\nbGlkYXRpb25GYWN0b3J5SW5zdGFuY2UiKTsKICAgICAgICBjb25mLnZhbGlk\nYXRpb25GYWN0b3J5LnNldER5bmFtaWModHJ1ZSk7CgogICAgICAgIGNvbmYu\ndmFsaWRhdG9yLnNldEluc3RhbnRpYXRpbmdHZXR0ZXIoImdldFZhbGlkYXRv\nckluc3RhbmNlIik7CiAgICAgICAgY29uZi52YWxpZGF0b3Iuc2V0RHluYW1p\nYyh0cnVlKTsKICAgICAgICBjb25mLnZhbGlkYXRvci5tYWtlUHJpdmF0ZSgp\nOwogICAgfQoKICAgIEBPdmVycmlkZQogICAgcHVibGljIGJvb2xlYW4gYWZ0\nZXJTcGVjaWZpY2F0aW9uU2V0KENvbmZpZ3VyYXRpb24gYykgewogICAgICAg\nIGlmICghT3BlbkpQQUNvbmZpZ3VyYXRpb25JbXBsLmNsYXNzLmlzSW5zdGFu\nY2UoYykKICAgICAgICAgJiYgIVNQRUNfSlBBLmlzU2FtZSgoKE9wZW5KUEFD\nb25maWd1cmF0aW9uKSBjKS5nZXRTcGVjaWZpY2F0aW9uKCkpKQogICAgICAg\nICAgICByZXR1cm4gZmFsc2U7CiAKICAgICAgICBPcGVuSlBBQ29uZmlndXJh\ndGlvbkltcGwgY29uZiA9IChPcGVuSlBBQ29uZmlndXJhdGlvbkltcGwpIGM7\nCiAgICAgICAgY29uZi5tZXRhRmFjdG9yeVBsdWdpbi5zZXREZWZhdWx0KFNQ\nRUNfSlBBLmdldE5hbWUoKSk7CiAgICAgICAgY29uZi5tZXRhRmFjdG9yeVBs\ndWdpbi5zZXRTdHJpbmcoU1BFQ19KUEEuZ2V0TmFtZSgpKTsKICAgICAgICBj\nb25mLmxvY2tNYW5hZ2VyUGx1Z2luLnNldERlZmF1bHQoIm1peGVkIik7CiAg\nICAgICAgY29uZi5sb2NrTWFuYWdlclBsdWdpbi5zZXRTdHJpbmcoIm1peGVk\nIik7CiAgICAgICAgY29uZi5ub250cmFuc2FjdGlvbmFsV3JpdGUuc2V0RGVm\nYXVsdCgidHJ1ZSIpOwogICAgICAgIGNvbmYubm9udHJhbnNhY3Rpb25hbFdy\naXRlLnNldCh0cnVlKTsKICAgICAgICBTcGVjaWZpY2F0aW9uIHNwZWMgPSAo\nKE9wZW5KUEFDb25maWd1cmF0aW9uKSBjKS5nZXRTcGVjaWZpY2F0aW9uSW5z\ndGFuY2UoKTsKICAgICAgICBpbnQgc3BlY1ZlcnNpb24gPSBzcGVjLmdldFZl\ncnNpb24oKTsKICAgICAgICBDb21wYXRpYmlsaXR5IGNvbXBhdGliaWxpdHkg\nPSBjb25mLmdldENvbXBhdGliaWxpdHlJbnN0YW5jZSgpOwogICAgICAgIHNw\nZWMuc2V0Q29tcGF0aWJpbGl0eShjb21wYXRpYmlsaXR5KTsKICAgICAgICBp\nZiAoc3BlY1ZlcnNpb24gPCAyKSB7CiAgICAgICAgICAgIGNvbXBhdGliaWxp\ndHkuc2V0Rmx1c2hCZWZvcmVEZXRhY2godHJ1ZSk7CiAgICAgICAgICAgIGNv\nbXBhdGliaWxpdHkuc2V0Q29weU9uRGV0YWNoKHRydWUpOwogICAgICAgICAg\nICBjb21wYXRpYmlsaXR5LnNldFByaXZhdGVQZXJzaXN0ZW50UHJvcGVydGll\ncyh0cnVlKTsKICAgICAgICAgICAgLy8gRGlzYWJsZSBiZWFuIHZhbGlkYXRp\nb24gZm9yIHNwZWMgbGV2ZWwgPCAyIGNvbmZpZ3VyYXRpb25zCiAgICAgICAg\nICAgIGNvbmYudmFsaWRhdGlvbk1vZGUuc2V0KFN0cmluZy52YWx1ZU9mKFZh\nbGlkYXRpb25Nb2RlLk5PTkUpKTsKICAgICAgICB9IGVsc2UgewogICAgICAg\nICAgICBjb21wYXRpYmlsaXR5LnNldEFic3RyYWN0TWFwcGluZ1VuaURpcmVj\ndGlvbmFsKHRydWUpOwogICAgICAgICAgICBjb21wYXRpYmlsaXR5LnNldE5v\nbkRlZmF1bHRNYXBwaW5nQWxsb3dlZCh0cnVlKTsKICAgICAgICB9CiAgICAg\nICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBMb2FkIGNv\nbmZpZ3VyYXRpb24gZnJvbSB0aGUgZ2l2ZW4gcGVyc2lzdGVuY2UgdW5pdCB3\naXRoIHRoZSBzcGVjaWZpZWQKICAgICAqIHVzZXIgcHJvcGVydGllcy4KICAg\nICAqLwogICAgcHVibGljIENvbmZpZ3VyYXRpb25Qcm92aWRlciBsb2FkKFBl\ncnNpc3RlbmNlVW5pdEluZm8gcGluZm8sIE1hcCBtKQogICAgICAgIHRocm93\ncyBJT0V4Y2VwdGlvbiB7CiAgICAgICAgaWYgKHBpbmZvID09IG51bGwpCiAg\nICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgIGlmICghaXNPcGVuSlBB\nUGVyc2lzdGVuY2VQcm92aWRlcihwaW5mbywgbnVsbCkpIHsKICAgICAgICAg\nICAgd2FyblVua25vd25Qcm92aWRlcihwaW5mbyk7CiAgICAgICAgICAgIHJl\ndHVybiBudWxsOwogICAgICAgIH0KCiAgICAgICAgQ29uZmlndXJhdGlvblBy\nb3ZpZGVySW1wbCBjcCA9IG5ldyBDb25maWd1cmF0aW9uUHJvdmlkZXJJbXBs\nKCk7CiAgICAgICAgY3AuYWRkUHJvcGVydGllcyhQZXJzaXN0ZW5jZVVuaXRJ\nbmZvSW1wbC50b09wZW5KUEFQcm9wZXJ0aWVzKHBpbmZvKSk7CiAgICAgICAg\nY3AuYWRkUHJvcGVydGllcyhtKTsKICAgICAgICBpZiAocGluZm8gaW5zdGFu\nY2VvZiBQZXJzaXN0ZW5jZVVuaXRJbmZvSW1wbCkgewogICAgICAgICAgICBQ\nZXJzaXN0ZW5jZVVuaXRJbmZvSW1wbCBpbXBsID0gKFBlcnNpc3RlbmNlVW5p\ndEluZm9JbXBsKSBwaW5mbzsKICAgICAgICAgICAgaWYgKGltcGwuZ2V0UGVy\nc2lzdGVuY2VYbWxGaWxlVXJsKCkgIT0gbnVsbCkKICAgICAgICAgICAgICAg\nIGNwLnNldFNvdXJjZShpbXBsLmdldFBlcnNpc3RlbmNlWG1sRmlsZVVybCgp\nLnRvU3RyaW5nKCkpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gY3A7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBMb2FkIGNvbmZpZ3VyYXRpb24gZnJvbSB0\naGUgZ2l2ZW4gcmVzb3VyY2UgYW5kIHVuaXQgbmFtZXMsIHdoaWNoIG1heQog\nICAgICogYmUgbnVsbC4KICAgICAqLwogICAgcHVibGljIENvbmZpZ3VyYXRp\nb25Qcm92aWRlciBsb2FkKFN0cmluZyByc3JjLCBTdHJpbmcgbmFtZSwgTWFw\nIG0pCiAgICAgICAgdGhyb3dzIElPRXhjZXB0aW9uIHsKICAgICAgICBib29s\nZWFuIGV4cGxpY2l0ID0gIVN0cmluZ1V0aWxzLmlzRW1wdHkocnNyYyk7CiAg\nICAgICAgaWYgKCFleHBsaWNpdCkKICAgICAgICAgICAgcnNyYyA9IFJTUkNf\nREVGQVVMVDsKICAgICAgICAKICAgICAgICBDb25maWd1cmF0aW9uUHJvdmlk\nZXJJbXBsIGNwID0gbmV3IENvbmZpZ3VyYXRpb25Qcm92aWRlckltcGwoKTsK\nICAgICAgICBCb29sZWFuIHJldCA9IGxvYWQoY3AsIHJzcmMsIG5hbWUsIG0s\nIG51bGwsIGV4cGxpY2l0KTsKICAgICAgICBpZiAocmV0ICE9IG51bGwpCiAg\nICAgICAgICAgIHJldHVybiAocmV0LmJvb2xlYW5WYWx1ZSgpKSA/IGNwIDog\nbnVsbDsKICAgICAgICBpZiAoZXhwbGljaXQpCiAgICAgICAgICAgIHJldHVy\nbiBudWxsOwoKICAgICAgICAvLyBwZXJzaXN0ZW5jZS54bWwgZG9lcyBub3Qg\nZXhpc3Q7IGp1c3QgbG9hZCBtYXAKICAgICAgICBQZXJzaXN0ZW5jZVVuaXRJ\nbmZvSW1wbCBwaW5mbyA9IG5ldyBQZXJzaXN0ZW5jZVVuaXRJbmZvSW1wbCgp\nOwogICAgICAgIHBpbmZvLmZyb21Vc2VyUHJvcGVydGllcyhtKTsKICAgICAg\nICBpZiAoIWlzT3BlbkpQQVBlcnNpc3RlbmNlUHJvdmlkZXIocGluZm8sIG51\nbGwpKSB7CiAgICAgICAgICAgIHdhcm5Vbmtub3duUHJvdmlkZXIocGluZm8p\nOwogICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICB9CiAgICAgICAg\nY3AuYWRkUHJvcGVydGllcyhwaW5mby50b09wZW5KUEFQcm9wZXJ0aWVzKCkp\nOwogICAgICAgIHJldHVybiBjcDsKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAg\nIHB1YmxpYyBDb25maWd1cmF0aW9uUHJvdmlkZXIgbG9hZChTdHJpbmcgcnNy\nYywgU3RyaW5nIGFuY2hvciwgCiAgICAgICAgQ2xhc3NMb2FkZXIgbG9hZGVy\nKQogICAgICAgIHRocm93cyBJT0V4Y2VwdGlvbiB7CiAgICAgICAgaWYgKHJz\ncmMgIT0gbnVsbCAmJiAhcnNyYy5lbmRzV2l0aCgiLnhtbCIpKQogICAgICAg\nICAgICByZXR1cm4gbnVsbDsKICAgICAgICBDb25maWd1cmF0aW9uUHJvdmlk\nZXJJbXBsIGNwID0gbmV3IENvbmZpZ3VyYXRpb25Qcm92aWRlckltcGwoKTsK\nICAgICAgICBpZiAobG9hZChjcCwgcnNyYywgYW5jaG9yLCBudWxsLCBsb2Fk\nZXIsIHRydWUpID09IEJvb2xlYW4uVFJVRSkKICAgICAgICAgICAgcmV0dXJu\nIGNwOwogICAgICAgIHJldHVybiBudWxsOwogICAgfQoKICAgIEBPdmVycmlk\nZQogICAgcHVibGljIENvbmZpZ3VyYXRpb25Qcm92aWRlciBsb2FkKEZpbGUg\nZmlsZSwgU3RyaW5nIGFuY2hvcikgCiAgICAgICAgdGhyb3dzIElPRXhjZXB0\naW9uIHsKICAgICAgICBpZiAoIWZpbGUuZ2V0TmFtZSgpLmVuZHNXaXRoKCIu\neG1sIikpCiAgICAgICAgICAgIHJldHVybiBudWxsOwoKICAgICAgICBDb25m\naWd1cmF0aW9uUGFyc2VyIHBhcnNlciA9IG5ldyBDb25maWd1cmF0aW9uUGFy\nc2VyKG51bGwpOwogICAgICAgIHBhcnNlci5wYXJzZShmaWxlKTsKICAgICAg\nICByZXR1cm4gbG9hZChmaW5kVW5pdCgoTGlzdDxQZXJzaXN0ZW5jZVVuaXRJ\nbmZvSW1wbD4pIAogICAgICAgICAgICBwYXJzZXIuZ2V0UmVzdWx0cygpLCBh\nbmNob3IsIG51bGwpLCBudWxsKTsKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAg\nIHB1YmxpYyBTdHJpbmcgZ2V0RGVmYXVsdFJlc291cmNlTG9jYXRpb24oKSB7\nCiAgICAgICAgcmV0dXJuIFJTUkNfREVGQVVMVDsKICAgIH0KCiAgICBAT3Zl\ncnJpZGUKICAgIHB1YmxpYyBMaXN0IGdldEFuY2hvcnNJbkZpbGUoRmlsZSBm\naWxlKSB0aHJvd3MgSU9FeGNlcHRpb24gewogICAgICAgIENvbmZpZ3VyYXRp\nb25QYXJzZXIgcGFyc2VyID0gbmV3IENvbmZpZ3VyYXRpb25QYXJzZXIobnVs\nbCk7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgcGFyc2VyLnBhcnNlKGZp\nbGUpOwogICAgICAgICAgICByZXR1cm4gZ2V0VW5pdE5hbWVzKHBhcnNlcik7\nCiAgICAgICAgfSBjYXRjaCAoSU9FeGNlcHRpb24gZSkgewogICAgICAgICAg\nICAvLyBub3QgYWxsIGNvbmZpZ3VyYXRpb24gZmlsZXMgYXJlIFhNTDsgcmV0\ndXJuIG51bGwgaWYgdW5wYXJzYWJsZQogICAgICAgICAgICByZXR1cm4gbnVs\nbDsKICAgICAgICB9CiAgICB9CgogICAgcHJpdmF0ZSBMaXN0PFN0cmluZz4g\nZ2V0VW5pdE5hbWVzKENvbmZpZ3VyYXRpb25QYXJzZXIgcGFyc2VyKSB7CiAg\nICAgICAgTGlzdDxQZXJzaXN0ZW5jZVVuaXRJbmZvSW1wbD4gdW5pdHMgPSBw\nYXJzZXIuZ2V0UmVzdWx0cygpOwogICAgICAgIExpc3Q8U3RyaW5nPiBuYW1l\ncyA9IG5ldyBBcnJheUxpc3Q8U3RyaW5nPigpOwogICAgICAgIGZvciAoUGVy\nc2lzdGVuY2VVbml0SW5mb0ltcGwgdW5pdCA6IHVuaXRzKXsKICAgICAgICAJ\nU3RyaW5nIHByb3ZpZGVyID0gdW5pdC5nZXRQZXJzaXN0ZW5jZVByb3ZpZGVy\nQ2xhc3NOYW1lKCk7CgkJCS8vIE9ubHkgYWRkIHRoZSBQVSBuYW1lIGlmIHRo\nZSBwcm92aWRlciBpdCBpcyBvdXJzIG9yIG5vdCBzcGVjaWZpZWQuCgkJCWlm\nIChwcm92aWRlciA9PSBudWxsIHx8IHByb3ZpZGVyLmVxdWFscyhfcHJvdmlk\nZXJJbXBsTmFtZSkpIHsKCQkJCW5hbWVzLmFkZCh1bml0LmdldFBlcnNpc3Rl\nbmNlVW5pdE5hbWUoKSk7CgkJCX0gZWxzZSB7CgkJCQkvLyBTaG91bGQgdHJh\nY2Ugc29tZXRoaW5nLCBidXQgbG9nZ2luZyBpc24ndCBjb25maWd1cmVkIHll\ndC4KCQkJCS8vIFN3YWxsb3cuCgkJCX0KICAgICAgICB9CiAgICAgICAgcmV0\ndXJuIG5hbWVzOwogICAgfQoKICAgIEBPdmVycmlkZQogICAgcHVibGljIExp\nc3QgZ2V0QW5jaG9yc0luUmVzb3VyY2UoU3RyaW5nIHJlc291cmNlKSB0aHJv\nd3MgRXhjZXB0aW9uIHsKICAgICAgICBDb25maWd1cmF0aW9uUGFyc2VyIHBh\ncnNlciA9IG5ldyBDb25maWd1cmF0aW9uUGFyc2VyKG51bGwpOwogICAgICAg\nIHRyeSB7CiAgICAgICAgCUxpc3QgcmVzdWx0cyA9IG5ldyBBcnJheUxpc3Qo\nKTsKICAgICAgICAgICAgQ2xhc3NMb2FkZXIgbG9hZGVyID0gQWNjZXNzQ29u\ndHJvbGxlci5kb1ByaXZpbGVnZWQoCiAgICAgICAgICAgICAgICBKMkRvUHJp\ndkhlbHBlci5nZXRDb250ZXh0Q2xhc3NMb2FkZXJBY3Rpb24oKSk7CiAgICAg\nICAgICAgIExpc3Q8VVJMPiB1cmxzID0gZ2V0UmVzb3VyY2VVUkxzKHJlc291\ncmNlLCBsb2FkZXIpOwogICAgICAgICAgICBpZiAodXJscyAhPSBudWxsKSB7\nCiAgICAgICAgICAgICAgICBmb3IgKFVSTCB1cmwgOiB1cmxzKSB7CiAgICAg\nICAgICAgICAgICAgICAgcGFyc2VyLnBhcnNlKHVybCk7CiAgICAgICAgICAg\nICAgICAgICAgcmVzdWx0cy5hZGRBbGwoZ2V0VW5pdE5hbWVzKHBhcnNlcikp\nOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAg\nIHJldHVybiByZXN1bHRzOwogICAgICAgIH0gY2F0Y2ggKElPRXhjZXB0aW9u\nIGUpIHsKICAgICAgICAgICAgLy8gbm90IGFsbCBjb25maWd1cmF0aW9uIGZp\nbGVzIGFyZSBYTUw7IHJldHVybiBudWxsIGlmIHVucGFyc2FibGUKICAgICAg\nICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgfQogICAgfQoKICAgIEBPdmVy\ncmlkZQogICAgcHVibGljIENvbmZpZ3VyYXRpb25Qcm92aWRlciBsb2FkR2xv\nYmFscyhDbGFzc0xvYWRlciBsb2FkZXIpCiAgICAgICAgdGhyb3dzIElPRXhj\nZXB0aW9uIHsKICAgICAgICBTdHJpbmdbXSBwcmVmaXhlcyA9IFByb2R1Y3RE\nZXJpdmF0aW9ucy5nZXRDb25maWd1cmF0aW9uUHJlZml4ZXMoKTsKICAgICAg\nICBTdHJpbmcgcnNyYyA9IG51bGw7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7\nIGkgPCBwcmVmaXhlcy5sZW5ndGggJiYgU3RyaW5nVXRpbHMuaXNFbXB0eShy\nc3JjKTsgaSsrKQogICAgICAgICAgIHJzcmMgPSBBY2Nlc3NDb250cm9sbGVy\nLmRvUHJpdmlsZWdlZChKMkRvUHJpdkhlbHBlcgogICAgICAgICAgICAgICAg\nLmdldFByb3BlcnR5QWN0aW9uKHByZWZpeGVzW2ldICsgIi5wcm9wZXJ0aWVz\nIikpOyAKICAgICAgICBib29sZWFuIGV4cGxpY2l0ID0gIVN0cmluZ1V0aWxz\nLmlzRW1wdHkocnNyYyk7CiAgICAgICAgU3RyaW5nIGFuY2hvciA9IG51bGw7\nCiAgICAgICAgaW50IGlkeCA9ICghZXhwbGljaXQpID8gLTEgOiByc3JjLmxh\nc3RJbmRleE9mKCcjJyk7CiAgICAgICAgaWYgKGlkeCAhPSAtMSkgewogICAg\nICAgICAgICAvLyBzZXBhcmF0ZSBuYW1lIGZyb20gPHJlc3JvdWNlPiM8bmFt\nZT4gc3RyaW5nCiAgICAgICAgICAgIGlmIChpZHggPCByc3JjLmxlbmd0aCgp\nIC0gMSkKICAgICAgICAgICAgICAgIGFuY2hvciA9IHJzcmMuc3Vic3RyaW5n\nKGlkeCArIDEpOwogICAgICAgICAgICByc3JjID0gcnNyYy5zdWJzdHJpbmco\nMCwgaWR4KTsKICAgICAgICB9CiAgICAgICAgaWYgKFN0cmluZ1V0aWxzLmlz\nRW1wdHkocnNyYykpCiAgICAgICAgICAgIHJzcmMgPSBSU1JDX0dMT0JBTDsK\nICAgICAgICBlbHNlIGlmICghcnNyYy5lbmRzV2l0aCgiLnhtbCIpKQogICAg\nICAgICAgICByZXR1cm4gbnVsbDsKCiAgICAgICAgQ29uZmlndXJhdGlvblBy\nb3ZpZGVySW1wbCBjcCA9IG5ldyBDb25maWd1cmF0aW9uUHJvdmlkZXJJbXBs\nKCk7CiAgICAgICAgaWYgKGxvYWQoY3AsIHJzcmMsIGFuY2hvciwgbnVsbCwg\nbG9hZGVyLCBleHBsaWNpdCkgPT0gQm9vbGVhbi5UUlVFKQogICAgICAgICAg\nICByZXR1cm4gY3A7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICB9CgogICAg\nQE92ZXJyaWRlCiAgICBwdWJsaWMgQ29uZmlndXJhdGlvblByb3ZpZGVyIGxv\nYWREZWZhdWx0cyhDbGFzc0xvYWRlciBsb2FkZXIpCiAgICAgICAgdGhyb3dz\nIElPRXhjZXB0aW9uIHsKICAgICAgICBDb25maWd1cmF0aW9uUHJvdmlkZXJJ\nbXBsIGNwID0gbmV3IENvbmZpZ3VyYXRpb25Qcm92aWRlckltcGwoKTsKICAg\nICAgICBpZiAobG9hZChjcCwgUlNSQ19ERUZBVUxULCBudWxsLCBudWxsLCBs\nb2FkZXIsIGZhbHNlKSA9PSBCb29sZWFuLlRSVUUpCiAgICAgICAgICAgIHJl\ndHVybiBjcDsKICAgICAgICByZXR1cm4gbnVsbDsKICAgIH0KCiAgICAgIC8q\nKgogICAgICAqIFRoaXMgbWV0aG9kIGNoZWNrcyB0byBzZWUgaWYgdGhlIHBy\nb3ZpZGVkIDxjb2RlPnB1TmFtZTwvY29kZT4gd2FzCiAgICAgICogZGV0ZWN0\nZWQgaW4gbXVsdGlwbGUgcmVzb3VyY2VzLiBJZiBhIGNvbGxpc2lvbiBpcyBk\nZXRlY3RlZCwgYSB3YXJuaW5nCiAgICAgICogd2lsbCBiZSBsb2dnZWQgYW5k\nIHRoaXMgbWV0aG9kIHdpbGwgcmV0dXJuIDxjb2RlPnRydWU8L2NvZGU+Lgog\nICAgICAqIDxwPgogICAgICAqLwogICAgIHB1YmxpYyBib29sZWFuIGNoZWNr\nUHVOYW1lQ29sbGlzaW9ucyhMb2cgbG9nZ2VyLFN0cmluZyBwdU5hbWUpewog\nICAgICAgICBQVU5hbWVDb2xsaXNpb24gcCA9IF9wdU5hbWVDb2xsaXNpb25z\nLmdldChwdU5hbWUpOwogICAgICAgICBpZiAocCAhPSBudWxsKXsKICAgICAg\nICAgICAgIHAubG9nQ29sbGlzaW9uKGxvZ2dlcik7CiAgICAgICAgICAgICBy\nZXR1cm4gdHJ1ZTsKICAgICAgICAgfQogICAgICAgICByZXR1cm4gZmFsc2U7\nCiAgICAgfQoKICAgIHByaXZhdGUgc3RhdGljIExpc3Q8VVJMPiBnZXRSZXNv\ndXJjZVVSTHMoU3RyaW5nIHJzcmMsIENsYXNzTG9hZGVyIGxvYWRlcikKICAg\nICAgICB0aHJvd3MgSU9FeGNlcHRpb24gewogICAgICAgIEVudW1lcmF0aW9u\nPFVSTD4gdXJscyA9IG51bGw7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAg\ndXJscyA9IEFjY2Vzc0NvbnRyb2xsZXIuZG9Qcml2aWxlZ2VkKEoyRG9Qcml2\nSGVscGVyLmdldFJlc291cmNlc0FjdGlvbihsb2FkZXIsIHJzcmMpKTsgCiAg\nICAgICAgICAgIGlmICghdXJscy5oYXNNb3JlRWxlbWVudHMoKSkgewogICAg\nICAgICAgICAgICAgaWYgKCFyc3JjLnN0YXJ0c1dpdGgoIk1FVEEtSU5GIikp\nCiAgICAgICAgICAgICAgICAgIHVybHMgPSBBY2Nlc3NDb250cm9sbGVyLmRv\nUHJpdmlsZWdlZChKMkRvUHJpdkhlbHBlci5nZXRSZXNvdXJjZXNBY3Rpb24o\nbG9hZGVyLCAiTUVUQS1JTkYvIiArIHJzcmMpKTsKICAgICAgICAgICAgICAg\nIGlmICghdXJscy5oYXNNb3JlRWxlbWVudHMoKSkKICAgICAgICAgICAgICAg\nICAgICByZXR1cm4gbnVsbDsKICAgICAgICAgICAgfQogICAgICAgIH0gY2F0\nY2ggKFByaXZpbGVnZWRBY3Rpb25FeGNlcHRpb24gcGFlKSB7CiAgICAgICAg\nICAgIHRocm93IChJT0V4Y2VwdGlvbikgcGFlLmdldEV4Y2VwdGlvbigpOwog\nICAgICAgIH0KCiAgICAgICAgcmV0dXJuIENvbGxlY3Rpb25zLmxpc3QodXJs\ncyk7CiAgICB9CgogICAgLyoqCiAgICAgKiBMb29rcyB0aHJvdWdoIHRoZSBy\nZXNvdXJjZXMgYXQgPGNvZGU+cnNyYzwvY29kZT4gZm9yIGEgY29uZmlndXJh\ndGlvbgogICAgICogZmlsZSB0aGF0IG1hdGNoZXMgPGNvZGU+bmFtZTwvY29k\nZT4gKG9yIGFuIHVubmFtZWQgb25lIGlmCiAgICAgKiA8Y29kZT5uYW1lPC9j\nb2RlPiBpcyA8Y29kZT5udWxsPC9jb2RlPiksIGFuZCBsb2FkcyB0aGUgWE1M\nIGluIHRoZQogICAgICogcmVzb3VyY2UgaW50byBhIG5ldyB7QGxpbmsgUGVy\nc2lzdGVuY2VVbml0SW5mb30uIFRoZW4sIGFwcGxpZXMgdGhlCiAgICAgKiBv\ndmVycmlkZXMgaW4gPGNvZGU+bTwvY29kZT4uCiAgICAgKgogICAgICogQHJl\ndHVybiB7QGxpbmsgQm9vbGVhbiNUUlVFfSBpZiB0aGUgcmVzb3VyY2Ugd2Fz\nIGxvYWRlZCwgbnVsbCBpZiBpdAogICAgICogZG9lcyBub3QgZXhpc3QsIG9y\nIHtAbGluayBCb29sZWFuI0ZBTFNFfSBpZiBpdCBpcyBub3QgZm9yIE9wZW5K\nUEEKICAgICAqLwogICAgcHJpdmF0ZSBCb29sZWFuIGxvYWQoQ29uZmlndXJh\ndGlvblByb3ZpZGVySW1wbCBjcCwgU3RyaW5nIHJzcmMsIAogICAgICAgIFN0\ncmluZyBuYW1lLCBNYXAgbSwgQ2xhc3NMb2FkZXIgbG9hZGVyLCBib29sZWFu\nIGV4cGxpY2l0KQogICAgICAgIHRocm93cyBJT0V4Y2VwdGlvbiB7CiAgICAg\nICAgaWYgKGxvYWRlciA9PSBudWxsKQogICAgICAgICAgICBsb2FkZXIgPSBB\nY2Nlc3NDb250cm9sbGVyLmRvUHJpdmlsZWdlZChKMkRvUHJpdkhlbHBlci5n\nZXRDb250ZXh0Q2xhc3NMb2FkZXJBY3Rpb24oKSk7CgogICAgICAgIExpc3Q8\nVVJMPiB1cmxzID0gZ2V0UmVzb3VyY2VVUkxzKHJzcmMsIGxvYWRlcik7CiAg\nICAgICAgaWYgKHVybHMgPT0gbnVsbCB8fCB1cmxzLnNpemUoKSA9PSAwKQog\nICAgICAgICAgICByZXR1cm4gbnVsbDsKCiAgICAgICAgQ29uZmlndXJhdGlv\nblBhcnNlciBwYXJzZXIgPSBuZXcgQ29uZmlndXJhdGlvblBhcnNlcihtKTsK\nICAgICAgICBQZXJzaXN0ZW5jZVVuaXRJbmZvSW1wbCBwaW5mbyA9IHBhcnNl\nUmVzb3VyY2VzKHBhcnNlciwgdXJscywgbmFtZSwgbG9hZGVyKTsKICAgICAg\nICBpZiAocGluZm8gPT0gbnVsbCkgewogICAgICAgICAgICBpZiAoIWV4cGxp\nY2l0KQogICAgICAgICAgICAgICAgcmV0dXJuIEJvb2xlYW4uRkFMU0U7CiAg\nICAgICAgICAgIHRocm93IG5ldyBNaXNzaW5nUmVzb3VyY2VFeGNlcHRpb24o\nX2xvYy5nZXQoIm1pc3NpbmcteG1sLWNvbmZpZyIsIAogICAgICAgICAgICAg\nICAgcnNyYywgU3RyaW5nLnZhbHVlT2YobmFtZSkpLmdldE1lc3NhZ2UoKSwg\nZ2V0Q2xhc3MoKS5nZXROYW1lKCksIHJzcmMpOwogICAgICAgIH0gZWxzZSBp\nZiAoIWlzT3BlbkpQQVBlcnNpc3RlbmNlUHJvdmlkZXIocGluZm8sIGxvYWRl\ncikpIHsKICAgICAgICAgICAgaWYgKCFleHBsaWNpdCkgewogICAgICAgICAg\nICAgICAgd2FyblVua25vd25Qcm92aWRlcihwaW5mbyk7CiAgICAgICAgICAg\nICAgICByZXR1cm4gQm9vbGVhbi5GQUxTRTsKICAgICAgICAgICAgfQogICAg\nICAgICAgICB0aHJvdyBuZXcgTWlzc2luZ1Jlc291cmNlRXhjZXB0aW9uKF9s\nb2MuZ2V0KCJ1bmtub3duLXByb3ZpZGVyIiwgCiAgICAgICAgICAgICAgICBy\nc3JjLCBuYW1lLCBwaW5mby5nZXRQZXJzaXN0ZW5jZVByb3ZpZGVyQ2xhc3NO\nYW1lKCkpLgogICAgICAgICAgICAgICAgZ2V0TWVzc2FnZSgpLCBnZXRDbGFz\ncygpLmdldE5hbWUoKSwgcnNyYyk7CiAgICAgICAgfQogICAgICAgIGNwLmFk\nZFByb3BlcnRpZXMocGluZm8udG9PcGVuSlBBUHJvcGVydGllcygpKTsKICAg\nICAgICBjcC5zZXRTb3VyY2UocGluZm8uZ2V0UGVyc2lzdGVuY2VYbWxGaWxl\nVXJsKCkudG9TdHJpbmcoKSk7CiAgICAgICAgcmV0dXJuIEJvb2xlYW4uVFJV\nRTsKICAgIH0KCiAgICAvKioKICAgICAqIFBhcnNlIHJlc291cmNlcyBhdCB0\naGUgZ2l2ZW4gbG9jYXRpb24uIFNlYXJjaGVzIGZvciBhCiAgICAgKiBQZXJz\naXN0ZW5jZVVuaXRJbmZvIHdpdGggdGhlIHJlcXVlc3RlZCBuYW1lLCBvciBh\nbiBPcGVuSlBBIHVuaXQgaWYKICAgICAqIG5vIG5hbWUgZ2l2ZW4gKHByZWZl\ncnJpbmcgYW4gdW5uYW1lZCBPcGVuSlBBIHVuaXQgdG8gYSBuYW1lZCBvbmUp\nLgogICAgICovCiAgICBwcml2YXRlIFBlcnNpc3RlbmNlVW5pdEluZm9JbXBs\nIHBhcnNlUmVzb3VyY2VzKENvbmZpZ3VyYXRpb25QYXJzZXIgcGFyc2VyLAog\nICAgICAgIExpc3Q8VVJMPiB1cmxzLCBTdHJpbmcgbmFtZSwgQ2xhc3NMb2Fk\nZXIgbG9hZGVyKQogICAgICAgIHRocm93cyBJT0V4Y2VwdGlvbiB7CiAgICAg\nICAgTGlzdDxQZXJzaXN0ZW5jZVVuaXRJbmZvSW1wbD4gcGluZm9zID0gbmV3\nIEFycmF5TGlzdDxQZXJzaXN0ZW5jZVVuaXRJbmZvSW1wbD4oKTsKICAgICAg\nICBmb3IgKFVSTCB1cmwgOiB1cmxzKSB7CiAgICAgICAgICAgIHBhcnNlci5w\nYXJzZSh1cmwpOwogICAgICAgICAgICBwaW5mb3MuYWRkQWxsKChMaXN0PFBl\ncnNpc3RlbmNlVW5pdEluZm9JbXBsPikgcGFyc2VyLmdldFJlc3VsdHMoKSk7\nCiAgICAgICAgfQogICAgICAgIHJldHVybiBmaW5kVW5pdChwaW5mb3MsIG5h\nbWUsIGxvYWRlcik7CiAgICB9CgogICAgLyoqCiAgICAgKiBGaW5kIHRoZSB1\nbml0IHdpdGggdGhlIGdpdmVuIG5hbWUsIG9yIGFuIE9wZW5KUEEgdW5pdCBp\nZiBubyBuYW1lIGlzCiAgICAgKiBnaXZlbiAocHJlZmVycmluZyBhbiB1bm5h\nbWVkIE9wZW5KUEEgdW5pdCB0byBhIG5hbWVkIG9uZSkuCiAgICAgKi8KICAg\nIHByaXZhdGUgUGVyc2lzdGVuY2VVbml0SW5mb0ltcGwgZmluZFVuaXQoTGlz\ndDxQZXJzaXN0ZW5jZVVuaXRJbmZvSW1wbD4gCiAgICAgICAgcGluZm9zLCBT\ndHJpbmcgbmFtZSwgQ2xhc3NMb2FkZXIgbG9hZGVyKSB7CiAgICAgICAgUGVy\nc2lzdGVuY2VVbml0SW5mb0ltcGwgb2pwYSA9IG51bGw7CiAgICAgICAgUGVy\nc2lzdGVuY2VVbml0SW5mb0ltcGwgcmVzdWx0ID0gbnVsbDsKICAgICAgICBm\nb3IgKFBlcnNpc3RlbmNlVW5pdEluZm9JbXBsIHBpbmZvIDogcGluZm9zKSB7\nCiAgICAgICAgICAgIC8vIGZvdW5kIG5hbWVkIHVuaXQ/CiAgICAgICAgICAg\nIGlmIChuYW1lICE9IG51bGwpIHsKICAgICAgICAgICAgICAgIGlmIChuYW1l\nLmVxdWFscyhwaW5mby5nZXRQZXJzaXN0ZW5jZVVuaXROYW1lKCkpKXsKICAg\nICAgICAgICAgICAgICAgICBpZiAocmVzdWx0ICE9IG51bGwpewogICAgICAg\nICAgICAgICAgICAgICAgICB0aGlzLmFkZFB1TmFtZUNvbGxpc2lvbihuYW1l\nLCByZXN1bHQuZ2V0UGVyc2lzdGVuY2VYbWxGaWxlVXJsKCkudG9TdHJpbmco\nKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwaW5mby5nZXRQ\nZXJzaXN0ZW5jZVhtbEZpbGVVcmwoKS50b1N0cmluZygpKTsKCiAgICAgICAg\nICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAg\nLy8gR3JhYiBhIHJlZiB0byB0aGUgcGluZm8gdGhhdCBtYXRjaGVzIHRoZSBu\nYW1lIHdlJ3JlCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGxvb2tpbmcg\nZm9yLiBLZWVwIGdvaW5nIHRvIGxvb2sgZm9yIGR1cGxpY2F0ZSBwdSBuYW1l\ncy4KICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gcGluZm87CiAg\nICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAg\nICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAg\nIGlmIChpc09wZW5KUEFQZXJzaXN0ZW5jZVByb3ZpZGVyKHBpbmZvLCBsb2Fk\nZXIpKSB7CiAgICAgICAgICAgICAgICAvLyBpZiBubyBuYW1lIGdpdmVuIGFu\nZCBmb3VuZCB1bm5hbWVkIHVuaXQsIHJldHVybiBpdC4gIAogICAgICAgICAg\nICAgICAgLy8gb3RoZXJ3aXNlIHJlY29yZCBhcyBkZWZhdWx0IHVuaXQgdW5s\nZXNzIHdlIGZpbmQgYSBiZXR0ZXIgbWF0Y2ggbGF0ZXIKICAgICAgICAgICAg\nICAgIGlmIChTdHJpbmdVdGlscy5pc0VtcHR5KHBpbmZvLmdldFBlcnNpc3Rl\nbmNlVW5pdE5hbWUoKSkpCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBp\nbmZvOwogICAgICAgICAgICAgICAgaWYgKG9qcGEgPT0gbnVsbCkKICAgICAg\nICAgICAgICAgICAgICBvanBhID0gcGluZm87CiAgICAgICAgICAgIH0KICAg\nICAgICB9CiAgICAgICAgaWYocmVzdWx0IT1udWxsKXsKICAgICAgICAgICAg\ncmV0dXJuIHJlc3VsdDsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIG9qcGE7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gd2hldGhlciB0aGUgZ2l2\nZW4gcGVyc2lzdGVuY2UgdW5pdCB1c2VzIGFuIE9wZW5KUEEgcHJvdmlkZXIu\nCiAgICAgKi8KICAgIHByaXZhdGUgc3RhdGljIGJvb2xlYW4gaXNPcGVuSlBB\nUGVyc2lzdGVuY2VQcm92aWRlcihQZXJzaXN0ZW5jZVVuaXRJbmZvIHBpbmZv\nLCBDbGFzc0xvYWRlciBsb2FkZXIpIHsKICAgICAgICBTdHJpbmcgcHJvdmlk\nZXIgPSBwaW5mby5nZXRQZXJzaXN0ZW5jZVByb3ZpZGVyQ2xhc3NOYW1lKCk7\nCiAgICAgICAgaWYgKFN0cmluZ1V0aWxzLmlzRW1wdHkocHJvdmlkZXIpIHx8\nIFBlcnNpc3RlbmNlUHJvdmlkZXJJbXBsLmNsYXNzLmdldE5hbWUoKS5lcXVh\nbHMocHJvdmlkZXIpKQogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKCiAgICAg\nICAgaWYgKGxvYWRlciA9PSBudWxsKQogICAgICAgICAgICBsb2FkZXIgPSBB\nY2Nlc3NDb250cm9sbGVyLmRvUHJpdmlsZWdlZChKMkRvUHJpdkhlbHBlci5n\nZXRDb250ZXh0Q2xhc3NMb2FkZXJBY3Rpb24oKSk7CiAgICAgICAgdHJ5IHsK\nICAgICAgICAgICAgaWYgKFBlcnNpc3RlbmNlUHJvdmlkZXJJbXBsLmNsYXNz\nLmlzQXNzaWduYWJsZUZyb20oQ2xhc3MuZm9yTmFtZShwcm92aWRlciwgZmFs\nc2UsIGxvYWRlcikpKQogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAg\nICAgICAgfSBjYXRjaCAoVGhyb3dhYmxlIHQpIHsKICAgICAgICAgICAgbG9n\nKF9sb2MuZ2V0KCJ1bmxvYWRhYmxlLXByb3ZpZGVyIiwgcHJvdmlkZXIsIHQp\nLmdldE1lc3NhZ2UoKSk7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAg\nICAgICB9CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIC8qKgog\nICAgICogV2FybiB0aGUgdXNlciB0aGF0IHdlIGNvdWxkIG9ubHkgZmluZCBh\nbiB1bnJlY29nbml6ZWQgcGVyc2lzdGVuY2UgCiAgICAgKiBwcm92aWRlci4K\nICAgICAqLwogICAgcHJpdmF0ZSBzdGF0aWMgdm9pZCB3YXJuVW5rbm93blBy\nb3ZpZGVyKFBlcnNpc3RlbmNlVW5pdEluZm8gcGluZm8pIHsKICAgICAgICBs\nb2coX2xvYy5nZXQoInVucmVjb2duaXplZC1wcm92aWRlciIsIHBpbmZvLmdl\ndFBlcnNpc3RlbmNlUHJvdmlkZXJDbGFzc05hbWUoKSkuZ2V0TWVzc2FnZSgp\nKTsKICAgIH0KICAgIAogICAgLyoqCiAgICAgKiBMb2cgYSBtZXNzYWdlLiAg\nIAogICAgICovCiAgICBwcml2YXRlIHN0YXRpYyB2b2lkIGxvZyhTdHJpbmcg\nbXNnKSB7CiAgICAgICAgLy8gYXQgdGhpcyBwb2ludCBsb2dnaW5nIGlzbid0\nIGNvbmZpZ3VyZWQgeWV0CiAgICAgICAgU3lzdGVtLmVyci5wcmludGxuKG1z\nZyk7CiAgICB9CgogICAgcHJpdmF0ZSB2b2lkIGFkZFB1TmFtZUNvbGxpc2lv\nbihTdHJpbmcgcHVOYW1lLCBTdHJpbmcgZmlsZTEsIFN0cmluZyBmaWxlMil7\nCiAgICAgICAgUFVOYW1lQ29sbGlzaW9uIHB1biA9IF9wdU5hbWVDb2xsaXNp\nb25zLmdldChwdU5hbWUpOwogICAgICAgIGlmIChwdW4gIT0gbnVsbCl7CiAg\nICAgICAgICAgIHB1bi5hZGRDb2xsaXNpb24oZmlsZTEsIGZpbGUyKTsKICAg\nICAgICB9IGVsc2UgewogICAgICAgICAgICBfcHVOYW1lQ29sbGlzaW9ucy5w\ndXQocHVOYW1lLCBuZXcgUFVOYW1lQ29sbGlzaW9uKHB1TmFtZSwgZmlsZTEs\nIGZpbGUyKSk7CiAgICAgICAgfQogICAgfQogICAgCiAgICAvKioKICAgICAq\nIEN1c3RvbSBjb25maWd1cmF0aW9uIHByb3ZpZGVyLiAgIAogICAgICovCiAg\nICBwdWJsaWMgc3RhdGljIGNsYXNzIENvbmZpZ3VyYXRpb25Qcm92aWRlcklt\ncGwKICAgICAgICBleHRlbmRzIE1hcENvbmZpZ3VyYXRpb25Qcm92aWRlciB7\nCgogICAgICAgIHByaXZhdGUgU3RyaW5nIF9zb3VyY2U7CgogICAgICAgIHB1\nYmxpYyBDb25maWd1cmF0aW9uUHJvdmlkZXJJbXBsKCkgewogICAgICAgIH0K\nCiAgICAgICAgcHVibGljIENvbmZpZ3VyYXRpb25Qcm92aWRlckltcGwoTWFw\nIHByb3BzKSB7CiAgICAgICAgICAgIHN1cGVyKHByb3BzKTsKICAgICAgICB9\nCgogICAgICAgIC8qKgogICAgICAgICAqIFNldCB0aGUgc291cmNlIG9mIGlu\nZm9ybWF0aW9uIGluIHRoaXMgcHJvdmlkZXIuCiAgICAgICAgICovCiAgICAg\nICAgcHVibGljIHZvaWQgc2V0U291cmNlKFN0cmluZyBzb3VyY2UpIHsKICAg\nICAgICAgICAgX3NvdXJjZSA9IHNvdXJjZTsKICAgICAgICB9CgogICAgICAg\nIEBPdmVycmlkZQogICAgICAgIHB1YmxpYyB2b2lkIHNldEludG8oQ29uZmln\ndXJhdGlvbiBjb25mKSB7CiAgICAgICAgICAgIGlmIChjb25mIGluc3RhbmNl\nb2YgT3BlbkpQQUNvbmZpZ3VyYXRpb24pIHsKICAgICAgICAgICAgICAgIE9w\nZW5KUEFDb25maWd1cmF0aW9uIG9jb25mID0gKE9wZW5KUEFDb25maWd1cmF0\naW9uKSBjb25mOwogICAgICAgICAgICAgICAgT2JqZWN0IHBlcnNpc3RlbmNl\nVmVyc2lvbiA9IGdldFByb3BlcnRpZXMoKS5nZXQoUGVyc2lzdGVuY2VVbml0\nSW5mb0ltcGwuUEVSU0lTVEVOQ0VfVkVSU0lPTik7CiAgICAgICAgICAgICAg\nICBpZiAocGVyc2lzdGVuY2VWZXJzaW9uID09IG51bGwpIHsKICAgICAgICAg\nICAgICAgICAgICBvY29uZi5zZXRTcGVjaWZpY2F0aW9uKFNQRUNfSlBBKTsK\nICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAg\nLy8gU2V0IHRoZSBzcGVjIGxldmVsIGJhc2VkIG9uIHRoZSBwZXJzaXN0ZW5j\nZSB2ZXJzaW9uCiAgICAgICAgICAgICAgICAgICAgb2NvbmYuc2V0U3BlY2lm\naWNhdGlvbigianBhICIgKyBwZXJzaXN0ZW5jZVZlcnNpb24udG9TdHJpbmco\nKSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgCgog\nICAgICAgICAgICAgICAgLy8gd2UgbWVyZ2Ugc2V2ZXJhbCBwZXJzaXN0ZW5j\nZS54bWwgZWxlbWVudHMgaW50byB0aGUgCiAgICAgICAgICAgICAgICAvLyBN\nZXRhRGF0YUZhY3RvcnkgcHJvcGVydHkgaW1wbGljaXRseS4gIGlmIHRoZSB1\nc2VyIGhhcyBhCiAgICAgICAgICAgICAgICAvLyBnbG9iYWwgb3BlbmpwYS54\nbWwgd2l0aCB0aGlzIHByb3BlcnR5IHNldCwgaXRzIHZhbHVlIHdpbGwKICAg\nICAgICAgICAgICAgIC8vIGdldCBvdmVyd3JpdHRlbiBieSBvdXIgaW1wbGlj\naXQgc2V0dGluZy4gIHNvIGluc3RlYWQsIGNvbWJpbmUKICAgICAgICAgICAg\nICAgIC8vIHRoZSBnbG9iYWwgdmFsdWUgd2l0aCBvdXIgc2V0dGluZ3MKICAg\nICAgICAgICAgICAgIFN0cmluZyBvcmlnID0gb2NvbmYuZ2V0TWV0YURhdGFG\nYWN0b3J5KCk7CiAgICAgICAgICAgICAgICBpZiAoIVN0cmluZ1V0aWxzLmlz\nRW1wdHkob3JpZykpIHsKICAgICAgICAgICAgICAgICAgICBTdHJpbmcga2V5\nID0gUHJvZHVjdERlcml2YXRpb25zLmdldENvbmZpZ3VyYXRpb25LZXkoIk1l\ndGFEYXRhRmFjdG9yeSIsIGdldFByb3BlcnRpZXMoKSk7CiAgICAgICAgICAg\nICAgICAgICAgT2JqZWN0IG92ZXJyaWRlID0gZ2V0UHJvcGVydGllcygpLmdl\ndChrZXkpOwogICAgICAgICAgICAgICAgICAgIGlmIChvdmVycmlkZSBpbnN0\nYW5jZW9mIFN0cmluZykKICAgICAgICAgICAgICAgICAgICAgICAgYWRkUHJv\ncGVydHkoa2V5LCBDb25maWd1cmF0aW9ucy5jb21iaW5lUGx1Z2lucyhvcmln\nLCAoU3RyaW5nKSBvdmVycmlkZSkpOwogICAgICAgICAgICAgICAgfQogICAg\nICAgICAgICB9CgogICAgICAgICAgICBzdXBlci5zZXRJbnRvKGNvbmYsIG51\nbGwpOwogICAgICAgICAgICBMb2cgbG9nID0gY29uZi5nZXRDb25maWd1cmF0\naW9uTG9nKCk7CiAgICAgICAgICAgIGlmIChsb2cuaXNUcmFjZUVuYWJsZWQo\nKSkgewogICAgICAgICAgICAgICAgU3RyaW5nIHNyYyA9IChfc291cmNlID09\nIG51bGwpID8gIj8iIDogX3NvdXJjZTsKICAgICAgICAgICAgICAgIGxvZy50\ncmFjZShfbG9jLmdldCgiY29uZi1sb2FkIiwgc3JjLCBnZXRQcm9wZXJ0aWVz\nKCkpKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICAvKioK\nICAgICAqIFNBWCBoYW5kbGVyIGNhcGFibGUgb2YgcGFyc2luZyBhbiBKUEEg\ncGVyc2lzdGVuY2UueG1sIGZpbGUuCiAgICAgKiBQYWNrYWdlLXByb3RlY3Rl\nZCBmb3IgdGVzdGluZy4KICAgICAqLwogICAgcHVibGljIHN0YXRpYyBjbGFz\ncyBDb25maWd1cmF0aW9uUGFyc2VyCiAgICAgICAgZXh0ZW5kcyBYTUxNZXRh\nRGF0YVBhcnNlciB7CgogICAgICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIFN0\ncmluZyBQRVJTSVNURU5DRV9YU0RfMV8wID0gInBlcnNpc3RlbmNlXzFfMC54\nc2QiOwogICAgICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIFN0cmluZyBQRVJT\nSVNURU5DRV9YU0RfMl8wID0gInBlcnNpc3RlbmNlXzJfMC54c2QiOwoKICAg\nICAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBMb2NhbGl6ZXIgX2xvYyA9IExv\nY2FsaXplci5mb3JQYWNrYWdlCiAgICAgICAgICAgIChDb25maWd1cmF0aW9u\nUGFyc2VyLmNsYXNzKTsKCiAgICAgICAgcHJpdmF0ZSBmaW5hbCBNYXAgX21h\ncDsKICAgICAgICBwcml2YXRlIFBlcnNpc3RlbmNlVW5pdEluZm9JbXBsIF9p\nbmZvID0gbnVsbDsKICAgICAgICBwcml2YXRlIFVSTCBfc291cmNlID0gbnVs\nbDsKICAgICAgICBwcml2YXRlIFN0cmluZyBfcGVyc2lzdGVuY2VWZXJzaW9u\nOwogICAgICAgIHByaXZhdGUgU3RyaW5nIF9zY2hlbWFMb2NhdGlvbjsKICAg\nICAgICBwcml2YXRlIGJvb2xlYW4gX2V4Y2x1ZGVVbmxpc3RlZFNldCA9IGZh\nbHNlOwoKICAgICAgICBwdWJsaWMgQ29uZmlndXJhdGlvblBhcnNlcihNYXAg\nbWFwKSB7CiAgICAgICAgICAgIF9tYXAgPSBtYXA7CiAgICAgICAgICAgIHNl\ndENhY2hpbmcoZmFsc2UpOwogICAgICAgICAgICBzZXRWYWxpZGF0aW5nKHRy\ndWUpOwogICAgICAgICAgICBzZXRQYXJzZVRleHQodHJ1ZSk7CiAgICAgICAg\nfQoKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBwdWJsaWMgdm9pZCBwYXJz\nZShVUkwgdXJsKQogICAgICAgICAgICB0aHJvd3MgSU9FeGNlcHRpb24gewog\nICAgICAgICAgICBfc291cmNlID0gdXJsOwoKICAgICAgICAgICAgLy8gcGVl\nayBhdCB0aGUgZG9jIHRvIGRldGVybWluZSB0aGUgdmVyc2lvbgogICAgICAg\nICAgICBYTUxWZXJzaW9uUGFyc2VyIHZwID0gbmV3IFhNTFZlcnNpb25QYXJz\nZXIoInBlcnNpc3RlbmNlIik7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAg\nICAgICAgICB2cC5wYXJzZSh1cmwpOwogICAgICAgICAgICAgICAgX3BlcnNp\nc3RlbmNlVmVyc2lvbiA9IHZwLmdldFZlcnNpb24oKTsKICAgICAgICAgICAg\nICAgIF9zY2hlbWFMb2NhdGlvbiA9IHZwLmdldFNjaGVtYUxvY2F0aW9uKCk7\nCiAgICAgICAgICAgIH0gY2F0Y2ggKFRocm93YWJsZSB0KSB7CiAgICAgICAg\nICAgICAgICAgICAgbG9nKF9sb2MuZ2V0KCJ2ZXJzaW9uLWNoZWNrLWVycm9y\nIiwgCiAgICAgICAgICAgICAgICAgICAgICAgIF9zb3VyY2UudG9TdHJpbmco\nKSkudG9TdHJpbmcoKSk7CiAgICAgICAgICAgIH0gICAgICAgICAgICAKICAg\nICAgICAgICAgc3VwZXIucGFyc2UodXJsKTsKICAgICAgICB9CgogICAgICAg\nIEBPdmVycmlkZQogICAgICAgIHB1YmxpYyB2b2lkIHBhcnNlKEZpbGUgZmls\nZSkKICAgICAgICAgICAgdGhyb3dzIElPRXhjZXB0aW9uIHsKICAgICAgICAg\nICAgdHJ5IHsKICAgICAgICAgICAgICAgIF9zb3VyY2UgPSBBY2Nlc3NDb250\ncm9sbGVyLmRvUHJpdmlsZWdlZChKMkRvUHJpdkhlbHBlcgogICAgICAgICAg\nICAgICAgICAgIC50b1VSTEFjdGlvbihmaWxlKSk7CiAgICAgICAgICAgIH0g\nY2F0Y2ggKFByaXZpbGVnZWRBY3Rpb25FeGNlcHRpb24gcGFlKSB7CiAgICAg\nICAgICAgICAgICB0aHJvdyAoTWFsZm9ybWVkVVJMRXhjZXB0aW9uKSBwYWUu\nZ2V0RXhjZXB0aW9uKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgLy8g\ncGVlayBhdCB0aGUgZG9jIHRvIGRldGVybWluZSB0aGUgdmVyc2lvbgogICAg\nICAgICAgICBYTUxWZXJzaW9uUGFyc2VyIHZwID0gbmV3IFhNTFZlcnNpb25Q\nYXJzZXIoInBlcnNpc3RlbmNlIik7CiAgICAgICAgICAgIHRyeSB7CiAgICAg\nICAgICAgICAgICB2cC5wYXJzZShmaWxlKTsKICAgICAgICAgICAgICAgIF9w\nZXJzaXN0ZW5jZVZlcnNpb24gPSB2cC5nZXRWZXJzaW9uKCk7CiAgICAgICAg\nICAgICAgICBfc2NoZW1hTG9jYXRpb24gPSB2cC5nZXRTY2hlbWFMb2NhdGlv\nbigpOyAgICAgICAgICAgICAgICAKICAgICAgICAgICAgfSBjYXRjaCAoVGhy\nb3dhYmxlIHQpIHsKICAgICAgICAgICAgICAgICAgICBsb2coX2xvYy5nZXQo\nInZlcnNpb24tY2hlY2stZXJyb3IiLCAKICAgICAgICAgICAgICAgICAgICAg\nICAgX3NvdXJjZS50b1N0cmluZygpKS50b1N0cmluZygpKTsKICAgICAgICAg\nICAgfSAgICAgICAgICAgIAogICAgICAgICAgICBzdXBlci5wYXJzZShmaWxl\nKTsKICAgICAgICB9CgogICAgICAgIEBPdmVycmlkZQogICAgICAgIHByb3Rl\nY3RlZCBPYmplY3QgZ2V0U2NoZW1hU291cmNlKCkgewogICAgICAgICAgICAv\nLyB1c2UgdGhlIHZlcnNpb24gMSBzY2hlbWEgYnkgZGVmYXVsdC4gIG5vbi12\nZXJzaW9uZWQgZG9jcyB3aWxsIAogICAgICAgICAgICAvLyBjb250aW51ZSB0\nbyBwYXJzZSB3aXRoIHRoZSBvbGQgeG1sIGlmIHRoZXkgZG8gbm90IGNvbnRh\naW4gYSAKICAgICAgICAgICAgLy8gcGVyc2lzdGVuY2UtdW5pdC4gIHRoYXQg\naXMgY3VycmVudGx5IHRoZSBvbmx5IHNpZ25pZmljYW50IGNoYW5nZQogICAg\nICAgICAgICAvLyB0byB0aGUgc2NoZW1hLiAgaWYgbW9yZSBzaWduaWZpY2Fu\ndCBjaGFuZ2VzIGFyZSBtYWRlIGluIHRoZSAKICAgICAgICAgICAgLy8gZnV0\ndXJlLCB0aGUgMi4wIHNjaGVtYSBtYXkgYmUgcHJlZmVyYWJsZS4KICAgICAg\nICAgICAgU3RyaW5nIHBlcnNpc3RlbmNleHNkID0gInBlcnNpc3RlbmNlLXhz\nZC5yc3JjIjsKICAgICAgICAgICAgLy8gaWYgdGhlIHZlcnNpb24gYW5kL29y\nIHNjaGVtYSBsb2NhdGlvbiBpcyBmb3IgMS4wLCB1c2UgdGhlIDEuMCAKICAg\nICAgICAgICAgLy8gc2NoZW1hCiAgICAgICAgICAgIGlmIChfcGVyc2lzdGVu\nY2VWZXJzaW9uICE9IG51bGwgJiYgX3BlcnNpc3RlbmNlVmVyc2lvbi5lcXVh\nbHMoWE1MVmVyc2lvblBhcnNlci5WRVJTSU9OXzJfMCkgCiAgICAgICAgICAg\nIHx8IChfc2NoZW1hTG9jYXRpb24gIT0gbnVsbCAmJiBfc2NoZW1hTG9jYXRp\nb24uaW5kZXhPZihQRVJTSVNURU5DRV9YU0RfMl8wKSAhPSAtMSkpIHsKICAg\nICAgICAgICAgICAgIHBlcnNpc3RlbmNleHNkID0gInBlcnNpc3RlbmNlXzJf\nMC14c2QucnNyYyI7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJu\nIGdldENsYXNzKCkuZ2V0UmVzb3VyY2VBc1N0cmVhbShwZXJzaXN0ZW5jZXhz\nZCk7CiAgICAgICAgfQoKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBwcm90\nZWN0ZWQgdm9pZCByZXNldCgpIHsKICAgICAgICAgICAgc3VwZXIucmVzZXQo\nKTsKICAgICAgICAgICAgX2luZm8gPSBudWxsOwogICAgICAgICAgICBfc291\ncmNlID0gbnVsbDsKICAgICAgICAgICAgX2V4Y2x1ZGVVbmxpc3RlZFNldCA9\nIGZhbHNlOwogICAgICAgIH0KCiAgICAgICAgcHJvdGVjdGVkIGJvb2xlYW4g\nc3RhcnRFbGVtZW50KFN0cmluZyBuYW1lLCBBdHRyaWJ1dGVzIGF0dHJzKQog\nICAgICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICAgICAg\naWYgKGN1cnJlbnREZXB0aCgpID09IDEpCiAgICAgICAgICAgICAgICBzdGFy\ndFBlcnNpc3RlbmNlVW5pdChhdHRycyk7CiAgICAgICAgICAgIGVsc2UgaWYg\nKGN1cnJlbnREZXB0aCgpID09IDMgJiYgInByb3BlcnR5Ii5lcXVhbHMobmFt\nZSkpCiAgICAgICAgICAgICAgICBfaW5mby5zZXRQcm9wZXJ0eShhdHRycy5n\nZXRWYWx1ZSgibmFtZSIpLCBhdHRycy5nZXRWYWx1ZSgidmFsdWUiKSk7CiAg\nICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KCiAgICAgICAgcHJv\ndGVjdGVkIHZvaWQgZW5kRWxlbWVudChTdHJpbmcgbmFtZSkKICAgICAgICAg\nICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgICAgIGlmIChjdXJy\nZW50RGVwdGgoKSA9PSAxKSB7CiAgICAgICAgICAgICAgICBlbmRQZXJzaXN0\nZW5jZVVuaXQoKTsKICAgICAgICAgICAgICAgIF9pbmZvLmZyb21Vc2VyUHJv\ncGVydGllcyhfbWFwKTsKICAgICAgICAgICAgICAgIGFkZFJlc3VsdChfaW5m\nbyk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKGN1cnJlbnREZXB0\naCgpICE9IDIpCiAgICAgICAgICAgICAgICByZXR1cm47CgogICAgICAgICAg\nICBzd2l0Y2ggKG5hbWUuY2hhckF0KDApKSB7CiAgICAgICAgICAgICAgICAv\nLyBjYXNlcyAnbmFtZScgYW5kICd0cmFuc2FjdGlvbi10eXBlJyBhcmUgaGFu\nZGxlZCBpbgogICAgICAgICAgICAgICAgLy8gICAgICBzdGFydFBlcnNpc3Rl\nbmNlVW5pdCgpCiAgICAgICAgICAgICAgICAvLyBjYXNlICdwcm9wZXJ0eScg\nZm9yICdwcm9wZXJ0aWVzJyBpcyBoYW5kbGVkIGluIHN0YXJ0RWxlbWVudCgp\nCiAgICAgICAgICAgICAgICBjYXNlICdjJzogLy8gY2xhc3MKICAgICAgICAg\nICAgICAgICAgICBfaW5mby5hZGRNYW5hZ2VkQ2xhc3NOYW1lKGN1cnJlbnRU\nZXh0KCkpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAg\nICAgICAgY2FzZSAnZSc6IC8vIGV4Y2x1ZGUtdW5saXN0ZWQtY2xhc3Nlcwog\nICAgICAgICAgICAgICAgICAgIHNldEV4Y2x1ZGVVbmxpc3RlZENsYXNzZXMo\nY3VycmVudFRleHQoKSk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAg\nICAgICAgICAgICAgICBjYXNlICdqJzoKICAgICAgICAgICAgICAgICAgICBp\nZiAoImp0YS1kYXRhLXNvdXJjZSIuZXF1YWxzKG5hbWUpKQogICAgICAgICAg\nICAgICAgICAgICAgICBfaW5mby5zZXRKdGFEYXRhU291cmNlTmFtZShjdXJy\nZW50VGV4dCgpKTsKICAgICAgICAgICAgICAgICAgICBlbHNlIHsgLy8gamFy\nLWZpbGUgCiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAg\nICAgICAgICAgICAgICAgICAgICBfaW5mby5hZGRKYXJGaWxlTmFtZShjdXJy\nZW50VGV4dCgpKTsKICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAo\nSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uIGlhZSkgewogICAgICAgICAgICAg\nICAgICAgICAgICAgICAgdGhyb3cgZ2V0RXhjZXB0aW9uKGlhZS5nZXRNZXNz\nYWdlKCkpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAg\nICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAg\nICAgICAgICAgY2FzZSAnbSc6IC8vIG1hcHBpbmctZmlsZQogICAgICAgICAg\nICAgICAgICAgIF9pbmZvLmFkZE1hcHBpbmdGaWxlTmFtZShjdXJyZW50VGV4\ndCgpKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAg\nICAgIGNhc2UgJ24nOiAvLyBub24tanRhLWRhdGEtc291cmNlCiAgICAgICAg\nICAgICAgICAgICAgX2luZm8uc2V0Tm9uSnRhRGF0YVNvdXJjZU5hbWUoY3Vy\ncmVudFRleHQoKSk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAg\nICAgICAgICAgICBjYXNlICdwJzoKICAgICAgICAgICAgICAgICAgICBpZiAo\nInByb3ZpZGVyIi5lcXVhbHMobmFtZSkpCiAgICAgICAgICAgICAgICAgICAg\nICAgIF9pbmZvLnNldFBlcnNpc3RlbmNlUHJvdmlkZXJDbGFzc05hbWUoY3Vy\ncmVudFRleHQoKSk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAg\nICAgICAgICAgICBjYXNlICdzJyA6IC8vIHNoYXJlZC1jYWNoZS1tb2RlCiAg\nICAgICAgICAgICAgICAgICAgX2luZm8uc2V0U2hhcmVkQ2FjaGVNb2RlKEpQ\nQVByb3BlcnRpZXMuZ2V0RW51bVZhbHVlKFNoYXJlZENhY2hlTW9kZS5jbGFz\ncywgY3VycmVudFRleHQoKSkpOwogICAgICAgICAgICAgICAgICAgIGJyZWFr\nOwogICAgICAgICAgICAgICAgY2FzZSAndic6IC8vIHZhbGlkYXRpb24tbW9k\nZQogICAgICAgICAgICAgICAgICAgIF9pbmZvLnNldFZhbGlkYXRpb25Nb2Rl\nKEpQQVByb3BlcnRpZXMuZ2V0RW51bVZhbHVlKFZhbGlkYXRpb25Nb2RlLmNs\nYXNzLCBjdXJyZW50VGV4dCgpKSk7CiAgICAgICAgICAgICAgICAgICAgYnJl\nYWs7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIC8vIFRoZSBk\nZWZhdWx0IHZhbHVlIGZvciBleGNsdWRlLXVubGlzdGVkLWNsYXNzZXMgd2Fz\nIAogICAgICAgIC8vIG1vZGlmaWVkIGluIEpQQSAyLjAgZnJvbSBmYWxzZSB0\nbyB0cnVlLiAgU2V0IHRoZSBkZWZhdWx0CiAgICAgICAgLy8gYmFzZWQgdXBv\nbiB0aGUgcGVyc2lzdGVuY2UgdmVyc2lvbiB0byBwcmVzZXJ2ZSBiZWhhdmlv\nciAKICAgICAgICAvLyBvZiBwcmUtSlBBIDIuMCBhcHBsaWNhdGlvbnMuCiAg\nICAgICAgcHJpdmF0ZSB2b2lkIHNldEV4Y2x1ZGVVbmxpc3RlZENsYXNzZXMo\nU3RyaW5nIHZhbHVlKSB7CiAgICAgICAgICAgIGlmICghX2V4Y2x1ZGVVbmxp\nc3RlZFNldCkgewogICAgICAgICAgICAgICAgQmlnRGVjaW1hbCB2ZXJzaW9u\nID0gZ2V0UGVyc2lzdGVuY2VWZXJzaW9uKCk7CiAgICAgICAgICAgICAgICBi\nb29sZWFuIGV4Y2x1ZGVVbmxpc3RlZDsKICAgICAgICAgICAgICAgIGlmICh2\nZXJzaW9uLmNvbXBhcmVUbyhWRVJTSU9OXzFfMCkgPiAwKSB7CiAgICAgICAg\nICAgICAgICAgICAgZXhjbHVkZVVubGlzdGVkID0gISgiZmFsc2UiLmVxdWFs\nc0lnbm9yZUNhc2UodmFsdWUpKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7\nCiAgICAgICAgICAgICAgICAgICAgZXhjbHVkZVVubGlzdGVkID0gInRydWUi\nLmVxdWFsc0lnbm9yZUNhc2UodmFsdWUpOwogICAgICAgICAgICAgICAgfSAg\nICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBfaW5mby5zZXRF\neGNsdWRlVW5saXN0ZWRDbGFzc2VzKGV4Y2x1ZGVVbmxpc3RlZCk7CiAgICAg\nICAgICAgICAgICBfZXhjbHVkZVVubGlzdGVkU2V0ID0gdHJ1ZTsgICAgICAg\nICAgICAKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgLyoqCiAg\nICAgICAgICogUGFyc2UgcGVyc2lzdGVuY2UtdW5pdCBlbGVtZW50LgogICAg\nICAgICAqLwogICAgICAgIHByaXZhdGUgdm9pZCBzdGFydFBlcnNpc3RlbmNl\nVW5pdChBdHRyaWJ1dGVzIGF0dHJzKQogICAgICAgICAgICB0aHJvd3MgU0FY\nRXhjZXB0aW9uIHsKICAgICAgICAgICAgX2V4Y2x1ZGVVbmxpc3RlZFNldCA9\nIGZhbHNlOyAgICAgICAgICAgIAogICAgICAgICAgICBfaW5mbyA9IG5ldyBQ\nZXJzaXN0ZW5jZVVuaXRJbmZvSW1wbCgpOwogICAgICAgICAgICBfaW5mby5z\nZXRQZXJzaXN0ZW5jZVVuaXROYW1lKGF0dHJzLmdldFZhbHVlKCJuYW1lIikp\nOwogICAgICAgICAgICBfaW5mby5zZXRQZXJzaXN0ZW5jZVhNTFNjaGVtYVZl\ncnNpb24oX3BlcnNpc3RlbmNlVmVyc2lvbik7CiAgICAgICAgICAgIAogICAg\nICAgICAgICAvLyB3ZSBvbmx5IHBhcnNlIHRoaXMgb3Vyc2VsdmVzIG91dHNp\nZGUgYSBjb250YWluZXIsIHNvIGRlZmF1bHQKICAgICAgICAgICAgLy8gdHJh\nbnNhY3Rpb24gdHlwZSB0byBsb2NhbAogICAgICAgICAgICBTdHJpbmcgdmFs\nID0gYXR0cnMuZ2V0VmFsdWUoInRyYW5zYWN0aW9uLXR5cGUiKTsKICAgICAg\nICAgICAgaWYgKHZhbCA9PSBudWxsKQogICAgICAgICAgICAgICAgX2luZm8u\nc2V0VHJhbnNhY3Rpb25UeXBlKFBlcnNpc3RlbmNlVW5pdFRyYW5zYWN0aW9u\nVHlwZS5SRVNPVVJDRV9MT0NBTCk7CiAgICAgICAgICAgIGVsc2UKICAgICAg\nICAgICAgICAgIF9pbmZvLnNldFRyYW5zYWN0aW9uVHlwZShFbnVtLnZhbHVl\nT2YoUGVyc2lzdGVuY2VVbml0VHJhbnNhY3Rpb25UeXBlLmNsYXNzLCB2YWwp\nKTsKCiAgICAgICAgICAgIGlmIChfc291cmNlICE9IG51bGwpCiAgICAgICAg\nICAgICAgICBfaW5mby5zZXRQZXJzaXN0ZW5jZVhtbEZpbGVVcmwoX3NvdXJj\nZSk7CgkJfQogICAgICAgIAogICAgICAgIHByaXZhdGUgdm9pZCBlbmRQZXJz\naXN0ZW5jZVVuaXQoKSB7CiAgICAgICAgICAgIGlmICghX2V4Y2x1ZGVVbmxp\nc3RlZFNldCkgewogICAgICAgICAgICAgICAgc2V0RXhjbHVkZVVubGlzdGVk\nQ2xhc3NlcyhudWxsKTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAg\nICAgcHJpdmF0ZSBCaWdEZWNpbWFsIGdldFBlcnNpc3RlbmNlVmVyc2lvbigp\nIHsKICAgICAgICAgICAgaWYgKF9pbmZvLmdldFBlcnNpc3RlbmNlWE1MU2No\nZW1hVmVyc2lvbigpICE9IG51bGwpIHsKICAgICAgICAgICAgICAgIHRyeSB7\nCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBCaWdEZWNpbWFsKF9p\nbmZvLmdldFBlcnNpc3RlbmNlWE1MU2NoZW1hVmVyc2lvbigpKTsKICAgICAg\nICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGNhdGNoIChUaHJvd2FibGUg\ndCkgewogICAgICAgICAgICAgICAgICAgIGxvZyhfbG9jLmdldCgiaW52YWxp\nZC12ZXJzaW9uLWF0dHJpYnV0ZSIsIAogICAgICAgICAgICAgICAgICAgICAg\nICBfaW5mby5nZXRQZXJzaXN0ZW5jZVhNTFNjaGVtYVZlcnNpb24oKSwKICAg\nICAgICAgICAgICAgICAgICAgICAgVkVSU0lPTl8xXzAudG9TdHJpbmcoKSku\ndG9TdHJpbmcoKSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0K\nICAgICAgICAgICAgLy8gT3BlbkpQQSBzdXBwb3J0cyBwZXJzaXN0ZW5jZSBm\naWxlcyB3aXRob3V0IGEgdmVyc2lvbiBhdHRyaWJ1dGUuCiAgICAgICAgICAg\nIC8vIEEgcGVyc2lzdGVuY2UgZmlsZSB3aXRob3V0IGEgdmVyc2lvbiBhdHRy\naWJ1dGUgd2lsbCBiZSBjb25zaWRlcmVkCiAgICAgICAgICAgIC8vIGEgdmVy\nc2lvbiAxLjAgcGVyc2lzdGVuY2UgZmlsZSBieSBkZWZhdWx0IHRvIG1haW50\nYWluIGJhY2t3YXJkIAogICAgICAgICAgICAvLyBjb21wYXRpYmlsaXR5Lgog\nICAgICAgICAgICByZXR1cm4gVkVSU0lPTl8xXzA7CiAgICAgICAgfQogICAg\nfQogICAgCiAgICAKICAgIC8qKgogICAgICogVGhpcyBwcml2YXRlIGNsYXNz\nIGlzIHVzZWQgdG8gaG9sZCBvbnRvIGluZm9ybWF0aW9uIHJlZ2FyZGluZwog\nICAgICogUGVyc2lzdGVudFVuaXQgbmFtZSBjb2xsaXNpb25zLgogICAgICov\nCiAgICBwcml2YXRlIHN0YXRpYyBjbGFzcyBQVU5hbWVDb2xsaXNpb257CiAg\nICAgICAgcHJpdmF0ZSBTdHJpbmcgX3B1TmFtZTsKICAgICAgICBwcml2YXRl\nIFNldDxTdHJpbmc+IF9yZXNvdXJjZXM7CgogICAgICAgIFBVTmFtZUNvbGxp\nc2lvbihTdHJpbmcgcHVOYW1lLCBTdHJpbmcgZmlsZTEsIFN0cmluZyBmaWxl\nMikgewogICAgICAgICAgICBfcmVzb3VyY2VzID0gbmV3IExpbmtlZEhhc2hT\nZXQ8U3RyaW5nPigpOwogICAgICAgICAgICBfcmVzb3VyY2VzLmFkZChmaWxl\nMSk7CiAgICAgICAgICAgIF9yZXNvdXJjZXMuYWRkKGZpbGUyKTsKCiAgICAg\nICAgICAgIF9wdU5hbWU9cHVOYW1lOwogICAgICAgIH0KICAgICAgICAKICAg\nICAgICB2b2lkIGxvZ0NvbGxpc2lvbihMb2cgbG9nZ2VyKXsKICAgICAgICAg\nICAgaWYobG9nZ2VyLmlzV2FybkVuYWJsZWQoKSl7CiAgICAgICAgICAgICAg\nICBsb2dnZXIud2FybihfbG9jLmdldEZhdGFsKCJkdXAtcHUiLCBuZXcgT2Jq\nZWN0W117X3B1TmFtZSxfcmVzb3VyY2VzLnRvU3RyaW5nKCksCQogICAgICAg\nICAgICAgICAgICAgIF9yZXNvdXJjZXMuaXRlcmF0b3IoKS5uZXh0KCl9KSk7\nCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgCiAgICAgICAgdm9p\nZCBhZGRDb2xsaXNpb24oU3RyaW5nIGZpbGUxLCBTdHJpbmcgZmlsZTIpewog\nICAgICAgICAgICBfcmVzb3VyY2VzLmFkZChmaWxlMSk7CiAgICAgICAgICAg\nIF9yZXNvdXJjZXMuYWRkKGZpbGUyKTsKICAgICAgICB9CgogICAgfQp9Cg==\n","encoding":"base64"}

