{"sha":"b611a10366467c5fb23230a153ae83ec320a27d3","node_id":"MDQ6QmxvYjIwNjM2NDpiNjExYTEwMzY2NDY3YzVmYjIzMjMwYTE1M2FlODNlYzMyMGEyN2Qz","size":71422,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/b611a10366467c5fb23230a153ae83ec320a27d3","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNr\nYWdlIG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZTsKCmltcG9ydCBq\nYXZhLmlvLkZpbGU7CmltcG9ydCBqYXZhLmlvLklPRXhjZXB0aW9uOwppbXBv\ncnQgamF2YS5sYW5nLnJlZmxlY3QuRmllbGQ7CmltcG9ydCBqYXZhLmxhbmcu\ncmVmbGVjdC5NZW1iZXI7CmltcG9ydCBqYXZhLmxhbmcucmVmbGVjdC5NZXRo\nb2Q7CmltcG9ydCBqYXZhLm5ldC5VUkw7CmltcG9ydCBqYXZhLnV0aWwuQXJy\nYXlMaXN0OwppbXBvcnQgamF2YS51dGlsLkNvbGxlY3Rpb247CmltcG9ydCBq\nYXZhLnV0aWwuRW51bVNldDsKaW1wb3J0IGphdmEudXRpbC5IYXNoTWFwOwpp\nbXBvcnQgamF2YS51dGlsLk1hcDsKaW1wb3J0IGphdmEudXRpbC5TZXQ7Cmlt\ncG9ydCBqYXZhLnV0aWwuU3RhY2s7CgppbXBvcnQgamF2YXgucGVyc2lzdGVu\nY2UuQ2FzY2FkZVR5cGU7CmltcG9ydCBqYXZheC5wZXJzaXN0ZW5jZS5HZW5l\ncmF0aW9uVHlwZTsKaW1wb3J0IGphdmF4LnBlcnNpc3RlbmNlLkxvY2tNb2Rl\nVHlwZTsKCmltcG9ydCBzdGF0aWMgamF2YXgucGVyc2lzdGVuY2UuQ2FzY2Fk\nZVR5cGUuKjsKCmltcG9ydCBvcmcuYXBhY2hlLmNvbW1vbnMubGFuZy5TdHJp\nbmdVdGlsczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5jb25mLk9wZW5K\nUEFDb25maWd1cmF0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmVu\naGFuY2UuUGVyc2lzdGVuY2VDYXBhYmxlOwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLmV2ZW50LkJlYW5MaWZlY3ljbGVDYWxsYmFja3M7CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEuZXZlbnQuTGlmZWN5Y2xlQ2FsbGJhY2tzOwpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmV2ZW50LkxpZmVjeWNsZUV2ZW50\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmV2ZW50Lk1ldGhvZExpZmVj\neWNsZUNhbGxiYWNrczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJu\nZWwuUXVlcnlMYW5ndWFnZXM7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\na2VybmVsLmpwcWwuSlBRTFBhcnNlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5saWIuY29uZi5Db25maWd1cmF0aW9uczsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5saWIubG9nLkxvZzsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5saWIubWV0YS5DRk1ldGFEYXRhUGFyc2VyOwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLmxpYi5tZXRhLlNvdXJjZVRyYWNrZXI7CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEubGliLm1ldGEuWE1MVmVyc2lvblBhcnNlcjsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIudXRpbC5Mb2NhbGl6ZXI7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YS5BY2Nlc3NDb2RlOwpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuQ2xhc3NNZXRhRGF0YTsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRhLkRlbGVnYXRpbmdNZXRh\nRGF0YUZhY3Rvcnk7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YS5G\naWVsZE1ldGFEYXRhOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEu\nSmF2YVR5cGVzOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuTGlm\nZWN5Y2xlTWV0YURhdGE7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0\nYS5NZXRhRGF0YUNvbnRleHQ7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\nbWV0YS5NZXRhRGF0YUZhY3Rvcnk7CmltcG9ydCBzdGF0aWMgb3JnLmFwYWNo\nZS5vcGVuanBhLm1ldGEuTWV0YURhdGFNb2Rlcy4qOwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLm1ldGEuTWV0YURhdGFSZXBvc2l0b3J5OwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuT3JkZXI7CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEubWV0YS5RdWVyeU1ldGFEYXRhOwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLm1ldGEuU2VxdWVuY2VNZXRhRGF0YTsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5tZXRhLlZhbHVlTWV0YURhdGE7CgppbXBvcnQg\nc3RhdGljIG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5NZXRhRGF0\nYVRhZy4qOwppbXBvcnQgc3RhdGljIG9yZy5hcGFjaGUub3BlbmpwYS5wZXJz\naXN0ZW5jZS5QZXJzaXN0ZW5jZVN0cmF0ZWd5Lio7CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEudXRpbC5JbXBsSGVscGVyOwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLnV0aWwuTWV0YURhdGFFeGNlcHRpb247CmltcG9ydCBvcmcu\neG1sLnNheC5BdHRyaWJ1dGVzOwppbXBvcnQgb3JnLnhtbC5zYXguTG9jYXRv\ncjsKaW1wb3J0IG9yZy54bWwuc2F4LlNBWEV4Y2VwdGlvbjsKCmltcG9ydCBz\nZXJwLnV0aWwuTnVtYmVyczsKCi8qKgogKiBDdXN0b20gU0FYIHBhcnNlciB1\nc2VkIGJ5IHRoZSBzeXN0ZW0gdG8gcXVpY2tseSBwYXJzZSBwZXJzaXN0ZW5j\nZQogKiBtZXRhZGF0YSBmaWxlcy4gVGhpcyBwYXJzZXIgbWF5IGludm9rZQog\nKiB7QGxpbmtwbGFpbiBBbm5vdGF0aW9uUGVyc2lzdGVuY2VNZXRhRGF0YVBh\ncnNlciBhbm90aGVyIHBhcnNlcn0gdG8gc2NhbgogKiBzb3VyY2UgY29kZSBh\nbm5vdGF0aW9uLgogKgogKiBAYXV0aG9yIFN0ZXZlIEtpbQogKiBAYXV0aG9y\nIFBpbmFraSBQb2RkYXIKICogQG5vamF2YWRvYwogKi8KcHVibGljIGNsYXNz\nIFhNTFBlcnNpc3RlbmNlTWV0YURhdGFQYXJzZXIKICAgIGV4dGVuZHMgQ0ZN\nZXRhRGF0YVBhcnNlcgogICAgaW1wbGVtZW50cyBQZXJzaXN0ZW5jZU1ldGFE\nYXRhRmFjdG9yeS5QYXJzZXIgewoKICAgIC8vIHBhcnNlIGNvbnN0YW50cwog\nICAgcHJvdGVjdGVkIHN0YXRpYyBmaW5hbCBTdHJpbmcgRUxFTV9QS0cgPSAi\ncGFja2FnZSI7CiAgICBwcm90ZWN0ZWQgc3RhdGljIGZpbmFsIFN0cmluZyBF\nTEVNX0FDQ0VTUyA9ICJhY2Nlc3MiOwogICAgcHJvdGVjdGVkIHN0YXRpYyBm\naW5hbCBTdHJpbmcgRUxFTV9BVFRSUyA9ICJhdHRyaWJ1dGVzIjsKICAgIHBy\nb3RlY3RlZCBzdGF0aWMgZmluYWwgU3RyaW5nIEVMRU1fTElTVEVORVIgPSAi\nZW50aXR5LWxpc3RlbmVyIjsKICAgIHByb3RlY3RlZCBzdGF0aWMgZmluYWwg\nU3RyaW5nIEVMRU1fQ0FTQ0FERSA9ICJjYXNjYWRlIjsKICAgIHByb3RlY3Rl\nZCBzdGF0aWMgZmluYWwgU3RyaW5nIEVMRU1fQ0FTQ0FERV9BTEwgPSAiY2Fz\nY2FkZS1hbGwiOwogICAgcHJvdGVjdGVkIHN0YXRpYyBmaW5hbCBTdHJpbmcg\nRUxFTV9DQVNDQURFX1BFUiA9ICJjYXNjYWRlLXBlcnNpc3QiOwogICAgcHJv\ndGVjdGVkIHN0YXRpYyBmaW5hbCBTdHJpbmcgRUxFTV9DQVNDQURFX01FUiA9\nICJjYXNjYWRlLW1lcmdlIjsKICAgIHByb3RlY3RlZCBzdGF0aWMgZmluYWwg\nU3RyaW5nIEVMRU1fQ0FTQ0FERV9SRU0gPSAiY2FzY2FkZS1yZW1vdmUiOwog\nICAgcHJvdGVjdGVkIHN0YXRpYyBmaW5hbCBTdHJpbmcgRUxFTV9DQVNDQURF\nX1JFRiA9ICJjYXNjYWRlLXJlZnJlc2giOwogICAgcHJvdGVjdGVkIHN0YXRp\nYyBmaW5hbCBTdHJpbmcgRUxFTV9DQVNDQURFX0RFVCA9ICJjYXNjYWRlLWRl\ndGFjaCI7CiAgICBwcm90ZWN0ZWQgc3RhdGljIGZpbmFsIFN0cmluZyBFTEVN\nX1BVX01FVEEgPSAicGVyc2lzdGVuY2UtdW5pdC1tZXRhZGF0YSI7CiAgICBw\ncm90ZWN0ZWQgc3RhdGljIGZpbmFsIFN0cmluZyBFTEVNX1BVX0RFRiA9ICJw\nZXJzaXN0ZW5jZS11bml0LWRlZmF1bHRzIjsKICAgIHByb3RlY3RlZCBzdGF0\naWMgZmluYWwgU3RyaW5nIEVMRU1fWE1MX01BUF9NRVRBX0NPTVBMRVRFID0g\nInhtbC1tYXBwaW5nLW1ldGFkYXRhLWNvbXBsZXRlIjsKICAgIHByb3RlY3Rl\nZCBzdGF0aWMgZmluYWwgU3RyaW5nIEVMRU1fREVMSU1fSURTID0gImRlbGlt\naXRlZC1pZGVudGlmaWVycyI7CiAgICAKICAgIC8vIFRoZSBmb2xsb3dpbmcg\naXMgbmVlZGVkIGZvciBpbnB1dCBpbnRvIHRoZSBkZWxpbWl0U3RyaW5nKCkg\nbWV0aG9kCiAgICBwcm90ZWN0ZWQgc3RhdGljIGVudW0gbG9jYWxEQklkZW50\naWZpZXJzIHsKICAgICAgICBTRVFVRU5DRV9HRU5fU0VRX05BTUUsCiAgICAg\nICAgU0VRVUVOQ0VfR0VOX1NDSEVNQQogICAgfSAgICAKCiAgICBwcml2YXRl\nIHN0YXRpYyBmaW5hbCBNYXA8U3RyaW5nLCBPYmplY3Q+IF9lbGVtcyA9CiAg\nICAgICAgbmV3IEhhc2hNYXA8U3RyaW5nLCBPYmplY3Q+KCk7CgogICAgLy8g\nTWFwIGZvciBzdG9yaW5nIGRlZmVycmVkIG1ldGFkYXRhIHdoaWNoIG5lZWRz\nIHRvIGJlIHBvcHVsYXRlZAogICAgLy8gYWZ0ZXIgZW1iZWRkYWJsZXMgYXJl\nIGxvYWRlZC4KICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIE1hcDxDbGFzczw/\nPiwgQXJyYXlMaXN0PE1ldGFEYXRhQ29udGV4dD4+CiAgICAgICAgX2VtYmVk\nZGFibGVzID0gbmV3IEhhc2hNYXA8Q2xhc3M8Pz4sIEFycmF5TGlzdDxNZXRh\nRGF0YUNvbnRleHQ+PigpOwogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgTWFw\nPENsYXNzPD8+LCBJbnRlZ2VyPgogICAgICAgIF9lbWJlZGRhYmxlQWNjZXNz\nID0gbmV3IEhhc2hNYXA8Q2xhc3M8Pz4sIEludGVnZXI+KCk7CgogICAgc3Rh\ndGljIHsKICAgICAgICBfZWxlbXMucHV0KEVMRU1fUEtHLCBFTEVNX1BLRyk7\nCiAgICAgICAgX2VsZW1zLnB1dChFTEVNX0FDQ0VTUywgRUxFTV9BQ0NFU1Mp\nOwogICAgICAgIF9lbGVtcy5wdXQoRUxFTV9BVFRSUywgRUxFTV9BVFRSUyk7\nCiAgICAgICAgX2VsZW1zLnB1dChFTEVNX0xJU1RFTkVSLCBFTEVNX0xJU1RF\nTkVSKTsKICAgICAgICBfZWxlbXMucHV0KEVMRU1fQ0FTQ0FERSwgRUxFTV9D\nQVNDQURFKTsKICAgICAgICBfZWxlbXMucHV0KEVMRU1fQ0FTQ0FERV9BTEws\nIEVMRU1fQ0FTQ0FERV9BTEwpOwogICAgICAgIF9lbGVtcy5wdXQoRUxFTV9D\nQVNDQURFX1BFUiwgRUxFTV9DQVNDQURFX1BFUik7CiAgICAgICAgX2VsZW1z\nLnB1dChFTEVNX0NBU0NBREVfUkVNLCBFTEVNX0NBU0NBREVfUkVNKTsKICAg\nICAgICBfZWxlbXMucHV0KEVMRU1fQ0FTQ0FERV9NRVIsIEVMRU1fQ0FTQ0FE\nRV9NRVIpOwogICAgICAgIF9lbGVtcy5wdXQoRUxFTV9DQVNDQURFX1JFRiwg\nRUxFTV9DQVNDQURFX1JFRik7CiAgICAgICAgX2VsZW1zLnB1dChFTEVNX0NB\nU0NBREVfREVULCBFTEVNX0NBU0NBREVfREVUKTsKICAgICAgICBfZWxlbXMu\ncHV0KEVMRU1fUFVfTUVUQSwgRUxFTV9QVV9NRVRBKTsKICAgICAgICBfZWxl\nbXMucHV0KEVMRU1fUFVfREVGLCBFTEVNX1BVX0RFRik7CiAgICAgICAgX2Vs\nZW1zLnB1dChFTEVNX1hNTF9NQVBfTUVUQV9DT01QTEVURSwgRUxFTV9YTUxf\nTUFQX01FVEFfQ09NUExFVEUpOwogICAgICAgIF9lbGVtcy5wdXQoRUxFTV9E\nRUxJTV9JRFMsIEVMRU1fREVMSU1fSURTKTsKCiAgICAgICAgX2VsZW1zLnB1\ndCgiZW50aXR5LWxpc3RlbmVycyIsIEVOVElUWV9MSVNURU5FUlMpOwogICAg\nICAgIF9lbGVtcy5wdXQoInByZS1wZXJzaXN0IiwgUFJFX1BFUlNJU1QpOwog\nICAgICAgIF9lbGVtcy5wdXQoInBvc3QtcGVyc2lzdCIsIFBPU1RfUEVSU0lT\nVCk7CiAgICAgICAgX2VsZW1zLnB1dCgicHJlLXJlbW92ZSIsIFBSRV9SRU1P\nVkUpOwogICAgICAgIF9lbGVtcy5wdXQoInBvc3QtcmVtb3ZlIiwgUE9TVF9S\nRU1PVkUpOwogICAgICAgIF9lbGVtcy5wdXQoInByZS11cGRhdGUiLCBQUkVf\nVVBEQVRFKTsKICAgICAgICBfZWxlbXMucHV0KCJwb3N0LXVwZGF0ZSIsIFBP\nU1RfVVBEQVRFKTsKICAgICAgICBfZWxlbXMucHV0KCJwb3N0LWxvYWQiLCBQ\nT1NUX0xPQUQpOwogICAgICAgIF9lbGVtcy5wdXQoImV4Y2x1ZGUtZGVmYXVs\ndC1saXN0ZW5lcnMiLCBFWENMVURFX0RFRkFVTFRfTElTVEVORVJTKTsKICAg\nICAgICBfZWxlbXMucHV0KCJleGNsdWRlLXN1cGVyY2xhc3MtbGlzdGVuZXJz\nIiwKICAgICAgICAgICAgRVhDTFVERV9TVVBFUkNMQVNTX0xJU1RFTkVSUyk7\nCgogICAgICAgIF9lbGVtcy5wdXQoIm5hbWVkLXF1ZXJ5IiwgUVVFUlkpOwog\nICAgICAgIF9lbGVtcy5wdXQoIm5hbWVkLW5hdGl2ZS1xdWVyeSIsIE5BVElW\nRV9RVUVSWSk7CiAgICAgICAgX2VsZW1zLnB1dCgicXVlcnktaGludCIsIFFV\nRVJZX0hJTlQpOwogICAgICAgIF9lbGVtcy5wdXQoInF1ZXJ5IiwgUVVFUllf\nU1RSSU5HKTsKCiAgICAgICAgX2VsZW1zLnB1dCgiZmx1c2gtbW9kZSIsIEZM\nVVNIX01PREUpOwogICAgICAgIF9lbGVtcy5wdXQoInNlcXVlbmNlLWdlbmVy\nYXRvciIsIFNFUV9HRU5FUkFUT1IpOwoKICAgICAgICBfZWxlbXMucHV0KCJp\nZCIsIElEKTsKICAgICAgICBfZWxlbXMucHV0KCJpZC1jbGFzcyIsIElEX0NM\nQVNTKTsKICAgICAgICBfZWxlbXMucHV0KCJlbWJlZGRlZC1pZCIsIEVNQkVE\nREVEX0lEKTsKICAgICAgICBfZWxlbXMucHV0KCJtYXBzLWlkIiwgTUFQUEVE\nX0JZX0lEKTsKICAgICAgICBfZWxlbXMucHV0KCJ2ZXJzaW9uIiwgVkVSU0lP\nTik7CiAgICAgICAgX2VsZW1zLnB1dCgiZ2VuZXJhdGVkLXZhbHVlIiwgR0VO\nRVJBVEVEX1ZBTFVFKTsKICAgICAgICBfZWxlbXMucHV0KCJtYXAta2V5Iiwg\nTUFQX0tFWSk7CiAgICAgICAgX2VsZW1zLnB1dCgib3JkZXItYnkiLCBPUkRF\nUl9CWSk7CiAgICAgICAgX2VsZW1zLnB1dCgib3JkZXItY29sdW1uIiwgT1JE\nRVJfQ09MVU1OKTsKICAgICAgICBfZWxlbXMucHV0KCJsb2IiLCBMT0IpOwoK\nICAgICAgICBfZWxlbXMucHV0KCJiYXNpYyIsIEJBU0lDKTsKICAgICAgICBf\nZWxlbXMucHV0KCJtYW55LXRvLW9uZSIsIE1BTllfT05FKTsKICAgICAgICBf\nZWxlbXMucHV0KCJvbmUtdG8tb25lIiwgT05FX09ORSk7CiAgICAgICAgX2Vs\nZW1zLnB1dCgiZW1iZWRkZWQiLCBFTUJFRERFRCk7CiAgICAgICAgX2VsZW1z\nLnB1dCgib25lLXRvLW1hbnkiLCBPTkVfTUFOWSk7CiAgICAgICAgX2VsZW1z\nLnB1dCgibWFueS10by1tYW55IiwgTUFOWV9NQU5ZKTsKICAgICAgICBfZWxl\nbXMucHV0KCJ0cmFuc2llbnQiLCBUUkFOU0lFTlQpOwogICAgICAgIF9lbGVt\ncy5wdXQoImVsZW1lbnQtY29sbGVjdGlvbiIsIEVMRU1fQ09MTCk7CiAgICAg\nICAgX2VsZW1zLnB1dCgibWFwLWtleS1jbGFzcyIsIE1BUF9LRVlfQ0xBU1Mp\nOwogICAgfQoKICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIExvY2FsaXplciBf\nbG9jID0gTG9jYWxpemVyLmZvclBhY2thZ2UKICAgICAgICAoWE1MUGVyc2lz\ndGVuY2VNZXRhRGF0YVBhcnNlci5jbGFzcyk7CgogICAgcHJpdmF0ZSBmaW5h\nbCBPcGVuSlBBQ29uZmlndXJhdGlvbiBfY29uZjsKICAgIHByaXZhdGUgTWV0\nYURhdGFSZXBvc2l0b3J5IF9yZXBvcyA9IG51bGw7CiAgICBwcml2YXRlIEFu\nbm90YXRpb25QZXJzaXN0ZW5jZU1ldGFEYXRhUGFyc2VyIF9wYXJzZXIgPSBu\ndWxsOwogICAgcHJpdmF0ZSBDbGFzc0xvYWRlciBfZW52TG9hZGVyID0gbnVs\nbDsKICAgIHByaXZhdGUgaW50IF9tb2RlID0gTU9ERV9OT05FOwogICAgcHJp\ndmF0ZSBib29sZWFuIF9vdmVycmlkZSA9IGZhbHNlOwoKICAgIHByaXZhdGUg\nZmluYWwgU3RhY2s8T2JqZWN0PiBfZWxlbWVudHMgPSBuZXcgU3RhY2s8T2Jq\nZWN0PigpOwogICAgcHJpdmF0ZSBmaW5hbCBTdGFjazxPYmplY3Q+IF9wYXJl\nbnRzID0gbmV3IFN0YWNrPE9iamVjdD4oKTsKCiAgICBwcml2YXRlIENsYXNz\nPD8+IF9jbHMgPSBudWxsOwogICAgLy8gTGlzdCBvZiBjbGFzc2VzIGN1cnJl\nbnRseSBiZWluZyBwYXJzZWQKICAgIHByaXZhdGUgQXJyYXlMaXN0PENsYXNz\nPD8+PiBfcGFyc2VMaXN0ID0gbmV3IEFycmF5TGlzdDxDbGFzczw/Pj4oKTsK\nICAgIHByaXZhdGUgaW50IF9maWVsZFBvcyA9IDA7CiAgICBwcml2YXRlIGlu\ndCBfY2xzUG9zID0gMDsKICAgIHByaXZhdGUgaW50IF9hY2Nlc3MgPSBBY2Nl\nc3NDb2RlLlVOS05PV047CiAgICBwcml2YXRlIFBlcnNpc3RlbmNlU3RyYXRl\nZ3kgX3N0cmF0ZWd5ID0gbnVsbDsKICAgIHByaXZhdGUgU2V0PENhc2NhZGVU\neXBlPiBfY2FzY2FkZXMgPSBudWxsOwogICAgcHJpdmF0ZSBTZXQ8Q2FzY2Fk\nZVR5cGU+IF9wa2dDYXNjYWRlcyA9IG51bGw7CgogICAgcHJpdmF0ZSBDbGFz\nczw/PiBfbGlzdGVuZXIgPSBudWxsOwogICAgcHJpdmF0ZSBDb2xsZWN0aW9u\nPExpZmVjeWNsZUNhbGxiYWNrcz5bXSBfY2FsbGJhY2tzID0gbnVsbDsKICAg\nIHByaXZhdGUgaW50W10gX2hpZ2hzID0gbnVsbDsKICAgIHByaXZhdGUgYm9v\nbGVhbiBfaXNYTUxNYXBwaW5nTWV0YURhdGFDb21wbGV0ZSA9IGZhbHNlOwoK\nICAgIHByaXZhdGUgU3RyaW5nIF9vcm1WZXJzaW9uOwogICAgcHJpdmF0ZSBT\ndHJpbmcgX3NjaGVtYUxvY2F0aW9uOwoKICAgIHByaXZhdGUgc3RhdGljIGZp\nbmFsIFN0cmluZyBPUk1fWFNEXzFfMCA9ICJvcm1fMV8wLnhzZCI7CiAgICBw\ncml2YXRlIHN0YXRpYyBmaW5hbCBTdHJpbmcgT1JNX1hTRF8yXzAgPSAib3Jt\nXzJfMC54c2QiOwoKICAgIC8qKgogICAgICogQ29uc3RydWN0b3I7IHN1cHBs\neSBjb25maWd1cmF0aW9uLgogICAgICovCiAgICBwdWJsaWMgWE1MUGVyc2lz\ndGVuY2VNZXRhRGF0YVBhcnNlcihPcGVuSlBBQ29uZmlndXJhdGlvbiBjb25m\nKSB7CiAgICAgICAgX2NvbmYgPSBjb25mOwogICAgICAgIHNldFZhbGlkYXRp\nbmcodHJ1ZSk7CiAgICAgICAgc2V0TG9nKGNvbmYuZ2V0TG9nKE9wZW5KUEFD\nb25maWd1cmF0aW9uLkxPR19NRVRBREFUQSkpOwogICAgICAgIHNldFBhcnNl\nQ29tbWVudHModHJ1ZSk7CiAgICAgICAgc2V0TW9kZShNT0RFX01FVEEgfCBN\nT0RFX01BUFBJTkcgfCBNT0RFX1FVRVJZKTsKICAgICAgICBzZXRQYXJzZVRl\neHQodHJ1ZSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBDb25maWd1cmF0aW9u\nIHN1cHBsaWVkIG9uIGNvbnN0cnVjdGlvbi4KICAgICAqLwogICAgcHVibGlj\nIE9wZW5KUEFDb25maWd1cmF0aW9uIGdldENvbmZpZ3VyYXRpb24oKSB7CiAg\nICAgICAgcmV0dXJuIF9jb25mOwogICAgfQoKICAgIC8qKgogICAgICogVGhl\nIGFubm90YXRpb24gcGFyc2VyLiBXaGVuIGNsYXNzIGlzIGRpc2NvdmVyZWQg\naW4gYW4gWE1MIGZpbGUsCiAgICAgKiB3ZSBmaXJzdCBwYXJzZSBhbnkgYW5u\nb3RhdGlvbnMgcHJlc2VudCwgdGhlbiBvdmVycmlkZSB3aXRoIHRoZSBYTUwu\nCiAgICAgKi8KICAgIHB1YmxpYyBBbm5vdGF0aW9uUGVyc2lzdGVuY2VNZXRh\nRGF0YVBhcnNlciBnZXRBbm5vdGF0aW9uUGFyc2VyKCkgewogICAgICAgIHJl\ndHVybiBfcGFyc2VyOwogICAgfQoKICAgIC8qKgogICAgICogVGhlIGFubm90\nYXRpb24gcGFyc2VyLiBXaGVuIGNsYXNzIGlzIGRpc2NvdmVyZWQgaW4gYW4g\nWE1MIGZpbGUsCiAgICAgKiB3ZSBmaXJzdCBwYXJzZSBhbnkgYW5ub3RhdGlv\nbnMgcHJlc2VudCwgdGhlbiBvdmVycmlkZSB3aXRoIHRoZSBYTUwuCiAgICAg\nKi8KICAgIHB1YmxpYyB2b2lkIHNldEFubm90YXRpb25QYXJzZXIoQW5ub3Rh\ndGlvblBlcnNpc3RlbmNlTWV0YURhdGFQYXJzZXIgcGFyc2VyKXsKICAgICAg\nICBfcGFyc2VyID0gcGFyc2VyOwogICAgfQoKICAgIC8qKgogICAgICogUmV0\ndXJucyB0aGUgcmVwb3NpdG9yeSBmb3IgdGhpcyBwYXJzZXIuIElmIG5vbmUg\naGFzIGJlZW4gc2V0LCBjcmVhdGVzCiAgICAgKiBhIG5ldyByZXBvc2l0b3J5\nIGFuZCBzZXRzIGl0LgogICAgICovCiAgICBwdWJsaWMgTWV0YURhdGFSZXBv\nc2l0b3J5IGdldFJlcG9zaXRvcnkoKSB7CiAgICAgICAgaWYgKF9yZXBvcyA9\nPSBudWxsKSB7CiAgICAgICAgICAgIE1ldGFEYXRhUmVwb3NpdG9yeSByZXBv\ncyA9IF9jb25mLm5ld01ldGFEYXRhUmVwb3NpdG9yeUluc3RhbmNlKCk7CiAg\nICAgICAgICAgIE1ldGFEYXRhRmFjdG9yeSBtZGYgPSByZXBvcy5nZXRNZXRh\nRGF0YUZhY3RvcnkoKTsKICAgICAgICAgICAgaWYgKG1kZiBpbnN0YW5jZW9m\nIERlbGVnYXRpbmdNZXRhRGF0YUZhY3RvcnkpCiAgICAgICAgICAgICAgICBt\nZGYgPSAoKERlbGVnYXRpbmdNZXRhRGF0YUZhY3RvcnkpIG1kZikuZ2V0SW5u\nZXJtb3N0RGVsZWdhdGUoKTsKICAgICAgICAgICAgaWYgKG1kZiBpbnN0YW5j\nZW9mIFBlcnNpc3RlbmNlTWV0YURhdGFGYWN0b3J5KQogICAgICAgICAgICAg\nICAgKChQZXJzaXN0ZW5jZU1ldGFEYXRhRmFjdG9yeSkgbWRmKS5zZXRYTUxQ\nYXJzZXIodGhpcyk7CiAgICAgICAgICAgIF9yZXBvcyA9IHJlcG9zOwogICAg\nICAgIH0KICAgICAgICByZXR1cm4gX3JlcG9zOwogICAgfQoKICAgIC8qKgog\nICAgICogU2V0IHRoZSBtZXRhZGF0YSByZXBvc2l0b3J5IGZvciB0aGlzIHBh\ncnNlci4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0UmVwb3NpdG9yeShN\nZXRhRGF0YVJlcG9zaXRvcnkgcmVwb3MpIHsKICAgICAgICBfcmVwb3MgPSBy\nZXBvczsKICAgICAgICBpZiAocmVwb3MgIT0gbnVsbAogICAgICAgICAgICAm\nJiAocmVwb3MuZ2V0VmFsaWRhdGUoKSAmIE1ldGFEYXRhUmVwb3NpdG9yeS5W\nQUxJREFURV9SVU5USU1FKSAhPSAwKQogICAgICAgICAgICBzZXRQYXJzZUNv\nbW1lbnRzKGZhbHNlKTsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0\naGUgZW52aXJvbm1lbnRhbCBjbGFzcyBsb2FkZXIgdG8gcGFzcyBvbiB0byBw\nYXJzZWQKICAgICAqIG1ldGFkYXRhIGluc3RhbmNlcy4KICAgICAqLwogICAg\ncHVibGljIENsYXNzTG9hZGVyIGdldEVudkNsYXNzTG9hZGVyKCkgewogICAg\nICAgIHJldHVybiBfZW52TG9hZGVyOwogICAgfQoKICAgIC8qKgogICAgICog\nU2V0IHRoZSBlbnZpcm9ubWVudGFsIGNsYXNzIGxvYWRlciB0byBwYXNzIG9u\nIHRvIHBhcnNlZAogICAgICogbWV0YWRhdGEgaW5zdGFuY2VzLgogICAgICov\nCiAgICBwdWJsaWMgdm9pZCBzZXRFbnZDbGFzc0xvYWRlcihDbGFzc0xvYWRl\nciBsb2FkZXIpIHsKICAgICAgICBfZW52TG9hZGVyID0gbG9hZGVyOwogICAg\nfQoKICAgIC8qKgogICAgICogV2hldGhlciB0byBhbGxvdyBsYXRlciBwYXJz\nZXMgb2YgbWFwcGluZyBpbmZvcm1hdGlvbiB0byBvdmVycmlkZQogICAgICog\nZWFybGllciBpbmZvcm1hdGlvbiBmb3IgdGhlIHNhbWUgY2xhc3MuIERlZmF1\nbHRzIHRvIGZhbHNlLiBVc2VmdWwKICAgICAqIHdoZW4gYSB0b29sIGlzIG1h\ncHBpbmcgYSBjbGFzcywgc28gdGhhdCAuamRvIGZpbGUgcGFydGlhbCBtYXBw\naW5nCiAgICAgKiBpbmZvcm1hdGlvbiBjYW4gYmUgdXNlZCBldmVuIHdoZW4g\nbWFwcGluZ3MgYXJlIHN0b3JlZCBpbiAub3JtIGZpbGVzCiAgICAgKiBvciBv\ndGhlciBsb2NhdGlvbnMuCiAgICAgKi8KICAgIHB1YmxpYyBib29sZWFuIGdl\ndE1hcHBpbmdPdmVycmlkZSgpIHsKICAgICAgICByZXR1cm4gX292ZXJyaWRl\nOwogICAgfQoKICAgIC8qKgogICAgICogV2hldGhlciB0byBhbGxvdyBsYXRl\nciBwYXJzZXMgb2YgbWFwcGluZyBpbmZvcm1hdGlvbiB0byBvdmVycmlkZQog\nICAgICogZWFybGllciBpbmZvcm1hdGlvbiBmb3IgdGhlIHNhbWUgY2xhc3Mu\nIERlZmF1bHRzIHRvIGZhbHNlLiBVc2VmdWwKICAgICAqIHdoZW4gYSB0b29s\nIGlzIG1hcHBpbmcgYSBjbGFzcywgc28gdGhhdCAuamRvIGZpbGUgcGFydGlh\nbCBtYXBwaW5nCiAgICAgKiBpbmZvcm1hdGlvbiBjYW4gYmUgdXNlZCBldmVu\nIHdoZW4gbWFwcGluZ3MgYXJlIHN0b3JlZCBpbiAub3JtIGZpbGVzCiAgICAg\nKiBvciBvdGhlciBsb2NhdGlvbnMuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lk\nIHNldE1hcHBpbmdPdmVycmlkZShib29sZWFuIG92ZXJyaWRlKSB7CiAgICAg\nICAgX292ZXJyaWRlID0gb3ZlcnJpZGU7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBUaGUgcGFyc2UgbW9kZSBhY2NvcmRpbmcgdG8gdGhlIGV4cGVjdGVkIGRv\nY3VtZW50IHR5cGUuIFRoZQogICAgICogbW9kZSBjb25zdGFudHMgYWN0IGFz\nIGJpdCBmbGFncywgYW5kIHRoZXJlZm9yZSBjYW4gYmUgY29tYmluZWQuCiAg\nICAgKi8KICAgIHB1YmxpYyBpbnQgZ2V0TW9kZSgpIHsKICAgICAgICByZXR1\ncm4gX21vZGU7CiAgICB9CgogICAgLyoqCiAgICAgKiBUaGUgcGFyc2UgbW9k\nZSBhY2NvcmRpbmcgdG8gdGhlIGV4cGVjdGVkIGRvY3VtZW50IHR5cGUuCiAg\nICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldE1vZGUoaW50IG1vZGUsIGJvb2xl\nYW4gb24pIHsKICAgICAgICBpZiAobW9kZSA9PSBNT0RFX05PTkUpCiAgICAg\nICAgICAgIHNldE1vZGUoTU9ERV9OT05FKTsKICAgICAgICBlbHNlIGlmIChv\nbikKICAgICAgICAgICAgc2V0TW9kZShfbW9kZSB8IG1vZGUpOwogICAgICAg\nIGVsc2UKICAgICAgICAgICAgc2V0TW9kZShfbW9kZSAmIH5tb2RlKTsKICAg\nIH0KCiAgICAvKioKICAgICAqIFRoZSBwYXJzZSBtb2RlIGFjY29yZGluZyB0\nbyB0aGUgZXhwZWN0ZWQgZG9jdW1lbnQgdHlwZS4KICAgICAqLwogICAgcHVi\nbGljIHZvaWQgc2V0TW9kZShpbnQgbW9kZSkgewogICAgICAgIF9tb2RlID0g\nbW9kZTsKICAgICAgICBpZiAoX3BhcnNlciAhPSBudWxsKQogICAgICAgICAg\nICBfcGFyc2VyLnNldE1vZGUobW9kZSk7CiAgICB9CgogICAgcHVibGljIHZv\naWQgcGFyc2UoVVJMIHVybCkgdGhyb3dzIElPRXhjZXB0aW9uIHsKICAgICAg\nICAvLyBwZWVrIGF0IHRoZSBkb2MgdG8gZGV0ZXJtaW5lIHRoZSB2ZXJzaW9u\nCiAgICAgICAgWE1MVmVyc2lvblBhcnNlciB2cCA9IG5ldyBYTUxWZXJzaW9u\nUGFyc2VyKCJlbnRpdHktbWFwcGluZ3MiKTsKICAgICAgICB0cnkgewogICAg\nICAgICAgICB2cC5wYXJzZSh1cmwpOwogICAgICAgICAgICBfb3JtVmVyc2lv\nbiA9IHZwLmdldFZlcnNpb24oKTsKICAgICAgICAgICAgX3NjaGVtYUxvY2F0\naW9uID0gdnAuZ2V0U2NoZW1hTG9jYXRpb24oKTsKICAgICAgICB9IGNhdGNo\nIChUaHJvd2FibGUgdCkgewogICAgICAgICAgICAgICAgTG9nIGxvZyA9IGdl\ndExvZygpOwogICAgICAgICAgICAgICAgaWYgKGxvZy5pc0luZm9FbmFibGVk\nKCkpCiAgICAgICAgICAgICAgICAgICAgbG9nLnRyYWNlKF9sb2MuZ2V0KCJ2\nZXJzaW9uLWNoZWNrLWVycm9yIiwKICAgICAgICAgICAgICAgICAgICAgICAg\ndXJsLnRvU3RyaW5nKCkpKTsKICAgICAgICB9CiAgICAgICAgc3VwZXIucGFy\nc2UodXJsKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBwYXJzZShGaWxlIGZp\nbGUpIHRocm93cyBJT0V4Y2VwdGlvbiB7CiAgICAgICAgLy8gcGVlayBhdCB0\naGUgZG9jIHRvIGRldGVybWluZSB0aGUgdmVyc2lvbgogICAgICAgIFhNTFZl\ncnNpb25QYXJzZXIgdnAgPSBuZXcgWE1MVmVyc2lvblBhcnNlcigiZW50aXR5\nLW1hcHBpbmdzIik7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgdnAucGFy\nc2UoZmlsZSk7CiAgICAgICAgICAgIF9vcm1WZXJzaW9uID0gdnAuZ2V0VmVy\nc2lvbigpOwogICAgICAgICAgICBfc2NoZW1hTG9jYXRpb24gPSB2cC5nZXRT\nY2hlbWFMb2NhdGlvbigpOwogICAgICAgIH0gY2F0Y2ggKFRocm93YWJsZSB0\nKSB7CiAgICAgICAgICAgICAgICBMb2cgbG9nID0gZ2V0TG9nKCk7CiAgICAg\nICAgICAgICAgICBpZiAobG9nLmlzSW5mb0VuYWJsZWQoKSkKICAgICAgICAg\nICAgICAgICAgICBsb2cudHJhY2UoX2xvYy5nZXQoInZlcnNpb24tY2hlY2st\nZXJyb3IiLAogICAgICAgICAgICAgICAgICAgICAgICBmaWxlLnRvU3RyaW5n\nKCkpKTsKICAgICAgICB9CiAgICAgICAgc3VwZXIucGFyc2UoZmlsZSk7CiAg\nICB9CiAgICAvKioKICAgICAqIENvbnZlbmllbmNlIG1ldGhvZCBmb3IgaW50\nZXJwcmV0aW5nIHtAbGluayAjZ2V0TW9kZX0uCiAgICAgKi8KICAgIHByb3Rl\nY3RlZCBib29sZWFuIGlzTWV0YURhdGFNb2RlKCkgewogICAgICAgIHJldHVy\nbiAoX21vZGUgJiBNT0RFX01FVEEpICE9IDA7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBDb252ZW5pZW5jZSBtZXRob2QgZm9yIGludGVycHJldGluZyB7QGxp\nbmsgI2dldE1vZGV9LgogICAgICovCiAgICBwcm90ZWN0ZWQgYm9vbGVhbiBp\nc1F1ZXJ5TW9kZSgpIHsKICAgICAgICByZXR1cm4gKF9tb2RlICYgTU9ERV9R\nVUVSWSkgIT0gMDsKICAgIH0KCiAgICAvKioKICAgICAqIENvbnZlbmllbmNl\nIG1ldGhvZCBmb3IgaW50ZXJwcmV0aW5nIHtAbGluayAjZ2V0TW9kZX0uCiAg\nICAgKi8KICAgIHByb3RlY3RlZCBib29sZWFuIGlzTWFwcGluZ01vZGUoKSB7\nCiAgICAgICAgcmV0dXJuIChfbW9kZSAmIE1PREVfTUFQUElORykgIT0gMDsK\nICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybnMgdHJ1ZSBpZiB3ZSdyZSBp\nbiBtYXBwaW5nIG1vZGUgb3IgaW4gbWV0YWRhdGEgbW9kZSB3aXRoCiAgICAg\nKiBtYXBwaW5nIG92ZXJyaWRlIGVuYWJsZWQuCiAgICAgKi8KICAgIHByb3Rl\nY3RlZCBib29sZWFuIGlzTWFwcGluZ092ZXJyaWRlTW9kZSgpIHsKICAgICAg\nICByZXR1cm4gaXNNYXBwaW5nTW9kZSgpIHx8IChfb3ZlcnJpZGUgJiYgaXNN\nZXRhRGF0YU1vZGUoKSk7CiAgICB9CgogICAgLy8vLy8vLy8vLy8vLy8vCiAg\nICAvLyBYTUwgcGFyc2luZwogICAgLy8vLy8vLy8vLy8vLy8vCgogICAgLyoq\nCiAgICAgKiBQdXNoIGEgcGFyc2UgZWxlbWVudCBvbnRvIHRoZSBzdGFjay4K\nICAgICAqLwogICAgcHJvdGVjdGVkIHZvaWQgcHVzaEVsZW1lbnQoT2JqZWN0\nIGVsZW0pIHsKICAgICAgICBfZWxlbWVudHMucHVzaChlbGVtKTsKICAgIH0K\nCiAgICAvKioKICAgICAqIFBvcCBhIHBhcnNlIGVsZW1lbnQgZnJvbSB0aGUg\nc3RhY2suCiAgICAgKi8KICAgIHByb3RlY3RlZCBPYmplY3QgcG9wRWxlbWVu\ndCgpIHsKICAgICAgICByZXR1cm4gX2VsZW1lbnRzLnBvcCgpOwogICAgfQoK\nICAgIC8qKgogICAgICogUGVlayBhIHBhcnNlIGVsZW1lbnQgZnJvbSB0aGUg\nc3RhY2suCiAgICAgKi8KICAgIHByb3RlY3RlZCBPYmplY3QgcGVla0VsZW1l\nbnQoKSB7CiAgICAgICAgcmV0dXJuIF9lbGVtZW50cy5wZWVrKCk7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIGN1cnJlbnQgZWxlbWVudCBi\nZWluZyBwYXJzZWQuIE1heSBiZSBhIGNsYXNzIG1ldGFkYXRhLAogICAgICog\nZmllbGQgbWV0YWRhdGEsIHF1ZXJ5IG1ldGFkYXRhLCBldGMuCiAgICAgKi8K\nICAgIHByb3RlY3RlZCBPYmplY3QgY3VycmVudEVsZW1lbnQoKSB7CiAgICAg\nICAgaWYgKF9lbGVtZW50cy5pc0VtcHR5KCkpCiAgICAgICAgICAgIHJldHVy\nbiBudWxsOwogICAgICAgIHJldHVybiBfZWxlbWVudHMucGVlaygpOwogICAg\nfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRoZSBjdXJyZW50IHtAbGluayBQ\nZXJzaXN0ZW5jZVN0cmF0ZWd5fSBpZiBhbnkuCiAgICAgKi8KICAgIHByb3Rl\nY3RlZCBQZXJzaXN0ZW5jZVN0cmF0ZWd5IGN1cnJlbnRTdHJhdGVneSgpIHsK\nICAgICAgICByZXR1cm4gX3N0cmF0ZWd5OwogICAgfQoKICAgIC8qKgogICAg\nICogUmV0dXJuIHRoZSB0YWcgb2YgdGhlIGN1cnJlbnQgcGFyZW50IGVsZW1l\nbnQuCiAgICAgKi8KICAgIHByb3RlY3RlZCBPYmplY3QgY3VycmVudFBhcmVu\ndCgpIHsKICAgICAgICBpZiAoX3BhcmVudHMuaXNFbXB0eSgpKQogICAgICAg\nICAgICByZXR1cm4gbnVsbDsKICAgICAgICByZXR1cm4gX3BhcmVudHMucGVl\naygpOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHdoZXRoZXIgd2Un\ncmUgcnVubmluZyB0aGUgcGFyc2VyIGF0IHJ1bnRpbWUuCiAgICAgKi8KICAg\nIHByb3RlY3RlZCBib29sZWFuIGlzUnVudGltZSgpIHsKICAgICAgICByZXR1\ncm4gKGdldFJlcG9zaXRvcnkoKS5nZXRWYWxpZGF0ZSgpCiAgICAgICAgICAg\nICYgTWV0YURhdGFSZXBvc2l0b3J5LlZBTElEQVRFX1JVTlRJTUUpICE9IDA7\nCiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwcm90ZWN0ZWQgT2JqZWN0IGdl\ndFNjaGVtYVNvdXJjZSgpIHsKICAgICAgICAvLyB1c2UgdGhlIGxhdGVzdCBz\nY2hlbWEgYnkgZGVmYXVsdC4gICd1bmtub3duJyBkb2NzIHNob3VsZCBwYXJz\nZQogICAgICAgIC8vIHdpdGggdGhlIGxhdGVzdCBzY2hlbWEuCiAgICAgICAg\nU3RyaW5nIG9ybXhzZCA9ICJvcm1fMl8wLXhzZC5yc3JjIjsKICAgICAgICAv\nLyBpZiB0aGUgdmVyc2lvbiBhbmQvb3Igc2NoZW1hIGxvY2F0aW9uIGlzIGZv\nciAxLjAsIHVzZSB0aGUgMS4wCiAgICAgICAgLy8gc2NoZW1hCiAgICAgICAg\naWYgKF9vcm1WZXJzaW9uICE9IG51bGwgJiYKICAgICAgICAgICAgX29ybVZl\ncnNpb24uZXF1YWxzKFhNTFZlcnNpb25QYXJzZXIuVkVSU0lPTl8xXzApIHx8\nCiAgICAgICAgICAgIChfc2NoZW1hTG9jYXRpb24gIT0gbnVsbCAmJgogICAg\nICAgICAgICBfc2NoZW1hTG9jYXRpb24uaW5kZXhPZihPUk1fWFNEXzFfMCkg\nIT0gLTEpKSB7CiAgICAgICAgICAgIG9ybXhzZCA9ICJvcm0teHNkLnJzcmMi\nOwogICAgICAgIH0KICAgICAgICByZXR1cm4gWE1MUGVyc2lzdGVuY2VNZXRh\nRGF0YVBhcnNlci5jbGFzcy5nZXRSZXNvdXJjZUFzU3RyZWFtKG9ybXhzZCk7\nCiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwcm90ZWN0ZWQgU3RyaW5nIGdl\ndFBhY2thZ2VBdHRyaWJ1dGVOYW1lKCkgewogICAgICAgIHJldHVybiBudWxs\nOwogICAgfQoKICAgIEBPdmVycmlkZQogICAgcHJvdGVjdGVkIFN0cmluZyBn\nZXRDbGFzc0F0dHJpYnV0ZU5hbWUoKSB7CiAgICAgICAgcmV0dXJuICJjbGFz\ncyI7CiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwcm90ZWN0ZWQgaW50IGdl\ndENsYXNzRWxlbWVudERlcHRoKCkgewogICAgICAgIHJldHVybiAxOwogICAg\nfQoKICAgIEBPdmVycmlkZQogICAgcHJvdGVjdGVkIGJvb2xlYW4gaXNDbGFz\nc0VsZW1lbnROYW1lKFN0cmluZyBuYW1lKSB7CiAgICAgICAgcmV0dXJuICJl\nbnRpdHkiLmVxdWFscyhuYW1lKQogICAgICAgICAgICB8fCAiZW1iZWRkYWJs\nZSIuZXF1YWxzKG5hbWUpCiAgICAgICAgICAgIHx8ICJtYXBwZWQtc3VwZXJj\nbGFzcyIuZXF1YWxzKG5hbWUpOwogICAgfQoKICAgIEBPdmVycmlkZQogICAg\ncHJvdGVjdGVkIHZvaWQgcmVzZXQoKSB7CiAgICAJLy8gQWRkIGFsbCByZW1h\naW5pbmcgZGVmZXJyZWQgZW1iZWRkYWJsZSBtZXRhZGF0YQogICAgICAgIGFk\nZERlZmVycmVkRW1iZWRkYWJsZU1ldGFEYXRhKCk7CgogICAgICAgIHN1cGVy\nLnJlc2V0KCk7CiAgICAgICAgX2VsZW1lbnRzLmNsZWFyKCk7CiAgICAgICAg\nX3BhcmVudHMuY2xlYXIoKTsKICAgICAgICBfY2xzID0gbnVsbDsKICAgICAg\nICBfcGFyc2VMaXN0LmNsZWFyKCk7CiAgICAgICAgX2ZpZWxkUG9zID0gMDsK\nICAgICAgICBfY2xzUG9zID0gMDsKCiAgICAgICAgX2FjY2VzcyA9IEFjY2Vz\nc0NvZGUuVU5LTk9XTjsKICAgICAgICBfc3RyYXRlZ3kgPSBudWxsOwogICAg\nICAgIF9saXN0ZW5lciA9IG51bGw7CiAgICAgICAgX2NhbGxiYWNrcyA9IG51\nbGw7CiAgICAgICAgX2hpZ2hzID0gbnVsbDsKICAgICAgICBfY2FzY2FkZXMg\nPSBudWxsOwogICAgICAgIF9wa2dDYXNjYWRlcyA9IG51bGw7CiAgICB9Cgog\nICAgQE92ZXJyaWRlCiAgICBwcm90ZWN0ZWQgYm9vbGVhbiBzdGFydFN5c3Rl\nbUVsZW1lbnQoU3RyaW5nIG5hbWUsIEF0dHJpYnV0ZXMgYXR0cnMpCiAgICAg\nICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgT2JqZWN0IHRhZyA9\nIChPYmplY3QpIF9lbGVtcy5nZXQobmFtZSk7CiAgICAgICAgYm9vbGVhbiBy\nZXQgPSBmYWxzZTsKICAgICAgICBpZiAodGFnID09IG51bGwpIHsKICAgICAg\nICAgICAgaWYgKGlzTWFwcGluZ092ZXJyaWRlTW9kZSgpKQogICAgICAgICAg\nICAgICAgdGFnID0gc3RhcnRTeXN0ZW1NYXBwaW5nRWxlbWVudChuYW1lLCBh\ndHRycyk7CiAgICAgICAgICAgIHJldCA9IHRhZyAhPSBudWxsOwogICAgICAg\nIH0gZWxzZSBpZiAodGFnIGluc3RhbmNlb2YgTWV0YURhdGFUYWcpIHsKICAg\nICAgICAgICAgc3dpdGNoICgoTWV0YURhdGFUYWcpIHRhZykgewogICAgICAg\nICAgICAgICAgY2FzZSBRVUVSWToKICAgICAgICAgICAgICAgICAgICByZXQg\nPSBzdGFydE5hbWVkUXVlcnkoYXR0cnMpOwogICAgICAgICAgICAgICAgICAg\nIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSBRVUVSWV9ISU5UOgogICAg\nICAgICAgICAgICAgICAgIHJldCA9IHN0YXJ0UXVlcnlIaW50KGF0dHJzKTsK\nICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNh\nc2UgTkFUSVZFX1FVRVJZOgogICAgICAgICAgICAgICAgICAgIHJldCA9IHN0\nYXJ0TmFtZWROYXRpdmVRdWVyeShhdHRycyk7CiAgICAgICAgICAgICAgICAg\nICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIFFVRVJZX1NUUklORzoK\nICAgICAgICAgICAgICAgICAgICByZXQgPSBzdGFydFF1ZXJ5U3RyaW5nKGF0\ndHJzKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAg\nICAgIGNhc2UgU0VRX0dFTkVSQVRPUjoKICAgICAgICAgICAgICAgICAgICBy\nZXQgPSBzdGFydFNlcXVlbmNlR2VuZXJhdG9yKGF0dHJzKTsKICAgICAgICAg\nICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgRkxVU0hf\nTU9ERToKICAgICAgICAgICAgICAgICAgICByZXQgPSBzdGFydEZsdXNoTW9k\nZShhdHRycyk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAg\nICAgICAgICBjYXNlIEVOVElUWV9MSVNURU5FUlM6CiAgICAgICAgICAgICAg\nICAgICAgcmV0ID0gc3RhcnRFbnRpdHlMaXN0ZW5lcnMoYXR0cnMpOwogICAg\nICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSBQ\nUkVfUEVSU0lTVDoKICAgICAgICAgICAgICAgIGNhc2UgUE9TVF9QRVJTSVNU\nOgogICAgICAgICAgICAgICAgY2FzZSBQUkVfUkVNT1ZFOgogICAgICAgICAg\nICAgICAgY2FzZSBQT1NUX1JFTU9WRToKICAgICAgICAgICAgICAgIGNhc2Ug\nUFJFX1VQREFURToKICAgICAgICAgICAgICAgIGNhc2UgUE9TVF9VUERBVEU6\nCiAgICAgICAgICAgICAgICBjYXNlIFBPU1RfTE9BRDoKICAgICAgICAgICAg\nICAgICAgICByZXQgPSBzdGFydENhbGxiYWNrKChNZXRhRGF0YVRhZykgdGFn\nLCBhdHRycyk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAg\nICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgICAgICAgIHdhcm5VbnN1\ncHBvcnRlZFRhZyhuYW1lKTsKICAgICAgICAgICAgfQogICAgICAgIH0gZWxz\nZSBpZiAodGFnID09IEVMRU1fUFVfTUVUQSB8fCB0YWcgPT0gRUxFTV9QVV9E\nRUYpCiAgICAgICAgICAgIHJldCA9IGlzTWV0YURhdGFNb2RlKCk7CiAgICAg\nICAgZWxzZSBpZiAodGFnID09IEVMRU1fWE1MX01BUF9NRVRBX0NPTVBMRVRF\nKSB7CiAgICAgICAgICAgIHNldEFubm90YXRpb25QYXJzZXIobnVsbCk7CiAg\nICAgICAgICAgIF9pc1hNTE1hcHBpbmdNZXRhRGF0YUNvbXBsZXRlID0gdHJ1\nZTsKICAgICAgICB9CiAgICAgICAgZWxzZSBpZiAodGFnID09IEVMRU1fQUND\nRVNTKQogICAgICAgICAgICByZXQgPSBfbW9kZSAhPSBNT0RFX1FVRVJZOwog\nICAgICAgIGVsc2UgaWYgKHRhZyA9PSBFTEVNX0xJU1RFTkVSKQogICAgICAg\nICAgICByZXQgPSBzdGFydEVudGl0eUxpc3RlbmVyKGF0dHJzKTsKICAgICAg\nICBlbHNlIGlmICh0YWcgPT0gRUxFTV9ERUxJTV9JRFMpCiAgICAgICAgICAg\nIHJldCA9IHN0YXJ0RGVsaW1pdGVkSWRlbnRpZmllcnMoKTsKICAgICAgICBl\nbHNlIGlmICh0YWcgPT0gRUxFTV9DQVNDQURFKQogICAgICAgICAgICByZXQg\nPSBpc01ldGFEYXRhTW9kZSgpOwogICAgICAgIGVsc2UgaWYgKHRhZyA9PSBF\nTEVNX0NBU0NBREVfQUxMIHx8IHRhZyA9PSBFTEVNX0NBU0NBREVfUEVSCiAg\nICAgICAgICAgIHx8IHRhZyA9PSBFTEVNX0NBU0NBREVfTUVSIHx8IHRhZyA9\nPSBFTEVNX0NBU0NBREVfUkVNCiAgICAgICAgICAgIHx8IHRhZyA9PSBFTEVN\nX0NBU0NBREVfUkVGIHx8IHRhZyA9PSBFTEVNX0NBU0NBREVfREVUKQogICAg\nICAgICAgICByZXQgPSBzdGFydENhc2NhZGUodGFnLCBhdHRycyk7CgogICAg\nICAgIGlmIChyZXQpCiAgICAgICAgICAgIF9wYXJlbnRzLnB1c2godGFnKTsK\nICAgICAgICByZXR1cm4gcmV0OwogICAgfQoKICAgIEBPdmVycmlkZQogICAg\ncHJvdGVjdGVkIHZvaWQgZW5kU3lzdGVtRWxlbWVudChTdHJpbmcgbmFtZSkK\nICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICBPYmplY3Qg\ndGFnID0gX2VsZW1zLmdldChuYW1lKTsKICAgICAgICBpZiAodGFnID09IG51\nbGwgJiYgaXNNYXBwaW5nT3ZlcnJpZGVNb2RlKCkpCiAgICAgICAgICAgIGVu\nZFN5c3RlbU1hcHBpbmdFbGVtZW50KG5hbWUpOwogICAgICAgIGVsc2UgaWYg\nKHRhZyBpbnN0YW5jZW9mIE1ldGFEYXRhVGFnKSB7CiAgICAgICAgICAgIHN3\naXRjaCAoKE1ldGFEYXRhVGFnKSB0YWcpIHsKICAgICAgICAgICAgICAgIGNh\nc2UgUVVFUlk6CiAgICAgICAgICAgICAgICAgICAgZW5kTmFtZWRRdWVyeSgp\nOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAg\nY2FzZSBRVUVSWV9ISU5UOgogICAgICAgICAgICAgICAgICAgIGVuZFF1ZXJ5\nSGludCgpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAg\nICAgICAgY2FzZSBOQVRJVkVfUVVFUlk6CiAgICAgICAgICAgICAgICAgICAg\nZW5kTmFtZWROYXRpdmVRdWVyeSgpOwogICAgICAgICAgICAgICAgICAgIGJy\nZWFrOwogICAgICAgICAgICAgICAgY2FzZSBRVUVSWV9TVFJJTkc6CiAgICAg\nICAgICAgICAgICAgICAgZW5kUXVlcnlTdHJpbmcoKTsKICAgICAgICAgICAg\nICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgU0VRX0dFTkVS\nQVRPUjoKICAgICAgICAgICAgICAgICAgICBlbmRTZXF1ZW5jZUdlbmVyYXRv\ncigpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9\nCiAgICAgICAgfSBlbHNlIGlmICh0YWcgPT0gRUxFTV9BQ0NFU1MpCiAgICAg\nICAgICAgIGVuZEFjY2VzcygpOwogICAgICAgIGVsc2UgaWYgKHRhZyA9PSBF\nTEVNX0xJU1RFTkVSKQogICAgICAgICAgICBlbmRFbnRpdHlMaXN0ZW5lcigp\nOwoKICAgICAgICBfcGFyZW50cy5wb3AoKTsKICAgIH0KCiAgICAvKioKICAg\nICAqIEltcGxlbWVudCB0byBwYXJzZSBhIG1hcHBpbmcgZWxlbWVudCBvdXRz\naWRlIG9mIGFueSBjbGFzcy4KICAgICAqCiAgICAgKiBAcmV0dXJuIHRoZSB0\nYWcgZm9yIHRoZSBnaXZlbiBlbGVtZW50LCBvciBudWxsIHRvIHNraXAgdGhl\nIGVsZW1lbnQKICAgICAqLwogICAgcHJvdGVjdGVkIE9iamVjdCBzdGFydFN5\nc3RlbU1hcHBpbmdFbGVtZW50KFN0cmluZyBuYW1lLCBBdHRyaWJ1dGVzIGF0\ndHJzKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24gewogICAgICAgIHJl\ndHVybiBudWxsOwogICAgfQoKICAgIC8qKgogICAgICogSW1wbGVtZW50IHRv\nIHBhcnNlIGEgbWFwcGluZyBlbGVtZW50IG91dHNpZGUgb2YgYW55IGNsYXNz\nLgogICAgICovCiAgICBwcm90ZWN0ZWQgdm9pZCBlbmRTeXN0ZW1NYXBwaW5n\nRWxlbWVudChTdHJpbmcgbmFtZSkKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0\naW9uIHsKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHByb3RlY3RlZCBib29s\nZWFuIHN0YXJ0Q2xhc3NFbGVtZW50KFN0cmluZyBuYW1lLCBBdHRyaWJ1dGVz\nIGF0dHJzKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24gewogICAgICAg\nIE9iamVjdCB0YWcgPSAoT2JqZWN0KSBfZWxlbXMuZ2V0KG5hbWUpOwogICAg\nICAgIGJvb2xlYW4gcmV0ID0gZmFsc2U7CiAgICAgICAgaWYgKHRhZyA9PSBu\ndWxsKSB7CiAgICAgICAgICAgIGlmIChpc01hcHBpbmdPdmVycmlkZU1vZGUo\nKSkKICAgICAgICAgICAgICAgIHRhZyA9IHN0YXJ0Q2xhc3NNYXBwaW5nRWxl\nbWVudChuYW1lLCBhdHRycyk7CiAgICAgICAgICAgIHJldCA9IHRhZyAhPSBu\ndWxsOwogICAgICAgIH0gZWxzZSBpZiAodGFnIGluc3RhbmNlb2YgTWV0YURh\ndGFUYWcpIHsKICAgICAgICAgICAgc3dpdGNoICgoTWV0YURhdGFUYWcpIHRh\nZykgewogICAgICAgICAgICAgICAgY2FzZSBHRU5FUkFURURfVkFMVUU6CiAg\nICAgICAgICAgICAgICAgICAgcmV0ID0gc3RhcnRHZW5lcmF0ZWRWYWx1ZShh\ndHRycyk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAg\nICAgICBjYXNlIElEOgogICAgICAgICAgICAgICAgICAgIHJldCA9IHN0YXJ0\nSWQoYXR0cnMpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAg\nICAgICAgICAgY2FzZSBFTUJFRERFRF9JRDoKICAgICAgICAgICAgICAgICAg\nICByZXQgPSBzdGFydEVtYmVkZGVkSWQoYXR0cnMpOwogICAgICAgICAgICAg\nICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSBJRF9DTEFTUzoK\nICAgICAgICAgICAgICAgICAgICByZXQgPSBzdGFydElkQ2xhc3MoYXR0cnMp\nOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAg\nY2FzZSBMT0I6CiAgICAgICAgICAgICAgICAgICAgcmV0ID0gc3RhcnRMb2Io\nYXR0cnMpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAg\nICAgICAgY2FzZSBRVUVSWToKICAgICAgICAgICAgICAgICAgICByZXQgPSBz\ndGFydE5hbWVkUXVlcnkoYXR0cnMpOwogICAgICAgICAgICAgICAgICAgIGJy\nZWFrOwogICAgICAgICAgICAgICAgY2FzZSBRVUVSWV9ISU5UOgogICAgICAg\nICAgICAgICAgICAgIHJldCA9IHN0YXJ0UXVlcnlIaW50KGF0dHJzKTsKICAg\nICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2Ug\nTkFUSVZFX1FVRVJZOgogICAgICAgICAgICAgICAgICAgIHJldCA9IHN0YXJ0\nTmFtZWROYXRpdmVRdWVyeShhdHRycyk7CiAgICAgICAgICAgICAgICAgICAg\nYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIFFVRVJZX1NUUklORzoKICAg\nICAgICAgICAgICAgICAgICByZXQgPSBzdGFydFF1ZXJ5U3RyaW5nKGF0dHJz\nKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAg\nIGNhc2UgU0VRX0dFTkVSQVRPUjoKICAgICAgICAgICAgICAgICAgICByZXQg\nPSBzdGFydFNlcXVlbmNlR2VuZXJhdG9yKGF0dHJzKTsKICAgICAgICAgICAg\nICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgVkVSU0lPTjoK\nICAgICAgICAgICAgICAgICAgICByZXQgPSBzdGFydFZlcnNpb24oYXR0cnMp\nOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAg\nY2FzZSBNQVBfS0VZOgogICAgICAgICAgICAgICAgICAgIHJldCA9IHN0YXJ0\nTWFwS2V5KGF0dHJzKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAg\nICAgICAgICAgICAgIGNhc2UgTUFQX0tFWV9DTEFTUzoKICAgICAgICAgICAg\nICAgICAgICByZXQgPSBzdGFydE1hcEtleUNsYXNzKGF0dHJzKTsKICAgICAg\nICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgRkxV\nU0hfTU9ERToKICAgICAgICAgICAgICAgICAgICByZXQgPSBzdGFydEZsdXNo\nTW9kZShhdHRycyk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAg\nICAgICAgICAgICBjYXNlIE9SREVSX0NPTFVNTjoKICAgICAgICAgICAgICAg\nICAgICByZXQgPSBzdGFydE9yZGVyQ29sdW1uKGF0dHJzKTsKICAgICAgICAg\nICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgT1JERVJf\nQlk6CiAgICAgICAgICAgICAgICBjYXNlIEVOVElUWV9MSVNURU5FUlM6CiAg\nICAgICAgICAgICAgICAgICAgcmV0ID0gaXNNZXRhRGF0YU1vZGUoKTsKICAg\nICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2Ug\nRVhDTFVERV9ERUZBVUxUX0xJU1RFTkVSUzoKICAgICAgICAgICAgICAgICAg\nICByZXQgPSBzdGFydEV4Y2x1ZGVEZWZhdWx0TGlzdGVuZXJzKGF0dHJzKTsK\nICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNh\nc2UgRVhDTFVERV9TVVBFUkNMQVNTX0xJU1RFTkVSUzoKICAgICAgICAgICAg\nICAgICAgICByZXQgPSBzdGFydEV4Y2x1ZGVTdXBlcmNsYXNzTGlzdGVuZXJz\nKGF0dHJzKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAg\nICAgICAgIGNhc2UgUFJFX1BFUlNJU1Q6CiAgICAgICAgICAgICAgICBjYXNl\nIFBPU1RfUEVSU0lTVDoKICAgICAgICAgICAgICAgIGNhc2UgUFJFX1JFTU9W\nRToKICAgICAgICAgICAgICAgIGNhc2UgUE9TVF9SRU1PVkU6CiAgICAgICAg\nICAgICAgICBjYXNlIFBSRV9VUERBVEU6CiAgICAgICAgICAgICAgICBjYXNl\nIFBPU1RfVVBEQVRFOgogICAgICAgICAgICAgICAgY2FzZSBQT1NUX0xPQUQ6\nCiAgICAgICAgICAgICAgICAgICAgcmV0ID0gc3RhcnRDYWxsYmFjaygoTWV0\nYURhdGFUYWcpIHRhZywgYXR0cnMpOwogICAgICAgICAgICAgICAgICAgIGJy\nZWFrOwogICAgICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAg\nICAgICB3YXJuVW5zdXBwb3J0ZWRUYWcobmFtZSk7CiAgICAgICAgICAgIH0K\nICAgICAgICB9IGVsc2UgaWYgKHRhZyBpbnN0YW5jZW9mIFBlcnNpc3RlbmNl\nU3RyYXRlZ3kpIHsKICAgICAgICAgICAgUGVyc2lzdGVuY2VTdHJhdGVneSBw\ncyA9IChQZXJzaXN0ZW5jZVN0cmF0ZWd5KSB0YWc7CiAgICAgICAgICAgIHJl\ndCA9IHN0YXJ0U3RyYXRlZ3kocHMsIGF0dHJzKTsKICAgICAgICAgICAgaWYg\nKHJldCkKICAgICAgICAgICAgICAgIF9zdHJhdGVneSA9IHBzOwogICAgICAg\nIH0gZWxzZSBpZiAodGFnID09IEVMRU1fTElTVEVORVIpCiAgICAgICAgICAg\nIHJldCA9IHN0YXJ0RW50aXR5TGlzdGVuZXIoYXR0cnMpOwogICAgICAgIGVs\nc2UgaWYgKHRhZyA9PSBFTEVNX0FUVFJTKQogICAgICAgICAgICByZXQgPSBf\nbW9kZSAhPSBNT0RFX1FVRVJZOwogICAgICAgIGVsc2UgaWYgKHRhZyA9PSBF\nTEVNX0NBU0NBREUpCiAgICAgICAgICAgIHJldCA9IGlzTWV0YURhdGFNb2Rl\nKCk7CiAgICAgICAgZWxzZSBpZiAodGFnID09IEVMRU1fQ0FTQ0FERV9BTEwg\nfHwgdGFnID09IEVMRU1fQ0FTQ0FERV9QRVIKICAgICAgICAgICAgfHwgdGFn\nID09IEVMRU1fQ0FTQ0FERV9NRVIgfHwgdGFnID09IEVMRU1fQ0FTQ0FERV9S\nRU0KICAgICAgICAgICAgfHwgdGFnID09IEVMRU1fQ0FTQ0FERV9SRUYgfHwg\ndGFnID09IEVMRU1fQ0FTQ0FERV9ERVQpCiAgICAgICAgICAgIHJldCA9IHN0\nYXJ0Q2FzY2FkZSh0YWcsIGF0dHJzKTsKCiAgICAgICAgaWYgKHJldCkKICAg\nICAgICAgICAgX3BhcmVudHMucHVzaCh0YWcpOwogICAgICAgIHJldHVybiBy\nZXQ7CiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwcm90ZWN0ZWQgdm9pZCBl\nbmRDbGFzc0VsZW1lbnQoU3RyaW5nIG5hbWUpCiAgICAgICAgdGhyb3dzIFNB\nWEV4Y2VwdGlvbiB7CiAgICAgICAgT2JqZWN0IHRhZyA9IF9lbGVtcy5nZXQo\nbmFtZSk7CiAgICAgICAgaWYgKHRhZyA9PSBudWxsICYmIGlzTWFwcGluZ092\nZXJyaWRlTW9kZSgpKQogICAgICAgICAgICBlbmRDbGFzc01hcHBpbmdFbGVt\nZW50KG5hbWUpOwogICAgICAgIGVsc2UgaWYgKHRhZyBpbnN0YW5jZW9mIE1l\ndGFEYXRhVGFnKSB7CiAgICAgICAgICAgIHN3aXRjaCAoKE1ldGFEYXRhVGFn\nKSB0YWcpIHsKICAgICAgICAgICAgICAgIGNhc2UgR0VORVJBVEVEX1ZBTFVF\nOgogICAgICAgICAgICAgICAgICAgIGVuZEdlbmVyYXRlZFZhbHVlKCk7CiAg\nICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNl\nIElEOgogICAgICAgICAgICAgICAgICAgIGVuZElkKCk7CiAgICAgICAgICAg\nICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIEVNQkVEREVE\nX0lEOgogICAgICAgICAgICAgICAgICAgIGVuZEVtYmVkZGVkSWQoKTsKICAg\nICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2Ug\nSURfQ0xBU1M6CiAgICAgICAgICAgICAgICAgICAgZW5kSWRDbGFzcygpOwog\nICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2Fz\nZSBMT0I6CiAgICAgICAgICAgICAgICAgICAgZW5kTG9iKCk7CiAgICAgICAg\nICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIFFVRVJZ\nOgogICAgICAgICAgICAgICAgICAgIGVuZE5hbWVkUXVlcnkoKTsKICAgICAg\nICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgUVVF\nUllfSElOVDoKICAgICAgICAgICAgICAgICAgICBlbmRRdWVyeUhpbnQoKTsK\nICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNh\nc2UgTkFUSVZFX1FVRVJZOgogICAgICAgICAgICAgICAgICAgIGVuZE5hbWVk\nTmF0aXZlUXVlcnkoKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAg\nICAgICAgICAgICAgIGNhc2UgUVVFUllfU1RSSU5HOgogICAgICAgICAgICAg\nICAgICAgIGVuZFF1ZXJ5U3RyaW5nKCk7CiAgICAgICAgICAgICAgICAgICAg\nYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIFNFUV9HRU5FUkFUT1I6CiAg\nICAgICAgICAgICAgICAgICAgZW5kU2VxdWVuY2VHZW5lcmF0b3IoKTsKICAg\nICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2Ug\nVkVSU0lPTjoKICAgICAgICAgICAgICAgICAgICBlbmRWZXJzaW9uKCk7CiAg\nICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNl\nIE9SREVSX0JZOgogICAgICAgICAgICAgICAgICAgIGVuZE9yZGVyQnkoKTsK\nICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAg\nICAgIH0gZWxzZSBpZiAodGFnIGluc3RhbmNlb2YgUGVyc2lzdGVuY2VTdHJh\ndGVneSkKICAgICAgICAgICAgZW5kU3RyYXRlZ3koKFBlcnNpc3RlbmNlU3Ry\nYXRlZ3kpIHRhZyk7CiAgICAgICAgZWxzZSBpZiAodGFnID09IEVMRU1fQUND\nRVNTKQogICAgICAgICAgICBlbmRBY2Nlc3MoKTsKICAgICAgICBlbHNlIGlm\nICh0YWcgPT0gRUxFTV9MSVNURU5FUikKICAgICAgICAgICAgZW5kRW50aXR5\nTGlzdGVuZXIoKTsKCiAgICAgICAgX3BhcmVudHMucG9wKCk7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBMb2cgd2FybmluZyBhYm91dCBhbiB1bnN1cHBvcnRl\nZCB0YWcuCiAgICAgKi8KICAgIHByaXZhdGUgdm9pZCB3YXJuVW5zdXBwb3J0\nZWRUYWcoU3RyaW5nIG5hbWUpIHsKICAgICAgICBMb2cgbG9nID0gZ2V0TG9n\nKCk7CiAgICAgICAgaWYgKGxvZy5pc0luZm9FbmFibGVkKCkpCiAgICAgICAg\nICAgIGxvZy50cmFjZShfbG9jLmdldCgidW5zdXBwb3J0ZWQtdGFnIiwgbmFt\nZSkpOwogICAgfQoKICAgIC8qKgogICAgICogSW1wbGVtZW50IHRvIHBhcnNl\nIGEgbWFwcGluZyBlbGVtZW50IHdpdGhpbiBhIGNsYXNzLgogICAgICoKICAg\nICAqIEByZXR1cm4gdGhlIHRhZyBmb3IgdGhlIGdpdmVuIGVsZW1lbnQsIG9y\nIG51bGwgdG8gc2tpcCBlbGVtZW50CiAgICAgKi8KICAgIHByb3RlY3RlZCBP\nYmplY3Qgc3RhcnRDbGFzc01hcHBpbmdFbGVtZW50KFN0cmluZyBuYW1lLCBB\ndHRyaWJ1dGVzIGF0dHJzKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24g\newogICAgICAgIHJldHVybiBudWxsOwogICAgfQoKICAgIC8qKgogICAgICog\nSW1wbGVtZW50IHRvIHBhcnNlIGEgbWFwcGluZyBlbGVtZW50IHdpdGhpbiBh\nIGNsYXNzLgogICAgICovCiAgICBwcm90ZWN0ZWQgdm9pZCBlbmRDbGFzc01h\ncHBpbmdFbGVtZW50KFN0cmluZyBuYW1lKQogICAgICAgIHRocm93cyBTQVhF\neGNlcHRpb24gewogICAgfQoKICAgIGJvb2xlYW4gaXNNZXRhRGF0YUNvbXBs\nZXRlKEF0dHJpYnV0ZXMgYXR0cnMpIHsKICAgIAlyZXR1cm4gYXR0cnMgIT0g\nbnVsbAogICAgCSAgICAmJiAidHJ1ZSIuZXF1YWxzKGF0dHJzLmdldFZhbHVl\nKCJtZXRhZGF0YS1jb21wbGV0ZSIpKTsKICAgIH0KCiAgICB2b2lkIHJlc2V0\nQW5ub3RhdGlvblBhcnNlcigpIHsKICAgIAlzZXRBbm5vdGF0aW9uUGFyc2Vy\nKCgoUGVyc2lzdGVuY2VNZXRhRGF0YUZhY3RvcnkpZ2V0UmVwb3NpdG9yeSgp\nCiAgICAJCQkuZ2V0TWV0YURhdGFGYWN0b3J5KCkpLmdldEFubm90YXRpb25Q\nYXJzZXIoKSk7CiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwcm90ZWN0ZWQg\nYm9vbGVhbiBzdGFydENsYXNzKFN0cmluZyBlbGVtLCBBdHRyaWJ1dGVzIGF0\ndHJzKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24gewogICAgICAgIGJv\nb2xlYW4gbWV0YURhdGFDb21wbGV0ZSA9IGZhbHNlOwogICAgICAgIHN1cGVy\nLnN0YXJ0Q2xhc3MoZWxlbSwgYXR0cnMpOwogICAgICAgIGlmIChpc01ldGFE\nYXRhQ29tcGxldGUoYXR0cnMpKSB7CiAgICAgICAgICAgIG1ldGFEYXRhQ29t\ncGxldGUgPSB0cnVlOwogICAgICAgIAlzZXRBbm5vdGF0aW9uUGFyc2VyKG51\nbGwpOwogICAgICAgIH0gZWxzZSBpZiAoIV9pc1hNTE1hcHBpbmdNZXRhRGF0\nYUNvbXBsZXRlKXsKICAgICAgICAJcmVzZXRBbm5vdGF0aW9uUGFyc2VyKCk7\nCiAgICAgICAgfQoKICAgICAgICAvLyBxdWVyeSBtb2RlIG9ubHk/CiAgICAg\nICAgX2NscyA9IGNsYXNzRm9yTmFtZShjdXJyZW50Q2xhc3NOYW1lKCkpOwoK\nICAgICAgICAvLyBQcmV2ZW50IGEgcmVlbnRyYW50IHBhcnNlIGZvciB0aGUg\nc2FtZSBjbGFzcwogICAgICAgIGlmIChwYXJzZUxpc3RDb250YWlucyhfY2xz\nKSkgewogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQoKICAg\nICAgICBpZiAoX21vZGUgPT0gTU9ERV9RVUVSWSkgewogICAgICAgICAgICBp\nZiAoX3BhcnNlciAhPSBudWxsKQogICAgICAgICAgICAgICAgX3BhcnNlci5w\nYXJzZShfY2xzKTsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAg\nfQoKICAgICAgICBMb2cgbG9nID0gZ2V0TG9nKCk7CiAgICAgICAgaWYgKGxv\nZy5pc1RyYWNlRW5hYmxlZCgpKQogICAgICAgICAgICBsb2cudHJhY2UoX2xv\nYy5nZXQoInBhcnNlLWNsYXNzIiwgX2Nscy5nZXROYW1lKCkpKTsKCiAgICAg\nICAgTWV0YURhdGFSZXBvc2l0b3J5IHJlcG9zID0gZ2V0UmVwb3NpdG9yeSgp\nOwogICAgICAgIENsYXNzTWV0YURhdGEgbWV0YSA9IHJlcG9zLmdldENhY2hl\nZE1ldGFEYXRhKF9jbHMpOwogICAgICAgIGlmIChtZXRhICE9IG51bGwKICAg\nICAgICAgICAgJiYgKChpc01ldGFEYXRhTW9kZSgpICYmIChtZXRhLmdldFNv\ndXJjZU1vZGUoKSAmIE1PREVfTUVUQSkgIT0gMCkKICAgICAgICAgICAgfHwg\nKGlzTWFwcGluZ01vZGUoKSAmJiAobWV0YS5nZXRTb3VyY2VNb2RlKCkgJiBN\nT0RFX01BUFBJTkcpICE9IDApKSkKICAgICAgICB7CiAgICAgICAgICAgIGlm\nIChsb2cuaXNXYXJuRW5hYmxlZCgpKQogICAgICAgICAgICAgICAgbG9nLndh\ncm4oX2xvYy5nZXQoImR1cC1tZXRhZGF0YSIsIF9jbHMsIGdldFNvdXJjZU5h\nbWUoKSkpOwogICAgICAgICAgICBfY2xzID0gbnVsbDsKICAgICAgICAgICAg\ncmV0dXJuIGZhbHNlOwogICAgICAgIH0KCiAgICAgICAgaW50IGFjY2VzcyA9\nIEFjY2Vzc0NvZGUuVU5LTk9XTjsKICAgICAgICBpZiAobWV0YSA9PSBudWxs\nKSB7CiAgICAgICAgICAgIGludCBhY2Nlc3NDb2RlID0gdG9BY2Nlc3NUeXBl\nKGF0dHJzLmdldFZhbHVlKCJhY2Nlc3MiKSk7CiAgICAgICAgICAgIC8vIGlm\nIGFjY2VzcyBub3Qgc3BlY2lmaWVkIGFuZCBhY2Nlc3Mgd2FzIHNwZWNpZmll\nZCBhdAogICAgICAgICAgICAvLyB0aGUgc3lzdGVtIGxldmVsLCB1c2UgdGhl\nIHN5c3RlbSBkZWZhdWx0ICh3aGljaCBtYXkKICAgICAgICAgICAgLy8gYmUg\nVU5LTk9XTikKICAgICAgICAgICAgaWYgKGFjY2Vzc0NvZGUgPT0gQWNjZXNz\nQ29kZS5VTktOT1dOKQogICAgICAgICAgICAgICAgYWNjZXNzQ29kZSA9IF9h\nY2Nlc3M7CiAgICAgICAgICAgIG1ldGEgPSByZXBvcy5hZGRNZXRhRGF0YShf\nY2xzLCBhY2Nlc3NDb2RlLCBtZXRhRGF0YUNvbXBsZXRlKTsKICAgICAgICAg\nICAgRmllbGRNZXRhRGF0YVtdIGZtZHMgPSBtZXRhLmdldEZpZWxkcygpOwog\nICAgICAgICAgICBpZiAobWV0YURhdGFDb21wbGV0ZSkgewogICAgICAgICAg\nICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBmbWRzLmxlbmd0aDsgaSsrKSB7\nCiAgICAgICAgICAgICAgICAgICAgZm1kc1tpXS5zZXRFeHBsaWNpdCh0cnVl\nKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAg\nICBtZXRhLnNldEVudkNsYXNzTG9hZGVyKF9lbnZMb2FkZXIpOwogICAgICAg\nICAgICBtZXRhLnNldFNvdXJjZU1vZGUoTU9ERV9OT05FKTsKCiAgICAgICAg\nICAgIC8vIHBhcnNlIGFubm90YXRpb25zIGZpcnN0IHNvIFhNTCBvdmVycmlk\nZXMgdGhlbQogICAgICAgICAgICBpZiAoX3BhcnNlciAhPSBudWxsKQogICAg\nICAgICAgICAgICAgX3BhcnNlci5wYXJzZShfY2xzKTsKICAgICAgICB9CiAg\nICAgICAgYWNjZXNzID0gbWV0YS5nZXRBY2Nlc3NUeXBlKCk7CgogICAgICAg\nIGJvb2xlYW4gbWFwcGVkU3VwZXIgPSAibWFwcGVkLXN1cGVyY2xhc3MiLmVx\ndWFscyhlbGVtKTsKICAgICAgICBib29sZWFuIGVtYmVkZGFibGUgPSAiZW1i\nZWRkYWJsZSIuZXF1YWxzKGVsZW0pOwogICAgICAgIGlmIChpc01ldGFEYXRh\nTW9kZSgpKSB7CiAgICAgICAgICAgIG1ldGEuc2V0U291cmNlKGdldFNvdXJj\nZUZpbGUoKSwgU291cmNlVHJhY2tlci5TUkNfWE1MKTsKICAgICAgICAgICAg\nbWV0YS5zZXRTb3VyY2VNb2RlKE1PREVfTUVUQSwgdHJ1ZSk7CiAgICAgICAg\nICAgIExvY2F0b3IgbG9jYXRvciA9IGdldExvY2F0aW9uKCkuZ2V0TG9jYXRv\ncigpOwogICAgICAgICAgICBpZiAobG9jYXRvciAhPSBudWxsKSB7CiAgICAg\nICAgICAgICAgICBtZXRhLnNldExpbmVOdW1iZXIoTnVtYmVycy52YWx1ZU9m\nKGxvY2F0b3IuZ2V0TGluZU51bWJlcigpKSk7CiAgICAgICAgICAgICAgICBt\nZXRhLnNldENvbE51bWJlcihOdW1iZXJzLnZhbHVlT2YobG9jYXRvci5nZXRD\nb2x1bW5OdW1iZXIoKSkpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIG1l\ndGEuc2V0TGlzdGluZ0luZGV4KF9jbHNQb3MpOwogICAgICAgICAgICBTdHJp\nbmcgbmFtZSA9IGF0dHJzLmdldFZhbHVlKCJuYW1lIik7CiAgICAgICAgICAg\nIGlmICghU3RyaW5nVXRpbHMuaXNFbXB0eShuYW1lKSkKICAgICAgICAgICAg\nICAgIG1ldGEuc2V0VHlwZUFsaWFzKG5hbWUpOwogICAgICAgICAgICBtZXRh\nLnNldEFic3RyYWN0KG1hcHBlZFN1cGVyKTsKICAgICAgICAgICAgbWV0YS5z\nZXRFbWJlZGRlZE9ubHkobWFwcGVkU3VwZXIgfHwgZW1iZWRkYWJsZSk7Cgog\nICAgICAgICAgICBpZiAoZW1iZWRkYWJsZSkgewogICAgICAgICAgICAgICAg\nbWV0YS5zZXRFbWJlZGRhYmxlKCk7CiAgICAgICAgICAgICAgICBzZXREZWZl\ncnJlZEVtYmVkZGFibGVBY2Nlc3NUeXBlKF9jbHMsIGFjY2Vzcyk7CiAgICAg\nICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGlmIChhdHRycy5nZXRWYWx1\nZSgiY2FjaGVhYmxlIikgIT0gbnVsbCkgewogICAgICAgICAgICBtZXRhLnNl\ndENhY2hlRW5hYmxlZChCb29sZWFuLnZhbHVlT2YoYXR0cnMuZ2V0VmFsdWUo\nImNhY2hlYWJsZSIpKSk7CiAgICAgICAgfQoKICAgICAgICBpZiAoaXNNYXBw\naW5nTW9kZSgpKQogICAgICAgICAgICBtZXRhLnNldFNvdXJjZU1vZGUoTU9E\nRV9NQVBQSU5HLCB0cnVlKTsKICAgICAgICBpZiAoaXNNYXBwaW5nT3ZlcnJp\nZGVNb2RlKCkpCiAgICAgICAgICAgIHN0YXJ0Q2xhc3NNYXBwaW5nKG1ldGEs\nIG1hcHBlZFN1cGVyLCBhdHRycyk7CiAgICAgICAgaWYgKGlzUXVlcnlNb2Rl\nKCkpCiAgICAgICAgICAgIG1ldGEuc2V0U291cmNlTW9kZShNT0RFX1FVRVJZ\nLCB0cnVlKTsKCiAgICAgICAgX2Nsc1BvcysrOwogICAgICAgIF9maWVsZFBv\ncyA9IDA7CiAgICAgICAgYWRkQ29tbWVudHMobWV0YSk7CiAgICAgICAgcHVz\naEVsZW1lbnQobWV0YSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9Cgog\nICAgQE92ZXJyaWRlCiAgICBwcm90ZWN0ZWQgdm9pZCBlbmRDbGFzcyhTdHJp\nbmcgZWxlbSkKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAg\nICBpZiAoX21vZGUgIT0gTU9ERV9RVUVSWSkgewogICAgICAgICAgICBDbGFz\nc01ldGFEYXRhIG1ldGEgPSAoQ2xhc3NNZXRhRGF0YSkgcG9wRWxlbWVudCgp\nOwogICAgICAgICAgICBzdG9yZUNhbGxiYWNrcyhtZXRhKTsKICAgICAgICAg\nICAgaWYgKGlzTWFwcGluZ092ZXJyaWRlTW9kZSgpKQogICAgICAgICAgICAg\nICAgZW5kQ2xhc3NNYXBwaW5nKG1ldGEpOwogICAgICAgIH0KICAgICAgICBf\nY2xzID0gbnVsbDsKICAgICAgICBzdXBlci5lbmRDbGFzcyhlbGVtKTsKICAg\nIH0KCiAgICAvKioKICAgICAqIEltcGxlbWVudCB0byBhZGQgbWFwcGluZyBh\ndHRyaWJ1dGVzIHRvIGNsYXNzLgogICAgICovCiAgICBwcm90ZWN0ZWQgdm9p\nZCBzdGFydENsYXNzTWFwcGluZyhDbGFzc01ldGFEYXRhIG1hcHBpbmcsCiAg\nICAgICAgYm9vbGVhbiBtYXBwZWRTdXBlciwgQXR0cmlidXRlcyBhdHRycykK\nICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgIH0KCiAgICAvKioK\nICAgICAqIEltcGxlbWVudCB0byBmaW5hbGl6ZSBjbGFzcyBtYXBwaW5nLgog\nICAgICovCiAgICBwcm90ZWN0ZWQgdm9pZCBlbmRDbGFzc01hcHBpbmcoQ2xh\nc3NNZXRhRGF0YSBtYXBwaW5nKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRp\nb24gewogICAgfQoKICAgIC8qKgogICAgICogRGVmYXVsdCBhY2Nlc3MgZWxl\nbWVudC4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIGVuZEFjY2VzcygpIHsK\nICAgICAgICBfYWNjZXNzID0gdG9BY2Nlc3NUeXBlKGN1cnJlbnRUZXh0KCkp\nOwogICAgfQoKICAgIC8qKgogICAgICogUGFyc2UgdGhlIGdpdmVuIHN0cmlu\nZyBhcyBhbiBlbnRpdHkgYWNjZXNzIHR5cGUsIGRlZmF1bHRpbmcgdG8gZ2l2\nZW4KICAgICAqIGRlZmF1bHQgaWYgc3RyaW5nIGlzIGVtcHR5LgogICAgICov\nCiAgICBwcml2YXRlIGludCB0b0FjY2Vzc1R5cGUoU3RyaW5nIHN0cikgewog\nICAgICAgIGlmIChTdHJpbmdVdGlscy5pc0VtcHR5KHN0cikpCiAgICAgICAg\nICAgIHJldHVybiBBY2Nlc3NDb2RlLlVOS05PV047CiAgICAgICAgaWYgKCJQ\nUk9QRVJUWSIuZXF1YWxzKHN0cikpCiAgICAgICAgICAgIHJldHVybiBBY2Nl\nc3NDb2RlLkVYUExJQ0lUIHwgQWNjZXNzQ29kZS5QUk9QRVJUWTsKICAgICAg\nICByZXR1cm4gQWNjZXNzQ29kZS5FWFBMSUNJVCB8IEFjY2Vzc0NvZGUuRklF\nTEQ7CiAgICB9CiAgICAvKioKICAgICAqIFBhcnNlIGZsdXNoLW1vZGUgZWxl\nbWVudC4KICAgICAqLwogICAgcHJpdmF0ZSBib29sZWFuIHN0YXJ0Rmx1c2hN\nb2RlKEF0dHJpYnV0ZXMgYXR0cnMpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2Vw\ndGlvbiB7CiAgICAgICAgTG9nIGxvZyA9IGdldExvZygpOwogICAgICAgIGlm\nIChsb2cuaXNXYXJuRW5hYmxlZCgpKQogICAgICAgICAgICBsb2cud2Fybihf\nbG9jLmdldCgidW5zdXBwb3J0ZWQiLCAiZmx1c2gtbW9kZSIsIGdldFNvdXJj\nZU5hbWUoKSkpOwogICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICAv\nKioKICAgICAqIFBhcnNlIHNlcXVlbmNlLWdlbmVyYXRvci4KICAgICAqLwog\nICAgcHJvdGVjdGVkIGJvb2xlYW4gc3RhcnRTZXF1ZW5jZUdlbmVyYXRvcihB\ndHRyaWJ1dGVzIGF0dHJzKSB7CiAgICAgICAgaWYgKCFpc01hcHBpbmdPdmVy\ncmlkZU1vZGUoKSkKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoKICAgICAg\nICBTdHJpbmcgbmFtZSA9IGF0dHJzLmdldFZhbHVlKCJuYW1lIik7CiAgICAg\nICAgTG9nIGxvZyA9IGdldExvZygpOwogICAgICAgIGlmIChsb2cuaXNUcmFj\nZUVuYWJsZWQoKSkKICAgICAgICAgICAgbG9nLnRyYWNlKF9sb2MuZ2V0KCJw\nYXJzZS1zZXF1ZW5jZSIsIG5hbWUpKTsKCiAgICAgICAgU2VxdWVuY2VNZXRh\nRGF0YSBtZXRhID0gZ2V0UmVwb3NpdG9yeSgpLmdldENhY2hlZFNlcXVlbmNl\nTWV0YURhdGEobmFtZSk7CiAgICAgICAgaWYgKG1ldGEgIT0gbnVsbCAmJiBs\nb2cuaXNXYXJuRW5hYmxlZCgpKQogICAgICAgICAgICBsb2cud2FybihfbG9j\nLmdldCgib3ZlcnJpZGUtc2VxdWVuY2UiLCBuYW1lKSk7CgogICAgICAgIG1l\ndGEgPSBnZXRSZXBvc2l0b3J5KCkuYWRkU2VxdWVuY2VNZXRhRGF0YShuYW1l\nKTsKICAgICAgICBTdHJpbmcgc2VxID0gYXR0cnMuZ2V0VmFsdWUoInNlcXVl\nbmNlLW5hbWUiKTsKICAgICAgICAvLyBEbyBub3Qgbm9ybWFsaXplIHRoZSBz\nZXF1ZW5jZSBuYW1lIGlmIGl0IGFwcGVhcnMgdG8gYmUgYSBwbHVnaW4gCiAg\nICAgICAgaWYgKHNlcS5pbmRleE9mKCcoJykgPT0gLTEpewogICAgICAgICAg\nICBzZXEgPSBub3JtYWxpemVTZXF1ZW5jZU5hbWUoc2VxKTsKICAgICAgICB9\nCiAgICAgICAgU3RyaW5nIHZhbCA9IGF0dHJzLmdldFZhbHVlKCJpbml0aWFs\nLXZhbHVlIik7CiAgICAgICAgaW50IGluaXRpYWwgPSB2YWwgPT0gbnVsbCA/\nIDEgOiBJbnRlZ2VyLnBhcnNlSW50KHZhbCk7CiAgICAgICAgdmFsID0gYXR0\ncnMuZ2V0VmFsdWUoImFsbG9jYXRpb24tc2l6ZSIpOwogICAgICAgIGludCBh\nbGxvY2F0ZSA9IHZhbCA9PSBudWxsID8gNTAgOiBJbnRlZ2VyLnBhcnNlSW50\nKHZhbCk7CiAgICAgICAgU3RyaW5nIHNjaGVtYSA9IG5vcm1hbGl6ZVNjaGVt\nYU5hbWUoYXR0cnMuZ2V0VmFsdWUoInNjaGVtYSIpKTsKICAgICAgICBTdHJp\nbmcgY2F0YWxvZyA9IG5vcm1hbGl6ZUNhdGFsb2dOYW1lKGF0dHJzLmdldFZh\nbHVlKCJjYXRhbG9nIikpOwoKICAgICAgICBTdHJpbmcgY2xzTmFtZSwgcHJv\ncHM7CiAgICAgICAgaWYgKHNlcSA9PSBudWxsIHx8IHNlcS5pbmRleE9mKCco\nJykgPT0gLTEpIHsKICAgICAgICAgICAgY2xzTmFtZSA9IFNlcXVlbmNlTWV0\nYURhdGEuSU1QTF9OQVRJVkU7CiAgICAgICAgICAgIHByb3BzID0gbnVsbDsK\nICAgICAgICB9IGVsc2UgeyAvLyBwbHVnaW4KICAgICAgICAgICAgY2xzTmFt\nZSA9IENvbmZpZ3VyYXRpb25zLmdldENsYXNzTmFtZShzZXEpOwogICAgICAg\nICAgICBwcm9wcyA9IENvbmZpZ3VyYXRpb25zLmdldFByb3BlcnRpZXMoc2Vx\nKTsKICAgICAgICAgICAgc2VxID0gbnVsbDsKICAgICAgICB9CgogICAgICAg\nIG1ldGEuc2V0U2VxdWVuY2VQbHVnaW4oQ29uZmlndXJhdGlvbnMuZ2V0UGx1\nZ2luKGNsc05hbWUsIHByb3BzKSk7CiAgICAgICAgbWV0YS5zZXRTZXF1ZW5j\nZShzZXEpOwogICAgICAgIG1ldGEuc2V0SW5pdGlhbFZhbHVlKGluaXRpYWwp\nOwogICAgICAgIG1ldGEuc2V0QWxsb2NhdGUoYWxsb2NhdGUpOwogICAgICAg\nIG1ldGEuc2V0U2NoZW1hKHNjaGVtYSk7CiAgICAgICAgbWV0YS5zZXRDYXRh\nbG9nKGNhdGFsb2cpOwoKICAgICAgICBPYmplY3QgY3VyID0gY3VycmVudEVs\nZW1lbnQoKTsKICAgICAgICBPYmplY3Qgc2NvcGUgPSAoY3VyIGluc3RhbmNl\nb2YgQ2xhc3NNZXRhRGF0YSkKICAgICAgICAgICAgPyAoKENsYXNzTWV0YURh\ndGEpIGN1cikuZ2V0RGVzY3JpYmVkVHlwZSgpIDogbnVsbDsKICAgICAgICBt\nZXRhLnNldFNvdXJjZShnZXRTb3VyY2VGaWxlKCksIHNjb3BlLCBTb3VyY2VU\ncmFja2VyLlNSQ19YTUwpOwogICAgICAgIExvY2F0b3IgbG9jYXRvciA9IGdl\ndExvY2F0aW9uKCkuZ2V0TG9jYXRvcigpOwogICAgICAgIGlmIChsb2NhdG9y\nICE9IG51bGwpIHsKICAgICAgICAgICAgbWV0YS5zZXRMaW5lTnVtYmVyKE51\nbWJlcnMudmFsdWVPZihsb2NhdG9yLmdldExpbmVOdW1iZXIoKSkpOwogICAg\nICAgICAgICBtZXRhLnNldENvbE51bWJlcihOdW1iZXJzLnZhbHVlT2YobG9j\nYXRvci5nZXRDb2x1bW5OdW1iZXIoKSkpOwogICAgICAgIH0KICAgICAgICBy\nZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBwcm90ZWN0ZWQgdm9pZCBlbmRTZXF1\nZW5jZUdlbmVyYXRvcigpIHsKICAgIH0KCiAgICAvKioKICAgICAqIFBhcnNl\nIGlkLgogICAgICovCiAgICBwcm90ZWN0ZWQgYm9vbGVhbiBzdGFydElkKEF0\ndHJpYnV0ZXMgYXR0cnMpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7\nCiAgICAgICAgRmllbGRNZXRhRGF0YSBmbWQgPSBwYXJzZUZpZWxkKGF0dHJz\nKTsKICAgICAgICBmbWQuc2V0RXhwbGljaXQodHJ1ZSk7CiAgICAgICAgZm1k\nLnNldFByaW1hcnlLZXkodHJ1ZSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAg\nICB9CgogICAgcHJvdGVjdGVkIHZvaWQgZW5kSWQoKQogICAgICAgIHRocm93\ncyBTQVhFeGNlcHRpb24gewogICAgICAgIGZpbmlzaEZpZWxkKCk7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBQYXJzZSBlbWJlZGRlZC1pZC4KICAgICAqLwog\nICAgcHJvdGVjdGVkIGJvb2xlYW4gc3RhcnRFbWJlZGRlZElkKEF0dHJpYnV0\nZXMgYXR0cnMpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAg\nICAgRmllbGRNZXRhRGF0YSBmbWQgPSBwYXJzZUZpZWxkKGF0dHJzKTsKICAg\nICAgICBmbWQuc2V0RXhwbGljaXQodHJ1ZSk7CiAgICAgICAgZm1kLnNldFBy\naW1hcnlLZXkodHJ1ZSk7CiAgICAgICAgZm1kLnNldEVtYmVkZGVkKHRydWUp\nOwogICAgICAgIGZtZC5zZXRTZXJpYWxpemVkKGZhbHNlKTsKICAgICAgICBp\nZiAoZm1kLmdldEVtYmVkZGVkTWV0YURhdGEoKSA9PSBudWxsKQovLyAgICAg\nICAgICAgIGZtZC5hZGRFbWJlZGRlZE1ldGFEYXRhKCk7CiAgICAgICAgICAg\nIGRlZmVyRW1iZWRkYWJsZShmbWQuZ2V0RGVjbGFyZWRUeXBlKCksIGZtZCk7\nCiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgcHJvdGVjdGVkIHZv\naWQgZW5kRW1iZWRkZWRJZCgpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlv\nbiB7CiAgICAgICAgZmluaXNoRmllbGQoKTsKICAgIH0KCiAgICAvKioKICAg\nICAqIFBhcnNlIGlkLWNsYXNzLgogICAgICovCiAgICBwcm90ZWN0ZWQgYm9v\nbGVhbiBzdGFydElkQ2xhc3MoQXR0cmlidXRlcyBhdHRycykKICAgICAgICB0\naHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICBpZiAoIWlzTWV0YURhdGFN\nb2RlKCkpCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCiAgICAgICAgQ2xh\nc3NNZXRhRGF0YSBtZXRhID0gKENsYXNzTWV0YURhdGEpIGN1cnJlbnRFbGVt\nZW50KCk7CiAgICAgICAgU3RyaW5nIGNscyA9IGF0dHJzLmdldFZhbHVlKCJj\nbGFzcyIpOwogICAgICAgIENsYXNzPD8+IGlkQ2xzID0gbnVsbDsKICAgICAg\nICB0cnkgewogICAgICAgICAgICBpZENscyA9IGNsYXNzRm9yTmFtZShjbHMp\nOwogICAgICAgIH0gY2F0Y2ggKFRocm93YWJsZSB0KSB7CiAgICAgICAgICAg\nIHRocm93IGdldEV4Y2VwdGlvbihfbG9jLmdldCgiaW52YWxpZC1pZC1jbGFz\ncyIsIG1ldGEsIGNscyksIHQpOwogICAgICAgIH0KICAgICAgICBtZXRhLnNl\ndE9iamVjdElkVHlwZShpZENscywgdHJ1ZSk7CiAgICAgICAgcmV0dXJuIHRy\ndWU7CiAgICB9CgogICAgcHJvdGVjdGVkIHZvaWQgZW5kSWRDbGFzcygpCiAg\nICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBQYXJzZSBsb2IuCiAgICAgKi8KICAgIHByb3RlY3RlZCBib29sZWFu\nIHN0YXJ0TG9iKEF0dHJpYnV0ZXMgYXR0cnMpCiAgICAgICAgdGhyb3dzIFNB\nWEV4Y2VwdGlvbiB7CiAgICAgICAgRmllbGRNZXRhRGF0YSBmbWQgPSAoRmll\nbGRNZXRhRGF0YSkgY3VycmVudEVsZW1lbnQoKTsKICAgICAgICBpbnQgdHlw\nZUNvZGUgPSBmbWQuaXNFbGVtZW50Q29sbGVjdGlvbigpID8gZm1kLmdldEVs\nZW1lbnQoKS5nZXREZWNsYXJlZFR5cGVDb2RlKCkgOiBmbWQuZ2V0RGVjbGFy\nZWRUeXBlQ29kZSgpOwogICAgICAgIENsYXNzPD8+IHR5cGUgPSBmbWQuaXNF\nbGVtZW50Q29sbGVjdGlvbigpID8gZm1kLmdldEVsZW1lbnQoKS5nZXREZWNs\nYXJlZFR5cGUoKSA6IGZtZC5nZXREZWNsYXJlZFR5cGUoKTsKICAgICAgICBp\nZiAodHlwZUNvZGUgIT0gSmF2YVR5cGVzLlNUUklORwogICAgICAgICAgICAm\nJiB0eXBlICE9IGNoYXJbXS5jbGFzcwogICAgICAgICAgICAmJiB0eXBlICE9\nIENoYXJhY3RlcltdLmNsYXNzCiAgICAgICAgICAgICYmIHR5cGUgIT0gYnl0\nZVtdLmNsYXNzCiAgICAgICAgICAgICYmIHR5cGUgIT0gQnl0ZVtdLmNsYXNz\nKQogICAgICAgICAgICBmbWQuc2V0U2VyaWFsaXplZCh0cnVlKTsKICAgICAg\nICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBwcm90ZWN0ZWQgdm9pZCBlbmRM\nb2IoKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24gewogICAgfQoKICAg\nIC8qKgogICAgICogUGFyc2UgZ2VuZXJhdGVkLXZhbHVlLgogICAgICovCiAg\nICBwcm90ZWN0ZWQgYm9vbGVhbiBzdGFydEdlbmVyYXRlZFZhbHVlKEF0dHJp\nYnV0ZXMgYXR0cnMpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAg\nICAgICAgaWYgKCFpc01hcHBpbmdPdmVycmlkZU1vZGUoKSkKICAgICAgICAg\nICAgcmV0dXJuIGZhbHNlOwoKICAgICAgICBTdHJpbmcgc3RyYXRlZ3kgPSBh\ndHRycy5nZXRWYWx1ZSgic3RyYXRlZ3kiKTsKICAgICAgICBTdHJpbmcgZ2Vu\nZXJhdG9yID0gYXR0cnMuZ2V0VmFsdWUoImdlbmVyYXRvciIpOwogICAgICAg\nIEdlbmVyYXRpb25UeXBlIHR5cGUgPSBTdHJpbmdVdGlscy5pc0VtcHR5KHN0\ncmF0ZWd5KQogICAgICAgICAgICA/IEdlbmVyYXRpb25UeXBlLkFVVE8gOiBH\nZW5lcmF0aW9uVHlwZS52YWx1ZU9mKHN0cmF0ZWd5KTsKCiAgICAgICAgRmll\nbGRNZXRhRGF0YSBmbWQgPSAoRmllbGRNZXRhRGF0YSkgY3VycmVudEVsZW1l\nbnQoKTsKICAgICAgICBBbm5vdGF0aW9uUGVyc2lzdGVuY2VNZXRhRGF0YVBh\ncnNlci5wYXJzZUdlbmVyYXRlZFZhbHVlKGZtZCwgdHlwZSwKICAgICAgICAg\nICAgZ2VuZXJhdG9yKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAg\nICBwcm90ZWN0ZWQgdm9pZCBlbmRHZW5lcmF0ZWRWYWx1ZSgpCiAgICAgICAg\ndGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICB9CgogICAgLyoqCiAgICAgKiBM\nYXppbHkgcGFyc2UgY2FzY2FkZXMuCiAgICAgKi8KICAgIHByb3RlY3RlZCBi\nb29sZWFuIHN0YXJ0Q2FzY2FkZShPYmplY3QgdGFnLCBBdHRyaWJ1dGVzIGF0\ndHJzKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24gewogICAgICAgIGlm\nICghaXNNZXRhRGF0YU1vZGUoKSkKICAgICAgICAgICAgcmV0dXJuIGZhbHNl\nOwoKICAgICAgICBTZXQ8Q2FzY2FkZVR5cGU+IGNhc2NhZGVzID0gbnVsbDsK\nICAgICAgICBpZiAoY3VycmVudEVsZW1lbnQoKSBpbnN0YW5jZW9mIEZpZWxk\nTWV0YURhdGEpIHsKICAgICAgICAgICAgaWYgKF9jYXNjYWRlcyA9PSBudWxs\nKQogICAgICAgICAgICAgICAgX2Nhc2NhZGVzID0gRW51bVNldC5ub25lT2Yo\nQ2FzY2FkZVR5cGUuY2xhc3MpOwogICAgICAgICAgICBjYXNjYWRlcyA9IF9j\nYXNjYWRlczsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBpZiAoX3Br\nZ0Nhc2NhZGVzID09IG51bGwpCiAgICAgICAgICAgICAgICBfcGtnQ2FzY2Fk\nZXMgPSBFbnVtU2V0Lm5vbmVPZihDYXNjYWRlVHlwZS5jbGFzcyk7CiAgICAg\nICAgICAgIGNhc2NhZGVzID0gX3BrZ0Nhc2NhZGVzOwogICAgICAgIH0KICAg\nICAgICBib29sZWFuIGFsbCA9IEVMRU1fQ0FTQ0FERV9BTEwgPT0gdGFnOwog\nICAgICAgIGlmIChhbGwgfHwgRUxFTV9DQVNDQURFX1BFUiA9PSB0YWcpCiAg\nICAgICAgICAgIGNhc2NhZGVzLmFkZChQRVJTSVNUKTsKICAgICAgICBpZiAo\nYWxsIHx8IEVMRU1fQ0FTQ0FERV9SRU0gPT0gdGFnKQogICAgICAgICAgICBj\nYXNjYWRlcy5hZGQoUkVNT1ZFKTsKICAgICAgICBpZiAoYWxsIHx8IEVMRU1f\nQ0FTQ0FERV9NRVIgPT0gdGFnKQogICAgICAgICAgICBjYXNjYWRlcy5hZGQo\nTUVSR0UpOwogICAgICAgIGlmIChhbGwgfHwgRUxFTV9DQVNDQURFX1JFRiA9\nPSB0YWcpCiAgICAgICAgICAgIGNhc2NhZGVzLmFkZChSRUZSRVNIKTsKICAg\nICAgICBpZiAoYWxsIHx8IEVMRU1fQ0FTQ0FERV9ERVQgPT0gdGFnKQogICAg\nICAgICAgICBjYXNjYWRlcy5hZGQoREVUQUNIKTsKICAgICAgICByZXR1cm4g\ndHJ1ZTsKICAgIH0KCiAgICAvKioKICAgICAqIFNldCB0aGUgY2FjaGVkIGNh\nc2NhZGVzIGludG8gdGhlIGZpZWxkLgogICAgICovCiAgICBwcm90ZWN0ZWQg\ndm9pZCBzZXRDYXNjYWRlcyhGaWVsZE1ldGFEYXRhIGZtZCkgewogICAgICAg\nIFNldDxDYXNjYWRlVHlwZT4gY2FzY2FkZXMgPSBfY2FzY2FkZXM7CiAgICAg\nICAgaWYgKF9jYXNjYWRlcyA9PSBudWxsKQogICAgICAgICAgICBjYXNjYWRl\ncyA9IF9wa2dDYXNjYWRlczsKICAgICAgICBpZiAoY2FzY2FkZXMgPT0gbnVs\nbCkKICAgICAgICAgICAgcmV0dXJuOwoKICAgICAgICBWYWx1ZU1ldGFEYXRh\nIHZtZCA9IGZtZDsKICAgICAgICBzd2l0Y2ggKF9zdHJhdGVneSkgewogICAg\nICAgICAgICBjYXNlIE9ORV9NQU5ZOgogICAgICAgICAgICBjYXNlIE1BTllf\nTUFOWToKICAgICAgICAgICAgICAgIHZtZCA9IGZtZC5nZXRFbGVtZW50KCk7\nCiAgICAgICAgfQogICAgICAgIGZvciAoQ2FzY2FkZVR5cGUgY2FzY2FkZSA6\nIGNhc2NhZGVzKSB7CiAgICAgICAgICAgIHN3aXRjaCAoY2FzY2FkZSkgewog\nICAgICAgICAgICAgICAgY2FzZSBQRVJTSVNUOgogICAgICAgICAgICAgICAg\nICAgIHZtZC5zZXRDYXNjYWRlUGVyc2lzdChWYWx1ZU1ldGFEYXRhLkNBU0NB\nREVfSU1NRURJQVRFKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAg\nICAgICAgICAgICAgIGNhc2UgTUVSR0U6CiAgICAgICAgICAgICAgICAgICAg\ndm1kLnNldENhc2NhZGVBdHRhY2goVmFsdWVNZXRhRGF0YS5DQVNDQURFX0lN\nTUVESUFURSk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAg\nICAgICAgICBjYXNlIERFVEFDSDoKICAgICAgICAgICAgICAgICAgICB2bWQu\nc2V0Q2FzY2FkZURldGFjaChWYWx1ZU1ldGFEYXRhLkNBU0NBREVfSU1NRURJ\nQVRFKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAg\nICAgIGNhc2UgUkVNT1ZFOgogICAgICAgICAgICAgICAgICAgIHZtZC5zZXRD\nYXNjYWRlRGVsZXRlKFZhbHVlTWV0YURhdGEuQ0FTQ0FERV9JTU1FRElBVEUp\nOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAg\nY2FzZSBSRUZSRVNIOgogICAgICAgICAgICAgICAgICAgIHZtZC5zZXRDYXNj\nYWRlUmVmcmVzaChWYWx1ZU1ldGFEYXRhLkNBU0NBREVfSU1NRURJQVRFKTsK\nICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAg\nICAgIH0KICAgICAgICBfY2FzY2FkZXMgPSBudWxsOwogICAgfQoKICAgIC8q\nKgogICAgICogUGFyc2UgY29tbW9uIGZpZWxkIGF0dHJpYnV0ZXMuCiAgICAg\nKi8KICAgIHByaXZhdGUgRmllbGRNZXRhRGF0YSBwYXJzZUZpZWxkKEF0dHJp\nYnV0ZXMgYXR0cnMpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAg\nICAgICAgQ2xhc3NNZXRhRGF0YSBtZXRhID0gKENsYXNzTWV0YURhdGEpIGN1\ncnJlbnRFbGVtZW50KCk7CiAgICAgICAgU3RyaW5nIG5hbWUgPSBhdHRycy5n\nZXRWYWx1ZSgibmFtZSIpOwogICAgICAgIEZpZWxkTWV0YURhdGEgZmllbGQg\nPSBtZXRhLmdldERlY2xhcmVkRmllbGQobmFtZSk7CiAgICAgICAgaW50IGZs\nZEFjY2VzcyA9IGdldEZpZWxkQWNjZXNzKGZpZWxkLCBhdHRycyk7CiAgICAg\nICAgLy8gSWYgdGhlIGFjY2VzcyBkZWZpbmVkIGluIFhNTCBpcyBub3QgdGhl\nIHNhbWUgYXMgd2hhdCB3YXMgZGVmaW5lZAogICAgICAgIC8vIGJ5IGRlZmF1\nbHQgb3IgYW5ub3RhdGlvbiwgZmluZCB0aGUgYXBwcm9wcmlhdGUgYmFja2lu\nZyBtZW1iZXIgYW5kCiAgICAgICAgLy8gcmVwbGFjZSB3aGF0IGlzIGN1cnJl\nbnRseSBkZWZpbmVkIGluIG1ldGFkYXRhLgogICAgICAgIGlmICgoZmllbGQg\nPT0gbnVsbCB8fCBmaWVsZC5nZXREZWNsYXJlZFR5cGUoKSA9PSBPYmplY3Qu\nY2xhc3MgfHwKICAgICAgICAgICAgIGZpZWxkLmdldEFjY2Vzc1R5cGUoKSAh\nPSBmbGRBY2Nlc3MpCiAgICAgICAgICAgICYmIG1ldGEuZ2V0RGVzY3JpYmVk\nVHlwZSgpICE9IE9iamVjdC5jbGFzcykgewogICAgICAgICAgICBNZW1iZXIg\nbWVtYmVyID0gX3JlcG9zLmdldE1ldGFEYXRhRmFjdG9yeSgpLmdldERlZmF1\nbHRzKCkKICAgICAJICAgICAgICAuZ2V0TWVtYmVyQnlQcm9wZXJ0eShtZXRh\nLCBuYW1lLCBmbGRBY2Nlc3MsIGZhbHNlKTsKICAgICAgICAgICAgQ2xhc3M8\nPz4gdHlwZSA9IEZpZWxkLmNsYXNzLmlzSW5zdGFuY2UobWVtYmVyKSA/CiAg\nICAgICAgICAgICAgICAoKEZpZWxkKW1lbWJlcikuZ2V0VHlwZSgpIDogKChN\nZXRob2QpbWVtYmVyKS5nZXRSZXR1cm5UeXBlKCk7CgogICAgICAgICAgICBp\nZiAoZmllbGQgPT0gbnVsbCkgewogICAgICAgICAgICAgICAgZmllbGQgPSBt\nZXRhLmFkZERlY2xhcmVkRmllbGQobmFtZSwgdHlwZSk7CiAgICAgICAgICAg\nICAgICBQZXJzaXN0ZW5jZU1ldGFEYXRhRGVmYXVsdHMuc2V0Q2FzY2FkZU5v\nbmUoZmllbGQpOwogICAgICAgICAgICAgICAgUGVyc2lzdGVuY2VNZXRhRGF0\nYURlZmF1bHRzLnNldENhc2NhZGVOb25lKGZpZWxkLmdldEtleSgpKTsKICAg\nICAgICAgICAgICAgIFBlcnNpc3RlbmNlTWV0YURhdGFEZWZhdWx0cy5zZXRD\nYXNjYWRlTm9uZShmaWVsZC5nZXRFbGVtZW50KCkpOwogICAgICAgICAgICB9\nCiAgICAgICAgICAgIGZpZWxkLmJhY2tpbmdNZW1iZXIobWVtYmVyKTsKICAg\nICAgICB9IGVsc2UgaWYgKGZpZWxkID09IG51bGwpIHsKICAgICAgICAgICAg\nZmllbGQgPSBtZXRhLmFkZERlY2xhcmVkRmllbGQobmFtZSwgT2JqZWN0LmNs\nYXNzKTsKICAgICAgICAgICAgUGVyc2lzdGVuY2VNZXRhRGF0YURlZmF1bHRz\nLnNldENhc2NhZGVOb25lKGZpZWxkKTsKICAgICAgICAgICAgUGVyc2lzdGVu\nY2VNZXRhRGF0YURlZmF1bHRzLnNldENhc2NhZGVOb25lKGZpZWxkLmdldEtl\neSgpKTsKICAgICAgICAgICAgUGVyc2lzdGVuY2VNZXRhRGF0YURlZmF1bHRz\nLnNldENhc2NhZGVOb25lKGZpZWxkLmdldEVsZW1lbnQoKSk7CiAgICAgICAg\nfQoKICAgICAgICBpZiAoaXNNZXRhRGF0YU1vZGUoKSkKICAgICAgICAgICAg\nZmllbGQuc2V0TGlzdGluZ0luZGV4KF9maWVsZFBvcyk7CgogICAgICAgIF9m\naWVsZFBvcysrOwogICAgICAgIHB1c2hFbGVtZW50KGZpZWxkKTsKICAgICAg\nICBhZGRDb21tZW50cyhmaWVsZCk7CgogICAgICAgIGlmIChpc01hcHBpbmdP\ndmVycmlkZU1vZGUoKSkKICAgICAgICAgICAgc3RhcnRGaWVsZE1hcHBpbmco\nZmllbGQsIGF0dHJzKTsKICAgICAgICByZXR1cm4gZmllbGQ7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBQb3BzIGZpZWxkIGVsZW1lbnQuCiAgICAgKi8KICAg\nIHByaXZhdGUgdm9pZCBmaW5pc2hGaWVsZCgpCiAgICAgICAgdGhyb3dzIFNB\nWEV4Y2VwdGlvbiB7CiAgICAgICAgRmllbGRNZXRhRGF0YSBmaWVsZCA9IChG\naWVsZE1ldGFEYXRhKSBwb3BFbGVtZW50KCk7CiAgICAgICAgc2V0Q2FzY2Fk\nZXMoZmllbGQpOwogICAgICAgIGlmIChpc01hcHBpbmdPdmVycmlkZU1vZGUo\nKSkKICAgICAgICAgICAgZW5kRmllbGRNYXBwaW5nKGZpZWxkKTsKICAgICAg\nICBfc3RyYXRlZ3kgPSBudWxsOwogICAgfQoKICAgIC8qKgogICAgICogRGV0\nZXJtaW5lcyBhY2Nlc3MgZm9yIGZpZWxkIGJhc2VkIHVwb24gZXhpc3Rpbmcg\nbWV0YWRhdGEgYW5kIFhNTAogICAgICogYXR0cmlidXRlcy4KICAgICAqCiAg\nICAgKiBAcGFyYW0gZmllbGQgRmllbGRNZXRhRGF0YSBjdXJyZW50IG1ldGFk\nYXRhIGZvciBmaWVsZAogICAgICogQHBhcmFtIGF0dHJzIFhNTCBBdHRyaWJ1\ndGVzIGRlZmluZWQgb24gdGhpcyBmaWVsZAogICAgICogQHJldHVybgogICAg\nICovCiAgICBwcml2YXRlIGludCBnZXRGaWVsZEFjY2VzcyhGaWVsZE1ldGFE\nYXRhIGZpZWxkLCBBdHRyaWJ1dGVzIGF0dHJzKSB7CiAgICAgICAgaWYgKGF0\ndHJzICE9IG51bGwpIHsKICAgICAgICAgICAgU3RyaW5nIGFjY2VzcyA9IGF0\ndHJzLmdldFZhbHVlKCJhY2Nlc3MiKTsKICAgICAgICAgICAgaWYgKCJQUk9Q\nRVJUWSIuZXF1YWxzKGFjY2VzcykpCiAgICAgICAgICAgICAgICByZXR1cm4g\nQWNjZXNzQ29kZS5FWFBMSUNJVCB8IEFjY2Vzc0NvZGUuUFJPUEVSVFk7CiAg\nICAgICAgICAgIGlmICgiRklFTEQiLmVxdWFscyhhY2Nlc3MpKQogICAgICAg\nICAgICAgICAgcmV0dXJuIEFjY2Vzc0NvZGUuRVhQTElDSVQgfCBBY2Nlc3ND\nb2RlLkZJRUxEOwogICAgICAgIH0KICAgICAgICAvLyBDaGVjayBhY2Nlc3Mg\nZGVmaW5lZCBvbiBmaWVsZCwgaWYgcHJvdmlkZWQKICAgICAgICBpZiAoZmll\nbGQgIT0gbnVsbCkgewogICAgICAgICAgICByZXR1cm4gZmllbGQuZ2V0QWNj\nZXNzVHlwZSgpOwogICAgICAgIH0KICAgICAgICAvLyBPdGhlcndpc2UsIGdl\ndCB0aGUgZGVmYXVsdCBhY2Nlc3MgdHlwZSBvZiB0aGUgZGVjbGFyaW5nIGNs\nYXNzCiAgICAgICAgQ2xhc3NNZXRhRGF0YSBtZXRhID0gKENsYXNzTWV0YURh\ndGEpIGN1cnJlbnRFbGVtZW50KCk7CiAgICAgICAgaWYgKG1ldGEgIT0gbnVs\nbCkgewogICAgICAgICAgICByZXR1cm4gQWNjZXNzQ29kZS50b0ZpZWxkQ29k\nZShtZXRhLmdldEFjY2Vzc1R5cGUoKSk7CiAgICAgICAgfQogICAgICAgIHJl\ndHVybiBBY2Nlc3NDb2RlLlVOS05PV047CiAgICB9CgogICAgLyoqCiAgICAg\nKiBJbXBsZW1lbnQgdG8gYWRkIGZpZWxkIG1hcHBpbmcgZGF0YS4gRG9lcyBu\nb3RoaW5nIGJ5IGRlZmF1bHQuCiAgICAgKi8KICAgIHByb3RlY3RlZCB2b2lk\nIHN0YXJ0RmllbGRNYXBwaW5nKEZpZWxkTWV0YURhdGEgZmllbGQsIEF0dHJp\nYnV0ZXMgYXR0cnMpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBJbXBsZW1lbnQgdG8gZmluYWxpemUgZmll\nbGQgbWFwcGluZy4gRG9lcyBub3RoaW5nIGJ5IGRlZmF1bHQuCiAgICAgKi8K\nICAgIHByb3RlY3RlZCB2b2lkIGVuZEZpZWxkTWFwcGluZyhGaWVsZE1ldGFE\nYXRhIGZpZWxkKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24gewogICAg\nfQoKICAgIC8qKgogICAgICogUGFyc2UgdmVyc2lvbi4KICAgICAqLwogICAg\ncHJvdGVjdGVkIGJvb2xlYW4gc3RhcnRWZXJzaW9uKEF0dHJpYnV0ZXMgYXR0\ncnMpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgRmll\nbGRNZXRhRGF0YSBmbWQgPSBwYXJzZUZpZWxkKGF0dHJzKTsKICAgICAgICBm\nbWQuc2V0RXhwbGljaXQodHJ1ZSk7CiAgICAgICAgZm1kLnNldFZlcnNpb24o\ndHJ1ZSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgcHJvdGVj\ndGVkIHZvaWQgZW5kVmVyc2lvbigpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2Vw\ndGlvbiB7CiAgICAgICAgZmluaXNoRmllbGQoKTsKICAgIH0KCiAgICAvKioK\nICAgICAqIFBhcnNlIHN0cmF0ZWd5IGVsZW1lbnQuCiAgICAgKi8KICAgIHBy\naXZhdGUgYm9vbGVhbiBzdGFydFN0cmF0ZWd5KFBlcnNpc3RlbmNlU3RyYXRl\nZ3kgc3RyYXRlZ3ksCiAgICAgICAgQXR0cmlidXRlcyBhdHRycykKICAgICAg\nICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICBGaWVsZE1ldGFEYXRh\nIGZtZCA9IHBhcnNlRmllbGQoYXR0cnMpOwogICAgICAgIGZtZC5zZXRFeHBs\naWNpdCh0cnVlKTsKICAgICAgICBmbWQuc2V0TWFuYWdlbWVudChGaWVsZE1l\ndGFEYXRhLk1BTkFHRV9QRVJTSVNURU5UKTsKCiAgICAgICAgU3RyaW5nIHZh\nbCA9IGF0dHJzLmdldFZhbHVlKCJvcHRpb25hbCIpOwogICAgICAgIGlmICgi\nZmFsc2UiLmVxdWFscyh2YWwpKQogICAgICAgICAgICBmbWQuc2V0TnVsbFZh\nbHVlKEZpZWxkTWV0YURhdGEuTlVMTF9FWENFUFRJT04pOwogICAgICAgIGVs\nc2UgaWYgKCJ0cnVlIi5lcXVhbHModmFsKQogICAgICAgICAgICAgICAgJiYg\nZm1kLmdldE51bGxWYWx1ZSgpID09IEZpZWxkTWV0YURhdGEuTlVMTF9FWENF\nUFRJT04pIHsKICAgICAgICAgICAgLy8gUmVzZXQgdmFsdWUgaWYgdGhlIGZp\nZWxkIHdhcyBhbm5vdGF0ZWQgd2l0aCBvcHRpb25hbD1mYWxzZS4KICAgICAg\nICAgICAgLy8gT3RoZXJ3aXNlIGxlYXZlIGl0IGFsb25lLgogICAgICAgICAg\nICBmbWQuc2V0TnVsbFZhbHVlKEZpZWxkTWV0YURhdGEuTlVMTF9VTlNFVCk7\nCiAgICAgICAgfQogICAgICAgIGlmIChpc01hcHBpbmdPdmVycmlkZU1vZGUo\nKSkgewogICAgICAgICAgICB2YWwgPSBhdHRycy5nZXRWYWx1ZSgibWFwcGVk\nLWJ5Iik7CiAgICAgICAgICAgIGlmICh2YWwgIT0gbnVsbCkKICAgICAgICAg\nICAgICAgIGZtZC5zZXRNYXBwZWRCeSh2YWwpOwogICAgICAgIH0KICAgICAg\nICBwYXJzZVN0cmF0ZWd5KGZtZCwgc3RyYXRlZ3ksIGF0dHJzKTsKICAgICAg\nICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBwcml2YXRlIHZvaWQgZW5kU3Ry\nYXRlZ3koUGVyc2lzdGVuY2VTdHJhdGVneSBzdHJhdGVneSkKICAgICAgICB0\naHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICBmaW5pc2hGaWVsZCgpOwog\nICAgfQoKICAgIC8qKgogICAgICogUGFyc2Ugc3RyYXRlZ3kgc3BlY2lmaWMg\nYXR0cmlidXRlcy4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIHBhcnNlU3Ry\nYXRlZ3koRmllbGRNZXRhRGF0YSBmbWQsCiAgICAgICAgUGVyc2lzdGVuY2VT\ndHJhdGVneSBzdHJhdGVneSwgQXR0cmlidXRlcyBhdHRycykKICAgICAgICB0\naHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICBzd2l0Y2ggKHN0cmF0ZWd5\nKSB7CiAgICAgICAgICAgIGNhc2UgQkFTSUM6CiAgICAgICAgICAgICAgICBw\nYXJzZUJhc2ljKGZtZCwgYXR0cnMpOwogICAgICAgICAgICAgICAgYnJlYWs7\nCiAgICAgICAgICAgIGNhc2UgRU1CRURERUQ6CiAgICAgICAgICAgICAgICBw\nYXJzZUVtYmVkZGVkKGZtZCwgYXR0cnMpOwogICAgICAgICAgICAgICAgYnJl\nYWs7CiAgICAgICAgICAgIGNhc2UgT05FX09ORToKICAgICAgICAgICAgICAg\nIHBhcnNlT25lVG9PbmUoZm1kLCBhdHRycyk7CiAgICAgICAgICAgICAgICBi\ncmVhazsKICAgICAgICAgICAgY2FzZSBNQU5ZX09ORToKICAgICAgICAgICAg\nICAgIHBhcnNlTWFueVRvT25lKGZtZCwgYXR0cnMpOwogICAgICAgICAgICAg\nICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgTUFOWV9NQU5ZOgogICAgICAg\nICAgICAgICAgcGFyc2VNYW55VG9NYW55KGZtZCwgYXR0cnMpOwogICAgICAg\nICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgT05FX01BTlk6CiAg\nICAgICAgICAgICAgICBwYXJzZU9uZVRvTWFueShmbWQsIGF0dHJzKTsKICAg\nICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIFRSQU5TSUVO\nVDoKICAgICAgICAgICAgICAgIFN0cmluZyB2YWwgPSBhdHRycy5nZXRWYWx1\nZSgiZmV0Y2giKTsKICAgICAgICAgICAgICAgIGlmICh2YWwgIT0gbnVsbCkg\newogICAgICAgICAgICAgICAgICAgIGZtZC5zZXRJbkRlZmF1bHRGZXRjaEdy\nb3VwKCJFQUdFUiIuZXF1YWxzKHZhbCkpOwogICAgICAgICAgICAgICAgfQog\nICAgICAgICAgICAgICAgZm1kLnNldE1hbmFnZW1lbnQoRmllbGRNZXRhRGF0\nYS5NQU5BR0VfTk9ORSk7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAg\nICAgICAgY2FzZSBFTEVNX0NPTEw6CiAgICAgICAgICAgICAgICBwYXJzZUVs\nZW1lbnRDb2xsZWN0aW9uKGZtZCwgYXR0cnMpOwogICAgICAgIH0KICAgIH0K\nCiAgICAvKioKICAgICAqIFBhcnNlIGJhc2ljLgogICAgICovCiAgICBwcm90\nZWN0ZWQgdm9pZCBwYXJzZUJhc2ljKEZpZWxkTWV0YURhdGEgZm1kLCBBdHRy\naWJ1dGVzIGF0dHJzKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24gewog\nICAgICAgIFN0cmluZyB2YWwgPSBhdHRycy5nZXRWYWx1ZSgiZmV0Y2giKTsK\nICAgICAgICBpZiAodmFsICE9IG51bGwpIHsKICAgICAgICAgICAgZm1kLnNl\ndEluRGVmYXVsdEZldGNoR3JvdXAoIkVBR0VSIi5lcXVhbHModmFsKSk7CiAg\nICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogUGFyc2UgZW1iZWRkZWQu\nCiAgICAgKi8KICAgIHByb3RlY3RlZCB2b2lkIHBhcnNlRW1iZWRkZWQoRmll\nbGRNZXRhRGF0YSBmbWQsIEF0dHJpYnV0ZXMgYXR0cnMpCiAgICAgICAgdGhy\nb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgYXNzZXJ0UEMoZm1kLCAiRW1i\nZWRkZWQiKTsKICAgICAgICBmbWQuc2V0SW5EZWZhdWx0RmV0Y2hHcm91cCh0\ncnVlKTsKICAgICAgICBmbWQuc2V0RW1iZWRkZWQodHJ1ZSk7CiAgICAgICAg\nZm1kLnNldFNlcmlhbGl6ZWQoZmFsc2UpOyAvLyBvdmVycmlkZSBhbnkgTG9i\nIGFubm90YXRpb24KCiAgICAgICAgaWYgKGZtZC5nZXRFbWJlZGRlZE1ldGFE\nYXRhKCkgPT0gbnVsbCkKLy8gICAgICAgICAgICBmbWQuYWRkRW1iZWRkZWRN\nZXRhRGF0YSgpOwogICAgICAgICAgICBkZWZlckVtYmVkZGFibGUoZm1kLmdl\ndERlY2xhcmVkVHlwZSgpLCBmbWQpOwogICAgfQoKICAgIC8qKgogICAgICog\nVGhyb3cgcHJvcGVyIGV4Y2VwdGlvbiBpZiBnaXZlbiB2YWx1ZSBpcyBub3Qg\ncG9zc2libHkgcGVyc2lzdGVuY2UKICAgICAqIGNhcGFibGUuCiAgICAgKi8K\nICAgIHByaXZhdGUgdm9pZCBhc3NlcnRQQyhGaWVsZE1ldGFEYXRhIGZtZCwg\nU3RyaW5nIGF0dHIpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAg\nICAgICAgaWYgKCFKYXZhVHlwZXMubWF5YmVQQyhmbWQpKQogICAgICAgICAg\nICB0aHJvdyBnZXRFeGNlcHRpb24oX2xvYy5nZXQoImJhZC1tZXRhLWFubm8i\nLCBmbWQsIGF0dHIpKTsKICAgIH0KCiAgICAvKioKICAgICAqIFBhcnNlIG9u\nZS10by1vbmUuCiAgICAgKi8KICAgIHByb3RlY3RlZCB2b2lkIHBhcnNlT25l\nVG9PbmUoRmllbGRNZXRhRGF0YSBmbWQsIEF0dHJpYnV0ZXMgYXR0cnMpCiAg\nICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgU3RyaW5nIHZh\nbCA9IGF0dHJzLmdldFZhbHVlKCJmZXRjaCIpOwogICAgICAgIGlmICh2YWwg\nPT0gbnVsbCB8fCAiRUFHRVIiLmVxdWFscyh2YWwpKSB7CiAgICAgICAgICAg\nIGZtZC5zZXRJbkRlZmF1bHRGZXRjaEdyb3VwKHRydWUpOwogICAgICAgIH0K\nICAgICAgICB2YWwgPSBhdHRycy5nZXRWYWx1ZSgidGFyZ2V0LWVudGl0eSIp\nOwogICAgICAgIGlmICh2YWwgIT0gbnVsbCkKICAgICAgICAgICAgZm1kLnNl\ndFR5cGVPdmVycmlkZShjbGFzc0Zvck5hbWUodmFsKSk7CiAgICAgICAgYXNz\nZXJ0UEMoZm1kLCAiT25lVG9PbmUiKTsKICAgICAgICBmbWQuc2V0U2VyaWFs\naXplZChmYWxzZSk7IC8vIG92ZXJyaWRlIGFueSBMb2IgYW5ub3RhdGlvbgog\nICAgICAgIGJvb2xlYW4gb3JwaGFuUmVtb3ZhbCA9IEJvb2xlYW4udmFsdWVP\nZihhdHRycy5nZXRWYWx1ZSgKICAgICAgICAgICAgIm9ycGhhbi1yZW1vdmFs\nIikpOwogICAgICAgIHNldE9ycGhhblJlbW92YWwoZm1kLCBvcnBoYW5SZW1v\ndmFsKTsKICAgICAgICBTdHJpbmcgbWFwc0lkID0gYXR0cnMuZ2V0VmFsdWUo\nIm1hcHMtaWQiKTsKICAgICAgICBpZiAobWFwc0lkICE9IG51bGwpCiAgICAg\nICAgICAgIGZtZC5zZXRNYXBwZWRCeUlkVmFsdWUobWFwc0lkKTsKICAgIH0K\nCiAgICAvKioKICAgICAqIFBhcnNlIG1hbnktdG8tb25lLgogICAgICovCiAg\nICBwcm90ZWN0ZWQgdm9pZCBwYXJzZU1hbnlUb09uZShGaWVsZE1ldGFEYXRh\nIGZtZCwgQXR0cmlidXRlcyBhdHRycykKICAgICAgICB0aHJvd3MgU0FYRXhj\nZXB0aW9uIHsKICAgICAgICBTdHJpbmcgdmFsID0gYXR0cnMuZ2V0VmFsdWUo\nImZldGNoIik7CiAgICAgICAgaWYgKHZhbCA9PSBudWxsIHx8ICJFQUdFUiIu\nZXF1YWxzKHZhbCkpIHsKICAgICAgICAgICAgZm1kLnNldEluRGVmYXVsdEZl\ndGNoR3JvdXAodHJ1ZSk7CiAgICAgICAgfQogICAgICAgIHZhbCA9IGF0dHJz\nLmdldFZhbHVlKCJ0YXJnZXQtZW50aXR5Iik7CiAgICAgICAgaWYgKHZhbCAh\nPSBudWxsKQogICAgICAgICAgICBmbWQuc2V0VHlwZU92ZXJyaWRlKGNsYXNz\nRm9yTmFtZSh2YWwpKTsKICAgICAgICBhc3NlcnRQQyhmbWQsICJNYW55VG9P\nbmUiKTsKICAgICAgICBmbWQuc2V0U2VyaWFsaXplZChmYWxzZSk7IC8vIG92\nZXJyaWRlIGFueSBMb2IgYW5ub3RhdGlvbgogICAgICAgIFN0cmluZyBtYXBz\nSWQgPSBhdHRycy5nZXRWYWx1ZSgibWFwcy1pZCIpOwogICAgICAgIGlmICht\nYXBzSWQgIT0gbnVsbCkKICAgICAgICAgICAgZm1kLnNldE1hcHBlZEJ5SWRW\nYWx1ZShtYXBzSWQpOwogICAgfQoKICAgIC8qKgogICAgICogUGFyc2UgbWFu\neS10by1tYW55LgogICAgICovCiAgICBwcm90ZWN0ZWQgdm9pZCBwYXJzZU1h\nbnlUb01hbnkoRmllbGRNZXRhRGF0YSBmbWQsIEF0dHJpYnV0ZXMgYXR0cnMp\nCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgU3RyaW5n\nIHZhbCA9IGF0dHJzLmdldFZhbHVlKCJmZXRjaCIpOwogICAgICAgIGlmICh2\nYWwgIT0gbnVsbCkgewogICAgICAgICAgICBmbWQuc2V0SW5EZWZhdWx0RmV0\nY2hHcm91cCgiRUFHRVIiLmVxdWFscyh2YWwpKTsKICAgICAgICB9CiAgICAg\nICAgdmFsID0gYXR0cnMuZ2V0VmFsdWUoInRhcmdldC1lbnRpdHkiKTsKICAg\nICAgICBpZiAodmFsICE9IG51bGwpCiAgICAgICAgICAgIGZtZC5nZXRFbGVt\nZW50KCkuc2V0RGVjbGFyZWRUeXBlKGNsYXNzRm9yTmFtZSh2YWwpKTsKICAg\nICAgICBhc3NlcnRQQ0NvbGxlY3Rpb24oZm1kLCAiTWFueVRvTWFueSIpOwog\nICAgICAgIGZtZC5zZXRTZXJpYWxpemVkKGZhbHNlKTsgLy8gb3ZlcnJpZGUg\nTG9iIGluIGFubm90YXRpb24KICAgIH0KCiAgICAvKioKICAgICAqIFRocm93\nIGV4Y2VwdGlvbiBpZiBnaXZlbiBmaWVsZCBub3QgYSBjb2xsZWN0aW9uIG9m\nIHBvc3NpYmxlIHBlcnNpc3RlbmNlCiAgICAgKiBjYXBhYmxlcy4KICAgICAq\nLwogICAgcHJpdmF0ZSB2b2lkIGFzc2VydFBDQ29sbGVjdGlvbihGaWVsZE1l\ndGFEYXRhIGZtZCwgU3RyaW5nIGF0dHIpCiAgICAgICAgdGhyb3dzIFNBWEV4\nY2VwdGlvbiB7CiAgICAgICAgc3dpdGNoIChmbWQuZ2V0RGVjbGFyZWRUeXBl\nQ29kZSgpKSB7CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLkFSUkFZOgog\nICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5DT0xMRUNUSU9OOgogICAgICAg\nICAgICBjYXNlIEphdmFUeXBlcy5NQVA6CiAgICAgICAgICAgICAgICBpZiAo\nSmF2YVR5cGVzLm1heWJlUEMoZm1kLmdldEVsZW1lbnQoKSkpCiAgICAgICAg\nICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAvLyBubyBicmVh\nawogICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgICAgdGhyb3cg\nZ2V0RXhjZXB0aW9uKF9sb2MuZ2V0KCJiYWQtbWV0YS1hbm5vIiwgZm1kLCBh\ndHRyKSk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogUGFyc2Ug\nb25lLXRvLW1hbnkuCiAgICAgKi8KICAgIHByb3RlY3RlZCB2b2lkIHBhcnNl\nT25lVG9NYW55KEZpZWxkTWV0YURhdGEgZm1kLCBBdHRyaWJ1dGVzIGF0dHJz\nKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24gewogICAgICAgIFN0cmlu\nZyB2YWwgPSBhdHRycy5nZXRWYWx1ZSgiZmV0Y2giKTsKICAgICAgICBpZiAo\ndmFsICE9IG51bGwpIHsKICAgICAgICAgICAgZm1kLnNldEluRGVmYXVsdEZl\ndGNoR3JvdXAoIkVBR0VSIi5lcXVhbHModmFsKSk7CiAgICAgICAgfQogICAg\nICAgIHZhbCA9IGF0dHJzLmdldFZhbHVlKCJ0YXJnZXQtZW50aXR5Iik7CiAg\nICAgICAgaWYgKHZhbCAhPSBudWxsKQogICAgICAgICAgICBmbWQuZ2V0RWxl\nbWVudCgpLnNldERlY2xhcmVkVHlwZShjbGFzc0Zvck5hbWUodmFsKSk7CiAg\nICAgICAgYXNzZXJ0UENDb2xsZWN0aW9uKGZtZCwgIk9uZVRvTWFueSIpOwog\nICAgICAgIGZtZC5zZXRTZXJpYWxpemVkKGZhbHNlKTsgLy8gb3ZlcnJpZGUg\nYW55IExvYiBhbm5vdGF0aW9uCiAgICAgICAgYm9vbGVhbiBvcnBoYW5SZW1v\ndmFsID0gQm9vbGVhbi52YWx1ZU9mKGF0dHJzLmdldFZhbHVlKAogICAgICAg\nICAgICAib3JwaGFuLXJlbW92YWwiKSk7CiAgICAgICAgc2V0T3JwaGFuUmVt\nb3ZhbChmbWQuZ2V0RWxlbWVudCgpLCBvcnBoYW5SZW1vdmFsKTsKICAgIH0K\nCiAgICBwcm90ZWN0ZWQgdm9pZCBzZXRPcnBoYW5SZW1vdmFsKFZhbHVlTWV0\nYURhdGEgdm1kLCBib29sZWFuIG9ycGhhblJlbW92YWwpIHsKICAgICAgICBp\nZiAob3JwaGFuUmVtb3ZhbCkKICAgICAgICAgICAgdm1kLnNldENhc2NhZGVE\nZWxldGUoVmFsdWVNZXRhRGF0YS5DQVNDQURFX0FVVE8pOwogICAgfQoKICAg\nIHByb3RlY3RlZCB2b2lkIHBhcnNlRWxlbWVudENvbGxlY3Rpb24oRmllbGRN\nZXRhRGF0YSBmbWQsIEF0dHJpYnV0ZXMgYXR0cnMpCiAgICAgICAgdGhyb3dz\nIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgU3RyaW5nIHZhbCA9IGF0dHJzLmdl\ndFZhbHVlKCJ0YXJnZXQtY2xhc3MiKTsKICAgICAgICBpZiAodmFsICE9IG51\nbGwpCiAgICAgICAgICAgIGZtZC5nZXRFbGVtZW50KCkuc2V0RGVjbGFyZWRU\neXBlKGNsYXNzRm9yTmFtZSh2YWwpKTsKCiAgICAgICAgaWYgKGZtZC5nZXRE\nZWNsYXJlZFR5cGVDb2RlKCkgIT0gSmF2YVR5cGVzLkNPTExFQ1RJT04gJiYK\nICAgICAgICAgICAgZm1kLmdldERlY2xhcmVkVHlwZUNvZGUoKSAhPSBKYXZh\nVHlwZXMuTUFQKQogICAgICAgICAgICB0aHJvdyBnZXRFeGNlcHRpb24oX2xv\nYy5nZXQoImJhZC1tZXRhLWFubm8iLCBmbWQsCiAgICAgICAgICAgICAgICAg\nICAgIkVsZW1lbnRDb2xsZWN0aW9uIikpOwoKICAgICAgICB2YWwgPSBhdHRy\ncy5nZXRWYWx1ZSgiZmV0Y2giKTsKICAgICAgICBpZiAodmFsICE9IG51bGwp\nCiAgICAgICAgICAgIGZtZC5zZXRJbkRlZmF1bHRGZXRjaEdyb3VwKCJFQUdF\nUiIuZXF1YWxzKHZhbCkpOwogICAgICAgIGZtZC5zZXRFbGVtZW50Q29sbGVj\ndGlvbih0cnVlKTsKICAgICAgICBmbWQuc2V0U2VyaWFsaXplZChmYWxzZSk7\nCiAgICAgICAgaWYgKEphdmFUeXBlcy5tYXliZVBDKGZtZC5nZXRFbGVtZW50\nKCkpICYmICFmbWQuZ2V0RWxlbWVudCgpLmdldERlY2xhcmVkVHlwZSgpLmlz\nRW51bSgpKSB7CiAgICAgICAgICAgIGZtZC5nZXRFbGVtZW50KCkuc2V0RW1i\nZWRkZWQodHJ1ZSk7CiAgICAgICAgICAgIGlmIChmbWQuZ2V0RWxlbWVudCgp\nLmdldEVtYmVkZGVkTWV0YURhdGEoKSA9PSBudWxsKQovLyAgICAgICAgICAg\nICAgICBmbWQuZ2V0RWxlbWVudCgpLmFkZEVtYmVkZGVkTWV0YURhdGEoKTsK\nICAgICAgICAgICAgICAgIGRlZmVyRW1iZWRkYWJsZShmbWQuZ2V0RWxlbWVu\ndCgpLmdldERlY2xhcmVkVHlwZSgpLAogICAgICAgICAgICAgICAgICAgIGZt\nZC5nZXRFbGVtZW50KCkpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAg\nICAqIFBhcnNlIG1hcC1rZXkuCiAgICAgKi8KICAgIHByaXZhdGUgYm9vbGVh\nbiBzdGFydE1hcEtleShBdHRyaWJ1dGVzIGF0dHJzKQogICAgICAgIHRocm93\ncyBTQVhFeGNlcHRpb24gewogICAgICAgIGlmICghaXNNYXBwaW5nT3ZlcnJp\nZGVNb2RlKCkpCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCiAgICAgICAg\nRmllbGRNZXRhRGF0YSBmbWQgPSAoRmllbGRNZXRhRGF0YSkgY3VycmVudEVs\nZW1lbnQoKTsKICAgICAgICBTdHJpbmcgbWFwS2V5ID0gYXR0cnMuZ2V0VmFs\ndWUoIm5hbWUiKTsKICAgICAgICBpZiAobWFwS2V5ID09IG51bGwpCiAgICAg\nICAgICAgIGZtZC5nZXRLZXkoKS5zZXRWYWx1ZU1hcHBlZEJ5KFZhbHVlTWV0\nYURhdGEuTUFQUEVEX0JZX1BLKTsKICAgICAgICBlbHNlCiAgICAgICAgICAg\nIGZtZC5nZXRLZXkoKS5zZXRWYWx1ZU1hcHBlZEJ5KG1hcEtleSk7CiAgICAg\nICAgcmV0dXJuIHRydWU7CiAgICB9CgoKICAgIC8qKgogICAgICogUGFyc2Ug\nbWFwLWtleS1jbGFzcy4KICAgICAqLwogICAgcHJpdmF0ZSBib29sZWFuIHN0\nYXJ0TWFwS2V5Q2xhc3MoQXR0cmlidXRlcyBhdHRycykKICAgIHRocm93cyBT\nQVhFeGNlcHRpb24gewogICAgICAgIGlmICghaXNNYXBwaW5nT3ZlcnJpZGVN\nb2RlKCkpCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCiAgICAgICAgRmll\nbGRNZXRhRGF0YSBmbWQgPSAoRmllbGRNZXRhRGF0YSkgY3VycmVudEVsZW1l\nbnQoKTsKICAgICAgICBTdHJpbmcgbWFwS2V5Q2xhc3MgPSBhdHRycy5nZXRW\nYWx1ZSgiY2xhc3MiKTsKCiAgICAgICAgaWYgKG1hcEtleUNsYXNzICE9IG51\nbGwpIHsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIGZtZC5n\nZXRLZXkoKS5zZXREZWNsYXJlZFR5cGUoQ2xhc3MuZm9yTmFtZShtYXBLZXlD\nbGFzcykpOwogICAgICAgICAgICB9IGNhdGNoIChDbGFzc05vdEZvdW5kRXhj\nZXB0aW9uIGUpIHsKICAgICAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2Fs\nQXJndW1lbnRFeGNlcHRpb24oIkNsYXNzIG5vdCBmb3VuZCIpOwogICAgICAg\nICAgICB9CiAgICAgICAgfSBlbHNlCiAgICAgICAgICAgIHRocm93IG5ldyBJ\nbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24oCiAgICAgICAgICAgICJUaGUgdmFs\ndWUgb2YgdGhlIE1hcEtleUNsYXNzIGNhbm5vdCBiZSBudWxsIik7CiAgICAg\nICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBQYXJzZSBv\ncmRlci1ieS4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIGVuZE9yZGVyQnko\nKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24gewogICAgICAgIEZpZWxk\nTWV0YURhdGEgZm1kID0gKEZpZWxkTWV0YURhdGEpIGN1cnJlbnRFbGVtZW50\nKCk7CiAgICAgICAgU3RyaW5nIGRlYyA9IGN1cnJlbnRUZXh0KCk7CiAgICAg\nICAgaWYgKGZtZC5pc0VsZW1lbnRDb2xsZWN0aW9uKCkgJiYKICAgICAgICAg\nICAgZm1kLmdldEVsZW1lbnQoKS5nZXRFbWJlZGRlZE1ldGFEYXRhKCkgIT0g\nbnVsbCB8fAogICAgICAgICAgICBpc0RlZmVycmVkRW1iZWRkYWJsZShmbWQu\nZ2V0RWxlbWVudCgpLmdldERlY2xhcmVkVHlwZSgpLAogICAgICAgICAgICAg\nICAgZm1kLmdldEVsZW1lbnQoKSkpIHsKICAgICAgICAgICAgaWYgKGRlYy5s\nZW5ndGgoKSA9PSAwIHx8IGRlYy5lcXVhbHMoIkFTQyIpIHx8CiAgICAgICAg\nICAgICAgICBkZWMuZXF1YWxzKCJERVNDIikpCiAgICAgICAgICAgICAgICB0\naHJvdyBuZXcgTWV0YURhdGFFeGNlcHRpb24oX2xvYy5nZXQoCiAgICAgICAg\nICAgICAgICAgICAgImludmFsaWQtb3JkZXJCeSIsIGZtZCkpOwogICAgICAg\nIH0KICAgICAgICBpZiAoU3RyaW5nVXRpbHMuaXNFbXB0eShkZWMpIHx8IGRl\nYy5lcXVhbHMoIkFTQyIpKQogICAgICAgICAgICBkZWMgPSBPcmRlci5FTEVN\nRU5UICsgIiBhc2MiOwogICAgICAgIGVsc2UgaWYgKGRlYy5lcXVhbHMoIkRF\nU0MiKSkKICAgICAgICAgICAgZGVjID0gT3JkZXIuRUxFTUVOVCArICIgZGVz\nYyI7CgogICAgICAgIGZtZC5zZXRPcmRlckRlY2xhcmF0aW9uKGRlYyk7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBQYXJzZSBuYW1lZC1xdWVyeS4KICAgICAq\nLwogICAgcHJvdGVjdGVkIGJvb2xlYW4gc3RhcnROYW1lZFF1ZXJ5KEF0dHJp\nYnV0ZXMgYXR0cnMpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAg\nICAgICAgaWYgKCFpc1F1ZXJ5TW9kZSgpKQogICAgICAgICAgICByZXR1cm4g\nZmFsc2U7CgogICAgICAgIFN0cmluZyBuYW1lID0gYXR0cnMuZ2V0VmFsdWUo\nIm5hbWUiKTsKICAgICAgICBMb2cgbG9nID0gZ2V0TG9nKCk7CiAgICAgICAg\naWYgKGxvZy5pc1RyYWNlRW5hYmxlZCgpKQogICAgICAgICAgICBsb2cudHJh\nY2UoX2xvYy5nZXQoInBhcnNlLXF1ZXJ5IiwgbmFtZSkpOwoKICAgICAgICBR\ndWVyeU1ldGFEYXRhIG1ldGEgPSBnZXRSZXBvc2l0b3J5KCkuc2VhcmNoUXVl\ncnlNZXRhRGF0YUJ5TmFtZShuYW1lKTsKICAgICAgICBpZiAobWV0YSAhPSBu\ndWxsKSB7CiAgICAgICAgCUNsYXNzPD8+IGRlZlR5cGUgPSBtZXRhLmdldERl\nZmluaW5nVHlwZSgpOwogICAgICAgICAgICBpZiAoKGRlZlR5cGUgIT0gX2Ns\ncykgJiYgbG9nLmlzV2FybkVuYWJsZWQoKSkgewogICAgICAgICAgICAgICAg\nbG9nLndhcm4oX2xvYy5nZXQoImR1cC1xdWVyeSIsIG5hbWUsIGN1cnJlbnRM\nb2NhdGlvbigpLAogICAgICAgICAgICAJICAgICAgICBkZWZUeXBlKSk7CiAg\nICAgICAgICAgIH0KICAgICAgICAgICAgcHVzaEVsZW1lbnQobWV0YSk7CiAg\nICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KCiAgICAgICAgbWV0\nYSA9IGdldFJlcG9zaXRvcnkoKS5hZGRRdWVyeU1ldGFEYXRhKG51bGwsIG5h\nbWUpOwogICAgICAgIG1ldGEuc2V0RGVmaW5pbmdUeXBlKF9jbHMpOwogICAg\nICAgIG1ldGEuc2V0UXVlcnlTdHJpbmcoYXR0cnMuZ2V0VmFsdWUoInF1ZXJ5\nIikpOwogICAgICAgIG1ldGEuc2V0TGFuZ3VhZ2UoSlBRTFBhcnNlci5MQU5H\nX0pQUUwpOwogICAgICAgIFN0cmluZyBsb2NrTW9kZVN0ciA9IGF0dHJzLmdl\ndFZhbHVlKCJsb2NrLW1vZGUiKTsKICAgICAgICBpZiAobG9ja01vZGVTdHIg\nIT0gbnVsbCkgewogICAgICAgICAgICBtZXRhLmFkZEhpbnQoIm9wZW5qcGEu\nRmV0Y2hQbGFuLlJlYWRMb2NrTW9kZSIsIExvY2tNb2RlVHlwZS52YWx1ZU9m\nKGxvY2tNb2RlU3RyKSk7CiAgICAgICAgfQogICAgICAgIExvY2F0b3IgbG9j\nYXRvciA9IGdldExvY2F0aW9uKCkuZ2V0TG9jYXRvcigpOwogICAgICAgIGlm\nIChsb2NhdG9yICE9IG51bGwpIHsKICAgICAgICAgICAgbWV0YS5zZXRMaW5l\nTnVtYmVyKE51bWJlcnMudmFsdWVPZihsb2NhdG9yLmdldExpbmVOdW1iZXIo\nKSkpOwogICAgICAgICAgICBtZXRhLnNldENvbE51bWJlcihOdW1iZXJzLnZh\nbHVlT2YobG9jYXRvci5nZXRDb2x1bW5OdW1iZXIoKSkpOwogICAgICAgIH0K\nICAgICAgICBPYmplY3QgY3VyID0gY3VycmVudEVsZW1lbnQoKTsKICAgICAg\nICBPYmplY3Qgc2NvcGUgPSAoY3VyIGluc3RhbmNlb2YgQ2xhc3NNZXRhRGF0\nYSkKICAgICAgICAgICAgPyAoKENsYXNzTWV0YURhdGEpIGN1cikuZ2V0RGVz\nY3JpYmVkVHlwZSgpIDogbnVsbDsKICAgICAgICBtZXRhLnNldFNvdXJjZShn\nZXRTb3VyY2VGaWxlKCksIHNjb3BlLCBTb3VyY2VUcmFja2VyLlNSQ19YTUwp\nOwogICAgICAgIGlmIChpc01ldGFEYXRhTW9kZSgpKQogICAgICAgICAgICBt\nZXRhLnNldFNvdXJjZU1vZGUoTU9ERV9NRVRBKTsKICAgICAgICBlbHNlIGlm\nIChpc01hcHBpbmdNb2RlKCkpCiAgICAgICAgICAgIG1ldGEuc2V0U291cmNl\nTW9kZShNT0RFX01BUFBJTkcpOwogICAgICAgIGVsc2UKICAgICAgICAgICAg\nbWV0YS5zZXRTb3VyY2VNb2RlKE1PREVfUVVFUlkpOwogICAgICAgIHB1c2hF\nbGVtZW50KG1ldGEpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAg\nIHByb3RlY3RlZCB2b2lkIGVuZE5hbWVkUXVlcnkoKQogICAgICAgIHRocm93\ncyBTQVhFeGNlcHRpb24gewogICAgICAgIHBvcEVsZW1lbnQoKTsKICAgIH0K\nCiAgICBwcm90ZWN0ZWQgYm9vbGVhbiBzdGFydFF1ZXJ5U3RyaW5nKEF0dHJp\nYnV0ZXMgYXR0cnMpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAg\nICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgcHJvdGVjdGVkIHZvaWQg\nZW5kUXVlcnlTdHJpbmcoKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24g\newogICAgICAgIFF1ZXJ5TWV0YURhdGEgbWV0YSA9IChRdWVyeU1ldGFEYXRh\nKSBjdXJyZW50RWxlbWVudCgpOwogICAgICAgIG1ldGEuc2V0UXVlcnlTdHJp\nbmcoY3VycmVudFRleHQoKSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBQYXJz\nZSBxdWVyeS1oaW50LgogICAgICovCiAgICBwcm90ZWN0ZWQgYm9vbGVhbiBz\ndGFydFF1ZXJ5SGludChBdHRyaWJ1dGVzIGF0dHJzKQogICAgICAgIHRocm93\ncyBTQVhFeGNlcHRpb24gewogICAgICAgIFF1ZXJ5TWV0YURhdGEgbWV0YSA9\nIChRdWVyeU1ldGFEYXRhKSBjdXJyZW50RWxlbWVudCgpOwogICAgICAgIG1l\ndGEuYWRkSGludChhdHRycy5nZXRWYWx1ZSgibmFtZSIpLCBhdHRycy5nZXRW\nYWx1ZSgidmFsdWUiKSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9Cgog\nICAgcHJvdGVjdGVkIHZvaWQgZW5kUXVlcnlIaW50KCkKICAgICAgICB0aHJv\nd3MgU0FYRXhjZXB0aW9uIHsKICAgIH0KCiAgICAvKioKICAgICAqIFBhcnNl\nIG5hdGl2ZS1uYW1lZC1xdWVyeS4KICAgICAqLwogICAgcHJvdGVjdGVkIGJv\nb2xlYW4gc3RhcnROYW1lZE5hdGl2ZVF1ZXJ5KEF0dHJpYnV0ZXMgYXR0cnMp\nCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgaWYgKCFp\nc1F1ZXJ5TW9kZSgpKQogICAgICAgICAgICByZXR1cm4gZmFsc2U7CgogICAg\nICAgIFN0cmluZyBuYW1lID0gYXR0cnMuZ2V0VmFsdWUoIm5hbWUiKTsKICAg\nICAgICBMb2cgbG9nID0gZ2V0TG9nKCk7CiAgICAgICAgaWYgKGxvZy5pc1Ry\nYWNlRW5hYmxlZCgpKQogICAgICAgICAgICBsb2cudHJhY2UoX2xvYy5nZXQo\nInBhcnNlLW5hdGl2ZS1xdWVyeSIsIG5hbWUpKTsKCiAgICAgICAgUXVlcnlN\nZXRhRGF0YSBtZXRhID0gZ2V0UmVwb3NpdG9yeSgpLmdldENhY2hlZFF1ZXJ5\nTWV0YURhdGEobnVsbCwgbmFtZSk7CiAgICAgICAgaWYgKG1ldGEgIT0gbnVs\nbCAmJiBsb2cuaXNXYXJuRW5hYmxlZCgpKQogICAgICAgICAgICBsb2cud2Fy\nbihfbG9jLmdldCgib3ZlcnJpZGUtcXVlcnkiLCBuYW1lLCBjdXJyZW50TG9j\nYXRpb24oKSkpOwoKICAgICAgICBtZXRhID0gZ2V0UmVwb3NpdG9yeSgpLmFk\nZFF1ZXJ5TWV0YURhdGEobnVsbCwgbmFtZSk7CiAgICAgICAgbWV0YS5zZXRE\nZWZpbmluZ1R5cGUoX2Nscyk7CiAgICAgICAgbWV0YS5zZXRRdWVyeVN0cmlu\nZyhhdHRycy5nZXRWYWx1ZSgicXVlcnkiKSk7CiAgICAgICAgbWV0YS5zZXRM\nYW5ndWFnZShRdWVyeUxhbmd1YWdlcy5MQU5HX1NRTCk7CiAgICAgICAgU3Ry\naW5nIHZhbCA9IGF0dHJzLmdldFZhbHVlKCJyZXN1bHQtY2xhc3MiKTsKICAg\nICAgICBpZiAodmFsICE9IG51bGwpIHsKICAgICAgICAgICAgQ2xhc3M8Pz4g\ndHlwZSA9IGNsYXNzRm9yTmFtZSh2YWwpOwogICAgICAgICAgICBpZiAoSW1w\nbEhlbHBlci5pc01hbmFnZWRUeXBlKGdldENvbmZpZ3VyYXRpb24oKSwgdHlw\nZSkpCiAgICAgICAgICAgICAgICBtZXRhLnNldENhbmRpZGF0ZVR5cGUodHlw\nZSk7CiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIG1ldGEuc2V0\nUmVzdWx0VHlwZSh0eXBlKTsKICAgICAgICB9CgogICAgICAgIHZhbCA9IGF0\ndHJzLmdldFZhbHVlKCJyZXN1bHQtc2V0LW1hcHBpbmciKTsKICAgICAgICBp\nZiAodmFsICE9IG51bGwpCiAgICAgICAgICAgIG1ldGEuc2V0UmVzdWx0U2V0\nTWFwcGluZ05hbWUodmFsKTsKCiAgICAgICAgT2JqZWN0IGN1ciA9IGN1cnJl\nbnRFbGVtZW50KCk7CiAgICAgICAgT2JqZWN0IHNjb3BlID0gKGN1ciBpbnN0\nYW5jZW9mIENsYXNzTWV0YURhdGEpCiAgICAgICAgICAgID8gKChDbGFzc01l\ndGFEYXRhKSBjdXIpLmdldERlc2NyaWJlZFR5cGUoKSA6IG51bGw7CiAgICAg\nICAgbWV0YS5zZXRTb3VyY2UoZ2V0U291cmNlRmlsZSgpLCBzY29wZSwgU291\ncmNlVHJhY2tlci5TUkNfWE1MKTsKICAgICAgICBMb2NhdG9yIGxvY2F0b3Ig\nPSBnZXRMb2NhdGlvbigpLmdldExvY2F0b3IoKTsKICAgICAgICBpZiAobG9j\nYXRvciAhPSBudWxsKSB7CiAgICAgICAgICAgIG1ldGEuc2V0TGluZU51bWJl\ncihOdW1iZXJzLnZhbHVlT2YobG9jYXRvci5nZXRMaW5lTnVtYmVyKCkpKTsK\nICAgICAgICAgICAgbWV0YS5zZXRDb2xOdW1iZXIoTnVtYmVycy52YWx1ZU9m\nKGxvY2F0b3IuZ2V0Q29sdW1uTnVtYmVyKCkpKTsKICAgICAgICB9CiAgICAg\nICAgaWYgKGlzTWV0YURhdGFNb2RlKCkpCiAgICAgICAgICAgIG1ldGEuc2V0\nU291cmNlTW9kZShNT0RFX01FVEEpOwogICAgICAgIGVsc2UgaWYgKGlzTWFw\ncGluZ01vZGUoKSkKICAgICAgICAgICAgbWV0YS5zZXRTb3VyY2VNb2RlKE1P\nREVfTUFQUElORyk7CiAgICAgICAgZWxzZQogICAgICAgICAgICBtZXRhLnNl\ndFNvdXJjZU1vZGUoTU9ERV9RVUVSWSk7CiAgICAgICAgcHVzaEVsZW1lbnQo\nbWV0YSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgcHJvdGVj\ndGVkIHZvaWQgZW5kTmFtZWROYXRpdmVRdWVyeSgpCiAgICAgICAgdGhyb3dz\nIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgcG9wRWxlbWVudCgpOwogICAgfQoK\nICAgIC8qKgogICAgICogU3RhcnQgZW50aXR5LWxpc3RlbmVycwogICAgICov\nCiAgICBwcml2YXRlIGJvb2xlYW4gc3RhcnRFbnRpdHlMaXN0ZW5lcnMoQXR0\ncmlidXRlcyBhdHRycykKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsK\nICAgICAgICBpZiAoIWlzTWV0YURhdGFNb2RlKCkpCiAgICAgICAgICAgIHJl\ndHVybiBmYWxzZTsKICAgICAgICBpZiAoY3VycmVudEVsZW1lbnQoKSA9PSBu\ndWxsKQogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKCiAgICAgICAgLy8gcmVz\nZXQgbGlzdGVuZXJzIGRlY2xhcmVkIGluIGFubm90YXRpb25zLgogICAgICAg\nIExpZmVjeWNsZU1ldGFEYXRhIG1ldGEgPSAoKENsYXNzTWV0YURhdGEpIGN1\ncnJlbnRFbGVtZW50KCkpLgogICAgICAgICAgICBnZXRMaWZlY3ljbGVNZXRh\nRGF0YSgpOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgTGlmZWN5Y2xl\nRXZlbnQuQUxMX0VWRU5UUy5sZW5ndGg7IGkrKykKICAgICAgICAgICAgbWV0\nYS5zZXREZWNsYXJlZENhbGxiYWNrcyhpLCBudWxsLCAwKTsKICAgICAgICBy\nZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvKioKICAgICAqIFBhcnNlIGV4Y2x1\nZGUtZGVmYXVsdC1saXN0ZW5lcnMuCiAgICAgKi8KICAgIHByaXZhdGUgYm9v\nbGVhbiBzdGFydEV4Y2x1ZGVEZWZhdWx0TGlzdGVuZXJzKEF0dHJpYnV0ZXMg\nYXR0cnMpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAg\naWYgKCFpc01ldGFEYXRhTW9kZSgpKQogICAgICAgICAgICByZXR1cm4gZmFs\nc2U7CiAgICAgICAgQ2xhc3NNZXRhRGF0YSBtZXRhID0gKENsYXNzTWV0YURh\ndGEpIGN1cnJlbnRFbGVtZW50KCk7CiAgICAgICAgbWV0YS5nZXRMaWZlY3lj\nbGVNZXRhRGF0YSgpLnNldElnbm9yZVN5c3RlbUxpc3RlbmVycyh0cnVlKTsK\nICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvKioKICAgICAqIFBh\ncnNlIGV4Y2x1ZGUtc3VwZXJjbGFzcy1saXN0ZW5lcnMuCiAgICAgKi8KICAg\nIHByaXZhdGUgYm9vbGVhbiBzdGFydEV4Y2x1ZGVTdXBlcmNsYXNzTGlzdGVu\nZXJzKEF0dHJpYnV0ZXMgYXR0cnMpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2Vw\ndGlvbiB7CiAgICAgICAgaWYgKCFpc01ldGFEYXRhTW9kZSgpKQogICAgICAg\nICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgQ2xhc3NNZXRhRGF0YSBtZXRh\nID0gKENsYXNzTWV0YURhdGEpIGN1cnJlbnRFbGVtZW50KCk7CiAgICAgICAg\nbWV0YS5nZXRMaWZlY3ljbGVNZXRhRGF0YSgpLnNldElnbm9yZVN1cGVyY2xh\nc3NDYWxsYmFja3MKICAgICAgICAgICAgKExpZmVjeWNsZU1ldGFEYXRhLklH\nTk9SRV9ISUdIKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAv\nKioKICAgICAqIFBhcnNlIGVudGl0eS1saXN0ZW5lci4KICAgICAqLwogICAg\ncHJpdmF0ZSBib29sZWFuIHN0YXJ0RW50aXR5TGlzdGVuZXIoQXR0cmlidXRl\ncyBhdHRycykKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAg\nICBfbGlzdGVuZXIgPSBjbGFzc0Zvck5hbWUoYXR0cnMuZ2V0VmFsdWUoImNs\nYXNzIikpOwogICAgICAgIGJvb2xlYW4gc3lzdGVtID0gY3VycmVudEVsZW1l\nbnQoKSA9PSBudWxsOwogICAgICAgIENvbGxlY3Rpb248TGlmZWN5Y2xlQ2Fs\nbGJhY2tzPltdIHBhcnNlZCA9CiAgICAgICAgICAgIEFubm90YXRpb25QZXJz\naXN0ZW5jZU1ldGFEYXRhUGFyc2VyLnBhcnNlQ2FsbGJhY2tNZXRob2RzKF9s\naXN0ZW5lciwKICAgICAgICAgICAgICAgIG51bGwsIHRydWUsIHRydWUsIF9y\nZXBvcyk7CiAgICAgICAgaWYgKHBhcnNlZCA9PSBudWxsKQogICAgICAgICAg\nICByZXR1cm4gdHJ1ZTsKCiAgICAgICAgaWYgKF9jYWxsYmFja3MgPT0gbnVs\nbCkgewogICAgICAgICAgICBfY2FsbGJhY2tzID0gKENvbGxlY3Rpb248TGlm\nZWN5Y2xlQ2FsbGJhY2tzPltdKQogICAgICAgICAgICAgICAgbmV3IENvbGxl\nY3Rpb25bTGlmZWN5Y2xlRXZlbnQuQUxMX0VWRU5UUy5sZW5ndGhdOwogICAg\nICAgICAgICBpZiAoIXN5c3RlbSkKICAgICAgICAgICAgICAgIF9oaWdocyA9\nIG5ldyBpbnRbTGlmZWN5Y2xlRXZlbnQuQUxMX0VWRU5UUy5sZW5ndGhdOwog\nICAgICAgIH0KICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IHBhcnNlZC5s\nZW5ndGg7IGkrKykgewogICAgICAgICAgICBpZiAocGFyc2VkW2ldID09IG51\nbGwpCiAgICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgaWYg\nKF9jYWxsYmFja3NbaV0gPT0gbnVsbCkKICAgICAgICAgICAgICAgIF9jYWxs\nYmFja3NbaV0gPSBwYXJzZWRbaV07CiAgICAgICAgICAgIGVsc2UKICAgICAg\nICAgICAgICAgIF9jYWxsYmFja3NbaV0uYWRkQWxsKHBhcnNlZFtpXSk7CiAg\nICAgICAgICAgIGlmICghc3lzdGVtKQogICAgICAgICAgICAgICAgX2hpZ2hz\nW2ldICs9IHBhcnNlZFtpXS5zaXplKCk7CiAgICAgICAgfQogICAgICAgIHJl\ndHVybiB0cnVlOwogICAgfQoKICAgIHByaXZhdGUgdm9pZCBlbmRFbnRpdHlM\naXN0ZW5lcigpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAg\nICAgLy8gc2hvdWxkIGJlIGluIGVuZEVudGl0eUxpc3RlbmVycyBJIHRoaW5r\nIHRvIG1lcmdlIGNhbGxiYWNrcwogICAgICAgIC8vIGludG8gYSBzaW5nbGUg\nbGlzdGVuZXIuICBCdXQgdGhlbiB0aGUgdXNlciBjYW5ub3QgcmVtb3ZlLgog\nICAgICAgIGlmIChjdXJyZW50RWxlbWVudCgpID09IG51bGwgJiYgX2NhbGxi\nYWNrcyAhPSBudWxsKSB7CiAgICAgICAgICAgIF9yZXBvcy5hZGRTeXN0ZW1M\naXN0ZW5lcihuZXcgUGVyc2lzdGVuY2VMaXN0ZW5lckFkYXB0ZXIKICAgICAg\nICAgICAgICAgIChfY2FsbGJhY2tzKSk7CiAgICAgICAgICAgIF9jYWxsYmFj\na3MgPSBudWxsOwogICAgICAgIH0KICAgICAgICBfbGlzdGVuZXIgPSBudWxs\nOwogICAgfQoKICAgIHByaXZhdGUgYm9vbGVhbiBzdGFydENhbGxiYWNrKE1l\ndGFEYXRhVGFnIGNhbGxiYWNrLCBBdHRyaWJ1dGVzIGF0dHJzKQogICAgICAg\nIHRocm93cyBTQVhFeGNlcHRpb24gewogICAgICAgIGlmICghaXNNZXRhRGF0\nYU1vZGUoKSkKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIGlu\ndFtdIGV2ZW50cyA9IE1ldGFEYXRhUGFyc2Vycy5nZXRFdmVudFR5cGVzKGNh\nbGxiYWNrLCBfY29uZik7CiAgICAgICAgaWYgKGV2ZW50cyA9PSBudWxsKQog\nICAgICAgICAgICByZXR1cm4gZmFsc2U7CgogICAgICAgIGJvb2xlYW4gc3lz\ndGVtID0gY3VycmVudEVsZW1lbnQoKSA9PSBudWxsOwoKICAgICAgICAvLyBJ\nZiBpbiBhIG11bHRpLWxldmVsIHBhcnNlLCBkbyBub3QgYWRkIHN5c3RlbSBs\nZXZlbCBsaXN0ZW5lcnMuCiAgICAgICAgLy8gT3RoZXJ3aXNlLCB0aGV5IHdp\nbGwgZ2V0IGFkZGVkIG11bHRpcGxlIHRpbWVzLgogICAgICAgIGlmIChzeXN0\nZW0gJiYgX3BhcnNlTGlzdCAhPSBudWxsICYmIF9wYXJzZUxpc3Quc2l6ZSgp\nID4gMCkgewogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQoK\nICAgICAgICBDbGFzczw/PiB0eXBlID0gY3VycmVudEVsZW1lbnQoKSA9PSBu\ndWxsID8gbnVsbCA6CiAgICAgICAgICAgICgoQ2xhc3NNZXRhRGF0YSkgY3Vy\ncmVudEVsZW1lbnQoKSkuZ2V0RGVzY3JpYmVkVHlwZSgpOwogICAgICAgIGlm\nICh0eXBlID09IG51bGwpCiAgICAgICAgICAgIHR5cGUgPSBPYmplY3QuY2xh\nc3M7CgogICAgICAgIGlmIChfY2FsbGJhY2tzID09IG51bGwpIHsKICAgICAg\nICAgICAgX2NhbGxiYWNrcyA9IChDb2xsZWN0aW9uPExpZmVjeWNsZUNhbGxi\nYWNrcz5bXSkKICAgICAgICAgICAgICAgIG5ldyBDb2xsZWN0aW9uW0xpZmVj\neWNsZUV2ZW50LkFMTF9FVkVOVFMubGVuZ3RoXTsKICAgICAgICAgICAgaWYg\nKCFzeXN0ZW0pCiAgICAgICAgICAgICAgICBfaGlnaHMgPSBuZXcgaW50W0xp\nZmVjeWNsZUV2ZW50LkFMTF9FVkVOVFMubGVuZ3RoXTsKICAgICAgICB9Cgog\nICAgICAgIExpZmVjeWNsZUNhbGxiYWNrcyBhZGFwdGVyOwogICAgICAgIGlm\nIChfbGlzdGVuZXIgIT0gbnVsbCkKICAgICAgICAgICAgYWRhcHRlciA9IG5l\ndyBCZWFuTGlmZWN5Y2xlQ2FsbGJhY2tzKF9saXN0ZW5lciwKICAgICAgICAg\nICAgICAgIGF0dHJzLmdldFZhbHVlKCJtZXRob2QtbmFtZSIpLCBmYWxzZSwg\ndHlwZSk7CiAgICAgICAgZWxzZQogICAgICAgICAgICBhZGFwdGVyID0gbmV3\nIE1ldGhvZExpZmVjeWNsZUNhbGxiYWNrcyhfY2xzLAogICAgICAgICAgICAg\nICAgYXR0cnMuZ2V0VmFsdWUoIm1ldGhvZC1uYW1lIiksIGZhbHNlKTsKCiAg\nICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBldmVudHMubGVuZ3RoOyBpKysp\nIHsKICAgICAgICAgICAgaW50IGV2ZW50ID0gZXZlbnRzW2ldOwogICAgICAg\nICAgICBpZiAoX2xpc3RlbmVyICE9IG51bGwpIHsKICAgICAgICAgICAgICAg\nIE1ldGFEYXRhUGFyc2Vycy52YWxpZGF0ZU1ldGhvZHNGb3JTYW1lQ2FsbGJh\nY2soX2xpc3RlbmVyLAogICAgICAgICAgICAgICAgICAgIF9jYWxsYmFja3Nb\nZXZlbnRdLCAoKEJlYW5MaWZlY3ljbGVDYWxsYmFja3MpIGFkYXB0ZXIpLgog\nICAgICAgICAgICAgICAgICAgIGdldENhbGxiYWNrTWV0aG9kKCksIGNhbGxi\nYWNrLCBfY29uZiwgZ2V0TG9nKCkpOwogICAgICAgICAgICB9IGVsc2Ugewog\nICAgICAgICAgICAgICAgTWV0YURhdGFQYXJzZXJzLnZhbGlkYXRlTWV0aG9k\nc0ZvclNhbWVDYWxsYmFjayhfY2xzLAogICAgICAgICAgICAgICAgICAgIF9j\nYWxsYmFja3NbZXZlbnRdLCAoKE1ldGhvZExpZmVjeWNsZUNhbGxiYWNrcykg\nYWRhcHRlcikuCiAgICAgICAgICAgICAgICAgICAgZ2V0Q2FsbGJhY2tNZXRo\nb2QoKSwgY2FsbGJhY2ssIF9jb25mLCBnZXRMb2coKSk7CgogICAgICAgICAg\nICB9CiAgICAgICAgICAgIGlmIChfY2FsbGJhY2tzW2V2ZW50XSA9PSBudWxs\nKQogICAgICAgICAgICAgICAgX2NhbGxiYWNrc1tldmVudF0gPSBuZXcgQXJy\nYXlMaXN0PExpZmVjeWNsZUNhbGxiYWNrcz4oMyk7CiAgICAgICAgICAgIF9j\nYWxsYmFja3NbZXZlbnRdLmFkZChhZGFwdGVyKTsKICAgICAgICAgICAgaWYg\nKCFzeXN0ZW0gJiYgX2xpc3RlbmVyICE9IG51bGwpCiAgICAgICAgICAgICAg\nICBfaGlnaHNbZXZlbnRdKys7CiAgICAgICAgfQogICAgICAgIHJldHVybiB0\ncnVlOwogICAgfQoKICAgIC8qKgogICAgICogU3RvcmUgbGlmZWN5Y2xlIG1l\ndGFkYXRhLgogICAgICovCiAgICBwcml2YXRlIHZvaWQgc3RvcmVDYWxsYmFj\na3MoQ2xhc3NNZXRhRGF0YSBjbHMpIHsKICAgICAgICBMaWZlY3ljbGVNZXRh\nRGF0YSBtZXRhID0gY2xzLmdldExpZmVjeWNsZU1ldGFEYXRhKCk7CiAgICAg\nICAgQ2xhc3M8Pz4gc3VwQ2xzID0gY2xzLmdldERlc2NyaWJlZFR5cGUoKS5n\nZXRTdXBlcmNsYXNzKCk7CiAgICAgICAgQ29sbGVjdGlvbjxMaWZlY3ljbGVD\nYWxsYmFja3M+W10gc3VwQ2FsbHMgPSBudWxsOwogICAgICAgIGlmICghT2Jq\nZWN0LmNsYXNzLmVxdWFscyhzdXBDbHMpKSB7CiAgICAgICAgICAgIHN1cENh\nbGxzID0gQW5ub3RhdGlvblBlcnNpc3RlbmNlTWV0YURhdGFQYXJzZXIucGFy\nc2VDYWxsYmFja01ldGhvZHMKICAgICAgICAgICAgICAgIChzdXBDbHMsIG51\nbGwsIHRydWUsIGZhbHNlLCBfcmVwb3MpOwogICAgICAgIH0KICAgICAgICBp\nZiAoc3VwQ2FsbHMgIT0gbnVsbCkgewogICAgICAgICAgICBmb3IgKGludCBl\ndmVudCA6IExpZmVjeWNsZUV2ZW50LkFMTF9FVkVOVFMpIHsKICAgICAgICAg\nICAgICAgIGlmIChzdXBDYWxsc1tldmVudF0gPT0gbnVsbCkKICAgICAgICAg\nICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgICAgIG1ldGEuc2V0\nTm9uUENTdXBlcmNsYXNzQ2FsbGJhY2tzKGV2ZW50LCBzdXBDYWxsc1tldmVu\ndF0udG9BcnJheQogICAgICAgICAgICAgICAgICAgIChuZXcgTGlmZWN5Y2xl\nQ2FsbGJhY2tzW3N1cENhbGxzW2V2ZW50XS5zaXplKCldKSwgMCk7CiAgICAg\nICAgICAgIH0KICAgICAgICB9CiAgICAgICAgaWYgKF9jYWxsYmFja3MgPT0g\nbnVsbCkKICAgICAgICAgICAgcmV0dXJuOwoKICAgICAgICBmb3IgKGludCBl\ndmVudCA6IExpZmVjeWNsZUV2ZW50LkFMTF9FVkVOVFMpIHsKICAgICAgICAg\nICAgaWYgKF9jYWxsYmFja3NbZXZlbnRdID09IG51bGwpCiAgICAgICAgICAg\nICAgICBjb250aW51ZTsKICAgICAgICAgICAgbWV0YS5zZXREZWNsYXJlZENh\nbGxiYWNrcyhldmVudCwgKExpZmVjeWNsZUNhbGxiYWNrc1tdKQogICAgICAg\nICAgICAgICAgX2NhbGxiYWNrc1tldmVudF0udG9BcnJheQogICAgICAgICAg\nICAgICAgICAgIChuZXcgTGlmZWN5Y2xlQ2FsbGJhY2tzW19jYWxsYmFja3Nb\nZXZlbnRdLnNpemUoKV0pLAogICAgICAgICAgICAgICAgX2hpZ2hzW2V2ZW50\nXSk7CiAgICAgICAgfQogICAgICAgIF9jYWxsYmFja3MgPSBudWxsOwogICAg\nICAgIF9oaWdocyA9IG51bGw7CiAgICB9CgogICAgcHJvdGVjdGVkIGJvb2xl\nYW4gc3RhcnRPcmRlckNvbHVtbihBdHRyaWJ1dGVzIGF0dHJzKQogICAgICAg\nIHRocm93cyBTQVhFeGNlcHRpb24gewogICAgICAgIHJldHVybiB0cnVlOwog\nICAgfQoKICAgIC8qKgogICAgICogSW5zdGFudGlhdGUgdGhlIGdpdmVuIGNs\nYXNzLCB0YWtpbmcgaW50byBhY2NvdW50IHRoZSBkZWZhdWx0IHBhY2thZ2Uu\nCgkgKi8KCXByb3RlY3RlZCBDbGFzczw/PiBjbGFzc0Zvck5hbWUoU3RyaW5n\nIG5hbWUpCgkJdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CgkJaWYgKCJFbnRpdHki\nLmVxdWFscyhuYW1lKSkKCQkJcmV0dXJuIFBlcnNpc3RlbmNlQ2FwYWJsZS5j\nbGFzczsKCQlyZXR1cm4gc3VwZXIuY2xhc3NGb3JOYW1lKG5hbWUsIGlzUnVu\ndGltZSgpKTsKCX0KCgkvKioKCSAqIFByb2Nlc3MgYWxsIGRlZmVycmVkIGVt\nYmVkZGFibGVzIHVzaW5nIGFuIHVua25vd24gYWNjZXNzIHR5cGUuCgkgKi8K\nCXByb3RlY3RlZCB2b2lkIGFkZERlZmVycmVkRW1iZWRkYWJsZU1ldGFEYXRh\nKCkgewoJICAgIGlmIChfZW1iZWRkYWJsZXMgIT0gbnVsbCAmJiBfZW1iZWRk\nYWJsZXMuc2l6ZSgpID4gMCkgewoJICAgICAgICAvLyBSZXZlcnNlIGl0ZXJh\ndGUgdGhlIGFycmF5IG9mIHJlbWFpbmluZyBkZWZlcnJlZCBlbWJlZGRhYmxl\ncwoJICAgICAgICAvLyBzaW5jZSBlbGVtZW50cyB3aWxsIGJlIHJlbW92ZWQg\nYXMgdGhleSBhcmUgcHJvY2Vzc2VkLgoJICAgICAgICBDbGFzczw/PltdIGNs\nYXNzZXMgPSBfZW1iZWRkYWJsZXMua2V5U2V0KCkudG9BcnJheSgKCSAgICAg\nICAgICAgIG5ldyBDbGFzczw/PltfZW1iZWRkYWJsZXMuc2l6ZSgpXSk7Cgkg\nICAgICAgIGZvciAoaW50IGkgPSBjbGFzc2VzLmxlbmd0aCAtIDEgOyBpID49\nIDA7IGktLSkgewoJICAgICAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgICAg\nICBJbnRlZ2VyIGFjY2VzcyA9IF9lbWJlZGRhYmxlQWNjZXNzLmdldChjbGFz\nc2VzW2ldKTsKCSAgICAgICAgICAgICAgICBpZiAoYWNjZXNzID09IG51bGwp\nIHsKCSAgICAgICAgICAgICAgICAgICAgYWNjZXNzID0gQWNjZXNzQ29kZS5V\nTktOT1dOOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBh\nZGREZWZlcnJlZEVtYmVkZGFibGVNZXRhRGF0YShjbGFzc2VzW2ldLAoJICAg\nICAgICAgICAgICAgICAgICBhY2Nlc3MpOwoJICAgICAgICAgICAgfQoJICAg\nICAgICAgICAgY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CgkgICAgICAgICAgICAg\nICAgdGhyb3cgbmV3IE1ldGFEYXRhRXhjZXB0aW9uKAoJICAgICAgICAgICAg\nICAgICAgICBfbG9jLmdldCgibm8tZW1iZWRkYWJsZS1tZXRhZGF0YSIsCgkg\nICAgICAgICAgICAgICAgICAgICAgICBjbGFzc2VzW2ldLmdldE5hbWUoKSks\nIGUpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgfQkKCX0KCQog\nICAgLyoqCiAgICAgKiBQcm9jZXNzIGFsbCBkZWZlcnJlZCBlbWJlZGRhYmxl\ncyBhbmQgZW1iZWRkYWJsZSBtYXBwaW5nIG92ZXJyaWRlcwogICAgICogZm9y\nIGEgZ2l2ZW4gY2xhc3MuICBUaGlzIHNob3VsZCBvbmx5IGhhcHBlbiBhZnRl\nciB0aGUgYWNjZXNzIHR5cGUKICAgICAqIG9mIHRoZSBlbWJlZGRhYmxlIGlz\nIGtub3duLgogICAgICoKICAgICAqIEBwYXJhbSBlbWJlZFR5cGUgZW1iZWRk\nYWJsZSBjbGFzcwogICAgICogQHBhcmFtIGFjY2VzcyBjbGFzcyBsZXZlbCBh\nY2Nlc3MgZm9yIGVtYmVkZGFibGUKICAgICAqIEB0aHJvd3MgU0FYRXhjZXB0\naW9uCiAgICAgKi8KICAgIHByb3RlY3RlZCB2b2lkIGFkZERlZmVycmVkRW1i\nZWRkYWJsZU1ldGFEYXRhKENsYXNzPD8+IGVtYmVkVHlwZSwKICAgICAgICBp\nbnQgYWNjZXNzKSB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICBBcnJh\neUxpc3Q8TWV0YURhdGFDb250ZXh0PiBmbWRzID0gX2VtYmVkZGFibGVzLmdl\ndChlbWJlZFR5cGUpOwogICAgICAgIGlmIChmbWRzICE9IG51bGwgJiYgZm1k\ncy5zaXplKCkgPiAwKSB7CiAgICAgICAgICAgIGZvciAoTWV0YURhdGFDb250\nZXh0IG1kIDogZm1kcykgewogICAgICAgICAgICAgICAgaWYgKG1kIGluc3Rh\nbmNlb2YgRmllbGRNZXRhRGF0YSkgewogICAgICAgICAgICAgICAgICAgIEZp\nZWxkTWV0YURhdGEgZm1kID0gKEZpZWxkTWV0YURhdGEpbWQ7CiAgICAgICAg\nICAgICAgICAgICAgZm1kLmFkZEVtYmVkZGVkTWV0YURhdGEoYWNjZXNzKTsK\nICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgaWYgKG1k\nIGluc3RhbmNlb2YgVmFsdWVNZXRhRGF0YSkgewogICAgICAgICAgICAgICAg\nICAgIFZhbHVlTWV0YURhdGEgdm1kID0gKFZhbHVlTWV0YURhdGEpbWQ7CiAg\nICAgICAgICAgICAgICAgICAgdm1kLmFkZEVtYmVkZGVkTWV0YURhdGEoYWNj\nZXNzKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAg\nICAgICBhcHBseURlZmVycmVkRW1iZWRkYWJsZU92ZXJyaWRlcyhlbWJlZFR5\ncGUpOwogICAgICAgICAgICAvLyBDbGVhbiB1cCBkZWZlcnJhbHMgYWZ0ZXIg\ndGhleSBoYXZlIGJlZW4gcHJvY2Vzc2VkCiAgICAgICAgICAgIGZtZHMuY2xl\nYXIoKTsKICAgICAgICAgICAgX2VtYmVkZGFibGVzLnJlbW92ZShlbWJlZFR5\ncGUpOwogICAgICAgIH0KICAgIH0KICAgIHByb3RlY3RlZCB2b2lkIHNldERl\nZmVycmVkRW1iZWRkYWJsZUFjY2Vzc1R5cGUoQ2xhc3M8Pz4gZW1iZWRUeXBl\nLAogICAgICAgIGludCBhY2Nlc3MpIHsKICAgICAgICBfZW1iZWRkYWJsZUFj\nY2Vzcy5wdXQoZW1iZWRUeXBlLCBhY2Nlc3MpOwogICAgfQoKICAgIC8qCiAg\nICAgKiBDbGVhciBhbnkgZGVmZXJyZWQgbWV0YWRhdGEKICAgICAqLwogICAg\nQE92ZXJyaWRlCiAgICBwcm90ZWN0ZWQgdm9pZCBjbGVhckRlZmVycmVkTWV0\nYURhdGEoKSB7CiAgICAgICAgX2VtYmVkZGFibGVzLmNsZWFyKCk7CiAgICAg\nICAgX2VtYmVkZGFibGVBY2Nlc3MuY2xlYXIoKTsKICAgIH0KCiAgICAvKgog\nICAgICogRGV0ZXJtaW5lcyB3aGV0aGVyIHRoZSBlbWJlZGRhYmxlIHR5cGUg\naXMgZGVmZXJyZWQuCiAgICAgKi8KICAgIHByb3RlY3RlZCBib29sZWFuIGlz\nRGVmZXJyZWRFbWJlZGRhYmxlKENsYXNzPD8+IGVtYmVkVHlwZSwKICAgICAg\nICBNZXRhRGF0YUNvbnRleHQgZm1kKSB7CiAgICAgICAgQXJyYXlMaXN0PE1l\ndGFEYXRhQ29udGV4dD4gZm1kcyA9IF9lbWJlZGRhYmxlcy5nZXQoZW1iZWRU\neXBlKTsKICAgICAgICBpZiAoZm1kcyAhPSBudWxsKSB7CiAgICAgICAgICAg\nIHJldHVybiBmbWRzLmNvbnRhaW5zKGZtZCk7CiAgICAgICAgfQogICAgICAg\nIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICAvKgogICAgICogQWRkIHRoZSBm\nbWQgdG8gdGhlIGRlZmVyIGxpc3QgZm9yIGZvciB0aGUgZ2l2ZW4gZW1iZWRk\nYWJsZSB0eXBlCiAgICAgKi8KICAgIHByb3RlY3RlZCB2b2lkIGRlZmVyRW1i\nZWRkYWJsZShDbGFzczw/PiBlbWJlZFR5cGUsIE1ldGFEYXRhQ29udGV4dCBm\nbWQpIHsKICAgICAgICBBcnJheUxpc3Q8TWV0YURhdGFDb250ZXh0PiBmbWRz\nID0gX2VtYmVkZGFibGVzLmdldChlbWJlZFR5cGUpOwogICAgICAgIGlmIChm\nbWRzID09IG51bGwpIHsKICAgICAgICAgICAgZm1kcyA9IG5ldyBBcnJheUxp\nc3Q8TWV0YURhdGFDb250ZXh0PigpOwogICAgICAgICAgICBfZW1iZWRkYWJs\nZXMucHV0KGVtYmVkVHlwZSwgZm1kcyk7CiAgICAgICAgfQogICAgICAgIGZt\nZHMuYWRkKGZtZCk7CiAgICB9CgogICAgLyoKICAgICAqIEFwcGx5IGFueSBk\nZWZlcnJlZCBvdmVycmlkZXMuCiAgICAgKi8KICAgIHByb3RlY3RlZCB2b2lk\nIGFwcGx5RGVmZXJyZWRFbWJlZGRhYmxlT3ZlcnJpZGVzKENsYXNzPD8+IGNs\ncykKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgIH0KCgkvKgoJ\nICogQWRkIHRoZSBhcnJheSBvZiBjbGFzc2VzIHRvIHRoZSBhY3RpdmUgcGFy\nc2UgbGlzdC4KCSAqLwogICAgcHVibGljIHZvaWQgYWRkVG9QYXJzZUxpc3Qo\nQXJyYXlMaXN0PENsYXNzPD8+PiBwYXJzZUxpc3QpIHsKICAgICAgICBpZiAo\ncGFyc2VMaXN0ID09IG51bGwpCiAgICAgICAgICAgIHJldHVybjsKICAgICAg\nICBfcGFyc2VMaXN0LmFkZEFsbChwYXJzZUxpc3QpOwogICAgfQoKICAgIC8q\nCiAgICAgKiBBZGQgdGhlIGNsYXNzIHRvIHRoZSBhY3RpdmUgcGFyc2UgbGlz\ndC4KICAgICAqLwogICAgcHVibGljIHZvaWQgYWRkVG9QYXJzZUxpc3QoQ2xh\nc3M8Pz4gcGFyZW50Q2xzKSB7CiAgICAgICAgaWYgKHBhcmVudENscyA9PSBu\ndWxsKQogICAgICAgICAgICByZXR1cm47CiAgICAgICAgX3BhcnNlTGlzdC5h\nZGQocGFyZW50Q2xzKTsKICAgIH0KCiAgICAvKgogICAgICogV2hldGhlciB0\naGUgYWN0aXZlIHBhcnNlIGxpc3QgY29udGFpbnMgdGhlIHNwZWNpZmllZCBj\nbGFzcy4KICAgICAqLwogICAgcHVibGljIGJvb2xlYW4gcGFyc2VMaXN0Q29u\ndGFpbnMoQ2xhc3M8Pz4gY2xzKSB7CiAgICAgICAgaWYgKF9wYXJzZUxpc3Qu\nc2l6ZSgpID09IDApCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAg\nICByZXR1cm4gX3BhcnNlTGlzdC5jb250YWlucyhjbHMpOwogICAgfQoKICAg\nIC8qCiAgICAgKiBSZXR1cm5zIHRoZSBsaXN0IG9mIGNsYXNzZXMgYWN0aXZl\nbHkgYmVpbmcgcGFyc2VkLgogICAgICovCiAgICBwdWJsaWMgQXJyYXlMaXN0\nPENsYXNzPD8+PiBnZXRQYXJzZUxpc3QoKSB7CiAgICAgICAgcmV0dXJuIF9w\nYXJzZUxpc3Q7CiAgICB9CgogICAgLyoKICAgICAqIFJldHVybnMgY2xhc3Mg\nY3VycmVudGx5IGJlaW5nIHBhcnNlZC4KICAgICAqLwogICAgcHVibGljIENs\nYXNzPD8+IGdldFBhcnNlQ2xhc3MoKSB7CiAgICAgICAgcmV0dXJuIF9jbHM7\nCiAgICB9CgogICAgcHJvdGVjdGVkIGJvb2xlYW4gc3RhcnREZWxpbWl0ZWRJ\nZGVudGlmaWVycygpIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAg\nICAKICAgIHByb3RlY3RlZCBTdHJpbmcgbm9ybWFsaXplU2VxdWVuY2VOYW1l\nKFN0cmluZyBzZXFOYW1lKSB7CiAgICAgICAgcmV0dXJuIHNlcU5hbWU7CiAg\nICB9CgogICAgcHJvdGVjdGVkIFN0cmluZyBub3JtYWxpemVTY2hlbWFOYW1l\nKFN0cmluZyBzY2hOYW1lKSB7CiAgICAgICAgcmV0dXJuIHNjaE5hbWU7CiAg\nICB9CgogICAgcHJvdGVjdGVkIFN0cmluZyBub3JtYWxpemVDYXRhbG9nTmFt\nZShTdHJpbmcgY2F0TmFtZSkgewogICAgICAgIHJldHVybiBjYXROYW1lOwog\nICAgfQp9Cg==\n","encoding":"base64"}

