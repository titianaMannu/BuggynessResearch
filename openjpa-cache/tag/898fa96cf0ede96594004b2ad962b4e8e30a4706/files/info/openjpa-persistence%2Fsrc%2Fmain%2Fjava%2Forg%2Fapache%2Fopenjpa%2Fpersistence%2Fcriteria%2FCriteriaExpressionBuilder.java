{"sha":"b4e250460e98e13bb6fc61f0d70caf69d3fa4b66","node_id":"MDQ6QmxvYjIwNjM2NDpiNGUyNTA0NjBlOThlMTNiYjZmYzYxZjBkNzBjYWY2OWQzZmE0YjY2","size":16602,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/b4e250460e98e13bb6fc61f0d70caf69d3fa4b66","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwoKcGFj\na2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuY3JpdGVyaWE7\nCgppbXBvcnQgamF2YS51dGlsLkFycmF5TGlzdDsKaW1wb3J0IGphdmEudXRp\nbC5IYXNoTWFwOwppbXBvcnQgamF2YS51dGlsLkhhc2hTZXQ7CmltcG9ydCBq\nYXZhLnV0aWwuTGlzdDsKaW1wb3J0IGphdmEudXRpbC5NYXA7CmltcG9ydCBq\nYXZhLnV0aWwuU2V0OwoKaW1wb3J0IGphdmF4LnBlcnNpc3RlbmNlLlR1cGxl\nOwppbXBvcnQgamF2YXgucGVyc2lzdGVuY2UuVHVwbGVFbGVtZW50OwppbXBv\ncnQgamF2YXgucGVyc2lzdGVuY2UuY3JpdGVyaWEuQ29tcG91bmRTZWxlY3Rp\nb247CmltcG9ydCBqYXZheC5wZXJzaXN0ZW5jZS5jcml0ZXJpYS5FeHByZXNz\naW9uOwppbXBvcnQgamF2YXgucGVyc2lzdGVuY2UuY3JpdGVyaWEuRmV0Y2g7\nCmltcG9ydCBqYXZheC5wZXJzaXN0ZW5jZS5jcml0ZXJpYS5Kb2luOwppbXBv\ncnQgamF2YXgucGVyc2lzdGVuY2UuY3JpdGVyaWEuSm9pblR5cGU7CmltcG9y\ndCBqYXZheC5wZXJzaXN0ZW5jZS5jcml0ZXJpYS5PcmRlcjsKaW1wb3J0IGph\ndmF4LnBlcnNpc3RlbmNlLmNyaXRlcmlhLlJvb3Q7CmltcG9ydCBqYXZheC5w\nZXJzaXN0ZW5jZS5jcml0ZXJpYS5TZWxlY3Rpb247CmltcG9ydCBqYXZheC5w\nZXJzaXN0ZW5jZS5tZXRhbW9kZWwuVHlwZS5QZXJzaXN0ZW5jZVR5cGU7Cgpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5GaWxsU3RyYXRlZ3k7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLlF1ZXJ5T3BlcmF0\naW9uczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuUmVzdWx0\nU2hhcGU7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLmV4cHMu\nQWJzdHJhY3RFeHByZXNzaW9uQnVpbGRlcjsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS5rZXJuZWwuZXhwcy5FeHByZXNzaW9uRmFjdG9yeTsKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuZXhwcy5RdWVyeUV4cHJlc3Np\nb25zOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5leHBzLlZh\nbHVlOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuQ2xhc3NNZXRh\nRGF0YTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5U\ndXBsZUZhY3Rvcnk7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lz\ndGVuY2UuVHVwbGVJbXBsOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnBl\ncnNpc3RlbmNlLm1ldGEuQWJzdHJhY3RNYW5hZ2VkVHlwZTsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5tZXRhLk1lbWJlcnM7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UubWV0YS5NZXRh\nbW9kZWxJbXBsOwoKLyoqCiAqIENvbnZlcnRzIGV4cHJlc3Npb25zIG9mIGEg\nQ3JpdGVyaWFRdWVyeSB0byBrZXJuZWwgRXhwcmVzc2lvbi4KICogCiAqIAog\nKiBAYXV0aG9yIFBpbmFraSBQb2RkYXIKICogQGF1dGhvciBGYXkgV2FuZwog\nKiAKICogQHNpbmNlIDIuMC4wCiAqLwpjbGFzcyBDcml0ZXJpYUV4cHJlc3Np\nb25CdWlsZGVyIHsKICAgIAogICAgcHVibGljIFF1ZXJ5RXhwcmVzc2lvbnMg\nZ2V0UXVlcnlFeHByZXNzaW9ucyhFeHByZXNzaW9uRmFjdG9yeSBmYWN0b3J5\nLCBDcml0ZXJpYVF1ZXJ5SW1wbDw/PiBxKSB7CiAgICAgICAgUXVlcnlFeHBy\nZXNzaW9ucyBleHBzID0gbmV3IFF1ZXJ5RXhwcmVzc2lvbnMoKTsKICAgICAg\nICBleHBzLnNldENvbnRleHRzKHEuZ2V0Q29udGV4dHMoKSk7CgogICAgICAg\nIGV2YWxBY2Nlc3NQYXRocyhleHBzLCBmYWN0b3J5LCBxKTsKICAgICAgICBl\neHBzLmFsaWFzID0gbnVsbDsgICAgICAvLyBTdHJpbmcgICAKICAgICAgICBl\ndmFsRGlzdGluY3QoZXhwcywgZmFjdG9yeSwgcSk7CiAgICAgICAgZXZhbEZl\ndGNoSm9pbihleHBzLCBmYWN0b3J5LCBxKTsKICAgICAgICBldmFsQ3Jvc3NK\nb2luUm9vdHMoZXhwcywgZmFjdG9yeSwgcSk7CiAgICAgICAgZXZhbEZpbHRl\ncihleHBzLCBmYWN0b3J5LCBxKTsKICAgICAgICBldmFsR3JvdXBpbmcoZXhw\ncywgZmFjdG9yeSwgcSk7CiAgICAgICAgZXZhbE9yZGVyaW5nQW5kUHJvamVj\ndGlvbihleHBzLCBmYWN0b3J5LCBxKTsKICAgICAgICBleHBzLm9wZXJhdGlv\nbiA9IFF1ZXJ5T3BlcmF0aW9ucy5PUF9TRUxFQ1Q7CiAgICAgICAgZXhwcy5y\nYW5nZSA9IFF1ZXJ5RXhwcmVzc2lvbnMuRU1QVFlfVkFMVUVTOwogICAgICAg\nIGV4cHMucmVzdWx0Q2xhc3MgPSBxLmdldFJlc3VsdFR5cGUoKTsKICAgICAg\nICBleHBzLnNoYXBlID0gZXZhbFJlc3VsdFNoYXBlKHEpOwogICAgICAgIGV4\ncHMucGFyYW1ldGVyVHlwZXMgPSBxLmdldFBhcmFtZXRlclR5cGVzKCk7CiAg\nICAgICAgZXhwcy5pc0FnZ3JlZ2F0ZSgpOwogICAgICAgIHJldHVybiBleHBz\nOwogICAgfQoKICAgIHByb3RlY3RlZCB2b2lkIGV2YWxBY2Nlc3NQYXRocyhR\ndWVyeUV4cHJlc3Npb25zIGV4cHMsIEV4cHJlc3Npb25GYWN0b3J5IGZhY3Rv\ncnksIENyaXRlcmlhUXVlcnlJbXBsPD8+IHEpIHsKICAgICAgICBTZXQ8Q2xh\nc3NNZXRhRGF0YT4gbWV0YXMgPSBuZXcgSGFzaFNldDxDbGFzc01ldGFEYXRh\nPigpOwogICAgICAgIE1ldGFtb2RlbEltcGwgbWV0YW1vZGVsID0gcS5nZXRN\nZXRhbW9kZWwoKTsgICAgCiAgICAgICAgZm9yIChSb290PD8+IHJvb3QgOiBx\nLmdldFJvb3RzKCkpIHsKICAgICAgICAgICAgbWV0YXMuYWRkKCgoQWJzdHJh\nY3RNYW5hZ2VkVHlwZTw/Pilyb290LmdldE1vZGVsKCkpLm1ldGEpOwogICAg\nICAgICAgICBmb3IgKEpvaW48Pyw/PiBqb2luIDogcm9vdC5nZXRKb2lucygp\nKSB7CiAgICAgICAgICAgICAgICBDbGFzczw/PiBjbHMgPSBqb2luLmdldEF0\ndHJpYnV0ZSgpLmdldEphdmFUeXBlKCk7CiAgICAgICAgICAgICAgICBpZiAo\nam9pbi5nZXRBdHRyaWJ1dGUoKS5pc0Fzc29jaWF0aW9uKCkpIHsKICAgICAg\nICAgICAgICAgICAgICBDbGFzc01ldGFEYXRhIG1ldGEgPSBtZXRhbW9kZWwu\nZ2V0UmVwb3NpdG9yeSgpLmdldE1ldGFEYXRhKGNscywgbnVsbCwgdHJ1ZSk7\nCiAgICAgICAgICAgICAgICAgICAgUGVyc2lzdGVuY2VUeXBlIHR5cGUgPSBN\nZXRhbW9kZWxJbXBsLmdldFBlcnNpc3RlbmNlVHlwZShtZXRhKTsKICAgICAg\nICAgICAgICAgICAgICBpZiAodHlwZSA9PSBQZXJzaXN0ZW5jZVR5cGUuRU5U\nSVRZIHx8IHR5cGUgPT0gUGVyc2lzdGVuY2VUeXBlLkVNQkVEREFCTEUpIAog\nICAgICAgICAgICAgICAgICAgICAgICBtZXRhcy5hZGQobWV0YSk7CiAgICAg\nICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZm9yIChG\nZXRjaDw/LD8+IGZldGNoIDogcm9vdC5nZXRGZXRjaGVzKCkpIHsKICAgICAg\nICAgICAgICAgIG1ldGFzLmFkZChtZXRhbW9kZWwuZ2V0UmVwb3NpdG9yeSgp\nLmdldENhY2hlZE1ldGFEYXRhKGZldGNoLmdldEF0dHJpYnV0ZSgpLmdldEph\ndmFUeXBlKCkpKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBl\neHBzLmFjY2Vzc1BhdGggPSBtZXRhcy50b0FycmF5KG5ldyBDbGFzc01ldGFE\nYXRhW21ldGFzLnNpemUoKV0pOwogICAgfQoKICAgIHByb3RlY3RlZCB2b2lk\nIGV2YWxPcmRlcmluZ0FuZFByb2plY3Rpb24oUXVlcnlFeHByZXNzaW9ucyBl\neHBzLCBFeHByZXNzaW9uRmFjdG9yeSBmYWN0b3J5LCBDcml0ZXJpYVF1ZXJ5\nSW1wbDw/PiBxKSB7CiAgICAgICAgTWFwPEV4cHJlc3Npb25JbXBsPD8+LCBW\nYWx1ZT4gZXhwMlZhbHMgPSBldmFsT3JkZXJpbmcoZXhwcywgZmFjdG9yeSwg\ncSk7CiAgICAgICAgZXZhbFByb2plY3Rpb25zKGV4cHMsIGZhY3RvcnksIHEs\nIGV4cDJWYWxzKTsKICAgIH0KICAgIAogICAgLyoqCiAgICAgKiBFdmFsdWF0\nZXMgdGhlIG9yZGVyaW5nIGV4cHJlc3Npb25zIGJ5IGNvbnZlcnRpbmcgdGhl\nbSB0byBrZXJuZWwgdmFsdWVzLgogICAgICogU2V0cyB0aGUgb3JkZXJpbmcg\nZmllbGRzIG9mIGtlcm5lbCBRdWVyeUV4cHJlc3Npb25zLgogICAgICogICAK\nICAgICAqIEBwYXJhbSBleHBzIGtlcm5lbCBRdWVyeUV4cHJlc3Npb25zCiAg\nICAgKiBAcGFyYW0gZmFjdG9yeSBmb3Iga2VybmVsIGV4cHJlc3Npb25zCiAg\nICAgKiBAcGFyYW0gcSBhIGNyaXRlcmlhIHF1ZXJ5CiAgICAgKiAKICAgICAq\nIEByZXR1cm4gbWFwIG9mIGtlcm5lbCB2YWx1ZXMgaW5kZXhlZCBieSBjcml0\nZXJpYSBxdWVyeSBleHByZXNzaW9ucyB0aGF0IGNyZWF0ZWQgaXQuCiAgICAg\nKiBUaGVzZSBrZXJuZWwgdmFsdWVzIGFyZSByZXF1aXJlZCB0byBiZSBoZWxk\nIGluIGEgbWFwIHRvIGF2b2lkIHJlY29tcHV0aW5nIGZvciB0aGUKICAgICAq\nIHNhbWUgQ3JpdGVyaWFRdWVyeSBFeHByZXNzaW9ucyBhcHBlYXJpbmcgaW4g\nb3JkZXJpbmcgdGVybXMgYXMgd2VsbCBhcyBwcm9qZWN0aW9uCiAgICAgKiB0\nZXJtLiAKICAgICAqIAogICAgICovCiAgICBwcm90ZWN0ZWQgTWFwPEV4cHJl\nc3Npb25JbXBsPD8+LCBWYWx1ZT4gZXZhbE9yZGVyaW5nKFF1ZXJ5RXhwcmVz\nc2lvbnMgZXhwcywgRXhwcmVzc2lvbkZhY3RvcnkgZmFjdG9yeSwgCiAgICAg\nICAgQ3JpdGVyaWFRdWVyeUltcGw8Pz4gcSkgewogICAgICAgIExpc3Q8T3Jk\nZXI+IG9yZGVycyA9IHEuZ2V0T3JkZXJMaXN0KCk7CiAgICAgICAgTWV0YW1v\nZGVsSW1wbCBtb2RlbCA9IHEuZ2V0TWV0YW1vZGVsKCk7IAogICAgICAgIGlu\ndCBvcmRlcmNvdW50ID0gKG9yZGVycyA9PSBudWxsKSA/IDAgOiBvcmRlcnMu\nc2l6ZSgpOwogICAgICAgIE1hcDxFeHByZXNzaW9uSW1wbDw/PiwgVmFsdWU+\nIGV4cDJWYWxzID0gbmV3IEhhc2hNYXA8RXhwcmVzc2lvbkltcGw8Pz4sIFZh\nbHVlPigpOwogICAgICAgIGV4cHMub3JkZXJpbmcgPSBuZXcgVmFsdWVbb3Jk\nZXJjb3VudF07CiAgICAgICAgZXhwcy5vcmRlcmluZ0NsYXVzZXMgPSBuZXcg\nU3RyaW5nW29yZGVyY291bnRdOwogICAgICAgIGV4cHMub3JkZXJpbmdBbGlh\nc2VzID0gbmV3IFN0cmluZ1tvcmRlcmNvdW50XTsKICAgICAgICBleHBzLmFz\nY2VuZGluZyA9IG5ldyBib29sZWFuW29yZGVyY291bnRdOwogICAgICAgIGZv\nciAoaW50IGkgPSAwOyBpIDwgb3JkZXJjb3VudDsgaSsrKSB7CiAgICAgICAg\nICAgIE9yZGVySW1wbCBvcmRlciA9IChPcmRlckltcGwpb3JkZXJzLmdldChp\nKTsKICAgICAgICAgICAgRXhwcmVzc2lvbkltcGw8Pz4gZXhwciA9IG9yZGVy\nLmdldEV4cHJlc3Npb24oKTsKICAgICAgICAgICAgVmFsdWUgdmFsID0gRXhw\ncmVzc2lvbnMudG9WYWx1ZShleHByLCBmYWN0b3J5LCBxKTsKICAgICAgICAg\nICAgZXhwcy5vcmRlcmluZ1tpXSA9IHZhbDsKICAgICAgICAgICAgU3RyaW5n\nIGFsaWFzID0gZXhwci5nZXRBbGlhcygpOwogICAgICAgICAgICBleHBzLm9y\nZGVyaW5nQWxpYXNlc1tpXSA9IGFsaWFzOwogICAgICAgICAgICBleHBzLm9y\nZGVyaW5nQ2xhdXNlc1tpXSA9ICIiOwogICAgICAgICAgICB2YWwuc2V0QWxp\nYXMoYWxpYXMpOwogICAgICAgICAgICBleHBzLmFzY2VuZGluZ1tpXSA9IG9y\nZGVyLmlzQXNjZW5kaW5nKCk7CiAgICAgICAgICAgIGV4cDJWYWxzLnB1dChl\neHByLCB2YWwpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gZXhwMlZhbHM7\nCiAgICB9CgogICAgcHJvdGVjdGVkIHZvaWQgZXZhbEdyb3VwaW5nKFF1ZXJ5\nRXhwcmVzc2lvbnMgZXhwcywgRXhwcmVzc2lvbkZhY3RvcnkgZmFjdG9yeSwg\nQ3JpdGVyaWFRdWVyeUltcGw8Pz4gcSkgewogICAgICAgIC8vICAgIGV4cHMu\nZ3JvdXBpbmcgPSBudWxsOyAvLyBWYWx1ZVtdCiAgICAgICAgLy8gICAgZXhw\ncy5ncm91cGluZ0NsYXVzZXMgPSBudWxsOyAvLyBTdHJpbmdbXQogICAgICAg\nIExpc3Q8RXhwcmVzc2lvbjw/Pj4gZ3JvdXBzID0gcS5nZXRHcm91cExpc3Qo\nKTsKICAgICAgICBNZXRhbW9kZWxJbXBsIG1vZGVsID0gcS5nZXRNZXRhbW9k\nZWwoKTsKICAgICAgICBQcmVkaWNhdGVJbXBsIGhhdmluZyA9IHEuZ2V0R3Jv\ndXBSZXN0cmljdGlvbigpOwogICAgICAgIGlmIChncm91cHMgPT0gbnVsbCkg\nCiAgICAgICAgICAgIHJldHVybjsKICAgICAgICBpbnQgZ3JvdXBCeUNvdW50\nID0gZ3JvdXBzLnNpemUoKTsKICAgICAgICBleHBzLmdyb3VwaW5nID0gbmV3\nIFZhbHVlW2dyb3VwQnlDb3VudF07CiAgICAgICAgZm9yIChpbnQgaSA9IDA7\nIGkgPCBncm91cEJ5Q291bnQ7IGkrKykgewogICAgICAgICAgICBFeHByZXNz\naW9uPD8+IGdyb3VwQnkgPSBncm91cHMuZ2V0KGkpOyAgICAKICAgICAgICAg\nICAgZXhwcy5ncm91cGluZ1tpXSA9IEV4cHJlc3Npb25zLnRvVmFsdWUoKEV4\ncHJlc3Npb25JbXBsPD8+KWdyb3VwQnksIGZhY3RvcnksIHEpOzsKICAgICAg\nICB9CgogICAgICAgIGV4cHMuaGF2aW5nID0gaGF2aW5nID09IG51bGwgPyBu\ndWxsIDogaGF2aW5nLnRvS2VybmVsRXhwcmVzc2lvbihmYWN0b3J5LCBxKTsK\nICAgIH0KCiAgICBwcm90ZWN0ZWQgdm9pZCBldmFsRGlzdGluY3QoUXVlcnlF\neHByZXNzaW9ucyBleHBzLCBFeHByZXNzaW9uRmFjdG9yeSBmYWN0b3J5LCBD\ncml0ZXJpYVF1ZXJ5SW1wbDw/PiBxKSB7CiAgICAgICAgZXhwcy5kaXN0aW5j\ndCA9IHEuaXNEaXN0aW5jdCgpID8gUXVlcnlFeHByZXNzaW9ucy5ESVNUSU5D\nVF9UUlVFIHwgUXVlcnlFeHByZXNzaW9ucy5ESVNUSU5DVF9BVVRPCiAgICAg\nICAgICAgIDogUXVlcnlFeHByZXNzaW9ucy5ESVNUSU5DVF9GQUxTRTsKICAg\nICB9CgogICAgcHJvdGVjdGVkIHZvaWQgZXZhbENyb3NzSm9pblJvb3RzKFF1\nZXJ5RXhwcmVzc2lvbnMgZXhwcywgRXhwcmVzc2lvbkZhY3RvcnkgZmFjdG9y\neSwgQ3JpdGVyaWFRdWVyeUltcGw8Pz4gcSkgewogICAgICAgIFNldDxSb290\nPD8+PiByb290cyA9IHEuZ2V0Um9vdHMoKTsKICAgICAgICBTdWJxdWVyeUlt\ncGw8Pz4gc3ViUXVlcnkgPSBxLmdldERlbGVnYXRvcigpOwogICAgICAgIGlm\nIChzdWJRdWVyeSA9PSBudWxsIHx8IHN1YlF1ZXJ5LmdldENvcnJlbGF0ZWRK\nb2lucygpLmlzRW1wdHkoKSkgewogICAgICAgICAgICBxLmFzc2VydFJvb3Qo\nKTsKICAgICAgICAgICAgaWYgKHJvb3RzLnNpemUoKSA+IDEpIHsgLy8gY3Jv\nc3Mgam9pbgogICAgICAgICAgICAgICAgZm9yIChSb290PD8+IHJvb3QgOiBy\nb290cykgewogICAgICAgICAgICAgICAgICAgIFN0cmluZyBhbGlhcyA9IHEu\nZ2V0QWxpYXMocm9vdCk7CiAgICAgICAgICAgICAgICAgICAgVmFsdWUgdmFy\nID0gZmFjdG9yeS5uZXdCb3VuZFZhcmlhYmxlKGFsaWFzLCBBYnN0cmFjdEV4\ncHJlc3Npb25CdWlsZGVyLlRZUEVfT0JKRUNUKTsKICAgICAgICAgICAgICAg\nICAgICB2YXIuc2V0TWV0YURhdGEoKChBYnN0cmFjdE1hbmFnZWRUeXBlPD8+\nKXJvb3QuZ2V0TW9kZWwoKSkubWV0YSk7CiAgICAgICAgICAgICAgICAgICAg\ncS5yZWdpc3RlclJvb3Qocm9vdCwgdmFyKTsKICAgICAgICAgICAgICAgIH0K\nICAgICAgICAgICAgfSAgICAgICAgIAogICAgICAgIH0KICAgIH0KICAgIAog\nICAgcHJvdGVjdGVkIHZvaWQgZXZhbEZpbHRlcihRdWVyeUV4cHJlc3Npb25z\nIGV4cHMsIEV4cHJlc3Npb25GYWN0b3J5IGZhY3RvcnksIENyaXRlcmlhUXVl\ncnlJbXBsPD8+IHEpIHsKICAgICAgICBTZXQ8Um9vdDw/Pj4gcm9vdHMgPSBx\nLmdldFJvb3RzKCk7CiAgICAgICAgTWV0YW1vZGVsSW1wbCBtb2RlbCA9IHEu\nZ2V0TWV0YW1vZGVsKCk7CiAgICAgICAgUHJlZGljYXRlSW1wbCB3aGVyZSA9\nIHEuZ2V0UmVzdHJpY3Rpb24oKTsKICAgICAgICBTdWJxdWVyeUltcGw8Pz4g\nc3ViUXVlcnkgPSBxLmdldERlbGVnYXRvcigpOwogICAgICAgIG9yZy5hcGFj\naGUub3BlbmpwYS5rZXJuZWwuZXhwcy5FeHByZXNzaW9uIGZpbHRlciA9IG51\nbGw7CiAgICAgICAgaWYgKHN1YlF1ZXJ5ID09IG51bGwgfHwgc3ViUXVlcnku\nZ2V0Q29ycmVsYXRlZEpvaW5zKCkuaXNFbXB0eSgpKSAKICAgICAgICAgICAg\ncS5hc3NlcnRSb290KCk7CiAgICAgICAgICAgIAogICAgICAgIGZvciAoUm9v\ndDw/PiByb290IDogcm9vdHMpIHsKICAgICAgICAgICAgZm9yIChKb2luPD8s\nID8+IGpvaW4gOiByb290LmdldEpvaW5zKCkpIHsKICAgICAgICAgICAgICAg\nIGZpbHRlciA9IEV4cHJlc3Npb25zLmFuZChmYWN0b3J5LCAKICAgICAgICAg\nICAgICAgICAgICAoKEV4cHJlc3Npb25JbXBsPD8+KWpvaW4pLnRvS2VybmVs\nRXhwcmVzc2lvbihmYWN0b3J5LCBxKSwgZmlsdGVyKTsKICAgICAgICAgICAg\nfQogICAgICAgICAgICAoKFJvb3RJbXBsPD8+KXJvb3QpLmFkZFRvQ29udGV4\ndChmYWN0b3J5LCBtb2RlbCwgcSk7CiAgICAgICAgfQogICAgICAgIGlmIChz\ndWJRdWVyeSAhPSBudWxsKSB7CiAgICAgICAgICAgIFNldDxKb2luPD8sPz4+\nIGNvcnJKb2lucyA9IHN1YlF1ZXJ5LmdldENvcnJlbGF0ZWRKb2lucygpOwog\nICAgICAgICAgICBmb3IgKEpvaW48Pyw/PiBjb3JySm9pbiA6IGNvcnJKb2lu\ncykgewogICAgICAgICAgICAgICAgZmlsdGVyID0gRXhwcmVzc2lvbnMuYW5k\nKGZhY3RvcnksICgoRXhwcmVzc2lvbkltcGw8Pz4pY29yckpvaW4pCiAgICAg\nICAgICAgICAgICAgICAgLnRvS2VybmVsRXhwcmVzc2lvbihmYWN0b3J5LCBx\nKSwgZmlsdGVyKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICAK\nICAgICAgICBpZiAod2hlcmUgIT0gbnVsbCkgewogICAgICAgICAgICBmaWx0\nZXIgPSBFeHByZXNzaW9ucy5hbmQoZmFjdG9yeSwgd2hlcmUudG9LZXJuZWxF\neHByZXNzaW9uKGZhY3RvcnksIHEpLCBmaWx0ZXIpOwogICAgICAgIH0KICAg\nICAgICBpZiAoZmlsdGVyID09IG51bGwpIHsKICAgICAgICAgICAgZmlsdGVy\nID0gZmFjdG9yeS5lbXB0eUV4cHJlc3Npb24oKTsKICAgICAgICB9CiAgICAg\nICAgZXhwcy5maWx0ZXIgPSBmaWx0ZXI7CiAgICB9CgogICAgcHJvdGVjdGVk\nIHZvaWQgZXZhbFByb2plY3Rpb25zKFF1ZXJ5RXhwcmVzc2lvbnMgZXhwcywg\nRXhwcmVzc2lvbkZhY3RvcnkgZmFjdG9yeSwgQ3JpdGVyaWFRdWVyeUltcGw8\nPz4gcSwKICAgICAgICBNYXA8RXhwcmVzc2lvbkltcGw8Pz4sIFZhbHVlPiBl\neHAyVmFscykgewogICAgICAgIExpc3Q8U2VsZWN0aW9uPD8+PiBzZWxlY3Rp\nb25zID0gcS5nZXRTZWxlY3Rpb25MaXN0KCk7CiAgICAgICAgTWV0YW1vZGVs\nSW1wbCBtb2RlbCA9IHEuZ2V0TWV0YW1vZGVsKCk7CiAgICAgICAgaWYgKHEu\naXNEZWZhdWx0UHJvamVjdGlvbigpKSB7CiAgICAgICAgICAgIGV4cHMucHJv\namVjdGlvbnMgPSBuZXcgVmFsdWVbMF07CiAgICAgICAgICAgIHJldHVybiA7\nCiAgICAgICAgfQogICAgICAgIGV4cHMucHJvamVjdGlvbnMgPSBuZXcgVmFs\ndWVbc2VsZWN0aW9ucy5zaXplKCldOwogICAgICAgIExpc3Q8VmFsdWU+IHBy\nb2plY3Rpb25zID0gbmV3IEFycmF5TGlzdDxWYWx1ZT4oKTsKICAgICAgICBM\naXN0PFN0cmluZz4gYWxpYXNlcyA9IG5ldyBBcnJheUxpc3Q8U3RyaW5nPigp\nOwogICAgICAgIExpc3Q8U3RyaW5nPiBjbGF1c2VzID0gbmV3IEFycmF5TGlz\ndDxTdHJpbmc+KCk7CiAgICAgICAgZ2V0UHJvamVjdGlvbnMoZXhwcywgc2Vs\nZWN0aW9ucywgcHJvamVjdGlvbnMsIGFsaWFzZXMsIGNsYXVzZXMsIGZhY3Rv\ncnksIHEsIG1vZGVsLCBleHAyVmFscyk7CiAgICAgICAgZXhwcy5wcm9qZWN0\naW9ucyA9IHByb2plY3Rpb25zLnRvQXJyYXkobmV3IFZhbHVlW3Byb2plY3Rp\nb25zLnNpemUoKV0pOwogICAgICAgIGV4cHMucHJvamVjdGlvbkFsaWFzZXMg\nPSBhbGlhc2VzLnRvQXJyYXkobmV3IFN0cmluZ1thbGlhc2VzLnNpemUoKV0p\nOwogICAgICAgIGV4cHMucHJvamVjdGlvbkNsYXVzZXMgPSBjbGF1c2VzLnRv\nQXJyYXkobmV3IFN0cmluZ1tjbGF1c2VzLnNpemUoKV0pOwogICAgfQoKICAg\nIC8qKgogICAgICogU2NhbnMgdGhlIHByb2plY3Rpb24gdGVybXMgdG8gcG9w\ndWxhdGUgdGhlIGtlcm5lbCBRdWVyeUV4cHJlc3Npb25zIHByb2plY3Rpb24g\nY2xhdXNlcwogICAgICogYW5kIGFsaWFzZXMuCiAgICAgKiAgIAogICAgICog\nQHBhcmFtIGV4cHMgCiAgICAgKiBAcGFyYW0gc2VsZWN0aW9ucwogICAgICog\nQHBhcmFtIHByb2plY3Rpb25zIGxpc3Qgb2Yga2VybmVsIHZhbHVlcyBmb3Ig\ncHJvamVjdGlvbnMgCiAgICAgKiBAcGFyYW0gYWxpYXNlcyBsaXN0IG9mIGtl\ncm5lbCBwcm9qZWN0aW9uIGFsaWFzZXMgCiAgICAgKiBAcGFyYW0gY2xhdXNl\ncyBsaXN0IG9mIGtlcm5lbCBwcm9qZWN0aW9uIGNsYXVzZXMKICAgICAqIEBw\nYXJhbSBmYWN0b3J5IGZvciBrZXJuZWwgZXhwcmVzc2lvbnMKICAgICAqIEBw\nYXJhbSBxIGEgQ3JpdGVyaWEgUXVlcnkKICAgICAqIEBwYXJhbSBtb2RlbCBv\nZiBkb21haW4gZW50aXRpZXMKICAgICAqIEBwYXJhbSBleHAyVmFscyB0aGUg\nZXZhbHVhdGVkIGtlcm5lbCB2YWx1ZXMgaW5kZXhlZCBieSB0aGUgQ3JpdGVy\naWEgRXhwcmVzc2lvbnMKICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIGdldFBy\nb2plY3Rpb25zKFF1ZXJ5RXhwcmVzc2lvbnMgZXhwcywgTGlzdDxTZWxlY3Rp\nb248Pz4+IHNlbGVjdGlvbnMsIAogICAgICAgIExpc3Q8VmFsdWU+IHByb2pl\nY3Rpb25zLCBMaXN0PFN0cmluZz4gYWxpYXNlcywgTGlzdDxTdHJpbmc+IGNs\nYXVzZXMsIAogICAgICAgIEV4cHJlc3Npb25GYWN0b3J5IGZhY3RvcnksIENy\naXRlcmlhUXVlcnlJbXBsPD8+IHEsIE1ldGFtb2RlbEltcGwgbW9kZWwsIAog\nICAgICAgIE1hcDxFeHByZXNzaW9uSW1wbDw/PiwgVmFsdWU+IGV4cDJWYWxz\nKSB7CgogICAgICAgIGlmIChzZWxlY3Rpb25zLnNpemUoKSA9PSAwICYmIHEu\nZ2V0RGVsZWdhdG9yKCkgIT0gbnVsbCkgeyAvLyB0aGlzIGlzIHN1YnF1ZXJ5\nCiAgICAgICAgICAgIFJvb3Q8Pz4gciA9IHEuZ2V0Um9vdCgpOwogICAgICAg\nICAgICBzZWxlY3Rpb25zID0gbmV3IEFycmF5TGlzdDxTZWxlY3Rpb248Pz4+\nKDEpOwogICAgICAgICAgICBzZWxlY3Rpb25zLmFkZChyKTsKICAgICAgICB9\nCiAgICAgICAgZm9yIChTZWxlY3Rpb248Pz4gcyA6IHNlbGVjdGlvbnMpIHsK\nICAgICAgICAgICAgaWYgKHMuaXNDb21wb3VuZFNlbGVjdGlvbigpKSB7CiAg\nICAgICAgICAgICAgICBnZXRQcm9qZWN0aW9ucyhleHBzLCBzLmdldENvbXBv\ndW5kU2VsZWN0aW9uSXRlbXMoKSwgcHJvamVjdGlvbnMsIGFsaWFzZXMsIAog\nICAgICAgICAgICAgICAgICAgIGNsYXVzZXMsIGZhY3RvcnksIHEsIG1vZGVs\nLCBleHAyVmFscyk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAg\nICAgICBWYWx1ZSB2YWwgPSAoZXhwMlZhbHMgIT0gbnVsbCAmJiBleHAyVmFs\ncy5jb250YWluc0tleShzKSAKICAgICAgICAgICAgICAgICAgICAgICAgPyBl\neHAyVmFscy5nZXQocykgOiAoKEV4cHJlc3Npb25JbXBsPD8+KXMpLnRvVmFs\ndWUoZmFjdG9yeSwgcSkpOwogICAgICAgICAgICAgICAgU3RyaW5nIGFsaWFz\nID0gcy5nZXRBbGlhcygpOwogICAgICAgICAgICAgICAgdmFsLnNldEFsaWFz\nKGFsaWFzKTsKICAgICAgICAgICAgICAgIHByb2plY3Rpb25zLmFkZCh2YWwp\nOwogICAgICAgICAgICAgICAgYWxpYXNlcy5hZGQoYWxpYXMpOwogICAgICAg\nICAgICAgICAgY2xhdXNlcy5hZGQoYWxpYXMpOwogICAgICAgICAgICB9ICAg\nICAgICAgCiAgICAgICAgfQogICAgfQoKICAgIHByb3RlY3RlZCB2b2lkIGV2\nYWxGZXRjaEpvaW4oUXVlcnlFeHByZXNzaW9ucyBleHBzLCBFeHByZXNzaW9u\nRmFjdG9yeSBmYWN0b3J5LCBDcml0ZXJpYVF1ZXJ5SW1wbDw/PiBxKSB7CiAg\nICAgICAgTGlzdDxTdHJpbmc+IGlQYXRocyA9IG5ldyBBcnJheUxpc3Q8U3Ry\naW5nPigpOwogICAgICAgIExpc3Q8U3RyaW5nPiBvUGF0aHMgPSBuZXcgQXJy\nYXlMaXN0PFN0cmluZz4oKTsKICAgICAgICBTZXQ8Um9vdDw/Pj4gcm9vdHMg\nPSBxLmdldFJvb3RzKCk7CiAgICAgICAgZm9yIChSb290IHJvb3QgOiByb290\ncykgewogICAgICAgICAgICBTZXQ8RmV0Y2g+IGZldGNoZXMgPSByb290Lmdl\ndEZldGNoZXMoKTsKICAgICAgICAgICAgaWYgKGZldGNoZXMgPT0gbnVsbCkK\nICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICBmb3IgKEZl\ndGNoPD8sPz4gZmV0Y2ggOiBmZXRjaGVzKSB7CiAgICAgICAgICAgICAgICBT\ndHJpbmcgZlBhdGggPSAoKE1lbWJlcnMuTWVtYmVyPD8sID8+KWZldGNoLmdl\ndEF0dHJpYnV0ZSgpKS5mbWQuZ2V0RnVsbE5hbWUoZmFsc2UpOwogICAgICAg\nICAgICAgICAgb1BhdGhzLmFkZChmUGF0aCk7CiAgICAgICAgICAgICAgICBp\nZiAoZmV0Y2guZ2V0Sm9pblR5cGUoKSA9PSBKb2luVHlwZS5JTk5FUikgewog\nICAgICAgICAgICAgICAgICAgaVBhdGhzLmFkZChmUGF0aCk7CiAgICAgICAg\nICAgICAgICB9IAogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGlm\nICghaVBhdGhzLmlzRW1wdHkoKSkgewogICAgICAgICAgICBleHBzLmZldGNo\nSW5uZXJQYXRocyA9IGlQYXRocy50b0FycmF5KG5ldyBTdHJpbmdbaVBhdGhz\nLnNpemUoKV0pOwogICAgICAgIH0KICAgICAgICBpZiAoIW9QYXRocy5pc0Vt\ncHR5KCkpIHsKICAgICAgICAgICAgZXhwcy5mZXRjaFBhdGhzID0gb1BhdGhz\nLnRvQXJyYXkobmV3IFN0cmluZ1tvUGF0aHMuc2l6ZSgpXSk7CiAgICAgICAg\nfQogICAgfQoKICAgIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09\nPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09\nPT09PT09PT09CiAgICAvLyBSZXN1bHQgU2hhcGUgcHJvY2Vzc2luZwogICAg\nLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09\nPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KICAg\nIAogICAgLyoqCiAgICAgKiBHZXRzIHRoZSBzaGFwZSBvZiBhIHNlbGVjdGlv\nbiBpdGVtLiBDcmVhdGVzIHRoZSBzaGFwZSBpZiBuZWNlc3NhcnkuCiAgICAg\nKiAKICAgICAqIEBwYXJhbSBxIHRoZSBvcmlnaW5hbCBxdWVyeQogICAgICog\nQHBhcmFtIHBhcmVudCB0aGUgcGFyZW50IHNoYXBlIHRoYXQgbmVzdHMgdGhp\ncyBnaXZlbiBzZWxlY3Rpb24KICAgICAqIEBwYXJhbSBzIHRoZSBzZWxlY3Rp\nb24gdGVybSBmb3Igd2hpY2ggYSByZXN1bHQgc2hhcGUgdG8gYmUgY29tcHV0\nZWQKICAgICAqLwogICAgUmVzdWx0U2hhcGU8Pz4gZ2V0U2hhcGUoQ3JpdGVy\naWFRdWVyeUltcGw8Pz4gcSwgUmVzdWx0U2hhcGU8Pz4gcGFyZW50LCBTZWxl\nY3Rpb248Pz4gcykgewogICAgICAgIFJlc3VsdFNoYXBlPD8+IHJlc3VsdCA9\nIG51bGw7CiAgICAgICAgQ2xhc3M8Pz4gdHlwZSA9IHMuZ2V0SmF2YVR5cGUo\nKTsKICAgICAgICBpZiAodHlwZSA9PSBudWxsKQogICAgICAgICAgICB0eXBl\nID0gT2JqZWN0LmNsYXNzOwogICAgICAgIGlmIChzLmlzQ29tcG91bmRTZWxl\nY3Rpb24oKSkgewogICAgICAgICAgICBDb21wb3VuZFNlbGVjdGlvbjw/PiBj\ncyA9IChDb21wb3VuZFNlbGVjdGlvbjw/PilzOwogICAgICAgICAgICByZXN1\nbHQgPSBuZXcgUmVzdWx0U2hhcGUocy5nZXRKYXZhVHlwZSgpLCBDb21wb3Vu\nZFNlbGVjdGlvbnMuZ2V0RmlsbFN0cmF0ZWd5KGNzKSk7CiAgICAgICAgICAg\nIExpc3Q8U2VsZWN0aW9uPD8+PiB0ZXJtcyA9IGNzLmdldENvbXBvdW5kU2Vs\nZWN0aW9uSXRlbXMoKTsKICAgICAgICAgICAgZm9yIChTZWxlY3Rpb248Pz4g\ndGVybSA6IHRlcm1zKSB7CiAgICAgICAgICAgICAgICByZXN1bHQubmVzdChn\nZXRTaGFwZShxLCByZXN1bHQsIHRlcm0pKTsKICAgICAgICAgICAgfQogICAg\nICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGlmIChwYXJlbnQuZ2V0VHlwZSgp\nLmlzQXJyYXkoKSAmJiBxLmlzTXVsdGlzZWxlY3QoKSkgewogICAgICAgICAg\nICAgICAgQ2xhc3M8Pz4gY29tcG9uZW50VHlwZSA9IHBhcmVudC5nZXRUeXBl\nKCkuZ2V0Q29tcG9uZW50VHlwZSgpOwogICAgICAgICAgICAgICAgaWYgKGNv\nbXBvbmVudFR5cGUgPT0gVHVwbGUuY2xhc3MpIHsKICAgICAgICAgICAgICAg\nICAgICByZXN1bHQgPSBuZXcgUmVzdWx0U2hhcGUoY29tcG9uZW50VHlwZSwg\nCiAgICAgICAgICAgICAgICAgICAgICAgICBuZXcgRmlsbFN0cmF0ZWd5LkZh\nY3RvcnkobmV3IFR1cGxlRmFjdG9yeShzKSwgVHVwbGVJbXBsLlBVVCksIGZh\nbHNlKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAg\nICAgICAgcmVzdWx0ID0gbmV3IFJlc3VsdFNoYXBlKGNvbXBvbmVudFR5cGUs\nIG5ldyBGaWxsU3RyYXRlZ3kuQXNzaWduKCksIHRydWUpOwogICAgICAgICAg\nICAgICAgfQogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAg\ncmVzdWx0ID0gbmV3IFJlc3VsdFNoYXBlKHR5cGUsIG5ldyBGaWxsU3RyYXRl\nZ3kuQXNzaWduKCksIHRydWUpOwogICAgICAgICAgICB9CiAgICAgICAgfQog\nICAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9CiAgICAKICAgIC8qKgogICAg\nICogQnVpbGRzIHRoZSByZXN1bHQgc2hhcGUgYnkgY3JlYXRpbmcgc2hhcGUg\nZm9yIHRoZSBjb21wbGV0ZSByZXN1bHQgYW5kIGhvdyBpdCBuZXN0cyBlYWNo\nIHNlbGVjdGlvbiB0ZXJtcy4KICAgICAqIFRoZSBzaGFwZSB2YXJpZXMgYmFz\nZWQgb24gd2hldGhlciB0aGUgdGVybXMgd2VyZSBzZWxlY3RlZCBiYXNlZCBv\nbiBtdWx0aXNlbGVjdCgpIG9yIHNlbGVjdCgpLiAKICAgICAqLwogICAgcHJp\ndmF0ZSBSZXN1bHRTaGFwZTw/PiBldmFsUmVzdWx0U2hhcGUoQ3JpdGVyaWFR\ndWVyeUltcGw8Pz4gcSkgewogICAgICAgIExpc3Q8U2VsZWN0aW9uPD8+PiBz\nZWxlY3Rpb25zID0gcS5nZXRTZWxlY3Rpb25MaXN0KCk7CiAgICAgICAgQ2xh\nc3M8Pz4gcmVzdWx0Q2xhc3MgPSBxLmdldFJlc3VsdFR5cGUoKTsKICAgICAg\nICBSZXN1bHRTaGFwZTw/PiByZXN1bHQgPSBudWxsOwogICAgICAgIGlmIChx\nLmlzTXVsdGlzZWxlY3QoKSkgewogICAgICAgICAgIHJlc3VsdCA9IG5ldyBS\nZXN1bHRTaGFwZShyZXN1bHRDbGFzcywgQ29tcG91bmRTZWxlY3Rpb25zLmdl\ndEZpbGxTdHJhdGVneShxLmdldFNlbGVjdGlvbigpKSk7CiAgICAgICAgICAg\nZm9yIChTZWxlY3Rpb248Pz4gdGVybSA6IHNlbGVjdGlvbnMpIHsKICAgICAg\nICAgICAgICAgcmVzdWx0Lm5lc3QoZ2V0U2hhcGUocSwgcmVzdWx0LCB0ZXJt\nKSk7CiAgICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7IC8vIG5vdCBtdWx0\naXNlbGVjdAogICAgICAgICAgICBGaWxsU3RyYXRlZ3k8Pz4gc3RyYXRlZ3kg\nPSBuZXcgRmlsbFN0cmF0ZWd5LkFzc2lnbigpOwogICAgICAgICAgICBpZiAo\nVHVwbGUuY2xhc3MuaXNBc3NpZ25hYmxlRnJvbShyZXN1bHRDbGFzcykpIHsK\nICAgICAgICAgICAgICAgIFR1cGxlRmFjdG9yeSBmYWN0b3J5ID0gbmV3IFR1\ncGxlRmFjdG9yeShzZWxlY3Rpb25zLnRvQXJyYXkobmV3IFR1cGxlRWxlbWVu\ndFtzZWxlY3Rpb25zLnNpemUoKV0pKTsKICAgICAgICAgICAgICAgIHN0cmF0\nZWd5ID0gbmV3IEZpbGxTdHJhdGVneS5GYWN0b3J5PFR1cGxlPihmYWN0b3J5\nLCAgVHVwbGVJbXBsLlBVVCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAg\ncmVzdWx0ID0gbmV3IFJlc3VsdFNoYXBlKHJlc3VsdENsYXNzLCBzdHJhdGVn\neSk7CiAgICAgICAgICAgIGlmIChxLmdldFNlbGVjdGlvbkxpc3QoKSA9PSBu\ndWxsKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0OwogICAgICAg\nICAgICB9CiAgICAgICAgICAgIGlmIChxLmdldFNlbGVjdGlvbkxpc3QoKS5z\naXplKCkgPT0gMSkgewogICAgICAgICAgICAgICAgcmVzdWx0ID0gZ2V0U2hh\ncGUocSwgcmVzdWx0LCBxLmdldFNlbGVjdGlvbkxpc3QoKS5nZXQoMCkpOwog\nICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgZm9yIChTZWxl\nY3Rpb248Pz4gdGVybSA6IHEuZ2V0U2VsZWN0aW9uTGlzdCgpKSB7CiAgICAg\nICAgICAgICAgICAgICAgcmVzdWx0Lm5lc3QoZ2V0U2hhcGUocSwgcmVzdWx0\nLCB0ZXJtKSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAg\nICAgICB9CiAgICAKICAgICAgICByZXR1cm4gcmVzdWx0OwogICB9Cn0K\n","encoding":"base64"}

