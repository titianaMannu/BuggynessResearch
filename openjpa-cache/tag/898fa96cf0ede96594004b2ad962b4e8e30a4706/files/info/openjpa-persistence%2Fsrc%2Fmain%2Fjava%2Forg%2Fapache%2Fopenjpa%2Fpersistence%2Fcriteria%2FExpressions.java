{"sha":"fb36b89540ec8d622f9a8234c1c5baf5fcf7ba4f","node_id":"MDQ6QmxvYjIwNjM2NDpmYjM2Yjg5NTQwZWM4ZDYyMmY5YTgyMzRjMWM1YmFmNWZjZjdiYTRm","size":67594,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/fb36b89540ec8d622f9a8234c1c5baf5fcf7ba4f","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwoKcGFj\na2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuY3JpdGVyaWE7\nCgppbXBvcnQgamF2YS51dGlsLkFycmF5TGlzdDsKaW1wb3J0IGphdmEudXRp\nbC5Db2xsZWN0aW9uOwppbXBvcnQgamF2YS51dGlsLkhhc2hTZXQ7CmltcG9y\ndCBqYXZhLnV0aWwuTGlzdDsKaW1wb3J0IGphdmEudXRpbC5TZXQ7CmltcG9y\ndCBqYXZhLnV0aWwuY29uY3VycmVudC5Db3B5T25Xcml0ZUFycmF5TGlzdDsK\naW1wb3J0IGphdmEudXRpbC5jb25jdXJyZW50LkNvcHlPbldyaXRlQXJyYXlT\nZXQ7CgppbXBvcnQgamF2YXgucGVyc2lzdGVuY2UuY3JpdGVyaWEuRXhwcmVz\nc2lvbjsKaW1wb3J0IGphdmF4LnBlcnNpc3RlbmNlLmNyaXRlcmlhLlByZWRp\nY2F0ZTsKaW1wb3J0IGphdmF4LnBlcnNpc3RlbmNlLmNyaXRlcmlhLkNyaXRl\ncmlhQnVpbGRlcjsKaW1wb3J0IGphdmF4LnBlcnNpc3RlbmNlLmNyaXRlcmlh\nLlN1YnF1ZXJ5OwppbXBvcnQgamF2YXgucGVyc2lzdGVuY2UuY3JpdGVyaWEu\nQ3JpdGVyaWFCdWlsZGVyLlRyaW1zcGVjOwoKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS5rZXJuZWwuZXhwcy5FeHByZXNzaW9uRmFjdG9yeTsKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuZXhwcy5MaXRlcmFsOwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5leHBzLlZhbHVlOwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5qcHFsLkpQUUxFeHByZXNz\naW9uQnVpbGRlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRhLkNs\nYXNzTWV0YURhdGE7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lz\ndGVuY2UuY3JpdGVyaWEuQ3JpdGVyaWFFeHByZXNzaW9uVmlzaXRvci5UcmF2\nZXJzYWxTdHlsZTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0\nZW5jZS5tZXRhLlR5cGVzOwoKLyoqCiAqIEV4cHJlc3Npb25zIGFjY29yZGlu\nZyB0byBKUEEgMi4wLgogKiAKICogQSBmYWNhZGUgdG8gT3BlbkpQQSBrZXJu\nZWwgZXhwcmVzc2lvbnMgdG8gZW5mb3JjZSBzdHJvbmdlciB0eXBpbmcuCiAq\nIAogKiBAYXV0aG9yIFBpbmFraSBQb2RkYXIKICogQGF1dGhvciBGYXkgV2Fu\nZwogKiAKICogQHNpbmNlIDIuMC4wCiAqCiAqLwpjbGFzcyBFeHByZXNzaW9u\ncyB7CiAgICBzdGF0aWMgZmluYWwgU3RyaW5nIE9QRU5fQlJBQ0UgPSAiKCI7\nCiAgICBzdGF0aWMgZmluYWwgU3RyaW5nIENMT1NFX0JSQUNFID0gIikiOwog\nICAgc3RhdGljIGZpbmFsIFN0cmluZyBDT01NQSA9ICIsIjsKICAgIAogICAg\nLyoqCiAgICAgKiBDb252ZXJ0IHRoZSBnaXZlbiBDcml0ZXJpYSBleHByZXNz\naW9uIHRvIGEgY29ycmVzcG9uZGluZyBrZXJuZWwgdmFsdWUgCiAgICAgKiB1\nc2luZyB0aGUgZ2l2ZW4gRXhwcmVzc2lvbkZhY3RvcnkuCiAgICAgKiBIYW5k\nbGVzIG51bGwgZXhwcmVzc2lvbi4KICAgICAqLwogICAgIHN0YXRpYyBWYWx1\nZSB0b1ZhbHVlKEV4cHJlc3Npb25JbXBsPD8+IGUsIEV4cHJlc3Npb25GYWN0\nb3J5IGZhY3RvcnksIENyaXRlcmlhUXVlcnlJbXBsPD8+IHEpIHsKICAgICAg\nICByZXR1cm4gKGUgPT0gbnVsbCkgPyBmYWN0b3J5LmdldE51bGwoKSA6IGUu\ndG9WYWx1ZShmYWN0b3J5LCBxKTsKICAgIH0KICAgICAKICAgICBzdGF0aWMg\ndm9pZCBzZXRJbXBsaWNpdFR5cGVzKFZhbHVlIHYxLCBWYWx1ZSB2MiwgQ2xh\nc3M8Pz4gZXhwZWN0ZWQsIENyaXRlcmlhUXVlcnlJbXBsPD8+IHEpIHsKICAg\nICAgICAgSlBRTEV4cHJlc3Npb25CdWlsZGVyLnNldEltcGxpY2l0VHlwZXMo\ndjEsIHYyLCBleHBlY3RlZCwgcS5nZXRNZXRhbW9kZWwoKSwgCiAgICAgICAg\nICAgICBxLmdldFBhcmFtZXRlclR5cGVzKCksIHEudG9TdHJpbmcoKSk7CiAg\nICAgfQogICAgIAogICAgIC8qKgogICAgICAqIFZpc2l0cyB0aGUgZ2l2ZW4g\nZXhwcmVzc2lvbiBhbmQgdGhlIGdpdmVuIGNoaWxkcmVuIHJlY3Vyc2l2ZWx5\nLgogICAgICAqIFRoZSBvcmRlciBvZiB0cmF2ZXJzYWwgZGVwZW5kcyBvbiB0\naGUgcGFyZW50IGFuZCBpcyBkZXRlcm1pbmVkIGJ5IHRoZSB2aXNpdG9yLgog\nICAgICAqLwogICAgIHN0YXRpYyB2b2lkIGFjY2VwdFZpc2l0KENyaXRlcmlh\nRXhwcmVzc2lvblZpc2l0b3IgdmlzaXRvciwgQ3JpdGVyaWFFeHByZXNzaW9u\nIHBhcmVudCwgRXhwcmVzc2lvbjw/Pi4uLmV4cHJzKSB7CiAgICAgICAgIGlm\nIChwYXJlbnQgPT0gbnVsbCkKICAgICAgICAgICAgIHJldHVybjsKICAgICAg\nICAgVHJhdmVyc2FsU3R5bGUgdHJhdmVyc2FsID0gdmlzaXRvci5nZXRUcmF2\nZXJzYWxTdHlsZShwYXJlbnQpOwogICAgICAgICBzd2l0Y2ggKHRyYXZlcnNh\nbCkgewogICAgICAgICBjYXNlIElORklYIDogCiAgICAgICAgICAgICBpZiAo\nZXhwcnMgPT0gbnVsbCB8fCBleHBycy5sZW5ndGggPT0gMCkgewogICAgICAg\nICAgICAgICAgIHZpc2l0b3IuZW50ZXIocGFyZW50KTsKICAgICAgICAgICAg\nICAgICB2aXNpdG9yLmV4aXQocGFyZW50KTsKICAgICAgICAgICAgICAgICBy\nZXR1cm47CiAgICAgICAgICAgICB9CiAgICAgICAgICAgICBmb3IgKGludCBp\nID0gMDsgaSA8IGV4cHJzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAg\nICAgRXhwcmVzc2lvbkltcGw8Pz4gZSA9IChFeHByZXNzaW9uSW1wbDw/Pill\neHByc1tpXTsKICAgICAgICAgICAgICAgICBpZiAoZSAhPSBudWxsKSBlLmFj\nY2VwdFZpc2l0KHZpc2l0b3IpOwogICAgICAgICAgICAgICAgIGlmIChpICsg\nMSAhPSBleHBycy5sZW5ndGgpIHsKICAgICAgICAgICAgICAgICAgICAgdmlz\naXRvci5lbnRlcihwYXJlbnQpOwogICAgICAgICAgICAgICAgICAgICB2aXNp\ndG9yLmV4aXQocGFyZW50KTsKICAgICAgICAgICAgICAgICB9CiAgICAgICAg\nICAgICB9CiAgICAgICAgICAgICBicmVhazsKICAgICAgICAgY2FzZSBQT1NU\nRklYOgogICAgICAgICAgICAgdmlzaXRDaGlsZHJlbih2aXNpdG9yLGV4cHJz\nKTsKICAgICAgICAgICAgIHZpc2l0b3IuZW50ZXIocGFyZW50KTsKICAgICAg\nICAgICAgIHZpc2l0b3IuZXhpdChwYXJlbnQpOwogICAgICAgICAgICAgYnJl\nYWs7CiAgICAgICAgIGNhc2UgUFJFRklYIDoKICAgICAgICAgICAgIHZpc2l0\nb3IuZW50ZXIocGFyZW50KTsKICAgICAgICAgICAgIHZpc2l0b3IuZXhpdChw\nYXJlbnQpOwogICAgICAgICAgICAgdmlzaXRDaGlsZHJlbih2aXNpdG9yLGV4\ncHJzKTsKICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICBjYXNlIEZVTkNU\nSU9OOgogICAgICAgICAgICAgdmlzaXRvci5lbnRlcihwYXJlbnQpOwogICAg\nICAgICAgICAgdmlzaXRDaGlsZHJlbih2aXNpdG9yLCBleHBycyk7CiAgICAg\nICAgICAgICB2aXNpdG9yLmV4aXQocGFyZW50KTsKICAgICAgICAgICAgIGJy\nZWFrOwogICAgICAgICB9CiAgICAgfQogICAgIAogICAgIHN0YXRpYyB2b2lk\nIHZpc2l0Q2hpbGRyZW4oQ3JpdGVyaWFFeHByZXNzaW9uVmlzaXRvciB2aXNp\ndG9yLCBFeHByZXNzaW9uPD8+Li4uZXhwcnMpIHsKICAgICAgICAgZm9yIChp\nbnQgaSA9IDA7IGV4cHJzICE9IG51bGwgJiYgaSA8IGV4cHJzLmxlbmd0aDsg\naSsrKSB7CiAgICAgICAgICAgICBFeHByZXNzaW9uSW1wbDw/PiBlID0gKEV4\ncHJlc3Npb25JbXBsPD8+KWV4cHJzW2ldOwogICAgICAgICAgICAgaWYgKGUg\nIT0gbnVsbCkgZS5hY2NlcHRWaXNpdCh2aXNpdG9yKTsKICAgICAgICAgfQog\nICAgIH0KICAgICAKICAgICAvKioKICAgICAgKiBSZW5kZXJzIHRoZSBnaXZl\nbiBleHByZXNzaW9ucyBhcyBhIGxpc3Qgb2YgdmFsdWVzIHNlcGFyYXRlZCBi\neSB0aGUgZ2l2ZW4gY29ubmVjdG9yLgogICAgICAqLwogICAgIHN0YXRpYyBT\ndHJpbmdCdWlsZGVyIGFzVmFsdWUoQWxpYXNDb250ZXh0IHEsIEV4cHJlc3Np\nb248Pz5bXSBleHBzLCBTdHJpbmcgY29ubmVjdG9yKSB7CiAgICAgICAgIFN0\ncmluZ0J1aWxkZXIgYnVmZmVyID0gbmV3IFN0cmluZ0J1aWxkZXIoKTsKICAg\nICAgICAgaWYgKGV4cHMgPT0gbnVsbCkgcmV0dXJuIGJ1ZmZlcjsKICAgICAg\nICAgZm9yIChpbnQgaSA9IDA7IGkgPCBleHBzLmxlbmd0aDsgaSsrKSB7CiAg\nICAgICAgICAgICBidWZmZXIuYXBwZW5kKCgoRXhwcmVzc2lvbkltcGw8Pz4p\nZXhwc1tpXSkuYXNWYWx1ZShxKSk7CiAgICAgICAgICAgICBpZiAoaSsxICE9\nIGV4cHMubGVuZ3RoKSB7CiAgICAgICAgICAgICAgICAgYnVmZmVyLmFwcGVu\nZChjb25uZWN0b3IpOwogICAgICAgICAgICAgfQogICAgICAgICB9CiAgICAg\nICAgIHJldHVybiBidWZmZXI7CiAgICAgfQogICAgIAogICAgIC8qKgogICAg\nICAqIFJlbmRlcnMgdGhlIGdpdmVuIGFyZ3VtZW50cyBhcyBhIGxpc3Qgb2Yg\ndmFsdWVzIHNlcGFyYXRlZCBieSB0aGUgZ2l2ZW4gY29ubmVjdG9yLgogICAg\nICAqLwogICAgIHN0YXRpYyBTdHJpbmdCdWlsZGVyIGFzVmFsdWUoQWxpYXND\nb250ZXh0IHEsIE9iamVjdC4uLnBhcmFtcykgewogICAgICAgICBTdHJpbmdC\ndWlsZGVyIGJ1ZmZlciA9IG5ldyBTdHJpbmdCdWlsZGVyKCk7CiAgICAgICAg\nIGlmIChwYXJhbXMgPT0gbnVsbCkgcmV0dXJuIGJ1ZmZlcjsKICAgICAgICAg\nZm9yIChpbnQgaSA9IDA7IGkgPCBwYXJhbXMubGVuZ3RoOyBpKyspIHsKICAg\nICAgICAgICAgIE9iamVjdCBvID0gcGFyYW1zW2ldOwogICAgICAgICAgICAg\naWYgKG8gPT0gbnVsbCkgewogICAgICAgICAgICAgICAgIGlmIChpKzEgPCBw\nYXJhbXMubGVuZ3RoICYmIHBhcmFtc1tpKzFdLmVxdWFscyhDT01NQSkpIHsK\nICAgICAgICAgICAgICAgICAgICAgaSsrOwogICAgICAgICAgICAgICAgIH0K\nICAgICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgIH0KICAg\nICAgICAgICAgIGlmIChvIGluc3RhbmNlb2YgQ3JpdGVyaWFFeHByZXNzaW9u\nKSB7CiAgICAgICAgICAgICAgICAgYnVmZmVyLmFwcGVuZCgoKENyaXRlcmlh\nRXhwcmVzc2lvbilvKS5hc1ZhbHVlKHEpKTsKICAgICAgICAgICAgIH0gZWxz\nZSB7CiAgICAgICAgICAgICAgICAgYnVmZmVyLmFwcGVuZChvKTsKICAgICAg\nICAgICAgIH0KICAgICAgICAgfQogICAgICAgICByZXR1cm4gYnVmZmVyOwog\nICAgIH0KICAgICAKICAgICAvKioKICAgICAgKiBSZXR1cm4gYSBsaXN0IHRo\nYXQgaXMgZWl0aGVyIGVtcHR5IChpZiB0aGUgZ2l2ZW4gbGlzdCBpcyBudWxs\nKSBvciBhIGxpc3QKICAgICAgKiB3aG9zZSBtdXRhdGlvbiBkbyBub3QgaW1w\nYWN0IHRoZSBvcmlnaW5hbCBsaXN0LgogICAgICAqLwogICAgIHN0YXRpYyA8\nWD4gTGlzdDxYPiByZXR1cm5Db3B5KExpc3Q8WD4gbGlzdCkgewogICAgICAg\nICByZXR1cm4gbGlzdCA9PSBudWxsID8gbmV3IEFycmF5TGlzdDxYPigpIDog\nbmV3IENvcHlPbldyaXRlQXJyYXlMaXN0PFg+KGxpc3QpOwogICAgIH0KICAg\nICAKICAgICAvKioKICAgICAgKiBSZXR1cm4gYSBzZXQgdGhhdCBpcyBlaXRo\nZXIgZW1wdHkgKGlmIHRoZSBnaXZlbiBzZXQgaXMgbnVsbCkgb3IgYSBzZXQK\nICAgICAgKiB3aG9zZSBtdXRhdGlvbiBkbyBub3QgaW1wYWN0IHRoZSBvcmln\naW5hbCBsaXN0LgogICAgICAqLwogICAgIHN0YXRpYyA8WD4gU2V0PFg+IHJl\ndHVybkNvcHkoU2V0PFg+IHNldCkgewogICAgICAgICByZXR1cm4gc2V0ID09\nIG51bGwgPyBuZXcgSGFzaFNldDxYPigpIDogbmV3IENvcHlPbldyaXRlQXJy\nYXlTZXQ8WD4oc2V0KTsKICAgICB9CiAgICAgCiAgICAgc3RhdGljIG9yZy5h\ncGFjaGUub3BlbmpwYS5rZXJuZWwuZXhwcy5FeHByZXNzaW9uIGFuZChFeHBy\nZXNzaW9uRmFjdG9yeSBmYWN0b3J5LAogICAgICAgICAgICAgb3JnLmFwYWNo\nZS5vcGVuanBhLmtlcm5lbC5leHBzLkV4cHJlc3Npb24gZTEsIG9yZy5hcGFj\naGUub3BlbmpwYS5rZXJuZWwuZXhwcy5FeHByZXNzaW9uIGUyKSB7CiAgICAg\nICAgICAgICByZXR1cm4gZTEgPT0gbnVsbCA/IGUyIDogZTIgPT0gbnVsbCA/\nIGUxIDogZmFjdG9yeS5hbmQoZTEsIGUyKTsKICAgICB9CiAgICAgICAgIAoK\nCiAgICAgLyoqCiAgICAgKiBVbmFyeSBGdW5jdGlvbmFsIEV4cHJlc3Npb24g\nYXBwbGllcyBhIHVuYXJ5IGZ1bmN0aW9uIG9uIGEgaW5wdXQgb3BlcmFuZCBF\neHByZXNzaW9uLgogICAgICoKICAgICAqIEBwYXJhbSA8WD4gdGhlIHR5cGUg\nb2YgdGhlIHJlc3VsdGFudCBleHByZXNzaW9uCiAgICAgKi8KICAgIHB1Ymxp\nYyBhYnN0cmFjdCBzdGF0aWMgY2xhc3MgVW5hcnlGdW5jdGlvbmFsRXhwcmVz\nc2lvbjxYPiBleHRlbmRzIEV4cHJlc3Npb25JbXBsPFg+IHsKICAgICAgICBw\ncm90ZWN0ZWQgZmluYWwgRXhwcmVzc2lvbkltcGw8Pz4gZTsKICAgICAgICAv\nKioKICAgICAgICAgKiBTdXBwbHkgdGhlIHJlc3VsdGFudCB0eXBlIGFuZCBp\nbnB1dCBvcGVyYW5kIGV4cHJlc3Npb24uCiAgICAgICAgICovCiAgICAgICAg\ncHVibGljIFVuYXJ5RnVuY3Rpb25hbEV4cHJlc3Npb24oQ2xhc3M8WD4gdCwg\nRXhwcmVzc2lvbjw/PiBlKSB7CiAgICAgICAgICAgIHN1cGVyKHQpOwogICAg\nICAgICAgICB0aGlzLmUgID0gKEV4cHJlc3Npb25JbXBsPD8+KWU7CiAgICAg\nICAgfQogICAgICAgIAogICAgICAgIHB1YmxpYyBVbmFyeUZ1bmN0aW9uYWxF\neHByZXNzaW9uKEV4cHJlc3Npb248WD4gZSkgewogICAgICAgICAgICB0aGlz\nKChDbGFzczxYPillLmdldEphdmFUeXBlKCksIGUpOwogICAgICAgIH0KICAg\nICAgICAKICAgICAgICBwdWJsaWMgdm9pZCBhY2NlcHRWaXNpdChDcml0ZXJp\nYUV4cHJlc3Npb25WaXNpdG9yIHZpc2l0b3IpIHsKICAgICAgICAgICAgRXhw\ncmVzc2lvbnMuYWNjZXB0VmlzaXQodmlzaXRvciwgdGhpcywgZSk7CiAgICAg\nICAgfQogICAgfQogICAgCiAgICAvKioKICAgICAqIEJpbmFyeSBGdW5jdGlv\nbmFsIEV4cHJlc3Npb24gYXBwbGllcyBhIGJpbmFyeSBmdW5jdGlvbiBvbiBh\nIHBhaXIgb2YgaW5wdXQgRXhwcmVzc2lvbi4KICAgICAqIAogICAgICogQHBh\ncmFtIDxYPiB0aGUgdHlwZSBvZiB0aGUgcmVzdWx0YW50IGV4cHJlc3Npb24K\nICAgICAqLwogICAgcHVibGljIGFic3RyYWN0IHN0YXRpYyBjbGFzcyBCaW5h\ncmF5RnVuY3Rpb25hbEV4cHJlc3Npb248WD4gZXh0ZW5kcyBFeHByZXNzaW9u\nSW1wbDxYPnsKICAgICAgICBwcm90ZWN0ZWQgZmluYWwgRXhwcmVzc2lvbklt\ncGw8Pz4gZTE7CiAgICAgICAgcHJvdGVjdGVkIGZpbmFsIEV4cHJlc3Npb25J\nbXBsPD8+IGUyOwogICAgICAgIAogICAgICAgIC8qKgogICAgICAgICAqIFN1\ncHBseSB0aGUgcmVzdWx0YW50IHR5cGUgYW5kIHBhaXIgb2YgaW5wdXQgb3Bl\ncmFuZCBleHByZXNzaW9ucy4KICAgICAgICAgKi8KICAgICAgICBwdWJsaWMg\nQmluYXJheUZ1bmN0aW9uYWxFeHByZXNzaW9uKENsYXNzPFg+IHQsIEV4cHJl\nc3Npb248Pz4geCwgRXhwcmVzc2lvbjw/PiB5KSB7CiAgICAgICAgICAgIHN1\ncGVyKHQpOwogICAgICAgICAgICBlMSA9IChFeHByZXNzaW9uSW1wbDw/Pil4\nOwogICAgICAgICAgICBlMiA9IChFeHByZXNzaW9uSW1wbDw/Pil5OwogICAg\nICAgIH0KICAgICAgICAKICAgICAgICBwdWJsaWMgdm9pZCBhY2NlcHRWaXNp\ndChDcml0ZXJpYUV4cHJlc3Npb25WaXNpdG9yIHZpc2l0b3IpIHsKICAgICAg\nICAgICAgRXhwcmVzc2lvbnMuYWNjZXB0VmlzaXQodmlzaXRvciwgdGhpcywg\nZTEsIGUyKTsKICAgICAgICB9CiAgICB9CiAgICAKICAgIC8qKgogICAgICog\nRnVuY3Rpb25hbCBFeHByZXNzaW9uIGFwcGxpZXMgYSBmdW5jdGlvbiBvbiBh\nIGxpc3Qgb2YgaW5wdXQgRXhwcmVzc2lvbnMuCiAgICAgKiAKICAgICAqIEBw\nYXJhbSA8WD4gdGhlIHR5cGUgb2YgdGhlIHJlc3VsdGFudCBleHByZXNzaW9u\nCiAgICAgKi8KICAgIHB1YmxpYyBhYnN0cmFjdCBzdGF0aWMgY2xhc3MgRnVu\nY3Rpb25hbEV4cHJlc3Npb248WD4gZXh0ZW5kcyBFeHByZXNzaW9uSW1wbDxY\nPiB7CiAgICAgICAgcHJvdGVjdGVkIGZpbmFsIEV4cHJlc3Npb25JbXBsPD8+\nW10gYXJnczsKICAgICAgICAKICAgICAgICAvKioKICAgICAgICAgKiBTdXBw\nbHkgdGhlIHJlc3VsdGFudCB0eXBlIGFuZCBsaXN0IG9mIGlucHV0IG9wZXJh\nbmQgZXhwcmVzc2lvbnMuCiAgICAgICAgICovCiAgICAgICAgcHVibGljIEZ1\nbmN0aW9uYWxFeHByZXNzaW9uKENsYXNzPFg+IHQsIEV4cHJlc3Npb248Pz4u\nLi4gYXJncykgewogICAgICAgICAgICBzdXBlcih0KTsKICAgICAgICAgICAg\naW50IGxlbiA9IGFyZ3MgPT0gbnVsbCA/IDAgOiBhcmdzLmxlbmd0aDsKICAg\nICAgICAgICAgdGhpcy5hcmdzID0gbmV3IEV4cHJlc3Npb25JbXBsPD8+W2xl\nbl07CiAgICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBhcmdzICE9IG51bGwg\nJiYgaSA8IGFyZ3MubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICAgIHRo\naXMuYXJnc1tpXSA9IChFeHByZXNzaW9uSW1wbDw/PilhcmdzW2ldOwogICAg\nICAgICAgICB9CiAgICAgICAgfQogICAgICAgIAogICAgICAgIHB1YmxpYyB2\nb2lkIGFjY2VwdFZpc2l0KENyaXRlcmlhRXhwcmVzc2lvblZpc2l0b3Igdmlz\naXRvcikgewogICAgICAgICAgICBFeHByZXNzaW9ucy5hY2NlcHRWaXNpdCh2\naXNpdG9yLCB0aGlzLCBhcmdzKTsKICAgICAgICB9CiAgICB9CiAgIAogICAg\nLyoqCiAgICAgKiBCaW5hcnkgTG9naWNhbCBFeHByZXNzaW9uIGFwcGxpZXMg\nYSBmdW5jdGlvbiBvbiBhIHBhaXIgb2YgaW5wdXQgRXhwcmVzc2lvbiB0byBn\nZW5lcmF0ZSBhIFByZWRpY2F0ZQogICAgICogaS5lLiBhbiBleHByZXNzaW9u\nIHdob3NlIHJlc3VsdGFudCB0eXBlIGlzIEJvb2xlYW4uCiAgICAgKgogICAg\nICovCiAgIHB1YmxpYyBzdGF0aWMgYWJzdHJhY3QgY2xhc3MgQmluYXJ5TG9n\naWNhbEV4cHJlc3Npb24gZXh0ZW5kcyBQcmVkaWNhdGVJbXBsIHsKICAgICAg\nICBwcm90ZWN0ZWQgZmluYWwgRXhwcmVzc2lvbkltcGw8Pz4gZTE7CiAgICAg\nICAgcHJvdGVjdGVkIGZpbmFsIEV4cHJlc3Npb25JbXBsPD8+IGUyOwogICAg\nICAgIAogICAgICAgIHB1YmxpYyBCaW5hcnlMb2dpY2FsRXhwcmVzc2lvbihF\neHByZXNzaW9uPD8+IHgsIEV4cHJlc3Npb248Pz4geSkgewogICAgICAgICAg\nICBzdXBlcigpOwogICAgICAgICAgICBlMSA9IChFeHByZXNzaW9uSW1wbDw/\nPil4OwogICAgICAgICAgICBlMiA9IChFeHByZXNzaW9uSW1wbDw/Pil5Owog\nICAgICAgIH0KICAgICAgICAgICAgICAgIAogICAgICAgIHB1YmxpYyB2b2lk\nIGFjY2VwdFZpc2l0KENyaXRlcmlhRXhwcmVzc2lvblZpc2l0b3IgdmlzaXRv\ncikgewogICAgICAgICAgICBFeHByZXNzaW9ucy5hY2NlcHRWaXNpdCh2aXNp\ndG9yLCB0aGlzLCBlMSwgZTIpOwogICAgICAgIH0KICAgIH0KICAgIAogICAg\nCiAgICBwdWJsaWMgc3RhdGljIGNsYXNzIEFiczxYPiBleHRlbmRzIFVuYXJ5\nRnVuY3Rpb25hbEV4cHJlc3Npb248WD4gewogICAgICAgIHB1YmxpYyAgQWJz\nKEV4cHJlc3Npb248WD4geCkgewogICAgICAgICAgICBzdXBlcih4KTsKICAg\nICAgICB9CgogICAgICAgIEBPdmVycmlkZQogICAgICAgIHB1YmxpYyBWYWx1\nZSB0b1ZhbHVlKEV4cHJlc3Npb25GYWN0b3J5IGZhY3RvcnksIENyaXRlcmlh\nUXVlcnlJbXBsPD8+IHEpIHsKICAgICAgICAgICAgVmFsdWUgdmFsdWUgPSBm\nYWN0b3J5LmFicyhFeHByZXNzaW9ucy50b1ZhbHVlKGUsIGZhY3RvcnksIHEp\nKTsKICAgICAgICAgICAgdmFsdWUuc2V0SW1wbGljaXRUeXBlKGdldEphdmFU\neXBlKCkpOwogICAgICAgICAgICByZXR1cm4gdmFsdWU7CiAgICAgICAgfQog\nICAgICAgIAogICAgICAgIHB1YmxpYyBTdHJpbmdCdWlsZGVyIGFzVmFsdWUo\nQWxpYXNDb250ZXh0IHEpIHsKICAgICAgICAgICAgcmV0dXJuIEV4cHJlc3Np\nb25zLmFzVmFsdWUocSwgIkFCUyIsIE9QRU5fQlJBQ0UsIGUsIENMT1NFX0JS\nQUNFKTsKICAgICAgICB9CiAgICB9CiAgICAKICAgIHB1YmxpYyBzdGF0aWMg\nY2xhc3MgQ291bnQgZXh0ZW5kcyBVbmFyeUZ1bmN0aW9uYWxFeHByZXNzaW9u\nPExvbmc+IHsKICAgICAgICBwcml2YXRlIGJvb2xlYW4gX2Rpc3RpbmN0OyAK\nICAgICAgICBwdWJsaWMgIENvdW50KEV4cHJlc3Npb248Pz4geCkgewogICAg\nICAgICAgICB0aGlzKHgsIGZhbHNlKTsKICAgICAgICB9CiAgICAgICAgCiAg\nICAgICAgcHVibGljICBDb3VudChFeHByZXNzaW9uPD8+IHgsIGJvb2xlYW4g\nZGlzdGluY3QpIHsKICAgICAgICAgICAgc3VwZXIoTG9uZy5jbGFzcywgeCk7\nCiAgICAgICAgICAgIF9kaXN0aW5jdCA9IGRpc3RpbmN0OwogICAgICAgICAg\nICAKICAgICAgICB9CgogICAgICAgIEBPdmVycmlkZQogICAgICAgIHB1Ymxp\nYyBWYWx1ZSB0b1ZhbHVlKEV4cHJlc3Npb25GYWN0b3J5IGZhY3RvcnksIENy\naXRlcmlhUXVlcnlJbXBsPD8+IHEpIHsKICAgICAgICAgICAgVmFsdWUgdiA9\nIEV4cHJlc3Npb25zLnRvVmFsdWUoZSwgZmFjdG9yeSwgcSk7CiAgICAgICAg\nICAgIHJldHVybiBfZGlzdGluY3QgPyBmYWN0b3J5LmNvdW50KGZhY3Rvcnku\nZGlzdGluY3QodikpIDogZmFjdG9yeS5jb3VudCh2KTsKICAgICAgICB9CiAg\nICAgICAgCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgcHVibGljIFN0cmlu\nZ0J1aWxkZXIgYXNWYWx1ZShBbGlhc0NvbnRleHQgcSkgewogICAgICAgICAg\nICByZXR1cm4gRXhwcmVzc2lvbnMuYXNWYWx1ZShxLCAiQ09VTlQiLCBPUEVO\nX0JSQUNFLCBfZGlzdGluY3QgPyAiRElTVElOQ1QiK09QRU5fQlJBQ0UgOiAi\nIiwgCiAgICAgICAgICAgICAgICBlLCBfZGlzdGluY3QgPyBDTE9TRV9CUkFD\nRSA6ICIiLCBDTE9TRV9CUkFDRSk7CiAgICAgICAgfQogICAgfQoKICAgIHB1\nYmxpYyBzdGF0aWMgY2xhc3MgQXZnIGV4dGVuZHMgVW5hcnlGdW5jdGlvbmFs\nRXhwcmVzc2lvbjxEb3VibGU+IHsKICAgICAgICBwdWJsaWMgIEF2ZyhFeHBy\nZXNzaW9uPD8+IHgpIHsKICAgICAgICAgICAgc3VwZXIoRG91YmxlLmNsYXNz\nLCB4KTsKICAgICAgICB9CgogICAgICAgIEBPdmVycmlkZQogICAgICAgIHB1\nYmxpYyBWYWx1ZSB0b1ZhbHVlKEV4cHJlc3Npb25GYWN0b3J5IGZhY3Rvcnks\nIENyaXRlcmlhUXVlcnlJbXBsPD8+IHEpIHsKICAgICAgICAgICAgVmFsdWUg\ndmFsdWUgPSBmYWN0b3J5LmF2ZyhFeHByZXNzaW9ucy50b1ZhbHVlKGUsIGZh\nY3RvcnksIHEpKTsKICAgICAgICAgICAgdmFsdWUuc2V0SW1wbGljaXRUeXBl\nKGdldEphdmFUeXBlKCkpOwogICAgICAgICAgICByZXR1cm4gdmFsdWU7CiAg\nICAgICAgfQogICAgICAgIAogICAgICAgIEBPdmVycmlkZQogICAgICAgIHB1\nYmxpYyBTdHJpbmdCdWlsZGVyIGFzVmFsdWUoQWxpYXNDb250ZXh0IHEpIHsK\nICAgICAgICAgICAgcmV0dXJuIEV4cHJlc3Npb25zLmFzVmFsdWUocSwgIkFW\nRyIsIE9QRU5fQlJBQ0UsIGUsIENMT1NFX0JSQUNFKTsKICAgICAgICB9CiAg\nICB9CiAgICAKICAgIHB1YmxpYyBzdGF0aWMgY2xhc3MgU3FydCBleHRlbmRz\nIFVuYXJ5RnVuY3Rpb25hbEV4cHJlc3Npb248RG91YmxlPiB7CiAgICAgICAg\ncHVibGljICBTcXJ0KEV4cHJlc3Npb248PyBleHRlbmRzIE51bWJlcj4geCkg\newogICAgICAgICAgICBzdXBlcihEb3VibGUuY2xhc3MsIHgpOwogICAgICAg\nIH0KCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgcHVibGljIFZhbHVlIHRv\nVmFsdWUoRXhwcmVzc2lvbkZhY3RvcnkgZmFjdG9yeSwgQ3JpdGVyaWFRdWVy\neUltcGw8Pz4gcSkgewogICAgICAgICAgICBWYWx1ZSB2YWx1ZSA9IGZhY3Rv\ncnkuc3FydChFeHByZXNzaW9ucy50b1ZhbHVlKGUsIGZhY3RvcnksIHEpKTsK\nICAgICAgICAgICAgdmFsdWUuc2V0SW1wbGljaXRUeXBlKGdldEphdmFUeXBl\nKCkpOwogICAgICAgICAgICByZXR1cm4gdmFsdWU7CiAgICAgICAgfQogICAg\nICAgIAogICAgICAgIHB1YmxpYyBTdHJpbmdCdWlsZGVyIGFzVmFsdWUoQWxp\nYXNDb250ZXh0IHEpIHsKICAgICAgICAgICAgcmV0dXJuIEV4cHJlc3Npb25z\nLmFzVmFsdWUocSwgIlNRUlQiLCBPUEVOX0JSQUNFLCBlLCBDTE9TRV9CUkFD\nRSk7CiAgICAgICAgfQogICAgfQogICAgCiAgICBwdWJsaWMgc3RhdGljIGNs\nYXNzIE1heDxYPiBleHRlbmRzIFVuYXJ5RnVuY3Rpb25hbEV4cHJlc3Npb248\nWD4gewogICAgICAgIHB1YmxpYyAgTWF4KEV4cHJlc3Npb248WD4geCkgewog\nICAgICAgICAgICBzdXBlcih4KTsKICAgICAgICB9CgogICAgICAgIEBPdmVy\ncmlkZQogICAgICAgIHB1YmxpYyBWYWx1ZSB0b1ZhbHVlKEV4cHJlc3Npb25G\nYWN0b3J5IGZhY3RvcnksIENyaXRlcmlhUXVlcnlJbXBsPD8+IHEpIHsKICAg\nICAgICAgICAgVmFsdWUgdmFsdWUgPSBmYWN0b3J5Lm1heChFeHByZXNzaW9u\ncy50b1ZhbHVlKGUsIGZhY3RvcnksIHEpKTsKICAgICAgICAgICAgdmFsdWUu\nc2V0SW1wbGljaXRUeXBlKGdldEphdmFUeXBlKCkpOwogICAgICAgICAgICBy\nZXR1cm4gdmFsdWU7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIHB1Ymxp\nYyBTdHJpbmdCdWlsZGVyIGFzVmFsdWUoQWxpYXNDb250ZXh0IHEpIHsKICAg\nICAgICAgICAgcmV0dXJuIEV4cHJlc3Npb25zLmFzVmFsdWUocSwgIk1BWCIs\nIE9QRU5fQlJBQ0UsIGUsIENMT1NFX0JSQUNFKTsKICAgICAgICB9CiAgICB9\nCgogICAgcHVibGljIHN0YXRpYyBjbGFzcyBNaW48WD4gZXh0ZW5kcyBVbmFy\neUZ1bmN0aW9uYWxFeHByZXNzaW9uPFg+IHsKICAgICAgICBwdWJsaWMgIE1p\nbihFeHByZXNzaW9uPFg+IHgpIHsKICAgICAgICAgICAgc3VwZXIoeCk7CiAg\nICAgICAgfQoKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBwdWJsaWMgVmFs\ndWUgdG9WYWx1ZShFeHByZXNzaW9uRmFjdG9yeSBmYWN0b3J5LCBDcml0ZXJp\nYVF1ZXJ5SW1wbDw/PiBxKSB7CiAgICAgICAgICAgIFZhbHVlIHZhbHVlID0g\nZmFjdG9yeS5taW4oRXhwcmVzc2lvbnMudG9WYWx1ZShlLCBmYWN0b3J5LCBx\nKSk7CiAgICAgICAgICAgIHZhbHVlLnNldEltcGxpY2l0VHlwZShnZXRKYXZh\nVHlwZSgpKTsKICAgICAgICAgICAgcmV0dXJuIHZhbHVlOwogICAgICAgIH0K\nICAgICAgICAKICAgICAgICBwdWJsaWMgU3RyaW5nQnVpbGRlciBhc1ZhbHVl\nKEFsaWFzQ29udGV4dCBxKSB7CiAgICAgICAgICAgIHJldHVybiBFeHByZXNz\naW9ucy5hc1ZhbHVlKHEsICJNSU4iLCBPUEVOX0JSQUNFLCBlLCBDTE9TRV9C\nUkFDRSk7CiAgICAgICAgfQogICAgfQogICAgCiAgICBwdWJsaWMgc3RhdGlj\nIGNsYXNzIFNpemUgZXh0ZW5kcyBVbmFyeUZ1bmN0aW9uYWxFeHByZXNzaW9u\nPEludGVnZXI+IHsKICAgICAgICBwdWJsaWMgIFNpemUoRXhwcmVzc2lvbjw/\nIGV4dGVuZHMgQ29sbGVjdGlvbjw/Pj4geCkgewogICAgICAgICAgICBzdXBl\ncihJbnRlZ2VyLmNsYXNzLCB4KTsKICAgICAgICB9CiAgICAgICAgCiAgICAg\nICAgcHVibGljICBTaXplKENvbGxlY3Rpb248Pz4geCkgewogICAgICAgICAg\nICB0aGlzKG5ldyBDb25zdGFudDxDb2xsZWN0aW9uPD8+Pih4KSk7CiAgICAg\nICAgfQoKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBwdWJsaWMgVmFsdWUg\ndG9WYWx1ZShFeHByZXNzaW9uRmFjdG9yeSBmYWN0b3J5LCBDcml0ZXJpYVF1\nZXJ5SW1wbDw/PiBxKSB7CiAgICAgICAgICAgIFZhbHVlIHZhbCA9IEV4cHJl\nc3Npb25zLnRvVmFsdWUoZSwgZmFjdG9yeSwgcSk7CiAgICAgICAgICAgIFZh\nbHVlIHJlc3VsdDsKICAgICAgICAgICAgaWYgKHZhbCBpbnN0YW5jZW9mIExp\ndGVyYWwgJiYgKChMaXRlcmFsKXZhbCkuZ2V0UGFyc2VUeXBlKCkgPT0gTGl0\nZXJhbC5UWVBFX0NPTExFQ1RJT04pCiAgICAgICAgICAgICAgICByZXN1bHQg\nPSBmYWN0b3J5Lm5ld0xpdGVyYWwoKChDb2xsZWN0aW9uKSgoTGl0ZXJhbCl2\nYWwpLmdldFZhbHVlKCkpLnNpemUoKSwgCiAgICAgICAgICAgICAgICAgICAg\nTGl0ZXJhbC5UWVBFX05VTUJFUik7CiAgICAgICAgICAgIGVsc2UKICAgICAg\nICAgICAgICAgIHJlc3VsdCA9IGZhY3Rvcnkuc2l6ZSh2YWwpOwogICAgICAg\nICAgICByZXN1bHQuc2V0SW1wbGljaXRUeXBlKEludGVnZXIuY2xhc3MpOwog\nICAgICAgICAgICByZXR1cm4gcmVzdWx0OwogICAgICAgIH0KICAgICAgICAK\nICAgICAgICBwdWJsaWMgU3RyaW5nQnVpbGRlciBhc1ZhbHVlKEFsaWFzQ29u\ndGV4dCBxKSB7CiAgICAgICAgICAgIHJldHVybiBFeHByZXNzaW9ucy5hc1Zh\nbHVlKHEsICJTSVpFIiwgT1BFTl9CUkFDRSwgZSwgQ0xPU0VfQlJBQ0UpOwog\nICAgICAgIH0KICAgIH0KICAgIAogICAgcHVibGljIHN0YXRpYyBjbGFzcyBE\nYXRhYmFzZUZ1bmN0aW9uPFQ+IGV4dGVuZHMgRnVuY3Rpb25hbEV4cHJlc3Np\nb248VD4gewogICAgICAgIHByaXZhdGUgZmluYWwgU3RyaW5nIGZ1bmN0aW9u\nTmFtZTsKICAgICAgICBwcml2YXRlIGZpbmFsIENsYXNzPFQ+IHJlc3VsdFR5\ncGU7CiAgICAgICAKICAgICAgICBwdWJsaWMgIERhdGFiYXNlRnVuY3Rpb24o\nU3RyaW5nIG5hbWUsIENsYXNzPFQ+IHJlc3VsdFR5cGUsIEV4cHJlc3Npb248\nPz4uLi4gZXhwcykgewogICAgICAgICAgICBzdXBlcihyZXN1bHRUeXBlLCBl\neHBzKTsKICAgICAgICAgICAgZnVuY3Rpb25OYW1lID0gbmFtZTsKICAgICAg\nICAgICAgdGhpcy5yZXN1bHRUeXBlID0gcmVzdWx0VHlwZTsKICAgICAgICB9\nCiAgICAgICAgCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgcHVibGljIFZh\nbHVlIHRvVmFsdWUoRXhwcmVzc2lvbkZhY3RvcnkgZmFjdG9yeSwgQ3JpdGVy\naWFRdWVyeUltcGw8Pz4gcSkgewogICAgICAgICAgICByZXR1cm4gZmFjdG9y\neS5uZXdGdW5jdGlvbihmdW5jdGlvbk5hbWUsIGdldEphdmFUeXBlKCksIAog\nICAgICAgICAgICAgICAgbmV3IEV4cHJlc3Npb25zLkxpc3RBcmd1bWVudChy\nZXN1bHRUeXBlLCBhcmdzKS50b1ZhbHVlKGZhY3RvcnksIHEpKTsKICAgICAg\nICB9CiAgICAgICAgCiAgICAgICAgcHVibGljIFN0cmluZ0J1aWxkZXIgYXNW\nYWx1ZShBbGlhc0NvbnRleHQgcSkgewogICAgICAgICAgICByZXR1cm4gRXhw\ncmVzc2lvbnMuYXNWYWx1ZShxLCBmdW5jdGlvbk5hbWUsIE9QRU5fQlJBQ0Us\nIEV4cHJlc3Npb25zLmFzVmFsdWUocSwgYXJncywgQ09NTUEpLCBDTE9TRV9C\nUkFDRSk7CiAgICAgICAgfQogICAgfQoKICAgIAogICAgcHVibGljIHN0YXRp\nYyBjbGFzcyBUeXBlPFggZXh0ZW5kcyBDbGFzcz4gZXh0ZW5kcyBVbmFyeUZ1\nbmN0aW9uYWxFeHByZXNzaW9uPFg+IHsKICAgICAgICBwdWJsaWMgVHlwZShQ\nYXRoSW1wbDw/LCA/PiBwYXRoKSB7CiAgICAgICAgICAgIHN1cGVyKChDbGFz\ncylDbGFzcy5jbGFzcywgcGF0aCk7CiAgICAgICAgfQogICAgICAgIAogICAg\nICAgIEBPdmVycmlkZQogICAgICAgIHB1YmxpYyBWYWx1ZSB0b1ZhbHVlKEV4\ncHJlc3Npb25GYWN0b3J5IGZhY3RvcnksIENyaXRlcmlhUXVlcnlJbXBsPD8+\nIHEpIHsKICAgICAgICAgICAgcmV0dXJuIGZhY3RvcnkudHlwZShFeHByZXNz\naW9ucy50b1ZhbHVlKGUsIGZhY3RvcnksIHEpKTsKICAgICAgICB9CiAgICAg\nICAgCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgcHVibGljIFN0cmluZ0J1\naWxkZXIgYXNWYWx1ZShBbGlhc0NvbnRleHQgcSkgewogICAgICAgICAgICBy\nZXR1cm4gRXhwcmVzc2lvbnMuYXNWYWx1ZShxLCAiVFlQRSIsIE9QRU5fQlJB\nQ0UsIGUsIENMT1NFX0JSQUNFKTsKICAgICAgICB9CiAgICB9CgogICAgcHVi\nbGljIHN0YXRpYyBjbGFzcyBDYXN0PEI+IGV4dGVuZHMgVW5hcnlGdW5jdGlv\nbmFsRXhwcmVzc2lvbjxCPiB7CiAgICAgICAgcHVibGljIENhc3QoRXhwcmVz\nc2lvbjw/PiB4LCBDbGFzczxCPiBiKSB7CiAgICAgICAgICAgIHN1cGVyKGIs\nIHgpOwogICAgICAgIH0KCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgcHVi\nbGljIFZhbHVlIHRvVmFsdWUoRXhwcmVzc2lvbkZhY3RvcnkgZmFjdG9yeSwg\nQ3JpdGVyaWFRdWVyeUltcGw8Pz4gcSkgewogICAgICAgICAgICByZXR1cm4g\nZmFjdG9yeS5jYXN0KEV4cHJlc3Npb25zLnRvVmFsdWUoZSwgZmFjdG9yeSwg\ncSksIGdldEphdmFUeXBlKCkpOwogICAgICAgIH0KICAgICAgICAKICAgICAg\nICBAT3ZlcnJpZGUKICAgICAgICBwdWJsaWMgU3RyaW5nQnVpbGRlciBhc1Zh\nbHVlKEFsaWFzQ29udGV4dCBxKSB7CiAgICAgICAgICAgIHJldHVybiBFeHBy\nZXNzaW9ucy5hc1ZhbHVlKHEsIE9QRU5fQlJBQ0UsIGdldEphdmFUeXBlKCku\nZ2V0U2ltcGxlTmFtZSgpLCBDTE9TRV9CUkFDRSwgZSk7CiAgICAgICAgfQog\nICAgfQogICAgCiAgICBwdWJsaWMgc3RhdGljIGNsYXNzIENvbmNhdCBleHRl\nbmRzIEJpbmFyYXlGdW5jdGlvbmFsRXhwcmVzc2lvbjxTdHJpbmc+IHsKICAg\nICAgICBwdWJsaWMgQ29uY2F0KEV4cHJlc3Npb248U3RyaW5nPiB4LCBFeHBy\nZXNzaW9uPFN0cmluZz4geSkgewogICAgICAgICAgICBzdXBlcihTdHJpbmcu\nY2xhc3MsIHgsIHkpOwogICAgICAgIH0KICAgICAgICAKICAgICAgICBwdWJs\naWMgQ29uY2F0KEV4cHJlc3Npb248U3RyaW5nPiB4LCBTdHJpbmcgeSkgewog\nICAgICAgICAgICB0aGlzKHgsIG5ldyBDb25zdGFudDxTdHJpbmc+KHkpKTsK\nICAgICAgICB9CiAgICAgICAgCiAgICAgICAgcHVibGljIENvbmNhdChTdHJp\nbmcgeCwgRXhwcmVzc2lvbjxTdHJpbmc+IHkpIHsKICAgICAgICAgICAgdGhp\ncyhuZXcgQ29uc3RhbnQ8U3RyaW5nPih4KSwgeSk7CiAgICAgICAgfQogICAg\nICAgIAogICAgICAgIEBPdmVycmlkZQogICAgICAgIHB1YmxpYyBWYWx1ZSB0\nb1ZhbHVlKEV4cHJlc3Npb25GYWN0b3J5IGZhY3RvcnksIENyaXRlcmlhUXVl\ncnlJbXBsPD8+IHEpIHsKICAgICAgICAgICAgcmV0dXJuIGZhY3RvcnkuY29u\nY2F0KAogICAgICAgICAgICAgICAgRXhwcmVzc2lvbnMudG9WYWx1ZShlMSwg\nZmFjdG9yeSwgcSksIAogICAgICAgICAgICAgICAgRXhwcmVzc2lvbnMudG9W\nYWx1ZShlMiwgZmFjdG9yeSwgcSkpOwogICAgICAgIH0KICAgICAgICAKICAg\nICAgICBAT3ZlcnJpZGUKICAgICAgICBwdWJsaWMgU3RyaW5nQnVpbGRlciBh\nc1ZhbHVlKEFsaWFzQ29udGV4dCBxKSB7CiAgICAgICAgICAgIHJldHVybiBF\neHByZXNzaW9ucy5hc1ZhbHVlKHEsICJDT05DQVQiLCBPUEVOX0JSQUNFLCBl\nMSwgQ09NTUEsIGUyLCBDTE9TRV9CUkFDRSk7CiAgICAgICAgfQogICAgfQog\nICAgCiAgICBwdWJsaWMgc3RhdGljIGNsYXNzIFN1YnN0cmluZyBleHRlbmRz\nIFVuYXJ5RnVuY3Rpb25hbEV4cHJlc3Npb248U3RyaW5nPiB7CiAgICAgICAg\ncHJpdmF0ZSBFeHByZXNzaW9uSW1wbDxJbnRlZ2VyPiBmcm9tOwogICAgICAg\nIHByaXZhdGUgRXhwcmVzc2lvbkltcGw8SW50ZWdlcj4gbGVuOwogICAgICAg\nIAogICAgICAgIHB1YmxpYyBTdWJzdHJpbmcoRXhwcmVzc2lvbjxTdHJpbmc+\nIHMsIEV4cHJlc3Npb248SW50ZWdlcj4gZnJvbSwgRXhwcmVzc2lvbjxJbnRl\nZ2VyPiBsZW4pIHsKICAgICAgICAgICAgc3VwZXIoU3RyaW5nLmNsYXNzLCBz\nKTsKICAgICAgICAgICAgdGhpcy5mcm9tID0gKEV4cHJlc3Npb25JbXBsPElu\ndGVnZXI+KWZyb207CiAgICAgICAgICAgIHRoaXMubGVuICA9IChFeHByZXNz\naW9uSW1wbDxJbnRlZ2VyPilsZW47CiAgICAgICAgfQogICAgICAgIAogICAg\nICAgIHB1YmxpYyBTdWJzdHJpbmcoRXhwcmVzc2lvbjxTdHJpbmc+IHMsIEV4\ncHJlc3Npb248SW50ZWdlcj4gZnJvbSkgewogICAgICAgICAgICB0aGlzKHMs\nIChFeHByZXNzaW9uSW1wbDxJbnRlZ2VyPilmcm9tLCBudWxsKTsKICAgICAg\nICB9CgogICAgICAgIHB1YmxpYyBTdWJzdHJpbmcoRXhwcmVzc2lvbjxTdHJp\nbmc+IHMpIHsKICAgICAgICAgICAgdGhpcyhzLCAoRXhwcmVzc2lvbjxJbnRl\nZ2VyPiludWxsLCAoRXhwcmVzc2lvbjxJbnRlZ2VyPiludWxsKTsKICAgICAg\nICB9CiAgICAgICAgCiAgICAgICAgcHVibGljIFN1YnN0cmluZyhFeHByZXNz\naW9uPFN0cmluZz4gcywgSW50ZWdlciBmcm9tKSB7CiAgICAgICAgICAgIHRo\naXMocywgbmV3IENvbnN0YW50PEludGVnZXI+KGZyb20pLCBudWxsKTsKICAg\nICAgICB9CiAgICAgICAgCiAgICAgICAgcHVibGljIFN1YnN0cmluZyhFeHBy\nZXNzaW9uPFN0cmluZz4gcywgSW50ZWdlciBmcm9tLCBJbnRlZ2VyIGxlbikg\newogICAgICAgICAgICB0aGlzKHMsIG5ldyBDb25zdGFudDxJbnRlZ2VyPihm\ncm9tKSwgbmV3IENvbnN0YW50PEludGVnZXI+KGxlbikpOwogICAgICAgIH0K\nICAgICAgICAKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBwdWJsaWMgVmFs\ndWUgdG9WYWx1ZShFeHByZXNzaW9uRmFjdG9yeSBmYWN0b3J5LCBDcml0ZXJp\nYVF1ZXJ5SW1wbDw/PiBxKSB7CiAgICAgICAgICAgIHJldHVybiBKUFFMRXhw\ncmVzc2lvbkJ1aWxkZXIuY29udmVydFN1YnN0cmluZ0FyZ3VtZW50cyhmYWN0\nb3J5LCAKICAgICAgICAgICAgICAgIEV4cHJlc3Npb25zLnRvVmFsdWUoZSwg\nZmFjdG9yeSwgcSksIAogICAgICAgICAgICAgICAgZnJvbSA9PSBudWxsID8g\nbnVsbCA6IGZyb20udG9WYWx1ZShmYWN0b3J5LCBxKSwgCiAgICAgICAgICAg\nICAgICBsZW4gPT0gbnVsbCA/IG51bGwgOiBsZW4udG9WYWx1ZShmYWN0b3J5\nLCBxKSk7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIHB1YmxpYyB2b2lk\nIGFjY2VwdFZpc2l0KENyaXRlcmlhRXhwcmVzc2lvblZpc2l0b3IgdmlzaXRv\ncikgewogICAgICAgICAgICBzdXBlci5hY2NlcHRWaXNpdCh2aXNpdG9yKTsK\nICAgICAgICAgICAgRXhwcmVzc2lvbnMuYWNjZXB0VmlzaXQodmlzaXRvciwg\nZnJvbSwgbGVuKTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgQE92ZXJy\naWRlCiAgICAgICAgcHVibGljIFN0cmluZ0J1aWxkZXIgYXNWYWx1ZShBbGlh\nc0NvbnRleHQgcSkgewogICAgICAgICAgICByZXR1cm4gRXhwcmVzc2lvbnMu\nYXNWYWx1ZShxLCAiU1VCU1RSSU5HIiwgT1BFTl9CUkFDRSwgZSwgQ09NTUEs\nIGZyb20sIENPTU1BLCBsZW4sIENMT1NFX0JSQUNFKTsKICAgICAgICB9CiAg\nICB9CgogICAgcHVibGljIHN0YXRpYyBjbGFzcyBMb2NhdGUgZXh0ZW5kcyBF\neHByZXNzaW9uSW1wbDxJbnRlZ2VyPiB7CiAgICAgICAgcHJpdmF0ZSBFeHBy\nZXNzaW9uSW1wbDxTdHJpbmc+IHBhdHRlcm47CiAgICAgICAgcHJpdmF0ZSBF\neHByZXNzaW9uSW1wbDxJbnRlZ2VyPiBmcm9tOwogICAgICAgIHByaXZhdGUg\nRXhwcmVzc2lvbkltcGw8U3RyaW5nPiBwYXRoOwogICAgICAgIAogICAgICAg\nIHB1YmxpYyBMb2NhdGUoRXhwcmVzc2lvbjxTdHJpbmc+IHBhdGgsIEV4cHJl\nc3Npb248U3RyaW5nPiBwYXR0ZXJuLCBFeHByZXNzaW9uPEludGVnZXI+IGZy\nb20pIHsKICAgICAgICAgICAgc3VwZXIoSW50ZWdlci5jbGFzcyk7CiAgICAg\nICAgICAgIHRoaXMucGF0aCA9IChFeHByZXNzaW9uSW1wbDxTdHJpbmc+KXBh\ndGg7CiAgICAgICAgICAgIHRoaXMucGF0dGVybiA9IChFeHByZXNzaW9uSW1w\nbDxTdHJpbmc+KXBhdHRlcm47CiAgICAgICAgICAgIHRoaXMuZnJvbSA9IChF\neHByZXNzaW9uSW1wbDxJbnRlZ2VyPilmcm9tOwogICAgICAgIH0KCiAgICAg\nICAgcHVibGljIExvY2F0ZShFeHByZXNzaW9uPFN0cmluZz4gcGF0aCwgRXhw\ncmVzc2lvbjxTdHJpbmc+IHBhdHRlcm4pIHsKICAgICAgICAgICAgdGhpcyhw\nYXRoLCBwYXR0ZXJuLCBudWxsKTsKICAgICAgICAgfQogICAgICAgIAogICAg\nICAgIHB1YmxpYyBMb2NhdGUoRXhwcmVzc2lvbjxTdHJpbmc+IHBhdGgsIFN0\ncmluZyBwYXR0ZXJuKSB7CiAgICAgICAgICAgIHRoaXMocGF0aCwgbmV3IENv\nbnN0YW50PFN0cmluZz4ocGF0dGVybiksIG51bGwpOwogICAgICAgIH0KICAg\nICAgICAKICAgICAgICBwdWJsaWMgTG9jYXRlKFN0cmluZyBwYXRoLCBFeHBy\nZXNzaW9uPFN0cmluZz4gcGF0dGVybikgewogICAgICAgICAgICB0aGlzKG5l\ndyBDb25zdGFudDxTdHJpbmc+KHBhdGgpLCBwYXR0ZXJuLCBudWxsKTsKICAg\nICAgICB9CiAgICAgICAgCiAgICAgICAgcHVibGljIExvY2F0ZShFeHByZXNz\naW9uPFN0cmluZz4gcGF0aCwgU3RyaW5nIHBhdHRlcm4sIGludCBmcm9tKSB7\nCiAgICAgICAgICAgIHRoaXMocGF0aCwgbmV3IENvbnN0YW50PFN0cmluZz4o\ncGF0dGVybiksIG5ldyBDb25zdGFudDxJbnRlZ2VyPihmcm9tKSk7CiAgICAg\nICAgfQoKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBwdWJsaWMgVmFsdWUg\ndG9WYWx1ZShFeHByZXNzaW9uRmFjdG9yeSBmYWN0b3J5LCBDcml0ZXJpYVF1\nZXJ5SW1wbDw/PiBxKSB7CiAgICAgICAgICAgIFZhbHVlIGxvY2F0ZVNlYXJj\naCA9IHBhdGgudG9WYWx1ZShmYWN0b3J5LCBxKTsKICAgICAgICAgICAgVmFs\ndWUgbG9jYXRlRnJvbUluZGV4ID0gKGZyb20gPT0gbnVsbCA/IG51bGwgOiBF\neHByZXNzaW9ucy50b1ZhbHVlKGZyb20sIGZhY3RvcnksIHEpKTsKICAgICAg\nICAgICAgVmFsdWUgbG9jYXRlUGF0aCA9IEV4cHJlc3Npb25zLnRvVmFsdWUo\ncGF0dGVybiwgZmFjdG9yeSwgcSk7CiAgICAgICAgICAgIAogICAgICAgICAg\nICByZXR1cm4gZmFjdG9yeS5hZGQoZmFjdG9yeS5pbmRleE9mKGxvY2F0ZVNl\nYXJjaCwKICAgICAgICAgICAgICAgICAgICBsb2NhdGVGcm9tSW5kZXggPT0g\nbnVsbCA/IGxvY2F0ZVBhdGgKICAgICAgICAgICAgICAgICAgICAgICAgOiBm\nYWN0b3J5Lm5ld0FyZ3VtZW50TGlzdChsb2NhdGVQYXRoLAogICAgICAgICAg\nICAgICAgICAgICAgICAgICAgZmFjdG9yeS5zdWJ0cmFjdChsb2NhdGVGcm9t\nSW5kZXgsIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICBmYWN0b3J5Lm5ld0xpdGVyYWwoSW50ZWdlci52YWx1ZU9mKDEp\nLCBMaXRlcmFsLlRZUEVfTlVNQkVSKSkpKSwKICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgZmFjdG9yeS5uZXdMaXRlcmFs\nKEludGVnZXIudmFsdWVPZigxKSwgTGl0ZXJhbC5UWVBFX05VTUJFUikpOwog\nICAgICAgIH0KICAgICAgICAKICAgICAgICBwdWJsaWMgdm9pZCBhY2NlcHRW\naXNpdChDcml0ZXJpYUV4cHJlc3Npb25WaXNpdG9yIHZpc2l0b3IpIHsKICAg\nICAgICAgICAgRXhwcmVzc2lvbnMuYWNjZXB0VmlzaXQodmlzaXRvciwgdGhp\ncywgcGF0dGVybiwgZnJvbSwgcGF0aCk7CiAgICAgICAgfQogICAgICAgIAog\nICAgICAgIEBPdmVycmlkZQogICAgICAgIHB1YmxpYyBTdHJpbmdCdWlsZGVy\nIGFzVmFsdWUoQWxpYXNDb250ZXh0IHEpIHsKICAgICAgICAgICAgcmV0dXJu\nIEV4cHJlc3Npb25zLmFzVmFsdWUocSwgIkxPQ0FURSIsIE9QRU5fQlJBQ0Us\nIHBhdHRlcm4sIENPTU1BLCBwYXRoLCBDTE9TRV9CUkFDRSk7CiAgICAgICAg\nfQogICAgfQogICAgCiAgICBwdWJsaWMgc3RhdGljIGNsYXNzIFRyaW0gZXh0\nZW5kcyBCaW5hcmF5RnVuY3Rpb25hbEV4cHJlc3Npb248U3RyaW5nPiB7CiAg\nICAgICAgc3RhdGljIEV4cHJlc3Npb248Q2hhcmFjdGVyPiBkZWZhdWx0VHJp\nbSA9IG5ldyBDb25zdGFudDxDaGFyYWN0ZXI+KENoYXJhY3Rlci5jbGFzcywg\nbmV3IENoYXJhY3RlcignICcpKTsKICAgICAgICBzdGF0aWMgVHJpbXNwZWMg\nZGVmYXVsdFNwZWMgPSBUcmltc3BlYy5CT1RIOwogICAgICAgIHByaXZhdGUg\nVHJpbXNwZWMgdHM7CiAgICAgICAgCiAgICAgICAgcHVibGljIFRyaW0oRXhw\ncmVzc2lvbjxTdHJpbmc+IHgsIEV4cHJlc3Npb248Q2hhcmFjdGVyPiB5LCBU\ncmltc3BlYyB0cykgewogICAgICAgICAgICBzdXBlcihTdHJpbmcuY2xhc3Ms\nIHgsIHkpOwogICAgICAgICAgICB0aGlzLnRzID0gdHM7CiAgICAgICAgfQog\nICAgICAgIAogICAgICAgIHB1YmxpYyBUcmltKEV4cHJlc3Npb248U3RyaW5n\nPiB4LCBFeHByZXNzaW9uPENoYXJhY3Rlcj4geSkgewogICAgICAgICAgICB0\naGlzKHgsIHksIGRlZmF1bHRTcGVjKTsKICAgICAgICB9CiAgICAgICAgCiAg\nICAgICAgcHVibGljIFRyaW0oRXhwcmVzc2lvbjxTdHJpbmc+IHgpIHsKICAg\nICAgICAgICAgdGhpcyh4LCBkZWZhdWx0VHJpbSwgZGVmYXVsdFNwZWMpOwog\nICAgICAgIH0KICAgICAgICAKICAgICAgICBwdWJsaWMgVHJpbShFeHByZXNz\naW9uPFN0cmluZz4geCwgQ2hhcmFjdGVyIHQpIHsKICAgICAgICAgICAgdGhp\ncyh4LCBuZXcgQ29uc3RhbnQ8Q2hhcmFjdGVyPihDaGFyYWN0ZXIuY2xhc3Ms\nIHQpLCBkZWZhdWx0U3BlYyk7CiAgICAgICAgfQogICAgICAgIAogICAgICAg\nIHB1YmxpYyBUcmltKEV4cHJlc3Npb248U3RyaW5nPiB4LCBDaGFyYWN0ZXIg\ndCwgVHJpbXNwZWMgdHMpIHsKICAgICAgICAgICAgdGhpcyh4LCBuZXcgQ29u\nc3RhbnQ8Q2hhcmFjdGVyPihDaGFyYWN0ZXIuY2xhc3MsIHQpLCB0cyk7CiAg\nICAgICAgfQogICAgICAgIAogICAgICAgIHB1YmxpYyBUcmltKEV4cHJlc3Np\nb248U3RyaW5nPiB4LCBUcmltc3BlYyB0cykgewogICAgICAgICAgICB0aGlz\nKHgsIGRlZmF1bHRUcmltLCB0cyk7CiAgICAgICAgfQoKICAgICAgICBAT3Zl\ncnJpZGUKICAgICAgICBwdWJsaWMgVmFsdWUgdG9WYWx1ZShFeHByZXNzaW9u\nRmFjdG9yeSBmYWN0b3J5LCBDcml0ZXJpYVF1ZXJ5SW1wbDw/PiBxKSB7CiAg\nICAgICAgICAgIEJvb2xlYW4gc3BlYyA9IG51bGw7CiAgICAgICAgICAgIGlm\nICh0cyAhPSBudWxsKSB7CiAgICAgICAgICAgICAgICBzd2l0Y2ggKHRzKSB7\nCiAgICAgICAgICAgICAgICBjYXNlIExFQURJTkcgIDogc3BlYyA9IHRydWU7\nICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgVFJBSUxJTkcgOiBzcGVj\nID0gZmFsc2U7IGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSBCT1RIICAg\nICA6IHNwZWMgPSBudWxsOyAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CiAg\nICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIGZhY3RvcnkudHJpbSgK\nICAgICAgICAgICAgICAgIEV4cHJlc3Npb25zLnRvVmFsdWUoZTEsIGZhY3Rv\ncnksIHEpLCAKICAgICAgICAgICAgICAgIEV4cHJlc3Npb25zLnRvVmFsdWUo\nZTIsIGZhY3RvcnksIHEpLCBzcGVjKTsKICAgICAgICB9CiAgICAgICAgCiAg\nICAgICAgQE92ZXJyaWRlCiAgICAgICAgcHVibGljIFN0cmluZ0J1aWxkZXIg\nYXNWYWx1ZShBbGlhc0NvbnRleHQgcSkgewogICAgICAgICAgICByZXR1cm4g\nRXhwcmVzc2lvbnMuYXNWYWx1ZShxLCAiVFJJTSIsIE9QRU5fQlJBQ0UsIGUx\nLCBDT01NQSwgZTIsIENMT1NFX0JSQUNFKTsKICAgICAgICB9ICAgICAgICAK\nICAgIH0KICAgIAogICAgcHVibGljIHN0YXRpYyBjbGFzcyBTdW08TiBleHRl\nbmRzIE51bWJlcj4gZXh0ZW5kcyBCaW5hcmF5RnVuY3Rpb25hbEV4cHJlc3Np\nb248Tj4gewogICAgICAgIHB1YmxpYyBTdW0oRXhwcmVzc2lvbjw/IGV4dGVu\nZHMgTnVtYmVyPiB4LCBFeHByZXNzaW9uPD8gZXh0ZW5kcyBOdW1iZXI+IHkp\nIHsKICAgICAgICAgICAgc3VwZXIoKENsYXNzPE4+KXguZ2V0SmF2YVR5cGUo\nKSwgeCwgeSk7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIHB1YmxpYyBT\ndW0oRXhwcmVzc2lvbjw/IGV4dGVuZHMgTnVtYmVyPiB4KSB7CiAgICAgICAg\nICAgIHRoaXMoeCwgKEV4cHJlc3Npb248PyBleHRlbmRzIE51bWJlcj4pbnVs\nbCk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgU3VtKEV4cHJlc3Npb248\nPyBleHRlbmRzIE51bWJlcj4geCwgTnVtYmVyIHkpIHsKICAgICAgICAgICAg\ndGhpcyh4LCBuZXcgQ29uc3RhbnQ8TnVtYmVyPihOdW1iZXIuY2xhc3MsIHkp\nKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBTdW0oTnVtYmVyIHgsIEV4\ncHJlc3Npb248PyBleHRlbmRzIE51bWJlcj4geSkgewogICAgICAgICAgICB0\naGlzKG5ldyBDb25zdGFudDxOdW1iZXI+KE51bWJlci5jbGFzcywgeCksIHkp\nOwogICAgICAgIH0KICAgICAgICAKICAgICAgICBAT3ZlcnJpZGUKICAgICAg\nICBwdWJsaWMgVmFsdWUgdG9WYWx1ZShFeHByZXNzaW9uRmFjdG9yeSBmYWN0\nb3J5LCBDcml0ZXJpYVF1ZXJ5SW1wbDw/PiBxKSB7CiAgICAgICAgICAgIFZh\nbHVlIHZhbHVlPSAoZTIgPT0gbnVsbCkgCiAgICAgICAgICAgID8gICBmYWN0\nb3J5LnN1bShFeHByZXNzaW9ucy50b1ZhbHVlKGUxLCBmYWN0b3J5LCBxKSkK\nICAgICAgICAgICAgOiAgIGZhY3RvcnkuYWRkKAogICAgICAgICAgICAgICAg\nICAgRXhwcmVzc2lvbnMudG9WYWx1ZShlMSwgZmFjdG9yeSwgcSksIAogICAg\nICAgICAgICAgICAgICAgRXhwcmVzc2lvbnMudG9WYWx1ZShlMiwgZmFjdG9y\neSwgcSkpOwogICAgICAgICAgICB2YWx1ZS5zZXRJbXBsaWNpdFR5cGUoZ2V0\nSmF2YVR5cGUoKSk7CiAgICAgICAgICAgIHJldHVybiB2YWx1ZTsKICAgICAg\nICB9CiAgICAgICAgCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgcHVibGlj\nIFN0cmluZ0J1aWxkZXIgYXNWYWx1ZShBbGlhc0NvbnRleHQgcSkgewogICAg\nICAgICAgICByZXR1cm4gZTIgPT0gbnVsbCAKICAgICAgICAgICAgICAgPyBF\neHByZXNzaW9ucy5hc1ZhbHVlKHEsICJTVU0iLCBPUEVOX0JSQUNFLCBlMSwg\nQ0xPU0VfQlJBQ0UpCiAgICAgICAgICAgICAgIDogRXhwcmVzc2lvbnMuYXNW\nYWx1ZShxLCBlMSwgIiArICIsIGUyKTsKICAgICAgICB9ICAgICAgICAKICAg\nICB9CiAgICAKICAgIHB1YmxpYyBzdGF0aWMgY2xhc3MgUHJvZHVjdDxOIGV4\ndGVuZHMgTnVtYmVyPiBleHRlbmRzIEJpbmFyYXlGdW5jdGlvbmFsRXhwcmVz\nc2lvbjxOPiB7CiAgICAgICAgcHVibGljIFByb2R1Y3QoRXhwcmVzc2lvbjw/\nIGV4dGVuZHMgTnVtYmVyPiB4LCBFeHByZXNzaW9uPD8gZXh0ZW5kcyBOdW1i\nZXI+IHkpIHsKICAgICAgICAgICAgc3VwZXIoKENsYXNzPE4+KXguZ2V0SmF2\nYVR5cGUoKSwgeCwgeSk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgUHJv\nZHVjdChFeHByZXNzaW9uPD8gZXh0ZW5kcyBOdW1iZXI+IHgsIE51bWJlciB5\nKSB7CiAgICAgICAgICAgIHRoaXMoeCwgbmV3IENvbnN0YW50PE51bWJlcj4o\nTnVtYmVyLmNsYXNzLCB5KSk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMg\nUHJvZHVjdChOdW1iZXIgeCwgRXhwcmVzc2lvbjw/IGV4dGVuZHMgTnVtYmVy\nPiB5KSB7CiAgICAgICAgICAgIHRoaXMobmV3IENvbnN0YW50PE51bWJlcj4o\nTnVtYmVyLmNsYXNzLCB4KSwgeSk7CiAgICAgICAgfQogICAgICAgIAogICAg\nICAgIEBPdmVycmlkZQogICAgICAgIHB1YmxpYyBWYWx1ZSB0b1ZhbHVlKEV4\ncHJlc3Npb25GYWN0b3J5IGZhY3RvcnksIENyaXRlcmlhUXVlcnlJbXBsPD8+\nIHEpIHsKICAgICAgICAgICAgcmV0dXJuIGZhY3RvcnkubXVsdGlwbHkoCiAg\nICAgICAgICAgICAgICBFeHByZXNzaW9ucy50b1ZhbHVlKGUxLCBmYWN0b3J5\nLCBxKSwgCiAgICAgICAgICAgICAgICBFeHByZXNzaW9ucy50b1ZhbHVlKGUy\nLCBmYWN0b3J5LCBxKSk7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIEBP\ndmVycmlkZQogICAgICAgIHB1YmxpYyBTdHJpbmdCdWlsZGVyIGFzVmFsdWUo\nQWxpYXNDb250ZXh0IHEpIHsKICAgICAgICAgICAgcmV0dXJuIEV4cHJlc3Np\nb25zLmFzVmFsdWUocSwgZTEsICIgKiAiICxlMik7CiAgICAgICAgfSAgICAg\nICAgCiAgICB9CiAgICAKICAgIHB1YmxpYyBzdGF0aWMgY2xhc3MgRGlmZjxO\nIGV4dGVuZHMgTnVtYmVyPiBleHRlbmRzIEJpbmFyYXlGdW5jdGlvbmFsRXhw\ncmVzc2lvbjxOPiB7CiAgICAgICAgcHVibGljIERpZmYoRXhwcmVzc2lvbjw/\nIGV4dGVuZHMgTnVtYmVyPiB4LCBFeHByZXNzaW9uPD8gZXh0ZW5kcyBOdW1i\nZXI+IHkpIHsKICAgICAgICAgICAgc3VwZXIoKENsYXNzPE4+KXguZ2V0SmF2\nYVR5cGUoKSwgeCwgeSk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgRGlm\nZihFeHByZXNzaW9uPD8gZXh0ZW5kcyBOdW1iZXI+IHgsIE51bWJlciB5KSB7\nCiAgICAgICAgICAgIHRoaXMoeCwgbmV3IENvbnN0YW50PE51bWJlcj4oTnVt\nYmVyLmNsYXNzLCB5KSk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgRGlm\nZihOdW1iZXIgeCwgRXhwcmVzc2lvbjw/IGV4dGVuZHMgTnVtYmVyPiB5KSB7\nCiAgICAgICAgICAgIHRoaXMobmV3IENvbnN0YW50PE51bWJlcj4oTnVtYmVy\nLmNsYXNzLCB4KSwgeSk7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIEBP\ndmVycmlkZQogICAgICAgIHB1YmxpYyBWYWx1ZSB0b1ZhbHVlKEV4cHJlc3Np\nb25GYWN0b3J5IGZhY3RvcnksIENyaXRlcmlhUXVlcnlJbXBsPD8+IHEpIHsK\nICAgICAgICAgICAgVmFsdWUgdmFsdWUgPSBmYWN0b3J5LnN1YnRyYWN0KAog\nICAgICAgICAgICAgICAgRXhwcmVzc2lvbnMudG9WYWx1ZShlMSwgZmFjdG9y\neSwgcSksIAogICAgICAgICAgICAgICAgRXhwcmVzc2lvbnMudG9WYWx1ZShl\nMiwgZmFjdG9yeSwgcSkpOwogICAgICAgICAgICB2YWx1ZS5zZXRJbXBsaWNp\ndFR5cGUoZ2V0SmF2YVR5cGUoKSk7CiAgICAgICAgICAgIHJldHVybiB2YWx1\nZTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgQE92ZXJyaWRlCiAgICAg\nICAgcHVibGljIFN0cmluZ0J1aWxkZXIgYXNWYWx1ZShBbGlhc0NvbnRleHQg\ncSkgewogICAgICAgICAgICByZXR1cm4gRXhwcmVzc2lvbnMuYXNWYWx1ZShx\nLCBlMSwgIiAtICIgLGUyKTsKICAgICAgICB9ICAgICAgICAKICAgIH0KCiAg\nICAKICAgIHB1YmxpYyBzdGF0aWMgY2xhc3MgUXVvdGllbnQ8TiBleHRlbmRz\nIE51bWJlcj4gZXh0ZW5kcyBCaW5hcmF5RnVuY3Rpb25hbEV4cHJlc3Npb248\nTj4gewogICAgICAgIHB1YmxpYyBRdW90aWVudChFeHByZXNzaW9uPD8gZXh0\nZW5kcyBOdW1iZXI+IHgsIEV4cHJlc3Npb248PyBleHRlbmRzIE51bWJlcj4g\neSkgewogICAgICAgICAgICBzdXBlcigoQ2xhc3M8Tj4peC5nZXRKYXZhVHlw\nZSgpLCB4LCB5KTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBRdW90aWVu\ndChFeHByZXNzaW9uPD8gZXh0ZW5kcyBOdW1iZXI+IHgsIE51bWJlciB5KSB7\nCiAgICAgICAgICAgIHRoaXMoeCwgbmV3IENvbnN0YW50PE51bWJlcj4oeSkp\nOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIFF1b3RpZW50KE51bWJlciB4\nLCBFeHByZXNzaW9uPD8gZXh0ZW5kcyBOdW1iZXI+IHkpIHsKICAgICAgICAg\nICAgdGhpcyhuZXcgQ29uc3RhbnQ8TnVtYmVyPih4KSwgeSk7CiAgICAgICAg\nfQogICAgICAgIAogICAgICAgIEBPdmVycmlkZQogICAgICAgIHB1YmxpYyBW\nYWx1ZSB0b1ZhbHVlKEV4cHJlc3Npb25GYWN0b3J5IGZhY3RvcnksIENyaXRl\ncmlhUXVlcnlJbXBsPD8+IHEpIHsKICAgICAgICAgICAgVmFsdWUgdmFsdWUg\nPSBmYWN0b3J5LmRpdmlkZSgKICAgICAgICAgICAgICAgIEV4cHJlc3Npb25z\nLnRvVmFsdWUoZTEsIGZhY3RvcnksIHEpLCAKICAgICAgICAgICAgICAgIEV4\ncHJlc3Npb25zLnRvVmFsdWUoZTIsIGZhY3RvcnksIHEpKTsKICAgICAgICAg\nICAgdmFsdWUuc2V0SW1wbGljaXRUeXBlKGdldEphdmFUeXBlKCkpOwogICAg\nICAgICAgICByZXR1cm4gdmFsdWU7CiAgICAgICAgfQogICAgICAgIAogICAg\nICAgIEBPdmVycmlkZQogICAgICAgIHB1YmxpYyBTdHJpbmdCdWlsZGVyIGFz\nVmFsdWUoQWxpYXNDb250ZXh0IHEpIHsKICAgICAgICAgICAgcmV0dXJuIEV4\ncHJlc3Npb25zLmFzVmFsdWUocSwgZTEsICIlIiAsZTIpOwogICAgICAgIH0g\nICAgICAgIAogICAgfQoKICAgIHB1YmxpYyBzdGF0aWMgY2xhc3MgTW9kIGV4\ndGVuZHMgQmluYXJheUZ1bmN0aW9uYWxFeHByZXNzaW9uPEludGVnZXI+IHsK\nICAgICAgICBwdWJsaWMgIE1vZChFeHByZXNzaW9uPEludGVnZXI+IHgsIEV4\ncHJlc3Npb248SW50ZWdlcj4geSkgewogICAgICAgICAgICBzdXBlcihJbnRl\nZ2VyLmNsYXNzLCB4LHkpOwogICAgICAgIH0KICAgICAgICBwdWJsaWMgIE1v\nZChFeHByZXNzaW9uPEludGVnZXI+IHgsIEludGVnZXIgeSkgewogICAgICAg\nICAgICB0aGlzKHgsbmV3IENvbnN0YW50PEludGVnZXI+KEludGVnZXIuY2xh\nc3MsIHkpKTsKICAgICAgICB9CiAgICAgICAgcHVibGljICBNb2QoSW50ZWdl\nciB4LCBFeHByZXNzaW9uPEludGVnZXI+IHkpIHsKICAgICAgICAgICAgdGhp\ncyhuZXcgQ29uc3RhbnQ8SW50ZWdlcj4oSW50ZWdlci5jbGFzcywgeCkseSk7\nCiAgICAgICAgfQoKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBwdWJsaWMg\nVmFsdWUgdG9WYWx1ZShFeHByZXNzaW9uRmFjdG9yeSBmYWN0b3J5LCBDcml0\nZXJpYVF1ZXJ5SW1wbDw/PiBxKSB7CiAgICAgICAgICAgIFZhbHVlIHZhbHVl\nID0gZmFjdG9yeS5tb2QoCiAgICAgICAgICAgICAgICBFeHByZXNzaW9ucy50\nb1ZhbHVlKGUxLCBmYWN0b3J5LCBxKSwgCiAgICAgICAgICAgICAgICBFeHBy\nZXNzaW9ucy50b1ZhbHVlKGUyLCBmYWN0b3J5LCBxKSk7CiAgICAgICAgICAg\nIHZhbHVlLnNldEltcGxpY2l0VHlwZShnZXRKYXZhVHlwZSgpKTsKICAgICAg\nICAgICAgcmV0dXJuIHZhbHVlOwogICAgICAgIH0KICAgICAgICAKICAgICAg\nICBAT3ZlcnJpZGUKICAgICAgICBwdWJsaWMgU3RyaW5nQnVpbGRlciBhc1Zh\nbHVlKEFsaWFzQ29udGV4dCBxKSB7CiAgICAgICAgICAgIHJldHVybiBFeHBy\nZXNzaW9ucy5hc1ZhbHVlKHEsICJNT0QiLCBPUEVOX0JSQUNFLCBlMSwgQ09N\nTUEsIGUyLCBDTE9TRV9CUkFDRSk7CiAgICAgICAgfSAgICAgICAgCiAgICB9\nCgogICAgcHVibGljIHN0YXRpYyBjbGFzcyBDdXJyZW50RGF0ZSBleHRlbmRz\nIEV4cHJlc3Npb25JbXBsPGphdmEuc3FsLkRhdGU+IHsKICAgICAgICBwdWJs\naWMgIEN1cnJlbnREYXRlKCkgewogICAgICAgICAgICBzdXBlcihqYXZhLnNx\nbC5EYXRlLmNsYXNzKTsKICAgICAgICB9CgogICAgICAgIEBPdmVycmlkZQog\nICAgICAgIHB1YmxpYyBWYWx1ZSB0b1ZhbHVlKEV4cHJlc3Npb25GYWN0b3J5\nIGZhY3RvcnksIENyaXRlcmlhUXVlcnlJbXBsPD8+IHEpIHsKICAgICAgICAg\nICAgcmV0dXJuIGZhY3RvcnkuZ2V0Q3VycmVudERhdGUoZ2V0SmF2YVR5cGUo\nKSk7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIEBPdmVycmlkZQogICAg\nICAgIHB1YmxpYyBTdHJpbmdCdWlsZGVyIGFzVmFsdWUoQWxpYXNDb250ZXh0\nIHEpIHsKICAgICAgICAgICAgcmV0dXJuIG5ldyBTdHJpbmdCdWlsZGVyKCJD\nVVJSRU5UX0RBVEUiKTsKICAgICAgICB9CiAgICB9CiAgICAKICAgIHB1Ymxp\nYyBzdGF0aWMgY2xhc3MgQ3VycmVudFRpbWUgZXh0ZW5kcyBFeHByZXNzaW9u\nSW1wbDxqYXZhLnNxbC5UaW1lPiB7CiAgICAgICAgcHVibGljICBDdXJyZW50\nVGltZSgpIHsKICAgICAgICAgICAgc3VwZXIoamF2YS5zcWwuVGltZS5jbGFz\ncyk7CiAgICAgICAgfQoKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBwdWJs\naWMgVmFsdWUgdG9WYWx1ZShFeHByZXNzaW9uRmFjdG9yeSBmYWN0b3J5LCBD\ncml0ZXJpYVF1ZXJ5SW1wbDw/PiBxKSB7CiAgICAgICAgICAgIHJldHVybiBm\nYWN0b3J5LmdldEN1cnJlbnRUaW1lKGdldEphdmFUeXBlKCkpOwogICAgICAg\nIH0KICAgICAgICAKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBwdWJsaWMg\nU3RyaW5nQnVpbGRlciBhc1ZhbHVlKEFsaWFzQ29udGV4dCBxKSB7CiAgICAg\nICAgICAgIHJldHVybiBuZXcgU3RyaW5nQnVpbGRlcigiQ1VSUkVOVF9USU1F\nIik7CiAgICAgICAgfQogICAgfQogICAgCiAgICBwdWJsaWMgc3RhdGljIGNs\nYXNzIEN1cnJlbnRUaW1lc3RhbXAgZXh0ZW5kcyBFeHByZXNzaW9uSW1wbDxq\nYXZhLnNxbC5UaW1lc3RhbXA+IHsKICAgICAgICBwdWJsaWMgIEN1cnJlbnRU\naW1lc3RhbXAoKSB7CiAgICAgICAgICAgIHN1cGVyKGphdmEuc3FsLlRpbWVz\ndGFtcC5jbGFzcyk7CiAgICAgICAgfQoKICAgICAgICBAT3ZlcnJpZGUKICAg\nICAgICBwdWJsaWMgVmFsdWUgdG9WYWx1ZShFeHByZXNzaW9uRmFjdG9yeSBm\nYWN0b3J5LCBDcml0ZXJpYVF1ZXJ5SW1wbDw/PiBxKSB7CiAgICAgICAgICAg\nIHJldHVybiBmYWN0b3J5LmdldEN1cnJlbnRUaW1lc3RhbXAoZ2V0SmF2YVR5\ncGUoKSk7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIEBPdmVycmlkZQog\nICAgICAgIHB1YmxpYyBTdHJpbmdCdWlsZGVyIGFzVmFsdWUoQWxpYXNDb250\nZXh0IHEpIHsKICAgICAgICAgICAgcmV0dXJuIG5ldyBTdHJpbmdCdWlsZGVy\nKCJDVVJSRU5UX1RJTUVTVEFNUCIpOwogICAgICAgIH0KICAgIH0KCiAgICBw\ndWJsaWMgc3RhdGljIGNsYXNzIEVxdWFsIGV4dGVuZHMgQmluYXJ5TG9naWNh\nbEV4cHJlc3Npb24gewogICAgICAgIHB1YmxpYyA8WCxZPiBFcXVhbChFeHBy\nZXNzaW9uPFg+IHgsIEV4cHJlc3Npb248WT4geSkgewogICAgICAgICAgICBz\ndXBlcih4LHkpOwogICAgICAgIH0KICAgICAgICAKICAgICAgICBwdWJsaWMg\nPFg+IEVxdWFsKEV4cHJlc3Npb248WD4geCwgT2JqZWN0IHkpIHsKICAgICAg\nICAgICAgdGhpcyh4LCBuZXcgQ29uc3RhbnQoeSkpOwogICAgICAgIH0KCiAg\nICAgICAgQE92ZXJyaWRlCiAgICAgICAgcHVibGljIFByZWRpY2F0ZUltcGwg\nbm90KCkgewogICAgICAgICAgICByZXR1cm4gbmV3IE5vdEVxdWFsKGUxLCBl\nMikubWFya05lZ2F0ZWQoKTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAg\nQE92ZXJyaWRlCiAgICAgICAgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5l\neHBzLkV4cHJlc3Npb24gdG9LZXJuZWxFeHByZXNzaW9uKEV4cHJlc3Npb25G\nYWN0b3J5IGZhY3RvcnksIENyaXRlcmlhUXVlcnlJbXBsPD8+IHEpewogICAg\nICAgICAgICBWYWx1ZSB2YWwxID0gRXhwcmVzc2lvbnMudG9WYWx1ZShlMSwg\nZmFjdG9yeSwgcSk7CiAgICAgICAgICAgIFZhbHVlIHZhbDIgPSBFeHByZXNz\naW9ucy50b1ZhbHVlKGUyLCBmYWN0b3J5LCBxKTsKICAgICAgICAgICAgRXhw\ncmVzc2lvbnMuc2V0SW1wbGljaXRUeXBlcyh2YWwxLCB2YWwyLCBlMS5nZXRK\nYXZhVHlwZSgpLCBxKTsKICAgICAgICAgICAgcmV0dXJuIGZhY3RvcnkuZXF1\nYWwodmFsMSwgdmFsMik7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIEBP\ndmVycmlkZQogICAgICAgIHB1YmxpYyBTdHJpbmdCdWlsZGVyIGFzVmFsdWUo\nQWxpYXNDb250ZXh0IHEpIHsKICAgICAgICAgICAgcmV0dXJuIEV4cHJlc3Np\nb25zLmFzVmFsdWUocSwgZTEsICIgPSAiLCBlMik7CiAgICAgICAgfSAgICAg\nICAgCiAgICB9CiAgICAKICAgIHB1YmxpYyBzdGF0aWMgY2xhc3MgTm90RXF1\nYWwgZXh0ZW5kcyBCaW5hcnlMb2dpY2FsRXhwcmVzc2lvbiB7CiAgICAgICAg\ncHVibGljIDxYLFk+IE5vdEVxdWFsKEV4cHJlc3Npb248WD4geCwgRXhwcmVz\nc2lvbjxZPiB5KSB7CiAgICAgICAgICAgIHN1cGVyKHgseSk7CiAgICAgICAg\nfQogICAgICAgIAogICAgICAgIHB1YmxpYyA8WD4gTm90RXF1YWwoRXhwcmVz\nc2lvbjxYPiB4LCBPYmplY3QgeSkgewogICAgICAgICAgICB0aGlzKHgsIG5l\ndyBDb25zdGFudCh5KSk7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIEBP\ndmVycmlkZQogICAgICAgIHB1YmxpYyBQcmVkaWNhdGVJbXBsIG5vdCgpIHsK\nICAgICAgICAgICAgcmV0dXJuIG5ldyBFcXVhbChlMSwgZTIpLm1hcmtOZWdh\ndGVkKCk7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIEBPdmVycmlkZQog\nICAgICAgIG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuZXhwcy5FeHByZXNz\naW9uIHRvS2VybmVsRXhwcmVzc2lvbihFeHByZXNzaW9uRmFjdG9yeSBmYWN0\nb3J5LCBDcml0ZXJpYVF1ZXJ5SW1wbDw/PiBxKXsKICAgICAgICAgICAgVmFs\ndWUgdmFsMSA9IEV4cHJlc3Npb25zLnRvVmFsdWUoZTEsIGZhY3RvcnksIHEp\nOwogICAgICAgICAgICBWYWx1ZSB2YWwyID0gRXhwcmVzc2lvbnMudG9WYWx1\nZShlMiwgZmFjdG9yeSwgcSk7CiAgICAgICAgICAgIEV4cHJlc3Npb25zLnNl\ndEltcGxpY2l0VHlwZXModmFsMSwgdmFsMiwgZTEuZ2V0SmF2YVR5cGUoKSwg\ncSk7CiAgICAgICAgICAgIHJldHVybiBmYWN0b3J5Lm5vdEVxdWFsKHZhbDEs\nIHZhbDIpOwogICAgICAgIH0KICAgICAgICAKICAgICAgICBAT3ZlcnJpZGUK\nICAgICAgICBwdWJsaWMgU3RyaW5nQnVpbGRlciBhc1ZhbHVlKEFsaWFzQ29u\ndGV4dCBxKSB7CiAgICAgICAgICAgIHJldHVybiBFeHByZXNzaW9ucy5hc1Zh\nbHVlKHEsIGUxLCAiIDw+ICIsIGUyKTsKICAgICAgICB9ICAgICAgICAKICAg\nIH0KICAgIAogICAgcHVibGljIHN0YXRpYyBjbGFzcyBHcmVhdGVyVGhhbiBl\neHRlbmRzIEJpbmFyeUxvZ2ljYWxFeHByZXNzaW9uIHsKICAgICAgICBwdWJs\naWMgPFgsWT4gR3JlYXRlclRoYW4oRXhwcmVzc2lvbjxYPiB4LCBFeHByZXNz\naW9uPFk+IHkpIHsKICAgICAgICAgICAgc3VwZXIoeCx5KTsKICAgICAgICB9\nCiAgICAgICAgCiAgICAgICAgcHVibGljIDxYPiBHcmVhdGVyVGhhbihFeHBy\nZXNzaW9uPFg+IHgsIE9iamVjdCB5KSB7CiAgICAgICAgICAgIHRoaXMoeCwg\nbmV3IENvbnN0YW50KHkpKTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAg\nQE92ZXJyaWRlCiAgICAgICAgcHVibGljIFByZWRpY2F0ZUltcGwgbm90KCkg\newogICAgICAgICAgICByZXR1cm4gbmV3IExlc3NUaGFuRXF1YWwoZTEsIGUy\nKS5tYXJrTmVnYXRlZCgpOwogICAgICAgIH0KICAgICAgICAKICAgICAgICBA\nT3ZlcnJpZGUKICAgICAgICBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLmV4\ncHMuRXhwcmVzc2lvbiB0b0tlcm5lbEV4cHJlc3Npb24oRXhwcmVzc2lvbkZh\nY3RvcnkgZmFjdG9yeSwgQ3JpdGVyaWFRdWVyeUltcGw8Pz4gcSl7CiAgICAg\nICAgICAgIFZhbHVlIHZhbDEgPSBFeHByZXNzaW9ucy50b1ZhbHVlKGUxLCBm\nYWN0b3J5LCBxKTsKICAgICAgICAgICAgVmFsdWUgdmFsMiA9IEV4cHJlc3Np\nb25zLnRvVmFsdWUoZTIsIGZhY3RvcnksIHEpOyAKICAgICAgICAgICAgRXhw\ncmVzc2lvbnMuc2V0SW1wbGljaXRUeXBlcyh2YWwxLCB2YWwyLCBlMS5nZXRK\nYXZhVHlwZSgpLCBxKTsgCiAgICAgICAgICAgIHJldHVybiBmYWN0b3J5Lmdy\nZWF0ZXJUaGFuKHZhbDEsIHZhbDIpOwogICAgICAgIH0KICAgICAgICAKICAg\nICAgICBAT3ZlcnJpZGUKICAgICAgICBwdWJsaWMgU3RyaW5nQnVpbGRlciBh\nc1ZhbHVlKEFsaWFzQ29udGV4dCBxKSB7CiAgICAgICAgICAgIHJldHVybiBF\neHByZXNzaW9ucy5hc1ZhbHVlKHEsIGUxLCAiID4gIiwgZTIpOwogICAgICAg\nIH0gICAgICAgIAogICAgfQogICAgCiAgICBwdWJsaWMgc3RhdGljIGNsYXNz\nIEdyZWF0ZXJUaGFuRXF1YWwgZXh0ZW5kcyBCaW5hcnlMb2dpY2FsRXhwcmVz\nc2lvbiB7CiAgICAgICAgcHVibGljIDxYLFk+IEdyZWF0ZXJUaGFuRXF1YWwo\nRXhwcmVzc2lvbjxYPiB4LCBFeHByZXNzaW9uPFk+IHkpIHsKICAgICAgICAg\nICAgc3VwZXIoeCx5KTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgcHVi\nbGljIDxYPiBHcmVhdGVyVGhhbkVxdWFsKEV4cHJlc3Npb248WD4geCwgT2Jq\nZWN0IHkpIHsKICAgICAgICAgICAgdGhpcyh4LCBuZXcgQ29uc3RhbnQoeSkp\nOwogICAgICAgIH0KICAgICAgICAKICAgICAgICBAT3ZlcnJpZGUKICAgICAg\nICBwdWJsaWMgUHJlZGljYXRlSW1wbCBub3QoKSB7CiAgICAgICAgICAgIHJl\ndHVybiBuZXcgTGVzc1RoYW4oZTEsIGUyKS5tYXJrTmVnYXRlZCgpOwogICAg\nICAgIH0KICAgICAgICAKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBvcmcu\nYXBhY2hlLm9wZW5qcGEua2VybmVsLmV4cHMuRXhwcmVzc2lvbiB0b0tlcm5l\nbEV4cHJlc3Npb24oRXhwcmVzc2lvbkZhY3RvcnkgZmFjdG9yeSwgQ3JpdGVy\naWFRdWVyeUltcGw8Pz4gcSl7CiAgICAgICAgICAgIFZhbHVlIHZhbDEgPSBF\neHByZXNzaW9ucy50b1ZhbHVlKGUxLCBmYWN0b3J5LCBxKTsKICAgICAgICAg\nICAgVmFsdWUgdmFsMiA9IEV4cHJlc3Npb25zLnRvVmFsdWUoZTIsIGZhY3Rv\ncnksIHEpOyAKICAgICAgICAgICAgRXhwcmVzc2lvbnMuc2V0SW1wbGljaXRU\neXBlcyh2YWwxLCB2YWwyLCBlMS5nZXRKYXZhVHlwZSgpLCBxKTsgCiAgICAg\nICAgICAgIHJldHVybiBmYWN0b3J5LmdyZWF0ZXJUaGFuRXF1YWwodmFsMSwg\ndmFsMik7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIEBPdmVycmlkZQog\nICAgICAgIHB1YmxpYyBTdHJpbmdCdWlsZGVyIGFzVmFsdWUoQWxpYXNDb250\nZXh0IHEpIHsKICAgICAgICAgICAgcmV0dXJuIEV4cHJlc3Npb25zLmFzVmFs\ndWUocSwgZTEsICIgPj0gIiwgZTIpOwogICAgICAgIH0gICAgICAgIAogICAg\nfQogICAKICAgIHB1YmxpYyBzdGF0aWMgY2xhc3MgTGVzc1RoYW4gZXh0ZW5k\ncyBCaW5hcnlMb2dpY2FsRXhwcmVzc2lvbiB7CiAgICAgICAgcHVibGljIDxY\nLFk+IExlc3NUaGFuKEV4cHJlc3Npb248WD4geCwgRXhwcmVzc2lvbjxZPiB5\nKSB7CiAgICAgICAgICAgIHN1cGVyKHgseSk7CiAgICAgICAgfQogICAgICAg\nIAogICAgICAgIHB1YmxpYyA8WD4gTGVzc1RoYW4oRXhwcmVzc2lvbjxYPiB4\nLCBPYmplY3QgeSkgewogICAgICAgICAgICB0aGlzKHgsIG5ldyBDb25zdGFu\ndCh5KSk7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIEBPdmVycmlkZQog\nICAgICAgIHB1YmxpYyBQcmVkaWNhdGVJbXBsIG5vdCgpIHsKICAgICAgICAg\nICAgcmV0dXJuIG5ldyBHcmVhdGVyVGhhbkVxdWFsKGUxLCBlMikubWFya05l\nZ2F0ZWQoKTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgQE92ZXJyaWRl\nCiAgICAgICAgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5leHBzLkV4cHJl\nc3Npb24gdG9LZXJuZWxFeHByZXNzaW9uKEV4cHJlc3Npb25GYWN0b3J5IGZh\nY3RvcnksIENyaXRlcmlhUXVlcnlJbXBsPD8+IHEpewogICAgICAgICAgICBW\nYWx1ZSB2YWwxID0gRXhwcmVzc2lvbnMudG9WYWx1ZShlMSwgZmFjdG9yeSwg\ncSk7CiAgICAgICAgICAgIFZhbHVlIHZhbDIgPSBFeHByZXNzaW9ucy50b1Zh\nbHVlKGUyLCBmYWN0b3J5LCBxKTsgCiAgICAgICAgICAgIEV4cHJlc3Npb25z\nLnNldEltcGxpY2l0VHlwZXModmFsMSwgdmFsMiwgZTEuZ2V0SmF2YVR5cGUo\nKSwgcSk7IAogICAgICAgICAgICByZXR1cm4gZmFjdG9yeS5sZXNzVGhhbih2\nYWwxLCB2YWwyKTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgQE92ZXJy\naWRlCiAgICAgICAgcHVibGljIFN0cmluZ0J1aWxkZXIgYXNWYWx1ZShBbGlh\nc0NvbnRleHQgcSkgewogICAgICAgICAgICByZXR1cm4gRXhwcmVzc2lvbnMu\nYXNWYWx1ZShxLCBlMSwgIiA8ICIsIGUyKTsKICAgICAgICB9ICAgICAgICAK\nICAgIH0KICAgIAogICAgcHVibGljIHN0YXRpYyBjbGFzcyBMZXNzVGhhbkVx\ndWFsIGV4dGVuZHMgQmluYXJ5TG9naWNhbEV4cHJlc3Npb24gewogICAgICAg\nIHB1YmxpYyA8WCxZPiBMZXNzVGhhbkVxdWFsKEV4cHJlc3Npb248WD4geCwg\nRXhwcmVzc2lvbjxZPiB5KSB7CiAgICAgICAgICAgIHN1cGVyKHgseSk7CiAg\nICAgICAgfQogICAgICAgIAogICAgICAgIHB1YmxpYyA8WD4gTGVzc1RoYW5F\ncXVhbChFeHByZXNzaW9uPFg+IHgsIE9iamVjdCB5KSB7CiAgICAgICAgICAg\nIHRoaXMoeCwgbmV3IENvbnN0YW50KHkpKTsKICAgICAgICB9CiAgICAgICAg\nCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgcHVibGljIFByZWRpY2F0ZUlt\ncGwgbm90KCkgewogICAgICAgICAgICByZXR1cm4gbmV3IEdyZWF0ZXJUaGFu\nKGUxLCBlMikubWFya05lZ2F0ZWQoKTsKICAgICAgICB9CiAgICAgICAgCiAg\nICAgICAgQE92ZXJyaWRlCiAgICAgICAgb3JnLmFwYWNoZS5vcGVuanBhLmtl\ncm5lbC5leHBzLkV4cHJlc3Npb24gdG9LZXJuZWxFeHByZXNzaW9uKEV4cHJl\nc3Npb25GYWN0b3J5IGZhY3RvcnksIENyaXRlcmlhUXVlcnlJbXBsPD8+IHEp\newogICAgICAgICAgICBWYWx1ZSB2YWwxID0gRXhwcmVzc2lvbnMudG9WYWx1\nZShlMSwgZmFjdG9yeSwgcSk7CiAgICAgICAgICAgIFZhbHVlIHZhbDIgPSBF\neHByZXNzaW9ucy50b1ZhbHVlKGUyLCBmYWN0b3J5LCBxKTsgCiAgICAgICAg\nICAgIEV4cHJlc3Npb25zLnNldEltcGxpY2l0VHlwZXModmFsMSwgdmFsMiwg\nZTEuZ2V0SmF2YVR5cGUoKSwgcSk7IAogICAgICAgICAgICByZXR1cm4gZmFj\ndG9yeS5sZXNzVGhhbkVxdWFsKHZhbDEsIHZhbDIpOwogICAgICAgIH0KICAg\nICAgICAKICAgICAgICAKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBwdWJs\naWMgU3RyaW5nQnVpbGRlciBhc1ZhbHVlKEFsaWFzQ29udGV4dCBxKSB7CiAg\nICAgICAgICAgIHJldHVybiBFeHByZXNzaW9ucy5hc1ZhbHVlKHEsIGUxLCAi\nIDw9ICIsIGUyKTsKICAgICAgICB9ICAgICAgICAKICAgIH0KCiAgICBwdWJs\naWMgc3RhdGljIGNsYXNzIEJldHdlZW48WSBleHRlbmRzIENvbXBhcmFibGU8\nWT4+IGV4dGVuZHMgUHJlZGljYXRlSW1wbC5BbmQgewogICAgICAgIHByaXZh\ndGUgZmluYWwgRXhwcmVzc2lvbkltcGw8PyBleHRlbmRzIFk+IGU7CiAgICAg\nICAgcHJpdmF0ZSBmaW5hbCBFeHByZXNzaW9uSW1wbDw/IGV4dGVuZHMgWT4g\ndjE7CiAgICAgICAgcHJpdmF0ZSBmaW5hbCBFeHByZXNzaW9uSW1wbDw/IGV4\ndGVuZHMgWT4gdjI7CiAgICAgICAgCiAgICAgICAgcHVibGljIEJldHdlZW4o\nRXhwcmVzc2lvbjw/IGV4dGVuZHMgWT4gdiwgRXhwcmVzc2lvbjw/IGV4dGVu\nZHMgWT4geCwgRXhwcmVzc2lvbjw/IGV4dGVuZHMgWT4geSkgewogICAgICAg\nICAgICBzdXBlcihuZXcgR3JlYXRlclRoYW5FcXVhbCh2LHgpLCBuZXcgTGVz\nc1RoYW5FcXVhbCh2LHkpKTsKICAgICAgICAgICAgZSA9IChFeHByZXNzaW9u\nSW1wbDw/IGV4dGVuZHMgWT4pdjsKICAgICAgICAgICAgdjEgPSAoRXhwcmVz\nc2lvbkltcGw8PyBleHRlbmRzIFk+KXg7CiAgICAgICAgICAgIHYyID0gKEV4\ncHJlc3Npb25JbXBsPD8gZXh0ZW5kcyBZPil5OwogICAgICAgIH0KICAgICAg\nICAKICAgICAgICBwdWJsaWMgQmV0d2VlbihFeHByZXNzaW9uPD8gZXh0ZW5k\ncyBZPiB2LCBZIHgsIFkgeSkgewogICAgICAgICAgICB0aGlzKHYsIG5ldyBD\nb25zdGFudDxZPih4KSwgbmV3IENvbnN0YW50PFk+KHkpKTsKICAgICAgICB9\nCiAgICAgICAgCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgcHVibGljIFN0\ncmluZ0J1aWxkZXIgYXNWYWx1ZShBbGlhc0NvbnRleHQgcSkgewogICAgICAg\nICAgICByZXR1cm4gRXhwcmVzc2lvbnMuYXNWYWx1ZShxLCBlLCAiIEJFVFdF\nRU4gIiwgdjEsICIgQU5EICIsIHYyKTsKICAgICAgICB9CiAgICB9CiAgICAK\nICAgIHB1YmxpYyBzdGF0aWMgY2xhc3MgQ29uc3RhbnQ8WD4gZXh0ZW5kcyBF\neHByZXNzaW9uSW1wbDxYPiB7CiAgICAgICAgcHVibGljIGZpbmFsIE9iamVj\ndCBhcmc7CiAgICAgICAgcHVibGljIENvbnN0YW50KENsYXNzPFg+IHQsIFgg\neCkgewogICAgICAgICAgICBzdXBlcih0KTsKICAgICAgICAgICAgdGhpcy5h\ncmcgPSB4OwogICAgICAgIH0KICAgICAgICAKICAgICAgICBwdWJsaWMgQ29u\nc3RhbnQoWCB4KSB7CiAgICAgICAgICAgIHRoaXMoeCA9PSBudWxsID8gbnVs\nbCA6IChDbGFzczxYPil4LmdldENsYXNzKCksIHgpOwogICAgICAgIH0KICAg\nICAgICAKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBwdWJsaWMgVmFsdWUg\ndG9WYWx1ZShFeHByZXNzaW9uRmFjdG9yeSBmYWN0b3J5LCBDcml0ZXJpYVF1\nZXJ5SW1wbDw/PiBxKSB7CiAgICAgICAgICAgIE9iamVjdCB2YWx1ZSA9IGFy\nZzsKICAgICAgICAgICAgQ2xhc3M8Pz4gbGl0ZXJhbENsYXNzID0gZ2V0SmF2\nYVR5cGUoKTsKICAgICAgICAgICAgaWYgKGFyZyBpbnN0YW5jZW9mIFBhcmFt\nZXRlckV4cHJlc3Npb25JbXBsKSB7CiAgICAgICAgICAgICAgICByZXR1cm4g\nKChQYXJhbWV0ZXJFeHByZXNzaW9uSW1wbClhcmcpLnRvVmFsdWUoZmFjdG9y\neSwgcSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaW50IGxpdGVyYWxU\neXBlID0gTGl0ZXJhbC5UWVBFX1VOS05PV047CiAgICAgICAgICAgIGlmIChO\ndW1iZXIuY2xhc3MuaXNBc3NpZ25hYmxlRnJvbShsaXRlcmFsQ2xhc3MpKSB7\nCiAgICAgICAgICAgICAgICBsaXRlcmFsVHlwZSA9IExpdGVyYWwuVFlQRV9O\nVU1CRVI7CiAgICAgICAgICAgIH0gZWxzZSBpZiAoQm9vbGVhbi5jbGFzcy5p\nc0Fzc2lnbmFibGVGcm9tKGxpdGVyYWxDbGFzcykpIHsKICAgICAgICAgICAg\nICAgIGxpdGVyYWxUeXBlID0gTGl0ZXJhbC5UWVBFX0JPT0xFQU47CiAgICAg\nICAgICAgIH0gZWxzZSBpZiAoU3RyaW5nLmNsYXNzLmlzQXNzaWduYWJsZUZy\nb20obGl0ZXJhbENsYXNzKSkgewogICAgICAgICAgICAgICAgbGl0ZXJhbFR5\ncGUgPSBMaXRlcmFsLlRZUEVfU1RSSU5HOwogICAgICAgICAgICB9IGVsc2Ug\naWYgKEVudW0uY2xhc3MuaXNBc3NpZ25hYmxlRnJvbShsaXRlcmFsQ2xhc3Mp\nKSB7CiAgICAgICAgICAgICAgICBsaXRlcmFsVHlwZSA9IExpdGVyYWwuVFlQ\nRV9FTlVNOwogICAgICAgICAgICB9IGVsc2UgaWYgKENsYXNzLmNsYXNzLmlz\nQXNzaWduYWJsZUZyb20obGl0ZXJhbENsYXNzKSkgewogICAgICAgICAgICAg\nICAgbGl0ZXJhbFR5cGUgPSBMaXRlcmFsLlRZUEVfQ0xBU1M7CiAgICAgICAg\nICAgICAgICBMaXRlcmFsIGxpdCA9IGZhY3RvcnkubmV3VHlwZUxpdGVyYWwo\ndmFsdWUsIExpdGVyYWwuVFlQRV9DTEFTUyk7CiAgICAgICAgICAgICAgICBD\nbGFzc01ldGFEYXRhIGNhbiA9ICgoVHlwZXMuRW50aXR5PFg+KXEuZ2V0Um9v\ndCgpLmdldE1vZGVsKCkpLm1ldGE7CiAgICAgICAgICAgICAgICBDbGFzczw/\nPiBjYW5kaWRhdGUgPSBjYW4uZ2V0RGVzY3JpYmVkVHlwZSgpOwogICAgICAg\nICAgICAgICAgaWYgKGNhbmRpZGF0ZS5pc0Fzc2lnbmFibGVGcm9tKChDbGFz\ncyl2YWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgIGxpdC5zZXRNZXRhRGF0\nYShxLmdldE1ldGFtb2RlbCgpLmdldFJlcG9zaXRvcnkoKS5nZXRNZXRhRGF0\nYSgoQ2xhc3M8Pz4pdmFsdWUsIG51bGwsIHRydWUpKTsKICAgICAgICAgICAg\nICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgbGl0LnNldE1ldGFE\nYXRhKGNhbik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBy\nZXR1cm4gbGl0OwogICAgICAgICAgICB9IGVsc2UgaWYgKENvbGxlY3Rpb24u\nY2xhc3MuaXNBc3NpZ25hYmxlRnJvbShsaXRlcmFsQ2xhc3MpKSB7CiAgICAg\nICAgICAgICAgICBsaXRlcmFsVHlwZSA9IExpdGVyYWwuVFlQRV9DT0xMRUNU\nSU9OOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiBmYWN0b3J5\nLm5ld0xpdGVyYWwodmFsdWUsIGxpdGVyYWxUeXBlKTsKICAgICAgICB9CiAg\nICAgICAgCiAgICAgICAgcHVibGljIHZvaWQgYWNjZXB0VmlzaXQoQ3JpdGVy\naWFFeHByZXNzaW9uVmlzaXRvciB2aXNpdG9yKSB7CiAgICAgICAgICAgIEV4\ncHJlc3Npb25zLmFjY2VwdFZpc2l0KHZpc2l0b3IsIHRoaXMsIGFyZyBpbnN0\nYW5jZW9mIEV4cHJlc3Npb24gPyAoKEV4cHJlc3Npb24pYXJnKSA6IG51bGwp\nOwogICAgICAgIH0KICAgICAgICAKICAgICAgICBwdWJsaWMgU3RyaW5nQnVp\nbGRlciBhc1ZhbHVlKEFsaWFzQ29udGV4dCBxKSB7CiAgICAgICAgICAgIGlm\nIChhcmcgPT0gbnVsbCkKICAgICAgICAgICAgICAgIHJldHVybiBuZXcgU3Ry\naW5nQnVpbGRlcigiTlVMTCIpOwogICAgICAgICAgICBDbGFzczw/PiBsaXRl\ncmFsQ2xhc3MgPSBnZXRKYXZhVHlwZSgpOwogICAgICAgICAgICBpZiAoYXJn\nIGluc3RhbmNlb2YgUGFyYW1ldGVyRXhwcmVzc2lvbkltcGwpIHsKICAgICAg\nICAgICAgICAgIHJldHVybiAoKFBhcmFtZXRlckV4cHJlc3Npb25JbXBsPD8+\nKWFyZykuYXNWYWx1ZShxKTsKICAgICAgICAgICAgfSBlbHNlIGlmIChOdW1i\nZXIuY2xhc3MuaXNBc3NpZ25hYmxlRnJvbShsaXRlcmFsQ2xhc3MpKSB7CiAg\nICAgICAgICAgICAgICByZXR1cm4gbmV3IFN0cmluZ0J1aWxkZXIoYXJnLnRv\nU3RyaW5nKCkpOwogICAgICAgICAgICB9IGVsc2UgaWYgKEJvb2xlYW4uY2xh\nc3MuaXNBc3NpZ25hYmxlRnJvbShsaXRlcmFsQ2xhc3MpKSB7CiAgICAgICAg\nICAgICAgICByZXR1cm4gbmV3IFN0cmluZ0J1aWxkZXIoYXJnLnRvU3RyaW5n\nKCkpOwogICAgICAgICAgICB9IGVsc2UgaWYgKFN0cmluZy5jbGFzcy5pc0Fz\nc2lnbmFibGVGcm9tKGxpdGVyYWxDbGFzcykpIHsKICAgICAgICAgICAgICAg\nIHJldHVybiBuZXcgU3RyaW5nQnVpbGRlcigiJyIpLmFwcGVuZChhcmcudG9T\ndHJpbmcoKSkuYXBwZW5kKCInIik7CiAgICAgICAgICAgIH0gZWxzZSBpZiAo\nRW51bS5jbGFzcy5pc0Fzc2lnbmFibGVGcm9tKGxpdGVyYWxDbGFzcykpIHsK\nICAgICAgICAgICAgICAgIHJldHVybiBuZXcgU3RyaW5nQnVpbGRlcihhcmcu\ndG9TdHJpbmcoKSk7CiAgICAgICAgICAgIH0gZWxzZSBpZiAoQ2xhc3MuY2xh\nc3MuaXNBc3NpZ25hYmxlRnJvbShsaXRlcmFsQ2xhc3MpKSB7CiAgICAgICAg\nICAgICAgICByZXR1cm4gbmV3IFN0cmluZ0J1aWxkZXIoKChDbGFzcylhcmcp\nLmdldFNpbXBsZU5hbWUoKSk7CiAgICAgICAgICAgIH0gZWxzZSBpZiAoQ29s\nbGVjdGlvbi5jbGFzcy5pc0Fzc2lnbmFibGVGcm9tKGxpdGVyYWxDbGFzcykp\nIHsKICAgICAgICAgICAgICAgIHJldHVybiBuZXcgU3RyaW5nQnVpbGRlcigo\nKENvbGxlY3Rpb24pYXJnKS50b1N0cmluZygpKTsKICAgICAgICAgICAgfQog\nICAgICAgICAgICByZXR1cm4gbmV3IFN0cmluZ0J1aWxkZXIoYXJnLnRvU3Ry\naW5nKCkpOwogICAgICAgIH0KICAgIH0KICAgIAogICAgcHVibGljIHN0YXRp\nYyBjbGFzcyBJc0VtcHR5IGV4dGVuZHMgUHJlZGljYXRlSW1wbCB7CiAgICAg\nICAgZmluYWwgRXhwcmVzc2lvbkltcGw8Pz4gY29sbGVjdGlvbjsKICAgICAg\nICBwdWJsaWMgSXNFbXB0eShFeHByZXNzaW9uPD8+IGNvbGxlY3Rpb24pIHsK\nICAgICAgICAgICAgc3VwZXIoKTsKICAgICAgICAgICAgdGhpcy5jb2xsZWN0\naW9uID0gKEV4cHJlc3Npb25JbXBsPD8+KWNvbGxlY3Rpb247CiAgICAgICAg\nfQogICAgICAgIAogICAgICAgIEBPdmVycmlkZQogICAgICAgIHB1YmxpYyBQ\ncmVkaWNhdGVJbXBsIG5vdCgpIHsKICAgICAgICAgICAgcmV0dXJuIG5ldyBJ\nc05vdEVtcHR5KGNvbGxlY3Rpb24pLm1hcmtOZWdhdGVkKCk7CiAgICAgICAg\nfQogICAgICAgIAogICAgICAgIEBPdmVycmlkZQogICAgICAgIFZhbHVlIHRv\nVmFsdWUoRXhwcmVzc2lvbkZhY3RvcnkgZmFjdG9yeSwgQ3JpdGVyaWFRdWVy\neUltcGw8Pz4gcSkgewogICAgICAgICAgICByZXR1cm4gRXhwcmVzc2lvbnMu\ndG9WYWx1ZShjb2xsZWN0aW9uLCBmYWN0b3J5LCBxKTsKICAgICAgICB9CiAg\nICAgICAgCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgb3JnLmFwYWNoZS5v\ncGVuanBhLmtlcm5lbC5leHBzLkV4cHJlc3Npb24gdG9LZXJuZWxFeHByZXNz\naW9uKEV4cHJlc3Npb25GYWN0b3J5IGZhY3RvcnksIENyaXRlcmlhUXVlcnlJ\nbXBsPD8+IHEpewogICAgICAgICAgICBWYWx1ZSB2YWwgPSBFeHByZXNzaW9u\ncy50b1ZhbHVlKGNvbGxlY3Rpb24sIGZhY3RvcnksIHEpOwogICAgICAgICAg\nICByZXR1cm4gZmFjdG9yeS5pc0VtcHR5KHZhbCk7CiAgICAgICAgfQogICAg\nICAgIAogICAgICAgIHB1YmxpYyB2b2lkIGFjY2VwdFZpc2l0KENyaXRlcmlh\nRXhwcmVzc2lvblZpc2l0b3IgdmlzaXRvcikgewogICAgICAgICAgICBzdXBl\nci5hY2NlcHRWaXNpdCh2aXNpdG9yKTsKICAgICAgICAgICAgRXhwcmVzc2lv\nbnMuYWNjZXB0VmlzaXQodmlzaXRvciwgY29sbGVjdGlvbik7CiAgICAgICAg\nfQogICAgICAgIAogICAgICAgIEBPdmVycmlkZQogICAgICAgIHB1YmxpYyBT\ndHJpbmdCdWlsZGVyIGFzVmFsdWUoQWxpYXNDb250ZXh0IHEpIHsKICAgICAg\nICAgICAgcmV0dXJuIEV4cHJlc3Npb25zLmFzVmFsdWUocSwgY29sbGVjdGlv\nbiwgIiBJUyBFTVBUWSIpOwogICAgICAgIH0KICAgIH0KICAgIAogICAgcHVi\nbGljIHN0YXRpYyBjbGFzcyBJc05vdEVtcHR5IGV4dGVuZHMgUHJlZGljYXRl\nSW1wbCB7CiAgICAgICAgZmluYWwgRXhwcmVzc2lvbkltcGw8Pz4gY29sbGVj\ndGlvbjsKICAgICAgICBwdWJsaWMgSXNOb3RFbXB0eShFeHByZXNzaW9uPD8+\nIGNvbGxlY3Rpb24pIHsKICAgICAgICAgICAgc3VwZXIoKTsKICAgICAgICAg\nICAgdGhpcy5jb2xsZWN0aW9uID0gKEV4cHJlc3Npb25JbXBsPD8+KWNvbGxl\nY3Rpb247CiAgICAgICAgfQogICAgICAgIAogICAgICAgIEBPdmVycmlkZQog\nICAgICAgIHB1YmxpYyBQcmVkaWNhdGVJbXBsIG5vdCgpIHsKICAgICAgICAg\nICAgcmV0dXJuIG5ldyBJc0VtcHR5KGNvbGxlY3Rpb24pLm1hcmtOZWdhdGVk\nKCk7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIEBPdmVycmlkZQogICAg\nICAgIFZhbHVlIHRvVmFsdWUoRXhwcmVzc2lvbkZhY3RvcnkgZmFjdG9yeSwg\nQ3JpdGVyaWFRdWVyeUltcGw8Pz4gcSkgewogICAgICAgICAgICByZXR1cm4g\nRXhwcmVzc2lvbnMudG9WYWx1ZShjb2xsZWN0aW9uLCBmYWN0b3J5LCBxKTsK\nICAgICAgICB9CiAgICAgICAgCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAg\nb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5leHBzLkV4cHJlc3Npb24gdG9L\nZXJuZWxFeHByZXNzaW9uKEV4cHJlc3Npb25GYWN0b3J5IGZhY3RvcnksIENy\naXRlcmlhUXVlcnlJbXBsPD8+IHEpewogICAgICAgICAgICBWYWx1ZSB2YWwg\nPSBFeHByZXNzaW9ucy50b1ZhbHVlKGNvbGxlY3Rpb24sIGZhY3RvcnksIHEp\nOwogICAgICAgICAgICAvLyBmYWN0b3J5LmlzTm90RW1wdHkoKSBub3QgdXNl\nZCB0byBtYXRjaCBKUFFMCiAgICAgICAgICAgIHJldHVybiBmYWN0b3J5Lm5v\ndChmYWN0b3J5LmlzRW1wdHkodmFsKSk7CiAgICAgICAgfQogICAgICAgIAog\nICAgICAgIHB1YmxpYyB2b2lkIGFjY2VwdFZpc2l0KENyaXRlcmlhRXhwcmVz\nc2lvblZpc2l0b3IgdmlzaXRvcikgewogICAgICAgICAgICBzdXBlci5hY2Nl\ncHRWaXNpdCh2aXNpdG9yKTsKICAgICAgICAgICAgRXhwcmVzc2lvbnMuYWNj\nZXB0VmlzaXQodmlzaXRvciwgY29sbGVjdGlvbik7CiAgICAgICAgfQogICAg\nICAgIAogICAgICAgIEBPdmVycmlkZQogICAgICAgIHB1YmxpYyBTdHJpbmdC\ndWlsZGVyIGFzVmFsdWUoQWxpYXNDb250ZXh0IHEpIHsKICAgICAgICAgICAg\ncmV0dXJuIEV4cHJlc3Npb25zLmFzVmFsdWUocSwgY29sbGVjdGlvbiwgIiBJ\nUyBOT1QgRU1QVFkiKTsKICAgICAgICB9CiAgICB9CgogICAgCiAgICBwdWJs\naWMgc3RhdGljIGNsYXNzIEluZGV4IGV4dGVuZHMgVW5hcnlGdW5jdGlvbmFs\nRXhwcmVzc2lvbjxJbnRlZ2VyPiB7CiAgICAgICAgcHVibGljIEluZGV4KEpv\naW5zLkxpc3Q8Pyw/PiBlKSB7CiAgICAgICAgICAgIHN1cGVyKEludGVnZXIu\nY2xhc3MsIGUpOwogICAgICAgIH0KICAgICAgICAKICAgICAgICBAT3ZlcnJp\nZGUKICAgICAgICBwdWJsaWMgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5l\neHBzLlZhbHVlIHRvVmFsdWUoRXhwcmVzc2lvbkZhY3RvcnkgZmFjdG9yeSwg\nQ3JpdGVyaWFRdWVyeUltcGw8Pz4gcSkgewogICAgICAgICAgICBWYWx1ZSB2\nID0gRXhwcmVzc2lvbnMudG9WYWx1ZShlLCBmYWN0b3J5LCBxKTsKICAgICAg\nICAgICAgQ2xhc3NNZXRhRGF0YSBtZXRhID0gKChQYXRoSW1wbDw/LD8+KWUp\nLl9tZW1iZXIuZm1kLmdldEVsZW1lbnQoKS5nZXRUeXBlTWV0YURhdGEoKTsK\nICAgICAgICAgICAgdi5zZXRNZXRhRGF0YShtZXRhKTsKICAgICAgICAgICAg\ncmV0dXJuIGZhY3RvcnkuaW5kZXgodik7CiAgICAgICAgfQogICAgICAgIAog\nICAgICAgIEBPdmVycmlkZQogICAgICAgIHB1YmxpYyBTdHJpbmdCdWlsZGVy\nIGFzVmFsdWUoQWxpYXNDb250ZXh0IHEpIHsKICAgICAgICAgICAgcmV0dXJu\nIEV4cHJlc3Npb25zLmFzVmFsdWUocSwgIklOREVYIiwgT1BFTl9CUkFDRSwg\nZSwgQ0xPU0VfQlJBQ0UpOwogICAgICAgIH0KICAgIH0KICAgIAogICAgcHVi\nbGljIHN0YXRpYyBjbGFzcyBJc01lbWJlcjxFPiBleHRlbmRzIFByZWRpY2F0\nZUltcGwgewogICAgICAgIGZpbmFsIEV4cHJlc3Npb25JbXBsPEU+IGVsZW1l\nbnQ7CiAgICAgICAgZmluYWwgRXhwcmVzc2lvbkltcGw8Pz4gY29sbGVjdGlv\nbjsKICAgICAgICAKICAgICAgICBwdWJsaWMgSXNNZW1iZXIoRXhwcmVzc2lv\nbjxFPiBlbGVtZW50LCBFeHByZXNzaW9uPD8+IGNvbGxlY3Rpb24pIHsKICAg\nICAgICAgICAgc3VwZXIoKTsKICAgICAgICAgICAgdGhpcy5lbGVtZW50ID0g\nKEV4cHJlc3Npb25JbXBsPEU+KWVsZW1lbnQ7CiAgICAgICAgICAgIHRoaXMu\nY29sbGVjdGlvbiA9IChFeHByZXNzaW9uSW1wbDw/Piljb2xsZWN0aW9uOwog\nICAgICAgIH0KICAgICAgICAKICAgICAgICBwdWJsaWMgSXNNZW1iZXIoRSBl\nbGVtZW50LCBFeHByZXNzaW9uPD8+IGNvbGxlY3Rpb24pIHsKICAgICAgICAg\nICAgdGhpcyhuZXcgQ29uc3RhbnQ8RT4oZWxlbWVudCksIGNvbGxlY3Rpb24p\nOwogICAgICAgIH0KICAgICAgICAKICAgICAgICBAT3ZlcnJpZGUKICAgICAg\nICBwdWJsaWMgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5leHBzLkV4cHJl\nc3Npb24gdG9LZXJuZWxFeHByZXNzaW9uKAogICAgICAgICAgICBFeHByZXNz\naW9uRmFjdG9yeSBmYWN0b3J5LCBDcml0ZXJpYVF1ZXJ5SW1wbDw/PiBxKSB7\nCiAgICAgICAgICAgIG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuZXhwcy5F\neHByZXNzaW9uIGNvbnRhaW5zID0gZmFjdG9yeS5jb250YWlucygKICAgICAg\nICAgICAgICAgIEV4cHJlc3Npb25zLnRvVmFsdWUoY29sbGVjdGlvbiwgZmFj\ndG9yeSwgcSksIAogICAgICAgICAgICAgICAgRXhwcmVzc2lvbnMudG9WYWx1\nZShlbGVtZW50LCBmYWN0b3J5LCBxKSk7CiAgICAgICAgICAgIHJldHVybiBj\nb250YWluczsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgcHVibGljIHZv\naWQgYWNjZXB0VmlzaXQoQ3JpdGVyaWFFeHByZXNzaW9uVmlzaXRvciB2aXNp\ndG9yKSB7CiAgICAgICAgICAgIHN1cGVyLmFjY2VwdFZpc2l0KHZpc2l0b3Ip\nOwogICAgICAgICAgICBFeHByZXNzaW9ucy5hY2NlcHRWaXNpdCh2aXNpdG9y\nLCBjb2xsZWN0aW9uLCBlbGVtZW50KTsKICAgICAgICB9CiAgICAgICAgCiAg\nICAgICAgQE92ZXJyaWRlCiAgICAgICAgcHVibGljIFN0cmluZ0J1aWxkZXIg\nYXNWYWx1ZShBbGlhc0NvbnRleHQgcSkgewogICAgICAgICAgICByZXR1cm4g\nRXhwcmVzc2lvbnMuYXNWYWx1ZShxLCBlbGVtZW50LCAiTUVNQkVSIE9GICIs\nIGNvbGxlY3Rpb24pOwogICAgICAgIH0KICAgIH0KICAgIAogICAgcHVibGlj\nIHN0YXRpYyBjbGFzcyBMaWtlIGV4dGVuZHMgUHJlZGljYXRlSW1wbCB7CiAg\nICAgICAgcHVibGljIHN0YXRpYyBmaW5hbCBTdHJpbmcgTUFUQ0hfTVVMVElD\nSEFSICA9ICIlIjsKICAgICAgICBwdWJsaWMgc3RhdGljIGZpbmFsIFN0cmlu\nZyBNQVRDSF9TSU5HTEVDSEFSID0gIl8iOwogICAgICAgIAogICAgICAgIGZp\nbmFsIEV4cHJlc3Npb25JbXBsPFN0cmluZz4gc3RyOwogICAgICAgIGZpbmFs\nIEV4cHJlc3Npb25JbXBsPFN0cmluZz4gcGF0dGVybjsKICAgICAgICBmaW5h\nbCBFeHByZXNzaW9uSW1wbDxDaGFyYWN0ZXI+IGVzY2FwZUNoYXI7CiAgICAg\nICAgCiAgICAgICAgcHVibGljIExpa2UoRXhwcmVzc2lvbjxTdHJpbmc+IHgs\nIEV4cHJlc3Npb248U3RyaW5nPiBwYXR0ZXJuLCBFeHByZXNzaW9uPENoYXJh\nY3Rlcj4gZXNjYXBlQ2hhcikgewogICAgICAgICAgICBzdXBlcigpOwogICAg\nICAgICAgICB0aGlzLnN0ciA9IChFeHByZXNzaW9uSW1wbDxTdHJpbmc+KXg7\nCiAgICAgICAgICAgIHRoaXMucGF0dGVybiA9IChFeHByZXNzaW9uSW1wbDxT\ndHJpbmc+KXBhdHRlcm47CiAgICAgICAgICAgIHRoaXMuZXNjYXBlQ2hhciA9\nIChFeHByZXNzaW9uSW1wbDxDaGFyYWN0ZXI+KWVzY2FwZUNoYXI7CiAgICAg\nICAgfQogICAgICAgIAogICAgICAgIHB1YmxpYyBMaWtlKEV4cHJlc3Npb248\nU3RyaW5nPiB4LCBFeHByZXNzaW9uPFN0cmluZz4gcGF0LCBjaGFyIGVzYykg\newogICAgICAgICAgICB0aGlzKHgsIHBhdCwgbmV3IENvbnN0YW50PENoYXJh\nY3Rlcj4oQ2hhcmFjdGVyLmNsYXNzLCBlc2MpKTsKICAgICAgICB9CiAgICAg\nICAgCiAgICAgICAgcHVibGljIExpa2UoRXhwcmVzc2lvbjxTdHJpbmc+IHgs\nIEV4cHJlc3Npb248U3RyaW5nPiBwYXR0ZXJuKSB7CiAgICAgICAgICAgIHRo\naXMoeCwgcGF0dGVybiwgbnVsbCk7CiAgICAgICAgfQogICAgICAgIAogICAg\nICAgIHB1YmxpYyBMaWtlKEV4cHJlc3Npb248U3RyaW5nPiB4LCBTdHJpbmcg\ncGF0dGVybikgewogICAgICAgICAgICB0aGlzKHgsIG5ldyBDb25zdGFudDxT\ndHJpbmc+KHBhdHRlcm4pLCBudWxsKTsKICAgICAgICB9CiAgICAgICAgCiAg\nICAgICAgcHVibGljIExpa2UoRXhwcmVzc2lvbjxTdHJpbmc+IHgsIFN0cmlu\nZyBwYXQsICAKICAgICAgICAgICAgRXhwcmVzc2lvbjxDaGFyYWN0ZXI+IGVz\nYykgewogICAgICAgICAgICB0aGlzKHgsIG5ldyBDb25zdGFudDxTdHJpbmc+\nKHBhdCksIGVzYyk7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIHB1Ymxp\nYyBMaWtlKEV4cHJlc3Npb248U3RyaW5nPiB4LCBTdHJpbmcgcGF0LCAgQ2hh\ncmFjdGVyIGVzYykgewogICAgICAgICAgICB0aGlzKHgsIG5ldyBDb25zdGFu\ndDxTdHJpbmc+KHBhdCksIG5ldyBDb25zdGFudDxDaGFyYWN0ZXI+KGVzYykp\nOwogICAgICAgIH0KCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgcHVibGlj\nIG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuZXhwcy5FeHByZXNzaW9uIHRv\nS2VybmVsRXhwcmVzc2lvbigKICAgICAgICAgICAgRXhwcmVzc2lvbkZhY3Rv\ncnkgZmFjdG9yeSwgQ3JpdGVyaWFRdWVyeUltcGw8Pz4gcSkgewogICAgICAg\nICAgICBTdHJpbmcgZXNjYXBlU3RyID0gZXNjYXBlQ2hhciA9PSBudWxsID8g\nbnVsbCA6CiAgICAgICAgICAgICAgICAoKENoYXJhY3RlcikoKExpdGVyYWwp\nRXhwcmVzc2lvbnMudG9WYWx1ZSgKICAgICAgICAgICAgICAgICAgICBlc2Nh\ncGVDaGFyLCBmYWN0b3J5LCBxKSkuZ2V0VmFsdWUoKSkudG9TdHJpbmcoKTsK\nICAgICAgICAgICAgCiAgICAgICAgICAgIHJldHVybiBmYWN0b3J5Lm1hdGNo\nZXMoCiAgICAgICAgICAgICAgICBFeHByZXNzaW9ucy50b1ZhbHVlKHN0ciwg\nZmFjdG9yeSwgcSksIAogICAgICAgICAgICAgICAgRXhwcmVzc2lvbnMudG9W\nYWx1ZShwYXR0ZXJuLCBmYWN0b3J5LCBxKSwgCiAgICAgICAgICAgICAgICBN\nQVRDSF9TSU5HTEVDSEFSLCBNQVRDSF9NVUxUSUNIQVIsIGVzY2FwZVN0cik7\nCiAgICAgICAgfQogICAgICAgIAogICAgICAgIHB1YmxpYyB2b2lkIGFjY2Vw\ndFZpc2l0KENyaXRlcmlhRXhwcmVzc2lvblZpc2l0b3IgdmlzaXRvcikgewog\nICAgICAgICAgICBFeHByZXNzaW9ucy5hY2NlcHRWaXNpdCh2aXNpdG9yLCB0\naGlzLCBzdHIsIHBhdHRlcm4sIGVzY2FwZUNoYXIpOwogICAgICAgIH0KICAg\nICAgICAKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBwdWJsaWMgU3RyaW5n\nQnVpbGRlciBhc1ZhbHVlKEFsaWFzQ29udGV4dCBxKSB7CiAgICAgICAgICAg\nIHJldHVybiBFeHByZXNzaW9ucy5hc1ZhbHVlKHEsIHN0ciwgIiBMSUtFICIs\nIHBhdHRlcm4pOwogICAgICAgIH0gICAgICAgIAogICAgfQogICAgCiAgICBw\ndWJsaWMgc3RhdGljIGNsYXNzIENvYWxlc2NlPFQ+IGV4dGVuZHMgRXhwcmVz\nc2lvbkltcGw8VD4gaW1wbGVtZW50cyBDcml0ZXJpYUJ1aWxkZXIuQ29hbGVz\nY2U8VD4gewogICAgICAgIHByaXZhdGUgZmluYWwgTGlzdDxFeHByZXNzaW9u\nPD8gZXh0ZW5kcyBUPj4gdmFsdWVzID0gbmV3IEFycmF5TGlzdDxFeHByZXNz\naW9uPD8gZXh0ZW5kcyBUPj4oKTsKICAgICAgICAKICAgICAgICBwdWJsaWMg\nQ29hbGVzY2UoQ2xhc3M8VD4gY2xzKSB7CiAgICAgICAgICAgIHN1cGVyKGNs\ncyk7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIHB1YmxpYyBDb2FsZXNj\nZTxUPiB2YWx1ZShUIHZhbHVlKSB7CiAgICAgICAgICAgIHZhbHVlcy5hZGQo\nbmV3IENvbnN0YW50PFQ+KHZhbHVlKSk7CiAgICAgICAgICAgIHJldHVybiB0\naGlzOwogICAgICAgIH0KICAgICAgICAKICAgICAgICBwdWJsaWMgQ29hbGVz\nY2U8VD4gdmFsdWUoRXhwcmVzc2lvbjw/IGV4dGVuZHMgVD4gdmFsdWUpIHsK\nICAgICAgICAgICAgdmFsdWVzLmFkZCh2YWx1ZSk7IAogICAgICAgICAgICBy\nZXR1cm4gdGhpczsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgQE92ZXJy\naWRlCiAgICAgICAgcHVibGljIG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwu\nZXhwcy5WYWx1ZSB0b1ZhbHVlKEV4cHJlc3Npb25GYWN0b3J5IGZhY3Rvcnks\nIENyaXRlcmlhUXVlcnlJbXBsPD8+IHEpIHsKICAgICAgICAgICAgVmFsdWVb\nXSB2cyA9IG5ldyBWYWx1ZVt2YWx1ZXMuc2l6ZSgpXTsKICAgICAgICAgICAg\naW50IGkgPSAwOwogICAgICAgICAgICBmb3IgKEV4cHJlc3Npb248Pz4gZSA6\nIHZhbHVlcykKICAgICAgICAgICAgICAgIHZzW2krK10gPSBFeHByZXNzaW9u\ncy50b1ZhbHVlKChFeHByZXNzaW9uSW1wbDw/PillLCBmYWN0b3J5LCBxKTsK\nICAgICAgICAgICAgcmV0dXJuIGZhY3RvcnkuY29hbGVzY2VFeHByZXNzaW9u\nKHZzKTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgcHVibGljIHZvaWQg\nYWNjZXB0VmlzaXQoQ3JpdGVyaWFFeHByZXNzaW9uVmlzaXRvciB2aXNpdG9y\nKSB7CiAgICAgICAgICAgIEV4cHJlc3Npb25zLmFjY2VwdFZpc2l0KHZpc2l0\nb3IsIHRoaXMsIHZhbHVlcy50b0FycmF5KG5ldyBFeHByZXNzaW9uSW1wbFt2\nYWx1ZXMuc2l6ZSgpXSkpOwogICAgICAgIH0KICAgICAgICAKICAgICAgICBA\nT3ZlcnJpZGUKICAgICAgICBwdWJsaWMgU3RyaW5nQnVpbGRlciBhc1ZhbHVl\nKEFsaWFzQ29udGV4dCBxKSB7CiAgICAgICAgICAgIHJldHVybiBFeHByZXNz\naW9ucy5hc1ZhbHVlKHEsICJDT0FMRVNDRSIsIE9QRU5fQlJBQ0UsIEV4cHJl\nc3Npb25zLmFzVmFsdWUocSwgdmFsdWVzID09IG51bGwgCiAgICAgICAgICAg\nICAgICAgICAgPyBudWxsIDogdmFsdWVzLnRvQXJyYXkobmV3IEV4cHJlc3Np\nb248Pz5bdmFsdWVzLnNpemUoKV0pLCBDT01NQSksIENMT1NFX0JSQUNFKTsK\nICAgICAgICB9ICAgICAgICAKICAgIH0KICAgIAogICAgcHVibGljIHN0YXRp\nYyBjbGFzcyBOdWxsaWY8VD4gZXh0ZW5kcyBFeHByZXNzaW9uSW1wbDxUPiB7\nCiAgICAgICAgcHJpdmF0ZSBFeHByZXNzaW9uPFQ+IHZhbDE7CiAgICAgICAg\ncHJpdmF0ZSBFeHByZXNzaW9uPD8+IHZhbDI7CgogICAgICAgIHB1YmxpYyBO\ndWxsaWYoRXhwcmVzc2lvbjxUPiB4LCBFeHByZXNzaW9uPD8+IHkpIHsKICAg\nICAgICAgICAgc3VwZXIoKENsYXNzPFQ+KXguZ2V0SmF2YVR5cGUoKSk7CiAg\nICAgICAgICAgIHZhbDEgPSB4OwogICAgICAgICAgICB2YWwyID0geTsKICAg\nICAgICB9CgogICAgICAgIHB1YmxpYyBOdWxsaWYoRXhwcmVzc2lvbjxUPiB4\nLCBUIHkpIHsKICAgICAgICAgICAgdGhpcyh4LCBuZXcgQ29uc3RhbnQ8VD4o\neSkpOwogICAgICAgIH0KCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgcHVi\nbGljIG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuZXhwcy5WYWx1ZSB0b1Zh\nbHVlKEV4cHJlc3Npb25GYWN0b3J5IGZhY3RvcnksIENyaXRlcmlhUXVlcnlJ\nbXBsPD8+IHEpIHsKICAgICAgICAgICAgVmFsdWUgdmFsdWUxID0gRXhwcmVz\nc2lvbnMudG9WYWx1ZSgoRXhwcmVzc2lvbkltcGw8Pz4pdmFsMSwgZmFjdG9y\neSwgcSk7IAogICAgICAgICAgICBWYWx1ZSB2YWx1ZTIgPSBFeHByZXNzaW9u\ncy50b1ZhbHVlKChFeHByZXNzaW9uSW1wbDw/Pil2YWwyLCBmYWN0b3J5LCBx\nKTsgCiAgICAgICAgICAgIHJldHVybiBmYWN0b3J5Lm51bGxJZkV4cHJlc3Np\nb24odmFsdWUxLCB2YWx1ZTIpOwogICAgICAgIH0KICAgICAgICAKICAgICAg\nICBwdWJsaWMgdm9pZCBhY2NlcHRWaXNpdChDcml0ZXJpYUV4cHJlc3Npb25W\naXNpdG9yIHZpc2l0b3IpIHsKICAgICAgICAgICAgRXhwcmVzc2lvbnMuYWNj\nZXB0VmlzaXQodmlzaXRvciwgdGhpcywgdmFsMSwgdmFsMik7CiAgICAgICAg\nfQogICAgICAgIAogICAgICAgIEBPdmVycmlkZQogICAgICAgIHB1YmxpYyBT\ndHJpbmdCdWlsZGVyIGFzVmFsdWUoQWxpYXNDb250ZXh0IHEpIHsKICAgICAg\nICAgICAgcmV0dXJuIEV4cHJlc3Npb25zLmFzVmFsdWUocSwgIk5VTExJRiIs\nIE9QRU5fQlJBQ0UsIHZhbDEsIENPTU1BLCB2YWwyLCBDTE9TRV9CUkFDRSk7\nCiAgICAgICAgfSAgICAgICAgCiAgICB9CgogICAgcHVibGljIHN0YXRpYyBj\nbGFzcyBJc051bGwgZXh0ZW5kcyBQcmVkaWNhdGVJbXBsIHsKICAgICAgICBm\naW5hbCBFeHByZXNzaW9uSW1wbDw/PiBlOwogICAgICAgIHB1YmxpYyBJc051\nbGwoRXhwcmVzc2lvbkltcGw8Pz4gZSkgewogICAgICAgICAgICBzdXBlcigp\nOwogICAgICAgICAgICB0aGlzLmUgPSBlOwogICAgICAgIH0KICAgICAgICAK\nICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBwdWJsaWMgUHJlZGljYXRlSW1w\nbCBub3QoKSB7CiAgICAgICAgICAgIHJldHVybiBuZXcgSXNOb3ROdWxsKGUp\nLm1hcmtOZWdhdGVkKCk7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIEBP\ndmVycmlkZQogICAgICAgIG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuZXhw\ncy5FeHByZXNzaW9uIHRvS2VybmVsRXhwcmVzc2lvbigKICAgICAgICAgICAg\nRXhwcmVzc2lvbkZhY3RvcnkgZmFjdG9yeSwgQ3JpdGVyaWFRdWVyeUltcGw8\nPz4gcSkgewogICAgICAgICAgICByZXR1cm4gZmFjdG9yeS5lcXVhbCgKICAg\nICAgICAgICAgICAgIEV4cHJlc3Npb25zLnRvVmFsdWUoZSwgZmFjdG9yeSwg\ncSksIAogICAgICAgICAgICAgICAgZmFjdG9yeS5nZXROdWxsKCkpOwogICAg\nICAgIH0KICAgICAgICAKICAgICAgICBwdWJsaWMgdm9pZCBhY2NlcHRWaXNp\ndChDcml0ZXJpYUV4cHJlc3Npb25WaXNpdG9yIHZpc2l0b3IpIHsKICAgICAg\nICAgICAgc3VwZXIuYWNjZXB0VmlzaXQodmlzaXRvcik7CiAgICAgICAgICAg\nIEV4cHJlc3Npb25zLmFjY2VwdFZpc2l0KHZpc2l0b3IsIGUpOwogICAgICAg\nIH0KICAgICAgICAKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBwdWJsaWMg\nU3RyaW5nQnVpbGRlciBhc1ZhbHVlKEFsaWFzQ29udGV4dCBxKSB7CiAgICAg\nICAgICAgIHJldHVybiBFeHByZXNzaW9ucy5hc1ZhbHVlKHEsIGUsICIgSVMg\nTlVMTCIpOwogICAgICAgIH0KICAgIH0KICAgIAogICAgcHVibGljIHN0YXRp\nYyBjbGFzcyBJc05vdE51bGwgZXh0ZW5kcyBQcmVkaWNhdGVJbXBsIHsKICAg\nICAgICBmaW5hbCBFeHByZXNzaW9uSW1wbDw/PiBlOwogICAgICAgIHB1Ymxp\nYyBJc05vdE51bGwoRXhwcmVzc2lvbkltcGw8Pz4gZSkgewogICAgICAgICAg\nICBzdXBlcigpOwogICAgICAgICAgICB0aGlzLmUgPSBlOwogICAgICAgIH0K\nICAgICAgICAKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBwdWJsaWMgUHJl\nZGljYXRlSW1wbCBub3QoKSB7CiAgICAgICAgICAgIHJldHVybiBuZXcgSXNO\ndWxsKGUpLm1hcmtOZWdhdGVkKCk7CiAgICAgICAgfQogICAgICAgIAogICAg\nICAgIEBPdmVycmlkZQogICAgICAgIG9yZy5hcGFjaGUub3BlbmpwYS5rZXJu\nZWwuZXhwcy5FeHByZXNzaW9uIHRvS2VybmVsRXhwcmVzc2lvbigKICAgICAg\nICAgICAgRXhwcmVzc2lvbkZhY3RvcnkgZmFjdG9yeSwgQ3JpdGVyaWFRdWVy\neUltcGw8Pz4gcSkgewogICAgICAgICAgICByZXR1cm4gZmFjdG9yeS5ub3RF\ncXVhbCgKICAgICAgICAgICAgICAgIEV4cHJlc3Npb25zLnRvVmFsdWUoZSwg\nZmFjdG9yeSwgcSksIAogICAgICAgICAgICAgICAgZmFjdG9yeS5nZXROdWxs\nKCkpOwogICAgICAgIH0KICAgICAgICAKICAgICAgICBwdWJsaWMgdm9pZCBh\nY2NlcHRWaXNpdChDcml0ZXJpYUV4cHJlc3Npb25WaXNpdG9yIHZpc2l0b3Ip\nIHsKICAgICAgICAgICAgc3VwZXIuYWNjZXB0VmlzaXQodmlzaXRvcik7CiAg\nICAgICAgICAgIEV4cHJlc3Npb25zLmFjY2VwdFZpc2l0KHZpc2l0b3IsIGUp\nOwogICAgICAgIH0KICAgICAgICAKICAgICAgICBAT3ZlcnJpZGUKICAgICAg\nICBwdWJsaWMgU3RyaW5nQnVpbGRlciBhc1ZhbHVlKEFsaWFzQ29udGV4dCBx\nKSB7CiAgICAgICAgICAgIHJldHVybiBFeHByZXNzaW9ucy5hc1ZhbHVlKHEs\nIGUsICIgSVMgTk9UIE5VTEwiKTsKICAgICAgICB9CiAgICB9CiAgICAKICAg\nIAogICAgcHVibGljIHN0YXRpYyBjbGFzcyBJbjxUPiBleHRlbmRzIFByZWRp\nY2F0ZUltcGwuT3IgaW1wbGVtZW50cyBDcml0ZXJpYUJ1aWxkZXIuSW48VD4g\newogICAgICAgIGZpbmFsIEV4cHJlc3Npb25JbXBsPFQ+IGU7CiAgICAgICAg\ncHVibGljIEluKEV4cHJlc3Npb248Pz4gZSkgewogICAgICAgICAgICBzdXBl\ncigpOwogICAgICAgICAgICB0aGlzLmUgPSAoRXhwcmVzc2lvbkltcGw8VD4p\nZTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgcHVibGljIEV4cHJlc3Np\nb248VD4gZ2V0RXhwcmVzc2lvbigpIHsKICAgICAgICAgICAgcmV0dXJuIGU7\nCiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgSW48VD4gdmFsdWUoVCB2YWx1\nZSkgewogICAgICAgICAgICBhZGQobmV3IEV4cHJlc3Npb25zLkVxdWFsKGUs\ndmFsdWUpKTsKICAgICAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgICAgfQoK\nICAgICAgICBwdWJsaWMgSW48VD4gdmFsdWUoRXhwcmVzc2lvbjw/IGV4dGVu\nZHMgVD4gdmFsdWUpIHsKICAgICAgICAgICAgYWRkKG5ldyBFeHByZXNzaW9u\ncy5FcXVhbChlLHZhbHVlKSk7CiAgICAgICAgICAgIHJldHVybiB0aGlzOwog\nICAgICAgIH0KICAgICAgICAKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBw\ndWJsaWMgUHJlZGljYXRlSW1wbCBub3QoKSB7CiAgICAgICAgICAgIEluPFQ+\nIG5vdEluID0gbmV3IEluPFQ+KGUpOwogICAgICAgICAgICBub3RJbi5tYXJr\nTmVnYXRlZCgpOwogICAgICAgICAgICBmb3IgKFByZWRpY2F0ZSBlIDogX2V4\ncHMpIHsKICAgICAgICAgICAgICAgIG5vdEluLmFkZChlKTsKICAgICAgICAg\nICAgfQogICAgICAgICAgICByZXR1cm4gbm90SW47CiAgICAgICAgfQogICAg\nICAgIAogICAgICAgIEBPdmVycmlkZQogICAgICAgIG9yZy5hcGFjaGUub3Bl\nbmpwYS5rZXJuZWwuZXhwcy5FeHByZXNzaW9uIHRvS2VybmVsRXhwcmVzc2lv\nbigKICAgICAgICAgICAgRXhwcmVzc2lvbkZhY3RvcnkgZmFjdG9yeSwgQ3Jp\ndGVyaWFRdWVyeUltcGw8Pz4gcSkgewogICAgICAgICAgICBvcmcuYXBhY2hl\nLm9wZW5qcGEua2VybmVsLmV4cHMuRXhwcmVzc2lvbiBpbkV4cHIgPSBudWxs\nOwogICAgICAgICAgICBpZiAoX2V4cHMuc2l6ZSgpID09IDEpIHsKICAgICAg\nICAgICAgICAgIEV4cHJlc3Npb25zLkVxdWFsIGUgPSAoRXhwcmVzc2lvbnMu\nRXF1YWwpX2V4cHMuZ2V0KDApOwogICAgICAgICAgICAgICAgRXhwcmVzc2lv\nbkltcGw8Pz4gZTIgPSBlLmUyOwogICAgICAgICAgICAgICAgRXhwcmVzc2lv\nbkltcGw8Pz4gZTEgPSBlLmUxOwogICAgICAgICAgICAgICAgVmFsdWUgdmFs\nMiA9IEV4cHJlc3Npb25zLnRvVmFsdWUoZTIsIGZhY3RvcnksIHEpOwogICAg\nICAgICAgICAgICAgaWYgKCEodmFsMiBpbnN0YW5jZW9mIExpdGVyYWwpKSB7\nCiAgICAgICAgICAgICAgICAgICAgVmFsdWUgdmFsMSA9IEV4cHJlc3Npb25z\nLnRvVmFsdWUoZTEsIGZhY3RvcnksIHEpOwogICAgICAgICAgICAgICAgICAg\nIEV4cHJlc3Npb25zLnNldEltcGxpY2l0VHlwZXModmFsMSwgdmFsMiwgZTEu\nZ2V0SmF2YVR5cGUoKSwgcSk7CiAgICAgICAgICAgICAgICAgICAgaW5FeHBy\nID0gZmFjdG9yeS5jb250YWlucyh2YWwyLCB2YWwxKTsKICAgICAgICAgICAg\nICAgICAgICByZXR1cm4gaXNOZWdhdGVkKCkgPyBmYWN0b3J5Lm5vdChpbkV4\ncHIpIDogaW5FeHByOwogICAgICAgICAgICAgICAgfSBlbHNlIGlmICgoKExp\ndGVyYWwpdmFsMikuZ2V0UGFyc2VUeXBlKCkgPT0gTGl0ZXJhbC5UWVBFX0NP\nTExFQ1RJT04pIHsKICAgICAgICAgICAgICAgICAgICBDb2xsZWN0aW9uIGNv\nbGwgPSAoQ29sbGVjdGlvbikoKExpdGVyYWwpdmFsMikuZ2V0VmFsdWUoKTsK\nICAgICAgICAgICAgICAgICAgICBfZXhwcy5jbGVhcigpOwogICAgICAgICAg\nICAgICAgICAgIGZvciAoT2JqZWN0IHYgOiBjb2xsKSB7CiAgICAgICAgICAg\nICAgICAgICAgICAgIGFkZChuZXcgRXhwcmVzc2lvbnMuRXF1YWwoZTEsdikp\nOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAg\nICAgICAgICAgfSAKICAgICAgICAgICAgaW5FeHByID0gc3VwZXIudG9LZXJu\nZWxFeHByZXNzaW9uKGZhY3RvcnksIHEpOyAKICAgICAgICAgICAgSXNOb3RO\ndWxsIG5vdE51bGwgPSBuZXcgRXhwcmVzc2lvbnMuSXNOb3ROdWxsKGUpOwog\nICAgICAgICAgICAKICAgICAgICAgICAgcmV0dXJuIGZhY3RvcnkuYW5kKGlu\nRXhwciwgbm90TnVsbC50b0tlcm5lbEV4cHJlc3Npb24oZmFjdG9yeSwgcSkp\nOwogICAgICAgIH0KICAgICAgICAKICAgICAgICBwdWJsaWMgdm9pZCBhY2Nl\ncHRWaXNpdChDcml0ZXJpYUV4cHJlc3Npb25WaXNpdG9yIHZpc2l0b3IpIHsK\nICAgICAgICAgICAgc3VwZXIuYWNjZXB0VmlzaXQodmlzaXRvcik7CiAgICAg\nICAgICAgIEV4cHJlc3Npb25zLmFjY2VwdFZpc2l0KHZpc2l0b3IsIHRoaXMs\nIGUpOwogICAgICAgIH0KICAgICAgICAKICAgICAgICBAT3ZlcnJpZGUKICAg\nICAgICBwdWJsaWMgU3RyaW5nQnVpbGRlciBhc1ZhbHVlKEFsaWFzQ29udGV4\ndCBxKSB7CiAgICAgICAgICAgIFN0cmluZ0J1aWxkZXIgYnVmZmVyID0gRXhw\ncmVzc2lvbnMuYXNWYWx1ZShxLCBlLCAiIElOICIsIE9QRU5fQlJBQ0UpOwog\nICAgICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IF9leHBzLnNpemUoKTsg\naSsrKSB7CiAgICAgICAgICAgICAgICBidWZmZXIuYXBwZW5kKCgoRXF1YWwp\nX2V4cHMuZ2V0KGkpKS5lMi5hc1ZhbHVlKHEpKS5hcHBlbmQoaSsxID09IF9l\neHBzLnNpemUoKSA/IENMT1NFX0JSQUNFIDogQ09NTUEpOwogICAgICAgICAg\nICB9CiAgICAgICAgICAgIHJldHVybiBidWZmZXI7CiAgICAgICAgfSAgICAg\nICAgCiAgICB9CiAgICAKICAgIHB1YmxpYyBzdGF0aWMgY2xhc3MgQ2FzZTxU\nPiBleHRlbmRzIEV4cHJlc3Npb25JbXBsPFQ+IGltcGxlbWVudHMgQ3JpdGVy\naWFCdWlsZGVyLkNhc2U8VD4gewogICAgICAgIHByaXZhdGUgZmluYWwgTGlz\ndDxFeHByZXNzaW9uPD8gZXh0ZW5kcyBUPj4gdGhlbnMgPSBuZXcgQXJyYXlM\naXN0PEV4cHJlc3Npb248PyBleHRlbmRzIFQ+PigpOwogICAgICAgIHByaXZh\ndGUgZmluYWwgTGlzdDxFeHByZXNzaW9uPEJvb2xlYW4+PiB3aGVucyA9IG5l\ndyBBcnJheUxpc3Q8RXhwcmVzc2lvbjxCb29sZWFuPj4oKTsKICAgICAgICBw\ncml2YXRlIEV4cHJlc3Npb248PyBleHRlbmRzIFQ+IG90aGVyd2lzZTsKCiAg\nICAgICAgcHVibGljIENhc2UoQ2xhc3M8VD4gY2xzKSB7CiAgICAgICAgICAg\nIHN1cGVyKGNscyk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgQ2FzZTxU\nPiB3aGVuKEV4cHJlc3Npb248Qm9vbGVhbj4gd2hlbiwgRXhwcmVzc2lvbjw/\nIGV4dGVuZHMgVD4gdGhlbikgewogICAgICAgICAgICB3aGVucy5hZGQod2hl\nbik7CiAgICAgICAgICAgIHRoZW5zLmFkZCh0aGVuKTsKICAgICAgICAgICAg\ncmV0dXJuIHRoaXM7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgQ2FzZTxU\nPiB3aGVuKEV4cHJlc3Npb248Qm9vbGVhbj4gd2hlbiwgVCB0aGVuKSB7CiAg\nICAgICAgICAgIHJldHVybiB3aGVuKHdoZW4sIG5ldyBFeHByZXNzaW9ucy5D\nb25zdGFudDxUPih0aGVuKSk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMg\nQ2FzZTxUPiBvdGhlcndpc2UoRXhwcmVzc2lvbjw/IGV4dGVuZHMgVD4gb3Ro\nZXJ3aXNlKSB7CiAgICAgICAgICAgIHRoaXMub3RoZXJ3aXNlID0gb3RoZXJ3\naXNlOwogICAgICAgICAgICByZXR1cm4gdGhpczsKICAgICAgICB9CgogICAg\nICAgIHB1YmxpYyBDYXNlPFQ+IG90aGVyd2lzZShUIG90aGVyd2lzZSkgewog\nICAgICAgICAgICByZXR1cm4gb3RoZXJ3aXNlKG5ldyBFeHByZXNzaW9ucy5D\nb25zdGFudDxUPihvdGhlcndpc2UpKTsKICAgICAgICB9CgogICAgICAgIEBP\ndmVycmlkZQogICAgICAgIHB1YmxpYyBvcmcuYXBhY2hlLm9wZW5qcGEua2Vy\nbmVsLmV4cHMuVmFsdWUgdG9WYWx1ZShFeHByZXNzaW9uRmFjdG9yeSBmYWN0\nb3J5LCBDcml0ZXJpYVF1ZXJ5SW1wbDw/PiBxKSB7CiAgICAgICAgICAgIGlu\ndCBzaXplID0gd2hlbnMuc2l6ZSgpOwogICAgICAgICAgICBvcmcuYXBhY2hl\nLm9wZW5qcGEua2VybmVsLmV4cHMuRXhwcmVzc2lvbltdIGV4cHMgPSBuZXcg\nb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5leHBzLkV4cHJlc3Npb25bc2l6\nZV07CiAgICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgc2l6ZTsgaSsr\nKSB7CiAgICAgICAgICAgICAgICBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVs\nLmV4cHMuRXhwcmVzc2lvbiBleHByID0gCiAgICAgICAgICAgICAgICAgICAg\nKChFeHByZXNzaW9uSW1wbDw/Pil3aGVucy5nZXQoaSkpLnRvS2VybmVsRXhw\ncmVzc2lvbihmYWN0b3J5LCBxKTsKICAgICAgICAgICAgICAgIFZhbHVlIGFj\ndGlvbiA9IEV4cHJlc3Npb25zLnRvVmFsdWUoKEV4cHJlc3Npb25JbXBsPD8+\nKXRoZW5zLmdldChpKSwgZmFjdG9yeSwgcSk7CiAgICAgICAgICAgICAgICBl\neHBzW2ldID0gZmFjdG9yeS53aGVuQ29uZGl0aW9uKGV4cHIsIGFjdGlvbik7\nCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIFZhbHVlIG90aGVyID0gRXhw\ncmVzc2lvbnMudG9WYWx1ZSgoRXhwcmVzc2lvbkltcGw8Pz4pb3RoZXJ3aXNl\nLCBmYWN0b3J5LCBxKTsKICAgICAgICAgICAgcmV0dXJuIGZhY3RvcnkuZ2Vu\nZXJhbENhc2VFeHByZXNzaW9uKGV4cHMsIG90aGVyKTsKICAgICAgICB9CiAg\nICAgICAgCiAgICAgICAgcHVibGljIHZvaWQgYWNjZXB0VmlzaXQoQ3JpdGVy\naWFFeHByZXNzaW9uVmlzaXRvciB2aXNpdG9yKSB7CiAgICAgICAgICAgIHZp\nc2l0b3IuZW50ZXIodGhpcyk7CiAgICAgICAgICAgIGZvciAoaW50IGkgPSAw\nOyBpIDwgd2hlbnMuc2l6ZSgpOyBpKyspIHsKICAgICAgICAgICAgICAgIEV4\ncHJlc3Npb25zLnZpc2l0Q2hpbGRyZW4odmlzaXRvciwgd2hlbnMuZ2V0KGkp\nKTsKICAgICAgICAgICAgICAgIEV4cHJlc3Npb25zLnZpc2l0Q2hpbGRyZW4o\ndmlzaXRvciwgdGhlbnMuZ2V0KGkpKTsKICAgICAgICAgICAgfQogICAgICAg\nICAgICBFeHByZXNzaW9ucy52aXNpdENoaWxkcmVuKHZpc2l0b3IsIG90aGVy\nd2lzZSk7CiAgICAgICAgICAgIHZpc2l0b3IuZXhpdCh0aGlzKTsKICAgICAg\nICB9CiAgICAgICAgCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgcHVibGlj\nIFN0cmluZ0J1aWxkZXIgYXNWYWx1ZShBbGlhc0NvbnRleHQgcSkgewogICAg\nICAgICAgICBTdHJpbmdCdWlsZGVyIGJ1ZmZlciA9IG5ldyBTdHJpbmdCdWls\nZGVyKCJDQVNFICIpOwogICAgICAgICAgICBpbnQgc2l6ZSA9IHdoZW5zLnNp\nemUoKTsKICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBzaXplOyBp\nKyspIHsKICAgICAgICAgICAgICAgIGJ1ZmZlci5hcHBlbmQoRXhwcmVzc2lv\nbnMuYXNWYWx1ZShxLCAiIFdIRU4gIiwgd2hlbnMuZ2V0KGkpLCAiIFRIRU4g\nIiwgdGhlbnMuZ2V0KGkpKSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAg\nYnVmZmVyLmFwcGVuZChFeHByZXNzaW9ucy5hc1ZhbHVlKHEsICIgRUxTRSAi\nLCBvdGhlcndpc2UsICIgRU5EIikpOwogICAgICAgICAgICByZXR1cm4gYnVm\nZmVyOwogICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMgc3RhdGljIGNsYXNz\nIFNpbXBsZUNhc2U8QyxSPiBleHRlbmRzIEV4cHJlc3Npb25JbXBsPFI+IGlt\ncGxlbWVudHMgQ3JpdGVyaWFCdWlsZGVyLlNpbXBsZUNhc2U8QyxSPiB7CiAg\nICAgICAgcHJpdmF0ZSBmaW5hbCBMaXN0PEV4cHJlc3Npb248PyBleHRlbmRz\nIFI+PiB0aGVucyA9IG5ldyBBcnJheUxpc3Q8RXhwcmVzc2lvbjw/IGV4dGVu\nZHMgUj4+KCk7CiAgICAgICAgcHJpdmF0ZSBmaW5hbCBMaXN0PEV4cHJlc3Np\nb248Qz4+IHdoZW5zID0gbmV3IEFycmF5TGlzdDxFeHByZXNzaW9uPEM+Pigp\nOwogICAgICAgIHByaXZhdGUgRXhwcmVzc2lvbjw/IGV4dGVuZHMgUj4gb3Ro\nZXJ3aXNlOwogICAgICAgIHByaXZhdGUgRXhwcmVzc2lvbjxDPiBjYXNlT3Bl\ncmFuZDsKCiAgICAgICAgcHVibGljIFNpbXBsZUNhc2UoQ2xhc3M8Uj4gY2xz\nKSB7CiAgICAgICAgICAgIHN1cGVyKGNscyk7CiAgICAgICAgfQogICAgICAg\nIAogICAgICAgIHB1YmxpYyBTaW1wbGVDYXNlKEV4cHJlc3Npb248Qz4gZXhw\ncikgewogICAgICAgICAgICBzdXBlcihudWxsKTsKICAgICAgICAgICAgdGhp\ncy5jYXNlT3BlcmFuZCA9IGV4cHI7CiAgICAgICAgfQogICAgICAgIAogICAg\nICAgIHB1YmxpYyBFeHByZXNzaW9uPEM+IGdldEV4cHJlc3Npb24oKSB7CiAg\nICAgICAgICAgIHJldHVybiBjYXNlT3BlcmFuZDsKICAgICAgICB9CgogICAg\nICAgIHB1YmxpYyBTaW1wbGVDYXNlPEMsUj4gd2hlbihFeHByZXNzaW9uPEM+\nIHdoZW4sIEV4cHJlc3Npb248PyBleHRlbmRzIFI+IHRoZW4pIHsKICAgICAg\nICAgICAgd2hlbnMuYWRkKHdoZW4pOwogICAgICAgICAgICB0aGVucy5hZGQo\ndGhlbik7CiAgICAgICAgICAgIHJldHVybiB0aGlzOwogICAgICAgIH0KCiAg\nICAgICAgcHVibGljIFNpbXBsZUNhc2U8QyxSPiB3aGVuKEMgd2hlbiwgRXhw\ncmVzc2lvbjw/IGV4dGVuZHMgUj4gdGhlbikgewogICAgICAgICAgICByZXR1\ncm4gd2hlbihuZXcgQ29uc3RhbnQ8Qz4od2hlbiksIHRoZW4pOwogICAgICAg\nIH0KCiAgICAgICAgcHVibGljIFNpbXBsZUNhc2U8QyxSPiB3aGVuKEMgd2hl\nbiwgUiB0aGVuKSB7CiAgICAgICAgICAgIHJldHVybiB3aGVuKHdoZW4sIG5l\ndyBFeHByZXNzaW9ucy5Db25zdGFudDxSPih0aGVuKSk7CiAgICAgICAgfQoK\nICAgICAgICBwdWJsaWMgU2ltcGxlQ2FzZTxDLFI+IG90aGVyd2lzZShFeHBy\nZXNzaW9uPD8gZXh0ZW5kcyBSPiBvdGhlcndpc2UpIHsKICAgICAgICAgICAg\ndGhpcy5vdGhlcndpc2UgPSBvdGhlcndpc2U7CiAgICAgICAgICAgIHJldHVy\nbiB0aGlzOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIFNpbXBsZUNhc2U8\nQyxSPiBvdGhlcndpc2UoUiBvdGhlcndpc2UpIHsKICAgICAgICAgICAgcmV0\ndXJuIG90aGVyd2lzZShuZXcgRXhwcmVzc2lvbnMuQ29uc3RhbnQ8Uj4ob3Ro\nZXJ3aXNlKSk7CiAgICAgICAgfQoKICAgICAgICBAT3ZlcnJpZGUKICAgICAg\nICBwdWJsaWMgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5leHBzLlZhbHVl\nIHRvVmFsdWUoRXhwcmVzc2lvbkZhY3RvcnkgZmFjdG9yeSwgQ3JpdGVyaWFR\ndWVyeUltcGw8Pz4gcSkgewogICAgICAgICAgICBWYWx1ZSBjYXNlT3BlcmFu\nZEV4cHIgPSBFeHByZXNzaW9ucy50b1ZhbHVlKChFeHByZXNzaW9uSW1wbDw/\nPiljYXNlT3BlcmFuZCwgZmFjdG9yeSwgcSk7CiAgICAgICAgICAgIGludCBz\naXplID0gd2hlbnMuc2l6ZSgpOwogICAgICAgICAgICBvcmcuYXBhY2hlLm9w\nZW5qcGEua2VybmVsLmV4cHMuRXhwcmVzc2lvbltdIGV4cHMgPSBuZXcgb3Jn\nLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5leHBzLkV4cHJlc3Npb25bc2l6ZV07\nCiAgICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgc2l6ZTsgaSsrKSB7\nCiAgICAgICAgICAgICAgICBWYWx1ZSB3aGVuID0gRXhwcmVzc2lvbnMudG9W\nYWx1ZSgoRXhwcmVzc2lvbkltcGw8Qz4pd2hlbnMuZ2V0KGkpLCBmYWN0b3J5\nLCBxKTsKICAgICAgICAgICAgICAgIFZhbHVlIGFjdGlvbiA9IEV4cHJlc3Np\nb25zLnRvVmFsdWUoKEV4cHJlc3Npb25JbXBsPD8+KXRoZW5zLmdldChpKSwg\nZmFjdG9yeSwgcSk7CiAgICAgICAgICAgICAgICBleHBzW2ldID0gZmFjdG9y\neS53aGVuU2NhbGFyKHdoZW4sIGFjdGlvbik7CiAgICAgICAgICAgIH0KCiAg\nICAgICAgICAgIFZhbHVlIG90aGVyID0gRXhwcmVzc2lvbnMudG9WYWx1ZSgo\nRXhwcmVzc2lvbkltcGw8Pz4pb3RoZXJ3aXNlLCBmYWN0b3J5LCBxKTsKICAg\nICAgICAgICAgcmV0dXJuIGZhY3Rvcnkuc2ltcGxlQ2FzZUV4cHJlc3Npb24o\nY2FzZU9wZXJhbmRFeHByLCBleHBzLCBvdGhlcik7CiAgICAgICAgfQogICAg\nICAgIAogICAgICAgIHB1YmxpYyB2b2lkIGFjY2VwdFZpc2l0KENyaXRlcmlh\nRXhwcmVzc2lvblZpc2l0b3IgdmlzaXRvcikgewogICAgICAgICAgICB2aXNp\ndG9yLmVudGVyKHRoaXMpOwogICAgICAgICAgICBFeHByZXNzaW9ucy52aXNp\ndENoaWxkcmVuKHZpc2l0b3IsIGNhc2VPcGVyYW5kKTsKICAgICAgICAgICAg\nZm9yIChpbnQgaSA9IDA7IGkgPCB3aGVucy5zaXplKCk7IGkrKykgewogICAg\nICAgICAgICAgICAgRXhwcmVzc2lvbnMudmlzaXRDaGlsZHJlbih2aXNpdG9y\nLCB3aGVucy5nZXQoaSkpOwogICAgICAgICAgICAgICAgRXhwcmVzc2lvbnMu\ndmlzaXRDaGlsZHJlbih2aXNpdG9yLCB0aGVucy5nZXQoaSkpOwogICAgICAg\nICAgICB9CiAgICAgICAgICAgIEV4cHJlc3Npb25zLnZpc2l0Q2hpbGRyZW4o\ndmlzaXRvciwgb3RoZXJ3aXNlKTsKICAgICAgICAgICAgdmlzaXRvci5leGl0\nKHRoaXMpOwogICAgICAgIH0KICAgICAgICAKICAgICAgICBAT3ZlcnJpZGUK\nICAgICAgICBwdWJsaWMgU3RyaW5nQnVpbGRlciBhc1ZhbHVlKEFsaWFzQ29u\ndGV4dCBxKSB7CiAgICAgICAgICAgIFN0cmluZ0J1aWxkZXIgYnVmZmVyID0g\nbmV3IFN0cmluZ0J1aWxkZXIoIkNBU0UgIik7CiAgICAgICAgICAgIGludCBz\naXplID0gd2hlbnMuc2l6ZSgpOwogICAgICAgICAgICBmb3IgKGludCBpID0g\nMDsgaSA8IHNpemU7IGkrKykgewogICAgICAgICAgICAgICAgYnVmZmVyLmFw\ncGVuZChFeHByZXNzaW9ucy5hc1ZhbHVlKHEsICIgV0hFTiAiLCB3aGVucy5n\nZXQoaSksICIgVEhFTiAiLCB0aGVucy5nZXQoaSkpKTsKICAgICAgICAgICAg\nfQogICAgICAgICAgICBidWZmZXIuYXBwZW5kKEV4cHJlc3Npb25zLmFzVmFs\ndWUocSwgIiBFTFNFICIsIG90aGVyd2lzZSwgIiBFTkQiKSk7CiAgICAgICAg\nICAgIHJldHVybiBidWZmZXI7CiAgICAgICAgfQogICAgfQoKICAgIHB1Ymxp\nYyBzdGF0aWMgY2xhc3MgTG93ZXIgZXh0ZW5kcyBVbmFyeUZ1bmN0aW9uYWxF\neHByZXNzaW9uPFN0cmluZz4gewogICAgICAgIHB1YmxpYyBMb3dlcihFeHBy\nZXNzaW9uPFN0cmluZz4geCkgewogICAgICAgICAgICBzdXBlcihTdHJpbmcu\nY2xhc3MsIHgpOwogICAgICAgIH0KICAgICAgICAKICAgICAgICBAT3ZlcnJp\nZGUKICAgICAgICBwdWJsaWMgVmFsdWUgdG9WYWx1ZShFeHByZXNzaW9uRmFj\ndG9yeSBmYWN0b3J5LCBDcml0ZXJpYVF1ZXJ5SW1wbDw/PiBxKSB7CiAgICAg\nICAgICAgIHJldHVybiBmYWN0b3J5LnRvTG93ZXJDYXNlKEV4cHJlc3Npb25z\nLnRvVmFsdWUoZSwgZmFjdG9yeSwgcSkpOwogICAgICAgIH0KICAgICAgICAK\nICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBwdWJsaWMgU3RyaW5nQnVpbGRl\nciBhc1ZhbHVlKEFsaWFzQ29udGV4dCBxKSB7CiAgICAgICAgICAgIHJldHVy\nbiBFeHByZXNzaW9ucy5hc1ZhbHVlKHEsICJMT1dFUiIsIE9QRU5fQlJBQ0Us\nIGUsIENMT1NFX0JSQUNFKTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGlj\nIHN0YXRpYyBjbGFzcyBVcHBlciBleHRlbmRzIFVuYXJ5RnVuY3Rpb25hbEV4\ncHJlc3Npb248U3RyaW5nPiB7CiAgICAgICAgcHVibGljIFVwcGVyKEV4cHJl\nc3Npb248U3RyaW5nPiB4KSB7CiAgICAgICAgICAgIHN1cGVyKFN0cmluZy5j\nbGFzcywgeCk7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIEBPdmVycmlk\nZQogICAgICAgIHB1YmxpYyBWYWx1ZSB0b1ZhbHVlKEV4cHJlc3Npb25GYWN0\nb3J5IGZhY3RvcnksIENyaXRlcmlhUXVlcnlJbXBsPD8+IHEpIHsKICAgICAg\nICAgICAgcmV0dXJuIGZhY3RvcnkudG9VcHBlckNhc2UoRXhwcmVzc2lvbnMu\ndG9WYWx1ZShlLCBmYWN0b3J5LCBxKSk7CiAgICAgICAgfQogICAgICAgIAog\nICAgICAgIEBPdmVycmlkZQogICAgICAgIHB1YmxpYyBTdHJpbmdCdWlsZGVy\nIGFzVmFsdWUoQWxpYXNDb250ZXh0IHEpIHsKICAgICAgICAgICAgcmV0dXJu\nIEV4cHJlc3Npb25zLmFzVmFsdWUocSwgIlVQUEVSIiwgT1BFTl9CUkFDRSwg\nZSwgQ0xPU0VfQlJBQ0UpOwogICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMg\nc3RhdGljIGNsYXNzIExlbmd0aCBleHRlbmRzIFVuYXJ5RnVuY3Rpb25hbEV4\ncHJlc3Npb248SW50ZWdlcj4gewogICAgICAgIHB1YmxpYyBMZW5ndGgoRXhw\ncmVzc2lvbjxTdHJpbmc+IHgpIHsKICAgICAgICAgICAgc3VwZXIoSW50ZWdl\nci5jbGFzcywgeCk7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIEBPdmVy\ncmlkZQogICAgICAgIHB1YmxpYyBWYWx1ZSB0b1ZhbHVlKEV4cHJlc3Npb25G\nYWN0b3J5IGZhY3RvcnksIENyaXRlcmlhUXVlcnlJbXBsPD8+IHEpIHsKICAg\nICAgICAgICAgcmV0dXJuIGZhY3Rvcnkuc3RyaW5nTGVuZ3RoKEV4cHJlc3Np\nb25zLnRvVmFsdWUoZSwgZmFjdG9yeSwgcSkpOwogICAgICAgIH0KICAgICAg\nICAKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBwdWJsaWMgU3RyaW5nQnVp\nbGRlciBhc1ZhbHVlKEFsaWFzQ29udGV4dCBxKSB7CiAgICAgICAgICAgIHJl\ndHVybiBFeHByZXNzaW9ucy5hc1ZhbHVlKHEsICJMRU5HVEgiLCBPUEVOX0JS\nQUNFLCBlLCBDTE9TRV9CUkFDRSk7CiAgICAgICAgfQogICAgfQogICAgCiAg\nICBwdWJsaWMgc3RhdGljIGFic3RyYWN0IGNsYXNzIFN1YnF1ZXJ5UHJlZGlj\nYXRlPFg+IGV4dGVuZHMgUHJlZGljYXRlSW1wbCB7CiAgICAgICAgZmluYWwg\nU3VicXVlcnlJbXBsPFg+IGU7CiAgICAgICAgCiAgICAgICAgcHVibGljIFN1\nYnF1ZXJ5UHJlZGljYXRlKFN1YnF1ZXJ5PFg+IHgpIHsKICAgICAgICAgICAg\nc3VwZXIoKTsKICAgICAgICAgICAgZSA9IChTdWJxdWVyeUltcGw8WD4peDsK\nICAgICAgICB9CiAgICAgICAgCiAgICAgICAgcHVibGljIHZvaWQgYWNjZXB0\nVmlzaXQoQ3JpdGVyaWFFeHByZXNzaW9uVmlzaXRvciB2aXNpdG9yKSB7CiAg\nICAgICAgICAgIEV4cHJlc3Npb25zLmFjY2VwdFZpc2l0KHZpc2l0b3IsIHRo\naXMsIGUpOwogICAgICAgIH0KICAgIH0KICAgICAKICAgIHB1YmxpYyBzdGF0\naWMgYWJzdHJhY3QgY2xhc3MgU3VicXVlcnlFeHByZXNzaW9uPFg+IGV4dGVu\nZHMgRXhwcmVzc2lvbkltcGw8WD4gewogICAgICAgIGZpbmFsIFN1YnF1ZXJ5\nSW1wbDxYPiBlOwogICAgICAgIAogICAgICAgIHB1YmxpYyBTdWJxdWVyeUV4\ncHJlc3Npb24oU3VicXVlcnk8WD4geCkgewogICAgICAgICAgICBzdXBlcigo\nQ2xhc3M8WD4peC5nZXRKYXZhVHlwZSgpKTsKICAgICAgICAgICAgZSA9IChT\ndWJxdWVyeUltcGw8WD4peDsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAg\ncHVibGljIHZvaWQgYWNjZXB0VmlzaXQoQ3JpdGVyaWFFeHByZXNzaW9uVmlz\naXRvciB2aXNpdG9yKSB7CiAgICAgICAgICAgIEV4cHJlc3Npb25zLmFjY2Vw\ndFZpc2l0KHZpc2l0b3IsIHRoaXMsIGUpOwogICAgICAgIH0KICAgIH0KCiAg\nICBwdWJsaWMgc3RhdGljIGNsYXNzIEV4aXN0czxYPiBleHRlbmRzIFN1YnF1\nZXJ5UHJlZGljYXRlPFg+IHsKICAgICAgICBwdWJsaWMgRXhpc3RzKFN1YnF1\nZXJ5PFg+IHgpIHsKICAgICAgICAgICAgc3VwZXIoeCk7CiAgICAgICAgfQoK\nICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBvcmcuYXBhY2hlLm9wZW5qcGEu\na2VybmVsLmV4cHMuRXhwcmVzc2lvbiB0b0tlcm5lbEV4cHJlc3Npb24oCiAg\nICAgICAgICAgIEV4cHJlc3Npb25GYWN0b3J5IGZhY3RvcnksIENyaXRlcmlh\nUXVlcnlJbXBsPD8+IHEpIHsKICAgICAgICAgICAgb3JnLmFwYWNoZS5vcGVu\nanBhLmtlcm5lbC5leHBzLkV4cHJlc3Npb24gZXhpc3RzID0gCiAgICAgICAg\nICAgICAgICBmYWN0b3J5LmlzTm90RW1wdHkoRXhwcmVzc2lvbnMudG9WYWx1\nZShlLCBmYWN0b3J5LCBxKSk7CiAgICAgICAgICAgIHJldHVybiBleGlzdHM7\nCiAgICAgICAgfSAgICAgICAgCiAgICAgICAgCiAgICAgICAgQE92ZXJyaWRl\nCiAgICAgICAgcHVibGljIFN0cmluZ0J1aWxkZXIgYXNWYWx1ZShBbGlhc0Nv\nbnRleHQgcSkgewogICAgICAgICAgICByZXR1cm4gRXhwcmVzc2lvbnMuYXNW\nYWx1ZShxLCAiIEVYSVNUUyIsIE9QRU5fQlJBQ0UsIGUsIENMT1NFX0JSQUNF\nKTsKICAgICAgICB9CiAgICB9CiAgICAKICAgIHB1YmxpYyBzdGF0aWMgY2xh\nc3MgQWxsPFg+IGV4dGVuZHMgU3VicXVlcnlFeHByZXNzaW9uPFg+IHsKICAg\nICAgICBwdWJsaWMgQWxsKFN1YnF1ZXJ5PFg+IHgpIHsKICAgICAgICAgICAg\nc3VwZXIoeCk7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIEBPdmVycmlk\nZQogICAgICAgIHB1YmxpYyBWYWx1ZSB0b1ZhbHVlKEV4cHJlc3Npb25GYWN0\nb3J5IGZhY3RvcnksIENyaXRlcmlhUXVlcnlJbXBsPD8+IHEpIHsKICAgICAg\nICAgICAgcmV0dXJuIGZhY3RvcnkuYWxsKEV4cHJlc3Npb25zLnRvVmFsdWUo\nZSwgZmFjdG9yeSwgcSkpOwogICAgICAgIH0KICAgICAgICAKICAgICAgICBA\nT3ZlcnJpZGUKICAgICAgICBwdWJsaWMgU3RyaW5nQnVpbGRlciBhc1ZhbHVl\nKEFsaWFzQ29udGV4dCBxKSB7CiAgICAgICAgICAgIHJldHVybiBFeHByZXNz\naW9ucy5hc1ZhbHVlKHEsICJBTEwiLCBPUEVOX0JSQUNFLCBlLCBDTE9TRV9C\nUkFDRSk7CiAgICAgICAgfQogICAgfQoKICAgIHB1YmxpYyBzdGF0aWMgY2xh\nc3MgQW55PFg+IGV4dGVuZHMgU3VicXVlcnlFeHByZXNzaW9uPFg+IHsKICAg\nICAgICBwdWJsaWMgQW55KFN1YnF1ZXJ5PFg+IHgpIHsKICAgICAgICAgICAg\nc3VwZXIoeCk7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIEBPdmVycmlk\nZQogICAgICAgIHB1YmxpYyBWYWx1ZSB0b1ZhbHVlKEV4cHJlc3Npb25GYWN0\nb3J5IGZhY3RvcnksIENyaXRlcmlhUXVlcnlJbXBsPD8+IHEpIHsKICAgICAg\nICAgICAgcmV0dXJuIGZhY3RvcnkuYW55KEV4cHJlc3Npb25zLnRvVmFsdWUo\nZSwgZmFjdG9yeSwgcSkpOwogICAgICAgIH0KICAgICAgICAKICAgICAgICBA\nT3ZlcnJpZGUKICAgICAgICBwdWJsaWMgU3RyaW5nQnVpbGRlciBhc1ZhbHVl\nKEFsaWFzQ29udGV4dCBxKSB7CiAgICAgICAgICAgIHJldHVybiBFeHByZXNz\naW9ucy5hc1ZhbHVlKHEsICJBTlkiLCBPUEVOX0JSQUNFLCBlLCBDTE9TRV9C\nUkFDRSk7CiAgICAgICAgfQogICAgfQoKICAgIHB1YmxpYyBzdGF0aWMgY2xh\nc3MgTm90IGV4dGVuZHMgUHJlZGljYXRlSW1wbCB7CiAgICAgICAgcHJvdGVj\ndGVkIGZpbmFsIEV4cHJlc3Npb25JbXBsPEJvb2xlYW4+IGU7CiAgICAgICAg\ncHVibGljIE5vdChFeHByZXNzaW9uPEJvb2xlYW4+IG5lKSB7CiAgICAgICAg\nICAgIHN1cGVyKCk7CiAgICAgICAgICAgIGUgPSAoRXhwcmVzc2lvbkltcGw8\nQm9vbGVhbj4pbmU7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIEBPdmVy\ncmlkZQogICAgICAgIHB1YmxpYyBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVs\nLmV4cHMuRXhwcmVzc2lvbiB0b0tlcm5lbEV4cHJlc3Npb24oCiAgICAgICAg\nICBFeHByZXNzaW9uRmFjdG9yeSBmYWN0b3J5LCBDcml0ZXJpYVF1ZXJ5SW1w\nbDw/PiBxKSB7CiAgICAgICAgICAgIHJldHVybiBmYWN0b3J5Lm5vdChlLnRv\nS2VybmVsRXhwcmVzc2lvbihmYWN0b3J5LCBxKSk7CiAgICAgICAgfSAgICAg\nICAgCiAgICAgICAgCiAgICAgICAgcHVibGljIHZvaWQgYWNjZXB0VmlzaXQo\nQ3JpdGVyaWFFeHByZXNzaW9uVmlzaXRvciB2aXNpdG9yKSB7CiAgICAgICAg\nICAgIEV4cHJlc3Npb25zLmFjY2VwdFZpc2l0KHZpc2l0b3IsIHRoaXMsIGUp\nOwogICAgICAgIH0KICAgICAgICAKICAgICAgICBAT3ZlcnJpZGUKICAgICAg\nICBwdWJsaWMgU3RyaW5nQnVpbGRlciBhc1ZhbHVlKEFsaWFzQ29udGV4dCBx\nKSB7CiAgICAgICAgICAgIHJldHVybiBFeHByZXNzaW9ucy5hc1ZhbHVlKHEs\nICJOT1QgIiwgZSk7CiAgICAgICAgfQogICAgfQogICAgCiAgICBwdWJsaWMg\nc3RhdGljIGNsYXNzIENhc3RBczxZPiBleHRlbmRzIEV4cHJlc3Npb25JbXBs\nPFk+IHsKICAgICAgICBwcm90ZWN0ZWQgZmluYWwgRXhwcmVzc2lvbkltcGw8\nPz4gYWN0dWFsOwogICAgICAgIHB1YmxpYyBDYXN0QXMoQ2xhc3M8WT4gY2Fz\ndCwgRXhwcmVzc2lvbkltcGw8Pz4gYWN0dWFsKSB7CiAgICAgICAgICAgIHN1\ncGVyKGNhc3QpOwogICAgICAgICAgICB0aGlzLmFjdHVhbCA9IGFjdHVhbDsK\nICAgICAgICB9CiAgICAgICAgCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAg\ncHVibGljIG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuZXhwcy5WYWx1ZSB0\nb1ZhbHVlKEV4cHJlc3Npb25GYWN0b3J5IGZhY3RvcnksIENyaXRlcmlhUXVl\ncnlJbXBsPD8+IHEpIHsKICAgICAgICAgICAgb3JnLmFwYWNoZS5vcGVuanBh\nLmtlcm5lbC5leHBzLlZhbHVlIGUgPSBhY3R1YWwudG9WYWx1ZShmYWN0b3J5\nLCBxKTsKICAgICAgICAgICAgZS5zZXRJbXBsaWNpdFR5cGUoZ2V0SmF2YVR5\ncGUoKSk7CiAgICAgICAgICAgIHJldHVybiBlOwogICAgICAgIH0KICAgICAg\nICAKICAgICAgICBwdWJsaWMgdm9pZCBhY2NlcHRWaXNpdChDcml0ZXJpYUV4\ncHJlc3Npb25WaXNpdG9yIHZpc2l0b3IpIHsKICAgICAgICAgICAgRXhwcmVz\nc2lvbnMuYWNjZXB0VmlzaXQodmlzaXRvciwgdGhpcywgYWN0dWFsKTsKICAg\nICAgICB9CiAgICAgICAgCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgcHVi\nbGljIFN0cmluZ0J1aWxkZXIgYXNWYWx1ZShBbGlhc0NvbnRleHQgcSkgewog\nICAgICAgICAgICByZXR1cm4gYWN0dWFsLmFzVmFsdWUocSk7CiAgICAgICAg\nfQogICAgfQogICAgCiAgICAvKioKICAgICAqIEFuIGV4cHJlc3Npb24gdGhh\ndCBpcyBjb21wb3NlZCBvZiBvbmUgb3IgbW9yZSBleHByZXNzaW9ucy4KICAg\nICAqCiAgICAgKiBAcGFyYW0gPFQ+CiAgICAgKi8KICAgIHB1YmxpYyBzdGF0\naWMgY2xhc3MgTGlzdEFyZ3VtZW50PFQ+IGV4dGVuZHMgRXhwcmVzc2lvbklt\ncGw8VD4gewogICAgICAgIHByaXZhdGUgZmluYWwgRXhwcmVzc2lvbkltcGw8\nPz5bXSBfYXJnczsKICAgICAgICBwdWJsaWMgTGlzdEFyZ3VtZW50KENsYXNz\nPFQ+IGNscywgRXhwcmVzc2lvbkltcGw8Pz4uLi4gYXJncykgewogICAgICAg\nICAgICBzdXBlcihjbHMpOwogICAgICAgICAgICBfYXJncyA9IGFyZ3M7CiAg\nICAgICAgfQogICAgICAgIAogICAgICAgIEBPdmVycmlkZQogICAgICAgIHB1\nYmxpYyBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLmV4cHMuQXJndW1lbnRz\nIHRvVmFsdWUoRXhwcmVzc2lvbkZhY3RvcnkgZmFjdG9yeSwgQ3JpdGVyaWFR\ndWVyeUltcGw8Pz4gcSkgewogICAgICAgICAgICBvcmcuYXBhY2hlLm9wZW5q\ncGEua2VybmVsLmV4cHMuVmFsdWVbXSBrdnMgPSBuZXcgb3JnLmFwYWNoZS5v\ncGVuanBhLmtlcm5lbC5leHBzLlZhbHVlW19hcmdzLmxlbmd0aF07CiAgICAg\nICAgICAgIGludCBpID0gMDsKICAgICAgICAgICAgZm9yIChFeHByZXNzaW9u\nSW1wbDw/PiBhcmcgOiBfYXJncykgewogICAgICAgICAgICAgICAga3ZzW2kr\nK10gPSBhcmcudG9WYWx1ZShmYWN0b3J5LCBxKTsKICAgICAgICAgICAgfQog\nICAgICAgICAgICBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLmV4cHMuQXJn\ndW1lbnRzIGUgPSBmYWN0b3J5Lm5ld0FyZ3VtZW50TGlzdChrdnMpOwogICAg\nICAgICAgICBlLnNldEltcGxpY2l0VHlwZShnZXRKYXZhVHlwZSgpKTsKICAg\nICAgICAgICAgcmV0dXJuIGU7CiAgICAgICAgfQogICAgICAgIAogICAgICAg\nIHB1YmxpYyB2b2lkIGFjY2VwdFZpc2l0KENyaXRlcmlhRXhwcmVzc2lvblZp\nc2l0b3IgdmlzaXRvcikgewogICAgICAgICAgICBFeHByZXNzaW9ucy5hY2Nl\ncHRWaXNpdCh2aXNpdG9yLCB0aGlzLCBfYXJncyk7CiAgICAgICAgfQogICAg\nfQp9Cg==\n","encoding":"base64"}

