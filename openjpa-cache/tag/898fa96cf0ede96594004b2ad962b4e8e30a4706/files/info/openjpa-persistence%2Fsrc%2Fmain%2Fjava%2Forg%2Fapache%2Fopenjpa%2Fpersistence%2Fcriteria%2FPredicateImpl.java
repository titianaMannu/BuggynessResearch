{"sha":"654ba506788f7b54a30fea7b15c9d06f34648c8c","node_id":"MDQ6QmxvYjIwNjM2NDo2NTRiYTUwNjc4OGY3YjU0YTMwZmVhN2IxNWM5ZDA2ZjM0NjQ4Yzhj","size":7051,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/654ba506788f7b54a30fea7b15c9d06f34648c8c","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuY3JpdGVy\naWE7CgppbXBvcnQgamF2YS51dGlsLkFycmF5TGlzdDsKaW1wb3J0IGphdmEu\ndXRpbC5MaXN0OwppbXBvcnQgamF2YS51dGlsLmNvbmN1cnJlbnQuQ29weU9u\nV3JpdGVBcnJheUxpc3Q7CgppbXBvcnQgamF2YXgucGVyc2lzdGVuY2UuY3Jp\ndGVyaWEuRXhwcmVzc2lvbjsKaW1wb3J0IGphdmF4LnBlcnNpc3RlbmNlLmNy\naXRlcmlhLlByZWRpY2F0ZTsKCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\na2VybmVsLmV4cHMuRXhwcmVzc2lvbkZhY3Rvcnk7CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEua2VybmVsLmV4cHMuTGl0ZXJhbDsKCi8qKgogKiBQcmVk\naWNhdGUgaXMgYSBleHByZXNzaW9uIHRoYXQgZXZhbHVhdGVzIHRvIHRydWUg\nb3IgZmFsc2UuCiAqIEFsbCBib29sZWFuIGV4cHJlc3Npb25zIGFyZSBpbXBs\nZW1lbnRlZCBhcyBQcmVkaWNhdGUuCiAqIEEgcHJlZGljYXRlIGNhbiBoYXZl\nIHplcm8gb3IgbW9yZSBwcmVkaWNhdGUgYXJndW1lbnRzLgogKiBEZWZhdWx0\nIHByZWRpY2F0ZSBvcGVyYXRvciBpcyBBTkQgKGNvbmp1bmN0aW9uKS4KICog\nVHdvIGNvbnN0YW50IHByZWRpY2F0ZXMgYXJlIFByZWRpY2F0ZS5UUlVFIGFu\nZCBQcmVkaWNhdGUuRkFMU0UuCiAqIEFORCBwcmVkaWNhdGUgd2l0aCBubyBh\ncmd1bWVudCBldmFsdWF0ZXMgdG8gVFJVRS4KICogT1IgcHJlZGljYXRlIHdp\ndGggbm8gYXJndW1lbnQgZXZhbHVhdGVzIHRvIEZBTFNFLgogKiBOZWdhdGlv\nbiBvZiBhIFByZWRpY2F0ZSBjcmVhdGVzIGEgbmV3IFByZWRpY2F0ZS4KICog\nCiAqIEBhdXRob3IgUGluYWtpIFBvZGRhcgogKiBAYXV0aG9yIEZheSBXYW5n\nCiAqIAogKiBAc2luY2UgMi4wLjAKICovCmFic3RyYWN0IGNsYXNzIFByZWRp\nY2F0ZUltcGwgZXh0ZW5kcyBFeHByZXNzaW9uSW1wbDxCb29sZWFuPiBpbXBs\nZW1lbnRzIFByZWRpY2F0ZSB7CiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBF\neHByZXNzaW9uSW1wbDxJbnRlZ2VyPiBPTkUgID0gbmV3IEV4cHJlc3Npb25z\nLkNvbnN0YW50PEludGVnZXI+KDEpOwogICAgcHVibGljIHN0YXRpYyBmaW5h\nbCBQcmVkaWNhdGUgVFJVRSAgPSBuZXcgRXhwcmVzc2lvbnMuRXF1YWwoT05F\nLE9ORSk7CiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIFByZWRpY2F0ZSBGQUxT\nRSA9IG5ldyBFeHByZXNzaW9ucy5Ob3RFcXVhbChPTkUsT05FKTsKICAgIAog\nICAgcHJvdGVjdGVkIGZpbmFsIExpc3Q8UHJlZGljYXRlPiBfZXhwcyA9IG5l\ndyBBcnJheUxpc3Q8UHJlZGljYXRlPigpOwogICAgcHJpdmF0ZSBmaW5hbCBC\nb29sZWFuT3BlcmF0b3IgX29wOwogICAgcHJpdmF0ZSBib29sZWFuIF9uZWdh\ndGVkID0gZmFsc2U7CgogICAgLyoqCiAgICAgKiBBbiBBTkQgcHJlZGljYXRl\nIHdpdGggbm8gYXJndW1lbnRzLgogICAgICovCiAgICBwcm90ZWN0ZWQgUHJl\nZGljYXRlSW1wbCgpIHsKICAgICAgICB0aGlzKEJvb2xlYW5PcGVyYXRvci5B\nTkQpOwogICAgfQogICAgCiAgICAvKioKICAgICAqIEEgcHJlZGljYXRlIHdp\ndGggdGhlIGdpdmVuIG9wZXJhdG9yLgogICAgICovCiAgICBwcm90ZWN0ZWQg\nUHJlZGljYXRlSW1wbChCb29sZWFuT3BlcmF0b3Igb3ApIHsKICAgICAgICBz\ndXBlcihCb29sZWFuLmNsYXNzKTsKICAgICAgICBfb3AgPSBvcDsKICAgIH0K\nCiAgICAvKioKICAgICAqIEEgcHJlZGljYXRlIG9mIGdpdmVuIG9wZXJhdG9y\nIHdpdGggZ2l2ZW4gYXJndW1lbnRzLgogICAgICovCiAgICBwcm90ZWN0ZWQg\nUHJlZGljYXRlSW1wbChCb29sZWFuT3BlcmF0b3Igb3AsIFByZWRpY2F0ZS4u\nLnJlc3RyaWN0aW9ucykgewogICAgICAgIHRoaXMob3ApOwogICAgICAgIGlm\nIChyZXN0cmljdGlvbnMgIT0gbnVsbCkgewogICAgICAgICAgICBmb3IgKFBy\nZWRpY2F0ZSBwIDogcmVzdHJpY3Rpb25zKQogICAgICAgICAgICAgICAgYWRk\nKHApOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIEFkZHMgdGhl\nIGdpdmVuIHByZWRpY2F0ZSBleHByZXNzaW9uLgogICAgICovCiAgICBwdWJs\naWMgUHJlZGljYXRlSW1wbCBhZGQoRXhwcmVzc2lvbjxCb29sZWFuPiBzKSB7\nCiAgICAgICAgX2V4cHMuYWRkKChQcmVkaWNhdGUpcyk7IC8vIGFsbCBib29s\nZWFuIGV4cHJlc3Npb25zIGFyZSBQcmVkaWNhdGUKICAgICAgICByZXR1cm4g\ndGhpczsKICAgIH0KCiAgICBwdWJsaWMgTGlzdDxFeHByZXNzaW9uPEJvb2xl\nYW4+PiBnZXRFeHByZXNzaW9ucygpIHsKICAgICAgICBMaXN0PEV4cHJlc3Np\nb248Qm9vbGVhbj4+IHJlc3VsdCA9IG5ldyBDb3B5T25Xcml0ZUFycmF5TGlz\ndDxFeHByZXNzaW9uPEJvb2xlYW4+PigpOwogICAgICAgIGlmIChfZXhwcy5p\nc0VtcHR5KCkpCiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7CiAgICAgICAg\ncmVzdWx0LmFkZEFsbChfZXhwcyk7CiAgICAgICAgcmV0dXJuIHJlc3VsdDsK\nICAgIH0KCiAgICBwdWJsaWMgZmluYWwgQm9vbGVhbk9wZXJhdG9yIGdldE9w\nZXJhdG9yKCkgewogICAgICAgIHJldHVybiBfb3A7CiAgICB9CiAgICAKICAg\nIHB1YmxpYyBmaW5hbCBib29sZWFuIGlzRW1wdHkoKSB7CiAgICAgICAgcmV0\ndXJuIF9leHBzLmlzRW1wdHkoKTsKICAgIH0KCiAgICAvKioKICAgICAqIElz\nIHRoaXMgcHJlZGljYXRlIGNyZWF0ZWQgYnkgbmVnYXRpbmcgYW5vdGhlciBw\ncmVkaWNhdGU/CiAgICAgKi8KICAgIHB1YmxpYyBmaW5hbCBib29sZWFuIGlz\nTmVnYXRlZCgpIHsKICAgICAgICByZXR1cm4gX25lZ2F0ZWQ7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBSZXR1cm5zIGEgbmV3IHByZWRpY2F0ZSBhcyB0aGUg\nbmVnYXRpb24gb2YgdGhpcyBwcmVkaWNhdGUuIAogICAgICogPGJyPgogICAg\nICogTm90ZToKICAgICAqIERlZmF1bHQgbmVnYXRpb24gY3JlYXRlcyBhIE5v\ndCBleHByZXNzaW9uIHdpdGggdGhpcyByZWNlaXZlciBhcyBkZWxlZ2F0ZS4K\nICAgICAqIERlcml2ZWQgcHJlZGljYXRlcyBjYW4gcmV0dXJuIHRoZSBpbnZl\ncnNlIGV4cHJlc3Npb24sIGlmIGV4aXN0cy4KICAgICAqIEZvciBleGFtcGxl\nLCBOb3RFcXVhbCBmb3IgRXF1YWwgb3IgTGVzc1RoYW4gZm9yIEdyZWF0ZXJU\naGFuRXF1YWwgZXRjLgogICAgICovCiAgICBwdWJsaWMgUHJlZGljYXRlSW1w\nbCBub3QoKSB7CiAgICAgICAgcmV0dXJuIG5ldyBFeHByZXNzaW9ucy5Ob3Qo\ndGhpcykubWFya05lZ2F0ZWQoKTsKICAgIH0KICAgIAogICAgcHJvdGVjdGVk\nIFByZWRpY2F0ZUltcGwgbWFya05lZ2F0ZWQoKSB7CiAgICAgICAgX25lZ2F0\nZWQgPSB0cnVlOwogICAgICAgIHJldHVybiB0aGlzOwogICAgfQogICAgCiAg\nICBAT3ZlcnJpZGUKICAgIG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuZXhw\ncy5WYWx1ZSB0b1ZhbHVlKEV4cHJlc3Npb25GYWN0b3J5IGZhY3RvcnksIENy\naXRlcmlhUXVlcnlJbXBsPD8+IHEpIHsKICAgICAgICBpZiAoX2V4cHMuaXNF\nbXB0eSgpKSB7CiAgICAgICAgICAgIHJldHVybiBmYWN0b3J5Lm5ld0xpdGVy\nYWwoX29wID09IEJvb2xlYW5PcGVyYXRvci5BTkQsIExpdGVyYWwuVFlQRV9C\nT09MRUFOKTsKICAgICAgICB9CiAgICAgICAgdGhyb3cgbmV3IEFic3RyYWN0\nTWV0aG9kRXJyb3IodGhpcy5nZXRDbGFzcygpLmdldE5hbWUoKSk7CiAgICB9\nCiAgICAKICAgIEBPdmVycmlkZQogICAgb3JnLmFwYWNoZS5vcGVuanBhLmtl\ncm5lbC5leHBzLkV4cHJlc3Npb24gdG9LZXJuZWxFeHByZXNzaW9uKEV4cHJl\nc3Npb25GYWN0b3J5IGZhY3RvcnksIENyaXRlcmlhUXVlcnlJbXBsPD8+IHEp\nIHsKICAgICAgICBpZiAoX2V4cHMuaXNFbXB0eSgpKSB7CiAgICAgICAgICAg\nIFByZWRpY2F0ZSBuaWwgPSBfb3AgPT0gQm9vbGVhbk9wZXJhdG9yLkFORCA/\nIFRSVUUgOiBGQUxTRTsKICAgICAgICAgICAgcmV0dXJuICgoUHJlZGljYXRl\nSW1wbCluaWwpLnRvS2VybmVsRXhwcmVzc2lvbihmYWN0b3J5LCBxKTsKICAg\nICAgICB9CiAgICAgICAgaWYgKF9leHBzLnNpemUoKSA9PSAxKSB7CiAgICAg\nICAgICAgIFByZWRpY2F0ZSBlMCA9IF9leHBzLmdldCgwKTsKICAgICAgICAg\nICAgaWYgKGlzTmVnYXRlZCgpKQogICAgICAgICAgICAgICAgZTAgPSBlMC5u\nb3QoKTsKICAgICAgICAgICAgcmV0dXJuICgoUHJlZGljYXRlSW1wbCllMCku\ndG9LZXJuZWxFeHByZXNzaW9uKGZhY3RvcnksIHEpOwogICAgICAgIH0KICAg\nICAgICAKICAgICAgICBFeHByZXNzaW9uSW1wbDw/PiBlMSA9IChFeHByZXNz\naW9uSW1wbDw/PilfZXhwcy5nZXQoMCk7CiAgICAgICAgRXhwcmVzc2lvbklt\ncGw8Pz4gZTIgPSAoRXhwcmVzc2lvbkltcGw8Pz4pX2V4cHMuZ2V0KDEpOwog\nICAgICAgIG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuZXhwcy5FeHByZXNz\naW9uIGtlMSA9IGUxLnRvS2VybmVsRXhwcmVzc2lvbihmYWN0b3J5LCBxKTsK\nICAgICAgICBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLmV4cHMuRXhwcmVz\nc2lvbiBrZTIgPSBlMi50b0tlcm5lbEV4cHJlc3Npb24oZmFjdG9yeSwgcSk7\nCiAgICAgICAgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5leHBzLkV4cHJl\nc3Npb24gcmVzdWx0ID0gX29wID09IEJvb2xlYW5PcGVyYXRvci5BTkQgCiAg\nICAgICAgICAgID8gZmFjdG9yeS5hbmQoa2UxLGtlMikgOiBmYWN0b3J5Lm9y\nKGtlMSwga2UyKTsKCiAgICAgICAgZm9yIChpbnQgaSA9IDI7IGkgPCBfZXhw\ncy5zaXplKCk7IGkrKykgewogICAgICAgICAgICBQcmVkaWNhdGVJbXBsIHAg\nPSAoUHJlZGljYXRlSW1wbClfZXhwcy5nZXQoaSk7CiAgICAgICAgICAgIHJl\nc3VsdCA9IF9vcCA9PSBCb29sZWFuT3BlcmF0b3IuQU5EIAogICAgICAgICAg\nICAgID8gZmFjdG9yeS5hbmQocmVzdWx0LCBwLnRvS2VybmVsRXhwcmVzc2lv\nbihmYWN0b3J5LCBxKSkKICAgICAgICAgICAgICA6IGZhY3Rvcnkub3IocmVz\ndWx0LCBwLnRvS2VybmVsRXhwcmVzc2lvbihmYWN0b3J5LHEpKTsKICAgICAg\nICB9CiAgICAgICAgcmV0dXJuIF9uZWdhdGVkID8gZmFjdG9yeS5ub3QocmVz\ndWx0KSA6IHJlc3VsdDsKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHB1Ymxp\nYyB2b2lkIGFjY2VwdFZpc2l0KENyaXRlcmlhRXhwcmVzc2lvblZpc2l0b3Ig\ndmlzaXRvcikgewogICAgICAgIEV4cHJlc3Npb25zLmFjY2VwdFZpc2l0KHZp\nc2l0b3IsIHRoaXMsIF9leHBzLnRvQXJyYXkobmV3IEV4cHJlc3Npb248Pz5b\nX2V4cHMuc2l6ZSgpXSkpOwogICAgfQogICAgCiAgICBAT3ZlcnJpZGUKICAg\nIHB1YmxpYyBTdHJpbmdCdWlsZGVyIGFzVmFsdWUoQWxpYXNDb250ZXh0IHEp\nIHsKICAgICAgICBib29sZWFuIGJyYWNlcyA9IF9leHBzLnNpemUoKSA+IDE7\nCiAgICAgICAgU3RyaW5nQnVpbGRlciBidWZmZXIgPSAgRXhwcmVzc2lvbnMu\nYXNWYWx1ZShxLCBfZXhwcy50b0FycmF5KG5ldyBFeHByZXNzaW9uPD8+W19l\neHBzLnNpemUoKV0pLCAiICIgK19vcCArICIgIik7CiAgICAgICAgaWYgKGJy\nYWNlcykgYnVmZmVyLmluc2VydCgwLCAiKCIpLmFwcGVuZCgiKSIpOwogICAg\nICAgIGlmIChpc05lZ2F0ZWQoKSkgYnVmZmVyLmluc2VydCgwLCAiTk9UICIp\nOwogICAgICAgIHJldHVybiBidWZmZXI7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBDb25jcmV0ZSBBTkQgcHJlZGljYXRlLgogICAgICoKICAgICAqLwogICAg\nc3RhdGljIGNsYXNzIEFuZCBleHRlbmRzIFByZWRpY2F0ZUltcGwgewogICAg\nICAgIHB1YmxpYyBBbmQoRXhwcmVzc2lvbjxCb29sZWFuPiB4LCBFeHByZXNz\naW9uPEJvb2xlYW4+IHkpIHsKICAgICAgICAgICAgc3VwZXIoQm9vbGVhbk9w\nZXJhdG9yLkFORCk7CiAgICAgICAgICAgIGFkZCh4KS5hZGQoeSk7CiAgICAg\nICAgfQoKICAgICAgICBwdWJsaWMgQW5kKFByZWRpY2F0ZS4uLnJlc3RyaWN0\naW9ucykgewogICAgICAgICAgICBzdXBlcihCb29sZWFuT3BlcmF0b3IuQU5E\nLCByZXN0cmljdGlvbnMpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAg\nICAqIENvbmNyZXRlIE9SIHByZWRpY2F0ZS4KICAgICAqCiAgICAgKi8KICAg\nIHN0YXRpYyBjbGFzcyBPciBleHRlbmRzIFByZWRpY2F0ZUltcGwgewogICAg\nICAgIHB1YmxpYyBPcihFeHByZXNzaW9uPEJvb2xlYW4+IHgsIEV4cHJlc3Np\nb248Qm9vbGVhbj4geSkgewogICAgICAgICAgICBzdXBlcihCb29sZWFuT3Bl\ncmF0b3IuT1IpOwogICAgICAgICAgICBhZGQoeCkuYWRkKHkpOwogICAgICAg\nIH0KCiAgICAgICAgcHVibGljIE9yKFByZWRpY2F0ZS4uLnJlc3RyaWN0aW9u\ncykgewogICAgICAgICAgICBzdXBlcihCb29sZWFuT3BlcmF0b3IuT1IsIHJl\nc3RyaWN0aW9ucyk7CiAgICAgICAgfQogICAgfQp9Cg==\n","encoding":"base64"}

