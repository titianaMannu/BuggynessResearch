{"sha":"7504296fa335fc1a31423dbcb5b8473338edbbb6","node_id":"MDQ6QmxvYjIwNjM2NDo3NTA0Mjk2ZmEzMzVmYzFhMzE0MjNkYmNiNWI4NDczMzM4ZWRiYmI2","size":27257,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/7504296fa335fc1a31423dbcb5b8473338edbbb6","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNr\nYWdlIG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5tZXRhOwoKaW1w\nb3J0IGphdmEubGFuZy5hbm5vdGF0aW9uLkFubm90YXRpb247CmltcG9ydCBq\nYXZhLnV0aWwuQXJyYXlMaXN0OwppbXBvcnQgamF2YS51dGlsLkNvbGxlY3Rp\nb247CmltcG9ydCBqYXZhLnV0aWwuSGFzaFNldDsKaW1wb3J0IGphdmEudXRp\nbC5MaXN0OwppbXBvcnQgamF2YS51dGlsLk1hcDsKaW1wb3J0IGphdmEudXRp\nbC5TZXQ7CgppbXBvcnQgamF2YXguYW5ub3RhdGlvbi5wcm9jZXNzaW5nLlBy\nb2Nlc3NpbmdFbnZpcm9ubWVudDsKaW1wb3J0IGphdmF4LmxhbmcubW9kZWwu\nZWxlbWVudC5Bbm5vdGF0aW9uTWlycm9yOwppbXBvcnQgamF2YXgubGFuZy5t\nb2RlbC5lbGVtZW50LkFubm90YXRpb25WYWx1ZTsKaW1wb3J0IGphdmF4Lmxh\nbmcubW9kZWwuZWxlbWVudC5FbGVtZW50OwppbXBvcnQgamF2YXgubGFuZy5t\nb2RlbC5lbGVtZW50LkVsZW1lbnRLaW5kOwppbXBvcnQgamF2YXgubGFuZy5t\nb2RlbC5lbGVtZW50LkV4ZWN1dGFibGVFbGVtZW50OwppbXBvcnQgamF2YXgu\nbGFuZy5tb2RlbC5lbGVtZW50Lk1vZGlmaWVyOwppbXBvcnQgamF2YXgubGFu\nZy5tb2RlbC5lbGVtZW50LlR5cGVFbGVtZW50OwppbXBvcnQgamF2YXgubGFu\nZy5tb2RlbC5lbGVtZW50LlZhcmlhYmxlRWxlbWVudDsKaW1wb3J0IGphdmF4\nLmxhbmcubW9kZWwudHlwZS5BcnJheVR5cGU7CmltcG9ydCBqYXZheC5sYW5n\nLm1vZGVsLnR5cGUuRGVjbGFyZWRUeXBlOwppbXBvcnQgamF2YXgubGFuZy5t\nb2RlbC50eXBlLlByaW1pdGl2ZVR5cGU7CmltcG9ydCBqYXZheC5sYW5nLm1v\nZGVsLnR5cGUuVHlwZUtpbmQ7CmltcG9ydCBqYXZheC5sYW5nLm1vZGVsLnR5\ncGUuVHlwZU1pcnJvcjsKaW1wb3J0IGphdmF4LmxhbmcubW9kZWwudXRpbC5U\neXBlczsKaW1wb3J0IGphdmF4LnBlcnNpc3RlbmNlLkFjY2VzczsKaW1wb3J0\nIGphdmF4LnBlcnNpc3RlbmNlLkFjY2Vzc1R5cGU7CmltcG9ydCBzdGF0aWMg\namF2YXgucGVyc2lzdGVuY2UuQWNjZXNzVHlwZS4qOwoKaW1wb3J0IGphdmF4\nLnBlcnNpc3RlbmNlLkVtYmVkZGFibGU7CmltcG9ydCBqYXZheC5wZXJzaXN0\nZW5jZS5FbnRpdHk7CmltcG9ydCBqYXZheC5wZXJzaXN0ZW5jZS5NYW55VG9N\nYW55OwppbXBvcnQgamF2YXgucGVyc2lzdGVuY2UuTWFueVRvT25lOwppbXBv\ncnQgamF2YXgucGVyc2lzdGVuY2UuTWFwcGVkU3VwZXJjbGFzczsKaW1wb3J0\nIGphdmF4LnBlcnNpc3RlbmNlLk9uZVRvTWFueTsKaW1wb3J0IGphdmF4LnBl\ncnNpc3RlbmNlLk9uZVRvT25lOwppbXBvcnQgamF2YXgucGVyc2lzdGVuY2Uu\nVHJhbnNpZW50OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51dGls\nLkxvY2FsaXplcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRhLkFj\nY2Vzc0NvZGU7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5Vc2Vy\nRXhjZXB0aW9uOwoKLyoqCiAqIEV4dHJhY3RzIHBlcnNpc3RlbnQgbWV0YWRh\ndGEgaW5mb3JtYXRpb24gYnkgYW5hbHl6aW5nIGF2YWlsYWJsZSBhbm5vdGF0\naW9uCiAqIGluICouamF2YSBzb3VyY2UgZmlsZXMuIFJlcXVpcmVzIEpESzYg\nQW5ub3RhdGlvbiBQcm9jZXNzaW5nIGVudmlyb25tZW50CiAqIGF2YWlsYWJs\nZS4KICogICAKICogQGF1dGhvciBQaW5ha2kgUG9kZGFyCiAqIEBzaW5jZSAy\nLjAuMAogKi8KcHVibGljIGNsYXNzIFNvdXJjZUFubm90YXRpb25IYW5kbGVy\nIAogICAgaW1wbGVtZW50cyBNZXRhZGF0YVByb2Nlc3NvcjxUeXBlRWxlbWVu\ndCwgRWxlbWVudD4gewoJCglwcml2YXRlIGZpbmFsIFByb2Nlc3NpbmdFbnZp\ncm9ubWVudCBwcm9jZXNzaW5nRW52OwoJcHJpdmF0ZSBmaW5hbCBUeXBlcyB0\neXBlVXRpbGl0eTsKCXByaXZhdGUgZmluYWwgQ29tcGlsZVRpbWVMb2dnZXIg\nbG9nZ2VyOwoJLyoqCiAgICAgKiBTZXQgb2YgSW5jbHVzaW9uIEZpbHRlcnMg\nYmFzZWQgb24gbWVtYmVyIHR5cGUsIGFjY2VzcyB0eXBlIG9yIHRyYW5zaWVu\ndAogICAgICogYW5ub3RhdGlvbnMuIFVzZWQgdG8gZGV0ZXJtaW5lIHRoZSBz\ndWJzZXQgb2YgYXZhaWxhYmxlIGZpZWxkL21ldGhvZCB0aGF0IAogICAgICog\nYXJlIHBlcnNpc3RlbnQuICAgCiAgICAgKi8KICAgIHByb3RlY3RlZCBBY2Nl\nc3NGaWx0ZXIgcHJvcGVydHlBY2Nlc3NGaWx0ZXIgPSBuZXcgQWNjZXNzRmls\ndGVyKFBST1BFUlRZKTsKICAgIHByb3RlY3RlZCBBY2Nlc3NGaWx0ZXIgZmll\nbGRBY2Nlc3NGaWx0ZXIgPSBuZXcgQWNjZXNzRmlsdGVyKEZJRUxEKTsKCiAg\nICBwcm90ZWN0ZWQgS2luZEZpbHRlciBmaWVsZEZpbHRlciAgPSBuZXcgS2lu\nZEZpbHRlcihFbGVtZW50S2luZC5GSUVMRCk7CiAgICBwcm90ZWN0ZWQgS2lu\nZEZpbHRlciBtZXRob2RGaWx0ZXIgPSBuZXcgS2luZEZpbHRlcihFbGVtZW50\nS2luZC5NRVRIT0QpOwogICAgcHJvdGVjdGVkIFRyYW5zaWVudEZpbHRlciBu\nb25UcmFuc2llbnRGaWx0ZXIgPSBuZXcgVHJhbnNpZW50RmlsdGVyKCk7CiAg\nICBwcm90ZWN0ZWQgQW5ub3RhdGVkRmlsdGVyIGFubm90YXRlZEZpbHRlciA9\nIG5ldyBBbm5vdGF0ZWRGaWx0ZXIoKTsKICAgIHByb3RlY3RlZCBHZXR0ZXJG\naWx0ZXIgZ2V0dGVyRmlsdGVyID0gbmV3IEdldHRlckZpbHRlcigpOwogICAg\ncHJvdGVjdGVkIFNldHRlckZpbHRlciBzZXR0ZXJGaWx0ZXIgPSBuZXcgU2V0\ndGVyRmlsdGVyKCk7CiAgICAKICAgIHByb3RlY3RlZCBzdGF0aWMgTGlzdDxD\nbGFzczw/IGV4dGVuZHMgQW5ub3RhdGlvbj4+IG1hcHBpbmdBbm5vcyA9IG5l\ndyBBcnJheUxpc3Q8Q2xhc3M8PyBleHRlbmRzIEFubm90YXRpb24+PigpOwog\nICAgc3RhdGljIHsKICAgICAgICBtYXBwaW5nQW5ub3MuYWRkKE9uZVRvT25l\nLmNsYXNzKTsKICAgICAgICBtYXBwaW5nQW5ub3MuYWRkKE9uZVRvTWFueS5j\nbGFzcyk7CiAgICAgICAgbWFwcGluZ0Fubm9zLmFkZChNYW55VG9PbmUuY2xh\nc3MpOwogICAgICAgIG1hcHBpbmdBbm5vcy5hZGQoTWFueVRvTWFueS5jbGFz\ncyk7CiAgICB9CiAgICBwcml2YXRlIHN0YXRpYyBMb2NhbGl6ZXIgX2xvYyA9\nIExvY2FsaXplci5mb3JQYWNrYWdlKFNvdXJjZUFubm90YXRpb25IYW5kbGVy\nLmNsYXNzKTsKICAgIAoJLyoqCgkgKiBDb25zdHJ1Y3Qgd2l0aCBKREs2IGFu\nbm90YXRpb24gcHJvY2Vzc2luZyBlbnZpcm9ubWVudC4KCSAqIAoJICovCiAg\nICBwdWJsaWMgU291cmNlQW5ub3RhdGlvbkhhbmRsZXIoUHJvY2Vzc2luZ0Vu\ndmlyb25tZW50IHByb2Nlc3NpbmdFbnYsIAogICAgICAgIENvbXBpbGVUaW1l\nTG9nZ2VyIGxvZ2dlcikgewoJCXN1cGVyKCk7CgkJdGhpcy5wcm9jZXNzaW5n\nRW52ID0gcHJvY2Vzc2luZ0VudjsKCQl0aGlzLnR5cGVVdGlsaXR5ICAgPSBw\ncm9jZXNzaW5nRW52LmdldFR5cGVVdGlscygpOwoJCXRoaXMubG9nZ2VyID0g\nbG9nZ2VyOwoJfQoKCXB1YmxpYyBpbnQgZGV0ZXJtaW5lVHlwZUFjY2VzcyhU\neXBlRWxlbWVudCB0eXBlKSB7CiAgICAgICAgQWNjZXNzVHlwZSBhY2Nlc3Mg\nPSBnZXRFeHBsaWNpdEFjY2Vzc1R5cGUodHlwZSk7CiAgICAgICAgYm9vbGVh\nbiBpc0V4cGxpY2l0ID0gYWNjZXNzICE9IG51bGw7CiAgICAgICAgcmV0dXJu\nIGlzRXhwbGljaXQgPyBhY2Nlc3MgPT0gQWNjZXNzVHlwZS5GSUVMRCAKICAg\nICAgICAgICAgICAgID8gQWNjZXNzQ29kZS5FWFBMSUNJVCB8IEFjY2Vzc0Nv\nZGUuRklFTEQKICAgICAgICAgICAgICAgIDogQWNjZXNzQ29kZS5FWFBMSUNJ\nVCB8IEFjY2Vzc0NvZGUuUFJPUEVSVFkKICAgICAgICAgICAgICAgIDogZ2V0\nSW1wbGljaXRBY2Nlc3NUeXBlKHR5cGUpOwoJfQoJCglwdWJsaWMgaW50IGRl\ndGVybWluZU1lbWJlckFjY2VzcyhFbGVtZW50IG0pIHsKCQlyZXR1cm4gMDsK\nCX0KCglwdWJsaWMgTGlzdDxFeGNlcHRpb24+IHZhbGlkYXRlQWNjZXNzKFR5\ncGVFbGVtZW50IHQpIHsKCQlyZXR1cm4gbnVsbDsKCX0KCQoJcHVibGljIGJv\nb2xlYW4gaXNNaXhlZEFjY2VzcyhUeXBlRWxlbWVudCB0KSB7CgkJcmV0dXJu\nIGZhbHNlOwoJfQogICAgLyoqCiAgICAgKiBHZXRzIHRoZSBsaXN0IG9mIHBl\ncnNpc3RlbnQgZmllbGRzIGFuZC9vciBtZXRob2RzIGZvciB0aGUgZ2l2ZW4g\ndHlwZS4KICAgICAqIAogICAgICogU2NhbnMgcmVsZXZhbnQgQEFjY2Vzc1R5\ncGUgYW5ub3RhdGlvbiBhbmQgZmllbGQvbWV0aG9kIGFzIHBlciBKUEEKICAg\nICAqIHNwZWNpZmljYXRpb24gdG8gZGV0ZXJtaW5lIHRoZSBjYW5kaWRhdGUg\nc2V0IG9mIGZpZWxkL21ldGhvZHMuCiAgICAgKi8KCQogICAgcHVibGljIFNl\ndDxFbGVtZW50PiBnZXRQZXJzaXN0ZW50TWVtYmVycyhUeXBlRWxlbWVudCB0\neXBlKSB7CiAgICAgICAgaW50IGFjY2VzcyA9IGRldGVybWluZVR5cGVBY2Nl\nc3ModHlwZSk7CiAgICAgICAgaWYgKEFjY2Vzc0NvZGUuaXNFeHBsaWNpdChh\nY2Nlc3MpKSB7CiAgICAgICAgICAgIHJldHVybiBBY2Nlc3NDb2RlLmlzRmll\nbGQoYWNjZXNzKSAKICAgICAgICAgICAgICAgID8gZ2V0RmllbGRBY2Nlc3NQ\nZXJzaXN0ZW50TWVtYmVycyh0eXBlKSAKICAgICAgICAJCTogZ2V0UHJvcGVy\ndHlBY2Nlc3NQZXJzaXN0ZW50TWVtYmVycyh0eXBlKTsKICAgICAgICB9CiAg\nICAgICAgcmV0dXJuIGdldERlZmF1bHRBY2Nlc3NQZXJzaXN0ZW50TWVtYmVy\ncyh0eXBlLCBhY2Nlc3MpOwogICAgfQogICAgCiAgICAvKioKICAgICAqIENv\nbGxlY3QgbWVtYmVycyBmb3IgdGhlIGdpdmVuIHR5cGUgd2hpY2ggdXNlcyBl\neHBsaWNpdCBmaWVsZCBhY2Nlc3MuCiAgICAgKi8KICAgIHByaXZhdGUgU2V0\nPEVsZW1lbnQ+IGdldEZpZWxkQWNjZXNzUGVyc2lzdGVudE1lbWJlcnMoVHlw\nZUVsZW1lbnQgdHlwZSkgeyAgIAogICAgICAgIExpc3Q8PyBleHRlbmRzIEVs\nZW1lbnQ+IGFsbE1lbWJlcnMgPSB0eXBlLmdldEVuY2xvc2VkRWxlbWVudHMo\nKTsgICAgICAgCiAgICAgICAgU2V0PFZhcmlhYmxlRWxlbWVudD4gYWxsRmll\nbGRzID0gKFNldDxWYXJpYWJsZUVsZW1lbnQ+KSAKICAgICAgICAgICBmaWx0\nZXIoYWxsTWVtYmVycywgZmllbGRGaWx0ZXIsIG5vblRyYW5zaWVudEZpbHRl\ncik7CiAgICAgICAgU2V0PEV4ZWN1dGFibGVFbGVtZW50PiBhbGxNZXRob2Rz\nID0gKFNldDxFeGVjdXRhYmxlRWxlbWVudD4pIAogICAgICAgICAgICBmaWx0\nZXIoYWxsTWVtYmVycywgbWV0aG9kRmlsdGVyLCBub25UcmFuc2llbnRGaWx0\nZXIpOwogICAgICAgIFNldDxFeGVjdXRhYmxlRWxlbWVudD4gZ2V0dGVycyA9\nIGZpbHRlcihhbGxNZXRob2RzLCBnZXR0ZXJGaWx0ZXIsIAogICAgICAgIAkJ\ncHJvcGVydHlBY2Nlc3NGaWx0ZXIsIGFubm90YXRlZEZpbHRlcik7CiAgICAg\nICAgU2V0PEV4ZWN1dGFibGVFbGVtZW50PiBzZXR0ZXJzID0gZmlsdGVyKGFs\nbE1ldGhvZHMsIHNldHRlckZpbHRlcik7CiAgICAgICAgZ2V0dGVycyA9IG1h\ndGNoR2V0dGVyQW5kU2V0dGVyKGdldHRlcnMsIHNldHRlcnMpOwogICAgICAg\nIAogICAgICAgIHJldHVybiBtZXJnZShnZXR0ZXJzLCBhbGxGaWVsZHMpOwog\nICAgfQogICAgCiAgICAvKioKICAgICAqIENvbGxlY3QgbWVtYmVycyBmb3Ig\ndGhlIGdpdmVuIHR5cGUgd2hpY2ggdXNlcyBleHBsaWNpdCBmaWVsZCBhY2Nl\nc3MuCiAgICAgKi8KICAgICBwcml2YXRlIFNldDxFbGVtZW50PiBnZXRQcm9w\nZXJ0eUFjY2Vzc1BlcnNpc3RlbnRNZW1iZXJzKFR5cGVFbGVtZW50IHR5cGUp\nCiAgICAgewogICAgICAgIExpc3Q8PyBleHRlbmRzIEVsZW1lbnQ+IGFsbE1l\nbWJlcnMgPSB0eXBlLmdldEVuY2xvc2VkRWxlbWVudHMoKTsKICAgICAgICBT\nZXQ8RXhlY3V0YWJsZUVsZW1lbnQ+IGFsbE1ldGhvZHMgPSAoU2V0PEV4ZWN1\ndGFibGVFbGVtZW50PikgCiAgICAgICAgICAgIGZpbHRlcihhbGxNZW1iZXJz\nLCBtZXRob2RGaWx0ZXIsIG5vblRyYW5zaWVudEZpbHRlcik7CgogICAgICAg\nIFNldDxFeGVjdXRhYmxlRWxlbWVudD4gZ2V0dGVycyA9IGZpbHRlcihhbGxN\nZXRob2RzLCBnZXR0ZXJGaWx0ZXIpOwogICAgICAgIFNldDxFeGVjdXRhYmxl\nRWxlbWVudD4gc2V0dGVycyA9IGZpbHRlcihhbGxNZXRob2RzLCBzZXR0ZXJG\naWx0ZXIpOwogICAgICAgIGdldHRlcnMgPSBtYXRjaEdldHRlckFuZFNldHRl\ncihnZXR0ZXJzLCBzZXR0ZXJzKTsKICAgICAgICAKICAgICAgICByZXR1cm4g\nbWVyZ2UoZmlsdGVyKGFsbE1lbWJlcnMsIGZpZWxkRmlsdGVyLCBub25UcmFu\nc2llbnRGaWx0ZXIsIAogICAgICAgIAlmaWVsZEFjY2Vzc0ZpbHRlciksIGdl\ndHRlcnMpOwogICAgfQogICAgCiAgICBwcml2YXRlIFNldDxFbGVtZW50PiBn\nZXREZWZhdWx0QWNjZXNzUGVyc2lzdGVudE1lbWJlcnMoVHlwZUVsZW1lbnQg\ndHlwZSwKICAgICAgICBpbnQgYWNjZXNzKSB7CiAgICAgICAgU2V0PEVsZW1l\nbnQ+IHJlc3VsdCA9IG5ldyBIYXNoU2V0PEVsZW1lbnQ+KCk7CiAgICAgICAg\nTGlzdDw/IGV4dGVuZHMgRWxlbWVudD4gYWxsTWVtYmVycyA9IHR5cGUuZ2V0\nRW5jbG9zZWRFbGVtZW50cygpOwogICAgICAgIGlmIChBY2Nlc3NDb2RlLmlz\nRmllbGQoYWNjZXNzKSkgewogICAgICAgICAgICBTZXQ8VmFyaWFibGVFbGVt\nZW50PiBhbGxGaWVsZHMgPSAoU2V0PFZhcmlhYmxlRWxlbWVudD4pIAogICAg\nICAgICAgICAgICAgZmlsdGVyKGFsbE1lbWJlcnMsIGZpZWxkRmlsdGVyLCBu\nb25UcmFuc2llbnRGaWx0ZXIpOwogICAgICAgICAgICByZXN1bHQuYWRkQWxs\nKGFsbEZpZWxkcyk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgU2V0\nPEV4ZWN1dGFibGVFbGVtZW50PiBhbGxNZXRob2RzID0gKFNldDxFeGVjdXRh\nYmxlRWxlbWVudD4pIAogICAgICAgICAgICAgICBmaWx0ZXIoYWxsTWVtYmVy\ncywgbWV0aG9kRmlsdGVyLCBub25UcmFuc2llbnRGaWx0ZXIpOwogICAgICAg\nICAgICBTZXQ8RXhlY3V0YWJsZUVsZW1lbnQ+IGdldHRlcnMgPSBmaWx0ZXIo\nYWxsTWV0aG9kcywgZ2V0dGVyRmlsdGVyKTsgCiAgICAgICAgICAgIFNldDxF\neGVjdXRhYmxlRWxlbWVudD4gc2V0dGVycyA9IGZpbHRlcihhbGxNZXRob2Rz\nLCBzZXR0ZXJGaWx0ZXIpOwogICAgICAgICAgICBnZXR0ZXJzID0gbWF0Y2hH\nZXR0ZXJBbmRTZXR0ZXIoZ2V0dGVycywgc2V0dGVycyk7CiAgICAgICAgICAg\nIHJlc3VsdC5hZGRBbGwoZ2V0dGVycyk7CiAgICAgICAgfQogICAgICAgIHJl\ndHVybiByZXN1bHQ7CiAgICB9CiAgICAKICAgIHByaXZhdGUgaW50IGdldElt\ncGxpY2l0QWNjZXNzVHlwZShUeXBlRWxlbWVudCB0eXBlKSB7CiAgICAgICAg\nTGlzdDw/IGV4dGVuZHMgRWxlbWVudD4gYWxsTWVtYmVycyA9IHR5cGUuZ2V0\nRW5jbG9zZWRFbGVtZW50cygpOwogICAgICAgIFNldDxWYXJpYWJsZUVsZW1l\nbnQ+IGFsbEZpZWxkcyA9IChTZXQ8VmFyaWFibGVFbGVtZW50PikgZmlsdGVy\nKGFsbE1lbWJlcnMsIGZpZWxkRmlsdGVyLCBub25UcmFuc2llbnRGaWx0ZXIp\nOwogICAgICAgIFNldDxFeGVjdXRhYmxlRWxlbWVudD4gYWxsTWV0aG9kcyA9\nIChTZXQ8RXhlY3V0YWJsZUVsZW1lbnQ+KSBmaWx0ZXIoYWxsTWVtYmVycywg\nbWV0aG9kRmlsdGVyLCAKICAgICAgICAgICAgICAgIG5vblRyYW5zaWVudEZp\nbHRlcik7CgogICAgICAgIFNldDxWYXJpYWJsZUVsZW1lbnQ+IGFubm90YXRl\nZEZpZWxkcyA9IGZpbHRlcihhbGxGaWVsZHMsIGFubm90YXRlZEZpbHRlcik7\nCiAgICAgICAgU2V0PEV4ZWN1dGFibGVFbGVtZW50PiBnZXR0ZXJzID0gZmls\ndGVyKGFsbE1ldGhvZHMsIGdldHRlckZpbHRlciwgYW5ub3RhdGVkRmlsdGVy\nKTsKICAgICAgICBTZXQ8RXhlY3V0YWJsZUVsZW1lbnQ+IHNldHRlcnMgPSBm\naWx0ZXIoYWxsTWV0aG9kcywgc2V0dGVyRmlsdGVyKTsKICAgICAgICBnZXR0\nZXJzID0gbWF0Y2hHZXR0ZXJBbmRTZXR0ZXIoZ2V0dGVycywgc2V0dGVycyk7\nCiAgICAgICAgCiAgICAgICAgYm9vbGVhbiBpc0ZpZWxkQWNjZXNzID0gIWFu\nbm90YXRlZEZpZWxkcy5pc0VtcHR5KCk7CiAgICAgICAgYm9vbGVhbiBpc1By\nb3BlcnR5QWNjZXNzID0gIWdldHRlcnMuaXNFbXB0eSgpOwoKICAgICAgICBp\nZiAoaXNGaWVsZEFjY2VzcyAmJiBpc1Byb3BlcnR5QWNjZXNzKSB7CiAgICAg\nICAgICAgIHRocm93IG5ldyBVc2VyRXhjZXB0aW9uKF9sb2MuZ2V0KCJhY2Nl\nc3MtbWl4ZWQiLCB0eXBlLAogICAgICAgICAgICAgICAgICAgIHRvU3RyaW5n\nKGFubm90YXRlZEZpZWxkcyksIHRvU3RyaW5nKGdldHRlcnMpKSk7CiAgICAg\nICAgfSAgICAKICAgICAgICBpZiAoaXNGaWVsZEFjY2VzcykgewogICAgICAg\nICAgICByZXR1cm4gQWNjZXNzQ29kZS5GSUVMRDsKICAgICAgICB9IGVsc2Ug\naWYgKGlzUHJvcGVydHlBY2Nlc3MpIHsKICAgICAgICAgICAgcmV0dXJuIEFj\nY2Vzc0NvZGUuUFJPUEVSVFk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAg\nICAgVHlwZUVsZW1lbnQgc3VwZXJUeXBlID0gZ2V0UGVyc2lzdGVudFN1cGVy\ndHlwZSh0eXBlKTsKICAgICAgICAgICAgcmV0dXJuIChzdXBlclR5cGUgPT0g\nbnVsbCkKICAgICAgICAgICAgICAgID8gQWNjZXNzQ29kZS5GSUVMRCA6IGRl\ndGVybWluZVR5cGVBY2Nlc3Moc3VwZXJUeXBlKTsKICAgICAgICB9CiAgICB9\nCiAgICAKICAgIFNldDxFbGVtZW50PiBtZXJnZShTZXQ8PyBleHRlbmRzIEVs\nZW1lbnQ+IGEsIFNldDw/IGV4dGVuZHMgRWxlbWVudD4gYikgewogICAgCVNl\ndDxFbGVtZW50PiByZXN1bHQgPSBuZXcgSGFzaFNldDxFbGVtZW50PigpOwog\nICAgCXJlc3VsdC5hZGRBbGwoYSk7CiAgICAJZm9yIChFbGVtZW50IGUxIDog\nYikgewogICAgCQlib29sZWFuIGhpZGUgPSBmYWxzZTsKICAgIAkJU3RyaW5n\nIGtleSA9IGdldFBlcnNpc3RlbnRNZW1iZXJOYW1lKGUxKTsKICAgIAkJZm9y\nIChFbGVtZW50IGUyIDogYSkgewogICAgCQkJaWYgKGdldFBlcnNpc3RlbnRN\nZW1iZXJOYW1lKGUyKS5lcXVhbHMoa2V5KSkgewogICAgCQkJCWhpZGUgPSB0\ncnVlOwogICAgCQkJCWJyZWFrOwogICAgCQkJfQogICAgCQl9CiAgICAJCWlm\nICghaGlkZSkgewogICAgCQkJcmVzdWx0LmFkZChlMSk7CiAgICAJCX0KICAg\nIAl9CiAgICAJcmV0dXJuIHJlc3VsdDsKICAgIH0KCiAgICAvKioKICAgICAq\nIE1hdGNoZXMgdGhlIGdpdmVuIGdldHRlcnMgd2l0aCB0aGUgZ2l2ZW4gc2V0\ndGVycy4gUmVtb3ZlcyB0aGUgZ2V0dGVycwogICAgICogdGhhdCBkbyBub3Qg\naGF2ZSBhIGNvcnJlc3BvbmRpbmcgc2V0dGVyLgogICAgICovCiAgICBwcml2\nYXRlIFNldDxFeGVjdXRhYmxlRWxlbWVudD4gbWF0Y2hHZXR0ZXJBbmRTZXR0\nZXIoCiAgICAgICAgU2V0PEV4ZWN1dGFibGVFbGVtZW50PiBnZXR0ZXJzLCAg\nU2V0PEV4ZWN1dGFibGVFbGVtZW50PiBzZXR0ZXJzKSB7CiAgICAgICAgQ29s\nbGVjdGlvbjxFeGVjdXRhYmxlRWxlbWVudD4gdW5tYXRjaGVkID0gIG5ldyBB\ncnJheUxpc3Q8RXhlY3V0YWJsZUVsZW1lbnQ+KCk7CiAgICAgICAgCiAgICAg\nICAgZm9yIChFeGVjdXRhYmxlRWxlbWVudCBnZXR0ZXIgOiBnZXR0ZXJzKSB7\nCiAgICAgICAgICAgIFN0cmluZyBnZXR0ZXJOYW1lID0gZ2V0dGVyLmdldFNp\nbXBsZU5hbWUoKS50b1N0cmluZygpOwogICAgICAgICAgICBUeXBlTWlycm9y\nIGdldHRlclJldHVyblR5cGUgPSBnZXR0ZXIuZ2V0UmV0dXJuVHlwZSgpOwog\nICAgICAgICAgICBTdHJpbmcgZXhwZWN0ZWRTZXR0ZXJOYW1lID0gInNldCIg\nKyBnZXR0ZXJOYW1lLnN1YnN0cmluZygKICAgICAgICAgICAgICAgIChpc0Jv\nb2xlYW5HZXR0ZXIoZ2V0dGVyKSA/ICJpcyIgOiAiZ2V0IikubGVuZ3RoKCkp\nOwogICAgICAgICAgICBib29sZWFuIG1hdGNoZWQgPSBmYWxzZTsKICAgICAg\nICAgICAgZm9yIChFeGVjdXRhYmxlRWxlbWVudCBzZXR0ZXIgOiBzZXR0ZXJz\nKSB7CiAgICAgICAgICAgICAgICBUeXBlTWlycm9yIHNldHRlckFyZ1R5cGUg\nPSBzZXR0ZXIuZ2V0UGFyYW1ldGVycygpCiAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAuaXRlcmF0b3IoKS5uZXh0KCkuYXNUeXBlKCk7\nCiAgICAgICAgICAgICAgICBTdHJpbmcgYWN0dWFsU2V0dGVyTmFtZSA9IHNl\ndHRlci5nZXRTaW1wbGVOYW1lKCkudG9TdHJpbmcoKTsKICAgICAgICAgICAg\nICAgIG1hdGNoZWQgPSBhY3R1YWxTZXR0ZXJOYW1lLmVxdWFscyhleHBlY3Rl\nZFNldHRlck5hbWUpCiAgICAgICAgICAgICAgICAgICAgICAgJiYgdHlwZVV0\naWxpdHkuaXNTYW1lVHlwZShzZXR0ZXJBcmdUeXBlLCBnZXR0ZXJSZXR1cm5U\neXBlKTsKICAgICAgICAgICAgICAgIGlmIChtYXRjaGVkKQogICAgICAgICAg\nICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlm\nICghbWF0Y2hlZCkgewogICAgICAgICAgICAgICAgbG9nZ2VyLndhcm4oX2xv\nYy5nZXQoImdldHRlci11bm1hdGNoZWQiLCBnZXR0ZXIsIGdldHRlci5nZXRF\nbmNsb3NpbmdFbGVtZW50KCkpKTsKICAgICAgICAgICAgICAgIHVubWF0Y2hl\nZC5hZGQoZ2V0dGVyKTsKICAgICAgICAgICAgfQoKICAgICAgICB9CiAgICAg\nICAgZ2V0dGVycy5yZW1vdmVBbGwodW5tYXRjaGVkKTsKICAgICAgICByZXR1\ncm4gZ2V0dGVyczsKICAgIH0KCiAgICAvLyA9PT09PT09PT09PT09PT09PT09\nPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09\nPT09PT09PT0KICAgIC8vICBTZWxlY3Rpb24gRmlsdGVycyBzZWxlY3Qgc3Bl\nY2lmaWMgZWxlbWVudHMgZnJvbSBhIGNvbGxlY3Rpb24uCiAgICAvLyA9PT09\nPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09\nPT09PT09PT09PT09PT09PT09PT09PT0KICAgIAogICAgLyoqCiAgICAgKiBJ\nbmNsdXNpdmUgZWxlbWVudCBmaWx0ZXJpbmcgcHJlZGljYXRlLgogICAgICoK\nICAgICAqLwogICAgcHJpdmF0ZSBzdGF0aWMgaW50ZXJmYWNlIEluY2x1c2l2\nZUZpbHRlcjxUIGV4dGVuZHMgRWxlbWVudD4gewogICAgICAgIC8qKgogICAg\nICAgICAqIFJldHVybiB0cnVlIHRvIGluY2x1ZGUgdGhlIGdpdmVuIGVsZW1l\nbnQuCiAgICAgICAgICovCiAgICAgICAgYm9vbGVhbiBpbmNsdWRlcyhUIGUp\nOwogICAgfQoKICAgIC8qKgogICAgICogRmlsdGVyIHRoZSBnaXZlbiBjb2xs\nZWN0aW9uIHdpdGggdGhlIGNvbmp1bmN0aW9uIG9mIGZpbHRlcnMuIFRoZSBn\naXZlbgogICAgICogY29sbGVjdGlvbiBpdHNlbGYgaXMgbm90IG1vZGlmaWVk\nLgogICAgICovCiAgICA8VCBleHRlbmRzIEVsZW1lbnQ+IFNldDxUPiBmaWx0\nZXIoQ29sbGVjdGlvbjxUPiBjb2xsLCAKICAgICAgICBJbmNsdXNpdmVGaWx0\nZXIuLi4gZmlsdGVycykgewogICAgICAgIFNldDxUPiByZXN1bHQgPSBuZXcg\nSGFzaFNldDxUPigpOwogICAgICAgIGZvciAoVCBlIDogY29sbCkgewogICAg\nICAgICAgICBib29sZWFuIGluY2x1ZGUgPSB0cnVlOwogICAgICAgICAgICBm\nb3IgKEluY2x1c2l2ZUZpbHRlciBmIDogZmlsdGVycykgewogICAgICAgICAg\nICAgICAgaWYgKCFmLmluY2x1ZGVzKGUpKSB7CiAgICAgICAgICAgICAgICAg\nICAgaW5jbHVkZSA9IGZhbHNlOwogICAgICAgICAgICAgICAgICAgIGJyZWFr\nOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAg\nIGlmIChpbmNsdWRlKQogICAgICAgICAgICAgICAgcmVzdWx0LmFkZChlKTsK\nICAgICAgICB9CiAgICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0KCiAgICAv\nKioKICAgICAqIFNlbGVjdHMgZ2V0dGVyIG1ldGhvZC4gQSBnZXR0ZXIgbWV0\naG9kIG5hbWUgc3RhcnRzIHdpdGggJ2dldCcsIHJldHVybnMgYQogICAgICog\nbm9uLXZvaWQgdHlwZSBhbmQgaGFzIG5vIGFyZ3VtZW50LiBPciBzdGFydHMg\nd2l0aCAnaXMnLCByZXR1cm5zIGEgYm9vbGVhbgogICAgICogYW5kIGhhcyBu\nbyBhcmd1bWVudC4KICAgICAqIAogICAgICovCiAgICBzdGF0aWMgY2xhc3Mg\nR2V0dGVyRmlsdGVyIGltcGxlbWVudHMgSW5jbHVzaXZlRmlsdGVyPEV4ZWN1\ndGFibGVFbGVtZW50PiB7CiAgICAgICAgcHVibGljIGJvb2xlYW4gaW5jbHVk\nZXMoRXhlY3V0YWJsZUVsZW1lbnQgbWV0aG9kKSB7CiAgICAgICAgICAgIHJl\ndHVybiBpc0dldHRlcihtZXRob2QpOwogICAgICAgIH0KICAgIH0KCiAgICAv\nKioKICAgICAqIFNlbGVjdHMgc2V0dGVyIG1ldGhvZC4gQSBzZXR0ZXIgbWV0\naG9kIG5hbWUgc3RhcnRzIHdpdGggJ3NldCcsIHJldHVybnMgYQogICAgICog\ndm9pZCBhbmQgaGFzIHNpbmdsZSBhcmd1bWVudC4KICAgICAqIAogICAgICov\nCiAgICBzdGF0aWMgY2xhc3MgU2V0dGVyRmlsdGVyIGltcGxlbWVudHMgSW5j\nbHVzaXZlRmlsdGVyPEV4ZWN1dGFibGVFbGVtZW50PiB7CiAgICAgICAgcHVi\nbGljIGJvb2xlYW4gaW5jbHVkZXMoRXhlY3V0YWJsZUVsZW1lbnQgbWV0aG9k\nKSB7CiAgICAgICAgICAgIHJldHVybiBpc1NldHRlcihtZXRob2QpOwogICAg\nICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIFNlbGVjdHMgZWxlbWVudHMg\nd2hpY2ggaXMgYW5ub3RhdGVkIHdpdGggQEFjY2VzcyBhbm5vdGF0aW9uIGFu\nZCB0aGF0IAogICAgICogYW5ub3RhdGlvbiBoYXMgdGhlIGdpdmVuIEFjY2Vz\nc1R5cGUgdmFsdWUuCiAgICAgKiAKICAgICAqLwogICAgc3RhdGljIGNsYXNz\nIEFjY2Vzc0ZpbHRlciBpbXBsZW1lbnRzIEluY2x1c2l2ZUZpbHRlcjxFbGVt\nZW50PiB7CiAgICAgICAgZmluYWwgQWNjZXNzVHlwZSB0YXJnZXQ7CgogICAg\nICAgIHB1YmxpYyBBY2Nlc3NGaWx0ZXIoQWNjZXNzVHlwZSB0YXJnZXQpIHsK\nICAgICAgICAgICAgdGhpcy50YXJnZXQgPSB0YXJnZXQ7CiAgICAgICAgfQoK\nICAgICAgICBwdWJsaWMgYm9vbGVhbiBpbmNsdWRlcyhFbGVtZW50IG9iaikg\newogICAgICAgICAgICBPYmplY3QgdmFsdWUgPSBnZXRBbm5vdGF0aW9uVmFs\ndWUob2JqLCBBY2Nlc3MuY2xhc3MpOwogICAgICAgICAgICByZXR1cm4gZXF1\nYWxzQnlWYWx1ZSh0YXJnZXQsIHZhbHVlKTsKICAgICAgICB9CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBTZWxlY3RzIGVsZW1lbnRzIG9mIGdpdmVuIGtpbmQu\nCiAgICAgKiAKICAgICAqLwogICAgc3RhdGljIGNsYXNzIEtpbmRGaWx0ZXIg\naW1wbGVtZW50cyBJbmNsdXNpdmVGaWx0ZXI8RWxlbWVudD4gewogICAgICAg\nIGZpbmFsIEVsZW1lbnRLaW5kIHRhcmdldDsKCiAgICAgICAgcHVibGljIEtp\nbmRGaWx0ZXIoRWxlbWVudEtpbmQgdGFyZ2V0KSB7CiAgICAgICAgICAgIHRo\naXMudGFyZ2V0ID0gdGFyZ2V0OwogICAgICAgIH0KCiAgICAgICAgcHVibGlj\nIGJvb2xlYW4gaW5jbHVkZXMoRWxlbWVudCBvYmopIHsKICAgICAgICAgICAg\ncmV0dXJuIG9iai5nZXRLaW5kKCkgPT0gdGFyZ2V0OwogICAgICAgIH0KICAg\nIH0KCiAgICAvKioKICAgICAqIFNlbGVjdHMgYWxsIG5vbi10cmFuc2llbnQg\nZWxlbWVudC4KICAgICAqLwogICAgc3RhdGljIGNsYXNzIFRyYW5zaWVudEZp\nbHRlciBpbXBsZW1lbnRzIEluY2x1c2l2ZUZpbHRlcjxFbGVtZW50PiB7CiAg\nICAgICAgcHVibGljIGJvb2xlYW4gaW5jbHVkZXMoRWxlbWVudCBvYmopIHsK\nICAgICAgICAgICAgU2V0PE1vZGlmaWVyPiBtb2RpZmllcnMgPSBvYmouZ2V0\nTW9kaWZpZXJzKCk7CiAgICAgICAgICAgIGJvb2xlYW4gaXNUcmFuc2llbnQg\nPSBpc0Fubm90YXRlZFdpdGgob2JqLCBUcmFuc2llbnQuY2xhc3MpCiAgICAg\nICAgICAgICAgICAgICAgICAgICAgICB8fCBtb2RpZmllcnMuY29udGFpbnMo\nTW9kaWZpZXIuVFJBTlNJRU5UKTsKICAgICAgICAgICByZXR1cm4gIWlzVHJh\nbnNpZW50ICYmICFtb2RpZmllcnMuY29udGFpbnMoTW9kaWZpZXIuU1RBVElD\nKTsKICAgICAgICB9CiAgICB9CiAgICAKICAgIC8qKgogICAgICogU2VsZWN0\ncyBhbGwgYW5ub3RhdGVkIGVsZW1lbnQuCiAgICAgKi8KICAgIHN0YXRpYyBj\nbGFzcyBBbm5vdGF0ZWRGaWx0ZXIgaW1wbGVtZW50cyBJbmNsdXNpdmVGaWx0\nZXI8RWxlbWVudD4gewogICAgICAgIHB1YmxpYyBib29sZWFuIGluY2x1ZGVz\nKEVsZW1lbnQgb2JqKSB7CiAgICAgICAgICAgIHJldHVybiBpc0Fubm90YXRl\nZChvYmopOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIEdldCAg\nYWNjZXNzIHR5cGUgb2YgdGhlIGdpdmVuIGNsYXNzLCBpZiBzcGVjaWZpZWQg\nZXhwbGljaXRseS4gCiAgICAgKiBudWxsIG90aGVyd2lzZS4KICAgICAqIAog\nICAgICogQHBhcmFtIHR5cGUKICAgICAqIEByZXR1cm4gRklFTEQgb3IgUFJP\nUEVSVFkgCiAgICAgKi8KICAgIEFjY2Vzc1R5cGUgZ2V0RXhwbGljaXRBY2Nl\nc3NUeXBlKFR5cGVFbGVtZW50IHR5cGUpIHsKICAgICAgICBPYmplY3QgYWNj\nZXNzID0gZ2V0QW5ub3RhdGlvblZhbHVlKHR5cGUsIEFjY2Vzcy5jbGFzcyk7\nCiAgICAgICAgaWYgKGVxdWFsc0J5VmFsdWUoQWNjZXNzVHlwZS5GSUVMRCwg\nYWNjZXNzKSkKICAgICAgICAgICAgcmV0dXJuIEFjY2Vzc1R5cGUuRklFTEQ7\nCiAgICAgICAgaWYgKGVxdWFsc0J5VmFsdWUoQWNjZXNzVHlwZS5QUk9QRVJU\nWSwgYWNjZXNzKSkKICAgICAgICAgICAgcmV0dXJuIEFjY2Vzc1R5cGUuUFJP\nUEVSVFk7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICB9CiAgICAKICAgIC8q\nKgogICAgICogR2V0cyB0aGUgdmFsdWUgb2YgdGhlIGdpdmVuIGFubm90YXRp\nb24sIGlmIHByZXNlbnQsIGluIHRoZSBnaXZlbgogICAgICogZGVjbGFyYXRp\nb24uIE90aGVyd2lzZSwgbnVsbC4KICAgICAqLwogICAgcHVibGljIHN0YXRp\nYyBPYmplY3QgZ2V0QW5ub3RhdGlvblZhbHVlKEVsZW1lbnQgZGVjbCwKICAg\nICAgICBDbGFzczw/IGV4dGVuZHMgQW5ub3RhdGlvbj4gYW5ubykgewogICAg\nICAgIHJldHVybiBnZXRBbm5vdGF0aW9uVmFsdWUoZGVjbCwgYW5ubywgInZh\nbHVlIik7CiAgICB9CgogICAgLyoqCiAgICAgKiBHZXRzIHRoZSB2YWx1ZSBv\nZiB0aGUgZ2l2ZW4gYXR0cmlidXRlIG9mIHRoZSBnaXZlbiBhbm5vdGF0aW9u\nLCBpZgogICAgICogcHJlc2VudCwgaW4gdGhlIGdpdmVuIGRlY2xhcmF0aW9u\nLiBPdGhlcndpc2UsIG51bGwuCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0aWMg\nT2JqZWN0IGdldEFubm90YXRpb25WYWx1ZShFbGVtZW50IGUsCiAgICAgICAg\nQ2xhc3M8PyBleHRlbmRzIEFubm90YXRpb24+IGFubm8sIFN0cmluZyBhdHRy\nKSB7CiAgICAgICAgaWYgKGUgPT0gbnVsbCB8fCBlLmdldEFubm90YXRpb24o\nYW5ubykgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAg\nICAgTGlzdDw/IGV4dGVuZHMgQW5ub3RhdGlvbk1pcnJvcj4gYW5ub3MgPSBl\nLmdldEFubm90YXRpb25NaXJyb3JzKCk7CiAgICAgICAgZm9yIChBbm5vdGF0\naW9uTWlycm9yIG1pcnJvciA6IGFubm9zKSB7CiAgICAgICAgICAgIGlmICht\naXJyb3IuZ2V0QW5ub3RhdGlvblR5cGUoKS50b1N0cmluZygpLmVxdWFscyhh\nbm5vLmdldE5hbWUoKSkpIHsKICAgICAgICAgICAgICAgIE1hcDw/IGV4dGVu\nZHMgRXhlY3V0YWJsZUVsZW1lbnQsID8gZXh0ZW5kcyBBbm5vdGF0aW9uVmFs\ndWU+IAogICAgICAgICAgICAgICAgdmFsdWVzID0gbWlycm9yLmdldEVsZW1l\nbnRWYWx1ZXMoKTsKICAgICAgICAgICAgICAgIGZvciAoRXhlY3V0YWJsZUVs\nZW1lbnQgZXggOiB2YWx1ZXMua2V5U2V0KCkpIHsKICAgICAgICAgICAgICAg\nICAgICBpZiAoZXguZ2V0U2ltcGxlTmFtZSgpLnRvU3RyaW5nKCkuZXF1YWxz\nKGF0dHIpKQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdmFsdWVz\nLmdldChleCkuZ2V0VmFsdWUoKTsKICAgICAgICAgICAgICAgIH0KICAgICAg\nICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4gbnVsbDsKICAgIH0K\nCiAgICBwdWJsaWMgc3RhdGljIFN0cmluZyB0b1N0cmluZyhDb2xsZWN0aW9u\nPD8gZXh0ZW5kcyBFbGVtZW50PiBlbGVtZW50cykgewogICAgICAgIFN0cmlu\nZ0J1aWxkZXIgdG1wID0gbmV3IFN0cmluZ0J1aWxkZXIoKTsKICAgICAgICBp\nbnQgaSA9IDA7CiAgICAgICAgZm9yIChFbGVtZW50IGUgOiBlbGVtZW50cykg\newogICAgICAgICAgICB0bXAuYXBwZW5kKGUuZ2V0U2ltcGxlTmFtZSgpICsg\nKCsraSA9PSBlbGVtZW50cy5zaXplKCkgPyAiIiA6ICIsIikpOwogICAgICAg\nIH0KICAgICAgICByZXR1cm4gdG1wLnRvU3RyaW5nKCk7CiAgICB9CiAgICAK\nICAgIFN0cmluZyB0b0RldGFpbHMoRWxlbWVudCBlKSB7CiAgICAgICAgVHlw\nZU1pcnJvciBtaXJyb3IgPSBlLmFzVHlwZSgpOwogICAgICAgIHJldHVybiBu\nZXcgU3RyaW5nQnVpbGRlcihlLmdldEtpbmQoKS50b1N0cmluZygpKS5hcHBl\nbmQoIiAiKQogICAgICAgICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKGUu\ndG9TdHJpbmcoKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgLmFwcGVu\nZCgiTWlycm9yICIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hcHBl\nbmQobWlycm9yLmdldEtpbmQoKS50b1N0cmluZygpKQogICAgICAgICAgICAg\nICAgICAgICAgICAgICAuYXBwZW5kKG1pcnJvci50b1N0cmluZygpKS50b1N0\ncmluZygpOwogICAgfQoKICAgIFN0cmluZyBnZXRQZXJzaXN0ZW50TWVtYmVy\nTmFtZShFbGVtZW50IGUpIHsKICAgIAlyZXR1cm4gaXNNZXRob2QoZSkgPyBl\neHRyYWN0RmllbGROYW1lKChFeGVjdXRhYmxlRWxlbWVudCllKSAKICAgIAkJ\nCTogZS5nZXRTaW1wbGVOYW1lKCkudG9TdHJpbmcoKTsKICAgIH0KICAgIAog\nICAgcHVibGljIFN0cmluZyBleHRyYWN0RmllbGROYW1lKEV4ZWN1dGFibGVF\nbGVtZW50IG1ldGhvZCkgewogICAgCVN0cmluZyBuYW1lID0gbWV0aG9kLmdl\ndFNpbXBsZU5hbWUoKS50b1N0cmluZygpOwoJCVN0cmluZyBoZWFkID0gaXNO\nb3JtYWxHZXR0ZXIobWV0aG9kKSA/ICJnZXQiIDogImlzIjsKCQluYW1lID0g\nbmFtZS5zdWJzdHJpbmcoaGVhZC5sZW5ndGgoKSk7CiAgICAgICAgcmV0dXJu\nIENoYXJhY3Rlci50b0xvd2VyQ2FzZShuYW1lLmNoYXJBdCgwKSkgKyBuYW1l\nLnN1YnN0cmluZygxKTsKICAgIH0KICAgIAoKICAgIC8vID09PT09PT09PT09\nPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09\nPT09PT09PT09PT09PT09PT0KICAgIC8vIEFubm90YXRpb24gcHJvY2Vzc2lu\nZyB1dGlsaXRpZXMKICAgIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09\nPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09\nPT0KICAgIAogICAgLyoqCiAgICAgKiBBZmZpcm1zIGlmIHRoZSBnaXZlbiBl\nbGVtZW50IGlzIGFubm90YXRlZCB3aXRoIDxlbT5hbnk8L2VtPiAKICAgICAq\nIDxjb2RlPmphdmF4LnBlcnNpc3RlbmNlLio8L2NvZGU+IG9yIDxjb2RlPm9y\nZy5hcGFjaGUub3BlbmpwYS4qPC9jb2RlPgogICAgICogYW5ub3RhdGlvbi4K\nICAgICAqLwogICAgcHVibGljIHN0YXRpYyBib29sZWFuIGlzQW5ub3RhdGVk\nKEVsZW1lbnQgZSkgewogICAgCXJldHVybiBpc0Fubm90YXRlZFdpdGgoZSwg\nKFNldDxTdHJpbmc+KW51bGwpOwogICAgfQogICAgCiAgICAvKioKICAgICAq\nIEFmZmlybXMgaWYgdGhlIGdpdmVuIGRlY2xhcmF0aW9uIGhhcyB0aGUgZ2l2\nZW4gYW5ub3RhdGlvbi4KICAgICAqLwogICAgYm9vbGVhbiBpc0Fubm90YXRl\nZEFzRW50aXR5KEVsZW1lbnQgZSkgewogICAgICAgIHJldHVybiBpc0Fubm90\nYXRlZFdpdGgoZSwgRW50aXR5LmNsYXNzKQogICAgICAgICAgICB8fCBpc0Fu\nbm90YXRlZFdpdGgoZSwgRW1iZWRkYWJsZS5jbGFzcykKICAgICAgICAgICAg\nfHwgaXNBbm5vdGF0ZWRXaXRoKGUsIE1hcHBlZFN1cGVyY2xhc3MuY2xhc3Mp\nOwogICAgfQoKICAgIC8qKgogICAgICogQWZmaXJtcyBpZiB0aGUgZ2l2ZW4g\nZGVjbGFyYXRpb24gaGFzIHRoZSBnaXZlbiBhbm5vdGF0aW9uLgogICAgICov\nCiAgICBwdWJsaWMgc3RhdGljIGJvb2xlYW4gaXNBbm5vdGF0ZWRXaXRoKEVs\nZW1lbnQgZSwKICAgICAgICBDbGFzczw/IGV4dGVuZHMgQW5ub3RhdGlvbj4g\nYW5ubykgewogICAgICAgIHJldHVybiBlICE9IG51bGwgJiYgZS5nZXRBbm5v\ndGF0aW9uKGFubm8pICE9IG51bGw7CiAgICB9CiAgICAKICAgIC8qKgogICAg\nICogQWZmaXJtcyBpZiB0aGUgZ2l2ZW4gZWxlbWVudCBpcyBhbm5vdGF0ZWQg\nd2l0aCBhbnkgb2YgdGhlIGdpdmVuIAogICAgICogYW5ub3RhdGlvbnMuCiAg\nICAgKiAKICAgICAqIEBwYXJhbSBhbm5vcyBudWxsIGNoZWNrcyBmb3IgYW55\nIGFubm90YXRpb24gdGhhdCBzdGFydHMgd2l0aCAKICAgICAqICAgICAgICAg\nICAgJ2phdmF4LnBlcnNpc3RlbmNlLicgb3IgJ29wZW5qcGEuKicuCiAgICAg\nKiAKICAgICAqLwogICAgcHVibGljIHN0YXRpYyBib29sZWFuIGlzQW5ub3Rh\ndGVkV2l0aChFbGVtZW50IGUsIFNldDxTdHJpbmc+IGFubm9zKSB7CiAgICAg\nICAgaWYgKGUgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwog\nICAgICAgIExpc3Q8PyBleHRlbmRzIEFubm90YXRpb25NaXJyb3I+IG1pcnJv\ncnMgPSBlLmdldEFubm90YXRpb25NaXJyb3JzKCk7CiAgICAgICAgaWYgKGFu\nbm9zID09IG51bGwpIHsKICAgICAgICAgICAgZm9yIChBbm5vdGF0aW9uTWly\ncm9yIG1pcnJvciA6IG1pcnJvcnMpIHsKICAgICAgICAgICAgICAgIFN0cmlu\nZyBuYW1lID0gbWlycm9yLmdldEFubm90YXRpb25UeXBlKCkudG9TdHJpbmco\nKTsKICAgICAgICAgICAgICAgIGlmIChzdGFydHNXaXRoKG5hbWUsICJqYXZh\neC5wZXJzaXN0ZW5jZS4iKQogICAgICAgICAgICAgICAgIHx8IHN0YXJ0c1dp\ndGgobmFtZSwgIm9yZy5hcGFjaGUub3BlbmpwYS4iKSkKICAgICAgICAgICAg\nICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgICAg\nICByZXR1cm4gZmFsc2U7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAg\nZm9yIChBbm5vdGF0aW9uTWlycm9yIG1pcnJvciA6IG1pcnJvcnMpIHsKICAg\nICAgICAgICAgICAgIFN0cmluZyBuYW1lID0gbWlycm9yLmdldEFubm90YXRp\nb25UeXBlKCkudG9TdHJpbmcoKTsKICAgICAgICAgICAgICAgIGlmIChhbm5v\ncy5jb250YWlucyhuYW1lKSkKICAgICAgICAgICAgICAgICAgICByZXR1cm4g\ndHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gZmFsc2U7\nCiAgICAgICAgfQogICAgfQogICAgCiAgICBUeXBlTWlycm9yIGdldFRhcmdl\ndEVudGl0eVR5cGUoRWxlbWVudCBlKSB7CiAgICAgICAgZm9yIChDbGFzczw/\nIGV4dGVuZHMgQW5ub3RhdGlvbj4gYW5ubyA6IG1hcHBpbmdBbm5vcykgewog\nICAgICAgICAgICBPYmplY3QgdGFyZ2V0ID0gZ2V0QW5ub3RhdGlvblZhbHVl\nKGUsIGFubm8sICJ0YXJnZXRFbnRpdHkiKTsKICAgICAgICAgICAgaWYgKHRh\ncmdldCAhPSBudWxsKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gKFR5cGVN\naXJyb3IpdGFyZ2V0OwogICAgICAgICAgICB9CiAgICAgICAgICAgIAogICAg\nICAgIH07CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICB9CiAgICAKICAgIFN0\ncmluZyBnZXREZWNsYXJlZFR5cGVOYW1lKFR5cGVNaXJyb3IgbWlycm9yKSB7\nCiAgICAJcmV0dXJuIGdldERlY2xhcmVkVHlwZU5hbWUobWlycm9yLCB0cnVl\nKTsKICAgIH0KICAgIAogICAgIC8qKgogICAgICogR2V0IHRoZSBlbGVtZW50\nIG5hbWUgb2YgdGhlIGNsYXNzIHRoZSBnaXZlbiBtaXJyb3IgcmVwcmVzZW50\ncy4gSWYgdGhlCiAgICAgKiBtaXJyb3IgaXMgcHJpbWl0aXZlIHRoZW4gcmV0\ndXJucyB0aGUgY29ycmVzcG9uZGluZyBib3hlZCBjbGFzcyBuYW1lLgogICAg\nICogSWYgdGhlIG1pcnJvciBpcyBwYXJhbWV0ZXJpemVkIHJldHVybnMgb25s\neSB0aGUgZ2VuZXJpYyB0eXBlIGkuZS4KICAgICAqIGlmIHRoZSBnaXZlbiBk\nZWNsYXJlZCB0eXBlIGlzIAogICAgICogPGNvZGU+amF2YS51dGlsLlNldCZs\ndDtqYXZhLmxhbmcuU3RyaW5nJmd0OzwvY29kZT4gdGhpcyBtZXRob2Qgd2ls\nbCAKICAgICAqIHJldHVybiA8Y29kZT5qYXZhLnV0aWwuU2V0PC9jb2RlPi4K\nICAgICAqLwogICAgU3RyaW5nIGdldERlY2xhcmVkVHlwZU5hbWUoVHlwZU1p\ncnJvciBtaXJyb3IsIGJvb2xlYW4gYm94KSB7CiAgICAgICAgaWYgKG1pcnJv\nciA9PSBudWxsIHx8IG1pcnJvci5nZXRLaW5kKCkgPT0gVHlwZUtpbmQuTlVM\nTCB8fCBtaXJyb3IuZ2V0S2luZCgpID09IFR5cGVLaW5kLldJTERDQVJEKQog\nICAgICAgICAgICByZXR1cm4gImphdmEubGFuZy5PYmplY3QiOwogICAgCWlm\nIChtaXJyb3IuZ2V0S2luZCgpID09IFR5cGVLaW5kLkFSUkFZKSB7CiAgICAJ\nCVR5cGVNaXJyb3IgY29tcCA9ICgoQXJyYXlUeXBlKW1pcnJvcikuZ2V0Q29t\ncG9uZW50VHlwZSgpOwogICAgCQlyZXR1cm4gZ2V0RGVjbGFyZWRUeXBlTmFt\nZShjb21wLCBmYWxzZSk7CiAgICAJfQogICAgCW1pcnJvciA9IGJveCA/IGJv\neChtaXJyb3IpIDogbWlycm9yOwogICAgCWlmIChpc1ByaW1pdGl2ZShtaXJy\nb3IpKQogICAgCQlyZXR1cm4gKChQcmltaXRpdmVUeXBlKW1pcnJvcikudG9T\ndHJpbmcoKTsKICAgIAlFbGVtZW50IGVsZW0gPSB0eXBlVXRpbGl0eS5hc0Vs\nZW1lbnQobWlycm9yKTsKICAgIAlpZiAoZWxlbSA9PSBudWxsKQogICAgCSAg\nICB0aHJvdyBuZXcgUnVudGltZUV4Y2VwdGlvbihfbG9jLmdldCgibW1nLW5v\nLXR5cGUiLCBtaXJyb3IpLmdldE1lc3NhZ2UoKSk7CiAgICAgICAgcmV0dXJu\nIGVsZW0udG9TdHJpbmcoKTsKICAgIH0KCiAgICAvKioKICAgICAqIEdldHMg\ndGhlIGRlY2xhcmVkIHR5cGUgb2YgdGhlIGdpdmVuIG1lbWJlci4gRm9yIGZp\nZWxkcywgcmV0dXJucyB0aGUgCiAgICAgKiBkZWNsYXJlZCB0eXBlIHdoaWxl\nIGZvciBtZXRob2QgcmV0dXJucyB0aGUgcmV0dXJuIHR5cGUuIAogICAgICog\nCiAgICAgKiBAcGFyYW0gZSBhIGZpZWxkIG9yIG1ldGhvZC4KICAgICAqIEBl\neGNlcHRpb24gaWYgZ2l2ZW4gbWVtYmVyIGlzIG5laXRoZXIgYSBmaWVsZCBu\nb3IgYSBtZXRob2QuCiAgICAgKi8KICAgIFR5cGVNaXJyb3IgZ2V0RGVjbGFy\nZWRUeXBlKEVsZW1lbnQgZSkgewogICAgICAgIFR5cGVNaXJyb3IgcmVzdWx0\nID0gbnVsbDsKICAgICAgICBzd2l0Y2ggKGUuZ2V0S2luZCgpKSB7CiAgICAg\nICAgY2FzZSBGSUVMRDoKICAgICAgICAgICAgcmVzdWx0ID0gZS5hc1R5cGUo\nKTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSBNRVRIT0Q6CiAg\nICAgICAgICAgIHJlc3VsdCA9ICgoRXhlY3V0YWJsZUVsZW1lbnQpIGUpLmdl\ndFJldHVyblR5cGUoKTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgZGVm\nYXVsdDoKICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4\nY2VwdGlvbih0b0RldGFpbHMoZSkpOwogICAgICAgIH0KICAgICAgICByZXR1\ncm4gcmVzdWx0OwogICAgfQogICAgCiAgICAvKioKICAgICAqIEFmZmlybXMg\naWYgdGhlIGdpdmVuIHR5cGUgbWlycm9ycyBhIHByaW1pdGl2ZS4KICAgICAq\nLwogICAgcHJpdmF0ZSBib29sZWFuIGlzUHJpbWl0aXZlKFR5cGVNaXJyb3Ig\nbWlycm9yKSB7CiAgICAgICAgVHlwZUtpbmQga2luZCA9IG1pcnJvci5nZXRL\naW5kKCk7CiAgICAgICAgcmV0dXJuIGtpbmQgPT0gVHlwZUtpbmQuQk9PTEVB\nTiAKICAgICAgICAgICAgfHwga2luZCA9PSBUeXBlS2luZC5CWVRFCiAgICAg\nICAgICAgIHx8IGtpbmQgPT0gVHlwZUtpbmQuQ0hBUgogICAgICAgICAgICB8\nfCBraW5kID09IFR5cGVLaW5kLkRPVUJMRQogICAgICAgICAgICB8fCBraW5k\nID09IFR5cGVLaW5kLkZMT0FUCiAgICAgICAgICAgIHx8IGtpbmQgPT0gVHlw\nZUtpbmQuSU5UCiAgICAgICAgICAgIHx8IGtpbmQgPT0gVHlwZUtpbmQuTE9O\nRwogICAgICAgICAgICB8fCBraW5kID09IFR5cGVLaW5kLlNIT1JUOwogICAg\nfQogICAgCiAgICBwdWJsaWMgVHlwZU1pcnJvciBib3goVHlwZU1pcnJvciB0\nKSB7CiAgICAgICAgaWYgKGlzUHJpbWl0aXZlKHQpKQogICAgICAgICAgICBy\nZXR1cm4gcHJvY2Vzc2luZ0Vudi5nZXRUeXBlVXRpbHMoKQogICAgICAgICAg\nICAuYm94ZWRDbGFzcygoUHJpbWl0aXZlVHlwZSl0KS5hc1R5cGUoKTsKICAg\nICAgICByZXR1cm4gdDsKICAgIH0KCiAgICAvKioKICAgICAqIEdldHMgdGhl\nIHBhcmFtZXRlciB0eXBlIGFyZ3VtZW50IGF0IHRoZSBnaXZlbiBpbmRleCBv\nZiB0aGUgZ2l2ZW4gdHlwZS4KICAgICAqIAogICAgICogQHJldHVybiBpZiB0\naGUgZ2l2ZW4gdHlwZSByZXByZXNlbnRzIGEgcGFyYW1ldGVyaXplZCB0eXBl\nLCB0aGVuIHRoZQogICAgICogICAgICAgICBpbmRleGVkIHBhcmFtZXRlciB0\neXBlIGFyZ3VtZW50LiBPdGhlcndpc2UgbnVsbC4KICAgICAqLwogICAgVHlw\nZU1pcnJvciBnZXRUeXBlUGFyYW1ldGVyKEVsZW1lbnQgZSwgVHlwZU1pcnJv\nciBtaXJyb3IsIGludCBpbmRleCwgYm9vbGVhbiBjaGVja1RhcmdldCkgewog\nICAgICAgIGlmIChtaXJyb3IuZ2V0S2luZCgpID09IFR5cGVLaW5kLkFSUkFZ\nKQogICAgICAgICAgICByZXR1cm4gKChBcnJheVR5cGUpbWlycm9yKS5nZXRD\nb21wb25lbnRUeXBlKCk7CiAgICAJaWYgKG1pcnJvci5nZXRLaW5kKCkgIT0g\nVHlwZUtpbmQuREVDTEFSRUQpCiAgICAJCXJldHVybiBudWxsOwogICAgCWlm\nIChjaGVja1RhcmdldCkgewogICAgCSAgICBUeXBlTWlycm9yIHRhcmdldCA9\nIGdldFRhcmdldEVudGl0eVR5cGUoZSk7CiAgICAJICAgIGlmICh0YXJnZXQg\nIT0gbnVsbCkKICAgIAkgICAgICAgIHJldHVybiB0YXJnZXQ7CiAgICAJfQog\nICAgICAgIExpc3Q8PyBleHRlbmRzIFR5cGVNaXJyb3I+IHBhcmFtcyA9ICgo\nRGVjbGFyZWRUeXBlKW1pcnJvcikuZ2V0VHlwZUFyZ3VtZW50cygpOwogICAg\nICAgIFR5cGVNaXJyb3IgcGFyYW0gPSAocGFyYW1zID09IG51bGwgfHwgcGFy\nYW1zLnNpemUoKSA8IGluZGV4KzEpIAogICAgICAgICAgICA/IHR5cGVVdGls\naXR5LmdldE51bGxUeXBlKCkgOiBwYXJhbXMuZ2V0KGluZGV4KTsKICAgICAg\nICBpZiAocGFyYW0uZ2V0S2luZCgpID09IFR5cGVLaW5kLk5VTEwgfHwgcGFy\nYW0uZ2V0S2luZCgpID09IFR5cGVLaW5kLldJTERDQVJEKSB7CiAgICAgICAg\nICAgIGxvZ2dlci53YXJuKF9sb2MuZ2V0KCJnZW5lcmljLXR5cGUtcGFyYW0i\nLCBlLCBnZXREZWNsYXJlZFR5cGUoZSksIGUuZ2V0RW5jbG9zaW5nRWxlbWVu\ndCgpKSk7CiAgICAgICAgfQogICAgICAgIHJldHVybiBwYXJhbTsKICAgIH0K\nCiAgICBwdWJsaWMgVHlwZUVsZW1lbnQgZ2V0UGVyc2lzdGVudFN1cGVydHlw\nZShUeXBlRWxlbWVudCBjbHMpIHsKICAgICAgICBUeXBlTWlycm9yIHN1cCA9\nIGNscy5nZXRTdXBlcmNsYXNzKCk7CiAgICAgICAgaWYgKHN1cCA9PSBudWxs\nIHx8IGlzUm9vdE9iamVjdChzdXApKQogICAgICAgICAgICByZXR1cm4gbnVs\nbDsKICAgICAgICBUeXBlRWxlbWVudCBzdXBlID0KICAgICAgICAgICAgKFR5\ncGVFbGVtZW50KSBwcm9jZXNzaW5nRW52LmdldFR5cGVVdGlscygpLmFzRWxl\nbWVudChzdXApOwogICAgICAgIGlmIChpc0Fubm90YXRlZEFzRW50aXR5KHN1\ncGUpKSAKICAgICAgICAgICAgcmV0dXJuIHN1cGU7CiAgICAgICAgcmV0dXJu\nIGdldFBlcnNpc3RlbnRTdXBlcnR5cGUoc3VwZSk7CiAgICB9CgoKICAgIC8v\nID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09\nPT09PT09PT09PT09PT09PT09PT09PT09PT09PQogICAgLy8gIFV0aWxpdGll\ncwogICAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09\nPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgogICAgLyoq\nCiAgICAgKiBBZmZpcm1zIGlmIHRoZSBnaXZlbiBtaXJyb3IgcmVwcmVzZW50\ncyBhIHByaW1pdGl2ZSBvciBub24tcHJpbWl0aXZlCiAgICAgKiBib29sZWFu\nLgogICAgICovCiAgICBwdWJsaWMgc3RhdGljIGJvb2xlYW4gaXNCb29sZWFu\nKFR5cGVNaXJyb3IgdHlwZSkgewogICAgICAgIHJldHVybiAodHlwZSAhPSBu\ndWxsICYmICh0eXBlLmdldEtpbmQoKSA9PSBUeXBlS2luZC5CT09MRUFOIAog\nICAgICAgICAgICB8fCAiamF2YS5sYW5nLkJvb2xlYW4iLmVxdWFscyh0eXBl\nLnRvU3RyaW5nKCkpKSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBBZmZpcm1z\nIGlmIHRoZSBnaXZlbiBtaXJyb3IgcmVwcmVzZW50cyBhIHZvaWQuCiAgICAg\nKi8KICAgIHB1YmxpYyBzdGF0aWMgYm9vbGVhbiBpc1ZvaWQoVHlwZU1pcnJv\nciB0eXBlKSB7CiAgICAgICAgcmV0dXJuICh0eXBlICE9IG51bGwgJiYgdHlw\nZS5nZXRLaW5kKCkgPT0gVHlwZUtpbmQuVk9JRCk7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBBZmZpcm1zIGlmIHRoZSBnaXZlbiBlbGVtZW50IHJlcHJlc2Vu\ndHMgYSBtZXRob2QuCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0aWMgYm9vbGVh\nbiBpc01ldGhvZChFbGVtZW50IGUpIHsKICAgICAgICByZXR1cm4gZSAhPSBu\ndWxsICYmIEV4ZWN1dGFibGVFbGVtZW50LmNsYXNzLmlzSW5zdGFuY2UoZSkK\nICAgICAgICAgICAgJiYgZS5nZXRLaW5kKCkgPT0gRWxlbWVudEtpbmQuTUVU\nSE9EOwogICAgfQogICAgCiAgICAvKioKICAgICAqIEFmZmlybXMgaWYgdGhl\nIGdpdmVuIG1ldGhvZCBtYXRjaGVzIHRoZSBmb2xsb3dpbmcgc2lnbmF0dXJl\nCiAgICAgKiA8Y29kZT4gcHVibGljIFQgZ2V0WFhYKCkgPC9jb2RlPgogICAg\nICogd2hlcmUgVCBpcyBhbnkgbm9uLXZvaWQgdHlwZS4KICAgICAqLwogICAg\ncHVibGljIHN0YXRpYyBib29sZWFuIGlzTm9ybWFsR2V0dGVyKEV4ZWN1dGFi\nbGVFbGVtZW50IG1ldGhvZCkgewogICAgCVN0cmluZyBtZXRob2ROYW1lID0g\nbWV0aG9kLmdldFNpbXBsZU5hbWUoKS50b1N0cmluZygpOwogICAgCXJldHVy\nbiBtZXRob2QuZ2V0S2luZCgpID09IEVsZW1lbnRLaW5kLk1FVEhPRAogICAg\nCSAgICAmJiBzdGFydHNXaXRoKG1ldGhvZE5hbWUsICJnZXQiKSAKICAgIAkg\nICAgJiYgbWV0aG9kLmdldFBhcmFtZXRlcnMoKS5pc0VtcHR5KCkKICAgIAkg\nICAgJiYgIWlzVm9pZChtZXRob2QuZ2V0UmV0dXJuVHlwZSgpKTsKICAgIH0K\nICAgIAogICAgLyoqCiAgICAgKiBBZmZpcm1zIGlmIHRoZSBnaXZlbiBtZXRo\nb2QgbWF0Y2hlcyB0aGUgZm9sbG93aW5nIHNpZ25hdHVyZQogICAgICogPGNv\nZGU+IHB1YmxpYyBib29sZWFuIGlzWHl6KCkgPC9jb2RlPgogICAgICogPGNv\nZGU+IHB1YmxpYyBCb29sZWFuIGlzWHl6KCkgPC9jb2RlPgogICAgICovCiAg\nICBwdWJsaWMgc3RhdGljIGJvb2xlYW4gaXNCb29sZWFuR2V0dGVyKEV4ZWN1\ndGFibGVFbGVtZW50IG1ldGhvZCkgewogICAgCVN0cmluZyBtZXRob2ROYW1l\nID0gbWV0aG9kLmdldFNpbXBsZU5hbWUoKS50b1N0cmluZygpOwogICAgCXJl\ndHVybiBtZXRob2QuZ2V0S2luZCgpID09IEVsZW1lbnRLaW5kLk1FVEhPRAog\nICAgCSAgICAmJiBzdGFydHNXaXRoKG1ldGhvZE5hbWUsICJpcyIpIAogICAg\nCSAgICAmJiBtZXRob2QuZ2V0UGFyYW1ldGVycygpLmlzRW1wdHkoKQogICAg\nCSAgICAmJiBpc0Jvb2xlYW4obWV0aG9kLmdldFJldHVyblR5cGUoKSk7CiAg\nICB9CgogICAgcHVibGljIHN0YXRpYyBib29sZWFuIGlzR2V0dGVyKEV4ZWN1\ndGFibGVFbGVtZW50IG1ldGhvZCkgewogICAgCXJldHVybiBpc05vcm1hbEdl\ndHRlcihtZXRob2QpIHx8IGlzQm9vbGVhbkdldHRlcihtZXRob2QpOwogICAg\nfQogICAgCiAgICAvKioKICAgICAqIEFmZmlybXMgaWYgdGhlIGdpdmVuIG1l\ndGhvZCBtYXRjaGVzIHRoZSBmb2xsb3dpbmcgc2lnbmF0dXJlCiAgICAgKiA8\nY29kZT4gcHVibGljIHZvaWQgc2V0WFhYKFQgdCkgPC9jb2RlPgogICAgICov\nCiAgICBwdWJsaWMgc3RhdGljIGJvb2xlYW4gaXNTZXR0ZXIoRXhlY3V0YWJs\nZUVsZW1lbnQgbWV0aG9kKSB7CiAgICAJU3RyaW5nIG1ldGhvZE5hbWUgPSBt\nZXRob2QuZ2V0U2ltcGxlTmFtZSgpLnRvU3RyaW5nKCk7CiAgICAJcmV0dXJu\nIG1ldGhvZC5nZXRLaW5kKCkgPT0gRWxlbWVudEtpbmQuTUVUSE9ECiAgICAJ\nICAgICYmIHN0YXJ0c1dpdGgobWV0aG9kTmFtZSwgInNldCIpIAogICAgCSAg\nICAmJiBtZXRob2QuZ2V0UGFyYW1ldGVycygpLnNpemUoKSA9PSAxCiAgICAJ\nICAgICYmIGlzVm9pZChtZXRob2QuZ2V0UmV0dXJuVHlwZSgpKTsKICAgIH0K\nICAgIAogICAgLyoqCiAgICAgKiBBZmZpcm1zIGlmIHRoZSBnaXZlbiBtaXJy\nb3IgcmVwcmVzZW50cyByb290IGphdmEubGFuZy5PYmplY3QuCiAgICAgKi8K\nICAgIHB1YmxpYyBzdGF0aWMgYm9vbGVhbiBpc1Jvb3RPYmplY3QoVHlwZU1p\ncnJvciB0eXBlKSB7CiAgICAgICAgcmV0dXJuIHR5cGUgIT0gbnVsbCAmJiAi\namF2YS5sYW5nLk9iamVjdCIuZXF1YWxzKHR5cGUudG9TdHJpbmcoKSk7CiAg\nICB9CiAgICAKICAgIC8qKgogICAgICogQWZmaXJtcyBpZiB0aGUgZ2l2ZW4g\nZnVsbCBzdHJpbmcgc3RhcnRzIHdpdGggdGhlIGdpdmVuIGhlYWQuCiAgICAg\nKi8KICAgIHB1YmxpYyBzdGF0aWMgYm9vbGVhbiBzdGFydHNXaXRoKFN0cmlu\nZyBmdWxsLCBTdHJpbmcgaGVhZCkgewogICAgICAgIHJldHVybiBmdWxsICE9\nIG51bGwgJiYgaGVhZCAhPSBudWxsICYmIGZ1bGwuc3RhcnRzV2l0aChoZWFk\nKSAKICAgICAgICAgICAgJiYgZnVsbC5sZW5ndGgoKSA+IGhlYWQubGVuZ3Ro\nKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBBZmZpcm1zIGlmIHRoZSBnaXZl\nbiBlbnVtIGVxdWFscyB0aGUgZ2l2ZW4gdmFsdWUuCiAgICAgKi8KICAgIHB1\nYmxpYyBzdGF0aWMgYm9vbGVhbiBlcXVhbHNCeVZhbHVlKEVudW08Pz4gZSwg\nT2JqZWN0IHYpIHsKICAgICAgICByZXR1cm4gZSA9PSB2IAogICAgICAgICAg\nICAgfHwgKHYgIT0gbnVsbCAmJiBlICE9IG51bGwgJiYgZS50b1N0cmluZygp\nLmVxdWFscyh2LnRvU3RyaW5nKCkpKTsKICAgIH0KfQo=\n","encoding":"base64"}

