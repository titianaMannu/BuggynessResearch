{"sha":"fcfb4664f03c36eab71d6fde25d29f7d7b7daba1","node_id":"MDQ6QmxvYjIwNjM2NDpmY2ZiNDY2NGYwM2MzNmVhYjcxZDZmZGUyNWQyOWY3ZDdiN2RhYmEx","size":15362,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/fcfb4664f03c36eab71d6fde25d29f7d7b7daba1","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UudmFsaWRh\ndGlvbjsKCmltcG9ydCBqYXZhLnNlY3VyaXR5LkFjY2Vzc0NvbnRyb2xsZXI7\nCmltcG9ydCBqYXZhLnV0aWwuSGFzaE1hcDsKaW1wb3J0IGphdmEudXRpbC5N\nYXA7CmltcG9ydCBqYXZhLnV0aWwuU2V0OwoKaW1wb3J0IGphdmF4LnBlcnNp\nc3RlbmNlLlZhbGlkYXRpb25Nb2RlOwppbXBvcnQgamF2YXgudmFsaWRhdGlv\nbi5tZXRhZGF0YS5CZWFuRGVzY3JpcHRvcjsKaW1wb3J0IGphdmF4LnZhbGlk\nYXRpb24uQ29uc3RyYWludFZpb2xhdGlvbjsKaW1wb3J0IGphdmF4LnZhbGlk\nYXRpb24uQ29uc3RyYWludFZpb2xhdGlvbkV4Y2VwdGlvbjsKaW1wb3J0IGph\ndmF4LnZhbGlkYXRpb24uVmFsaWRhdG9yOwppbXBvcnQgamF2YXgudmFsaWRh\ndGlvbi5WYWxpZGF0b3JGYWN0b3J5OwoKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5jb25mLk9wZW5KUEFDb25maWd1cmF0aW9uOwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLmV2ZW50LkxpZmVjeWNsZUV2ZW50OwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLmxpYi5jb25mLkNvbmZpZ3VyYXRpb247CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLmxvZy5Mb2c7CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuSjJEb1ByaXZIZWxwZXI7CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuTG9jYWxpemVyOwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNlLkpQQVByb3BlcnRp\nZXM7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudmFsaWRhdGlvbi5BYnN0\ncmFjdFZhbGlkYXRvcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS52YWxp\nZGF0aW9uLlZhbGlkYXRpb25FeGNlcHRpb247CgpwdWJsaWMgY2xhc3MgVmFs\naWRhdG9ySW1wbCBleHRlbmRzIEFic3RyYWN0VmFsaWRhdG9yIHsKICAgIAog\nICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgTG9jYWxpemVyIF9sb2MgPSBMb2Nh\nbGl6ZXIuZm9yUGFja2FnZShWYWxpZGF0b3JJbXBsLmNsYXNzKTsKCiAgICBw\ncml2YXRlIFZhbGlkYXRvckZhY3RvcnkgX3ZhbGlkYXRvckZhY3RvcnkgPSBu\ndWxsOwogICAgcHJpdmF0ZSBWYWxpZGF0b3IgX3ZhbGlkYXRvciA9IG51bGw7\nCiAgICBwcml2YXRlIFZhbGlkYXRpb25Nb2RlIF9tb2RlID0gVmFsaWRhdGlv\nbk1vZGUuQVVUTzsKICAgIHByaXZhdGUgT3BlbkpQQUNvbmZpZ3VyYXRpb24g\nX2NvbmYgPSBudWxsOwogICAgcHJpdmF0ZSB0cmFuc2llbnQgTG9nIF9sb2cg\nPSBudWxsOwogICAgCiAgICAvLyBBIG1hcCBzdG9yaW5nIHRoZSB2YWxpZGF0\naW9uIGdyb3VwcyB0byB1c2UgZm9yIGEgcGFydGljdWxhciBldmVudCB0eXBl\nCiAgICBwcml2YXRlIE1hcDxJbnRlZ2VyLCBDbGFzczw/PltdPiBfdmFsaWRh\ndGlvbkdyb3VwcyA9IG5ldyBIYXNoTWFwPEludGVnZXIsQ2xhc3M8Pz5bXT4o\nKTsKICAgICAgICAKICAgIC8vIExvb2t1cCB0YWJsZSBmb3IgZXZlbnQgdG8g\nZ3JvdXAgcHJvcGVydHkgbWFwcGluZyAKICAgIHByaXZhdGUgc3RhdGljIEhh\nc2hNYXA8U3RyaW5nLCBJbnRlZ2VyPiBfdmdNYXBwaW5nID0gbmV3IEhhc2hN\nYXA8U3RyaW5nLCBJbnRlZ2VyPiAoKTsKICAgICAgICAgICAgCiAgICBzdGF0\naWMgewogICAgICAgIF92Z01hcHBpbmcucHV0KEpQQVByb3BlcnRpZXMuVkFM\nSURBVEVfUFJFX1BFUlNJU1QsIExpZmVjeWNsZUV2ZW50LkJFRk9SRV9QRVJT\nSVNUKTsKICAgICAgICBfdmdNYXBwaW5nLnB1dChKUEFQcm9wZXJ0aWVzLlZB\nTElEQVRFX1BSRV9SRU1PVkUsICBMaWZlY3ljbGVFdmVudC5CRUZPUkVfREVM\nRVRFKTsKICAgICAgICBfdmdNYXBwaW5nLnB1dChKUEFQcm9wZXJ0aWVzLlZB\nTElEQVRFX1BSRV9VUERBVEUsICBMaWZlY3ljbGVFdmVudC5CRUZPUkVfVVBE\nQVRFKTsgCiAgICB9CgogICAgLyoqCiAgICAgKiBEZWZhdWx0IGNvbnN0cnVj\ndG9yLiAgQnVpbGRzIGEgZGVmYXVsdCB2YWxpZGF0b3IgZmFjdG9yeSwgaWYg\nYXZhaWxhYmxlCiAgICAgKiBhbmQgY3JlYXRlcyB0aGUgdmFsaWRhdG9yLgog\nICAgICogUmV0dXJucyBhbiBFeGNlcHRpb24gaWYgYSBWYWxpZGF0b3IgY291\nbGQgbm90IGJlIGNyZWF0ZWQuCiAgICAgKi8KICAgIHB1YmxpYyBWYWxpZGF0\nb3JJbXBsKCkgewogICAgICAgIGluaXRpYWxpemUoKTsKICAgIH0KICAgIAog\nICAgcHVibGljIFZhbGlkYXRvckltcGwoQ29uZmlndXJhdGlvbiBjb25mKSB7\nCiAgICAgICAgaWYgKGNvbmYgaW5zdGFuY2VvZiBPcGVuSlBBQ29uZmlndXJh\ndGlvbikgewogICAgICAgICAgICBfY29uZiA9IChPcGVuSlBBQ29uZmlndXJh\ndGlvbiljb25mOwogICAgICAgICAgICBfbG9nID0gX2NvbmYuZ2V0TG9nKE9w\nZW5KUEFDb25maWd1cmF0aW9uLkxPR19SVU5USU1FKTsKICAgICAgICAgICAg\nT2JqZWN0IHZhbGlkYXRvckZhY3RvcnkgPSBfY29uZi5nZXRWYWxpZGF0aW9u\nRmFjdG9yeUluc3RhbmNlKCk7CiAgICAgICAgICAgIFN0cmluZyBtb2RlID0g\nX2NvbmYuZ2V0VmFsaWRhdGlvbk1vZGUoKTsKICAgICAgICAgICAgX21vZGUg\nPSBFbnVtLnZhbHVlT2YoVmFsaWRhdGlvbk1vZGUuY2xhc3MsIG1vZGUpOwog\nICAgICAgICAgICBpZiAodmFsaWRhdG9yRmFjdG9yeSAhPSBudWxsKSB7CiAg\nICAgICAgICAgICAgICBpZiAodmFsaWRhdG9yRmFjdG9yeSBpbnN0YW5jZW9m\nIFZhbGlkYXRvckZhY3RvcnkpIHsKICAgICAgICAgICAgICAgICAgICBfdmFs\naWRhdG9yRmFjdG9yeSA9IChWYWxpZGF0b3JGYWN0b3J5KXZhbGlkYXRvckZh\nY3Rvcnk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAg\nICAgICAgIC8vIFN1cHBsaWVkIG9iamVjdCB3YXMgbm90IGFuIGluc3RhbmNl\nIG9mIGEgVmFsaWRhdG9yRmFjdG9yeQogICAgICAgICAgICAgICAgICAgIHRo\ncm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24oCiAgICAgICAgICAg\nICAgICAgICAgICAgIF9sb2MuZ2V0KCJpbnZhbGlkLWZhY3RvcnkiKS5nZXRN\nZXNzYWdlKCkpOyAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIH0K\nICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBpbml0aWFsaXplKCk7\nCiAgICB9CiAgICAKICAgIC8qKgogICAgICogVHlwZS1zcGVjaWZpYyBjb25z\ndHJ1Y3RvcgogICAgICogUmV0dXJucyBhbiBFeGNlcHRpb24gaWYgYSBWYWxp\nZGF0b3IgY291bGQgbm90IGJlIGNyZWF0ZWQuCiAgICAgKiBAcGFyYW0gdmFs\naWRhdG9yRmFjdG9yeSBJbnN0YW5jZSBvZiB2YWxpZGF0b3IgZmFjdG9yeSB0\nbyB1c2UuICBTcGVjaWZ5CiAgICAgKiAgICAgICAgbnVsbCB0byB1c2UgdGhl\nIGRlZmF1bHQgZmFjdG9yeS4KICAgICAqIEBwYXJhbSBtb2RlIFZhbGRpYXRp\nb25Nb2RlIGVudW0gdmFsdWUKICAgICAqLwogICAgcHVibGljIFZhbGlkYXRv\nckltcGwoVmFsaWRhdG9yRmFjdG9yeSB2YWxpZGF0b3JGYWN0b3J5LAogICAg\nICAgIFZhbGlkYXRpb25Nb2RlIG1vZGUpIHsKICAgICAgICBpZiAobW9kZSAh\nPSBudWxsKSB7CiAgICAgICAgICAgIF9tb2RlID0gbW9kZTsKICAgICAgICB9\nCiAgICAgICAgaWYgKHZhbGlkYXRvckZhY3RvcnkgIT0gbnVsbCkgewogICAg\nICAgICAgICBfdmFsaWRhdG9yRmFjdG9yeSA9IHZhbGlkYXRvckZhY3Rvcnk7\nCiAgICAgICAgfQogICAgICAgIGluaXRpYWxpemUoKTsKICAgIH0KCiAgICAv\nKioKICAgICAqIENvbW1vbiBzZXR1cCBjb2RlIGZhY3RvcmVkIG91dCBvZiB0\naGUgY29uc3RydWN0b3JzCiAgICAgKi8KICAgIHByaXZhdGUgdm9pZCBpbml0\naWFsaXplKCkgewogICAgICAgIC8vIG9ubHkgdHJ5IHNldHRpbmcgdXAgYSB2\nYWxpZGF0b3IgaWYgbW9kZSBpcyBub3QgTk9ORQogICAgICAgIGlmIChfbW9k\nZSAhPSBWYWxpZGF0aW9uTW9kZS5OT05FKSB7CiAgICAgICAgICAgIGlmIChf\ndmFsaWRhdG9yRmFjdG9yeSA9PSBudWxsKSB7CiAgICAgICAgICAgICAgICBf\ndmFsaWRhdG9yRmFjdG9yeSA9IGdldERlZmF1bHRWYWxpZGF0b3JGYWN0b3J5\nKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKF92YWxpZGF0b3JG\nYWN0b3J5ICE9IG51bGwpIHsKICAgICAgICAgICAgICAgIC8vIHVzZSBvdXIg\nVHJhdmVyc2FibGVSZXNvbHZlciBpbnN0ZWFkIG9mIEJWIHByb3ZpZGVyIG9u\nZQogICAgICAgICAgICAgICAgX3ZhbGlkYXRvciA9IF92YWxpZGF0b3JGYWN0\nb3J5LnVzaW5nQ29udGV4dCgpLgogICAgICAgICAgICAgICAgICAgIHRyYXZl\ncnNhYmxlUmVzb2x2ZXIobmV3IFRyYXZlcnNhYmxlUmVzb2x2ZXJJbXBsKCkp\nLgogICAgICAgICAgICAgICAgICAgIGdldFZhbGlkYXRvcigpOwogICAgICAg\nICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgLy8gQSBkZWZhdWx0IFZh\nbGlkYXRvckZhY3RvcnkgY291bGQgbm90IGJlIGNyZWF0ZWQuCiAgICAgICAg\nICAgICAgICB0aHJvdyBuZXcgUnVudGltZUV4Y2VwdGlvbigKICAgICAgICAg\nICAgICAgICAgICBfbG9jLmdldCgibm8tZGVmYXVsdC1mYWN0b3J5IikuZ2V0\nTWVzc2FnZSgpKTsKICAgICAgICAgICAgfQogICAgICAgICAgICAKICAgICAg\nICAgICAgLy8gdGhyb3cgYW4gZXhjZXB0aW9uIGlmIHdlIGhhdmUgbm8gVmFs\naWRhdG9yCiAgICAgICAgICAgIGlmIChfdmFsaWRhdG9yID09IG51bGwpIHsK\nICAgICAgICAgICAgICAgIC8vIEEgVmFsaWRhdG9yIHByb3ZpZGVyIGNvdWxk\nIG5vdCBiZSBjcmVhdGVkLgogICAgICAgICAgICAgICAgdGhyb3cgbmV3IFJ1\nbnRpbWVFeGNlcHRpb24oCiAgICAgICAgICAgICAgICAgICAgX2xvYy5nZXQo\nIm5vLXZhbGlkYXRvciIpLmdldE1lc3NhZ2UoKSk7CiAgICAgICAgICAgIH0K\nCiAgICAgICAgICAgIGlmIChfY29uZiAhPSBudWxsKSB7CiAgICAgICAgICAg\nICAgICBhZGRWYWxpZGF0aW9uR3JvdXAoSlBBUHJvcGVydGllcy5WQUxJREFU\nRV9QUkVfUEVSU0lTVCwgX2NvbmYuZ2V0VmFsaWRhdGlvbkdyb3VwUHJlUGVy\nc2lzdCgpKTsKICAgICAgICAgICAgICAgIGFkZFZhbGlkYXRpb25Hcm91cChK\nUEFQcm9wZXJ0aWVzLlZBTElEQVRFX1BSRV9VUERBVEUsICBfY29uZi5nZXRW\nYWxpZGF0aW9uR3JvdXBQcmVVcGRhdGUoKSk7CiAgICAgICAgICAgICAgICBh\nZGRWYWxpZGF0aW9uR3JvdXAoSlBBUHJvcGVydGllcy5WQUxJREFURV9QUkVf\nUkVNT1ZFLCAgX2NvbmYuZ2V0VmFsaWRhdGlvbkdyb3VwUHJlUmVtb3ZlKCkp\nOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgLy8gYWRk\nIGluIGRlZmF1bHQgdmFsaWRhdGlvbiBncm91cHMsIHdoaWNoIGNhbiBiZSBv\ndmVyLXJpZGRlbiBsYXRlcgogICAgICAgICAgICAgICAgYWRkRGVmYXVsdFZh\nbGlkYXRpb25Hcm91cHMoKTsKICAgICAgICAgICAgfQogICAgICAgIH0gZWxz\nZSB7CiAgICAgICAgICAgIC8vIEEgVmFsaWRhdG9yIHNob3VsZCBub3QgYmUg\nY3JlYXRlZCBiYXNlZCBvbiB0aGUgc3VwcGxpZWQgVmFsaWRhdGlvbk1vZGUu\nCiAgICAgICAgICAgIHRocm93IG5ldyBSdW50aW1lRXhjZXB0aW9uKAogICAg\nICAgICAgICAgICAgX2xvYy5nZXQoIm5vLXZhbGlkYXRpb24iKS5nZXRNZXNz\nYWdlKCkpOwogICAgICAgIH0KICAgIH0KICAgIAogICAgLyoqCiAgICAgKiBB\nZGQgYSB2YWxpZGF0aW9uIGdyb3VwIGZvciB0aGUgc3BlY2lmaWMgcHJvcGVy\ndHkuICBUaGUgcHJvcGVydGllcyBtYXAKICAgICAqIHRvIGEgc3BlY2lmaWMg\nbGlmZWN5Y2xlIGV2ZW50LiAgVG8gZGlzYWJsZSB2YWxpZGF0aW9uIGZvciBh\nIGdyb3VwLCBzZXQKICAgICAqIHRoZSB2YWxpZGF0aW9uIGdyb3VwIHRvIG51\nbGwuCiAgICAgKiAKICAgICAqIEBwYXJhbSB2YWxpZGF0aW9uR3JvdXBOYW1l\nCiAgICAgKiBAcGFyYW0gdmdzCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIGFk\nZFZhbGlkYXRpb25Hcm91cChTdHJpbmcgdmFsaWRhdGlvbkdyb3VwTmFtZSwg\nQ2xhc3M8Pz4uLi52Z3MpIHsKICAgICAgICBJbnRlZ2VyIGV2ZW50ID0gZmlu\nZEV2ZW50KHZhbGlkYXRpb25Hcm91cE5hbWUpOwogICAgICAgIGlmIChldmVu\ndCAhPSBudWxsKSB7CiAgICAgICAgICAgIF92YWxpZGF0aW9uR3JvdXBzLnB1\ndChldmVudCwgdmdzKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0g\nZWxzZSB7CiAgICAgICAgICAgIC8vIFRoZXJlIHdlcmUgbm8gZXZlbnRzIGZv\ndW5kIGZvciBncm91cCAiezB9Ii4KICAgICAgICAgICAgdGhyb3cgbmV3IEls\nbGVnYWxBcmd1bWVudEV4Y2VwdGlvbigKICAgICAgICAgICAgICAgIF9sb2Mu\nZ2V0KCJuby1ncm91cC1ldmVudHMiLCB2YWxpZGF0aW9uR3JvdXBOYW1lKS5n\nZXRNZXNzYWdlKCkpOwogICAgICAgIH0KICAgIH0KICAgICAgICAgICAgCiAg\nICAvKioKICAgICAqIEFkZCBhIHZhbGlkYXRpb24gZ3JvdXAgZm9yIGEgc3Bl\nY2lmaWVkIGV2ZW50LiAgRXZlbnQgZGVmaW5pdGlvbnMKICAgICAqIGFyZSBk\nZWZpbmVkIGluIExpZmVjeWNsZUV2ZW50LiAgVG8gZGlzYWJsZSB2YWxpZGF0\naW9uIGZvciBhIGdyb3VwLCBzZXQKICAgICAqIHRoZSB2YWxpZGF0aW9uIGdy\nb3VwIHRvIG51bGwuCiAgICAgKiAKICAgICAqIEBwYXJhbSBldmVudAogICAg\nICogQHBhcmFtIHZhbGlkYXRpb25Hcm91cAogICAgICovCiAgICBwdWJsaWMg\ndm9pZCBhZGRWYWxpZGF0aW9uR3JvdXAoSW50ZWdlciBldmVudCwgQ2xhc3M8\nPz4uLi4gdmFsaWRhdGlvbkdyb3VwKSB7CiAgICAgICAgX3ZhbGlkYXRpb25H\ncm91cHMucHV0KGV2ZW50LCB2YWxpZGF0aW9uR3JvdXApOyAgICAgICAgCiAg\nICB9CiAgICAKICAgIC8qKgogICAgICogQWRkIHRoZSB2YWxpZGF0aW9uIGdy\nb3VwKHMpIGZvciB0aGUgc3BlY2lmaWVkIGV2ZW50LiAgRXZlbnQgZGVmaW5p\ndGlvbnMKICAgICAqIGFyZSBkZWZpbmVkIGluIExpZmVjeWNsZUV2ZW50CiAg\nICAgKiBAcGFyYW0gZXZlbnQKICAgICAqIEBwYXJhbSBncm91cAogICAgICov\nCiAgICBwdWJsaWMgdm9pZCBhZGRWYWxpZGF0aW9uR3JvdXAoU3RyaW5nIHZh\nbGlkYXRpb25Hcm91cE5hbWUsIFN0cmluZyBncm91cCkgewogICAgICAgIElu\ndGVnZXIgZXZlbnQgPSBmaW5kRXZlbnQodmFsaWRhdGlvbkdyb3VwTmFtZSk7\nCiAgICAgICAgaWYgKGV2ZW50ICE9IG51bGwpIHsKICAgICAgICAgICAgQ2xh\nc3M8Pz5bXSB2Z3MgPSBnZXRWYWxpZGF0aW9uR3JvdXAodmFsaWRhdGlvbkdy\nb3VwTmFtZSwgZ3JvdXApOwogICAgICAgICAgICBpZiAodmdzICE9IG51bGwp\nIHsKICAgICAgICAgICAgICAgIGFkZFZhbGlkYXRpb25Hcm91cChldmVudCwg\ndmdzKTsKICAgICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAg\nICAgIC8vIFRoZXJlIHdlcmUgbm8gZXZlbnRzIGZvdW5kIGZvciBncm91cCAi\nezB9Ii4KICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4\nY2VwdGlvbigKICAgICAgICAgICAgICAgIF9sb2MuZ2V0KCJuby1ncm91cC1l\ndmVudHMiLCB2YWxpZGF0aW9uR3JvdXBOYW1lKS5nZXRNZXNzYWdlKCkpOwog\nICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIENvbnZlcnRzIGEgY29t\nbWEgc2VwYXJhdGVkIGxpc3Qgb2YgdmFsaWRhdGlvbiBncm91cHMgaW50byBh\nbiBhcnJheQogICAgICogb2YgY2xhc3Nlcy4KICAgICAqIEBwYXJhbSBncm91\ncAogICAgICogQHJldHVybgogICAgICovCiAgICBwcml2YXRlIENsYXNzPD8+\nW10gZ2V0VmFsaWRhdGlvbkdyb3VwKFN0cmluZyB2Z05hbWUsIFN0cmluZyBn\ncm91cCkgewogICAgICAgIENsYXNzPD8+W10gdmdHcnAgPSBudWxsOwogICAg\nICAgIGlmIChncm91cCA9PSBudWxsIHx8IGdyb3VwLnRyaW0oKS5sZW5ndGgo\nKSA9PSAwKSB7CiAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgIH0K\nICAgICAgICBTdHJpbmdbXSBzdHJDbGFzc2VzID0gZ3JvdXAuc3BsaXQoIiwi\nKTsKICAgICAgICBpZiAoc3RyQ2xhc3Nlcy5sZW5ndGggPiAwKSB7CiAgICAg\nICAgICAgIHZnR3JwID0gbmV3IENsYXNzPD8+W3N0ckNsYXNzZXMubGVuZ3Ro\nXTsKICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBzdHJDbGFzc2Vz\nLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgICB0cnkgewogICAgICAg\nICAgICAgICAgICAgIHZnR3JwW2ldID0gIENsYXNzLmZvck5hbWUoc3RyQ2xh\nc3Nlc1tpXSk7CiAgICAgICAgICAgICAgICB9IGNhdGNoIChUaHJvd2FibGUg\ndCkgewogICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJn\ndW1lbnRFeGNlcHRpb24oCiAgICAgICAgICAgICAgICAgICAgICAgIF9sb2Mu\nZ2V0KCJpbnZhbGlkLXZhbGlkYXRpb24tZ3JvdXAiLCBzdHJDbGFzc2VzW2ld\nLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZnTmFtZSkuZ2V0TWVz\nc2FnZSgpLCB0KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSAg\nICAgICAgICAgIAogICAgICAgIH0KICAgICAgICByZXR1cm4gdmdHcnA7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIHZhbGlkYXRpb24gZ3Jv\ndXBzIHRvIGJlIHZhbGlkYXRlZCBmb3IgYSBzcGVjaWZpZWQgZXZlbnQKICAg\nICAqIEBwYXJhbSBldmVudCBMaWZlY3ljbGUgZXZlbnQgaWQKICAgICAqIEBy\nZXR1cm4gQW4gYXJyYXkgb2YgdmFsaWRhdGlvbiBncm91cHMKICAgICAqLwog\nICAgcHVibGljIENsYXNzPD8+W10gZ2V0VmFsaWRhdGlvbkdyb3VwKEludGVn\nZXIgZXZlbnQpIHsKICAgICAgICByZXR1cm4gX3ZhbGlkYXRpb25Hcm91cHMu\nZ2V0KGV2ZW50KTsKICAgIH0KICAgIAogICAgLyoqCiAgICAgKiBSZXR1cm5z\nIHdoZXRoZXIgdGhlIFZhbGlkYXRvciBpcyB2YWxpZGF0aW5nIGZvciB0aGUg\nCiAgICAgKiBzcGVjaWZpZWQgZXZlbnQuICBCYXNlZCBvbiB3aGV0aGVyIHZh\nbGlkYXRpb24gZ3JvdXBzIGFyZSBzcGVjaWZpZWQgZm9yCiAgICAgKiB0aGUg\nZXZlbnQuCiAgICAgKiAKICAgICAqIEBwYXJhbSBldmVudCB0aGUgZXZlbnQg\ndG8gY2hlY2sgZm9yIHZhbGlkYXRpb24KICAgICAqIEByZXR1cm4gcmV0dXJu\ncyB0cnVlIGlmIHZhbGlkYXRpbmcgZm9yIHRoaXMgcGFydGljdWxhciBldmVu\ndAogICAgICovCiAgICBwdWJsaWMgYm9vbGVhbiBpc1ZhbGlkYXRpbmcoSW50\nZWdlciBldmVudCkgewogICAgICAgIHJldHVybiAoX3ZhbGlkYXRpb25Hcm91\ncHMuZ2V0KGV2ZW50KSAhPSBudWxsKTsKICAgIH0KCiAgICAvKioKICAgICAq\nIFJldHVybnMgdGhlIHZhbGlkYXRpb24gY29uc3RyYWludHMgZm9yIHRoZSBz\ncGVjaWZpZWQgY2xhc3MKICAgICAqIAogICAgICogQHBhcmFtIGNscyBDbGFz\ncyBmb3Igd2hpY2ggY29uc3RyYWludHMgdG8gcmV0dXJuCiAgICAgKiBAcmV0\ndXJuIFRoZSB2YWxpZGF0aW9uIGJlYW4gZGVzY3JpcHRvcgogICAgICovCiAg\nICBwdWJsaWMgQmVhbkRlc2NyaXB0b3IgZ2V0Q29uc3RyYWludHNGb3JDbGFz\ncyhDbGFzczw/PiBjbHMpIHsKICAgICAgICByZXR1cm4gX3ZhbGlkYXRvci5n\nZXRDb25zdHJhaW50c0ZvckNsYXNzKGNscyk7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBWYWxpZGF0ZXMgYSBnaXZlbiBpbnN0YW5jZQogICAgICogCiAgICAg\nKiBAcGFyYW0gPFQ+IFRoZSBpbnN0YW5jZSB0byB2YWxpZGF0ZQogICAgICog\nQHBhcmFtIGFyZzAgVGhlIGNsYXNzLCBvZiB0eXBlIFQgdG8gdmFsaWRhdGUK\nICAgICAqIEBwYXJhbSBldmVudCBUaGUgZXZlbnQgaWQKICAgICAqIEByZXR1\ncm4gVmFsaWRhdGlvbkV4Y2VwdGlvbiBpZiB0aGUgdmFsaWRhdG9yIHByb2R1\nY2VzIG9uZSBvciBtb3JlCiAgICAgKiAgICAgICAgIGNvbnN0cmFpbnQgdmlv\nbGF0aW9ucy4KICAgICAqLwogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgPFQ+\nIFZhbGlkYXRpb25FeGNlcHRpb24gdmFsaWRhdGUoVCBhcmcwLCBpbnQgZXZl\nbnQpIHsgCiAgICAgICAgaWYgKCFpc1ZhbGlkYXRpbmcoZXZlbnQpKQogICAg\nICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICBTZXQ8Q29uc3RyYWludFZp\nb2xhdGlvbjxUPj4gdmlvbGF0aW9ucyA9IEFjY2Vzc0NvbnRyb2xsZXIuZG9Q\ncml2aWxlZ2VkKAogICAgICAgICAgICAgICAgSjJEb1ByaXZIZWxwZXIudmFs\naWRhdGVBY3Rpb24oX3ZhbGlkYXRvciwgYXJnMCwgZ2V0VmFsaWRhdGlvbkdy\nb3VwKGV2ZW50KSkpOwoKICAgICAgICBpZiAodmlvbGF0aW9ucyAhPSBudWxs\nICYmIHZpb2xhdGlvbnMuc2l6ZSgpID4gMCkgewogICAgICAgICAgICByZXR1\ncm4gbmV3IFZhbGlkYXRpb25FeGNlcHRpb24oCiAgICAgICAgICAgICAgICBu\nZXcgQ29uc3RyYWludFZpb2xhdGlvbkV4Y2VwdGlvbigKICAgICAgICAgICAg\nICAgICAgICAvLyBBIHZhbGlkYXRpb24gY29uc3RyYWludCBmYWlsdXJlIG9j\nY3VycmVkIGZvciBjbGFzcyAiezB9Ii4KICAgICAgICAgICAgICAgICAgICBf\nbG9jLmdldCgidmFsaWRhdGUtZmFpbGVkIiwKICAgICAgICAgICAgICAgICAg\nICAgICAgYXJnMC5nZXRDbGFzcygpLmdldE5hbWUoKSkuZ2V0TWVzc2FnZSgp\nLAogICAgICAgICAgICAgICAgICAgIChTZXQpdmlvbGF0aW9ucyksCiAgICAg\nICAgICAgICAgICB0cnVlKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIG51\nbGw7CiAgICB9CgogICAgLyoqCiAgICAgKiBWYWxpZGF0ZXMgYSBwcm9wZXJ0\neSBvZiBhIGdpdmVuIGluc3RhbmNlCiAgICAgKiAKICAgICAqIEBwYXJhbSA8\nVD4gVGhlIGluc3RhbmNlIHRvIHZhbGlkYXRlCiAgICAgKiBAcGFyYW0gYXJn\nMCBUaGUgcHJvcGVydHkgdG8gdmFsaWRhdGUKICAgICAqIEBwYXJhbSBwcm9w\nZXJ0eSBUaGUgcHJvcGVydHkgdG8gdmFsaWRhdGUKICAgICAqIEBwYXJhbSBl\ndmVudCBUaGUgZXZlbnQgaWQKICAgICAqIEByZXR1cm4gVmFsaWRhdGlvbkV4\nY2VwdGlvbiBpZiB0aGUgdmFsaWRhdG9yIHByb2R1Y2VzIG9uZSBvciBtb3Jl\nCiAgICAgKiAgICAgICAgIGNvbnN0cmFpbnQgdmlvbGF0aW9ucy4KICAgICAq\nLwogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgPFQ+IFZhbGlkYXRpb25FeGNl\ncHRpb24gdmFsaWRhdGVQcm9wZXJ0eShUIGFyZzAsIFN0cmluZyBwcm9wZXJ0\neSwKICAgICAgICBpbnQgZXZlbnQpIHsKICAgICAgICBpZiAoIWlzVmFsaWRh\ndGluZyhldmVudCkpCiAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAg\nIFNldDxDb25zdHJhaW50VmlvbGF0aW9uPFQ+PiB2aW9sYXRpb25zID0gCiAg\nICAgICAgICAgIF92YWxpZGF0b3IudmFsaWRhdGVQcm9wZXJ0eShhcmcwLCBw\ncm9wZXJ0eSwgCiAgICAgICAgICAgICAgICBnZXRWYWxpZGF0aW9uR3JvdXAo\nZXZlbnQpKTsKICAgICAgICBpZiAodmlvbGF0aW9ucyAhPSBudWxsICYmIHZp\nb2xhdGlvbnMuc2l6ZSgpID4gMCkgewogICAgICAgICAgICByZXR1cm4gbmV3\nIFZhbGlkYXRpb25FeGNlcHRpb24oCiAgICAgICAgICAgICAgICBuZXcgQ29u\nc3RyYWludFZpb2xhdGlvbkV4Y2VwdGlvbigKICAgICAgICAgICAgICAgICAg\nICAvLyBBIHZhbGlkYXRpb24gY29uc3RyYWludCBmYWlsdXJlIG9jY3VycmVk\nIGZvciAKICAgICAgICAgICAgICAgICAgICAvLyBwcm9wZXJ0eSAiezF9IiBp\nbiBjbGFzcyAiezB9Ii4KICAgICAgICAgICAgICAgICAgICBfbG9jLmdldCgi\ndmFsZGlhdGUtcHJvcGVydHktZmFpbGVkIiwKICAgICAgICAgICAgICAgICAg\nICAgICAgYXJnMC5nZXRDbGFzcygpLmdldE5hbWUoKSxwcm9wZXJ0eSkuZ2V0\nTWVzc2FnZSgpLAogICAgICAgICAgICAgICAgICAgIChTZXQpdmlvbGF0aW9u\ncyksCiAgICAgICAgICAgICAgICB0cnVlKTsKICAgICAgICB9CiAgICAgICAg\ncmV0dXJuIG51bGw7CiAgICB9CgogICAgLyoqCiAgICAgKiBWYWxpZGF0ZXMg\nYSB2YWx1ZSBiYXNlZCB1cG9uIHRoZSBjb25zdHJhaW50cyBhcHBsaWVkIHRv\nIGEgZ2l2ZW4gY2xhc3MKICAgICAqIGF0dHJpYnV0ZS4KICAgICAqIEBwYXJh\nbSA8VD4gVGhlIGluc3RhbmNlIHR5cGUgdG8gYmFzZSB2YWxpZGF0aW9uIHVw\nb24KICAgICAqIEBwYXJhbSBhcmcwIFRoZSBjbGFzcyBvZiB0eXBlIFQgdG8g\ndmFsaWRhdGUKICAgICAqIEBwYXJhbSBhcmcxIFRoZSBwcm9wZXJ0eSB0byB2\nYWxpZGF0ZQogICAgICogQHBhcmFtIGFyZzIgVGhlIHByb3BlcnR5IHZhbHVl\nIHRvIHZhbGlkYXRlCiAgICAgKiBAcGFyYW0gZXZlbnQgVGhlIGV2ZW50IGlk\nCiAgICAgKiBAcmV0dXJuIFZhbGlkYXRpb25FeGNlcHRpb24gaWYgdGhlIHZh\nbGlkYXRvciBwcm9kdWNlcyBvbmUgb3IgbW9yZQogICAgICogICAgICAgICBj\nb25zdHJhaW50IHZpb2xhdGlvbnMuCiAgICAgKi8KICAgIEBPdmVycmlkZQog\nICAgcHVibGljIDxUPiBWYWxpZGF0aW9uRXhjZXB0aW9uIHZhbGlkYXRlVmFs\ndWUoQ2xhc3M8VD4gYXJnMCwgCiAgICAgICAgU3RyaW5nIGFyZzEsIE9iamVj\ndCBhcmcyLCBpbnQgZXZlbnQpICB7CiAgICAgICAgaWYgKCFpc1ZhbGlkYXRp\nbmcoZXZlbnQpKQogICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICBT\nZXQ8Q29uc3RyYWludFZpb2xhdGlvbjxUPj4gdmlvbGF0aW9ucyA9IAogICAg\nICAgICAgICBfdmFsaWRhdG9yLnZhbGlkYXRlVmFsdWUoYXJnMCwgYXJnMSwg\nYXJnMiwgCiAgICAgICAgICAgICAgICBnZXRWYWxpZGF0aW9uR3JvdXAoZXZl\nbnQpKTsKICAgICAgICBpZiAodmlvbGF0aW9ucyAhPSBudWxsICYmIHZpb2xh\ndGlvbnMuc2l6ZSgpID4gMCkgewogICAgICAgICAgICByZXR1cm4gbmV3IFZh\nbGlkYXRpb25FeGNlcHRpb24oCiAgICAgICAgICAgICAgICBuZXcgQ29uc3Ry\nYWludFZpb2xhdGlvbkV4Y2VwdGlvbigKICAgICAgICAgICAgICAgICAgICAv\nLyBBIHZhbGlkYXRpb24gY29uc3RyYWludCBmYWlsdXJlIG9jY3VycmVkIGZv\nciAKICAgICAgICAgICAgICAgICAgICAvLyB2YWx1ZSAiezJ9IiBvZiBwcm9w\nZXJ0eSAiezF9IiBpbiBjbGFzcyAiezB9Ii4KICAgICAgICAgICAgICAgICAg\nICBfbG9jLmdldCgidmFsaWRhdGUtdmFsdWUtZmFpbGVkIiwgYXJnMC5nZXRD\nbGFzcygpLmdldE5hbWUoKSwKICAgICAgICAgICAgICAgICAgICAgICAgYXJn\nMSwgYXJnMi50b1N0cmluZygpKS5nZXRNZXNzYWdlKCksICAgICAgICAgICAg\nICAgICAgICAKICAgICAgICAgICAgICAgICAgICAoU2V0KXZpb2xhdGlvbnMp\nLAogICAgICAgICAgICAgICAgdHJ1ZSk7CiAgICAgICAgfQogICAgICAgIHJl\ndHVybiBudWxsOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJucyB3aGV0\naGVyIHZhbGlkYXRpb24gaXMgYWN0aXZlIGZvciB0aGUgZ2l2ZW4gZXZlbnQu\nCiAgICAgKiAKICAgICAqIEBwYXJhbSA8VD4KICAgICAqIEBwYXJhbSBhcmcw\nIFR5cGUgYmVpbmcgdmFsaWRhdGVkCiAgICAgKiBAcGFyYW0gZXZlbnQgZXZl\nbnQgdHlwZQogICAgICogQHJldHVybiB0cnVlIGlmIHZhbGlkYXRpb24gaXMg\nYWN0aXZlIGZvciB0aGUgc3BlY2lmaWVkIGV2ZW50CiAgICAgKi8KICAgIEBP\ndmVycmlkZQogICAgcHVibGljIDxUPiBib29sZWFuIHZhbGlkYXRpbmcoVCBh\ncmcwLCBpbnQgZXZlbnQpIHsKICAgICAgICAvLyBUT0RPOiBUaGlzIG1ldGhv\nZCB3aWxsIGFsc28gbWFrZSBhIGRldGVybWluYXRpb24gYmFzZWQgdXBvbiB3\naGljaCAKICAgICAgICAvLyBncm91cHMgYXJlIHZhbGlkYXRpbmcgYW5kIHRo\nZSBncm91cCBkZWZpbmVkIG9uIHRoZSBjbGFzcwogICAgICAgIHJldHVybiBp\nc1ZhbGlkYXRpbmcoZXZlbnQpOwogICAgfQogICAgCiAgICAvLyBMb29rdXAg\ndGhlIGxpZmVjeWNsZSBldmVudCBpZCBmb3IgdGhlIHZhbGlkYXRpb25Qcm9w\nZXJ0eQogICAgcHJpdmF0ZSBJbnRlZ2VyIGZpbmRFdmVudChTdHJpbmcgdmFs\naWRhdGlvblByb3BlcnR5KSB7CiAgICAgICAgcmV0dXJuIF92Z01hcHBpbmcu\nZ2V0KHZhbGlkYXRpb25Qcm9wZXJ0eSk7CiAgICB9CiAgICAKICAgIC8vIEdl\ndCB0aGUgZGVmYXVsdCB2YWxpZGF0b3IgZmFjdG9yeQogICAgcHJpdmF0ZSBW\nYWxpZGF0b3JGYWN0b3J5IGdldERlZmF1bHRWYWxpZGF0b3JGYWN0b3J5KCkg\newogICAgICAgIFZhbGlkYXRvckZhY3RvcnkgZmFjdG9yeSA9IG51bGw7CiAg\nICAgICAgdHJ5IHsKICAgICAgICAgICAgZmFjdG9yeSA9IEFjY2Vzc0NvbnRy\nb2xsZXIuZG9Qcml2aWxlZ2VkKEoyRG9Qcml2SGVscGVyLmJ1aWxkRGVmYXVs\ndFZhbGlkYXRvckZhY3RvcnlBY3Rpb24oKSk7CiAgICAgICAgfSBjYXRjaCAo\namF2YXgudmFsaWRhdGlvbi5WYWxpZGF0aW9uRXhjZXB0aW9uIGUpIHsKICAg\nICAgICAgICAgaWYgKF9sb2cgIT0gbnVsbCAmJiBfbG9nLmlzVHJhY2VFbmFi\nbGVkKCkpCiAgICAgICAgICAgICAgICBfbG9nLnRyYWNlKF9sb2MuZ2V0KCJm\nYWN0b3J5LWNyZWF0ZS1mYWlsZWQiKSwgZSk7CiAgICAgICAgfQogICAgICAg\nIHJldHVybiBmYWN0b3J5OwogICAgfQogICAgCiAgICAvLyBQZXIgSlNSLTMx\nNywgdGhlIHByZS1wZXJzaXN0IGFuZCBwcmUtdXBkYXRlIGdyb3VwcyB3aWxs\nIHZhbGlkYXRlIHVzaW5nCiAgICAvLyB0aGUgZGVmYXVsdCB2YWxpZGF0aW9u\nIGdyb3VwIGFuZCBwcmUtcmVtb3ZlIHdpbGwgbm90IHZhbGlkYXRlIChubyAK\nICAgIC8vIHZhbGlkYXRpb24gZ3JvdXApCiAgICBwcml2YXRlIHZvaWQgYWRk\nRGVmYXVsdFZhbGlkYXRpb25Hcm91cHMoKSB7CiAgICAgICAgYWRkVmFsaWRh\ndGlvbkdyb3VwKEpQQVByb3BlcnRpZXMuVkFMSURBVEVfUFJFX1BFUlNJU1Qs\nIGphdmF4LnZhbGlkYXRpb24uZ3JvdXBzLkRlZmF1bHQuY2xhc3MpOwogICAg\nICAgIGFkZFZhbGlkYXRpb25Hcm91cChKUEFQcm9wZXJ0aWVzLlZBTElEQVRF\nX1BSRV9VUERBVEUsICBqYXZheC52YWxpZGF0aW9uLmdyb3Vwcy5EZWZhdWx0\nLmNsYXNzKTsKICAgIH0KfQo=\n","encoding":"base64"}

