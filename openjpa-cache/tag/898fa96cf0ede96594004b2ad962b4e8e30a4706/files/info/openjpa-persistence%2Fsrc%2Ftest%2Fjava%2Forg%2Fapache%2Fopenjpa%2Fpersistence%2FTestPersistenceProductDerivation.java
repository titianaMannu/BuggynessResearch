{"sha":"4d81080aa270f2a779a72559493bbb45e7493c8f","node_id":"MDQ6QmxvYjIwNjM2NDo0ZDgxMDgwYWEyNzBmMmE3NzlhNzI1NTk0OTNiYmI0NWU3NDkzYzhm","size":12347,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/4d81080aa270f2a779a72559493bbb45e7493c8f","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNr\nYWdlIG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZTsKCmltcG9ydCBq\nYXZhLmlvLkJ1ZmZlcmVkSW5wdXRTdHJlYW07CmltcG9ydCBqYXZhLmlvLkJ1\nZmZlcmVkT3V0cHV0U3RyZWFtOwppbXBvcnQgamF2YS5pby5GaWxlOwppbXBv\ncnQgamF2YS5pby5GaWxlSW5wdXRTdHJlYW07CmltcG9ydCBqYXZhLmlvLkZp\nbGVPdXRwdXRTdHJlYW07CmltcG9ydCBqYXZhLmlvLklPRXhjZXB0aW9uOwpp\nbXBvcnQgamF2YS5uZXQuVVJMOwppbXBvcnQgamF2YS5uZXQuVVJMQ2xhc3NM\nb2FkZXI7CmltcG9ydCBqYXZhLnNlY3VyaXR5LkFjY2Vzc0NvbnRyb2xsZXI7\nCmltcG9ydCBqYXZhLnNlY3VyaXR5LlByaXZpbGVnZWRBY3Rpb25FeGNlcHRp\nb247CmltcG9ydCBqYXZhLnV0aWwuQXJyYXlzOwppbXBvcnQgamF2YS51dGls\nLkNvbGxlY3Rpb25zOwppbXBvcnQgamF2YS51dGlsLkVudW1lcmF0aW9uOwpp\nbXBvcnQgamF2YS51dGlsLkhhc2hNYXA7CmltcG9ydCBqYXZhLnV0aWwuTGlz\ndDsKaW1wb3J0IGphdmEudXRpbC5qYXIuSmFyRW50cnk7CmltcG9ydCBqYXZh\nLnV0aWwuamFyLkphck91dHB1dFN0cmVhbTsKCmltcG9ydCBqdW5pdC5mcmFt\nZXdvcmsuVGVzdENhc2U7CgppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmNv\nbmYuT3BlbkpQQUNvbmZpZ3VyYXRpb247CmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEuY29uZi5PcGVuSlBBQ29uZmlndXJhdGlvbkltcGw7CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEubGliLmNvbmYuQ29uZmlndXJhdGlvblByb3Zp\nZGVyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi5lbmNyeXB0aW9u\nLkVuY3J5cHRpb25Qcm92aWRlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3Blbmpw\nYS5saWIudXRpbC5KMkRvUHJpdkhlbHBlcjsKCnB1YmxpYyBjbGFzcyBUZXN0\nUGVyc2lzdGVuY2VQcm9kdWN0RGVyaXZhdGlvbiBleHRlbmRzIFRlc3RDYXNl\nIHsKICAgIHByaXZhdGUgRmlsZSBzb3VyY2VGaWxlOwogICAgcHJpdmF0ZSBG\naWxlIHRhcmdldEZpbGU7CiAgICAKICAgIENsYXNzTG9hZGVyIG9yaWdpbmFs\nTG9hZGVyID0gbnVsbDsKICAgIENsYXNzTG9hZGVyIHRlbXBMb2FkZXIgPSBu\ndWxsOwogICAgCiAgICBwcm90ZWN0ZWQgdm9pZCBzZXRVcCgpIHRocm93cyBF\neGNlcHRpb24gewogICAgICAgIHN1cGVyLnNldFVwKCk7CiAgICAgICAgU3Ry\naW5nIGN1cnJlbnREaXIgPSBTeXN0ZW0uZ2V0UHJvcGVydHkoInVzZXIuZGly\nIik7CiAgICAgICAgCiAgICAgICAgLy8gb3BlbmpwYS1wZXJzaXN0ZW5jZS90\nYXJnZXQvdGVzdC1jbGFzc2VzL3Jlc291cmNlcy9zZWNvbmQtcGVyc2lzdGVu\nY2UvTUVUQS1JTkYvcGVyc2lzdGVuY2UueG1sCiAgICAgICAgc291cmNlRmls\nZSA9IG5ldyBGaWxlKGN1cnJlbnREaXIgKyBGaWxlLnNlcGFyYXRvciAKICAg\nICAgICAgICAgKyAidGFyZ2V0IiArIEZpbGUuc2VwYXJhdG9yICsgInRlc3Qt\nY2xhc3NlcyIKICAgICAgICAgICAgKyBGaWxlLnNlcGFyYXRvciAgKyAic2Vj\nb25kLXBlcnNpc3RlbmNlIiArIEZpbGUuc2VwYXJhdG9yIAogICAgICAgICAg\nICArICJNRVRBLUlORiIgKyBGaWxlLnNlcGFyYXRvciArICJwZXJzaXN0ZW5j\nZS54bWwiKTsKICAgICAgICAKICAgICAgICAvLyBvcGVuanBhLXBlcnNpc3Rl\nbmNlL3RhcmdldC90ZXN0LWNsYXNzZXMvCiAgICAgICAgLy8gICBUZXN0UGVy\nc2lzdGVuY2VQcm9kdWN0RGVyaXZhdGlvbl9nZW5lcmF0ZWRfKHRpbWVfc3Rh\nbXApLmphciAgICAgICAgCiAgICAgICAgdGFyZ2V0RmlsZSA9IG5ldyBGaWxl\nKGN1cnJlbnREaXIgKyBGaWxlLnNlcGFyYXRvciArICJ0YXJnZXQiICsgCiAg\nICAgICAgICAgIEZpbGUuc2VwYXJhdG9yICsgInRlc3QtY2xhc3NlcyIgKyBG\naWxlLnNlcGFyYXRvciArIAogICAgICAgICAgICAiVGVzdFBlcnNpc3RlbmNl\nUHJvZHVjdERlcml2YXRpb25fZ2VuZXJhdGVkXyIgKwogICAgICAgICAgICBT\neXN0ZW0uY3VycmVudFRpbWVNaWxsaXMoKSArICIuamFyIik7CiAgICAgICAg\nCiAgICAgICAgQWNjZXNzQ29udHJvbGxlci5kb1ByaXZpbGVnZWQoSjJEb1By\naXZIZWxwZXIKICAgICAgICAgICAgLmRlbGV0ZU9uRXhpdEFjdGlvbih0YXJn\nZXRGaWxlKSk7CiAgICAgICAgYnVpbGRKYXIoc291cmNlRmlsZSx0YXJnZXRG\naWxlKTsKICAgICAgICAKICAgICAgICAvLyBIb2xkIGEgcmVmZXJlbmNlIHRv\nIHRoZSBjdXJyZW50IGNsYXNzbG9hZGVyIHNvIHdlIGNhbiBjbGVhbnVwCiAg\nICAgICAgLy8gd2hlbiB3ZSdyZSBkb25lLgogICAgICAgIG9yaWdpbmFsTG9h\nZGVyID0gVGhyZWFkLmN1cnJlbnRUaHJlYWQoKS5nZXRDb250ZXh0Q2xhc3NM\nb2FkZXIoKTsKICAgICAgICB0ZW1wTG9hZGVyID0gbmV3IFRlbXBVcmxMb2Fk\nZXIobmV3IFVSTFtde3RhcmdldEZpbGUudG9VUkkoKS50b1VSTCgpfQogICAg\nICAgICAgICAsb3JpZ2luYWxMb2FkZXIpOyAgICAgICAgCiAgICAgICAgQWNj\nZXNzQ29udHJvbGxlci5kb1ByaXZpbGVnZWQoSjJEb1ByaXZIZWxwZXIKICAg\nICAgICAgICAgLnNldENvbnRleHRDbGFzc0xvYWRlckFjdGlvbih0ZW1wTG9h\nZGVyKSk7CiAgICB9CiAgICAKICAgIHByb3RlY3RlZCB2b2lkIHRlYXJEb3du\nKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgc3VwZXIudGVhckRvd24o\nKTsKICAgICAgICAvLyBSZXN0b3JlIHRoZSBvcmlnaW5hbCBjbGFzc2xvYWRl\nci4KICAgICAgICBUaHJlYWQuY3VycmVudFRocmVhZCgpLnNldENvbnRleHRD\nbGFzc0xvYWRlcihvcmlnaW5hbExvYWRlcik7CiAgICAgICAgCiAgICAgICAg\nLy8gRm9yIHdoYXRldmVyIHJlYXNvbiwgdGhpcyBmaWxlIHdvbid0IGV2ZXIg\nZGVsZXRlLiBJIHNlYXJjaGVkIGFyb3VuZAogICAgICAgIC8vIGFuZCBmb3Vu\nZCBudW1lcm91cyBkb2N1bWVudGVkIHByb2JsZW1zIHdpdGggZGVsZXRpbmcg\nZmlsZXMuIFBlcmhhcHMKICAgICAgICAvLyBzb21ldGltZSBpbiB0aGUgZnV0\ndXJlIHRoaXMgcHJvYmxlbSB3aWxsIGJlIGZpeGVkLiBGb3Igbm93IGl0IGRv\nZXNuJ3QKICAgICAgICAvLyByZWFsbHkgbWF0dGVyIHNpbmNlIHdlIGdlbmVy\nYXRlIGEgbmV3IGZpbGUgZXZlcnkgdGltZS4KICAgICAgICBib29sZWFuIGRl\nbGV0ZWQgPSBBY2Nlc3NDb250cm9sbGVyLmRvUHJpdmlsZWdlZChKMkRvUHJp\ndkhlbHBlcgogICAgICAgICAgICAuZGVsZXRlQWN0aW9uKHRhcmdldEZpbGUp\nKTsKICAgICAgICBpZihkZWxldGVkPT1mYWxzZSl7CiAgICAgICAgICAgIFN5\nc3RlbS5vdXQucHJpbnRsbigiVGhlIGZpbGUgIiArIHRhcmdldEZpbGUgKyAi\nIHdhc24ndCBkZWxldGVkLiIpOwogICAgICAgIH0KICAgIH0KICAgIC8qKgog\nICAgICogQWRkZWQgZm9yIE9QRU5KUEEtOTMyLiBWZXJpZmllcyBhIFBlcnNp\nc3RlbmNlUHJvZHVjdERlcml2YXRpb24gcHJvcGVybHkgbG9hZHMgcHUncyBm\ncm9tIG11bHRpcGxlIAogICAgICogYXJjaGl2ZXMuCiAgICAgKiAKICAgICAq\nIEB0aHJvd3MgRXhjZXB0aW9uCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHRl\nc3RHZXRBbmNob3JzSW5SZXNvdXJjZSgpdGhyb3dzIEV4Y2VwdGlvbiB7CiAg\nICAgICAgCiAgICAgICAgTGlzdDxTdHJpbmc+IGV4cGVjdGVkUFVzID0gQXJy\nYXlzLmFzTGlzdCgKICAgICAgICAgICAgbmV3IFN0cmluZ1tdeyJwdV8xIiwi\ncHVfMiIsInB1XzMifSk7CiAgICAgICAgCiAgICAgICAgUGVyc2lzdGVuY2VQ\ncm9kdWN0RGVyaXZhdGlvbiBwcGQgPSBuZXcgUGVyc2lzdGVuY2VQcm9kdWN0\nRGVyaXZhdGlvbigpOwogICAgICAgIExpc3Q8U3RyaW5nPiBhY3R1YWwgPSBw\ncGQuZ2V0QW5jaG9yc0luUmVzb3VyY2UoIk1FVEEtSU5GL3BlcnNpc3RlbmNl\nLnhtbCIpOwogICAgICAgIAogICAgICAgIGFzc2VydFRydWUoYWN0dWFsLmNv\nbnRhaW5zQWxsKGV4cGVjdGVkUFVzKSk7CiAgICAgICAgCiAgICAgICAgLy8g\nQWRkZWQgZm9yIE9QRU5KUEEtOTkzCiAgICAgICAgYXNzZXJ0RmFsc2UoYWN0\ndWFsLmNvbnRhaW5zKCJiYWRfcHJvdmlkZXIiKSk7CiAgICB9CiAgICBwdWJs\naWMgdm9pZCB0ZXN0RW5jcnlwdGlvblBsdWdpbkNvbmZpZ3VyYXRpb24oKSB0\naHJvd3MgRXhjZXB0aW9uIHsKCQlQZXJzaXN0ZW5jZVByb2R1Y3REZXJpdmF0\naW9uIHBwZCA9IG5ldyBQZXJzaXN0ZW5jZVByb2R1Y3REZXJpdmF0aW9uKCk7\nCgkJT3BlbkpQQUNvbmZpZ3VyYXRpb24gY29uZiA9IG5ldyBPcGVuSlBBQ29u\nZmlndXJhdGlvbkltcGwoKTsKCQlTdHJpbmcgZW5jcnlwdGVkUGFzc3dvcmQg\nPSAiZW5jcnlwdGVkX3Bhc3N3b3JkIjsKCQlDbGFzc0xvYWRlciBsb2FkZXIg\nPSBudWxsOwoKCQlDb25maWd1cmF0aW9uUHJvdmlkZXIgcHJvdmlkZXIgPSBw\ncGQubG9hZCgKCQkJCVBlcnNpc3RlbmNlUHJvZHVjdERlcml2YXRpb24uUlNS\nQ19ERUZBVUxULAoJCQkJImVuY3J5cHRpb25fcGx1Z2luX3B1IiwgbG9hZGVy\nKTsKCQlwcm92aWRlci5zZXRJbnRvKGNvbmYpOwoJCUVuY3J5cHRpb25Qcm92\naWRlciBlcCA9IGNvbmYuZ2V0RW5jcnlwdGlvblByb3ZpZGVyKCk7CgkJYXNz\nZXJ0Tm90TnVsbChlcCk7CgkJLy8gQ2FzdCB0byB0ZXN0IGltcGwKCQlUZXN0\nRW5jcnlwdGlvblByb3ZpZGVyIHRlcCA9IChUZXN0RW5jcnlwdGlvblByb3Zp\nZGVyKSBlcDsKCgkJY29uZi5zZXRDb25uZWN0aW9uUGFzc3dvcmQoZW5jcnlw\ndGVkUGFzc3dvcmQpOwoJCS8vIFZhbGlkYXRlIHRoYXQgd2hlbiB3ZSBnZXQg\ndGhlIENvbm5lY3Rpb25QYXNzd29yZCBmcm9tIGNvbmZpZ3VyYXRpb24KCQkv\nLyB0aGF0IGl0IGlzIGRlY3J5cHRlZAoJCWFzc2VydEVxdWFscyhUZXN0RW5j\ncnlwdGlvblByb3ZpZGVyLmRlY3J5cHRlZFBhc3N3b3JkLCBjb25mCgkJCQku\nZ2V0Q29ubmVjdGlvblBhc3N3b3JkKCkpOwoJCS8vIFZhbGlkYXRlIHRoYXQg\ndGhlIEVuY3J5cHRpb25Qcm92aWRlciBpcyBjYWxsZWQgd2l0aCB0aGUgJ2Vu\nY3J5cHRlZCcKCQkvLyBwYXNzd29yZAoJCWFzc2VydEVxdWFscyhlbmNyeXB0\nZWRQYXNzd29yZCwgdGVwLmdldEVuY3J5cHRlZFBhc3N3b3JkKCkpOwoJfQog\nICAgcHVibGljIHZvaWQgdGVzdEVuY3J5cHRpb25QbHVnaW5Db25maWd1cmF0\naW9uRGVmYXVsdFZhbHVlKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CgkJUGVyc2lz\ndGVuY2VQcm9kdWN0RGVyaXZhdGlvbiBwcGQgPSBuZXcgUGVyc2lzdGVuY2VQ\ncm9kdWN0RGVyaXZhdGlvbigpOwoJCU9wZW5KUEFDb25maWd1cmF0aW9uIGNv\nbmYgPSBuZXcgT3BlbkpQQUNvbmZpZ3VyYXRpb25JbXBsKCk7CgkJQ2xhc3NM\nb2FkZXIgbG9hZGVyID0gbnVsbDsKCgkJQ29uZmlndXJhdGlvblByb3ZpZGVy\nIHByb3ZpZGVyID0gcHBkLmxvYWQoCgkJCQlQZXJzaXN0ZW5jZVByb2R1Y3RE\nZXJpdmF0aW9uLlJTUkNfREVGQVVMVCwKCQkJCSJlbmNyeXB0aW9uX3BsdWdp\nbl9kZWZhdWx0X3B1IiwgbG9hZGVyKTsKCQlwcm92aWRlci5zZXRJbnRvKGNv\nbmYpOwoKCQlhc3NlcnROdWxsKGNvbmYuZ2V0RW5jcnlwdGlvblByb3ZpZGVy\nKCkpOwoJfQogICAgCiAgICAvKgogICAgICogVmVyaWZpZXMgdmFsdWUgb2Yg\nZXhjbHVkZS11bmxpc3RlZC1jbGFzc2VzIHdpdGggYSB2ZXJzaW9uIDEuMAog\nICAgICogcGVyc2lzdGVuY2UueG1sLgogICAgICovCiAgICBwdWJsaWMgdm9p\nZCB0ZXN0SlBBMUV4Y2x1ZGVVbmxpc3RlZENsYXNzZXMoKSB0aHJvd3MgRXhj\nZXB0aW9uIHsKICAgICAgICBQZXJzaXN0ZW5jZVByb2R1Y3REZXJpdmF0aW9u\nLkNvbmZpZ3VyYXRpb25QYXJzZXIgY3AgPSAKICAgICAgICAgICAgICAgIG5l\ndyBQZXJzaXN0ZW5jZVByb2R1Y3REZXJpdmF0aW9uLkNvbmZpZ3VyYXRpb25Q\nYXJzZXIobmV3IEhhc2hNYXAoKSk7CgogICAgICAgIExpc3Q8VVJMPiB1cmxz\nID0gZ2V0UmVzb3VyY2VVUkwoUGVyc2lzdGVuY2VQcm9kdWN0RGVyaXZhdGlv\nbi5SU1JDX0RFRkFVTFQpOwogICAgICAgIGFzc2VydE5vdE51bGwodXJscyk7\nCiAgICAgICAgYXNzZXJ0RXF1YWxzKDEsIHVybHMuc2l6ZSgpKTsKICAgICAg\nICBjcC5wYXJzZSh1cmxzLmdldCgwKSk7CiAgICAgICAgCiAgICAgICAgTGlz\ndDxQZXJzaXN0ZW5jZVVuaXRJbmZvSW1wbD4gdW5pdHMgPSBjcC5nZXRSZXN1\nbHRzKCk7CiAgICAgICAgICAgICAgICAKICAgICAgICBpbnQgdmZ5Q291bnQg\nPSAwOwogICAgICAgIGZvciAoUGVyc2lzdGVuY2VVbml0SW5mb0ltcGwgcHB1\naSA6IHVuaXRzKSB7CiAgICAgICAgICAgIGlmICgiZXhjbHVkZV9ub3Rfc3Bl\nY2lmaWVkIi5lcXVhbHMocHB1aS5nZXRQZXJzaXN0ZW5jZVVuaXROYW1lKCkp\nKSB7CiAgICAgICAgICAgICAgICB2ZnlDb3VudCsrOwogICAgICAgICAgICAg\nICAgYXNzZXJ0RmFsc2UocHB1aS5leGNsdWRlVW5saXN0ZWRDbGFzc2VzKCkp\nOwogICAgICAgICAgICB9CiAgICAgICAgICAgIC8vIFZlcmlmeSBjYXNlIHdo\nZXJlIGV4Y2x1ZGUtdW5saXN0ZWQtY2xhc3NlcyB3YXMgc3BlY2lmaWVkLCBi\ndXQKICAgICAgICAgICAgLy8gaXMgdGhlIGRlZmF1bHQgaWUgPGV4Y2x1ZGUt\ndW5saXN0ZWQtY2xhc3Nlcy8+CiAgICAgICAgICAgIGlmICgiZXhjbHVkZV9k\nZWZhdWx0Ii5lcXVhbHMocHB1aS5nZXRQZXJzaXN0ZW5jZVVuaXROYW1lKCkp\nKSB7CiAgICAgICAgICAgICAgICB2ZnlDb3VudCsrOwogICAgICAgICAgICAg\nICAgYXNzZXJ0RmFsc2UocHB1aS5leGNsdWRlVW5saXN0ZWRDbGFzc2VzKCkp\nOwogICAgICAgICAgICB9CiAgICAgICAgICAgIC8vIFZlcmlmeSBjYXNlIHdo\nZXJlIGV4Y2x1ZGUtdW5saXN0ZWQtY2xhc3NlcyB3YXMgc3BlY2lmaWVkIGFz\nCiAgICAgICAgICAgIC8vIHRydWUgPGV4Y2x1ZGUtdW5saXN0ZWQtY2xhc3Nl\ncz50cnVlPC9leGNsdWRlLXVubGlzdGVkLWNsYXNzZXM+CiAgICAgICAgICAg\nIGlmICgiZXhjbHVkZV90cnVlIi5lcXVhbHMocHB1aS5nZXRQZXJzaXN0ZW5j\nZVVuaXROYW1lKCkpKSB7CiAgICAgICAgICAgICAgICB2ZnlDb3VudCsrOwog\nICAgICAgICAgICAgICAgYXNzZXJ0VHJ1ZShwcHVpLmV4Y2x1ZGVVbmxpc3Rl\nZENsYXNzZXMoKSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgLy8gVmVy\naWZ5IGNhc2Ugd2hlcmUgZXhjbHVkZS11bmxpc3RlZC1jbGFzc2VzIHdhcyBz\ncGVjaWZpZWQgYXMKICAgICAgICAgICAgLy8gZmFsc2UgPGV4Y2x1ZGUtdW5s\naXN0ZWQtY2xhc3Nlcz5mYWxzZTwvZXhjbHVkZS11bmxpc3RlZC1jbGFzc2Vz\nPgogICAgICAgICAgICBpZiAoImV4Y2x1ZGVfZmFsc2UiLmVxdWFscyhwcHVp\nLmdldFBlcnNpc3RlbmNlVW5pdE5hbWUoKSkpIHsKICAgICAgICAgICAgICAg\nIHZmeUNvdW50Kys7CiAgICAgICAgICAgICAgICBhc3NlcnRGYWxzZShwcHVp\nLmV4Y2x1ZGVVbmxpc3RlZENsYXNzZXMoKSk7CiAgICAgICAgICAgIH0gICAg\nICAgICAgICAKICAgICAgICB9CiAgICAgICAgLy8gTWFrZSBzdXJlIGFsbCBw\ndSdzIHdlcmUgdmFsaWRhdGVkCiAgICAgICAgYXNzZXJ0RXF1YWxzKDQsIHZm\neUNvdW50KTsgICAgICAgICAgICAgICAgCiAgICB9CgogICAgLyoKICAgICAq\nIFZlcmlmaWVzIHZhbHVlIG9mIGV4Y2x1ZGUtdW5saXN0ZWQtY2xhc3NlcyB3\naXRoIGEgdmVyc2lvbiAyLjAKICAgICAqIHBlcnNpc3RlbmNlLnhtbC4KICAg\nICAqLwogICAgcHVibGljIHZvaWQgdGVzdEV4Y2x1ZGVVbmxpc3RlZENsYXNz\nZXMoKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBQZXJzaXN0ZW5jZVBy\nb2R1Y3REZXJpdmF0aW9uLkNvbmZpZ3VyYXRpb25QYXJzZXIgY3AgPSAKICAg\nICAgICAgICAgbmV3IFBlcnNpc3RlbmNlUHJvZHVjdERlcml2YXRpb24uQ29u\nZmlndXJhdGlvblBhcnNlcihuZXcgSGFzaE1hcCgpKTsKCiAgICBMaXN0PFVS\nTD4gdXJscyA9IGdldFJlc291cmNlVVJMKCJNRVRBLUlORi9wZXJzaXN0ZW5j\nZS0yXzAueG1sIik7CiAgICBhc3NlcnROb3ROdWxsKHVybHMpOwogICAgYXNz\nZXJ0RXF1YWxzKDEsIHVybHMuc2l6ZSgpKTsKICAgIGNwLnBhcnNlKHVybHMu\nZ2V0KDApKTsKICAgIAogICAgTGlzdDxQZXJzaXN0ZW5jZVVuaXRJbmZvSW1w\nbD4gdW5pdHMgPSBjcC5nZXRSZXN1bHRzKCk7CiAgICAgICAgICAgIAogICAg\naW50IHZmeUNvdW50ID0gMDsKICAgIGZvciAoUGVyc2lzdGVuY2VVbml0SW5m\nb0ltcGwgcHB1aSA6IHVuaXRzKSB7CiAgICAgICAgLy8gVmVyaWZ5IGNhc2Ug\nd2hlcmUgZXhjbHVkZS11bmxpc3RlZC1jbGFzc2VzIHdhcyBub3Qgc3BlY2lm\naWVkCiAgICAgICAgaWYgKCJleGNsdWRlX25vdF9zcGVjaWZpZWQiLmVxdWFs\ncyhwcHVpLmdldFBlcnNpc3RlbmNlVW5pdE5hbWUoKSkpIHsKICAgICAgICAg\nICAgdmZ5Q291bnQrKzsKICAgICAgICAgICAgYXNzZXJ0VHJ1ZShwcHVpLmV4\nY2x1ZGVVbmxpc3RlZENsYXNzZXMoKSk7CiAgICAgICAgfQogICAgICAgIC8v\nIFZlcmlmeSBjYXNlIHdoZXJlIGV4Y2x1ZGUtdW5saXN0ZWQtY2xhc3NlcyB3\nYXMgc3BlY2lmaWVkLCBidXQKICAgICAgICAvLyBpcyB0aGUgZGVmYXVsdCBp\nZSA8ZXhjbHVkZS11bmxpc3RlZC1jbGFzc2VzLz4KICAgICAgICBpZiAoImV4\nY2x1ZGVfZGVmYXVsdCIuZXF1YWxzKHBwdWkuZ2V0UGVyc2lzdGVuY2VVbml0\nTmFtZSgpKSkgewogICAgICAgICAgICB2ZnlDb3VudCsrOwogICAgICAgICAg\nICBhc3NlcnRUcnVlKHBwdWkuZXhjbHVkZVVubGlzdGVkQ2xhc3NlcygpKTsK\nICAgICAgICB9CiAgICAgICAgLy8gVmVyaWZ5IGNhc2Ugd2hlcmUgZXhjbHVk\nZS11bmxpc3RlZC1jbGFzc2VzIHdhcyBzcGVjaWZpZWQgYXMKICAgICAgICAv\nLyB0cnVlIDxleGNsdWRlLXVubGlzdGVkLWNsYXNzZXM+dHJ1ZTwvZXhjbHVk\nZS11bmxpc3RlZC1jbGFzc2VzPgogICAgICAgIGlmICgiZXhjbHVkZV90cnVl\nIi5lcXVhbHMocHB1aS5nZXRQZXJzaXN0ZW5jZVVuaXROYW1lKCkpKSB7CiAg\nICAgICAgICAgIHZmeUNvdW50Kys7CiAgICAgICAgICAgIGFzc2VydFRydWUo\ncHB1aS5leGNsdWRlVW5saXN0ZWRDbGFzc2VzKCkpOwogICAgICAgIH0KICAg\nICAgICAvLyBWZXJpZnkgY2FzZSB3aGVyZSBleGNsdWRlLXVubGlzdGVkLWNs\nYXNzZXMgd2FzIHNwZWNpZmllZCBhcwogICAgICAgIC8vIGZhbHNlIDxleGNs\ndWRlLXVubGlzdGVkLWNsYXNzZXM+ZmFsc2U8L2V4Y2x1ZGUtdW5saXN0ZWQt\nY2xhc3Nlcz4KICAgICAgICBpZiAoImV4Y2x1ZGVfZmFsc2UiLmVxdWFscyhw\ncHVpLmdldFBlcnNpc3RlbmNlVW5pdE5hbWUoKSkpIHsKICAgICAgICAgICAg\ndmZ5Q291bnQrKzsKICAgICAgICAgICAgYXNzZXJ0RmFsc2UocHB1aS5leGNs\ndWRlVW5saXN0ZWRDbGFzc2VzKCkpOwogICAgICAgIH0gICAgICAgICAgICAK\nICAgIH0KICAgIC8vIE1ha2Ugc3VyZSBhbGwgcHUncyB3ZXJlIHZhbGlkYXRl\nZAogICAgYXNzZXJ0RXF1YWxzKDQsIHZmeUNvdW50KTsgICAgICAgICAgICAg\nICAgCiAgICAgICAgCiAgICB9CgogICAgcHJpdmF0ZSBzdGF0aWMgTGlzdDxV\nUkw+IGdldFJlc291cmNlVVJMKFN0cmluZyByc3JjKQogICAgICAgIHRocm93\ncyBJT0V4Y2VwdGlvbiB7CiAgICBFbnVtZXJhdGlvbjxVUkw+IHVybHMgPSBu\ndWxsOwogICAgdHJ5IHsKICAgICAgICBDbGFzc0xvYWRlciBjbCA9IFRlc3RQ\nZXJzaXN0ZW5jZVByb2R1Y3REZXJpdmF0aW9uLmNsYXNzLmdldENsYXNzTG9h\nZGVyKCk7CiAgICAgICAgdXJscyA9IEFjY2Vzc0NvbnRyb2xsZXIuZG9Qcml2\naWxlZ2VkKAogICAgICAgICAgICBKMkRvUHJpdkhlbHBlci5nZXRSZXNvdXJj\nZXNBY3Rpb24oY2wsIHJzcmMpKTsgCiAgICAgICAgaWYgKCF1cmxzLmhhc01v\ncmVFbGVtZW50cygpKSB7CiAgICAgICAgICAgIGlmICghcnNyYy5zdGFydHNX\naXRoKCJNRVRBLUlORiIpKQogICAgICAgICAgICAgIHVybHMgPSBBY2Nlc3ND\nb250cm9sbGVyLmRvUHJpdmlsZWdlZCgKICAgICAgICAgICAgICAgICAgSjJE\nb1ByaXZIZWxwZXIuZ2V0UmVzb3VyY2VzQWN0aW9uKGNsLCAiTUVUQS1JTkYv\nIiArIHJzcmMpKTsKICAgICAgICAgICAgaWYgKCF1cmxzLmhhc01vcmVFbGVt\nZW50cygpKQogICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAg\nfQogICAgfSBjYXRjaCAoUHJpdmlsZWdlZEFjdGlvbkV4Y2VwdGlvbiBwYWUp\nIHsKICAgICAgICB0aHJvdyAoSU9FeGNlcHRpb24pIHBhZS5nZXRFeGNlcHRp\nb24oKTsKICAgIH0KCiAgICByZXR1cm4gQ29sbGVjdGlvbnMubGlzdCh1cmxz\nKTsKfQoKICAgIHByaXZhdGUgdm9pZCBidWlsZEphcihGaWxlIHNvdXJjZUZp\nbGUsIEZpbGUgdGFyZ2V0RmlsZSkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAg\nICAgCiAgICAgICAgSmFyT3V0cHV0U3RyZWFtIG91dCA9IG5ldyBKYXJPdXRw\ndXRTdHJlYW0oCiAgICAgICAgICAgIG5ldyBCdWZmZXJlZE91dHB1dFN0cmVh\nbShuZXcgRmlsZU91dHB1dFN0cmVhbSh0YXJnZXRGaWxlKSkpOwogICAgICAg\nIAogICAgICAgIEJ1ZmZlcmVkSW5wdXRTdHJlYW0gaW4gPSAKICAgICAgICAg\nICAgbmV3IEJ1ZmZlcmVkSW5wdXRTdHJlYW0obmV3IEZpbGVJbnB1dFN0cmVh\nbShzb3VyY2VGaWxlKSk7CgogICAgICAgIG91dC5wdXROZXh0RW50cnkobmV3\nIEphckVudHJ5KCJNRVRBLUlORi8iKSk7CiAgICAgICAgb3V0LnB1dE5leHRF\nbnRyeShuZXcgSmFyRW50cnkoIk1FVEEtSU5GL3BlcnNpc3RlbmNlLnhtbCIp\nKTsKICAgICAgICAvL3dyaXRlIHRoZSB4bWwgdG8gdGhlIGphcgogICAgICAg\nIGJ5dGVbXSBidWYgPSBuZXcgYnl0ZVsxMDI0XTsKICAgICAgICBpbnQgaTsK\nICAgICAgICB3aGlsZSAoKGkgPSBpbi5yZWFkKGJ1ZikpICE9IC0xKSB7CiAg\nICAgICAgICBvdXQud3JpdGUoYnVmLCAwLCBpKTsKICAgICAgICB9CiAgICAg\nICAgCiAgICAgICAgb3V0LmNsb3NlKCk7CiAgICAgICAgaW4uY2xvc2UoKTsg\nICAgICAgIAogICAgfQoKICAgIGNsYXNzIFRlbXBVcmxMb2FkZXIgZXh0ZW5k\ncyBVUkxDbGFzc0xvYWRlciB7CiAgICAgICAgcHVibGljIFRlbXBVcmxMb2Fk\nZXIoVVJMW10gdXJscywgQ2xhc3NMb2FkZXIgcGFyZW50KSB7CiAgICAgICAg\nICAgIHN1cGVyKHVybHMscGFyZW50KTsKICAgICAgICB9CiAgICB9CiAgICBw\ndWJsaWMgc3RhdGljIGNsYXNzIFRlc3RFbmNyeXB0aW9uUHJvdmlkZXIgaW1w\nbGVtZW50cyBFbmNyeXB0aW9uUHJvdmlkZXIgewoJCXB1YmxpYyBzdGF0aWMg\nZmluYWwgU3RyaW5nIGRlY3J5cHRlZFBhc3N3b3JkID0gImRlY3lwdGVkX3Bh\nc3N3b3JkIjsKCQkvLyBTYXZlIHRoZSAnZW5jcnlwdGVkJyBwYXNzd29yZCBz\nbyBvdXIgVVQgY2FuIHBlcmZvcm0gdmFsaWRhdGlvbi4KCQlwcml2YXRlIFN0\ncmluZyBlbmNyeXB0ZWRQYXNzd29yZDsKCgkJcHVibGljIFN0cmluZyBnZXRF\nbmNyeXB0ZWRQYXNzd29yZCgpIHsKCQkJcmV0dXJuIGVuY3J5cHRlZFBhc3N3\nb3JkOwoJCX0KCgkJLyoqCgkJICogVGhpcyBtZXRob2QgQUxXQVlTIHJldHVy\nbnMgdGhlIFN0cmluZyAiZGVjeXB0ZWRfcGFzc3dvcmQiLgoJCSAqIAoJCSAq\nIEBzZWUgRW5jcnlwdGlvblByb3ZpZGVyI2RlY3J5cHQoU3RyaW5nKQoJCSAq\nLwoJCXB1YmxpYyBTdHJpbmcgZGVjcnlwdChTdHJpbmcgcGFzc3dvcmQpIHsK\nCQkJZW5jcnlwdGVkUGFzc3dvcmQgPSBwYXNzd29yZDsKCgkJCXJldHVybiBk\nZWNyeXB0ZWRQYXNzd29yZDsKCQl9CgoJCS8qKgoJCSAqIEBzZWUgRW5jcnlw\ndGlvblByb3ZpZGVyI2VuY3J5cHQoU3RyaW5nKQoJCSAqLwoJCXB1YmxpYyBT\ndHJpbmcgZW5jcnlwdChTdHJpbmcgcGFzc3dvcmQpIHsKCQkJcmV0dXJuIHBh\nc3N3b3JkOwoJCX0KCX0KfQo=\n","encoding":"base64"}

