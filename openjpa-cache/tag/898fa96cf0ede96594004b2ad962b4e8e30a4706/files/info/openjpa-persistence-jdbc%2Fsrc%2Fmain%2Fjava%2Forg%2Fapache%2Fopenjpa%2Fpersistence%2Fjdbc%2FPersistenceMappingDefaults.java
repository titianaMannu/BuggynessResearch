{"sha":"c7f5e708489f1fa0a7b6672c1820aa6d1d94236b","node_id":"MDQ6QmxvYjIwNjM2NDpjN2Y1ZTcwODQ4OWYxZmEwYTdiNjY3MmMxODIwYWE2ZDFkOTQyMzZi","size":10774,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/c7f5e708489f1fa0a7b6672c1820aa6d1d94236b","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuamRiYzsK\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5pZGVudGlmaWVyLk5v\ncm1hbGl6ZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5pZGVu\ndGlmaWVyLkRCSWRlbnRpZmllcjsKaW1wb3J0IG9yZy5hcGFjaGUub3Blbmpw\nYS5qZGJjLm1ldGEuQ2xhc3NNYXBwaW5nOwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLmpkYmMubWV0YS5EaXNjcmltaW5hdG9yOwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLmpkYmMubWV0YS5GaWVsZE1hcHBpbmc7CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhLk1hcHBpbmdEZWZhdWx0c0lt\ncGw7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhLlZhbHVl\nTWFwcGluZzsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLm1ldGEu\nVmFsdWVNYXBwaW5nSW1wbDsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5q\nZGJjLm1ldGEuVmVyc2lvbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5q\nZGJjLm1ldGEuc3RyYXRzLkZsYXRDbGFzc1N0cmF0ZWd5OwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0YS5zdHJhdHMuTXVsdGlDb2x1bW5W\nZXJzaW9uU3RyYXRlZ3k7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRi\nYy5tZXRhLnN0cmF0cy5Ob25lRGlzY3JpbWluYXRvclN0cmF0ZWd5OwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0YS5zdHJhdHMuTm9uZVZl\ncnNpb25TdHJhdGVneTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJj\nLm1ldGEuc3RyYXRzLk51bWJlclZlcnNpb25TdHJhdGVneTsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5qZGJjLm1ldGEuc3RyYXRzLlN1YmNsYXNzSm9p\nbkRpc2NyaW1pbmF0b3JTdHJhdGVneTsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5qZGJjLm1ldGEuc3RyYXRzLlZhbHVlTWFwRGlzY3JpbWluYXRvclN0\ncmF0ZWd5OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0YS5z\ndHJhdHMuVmVydGljYWxDbGFzc1N0cmF0ZWd5OwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLmpkYmMuc2NoZW1hLkNvbHVtbjsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5qZGJjLnNjaGVtYS5TY2hlbWE7CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEuamRiYy5zY2hlbWEuVGFibGU7CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEuamRiYy5zcWwuSm9pblN5bnRheGVzOwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLm1ldGEuRmllbGRNZXRhRGF0YTsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5tZXRhLkphdmFUeXBlczsKaW1wb3J0IHNlcnAu\ndXRpbC5TdHJpbmdzOwoKLyoqCiAqIFN1cHBsaWVzIGRlZmF1bHQgbWFwcGlu\nZyBpbmZvcm1hdGlvbiBpbiBhY2NvcmRhbmNlIHdpdGggSlBBIHNwZWMuCiAq\nCiAqIEBhdXRob3IgU3RldmUgS2ltCiAqIEBhdXRob3IgQWJlIFdoaXRlCiAq\nIEBub2phdmFkb2MKICovCnB1YmxpYyBjbGFzcyBQZXJzaXN0ZW5jZU1hcHBp\nbmdEZWZhdWx0cwogICAgZXh0ZW5kcyBNYXBwaW5nRGVmYXVsdHNJbXBsIHsK\nCiAgICBwcml2YXRlIGJvb2xlYW4gX3ByZXBlbmRGaWVsZE5hbWVUb0pvaW5U\nYWJsZUludmVyc2VKb2luQ29sdW1ucyA9IHRydWU7CgogICAgcHVibGljIFBl\ncnNpc3RlbmNlTWFwcGluZ0RlZmF1bHRzKCkgewogICAgICAgIHNldERlZmF1\nbHRNaXNzaW5nSW5mbyh0cnVlKTsKICAgICAgICBzZXRTdG9yZUVudW1PcmRp\nbmFsKHRydWUpOwogICAgICAgIHNldE9yZGVyTGlzdHMoZmFsc2UpOwogICAg\nICAgIHNldEFkZE51bGxJbmRpY2F0b3IoZmFsc2UpOwogICAgICAgIHNldERp\nc2NyaW1pbmF0b3JDb2x1bW5OYW1lKCJEVFlQRSIpOwogICAgfQoKICAgIC8q\nKgogICAgICogV2hldGhlciB0byBwcmVwZW5kIHRoZSBmaWVsZCBuYW1lIHRv\nIHRoZSBkZWZhdWx0IG5hbWUgb2YgaW52ZXJzZSBqb2luCiAgICAgKiBjb2x1\nbW5zIHdpdGhpbiBqb2luIHRhYmxlcy4gIERlZmF1bHRzIHRvIHRydWUgcGVy\nIHNwZWMsIGJ1dCBzZXQgdG8gZmFsc2UKICAgICAqIGZvciBjb21wYXRpYmls\naXR5IHdpdGggb2xkZXIgdmVyc2lvbnMgb2YgT3BlbkpQQS4KICAgICAqLwog\nICAgcHVibGljIGJvb2xlYW4gZ2V0UHJlcGVuZEZpZWxkTmFtZVRvSm9pblRh\nYmxlSW52ZXJzZUpvaW5Db2x1bW5zKCkgewogICAgICAgIHJldHVybiBfcHJl\ncGVuZEZpZWxkTmFtZVRvSm9pblRhYmxlSW52ZXJzZUpvaW5Db2x1bW5zOwog\nICAgfQoKICAgIC8qKgogICAgICogV2hldGhlciB0byBwcmVwZW5kIHRoZSBm\naWVsZCBuYW1lIHRvIHRoZSBkZWZhdWx0IG5hbWUgb2YgaW52ZXJzZSBqb2lu\nCiAgICAgKiBjb2x1bW5zIHdpdGhpbiBqb2luIHRhYmxlcy4gIERlZmF1bHRz\nIHRvIHRydWUgcGVyIHNwZWMsIGJ1dCBzZXQgdG8gZmFsc2UKICAgICAqIGZv\nciBjb21wYXRpYmlsaXR5IHdpdGggb2xkZXIgdmVyc2lvbnMgb2YgT3BlbkpQ\nQS4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0UHJlcGVuZEZpZWxkTmFt\nZVRvSm9pblRhYmxlSW52ZXJzZUpvaW5Db2x1bW5zKGJvb2xlYW4gdmFsKSB7\nCiAgICAgICAgX3ByZXBlbmRGaWVsZE5hbWVUb0pvaW5UYWJsZUludmVyc2VK\nb2luQ29sdW1ucyA9IHZhbDsKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHB1\nYmxpYyBPYmplY3QgZ2V0U3RyYXRlZ3koVmVyc2lvbiB2ZXJzLCBib29sZWFu\nIGFkYXB0KSB7CiAgICAgICAgT2JqZWN0IHN0cmF0ID0gc3VwZXIuZ2V0U3Ry\nYXRlZ3kodmVycywgYWRhcHQpOwogICAgICAgIENsYXNzTWFwcGluZyBjbHMg\nPSB2ZXJzLmdldENsYXNzTWFwcGluZygpOwogICAgICAgIGlmIChzdHJhdCAh\nPSBudWxsIHx8IGNscy5nZXRKb2luYWJsZVBDU3VwZXJjbGFzc01hcHBpbmco\nKSAhPSBudWxsCiAgICAgICAgICAgIHx8IGNscy5nZXRWZXJzaW9uRmllbGQo\nKSAhPSBudWxsKQogICAgICAgICAgICByZXR1cm4gc3RyYXQ7CgogICAgICAg\nIGludCBuQ29sdW1uID0gdmVycy5nZXRNYXBwaW5nSW5mbygpLmdldENvbHVt\nbnMoKS5zaXplKCk7CiAgICAgICAgc3dpdGNoIChuQ29sdW1uKSB7CiAgICAg\nICAgICAgIGNhc2UgMCA6IHJldHVybiBOb25lVmVyc2lvblN0cmF0ZWd5Lmdl\ndEluc3RhbmNlKCk7CiAgICAgICAgICAgIGNhc2UgMSA6IHJldHVybiBuZXcg\nTnVtYmVyVmVyc2lvblN0cmF0ZWd5KCk7CiAgICAgICAgICAgIGRlZmF1bHQ6\nIHJldHVybiBuZXcgTXVsdGlDb2x1bW5WZXJzaW9uU3RyYXRlZ3koKTsKICAg\nICAgICB9CiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgT2JqZWN0\nIGdldFN0cmF0ZWd5KERpc2NyaW1pbmF0b3IgZGlzYywgYm9vbGVhbiBhZGFw\ndCkgewogICAgICAgIE9iamVjdCBzdHJhdCA9IHN1cGVyLmdldFN0cmF0ZWd5\nKGRpc2MsIGFkYXB0KTsKICAgICAgICBDbGFzc01hcHBpbmcgY2xzID0gZGlz\nYy5nZXRDbGFzc01hcHBpbmcoKTsKICAgICAgICBpZiAoc3RyYXQgIT0gbnVs\nbCB8fCBjbHMuZ2V0Sm9pbmFibGVQQ1N1cGVyY2xhc3NNYXBwaW5nKCkgIT0g\nbnVsbAogICAgICAgICAgICB8fCBkaXNjLmdldE1hcHBpbmdJbmZvKCkuZ2V0\nVmFsdWUoKSAhPSBudWxsKQogICAgICAgICAgICByZXR1cm4gc3RyYXQ7Cgog\nICAgICAgIC8vIGRvbid0IHVzZSBhIGNvbHVtbi1iYXNlZCBkaXNjcmltaW5h\ndG9yIGFwcHJvYWNoIHVubGVzcyB1c2VyIGhhcyBzZXQKICAgICAgICAvLyBh\nIGNvbHVtbiBleHBsaWNpdGx5IG9yIGlzIHVzaW5nIGZsYXQgaW5oZXJpdGFu\nY2UgZXhwbGljaXRseQogICAgICAgIGlmICghZGlzYy5nZXRNYXBwaW5nSW5m\nbygpLmdldENvbHVtbnMoKS5pc0VtcHR5KCkpCiAgICAgICAgICAgIHJldHVy\nbiBuZXcgVmFsdWVNYXBEaXNjcmltaW5hdG9yU3RyYXRlZ3koKTsKCiAgICAg\nICAgQ2xhc3NNYXBwaW5nIGJhc2UgPSBjbHM7CiAgICAgICAgd2hpbGUgKGJh\nc2UuZ2V0TWFwcGluZ0luZm8oKS5nZXRIaWVyYXJjaHlTdHJhdGVneSgpID09\nIG51bGwKICAgICAgICAgICAgJiYgYmFzZS5nZXRQQ1N1cGVyY2xhc3NNYXBw\naW5nKCkgIT0gbnVsbCkKICAgICAgICAgICAgYmFzZSA9IGJhc2UuZ2V0UENT\ndXBlcmNsYXNzTWFwcGluZygpOwoKICAgICAgICBzdHJhdCA9IGJhc2UuZ2V0\nTWFwcGluZ0luZm8oKS5nZXRIaWVyYXJjaHlTdHJhdGVneSgpOwogICAgICAg\nIGlmIChGbGF0Q2xhc3NTdHJhdGVneS5BTElBUy5lcXVhbHMoc3RyYXQpKQog\nICAgICAgICAgICByZXR1cm4gbmV3IFZhbHVlTWFwRGlzY3JpbWluYXRvclN0\ncmF0ZWd5KCk7CiAgICAgICAgaWYgKFZlcnRpY2FsQ2xhc3NTdHJhdGVneS5B\nTElBUy5lcXVhbHMoc3RyYXQpCiAgICAgICAgICAgICYmIGRpY3Quam9pblN5\nbnRheCAhPSBKb2luU3ludGF4ZXMuU1lOVEFYX1RSQURJVElPTkFMKQogICAg\nICAgICAgICByZXR1cm4gbmV3IFN1YmNsYXNzSm9pbkRpc2NyaW1pbmF0b3JT\ndHJhdGVneSgpOwogICAgICAgIHJldHVybiBOb25lRGlzY3JpbWluYXRvclN0\ncmF0ZWd5LmdldEluc3RhbmNlKCk7CiAgICB9CgogICAgQE92ZXJyaWRlCiAg\nICBwdWJsaWMgU3RyaW5nIGdldFRhYmxlTmFtZShDbGFzc01hcHBpbmcgY2xz\nLCBTY2hlbWEgc2NoZW1hKSB7CiAgICAgICAgaWYgKGNscy5nZXRUeXBlQWxp\nYXMoKSAhPSBudWxsKQogICAgICAgICAgICByZXR1cm4gY2xzLmdldFR5cGVB\nbGlhcygpOwogICAgICAgIHJldHVybiBTdHJpbmdzLmdldENsYXNzTmFtZShj\nbHMuZ2V0RGVzY3JpYmVkVHlwZSgpKS5yZXBsYWNlKCckJywgJ18nKTsKICAg\nIH0KCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyBTdHJpbmcgZ2V0VGFibGVO\nYW1lKEZpZWxkTWFwcGluZyBmbSwgU2NoZW1hIHNjaGVtYSkgewogICAgICAg\nIHJldHVybiBnZXRUYWJsZUlkZW50aWZpZXIoZm0sIHNjaGVtYSkuZ2V0TmFt\nZSgpOwogICAgfQoKICAgIEBPdmVycmlkZQogICAgcHVibGljIERCSWRlbnRp\nZmllciBnZXRUYWJsZUlkZW50aWZpZXIoRmllbGRNYXBwaW5nIGZtLCBTY2hl\nbWEgc2NoZW1hKSB7CiAgICAgICAgLy8gYmFzZSBuYW1lIGlzIHRhYmxlIG9m\nIGRlZmluaW5nIHR5cGUgKyAnXycKICAgICAgICBDbGFzc01hcHBpbmcgY2xt\nID0gZm0uZ2V0RGVmaW5pbmdNYXBwaW5nKCk7CiAgICAgICAgVGFibGUgdGFi\nbGUgPSBnZXRUYWJsZShjbG0pOwogICAgICAgIAogICAgICAgIERCSWRlbnRp\nZmllciBzTmFtZSA9IERCSWRlbnRpZmllci5OVUxMOwogICAgICAgIGlmIChm\nbS5pc0VsZW1lbnRDb2xsZWN0aW9uKCkpIAogICAgICAgICAgICBzTmFtZSA9\nIERCSWRlbnRpZmllci5uZXdUYWJsZShjbG0uZ2V0VHlwZUFsaWFzKCkpOwog\nICAgICAgIGVsc2UgCiAgICAgICAgICAgIHNOYW1lID0gdGFibGUuZ2V0SWRl\nbnRpZmllcigpOwogICAgICAgIAogICAgICAgIC8vIGlmIHRoaXMgaXMgYW4g\nYXNzb2NhdGlvbiB0YWJsZSwgc3BlYyBzYXlzIHRvIHN1ZmZpeCB3aXRoIHRh\nYmxlIG9mCiAgICAgICAgLy8gdGhlIHJlbGF0ZWQgdHlwZS4gc3BlYyBkb2Vz\nbid0IGNvdmVyIG90aGVyIGNhc2VzOyB3ZSdyZSBnb2luZyB0bwogICAgICAg\nIC8vIHN1ZmZpeCB3aXRoIHRoZSBmaWVsZCBuYW1lCiAgICAgICAgQ2xhc3NN\nYXBwaW5nIHJlbCA9IGZtLmdldEVsZW1lbnRNYXBwaW5nKCkuZ2V0VHlwZU1h\ncHBpbmcoKTsKICAgICAgICBib29sZWFuIGFzc29jID0gcmVsICE9IG51bGwg\nJiYgcmVsLmdldFRhYmxlKCkgIT0gbnVsbAogICAgICAgICAgICAmJiBmbS5n\nZXRUeXBlQ29kZSgpICE9IEphdmFUeXBlcy5NQVA7CiAgICAgICAgREJJZGVu\ndGlmaWVyIHNOYW1lMiA9IERCSWRlbnRpZmllci5OVUxMOwogICAgICAgIGlm\nIChhc3NvYykgewogICAgICAgICAgICBzTmFtZTIgPSByZWwuZ2V0VGFibGUo\nKS5nZXRJZGVudGlmaWVyKCk7CiAgICAgICAgfQogICAgICAgIGVsc2Ugewog\nICAgICAgICAgICBzTmFtZTIgPSBEQklkZW50aWZpZXIubmV3VGFibGUoZm0u\nZ2V0TmFtZSgpLnJlcGxhY2UoJyQnLCAnXycpKTsKICAgICAgICB9CiAgICAg\nICAgCiAgICAgICAgc05hbWUgPSBEQklkZW50aWZpZXIuY29tYmluZShzTmFt\nZSwgc05hbWUyLmdldE5hbWUoKSk7CiAgICAgICAgCiAgICAgICAgcmV0dXJu\nIHNOYW1lOwogICAgfQogICAgCiAgICBwcml2YXRlIFRhYmxlIGdldFRhYmxl\nKENsYXNzTWFwcGluZyBjbG0pIHsKICAgICAgICBUYWJsZSB0YWJsZSA9IGNs\nbS5nZXRUYWJsZSgpOwogICAgICAgIGlmICh0YWJsZSA9PSBudWxsKSB7CiAg\nICAgICAgICAgIFZhbHVlTWFwcGluZ0ltcGwgdmFsdWUgPQogICAgICAgICAg\nICAgICAgICAgIChWYWx1ZU1hcHBpbmdJbXBsKWNsbS5nZXRFbWJlZGRpbmdN\nZXRhRGF0YSgpOwogICAgICAgICAgICBpZiAodmFsdWUgPT0gbnVsbCkKICAg\nICAgICAgICAgICAgIHJldHVybiB0YWJsZTsKICAgICAgICAgICAgRmllbGRN\nZXRhRGF0YSBmaWVsZCA9IHZhbHVlLmdldEZpZWxkTWV0YURhdGEoKTsKICAg\nICAgICAgICAgY2xtID0gKENsYXNzTWFwcGluZylmaWVsZC5nZXREZWZpbmlu\nZ01ldGFEYXRhKCk7CiAgICAgICAgICAgIHJldHVybiBnZXRUYWJsZShjbG0p\nOwogICAgICAgIH0KICAgICAgICByZXR1cm4gdGFibGU7CiAgICB9CgogICAg\nQE92ZXJyaWRlCiAgICBwdWJsaWMgdm9pZCBwb3B1bGF0ZUpvaW5Db2x1bW4o\nRmllbGRNYXBwaW5nIGZtLCBUYWJsZSBsb2NhbCwgVGFibGUgZm9yZWlnbiwK\nICAgICAgICBDb2x1bW4gY29sLCBPYmplY3QgdGFyZ2V0LCBpbnQgcG9zLCBp\nbnQgY29scykgewogICAgICAgIC8vIG9ubHkgdXNlIHNwZWMgZGVmYXVsdHMg\nd2l0aCBjb2x1bW4gdGFyZ2V0cwogICAgICAgIGlmICghKHRhcmdldCBpbnN0\nYW5jZW9mIENvbHVtbikpCiAgICAgICAgICAgIHJldHVybjsKCiAgICAgICAg\nLy8gaWYgdGhpcyBpcyBhIGJpZGkgcmVsYXRpb24sIHByZWZpeCB3aXRoIGlu\ndmVyc2UgZmllbGQgbmFtZSwgZWxzZQogICAgICAgIC8vIHByZWZpeCB3aXRo\nIG93bmluZyBlbnRpdHkgbmFtZQogICAgICAgIEZpZWxkTWFwcGluZ1tdIGlu\ndmVyc2VzID0gZm0uZ2V0SW52ZXJzZU1hcHBpbmdzKCk7CiAgICAgICAgREJJ\nZGVudGlmaWVyIHNOYW1lID0gREJJZGVudGlmaWVyLk5VTEw7CiAgICAgICAg\naWYgKGludmVyc2VzLmxlbmd0aCA+IDApCiAgICAgICAgICAgIHNOYW1lID0g\nREJJZGVudGlmaWVyLm5ld0NvbHVtbihpbnZlcnNlc1swXS5nZXROYW1lKCkp\nOwogICAgICAgIGVsc2UKICAgICAgICAgICAgc05hbWUgPSBEQklkZW50aWZp\nZXIubmV3Q29sdW1uKGZtLmdldERlZmluaW5nTWFwcGluZygpLmdldFR5cGVB\nbGlhcygpKTsKICAgICAgICBEQklkZW50aWZpZXIgdGFyZ2V0TmFtZSA9ICgo\nQ29sdW1uKSB0YXJnZXQpLmdldElkZW50aWZpZXIoKTsKICAgICAgICBEQklk\nZW50aWZpZXIgdGVtcE5hbWUgPSBEQklkZW50aWZpZXIuTlVMTDsKICAgICAg\nICBpZiAoKHNOYW1lLmxlbmd0aCgpICsgdGFyZ2V0TmFtZS5sZW5ndGgoKSkg\nPj0gZGljdC5tYXhDb2x1bW5OYW1lTGVuZ3RoKQogICAgICAgICAgICB0ZW1w\nTmFtZSA9IERCSWRlbnRpZmllci50cnVuY2F0ZShzTmFtZSwgZGljdC5tYXhD\nb2x1bW5OYW1lTGVuZ3RoCiAgICAgICAgICAgICAgICAgICAgLSB0YXJnZXRO\nYW1lLmxlbmd0aCgpIC0gMSk7CiAgICAgICAgLy8gc3VmZml4IHdpdGggJ18n\nICsgdGFyZ2V0IGNvbHVtbgogICAgICAgIGlmIChEQklkZW50aWZpZXIuaXNO\ndWxsKHRlbXBOYW1lKSkKICAgICAgICAgICAgdGVtcE5hbWUgPSBzTmFtZTsK\nICAgICAgICBzTmFtZSA9IERCSWRlbnRpZmllci5jb21iaW5lKHRlbXBOYW1l\nLCB0YXJnZXROYW1lLmdldE5hbWUoKSk7CiAgICAgICAgc05hbWUgPSBkaWN0\nLmdldFZhbGlkQ29sdW1uTmFtZShzTmFtZSwgZm9yZWlnbik7CiAgICAgICAg\nY29sLnNldElkZW50aWZpZXIoc05hbWUpOwogICAgfQoKICAgIEBPdmVycmlk\nZQogICAgcHVibGljIHZvaWQgcG9wdWxhdGVGb3JlaWduS2V5Q29sdW1uKFZh\nbHVlTWFwcGluZyB2bSwgU3RyaW5nIG5hbWUsCiAgICAgICAgVGFibGUgbG9j\nYWwsIFRhYmxlIGZvcmVpZ24sIENvbHVtbiBjb2wsIE9iamVjdCB0YXJnZXQs\nIGJvb2xlYW4gaW52ZXJzZSwKICAgICAgICBpbnQgcG9zLCBpbnQgY29scykg\newogICAgICAgICBwb3B1bGF0ZUZvcmVpZ25LZXlDb2x1bW4odm0sIERCSWRl\nbnRpZmllci5uZXdDb2x1bW4obmFtZSksIGxvY2FsLAogICAgICAgICAgICBm\nb3JlaWduLCBjb2wsIHRhcmdldCwgaW52ZXJzZSwgcG9zLCBjb2xzKTsKICAg\nIH0KCiAgICBwdWJsaWMgdm9pZCBwb3B1bGF0ZUZvcmVpZ25LZXlDb2x1bW4o\nVmFsdWVNYXBwaW5nIHZtLCBEQklkZW50aWZpZXIgc05hbWUsCiAgICAgICAg\nVGFibGUgbG9jYWwsIFRhYmxlIGZvcmVpZ24sIENvbHVtbiBjb2wsIE9iamVj\ndCB0YXJnZXQsIGJvb2xlYW4gaW52ZXJzZSwKICAgICAgICBpbnQgcG9zLCBp\nbnQgY29scykgewogICAgICAgIGJvb2xlYW4gZWxlbSA9IHZtID09IHZtLmdl\ndEZpZWxkTWFwcGluZygpLmdldEVsZW1lbnQoKQogICAgICAgICAgICAmJiB2\nbS5nZXRGaWVsZE1hcHBpbmcoKS5nZXRUeXBlQ29kZSgpICE9IEphdmFUeXBl\ncy5NQVA7CgogICAgICAgIC8vIGlmIHRoaXMgaXMgYSBub24taW52ZXJzZSBj\nb2xsZWN0aW9uIGVsZW1lbnQga2V5LCBpdCBtdXN0IGJlIGluCiAgICAgICAg\nLy8gYSBqb2luIHRhYmxlOiBpZiB3ZSdyZSBub3QgcHJlcGVuZGluZyB0aGUg\nZmllbGQgbmFtZSwgbGVhdmUgdGhlCiAgICAgICAgLy8gZGVmYXVsdAogICAg\nICAgIGlmICghX3ByZXBlbmRGaWVsZE5hbWVUb0pvaW5UYWJsZUludmVyc2VK\nb2luQ29sdW1ucyAmJiAhaW52ZXJzZSAmJiBlbGVtKQogICAgICAgICAgICBy\nZXR1cm47CgogICAgICAgIC8vIG90aGVyd2lzZSBqcGEgYWx3YXlzIHVzZXMg\nPGZpZWxkPl88cGtjb2w+IGZvciBjb2x1bW4gbmFtZSwgZXZlbgogICAgICAg\nIC8vIHdoZW4gb25seSBvbmUgY29sCiAgICAgICAgaWYgKHRhcmdldCBpbnN0\nYW5jZW9mIENvbHVtbikgewogICAgICAgICAgICBpZiAoREJJZGVudGlmaWVy\nLmlzTnVsbChzTmFtZSkpIHsKICAgICAgICAgICAgICAgIHNOYW1lID0gY29s\nLmdldElkZW50aWZpZXIoKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAg\nICAgICAgICAgIGlmIChlbGVtKQogICAgICAgICAgICAgICAgICAgIHNOYW1l\nID0gREJJZGVudGlmaWVyLm5ld0NvbHVtbih2bS5nZXRGaWVsZE1hcHBpbmco\nKS5nZXROYW1lKCkpOwogICAgICAgICAgICAgICAgaWYgKGlzUmVtb3ZlSHVu\nZ2FyaWFuTm90YXRpb24oKSkKICAgICAgICAgICAgICAgICAgICBzTmFtZSA9\nIERCSWRlbnRpZmllci5uZXdDb2x1bW4oTm9ybWFsaXplci5yZW1vdmVIdW5n\nYXJpYW5Ob3RhdGlvbihzTmFtZS5nZXROYW1lKCkpKTsKICAgICAgICAgICAg\nICAgIHNOYW1lID0gc05hbWUuY29tYmluZShzTmFtZSwgKChDb2x1bW4pdGFy\nZ2V0KS5nZXRJZGVudGlmaWVyKCkuZ2V0TmFtZSgpKTsKCiAgICAgICAgICAg\nICAgICAvLyBObyBuZWVkIHRvIGNoZWNrIGZvciB1bmlxdWVuZXNzLgogICAg\nICAgICAgICAgICAgc05hbWUgPSBkaWN0LmdldFZhbGlkQ29sdW1uTmFtZShz\nTmFtZSwgbG9jYWwsIGZhbHNlKTsKICAgICAgICAgICAgfQogICAgICAgICAg\nICBjb2wuc2V0SWRlbnRpZmllcihzTmFtZSk7CiAgICAgICAgfQogICAgfQoK\nICAgIEBPdmVycmlkZQogICAgcHVibGljIHZvaWQgcG9wdWxhdGVDb2x1bW5z\nKFZlcnNpb24gdmVycywgVGFibGUgdGFibGUsIENvbHVtbltdIGNvbHMpIHsK\nICAgICAgICAvLyBjaGVjayBmb3IgdmVyc2lvbiBmaWVsZCBhbmQgdXNlIGl0\ncyBuYW1lIGFzIGNvbHVtbiBuYW1lCiAgICAgICAgRmllbGRNYXBwaW5nIGZt\nID0gdmVycy5nZXRDbGFzc01hcHBpbmcoKS5nZXRWZXJzaW9uRmllbGRNYXBw\naW5nKCk7CiAgICAgICAgaWYgKGZtICE9IG51bGwgJiYgY29scy5sZW5ndGgg\nPT0gMSkKICAgICAgICAgICAgY29sc1swXS5zZXRJZGVudGlmaWVyKERCSWRl\nbnRpZmllci5uZXdDb2x1bW4oZm0uZ2V0TmFtZSgpKSk7CiAgICAgICAgZWxz\nZQogICAgICAgICAgICBzdXBlci5wb3B1bGF0ZUNvbHVtbnModmVycywgdGFi\nbGUsIGNvbHMpOwogICAgfQp9Cg==\n","encoding":"base64"}

