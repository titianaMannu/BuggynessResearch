{"sha":"2522952a6a5a775dce59496b1d3c6e7ab20c6559","node_id":"MDQ6QmxvYjIwNjM2NDoyNTIyOTUyYTZhNWE3NzVkY2U1OTQ5NmIxZDNjNmU3YWIyMGM2NTU5","size":50407,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/2522952a6a5a775dce59496b1d3c6e7ab20c6559","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuamRiYzsK\nCmltcG9ydCBqYXZhLmxhbmcucmVmbGVjdC5Nb2RpZmllcjsKaW1wb3J0IGph\ndmEuc3FsLlR5cGVzOwppbXBvcnQgamF2YS51dGlsLkFycmF5TGlzdDsKaW1w\nb3J0IGphdmEudXRpbC5BcnJheXM7CmltcG9ydCBqYXZhLnV0aWwuRW51bVNl\ndDsKaW1wb3J0IGphdmEudXRpbC5IYXNoTWFwOwppbXBvcnQgamF2YS51dGls\nLkxpc3Q7CmltcG9ydCBqYXZhLnV0aWwuTWFwOwppbXBvcnQgamF2YXgucGVy\nc2lzdGVuY2UuRGlzY3JpbWluYXRvclR5cGU7CmltcG9ydCBqYXZheC5wZXJz\naXN0ZW5jZS5FbnVtVHlwZTsKaW1wb3J0IGphdmF4LnBlcnNpc3RlbmNlLklu\naGVyaXRhbmNlVHlwZTsKaW1wb3J0IGphdmF4LnBlcnNpc3RlbmNlLlRlbXBv\ncmFsVHlwZTsKCmltcG9ydCBvcmcuYXBhY2hlLmNvbW1vbnMubGFuZy5TdHJp\nbmdVdGlsczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLmNvbmYu\nSkRCQ0NvbmZpZ3VyYXRpb247CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\namRiYy5pZGVudGlmaWVyLkRCSWRlbnRpZmllcjsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5qZGJjLmlkZW50aWZpZXIuUXVhbGlmaWVkREJJZGVudGlm\naWVyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0YS5DbGFz\nc01hcHBpbmc7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRh\nLkNsYXNzTWFwcGluZ0luZm87CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\namRiYy5tZXRhLkRpc2NyaW1pbmF0b3JNYXBwaW5nSW5mbzsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5qZGJjLm1ldGEuRmllbGRNYXBwaW5nOwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0YS5GaWVsZE1hcHBpbmdJ\nbmZvOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0YS5NYXBw\naW5nSW5mbzsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLm1ldGEu\nTWFwcGluZ1JlcG9zaXRvcnk7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\namRiYy5tZXRhLlF1ZXJ5UmVzdWx0TWFwcGluZzsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5qZGJjLm1ldGEuU2VxdWVuY2VNYXBwaW5nOwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0YS5RdWVyeVJlc3VsdE1hcHBp\nbmcuUENSZXN1bHQ7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5t\nZXRhLnN0cmF0cy5FbnVtVmFsdWVIYW5kbGVyOwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLmpkYmMubWV0YS5zdHJhdHMuRmxhdENsYXNzU3RyYXRlZ3k7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhLnN0cmF0cy5G\ndWxsQ2xhc3NTdHJhdGVneTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5q\nZGJjLm1ldGEuc3RyYXRzLk5vbmVDbGFzc1N0cmF0ZWd5OwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0YS5zdHJhdHMuVmVydGljYWxDbGFz\nc1N0cmF0ZWd5OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2No\nZW1hLkNvbHVtbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNj\naGVtYS5VbmlxdWU7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5z\ncWwuREJEaWN0aW9uYXJ5OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxp\nYi5sb2cuTG9nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi5tZXRh\nLlNvdXJjZVRyYWNrZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGli\nLnV0aWwuTG9jYWxpemVyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1l\ndGEuQ2xhc3NNZXRhRGF0YTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5t\nZXRhLkZpZWxkTWV0YURhdGE7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\nbWV0YS5KYXZhVHlwZXM7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEucGVy\nc2lzdGVuY2UuWE1MUGVyc2lzdGVuY2VNZXRhRGF0YVBhcnNlcjsKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLkludGVybmFsRXhjZXB0aW9uOwpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuVXNlckV4Y2VwdGlvbjsK\naW1wb3J0IG9yZy54bWwuc2F4LkF0dHJpYnV0ZXM7CmltcG9ydCBvcmcueG1s\nLnNheC5Mb2NhdG9yOwppbXBvcnQgb3JnLnhtbC5zYXguU0FYRXhjZXB0aW9u\nOwoKaW1wb3J0IHN0YXRpYyBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVu\nY2UuamRiYy5NYXBwaW5nVGFnLio7CmltcG9ydCBzZXJwLnV0aWwuTnVtYmVy\nczsKLyoqCiAqIEN1c3RvbSBTQVggcGFyc2VyIHVzZWQgYnkgdGhlIHN5c3Rl\nbSB0byBwYXJzZSBwZXJzaXN0ZW5jZSBtYXBwaW5nIGZpbGVzLgogKgogKiBA\nYXV0aG9yIFN0ZXZlIEtpbQogKiBAbm9qYXZhZG9jCiAqLwpwdWJsaWMgY2xh\nc3MgWE1MUGVyc2lzdGVuY2VNYXBwaW5nUGFyc2VyCiAgICBleHRlbmRzIFhN\nTFBlcnNpc3RlbmNlTWV0YURhdGFQYXJzZXIgewoKICAgIHByaXZhdGUgc3Rh\ndGljIGZpbmFsIE1hcDxTdHJpbmcsIE1hcHBpbmdUYWc+IF9lbGVtcyA9CiAg\nICAgICAgbmV3IEhhc2hNYXA8U3RyaW5nLCBNYXBwaW5nVGFnPigpOwoKICAg\nIHN0YXRpYyB7CiAgICAgICAgX2VsZW1zLnB1dCgiYXNzb2NpYXRpb24tb3Zl\ncnJpZGUiLCBBU1NPQ19PVkVSUklERSk7CiAgICAgICAgX2VsZW1zLnB1dCgi\nYXR0cmlidXRlLW92ZXJyaWRlIiwgQVRUUl9PVkVSUklERSk7CiAgICAgICAg\nX2VsZW1zLnB1dCgiY29sbGVjdGlvbi10YWJsZSIsIENPTExFQ1RJT05fVEFC\nTEUpOwogICAgICAgIF9lbGVtcy5wdXQoImNvbHVtbiIsIENPTCk7CiAgICAg\nICAgX2VsZW1zLnB1dCgiY29sdW1uLW5hbWUiLCBDT0xVTU5fTkFNRSk7CiAg\nICAgICAgX2VsZW1zLnB1dCgiY29sdW1uLXJlc3VsdCIsIENPTFVNTl9SRVNV\nTFQpOwogICAgICAgIF9lbGVtcy5wdXQoImRlbGltaXRlZC1pZGVudGlmaWVy\ncyIsIERFTElNSVRFRF9JRFMpOwogICAgICAgIF9lbGVtcy5wdXQoImRpc2Ny\naW1pbmF0b3ItY29sdW1uIiwgRElTQ1JJTV9DT0wpOwogICAgICAgIF9lbGVt\ncy5wdXQoImRpc2NyaW1pbmF0b3ItdmFsdWUiLCBESVNDUklNX1ZBTCk7CiAg\nICAgICAgX2VsZW1zLnB1dCgiZW50aXR5LXJlc3VsdCIsIEVOVElUWV9SRVNV\nTFQpOwogICAgICAgIF9lbGVtcy5wdXQoImVudW1lcmF0ZWQiLCBFTlVNRVJB\nVEVEKTsKICAgICAgICBfZWxlbXMucHV0KCJmaWVsZC1yZXN1bHQiLCBGSUVM\nRF9SRVNVTFQpOwogICAgICAgIF9lbGVtcy5wdXQoImluaGVyaXRhbmNlIiwg\nSU5IRVJJVEFOQ0UpOwogICAgICAgIF9lbGVtcy5wdXQoImpvaW4tY29sdW1u\nIiwgSk9JTl9DT0wpOwogICAgICAgIF9lbGVtcy5wdXQoImludmVyc2Utam9p\nbi1jb2x1bW4iLCBDT0wpOwogICAgICAgIF9lbGVtcy5wdXQoImpvaW4tdGFi\nbGUiLCBKT0lOX1RBQkxFKTsKICAgICAgICBfZWxlbXMucHV0KCJtYXAta2V5\nLWVudW1lcmF0ZWQiLCBNQVBfS0VZX0VOVU1FUkFURUQpOwogICAgICAgIF9l\nbGVtcy5wdXQoIm1hcC1rZXktY29sdW1uIiwgTUFQX0tFWV9DT0wpOwogICAg\nICAgIF9lbGVtcy5wdXQoIm1hcC1rZXktam9pbi1jb2x1bW4iLCBNQVBfS0VZ\nX0pPSU5fQ09MKTsKICAgICAgICBfZWxlbXMucHV0KCJtYXAta2V5LXRlbXBv\ncmFsIiwgTUFQX0tFWV9URU1QT1JBTCk7CiAgICAgICAgX2VsZW1zLnB1dCgi\nbmFtZSIsIE5BTUUpOwogICAgICAgIF9lbGVtcy5wdXQoIm9yZGVyLWNvbHVt\nbiIsIE9SREVSX0NPTFVNTik7CiAgICAgICAgX2VsZW1zLnB1dCgicHJpbWFy\neS1rZXktam9pbi1jb2x1bW4iLCBQS19KT0lOX0NPTCk7CiAgICAgICAgX2Vs\nZW1zLnB1dCgic2Vjb25kYXJ5LXRhYmxlIiwgU0VDT05EQVJZX1RBQkxFKTsK\nICAgICAgICBfZWxlbXMucHV0KCJzcWwtcmVzdWx0LXNldC1tYXBwaW5nIiwg\nU1FMX1JFU1VMVF9TRVRfTUFQUElORyk7CiAgICAgICAgX2VsZW1zLnB1dCgi\ndGFibGUiLCBUQUJMRSk7CiAgICAgICAgX2VsZW1zLnB1dCgidGFibGUtZ2Vu\nZXJhdG9yIiwgVEFCTEVfR0VOKTsKICAgICAgICBfZWxlbXMucHV0KCJ0ZW1w\nb3JhbCIsIFRFTVBPUkFMKTsKICAgICAgICBfZWxlbXMucHV0KCJ1bmlxdWUt\nY29uc3RyYWludCIsIFVOSVFVRSk7CiAgICB9CgogICAgcHJpdmF0ZSBzdGF0\naWMgZmluYWwgTG9jYWxpemVyIF9sb2MgPSBMb2NhbGl6ZXIuZm9yUGFja2Fn\nZQogICAgICAgIChYTUxQZXJzaXN0ZW5jZU1hcHBpbmdQYXJzZXIuY2xhc3Mp\nOwoKICAgIHByaXZhdGUgU3RyaW5nIF9vdmVycmlkZSA9IG51bGw7CiAgICBw\ncml2YXRlIFN0cmluZyBfc2NoZW1hID0gbnVsbDsKICAgIHByaXZhdGUgU3Ry\naW5nIF9jb2xUYWJsZSA9IG51bGw7CiAgICBwcml2YXRlIFN0cmluZyBfc2Vj\nb25kYXJ5VGFibGUgPSBudWxsOwogICAgcHJpdmF0ZSBMaXN0PENvbHVtbj4g\nX2NvbHMgPSBudWxsOwogICAgcHJpdmF0ZSBMaXN0PENvbHVtbj4gX2pvaW5D\nb2xzID0gbnVsbDsKICAgIHByaXZhdGUgTGlzdDxDb2x1bW4+IF9zdXBKb2lu\nQ29scyA9IG51bGw7CiAgICBwcml2YXRlIGJvb2xlYW4gX2xvYiA9IGZhbHNl\nOwogICAgcHJpdmF0ZSBUZW1wb3JhbFR5cGUgX3RlbXBvcmFsID0gbnVsbDsK\nICAgIHByaXZhdGUgRW51bVNldDxVbmlxdWVGbGFnPiBfdW5pcXVlID0gRW51\nbVNldC5ub25lT2YoVW5pcXVlRmxhZy5jbGFzcyk7CiAgICBwcml2YXRlIERp\nc2NyaW1pbmF0b3JUeXBlIF9kaXNjVHlwZTsKICAgIHByaXZhdGUgQ29sdW1u\nIF9kaXNjQ29sOwogICAgcHJpdmF0ZSBpbnQgX3Jlc3VsdElkeCA9IDA7CiAg\nICBwcml2YXRlIGZpbmFsIERCRGljdGlvbmFyeSBfZGljdDsKCiAgICBwcml2\nYXRlIGZpbmFsIE1hcDxDbGFzczw/PiwgQXJyYXlMaXN0PERlZmVycmVkRW1i\nZWRkYWJsZU92ZXJyaWRlcz4+IAogICAgICAgIF9kZWZlcnJlZE1hcHBpbmdz\nID0gbmV3IEhhc2hNYXA8Q2xhc3M8Pz4sIAogICAgICAgICAgICAgQXJyYXlM\naXN0PERlZmVycmVkRW1iZWRkYWJsZU92ZXJyaWRlcz4+KCk7CgogICAgLyoq\nCiAgICAgKiBDb25zdHJ1Y3Rvcjsgc3VwcGx5IGNvbmZpZ3VyYXRpb24uCiAg\nICAgKi8KICAgIHB1YmxpYyBYTUxQZXJzaXN0ZW5jZU1hcHBpbmdQYXJzZXIo\nSkRCQ0NvbmZpZ3VyYXRpb24gY29uZikgewogICAgICAgIHN1cGVyKGNvbmYp\nOwogICAgICAgIF9kaWN0ID0gY29uZi5nZXREQkRpY3Rpb25hcnlJbnN0YW5j\nZSgpOwogICAgfQoKICAgIEBPdmVycmlkZQogICAgcHJvdGVjdGVkIHZvaWQg\ncmVzZXQoKSB7CiAgICAgICAgc3VwZXIucmVzZXQoKTsKICAgICAgICBjbGVh\nckNvbHVtbkluZm8oKTsKICAgICAgICBjbGVhckNsYXNzSW5mbygpOwogICAg\nICAgIGNsZWFyU2Vjb25kYXJ5VGFibGVJbmZvKCk7CiAgICAgICAgX292ZXJy\naWRlID0gbnVsbDsKICAgICAgICBfc2NoZW1hID0gbnVsbDsKICAgICAgICBf\ncmVzdWx0SWR4ID0gMDsKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHByb3Rl\nY3RlZCBPYmplY3Qgc3RhcnRTeXN0ZW1NYXBwaW5nRWxlbWVudChTdHJpbmcg\nbmFtZSwgQXR0cmlidXRlcyBhdHRycykKICAgICAgICB0aHJvd3MgU0FYRXhj\nZXB0aW9uIHsKICAgICAgICBNYXBwaW5nVGFnIHRhZyA9IF9lbGVtcy5nZXQo\nbmFtZSk7CiAgICAgICAgaWYgKHRhZyA9PSBudWxsKSB7CiAgICAgICAgICAg\nIGlmICgic2NoZW1hIi5lcXVhbHMobmFtZSkpCiAgICAgICAgICAgICAgICBy\nZXR1cm4gbmFtZTsKICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAg\nfQoKICAgICAgICBib29sZWFuIHJldDsKICAgICAgICBzd2l0Y2ggKHRhZykg\newogICAgICAgICAgICBjYXNlIFRBQkxFX0dFTjoKICAgICAgICAgICAgICAg\nIHJldCA9IHN0YXJ0VGFibGVHZW5lcmF0b3IoYXR0cnMpOwogICAgICAgICAg\nICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgU1FMX1JFU1VMVF9TRVRf\nTUFQUElORzoKICAgICAgICAgICAgICAgIHJldCA9IHN0YXJ0U1FMUmVzdWx0\nU2V0TWFwcGluZyhhdHRycyk7CiAgICAgICAgICAgICAgICBicmVhazsKICAg\nICAgICAgICAgY2FzZSBFTlRJVFlfUkVTVUxUOgogICAgICAgICAgICAgICAg\ncmV0ID0gc3RhcnRFbnRpdHlSZXN1bHQoYXR0cnMpOwogICAgICAgICAgICAg\nICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgRklFTERfUkVTVUxUOgogICAg\nICAgICAgICAgICAgcmV0ID0gc3RhcnRGaWVsZFJlc3VsdChhdHRycyk7CiAg\nICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSBDT0xVTU5f\nUkVTVUxUOgogICAgICAgICAgICAgICAgcmV0ID0gc3RhcnRDb2x1bW5SZXN1\nbHQoYXR0cnMpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAg\nIGRlZmF1bHQ6CiAgICAgICAgICAgICAgICByZXQgPSBmYWxzZTsKICAgICAg\nICB9CiAgICAgICAgcmV0dXJuIChyZXQpID8gdGFnIDogbnVsbDsKICAgIH0K\nCiAgICBAT3ZlcnJpZGUKICAgIHByb3RlY3RlZCB2b2lkIGVuZFN5c3RlbU1h\ncHBpbmdFbGVtZW50KFN0cmluZyBuYW1lKQogICAgICAgIHRocm93cyBTQVhF\neGNlcHRpb24gewogICAgICAgIE1hcHBpbmdUYWcgdGFnID0gX2VsZW1zLmdl\ndChuYW1lKTsKICAgICAgICBpZiAodGFnID09IG51bGwpIHsKICAgICAgICAg\nICAgaWYgKCJzY2hlbWEiLmVxdWFscyhuYW1lKSkKICAgICAgICAgICAgICAg\nIF9zY2hlbWEgPSBjdXJyZW50VGV4dCgpOwogICAgICAgICAgICByZXR1cm47\nCiAgICAgICAgfQoKICAgICAgICBzd2l0Y2ggKHRhZykgewogICAgICAgICAg\nICBjYXNlIFNRTF9SRVNVTFRfU0VUX01BUFBJTkc6CiAgICAgICAgICAgICAg\nICBlbmRTUUxSZXN1bHRTZXRNYXBwaW5nKCk7CiAgICAgICAgICAgICAgICBi\ncmVhazsKICAgICAgICAgICAgY2FzZSBFTlRJVFlfUkVTVUxUOgogICAgICAg\nICAgICAgICAgZW5kRW50aXR5UmVzdWx0KCk7CiAgICAgICAgICAgICAgICBi\ncmVhazsKICAgICAgICB9CiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwcm90\nZWN0ZWQgT2JqZWN0IHN0YXJ0Q2xhc3NNYXBwaW5nRWxlbWVudChTdHJpbmcg\nbmFtZSwgQXR0cmlidXRlcyBhdHRycykKICAgICAgICB0aHJvd3MgU0FYRXhj\nZXB0aW9uIHsKICAgICAgICBNYXBwaW5nVGFnIHRhZyA9IF9lbGVtcy5nZXQo\nbmFtZSk7CiAgICAgICAgaWYgKHRhZyA9PSBudWxsKQogICAgICAgICAgICBy\nZXR1cm4gbnVsbDsKCiAgICAgICAgYm9vbGVhbiByZXQ7CiAgICAgICAgc3dp\ndGNoICh0YWcpIHsKICAgICAgICAgICAgY2FzZSBUQUJMRToKICAgICAgICAg\nICAgICAgIHJldCA9IHN0YXJ0VGFibGUoYXR0cnMpOwogICAgICAgICAgICAg\nICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgU0VDT05EQVJZX1RBQkxFOgog\nICAgICAgICAgICAgICAgcmV0ID0gc3RhcnRTZWNvbmRhcnlUYWJsZShhdHRy\ncyk7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSBE\nSVNDUklNX0NPTDoKICAgICAgICAgICAgICAgIHBhcnNlRGlzY3JpbWluYXRv\nckNvbHVtbihhdHRycyk7CiAgICAgICAgICAgICAgICBfZGlzY0NvbCA9IHBh\ncnNlQ29sdW1uKGF0dHJzKTsKICAgICAgICAgICAgICAgIHJldCA9IHRydWU7\nCiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSBESVND\nUklNX1ZBTDoKICAgICAgICAgICAgICAgIHJldCA9IHRydWU7CiAgICAgICAg\nICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSBJTkhFUklUQU5DRToK\nICAgICAgICAgICAgICAgIHJldCA9IHN0YXJ0SW5oZXJpdGFuY2UoYXR0cnMp\nOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgQVNT\nT0NfT1ZFUlJJREU6CiAgICAgICAgICAgIGNhc2UgQVRUUl9PVkVSUklERToK\nICAgICAgICAgICAgICAgIHJldCA9IHN0YXJ0QXR0cmlidXRlT3ZlcnJpZGUo\nYXR0cnMpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNh\nc2UgUEtfSk9JTl9DT0w6CiAgICAgICAgICAgICAgICByZXQgPSBzdGFydFBy\naW1hcnlLZXlKb2luQ29sdW1uKGF0dHJzKTsKICAgICAgICAgICAgICAgIGJy\nZWFrOwogICAgICAgICAgICBjYXNlIENPTDoKICAgICAgICAgICAgICAgIHJl\ndCA9IHN0YXJ0Q29sdW1uKGF0dHJzKTsKICAgICAgICAgICAgICAgIGJyZWFr\nOwogICAgICAgICAgICBjYXNlIEpPSU5fQ09MOgogICAgICAgICAgICAgICAg\ncmV0ID0gc3RhcnRKb2luQ29sdW1uKGF0dHJzKTsKICAgICAgICAgICAgICAg\nIGJyZWFrOwogICAgICAgICAgICBjYXNlIEpPSU5fVEFCTEU6CiAgICAgICAg\nICAgICAgICByZXQgPSBzdGFydEpvaW5UYWJsZShhdHRycyk7CiAgICAgICAg\nICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSBUQUJMRV9HRU46CiAg\nICAgICAgICAgICAgICByZXQgPSBzdGFydFRhYmxlR2VuZXJhdG9yKGF0dHJz\nKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIFVO\nSVFVRToKICAgICAgICAgICAgICAgIHJldCA9IHN0YXJ0VW5pcXVlQ29uc3Ry\nYWludChhdHRycyk7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAg\nICAgY2FzZSBOQU1FOgogICAgICAgICAgICAgICAgcmV0ID0gdHJ1ZTsKICAg\nICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIFRFTVBPUkFM\nOgogICAgICAgICAgICBjYXNlIEVOVU1FUkFURUQ6CiAgICAgICAgICAgIGNh\nc2UgTUFQX0tFWV9FTlVNRVJBVEVEOgogICAgICAgICAgICBjYXNlIE1BUF9L\nRVlfVEVNUE9SQUw6CiAgICAgICAgICAgICAgICByZXQgPSB0cnVlOwogICAg\nICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgU1FMX1JFU1VM\nVF9TRVRfTUFQUElORzoKICAgICAgICAgICAgICAgIHJldCA9IHN0YXJ0U1FM\nUmVzdWx0U2V0TWFwcGluZyhhdHRycyk7CiAgICAgICAgICAgICAgICBicmVh\nazsKICAgICAgICAgICAgY2FzZSBFTlRJVFlfUkVTVUxUOgogICAgICAgICAg\nICAgICAgcmV0ID0gc3RhcnRFbnRpdHlSZXN1bHQoYXR0cnMpOwogICAgICAg\nICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgRklFTERfUkVTVUxU\nOgogICAgICAgICAgICAgICAgcmV0ID0gc3RhcnRGaWVsZFJlc3VsdChhdHRy\ncyk7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSBD\nT0xVTU5fUkVTVUxUOgogICAgICAgICAgICAgICAgcmV0ID0gc3RhcnRDb2x1\nbW5SZXN1bHQoYXR0cnMpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAg\nICAgICAgIGNhc2UgQ09MVU1OX05BTUU6CiAgICAgICAgICAgICAgICByZXQg\nPSB0cnVlOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNh\nc2UgQ09MTEVDVElPTl9UQUJMRToKICAgICAgICAgICAgICAgIHJldCA9IHN0\nYXJ0Q29sbGVjdGlvblRhYmxlKGF0dHJzKTsKICAgICAgICAgICAgICAgIGJy\nZWFrOwogICAgICAgICAgICBjYXNlIE1BUF9LRVlfQ09MOgogICAgICAgICAg\nICAgICAgcmV0ID0gc3RhcnRNYXBLZXlDb2x1bW4oYXR0cnMpOwogICAgICAg\nICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgTUFQX0tFWV9KT0lO\nX0NPTDoKICAgICAgICAgICAgICAgIHJldCA9IHN0YXJ0TWFwS2V5Sm9pbkNv\nbHVtbihhdHRycyk7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAg\nICAgZGVmYXVsdDoKICAgICAgICAgICAgICAgIHJldCA9IGZhbHNlOwogICAg\nICAgIH0KICAgICAgICByZXR1cm4gKHJldCkgPyB0YWcgOiBudWxsOwogICAg\nfQoKICAgIHByaXZhdGUgYm9vbGVhbiBlbmROYW1lKCkgewogICAgICAgIFN0\ncmluZyBuYW1lID0gdGhpcy5jdXJyZW50VGV4dCgpOwogICAgICAgIGlmIChT\ndHJpbmdVdGlscy5pc05vdEVtcHR5KG5hbWUpKSB7CiAgICAgICAgICAgIE9i\namVjdCBjdXJyZW50ID0gY3VycmVudEVsZW1lbnQoKTsKICAgICAgICAgICAg\naWYgKGN1cnJlbnQgaW5zdGFuY2VvZiBVbmlxdWUpIHsKICAgICAgICAgICAg\nICAgIFVuaXF1ZSB1bnEgPSAoVW5pcXVlKWN1cnJlbnQ7CiAgICAgICAgICAg\nICAgICB1bnEuc2V0SWRlbnRpZmllcihEQklkZW50aWZpZXIubmV3Q29uc3Ry\nYWludChuYW1lLCBkZWxpbWl0KCkpKTsKICAgICAgICAgICAgfQogICAgICAg\nIH0KICAgICAgICAgICAgCiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9Cgog\nICAgQE92ZXJyaWRlCiAgICBwcm90ZWN0ZWQgdm9pZCBlbmRDbGFzc01hcHBp\nbmdFbGVtZW50KFN0cmluZyBuYW1lKQogICAgICAgIHRocm93cyBTQVhFeGNl\ncHRpb24gewogICAgICAgIE1hcHBpbmdUYWcgdGFnID0gX2VsZW1zLmdldChu\nYW1lKTsKICAgICAgICBpZiAodGFnID09IG51bGwpCiAgICAgICAgICAgIHJl\ndHVybjsKCiAgICAgICAgc3dpdGNoICh0YWcpIHsKICAgICAgICAgICAgY2Fz\nZSBTRUNPTkRBUllfVEFCTEU6CiAgICAgICAgICAgICAgICBlbmRTZWNvbmRh\ncnlUYWJsZSgpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAg\nIGNhc2UgRElTQ1JJTV9WQUw6CiAgICAgICAgICAgICAgICBlbmREaXNjcmlt\naW5hdG9yVmFsdWUoKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAg\nICAgICBjYXNlIEFTU09DX09WRVJSSURFOiAgICAgICAgICAgICAgICAKICAg\nICAgICAgICAgY2FzZSBBVFRSX09WRVJSSURFOgogICAgICAgICAgICAgICAg\nZW5kQXR0cmlidXRlT3ZlcnJpZGUoKTsKICAgICAgICAgICAgICAgIGJyZWFr\nOwogICAgICAgICAgICBjYXNlIEpPSU5fVEFCTEU6CiAgICAgICAgICAgICAg\nICBlbmRKb2luVGFibGUoKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAg\nICAgICAgICBjYXNlIFRFTVBPUkFMOgogICAgICAgICAgICAgICAgZW5kVGVt\ncG9yYWwoKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBj\nYXNlIE1BUF9LRVlfVEVNUE9SQUw6CiAgICAgICAgICAgICAgICBlbmRNYXBL\nZXlUZW1wb3JhbCgpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAg\nICAgIGNhc2UgRU5VTUVSQVRFRDoKICAgICAgICAgICAgICAgIGVuZEVudW1l\ncmF0ZWQoKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBj\nYXNlIE1BUF9LRVlfRU5VTUVSQVRFRDoKICAgICAgICAgICAgICAgIGVuZE1h\ncEtleUVudW1lcmF0ZWQoKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAg\nICAgICAgICBjYXNlIFNRTF9SRVNVTFRfU0VUX01BUFBJTkc6CiAgICAgICAg\nICAgICAgICBlbmRTUUxSZXN1bHRTZXRNYXBwaW5nKCk7CiAgICAgICAgICAg\nICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSBFTlRJVFlfUkVTVUxUOgog\nICAgICAgICAgICAgICAgZW5kRW50aXR5UmVzdWx0KCk7CiAgICAgICAgICAg\nICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSBVTklRVUU6CiAgICAgICAg\nICAgICAgICBlbmRVbmlxdWVDb25zdHJhaW50KCk7CiAgICAgICAgICAgICAg\nICBicmVhazsKICAgICAgICAgICAgY2FzZSBDT0xVTU5fTkFNRToKICAgICAg\nICAgICAgICAgIGVuZENvbHVtbk5hbWUoKTsKICAgICAgICAgICAgICAgIGJy\nZWFrOwogICAgICAgICAgICBjYXNlIFRBQkxFX0dFTjoKICAgICAgICAgICAg\nCWVuZFRhYmxlR2VuZXJhdG9yKCk7CiAgICAgICAgICAgIAlicmVhazsKICAg\nICAgICAgICAgY2FzZSBOQU1FOgogICAgICAgICAgICAgICAgZW5kTmFtZSgp\nOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgfQoKICAg\nIEBPdmVycmlkZQogICAgcHJvdGVjdGVkIHZvaWQgc3RhcnRDbGFzc01hcHBp\nbmcoQ2xhc3NNZXRhRGF0YSBtZXRhLCBib29sZWFuIG1hcHBlZFN1cGVyLAog\nICAgICAgIEF0dHJpYnV0ZXMgYXR0cnMpCiAgICAgICAgdGhyb3dzIFNBWEV4\nY2VwdGlvbiB7CiAgICAgICAgaWYgKG1hcHBlZFN1cGVyKQogICAgICAgICAg\nICAoKENsYXNzTWFwcGluZykgbWV0YSkuZ2V0TWFwcGluZ0luZm8oKS5zZXRT\ndHJhdGVneQogICAgICAgICAgICAgICAgKE5vbmVDbGFzc1N0cmF0ZWd5LkFM\nSUFTKTsKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHByb3RlY3RlZCB2b2lk\nIGVuZENsYXNzTWFwcGluZyhDbGFzc01ldGFEYXRhIG1ldGEpCiAgICAgICAg\ndGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgQ2xhc3NNYXBwaW5nIGNt\nID0gKENsYXNzTWFwcGluZykgbWV0YTsKICAgICAgICBpZiAoX3NjaGVtYSAh\nPSBudWxsKQogICAgICAgICAgICBjbS5nZXRNYXBwaW5nSW5mbygpLnNldFNj\naGVtYUlkZW50aWZpZXIoREJJZGVudGlmaWVyLm5ld1NjaGVtYShfc2NoZW1h\nLCBkZWxpbWl0KCkpKTsKCiAgICAgICAgaWYgKF9zdXBKb2luQ29scyAhPSBu\ndWxsKQogICAgICAgICAgICBjbS5nZXRNYXBwaW5nSW5mbygpLnNldENvbHVt\nbnMoX3N1cEpvaW5Db2xzKTsKCiAgICAgICAgaWYgKF9kaXNjQ29sICE9IG51\nbGwpIHsKICAgICAgICAgICAgRGlzY3JpbWluYXRvck1hcHBpbmdJbmZvIGRp\nbmZvID0gY20uZ2V0RGlzY3JpbWluYXRvcigpCiAgICAgICAgICAgICAgICAg\nICAgLmdldE1hcHBpbmdJbmZvKCk7CiAgICAgICAgICAgIHN3aXRjaCAoX2Rp\nc2NUeXBlKSB7CiAgICAgICAgICAgICAgICBjYXNlIENIQVI6CiAgICAgICAg\nICAgICAgICAgICAgX2Rpc2NDb2wuc2V0SmF2YVR5cGUoSmF2YVR5cGVzLkNI\nQVIpOwogICAgICAgICAgICAgICAgICAgIGNtLmdldERpc2NyaW1pbmF0b3Io\nKS5zZXRKYXZhVHlwZShKYXZhVHlwZXMuQ0hBUik7CiAgICAgICAgICAgICAg\nICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIElOVEVHRVI6CiAg\nICAgICAgICAgICAgICAgICAgX2Rpc2NDb2wuc2V0SmF2YVR5cGUoSmF2YVR5\ncGVzLklOVCk7CiAgICAgICAgICAgICAgICAgICAgY20uZ2V0RGlzY3JpbWlu\nYXRvcigpLnNldEphdmFUeXBlKEphdmFUeXBlcy5JTlQpOwogICAgICAgICAg\nICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgZGVmYXVsdDoKICAg\nICAgICAgICAgICAgICAgICBfZGlzY0NvbC5zZXRKYXZhVHlwZShKYXZhVHlw\nZXMuU1RSSU5HKTsKICAgICAgICAgICAgICAgICAgICBjbS5nZXREaXNjcmlt\naW5hdG9yKCkuc2V0SmF2YVR5cGUoSmF2YVR5cGVzLlNUUklORyk7CiAgICAg\nICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICAg\nICAgZGluZm8uc2V0Q29sdW1ucyhBcnJheXMuYXNMaXN0KG5ldyBDb2x1bW5b\nXXsgX2Rpc2NDb2wgfSkpOwogICAgICAgIH0KICAgICAgICBjbGVhckNsYXNz\nSW5mbygpOwogICAgfQoKICAgIC8qKgogICAgICogQ2xlYXIgY2FjaGVkIGNs\nYXNzIG1hcHBpbmcgaW5mby4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIGNs\nZWFyQ2xhc3NJbmZvKCkgewogICAgICAgIF9zdXBKb2luQ29scyA9IG51bGw7\nCiAgICAgICAgX2Rpc2NDb2wgPSBudWxsOwogICAgICAgIF9kaXNjVHlwZSA9\nIG51bGw7CiAgICB9CgogICAgLyoqCiAgICAgKiBTdGFydCB0cmFja2luZyBz\nZWNvbmRhcnkgdGFibGUgaW5mb3JtYXRpb24gYW5kIGNvbHVtbnMKICAgICAq\nLwogICAgcHJpdmF0ZSBib29sZWFuIHN0YXJ0U2Vjb25kYXJ5VGFibGUoQXR0\ncmlidXRlcyBhdHRycykKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsK\nICAgICAgICBfc2Vjb25kYXJ5VGFibGUgPSB0b1RhYmxlSWRlbnRpZmllcihh\ndHRycy5nZXRWYWx1ZSgic2NoZW1hIiksCiAgICAgICAgICAgIGF0dHJzLmdl\ndFZhbHVlKCJuYW1lIikpLmdldE5hbWUoKTsKICAgICAgICAoKENsYXNzTWFw\ncGluZyljdXJyZW50RWxlbWVudCgpKS5nZXRNYXBwaW5nSW5mbygpCiAgICAg\nICAgCS5hZGRTZWNvbmRhcnlUYWJsZShEQklkZW50aWZpZXIubmV3VGFibGUo\nX3NlY29uZGFyeVRhYmxlKSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBTZXQgdGhlIHNlY29uZGFyeSB0YWJsZSBpbmZv\ncm1hdGlvbiBiYWNrIHRvIHRoZSBvd25pbmcgY2xhc3MgbWFwcGluZy4KICAg\nICAqLwogICAgcHJpdmF0ZSB2b2lkIGVuZFNlY29uZGFyeVRhYmxlKCkgewog\nICAgICAgIENsYXNzTWFwcGluZyBjbSA9IChDbGFzc01hcHBpbmcpIGN1cnJl\nbnRFbGVtZW50KCk7CiAgICAgICAgQ2xhc3NNYXBwaW5nSW5mbyBpbmZvID0g\nY20uZ2V0TWFwcGluZ0luZm8oKTsKICAgICAgICBpbmZvLnNldFNlY29uZGFy\neVRhYmxlSm9pbkNvbHVtbnMoREJJZGVudGlmaWVyLm5ld1RhYmxlKF9zZWNv\nbmRhcnlUYWJsZSwgZGVsaW1pdCgpKSwgX2pvaW5Db2xzKTsKICAgICAgICBj\nbGVhclNlY29uZGFyeVRhYmxlSW5mbygpOwogICAgfQoKICAgIC8qKgogICAg\nICogQ2xlYXIgY2FjaGVkIHNlY29uZGFyeSB0YWJsZSBpbmZvLgogICAgICov\nCiAgICBwcml2YXRlIHZvaWQgY2xlYXJTZWNvbmRhcnlUYWJsZUluZm8oKSB7\nCiAgICAgICAgX2pvaW5Db2xzID0gbnVsbDsKICAgICAgICBfc2Vjb25kYXJ5\nVGFibGUgPSBudWxsOwogICAgfQoKICAgIC8qKgogICAgICogUGFyc2UgdGFi\nbGUtZ2VuZXJhdG9yLgogICAgICovCiAgICBwcml2YXRlIGJvb2xlYW4gc3Rh\ncnRUYWJsZUdlbmVyYXRvcihBdHRyaWJ1dGVzIGF0dHJzKSB7CiAgICAgICAg\nU3RyaW5nIG5hbWUgPSBhdHRycy5nZXRWYWx1ZSgibmFtZSIpOwogICAgICAg\nIExvZyBsb2cgPSBnZXRMb2coKTsKICAgICAgICBpZiAobG9nLmlzVHJhY2VF\nbmFibGVkKCkpCiAgICAgICAgICAgIGxvZy50cmFjZShfbG9jLmdldCgicGFy\nc2UtZ2VuIiwgbmFtZSkpOwogICAgICAgIGlmIChnZXRSZXBvc2l0b3J5KCku\nZ2V0Q2FjaGVkU2VxdWVuY2VNZXRhRGF0YShuYW1lKSAhPSBudWxsCiAgICAg\nICAgICAgICYmIGxvZy5pc1dhcm5FbmFibGVkKCkpCiAgICAgICAgICAgIGxv\nZy53YXJuKF9sb2MuZ2V0KCJvdmVycmlkZS1nZW4iLCBuYW1lKSk7CgogICAg\nICAgIFNlcXVlbmNlTWFwcGluZyBzZXEgPSAoU2VxdWVuY2VNYXBwaW5nKSBn\nZXRSZXBvc2l0b3J5KCkuCiAgICAgICAgICAgIGFkZFNlcXVlbmNlTWV0YURh\ndGEobmFtZSk7CiAgICAgICAgc2VxLnNldFNlcXVlbmNlUGx1Z2luKFNlcXVl\nbmNlTWFwcGluZy5JTVBMX1ZBTFVFX1RBQkxFKTsKICAgICAgICBzZXEuc2V0\nVGFibGVJZGVudGlmaWVyKHRvVGFibGVJZGVudGlmaWVyKGF0dHJzLmdldFZh\nbHVlKCJzY2hlbWEiKSwKICAgICAgICAgICAgYXR0cnMuZ2V0VmFsdWUoInRh\nYmxlIikpKTsKICAgICAgICBzZXEuc2V0UHJpbWFyeUtleUNvbHVtbklkZW50\naWZpZXIoREJJZGVudGlmaWVyLm5ld0NvbHVtbihhdHRycy5nZXRWYWx1ZSgi\ncGstY29sdW1uLW5hbWUiKSwgZGVsaW1pdCgpKSk7IAogICAgICAgIHNlcS5z\nZXRTZXF1ZW5jZUNvbHVtbklkZW50aWZpZXIoREJJZGVudGlmaWVyLm5ld0Nv\nbHVtbihhdHRycy5nZXRWYWx1ZSgidmFsdWUtY29sdW1uLW5hbWUiKSwgZGVs\naW1pdCgpKSk7IAogICAgICAgIHNlcS5zZXRQcmltYXJ5S2V5VmFsdWUoYXR0\ncnMuZ2V0VmFsdWUoInBrLWNvbHVtbi12YWx1ZSIpKTsKICAgICAgICBTdHJp\nbmcgdmFsID0gYXR0cnMuZ2V0VmFsdWUoImluaXRpYWwtdmFsdWUiKTsKICAg\nICAgICBpZiAodmFsICE9IG51bGwpCiAgICAgICAgICAgIHNlcS5zZXRJbml0\naWFsVmFsdWUoSW50ZWdlci5wYXJzZUludCh2YWwpKTsKICAgICAgICB2YWwg\nPSBhdHRycy5nZXRWYWx1ZSgiYWxsb2NhdGlvbi1zaXplIik7CiAgICAgICAg\naWYgKHZhbCAhPSBudWxsKQogICAgICAgICAgICBzZXEuc2V0QWxsb2NhdGUo\nSW50ZWdlci5wYXJzZUludCh2YWwpKTsKCiAgICAgICAgT2JqZWN0IGN1ciA9\nIGN1cnJlbnRFbGVtZW50KCk7CiAgICAgICAgT2JqZWN0IHNjb3BlID0gKGN1\nciBpbnN0YW5jZW9mIENsYXNzTWV0YURhdGEpCiAgICAgICAgICAgID8gKChD\nbGFzc01ldGFEYXRhKSBjdXIpLmdldERlc2NyaWJlZFR5cGUoKSA6IG51bGw7\nCiAgICAgICAgc2VxLnNldFNvdXJjZShnZXRTb3VyY2VGaWxlKCksIHNjb3Bl\nLCBTb3VyY2VUcmFja2VyLlNSQ19YTUwpOwogICAgICAgIExvY2F0b3IgbG9j\nYXRvciA9IGdldExvY2F0aW9uKCkuZ2V0TG9jYXRvcigpOwogICAgICAgIGlm\nIChsb2NhdG9yICE9IG51bGwpIHsKICAgICAgICAgICAgc2VxLnNldExpbmVO\ndW1iZXIoTnVtYmVycy52YWx1ZU9mKGxvY2F0b3IuZ2V0TGluZU51bWJlcigp\nKSk7CiAgICAgICAgICAgIHNlcS5zZXRDb2xOdW1iZXIoTnVtYmVycy52YWx1\nZU9mKGxvY2F0b3IuZ2V0Q29sdW1uTnVtYmVyKCkpKTsKICAgICAgICB9CiAg\nICAgICAgcHVzaEVsZW1lbnQoc2VxKTsKICAgICAgICByZXR1cm4gdHJ1ZTsK\nICAgIH0KICAgIAogICAgcHJpdmF0ZSB2b2lkIGVuZFRhYmxlR2VuZXJhdG9y\nKCkgewogICAgCXBvcEVsZW1lbnQoKTsKICAgIH0KCiAgICAvKioKICAgICAq\nIFBhcnNlIGluaGVyaXRhbmNlLgogICAgICovCiAgICBwcml2YXRlIGJvb2xl\nYW4gc3RhcnRJbmhlcml0YW5jZShBdHRyaWJ1dGVzIGF0dHJzKSB7CiAgICAg\nICAgU3RyaW5nIHZhbCA9IGF0dHJzLmdldFZhbHVlKCJzdHJhdGVneSIpOwog\nICAgICAgIGlmICh2YWwgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIHRy\ndWU7CgogICAgICAgIENsYXNzTWFwcGluZyBjbSA9IChDbGFzc01hcHBpbmcp\nIGN1cnJlbnRFbGVtZW50KCk7CiAgICAgICAgQ2xhc3NNYXBwaW5nSW5mbyBp\nbmZvID0gY20uZ2V0TWFwcGluZ0luZm8oKTsKICAgICAgICBzd2l0Y2ggKEVu\ndW0udmFsdWVPZihJbmhlcml0YW5jZVR5cGUuY2xhc3MsIHZhbCkpIHsKICAg\nICAgICAgICAgY2FzZSBTSU5HTEVfVEFCTEU6CiAgICAgICAgICAgICAgICBp\nbmZvLnNldEhpZXJhcmNoeVN0cmF0ZWd5KEZsYXRDbGFzc1N0cmF0ZWd5LkFM\nSUFTKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNl\nIEpPSU5FRDoKICAgICAgICAgICAgICAgIGluZm8uc2V0SGllcmFyY2h5U3Ry\nYXRlZ3koVmVydGljYWxDbGFzc1N0cmF0ZWd5LkFMSUFTKTsKICAgICAgICAg\nICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIFRBQkxFX1BFUl9DTEFT\nUzoKICAgICAgICAgICAgICAgIGluZm8uc2V0SGllcmFyY2h5U3RyYXRlZ3ko\nRnVsbENsYXNzU3RyYXRlZ3kuQUxJQVMpOwogICAgICAgICAgICAgICAgYnJl\nYWs7CiAgICAgICAgfQogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAg\nIC8qKgogICAgICogUGFyc2UgZGlzY3JpbWluYXRvci12YWx1ZS4KICAgICAq\nLwogICAgcHJpdmF0ZSB2b2lkIGVuZERpc2NyaW1pbmF0b3JWYWx1ZSgpIHsK\nICAgICAgICBTdHJpbmcgdmFsID0gY3VycmVudFRleHQoKTsKICAgICAgICBp\nZiAoU3RyaW5nVXRpbHMuaXNFbXB0eSh2YWwpKQogICAgICAgICAgICByZXR1\ncm47CgogICAgICAgIENsYXNzTWFwcGluZyBjbSA9IChDbGFzc01hcHBpbmcp\nIGN1cnJlbnRFbGVtZW50KCk7CiAgICAgICAgY20uZ2V0RGlzY3JpbWluYXRv\ncigpLmdldE1hcHBpbmdJbmZvKCkuc2V0VmFsdWUodmFsKTsKCiAgICAgICAg\naWYgKE1vZGlmaWVyLmlzQWJzdHJhY3QoY20uZ2V0RGVzY3JpYmVkVHlwZSgp\nLmdldE1vZGlmaWVycygpKQogICAgICAgICAgICAgICAgJiYgZ2V0TG9nKCku\naXNJbmZvRW5hYmxlZCgpKSB7CiAgICAgICAgICAgIGdldExvZygpLmluZm8o\nCiAgICAgICAgICAgICAgICAgICAgX2xvYy5nZXQoImRpc2NyaW1pbmF0b3It\nb24tYWJzdHJhY3QtY2xhc3MiLCBjbQogICAgICAgICAgICAgICAgICAgICAg\nICAgICAgLmdldERlc2NyaWJlZFR5cGUoKS5nZXROYW1lKCkpKTsKICAgICAg\nICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBQYXJzZSB0ZW1wb3JhbC4KICAg\nICAqLwogICAgcHJpdmF0ZSB2b2lkIGVuZFRlbXBvcmFsKCkgewogICAgICAg\nIFN0cmluZyB0ZW1wID0gY3VycmVudFRleHQoKTsKICAgICAgICBpZiAoIVN0\ncmluZ1V0aWxzLmlzRW1wdHkodGVtcCkpCiAgICAgICAgICAgIF90ZW1wb3Jh\nbCA9IEVudW0udmFsdWVPZihUZW1wb3JhbFR5cGUuY2xhc3MsIHRlbXApOwog\nICAgfQoKICAgIC8qKgogICAgICogUGFyc2UgdGVtcG9yYWwuCiAgICAgKi8K\nICAgIHByaXZhdGUgdm9pZCBlbmRNYXBLZXlUZW1wb3JhbCgpIHsKICAgICAg\nICBTdHJpbmcgdGVtcCA9IGN1cnJlbnRUZXh0KCk7CiAgICAgICAgVGVtcG9y\nYWxUeXBlIF9tYXBLZXlUZW1wb3JhbCA9IG51bGw7CiAgICAgICAgaWYgKCFT\ndHJpbmdVdGlscy5pc0VtcHR5KHRlbXApKQogICAgICAgICAgICBfbWFwS2V5\nVGVtcG9yYWwgPSBFbnVtLnZhbHVlT2YoVGVtcG9yYWxUeXBlLmNsYXNzLCB0\nZW1wKTsKICAgICAgICBGaWVsZE1hcHBpbmcgZm0gPSAoRmllbGRNYXBwaW5n\nKSBjdXJyZW50RWxlbWVudCgpOwogICAgICAgIExpc3Q8Q29sdW1uPiBjb2xz\nID0gZm0uZ2V0S2V5TWFwcGluZygpLmdldFZhbHVlSW5mbygpLmdldENvbHVt\nbnMoKTsKICAgICAgICBpZiAoY29scy5pc0VtcHR5KCkpIHsKICAgICAgICAg\nICAgY29scyA9IEFycmF5cy5hc0xpc3QobmV3IENvbHVtbltdeyBuZXcgQ29s\ndW1uKCkgfSk7CiAgICAgICAgICAgIGZtLmdldEtleU1hcHBpbmcoKS5nZXRW\nYWx1ZUluZm8oKS5zZXRDb2x1bW5zKGNvbHMpOwogICAgICAgIH0KCiAgICAg\nICAgQ29sdW1uIGNvbCA9IChDb2x1bW4pIGNvbHMuZ2V0KDApOwogICAgICAg\nIHN3aXRjaCAoX21hcEtleVRlbXBvcmFsKSB7CiAgICAgICAgICAgIGNhc2Ug\nREFURToKICAgICAgICAgICAgICAgIGNvbC5zZXRUeXBlKFR5cGVzLkRBVEUp\nOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgVElN\nRToKICAgICAgICAgICAgICAgIGNvbC5zZXRUeXBlKFR5cGVzLlRJTUUpOwog\nICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgVElNRVNU\nQU1QOgogICAgICAgICAgICAgICAgY29sLnNldFR5cGUoVHlwZXMuVElNRVNU\nQU1QKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgIH0K\nCiAgICAvKioKICAgICAqIFBhcnNlIGVudW1lcmF0ZWQuCiAgICAgKi8KICAg\nIHByaXZhdGUgdm9pZCBlbmRFbnVtZXJhdGVkKCkgewogICAgICAgIFN0cmlu\nZyB0ZXh0ID0gY3VycmVudFRleHQoKTsKICAgICAgICBpZiAoU3RyaW5nVXRp\nbHMuaXNFbXB0eSh0ZXh0KSkKICAgICAgICAgICAgcmV0dXJuOwogICAgICAg\nIEVudW1UeXBlIHR5cGUgPSBFbnVtLnZhbHVlT2YoRW51bVR5cGUuY2xhc3Ms\nIHRleHQpOwoKICAgICAgICBGaWVsZE1hcHBpbmcgZm0gPSAoRmllbGRNYXBw\naW5nKSBjdXJyZW50RWxlbWVudCgpOwogICAgICAgIFN0cmluZyBzdHJhdCA9\nIEVudW1WYWx1ZUhhbmRsZXIuY2xhc3MuZ2V0TmFtZSgpICsgIihTdG9yZU9y\nZGluYWw9IgogICAgICAgICAgICArIFN0cmluZy52YWx1ZU9mKHR5cGUgPT0g\nRW51bVR5cGUuT1JESU5BTCkgKyAiKSI7CiAgICAgICAgaWYgKGZtLmlzRWxl\nbWVudENvbGxlY3Rpb24oKSkKICAgICAgICAgICAgZm0uZ2V0RWxlbWVudE1h\ncHBpbmcoKS5nZXRWYWx1ZUluZm8oKS5zZXRTdHJhdGVneShzdHJhdCk7CiAg\nICAgICAgZWxzZQogICAgICAgICAgICBmbS5nZXRWYWx1ZUluZm8oKS5zZXRT\ndHJhdGVneShzdHJhdCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBQYXJzZSBt\nYXAta2V5LWVudW1lcmF0ZWQuCiAgICAgKi8KICAgIHByaXZhdGUgdm9pZCBl\nbmRNYXBLZXlFbnVtZXJhdGVkKCkgewogICAgICAgIFN0cmluZyB0ZXh0ID0g\nY3VycmVudFRleHQoKTsKICAgICAgICBpZiAoU3RyaW5nVXRpbHMuaXNFbXB0\neSh0ZXh0KSkKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIEVudW1UeXBl\nIHR5cGUgPSBFbnVtLnZhbHVlT2YoRW51bVR5cGUuY2xhc3MsIHRleHQpOwoK\nICAgICAgICBGaWVsZE1hcHBpbmcgZm0gPSAoRmllbGRNYXBwaW5nKSBjdXJy\nZW50RWxlbWVudCgpOwogICAgICAgIFN0cmluZyBzdHJhdCA9IEVudW1WYWx1\nZUhhbmRsZXIuY2xhc3MuZ2V0TmFtZSgpICsgIihTdG9yZU9yZGluYWw9Igog\nICAgICAgICAgICArIFN0cmluZy52YWx1ZU9mKHR5cGUgPT0gRW51bVR5cGUu\nT1JESU5BTCkgKyAiKSI7CiAgICAgICAgZm0uZ2V0S2V5TWFwcGluZygpLmdl\ndFZhbHVlSW5mbygpLnNldFN0cmF0ZWd5KHN0cmF0KTsKICAgIH0KCiAgICBA\nT3ZlcnJpZGUKICAgIHByb3RlY3RlZCBib29sZWFuIHN0YXJ0TG9iKEF0dHJp\nYnV0ZXMgYXR0cnMpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAg\nICAgICAgaWYgKHN1cGVyLnN0YXJ0TG9iKGF0dHJzKSkgewogICAgICAgICAg\nICBfbG9iID0gdHJ1ZTsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAg\nICAgfQogICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICAvKioKICAg\nICAqIEV4dGVuZCB0byBjbGVhciBhbm5vdGF0aW9uIG1hcHBpbmcgaW5mby4K\nICAgICAqLwogICAgQE92ZXJyaWRlCiAgICBwcm90ZWN0ZWQgdm9pZCBzdGFy\ndEZpZWxkTWFwcGluZyhGaWVsZE1ldGFEYXRhIGZpZWxkLCBBdHRyaWJ1dGVz\nIGF0dHJzKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24gewogICAgICAg\nIHN1cGVyLnN0YXJ0RmllbGRNYXBwaW5nKGZpZWxkLCBhdHRycyk7CiAgICAg\nICAgaWYgKGdldEFubm90YXRpb25QYXJzZXIoKSAhPSBudWxsKSB7CiAgICAg\nICAgICAgIEZpZWxkTWFwcGluZyBmbSA9IChGaWVsZE1hcHBpbmcpIGZpZWxk\nOwogICAgICAgICAgICBmbS5nZXRNYXBwaW5nSW5mbygpLmNsZWFyKCk7CiAg\nICAgICAgICAgIGZtLmdldFZhbHVlSW5mbygpLmNsZWFyKCk7CiAgICAgICAg\nICAgIGZtLmdldEVsZW1lbnRNYXBwaW5nKCkuZ2V0VmFsdWVJbmZvKCkuY2xl\nYXIoKTsKICAgICAgICAgICAgZm0uZ2V0S2V5TWFwcGluZygpLmdldFZhbHVl\nSW5mbygpLmNsZWFyKCk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAg\nICogRXh0ZW5kIHRvIHNldCB0aGUgY29sdW1ucy4KICAgICAqLwogICAgQE92\nZXJyaWRlCiAgICBwcm90ZWN0ZWQgdm9pZCBlbmRGaWVsZE1hcHBpbmcoRmll\nbGRNZXRhRGF0YSBmaWVsZCkKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9u\nIHsKICAgICAgICAvLyBzZXR1cCBjb2x1bW5zIHdpdGggY2FjaGVkIGxvYiBh\nbmQgdGVtcG9yYWwgaW5mbwogICAgICAgIEZpZWxkTWFwcGluZyBmbSA9IChG\naWVsZE1hcHBpbmcpIGZpZWxkOwogICAgICAgIGlmIChfbG9iIHx8IF90ZW1w\nb3JhbCAhPSBudWxsKSB7CiAgICAgICAgICAgIGludCB0eXBlQ29kZSA9IGZt\nLmlzRWxlbWVudENvbGxlY3Rpb24oKSA/IGZtLmdldEVsZW1lbnQoKS5nZXRE\nZWNsYXJlZFR5cGVDb2RlKCkgOiAKICAgICAgICAgICAgICAgIGZtLmdldERl\nY2xhcmVkVHlwZUNvZGUoKTsKICAgICAgICAgICAgQ2xhc3M8Pz4gdHlwZSA9\nIGZtLmlzRWxlbWVudENvbGxlY3Rpb24oKSA/IGZtLmdldEVsZW1lbnQoKS5n\nZXREZWNsYXJlZFR5cGUoKSA6IGZtLmdldERlY2xhcmVkVHlwZSgpOyAgCiAg\nICAgICAgICAgIGlmIChfY29scyA9PSBudWxsKSB7CiAgICAgICAgICAgICAg\nICBfY29scyA9IG5ldyBBcnJheUxpc3Q8Q29sdW1uPigxKTsKICAgICAgICAg\nICAgICAgIF9jb2xzLmFkZChuZXcgQ29sdW1uKCkpOwogICAgICAgICAgICB9\nCiAgICAgICAgICAgIGZvciAoQ29sdW1uIGNvbCA6IF9jb2xzKSB7CiAgICAg\nICAgICAgICAgICBpZiAoX2xvYiAmJiAodHlwZUNvZGUgPT0gSmF2YVR5cGVz\nLlNUUklORwogICAgICAgICAgICAgICAgICAgIHx8IHR5cGUgPT0gY2hhcltd\nLmNsYXNzCiAgICAgICAgICAgICAgICAgICAgfHwgdHlwZSA9PSBDaGFyYWN0\nZXJbXS5jbGFzcykpIHsKICAgICAgICAgICAgICAgICAgICBjb2wuc2V0U2l6\nZSgtMSk7CiAgICAgICAgICAgICAgICAgICAgY29sLnNldFR5cGUoVHlwZXMu\nQ0xPQik7CiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKF9sb2IpCiAgICAg\nICAgICAgICAgICAgICAgY29sLnNldFR5cGUoVHlwZXMuQkxPQik7CiAgICAg\nICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBzd2l0Y2gg\nKF90ZW1wb3JhbCkgewogICAgICAgICAgICAgICAgICAgICAgICBjYXNlIERB\nVEU6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2wuc2V0VHlwZShU\neXBlcy5EQVRFKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFr\nOwogICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFRJTUU6CiAgICAgICAg\nICAgICAgICAgICAgICAgICAgICBjb2wuc2V0VHlwZShUeXBlcy5USU1FKTsK\nICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAg\nICAgICAgICAgICAgICBjYXNlIFRJTUVTVEFNUDoKICAgICAgICAgICAgICAg\nICAgICAgICAgICAgIGNvbC5zZXRUeXBlKFR5cGVzLlRJTUVTVEFNUCk7CiAg\nICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAg\nICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAg\nICAgICB9CgogICAgICAgIGlmIChfY29scyAhPSBudWxsKSB7CiAgICAgICAg\nICAgIHN3aXRjaCAoZm0uZ2V0RGVjbGFyZWRUeXBlQ29kZSgpKSB7CiAgICAg\nICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5BUlJBWToKICAgICAgICAgICAg\nICAgICAgICBDbGFzczw/PiB0eXBlID0gZm0uZ2V0RGVjbGFyZWRUeXBlKCk7\nCiAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGUgPT0gYnl0ZVtdLmNsYXNz\nIHx8IHR5cGUgPT0gQnl0ZVtdLmNsYXNzCiAgICAgICAgICAgICAgICAgICAg\nICAgIHx8IHR5cGUgPT0gY2hhcltdLmNsYXNzIHx8IHR5cGUgPT0gQ2hhcmFj\ndGVyW10uY2xhc3MgKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGZtLmdl\ndFZhbHVlSW5mbygpLnNldENvbHVtbnMoX2NvbHMpOwogICAgICAgICAgICAg\nICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICB9CiAgICAg\nICAgICAgICAgICAgICAgLy8gZWxzZSBubyBicmVhawogICAgICAgICAgICAg\nICAgY2FzZSBKYXZhVHlwZXMuQ09MTEVDVElPTjoKICAgICAgICAgICAgICAg\nIGNhc2UgSmF2YVR5cGVzLk1BUDoKICAgICAgICAgICAgICAgICAgICBmbS5n\nZXRFbGVtZW50TWFwcGluZygpLmdldFZhbHVlSW5mbygpLnNldENvbHVtbnMo\nX2NvbHMpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAg\nICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAgICAgICBmbS5nZXRWYWx1\nZUluZm8oKS5zZXRDb2x1bW5zKF9jb2xzKTsKICAgICAgICAgICAgfQogICAg\nICAgICAgICBpZiAoX2NvbFRhYmxlICE9IG51bGwpCiAgICAgICAgICAgICAg\nICBmbS5nZXRNYXBwaW5nSW5mbygpLnNldFRhYmxlSWRlbnRpZmllcihEQklk\nZW50aWZpZXIubmV3VGFibGUoX2NvbFRhYmxlLCBkZWxpbWl0KCkpKTsKICAg\nICAgICAgICAgc2V0VW5pcXVlKGZtKTsKICAgICAgICB9CiAgICAgICAgY2xl\nYXJDb2x1bW5JbmZvKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBTZXQgdW5p\ncXVlIGZvciBmaWVsZC4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIHNldFVu\naXF1ZShGaWVsZE1hcHBpbmcgZm0pIHsKICAgICAgICBzZXRVbmlxdWUoZm0s\nIF91bmlxdWUpOwogICAgfQoKICAgIHByaXZhdGUgdm9pZCBzZXRVbmlxdWUo\nRmllbGRNYXBwaW5nIGZtLCBFbnVtU2V0PFVuaXF1ZUZsYWc+IHVuaXF1ZSkg\newogICAgICAgIGlmICh1bmlxdWUuc2l6ZSgpID09IDIpIC8vIGkuZS4gVFJV\nRSAmIEZBTFNFCiAgICAgICAgICAgIGdldExvZygpLndhcm4oX2xvYy5nZXQo\nImluY29uc2lzdC1jb2wtYXR0cnMiLCBmbSkpOwogICAgICAgIGVsc2UgaWYg\nKHVuaXF1ZS5jb250YWlucyhVbmlxdWVGbGFnLlRSVUUpKQogICAgICAgICAg\nICBmbS5nZXRWYWx1ZUluZm8oKS5zZXRVbmlxdWUobmV3IFVuaXF1ZSgpKTsK\nICAgIH0KCiAgICAvKioKICAgICAqIENsZWFyIGZpZWxkIGxldmVsIGNvbHVt\nbiBpbmZvcm1hdGlvbi4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIGNsZWFy\nQ29sdW1uSW5mbygpIHsKICAgICAgICBfY29scyA9IG51bGw7CiAgICAgICAg\nX2pvaW5Db2xzID0gbnVsbDsKICAgICAgICBfY29sVGFibGUgPSBudWxsOwog\nICAgICAgIF9sb2IgPSBmYWxzZTsKICAgICAgICBfdGVtcG9yYWwgPSBudWxs\nOwogICAgICAgIF91bmlxdWUuY2xlYXIoKTsKICAgIH0KCiAgICAvKioKICAg\nICAqIFBhcnNlIGF0dHJpYnV0ZS1vdmVycmlkZS4KICAgICAqLwogICAgcHJp\ndmF0ZSBib29sZWFuIHN0YXJ0QXR0cmlidXRlT3ZlcnJpZGUoQXR0cmlidXRl\ncyBhdHRyKSB7CiAgICAgICAgX292ZXJyaWRlID0gYXR0ci5nZXRWYWx1ZSgi\nbmFtZSIpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qKgog\nICAgICogU2V0IGF0dHJpYnV0ZSBvdmVycmlkZSBpbnRvIHByb3BlciBtYXBw\naW5nLgogICAgICovCiAgICBwcml2YXRlIHZvaWQgZW5kQXR0cmlidXRlT3Zl\ncnJpZGUoKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24gewogICAgICAg\nIE9iamVjdCBlbGVtID0gY3VycmVudEVsZW1lbnQoKTsKICAgICAgICBGaWVs\nZE1hcHBpbmcgZm0gPSBudWxsOwogICAgICAgIGlmIChlbGVtIGluc3RhbmNl\nb2YgQ2xhc3NNYXBwaW5nKQogICAgICAgICAgICBmbSA9IGdldEF0dHJpYnV0\nZU92ZXJyaWRlKChDbGFzc01hcHBpbmcpIGVsZW0pOwogICAgICAgIGVsc2Ug\newogICAgICAgICAgICBGaWVsZE1hcHBpbmcgYmFzZWZtID0gKEZpZWxkTWFw\ncGluZykgZWxlbTsKICAgICAgICAgICAgCiAgICAgICAgICAgIGZtID0gZ2V0\nQXR0cmlidXRlT3ZlcnJpZGVGb3JFbWJlZGRhYmxlKGJhc2VmbSwgX292ZXJy\naWRlLCBmYWxzZSk7CiAgICAgICAgICAgIGlmIChmbSA9PSBudWxsKSB7CiAg\nICAgICAgICAgICAgICBEZWZlcnJlZEVtYmVkZGFibGVPdmVycmlkZXMgZGZt\nID0gCiAgICAgICAgICAgICAgICAgICAgZ2V0RGVmZXJyZWRGaWVsZE1hcHBp\nbmdJbmZvKAogICAgICAgICAgICAgICAgICAgICAgICBBbm5vdGF0aW9uUGVy\nc2lzdGVuY2VNYXBwaW5nUGFyc2VyLgogICAgICAgICAgICAgICAgICAgICAg\nICBnZXRFbWJlZGRlZENsYXNzVHlwZShiYXNlZm0sIF9vdmVycmlkZSksCiAg\nICAgICAgICAgICAgICAgICAgICAgIGJhc2VmbSwgX292ZXJyaWRlLCB0cnVl\nKTsKICAgICAgICAgICAgICAgIGRmbS5fZGVmQ29scyA9IF9jb2xzOwogICAg\nICAgICAgICAgICAgZGZtLl9kZWZUYWJsZSA9IERCSWRlbnRpZmllci5uZXdU\nYWJsZShfY29sVGFibGUsIGRlbGltaXQoKSk7CiAgICAgICAgICAgICAgICBk\nZm0uX2F0dHJOYW1lID0gX292ZXJyaWRlOwogICAgICAgICAgICAgICAgZGZt\nLl91bmlxdWUgPSBfdW5pcXVlOwogICAgICAgICAgICB9CiAgICAgICAgfQog\nICAgICAgIGlmIChmbSAhPSBudWxsICYmIF9jb2xzICE9IG51bGwpIHsKICAg\nICAgICAgICAgZm0uZ2V0VmFsdWVJbmZvKCkuc2V0Q29sdW1ucyhfY29scyk7\nCiAgICAgICAgICAgIGlmIChfY29sVGFibGUgIT0gbnVsbCkKICAgICAgICAg\nICAgICAgIGZtLmdldE1hcHBpbmdJbmZvKCkuc2V0VGFibGVJZGVudGlmaWVy\nKERCSWRlbnRpZmllci5uZXdUYWJsZShfY29sVGFibGUsIGRlbGltaXQoKSkp\nOwogICAgICAgICAgICBzZXRVbmlxdWUoZm0pOwogICAgICAgIH0KICAgICAg\nICBjbGVhckNvbHVtbkluZm8oKTsKICAgICAgICBfb3ZlcnJpZGUgPSBudWxs\nOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRoZSBwcm9wZXIgb3Zl\ncnJpZGUuCiAgICAgKi8KICAgIHByaXZhdGUgRmllbGRNYXBwaW5nIGdldEF0\ndHJpYnV0ZU92ZXJyaWRlKENsYXNzTWFwcGluZyBjbSkgewogICAgICAgIEZp\nZWxkTWFwcGluZyBzdXAgPSAoRmllbGRNYXBwaW5nKSBjbS5nZXREZWZpbmVk\nU3VwZXJjbGFzc0ZpZWxkCiAgICAgICAgICAgIChfb3ZlcnJpZGUpOwogICAg\nICAgIGlmIChzdXAgPT0gbnVsbCkKICAgICAgICAgICAgc3VwID0gKEZpZWxk\nTWFwcGluZykgY20uYWRkRGVmaW5lZFN1cGVyY2xhc3NGaWVsZChfb3ZlcnJp\nZGUsCiAgICAgICAgICAgICAgICBPYmplY3QuY2xhc3MsIE9iamVjdC5jbGFz\ncyk7CiAgICAgICAgcmV0dXJuIHN1cDsKICAgIH0KCiAgICAvKioKICAgICAq\nIFJldHVybiB0aGUgcHJvcGVyIG92ZXJyaWRlLgogICAgICovCiAgICBwcml2\nYXRlIEZpZWxkTWFwcGluZyBnZXRBdHRyaWJ1dGVPdmVycmlkZUZvckVtYmVk\nZGFibGUoRmllbGRNYXBwaW5nIGZtLCAKICAgICAgICBTdHJpbmcgYXR0ck5h\nbWUsIGJvb2xlYW4gbXVzdEV4aXN0KSAKICAgIHRocm93cyBTQVhFeGNlcHRp\nb24gewogICAgICAgIHJldHVybiBBbm5vdGF0aW9uUGVyc2lzdGVuY2VNYXBw\naW5nUGFyc2VyLmdldEVtYmVkZGVkRmllbGRNYXBwaW5nKGZtLCAKICAgICAg\nICAgICAgYXR0ck5hbWUsIG11c3RFeGlzdCk7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBQYXJzZSB0YWJsZS4KICAgICAqLwogICAgcHJpdmF0ZSBib29sZWFu\nIHN0YXJ0VGFibGUoQXR0cmlidXRlcyBhdHRycykKICAgICAgICB0aHJvd3Mg\nU0FYRXhjZXB0aW9uIHsKICAgICAgICBDbGFzc01hcHBpbmcgbWFwcGluZyA9\nIChDbGFzc01hcHBpbmcpIGN1cnJlbnRFbGVtZW50KCk7CiAgICAgICAgaWYg\nKG1hcHBpbmcuaXNBYnN0cmFjdCgpKQogICAgICAgICAgICB0aHJvdyBuZXcg\nVXNlckV4Y2VwdGlvbihfbG9jLmdldCgidGFibGUtbm90LWFsbG93ZWQiLCBt\nYXBwaW5nKSk7CiAgICAgICAgREJJZGVudGlmaWVyIHRhYmxlID0gdG9UYWJs\nZUlkZW50aWZpZXIoYXR0cnMuZ2V0VmFsdWUoInNjaGVtYSIpLAogICAgICAg\nICAgICBhdHRycy5nZXRWYWx1ZSgibmFtZSIpKTsKICAgICAgICBpZiAoIURC\nSWRlbnRpZmllci5pc051bGwodGFibGUpKQogICAgICAgICAgICBtYXBwaW5n\nLmdldE1hcHBpbmdJbmZvKCkuc2V0VGFibGVJZGVudGlmaWVyKHRhYmxlKTsK\nICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvKioKICAgICAqIFBh\ncnNlIGpvaW4tdGFibGUuCiAgICAgKi8KICAgIHByaXZhdGUgYm9vbGVhbiBz\ndGFydEpvaW5UYWJsZShBdHRyaWJ1dGVzIGF0dHJzKQogICAgICAgIHRocm93\ncyBTQVhFeGNlcHRpb24gewogICAgICAgIERCSWRlbnRpZmllciBzVGFibGUg\nPSB0b1RhYmxlSWRlbnRpZmllcihhdHRycy5nZXRWYWx1ZSgic2NoZW1hIiks\nCiAgICAgICAgICAgIGF0dHJzLmdldFZhbHVlKCJuYW1lIikpOwogICAgICAg\nIGlmICghREJJZGVudGlmaWVyLmlzTnVsbChzVGFibGUpKSB7CiAgICAgICAg\nICAgIE9iamVjdCBlbGVtID0gY3VycmVudEVsZW1lbnQoKTsKICAgICAgICAg\nICAgRmllbGRNYXBwaW5nIGZtID0gbnVsbDsKICAgICAgICAgICAgaWYgKGVs\nZW0gaW5zdGFuY2VvZiBGaWVsZE1hcHBpbmcpIHsKICAgICAgICAgICAgICAg\nIGZtID0gKEZpZWxkTWFwcGluZykgZWxlbTsgCiAgICAgICAgICAgICAgICBp\nZiAoX292ZXJyaWRlICE9IG51bGwpIHsKICAgICAgICAgICAgICAgICAgICBG\naWVsZE1hcHBpbmcgYmFzZWZtID0gKEZpZWxkTWFwcGluZykgZWxlbTsKICAg\nICAgICAgICAgICAgICAgICBmbSA9IGdldEF0dHJpYnV0ZU92ZXJyaWRlRm9y\nRW1iZWRkYWJsZShiYXNlZm0sIAogICAgICAgICAgICAgICAgICAgICAgICBf\nb3ZlcnJpZGUsIGZhbHNlKTsKICAgICAgICAgICAgICAgICAgICBpZiAoZm0g\nPT0gbnVsbCkgewogICAgICAgICAgICAgICAgICAgICAgICBEZWZlcnJlZEVt\nYmVkZGFibGVPdmVycmlkZXMgZGZtID0gCiAgICAgICAgICAgICAgICAgICAg\nICAgICAgICBnZXREZWZlcnJlZEZpZWxkTWFwcGluZ0luZm8oCiAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgQW5ub3RhdGlvblBlcnNpc3RlbmNl\nTWFwcGluZ1BhcnNlci4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICBnZXRFbWJlZGRlZENsYXNzVHlwZShiYXNlZm0sIF9vdmVycmlkZSksCiAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmFzZWZtLCBfb3ZlcnJp\nZGUsIHRydWUpOwogICAgICAgICAgICAgICAgICAgICAgICBkZm0uX2RlZlRh\nYmxlID0gc1RhYmxlLmNsb25lKCk7CiAgICAgICAgICAgICAgICAgICAgICAg\nIGRmbS5fYXR0ck5hbWUgPSBfb3ZlcnJpZGU7CiAgICAgICAgICAgICAgICAg\nICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGVsc2UgaWYg\nKGVsZW0gaW5zdGFuY2VvZiBDbGFzc01hcHBpbmcpIHsKICAgICAgICAgICAg\nICAgIENsYXNzTWFwcGluZyBjbSA9IChDbGFzc01hcHBpbmcpIGVsZW07CiAg\nICAgICAgICAgICAgICBmbSA9IGdldEF0dHJpYnV0ZU92ZXJyaWRlKGNtKTsK\nICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoZm0gIT0gbnVsbCkKICAg\nICAgICAgICAgICAgIGZtLmdldE1hcHBpbmdJbmZvKCkuc2V0VGFibGVJZGVu\ndGlmaWVyKHNUYWJsZSk7CiAgICAgICAgfQogICAgICAgIHJldHVybiB0cnVl\nOwogICAgfQoKICAgIC8qKgogICAgICogU2V0IHRoZSBqb2luIHRhYmxlIGlu\nZm9ybWF0aW9uIGJhY2suCiAgICAgKi8KICAgIHByaXZhdGUgdm9pZCBlbmRK\nb2luVGFibGUoKSB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICBPYmpl\nY3QgZWxlbSA9IGN1cnJlbnRFbGVtZW50KCk7CiAgICAgICAgRmllbGRNYXBw\naW5nIGZtID0gbnVsbDsKICAgICAgICBpZiAoZWxlbSBpbnN0YW5jZW9mIEZp\nZWxkTWFwcGluZykgewogICAgICAgICAgICBmbSA9IChGaWVsZE1hcHBpbmcp\nIGVsZW07CiAgICAgICAgICAgIGlmIChfb3ZlcnJpZGUgIT0gbnVsbCkgewog\nICAgICAgICAgICAgICAgRmllbGRNYXBwaW5nIGJhc2VmbSA9IChGaWVsZE1h\ncHBpbmcpIGVsZW07CiAgICAgICAgICAgICAgICBmbSA9IGdldEF0dHJpYnV0\nZU92ZXJyaWRlRm9yRW1iZWRkYWJsZShiYXNlZm0sIF9vdmVycmlkZSwgCiAg\nICAgICAgICAgICAgICAgICAgZmFsc2UpOwogICAgICAgICAgICAgICAgaWYg\nKGZtID09IG51bGwpIHsKICAgICAgICAgICAgICAgICAgICBEZWZlcnJlZEVt\nYmVkZGFibGVPdmVycmlkZXMgZGZtID0gCiAgICAgICAgICAgICAgICAgICAg\nICAgIGdldERlZmVycmVkRmllbGRNYXBwaW5nSW5mbygKICAgICAgICAgICAg\nICAgICAgICAgICAgICAgIEFubm90YXRpb25QZXJzaXN0ZW5jZU1hcHBpbmdQ\nYXJzZXIuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnZXRFbWJlZGRl\nZENsYXNzVHlwZShiYXNlZm0sIF9vdmVycmlkZSksCiAgICAgICAgICAgICAg\nICAgICAgICAgICAgICBiYXNlZm0sIF9vdmVycmlkZSwgdHJ1ZSk7CiAgICAg\nICAgICAgICAgICAgICAgZGZtLl9kZWZDb2xzID0gX2NvbHM7CiAgICAgICAg\nICAgICAgICAgICAgZGZtLl9kZWZFbGVtSm9pbkNvbHMgPSBfam9pbkNvbHM7\nCiAgICAgICAgICAgICAgICAgICAgZGZtLl9hdHRyTmFtZSA9IF9vdmVycmlk\nZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0g\nZWxzZSBpZiAoZWxlbSBpbnN0YW5jZW9mIENsYXNzTWFwcGluZyl7CiAgICAg\nICAgICAgIENsYXNzTWFwcGluZyBjbSA9IChDbGFzc01hcHBpbmcpIGVsZW07\nCiAgICAgICAgICAgIGZtID0gZ2V0QXR0cmlidXRlT3ZlcnJpZGUoY20pOwog\nICAgICAgIH0KCiAgICAgICAgaWYgKGZtICE9IG51bGwpIHsKICAgICAgICAg\nICAgaWYgKF9qb2luQ29scyAhPSBudWxsKQogICAgICAgICAgICAgICAgZm0u\nZ2V0TWFwcGluZ0luZm8oKS5zZXRDb2x1bW5zKF9qb2luQ29scyk7CiAgICAg\nICAgICAgIGlmIChfY29scyAhPSBudWxsKQogICAgICAgICAgICAgICAgZm0u\nZ2V0RWxlbWVudE1hcHBpbmcoKS5nZXRWYWx1ZUluZm8oKS5zZXRDb2x1bW5z\nKF9jb2xzKTsKICAgICAgICB9CiAgICAgICAgY2xlYXJDb2x1bW5JbmZvKCk7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBQYXJzZSBwcmltYXJ5LWtleS1qb2lu\nLWNvbHVtbi4KICAgICAqLwogICAgcHJpdmF0ZSBib29sZWFuIHN0YXJ0UHJp\nbWFyeUtleUpvaW5Db2x1bW4oQXR0cmlidXRlcyBhdHRycykKICAgICAgICB0\naHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICBDb2x1bW4gY29sID0gcGFy\nc2VDb2x1bW4oYXR0cnMpOwogICAgICAgIGNvbC5zZXRGbGFnKENvbHVtbi5G\nTEFHX1BLX0pPSU4sIHRydWUpOwogICAgICAgIC8vIHBrIGpvaW4gY29sdW1u\ncyBvbiBmaWVsZHMgYWN0IGFzIGZpZWxkIGNvbHMKICAgICAgICBpZiAoY3Vy\ncmVudEVsZW1lbnQoKSBpbnN0YW5jZW9mIEZpZWxkTWFwcGluZykgewogICAg\nICAgICAgICBpZiAoX2NvbHMgPT0gbnVsbCkKICAgICAgICAgICAgICAgIF9j\nb2xzID0gbmV3IEFycmF5TGlzdDxDb2x1bW4+KDMpOwogICAgICAgICAgICBf\nY29scy5hZGQoY29sKTsKICAgICAgICB9IGVsc2UgaWYgKGN1cnJlbnRQYXJl\nbnQoKSA9PSBTRUNPTkRBUllfVEFCTEUpIHsKICAgICAgICAgICAgLy8gcGsg\nam9pbiBjb2x1bW5zIGluIHNlY29uZGFyeSB0YWJsZSBhY3RzIGFzIGpvaW4g\nY29scwogICAgICAgICAgICBpZiAoX2pvaW5Db2xzID09IG51bGwpCiAgICAg\nICAgICAgICAgICBfam9pbkNvbHMgPSBuZXcgQXJyYXlMaXN0PENvbHVtbj4o\nMyk7CiAgICAgICAgICAgIF9qb2luQ29scy5hZGQoY29sKTsKICAgICAgICB9\nIGVsc2UgewogICAgICAgICAgICAvLyBtdXN0IGJlIHBrIGpvaW4gY29scyBm\ncm9tIHRoaXMgY2xhc3MgdG8gc3VwZXJjbGFzcwogICAgICAgICAgICBpZiAo\nX3N1cEpvaW5Db2xzID09IG51bGwpCiAgICAgICAgICAgICAgICBfc3VwSm9p\nbkNvbHMgPSBuZXcgQXJyYXlMaXN0PENvbHVtbj4oMyk7CiAgICAgICAgICAg\nIF9zdXBKb2luQ29scy5hZGQoY29sKTsKICAgICAgICB9CiAgICAgICAgcmV0\ndXJuIHRydWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBQYXJzZSBqb2luLWNv\nbHVtbi4KICAgICAqLwogICAgcHJpdmF0ZSBib29sZWFuIHN0YXJ0Sm9pbkNv\nbHVtbihBdHRyaWJ1dGVzIGF0dHJzKQogICAgICAgIHRocm93cyBTQVhFeGNl\ncHRpb24gewogICAgICAgIC8vIG9ubHkgam9pbiBjb2xzIGluIGEgam9pbiB0\nYWJsZSBqb2luIGZpZWxkIHRhYmxlIHRvIGNsYXNzIHRhYmxlOwogICAgICAg\nIC8vIG90aGVycyBhY3QgYXMgZGF0YSBmayBjb2xzCiAgICAgICAgT2JqZWN0\nIGN1cnJlbnRQYXJlbnQgPSBjdXJyZW50UGFyZW50KCk7CiAgICAgICAgaWYg\nKGN1cnJlbnRQYXJlbnQgPT0gQ09MTEVDVElPTl9UQUJMRSkgewogICAgICAg\nICAgICBGaWVsZE1hcHBpbmcgZm0gPSAoRmllbGRNYXBwaW5nKSBwZWVrRWxl\nbWVudCgpOwogICAgICAgICAgICBDb2x1bW4gY29sID0gcGFyc2VDb2x1bW4o\nYXR0cnMpOwogICAgICAgICAgICBMaXN0PENvbHVtbj4gY29sTGlzdCA9IG5l\ndyBBcnJheUxpc3Q8Q29sdW1uPigpOwogICAgICAgICAgICBjb2xMaXN0LmFk\nZChjb2wpOwogICAgICAgICAgICBmbS5nZXRNYXBwaW5nSW5mbygpLnNldENv\nbHVtbnMoY29sTGlzdCk7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAg\nICAgIH0KICAgICAgICAKICAgICAgICBpZiAoY3VycmVudFBhcmVudCAhPSBK\nT0lOX1RBQkxFKQogICAgICAgICAgICByZXR1cm4gc3RhcnRDb2x1bW4oYXR0\ncnMpOwoKICAgICAgICBpZiAoX2pvaW5Db2xzID09IG51bGwpCiAgICAgICAg\nICAgIF9qb2luQ29scyA9IG5ldyBBcnJheUxpc3Q8Q29sdW1uPigzKTsKICAg\nICAgICBfam9pbkNvbHMuYWRkKHBhcnNlQ29sdW1uKGF0dHJzKSk7CiAgICAg\nICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBQYXJzZSBj\nb2x1bW4uCiAgICAgKi8KICAgIHByaXZhdGUgYm9vbGVhbiBzdGFydENvbHVt\nbihBdHRyaWJ1dGVzIGF0dHJzKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRp\nb24gewogICAgICAgIENvbHVtbiBjb2wgPSBwYXJzZUNvbHVtbihhdHRycyk7\nCiAgICAgICAgT2JqZWN0IG9iaiA9IHBlZWtFbGVtZW50KCk7CiAgICAgICAg\naWYgKG9iaiBpbnN0YW5jZW9mIEZpZWxkTWFwcGluZykgewogICAgICAgICAg\nICBGaWVsZE1hcHBpbmcgZm0gPSAoRmllbGRNYXBwaW5nKW9iajsKICAgICAg\nICAgICAgLy8gYSBjb2xsZWN0aW9uIG9mIGJhc2ljIHR5cGVzCiAgICAgICAg\nICAgIC8vIHRoZSBjb2x1bW4gaXMgaW4gYSBzZXBhcmF0ZSB0YWJsZQogICAg\nICAgICAgICBpZiAoZm0uaXNFbGVtZW50Q29sbGVjdGlvbigpICYmCiAgICAg\nICAgICAgICAgICAhZm0uZ2V0RWxlbWVudE1hcHBpbmcoKS5pc0VtYmVkZGVk\nKCkpIHsKICAgICAgICAgICAgICAgIExpc3Q8Q29sdW1uPiBsaXN0ID0gZm0u\nZ2V0RWxlbWVudE1hcHBpbmcoKS5nZXRWYWx1ZUluZm8oKS5nZXRDb2x1bW5z\nKCk7CiAgICAgICAgICAgICAgICBpZiAobGlzdC5zaXplKCkgPT0gMCkgewog\nICAgICAgICAgICAgICAgICAgIGxpc3QgPSBuZXcgQXJyYXlMaXN0PENvbHVt\nbj4oKTsKICAgICAgICAgICAgICAgICAgICBmbS5nZXRFbGVtZW50TWFwcGlu\nZygpLmdldFZhbHVlSW5mbygpLnNldENvbHVtbnMobGlzdCk7CiAgICAgICAg\nICAgICAgICB9CiAgICAgICAgICAgICAgICBsaXN0LmFkZChjb2wpOwogICAg\nICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgIH0KICAgICAg\nICB9CiAgICAgICAgaWYgKF9jb2xzID09IG51bGwpCiAgICAgICAgICAgIF9j\nb2xzID0gbmV3IEFycmF5TGlzdDxDb2x1bW4+KDMpOwogICAgICAgIF9jb2xz\nLmFkZChjb2wpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8q\nKgogICAgICogUGFyc2UgbWFwLWtleS1jb2x1bW4uCiAgICAgKi8KICAgIHBy\naXZhdGUgYm9vbGVhbiBzdGFydE1hcEtleUNvbHVtbihBdHRyaWJ1dGVzIGF0\ndHJzKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24gewogICAgICAgIEZp\nZWxkTWFwcGluZyBmbSA9IChGaWVsZE1hcHBpbmcpIHBlZWtFbGVtZW50KCk7\nCiAgICAgICAgQ29sdW1uIGNvbCA9IHBhcnNlQ29sdW1uKGF0dHJzKTsKICAg\nICAgICBNYXBwaW5nSW5mbyBpbmZvID0gZm0uZ2V0S2V5TWFwcGluZygpLmdl\ndFZhbHVlSW5mbygpOwogICAgICAgIExpc3Q8Q29sdW1uPiBjb2xzID0gbmV3\nIEFycmF5TGlzdDxDb2x1bW4+KCk7CiAgICAgICAgY29scy5hZGQoY29sKTsK\nICAgICAgICBpbmZvLnNldENvbHVtbnMoY29scyk7CiAgICAgICAgcmV0dXJu\nIHRydWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBQYXJzZSBtYXAta2V5LWpv\naW4tY29sdW1uLgogICAgICovCiAgICBwcml2YXRlIGJvb2xlYW4gc3RhcnRN\nYXBLZXlKb2luQ29sdW1uKEF0dHJpYnV0ZXMgYXR0cnMpCiAgICB0aHJvd3Mg\nU0FYRXhjZXB0aW9uIHsKICAgICAgICBib29sZWFuIHJldFZhbCA9IHN0YXJ0\nTWFwS2V5Q29sdW1uKGF0dHJzKTsKICAgICAgICAvLyBjaGVjayBpZiBuYW1l\nIGlzIG5vdCBzZXQsIHNldCBpdCB0byBkZWZhdWx0OiB0aGUKICAgICAgICAv\nLyBjb25jYXRlbmF0aW9uIG9mIHRoZSBuYW1lIG9mIHRoZSByZWZlcmVuY2lu\nZyBwcm9wZXJ0eQogICAgICAgIC8vIG9yIGZpZWxkIG5hbWUsICItIiwgIktF\nWSIKICAgICAgICBGaWVsZE1hcHBpbmcgZm0gPSAoRmllbGRNYXBwaW5nKSBw\nZWVrRWxlbWVudCgpOwogICAgICAgIE1hcHBpbmdJbmZvIGluZm8gPSBmbS5n\nZXRLZXlNYXBwaW5nKCkuZ2V0VmFsdWVJbmZvKCk7CiAgICAgICAgTGlzdDxD\nb2x1bW4+IGNvbHMgPSBpbmZvLmdldENvbHVtbnMoKTsKICAgICAgICBDb2x1\nbW4gY29sID0gY29scy5nZXQoMCk7CiAgICAgICAgaWYgKERCSWRlbnRpZmll\nci5pc051bGwoY29sLmdldElkZW50aWZpZXIoKSkpIHsKICAgICAgICAgICAg\nY29sLnNldElkZW50aWZpZXIoREJJZGVudGlmaWVyLm5ld0NvbHVtbihmbS5n\nZXROYW1lKCkgKyAiXyIgKyAiS0VZIiwgZGVsaW1pdCgpKSk7CiAgICAgICAg\nfQoKICAgICAgICByZXR1cm4gcmV0VmFsOwogICAgfQogICAgCiAgICAvKioK\nICAgICAqIENyZWF0ZSBhIGNvbHVtbiB3aXRoIHRoZSBnaXZlbiBhdHRyaWJ1\ndGVzLgogICAgICovCiAgICBwcml2YXRlIENvbHVtbiBwYXJzZUNvbHVtbihB\ndHRyaWJ1dGVzIGF0dHJzKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24g\newogICAgICAgIENvbHVtbiBjb2wgPSBuZXcgQ29sdW1uKCk7CiAgICAgICAg\nU3RyaW5nIHZhbCA9IGF0dHJzLmdldFZhbHVlKCJuYW1lIik7CiAgICAgICAg\naWYgKHZhbCAhPSBudWxsKQogICAgICAgICAgICBjb2wuc2V0SWRlbnRpZmll\ncihEQklkZW50aWZpZXIubmV3Q29sdW1uKHZhbCwgZGVsaW1pdCgpKSk7CiAg\nICAgICAgdmFsID0gYXR0cnMuZ2V0VmFsdWUoInJlZmVyZW5jZWQtY29sdW1u\nLW5hbWUiKTsKICAgICAgICBpZiAodmFsICE9IG51bGwpCiAgICAgICAgICAg\nIGNvbC5zZXRUYXJnZXRJZGVudGlmaWVyKERCSWRlbnRpZmllci5uZXdDb2x1\nbW4odmFsLCBkZWxpbWl0KCkpKTsKICAgICAgICB2YWwgPSBhdHRycy5nZXRW\nYWx1ZSgiY29sdW1uLWRlZmluaXRpb24iKTsKICAgICAgICBpZiAodmFsICE9\nIG51bGwpCiAgICAgICAgICAgIGNvbC5zZXRUeXBlSWRlbnRpZmllcihEQklk\nZW50aWZpZXIubmV3Q29sdW1uRGVmaW5pdGlvbih2YWwpKTsKICAgICAgICB2\nYWwgPSBhdHRycy5nZXRWYWx1ZSgicHJlY2lzaW9uIik7CiAgICAgICAgaWYg\nKHZhbCAhPSBudWxsKQogICAgICAgICAgICBjb2wuc2V0U2l6ZShJbnRlZ2Vy\nLnBhcnNlSW50KHZhbCkpOwogICAgICAgIHZhbCA9IGF0dHJzLmdldFZhbHVl\nKCJsZW5ndGgiKTsKICAgICAgICBpZiAodmFsICE9IG51bGwpCiAgICAgICAg\nICAgIGNvbC5zZXRTaXplKEludGVnZXIucGFyc2VJbnQodmFsKSk7CiAgICAg\nICAgdmFsID0gYXR0cnMuZ2V0VmFsdWUoInNjYWxlIik7CiAgICAgICAgaWYg\nKHZhbCAhPSBudWxsKQogICAgICAgICAgICBjb2wuc2V0RGVjaW1hbERpZ2l0\ncyhJbnRlZ2VyLnBhcnNlSW50KHZhbCkpOwogICAgICAgIHZhbCA9IGF0dHJz\nLmdldFZhbHVlKCJudWxsYWJsZSIpOwogICAgICAgIGlmICh2YWwgIT0gbnVs\nbCkKICAgICAgICAgICAgY29sLnNldE5vdE51bGwoImZhbHNlIi5lcXVhbHMo\ndmFsKSk7CiAgICAgICAgdmFsID0gYXR0cnMuZ2V0VmFsdWUoImluc2VydGFi\nbGUiKTsKICAgICAgICBpZiAodmFsICE9IG51bGwpCiAgICAgICAgICAgIGNv\nbC5zZXRGbGFnKENvbHVtbi5GTEFHX1VOSU5TRVJUQUJMRSwgImZhbHNlIi5l\ncXVhbHModmFsKSk7CiAgICAgICAgdmFsID0gYXR0cnMuZ2V0VmFsdWUoInVw\nZGF0YWJsZSIpOwogICAgICAgIGlmICh2YWwgIT0gbnVsbCkKICAgICAgICAg\nICAgY29sLnNldEZsYWcoQ29sdW1uLkZMQUdfVU5VUERBVEFCTEUsICJmYWxz\nZSIuZXF1YWxzKHZhbCkpOwoKICAgICAgICB2YWwgPSBhdHRycy5nZXRWYWx1\nZSgidW5pcXVlIik7CiAgICAgICAgaWYgKHZhbCAhPSBudWxsKQogICAgICAg\nICAgICBfdW5pcXVlLmFkZChFbnVtLnZhbHVlT2YoVW5pcXVlRmxhZy5jbGFz\ncywgdmFsLnRvVXBwZXJDYXNlKCkpKTsKICAgICAgICB2YWwgPSBhdHRycy5n\nZXRWYWx1ZSgidGFibGUiKTsKICAgICAgICBpZiAodmFsICE9IG51bGwpIHsK\nICAgICAgICAgICAgaWYgKF9jb2xUYWJsZSAhPSBudWxsICYmICFfY29sVGFi\nbGUuZXF1YWxzKHZhbCkpCiAgICAgICAgICAgICAgICB0aHJvdyBnZXRFeGNl\ncHRpb24oX2xvYy5nZXQoInNlY29uZC1pbmNvbnNpc3QiLAogICAgICAgICAg\nICAgICAgICAgIGN1cnJlbnRFbGVtZW50KCkpKTsKICAgICAgICAgICAgX2Nv\nbFRhYmxlID0gdmFsOwogICAgICAgIH0KICAgICAgICByZXR1cm4gY29sOwog\nICAgfQoKICAgIC8qKgogICAgICogUGFyc2UgY29sbGVjdGlvblRhYmxlLgog\nICAgICovCiAgICBwcml2YXRlIGJvb2xlYW4gc3RhcnRDb2xsZWN0aW9uVGFi\nbGUoQXR0cmlidXRlcyBhdHRycykKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0\naW9uIHsKICAgICAgICBGaWVsZE1hcHBpbmcgZm0gPSAoRmllbGRNYXBwaW5n\nKSBwZWVrRWxlbWVudCgpOwoKICAgICAgICBGaWVsZE1hcHBpbmdJbmZvIGlu\nZm8gPSBmbS5nZXRNYXBwaW5nSW5mbygpOwogICAgICAgIERCSWRlbnRpZmll\nciBjdGJsID0gcGFyc2VDb2xsZWN0aW9uVGFibGUoYXR0cnMpOwogICAgICAg\nIGluZm8uc2V0VGFibGVJZGVudGlmaWVyKGN0YmwpOwogICAgICAgIHJldHVy\nbiB0cnVlOwogICAgfQoKICAgIHByaXZhdGUgREJJZGVudGlmaWVyIHBhcnNl\nQ29sbGVjdGlvblRhYmxlKEF0dHJpYnV0ZXMgYXR0cnMpIHsKICAgICAgICBT\ndHJpbmcgdFZhbCA9IGF0dHJzLmdldFZhbHVlKCJuYW1lIik7CiAgICAgICAg\nU3RyaW5nIHNWYWwgPSBhdHRycy5nZXRWYWx1ZSgic2NoZW1hIik7CiAgICAg\nICAgcmV0dXJuIHRvVGFibGVJZGVudGlmaWVyKHNWYWwsIHRWYWwpOyAKICAg\nIH0KCiAgICAvKioKICAgICAqIEZvcm0gYSBxdWFsaWZpZWQgdGFibGUgbmFt\nZSBmcm9tIGEgc2NoZW1hIGFuZCB0YWJsZSBuYW1lLgogICAgICovCiAgICBw\ncml2YXRlIERCSWRlbnRpZmllciB0b1RhYmxlSWRlbnRpZmllcihTdHJpbmcg\nc2NoZW1hLCBTdHJpbmcgdGFibGUpIHsKICAgICAgICBEQklkZW50aWZpZXIg\nc05hbWUgPSBEQklkZW50aWZpZXIubmV3U2NoZW1hKHNjaGVtYSwgZGVsaW1p\ndCgpKTsKICAgICAgICBEQklkZW50aWZpZXIgdE5hbWUgPSBEQklkZW50aWZp\nZXIubmV3VGFibGUodGFibGUsIGRlbGltaXQoKSk7CiAgICAgICAgaWYgKERC\nSWRlbnRpZmllci5pc0VtcHR5KHROYW1lKSB8fCBEQklkZW50aWZpZXIuaXNF\nbXB0eShzTmFtZSkpIHsKICAgICAgICAgICAgcmV0dXJuIHROYW1lOwogICAg\nICAgIH0KICAgICAgICByZXR1cm4gUXVhbGlmaWVkREJJZGVudGlmaWVyLm5l\nd1BhdGgoc05hbWUsIHROYW1lKTsKICAgIH0KCgogICAgLyoqCiAgICAgKiBT\ndGFydCBwcm9jZXNzaW5nIDxjb2RlPnNxbC1yZXN1bHQtc2V0LW1hcHBpbmc8\nL2NvZGU+IG5vZGUuCiAgICAgKiBQdXNoZXMgdGhlIHtAbGluayBRdWVyeVJl\nc3VsdE1hcHBpbmd9IG9udG8gdGhlIHN0YWNrIGFzIGN1cnJlbnQgZWxlbWVu\ndC4KICAgICAqLwogICAgcHJpdmF0ZSBib29sZWFuIHN0YXJ0U1FMUmVzdWx0\nU2V0TWFwcGluZyhBdHRyaWJ1dGVzIGF0dHJzKSB7CiAgICAgICAgU3RyaW5n\nIG5hbWUgPSBhdHRycy5nZXRWYWx1ZSgibmFtZSIpOwogICAgICAgIExvZyBs\nb2cgPSBnZXRMb2coKTsKICAgICAgICBpZiAobG9nLmlzVHJhY2VFbmFibGVk\nKCkpCiAgICAgICAgICAgIGxvZy50cmFjZShfbG9jLmdldCgicGFyc2Utc3Fs\ncnNtYXBwaW5nIiwgbmFtZSkpOwoKICAgICAgICBNYXBwaW5nUmVwb3NpdG9y\neSByZXBvcyA9IChNYXBwaW5nUmVwb3NpdG9yeSkgZ2V0UmVwb3NpdG9yeSgp\nOwogICAgICAgIFF1ZXJ5UmVzdWx0TWFwcGluZyByZXN1bHQgPSByZXBvcy5n\nZXRDYWNoZWRRdWVyeVJlc3VsdE1hcHBpbmcKICAgICAgICAgICAgKG51bGws\nIG5hbWUpOwogICAgICAgIGlmIChyZXN1bHQgIT0gbnVsbCAmJiBsb2cuaXNX\nYXJuRW5hYmxlZCgpKQogICAgICAgICAgICBsb2cud2FybihfbG9jLmdldCgi\nb3ZlcnJpZGUtc3FscnNtYXBwaW5nIiwgbmFtZSwKICAgICAgICAgICAgICAg\nIGN1cnJlbnRMb2NhdGlvbigpKSk7CgogICAgICAgIHJlc3VsdCA9IHJlcG9z\nLmFkZFF1ZXJ5UmVzdWx0TWFwcGluZyhudWxsLCBuYW1lKTsKICAgICAgICBy\nZXN1bHQuc2V0TGlzdGluZ0luZGV4KF9yZXN1bHRJZHgrKyk7CiAgICAgICAg\nYWRkQ29tbWVudHMocmVzdWx0KTsKCiAgICAgICAgT2JqZWN0IGN1ciA9IGN1\ncnJlbnRFbGVtZW50KCk7CiAgICAgICAgT2JqZWN0IHNjb3BlID0gKGN1ciBp\nbnN0YW5jZW9mIENsYXNzTWV0YURhdGEpCiAgICAgICAgICAgID8gKChDbGFz\nc01ldGFEYXRhKSBjdXIpLmdldERlc2NyaWJlZFR5cGUoKSA6IG51bGw7CiAg\nICAgICAgcmVzdWx0LnNldFNvdXJjZShnZXRTb3VyY2VGaWxlKCksIHNjb3Bl\nLCBTb3VyY2VUcmFja2VyLlNSQ19YTUwpOwogICAgICAgIExvY2F0b3IgbG9j\nYXRvciA9IGdldExvY2F0aW9uKCkuZ2V0TG9jYXRvcigpOwogICAgICAgIGlm\nIChsb2NhdG9yICE9IG51bGwpIHsKICAgICAgICAgICAgcmVzdWx0LnNldExp\nbmVOdW1iZXIoTnVtYmVycy52YWx1ZU9mKGxvY2F0b3IuZ2V0TGluZU51bWJl\ncigpKSk7CiAgICAgICAgICAgIHJlc3VsdC5zZXRDb2xOdW1iZXIoTnVtYmVy\ncy52YWx1ZU9mKGxvY2F0b3IuZ2V0Q29sdW1uTnVtYmVyKCkpKTsKICAgICAg\nICB9CiAgICAgICAgcHVzaEVsZW1lbnQocmVzdWx0KTsKICAgICAgICByZXR1\ncm4gdHJ1ZTsKICAgIH0KCiAgICBwcml2YXRlIHZvaWQgZW5kU1FMUmVzdWx0\nU2V0TWFwcGluZygpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAg\nICAgICAgcG9wRWxlbWVudCgpOwogICAgfQoKICAgIC8qKgogICAgICogU3Rh\ncnQgcHJvY2Vzc2luZyA8Y29kZT5lbnRpdHktcmVzdWx0PC9jb2RlPiBub2Rl\nLgogICAgICogUHVzaGVzIHRoZSB7QGxpbmsgUXVlcnlSZXN1bHRNYXBwaW5n\nLlBDUmVzdWx0fQogICAgICogb250byB0aGUgc3RhY2sgYXMgY3VycmVudCBl\nbGVtZW50LgogICAgICovCiAgICBwcml2YXRlIGJvb2xlYW4gc3RhcnRFbnRp\ndHlSZXN1bHQoQXR0cmlidXRlcyBhdHRycykKICAgICAgICB0aHJvd3MgU0FY\nRXhjZXB0aW9uIHsKICAgICAgICBDbGFzczw/PiBlbnRpdHlDbGFzcyA9IGNs\nYXNzRm9yTmFtZShhdHRycy5nZXRWYWx1ZSgiZW50aXR5LWNsYXNzIikpOwog\nICAgICAgIFN0cmluZyBkaXNjcmltaW5hdG9yID0gREJJZGVudGlmaWVyLm5l\nd0NvbHVtbihhdHRycy5nZXRWYWx1ZSgiZGlzY3JpbWluYXRvci1jb2x1bW4i\nKSwgZGVsaW1pdCgpKS5nZXROYW1lKCk7IAoKICAgICAgICBRdWVyeVJlc3Vs\ndE1hcHBpbmcgcGFyZW50ID0gKFF1ZXJ5UmVzdWx0TWFwcGluZykgY3VycmVu\ndEVsZW1lbnQoKTsKICAgICAgICBRdWVyeVJlc3VsdE1hcHBpbmcuUENSZXN1\nbHQgcmVzdWx0ID0gcGFyZW50LmFkZFBDUmVzdWx0KGVudGl0eUNsYXNzKTsK\nICAgICAgICBpZiAoIVN0cmluZ1V0aWxzLmlzRW1wdHkoZGlzY3JpbWluYXRv\ncikpCiAgICAgICAgICAgIHJlc3VsdC5hZGRNYXBwaW5nKFBDUmVzdWx0LkRJ\nU0NSSU1JTkFUT1IsIGRpc2NyaW1pbmF0b3IpOwogICAgICAgIHB1c2hFbGVt\nZW50KHJlc3VsdCk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAg\ncHJpdmF0ZSB2b2lkIGVuZEVudGl0eVJlc3VsdCgpCiAgICAgICAgdGhyb3dz\nIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgcG9wRWxlbWVudCgpOwogICAgfQoK\nICAgIC8qKgogICAgICogUHJvY2VzcyBhIDxjb2RlPmZpZWxkLXJlc3VsdDwv\nY29kZT4gbm9kZS4KICAgICAqLwogICAgcHJpdmF0ZSBib29sZWFuIHN0YXJ0\nRmllbGRSZXN1bHQoQXR0cmlidXRlcyBhdHRycykKICAgICAgICB0aHJvd3Mg\nU0FYRXhjZXB0aW9uIHsKICAgICAgICBTdHJpbmcgZmllbGROYW1lID0gYXR0\ncnMuZ2V0VmFsdWUoIm5hbWUiKTsKICAgICAgICBTdHJpbmcgY29sdW1uTmFt\nZSA9IERCSWRlbnRpZmllci5uZXdDb2x1bW4oYXR0cnMuZ2V0VmFsdWUoImNv\nbHVtbiIpLCBkZWxpbWl0KCkpLmdldE5hbWUoKTsKCiAgICAgICAgUXVlcnlS\nZXN1bHRNYXBwaW5nLlBDUmVzdWx0IHBhcmVudCA9IChRdWVyeVJlc3VsdE1h\ncHBpbmcuUENSZXN1bHQpCiAgICAgICAgICAgIGN1cnJlbnRFbGVtZW50KCk7\nCiAgICAgICAgcGFyZW50LmFkZE1hcHBpbmcoZmllbGROYW1lLCBjb2x1bW5O\nYW1lKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvKioKICAg\nICAqIFByb2Nlc3MgYSA8Y29kZT5jb2x1bW4tcmVzdWx0PC9jb2RlPiBub2Rl\nLgogICAgICovCiAgICBwcml2YXRlIGJvb2xlYW4gc3RhcnRDb2x1bW5SZXN1\nbHQoQXR0cmlidXRlcyBhdHRycykKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0\naW9uIHsKICAgICAgICBRdWVyeVJlc3VsdE1hcHBpbmcgcGFyZW50ID0gKFF1\nZXJ5UmVzdWx0TWFwcGluZykgY3VycmVudEVsZW1lbnQoKTsKICAgICAgICBw\nYXJlbnQuYWRkQ29sdW1uUmVzdWx0KGF0dHJzLmdldFZhbHVlKCJuYW1lIikp\nOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qKiAKICAgICAq\nIFN0YXJ0cyBwcm9jZXNzaW5nICZsdDt1bmlxdWUtY29uc3RyYWludCZndDsg\ncHJvdmlkZWQgdGhlIHRhZyBvY2N1cnMKICAgICAqIHdpdGhpbiBhIENsYXNz\nTWFwcGluZyBlbGVtZW50IGFuZCA8ZW0+bm90PC9lbT4gd2l0aGluIGEgc2Vj\nb25kYXJ5CiAgICAgKiB0YWJsZS4gCiAgICAgKiBQdXNoZXMgdGhlIFVuaXF1\nZSBlbGVtZW50IGluIHRoZSBzdGFjay4KICAgICAqLwogICAgcHJpdmF0ZSBi\nb29sZWFuIHN0YXJ0VW5pcXVlQ29uc3RyYWludChBdHRyaWJ1dGVzIGF0dHJz\nKSAKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICBVbmlx\ndWUgdW5pcXVlID0gbmV3IFVuaXF1ZSgpOwoKICAgICAgICBEQklkZW50aWZp\nZXIgbmFtZSA9IERCSWRlbnRpZmllci5uZXdDb25zdHJhaW50KGF0dHJzLmdl\ndFZhbHVlKCJuYW1lIiksIGRlbGltaXQoKSk7CiAgICAgICAgaWYgKCFEQklk\nZW50aWZpZXIuaXNFbXB0eShuYW1lKSkgewogICAgICAgICAgICB1bmlxdWUu\nc2V0SWRlbnRpZmllcihuYW1lKTsKICAgICAgICB9CgogICAgICAgIHB1c2hF\nbGVtZW50KHVuaXF1ZSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CiAg\nICAKICAgIC8qKgogICAgICogRW5kcyBwcm9jZXNzaW5nICZsdDt1bmlxdWUt\nY29uc3RyYWludCZndDsgcHJvdmlkZWQgdGhlIHRhZyBvY2N1cnMKICAgICAq\nIHdpdGhpbiBhIENsYXNzTWFwcGluZyBlbGVtZW50IGFuZCA8ZW0+bm90PC9l\nbT4gd2l0aGluIGEgc2Vjb25kYXJ5CiAgICAgKiB0YWJsZS4gVGhlIHN0YWNr\nIGlzIHBvcHBlZCBhbmQgdGhlIFVuaXF1ZSBlbGVtZW50IGlzIGFkZGVkIHRv\nIHRoZQogICAgICogQ2xhc3NNYXBwaW5nSW5mby4gCiAgICAgKi8KICAgIHBy\naXZhdGUgdm9pZCBlbmRVbmlxdWVDb25zdHJhaW50KCkgewogICAgICAgIFVu\naXF1ZSB1bmlxdWUgPSAoVW5pcXVlKSBwb3BFbGVtZW50KCk7CiAgICAgICAg\nT2JqZWN0IGN0eCA9IGN1cnJlbnRFbGVtZW50KCk7CiAgICAgICAgREJJZGVu\ndGlmaWVyIHRhYmxlTmFtZSA9IERCSWRlbnRpZmllci5uZXdUYWJsZSgiPyIp\nOwogICAgICAgIGlmIChjdHggaW5zdGFuY2VvZiBDbGFzc01hcHBpbmcpIHsK\nICAgICAgICAJQ2xhc3NNYXBwaW5nSW5mbyBpbmZvID0gKChDbGFzc01hcHBp\nbmcpIGN0eCkuZ2V0TWFwcGluZ0luZm8oKTsKICAgICAgICAJdGFibGVOYW1l\nID0gKF9zZWNvbmRhcnlUYWJsZSA9PSBudWxsKSAKICAgICAgICAJCT8gaW5m\nby5nZXRUYWJsZUlkZW50aWZpZXIoKSA6IERCSWRlbnRpZmllci5uZXdUYWJs\nZShfc2Vjb25kYXJ5VGFibGUsIGRlbGltaXQoKSk7CiAgICAgICAgCWluZm8u\nYWRkVW5pcXVlKHRhYmxlTmFtZSwgdW5pcXVlKTsKICAgICAgICB9IGVsc2Ug\naWYgKGN0eCBpbnN0YW5jZW9mIEZpZWxkTWFwcGluZykgey8vIEpvaW5UYWJs\nZQogICAgICAgIAlGaWVsZE1hcHBpbmdJbmZvIGluZm8gPSAoKEZpZWxkTWFw\ncGluZyljdHgpLmdldE1hcHBpbmdJbmZvKCk7CiAgICAgICAgCWluZm8uYWRk\nSm9pblRhYmxlVW5pcXVlKHVuaXF1ZSk7CiAgICAgICAgfSBlbHNlIGlmIChj\ndHggaW5zdGFuY2VvZiBTZXF1ZW5jZU1hcHBpbmcpIHsKICAgICAgICAJU2Vx\ndWVuY2VNYXBwaW5nIHNlcSA9IChTZXF1ZW5jZU1hcHBpbmcpY3R4OwogICAg\nICAgIAl1bmlxdWUuc2V0VGFibGVJZGVudGlmaWVyKHNlcS5nZXRUYWJsZUlk\nZW50aWZpZXIoKSk7CiAgICAgICAgCUNvbHVtbltdIHVuaXF1ZUNvbHVtbnMg\nPSB1bmlxdWUuZ2V0Q29sdW1ucygpOwogICAgICAgIAlEQklkZW50aWZpZXJb\nXSBjb2x1bW5OYW1lcyA9IG5ldyBEQklkZW50aWZpZXJbdW5pcXVlQ29sdW1u\ncy5sZW5ndGhdOwogICAgICAgIAlpbnQgaSA9IDA7CiAgICAgICAgCWZvciAo\nQ29sdW1uIHVuaXF1ZUNvbHVtbiA6IHVuaXF1ZUNvbHVtbnMpCiAgICAgICAg\nCQljb2x1bW5OYW1lc1tpKytdID0gdW5pcXVlQ29sdW1uLmdldElkZW50aWZp\nZXIoKS5jbG9uZSgpOwogICAgICAgIAlzZXEuc2V0VW5pcXVlQ29sdW1uc0lk\nZW50aWZpZXIoY29sdW1uTmFtZXMpOwogICAgICAgIAlpZiAoIURCSWRlbnRp\nZmllci5pc0VtcHR5KHVuaXF1ZS5nZXRJZGVudGlmaWVyKCkpKSB7CiAgICAg\nICAgCSAgICBzZXEuc2V0VW5pcXVlQ29uc3RyYWludElkZW50aWZpZXIodW5p\ncXVlLmdldElkZW50aWZpZXIoKSk7CiAgICAgICAgCX0KICAgICAgICB9IGVs\nc2UgewogICAgICAgIAl0aHJvdyBuZXcgSW50ZXJuYWxFeGNlcHRpb24oKTsK\nICAgICAgICB9CiAgICB9CiAgICAKICAgIC8qKgogICAgICogRW5kcyBwcm9j\nZXNzaW5nICZsdDtjb2x1bW4tbmFtZSZndDsgdGFnIGJ5IGFkZGluZyB0aGUg\nY29sdW1uIG5hbWUgaW4KICAgICAqIHRoZSBjdXJyZW50IFVuaXF1ZSBlbGVt\nZW50IHRoYXQgcmVzaWRlcyBpbiB0aGUgdG9wIG9mIHRoZSBzdGFjay4KICAg\nICAqLwogICAgcHJpdmF0ZSBib29sZWFuIGVuZENvbHVtbk5hbWUoKSB7CiAg\nICAgICAgT2JqZWN0IGN1cnJlbnQgPSBjdXJyZW50RWxlbWVudCgpOwogICAg\nICAgIGlmIChjdXJyZW50IGluc3RhbmNlb2YgVW5pcXVlKSB7CiAgICAgICAg\nICAgIFVuaXF1ZSB1bmlxdWUgPSAoVW5pcXVlKSBjdXJyZW50OwogICAgICAg\nICAgICBDb2x1bW4gY29sdW1uID0gbmV3IENvbHVtbigpOwogICAgICAgICAg\nICBjb2x1bW4uc2V0SWRlbnRpZmllcihEQklkZW50aWZpZXIubmV3Q29sdW1u\nKHRoaXMuY3VycmVudFRleHQoKSwgZGVsaW1pdCgpKSk7CiAgICAgICAgICAg\nIHVuaXF1ZS5hZGRDb2x1bW4oY29sdW1uKTsKICAgICAgICAgICAgcmV0dXJu\nIHRydWU7CiAgICAgICAgfQogICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0K\nICAgIAogICAgLyoqCiAgICAgKiBUcmFjayB1bmlxdWUgY29sdW1uIHNldHRp\nbmdzLgoJICovCglwcml2YXRlIHN0YXRpYyBlbnVtIFVuaXF1ZUZsYWcKCXsK\nCQlUUlVFLAoJCUZBTFNFCgl9CgkKCXByaXZhdGUgdm9pZCBwYXJzZURpc2Ny\naW1pbmF0b3JDb2x1bW4oQXR0cmlidXRlcyBhdHRycykgeyAKCSAgICBTdHJp\nbmcgdmFsID0gYXR0cnMuZ2V0VmFsdWUoImRpc2NyaW1pbmF0b3ItdHlwZSIp\nOwogICAgICAgIGlmICh2YWwgIT0gbnVsbCkgewogICAgICAgICAgICBfZGlz\nY1R5cGUgPSBFbnVtLnZhbHVlT2YoRGlzY3JpbWluYXRvclR5cGUuY2xhc3Ms\nIHZhbCk7CiAgICAgICAgfQogICAgICAgIGVsc2UgewogICAgICAgICAgICBf\nZGlzY1R5cGUgPSBEaXNjcmltaW5hdG9yVHlwZS5TVFJJTkc7CiAgICAgICAg\nfQogICAgICAgICAgICAKCX0gIAogICAgCiAgICAvKioKICAgICAqIFByb2Nl\nc3MgT3JkZXJDb2x1bW4uCiAgICAgKi8KICAgIHByb3RlY3RlZCBib29sZWFu\nIHN0YXJ0T3JkZXJDb2x1bW4oQXR0cmlidXRlcyBhdHRycykKICAgICAgICB0\naHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICBDb2x1bW4gY29sID0gcGFy\nc2VPcmRlckNvbHVtbihhdHRycyk7CiAgICAgICAgT2JqZWN0IG9iaiA9IHBl\nZWtFbGVtZW50KCk7CiAgICAgICAgaWYgKG9iaiBpbnN0YW5jZW9mIEZpZWxk\nTWFwcGluZykgewogICAgICAgICAgICBGaWVsZE1hcHBpbmcgZm0gPSAoRmll\nbGRNYXBwaW5nKW9iajsKICAgICAgICAgICAgZm0uZ2V0TWFwcGluZ0luZm8o\nKS5zZXRPcmRlckNvbHVtbihjb2wpOwoKICAgICAgICB9CiAgICAgICAgcmV0\ndXJuIHRydWU7CiAgICB9CiAgICAvKioKICAgICAqIENyZWF0ZSBhbiBvcmRl\nciBjb2x1bW4gd2l0aCB0aGUgZ2l2ZW4gYXR0cmlidXRlcy4KICAgICAqLwog\nICAgcHJpdmF0ZSBDb2x1bW4gcGFyc2VPcmRlckNvbHVtbihBdHRyaWJ1dGVz\nIGF0dHJzKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24gewoKICAgICAg\nICBDb2x1bW4gY29sID0gbmV3IENvbHVtbigpOwogICAgICAgIFN0cmluZyB2\nYWwgPSBhdHRycy5nZXRWYWx1ZSgibmFtZSIpOwogICAgICAgIGlmICh2YWwg\nIT0gbnVsbCkKICAgICAgICAgICAgY29sLnNldElkZW50aWZpZXIoREJJZGVu\ndGlmaWVyLm5ld0NvbHVtbih2YWwsIGRlbGltaXQoKSkpOwogICAgICAgIHZh\nbCA9IGF0dHJzLmdldFZhbHVlKCJjb2x1bW4tZGVmaW5pdGlvbiIpOyAKICAg\nICAgICBpZiAodmFsICE9IG51bGwpCiAgICAgICAgICAgIGNvbC5zZXRUeXBl\nSWRlbnRpZmllcihEQklkZW50aWZpZXIubmV3Q29sdW1uRGVmaW5pdGlvbih2\nYWwpKTsKICAgICAgICB2YWwgPSBhdHRycy5nZXRWYWx1ZSgicHJlY2lzaW9u\nIik7CiAgICAgICAgaWYgKHZhbCAhPSBudWxsKQogICAgICAgICAgICBjb2wu\nc2V0U2l6ZShJbnRlZ2VyLnBhcnNlSW50KHZhbCkpOwogICAgICAgIHZhbCA9\nIGF0dHJzLmdldFZhbHVlKCJsZW5ndGgiKTsKICAgICAgICBpZiAodmFsICE9\nIG51bGwpCiAgICAgICAgICAgIGNvbC5zZXRTaXplKEludGVnZXIucGFyc2VJ\nbnQodmFsKSk7CiAgICAgICAgdmFsID0gYXR0cnMuZ2V0VmFsdWUoInNjYWxl\nIik7CiAgICAgICAgaWYgKHZhbCAhPSBudWxsKQogICAgICAgICAgICBjb2wu\nc2V0RGVjaW1hbERpZ2l0cyhJbnRlZ2VyLnBhcnNlSW50KHZhbCkpOwogICAg\nICAgIHZhbCA9IGF0dHJzLmdldFZhbHVlKCJudWxsYWJsZSIpOwogICAgICAg\nIGlmICh2YWwgIT0gbnVsbCkKICAgICAgICAgICAgY29sLnNldE5vdE51bGwo\nImZhbHNlIi5lcXVhbHModmFsKSk7CiAgICAgICAgdmFsID0gYXR0cnMuZ2V0\nVmFsdWUoImluc2VydGFibGUiKTsKICAgICAgICBpZiAodmFsICE9IG51bGwp\nCiAgICAgICAgICAgIGNvbC5zZXRGbGFnKENvbHVtbi5GTEFHX1VOSU5TRVJU\nQUJMRSwgImZhbHNlIi5lcXVhbHModmFsKSk7CiAgICAgICAgdmFsID0gYXR0\ncnMuZ2V0VmFsdWUoInVwZGF0YWJsZSIpOwogICAgICAgIGlmICh2YWwgIT0g\nbnVsbCkKICAgICAgICAgICAgY29sLnNldEZsYWcoQ29sdW1uLkZMQUdfVU5V\nUERBVEFCTEUsICJmYWxzZSIuZXF1YWxzKHZhbCkpOwogICAgICAgIAogICAg\nICAgIHJldHVybiBjb2w7CiAgICB9CiAgICAKICAgIC8qKgogICAgICogUHJv\nY2VzcyBhbGwgZGVmZXJyZWQgZW1iZWRkYWJsZSBvdmVycmlkZXMgZm9yIGEg\nZ2l2ZW4gY2xhc3MuICAKICAgICAqIFRoaXMgc2hvdWxkIG9ubHkgb2NjdXIg\nYWZ0ZXIgdGhlIGVtYmVkZGFibGUgaXMgbWFwcGVkLgogICAgICogCiAgICAg\nKiBAcGFyYW0gZW1iZWRUeXBlICBlbWJlZGRhYmxlIGNsYXNzIAogICAgICog\nQHBhcmFtIGFjY2VzcyBjbGFzcyBsZXZlbCBhY2Nlc3MgZm9yIGVtYmVkZGFi\nbGUKICAgICAqIEB0aHJvd3MgU0FYRXhjZXB0aW9uIAogICAgICovCiAgICBA\nT3ZlcnJpZGUKICAgIHByb3RlY3RlZCB2b2lkIGFwcGx5RGVmZXJyZWRFbWJl\nZGRhYmxlT3ZlcnJpZGVzKENsYXNzPD8+IGNscykgCiAgICAgICAgdGhyb3dz\nIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgQXJyYXlMaXN0PERlZmVycmVkRW1i\nZWRkYWJsZU92ZXJyaWRlcz4gZGVmTWFwcGluZ3MgPSAKICAgICAgICAgICAg\nX2RlZmVycmVkTWFwcGluZ3MuZ2V0KGNscyk7CiAgICAgICAgaWYgKGRlZk1h\ncHBpbmdzID09IG51bGwpCiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAK\nICAgICAgICBmb3IgKERlZmVycmVkRW1iZWRkYWJsZU92ZXJyaWRlcyBkZWZN\nYXAgOiBkZWZNYXBwaW5ncykgewogICAgICAgICAgICBGaWVsZE1hcHBpbmcg\nZm0gPSAoRmllbGRNYXBwaW5nKWRlZk1hcC5fZm07CiAgICAgICAgICAgIGlm\nIChkZWZNYXAgPT0gbnVsbCkKICAgICAgICAgICAgICAgIHJldHVybjsKICAg\nICAgICAgICAgZm0gPSBnZXRBdHRyaWJ1dGVPdmVycmlkZUZvckVtYmVkZGFi\nbGUoZm0sIGRlZk1hcC5fYXR0ck5hbWUsIHRydWUpOwogICAgICAgICAgICAv\nLyBBcHBseSBjb2x1bW4sIHRhYmxlLCBhbmQgdW5pcXVlIG92ZXJyaWRlcwog\nICAgICAgICAgICBpZiAoZGVmTWFwLl9kZWZDb2xzICE9IG51bGwpIHsKICAg\nICAgICAgICAgICAgIGZtLmdldFZhbHVlSW5mbygpLnNldENvbHVtbnMoZGVm\nTWFwLl9kZWZDb2xzKTsKICAgICAgICAgICAgICAgIGlmICghREJJZGVudGlm\naWVyLmlzTnVsbChkZWZNYXAuX2RlZlRhYmxlKSkKICAgICAgICAgICAgICAg\nICAgICBmbS5nZXRNYXBwaW5nSW5mbygpLnNldFRhYmxlSWRlbnRpZmllcihk\nZWZNYXAuX2RlZlRhYmxlKTsKICAgICAgICAgICAgICAgIHNldFVuaXF1ZShm\nbSwgZGVmTWFwLl91bmlxdWUpOwogICAgICAgICAgICB9CiAgICAgICAgICAg\nIC8vIEFwcGx5IEpvaW4gY29sdW1uIGFuZCBlbGVtZW50IGpvaW4gY29sdW1u\ncyBvdmVycmlkZXMgb3ZlcnJpZGVzCiAgICAgICAgICAgIGlmIChkZWZNYXAu\nX2RlZkpvaW5Db2xzICE9IG51bGwpCiAgICAgICAgICAgICAgICBmbS5nZXRN\nYXBwaW5nSW5mbygpLnNldENvbHVtbnMoZGVmTWFwLl9kZWZKb2luQ29scyk7\nCiAgICAgICAgICAgIGlmIChkZWZNYXAuX2RlZkVsZW1Kb2luQ29scyAhPSBu\ndWxsKQogICAgICAgICAgICAgICAgZm0uZ2V0RWxlbWVudE1hcHBpbmcoKS5n\nZXRWYWx1ZUluZm8oKS5zZXRDb2x1bW5zKAogICAgICAgICAgICAgICAgICAg\nIGRlZk1hcC5fZGVmRWxlbUpvaW5Db2xzKTsKICAgICAgICB9CiAgICAgICAg\nLy8gQ2xlYW4gdXAgYWZ0ZXIgYXBwbHlpbmcgbWFwcGluZ3MKICAgICAgICBk\nZWZNYXBwaW5ncy5jbGVhcigpOwogICAgICAgIF9kZWZlcnJlZE1hcHBpbmdz\nLnJlbW92ZShjbHMpOwogICAgfQoKICAgIC8qCiAgICAgKiBEZWZlciBvdmVy\ncmlkZXMgZm9yIHRoZSBzcGVjaWZpZWQgZmllbGQgbWFwcGluZwogICAgICov\nCiAgICBwcml2YXRlIHZvaWQgZGVmZXJFbWJlZGRhYmxlT3ZlcnJpZGVzKAog\nICAgICAgIENsYXNzPD8+IGNscywgRGVmZXJyZWRFbWJlZGRhYmxlT3ZlcnJp\nZGVzIGRlZk1hcCkgewogICAgICAgIEFycmF5TGlzdDxEZWZlcnJlZEVtYmVk\nZGFibGVPdmVycmlkZXM+IGRlZk1hcHBpbmdzID0gCiAgICAgICAgICAgIF9k\nZWZlcnJlZE1hcHBpbmdzLmdldChjbHMpOwogICAgICAgIGlmIChkZWZNYXBw\naW5ncyA9PSBudWxsKSB7CiAgICAgICAgICAgIGRlZk1hcHBpbmdzID0gbmV3\nIEFycmF5TGlzdDxEZWZlcnJlZEVtYmVkZGFibGVPdmVycmlkZXM+KCk7CiAg\nICAgICAgICAgIF9kZWZlcnJlZE1hcHBpbmdzLnB1dChjbHMsIGRlZk1hcHBp\nbmdzKTsKICAgICAgICB9CiAgICAgICAgZGVmTWFwcGluZ3MuYWRkKGRlZk1h\ncCk7CiAgICB9CiAgICAKICAgIC8qCiAgICAgKiBDbGVhbiB1cCBhbnkgZGVm\nZXJyZWQgbWFwcGluZ3MKICAgICAqLwogICAgQE92ZXJyaWRlCiAgICBwcm90\nZWN0ZWQgdm9pZCBjbGVhckRlZmVycmVkTWV0YURhdGEoKSB7CiAgICAgICAg\nc3VwZXIuY2xlYXJEZWZlcnJlZE1ldGFEYXRhKCk7CiAgICAgICAgX2RlZmVy\ncmVkTWFwcGluZ3MuY2xlYXIoKTsKICAgIH0KICAgIAogICAgLyoKICAgICAq\nIEdldCBlbWJlZGRhYmxlIG92ZXJyaWRlcyBmb3IgdGhlIHNwZWNpZmllZCBm\naWVsZCBtYXBwaW5nLiAgSWYgY3JlYXRlCiAgICAgKiBpcyB0cnVlLCBjcmVh\ndGUgYSBuZXcgb3ZlcnJpZGUgaWYgb25lIGRvZXMgbm90IGV4aXN0LgogICAg\nICovCiAgICBwcml2YXRlIERlZmVycmVkRW1iZWRkYWJsZU92ZXJyaWRlcyAK\nICAgICAgICBnZXREZWZlcnJlZEZpZWxkTWFwcGluZ0luZm8oQ2xhc3M8Pz4g\nY2xzLCBGaWVsZE1hcHBpbmcgZm0sIAogICAgICAgICAgICBTdHJpbmcgYXR0\nck5hbWUsIGJvb2xlYW4gY3JlYXRlKSB7CgogICAgICAgIEFycmF5TGlzdDxE\nZWZlcnJlZEVtYmVkZGFibGVPdmVycmlkZXM+IGRlZk1hcHBpbmdzID0gCiAg\nICAgICAgICAgIF9kZWZlcnJlZE1hcHBpbmdzLmdldChjbHMpOwogICAgICAg\nIAogICAgICAgIGlmIChkZWZNYXBwaW5ncyA9PSBudWxsICYmIGNyZWF0ZSkg\newogICAgICAgICAgICBkZWZNYXBwaW5ncyA9IG5ldyBBcnJheUxpc3Q8RGVm\nZXJyZWRFbWJlZGRhYmxlT3ZlcnJpZGVzPigpOwogICAgICAgICAgICBfZGVm\nZXJyZWRNYXBwaW5ncy5wdXQoY2xzLCBkZWZNYXBwaW5ncyk7CiAgICAgICAg\nfQogICAgICAgIERlZmVycmVkRW1iZWRkYWJsZU92ZXJyaWRlcyBkZm0gPSAK\nICAgICAgICAgICAgZmluZERlZmVycmVkTWFwcGluZyhjbHMsIGZtLCBhdHRy\nTmFtZSk7CgogICAgICAgIGlmIChkZm0gPT0gbnVsbCAmIGNyZWF0ZSkgewog\nICAgICAgICAgICBkZm0gPSBuZXcgRGVmZXJyZWRFbWJlZGRhYmxlT3ZlcnJp\nZGVzKGZtLCBhdHRyTmFtZSk7CiAgICAgICAgICAgIGRlZmVyRW1iZWRkYWJs\nZU92ZXJyaWRlcyhjbHMsIGRmbSk7CiAgICAgICAgfQogICAgICAgIHJldHVy\nbiBkZm07ICAgICAgICAgICAgCiAgICB9CgogICAgLyoKICAgICAqIEZpbmQg\nZGVmZXJyZWQgbWFwcGluZ3MgZm9yIHRoZSBnaXZlbiBjbGFzcywgZm0sIGFu\nZCBhdHRyIG5hbWUKICAgICAqLwogICAgcHJpdmF0ZSBEZWZlcnJlZEVtYmVk\nZGFibGVPdmVycmlkZXMgZmluZERlZmVycmVkTWFwcGluZyhDbGFzczw/PiBj\nbHMsIAogICAgICAgIEZpZWxkTWFwcGluZyBmbSwgU3RyaW5nIGF0dHJOYW1l\nKSB7CiAgICAgICAgQXJyYXlMaXN0PERlZmVycmVkRW1iZWRkYWJsZU92ZXJy\naWRlcz4gZGVmTWFwcGluZ3MgPSAKICAgICAgICAgICAgX2RlZmVycmVkTWFw\ncGluZ3MuZ2V0KGNscyk7CiAgICAgICAgaWYgKGRlZk1hcHBpbmdzID09IG51\nbGwpCiAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgIAogICAgICAg\nIGZvciAoRGVmZXJyZWRFbWJlZGRhYmxlT3ZlcnJpZGVzIGRmbSA6IGRlZk1h\ncHBpbmdzKSB7CiAgICAgICAgICAgIGlmIChkZm0gIT0gbnVsbCAmJiBkZm0u\nX2ZtID09IGZtICYmIAogICAgICAgICAgICAgICAgYXR0ck5hbWUuZXF1YWxz\nKGRmbS5fYXR0ck5hbWUpKQogICAgICAgICAgICAgICAgcmV0dXJuIGRmbTsK\nICAgICAgICB9CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICB9CiAgICAKICAg\nIC8vIElubmVyIGNsYXNzIGZvciBzdG9yaW5nIG92ZXJyaWRlIGluZm9ybWF0\naW9uCiAgICBjbGFzcyBEZWZlcnJlZEVtYmVkZGFibGVPdmVycmlkZXMgewog\nICAgICAgIERlZmVycmVkRW1iZWRkYWJsZU92ZXJyaWRlcyhGaWVsZE1hcHBp\nbmcgZm0sIFN0cmluZyBhdHRyTmFtZSkgewogICAgICAgICAgICBfZm0gPSBm\nbTsKICAgICAgICAgICAgX2F0dHJOYW1lID0gYXR0ck5hbWU7CiAgICAgICAg\nICAgIF9kZWZUYWJsZSA9IERCSWRlbnRpZmllci5OVUxMOwogICAgICAgIH0K\nICAgICAgICBwcml2YXRlIEZpZWxkTWFwcGluZyBfZm07CiAgICAgICAgcHJp\ndmF0ZSBMaXN0PENvbHVtbj4gX2RlZkNvbHM7CiAgICAgICAgcHJpdmF0ZSBM\naXN0PENvbHVtbj4gX2RlZkVsZW1Kb2luQ29sczsKICAgICAgICBwcml2YXRl\nIExpc3Q8Q29sdW1uPiBfZGVmSm9pbkNvbHM7CiAgICAgICAgcHJpdmF0ZSBE\nQklkZW50aWZpZXIgX2RlZlRhYmxlOwogICAgICAgIHByaXZhdGUgU3RyaW5n\nIF9hdHRyTmFtZTsKICAgICAgICBwcml2YXRlIEVudW1TZXQ8VW5pcXVlRmxh\nZz4gX3VuaXF1ZTsKICAgIH0gIAogICAgCiAgICBAT3ZlcnJpZGUKICAgIHBy\nb3RlY3RlZCBib29sZWFuIHN0YXJ0RGVsaW1pdGVkSWRlbnRpZmllcnMoKSB7\nCiAgICAgICAgSkRCQ0NvbmZpZ3VyYXRpb24gY29uZiA9IChKREJDQ29uZmln\ndXJhdGlvbikgZ2V0Q29uZmlndXJhdGlvbigpOwogICAgICAgIERCRGljdGlv\nbmFyeSBkaWN0ID0gY29uZi5nZXREQkRpY3Rpb25hcnlJbnN0YW5jZSgpOwog\nICAgICAgIGRpY3Quc2V0RGVsaW1pdElkZW50aWZpZXJzKHRydWUpOwogICAg\nICAgIHJldHVybiB0cnVlOwogICAgfQogICAgCiAgICBAT3ZlcnJpZGUKICAg\nIHByb3RlY3RlZCBTdHJpbmcgbm9ybWFsaXplU2VxdWVuY2VOYW1lKFN0cmlu\nZyBzZXFOYW1lKSB7CiAgICAgICAgaWYgKFN0cmluZ1V0aWxzLmlzRW1wdHko\nc2VxTmFtZSkpIHsKICAgICAgICAgICAgcmV0dXJuIHNlcU5hbWU7CiAgICAg\nICAgfQogICAgICAgIHJldHVybiBEQklkZW50aWZpZXIubmV3U2VxdWVuY2Uo\nc2VxTmFtZSwgZGVsaW1pdCgpKS5nZXROYW1lKCk7CiAgICB9CiAgICAKICAg\nIEBPdmVycmlkZQogICAgcHJvdGVjdGVkIFN0cmluZyBub3JtYWxpemVTY2hl\nbWFOYW1lKFN0cmluZyBzY2hOYW1lKSB7CiAgICAgICAgaWYgKFN0cmluZ1V0\naWxzLmlzRW1wdHkoc2NoTmFtZSkpIHsKICAgICAgICAgICAgcmV0dXJuIHNj\naE5hbWU7CiAgICAgICAgfQogICAgICAgIHJldHVybiBEQklkZW50aWZpZXIu\nbmV3U2NoZW1hKHNjaE5hbWUsIGRlbGltaXQoKSkuZ2V0TmFtZSgpOwogICAg\nfQoKICAgIEBPdmVycmlkZQogICAgcHJvdGVjdGVkIFN0cmluZyBub3JtYWxp\nemVDYXRhbG9nTmFtZShTdHJpbmcgY2F0TmFtZSkgewogICAgICAgIGlmIChT\ndHJpbmdVdGlscy5pc0VtcHR5KGNhdE5hbWUpKSB7CiAgICAgICAgICAgIHJl\ndHVybiBjYXROYW1lOwogICAgICAgIH0KICAgICAgICByZXR1cm4gREJJZGVu\ndGlmaWVyLm5ld0NhdGFsb2coY2F0TmFtZSwgZGVsaW1pdCgpKS5nZXROYW1l\nKCk7CiAgICB9CgogICAgcHJpdmF0ZSBib29sZWFuIGRlbGltaXQoKSB7CiAg\nICAgICAgcmV0dXJuIF9kaWN0LmdldERlbGltaXRJZGVudGlmaWVycygpOwog\nICAgfQp9Cg==\n","encoding":"base64"}

