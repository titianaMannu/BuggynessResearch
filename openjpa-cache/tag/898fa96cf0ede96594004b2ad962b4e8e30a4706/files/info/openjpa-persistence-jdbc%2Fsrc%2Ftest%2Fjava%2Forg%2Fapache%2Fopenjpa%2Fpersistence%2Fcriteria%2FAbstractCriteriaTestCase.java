{"sha":"8921d5d5da3f1af8fbeb3c4400e9739268d9abe4","node_id":"MDQ6QmxvYjIwNjM2NDo4OTIxZDVkNWRhM2YxYWY4ZmJlYjNjNDQwMGU5NzM5MjY4ZDlhYmU0","size":15054,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/8921d5d5da3f1af8fbeb3c4400e9739268d9abe4","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwogcGFj\na2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuY3JpdGVyaWE7\nCgppbXBvcnQgamF2YS5pby5QcmludFdyaXRlcjsKaW1wb3J0IGphdmEuaW8u\nU3RyaW5nV3JpdGVyOwppbXBvcnQgamF2YS5sYW5nLnJlZmxlY3QuTWV0aG9k\nOwppbXBvcnQgamF2YS51dGlsLkFycmF5TGlzdDsKaW1wb3J0IGphdmEudXRp\nbC5IYXNoTWFwOwppbXBvcnQgamF2YS51dGlsLkxpc3Q7CmltcG9ydCBqYXZh\nLnV0aWwuTWFwOwoKaW1wb3J0IGphdmF4LnBlcnNpc3RlbmNlLkVudGl0eU1h\nbmFnZXI7CmltcG9ydCBqYXZheC5wZXJzaXN0ZW5jZS5QZXJzaXN0ZW5jZTsK\naW1wb3J0IGphdmF4LnBlcnNpc3RlbmNlLlF1ZXJ5OwppbXBvcnQgamF2YXgu\ncGVyc2lzdGVuY2UuY3JpdGVyaWEuQ3JpdGVyaWFRdWVyeTsKCmltcG9ydCBq\ndW5pdC5mcmFtZXdvcmsuVGVzdENhc2U7CgppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLmpkYmMuY29uZi5KREJDQ29uZmlndXJhdGlvbjsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNxbC5EQkRpY3Rpb25hcnk7CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zcWwuRGVyYnlEaWN0aW9uYXJ5\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc3FsLkhTUUxEaWN0\naW9uYXJ5OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc3FsLk15\nU1FMRGljdGlvbmFyeTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJj\nLnNxbC5PcmFjbGVEaWN0aW9uYXJ5OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLmxpYi5qZGJjLkFic3RyYWN0SkRCQ0xpc3RlbmVyOwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLmxpYi5qZGJjLkpEQkNFdmVudDsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5saWIuamRiYy5KREJDTGlzdGVuZXI7CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLmpkYmMuUmVwb3J0aW5nU1FMRXhj\nZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNl\nLk9wZW5KUEFFbnRpdHlNYW5hZ2VyRmFjdG9yeVNQSTsKaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS50ZXN0LkFsbG93RmFpbHVyZTsK\nCnB1YmxpYyBhYnN0cmFjdCBjbGFzcyBBYnN0cmFjdENyaXRlcmlhVGVzdENh\nc2UgZXh0ZW5kcyBUZXN0Q2FzZSB7CgogICAgcHJvdGVjdGVkIGFic3RyYWN0\nIFNRTEF1ZGl0b3IgZ2V0QXVkaXRvcigpOwoKICAgIHByb3RlY3RlZCBhYnN0\ncmFjdCBPcGVuSlBBRW50aXR5TWFuYWdlckZhY3RvcnlTUEkgZ2V0RW50aXR5\nTWFuYWdlckZhY3RvcnkoKTsKICAgIAogICAgcHJvdGVjdGVkIGFic3RyYWN0\nIEVudGl0eU1hbmFnZXIgZ2V0RW50aXR5TWFuYWdlcigpOwogICAgcHJpdmF0\nZSBEQkRpY3Rpb25hcnkgZGljdCA9IG51bGw7CgogICAgcHVibGljIERCRGlj\ndGlvbmFyeSBnZXREaWN0aW9uYXJ5KCkgewogICAgICAgIHJldHVybiBkaWN0\nOwogICAgfQoKICAgIC8qKgogICAgICogQ3JlYXRlIGFuIGVudGl0eSBtYW5h\nZ2VyIGZhY3RvcnkgZm9yIHBlcnNpc3RlbmNlIHVuaXQgPGNvZGU+cHU8L2Nv\nZGU+LiBQdXQge0BsaW5rICNDTEVBUl9UQUJMRVN9IGluIHRoaXMgbGlzdCB0\nbwogICAgICogdGVsbCB0aGUgdGVzdCBmcmFtZXdvcmsgdG8gZGVsZXRlIGFs\nbCB0YWJsZSBjb250ZW50cyBiZWZvcmUgcnVubmluZyB0aGUgdGVzdHMuCiAg\nICAgKiAKICAgICAqIEBwYXJhbSBwcm9wcwogICAgICogICAgICAgICAgICBs\naXN0IG9mIHBlcnNpc3RlbnQgdHlwZXMgdXNlZCBpbiB0ZXN0aW5nIGFuZC9v\nciBjb25maWd1cmF0aW9uIHZhbHVlcyBpbiB0aGUgZm9ybQogICAgICogICAg\nICAgICAgICBrZXksdmFsdWUsa2V5LHZhbHVlLi4uCiAgICAgKi8KICAgIHBy\nb3RlY3RlZCBPcGVuSlBBRW50aXR5TWFuYWdlckZhY3RvcnlTUEkgY3JlYXRl\nTmFtZWRFTUYoQ2xhc3M8Pz4uLi4gdHlwZXMpIHsKICAgICAgICBNYXA8T2Jq\nZWN0LCBPYmplY3Q+IG1hcCA9IG5ldyBIYXNoTWFwPE9iamVjdCwgT2JqZWN0\nPigpOwogICAgICAgIG1hcC5wdXQoIm9wZW5qcGEuamRiYy5TeW5jaHJvbml6\nZU1hcHBpbmdzIiwgImJ1aWxkU2NoZW1hKEZvcmVpZ25LZXlzPXRydWUsIiAr\nICJTY2hlbWFBY3Rpb249J2FkZCcpIik7CiAgICAgICAgbWFwLnB1dCgib3Bl\nbmpwYS5qZGJjLlF1ZXJ5U1FMQ2FjaGUiLCAiZmFsc2UiKTsKICAgICAgICBt\nYXAucHV0KCJvcGVuanBhLkR5bmFtaWNFbmhhbmNlbWVudEFnZW50IiwgImZh\nbHNlIik7CiAgICAgICAgbWFwLnB1dCgib3BlbmpwYS5SdW50aW1lVW5lbmhh\nbmNlZENsYXNzZXMiLCAidW5zdXBwb3J0ZWQiKTsKICAgICAgICBtYXAucHV0\nKCJvcGVuanBhLkNvbXBhdGliaWxpdHkiLCAiUXVvdGVkTnVtYmVyc0luUXVl\ncmllcz10cnVlIik7CiAgICAgICAgbWFwLnB1dCgib3BlbmpwYS5qZGJjLkpE\nQkNMaXN0ZW5lcnMiLCBuZXcgSkRCQ0xpc3RlbmVyW10geyBnZXRBdWRpdG9y\nKCkgfSk7CgogICAgICAgIFN0cmluZ0J1ZmZlciBidWYgPSBuZXcgU3RyaW5n\nQnVmZmVyKCk7CiAgICAgICAgZm9yIChDbGFzczw/PiBjIDogdHlwZXMpIHsK\nICAgICAgICAgICAgaWYgKGJ1Zi5sZW5ndGgoKSA+IDApCiAgICAgICAgICAg\nICAgICBidWYuYXBwZW5kKCI7Iik7CiAgICAgICAgICAgIGJ1Zi5hcHBlbmQo\nYy5nZXROYW1lKCkpOwogICAgICAgIH0KCiAgICAgICAgbWFwLnB1dCgib3Bl\nbmpwYS5NZXRhRGF0YUZhY3RvcnkiLCAianBhKFR5cGVzPSIgKyBidWYudG9T\ndHJpbmcoKSArICIpIik7CgogICAgICAgIE1hcDxPYmplY3QsIE9iamVjdD4g\nY29uZmlnID0gbmV3IEhhc2hNYXA8T2JqZWN0LCBPYmplY3Q+KFN5c3RlbS5n\nZXRQcm9wZXJ0aWVzKCkpOwogICAgICAgIGNvbmZpZy5wdXRBbGwobWFwKTsK\nICAgICAgICByZXR1cm4gKE9wZW5KUEFFbnRpdHlNYW5hZ2VyRmFjdG9yeVNQ\nSSkgUGVyc2lzdGVuY2UuY3JlYXRlRW50aXR5TWFuYWdlckZhY3RvcnkoInRl\nc3QiLCBjb25maWcpOwogICAgfQoKICAgIHZvaWQgc2V0RGljdGlvbmFyeSgp\nIHsKICAgICAgICBKREJDQ29uZmlndXJhdGlvbiBjb25mID0gKEpEQkNDb25m\naWd1cmF0aW9uKSBnZXRFbnRpdHlNYW5hZ2VyRmFjdG9yeSgpLmdldENvbmZp\nZ3VyYXRpb24oKTsKICAgICAgICBkaWN0ID0gY29uZi5nZXREQkRpY3Rpb25h\ncnlJbnN0YW5jZSgpOwogICAgICAgIGlmIChkaWN0IGluc3RhbmNlb2YgRGVy\nYnlEaWN0aW9uYXJ5IHx8IGRpY3QgaW5zdGFuY2VvZiBIU1FMRGljdGlvbmFy\neSkgewogICAgICAgICAgICBkaWN0LnJlcXVpcmVzQ2FzdEZvckNvbXBhcmlz\nb25zID0gZmFsc2U7CiAgICAgICAgICAgIGRpY3QucmVxdWlyZXNDYXN0Rm9y\nTWF0aEZ1bmN0aW9ucyA9IGZhbHNlOwogICAgICAgIH0gZWxzZSBpZiAoZGlj\ndCBpbnN0YW5jZW9mIE9yYWNsZURpY3Rpb25hcnkpIHsKICAgICAgICAgICAg\nZGljdC5zZXRKb2luU3ludGF4KCJzcWw5MiIpOwogICAgICAgIH0gCiAgICB9\nCgogICAgLyoqCiAgICAgKiBFeGVjdXRlcyB0aGUgZ2l2ZW4gQ3JpdGVyaWFR\ndWVyeSBhbmQgSlBRTCBzdHJpbmcgYW5kIGNvbXBhcmUgdGhlaXIgcmVzcGVj\ndGl2ZSBTUUxzIGZvciBlcXVhbGl0eS4KICAgICAqLwogICAgdm9pZCBhc3Nl\ncnRFcXVpdmFsZW5jZShDcml0ZXJpYVF1ZXJ5PD8+IGMsIFN0cmluZyBqcHFs\nKSB7CiAgICAgICAgYXNzZXJ0RXF1aXZhbGVuY2UobnVsbCwgYywganBxbCwg\nbnVsbCk7CiAgICB9CiAgICAKICAgIC8qKgogICAgICogRXhlY3V0ZXMgdGhl\nIGdpdmVuIENyaXRlcmlhUXVlcnkgYW5kIEpQUUwgc3RyaW5nIGFuZCBjb21w\nYXJlIHRoZWlyIHJlc3BlY3RpdmUgU1FMcyBmb3IgZXF1YWxpdHkKICAgICAq\nIHdpdGggdGhlIGV4cGVjdGVkIFNRTC4KICAgICAqLwogICAgdm9pZCBhc3Nl\ncnRFcXVpdmFsZW5jZShDcml0ZXJpYVF1ZXJ5PD8+IGMsIFN0cmluZyBqcHFs\nLCBTdHJpbmcgZXhwZWN0ZWRTUUwpIHsKICAgICAgICBhc3NlcnRFcXVpdmFs\nZW5jZShudWxsLCBjLCBqcHFsLCBleHBlY3RlZFNRTCk7CiAgICB9CiAgICAK\nICAgIC8qKgogICAgICogRXhlY3V0ZXMgdGhlIGdpdmVuIENyaXRlcmlhUXVl\ncnkgYW5kIEpQUUwgc3RyaW5nIGFmdGVyIGRlY29yYXRpbmcgd2l0aCB0aGUg\nZ2l2ZW4gZGVjb3JhdG9yLAogICAgICogYW5kIHRoZW4gY29tcGFyZSB0aGVp\nciByZXNwZWN0aXZlIFNRTHMgZm9yIGVxdWFsaXR5LgogICAgICovCiAgICB2\nb2lkIGFzc2VydEVxdWl2YWxlbmNlKFF1ZXJ5RGVjb3JhdG9yIGRlY29yYXRv\nciwgQ3JpdGVyaWFRdWVyeTw/PiBjLCBTdHJpbmcganBxbCkgewogICAgICAg\nIGFzc2VydEVxdWl2YWxlbmNlKGRlY29yYXRvciwgYywganBxbCwgbnVsbCk7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBFeGVjdXRlcyB0aGUgZ2l2ZW4gQ3Jp\ndGVyaWFRdWVyeSBhbmQgSlBRTCBzdHJpbmcgYW5kIGNvbXBhcmUgdGhlaXIg\ncmVzcGVjdGl2ZSBTUUxzIGZvciBlcXVhbGl0eS4gCiAgICAgKiBEZWNvcmF0\nZXMgdGhlIHF1ZXJ5IHdpdGggdGhlIGdpdmVuIGRlY29yYXRvciBiZWZvcmUg\nZXhlY3V0aW9uLgogICAgICogc3VwcGxpZWQgcGFyYW1ldGVycywgaWYgYW55\nLgogICAgICovCiAgICB2b2lkIGFzc2VydEVxdWl2YWxlbmNlKFF1ZXJ5RGVj\nb3JhdG9yIGRlY29yYXRvciwgQ3JpdGVyaWFRdWVyeTw/PiBjLCBTdHJpbmcg\nanBxbCwgU3RyaW5nIGV4cGVjdGVkU1FMKSB7CiAgICAgICAgU3lzdGVtLmVy\nci5wcmludGxuKCJKUFFMOlsiICsganBxbCArICJdIik7CiAgICAgICAgU3lz\ndGVtLmVyci5wcmludGxuKCJDUUwgOlsiICsgKChPcGVuSlBBQ3JpdGVyaWFR\ndWVyeTw/PiljKS50b0NRTCgpKTsKICAgICAgICBRdWVyeSBjUSA9IGdldEVu\ndGl0eU1hbmFnZXIoKS5jcmVhdGVRdWVyeShjKTsKICAgICAgICBRdWVyeSBq\nUSA9IGdldEVudGl0eU1hbmFnZXIoKS5jcmVhdGVRdWVyeShqcHFsKTsKICAg\nICAgICBpZiAoZGVjb3JhdG9yICE9IG51bGwpIHsKICAgICAgICAgICAgZGVj\nb3JhdG9yLmRlY29yYXRlKGNRKTsKICAgICAgICAgICAgZGVjb3JhdG9yLmRl\nY29yYXRlKGpRKTsKICAgICAgICB9CiAgICAgICAgZXhlY3V0ZUFuZENvbXBh\ncmVTUUwoanBxbCwgY1EsIGpRLCBleHBlY3RlZFNRTCk7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBFeGVjdXRlIHRoZSB0d28gZ2l2ZW4gcXVlcmllcy4gVGhl\nIGZpcnN0IHF1ZXJ5IG9yaWdpbmF0ZWQgZnJvbSBhIEpQUUwgc3RyaW5nIG11\nc3QgYmUgd2VsbC1mb3JtZWQuIFRoZSBzZWNvbmQKICAgICAqIHF1ZXJ5IG9y\naWdpbmF0ZWQgZnJvbSBhIENyaXRlcmlhIGlzIGJlaW5nIHRlc3RlZC4KICAg\nICAqIAogICAgICogQHBhcmFtIHNxbHMKICAgICAqICAgICAgICAgICAgVGhl\nIHRhcmdldCBTUUwgZm9yIHRoZSBxdWVyaWVzIHdpbGwgYmUgZmlsbGVkLWlu\nIHRoZSBnaXZlbiBhcnJheS4KICAgICAqIEByZXR1cm4gdHJ1ZSBpZiBib3Ro\nIHF1ZXJpZXMgZXhlY3V0ZSBzdWNjZXNzZnVsbHkuCiAgICAgKi8KICAgIHZv\naWQgZXhlY3V0ZUFuZENvbXBhcmVTUUwoU3RyaW5nIGpwcWwsIFF1ZXJ5IGNR\nLCBRdWVyeSBqUSwgU3RyaW5nIGV4cGVjdGVkU1FMKSB7CiAgICAgICAgTGlz\ndDxTdHJpbmc+IGpTUUwgPSBudWxsOwogICAgICAgIExpc3Q8U3RyaW5nPiBj\nU1FMID0gbnVsbDsKICAgICAgICB0cnkgewogICAgICAgICAgICBqU1FMID0g\nZXhlY3V0ZVF1ZXJ5QW5kQ29sbGVjdFNRTChqUSk7CiAgICAgICAgfSBjYXRj\naCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgU3RyaW5nV3JpdGVyIHcg\nPSBuZXcgU3RyaW5nV3JpdGVyKCk7CiAgICAgICAgICAgIGUucHJpbnRTdGFj\na1RyYWNlKG5ldyBQcmludFdyaXRlcih3KSk7CiAgICAgICAgICAgIGZhaWwo\nIkpQUUwgIiArIGpwcWwgKyAiIGZhaWxlZCB0byBleGVjdXRlXHJcbiIgKyB3\nKTsKICAgICAgICB9CiAgICAgICAgZ2V0RW50aXR5TWFuYWdlcigpLmNsZWFy\nKCk7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgY1NRTCA9IGV4ZWN1dGVR\ndWVyeUFuZENvbGxlY3RTUUwoY1EpOwogICAgICAgIH0gY2F0Y2ggKEV4Y2Vw\ndGlvbiBlKSB7CiAgICAgICAgICAgIFN0cmluZ1dyaXRlciB3ID0gbmV3IFN0\ncmluZ1dyaXRlcigpOwogICAgICAgICAgICBlLnByaW50U3RhY2tUcmFjZShu\nZXcgUHJpbnRXcml0ZXIodykpOwogICAgICAgICAgICBmYWlsKCJDcml0ZXJp\nYVF1ZXJ5IGNvcnJlc3BvbmRpbmcgdG8gIiArIGpwcWwgKyAiIGZhaWxlZCB0\nbyBleGVjdXRlXHJcbiIgKyB3KTsKICAgICAgICB9CgogICAgICAgIGlmIChq\nU1FMLnNpemUoKSAhPSBjU1FMLnNpemUoKSkgewogICAgICAgICAgICBwcmlu\ndFNRTCgiVGFyZ2V0IFNRTCBmb3IgSlBRTCIsIGpTUUwpOwogICAgICAgICAg\nICBwcmludFNRTCgiVGFyZ2V0IFNRTCBmb3IgQ3JpdGVyaWFRdWVyeSIsIGNT\nUUwpOwogICAgICAgICAgICBhc3NlcnRFcXVhbHMoIk5vLiBvZiBTUUwgZ2Vu\nZXJhdGVkIGZvciBKUFFMIGFuZCBDcml0ZXJpYVF1ZXJ5IGZvciAiICsganBx\nbCArICIgaXMgZGlmZmVyZW50IiwgalNRTC5zaXplKCksCiAgICAgICAgICAg\nICAgICBjU1FMLnNpemUoKSk7CiAgICAgICAgfQoKICAgICAgICBpZiAoIShk\naWN0IGluc3RhbmNlb2YgRGVyYnlEaWN0aW9uYXJ5IHx8IGRpY3QgaW5zdGFu\nY2VvZiBNeVNRTERpY3Rpb25hcnkpKQogICAgICAgICAgICByZXR1cm47Cgog\nICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgalNRTC5zaXplKCk7IGkrKykg\newogICAgICAgICAgICBpZiAoIWpTUUwuZ2V0KGkpLmVxdWFsc0lnbm9yZUNh\nc2UoY1NRTC5nZXQoaSkpKSB7CiAgICAgICAgICAgICAgICBwcmludFNRTCgi\nVGFyZ2V0IFNRTCBmb3IgSlBRTCIsIGpTUUwpOwogICAgICAgICAgICAgICAg\ncHJpbnRTUUwoIlRhcmdldCBTUUwgZm9yIENyaXRlcmlhUXVlcnkiLCBjU1FM\nKTsKICAgICAgICAgICAgICAgIGFzc2VydFRydWUoaSArICItdGggU1FMIGZv\nciBKUFFMIGFuZCBDcml0ZXJpYVF1ZXJ5IGZvciAiICsganBxbCArICIgaXMg\nZGlmZmVyZW50XHJcbiIgKwogICAgICAgICAgICAgICAgICAgICAgICAiSlBR\nTCA9IFsiICsgalNRTC5nZXQoaSkgKyAiXVxyXG4iICsKICAgICAgICAgICAg\nICAgICAgICAgICAgIkNTUUwgPSBbIiArIGNTUUwuZ2V0KGkpICsgIl1cclxu\nIiwKICAgICAgICAgICAgICAgICAgICAgICAgalNRTC5nZXQoaSkuZXF1YWxz\nSWdub3JlQ2FzZShjU1FMLmdldChpKSkpOwogICAgICAgICAgICB9CiAgICAg\nICAgfQoKICAgICAgICBpZiAoZXhwZWN0ZWRTUUwgIT0gbnVsbCkgewogICAg\nICAgICAgICBhc3NlcnRUcnVlKCJTUUwgZm9yIEpQUUwgIiArIGpwcWwgKyAi\nIGlzIGRpZmZlcmVudCB0aGFuIGV4cGVjZXRkICIgKyBleHBlY3RlZFNRTCwg\nCiAgICAgICAgICAgICAgICAgICAgalNRTC5nZXQoMCkuZXF1YWxzSWdub3Jl\nQ2FzZShleHBlY3RlZFNRTCkpOwogICAgICAgICAgICAKICAgICAgICB9CiAg\nICB9CgogICAgdm9pZCBleGVjdXRlQW5kQ29tcGFyZVNRTChTdHJpbmcganBx\nbCwgU3RyaW5nIGV4cGVjdGVkU1FMKSB7CiAgICAgICAgUXVlcnkgalEgPSBn\nZXRFbnRpdHlNYW5hZ2VyKCkuY3JlYXRlUXVlcnkoanBxbCk7CgogICAgICAg\nIExpc3Q8U3RyaW5nPiBqU1FMID0gbnVsbDsKICAgICAgICB0cnkgewogICAg\nICAgICAgICBqU1FMID0gZXhlY3V0ZVF1ZXJ5QW5kQ29sbGVjdFNRTChqUSk7\nCiAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAg\nU3RyaW5nV3JpdGVyIHcgPSBuZXcgU3RyaW5nV3JpdGVyKCk7CiAgICAgICAg\nICAgIGUucHJpbnRTdGFja1RyYWNlKG5ldyBQcmludFdyaXRlcih3KSk7CiAg\nICAgICAgICAgIGZhaWwoIkpQUUwgIiArIGpwcWwgKyAiIGZhaWxlZCB0byBl\neGVjdXRlXHJcbiIgKyB3KTsKICAgICAgICB9CgogICAgICAgIGlmICghKGRp\nY3QgaW5zdGFuY2VvZiBEZXJieURpY3Rpb25hcnkgfHwgZGljdCBpbnN0YW5j\nZW9mIE15U1FMRGljdGlvbmFyeSkpCiAgICAgICAgICAgIHJldHVybjsKCiAg\nICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBqU1FMLnNpemUoKTsgaSsrKSB7\nCiAgICAgICAgICAgIGlmICghalNRTC5nZXQoaSkuZXF1YWxzSWdub3JlQ2Fz\nZShleHBlY3RlZFNRTCkpIHsKICAgICAgICAgICAgICAgIHByaW50U1FMKCJT\nUUwgZm9yIEpQUUwiLCBqU1FMLmdldChpKSk7CiAgICAgICAgICAgICAgICBw\ncmludFNRTCgiRXhwZWN0ZWQgU1FMIiwgZXhwZWN0ZWRTUUwpOwogICAgICAg\nICAgICAgICAgYXNzZXJ0VHJ1ZShpICsgIi10aCBTUUwgZm9yIEpQUUw6ICIg\nKyBqU1FMLmdldChpKSArICIgYXJlIGRpZmZlcmVudCB0aGFuIEV4cGVjdGVk\nIFNRTCAiICsgZXhwZWN0ZWRTUUwsIAogICAgICAgICAgICAgICAgICAgIGV4\ncGVjdGVkU1FMLmVxdWFsc0lnbm9yZUNhc2UoalNRTC5nZXQoaSkpKTsKICAg\nICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICB2b2lkIGV4ZWN1dGVB\nbmRDb21wYXJlU1FMKFF1ZXJ5IGpRLCBTdHJpbmcgZXhwZWN0ZWRTUUwpIHsK\nICAgICAgICBMaXN0PFN0cmluZz4galNRTCA9IG51bGw7CiAgICAgICAgdHJ5\nIHsKICAgICAgICAgICAgalNRTCA9IGV4ZWN1dGVRdWVyeUFuZENvbGxlY3RT\nUUwoalEpOwogICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAg\nICAgICAgIFN0cmluZ1dyaXRlciB3ID0gbmV3IFN0cmluZ1dyaXRlcigpOwog\nICAgICAgICAgICBlLnByaW50U3RhY2tUcmFjZShuZXcgUHJpbnRXcml0ZXIo\ndykpOwogICAgICAgICAgICBmYWlsKHcudG9TdHJpbmcoKSk7CiAgICAgICAg\nfQoKICAgICAgICBpZiAoIShkaWN0IGluc3RhbmNlb2YgRGVyYnlEaWN0aW9u\nYXJ5IHx8IGRpY3QgaW5zdGFuY2VvZiBNeVNRTERpY3Rpb25hcnkpKQogICAg\nICAgICAgICByZXR1cm47CgogICAgICAgIFN0cmluZyBqU3FsID0galNRTC5n\nZXQoMCkudHJpbSgpOwogICAgICAgIGlmIChqU3FsLmluZGV4T2YoIm9wdGlt\naXplIGZvciAxIHJvdyIpICE9IC0xKQogICAgICAgICAgICBqU3FsID0galNx\nbC5zdWJzdHJpbmcoMCwgalNxbC5pbmRleE9mKCJvcHRpbWl6ZSBmb3IgMSBy\nb3ciKSkudHJpbSgpOwoKICAgICAgICBpZiAoIWpTcWwuZXF1YWxzSWdub3Jl\nQ2FzZShleHBlY3RlZFNRTCkpIHsKICAgICAgICAgICAgcHJpbnRTUUwoIlNR\nTCBmb3IgSlBRTCIsIGpTcWwpOwogICAgICAgICAgICBhc3NlcnRUcnVlKCJT\nUUwgZm9yIEpQUUwgIiArIGpTcWwgKyAiIGlzIGRpZmZlcmVudCB0aGFuIGV4\ncGVjZXRkICIgKyBleHBlY3RlZFNRTCwKICAgICAgICAgICAgICAgICAgICBl\neHBlY3RlZFNRTC5lcXVhbHNJZ25vcmVDYXNlKGpTcWwpKTsKICAgICAgICB9\nCiAgICB9CgogICAgdm9pZCBleGVjdXRlRXhwZWN0RmFpbChDcml0ZXJpYVF1\nZXJ5PD8+IGMsIFN0cmluZyBqcHFsKSB7CiAgICAgICAgdHJ5IHsKICAgICAg\nICAgICAgUXVlcnkgY1EgPSBnZXRFbnRpdHlNYW5hZ2VyKCkuY3JlYXRlUXVl\ncnkoYyk7CiAgICAgICAgICAgIGV4ZWN1dGVRdWVyeUFuZENvbGxlY3RTUUwo\nY1EpOwogICAgICAgICAgICBmYWlsKCJDcml0ZXJpYVF1ZXJ5IGNvcnJlc3Bv\nbmRpbmcgdG8gIiArIGpwcWwgKyAiIGlzIGV4cGVjdGVkIHRvIGZhaWxcclxu\nIik7CiAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICAg\nICAgLy8gZXhwZWN0ZWQKICAgICAgICB9CiAgICB9CgogICAgdm9pZCBleGVj\ndXRlRXhwZWN0RmFpbChDcml0ZXJpYVF1ZXJ5PD8+IGMsIFN0cmluZyBqcHFs\nLCBTdHJpbmdbXSBwYXJhbU5hbWVzLCBPYmplY3RbXSBwYXJhbXMpIHsKICAg\nICAgICB0cnkgewogICAgICAgICAgICBRdWVyeSBjUSA9IGdldEVudGl0eU1h\nbmFnZXIoKS5jcmVhdGVRdWVyeShjKTsKICAgICAgICAgICAgZm9yIChpbnQg\naSA9IDA7IGkgPCBwYXJhbXMubGVuZ3RoOyBpKyspCiAgICAgICAgICAgICAg\nICBjUS5zZXRQYXJhbWV0ZXIocGFyYW1OYW1lc1tpXSwgcGFyYW1zW2ldKTsK\nICAgICAgICAgICAgZXhlY3V0ZVF1ZXJ5QW5kQ29sbGVjdFNRTChjUSk7CiAg\nICAgICAgICAgIGZhaWwoIkNyaXRlcmlhUXVlcnkgY29ycmVzcG9uZGluZyB0\nbyAiICsganBxbCArICIgaXMgZXhwZWN0ZWQgdG8gZmFpbFxyXG4iKTsKICAg\nICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkgewogICAgICAgICAgICAvLyBl\neHBlY3RlZAogICAgICAgIH0KICAgIH0KCiAgICB2b2lkIGV4ZWN1dGVFeHBl\nY3RGYWlsKFN0cmluZyBqcHFsKSB7CiAgICAgICAgdHJ5IHsKICAgICAgICAg\nICAgUXVlcnkgalEgPSBnZXRFbnRpdHlNYW5hZ2VyKCkuY3JlYXRlUXVlcnko\nanBxbCk7CiAgICAgICAgICAgIGV4ZWN1dGVRdWVyeUFuZENvbGxlY3RTUUwo\nalEpOwogICAgICAgICAgICBmYWlsKCJKUFFMICIgKyBqcHFsICsgIiBpcyBl\neHBlY3RlZCB0byBGYWlsZWQgdG8gZXhlY3V0ZVxyXG4iKTsKICAgICAgICB9\nIGNhdGNoIChFeGNlcHRpb24gZSkgewogICAgICAgICAgICAvLyBleHBlY3Rl\nZAogICAgICAgIH0KICAgIH0KCiAgICB2b2lkIGV4ZWN1dGVFeHBlY3RGYWls\nKFN0cmluZyBqcHFsLCBTdHJpbmdbXSBwYXJhbU5hbWVzLCBPYmplY3RbXSBw\nYXJhbXMpIHsKICAgICAgICB0cnkgewogICAgICAgICAgICBRdWVyeSBqUSA9\nIGdldEVudGl0eU1hbmFnZXIoKS5jcmVhdGVRdWVyeShqcHFsKTsKICAgICAg\nICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBwYXJhbXMubGVuZ3RoOyBpKysp\nCiAgICAgICAgICAgICAgICBqUS5zZXRQYXJhbWV0ZXIocGFyYW1OYW1lc1tp\nXSwgcGFyYW1zW2ldKTsKICAgICAgICAgICAgZXhlY3V0ZVF1ZXJ5QW5kQ29s\nbGVjdFNRTChqUSk7CiAgICAgICAgICAgIGZhaWwoIkpQUUwgIiArIGpwcWwg\nKyAiIGlzIGV4cGVjdGVkIHRvIEZhaWxlZCB0byBleGVjdXRlXHJcbiIpOwog\nICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgIC8v\nIGV4cGVjdGVkCiAgICAgICAgfQogICAgfQoKICAgIHZvaWQgcHJpbnRTUUwo\nU3RyaW5nIGhlYWRlciwgU3RyaW5nIHNxbCkgewogICAgICAgIFN5c3RlbS5l\ncnIucHJpbnRsbihoZWFkZXIpOwogICAgICAgIFN5c3RlbS5lcnIucHJpbnRs\nbihzcWwpOwogICAgfQoKICAgIHZvaWQgcHJpbnRTUUwoU3RyaW5nIGhlYWRl\nciwgTGlzdDxTdHJpbmc+IHNxbHMpIHsKICAgICAgICBTeXN0ZW0uZXJyLnBy\naW50bG4oaGVhZGVyKTsKICAgICAgICBmb3IgKGludCBpID0gMDsgc3FscyAh\nPSBudWxsICYmIGkgPCBzcWxzLnNpemUoKTsgaSsrKSB7CiAgICAgICAgICAg\nIFN5c3RlbS5lcnIucHJpbnRsbihpICsgIjoiICsgc3Fscy5nZXQoaSkpOwog\nICAgICAgIH0KICAgIH0KCgogICAgLyoqCiAgICAgKiBFeGVjdXRlIHRoZSBn\naXZlbiBxdWVyeSBhbmQgcmV0dXJuIHRoZSBnZW5lcmF0ZWQgU1FMLiBJZiB0\naGUgcXVlcnkgZXhlY3V0aW9uIGZhaWwgYmVjYXVzZSB0aGUgZ2VuZXJhdGVk\nIFNRTCBpcwogICAgICogaWxsLWZvcm1lZCwgdGhlbiByYWlzZWQgZXhjZXB0\naW9uIHNob3VsZCBjYXJyeSB0aGUgaWxsLWZvcm1lZCBTUUwgZm9yIGRpYWdu\nb3Npcy4KICAgICAqLwogICAgTGlzdDxTdHJpbmc+IGV4ZWN1dGVRdWVyeUFu\nZENvbGxlY3RTUUwoUXVlcnkgcSkgewogICAgICAgIGdldEF1ZGl0b3IoKS5j\nbGVhcigpOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIHEuZ2V0UmVzdWx0\nTGlzdCgpOwogICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAg\nICAgICAgIHRocm93IG5ldyBSdW50aW1lRXhjZXB0aW9uKGV4dHJhY3RTUUwo\nZSksIGUpOwogICAgICAgIH0KICAgICAgICBhc3NlcnRGYWxzZShnZXRBdWRp\ndG9yKCkuZ2V0U1FMcygpLmlzRW1wdHkoKSk7CiAgICAgICAgcmV0dXJuIGdl\ndEF1ZGl0b3IoKS5nZXRTUUxzKCk7CiAgICB9CgogICAgdm9pZCBleGVjdXRl\nQW5kQ29tcGFyZVNRTChDcml0ZXJpYVF1ZXJ5PD8+IHEsIFN0cmluZyBleHBl\nY3RlZFNRTCkgewogICAgICAgIGV4ZWN1dGVBbmRDb21wYXJlU1FMKGdldEVu\ndGl0eU1hbmFnZXIoKS5jcmVhdGVRdWVyeShxKSwgZXhwZWN0ZWRTUUwpOwog\nICAgfQoKICAgIFN0cmluZyBleHRyYWN0U1FMKEV4Y2VwdGlvbiBlKSB7CiAg\nICAgICAgVGhyb3dhYmxlIHQgPSBlLmdldENhdXNlKCk7CiAgICAgICAgaWYg\nKHQgaW5zdGFuY2VvZiBSZXBvcnRpbmdTUUxFeGNlcHRpb24pIHsKICAgICAg\nICAgICAgcmV0dXJuICgoUmVwb3J0aW5nU1FMRXhjZXB0aW9uKSB0KS5nZXRT\nUUwoKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuICJDYW4gbm90IGV4dHJh\nY3QgU1FMIGZyb20gZXhjZXB0aW9uICIgKyBlOwogICAgfQoKICAgIEBPdmVy\ncmlkZQogICAgcHVibGljIHZvaWQgcnVuQmFyZSgpIHRocm93cyBUaHJvd2Fi\nbGUgewogICAgICAgIHRyeSB7CiAgICAgICAgICAgIHN1cGVyLnJ1bkJhcmUo\nKTsKICAgICAgICB9IGNhdGNoIChUaHJvd2FibGUgdCkgewogICAgICAgICAg\nICBBbGxvd0ZhaWx1cmUgYWxsb3dGYWlsdXJlID0gZ2V0QWxsb3dGYWlsdXJl\nKCk7CiAgICAgICAgICAgIGlmIChhbGxvd0ZhaWx1cmUgIT0gbnVsbCAmJiBh\nbGxvd0ZhaWx1cmUudmFsdWUoKSkgewogICAgICAgICAgICAgICAgU3lzdGVt\nLmVyci5wcmludGxuKCIqKiogRkFJTEVEIChidXQgaWdub3JlZCk6ICIgKyB0\naGlzKTsKICAgICAgICAgICAgICAgIFN5c3RlbS5lcnIucHJpbnRsbigiKioq\nICAgICAgICAgICAgICBSZWFzb24gOiAiICsgYWxsb3dGYWlsdXJlLm1lc3Nh\nZ2UoKSk7CiAgICAgICAgICAgICAgICBTeXN0ZW0uZXJyLnByaW50bG4oIlN0\nYWNrdHJhY2Ugb2YgZmFpbHVyZSIpOwogICAgICAgICAgICAgICAgdC5wcmlu\ndFN0YWNrVHJhY2UoKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAg\nICAgICAgIHRocm93IHQ7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9\nCgogICAgLyoqCiAgICAgKiBBZmZpcm1zIGlmIHRoZSB0ZXN0IGNhc2Ugb3Ig\ndGhlIHRlc3QgbWV0aG9kIGlzIGFubm90YXRlZCB3aXRoCiAgICAgKiAKICAg\nICAqIEBBbGxvd0ZhaWx1cmUuIE1ldGhvZCBsZXZlbCBhbm5vdGF0aW9uIGhh\ncyBoaWdoZXIgcHJlY2VkZW5jZSB0aGFuIENsYXNzIGxldmVsIGFubm90YXRp\nb24uCiAgICAgKiAKICAgICAqICAgICAgICAgICAgICAgIFNldCAtRElnbm9y\nZUFsbG93RmFpbHVyZT10cnVlIHRvIGlnbm9yZSB0aGlzIGRpcmVjdGl2ZSBh\nbHRvZ2V0aGVyLgogICAgICovCiAgICBwcm90ZWN0ZWQgQWxsb3dGYWlsdXJl\nIGdldEFsbG93RmFpbHVyZSgpIHsKICAgICAgICBpZiAoQm9vbGVhbi5nZXRC\nb29sZWFuKCJJZ25vcmVBbGxvd0ZhaWx1cmUiKSkgewogICAgICAgICAgICBy\nZXR1cm4gbnVsbDsKICAgICAgICB9CiAgICAgICAgdHJ5IHsKICAgICAgICAg\nICAgTWV0aG9kIHJ1bk1ldGhvZCA9IGdldENsYXNzKCkuZ2V0TWV0aG9kKGdl\ndE5hbWUoKSwgKENsYXNzW10pIG51bGwpOwogICAgICAgICAgICBBbGxvd0Zh\naWx1cmUgYW5ubyA9IHJ1bk1ldGhvZC5nZXRBbm5vdGF0aW9uKEFsbG93RmFp\nbHVyZS5jbGFzcyk7CiAgICAgICAgICAgIGlmIChhbm5vICE9IG51bGwpIHsK\nICAgICAgICAgICAgICAgIHJldHVybiBhbm5vOwogICAgICAgICAgICB9CiAg\nICAgICAgfSBjYXRjaCAoU2VjdXJpdHlFeGNlcHRpb24gZSkgewogICAgICAg\nICAgICAvLyBpZ25vcmUKICAgICAgICB9IGNhdGNoIChOb1N1Y2hNZXRob2RF\neGNlcHRpb24gZSkgewogICAgICAgICAgICAvLyBpZ25vcmUKICAgICAgICB9\nCiAgICAgICAgcmV0dXJuIGdldENsYXNzKCkuZ2V0QW5ub3RhdGlvbihBbGxv\nd0ZhaWx1cmUuY2xhc3MpOwogICAgfQoKICAgIHB1YmxpYyBjbGFzcyBTUUxB\ndWRpdG9yIGV4dGVuZHMgQWJzdHJhY3RKREJDTGlzdGVuZXIgewogICAgICAg\nIHByaXZhdGUgTGlzdDxTdHJpbmc+IHNxbHMgPSBuZXcgQXJyYXlMaXN0PFN0\ncmluZz4oKTsKCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgcHVibGljIHZv\naWQgYmVmb3JlRXhlY3V0ZVN0YXRlbWVudChKREJDRXZlbnQgZXZlbnQpIHsK\nICAgICAgICAgICAgaWYgKGV2ZW50LmdldFNRTCgpICE9IG51bGwgJiYgc3Fs\ncyAhPSBudWxsKSB7CiAgICAgICAgICAgICAgICBzcWxzLmFkZChldmVudC5n\nZXRTUUwoKSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHZv\naWQgY2xlYXIoKSB7CiAgICAgICAgICAgIHNxbHMuY2xlYXIoKTsKICAgICAg\nICB9CgogICAgICAgIExpc3Q8U3RyaW5nPiBnZXRTUUxzKCkgewogICAgICAg\nICAgICByZXR1cm4gbmV3IEFycmF5TGlzdDxTdHJpbmc+KHNxbHMpOwogICAg\nICAgIH0KICAgIH0KICAgIAogICAgLyoqCiAgICAgKiBJbnRlcmZhY2UgdG8g\nZGVjb3JhdGUgYSBxdWVyeSBzdWNoIGFzIHNldCBwYXJhbWV0ZXIgb3IgcmFu\nZ2UgYmVmb3JlIGV4ZWN1dGlvbi4KICAgICAqCiAgICAgKi8KICAgIHB1Ymxp\nYyBpbnRlcmZhY2UgUXVlcnlEZWNvcmF0b3IgewogICAgICAgIHZvaWQgZGVj\nb3JhdGUoUXVlcnkgcSk7CiAgICB9Cn0K\n","encoding":"base64"}

