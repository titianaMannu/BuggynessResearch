{"sha":"aa268b75ed196b935e921b14b57b78763e17396c","node_id":"MDQ6QmxvYjIwNjM2NDphYTI2OGI3NWVkMTk2YjkzNWU5MjFiMTRiNTdiNzg3NjNlMTczOTZj","size":7166,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/aa268b75ed196b935e921b14b57b78763e17396c","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuY3JpdGVy\naWE7CgppbXBvcnQgamF2YS5zcWwuRGF0ZTsKaW1wb3J0IGphdmEuc3FsLlRp\nbWU7CmltcG9ydCBqYXZhLnNxbC5UaW1lc3RhbXA7CmltcG9ydCBqYXZhLnV0\naWwuTGlzdDsKCmltcG9ydCBqYXZheC5wZXJzaXN0ZW5jZS5RdWVyeTsKaW1w\nb3J0IGphdmF4LnBlcnNpc3RlbmNlLmNyaXRlcmlhLkNyaXRlcmlhUXVlcnk7\nCmltcG9ydCBqYXZheC5wZXJzaXN0ZW5jZS5jcml0ZXJpYS5Sb290OwoKaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuRmlsdGVyczsKCi8qKgog\nKiBUZXN0IEpEQkMgRXNjYXBlIFN5bnRheCBkYXRlL3RpbWUgc3RyaW5ncyBp\nbiBxdWVyeS4KICogCiAqIAogKiBAYXV0aG9yIFBpbmFraSBQb2RkYXIKICoK\nICovCnB1YmxpYyBjbGFzcyBUZXN0RGF0ZVN0cmluZ0NvbnZlcnNpb24gZXh0\nZW5kcyBDcml0ZXJpYVRlc3QgewogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwg\nU3RyaW5nIE9QRU5fQlJBQ0tFVCAgPSAieyI7CiAgICBwcml2YXRlIHN0YXRp\nYyBmaW5hbCBTdHJpbmcgQ0xPU0VfQlJBQ0tFVCA9ICJ9IjsKICAgIHByaXZh\ndGUgc3RhdGljIGZpbmFsIFN0cmluZyBTSU5HTEVfUVVPVEUgID0gIiciOwog\nICAgCiAgICB2b2lkIGNyZWF0ZURhdGEoU3RyaW5nIG5hbWUpIHsKICAgICAg\nICBsb25nIG5vdyA9IFN5c3RlbS5jdXJyZW50VGltZU1pbGxpcygpOwogICAg\nICAgIGxvbmcgdG9tb3Jyb3cgPSBub3cgKyAyNCo2MCo2MCoxMDAwKzE7CiAg\nICAgICAgCiAgICAgICAgRGF0ZSBkYXRlID0gbmV3IERhdGUodG9tb3Jyb3cp\nOwogICAgICAgIERlcGVuZGVudElkIGlkID0gbmV3IERlcGVuZGVudElkKCk7\nCiAgICAgICAgaWQuc2V0RWZmRGF0ZShkYXRlKTsKICAgICAgICBpZC5zZXRO\nYW1lKG5hbWUpOwogICAgICAgIERlcGVuZGVudCBwYyA9IG5ldyBEZXBlbmRl\nbnQoKTsKICAgICAgICBwYy5zZXRJZChpZCk7CiAgICAgICAgcGMuc2V0RW5k\nRGF0ZShkYXRlKTsKICAgICAgICBlbS5nZXRUcmFuc2FjdGlvbigpLmJlZ2lu\nKCk7CiAgICAgICAgZW0ucGVyc2lzdChwYyk7CiAgICAgICAgZW0uZ2V0VHJh\nbnNhY3Rpb24oKS5jb21taXQoKTsKICAgIH0KICAgIAogICAgLyoqCiAgICAg\nKiBUaGUgcGVyc2lzdGVudCBwcm9wZXJ0eSBEZXBlbmRlbnQuZW5kRGF0ZSBi\nZWluZyB0ZXN0ZWQgaXMgZGVjbGFyZWQgYXMgRGF0ZSBidXQgbWFwcGVkIHdp\ndGgKICAgICAqIEBUZW1wb3JhbChUZW1wb3JhbFR5cGUuVElNRVNUQU1QKS4g\nCiAgICAgKiAKICAgICAqIFdoZW4gZXhlY3V0aW5nIEpQUUwsIHRoZSBxdWVy\neSBzdHJpbmcgZGlyZWN0bHkgdXNlcyBhIEpEQkMgRXNjYXBlIFN5bnRheCB0\naGF0IGlzIHBhc3NlZAogICAgICogdG8gSkRCQyBEcml2ZXIgYW5kIGhlbmNl\nIHRoYXQgc3RyaW5nIHNob3VsZCBlbmNvZGUgYSBUaW1lc3RhbXAuCiAgICAg\nKiAKICAgICAqIENyaXRlcmlhIFF1ZXJ5LCBvbiB0aGUgb3RoZXIgaGFuZCwg\nbXVzdCBjb25mb3JtIHRvIHRoZSBBUEkgc2lnbmF0dXJlIGFuZCBoZW5jZSB0\naGUgZXhwcmVzc2lvbgogICAgICogdGhhdCB0YWtlcyB0aGUgSkRCQyBFc2Nh\ncGUgU3ludGF4IG11c3QgYmUgY2FzdCB0byBEYXRlLmNsYXNzIHRvIG1hdGNo\nIHRoZSBkZWNsYXJlZCB0eXBlIG9mCiAgICAgKiBEZXBlbmRlbnQuZW5kRGF0\nZS4KICAgICAqIAogICAgICovCiAgICBwdWJsaWMgdm9pZCB0ZXN0RGF0ZVN0\ncmluZygpIHsKICAgICAgICBjcmVhdGVEYXRhKCJ0ZXN0RGF0ZVN0cmluZyIp\nOwogICAgICAgIGxvbmcgbm93ID0gU3lzdGVtLmN1cnJlbnRUaW1lTWlsbGlz\nKCk7CiAgICAgICAgCiAgICAgICAgU3RyaW5nIGRhdGVTdHJpbmcgPSBjcmVh\ndGVKREJDRXNjYXBlU3RyaW5nKG5ldyBEYXRlKG5vdykpOwogICAgICAgIFN0\ncmluZyB0c1N0cmluZyA9IGNyZWF0ZUpEQkNFc2NhcGVTdHJpbmcobmV3IFRp\nbWVzdGFtcChub3cpKTsKICAgICAgICAKICAgICAgICAvLyBhZGQgVGltZXN0\nYW1wIHN0cmluZyBiZWNhdXNlIERlcGVuZGVudC5lbmREYXRlIGlzIG1hcHBl\nZCB0byBUZW1wb3JhbFR5cGUuVGltZVN0YW1wCiAgICAgICAgU3RyaW5nIGpw\ncWwgPSAic2VsZWN0IGQgZnJvbSBEZXBlbmRlbnQgZCB3aGVyZSBkLmVuZERh\ndGUgPj0gIiArIHRzU3RyaW5nICsgIiBPUkRFUiBCWSBkLmVuZERhdGUiOwog\nICAgICAgIAogICAgICAgIAogICAgICAgIENyaXRlcmlhUXVlcnk8RGVwZW5k\nZW50PiBjID0gY2IuY3JlYXRlUXVlcnkoRGVwZW5kZW50LmNsYXNzKTsKICAg\nICAgICBSb290PERlcGVuZGVudD4gZCA9IGMuZnJvbShEZXBlbmRlbnQuY2xh\nc3MpOwogICAgICAgIC8vIHRoZSBsaXRlcmFsIGlzIGNhc3QgdG8gRGF0ZS5j\nbGFzcyBiZWNhdXNlIERlcGVuZGVudC5lbmREYXRlIGlzIGRlY2xhcmVkIGFz\nIERhdGUKICAgICAgICBjLndoZXJlKGNiLmdyZWF0ZXJUaGFuT3JFcXVhbFRv\nKGQuZ2V0KERlcGVuZGVudF8uZW5kRGF0ZSksIGNiLmxpdGVyYWwoZGF0ZVN0\ncmluZykuYXMoRGF0ZS5jbGFzcykpKTsKICAgICAgICBjLm9yZGVyQnkoY2Iu\nYXNjKGQuZ2V0KERlcGVuZGVudF8uZW5kRGF0ZSkpKTsKICAgICAgICAKICAg\nICAgICAvLyBjYW4gbm90IGNvbXBhcmUgU1FMIGJlY2F1c2UgSlBRTCBhbmQg\nQ3JpdGVyaWEgaGFuZGxlcyBKREJDIGVzY2FwZSBzeW50YXggaW4gCiAgICAg\nICAgLy8gYSBkaWZmZXJlbnQgd2F5LgogICAgICAgIGFzc2VydFNhbWVSZXN1\nbHQoYywganBxbCk7CiAgICB9CiAgICAKICAgIC8qKgogICAgICogQSBzaW1p\nbGFyIHF1ZXJ5IGJ1dCB0aGUgSkRCQyBFc2NhcGUgU3RyaW5nIGlzIHBhc3Nl\nZCBhcyBhbiBwYXJhbWV0ZXIuCiAgICAgKiBQYXJhbWV0ZXIgdmFsdWUgYmlu\nZGluZyBpcyByZWxheGVkIHRvIGFjY2VwdCB0aGUgc3RyaW5nIGFzIGEgdmFs\ndWUKICAgICAqIG9mIHRlbXBvcmFsIHR5cGUgaW5zdGFuY2UuCiAgICAgKiBI\nZW5jZSBkb2VzIG5vdCByZXF1aXJlLCBhcyBpbiB0aGUgdGhlIGVhcmxpZXIg\nY2FzZSwgdG8gdXNlIGRpZmZlcmVudCAKICAgICAqIGVzY2FwZSBzdHJpbmcu\nIAogICAgICovCiAgICBwdWJsaWMgdm9pZCB0ZXN0RGF0ZVN0cmluZ0FzUGFy\nYW1ldGVyKCkgewogICAgICAgIGNyZWF0ZURhdGEoInRlc3REYXRlU3RyaW5n\nQXNQYXJhbWV0ZXIiKTsKICAgICAgICBsb25nIG5vdyA9IFN5c3RlbS5jdXJy\nZW50VGltZU1pbGxpcygpOwogICAgICAgIAogICAgICAgIERhdGUgZWFybGll\nciA9IG5ldyBEYXRlKG5vdyAtIDEwMDApOwogICAgICAgIAogICAgICAgIGZp\nbmFsIFN0cmluZyBkYXRlU3RyaW5nID0gY3JlYXRlSkRCQ0VzY2FwZVN0cmlu\nZyhlYXJsaWVyKTsKICAgICAgICBTdHJpbmcganBxbCA9ICJzZWxlY3QgZCBm\ncm9tIERlcGVuZGVudCBkIHdoZXJlIGQuZW5kRGF0ZSA+PSA6ZGF0ZVN0cmlu\nZyBPUkRFUiBCWSBkLmVuZERhdGUiOwogICAgICAgIENyaXRlcmlhUXVlcnk8\nRGVwZW5kZW50PiBjID0gY2IuY3JlYXRlUXVlcnkoRGVwZW5kZW50LmNsYXNz\nKTsKICAgICAgICBSb290PERlcGVuZGVudD4gZCA9IGMuZnJvbShEZXBlbmRl\nbnQuY2xhc3MpOwogICAgICAgIAogICAgICAgIGMud2hlcmUoY2IuZ3JlYXRl\nclRoYW5PckVxdWFsVG8oZC5nZXQoRGVwZW5kZW50Xy5lbmREYXRlKSwgY2Iu\ncGFyYW1ldGVyKFN0cmluZy5jbGFzcywgImRhdGVTdHJpbmciKQogICAgICAg\nICAgICAgICAgLmFzKERhdGUuY2xhc3MpKSk7CiAgICAgICAgYy5vcmRlckJ5\nKGNiLmFzYyhkLmdldChEZXBlbmRlbnRfLmVuZERhdGUpKSk7CiAgICAgICAg\nCiAgICAgICAgYXNzZXJ0RXF1aXZhbGVuY2UobmV3IFF1ZXJ5RGVjb3JhdG9y\nKCkgewogICAgICAgICAgICBwdWJsaWMgdm9pZCBkZWNvcmF0ZShRdWVyeSBx\nKSB7CiAgICAgICAgICAgICAgICBxLnNldFBhcmFtZXRlcigiZGF0ZVN0cmlu\nZyIsIGRhdGVTdHJpbmcpOwogICAgICAgICAgICB9CiAgICAgICAgfSwgYywg\nanBxbCk7CgogICAgfQogICAgCiAgICBTdHJpbmcgY3JlYXRlSkRCQ0VzY2Fw\nZVN0cmluZyhPYmplY3QgdGltZSkgewogICAgICAgIFN0cmluZyBrZXkgPSAi\nIjsKICAgICAgICBpZiAodGltZSBpbnN0YW5jZW9mIERhdGUpCiAgICAgICAg\nICAgIGtleSA9ICJkICI7CiAgICAgICAgZWxzZSBpZiAodGltZSBpbnN0YW5j\nZW9mIFRpbWUpCiAgICAgICAgICAgIGtleSA9ICJ0ICI7CiAgICAgICAgZWxz\nZSBpZiAodGltZSBpbnN0YW5jZW9mIFRpbWVzdGFtcCkKICAgICAgICAgICAg\na2V5ID0gInRzICI7CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIGZhaWwo\nIldyb25nIG9iamVjdCAiICsgdGltZSArICIgb2YgIiArIHRpbWUuZ2V0Q2xh\nc3MoKSArICIgZm9yIEpEQkMgY29udmVyc2lvbiIpOwogICAgICAgIH0KICAg\nICAgICByZXR1cm4gT1BFTl9CUkFDS0VUICsga2V5ICsgU0lOR0xFX1FVT1RF\nICsgdGltZS50b1N0cmluZygpICsgU0lOR0xFX1FVT1RFICsgQ0xPU0VfQlJB\nQ0tFVDsKICAgIH0KICAgIAogICAgcHVibGljIHZvaWQgdGVzdEpEQkNFc2Nh\ncGVTeW50YXhUaW1lc3RhbXAoKSB7CiAgICAgICAgVGltZXN0YW1wIHRzID0g\nbmV3IFRpbWVzdGFtcChTeXN0ZW0uY3VycmVudFRpbWVNaWxsaXMoKSk7CiAg\nICAgICAgU3RyaW5nIHMgPSAie3RzICciICsgdHMudG9TdHJpbmcoKSArICIn\nfSI7CiAgICAgICAgYXNzZXJ0VHJ1ZShGaWx0ZXJzLmlzSkRCQ1RlbXBvcmFs\nU3ludGF4KHMpKTsKICAgICAgICBhc3NlcnROb3ROdWxsKEZpbHRlcnMucGFy\nc2VKREJDVGVtcG9yYWxTeW50YXgocykpOwogICAgICAgIE9iamVjdCBjb252\nZXJ0ZWQgPSBGaWx0ZXJzLmNvbnZlcnQocywgVGltZXN0YW1wLmNsYXNzKTsK\nICAgICAgICBhc3NlcnRUcnVlKGNvbnZlcnRlZCBpbnN0YW5jZW9mIFRpbWVz\ndGFtcCk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKCJPcmlnaW5hbD0iICsgcyAr\nICIgQ29udmVydGVkICIgKyBjb252ZXJ0ZWQsIHRzLnRvU3RyaW5nKCksIGNv\nbnZlcnRlZC50b1N0cmluZygpKTsKICAgIH0KICAgIAogICAgcHVibGljIHZv\naWQgdGVzdEpEQkNFc2NhcGVTeW50YXhUaW1lKCkgewogICAgICAgIFRpbWUg\ndCA9IG5ldyBUaW1lKFN5c3RlbS5jdXJyZW50VGltZU1pbGxpcygpKTsKICAg\nICAgICBTdHJpbmcgcyA9ICJ7dCAnIiArIHQudG9TdHJpbmcoKSArICInfSI7\nCiAgICAgICAgYXNzZXJ0VHJ1ZShGaWx0ZXJzLmlzSkRCQ1RlbXBvcmFsU3lu\ndGF4KHMpKTsKICAgICAgICBhc3NlcnROb3ROdWxsKEZpbHRlcnMucGFyc2VK\nREJDVGVtcG9yYWxTeW50YXgocykpOwogICAgICAgIE9iamVjdCBjb252ZXJ0\nZWQgPSBGaWx0ZXJzLmNvbnZlcnQocywgVGltZS5jbGFzcyk7CiAgICAgICAg\nYXNzZXJ0VHJ1ZShjb252ZXJ0ZWQgaW5zdGFuY2VvZiBUaW1lKTsKICAgICAg\nICBhc3NlcnRFcXVhbHMoIk9yaWdpbmFsPSIgKyBzICsgIiBDb252ZXJ0ZWQg\nIiArIGNvbnZlcnRlZCwgdC50b1N0cmluZygpLCBjb252ZXJ0ZWQudG9TdHJp\nbmcoKSk7CiAgICB9CiAgICAKICAgIHB1YmxpYyB2b2lkIHRlc3RKREJDRXNj\nYXBlU3ludGF4RGF0ZSgpIHsKICAgICAgICBEYXRlIGQgPSBuZXcgRGF0ZShT\neXN0ZW0uY3VycmVudFRpbWVNaWxsaXMoKSk7CiAgICAgICAgU3RyaW5nIHMg\nPSAie2QgJyIgKyBkLnRvU3RyaW5nKCkgKyAiJ30iOwogICAgICAgIGFzc2Vy\ndFRydWUoRmlsdGVycy5pc0pEQkNUZW1wb3JhbFN5bnRheChzKSk7CiAgICAg\nICAgYXNzZXJ0Tm90TnVsbChGaWx0ZXJzLnBhcnNlSkRCQ1RlbXBvcmFsU3lu\ndGF4KHMpKTsKICAgICAgICBPYmplY3QgY29udmVydGVkID0gRmlsdGVycy5j\nb252ZXJ0KHMsIERhdGUuY2xhc3MpOwogICAgICAgIGFzc2VydFRydWUoY29u\ndmVydGVkIGluc3RhbmNlb2YgRGF0ZSk7CiAgICAgICAgYXNzZXJ0RXF1YWxz\nKCJPcmlnaW5hbD0iICsgcyArICIgQ29udmVydGVkICIgKyBjb252ZXJ0ZWQs\nIGQudG9TdHJpbmcoKSwgY29udmVydGVkLnRvU3RyaW5nKCkpOwogICAgfQog\nICAgCiAgICB2b2lkIGFzc2VydFNhbWVSZXN1bHQoQ3JpdGVyaWFRdWVyeTxE\nZXBlbmRlbnQ+IGMsIFN0cmluZyBqcHFsKSB7CiAgICAgICAgTGlzdDxEZXBl\nbmRlbnQ+IGpSZXN1bHQgPSBlbS5jcmVhdGVRdWVyeShqcHFsKS5nZXRSZXN1\nbHRMaXN0KCk7CiAgICAgICAgTGlzdDxEZXBlbmRlbnQ+IGNSZXN1bHQgPSBl\nbS5jcmVhdGVRdWVyeShjKS5nZXRSZXN1bHRMaXN0KCk7CiAgICAgICAgYXNz\nZXJ0RmFsc2UoalJlc3VsdC5pc0VtcHR5KCkpOwogICAgICAgIGFzc2VydEVx\ndWFscyhjUmVzdWx0LnNpemUoKSwgalJlc3VsdC5zaXplKCkpOwogICAgICAg\nIGZvciAoaW50IGkgPSAwOyBpIDwgalJlc3VsdC5zaXplKCk7IGkrKykgewog\nICAgICAgICAgICBhc3NlcnRFcXVhbHMoalJlc3VsdC5nZXQoaSkuZ2V0RW5k\nRGF0ZSgpLCBjUmVzdWx0LmdldChpKS5nZXRFbmREYXRlKCkpOwogICAgICAg\nIH0KICAgIH0KfQo=\n","encoding":"base64"}

