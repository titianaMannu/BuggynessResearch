{"sha":"fec48153e2d7ba12acd56b703f7c29cf99beb825","node_id":"MDQ6QmxvYjIwNjM2NDpmZWM0ODE1M2UyZDdiYTEyYWNkNTZiNzAzZjdjMjljZjk5YmViODI1","size":22535,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/fec48153e2d7ba12acd56b703f7c29cf99beb825","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNr\nYWdlIG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5lbWJlZDsKCmlt\ncG9ydCBqYXZhLnV0aWwuSGFzaE1hcDsKaW1wb3J0IGphdmEudXRpbC5MaXN0\nOwppbXBvcnQgamF2YS51dGlsLk1hcDsKaW1wb3J0IGphdmEudXRpbC5TZXQ7\nCgppbXBvcnQgamF2YXgucGVyc2lzdGVuY2UuRW50aXR5TWFuYWdlcjsKaW1w\nb3J0IGphdmF4LnBlcnNpc3RlbmNlLkVudGl0eVRyYW5zYWN0aW9uOwppbXBv\ncnQgamF2YXgucGVyc2lzdGVuY2UuUXVlcnk7CgppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLnBlcnNpc3RlbmNlLnRlc3QuQWxsb3dGYWlsdXJlOwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNlLnRlc3QuU2luZ2xl\nRU1GVGVzdENhc2U7CgpAQWxsb3dGYWlsdXJlKG1lc3NhZ2U9CgkiTXVsdGkt\nbGV2ZWwgZW1iZWRkaW5nIiArIAoJIkpQQSAyLjAgQWNjZXNzIFN0eWxlICIg\nKyAKICAgICJYTUwgTWV0YWRhdGEgIiAgICAgICAgICsgCiAgICAiQXR0cmli\ndXRlIE92ZXJyaWRlICIgICArICAKICAgICIgaXMgbm90IHlldCBzdXBwb3J0\nZWQiKQpwdWJsaWMgY2xhc3MgVGVzdEVtYmVkZGFibGVYbWwgZXh0ZW5kcyBT\naW5nbGVFTUZUZXN0Q2FzZSB7CiAgIAogICAgcHVibGljIGludCBudW1FbWJl\nZGRhYmxlcyA9IDE7CiAgICBwdWJsaWMgaW50IG51bUJhc2ljVHlwZXMgPSAx\nMDsKICAgIHB1YmxpYyBpbnQgSUQgPSAxOwogICAgcHVibGljIGludCBkZXB0\nSWQgPSAxOwogICAgcHVibGljIGludCBlbXBJZCA9IDE7CiAgICBwdWJsaWMg\naW50IGNvbXBJZCA9IDE7CiAgICBwdWJsaWMgaW50IGRpdklkID0gMTsKICAg\nIHB1YmxpYyBpbnQgdnBJZCA9IDE7CiAgICBwdWJsaWMgaW50IG5ld0Rpdklk\nID0gMTAwOwogICAgcHVibGljIGludCBuZXdWcElkID0gMTAwOwogICAgcHVi\nbGljIGludCBudW1JdGVtcyA9IDI7CiAgICBwdWJsaWMgaW50IGl0ZW1JZCA9\nIDE7CiAgICBwdWJsaWMgaW50IGNJZCA9IDE7CiAgICBwdWJsaWMgaW50IG9J\nZCA9IDE7CgogICAgcHVibGljIGludCBudW1JbWFnZXNQZXJJdGVtID0gMzsK\nICAgIHB1YmxpYyBpbnQgbnVtRGVwYXJ0bWVudHMgPSAyOwogICAgcHVibGlj\nIGludCBudW1FbXBsb3llZXNQZXJEZXB0ID0gMjsKICAgIHB1YmxpYyBpbnQg\nbnVtQ29tcGFueSA9IDI7CiAgICBwdWJsaWMgaW50IG51bURpdmlzaW9uc1Bl\nckNvID0gMjsKICAgIHB1YmxpYyBpbnQgbnVtQ3VzdG9tZXJzID0gMTsKICAg\nIHB1YmxpYyBpbnQgbnVtT3JkZXJzUGVyQ3VzdG9tZXIgPSAyOwogICAgCiAg\nICBwdWJsaWMgdm9pZCBzZXRVcCgpIHsKICAgICAgICBzZXRVcChDTEVBUl9U\nQUJMRVMpOwogICAgfQogICAgCiAgICBAT3ZlcnJpZGUKICAgIHByb3RlY3Rl\nZCBTdHJpbmcgZ2V0UGVyc2lzdGVuY2VVbml0TmFtZSgpIHsKICAgICAgICBy\nZXR1cm4gImVtYmVkLXB1IjsKICAgIH0KICAgIAogICAgcHVibGljIHZvaWQg\ndGVzdEVudGl0eUFfQ29sbF9TdHJpbmdYbWwoKSB7CiAgICAgICAgY3JlYXRl\nRW50aXR5QV9Db2xsX1N0cmluZ1htbCgpOwogICAgICAgIHF1ZXJ5RW50aXR5\nQV9Db2xsX1N0cmluZ1htbCgpOwogICAgICAgIGZpbmRFbnRpdHlBX0NvbGxf\nU3RyaW5nWG1sKCk7CiAgICB9CgogICAgcHVibGljIHZvaWQgdGVzdEVudGl0\neUFfQ29sbF9FbWJlZF9FbWJlZCgpIHsKICAgICAgICBjcmVhdGVFbnRpdHlB\nX0NvbGxfRW1iZWRfRW1iZWRYbWwoKTsKICAgICAgICBxdWVyeUVudGl0eUFf\nQ29sbF9FbWJlZF9FbWJlZFhtbCgpOwogICAgICAgIGZpbmRFbnRpdHlBX0Nv\nbGxfRW1iZWRfRW1iZWRYbWwoKTsKICAgIH0KCiAgICAvKgogICAgICogQ3Jl\nYXRlIEVudGl0eUFfQ29sbF9TdHJpbmdYbWwKICAgICAqLwogICAgcHVibGlj\nIHZvaWQgY3JlYXRlRW50aXR5QV9Db2xsX1N0cmluZ1htbCgpIHsKICAgICAg\nICBFbnRpdHlNYW5hZ2VyIGVtID0gZW1mLmNyZWF0ZUVudGl0eU1hbmFnZXIo\nKTsKICAgICAgICBFbnRpdHlUcmFuc2FjdGlvbiB0cmFuID0gZW0uZ2V0VHJh\nbnNhY3Rpb24oKTsKICAgICAgICBjcmVhdGVFbnRpdHlBX0NvbGxfU3RyaW5n\nWG1sKGVtLCBJRCk7CiAgICAgICAgdHJhbi5iZWdpbigpOwogICAgICAgIGVt\nLmZsdXNoKCk7CiAgICAgICAgdHJhbi5jb21taXQoKTsKICAgICAgICBlbS5j\nbG9zZSgpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIGNyZWF0ZUVudGl0eUFf\nQ29sbF9TdHJpbmdYbWwoRW50aXR5TWFuYWdlciBlbSwgaW50IGlkKSB7CiAg\nICAgICAgRW50aXR5QV9Db2xsX1N0cmluZ1htbCBhID0gbmV3IEVudGl0eUFf\nQ29sbF9TdHJpbmdYbWwoKTsKICAgICAgICBhLnNldElkKGlkKTsKICAgICAg\nICBhLnNldE5hbWUoImEiICsgaWQpOwogICAgICAgIGEuc2V0QWdlKGlkKTsK\nICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IG51bUJhc2ljVHlwZXM7IGkr\nKykKICAgICAgICAgICAgYS5hZGROaWNrTmFtZSgibmlja05hbWVfIiArIGlk\nICsgaSk7CiAgICAgICAgZW0ucGVyc2lzdChhKTsKICAgIH0KCiAgICAvKgog\nICAgICogQ3JlYXRlIEVudGl0eUFfQ29sbF9FbWJlZF9FbWJlZFhtbAogICAg\nICovCiAgICBwdWJsaWMgdm9pZCBjcmVhdGVFbnRpdHlBX0NvbGxfRW1iZWRf\nRW1iZWRYbWwoKSB7CiAgICAgICAgRW50aXR5TWFuYWdlciBlbSA9IGVtZi5j\ncmVhdGVFbnRpdHlNYW5hZ2VyKCk7CiAgICAgICAgRW50aXR5VHJhbnNhY3Rp\nb24gdHJhbiA9IGVtLmdldFRyYW5zYWN0aW9uKCk7CiAgICAgICAgY3JlYXRl\nRW50aXR5QV9Db2xsX0VtYmVkX0VtYmVkWG1sKGVtLCBJRCk7CiAgICAgICAg\ndHJhbi5iZWdpbigpOwogICAgICAgIGVtLmZsdXNoKCk7CiAgICAgICAgdHJh\nbi5jb21taXQoKTsKICAgICAgICBlbS5jbG9zZSgpOwogICAgfQoKICAgIHB1\nYmxpYyB2b2lkIGNyZWF0ZUVudGl0eUFfQ29sbF9FbWJlZF9FbWJlZFhtbChF\nbnRpdHlNYW5hZ2VyIGVtLCBpbnQgaWQpIHsKICAgICAgICBFbnRpdHlBX0Nv\nbGxfRW1iZWRfRW1iZWRYbWwgYSA9IG5ldyBFbnRpdHlBX0NvbGxfRW1iZWRf\nRW1iZWRYbWwoKTsKICAgICAgICBhLnNldElkKGlkKTsKICAgICAgICBhLnNl\ndE5hbWUoImEiICsgaWQpOwogICAgICAgIGEuc2V0QWdlKGlkKTsKICAgICAg\nICBmb3IgKGludCBpID0gMDsgaSA8IG51bUVtYmVkZGFibGVzOyBpKyspIHsK\nICAgICAgICAgICAgRW1iZWRfRW1iZWRYbWwgZW1iZWQgPSBjcmVhdGVFbWJl\nZF9FbWJlZFhtbChlbSwgaWQsIGkpOwogICAgICAgICAgICBhLmFkZEVtYmVk\nKGVtYmVkKTsKICAgICAgICB9CiAgICAgICAgZW0ucGVyc2lzdChhKTsKICAg\nIH0KCiAgICBwdWJsaWMgRW1iZWRfRW1iZWRYbWwgY3JlYXRlRW1iZWRfRW1i\nZWRYbWwoRW50aXR5TWFuYWdlciBlbSwgaW50IGlkLAogICAgICAgICAgICBp\nbnQgaWR4KSB7CiAgICAgICAgRW1iZWRfRW1iZWRYbWwgZW1iZWQgPSBuZXcg\nRW1iZWRfRW1iZWRYbWwoKTsKICAgICAgICBlbWJlZC5zZXRJbnRWYWwxKGlk\nICogMTAwICsgaWR4ICogMTAgKyAxKTsKICAgICAgICBlbWJlZC5zZXRJbnRW\nYWwyKGlkICogMTAwICsgaWR4ICogMTAgKyAyKTsKICAgICAgICBlbWJlZC5z\nZXRJbnRWYWwzKGlkICogMTAwICsgaWR4ICogMTAgKyAzKTsKICAgICAgICBF\nbWJlZFhtbCBlbWJlZDEgPSBjcmVhdGVFbWJlZFhtbChpZCwgaWR4KTsKICAg\nICAgICBlbWJlZC5zZXRFbWJlZChlbWJlZDEpOwogICAgICAgIHJldHVybiBl\nbWJlZDsKICAgIH0KCiAgICBwdWJsaWMgRW1iZWRYbWwgY3JlYXRlRW1iZWRY\nbWwoaW50IGlkLCBpbnQgaWR4KSB7CiAgICAgICAgRW1iZWRYbWwgZW1iZWQg\nPSBuZXcgRW1iZWRYbWwoKTsKICAgICAgICBlbWJlZC5zZXRJbnRWYWwxKGlk\nICogMTAwICsgaWR4ICogMTAgKyA0KTsKICAgICAgICBlbWJlZC5zZXRJbnRW\nYWwyKGlkICogMTAwICsgaWR4ICogMTAgKyA1KTsKICAgICAgICBlbWJlZC5z\nZXRJbnRWYWwzKGlkICogMTAwICsgaWR4ICogMTAgKyA2KTsKICAgICAgICBy\nZXR1cm4gZW1iZWQ7CiAgICB9CgogICAgLyoKICAgICAqIEZpbmQgRW50aXR5\nQV9Db2xsX1N0cmluZ1htbAogICAgICovCiAgICBwdWJsaWMgdm9pZCBmaW5k\nRW50aXR5QV9Db2xsX1N0cmluZ1htbCgpIHsKICAgICAgICBFbnRpdHlNYW5h\nZ2VyIGVtID0gZW1mLmNyZWF0ZUVudGl0eU1hbmFnZXIoKTsKICAgICAgICBF\nbnRpdHlBX0NvbGxfU3RyaW5nWG1sIGEgPSBlbS5maW5kKEVudGl0eUFfQ29s\nbF9TdHJpbmdYbWwuY2xhc3MsIElEKTsKICAgICAgICBjaGVja0VudGl0eUFf\nQ29sbF9TdHJpbmdYbWwoYSk7CiAgICAgICAgCiAgICAgICAgUXVlcnkgcSA9\nIGVtLmNyZWF0ZU5hdGl2ZVF1ZXJ5KCJzZWxlY3QgY291bnQoKikgZnJvbSBF\nbnRpdHlBX0NvbGxfU3RyaW5nWG1sX25pY2tOYW1lcyIpOwogICAgICAgIE9i\namVjdCBvYmogPSBxLmdldFNpbmdsZVJlc3VsdCgpOwogICAgICAgIC8vIGVu\nc3VyZSB0aGF0IG11bHRpcGxlIHJvd3MgYXJlIGluc2VydGVkIGludG8gdGhl\nIHRhYmxlICh0aGUgY29sdW1uIGlzIG5vdCBzZXJpYWxpemVkKQogICAgICAg\nIGFzc2VydEVxdWFscyhudW1CYXNpY1R5cGVzLCBvYmopOyAgICAgICAgICAK\nICAgICAgICAKICAgICAgICAKICAgICAgICAKICAgICAgICBlbS5jbG9zZSgp\nOwogICAgfQoKICAgIC8qCiAgICAgKiBGaW5kIEVudGl0eUFfQ29sbF9FbWJl\nZF9FbWJlZFhtbAogICAgICovCiAgICBwdWJsaWMgdm9pZCBmaW5kRW50aXR5\nQV9Db2xsX0VtYmVkX0VtYmVkWG1sKCkgewogICAgICAgIEVudGl0eU1hbmFn\nZXIgZW0gPSBlbWYuY3JlYXRlRW50aXR5TWFuYWdlcigpOwogICAgICAgIEVu\ndGl0eUFfQ29sbF9FbWJlZF9FbWJlZFhtbCBhID0KICAgICAgICAgICAgZW0u\nZmluZChFbnRpdHlBX0NvbGxfRW1iZWRfRW1iZWRYbWwuY2xhc3MsIElEKTsK\nICAgICAgICBjaGVja0VudGl0eUFfQ29sbF9FbWJlZF9FbWJlZFhtbChhKTsK\nICAgICAgICBlbS5jbG9zZSgpOwogICAgfQoKICAgIC8qCiAgICAgKiBjaGVj\nayBFbnRpdHlBX0NvbGxfU3RyaW5nCiAgICAgKi8KICAgIHB1YmxpYyB2b2lk\nIGNoZWNrRW50aXR5QV9Db2xsX1N0cmluZ1htbChFbnRpdHlBX0NvbGxfU3Ry\naW5nWG1sIGEpIHsKICAgICAgICBpbnQgaWQgPSBhLmdldElkKCk7CiAgICAg\nICAgU3RyaW5nIG5hbWUgPSBhLmdldE5hbWUoKTsKICAgICAgICBpbnQgYWdl\nID0gYS5nZXRBZ2UoKTsKICAgICAgICBhc3NlcnRFcXVhbHMoMSwgaWQpOwog\nICAgICAgIGFzc2VydEVxdWFscygiYSIgKyBpZCAsbmFtZSk7CiAgICAgICAg\nYXNzZXJ0RXF1YWxzKDEsIGFnZSk7CiAgICAgICAgU2V0PFN0cmluZz4gbmlj\na05hbWVzID0gYS5nZXROaWNrTmFtZXMoKTsKICAgICAgICBmb3IgKFN0cmlu\nZyBuaWNrTmFtZSA6IG5pY2tOYW1lcykKICAgICAgICAgICAgYXNzZXJ0RXF1\nYWxzKCJuaWNrTmFtZV8iICsgaWQgKyAiMCIsIG5pY2tOYW1lKTsKICAgIH0K\nCiAgICAvKgogICAgICogY2hlY2sgRW50aXR5QV9Db2xsX0VtYmVkX0VtYmVk\nWG1sCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIGNoZWNrRW50aXR5QV9Db2xs\nX0VtYmVkX0VtYmVkWG1sKAogICAgICAgICAgICBFbnRpdHlBX0NvbGxfRW1i\nZWRfRW1iZWRYbWwgYSkgewogICAgICAgIGludCBpZCA9IGEuZ2V0SWQoKTsK\nICAgICAgICBTdHJpbmcgbmFtZSA9IGEuZ2V0TmFtZSgpOwogICAgICAgIGlu\ndCBhZ2UgPSBhLmdldEFnZSgpOwogICAgICAgIGFzc2VydEVxdWFscygxLCBp\nZCk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKCJhIiArIGlkICxuYW1lKTsKICAg\nICAgICBhc3NlcnRFcXVhbHMoMSwgYWdlKTsKICAgICAgICBMaXN0PEVtYmVk\nX0VtYmVkWG1sPiBlbWJlZHMgPSBhLmdldEVtYmVkcygpOwogICAgICAgIGZv\nciAoRW1iZWRfRW1iZWRYbWwgZW1iZWQgOiBlbWJlZHMpCiAgICAgICAgICAg\nIGNoZWNrRW1iZWRfRW1iZWRYbWwoZW1iZWQpOwogICAgfQoKICAgIHB1Ymxp\nYyB2b2lkIGNoZWNrRW1iZWRfRW1iZWRYbWwoRW1iZWRfRW1iZWRYbWwgZW1i\nZWQpIHsKICAgICAgICBpbnQgaW50VmFsMSA9IGVtYmVkLmdldEludFZhbDEo\nKTsKICAgICAgICBpbnQgaW50VmFsMiA9IGVtYmVkLmdldEludFZhbDIoKTsK\nICAgICAgICBpbnQgaW50VmFsMyA9IGVtYmVkLmdldEludFZhbDMoKTsKICAg\nICAgICBhc3NlcnRFcXVhbHMoMTAxLCBpbnRWYWwxKTsKICAgICAgICBhc3Nl\ncnRFcXVhbHMoMTAyLCBpbnRWYWwyKTsKICAgICAgICBhc3NlcnRFcXVhbHMo\nMTAzLCBpbnRWYWwzKTsKICAgICAgICBFbWJlZFhtbCBlbWJlZDEgPSBlbWJl\nZC5nZXRFbWJlZCgpOwogICAgICAgIGNoZWNrRW1iZWRYbWwoZW1iZWQxKTsK\nICAgIH0KCiAgICBwdWJsaWMgdm9pZCBjaGVja0VtYmVkWG1sKEVtYmVkWG1s\nIGVtYmVkKSB7CiAgICAgICAgaW50IGludFZhbDEgPSBlbWJlZC5nZXRJbnRW\nYWwxKCk7CiAgICAgICAgaW50IGludFZhbDIgPSBlbWJlZC5nZXRJbnRWYWwy\nKCk7CiAgICAgICAgaW50IGludFZhbDMgPSBlbWJlZC5nZXRJbnRWYWwzKCk7\nCiAgICAgICAgYXNzZXJ0RXF1YWxzKDEwNCwgaW50VmFsMSk7CiAgICAgICAg\nYXNzZXJ0RXF1YWxzKDEwNSwgaW50VmFsMik7CiAgICAgICAgYXNzZXJ0RXF1\nYWxzKDEwNiwgaW50VmFsMyk7CiAgICB9CgogICAgLyoKICAgICAqIFF1ZXJ5\nIEVudGl0eUFfQ29sbF9TdHJpbmdYbWwKICAgICAqLwogICAgcHVibGljIHZv\naWQgcXVlcnlFbnRpdHlBX0NvbGxfU3RyaW5nWG1sKCkgewogICAgICAgIEVu\ndGl0eU1hbmFnZXIgZW0gPSBlbWYuY3JlYXRlRW50aXR5TWFuYWdlcigpOwog\nICAgICAgIEVudGl0eVRyYW5zYWN0aW9uIHRyYW4gPSBlbS5nZXRUcmFuc2Fj\ndGlvbigpOwogICAgICAgIHRyYW4uYmVnaW4oKTsKICAgICAgICBRdWVyeSBx\nID0gZW0uY3JlYXRlUXVlcnkoInNlbGVjdCBhIGZyb20gRW50aXR5QV9Db2xs\nX1N0cmluZ1htbCBhIik7CiAgICAgICAgTGlzdDxFbnRpdHlBX0NvbGxfU3Ry\naW5nWG1sPiBhcyA9IHEuZ2V0UmVzdWx0TGlzdCgpOwogICAgICAgIGZvciAo\nRW50aXR5QV9Db2xsX1N0cmluZ1htbCBhIDogYXMpIHsKICAgICAgICAgICAg\nY2hlY2tFbnRpdHlBX0NvbGxfU3RyaW5nWG1sKGEpOwogICAgICAgIH0KICAg\nICAgICB0cmFuLmNvbW1pdCgpOwogICAgICAgIGVtLmNsb3NlKCk7CiAgICB9\nCgogICAgLyoKICAgICAqIFF1ZXJ5IEVudGl0eUFfQ29sbF9FbWJlZF9FbWJl\nZAogICAgICovCiAgICBwdWJsaWMgdm9pZCBxdWVyeUVudGl0eUFfQ29sbF9F\nbWJlZF9FbWJlZFhtbCgpIHsKICAgICAgICBFbnRpdHlNYW5hZ2VyIGVtID0g\nZW1mLmNyZWF0ZUVudGl0eU1hbmFnZXIoKTsKICAgICAgICBFbnRpdHlUcmFu\nc2FjdGlvbiB0cmFuID0gZW0uZ2V0VHJhbnNhY3Rpb24oKTsKICAgICAgICB0\ncmFuLmJlZ2luKCk7CiAgICAgICAgUXVlcnkgcSA9IGVtLmNyZWF0ZVF1ZXJ5\nKCJzZWxlY3QgYSBmcm9tIEVudGl0eUFfQ29sbF9FbWJlZF9FbWJlZFhtbCBh\nIik7CiAgICAgICAgTGlzdDxFbnRpdHlBX0NvbGxfRW1iZWRfRW1iZWRYbWw+\nIGFzID0gcS5nZXRSZXN1bHRMaXN0KCk7CiAgICAgICAgZm9yIChFbnRpdHlB\nX0NvbGxfRW1iZWRfRW1iZWRYbWwgYSA6IGFzKSB7CiAgICAgICAgICAgIGNo\nZWNrRW50aXR5QV9Db2xsX0VtYmVkX0VtYmVkWG1sKGEpOwogICAgICAgIH0K\nICAgICAgICB0cmFuLmNvbW1pdCgpOwogICAgICAgIGVtLmNsb3NlKCk7CiAg\nICB9CgogICAgIAogICAgcHVibGljIHZvaWQgdGVzdE1hcEtleUFubm90YXRp\nb25zKCl7CiAgICAgICAgY3JlYXRlT2JqKCk7CiAgICAgICAgcXVlcnlPYmoo\nKTsKICAgICAgICBmaW5kT2JqKCk7CiAgICB9CgogICAgcHVibGljIHZvaWQg\nY3JlYXRlT2JqKCkgewogICAgICAgIGNyZWF0ZURlcGFydG1lbnRzKCk7CiAg\nICAgICAgY3JlYXRlQ29tcGFuaWVzKCk7CiAgICAgICAgY3JlYXRlSXRlbXMo\nKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBmaW5kT2JqKCkgewogICAgICAg\nIGZpbmREZXBhcnRtZW50KCk7CiAgICAgICAgZmluZENvbXBhbnkoKTsKICAg\nICAgICBmaW5kSXRlbSgpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIGNyZWF0\nZURlcGFydG1lbnRzKCkgewogICAgICAgIEVudGl0eU1hbmFnZXIgZW0gPSBl\nbWYuY3JlYXRlRW50aXR5TWFuYWdlcigpOwogICAgICAgIEVudGl0eVRyYW5z\nYWN0aW9uIHRyYW4gPSBlbS5nZXRUcmFuc2FjdGlvbigpOwogICAgICAgIGZv\nciAoaW50IGkgPSAwOyBpIDwgbnVtRGVwYXJ0bWVudHM7IGkrKykKICAgICAg\nICAgICAgY3JlYXRlRGVwYXJ0bWVudChlbSwgZGVwdElkKyspOwogICAgICAg\nIHRyYW4uYmVnaW4oKTsKICAgICAgICBlbS5mbHVzaCgpOwogICAgICAgIHRy\nYW4uY29tbWl0KCk7CiAgICAgICAgZW0uY2xvc2UoKTsKICAgIH0KCiAgICBw\ndWJsaWMgdm9pZCBjcmVhdGVDb21wYW5pZXMoKSB7CiAgICAgICAgRW50aXR5\nTWFuYWdlciBlbSA9IGVtZi5jcmVhdGVFbnRpdHlNYW5hZ2VyKCk7CiAgICAg\nICAgRW50aXR5VHJhbnNhY3Rpb24gdHJhbiA9IGVtLmdldFRyYW5zYWN0aW9u\nKCk7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBudW1Db21wYW55OyBp\nKyspCiAgICAgICAgICAgIGNyZWF0ZUNvbXBhbnkoZW0sIGNvbXBJZCsrKTsK\nICAgICAgICB0cmFuLmJlZ2luKCk7CiAgICAgICAgZW0uZmx1c2goKTsKICAg\nICAgICB0cmFuLmNvbW1pdCgpOwogICAgICAgIGVtLmNsb3NlKCk7CiAgICB9\nCgogICAgcHVibGljIHZvaWQgY3JlYXRlSXRlbXMoKSB7CiAgICAgICAgRW50\naXR5TWFuYWdlciBlbSA9IGVtZi5jcmVhdGVFbnRpdHlNYW5hZ2VyKCk7CiAg\nICAgICAgRW50aXR5VHJhbnNhY3Rpb24gdHJhbiA9IGVtLmdldFRyYW5zYWN0\naW9uKCk7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBudW1JdGVtczsg\naSsrKQogICAgICAgICAgICBjcmVhdGVJdGVtKGVtLCBpdGVtSWQrKyk7CiAg\nICAgICAgdHJhbi5iZWdpbigpOwogICAgICAgIGVtLmZsdXNoKCk7CiAgICAg\nICAgdHJhbi5jb21taXQoKTsKICAgICAgICBlbS5jbG9zZSgpOwogICAgfQoK\nICAgIHB1YmxpYyB2b2lkIGNyZWF0ZUl0ZW0oRW50aXR5TWFuYWdlciBlbSwg\naW50IGlkKSB7CiAgICAgICAgSXRlbVhtbCBpdGVtID0gbmV3IEl0ZW1YbWwo\nKTsKICAgICAgICBpdGVtLnNldElkKGlkKTsKICAgICAgICBmb3IgKGludCBp\nID0gMDsgaSA8IG51bUltYWdlc1Blckl0ZW07IGkrKykgewogICAgICAgICAg\nICBpdGVtLmFkZEltYWdlKCJpbWFnZSIgKyBpZCArIGksICJmaWxlIiArIGlk\nICsgaSk7CiAgICAgICAgfQogICAgICAgIGVtLnBlcnNpc3QoaXRlbSk7CiAg\nICB9CgogICAgcHVibGljIHZvaWQgY3JlYXRlRGVwYXJ0bWVudChFbnRpdHlN\nYW5hZ2VyIGVtLCBpbnQgaWQpIHsKICAgICAgICBEZXBhcnRtZW50WG1sIGQg\nPSBuZXcgRGVwYXJ0bWVudFhtbCgpOwogICAgICAgIGQuc2V0RGVwdElkKGlk\nKTsKICAgICAgICBNYXAgZW1wcyA9IG5ldyBIYXNoTWFwKCk7CiAgICAgICAg\nZm9yIChpbnQgaSA9IDA7IGkgPCBudW1FbXBsb3llZXNQZXJEZXB0OyBpKysp\nIHsKICAgICAgICAgICAgRW1wbG95ZWVYbWwgZSA9IGNyZWF0ZUVtcGxveWVl\nKGVtLCBlbXBJZCsrKTsKICAgICAgICAgICAgZC5hZGRFbXBsb3llZShlKTsK\nICAgICAgICAgICAgZW1wcy5wdXQoZS5nZXRFbXBJZCgpLCBlKTsKICAgICAg\nICAgICAgZS5zZXREZXBhcnRtZW50KGQpOwogICAgICAgICAgICBlbS5wZXJz\naXN0KGUpOwogICAgICAgIH0KICAgICAgICBlbS5wZXJzaXN0KGQpOwogICAg\nfQoKICAgIHB1YmxpYyBFbXBsb3llZVhtbCBjcmVhdGVFbXBsb3llZShFbnRp\ndHlNYW5hZ2VyIGVtLCBpbnQgaWQpIHsKICAgICAgICBFbXBsb3llZVhtbCBl\nID0gbmV3IEVtcGxveWVlWG1sKCk7CiAgICAgICAgZS5zZXRFbXBJZChpZCk7\nCiAgICAgICAgcmV0dXJuIGU7CiAgICB9CgogICAgcHVibGljIHZvaWQgY3Jl\nYXRlQ29tcGFueShFbnRpdHlNYW5hZ2VyIGVtLCBpbnQgaWQpIHsKICAgICAg\nICBDb21wYW55WG1sIGMgPSBuZXcgQ29tcGFueVhtbCgpOwogICAgICAgIGMu\nc2V0SWQoaWQpOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgbnVtRGl2\naXNpb25zUGVyQ287IGkrKykgewogICAgICAgICAgICBEaXZpc2lvblhtbCBk\nID0gY3JlYXRlRGl2aXNpb24oZW0sIGRpdklkKyspOwogICAgICAgICAgICBW\naWNlUHJlc2lkZW50WG1sIHZwID0gY3JlYXRlVmljZVByZXNpZGVudChlbSwg\ndnBJZCsrKTsKICAgICAgICAgICAgYy5hZGRUb09yZ2FuaXphdGlvbihkLCB2\ncCk7CiAgICAgICAgICAgIGVtLnBlcnNpc3QoZCk7CiAgICAgICAgICAgIGVt\nLnBlcnNpc3QodnApOwogICAgICAgIH0KICAgICAgICBlbS5wZXJzaXN0KGMp\nOwogICAgfQoKICAgIHB1YmxpYyBEaXZpc2lvblhtbCBjcmVhdGVEaXZpc2lv\nbihFbnRpdHlNYW5hZ2VyIGVtLCBpbnQgaWQpIHsKICAgICAgICBEaXZpc2lv\nblhtbCBkID0gbmV3IERpdmlzaW9uWG1sKCk7CiAgICAgICAgZC5zZXRJZChp\nZCk7CiAgICAgICAgZC5zZXROYW1lKCJkIiArIGlkKTsKICAgICAgICByZXR1\ncm4gZDsKICAgIH0KCiAgICBwdWJsaWMgVmljZVByZXNpZGVudFhtbCBjcmVh\ndGVWaWNlUHJlc2lkZW50KEVudGl0eU1hbmFnZXIgZW0sIGludCBpZCkgewog\nICAgICAgIFZpY2VQcmVzaWRlbnRYbWwgdnAgPSBuZXcgVmljZVByZXNpZGVu\ndFhtbCgpOwogICAgICAgIHZwLnNldElkKGlkKTsKICAgICAgICB2cC5zZXRO\nYW1lKCJ2cCIgKyBpZCk7CiAgICAgICAgcmV0dXJuIHZwOwogICAgfQoKICAg\nIHB1YmxpYyB2b2lkIGZpbmRDb21wYW55KCkgewogICAgICAgIEVudGl0eU1h\nbmFnZXIgZW0gPSBlbWYuY3JlYXRlRW50aXR5TWFuYWdlcigpOwogICAgICAg\nIENvbXBhbnlYbWwgYyA9IGVtLmZpbmQoQ29tcGFueVhtbC5jbGFzcywgMSk7\nCiAgICAgICAgYXNzZXJ0Q29tcGFueShjKTsKCiAgICAgICAgRGl2aXNpb25Y\nbWwgZCA9IGVtLmZpbmQoRGl2aXNpb25YbWwuY2xhc3MsIDEpOwogICAgICAg\nIGFzc2VydERpdmlzaW9uKGQpOwoKICAgICAgICBWaWNlUHJlc2lkZW50WG1s\nIHZwID0gZW0uZmluZChWaWNlUHJlc2lkZW50WG1sLmNsYXNzLCAxKTsKICAg\nICAgICBhc3NlcnRWaWNlUHJlc2lkZW50KHZwKTsKCiAgICAgICAgdXBkYXRl\nQ29tcGFueShlbSwgYyk7CiAgICAgICAgZW0uY2xvc2UoKTsKCiAgICAgICAg\nZW0gPSBlbWYuY3JlYXRlRW50aXR5TWFuYWdlcigpOwogICAgICAgIGMgPSBl\nbS5maW5kKENvbXBhbnlYbWwuY2xhc3MsIDEpOwogICAgICAgIGFzc2VydENv\nbXBhbnkoYyk7CiAgICAgICAgZGVsZXRlQ29tcGFueShlbSwgYyk7CiAgICAg\nICAgZW0uY2xvc2UoKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBmaW5kRGVw\nYXJ0bWVudCgpIHsKICAgICAgICBFbnRpdHlNYW5hZ2VyIGVtID0gZW1mLmNy\nZWF0ZUVudGl0eU1hbmFnZXIoKTsKICAgICAgICBEZXBhcnRtZW50WG1sIGQg\nPSBlbS5maW5kKERlcGFydG1lbnRYbWwuY2xhc3MsIDEpOwogICAgICAgIGFz\nc2VydERlcGFydG1lbnQoZCk7CgogICAgICAgIEVtcGxveWVlWG1sIGUgPSBl\nbS5maW5kKEVtcGxveWVlWG1sLmNsYXNzLCAxKTsKICAgICAgICBhc3NlcnRF\nbXBsb3llZShlKTsKCiAgICAgICAgLy8gdXBkYXRlT2JqIGJ5IGFkZGluZyBh\nIG5ldyBFbXBsb3llZQogICAgICAgIHVwZGF0ZURlcGFydG1lbnQoZW0sIGQp\nOwogICAgICAgIGRlbGV0ZURlcGFydG1lbnQoZW0sIGQpOwogICAgICAgIGVt\nLmNsb3NlKCk7CiAgICB9CgogICAgcHVibGljIHZvaWQgZmluZEl0ZW0oKSB7\nCiAgICAgICAgRW50aXR5TWFuYWdlciBlbSA9IGVtZi5jcmVhdGVFbnRpdHlN\nYW5hZ2VyKCk7CiAgICAgICAgSXRlbVhtbCBpdGVtID0gZW0uZmluZChJdGVt\nWG1sLmNsYXNzLCAxKTsKICAgICAgICBhc3NlcnRJdGVtKGl0ZW0pOwogICAg\nICAgIHVwZGF0ZUl0ZW0oZW0sIGl0ZW0pOwogICAgICAgIGRlbGV0ZUl0ZW0o\nZW0sIGl0ZW0pOwogICAgICAgIGVtLmNsb3NlKCk7CiAgICB9CgogICAgcHVi\nbGljIHZvaWQgdXBkYXRlSXRlbShFbnRpdHlNYW5hZ2VyIGVtLCBJdGVtWG1s\nIGl0ZW0pIHsKICAgICAgICAvLyByZW1vdmUgYW4gZWxlbWVudAogICAgICAg\nIEVudGl0eVRyYW5zYWN0aW9uIHRyYW4gPSBlbS5nZXRUcmFuc2FjdGlvbigp\nOwogICAgICAgIHRyYW4uYmVnaW4oKTsKICAgICAgICBpdGVtLnJlbW92ZUlt\nYWdlKCJpbWFnZSIgKyBpdGVtLmdldElkKCkgKyAiMCIpOwogICAgICAgIGVt\nLnBlcnNpc3QoaXRlbSk7CiAgICAgICAgZW0uZmx1c2goKTsKICAgICAgICB0\ncmFuLmNvbW1pdCgpOwoKICAgICAgICAvLyBhZGQgYW4gZWxlbWVudAogICAg\nICAgIFN0cmluZyBrZXkgPSAiaW1hZ2UiICsgaXRlbS5nZXRJZCgpICsgIm5l\ndyI7CiAgICAgICAgdHJhbi5iZWdpbigpOwogICAgICAgIGl0ZW0uYWRkSW1h\nZ2Uoa2V5LCAiZmlsZSIgKyBpdGVtLmdldElkKCkgKyAibmV3Iik7CiAgICAg\nICAgZW0ucGVyc2lzdChpdGVtKTsKICAgICAgICBlbS5mbHVzaCgpOwogICAg\nICAgIHRyYW4uY29tbWl0KCk7CgogICAgICAgIC8vIG1vZGlmeSBhbiBlbGVt\nZW50CiAgICAgICAgdHJhbi5iZWdpbigpOwogICAgICAgIFN0cmluZyBmaWxl\nTmFtZSA9IGl0ZW0uZ2V0SW1hZ2Uoa2V5KTsKICAgICAgICBmaWxlTmFtZSA9\nIGZpbGVOYW1lICsgIm5ld0FnYWluIjsKICAgICAgICBpdGVtLmFkZEltYWdl\nKGtleSwgZmlsZU5hbWUpOwogICAgICAgIGVtLnBlcnNpc3QoaXRlbSk7CiAg\nICAgICAgZW0uZmx1c2goKTsKICAgICAgICB0cmFuLmNvbW1pdCgpOwogICAg\nfQoKICAgIHB1YmxpYyB2b2lkIGRlbGV0ZUl0ZW0oRW50aXR5TWFuYWdlciBl\nbSwgSXRlbVhtbCBpdGVtKSB7CiAgICAgICAgRW50aXR5VHJhbnNhY3Rpb24g\ndHJhbiA9IGVtLmdldFRyYW5zYWN0aW9uKCk7CiAgICAgICAgdHJhbi5iZWdp\nbigpOwogICAgICAgIGVtLnJlbW92ZShpdGVtKTsKICAgICAgICB0cmFuLmNv\nbW1pdCgpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHVwZGF0ZUNvbXBhbnko\nRW50aXR5TWFuYWdlciBlbSwgQ29tcGFueVhtbCBjKSB7CiAgICAgICAgRW50\naXR5VHJhbnNhY3Rpb24gdHJhbiA9IGVtLmdldFRyYW5zYWN0aW9uKCk7CiAg\nICAgICAgLy8gcmVtb3ZlIGFuIGVsZW1lbnQKICAgICAgICB0cmFuLmJlZ2lu\nKCk7CiAgICAgICAgTWFwIG9yZ3MgPSBjLmdldE9yZ2FuaXphdGlvbigpOwog\nICAgICAgIFNldCBrZXlzID0gb3Jncy5rZXlTZXQoKTsKICAgICAgICBmb3Ig\nKE9iamVjdCBrZXkgOiBrZXlzKSB7CiAgICAgICAgICAgIERpdmlzaW9uWG1s\nIGQgPSAoRGl2aXNpb25YbWwpIGtleTsKICAgICAgICAgICAgYy5yZW1vdmVG\ncm9tT3JnYW5pemF0aW9uKGQpOwogICAgICAgICAgICBicmVhazsKICAgICAg\nICB9CiAgICAgICAgZW0ucGVyc2lzdChjKTsKICAgICAgICBlbS5mbHVzaCgp\nOwogICAgICAgIHRyYW4uY29tbWl0KCk7CgogICAgICAgIC8vIGFkZCBhbiBl\nbGVtZW50CiAgICAgICAgdHJhbi5iZWdpbigpOwogICAgICAgIERpdmlzaW9u\nWG1sIGQgPSBjcmVhdGVEaXZpc2lvbihlbSwgbmV3RGl2SWQrKyk7CiAgICAg\nICAgVmljZVByZXNpZGVudFhtbCB2cCA9IGNyZWF0ZVZpY2VQcmVzaWRlbnQo\nZW0sIG5ld1ZwSWQrKyk7CiAgICAgICAgYy5hZGRUb09yZ2FuaXphdGlvbihk\nLCB2cCk7CiAgICAgICAgZW0ucGVyc2lzdChkKTsKICAgICAgICBlbS5wZXJz\naXN0KHZwKTsKICAgICAgICBlbS5wZXJzaXN0KGMpOwogICAgICAgIGVtLmZs\ndXNoKCk7CiAgICAgICAgdHJhbi5jb21taXQoKTsKCiAgICAgICAgLy8gbW9k\naWZ5IGFuIGVsZW1lbnQKICAgICAgICB0cmFuLmJlZ2luKCk7CiAgICAgICAg\nb3JncyA9IGMuZ2V0T3JnYW5pemF0aW9uKCk7CiAgICAgICAgdnAgPSBjLmdl\ndE9yZ2FuaXphdGlvbihkKTsKICAgICAgICB2cC5zZXROYW1lKCJuZXdOYW1l\nQWdhaW4iKTsKICAgICAgICBlbS5wZXJzaXN0KGMpOwogICAgICAgIGVtLnBl\ncnNpc3QodnApOwogICAgICAgIGVtLmZsdXNoKCk7CiAgICAgICAgdHJhbi5j\nb21taXQoKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBkZWxldGVDb21wYW55\nKEVudGl0eU1hbmFnZXIgZW0sIENvbXBhbnlYbWwgYykgewogICAgICAgIEVu\ndGl0eVRyYW5zYWN0aW9uIHRyYW4gPSBlbS5nZXRUcmFuc2FjdGlvbigpOwog\nICAgICAgIHRyYW4uYmVnaW4oKTsKICAgICAgICBlbS5yZW1vdmUoYyk7CiAg\nICAgICAgdHJhbi5jb21taXQoKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCB1\ncGRhdGVEZXBhcnRtZW50KEVudGl0eU1hbmFnZXIgZW0sIERlcGFydG1lbnRY\nbWwgZCkgewogICAgICAgIEVudGl0eVRyYW5zYWN0aW9uIHRyYW4gPSBlbS5n\nZXRUcmFuc2FjdGlvbigpOwoKICAgICAgICAvLyBhZGQgYW4gZWxlbWVudAog\nICAgICAgIHRyYW4uYmVnaW4oKTsKICAgICAgICBFbXBsb3llZVhtbCBlID0K\nICAgICAgICAgICAgY3JlYXRlRW1wbG95ZWUoZW0sIG51bURlcGFydG1lbnRz\nICogbnVtRW1wbG95ZWVzUGVyRGVwdCArIDEpOwogICAgICAgIGQuYWRkRW1w\nbG95ZWUoZSk7CiAgICAgICAgZS5zZXREZXBhcnRtZW50KGQpOwogICAgICAg\nIGVtLnBlcnNpc3QoZCk7CiAgICAgICAgZW0ucGVyc2lzdChlKTsKICAgICAg\nICBlbS5mbHVzaCgpOwogICAgICAgIHRyYW4uY29tbWl0KCk7CgogICAgICAg\nIC8vIHJlbW92ZSBhbiBlbGVtZW50CiAgICAgICAgdHJhbi5iZWdpbigpOwog\nICAgICAgIGQucmVtb3ZlRW1wbG95ZWUoZS5nZXRFbXBJZCgpKTsKICAgICAg\nICBlLnNldERlcGFydG1lbnQobnVsbCk7CiAgICAgICAgZW0ucGVyc2lzdChk\nKTsKICAgICAgICBlbS5wZXJzaXN0KGUpOwogICAgICAgIGVtLmZsdXNoKCk7\nCiAgICAgICAgdHJhbi5jb21taXQoKTsKICAgIH0KCiAgICBwdWJsaWMgdm9p\nZCBkZWxldGVEZXBhcnRtZW50KEVudGl0eU1hbmFnZXIgZW0sIERlcGFydG1l\nbnRYbWwgZCkgewogICAgICAgIEVudGl0eVRyYW5zYWN0aW9uIHRyYW4gPSBl\nbS5nZXRUcmFuc2FjdGlvbigpOwogICAgICAgIHRyYW4uYmVnaW4oKTsKICAg\nICAgICBlbS5yZW1vdmUoZCk7CiAgICAgICAgdHJhbi5jb21taXQoKTsKICAg\nIH0KCiAgICBwdWJsaWMgdm9pZCBxdWVyeU9iaigpIHsKICAgICAgICBxdWVy\neURlcGFydG1lbnQoKTsKICAgICAgICBxdWVyeUVtcGxveWVlKCk7CiAgICAg\nICAgcXVlcnlDb21wYW55KCk7CiAgICAgICAgcXVlcnlEaXZpc2lvbigpOwog\nICAgICAgIHF1ZXJ5VmljZVByZXNpZGVudCgpOwogICAgICAgIHF1ZXJ5SXRl\nbSgpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHF1ZXJ5RGVwYXJ0bWVudCgp\nIHsKICAgICAgICBFbnRpdHlNYW5hZ2VyIGVtID0gZW1mLmNyZWF0ZUVudGl0\neU1hbmFnZXIoKTsKICAgICAgICBFbnRpdHlUcmFuc2FjdGlvbiB0cmFuID0g\nZW0uZ2V0VHJhbnNhY3Rpb24oKTsKICAgICAgICB0cmFuLmJlZ2luKCk7CiAg\nICAgICAgUXVlcnkgcSA9IGVtLmNyZWF0ZVF1ZXJ5KCJzZWxlY3QgZCBmcm9t\nIERlcGFydG1lbnRYbWwgZCIpOwogICAgICAgIExpc3Q8RGVwYXJ0bWVudFht\nbD4gZHMgPSBxLmdldFJlc3VsdExpc3QoKTsKICAgICAgICBmb3IgKERlcGFy\ndG1lbnRYbWwgZCA6IGRzKSB7CiAgICAgICAgICAgIGFzc2VydERlcGFydG1l\nbnQoZCk7CiAgICAgICAgfQogICAgICAgIHRyYW4uY29tbWl0KCk7CiAgICAg\nICAgZW0uY2xvc2UoKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBxdWVyeUVt\ncGxveWVlKCkgewogICAgICAgIEVudGl0eU1hbmFnZXIgZW0gPSBlbWYuY3Jl\nYXRlRW50aXR5TWFuYWdlcigpOwogICAgICAgIEVudGl0eVRyYW5zYWN0aW9u\nIHRyYW4gPSBlbS5nZXRUcmFuc2FjdGlvbigpOwogICAgICAgIHRyYW4uYmVn\naW4oKTsKICAgICAgICBRdWVyeSBxID0gZW0uY3JlYXRlUXVlcnkoInNlbGVj\ndCBlIGZyb20gRW1wbG95ZWVYbWwgZSIpOwogICAgICAgIExpc3Q8RW1wbG95\nZWVYbWw+IGVzID0gcS5nZXRSZXN1bHRMaXN0KCk7CiAgICAgICAgZm9yIChF\nbXBsb3llZVhtbCBlIDogZXMpIHsKICAgICAgICAgICAgYXNzZXJ0RW1wbG95\nZWUoZSk7CiAgICAgICAgfQogICAgICAgIHRyYW4uY29tbWl0KCk7CiAgICAg\nICAgZW0uY2xvc2UoKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBxdWVyeUNv\nbXBhbnkoKSB7CiAgICAgICAgRW50aXR5TWFuYWdlciBlbSA9IGVtZi5jcmVh\ndGVFbnRpdHlNYW5hZ2VyKCk7CiAgICAgICAgRW50aXR5VHJhbnNhY3Rpb24g\ndHJhbiA9IGVtLmdldFRyYW5zYWN0aW9uKCk7CiAgICAgICAgdHJhbi5iZWdp\nbigpOwogICAgICAgIFF1ZXJ5IHEgPSBlbS5jcmVhdGVRdWVyeSgic2VsZWN0\nIGMgZnJvbSBDb21wYW55WG1sIGMiKTsKICAgICAgICBMaXN0PENvbXBhbnlY\nbWw+IGNzID0gcS5nZXRSZXN1bHRMaXN0KCk7CiAgICAgICAgZm9yIChDb21w\nYW55WG1sIGMgOiBjcyl7CiAgICAgICAgICAgIGFzc2VydENvbXBhbnkoYyk7\nCiAgICAgICAgfQogICAgICAgIHRyYW4uY29tbWl0KCk7CiAgICAgICAgZW0u\nY2xvc2UoKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBxdWVyeURpdmlzaW9u\nKCkgewogICAgICAgIEVudGl0eU1hbmFnZXIgZW0gPSBlbWYuY3JlYXRlRW50\naXR5TWFuYWdlcigpOwogICAgICAgIEVudGl0eVRyYW5zYWN0aW9uIHRyYW4g\nPSBlbS5nZXRUcmFuc2FjdGlvbigpOwogICAgICAgIHRyYW4uYmVnaW4oKTsK\nICAgICAgICBRdWVyeSBxID0gZW0uY3JlYXRlUXVlcnkoInNlbGVjdCBkIGZy\nb20gRGl2aXNpb25YbWwgZCIpOwogICAgICAgIExpc3Q8RGl2aXNpb25YbWw+\nIGRzID0gcS5nZXRSZXN1bHRMaXN0KCk7CiAgICAgICAgZm9yIChEaXZpc2lv\nblhtbCBkIDogZHMpewogICAgICAgICAgICBhc3NlcnREaXZpc2lvbihkKTsK\nICAgICAgICB9CiAgICAgICAgdHJhbi5jb21taXQoKTsKICAgICAgICBlbS5j\nbG9zZSgpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHF1ZXJ5VmljZVByZXNp\nZGVudCgpIHsKICAgICAgICBFbnRpdHlNYW5hZ2VyIGVtID0gZW1mLmNyZWF0\nZUVudGl0eU1hbmFnZXIoKTsKICAgICAgICBFbnRpdHlUcmFuc2FjdGlvbiB0\ncmFuID0gZW0uZ2V0VHJhbnNhY3Rpb24oKTsKICAgICAgICB0cmFuLmJlZ2lu\nKCk7CiAgICAgICAgUXVlcnkgcSA9IGVtLmNyZWF0ZVF1ZXJ5KCJzZWxlY3Qg\ndnAgZnJvbSBWaWNlUHJlc2lkZW50WG1sIHZwIik7CiAgICAgICAgTGlzdDxW\naWNlUHJlc2lkZW50WG1sPiB2cHMgPSBxLmdldFJlc3VsdExpc3QoKTsKICAg\nICAgICBmb3IgKFZpY2VQcmVzaWRlbnRYbWwgdnAgOiB2cHMpewogICAgICAg\nICAgICBhc3NlcnRWaWNlUHJlc2lkZW50KHZwKTsKICAgICAgICB9CiAgICAg\nICAgdHJhbi5jb21taXQoKTsKICAgICAgICBlbS5jbG9zZSgpOwogICAgfQoK\nICAgIHB1YmxpYyB2b2lkIHF1ZXJ5SXRlbSgpIHsKICAgICAgICBFbnRpdHlN\nYW5hZ2VyIGVtID0gZW1mLmNyZWF0ZUVudGl0eU1hbmFnZXIoKTsKICAgICAg\nICBFbnRpdHlUcmFuc2FjdGlvbiB0cmFuID0gZW0uZ2V0VHJhbnNhY3Rpb24o\nKTsKICAgICAgICB0cmFuLmJlZ2luKCk7CiAgICAgICAgUXVlcnkgcSA9IGVt\nLmNyZWF0ZVF1ZXJ5KCJzZWxlY3QgaSBmcm9tIEl0ZW1YbWwgaSIpOwogICAg\nICAgIExpc3Q8SXRlbVhtbD4gaXMgPSBxLmdldFJlc3VsdExpc3QoKTsKICAg\nICAgICBmb3IgKEl0ZW1YbWwgaXRlbSA6IGlzKXsKICAgICAgICAgICAgYXNz\nZXJ0SXRlbShpdGVtKTsKICAgICAgICB9CiAgICAgICAgdHJhbi5jb21taXQo\nKTsKICAgICAgICBlbS5jbG9zZSgpOwogICAgfQoKICAgIHB1YmxpYyB2b2lk\nIGFzc2VydERlcGFydG1lbnQoRGVwYXJ0bWVudFhtbCBkKSB7CiAgICAgICAg\naW50IGlkID0gZC5nZXREZXB0SWQoKTsKICAgICAgICBNYXA8SW50ZWdlciwg\nRW1wbG95ZWVYbWw+IGVzID0gZC5nZXRFbXBNYXAoKTsKICAgICAgICBhc3Nl\ncnRFcXVhbHMoMiwgZXMuc2l6ZSgpKTsKICAgICAgICBTZXQga2V5cyA9IGVz\nLmtleVNldCgpOwogICAgICAgIGZvciAoT2JqZWN0IG9iaiA6IGtleXMpIHsK\nICAgICAgICAgICAgSW50ZWdlciBlbXBJZCA9IChJbnRlZ2VyKSBvYmo7CiAg\nICAgICAgICAgIEVtcGxveWVlWG1sIGUgPSBlcy5nZXQoZW1wSWQpOwogICAg\nICAgICAgICBhc3NlcnRFcXVhbHMoZW1wSWQuaW50VmFsdWUoKSwgZS5nZXRF\nbXBJZCgpKTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGljIHZvaWQgYXNz\nZXJ0SXRlbShJdGVtWG1sIGl0ZW0pIHsKICAgICAgICBpbnQgaWQgPSBpdGVt\nLmdldElkKCk7CiAgICAgICAgTWFwIGltYWdlcyA9IGl0ZW0uZ2V0SW1hZ2Vz\nKCk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKG51bUltYWdlc1Blckl0ZW0sIGlt\nYWdlcy5zaXplKCkpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIGFzc2VydEVt\ncGxveWVlKEVtcGxveWVlWG1sIGUpIHsKICAgICAgICBpbnQgaWQgPSBlLmdl\ndEVtcElkKCk7CiAgICAgICAgRGVwYXJ0bWVudFhtbCBkID0gZS5nZXREZXBh\ncnRtZW50KCk7CiAgICAgICAgYXNzZXJ0RGVwYXJ0bWVudChkKTsKICAgIH0K\nCiAgICBwdWJsaWMgdm9pZCBhc3NlcnRDb21wYW55KENvbXBhbnlYbWwgYykg\newogICAgICAgIGludCBpZCA9IGMuZ2V0SWQoKTsKICAgICAgICBNYXAgb3Jn\nYW5pemF0aW9uID0gYy5nZXRPcmdhbml6YXRpb24oKTsKICAgICAgICBhc3Nl\ncnRFcXVhbHMoMixvcmdhbml6YXRpb24uc2l6ZSgpKTsKICAgIH0KCiAgICBw\ndWJsaWMgdm9pZCBhc3NlcnREaXZpc2lvbihEaXZpc2lvblhtbCBkKSB7CiAg\nICAgICAgaW50IGlkID0gZC5nZXRJZCgpOwogICAgICAgIFN0cmluZyBuYW1l\nID0gZC5nZXROYW1lKCk7CiAgICB9CgogICAgcHVibGljIHZvaWQgYXNzZXJ0\nVmljZVByZXNpZGVudChWaWNlUHJlc2lkZW50WG1sIHZwKSB7CiAgICAgICAg\naW50IGlkID0gdnAuZ2V0SWQoKTsKICAgICAgICBTdHJpbmcgbmFtZSA9IHZw\nLmdldE5hbWUoKTsKICAgIH0KICAgIAogICAgcHVibGljIHZvaWQgY3JlYXRl\nT3JwaGFuUmVtb3ZhbCgpIHsKICAgICAgICBFbnRpdHlNYW5hZ2VyIGVtID0g\nZW1mLmNyZWF0ZUVudGl0eU1hbmFnZXIoKTsKICAgICAgICBFbnRpdHlUcmFu\nc2FjdGlvbiB0cmFuID0gZW0uZ2V0VHJhbnNhY3Rpb24oKTsKICAgICAgICBm\nb3IgKGludCBpID0gMDsgaSA8IG51bUN1c3RvbWVyczsgaSsrKQogICAgICAg\nICAgICBjcmVhdGVDdXN0b21lcihlbSwgY0lkKyspOwogICAgICAgIHRyYW4u\nYmVnaW4oKTsKICAgICAgICBlbS5mbHVzaCgpOwogICAgICAgIHRyYW4uY29t\nbWl0KCk7CiAgICAgICAgZW0uY2xvc2UoKTsKICAgIH0KCiAgICBwdWJsaWMg\nQ3VzdG9tZXJYbWwgY3JlYXRlQ3VzdG9tZXIoRW50aXR5TWFuYWdlciBlbSwg\naW50IGlkKSB7CiAgICAgICAgQ3VzdG9tZXJYbWwgYyA9IG5ldyBDdXN0b21l\nclhtbCgpOwogICAgICAgIGMuc2V0SWQoaWQpOwogICAgICAgIGMuc2V0TmFt\nZSgibmFtZSIgKyBpZCk7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBu\ndW1PcmRlcnNQZXJDdXN0b21lcjsgaSsrKSB7CiAgICAgICAgICAgIE9yZGVy\nWG1sIG9yZGVyID0gY3JlYXRlT3JkZXIoZW0sIG9JZCsrKTsKICAgICAgICAg\nICAgYy5hZGRPcmRlcihvcmRlcik7CiAgICAgICAgICAgIG9yZGVyLnNldEN1\nc3QoYyk7CiAgICAgICAgICAgIGVtLnBlcnNpc3Qob3JkZXIpOwogICAgICAg\nIH0KICAgICAgICBlbS5wZXJzaXN0KGMpOwogICAgICAgIHJldHVybiBjOwog\nICAgfQoKICAgIHB1YmxpYyBPcmRlclhtbCBjcmVhdGVPcmRlcihFbnRpdHlN\nYW5hZ2VyIGVtLCBpbnQgaWQpIHsKICAgICAgICBPcmRlclhtbCBvID0gbmV3\nIE9yZGVyWG1sKCk7CiAgICAgICAgby5zZXRJZChpZCk7CiAgICAgICAgZW0u\ncGVyc2lzdChvKTsKICAgICAgICByZXR1cm4gbzsKICAgIH0KICAgIAogICAg\ncHVibGljIHZvaWQgdGVzdE9ycGhhblJlbW92YWxUYXJnZXQoKSB7CiAgICAg\nICAgY3JlYXRlT3JwaGFuUmVtb3ZhbCgpOwogICAgICAgIEVudGl0eU1hbmFn\nZXIgZW0gPSBlbWYuY3JlYXRlRW50aXR5TWFuYWdlcigpOwogICAgICAgIGlu\ndCBjb3VudCA9IGNvdW50KE9yZGVyWG1sLmNsYXNzKTsKICAgICAgICBhc3Nl\ncnRFcXVhbHMobnVtT3JkZXJzUGVyQ3VzdG9tZXIgKiBudW1DdXN0b21lcnMs\nIGNvdW50KTsKCiAgICAgICAgQ3VzdG9tZXJYbWwgYyA9IGVtLmZpbmQoQ3Vz\ndG9tZXJYbWwuY2xhc3MsIDEpOwogICAgICAgIFNldDxPcmRlclhtbD4gb3Jk\nZXJzID0gYy5nZXRPcmRlcnMoKTsKICAgICAgICBhc3NlcnRFcXVhbHMobnVt\nT3JkZXJzUGVyQ3VzdG9tZXIsIG9yZGVycy5zaXplKCkpOwoKICAgICAgICAv\nLyBPcnBoYW5SZW1vdmFsOiByZW1vdmUgdGFyZ2V0OiB0aGUgb3JkZXIgd2ls\nbCBiZSBkZWxldGVkIGZyb20gZGIKICAgICAgICBmb3IgKE9yZGVyWG1sIG9y\nZGVyIDogb3JkZXJzKSB7CiAgICAgICAgICAgIG9yZGVycy5yZW1vdmUob3Jk\nZXIpOwogICAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgICAgZW0u\nZ2V0VHJhbnNhY3Rpb24oKS5iZWdpbigpOwogICAgICAgIGVtLnBlcnNpc3Qo\nYyk7CiAgICAgICAgZW0uZmx1c2goKTsKICAgICAgICBlbS5nZXRUcmFuc2Fj\ndGlvbigpLmNvbW1pdCgpOwogICAgICAgIGVtLmNsZWFyKCk7CgogICAgICAg\nIGMgPSBlbS5maW5kKEN1c3RvbWVyWG1sLmNsYXNzLCAxKTsKICAgICAgICBv\ncmRlcnMgPSBjLmdldE9yZGVycygpOwogICAgICAgIGFzc2VydEVxdWFscyhu\ndW1PcmRlcnNQZXJDdXN0b21lciAtIDEsIG9yZGVycy5zaXplKCkpOwogICAg\nICAgIGNvdW50ID0gY291bnQoT3JkZXJYbWwuY2xhc3MpOwogICAgICAgIGFz\nc2VydEVxdWFscyhudW1PcmRlcnNQZXJDdXN0b21lciAqIG51bUN1c3RvbWVy\ncyAtIDEsIGNvdW50KTsKICAgICAgICBlbS5jbG9zZSgpOwogICAgfQogICAg\nCiAgICBwdWJsaWMgdm9pZCB0ZXN0T3JwaGFuUmVtb3ZhbFRhcmdldFNldE51\nbGwoKSB7CiAgICAgICAgY3JlYXRlT3JwaGFuUmVtb3ZhbCgpOwogICAgICAg\nIEVudGl0eU1hbmFnZXIgZW0gPSBlbWYuY3JlYXRlRW50aXR5TWFuYWdlcigp\nOwogICAgICAgIEN1c3RvbWVyWG1sIGMgPSBlbS5maW5kKEN1c3RvbWVyWG1s\nLmNsYXNzLCAxKTsKICAgICAgICBjLnNldE9yZGVycyhudWxsKTsKICAgICAg\nICBlbS5nZXRUcmFuc2FjdGlvbigpLmJlZ2luKCk7CiAgICAgICAgZW0ucGVy\nc2lzdChjKTsKICAgICAgICBlbS5mbHVzaCgpOwogICAgICAgIGVtLmdldFRy\nYW5zYWN0aW9uKCkuY29tbWl0KCk7CiAgICAgICAgZW0uY2xlYXIoKTsKCiAg\nICAgICAgaW50IGNvdW50ID0gY291bnQoT3JkZXJYbWwuY2xhc3MpOwogICAg\nICAgIGFzc2VydEVxdWFscyhudW1PcmRlcnNQZXJDdXN0b21lciAqIChudW1D\ndXN0b21lcnMgLSAxKSwgY291bnQpOwogICAgICAgIAogICAgICAgIGMgPSBl\nbS5maW5kKEN1c3RvbWVyWG1sLmNsYXNzLCAxKTsKICAgICAgICBTZXQ8T3Jk\nZXJYbWw+IG9yZGVycyA9IGMuZ2V0T3JkZXJzKCk7CiAgICAgICAgaWYgKG9y\nZGVycyAhPSBudWxsKQogICAgICAgICAgICBhc3NlcnRFcXVhbHMoMCwgb3Jk\nZXJzLnNpemUoKSk7CiAgICAgICAgZW0uY2xvc2UoKTsKICAgIH0KICAgIAog\nICAgcHVibGljIHZvaWQgdGVzdE9ycGhhblJlbW92YWxTb3VyY2UoKSB7CiAg\nICAgICAgY3JlYXRlT3JwaGFuUmVtb3ZhbCgpOwogICAgICAgIEVudGl0eU1h\nbmFnZXIgZW0gPSBlbWYuY3JlYXRlRW50aXR5TWFuYWdlcigpOwogICAgICAg\nIAogICAgICAgIC8vIE9ycGhhblJlbW92YWw6IHJlbW92ZSBzb3VyY2UKICAg\nICAgICBDdXN0b21lclhtbCBjID0gZW0uZmluZChDdXN0b21lclhtbC5jbGFz\ncywgMSk7CiAgICAgICAgZW0uZ2V0VHJhbnNhY3Rpb24oKS5iZWdpbigpOwog\nICAgICAgIGVtLnJlbW92ZShjKTsKICAgICAgICBlbS5mbHVzaCgpOwogICAg\nICAgIGVtLmdldFRyYW5zYWN0aW9uKCkuY29tbWl0KCk7CiAgICAgICAgZW0u\nY2xlYXIoKTsKICAgICAgICAKICAgICAgICBpbnQgY291bnQgPSBjb3VudChP\ncmRlclhtbC5jbGFzcyk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKG51bU9yZGVy\nc1BlckN1c3RvbWVyICogKG51bUN1c3RvbWVycyAtIDEpLCBjb3VudCk7CiAg\nICAgICAgCiAgICAgICAgZW0uY2xvc2UoKTsKICAgIH0KfQo=\n","encoding":"base64"}

