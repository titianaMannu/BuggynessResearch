{"sha":"844ab6e136f2dd4e233017609ca9c06d474c923e","node_id":"MDQ6QmxvYjIwNjM2NDo4NDRhYjZlMTM2ZjJkZDRlMjMzMDE3NjA5Y2E5YzA2ZDQ3NGM5MjNl","size":26596,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/844ab6e136f2dd4e233017609ca9c06d474c923e","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuZW5oYW5j\nZS5pZGVudGl0eTsKCmltcG9ydCBqYXZhLnV0aWwuQXJyYXlMaXN0OwppbXBv\ncnQgamF2YS51dGlsLkhhc2hNYXA7CmltcG9ydCBqYXZhLnV0aWwuTGlzdDsK\naW1wb3J0IGphdmEudXRpbC5NYXA7CgppbXBvcnQgamF2YXgucGVyc2lzdGVu\nY2UuRW50aXR5TWFuYWdlcjsKaW1wb3J0IGphdmF4LnBlcnNpc3RlbmNlLkVu\ndGl0eVRyYW5zYWN0aW9uOwppbXBvcnQgamF2YXgucGVyc2lzdGVuY2UuUXVl\ncnk7CgppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmVuaGFuY2UuUGVyc2lz\ndGVuY2VDYXBhYmxlOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMu\nY29uZi5KREJDQ29uZmlndXJhdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5rZXJuZWwuU3RhdGVNYW5hZ2VySW1wbDsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5wZXJzaXN0ZW5jZS50ZXN0LlNpbmdsZUVNRlRlc3RDYXNl\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuT2JqZWN0SWQ7Cgpw\ndWJsaWMgY2xhc3MgVGVzdE1hcHBlZEJ5SWQgZXh0ZW5kcyBTaW5nbGVFTUZU\nZXN0Q2FzZSB7CiAgICBwdWJsaWMgaW50IG51bUVtcGxveWVlcyA9IDQ7CiAg\nICBwdWJsaWMgaW50IG51bURlcGVuZGVudHNQZXJFbXBsb3llZSA9IDI7CiAg\nICBwdWJsaWMgaW50IG51bVBlcnNvbnMgPSA0OwoKICAgIHB1YmxpYyBNYXA8\nSW50ZWdlciwgRW1wbG95ZWUxPiBlbXBzMSA9IG5ldyBIYXNoTWFwPEludGVn\nZXIsIEVtcGxveWVlMT4oKTsKICAgIHB1YmxpYyBNYXA8U3RyaW5nLCBEZXBl\nbmRlbnQxPiBkZXBzMSA9IG5ldyBIYXNoTWFwPFN0cmluZywgRGVwZW5kZW50\nMT4oKTsKICAgIHB1YmxpYyBNYXA8SW50ZWdlciwgRW1wbG95ZWUyPiBlbXBz\nMiA9IG5ldyBIYXNoTWFwPEludGVnZXIsIEVtcGxveWVlMj4oKTsKICAgIHB1\nYmxpYyBNYXA8U3RyaW5nLCBEZXBlbmRlbnQyPiBkZXBzMiA9IG5ldyBIYXNo\nTWFwPFN0cmluZywgRGVwZW5kZW50Mj4oKTsKICAgIHB1YmxpYyBNYXA8U3Ry\naW5nLCBQZXJzb24xPiBwZXJzb25zMSA9IG5ldyBIYXNoTWFwPFN0cmluZywg\nUGVyc29uMT4oKTsKICAgIHB1YmxpYyBNYXA8U3RyaW5nLCBNZWRpY2FsSGlz\ndG9yeTE+IG1lZGljYWxzMSA9IAogICAgICAgIG5ldyBIYXNoTWFwPFN0cmlu\nZywgTWVkaWNhbEhpc3RvcnkxPigpOwogICAgcHVibGljIE1hcDxTdHJpbmcs\nIFBlcnNvbjI+IHBlcnNvbnMyID0gbmV3IEhhc2hNYXA8U3RyaW5nLCBQZXJz\nb24yPigpOwogICAgcHVibGljIE1hcDxTdHJpbmcsIE1lZGljYWxIaXN0b3J5\nMj4gbWVkaWNhbHMyID0gCiAgICAgICAgbmV3IEhhc2hNYXA8U3RyaW5nLCBN\nZWRpY2FsSGlzdG9yeTI+KCk7CiAgICBwdWJsaWMgTWFwPFN0cmluZywgUGVy\nc29uMz4gcGVyc29uczMgPSBuZXcgSGFzaE1hcDxTdHJpbmcsIFBlcnNvbjM+\nKCk7CiAgICBwdWJsaWMgTWFwPFN0cmluZywgTWVkaWNhbEhpc3RvcnkzPiBt\nZWRpY2FsczMgPSBuZXcgSGFzaE1hcDxTdHJpbmcsIAogICAgICAgIE1lZGlj\nYWxIaXN0b3J5Mz4oKTsKICAgIHB1YmxpYyBNYXA8U3RyaW5nLCBQZXJzb240\nPiBwZXJzb25zNCA9IG5ldyBIYXNoTWFwPFN0cmluZywgUGVyc29uND4oKTsK\nICAgIHB1YmxpYyBNYXA8U3RyaW5nLCBNZWRpY2FsSGlzdG9yeTQ+IG1lZGlj\nYWxzNCA9CiAgICAgICAgbmV3IEhhc2hNYXA8U3RyaW5nLCBNZWRpY2FsSGlz\ndG9yeTQ+KCk7CgogICAgcHVibGljIE1hcDxJbnRlZ2VyLCBFbXBsb3llZTM+\nIGVtcHMzID0gbmV3IEhhc2hNYXA8SW50ZWdlciwgRW1wbG95ZWUzPigpOwog\nICAgcHVibGljIE1hcDxPYmplY3QsIERlcGVuZGVudDM+IGRlcE1hcDMgPSAK\nICAgIAluZXcgSGFzaE1hcDxPYmplY3QsIERlcGVuZGVudDM+KCk7CiAgICBw\ndWJsaWMgTGlzdCBkaWRzMyA9IG5ldyBBcnJheUxpc3QoKTsKICAgIHB1Ymxp\nYyBMaXN0PERlcGVuZGVudDM+IGRlcHMzID0gbmV3IEFycmF5TGlzdDxEZXBl\nbmRlbnQzPigpOwogICAgCiAgICBwdWJsaWMgaW50IGVJZDEgPSAxOwogICAg\ncHVibGljIGludCBkSWQxID0gMTsKICAgIHB1YmxpYyBpbnQgZUlkMiA9IDE7\nCiAgICBwdWJsaWMgaW50IGRJZDIgPSAxOwogICAgcHVibGljIGludCBlSWQz\nID0gMTsKICAgIHB1YmxpYyBpbnQgZUlkNCA9IDE7CiAgICBwdWJsaWMgaW50\nIGRJZDQgPSAxOwogICAgcHVibGljIGludCBkSWQzID0gMTsKICAgIHB1Ymxp\nYyBpbnQgcElkMSA9IDE7CiAgICBwdWJsaWMgaW50IG1JZDEgPSAxOwogICAg\ncHVibGljIGludCBwSWQyID0gMTsKICAgIHB1YmxpYyBpbnQgbUlkMiA9IDE7\nCiAgICBwdWJsaWMgaW50IHBJZDMgPSAxOwogICAgcHVibGljIGludCBtSWQz\nID0gMTsKICAgIHB1YmxpYyBpbnQgcElkNCA9IDE7CiAgICBwdWJsaWMgaW50\nIG1JZDQgPSAxOwoKICAgIHB1YmxpYyB2b2lkIHNldFVwKCkgdGhyb3dzIEV4\nY2VwdGlvbiB7CiAgICAgICAgc3VwZXIuc2V0VXAoRFJPUF9UQUJMRVMsIERl\ncGVuZGVudDEuY2xhc3MsIEVtcGxveWVlLmNsYXNzLCBFbXBsb3llZTEuY2xh\nc3MsIAogICAgICAgICAgICBEZXBlbmRlbnRJZDEuY2xhc3MsIERlcGVuZGVu\ndDIuY2xhc3MsIEVtcGxveWVlMi5jbGFzcywKICAgICAgICAgICAgRGVwZW5k\nZW50SWQyLmNsYXNzLCBFbXBsb3llZUlkMi5jbGFzcywgTWVkaWNhbEhpc3Rv\ncnkxLmNsYXNzLAogICAgICAgICAgICBQZXJzb24xLmNsYXNzLCBQZXJzb25J\nZDEuY2xhc3MsIE1lZGljYWxIaXN0b3J5Mi5jbGFzcywKICAgICAgICAgICAg\nUGVyc29uMi5jbGFzcywgUGVyc29uMy5jbGFzcywgTWVkaWNhbEhpc3Rvcnkz\nLmNsYXNzLCAKICAgICAgICAgICAgUGVyc29uNC5jbGFzcywgUGVyc29uSWQ0\nLmNsYXNzLCBNZWRpY2FsSGlzdG9yeTQuY2xhc3MsCiAgICAgICAgICAgIERl\ncGVuZGVudDMuY2xhc3MsIEVtcGxveWVlMy5jbGFzcywgRGVwZW5kZW50SWQz\nLmNsYXNzLCAKICAgICAgICAgICAgUGFyZW50My5jbGFzcywgRGVwZW5kZW50\nNC5jbGFzcywgRW1wbG95ZWU0LmNsYXNzLCBQaG9uZU51bWJlci5jbGFzcywK\nICAgICAgICAgICAgQmVuZUNvbnRhY3QuY2xhc3MsIEJlbmVDb250YWN0SWQu\nY2xhc3MsIEJlbmVmaWNpYXJ5LmNsYXNzLAogICAgICAgICAgICBEZXBlbmRl\nbnQ1LmNsYXNzLCBFbXBsb3llZTUuY2xhc3MsIEVtcGxveWVlSWQ1LmNsYXNz\nKTsKICAgIH0KCiAgICAvKioKICAgICAqIFRoaXMgaXMgc3BlYyAyLjQuMS4y\nIEV4YW1wbGUgMSwgY2FzZShiKQogICAgICovCiAgICBwdWJsaWMgdm9pZCB0\nZXN0TWFwc0lkMSgpIHsKICAgICAgICBjcmVhdGVPYmoxKCk7CiAgICAgICAg\nZmluZE9iajEoKTsKICAgICAgICBxdWVyeU9iajEoKTsKICAgIH0KCiAgICAv\nKioKICAgICAqIFRoaXMgaXMgc3BlYyAyLjQuMS4yIEV4YW1wbGUgMywgY2Fz\nZShiKQogICAgICovCiAgICBwdWJsaWMgdm9pZCB0ZXN0TWFwc0lkMigpIHsK\nICAgICAgICBjcmVhdGVPYmoyKCk7CiAgICAgICAgZmluZE9iajIoKTsKICAg\nICAgICBxdWVyeU9iajIoKTsKICAgIH0KICAgIAogICAgLyoqCiAgICAgKiBU\naGlzIGlzIHNwZWMgMi40LjEuMiBFeGFtcGxlIDUsIGNhc2UoYikKICAgICAq\nLwogICAgcHVibGljIHZvaWQgdGVzdE1hcHNJZDMoKSB7CiAgICAgICAgY3Jl\nYXRlT2JqMygpOwogICAgICAgIGZpbmRPYmozKCk7CiAgICAgICAgcXVlcnlP\nYmozKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBUaGlzIGlzIGEgdmFyaWF0\naW9uIG9mIHNwZWMgMi40LjEuMiBFeGFtcGxlIDQsIGNhc2UoYikgd2l0aCBn\nZW5lcmF0ZWQga2V5CiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHRlc3RNYXBz\nSWQ0KCkgewogICAgICAgIC8vIE5vdCBhbGwgZGF0YWJhc2VzIHN1cHBvcnQg\nR2VuZXJhdGlvblR5cGUuSURFTlRJVFkgY29sdW1uKHMpCiAgICAgICAgaWYg\nKCEoKEpEQkNDb25maWd1cmF0aW9uKSBlbWYuZ2V0Q29uZmlndXJhdGlvbigp\nKS4KICAgICAgICAgICAgZ2V0REJEaWN0aW9uYXJ5SW5zdGFuY2UoKS5zdXBw\nb3J0c0F1dG9Bc3NpZ24pIHsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAg\nIH0KICAgICAgICBjcmVhdGVPYmo0KCk7CiAgICAgICAgcXVlcnlPYmo0KCk7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBUaGlzIGlzIGEgdmFyaWF0aW9uIG9m\nIHNwZWMgMi40LjEuMiBFeGFtcGxlIDEsIGNhc2UoYik6CiAgICAgKiB0d28g\nTWFwc0lkIGFubm90YXRpb25zIGluIERlcGVuZGVudDMgYW5kIGJvdGggcGFy\nZW50CiAgICAgKiBjbGFzc2VzIHVzZSBnZW5lcmF0ZWQga2V5IAogICAgICov\nCiAgICBwdWJsaWMgdm9pZCB0ZXN0TWFwc0lkNSgpIHsKICAgICAgICAvLyBO\nb3QgYWxsIGRhdGFiYXNlcyBzdXBwb3J0IEdlbmVyYXRpb25UeXBlLklERU5U\nSVRZIGNvbHVtbihzKQogICAgICAgIGlmICghKChKREJDQ29uZmlndXJhdGlv\nbikgZW1mLmdldENvbmZpZ3VyYXRpb24oKSkuCiAgICAgICAgICAgIGdldERC\nRGljdGlvbmFyeUluc3RhbmNlKCkuc3VwcG9ydHNBdXRvQXNzaWduKSB7CgkJ\nCXJldHVybjsKICAgICAgICB9CiAgICAgICAgY3JlYXRlT2JqNSgpOwogICAg\nICAgIGZpbmRPYmo1KCk7CiAgICAgICAgcXVlcnlPYmo1KCk7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBUaGlzIGlzIHNwZWMgMi40LjEuMiBFeGFtcGxlIDUs\nIGNhc2UoYSkKICAgICAqLwogICAgcHVibGljIHZvaWQgdGVzdE1hcHNJZDYo\nKSB7CiAgICAgICAgY3JlYXRlT2JqNigpOwogICAgICAgIGZpbmRPYmo2KCk7\nCiAgICAgICAgcXVlcnlPYmo2KCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBU\naGlzIGlzIHNwZWMgMi40LjEuMiBFeGFtcGxlIDYsIGNhc2UoYSkKICAgICAq\nLwogICAgcHVibGljIHZvaWQgdGVzdE1hcHNJZDcoKSB7CiAgICAgICAgY3Jl\nYXRlT2JqNygpOwogICAgICAgIGZpbmRPYmo3KCk7CiAgICAgICAgcXVlcnlP\nYmo3KCk7CiAgICB9CgogICAgcHVibGljIHZvaWQgdGVzdEVudW1JZENsYXNz\nKCkgewogICAgICAgIEVudGl0eU1hbmFnZXIgZW0gPSBlbWYuY3JlYXRlRW50\naXR5TWFuYWdlcigpOwogICAgICAgIEVtcGxveWVlIGUgPSBuZXcgRW1wbG95\nZWUoKTsKICAgICAgICBlLnNldEVtcElkKDEpOwogICAgICAgIGUuc2V0RW1w\nVHlwZShFbXBsb3llZS5FbXBUeXBlLkExKTsKICAgICAgICBQaG9uZU51bWJl\nciBwaG9uZU51bWJlciA9IG5ldyBQaG9uZU51bWJlcigpOwogICAgICAgIHBo\nb25lTnVtYmVyLnNldFBoTnVtYmVyKDEpOwogICAgICAgIHBob25lTnVtYmVy\nLnNldEVtcChlKTsKICAgICAgICBlLnNldFBob25lTnVtYmVyKHBob25lTnVt\nYmVyKTsKICAgICAgICBlbS5wZXJzaXN0KHBob25lTnVtYmVyKTsKICAgICAg\nICBlbS5wZXJzaXN0KGUpOwogICAgICAgIEVudGl0eVRyYW5zYWN0aW9uIHRy\nYW4gPSBlbS5nZXRUcmFuc2FjdGlvbigpOwogICAgICAgIHRyYW4uYmVnaW4o\nKTsKICAgICAgICBlbS5mbHVzaCgpOwogICAgICAgIHRyYW4uY29tbWl0KCk7\nCiAgICAgICAgZW0uY2xlYXIoKTsKICAgICAgICBQaG9uZU51bWJlciBwID0g\nZW0uZmluZChQaG9uZU51bWJlci5jbGFzcywgMSk7CiAgICAgICAgRW1wbG95\nZWUgZW1wID0gcC5nZXRFbXAoKTsKICAgICAgICBhc3NlcnRFcXVhbHMoMSwg\nZW1wLmdldEVtcElkKCkpOwogICAgICAgIGVtLmNsb3NlKCk7CiAgICB9CiAg\nICAKICAgIHB1YmxpYyB2b2lkIHRlc3RFbWJlZGRlZElkQ29udGFpbmVkSW5J\nZENsYXNzKCkgewogICAgICAgIEVudGl0eU1hbmFnZXIgZW0gPSBlbWYuY3Jl\nYXRlRW50aXR5TWFuYWdlcigpOwogICAgICAgIEVtcGxveWVlSWQ1IGVJZDEg\nPSBuZXcgRW1wbG95ZWVJZDUoIkphdmEiLCAiRHVrZSIpOwogICAgICAgIEVt\ncGxveWVlNSBlbXBsb3llZTEgPSBuZXcgRW1wbG95ZWU1KGVJZDEpOwogICAg\nICAgIERlcGVuZGVudDUgZGVwMSA9IG5ldyBEZXBlbmRlbnQ1KCIxIiwgZW1w\nbG95ZWUxKTsKCiAgICAgICAgZW0ucGVyc2lzdChkZXAxKTsKICAgICAgICBl\nbS5wZXJzaXN0KGVtcGxveWVlMSk7CgogICAgICAgIGVtLmdldFRyYW5zYWN0\naW9uKCkuYmVnaW4oKTsKICAgICAgICBlbS5mbHVzaCgpOwogICAgICAgIGVt\nLmdldFRyYW5zYWN0aW9uKCkuY29tbWl0KCk7CiAgICAgICAgZW0uY2xlYXIo\nKTsKICAgICAgICAKICAgICAgICBEZXBlbmRlbnRJZDUgZGVwSWQxID0gbmV3\nIERlcGVuZGVudElkNSgiMSIsIGVJZDEpOwogICAgICAgIERlcGVuZGVudDUg\nbmV3RGVwID0gZW0uZmluZChEZXBlbmRlbnQ1LmNsYXNzLCBkZXBJZDEpOwog\nICAgICAgIGFzc2VydE5vdE51bGwobmV3RGVwKTsKICAgIH0KICAgIAogICAg\ncHVibGljIHZvaWQgY3JlYXRlT2JqMSgpIHsKICAgICAgICBFbnRpdHlNYW5h\nZ2VyIGVtID0gZW1mLmNyZWF0ZUVudGl0eU1hbmFnZXIoKTsKICAgICAgICBF\nbnRpdHlUcmFuc2FjdGlvbiB0cmFuID0gZW0uZ2V0VHJhbnNhY3Rpb24oKTsK\nICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IG51bUVtcGxveWVlczsgaSsr\nKQogICAgICAgICAgICBjcmVhdGVFbXBsb3llZTEoZW0sIGVJZDErKyk7CiAg\nICAgICAgdHJhbi5iZWdpbigpOwogICAgICAgIGVtLmZsdXNoKCk7CiAgICAg\nICAgdHJhbi5jb21taXQoKTsKICAgICAgICBlbS5jbG9zZSgpOwogICAgfQoK\nICAgIHB1YmxpYyBFbXBsb3llZTEgY3JlYXRlRW1wbG95ZWUxKEVudGl0eU1h\nbmFnZXIgZW0sIGludCBpZCkgewogICAgICAgIEVtcGxveWVlMSBlID0gbmV3\nIEVtcGxveWVlMSgpOwogICAgICAgIGUuc2V0RW1wSWQoaWQpOwogICAgICAg\nIGUuc2V0TmFtZSgiZW1wXyIgKyBpZCk7CiAgICAgICAgZm9yIChpbnQgaSA9\nIDA7IGkgPCBudW1EZXBlbmRlbnRzUGVyRW1wbG95ZWU7IGkrKykgewogICAg\nICAgICAgICBEZXBlbmRlbnQxIGQgPSBjcmVhdGVEZXBlbmRlbnQxKGVtLCBk\nSWQxKyssIGUpOwogICAgICAgICAgICBlLmFkZERlcGVuZGVudChkKTsKICAg\nICAgICAgICAgZW0ucGVyc2lzdChkKTsKICAgICAgICB9CiAgICAgICAgZW0u\ncGVyc2lzdChlKTsKICAgICAgICBlbXBzMS5wdXQoaWQsIGUpOwogICAgICAg\nIHJldHVybiBlOwogICAgfQoKICAgIHB1YmxpYyBEZXBlbmRlbnQxIGNyZWF0\nZURlcGVuZGVudDEoRW50aXR5TWFuYWdlciBlbSwgaW50IGlkLCBFbXBsb3ll\nZTEgZSkgewogICAgICAgIERlcGVuZGVudDEgZCA9IG5ldyBEZXBlbmRlbnQx\nKCk7CiAgICAgICAgRGVwZW5kZW50SWQxIGRpZCA9IG5ldyBEZXBlbmRlbnRJ\nZDEoKTsKICAgICAgICBkaWQuc2V0TmFtZSgiZGVwXyIgKyBpZCk7CiAgICAg\nICAgZC5zZXRJZChkaWQpOwogICAgICAgIGQuc2V0RW1wKGUpOwogICAgICAg\nIGRlcHMxLnB1dChkaWQuZ2V0TmFtZSgpLCBkKTsKICAgICAgICByZXR1cm4g\nZDsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBmaW5kT2JqMSgpIHsKICAgICAg\nICBFbnRpdHlNYW5hZ2VyIGVtID0gZW1mLmNyZWF0ZUVudGl0eU1hbmFnZXIo\nKTsKICAgICAgICBFbXBsb3llZTEgZSA9IGVtLmZpbmQoRW1wbG95ZWUxLmNs\nYXNzLCAxKTsKICAgICAgICBMaXN0PERlcGVuZGVudDE+IGRzID0gZS5nZXRE\nZXBlbmRlbnRzKCk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKG51bURlcGVuZGVu\ndHNQZXJFbXBsb3llZSwgZHMuc2l6ZSgpKTsKICAgICAgICBFbXBsb3llZTEg\nZTAgPSBlbXBzMS5nZXQoMSk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKGUwLCBl\nKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBxdWVyeU9iajEoKSB7CiAgICAg\nICAgcXVlcnlEZXBlbmRlbnQxKCk7CiAgICB9CgogICAgcHVibGljIHZvaWQg\ncXVlcnlEZXBlbmRlbnQxKCkgewogICAgICAgIEVudGl0eU1hbmFnZXIgZW0g\nPSBlbWYuY3JlYXRlRW50aXR5TWFuYWdlcigpOwogICAgICAgIEVudGl0eVRy\nYW5zYWN0aW9uIHRyYW4gPSBlbS5nZXRUcmFuc2FjdGlvbigpOwogICAgICAg\nIHRyYW4uYmVnaW4oKTsKICAgICAgICBTdHJpbmcganBxbCA9ICJzZWxlY3Qg\nZCBmcm9tIERlcGVuZGVudDEgZCB3aGVyZSBkLmlkLm5hbWUgPSAnZGVwXzEn\nICIKICAgICAgICAgICAgKyAiQU5EIGQuZW1wLm5hbWUgPSAnZW1wXzEnIjsK\nICAgICAgICBRdWVyeSBxID0gZW0uY3JlYXRlUXVlcnkoanBxbCk7CiAgICAg\nICAgTGlzdDxEZXBlbmRlbnQxPiBkcyA9IHEuZ2V0UmVzdWx0TGlzdCgpOwog\nICAgICAgIGZvciAoRGVwZW5kZW50MSBkIDogZHMpIHsKICAgICAgICAgICAg\nYXNzZXJ0RGVwZW5kZW50MShkKTsKICAgICAgICB9CiAgICAgICAgdHJhbi5j\nb21taXQoKTsKICAgICAgICBlbS5jbG9zZSgpOwogICAgfQoKICAgIHB1Ymxp\nYyB2b2lkIGFzc2VydERlcGVuZGVudDEoRGVwZW5kZW50MSBkKSB7CiAgICAg\nICAgRGVwZW5kZW50SWQxIGlkID0gZC5nZXRJZCgpOwogICAgICAgIERlcGVu\nZGVudDEgZDAgPSBkZXBzMS5nZXQoaWQuZ2V0TmFtZSgpKTsKICAgICAgICBp\nZiAoZDAuaWQuZW1wUEsgPT0gMCkKICAgICAgICAgICAgZDAuaWQuZW1wUEsg\nPSBkMC5lbXAuZ2V0RW1wSWQoKTsKICAgICAgICBhc3NlcnRFcXVhbHMoZDAs\nIGQpOwogICAgfQogICAgCiAgICBwdWJsaWMgdm9pZCBjcmVhdGVPYmoyKCkg\newogICAgICAgIEVudGl0eU1hbmFnZXIgZW0gPSBlbWYuY3JlYXRlRW50aXR5\nTWFuYWdlcigpOwogICAgICAgIEVudGl0eVRyYW5zYWN0aW9uIHRyYW4gPSBl\nbS5nZXRUcmFuc2FjdGlvbigpOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBp\nIDwgbnVtRW1wbG95ZWVzOyBpKyspCiAgICAgICAgICAgIGNyZWF0ZUVtcGxv\neWVlMihlbSwgZUlkMisrKTsKICAgICAgICB0cmFuLmJlZ2luKCk7CiAgICAg\nICAgZW0uZmx1c2goKTsKICAgICAgICB0cmFuLmNvbW1pdCgpOwogICAgICAg\nIGVtLmNsb3NlKCk7CiAgICB9CiAgICAKICAgIHB1YmxpYyBFbXBsb3llZTIg\nY3JlYXRlRW1wbG95ZWUyKEVudGl0eU1hbmFnZXIgZW0sIGludCBpZCkgewog\nICAgICAgIEVtcGxveWVlMiBlID0gbmV3IEVtcGxveWVlMigpOwogICAgICAg\nIGUuc2V0RW1wSWQobmV3IEVtcGxveWVlSWQyKCJmXyIgKyBpZCwgImxfIiAr\nIGlkKSk7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBudW1EZXBlbmRl\nbnRzUGVyRW1wbG95ZWU7IGkrKykgewogICAgICAgICAgICBEZXBlbmRlbnQy\nIGQgPSBjcmVhdGVEZXBlbmRlbnQyKGVtLCBkSWQyKyssIGUpOwogICAgICAg\nICAgICBlLmFkZERlcGVuZGVudChkKTsKICAgICAgICAgICAgZW0ucGVyc2lz\ndChkKTsKICAgICAgICB9CiAgICAgICAgZW0ucGVyc2lzdChlKTsKICAgICAg\nICBlbXBzMi5wdXQoaWQsIGUpOwogICAgICAgIHJldHVybiBlOwogICAgfQoK\nICAgIHB1YmxpYyBEZXBlbmRlbnQyIGNyZWF0ZURlcGVuZGVudDIoRW50aXR5\nTWFuYWdlciBlbSwgaW50IGlkLCBFbXBsb3llZTIgZSkgewogICAgICAgIERl\ncGVuZGVudDIgZCA9IG5ldyBEZXBlbmRlbnQyKCk7CiAgICAgICAgRGVwZW5k\nZW50SWQyIGRpZCA9IG5ldyBEZXBlbmRlbnRJZDIoKTsKICAgICAgICBkaWQu\nc2V0TmFtZSgiZGVwXyIgKyBpZCk7CiAgICAgICAgZC5zZXRFbXAoZSk7CiAg\nICAgICAgZC5zZXRJZChkaWQpOwogICAgICAgIGVtLnBlcnNpc3QoZCk7CiAg\nICAgICAgZGVwczIucHV0KGRpZC5nZXROYW1lKCksIGQpOwogICAgICAgIHJl\ndHVybiBkOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIGZpbmRPYmoyKCkgewog\nICAgICAgIEVudGl0eU1hbmFnZXIgZW0gPSBlbWYuY3JlYXRlRW50aXR5TWFu\nYWdlcigpOwogICAgICAgIEVtcGxveWVlMiBlID0gZW0uZmluZChFbXBsb3ll\nZTIuY2xhc3MsIG5ldyBFbXBsb3llZUlkMigiZl8xIiwgImxfMSIpKTsKICAg\nICAgICBMaXN0PERlcGVuZGVudDI+IGRzID0gZS5nZXREZXBlbmRlbnRzKCk7\nCiAgICAgICAgYXNzZXJ0RXF1YWxzKG51bURlcGVuZGVudHNQZXJFbXBsb3ll\nZSwgZHMuc2l6ZSgpKTsKICAgICAgICBFbXBsb3llZTIgZTAgPSBlbXBzMi5n\nZXQoMSk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKGUwLCBlKTsKICAgIH0KCiAg\nICBwdWJsaWMgdm9pZCBxdWVyeU9iajIoKSB7CiAgICAgICAgcXVlcnlEZXBl\nbmRlbnQyKCk7CiAgICB9CiAgICBwdWJsaWMgdm9pZCBxdWVyeURlcGVuZGVu\ndDIoKSB7CiAgICAgICAgRW50aXR5TWFuYWdlciBlbSA9IGVtZi5jcmVhdGVF\nbnRpdHlNYW5hZ2VyKCk7CiAgICAgICAgRW50aXR5VHJhbnNhY3Rpb24gdHJh\nbiA9IGVtLmdldFRyYW5zYWN0aW9uKCk7CiAgICAgICAgU3RyaW5nIGpwcWwg\nPSAic2VsZWN0IGQgZnJvbSBEZXBlbmRlbnQyIGQgd2hlcmUgZC5pZC5uYW1l\nID0gJ2RlcF8xJyAiCiAgICAgICAgICAgICsgIkFORCBkLmlkLmVtcFBLLmZp\ncnN0TmFtZSA9ICdmXzEnIjsKICAgICAgICBRdWVyeSBxID0gZW0uY3JlYXRl\nUXVlcnkoanBxbCk7CiAgICAgICAgTGlzdDxEZXBlbmRlbnQyPiBkcyA9IHEu\nZ2V0UmVzdWx0TGlzdCgpOwogICAgICAgIGZvciAoRGVwZW5kZW50MiBkIDog\nZHMpIHsKICAgICAgICAgICAgYXNzZXJ0RGVwZW5kZW50MihkKTsKICAgICAg\nICB9CiAgICAgICAgCiAgICAgICAganBxbCA9ICJzZWxlY3QgZCBmcm9tIERl\ncGVuZGVudDIgZCB3aGVyZSBkLmlkLm5hbWUgPSAnZGVwXzEnICIKICAgICAg\nICAgICAgKyAiQU5EIGQuZW1wLmVtcElkLmZpcnN0TmFtZSA9ICdmXzEnIjsK\nICAgICAgICBxID0gZW0uY3JlYXRlUXVlcnkoanBxbCk7CiAgICAgICAgZHMg\nPSBxLmdldFJlc3VsdExpc3QoKTsKICAgICAgICBmb3IgKERlcGVuZGVudDIg\nZCA6IGRzKSB7CiAgICAgICAgICAgIGFzc2VydERlcGVuZGVudDIoZCk7CiAg\nICAgICAgfSAgICAgICAgCiAgICAgICAgZW0uY2xvc2UoKTsKICAgIH0KCiAg\nICBwdWJsaWMgdm9pZCBhc3NlcnREZXBlbmRlbnQyKERlcGVuZGVudDIgZCkg\newogICAgICAgIERlcGVuZGVudElkMiBkaWQgPSBkLmdldElkKCk7CiAgICAg\nICAgRGVwZW5kZW50MiBkMCA9IGRlcHMyLmdldChkaWQuZ2V0TmFtZSgpKTsK\nICAgICAgICBEZXBlbmRlbnRJZDIgZGlkMCA9IGQwLmdldElkKCk7CiAgICAg\nICAgZGlkMC5zZXRFbXBQSyhkMC5nZXRFbXAoKS5nZXRFbXBJZCgpKTsKICAg\nICAgICBhc3NlcnRFcXVhbHMoZDAsIGQpOwogICAgfQogICAgCiAgICBwdWJs\naWMgdm9pZCBjcmVhdGVPYmozKCkgewogICAgICAgIEVudGl0eU1hbmFnZXIg\nZW0gPSBlbWYuY3JlYXRlRW50aXR5TWFuYWdlcigpOwogICAgICAgIEVudGl0\neVRyYW5zYWN0aW9uIHRyYW4gPSBlbS5nZXRUcmFuc2FjdGlvbigpOwogICAg\nICAgIGZvciAoaW50IGkgPSAwOyBpIDwgbnVtUGVyc29uczsgaSsrKQogICAg\nICAgICAgICBjcmVhdGVQZXJzb24xKGVtLCBwSWQxKyspOwogICAgICAgIHRy\nYW4uYmVnaW4oKTsKICAgICAgICBlbS5mbHVzaCgpOwogICAgICAgIHRyYW4u\nY29tbWl0KCk7CiAgICAgICAgZW0uY2xvc2UoKTsKICAgIH0KCiAgICBwdWJs\naWMgUGVyc29uMSBjcmVhdGVQZXJzb24xKEVudGl0eU1hbmFnZXIgZW0sIGlu\ndCBpZCkgewogICAgICAgIFBlcnNvbjEgcCA9IG5ldyBQZXJzb24xKCk7CiAg\nICAgICAgUGVyc29uSWQxIHBpZCA9IG5ldyBQZXJzb25JZDEoKTsKICAgICAg\nICBwaWQuc2V0Rmlyc3ROYW1lKCJmXyIgKyBpZCk7CiAgICAgICAgcGlkLnNl\ndExhc3ROYW1lKCJsXyIgKyBpZCk7CiAgICAgICAgcC5zZXRJZChwaWQpOwog\nICAgICAgIE1lZGljYWxIaXN0b3J5MSBtID0gY3JlYXRlTWVkaWNhbEhpc3Rv\ncnkxKGVtLCBtSWQxKyspOwogICAgICAgIG0uc2V0UGF0aWVudChwKTsKICAg\nICAgICBwLnNldE1lZGljYWwobSk7CiAgICAgICAgZW0ucGVyc2lzdChtKTsK\nICAgICAgICBlbS5wZXJzaXN0KHApOwogICAgICAgIHBlcnNvbnMxLnB1dChw\naWQuZ2V0Rmlyc3ROYW1lKCksIHApOwogICAgICAgIG1lZGljYWxzMS5wdXQo\nbS5nZXRQYXRpZW50KCkuZ2V0SWQoKS5nZXRGaXJzdE5hbWUoKSwgbSk7CiAg\nICAgICAgcmV0dXJuIHA7CiAgICB9CgogICAgcHVibGljIE1lZGljYWxIaXN0\nb3J5MSBjcmVhdGVNZWRpY2FsSGlzdG9yeTEoRW50aXR5TWFuYWdlciBlbSwg\naW50IGlkKSB7CiAgICAgICAgTWVkaWNhbEhpc3RvcnkxIG0gPSBuZXcgTWVk\naWNhbEhpc3RvcnkxKCk7CiAgICAgICAgbS5zZXROYW1lKCJtZWRpY2FsXyIg\nKyBpZCk7CiAgICAgICAgcmV0dXJuIG07CiAgICB9CgogICAgcHVibGljIHZv\naWQgZmluZE9iajMoKSB7CiAgICAgICAgRW50aXR5TWFuYWdlciBlbSA9IGVt\nZi5jcmVhdGVFbnRpdHlNYW5hZ2VyKCk7CiAgICAgICAgUGVyc29uSWQxIHBp\nZCA9IG5ldyBQZXJzb25JZDEoKTsKICAgICAgICBwaWQuc2V0Rmlyc3ROYW1l\nKCJmXzEiKTsKICAgICAgICBwaWQuc2V0TGFzdE5hbWUoImxfMSIpOwogICAg\nICAgIFBlcnNvbjEgcCA9IGVtLmZpbmQoUGVyc29uMS5jbGFzcywgcGlkKTsK\nICAgICAgICBQZXJzb24xIHAwID0gcGVyc29uczEuZ2V0KHBpZC5nZXRGaXJz\ndE5hbWUoKSk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKHAwLCBwKTsKICAgIH0K\nCiAgICBwdWJsaWMgdm9pZCBxdWVyeU9iajMoKSB7CiAgICAgICAgcXVlcnlN\nZWRpY2FsSGlzdG9yeTEoKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBxdWVy\neU1lZGljYWxIaXN0b3J5MSgpIHsKICAgICAgICBFbnRpdHlNYW5hZ2VyIGVt\nID0gZW1mLmNyZWF0ZUVudGl0eU1hbmFnZXIoKTsKICAgICAgICBFbnRpdHlU\ncmFuc2FjdGlvbiB0cmFuID0gZW0uZ2V0VHJhbnNhY3Rpb24oKTsKICAgICAg\nICBTdHJpbmcgZmlyc3ROYW1lID0gImZfMSI7CiAgICAgICAgdHJhbi5iZWdp\nbigpOwogICAgICAgIFN0cmluZyBqcHFsID0KICAgICAgICAgICAgInNlbGVj\ndCBtIGZyb20gTWVkaWNhbEhpc3RvcnkxIG0gd2hlcmUgbS5wYXRpZW50Lmlk\nLmZpcnN0TmFtZSA9ICciCiAgICAgICAgICAgICsgZmlyc3ROYW1lICsgIici\nOwogICAgICAgIFF1ZXJ5IHEgPSBlbS5jcmVhdGVRdWVyeShqcHFsKTsKICAg\nICAgICBMaXN0PE1lZGljYWxIaXN0b3J5MT4gbXMgPSBxLmdldFJlc3VsdExp\nc3QoKTsKICAgICAgICBmb3IgKE1lZGljYWxIaXN0b3J5MSBtIDogbXMpIHsK\nICAgICAgICAgICAgYXNzZXJ0TWVkaWNhbEhpc3RvcnkxKG0sIGZpcnN0TmFt\nZSk7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIGpwcWwgPSAic2VsZWN0\nIG0gZnJvbSBNZWRpY2FsSGlzdG9yeTEgbSB3aGVyZSBtLmlkLmZpcnN0TmFt\nZSA9ICciCiAgICAgICAgICAgICsgZmlyc3ROYW1lICsgIiciOwogICAgICAg\nIHEgPSBlbS5jcmVhdGVRdWVyeShqcHFsKTsKICAgICAgICBtcyA9IHEuZ2V0\nUmVzdWx0TGlzdCgpOwogICAgICAgIGZvciAoTWVkaWNhbEhpc3RvcnkxIG0g\nOiBtcykgewogICAgICAgICAgICBhc3NlcnRNZWRpY2FsSGlzdG9yeTEobSwg\nZmlyc3ROYW1lKTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgdHJhbi5j\nb21taXQoKTsKICAgICAgICBlbS5jbG9zZSgpOwogICAgfQoKICAgIHB1Ymxp\nYyB2b2lkIGFzc2VydE1lZGljYWxIaXN0b3J5MShNZWRpY2FsSGlzdG9yeTEg\nbSwgU3RyaW5nIGZpcnN0TmFtZSkgewogICAgICAgIE1lZGljYWxIaXN0b3J5\nMSBtMCA9IG1lZGljYWxzMS5nZXQoZmlyc3ROYW1lKTsKICAgICAgICBhc3Nl\ncnRFcXVhbHMobTAsIG0pOwogICAgfQogICAgCiAgICBwdWJsaWMgdm9pZCBj\ncmVhdGVPYmo0KCkgewogICAgICAgIEVudGl0eU1hbmFnZXIgZW0gPSBlbWYu\nY3JlYXRlRW50aXR5TWFuYWdlcigpOwogICAgICAgIEVudGl0eVRyYW5zYWN0\naW9uIHRyYW4gPSBlbS5nZXRUcmFuc2FjdGlvbigpOwogICAgICAgIGZvciAo\naW50IGkgPSAwOyBpIDwgbnVtUGVyc29uczsgaSsrKQogICAgICAgICAgICBj\ncmVhdGVQZXJzb24yKGVtLCBwSWQyKyspOwogICAgICAgIHRyYW4uYmVnaW4o\nKTsKICAgICAgICBlbS5mbHVzaCgpOwogICAgICAgIHRyYW4uY29tbWl0KCk7\nCiAgICAgICAgZW0uY2xvc2UoKTsKICAgIH0KCiAgICBwdWJsaWMgUGVyc29u\nMiBjcmVhdGVQZXJzb24yKEVudGl0eU1hbmFnZXIgZW0sIGludCBpZCkgewog\nICAgICAgIFBlcnNvbjIgcCA9IG5ldyBQZXJzb24yKCk7CiAgICAgICAgcC5z\nZXROYW1lKCJwXyIgKyBpZCk7CiAgICAgICAgCiAgICAgICAgTWVkaWNhbEhp\nc3RvcnkyIG0gPSBjcmVhdGVNZWRpY2FsSGlzdG9yeTIoZW0sIG1JZDIrKyk7\nCiAgICAgICAgbS5zZXRQYXRpZW50KHApOyAgLy8gYXV0b21hdGljYWxseSBz\nZXQgdGhlIGlkCiAgICAgICAgcC5zZXRNZWRpY2FsKG0pOwogICAgICAgIGVt\nLnBlcnNpc3QobSk7CiAgICAgICAgbWVkaWNhbHMyLnB1dChtLmdldE5hbWUo\nKSwgbSk7CgogICAgICAgIGVtLnBlcnNpc3QocCk7CiAgICAgICAgcGVyc29u\nczIucHV0KHAuZ2V0TmFtZSgpLCBwKTsKICAgICAgICByZXR1cm4gcDsKICAg\nIH0KCiAgICBwdWJsaWMgTWVkaWNhbEhpc3RvcnkyIGNyZWF0ZU1lZGljYWxI\naXN0b3J5MihFbnRpdHlNYW5hZ2VyIGVtLCBpbnQgaWQpIHsKICAgICAgICBN\nZWRpY2FsSGlzdG9yeTIgbSA9IG5ldyBNZWRpY2FsSGlzdG9yeTIoKTsKICAg\nICAgICBtLnNldE5hbWUoIm1lZGljYWxfIiArIGlkKTsKICAgICAgICByZXR1\ncm4gbTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBmaW5kT2JqNChsb25nIHNz\nbikgewogICAgICAgIEVudGl0eU1hbmFnZXIgZW0gPSBlbWYuY3JlYXRlRW50\naXR5TWFuYWdlcigpOwogICAgICAgIFBlcnNvbjIgcCA9IGVtLmZpbmQoUGVy\nc29uMi5jbGFzcywgc3NuKTsKICAgICAgICBQZXJzb24yIHAxID0gcC5nZXRN\nZWRpY2FsKCkuZ2V0UGF0aWVudCgpOwogICAgICAgIGFzc2VydEVxdWFscyhw\nMSwgcCk7CiAgICB9CgogICAgcHVibGljIHZvaWQgcXVlcnlPYmo0KCkgewog\nICAgICAgIHF1ZXJ5TWVkaWNhbEhpc3Rvcnk0KCk7CiAgICB9CgogICAgcHVi\nbGljIHZvaWQgcXVlcnlNZWRpY2FsSGlzdG9yeTQoKSB7CiAgICAgICAgRW50\naXR5TWFuYWdlciBlbSA9IGVtZi5jcmVhdGVFbnRpdHlNYW5hZ2VyKCk7CiAg\nICAgICAgTWFwIG1lZGljYWxzID0gbmV3IEhhc2hNYXAoKTsKICAgICAgICBs\nb25nIHNzbiA9IDA7CiAgICAgICAgRW50aXR5VHJhbnNhY3Rpb24gdHJhbiA9\nIGVtLmdldFRyYW5zYWN0aW9uKCk7CiAgICAgICAgdHJhbi5iZWdpbigpOwog\nICAgICAgIFN0cmluZyBqcHFsID0gInNlbGVjdCBtIGZyb20gTWVkaWNhbEhp\nc3RvcnkyIG0iOwogICAgICAgIFF1ZXJ5IHEgPSBlbS5jcmVhdGVRdWVyeShq\ncHFsKTsKICAgICAgICBMaXN0PE1lZGljYWxIaXN0b3J5Mj4gbXMgPSBxLmdl\ndFJlc3VsdExpc3QoKTsKICAgICAgICBmb3IgKE1lZGljYWxIaXN0b3J5MiBt\nIDogbXMpIHsKICAgICAgICAgICAgc3NuID0gbS5nZXRJZCgpOwogICAgICAg\nIH0KICAgICAgICB0cmFuLmNvbW1pdCgpOwogICAgICAgIGVtLmNsb3NlKCk7\nCiAgICAgICAgCiAgICAgICAgZW0gPSBlbWYuY3JlYXRlRW50aXR5TWFuYWdl\ncigpOwogICAgICAgIHRyYW4gPSBlbS5nZXRUcmFuc2FjdGlvbigpOwogICAg\nICAgIHRyYW4uYmVnaW4oKTsKICAgICAgICBqcHFsID0gInNlbGVjdCBtIGZy\nb20gTWVkaWNhbEhpc3RvcnkyIG0gd2hlcmUgbS5wYXRpZW50LnNzbiA9ICIg\nKyBzc247CiAgICAgICAgcSA9IGVtLmNyZWF0ZVF1ZXJ5KGpwcWwpOwogICAg\nICAgIG1zID0gcS5nZXRSZXN1bHRMaXN0KCk7CiAgICAgICAgZm9yIChNZWRp\nY2FsSGlzdG9yeTIgbSA6IG1zKSB7CiAgICAgICAgICAgIGFzc2VydE1lZGlj\nYWxIaXN0b3J5MihtKTsKICAgICAgICB9CiAgICAgICAgdHJhbi5jb21taXQo\nKTsKICAgICAgICBlbS5jbG9zZSgpOwogICAgICAgIAogICAgICAgIGZpbmRP\nYmo0KHNzbik7CiAgICB9CgogICAgcHVibGljIHZvaWQgYXNzZXJ0TWVkaWNh\nbEhpc3RvcnkyKE1lZGljYWxIaXN0b3J5MiBtKSB7CiAgICAgICAgU3RyaW5n\nIG5hbWUgPSBtLmdldE5hbWUoKTsKICAgICAgICBNZWRpY2FsSGlzdG9yeTIg\nbTAgPSBtZWRpY2FsczIuZ2V0KG5hbWUpOwogICAgICAgIE1lZGljYWxIaXN0\nb3J5MiBtMSA9IG0uZ2V0UGF0aWVudCgpLmdldE1lZGljYWwoKTsKICAgICAg\nICBhc3NlcnRFcXVhbHMobTEsIG0pOwogICAgfQogICAgCiAgICBwdWJsaWMg\ndm9pZCBjcmVhdGVPYmo1KCkgewogICAgICAgIEVudGl0eU1hbmFnZXIgZW0g\nPSBlbWYuY3JlYXRlRW50aXR5TWFuYWdlcigpOwogICAgICAgIEVudGl0eVRy\nYW5zYWN0aW9uIHRyYW4gPSBlbS5nZXRUcmFuc2FjdGlvbigpOwogICAgICAg\nIGZvciAoaW50IGkgPSAwOyBpIDwgbnVtRW1wbG95ZWVzOyBpKyspCiAgICAg\nICAgICAgIGNyZWF0ZUVtcGxveWVlMyhlbSwgZUlkMysrKTsKICAgICAgICB0\ncmFuLmJlZ2luKCk7CiAgICAgICAgZW0uZmx1c2goKTsKICAgICAgICB0cmFu\nLmNvbW1pdCgpOwogICAgICAgIGZvciAoRGVwZW5kZW50MyBkOiBkZXBzMykg\newogICAgICAgICAgICBPYmplY3RJZCBkaWQgPSAoT2JqZWN0SWQpKChTdGF0\nZU1hbmFnZXJJbXBsKSgoUGVyc2lzdGVuY2VDYXBhYmxlKWQpCiAgICAgICAg\nCSAgICAgICAgLnBjR2V0U3RhdGVNYW5hZ2VyKCkpLmdldE9iamVjdElkKCk7\nCiAgICAgICAgCWRpZHMzLmFkZChkaWQuZ2V0SWQoKSk7CiAgICAgICAgCWRl\ncE1hcDMucHV0KGRpZC5nZXRJZCgpLCBkKTsKICAgICAgICB9CiAgICAgICAg\nCiAgICAgICAgZW0uY2xvc2UoKTsKICAgIH0KCiAgICBwdWJsaWMgRW1wbG95\nZWUzIGNyZWF0ZUVtcGxveWVlMyhFbnRpdHlNYW5hZ2VyIGVtLCBpbnQgaWQp\nIHsKICAgICAgICBFbXBsb3llZTMgZSA9IG5ldyBFbXBsb3llZTMoKTsKICAg\nICAgICBlLnNldE5hbWUoImVtcF8iICsgaWQpOwogICAgICAgIGZvciAoaW50\nIGkgPSAwOyBpIDwgbnVtRGVwZW5kZW50c1BlckVtcGxveWVlOyBpKyspIHsK\nICAgICAgICAgICAgRGVwZW5kZW50MyBkID0gY3JlYXRlRGVwZW5kZW50Myhl\nbSwgZElkMysrLCBlKTsKICAgICAgICAgICAgZS5hZGREZXBlbmRlbnQoZCk7\nCiAgICAgICAgICAgIGVtLnBlcnNpc3QoZCk7CiAgICAgICAgfQogICAgICAg\nIGVtLnBlcnNpc3QoZSk7CiAgICAgICAgZW1wczMucHV0KGlkLCBlKTsKICAg\nICAgICByZXR1cm4gZTsKICAgIH0KCiAgICBwdWJsaWMgRGVwZW5kZW50MyBj\ncmVhdGVEZXBlbmRlbnQzKEVudGl0eU1hbmFnZXIgZW0sIGludCBpZCwgRW1w\nbG95ZWUzIGUpIHsKICAgICAgICBEZXBlbmRlbnQzIGQgPSBuZXcgRGVwZW5k\nZW50MygpOwogICAgICAgIERlcGVuZGVudElkMyBkaWQgPSBuZXcgRGVwZW5k\nZW50SWQzKCk7CiAgICAgICAgZGlkLnNldE5hbWUoImRlcF8iICsgaWQpOwog\nICAgICAgIGQuc2V0SWQoZGlkKTsKICAgICAgICBkLnNldEVtcChlKTsKICAg\nICAgICBkZXBzMy5hZGQoZCk7CiAgICAgICAgUGFyZW50MyBwID0gbmV3IFBh\ncmVudDMoKTsKICAgICAgICBwLnNldE5hbWUoInBfIiArIGlkKTsKICAgICAg\nICBwLnNldERlcGVuZGVudChkKTsKICAgICAgICBkLnNldFBhcmVudChwKTsK\nICAgICAgICBlbS5wZXJzaXN0KHApOwogICAgICAgIHJldHVybiBkOwogICAg\nfQoKICAgIHB1YmxpYyB2b2lkIGZpbmRPYmo1KCkgewogICAgICAgIEVudGl0\neU1hbmFnZXIgZW0gPSBlbWYuY3JlYXRlRW50aXR5TWFuYWdlcigpOwogICAg\nICAgIERlcGVuZGVudDMgZCA9IGVtLmZpbmQoRGVwZW5kZW50My5jbGFzcywg\nZGlkczMuZ2V0KDEpKTsKICAgICAgICBEZXBlbmRlbnQzIGQwID0gZGVwTWFw\nMy5nZXQoZGlkczMuZ2V0KDEpKTsKICAgICAgICBhc3NlcnRFcXVhbHMoZDAs\nIGQpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHF1ZXJ5T2JqNSgpIHsKICAg\nICAgICBFbnRpdHlNYW5hZ2VyIGVtID0gZW1mLmNyZWF0ZUVudGl0eU1hbmFn\nZXIoKTsKICAgICAgICBFbnRpdHlUcmFuc2FjdGlvbiB0cmFuID0gZW0uZ2V0\nVHJhbnNhY3Rpb24oKTsKICAgICAgICB0cmFuLmJlZ2luKCk7CiAgICAgICAg\nU3RyaW5nIGpwcWwgPSAic2VsZWN0IGQgZnJvbSBEZXBlbmRlbnQzIGQgd2hl\ncmUgZC5pZC5uYW1lID0gJ2RlcF8xJyAiCiAgICAgICAgICAgICsgIkFORCBk\nLmVtcC5uYW1lID0gJ2VtcF8xJyI7CiAgICAgICAgUXVlcnkgcSA9IGVtLmNy\nZWF0ZVF1ZXJ5KGpwcWwpOwogICAgICAgIExpc3Q8RGVwZW5kZW50Mz4gZHMg\nPSBxLmdldFJlc3VsdExpc3QoKTsKICAgICAgICBmb3IgKERlcGVuZGVudDMg\nZCA6IGRzKSB7CiAgICAgICAgICAgIGFzc2VydERlcGVuZGVudDMoZCk7CiAg\nICAgICAgfQogICAgICAgIHRyYW4uY29tbWl0KCk7CiAgICAgICAgZW0uY2xv\nc2UoKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBhc3NlcnREZXBlbmRlbnQz\nKERlcGVuZGVudDMgZCkgewogICAgICAgIERlcGVuZGVudElkMyBpZCA9IGQu\nZ2V0SWQoKTsKICAgICAgICBEZXBlbmRlbnQzIGQwID0gZGVwTWFwMy5nZXQo\naWQpOwogICAgICAgIGlmIChkMC5pZC5lbXBQSyA9PSAwKQogICAgICAgICAg\nICBkMC5pZC5lbXBQSyA9IGQwLmVtcC5nZXRFbXBJZCgpOwogICAgICAgIGFz\nc2VydEVxdWFscyhkMCwgZCk7CiAgICB9CiAgICAKICAgIHB1YmxpYyB2b2lk\nIGNyZWF0ZU9iajYoKSB7CiAgICAgICAgRW50aXR5TWFuYWdlciBlbSA9IGVt\nZi5jcmVhdGVFbnRpdHlNYW5hZ2VyKCk7CiAgICAgICAgRW50aXR5VHJhbnNh\nY3Rpb24gdHJhbiA9IGVtLmdldFRyYW5zYWN0aW9uKCk7CiAgICAgICAgZm9y\nIChpbnQgaSA9IDA7IGkgPCBudW1QZXJzb25zOyBpKyspCiAgICAgICAgICAg\nIGNyZWF0ZVBlcnNvbjMoZW0sIHBJZDMrKyk7CiAgICAgICAgdHJhbi5iZWdp\nbigpOwogICAgICAgIGVtLmZsdXNoKCk7CiAgICAgICAgdHJhbi5jb21taXQo\nKTsKICAgICAgICBlbS5jbG9zZSgpOwogICAgfQoKICAgIHB1YmxpYyBQZXJz\nb24zIGNyZWF0ZVBlcnNvbjMoRW50aXR5TWFuYWdlciBlbSwgaW50IGlkKSB7\nCiAgICAgICAgUGVyc29uMyBwID0gbmV3IFBlcnNvbjMoKTsKICAgICAgICBw\nLnNldEZpcnN0TmFtZSgiZl8iICsgaWQpOwogICAgICAgIHAuc2V0TGFzdE5h\nbWUoImxfIiArIGlkKTsKICAgICAgICBNZWRpY2FsSGlzdG9yeTMgbSA9IGNy\nZWF0ZU1lZGljYWxIaXN0b3J5MyhlbSwgbUlkMysrKTsKICAgICAgICBtLnNl\ndFBhdGllbnQocCk7CiAgICAgICAgcC5zZXRNZWRpY2FsKG0pOwogICAgICAg\nIGVtLnBlcnNpc3QobSk7CiAgICAgICAgZW0ucGVyc2lzdChwKTsKICAgICAg\nICBwZXJzb25zMy5wdXQocC5nZXRGaXJzdE5hbWUoKSwgcCk7CiAgICAgICAg\nbWVkaWNhbHMzLnB1dChtLmdldFBhdGllbnQoKS5nZXRGaXJzdE5hbWUoKSwg\nbSk7CiAgICAgICAgcmV0dXJuIHA7CiAgICB9CgogICAgcHVibGljIE1lZGlj\nYWxIaXN0b3J5MyBjcmVhdGVNZWRpY2FsSGlzdG9yeTMoRW50aXR5TWFuYWdl\nciBlbSwgaW50IGlkKSB7CiAgICAgICAgTWVkaWNhbEhpc3RvcnkzIG0gPSBu\nZXcgTWVkaWNhbEhpc3RvcnkzKCk7CiAgICAgICAgbS5zZXROYW1lKCJtZWRp\nY2FsXyIgKyBpZCk7CiAgICAgICAgcmV0dXJuIG07CiAgICB9CgogICAgcHVi\nbGljIHZvaWQgZmluZE9iajYoKSB7CiAgICAgICAgRW50aXR5TWFuYWdlciBl\nbSA9IGVtZi5jcmVhdGVFbnRpdHlNYW5hZ2VyKCk7CiAgICAgICAgUGVyc29u\nMyBwID0gZW0uZmluZChQZXJzb24zLmNsYXNzLCBuZXcgUGVyc29uSWQzKCJm\nXzEiLCAibF8xIikpOwogICAgICAgIFBlcnNvbjMgcDAgPSBwZXJzb25zMy5n\nZXQoImZfMSIpOwogICAgICAgIFBlcnNvbjMgcDEgPSBwLmdldE1lZGljYWwo\nKS5nZXRQYXRpZW50KCk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKHAsIHAxKTsK\nICAgICAgICBlbS5jbGVhcigpOwogICAgICAgIAogICAgICAgIE1lZGljYWxI\naXN0b3J5MyBtID0gZW0uZmluZChNZWRpY2FsSGlzdG9yeTMuY2xhc3MsIG5l\ndyBQZXJzb25JZDMoImZfMSIsICJsXzEiKSk7CiAgICAgICAgTWVkaWNhbEhp\nc3RvcnkzIG0wID0gbWVkaWNhbHMzLmdldCgiZl8xIik7CiAgICAgICAgYXNz\nZXJ0RXF1YWxzKG0sIG0wKTsKICAgICAgICAKICAgICAgICBlbS5nZXRUcmFu\nc2FjdGlvbigpLmJlZ2luKCk7CiAgICAgICAgZW0ucmVtb3ZlKG0pOwogICAg\nICAgIGVtLmdldFRyYW5zYWN0aW9uKCkuY29tbWl0KCk7CiAgICB9CgogICAg\ncHVibGljIHZvaWQgcXVlcnlPYmo2KCkgeyAKICAgICAgICBFbnRpdHlNYW5h\nZ2VyIGVtID0gZW1mLmNyZWF0ZUVudGl0eU1hbmFnZXIoKTsKICAgICAgICBF\nbnRpdHlUcmFuc2FjdGlvbiB0cmFuID0gZW0uZ2V0VHJhbnNhY3Rpb24oKTsK\nICAgICAgICB0cmFuLmJlZ2luKCk7CiAgICAgICAgU3RyaW5nIGZpcnN0TmFt\nZSA9ICJmXzEiOwogICAgICAgIFN0cmluZyBqcHFsID0KICAgICAgICAgICAg\nInNlbGVjdCBtIGZyb20gTWVkaWNhbEhpc3RvcnkzIG0gd2hlcmUgbS5wYXRp\nZW50LmZpcnN0TmFtZSA9ICciCiAgICAgICAgICAgICsgZmlyc3ROYW1lICsg\nIiciOwogICAgICAgIFF1ZXJ5IHEgPSBlbS5jcmVhdGVRdWVyeShqcHFsKTsK\nICAgICAgICBMaXN0PE1lZGljYWxIaXN0b3J5Mz4gbXMgPSBxLmdldFJlc3Vs\ndExpc3QoKTsKICAgICAgICBmb3IgKE1lZGljYWxIaXN0b3J5MyBtIDogbXMp\nIHsKICAgICAgICAgICAgYXNzZXJ0TWVkaWNhbEhpc3RvcnkzKG0sIGZpcnN0\nTmFtZSk7CiAgICAgICAgfQogICAgICAgIHRyYW4uY29tbWl0KCk7CiAgICAg\nICAgZW0uY2xvc2UoKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBhc3NlcnRN\nZWRpY2FsSGlzdG9yeTMoTWVkaWNhbEhpc3RvcnkzIG0sIFN0cmluZyBmaXJz\ndE5hbWUpIHsKICAgICAgICBNZWRpY2FsSGlzdG9yeTMgbTAgPSBtZWRpY2Fs\nczMuZ2V0KGZpcnN0TmFtZSk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKG0wLCBt\nKTsKICAgIH0KICAgIAogICAgcHVibGljIHZvaWQgY3JlYXRlT2JqNygpIHsK\nICAgICAgICBFbnRpdHlNYW5hZ2VyIGVtID0gZW1mLmNyZWF0ZUVudGl0eU1h\nbmFnZXIoKTsKICAgICAgICBFbnRpdHlUcmFuc2FjdGlvbiB0cmFuID0gZW0u\nZ2V0VHJhbnNhY3Rpb24oKTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8\nIG51bVBlcnNvbnM7IGkrKykKICAgICAgICAgICAgY3JlYXRlUGVyc29uNChl\nbSwgcElkNCsrKTsKICAgICAgICB0cmFuLmJlZ2luKCk7CiAgICAgICAgZW0u\nZmx1c2goKTsKICAgICAgICB0cmFuLmNvbW1pdCgpOwogICAgICAgIGVtLmNs\nb3NlKCk7CiAgICB9CgogICAgcHVibGljIFBlcnNvbjQgY3JlYXRlUGVyc29u\nNChFbnRpdHlNYW5hZ2VyIGVtLCBpbnQgaWQpIHsKICAgICAgICBQZXJzb240\nIHAgPSBuZXcgUGVyc29uNCgpOwogICAgICAgIHAuc2V0SWQobmV3IFBlcnNv\nbklkNCgiZl8iICsgaWQsICJsXyIgKyBpZCkpOwogICAgICAgIE1lZGljYWxI\naXN0b3J5NCBtID0gY3JlYXRlTWVkaWNhbEhpc3Rvcnk0KGVtLCBtSWQ0Kysp\nOwogICAgICAgIG0uc2V0UGF0aWVudChwKTsKICAgICAgICBwLnNldE1lZGlj\nYWwobSk7CiAgICAgICAgZW0ucGVyc2lzdChwKTsKICAgICAgICBlbS5wZXJz\naXN0KG0pOwogICAgICAgIHBlcnNvbnM0LnB1dChwLmdldElkKCkuZ2V0Rmly\nc3ROYW1lKCksIHApOwogICAgICAgIG1lZGljYWxzNC5wdXQobS5nZXRQYXRp\nZW50KCkuZ2V0SWQoKS5nZXRGaXJzdE5hbWUoKSwgbSk7CiAgICAgICAgcmV0\ndXJuIHA7CiAgICB9CgogICAgcHVibGljIE1lZGljYWxIaXN0b3J5NCBjcmVh\ndGVNZWRpY2FsSGlzdG9yeTQoRW50aXR5TWFuYWdlciBlbSwgaW50IGlkKSB7\nCiAgICAgICAgTWVkaWNhbEhpc3Rvcnk0IG0gPSBuZXcgTWVkaWNhbEhpc3Rv\ncnk0KCk7CiAgICAgICAgbS5zZXROYW1lKCJtZWRpY2FsXyIgKyBpZCk7CiAg\nICAgICAgcmV0dXJuIG07CiAgICB9CgogICAgcHVibGljIHZvaWQgZmluZE9i\najcoKSB7CiAgICAgICAgRW50aXR5TWFuYWdlciBlbSA9IGVtZi5jcmVhdGVF\nbnRpdHlNYW5hZ2VyKCk7CiAgICAgICAgUGVyc29uNCBwID0gZW0uZmluZChQ\nZXJzb240LmNsYXNzLCBuZXcgUGVyc29uSWQ0KCJmXzEiLCAibF8xIikpOwog\nICAgICAgIFBlcnNvbjQgcDAgPSBwZXJzb25zNC5nZXQoImZfMSIpOwogICAg\nICAgIFBlcnNvbjQgcDEgPSBwLmdldE1lZGljYWwoKS5nZXRQYXRpZW50KCk7\nCiAgICAgICAgYXNzZXJ0RXF1YWxzKHAxLCBwKTsKICAgICAgICBlbS5jbGVh\ncigpOwogICAgICAgIAogICAgICAgIE1lZGljYWxIaXN0b3J5NCBtID0gZW0u\nZmluZChNZWRpY2FsSGlzdG9yeTQuY2xhc3MsIG5ldyBQZXJzb25JZDQoImZf\nMSIsICJsXzEiKSk7CiAgICAgICAgTWVkaWNhbEhpc3Rvcnk0IG0wID0gbWVk\naWNhbHM0LmdldCgiZl8xIik7CiAgICAgICAgYXNzZXJ0RXF1YWxzKG0sIG0w\nKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBxdWVyeU9iajcoKSB7CiAgICAg\nICAgRW50aXR5TWFuYWdlciBlbSA9IGVtZi5jcmVhdGVFbnRpdHlNYW5hZ2Vy\nKCk7CiAgICAgICAgRW50aXR5VHJhbnNhY3Rpb24gdHJhbiA9IGVtLmdldFRy\nYW5zYWN0aW9uKCk7CiAgICAgICAgdHJhbi5iZWdpbigpOwogICAgICAgIFN0\ncmluZyBmaXJzdE5hbWUgPSAiZl8xIjsKICAgICAgICBTdHJpbmcganBxbCA9\nCiAgICAgICAgICAgICJzZWxlY3QgbSBmcm9tIE1lZGljYWxIaXN0b3J5NCBt\nIHdoZXJlIG0ucGF0aWVudC5pZC5maXJzdE5hbWUgPSAnIgogICAgICAgICAg\nICArIGZpcnN0TmFtZSArICInIjsKICAgICAgICBRdWVyeSBxID0gZW0uY3Jl\nYXRlUXVlcnkoanBxbCk7CiAgICAgICAgTGlzdDxNZWRpY2FsSGlzdG9yeTQ+\nIG1zID0gcS5nZXRSZXN1bHRMaXN0KCk7CiAgICAgICAgZm9yIChNZWRpY2Fs\nSGlzdG9yeTQgbSA6IG1zKSB7CiAgICAgICAgICAgIGFzc2VydE1lZGljYWxI\naXN0b3J5NChtLCBmaXJzdE5hbWUpOwogICAgICAgIH0KICAgICAgICB0cmFu\nLmNvbW1pdCgpOwogICAgICAgIGVtLmNsb3NlKCk7CiAgICB9CgogICAgcHVi\nbGljIHZvaWQgYXNzZXJ0TWVkaWNhbEhpc3Rvcnk0KE1lZGljYWxIaXN0b3J5\nNCBtLCBTdHJpbmcgZmlyc3ROYW1lKSB7CiAgICAgICAgTWVkaWNhbEhpc3Rv\ncnk0IG0wID0gbWVkaWNhbHM0LmdldChmaXJzdE5hbWUpOwogICAgICAgIE1l\nZGljYWxIaXN0b3J5NCBtMSA9IG0uZ2V0UGF0aWVudCgpLmdldE1lZGljYWwo\nKTsKICAgICAgICBhc3NlcnRFcXVhbHMobTEsIG0pOwogICAgfQogICAgCiAg\nICAvKioKICAgICAqIERlcml2ZWQgSWRlbnRpdHkgd2l0aCBJZENsYXNzIGFu\nZCBnZW5lcmF0ZWRLZXkKICAgICAqLwogICAgcHVibGljIHZvaWQgdGVzdFBl\ncnNpc3REZXJpdmVkSWRlbnRpdHlVc2luZ0lkQ2xhc3NBbmRHZW5lcmF0ZWRL\nZXkoKSB7CiAgICAgICAgLy8gTm90IGFsbCBkYXRhYmFzZXMgc3VwcG9ydCBH\nZW5lcmF0aW9uVHlwZS5JREVOVElUWSBjb2x1bW4ocykKICAgICAgICBpZiAo\nISgoSkRCQ0NvbmZpZ3VyYXRpb24pIGVtZi5nZXRDb25maWd1cmF0aW9uKCkp\nLgogICAgICAgICAgICBnZXREQkRpY3Rpb25hcnlJbnN0YW5jZSgpLnN1cHBv\ncnRzQXV0b0Fzc2lnbikgewoJCQlyZXR1cm47CiAgICAgICAgfQogICAgICAg\nIEVudGl0eU1hbmFnZXIgZW0gPSBlbWYuY3JlYXRlRW50aXR5TWFuYWdlcigp\nOwogICAgICAgIEVudGl0eVRyYW5zYWN0aW9uIHRyYW4gPSBlbS5nZXRUcmFu\nc2FjdGlvbigpOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgbnVtRW1w\nbG95ZWVzOyBpKyspCiAgICAgICAgICAgIHBlcnNpc3RFbXBsb3llZTQoZW0s\nIGVJZDQrKyk7CiAgICAgICAgdHJhbi5iZWdpbigpOwogICAgICAgIGVtLmZs\ndXNoKCk7CiAgICAgICAgdHJhbi5jb21taXQoKTsKICAgICAgICBlbS5jbG9z\nZSgpOwogICAgfQoKICAgIC8qKgogICAgICogRGVyaXZlZCBJZGVudGl0eSB3\naXRoIElkQ2xhc3MgYW5kIGdlbmVyYXRlZEtleQogICAgICovCiAgICBwdWJs\naWMgdm9pZCB0ZXN0TWVyZ2VEZXJpdmVkSWRlbnRpdHlVc2luZ0lkQ2xhc3NB\nbmRHZW5lcmF0ZWRLZXkoKSB7CiAgICAgICAgLy8gTm90IGFsbCBkYXRhYmFz\nZXMgc3VwcG9ydCBHZW5lcmF0aW9uVHlwZS5JREVOVElUWSBjb2x1bW4ocykK\nICAgICAgICBpZiAoISgoSkRCQ0NvbmZpZ3VyYXRpb24pIGVtZi5nZXRDb25m\naWd1cmF0aW9uKCkpLgogICAgICAgICAgICBnZXREQkRpY3Rpb25hcnlJbnN0\nYW5jZSgpLnN1cHBvcnRzQXV0b0Fzc2lnbikgewoJCQlyZXR1cm47CiAgICAg\nICAgfQogICAgICAgIEVudGl0eU1hbmFnZXIgZW0gPSBlbWYuY3JlYXRlRW50\naXR5TWFuYWdlcigpOwogICAgICAgIEVudGl0eVRyYW5zYWN0aW9uIHRyYW4g\nPSBlbS5nZXRUcmFuc2FjdGlvbigpOwogICAgICAgIGZvciAoaW50IGkgPSAw\nOyBpIDwgbnVtRW1wbG95ZWVzOyBpKyspCiAgICAgICAgICAgIG1lcmdlRW1w\nbG95ZWU0KGVtLCBlSWQ0KyspOwogICAgICAgIHRyYW4uYmVnaW4oKTsKICAg\nICAgICBlbS5mbHVzaCgpOwogICAgICAgIHRyYW4uY29tbWl0KCk7CiAgICAg\nICAgZW0uY2xvc2UoKTsKICAgIH0KCiAgICBwdWJsaWMgRW1wbG95ZWU0IHBl\ncnNpc3RFbXBsb3llZTQoRW50aXR5TWFuYWdlciBlbSwgaW50IGlkKSB7CiAg\nICAgICAgRW1wbG95ZWU0IHAgPSBuZXcgRW1wbG95ZWU0KCk7CiAgICAgICAg\ncC5zZXRBZ2UoaWQpOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgbnVt\nRGVwZW5kZW50c1BlckVtcGxveWVlOyBpKyspIHsKICAgICAgICAgICAgRGVw\nZW5kZW50NCBjID0gcGVyc2lzdERlcGVuZGVudDQoZW0sIGRJZDQrKywgcCk7\nCiAgICAgICAgICAgIHAuYWRkQ2hpbGQoYyk7CiAgICAgICAgfQogICAgICAg\nIGVtLnBlcnNpc3QocCk7CiAgICAgICAgcmV0dXJuIHA7CiAgICB9CiAgICAK\nICAgIHB1YmxpYyBEZXBlbmRlbnQ0IHBlcnNpc3REZXBlbmRlbnQ0KEVudGl0\neU1hbmFnZXIgZW0sIGludCBpZCwgRW1wbG95ZWU0IHApIHsKICAgICAgICBE\nZXBlbmRlbnQ0IGMgPSBuZXcgRGVwZW5kZW50NCgpOwogICAgICAgIGMuc2V0\nSWQoaWQpOwogICAgICAgIGMuc2V0UGFyZW50KHApOwogICAgICAgIGVtLnBl\ncnNpc3QoYyk7CiAgICAgICAgcmV0dXJuIGM7CiAgICB9CiAgICAKICAgIHB1\nYmxpYyBFbXBsb3llZTQgbWVyZ2VFbXBsb3llZTQoRW50aXR5TWFuYWdlciBl\nbSwgaW50IGlkKSB7CiAgICAgICAgRW1wbG95ZWU0IGUgPSBuZXcgRW1wbG95\nZWU0KCk7CiAgICAgICAgZS5zZXRBZ2UoaWQpOwogICAgICAgIGUgPSBlbS5t\nZXJnZShlKTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IG51bURlcGVu\nZGVudHNQZXJFbXBsb3llZTsgaSsrKSB7CiAgICAgICAgICAgIERlcGVuZGVu\ndDQgZCA9IG5ldyBEZXBlbmRlbnQ0KCk7CiAgICAgICAgICAgIGQuc2V0SWQo\nZElkNCsrKTsKICAgICAgICAgICAgZC5zZXRQYXJlbnQoZSk7CiAgICAgICAg\nICAgIC8vIGRvIG5vdCBuZWVkIHRvIG1lcmdlIGQsIGFzIEVtcGxveWVlIGlz\nIGNhc2NhZGUuQWxsCiAgICAgICAgICAgIGQgPSBlbS5tZXJnZShkKTsKICAg\nICAgICAgICAgZS5hZGRDaGlsZChkKTsKICAgICAgICB9CiAgICAgICAgcmV0\ndXJuIGU7CiAgICB9CiAgICAKICAgIHB1YmxpYyB2b2lkIHRlc3RFbnVtSW5F\nbWJlZGRlZElkKCkgewogICAgICAgIEVudGl0eU1hbmFnZXIgZW0gPSBlbWYu\nY3JlYXRlRW50aXR5TWFuYWdlcigpOwogICAgICAgIEJlbmVmaWNpYXJ5IGIg\nPSBuZXcgQmVuZWZpY2lhcnkoKTsKICAgICAgICBiLnNldElkKCJiOCIpOwog\nICAgICAgIExpc3Q8QmVuZUNvbnRhY3Q+IGNvbnRhY3RzID0gbmV3IEFycmF5\nTGlzdDxCZW5lQ29udGFjdD4oKTsKICAgICAgICBCZW5lQ29udGFjdCBjID0g\nbmV3IEJlbmVDb250YWN0KCk7CiAgICAgICAgYy5zZXRFbWFpbCgiZW1haWw4\nIik7CiAgICAgICAgQmVuZUNvbnRhY3RJZCBpZCA9IG5ldyBCZW5lQ29udGFj\ndElkKCk7CiAgICAgICAgaWQuc2V0Q29udGFjdFR5cGUoQmVuZUNvbnRhY3RJ\nZC5Db250YWN0VHlwZS5IT01FKTsKICAgICAgICBjLnNldEJlbmVmaWNpYXJ5\nKGIpOwogICAgICAgIAogICAgICAgIGMuc2V0SWQoaWQpOwogICAgICAgIGVt\nLnBlcnNpc3QoYyk7CiAgICAgICAgY29udGFjdHMuYWRkKGMpOwogICAgICAg\nIGIuc2V0Q29udGFjdHMoY29udGFjdHMpOwogICAgICAgIGVtLnBlcnNpc3Qo\nYik7CiAgICAgICAgZW0uZ2V0VHJhbnNhY3Rpb24oKS5iZWdpbigpOwogICAg\nICAgIGVtLmZsdXNoKCk7CiAgICAgICAgZW0uZ2V0VHJhbnNhY3Rpb24oKS5j\nb21taXQoKTsKICAgICAgICBlbS5jbGVhcigpOwogICAgICAgIEJlbmVDb250\nYWN0SWQgaWQxID0gYy5nZXRJZCgpOwogICAgICAgIEJlbmVDb250YWN0IGMx\nID0gZW0uZmluZChCZW5lQ29udGFjdC5jbGFzcywgaWQxKTsKICAgICAgICBh\nc3NlcnRFcXVhbHMoImVtYWlsOCIsIGMxLmdldEVtYWlsKCkpOwogICAgfQp9\nCg==\n","encoding":"base64"}

