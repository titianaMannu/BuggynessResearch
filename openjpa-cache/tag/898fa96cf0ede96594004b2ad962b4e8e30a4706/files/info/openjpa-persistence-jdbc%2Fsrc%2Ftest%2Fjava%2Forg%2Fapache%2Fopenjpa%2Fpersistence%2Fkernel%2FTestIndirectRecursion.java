{"sha":"d891d81bba011a2c7e0d5ccd99de901d8a05f931","node_id":"MDQ6QmxvYjIwNjM2NDpkODkxZDgxYmJhMDExYTJjN2UwZDVjY2Q5OWRlOTAxZDhhMDVmOTMx","size":7249,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/d891d81bba011a2c7e0d5ccd99de901d8a05f931","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2Uua2VybmVs\nOwoKaW1wb3J0IGphdmEudXRpbC5IYXNoU2V0OwppbXBvcnQgamF2YS51dGls\nLkxpc3Q7CmltcG9ydCBqYXZhLnV0aWwuU2V0OwoKaW1wb3J0IGphdmF4LnBl\ncnNpc3RlbmNlLkVudGl0eU1hbmFnZXI7CmltcG9ydCBqYXZheC5wZXJzaXN0\nZW5jZS5RdWVyeTsKCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5j\nb25mLkpEQkNDb25maWd1cmF0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLmpkYmMuc3FsLkRCRGljdGlvbmFyeTsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS5qZGJjLnNxbC5PcmFjbGVEaWN0aW9uYXJ5OwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNlLkZldGNoUGxhbjsKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5PcGVuSlBBUGVyc2lz\ndGVuY2U7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2Uu\na2VybmVsLmNvbW1vbi5hcHBzLlN0YXRlOwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLnBlcnNpc3RlbmNlLmtlcm5lbC5jb21tb24uYXBwcy5UcmFuc2l0\naW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNlLnRl\nc3QuU2luZ2xlRU1GVGVzdENhc2U7CgovKioKICogVGVzdCBjb21wbGV4IHJl\nbGF0aW9uc2hpcCBncmFwaCBmZXRjaC4KICogVGhlIGdyYXBoIGlzIHJlcHJl\nc2VudGVkIGJ5IFN0YXRlIChub2RlKSBhbmQgVHJhbnNpdGlvbihlZGdlcyku\nCiAqIEdyYXBoIG5vZGVzIChTdGF0ZSkgaG9sZHMgcGFpciBvZiBsaXN0IG9m\nIGluY29taW5nL291dGdvaW5nIGVkZ2VzIChUcmFuc2l0aW9uKS4KICogVGhl\nIHByb2JsZW0gcmVwb3J0IFsxXSBzaG93ZWQgdGhhdCB0cmF2ZXJzYWwgZnJv\nbSBhIHJvb3Qgbm9kZSAoaW5jb3JyZWN0bHkpIHRlcm1pbmF0ZXMKICogYXQg\nYSBkZXB0aCBvZiAxIGlycmVzcGVjdGl2ZSBvZiB0aGUgdmFsdWUgb2YgcmVj\ndXJzaW9uIGRlcHRoIGFuZC9vciBtYXggZGVwdGggZGVwdGguCiAqIAogKiBU\naGUgdGVzdCBkYXRhIG1vZGVsIGlzIG9yaWdpbmFsbHkgcmVwb3J0ZWQgaW4g\nCiAqIFsxXSBGZXRjaEdyb3VwIFJlY3Vyc2lvbiBQcm9ibGVtCiAqIDxBIEhS\nRUY9Imh0dHA6Ly9uMi5uYWJibGUuY29tL0ZldGNoZ3JvdXBzLXJlY3Vyc2lv\nbi1wcm9ibGVtLXRjMzg3NDM4Mi5odG1sI2EzODc0MzgyIj5tYWlsaW5nIGxp\nc3Q8L0E+LgogKiAKICogCiAqIEBhdXRob3IgUGluYWtpIFBvZGRhcgogKgog\nKi8KcHVibGljIGNsYXNzIFRlc3RJbmRpcmVjdFJlY3Vyc2lvbiBleHRlbmRz\nIFNpbmdsZUVNRlRlc3RDYXNlIHsKICAgIC8vIFRoZSBjb25uZWN0aW9uIG1h\ndHJpeAogICAgc3RhdGljIGJ5dGVbXVtdIHRyYW5zaXRpb25zID0geyAKICAg\nICAgLy8gIHMxIHMyIHMzIHM0IHM1ICAgIAogICAgICAgIHsgMCwgMSwgMCwg\nMCwgMCB9LCAvLyBzMSAKICAgICAgICB7IDEsIDAsIDEsIDEsIDAgfSwgLy8g\nczIKICAgICAgICB7IDEsIDEsIDAsIDEsIDAgfSwgLy8gczMKICAgICAgICB7\nIDAsIDAsIDAsIDAsIDEgfSwgLy8gczQKICAgICAgICB7IDAsIDAsIDAsIDAs\nIDAgfSAgLy8gczUKICAgIH07CgogICAgcHVibGljIHZvaWQgc2V0VXAoKSB7\nCiAgICAgICAgc3VwZXIuc2V0VXAoQ0xFQVJfVEFCTEVTLCBTdGF0ZS5jbGFz\ncywgVHJhbnNpdGlvbi5jbGFzcyk7CiAgICAgICAgCiAgICAgICAgREJEaWN0\naW9uYXJ5IGRpY3QgPSAoKEpEQkNDb25maWd1cmF0aW9uKSBlbWYuZ2V0Q29u\nZmlndXJhdGlvbigpKS5nZXREQkRpY3Rpb25hcnlJbnN0YW5jZSgpOwogICAg\nICAgIGlmIChkaWN0IGluc3RhbmNlb2YgT3JhY2xlRGljdGlvbmFyeSkgewog\nICAgICAgICAgICAoKE9yYWNsZURpY3Rpb25hcnkpIGRpY3QpLnVzZVRyaWdn\nZXJzRm9yQXV0b0Fzc2lnbiA9IHRydWU7CiAgICAgICAgfQogICAgfQoKICAg\nIHB1YmxpYyB2b2lkIHRlc3RGZXRjaCgpIHsKICAgICAgICBFbnRpdHlNYW5h\nZ2VyIGVtID0gZW1mLmNyZWF0ZUVudGl0eU1hbmFnZXIoKTsKICAgICAgICBl\nbS5nZXRUcmFuc2FjdGlvbigpLmJlZ2luKCk7CgogICAgICAgIGludCBOID0g\ndHJhbnNpdGlvbnMubGVuZ3RoOwogICAgICAgIFN0YXRlW10gc3RhdGVzID0g\nbmV3IFN0YXRlW05dOwogICAgICAgIC8vIGNyZWF0ZSBub2RlcyAKICAgICAg\nICBmb3IgKGludCBpID0gMTsgaSA8PSBOOyBpKyspIHsKICAgICAgICAgICAg\nU3RhdGUgcyA9IG5ldyBTdGF0ZSgpOwogICAgICAgICAgICBzLnNldE5hbWUo\nInMiICsgaSk7CiAgICAgICAgICAgIGVtLnBlcnNpc3Qocyk7CiAgICAgICAg\nICAgIHN0YXRlc1tpIC0gMV0gPSBzOwogICAgICAgIH0KICAgICAgICAvLyBj\ncmVhdGUgZWRnZXMgYXMgcGVyIHRoZSB0cmFuc2l0aW9uIG1hdHJpeCAKICAg\nICAgICBmb3IgKGludCBpID0gMDsgaSA8IE47IGkrKykgewogICAgICAgICAg\nICBmb3IgKGludCBqID0gMDsgaiA8IE47IGorKykgewogICAgICAgICAgICAg\nICAgaWYgKHRyYW5zaXRpb25zW2ldW2pdID09IDEpIHsKICAgICAgICAgICAg\nICAgICAgICBuZXdUcmFuc2l0aW9uKHN0YXRlc1tpXSwgc3RhdGVzW2pdKTsK\nICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAg\nICAgICBlbS5nZXRUcmFuc2FjdGlvbigpLmNvbW1pdCgpOwoKICAgICAgICBl\nbS5jbGVhcigpOwogICAgICAgIAogICAgICAgIC8vIFNlbGVjdCByb290IChz\ndGF0ZSAxKQogICAgICAgIFF1ZXJ5IHF1ZXJ5ID0gZW0uY3JlYXRlUXVlcnko\nInNlbGVjdCBzIGZyb20gU3RhdGUgcyB3aGVyZSBzLm5hbWU9Om5hbWUiKTsK\nICAgICAgICBGZXRjaFBsYW4gZmV0Y2ggPSBPcGVuSlBBUGVyc2lzdGVuY2Uu\nY2FzdChxdWVyeSkuZ2V0RmV0Y2hQbGFuKCk7CiAgICAgICAgZmV0Y2guc2V0\nTWF4RmV0Y2hEZXB0aCgxNSk7CiAgICAgICAgZmV0Y2guYWRkRmllbGQoU3Rh\ndGUuY2xhc3MsICJpbmNvbWluZ1RyYW5zaXRpb25zIik7CiAgICAgICAgZmV0\nY2guYWRkRmllbGQoU3RhdGUuY2xhc3MsICJvdXRnb2luZ1RyYW5zaXRpb25z\nIik7CiAgICAgICAgZmV0Y2guYWRkRmllbGQoVHJhbnNpdGlvbi5jbGFzcywg\nInRvU3RhdGUiKTsKICAgICAgICBmZXRjaC5hZGRGaWVsZChUcmFuc2l0aW9u\nLmNsYXNzLCAiZnJvbVN0YXRlIik7CiAgICAgICAgU3RhdGUgcXMxID0gKFN0\nYXRlKSBxdWVyeS5zZXRQYXJhbWV0ZXIoIm5hbWUiLCAiczEiKS5nZXRTaW5n\nbGVSZXN1bHQoKTsKCiAgICAgICAgZW0uY2xvc2UoKTsgLy8gd2lsbCBub3Qg\nbG9hZCBhbnl0aGluZyBhbnltb3JlCgogICAgICAgIGJ5dGVbXVtdIGFjdHVh\nbFRyYW5zaXRpb25NYXRyaXggPSBuZXcgYnl0ZVs1XVs1XTsKICAgICAgICBm\naWxsVHJhbnNpdGlvbk1hdHJpeChhY3R1YWxUcmFuc2l0aW9uTWF0cml4LCBu\nZXcgSGFzaFNldDxTdGF0ZT4oKSwgcXMxKTsKICAgICAgICBhc3NlcnRNYXRy\naXhFcXVhbCh0cmFuc2l0aW9ucywgYWN0dWFsVHJhbnNpdGlvbk1hdHJpeCk7\nCgogICAgfQogICAgCiAgICB2b2lkIGFzc2VydE1hdHJpeEVxdWFsKGJ5dGVb\nXVtdIGV4cGVjdGVkLCBieXRlW11bXSBhY3R1YWwpIHsKICAgICAgICBpbnQg\nTiA9IHRyYW5zaXRpb25zLmxlbmd0aDsKICAgICAgICBmb3IgKGludCBpID0g\nMDsgaSA8IE47IGkrKykgewogICAgICAgICAgICBmb3IgKGludCBqID0gMDsg\naiA8IE47IGorKykgewogICAgICAgICAgICAgICAgYXNzZXJ0RXF1YWxzKCJU\ncmFuc2l0aW9uKHMiICsgKGkrMSkgKyAiLCBzIiArIChqKzEpICsgIikgZG9l\ncyBub3QgbWF0Y2giLCBleHBlY3RlZFtpXVtqXSwgYWN0dWFsW2ldW2pdKTsK\nICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICB2b2lkIGZpbGxU\ncmFuc2l0aW9uTWF0cml4KGJ5dGVbXVtdIG1hdHJpeCwgU2V0PFN0YXRlPiB2\naXNpdGVkLCBTdGF0ZSBzKSB7CiAgICAgICAgaWYgKHZpc2l0ZWQuY29udGFp\nbnMocykpCiAgICAgICAgICAgIHJldHVybjsKICAgICAgICBMaXN0PFRyYW5z\naXRpb24+IG91dGdvaW5ncyA9IHMuZ2V0T3V0Z29pbmdUcmFuc2l0aW9ucygp\nOwogICAgICAgIGlmIChvdXRnb2luZ3MgIT0gbnVsbCkgewogICAgICAgICAg\nICBmb3IgKFRyYW5zaXRpb24gdCA6IG91dGdvaW5ncykgewogICAgICAgICAg\nICAgICAgZmlsbFRyYW5zaXRpb25NYXRyaXgobWF0cml4LCB0KTsKICAgICAg\nICAgICAgfQogICAgICAgIH0KICAgICAgICB2aXNpdGVkLmFkZChzKTsKCiAg\nICAgICAgaWYgKG91dGdvaW5ncyAhPSBudWxsKSB7CiAgICAgICAgICAgIGZv\nciAoVHJhbnNpdGlvbiB0IDogb3V0Z29pbmdzKSB7CiAgICAgICAgICAgICAg\nICBmaWxsVHJhbnNpdGlvbk1hdHJpeChtYXRyaXgsIHZpc2l0ZWQsIHQuZ2V0\nVG9TdGF0ZSgpKTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICB9Cgog\nICAgdm9pZCBmaWxsVHJhbnNpdGlvbk1hdHJpeChieXRlW11bXSBtYXRyaXgs\nIFRyYW5zaXRpb24gdCkgewogICAgICAgIG1hdHJpeFtnZXRJbmRleCh0Lmdl\ndEZyb21TdGF0ZSgpKV1bZ2V0SW5kZXgodC5nZXRUb1N0YXRlKCkpXSA9IDE7\nCiAgICB9CgogICAgaW50IGdldEluZGV4KFN0YXRlIHMpIHsKICAgICAgICBy\nZXR1cm4gSW50ZWdlci5wYXJzZUludChzLmdldE5hbWUoKS5zdWJzdHJpbmco\nMSkpIC0gMTsKICAgIH0KCiAgICBUcmFuc2l0aW9uIG5ld1RyYW5zaXRpb24o\nU3RhdGUgZnJvbSwgU3RhdGUgdG8pIHsKICAgICAgICBUcmFuc2l0aW9uIHQg\nPSBuZXcgVHJhbnNpdGlvbigpOwogICAgICAgIHQuc2V0RnJvbVN0YXRlKGZy\nb20pOwogICAgICAgIHQuc2V0VG9TdGF0ZSh0byk7CiAgICAgICAgdC5zZXRO\nYW1lKGZyb20uZ2V0TmFtZSgpKyItPiIrdG8uZ2V0TmFtZSgpKTsKICAgICAg\nICBmcm9tLmFkZE91dGdvaW5nVHJhbnNpdGlvbnModCk7CiAgICAgICAgdG8u\nYWRkSW5jb21pbmdUcmFuc2l0aW9ucyh0KTsKICAgICAgICByZXR1cm4gdDsK\nICAgIH0KCiAgICAvKioKICAgICAqIEZpbmQgYSBzdGF0ZSBvZiB0aGUgZ2l2\nZW4gbmFtZSBpbiB0aGUgbGlzdCBvZiBvdXRnb2luZyB0cmFuc2l0aW9uIG9m\nIHRoZQogICAgICogZ2l2ZW4gU3RhdGUuCiAgICAgKi8KICAgIFN0YXRlIGZp\nbmRPdXRnb2luZ1N0YXRlKFN0cmluZyBuYW1lLCBTdGF0ZSByb290KSB7CiAg\nICAgICAgTGlzdDxUcmFuc2l0aW9uPiB0cmFuc2l0aW9ucyA9IHJvb3QuZ2V0\nT3V0Z29pbmdUcmFuc2l0aW9ucygpOwogICAgICAgIGZvciAoVHJhbnNpdGlv\nbiB0IDogdHJhbnNpdGlvbnMpIHsKICAgICAgICAgICAgaWYgKHQuZ2V0VG9T\ndGF0ZSgpLmdldE5hbWUoKS5lcXVhbHMobmFtZSkpCiAgICAgICAgICAgICAg\nICByZXR1cm4gdC5nZXRUb1N0YXRlKCk7CiAgICAgICAgfQogICAgICAgIHJl\ndHVybiBudWxsOwogICAgfQoKICAgIC8qKgogICAgICogRmluZCBhIHN0YXRl\nIG9mIHRoZSBnaXZlbiBuYW1lIGluIHRoZSBsaXN0IG9mIGluY29taW5nIHRy\nYW5zaXRpb24gb2YgdGhlCiAgICAgKiBnaXZlbiBTdGF0ZS4KICAgICAqLwog\nICAgU3RhdGUgZmluZEluY29taW5nU3RhdGUoU3RyaW5nIG5hbWUsIFN0YXRl\nIHJvb3QpIHsKICAgICAgICBMaXN0PFRyYW5zaXRpb24+IHRyYW5zaXRpb25z\nID0gcm9vdC5nZXRJbmNvbWluZ1RyYW5zaXRpb25zKCk7CiAgICAgICAgZm9y\nIChUcmFuc2l0aW9uIHQgOiB0cmFuc2l0aW9ucykgewogICAgICAgICAgICBp\nZiAodC5nZXRGcm9tU3RhdGUoKS5nZXROYW1lKCkuZXF1YWxzKG5hbWUpKQog\nICAgICAgICAgICAgICAgcmV0dXJuIHQuZ2V0RnJvbVN0YXRlKCk7CiAgICAg\nICAgfQogICAgICAgIHJldHVybiBudWxsOwogICAgfQoKICAgIC8qKgogICAg\nICogQXNzZXJ0cyB0aGUgdGhlIG9yaWdpbiBzdGF0ZSBoYXMgdGhlIGdpdmVu\nIGluY29taW5nIHN0YXRlcy4KICAgICAqLwogICAgdm9pZCBhc3NlcnRJbmNv\nbWluZ1N0YXRlcyhTdGF0ZSBvcmlnaW4sIFN0YXRlLi4uIGV4cGVjdGVkKSB7\nCiAgICAgICAgYXNzZXJ0Tm90TnVsbChvcmlnaW4pOwogICAgICAgIGZvciAo\nU3RhdGUgZSA6IGV4cGVjdGVkKSB7CiAgICAgICAgICAgIGFzc2VydE5vdE51\nbGwoZSArICIgaW4gbm90IGFuIGluY29pbW5nIHN0YXRlcyBvZiAiICsgb3Jp\nZ2luLCBmaW5kSW5jb21pbmdTdGF0ZShlLmdldE5hbWUoKSwgb3JpZ2luKSk7\nCiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogQXNzZXJ0cyB0aGUg\ndGhlIG9yaWdpbiBzdGF0ZSBoYXMgdGhlIGdpdmVuIG91dGdvaW5nIHN0YXRl\ncy4KICAgICAqLwogICAgdm9pZCBhc3NlcnRPdXRnb2luZ1N0YXRlcyhTdGF0\nZSBvcmlnaW4sIFN0YXRlLi4uIGV4cGVjdGVkKSB7CiAgICAgICAgYXNzZXJ0\nTm90TnVsbChvcmlnaW4pOwogICAgICAgIGZvciAoU3RhdGUgZSA6IGV4cGVj\ndGVkKSB7CiAgICAgICAgICAgIGFzc2VydE5vdE51bGwoZSArICIgaW4gbm90\nIGFuIGluY29pbW5nIHN0YXRlcyBvZiAiICsgb3JpZ2luLCBmaW5kT3V0Z29p\nbmdTdGF0ZShlLmdldE5hbWUoKSwgb3JpZ2luKSk7CiAgICAgICAgfQogICAg\nfQp9Cg==\n","encoding":"base64"}

