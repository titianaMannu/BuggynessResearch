{"sha":"4e8cc9b515c0c9ed2032c06e120a8ef8d9fbe15e","node_id":"MDQ6QmxvYjIwNjM2NDo0ZThjYzliNTE1YzBjOWVkMjAzMmMwNmUxMjBhOGVmOGQ5ZmJlMTVl","size":15220,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/4e8cc9b515c0c9ed2032c06e120a8ef8d9fbe15e","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNr\nYWdlIG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5sb2NrLmV4dGVu\nZGVkOwoKaW1wb3J0IGphdmEuaW8uUHJpbnRXcml0ZXI7CmltcG9ydCBqYXZh\nLmlvLlN0cmluZ1dyaXRlcjsKaW1wb3J0IGphdmEudXRpbC5BcnJheUxpc3Q7\nCmltcG9ydCBqYXZhLnV0aWwuSGFzaE1hcDsKaW1wb3J0IGphdmEudXRpbC5M\naXN0OwppbXBvcnQgamF2YS51dGlsLk1hcDsKCmltcG9ydCBqYXZheC5wZXJz\naXN0ZW5jZS5FbnRpdHlNYW5hZ2VyOwppbXBvcnQgamF2YXgucGVyc2lzdGVu\nY2UuTG9ja01vZGVUeXBlOwppbXBvcnQgamF2YXgucGVyc2lzdGVuY2UuUGVz\nc2ltaXN0aWNMb2NrU2NvcGU7CmltcG9ydCBqYXZheC5wZXJzaXN0ZW5jZS5R\ndWVyeTsKCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5jb25mLkpE\nQkNDb25maWd1cmF0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpk\nYmMuY29uZi5KREJDQ29uZmlndXJhdGlvbkltcGw7CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEubGliLmxvZy5Mb2c7CmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEucGVyc2lzdGVuY2UuTWl4ZWRMb2NrTGV2ZWxzSGVscGVyOwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNlLk9wZW5KUEFFbnRp\ndHlNYW5hZ2VyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNpc3Rl\nbmNlLnRlc3QuU1FMTGlzdGVuZXJUZXN0Q2FzZTsKCi8qKgogKiBCYXNlIGNs\nYXNzIGZvciBsb2NraW5nIGV4dGVuZGVkIHNjb3BlIHRlc3RzLgogKgogKiBU\nZXN0IEpQQSAyLjAgRU0gaW50ZXJmYWNlIG5vcm1hbCBsb2NrIHNjb3BlIGJl\naGF2aW9ycyB3aXRoICJtaXhlZCIgbG9jawogKiBtYW5hZ2VyLiBXaGVuIGFu\nIGVudGl0eSBpbnN0YW5jZSBpcyBsb2NrZWQgdXNpbmcgcGVzc2ltaXN0aWMg\nbG9ja2luZywgdGhlCiAqIHBlcnNpc3RlbmNlIHByb3ZpZGVyIG11c3QgbG9j\nayB0aGUgZGF0YWJhc2Ugcm93KHMpIHRoYXQgY29ycmVzcG9uZCB0byB0aGUK\nICogbm9uLWNvbGxlY3Rpb24tdmFsdWVkIHBlcnNpc3RlbnQgc3RhdGUgb2Yg\ndGhhdCBpbnN0YW5jZS4gSWYgYSBqb2luZWQKICogaW5oZXJpdGFuY2Ugc3Ry\nYXRlZ3kgaXMgdXNlZCwgb3IgaWYgdGhlIGVudGl0eSBpcyBvdGhlcndpc2Ug\nbWFwcGVkIHRvIGEKICogc2Vjb25kYXJ5IHRhYmxlLCB0aGlzIGVudGFpbHMg\nbG9ja2luZyB0aGUgcm93KHMpIGZvciB0aGUgZW50aXR5IGluc3RhbmNlIGlu\nCiAqIHRoZSBhZGRpdGlvbmFsIHRhYmxlKHMpLiBFbnRpdHkgcmVsYXRpb25z\naGlwcyBmb3Igd2hpY2ggdGhlIGxvY2tlZCBlbnRpdHkKICogY29udGFpbnMg\ndGhlIGZvcmVpZ24ga2V5IHdpbGwgYWxzbyBiZSBsb2NrZWQsIGJ1dCBub3Qg\ndGhlIHN0YXRlIG9mIHRoZQogKiByZWZlcmVuY2VkIGVudGl0aWVzICh1bmxl\nc3MgaG9zZSBlbnRpdGllcyBhcmUgZXhwbGljaXRseSBsb2NrZWQpLiBFbGVt\nZW50CiAqIGNvbGxlY3Rpb25zIGFuZCByZWxhdGlvbnNoaXBzIGZvciB3aGlj\naCB0aGUgZW50aXR5IGRvZXMgbm90IGNvbnRhaW4gdGhlCiAqIGZvcmVpZ24g\na2V5IChzdWNoIGFzIHJlbGF0aW9uc2hpcHMgdGhhdCBhcmUgbWFwcGVkIHRv\nIGpvaW4gdGFibGVzIG9yCiAqIHVuaWRpcmVjdGlvbmFsIG9uZS10by1tYW55\nIHJlbGF0aW9uc2hpcHMgZm9yIHdoaWNoIHRoZSB0YXJnZXQgZW50aXR5IGNv\nbnRhaW5zCiAqIHRoZSBmb3JlaWduIGtleSkgd2lsbCBub3QgYmUgbG9ja2Vk\nIGJ5IGRlZmF1bHQuCiAqCiAqIEVsZW1lbnQgY29sbGVjdGlvbnMgYW5kIHJl\nbGF0aW9uc2hpcHMgb3duZWQgYnkgdGhlIGVudGl0eSB0aGF0IGFyZSBjb250\nYWluZWQKICogaW4gam9pbiB0YWJsZXMgd2lsbCBiZSBsb2NrZWQgaWYgdGhl\nIGphdmF4LnBlcnNpc3RlbmNlLmxvY2suc2NvcGUgcHJvcGVydHkgaXMKICog\nc3BlY2lmaWVkIHdpdGggYSB2YWx1ZSBvZiBQZXNzaW1pc3RpY0xvY2tTY29w\nZS5FWFRFTkRFRC4gVGhlIHN0YXRlIG9mCiAqIGVudGl0aWVzIHJlZmVyZW5j\nZWQgYnkgc3VjaCByZWxhdGlvbnNoaXBzIHdpbGwgbm90IGJlIGxvY2tlZCAo\ndW5sZXNzIHRob3NlCiAqIGVudGl0aWVzIGFyZSBleHBsaWNpdGx5IGxvY2tl\nZCkuIFRoaXMgcHJvcGVydHkgbWF5IGJlIHBhc3NlZCBhcyBhbiBhcmd1bWVu\ndAogKiB0byB0aGUgbWV0aG9kcyBvZiB0aGUgRW50aXR5TWFuYWdlciBhbmQg\nUXVlcnkgaW50ZXJmYWNlcyB0aGF0IGFsbG93IGxvY2sKICogbW9kZXMgdG8g\nYmUgc3BlY2lmaWVkIG9yIHVzZWQgd2l0aCB0aGUgTmFtZWRRdWVyeSBhbm5v\ndGF0aW9uLgogKiAKICogQHNpbmNlIDIuMAogKi8KcHVibGljIGFic3RyYWN0\nIGNsYXNzIExvY2tTY29wZVRlc3RDYXNlIGV4dGVuZHMgU1FMTGlzdGVuZXJU\nZXN0Q2FzZSB7CiAgICAKICAgIHByb3RlY3RlZCBmaW5hbCBTdHJpbmcgQW55\nICAgICAgICAgICAgICA9ICIuKiI7CiAgICBwcm90ZWN0ZWQgZmluYWwgU3Ry\naW5nIFNlbGVjdCAgICAgICAgICAgPSAiU0VMRUNULipGUk9NLioiOwogICAg\ncHJvdGVjdGVkIGZpbmFsIFN0cmluZyBTZWxlY3RWZXJzaW9uICAgID0gIlNF\nTEVDVC4qdmVyc2lvbi4qRlJPTS4qIjsKICAgIHByb3RlY3RlZCBmaW5hbCBT\ndHJpbmcgV2hlcmUgICAgICAgICAgICA9ICIuKldIRVJFLioiOwovLyAgICBw\ncm90ZWN0ZWQgZmluYWwgU3RyaW5nIEpvaW4gICAgICAgICAgICAgPSAiLioo\nSk9JTil7MX0uKiI7CiAgICBwcm90ZWN0ZWQgZmluYWwgU3RyaW5nIE5vSm9p\nbiAgICAgICAgICAgPSAiKEpPSU4pezB9IjsKICAgIHByb3RlY3RlZCBmaW5h\nbCBTdHJpbmcgRm9yVXBkYXRlUmV4ICAgICA9ICJGT1IgVVBEQVRFLioiOwog\nICAgcHJvdGVjdGVkIGZpbmFsIFN0cmluZyBGb3JVcGRhdGVDbGF1c2UgID0g\nIigiICsgRm9yVXBkYXRlUmV4ICsgIikiOwogICAgcHJvdGVjdGVkIGZpbmFs\nIFN0cmluZyBGb3JVcGRhdGUgICAgICAgID0gRm9yVXBkYXRlQ2xhdXNlICsg\nInsxfSI7CiAgICBwcm90ZWN0ZWQgZmluYWwgU3RyaW5nIE5vRm9yVXBkYXRl\nICAgICAgPSBGb3JVcGRhdGVDbGF1c2UgKyAiezB9IjsKICAgIHByb3RlY3Rl\nZCBmaW5hbCBTdHJpbmcgREIyTG9ja0NsYXVzZSAgICA9ICIoIiArIEZvclVw\nZGF0ZVJleCArCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAifEZPUiBSRUFEIE9OTFkgV0lUSCBSLiBVU0UgQU5EIEtF\nRVAgKFVQREFURXxFWENMVVNJVkUpIExPQ0tTKSI7CiAgICBwcm90ZWN0ZWQg\nZmluYWwgU3RyaW5nIERCMkxvY2sgICAgICAgICAgPSBEQjJMb2NrQ2xhdXNl\nICsgInsxfSI7IAogICAgcHJvdGVjdGVkIGZpbmFsIFN0cmluZyBOb0RCMkxv\nY2sgICAgICAgID0gREIyTG9ja0NsYXVzZSArICJ7MH0iOyAKCiAgICBwcm90\nZWN0ZWQgTGlzdDxTdHJpbmc+IGVtcFRhYmxlTmFtZSA9IG5ldyBBcnJheUxp\nc3Q8U3RyaW5nPigpOzsKCiAgICBwcm90ZWN0ZWQgTWFwPFN0cmluZywgT2Jq\nZWN0PiBub3JtYWxQcm9wczsKICAgIHByb3RlY3RlZCBNYXA8U3RyaW5nLCBP\nYmplY3Q+IGV4dGVuZGVkUHJvcHM7CgogICAgcHJvdGVjdGVkIHZvaWQgY29t\nbW9uU2V0VXAoQ2xhc3M8Pz4uLi4gZUNsYXNzZXMgKSB7CiAgICAgICAgbm9y\nbWFsUHJvcHMgPSBuZXcgSGFzaE1hcDxTdHJpbmcsIE9iamVjdD4oKTsKICAg\nICAgICBleHRlbmRlZFByb3BzID0gbmV3IEhhc2hNYXA8U3RyaW5nLCBPYmpl\nY3Q+KCk7CiAgICAgICAgZXh0ZW5kZWRQcm9wcy5wdXQoImphdmF4LnBlcnNp\nc3RlbmNlLmxvY2suc2NvcGUiLCBQZXNzaW1pc3RpY0xvY2tTY29wZS5FWFRF\nTkRFRCk7CgogICAgICAgIGZvciggQ2xhc3M8Pz4gZUNsYXp6IDogZUNsYXNz\nZXMpIHsKICAgICAgICAgICAgZW1wVGFibGVOYW1lLmFkZChnZXRNYXBwaW5n\nKGVDbGF6eikuZ2V0VGFibGUoKS5nZXRGdWxsTmFtZSgpKTsKICAgICAgICB9\nCiAgICAgICAgY2xlYW51cERCKCk7CiAgICB9CgogICAgcHJpdmF0ZSB2b2lk\nIGNsZWFudXBEQigpIHsKICAgICAgICBFbnRpdHlNYW5hZ2VyIGVtID0gbnVs\nbDsKICAgICAgICB0cnkgewogICAgICAgICAgICBlbSA9IGVtZi5jcmVhdGVF\nbnRpdHlNYW5hZ2VyKCk7CiAgICAgICAgICAgIGVtLmdldFRyYW5zYWN0aW9u\nKCkuYmVnaW4oKTsKICAgICAgICAgICAgZm9yIChTdHJpbmcgdGFibGVOYW1l\nIDogZW1wVGFibGVOYW1lLnRvQXJyYXkobmV3IFN0cmluZ1tlbXBUYWJsZU5h\nbWUuc2l6ZSgpXSkpIHsKICAgICAgICAgICAgICAgIGVtLmNyZWF0ZVF1ZXJ5\nKCJkZWxldGUgZnJvbSAiICsgdGFibGVOYW1lKS5leGVjdXRlVXBkYXRlKCk7\nCiAgICAgICAgICAgIH0KICAgICAgICAgICAgZW0uZ2V0VHJhbnNhY3Rpb24o\nKS5jb21taXQoKTsKICAgICAgICB9IGNhdGNoKEV4Y2VwdGlvbiBlKSB7CiAg\nICAgICAgICAgIGUucHJpbnRTdGFja1RyYWNlKCk7CiAgICAgICAgfSBmaW5h\nbGx5IHsKICAgICAgICAgICAgaWYgKGVtICE9IG51bGwgJiYgZW0uaXNPcGVu\nKCkpIHsKICAgICAgICAgICAgICAgIGVtLmNsb3NlKCk7CiAgICAgICAgICAg\nIH0KICAgICAgICB9CiAgICB9CgogICAgcHJvdGVjdGVkIGVudW0gREJUeXBl\nIHsKICAgICAgICBhY2Nlc3MsIGRiMiwgZGVyYnksIGVtcHJlc3MsIGZveHBy\nbywgaDIsIGhzcWwsIGluZm9ybWl4LCBpbmdyZXMsIGpkYXRhc3RvcmUsIG15\nc3FsLCBvcmFjbGUsIHBvaW50YmFzZSwgcG9zdGdyZXMsCiAgICAgICAgc3Fs\nc2VydmVyLCBzeWJhc2UKICAgIH07CgogICAgcHJvdGVjdGVkIERCVHlwZSBn\nZXREQlR5cGUoRW50aXR5TWFuYWdlciBlbSkgewogICAgICAgIEpEQkNDb25m\naWd1cmF0aW9uSW1wbCBjb25mID0gKEpEQkNDb25maWd1cmF0aW9uSW1wbCkg\nZ2V0Q29uZmlndXJhdGlvbihlbSk7CiAgICAgICAgU3RyaW5nIGRpY3RDbGFz\nc05hbWUgPSBnZXRDb25maWd1cmF0aW9uKGVtKS5nZXREQkRpY3Rpb25hcnlJ\nbnN0YW5jZSgpLmdldENsYXNzKCkuZ2V0TmFtZSgpOwogICAgICAgIFN0cmlu\nZyBkYiA9IGNvbmYuZGJkaWN0aW9uYXJ5UGx1Z2luLmFsaWFzKGRpY3RDbGFz\nc05hbWUpOwogICAgICAgIHJldHVybiBEQlR5cGUudmFsdWVPZihkYik7CiAg\nICB9CgogICAgQFN1cHByZXNzV2FybmluZ3MoIHsgInVudXNlZCIsICJkZXBy\nZWNhdGlvbiIgfSkKICAgIHByb3RlY3RlZCBKREJDQ29uZmlndXJhdGlvbiBn\nZXRDb25maWd1cmF0aW9uKEVudGl0eU1hbmFnZXIgZW0pIHsKICAgICAgICBy\nZXR1cm4gKChKREJDQ29uZmlndXJhdGlvbikgKChPcGVuSlBBRW50aXR5TWFu\nYWdlcikgZW0pLmdldENvbmZpZ3VyYXRpb24oKSk7CiAgICB9CgogICAgcHJv\ndGVjdGVkIExvZyBnZXRMb2coKSB7CiAgICAgICAgcmV0dXJuIGVtZi5nZXRD\nb25maWd1cmF0aW9uKCkuZ2V0TG9nKCJUZXN0cyIpOwogICAgfQoKICAgIHBy\nb3RlY3RlZCBMb2cgZ2V0RHVtcFN0YWNrTG9nKCkgewogICAgICAgIHJldHVy\nbiBlbWYuZ2V0Q29uZmlndXJhdGlvbigpLmdldExvZygiRHVtcFN0YWNrIik7\nCiAgICB9CgogICAgLyoKICAgICAqIFNldCBMb2c9TG9ja1Rlc3RTUUw9VFJB\nQ0UgdG8gZHVtcCB0aGUgU1FMIGNhdWdodCBieSB0aGUgU1FMIGxpc3RlbmVy\nIGJ1dCBkbyBub3QgcGVyZm9ybSBTUUwgYXNzZXJ0aW9uLgogICAgICovCiAg\nICBwcm90ZWN0ZWQgTG9nIGdldER1bXBTUUxMb2coKSB7CiAgICAgICAgcmV0\ndXJuIGVtZi5nZXRDb25maWd1cmF0aW9uKCkuZ2V0TG9nKCJMb2NrVGVzdFNR\nTCIpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIGFzc2VydExvY2tUZXN0U1FM\ncyhTdHJpbmcuLi4gZXhwZWN0ZWQpIHsKICAgICAgICBMb2cgbG9nID0gZ2V0\nRHVtcFNRTExvZygpOyAKICAgICAgICBpZiggbG9nLmlzVHJhY2VFbmFibGVk\nKCkpIHsKICAgICAgICAgICAgbG9nLnRyYWNlKCJcclxuIiArIHRvU3RyaW5n\nKHNxbCkpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAg\nIGFzc2VydEFsbFNRTEFueU9yZGVyKGV4cGVjdGVkKTsKICAgIH0KICAgIAog\nICAgcHVibGljIHZvaWQgYXNzZXJ0TG9ja1Rlc3ROb1NRTHMoU3RyaW5nLi4u\nIGV4cGVjdGVkKSB7CiAgICAgICAgTG9nIGxvZyA9IGdldER1bXBTUUxMb2co\nKTsgCiAgICAgICAgaWYoIGxvZy5pc1RyYWNlRW5hYmxlZCgpKSB7CiAgICAg\nICAgICAgIGxvZy50cmFjZSgiXHJcbiIgKyB0b1N0cmluZyhzcWwpKTsKICAg\nICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICBhc3NlcnROb25l\nU1FMQW55T3JkZXIoZXhwZWN0ZWQpOwogICAgfQoKICAgIHByb3RlY3RlZCB2\nb2lkIGxvZ1N0YWNrKFRocm93YWJsZSB0KSB7CiAgICAgICAgU3RyaW5nV3Jp\ndGVyIHN0ciA9IG5ldyBTdHJpbmdXcml0ZXIoKTsKICAgICAgICBQcmludFdy\naXRlciBwcmludCA9IG5ldyBQcmludFdyaXRlcihzdHIpOwogICAgICAgIHQu\ncHJpbnRTdGFja1RyYWNlKHByaW50KTsKICAgICAgICBnZXREdW1wU3RhY2tM\nb2coKS50cmFjZShzdHIudG9TdHJpbmcoKSk7CiAgICB9CgogICAgLy8gSWQg\nZGVzaWduYXRpb24tCiAgICAvLyBmb3IgYmFzaWMgdGVzdDoKICAgIC8vICAg\nICAgW2Jhc2ljPTAsc2VjdGFibGU9MSxzaW5nbGV0YWJsZT0yLGpvaW49NCxl\nbGVDb2xsPTUsZWxlQ29sbEVhZ2VyPTZdW25vcm1hbD0wfGV4dGVuZGVkPTFd\nW2VudGl0eSNdCiAgICAvLyBGb3IgMXgxLzF4bSB0ZXN0czoKICAgIC8vICAg\nICAgWzF4MT0xLDF4TT0yXSBbdW5pPTF8Ymk9Ml0gW2xlZnQ9MXxyaWdodD0y\nXSBbbm9ybWFsPTF8am9pbj0yXSBbZGVmYXVsdD0wfGxhenk9MXxlYWdlcj0y\nXSAKICAgIC8vICAgICAgICAgIFtub3JtYWw9MHxleHRlbmRlZD0xXSBbbi10\naCBlbnRpdHldCiAgICBwcm90ZWN0ZWQgPFQ+IHZvaWQgY29tbW9uTG9ja1Rl\nc3QoU3RyaW5nIHRlc3ROYW1lLCBDbGFzczxUPiB0eXBlLCBpbnQgaWQwLCBi\nb29sZWFuIGV4dGVuZGVkLCBTdHJpbmcgcXVlcnlTdHJpbmcsCiAgICAgICAg\nICAgIFN0cmluZyBuYW1lZFF1ZXJ5U3RyaW5nLCBBc3NlcnRDYWxsYmFjayB2\nZXJpZnkpIHsKICAgICAgICBnZXRMb2coKS5pbmZvKCIqKiAiICsgdGVzdE5h\nbWUgKyAiKCkiKTsKICAgICAgICBTdHJpbmcgZW50aXR5TmFtZSA9IHR5cGUu\nZ2V0TmFtZSgpOwogICAgICAgIFN0cmluZyBzY29wZSA9IGV4dGVuZGVkID8g\nIkV4dGVuZGVkIiA6ICJOb3JtYWwiOwogICAgICAgIE1hcDxTdHJpbmcsIE9i\namVjdD4gcHJvcHMgPSBleHRlbmRlZCA/IGV4dGVuZGVkUHJvcHMgOiBub3Jt\nYWxQcm9wczsKICAgICAgICBpbnQgaWQxID0gaWQwICsgMTsKCiAgICAgICAg\nRW50aXR5TWFuYWdlciBlbSA9IG51bGw7CiAgICAgICAgVCBlMCA9IG51bGw7\nCiAgICAgICAgVCBlMSA9IG51bGw7CiAgICAgICAgdHJ5IHsKICAgICAgICAg\nICAgZ2V0TG9nKCkuaW5mbygiLS0gVGVzdCBmaW5kIHdpdGggbm8gbG9jayBp\nbiAiICsgc2NvcGUgKyAiIHNjb3BlIik7CiAgICAgICAgICAgIGVtID0gZW1m\nLmNyZWF0ZUVudGl0eU1hbmFnZXIoKTsKICAgICAgICAgICAgZ2V0TG9nKCku\naW5mbygiICpCZWdpbiBhIHRyYW5zYWN0aW9uLiIpOwogICAgICAgICAgICBl\nbS5nZXRUcmFuc2FjdGlvbigpLmJlZ2luKCk7CiAgICAgICAgICAgIHJlc2V0\nU1FMKCk7CiAgICAgICAgICAgIGdldExvZygpLmluZm8oIiAqRmluZCAiICsg\nZW50aXR5TmFtZSArICIoIiArIGlkMCArICIpIHdpdGggbm8gbG9jayIpOwog\nICAgICAgICAgICBlMCA9IGVtLmZpbmQodHlwZSwgaWQwLCBwcm9wcyk7CiAg\nICAgICAgICAgIGdldExvZygpLmluZm8oIiAqIiArIChlMCAhPSBudWxsID8g\nIkYiIDogIkNhbiBub3QgZiIpICsgImluZCBlbnRpdHkiKTsKICAgICAgICAg\nICAgdmVyaWZ5LmZpbmROb0xvY2tEYlNRTChlbSk7CiAgICAgICAgICAgIGdl\ndExvZygpLmluZm8oIiAqRm91bmQgZW50aXR5OiIgKyBlMCk7CiAgICAgICAg\nICAgIGFzc2VydE5vdE51bGwoIiAqRm91bmQgIiArIGVudGl0eU5hbWUgKyAi\nKCIgKyBpZDAgKyAiKSIsIGUwKTsKICAgICAgICAgICAgYXNzZXJ0RXF1YWxz\nKCIgKkFzc2VydCBubyBsb2NrIGFwcGxpZWQiLCBMb2NrTW9kZVR5cGUuTk9O\nRSwgZW0uZ2V0TG9ja01vZGUoZTApKTsKCiAgICAgICAgICAgIGdldExvZygp\nLmluZm8oIiAqRmluZCAiICsgZW50aXR5TmFtZSArICIoIiArIGlkMSArICIp\nIHdpdGggcGVzc2ltaXN0aWMgZm9yY2UgaW5jcmVtZW50IGxvY2siKTsKICAg\nICAgICAgICAgcmVzZXRTUUwoKTsKICAgICAgICAgICAgZTEgPSBlbS5maW5k\nKHR5cGUsIGlkMSwgTG9ja01vZGVUeXBlLlBFU1NJTUlTVElDX0ZPUkNFX0lO\nQ1JFTUVOVCwgcHJvcHMpOwogICAgICAgICAgICBnZXRMb2coKS5pbmZvKCIg\nKiIgKyAoZTEgIT0gbnVsbCA/ICJGIiA6ICJDYW4gbm90IGYiKSArICJpbmQg\nZW50aXR5Iik7CiAgICAgICAgICAgIHZlcmlmeS5maW5kUGVzc2ltaXN0aWNG\nb3JjSW5jRGJTUUwoZW0pOwogICAgICAgICAgICBnZXRMb2coKS5pbmZvKCIg\nKkZvdW5kIGVudGl0eToiICsgZTEpOwogICAgICAgICAgICBhc3NlcnROb3RO\ndWxsKCIgKkZvdW5kICIgKyBlbnRpdHlOYW1lICsgIigiICsgaWQxICsgIiki\nLCBlMSk7CiAgICAgICAgICAgIGFzc2VydEVxdWFscygiICpBc3NlcnQgcGVz\nc2ltaXN0aWMgZm9yY2UgaW5jcmVtZW50IGxvY2sgYXBwbGllZCIsIExvY2tN\nb2RlVHlwZS5QRVNTSU1JU1RJQ19GT1JDRV9JTkNSRU1FTlQsCiAgICAgICAg\nICAgICAgICAgICAgZW0uZ2V0TG9ja01vZGUoZTEpKTsKCiAgICAgICAgICAg\nIGdldExvZygpLmluZm8oIkNvbW1pdHRpbmcgdHJhbnNhY3Rpb24uIik7CiAg\nICAgICAgICAgIGVtLmdldFRyYW5zYWN0aW9uKCkuY29tbWl0KCk7CiAgICAg\nICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgZW0gPSBudWxsOwogICAgICAg\nICAgICBlMCA9IGUxID0gbnVsbDsKICAgICAgICAgICAgaWYgKGVtICE9IG51\nbGwgJiYgZW0uaXNPcGVuKCkpIHsKICAgICAgICAgICAgICAgIGVtLmNsb3Nl\nKCk7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHRyeSB7CiAg\nICAgICAgICAgIGdldExvZygpLmluZm8oIi0tIFRlc3QgcXVlcnkgd2l0aCBw\nZXNzaW1pc3RpYyByZWFkIGxvY2sgaW4gIiArIHNjb3BlICsgIiBzY29wZSIp\nOwogICAgICAgICAgICBlbSA9IGVtZi5jcmVhdGVFbnRpdHlNYW5hZ2VyKCk7\nCiAgICAgICAgICAgIGdldExvZygpLmluZm8oIiAqQmVnaW4gYSB0cmFuc2Fj\ndGlvbi4iKTsKICAgICAgICAgICAgZW0uZ2V0VHJhbnNhY3Rpb24oKS5iZWdp\nbigpOwogICAgICAgICAgICByZXNldFNRTCgpOwogICAgICAgICAgICBpbnQg\nYmVmb3JlUmVhZExldmVsID0gZ2V0Q29uZmlndXJhdGlvbihlbSkuZ2V0UmVh\nZExvY2tMZXZlbENvbnN0YW50KCk7CiAgICAgICAgICAgIExvY2tNb2RlVHlw\nZSBiZWZvcmVSZWFkTW9kZSA9IE1peGVkTG9ja0xldmVsc0hlbHBlci5mcm9t\nTG9ja0xldmVsKGJlZm9yZVJlYWRMZXZlbCk7CiAgICAgICAgICAgIGdldExv\nZygpLmluZm8oIiAqU2F2ZSBSZWFkTG9ja0xldmVsIGJlZm9yZSBRdWVyeToi\nICsgYmVmb3JlUmVhZE1vZGUpOwogICAgICAgICAgICBnZXRMb2coKS5pbmZv\nKCIgKlF1ZXJ5ICIgKyBlbnRpdHlOYW1lICsgIigiICsgaWQwICsgIikgd2l0\naCBQRVNTSU1JU1RJQ19SRUFEIGxvY2siKTsKICAgICAgICAgICAgUXVlcnkg\ncSA9IGVtLmNyZWF0ZVF1ZXJ5KHF1ZXJ5U3RyaW5nKTsKICAgICAgICAgICAg\naWYgKGV4dGVuZGVkKSB7CiAgICAgICAgICAgICAgICBxID0gcS5zZXRIaW50\nKCJqYXZheC5wZXJzaXN0ZW5jZS5sb2NrLnNjb3BlIiwgUGVzc2ltaXN0aWNM\nb2NrU2NvcGUuRVhURU5ERUQpOwogICAgICAgICAgICB9CiAgICAgICAgICAg\nIHEgPSBxLnNldExvY2tNb2RlKExvY2tNb2RlVHlwZS5QRVNTSU1JU1RJQ19S\nRUFEKTsKICAgICAgICAgICAgcSA9IHEuc2V0UGFyYW1ldGVyKCJmaXJzdE5h\nbWUiLCAiZmlyc3ROYW1lJSIgKyBpZDApOwogICAgICAgICAgICBMaXN0PFQ+\nIGVzID0gcS5nZXRSZXN1bHRMaXN0KCk7CiAgICAgICAgICAgIGdldExvZygp\nLmluZm8oIiAqRm91bmQgIiArIGVzLnNpemUoKSArICIgZW50aXR5Iik7CiAg\nICAgICAgICAgIGFzc2VydEVxdWFscygiICpTaG91bGQgZmluZCAxIGVudGl0\neSIsIGVzLnNpemUoKSwgMSk7CiAgICAgICAgICAgIHZlcmlmeS5xdWVyeVBl\nc3NpbWlzdGljUmVhZERiU1FMKGVtKTsKICAgICAgICAgICAgZTAgPSBlcy5n\nZXQoMCk7CiAgICAgICAgICAgIGdldExvZygpLmluZm8oIiAqRm91bmQgZW50\naXR5OiIgKyBlMCk7CiAgICAgICAgICAgIGFzc2VydE5vdE51bGwoIiAqRm91\nbmQgIiArIGVudGl0eU5hbWUgKyAiKCIgKyBpZDAgKyAiKSIsIGUwKTsKICAg\nICAgICAgICAgYXNzZXJ0RXF1YWxzKCJBc3NlcnQgcGVzc2ltaXN0aWMgcmVh\nZCBsb2NrIGFwcGxpZWQiLCBMb2NrTW9kZVR5cGUuUEVTU0lNSVNUSUNfUkVB\nRCwgZW0uZ2V0TG9ja01vZGUoZTApKTsKICAgICAgICAgICAgYXNzZXJ0RXF1\nYWxzKCIgKlJlYWQgbG9jayBzaG91bGQgc3RpbGwgYmUgIiArIGJlZm9yZVJl\nYWRNb2RlICsgImFmdGVyIHF1ZXJ5IHNldCBsb2NrIG1vZGUiLAogICAgICAg\nICAgICAgICAgICAgIGJlZm9yZVJlYWRMZXZlbCwgZ2V0Q29uZmlndXJhdGlv\nbihlbSkuZ2V0UmVhZExvY2tMZXZlbENvbnN0YW50KCkpOwoKICAgICAgICAg\nICAgZ2V0TG9nKCkuaW5mbygKICAgICAgICAgICAgICAgICAgICAiICpGaW5k\nICIgKyBlbnRpdHlOYW1lICsgIigiICsgaWQxCiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICArICIpIHdpdGggbm8gbG9jayB0byB2ZXJpZnkgcXVlcnkg\nbG9jayBzZXQgZG9lcyBub3QgYWZmZWN0IGVtIGxvY2sgbW9kZS4iKTsKICAg\nICAgICAgICAgcmVzZXRTUUwoKTsKICAgICAgICAgICAgZTEgPSBlbS5maW5k\nKHR5cGUsIGlkMSk7CiAgICAgICAgICAgIGdldExvZygpLmluZm8oIiAqIiAr\nIChlMSAhPSBudWxsID8gIkYiIDogIkNhbiBub3QgZiIpICsgImluZCBlbnRp\ndHkiKTsKICAgICAgICAgICAgdmVyaWZ5LmZpbmROb0xvY2tBZnRlclF1ZXJ5\nUGVzc2ltaXN0aWNSZWFkRGJTUUwoZW0pOwogICAgICAgICAgICBnZXRMb2co\nKS5pbmZvKCIgKkZvdW5kIGVudGl0eToiICsgZTEpOwogICAgICAgICAgICBh\nc3NlcnROb3ROdWxsKCIgKkZvdW5kICIgKyBlbnRpdHlOYW1lICsgIigiICsg\naWQxICsgIikiLCBlMSk7CiAgICAgICAgICAgIGFzc2VydEVxdWFscygiICpB\nc3NlcnQgZGVmYXVsdCBsb2NrIGFwcGxpZWQiLCBMb2NrTW9kZVR5cGUuTk9O\nRSwgZW0uZ2V0TG9ja01vZGUoZTEpKTsKCiAgICAgICAgICAgIGdldExvZygp\nLmluZm8oIkNvbW1pdHRpbmcgdHJhbnNhY3Rpb24uIik7CiAgICAgICAgICAg\nIGVtLmdldFRyYW5zYWN0aW9uKCkuY29tbWl0KCk7CiAgICAgICAgfSBmaW5h\nbGx5IHsKICAgICAgICAgICAgZW0gPSBudWxsOwogICAgICAgICAgICBlMCA9\nIGUxID0gbnVsbDsKICAgICAgICAgICAgaWYgKGVtICE9IG51bGwgJiYgZW0u\naXNPcGVuKCkpIHsKICAgICAgICAgICAgICAgIGVtLmNsb3NlKCk7CiAgICAg\nICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHRyeSB7CiAgICAgICAgICAg\nIGdldExvZygpLmluZm8oIi0tIFRlc3QgbmFtZSBxdWVyeSB3aXRoIHBlc3Np\nbWlzdGljIHdyaXRlIGxvY2sgaW4gIiArIHNjb3BlICsgIiBzY29wZSIpOwog\nICAgICAgICAgICBlbSA9IGVtZi5jcmVhdGVFbnRpdHlNYW5hZ2VyKCk7CiAg\nICAgICAgICAgIGdldExvZygpLmluZm8oIiAqQmVnaW4gYSB0cmFuc2FjdGlv\nbi4iKTsKICAgICAgICAgICAgZW0uZ2V0VHJhbnNhY3Rpb24oKS5iZWdpbigp\nOwogICAgICAgICAgICByZXNldFNRTCgpOwogICAgICAgICAgICBpbnQgYmVm\nb3JlUmVhZExldmVsID0gZ2V0Q29uZmlndXJhdGlvbihlbSkuZ2V0UmVhZExv\nY2tMZXZlbENvbnN0YW50KCk7CiAgICAgICAgICAgIExvY2tNb2RlVHlwZSBi\nZWZvcmVSZWFkTW9kZSA9IE1peGVkTG9ja0xldmVsc0hlbHBlci5mcm9tTG9j\na0xldmVsKGJlZm9yZVJlYWRMZXZlbCk7CiAgICAgICAgICAgIGdldExvZygp\nLmluZm8oIiAqU2F2ZSBSZWFkTG9ja0xldmVsIGJlZm9yZSBRdWVyeToiICsg\nYmVmb3JlUmVhZE1vZGUpOwogICAgICAgICAgICBnZXRMb2coKS5pbmZvKCIg\nKlF1ZXJ5ICIgKyBlbnRpdHlOYW1lICsgIigiICsgaWQwICsgIikgd2l0aCBQ\nRVNTSU1JU1RJQ19XUklURSBsb2NrIik7CiAgICAgICAgICAgIFF1ZXJ5IHEg\nPSBlbS5jcmVhdGVOYW1lZFF1ZXJ5KG5hbWVkUXVlcnlTdHJpbmcpOwogICAg\nICAgICAgICBpZiAoZXh0ZW5kZWQpIHsKICAgICAgICAgICAgICAgIHEgPSBx\nLnNldEhpbnQoImphdmF4LnBlcnNpc3RlbmNlLmxvY2suc2NvcGUiLCBQZXNz\naW1pc3RpY0xvY2tTY29wZS5FWFRFTkRFRCk7CiAgICAgICAgICAgIH0KICAg\nICAgICAgICAgcSA9IHEuc2V0UGFyYW1ldGVyKCJmaXJzdE5hbWUiLCAiZmly\nc3ROYW1lJSIgKyBpZDApOwogICAgICAgICAgICBMaXN0PFQ+IGVzID0gcS5n\nZXRSZXN1bHRMaXN0KCk7CiAgICAgICAgICAgIGdldExvZygpLmluZm8oIiAq\nRm91bmQgIiArIGVzLnNpemUoKSArICIgZW50aXR5Iik7CiAgICAgICAgICAg\nIGFzc2VydEVxdWFscygiICpGb3VuZCAxIGVudGl0eSIsIGVzLnNpemUoKSwg\nMSk7CiAgICAgICAgICAgIHZlcmlmeS5uYW1lZFF1ZXJ5UGVzc2ltaXN0aWNX\ncml0ZURiU3FsKGVtKTsKICAgICAgICAgICAgZTAgPSBlcy5nZXQoMCk7CiAg\nICAgICAgICAgIGdldExvZygpLmluZm8oIiAqRm91bmQgZW50aXR5OiIgKyBl\nMCk7CiAgICAgICAgICAgIGFzc2VydE5vdE51bGwoIiAqRm91bmQgIiArIGVu\ndGl0eU5hbWUgKyAiKCIgKyBpZDAgKyAiKSIsIGUwKTsKICAgICAgICAgICAg\nYXNzZXJ0RXF1YWxzKCJBc3NlcnQgcGVzc2ltaXN0aWMgd3JpdGUgbG9jayBh\ncHBsaWVkIiwgTG9ja01vZGVUeXBlLlBFU1NJTUlTVElDX1dSSVRFLCBlbS5n\nZXRMb2NrTW9kZShlMCkpOwoKICAgICAgICAgICAgZ2V0TG9nKCkuaW5mbygi\nICpFbnN1cmUgUmVhZExvY2tMZXZlbCByZW1haW5zIGF0IGxldmVsICIgKyBi\nZWZvcmVSZWFkTW9kZSk7CiAgICAgICAgICAgIGFzc2VydEVxdWFscygiICpS\nZWFkIGxvY2sgc2hvdWxkIHN0aWxsIGJlICIgKyBiZWZvcmVSZWFkTW9kZSAr\nICJhZnRlciBxdWVyeSBzZXQgbG9jayBtb2RlIiwKICAgICAgICAgICAgICAg\nICAgICBiZWZvcmVSZWFkTGV2ZWwsIGdldENvbmZpZ3VyYXRpb24oZW0pLmdl\ndFJlYWRMb2NrTGV2ZWxDb25zdGFudCgpKTsKCiAgICAgICAgICAgIGdldExv\nZygpLmluZm8oCiAgICAgICAgICAgICAgICAgICAgIiAqRmluZCAiICsgZW50\naXR5TmFtZSArICIoIiArIGlkMQogICAgICAgICAgICAgICAgICAgICAgICAg\nICAgKyAiKSB3aXRoIG5vIGxvY2sgdG8gdmVyaWZ5IHF1ZXJ5IGxvY2sgc2V0\nIGRvZXMgbm90IGFmZmVjdCBlbSBsb2NrIG1vZGUuIik7CiAgICAgICAgICAg\nIHJlc2V0U1FMKCk7CiAgICAgICAgICAgIGUxID0gZW0uZmluZCh0eXBlLCBp\nZDEpOwogICAgICAgICAgICBnZXRMb2coKS5pbmZvKCIgKiIgKyAoZTEgIT0g\nbnVsbCA/ICJGIiA6ICJDYW4gbm90IGYiKSArICJpbmQgYW4gZW50aXR5Iik7\nCiAgICAgICAgICAgIHZlcmlmeS5maW5kTm9Mb2NrQWZ0ZXJOYW1lZFF1ZXJ5\nUGVzc2ltaXN0aWNXcml0ZURiU3FsKGVtKTsKICAgICAgICAgICAgZ2V0TG9n\nKCkuaW5mbygiICpGb3VuZCBlbnRpdHk6IiArIGUxKTsKICAgICAgICAgICAg\nYXNzZXJ0Tm90TnVsbCgiICpGb3VuZCAiICsgZW50aXR5TmFtZSArICIoIiAr\nIGlkMSArICIpIiwgZTEpOwogICAgICAgICAgICBhc3NlcnRFcXVhbHMoIiAq\nQXNzZXJ0IGRlZmF1bHQgbG9jayBhcHBsaWVkIiwgTG9ja01vZGVUeXBlLk5P\nTkUsIGVtLmdldExvY2tNb2RlKGUxKSk7CgogICAgICAgICAgICBnZXRMb2co\nKS5pbmZvKCJDb21taXR0aW5nIHRyYW5zYWN0aW9uLiIpOwogICAgICAgICAg\nICBlbS5nZXRUcmFuc2FjdGlvbigpLmNvbW1pdCgpOwogICAgICAgIH0gZmlu\nYWxseSB7CiAgICAgICAgICAgIGVtID0gbnVsbDsKICAgICAgICAgICAgZTAg\nPSBlMSA9IG51bGw7CiAgICAgICAgICAgIGlmIChlbSAhPSBudWxsICYmIGVt\nLmlzT3BlbigpKSB7CiAgICAgICAgICAgICAgICBlbS5jbG9zZSgpOwogICAg\nICAgICAgICB9CiAgICAgICAgfQogICAgfQoKICAgIHByb3RlY3RlZCBpbnRl\ncmZhY2UgQXNzZXJ0Q2FsbGJhY2sgewogICAgICAgIHB1YmxpYyB2b2lkIGZp\nbmROb0xvY2tEYlNRTChFbnRpdHlNYW5hZ2VyIGVtKTsKCiAgICAgICAgcHVi\nbGljIHZvaWQgZmluZFBlc3NpbWlzdGljRm9yY0luY0RiU1FMKEVudGl0eU1h\nbmFnZXIgZW0pOwoKICAgICAgICBwdWJsaWMgdm9pZCBxdWVyeVBlc3NpbWlz\ndGljUmVhZERiU1FMKEVudGl0eU1hbmFnZXIgZW0pOwoKICAgICAgICBwdWJs\naWMgdm9pZCBmaW5kTm9Mb2NrQWZ0ZXJRdWVyeVBlc3NpbWlzdGljUmVhZERi\nU1FMKEVudGl0eU1hbmFnZXIgZW0pOwoKICAgICAgICBwdWJsaWMgdm9pZCBu\nYW1lZFF1ZXJ5UGVzc2ltaXN0aWNXcml0ZURiU3FsKEVudGl0eU1hbmFnZXIg\nZW0pOwoKICAgICAgICBwdWJsaWMgdm9pZCBmaW5kTm9Mb2NrQWZ0ZXJOYW1l\nZFF1ZXJ5UGVzc2ltaXN0aWNXcml0ZURiU3FsKEVudGl0eU1hbmFnZXIgZW0p\nOwogICAgfQp9Cg==\n","encoding":"base64"}

