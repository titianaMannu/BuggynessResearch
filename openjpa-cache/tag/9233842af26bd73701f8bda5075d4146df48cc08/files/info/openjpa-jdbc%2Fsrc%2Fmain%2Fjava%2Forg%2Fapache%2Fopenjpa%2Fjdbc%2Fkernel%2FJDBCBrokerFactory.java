{"sha":"12bd7ec76bc333e5d95a5e7d8f40fc28e2246d5d","node_id":"MDQ6QmxvYjIwNjM2NDoxMmJkN2VjNzZiYzMzM2U1ZDk1YTVlN2Q4ZjQwZmMyOGUyMjQ2ZDVk","size":5562,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/12bd7ec76bc333e5d95a5e7d8f40fc28e2246d5d","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5rZXJuZWw7CgppbXBv\ncnQgamF2YS51dGlsLkFycmF5czsKaW1wb3J0IGphdmEudXRpbC5Db2xsZWN0\naW9uOwppbXBvcnQgamF2YS51dGlsLk1hcDsKCmltcG9ydCBvcmcuYXBhY2hl\nLmNvbW1vbnMubGFuZy5TdHJpbmdVdGlsczsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS5qZGJjLmNvbmYuSkRCQ0NvbmZpZ3VyYXRpb247CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEuamRiYy5jb25mLkpEQkNDb25maWd1cmF0aW9u\nSW1wbDsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLm1ldGEuTWFw\ncGluZ1JlcG9zaXRvcnk7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRi\nYy5tZXRhLk1hcHBpbmdUb29sOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLmtlcm5lbC5BYnN0cmFjdEJyb2tlckZhY3Rvcnk7CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEua2VybmVsLkJvb3RzdHJhcDsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5rZXJuZWwuQnJva2VySW1wbDsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5rZXJuZWwuU3RvcmVNYW5hZ2VyOwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLmxpYi5jb25mLkNvbmZpZ3VyYXRpb25Qcm92aWRlcjsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIuY29uZi5Db25maWd1cmF0\naW9uczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIudXRpbC5Mb2Nh\nbGl6ZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5Vc2VyRXhj\nZXB0aW9uOwoKLyoqCiAqIEJyb2tlckZhY3RvcnkgdHlwZSBmb3IgdXNlIHdp\ndGggdGhlIEpEQkMgcnVudGltZS4KICoKICogQGF1dGhvciBBYmUgV2hpdGUK\nICogQGF1dGhvciBNYXJjIFBydWQnaG9tbWVhdXgKICovCkBTdXBwcmVzc1dh\ncm5pbmdzKCJzZXJpYWwiKQpwdWJsaWMgY2xhc3MgSkRCQ0Jyb2tlckZhY3Rv\ncnkKICAgIGV4dGVuZHMgQWJzdHJhY3RCcm9rZXJGYWN0b3J5IHsKCiAgICBw\ncml2YXRlIHN0YXRpYyBmaW5hbCBMb2NhbGl6ZXIgX2xvYyA9IExvY2FsaXpl\nci5mb3JQYWNrYWdlCiAgICAgICAgKEpEQkNCcm9rZXJGYWN0b3J5LmNsYXNz\nKTsKCiAgICBwcml2YXRlIGJvb2xlYW4gX3N5bmNocm9uaXplZE1hcHBpbmdz\nID0gZmFsc2U7CgogICAgLyoqCiAgICAgKiBGYWN0b3J5IG1ldGhvZCBmb3Ig\nY29uc3RydWN0aW5nIGEgZmFjdG9yeSBmcm9tIHByb3BlcnRpZXMuIEludm9r\nZWQgZnJvbQogICAgICoge0BsaW5rIEJvb3RzdHJhcCNuZXdCcm9rZXJGYWN0\nb3J5fS4KICAgICAqLwogICAgcHVibGljIHN0YXRpYyBKREJDQnJva2VyRmFj\ndG9yeSBuZXdJbnN0YW5jZShDb25maWd1cmF0aW9uUHJvdmlkZXIgY3ApIHsK\nICAgICAgICBKREJDQ29uZmlndXJhdGlvbkltcGwgY29uZiA9IG5ldyBKREJD\nQ29uZmlndXJhdGlvbkltcGwoKTsKICAgICAgICBjcC5zZXRJbnRvKGNvbmYp\nOwogICAgICAgIHJldHVybiBuZXcgSkRCQ0Jyb2tlckZhY3RvcnkoY29uZik7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBGYWN0b3J5IG1ldGhvZCBmb3Igb2J0\nYWluaW5nIGEgcG9zc2libHktcG9vbGVkIGZhY3RvcnkgZnJvbSBwcm9wZXJ0\naWVzLgogICAgICogSW52b2tlZCBmcm9tIHtAbGluayBCb290c3RyYXAjZ2V0\nQnJva2VyRmFjdG9yeX0uCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0aWMgSkRC\nQ0Jyb2tlckZhY3RvcnkgZ2V0SW5zdGFuY2UoQ29uZmlndXJhdGlvblByb3Zp\nZGVyIGNwKSB7CiAgICAgICAgTWFwPFN0cmluZyxPYmplY3Q+IHByb3BzID0g\nY3AuZ2V0UHJvcGVydGllcygpOwogICAgICAgIE9iamVjdCBrZXkgPSB0b1Bv\nb2xLZXkocHJvcHMpOwogICAgICAgIEpEQkNCcm9rZXJGYWN0b3J5IGZhY3Rv\ncnkgPSAoSkRCQ0Jyb2tlckZhY3RvcnkpCiAgICAgICAgICAgIGdldFBvb2xl\nZEZhY3RvcnlGb3JLZXkoa2V5KTsKICAgICAgICBpZiAoZmFjdG9yeSAhPSBu\ndWxsKQogICAgICAgICAgICByZXR1cm4gZmFjdG9yeTsKCiAgICAgICAgZmFj\ndG9yeSA9IG5ld0luc3RhbmNlKGNwKTsKICAgICAgICBwb29sKGtleSwgZmFj\ndG9yeSk7CiAgICAgICAgcmV0dXJuIGZhY3Rvcnk7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBDb25zdHJ1Y3QgdGhlIGZhY3Rvcnkgd2l0aCB0aGUgZ2l2ZW4g\nb3B0aW9uIHNldHRpbmdzOyBob3dldmVyLCB0aGUKICAgICAqIGZhY3Rvcnkg\nY29uc3RydWN0aW9uIG1ldGhvZHMgYXJlIHJlY29tbWVuZGVkLgogICAgICov\nCiAgICBwdWJsaWMgSkRCQ0Jyb2tlckZhY3RvcnkoSkRCQ0NvbmZpZ3VyYXRp\nb24gY29uZikgewogICAgICAgIHN1cGVyKGNvbmYpOwogICAgfQogICAKICAg\nIHB1YmxpYyBNYXA8U3RyaW5nLE9iamVjdD4gZ2V0UHJvcGVydGllcygpIHsK\nICAgICAgICAvLyBhZGQgcGxhdGZvcm0gcHJvcGVydHkKICAgICAgICBNYXA8\nU3RyaW5nLE9iamVjdD4gcHJvcHMgPSBzdXBlci5nZXRQcm9wZXJ0aWVzKCk7\nCiAgICAgICAgU3RyaW5nIGRiID0gIlVua25vd24iOwogICAgICAgIHRyeSB7\nCiAgICAgICAgICAgIEpEQkNDb25maWd1cmF0aW9uIGNvbmYgPSAoSkRCQ0Nv\nbmZpZ3VyYXRpb24pIGdldENvbmZpZ3VyYXRpb24oKTsKICAgICAgICAgICAg\nZGIgPSBjb25mLmdldERCRGljdGlvbmFyeUluc3RhbmNlKCkucGxhdGZvcm07\nCiAgICAgICAgfSBjYXRjaCAoUnVudGltZUV4Y2VwdGlvbiByZSkgewogICAg\nICAgIH0KICAgICAgICBwcm9wcy5wdXQoIlBsYXRmb3JtIiwgIk9wZW5KUEEg\nSkRCQyBFZGl0aW9uOiAiICsgZGIgKyAiIERhdGFiYXNlIik7CgogICAgICAg\nIHJldHVybiBwcm9wczsKICAgIH0KCiAgICBwcm90ZWN0ZWQgU3RvcmVNYW5h\nZ2VyIG5ld1N0b3JlTWFuYWdlcigpIHsKICAgICAgICByZXR1cm4gbmV3IEpE\nQkNTdG9yZU1hbmFnZXIoKTsKICAgIH0KCiAgICBwcm90ZWN0ZWQgQnJva2Vy\nSW1wbCBuZXdCcm9rZXJJbXBsKFN0cmluZyB1c2VyLCBTdHJpbmcgcGFzcykg\newogICAgICAgIEJyb2tlckltcGwgYnJva2VyID0gc3VwZXIubmV3QnJva2Vy\nSW1wbCh1c2VyLCBwYXNzKTsKCiAgICAgICAgbG9jaygpOwogICAgICAgIHRy\neSB7CiAgICAgICAgICAgIC8vIHN5bmNocm9uaXplIG1hcHBpbmdzOyB3ZSB3\nYWl0IHVudGlsIG5vdyB0byBkbyB0aGlzIHNvIHRoYXQKICAgICAgICAgICAg\nLy8gd2UgY2FuIHVzZSB0aGUgZmlyc3QgYnJva2VyIHVzZXIvcGFzcyBmb3Ig\nY29ubmVjdGlvbiBpZiBubwogICAgICAgICAgICAvLyBnbG9iYWwgbG9naW4g\naXMgZ2l2ZW4KICAgICAgICAgICAgaWYgKCFfc3luY2hyb25pemVkTWFwcGlu\nZ3MpIHsKICAgICAgICAgICAgICAgIF9zeW5jaHJvbml6ZWRNYXBwaW5ncyA9\nIHRydWU7CiAgICAgICAgICAgICAgICBzeW5jaHJvbml6ZU1hcHBpbmdzKGJy\nb2tlci5nZXRDbGFzc0xvYWRlcigpKTsKICAgICAgICAgICAgfQoKICAgICAg\nICAgICAgcmV0dXJuIGJyb2tlcjsKICAgICAgICB9IGZpbmFsbHkgewogICAg\nICAgICAgICB1bmxvY2soKTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAg\nICAgKiBTeW5jaHJvbml6ZSB0aGUgbWFwcGluZ3Mgb2YgdGhlIGNsYXNzZXMg\nbGlzdGVkIGluIHRoZSBjb25maWd1cmF0aW9uLgogICAgICovCiAgICBwcm90\nZWN0ZWQgdm9pZCBzeW5jaHJvbml6ZU1hcHBpbmdzKENsYXNzTG9hZGVyIGxv\nYWRlciwgCiAgICAgICAgSkRCQ0NvbmZpZ3VyYXRpb24gY29uZikgewogICAg\nICAgIFN0cmluZyBhY3Rpb24gPSBjb25mLmdldFN5bmNocm9uaXplTWFwcGlu\nZ3MoKTsKICAgICAgICBpZiAoU3RyaW5nVXRpbHMuaXNFbXB0eShhY3Rpb24p\nKQogICAgICAgICAgICByZXR1cm47CgogICAgICAgIE1hcHBpbmdSZXBvc2l0\nb3J5IHJlcG8gPSBjb25mLmdldE1hcHBpbmdSZXBvc2l0b3J5SW5zdGFuY2Uo\nKTsKICAgICAgICBDb2xsZWN0aW9uPENsYXNzPD8+PiBjbGFzc2VzID0gcmVw\nby5sb2FkUGVyc2lzdGVudFR5cGVzKGZhbHNlLCBsb2FkZXIpOwogICAgICAg\nIGlmIChjbGFzc2VzLmlzRW1wdHkoKSkKICAgICAgICAgICAgcmV0dXJuOwoK\nICAgICAgICBTdHJpbmcgcHJvcHMgPSBDb25maWd1cmF0aW9ucy5nZXRQcm9w\nZXJ0aWVzKGFjdGlvbik7CiAgICAgICAgYWN0aW9uID0gQ29uZmlndXJhdGlv\nbnMuZ2V0Q2xhc3NOYW1lKGFjdGlvbik7CiAgICAgICAgTWFwcGluZ1Rvb2wg\ndG9vbCA9IG5ldyBNYXBwaW5nVG9vbChjb25mLCBhY3Rpb24sIGZhbHNlKTsK\nICAgICAgICBDb25maWd1cmF0aW9ucy5jb25maWd1cmVJbnN0YW5jZSh0b29s\nLCBjb25mLCBwcm9wcywKICAgICAgICAgICAgIlN5bmNocm9uaXplTWFwcGlu\nZ3MiKTsKCiAgICAgICAgLy8gaW5pdGlhbGl6ZSB0aGUgc2NoZW1hCiAgICAg\nICAgZm9yIChDbGFzczw/PiBjbHMgOiBjbGFzc2VzKSB7CiAgICAgICAgICAg\nIHRyeSB7CiAgICAgICAgICAgICAgICB0b29sLnJ1bihjbHMpOwogICAgICAg\nICAgICB9IGNhdGNoIChJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24gaWFlKSB7\nCiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgVXNlckV4Y2VwdGlvbihfbG9j\nLmdldCgiYmFkLXN5bmNoLW1hcHBpbmdzIiwKICAgICAgICAgICAgICAgICAg\nICBhY3Rpb24sIEFycmF5cy5hc0xpc3QoTWFwcGluZ1Rvb2wuQUNUSU9OUykp\nKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICB0b29sLnJlY29y\nZCgpOwogICAgfQogICAgCiAgICBwcm90ZWN0ZWQgdm9pZCBzeW5jaHJvbml6\nZU1hcHBpbmdzKENsYXNzTG9hZGVyIGxvYWRlcikgewogICAgICAgIHN5bmNo\ncm9uaXplTWFwcGluZ3MobG9hZGVyLCAoSkRCQ0NvbmZpZ3VyYXRpb24pIGdl\ndENvbmZpZ3VyYXRpb24oKSk7CiAgICB9Cn0K\n","encoding":"base64"}

