{"sha":"d5e717e0620f1842fe4d6a21048a6128df02f791","node_id":"MDQ6QmxvYjIwNjM2NDpkNWU3MTdlMDYyMGYxODQyZmU0ZDZhMjEwNDhhNjEyOGRmMDJmNzkx","size":5875,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/d5e717e0620f1842fe4d6a21048a6128df02f791","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5rZXJuZWwuZXhwczsK\nCmltcG9ydCBqYXZhLnV0aWwuTWFwOwoKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5qZGJjLnNjaGVtYS5Db2x1bW47CmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEuamRiYy5zcWwuREJEaWN0aW9uYXJ5OwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLmpkYmMuc3FsLlNRTEJ1ZmZlcjsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5qZGJjLnNxbC5TZWxlY3Q7CmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEua2VybmVsLmV4cHMuRXhwcmVzc2lvblZpc2l0b3I7CmltcG9y\ndCBzZXJwLnV0aWwuU3RyaW5nczsKCi8qKgogKiBUZXN0IGlmIGEgc3RyaW5n\nIG1hdGNoZXMgYSByZWdleHAuCiAqCiAqIEBhdXRob3IgQWJlIFdoaXRlCiAq\nLwpjbGFzcyBNYXRjaGVzRXhwcmVzc2lvbgogICAgaW1wbGVtZW50cyBFeHAg\newoKICAgIHByaXZhdGUgZmluYWwgVmFsIF92YWw7CiAgICBwcml2YXRlIGZp\nbmFsIENvbnN0IF9jb25zdDsKICAgIHByaXZhdGUgZmluYWwgU3RyaW5nIF9z\naW5nbGU7CiAgICBwcml2YXRlIGZpbmFsIFN0cmluZyBfbXVsdGk7CiAgICBw\ncml2YXRlIGZpbmFsIFN0cmluZyBfZXNjYXBlOwoKICAgIC8qKgogICAgICog\nQ29uc3RydWN0b3IuIFN1cHBseSB2YWx1ZXMuCiAgICAgKi8KICAgIHB1Ymxp\nYyBNYXRjaGVzRXhwcmVzc2lvbihWYWwgdmFsLCBDb25zdCBjb24sCiAgICAg\nICAgU3RyaW5nIHNpbmdsZSwgU3RyaW5nIG11bHRpLCBTdHJpbmcgZXNjYXBl\nKSB7CiAgICAgICAgX3ZhbCA9IHZhbDsKICAgICAgICBfY29uc3QgPSBjb247\nCiAgICAgICAgX3NpbmdsZSA9IHNpbmdsZTsKICAgICAgICBfbXVsdGkgPSBt\ndWx0aTsKICAgICAgICBfZXNjYXBlID0gZXNjYXBlOwogICAgfQoKICAgIHB1\nYmxpYyBFeHBTdGF0ZSBpbml0aWFsaXplKFNlbGVjdCBzZWwsIEV4cENvbnRl\neHQgY3R4LCBNYXAgY29udGFpbnMpIHsKICAgICAgICBFeHBTdGF0ZSBzMSA9\nIF92YWwuaW5pdGlhbGl6ZShzZWwsIGN0eCwgMCk7CiAgICAgICAgRXhwU3Rh\ndGUgczIgPSBfY29uc3QuaW5pdGlhbGl6ZShzZWwsIGN0eCwgMCk7CiAgICAg\nICAgcmV0dXJuIG5ldyBCaW5hcnlPcEV4cFN0YXRlKHNlbC5hbmQoczEuam9p\nbnMsIHMyLmpvaW5zKSwgczEsIHMyKTsKICAgIH0KCiAgICBwdWJsaWMgdm9p\nZCBhcHBlbmRUbyhTZWxlY3Qgc2VsLCBFeHBDb250ZXh0IGN0eCwgRXhwU3Rh\ndGUgc3RhdGUsIAogICAgICAgIFNRTEJ1ZmZlciBidWYpIHsKICAgICAgICBC\naW5hcnlPcEV4cFN0YXRlIGJzdGF0ZSA9IChCaW5hcnlPcEV4cFN0YXRlKSBz\ndGF0ZTsKICAgICAgICBfdmFsLmNhbGN1bGF0ZVZhbHVlKHNlbCwgY3R4LCBi\nc3RhdGUuc3RhdGUxLCBfY29uc3QsIGJzdGF0ZS5zdGF0ZTIpOwogICAgICAg\nIF9jb25zdC5jYWxjdWxhdGVWYWx1ZShzZWwsIGN0eCwgYnN0YXRlLnN0YXRl\nMiwgX3ZhbCwgYnN0YXRlLnN0YXRlMSk7CgogICAgICAgIENvbHVtbiBjb2wg\nPSBudWxsOwogICAgICAgIGlmIChfdmFsIGluc3RhbmNlb2YgUENQYXRoKSB7\nCiAgICAgICAgICAgIENvbHVtbltdIGNvbHMgPSAoKFBDUGF0aCkgX3ZhbCku\nZ2V0Q29sdW1ucyhic3RhdGUuc3RhdGUxKTsKICAgICAgICAgICAgaWYgKGNv\nbHMubGVuZ3RoID09IDEpCiAgICAgICAgICAgICAgICBjb2wgPSBjb2xzWzBd\nOwogICAgICAgIH0KCiAgICAgICAgT2JqZWN0IG8gPSBfY29uc3QuZ2V0VmFs\ndWUoY3R4LCBic3RhdGUuc3RhdGUyKTsKICAgICAgICBpZiAobyA9PSBudWxs\nKQogICAgICAgICAgICBidWYuYXBwZW5kKCIxIDw+IDEiKTsKICAgICAgICBl\nbHNlIHsKICAgICAgICAgICAgLy8gbG9vayBmb3IgaWdub3JlIGNhc2UgZmxh\nZyBhbmQgc3RyaXAgaXQgb3V0IGlmIHByZXNlbnQKICAgICAgICAgICAgYm9v\nbGVhbiBpZ25vcmVDYXNlID0gZmFsc2U7CiAgICAgICAgICAgIFN0cmluZyBz\ndHIgPSBvLnRvU3RyaW5nKCk7CiAgICAgICAgICAgIGludCBpZHggPSBzdHIu\naW5kZXhPZigiKD9pKSIpOwogICAgICAgICAgICBpZiAoaWR4ICE9IC0xKSB7\nCiAgICAgICAgICAgICAgICBpZ25vcmVDYXNlID0gdHJ1ZTsKICAgICAgICAg\nICAgICAgIGlmIChpZHggKyA0IDwgc3RyLmxlbmd0aCgpKQogICAgICAgICAg\nICAgICAgICAgIHN0ciA9IHN0ci5zdWJzdHJpbmcoMCwgaWR4KSArIHN0ci5z\ndWJzdHJpbmcoaWR4ICsgNCk7CiAgICAgICAgICAgICAgICBlbHNlCiAgICAg\nICAgICAgICAgICAgICAgc3RyID0gc3RyLnN1YnN0cmluZygwLCBpZHgpOwog\nICAgICAgICAgICAgICAgc3RyID0gc3RyLnRvTG93ZXJDYXNlKCk7CiAgICAg\nICAgICAgIH0KCiAgICAgICAgICAgIC8vIGFwcGVuZCB0YXJnZXQKICAgICAg\nICAgICAgaWYgKGlnbm9yZUNhc2UpCiAgICAgICAgICAgICAgICBidWYuYXBw\nZW5kKCJMT1dFUigiKTsKICAgICAgICAgICAgX3ZhbC5hcHBlbmRUbyhzZWws\nIGN0eCwgYnN0YXRlLnN0YXRlMSwgYnVmLCAwKTsKICAgICAgICAgICAgaWYg\nKGlnbm9yZUNhc2UpCiAgICAgICAgICAgICAgICBidWYuYXBwZW5kKCIpIik7\nCgogICAgICAgICAgICAvLyBjcmVhdGUgYSBEQiB3aWxkY2FyZCBzdHJpbmcg\nYnkgcmVwbGFjaW5nIHRoZQogICAgICAgICAgICAvLyBtdWx0aSB0b2tlbiAo\nZS5nLiwgJy4qJykgYW5kIHRoZSBzaW5nbGUgdG9rZW4gKGUuZy4sICIuIikK\nICAgICAgICAgICAgLy8gd2l0aCAnJScgYW5kICcuJyB3aXRoICdfJwogICAg\nICAgICAgICBzdHIgPSByZXBsYWNlRXNjYXBlKHN0ciwgX211bHRpLCAiJSIs\nIF9lc2NhcGUpOwogICAgICAgICAgICBzdHIgPSByZXBsYWNlRXNjYXBlKHN0\nciwgX3NpbmdsZSwgIl8iLCBfZXNjYXBlKTsKICAgICAgICAgICAgYnVmLmFw\ncGVuZCgiIExJS0UgIikuYXBwZW5kVmFsdWUoc3RyLCBjb2wpOwoKICAgICAg\nICAgICAgLy8gZXNjYXBlIG91dCBjaGFyYWN0ZXJzIGJ5IHVzaW5nIHRoZSBk\nYXRhYmFzZSdzIGVzY2FwZSBzZXF1ZW5jZQogICAgICAgICAgICBEQkRpY3Rp\nb25hcnkgZGljdCA9IGN0eC5zdG9yZS5nZXREQkRpY3Rpb25hcnkoKTsKICAg\nICAgICAgICAgaWYgKF9lc2NhcGUgIT0gbnVsbCkgewogICAgICAgICAgICAg\nICAgaWYgKF9lc2NhcGUuZXF1YWxzKCJcXCIpKSAKICAgICAgICAgICAgICAg\nICAgICBidWYuYXBwZW5kKCIgRVNDQVBFICciKS5hcHBlbmQoZGljdC5zZWFy\nY2hTdHJpbmdFc2NhcGUpLmFwcGVuZCgiJyIpOwogICAgICAgICAgICAgICAg\nZWxzZQogICAgICAgICAgICAgICAgICAgIGJ1Zi5hcHBlbmQoIiBFU0NBUEUg\nJyIpLmFwcGVuZChfZXNjYXBlKS5hcHBlbmQoIiciKTsKICAgICAgICAgICAg\nfQogICAgICAgICAgICAKICAgICAgICB9CiAgICAgICAgc2VsLmFwcGVuZChi\ndWYsIHN0YXRlLmpvaW5zKTsKICAgIH0KCiAgICAvKiogCiAgICAgKiBQZXJm\nb3JtIGEgc3RyaW5nIHJlcGxhY2VtZW50IHdpdGggc2ltcGxpc3RpYyBlc2Nh\ncGUgaGFuZGluZy4gCiAgICAgKiAgCiAgICAgKiBAcGFyYW0gIHN0ciAgICAg\nIHRoZSBzb3VyY2Ugc3RyaW5nCiAgICAgKiBAcGFyYW0gIGZyb20gICAgIHRo\nZSBzdHJpbmcgdG8gZmluZAogICAgICogQHBhcmFtICB0byAgICAgICB0aGUg\nc3RyaW5nIHRvIHJlcGxhY2UKICAgICAqIEBwYXJhbSAgZXNjYXBlICAgdGhl\nIHN0cmluZyB0byB1c2UgdG8gZXNjYXBlIHJlcGxhY2VtZW50CiAgICAgKiBA\ncmV0dXJuICAgICAgICAgIHRoZSByZXBsYWNlZCBzdHJpbmcKICAgICAqLwog\nICAgcHJpdmF0ZSBzdGF0aWMgU3RyaW5nIHJlcGxhY2VFc2NhcGUoU3RyaW5n\nIHN0ciwgU3RyaW5nIGZyb20sIFN0cmluZyB0bywKICAgICAgICBTdHJpbmcg\nZXNjYXBlKSB7CiAgICAgICAgU3RyaW5nW10gcGFydHMgPSBTdHJpbmdzLnNw\nbGl0KHN0ciwgZnJvbSwgSW50ZWdlci5NQVhfVkFMVUUpOwogICAgICAgIFN0\ncmluZ0J1ZmZlciByZXBidWYgPSBuZXcgU3RyaW5nQnVmZmVyKCk7CiAgICAg\nICAgZm9yIChpbnQgaSA9IDA7IGkgPCBwYXJ0cy5sZW5ndGg7IGkrKykgewog\nICAgICAgICAgICBpZiAoaSA+IDApIHsKICAgICAgICAgICAgICAgIC8vIGlm\nIHRoZSBwcmV2aW91cyBwYXJ0IGVuZGVkIHdpdGggYW4gZXNjYXBlIGNoYXJh\nY3RlciwgdGhlbgogICAgICAgICAgICAgICAgLy8gZXNjYXBlIHRoZSBjaGFy\nYWN0ZXIgYW5kIHJlbW92ZSB0aGUgcHJldmlvdXMgZXNjYXBlOwogICAgICAg\nICAgICAgICAgLy8gdGhpcyBkb2Vzbid0IHN1cHBvcnQgYW55IGRvdWJsZS1l\nc2NhcGluZyBvciBvdGhlciBtb3JlCiAgICAgICAgICAgICAgICAvLyBzb3Bo\naXN0aWNhdGVkIGZlYXR1cmVzCiAgICAgICAgICAgICAgICBpZiAoIWZyb20u\nZXF1YWxzKHRvKSAmJiBwYXJ0c1tpIC0gMV0uZW5kc1dpdGgoZXNjYXBlKSkg\newogICAgICAgICAgICAgICAgICAgIHJlcGJ1Zi5zZXRMZW5ndGgocmVwYnVm\nLmxlbmd0aCgpIC0gMSk7CiAgICAgICAgICAgICAgICAgICAgcmVwYnVmLmFw\ncGVuZChmcm9tKTsKICAgICAgICAgICAgICAgIH0gZWxzZQogICAgICAgICAg\nICAgICAgICAgIHJlcGJ1Zi5hcHBlbmQodG8pOwogICAgICAgICAgICB9CiAg\nICAgICAgICAgIHJlcGJ1Zi5hcHBlbmQocGFydHNbaV0pOwogICAgICAgIH0K\nICAgICAgICByZXR1cm4gcmVwYnVmLnRvU3RyaW5nKCk7CiAgICB9CgogICAg\ncHVibGljIHZvaWQgc2VsZWN0Q29sdW1ucyhTZWxlY3Qgc2VsLCBFeHBDb250\nZXh0IGN0eCwgRXhwU3RhdGUgc3RhdGUsIAogICAgICAgIGJvb2xlYW4gcGtz\nKSB7CiAgICAgICAgQmluYXJ5T3BFeHBTdGF0ZSBic3RhdGUgPSAoQmluYXJ5\nT3BFeHBTdGF0ZSkgc3RhdGU7CiAgICAgICAgX3ZhbC5zZWxlY3RDb2x1bW5z\nKHNlbCwgY3R4LCBic3RhdGUuc3RhdGUxLCB0cnVlKTsKICAgICAgICBfY29u\nc3Quc2VsZWN0Q29sdW1ucyhzZWwsIGN0eCwgYnN0YXRlLnN0YXRlMiwgdHJ1\nZSk7CiAgICB9CgogICAgcHVibGljIHZvaWQgYWNjZXB0VmlzaXQoRXhwcmVz\nc2lvblZpc2l0b3IgdmlzaXRvcikgewogICAgICAgIHZpc2l0b3IuZW50ZXIo\ndGhpcyk7CiAgICAgICAgX3ZhbC5hY2NlcHRWaXNpdCh2aXNpdG9yKTsKICAg\nICAgICBfY29uc3QuYWNjZXB0VmlzaXQodmlzaXRvcik7CiAgICAgICAgdmlz\naXRvci5leGl0KHRoaXMpOwogICAgfQp9Cg==\n","encoding":"base64"}

