{"sha":"547fd1f8609d3fa9941fd3edfc8c737cea9fafec","node_id":"MDQ6QmxvYjIwNjM2NDo1NDdmZDFmODYwOWQzZmE5OTQxZmQzZWRmYzhjNzM3Y2VhOWZhZmVj","size":37713,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/547fd1f8609d3fa9941fd3edfc8c737cea9fafec","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zcWw7CgppbXBvcnQg\namF2YS5pby5CeXRlQXJyYXlJbnB1dFN0cmVhbTsKaW1wb3J0IGphdmEubGFu\nZy5yZWZsZWN0Lk1ldGhvZDsKaW1wb3J0IGphdmEuc3FsLkJsb2I7CmltcG9y\ndCBqYXZhLnNxbC5Db25uZWN0aW9uOwppbXBvcnQgamF2YS5zcWwuRGF0YWJh\nc2VNZXRhRGF0YTsKaW1wb3J0IGphdmEuc3FsLlByZXBhcmVkU3RhdGVtZW50\nOwppbXBvcnQgamF2YS5zcWwuUmVzdWx0U2V0OwppbXBvcnQgamF2YS5zcWwu\nU1FMRXhjZXB0aW9uOwppbXBvcnQgamF2YS5zcWwuVHlwZXM7CmltcG9ydCBq\nYXZhLnV0aWwuQXJyYXlzOwppbXBvcnQgamF2YS51dGlsLkVudW1TZXQ7Cmlt\ncG9ydCBqYXZhLnV0aWwuU2V0OwppbXBvcnQgamF2YS51dGlsLlN0cmluZ1Rv\na2VuaXplcjsKCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5rZXJu\nZWwuSkRCQ0ZldGNoQ29uZmlndXJhdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS5qZGJjLmtlcm5lbC5leHBzLkZpbHRlclZhbHVlOwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMua2VybmVsLmV4cHMuTGl0OwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMua2VybmVsLmV4cHMuUGFyYW07\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5rZXJuZWwuZXhwcy5W\nYWw7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hlbWEuQ29s\ndW1uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1hLklu\nZGV4OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1hLlNj\naGVtYTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNjaGVtYS5T\nZXF1ZW5jZTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNjaGVt\nYS5UYWJsZTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuRmls\ndGVyczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuTWl4ZWRM\nb2NrTGV2ZWxzOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5l\neHBzLkxpdGVyYWw7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0\naWwuTG9jYWxpemVyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEu\nSmF2YVR5cGVzOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuT3Bl\nbkpQQUV4Y2VwdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGls\nLlN0b3JlRXhjZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0\naWwuVW5zdXBwb3J0ZWRFeGNlcHRpb247CgppbXBvcnQgc2VycC51dGlsLlN0\ncmluZ3M7CgovKioKICogRGljdGlvbmFyeSBmb3IgSUJNIERCMiBkYXRhYmFz\nZS4KICovCnB1YmxpYyBjbGFzcyBEQjJEaWN0aW9uYXJ5CiAgICBleHRlbmRz\nIEFic3RyYWN0REIyRGljdGlvbmFyeSB7CiAgICBwcml2YXRlIHN0YXRpYyBm\naW5hbCBMb2NhbGl6ZXIgX2xvYyA9IExvY2FsaXplci5mb3JQYWNrYWdlCiAg\nICAgICAgKERCMkRpY3Rpb25hcnkuY2xhc3MpOwoKICAgIHB1YmxpYyBzdGF0\naWMgZmluYWwgU3RyaW5nIFZFTkRPUl9JQk0gPSAiaWJtIjsKICAgIHB1Ymxp\nYyBTdHJpbmcgb3B0aW1pemVDbGF1c2UgPSAib3B0aW1pemUgZm9yIjsKICAg\nIHB1YmxpYyBTdHJpbmcgcm93Q2xhdXNlID0gInJvdyI7CiAgICBwcm90ZWN0\nZWQgaW50IGRiMlNlcnZlclR5cGUgPSAwOwogICAgcHVibGljIHN0YXRpYyBm\naW5hbCBpbnQgZGIySVNlcmllc1Y1UjNPckVhcmxpZXIgPSAxOwogICAgcHVi\nbGljIHN0YXRpYyBmaW5hbCBpbnQgZGIyVURCVjgxT3JFYXJsaWVyID0gMjsK\nICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgaW50IGRiMlpPU1Y4eE9yTGF0ZXIg\nPSAzOwogICAgcHVibGljIHN0YXRpYyBmaW5hbCBpbnQgZGIyVURCVjgyT3JM\nYXRlciA9IDQ7CiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIGludCBkYjJJU2Vy\naWVzVjVSNE9yTGF0ZXIgPSA1OwogICAgcHJvdGVjdGVkIHN0YXRpYyBmaW5h\nbCBTdHJpbmcgZm9yVXBkYXRlID0gIkZPUiBVUERBVEUiOwogICAgcHJvdGVj\ndGVkIHN0YXRpYyBmaW5hbCBTdHJpbmcgd2l0aFVSQ2xhdXNlID0gIldJVEgg\nVVIiOwogICAgcHJvdGVjdGVkIHN0YXRpYyBmaW5hbCBTdHJpbmcgd2l0aENT\nQ2xhdXNlID0gIldJVEggQ1MiOwogICAgcHJvdGVjdGVkIHN0YXRpYyBmaW5h\nbCBTdHJpbmcgd2l0aFJTQ2xhdXNlID0gIldJVEggUlMiOwogICAgcHJvdGVj\ndGVkIHN0YXRpYyBmaW5hbCBTdHJpbmcgd2l0aFJSQ2xhdXNlID0gIldJVEgg\nUlIiOwogICAgcHJvdGVjdGVkIHN0YXRpYyBmaW5hbCBTdHJpbmcgdXNlS2Vl\ncFNoYXJlTG9ja0NsYXVzZQogICAgICAgID0gIlVTRSBBTkQgS0VFUCBTSEFS\nRSBMT0NLUyI7CiAgICBwcm90ZWN0ZWQgc3RhdGljIGZpbmFsIFN0cmluZyB1\nc2VLZWVwVXBkYXRlTG9ja0NsYXVzZQogICAgICAgID0gIlVTRSBBTkQgS0VF\nUCBVUERBVEUgTE9DS1MiOwogICAgcHJvdGVjdGVkIHN0YXRpYyBmaW5hbCBT\ndHJpbmcgdXNlS2VlcEV4Y2x1c2l2ZUxvY2tDbGF1c2UKICAgICAgICA9ICJV\nU0UgQU5EIEtFRVAgRVhDTFVTSVZFIExPQ0tTIjsKICAgIHByb3RlY3RlZCBz\ndGF0aWMgZmluYWwgU3RyaW5nIGZvclJlYWRPbmx5Q2xhdXNlID0gIkZPUiBS\nRUFEIE9OTFkiOwogICAgcHJvdGVjdGVkIFN0cmluZyBkYXRhYmFzZVByb2R1\nY3ROYW1lID0gIiI7CiAgICBwcm90ZWN0ZWQgU3RyaW5nIGRhdGFiYXNlUHJv\nZHVjdFZlcnNpb24gPSAiIjsKICAgIHByb3RlY3RlZCBpbnQgbWFqID0gMDsK\nICAgIHByb3RlY3RlZCBpbnQgbWluID0gMDsKICAgIAogICAgcHJpdmF0ZSBp\nbnQgZGVmYXVsdEJhdGNoTGltaXQgPSAxMDA7CiAgICAKICAgIHByaXZhdGUg\nRW51bVNldDxEQklkZW50aWZpZXJzPiB1bnN1cHBvcnRlZERlbGltaXRlZElk\ncyA9CiAgICAgICAgRW51bVNldC5vZihEQklkZW50aWZpZXJzLkNPTFVNTl9D\nT0xVTU5fREVGSU5JVElPTik7IAogICAgCiAgICBwdWJsaWMgREIyRGljdGlv\nbmFyeSgpIHsKICAgICAgICBwbGF0Zm9ybSA9ICJEQjIiOwogICAgICAgIHZh\nbGlkYXRpb25TUUwgPSAiU0VMRUNUIERJU1RJTkNUKENVUlJFTlQgVElNRVNU\nQU1QKSBGUk9NICIKICAgICAgICAgICAgKyAiU1lTSUJNLlNZU1RBQkxFUyI7\nCiAgICAgICAgc3VwcG9ydHNTZWxlY3RFbmRJbmRleCA9IHRydWU7CgogICAg\nICAgIG5leHRTZXF1ZW5jZVF1ZXJ5ID0gIlZBTFVFUyBORVhUVkFMIEZPUiB7\nMH0iOwoKICAgICAgICBzZXF1ZW5jZVNRTCA9ICJTRUxFQ1QgU0VRU0NIRU1B\nIEFTIFNFUVVFTkNFX1NDSEVNQSwgIgogICAgICAgICAgICArICJTRVFOQU1F\nIEFTIFNFUVVFTkNFX05BTUUgRlJPTSBTWVNDQVQuU0VRVUVOQ0VTIjsKICAg\nICAgICBzZXF1ZW5jZVNjaGVtYVNRTCA9ICJTRVFTQ0hFTUEgPSA/IjsKICAg\nICAgICBzZXF1ZW5jZU5hbWVTUUwgPSAiU0VRTkFNRSA9ID8iOwogICAgICAg\nIGNoYXJhY3RlckNvbHVtblNpemUgPSAyNTQ7CgogICAgICAgIGJpbmFyeVR5\ncGVOYW1lID0gIkJMT0IoMU0pIjsKICAgICAgICBsb25nVmFyYmluYXJ5VHlw\nZU5hbWUgPSAiQkxPQigxTSkiOwogICAgICAgIHZhcmJpbmFyeVR5cGVOYW1l\nID0gIkJMT0IoMU0pIjsKICAgICAgICBjbG9iVHlwZU5hbWUgPSAiQ0xPQigx\nTSkiOwogICAgICAgIGxvbmdWYXJjaGFyVHlwZU5hbWUgPSAiTE9ORyBWQVJD\nSEFSIjsKICAgICAgICBkYXRlUHJlY2lzaW9uID0gTUlDUk87CiAgICAgICAg\nc3RvcmVDaGFyc0FzTnVtYmVycyA9IGZhbHNlOwoKICAgICAgICBmaXhlZFNp\nemVUeXBlTmFtZVNldC5hZGRBbGwoQXJyYXlzLmFzTGlzdChuZXcgU3RyaW5n\nW117CiAgICAgICAgICAgICJMT05HIFZBUkNIQVIgRk9SIEJJVCBEQVRBIiwg\nIkxPTkcgVkFSQ0hBUiIsICJMT05HIFZBUkdSQVBISUMiLAogICAgICAgIH0p\nKTsKICAgICAgICBzeXN0ZW1TY2hlbWFzID0gbmV3IFN0cmluZygKICAgICAg\nICAgICAgICAgICJTWVNDQVQsU1lTSUJNLFNZU1NUQVQsU1lTSUJNQURNLFNZ\nU1RPT0xTIik7CiAgICAgICAgbWF4Q29uc3RyYWludE5hbWVMZW5ndGggPSAx\nODsKICAgICAgICBtYXhJbmRleE5hbWVMZW5ndGggPSAxODsKICAgICAgICBt\nYXhDb2x1bW5OYW1lTGVuZ3RoID0gMzA7CiAgICAgICAgc3VwcG9ydHNEZWZl\ncnJlZENvbnN0cmFpbnRzID0gZmFsc2U7CiAgICAgICAgc3VwcG9ydHNEZWZh\ndWx0RGVsZXRlQWN0aW9uID0gZmFsc2U7CiAgICAgICAgc3VwcG9ydHNBbHRl\nclRhYmxlV2l0aERyb3BDb2x1bW4gPSBmYWxzZTsKCiAgICAgICAgc3VwcG9y\ndHNOdWxsVGFibGVGb3JHZXRDb2x1bW5zID0gZmFsc2U7CiAgICAgICAgcmVx\ndWlyZXNDYXN0Rm9yTWF0aEZ1bmN0aW9ucyA9IHRydWU7CiAgICAgICAgcmVx\ndWlyZXNDYXN0Rm9yQ29tcGFyaXNvbnMgPSB0cnVlOwoKICAgICAgICByZXNl\ncnZlZFdvcmRTZXQuYWRkQWxsKEFycmF5cy5hc0xpc3QobmV3IFN0cmluZ1td\newogICAgICAgICAgICAiQUZURVIiLCAiQUxJQVMiLCAiQUxMT1ciLCAiQVBQ\nTElDQVRJT04iLCAiQVNTT0NJQVRFIiwgIkFTVVRJTUUiLAogICAgICAgICAg\nICAiQVVESVQiLCAiQVVYIiwgIkFVWElMSUFSWSIsICJCRUZPUkUiLCAiQklO\nQVJZIiwgIkJVRkZFUlBPT0wiLAogICAgICAgICAgICAiQ0FDSEUiLCAiQ0FM\nTCIsICJDQUxMRUQiLCAiQ0FQVFVSRSIsICJDQVJESU5BTElUWSIsICJDQ1NJ\nRCIsCiAgICAgICAgICAgICJDTFVTVEVSIiwgIkNPTExFQ1RJT04iLCAiQ09M\nTElEIiwgIkNPTU1FTlQiLCAiQ09OQ0FUIiwKICAgICAgICAgICAgIkNPTkRJ\nVElPTiIsICJDT05UQUlOUyIsICJDT1VOVF9CSUciLCAiQ1VSUkVOVF9MQ19D\nVFlQRSIsCiAgICAgICAgICAgICJDVVJSRU5UX1BBVEgiLCAiQ1VSUkVOVF9T\nRVJWRVIiLCAiQ1VSUkVOVF9USU1FWk9ORSIsICJDWUNMRSIsCiAgICAgICAg\nICAgICJEQVRBQkFTRSIsICJEQVlTIiwgIkRCMkdFTkVSQUwiLCAiREIyR0VO\nUkwiLCAiREIyU1FMIiwKICAgICAgICAgICAgIkRCSU5GTyIsICJERUZBVUxU\nUyIsICJERUZJTklUSU9OIiwgIkRFVEVSTUlOSVNUSUMiLCAiRElTQUxMT1ci\nLAogICAgICAgICAgICAiRE8iLCAiRFNOSEFUVFIiLCAiRFNTSVpFIiwgIkRZ\nTkFNSUMiLCAiRUFDSCIsICJFRElUUFJPQyIsICJFTFNFSUYiLAogICAgICAg\nICAgICAiRU5DT0RJTkciLCAiRU5ELUVYRUMxIiwgIkVSQVNFIiwgIkVYQ0xV\nRElORyIsICJFWElUIiwgIkZFTkNFRCIsCiAgICAgICAgICAgICJGSUVMRFBS\nT0MiLCAiRklMRSIsICJGSU5BTCIsICJGUkVFIiwgIkZVTkNUSU9OIiwgIkdF\nTkVSQUwiLAogICAgICAgICAgICAiR0VORVJBVEVEIiwgIkdSQVBISUMiLCAi\nSEFORExFUiIsICJIT0xEIiwgIkhPVVJTIiwgIklGIiwKICAgICAgICAgICAg\nIklOQ0xVRElORyIsICJJTkNSRU1FTlQiLCAiSU5ERVgiLCAiSU5IRVJJVCIs\nICJJTk9VVCIsICJJTlRFR1JJVFkiLAogICAgICAgICAgICAiSVNPQklEIiwg\nIklURVJBVEUiLCAiSkFSIiwgIkpBVkEiLCAiTEFCRUwiLCAiTENfQ1RZUEUi\nLCAiTEVBVkUiLAogICAgICAgICAgICAiTElOS1RZUEUiLCAiTE9DQUxFIiwg\nIkxPQ0FUT1IiLCAiTE9DQVRPUlMiLCAiTE9DSyIsICJMT0NLTUFYIiwKICAg\nICAgICAgICAgIkxPQ0tTSVpFIiwgIkxPTkciLCAiTE9PUCIsICJNQVhWQUxV\nRSIsICJNSUNST1NFQ09ORCIsCiAgICAgICAgICAgICJNSUNST1NFQ09ORFMi\nLCAiTUlOVVRFUyIsICJNSU5WQUxVRSIsICJNT0RFIiwgIk1PRElGSUVTIiwg\nIk1PTlRIUyIsCiAgICAgICAgICAgICJORVciLCAiTkVXX1RBQkxFIiwgIk5P\nQ0FDSEUiLCAiTk9DWUNMRSIsICJOT0RFTkFNRSIsICJOT0RFTlVNQkVSIiwK\nICAgICAgICAgICAgIk5PTUFYVkFMVUUiLCAiTk9NSU5WQUxVRSIsICJOT09S\nREVSIiwgIk5VTExTIiwgIk5VTVBBUlRTIiwgIk9CSUQiLAogICAgICAgICAg\nICAiT0xEIiwgIk9MRF9UQUJMRSIsICJPUFRJTUlaQVRJT04iLCAiT1BUSU1J\nWkUiLCAiT1VUIiwgIk9WRVJSSURJTkciLAogICAgICAgICAgICAiUEFDS0FH\nRSIsICJQQVJBTUVURVIiLCAiUEFSVCIsICJQQVJUSVRJT04iLCAiUEFUSCIs\nICJQSUVDRVNJWkUiLAogICAgICAgICAgICAiUExBTiIsICJQUklRVFkiLCAi\nUFJPR1JBTSIsICJQU0lEIiwgIlFVRVJZTk8iLCAiUkVBRFMiLCAiUkVDT1ZF\nUlkiLAogICAgICAgICAgICAiUkVGRVJFTkNJTkciLCAiUkVMRUFTRSIsICJS\nRU5BTUUiLCAiUkVQRUFUIiwgIlJFU0VUIiwgIlJFU0lHTkFMIiwKICAgICAg\nICAgICAgIlJFU1RBUlQiLCAiUkVTVUxUIiwgIlJFU1VMVF9TRVRfTE9DQVRP\nUiIsICJSRVRVUk4iLCAiUkVUVVJOUyIsCiAgICAgICAgICAgICJST1VUSU5F\nIiwgIlJPVyIsICJSUk4iLCAiUlVOIiwgIlNBVkVQT0lOVCIsICJTQ1JBVENI\nUEFEIiwKICAgICAgICAgICAgIlNFQ09ORFMiLCAiU0VDUVRZIiwgIlNFQ1VS\nSVRZIiwgIlNFTlNJVElWRSIsICJTSUdOQUwiLCAiU0lNUExFIiwKICAgICAg\nICAgICAgIlNPVVJDRSIsICJTUEVDSUZJQyIsICJTUUxJRCIsICJTVEFOREFS\nRCIsICJTVEFSVCIsICJTVEFUSUMiLAogICAgICAgICAgICAiU1RBWSIsICJT\nVE9HUk9VUCIsICJTVE9SRVMiLCAiU1RZTEUiLCAiU1VCUEFHRVMiLCAiU1lO\nT05ZTSIsCiAgICAgICAgICAgICJTWVNGVU4iLCAiU1lTSUJNIiwgIlNZU1BS\nT0MiLCAiU1lTVEVNIiwgIlRBQkxFU1BBQ0UiLCAiVFJJR0dFUiIsCiAgICAg\nICAgICAgICJVTkRPIiwgIlVOVElMIiwgIlZBTElEUFJPQyIsICJWQVJJQUJM\nRSIsICJWQVJJQU5UIiwgIlZDQVQiLAogICAgICAgICAgICAiVk9MVU1FUyIs\nICJXSElMRSIsICJXTE0iLCAiWUVBUlMiLAogICAgICAgIH0pKTsKICAgICAg\nICAKICAgICAgICAvLyByZXNlcnZlZFdvcmRTZXQgc3Vic2V0IHRoYXQgQ0FO\nTk9UIGJlIHVzZWQgYXMgdmFsaWQgY29sdW1uIG5hbWVzCiAgICAgICAgLy8g\nKGkuZS4sIHdpdGhvdXQgc3Vycm91bmRpbmcgdGhlbSB3aXRoIGRvdWJsZS1x\ndW90ZXMpCiAgICAgICAgaW52YWxpZENvbHVtbldvcmRTZXQuYWRkQWxsKEFy\ncmF5cy5hc0xpc3QobmV3IFN0cmluZ1tdIHsKICAgICAgICAgICAgIkNPTlNU\nUkFJTlQiLCAiRU5ELUVYRUMiLCAiRU5ELUVYRUMxIiwgCiAgICAgICAgfSkp\nOwoKCiAgICAgICAgc3VwZXIuc2V0QmF0Y2hMaW1pdChkZWZhdWx0QmF0Y2hM\naW1pdCk7CiAgICAgICAgCiAgICAgICAgc2VsZWN0V29yZFNldC5hZGQoIldJ\nVEgiKTsKICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBzdXBwb3J0c1JhbmRv\nbUFjY2Vzc1Jlc3VsdFNldChTZWxlY3Qgc2VsLAogICAgICAgIGJvb2xlYW4g\nZm9yVXBkYXRlKSB7CiAgICAgICAgcmV0dXJuICFmb3JVcGRhdGUKICAgICAg\nICAgICAgJiYgc3VwZXIuc3VwcG9ydHNSYW5kb21BY2Nlc3NSZXN1bHRTZXQo\nc2VsLCBmb3JVcGRhdGUpOwogICAgfQoKICAgIHByb3RlY3RlZCB2b2lkIGFw\ncGVuZFNlbGVjdFJhbmdlKFNRTEJ1ZmZlciBidWYsIGxvbmcgc3RhcnQsIGxv\nbmcgZW5kLAogICAgICAgIGJvb2xlYW4gc3Vic2VsZWN0KSB7CiAgICAgICAg\nLy8gYXBwZW5kcyB0aGUgbGl0ZXJhbCByYW5nZSBzdHJpbmcsIHNpbmNlIERC\nMiBpcyB1bmFibGUgdG8gaGFuZGxlCiAgICAgICAgLy8gYSBib3VuZCBwYXJh\nbWV0ZXIgZm9yIGl0CiAgICAgICAgLy8gZG8gbm90IGdlbmVyYXRlIEZFVENI\nIEZJUlNUIGNsYXVzZSBmb3Igc3Vic2VsZWN0CiAgICAgICAgaWYgKCFzdWJz\nZWxlY3QpCiAgICAgICAgICAgIGJ1Zi5hcHBlbmQoIiBGRVRDSCBGSVJTVCAi\nKS5hcHBlbmQoTG9uZy50b1N0cmluZyhlbmQpKS4KICAgICAgICAgICAgICAg\nIGFwcGVuZCgiIFJPV1MgT05MWSIpOwogICAgfQoKICAgIHByb3RlY3RlZCB2\nb2lkIGFwcGVuZFNlbGVjdChTUUxCdWZmZXIgc2VsZWN0U1FMLCBPYmplY3Qg\nYWxpYXMsIFNlbGVjdCBzZWwsCiAgICAgICAgaW50IGlkeCkgewogICAgICAg\nIC8vIGlmIHRoaXMgaXMgYSBsaXRlcmFsIHZhbHVlLCBhZGQgYSBjYXN0Li4u\nCiAgICAgICAgT2JqZWN0IHZhbCA9IHNlbC5nZXRTZWxlY3RzKCkuZ2V0KGlk\neCk7CiAgICAgICAgYm9vbGVhbiB0b0Nhc3QgPSAodmFsIGluc3RhbmNlb2Yg\nTGl0KSAmJiAKICAgICAgICAgICAgKChMaXQpdmFsKS5nZXRQYXJzZVR5cGUo\nKSAhPSBMaXRlcmFsLlRZUEVfREFURSAmJiAKICAgICAgICAgICAgKChMaXQp\ndmFsKS5nZXRQYXJzZVR5cGUoKSAhPSBMaXRlcmFsLlRZUEVfVElNRSAmJgog\nICAgICAgICAgICAoKExpdCl2YWwpLmdldFBhcnNlVHlwZSgpICE9IExpdGVy\nYWwuVFlQRV9USU1FU1RBTVA7CiAgICAgICAgCiAgICAgICAgaWYgKHRvQ2Fz\ndCkgCiAgICAgICAgICAgIHNlbGVjdFNRTC5hcHBlbmQoIkNBU1QoIik7Cgog\nICAgICAgIC8vIC4uLiBhbmQgYWRkIHRoZSBzZWxlY3QgcGVyIHN1cGVyJ3Mg\nYmVoYXZpb3IuLi4KICAgICAgICBzdXBlci5hcHBlbmRTZWxlY3Qoc2VsZWN0\nU1FMLCBhbGlhcywgc2VsLCBpZHgpOwoKICAgICAgICAvLyAuLi4gYW5kIGZp\nbmlzaCB0aGUgY2FzdAogICAgICAgIGlmICh0b0Nhc3QpIHsKICAgICAgICAg\nICAgQ2xhc3MgYyA9ICgoTGl0KSB2YWwpLmdldFR5cGUoKTsKICAgICAgICAg\nICAgaW50IGphdmFUeXBlQ29kZSA9IEphdmFUeXBlcy5nZXRUeXBlQ29kZShj\nKTsKICAgICAgICAgICAgaW50IGpkYmNUeXBlQ29kZSA9IGdldEpEQkNUeXBl\nKGphdmFUeXBlQ29kZSwgZmFsc2UpOwogICAgICAgICAgICBTdHJpbmcgdHlw\nZU5hbWUgPSBnZXRUeXBlTmFtZShqZGJjVHlwZUNvZGUpOwogICAgICAgICAg\nICBzZWxlY3RTUUwuYXBwZW5kKCIgQVMgIiArIHR5cGVOYW1lKTsKCiAgICAg\nICAgICAgIC8vIGlmIHRoZSBsaXRlcmFsIGlzIGEgc3RyaW5nLCB1c2UgdGhl\nIGRlZmF1bHQgY2hhciBjb2wgc2l6ZQogICAgICAgICAgICAvLyBpbiB0aGUg\nY2FzdCBzdGF0ZW1lbnQuCiAgICAgICAgICAgIGlmIChTdHJpbmcuY2xhc3Mu\nZXF1YWxzKGMpKQogICAgICAgICAgICAgICAgc2VsZWN0U1FMLmFwcGVuZCgi\nKCIgKyBjaGFyYWN0ZXJDb2x1bW5TaXplICsgIikiKTsKCiAgICAgICAgICAg\nIHNlbGVjdFNRTC5hcHBlbmQoIikiKTsKICAgICAgICB9CiAgICB9CgogICAg\ncHVibGljIFN0cmluZ1tdIGdldENyZWF0ZVNlcXVlbmNlU1FMKFNlcXVlbmNl\nIHNlcSkgewogICAgICAgIFN0cmluZ1tdIHNxbCA9IHN1cGVyLmdldENyZWF0\nZVNlcXVlbmNlU1FMKHNlcSk7CiAgICAgICAgaWYgKHNlcS5nZXRBbGxvY2F0\nZSgpID4gMSkKICAgICAgICAgICAgc3FsWzBdICs9ICIgQ0FDSEUgIiArIHNl\ncS5nZXRBbGxvY2F0ZSgpOwogICAgICAgIHJldHVybiBzcWw7CiAgICB9Cgog\nICAgcHJvdGVjdGVkIFN0cmluZyBnZXRTZXF1ZW5jZXNTUUwoU3RyaW5nIHNj\naGVtYU5hbWUsIFN0cmluZyBzZXF1ZW5jZU5hbWUpIHsKICAgICAgICBTdHJp\nbmdCdWZmZXIgYnVmID0gbmV3IFN0cmluZ0J1ZmZlcigpOwogICAgICAgIGJ1\nZi5hcHBlbmQoc2VxdWVuY2VTUUwpOwogICAgICAgIGlmIChzY2hlbWFOYW1l\nICE9IG51bGwgfHwgc2VxdWVuY2VOYW1lICE9IG51bGwpCiAgICAgICAgICAg\nIGJ1Zi5hcHBlbmQoIiBXSEVSRSAiKTsKICAgICAgICBpZiAoc2NoZW1hTmFt\nZSAhPSBudWxsKSB7CiAgICAgICAgICAgIGJ1Zi5hcHBlbmQoc2VxdWVuY2VT\nY2hlbWFTUUwpOwogICAgICAgICAgICBpZiAoc2VxdWVuY2VOYW1lICE9IG51\nbGwpCiAgICAgICAgICAgICAgICBidWYuYXBwZW5kKCIgQU5EICIpOwogICAg\nICAgIH0KICAgICAgICBpZiAoc2VxdWVuY2VOYW1lICE9IG51bGwpCiAgICAg\nICAgICAgIGJ1Zi5hcHBlbmQoc2VxdWVuY2VOYW1lU1FMKTsKICAgICAgICBy\nZXR1cm4gYnVmLnRvU3RyaW5nKCk7CiAgICB9CgogICAgcHVibGljIENvbm5l\nY3Rpb24gZGVjb3JhdGUoQ29ubmVjdGlvbiBjb25uKQogICAgICAgIHRocm93\ncyBTUUxFeGNlcHRpb24gewogICAgICAgIC8vIHNvbWUgdmVyc2lvbnMgb2Yg\ndGhlIERCMiBkcml2ZXIgc2VlbSB0byBkZWZhdWx0IHRvCiAgICAgICAgLy8g\nUkVBRF9VTkNPTU1JVFRFRCwgd2hpY2ggd2lsbCBwcmV2ZW50IGxvY2tpbmcg\nZnJvbSB3b3JraW5nCiAgICAgICAgLy8gKG11bHRpcGxlIFNFTEVDVCAuLi4g\nRk9SIFVQREFURSBzdGF0ZW1lbnRzIGFyZSBhbGxvd2VkIG9uCiAgICAgICAg\nLy8gdGhlIHNhbWUgaW5zdGFuY2UpOyBpZiB3ZSBoYXZlIG5vdCBvdmVycmlk\nZGVuIHRoZQogICAgICAgIC8vIHRyYW5zYWN0aW9uIGlzb2xhdGlvbiBpbiB0\naGUgY29uZmlndXJhdGlvbiwgZGVmYXVsdCB0bwogICAgICAgIC8vIFRSQU5T\nQUNUSU9OX1JFQURfQ09NTUlUVEVECiAgICAgICAgY29ubiA9IHN1cGVyLmRl\nY29yYXRlKGNvbm4pOwoKICAgICAgICBpZiAoY29uZi5nZXRUcmFuc2FjdGlv\nbklzb2xhdGlvbkNvbnN0YW50KCkgPT0gLTEgJiYKICAgICAgICAgICAgICAg\nIGNvbm4uZ2V0VHJhbnNhY3Rpb25Jc29sYXRpb24oKSA8CiAgICAgICAgICAg\nICAgICBDb25uZWN0aW9uLlRSQU5TQUNUSU9OX1JFQURfQ09NTUlUVEVEKQog\nICAgICAgICAgICBjb25uLnNldFRyYW5zYWN0aW9uSXNvbGF0aW9uKENvbm5l\nY3Rpb24uVFJBTlNBQ1RJT05fUkVBRF9DT01NSVRURUQpOwoKICAgICAgICBy\nZXR1cm4gY29ubjsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBjb25uZWN0ZWRD\nb25maWd1cmF0aW9uKENvbm5lY3Rpb24gY29ubikgdGhyb3dzIFNRTEV4Y2Vw\ndGlvbiB7CiAgICAgICAgc3VwZXIuY29ubmVjdGVkQ29uZmlndXJhdGlvbihj\nb25uKTsKCiAgICAgICAgRGF0YWJhc2VNZXRhRGF0YSBtZXRhRGF0YSA9IGNv\nbm4uZ2V0TWV0YURhdGEoKTsKICAgICAgICBTdHJpbmcgZHJpdmVyTmFtZSA9\nIG1ldGFEYXRhLmdldERyaXZlck5hbWUoKTsKICAgICAgICBpZiAoZHJpdmVy\nTmFtZSAhPSBudWxsICYmIGRyaXZlck5hbWUuc3RhcnRzV2l0aCgiSUJNIERC\nMiIpKQogICAgICAgICAgICBkcml2ZXJWZW5kb3IgPSBWRU5ET1JfSUJNOwog\nICAgICAgIGVsc2UKICAgICAgICAgICAgZHJpdmVyVmVuZG9yID0gVkVORE9S\nX09USEVSOwoKICAgICAgICBkYXRhYmFzZVByb2R1Y3ROYW1lID0gbnVsbFNh\nZmUobWV0YURhdGEuZ2V0RGF0YWJhc2VQcm9kdWN0TmFtZSgpKTsKICAgICAg\nICBkYXRhYmFzZVByb2R1Y3RWZXJzaW9uID0gbnVsbFNhZmUobWV0YURhdGEu\nZ2V0RGF0YWJhc2VQcm9kdWN0VmVyc2lvbigpKTsKICAgICAgICAKICAgICAg\nICAvLyBEZXRlcm1pbmUgdGhlIHR5cGUgb2YgREIyIGRhdGFiYXNlCiAgICAg\nICAgLy8gRmlyc3QgY2hlY2sgZm9yIEFTLzQwMAogICAgICAgIGdldFByb2R1\nY3RWZXJzaW9uTWFqb3JNaW5vckZvcklTZXJpZXMoKTsKCiAgICAgICAgaWYg\nKG1haiA+IDApIHsKICAgICAgICAgICAgaWYgKGlzREIySVNlcmllc1Y1UjNP\nckVhcmxpZXIoKSkKICAgICAgICAgICAgICAgIGRiMlNlcnZlclR5cGUgPSBk\nYjJJU2VyaWVzVjVSM09yRWFybGllcjsKICAgICAgICAgICAgZWxzZSBpZiAo\naXNEQjJJU2VyaWVzVjVSNE9yTGF0ZXIoKSkKICAgICAgICAgICAgICAgIGRi\nMlNlcnZlclR5cGUgPSBkYjJJU2VyaWVzVjVSNE9yTGF0ZXI7CiAgICAgICAg\nfQogICAgICAgIAogICAgICAgIGlmIChkYjJTZXJ2ZXJUeXBlID09IDApIHsK\nICAgICAgICAgICAgaWYgKGlzSkRCQzMpIHsKICAgICAgICAgICAgICAgIG1h\naiA9IG1ldGFEYXRhLmdldERhdGFiYXNlTWFqb3JWZXJzaW9uKCk7CiAgICAg\nICAgICAgICAgICBtaW4gPSBtZXRhRGF0YS5nZXREYXRhYmFzZU1pbm9yVmVy\nc2lvbigpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UKICAgICAg\nICAgICAgICAgIGdldFByb2R1Y3RWZXJzaW9uTWFqb3JNaW5vcigpOwoKICAg\nICAgICAgICAgLy8gRGV0ZXJtaW5lIHRoZSB0eXBlIG9mIERCMiBkYXRhYmFz\nZSBmb3IgWk9TICYgVURCCiAgICAgICAgICAgIGlmIChpc0RCMlVEQlY4MU9y\nRWFybGllcigpKQogICAgICAgICAgICAgICAgZGIyU2VydmVyVHlwZSA9IGRi\nMlVEQlY4MU9yRWFybGllcjsKICAgICAgICAgICAgZWxzZSBpZiAoaXNEQjJa\nT1NWOHhPckxhdGVyKCkpCiAgICAgICAgICAgICAgICBkYjJTZXJ2ZXJUeXBl\nID0gZGIyWk9TVjh4T3JMYXRlcjsKICAgICAgICAgICAgZWxzZSBpZiAoaXNE\nQjJVREJWODJPckxhdGVyKCkpCiAgICAgICAgICAgICAgICBkYjJTZXJ2ZXJU\neXBlID0gZGIyVURCVjgyT3JMYXRlcjsKICAgICAgICB9CgogICAgICAgIC8v\nIHZlcmlmeSB0aGF0IGRhdGFiYXNlIHByb2R1Y3QgaXMgc3VwcG9ydGVkCiAg\nICAgICAgaWYgKGRiMlNlcnZlclR5cGUgPT0gMCB8fCBtYWogPT0gMCkKICAg\nICAgICAgICAgdGhyb3cgbmV3IFVuc3VwcG9ydGVkRXhjZXB0aW9uKF9sb2Mu\nZ2V0KCJkYi1ub3Qtc3VwcG9ydGVkIiwKICAgICAgICAgICAgICAgIG5ldyBP\nYmplY3RbXSB7ZGF0YWJhc2VQcm9kdWN0TmFtZSwgZGF0YWJhc2VQcm9kdWN0\nVmVyc2lvbiB9KSk7CgogICAgICAgIGlmIChtYWogPj0gOSB8fCAobWFqID09\nIDggJiYgbWluID49IDIpKSB7CiAgICAgICAgICAgIHN1cHBvcnRzTG9ja2lu\nZ1dpdGhNdWx0aXBsZVRhYmxlcyA9IHRydWU7CiAgICAgICAgICAgIHN1cHBv\ncnRzTG9ja2luZ1dpdGhJbm5lckpvaW4gPSB0cnVlOwogICAgICAgICAgICBz\ndXBwb3J0c0xvY2tpbmdXaXRoT3V0ZXJKb2luID0gdHJ1ZTsKICAgICAgICAg\nICAgZm9yVXBkYXRlQ2xhdXNlID0gIldJVEggUlIgVVNFIEFORCBLRUVQIFVQ\nREFURSBMT0NLUyI7CiAgICAgICAgICAgIGlmIChtYWogPj05KQogICAgICAg\nICAgICAgICAgc3VwcG9ydHNYTUxDb2x1bW4gPSB0cnVlOwogICAgICAgIH0K\nCiAgICAgICAgLy8gcGxhdGZvcm0gc3BlY2lmaWMgc2V0dGluZ3MKICAgICAg\nICBzd2l0Y2ggKGRiMlNlcnZlclR5cGUpIHsKICAgICAgICBjYXNlIGRiMlVE\nQlY4Mk9yTGF0ZXI6CiAgICAgICAgICAgIGxhc3RHZW5lcmF0ZWRLZXlRdWVy\neSA9ICJTRUxFQ1QgSURFTlRJVFlfVkFMX0xPQ0FMKCkgRlJPTSAiCiAgICAg\nICAgICAgICAgICArICJTWVNJQk0uU1lTRFVNTVkxIjsKICAgICAgICAgICAg\nYnJlYWs7CiAgICAgICAgY2FzZSAgZGIyWk9TVjh4T3JMYXRlcjoKICAgICAg\nICAgICAgLy8gREIyIFovT1MgCiAgICAgICAgICAgIGNoYXJhY3RlckNvbHVt\nblNpemUgPSAyNTU7CiAgICAgICAgICAgIGxhc3RHZW5lcmF0ZWRLZXlRdWVy\neSA9ICJTRUxFQ1QgSURFTlRJVFlfVkFMX0xPQ0FMKCkgRlJPTSAiCiAgICAg\nICAgICAgICAgICArICJTWVNJQk0uU1lTRFVNTVkxIjsKICAgICAgICAgICAg\nbmV4dFNlcXVlbmNlUXVlcnkgPSAiU0VMRUNUIE5FWFRWQUwgRk9SIHswfSBG\nUk9NICIKICAgICAgICAgICAgICAgICsgIlNZU0lCTS5TWVNEVU1NWTEiOwog\nICAgICAgICAgICBzZXF1ZW5jZVNRTCA9ICJTRUxFQ1QgU0NIRU1BIEFTIFNF\nUVVFTkNFX1NDSEVNQSwgIgogICAgICAgICAgICAgICAgKyAiTkFNRSBBUyBT\nRVFVRU5DRV9OQU1FIEZST00gU1lTSUJNLlNZU1NFUVVFTkNFUyI7CiAgICAg\nICAgICAgIHNlcXVlbmNlU2NoZW1hU1FMID0gIlNDSEVNQSA9ID8iOwogICAg\nICAgICAgICBzZXF1ZW5jZU5hbWVTUUwgPSAiTkFNRSA9ID8iOwogICAgICAg\nICAgICBpZiAobWFqID09IDgpIHsKICAgICAgICAgICAgICAgIC8vIERCMiBa\nL09TIFZlcnNpb24gODogbm8gYmlnaW50IHN1cHBvcnQsIGhlbmNlIG1hcCBK\nYXZhCiAgICAgICAgICAgICAgICAvLyBsb25nIHRvIGRlY2ltYWwKICAgICAg\nICAgICAgICAgIGJpZ2ludFR5cGVOYW1lID0gIkRFQ0lNQUwoMzEsMCkiOwog\nICAgICAgICAgICB9CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2Ug\nZGIySVNlcmllc1Y1UjNPckVhcmxpZXI6CiAgICAgICAgY2FzZSBkYjJJU2Vy\naWVzVjVSNE9yTGF0ZXI6CiAgICAgICAgICAgIGxhc3RHZW5lcmF0ZWRLZXlR\ndWVyeSA9ICJTRUxFQ1QgSURFTlRJVFlfVkFMX0xPQ0FMKCkgRlJPTSAiCiAg\nICAgICAgICAgICAgICArICJTWVNJQk0uU1lTRFVNTVkxIjsKICAgICAgICAg\nICAgbmV4dFNlcXVlbmNlUXVlcnkgPSAiU0VMRUNUIE5FWFRWQUwgRk9SIHsw\nfSBGUk9NICIKICAgICAgICAgICAgICAgICsgIlNZU0lCTS5TWVNEVU1NWTEi\nOwogICAgICAgICAgICB2YWxpZGF0aW9uU1FMID0gIlNFTEVDVCBESVNUSU5D\nVChDVVJSRU5UIFRJTUVTVEFNUCkgRlJPTSAiCiAgICAgICAgICAgICAgICAr\nICJRU1lTMi5TWVNUQUJMRVMiOwogICAgICAgICAgICBzZXF1ZW5jZVNRTCA9\nICJTRUxFQ1QgU0VRVUVOQ0VfU0NIRU1BLCAiCiAgICAgICAgICAgICAgICAr\nICJTRVFVRU5DRV9OQU1FIEZST00gUVNZUzIuU1lTU0VRVUVOQ0VTIjsKICAg\nICAgICAgICAgc2VxdWVuY2VTY2hlbWFTUUwgPSAiU0VRVUVOQ0VfU0NIRU1B\nID0gPyI7CiAgICAgICAgICAgIHNlcXVlbmNlTmFtZVNRTCA9ICJTRVFVRU5D\nRV9OQU1FID0gPyI7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAg\nIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBzdXBwb3J0c0lzb2xhdGlvbkZvclVw\nZGF0ZSgpIHsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvKioK\nICAgICAqIEdldCB0aGUgdXBkYXRlIGNsYXVzZSBmb3IgdGhlIHF1ZXJ5IGJh\nc2VkIG9uIHRoZQogICAgICogdXBkYXRlQ2xhdXNlIGFuZCBpc29sYXRpb25M\nZXZlbCBoaW50cwogICAgICovCiAgICBwcm90ZWN0ZWQgU3RyaW5nIGdldEZv\nclVwZGF0ZUNsYXVzZShKREJDRmV0Y2hDb25maWd1cmF0aW9uIGZldGNoLAog\nICAgICAgIGJvb2xlYW4gaXNGb3JVcGRhdGUsIFNlbGVjdCBzZWwpIHsKICAg\nICAgICBpbnQgaXNvbGF0aW9uTGV2ZWw7CiAgICAgICAgLy8gRm9yIGRiMlVE\nQlY4MU9yRWFybGllciBhbmQgZGIySVNlcmllc1Y1UjNPckVhcmxpZXI6CiAg\nICAgICAgLy8gIm9wdGltaXplIGZvciIgY2xhdXNlIGFwcGVhcnMgYmVmb3Jl\nICJmb3IgdXBkYXRlIiBjbGF1c2UuCiAgICAgICAgU3RyaW5nQnVmZmVyIGZv\nclVwZGF0ZVN0cmluZyA9IG5ldyBTdHJpbmdCdWZmZXIoZ2V0T3B0aW1pemVD\nbGF1c2Uoc2VsKSk7CiAgICAgICAgLy8gRGV0ZXJtaW5lIHRoZSBpc29sYXRp\nb25MZXZlbDsgdGhlIGZldGNoCiAgICAgICAgLy8gY29uZmlndXJhdGlvbiBk\nYXRhIG92ZXJyaWRlcyB0aGUgcGVyc2lzdGVuY2UueG1sIHZhbHVlCiAgICAg\nICAgaWYgKGZldGNoICE9IG51bGwgJiYgZmV0Y2guZ2V0SXNvbGF0aW9uKCkg\nIT0gLTEpCiAgICAgICAgICAgIGlzb2xhdGlvbkxldmVsID0gZmV0Y2guZ2V0\nSXNvbGF0aW9uKCk7CiAgICAgICAgZWxzZQogICAgICAgICAgICBpc29sYXRp\nb25MZXZlbCA9IGNvbmYuZ2V0VHJhbnNhY3Rpb25Jc29sYXRpb25Db25zdGFu\ndCgpOwoKICAgICAgICBpZiAoZmV0Y2ggIT0gbnVsbCAmJiBmZXRjaC5nZXRS\nZWFkTG9ja0xldmVsKCkgPj0gCiAgICAgICAgICAgIE1peGVkTG9ja0xldmVs\ncy5MT0NLX1BFU1NJTUlTVElDX1dSSVRFKQogICAgICAgICAgICBpc29sYXRp\nb25MZXZlbCA9IENvbm5lY3Rpb24uVFJBTlNBQ1RJT05fU0VSSUFMSVpBQkxF\nOwoKICAgICAgICBpZiAoaXNGb3JVcGRhdGUpIHsKICAgICAgICAgICAgc3dp\ndGNoIChkYjJTZXJ2ZXJUeXBlKSB7CiAgICAgICAgICAgIGNhc2UgZGIySVNl\ncmllc1Y1UjNPckVhcmxpZXI6CiAgICAgICAgICAgIGNhc2UgZGIyVURCVjgx\nT3JFYXJsaWVyOgogICAgICAgICAgICAgICAgaWYgKGlzb2xhdGlvbkxldmVs\nID09IENvbm5lY3Rpb24uVFJBTlNBQ1RJT05fU0VSSUFMSVpBQkxFKQogICAg\nICAgICAgICAgICAgICAgIGZvclVwZGF0ZVN0cmluZy5hcHBlbmQoIiAiKS5h\ncHBlbmQoZm9yVXBkYXRlQ2xhdXNlKTsKICAgICAgICAgICAgICAgIGVsc2UK\nICAgICAgICAgICAgICAgICAgICBmb3JVcGRhdGVTdHJpbmcuYXBwZW5kKCIg\nIikuYXBwZW5kKGZvclVwZGF0ZSkuYXBwZW5kKCIgIikKICAgICAgICAgICAg\nICAgICAgICAgICAgLmFwcGVuZCh3aXRoUlNDbGF1c2UpOwogICAgICAgICAg\nICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgZGIyWk9TVjh4T3JMYXRl\ncjoKICAgICAgICAgICAgY2FzZSBkYjJVREJWODJPckxhdGVyOgogICAgICAg\nICAgICAgICAgaWYgKGlzb2xhdGlvbkxldmVsID09IENvbm5lY3Rpb24uVFJB\nTlNBQ1RJT05fU0VSSUFMSVpBQkxFKSB7CiAgICAgICAgICAgICAgICAgICAg\nZm9yVXBkYXRlU3RyaW5nLmFwcGVuZCgiICIpLmFwcGVuZChmb3JSZWFkT25s\neUNsYXVzZSkKICAgICAgICAgICAgICAgICAgICAgICAgLmFwcGVuZCgiICIp\nLmFwcGVuZCh3aXRoUlJDbGF1c2UpLmFwcGVuZCgiICIpLmFwcGVuZCgKICAg\nICAgICAgICAgICAgICAgICAgICAgICAgIHVzZUtlZXBVcGRhdGVMb2NrQ2xh\ndXNlKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAg\nICAgICAgZm9yVXBkYXRlU3RyaW5nLmFwcGVuZCgiICIpLmFwcGVuZChmb3JS\nZWFkT25seUNsYXVzZSkKICAgICAgICAgICAgICAgICAgICAgICAgLmFwcGVu\nZCgiICIpLmFwcGVuZCh3aXRoUlNDbGF1c2UpLmFwcGVuZCgiICIpLmFwcGVu\nZCgKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzZUtlZXBVcGRhdGVM\nb2NrQ2xhdXNlKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAg\nIGJyZWFrOwogICAgICAgICAgICBjYXNlIGRiMklTZXJpZXNWNVI0T3JMYXRl\ncjoKICAgICAgICAgICAgICAgIGlmIChpc29sYXRpb25MZXZlbCA9PSBDb25u\nZWN0aW9uLlRSQU5TQUNUSU9OX1NFUklBTElaQUJMRSkgewogICAgICAgICAg\nICAgICAgICAgIGZvclVwZGF0ZVN0cmluZy5hcHBlbmQoIiAiKS5hcHBlbmQo\nZm9yUmVhZE9ubHlDbGF1c2UpCiAgICAgICAgICAgICAgICAgICAgICAgIC5h\ncHBlbmQoIiAiKS5hcHBlbmQod2l0aFJSQ2xhdXNlKS5hcHBlbmQoIiAiKS5h\ncHBlbmQoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2VLZWVwRXhj\nbHVzaXZlTG9ja0NsYXVzZSk7CiAgICAgICAgICAgICAgICB9IGVsc2Ugewog\nICAgICAgICAgICAgICAgICAgIGZvclVwZGF0ZVN0cmluZy5hcHBlbmQoIiAi\nKS5hcHBlbmQoZm9yUmVhZE9ubHlDbGF1c2UpCiAgICAgICAgICAgICAgICAg\nICAgICAgIC5hcHBlbmQoIiAiKS5hcHBlbmQod2l0aFJTQ2xhdXNlKS5hcHBl\nbmQoIiAiKS5hcHBlbmQoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1\nc2VLZWVwRXhjbHVzaXZlTG9ja0NsYXVzZSk7CiAgICAgICAgICAgICAgICB9\nCiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAg\nIH0KICAgCiAgICAgICAgcmV0dXJuIGZvclVwZGF0ZVN0cmluZy50b1N0cmlu\nZygpOwogICAgfQoKICAgIHB1YmxpYyBib29sZWFuIGlzREIyVURCVjgyT3JM\nYXRlcigpIHsKICAgICAgICByZXR1cm4gKGRhdGFiYXNlUHJvZHVjdFZlcnNp\nb24uaW5kZXhPZigiU1FMIikgIT0gLTEKICAgICAgICAgICAgIHx8IGRhdGFi\nYXNlUHJvZHVjdE5hbWUuaW5kZXhPZigiREIyLyIpICE9IC0xKQogICAgICAg\nICAgICAgJiYgKChtYWogPT0gOCAmJiBtaW4gPj0gMikgfHwgKG1haiA+PSA5\nKSk7CiAgICB9CgogICAgcHVibGljIGJvb2xlYW4gaXNEQjJaT1NWOHhPckxh\ndGVyKCkgewogICAgICAgcmV0dXJuIChkYXRhYmFzZVByb2R1Y3RWZXJzaW9u\nLmluZGV4T2YoIkRTTiIpICE9IC0xCiAgICAgICAgICAgIHx8IGRhdGFiYXNl\nUHJvZHVjdE5hbWUuaW5kZXhPZigiREIyLyIpID09IC0xKQogICAgICAgICAg\nICAmJiBtYWogPj0gODsKICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBpc0RC\nMklTZXJpZXNWNVIzT3JFYXJsaWVyKCkgewogICAgICAgcmV0dXJuIChkYXRh\nYmFzZVByb2R1Y3ROYW1lLmluZGV4T2YoIkFTIikgIT0gLTEKICAgICAgICAg\nICAmJiAoKG1haiA9PSA1ICYmIG1pbiA8PTMpIHx8IG1haiA8IDUpKTsKICAg\nIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBpc0RCMklTZXJpZXNWNVI0T3JMYXRl\ncigpIHsKICAgICAgIHJldHVybiBkYXRhYmFzZVByb2R1Y3ROYW1lLmluZGV4\nT2YoIkFTIikgIT0gLTEKICAgICAgICAgICAmJiAobWFqID49NiB8fCAobWFq\nID09IDUgJiYgbWluID49NCkpOwogICAgfQoKICAgIHB1YmxpYyBib29sZWFu\nIGlzREIyVURCVjgxT3JFYXJsaWVyKCkgewogICAgICAgIHJldHVybiAoZGF0\nYWJhc2VQcm9kdWN0VmVyc2lvbi5pbmRleE9mKCJTUUwiKSAhPSAtMSAKICAg\nICAgICAgICAgfHwgZGF0YWJhc2VQcm9kdWN0TmFtZS5pbmRleE9mKCJEQjIv\nIikgIT0gLTEpIAogICAgICAgICAgICAmJiAoKG1haiA9PSA4ICYmIG1pbiA8\nPSAxKSB8fCBtYWogPCA4KTsKICAgIH0KCiAgICAvKiogR2V0IHRoZSB2ZXJz\naW9uIE1ham9yL01pbm9yIGZvciB0aGUgSVNlcmllcwogICAgICovCiAgICBw\ncml2YXRlIHZvaWQgZ2V0UHJvZHVjdFZlcnNpb25NYWpvck1pbm9yRm9ySVNl\ncmllcygpIHsKICAgICAgICAvLyBJU2VyaWVzICAgIERCUHJvZE5hbWUgICAg\nICAgICAgICAgICAgIERCMiBVREIgZm9yIEFTLzQwMAogICAgICAgIC8vICAg\nKFRvb2xib3gpREJQcm9kVmVyc2lvbiAgICAgICAgICAgICAgMDUuMDQuMDAw\nMCBWNVI0bTAKICAgICAgICAvLyBJU2VyaWVzICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgIERCMiBVREIgZm9yIEFTLzQwMAogICAgICAgIC8vICAg\nKE5hdGl2ZSkgICAgICAgICAgICAgICAgICAgICAgICAgICAgVjVSNE0wCiAg\nICAgICAgLy8gbmV3IGpjYyAgICBEQlByb2RWZXJzaW9uICAgICAgICAgICAg\nICBRU1EwNTA0MCBvciBRU1EwNjAxMAogICAgICAgIGlmIChkYXRhYmFzZVBy\nb2R1Y3ROYW1lLmluZGV4T2YoIkFTIikgIT0gLTEpIHsKICAgICAgICAgICAg\nLy8gZGVmYXVsdCB0byBWNVI0CiAgICAgICAgICAgIG1haiA9IDU7CiAgICAg\nICAgICAgIG1pbiA9IDQ7CiAgICAgICAgICAgIGludCBpbmRleCA9IGRhdGFi\nYXNlUHJvZHVjdFZlcnNpb24uaW5kZXhPZignVicpOwogICAgICAgICAgICBp\nZiAoaW5kZXggIT0gLTEpIHsKICAgICAgICAgICAgICAgIFN0cmluZyBzID0g\nZGF0YWJhc2VQcm9kdWN0VmVyc2lvbi5zdWJzdHJpbmcoaW5kZXgpOwogICAg\nICAgICAgICAgICAgcyA9IHMudG9VcHBlckNhc2UoKTsKCiAgICAgICAgICAg\nICAgICBTdHJpbmdUb2tlbml6ZXIgc3RyaW5ndG9rZW5pemVyID0gbmV3IFN0\ncmluZ1Rva2VuaXplcihzLCAiVlJNIgogICAgICAgICAgICAgICAgICAgICwg\nZmFsc2UpOwogICAgICAgICAgICAgICAgaWYgKHN0cmluZ3Rva2VuaXplci5j\nb3VudFRva2VucygpID09IDMpIHsKICAgICAgICAgICAgICAgICAgICBTdHJp\nbmcgczEgPSBzdHJpbmd0b2tlbml6ZXIubmV4dFRva2VuKCk7CiAgICAgICAg\nICAgICAgICAgICAgbWFqID0gSW50ZWdlci5wYXJzZUludChzMSk7CiAgICAg\nICAgICAgICAgICAgICAgU3RyaW5nIHMyID0gIHN0cmluZ3Rva2VuaXplci5u\nZXh0VG9rZW4oKTsKICAgICAgICAgICAgICAgICAgICBtaW4gPSBJbnRlZ2Vy\nLnBhcnNlSW50KHMyKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAg\nfSBlbHNlIHsKICAgICAgICAgICAgICAgIGluZGV4ID0gZGF0YWJhc2VQcm9k\ndWN0VmVyc2lvbi5pbmRleE9mKCcwJyk7CiAgICAgICAgICAgICAgICBpZiAo\naW5kZXggIT0gLTEpIHsKICAgICAgICAgICAgICAgICAgICBTdHJpbmcgcyA9\nIGRhdGFiYXNlUHJvZHVjdFZlcnNpb24uc3Vic3RyaW5nKGluZGV4KTsKICAg\nICAgICAgICAgICAgICAgICBzID0gcy50b1VwcGVyQ2FzZSgpOwoKICAgICAg\nICAgICAgICAgICAgICBTdHJpbmdUb2tlbml6ZXIgc3RyaW5ndG9rZW5pemVy\nID0gbmV3IFN0cmluZ1Rva2VuaXplcihzLCAiMCIKICAgICAgICAgICAgICAg\nICAgICAgICAgLCBmYWxzZSk7ICAgICAgICAgICAgICAgICAgICAKICAgICAg\nICAgICAgICAgICAgICBpZiAoc3RyaW5ndG9rZW5pemVyLmNvdW50VG9rZW5z\nKCkgPT0gMikgewogICAgICAgICAgICAgICAgICAgICAgICBTdHJpbmcgczEg\nPSBzdHJpbmd0b2tlbml6ZXIubmV4dFRva2VuKCk7CiAgICAgICAgICAgICAg\nICAgICAgICAgIG1haiA9IEludGVnZXIucGFyc2VJbnQoczEpOwogICAgICAg\nICAgICAgICAgICAgICAgICBTdHJpbmcgczIgPSAgc3RyaW5ndG9rZW5pemVy\nLm5leHRUb2tlbigpOwogICAgICAgICAgICAgICAgICAgICAgICBtaW4gPSBJ\nbnRlZ2VyLnBhcnNlSW50KHMyKTsKICAgICAgICAgICAgICAgICAgICB9CiAg\nICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9\nCiAgICAKICAgIHByaXZhdGUgdm9pZCBnZXRQcm9kdWN0VmVyc2lvbk1ham9y\nTWlub3IoKSB7CiAgICAgICAgLy8gSW4gY2FzZSBKREJDIGRyaXZlciB2ZXJz\naW9uIGlzIGxvd2VyIHRoYW4gMwogICAgICAgIC8vIHVzZSBmb2xsb3dpbmcg\naW5mbyB0byBkZXRlcm1pbmUgTWFqb3IgYW5kIE1pbm9yIAogICAgICAgIC8v\nICAgICAgICAgICAgICAgICAgICAgICAgQ0xJICAgIHZzICAgICAgSkNDCiAg\nICAgICAgLy8gWkRCVjggREJQcm9kTmFtZSAgICAgICBEQjIgICAgICAgICAg\nICBEQjIKICAgICAgICAvLyAgICAgICBEQlByb2RWZXJzaW9uICAgIDA4LjAx\nLjAwMDUgICAgIERTTjA4MDE1CiAgICAgICAgLy8gWkRCVjkgICAgICAgICAg\nICAgICAgICBEQjIgICAgICAgICAgICBEQjIKICAgICAgICAvLyAgICAgICAg\nICAgICAgICAgICAgICAgIDA5LjAxLjAwMDUgICAgIERTTjA5MDE1CiAgICAg\nICAgLy8gV2luVjkgICAgICAgICAgICAgICAgICBEQjIvTlQgICAgICAgICBE\nQjIvTlQKICAgICAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgIDA5LjAx\nLjAwMDAgICAgIFNRTDA5MDEwCiAgICAgICAgLy8gU29sYXJpc1Y5ICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICBEQjIvU1VONjQKICAgICAgICAvLyAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNRTDA5MDEK\nICAgICAgICAvLyBMaW51eCAgICAgICAgICAgICAgICAgIERCMi9MSU5VWCAg\nICAgIERCMi9MSU5VWAogICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAg\nICAgMDkuMDEuMDAwMCAgICAgU1FMMDkwMQogICAgICAgIGlmIChkYXRhYmFz\nZVByb2R1Y3RWZXJzaW9uLmluZGV4T2YoIjA5IikgIT0gLTEpIHsKICAgICAg\nICAgICAgbWFqID0gOTsKICAgICAgICAgICAgaWYgKGRhdGFiYXNlUHJvZHVj\ndFZlcnNpb24uaW5kZXhPZigiMDEiKSAhPSAtMSkgewogICAgICAgICAgICAg\nICAgbWluID0gMTsKICAgICAgICAgICAgfQogICAgICAgIH0gZWxzZSBpZiAo\nZGF0YWJhc2VQcm9kdWN0VmVyc2lvbi5pbmRleE9mKCIwOCIpICE9IC0xKSB7\nCiAgICAgICAgICAgIG1haiA9IDg7CiAgICAgICAgICAgIG1pbiA9IDI7CiAg\nICAgICAgICAgIGlmIChkYXRhYmFzZVByb2R1Y3RWZXJzaW9uLmluZGV4T2Yo\nIjAxIikgIT0gLTEpIHsKICAgICAgICAgICAgICAgIG1pbiA9IDE7CiAgICAg\nICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgcHJvdGVjdGVkIFN0cmlu\nZyBnZXRPcHRpbWl6ZUNsYXVzZShTZWxlY3Qgc2VsKSB7CiAgICAgICAgaWYg\nKHNlbCAhPSBudWxsICYmIHNlbC5nZXRFeHBlY3RlZFJlc3VsdENvdW50KCkg\nPiAwKSB7CiAgICAgICAgICAgIFN0cmluZ0J1ZmZlciBidWYgPSBuZXcgU3Ry\naW5nQnVmZmVyKCk7CiAgICAgICAgICAgIGJ1Zi5hcHBlbmQoIiAiKS5hcHBl\nbmQob3B0aW1pemVDbGF1c2UpLmFwcGVuZCgiICIpCiAgICAgICAgICAgICAg\nICAuYXBwZW5kKFN0cmluZy52YWx1ZU9mKHNlbC5nZXRFeHBlY3RlZFJlc3Vs\ndENvdW50KCkpKQogICAgICAgICAgICAgICAgLmFwcGVuZCgiICIpLmFwcGVu\nZChyb3dDbGF1c2UpOwogICAgICAgICAgICByZXR1cm4gYnVmLnRvU3RyaW5n\nKCk7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gIiI7CiAgICB9CgogICAg\ncHVibGljIE9wZW5KUEFFeGNlcHRpb24gbmV3U3RvcmVFeGNlcHRpb24oU3Ry\naW5nIG1zZywgU1FMRXhjZXB0aW9uW10gY2F1c2VzLAogICAgICAgIE9iamVj\ndCBmYWlsZWQpIHsKICAgICAgICBpZiAoY2F1c2VzICE9IG51bGwgJiYgY2F1\nc2VzLmxlbmd0aCA+IDApCiAgICAgICAgICAgIG1zZyA9IGFwcGVuZEV4dGVu\nZGVkRXhjZXB0aW9uTXNnKG1zZywgY2F1c2VzWzBdKTsKICAgICAgICByZXR1\ncm4gc3VwZXIubmV3U3RvcmVFeGNlcHRpb24obXNnLCBjYXVzZXMsIGZhaWxl\nZCk7CiAgICB9CgogICAgLyoqCiAgICAgKiAgQXBwZW5kIGV4Y2VwdGlvbiBp\nbmZvcm1hdGlvbiBmcm9tIFNRTENBIHRvIHRoZSBleGlzdGluZwogICAgICog\nIGV4Y2VwdGlvbiBtZXNzYWdlCiAgICAgKi8KICAgIHByaXZhdGUgU3RyaW5n\nIGFwcGVuZEV4dGVuZGVkRXhjZXB0aW9uTXNnKFN0cmluZyBtc2csIFNRTEV4\nY2VwdGlvbiBzcWxlKXsKICAgICAgIGZpbmFsIFN0cmluZyBHRVRTUUxDQSA9\nImdldFNxbGNhIjsKICAgICAgIFN0cmluZyBleGNlcHRpb25Nc2cgPSBuZXcg\nU3RyaW5nKCk7CiAgICAgICB0cnkgewogICAgICAgICAgICBNZXRob2Qgc3Fs\nY2FNMiA9IHNxbGUuZ2V0TmV4dEV4Y2VwdGlvbigpLmdldENsYXNzKCkKICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAuZ2V0TWV0aG9kKEdFVFNRTENB\nLG51bGwpOwogICAgICAgICAgICBPYmplY3Qgc3FsY2EgPSBzcWxjYU0yLmlu\ndm9rZShzcWxlLmdldE5leHRFeGNlcHRpb24oKSwKICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3IE9iamVjdFtdIHt9KTsK\nICAgICAgICAgICAgTWV0aG9kICBnZXRTcWxFcnJwTWV0aGQgPSBzcWxjYS5n\nZXRDbGFzcygpLgogICAgICAgICAgICBnZXRNZXRob2QoImdldFNxbEVycnAi\nLCBudWxsKTsKICAgICAgICAgICAgTWV0aG9kICBnZXRTcWxXYXJuTWV0aGQg\nPSBzcWxjYS5nZXRDbGFzcygpLgogICAgICAgICAgICBnZXRNZXRob2QoImdl\ndFNxbFdhcm4iLCBudWxsKTsKICAgICAgICAgICAgTWV0aG9kICBnZXRTcWxF\ncnJkTWV0aGQgPSBzcWxjYS5nZXRDbGFzcygpLgogICAgICAgICAgICBnZXRN\nZXRob2QoImdldFNxbEVycmQiLCBudWxsKTsKICAgICAgICAgICAgU3RyaW5n\nQnVmZmVyIGVycmRTdHIgPSBuZXcgU3RyaW5nQnVmZmVyKCk7CgogICAgICAg\nICAgICBpbnRbXSBlcnJkcyA9IChpbnRbXSkgZ2V0U3FsRXJyZE1ldGhkLmlu\ndm9rZShzcWxjYSwgbmV3IE9iamVjdFtde30pOwogICAgICAgICAgICBmb3Ig\nKGludCBpID0gMDsgaSA8IGVycmRzLmxlbmd0aDsgaSsrKQogICAgICAgICAg\nICAgICAgZXJyZFN0ci5hcHBlbmQoZXJyZFN0ci5sZW5ndGgoKSA+IDAgPyAi\nLCAiIDogIiIpLgogICAgICAgICAgICAgICAgICAgIGFwcGVuZChlcnJkc1tp\nXSk7CiAgICAgICAgICAgIGV4Y2VwdGlvbk1zZyA9IGV4Y2VwdGlvbk1zZy5j\nb25jYXQoICJTUUxDQSBPVVRQVVQiICsKICAgICAgICAgICAgICAgICAgICAi\nW0VycnA9IiArIGdldFNxbEVycnBNZXRoZC5pbnZva2Uoc3FsY2EsIG5ldyBP\nYmplY3RbXXt9KQogICAgICAgICAgICAgICAgICAgICsgIiwgRXJyZD0iICsg\nZXJyZFN0cik7CgogICAgICAgICAgICBTdHJpbmcgV2FybiA9IG5ldyBTdHJp\nbmcoKGNoYXJbXSkgZ2V0U3FsV2Fybk1ldGhkLgogICAgICAgICAgICAgICAg\nICAgIGludm9rZShzcWxjYSwgbmV3IE9iamVjdFtde30pKTsKICAgICAgICAg\nICAgaWYgKFdhcm4udHJpbSgpLmxlbmd0aCgpICE9IDApCiAgICAgICAgICAg\nICAgICBleGNlcHRpb25Nc2cgPSBleGNlcHRpb25Nc2cuY29uY2F0KCIsIFdh\ncm49IiArV2FybiArICJdIiApOwogICAgICAgICAgICBlbHNlCiAgICAgICAg\nICAgICAgICBleGNlcHRpb25Nc2cgPSBleGNlcHRpb25Nc2cuY29uY2F0KCAi\nXSIgKTsKICAgICAgICAgICAgbXNnID0gbXNnLmNvbmNhdChleGNlcHRpb25N\nc2cpOwogICAgICAgICAgICAKICAgICAgICAgICAgLy8gZm9yIGJhdGNoZWQg\nZXhlY3V0aW9uIGZhaWx1cmVzLCBTUUxFeGNlcHRpb25zIGFyZSBuZXN0ZWQK\nICAgICAgICAgICAgU1FMRXhjZXB0aW9uIHNxbGUyID0gc3FsZS5nZXROZXh0\nRXhjZXB0aW9uKCk7CiAgICAgICAgICAgIHdoaWxlIChzcWxlMiAhPSBudWxs\nKSB7ICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgbXNnID0gbXNn\nLmNvbmNhdCgiXG4iICsgc3FsZTIuZ2V0TWVzc2FnZSgpKTsKICAgICAgICAg\nICAgICAgIHNxbGUyID0gc3FsZTIuZ2V0TmV4dEV4Y2VwdGlvbigpOwogICAg\nICAgICAgICB9CiAgICAgICAgICAgIAogICAgICAgICAgICByZXR1cm4gbXNn\nOwogICAgICAgIH0gY2F0Y2ggKFRocm93YWJsZSB0KSB7CiAgICAgICAgICAg\nIHJldHVybiBzcWxlLmdldE1lc3NhZ2UoKTsKICAgICAgICB9CiAgICB9Cgog\nICAgcHVibGljIGludCBnZXREYjJTZXJ2ZXJUeXBlKCkgewogICAgICAgIHJl\ndHVybiBkYjJTZXJ2ZXJUeXBlOwogICAgfQogICAgCiAgICBwcm90ZWN0ZWQg\ndm9pZCBhcHBlbmRMZW5ndGgoU1FMQnVmZmVyIGJ1ZiwgaW50IHR5cGUpIHsK\nICAgICAgICBpZiAodHlwZSA9PSBUeXBlcy5WQVJDSEFSKQogICAgICAgICAg\nICBidWYuYXBwZW5kKCIoIikuYXBwZW5kKEludGVnZXIudG9TdHJpbmcoY2hh\ncmFjdGVyQ29sdW1uU2l6ZSkpLgogICAgICAgICAgICAgICAgYXBwZW5kKCIp\nIik7CiAgICB9CgogICAgLyoqCiAgICAgKiBJZiB0aGlzIGRpY3Rpb25hcnkg\nc3VwcG9ydHMgWE1MIHR5cGUsCiAgICAgKiB1c2UgdGhpcyBtZXRob2QgdG8g\nYXBwZW5kIHhtbCBwcmVkaWNhdGUuCiAgICAgKiAKICAgICAqIEBwYXJhbSBi\ndWYgdGhlIFNRTCBidWZmZXIgdG8gd3JpdGUgdGhlIGNvbXBhcmlzb24KICAg\nICAqIEBwYXJhbSBvcCB0aGUgY29tcGFyaXNvbiBvcGVyYXRpb24gdG8gcGVy\nZm9ybQogICAgICogQHBhcmFtIGxocyB0aGUgbGVmdCBoYW5kIHNpZGUgb2Yg\ndGhlIGNvbXBhcmlzb24KICAgICAqIEBwYXJhbSByaHMgdGhlIHJpZ2h0IGhh\nbmQgc2lkZSBvZiB0aGUgY29tcGFyaXNvbgogICAgICogQHBhcmFtIGxoc3ht\nbCBpbmRpY2F0ZXMgd2hldGhlciB0aGUgbGVmdCBvcGVyYW5kIG1hcHMgdG8g\neG1sCiAgICAgKiBAcGFyYW0gcmhzeG1sIGluZGljYXRlcyB3aGV0aGVyIHRo\nZSByaWdodCBvcGVyYW5kIG1hcHMgdG8geG1sCiAgICAgKi8KICAgIHB1Ymxp\nYyB2b2lkIGFwcGVuZFhtbENvbXBhcmlzb24oU1FMQnVmZmVyIGJ1ZiwgU3Ry\naW5nIG9wLCBGaWx0ZXJWYWx1ZSBsaHMsCiAgICAgICAgRmlsdGVyVmFsdWUg\ncmhzLCBib29sZWFuIGxoc3htbCwgYm9vbGVhbiByaHN4bWwpIHsKICAgICAg\nICBzdXBlci5hcHBlbmRYbWxDb21wYXJpc29uKGJ1Ziwgb3AsIGxocywgcmhz\nLCBsaHN4bWwsIHJoc3htbCk7CiAgICAgICAgaWYgKGxoc3htbCAmJiByaHN4\nbWwpCiAgICAgICAgICAgIGFwcGVuZFhtbENvbXBhcmlzb24yKGJ1Ziwgb3As\nIGxocywgcmhzKTsKICAgICAgICBlbHNlIGlmIChsaHN4bWwpCiAgICAgICAg\nICAgIGFwcGVuZFhtbENvbXBhcmlzb24xKGJ1Ziwgb3AsIGxocywgcmhzKTsK\nICAgICAgICBlbHNlIAogICAgICAgICAgICBhcHBlbmRYbWxDb21wYXJpc29u\nMShidWYsIG9wLCByaHMsIGxocyk7CiAgICB9CgogICAgLyoqCiAgICAgKiBB\ncHBlbmQgYW4geG1sIGNvbXBhcmlzb24gcHJlZGljYXRlLgogICAgICoKICAg\nICAqIEBwYXJhbSBidWYgdGhlIFNRTCBidWZmZXIgdG8gd3JpdGUgdGhlIGNv\nbXBhcmlzb24KICAgICAqIEBwYXJhbSBvcCB0aGUgY29tcGFyaXNvbiBvcGVy\nYXRpb24gdG8gcGVyZm9ybQogICAgICogQHBhcmFtIGxocyB0aGUgbGVmdCBo\nYW5kIHNpZGUgb2YgdGhlIGNvbXBhcmlzb24gKG1hcHMgdG8geG1sIGNvbHVt\nbikKICAgICAqIEBwYXJhbSByaHMgdGhlIHJpZ2h0IGhhbmQgc2lkZSBvZiB0\naGUgY29tcGFyaXNvbgogICAgICovCiAgICBwcml2YXRlIHZvaWQgYXBwZW5k\nWG1sQ29tcGFyaXNvbjEoU1FMQnVmZmVyIGJ1ZiwgU3RyaW5nIG9wLCAKICAg\nICAgICAgICAgRmlsdGVyVmFsdWUgbGhzLCBGaWx0ZXJWYWx1ZSByaHMpIHsK\nICAgICAgICBib29sZWFuIGNhc3RyaHMgPSBmYWxzZTsKICAgICAgICBDbGFz\ncyByYyA9IEZpbHRlcnMud3JhcChyaHMuZ2V0VHlwZSgpKTsKICAgICAgICBp\nbnQgdHlwZSA9IDA7CiAgICAgICAgaWYgKHJocy5pc0NvbnN0YW50KCkpIHsK\nICAgICAgICAgICAgdHlwZSA9IGdldEpEQkNUeXBlKEphdmFUeXBlcy5nZXRU\neXBlQ29kZShyYyksIGZhbHNlKTsKICAgICAgICAgICAgY2FzdHJocyA9IHRy\ndWU7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIGFwcGVuZFhtbEV4aXN0\ncyhidWYsIGxocyk7CgogICAgICAgIGJ1Zi5hcHBlbmQoIiAiKS5hcHBlbmQo\nb3ApLmFwcGVuZCgiICIpOwogICAgICAgIAogICAgICAgIGJ1Zi5hcHBlbmQo\nIiQiKTsKICAgICAgICBpZiAoY2FzdHJocykKICAgICAgICAgICAgYnVmLmFw\ncGVuZCgiUGFybSIpOwogICAgICAgIGVsc2UKICAgICAgICAgICAgcmhzLmFw\ncGVuZFRvKGJ1Zik7CiAgICAgICAgCiAgICAgICAgYnVmLmFwcGVuZCgiXScg\nUEFTU0lORyAiKTsKICAgICAgICBhcHBlbmRYbWxWYXIoYnVmLCBsaHMpOwog\nICAgICAgIGJ1Zi5hcHBlbmQoIiwgIik7CiAgICAgICAgCiAgICAgICAgaWYg\nKGNhc3RyaHMpCiAgICAgICAgICAgIGFwcGVuZENhc3QoYnVmLCByaHMsIHR5\ncGUpOwogICAgICAgIGVsc2UKICAgICAgICAgICAgcmhzLmFwcGVuZFRvKGJ1\nZik7CiAgICAgICAgCiAgICAgICAgYnVmLmFwcGVuZCgiIEFTIFwiIik7CiAg\nICAgICAgaWYgKGNhc3RyaHMpCiAgICAgICAgICAgIGJ1Zi5hcHBlbmQoIlBh\ncm0iKTsKICAgICAgICBlbHNlCiAgICAgICAgICAgIHJocy5hcHBlbmRUbyhi\ndWYpOwogICAgICAgIGJ1Zi5hcHBlbmQoIlwiKSIpOwogICAgfQogICAgCiAg\nICAvKioKICAgICAqIEFwcGVuZCBhbiB4bWwgY29tcGFyaXNvbiBwcmVkaWNh\ndGUuIChib3RoIG9wZXJhbmRzIG1hcCB0byB4bWwgY29sdW1uKQogICAgICoK\nICAgICAqIEBwYXJhbSBidWYgdGhlIFNRTCBidWZmZXIgdG8gd3JpdGUgdGhl\nIGNvbXBhcmlzb24KICAgICAqIEBwYXJhbSBvcCB0aGUgY29tcGFyaXNvbiBv\ncGVyYXRpb24gdG8gcGVyZm9ybQogICAgICogQHBhcmFtIGxocyB0aGUgbGVm\ndCBoYW5kIHNpZGUgb2YgdGhlIGNvbXBhcmlzb24gKG1hcHMgdG8geG1sIGNv\nbHVtbikKICAgICAqIEBwYXJhbSByaHMgdGhlIHJpZ2h0IGhhbmQgc2lkZSBv\nZiB0aGUgY29tcGFyaXNvbiAobWFwcyB0byB4bWwgY29sdW1uKQogICAgICov\nCiAgICBwcml2YXRlIHZvaWQgYXBwZW5kWG1sQ29tcGFyaXNvbjIoU1FMQnVm\nZmVyIGJ1ZiwgU3RyaW5nIG9wLCAKICAgICAgICAgICAgRmlsdGVyVmFsdWUg\nbGhzLCBGaWx0ZXJWYWx1ZSByaHMpIHsKICAgICAgICBhcHBlbmRYbWxFeGlz\ndHMoYnVmLCBsaHMpOwogICAgICAgIAogICAgICAgIGJ1Zi5hcHBlbmQoIiAi\nKS5hcHBlbmQob3ApLmFwcGVuZCgiICIpOwogICAgICAgIAogICAgICAgIGJ1\nZi5hcHBlbmQoIiQiKS5hcHBlbmQocmhzLmdldENvbHVtbkFsaWFzKAogICAg\nICAgICAgICByaHMuZ2V0RmllbGRNYXBwaW5nKCkuZ2V0Q29sdW1ucygpWzBd\nKSkuCiAgICAgICAgICAgIGFwcGVuZCgiLyovIik7CiAgICAgICAgcmhzLmFw\ncGVuZFRvKGJ1Zik7CiAgICAgICAgCiAgICAgICAgYnVmLmFwcGVuZCgiXScg\nUEFTU0lORyAiKTsKICAgICAgICBhcHBlbmRYbWxWYXIoYnVmLCBsaHMpOwog\nICAgICAgIGJ1Zi5hcHBlbmQoIiwgIik7CiAgICAgICAgYXBwZW5kWG1sVmFy\nKGJ1ZiwgcmhzKTsKICAgICAgICBidWYuYXBwZW5kKCIpIik7CiAgICB9CiAg\nICAKICAgIHByaXZhdGUgdm9pZCBhcHBlbmRYbWxWYXIoU1FMQnVmZmVyIGJ1\nZiwgRmlsdGVyVmFsdWUgdmFsKSB7CiAgICAgICAgYnVmLmFwcGVuZCh2YWwu\nZ2V0Q29sdW1uQWxpYXMoCiAgICAgICAgICAgIHZhbC5nZXRGaWVsZE1hcHBp\nbmcoKS5nZXRDb2x1bW5zKClbMF0pKS4KICAgICAgICAgICAgYXBwZW5kKCIg\nQVMgIikuCiAgICAgICAgICAgIGFwcGVuZCgiXCIiKS5hcHBlbmQodmFsLmdl\ndENvbHVtbkFsaWFzKAogICAgICAgICAgICB2YWwuZ2V0RmllbGRNYXBwaW5n\nKCkuZ2V0Q29sdW1ucygpWzBdKSkuCiAgICAgICAgICAgIGFwcGVuZCgiXCIi\nKTsgICAgICAgIAogICAgfQogICAgCiAgICBwcml2YXRlIHZvaWQgYXBwZW5k\nWG1sRXhpc3RzKFNRTEJ1ZmZlciBidWYsIEZpbHRlclZhbHVlIHZhbCkgewog\nICAgICAgIGJ1Zi5hcHBlbmQoIlhNTEVYSVNUUygnIik7CiAgICAgICAgYnVm\nLmFwcGVuZCgiJCIpLmFwcGVuZCh2YWwuZ2V0Q29sdW1uQWxpYXMoCiAgICAg\nICAgICAgIHZhbC5nZXRGaWVsZE1hcHBpbmcoKS5nZXRDb2x1bW5zKClbMF0p\nKS4KICAgICAgICAgICAgYXBwZW5kKCIvKlsiKTsKICAgICAgICB2YWwuYXBw\nZW5kVG8oYnVmKTsgICAgICAgIAogICAgfQogICAgCiAgICAvKioKICAgICAq\nIGFkZCBDQVNUIGZvciBhIHNjYWxhciBmdW5jdGlvbiB3aGVyZSBvcGVyYW5k\nIGlzIGEgcGFyYW0KICAgICAqIAogICAgICogQHBhcmFtIGZ1bmMgb3JpZ2lu\nYWwgc3RyaW5nCiAgICAgKiBAcGFyYW0gdGFyZ2V0IHN1YnN0cmluZyB0byBs\nb29rIGZvcgogICAgICogQHBhcmFtIGFzU3RyaW5nIAogICAgICogQHJldHVy\nbiB1cGRhdGVkIHN0cmluZyAoZnVuYykKICAgICAqLwogICAgcHJpdmF0ZSBT\ndHJpbmcgYWRkQ2FzdEFzU3RyaW5nKFN0cmluZyBmdW5jLCBTdHJpbmcgdGFy\nZ2V0LCAKICAgICAgICAgICAgU3RyaW5nIGFzU3RyaW5nKSB7CiAgICAgICAg\nU3RyaW5nIGZzdHJpbmcgPSBmdW5jOwogICAgICAgIGlmIChmdW5jLmluZGV4\nT2YodGFyZ2V0KSAhPSAtMSkKICAgICAgICAgICAgZnN0cmluZyA9IFN0cmlu\nZ3MucmVwbGFjZSgKICAgICAgICAgICAgICAgIGZ1bmMsIHRhcmdldCwgIkNB\nU1QoIiArIHRhcmdldCArIGFzU3RyaW5nICsgIikiKTsKICAgICAgICByZXR1\ncm4gZnN0cmluZzsKICAgIH0KCiAgICAvKioKICAgICAqIGFkZCBDQVNUIGZv\nciBhIGZ1bmN0aW9uIG9wZXJhdG9yIHdoZXJlIG9wZXJhbmQgaXMgYSBwYXJh\nbQogICAgICogCiAgICAgKiBAcGFyYW0gZnVuYyBmdW5jdGlvbiBuYW1lCiAg\nICAgKiBAcGFyYW0gdmFsIHR5cGUKICAgICAqIEByZXR1cm4gdXBkYXRlZCBz\ndHJpbmcgKGZ1bmMpCiAgICAgKi8KICAgIHB1YmxpYyBTdHJpbmcgYWRkQ2Fz\ndEFzVHlwZShTdHJpbmcgZnVuYywgVmFsIHZhbCkgewogICAgICAgIFN0cmlu\nZyBmc3RyaW5nID0gbnVsbDsKICAgICAgICBTdHJpbmcgdHlwZSA9IGdldFR5\ncGVOYW1lKGdldEpEQkNUeXBlKEphdmFUeXBlcy5nZXRUeXBlQ29kZSh2YWwK\nICAgICAgICAgICAgLmdldFR5cGUoKSksIGZhbHNlKSk7CiAgICAgICAgaWYg\nKFN0cmluZy5jbGFzcy5lcXVhbHModmFsLmdldFR5cGUoKSkpCiAgICAgICAg\nICAgIHR5cGUgPSB0eXBlICsgIigiICsgY2hhcmFjdGVyQ29sdW1uU2l6ZSAr\nICIpIjsKICAgICAgICBmc3RyaW5nID0gIkNBU1QoPyBBUyAiICsgdHlwZSAr\nICIpIjsKICAgICAgICByZXR1cm4gZnN0cmluZzsKICAgIH0KCiAgICAvKioK\nICAgICAqIFJldHVybiB0aGUgYmF0Y2ggbGltaXQuIElmIHRoZSBiYXRjaExp\nbWl0IGlzIC0xLCBjaGFuZ2UgaXQgdG8gMTAwIGZvcgogICAgICogYmVzdCBw\nZXJmb3JtYW5jZQogICAgICovCiAgICBwdWJsaWMgaW50IGdldEJhdGNoTGlt\naXQoKSB7CiAgICAgICAgaW50IGxpbWl0ID0gc3VwZXIuZ2V0QmF0Y2hMaW1p\ndCgpOwogICAgICAgIGlmIChsaW1pdCA9PSBVTkxJTUlURUQpIHsKICAgICAg\nICAgICAgbGltaXQgPSBkZWZhdWx0QmF0Y2hMaW1pdDsKICAgICAgICAgICAg\naWYgKGxvZy5pc1RyYWNlRW5hYmxlZCgpKQogICAgICAgICAgICAgICAgbG9n\nLnRyYWNlKF9sb2MuZ2V0KCJiYXRjaF91bmxpbWl0IiwgU3RyaW5nLnZhbHVl\nT2YobGltaXQpKSk7CiAgICAgICAgfQogICAgICAgIHJldHVybiBsaW1pdDsK\nICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgY29ycmVjdCBDQVNU\nIGZ1bmN0aW9uIHN5bnRheAogICAgICogCiAgICAgKiBAcGFyYW0gdmFsIG9w\nZXJhbmQgb2YgY2FzdAogICAgICogQHBhcmFtIGZ1bmMgb3JpZ2luYWwgc3Ry\naW5nCiAgICAgKiBAcmV0dXJuIGEgU3RyaW5nIHdpdGggdGhlIGNvcnJlY3Qg\nQ0FTVCBmdW5jdGlvbiBzeW50YXgKICAgICAqLwogICAgcHVibGljIFN0cmlu\nZyBnZXRDYXN0RnVuY3Rpb24oVmFsIHZhbCwgU3RyaW5nIGZ1bmMpIHsKICAg\nICAgICBpZiAodmFsIGluc3RhbmNlb2YgTGl0IHx8IHZhbCBpbnN0YW5jZW9m\nIFBhcmFtKQogICAgICAgICAgICBpZiAoZnVuYy5pbmRleE9mKCJWQVJDSEFS\nIikgPT0gLTEpCiAgICAgICAgICAgICAgICBmdW5jID0gYWRkQ2FzdEFzU3Ry\naW5nKGZ1bmMsICJ7MH0iLCAiIEFTIFZBUkNIQVIoMTAwMCkiKTsKICAgICAg\nICByZXR1cm4gZnVuYzsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBpbmRleE9m\nKFNRTEJ1ZmZlciBidWYsIEZpbHRlclZhbHVlIHN0ciwgRmlsdGVyVmFsdWUg\nZmluZCwKICAgICAgICAgICAgRmlsdGVyVmFsdWUgc3RhcnQpIHsKICAgICAg\nICBpZiAoZmluZC5nZXRWYWx1ZSgpICE9IG51bGwpIHsgLy8gbm9uIGNvbnN0\nYW50cwogICAgICAgICAgICBidWYuYXBwZW5kKCIoTE9DQVRFKENBU1QoKCIp\nOwogICAgICAgICAgICBmaW5kLmFwcGVuZFRvKGJ1Zik7CiAgICAgICAgICAg\nIGJ1Zi5hcHBlbmQoIikgQVMgVkFSQ0hBUigxMDAwKSksICIpOwogICAgICAg\nIH0gZWxzZSB7CiAgICAgICAgICAgIC8vIHRoaXMgaXMgYSBjb25zdGFudAog\nICAgICAgICAgICBidWYuYXBwZW5kKCIoTE9DQVRFKCIpOwogICAgICAgICAg\nICBmaW5kLmFwcGVuZFRvKGJ1Zik7CiAgICAgICAgICAgIGJ1Zi5hcHBlbmQo\nIiwgIik7CiAgICAgICAgfQogICAgICAgIGlmIChzdHIuZ2V0VmFsdWUoKSAh\nPSBudWxsKSB7CiAgICAgICAgICAgIGJ1Zi5hcHBlbmQoIkNBU1QoKCIpOwog\nICAgICAgICAgICBzdHIuYXBwZW5kVG8oYnVmKTsKICAgICAgICAgICAgYnVm\nLmFwcGVuZCgiKSBBUyBWQVJDSEFSKDEwMDApKSIpOwogICAgICAgIH0gZWxz\nZSB7CiAgICAgICAgICAgIHN0ci5hcHBlbmRUbyhidWYpOwogICAgICAgIH0K\nICAgICAgICBpZiAoc3RhcnQgIT0gbnVsbCkgewogICAgICAgICAgICBpZiAo\nc3RhcnQuZ2V0VmFsdWUoKSA9PSBudWxsKSB7CiAgICAgICAgICAgICAgICBi\ndWYuYXBwZW5kKCIsIENBU1QoKCIpOwogICAgICAgICAgICAgICAgc3RhcnQu\nYXBwZW5kVG8oYnVmKTsKICAgICAgICAgICAgICAgIGJ1Zi5hcHBlbmQoIikg\nQVMgSU5URUdFUikgKyAxIik7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAg\nICAgICAgICAgICBidWYuYXBwZW5kKCIsICIpOwogICAgICAgICAgICAgICAg\nc3RhcnQuYXBwZW5kVG8oYnVmKTsKICAgICAgICAgICAgfQogICAgICAgIH0K\nICAgICAgICBidWYuYXBwZW5kKCIpIC0gMSkiKTsKICAgIH0KICAgIAogICAg\nLyoqIAogICAgICogQ2FzdCB0aGUgc3BlY2lmaWVkIHZhbHVlIHRvIHRoZSBz\ncGVjaWZpZWQgdHlwZS4KICAgICAqCiAgICAgKiBAcGFyYW0gYnVmIHRoZSBi\ndWZmZXIgdG8gYXBwZW5kIHRoZSBjYXN0IHRvCiAgICAgKiBAcGFyYW0gdmFs\nIHRoZSB2YWx1ZSB0byBjYXN0CiAgICAgKiBAcGFyYW0gdHlwZSB0aGUgdHlw\nZSBvZiB0aGUgY2FzZSwgZS5nLiB7QGxpbmsgVHlwZXMjTlVNRVJJQ30KICAg\nICAqLwogICAgcHVibGljIHZvaWQgYXBwZW5kQ2FzdChTUUxCdWZmZXIgYnVm\nLCBGaWx0ZXJWYWx1ZSB2YWwsIGludCB0eXBlKSB7CgogICAgICAgIC8vIENv\nbnZlcnQgdGhlIGNhc3QgZnVuY3Rpb246ICJDQVNUKHswfSBBUyB7MX0pIgog\nICAgICAgIGludCBmaXJzdFBhcmFtID0gY2FzdEZ1bmN0aW9uLmluZGV4T2Yo\nInswfSIpOwogICAgICAgIFN0cmluZyBwcmUgPSBjYXN0RnVuY3Rpb24uc3Vi\nc3RyaW5nKDAsIGZpcnN0UGFyYW0pOyAvLyAiQ0FTVCgiCiAgICAgICAgU3Ry\naW5nIG1pZCA9IGNhc3RGdW5jdGlvbi5zdWJzdHJpbmcoZmlyc3RQYXJhbSAr\nIDMpOwogICAgICAgIGludCBzZWNvbmRQYXJhbSA9IG1pZC5pbmRleE9mKCJ7\nMX0iKTsKICAgICAgICBTdHJpbmcgcG9zdDsKICAgICAgICBpZiAoc2Vjb25k\nUGFyYW0gPiAtMSkgewogICAgICAgICAgICBwb3N0ID0gbWlkLnN1YnN0cmlu\nZyhzZWNvbmRQYXJhbSArIDMpOyAvLyAiKSIKICAgICAgICAgICAgbWlkID0g\nbWlkLnN1YnN0cmluZygwLCBzZWNvbmRQYXJhbSk7IC8vICIgQVMgIgogICAg\nICAgIH0gZWxzZQogICAgICAgICAgICBwb3N0ID0gIiI7CgogICAgICAgIC8v\nIE5vIG5lZWQgdG8gYWRkIENBU1QgaWYgdGhlIHZhbHVlIGlzIGEgY29uc3Rh\nbnQKICAgICAgICBpZiAodmFsIGluc3RhbmNlb2YgTGl0IHx8IHZhbCBpbnN0\nYW5jZW9mIFBhcmFtKSB7CiAgICAgICAgICAgIGJ1Zi5hcHBlbmQocHJlKTsK\nICAgICAgICAgICAgdmFsLmFwcGVuZFRvKGJ1Zik7CiAgICAgICAgICAgIGJ1\nZi5hcHBlbmQobWlkKTsKICAgICAgICAgICAgYnVmLmFwcGVuZChnZXRUeXBl\nTmFtZSh0eXBlKSk7CiAgICAgICAgICAgIGFwcGVuZExlbmd0aChidWYsIHR5\ncGUpOwogICAgICAgICAgICBidWYuYXBwZW5kKHBvc3QpOwogICAgICAgIH0g\nZWxzZSB7CiAgICAgICAgICAgIHZhbC5hcHBlbmRUbyhidWYpOwogICAgICAg\nICAgICBTdHJpbmcgc3FsU3RyaW5nID0gYnVmLmdldFNRTChmYWxzZSk7CiAg\nICAgICAgICAgIGlmIChzcWxTdHJpbmcuZW5kc1dpdGgoIj8iKSkgewogICAg\nICAgICAgICAgICAgLy8gY2FzZSAiKD8iIC0gY29udmVydCB0byAiQ0FTVCg/\nIEFTIHR5cGUiCiAgICAgICAgICAgICAgICBTdHJpbmcgdHlwZU5hbWUgPSBn\nZXRUeXBlTmFtZSh0eXBlKTsKICAgICAgICAgICAgICAgIGlmIChTdHJpbmcu\nY2xhc3MuZXF1YWxzKHZhbC5nZXRUeXBlKCkpKQogICAgICAgICAgICAgICAg\nICAgIHR5cGVOYW1lID0gdHlwZU5hbWUgKyAiKCIgKyBjaGFyYWN0ZXJDb2x1\nbW5TaXplICsgIikiOwogICAgICAgICAgICAgICAgU3RyaW5nIHN0ciA9ICJD\nQVNUKD8gQVMgIiArIHR5cGVOYW1lICsgIikiOwogICAgICAgICAgICAgICAg\nYnVmLnJlcGxhY2VTcWxTdHJpbmcoc3FsU3RyaW5nLmxlbmd0aCgpIC0gMSwK\nICAgICAgICAgICAgICAgICAgICAgICAgc3FsU3RyaW5nLmxlbmd0aCgpLCBz\ndHIpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQoKICAgIC8qKgog\nICAgICogQ3JlYXRlIGFuIGluZGV4IGlmIG5lY2Vzc2FyeSBmb3Igc29tZSBk\nYXRhYmFzZSB0YWJsZXMKICAgICAqLwogICAgcHVibGljIHZvaWQgY3JlYXRl\nSW5kZXhJZk5lY2Vzc2FyeShTY2hlbWEgc2NoZW1hLCBTdHJpbmcgdGFibGUs\nCiAgICAgICAgICAgIENvbHVtbiBwa0NvbHVtbikgewogICAgICAgIGlmIChp\nc0RCMlpPU1Y4eE9yTGF0ZXIoKSkgewogICAgICAgICAgICAvLyBidWlsZCB0\naGUgaW5kZXggZm9yIHRoZSBzZXF1ZW5jZSB0YWJsZXMKICAgICAgICAgICAg\nLy8gdGhlIGluZGV4IG5hbWUgd2lsbCBiZSB0aGUgZnVsbHkgcXVhbGlmaWVk\nIHRhYmxlIG5hbWUgKyBfSURYCiAgICAgICAgICAgIFRhYmxlIHRhYiA9IHNj\naGVtYS5nZXRUYWJsZSh0YWJsZSk7CiAgICAgICAgICAgIEluZGV4IGlkeCA9\nIHRhYi5hZGRJbmRleCh0YWIuZ2V0RnVsbE5hbWUoKSArICJfSURYIik7CiAg\nICAgICAgICAgIGlkeC5zZXRVbmlxdWUodHJ1ZSk7CiAgICAgICAgICAgIGlk\neC5hZGRDb2x1bW4ocGtDb2x1bW4pOwogICAgICAgIH0KICAgIH0KICAgIAog\nICAgU3RyaW5nIG51bGxTYWZlKFN0cmluZyBzKSB7CiAgICAgICAgcmV0dXJu\nIHMgPT0gbnVsbCA/ICIiIDogczsKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAg\nIHByb3RlY3RlZCBCb29sZWFuIG1hdGNoRXJyb3JTdGF0ZShpbnQgc3VidHlw\nZSwgU2V0PFN0cmluZz4gZXJyb3JTdGF0ZXMsCiAgICAgICAgU1FMRXhjZXB0\naW9uIGV4KSB7CiAgICAgICAgQm9vbGVhbiByZWNvdmVyYWJsZSA9IG51bGw7\nCiAgICAgICAgU3RyaW5nIGVycm9yU3RhdGUgPSBleC5nZXRTUUxTdGF0ZSgp\nOwogICAgICAgIGlmIChlcnJvclN0YXRlcy5jb250YWlucyhlcnJvclN0YXRl\nKSkgewogICAgICAgICAgICByZWNvdmVyYWJsZSA9IEJvb2xlYW4uRkFMU0U7\nCiAgICAgICAgICAgIGlmIChzdWJ0eXBlID09IFN0b3JlRXhjZXB0aW9uLkxP\nQ0sgJiYgZXJyb3JTdGF0ZS5lcXVhbHMoIjU3MDMzIikKICAgICAgICAgICAg\nICAgICYmIGV4LmdldE1lc3NhZ2UoKS5pbmRleE9mKCI4MCIpICE9IC0xKSB7\nCiAgICAgICAgICAgICAgICByZWNvdmVyYWJsZSA9IEJvb2xlYW4uVFJVRTsK\nICAgICAgICAgICAgfSBlbHNlIGlmICgoc3VidHlwZSA9PSBTdG9yZUV4Y2Vw\ndGlvbi5RVUVSWSAmJgogICAgICAgICAgICAgICAgZXJyb3JTdGF0ZS5lcXVh\nbHMoIjU3MDE0IikpICYmCiAgICAgICAgICAgICAgICAoZXguZ2V0RXJyb3JD\nb2RlKCkgPT0gLTk1MiB8fCBleC5nZXRFcnJvckNvZGUoKSA9PSAtOTA1KSkg\newogICAgICAgICAgICAgICAgcmVjb3ZlcmFibGUgPSBCb29sZWFuLlRSVUU7\nCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIHJlY292\nZXJhYmxlOwogICAgfQogICAgCiAgICAvKioKICAgICAqIEByZXR1cm4gdGhl\nIHVuc3VwcG9ydGVkRGVsaW1pdGVkSWRzCiAgICAgKi8KICAgIEBPdmVycmlk\nZQogICAgcHJvdGVjdGVkIEVudW1TZXQ8REJJZGVudGlmaWVycz4gZ2V0VW5z\ndXBwb3J0ZWREZWxpbWl0ZWRJZHMoKSB7CiAgICAgICAgcmV0dXJuIHVuc3Vw\ncG9ydGVkRGVsaW1pdGVkSWRzOwogICAgfQogICAgCiAgICBAT3ZlcnJpZGUK\nICAgIHByb3RlY3RlZCB2b2lkIHNldERlbGltaXRlZENhc2UoRGF0YWJhc2VN\nZXRhRGF0YSBtZXRhRGF0YSkgewogICAgICAgIGRlbGltaXRlZENhc2UgPSBT\nQ0hFTUFfQ0FTRV9QUkVTRVJWRTsKICAgIH0KICAgIAogICAgLyoqCiAgICAg\nKiBUaGUgVHlwZSAyIEpEQkMgRHJpdmVyIG1heSB0aHJvdyBhbiBTUUxFeGNl\ncHRpb24gd2hlbiBwcm92aWRlZCBhIG5vbi0KICAgICAqIHplcm8gdGltZW91\ndCBpZiB3ZSdyZSBjb25uZWN0ZWQgdG8gWi9PUy4gVGhlIFNRTEV4Y2VwdGlv\nbiBzaG91bGQgYmUKICAgICAqIGxvZ2dlZCBidXQgbm90IHRocm93bi4KICAg\nICAqLwogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgdm9pZCBzZXRRdWVyeVRp\nbWVvdXQoUHJlcGFyZWRTdGF0ZW1lbnQgc3RtbnQsIGludCB0aW1lb3V0KQog\nICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIGlmKGlzREIy\nWk9TVjh4T3JMYXRlcigpKSB7IAogICAgICAgICAgICB0cnkgeyAKICAgICAg\nICAgICAgICAgIHN1cGVyLnNldFF1ZXJ5VGltZW91dChzdG1udCwgdGltZW91\ndCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2F0Y2ggKFNRTEV4Y2Vw\ndGlvbiBlKSB7CiAgICAgICAgICAgICAgICBpZiAobG9nLmlzVHJhY2VFbmFi\nbGVkKCkpIHsKICAgICAgICAgICAgICAgICAgICBsb2cudHJhY2UoX2xvYy5n\nZXQoImVycm9yLXNldHRpbmctcXVlcnktdGltZW91dCIsIHRpbWVvdXQsCiAg\nICAgICAgICAgICAgICAgICAgICAgIGUuZ2V0TWVzc2FnZSgpKSwgZSk7CiAg\nICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAg\nICAgZWxzZSB7IAogICAgICAgICAgICBzdXBlci5zZXRRdWVyeVRpbWVvdXQo\nc3RtbnQsIHRpbWVvdXQpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAg\nICAqIFNldCB0aGUgZ2l2ZW4gdmFsdWUgYXMgYSBwYXJhbWV0ZXIgdG8gdGhl\nIHN0YXRlbWVudC4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0Qnl0ZXMo\nUHJlcGFyZWRTdGF0ZW1lbnQgc3RtbnQsIGludCBpZHgsIGJ5dGVbXSB2YWws\nCiAgICAgICAgQ29sdW1uIGNvbCkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0\naW9uIHsKICAgICAgICAvLyBmb3IgREIyLCBpZiB0aGUgY29sdW1uIHdhcyBk\nZWZpbmVkIGFzIENIQVIgZm9yIEJJVCBEQVRBLCB0aGVuCiAgICAgICAgLy8g\nd2Ugd2FudCB0byB1c2UgdGhlIHNldEJ5dGVzIGluIHN0ZWFkIG9mIHRoZSBz\nZXRCaW5hcnlTdHJlYW0KICAgICAgICBpZiAodXNlU2V0Qnl0ZXNGb3JCbG9i\ncyAKICAgICAgICAgICAgICAgIHx8IChjb2wuZ2V0VHlwZU5hbWUoKSAhPSBu\ndWxsICYmIGNvbC5nZXRUeXBlTmFtZSgpLmNvbnRhaW5zKCJCSVQgREFUQSIp\nKSkgewogICAgICAgICAgICBzdG1udC5zZXRCeXRlcyhpZHgsIHZhbCk7CiAg\nICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgc2V0QmluYXJ5U3RyZWFtKHN0\nbW50LCBpZHgsIG5ldyBCeXRlQXJyYXlJbnB1dFN0cmVhbSh2YWwpLCB2YWwu\nbGVuZ3RoLCBjb2wpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAq\nIENvbnZlcnQgdGhlIHNwZWNpZmllZCBjb2x1bW4gb2YgdGhlIFNRTCBSZXN1\nbHRTZXQgdG8gdGhlIHByb3BlcgogICAgICogamF2YSB0eXBlLgogICAgICov\nCiAgICBwdWJsaWMgYnl0ZVtdIGdldEJ5dGVzKFJlc3VsdFNldCBycywgaW50\nIGNvbHVtbikKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAg\nICBpZiAodXNlR2V0Qnl0ZXNGb3JCbG9icykgewogICAgICAgICAgICByZXR1\ncm4gcnMuZ2V0Qnl0ZXMoY29sdW1uKTsKICAgICAgICB9CiAgICAgICAgaWYg\nKHVzZUdldE9iamVjdEZvckJsb2JzKSB7CiAgICAgICAgICAgIHJldHVybiAo\nYnl0ZVtdKSBycy5nZXRPYmplY3QoY29sdW1uKTsKICAgICAgICB9CgogICAg\nICAgIC8vIEF0IHRoaXMgcG9pbnQgd2UgZG9uJ3QgaGF2ZSBhbnkgaWRlYSBp\nZiB0aGUgREIyIGNvbHVtbiB3YXMgZGVmaW5lZCBhcwogICAgICAgIC8vICAg\nICBhIGJsb2Igb3IgaWYgaXQgd2FzIGRlZmluZWQgYXMgQ0hBUiBmb3IgQklU\nIERBVEEuCiAgICAgICAgLy8gRmlyc3QgdHJ5IGFzIGEgYmxvYiwgaWYgdGhh\ndCBkb2Vzbid0IHdvcmssIHRoZW4gdHJ5IGFzIENIQVIgZm9yIEJJVCBEQVRB\nCiAgICAgICAgLy8gSWYgdGhhdCBkb2Vzbid0IHdvcmssIHRoZW4gZ28gYWhl\nYWQgYW5kIHRocm93IHRoZSBmaXJzdCBleGNlcHRpb24KICAgICAgICB0cnkg\newogICAgICAgICAgICBCbG9iIGJsb2IgPSBnZXRCbG9iKHJzLCBjb2x1bW4p\nOwogICAgICAgICAgICBpZiAoYmxvYiA9PSBudWxsKSB7CiAgICAgICAgICAg\nICAgICByZXR1cm4gbnVsbDsKICAgICAgICAgICAgfQogICAgICAgICAgICAK\nICAgICAgICAgICAgaW50IGxlbmd0aCA9IChpbnQpIGJsb2IubGVuZ3RoKCk7\nCiAgICAgICAgICAgIGlmIChsZW5ndGggPT0gMCkgewogICAgICAgICAgICAg\nICAgcmV0dXJuIG51bGw7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgCiAg\nICAgICAgICAgIHJldHVybiBibG9iLmdldEJ5dGVzKDEsIGxlbmd0aCk7CiAg\nICAgICAgfQogICAgICAgIGNhdGNoIChTUUxFeGNlcHRpb24gZSkgewogICAg\nICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgcmV0dXJuIHJzLmdldEJ5\ndGVzKGNvbHVtbik7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2F0Y2gg\nKFNRTEV4Y2VwdGlvbiBlMikgewogICAgICAgICAgICAgICAgdGhyb3cgZTsg\nICAgICAgICAgICAgICAgCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9\nCn0K\n","encoding":"base64"}

