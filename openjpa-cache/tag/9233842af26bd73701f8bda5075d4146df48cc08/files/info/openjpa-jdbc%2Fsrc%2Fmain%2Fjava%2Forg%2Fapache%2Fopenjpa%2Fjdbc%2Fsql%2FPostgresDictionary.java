{"sha":"1ecf0feece32a574a3db694474fe5569b56ddff4","node_id":"MDQ6QmxvYjIwNjM2NDoxZWNmMGZlZWNlMzJhNTc0YTNkYjY5NDQ3NGZlNTU2OWI1NmRkZmY0","size":28911,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/1ecf0feece32a574a3db694474fe5569b56ddff4","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zcWw7CgppbXBvcnQg\namF2YS5pby5JT0V4Y2VwdGlvbjsKaW1wb3J0IGphdmEuaW8uSW5wdXRTdHJl\nYW07CmltcG9ydCBqYXZhLmlvLk91dHB1dFN0cmVhbTsKaW1wb3J0IGphdmEu\nbGFuZy5yZWZsZWN0LkNvbnN0cnVjdG9yOwppbXBvcnQgamF2YS5sYW5nLnJl\nZmxlY3QuSW52b2NhdGlvblRhcmdldEV4Y2VwdGlvbjsKaW1wb3J0IGphdmEu\nbGFuZy5yZWZsZWN0Lk1ldGhvZDsKaW1wb3J0IGphdmEuc3FsLkNvbm5lY3Rp\nb247CmltcG9ydCBqYXZhLnNxbC5EYXRhYmFzZU1ldGFEYXRhOwppbXBvcnQg\namF2YS5zcWwuUHJlcGFyZWRTdGF0ZW1lbnQ7CmltcG9ydCBqYXZhLnNxbC5S\nZXN1bHRTZXQ7CmltcG9ydCBqYXZhLnNxbC5TUUxFeGNlcHRpb247CmltcG9y\ndCBqYXZhLnNxbC5TdGF0ZW1lbnQ7CmltcG9ydCBqYXZhLnNxbC5UeXBlczsK\naW1wb3J0IGphdmEudGV4dC5QYXJzZUV4Y2VwdGlvbjsKaW1wb3J0IGphdmEu\ndGV4dC5TaW1wbGVEYXRlRm9ybWF0OwppbXBvcnQgamF2YS51dGlsLkFycmF5\nczsKaW1wb3J0IGphdmEudXRpbC5EYXRlOwppbXBvcnQgamF2YS51dGlsLk1h\ncDsKCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5rZXJuZWwuSkRC\nQ0ZldGNoQ29uZmlndXJhdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUub3Blbmpw\nYS5qZGJjLmtlcm5lbC5KREJDU3RvcmU7CmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEuamRiYy5rZXJuZWwuZXhwcy5GaWx0ZXJWYWx1ZTsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNjaGVtYS5Db2x1bW47CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hlbWEuU2VxdWVuY2U7CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hlbWEuVGFibGU7CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLkZpbHRlcnM7CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEubGliLmpkYmMuRGVsZWdhdGluZ0Nvbm5lY3Rp\nb247CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLmpkYmMuRGVsZWdh\ndGluZ1ByZXBhcmVkU3RhdGVtZW50OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLmxpYi51dGlsLkNvbmNyZXRlQ2xhc3NHZW5lcmF0b3I7CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuTG9jYWxpemVyOwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuSmF2YVR5cGVzOwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLnV0aWwuSW50ZXJuYWxFeGNlcHRpb247CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5TdG9yZUV4Y2VwdGlvbjsKaW1w\nb3J0IG9yZy5wb3N0Z3Jlc3FsLlBHQ29ubmVjdGlvbjsKaW1wb3J0IG9yZy5w\nb3N0Z3Jlc3FsLmxhcmdlb2JqZWN0LkxhcmdlT2JqZWN0OwppbXBvcnQgb3Jn\nLnBvc3RncmVzcWwubGFyZ2VvYmplY3QuTGFyZ2VPYmplY3RNYW5hZ2VyOwoK\nLyoqCiAqIERpY3Rpb25hcnkgZm9yIFBvc3RncmVzLgogKi8KcHVibGljIGNs\nYXNzIFBvc3RncmVzRGljdGlvbmFyeQogICAgZXh0ZW5kcyBEQkRpY3Rpb25h\ncnkgewoKICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIExvY2FsaXplciBfbG9j\nID0gTG9jYWxpemVyLmZvclBhY2thZ2UKICAgICAgICAoUG9zdGdyZXNEaWN0\naW9uYXJ5LmNsYXNzKTsKCiAgICBwcml2YXRlIHN0YXRpYyBDb25zdHJ1Y3Rv\ncjxQb3N0Z3Jlc0Nvbm5lY3Rpb24+IHBvc3RncmVzQ29ubmVjdGlvbkltcGw7\nCiAgICBwcml2YXRlIHN0YXRpYyBDb25zdHJ1Y3RvcjxQb3N0Z3Jlc1ByZXBh\ncmVkU3RhdGVtZW50PiBwb3N0Z3Jlc1ByZXBhcmVkU3RhdGVtZW50SW1wbDsK\nCiAgICBzdGF0aWMgewogICAgICAgIHRyeSB7CiAgICAgICAgICAgIHBvc3Rn\ncmVzQ29ubmVjdGlvbkltcGwgPSBDb25jcmV0ZUNsYXNzR2VuZXJhdG9yLmdl\ndENvbmNyZXRlQ29uc3RydWN0b3IoUG9zdGdyZXNDb25uZWN0aW9uLmNsYXNz\nLAogICAgICAgICAgICAgICAgICAgIENvbm5lY3Rpb24uY2xhc3MsIFBvc3Rn\ncmVzRGljdGlvbmFyeS5jbGFzcyk7CiAgICAgICAgICAgIHBvc3RncmVzUHJl\ncGFyZWRTdGF0ZW1lbnRJbXBsID0gQ29uY3JldGVDbGFzc0dlbmVyYXRvci5n\nZXRDb25jcmV0ZUNvbnN0cnVjdG9yKAogICAgICAgICAgICAgICAgICAgIFBv\nc3RncmVzUHJlcGFyZWRTdGF0ZW1lbnQuY2xhc3MsCiAgICAgICAgICAgICAg\nICAgICAgUHJlcGFyZWRTdGF0ZW1lbnQuY2xhc3MsIENvbm5lY3Rpb24uY2xh\nc3MsIFBvc3RncmVzRGljdGlvbmFyeS5jbGFzcyk7CiAgICAgICAgfSBjYXRj\naCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgdGhyb3cgbmV3IEV4Y2Vw\ndGlvbkluSW5pdGlhbGl6ZXJFcnJvcihlKTsKICAgICAgICB9CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBTUUwgc3RhdGVtZW50IHRvIGxvYWQgYWxsIHNlcXVl\nbmNlIHNjaGVtYSxuYW1lIHBhaXJzIGZyb20gYWxsIHNjaGVtYXMuCiAgICAg\nKi8KICAgIHB1YmxpYyBTdHJpbmcgYWxsU2VxdWVuY2VzU1FMID0gIlNFTEVD\nVCBOVUxMIEFTIFNFUVVFTkNFX1NDSEVNQSwgcmVsbmFtZSAiICsKICAgICAg\nICAiQVMgU0VRVUVOQ0VfTkFNRSBGUk9NIHBnX2NsYXNzIFdIRVJFIHJlbGtp\nbmQ9J1MnIjsKCiAgICAvKioKICAgICAqIFNRTCBzdGF0ZW1lbnQgdG8gbG9h\nZCBzY2hlbWEsbmFtZSBwYWlycyBmb3IgYWxsIHNlcXVlbmNlcyB3aXRoIGEK\nICAgICAqIGNlcnRhaW4gbmFtZSBmcm9tIGFsbCBzY2hlbWFzLgogICAgICov\nCiAgICBwdWJsaWMgU3RyaW5nIG5hbWVkU2VxdWVuY2VzRnJvbUFsbFNjaGVt\nYXNTUUwgPSAiU0VMRUNUIE5VTEwgQVMgIiArCiAgICAgICAgIlNFUVVFTkNF\nX1NDSEVNQSwgcmVsbmFtZSBBUyBTRVFVRU5DRV9OQU1FIEZST00gcGdfY2xh\nc3MgIiArCiAgICAgICAgIldIRVJFIHJlbGtpbmQ9J1MnIEFORCByZWxuYW1l\nID0gPyI7CgogICAgLyoqCiAgICAgKiBTUUwgc3RhdGVtZW50IHRvIGxvYWQg\nc2NoZW1hLG5hbWUgcGFpcnMgZnJvbSBhIG5hbWVkIHNjaGVtYS4KICAgICAq\nLwogICAgcHVibGljIFN0cmluZyBhbGxTZXF1ZW5jZXNGcm9tT25lU2NoZW1h\nU1FMID0gIlNFTEVDVCBOVUxMIEFTICIgKwogICAgICAgICJTRVFVRU5DRV9T\nQ0hFTUEsIHJlbG5hbWUgQVMgU0VRVUVOQ0VfTkFNRSBGUk9NIHBnX2NsYXNz\nLCAiICsKICAgICAgICAicGdfbmFtZXNwYWNlIFdIRVJFIHJlbGtpbmQ9J1Mn\nIEFORCBwZ19jbGFzcy5yZWxuYW1lc3BhY2UgPSAiICsKICAgICAgICAicGdf\nbmFtZXNwYWNlLm9pZCBBTkQgbnNwbmFtZSA9ID8iOwoKICAgIC8qKgogICAg\nICogU1FMIHN0YXRlbWVudCB0byBsb2FkIGEgc2VxdWVuY2UncyBzY2hlbWEs\nbmFtZSBwYWlyIGZyb20gb25lIHNjaGVtYS4KICAgICAqLwogICAgcHVibGlj\nIFN0cmluZyBuYW1lZFNlcXVlbmNlRnJvbU9uZVNjaGVtYVNRTCA9ICJTRUxF\nQ1QgTlVMTCBBUyAiICsKICAgICAgICAiU0VRVUVOQ0VfU0NIRU1BLCByZWxu\nYW1lIEFTIFNFUVVFTkNFX05BTUUgRlJPTSBwZ19jbGFzcywgIiArCiAgICAg\nICAgInBnX25hbWVzcGFjZSBXSEVSRSByZWxraW5kPSdTJyBBTkQgcGdfY2xh\nc3MucmVsbmFtZXNwYWNlID0gIiArCiAgICAgICAgInBnX25hbWVzcGFjZS5v\naWQgQU5EIHJlbG5hbWUgPSA/IEFORCBuc3BuYW1lID0gPyI7CgogICAgLyoq\nCiAgICAgKiBTb21lIFBvc3RncmVzIGRyaXZlcnMgZG8gbm90IHN1cHBvcnQg\ndGhlIHtAbGluayBTdGF0ZW1lbnQjc2V0RmV0Y2hTaXplfQogICAgICogbWV0\naG9kLgogICAgICovCiAgICBwdWJsaWMgYm9vbGVhbiBzdXBwb3J0c1NldEZl\ndGNoU2l6ZSA9IHRydWU7CgogICAgcHVibGljIFBvc3RncmVzRGljdGlvbmFy\neSgpIHsKICAgICAgICBwbGF0Zm9ybSA9ICJQb3N0Z3JlU1FMIjsKICAgICAg\nICB2YWxpZGF0aW9uU1FMID0gIlNFTEVDVCBOT1coKSI7CiAgICAgICAgZGF0\nZVByZWNpc2lvbiA9IENFTlRJOwogICAgICAgIHN1cHBvcnRzQWx0ZXJUYWJs\nZVdpdGhEcm9wQ29sdW1uID0gZmFsc2U7CiAgICAgICAgc3VwcG9ydHNEZWZl\ncnJlZENvbnN0cmFpbnRzID0gdHJ1ZTsKICAgICAgICBzdXBwb3J0c1NlbGVj\ndFN0YXJ0SW5kZXggPSB0cnVlOwogICAgICAgIHN1cHBvcnRzU2VsZWN0RW5k\nSW5kZXggPSB0cnVlOwoKICAgICAgICAvLyBQb3N0Z3JlU1FMIHJlcXVpcmVz\nIGRvdWJsZS1lc2NhcGUgZm9yIHN0cmluZ3MKICAgICAgICBzZWFyY2hTdHJp\nbmdFc2NhcGUgPSAiXFxcXCI7CgogICAgICAgIG1heFRhYmxlTmFtZUxlbmd0\naCA9IDYzOwogICAgICAgIG1heENvbHVtbk5hbWVMZW5ndGggPSA2MzsKICAg\nICAgICBtYXhJbmRleE5hbWVMZW5ndGggPSA2MzsKICAgICAgICBtYXhDb25z\ndHJhaW50TmFtZUxlbmd0aCA9IDYzOwogICAgICAgIG1heEF1dG9Bc3NpZ25O\nYW1lTGVuZ3RoID0gNjM7CiAgICAgICAgc2NoZW1hQ2FzZSA9IFNDSEVNQV9D\nQVNFX0xPV0VSOwogICAgICAgIHJhbmdlUG9zaXRpb24gPSBSQU5HRV9QT1NU\nX0xPQ0s7CiAgICAgICAgcmVxdWlyZXNBbGlhc0ZvclN1YnNlbGVjdCA9IHRy\ndWU7CiAgICAgICAgYWxsb3dzQWxpYXNJbkJ1bGtDbGF1c2UgPSBmYWxzZTsK\nCiAgICAgICAgLy8gc2luZ2xlLXF1b3RlIGVzY2FwZSB3aWxsIHJlc3VsdCBp\nbiBTRUxFQ1QgQ1VSVkFMKCdteXNlcXVlbmNlJykKICAgICAgICBsYXN0R2Vu\nZXJhdGVkS2V5UXVlcnkgPSAiU0VMRUNUIENVUlJWQUwoJyd7MX1fezB9X3Nl\ncScnKSI7CiAgICAgICAgc3VwcG9ydHNBdXRvQXNzaWduID0gdHJ1ZTsKICAg\nICAgICBhdXRvQXNzaWduVHlwZU5hbWUgPSAiQklHU0VSSUFMIjsKICAgICAg\nICBuZXh0U2VxdWVuY2VRdWVyeSA9ICJTRUxFQ1QgTkVYVFZBTCgnJ3swfScn\nKSI7CgogICAgICAgIHVzZUdldEJ5dGVzRm9yQmxvYnMgPSB0cnVlOwogICAg\nICAgIHVzZVNldEJ5dGVzRm9yQmxvYnMgPSB0cnVlOwogICAgICAgIHVzZUdl\ndFN0cmluZ0ZvckNsb2JzID0gdHJ1ZTsKICAgICAgICB1c2VTZXRTdHJpbmdG\nb3JDbG9icyA9IHRydWU7CiAgICAgICAgYml0VHlwZU5hbWUgPSAiQk9PTCI7\nCiAgICAgICAgc21hbGxpbnRUeXBlTmFtZSA9ICJTTUFMTElOVCI7CiAgICAg\nICAgcmVhbFR5cGVOYW1lID0gIkZMT0FUOCI7CiAgICAgICAgdGlueWludFR5\ncGVOYW1lID0gIlNNQUxMSU5UIjsKICAgICAgICBiaW5hcnlUeXBlTmFtZSA9\nICJCWVRFQSI7CiAgICAgICAgYmxvYlR5cGVOYW1lID0gIkJZVEVBIjsKICAg\nICAgICBsb25nVmFyYmluYXJ5VHlwZU5hbWUgPSAiQllURUEiOwogICAgICAg\nIHZhcmJpbmFyeVR5cGVOYW1lID0gIkJZVEVBIjsKICAgICAgICBjbG9iVHlw\nZU5hbWUgPSAiVEVYVCI7CiAgICAgICAgbG9uZ1ZhcmNoYXJUeXBlTmFtZSA9\nICJURVhUIjsKICAgICAgICBkb3VibGVUeXBlTmFtZSA9ICJET1VCTEUgUFJF\nQ0lTSU9OIjsKICAgICAgICB0aW1lc3RhbXBUeXBlTmFtZSA9ICJBQlNUSU1F\nIjsKICAgICAgICBmaXhlZFNpemVUeXBlTmFtZVNldC5hZGRBbGwoQXJyYXlz\nLmFzTGlzdChuZXcgU3RyaW5nW117CiAgICAgICAgICAgICJCT09MIiwgIkJZ\nVEVBIiwgIk5BTUUiLCAiSU5UOCIsICJJTlQyIiwgIklOVDJWRUNUT1IiLCAi\nSU5UNCIsCiAgICAgICAgICAgICJSRUdQUk9DIiwgIlRFWFQiLCAiT0lEIiwg\nIlRJRCIsICJYSUQiLCAiQ0lEIiwgIk9JRFZFQ1RPUiIsCiAgICAgICAgICAg\nICJTRVQiLCAiRkxPQVQ0IiwgIkZMT0FUOCIsICJBQlNUSU1FIiwgIlJFTFRJ\nTUUiLCAiVElOVEVSVkFMIiwKICAgICAgICAgICAgIk1PTkVZIiwKICAgICAg\nICB9KSk7CgogICAgICAgIHN1cHBvcnRzTG9ja2luZ1dpdGhEaXN0aW5jdENs\nYXVzZSA9IGZhbHNlOwogICAgICAgIHN1cHBvcnRzUXVlcnlUaW1lb3V0ID0g\nZmFsc2U7CiAgICAgICAgc3VwcG9ydHNMb2NraW5nV2l0aE91dGVySm9pbiA9\nIGZhbHNlOwogICAgICAgIHN1cHBvcnRzTnVsbFRhYmxlRm9yR2V0SW1wb3J0\nZWRLZXlzID0gdHJ1ZTsKCiAgICAgICAgcmVzZXJ2ZWRXb3JkU2V0LmFkZEFs\nbChBcnJheXMuYXNMaXN0KG5ldyBTdHJpbmdbXXsKICAgICAgICAgICAgIkFC\nT1JUIiwgIkFDTCIsICJBR0dSRUdBVEUiLCAiQVBQRU5EIiwgIkFSQ0hJVkUi\nLCAiQVJDSF9TVE9SRSIsCiAgICAgICAgICAgICJCQUNLV0FSRCIsICJCSU5B\nUlkiLCAiQ0hBTkdFIiwgIkNMVVNURVIiLCAiQ09QWSIsICJEQVRBQkFTRSIs\nCiAgICAgICAgICAgICJERUxJTUlURVIiLCAiREVMSU1JVEVSUyIsICJETyIs\nICJFWFBMQUlOIiwgIkVYVEVORCIsCiAgICAgICAgICAgICJGT1JXQVJEIiwg\nIkhFQVZZIiwgIklOREVYIiwgIklOSEVSSVRTIiwgIklTTlVMTCIsICJMSUdI\nVCIsCiAgICAgICAgICAgICJMSVNURU4iLCAiTE9BRCIsICJNRVJHRSIsICJO\nT1RISU5HIiwgIk5PVElGWSIsICJOT1ROVUxMIiwKICAgICAgICAgICAgIk9J\nRCIsICJPSURTIiwgIlBVUkdFIiwgIlJFQ0lQRSIsICJSRU5BTUUiLCAiUkVQ\nTEFDRSIsCiAgICAgICAgICAgICJSRVRSSUVWRSIsICJSRVRVUk5TIiwgIlJV\nTEUiLCAiU0VUT0YiLCAiU1RESU4iLCAiU1RET1VUIiwKICAgICAgICAgICAg\nIlNUT1JFIiwgIlZBQ1VVTSIsICJWRVJCT1NFIiwgIlZFUlNJT04iLAogICAg\nICAgIH0pKTsKCiAgICAgICAgLy8gcmVzZXJ2ZWRXb3JkU2V0IHN1YnNldCB0\naGF0IENBTk5PVCBiZSB1c2VkIGFzIHZhbGlkIGNvbHVtbiBuYW1lcwogICAg\nICAgIC8vIChpLmUuLCB3aXRob3V0IHN1cnJvdW5kaW5nIHRoZW0gd2l0aCBk\nb3VibGUtcXVvdGVzKQogICAgICAgIGludmFsaWRDb2x1bW5Xb3JkU2V0LmFk\nZEFsbChBcnJheXMuYXNMaXN0KG5ldyBTdHJpbmdbXSB7CiAgICAgICAgICAg\nICJBTEwiLCAiQU5EIiwgIkFOWSIsICJBUyIsICJBU0MiLCAiQVVUSE9SSVpB\nVElPTiIsICJCRVRXRUVOIiwgCiAgICAgICAgICAgICJCSU5BUlkiLCAiQk9U\nSCIsICJDQVNFIiwgIkNBU1QiLCAiQ0hFQ0siLCAiQ09MTEFURSIsICJDT0xV\nTU4iLAogICAgICAgICAgICAiQ09OU1RSQUlOVCIsICJDUkVBVEUiLCAiQ1JP\nU1MiLCAiQ1VSUkVOVF9EQVRFIiwgIkNVUlJFTlRfVElNRSIsCiAgICAgICAg\nICAgICJDVVJSRU5UX1RJTUVTVEFNUCIsICJDVVJSRU5UX1VTRVIiLCAiREVG\nQVVMVCIsICJERUZFUlJBQkxFIiwgCiAgICAgICAgICAgICJERVNDIiwgIkRJ\nU1RJTkNUIiwgIkRPIiwgIkVMU0UiLCAiRU5EIiwgIkVORCIsICJFWENFUFQi\nLCAiRkFMU0UiLAogICAgICAgICAgICAiRk9SIiwgIkZPUkVJR04iLCAiRlJP\nTSIsICJGVUxMIiwgIkdSQU5UIiwgIkdST1VQIiwgIkhBVklORyIsICJJTiIs\nCiAgICAgICAgICAgICJJTklUSUFMTFkiLCAiSU5ORVIiLCAiSU5URVJTRUNU\nIiwgIklOVE8iLCAiSVMiLCAiSVNOVUxMIiwgIkpPSU4iLAogICAgICAgICAg\nICAiTEVBRElORyIsICJMRUZUIiwgIkxJS0UiLCAiTkFUVVJBTCIsICJOT1Qi\nLCAiTk9UTlVMTCIsICJOVUxMIiwgCiAgICAgICAgICAgICJPTiIsICJPTkxZ\nIiwgIk9SIiwgIk9SREVSIiwgIk9VVEVSIiwgIk9WRVJMQVBTIiwgIlBSSU1B\nUlkiLAogICAgICAgICAgICAiUkVGRVJFTkNFUyIsICJSSUdIVCIsICJTRUxF\nQ1QiLCAiU0VTU0lPTl9VU0VSIiwgIlNPTUUiLCAiVEFCTEUiLAogICAgICAg\nICAgICAiVEhFTiIsICJUTyIsICJUUkFJTElORyIsICJUUlVFIiwgIlVOSU9O\nIiwgIlVOSVFVRSIsICJVU0VSIiwgCiAgICAgICAgICAgICJVU0lORyIsICJW\nRVJCT1NFIiwgIldIRU4iLCAiV0hFUkUiLAogICAgICAgIH0pKTsKICAgIH0K\nCiAgICBwdWJsaWMgRGF0ZSBnZXREYXRlKFJlc3VsdFNldCBycywgaW50IGNv\nbHVtbikKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICB0\ncnkgewogICAgICAgICAgICByZXR1cm4gc3VwZXIuZ2V0RGF0ZShycywgY29s\ndW1uKTsKICAgICAgICB9IGNhdGNoIChTdHJpbmdJbmRleE91dE9mQm91bmRz\nRXhjZXB0aW9uIHNpb29iZSkgewogICAgICAgICAgICAvLyB0aGVyZSBpcyBh\nIGJ1ZyBpbiBzb21lIHZlcnNpb25zIG9mIHRoZSBwb3N0Z3JlcyBKREJDCiAg\nICAgICAgICAgIC8vIGRyaXZlciBzdWNoIHRoYXQgYSBkYXRlIHdpdGggbm90\nIGVub3VnaCBudW1iZXJzIGluIGl0CiAgICAgICAgICAgIC8vIHdpbGwgdGhy\nb3cgYSBwYXJzaW5nIGV4Y2VwdGlvbjogdGhpcyB0cmllcyB0byB3b3JrCiAg\nICAgICAgICAgIC8vIGFyb3VuZCBpdC4gVGhlIGJ1ZyBvbmx5IG9jY3VycyB3\naGVuIHRoZXJlIGlzIGEgdHJhaWxpbmcKICAgICAgICAgICAgLy8gbWlsbGlz\nZWNvbmQgbWlzc2luZyBmcm9tIHRoZSBlbmQuIEUuZy4sIHdoZW4gdGhlIGRh\ndGUgaXMKICAgICAgICAgICAgLy8gbGlrZToKICAgICAgICAgICAgLy8gMjA2\nNi0xMC0xOSAyMjowODozMi44MwogICAgICAgICAgICAvLyByYXRoZXIgdGhh\nbiB3aGF0IHRoZSBkcml2ZXIgZXhwZWN0czoKICAgICAgICAgICAgLy8gMjA2\nNi0xMC0xOSAyMjowODozMi44MzAKICAgICAgICAgICAgU3RyaW5nIGRhdGVT\ndHIgPSBycy5nZXRTdHJpbmcoY29sdW1uKTsKICAgICAgICAgICAgU2ltcGxl\nRGF0ZUZvcm1hdCBmbXQgPSBuZXcgU2ltcGxlRGF0ZUZvcm1hdCgKICAgICAg\nICAgICAgICAgICJ5eXl5LU1NLWRkIGhoOm1tOnNzLlNTIik7CiAgICAgICAg\nICAgIHRyeSB7CiAgICAgICAgICAgICAgICByZXR1cm4gZm10LnBhcnNlKGRh\ndGVTdHIpOwogICAgICAgICAgICB9IGNhdGNoIChQYXJzZUV4Y2VwdGlvbiBw\nZSkgewogICAgICAgICAgICAgICAgdGhyb3cgbmV3IFNRTEV4Y2VwdGlvbihw\nZS50b1N0cmluZygpKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0K\nCiAgICBwdWJsaWMgYnl0ZSBnZXRCeXRlKFJlc3VsdFNldCBycywgaW50IGNv\nbHVtbikKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAv\nLyBwb3N0Z3JlcyBkb2VzIG5vdCBwZXJmb3JtIGF1dG9tYXRpYyBjb252ZXJz\naW9ucywgc28gYXR0ZW1wdGluZyB0bwogICAgICAgIC8vIGdldCBhIHdob2xl\nIG51bWJlciBvdXQgb2YgYSBkZWNpbWFsIHdpbGwgdGhyb3cgYW4gZXhjZXB0\naW9uLgogICAgICAgIC8vIGZhbGwgYmFjayB0byBwZXJmb3JtaW5nIG1hbnVh\nbCBjb252ZXJzaW9uIGlmIHRoZSBpbml0aWFsIGdldCBmYWlscwogICAgICAg\nIHRyeSB7CiAgICAgICAgICAgIHJldHVybiBzdXBlci5nZXRCeXRlKHJzLCBj\nb2x1bW4pOwogICAgICAgIH0gY2F0Y2ggKFNRTEV4Y2VwdGlvbiBzcWxlKSB7\nCiAgICAgICAgICAgIHJldHVybiBzdXBlci5nZXRCaWdEZWNpbWFsKHJzLCBj\nb2x1bW4pLmJ5dGVWYWx1ZSgpOwogICAgICAgIH0KICAgIH0KCiAgICBwdWJs\naWMgc2hvcnQgZ2V0U2hvcnQoUmVzdWx0U2V0IHJzLCBpbnQgY29sdW1uKQog\nICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIC8vIHBvc3Rn\ncmVzIGRvZXMgbm90IHBlcmZvcm0gYXV0b21hdGljIGNvbnZlcnNpb25zLCBz\nbyBhdHRlbXB0aW5nIHRvCiAgICAgICAgLy8gZ2V0IGEgd2hvbGUgbnVtYmVy\nIG91dCBvZiBhIGRlY2ltYWwgd2lsbCB0aHJvdyBhbiBleGNlcHRpb24uCiAg\nICAgICAgLy8gZmFsbCBiYWNrIHRvIHBlcmZvcm1pbmcgbWFudWFsIGNvbnZl\ncnNpb24gaWYgdGhlIGluaXRpYWwgZ2V0IGZhaWxzCiAgICAgICAgdHJ5IHsK\nICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmdldFNob3J0KHJzLCBjb2x1bW4p\nOwogICAgICAgIH0gY2F0Y2ggKFNRTEV4Y2VwdGlvbiBzcWxlKSB7CiAgICAg\nICAgICAgIHJldHVybiBzdXBlci5nZXRCaWdEZWNpbWFsKHJzLCBjb2x1bW4p\nLnNob3J0VmFsdWUoKTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGljIGlu\ndCBnZXRJbnQoUmVzdWx0U2V0IHJzLCBpbnQgY29sdW1uKQogICAgICAgIHRo\ncm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIC8vIHBvc3RncmVzIGRvZXMg\nbm90IHBlcmZvcm0gYXV0b21hdGljIGNvbnZlcnNpb25zLCBzbyBhdHRlbXB0\naW5nIHRvCiAgICAgICAgLy8gZ2V0IGEgd2hvbGUgbnVtYmVyIG91dCBvZiBh\nIGRlY2ltYWwgd2lsbCB0aHJvdyBhbiBleGNlcHRpb24uCiAgICAgICAgLy8g\nZmFsbCBiYWNrIHRvIHBlcmZvcm1pbmcgbWFudWFsIGNvbnZlcnNpb24gaWYg\ndGhlIGluaXRpYWwgZ2V0IGZhaWxzCiAgICAgICAgdHJ5IHsKICAgICAgICAg\nICAgcmV0dXJuIHN1cGVyLmdldEludChycywgY29sdW1uKTsKICAgICAgICB9\nIGNhdGNoIChTUUxFeGNlcHRpb24gc3FsZSkgewogICAgICAgICAgICByZXR1\ncm4gc3VwZXIuZ2V0QmlnRGVjaW1hbChycywgY29sdW1uKS5pbnRWYWx1ZSgp\nOwogICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMgbG9uZyBnZXRMb25nKFJl\nc3VsdFNldCBycywgaW50IGNvbHVtbikKICAgICAgICB0aHJvd3MgU1FMRXhj\nZXB0aW9uIHsKICAgICAgICAvLyBwb3N0Z3JlcyBkb2VzIG5vdCBwZXJmb3Jt\nIGF1dG9tYXRpYyBjb252ZXJzaW9ucywgc28gYXR0ZW1wdGluZyB0bwogICAg\nICAgIC8vIGdldCBhIHdob2xlIG51bWJlciBvdXQgb2YgYSBkZWNpbWFsIHdp\nbGwgdGhyb3cgYW4gZXhjZXB0aW9uLgogICAgICAgIC8vIGZhbGwgYmFjayB0\nbyBwZXJmb3JtaW5nIG1hbnVhbCBjb252ZXJzaW9uIGlmIHRoZSBpbml0aWFs\nIGdldCBmYWlscwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIHJldHVybiBz\ndXBlci5nZXRMb25nKHJzLCBjb2x1bW4pOwogICAgICAgIH0gY2F0Y2ggKFNR\nTEV4Y2VwdGlvbiBzcWxlKSB7CiAgICAgICAgICAgIHJldHVybiBzdXBlci5n\nZXRCaWdEZWNpbWFsKHJzLCBjb2x1bW4pLmxvbmdWYWx1ZSgpOwogICAgICAg\nIH0KICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRCb29sZWFuKFByZXBhcmVk\nU3RhdGVtZW50IHN0bW50LCBpbnQgaWR4LCBib29sZWFuIHZhbCwKICAgICAg\nICBDb2x1bW4gY29sKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewog\nICAgICAgIC8vIHBvc3RncmVzIGFjdHVhbGx5IHJlcXVpcmVzIHRoYXQgYSBi\nb29sZWFuIGJlIHNldDogaXQgY2Fubm90CiAgICAgICAgLy8gaGFuZGxlIGEg\nbnVtZXJpYyBhcmd1bWVudC4KICAgICAgICBzdG1udC5zZXRCb29sZWFuKGlk\neCwgdmFsKTsKICAgIH0KCiAgICAvKioKICAgICAqIEhhbmRsZSBYTUwgYW5k\nIGJ5dGVhL29pZCBjb2x1bW5zIGluIGEgUG9zdGdyZVNRTCB3YXkuCiAgICAg\nKi8KICAgIHB1YmxpYyB2b2lkIHNldE51bGwoUHJlcGFyZWRTdGF0ZW1lbnQg\nc3RtbnQsIGludCBpZHgsIGludCBjb2xUeXBlLAogICAgICAgIENvbHVtbiBj\nb2wpCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgaWYg\nKGNvbCAhPSBudWxsICYmIGNvbC5pc1hNTCgpKSB7CiAgICAgICAgICAgIHN0\nbW50LnNldE51bGwoaWR4LCBUeXBlcy5PVEhFUik7CiAgICAgICAgICAgIHJl\ndHVybjsKICAgICAgICB9CgogICAgICAgIC8vIE9QRU5KUEEtMzA4CiAgICAg\nICAgaWYgKGNvbFR5cGUgPT0gVHlwZXMuQkxPQikKICAgICAgICAgICAgY29s\nVHlwZSA9IFR5cGVzLkJJTkFSWTsKICAgICAgICBzdG1udC5zZXROdWxsKGlk\neCwgY29sVHlwZSk7CiAgICB9CgogICAgcHJvdGVjdGVkIHZvaWQgYXBwZW5k\nU2VsZWN0UmFuZ2UoU1FMQnVmZmVyIGJ1ZiwgbG9uZyBzdGFydCwgbG9uZyBl\nbmQsCiAgICAgICAgYm9vbGVhbiBzdWJzZWxlY3QpIHsKICAgICAgICBpZiAo\nZW5kICE9IExvbmcuTUFYX1ZBTFVFKQogICAgICAgICAgICBidWYuYXBwZW5k\nKCIgTElNSVQgIikuYXBwZW5kVmFsdWUoZW5kIC0gc3RhcnQpOwogICAgICAg\nIGlmIChzdGFydCAhPSAwKQogICAgICAgICAgICBidWYuYXBwZW5kKCIgT0ZG\nU0VUICIpLmFwcGVuZFZhbHVlKHN0YXJ0KTsKICAgIH0KCiAgICBwdWJsaWMg\ndm9pZCBpbmRleE9mKFNRTEJ1ZmZlciBidWYsIEZpbHRlclZhbHVlIHN0ciwg\nRmlsdGVyVmFsdWUgZmluZCwKICAgICAgICBGaWx0ZXJWYWx1ZSBzdGFydCkg\newogICAgICAgIGJ1Zi5hcHBlbmQoIihQT1NJVElPTigiKTsKICAgICAgICBm\naW5kLmFwcGVuZFRvKGJ1Zik7CiAgICAgICAgYnVmLmFwcGVuZCgiIElOICIp\nOwogICAgICAgIGlmIChzdGFydCAhPSBudWxsKQogICAgICAgICAgICBzdWJz\ndHJpbmcoYnVmLCBzdHIsIHN0YXJ0LCBudWxsKTsKICAgICAgICBlbHNlCiAg\nICAgICAgICAgIHN0ci5hcHBlbmRUbyhidWYpOwogICAgICAgIGJ1Zi5hcHBl\nbmQoIikgLSAxIik7CiAgICAgICAgaWYgKHN0YXJ0ICE9IG51bGwpIHsKICAg\nICAgICAgICAgYnVmLmFwcGVuZCgiICsgIik7CiAgICAgICAgICAgIHN0YXJ0\nLmFwcGVuZFRvKGJ1Zik7CiAgICAgICAgfQogICAgICAgIGJ1Zi5hcHBlbmQo\nIikiKTsKICAgIH0KCiAgICBwdWJsaWMgU3RyaW5nW10gZ2V0Q3JlYXRlU2Vx\ndWVuY2VTUUwoU2VxdWVuY2Ugc2VxKSB7CiAgICAgICAgU3RyaW5nW10gc3Fs\nID0gc3VwZXIuZ2V0Q3JlYXRlU2VxdWVuY2VTUUwoc2VxKTsKICAgICAgICBp\nZiAoc2VxLmdldEFsbG9jYXRlKCkgPiAxKQogICAgICAgICAgICBzcWxbMF0g\nKz0gIiBDQUNIRSAiICsgc2VxLmdldEFsbG9jYXRlKCk7CiAgICAgICAgcmV0\ndXJuIHNxbDsKICAgIH0KCiAgICBwcm90ZWN0ZWQgYm9vbGVhbiBzdXBwb3J0\nc0RlZmVycmVkVW5pcXVlQ29uc3RyYWludHMoKSB7CiAgICAgICAgLy8gUG9z\ndGdyZXMgb25seSBzdXBwb3J0cyBkZWZlcnJlZCBmb3JlaWduIGtleSBjb25z\ndHJhaW50cy4KICAgICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgcHJv\ndGVjdGVkIFN0cmluZyBnZXRTZXF1ZW5jZXNTUUwoU3RyaW5nIHNjaGVtYU5h\nbWUsIFN0cmluZyBzZXF1ZW5jZU5hbWUpIHsKICAgICAgICBpZiAoc2NoZW1h\nTmFtZSA9PSBudWxsICYmIHNlcXVlbmNlTmFtZSA9PSBudWxsKQogICAgICAg\nICAgICByZXR1cm4gYWxsU2VxdWVuY2VzU1FMOwogICAgICAgIGVsc2UgaWYg\nKHNjaGVtYU5hbWUgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIG5hbWVk\nU2VxdWVuY2VzRnJvbUFsbFNjaGVtYXNTUUw7CiAgICAgICAgZWxzZSBpZiAo\nc2VxdWVuY2VOYW1lID09IG51bGwpCiAgICAgICAgICAgIHJldHVybiBhbGxT\nZXF1ZW5jZXNGcm9tT25lU2NoZW1hU1FMOwogICAgICAgIGVsc2UKICAgICAg\nICAgICAgcmV0dXJuIG5hbWVkU2VxdWVuY2VGcm9tT25lU2NoZW1hU1FMOwog\nICAgfQoKICAgIHB1YmxpYyBib29sZWFuIGlzU3lzdGVtU2VxdWVuY2UoU3Ry\naW5nIG5hbWUsIFN0cmluZyBzY2hlbWEsCiAgICAgICAgYm9vbGVhbiB0YXJn\nZXRTY2hlbWEpIHsKICAgICAgICBpZiAoc3VwZXIuaXNTeXN0ZW1TZXF1ZW5j\nZShuYW1lLCBzY2hlbWEsIHRhcmdldFNjaGVtYSkpCiAgICAgICAgICAgIHJl\ndHVybiB0cnVlOwoKICAgICAgICAvLyBmaWx0ZXIgb3V0IGdlbmVyYXRlZCBz\nZXF1ZW5jZXMgdXNlZCBmb3IgYmlnc2VyaWFsIGNvbHMsIHdoaWNoIGFyZQog\nICAgICAgIC8vIG9mIHRoZSBmb3JtIDx0YWJsZT5fPGNvbD5fc2VxCiAgICAg\nICAgaW50IGlkeCA9IG5hbWUuaW5kZXhPZignXycpOwogICAgICAgIHJldHVy\nbiBpZHggIT0gLTEgJiYgaWR4ICE9IG5hbWUubGVuZ3RoKCkgLSA0CiAgICAg\nICAgICAgICYmIG5hbWUudG9VcHBlckNhc2UoKS5lbmRzV2l0aCgiX1NFUSIp\nOwogICAgfQoKICAgIHB1YmxpYyBib29sZWFuIGlzU3lzdGVtVGFibGUoU3Ry\naW5nIG5hbWUsIFN0cmluZyBzY2hlbWEsCiAgICAgICAgYm9vbGVhbiB0YXJn\nZXRTY2hlbWEpIHsKICAgICAgICAvLyBuYW1lcyBzdGFydGluZyB3aXRoICJw\nZ18iIGFyZSByZXNlcnZlZCBmb3IgUG9zdGdyZXNxbCBpbnRlcm5hbCB1c2UK\nICAgICAgICByZXR1cm4gc3VwZXIuaXNTeXN0ZW1UYWJsZShuYW1lLCBzY2hl\nbWEsIHRhcmdldFNjaGVtYSkKICAgICAgICAgICAgfHwgKG5hbWUgIT0gbnVs\nbCAmJiBuYW1lLnRvTG93ZXJDYXNlKCkuc3RhcnRzV2l0aCgicGdfIikpOwog\nICAgfQoKICAgIHB1YmxpYyBib29sZWFuIGlzU3lzdGVtSW5kZXgoU3RyaW5n\nIG5hbWUsIFRhYmxlIHRhYmxlKSB7CiAgICAgICAgLy8gbmFtZXMgc3RhcnRp\nbmcgd2l0aCAicGdfIiBhcmUgcmVzZXJ2ZWQgZm9yIFBvc3RncmVzcWwgaW50\nZXJuYWwgdXNlCiAgICAgICAgcmV0dXJuIHN1cGVyLmlzU3lzdGVtSW5kZXgo\nbmFtZSwgdGFibGUpCiAgICAgICAgICAgIHx8IChuYW1lICE9IG51bGwgJiYg\nbmFtZS50b0xvd2VyQ2FzZSgpLnN0YXJ0c1dpdGgoInBnXyIpKTsKICAgIH0K\nCiAgICBwdWJsaWMgQ29ubmVjdGlvbiBkZWNvcmF0ZShDb25uZWN0aW9uIGNv\nbm4pCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgcmV0\ndXJuIENvbmNyZXRlQ2xhc3NHZW5lcmF0b3IubmV3SW5zdGFuY2UocG9zdGdy\nZXNDb25uZWN0aW9uSW1wbCwgc3VwZXIuZGVjb3JhdGUoY29ubiksIHRoaXMp\nOwogICAgfQoKICAgIHB1YmxpYyBJbnB1dFN0cmVhbSBnZXRMT0JTdHJlYW0o\nSkRCQ1N0b3JlIHN0b3JlLCBSZXN1bHRTZXQgcnMsCiAgICAgICAgaW50IGNv\nbHVtbikgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgRGVsZWdhdGlu\nZ0Nvbm5lY3Rpb24gY29ubiA9IChEZWxlZ2F0aW5nQ29ubmVjdGlvbilzdG9y\nZQogICAgICAgICAgICAuZ2V0Q29ubmVjdGlvbigpOwogICAgICAgIGNvbm4u\nc2V0QXV0b0NvbW1pdChmYWxzZSk7CiAgICAgICAgTGFyZ2VPYmplY3RNYW5h\nZ2VyIGxvbSA9ICgoUEdDb25uZWN0aW9uKWNvbm4uZ2V0SW5uZXJtb3N0RGVs\nZWdhdGUoKSkKICAgICAgICAuZ2V0TGFyZ2VPYmplY3RBUEkoKTsKICAgICAg\nICBpZiAocnMuZ2V0SW50KGNvbHVtbikgIT0gLTEpIHsKICAgICAgICAgICAg\nTGFyZ2VPYmplY3QgbG8gPSBsb20ub3Blbihycy5nZXRJbnQoY29sdW1uKSk7\nCiAgICAgICAgICAgIHJldHVybiBsby5nZXRJbnB1dFN0cmVhbSgpOwogICAg\nICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAg\nIH0KICAgIH0KCiAgICBwdWJsaWMgdm9pZCBpbnNlcnRCbG9iRm9yU3RyZWFt\naW5nTG9hZChSb3cgcm93LCBDb2x1bW4gY29sLCAKICAgICAgICBKREJDU3Rv\ncmUgc3RvcmUsIE9iamVjdCBvYiwgU2VsZWN0IHNlbCkgdGhyb3dzIFNRTEV4\nY2VwdGlvbiB7CiAgICAgICAgaWYgKHJvdy5nZXRBY3Rpb24oKSA9PSBSb3cu\nQUNUSU9OX0lOU0VSVCkgewogICAgICAgICAgICBpbnNlcnRQb3N0Z3Jlc0Js\nb2Iocm93LCBjb2wsIHN0b3JlLCBvYik7CiAgICAgICAgfSBlbHNlIGlmIChy\nb3cuZ2V0QWN0aW9uKCkgPT0gUm93LkFDVElPTl9VUERBVEUpIHsKICAgICAg\nICAgICAgdXBkYXRlUG9zdGdyZXNCbG9iKHJvdywgY29sLCBzdG9yZSwgb2Is\nIHNlbCk7CiAgICAgICAgfQogICAgfQoKICAgIHByaXZhdGUgdm9pZCBpbnNl\ncnRQb3N0Z3Jlc0Jsb2IoUm93IHJvdywgQ29sdW1uIGNvbCwgSkRCQ1N0b3Jl\nIHN0b3JlLAogICAgICAgIE9iamVjdCBvYikgdGhyb3dzIFNRTEV4Y2VwdGlv\nbiB7CiAgICAgICAgaWYgKG9iICE9IG51bGwpIHsKICAgICAgICAgICAgY29s\nLnNldFR5cGUoVHlwZXMuSU5URUdFUik7CiAgICAgICAgICAgIERlbGVnYXRp\nbmdDb25uZWN0aW9uIGNvbm4gPSAoRGVsZWdhdGluZ0Nvbm5lY3Rpb24pc3Rv\ncmUKICAgICAgICAgICAgLmdldENvbm5lY3Rpb24oKTsKICAgICAgICAgICAg\ndHJ5IHsKICAgICAgICAgICAgICAgIGNvbm4uc2V0QXV0b0NvbW1pdChmYWxz\nZSk7CiAgICAgICAgICAgICAgICBQR0Nvbm5lY3Rpb24gcGdjb25uID0gKFBH\nQ29ubmVjdGlvbiljb25uLmdldElubmVybW9zdERlbGVnYXRlKCk7CiAgICAg\nICAgICAgICAgICBMYXJnZU9iamVjdE1hbmFnZXIgbG9tID0gcGdjb25uLmdl\ndExhcmdlT2JqZWN0QVBJKCk7CiAgICAgICAgICAgICAgICAvLyBUaGUgY3Jl\nYXRlIG1ldGhvZCBpcyB2YWxpZCBpbiB2ZXJzaW9ucyBwcmV2aW91cyB0byA4\nLjMKICAgICAgICAgICAgICAgIC8vIGluIDguMyB0aGlzIG1ldGhvZCBpcyBk\nZXByZWNhdGVkLCB1c2UgY3JlYXRlTE8KICAgICAgICAgICAgICAgIGludCBv\naWQgPSBsb20uY3JlYXRlKCk7CiAgICAgICAgICAgICAgICBMYXJnZU9iamVj\ndCBsbyA9IGxvbS5vcGVuKG9pZCwgTGFyZ2VPYmplY3RNYW5hZ2VyLldSSVRF\nKTsKICAgICAgICAgICAgICAgIE91dHB1dFN0cmVhbSBvcyA9IGxvLmdldE91\ndHB1dFN0cmVhbSgpOwogICAgICAgICAgICAgICAgY29weSgoSW5wdXRTdHJl\nYW0pb2IsIG9zKTsKICAgICAgICAgICAgICAgIGxvLmNsb3NlKCk7CiAgICAg\nICAgICAgICAgICByb3cuc2V0SW50KGNvbCwgb2lkKTsKICAgICAgICAgICAg\nfSBjYXRjaCAoSU9FeGNlcHRpb24gaW9lKSB7CiAgICAgICAgICAgICAgICB0\naHJvdyBuZXcgU3RvcmVFeGNlcHRpb24oaW9lKTsKICAgICAgICAgICAgfSBm\naW5hbGx5IHsKICAgICAgICAgICAgICAgIGNvbm4uY2xvc2UoKTsKICAgICAg\nICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJvdy5zZXRJ\nbnQoY29sLCAtMSk7CiAgICAgICAgfQogICAgfQogICAgCiAgICBwcml2YXRl\nIHZvaWQgdXBkYXRlUG9zdGdyZXNCbG9iKFJvdyByb3csIENvbHVtbiBjb2ws\nIEpEQkNTdG9yZSBzdG9yZSwKICAgICAgICBPYmplY3Qgb2IsIFNlbGVjdCBz\nZWwpIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIEpEQkNGZXRjaENv\nbmZpZ3VyYXRpb24gZmV0Y2ggPSBzdG9yZS5nZXRGZXRjaENvbmZpZ3VyYXRp\nb24oKTsKICAgICAgICBTUUxCdWZmZXIgc3FsID0gc2VsLnRvU2VsZWN0KHRy\ndWUsIGZldGNoKTsKICAgICAgICBSZXN1bHRTZXQgcmVzID0gbnVsbDsKICAg\nICAgICBEZWxlZ2F0aW5nQ29ubmVjdGlvbiBjb25uID0gCiAgICAgICAgICAg\nIChEZWxlZ2F0aW5nQ29ubmVjdGlvbikgc3RvcmUuZ2V0Q29ubmVjdGlvbigp\nOwogICAgICAgIFByZXBhcmVkU3RhdGVtZW50IHN0bW50ID0gbnVsbDsKICAg\nICAgICB0cnkgewogICAgICAgICAgICBzdG1udCA9IHNxbC5wcmVwYXJlU3Rh\ndGVtZW50KGNvbm4sIGZldGNoLAogICAgICAgICAgICAgICAgUmVzdWx0U2V0\nLlRZUEVfU0NST0xMX1NFTlNJVElWRSwgUmVzdWx0U2V0LkNPTkNVUl9VUERB\nVEFCTEUpOwogICAgICAgICAgICBzZXRUaW1lb3V0cyhzdG1udCwgZmV0Y2gs\nIHRydWUpOwogICAgICAgICAgICByZXMgPSBzdG1udC5leGVjdXRlUXVlcnko\nKTsKICAgICAgICAgICAgaWYgKCFyZXMubmV4dCgpKSB7CiAgICAgICAgICAg\nICAgICB0aHJvdyBuZXcgSW50ZXJuYWxFeGNlcHRpb24oX2xvYy5nZXQoInN0\ncmVhbS1leGNlcHRpb24iKSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAg\naW50IG9pZCA9IHJlcy5nZXRJbnQoMSk7CiAgICAgICAgICAgIGlmIChvaWQg\nIT0gLTEpIHsKICAgICAgICAgICAgICAgIGNvbm4uc2V0QXV0b0NvbW1pdChm\nYWxzZSk7CiAgICAgICAgICAgICAgICBQR0Nvbm5lY3Rpb24gcGdjb25uID0g\nKFBHQ29ubmVjdGlvbiljb25uCiAgICAgICAgICAgICAgICAgICAgLmdldElu\nbmVybW9zdERlbGVnYXRlKCk7CiAgICAgICAgICAgICAgICBMYXJnZU9iamVj\ndE1hbmFnZXIgbG9tID0gcGdjb25uLmdldExhcmdlT2JqZWN0QVBJKCk7CiAg\nICAgICAgICAgICAgICBpZiAob2IgIT0gbnVsbCkgewogICAgICAgICAgICAg\nICAgICAgIExhcmdlT2JqZWN0IGxvID0gbG9tLm9wZW4ob2lkLCBMYXJnZU9i\namVjdE1hbmFnZXIuV1JJVEUpOwogICAgICAgICAgICAgICAgICAgIE91dHB1\ndFN0cmVhbSBvcyA9IGxvLmdldE91dHB1dFN0cmVhbSgpOwogICAgICAgICAg\nICAgICAgICAgIGNvcHkoKElucHV0U3RyZWFtKW9iLCBvcyk7CiAgICAgICAg\nICAgICAgICAgICAgbG8uY2xvc2UoKTsKICAgICAgICAgICAgICAgIH0gZWxz\nZSB7CiAgICAgICAgICAgICAgICAgICAgbG9tLmRlbGV0ZShvaWQpOwogICAg\nICAgICAgICAgICAgICAgIHJvdy5zZXRJbnQoY29sLCAtMSk7CiAgICAgICAg\nICAgICAgICB9CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAg\nICBpZiAob2IgIT0gbnVsbCkgewogICAgICAgICAgICAgICAgICAgIGNvbm4u\nc2V0QXV0b0NvbW1pdChmYWxzZSk7CiAgICAgICAgICAgICAgICAgICAgUEdD\nb25uZWN0aW9uIHBnY29ubiA9IChQR0Nvbm5lY3Rpb24pY29ubgogICAgICAg\nICAgICAgICAgICAgICAgICAuZ2V0SW5uZXJtb3N0RGVsZWdhdGUoKTsKICAg\nICAgICAgICAgICAgICAgICBMYXJnZU9iamVjdE1hbmFnZXIgbG9tID0gcGdj\nb25uLmdldExhcmdlT2JqZWN0QVBJKCk7CiAgICAgICAgICAgICAgICAgICAg\nb2lkID0gbG9tLmNyZWF0ZSgpOwogICAgICAgICAgICAgICAgICAgIExhcmdl\nT2JqZWN0IGxvID0gbG9tLm9wZW4ob2lkLCBMYXJnZU9iamVjdE1hbmFnZXIu\nV1JJVEUpOwogICAgICAgICAgICAgICAgICAgIE91dHB1dFN0cmVhbSBvcyA9\nIGxvLmdldE91dHB1dFN0cmVhbSgpOwogICAgICAgICAgICAgICAgICAgIGNv\ncHkoKElucHV0U3RyZWFtKW9iLCBvcyk7CiAgICAgICAgICAgICAgICAgICAg\nbG8uY2xvc2UoKTsKICAgICAgICAgICAgICAgICAgICByb3cuc2V0SW50KGNv\nbCwgb2lkKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAg\nICAgICB9IGNhdGNoIChJT0V4Y2VwdGlvbiBpb2UpIHsKICAgICAgICAgICAg\ndGhyb3cgbmV3IFN0b3JlRXhjZXB0aW9uKGlvZSk7CiAgICAgICAgfSBmaW5h\nbGx5IHsKICAgICAgICAgICAgaWYgKHJlcyAhPSBudWxsKQogICAgICAgICAg\nICAgICAgdHJ5IHsgcmVzLmNsb3NlICgpOyB9IGNhdGNoIChTUUxFeGNlcHRp\nb24gZSkge30KICAgICAgICAgICAgaWYgKHN0bW50ICE9IG51bGwpCiAgICAg\nICAgICAgICAgICB0cnkgeyBzdG1udC5jbG9zZSAoKTsgfSBjYXRjaCAoU1FM\nRXhjZXB0aW9uIGUpIHt9CiAgICAgICAgICAgIGlmIChjb25uICE9IG51bGwp\nCiAgICAgICAgICAgICAgICB0cnkgeyBjb25uLmNsb3NlICgpOyB9IGNhdGNo\nIChTUUxFeGNlcHRpb24gZSkge30KICAgICAgICB9CgogICAgfQogICAgCiAg\nICBwdWJsaWMgdm9pZCB1cGRhdGVCbG9iKFNlbGVjdCBzZWwsIEpEQkNTdG9y\nZSBzdG9yZSwgSW5wdXRTdHJlYW0gaXMpCiAgICAgICAgdGhyb3dzIFNRTEV4\nY2VwdGlvbiB7CiAgICAgICAgLy9EbyBub3RoaW5nCiAgICB9CgogICAgcHVi\nbGljIHZvaWQgZGVsZXRlU3RyZWFtKEpEQkNTdG9yZSBzdG9yZSwgU2VsZWN0\nIHNlbCkgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgSkRCQ0ZldGNo\nQ29uZmlndXJhdGlvbiBmZXRjaCA9IHN0b3JlLmdldEZldGNoQ29uZmlndXJh\ndGlvbigpOwogICAgICAgIFNRTEJ1ZmZlciBzcWwgPSBzZWwudG9TZWxlY3Qo\ndHJ1ZSwgZmV0Y2gpOwogICAgICAgIFJlc3VsdFNldCByZXMgPSBudWxsOwog\nICAgICAgIERlbGVnYXRpbmdDb25uZWN0aW9uIGNvbm4gPSAKICAgICAgICAg\nICAgKERlbGVnYXRpbmdDb25uZWN0aW9uKSBzdG9yZS5nZXRDb25uZWN0aW9u\nKCk7CiAgICAgICAgUHJlcGFyZWRTdGF0ZW1lbnQgc3RtbnQgPSBudWxsOwog\nICAgICAgIHRyeSB7CiAgICAgICAgICAgIHN0bW50ID0gc3FsLnByZXBhcmVT\ndGF0ZW1lbnQoY29ubiwgZmV0Y2gsCiAgICAgICAgICAgICAgICBSZXN1bHRT\nZXQuVFlQRV9TQ1JPTExfU0VOU0lUSVZFLCBSZXN1bHRTZXQuQ09OQ1VSX1VQ\nREFUQUJMRSk7CiAgICAgICAgICAgIHNldFRpbWVvdXRzKHN0bW50LCBmZXRj\naCwgdHJ1ZSk7CiAgICAgICAgICAgIHJlcyA9IHN0bW50LmV4ZWN1dGVRdWVy\neSgpOwogICAgICAgICAgICBpZiAoIXJlcy5uZXh0KCkpIHsKICAgICAgICAg\nICAgICAgIHRocm93IG5ldyBJbnRlcm5hbEV4Y2VwdGlvbihfbG9jLmdldCgi\nc3RyZWFtLWV4Y2VwdGlvbiIpKTsKICAgICAgICAgICAgfQogICAgICAgICAg\nICBpbnQgb2lkID0gcmVzLmdldEludCgxKTsKICAgICAgICAgICAgaWYgKG9p\nZCAhPSAtMSkgewogICAgICAgICAgICAgICAgY29ubi5zZXRBdXRvQ29tbWl0\nKGZhbHNlKTsKICAgICAgICAgICAgICAgIFBHQ29ubmVjdGlvbiBwZ2Nvbm4g\nPSAoUEdDb25uZWN0aW9uKWNvbm4KICAgICAgICAgICAgICAgICAgICAuZ2V0\nSW5uZXJtb3N0RGVsZWdhdGUoKTsKICAgICAgICAgICAgICAgIExhcmdlT2Jq\nZWN0TWFuYWdlciBsb20gPSBwZ2Nvbm4uZ2V0TGFyZ2VPYmplY3RBUEkoKTsK\nICAgICAgICAgICAgICAgIGxvbS5kZWxldGUob2lkKTsKICAgICAgICAgICAg\nfQogICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgIGlmIChyZXMgIT0g\nbnVsbCkKICAgICAgICAgICAgICAgIHRyeSB7IHJlcy5jbG9zZSAoKTsgfSBj\nYXRjaCAoU1FMRXhjZXB0aW9uIGUpIHt9CiAgICAgICAgICAgIGlmIChzdG1u\ndCAhPSBudWxsKQogICAgICAgICAgICAgICAgdHJ5IHsgc3RtbnQuY2xvc2Ug\nKCk7IH0gY2F0Y2ggKFNRTEV4Y2VwdGlvbiBlKSB7fQogICAgICAgICAgICBp\nZiAoY29ubiAhPSBudWxsKQogICAgICAgICAgICAgICAgdHJ5IHsgY29ubi5j\nbG9zZSAoKTsgfSBjYXRjaCAoU1FMRXhjZXB0aW9uIGUpIHt9CiAgICAgICAg\nfQogICAgfQoKICAgIC8qKgogICAgICogRGV0ZXJtaW5lIHdoZXRoZXIgWE1M\nIGNvbHVtbiBpcyBzdXBwb3J0ZWQuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lk\nIGNvbm5lY3RlZENvbmZpZ3VyYXRpb24oQ29ubmVjdGlvbiBjb25uKSB0aHJv\nd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBzdXBlci5jb25uZWN0ZWRDb25m\naWd1cmF0aW9uKGNvbm4pOwogICAgICAgIAogICAgICAgIERhdGFiYXNlTWV0\nYURhdGEgbWV0YURhdGEgPSBjb25uLmdldE1ldGFEYXRhKCk7CiAgICAgICAg\naW50IG1haiA9IDA7CiAgICAgICAgaW50IG1pbiA9IDA7CiAgICAgICAgaWYg\nKGlzSkRCQzMpIHsKICAgICAgICAgICAgbWFqID0gbWV0YURhdGEuZ2V0RGF0\nYWJhc2VNYWpvclZlcnNpb24oKTsKICAgICAgICAgICAgbWluID0gbWV0YURh\ndGEuZ2V0RGF0YWJhc2VNaW5vclZlcnNpb24oKTsKICAgICAgICB9IGVsc2Ug\newogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgLy8gVGhlIHBy\nb2R1Y3QgdmVyc2lvbiBsb29rcyBsaWtlICI4LjMuNSIuCiAgICAgICAgICAg\nICAgICBTdHJpbmcgcHJvZHVjdFZlcnNpb24gPSBtZXRhRGF0YS5nZXREYXRh\nYmFzZVByb2R1Y3RWZXJzaW9uKCk7CiAgICAgICAgICAgICAgICBTdHJpbmcg\nbWFqTWluW10gPSBwcm9kdWN0VmVyc2lvbi5zcGxpdCgiXFwuIik7CiAgICAg\nICAgICAgICAgICBtYWogPSBJbnRlZ2VyLnBhcnNlSW50KG1hak1pblswXSk7\nCiAgICAgICAgICAgICAgICBtaW4gPSBJbnRlZ2VyLnBhcnNlSW50KG1hak1p\nblsxXSk7CiAgICAgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAg\nICAgICAgICAgICAgICAvLyBXZSBkb24ndCB1bmRlcnN0YW5kIHRoZSB2ZXJz\naW9uIGZvcm1hdC4KICAgICAgICAgICAgICAgIGlmIChsb2cuaXNXYXJuRW5h\nYmxlZCgpKQogICAgICAgICAgICAgICAgICAgIGxvZy53YXJuKGUudG9TdHJp\nbmcoKSxlKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICAKICAg\nICAgICBpZiAoKG1haiA+PSA5IHx8IChtYWogPT0gOCAmJiBtaW4gPj0gMykp\nKSB7CiAgICAgICAgICAgIHN1cHBvcnRzWE1MQ29sdW1uID0gdHJ1ZTsKICAg\nICAgICB9CiAgICB9CiAKICAgIC8qKgogICAgICogSWYgY29sdW1uIGlzIGFu\nIFhNTCBjb2x1bW4sIFBvc3RncmVTUUwgcmVxdWlyZXMgdGhhdCBpdHMgdmFs\ndWUgaXMgc2V0CiAgICAgKiBieSB1c2luZyB7QGxpbmsgUHJlcGFyZWRTdGF0\nZW1lbnQjc2V0T2JqZWN0KGludCwgT2JqZWN0LCBpbnQpfQogICAgICogd2l0\naCB7QGxpbmsgVHlwZXMjT1RIRVJ9IGFzIHRoZSB0aGlyZCBhcmd1bWVudC4K\nICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0Q2xvYlN0cmluZyhQcmVwYXJl\nZFN0YXRlbWVudCBzdG1udCwgaW50IGlkeCwgU3RyaW5nIHZhbCwKICAgICAg\nICBDb2x1bW4gY29sKSB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBp\nZiAoY29sICE9IG51bGwgJiYgY29sLmlzWE1MKCkpCiAgICAgICAgICAgIHN0\nbW50LnNldE9iamVjdChpZHgsIHZhbCwgVHlwZXMuT1RIRVIpOwogICAgICAg\nIGVsc2UKICAgICAgICAgICAgc3VwZXIuc2V0Q2xvYlN0cmluZyhzdG1udCwg\naWR4LCB2YWwsIGNvbCk7CiAgICB9CiAgICAKICAgIC8qKgogICAgICogT3Zl\ncnJpZGUgdGhlIGdldE9qYmVjdCgpIG1ldGhvZCB0byBoYW5kbGUgdGhlIGNh\nc2Ugd2hlcmUgdGhlIGxhdGVzdAogICAgICogUG9zdGdyZXMgSkRCQyBkcml2\nZXIgcmV0dXJucyBhIG9yZy5wb3N0Z3Jlc3FsLnV0aWwuUEdvYmplY3QgaW5z\ndGVhZCBvZiBhCiAgICAgKiBqYXZhLnNxbC5UaW1lc3RhbXAKICAgICAqIAog\nICAgICogQHBhcmFtIHJzCiAgICAgKiBAcGFyYW0gY29sdW1uCiAgICAgKiBA\ncGFyYW0gbWFwCiAgICAgKiAKICAgICAqIEByZXR1cm4KICAgICAqIEBleGNl\ncHRpb24gU1FMRXhjZXB0aW9uCiAgICAgKi8KICAgIHB1YmxpYyBPYmplY3Qg\nZ2V0T2JqZWN0KFJlc3VsdFNldCBycywgaW50IGNvbHVtbiwgTWFwIG1hcCkK\nICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBPYmplY3Qg\nb2JqID0gc3VwZXIuZ2V0T2JqZWN0KHJzLCBjb2x1bW4sIG1hcCk7CgogICAg\nICAgIGlmIChvYmogPT0gbnVsbCkgewogICAgICAgICAgICByZXR1cm4gbnVs\nbDsKICAgICAgICB9CiAgICAgICAgaWYgKG9iai5nZXRDbGFzcygpLmdldE5h\nbWUoKS5lcXVhbHMoIm9yZy5wb3N0Z3Jlc3FsLnV0aWwuUEdvYmplY3QiKSkg\newogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgTWV0aG9kIG0g\nPSBvYmouZ2V0Q2xhc3MoKS5nZXRNZXRob2QoImdldFR5cGUiLCAoQ2xhc3Nb\nXSkgbnVsbCk7CiAgICAgICAgICAgICAgICBPYmplY3QgdHlwZSA9IG0uaW52\nb2tlKG9iaiwgKE9iamVjdFtdKSBudWxsKTsKICAgICAgICAgICAgICAgIGlm\nICgoKFN0cmluZykgdHlwZSkuZXF1YWxzSWdub3JlQ2FzZSh0aW1lc3RhbXBU\neXBlTmFtZSkpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gcnMuZ2V0\nVGltZXN0YW1wKGNvbHVtbik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAg\nICAgIH0gY2F0Y2ggKFRocm93YWJsZSB0KSB7CiAgICAgICAgICAgICAgICBp\nZiAodCBpbnN0YW5jZW9mIEludm9jYXRpb25UYXJnZXRFeGNlcHRpb24pCiAg\nICAgICAgICAgICAgICAgICAgdCA9ICgoSW52b2NhdGlvblRhcmdldEV4Y2Vw\ndGlvbikgdCkuZ2V0VGFyZ2V0RXhjZXB0aW9uKCk7CiAgICAgICAgICAgICAg\nICBpZiAodCBpbnN0YW5jZW9mIFNRTEV4Y2VwdGlvbikKICAgICAgICAgICAg\nICAgICAgICB0aHJvdyAoU1FMRXhjZXB0aW9uKSB0OwogICAgICAgICAgICAg\nICAgdGhyb3cgbmV3IFNRTEV4Y2VwdGlvbih0LmdldE1lc3NhZ2UoKSk7CiAg\nICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIG9iajsKICAg\nIH0KCiAgICAvKioKICAgICAqIEFwcGVuZCBYTUwgY29tcGFyaXNvbi4KICAg\nICAqIAogICAgICogQHBhcmFtIGJ1ZgogICAgICogICAgICAgICAgICB0aGUg\nU1FMIGJ1ZmZlciB0byB3cml0ZSB0aGUgY29tcGFyaXNvbgogICAgICogQHBh\ncmFtIG9wCiAgICAgKiAgICAgICAgICAgIHRoZSBjb21wYXJpc29uIG9wZXJh\ndGlvbiB0byBwZXJmb3JtCiAgICAgKiBAcGFyYW0gbGhzCiAgICAgKiAgICAg\nICAgICAgIHRoZSBsZWZ0IGhhbmQgc2lkZSBvZiB0aGUgY29tcGFyaXNvbgog\nICAgICogQHBhcmFtIHJocwogICAgICogICAgICAgICAgICB0aGUgcmlnaHQg\naGFuZCBzaWRlIG9mIHRoZSBjb21wYXJpc29uCiAgICAgKiBAcGFyYW0gbGhz\neG1sCiAgICAgKiAgICAgICAgICAgIGluZGljYXRlcyB3aGV0aGVyIHRoZSBs\nZWZ0IG9wZXJhbmQgbWFwcyB0byBYTUwKICAgICAqIEBwYXJhbSByaHN4bWwK\nICAgICAqICAgICAgICAgICAgaW5kaWNhdGVzIHdoZXRoZXIgdGhlIHJpZ2h0\nIG9wZXJhbmQgbWFwcyB0byBYTUwKICAgICAqLwogICAgcHVibGljIHZvaWQg\nYXBwZW5kWG1sQ29tcGFyaXNvbihTUUxCdWZmZXIgYnVmLCBTdHJpbmcgb3As\nIEZpbHRlclZhbHVlIGxocywKICAgICAgICBGaWx0ZXJWYWx1ZSByaHMsIGJv\nb2xlYW4gbGhzeG1sLCBib29sZWFuIHJoc3htbCkgewogICAgICAgIHN1cGVy\nLmFwcGVuZFhtbENvbXBhcmlzb24oYnVmLCBvcCwgbGhzLCByaHMsIGxoc3ht\nbCwgcmhzeG1sKTsKICAgICAgICBpZiAobGhzeG1sKQogICAgICAgICAgICBh\ncHBlbmRYbWxWYWx1ZShidWYsIGxocyk7CiAgICAgICAgZWxzZQogICAgICAg\nICAgICBsaHMuYXBwZW5kVG8oYnVmKTsKICAgICAgICBidWYuYXBwZW5kKCIg\nIikuYXBwZW5kKG9wKS5hcHBlbmQoIiAiKTsKICAgICAgICBpZiAocmhzeG1s\nKQogICAgICAgICAgICBhcHBlbmRYbWxWYWx1ZShidWYsIHJocyk7CiAgICAg\nICAgZWxzZQogICAgICAgICAgICByaHMuYXBwZW5kVG8oYnVmKTsKICAgIH0K\nICAgIAogICAgLyoqCiAgICAgKiBBcHBlbmQgWE1MIGNvbHVtbiB2YWx1ZSBz\nbyB0aGF0IGl0IGNhbiBiZSB1c2VkIGluIGNvbXBhcmlzb25zLgogICAgICog\nCiAgICAgKiBAcGFyYW0gYnVmCiAgICAgKiAgICAgICAgICAgIHRoZSBTUUwg\nYnVmZmVyIHRvIHdyaXRlIHRoZSB2YWx1ZQogICAgICogQHBhcmFtIHZhbAog\nICAgICogICAgICAgICAgICB0aGUgdmFsdWUgdG8gYmUgd3JpdHRlbgogICAg\nICovCiAgICBwcml2YXRlIHZvaWQgYXBwZW5kWG1sVmFsdWUoU1FMQnVmZmVy\nIGJ1ZiwgRmlsdGVyVmFsdWUgdmFsKSB7CiAgICAgICAgQ2xhc3MgcmMgPSBG\naWx0ZXJzLndyYXAodmFsLmdldFR5cGUoKSk7CiAgICAgICAgaW50IHR5cGUg\nPSBnZXRKREJDVHlwZShKYXZhVHlwZXMuZ2V0VHlwZUNvZGUocmMpLCBmYWxz\nZSk7CiAgICAgICAgYm9vbGVhbiBpc1htbEF0dHJpYnV0ZSA9ICh2YWwuZ2V0\nWG1sTWFwcGluZygpID09IG51bGwpID8gZmFsc2UKICAgICAgICAgICAgICAg\nIDogdmFsLmdldFhtbE1hcHBpbmcoKS5pc1htbEF0dHJpYnV0ZSgpOwogICAg\nICAgIFNRTEJ1ZmZlciBuZXdCdWZlciA9IG5ldyBTUUxCdWZmZXIodGhpcyk7\nCiAgICAgICAgbmV3QnVmZXIuYXBwZW5kKCIoeHBhdGgoJy8qLyIpOwogICAg\nICAgIHZhbC5hcHBlbmRUbyhuZXdCdWZlcik7CiAgICAgICAgaWYgKCFpc1ht\nbEF0dHJpYnV0ZSkKICAgICAgICAgICAgbmV3QnVmZXIuYXBwZW5kKCIvdGV4\ndCgpIik7CiAgICAgICAgbmV3QnVmZXIuYXBwZW5kKCInLCIpLgogICAgICAg\nICAgICBhcHBlbmQodmFsLmdldENvbHVtbkFsaWFzKHZhbC5nZXRGaWVsZE1h\ncHBpbmcoKS5nZXRDb2x1bW5zKClbMF0pKS4KICAgICAgICAgICAgYXBwZW5k\nKCIpKVsxXSIpOwogICAgICAgIGFwcGVuZENhc3QoYnVmLCBuZXdCdWZlciwg\ndHlwZSk7CiAgICB9CgoKICAgIC8qKgogICAgICogUmV0dXJuIGEgU1FMIHN0\ncmluZyB0byBhY3QgYXMgYSBwbGFjZWhvbGRlciBmb3IgdGhlIGdpdmVuIGNv\nbHVtbi4KICAgICAqLwogICAgcHVibGljIFN0cmluZyBnZXRQbGFjZWhvbGRl\nclZhbHVlU3RyaW5nKENvbHVtbiBjb2wpIHsKICAgICAgICBpZiAoY29sLmdl\ndFR5cGUoKSA9PSBUeXBlcy5CSVQpIHsKICAgICAgICAgICAgcmV0dXJuICJm\nYWxzZSI7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmV0dXJuIHN1\ncGVyLmdldFBsYWNlaG9sZGVyVmFsdWVTdHJpbmcoY29sKTsKICAgICAgICB9\nCiAgICB9CgogICAgLyoqCiAgICAgKiBDb25uZWN0aW9uIHdyYXBwZXIgdG8g\nd29yayBhcm91bmQgdGhlIHBvc3RncmVzIGVtcHR5IHJlc3VsdCBzZXQgYnVn\nLgogICAgICovCiAgICBwcm90ZWN0ZWQgYWJzdHJhY3Qgc3RhdGljIGNsYXNz\nIFBvc3RncmVzQ29ubmVjdGlvbgogICAgICAgIGV4dGVuZHMgRGVsZWdhdGlu\nZ0Nvbm5lY3Rpb24gewoKICAgICAgICBwcml2YXRlIGZpbmFsIFBvc3RncmVz\nRGljdGlvbmFyeSBfZGljdDsKCiAgICAgICAgcHVibGljIFBvc3RncmVzQ29u\nbmVjdGlvbihDb25uZWN0aW9uIGNvbm4sIFBvc3RncmVzRGljdGlvbmFyeSBk\naWN0KSB7CiAgICAgICAgICAgIHN1cGVyKGNvbm4pOwogICAgICAgICAgICBf\nZGljdCA9IGRpY3Q7CiAgICAgICAgfQoKICAgICAgICBwcm90ZWN0ZWQgUHJl\ncGFyZWRTdGF0ZW1lbnQgcHJlcGFyZVN0YXRlbWVudChTdHJpbmcgc3FsLCBi\nb29sZWFuIHdyYXApCiAgICAgICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24g\newogICAgICAgICAgIHJldHVybiBDb25jcmV0ZUNsYXNzR2VuZXJhdG9yLm5l\nd0luc3RhbmNlKHBvc3RncmVzUHJlcGFyZWRTdGF0ZW1lbnRJbXBsLCAKICAg\nICAgICAgICAgICAgICAgIHN1cGVyLnByZXBhcmVTdGF0ZW1lbnQoc3FsLCBm\nYWxzZSksIFBvc3RncmVzQ29ubmVjdGlvbi50aGlzLCBfZGljdCk7CiAgICAg\nICAgfQoKICAgICAgICBwcm90ZWN0ZWQgUHJlcGFyZWRTdGF0ZW1lbnQgcHJl\ncGFyZVN0YXRlbWVudChTdHJpbmcgc3FsLCBpbnQgcnNUeXBlLAogICAgICAg\nICAgICBpbnQgcnNDb25jdXIsIGJvb2xlYW4gd3JhcCkKICAgICAgICAgICAg\ndGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgICAgIHJldHVybiBDb25j\ncmV0ZUNsYXNzR2VuZXJhdG9yLgogICAgICAgICAgICAgICAgbmV3SW5zdGFu\nY2UocG9zdGdyZXNQcmVwYXJlZFN0YXRlbWVudEltcGwsCiAgICAgICAgICAg\nICAgICAgICAgUHJlcGFyZWRTdGF0ZW1lbnQuY2xhc3MsCiAgICAgICAgICAg\nICAgICAgICAgICAgIHN1cGVyLnByZXBhcmVTdGF0ZW1lbnQoc3FsLCByc1R5\ncGUsIHJzQ29uY3VyLCBmYWxzZSksCiAgICAgICAgICAgICAgICAgICAgQ29u\nbmVjdGlvbi5jbGFzcywgUG9zdGdyZXNDb25uZWN0aW9uLnRoaXMsCiAgICAg\nICAgICAgICAgICAgICAgUG9zdGdyZXNEaWN0aW9uYXJ5LmNsYXNzLCBfZGlj\ndCk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogU3RhdGVtZW50\nIHdyYXBwZXIgdG8gd29yayBhcm91bmQgdGhlIHBvc3RncmVzIGVtcHR5IHJl\nc3VsdCBzZXQgYnVnLgogICAgICovCiAgICBwcm90ZWN0ZWQgYWJzdHJhY3Qg\nc3RhdGljIGNsYXNzIFBvc3RncmVzUHJlcGFyZWRTdGF0ZW1lbnQKICAgICAg\nICBleHRlbmRzIERlbGVnYXRpbmdQcmVwYXJlZFN0YXRlbWVudCB7CgogICAg\nICAgIHByaXZhdGUgZmluYWwgUG9zdGdyZXNEaWN0aW9uYXJ5IF9kaWN0OwoK\nICAgICAgICBwdWJsaWMgUG9zdGdyZXNQcmVwYXJlZFN0YXRlbWVudChQcmVw\nYXJlZFN0YXRlbWVudCBwcywKICAgICAgICAgICAgQ29ubmVjdGlvbiBjb25u\nLCBQb3N0Z3Jlc0RpY3Rpb25hcnkgZGljdCkgewogICAgICAgICAgICBzdXBl\ncihwcywgY29ubik7CiAgICAgICAgICAgIF9kaWN0ID0gZGljdDsKICAgICAg\nICB9CgogICAgICAgIHByb3RlY3RlZCBSZXN1bHRTZXQgZXhlY3V0ZVF1ZXJ5\nKGJvb2xlYW4gd3JhcCkKICAgICAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlv\nbiB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICByZXR1cm4g\nc3VwZXIuZXhlY3V0ZVF1ZXJ5KHdyYXApOwogICAgICAgICAgICB9IGNhdGNo\nIChTUUxFeGNlcHRpb24gc2UpIHsKICAgICAgICAgICAgICAgIC8vIHdlIG5l\nZWQgdG8gbWFrZSBvdXIgYmVzdCBndWVzcyB3aGV0aGVyIHRoaXMgaXMgdGhl\nIGVtcHR5CiAgICAgICAgICAgICAgICAvLyBSZXN1bHRTZXQgYnVnLCBzaW5j\nZSB0aGlzIGV4Y2VwdGlvbiBjb3VsZCBvY2N1cgogICAgICAgICAgICAgICAg\nLy8gZm9yIG90aGVyIHJlYXNvbnMgKGxpa2UgYW4gaW52YWxpZCBxdWVyeSBz\ndHJpbmcpLiBOb3RlCiAgICAgICAgICAgICAgICAvLyB0aGF0IFBvc3RncmVz\nIGVycm9yIG1lc3NhZ2VzIGFyZSBsb2NhbGl6ZWQsIHNvIHdlCiAgICAgICAg\nICAgICAgICAvLyBjYW5ub3QganVzdCBwYXJzZSB0aGUgZXhjZXB0aW9uIFN0\ncmluZy4KICAgICAgICAgICAgICAgIFJlc3VsdFNldCBycyA9IGdldFJlc3Vs\ndFNldCh3cmFwKTsKCiAgICAgICAgICAgICAgICAvLyBSZXN1bHRTZXQgc2hv\ndWxkIGJlIGVtcHR5OiBpZiBub3QsIHRoZW4gbWF5YmUgYW4KICAgICAgICAg\nICAgICAgIC8vIGFjdHVhbCBlcnJvciBvY2N1cnJlZAogICAgICAgICAgICAg\nICAgaWYgKHJzID09IG51bGwpCiAgICAgICAgICAgICAgICAgICAgdGhyb3cg\nc2U7CgogICAgICAgICAgICAgICAgcmV0dXJuIHJzOwogICAgICAgICAgICB9\nCiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgdm9pZCBzZXRGZXRjaFNpemUo\naW50IGkpCiAgICAgICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAg\nICAgICAgICAvLyBzb21lIHBvc3RncmVzIGRyaXZlcnMgZG8gbm90IHN1cHBv\ncnQgdGhlIHNldEZldGNoU2l6ZSBtZXRob2QKICAgICAgICAgICAgdHJ5IHsK\nICAgICAgICAgICAgICAgIGlmIChfZGljdC5zdXBwb3J0c1NldEZldGNoU2l6\nZSkKICAgICAgICAgICAgICAgICAgICBzdXBlci5zZXRGZXRjaFNpemUoaSk7\nCiAgICAgICAgICAgIH0gY2F0Y2ggKFNRTEV4Y2VwdGlvbiBlKSB7CiAgICAg\nICAgICAgICAgICBfZGljdC5zdXBwb3J0c1NldEZldGNoU2l6ZSA9IGZhbHNl\nOwogICAgICAgICAgICAgICAgaWYgKF9kaWN0LmxvZy5pc1dhcm5FbmFibGVk\nKCkpCiAgICAgICAgICAgICAgICAgICAgX2RpY3QubG9nLndhcm4oX2xvYy5n\nZXQoInBzcWwtbm8tc2V0LWZldGNoLXNpemUiKSwgZSk7CiAgICAgICAgICAg\nIH0KICAgICAgICB9CiAgICB9Cn0K\n","encoding":"base64"}

