{"sha":"3ad85fd9d2673833e6dc82cece6a8774a9a814d0","node_id":"MDQ6QmxvYjIwNjM2NDozYWQ4NWZkOWQyNjczODMzZTZkYzgyY2VjZTZhODc3NGE5YTgxNGQw","size":11385,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/3ad85fd9d2673833e6dc82cece6a8774a9a814d0","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZSBvciBtb3JlCiAqIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gU2VlIHRoZSBOT1RJQ0UgZmlsZSBkaXN0cmli\ndXRlZCB3aXRoIHRoaXMKICogd29yayBmb3IgYWRkaXRpb25hbCBpbmZvcm1h\ndGlvbiByZWdhcmRpbmcgY29weXJpZ2h0IG93bmVyc2hpcC4gVGhlIEFTRgog\nKiBsaWNlbnNlcyB0aGlzIGZpbGUgdG8geW91IHVuZGVyIHRoZSBBcGFjaGUg\nTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIpOyB5b3Ug\nbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdp\ndGggdGhlIExpY2Vuc2UuCiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0\naGUgTGljZW5zZSBhdAogKiAKICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xp\nY2Vuc2VzL0xJQ0VOU0UtMi4wCiAqIAogKiBVbmxlc3MgcmVxdWlyZWQgYnkg\nYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3\nYXJlCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3Ry\naWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsIFdJVEhPVVQKICogV0FSUkFO\nVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVz\ncyBvciBpbXBsaWVkLiBTZWUgdGhlCiAqIExpY2Vuc2UgZm9yIHRoZSBzcGVj\naWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kIGxpbWl0\nYXRpb25zIHVuZGVyCiAqIHRoZSBMaWNlbnNlLgogKi8KcGFja2FnZSBvcmcu\nYXBhY2hlLm9wZW5qcGEuamRiYy5zcWw7CgppbXBvcnQgamF2YS5zcWwuQ29u\nbmVjdGlvbjsKaW1wb3J0IGphdmEuc3FsLkRhdGFiYXNlTWV0YURhdGE7Cmlt\ncG9ydCBqYXZhLnNxbC5TUUxFeGNlcHRpb247CmltcG9ydCBqYXZhLnNxbC5U\neXBlczsKaW1wb3J0IGphdmEudXRpbC5TZXQ7CgppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLmpkYmMua2VybmVsLmV4cHMuRmlsdGVyVmFsdWU7CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLkZpbHRlcnM7CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hlbWEuQ29sdW1uOwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51dGlsLkxvY2FsaXplcjsKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5tZXRhLkphdmFUeXBlczsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS51dGlsLlN0b3JlRXhjZXB0aW9uOwoKLyoqCiAq\nIERpY3Rpb25hcnkgZm9yIE1TIFNRTFNlcnZlci4KICovCnB1YmxpYyBjbGFz\ncyBTUUxTZXJ2ZXJEaWN0aW9uYXJ5IGV4dGVuZHMgQWJzdHJhY3RTUUxTZXJ2\nZXJEaWN0aW9uYXJ5IHsKCiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIFN0cmlu\nZyBWRU5ET1JfTUlDUk9TT0ZUID0gIm1pY3Jvc29mdCI7CiAgICBwdWJsaWMg\nc3RhdGljIGZpbmFsIFN0cmluZyBWRU5ET1JfTkVURElSRUNUID0gIm5ldGRp\ncmVjdCI7CiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIFN0cmluZyBWRU5ET1Jf\nSlREUyA9ICJqdGRzIjsKCiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBMb2Nh\nbGl6ZXIgX2xvYyA9CiAgICAgICAgTG9jYWxpemVyLmZvclBhY2thZ2UoU1FM\nU2VydmVyRGljdGlvbmFyeS5jbGFzcyk7CgogICAgcHJpdmF0ZSBTdHJpbmcg\nc2NoZW1hQ2FzZSA9IFNDSEVNQV9DQVNFX1BSRVNFUlZFOwogICAgLyoqCiAg\nICAgKiBGbGFnIHdoZXRoZXIgdG8gdHJlYXQgVU5JUVVFSURFTlRJRklFUiBh\ncyBWQVJCSU5BUlkgb3IgVkFSQ0hBUgogICAgICovCiAgICBwdWJsaWMgYm9v\nbGVhbiB1bmlxdWVJZGVudGlmaWVyQXNWYXJiaW5hcnkgPSB0cnVlOwoKICAg\nIHB1YmxpYyBTUUxTZXJ2ZXJEaWN0aW9uYXJ5KCkgewogICAgICAgIHBsYXRm\nb3JtID0gIk1pY3Jvc29mdCBTUUwgU2VydmVyIjsKICAgICAgICAvLyBTUUxT\nZXJ2ZXIgbG9ja3Mgb24gYSB0YWJsZS1ieS10YWJsZSBiYXNpcwogICAgICAg\nIGZvclVwZGF0ZUNsYXVzZSA9IG51bGw7CiAgICAgICAgdGFibGVGb3JVcGRh\ndGVDbGF1c2UgPSAiV0lUSCAoVVBETE9DSykiOwogICAgICAgIHN1cHBvcnRz\nTnVsbFRhYmxlRm9yR2V0Q29sdW1ucyA9IGZhbHNlOwogICAgICAgIHJlcXVp\ncmVzQWxpYXNGb3JTdWJzZWxlY3QgPSB0cnVlOwogICAgICAgIHN0cmluZ0xl\nbmd0aEZ1bmN0aW9uID0gIkxFTih7MH0pIjsKICAgIH0KCiAgICBwdWJsaWMg\ndm9pZCBjb25uZWN0ZWRDb25maWd1cmF0aW9uKENvbm5lY3Rpb24gY29ubikg\ndGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgc3VwZXIuY29ubmVjdGVk\nQ29uZmlndXJhdGlvbihjb25uKTsKICAgICAgICBib29sZWFuIHJlcXVpcmVz\nV2FybmluZ3MgPSB0cnVlOwogICAgICAgIERhdGFiYXNlTWV0YURhdGEgbWV0\nYSA9IGNvbm4uZ2V0TWV0YURhdGEoKTsKICAgICAgICBTdHJpbmcgZHJpdmVy\nTmFtZSA9IG1ldGEuZ2V0RHJpdmVyTmFtZSgpOwogICAgICAgIFN0cmluZyB1\ncmwgPSBtZXRhLmdldFVSTCgpOwogICAgICAgIGlmIChkcml2ZXJWZW5kb3Ig\nPT0gbnVsbCkgewogICAgICAgICAgICBpZiAoZHJpdmVyTmFtZSAhPSBudWxs\nKSB7CiAgICAgICAgICAgICAgICBpZiAoZHJpdmVyTmFtZS5zdGFydHNXaXRo\nKCJNaWNyb3NvZnQgU1FMIFNlcnZlciIpKSB7CiAgICAgICAgICAgICAgICAg\nICAgLy8gdjEuMSwgMS4yIG9yIDIuMCBkcml2ZXIKICAgICAgICAgICAgICAg\nICAgICBkcml2ZXJWZW5kb3IgPSBWRU5ET1JfTUlDUk9TT0ZUOwogICAgICAg\nICAgICAgICAgICAgIC8vIHNlcnZlck1ham9yVmVyc2lvbiBvZiA4PT0yMDAw\nLCA5PT0yMDA1LCAxMD09MjAwOAogICAgICAgICAgICAgICAgICAgIGlmICht\nZXRhLmdldERhdGFiYXNlTWFqb3JWZXJzaW9uKCkgPj0gOSkKICAgICAgICAg\nICAgICAgICAgICAgICAgc2V0U3VwcG9ydHNYTUxDb2x1bW4odHJ1ZSk7CiAg\nICAgICAgICAgICAgICAgICAgaWYgKG1ldGEuZ2V0RHJpdmVyTWFqb3JWZXJz\naW9uKCkgPj0gMikgewogICAgICAgICAgICAgICAgICAgICAgICAvLyBzZWUg\naHR0cDovL2Jsb2dzLm1zZG4uY29tL2pkYmN0ZWFtL2FyY2hpdmUvMjAwNy8w\nNS9cCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIDAyL3doYXQtaXMtYWRh\ncHRpdmUtcmVzcG9uc2UtYnVmZmVyaW5nLWFuZC13aHktXAogICAgICAgICAg\nICAgICAgICAgICAgICAvLyBzaG91bGQtaS11c2UtaXQuYXNweAogICAgICAg\nICAgICAgICAgICAgICAgICAvLyAyLjAgZHJpdmVyIGNvbm5lY3RVUkwgYXV0\nb21hdGljYWxseSBpbmNsdWRlcwogICAgICAgICAgICAgICAgICAgICAgICAv\nLyByZXNwb25zZUJ1ZmZlcmluZz1hZGFwdGl2ZQogICAgICAgICAgICAgICAg\nICAgICAgICAvLyBhbmQgZGlzYWJsZVN0YXRlbWVudFBvb2xpbmc9dHJ1ZQog\nICAgICAgICAgICAgICAgICAgICAgICByZXF1aXJlc1dhcm5pbmdzID0gZmFs\nc2U7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSBl\nbHNlIHsKICAgICAgICAgICAgICAgICAgICBpZiAoIk5ldERpcmVjdCBKU1FM\nQ29ubmVjdCIuZXF1YWxzKGRyaXZlck5hbWUpKQogICAgICAgICAgICAgICAg\nICAgICAgICBkcml2ZXJWZW5kb3IgPSBWRU5ET1JfTkVURElSRUNUOwogICAg\nICAgICAgICAgICAgICAgIGVsc2UgaWYgKGRyaXZlck5hbWUuc3RhcnRzV2l0\naCgialREUyIpKQogICAgICAgICAgICAgICAgICAgICAgICBkcml2ZXJWZW5k\nb3IgPSBWRU5ET1JfSlREUzsKICAgICAgICAgICAgICAgICAgICBlbHNlIGlm\nICgiU1FMU2VydmVyIi5lcXVhbHMoZHJpdmVyTmFtZSkpIHsKICAgICAgICAg\nICAgICAgICAgICAgICAgaWYgKHVybCAhPSBudWxsICYmCiAgICAgICAgICAg\nICAgICAgICAgICAgICAgICB1cmwuc3RhcnRzV2l0aCgiamRiYzptaWNyb3Nv\nZnQ6c3Fsc2VydmVyOiIpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAg\nZHJpdmVyVmVuZG9yID0gVkVORE9SX01JQ1JPU09GVDsKICAgICAgICAgICAg\nICAgICAgICAgICAgZWxzZSBpZiAodXJsICE9IG51bGwgJiYKICAgICAgICAg\nICAgICAgICAgICAgICAgICAgIHVybC5zdGFydHNXaXRoKCJqZGJjOmRhdGFk\naXJlY3Q6c3Fsc2VydmVyOiIpKQogICAgICAgICAgICAgICAgICAgICAgICAg\nICAgZHJpdmVyVmVuZG9yID0gVkVORE9SX0RBVEFESVJFQ1Q7CiAgICAgICAg\nICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICAgICAg\nICAgIGRyaXZlclZlbmRvciA9IFZFTkRPUl9PVEhFUjsKICAgICAgICAgICAg\nICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgLy8gb2xkIHdheSBvZiBk\nZXRlcm1pbmluZyB4bWwgc3VwcG9ydAogICAgICAgICAgICAgICAgICAgIGlm\nIChkcml2ZXJOYW1lLmluZGV4T2YocGxhdGZvcm0pICE9IC0xKSB7CiAgICAg\nICAgICAgICAgICAgICAgICAgIFN0cmluZyB2ZXJzaW9uU3RyaW5nID0KICAg\nICAgICAgICAgICAgICAgICAgICAgICAgIGRyaXZlck5hbWUuc3Vic3RyaW5n\nKHBsYXRmb3JtLmxlbmd0aCgpICsgMSk7CiAgICAgICAgICAgICAgICAgICAg\nICAgIGlmICh2ZXJzaW9uU3RyaW5nLmluZGV4T2YoIiAiKSAhPSAtMSkKICAg\nICAgICAgICAgICAgICAgICAgICAgICAgIHZlcnNpb25TdHJpbmcgPSB2ZXJz\naW9uU3RyaW5nLnN1YnN0cmluZygwLAogICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgIHZlcnNpb25TdHJpbmcuaW5kZXhPZigiICIpKTsKICAgICAg\nICAgICAgICAgICAgICAgICAgaW50IHZlcnNpb24gPSBJbnRlZ2VyLnBhcnNl\nSW50KHZlcnNpb25TdHJpbmcpOwogICAgICAgICAgICAgICAgICAgICAgICBp\nZiAodmVyc2lvbiA+PSAyMDA1KQogICAgICAgICAgICAgICAgICAgICAgICAg\nICAgc2V0U3VwcG9ydHNYTUxDb2x1bW4odHJ1ZSk7CiAgICAgICAgICAgICAg\nICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGVsc2Ug\newogICAgICAgICAgICAgICAgZHJpdmVyVmVuZG9yID0gVkVORE9SX09USEVS\nOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAvLyB3YXJuIGFi\nb3V0IG5vdCB1c2luZyBjdXJzb3JzIGZvciBwcmUtMi4wIE1TIGRyaXZlcgog\nICAgICAgIC8vIGFzIGNvbm5lY3RVUkwgaW5jbHVkZXMgc2VsZWN0TWV0aG9k\nPWRpcmVjdAogICAgICAgIGlmICgoKFZFTkRPUl9NSUNST1NPRlQuZXF1YWxz\nSWdub3JlQ2FzZShkcml2ZXJWZW5kb3IpICYmCiAgICAgICAgICAgIHJlcXVp\ncmVzV2FybmluZ3MpIHx8IAogICAgICAgICAgICBWRU5ET1JfREFUQURJUkVD\nVC5lcXVhbHNJZ25vcmVDYXNlKGRyaXZlclZlbmRvcikpICYmCiAgICAgICAg\nICAgICh1cmwudG9Mb3dlckNhc2UoKS5pbmRleE9mKCJzZWxlY3RtZXRob2Q9\nY3Vyc29yIikgPT0gLTEpKQogICAgICAgICAgICBsb2cud2FybihfbG9jLmdl\ndCgic3Fsc2VydmVyLWN1cnNvciIsIHVybCkpOwoKICAgICAgICAvLyB3YXJu\nIGFib3V0IHByZXBhcmVkIHN0YXRlbWVudCBjYWNoaW5nIGlmIHVzaW5nIHBy\nZS0yLjAgTVMgZHJpdmVycwogICAgICAgIC8vIGFzIGNvbm5lY3RVUkwgaW5j\nbHVkZXMgcmVzcG9uc2VCdWZmZXJpbmc9ZnVsbAogICAgICAgIFN0cmluZyBw\ncm9wcyA9IGNvbmYuZ2V0Q29ubmVjdGlvbkZhY3RvcnlQcm9wZXJ0aWVzKCk7\nCiAgICAgICAgaWYgKChwcm9wcyAhPSBudWxsKSAmJgogICAgICAgICAgICBW\nRU5ET1JfTUlDUk9TT0ZULmVxdWFsc0lnbm9yZUNhc2UoZHJpdmVyVmVuZG9y\nKSAmJgogICAgICAgICAgICByZXF1aXJlc1dhcm5pbmdzICYmCiAgICAgICAg\nICAgIChwcm9wcy50b0xvd2VyQ2FzZSgpLmluZGV4T2YoIm1heGNhY2hlZHN0\nYXRlbWVudHM9MCIpID09IC0xKSkKICAgICAgICAgICAgbG9nLndhcm4oX2xv\nYy5nZXQoInNxbHNlcnZlci1jYWNoZWRzdG1udHMiKSk7CiAgICB9CgogICAg\ncHVibGljIENvbHVtbltdIGdldENvbHVtbnMoRGF0YWJhc2VNZXRhRGF0YSBt\nZXRhLCBTdHJpbmcgY2F0YWxvZywKICAgICAgICBTdHJpbmcgc2NoZW1hTmFt\nZSwgU3RyaW5nIHRhYmxlTmFtZSwgU3RyaW5nIGNvbHVtbk5hbWUsIENvbm5l\nY3Rpb24gY29ubikKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAg\nICAgICBDb2x1bW5bXSBjb2xzID0gc3VwZXIuZ2V0Q29sdW1ucyhtZXRhLCBj\nYXRhbG9nLCBzY2hlbWFOYW1lLCB0YWJsZU5hbWUsCiAgICAgICAgICAgIGNv\nbHVtbk5hbWUsIGNvbm4pOwoKICAgICAgICAvLyBmb3Igb3B0YSBkcml2ZXIs\nIHdoaWNoIHJlcG9ydHMgbnZhcmNoYXIgYXMgdW5rbm93biB0eXBlCiAgICAg\nICAgZm9yIChpbnQgaSA9IDA7IGNvbHMgIT0gbnVsbCAmJiBpIDwgY29scy5s\nZW5ndGg7IGkrKykgewogICAgICAgICAgICBTdHJpbmcgdHlwZU5hbWUgPSBj\nb2xzW2ldLmdldFR5cGVOYW1lKCk7CiAgICAgICAgICAgIGlmICh0eXBlTmFt\nZSA9PSBudWxsKQogICAgICAgICAgICAgICAgY29udGludWU7CgogICAgICAg\nICAgICB0eXBlTmFtZSA9IHR5cGVOYW1lLnRvVXBwZXJDYXNlKCk7CiAgICAg\nICAgICAgIGlmICgiTlZBUkNIQVIiLmVxdWFscyh0eXBlTmFtZSkpCiAgICAg\nICAgICAgICAgICBjb2xzW2ldLnNldFR5cGUoVHlwZXMuVkFSQ0hBUik7CiAg\nICAgICAgICAgIGVsc2UgaWYgKCJVTklRVUVJREVOVElGSUVSIi5lcXVhbHMo\ndHlwZU5hbWUpKSB7CiAgICAgICAgICAgICAgICBpZiAodW5pcXVlSWRlbnRp\nZmllckFzVmFyYmluYXJ5KQogICAgICAgICAgICAgICAgICAgIGNvbHNbaV0u\nc2V0VHlwZShUeXBlcy5WQVJCSU5BUlkpOwogICAgICAgICAgICAgICAgZWxz\nZQogICAgICAgICAgICAgICAgICAgIGNvbHNbaV0uc2V0VHlwZShUeXBlcy5W\nQVJDSEFSKTsKICAgICAgICAgICAgfSBlbHNlIGlmICgiTkNIQVIiLmVxdWFs\ncyh0eXBlTmFtZSkpCiAgICAgICAgICAgICAgICBjb2xzW2ldLnNldFR5cGUo\nVHlwZXMuQ0hBUik7CiAgICAgICAgICAgIGVsc2UgaWYgKCJOVEVYVCIuZXF1\nYWxzKHR5cGVOYW1lKSkKICAgICAgICAgICAgICAgIGNvbHNbaV0uc2V0VHlw\nZShUeXBlcy5DTE9CKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGNvbHM7\nCiAgICB9CgogICAgcHJvdGVjdGVkIHZvaWQgYXBwZW5kTGVuZ3RoKFNRTEJ1\nZmZlciBidWYsIGludCB0eXBlKSB7CiAgICAgICAgaWYgKHR5cGUgPT0gVHlw\nZXMuVkFSQ0hBUikKICAgICAgICAgICAgYnVmLmFwcGVuZCgiKCIpLmFwcGVu\nZChJbnRlZ2VyLnRvU3RyaW5nKGNoYXJhY3RlckNvbHVtblNpemUpKQogICAg\nICAgICAgICAgICAgLmFwcGVuZCgiKSIpOwogICAgfQoKICAgIC8qKgogICAg\nICogSWYgdGhpcyBkaWN0aW9uYXJ5IHN1cHBvcnRzIFhNTCB0eXBlLCB1c2Ug\ndGhpcyBtZXRob2QgdG8gYXBwZW5kIHhtbAogICAgICogcHJlZGljYXRlLgog\nICAgICogCiAgICAgKiBAcGFyYW0gYnVmIHRoZSBTUUwgYnVmZmVyIHRvIHdy\naXRlIHRoZSBjb21wYXJpc29uCiAgICAgKiBAcGFyYW0gb3AgdGhlIGNvbXBh\ncmlzb24gb3BlcmF0aW9uIHRvIHBlcmZvcm0KICAgICAqIEBwYXJhbSBsaHMg\ndGhlIGxlZnQgaGFuZCBzaWRlIG9mIHRoZSBjb21wYXJpc29uCiAgICAgKiBA\ncGFyYW0gcmhzIHRoZSByaWdodCBoYW5kIHNpZGUgb2YgdGhlIGNvbXBhcmlz\nb24KICAgICAqIEBwYXJhbSBsaHN4bWwgaW5kaWNhdGVzIHdoZXRoZXIgdGhl\nIGxlZnQgb3BlcmFuZCBtYXBzIHRvIHhtbAogICAgICogQHBhcmFtIHJoc3ht\nbCBpbmRpY2F0ZXMgd2hldGhlciB0aGUgcmlnaHQgb3BlcmFuZCBtYXBzIHRv\nIHhtbAogICAgICovCiAgICBwdWJsaWMgdm9pZCBhcHBlbmRYbWxDb21wYXJp\nc29uKFNRTEJ1ZmZlciBidWYsIFN0cmluZyBvcCwgRmlsdGVyVmFsdWUgbGhz\nLAogICAgICAgIEZpbHRlclZhbHVlIHJocywgYm9vbGVhbiBsaHN4bWwsIGJv\nb2xlYW4gcmhzeG1sKSB7CiAgICAgICAgc3VwZXIuYXBwZW5kWG1sQ29tcGFy\naXNvbihidWYsIG9wLCBsaHMsIHJocywgbGhzeG1sLCByaHN4bWwpOwogICAg\nICAgIGlmIChsaHN4bWwgJiYgcmhzeG1sKQogICAgICAgICAgICBhcHBlbmRY\nbWxDb21wYXJpc29uMihidWYsIG9wLCBsaHMsIHJocyk7CiAgICAgICAgZWxz\nZSBpZiAobGhzeG1sKQogICAgICAgICAgICBhcHBlbmRYbWxDb21wYXJpc29u\nMShidWYsIG9wLCBsaHMsIHJocyk7CiAgICAgICAgZWxzZQogICAgICAgICAg\nICBhcHBlbmRYbWxDb21wYXJpc29uMShidWYsIG9wLCByaHMsIGxocyk7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBBcHBlbmQgYW4geG1sIGNvbXBhcmlzb24g\ncHJlZGljYXRlCiAgICAgKiAKICAgICAqIEBwYXJhbSBidWYgdGhlIFNRTCBi\ndWZmZXIgdG8gd3JpdGUgdGhlIGNvbXBhcmlzb24KICAgICAqIEBwYXJhbSBv\ncCB0aGUgY29tcGFyaXNvbiBvcGVyYXRpb24gdG8gcGVyZm9ybQogICAgICog\nQHBhcmFtIGxocyB0aGUgbGVmdCBoYW5kIHNpZGUgb2YgdGhlIGNvbXBhcmlz\nb24gKG1hcHMgdG8geG1sIGNvbHVtbikKICAgICAqIEBwYXJhbSByaHMgdGhl\nIHJpZ2h0IGhhbmQgc2lkZSBvZiB0aGUgY29tcGFyaXNvbgogICAgICovCiAg\nICBwcml2YXRlIHZvaWQgYXBwZW5kWG1sQ29tcGFyaXNvbjEoU1FMQnVmZmVy\nIGJ1ZiwgU3RyaW5nIG9wLAogICAgICAgIEZpbHRlclZhbHVlIGxocywgRmls\ndGVyVmFsdWUgcmhzKSB7CiAgICAgICAgYm9vbGVhbiBjYXN0cmhzID0gcmhz\nLmlzQ29uc3RhbnQoKTsKICAgICAgICBpZiAoY2FzdHJocykKICAgICAgICAg\nICAgYXBwZW5kWG1sVmFsdWUoYnVmLCBsaHMpOwogICAgICAgIGVsc2UKICAg\nICAgICAgICAgYXBwZW5kWG1sRXhpc3QoYnVmLCBsaHMpOwogICAgICAgIGJ1\nZi5hcHBlbmQoIiAiKS5hcHBlbmQob3ApLmFwcGVuZCgiICIpOwogICAgICAg\nIGlmIChjYXN0cmhzKQogICAgICAgICAgICByaHMuYXBwZW5kVG8oYnVmKTsK\nICAgICAgICBlbHNlIHsKICAgICAgICAgICAgYnVmLmFwcGVuZCgic3FsOmNv\nbHVtbihcIiIpOwogICAgICAgICAgICByaHMuYXBwZW5kVG8oYnVmKTsKICAg\nICAgICAgICAgYnVmLmFwcGVuZCgiXCIpIikuYXBwZW5kKCJdJykgPSAxIik7\nCiAgICAgICAgfQogICAgfQoKICAgIHByaXZhdGUgdm9pZCBhcHBlbmRYbWxF\neGlzdChTUUxCdWZmZXIgYnVmLCBGaWx0ZXJWYWx1ZSBsaHMpIHsKICAgICAg\nICBidWYuYXBwZW5kKGxocy5nZXRDb2x1bW5BbGlhcyhsaHMuZ2V0RmllbGRN\nYXBwaW5nKCkuZ2V0Q29sdW1ucygpWzBdKSkKICAgICAgICAgICAgLmFwcGVu\nZCgiLmV4aXN0KCciKS5hcHBlbmQoIi8qWyIpOwogICAgICAgIGxocy5hcHBl\nbmRUbyhidWYpOwogICAgfQoKICAgIC8qKgogICAgICogQXBwZW5kIGFuIHht\nbCBjb21wYXJpc29uIHByZWRpY2F0ZSAoYm90aCBvcGVyYW5kcyBtYXAgdG8g\neG1sIGNvbHVtbikKICAgICAqIAogICAgICogQHBhcmFtIGJ1ZiB0aGUgU1FM\nIGJ1ZmZlciB0byB3cml0ZSB0aGUgY29tcGFyaXNvbgogICAgICogQHBhcmFt\nIG9wIHRoZSBjb21wYXJpc29uIG9wZXJhdGlvbiB0byBwZXJmb3JtCiAgICAg\nKiBAcGFyYW0gbGhzIHRoZSBsZWZ0IGhhbmQgc2lkZSBvZiB0aGUgY29tcGFy\naXNvbiAobWFwcyB0byB4bWwgY29sdW1uKQogICAgICogQHBhcmFtIHJocyB0\naGUgcmlnaHQgaGFuZCBzaWRlIG9mIHRoZSBjb21wYXJpc29uIChtYXBzIHRv\nIHhtbCBjb2x1bW4pCiAgICAgKi8KICAgIHByaXZhdGUgdm9pZCBhcHBlbmRY\nbWxDb21wYXJpc29uMihTUUxCdWZmZXIgYnVmLCBTdHJpbmcgb3AsCiAgICAg\nICAgRmlsdGVyVmFsdWUgbGhzLCBGaWx0ZXJWYWx1ZSByaHMpIHsKICAgICAg\nICBhcHBlbmRYbWxWYWx1ZShidWYsIGxocyk7CiAgICAgICAgYnVmLmFwcGVu\nZCgiICIpLmFwcGVuZChvcCkuYXBwZW5kKCIgIik7CiAgICAgICAgYXBwZW5k\nWG1sVmFsdWUoYnVmLCByaHMpOwogICAgfQoKICAgIHByaXZhdGUgdm9pZCBh\ncHBlbmRYbWxWYWx1ZShTUUxCdWZmZXIgYnVmLCBGaWx0ZXJWYWx1ZSB2YWwp\nIHsKICAgICAgICBDbGFzcyByYyA9IEZpbHRlcnMud3JhcCh2YWwuZ2V0VHlw\nZSgpKTsKICAgICAgICBpbnQgdHlwZSA9IGdldEpEQkNUeXBlKEphdmFUeXBl\ncy5nZXRUeXBlQ29kZShyYyksIGZhbHNlKTsKICAgICAgICBib29sZWFuIGlz\nWG1sQXR0cmlidXRlID0gKHZhbC5nZXRYbWxNYXBwaW5nKCkgPT0gbnVsbCkK\nICAgICAgICAgICAgPyBmYWxzZSA6IHZhbC5nZXRYbWxNYXBwaW5nKCkuaXNY\nbWxBdHRyaWJ1dGUoKTsKICAgICAgICBidWYuYXBwZW5kKHZhbC5nZXRDb2x1\nbW5BbGlhcyh2YWwuZ2V0RmllbGRNYXBwaW5nKCkuZ2V0Q29sdW1ucygpWzBd\nKSkKICAgICAgICAgICAgLmFwcGVuZCgiLnZhbHVlKCIpLmFwcGVuZCgiJygv\nKi8iKTsKICAgICAgICB2YWwuYXBwZW5kVG8oYnVmKTsKICAgICAgICBpZiAo\nIWlzWG1sQXR0cmlidXRlKQogICAgICAgICAgICBidWYuYXBwZW5kKCIvdGV4\ndCgpIik7CiAgICAgICAgYnVmLmFwcGVuZCgiKVsxXScsJyIpLmFwcGVuZChn\nZXRUeXBlTmFtZSh0eXBlKSk7CiAgICAgICAgYXBwZW5kTGVuZ3RoKGJ1Ziwg\ndHlwZSk7CiAgICAgICAgYnVmLmFwcGVuZCgiJykiKTsKICAgIH0KCiAgICAv\nKioKICAgICAqIFJldHVybiBEQiBzcGVjaWZpYyBzY2hlbWFDYXNlCiAgICAg\nKi8KICAgIHB1YmxpYyBTdHJpbmcgZ2V0U2NoZW1hQ2FzZSgpIHsKICAgICAg\nICByZXR1cm4gc2NoZW1hQ2FzZTsKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAg\nIHB1YmxpYyB2b2lkIHNldFN1cHBvcnRzWE1MQ29sdW1uKGJvb2xlYW4gYikg\newogICAgICAgIHN1cGVyLnNldFN1cHBvcnRzWE1MQ29sdW1uKGIpOwogICAg\nICAgIC8vIE1TIFNRTCBTZXJ2ZXIgcmVxdWlyZXMgWE1MIGRhdGEgaW4gVVRG\nLTE2IG9yIFVDUy0yIGluc3RlYWQgb2YgSkFYQiBkZWZhdWx0IG9mIFVURi04\nCiAgICAgICAgc3VwZXIuc2V0WE1MVHlwZUVuY29kaW5nKCJVVEYtMTYiKTsK\nICAgIH0KICAgIAogICAgQE92ZXJyaWRlCiAgICBwcm90ZWN0ZWQgQm9vbGVh\nbiBtYXRjaEVycm9yU3RhdGUoaW50IHN1YnR5cGUsIFNldDxTdHJpbmc+IGVy\ncm9yU3RhdGVzLAogICAgICAgIFNRTEV4Y2VwdGlvbiBleCkgewogICAgICAg\nIEJvb2xlYW4gcmVjb3ZlcmFibGUgPSBudWxsOwogICAgICAgIFN0cmluZyBl\ncnJvclN0YXRlID0gZXguZ2V0U1FMU3RhdGUoKTsKICAgICAgICBpZiAoZXJy\nb3JTdGF0ZXMuY29udGFpbnMoZXJyb3JTdGF0ZSkpIHsKICAgICAgICAgICAg\ncmVjb3ZlcmFibGUgPSBCb29sZWFuLkZBTFNFOwogICAgICAgICAgICBpZiAo\nc3VidHlwZSA9PSBTdG9yZUV4Y2VwdGlvbi5MT0NLICYmIGVycm9yU3RhdGUu\nZXF1YWxzKCIxMjIyIikpIHsKICAgICAgICAgICAgICAgIHJlY292ZXJhYmxl\nID0gQm9vbGVhbi5UUlVFOwogICAgICAgICAgICB9IGVsc2UgaWYgKHN1YnR5\ncGUgPT0gU3RvcmVFeGNlcHRpb24uUVVFUlkgJiYKICAgICAgICAgICAgICAg\nIGVycm9yU3RhdGUuZXF1YWxzKCJIWTAwOCIpKSB7CiAgICAgICAgICAgICAg\nICByZWNvdmVyYWJsZSA9IEJvb2xlYW4uVFJVRTsKICAgICAgICAgICAgfQog\nICAgICAgIH0KICAgICAgICByZXR1cm4gcmVjb3ZlcmFibGU7CiAgICB9Cn0K\n","encoding":"base64"}

