{"sha":"e7ff2b93648bc12854bfb20b31e3ad36c5611440","node_id":"MDQ6QmxvYjIwNjM2NDplN2ZmMmI5MzY0OGJjMTI4NTRiZmIyMGIzMWUzYWQzNmM1NjExNDQw","size":6902,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/e7ff2b93648bc12854bfb20b31e3ad36c5611440","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuZGF0YWNhY2hlOwoKaW1wb3J0\nIGphdmEudXRpbC5CaXRTZXQ7CgppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLmtlcm5lbC5BYnN0cmFjdFBDRGF0YTsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5rZXJuZWwuT3BlbkpQQVN0YXRlTWFuYWdlcjsKaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS5rZXJuZWwuUENEYXRhOwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLmtlcm5lbC5QQ0RhdGFJbXBsOwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLmtlcm5lbC5QQ1N0YXRlOwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLmtlcm5lbC5TdG9yZUNvbnRleHQ7CmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEubWV0YS5DbGFzc01ldGFEYXRhOwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLm1ldGEuRmllbGRNZXRhRGF0YTsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5tZXRhLkphdmFUeXBlczsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS5tZXRhLlZhbHVlTWV0YURhdGE7CgovKioKICogU3BlY2lhbGl6\nZWQge0BsaW5rIFBDRGF0YX0gaW1wbGVtZW50YXRpb24gZm9yIGRhdGEgY2Fj\naGluZy4gVGhpcwogKiBpbXBsZW1lbnRhdGlvbiBpcyBwcm9wZXJseSBzeW5j\naHJvbml6ZWQuCiAqCiAqIEBhdXRob3IgUGF0cmljayBMaW5za2V5CiAqLwpw\ndWJsaWMgY2xhc3MgRGF0YUNhY2hlUENEYXRhSW1wbAogICAgZXh0ZW5kcyBQ\nQ0RhdGFJbXBsCiAgICBpbXBsZW1lbnRzIERhdGFDYWNoZVBDRGF0YSB7Cgog\nICAgcHJpdmF0ZSBmaW5hbCBsb25nIF9leHA7CgogICAgLyoqCiAgICAgKiBD\nb25zdHJ1Y3Rvci4KICAgICAqLwogICAgcHVibGljIERhdGFDYWNoZVBDRGF0\nYUltcGwoT2JqZWN0IG9pZCwgQ2xhc3NNZXRhRGF0YSBtZXRhKSB7CiAgICAg\nICAgc3VwZXIob2lkLCBtZXRhKTsKCiAgICAgICAgaW50IHRpbWVvdXQgPSBt\nZXRhLmdldERhdGFDYWNoZVRpbWVvdXQoKTsKICAgICAgICBpZiAodGltZW91\ndCA+IDApCiAgICAgICAgICAgIF9leHAgPSBTeXN0ZW0uY3VycmVudFRpbWVN\naWxsaXMoKSArIHRpbWVvdXQ7CiAgICAgICAgZWxzZQogICAgICAgICAgICBf\nZXhwID0gLTE7CiAgICB9CgogICAgcHVibGljIGJvb2xlYW4gaXNUaW1lZE91\ndCgpIHsKICAgICAgICByZXR1cm4gX2V4cCAhPSAtMSAmJiBfZXhwIDwgU3lz\ndGVtLmN1cnJlbnRUaW1lTWlsbGlzKCk7CiAgICB9CiAgICAKICAgIHB1Ymxp\nYyBsb25nIGdldFRpbWVPdXQoKSB7CiAgICAgICAgcmV0dXJuIF9leHA7CiAg\nICB9CgogICAgcHVibGljIHN5bmNocm9uaXplZCBPYmplY3QgZ2V0RGF0YShp\nbnQgaW5kZXgpIHsKICAgICAgICByZXR1cm4gc3VwZXIuZ2V0RGF0YShpbmRl\neCk7CiAgICB9CgogICAgcHVibGljIHN5bmNocm9uaXplZCB2b2lkIHNldERh\ndGEoaW50IGluZGV4LCBPYmplY3QgdmFsKSB7CiAgICAgICAgc3VwZXIuc2V0\nRGF0YShpbmRleCwgdmFsKTsKICAgIH0KCiAgICBwdWJsaWMgc3luY2hyb25p\nemVkIHZvaWQgY2xlYXJEYXRhKGludCBpbmRleCkgewogICAgICAgIHN1cGVy\nLmNsZWFyRGF0YShpbmRleCk7CiAgICB9CgogICAgcHVibGljIHN5bmNocm9u\naXplZCBPYmplY3QgZ2V0SW1wbERhdGEoKSB7CiAgICAgICAgcmV0dXJuIHN1\ncGVyLmdldEltcGxEYXRhKCk7CiAgICB9CgogICAgcHVibGljIHN5bmNocm9u\naXplZCB2b2lkIHNldEltcGxEYXRhKE9iamVjdCB2YWwpIHsKICAgICAgICBz\ndXBlci5zZXRJbXBsRGF0YSh2YWwpOwogICAgfQoKICAgIHB1YmxpYyBzeW5j\naHJvbml6ZWQgT2JqZWN0IGdldEltcGxEYXRhKGludCBpbmRleCkgewogICAg\nICAgIHJldHVybiBzdXBlci5nZXRJbXBsRGF0YShpbmRleCk7CiAgICB9Cgog\nICAgcHVibGljIHN5bmNocm9uaXplZCB2b2lkIHNldEltcGxEYXRhKGludCBp\nbmRleCwgT2JqZWN0IHZhbCkgewogICAgICAgIHN1cGVyLnNldEltcGxEYXRh\nKGluZGV4LCB2YWwpOwogICAgfQoKICAgIHB1YmxpYyBzeW5jaHJvbml6ZWQg\nT2JqZWN0IGdldEludGVybWVkaWF0ZShpbnQgaW5kZXgpIHsKICAgICAgICBy\nZXR1cm4gc3VwZXIuZ2V0SW50ZXJtZWRpYXRlKGluZGV4KTsKICAgIH0KCiAg\nICBwdWJsaWMgc3luY2hyb25pemVkIHZvaWQgc2V0SW50ZXJtZWRpYXRlKGlu\ndCBpbmRleCwgT2JqZWN0IHZhbCkgewogICAgICAgIHN1cGVyLnNldEludGVy\nbWVkaWF0ZShpbmRleCwgdmFsKTsKICAgIH0KCiAgICBwdWJsaWMgc3luY2hy\nb25pemVkIGJvb2xlYW4gaXNMb2FkZWQoaW50IGluZGV4KSB7CiAgICAgICAg\ncmV0dXJuIHN1cGVyLmlzTG9hZGVkKGluZGV4KTsKICAgIH0KCiAgICBwdWJs\naWMgc3luY2hyb25pemVkIHZvaWQgc2V0TG9hZGVkKGludCBpbmRleCwgYm9v\nbGVhbiBsb2FkZWQpIHsKICAgICAgICBzdXBlci5zZXRMb2FkZWQoaW5kZXgs\nIGxvYWRlZCk7CiAgICB9CgogICAgcHVibGljIHN5bmNocm9uaXplZCBPYmpl\nY3QgZ2V0VmVyc2lvbigpIHsKICAgICAgICByZXR1cm4gc3VwZXIuZ2V0VmVy\nc2lvbigpOwogICAgfQoKICAgIHB1YmxpYyBzeW5jaHJvbml6ZWQgdm9pZCBz\nZXRWZXJzaW9uKE9iamVjdCB2ZXJzaW9uKSB7CiAgICAgICAgc3VwZXIuc2V0\nVmVyc2lvbih2ZXJzaW9uKTsKICAgIH0KCiAgICBwdWJsaWMgc3luY2hyb25p\nemVkIHZvaWQgc3RvcmUoT3BlbkpQQVN0YXRlTWFuYWdlciBzbSkgewogICAg\nICAgIHN1cGVyLnN0b3JlKHNtKTsKICAgIH0KCiAgICBwdWJsaWMgc3luY2hy\nb25pemVkIHZvaWQgc3RvcmUoT3BlbkpQQVN0YXRlTWFuYWdlciBzbSwgQml0\nU2V0IGZpZWxkcykgewogICAgICAgIHN1cGVyLnN0b3JlKHNtLCBmaWVsZHMp\nOwogICAgfQoKICAgIC8qKgogICAgICogU3RvcmUgZmllbGQtbGV2ZWwgaW5m\nb3JtYXRpb24gZnJvbSB0aGUgZ2l2ZW4gc3RhdGUgbWFuYWdlci4KICAgICAq\nIFNwZWNpYWwgcHJvY2VzcyBvZiBjaGVja2luZyBpZiB0aGUgY2FjaGVkIGNv\nbGxlY3Rpb24gZGF0YSBpcyBvdXQgb2YKICAgICAqIG9yZGVyLgogICAgICov\nCiAgICBwcm90ZWN0ZWQgdm9pZCBzdG9yZUZpZWxkKE9wZW5KUEFTdGF0ZU1h\nbmFnZXIgc20sIEZpZWxkTWV0YURhdGEgZm1kKSB7CiAgICAgICAgaWYgKGZt\nZC5nZXRNYW5hZ2VtZW50KCkgIT0gZm1kLk1BTkFHRV9QRVJTSVNURU5UKQog\nICAgICAgICAgICByZXR1cm47CiAgICAgICAgaW50IGluZGV4ID0gZm1kLmdl\ndEluZGV4KCk7CgogICAgICAgIC8vIGlmIHRoZSBmaWVsZCBpcyBhIGNvbGxl\nY3Rpb24gYW5kIGhhcyAib3JkZXIgYnkiIHNldCwgZG9uJ3QgY2FjaGUKICAg\nICAgICAvLyBpdCBpZiB0aGlzIHN0b3JlIGlzIGNvbWluZyBmcm9tIGEgY3Jl\nYXRlIG9yIHVwZGF0ZSAoaS5lLiwgb25seQogICAgICAgIC8vIGVubGlzdCBp\nbiBjYWNoZSBpZiB0aGlzIGlzIGNvbWluZyBmcm9tIGEgZGF0YWJhc2UgcmVh\nZCkuCiAgICAgICAgaWYgKGZtZC5nZXRPcmRlcnMoKS5sZW5ndGggPiAwKSB7\nCiAgICAgICAgICAgIGlmIChzbS5nZXRQQ1N0YXRlKCkgPT0gUENTdGF0ZS5Q\nTkVXKQogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICBpZiAo\nc20uZ2V0UENTdGF0ZSgpID09IFBDU3RhdGUuUERJUlRZKSB7CiAgICAgICAg\nICAgICAgICBjbGVhckRhdGEoaW5kZXgpOwogICAgICAgICAgICAgICAgcmV0\ndXJuOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBzdXBlci5z\ndG9yZUZpZWxkKHNtLCBmbWQpOwoKICAgICAgICAvLyBJZiB0aGlzIGZpZWxk\nIGlzIHVzZWQgaW4gIm9yZGVyIGJ5Iiwgd2UgbmVlZCB0byBpbnZhbGlkYXRl\nIGNhY2hlCiAgICAgICAgLy8gZm9yIHRoZSBjb2xsZWN0aW9uIHRoYXQgcmVm\nZXIgdG8gdGhpcyBmaWVsZC4KICAgICAgICBpZiAoKHNtLmdldFBDU3RhdGUo\nKSA9PSBQQ1N0YXRlLlBESVJUWSkgJiYgZm1kLmlzVXNlZEluT3JkZXJCeSgp\nKSB7CiAgICAgICAgICAgIGNsZWFySW52ZXJzZVJlbGF0aW9uQ2FjaGUoc20s\nIGZtZCk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogQ2hlY2sg\naWYgdGhpcyBmaWVsZCBpcyBpbiB1c2Ugb2YgIm9yZGVyIGJ5IiBieSBvdGhl\nciBmaWVsZCBjb2xsZWN0aW9ucwogICAgICogaW4gaW52ZXJzZSByZWxhdGlv\nbi4gSWYgaXQgaXMsIGNsZWFyIHRoZSBvdGhlciBmaWVsZCBjYWNoZSBiZWNh\ndXNlIGl0CiAgICAgKiBjb3VsZCBiZSBvdXQgb2Ygb3JkZXIuCiAgICAgKi8K\nICAgIHByb3RlY3RlZCB2b2lkIGNsZWFySW52ZXJzZVJlbGF0aW9uQ2FjaGUo\nT3BlbkpQQVN0YXRlTWFuYWdlciBzbSwKICAgICAgICBGaWVsZE1ldGFEYXRh\nIGZtZCkgewogICAgICAgIENsYXNzTWV0YURhdGEgY21kID0gc20uZ2V0TWV0\nYURhdGEoKTsKICAgICAgICBGaWVsZE1ldGFEYXRhW10gZmllbGRzID0gY21k\nLmdldEZpZWxkcygpOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgZmll\nbGRzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIEZpZWxkTWV0YURhdGFb\nXSBpbnZlcnNlcyA9IGZpZWxkc1tpXS5nZXRJbnZlcnNlTWV0YURhdGFzKCk7\nCiAgICAgICAgICAgIGlmIChpbnZlcnNlcy5sZW5ndGggPT0gMCkKICAgICAg\nICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICBmb3IgKGludCBqID0g\nMDsgaiA8IGludmVyc2VzLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICAgICAg\nICBpZiAoaW52ZXJzZXNbal0uZ2V0T3JkZXJEZWNsYXJhdGlvbigpCiAgICAg\nICAgICAgICAgICAgICAgLmluZGV4T2YoZm1kLmdldE5hbWUoKSkgIT0gLTEp\nIHsKICAgICAgICAgICAgICAgICAgICBEYXRhQ2FjaGUgY2FjaGUgPSBzbS5n\nZXRNZXRhRGF0YSgpLmdldERhdGFDYWNoZSgpOwogICAgICAgICAgICAgICAg\nICAgIE9iamVjdCBvaWQgPSBzbS5nZXRDb250ZXh0KCkuZ2V0T2JqZWN0SWQo\nc20uZmV0Y2goaSkpOwogICAgICAgICAgICAgICAgICAgIERhdGFDYWNoZVBD\nRGF0YSBkYXRhID0gY2FjaGUgPT0gbnVsbCA/IG51bGwKICAgICAgICAgICAg\nICAgICAgICAgICAgOiBjYWNoZS5nZXQob2lkKTsKICAgICAgICAgICAgICAg\nICAgICBpZiAoKGRhdGEgIT0gbnVsbCkgJiYKICAgICAgICAgICAgICAgICAg\nICAgICAgKGRhdGEgaW5zdGFuY2VvZiBEYXRhQ2FjaGVQQ0RhdGFJbXBsKSkg\newogICAgICAgICAgICAgICAgICAgICAgICAoKERhdGFDYWNoZVBDRGF0YUlt\ncGwpIGRhdGEpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuY2xlYXJE\nYXRhKGludmVyc2VzW2pdLmdldEluZGV4KCkpOwogICAgICAgICAgICAgICAg\nICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAg\nIH0KICAgIH0KCiAgICBwcm90ZWN0ZWQgT2JqZWN0IHRvRGF0YShGaWVsZE1l\ndGFEYXRhIGZtZCwgT2JqZWN0IHZhbCwgU3RvcmVDb250ZXh0IGN0eCkgewog\nICAgICAgIC8vIGF2b2lkIGNhY2hpbmcgbGFyZ2UgcmVzdWx0IHNldCBmaWVs\nZHMKICAgICAgICBpZiAoZm1kLmlzTFJTKCkgfHwgZm1kLmlzU3RyZWFtKCkp\nCiAgICAgICAgICAgIHJldHVybiBOVUxMOwogICAgICAgIHJldHVybiBzdXBl\nci50b0RhdGEoZm1kLCB2YWwsIGN0eCk7CiAgICB9CgogICAgcHJvdGVjdGVk\nIE9iamVjdCB0b05lc3RlZERhdGEoVmFsdWVNZXRhRGF0YSB2bWQsIE9iamVj\ndCB2YWwsCiAgICAgICAgU3RvcmVDb250ZXh0IGN0eCkgewogICAgICAgIGlm\nICh2YWwgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIG51bGw7CgogICAg\nICAgIC8vIGRvbid0IHRyeSB0byBjYWNoZSBuZXN0ZWQgY29udGFpbmVycwog\nICAgICAgIHN3aXRjaCAodm1kLmdldERlY2xhcmVkVHlwZUNvZGUoKSkgewog\nICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5DT0xMRUNUSU9OOgogICAgICAg\nICAgICBjYXNlIEphdmFUeXBlcy5NQVA6CiAgICAgICAgICAgIGNhc2UgSmF2\nYVR5cGVzLkFSUkFZOgogICAgICAgICAgICAgICAgcmV0dXJuIE5VTEw7CiAg\nICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgICByZXR1cm4gc3Vw\nZXIudG9OZXN0ZWREYXRhKHZtZCwgdmFsLCBjdHgpOwogICAgICAgIH0KICAg\nIH0KCiAgICBwdWJsaWMgQWJzdHJhY3RQQ0RhdGEgbmV3RW1iZWRkZWRQQ0Rh\ndGEoT3BlbkpQQVN0YXRlTWFuYWdlciBzbSkgewogICAgICAgIHJldHVybiBu\nZXcgRGF0YUNhY2hlUENEYXRhSW1wbChzbS5nZXRJZCgpLCBzbS5nZXRNZXRh\nRGF0YSgpKTsKICAgIH0KfQo=\n","encoding":"base64"}

