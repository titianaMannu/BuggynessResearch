{"sha":"4f1956fdc67553d40cea53b28e752e24784b65d1","node_id":"MDQ6QmxvYjIwNjM2NDo0ZjE5NTZmZGM2NzU1M2Q0MGNlYTUzYjI4ZTc1MmUyNDc4NGI2NWQx","size":5710,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/4f1956fdc67553d40cea53b28e752e24784b65d1","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNr\nYWdlIG9yZy5hcGFjaGUub3BlbmpwYS5lbmhhbmNlOwoKaW1wb3J0IGphdmEu\nbGFuZy5pbnN0cnVtZW50LkNsYXNzRGVmaW5pdGlvbjsKaW1wb3J0IGphdmEu\nbGFuZy5pbnN0cnVtZW50LkNsYXNzRmlsZVRyYW5zZm9ybWVyOwppbXBvcnQg\namF2YS5sYW5nLmluc3RydW1lbnQuSW5zdHJ1bWVudGF0aW9uOwppbXBvcnQg\namF2YS5sYW5nLnJlZmxlY3QuTWV0aG9kOwppbXBvcnQgamF2YS5zZWN1cml0\neS5Qcm90ZWN0aW9uRG9tYWluOwppbXBvcnQgamF2YS51dGlsLk1hcDsKCmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuY29uZi5PcGVuSlBBQ29uZmlndXJh\ndGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIubG9nLkxvZzsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIudXRpbC5KYXZhVmVyc2lv\nbnM7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuTG9jYWxp\nemVyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuSW50ZXJuYWxF\neGNlcHRpb247CgovKioKICogUmVkZWZpbmVzIHRoZSBtZXRob2QgYm9kaWVz\nIG9mIGV4aXN0aW5nIGNsYXNzZXMuIFN1cHBvcnRzIEphdmEgNSBWTXMgdGhh\ndAogKiBoYXZlIGEgamF2YSBhZ2VudCBpbnN0YWxsZWQgb24gdGhlIGNvbW1h\nbmQgbGluZSBhcyB3ZWxsIGFzIG5ld2VyIFZNcyB3aXRob3V0CiAqIGFueSA8\nY29kZT4tamF2YWFnZW50PC9jb2RlPiBmbGFnLgogKgogKiBAc2luY2UgMS4w\nLjAKICovCnB1YmxpYyBjbGFzcyBDbGFzc1JlZGVmaW5lciB7CgogICAgcHJp\ndmF0ZSBzdGF0aWMgZmluYWwgTG9jYWxpemVyIF9sb2MgPSBMb2NhbGl6ZXIu\nZm9yUGFja2FnZShDbGFzc1JlZGVmaW5lci5jbGFzcyk7CgogICAgcHJpdmF0\nZSBzdGF0aWMgQm9vbGVhbiBfY2FuUmVkZWZpbmUgPSBudWxsOwoKICAgIC8q\nKgogICAgICogRm9yIGVhY2ggZWxlbWVudCBpbiA8Y29kZT5jbGFzc2VzPC9j\nb2RlPiwgdGhpcyBtZXRob2Qgd2lsbCByZWRlZmluZQogICAgICogYWxsIHRo\nZSBlbGVtZW50J3MgbWV0aG9kcyBzdWNoIHRoYXQgZmllbGQgYWNjZXNzZXMg\nYXJlIGludGVyY2VwdGVkCiAgICAgKiBpbi1saW5lLiBJZiB7QGxpbmsgI2Nh\nblJlZGVmaW5lQ2xhc3NlcygpfSByZXR1cm5zIDxjb2RlPmZhbHNlPC9jb2Rl\nPiwKICAgICAqIHRoaXMgbWV0aG9kIGlzIGEgbm8tb3AuCiAgICAgKi8KICAg\nIHB1YmxpYyBzdGF0aWMgdm9pZCByZWRlZmluZUNsYXNzZXMoT3BlbkpQQUNv\nbmZpZ3VyYXRpb24gY29uZiwKICAgICAgICBmaW5hbCBNYXA8Q2xhc3M8Pz4s\nYnl0ZVtdPiBjbGFzc2VzKSB7CiAgICAgICAgTG9nIGxvZyA9IGNvbmYuZ2V0\nTG9nKE9wZW5KUEFDb25maWd1cmF0aW9uLkxPR19FTkhBTkNFKTsKICAgICAg\nICBpZiAoY2xhc3NlcyA9PSBudWxsIHx8IGNsYXNzZXMuc2l6ZSgpID09IDAg\nfHwgIWNhblJlZGVmaW5lQ2xhc3Nlcyhsb2cpKQogICAgICAgICAgICByZXR1\ncm47CgogICAgICAgIEluc3RydW1lbnRhdGlvbiBpbnN0ID0gbnVsbDsKICAg\nICAgICBDbGFzc0ZpbGVUcmFuc2Zvcm1lciB0ID0gbnVsbDsKICAgICAgICB0\ncnkgewogICAgICAgICAgICBpbnN0ID0gSW5zdHJ1bWVudGF0aW9uRmFjdG9y\neS5nZXRJbnN0cnVtZW50YXRpb24obG9nKTsKCiAgICAgICAgICAgIENsYXNz\nPD8+W10gYXJyYXkgPSBjbGFzc2VzLmtleVNldCgpLnRvQXJyYXkobmV3IENs\nYXNzW2NsYXNzZXMuc2l6ZSgpXSk7CiAgICAgICAgICAgIGlmIChKYXZhVmVy\nc2lvbnMuVkVSU0lPTiA+PSA2KSB7CiAgICAgICAgICAgICAgICBsb2cudHJh\nY2UoX2xvYy5nZXQoInJldHJhbnNmb3JtLXR5cGVzIiwgY2xhc3Nlcy5rZXlT\nZXQoKSkpOwoKICAgICAgICAgICAgICAgIHQgPSBuZXcgQ2xhc3NGaWxlVHJh\nbnNmb3JtZXIoKSB7CiAgICAgICAgICAgICAgICAgICAgcHVibGljIGJ5dGVb\nXSB0cmFuc2Zvcm0oQ2xhc3NMb2FkZXIgbG9hZGVyLCBTdHJpbmcgY2xzTmFt\nZSwKICAgICAgICAgICAgICAgICAgICAgICAgQ2xhc3M8Pz4gY2xhc3NCZWlu\nZ1JlZGVmaW5lZCwgUHJvdGVjdGlvbkRvbWFpbiBwZCwKICAgICAgICAgICAg\nICAgICAgICAgICAgYnl0ZVtdIGNsYXNzZmlsZUJ1ZmZlcikgewogICAgICAg\nICAgICAgICAgICAgICAgICByZXR1cm4gY2xhc3Nlcy5nZXQoY2xhc3NCZWlu\nZ1JlZGVmaW5lZCk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAg\nICAgICAgfTsKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgLy8g\ndGhlc2UgYXJlIEphdmEgNiBtZXRob2RzLCBhbmQgd2UgZG9uJ3QgaGF2ZSBh\nIEphdmEgNiBidWlsZAogICAgICAgICAgICAgICAgLy8gbW9kdWxlIHlldC4g\nVGhlIGNvc3Qgb2YgcmVmbGVjdGlvbiBoZXJlIGlzIG5lZ2xpZ2libGUKICAg\nICAgICAgICAgICAgIC8vIGNvbXBhcmVkIHRvIHRoZSByZWRlZmluaXRpb24g\nLyBlbmhhbmNlbWVudCBjb3N0cyBpbiB0b3RhbCwKICAgICAgICAgICAgICAg\nIC8vIHNvIHRoaXMgc2hvdWxkIG5vdCBiZSBhIGJpZyBwcm9ibGVtLgogICAg\nICAgICAgICAgICAgTWV0aG9kIG1ldGggPSBpbnN0LmdldENsYXNzKCkuZ2V0\nTWV0aG9kKCJhZGRUcmFuc2Zvcm1lciIsCiAgICAgICAgICAgICAgICAgICAg\nbmV3IENsYXNzW10geyBDbGFzc0ZpbGVUcmFuc2Zvcm1lci5jbGFzcywgYm9v\nbGVhbi5jbGFzcyB9KTsKICAgICAgICAgICAgICAgIG1ldGguaW52b2tlKGlu\nc3QsIG5ldyBPYmplY3RbXSB7IHQsIHRydWUgfSk7CiAgICAgICAgICAgICAg\nICBtZXRoID0gaW5zdC5nZXRDbGFzcygpLmdldE1ldGhvZCgicmV0cmFuc2Zv\ncm1DbGFzc2VzIiwKICAgICAgICAgICAgICAgICAgICBuZXcgQ2xhc3NbXSB7\nIGFycmF5LmdldENsYXNzKCkgfSk7CiAgICAgICAgICAgICAgICBtZXRoLmlu\ndm9rZShpbnN0LCBuZXcgT2JqZWN0W10geyBhcnJheSB9KTsKICAgICAgICAg\nICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGxvZy50cmFjZShfbG9jLmdl\ndCgicmVkZWZpbmUtdHlwZXMiLCBjbGFzc2VzLmtleVNldCgpKSk7CiAgICAg\nICAgICAgICAgICAvLyBpbiBhIEphdmEgNSBjb250ZXh0LCB3ZSBjYW4gdXNl\nIGNsYXNzIHJlZGVmaW5pdGlvbiBpbnN0ZWFkCiAgICAgICAgICAgICAgICBD\nbGFzc0RlZmluaXRpb25bXSBkZWZzID0gbmV3IENsYXNzRGVmaW5pdGlvblth\ncnJheS5sZW5ndGhdOwogICAgICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7\nIGkgPCBkZWZzLmxlbmd0aDsgaSsrKQogICAgICAgICAgICAgICAgICAgIGRl\nZnNbaV0gPSBuZXcgQ2xhc3NEZWZpbml0aW9uKGFycmF5W2ldLAogICAgICAg\nICAgICAgICAgICAgICAgICBjbGFzc2VzLmdldChhcnJheVtpXSkpOwogICAg\nICAgICAgICAgICAgaW5zdC5yZWRlZmluZUNsYXNzZXMoZGVmcyk7CiAgICAg\nICAgICAgIH0KICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkgewogICAg\nICAgICAgICB0aHJvdyBuZXcgSW50ZXJuYWxFeGNlcHRpb24oZSk7CiAgICAg\nICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgaWYgKGluc3QgIT0gbnVsbCAm\nJiB0ICE9IG51bGwpCiAgICAgICAgICAgICAgICBpbnN0LnJlbW92ZVRyYW5z\nZm9ybWVyKHQpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIEBy\nZXR1cm4gd2hldGhlciBvciBub3QgdGhpcyBWTSBoYXMgYW4gaW5zdHJ1bWVu\ndGF0aW9uIGluc3RhbGxlZCB0aGF0CiAgICAgKiBwZXJtaXRzIHJlZGVmaW5p\ndGlvbiBvZiBjbGFzc2VzLiBUaGlzIGFzc3VtZXMgdGhhdCBhbGwgdGhlIGFy\nZ3VtZW50cwogICAgICogd2lsbCBiZSBtb2RpZmlhYmxlIGNsYXNzZXMgYWNj\nb3JkaW5nIHRvCiAgICAgKiB7QGxpbmsgamF2YS5sYW5nLmluc3RydW1lbnQu\nSW5zdHJ1bWVudGF0aW9uI2lzTW9kaWZpYWJsZUNsYXNzfSwgYW5kCiAgICAg\nKiBvbmx5IGNoZWNrcyB3aGV0aGVyIG9yIG5vdCBhbiBpbnN0cnVtZW50YXRp\nb24gaXMgYXZhaWxhYmxlIGFuZAogICAgICogaWYgcmV0cmFuc2Zvcm1hdGlv\nbiBpcyBwb3NzaWJsZS4KICAgICAqLwogICAgcHVibGljIHN0YXRpYyBib29s\nZWFuIGNhblJlZGVmaW5lQ2xhc3NlcyhMb2cgbG9nKSB7CiAgICAgICAgaWYg\nKF9jYW5SZWRlZmluZSA9PSBudWxsKSB7CiAgICAgICAgICAgIHRyeSB7CiAg\nICAgICAgICAgICAgICBJbnN0cnVtZW50YXRpb24gaW5zdCA9IEluc3RydW1l\nbnRhdGlvbkZhY3RvcnkuZ2V0SW5zdHJ1bWVudGF0aW9uKGxvZyk7CiAgICAg\nICAgICAgICAgICBpZiAoaW5zdCA9PSBudWxsKSB7CiAgICAgICAgICAgICAg\nICAgICAgX2NhblJlZGVmaW5lID0gQm9vbGVhbi5GQUxTRTsKICAgICAgICAg\nICAgICAgIH0gZWxzZSBpZiAoSmF2YVZlcnNpb25zLlZFUlNJT04gPT0gNSkg\newogICAgICAgICAgICAgICAgICAgIC8vIGlmIGluc3RydW1lbnRhdGlvbiBp\ncyBub24tbnVsbCBhbmQgd2UncmUgdXNpbmcgSmF2YSA1LAogICAgICAgICAg\nICAgICAgICAgIC8vIGlzUmV0cmFuc2Zvcm1DbGFzc2VzU3VwcG9ydGVkIGlz\nbid0IGF2YWlsYWJsZSwKICAgICAgICAgICAgICAgICAgICAvLyBzbyB3ZSB1\nc2UgdGhlIG1vcmUgYmFzaWMgY2xhc3MgcmVkZWZpbml0aW9uIGluc3RlYWQu\nCiAgICAgICAgICAgICAgICAgICAgX2NhblJlZGVmaW5lID0gQm9vbGVhbi5U\nUlVFOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAg\nICAgICBfY2FuUmVkZWZpbmUgPSAoQm9vbGVhbikgSW5zdHJ1bWVudGF0aW9u\nLmNsYXNzLmdldE1ldGhvZCgKICAgICAgICAgICAgICAgICAgICAgICAgImlz\nUmV0cmFuc2Zvcm1DbGFzc2VzU3VwcG9ydGVkIikuaW52b2tlKGluc3QpOwog\nICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGNhdGNoIChFeGNlcHRp\nb24gZSkgewogICAgICAgICAgICAgICAgX2NhblJlZGVmaW5lID0gQm9vbGVh\nbi5GQUxTRTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1\ncm4gX2NhblJlZGVmaW5lLmJvb2xlYW5WYWx1ZSgpOwogICAgfQp9Cg==\n","encoding":"base64"}

