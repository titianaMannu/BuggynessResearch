{"sha":"19f96214074abb0ec31ac9a3883cdfa599ffadf2","node_id":"MDQ6QmxvYjIwNjM2NDoxOWY5NjIxNDA3NGFiYjBlYzMxYWM5YTM4ODNjZGZhNTk5ZmZhZGYy","size":72830,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/19f96214074abb0ec31ac9a3883cdfa599ffadf2","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YTsKCmltcG9ydCBqYXZh\nLmlvLkV4dGVybmFsaXphYmxlOwppbXBvcnQgamF2YS5pby5JT0V4Y2VwdGlv\nbjsKaW1wb3J0IGphdmEuaW8uT2JqZWN0SW5wdXQ7CmltcG9ydCBqYXZhLmlv\nLk9iamVjdE91dHB1dDsKaW1wb3J0IGphdmEuaW8uU2VyaWFsaXphYmxlOwpp\nbXBvcnQgamF2YS5sYW5nLnJlZmxlY3QuQ29uc3RydWN0b3I7CmltcG9ydCBq\nYXZhLmxhbmcucmVmbGVjdC5GaWVsZDsKaW1wb3J0IGphdmEubGFuZy5yZWZs\nZWN0Lkludm9jYXRpb25UYXJnZXRFeGNlcHRpb247CmltcG9ydCBqYXZhLmxh\nbmcucmVmbGVjdC5NZW1iZXI7CmltcG9ydCBqYXZhLmxhbmcucmVmbGVjdC5N\nZXRob2Q7CmltcG9ydCBqYXZhLmxhbmcucmVmbGVjdC5Nb2RpZmllcjsKaW1w\nb3J0IGphdmEuc2VjdXJpdHkuQWNjZXNzQ29udHJvbGxlcjsKaW1wb3J0IGph\ndmEuc2VjdXJpdHkuUHJpdmlsZWdlZEFjdGlvbkV4Y2VwdGlvbjsKaW1wb3J0\nIGphdmEudXRpbC5BcnJheUxpc3Q7CmltcG9ydCBqYXZhLnV0aWwuQ2FsZW5k\nYXI7CmltcG9ydCBqYXZhLnV0aWwuQ29sbGVjdGlvbjsKaW1wb3J0IGphdmEu\ndXRpbC5Db2xsZWN0aW9uczsKaW1wb3J0IGphdmEudXRpbC5Db21wYXJhdG9y\nOwppbXBvcnQgamF2YS51dGlsLkhhc2hNYXA7CmltcG9ydCBqYXZhLnV0aWwu\nSGFzaFNldDsKaW1wb3J0IGphdmEudXRpbC5JdGVyYXRvcjsKaW1wb3J0IGph\ndmEudXRpbC5MaXN0OwppbXBvcnQgamF2YS51dGlsLk1hcDsKaW1wb3J0IGph\ndmEudXRpbC5Qcm9wZXJ0aWVzOwppbXBvcnQgamF2YS51dGlsLlNldDsKaW1w\nb3J0IGphdmEudXRpbC5UaW1lWm9uZTsKCmltcG9ydCBvcmcuYXBhY2hlLmNv\nbW1vbnMuY29sbGVjdGlvbnMuY29tcGFyYXRvcnMuQ29tcGFyYXRvckNoYWlu\nOwppbXBvcnQgb3JnLmFwYWNoZS5jb21tb25zLmxhbmcuU3RyaW5nVXRpbHM7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuY29uZi5PcGVuSlBBQ29uZmln\ndXJhdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuT3Bl\nbkpQQVN0YXRlTWFuYWdlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5r\nZXJuZWwuU3RvcmVDb250ZXh0OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLmxpYi5jb25mLkNvbmZpZ3VyYXRpb25zOwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLmxpYi5sb2cuTG9nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLmxpYi51dGlsLkoyRG9Qcml2SGVscGVyOwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLmxpYi51dGlsLkphdmFWZXJzaW9uczsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5saWIudXRpbC5Mb2NhbGl6ZXI7CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEubGliLnV0aWwuT3B0aW9uczsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5saWIueG1sLkNvbW1lbnRhYmxlOwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLnV0aWwuRXhjZXB0aW9uczsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS51dGlsLkludGVybmFsRXhjZXB0aW9uOwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLnV0aWwuTWV0YURhdGFFeGNlcHRpb247CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5PcGVuSlBBRXhjZXB0aW9uOwpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuVW5zdXBwb3J0ZWRFeGNl\ncHRpb247CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5JbXBsSGVs\ncGVyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuVXNlckV4Y2Vw\ndGlvbjsKCmltcG9ydCBzZXJwLnV0aWwuU3RyaW5nczsKCi8qKgogKiBNZXRh\nZGF0YSBmb3IgYSBtYW5hZ2VkIGNsYXNzIGZpZWxkLgogKgogKiBAYXV0aG9y\nIEFiZSBXaGl0ZQogKi8KQFN1cHByZXNzV2FybmluZ3MoInNlcmlhbCIpCnB1\nYmxpYyBjbGFzcyBGaWVsZE1ldGFEYXRhCiAgICBleHRlbmRzIEV4dGVuc2lv\nbnMKICAgIGltcGxlbWVudHMgVmFsdWVNZXRhRGF0YSwgTWV0YURhdGFDb250\nZXh0LCBNZXRhRGF0YU1vZGVzLCBDb21tZW50YWJsZSB7CiAgICAKICAgIC8q\nKgogICAgICogQ29uc3RhbnQgc3BlY2lmeWluZyB0aGF0IG5vIG51bGwtdmFs\ndWUgd2FzIGdpdmVuLgogICAgICovCiAgICBwdWJsaWMgc3RhdGljIGZpbmFs\nIGludCBOVUxMX1VOU0VUID0gLTE7CgogICAgLyoqCiAgICAgKiBDb25zdGFu\ndCBzcGVjaWZ5aW5nIHRvIHVzZSBhIGRhdGFzdG9yZSBudWxsIHRvIHBlcnNp\nc3QgbnVsbCB2YWx1ZXMKICAgICAqIGluIG9iamVjdCBmaWVsZHMuCiAgICAg\nKi8KICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgaW50IE5VTExfTk9ORSA9IDA7\nCgogICAgLyoqCiAgICAgKiBDb25zdGFudCBzcGVjaWZ5aW5nIHRvIHVzZSBh\nIGRhdGFzdG9yZSBkZWZhdWx0IHZhbHVlIHRvIHBlcnNpc3QgbnVsbAogICAg\nICogdmFsdWVzIGluIG9iamVjdCBmaWVsZHMuCiAgICAgKi8KICAgIHB1Ymxp\nYyBzdGF0aWMgZmluYWwgaW50IE5VTExfREVGQVVMVCA9IDE7CgogICAgLyoq\nCiAgICAgKiBDb25zdGFudCBzcGVjaWZ5aW5nIHRvIHRocm93IGFuIGV4Y2Vw\ndGlvbiB3aGVuIGF0dGVtcHRpbmcgdG8gcGVyc2lzdAogICAgICogbnVsbCB2\nYWx1ZXMgaW4gb2JqZWN0IGZpZWxkcy4KICAgICAqLwogICAgcHVibGljIHN0\nYXRpYyBmaW5hbCBpbnQgTlVMTF9FWENFUFRJT04gPSAyOwoKICAgIC8qKgog\nICAgICogQ29uc3RhbnQgc3BlY2lmeWluZyB0aGUgbWFuYWdlbWVudCBsZXZl\nbCBvZiBhIGZpZWxkLgogICAgICovCiAgICBwdWJsaWMgc3RhdGljIGZpbmFs\nIGludCBNQU5BR0VfUEVSU0lTVEVOVCA9IDM7CgogICAgLyoqCiAgICAgKiBD\nb25zdGFudCBzcGVjaWZ5aW5nIHRoZSBtYW5hZ2VtZW50IGxldmVsIG9mIGEg\nZmllbGQuCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgaW50IE1B\nTkFHRV9UUkFOU0FDVElPTkFMID0gMTsKCiAgICAvKioKICAgICAqIENvbnN0\nYW50IHNwZWNpZnlpbmcgdGhlIG1hbmFnZW1lbnQgbGV2ZWwgb2YgYSBmaWVs\nZC4KICAgICAqLwogICAgcHVibGljIHN0YXRpYyBmaW5hbCBpbnQgTUFOQUdF\nX05PTkUgPSAwOwogICAgCiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIGludCBP\nTkVfVE9fT05FID0gMTsKICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgaW50IE9O\nRV9UT19NQU5ZID0gMjsKICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgaW50IE1B\nTllfVE9fT05FID0gMzsKICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgaW50IE1B\nTllfVE9fTUFOWSA9IDQ7CgogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgTG9j\nYWxpemVyIF9sb2MgPSBMb2NhbGl6ZXIuZm9yUGFja2FnZQogICAgICAgIChG\naWVsZE1ldGFEYXRhLmNsYXNzKTsKCiAgICBwcml2YXRlIHN0YXRpYyBmaW5h\nbCBpbnQgREZHX0ZBTFNFID0gMTsKICAgIHByaXZhdGUgc3RhdGljIGZpbmFs\nIGludCBERkdfVFJVRSA9IDI7CiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBp\nbnQgREZHX0VYUExJQ0lUID0gNDsKCiAgICBwcml2YXRlIHN0YXRpYyBmaW5h\nbCBNZXRob2QgREVGQVVMVF9NRVRIT0Q7CiAgICBzdGF0aWMgewogICAgICAg\nIHRyeSB7CiAgICAgICAgICAgIERFRkFVTFRfTUVUSE9EID0gT2JqZWN0LmNs\nYXNzLmdldE1ldGhvZCgid2FpdCIsIChDbGFzc1tdKSBudWxsKTsKICAgICAg\nICB9IGNhdGNoIChFeGNlcHRpb24gZSkgewogICAgICAgICAgICAvLyBzaG91\nbGRuJ3QgZXZlciBoYXBwZW4KICAgICAgICAgICAgdGhyb3cgbmV3IEludGVy\nbmFsRXhjZXB0aW9uKGUpOwogICAgICAgIH0KICAgIH0KCiAgICAvLyBuYW1l\nIGFuZCB0eXBlCiAgICBwcml2YXRlIGZpbmFsIFZhbHVlTWV0YURhdGEgX3Zh\nbDsKICAgIHByaXZhdGUgZmluYWwgVmFsdWVNZXRhRGF0YSBfa2V5OwogICAg\ncHJpdmF0ZSBmaW5hbCBWYWx1ZU1ldGFEYXRhIF9lbGVtOwogICAgcHJpdmF0\nZSBmaW5hbCBDbGFzc01ldGFEYXRhIF9vd25lcjsKICAgIHByaXZhdGUgZmlu\nYWwgU3RyaW5nIF9uYW1lOwogICAgcHJpdmF0ZSBDbGFzczw/PiBfZGVjID0g\nbnVsbDsKICAgIHByaXZhdGUgQ2xhc3NNZXRhRGF0YSBfZGVjTWV0YSA9IG51\nbGw7CiAgICBwcml2YXRlIFN0cmluZyBfZnVsbE5hbWUgPSBudWxsOwogICAg\ncHJpdmF0ZSBTdHJpbmcgX2VtYmVkRnVsbE5hbWUgPSBudWxsOwogICAgcHJp\ndmF0ZSBpbnQgX3Jlc01vZGUgPSBNT0RFX05PTkU7CiAgICBwcml2YXRlIFN0\ncmluZyBfbWFwcGVkQnlJZFZhbHVlID0gbnVsbDsKICAgIHByaXZhdGUgaW50\nIF9hY2Nlc3MgPSBBY2Nlc3NDb2RlLlVOS05PV047CgogICAgLy8gbG9hZC9z\ndG9yZSBpbmZvCiAgICBwcml2YXRlIFN0cmluZ1tdIF9jb21tZW50cyA9IG51\nbGw7CiAgICBwcml2YXRlIGludCBfbGlzdEluZGV4ID0gLTE7CgogICAgLy8v\nLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v\nLy8vLy8vLy8vLy8vLy8vLy8vLy8KICAgIC8vIE5vdGU6IGlmIHlvdSBhZGQg\nYWRkaXRpb25hbCBzdGF0ZSwgbWFrZSBzdXJlIHRvIGFkZCBpdCB0byBjb3B5\nKCkKICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v\nLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCgogICAgLy8gbWlzYyBp\nbmZvCiAgICBwcml2YXRlIENsYXNzPD8+IF9wcm94eUNsYXNzID0gbnVsbDsK\nICAgIHByaXZhdGUgT2JqZWN0IF9pbml0aWFsaXplciA9IG51bGw7CiAgICBw\ncml2YXRlIGJvb2xlYW4gX3RyYW5zaWVudCA9IGZhbHNlOwogICAgcHJpdmF0\nZSBib29sZWFuIF9wcmltS2V5ID0gZmFsc2U7CiAgICBwcml2YXRlIEJvb2xl\nYW4gX3ZlcnNpb24gPSBudWxsOwogICAgcHJpdmF0ZSBpbnQgX251bGxWYWx1\nZSA9IE5VTExfVU5TRVQ7CiAgICBwcml2YXRlIGludCBfbWFuYWdlID0gTUFO\nQUdFX1BFUlNJU1RFTlQ7CiAgICBwcml2YXRlIGludCBfaW5kZXggPSAtMTsK\nICAgIHByaXZhdGUgaW50IF9kZWNJbmRleCA9IC0xOwogICAgcHJpdmF0ZSBp\nbnQgX3BrSW5kZXggPSAtMTsKICAgIHByaXZhdGUgYm9vbGVhbiBfZXhwbGlj\naXQgPSBmYWxzZTsKICAgIHByaXZhdGUgaW50IF9kZmcgPSAwOwogICAgcHJp\ndmF0ZSBTZXQ8U3RyaW5nPiBfZmdTZXQgPSBudWxsOwogICAgcHJpdmF0ZSBT\ndHJpbmdbXSBfZmdzID0gbnVsbDsKICAgIHByaXZhdGUgU3RyaW5nICAgX2xm\nZyA9IG51bGw7CiAgICBwcml2YXRlIEJvb2xlYW4gX2xycyA9IG51bGw7CiAg\nICBwcml2YXRlIEJvb2xlYW4gX3N0cmVhbSA9IG51bGw7CiAgICBwcml2YXRl\nIFN0cmluZyBfZXh0TmFtZSA9IG51bGw7CiAgICBwcml2YXRlIFN0cmluZyBf\nZmFjdE5hbWUgPSBudWxsOwogICAgcHJpdmF0ZSBTdHJpbmcgX2V4dFN0cmlu\nZyA9IG51bGw7CiAgICBwcml2YXRlIE1hcCBfZXh0VmFsdWVzID0gQ29sbGVj\ndGlvbnMuRU1QVFlfTUFQOwogICAgcHJpdmF0ZSBNYXAgX2ZpZWxkVmFsdWVz\nID0gQ29sbGVjdGlvbnMuRU1QVFlfTUFQOwogICAgcHJpdmF0ZSBCb29sZWFu\nIF9lbnVtRmllbGQgPSBudWxsOwogICAgcHJpdmF0ZSBCb29sZWFuIF9sb2JG\naWVsZCA9IG51bGw7CiAgICBwcml2YXRlIEJvb2xlYW4gX3NlcmlhbGl6YWJs\nZUZpZWxkID0gbnVsbDsKICAgIHByaXZhdGUgYm9vbGVhbiBfZ2VuZXJhdGVk\nID0gZmFsc2U7CgogICAgLy8gTWVtYmVycyBhcmVuJ3Qgc2VyaWFsaXphYmxl\nLiBVc2UgYSBwcm94eSB0aGF0IGNhbiBwcm92aWRlIGEgTWVtYmVyCiAgICAv\nLyB0byBhdm9pZCB3cml0aW5nIHRoZSBmdWxsIEV4dGVybmFsaXphYmxlIGlt\ncGxlbWVudGF0aW9uLgogICAgcHJpdmF0ZSBNZW1iZXJQcm92aWRlciBfYmFj\na2luZ01lbWJlciA9IG51bGw7CgogICAgLy8gTWVtYmVycyBhcmVuJ3Qgc2Vy\naWFsaXphYmxlLiBJbml0aWFsaXppbmcgX2V4dE1ldGhvZCBhbmQgX2ZhY3RN\nZXRob2QgdG8KICAgIC8vIERFRkFVTFRfTUVUSE9EIGlzIHN1ZmZpY2llbnQg\ndG8gdHJpZ2dlciBsYXp5IHBvcHVsYXRpb24gb2YgdGhlc2UgZmllbGRzLgog\nICAgcHJpdmF0ZSB0cmFuc2llbnQgTWV0aG9kIF9leHRNZXRob2QgPSBERUZB\nVUxUX01FVEhPRDsKICAgIHByaXZhdGUgdHJhbnNpZW50IE1lbWJlciBfZmFj\ndE1ldGhvZCA9IERFRkFVTFRfTUVUSE9EOwoKICAgIC8vIGludGVybWVkaWF0\nZSBhbmQgaW1wbCBkYXRhCiAgICBwcml2YXRlIGJvb2xlYW4gX2ludGVybWVk\naWF0ZSA9IHRydWU7CiAgICBwcml2YXRlIEJvb2xlYW4gX2ltcGxEYXRhID0g\nQm9vbGVhbi5UUlVFOwoKICAgIC8vIHZhbHVlIGdlbmVyYXRpb24KICAgIHBy\naXZhdGUgaW50IF92YWxTdHJhdGVneSA9IC0xOwogICAgcHJpdmF0ZSBpbnQg\nX3VwU3RyYXRlZ3kgPSAtMTsKICAgIHByaXZhdGUgU3RyaW5nIF9zZXFOYW1l\nID0gQ2xhc3NNZXRhRGF0YS5ERUZBVUxUX1NUUklORzsKICAgIHByaXZhdGUg\nU2VxdWVuY2VNZXRhRGF0YSBfc2VxTWV0YSA9IG51bGw7CgogICAgLy8gaW52\nZXJzZXMKICAgIHByaXZhdGUgU3RyaW5nIF9tYXBwZWRCeSA9IG51bGw7CiAg\nICBwcml2YXRlIEZpZWxkTWV0YURhdGEgX21hcHBlZEJ5TWV0YSA9IG51bGw7\nCiAgICBwcml2YXRlIEZpZWxkTWV0YURhdGFbXSBfaW52ZXJzZXMgPSBudWxs\nOwogICAgcHJpdmF0ZSBTdHJpbmcgX2ludmVyc2UgPSBDbGFzc01ldGFEYXRh\nLkRFRkFVTFRfU1RSSU5HOwoKICAgIC8vIG9yZGVyaW5nIG9uIGxvYWQKICAg\nIHByaXZhdGUgT3JkZXJbXSBfb3JkZXJzID0gbnVsbDsKICAgIHByaXZhdGUg\nU3RyaW5nIF9vcmRlckRlYyA9IG51bGw7CiAgICAvLyBpbmRpY2F0ZSBpZiB0\naGlzIGZpZWxkIGlzIHVzZWQgYnkgb3RoZXIgZmllbGQgYXMgIm9yZGVyIGJ5\nIiB2YWx1ZSAKICAgIHByaXZhdGUgYm9vbGVhbiBfdXNlZEluT3JkZXJCeSA9\nIGZhbHNlOwogICAgcHJpdmF0ZSBib29sZWFuIF9pc0VsZW1lbnRDb2xsZWN0\naW9uID0gZmFsc2U7CiAgICBwcml2YXRlIGludCBfYXNzb2NpYXRpb25UeXBl\nOwoKICAgIC8qKgogICAgICogQ29uc3RydWN0b3IuCiAgICAgKgogICAgICog\nQHBhcmFtIG5hbWUgdGhlIGZpZWxkIG5hbWUKICAgICAqIEBwYXJhbSB0eXBl\nIHRoZSBmaWVsZCB0eXBlCiAgICAgKiBAcGFyYW0gb3duZXIgdGhlIG93bmlu\nZyBjbGFzcyBtZXRhZGF0YQogICAgICovCiAgICBwcm90ZWN0ZWQgRmllbGRN\nZXRhRGF0YShTdHJpbmcgbmFtZSwgQ2xhc3M8Pz4gdHlwZSwgQ2xhc3NNZXRh\nRGF0YSBvd25lcikgewogICAgICAgIF9uYW1lID0gbmFtZTsKICAgICAgICBf\nb3duZXIgPSBvd25lcjsKICAgICAgICBfZGVjID0gbnVsbDsKICAgICAgICBf\nZGVjTWV0YSA9IG51bGw7CiAgICAgICAgX3ZhbCA9IG93bmVyLmdldFJlcG9z\naXRvcnkoKS5uZXdWYWx1ZU1ldGFEYXRhKHRoaXMpOwogICAgICAgIF9rZXkg\nPSBvd25lci5nZXRSZXBvc2l0b3J5KCkubmV3VmFsdWVNZXRhRGF0YSh0aGlz\nKTsKICAgICAgICBfZWxlbSA9IG93bmVyLmdldFJlcG9zaXRvcnkoKS5uZXdW\nYWx1ZU1ldGFEYXRhKHRoaXMpOwoKICAgICAgICBzZXREZWNsYXJlZFR5cGUo\ndHlwZSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBTdXBwbHkgdGhlIGJhY2tp\nbmcgbWVtYmVyIG9iamVjdDsgdGhpcyBhbGxvd3MgdXMgdG8gdXRpbGl6ZQog\nICAgICogcGFyYW1ldGVyaXplZCB0eXBlIGluZm9ybWF0aW9uIGlmIGF2YWls\nYWJsZS4KICAgICAqIFNldHMgdGhlIGFjY2VzcyBzdHlsZSBvZiB0aGlzIHJl\nY2VpdmVyIGJhc2VkIG9uIHdoZXRoZXIgdGhlIGdpdmVuIAogICAgICogbWVt\nYmVyIHJlcHJlc2VudHMgYSBmaWVsZCBvciBnZXR0ZXIgbWV0aG9kLgogICAg\nICovCiAgICBwdWJsaWMgdm9pZCBiYWNraW5nTWVtYmVyKE1lbWJlciBtZW1i\nZXIpIHsKICAgICAgICBpZiAobWVtYmVyID09IG51bGwpCiAgICAgICAgICAg\nIHJldHVybjsKICAgICAgICBpZiAoTW9kaWZpZXIuaXNUcmFuc2llbnQobWVt\nYmVyLmdldE1vZGlmaWVycygpKSkKICAgICAgICAgICAgX3RyYW5zaWVudCA9\nIHRydWU7CgogICAgICAgIF9iYWNraW5nTWVtYmVyID0gbmV3IE1lbWJlclBy\nb3ZpZGVyKG1lbWJlcik7CgogICAgICAgIENsYXNzPD8+IHR5cGU7CiAgICAg\nICAgQ2xhc3M8Pz5bXSB0eXBlczsKICAgICAgICBpZiAobWVtYmVyIGluc3Rh\nbmNlb2YgRmllbGQpIHsKICAgICAgICAgICAgRmllbGQgZiA9IChGaWVsZCkg\nbWVtYmVyOwogICAgICAgICAgICB0eXBlID0gZi5nZXRUeXBlKCk7CiAgICAg\nICAgICAgIHR5cGVzID0gSmF2YVZlcnNpb25zLmdldFBhcmFtZXRlcml6ZWRU\neXBlcyhmKTsKICAgICAgICAgICAgc2V0QWNjZXNzVHlwZShBY2Nlc3NDb2Rl\nLkZJRUxEKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBNZXRob2Qg\nbWV0aCA9IChNZXRob2QpIG1lbWJlcjsKICAgICAgICAgICAgdHlwZSA9IG1l\ndGguZ2V0UmV0dXJuVHlwZSgpOwogICAgICAgICAgICB0eXBlcyA9IEphdmFW\nZXJzaW9ucy5nZXRQYXJhbWV0ZXJpemVkVHlwZXMobWV0aCk7CiAgICAgICAg\nICAgIHNldEFjY2Vzc1R5cGUoQWNjZXNzQ29kZS5QUk9QRVJUWSk7CiAgICAg\nICAgfQoKICAgICAgICBzZXREZWNsYXJlZFR5cGUodHlwZSk7CiAgICAgICAg\naWYgKENvbGxlY3Rpb24uY2xhc3MuaXNBc3NpZ25hYmxlRnJvbSh0eXBlKQog\nICAgICAgICAgICAmJiBfZWxlbS5nZXREZWNsYXJlZFR5cGUoKSA9PSBPYmpl\nY3QuY2xhc3MKICAgICAgICAgICAgJiYgdHlwZXMubGVuZ3RoID09IDEpIHsK\nICAgICAgICAgICAgX2VsZW0uc2V0RGVjbGFyZWRUeXBlKHR5cGVzWzBdKTsK\nICAgICAgICB9IGVsc2UgaWYgKE1hcC5jbGFzcy5pc0Fzc2lnbmFibGVGcm9t\nKHR5cGUpCiAgICAgICAgICAgICYmIHR5cGVzLmxlbmd0aCA9PSAyKSB7CiAg\nICAgICAgICAgIGlmIChfa2V5LmdldERlY2xhcmVkVHlwZSgpID09IE9iamVj\ndC5jbGFzcykKICAgICAgICAgICAgICAgIF9rZXkuc2V0RGVjbGFyZWRUeXBl\nKHR5cGVzWzBdKTsKICAgICAgICAgICAgaWYgKF9lbGVtLmdldERlY2xhcmVk\nVHlwZSgpID09IE9iamVjdC5jbGFzcykKICAgICAgICAgICAgICAgIF9lbGVt\nLnNldERlY2xhcmVkVHlwZSh0eXBlc1sxXSk7CiAgICAgICAgfQogICAgfQoK\nICAgIC8qKgogICAgICogUmV0dXJuIHRoZSBiYWNraW5nIG1lbWJlciBzdXBw\nbGllZCBpbiB7QGxpbmsgI2JhY2tpbmdNZW1iZXJ9LgogICAgICovCiAgICBw\ndWJsaWMgTWVtYmVyIGdldEJhY2tpbmdNZW1iZXIoKSB7CiAgICAgICAgcmV0\ndXJuIChfYmFja2luZ01lbWJlciA9PSBudWxsKSA/IG51bGwgOiBfYmFja2lu\nZ01lbWJlci5nZXRNZW1iZXIoKTsKICAgIH0KCiAgICAvKioKICAgICAqIFRo\nZSBtZXRhZGF0YSByZXBvc2l0b3J5LgogICAgICovCiAgICBwdWJsaWMgTWV0\nYURhdGFSZXBvc2l0b3J5IGdldFJlcG9zaXRvcnkoKSB7CiAgICAgICAgcmV0\ndXJuIF9vd25lci5nZXRSZXBvc2l0b3J5KCk7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBUaGUgY2xhc3MgdGhhdCBkZWZpbmVzIHRoZSBtZXRhZGF0YSBmb3Ig\ndGhpcyBmaWVsZC4KICAgICAqLwogICAgcHVibGljIENsYXNzTWV0YURhdGEg\nZ2V0RGVmaW5pbmdNZXRhRGF0YSgpIHsKICAgICAgICByZXR1cm4gX293bmVy\nOwogICAgfQoKICAgIC8qKgogICAgICogVGhlIGRlY2xhcmluZyBjbGFzcy4K\nICAgICAqLwogICAgcHVibGljIENsYXNzIGdldERlY2xhcmluZ1R5cGUoKSB7\nCiAgICAgICAgcmV0dXJuIChfZGVjID09IG51bGwpID8gX293bmVyLmdldERl\nc2NyaWJlZFR5cGUoKSA6IF9kZWM7CiAgICB9CgogICAgLyoqCiAgICAgKiBU\naGUgZGVjbGFyaW5nIGNsYXNzLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBz\nZXREZWNsYXJpbmdUeXBlKENsYXNzPD8+IGNscykgewogICAgICAgIF9kZWMg\nPSBjbHM7CiAgICAgICAgX2RlY01ldGEgPSBudWxsOwogICAgICAgIF9mdWxs\nTmFtZSA9IG51bGw7CiAgICAgICAgX2VtYmVkRnVsbE5hbWUgPSBudWxsOwog\nICAgfQoKICAgIC8qKgogICAgICogVGhlIGRlY2xhcmluZyBjbGFzcy4KICAg\nICAqLwogICAgcHVibGljIENsYXNzTWV0YURhdGEgZ2V0RGVjbGFyaW5nTWV0\nYURhdGEoKSB7CiAgICAgICAgaWYgKF9kZWMgPT0gbnVsbCkKICAgICAgICAg\nICAgcmV0dXJuIF9vd25lcjsKICAgICAgICBpZiAoX2RlY01ldGEgPT0gbnVs\nbCkKICAgICAgICAgICAgX2RlY01ldGEgPSBnZXRSZXBvc2l0b3J5KCkuZ2V0\nTWV0YURhdGEoX2RlYywKICAgICAgICAgICAgICAgIF9vd25lci5nZXRFbnZD\nbGFzc0xvYWRlcigpLCB0cnVlKTsKICAgICAgICByZXR1cm4gX2RlY01ldGE7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBUaGUgZmllbGQgbmFtZS4KICAgICAq\nLwogICAgcHVibGljIFN0cmluZyBnZXROYW1lKCkgewogICAgICAgIHJldHVy\nbiBfbmFtZTsKICAgIH0KCiAgICAvKioKICAgICAqIFRoZSBmaWVsZCBuYW1l\nLCBxdWFsaWZpZWQgYnkgdGhlIG93bmluZyBjbGFzcy4KICAgICAqIEBkZXBy\nZWNhdGVkIFVzZSBnZXRGdWxsTmFtZShib29sZWFuKSBpbnN0ZWFkLgogICAg\nICovCiAgICBwdWJsaWMgU3RyaW5nIGdldEZ1bGxOYW1lKCkgewogICAgICAg\nIHJldHVybiBnZXRGdWxsTmFtZShmYWxzZSk7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBUaGUgZmllbGQgbmFtZSwgcXVhbGlmaWVkIGJ5IHRoZSBvd25pbmcg\nY2xhc3MgYW5kIG9wdGlvbmFsbHkgdGhlCiAgICAgKiBlbWJlZGRpbmcgb3du\nZXIncyBuYW1lIChpZiBhbnkpLgogICAgICovCiAgICBwdWJsaWMgU3RyaW5n\nIGdldEZ1bGxOYW1lKGJvb2xlYW4gZW1iZWRPd25lcikgewogICAgICAgIGlm\nIChfZnVsbE5hbWUgPT0gbnVsbCkKICAgICAgICAgICAgX2Z1bGxOYW1lID0g\nZ2V0RGVjbGFyaW5nVHlwZSgpLmdldE5hbWUoKSArICIuIiArIF9uYW1lOwog\nICAgICAgIGlmIChlbWJlZE93bmVyICYmIF9lbWJlZEZ1bGxOYW1lID09IG51\nbGwpIHsKICAgICAgICAgICAgaWYgKF9vd25lci5nZXRFbWJlZGRpbmdNZXRh\nRGF0YSgpID09IG51bGwpCiAgICAgICAgICAgICAgICBfZW1iZWRGdWxsTmFt\nZSA9IF9mdWxsTmFtZTsKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAg\nICAgX2VtYmVkRnVsbE5hbWUgPSBfb3duZXIuZ2V0RW1iZWRkaW5nTWV0YURh\ndGEoKS4KICAgICAgICAgICAgICAgICAgICBnZXRGaWVsZE1ldGFEYXRhKCku\nZ2V0RnVsbE5hbWUodHJ1ZSkgKyAiLiIgKyBfZnVsbE5hbWU7CiAgICAgICAg\nfQogICAgICAgIHJldHVybiAoZW1iZWRPd25lcikgPyBfZW1iZWRGdWxsTmFt\nZSA6IF9mdWxsTmFtZTsKICAgIH0KCiAgICAvKioKICAgICAqIFRoZSBmaWVs\nZCBuYW1lLCBxdWFsaWZpZWQgYnkgdGhlIGRlZmluaW5nIGNsYXNzLgogICAg\nICovCiAgICBwdWJsaWMgU3RyaW5nIGdldFJlYWxOYW1lKCkgewogICAgCS8v\nIEFkZGVkIHRvIHN1cHBvcnQgT1BFTkpQQS03MDQKICAgICAgICByZXR1cm4g\nZ2V0RGVmaW5pbmdNZXRhRGF0YSgpLmdldERlc2NyaWJlZFR5cGUoKS5nZXRO\nYW1lKCkgKyAiLiIgKyBfbmFtZTsKICAgIH0KCiAgICAvKioKICAgICAqIE1l\ndGFEYXRhIGFib3V0IHRoZSBmaWVsZCB2YWx1ZS4KICAgICAqLwogICAgcHVi\nbGljIFZhbHVlTWV0YURhdGEgZ2V0VmFsdWUoKSB7CiAgICAgICAgcmV0dXJu\nIF92YWw7CiAgICB9CgogICAgLyoqCiAgICAgKiBNZXRhZGF0YSBhYm91dCB0\naGUga2V5IHZhbHVlLgogICAgICovCiAgICBwdWJsaWMgVmFsdWVNZXRhRGF0\nYSBnZXRLZXkoKSB7CiAgICAgICAgcmV0dXJuIF9rZXk7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBNZXRhZGF0YSBhYm91dCB0aGUgZWxlbWVudCB2YWx1ZS4K\nICAgICAqLwogICAgcHVibGljIFZhbHVlTWV0YURhdGEgZ2V0RWxlbWVudCgp\nIHsKICAgICAgICByZXR1cm4gX2VsZW07CiAgICB9CgogICAgLyoqCiAgICAg\nKiBSZXR1cm4gd2hldGhlciB0aGlzIGZpZWxkIGlzIG1hcHBlZCB0byB0aGUg\nZGF0YXN0b3JlLiBCeSBkZWZhdWx0LAogICAgICogcmV0dXJucyB0cnVlIGZv\nciBhbGwgcGVyc2lzdGVudCBmaWVsZHMgd2hvc2UgZGVmaW5pbmcgY2xhc3Mg\naXMgbWFwcGVkLgogICAgICovCiAgICBwdWJsaWMgYm9vbGVhbiBpc01hcHBl\nZCgpIHsKICAgICAgICByZXR1cm4gX21hbmFnZSA9PSBNQU5BR0VfUEVSU0lT\nVEVOVCAmJiBfb3duZXIuaXNNYXBwZWQoKTsKICAgIH0KCiAgICAvKioKICAg\nICAqIFRoZSB0eXBlIHRoaXMgZmllbGQgd2FzIGluaXRpYWxpemVkIHdpdGgs\nIGFuZCB0aGVyZWZvcmUgdGhlCiAgICAgKiB0eXBlIHRvIHVzZSBmb3IgcHJv\neGllcyB3aGVuIGxvYWRpbmcgZGF0YSBpbnRvIHRoaXMgZmllbGQuCiAgICAg\nKi8KICAgIHB1YmxpYyBDbGFzczw/PiBnZXRQcm94eVR5cGUoKSB7CiAgICAg\nICAgcmV0dXJuIChfcHJveHlDbGFzcyA9PSBudWxsKSA/IGdldERlY2xhcmVk\nVHlwZSgpIDogX3Byb3h5Q2xhc3M7CiAgICB9CgogICAgLyoqCiAgICAgKiBU\naGUgdHlwZSB0aGlzIGZpZWxkIHdhcyBpbml0aWFsaXplZCB3aXRoLCBhbmQg\ndGhlcmVmb3JlIHRoZQogICAgICogdHlwZSB0byB1c2UgZm9yIHByb3hpZXMg\nd2hlbiBsb2FkaW5nIGRhdGEgaW50byB0aGlzIGZpZWxkLgogICAgICovCiAg\nICBwdWJsaWMgdm9pZCBzZXRQcm94eVR5cGUoQ2xhc3M8Pz4gdHlwZSkgewog\nICAgICAgIF9wcm94eUNsYXNzID0gdHlwZTsKICAgIH0KCiAgICAvKioKICAg\nICAqIFRoZSBpbml0aWFsaXplciB1c2VkIGJ5IHRoZSBmaWVsZCwgb3IgbnVs\nbCBpZiBub25lLiBUaGlzCiAgICAgKiBpcyBhZGRpdGlvbmFsIGluZm9ybWF0\naW9uIGZvciBpbml0aWFsaXppbmcgdGhlIGZpZWxkLCBzdWNoIGFzCiAgICAg\nKiBhIGN1c3RvbSB7QGxpbmsgQ29tcGFyYXRvcn0gdXNlZCBieSBhIHtAbGlu\nayBTZXR9IG9yCiAgICAgKiBhIHtAbGluayBUaW1lWm9uZX0gdXNlZCBieSBh\nIHtAbGluayBDYWxlbmRhcn0uCiAgICAgKi8KICAgIHB1YmxpYyBPYmplY3Qg\nZ2V0SW5pdGlhbGl6ZXIoKSB7CiAgICAgICAgcmV0dXJuIF9pbml0aWFsaXpl\ncjsKICAgIH0KCiAgICAvKioKICAgICAqIFRoZSBpbml0aWFsaXplciB1c2Vk\nIGJ5IHRoZSBmaWVsZCwgb3IgbnVsbCBpZiBub25lLiBUaGlzCiAgICAgKiBp\ncyBhZGRpdGlvbmFsIGluZm9ybWF0aW9uIGZvciBpbml0aWFsaXppbmcgdGhl\nIGZpZWxkLCBzdWNoIGFzCiAgICAgKiBhIGN1c3RvbSB7QGxpbmsgQ29tcGFy\nYXRvcn0gdXNlZCBieSBhIHtAbGluayBTZXR9IG9yCiAgICAgKiBhIHtAbGlu\nayBUaW1lWm9uZX0gdXNlZCBieSBhIHtAbGluayBDYWxlbmRhcn0uCiAgICAg\nKi8KICAgIHB1YmxpYyB2b2lkIHNldEluaXRpYWxpemVyKE9iamVjdCBpbml0\naWFsaXplcikgewogICAgICAgIF9pbml0aWFsaXplciA9IGluaXRpYWxpemVy\nOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHdoZXRoZXIgdGhpcyBp\ncyBhIHRyYW5zaWVudCBmaWVsZC4KICAgICAqLwogICAgcHVibGljIGJvb2xl\nYW4gaXNUcmFuc2llbnQoKSB7CiAgICAgICAgcmV0dXJuIF90cmFuc2llbnQ7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gd2hldGhlciB0aGlzIGlz\nIGEgdHJhbnNpZW50IGZpZWxkLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBz\nZXRUcmFuc2llbnQoYm9vbGVhbiB0cmFucykgewogICAgICAgIF90cmFuc2ll\nbnQgPSB0cmFuczsKICAgIH0KCiAgICAvKioKICAgICAqIFRoZSBhYnNvbHV0\nZSBpbmRleCBvZiB0aGlzIHBlcnNpc3RlbnQvdHJhbnNhY3Rpb25hbCBmaWVs\nZC4KICAgICAqLwogICAgcHVibGljIGludCBnZXRJbmRleCgpIHsKICAgICAg\nICByZXR1cm4gX2luZGV4OwogICAgfQoKICAgIC8qKgogICAgICogVGhlIGFi\nc29sdXRlIGluZGV4IG9mIHRoaXMgcGVyc2lzdGVudC90cmFuc2FjdGlvbmFs\nIGZpZWxkLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRJbmRleChpbnQg\naW5kZXgpIHsKICAgICAgICBfaW5kZXggPSBpbmRleDsKICAgIH0KCiAgICAv\nKioKICAgICAqIFRoZSByZWxhdGl2ZSBpbmRleCBvZiB0aGlzIHBlcnNpc3Rl\nbnQvdHJhbnNhY3Rpb25hbCBmaWVsZC4KICAgICAqLwogICAgcHVibGljIGlu\ndCBnZXREZWNsYXJlZEluZGV4KCkgewogICAgICAgIHJldHVybiBfZGVjSW5k\nZXg7CiAgICB9CgogICAgLyoqCiAgICAgKiBUaGUgcmVsYXRpdmUgaW5kZXgg\nb2YgdGhpcyBwZXJzaXN0ZW50L3RyYW5zYWN0aW9uYWwgZmllbGQuCiAgICAg\nKi8KICAgIHB1YmxpYyB2b2lkIHNldERlY2xhcmVkSW5kZXgoaW50IGluZGV4\nKSB7CiAgICAgICAgX2RlY0luZGV4ID0gaW5kZXg7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBUaGUgaW5kZXggaW4gd2hpY2ggdGhpcyBmaWVsZCB3YXMgbGlz\ndGVkIGluIHRoZSBtZXRhZGF0YS4gRGVmYXVsdHMgdG8KICAgICAqIDxjb2Rl\nPi0xPC9jb2RlPiBpZiB0aGlzIGZpZWxkIHdhcyBub3QgbGlzdGVkIGluIHRo\nZSBtZXRhZGF0YS4KICAgICAqLwogICAgcHVibGljIGludCBnZXRMaXN0aW5n\nSW5kZXgoKSB7CiAgICAgICAgcmV0dXJuIF9saXN0SW5kZXg7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBUaGUgaW5kZXggaW4gd2hpY2ggdGhpcyBmaWVsZCB3\nYXMgbGlzdGVkIGluIHRoZSBtZXRhZGF0YS4gRGVmYXVsdHMgdG8KICAgICAq\nIDxjb2RlPi0xPC9jb2RlPiBpZiB0aGlzIGZpZWxkIHdhcyBub3QgbGlzdGVk\nIGluIHRoZSBtZXRhZGF0YS4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0\nTGlzdGluZ0luZGV4KGludCBpbmRleCkgewogICAgICAgIF9saXN0SW5kZXgg\nPSBpbmRleDsKICAgIH0KCiAgICAvKioKICAgICAqIFRoZSBhYnNvbHV0ZSBw\ncmltYXJ5IGtleSBpbmRleCBmb3IgdGhpcyBmaWVsZCwgb3IgLTEgaWYgbm90\nIGEgcHJpbWFyeQogICAgICoga2V5LiBUaGUgZmlyc3QgcHJpbWFyeSBrZXkg\nZmllbGQgaGFzIGluZGV4IDAsIHRoZSBzZWNvbmQgaW5kZXggMSwgZXRjLgog\nICAgICovCiAgICBwdWJsaWMgaW50IGdldFByaW1hcnlLZXlJbmRleCgpIHsK\nICAgICAgICByZXR1cm4gX3BrSW5kZXg7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBUaGUgYWJzb2x1dGUgcHJpbWFyeSBrZXkgaW5kZXggZm9yIHRoaXMgZmll\nbGQsIG9yIC0xIGlmIG5vdCBhIHByaW1hcnkKICAgICAqIGtleS4gVGhlIGZp\ncnN0IHByaW1hcnkga2V5IGZpZWxkIGhhcyBpbmRleCAwLCB0aGUgc2Vjb25k\nIGluZGV4IDEsIGV0Yy4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0UHJp\nbWFyeUtleUluZGV4KGludCBpbmRleCkgewogICAgICAgIF9wa0luZGV4ID0g\naW5kZXg7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIG1hbmFn\nZW1lbnQgbGV2ZWwgZm9yIHRoZSBmaWVsZC4gV2lsbCBiZSBvbmUgb2Y6CiAg\nICAgKiA8dWw+CiAgICAgKiA8bGk+e0BsaW5rICNNQU5BR0VfUEVSU0lTVEVO\nVH06IHRoZSBmaWVsZCBpcyBwZXJzaXN0ZW50PC9saT4KICAgICAqIDxsaT57\nQGxpbmsgI01BTkFHRV9UUkFOU0FDVElPTkFMfTogdGhlIGZpZWxkIGlzIHRy\nYW5zYWN0aW9uYWwgYnV0IG5vdAogICAgICogcGVyc2lzdGVudDwvbGk+CiAg\nICAgKiA8bGk+e0BsaW5rICNNQU5BR0VfTk9ORX06IHRoZSBmaWVsZCBpcyBu\nb3QgbWFuYWdlZDwvbGk+CiAgICAgKiA8L3VsPiBEZWZhdWx0cyB0byB7QGxp\nbmsgI01BTkFHRV9QRVJTSVNURU5UfS4KICAgICAqLwogICAgcHVibGljIGlu\ndCBnZXRNYW5hZ2VtZW50KCkgewogICAgICAgIHJldHVybiBfbWFuYWdlOwog\nICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRoZSBtYW5hZ2VtZW50IGxl\ndmVsIGZvciB0aGUgZmllbGQuIFdpbGwgYmUgb25lIG9mOgogICAgICogPHVs\nPgogICAgICogPGxpPntAbGluayAjTUFOQUdFX1BFUlNJU1RFTlR9OiB0aGUg\nZmllbGQgaXMgcGVyc2lzdGVudDwvbGk+CiAgICAgKiA8bGk+e0BsaW5rICNN\nQU5BR0VfVFJBTlNBQ1RJT05BTH06IHRoZSBmaWVsZCBpcyB0cmFuc2FjdGlv\nbmFsIGJ1dCBub3QKICAgICAqIHBlcnNpc3RlbnQ8L2xpPgogICAgICogPGxp\nPntAbGluayAjTUFOQUdFX05PTkV9OiB0aGUgZmllbGQgaXMgbm90IG1hbmFn\nZWQ8L2xpPgogICAgICogPC91bD4gCiAgICAgKiBEZWZhdWx0cyB0byB7QGxp\nbmsgI01BTkFHRV9QRVJTSVNURU5UfS4KICAgICAqLwogICAgcHVibGljIHZv\naWQgc2V0TWFuYWdlbWVudChpbnQgbWFuYWdlKSB7CiAgICAgICAgaWYgKChf\nbWFuYWdlID09IE1BTkFHRV9OT05FKSAhPSAobWFuYWdlID09IE1BTkFHRV9O\nT05FKSkKICAgICAgICAgICAgX293bmVyLmNsZWFyRmllbGRDYWNoZSgpOwog\nICAgICAgIF9tYW5hZ2UgPSBtYW5hZ2U7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBXaGV0aGVyIHRoaXMgaXMgYSBwcmltYXJ5IGtleSBmaWVsZC4KICAgICAq\nLwogICAgcHVibGljIGJvb2xlYW4gaXNQcmltYXJ5S2V5KCkgewogICAgICAg\nIHJldHVybiBfcHJpbUtleTsKICAgIH0KCiAgICAvKioKICAgICAqIFdoZXRo\nZXIgdGhpcyBpcyBhIHByaW1hcnkga2V5IGZpZWxkLgogICAgICovCiAgICBw\ndWJsaWMgdm9pZCBzZXRQcmltYXJ5S2V5KGJvb2xlYW4gcHJpbUtleSkgewog\nICAgICAgIF9wcmltS2V5ID0gcHJpbUtleTsKICAgIH0KCiAgICAvKioKICAg\nICAqIEZvciBhIHByaW1hcnkga2V5IGZpZWxkLCByZXR1cm4gdGhlIHR5cGUg\nb2YgdGhlIGNvcnJlc3BvbmRpbmcgb2JqZWN0IGlkIAogICAgICogY2xhc3Mg\nZmllbGQuCiAgICAgKi8KICAgIHB1YmxpYyBpbnQgZ2V0T2JqZWN0SWRGaWVs\nZFR5cGVDb2RlKCkgewogICAgICAgIENsYXNzTWV0YURhdGEgcmVsbWV0YSA9\nIGdldERlY2xhcmVkVHlwZU1ldGFEYXRhKCk7CiAgICAgICAgaWYgKHJlbG1l\ndGEgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIGdldERlY2xhcmVkVHlw\nZUNvZGUoKTsKICAgICAgICBpZiAocmVsbWV0YS5nZXRJZGVudGl0eVR5cGUo\nKSA9PSBDbGFzc01ldGFEYXRhLklEX0RBVEFTVE9SRSkgewogICAgICAgICAg\nICBib29sZWFuIHVud3JhcCA9IGdldFJlcG9zaXRvcnkoKS5nZXRNZXRhRGF0\nYUZhY3RvcnkoKS5nZXREZWZhdWx0cygpLgogICAgICAgICAgICAgICAgaXNE\nYXRhU3RvcmVPYmplY3RJZEZpZWxkVW53cmFwcGVkKCk7CiAgICAgICAgICAg\nIHJldHVybiAodW53cmFwKSA/IEphdmFUeXBlcy5MT05HIDogSmF2YVR5cGVz\nLk9CSkVDVDsKICAgICAgICB9CiAgICAgICAgaWYgKHJlbG1ldGEuaXNPcGVu\nSlBBSWRlbnRpdHkoKSkKICAgICAgICAgICAgcmV0dXJuIHJlbG1ldGEuZ2V0\nUHJpbWFyeUtleUZpZWxkcygpWzBdLmdldE9iamVjdElkRmllbGRUeXBlQ29k\nZSgpOwogICAgICAgIHJldHVybiBKYXZhVHlwZXMuT0JKRUNUOwogICAgfQoK\nICAgIC8qKgogICAgICogRm9yIGEgcHJpbWFyeSBrZXkgZmllbGQsIHJldHVy\nbiB0aGUgdHlwZSBvZiB0aGUgY29ycmVzcG9uZGluZyBvYmplY3QgaWQgCiAg\nICAgKiBjbGFzcyBmaWVsZC4KICAgICAqLwogICAgcHVibGljIENsYXNzPD8+\nIGdldE9iamVjdElkRmllbGRUeXBlKCkgewogICAgICAgIENsYXNzTWV0YURh\ndGEgcmVsbWV0YSA9IGdldERlY2xhcmVkVHlwZU1ldGFEYXRhKCk7CiAgICAg\nICAgaWYgKHJlbG1ldGEgPT0gbnVsbCB8fCBnZXRWYWx1ZSgpLmlzRW1iZWRk\nZWQoKSkKICAgICAgICAgICAgcmV0dXJuIGdldERlY2xhcmVkVHlwZSgpOwog\nICAgICAgIHN3aXRjaCAocmVsbWV0YS5nZXRJZGVudGl0eVR5cGUoKSkgewog\nICAgICAgICAgICBjYXNlIENsYXNzTWV0YURhdGEuSURfREFUQVNUT1JFOgog\nICAgICAgICAgICAgICAgYm9vbGVhbiB1bndyYXAgPSBnZXRSZXBvc2l0b3J5\nKCkuZ2V0TWV0YURhdGFGYWN0b3J5KCkuCiAgICAgICAgICAgICAgICAgICAg\nZ2V0RGVmYXVsdHMoKS5pc0RhdGFTdG9yZU9iamVjdElkRmllbGRVbndyYXBw\nZWQoKTsKICAgICAgICAgICAgICAgIHJldHVybiAodW53cmFwKSA/IGxvbmcu\nY2xhc3MgOiBPYmplY3QuY2xhc3M7CiAgICAgICAgICAgIGNhc2UgQ2xhc3NN\nZXRhRGF0YS5JRF9BUFBMSUNBVElPTjoKICAgICAgICAgICAgICAgIGlmIChy\nZWxtZXRhLmlzT3BlbkpQQUlkZW50aXR5KCkpCiAgICAgICAgICAgICAgICAg\nICAgcmV0dXJuIHJlbG1ldGEuZ2V0UHJpbWFyeUtleUZpZWxkcygpWzBdLgog\nICAgICAgICAgICAgICAgICAgICAgICBnZXRPYmplY3RJZEZpZWxkVHlwZSgp\nOwogICAgICAgICAgICAgICAgcmV0dXJuIChyZWxtZXRhLmdldE9iamVjdElk\nVHlwZSgpID09IG51bGwpID8gT2JqZWN0LmNsYXNzCiAgICAgICAgICAgICAg\nICAgICAgOiByZWxtZXRhLmdldE9iamVjdElkVHlwZSgpOwogICAgICAgICAg\nICBkZWZhdWx0OgogICAgICAgICAgICAgICAgcmV0dXJuIE9iamVjdC5jbGFz\nczsKICAgICAgICB9IAogICAgfQoKICAgIC8qKgogICAgICogV2hldGhlciB0\naGlzIGZpZWxkIGhvbGRzIG9wdGltaXN0aWMgdmVyc2lvbiBpbmZvcm1hdGlv\nbi4KICAgICAqLwogICAgcHVibGljIGJvb2xlYW4gaXNWZXJzaW9uKCkgewog\nICAgICAgIHJldHVybiBfdmVyc2lvbiA9PSBCb29sZWFuLlRSVUU7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBXaGV0aGVyIHRoaXMgZmllbGQgaG9sZHMgb3B0\naW1pc3RpYyB2ZXJzaW9uIGluZm9ybWF0aW9uLgogICAgICovCiAgICBwdWJs\naWMgdm9pZCBzZXRWZXJzaW9uKGJvb2xlYW4gdmVyc2lvbikgewogICAgICAg\nIF92ZXJzaW9uID0gKHZlcnNpb24pID8gQm9vbGVhbi5UUlVFIDogQm9vbGVh\nbi5GQUxTRTsKICAgIH0KCiAgICAvKioKICAgICAqIFdoZXRoZXIgdGhpcyBm\naWVsZCBpcyBpbiB0aGUgZGVmYXVsdCBmZXRjaCBncm91cC4KICAgICAqLwog\nICAgcHVibGljIGJvb2xlYW4gaXNJbkRlZmF1bHRGZXRjaEdyb3VwKCkgewog\nICAgICAgIGlmIChfZGZnID09IDApIHsKICAgICAgICAgICAgaWYgKF9tYW5h\nZ2UgIT0gTUFOQUdFX1BFUlNJU1RFTlQgfHwgaXNQcmltYXJ5S2V5KCkgfHwg\naXNWZXJzaW9uKCkpCiAgICAgICAgICAgICAgICBfZGZnID0gREZHX0ZBTFNF\nOwogICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgIC8vIGZpZWxk\nIGxlZnQgYXMgZGVmYXVsdDsgZGZnIHNldHRpbmcgZGVwZW5kcyBvbiB0eXBl\nCiAgICAgICAgICAgICAgICBzd2l0Y2ggKGdldFR5cGVDb2RlKCkpIHsKICAg\nICAgICAgICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5PQkpFQ1Q6CiAgICAg\nICAgICAgICAgICAgICAgICAgIGlmIChpc1NlcmlhbGl6YWJsZSgpIHx8IGlz\nRW51bSgpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgX2RmZyA9IERG\nR19UUlVFOwogICAgICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAg\nICAgICAgICAgICAgICAgICAgICBfZGZnID0gREZHX0ZBTFNFOwogICAgICAg\nICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICBj\nYXNlIEphdmFUeXBlcy5BUlJBWToKICAgICAgICAgICAgICAgICAgICAgICAg\naWYgKGlzTG9iQXJyYXkoKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAg\nIF9kZmcgPSBERkdfVFJVRTsKICAgICAgICAgICAgICAgICAgICAgICAgZWxz\nZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgX2RmZyA9IERGR19GQUxT\nRTsKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAg\nICAgICAgICAgY2FzZSBKYXZhVHlwZXMuQ09MTEVDVElPTjoKICAgICAgICAg\nICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5NQVA6CiAgICAgICAgICAgICAg\nICAgICAgY2FzZSBKYXZhVHlwZXMuUEM6CiAgICAgICAgICAgICAgICAgICAg\nY2FzZSBKYXZhVHlwZXMuUENfVU5UWVBFRDoKICAgICAgICAgICAgICAgICAg\nICAgICAgX2RmZyA9IERGR19GQUxTRTsKICAgICAgICAgICAgICAgICAgICAg\nICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDoKICAgICAg\nICAgICAgICAgICAgICAgICAgX2RmZyA9IERGR19UUlVFOwogICAgICAgICAg\nICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVy\nbiAoX2RmZyAmIERGR19UUlVFKSA+IDA7CiAgICB9CgogICAgcHJpdmF0ZSBi\nb29sZWFuIGlzRW51bSgpIHsKICAgICAgICBpZiAoX2VudW1GaWVsZCA9PSBu\ndWxsKSB7CiAgICAgICAgICAgIENsYXNzPD8+IGRlY2wgPSBnZXREZWNsYXJl\nZFR5cGUoKTsKICAgICAgICAgICAgX2VudW1GaWVsZCA9IEphdmFWZXJzaW9u\ncy5pc0VudW1lcmF0aW9uKGRlY2wpCiAgICAgICAgICAgICAgICA/IEJvb2xl\nYW4uVFJVRSA6IEJvb2xlYW4uRkFMU0U7CiAgICAgICAgfQogICAgICAgIHJl\ndHVybiBfZW51bUZpZWxkLmJvb2xlYW5WYWx1ZSgpOwogICAgfQoKICAgIHBy\naXZhdGUgYm9vbGVhbiBpc1NlcmlhbGl6YWJsZSgpIHsKICAgICAgICBpZiAo\nX3NlcmlhbGl6YWJsZUZpZWxkID09IG51bGwpIHsKICAgICAgICAgICAgQ2xh\nc3M8Pz4gZGVjbCA9IGdldERlY2xhcmVkVHlwZSgpOwogICAgICAgICAgICBp\nZiAoU2VyaWFsaXphYmxlLmNsYXNzLmlzQXNzaWduYWJsZUZyb20oZGVjbCkp\nCiAgICAgICAgICAgICAgICBfc2VyaWFsaXphYmxlRmllbGQgPSBCb29sZWFu\nLlRSVUU7CiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIF9zZXJp\nYWxpemFibGVGaWVsZCA9IEJvb2xlYW4uRkFMU0U7CiAgICAgICAgfQogICAg\nICAgIHJldHVybiBfc2VyaWFsaXphYmxlRmllbGQuYm9vbGVhblZhbHVlKCk7\nCiAgICB9CgogICAgcHJpdmF0ZSBib29sZWFuIGlzTG9iQXJyYXkoKSB7CiAg\nICAgICAgLy8gY2hlY2sgZm9yIGJ5dGVbXSwgQnl0ZVtdLCBjaGFyW10sIENo\nYXJhY3RlcltdCiAgICAgICAgaWYgKF9sb2JGaWVsZCA9PSBudWxsKSB7CiAg\nICAgICAgICAgIENsYXNzPD8+IGRlY2wgPSBnZXREZWNsYXJlZFR5cGUoKTsK\nICAgICAgICAgICAgaWYgKGRlY2wgPT0gYnl0ZVtdLmNsYXNzIHx8IGRlY2wg\nPT0gQnl0ZVtdLmNsYXNzIHx8CiAgICAgICAgICAgICAgICBkZWNsID09IGNo\nYXJbXS5jbGFzcyB8fCBkZWNsID09IENoYXJhY3RlcltdLmNsYXNzKQogICAg\nICAgICAgICAgICAgX2xvYkZpZWxkID0gQm9vbGVhbi5UUlVFOwogICAgICAg\nICAgICBlbHNlCiAgICAgICAgICAgICAgICBfbG9iRmllbGQgPSBCb29sZWFu\nLkZBTFNFOwogICAgICAgIH0KICAgICAgICByZXR1cm4gX2xvYkZpZWxkLmJv\nb2xlYW5WYWx1ZSgpOwogICAgfQoKICAgIC8qKgogICAgICogV2hldGhlciB0\naGlzIGZpZWxkIGlzIGluIHRoZSBkZWZhdWx0IGZldGNoIGdyb3VwLgogICAg\nICovCiAgICBwdWJsaWMgdm9pZCBzZXRJbkRlZmF1bHRGZXRjaEdyb3VwKGJv\nb2xlYW4gZGZnKSB7CiAgICAgICAgaWYgKGRmZykKICAgICAgICAgICAgX2Rm\nZyA9IERGR19UUlVFOwogICAgICAgIGVsc2UKICAgICAgICAgICAgX2RmZyA9\nIERGR19GQUxTRTsKICAgICAgICBfZGZnIHw9IERGR19FWFBMSUNJVDsKICAg\nIH0KCiAgICAvKioKICAgICAqIFdoZXRoZXIgdGhlIGRlZmF1bHQgZmV0Y2gg\nZ3JvdXAgc2V0dGluZyBpcyBleHBsaWNpdC4KICAgICAqLwogICAgcHVibGlj\nIGJvb2xlYW4gaXNEZWZhdWx0RmV0Y2hHcm91cEV4cGxpY2l0KCkgewogICAg\nICAgIHJldHVybiAoX2RmZyAmIERGR19FWFBMSUNJVCkgPiAwOwogICAgfQoK\nICAgIC8qKgogICAgICogV2hldGhlciB0aGUgZGVmYXVsdCBmZXRjaCBncm91\ncCBzZXR0aW5nIGlzIGV4cGxpY2l0LiBBbGxvdyBzZXR0aW5nCiAgICAgKiBm\nb3IgdGVzdGluZy4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0RGVmYXVs\ndEZldGNoR3JvdXBFeHBsaWNpdChib29sZWFuIGV4cGxpY2l0KSB7CiAgICAg\nICAgaWYgKGV4cGxpY2l0KQogICAgICAgICAgICBfZGZnIHw9IERGR19FWFBM\nSUNJVDsKICAgICAgICBlbHNlCiAgICAgICAgICAgIF9kZmcgJj0gfkRGR19F\nWFBMSUNJVDsKICAgIH0KCiAgICAvKioKICAgICAqIEdldHMgdGhlIG5hbWUg\nb2YgdGhlIGN1c3RvbSBmZXRjaCBncm91cHMgdGhvc2UgYXJlIGFzc29jaWF0\nZWQgdG8gdGhpcyAKICAgICAqIHJlY2VpdmVyLiAgVGhpcyBkb2VzIG5vdCBp\nbmNsdWRlIHRoZSAiZGVmYXVsdCIgYW5kICJhbGwiIGZldGNoIGdyb3Vwcy4K\nICAgICAqCiAgICAgKiBAcmV0dXJuIHRoZSBzZXQgb2YgZmV0Y2ggZ3JvdXAg\nbmFtZXMsIG5vdCBpbmNsdWRpbmcgdGhlIGRlZmF1bHQgYW5kCiAgICAgKiBh\nbGwgZmV0Y2ggZ3JvdXBzLgogICAgICovCiAgICBwdWJsaWMgU3RyaW5nW10g\nZ2V0Q3VzdG9tRmV0Y2hHcm91cHMoKSB7CiAgICAgICAgaWYgKF9mZ3MgPT0g\nbnVsbCkgewogICAgICAgICAgICBpZiAoX2ZnU2V0ID09IG51bGwgfHwgX21h\nbmFnZSAhPSBNQU5BR0VfUEVSU0lTVEVOVCAKICAgICAgICAgICAgICAgIHx8\nIGlzUHJpbWFyeUtleSgpIHx8IGlzVmVyc2lvbigpKQogICAgICAgICAgICAg\nICAgX2ZncyA9IG5ldyBTdHJpbmdbMF07CiAgICAgICAgICAgIGVsc2UKICAg\nICAgICAgICAgICAgIF9mZ3MgPSAoU3RyaW5nW10pIF9mZ1NldC50b0FycmF5\nKG5ldyBTdHJpbmdbX2ZnU2V0LnNpemUoKV0pOwogICAgICAgIH0KICAgICAg\nICByZXR1cm4gX2ZnczsKICAgIH0KCiAgICAvKioKICAgICAqIFRoZSBmZXRj\naCBncm91cCB0aGF0IGlzIHRvIGJlIGxvYWRlZCB3aGVuIHRoaXMgcmVjZWl2\nZXIgaXMgbG9hZGVkLCBvcgogICAgICogbnVsbCBpZiBub25lIHNldC4KICAg\nICAqLwogICAgcHVibGljIFN0cmluZyBnZXRMb2FkRmV0Y2hHcm91cCAoKSB7\nCiAgICAJcmV0dXJuIF9sZmc7CiAgICB9CiAgICAKICAgIC8qKgogICAgICog\nVGhlIGZldGNoIGdyb3VwIHRoYXQgaXMgdG8gYmUgbG9hZGVkIHdoZW4gdGhp\ncyByZWNlaXZlciBpcyBsb2FkZWQsIG9yCiAgICAgKiBudWxsIGlmIG5vbmUg\nc2V0LgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRMb2FkRmV0Y2hHcm91\ncCAoU3RyaW5nIGxmZykgewogICAgICAgIGlmICgiIi5lcXVhbHMobGZnKSkK\nICAgICAgICAgICAgbGZnID0gbnVsbDsKICAgIAlfbGZnID0gbGZnOwogICAg\nfQoKICAgIC8qKgogICAgICogV2hldGhlciB0aGlzIGZpZWxkIGlzIGluIHRo\nZSBnaXZlbiBmZXRjaCBncm91cC4KICAgICAqLwogICAgcHVibGljIGJvb2xl\nYW4gaXNJbkZldGNoR3JvdXAoU3RyaW5nIGZnKSB7CiAgICAgICAgaWYgKF9t\nYW5hZ2UgIT0gTUFOQUdFX1BFUlNJU1RFTlQgfHwgaXNQcmltYXJ5S2V5KCkg\nfHwgaXNWZXJzaW9uKCkpCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAg\nICAgICBpZiAoRmV0Y2hHcm91cC5OQU1FX0FMTC5lcXVhbHMoZmcpKQogICAg\nICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICBpZiAoRmV0Y2hHcm91cC5O\nQU1FX0RFRkFVTFQuZXF1YWxzKGZnKSkKICAgICAgICAgICAgcmV0dXJuIGlz\nSW5EZWZhdWx0RmV0Y2hHcm91cCgpOwogICAgICAgIHJldHVybiBfZmdTZXQg\nIT0gbnVsbCAmJiBfZmdTZXQuY29udGFpbnMoZmcpOwogICAgfQoKICAgIC8q\nKgogICAgICogU2V0IHdoZXRoZXIgdGhpcyBmaWVsZCBpcyBpbiB0aGUgZ2l2\nZW4gZmV0Y2ggZ3JvdXAuCiAgICAgKgogICAgICogQHBhcmFtIGZnIGlzIHRo\nZSBuYW1lIG9mIGEgZmV0Y2ggZ3JvdXAgdGhhdCBtdXN0IGJlIHByZXNlbnQg\naW4gdGhlCiAgICAgKiBjbGFzcyB0aGF0IGRlY2xhcmVkIHRoaXMgZmllbGQg\nb3IgYW55IG9mIGl0cyBwZXJzaXN0ZW50IHN1cGVyY2xhc3Nlcy4KICAgICAq\nLwogICAgcHVibGljIHZvaWQgc2V0SW5GZXRjaEdyb3VwKFN0cmluZyBmZywg\nYm9vbGVhbiBpbikgewogICAgICAgIGlmIChTdHJpbmdVdGlscy5pc0VtcHR5\nKGZnKSkKICAgICAgICAgICAgdGhyb3cgbmV3IE1ldGFEYXRhRXhjZXB0aW9u\nKF9sb2MuZ2V0KCJlbXB0eS1mZy1uYW1lIiwgdGhpcykpOwogICAgICAgIGlm\nIChmZy5lcXVhbHMoRmV0Y2hHcm91cC5OQU1FX0FMTCkpCiAgICAgICAgICAg\nIHJldHVybjsKICAgICAgICBpZiAoZmcuZXF1YWxzKEZldGNoR3JvdXAuTkFN\nRV9ERUZBVUxUKSkgewogICAgICAgICAgICBzZXRJbkRlZmF1bHRGZXRjaEdy\nb3VwKGluKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAg\nICBpZiAoX293bmVyLmdldEZldGNoR3JvdXAoZmcpID09IG51bGwpCiAgICAg\nICAgICAgIHRocm93IG5ldyBNZXRhRGF0YUV4Y2VwdGlvbihfbG9jLmdldCgi\ndW5rbm93bi1mZyIsIGZnLCB0aGlzKSk7CiAgICAgICAgaWYgKGluICYmIF9m\nZ1NldCA9PSBudWxsKQogICAgICAgICAgICBfZmdTZXQgPSBuZXcgSGFzaFNl\ndDxTdHJpbmc+KCk7CiAgICAgICAgaWYgKChpbiAmJiBfZmdTZXQuYWRkKGZn\nKSkKICAgICAgICAgICAgfHwgKCFpbiAmJiBfZmdTZXQgIT0gbnVsbCAmJiBf\nZmdTZXQucmVtb3ZlKGZnKSkpCiAgICAgICAgICAgIF9mZ3MgPSBudWxsOwog\nICAgfQogICAgCiAgICAvKioKICAgICAqIEhvdyB0aGUgZGF0YSBzdG9yZSBz\naG91bGQgdHJlYXQgbnVsbCB2YWx1ZXMgZm9yIHRoaXMgZmllbGQ6CiAgICAg\nKiA8dWw+CiAgICAgKiA8bGk+e0BsaW5rICNOVUxMX1VOU0VUfTogbm8gdmFs\ndWUgc3VwcGxpZWQ8L2xpPgogICAgICogPGxpPntAbGluayAjTlVMTF9OT05F\nfTogbGVhdmUgbnVsbCB2YWx1ZXMgYXMgbnVsbCBpbiB0aGUgZGF0YSBzdG9y\nZTwvbGk+CiAgICAgKiA8bGk+e0BsaW5rICNOVUxMX0VYQ0VQVElPTn06IHRo\ncm93IGFuIGV4Y2VwdGlvbiBpZiB0aGlzIGZpZWxkIGlzIG51bGwKICAgICAq\nIGF0IGNvbW1pdDwvbGk+CiAgICAgKiA8bGk+e0BsaW5rICNOVUxMX0RFRkFV\nTFR9OiB1c2UgdGhlIGRhdGFiYXNlIGRlZmF1bHQgaWYgdGhpcyBmaWVsZCBp\ncwogICAgICogbnVsbCBhdCBjb21taXQ8L2xpPgogICAgICogPC91bD4gRGVm\nYXVsdHMgdG8ge0BsaW5rICNOVUxMX1VOU0VUfS4KICAgICAqLwogICAgcHVi\nbGljIGludCBnZXROdWxsVmFsdWUoKSB7CiAgICAgICAgcmV0dXJuIF9udWxs\nVmFsdWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBIb3cgdGhlIGRhdGEgc3Rv\ncmUgc2hvdWxkIHRyZWF0IG51bGwgdmFsdWVzIGZvciB0aGlzIGZpZWxkOgog\nICAgICogPHVsPgogICAgICogPGxpPntAbGluayAjTlVMTF9VTlNFVH06IG5v\nIHZhbHVlIHN1cHBsaWVkPC9saT4KICAgICAqIDxsaT57QGxpbmsgI05VTExf\nTk9ORX06IGxlYXZlIG51bGwgdmFsdWVzIGFzIG51bGwgaW4gdGhlIGRhdGEg\nc3RvcmU8L2xpPgogICAgICogPGxpPntAbGluayAjTlVMTF9FWENFUFRJT059\nOiB0aHJvdyBhbiBleGNlcHRpb24gaWYgdGhpcyBmaWVsZCBpcyBudWxsCiAg\nICAgKiBhdCBjb21taXQ8L2xpPgogICAgICogPGxpPntAbGluayAjTlVMTF9E\nRUZBVUxUfTogdXNlIHRoZSBkYXRhYmFzZSBkZWZhdWx0IGlmIHRoaXMgZmll\nbGQgaXMKICAgICAqIG51bGwgYXQgY29tbWl0PC9saT4KICAgICAqIDwvdWw+\nIERlZmF1bHRzIHRvIHtAbGluayAjTlVMTF9VTlNFVH0uCiAgICAgKi8KICAg\nIHB1YmxpYyB2b2lkIHNldE51bGxWYWx1ZShpbnQgbnVsbFZhbHVlKSB7CiAg\nICAgICAgX251bGxWYWx1ZSA9IG51bGxWYWx1ZTsKICAgIH0KCiAgICAvKioK\nICAgICAqIFdoZXRoZXIgdGhpcyBmaWVsZCBpcyBleHBsaWNpdGx5IGRlY2xh\ncmVkIGluIHRoZSBtZXRhZGF0YS4KICAgICAqLwogICAgcHVibGljIGJvb2xl\nYW4gaXNFeHBsaWNpdCgpIHsKICAgICAgICByZXR1cm4gX2V4cGxpY2l0Owog\nICAgfQoKICAgIC8qKgogICAgICogV2hldGhlciB0aGlzIGZpZWxkIGlzIGV4\ncGxpY2l0bHkgZGVjbGFyZWQgaW4gdGhlIG1ldGFkYXRhLgogICAgICovCiAg\nICBwdWJsaWMgdm9pZCBzZXRFeHBsaWNpdChib29sZWFuIGV4cGxpY2l0KSB7\nCiAgICAgICAgX2V4cGxpY2l0ID0gZXhwbGljaXQ7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBUaGUgZmllbGQgdGhhdCB0aGlzIGZpZWxkIHNoYXJlcyBhIG1h\ncHBpbmcgd2l0aC4KICAgICAqLwogICAgcHVibGljIFN0cmluZyBnZXRNYXBw\nZWRCeSgpIHsKICAgICAgICByZXR1cm4gX21hcHBlZEJ5OwogICAgfQoKICAg\nIC8qKgogICAgICogVGhlIGZpZWxkIHRoYXQgdGhpcyBmaWVsZCBzaGFyZXMg\nYSBtYXBwaW5nIHdpdGguCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldE1h\ncHBlZEJ5KFN0cmluZyBtYXBwZWQpIHsKICAgICAgICBfbWFwcGVkQnkgPSBt\nYXBwZWQ7CiAgICAgICAgX21hcHBlZEJ5TWV0YSA9IG51bGw7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBUaGUgZmllbGQgdGhhdCB0aGlzIGZpZWxkIHNoYXJl\ncyBhIG1hcHBpbmcgd2l0aC4KICAgICAqLwogICAgcHVibGljIEZpZWxkTWV0\nYURhdGEgZ2V0TWFwcGVkQnlNZXRhRGF0YSgpIHsKICAgICAgICBpZiAoX21h\ncHBlZEJ5ICE9IG51bGwgJiYgX21hcHBlZEJ5TWV0YSA9PSBudWxsKSB7CiAg\nICAgICAgICAgIENsYXNzTWV0YURhdGEgbWV0YSA9IG51bGw7CiAgICAgICAg\nICAgIHN3aXRjaCAoZ2V0VHlwZUNvZGUoKSkgewogICAgICAgICAgICAgICAg\nY2FzZSBKYXZhVHlwZXMuUEM6CiAgICAgICAgICAgICAgICAgICAgbWV0YSA9\nIGdldFR5cGVNZXRhRGF0YSgpOwogICAgICAgICAgICAgICAgICAgIGJyZWFr\nOwogICAgICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuQVJSQVk6CiAgICAg\nICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5DT0xMRUNUSU9OOgogICAgICAg\nICAgICAgICAgY2FzZSBKYXZhVHlwZXMuTUFQOgogICAgICAgICAgICAgICAg\nICAgIG1ldGEgPSBfZWxlbS5nZXRUeXBlTWV0YURhdGEoKTsKICAgICAgICAg\nICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQoKICAgICAgICAgICAg\nRmllbGRNZXRhRGF0YSBmaWVsZCA9IChtZXRhID09IG51bGwpID8gbnVsbAog\nICAgICAgICAgICAgICAgOiBnZXRNYXBwZWRCeUZpZWxkKG1ldGEsIF9tYXBw\nZWRCeSk7CiAgICAgICAgICAgIGlmIChmaWVsZCA9PSBudWxsKQogICAgICAg\nICAgICAgICAgdGhyb3cgbmV3IE1ldGFEYXRhRXhjZXB0aW9uKF9sb2MuZ2V0\nKCJuby1tYXBwZWQtYnkiLCB0aGlzLAogICAgICAgICAgICAgICAgICAgIF9t\nYXBwZWRCeSkpOwogICAgICAgICAgICBpZiAoZmllbGQuZ2V0TWFwcGVkQnko\nKSAhPSBudWxsKQogICAgICAgICAgICAgICAgdGhyb3cgbmV3IE1ldGFEYXRh\nRXhjZXB0aW9uKF9sb2MuZ2V0KCJjaXJjLW1hcHBlZC1ieSIsIHRoaXMsCiAg\nICAgICAgICAgICAgICAgICAgX21hcHBlZEJ5KSk7CiAgICAgICAgICAgIE9w\nZW5KUEFDb25maWd1cmF0aW9uIGNvbmYgPSBnZXRSZXBvc2l0b3J5KCkuZ2V0\nQ29uZmlndXJhdGlvbigpOwogICAgICAgICAgICBib29sZWFuIGlzQWJzdHJh\nY3RNYXBwaW5nVW5pRGlyZWN0aW9uYWwgPSBnZXRSZXBvc2l0b3J5KCkuZ2V0\nTWV0YURhdGFGYWN0b3J5KCkuCiAgICAgICAgICAgICAgICAgICAgZ2V0RGVm\nYXVsdHMoKS5pc0Fic3RyYWN0TWFwcGluZ1VuaURpcmVjdGlvbmFsKGNvbmYp\nOwogICAgICAgICAgICBpZiAoaXNBYnN0cmFjdE1hcHBpbmdVbmlEaXJlY3Rp\nb25hbCkgewogICAgICAgICAgICAgICAgaWYgKGZpZWxkLmdldERlY2xhcmlu\nZ01ldGFEYXRhKCkuaXNBYnN0cmFjdCgpKQogICAgICAgICAgICAgICAgICAg\nIHRocm93IG5ldyBNZXRhRGF0YUV4Y2VwdGlvbihfbG9jLmdldCgibm8tbWFw\ncGVkLWJ5LWluLW1hcHBlZC1zdXBlciIsIGZpZWxkLAogICAgICAgICAgICAg\nICAgICAgICAgICAgICAgZmllbGQuZ2V0RGVjbGFyaW5nTWV0YURhdGEoKSkp\nOwoKICAgICAgICAgICAgICAgIGlmICh0aGlzLmdldERlY2xhcmluZ01ldGFE\nYXRhKCkuaXNBYnN0cmFjdCgpKQogICAgICAgICAgICAgICAgICAgIHRocm93\nIG5ldyBNZXRhRGF0YUV4Y2VwdGlvbihfbG9jLmdldCgibm8tbWFwcGVkLWJ5\nLWluLW1hcHBlZC1zdXBlciIsIHRoaXMsCiAgICAgICAgICAgICAgICAgICAg\nICAgICAgICB0aGlzLmdldERlY2xhcmluZ01ldGFEYXRhKCkpKTsKICAgICAg\nICAgICAgfQogICAgICAgICAgICBfbWFwcGVkQnlNZXRhID0gZmllbGQ7CiAg\nICAgICAgfQogICAgICAgIHJldHVybiBfbWFwcGVkQnlNZXRhOwogICAgfQoK\nICAgIHB1YmxpYyBGaWVsZE1ldGFEYXRhIGdldE1hcHBlZEJ5RmllbGQoQ2xh\nc3NNZXRhRGF0YSBtZXRhLCBTdHJpbmcgbWFwcGVkQnkpIHsKICAgICAgICBG\naWVsZE1ldGFEYXRhIGZpZWxkID0gbWV0YS5nZXRGaWVsZChtYXBwZWRCeSk7\nCiAgICAgICAgaWYgKGZpZWxkICE9IG51bGwpCiAgICAgICAgICAgIHJldHVy\nbiBmaWVsZDsKICAgICAgICBpbnQgZG90SWR4ID0gbWFwcGVkQnkuaW5kZXhP\nZigiLiIpOyAKICAgICAgICBpZiAoIGRvdElkeCA9PSAtMSkKICAgICAgICAg\nICAgcmV0dXJuIG51bGw7CiAgICAgICAgU3RyaW5nIGZpZWxkTmFtZSA9IG1h\ncHBlZEJ5LnN1YnN0cmluZygwLCBkb3RJZHgpOwogICAgICAgIEZpZWxkTWV0\nYURhdGEgZmllbGQxID0gbWV0YS5nZXRGaWVsZChmaWVsZE5hbWUpOwogICAg\nICAgIGlmIChmaWVsZDEgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIG51\nbGw7CiAgICAgICAgQ2xhc3NNZXRhRGF0YSBtZXRhMSA9IGZpZWxkMS5nZXRF\nbWJlZGRlZE1ldGFEYXRhKCk7CiAgICAgICAgaWYgKG1ldGExID09IG51bGwp\nCiAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgIFN0cmluZyBtYXBw\nZWRCeTEgPSBtYXBwZWRCeS5zdWJzdHJpbmcoZG90SWR4ICsgMSk7CiAgICAg\nICAgcmV0dXJuIGdldE1hcHBlZEJ5RmllbGQobWV0YTEsIG1hcHBlZEJ5MSk7\nCiAgICB9CiAgICAKICAgIAogICAgLyoqCiAgICAgKiBMb2dpY2FsIGludmVy\nc2UgZmllbGQuCiAgICAgKi8KICAgIHB1YmxpYyBTdHJpbmcgZ2V0SW52ZXJz\nZSgpIHsKICAgICAgICBpZiAoQ2xhc3NNZXRhRGF0YS5ERUZBVUxUX1NUUklO\nRy5lcXVhbHMoX2ludmVyc2UpKQogICAgICAgICAgICBfaW52ZXJzZSA9IG51\nbGw7CiAgICAgICAgcmV0dXJuIF9pbnZlcnNlOwogICAgfQoKICAgIC8qKgog\nICAgICogTG9naWNhbCBpbnZlcnNlIGZpZWxkLgogICAgICovCiAgICBwdWJs\naWMgdm9pZCBzZXRJbnZlcnNlKFN0cmluZyBpbnZlcnNlKSB7CiAgICAgICAg\nX2ludmVyc2VzID0gbnVsbDsKICAgICAgICBfaW52ZXJzZSA9IGludmVyc2U7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gYWxsIGludmVyc2VzIG9m\nIHRoaXMgZmllbGQuCiAgICAgKi8KICAgIHB1YmxpYyBGaWVsZE1ldGFEYXRh\nW10gZ2V0SW52ZXJzZU1ldGFEYXRhcygpIHsKICAgICAgICBpZiAoX2ludmVy\nc2VzID09IG51bGwpIHsKICAgICAgICAgICAgLy8gY2FuJ3QgZGVjbGFyZSBi\nb3RoIGFuIGludmVyc2Ugb3duZXIgYW5kIGEgbG9naWNhbCBpbnZlcnNlCiAg\nICAgICAgICAgIFN0cmluZyBpbnYgPSBnZXRJbnZlcnNlKCk7CiAgICAgICAg\nICAgIGlmIChfbWFwcGVkQnkgIT0gbnVsbCAmJiBpbnYgIT0gbnVsbCAmJiAh\nX21hcHBlZEJ5LmVxdWFscyhpbnYpKQogICAgICAgICAgICAgICAgdGhyb3cg\nbmV3IE1ldGFEYXRhRXhjZXB0aW9uKF9sb2MuZ2V0KCJtYXBwZWQtbm90LWlu\ndmVyc2UiLAogICAgICAgICAgICAgICAgICAgIHRoaXMpKTsKCiAgICAgICAg\nICAgIC8vIGdldCB0aGUgbWV0YWRhdGEgZm9yIHRoZSB0eXBlIG9uIHRoZSBv\ndGhlciBzaWRlIG9mIHRoaXMgcmVsYXRpb24KICAgICAgICAgICAgQ2xhc3NN\nZXRhRGF0YSBtZXRhID0gbnVsbDsKICAgICAgICAgICAgc3dpdGNoIChnZXRU\neXBlQ29kZSgpKSB7CiAgICAgICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5Q\nQzoKICAgICAgICAgICAgICAgICAgICBtZXRhID0gZ2V0VHlwZU1ldGFEYXRh\nKCk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAg\nICBjYXNlIEphdmFUeXBlcy5BUlJBWToKICAgICAgICAgICAgICAgIGNhc2Ug\nSmF2YVR5cGVzLkNPTExFQ1RJT046CiAgICAgICAgICAgICAgICBjYXNlIEph\ndmFUeXBlcy5NQVA6CiAgICAgICAgICAgICAgICAgICAgbWV0YSA9IF9lbGVt\nLmdldFR5cGVNZXRhRGF0YSgpOwogICAgICAgICAgICAgICAgICAgIGJyZWFr\nOwogICAgICAgICAgICB9CgogICAgICAgICAgICBDb2xsZWN0aW9uPEZpZWxk\nTWV0YURhdGE+IGludmVyc2VzID0gbnVsbDsKICAgICAgICAgICAgaWYgKG1l\ndGEgIT0gbnVsbCkgewogICAgICAgICAgICAgICAgLy8gYWRkIG1hcHBlZCBi\neSBhbmQgbmFtZWQgaW52ZXJzZSwgaWYgYW55CiAgICAgICAgICAgICAgICBG\naWVsZE1ldGFEYXRhIGZpZWxkID0gZ2V0TWFwcGVkQnlNZXRhRGF0YSgpOwog\nICAgICAgICAgICAgICAgaWYgKGZpZWxkICE9IG51bGwpIHsKICAgICAgICAg\nICAgICAgICAgICAvLyBtYXBwZWQgYnkgZmllbGQgaXNuJ3QgbmVjZXNzYXJp\nbHkgYSBwYyB0eXBlLCBidXQgYWxsCiAgICAgICAgICAgICAgICAgICAgLy8g\naW52ZXJzZXMgbXVzdCBiZQogICAgICAgICAgICAgICAgICAgIGlmIChmaWVs\nZC5nZXRUeXBlQ29kZSgpID09IEphdmFUeXBlcy5QQwogICAgICAgICAgICAg\nICAgICAgICAgICB8fCBmaWVsZC5nZXRFbGVtZW50KCkuZ2V0VHlwZUNvZGUo\nKSA9PSBKYXZhVHlwZXMuUEMpIHsKICAgICAgICAgICAgICAgICAgICAgICAg\naW52ZXJzZXMgPSBuZXcgQXJyYXlMaXN0PEZpZWxkTWV0YURhdGE+KDMpOwog\nICAgICAgICAgICAgICAgICAgICAgICBpbnZlcnNlcy5hZGQoZmllbGQpOwog\nICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0gZWxzZSBp\nZiAoaW52ICE9IG51bGwpIHsKICAgICAgICAgICAgICAgICAgICBmaWVsZCA9\nIG1ldGEuZ2V0RmllbGQoaW52KTsKICAgICAgICAgICAgICAgICAgICBpZiAo\nZmllbGQgPT0gbnVsbCkKICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cg\nbmV3IE1ldGFEYXRhRXhjZXB0aW9uKF9sb2MuZ2V0KCJuby1pbnZlcnNlIiwK\nICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMsIGludikpOwogICAg\nICAgICAgICAgICAgICAgIGludmVyc2VzID0gbmV3IEFycmF5TGlzdDxGaWVs\nZE1ldGFEYXRhPigzKTsKICAgICAgICAgICAgICAgICAgICBpbnZlcnNlcy5h\nZGQoZmllbGQpOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAg\nIC8vIHNjYW4gcmVsIHR5cGUgZm9yIGZpZWxkcyB0aGF0IG5hbWUgdGhpcyBm\naWVsZCBhcyBhbiBpbnZlcnNlCiAgICAgICAgICAgICAgICBGaWVsZE1ldGFE\nYXRhW10gZmllbGRzID0gbWV0YS5nZXRGaWVsZHMoKTsKICAgICAgICAgICAg\nICAgIENsYXNzPD8+IHR5cGUgPSBnZXREZWNsYXJpbmdNZXRhRGF0YSgpLmdl\ndERlc2NyaWJlZFR5cGUoKTsKICAgICAgICAgICAgICAgIGZvciAoaW50IGkg\nPSAwOyBpIDwgZmllbGRzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAg\nICAgICAgLy8gc2tpcCBmaWVsZHMgdGhhdCBhcmVuJ3QgY29tcGF0aWJsZSB3\naXRoIG91ciBvd25pbmcgY2xhc3MKICAgICAgICAgICAgICAgICAgICBzd2l0\nY2ggKGZpZWxkc1tpXS5nZXRUeXBlQ29kZSgpKSB7CiAgICAgICAgICAgICAg\nICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLlBDOgogICAgICAgICAgICAgICAg\nICAgICAgICAgICAgaWYgKCF0eXBlLmlzQXNzaWduYWJsZUZyb20oZmllbGRz\nW2ldLmdldFR5cGUoKSkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgY29udGludWU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVh\nazsKICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuQ09M\nTEVDVElPTjoKICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBKYXZhVHlw\nZXMuQVJSQVk6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXR5\ncGUuaXNBc3NpZ25hYmxlRnJvbShmaWVsZHNbaV0uCiAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgZ2V0RWxlbWVudCgpLmdldFR5cGUoKSkpCiAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7CiAgICAg\nICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAg\nICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAgICAgICAgICAgICAg\nIGNvbnRpbnVlOwogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAg\nICAgICAgICAgLy8gaWYgdGhlIGZpZWxkIGRlY2xhcmVzIHVzIGFzIGl0cyBp\nbnZlcnNlIGFuZCB3ZSBoYXZlbid0CiAgICAgICAgICAgICAgICAgICAgLy8g\nYWxyZWFkeSBhZGRlZCBpdCAod2UgbWlnaHQgaGF2ZSBpZiB3ZSBhbHNvIGRl\nY2xhcmVkIGl0CiAgICAgICAgICAgICAgICAgICAgLy8gYXMgb3VyIGludmVy\nc2UpLCBhZGQgaXQgbm93CiAgICAgICAgICAgICAgICAgICAgaWYgKF9uYW1l\nLmVxdWFscyhmaWVsZHNbaV0uZ2V0TWFwcGVkQnkoKSkKICAgICAgICAgICAg\nICAgICAgICAgICAgfHwgX25hbWUuZXF1YWxzKGZpZWxkc1tpXS5nZXRJbnZl\ncnNlKCkpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpbnZlcnNl\ncyA9PSBudWxsKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaW52ZXJz\nZXMgPSBuZXcgQXJyYXlMaXN0PEZpZWxkTWV0YURhdGE+KDMpOwogICAgICAg\nICAgICAgICAgICAgICAgICBpZiAoIWludmVyc2VzLmNvbnRhaW5zKGZpZWxk\nc1tpXSkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnZlcnNlcy5h\nZGQoZmllbGRzW2ldKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAg\nICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIE1ldGFEYXRh\nUmVwb3NpdG9yeSByZXBvcyA9IGdldFJlcG9zaXRvcnkoKTsKICAgICAgICAg\nICAgaWYgKGludmVyc2VzID09IG51bGwpCiAgICAgICAgICAgICAgICBfaW52\nZXJzZXMgPSByZXBvcy5FTVBUWV9GSUVMRFM7CiAgICAgICAgICAgIGVsc2UK\nICAgICAgICAgICAgICAgIF9pbnZlcnNlcyA9IGludmVyc2VzLnRvQXJyYXkK\nICAgICAgICAgICAgICAgICAgICAocmVwb3MubmV3RmllbGRNZXRhRGF0YUFy\ncmF5KGludmVyc2VzLnNpemUoKSkpOwogICAgICAgIH0KICAgICAgICByZXR1\ncm4gX2ludmVyc2VzOwogICAgfQoKICAgIC8qKgogICAgICogVGhlIHN0cmF0\nZWd5IHRvIHVzZSBmb3IgaW5zZXJ0IHZhbHVlIGdlbmVyYXRpb24uCiAgICAg\nKiBPbmUgb2YgdGhlIGNvbnN0YW50cyBmcm9tIHtAbGluayBWYWx1ZVN0cmF0\nZWdpZXN9LgogICAgICovCiAgICBwdWJsaWMgaW50IGdldFZhbHVlU3RyYXRl\nZ3koKSB7CiAgICAgICAgaWYgKF92YWxTdHJhdGVneSA9PSAtMSkKICAgICAg\nICAgICAgX3ZhbFN0cmF0ZWd5ID0gVmFsdWVTdHJhdGVnaWVzLk5PTkU7CiAg\nICAgICAgcmV0dXJuIF92YWxTdHJhdGVneTsKICAgIH0KCiAgICAvKioKICAg\nICAqIFRoZSBzdHJhdGVneSB0byB1c2UgZm9yIGluc2VydCB2YWx1ZSBnZW5l\ncmF0aW9uLgogICAgICogT25lIG9mIHRoZSBjb25zdGFudHMgZnJvbSB7QGxp\nbmsgVmFsdWVTdHJhdGVnaWVzfS4KICAgICAqLwogICAgcHVibGljIHZvaWQg\nc2V0VmFsdWVTdHJhdGVneShpbnQgc3RyYXRlZ3kpIHsKICAgICAgICBfdmFs\nU3RyYXRlZ3kgPSBzdHJhdGVneTsKICAgICAgICBpZiAoc3RyYXRlZ3kgIT0g\nVmFsdWVTdHJhdGVnaWVzLlNFUVVFTkNFKQogICAgICAgICAgICBzZXRWYWx1\nZVNlcXVlbmNlTmFtZShudWxsKTsKICAgIH0KCiAgICAvKioKICAgICAqIFRo\nZSB2YWx1ZSBzZXF1ZW5jZSBuYW1lLCBvciBudWxsIGZvciBub25lLgogICAg\nICovCiAgICBwdWJsaWMgU3RyaW5nIGdldFZhbHVlU2VxdWVuY2VOYW1lKCkg\newogICAgICAgIGlmIChDbGFzc01ldGFEYXRhLkRFRkFVTFRfU1RSSU5HLmVx\ndWFscyhfc2VxTmFtZSkpCiAgICAgICAgICAgIF9zZXFOYW1lID0gbnVsbDsK\nICAgICAgICByZXR1cm4gX3NlcU5hbWU7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBUaGUgdmFsdWUgc2VxdWVuY2UgbmFtZSwgb3IgbnVsbCBmb3Igbm9uZS4K\nICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0VmFsdWVTZXF1ZW5jZU5hbWUo\nU3RyaW5nIHNlcU5hbWUpIHsKICAgICAgICBfc2VxTmFtZSA9IHNlcU5hbWU7\nCiAgICAgICAgX3NlcU1ldGEgPSBudWxsOwogICAgICAgIGlmIChzZXFOYW1l\nICE9IG51bGwpCiAgICAgICAgICAgIHNldFZhbHVlU3RyYXRlZ3koVmFsdWVT\ndHJhdGVnaWVzLlNFUVVFTkNFKTsKICAgIH0KCiAgICAvKioKICAgICAqIE1l\ndGFkYXRhIGZvciB0aGUgdmFsdWUgc2VxdWVuY2UuCiAgICAgKi8KICAgIHB1\nYmxpYyBTZXF1ZW5jZU1ldGFEYXRhIGdldFZhbHVlU2VxdWVuY2VNZXRhRGF0\nYSgpIHsKICAgICAgICBpZiAoX3NlcU1ldGEgPT0gbnVsbCAmJiBnZXRWYWx1\nZVNlcXVlbmNlTmFtZSgpICE9IG51bGwpCiAgICAgICAgICAgIF9zZXFNZXRh\nID0gZ2V0UmVwb3NpdG9yeSgpLmdldFNlcXVlbmNlTWV0YURhdGEoX293bmVy\nLAogICAgICAgICAgICAgICAgZ2V0VmFsdWVTZXF1ZW5jZU5hbWUoKSwgdHJ1\nZSk7CiAgICAgICAgcmV0dXJuIF9zZXFNZXRhOwogICAgfQoKICAgIC8qKgog\nICAgICogVGhlIHN0cmF0ZWd5IHRvIHVzZSB3aGVuIHVwZGF0aW5nIHRoZSBm\naWVsZC4KICAgICAqLwogICAgcHVibGljIGludCBnZXRVcGRhdGVTdHJhdGVn\neSgpIHsKICAgICAgICBpZiAoaXNWZXJzaW9uKCkpCiAgICAgICAgICAgIHJl\ndHVybiBVcGRhdGVTdHJhdGVnaWVzLlJFU1RSSUNUOwogICAgICAgIGlmIChf\ndXBTdHJhdGVneSA9PSAtMSkKICAgICAgICAgICAgX3VwU3RyYXRlZ3kgPSBV\ncGRhdGVTdHJhdGVnaWVzLk5PTkU7CiAgICAgICAgcmV0dXJuIF91cFN0cmF0\nZWd5OwogICAgfQoKICAgIC8qKgogICAgICogU2V0IHRoZSB1cGRhdGUgc3Ry\nYXRlZ3kuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldFVwZGF0ZVN0cmF0\nZWd5KGludCBzdHJhdGVneSkgewogICAgICAgIF91cFN0cmF0ZWd5ID0gc3Ry\nYXRlZ3k7CiAgICB9CgogICAgLyoqCiAgICAgKiBXaGV0aGVyIHRoaXMgZmll\nbGQgaXMgYmFja2VkIGJ5IGEgbGFyZ2UgcmVzdWx0IHNldC4KICAgICAqLwog\nICAgcHVibGljIGJvb2xlYW4gaXNMUlMoKSB7CiAgICAgICAgcmV0dXJuIF9s\ncnMgPT0gQm9vbGVhbi5UUlVFICYmIF9tYW5hZ2UgPT0gTUFOQUdFX1BFUlNJ\nU1RFTlQ7CiAgICB9CgogICAgLyoqCiAgICAgKiBXaGV0aGVyIHRoaXMgZmll\nbGQgaXMgYmFja2VkIGJ5IGEgbGFyZ2UgcmVzdWx0IHNldC4KICAgICAqLwog\nICAgcHVibGljIHZvaWQgc2V0TFJTKGJvb2xlYW4gbHJzKSB7CiAgICAgICAg\nX2xycyA9IChscnMpID8gQm9vbGVhbi5UUlVFIDogQm9vbGVhbi5GQUxTRTsK\nICAgIH0KCiAgICAvKioKICAgICAqIFdoZXRoZXIgdGhpcyBmaWVsZCBpcyBi\nYWNrZWQgYnkgYSBzdHJlYW0uCiAgICAgKgogICAgICogQHNpbmNlIDEuMS4w\nCiAgICAgKi8KICAgIHB1YmxpYyBib29sZWFuIGlzU3RyZWFtKCkgewogICAg\nICAgIHJldHVybiBfc3RyZWFtID09IEJvb2xlYW4uVFJVRSAmJiBfbWFuYWdl\nID09IE1BTkFHRV9QRVJTSVNURU5UOwogICAgfQogICAgCiAgICAvKioKICAg\nICAqIFdoZXRoZXIgdGhpcyBmaWVsZCBpcyBiYWNrZWQgYnkgYSBzdHJlYW0u\nCiAgICAgKgogICAgICogQHNpbmNlIDEuMS4wCiAgICAgKi8KICAgIHB1Ymxp\nYyB2b2lkIHNldFN0cmVhbShib29sZWFuIHN0cmVhbSkgewogICAgICAgIF9z\ndHJlYW0gPSAoc3RyZWFtKSA/IEJvb2xlYW4uVFJVRSA6IEJvb2xlYW4uRkFM\nU0U7CiAgICB9CiAgICAKICAgIC8qKgogICAgICogV2hldGhlciB0aGlzIGZp\nZWxkIHVzZXMgaW50ZXJtZWRpYXRlIGRhdGEgd2hlbiBsb2FkaW5nL3N0b3Jp\nbmcKICAgICAqIGluZm9ybWF0aW9uIHRocm91Z2ggYSB7QGxpbmsgT3BlbkpQ\nQVN0YXRlTWFuYWdlcn0uIERlZmF1bHRzIHRvIHRydWUuCiAgICAgKgogICAg\nICogQHNlZSBPcGVuSlBBU3RhdGVNYW5hZ2VyI3NldEludGVybWVkaWF0ZShp\nbnQsT2JqZWN0KQogICAgICovCiAgICBwdWJsaWMgYm9vbGVhbiB1c2VzSW50\nZXJtZWRpYXRlKCkgewogICAgICAgIHJldHVybiBfaW50ZXJtZWRpYXRlOwog\nICAgfQoKICAgIC8qKgogICAgICogV2hldGhlciB0aGlzIGZpZWxkIHVzZXMg\naW50ZXJtZWRpYXRlIGRhdGEgd2hlbiBsb2FkaW5nL3N0b3JpbmcKICAgICAq\nIGluZm9ybWF0aW9uIHRocm91Z2ggYSB7QGxpbmsgT3BlbkpQQVN0YXRlTWFu\nYWdlcn0uIERlZmF1bHRzIHRvIHRydWUuCiAgICAgKgogICAgICogQHNlZSBP\ncGVuSlBBU3RhdGVNYW5hZ2VyI3NldEludGVybWVkaWF0ZShpbnQsT2JqZWN0\nKQogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRVc2VzSW50ZXJtZWRpYXRl\nKGJvb2xlYW4gaW50ZXJtZWRpYXRlKSB7CiAgICAgICAgX2ludGVybWVkaWF0\nZSA9IGludGVybWVkaWF0ZTsKICAgICAgICBfb3duZXIuY2xlYXJFeHRyYUZp\nZWxkRGF0YVRhYmxlKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBXaGV0aGVy\nIHRoaXMgZmllbGQgdXNlcyBpbXBsIGRhdGEgaW4gY29uanVuY3Rpb24gd2l0\naCBzdGFuZGFyZAogICAgICogZmllbGQgZGF0YSB3aGVuIGFjdGluZyBvbiBh\nIHtAbGluayBPcGVuSlBBU3RhdGVNYW5hZ2VyfS4KICAgICAqIERlZmF1bHRz\nIHRvIHtAbGluayBCb29sZWFuI1RSVUV9IChub24tY2FjaGFibGUgaW1wbCBk\nYXRhKS4KICAgICAqCiAgICAgKiBAcmV0dXJuIHtAbGluayBCb29sZWFuI0ZB\nTFNFfSBpZiB0aGlzIGZpZWxkIGRvZXMgbm90IHVzZSBpbXBsIGRhdGEsCiAg\nICAgKiB7QGxpbmsgQm9vbGVhbiNUUlVFfSBpZiB0aGlzIGZpZWxkIHVzZXMg\nbm9uLWNhY2hhYmxlIGltcGwKICAgICAqIGRhdGEsIG9yIDxjb2RlPm51bGw8\nL2NvZGU+IGlmIHRoaXMgZmllbGQgdXNlcyBpbXBsIGRhdGEgdGhhdAogICAg\nICogc2hvdWxkIGJlIGNhY2hlZCBhY3Jvc3MgaW5zdGFuY2VzCiAgICAgKiBA\nc2VlIE9wZW5KUEFTdGF0ZU1hbmFnZXIjc2V0SW1wbERhdGEoaW50LE9iamVj\ndCkKICAgICAqLwogICAgcHVibGljIEJvb2xlYW4gdXNlc0ltcGxEYXRhKCkg\newogICAgICAgIHJldHVybiBfaW1wbERhdGE7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBXaGV0aGVyIHRoaXMgZmllbGQgdXNlcyBpbXBsIGRhdGEgaW4gY29u\nanVuY3Rpb24gd2l0aCBzdGFuZGFyZAogICAgICogZmllbGQgZGF0YSB3aGVu\nIGFjdGluZyBvbiBhIHtAbGluayBPcGVuSlBBU3RhdGVNYW5hZ2VyfS4KICAg\nICAqCiAgICAgKiBAc2VlIE9wZW5KUEFTdGF0ZU1hbmFnZXIjc2V0SW1wbERh\ndGEoaW50LE9iamVjdCkKICAgICAqIEBzZWUgI3VzZXNJbXBsRGF0YQogICAg\nICovCiAgICBwdWJsaWMgdm9pZCBzZXRVc2VzSW1wbERhdGEoQm9vbGVhbiBp\nbXBsRGF0YSkgewogICAgICAgIF9pbXBsRGF0YSA9IGltcGxEYXRhOwogICAg\nICAgIF9vd25lci5jbGVhckV4dHJhRmllbGREYXRhVGFibGUoKTsKICAgIH0K\nCiAgICAvKioKICAgICAqIFRoZSBvcmRlcmluZ3MgZm9yIHRoaXMgZmllbGQg\ndG8gYmUgYXBwbGllZCBvbiBsb2FkLCBvciBlbXB0eSBhcnJheS4KICAgICAq\nLwogICAgcHVibGljIE9yZGVyW10gZ2V0T3JkZXJzKCkgewogICAgICAgIGlm\nIChfb3JkZXJzID09IG51bGwpIHsKICAgICAgICAgICAgaWYgKF9vcmRlckRl\nYyA9PSBudWxsKQogICAgICAgICAgICAgICAgX29yZGVycyA9IGdldFJlcG9z\naXRvcnkoKS5FTVBUWV9PUkRFUlM7CiAgICAgICAgICAgIGVsc2UgewogICAg\nICAgICAgICAgICAgU3RyaW5nW10gZGVjcyA9IFN0cmluZ3Muc3BsaXQoX29y\nZGVyRGVjLCAiLCIsIDApOwogICAgICAgICAgICAgICAgT3JkZXJbXSBvcmRl\ncnMgPSBnZXRSZXBvc2l0b3J5KCkubmV3T3JkZXJBcnJheShkZWNzLmxlbmd0\naCk7CiAgICAgICAgICAgICAgICBpbnQgc3BjOwogICAgICAgICAgICAgICAg\nYm9vbGVhbiBhc2M7CiAgICAgICAgICAgICAgICBmb3IgKGludCBpID0gMDsg\naSA8IGRlY3MubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICAgICAgICBk\nZWNzW2ldID0gZGVjc1tpXS50cmltKCk7CiAgICAgICAgICAgICAgICAgICAg\nc3BjID0gZGVjc1tpXS5pbmRleE9mKCcgJyk7CiAgICAgICAgICAgICAgICAg\nICAgaWYgKHNwYyA9PSAtMSkKICAgICAgICAgICAgICAgICAgICAgICAgYXNj\nID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAg\nICAgICAgICAgICAgICAgYXNjID0gZGVjc1tpXS5zdWJzdHJpbmcoc3BjICsg\nMSkudHJpbSgpLgogICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9Mb3dl\nckNhc2UoKS5zdGFydHNXaXRoKCJhc2MiKTsKICAgICAgICAgICAgICAgICAg\nICAgICAgZGVjc1tpXSA9IGRlY3NbaV0uc3Vic3RyaW5nKDAsIHNwYyk7CiAg\nICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIG9yZGVy\nc1tpXSA9IGdldFJlcG9zaXRvcnkoKS5uZXdPcmRlcih0aGlzLCBkZWNzW2ld\nLCBhc2MpOwogICAgICAgICAgICAgICAgICAgIC8vc2V0ICJpc1VzZWRJbk9y\nZGVyQnkiIHRvIHRoZSBmaWVsZAogICAgICAgICAgICAgICAgICAgIENsYXNz\nTWV0YURhdGEgZWxlbUNscyA9IGdldEVsZW1lbnQoKQogICAgICAgICAgICAg\nICAgICAgICAgICAuZ2V0RGVjbGFyZWRUeXBlTWV0YURhdGEoKTsKICAgICAg\nICAgICAgICAgICAgICBpZiAoZWxlbUNscyAhPSBudWxsKSB7CiAgICAgICAg\nICAgICAgICAgICAgICBGaWVsZE1ldGFEYXRhIGZtZCA9IGVsZW1DbHMuZ2V0\nRGVjbGFyZWRGaWVsZChkZWNzW2ldKTsKICAgICAgICAgICAgICAgICAgICAg\nIGlmIChmbWQgIT0gbnVsbCkKICAgICAgICAgICAgICAgICAgICAgICAgZm1k\nLnNldFVzZWRJbk9yZGVyQnkodHJ1ZSk7ICAgICAgICAgICAgICAgICAgICAg\nIAogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAg\nICAgICAgICAgICAgIF9vcmRlcnMgPSBvcmRlcnM7CiAgICAgICAgICAgIH0K\nICAgICAgICB9CiAgICAgICAgcmV0dXJuIF9vcmRlcnM7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBUaGUgb3JkZXJpbmdzIGZvciB0aGlzIGZpZWxkIHRvIGJl\nIGFwcGxpZWQgb24gbG9hZC4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0\nT3JkZXJzKE9yZGVyW10gb3JkZXJzKSB7CiAgICAgICAgX29yZGVyRGVjID0g\nbnVsbDsKICAgICAgICBfb3JkZXJzID0gb3JkZXJzOwogICAgfQoKICAgIC8q\nKgogICAgICogU3RyaW5nIGRlY2xhcmluZyB0aGUgb3JkZXJpbmdzIGZvciB0\naGlzIGZpZWxkIHRvIGJlIGFwcGxpZWQgb24gbG9hZCwKICAgICAqIG9yIG51\nbGwuIFRoZSBzdHJpbmcgaXMgb2YgdGhlIGZvcm06PGJyIC8+CiAgICAgKiA8\nY29kZT5vcmRlcmFibGVbIGFzY3xkZXNjXVssIC4uLl08L2NvZGU+PGJyIC8+\nCiAgICAgKiBUaGUgb3JkZXJhYmxlIDxjb2RlPiNlbGVtZW50PC9jb2RlPiBp\ncyB1c2VkIHRvIGRlbm90ZSB0aGUgdmFsdWUgb2YKICAgICAqIHRoZSBmaWVs\nZCdzIGVsZW1lbnRzLgogICAgICovCiAgICBwdWJsaWMgU3RyaW5nIGdldE9y\nZGVyRGVjbGFyYXRpb24oKSB7CiAgICAgICAgaWYgKF9vcmRlckRlYyA9PSBu\ndWxsICYmIF9vcmRlcnMgIT0gbnVsbCkgewogICAgICAgICAgICBTdHJpbmdC\ndWZmZXIgYnVmID0gbmV3IFN0cmluZ0J1ZmZlcigpOwogICAgICAgICAgICBm\nb3IgKGludCBpID0gMDsgaSA8IF9vcmRlcnMubGVuZ3RoOyBpKyspIHsKICAg\nICAgICAgICAgICAgIGlmIChpID4gMCkKICAgICAgICAgICAgICAgICAgICBi\ndWYuYXBwZW5kKCIsICIpOwogICAgICAgICAgICAgICAgYnVmLmFwcGVuZChf\nb3JkZXJzW2ldLmdldE5hbWUoKSkuYXBwZW5kKCIgIik7CiAgICAgICAgICAg\nICAgICBidWYuYXBwZW5kKChfb3JkZXJzW2ldLmlzQXNjZW5kaW5nKCkpID8g\nImFzYyIgOiAiZGVzYyIpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIF9v\ncmRlckRlYyA9IGJ1Zi50b1N0cmluZygpOwogICAgICAgIH0KICAgICAgICBy\nZXR1cm4gX29yZGVyRGVjOwogICAgfQoKICAgIC8qKgogICAgICogU3RyaW5n\nIGRlY2xhcmluZyB0aGUgb3JkZXJpbmdzIGZvciB0aGlzIGZpZWxkIHRvIGJl\nIGFwcGxpZWQgb24gbG9hZCwKICAgICAqIG9yIG51bGwuIFRoZSBzdHJpbmcg\naXMgb2YgdGhlIGZvcm06PGJyIC8+CiAgICAgKiA8Y29kZT5vcmRlcmFibGVb\nIGFzY3xkZXNjXVssIC4uLl08L2NvZGU+PGJyIC8+CiAgICAgKiBUaGUgb3Jk\nZXJhYmxlIDxjb2RlPiNlbGVtZW50PC9jb2RlPiBpcyB1c2VkIHRvIGRlbm90\nZSB0aGUgdmFsdWUgb2YKICAgICAqIHRoZSBmaWVsZCdzIGVsZW1lbnRzLgog\nICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRPcmRlckRlY2xhcmF0aW9uKFN0\ncmluZyBkZWMpIHsKICAgICAgICBfb3JkZXJEZWMgPSBTdHJpbmdVdGlscy50\ncmltVG9OdWxsKGRlYyk7CiAgICAgICAgX29yZGVycyA9IG51bGw7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBPcmRlciB0aGlzIGZpZWxkIHZhbHVlIHdoZW4g\naXQgaXMgbG9hZGVkLgogICAgICovCiAgICBwdWJsaWMgT2JqZWN0IG9yZGVy\nKE9iamVjdCB2YWwpIHsKICAgICAgICBpZiAodmFsID09IG51bGwpCiAgICAg\nICAgICAgIHJldHVybiBudWxsOwoKICAgICAgICBPcmRlcltdIG9yZGVycyA9\nIGdldE9yZGVycygpOwogICAgICAgIGlmIChvcmRlcnMubGVuZ3RoID09IDAp\nCiAgICAgICAgICAgIHJldHVybiB2YWw7CgogICAgICAgIC8vIGNyZWF0ZSBh\nIGNvbXBhcmF0b3IgZm9yIHRoZSBlbGVtZW50cyBvZiB0aGUgdmFsdWUKICAg\nICAgICBDb21wYXJhdG9yPD8+IGNvbXA7CiAgICAgICAgaWYgKG9yZGVycy5s\nZW5ndGggPT0gMSkKICAgICAgICAgICAgY29tcCA9IG9yZGVyc1swXS5nZXRD\nb21wYXJhdG9yKCk7CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIExpc3Q8\nQ29tcGFyYXRvcjw/Pj4gY29tcHMgPSBudWxsOwogICAgICAgICAgICBDb21w\nYXJhdG9yPD8+IGN1ckNvbXA7CiAgICAgICAgICAgIGZvciAoaW50IGkgPSAw\nOyBpIDwgb3JkZXJzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgICBj\ndXJDb21wID0gb3JkZXJzW2ldLmdldENvbXBhcmF0b3IoKTsKICAgICAgICAg\nICAgICAgIGlmIChjdXJDb21wICE9IG51bGwpIHsKICAgICAgICAgICAgICAg\nICAgICBpZiAoY29tcHMgPT0gbnVsbCkKICAgICAgICAgICAgICAgICAgICAg\nICAgY29tcHMgPSBuZXcgQXJyYXlMaXN0PENvbXBhcmF0b3I8Pz4+KG9yZGVy\ncy5sZW5ndGgpOwogICAgICAgICAgICAgICAgICAgIGlmIChpICE9IGNvbXBz\nLnNpemUoKSkKICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IE1l\ndGFEYXRhRXhjZXB0aW9uKF9sb2MuZ2V0CiAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAoIm1peGVkLWlubWVtLW9yZGVyaW5nIiwgdGhpcykpOwogICAg\nICAgICAgICAgICAgICAgIGNvbXBzLmFkZChjdXJDb21wKTsKICAgICAgICAg\nICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoY29tcHMg\nPT0gbnVsbCkKICAgICAgICAgICAgICAgIGNvbXAgPSBudWxsOwogICAgICAg\nICAgICBlbHNlCiAgICAgICAgICAgICAgICBjb21wID0gbmV3IENvbXBhcmF0\nb3JDaGFpbihjb21wcyk7CiAgICAgICAgfQoKICAgICAgICBpZiAoY29tcCA9\nPSBudWxsKQogICAgICAgICAgICByZXR1cm4gdmFsOwoKICAgICAgICAvLyBz\nb3J0CiAgICAgICAgc3dpdGNoIChnZXRUeXBlQ29kZSgpKSB7CiAgICAgICAg\nICAgIGNhc2UgSmF2YVR5cGVzLkFSUkFZOgogICAgICAgICAgICAgICAgTGlz\ndCBsID0gSmF2YVR5cGVzLnRvTGlzdCh2YWwsIF9lbGVtLmdldFR5cGUoKSwg\ndHJ1ZSk7CiAgICAgICAgICAgICAgICBDb2xsZWN0aW9ucy5zb3J0KGwsIChD\nb21wYXJhdG9yPD8gc3VwZXIgT3JkZXI+KSBjb21wKTsKICAgICAgICAgICAg\nICAgIHJldHVybiBKYXZhVHlwZXMudG9BcnJheShsLCBfZWxlbS5nZXRUeXBl\nKCkpOwogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5DT0xMRUNUSU9OOgog\nICAgICAgICAgICAgICAgaWYgKHZhbCBpbnN0YW5jZW9mIExpc3QpCiAgICAg\nICAgICAgICAgICAgICAgQ29sbGVjdGlvbnMuc29ydCgoTGlzdCkgdmFsLCAo\nQ29tcGFyYXRvcjw/IHN1cGVyIE9yZGVyPikgY29tcCk7CiAgICAgICAgICAg\nICAgICByZXR1cm4gdmFsOwogICAgICAgICAgICBkZWZhdWx0OgogICAgICAg\nICAgICAgICAgdGhyb3cgbmV3IE1ldGFEYXRhRXhjZXB0aW9uKF9sb2MuZ2V0\nKCJjYW50LW9yZGVyIiwgdGhpcykpOwogICAgICAgIH0KICAgIH0KCiAgICAv\nKioKICAgICAqIFdoZXRoZXIgdGhlIGZpZWxkIGlzIGV4dGVybmFsaXplZC4K\nICAgICAqLwogICAgcHVibGljIGJvb2xlYW4gaXNFeHRlcm5hbGl6ZWQoKSB7\nCiAgICAgICAgcmV0dXJuIGdldEV4dGVybmFsaXplck1ldGhvZCgpICE9IG51\nbGwKICAgICAgICAgICAgfHwgZ2V0RXh0ZXJuYWxWYWx1ZU1hcCgpICE9IG51\nbGw7CiAgICB9CgogICAgLyoqCiAgICAgKiBDb252ZXJ0IHRoZSBnaXZlbiBm\naWVsZCB2YWx1ZSB0byBpdHMgZXh0ZXJuYWwgdmFsdWUgdGhyb3VnaCB0aGUK\nICAgICAqIHByb3ZpZGVkIGV4dGVybmFsaXplciwgb3IgcmV0dXJuIHRoZSB2\nYWx1ZSBhcy1pcyBpZiBubyBleHRlcm5hbGl6ZXIuCiAgICAgKi8KICAgIHB1\nYmxpYyBPYmplY3QgZ2V0RXh0ZXJuYWxWYWx1ZShPYmplY3QgdmFsLCBTdG9y\nZUNvbnRleHQgY3R4KSB7CiAgICAgICAgTWFwIGV4dFZhbHVlcyA9IGdldEV4\ndGVybmFsVmFsdWVNYXAoKTsKICAgICAgICBpZiAoZXh0VmFsdWVzICE9IG51\nbGwpIHsKICAgICAgICAgICAgT2JqZWN0IGZvdW5kVmFsID0gZXh0VmFsdWVz\nLmdldCh2YWwpOwogICAgICAgICAgICBpZiAoZm91bmRWYWwgPT0gbnVsbCkg\newogICAgICAgICAgICAgICAgdGhyb3cgbmV3IFVzZXJFeGNlcHRpb24oX2xv\nYy5nZXQoImJhZC1leHRlcm5hbGl6ZWQtdmFsdWUiLAogICAgICAgICAgICAg\nICAgICAgICAgICBuZXcgT2JqZWN0W10geyB2YWwsIGV4dFZhbHVlcy5rZXlT\nZXQoKSwgdGhpcyB9KSkKICAgICAgICAgICAgICAgICAgICAgICAgLnNldEZh\ndGFsKHRydWUpLnNldEZhaWxlZE9iamVjdCh2YWwpOwogICAgICAgICAgICB9\nIGVsc2UgewogICAgICAgICAgICAgICAgcmV0dXJuIGZvdW5kVmFsOwogICAg\nICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBNZXRob2QgZXh0ZXJuYWxp\nemVyID0gZ2V0RXh0ZXJuYWxpemVyTWV0aG9kKCk7CiAgICAgICAgaWYgKGV4\ndGVybmFsaXplciA9PSBudWxsKQogICAgICAgICAgICByZXR1cm4gdmFsOwoK\nICAgICAgICAvLyBzcGVjaWFsIGNhc2UgZm9yIHF1ZXJpZXM6IGFsbG93IHRo\nZSBnaXZlbiB2YWx1ZSB0byBwYXNzIHRocm91Z2gKICAgICAgICAvLyBhcy1p\ncyBpZiBpdCBpcyBhbHJlYWR5IGluIGV4dGVybmFsaXplZCBmb3JtCiAgICAg\nICAgaWYgKHZhbCAhPSBudWxsICYmIGdldFR5cGUoKS5pc0luc3RhbmNlKHZh\nbCkKICAgICAgICAgICAgJiYgKCFnZXREZWNsYXJlZFR5cGUoKS5pc0luc3Rh\nbmNlKHZhbCkKICAgICAgICAgICAgfHwgZ2V0RGVjbGFyZWRUeXBlKCkgPT0g\nT2JqZWN0LmNsYXNzKSkKICAgICAgICAgICAgcmV0dXJuIHZhbDsKCiAgICAg\nICAgdHJ5IHsKICAgICAgICAgICAgLy8gZWl0aGVyIGludm9rZSB0aGUgc3Rh\ndGljIHRvRXh0ZXJuYWwodmFsWywgY3R4XSkgbWV0aG9kLCBvciB0aGUKICAg\nICAgICAgICAgLy8gbm9uLXN0YXRpYyB2YWwudG9FeHRlcm5hbChbY3R4XSkg\nbWV0aG9kCiAgICAgICAgICAgIGlmIChNb2RpZmllci5pc1N0YXRpYyhleHRl\ncm5hbGl6ZXIuZ2V0TW9kaWZpZXJzKCkpKSB7CiAgICAgICAgICAgICAgICBp\nZiAoZXh0ZXJuYWxpemVyLmdldFBhcmFtZXRlclR5cGVzKCkubGVuZ3RoID09\nIDEpCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGV4dGVybmFsaXplci5p\nbnZva2UobnVsbCwgbmV3IE9iamVjdFtdeyB2YWwgfSk7CiAgICAgICAgICAg\nICAgICByZXR1cm4gZXh0ZXJuYWxpemVyLmludm9rZShudWxsLCBuZXcgT2Jq\nZWN0W117IHZhbCwgY3R4IH0pOwogICAgICAgICAgICB9CiAgICAgICAgICAg\nIGlmICh2YWwgPT0gbnVsbCkKICAgICAgICAgICAgICAgIHJldHVybiBudWxs\nOwogICAgICAgICAgICBpZiAoZXh0ZXJuYWxpemVyLmdldFBhcmFtZXRlclR5\ncGVzKCkubGVuZ3RoID09IDApCiAgICAgICAgICAgICAgICByZXR1cm4gZXh0\nZXJuYWxpemVyLmludm9rZSh2YWwsIChPYmplY3RbXSkgbnVsbCk7CiAgICAg\nICAgICAgIHJldHVybiBleHRlcm5hbGl6ZXIuaW52b2tlKHZhbCwgbmV3IE9i\namVjdFtdeyBjdHggfSk7CiAgICAgICAgfSBjYXRjaCAoT3BlbkpQQUV4Y2Vw\ndGlvbiBrZSkgewogICAgICAgICAgICB0aHJvdyBrZTsKICAgICAgICB9IGNh\ndGNoIChFeGNlcHRpb24gZSkgewogICAgICAgICAgICB0aHJvdyBuZXcgTWV0\nYURhdGFFeGNlcHRpb24oX2xvYy5nZXQoImV4dGVybmFsaXplci1lcnIiLCB0\naGlzLAogICAgICAgICAgICAgICAgRXhjZXB0aW9ucy50b1N0cmluZyh2YWwp\nLCBlLnRvU3RyaW5nKCkpKS5zZXRDYXVzZShlKTsKICAgICAgICB9CiAgICB9\nCgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIHJlc3VsdCBvZiBwYXNzaW5n\nIHRoZSBnaXZlbiBleHRlcm5hbCB2YWx1ZSB0aHJvdWdoIHRoZQogICAgICog\nZmFjdG9yeSB0byBnZXQgdGhlIGZpZWxkIHZhbHVlLiBJZiBubyBmYWN0b3J5\nIGlzIHByZXNlbnQsCiAgICAgKiB0aGUgZ2l2ZW4gdmFsdWUgaXMgcmV0dXJu\nZWQgYXMtaXMuCiAgICAgKi8KICAgIHB1YmxpYyBPYmplY3QgZ2V0RmllbGRW\nYWx1ZShPYmplY3QgdmFsLCBTdG9yZUNvbnRleHQgY3R4KSB7CiAgICAgICAg\nTWFwIGZpZWxkVmFsdWVzID0gZ2V0RmllbGRWYWx1ZU1hcCgpOwogICAgICAg\nIGlmIChmaWVsZFZhbHVlcyAhPSBudWxsKQogICAgICAgICAgICByZXR1cm4g\nZmllbGRWYWx1ZXMuZ2V0KHZhbCk7CgogICAgICAgIE1lbWJlciBmYWN0b3J5\nID0gZ2V0RmFjdG9yeU1ldGhvZCgpOwogICAgICAgIGlmIChmYWN0b3J5ID09\nIG51bGwpCiAgICAgICAgICAgIHJldHVybiB2YWw7CgogICAgICAgIHRyeSB7\nCiAgICAgICAgICAgIGlmICh2YWwgPT0gbnVsbCAmJiBnZXROdWxsVmFsdWUo\nKSA9PSBOVUxMX0RFRkFVTFQpCiAgICAgICAgICAgICAgICByZXR1cm4gQWNj\nZXNzQ29udHJvbGxlci5kb1ByaXZpbGVnZWQoCiAgICAgICAgICAgICAgICAg\nICAgSjJEb1ByaXZIZWxwZXIubmV3SW5zdGFuY2VBY3Rpb24oZ2V0RGVjbGFy\nZWRUeXBlKCkpKTsgCgogICAgICAgICAgICAvLyBpbnZva2UgZWl0aGVyIHRo\nZSBjb25zdHJ1Y3RvciBmb3IgdGhlIGZpZWxkIHR5cGUsCiAgICAgICAgICAg\nIC8vIG9yIHRoZSBzdGF0aWMgdHlwZS50b0ZpZWxkKHZhbFssIGN0eF0pIG1l\ndGhvZAogICAgICAgICAgICBpZiAoZmFjdG9yeSBpbnN0YW5jZW9mIENvbnN0\ncnVjdG9yKSB7CiAgICAgICAgICAgICAgICBpZiAodmFsID09IG51bGwpCiAg\nICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgICAgICAg\nICByZXR1cm4gKChDb25zdHJ1Y3RvcikgZmFjdG9yeSkubmV3SW5zdGFuY2UK\nICAgICAgICAgICAgICAgICAgICAobmV3IE9iamVjdFtdeyB2YWwgfSk7CiAg\nICAgICAgICAgIH0KCiAgICAgICAgICAgIE1ldGhvZCBtZXRoID0gKE1ldGhv\nZCkgZmFjdG9yeTsKICAgICAgICAgICAgaWYgKG1ldGguZ2V0UGFyYW1ldGVy\nVHlwZXMoKS5sZW5ndGggPT0gMSkKICAgICAgICAgICAgICAgIHJldHVybiBt\nZXRoLmludm9rZShudWxsLCBuZXcgT2JqZWN0W117IHZhbCB9KTsKICAgICAg\nICAgICAgcmV0dXJuIG1ldGguaW52b2tlKG51bGwsIG5ldyBPYmplY3RbXXsg\ndmFsLCBjdHggfSk7CiAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsK\nICAgICAgICAgICAgLy8gdW53cmFwIGNhdXNlCiAgICAgICAgICAgIGlmIChl\nIGluc3RhbmNlb2YgSW52b2NhdGlvblRhcmdldEV4Y2VwdGlvbikgewogICAg\nICAgICAgICAgICAgVGhyb3dhYmxlIHQgPSAoKEludm9jYXRpb25UYXJnZXRF\neGNlcHRpb24pIGUpLgogICAgICAgICAgICAgICAgICAgIGdldFRhcmdldEV4\nY2VwdGlvbigpOwogICAgICAgICAgICAgICAgaWYgKHQgaW5zdGFuY2VvZiBF\ncnJvcikKICAgICAgICAgICAgICAgICAgICB0aHJvdyAoRXJyb3IpIHQ7CiAg\nICAgICAgICAgICAgICBlID0gKEV4Y2VwdGlvbikgdDsKCiAgICAgICAgICAg\nICAgICAvLyBhbGxvdyBudWxsIHZhbHVlcyB0byBjYXVzZSBOUEVzIGFuZCBp\nbGxlZ2FsIGFyZyBleGNlcHRpb25zCiAgICAgICAgICAgICAgICAvLyB3aXRo\nb3V0IGVycm9yCiAgICAgICAgICAgICAgICBpZiAodmFsID09IG51bGwgJiYg\nKGUgaW5zdGFuY2VvZiBOdWxsUG9pbnRlckV4Y2VwdGlvbgogICAgICAgICAg\nICAgICAgICAgIHx8IGUgaW5zdGFuY2VvZiBJbGxlZ2FsQXJndW1lbnRFeGNl\ncHRpb24pKQogICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsOwogICAg\nICAgICAgICB9CgogICAgICAgICAgICBpZiAoZSBpbnN0YW5jZW9mIE9wZW5K\nUEFFeGNlcHRpb24pCiAgICAgICAgICAgICAgICB0aHJvdyAoT3BlbkpQQUV4\nY2VwdGlvbikgZTsKICAgICAgICAgICAgaWYgKGUgaW5zdGFuY2VvZiBQcml2\naWxlZ2VkQWN0aW9uRXhjZXB0aW9uKQogICAgICAgICAgICAgICAgZSA9ICgo\nUHJpdmlsZWdlZEFjdGlvbkV4Y2VwdGlvbikgZSkuZ2V0RXhjZXB0aW9uKCk7\nCiAgICAgICAgICAgIHRocm93IG5ldyBNZXRhRGF0YUV4Y2VwdGlvbihfbG9j\nLmdldCgiZmFjdG9yeS1lcnIiLCB0aGlzLAogICAgICAgICAgICAgICAgRXhj\nZXB0aW9ucy50b1N0cmluZyh2YWwpLCBlLnRvU3RyaW5nKCkpKS5zZXRDYXVz\nZShlKTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBUaGUgbmFt\nZSBvZiB0aGlzIGZpZWxkJ3MgZXh0ZXJuYWxpemVyLCBvciBudWxsIGlmIG5v\nbmUuCiAgICAgKi8KICAgIHB1YmxpYyBTdHJpbmcgZ2V0RXh0ZXJuYWxpemVy\nKCkgewogICAgICAgIHJldHVybiBfZXh0TmFtZTsKICAgIH0KCiAgICAvKioK\nICAgICAqIFRoZSBuYW1lIG9mIHRoaXMgZmllbGQncyBleHRlcm5hbGl6ZXIs\nIG9yIG51bGwgaWYgbm9uZS4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0\nRXh0ZXJuYWxpemVyKFN0cmluZyBleHRlcm5hbGl6ZXIpIHsKICAgICAgICBf\nZXh0TmFtZSA9IGV4dGVybmFsaXplcjsKICAgICAgICBfZXh0TWV0aG9kID0g\nREVGQVVMVF9NRVRIT0Q7CiAgICB9CgogICAgLyoqCiAgICAgKiBUaGUgbmFt\nZSBvZiB0aGlzIGZpZWxkJ3MgZmFjdG9yeSwgb3IgbnVsbCBpZiBub25lLgog\nICAgICovCiAgICBwdWJsaWMgU3RyaW5nIGdldEZhY3RvcnkoKSB7CiAgICAg\nICAgcmV0dXJuIF9mYWN0TmFtZTsKICAgIH0KCiAgICAvKioKICAgICAqIFRo\nZSBuYW1lIG9mIHRoaXMgZmllbGQncyBmYWN0b3J5LCBvciBudWxsIGlmIG5v\nbmUuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldEZhY3RvcnkoU3RyaW5n\nIGZhY3RvcnkpIHsKICAgICAgICBfZmFjdE5hbWUgPSBmYWN0b3J5OwogICAg\nICAgIF9mYWN0TWV0aG9kID0gREVGQVVMVF9NRVRIT0Q7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBQcm9wZXJ0aWVzIHN0cmluZyBtYXBwaW5nIGZpZWxkIHZh\nbHVlcyB0byBleHRlcm5hbCB2YWx1ZXMuCiAgICAgKi8KICAgIHB1YmxpYyBT\ndHJpbmcgZ2V0RXh0ZXJuYWxWYWx1ZXMoKSB7CiAgICAgICAgcmV0dXJuIF9l\neHRTdHJpbmc7CiAgICB9CgogICAgLyoqCiAgICAgKiBQcm9wZXJ0aWVzIHN0\ncmluZyBtYXBwaW5nIGZpZWxkIHZhbHVlcyB0byBleHRlcm5hbCB2YWx1ZXMu\nCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldEV4dGVybmFsVmFsdWVzKFN0\ncmluZyB2YWx1ZXMpIHsKICAgICAgICBfZXh0U3RyaW5nID0gdmFsdWVzOwog\nICAgICAgIF9leHRWYWx1ZXMgPSBudWxsOwogICAgfQoKICAgIC8qKgogICAg\nICogUmV0dXJuIHRoZSBtYXBwaW5nIG9mIGZpZWxkIHZhbHVlcyB0byBleHRl\ncm5hbCB2YWx1ZXMuCiAgICAgKi8KICAgIHB1YmxpYyBNYXAgZ2V0RXh0ZXJu\nYWxWYWx1ZU1hcCgpIHsKICAgICAgICBwYXJzZUV4dGVybmFsVmFsdWVzKCk7\nCiAgICAgICAgcmV0dXJuIF9leHRWYWx1ZXM7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBSZXR1cm4gdGhlIG1hcHBpbmcgb2YgZXh0ZXJuYWwgdmFsdWVzIHRv\nIGZpZWxkIHZhbHVlcy4KICAgICAqLwogICAgcHVibGljIE1hcCBnZXRGaWVs\nZFZhbHVlTWFwKCkgewogICAgICAgIHBhcnNlRXh0ZXJuYWxWYWx1ZXMoKTsK\nICAgICAgICByZXR1cm4gX2ZpZWxkVmFsdWVzOwogICAgfQoKICAgIC8qKgog\nICAgICogUGFyc2UgZXh0ZXJuYWwgdmFsdWVzIGludG8gbWFwcy4KICAgICAq\nLwogICAgcHJpdmF0ZSB2b2lkIHBhcnNlRXh0ZXJuYWxWYWx1ZXMoKSB7CiAg\nICAgICAgaWYgKF9leHRWYWx1ZXMgIT0gQ29sbGVjdGlvbnMuRU1QVFlfTUFQ\nCiAgICAgICAgICAgICYmIF9maWVsZFZhbHVlcyAhPSBDb2xsZWN0aW9ucy5F\nTVBUWV9NQVApCiAgICAgICAgICAgIHJldHVybjsKCiAgICAgICAgaWYgKF9l\neHRTdHJpbmcgPT0gbnVsbCkgewogICAgICAgICAgICBfZXh0VmFsdWVzID0g\nbnVsbDsKICAgICAgICAgICAgX2ZpZWxkVmFsdWVzID0gbnVsbDsKICAgICAg\nICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgLy8gcGFyc2Ugc3Ry\naW5nIGludG8gb3B0aW9uczsgdGhpcyB0YWtlcyBjYXJlIG9mIHByb3BlciB0\ncmltbWluZyBldGMKICAgICAgICBPcHRpb25zIHZhbHVlcyA9IENvbmZpZ3Vy\nYXRpb25zLnBhcnNlUHJvcGVydGllcyhfZXh0U3RyaW5nKTsKICAgICAgICBp\nZiAodmFsdWVzLmlzRW1wdHkoKSkKICAgICAgICAgICAgdGhyb3cgbmV3IE1l\ndGFEYXRhRXhjZXB0aW9uKF9sb2MuZ2V0KCJuby1leHRlcm5hbC12YWx1ZXMi\nLCB0aGlzLAogICAgICAgICAgICAgICAgX2V4dFN0cmluZykpOwoKICAgICAg\nICBNYXAgZXh0VmFsdWVzID0gbmV3IEhhc2hNYXAoKGludCkgKHZhbHVlcy5z\naXplKCkgKiAxLjMzICsgMSkpOwogICAgICAgIE1hcCBmaWVsZFZhbHVlcyA9\nIG5ldyBIYXNoTWFwKChpbnQpICh2YWx1ZXMuc2l6ZSgpICogMS4zMyArIDEp\nKTsKICAgICAgICBNYXAuRW50cnkgZW50cnk7CiAgICAgICAgT2JqZWN0IGV4\ndFZhbHVlLCBmaWVsZFZhbHVlOwogICAgICAgIGZvciAoSXRlcmF0b3IgaXRy\nID0gdmFsdWVzLmVudHJ5U2V0KCkuaXRlcmF0b3IoKTsgaXRyLmhhc05leHQo\nKTspIHsKICAgICAgICAgICAgZW50cnkgPSAoTWFwLkVudHJ5KSBpdHIubmV4\ndCgpOwogICAgICAgICAgICBmaWVsZFZhbHVlID0gdHJhbnNmb3JtKChTdHJp\nbmcpIGVudHJ5LmdldEtleSgpLAogICAgICAgICAgICAgICAgZ2V0RGVjbGFy\nZWRUeXBlQ29kZSgpKTsKICAgICAgICAgICAgZXh0VmFsdWUgPSB0cmFuc2Zv\ncm0oKFN0cmluZykgZW50cnkuZ2V0VmFsdWUoKSwgZ2V0VHlwZUNvZGUoKSk7\nCgogICAgICAgICAgICBleHRWYWx1ZXMucHV0KGZpZWxkVmFsdWUsIGV4dFZh\nbHVlKTsKICAgICAgICAgICAgZmllbGRWYWx1ZXMucHV0KGV4dFZhbHVlLCBm\naWVsZFZhbHVlKTsKICAgICAgICB9CgogICAgICAgIF9leHRWYWx1ZXMgPSBl\neHRWYWx1ZXM7CiAgICAgICAgX2ZpZWxkVmFsdWVzID0gZmllbGRWYWx1ZXM7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIHN0cmluZyB2YWx1\nZSBjb252ZXJ0ZWQgdG8gdGhlIGdpdmVuIHR5cGUgY29kZS4gVGhlIHN0cmlu\nZwogICAgICogbXVzdCBiZSBub24tbnVsbCBhbmQgdHJpbW1lZC4KICAgICAq\nLwogICAgcHJpdmF0ZSBPYmplY3QgdHJhbnNmb3JtKFN0cmluZyB2YWwsIGlu\ndCB0eXBlQ29kZSkgewogICAgICAgIGlmICgibnVsbCIuZXF1YWxzKHZhbCkp\nCiAgICAgICAgICAgIHJldHVybiBudWxsOwoKICAgICAgICBzd2l0Y2ggKHR5\ncGVDb2RlKSB7CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLkJPT0xFQU46\nCiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLkJPT0xFQU5fT0JKOgogICAg\nICAgICAgICAgICAgcmV0dXJuIEJvb2xlYW4udmFsdWVPZih2YWwpOwogICAg\nICAgICAgICBjYXNlIEphdmFUeXBlcy5CWVRFOgogICAgICAgICAgICBjYXNl\nIEphdmFUeXBlcy5CWVRFX09CSjoKICAgICAgICAgICAgICAgIHJldHVybiBC\neXRlLnZhbHVlT2YodmFsKTsKICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMu\nSU5UOgogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5JTlRfT0JKOgogICAg\nICAgICAgICAgICAgcmV0dXJuIEludGVnZXIudmFsdWVPZih2YWwpOwogICAg\nICAgICAgICBjYXNlIEphdmFUeXBlcy5MT05HOgogICAgICAgICAgICBjYXNl\nIEphdmFUeXBlcy5MT05HX09CSjoKICAgICAgICAgICAgICAgIHJldHVybiBM\nb25nLnZhbHVlT2YodmFsKTsKICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMu\nU0hPUlQ6CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLlNIT1JUX09CSjoK\nICAgICAgICAgICAgICAgIHJldHVybiBTaG9ydC52YWx1ZU9mKHZhbCk7CiAg\nICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLkRPVUJMRToKICAgICAgICAgICAg\nY2FzZSBKYXZhVHlwZXMuRE9VQkxFX09CSjoKICAgICAgICAgICAgICAgIHJl\ndHVybiBEb3VibGUudmFsdWVPZih2YWwpOwogICAgICAgICAgICBjYXNlIEph\ndmFUeXBlcy5GTE9BVDoKICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuRkxP\nQVRfT0JKOgogICAgICAgICAgICAgICAgcmV0dXJuIEZsb2F0LnZhbHVlT2Yo\ndmFsKTsKICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuQ0hBUjoKICAgICAg\nICAgICAgY2FzZSBKYXZhVHlwZXMuQ0hBUl9PQko6CiAgICAgICAgICAgICAg\nICByZXR1cm4gbmV3IENoYXJhY3Rlcih2YWwuY2hhckF0KDApKTsKICAgICAg\nICAgICAgY2FzZSBKYXZhVHlwZXMuU1RSSU5HOgogICAgICAgICAgICAgICAg\ncmV0dXJuIHZhbDsKICAgICAgICB9CiAgICAgICAgdGhyb3cgbmV3IE1ldGFE\nYXRhRXhjZXB0aW9uKF9sb2MuZ2V0KCJiYWQtZXh0ZXJuYWwtdHlwZSIsIHRo\naXMpKTsKICAgIH0KCiAgICAvKioKICAgICAqIFRoZSBleHRlcm5hbGl6ZXIg\nbWV0aG9kLgogICAgICovCiAgICBwdWJsaWMgTWV0aG9kIGdldEV4dGVybmFs\naXplck1ldGhvZCgpIHsKICAgICAgICBpZiAoX21hbmFnZSAhPSBNQU5BR0Vf\nUEVSU0lTVEVOVCkKICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAg\naWYgKF9leHRNZXRob2QgPT0gREVGQVVMVF9NRVRIT0QpIHsKICAgICAgICAg\nICAgaWYgKF9leHROYW1lICE9IG51bGwpIHsKICAgICAgICAgICAgICAgIF9l\neHRNZXRob2QgPSBmaW5kTWV0aG9kKF9leHROYW1lKTsKICAgICAgICAgICAg\nICAgIGlmIChfZXh0TWV0aG9kID09IG51bGwpCiAgICAgICAgICAgICAgICAg\nICAgdGhyb3cgbmV3IE1ldGFEYXRhRXhjZXB0aW9uKF9sb2MuZ2V0KCJiYWQt\nZXh0ZXJuYWxpemVyIiwKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcywg\nX2V4dE5hbWUpKTsKICAgICAgICAgICAgfSBlbHNlCiAgICAgICAgICAgICAg\nICBfZXh0TWV0aG9kID0gbnVsbDsKICAgICAgICB9CiAgICAgICAgcmV0dXJu\nIF9leHRNZXRob2Q7CiAgICB9CgogICAgLyoqCiAgICAgKiBUaGUgZmFjdG9y\neSBtZXRob2Qgb3IgY29uc3RydWN0b3IuCiAgICAgKi8KICAgIHB1YmxpYyBN\nZW1iZXIgZ2V0RmFjdG9yeU1ldGhvZCgpIHsKICAgICAgICBpZiAoX21hbmFn\nZSAhPSBNQU5BR0VfUEVSU0lTVEVOVCkKICAgICAgICAgICAgcmV0dXJuIG51\nbGw7CiAgICAgICAgaWYgKF9mYWN0TWV0aG9kID09IERFRkFVTFRfTUVUSE9E\nKSB7CiAgICAgICAgICAgIGlmIChnZXRFeHRlcm5hbGl6ZXJNZXRob2QoKSA9\nPSBudWxsKQogICAgICAgICAgICAgICAgX2ZhY3RNZXRob2QgPSBudWxsOwog\nICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgIHRyeSB7CiAgICAg\nICAgICAgICAgICAgICAgaWYgKF9mYWN0TmFtZSA9PSBudWxsKQogICAgICAg\nICAgICAgICAgICAgICAgICBfZmFjdE1ldGhvZCA9IGdldERlY2xhcmVkVHlw\nZSgpLmdldENvbnN0cnVjdG9yCiAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAobmV3IENsYXNzW117IGdldFR5cGUoKSB9KTsKICAgICAgICAgICAgICAg\nICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgICAgIF9mYWN0TWV0aG9k\nID0gZmluZE1ldGhvZChfZmFjdE5hbWUpOwogICAgICAgICAgICAgICAgfSBj\nYXRjaCAoT3BlbkpQQUV4Y2VwdGlvbiBrZSkgewogICAgICAgICAgICAgICAg\nICAgIHRocm93IGtlOwogICAgICAgICAgICAgICAgfSBjYXRjaCAoRXhjZXB0\naW9uIGUpIHsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBp\nZiAoIShfZmFjdE1ldGhvZCBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKQogICAg\nICAgICAgICAgICAgICAgICYmICEoX2ZhY3RNZXRob2QgaW5zdGFuY2VvZiBN\nZXRob2QpKQogICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBNZXRhRGF0\nYUV4Y2VwdGlvbihfbG9jLmdldCgiYmFkLWZhY3RvcnkiLCB0aGlzKSk7CiAg\nICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIF9mYWN0TWV0\naG9kOwogICAgfQoKICAgIC8qKgogICAgICogRmluZCB0aGUgbWV0aG9kIGZv\nciB0aGUgc3BlY2lmaWVkIG5hbWUuIFBvc3NpYmxlIGZvcm1zIGFyZToKICAg\nICAqIDx1bD4KICAgICAqIDxsaT50b0V4dGVybmFsU3RyaW5nPC9saT4KICAg\nICAqIDxsaT5NeUZhY3RvcnlDbGFzcy50b0V4dGVybmFsU3RyaW5nPC9saT4K\nICAgICAqIDxsaT5jb20uY29tcGFueS5NeUZhY3RvcnlDbGFzcy50b0V4dGVy\nbmFsU3RyaW5nPC9saT4KICAgICAqIDwvdWw+CiAgICAgKgogICAgICogQHBh\ncmFtIG1ldGhvZCB0aGUgbmFtZSBvZiB0aGUgbWV0aG9kIHRvIGxvY2F0ZQog\nICAgICogQHJldHVybiB0aGUgbWV0aG9kIGZvciBpbnZvY2F0aW9uCiAgICAg\nKi8KICAgIHByaXZhdGUgTWV0aG9kIGZpbmRNZXRob2QoU3RyaW5nIG1ldGhv\nZCkgewogICAgICAgIGlmIChTdHJpbmdVdGlscy5pc0VtcHR5KG1ldGhvZCkp\nCiAgICAgICAgICAgIHJldHVybiBudWxsOwoKICAgICAgICAvLyBnZXQgY2xh\nc3MgbmFtZSBhbmQgZ2V0IHBhY2thZ2UgbmFtZSBkaXZpZGUgb24gdGhlIGxh\nc3QgJy4nLCBzbyB0aGUKICAgICAgICAvLyBuYW1lcyBkb24ndCBhcHBseSBp\nbiB0aGlzIGNhc2UsIGJ1dCB0aGUgbWV0aG9kcyBkbyB3aGF0IHdlIHdhbnQK\nICAgICAgICBTdHJpbmcgbWV0aG9kTmFtZSA9IFN0cmluZ3MuZ2V0Q2xhc3NO\nYW1lKG1ldGhvZCk7CiAgICAgICAgU3RyaW5nIGNsc05hbWUgPSBTdHJpbmdz\nLmdldFBhY2thZ2VOYW1lKG1ldGhvZCk7CgogICAgICAgIENsYXNzPD8+IGNs\ncyA9IG51bGw7CiAgICAgICAgQ2xhc3M8Pz4gb3duZXIgPSBfb3duZXIuZ2V0\nRGVzY3JpYmVkVHlwZSgpOwoKICAgICAgICBpZiAoY2xzTmFtZS5sZW5ndGgo\nKSA9PSAwKQogICAgICAgICAgICBjbHMgPSBnZXREZWNsYXJlZFR5cGUoKTsK\nICAgICAgICBlbHNlIGlmIChjbHNOYW1lLmVxdWFscyhvd25lci5nZXROYW1l\nKCkpCiAgICAgICAgICAgIHx8IGNsc05hbWUuZXF1YWxzKFN0cmluZ3MuZ2V0\nQ2xhc3NOYW1lKG93bmVyKSkpCiAgICAgICAgICAgIGNscyA9IG93bmVyOwog\nICAgICAgIGVsc2UKICAgICAgICAgICAgY2xzID0gSmF2YVR5cGVzLmNsYXNz\nRm9yTmFtZShjbHNOYW1lLCB0aGlzKTsKCiAgICAgICAgLy8gZmluZCB0aGUg\nbmFtZWQgbWV0aG9kCiAgICAgICAgTWV0aG9kW10gbWV0aG9kcyA9IGNscy5n\nZXRNZXRob2RzKCk7CiAgICAgICAgQ2xhc3M8Pz5bXSBwYXJhbXM7CiAgICAg\nICAgZm9yIChpbnQgaSA9IDA7IGkgPCBtZXRob2RzLmxlbmd0aDsgaSsrKSB7\nCiAgICAgICAgICAgIGlmIChtZXRob2RzW2ldLmdldE5hbWUoKS5lcXVhbHMo\nbWV0aG9kTmFtZSkpIHsKICAgICAgICAgICAgICAgIHBhcmFtcyA9IG1ldGhv\nZHNbaV0uZ2V0UGFyYW1ldGVyVHlwZXMoKTsKCiAgICAgICAgICAgICAgICAv\nLyBzdGF0aWMgZmFjdG9yeSBtZXRob2RzIHJlcXVpcmUgb25lIGFyZ3VtZW50\nIG9yIG9uZSBhcmd1bWVudAogICAgICAgICAgICAgICAgLy8gcGx1cyBhIGNv\nbnRleHQ7IG5vbi1zdGF0aWMgbWV0aG9kcyByZXF1aXJlIHplcm8gYXJndW1l\nbnRzIG9yCiAgICAgICAgICAgICAgICAvLyBqdXN0IGEgY29udGV4dAogICAg\nICAgICAgICAgICAgaWYgKE1vZGlmaWVyLmlzU3RhdGljKG1ldGhvZHNbaV0u\nZ2V0TW9kaWZpZXJzKCkpCiAgICAgICAgICAgICAgICAgICAgJiYgKHBhcmFt\ncy5sZW5ndGggPT0gMSB8fCAocGFyYW1zLmxlbmd0aCA9PSAyCiAgICAgICAg\nICAgICAgICAgICAgJiYgaXNTdG9yZUNvbnRleHRQYXJhbWV0ZXIocGFyYW1z\nWzFdKSkpKQogICAgICAgICAgICAgICAgICAgIHJldHVybiBtZXRob2RzW2ld\nOwogICAgICAgICAgICAgICAgaWYgKCFNb2RpZmllci5pc1N0YXRpYyhtZXRo\nb2RzW2ldLmdldE1vZGlmaWVycygpKQogICAgICAgICAgICAgICAgICAgICYm\nIChwYXJhbXMubGVuZ3RoID09IDAgfHwgKHBhcmFtcy5sZW5ndGggPT0gMQog\nICAgICAgICAgICAgICAgICAgICYmIGlzU3RvcmVDb250ZXh0UGFyYW1ldGVy\nKHBhcmFtc1swXSkpKSkKICAgICAgICAgICAgICAgICAgICByZXR1cm4gbWV0\naG9kc1tpXTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgcmV0\ndXJuIG51bGw7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gdHJ1ZSBp\nZiB0aGUgZ2l2ZW4gdHlwZSBpcyBhIHN0b3JlIGNvbnRleHQgdHlwZTsgd2Ug\nY2FuJ3QKICAgICAqIHVzZSB0aGUgc3RhbmRhcmQgPGNvZGU+aXNBc3NpZ25h\nYmxlRnJvbTwvY29kZT4gYmVjYXVzZSBvZiBjbGFzc2xvYWRlcgogICAgICog\nb2RkbmVzcy4KICAgICAqLwogICAgcHJpdmF0ZSBzdGF0aWMgYm9vbGVhbiBp\nc1N0b3JlQ29udGV4dFBhcmFtZXRlcihDbGFzczw/PiB0eXBlKSB7CiAgICAg\nICAgcmV0dXJuIFN0b3JlQ29udGV4dC5jbGFzcy5nZXROYW1lKCkuZXF1YWxz\nKHR5cGUuZ2V0TmFtZSgpKTsKICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBl\ncXVhbHMoT2JqZWN0IG90aGVyKSB7CiAgICAgICAgaWYgKG90aGVyID09IHRo\naXMpCiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIGlmICghKG90\naGVyIGluc3RhbmNlb2YgRmllbGRNZXRhRGF0YSkpCiAgICAgICAgICAgIHJl\ndHVybiBmYWxzZTsKICAgICAgICByZXR1cm4gZ2V0RnVsbE5hbWUodHJ1ZSku\nZXF1YWxzKCgoRmllbGRNZXRhRGF0YSkgb3RoZXIpLgogICAgICAgICAgICBn\nZXRGdWxsTmFtZSh0cnVlKSk7CiAgICB9CgogICAgcHVibGljIGludCBoYXNo\nQ29kZSgpIHsKICAgICAgICByZXR1cm4gZ2V0RnVsbE5hbWUodHJ1ZSkuaGFz\naENvZGUoKTsKICAgIH0KCiAgICBwdWJsaWMgaW50IGNvbXBhcmVUbyhPYmpl\nY3Qgb3RoZXIpIHsKICAgICAgICBpZiAob3RoZXIgPT0gbnVsbCkKICAgICAg\nICAgICAgcmV0dXJuIDE7CiAgICAgICAgcmV0dXJuIGdldEZ1bGxOYW1lKHRy\ndWUpLmNvbXBhcmVUbygoKEZpZWxkTWV0YURhdGEpIG90aGVyKS4KICAgICAg\nICAgICAgZ2V0RnVsbE5hbWUodHJ1ZSkpOwogICAgfQoKICAgIHB1YmxpYyBT\ndHJpbmcgdG9TdHJpbmcoKSB7CiAgICAgICAgcmV0dXJuIGdldEZ1bGxOYW1l\nKHRydWUpOwogICAgfQoKICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwog\nICAgLy8gUmVzb2x2ZSBhbmQgdmFsaWRhdGUKICAgIC8vLy8vLy8vLy8vLy8v\nLy8vLy8vLy8vLwoKICAgIC8qKgogICAgICogUmVzb2x2ZSBtb2RlIGZvciB0\naGlzIGZpZWxkLgogICAgICovCiAgICBwdWJsaWMgaW50IGdldFJlc29sdmUo\nKSB7CiAgICAgICAgcmV0dXJuIF9yZXNNb2RlOwogICAgfQoKICAgIC8qKgog\nICAgICogUmVzb2x2ZSBtb2RlIGZvciB0aGlzIGZpZWxkLgogICAgICovCiAg\nICBwdWJsaWMgdm9pZCBzZXRSZXNvbHZlKGludCBtb2RlKSB7CiAgICAgICAg\nX3Jlc01vZGUgPSBtb2RlOwogICAgfQoKICAgIC8qKgogICAgICogUmVzb2x2\nZSBtb2RlIGZvciB0aGlzIGZpZWxkLgogICAgICovCiAgICBwdWJsaWMgdm9p\nZCBzZXRSZXNvbHZlKGludCBtb2RlLCBib29sZWFuIG9uKSB7CiAgICAgICAg\naWYgKG1vZGUgPT0gTU9ERV9OT05FKQogICAgICAgICAgICBfcmVzTW9kZSA9\nIG1vZGU7CiAgICAgICAgZWxzZSBpZiAob24pCiAgICAgICAgICAgIF9yZXNN\nb2RlIHw9IG1vZGU7CiAgICAgICAgZWxzZQogICAgICAgICAgICBfcmVzTW9k\nZSAmPSB+bW9kZTsKICAgIH0KCiAgICAvKioKICAgICAqIFJlc29sdmUgYW5k\nIHZhbGlkYXRlIG1ldGFkYXRhLiBSZXR1cm4gdHJ1ZSBpZiBhbHJlYWR5IHJl\nc29sdmVkLgogICAgICovCiAgICBwdWJsaWMgYm9vbGVhbiByZXNvbHZlKGlu\ndCBtb2RlKSB7CiAgICAgICAgaWYgKChfcmVzTW9kZSAmIG1vZGUpID09IG1v\nZGUpCiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIGludCBjdXIg\nPSBfcmVzTW9kZTsKICAgICAgICBfcmVzTW9kZSB8PSBtb2RlOwoKICAgICAg\nICBMb2cgbG9nID0gZ2V0UmVwb3NpdG9yeSgpLmdldExvZygpOwogICAgICAg\nIGlmIChsb2cuaXNUcmFjZUVuYWJsZWQoKSkKICAgICAgICAgICAgbG9nLnRy\nYWNlKF9sb2MuZ2V0KCJyZXNvbHZlLWZpZWxkIiwgX293bmVyICsgIkAiCiAg\nICAgICAgICAgICAgICArIFN5c3RlbS5pZGVudGl0eUhhc2hDb2RlKF9vd25l\ncikgKyAiLiIgKyBfbmFtZSkpOwoKICAgICAgICAvLyB3ZSBvbmx5IHBlcmZv\ncm0gYWN0aW9ucyBmb3IgbWV0YWRhdGEgbW9kZQogICAgICAgIGlmICgobW9k\nZSAmIE1PREVfTUVUQSkgPT0gMCB8fCAoY3VyICYgTU9ERV9NRVRBKSAhPSAw\nKQogICAgICAgICAgICByZXR1cm4gZmFsc2U7CgogICAgICAgIE1ldGhvZCBl\neHRlcm5hbGl6ZXIgPSBnZXRFeHRlcm5hbGl6ZXJNZXRob2QoKTsKICAgICAg\nICBpZiAoZXh0ZXJuYWxpemVyICE9IG51bGwpCiAgICAgICAgICAgIHNldFR5\ncGUoZXh0ZXJuYWxpemVyLmdldFJldHVyblR5cGUoKSk7CgogICAgICAgIC8v\nIG9ubHkgcGFzcyBvbiBtZXRhZGF0YSByZXNvbHZlIG1vZGUgc28gdGhhdCBt\nZXRhZGF0YSBpcyBhbHdheXMKICAgICAgICAvLyByZXNvbHZlZCBiZWZvcmUg\nYW55IG90aGVyIHJlc29sdmUgbW9kZXMgb3VyIHN1YmNsYXNzZXMgcGFzcyBh\nbG9uZwogICAgICAgIF92YWwucmVzb2x2ZShNT0RFX01FVEEpOwogICAgICAg\nIF9rZXkucmVzb2x2ZShNT0RFX01FVEEpOwogICAgICAgIF9lbGVtLnJlc29s\ndmUoTU9ERV9NRVRBKTsKCiAgICAgICAgTWV0YURhdGFSZXBvc2l0b3J5IHJl\ncG9zID0gZ2V0UmVwb3NpdG9yeSgpOwogICAgICAgIGludCB2YWxpZGF0ZSA9\nIHJlcG9zLmdldFZhbGlkYXRlKCk7CiAgICAgICAgaWYgKCh2YWxpZGF0ZSAm\nIE1ldGFEYXRhUmVwb3NpdG9yeS5WQUxJREFURV9NRVRBKSAhPSAwCiAgICAg\nICAgICAgICYmICghSW1wbEhlbHBlci5pc01hbmFnZWRUeXBlKHJlcG9zLmdl\ndENvbmZpZ3VyYXRpb24oKSwKICAgICAgICAgICAgICAgIF9vd25lci5nZXRE\nZXNjcmliZWRUeXBlKCkpCiAgICAgICAgICAgIHx8ICh2YWxpZGF0ZSAmIE1l\ndGFEYXRhUmVwb3NpdG9yeS5WQUxJREFURV9VTkVOSEFOQ0VEKSA9PSAwKSkg\newogICAgICAgICAgICB2YWxpZGF0ZUxSUygpOwogICAgICAgICAgICBpZiAo\nKHZhbGlkYXRlICYgTWV0YURhdGFSZXBvc2l0b3J5LlZBTElEQVRFX1JVTlRJ\nTUUpID09IDApCiAgICAgICAgICAgICAgICB2YWxpZGF0ZVN1cHBvcnRlZFR5\ncGUoKTsKICAgICAgICAgICAgdmFsaWRhdGVWYWx1ZSgpOwogICAgICAgICAg\nICB2YWxpZGF0ZUV4dGVuc2lvbktleXMoKTsKICAgICAgICB9CiAgICAgICAg\ncmV0dXJuIGZhbHNlOwogICAgfQoKICAgIC8qKgogICAgICogVmFsaWRhdGUg\ndGhhdCB0aGlzIGZpZWxkIGNhbiBiZSB1c2VkIGZvciBMUlMuCiAgICAgKi8K\nICAgIHByaXZhdGUgdm9pZCB2YWxpZGF0ZUxSUygpIHsKICAgICAgICBpZiAo\nIWlzTFJTKCkpCiAgICAgICAgICAgIHJldHVybjsKCiAgICAgICAgLy8gY2Fu\nJ3QgdXNlIGxycyBmb3IgYXJyYXlzCiAgICAgICAgaWYgKGdldFR5cGVDb2Rl\nKCkgPT0gSmF2YVR5cGVzLkFSUkFZKQogICAgICAgICAgICB0aHJvdyBuZXcg\nTWV0YURhdGFFeGNlcHRpb24oX2xvYy5nZXQoImJhZC1scnMtYXJyYXkiLCB0\naGlzKSk7CgogICAgICAgIC8vIGNhbid0IHVzZSBscnMgZm9yIGV4dGVybmFs\naXplZCB2YWxzCiAgICAgICAgaWYgKGdldEV4dGVybmFsaXplck1ldGhvZCgp\nICE9IG51bGwpCiAgICAgICAgICAgIHRocm93IG5ldyBNZXRhRGF0YUV4Y2Vw\ndGlvbihfbG9jLmdldCgiYmFkLWxycy1leHRlcm4iLCB0aGlzKSk7CgogICAg\nICAgIC8vIGNhbid0IHVzZSBscnMgZm9yIGNvbmNyZXRlIHR5cGVzCiAgICAg\nICAgaWYgKGdldFR5cGUoKSAhPSBDb2xsZWN0aW9uLmNsYXNzICYmIGdldFR5\ncGUoKSAhPSBNYXAuY2xhc3MKICAgICAgICAgICAgJiYgZ2V0VHlwZSgpICE9\nIFNldC5jbGFzcykKICAgICAgICAgICAgdGhyb3cgbmV3IE1ldGFEYXRhRXhj\nZXB0aW9uKF9sb2MuZ2V0KCJiYWQtbHJzLWNvbmNyZXRlIiwgdGhpcykpOwog\nICAgfQoKICAgIC8qKgogICAgICogVmFsaWRhdGUgdGhhdCB0aGlzIGZpZWxk\nIGlzIHN1cHBvcnRlZCBieSB0aGUgcnVudGltZS4KICAgICAqLwogICAgcHJp\ndmF0ZSB2b2lkIHZhbGlkYXRlU3VwcG9ydGVkVHlwZSgpIHsKICAgICAgICAv\nLyBsb2cgd2FybmluZ3MgYWJvdXQgdGhpbmdzIHdlIGRvbid0IGhhbmRsZQog\nICAgICAgIE9wZW5KUEFDb25maWd1cmF0aW9uIGNvbmYgPSBnZXRSZXBvc2l0\nb3J5KCkuZ2V0Q29uZmlndXJhdGlvbigpOwogICAgICAgIENvbGxlY3Rpb248\nU3RyaW5nPiBvcHRzID0gY29uZi5zdXBwb3J0ZWRPcHRpb25zKCk7CiAgICAg\nICAgTG9nIGxvZyA9IGNvbmYuZ2V0TG9nKE9wZW5KUEFDb25maWd1cmF0aW9u\nLkxPR19NRVRBREFUQSk7CiAgICAgICAgc3dpdGNoIChnZXRUeXBlQ29kZSgp\nKSB7CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLlBDOgogICAgICAgICAg\nICAgICAgaWYgKGlzRW1iZWRkZWQoKSAmJiAhb3B0cy5jb250YWlucygKICAg\nICAgICAgICAgICAgIAlPcGVuSlBBQ29uZmlndXJhdGlvbi5PUFRJT05fRU1C\nRURERURfUkVMQVRJT04pKSB7CiAgICAgICAgICAgICAgICAgICAgc2V0RW1i\nZWRkZWQoZmFsc2UpOwogICAgICAgICAgICAgICAgICAgIGlmIChsb2cuaXNX\nYXJuRW5hYmxlZCgpKQogICAgICAgICAgICAgICAgICAgICAgICBsb2cud2Fy\nbihfbG9jLmdldCgiY2FudC1lbWJlZCIsIHRoaXMpKTsKICAgICAgICAgICAg\nICAgIH0gZWxzZQogICAgICAgICAgICAgICAgaWYgKGlzRW1iZWRkZWQoKSAm\nJiBnZXREZWNsYXJlZFR5cGVDb2RlKCkgIT0gSmF2YVR5cGVzLlBDKSB7CiAg\nICAgICAgICAgICAgICAgICAgc2V0RW1iZWRkZWQoZmFsc2UpOwogICAgICAg\nICAgICAgICAgICAgIGlmIChsb2cuaXNXYXJuRW5hYmxlZCgpKQogICAgICAg\nICAgICAgICAgICAgICAgICBsb2cud2FybihfbG9jLmdldCgiY2FudC1lbWJl\nZC1leHRlcm4iLCB0aGlzKSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAg\nICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuQ09M\nTEVDVElPTjoKICAgICAgICAgICAgICAgIGlmICghb3B0cy5jb250YWlucyhP\ncGVuSlBBQ29uZmlndXJhdGlvbi5PUFRJT05fVFlQRV9DT0xMRUNUSU9OKSkK\nICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgVW5zdXBwb3J0ZWRFeGNl\ncHRpb24oCiAgICAgICAgICAgICAgICAgICAgICAgIF9sb2MuZ2V0KCJ0eXBl\nLW5vdC1zdXBwb3J0ZWQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAg\nIkNvbGxlY3Rpb24iLCB0aGlzKSk7CiAgICAgICAgICAgICAgICBpZiAoX2Vs\nZW0uaXNFbWJlZGRlZFBDKCkgJiYgIW9wdHMuY29udGFpbnMoCiAgICAgICAg\nICAgICAgICAgICAgT3BlbkpQQUNvbmZpZ3VyYXRpb24uT1BUSU9OX0VNQkVE\nREVEX0NPTExFQ1RJT05fUkVMQVRJT04pKXsKICAgICAgICAgICAgICAgICAg\nICBfZWxlbS5zZXRFbWJlZGRlZChmYWxzZSk7CiAgICAgICAgICAgICAgICAg\nICAgaWYgKGxvZy5pc1dhcm5FbmFibGVkKCkpCiAgICAgICAgICAgICAgICAg\nICAgICAgIGxvZy53YXJuKF9sb2MuZ2V0KCJjYW50LWVtYmVkLWVsZW1lbnQi\nLCB0aGlzKSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBi\ncmVhazsKICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuQVJSQVk6CiAgICAg\nICAgICAgICAgICBpZiAoIW9wdHMuY29udGFpbnMoT3BlbkpQQUNvbmZpZ3Vy\nYXRpb24uT1BUSU9OX1RZUEVfQVJSQVkpKQogICAgICAgICAgICAgICAgICAg\nIHRocm93IG5ldyBVbnN1cHBvcnRlZEV4Y2VwdGlvbigKICAgICAgICAgICAg\nICAgICAgICAgICAgX2xvYy5nZXQoInR5cGUtbm90LXN1cHBvcnRlZCIsCiAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAiQXJyYXkiLCB0aGlzKSk7CiAg\nICAgICAgICAgICAgICBpZiAoX2VsZW0uaXNFbWJlZGRlZFBDKCkgJiYgIW9w\ndHMuY29udGFpbnMoCiAgICAgICAgICAgICAgICAgICAgT3BlbkpQQUNvbmZp\nZ3VyYXRpb24uT1BUSU9OX0VNQkVEREVEX0NPTExFQ1RJT05fUkVMQVRJT04p\nKSB7CiAgICAgICAgICAgICAgICAgICAgX2VsZW0uc2V0RW1iZWRkZWQoZmFs\nc2UpOwogICAgICAgICAgICAgICAgICAgIGlmIChsb2cuaXNXYXJuRW5hYmxl\nZCgpKQogICAgICAgICAgICAgICAgICAgICAgICBsb2cud2FybihfbG9jLmdl\ndCgiY2FudC1lbWJlZC1lbGVtZW50IiwgdGhpcykpOwogICAgICAgICAgICAg\nICAgfQogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2Ug\nSmF2YVR5cGVzLk1BUDoKICAgICAgICAgICAgICAgIGlmICghb3B0cy5jb250\nYWlucyhPcGVuSlBBQ29uZmlndXJhdGlvbi5PUFRJT05fVFlQRV9NQVApKQog\nICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBVbnN1cHBvcnRlZEV4Y2Vw\ndGlvbigKICAgICAgICAgICAgICAgICAgICAgICAgX2xvYy5nZXQoInR5cGUt\nbm90LXN1cHBvcnRlZCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAi\nTWFwIiwgdGhpcykpOwogICAgICAgICAgICAgICAgaWYgKF9lbGVtLmlzRW1i\nZWRkZWRQQygpICYmICFvcHRzLmNvbnRhaW5zKAogICAgICAgICAgICAgICAg\nCU9wZW5KUEFDb25maWd1cmF0aW9uLk9QVElPTl9FTUJFRERFRF9NQVBfUkVM\nQVRJT04pKSB7CiAgICAgICAgICAgICAgICAgICAgX2VsZW0uc2V0RW1iZWRk\nZWQoZmFsc2UpOwogICAgICAgICAgICAgICAgICAgIGlmIChsb2cuaXNXYXJu\nRW5hYmxlZCgpKQogICAgICAgICAgICAgICAgICAgICAgICBsb2cud2Fybihf\nbG9jLmdldCgiY2FudC1lbWJlZC1lbGVtZW50IiwgdGhpcykpOwogICAgICAg\nICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKF9rZXkuaXNFbWJlZGRl\nZFBDKCkgJiYgIW9wdHMuY29udGFpbnMoCiAgICAgICAgICAgICAgICAJT3Bl\nbkpQQUNvbmZpZ3VyYXRpb24uT1BUSU9OX0VNQkVEREVEX01BUF9SRUxBVElP\nTikpIHsKICAgICAgICAgICAgICAgICAgICBfa2V5LnNldEVtYmVkZGVkKGZh\nbHNlKTsKICAgICAgICAgICAgICAgICAgICBpZiAobG9nLmlzV2FybkVuYWJs\nZWQoKSkKICAgICAgICAgICAgICAgICAgICAgICAgbG9nLndhcm4oX2xvYy5n\nZXQoImNhbnQtZW1iZWQta2V5IiwgdGhpcykpOwogICAgICAgICAgICAgICAg\nfQogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgfQoKICAg\nIC8qKgogICAgICogVmFsaWRhdGUgb3VyIHZhbHVlIHN0cmF0ZWd5LgogICAg\nICovCiAgICBwcml2YXRlIHZvaWQgdmFsaWRhdGVWYWx1ZSgpIHsKICAgICAg\nICBpZiAoZ2V0RXh0ZXJuYWxpemVyTWV0aG9kKCkgIT0gbnVsbCAmJiBnZXRF\neHRlcm5hbFZhbHVlTWFwKCkgIT0gbnVsbCkKICAgICAgICAgICAgdGhyb3cg\nbmV3IE1ldGFEYXRhRXhjZXB0aW9uKF9sb2MuZ2V0KCJleHRlcm4tZXh0ZXJu\ndmFsdWVzIiwgdGhpcykpOwogICAgICAgIGlmIChnZXRWYWx1ZVN0cmF0ZWd5\nKCkgPT0gVmFsdWVTdHJhdGVnaWVzLlNFUVVFTkNFCiAgICAgICAgICAgICYm\nIGdldFZhbHVlU2VxdWVuY2VOYW1lKCkgPT0gbnVsbCkKICAgICAgICAgICAg\ndGhyb3cgbmV3IE1ldGFEYXRhRXhjZXB0aW9uKF9sb2MuZ2V0KCJuby1zZXEt\nbmFtZSIsIHRoaXMpKTsKICAgICAgICBWYWx1ZVN0cmF0ZWdpZXMuYXNzZXJ0\nU3VwcG9ydGVkKGdldFZhbHVlU3RyYXRlZ3koKSwgdGhpcywKICAgICAgICAg\nICAgInZhbHVlIHN0cmF0ZWd5Iik7CiAgICB9CgogICAgLyoqCiAgICAgKiBD\nb3B5IHN0YXRlIGZyb20gdGhlIGdpdmVuIGZpZWxkIHRvIHRoaXMgb25lLiBE\nbyBub3QgY29weSBtYXBwaW5nCiAgICAgKiBpbmZvcm1hdGlvbi4KICAgICAq\nLwogICAgcHVibGljIHZvaWQgY29weShGaWVsZE1ldGFEYXRhIGZpZWxkKSB7\nCiAgICAgICAgc3VwZXIuY29weShmaWVsZCk7CgogICAgICAgIF9pbnRlcm1l\nZGlhdGUgPSBmaWVsZC51c2VzSW50ZXJtZWRpYXRlKCk7CiAgICAgICAgX2lt\ncGxEYXRhID0gZmllbGQudXNlc0ltcGxEYXRhKCk7CgogICAgICAgIC8vIGNv\ncHkgZmllbGQtbGV2ZWwgaW5mbzsgdXNlIGdldCBtZXRob2RzIHRvIGZvcmNl\nIHJlc29sdXRpb24gb2YKICAgICAgICAvLyBsYXp5IGRhdGEKICAgICAgICBf\ncHJveHlDbGFzcyA9IGZpZWxkLmdldFByb3h5VHlwZSgpOwogICAgICAgIF9p\nbml0aWFsaXplciA9IGZpZWxkLmdldEluaXRpYWxpemVyKCk7CiAgICAgICAg\nX3RyYW5zaWVudCA9IGZpZWxkLmlzVHJhbnNpZW50KCk7CiAgICAgICAgX251\nbGxWYWx1ZSA9IGZpZWxkLmdldE51bGxWYWx1ZSgpOwogICAgICAgIF9tYW5h\nZ2UgPSBmaWVsZC5nZXRNYW5hZ2VtZW50KCk7CiAgICAgICAgX2V4cGxpY2l0\nID0gZmllbGQuaXNFeHBsaWNpdCgpOwogICAgICAgIF9leHROYW1lID0gZmll\nbGQuZ2V0RXh0ZXJuYWxpemVyKCk7CiAgICAgICAgX2V4dE1ldGhvZCA9IERF\nRkFVTFRfTUVUSE9EOwogICAgICAgIF9mYWN0TmFtZSA9IGZpZWxkLmdldEZh\nY3RvcnkoKTsKICAgICAgICBfZmFjdE1ldGhvZCA9IERFRkFVTFRfTUVUSE9E\nOwogICAgICAgIF9leHRTdHJpbmcgPSBmaWVsZC5nZXRFeHRlcm5hbFZhbHVl\ncygpOwogICAgICAgIF9leHRWYWx1ZXMgPSBDb2xsZWN0aW9ucy5FTVBUWV9N\nQVA7CiAgICAgICAgX2ZpZWxkVmFsdWVzID0gQ29sbGVjdGlvbnMuRU1QVFlf\nTUFQOwogICAgICAgIF9wcmltS2V5ID0gZmllbGQuaXNQcmltYXJ5S2V5KCk7\nCiAgICAgICAgX2JhY2tpbmdNZW1iZXIgPSBmaWVsZC5fYmFja2luZ01lbWJl\ncjsKICAgICAgICBfZW51bUZpZWxkID0gZmllbGQuX2VudW1GaWVsZDsKICAg\nICAgICBfbG9iRmllbGQgPSBmaWVsZC5fbG9iRmllbGQ7CiAgICAgICAgX3Nl\ncmlhbGl6YWJsZUZpZWxkID0gZmllbGQuX3NlcmlhbGl6YWJsZUZpZWxkOwog\nICAgICAgIF9nZW5lcmF0ZWQgPSBmaWVsZC5fZ2VuZXJhdGVkOwogICAgICAg\nIF9tYXBwZWRCeUlkVmFsdWUgPSBmaWVsZC5fbWFwcGVkQnlJZFZhbHVlOwog\nICAgICAgIF9pc0VsZW1lbnRDb2xsZWN0aW9uID0gZmllbGQuX2lzRWxlbWVu\ndENvbGxlY3Rpb247CiAgICAgICAgX2FjY2VzcyA9IGZpZWxkLl9hY2Nlc3M7\nCiAgICAgICAgX29yZGVyRGVjID0gZmllbGQuX29yZGVyRGVjOwoKICAgICAg\nICAvLyBlbWJlZGRlZCBmaWVsZHMgY2FuJ3QgYmUgdmVyc2lvbnMKICAgICAg\nICBpZiAoX293bmVyLmdldEVtYmVkZGluZ01ldGFEYXRhKCkgPT0gbnVsbCAm\nJiBfdmVyc2lvbiA9PSBudWxsKQogICAgICAgICAgICBfdmVyc2lvbiA9IChm\naWVsZC5pc1ZlcnNpb24oKSkgPyBCb29sZWFuLlRSVUUgOiBCb29sZWFuLkZB\nTFNFOwoKICAgICAgICAvLyBvbmx5IGNvcHkgdGhpcyBkYXRhIGlmIG5vdCBh\nbHJlYWR5IHNldCBleHBsaWNpdGx5IGluIHRoaXMgaW5zdGFuY2UKICAgICAg\nICBpZiAoX2RmZyA9PSAwKSB7CiAgICAgICAgICAgIF9kZmcgPSAoZmllbGQu\naXNJbkRlZmF1bHRGZXRjaEdyb3VwKCkpID8gREZHX1RSVUUgOiBERkdfRkFM\nU0U7CiAgICAgICAgICAgIGlmIChmaWVsZC5pc0RlZmF1bHRGZXRjaEdyb3Vw\nRXhwbGljaXQoKSkKICAgICAgICAgICAgICAgIF9kZmcgfD0gREZHX0VYUExJ\nQ0lUOwogICAgICAgIH0KICAgICAgICBpZiAoX2ZnU2V0ID09IG51bGwgJiYg\nZmllbGQuX2ZnU2V0ICE9IG51bGwpCiAgICAgICAgICAgIF9mZ1NldCA9IG5l\ndyBIYXNoU2V0KGZpZWxkLl9mZ1NldCk7CiAgICAgICAgaWYgKF9sZmcgPT0g\nbnVsbCkKICAgICAgICAgICAgX2xmZyA9IGZpZWxkLmdldExvYWRGZXRjaEdy\nb3VwKCk7CiAgICAgICAgaWYgKF9scnMgPT0gbnVsbCkKICAgICAgICAgICAg\nX2xycyA9IChmaWVsZC5pc0xSUygpKSA/IEJvb2xlYW4uVFJVRSA6IEJvb2xl\nYW4uRkFMU0U7CiAgICAgICAgaWYgKF92YWxTdHJhdGVneSA9PSAtMSkKICAg\nICAgICAgICAgX3ZhbFN0cmF0ZWd5ID0gZmllbGQuZ2V0VmFsdWVTdHJhdGVn\neSgpOwogICAgICAgIGlmIChfdXBTdHJhdGVneSA9PSAtMSkKICAgICAgICAg\nICAgX3VwU3RyYXRlZ3kgPSBmaWVsZC5nZXRVcGRhdGVTdHJhdGVneSgpOwog\nICAgICAgIGlmIChDbGFzc01ldGFEYXRhLkRFRkFVTFRfU1RSSU5HLmVxdWFs\ncyhfc2VxTmFtZSkpIHsKICAgICAgICAgICAgX3NlcU5hbWUgPSBmaWVsZC5n\nZXRWYWx1ZVNlcXVlbmNlTmFtZSgpOwogICAgICAgICAgICBfc2VxTWV0YSA9\nIG51bGw7CiAgICAgICAgfQogICAgICAgIGlmIChDbGFzc01ldGFEYXRhLkRF\nRkFVTFRfU1RSSU5HLmVxdWFscyhfaW52ZXJzZSkpCiAgICAgICAgICAgIF9p\nbnZlcnNlID0gZmllbGQuZ2V0SW52ZXJzZSgpOwoKICAgICAgICAvLyBjb3B5\nIHZhbHVlIG1ldGFkYXRhCiAgICAgICAgX3ZhbC5jb3B5KGZpZWxkKTsKICAg\nICAgICBfa2V5LmNvcHkoZmllbGQuZ2V0S2V5KCkpOwogICAgICAgIF9lbGVt\nLmNvcHkoZmllbGQuZ2V0RWxlbWVudCgpKTsKICAgIH0KCiAgICBwcm90ZWN0\nZWQgdm9pZCBhZGRFeHRlbnNpb25LZXlzKENvbGxlY3Rpb24gZXh0cykgewog\nICAgICAgIGdldFJlcG9zaXRvcnkoKS5nZXRNZXRhRGF0YUZhY3RvcnkoKS5h\nZGRGaWVsZEV4dGVuc2lvbktleXMoZXh0cyk7CiAgICB9CgogICAgLy8vLy8v\nLy8vLy8vLy8vCiAgICAvLyBDb21tZW50YWJsZQogICAgLy8vLy8vLy8vLy8v\nLy8vCgogICAgcHVibGljIFN0cmluZ1tdIGdldENvbW1lbnRzKCkgewogICAg\nICAgIHJldHVybiAoX2NvbW1lbnRzID09IG51bGwpID8gRU1QVFlfQ09NTUVO\nVFMgOiBfY29tbWVudHM7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0Q29t\nbWVudHMoU3RyaW5nW10gY29tbWVudHMpIHsKICAgICAgICBfY29tbWVudHMg\nPSBjb21tZW50czsKICAgIH0KCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8v\nLy8vLy8vLy8vLwogICAgLy8gVmFsdWVNZXRhRGF0YSBpbXBsZW1lbnRhdGlv\nbgogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KCiAgICBw\ndWJsaWMgRmllbGRNZXRhRGF0YSBnZXRGaWVsZE1ldGFEYXRhKCkgewogICAg\nICAgIHJldHVybiB0aGlzOwogICAgfQoKICAgIHB1YmxpYyBDbGFzcyBnZXRU\neXBlKCkgewogICAgICAgIHJldHVybiBfdmFsLmdldFR5cGUoKTsKICAgIH0K\nCiAgICBwdWJsaWMgdm9pZCBzZXRUeXBlKENsYXNzIHR5cGUpIHsKICAgICAg\nICBfdmFsLnNldFR5cGUodHlwZSk7CiAgICAgICAgaWYgKHR5cGUuaXNBcnJh\neSgpKQogICAgICAgICAgICBfZWxlbS5zZXRUeXBlKHR5cGUuZ2V0Q29tcG9u\nZW50VHlwZSgpKTsKICAgICAgICBlbHNlIGlmICh0eXBlID09IFByb3BlcnRp\nZXMuY2xhc3MpIHsKICAgICAgICAgICAgX2tleS5zZXRUeXBlKFN0cmluZy5j\nbGFzcyk7CiAgICAgICAgICAgIF9lbGVtLnNldFR5cGUoU3RyaW5nLmNsYXNz\nKTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGljIGludCBnZXRUeXBlQ29k\nZSgpIHsKICAgICAgICByZXR1cm4gX3ZhbC5nZXRUeXBlQ29kZSgpOwogICAg\nfQoKICAgIHB1YmxpYyB2b2lkIHNldFR5cGVDb2RlKGludCBjb2RlKSB7CiAg\nICAgICAgX3ZhbC5zZXRUeXBlQ29kZShjb2RlKTsKICAgIH0KCiAgICBwdWJs\naWMgYm9vbGVhbiBpc1R5cGVQQygpIHsKICAgICAgICByZXR1cm4gX3ZhbC5p\nc1R5cGVQQygpOwogICAgfQoKICAgIHB1YmxpYyBDbGFzc01ldGFEYXRhIGdl\ndFR5cGVNZXRhRGF0YSgpIHsKICAgICAgICByZXR1cm4gX3ZhbC5nZXRUeXBl\nTWV0YURhdGEoKTsKICAgIH0KCiAgICBwdWJsaWMgQ2xhc3MgZ2V0RGVjbGFy\nZWRUeXBlKCkgewogICAgICAgIHJldHVybiBfdmFsLmdldERlY2xhcmVkVHlw\nZSgpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldERlY2xhcmVkVHlwZShD\nbGFzcyB0eXBlKSB7CiAgICAgICAgX3ZhbC5zZXREZWNsYXJlZFR5cGUodHlw\nZSk7CiAgICAgICAgaWYgKHR5cGUuaXNBcnJheSgpKQogICAgICAgICAgICBf\nZWxlbS5zZXREZWNsYXJlZFR5cGUodHlwZS5nZXRDb21wb25lbnRUeXBlKCkp\nOwogICAgICAgIGVsc2UgaWYgKHR5cGUgPT0gUHJvcGVydGllcy5jbGFzcykg\newogICAgICAgICAgICBfa2V5LnNldERlY2xhcmVkVHlwZShTdHJpbmcuY2xh\nc3MpOwogICAgICAgICAgICBfZWxlbS5zZXREZWNsYXJlZFR5cGUoU3RyaW5n\nLmNsYXNzKTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGljIGludCBnZXRE\nZWNsYXJlZFR5cGVDb2RlKCkgewogICAgICAgIHJldHVybiBfdmFsLmdldERl\nY2xhcmVkVHlwZUNvZGUoKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRE\nZWNsYXJlZFR5cGVDb2RlKGludCB0eXBlKSB7CiAgICAgICAgX3ZhbC5zZXRE\nZWNsYXJlZFR5cGVDb2RlKHR5cGUpOwogICAgfQoKICAgIHB1YmxpYyBib29s\nZWFuIGlzRGVjbGFyZWRUeXBlUEMoKSB7CiAgICAgICAgcmV0dXJuIF92YWwu\naXNEZWNsYXJlZFR5cGVQQygpOwogICAgfQoKICAgIHB1YmxpYyBDbGFzc01l\ndGFEYXRhIGdldERlY2xhcmVkVHlwZU1ldGFEYXRhKCkgewogICAgICAgIHJl\ndHVybiBfdmFsLmdldERlY2xhcmVkVHlwZU1ldGFEYXRhKCk7CiAgICB9Cgog\nICAgcHVibGljIGJvb2xlYW4gaXNFbWJlZGRlZCgpIHsKICAgICAgICByZXR1\ncm4gX3ZhbC5pc0VtYmVkZGVkKCk7CiAgICB9CgogICAgcHVibGljIHZvaWQg\nc2V0RW1iZWRkZWQoYm9vbGVhbiBlbWJlZGRlZCkgewogICAgICAgIF92YWwu\nc2V0RW1iZWRkZWQoZW1iZWRkZWQpOwogICAgfQoKICAgIHB1YmxpYyBib29s\nZWFuIGlzRW1iZWRkZWRQQygpIHsKICAgICAgICByZXR1cm4gX3ZhbC5pc0Vt\nYmVkZGVkUEMoKTsKICAgIH0KCiAgICBwdWJsaWMgQ2xhc3NNZXRhRGF0YSBn\nZXRFbWJlZGRlZE1ldGFEYXRhKCkgewogICAgICAgIHJldHVybiBfdmFsLmdl\ndEVtYmVkZGVkTWV0YURhdGEoKTsKICAgIH0KCiAgICBwdWJsaWMgQ2xhc3NN\nZXRhRGF0YSBhZGRFbWJlZGRlZE1ldGFEYXRhKGludCBhY2Nlc3MpIHsKICAg\nICAgICByZXR1cm4gX3ZhbC5hZGRFbWJlZGRlZE1ldGFEYXRhKGFjY2Vzcyk7\nCiAgICB9CiAgICBwdWJsaWMgQ2xhc3NNZXRhRGF0YSBhZGRFbWJlZGRlZE1l\ndGFEYXRhKCkgewogICAgICAgIHJldHVybiBfdmFsLmFkZEVtYmVkZGVkTWV0\nYURhdGEoKTsKICAgIH0KCiAgICBwdWJsaWMgaW50IGdldENhc2NhZGVEZWxl\ndGUoKSB7CiAgICAgICAgcmV0dXJuIF92YWwuZ2V0Q2FzY2FkZURlbGV0ZSgp\nOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldENhc2NhZGVEZWxldGUoaW50\nIGRlbGV0ZSkgewogICAgICAgIF92YWwuc2V0Q2FzY2FkZURlbGV0ZShkZWxl\ndGUpOwogICAgfQoKICAgIHB1YmxpYyBpbnQgZ2V0Q2FzY2FkZVBlcnNpc3Qo\nKSB7CiAgICAgICAgcmV0dXJuIF92YWwuZ2V0Q2FzY2FkZVBlcnNpc3QoKTsK\nICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRDYXNjYWRlUGVyc2lzdChpbnQg\ncGVyc2lzdCkgewogICAgICAgIF92YWwuc2V0Q2FzY2FkZVBlcnNpc3QocGVy\nc2lzdCk7CiAgICB9CgogICAgcHVibGljIGludCBnZXRDYXNjYWRlQXR0YWNo\nKCkgewogICAgICAgIHJldHVybiBfdmFsLmdldENhc2NhZGVBdHRhY2goKTsK\nICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRDYXNjYWRlQXR0YWNoKGludCBh\ndHRhY2gpIHsKICAgICAgICBfdmFsLnNldENhc2NhZGVBdHRhY2goYXR0YWNo\nKTsKICAgIH0KICAgIAogICAgcHVibGljIGludCBnZXRDYXNjYWRlRGV0YWNo\nKCkgewogICAgICAgIHJldHVybiBfdmFsLmdldENhc2NhZGVEZXRhY2goKTsK\nICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRDYXNjYWRlRGV0YWNoKGludCBk\nZXRhY2gpIHsKICAgICAgICBfdmFsLnNldENhc2NhZGVEZXRhY2goZGV0YWNo\nKTsKICAgIH0KCiAgICBwdWJsaWMgaW50IGdldENhc2NhZGVSZWZyZXNoKCkg\newogICAgICAgIHJldHVybiBfdmFsLmdldENhc2NhZGVSZWZyZXNoKCk7CiAg\nICB9CgogICAgcHVibGljIHZvaWQgc2V0Q2FzY2FkZVJlZnJlc2goaW50IHJl\nZnJlc2gpIHsKICAgICAgICBfdmFsLnNldENhc2NhZGVSZWZyZXNoKHJlZnJl\nc2gpOwogICAgfQoKICAgIHB1YmxpYyBib29sZWFuIGlzU2VyaWFsaXplZCgp\nIHsKICAgICAgICByZXR1cm4gX3ZhbC5pc1NlcmlhbGl6ZWQoKTsKICAgIH0K\nCiAgICBwdWJsaWMgdm9pZCBzZXRTZXJpYWxpemVkKGJvb2xlYW4gc2VyaWFs\naXplZCkgewogICAgICAgIF92YWwuc2V0U2VyaWFsaXplZChzZXJpYWxpemVk\nKTsKICAgIH0KCiAgICBwdWJsaWMgU3RyaW5nIGdldFZhbHVlTWFwcGVkQnko\nKSB7CiAgICAgICAgcmV0dXJuIF92YWwuZ2V0VmFsdWVNYXBwZWRCeSgpOwog\nICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldFZhbHVlTWFwcGVkQnkoU3RyaW5n\nIG1hcHBlZCkgewogICAgICAgIF92YWwuc2V0VmFsdWVNYXBwZWRCeShtYXBw\nZWQpOwogICAgfQoKICAgIHB1YmxpYyBGaWVsZE1ldGFEYXRhIGdldFZhbHVl\nTWFwcGVkQnlNZXRhRGF0YSAoKSB7CgkJcmV0dXJuIF92YWwuZ2V0VmFsdWVN\nYXBwZWRCeU1ldGFEYXRhICgpOwoJfQoKCXB1YmxpYyBDbGFzczw/PiBnZXRU\neXBlT3ZlcnJpZGUgKCkgewoJCXJldHVybiBfdmFsLmdldFR5cGVPdmVycmlk\nZSAoKTsKCX0KCglwdWJsaWMgdm9pZCBzZXRUeXBlT3ZlcnJpZGUoQ2xhc3Mg\ndHlwZSkgewoJCV92YWwuc2V0VHlwZU92ZXJyaWRlICh0eXBlKTsKCX0KCglw\ndWJsaWMgdm9pZCBjb3B5IChWYWx1ZU1ldGFEYXRhIHZtZCkgewoJCV92YWwu\nY29weSAodm1kKTsKCX0KCiAgICAvKioKICAgICAqIENoZWNrIGlmIHRoaXMg\nZmllbGQgaXMgdXNlZCBieSBvdGhlciBmaWVsZCBhcyAib3JkZXIgYnkiIHZh\nbHVlLgogICAgICoKICAgICAqIEBzaW5jZSAxLjEuMAogICAgICovCiAgICBw\ndWJsaWMgYm9vbGVhbiBpc1VzZWRJbk9yZGVyQnkoKSB7CiAgICAJcmV0dXJu\nIF91c2VkSW5PcmRlckJ5OwogICAgfQogICAgCiAgICAvKioKICAgICAqIFdo\nZXRoZXIgdGhpcyBmaWVsZCBpcyB1c2VkIGJ5IG90aGVyIGZpZWxkIGFzICJv\ncmRlciBieSIgdmFsdWUgLgogICAgICoKICAgICAqIEBzaW5jZSAxLjEuMAog\nICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRVc2VkSW5PcmRlckJ5KGJvb2xl\nYW4gaXNVc2VkKSB7CiAgICAJX3VzZWRJbk9yZGVyQnkgPSBpc1VzZWQ7CiAg\nICB9CiAgICAKICAgIC8qKgogICAgICogU2VyaWFsaXphYmxlIHdyYXBwZXIg\nYXJvdW5kIGEge0BsaW5rIE1ldGhvZH0gb3Ige0BsaW5rIEZpZWxkfS4gRm9y\nIAogICAgICogc3BhY2UgY29uc2lkZXJhdGlvbnMsIHRoaXMgZG9lcyBub3Qg\nc3VwcG9ydCB7QGxpbmsgQ29uc3RydWN0b3J9cy4KICAgICAqLwoJcHVibGlj\nIHN0YXRpYyBjbGFzcyBNZW1iZXJQcm92aWRlcgogICAgICAgIGltcGxlbWVu\ndHMgRXh0ZXJuYWxpemFibGUgewoKICAgICAgICBwcml2YXRlIHRyYW5zaWVu\ndCBNZW1iZXIgX21lbWJlcjsKCiAgICAgICAgcHVibGljIE1lbWJlclByb3Zp\nZGVyKCkgewogICAgICAgICAgICAvLyBmb3IgZXh0ZXJuYWxpemF0aW9uCiAg\nICAgICAgfQoKICAgICAgICBNZW1iZXJQcm92aWRlcihNZW1iZXIgbWVtYmVy\nKSB7CiAgICAgICAgICAgIGlmIChtZW1iZXIgaW5zdGFuY2VvZiBDb25zdHJ1\nY3RvcikKICAgICAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1l\nbnRFeGNlcHRpb24oKTsKCiAgICAgICAgICAgIF9tZW1iZXIgPSBtZW1iZXI7\nCiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgTWVtYmVyIGdldE1lbWJlcigp\nIHsKICAgICAgICAgICAgcmV0dXJuIF9tZW1iZXI7CiAgICAgICAgfQoKICAg\nICAgICBwdWJsaWMgdm9pZCByZWFkRXh0ZXJuYWwoT2JqZWN0SW5wdXQgaW4p\nCiAgICAgICAgICAgIHRocm93cyBJT0V4Y2VwdGlvbiwgQ2xhc3NOb3RGb3Vu\nZEV4Y2VwdGlvbiB7CiAgICAgICAgICAgIGJvb2xlYW4gaXNGaWVsZCA9IGlu\nLnJlYWRCb29sZWFuKCk7CiAgICAgICAgICAgIENsYXNzPD8+IGNscyA9IChD\nbGFzczw/PikgaW4ucmVhZE9iamVjdCgpOwogICAgICAgICAgICBTdHJpbmcg\nbWVtYmVyTmFtZSA9IChTdHJpbmcpIGluLnJlYWRPYmplY3QoKTsKICAgICAg\nICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIGlmIChpc0ZpZWxkKQogICAg\nICAgICAgICAgICAgICAgIF9tZW1iZXIgPSBBY2Nlc3NDb250cm9sbGVyLmRv\nUHJpdmlsZWdlZCgKICAgICAgICAgICAgICAgICAgICAgICAgSjJEb1ByaXZI\nZWxwZXIuZ2V0RGVjbGFyZWRGaWVsZEFjdGlvbigKICAgICAgICAgICAgICAg\nICAgICAgICAgICAgIGNscywgbWVtYmVyTmFtZSkpOyAKICAgICAgICAgICAg\nICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgIENsYXNzPD8+W10gcGFy\nYW1ldGVyVHlwZXMgPSAoQ2xhc3NbXSkgaW4ucmVhZE9iamVjdCgpOwogICAg\nICAgICAgICAgICAgICAgIF9tZW1iZXIgPSBBY2Nlc3NDb250cm9sbGVyLmRv\nUHJpdmlsZWdlZCgKICAgICAgICAgICAgICAgICAgICAgICAgSjJEb1ByaXZI\nZWxwZXIuZ2V0RGVjbGFyZWRNZXRob2RBY3Rpb24oCiAgICAgICAgICAgICAg\nICAgICAgICAgICAgICBjbHMsIG1lbWJlck5hbWUsIHBhcmFtZXRlclR5cGVz\nKSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gY2F0Y2ggKFNl\nY3VyaXR5RXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgICAgIElPRXhjZXB0\naW9uIGlvZSA9IG5ldyBJT0V4Y2VwdGlvbihlLmdldE1lc3NhZ2UoKSk7CiAg\nICAgICAgICAgICAgICBpb2UuaW5pdENhdXNlKGUpOwogICAgICAgICAgICAg\nICAgdGhyb3cgaW9lOwogICAgICAgICAgICB9IGNhdGNoIChQcml2aWxlZ2Vk\nQWN0aW9uRXhjZXB0aW9uIHBhZSkgewogICAgICAgICAgICAgICAgSU9FeGNl\ncHRpb24gaW9lID0gbmV3IElPRXhjZXB0aW9uKAogICAgICAgICAgICAgICAg\nICAgIHBhZS5nZXRFeGNlcHRpb24oKS5nZXRNZXNzYWdlKCkpOwogICAgICAg\nICAgICAgICAgaW9lLmluaXRDYXVzZShwYWUpOwogICAgICAgICAgICAgICAg\ndGhyb3cgaW9lOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBw\ndWJsaWMgdm9pZCB3cml0ZUV4dGVybmFsKE9iamVjdE91dHB1dCBvdXQpCiAg\nICAgICAgICAgIHRocm93cyBJT0V4Y2VwdGlvbiB7CiAgICAgICAgICAgIGJv\nb2xlYW4gaXNGaWVsZCA9IF9tZW1iZXIgaW5zdGFuY2VvZiBGaWVsZDsKICAg\nICAgICAgICAgb3V0LndyaXRlQm9vbGVhbihpc0ZpZWxkKTsKICAgICAgICAg\nICAgb3V0LndyaXRlT2JqZWN0KF9tZW1iZXIuZ2V0RGVjbGFyaW5nQ2xhc3Mo\nKSk7CiAgICAgICAgICAgIG91dC53cml0ZU9iamVjdChfbWVtYmVyLmdldE5h\nbWUoKSk7CiAgICAgICAgICAgIGlmICghaXNGaWVsZCkKICAgICAgICAgICAg\nICAgIG91dC53cml0ZU9iamVjdCgoKE1ldGhvZCkgX21lbWJlcikuZ2V0UGFy\nYW1ldGVyVHlwZXMoKSk7CiAgICAgICAgfQogICAgfQoKICAgIHB1YmxpYyBi\nb29sZWFuIGlzVmFsdWVHZW5lcmF0ZWQoKSB7CiAgICAgICAgcmV0dXJuIF9n\nZW5lcmF0ZWQ7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0VmFsdWVHZW5l\ncmF0ZWQoYm9vbGVhbiBnZW5lcmF0ZWQpIHsKICAgICAgICB0aGlzLl9nZW5l\ncmF0ZWQgPSBnZW5lcmF0ZWQ7CiAgICB9CgogICAgcHVibGljIGJvb2xlYW4g\naXNFbGVtZW50Q29sbGVjdGlvbigpIHsKICAgICAgICByZXR1cm4gX2lzRWxl\nbWVudENvbGxlY3Rpb247CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0RWxl\nbWVudENvbGxlY3Rpb24oYm9vbGVhbiBpc0VsZW1lbnRDb2xsZWN0aW9uKSB7\nCiAgICAgICAgdGhpcy5faXNFbGVtZW50Q29sbGVjdGlvbiA9IGlzRWxlbWVu\ndENvbGxlY3Rpb247CiAgICB9CgogICAgcHVibGljIFN0cmluZyBnZXRNYXBw\nZWRCeUlkVmFsdWUoKSB7CiAgICAgICAgcmV0dXJuIF9tYXBwZWRCeUlkVmFs\ndWU7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0TWFwcGVkQnlJZFZhbHVl\nKFN0cmluZyBtYXBwZWRCeUlkVmFsdWUpIHsKICAgICAgICB0aGlzLl9tYXBw\nZWRCeUlkVmFsdWUgPSBtYXBwZWRCeUlkVmFsdWU7CiAgICB9CiAgICAKICAg\nIHB1YmxpYyBib29sZWFuIGlzTWFwcGVkQnlJZCgpIHsKICAgIAlyZXR1cm4g\nKF9tYXBwZWRCeUlkVmFsdWUgIT0gbnVsbCk7CiAgICB9CiAgICAKICAgIC8q\nKgogICAgICogR2V0cyB0aGUgYWNjZXNzIHR5cGUgdXNlZCBieSB0aGlzIGZp\nZWxkLiBJZiBubyBhY2Nlc3MgdHlwZSBpcyBzZXQgZm9yCiAgICAgKiB0aGlz\nIGZpZWxkIHRoZW4gcmV0dXJuIHRoZSBhY2Nlc3MgdHlwZSB1c2VkIGJ5IHRo\nZSBkZWNsYXJpbmcgY2xhc3MuCiAgICAgKi8KICAgIHB1YmxpYyBpbnQgZ2V0\nQWNjZXNzVHlwZSgpIHsKICAgICAgICBpZiAoQWNjZXNzQ29kZS5pc1Vua25v\nd24oX2FjY2VzcykpIHsKICAgICAgICAJaW50IGZDb2RlID0gQWNjZXNzQ29k\nZS50b0ZpZWxkQ29kZShnZXREZWNsYXJpbmdNZXRhRGF0YSgpCiAgICAgICAg\nCQkJLmdldEFjY2Vzc1R5cGUoKSk7CiAgICAgICAgCXJldHVybiBmQ29kZTsK\nICAgICAgICB9CiAgICAgICAgcmV0dXJuIF9hY2Nlc3M7CiAgICB9CiAgICAK\nICAgIC8qKgogICAgICogU2V0cyBhY2Nlc3MgdHlwZSBvZiB0aGlzIGZpZWxk\nLiBUaGUgYWNjZXNzIGNvZGUgaXMgdmVyaWZpZWQgZm9yIHZhbGlkaXR5CiAg\nICAgKiBhcyB3ZWxsIGFzIGFnYWluc3QgdGhlIGFjY2VzcyBzdHlsZSB1c2Vk\nIGJ5IHRoZSBkZWNsYXJpbmcgY2xhc3MuCiAgICAgKi8KICAgIHB1YmxpYyB2\nb2lkIHNldEFjY2Vzc1R5cGUoaW50IGZDb2RlKSB7CiAgICAJQ2xhc3NNZXRh\nRGF0YSBvd25lciA9IGdldERlY2xhcmluZ01ldGFEYXRhKCk7CiAgICAJb3du\nZXIubWVyZ2VGaWVsZEFjY2Vzcyh0aGlzLCBmQ29kZSk7CiAgICAgICAgX2Fj\nY2VzcyA9IGZDb2RlOwogICAgfQogICAgCiAgICBwdWJsaWMgaW50IGdldEFz\nc29jaWF0aW9uVHlwZSgpIHsKICAgICAgICByZXR1cm4gX2Fzc29jaWF0aW9u\nVHlwZTsKICAgIH0KICAgIAogICAgcHVibGljIHZvaWQgc2V0QXNzb2NpYXRp\nb25UeXBlKGludCB0eXBlKSB7CiAgICAgICAgX2Fzc29jaWF0aW9uVHlwZSA9\nIHR5cGU7CiAgICB9CiAgICAKfQo=\n","encoding":"base64"}

