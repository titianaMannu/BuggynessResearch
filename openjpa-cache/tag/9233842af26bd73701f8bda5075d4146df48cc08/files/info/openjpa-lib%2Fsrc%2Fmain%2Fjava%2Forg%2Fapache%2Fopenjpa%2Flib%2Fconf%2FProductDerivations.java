{"sha":"173b7caba2eede2399752cfb0ef9f032d539cd16","node_id":"MDQ6QmxvYjIwNjM2NDoxNzNiN2NhYmEyZWVkZTIzOTk3NTJjZmIwZWY5ZjAzMmQ1MzljZDE2","size":18739,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/173b7caba2eede2399752cfb0ef9f032d539cd16","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEubGliLmNvbmY7CgppbXBvcnQg\namF2YS5pby5GaWxlOwppbXBvcnQgamF2YS5zZWN1cml0eS5BY2Nlc3NDb250\ncm9sbGVyOwppbXBvcnQgamF2YS5zZWN1cml0eS5Qcml2aWxlZ2VkQWN0aW9u\nRXhjZXB0aW9uOwppbXBvcnQgamF2YS51dGlsLkFycmF5TGlzdDsKaW1wb3J0\nIGphdmEudXRpbC5Db2xsZWN0aW9uOwppbXBvcnQgamF2YS51dGlsLkNvbGxl\nY3Rpb25zOwppbXBvcnQgamF2YS51dGlsLkNvbXBhcmF0b3I7CmltcG9ydCBq\nYXZhLnV0aWwuSXRlcmF0b3I7CmltcG9ydCBqYXZhLnV0aWwuTGlzdDsKaW1w\nb3J0IGphdmEudXRpbC5NYXA7CmltcG9ydCBqYXZhLnV0aWwuTWlzc2luZ1Jl\nc291cmNlRXhjZXB0aW9uOwppbXBvcnQgamF2YS51dGlsLlNldDsKaW1wb3J0\nIGphdmEudXRpbC5UcmVlU2V0OwoKaW1wb3J0IG9yZy5hcGFjaGUuY29tbW9u\ncy5sYW5nLlN0cmluZ1V0aWxzOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLmxpYi51dGlsLkoyRG9Qcml2SGVscGVyOwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLmxpYi51dGlsLkphdmFWZXJzaW9uczsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5saWIudXRpbC5Mb2NhbGl6ZXI7CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEubGliLnV0aWwuTXVsdGlDbGFzc0xvYWRlcjsKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5saWIudXRpbC5TZXJ2aWNlczsKCi8qKgog\nKiBVdGlsaXRpZXMgZm9yIHJ1bm5pbmcgcHJvZHVjdCBkZXJpdmF0aW9ucy4K\nICoKICogQGF1dGhvciBBYmUgV2hpdGUKICogQGF1dGhvciBQaW5ha2kgUG9k\nZGFyCiAqIEBub2phdmFkb2MKICovCnB1YmxpYyBjbGFzcyBQcm9kdWN0RGVy\naXZhdGlvbnMgewoKICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIExvY2FsaXpl\nciBfbG9jID0gTG9jYWxpemVyLmZvclBhY2thZ2UKICAgICAgICAoUHJvZHVj\ndERlcml2YXRpb25zLmNsYXNzKTsKCiAgICBwcml2YXRlIHN0YXRpYyBmaW5h\nbCBQcm9kdWN0RGVyaXZhdGlvbltdIF9kZXJpdmF0aW9uczsKICAgIHByaXZh\ndGUgc3RhdGljIGZpbmFsIFN0cmluZ1tdIF9kZXJpdmF0aW9uTmFtZXM7CiAg\nICBwcml2YXRlIHN0YXRpYyBmaW5hbCBUaHJvd2FibGVbXSBfZGVyaXZhdGlv\nbkVycm9yczsKICAgIHByaXZhdGUgc3RhdGljIFN0cmluZ1tdIF9wcmVmaXhl\nczsKICAgIHN0YXRpYyB7CiAgICAgICAgTXVsdGlDbGFzc0xvYWRlciBsID0g\nQWNjZXNzQ29udHJvbGxlci5kb1ByaXZpbGVnZWQoSjJEb1ByaXZIZWxwZXIu\nbmV3TXVsdGlDbGFzc0xvYWRlckFjdGlvbigpKTsKICAgICAgICBsLmFkZENs\nYXNzTG9hZGVyKDAsIEFjY2Vzc0NvbnRyb2xsZXIKICAgICAgICAgICAgLmRv\nUHJpdmlsZWdlZChKMkRvUHJpdkhlbHBlci5nZXRDbGFzc0xvYWRlckFjdGlv\nbihQcm9kdWN0RGVyaXZhdGlvbnMuY2xhc3MpKSk7CiAgICAgICAgbC5hZGRD\nbGFzc0xvYWRlcigxLCBBY2Nlc3NDb250cm9sbGVyLmRvUHJpdmlsZWdlZChK\nMkRvUHJpdkhlbHBlci5nZXRDb250ZXh0Q2xhc3NMb2FkZXJBY3Rpb24oKSkp\nOwogICAgICAgIF9kZXJpdmF0aW9uTmFtZXMgPSBTZXJ2aWNlcy5nZXRJbXBs\nZW1lbnRvcnMoUHJvZHVjdERlcml2YXRpb24uY2xhc3MsIGwpOwogICAgICAg\nIF9kZXJpdmF0aW9uRXJyb3JzID0gbmV3IFRocm93YWJsZVtfZGVyaXZhdGlv\nbk5hbWVzLmxlbmd0aF07CiAgICAgICAgTGlzdDxQcm9kdWN0RGVyaXZhdGlv\nbj4gZGVyaXZhdGlvbnMgPQogICAgICAgICAgICBuZXcgQXJyYXlMaXN0PFBy\nb2R1Y3REZXJpdmF0aW9uPihfZGVyaXZhdGlvbk5hbWVzLmxlbmd0aCk7CiAg\nICAgICAgYm9vbGVhbiBlcnJvcnMgPSBmYWxzZTsgCiAgICAgICAgZm9yIChp\nbnQgaSA9IDA7IGkgPCBfZGVyaXZhdGlvbk5hbWVzLmxlbmd0aDsgaSsrKSB7\nCiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBQcm9kdWN0RGVy\naXZhdGlvbiBkID0gKFByb2R1Y3REZXJpdmF0aW9uKQogICAgICAgICAgICAg\nICAgICAgIEFjY2Vzc0NvbnRyb2xsZXIuZG9Qcml2aWxlZ2VkKAogICAgICAg\nICAgICAgICAgICAgICAgICBKMkRvUHJpdkhlbHBlci5uZXdJbnN0YW5jZUFj\ndGlvbigKICAgICAgICAgICAgICAgICAgICAgICAgICAgIENsYXNzLmZvck5h\nbWUoX2Rlcml2YXRpb25OYW1lc1tpXSwgdHJ1ZSwgbCkpKTsKICAgICAgICAg\nICAgICAgIGQudmFsaWRhdGUoKTsKICAgICAgICAgICAgICAgIGRlcml2YXRp\nb25zLmFkZChkKTsKICAgICAgICAgICAgfSBjYXRjaCAoVGhyb3dhYmxlIHQp\nIHsKICAgICAgICAgICAgICAgIGlmICh0IGluc3RhbmNlb2YgUHJpdmlsZWdl\nZEFjdGlvbkV4Y2VwdGlvbikKICAgICAgICAgICAgICAgICAgICB0ID0gKChQ\ncml2aWxlZ2VkQWN0aW9uRXhjZXB0aW9uKSB0KS5nZXRFeGNlcHRpb24oKTsK\nICAgICAgICAgICAgICAgIF9kZXJpdmF0aW9uRXJyb3JzW2ldID0gdDsKICAg\nICAgICAgICAgICAgIGVycm9ycyA9IHRydWU7CiAgICAgICAgICAgIH0KICAg\nICAgICB9CgogICAgICAgIC8vIG11c3QgYmUgYXQgbGVhc3Qgb25lIHByb2R1\nY3QgZGVyaXZhdGlvbiB0byBkZWZpbmUgbWV0YWRhdGEgZmFjdG9yaWVzLAog\nICAgICAgIC8vIGV0Yy4gCiAgICAgICAgaWYgKGRlcml2YXRpb25zLmlzRW1w\ndHkoKSkgewogICAgICAgICAgICB0aHJvdyBuZXcgTWlzc2luZ1Jlc291cmNl\nRXhjZXB0aW9uKF9sb2MuZ2V0CiAgICAgICAgICAgICAgICAoIm5vLXByb2R1\nY3QtZGVyaXZhdGlvbnMiLCBQcm9kdWN0RGVyaXZhdGlvbi5jbGFzcy5nZXRO\nYW1lKCksCiAgICAgICAgICAgICAgICBkZXJpdmF0aW9uRXJyb3JzVG9TdHJp\nbmcoKSkuZ2V0TWVzc2FnZSgpLCAKICAgICAgICAgICAgICAgIFByb2R1Y3RE\nZXJpdmF0aW9ucy5jbGFzcy5nZXROYW1lKCksImRlcml2YXRpb25zIik7CiAg\nICAgICAgfQoKICAgICAgICAvLyBpZiBzb21lIGRlcml2YXRpb25zIHdlcmVu\nJ3QgaW5zdGFudGlhYmxlLCB3YXJuCiAgICAgICAgaWYgKGVycm9ycykKICAg\nICAgICAgICAgU3lzdGVtLmVyci5wcmludGxuKF9sb2MuZ2V0KCJiYWQtcHJv\nZHVjdC1kZXJpdmF0aW9ucyIsCiAgICAgICAgICAgICAgICBQcm9kdWN0RGVy\naXZhdGlvbnMuY2xhc3MuZ2V0TmFtZSgpKSk7CiAgICAgICAgZm9yIChpbnQg\naSA9IDA7IGkgPCBfZGVyaXZhdGlvbkVycm9ycy5sZW5ndGg7IGkrKykgewog\nICAgICAgICAgICBpZiAoX2Rlcml2YXRpb25FcnJvcnNbaV0gPT0gbnVsbCkK\nICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICBTeXN0ZW0u\nZXJyLnByaW50bG4oX2Rlcml2YXRpb25OYW1lc1tpXSArICI6IiArCiAgICAg\nICAgICAgICAgICAgICAgX2Rlcml2YXRpb25FcnJvcnNbaV0pOwogICAgICAg\nICAgICBicmVhazsKICAgICAgICB9CgogICAgICAgIENvbGxlY3Rpb25zLnNv\ncnQoZGVyaXZhdGlvbnMsIG5ldyBQcm9kdWN0RGVyaXZhdGlvbkNvbXBhcmF0\nb3IoKSk7CiAgICAgICAgX2Rlcml2YXRpb25zID0KICAgICAgICAgICAgZGVy\naXZhdGlvbnMudG9BcnJheShuZXcgUHJvZHVjdERlcml2YXRpb25bZGVyaXZh\ndGlvbnMuc2l6ZSgpXSk7CgogICAgICAgIExpc3Q8U3RyaW5nPiBwcmVmaXhl\ncyA9IG5ldyBBcnJheUxpc3Q8U3RyaW5nPigyKTsKICAgICAgICBwcmVmaXhl\ncy5hZGQoIm9wZW5qcGEiKTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8\nIF9kZXJpdmF0aW9ucy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBTdHJp\nbmcgcHJlZml4ID0gX2Rlcml2YXRpb25zW2ldLmdldENvbmZpZ3VyYXRpb25Q\ncmVmaXgoKTsKICAgICAgICAgICAgaWYgKHByZWZpeCAhPSBudWxsICYmICEi\nb3BlbmpwYSIuZXF1YWxzKHByZWZpeCkpCiAgICAgICAgICAgICAgICBwcmVm\naXhlcy5hZGQocHJlZml4KTsKICAgICAgICB9CiAgICAgICAgX3ByZWZpeGVz\nID0gcHJlZml4ZXMudG9BcnJheShuZXcgU3RyaW5nW3ByZWZpeGVzLnNpemUo\nKV0pOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIGFsbCB0aGUgcHJv\nZHVjdCBkZXJpdmF0aW9ucyByZWdpc3RlcmVkIGluIHRoZSBjdXJyZW50IGNs\nYXNzbG9hZGVyCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0aWMgUHJvZHVjdERl\ncml2YXRpb25bXSBnZXRQcm9kdWN0RGVyaXZhdGlvbnMoKSB7CiAgICAgICAg\ncmV0dXJuIF9kZXJpdmF0aW9uczsKICAgIH0KCiAgICAvKioKICAgICAqIFJl\ndHVybiB0aGUgcmVjb2duaXplZCBwcmVmaXhlcyBmb3IgY29uZmlndXJhdGlv\nbiBwcm9wZXJ0aWVzLgogICAgICovCiAgICBwdWJsaWMgc3RhdGljIFN0cmlu\nZ1tdIGdldENvbmZpZ3VyYXRpb25QcmVmaXhlcygpIHsKICAgICAgICByZXR1\ncm4gX3ByZWZpeGVzOwogICAgfQoKICAgIC8qKgogICAgICogU2V0IHRoZSBj\nb25maWd1cmF0aW9uIHByZWZpeCBhcnJheS4gVGhpcyBpcyBwYWNrYWdlLXZp\nc2libGUgZm9yIAogICAgICogdGVzdGluZyBwdXJwb3Nlcy4KICAgICAqIAog\nICAgICogQHNpbmNlIDAuOS43CiAgICAgKi8KICAgIHN0YXRpYyB2b2lkIHNl\ndENvbmZpZ3VyYXRpb25QcmVmaXhlcyhTdHJpbmdbXSBwcmVmaXhlcykgewog\nICAgICAgIF9wcmVmaXhlcyA9IHByZWZpeGVzOwogICAgfQogICAgCiAgICAv\nKioKICAgICAqIERldGVybWluZSB0aGUgZnVsbCBrZXkgbmFtZSBmb3IgPGNv\nZGU+cGFydGlhbEtleTwvY29kZT4sIGdpdmVuIHRoZSAKICAgICAqIHJlZ2lz\ndGVyZWQgcHJlZml4ZXMgYW5kIHRoZSBlbnRyaWVzIGluIDxjb2RlPm1hcDwv\nY29kZT4uIFRoaXMgbWV0aG9kCiAgICAgKiBjb21wdXRlcyB0aGUgYXBwcm9w\ncmlhdGUgY29uZmlndXJhdGlvbiBwcmVmaXggdG8gdXNlIGJ5IGxvb2tpbmcg\nCiAgICAgKiB0aHJvdWdoIDxjb2RlPm1hcDwvY29kZT4gZm9yIGEga2V5IHN0\nYXJ0aW5nIHdpdGggYW55IG9mIHRoZSBrbm93bgogICAgICogY29uZmlndXJh\ndGlvbiBwcmVmaXhlcyBhbmQgZW5kaW5nIHdpdGggPGNvZGU+cGFydGlhbEtl\neTwvY29kZT4gYW5kLCBpZiBhCiAgICAgKiB2YWx1ZSBpcyBmb3VuZCwgdXNp\nbmcgdGhlIHByZWZpeCBvZiB0aGF0IGtleS4gT3RoZXJ3aXNlLCBpdCB1c2Vz\nCiAgICAgKiB0aGUgZmlyc3QgcmVnaXN0ZXJlZCBwcmVmaXguIAogICAgICog\nCiAgICAgKiBUaGUgZ2l2ZW4gPGNvZGU+cGFydGlhbEtleTwvY29kZT4gaXMg\nZmlyc3QgdGVzdGVkIGZvciBjb250YWlubWVudCBpbiB0aGUKICAgICAqIGdp\ndmVuIG1hcCB3aXRob3V0IGFueSBwcmVmaXguCiAgICAgKiAgCiAgICAgKiBA\nc2luY2UgMC45LjcKICAgICAqLwogICAgcHVibGljIHN0YXRpYyBTdHJpbmcg\nZ2V0Q29uZmlndXJhdGlvbktleShTdHJpbmcgcGFydGlhbEtleSwgTWFwIG1h\ncCkgewogICAgICAgIFN0cmluZyBmaXJzdEtleSA9IChtYXAgIT0gbnVsbCAm\nJiBtYXAuY29udGFpbnNLZXkocGFydGlhbEtleSkpIAogICAgICAgICAgICA/\nIHBhcnRpYWxLZXkgOiBudWxsOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBt\nYXAgIT0gbnVsbCAmJiBpIDwgX3ByZWZpeGVzLmxlbmd0aDsgaSsrKSB7CiAg\nICAgICAgICAgIFN0cmluZyBmdWxsS2V5ID0gX3ByZWZpeGVzW2ldICsgIi4i\nICsgcGFydGlhbEtleTsKICAgICAgICAgICAgaWYgKG1hcC5jb250YWluc0tl\neShmdWxsS2V5KSkgewogICAgICAgICAgICAgICAgaWYgKGZpcnN0S2V5ID09\nIG51bGwpIAogICAgICAgICAgICAgICAgICAgIGZpcnN0S2V5ID0gZnVsbEtl\neTsKICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAg\nIC8vIGlmIHdlJ3ZlIGFscmVhZHkgZm91bmQgYSBwcm9wZXJ0eSB3aXRoIGEg\ncHJldmlvdXMgCiAgICAgICAgICAgICAgICAgICAgLy8gcHJlZml4LCB0aGVu\nIHRoaXMgaXMgYSBjb2xsaXNpb24uCiAgICAgICAgICAgICAgICAgICAgdGhy\nb3cgbmV3IElsbGVnYWxTdGF0ZUV4Y2VwdGlvbihfbG9jLmdldCgKICAgICAg\nICAgICAgICAgICAgICAgICAgImR1cC13aXRoLWRpZmZlcmVudC1wcmVmaXhl\ncyIsIGZpcnN0S2V5LCBmdWxsS2V5KQogICAgICAgICAgICAgICAgICAgICAg\nICAuZ2V0TWVzc2FnZSgpKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAg\nICAgfQogICAgICAgIH0KICAgICAgICAKICAgICAgICBpZiAoZmlyc3RLZXkg\nPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIF9wcmVmaXhlc1swXSArICIu\nIiArIHBhcnRpYWxLZXk7CiAgICAgICAgZWxzZQogICAgICAgICAgICByZXR1\ncm4gZmlyc3RLZXk7CiAgICB9CgogICAgLyoqCiAgICAgKiBBcHBseSB7QGxp\nbmsgUHJvZHVjdERlcml2YXRpb24jYmVmb3JlQ29uZmlndXJhdGlvbkNvbnN0\ncnVjdH0gY2FsbGJhY2tzCiAgICAgKiB0byB0aGUgdGhlIGdpdmVuIGluc3Rh\nbmNlLiBFeGNlcHRpb25zIG90aGVyIHRoYW4gZmF0YWwKICAgICAqIHtAbGlu\nayBCb290c3RyYXBFeGNlcHRpb259IGFyZSBzd2FsbG93ZWQuCiAgICAgKi8K\nICAgIHB1YmxpYyBzdGF0aWMgdm9pZCBiZWZvcmVDb25maWd1cmF0aW9uQ29u\nc3RydWN0KENvbmZpZ3VyYXRpb25Qcm92aWRlciBjcCkgewogICAgICAgIGZv\nciAoaW50IGkgPSAwOyBpIDwgX2Rlcml2YXRpb25zLmxlbmd0aDsgaSsrKSB7\nCiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBfZGVyaXZhdGlv\nbnNbaV0uYmVmb3JlQ29uZmlndXJhdGlvbkNvbnN0cnVjdChjcCk7CiAgICAg\nICAgICAgIH0gY2F0Y2ggKEJvb3RzdHJhcEV4Y2VwdGlvbiBiZSkgewogICAg\nICAgICAgICAJaWYgKGJlLmlzRmF0YWwoKSkKICAgICAgICAgICAgCQl0aHJv\ndyBiZTsKICAgICAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAg\nICAgICAgICAgICAgIC8vIGNhbid0IGxvZzsgbm8gY29uZmlndXJhdGlvbiB5\nZXQKICAgICAgICAgICAgICAgIGUucHJpbnRTdGFja1RyYWNlKCk7CiAgICAg\nICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBBcHBs\neSB7QGxpbmsgUHJvZHVjdERlcml2YXRpb24jYmVmb3JlQ29uZmlndXJhdGlv\nbkxvYWR9IGNhbGxiYWNrcwogICAgICogdG8gdGhlIHRoZSBnaXZlbiBpbnN0\nYW5jZS4gRXhjZXB0aW9ucyBvdGhlciB0aGFuIGZhdGFsCiAgICAgKiB7QGxp\nbmsgQm9vdHN0cmFwRXhjZXB0aW9ufSBhcmUgc3dhbGxvd2VkLgogICAgICov\nCiAgICBwdWJsaWMgc3RhdGljIHZvaWQgYmVmb3JlQ29uZmlndXJhdGlvbkxv\nYWQoQ29uZmlndXJhdGlvbiBjb25mKSB7CiAgICAgICAgZm9yIChpbnQgaSA9\nIDA7IGkgPCBfZGVyaXZhdGlvbnMubGVuZ3RoOyBpKyspIHsKICAgICAgICAg\nICAgdHJ5IHsKICAgICAgICAgICAgICAgIF9kZXJpdmF0aW9uc1tpXS5iZWZv\ncmVDb25maWd1cmF0aW9uTG9hZChjb25mKTsKICAgICAgICAgICAgfSBjYXRj\naCAoQm9vdHN0cmFwRXhjZXB0aW9uIGJlKSB7CiAgICAgICAgICAgIAlpZiAo\nYmUuaXNGYXRhbCgpKQogICAgICAgICAgICAJCXRocm93IGJlOwogICAgICAg\nICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkgewogICAgICAgICAgICAgICAg\nLy8gbG9nZ2luZyBub3QgY29uZmlndXJlZCB5ZXQKICAgICAgICAgICAgICAg\nIGUucHJpbnRTdGFja1RyYWNlKCk7CiAgICAgICAgICAgIH0KICAgICAgICB9\nCiAgICB9CgogICAgLyoqCiAgICAgKiBBcHBseSB7QGxpbmsgUHJvZHVjdERl\ncml2YXRpb24jYWZ0ZXJTcGVjaWZpY2F0aW9uU2V0fSBjYWxsYmFja3MKICAg\nICAqIHRvIHRoZSB0aGUgZ2l2ZW4gaW5zdGFuY2UuIEV4Y2VwdGlvbnMgb3Ro\nZXIgdGhhbiBmYXRhbAogICAgICoge0BsaW5rIEJvb3RzdHJhcEV4Y2VwdGlv\nbn0gYXJlIHN3YWxsb3dlZC4KICAgICAqLwogICAgcHVibGljIHN0YXRpYyB2\nb2lkIGFmdGVyU3BlY2lmaWNhdGlvblNldChDb25maWd1cmF0aW9uIGNvbmYp\nIHsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IF9kZXJpdmF0aW9ucy5s\nZW5ndGg7IGkrKykgewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAg\nICAgX2Rlcml2YXRpb25zW2ldLmFmdGVyU3BlY2lmaWNhdGlvblNldChjb25m\nKTsKICAgICAgICAgICAgfSBjYXRjaCAoQm9vdHN0cmFwRXhjZXB0aW9uIGJl\nKSB7CiAgICAgICAgICAgIAlpZiAoYmUuaXNGYXRhbCgpKQogICAgICAgICAg\nICAJCXRocm93IGJlOwogICAgICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24g\nZSkgewogICAgICAgICAgICAgICAgLy8gbG9nZ2luZyBub3QgY29uZmlndXJl\nZCB5ZXQKICAgICAgICAgICAgICAgIGUucHJpbnRTdGFja1RyYWNlKCk7CiAg\nICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBD\nYWxsZWQgYXMgdGhlIGZpcnN0IHN0ZXAgb2YgYSBDb25maWd1cmF0aW9uJ3Mg\nY2xvc2UoKSBtZXRob2QuIAogICAgICogRXhjZXB0aW9ucyBhcmUgc3dhbGxv\nd2VkLgogICAgICogCiAgICAgKiBAc2luY2UgMC45LjcKICAgICAqLwogICAg\ncHVibGljIHN0YXRpYyB2b2lkIGJlZm9yZUNsb3NlKENvbmZpZ3VyYXRpb24g\nY29uZikgewogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgX2Rlcml2YXRp\nb25zLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAg\nICAgICAgICBfZGVyaXZhdGlvbnNbaV0uYmVmb3JlQ29uZmlndXJhdGlvbkNs\nb3NlKGNvbmYpOwogICAgICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkg\newogICAgICAgICAgICAgICAgY29uZi5nZXRDb25maWd1cmF0aW9uTG9nKCku\nd2FybihfbG9jLmdldCgiYmVmb3JlLWNsb3NlLWV4IiksIGUpOwogICAgICAg\nICAgICB9CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogTG9hZCB0\naGUgZ2l2ZW4gZ2l2ZW4gcmVzb3VyY2UsIG9yIHJldHVybiBmYWxzZSBpZiBp\ndCBpcyBub3QgYSByZXNvdXJjZQogICAgICogdGhpcyBwcm92aWRlciB1bmRl\ncnN0YW5kcy4gVGhlIGdpdmVuIGNsYXNzIGxvYWRlciBtYXkgYmUgbnVsbC4K\nICAgICAqCiAgICAgKiBAcGFyYW0gYW5jaG9yIG9wdGlvbmFsIG5hbWVkIGFu\nY2hvciB3aXRoaW4gYSBtdWx0aXBsZS1jb25maWd1cmF0aW9uCiAgICAgKiBy\nZXNvdXJjZQogICAgICovCiAgICBwdWJsaWMgc3RhdGljIENvbmZpZ3VyYXRp\nb25Qcm92aWRlciBsb2FkKFN0cmluZyByZXNvdXJjZSwgU3RyaW5nIGFuY2hv\nciwgCiAgICAgICAgQ2xhc3NMb2FkZXIgbG9hZGVyKSB7CiAgICAgICAgaWYg\nKFN0cmluZ1V0aWxzLmlzRW1wdHkocmVzb3VyY2UpKQogICAgICAgICAgICBy\nZXR1cm4gbnVsbDsKICAgICAgICBpZiAobG9hZGVyID09IG51bGwpCiAgICAg\nICAgICAgIGxvYWRlciA9IEFjY2Vzc0NvbnRyb2xsZXIuZG9Qcml2aWxlZ2Vk\nKAogICAgICAgICAgICAgICAgSjJEb1ByaXZIZWxwZXIuZ2V0Q29udGV4dENs\nYXNzTG9hZGVyQWN0aW9uKCkpOwogICAgICAgIENvbmZpZ3VyYXRpb25Qcm92\naWRlciBwcm92aWRlciA9IG51bGw7CiAgICAgICAgU3RyaW5nQnVmZmVyIGVy\ncnMgPSBudWxsOwogICAgICAgIC8vIG1vc3Qgc3BlY2lmaWMgdG8gbGVhc3QK\nICAgICAgICBUaHJvd2FibGUgZXJyID0gbnVsbDsKICAgICAgICBmb3IgKGlu\ndCBpID0gX2Rlcml2YXRpb25zLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7\nCiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBwcm92aWRlciA9\nIF9kZXJpdmF0aW9uc1tpXS5sb2FkKHJlc291cmNlLCBhbmNob3IsIGxvYWRl\ncik7CiAgICAgICAgICAgICAgICBpZiAocHJvdmlkZXIgIT0gbnVsbCkKICAg\nICAgICAgICAgICAgICAgICByZXR1cm4gcHJvdmlkZXI7CiAgICAgICAgICAg\nIH0gY2F0Y2ggKFRocm93YWJsZSB0KSB7CiAgICAgICAgICAgICAgICBlcnIg\nPSB0OwogICAgICAgICAgICAgICAgZXJycyA9IChlcnJzID09IG51bGwpID8g\nbmV3IFN0cmluZ0J1ZmZlcigpIDogZXJycy5hcHBlbmQoIlxuIik7CiAgICAg\nICAgICAgICAgICBlcnJzLmFwcGVuZChfZGVyaXZhdGlvbnNbaV0uZ2V0Q2xh\nc3MoKS5nZXROYW1lKCkgKyAiOiIgKyB0KTsKICAgICAgICAgICAgfQogICAg\nICAgIH0KICAgICAgICByZXBvcnRFcnJvcnMoZXJycywgcmVzb3VyY2UsIGVy\ncik7CiAgICAgICAgU3RyaW5nIHJzcmMgPSByZXNvdXJjZSArICIjIiArIGFu\nY2hvcjsKICAgICAgICB0aHJvdyAoTWlzc2luZ1Jlc291cmNlRXhjZXB0aW9u\nKSBKYXZhVmVyc2lvbnMuaW5pdENhdXNlCiAgICAgICAgICAgIChuZXcgTWlz\nc2luZ1Jlc291cmNlRXhjZXB0aW9uKHJzcmMsCiAgICAgICAgICAgICAgICBQ\ncm9kdWN0RGVyaXZhdGlvbnMuY2xhc3MuZ2V0TmFtZSgpLCByc3JjKSwgZXJy\nKTsKICAgIH0KCiAgICAvKioKICAgICAqIExvYWQgZ2l2ZW4gZmlsZSwgb3Ig\ncmV0dXJuIGZhbHNlIGlmIGl0IGlzIG5vdCBhIGZpbGUgdGhpcyBwcm92aWRl\ncgogICAgICogdW5kZXJzdGFuZHMuCiAgICAgKgogICAgICogQHBhcmFtIGFu\nY2hvciBvcHRpb25hbCBuYW1lZCBhbmNob3Igd2l0aGluIGEgbXVsdGlwbGUt\nY29uZmlndXJhdGlvbiBmaWxlCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0aWMg\nQ29uZmlndXJhdGlvblByb3ZpZGVyIGxvYWQoRmlsZSBmaWxlLCBTdHJpbmcg\nYW5jaG9yLCAKICAgICAgICBDbGFzc0xvYWRlciBsb2FkZXIpIHsKICAgICAg\nICBpZiAoZmlsZSA9PSBudWxsKQogICAgICAgICAgICByZXR1cm4gbnVsbDsK\nICAgICAgICBpZiAobG9hZGVyID09IG51bGwpCiAgICAgICAgICAgIGxvYWRl\nciA9IEFjY2Vzc0NvbnRyb2xsZXIuZG9Qcml2aWxlZ2VkKAogICAgICAgICAg\nICAgICAgSjJEb1ByaXZIZWxwZXIuZ2V0Q29udGV4dENsYXNzTG9hZGVyQWN0\naW9uKCkpOwogICAgICAgIENvbmZpZ3VyYXRpb25Qcm92aWRlciBwcm92aWRl\nciA9IG51bGw7CiAgICAgICAgU3RyaW5nQnVmZmVyIGVycnMgPSBudWxsOwog\nICAgICAgIFRocm93YWJsZSBlcnIgPSBudWxsOwogICAgICAgIC8vIG1vc3Qg\nc3BlY2lmaWMgdG8gbGVhc3QKICAgICAgICBmb3IgKGludCBpID0gX2Rlcml2\nYXRpb25zLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7CiAgICAgICAgICAg\nIHRyeSB7CiAgICAgICAgICAgICAgICBwcm92aWRlciA9IF9kZXJpdmF0aW9u\nc1tpXS5sb2FkKGZpbGUsIGFuY2hvcik7CiAgICAgICAgICAgICAgICBpZiAo\ncHJvdmlkZXIgIT0gbnVsbCkKICAgICAgICAgICAgICAgICAgICByZXR1cm4g\ncHJvdmlkZXI7CiAgICAgICAgICAgIH0gY2F0Y2ggKFRocm93YWJsZSB0KSB7\nCiAgICAgICAgICAgICAgICBlcnIgPSB0OwogICAgICAgICAgICAgICAgZXJy\ncyA9IChlcnJzID09IG51bGwpID8gbmV3IFN0cmluZ0J1ZmZlcigpIDogZXJy\ncy5hcHBlbmQoIlxuIik7CiAgICAgICAgICAgICAgICBlcnJzLmFwcGVuZChf\nZGVyaXZhdGlvbnNbaV0uZ2V0Q2xhc3MoKS5nZXROYW1lKCkgKyAiOiIgKyB0\nKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBTdHJpbmcgYVBh\ndGggPSBBY2Nlc3NDb250cm9sbGVyLmRvUHJpdmlsZWdlZCgKICAgICAgICAg\nICAgSjJEb1ByaXZIZWxwZXIuZ2V0QWJzb2x1dGVQYXRoQWN0aW9uKGZpbGUp\nKTsKICAgICAgICByZXBvcnRFcnJvcnMoZXJycywgYVBhdGgsIGVycik7CiAg\nICAgICAgU3RyaW5nIHJzcmMgPSBhUGF0aCArICIjIiArIGFuY2hvcjsKICAg\nICAgICB0aHJvdyAoTWlzc2luZ1Jlc291cmNlRXhjZXB0aW9uKSBKYXZhVmVy\nc2lvbnMuaW5pdENhdXNlCiAgICAgICAgICAgIChuZXcgTWlzc2luZ1Jlc291\ncmNlRXhjZXB0aW9uKHJzcmMsCiAgICAgICAgICAgICAgICBQcm9kdWN0RGVy\naXZhdGlvbnMuY2xhc3MuZ2V0TmFtZSgpLCByc3JjKSwgZXJyKTsKICAgIH0K\nICAgCiAgICAvKioKICAgICAqIFJldHVybiBhIHtAbGluayBDb25maWd1cmF0\naW9uUHJvdmlkZXJ9IHRoYXQgaGFzIHBhcnNlZCBzeXN0ZW0gZGVmYXVsdHMu\nCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0aWMgQ29uZmlndXJhdGlvblByb3Zp\nZGVyIGxvYWREZWZhdWx0cyhDbGFzc0xvYWRlciBsb2FkZXIpIHsKICAgICAg\nICByZXR1cm4gbG9hZChsb2FkZXIsIGZhbHNlKTsKICAgIH0KCiAgICAvKioK\nICAgICAqIFJldHVybiBhIHtAbGluayBDb25maWd1cmF0aW9uUHJvdmlkZXJ9\nIHRoYXQgaGFzIHBhcnNlZCBzeXN0ZW0gZ2xvYmFscy4KICAgICAqLwogICAg\ncHVibGljIHN0YXRpYyBDb25maWd1cmF0aW9uUHJvdmlkZXIgbG9hZEdsb2Jh\nbHMoQ2xhc3NMb2FkZXIgbG9hZGVyKSB7CiAgICAgICAgcmV0dXJuIGxvYWQo\nbG9hZGVyLCB0cnVlKTsKICAgIH0KICAgICAgICAgICAgCiAgICAvKioKICAg\nICAqIExvYWQgYSBidWlsdC1pbiByZXNvdXJjZSBsb2NhdGlvbi4KICAgICAq\nLwogICAgcHJpdmF0ZSBzdGF0aWMgQ29uZmlndXJhdGlvblByb3ZpZGVyIGxv\nYWQoQ2xhc3NMb2FkZXIgbG9hZGVyLCAKICAgICAgIGJvb2xlYW4gZ2xvYmFs\ncykgewogICAgICAgIGlmIChsb2FkZXIgPT0gbnVsbCkKICAgICAgICAgICAg\nbG9hZGVyID0gQWNjZXNzQ29udHJvbGxlci5kb1ByaXZpbGVnZWQoCiAgICAg\nICAgICAgICAgICBKMkRvUHJpdkhlbHBlci5nZXRDb250ZXh0Q2xhc3NMb2Fk\nZXJBY3Rpb24oKSk7CiAgICAgICAgCiAgICAgICAgQ29uZmlndXJhdGlvblBy\nb3ZpZGVyIHByb3ZpZGVyID0gbnVsbDsKICAgICAgICBTdHJpbmdCdWZmZXIg\nZXJycyA9IG51bGw7CiAgICAgICAgU3RyaW5nIHR5cGUgPSAoZ2xvYmFscykg\nPyAiZ2xvYmFscyIgOiAiZGVmYXVsdHMiOwogICAgICAgIFRocm93YWJsZSBl\ncnIgPSBudWxsOwogICAgICAgIC8vIG1vc3Qgc3BlY2lmaWMgdG8gbGVhc3QK\nICAgICAgICBmb3IgKGludCBpID0gX2Rlcml2YXRpb25zLmxlbmd0aCAtIDE7\nIGkgPj0gMDsgaS0tKSB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAg\nICAgICBwcm92aWRlciA9IChnbG9iYWxzKSA/IF9kZXJpdmF0aW9uc1tpXS5s\nb2FkR2xvYmFscyhsb2FkZXIpIAogICAgICAgICAgICAgICAgICAgIDogX2Rl\ncml2YXRpb25zW2ldLmxvYWREZWZhdWx0cyhsb2FkZXIpOwogICAgICAgICAg\nICAgICAgaWYgKHByb3ZpZGVyICE9IG51bGwpCiAgICAgICAgICAgICAgICAg\nICByZXR1cm4gcHJvdmlkZXI7CiAgICAgICAgICAgIH0gY2F0Y2ggKFRocm93\nYWJsZSB0KSB7CiAgICAgICAgICAgICAgICBlcnIgPSB0OwogICAgICAgICAg\nICAgICAgZXJycyA9IChlcnJzID09IG51bGwpID8gbmV3IFN0cmluZ0J1ZmZl\ncigpIDogZXJycy5hcHBlbmQoIlxuIik7CiAgICAgICAgICAgICAgICBlcnJz\nLmFwcGVuZChfZGVyaXZhdGlvbnNbaV0uZ2V0Q2xhc3MoKS5nZXROYW1lKCkg\nKyAiOiIgKyB0KTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBy\nZXBvcnRFcnJvcnMoZXJycywgdHlwZSwgZXJyKTsKICAgICAgICByZXR1cm4g\nbnVsbDsKICAgIH0KIAogICAgLyoqCiAgICAgKiBUaHJvd24gcHJvcGVyIGV4\nY2VwdGlvbiBmb3IgZ2l2ZW4gZXJyb3JzLgogICAgICovCiAgICBwcml2YXRl\nIHN0YXRpYyB2b2lkIHJlcG9ydEVycm9ycyhTdHJpbmdCdWZmZXIgZXJycywg\nU3RyaW5nIHJlc291cmNlLAogICAgICAgIFRocm93YWJsZSBuZXN0ZWQpIHsK\nICAgICAgICBpZiAoZXJycyA9PSBudWxsKQogICAgICAgICAgICByZXR1cm47\nCiAgICAgICAgdGhyb3cgKE1pc3NpbmdSZXNvdXJjZUV4Y2VwdGlvbikgSmF2\nYVZlcnNpb25zLmluaXRDYXVzZQogICAgICAgICAgICAobmV3IE1pc3NpbmdS\nZXNvdXJjZUV4Y2VwdGlvbihlcnJzLnRvU3RyaW5nKCksCiAgICAgICAgICAg\nICAgICBQcm9kdWN0RGVyaXZhdGlvbnMuY2xhc3MuZ2V0TmFtZSgpLCByZXNv\ndXJjZSksIG5lc3RlZCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4g\nYSBMaXN0PFN0cmluZz4gb2YgYWxsIHRoZSBmdWxseS1xdWFsaWZpZWQgYW5j\naG9ycyBzcGVjaWZpZWQgaW4KICAgICAqIDxjb2RlPnByb3BlcnRpZXNMb2Nh\ndGlvbjwvY29kZT4uIFRoZSByZXR1cm4gdmFsdWVzIG11c3QgYmUgdXNlZCBp\nbgogICAgICogY29uanVuY3Rpb24gd2l0aCA8Y29kZT5wcm9wZXJ0aWVzTG9j\nYXRpb248L2NvZGU+LiBJZiB0aGVyZSBhcmUgbm8KICAgICAqIHByb2R1Y3Qg\nZGVyaXZhdGlvbnMgb3IgaWYgbm8gcHJvZHVjdCBkZXJpdmF0aW9ucyBjb3Vs\nZCBmaW5kIGFuY2hvcnMsCiAgICAgKiB0aGlzIHJldHVybnMgYW4gZW1wdHkg\nbGlzdC4KICAgICAqCiAgICAgKiBAc2luY2UgMS4xLjAKICAgICAqLwogICAg\ncHVibGljIHN0YXRpYyBMaXN0PFN0cmluZz4gZ2V0RnVsbHlRdWFsaWZpZWRB\nbmNob3JzSW5Qcm9wZXJ0aWVzTG9jYXRpb24oCiAgICAgICAgZmluYWwgU3Ry\naW5nIHByb3BlcnRpZXNMb2NhdGlvbikgewogICAgICAgIExpc3Q8U3RyaW5n\nPiBmcUFuY2hvcnMgPSBuZXcgQXJyYXlMaXN0PFN0cmluZz4oKTsKICAgICAg\nICBTdHJpbmdCdWZmZXIgZXJycyA9IG51bGw7CiAgICAgICAgVGhyb3dhYmxl\nIGVyciA9IG51bGw7CiAgICAgICAgZm9yIChpbnQgaSA9IF9kZXJpdmF0aW9u\ncy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkgewogICAgICAgICAgICB0cnkg\newogICAgICAgICAgICAgICAgaWYgKHByb3BlcnRpZXNMb2NhdGlvbiA9PSBu\ndWxsKSB7CiAgICAgICAgICAgICAgICAgICAgU3RyaW5nIGxvYyA9IF9kZXJp\ndmF0aW9uc1tpXS5nZXREZWZhdWx0UmVzb3VyY2VMb2NhdGlvbigpOwogICAg\nICAgICAgICAgICAgICAgIGFkZEFsbChmcUFuY2hvcnMsIGxvYywKICAgICAg\nICAgICAgICAgICAgICAgICAgX2Rlcml2YXRpb25zW2ldLmdldEFuY2hvcnNJ\nblJlc291cmNlKGxvYykpOwogICAgICAgICAgICAgICAgICAgIGNvbnRpbnVl\nOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIEZpbGUgZiA9\nIG5ldyBGaWxlKHByb3BlcnRpZXNMb2NhdGlvbik7CiAgICAgICAgICAgICAg\nICBpZiAoKChCb29sZWFuKSBKMkRvUHJpdkhlbHBlci5pc0ZpbGVBY3Rpb24o\nZikucnVuKCkpCiAgICAgICAgICAgICAgICAgICAgLmJvb2xlYW5WYWx1ZSgp\nKSB7CiAgICAgICAgICAgICAgICAgICAgYWRkQWxsKGZxQW5jaG9ycywgcHJv\ncGVydGllc0xvY2F0aW9uLAogICAgICAgICAgICAgICAgICAgICAgICBfZGVy\naXZhdGlvbnNbaV0uZ2V0QW5jaG9yc0luRmlsZShmKSk7CiAgICAgICAgICAg\nICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIGYgPSBuZXcgRmls\nZSgiTUVUQS1JTkYiICsgRmlsZS5zZXBhcmF0b3JDaGFyCiAgICAgICAgICAg\nICAgICAgICAgICAgICsgcHJvcGVydGllc0xvY2F0aW9uKTsKICAgICAgICAg\nICAgICAgICAgICBpZiAoKChCb29sZWFuKSBKMkRvUHJpdkhlbHBlci5pc0Zp\nbGVBY3Rpb24oZikucnVuKCkpCiAgICAgICAgICAgICAgICAgICAgICAgIC5i\nb29sZWFuVmFsdWUoKSkgewogICAgICAgICAgICAgICAgICAgICAgICBhZGRB\nbGwoZnFBbmNob3JzLCBwcm9wZXJ0aWVzTG9jYXRpb24sCiAgICAgICAgICAg\nICAgICAgICAgICAgICAgICBfZGVyaXZhdGlvbnNbaV0uZ2V0QW5jaG9yc0lu\nRmlsZShmKSk7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAg\nICAgICAgICAgICAgICAgICAgYWRkQWxsKGZxQW5jaG9ycywgcHJvcGVydGll\nc0xvY2F0aW9uLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgX2Rlcml2\nYXRpb25zW2ldLmdldEFuY2hvcnNJblJlc291cmNlKAogICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXNMb2NhdGlvbikpOwogICAg\nICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAg\nICAgfSBjYXRjaCAoVGhyb3dhYmxlIHQpIHsKICAgICAgICAgICAgICAgIGVy\nciA9IHQ7CiAgICAgICAgICAgICAgICBlcnJzID0gKGVycnMgPT0gbnVsbCkg\nPyBuZXcgU3RyaW5nQnVmZmVyKCkgOiBlcnJzLmFwcGVuZCgiXG4iKTsKICAg\nICAgICAgICAgICAgIGVycnMuYXBwZW5kKF9kZXJpdmF0aW9uc1tpXS5nZXRD\nbGFzcygpLmdldE5hbWUoKSArICI6IiArIHQpOwogICAgICAgICAgICB9CiAg\nICAgICAgfQogICAgICAgIHJlcG9ydEVycm9ycyhlcnJzLCBwcm9wZXJ0aWVz\nTG9jYXRpb24sIGVycik7CiAgICAgICAgcmV0dXJuIGZxQW5jaG9yczsKICAg\nIH0KCiAgICBwcml2YXRlIHN0YXRpYyB2b2lkIGFkZEFsbChDb2xsZWN0aW9u\nIGNvbGxlY3Rpb24sIFN0cmluZyBiYXNlLAogICAgICAgIENvbGxlY3Rpb24g\nbmV3TWVtYmVycykgewogICAgICAgIGlmIChuZXdNZW1iZXJzID09IG51bGwg\nfHwgY29sbGVjdGlvbiA9PSBudWxsKQogICAgICAgICAgICByZXR1cm47CiAg\nICAgICAgZm9yIChJdGVyYXRvciBpdGVyID0gbmV3TWVtYmVycy5pdGVyYXRv\ncigpOyBpdGVyLmhhc05leHQoKTsgKSB7CiAgICAgICAgICAgIFN0cmluZyBm\ncUxvYyA9IGJhc2UgKyAiIyIgKyBpdGVyLm5leHQoKTsKICAgICAgICAgICAg\naWYgKCFjb2xsZWN0aW9uLmNvbnRhaW5zKGZxTG9jKSkKICAgICAgICAgICAg\nICAgIGNvbGxlY3Rpb24uYWRkKGZxTG9jKTsKICAgICAgICB9CiAgICB9CiAg\nICAKICAgIAogICAgcHVibGljIHN0YXRpYyBTZXQ8U3RyaW5nPiBnZXRTdXBw\nb3J0ZWRRdWVyeUhpbnRzKCkgewogICAgICAgIFNldDxTdHJpbmc+IHJlc3Vs\ndCA9IG5ldyBUcmVlU2V0PFN0cmluZz4oKTsKICAgICAgICAvLyBtb3N0IHNw\nZWNpZmljIHRvIGxlYXN0CiAgICAgICAgZm9yIChpbnQgaSA9IF9kZXJpdmF0\naW9ucy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkgewogICAgICAgICAgICBT\nZXQ8U3RyaW5nPiBtZW1iZXJzID0gX2Rlcml2YXRpb25zW2ldLmdldFN1cHBv\ncnRlZFF1ZXJ5SGludHMoKTsKICAgICAgICAgICAgaWYgKG1lbWJlcnMgIT0g\nbnVsbCB8fCAhbWVtYmVycy5pc0VtcHR5KCkpCiAgICAgICAgICAgICAgICBy\nZXN1bHQuYWRkQWxsKG1lbWJlcnMpOwogICAgICAgIH0KICAgICAgICByZXR1\ncm4gcmVzdWx0OwogICAgfQoKCiAgICAvKioKICAgICAqIENvbXBhcmUge0Bs\naW5rIFByb2R1Y3REZXJpdmF0aW9ufXMuCiAgICAgKi8KICAgIHByaXZhdGUg\nc3RhdGljIGNsYXNzIFByb2R1Y3REZXJpdmF0aW9uQ29tcGFyYXRvcgogICAg\nICAgIGltcGxlbWVudHMgQ29tcGFyYXRvcjxQcm9kdWN0RGVyaXZhdGlvbj4g\newoKICAgICAgICBwdWJsaWMgaW50IGNvbXBhcmUoUHJvZHVjdERlcml2YXRp\nb24gbzEsIFByb2R1Y3REZXJpdmF0aW9uIG8yKSB7CiAgICAgICAgICAgIGlu\ndCB0eXBlMSA9IG8xLmdldFR5cGUoKTsKICAgICAgICAgICAgaW50IHR5cGUy\nID0gbzIuZ2V0VHlwZSgpOwogICAgICAgICAgICBpZiAodHlwZTEgIT0gdHlw\nZTIpCiAgICAgICAgICAgICAgICByZXR1cm4gdHlwZTEgLSB0eXBlMjsKCiAg\nICAgICAgICAgIC8vIGFyYml0cmFyeSBidXQgY29uc2lzdGVudCBvcmRlcgog\nICAgICAgICAgICByZXR1cm4gbzEuZ2V0Q2xhc3MoKS5nZXROYW1lKCkuY29t\ncGFyZVRvKG8yLmdldENsYXNzKCkuCiAgICAgICAgICAgICAgICBnZXROYW1l\nKCkpOwoJCX0KCX0KCiAgICAvKioKICAgICAqIFByaW50cyBwcm9kdWN0IGRl\ncml2YXRpb24gaW5mb3JtYXRpb24uCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0\naWMgdm9pZCBtYWluKFN0cmluZ1tdIGFyZ3MpIHsKICAgICAgICBTeXN0ZW0u\nZXJyLnByaW50bG4oZGVyaXZhdGlvbkVycm9yc1RvU3RyaW5nKCkpOwogICAg\nfQoKICAgIC8qKgogICAgICogUmV0dXJuIGEgbWVzc2FnZSBhYm91dCB0aGUg\nc3RhdHVzIG9mIGVhY2ggcHJvZHVjdCBkZXJpdmF0aW9uLgogICAgICovCiAg\nICBwcml2YXRlIHN0YXRpYyBTdHJpbmcgZGVyaXZhdGlvbkVycm9yc1RvU3Ry\naW5nKCkgewogICAgICAgIFN0cmluZ0J1ZmZlciBidWYgPSBuZXcgU3RyaW5n\nQnVmZmVyKCk7CiAgICAgICAgYnVmLmFwcGVuZCgiUHJvZHVjdERlcml2YXRp\nb25zOiAiKS5hcHBlbmQoX2Rlcml2YXRpb25OYW1lcy5sZW5ndGgpOwogICAg\nICAgIGZvciAoaW50IGkgPSAwOyBpIDwgX2Rlcml2YXRpb25OYW1lcy5sZW5n\ndGg7IGkrKykgewogICAgICAgICAgICBidWYuYXBwZW5kKCJcbiIpLmFwcGVu\nZChpICsgMSkuYXBwZW5kKCIuICIpLgogICAgICAgICAgICAgICAgYXBwZW5k\nKF9kZXJpdmF0aW9uTmFtZXNbaV0pLmFwcGVuZCgiOiAiKTsKICAgICAgICAg\nICAgaWYgKF9kZXJpdmF0aW9uRXJyb3JzW2ldID09IG51bGwpCiAgICAgICAg\nICAgICAgICBidWYuYXBwZW5kKCJPSyIpOwogICAgICAgICAgICBlbHNlCiAg\nICAgICAgICAgICAgICBidWYuYXBwZW5kKF9kZXJpdmF0aW9uRXJyb3JzW2ld\nLnRvU3RyaW5nKCkpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gYnVmLnRv\nU3RyaW5nKCk7CiAgICB9Cn0KCg==\n","encoding":"base64"}

