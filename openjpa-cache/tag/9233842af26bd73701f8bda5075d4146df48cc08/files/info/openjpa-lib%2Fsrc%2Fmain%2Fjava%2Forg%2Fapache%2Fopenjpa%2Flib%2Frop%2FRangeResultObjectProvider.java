{"sha":"0106ff846b1c319aba463b26ecbf98531ddbbd5f","node_id":"MDQ6QmxvYjIwNjM2NDowMTA2ZmY4NDZiMWMzMTlhYmE0NjNiMjZlY2JmOTg1MzFkZGJiZDVm","size":4454,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/0106ff846b1c319aba463b26ecbf98531ddbbd5f","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnJvcDsKCmltcG9ydCBq\nYXZhLnV0aWwuTm9TdWNoRWxlbWVudEV4Y2VwdGlvbjsKCmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuTG9jYWxpemVyOwoKLyoqCiAqIFBy\nZXZlbnRzIGEgdmlldyBvZiBhIGdpdmVuIHJhbmdlIG9mIGluZGljZXMgZnJv\nbSB0aGUgZGVsZWdhdGUKICogcmVzdWx0IG9iamVjdCBwcm92aWRlci4KICoK\nICogQGF1dGhvciBBYmUgV2hpdGUKICogQG5vamF2YWRvYwogKi8KcHVibGlj\nIGNsYXNzIFJhbmdlUmVzdWx0T2JqZWN0UHJvdmlkZXIgaW1wbGVtZW50cyBS\nZXN1bHRPYmplY3RQcm92aWRlciB7CgogICAgcHJpdmF0ZSBzdGF0aWMgZmlu\nYWwgTG9jYWxpemVyIF9sb2MgPSBMb2NhbGl6ZXIuZm9yUGFja2FnZQogICAg\nICAgIChSYW5nZVJlc3VsdE9iamVjdFByb3ZpZGVyLmNsYXNzKTsKCiAgICBw\ncml2YXRlIGZpbmFsIFJlc3VsdE9iamVjdFByb3ZpZGVyIF9kZWxlZ2F0ZTsK\nICAgIHByaXZhdGUgZmluYWwgaW50IF9zdGFydElkeDsKICAgIHByaXZhdGUg\nZmluYWwgaW50IF9lbmRJZHg7CiAgICBwcml2YXRlIGludCBfaWR4ID0gLTE7\nCgogICAgLyoqCiAgICAgKiBDb25zdHJ1Y3Rvci4gQmVjYXVzZSB0aGlzIGlz\nIGEgd3JhcHBlciBhcm91bmQgc29tZSBkZWxlZ2F0ZSwKICAgICAqIGFuZCBy\nZXN1bHQgb2JqZWN0IHByb3ZpZGVycyB3b3JrIHdpdGggaW50IGluZGV4ZXMs\nIG5laXRoZXIgdGhlIHN0YXJ0CiAgICAgKiBvciBlbmQgaW5kZXggY2FuIGJl\nIGdyZWF0ZXIgdGhhbiBJbnRlZ2VyLk1BWF9WQUxVRSh3aXRoIHRoZSBleGNl\ncHRpb24KICAgICAqIG9mIExvbmcuTUFYX1ZBTFVFLCB3aGljaCBpcyB1c2Vk\nIHRvIGluZGljYXRlIG5vIGxpbWl0KS4KICAgICAqCiAgICAgKiBAcGFyYW0g\nZGVsZWdhdGUgdGhlIHJlc3VsdCBvYmplY3QgcHJvdmlkZXIgdG8gZGVsZWdh\ndGUgdG8KICAgICAqIEBwYXJhbSBzdGFydElkeCAwLWJhc2VkIGluY2x1c2l2\nZSBzdGFydCBpbmRleCBvZiB0aGUgcmFuZ2UKICAgICAqIHRvIHByZXNlbnQ7\nIG11c3QgYmUgJmx0OyBJbnRlZ2VyLk1BWF9WQUxVRQogICAgICogQHBhcmFt\nIGVuZElkeCAwLWJhc2VkIGV4Y2x1c2l2ZSBlbmQgaW5kZXggb2YgdGhlIHJh\nbmdlIHRvCiAgICAgKiBwcmVzZW50OyBtdXN0IGJlICZsdDsgSW50ZWdlci5N\nQVhfVkFMVUUsIG9yIExvbmcuTUFYX1ZBTFVFIGZvciBubyBsaW1pdAogICAg\nICovCiAgICBwdWJsaWMgUmFuZ2VSZXN1bHRPYmplY3RQcm92aWRlcihSZXN1\nbHRPYmplY3RQcm92aWRlciBkZWxlZ2F0ZSwKICAgICAgICBsb25nIHN0YXJ0\nSWR4LCBsb25nIGVuZElkeCkgewogICAgICAgIC8vIHVzZSBJbnRlZ2VyLk1B\nWF9WQUxVRSBmb3Igbm8gbGltaXQgaW50ZXJuYWxseQogICAgICAgIGlmIChl\nbmRJZHggPT0gTG9uZy5NQVhfVkFMVUUpCiAgICAgICAgICAgIGVuZElkeCA9\nIEludGVnZXIuTUFYX1ZBTFVFOwoKICAgICAgICBfZGVsZWdhdGUgPSBkZWxl\nZ2F0ZTsKICAgICAgICBpZiAoc3RhcnRJZHggPiBJbnRlZ2VyLk1BWF9WQUxV\nRSB8fCBlbmRJZHggPiBJbnRlZ2VyLk1BWF9WQUxVRSkKICAgICAgICAgICAg\ndGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbihfbG9jLmdldCgi\ncmFuZ2UtdG9vLWhpZ2giLAogICAgICAgICAgICAgICAgU3RyaW5nLnZhbHVl\nT2Yoc3RhcnRJZHgpLCBTdHJpbmcudmFsdWVPZihlbmRJZHgpKS5nZXRNZXNz\nYWdlKCkpOwoKICAgICAgICBfc3RhcnRJZHggPSAoaW50KSBzdGFydElkeDsK\nICAgICAgICBfZW5kSWR4ID0gKGludCkgZW5kSWR4OwogICAgfQoKICAgIHB1\nYmxpYyBib29sZWFuIHN1cHBvcnRzUmFuZG9tQWNjZXNzKCkgewogICAgICAg\nIHJldHVybiBfZGVsZWdhdGUuc3VwcG9ydHNSYW5kb21BY2Nlc3MoKTsKICAg\nIH0KCiAgICBwdWJsaWMgdm9pZCBvcGVuKCkgdGhyb3dzIEV4Y2VwdGlvbiB7\nCiAgICAgICAgX2RlbGVnYXRlLm9wZW4oKTsKICAgIH0KCiAgICBwdWJsaWMg\nT2JqZWN0IGdldFJlc3VsdE9iamVjdCgpIHRocm93cyBFeGNlcHRpb24gewog\nICAgICAgIGlmIChfaWR4IDwgX3N0YXJ0SWR4IHx8IF9pZHggPj0gX2VuZElk\neCkKICAgICAgICAgICAgdGhyb3cgbmV3IE5vU3VjaEVsZW1lbnRFeGNlcHRp\nb24oU3RyaW5nLnZhbHVlT2YoX2lkeCkpOwogICAgICAgIHJldHVybiBfZGVs\nZWdhdGUuZ2V0UmVzdWx0T2JqZWN0KCk7CiAgICB9CgogICAgcHVibGljIGJv\nb2xlYW4gbmV4dCgpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIC8vIGFk\ndmFuY2UgdXAgdG8ganVzdCBiZWhpbmQgX3N0YXJ0SWR4IGlmIHdlIGhhdmVu\nJ3QgYWxyZWFkeQogICAgICAgIHdoaWxlIChfaWR4IDwgX3N0YXJ0SWR4IC0g\nMSkgewogICAgICAgICAgICBpZiAoX2RlbGVnYXRlLnN1cHBvcnRzUmFuZG9t\nQWNjZXNzKCkpIHsKICAgICAgICAgICAgICAgIF9pZHggPSBfc3RhcnRJZHgg\nLSAxOwogICAgICAgICAgICAgICAgaWYgKCFfZGVsZWdhdGUuYWJzb2x1dGUo\nX3N0YXJ0SWR4IC0gMSkpCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZh\nbHNlOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgX2lk\neCsrOwogICAgICAgICAgICAgICAgaWYgKCFfZGVsZWdhdGUubmV4dCgpKQog\nICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAg\nfQogICAgICAgIH0KCiAgICAgICAgLy8gbWFrZSBzdXJlIHdlJ3JlIG5vdCBm\nYWxsaW5nIG9mZiB0aGUgZW5kIG9mIHRoZSByYW5nZQogICAgICAgIGlmIChf\naWR4ID49IF9lbmRJZHggLSAxKQogICAgICAgICAgICByZXR1cm4gZmFsc2U7\nCgogICAgICAgIF9pZHgrKzsKICAgICAgICByZXR1cm4gX2RlbGVnYXRlLm5l\neHQoKTsKICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBhYnNvbHV0ZShpbnQg\ncG9zKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBfaWR4ID0gcG9zICsg\nX3N0YXJ0SWR4OwogICAgICAgIGlmIChfaWR4ID49IF9lbmRJZHgpCiAgICAg\nICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICByZXR1cm4gX2RlbGVnYXRl\nLmFic29sdXRlKF9pZHgpOwogICAgfQoKICAgIHB1YmxpYyBpbnQgc2l6ZSgp\nIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIGludCBzaXplID0gX2RlbGVn\nYXRlLnNpemUoKTsKICAgICAgICBpZiAoc2l6ZSA9PSBJbnRlZ2VyLk1BWF9W\nQUxVRSkKICAgICAgICAgICAgcmV0dXJuIHNpemU7CiAgICAgICAgc2l6ZSA9\nIE1hdGgubWluKF9lbmRJZHgsIHNpemUpIC0gX3N0YXJ0SWR4OwogICAgICAg\nIHJldHVybiAoc2l6ZSA8IDApID8gMCA6IHNpemU7CiAgICB9CgogICAgcHVi\nbGljIHZvaWQgcmVzZXQoKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBf\naWR4ID0gLTE7CiAgICAgICAgX2RlbGVnYXRlLnJlc2V0KCk7CiAgICB9Cgog\nICAgcHVibGljIHZvaWQgY2xvc2UoKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAg\nICAgICBfZGVsZWdhdGUuY2xvc2UoKTsKICAgIH0KCiAgICBwdWJsaWMgdm9p\nZCBoYW5kbGVDaGVja2VkRXhjZXB0aW9uKEV4Y2VwdGlvbiBlKSB7CiAgICAg\nICAgX2RlbGVnYXRlLmhhbmRsZUNoZWNrZWRFeGNlcHRpb24oZSk7CiAgICB9\nCiAgICAKICAgIHB1YmxpYyBSZXN1bHRPYmplY3RQcm92aWRlciBnZXREZWxl\nZ2F0ZSgpIHsKICAgICAgICByZXR1cm4gX2RlbGVnYXRlOwogICAgfQp9Cgo=\n","encoding":"base64"}

