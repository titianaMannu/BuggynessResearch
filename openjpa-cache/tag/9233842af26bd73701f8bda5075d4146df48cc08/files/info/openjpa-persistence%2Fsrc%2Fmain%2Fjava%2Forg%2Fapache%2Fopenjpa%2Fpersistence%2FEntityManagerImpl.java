{"sha":"3673d2b3581da5cfb3750bb3c4ee170f1611603f","node_id":"MDQ6QmxvYjIwNjM2NDozNjczZDJiMzU4MWRhNWNmYjM3NTBiYjNjNGVlMTcwZjE2MTE2MDNm","size":54501,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/3673d2b3581da5cfb3750bb3c4ee170f1611603f","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2U7CgppbXBv\ncnQgamF2YS5pby5CeXRlQXJyYXlJbnB1dFN0cmVhbTsKaW1wb3J0IGphdmEu\naW8uQnl0ZUFycmF5T3V0cHV0U3RyZWFtOwppbXBvcnQgamF2YS5pby5FeHRl\ncm5hbGl6YWJsZTsKaW1wb3J0IGphdmEuaW8uSU9FeGNlcHRpb247CmltcG9y\ndCBqYXZhLmlvLk9iamVjdElucHV0OwppbXBvcnQgamF2YS5pby5PYmplY3RJ\nbnB1dFN0cmVhbTsKaW1wb3J0IGphdmEuaW8uT2JqZWN0T3V0cHV0OwppbXBv\ncnQgamF2YS5pby5PYmplY3RPdXRwdXRTdHJlYW07CmltcG9ydCBqYXZhLmlv\nLk9iamVjdFN0cmVhbUNsYXNzOwppbXBvcnQgamF2YS5sYW5nLnJlZmxlY3Qu\nQXJyYXk7CmltcG9ydCBqYXZhLmxhbmcucmVmbGVjdC5NZXRob2Q7CmltcG9y\ndCBqYXZhLnV0aWwuQXJyYXlzOwppbXBvcnQgamF2YS51dGlsLkNvbGxlY3Rp\nb247CmltcG9ydCBqYXZhLnV0aWwuRW51bVNldDsKaW1wb3J0IGphdmEudXRp\nbC5JZGVudGl0eUhhc2hNYXA7CmltcG9ydCBqYXZhLnV0aWwuTWFwOwppbXBv\ncnQgamF2YS51dGlsLlNldDsKCmltcG9ydCBqYXZheC5wZXJzaXN0ZW5jZS5D\nYWNoZVJldHJpZXZlTW9kZTsKaW1wb3J0IGphdmF4LnBlcnNpc3RlbmNlLkNh\nY2hlU3RvcmVNb2RlOwppbXBvcnQgamF2YXgucGVyc2lzdGVuY2UuRW50aXR5\nTWFuYWdlcjsKaW1wb3J0IGphdmF4LnBlcnNpc3RlbmNlLkZsdXNoTW9kZVR5\ncGU7CmltcG9ydCBqYXZheC5wZXJzaXN0ZW5jZS5Mb2NrTW9kZVR5cGU7Cmlt\ncG9ydCBqYXZheC5wZXJzaXN0ZW5jZS5RdWVyeTsKaW1wb3J0IGphdmF4LnBl\ncnNpc3RlbmNlLlR5cGVkUXVlcnk7CmltcG9ydCBqYXZheC5wZXJzaXN0ZW5j\nZS5jcml0ZXJpYS5Dcml0ZXJpYVF1ZXJ5OwppbXBvcnQgamF2YXgucGVyc2lz\ndGVuY2UuY3JpdGVyaWEuUGFyYW1ldGVyRXhwcmVzc2lvbjsKaW1wb3J0IGph\ndmF4LnBlcnNpc3RlbmNlLm1ldGFtb2RlbC5NZXRhbW9kZWw7CgppbXBvcnQg\nb3JnLmFwYWNoZS5jb21tb25zLmxhbmcuU3RyaW5nVXRpbHM7CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEuY29uZi5Db21wYXRpYmlsaXR5OwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLmNvbmYuT3BlbkpQQUNvbmZpZ3VyYXRpb247\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuZWUuTWFuYWdlZFJ1bnRpbWU7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuZW5oYW5jZS5QQ0VuaGFuY2Vy\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmVuaGFuY2UuUENSZWdpc3Ry\neTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5lbmhhbmNlLlJlZmxlY3Rp\nb247CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLkFic3RyYWN0\nQnJva2VyRmFjdG9yeTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJu\nZWwuQnJva2VyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5E\nYXRhQ2FjaGVSZXRyaWV2ZU1vZGU7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEua2VybmVsLkRhdGFDYWNoZVN0b3JlTW9kZTsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5rZXJuZWwuRGVsZWdhdGluZ0Jyb2tlcjsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuRmV0Y2hDb25maWd1cmF0aW9uOwpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5GaW5kQ2FsbGJhY2tz\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5PcENhbGxiYWNr\nczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuT3BlbkpQQVN0\nYXRlTWFuYWdlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwu\nUHJlcGFyZWRRdWVyeTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJu\nZWwuUHJlcGFyZWRRdWVyeUNhY2hlOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLmtlcm5lbC5RdWVyeUZsdXNoTW9kZXM7CmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEua2VybmVsLlF1ZXJ5TGFuZ3VhZ2VzOwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLmtlcm5lbC5TZXE7CmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEua2VybmVsLmpwcWwuSlBRTFBhcnNlcjsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5saWIubG9nLkxvZzsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5saWIudXRpbC5DbG9zZWFibGU7CmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEubGliLnV0aWwuTG9jYWxpemVyOwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLm1ldGEuQ2xhc3NNZXRhRGF0YTsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS5tZXRhLkZpZWxkTWV0YURhdGE7CmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEubWV0YS5RdWVyeU1ldGFEYXRhOwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLm1ldGEuU2VxdWVuY2VNZXRhRGF0YTsKaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5jcml0ZXJpYS5Dcml0ZXJpYUJ1\naWxkZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2Uu\nY3JpdGVyaWEuT3BlbkpQQUNyaXRlcmlhUXVlcnk7CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UudmFsaWRhdGlvbi5WYWxpZGF0aW9u\nVXRpbHM7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5FeGNlcHRp\nb25zOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuSW1wbEhlbHBl\ncjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLlJ1bnRpbWVFeGNl\ncHRpb25UcmFuc2xhdG9yOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0\naWwuVXNlckV4Y2VwdGlvbjsKCmltcG9ydCBzZXJwLnV0aWwuU3RyaW5nczsK\nCi8qKgogKiBJbXBsZW1lbnRhdGlvbiBvZiB7QGxpbmsgRW50aXR5TWFuYWdl\ncn0gaW50ZXJmYWNlLgogKgogKiBAYXV0aG9yIFBhdHJpY2sgTGluc2tleQog\nKiBAYXV0aG9yIEFiZSBXaGl0ZQogKiBAbm9qYXZhZG9jCiAqLwpwdWJsaWMg\nY2xhc3MgRW50aXR5TWFuYWdlckltcGwKICAgIGltcGxlbWVudHMgT3BlbkpQ\nQUVudGl0eU1hbmFnZXJTUEksIEV4dGVybmFsaXphYmxlLAogICAgRmluZENh\nbGxiYWNrcywgT3BDYWxsYmFja3MsIENsb3NlYWJsZSwgT3BlbkpQQUVudGl0\neVRyYW5zYWN0aW9uIHsKCiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBMb2Nh\nbGl6ZXIgX2xvYyA9IExvY2FsaXplci5mb3JQYWNrYWdlKEVudGl0eU1hbmFn\nZXJJbXBsLmNsYXNzKTsKICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIE9iamVj\ndFtdIEVNUFRZX09CSkVDVFMgPSBuZXcgT2JqZWN0WzBdOwoKICAgIHByaXZh\ndGUgRGVsZWdhdGluZ0Jyb2tlciBfYnJva2VyOwogICAgcHJpdmF0ZSBFbnRp\ndHlNYW5hZ2VyRmFjdG9yeUltcGwgX2VtZjsKICAgIHByaXZhdGUgTWFwPEZl\ndGNoQ29uZmlndXJhdGlvbixGZXRjaFBsYW4+IF9wbGFucyA9IG5ldyBJZGVu\ndGl0eUhhc2hNYXA8RmV0Y2hDb25maWd1cmF0aW9uLEZldGNoUGxhbj4oMSk7\nCgogICAgcHJpdmF0ZSBSdW50aW1lRXhjZXB0aW9uVHJhbnNsYXRvciBfcmV0\nID0gUGVyc2lzdGVuY2VFeGNlcHRpb25zLmdldFJvbGxiYWNrVHJhbnNsYXRv\ncih0aGlzKTsKICAgIAogICAgcHJvdGVjdGVkIGZpbmFsIFN0cmluZyBSRVRS\nSUVWRV9NT0RFX1BST1AgPSAiamF2YXgucGVyc2lzdGVuY2UuY2FjaGUucmV0\ncmlldmVNb2RlIjsKICAgIHByb3RlY3RlZCBmaW5hbCBTdHJpbmcgU1RPUkVf\nTU9ERV9QUk9QID0gImphdmF4LnBlcnNpc3RlbmNlLmNhY2hlLnN0b3JlTW9k\nZSI7CgogICAgcHVibGljIEVudGl0eU1hbmFnZXJJbXBsKCkgewogICAgICAg\nIC8vIGZvciBFeHRlcm5hbGl6YWJsZQogICAgfQoKICAgIC8qKgogICAgICog\nQ29uc3RydWN0b3I7IHN1cHBseSBmYWN0b3J5IGFuZCBkZWxlZ2F0ZS4KICAg\nICAqLwogICAgcHVibGljIEVudGl0eU1hbmFnZXJJbXBsKEVudGl0eU1hbmFn\nZXJGYWN0b3J5SW1wbCBmYWN0b3J5LCBCcm9rZXIgYnJva2VyKSB7CiAgICAg\nICAgaW5pdGlhbGl6ZShmYWN0b3J5LCBicm9rZXIpOwogICAgfQoKICAgIHBy\naXZhdGUgdm9pZCBpbml0aWFsaXplKEVudGl0eU1hbmFnZXJGYWN0b3J5SW1w\nbCBmYWN0b3J5LCBCcm9rZXIgYnJva2VyKSB7CiAgICAgICAgX2VtZiA9IGZh\nY3Rvcnk7CiAgICAgICAgX2Jyb2tlciA9IG5ldyBEZWxlZ2F0aW5nQnJva2Vy\nKGJyb2tlciwgX3JldCk7CiAgICAgICAgX2Jyb2tlci5zZXRJbXBsaWNpdEJl\naGF2aW9yKHRoaXMsIF9yZXQpOwogICAgfQoKICAgIC8qKgogICAgICogQnJv\na2VyIGRlbGVnYXRlLgogICAgICovCiAgICBwdWJsaWMgQnJva2VyIGdldEJy\nb2tlcigpIHsKICAgICAgICByZXR1cm4gX2Jyb2tlci5nZXREZWxlZ2F0ZSgp\nOwogICAgfQoKICAgIHB1YmxpYyBPcGVuSlBBRW50aXR5TWFuYWdlckZhY3Rv\ncnkgZ2V0RW50aXR5TWFuYWdlckZhY3RvcnkoKSB7CiAgICAgICAgcmV0dXJu\nIF9lbWY7CiAgICB9CgogICAgcHVibGljIE9wZW5KUEFDb25maWd1cmF0aW9u\nIGdldENvbmZpZ3VyYXRpb24oKSB7CiAgICAgICAgcmV0dXJuIF9icm9rZXIu\nZ2V0Q29uZmlndXJhdGlvbigpOwogICAgfQoKICAgIHB1YmxpYyBGZXRjaFBs\nYW4gZ2V0RmV0Y2hQbGFuKCkgewogICAgICAgIGFzc2VydE5vdENsb3NlSW52\nb2tlZCgpOwogICAgICAgIF9icm9rZXIubG9jaygpOwogICAgICAgIHRyeSB7\nCiAgICAgICAgICAgIEZldGNoQ29uZmlndXJhdGlvbiBmYyA9IF9icm9rZXIu\nZ2V0RmV0Y2hDb25maWd1cmF0aW9uKCk7CiAgICAgICAgICAgIEZldGNoUGxh\nbiBmcCA9IF9wbGFucy5nZXQoZmMpOwogICAgICAgICAgICBpZiAoZnAgPT0g\nbnVsbCkgewogICAgICAgICAgICAgICAgZnAgPSBfZW1mLnRvRmV0Y2hQbGFu\nKF9icm9rZXIsIGZjKTsKICAgICAgICAgICAgICAgIF9wbGFucy5wdXQoZmMs\nIGZwKTsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gZnA7CiAg\nICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgX2Jyb2tlci51bmxvY2so\nKTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGljIEZldGNoUGxhbiBwdXNo\nRmV0Y2hQbGFuKCkgewogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgp\nOwogICAgICAgIF9icm9rZXIubG9jaygpOwogICAgICAgIHRyeSB7CiAgICAg\nICAgICAgIF9icm9rZXIucHVzaEZldGNoQ29uZmlndXJhdGlvbigpOwogICAg\nICAgICAgICByZXR1cm4gZ2V0RmV0Y2hQbGFuKCk7CiAgICAgICAgfSBmaW5h\nbGx5IHsKICAgICAgICAgICAgX2Jyb2tlci51bmxvY2soKTsKICAgICAgICB9\nCiAgICB9CgogICAgcHVibGljIHZvaWQgcG9wRmV0Y2hQbGFuKCkgewogICAg\nICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIF9icm9rZXIu\nbG9jaygpOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIF9icm9rZXIucG9w\nRmV0Y2hDb25maWd1cmF0aW9uKCk7CiAgICAgICAgfSBmaW5hbGx5IHsKICAg\nICAgICAgICAgX2Jyb2tlci51bmxvY2soKTsKICAgICAgICB9CiAgICB9Cgog\nICAgcHVibGljIENvbm5lY3Rpb25SZXRhaW5Nb2RlIGdldENvbm5lY3Rpb25S\nZXRhaW5Nb2RlKCkgewogICAgICAgIHJldHVybiBDb25uZWN0aW9uUmV0YWlu\nTW9kZS5mcm9tS2VybmVsQ29uc3RhbnQoCiAgICAgICAgICAgIF9icm9rZXIu\nZ2V0Q29ubmVjdGlvblJldGFpbk1vZGUoKSk7CiAgICB9CgogICAgcHVibGlj\nIGJvb2xlYW4gaXNUcmFuc2FjdGlvbk1hbmFnZWQoKSB7CiAgICAgICAgcmV0\ndXJuIF9icm9rZXIuaXNNYW5hZ2VkKCk7CiAgICB9CgogICAgcHVibGljIGJv\nb2xlYW4gaXNNYW5hZ2VkKCkgewogICAgICAgIHJldHVybiBfYnJva2VyLmlz\nTWFuYWdlZCgpOwogICAgfQoKICAgIHB1YmxpYyBNYW5hZ2VkUnVudGltZSBn\nZXRNYW5hZ2VkUnVudGltZSgpIHsKICAgICAgICByZXR1cm4gX2Jyb2tlci5n\nZXRNYW5hZ2VkUnVudGltZSgpOwogICAgfQoKICAgIHB1YmxpYyBib29sZWFu\nIGdldFN5bmNXaXRoTWFuYWdlZFRyYW5zYWN0aW9ucygpIHsKICAgICAgICBy\nZXR1cm4gX2Jyb2tlci5nZXRTeW5jV2l0aE1hbmFnZWRUcmFuc2FjdGlvbnMo\nKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRTeW5jV2l0aE1hbmFnZWRU\ncmFuc2FjdGlvbnMoYm9vbGVhbiBzeW5jKSB7CiAgICAgICAgYXNzZXJ0Tm90\nQ2xvc2VJbnZva2VkKCk7CiAgICAgICAgX2Jyb2tlci5zZXRTeW5jV2l0aE1h\nbmFnZWRUcmFuc2FjdGlvbnMoc3luYyk7CiAgICB9CgogICAgcHVibGljIENs\nYXNzTG9hZGVyIGdldENsYXNzTG9hZGVyKCkgewogICAgICAgIHJldHVybiBf\nYnJva2VyLmdldENsYXNzTG9hZGVyKCk7CiAgICB9CgogICAgcHVibGljIFN0\ncmluZyBnZXRDb25uZWN0aW9uVXNlck5hbWUoKSB7CiAgICAgICAgcmV0dXJu\nIF9icm9rZXIuZ2V0Q29ubmVjdGlvblVzZXJOYW1lKCk7CiAgICB9CgogICAg\ncHVibGljIFN0cmluZyBnZXRDb25uZWN0aW9uUGFzc3dvcmQoKSB7CiAgICAg\nICAgcmV0dXJuIF9icm9rZXIuZ2V0Q29ubmVjdGlvblBhc3N3b3JkKCk7CiAg\nICB9CgogICAgcHVibGljIGJvb2xlYW4gZ2V0TXVsdGl0aHJlYWRlZCgpIHsK\nICAgICAgICByZXR1cm4gX2Jyb2tlci5nZXRNdWx0aXRocmVhZGVkKCk7CiAg\nICB9CgogICAgcHVibGljIHZvaWQgc2V0TXVsdGl0aHJlYWRlZChib29sZWFu\nIG11bHRpdGhyZWFkZWQpIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUludm9r\nZWQoKTsKICAgICAgICBfYnJva2VyLnNldE11bHRpdGhyZWFkZWQobXVsdGl0\naHJlYWRlZCk7CiAgICB9CgogICAgcHVibGljIGJvb2xlYW4gZ2V0SWdub3Jl\nQ2hhbmdlcygpIHsKICAgICAgICByZXR1cm4gX2Jyb2tlci5nZXRJZ25vcmVD\naGFuZ2VzKCk7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0SWdub3JlQ2hh\nbmdlcyhib29sZWFuIHZhbCkgewogICAgICAgIGFzc2VydE5vdENsb3NlSW52\nb2tlZCgpOwogICAgICAgIF9icm9rZXIuc2V0SWdub3JlQ2hhbmdlcyh2YWwp\nOwogICAgfQoKICAgIHB1YmxpYyBib29sZWFuIGdldE5vbnRyYW5zYWN0aW9u\nYWxSZWFkKCkgewogICAgICAgIHJldHVybiBfYnJva2VyLmdldE5vbnRyYW5z\nYWN0aW9uYWxSZWFkKCk7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0Tm9u\ndHJhbnNhY3Rpb25hbFJlYWQoYm9vbGVhbiB2YWwpIHsKICAgICAgICBhc3Nl\ncnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICBfYnJva2VyLnNldE5vbnRy\nYW5zYWN0aW9uYWxSZWFkKHZhbCk7CiAgICB9CgogICAgcHVibGljIGJvb2xl\nYW4gZ2V0Tm9udHJhbnNhY3Rpb25hbFdyaXRlKCkgewogICAgICAgIHJldHVy\nbiBfYnJva2VyLmdldE5vbnRyYW5zYWN0aW9uYWxXcml0ZSgpOwogICAgfQoK\nICAgIHB1YmxpYyB2b2lkIHNldE5vbnRyYW5zYWN0aW9uYWxXcml0ZShib29s\nZWFuIHZhbCkgewogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwog\nICAgICAgIF9icm9rZXIuc2V0Tm9udHJhbnNhY3Rpb25hbFdyaXRlKHZhbCk7\nCiAgICB9CgogICAgcHVibGljIGJvb2xlYW4gZ2V0T3B0aW1pc3RpYygpIHsK\nICAgICAgICByZXR1cm4gX2Jyb2tlci5nZXRPcHRpbWlzdGljKCk7CiAgICB9\nCgogICAgcHVibGljIHZvaWQgc2V0T3B0aW1pc3RpYyhib29sZWFuIHZhbCkg\newogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIF9i\ncm9rZXIuc2V0T3B0aW1pc3RpYyh2YWwpOwogICAgfQoKICAgIHB1YmxpYyBS\nZXN0b3JlU3RhdGVUeXBlIGdldFJlc3RvcmVTdGF0ZSgpIHsKICAgICAgICBy\nZXR1cm4gUmVzdG9yZVN0YXRlVHlwZS5mcm9tS2VybmVsQ29uc3RhbnQoX2Jy\nb2tlci5nZXRSZXN0b3JlU3RhdGUoKSk7CiAgICB9CgogICAgcHVibGljIHZv\naWQgc2V0UmVzdG9yZVN0YXRlKFJlc3RvcmVTdGF0ZVR5cGUgdmFsKSB7CiAg\nICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAgX2Jyb2tl\nci5zZXRSZXN0b3JlU3RhdGUodmFsLnRvS2VybmVsQ29uc3RhbnQoKSk7CiAg\nICB9CgogICAgcHVibGljIHZvaWQgc2V0UmVzdG9yZVN0YXRlKGludCByZXN0\nb3JlKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAg\nICAgX2Jyb2tlci5zZXRSZXN0b3JlU3RhdGUocmVzdG9yZSk7CiAgICB9Cgog\nICAgcHVibGljIGJvb2xlYW4gZ2V0UmV0YWluU3RhdGUoKSB7CiAgICAgICAg\ncmV0dXJuIF9icm9rZXIuZ2V0UmV0YWluU3RhdGUoKTsKICAgIH0KCiAgICBw\ndWJsaWMgdm9pZCBzZXRSZXRhaW5TdGF0ZShib29sZWFuIHZhbCkgewogICAg\nICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIF9icm9rZXIu\nc2V0UmV0YWluU3RhdGUodmFsKTsKICAgIH0KCiAgICBwdWJsaWMgQXV0b0Ns\nZWFyVHlwZSBnZXRBdXRvQ2xlYXIoKSB7CiAgICAgICAgcmV0dXJuIEF1dG9D\nbGVhclR5cGUuZnJvbUtlcm5lbENvbnN0YW50KF9icm9rZXIuZ2V0QXV0b0Ns\nZWFyKCkpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldEF1dG9DbGVhcihB\ndXRvQ2xlYXJUeXBlIHZhbCkgewogICAgICAgIGFzc2VydE5vdENsb3NlSW52\nb2tlZCgpOwogICAgICAgIF9icm9rZXIuc2V0QXV0b0NsZWFyKHZhbC50b0tl\ncm5lbENvbnN0YW50KCkpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldEF1\ndG9DbGVhcihpbnQgYXV0b0NsZWFyKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xv\nc2VJbnZva2VkKCk7CiAgICAgICAgX2Jyb2tlci5zZXRBdXRvQ2xlYXIoYXV0\nb0NsZWFyKTsKICAgIH0KCiAgICBwdWJsaWMgRGV0YWNoU3RhdGVUeXBlIGdl\ndERldGFjaFN0YXRlKCkgewogICAgICAgIHJldHVybiBEZXRhY2hTdGF0ZVR5\ncGUuZnJvbUtlcm5lbENvbnN0YW50KF9icm9rZXIuZ2V0RGV0YWNoU3RhdGUo\nKSk7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0RGV0YWNoU3RhdGUoRGV0\nYWNoU3RhdGVUeXBlIHR5cGUpIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUlu\ndm9rZWQoKTsKICAgICAgICBfYnJva2VyLnNldERldGFjaFN0YXRlKHR5cGUu\ndG9LZXJuZWxDb25zdGFudCgpKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBz\nZXREZXRhY2hTdGF0ZShpbnQgZGV0YWNoKSB7CiAgICAgICAgYXNzZXJ0Tm90\nQ2xvc2VJbnZva2VkKCk7CiAgICAgICAgX2Jyb2tlci5zZXREZXRhY2hTdGF0\nZShkZXRhY2gpOwogICAgfQoKICAgIHB1YmxpYyBFbnVtU2V0PEF1dG9EZXRh\nY2hUeXBlPiBnZXRBdXRvRGV0YWNoKCkgewogICAgICAgIHJldHVybiBBdXRv\nRGV0YWNoVHlwZS50b0VudW1TZXQoX2Jyb2tlci5nZXRBdXRvRGV0YWNoKCkp\nOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldEF1dG9EZXRhY2goQXV0b0Rl\ndGFjaFR5cGUgZmxhZykgewogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tl\nZCgpOwogICAgICAgIF9icm9rZXIuc2V0QXV0b0RldGFjaChBdXRvRGV0YWNo\nVHlwZS5mcm9tRW51bVNldChFbnVtU2V0Lm9mKGZsYWcpKSk7CiAgICB9Cgog\nICAgcHVibGljIHZvaWQgc2V0QXV0b0RldGFjaChFbnVtU2V0PEF1dG9EZXRh\nY2hUeXBlPiBmbGFncykgewogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tl\nZCgpOwogICAgICAgIF9icm9rZXIuc2V0QXV0b0RldGFjaChBdXRvRGV0YWNo\nVHlwZS5mcm9tRW51bVNldChmbGFncykpOwogICAgfQoKICAgIHB1YmxpYyB2\nb2lkIHNldEF1dG9EZXRhY2goaW50IGF1dG9EZXRhY2hGbGFncykgewogICAg\nICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIF9icm9rZXIu\nc2V0QXV0b0RldGFjaChhdXRvRGV0YWNoRmxhZ3MpOwogICAgfQoKICAgIHB1\nYmxpYyB2b2lkIHNldEF1dG9EZXRhY2goQXV0b0RldGFjaFR5cGUgdmFsdWUs\nIGJvb2xlYW4gb24pIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQo\nKTsKICAgICAgICBfYnJva2VyLnNldEF1dG9EZXRhY2goQXV0b0RldGFjaFR5\ncGUuZnJvbUVudW1TZXQoRW51bVNldC5vZih2YWx1ZSkpLG9uKTsKICAgIH0K\nCiAgICBwdWJsaWMgdm9pZCBzZXRBdXRvRGV0YWNoKGludCBmbGFnLCBib29s\nZWFuIG9uKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAg\nICAgICAgX2Jyb2tlci5zZXRBdXRvRGV0YWNoKGZsYWcsIG9uKTsKICAgIH0K\nCiAgICBwdWJsaWMgYm9vbGVhbiBnZXRFdmljdEZyb21TdG9yZUNhY2hlKCkg\newogICAgICAgIHJldHVybiBfYnJva2VyLmdldEV2aWN0RnJvbURhdGFDYWNo\nZSgpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldEV2aWN0RnJvbVN0b3Jl\nQ2FjaGUoYm9vbGVhbiBldmljdCkgewogICAgICAgIGFzc2VydE5vdENsb3Nl\nSW52b2tlZCgpOwogICAgICAgIF9icm9rZXIuc2V0RXZpY3RGcm9tRGF0YUNh\nY2hlKGV2aWN0KTsKICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBnZXRQb3B1\nbGF0ZVN0b3JlQ2FjaGUoKSB7CiAgICAgICAgcmV0dXJuIF9icm9rZXIuZ2V0\nUG9wdWxhdGVEYXRhQ2FjaGUoKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBz\nZXRQb3B1bGF0ZVN0b3JlQ2FjaGUoYm9vbGVhbiBjYWNoZSkgewogICAgICAg\nIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIF9icm9rZXIuc2V0\nUG9wdWxhdGVEYXRhQ2FjaGUoY2FjaGUpOwogICAgfQoKICAgIHB1YmxpYyBi\nb29sZWFuIGlzVHJhY2tDaGFuZ2VzQnlUeXBlKCkgewogICAgICAgIHJldHVy\nbiBfYnJva2VyLmlzVHJhY2tDaGFuZ2VzQnlUeXBlKCk7CiAgICB9CgogICAg\ncHVibGljIHZvaWQgc2V0VHJhY2tDaGFuZ2VzQnlUeXBlKGJvb2xlYW4gdHJh\nY2tCeVR5cGUpIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsK\nICAgICAgICBfYnJva2VyLnNldFRyYWNrQ2hhbmdlc0J5VHlwZSh0cmFja0J5\nVHlwZSk7CiAgICB9CgogICAgcHVibGljIGJvb2xlYW4gaXNMYXJnZVRyYW5z\nYWN0aW9uKCkgewogICAgICAgIHJldHVybiBpc1RyYWNrQ2hhbmdlc0J5VHlw\nZSgpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldExhcmdlVHJhbnNhY3Rp\nb24oYm9vbGVhbiB2YWx1ZSkgewogICAgICAgIHNldFRyYWNrQ2hhbmdlc0J5\nVHlwZSh2YWx1ZSk7CiAgICB9CgogICAgcHVibGljIE9iamVjdCBnZXRVc2Vy\nT2JqZWN0KE9iamVjdCBrZXkpIHsKICAgICAgICByZXR1cm4gX2Jyb2tlci5n\nZXRVc2VyT2JqZWN0KGtleSk7CiAgICB9CgogICAgcHVibGljIE9iamVjdCBw\ndXRVc2VyT2JqZWN0KE9iamVjdCBrZXksIE9iamVjdCB2YWwpIHsKICAgICAg\nICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICByZXR1cm4gX2Jy\nb2tlci5wdXRVc2VyT2JqZWN0KGtleSwgdmFsKTsKICAgIH0KCiAgICBwdWJs\naWMgdm9pZCBhZGRUcmFuc2FjdGlvbkxpc3RlbmVyKE9iamVjdCBsaXN0ZW5l\ncikgewogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAgICAg\nIF9icm9rZXIuYWRkVHJhbnNhY3Rpb25MaXN0ZW5lcihsaXN0ZW5lcik7CiAg\nICB9CgogICAgcHVibGljIHZvaWQgcmVtb3ZlVHJhbnNhY3Rpb25MaXN0ZW5l\ncihPYmplY3QgbGlzdGVuZXIpIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUlu\ndm9rZWQoKTsKICAgICAgICBfYnJva2VyLnJlbW92ZVRyYW5zYWN0aW9uTGlz\ndGVuZXIobGlzdGVuZXIpOwogICAgfQoKICAgIHB1YmxpYyBFbnVtU2V0PENh\nbGxiYWNrTW9kZT4gZ2V0VHJhbnNhY3Rpb25MaXN0ZW5lckNhbGxiYWNrTW9k\nZXMoKSB7CiAgICAgICAgcmV0dXJuIENhbGxiYWNrTW9kZS50b0VudW1TZXQo\nCiAgICAgICAgICAgIF9icm9rZXIuZ2V0VHJhbnNhY3Rpb25MaXN0ZW5lckNh\nbGxiYWNrTW9kZSgpKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRUcmFu\nc2FjdGlvbkxpc3RlbmVyQ2FsbGJhY2tNb2RlKENhbGxiYWNrTW9kZSBtb2Rl\nKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAg\nX2Jyb2tlci5zZXRUcmFuc2FjdGlvbkxpc3RlbmVyQ2FsbGJhY2tNb2RlKAog\nICAgICAgICAgICBDYWxsYmFja01vZGUuZnJvbUVudW1TZXQoRW51bVNldC5v\nZihtb2RlKSkpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldFRyYW5zYWN0\naW9uTGlzdGVuZXJDYWxsYmFja01vZGUoRW51bVNldDxDYWxsYmFja01vZGU+\nIG1vZGVzKXsKICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAg\nICAgICBfYnJva2VyLnNldFRyYW5zYWN0aW9uTGlzdGVuZXJDYWxsYmFja01v\nZGUoCiAgICAgICAgICAgIENhbGxiYWNrTW9kZS5mcm9tRW51bVNldChtb2Rl\ncykpOwogICAgfQoKICAgIHB1YmxpYyBpbnQgZ2V0VHJhbnNhY3Rpb25MaXN0\nZW5lckNhbGxiYWNrTW9kZSgpIHsKICAgICAgICByZXR1cm4gX2Jyb2tlci5n\nZXRUcmFuc2FjdGlvbkxpc3RlbmVyQ2FsbGJhY2tNb2RlKCk7CiAgICB9Cgog\nICAgcHVibGljIHZvaWQgc2V0VHJhbnNhY3Rpb25MaXN0ZW5lckNhbGxiYWNr\nTW9kZShpbnQgY2FsbGJhY2tNb2RlKSB7CiAgICAgICAgdGhyb3cgbmV3IFVu\nc3VwcG9ydGVkT3BlcmF0aW9uRXhjZXB0aW9uKCk7CiAgICB9CgogICAgcHVi\nbGljIHZvaWQgYWRkTGlmZWN5Y2xlTGlzdGVuZXIoT2JqZWN0IGxpc3RlbmVy\nLCBDbGFzcy4uLiBjbGFzc2VzKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJ\nbnZva2VkKCk7CiAgICAgICAgX2Jyb2tlci5hZGRMaWZlY3ljbGVMaXN0ZW5l\ncihsaXN0ZW5lciwgY2xhc3Nlcyk7CiAgICB9CgogICAgcHVibGljIHZvaWQg\ncmVtb3ZlTGlmZWN5Y2xlTGlzdGVuZXIoT2JqZWN0IGxpc3RlbmVyKSB7CiAg\nICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAgX2Jyb2tl\nci5yZW1vdmVMaWZlY3ljbGVMaXN0ZW5lcihsaXN0ZW5lcik7CiAgICB9Cgog\nICAgcHVibGljIEVudW1TZXQ8Q2FsbGJhY2tNb2RlPiBnZXRMaWZlY3ljbGVM\naXN0ZW5lckNhbGxiYWNrTW9kZXMoKSB7CiAgICAgICAgcmV0dXJuIENhbGxi\nYWNrTW9kZS50b0VudW1TZXQoCiAgICAgICAgICAgIF9icm9rZXIuZ2V0TGlm\nZWN5Y2xlTGlzdGVuZXJDYWxsYmFja01vZGUoKSk7CiAgICB9CgogICAgcHVi\nbGljIHZvaWQgc2V0TGlmZWN5Y2xlTGlzdGVuZXJDYWxsYmFja01vZGUoQ2Fs\nbGJhY2tNb2RlIG1vZGUpIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUludm9r\nZWQoKTsKICAgICAgICBfYnJva2VyLnNldExpZmVjeWNsZUxpc3RlbmVyQ2Fs\nbGJhY2tNb2RlKAogICAgICAgICAgICBDYWxsYmFja01vZGUuZnJvbUVudW1T\nZXQoRW51bVNldC5vZihtb2RlKSkpOwogICAgfQoKICAgIHB1YmxpYyB2b2lk\nIHNldExpZmVjeWNsZUxpc3RlbmVyQ2FsbGJhY2tNb2RlKEVudW1TZXQ8Q2Fs\nbGJhY2tNb2RlPiBtb2RlcykgewogICAgICAgIGFzc2VydE5vdENsb3NlSW52\nb2tlZCgpOwogICAgICAgIF9icm9rZXIuc2V0TGlmZWN5Y2xlTGlzdGVuZXJD\nYWxsYmFja01vZGUoCiAgICAgICAgICAgIENhbGxiYWNrTW9kZS5mcm9tRW51\nbVNldChtb2RlcykpOwogICAgfQoKICAgIHB1YmxpYyBpbnQgZ2V0TGlmZWN5\nY2xlTGlzdGVuZXJDYWxsYmFja01vZGUoKSB7CiAgICAgICAgcmV0dXJuIF9i\ncm9rZXIuZ2V0TGlmZWN5Y2xlTGlzdGVuZXJDYWxsYmFja01vZGUoKTsKICAg\nIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRMaWZlY3ljbGVMaXN0ZW5lckNhbGxi\nYWNrTW9kZShpbnQgY2FsbGJhY2tNb2RlKSB7CiAgICAgICAgYXNzZXJ0Tm90\nQ2xvc2VJbnZva2VkKCk7CiAgICAgICAgX2Jyb2tlci5zZXRMaWZlY3ljbGVM\naXN0ZW5lckNhbGxiYWNrTW9kZShjYWxsYmFja01vZGUpOwogICAgfQoKICAg\nIEBTdXBwcmVzc1dhcm5pbmdzKCJ1bmNoZWNrZWQiKQogICAgcHVibGljIDxU\nPiBUIGdldFJlZmVyZW5jZShDbGFzczxUPiBjbHMsIE9iamVjdCBvaWQpIHsK\nICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICBvaWQg\nPSBfYnJva2VyLm5ld09iamVjdElkKGNscywgb2lkKTsKICAgICAgICByZXR1\ncm4gKFQpIF9icm9rZXIuZmluZChvaWQsIGZhbHNlLCB0aGlzKTsKICAgIH0K\nCiAgICBAU3VwcHJlc3NXYXJuaW5ncygidW5jaGVja2VkIikKICAgIHB1Ymxp\nYyA8VD4gVCBmaW5kKENsYXNzPFQ+IGNscywgT2JqZWN0IG9pZCkgewogICAg\nICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIGlmIChvaWQg\nPT0gbnVsbCkKICAgICAgICAJcmV0dXJuIG51bGw7CiAgICAgICAgb2lkID0g\nX2Jyb2tlci5uZXdPYmplY3RJZChjbHMsIG9pZCk7CiAgICAgICAgcmV0dXJu\nIChUKSBfYnJva2VyLmZpbmQob2lkLCB0cnVlLCB0aGlzKTsKICAgIH0KCiAg\nICBwdWJsaWMgPFQ+IFQgZmluZChDbGFzczxUPiBjbHMsIE9iamVjdCBvaWQs\nIExvY2tNb2RlVHlwZSBtb2RlKSB7CiAgICAgICAgcmV0dXJuIGZpbmQoY2xz\nLCBvaWQsIG1vZGUsIG51bGwpOwogICAgfQoKICAgIHB1YmxpYyA8VD4gVCBm\naW5kKENsYXNzPFQ+IGNscywgT2JqZWN0IG9pZCwgCiAgICAgICAgTWFwPFN0\ncmluZywgT2JqZWN0PiBwcm9wZXJ0aWVzKXsKICAgICAgICByZXR1cm4gZmlu\nZChjbHMsIG9pZCwgbnVsbCwgcHJvcGVydGllcyk7CiAgICB9CgogICAgQFN1\ncHByZXNzV2FybmluZ3MoInVuY2hlY2tlZCIpCiAgICBwdWJsaWMgPFQ+IFQg\nZmluZChDbGFzczxUPiBjbHMsIE9iamVjdCBvaWQsIExvY2tNb2RlVHlwZSBt\nb2RlLAogICAgICAgIE1hcDxTdHJpbmcsIE9iamVjdD4gcHJvcGVydGllcykg\newogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIGlm\nIChtb2RlICE9IG51bGwgJiYgbW9kZSAhPSBMb2NrTW9kZVR5cGUuTk9ORSkg\newogICAgICAgICAgICBfYnJva2VyLmFzc2VydEFjdGl2ZVRyYW5zYWN0aW9u\nKCk7CiAgICAgICAgfQogICAgICAgIHByb2Nlc3NMb2NrUHJvcGVydGllcyhw\ndXNoRmV0Y2hQbGFuKCksIG1vZGUsIHByb3BlcnRpZXMpOwogICAgICAgIHRy\neSB7CiAgICAgICAgICAgIG9pZCA9IF9icm9rZXIubmV3T2JqZWN0SWQoY2xz\nLCBvaWQpOwogICAgICAgICAgICByZXR1cm4gKFQpIF9icm9rZXIuZmluZChv\naWQsIHRydWUsIHRoaXMpOwogICAgICAgIH0gZmluYWxseSB7CiAgICAgICAg\nICAgIHBvcEZldGNoUGxhbigpOwogICAgICAgIH0KICAgIH0KCiAgICBAU3Vw\ncHJlc3NXYXJuaW5ncygidW5jaGVja2VkIikKICAgIHB1YmxpYyA8VD4gVFtd\nIGZpbmRBbGwoQ2xhc3M8VD4gY2xzLCBPYmplY3QuLi4gb2lkcykgewogICAg\nICAgIGlmIChvaWRzLmxlbmd0aCA9PSAwKQogICAgICAgICAgICByZXR1cm4g\nKFRbXSkgQXJyYXkubmV3SW5zdGFuY2UoY2xzLCAwKTsKICAgICAgICBDb2xs\nZWN0aW9uPFQ+IHJldCA9IGZpbmRBbGwoY2xzLCBBcnJheXMuYXNMaXN0KG9p\nZHMpKTsKICAgICAgICByZXR1cm4gcmV0LnRvQXJyYXkoKFRbXSkgQXJyYXku\nbmV3SW5zdGFuY2UoY2xzLCByZXQuc2l6ZSgpKSk7CiAgICB9CgogICAgQFN1\ncHByZXNzV2FybmluZ3MoInVuY2hlY2tlZCIpCiAgICBwdWJsaWMgPFQ+IENv\nbGxlY3Rpb248VD4gZmluZEFsbChmaW5hbCBDbGFzczxUPiBjbHMsIENvbGxl\nY3Rpb24gb2lkcykgewogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgp\nOwogICAgICAgIE9iamVjdFtdIG9ianMgPSBfYnJva2VyLmZpbmRBbGwob2lk\ncywgdHJ1ZSwgbmV3IEZpbmRDYWxsYmFja3MoKSB7CiAgICAgICAgICAgIHB1\nYmxpYyBPYmplY3QgcHJvY2Vzc0FyZ3VtZW50KE9iamVjdCBvaWQpIHsKICAg\nICAgICAgICAgICAgIHJldHVybiBfYnJva2VyLm5ld09iamVjdElkKGNscywg\nb2lkKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHVibGljIE9iamVj\ndCBwcm9jZXNzUmV0dXJuKE9iamVjdCBvaWQsIE9wZW5KUEFTdGF0ZU1hbmFn\nZXIgc20pIHsKICAgICAgICAgICAgICAgIHJldHVybiBFbnRpdHlNYW5hZ2Vy\nSW1wbC50aGlzLnByb2Nlc3NSZXR1cm4ob2lkLCBzbSk7CiAgICAgICAgICAg\nIH0KICAgICAgICB9KTsKICAgICAgICByZXR1cm4gKENvbGxlY3Rpb248VD4p\nIEFycmF5cy5hc0xpc3Qob2Jqcyk7CiAgICB9CgogICAgQFN1cHByZXNzV2Fy\nbmluZ3MoInVuY2hlY2tlZCIpCiAgICBwdWJsaWMgPFQ+IFQgZmluZENhY2hl\nZChDbGFzczxUPiBjbHMsIE9iamVjdCBvaWQpIHsKICAgICAgICBhc3NlcnRO\nb3RDbG9zZUludm9rZWQoKTsKICAgICAgICByZXR1cm4gKFQpIF9icm9rZXIu\nZmluZENhY2hlZChfYnJva2VyLm5ld09iamVjdElkKGNscywgb2lkKSwgdGhp\ncyk7CiAgICB9CgogICAgcHVibGljIENsYXNzIGdldE9iamVjdElkQ2xhc3Mo\nQ2xhc3MgY2xzKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7\nCiAgICAgICAgaWYgKGNscyA9PSBudWxsKQogICAgICAgICAgICByZXR1cm4g\nbnVsbDsKICAgICAgICByZXR1cm4gSlBBRmFjYWRlSGVscGVyLmZyb21PcGVu\nSlBBT2JqZWN0SWRDbGFzcwogICAgICAgICAgICAgICAgKF9icm9rZXIuZ2V0\nT2JqZWN0SWRUeXBlKGNscykpOwogICAgfQoKICAgIHB1YmxpYyBPcGVuSlBB\nRW50aXR5VHJhbnNhY3Rpb24gZ2V0VHJhbnNhY3Rpb24oKSB7CiAgICAgICAg\naWYgKF9icm9rZXIuaXNNYW5hZ2VkKCkpCiAgICAgICAgICAgIHRocm93IG5l\ndyBJbnZhbGlkU3RhdGVFeGNlcHRpb24oX2xvYy5nZXQoImdldC1tYW5hZ2Vk\nLXRyYW5zIiksCiAgICAgICAgICAgICAgICBudWxsLCBudWxsLCBmYWxzZSk7\nCiAgICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CgogICAgcHVibGljIHZvaWQg\nam9pblRyYW5zYWN0aW9uKCkgewogICAgICAgIGFzc2VydE5vdENsb3NlSW52\nb2tlZCgpOwogICAgICAgIGlmICghX2Jyb2tlci5zeW5jV2l0aE1hbmFnZWRU\ncmFuc2FjdGlvbigpKQogICAgICAgICAgICB0aHJvdyBuZXcgVHJhbnNhY3Rp\nb25SZXF1aXJlZEV4Y2VwdGlvbihfbG9jLmdldAogICAgICAgICAgICAgICAg\nKCJuby1tYW5hZ2VkLXRyYW5zIiksIG51bGwsIG51bGwsIGZhbHNlKTsKICAg\nIH0KCiAgICBwdWJsaWMgdm9pZCBiZWdpbigpIHsKICAgICAgICBfYnJva2Vy\nLmJlZ2luKCk7CiAgICB9CgogICAgcHVibGljIHZvaWQgY29tbWl0KCkgewog\nICAgICAgIHRyeSB7CiAgICAgICAgICAgIF9icm9rZXIuY29tbWl0KCk7CiAg\nICAgICAgfSBjYXRjaCAoUm9sbGJhY2tFeGNlcHRpb24gZSkgewogICAgICAg\nICAgICB0aHJvdyBlOwogICAgICAgIH0gY2F0Y2ggKElsbGVnYWxTdGF0ZUV4\nY2VwdGlvbiBlKSB7CiAgICAgICAgICAgIHRocm93IGU7CiAgICAgICAgfSBj\nYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICAJLy8gUGVyIEpQQSAyLjAg\nc3BlYywgaWYgdGhlIGV4Y2VwdGlvbiB3YXMgZHVlIHRvIGEgSlNSLTMwMyAK\nICAgICAgICAgICAgLy8gY29uc3RyYWludCB2aW9sYXRpb24sIHRoZSBDb25z\ndHJhaW50VmlvbGF0aW9uRXhjZXB0aW9uIHNob3VsZCBiZSAKICAgICAgICAg\nICAgLy8gdGhyb3duLiAgU2luY2UgSlNSLTMwMyBpcyBvcHRpb25hbCwgdGhl\nIGNhc3QgdG8gUnVudGltZUV4Y2VwdGlvbiAKICAgICAgICAgICAgLy8gcHJl\ndmVudHMgdGhlIGludHJvZHVjdGlvbiBvZiBhIHJ1bnRpbWUgZGVwZW5kZW5j\neSBvbiB0aGUgQlYgQVBJLgogICAgICAgICAgICBpZiAoVmFsaWRhdGlvblV0\naWxzLmlzQ29uc3RyYWludFZpb2xhdGlvbkV4Y2VwdGlvbihlKSkKICAgICAg\nICAgICAgICAgIHRocm93IChSdW50aW1lRXhjZXB0aW9uKWU7CiAgICAgICAg\nICAgIC8vIFJvbGxiYWNrRXhjZXB0aW9ucyBhcmUgc3BlY2lhbCBhbmQgYXJl\nbid0IGhhbmRsZWQgYnkgdGhlCiAgICAgICAgICAgIC8vIG5vcm1hbCBleGNl\ncHRpb24gdHJhbnNsYXRvciwgc2luY2UgdGhlIHNwZWMgc2F5cyB0aGV5CiAg\nICAgICAgICAgIC8vIHNob3VsZCBiZSB0aHJvd24gd2hlbmV2ZXIgdGhlIGNv\nbW1pdCBmYWlscyBmb3IgYW55IHJlYXNvbiBhdAogICAgICAgICAgICAvLyBh\nbGwsIHdoZXJhcyB0aGUgZXhjZXB0aW9uIHRyYW5zbGF0b3IgaGFuZGxlcyBl\neGNlcHRpb25zIHRoYXQKICAgICAgICAgICAgLy8gYXJlIGNhdXNlZCBmb3Ig\nc3BlY2lmaWMgcmVhc29ucwogICAgICAgICAgICB0aHJvdyBuZXcgUm9sbGJh\nY2tFeGNlcHRpb24oZSk7CiAgICAgICAgfQogICAgfQoKICAgIHB1YmxpYyB2\nb2lkIHJvbGxiYWNrKCkgewogICAgICAgIF9icm9rZXIucm9sbGJhY2soKTsK\nICAgIH0KCiAgICBwdWJsaWMgdm9pZCBjb21taXRBbmRSZXN1bWUoKSB7CiAg\nICAgICAgX2Jyb2tlci5jb21taXRBbmRSZXN1bWUoKTsKICAgIH0KCiAgICBw\ndWJsaWMgdm9pZCByb2xsYmFja0FuZFJlc3VtZSgpIHsKICAgICAgICBfYnJv\na2VyLnJvbGxiYWNrQW5kUmVzdW1lKCk7CiAgICB9CgogICAgcHVibGljIFRo\ncm93YWJsZSBnZXRSb2xsYmFja0NhdXNlKCkgewogICAgICAgIGlmICghaXNB\nY3RpdmUoKSkKICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxTdGF0ZUV4\nY2VwdGlvbihfbG9jLmdldCgibm8tdHJhbnNhY3Rpb24iKQogICAgICAgICAg\nICAgICAgLmdldE1lc3NhZ2UoKSk7CgogICAgICAgIHJldHVybiBfYnJva2Vy\nLmdldFJvbGxiYWNrQ2F1c2UoKTsKICAgIH0KCiAgICBwdWJsaWMgYm9vbGVh\nbiBnZXRSb2xsYmFja09ubHkoKSB7CiAgICAgICAgaWYgKCFpc0FjdGl2ZSgp\nKQogICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbFN0YXRlRXhjZXB0aW9u\nKF9sb2MuZ2V0KCJuby10cmFuc2FjdGlvbiIpCiAgICAgICAgICAgICAgICAu\nZ2V0TWVzc2FnZSgpKTsKCiAgICAgICAgcmV0dXJuIF9icm9rZXIuZ2V0Um9s\nbGJhY2tPbmx5KCk7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0Um9sbGJh\nY2tPbmx5KCkgewogICAgICAgIF9icm9rZXIuc2V0Um9sbGJhY2tPbmx5KCk7\nCiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0Um9sbGJhY2tPbmx5KFRocm93\nYWJsZSBjYXVzZSkgewogICAgICAgIF9icm9rZXIuc2V0Um9sbGJhY2tPbmx5\nKGNhdXNlKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRTYXZlcG9pbnQo\nU3RyaW5nIG5hbWUpIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQo\nKTsKICAgICAgICBfYnJva2VyLnNldFNhdmVwb2ludChuYW1lKTsKICAgIH0K\nCiAgICBwdWJsaWMgdm9pZCByb2xsYmFja1RvU2F2ZXBvaW50KCkgewogICAg\nICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIF9icm9rZXIu\ncm9sbGJhY2tUb1NhdmVwb2ludCgpOwogICAgfQoKICAgIHB1YmxpYyB2b2lk\nIHJvbGxiYWNrVG9TYXZlcG9pbnQoU3RyaW5nIG5hbWUpIHsKICAgICAgICBh\nc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICBfYnJva2VyLnJvbGxi\nYWNrVG9TYXZlcG9pbnQobmFtZSk7CiAgICB9CgogICAgcHVibGljIHZvaWQg\ncmVsZWFzZVNhdmVwb2ludCgpIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUlu\ndm9rZWQoKTsKICAgICAgICBfYnJva2VyLnJlbGVhc2VTYXZlcG9pbnQoKTsK\nICAgIH0KCiAgICBwdWJsaWMgdm9pZCByZWxlYXNlU2F2ZXBvaW50KFN0cmlu\nZyBuYW1lKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAg\nICAgICAgX2Jyb2tlci5yZWxlYXNlU2F2ZXBvaW50KG5hbWUpOwogICAgfQoK\nICAgIHB1YmxpYyB2b2lkIGZsdXNoKCkgewogICAgICAgIGFzc2VydE5vdENs\nb3NlSW52b2tlZCgpOwogICAgICAgIF9icm9rZXIuYXNzZXJ0T3BlbigpOwog\nICAgICAgIF9icm9rZXIuYXNzZXJ0QWN0aXZlVHJhbnNhY3Rpb24oKTsKICAg\nICAgICBfYnJva2VyLmZsdXNoKCk7CiAgICB9CgogICAgcHVibGljIHZvaWQg\ncHJlRmx1c2goKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7\nCiAgICAgICAgX2Jyb2tlci5wcmVGbHVzaCgpOwogICAgfQoKICAgIHB1Ymxp\nYyB2b2lkIHZhbGlkYXRlQ2hhbmdlcygpIHsKICAgICAgICBhc3NlcnROb3RD\nbG9zZUludm9rZWQoKTsKICAgICAgICBfYnJva2VyLnZhbGlkYXRlQ2hhbmdl\ncygpOwogICAgfQoKICAgIHB1YmxpYyBib29sZWFuIGlzQWN0aXZlKCkgewog\nICAgICAgIHJldHVybiBpc09wZW4oKSAmJiBfYnJva2VyLmlzQWN0aXZlKCk7\nCiAgICB9CgogICAgcHVibGljIGJvb2xlYW4gaXNTdG9yZUFjdGl2ZSgpIHsK\nICAgICAgICByZXR1cm4gX2Jyb2tlci5pc1N0b3JlQWN0aXZlKCk7CiAgICB9\nCgogICAgcHVibGljIHZvaWQgYmVnaW5TdG9yZSgpIHsKICAgICAgICBfYnJv\na2VyLmJlZ2luU3RvcmUoKTsKICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBj\nb250YWlucyhPYmplY3QgZW50aXR5KSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xv\nc2VJbnZva2VkKCk7CiAgICAgICAgaWYgKGVudGl0eSA9PSBudWxsKQogICAg\nICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgT3BlbkpQQVN0YXRlTWFu\nYWdlciBzbSA9IF9icm9rZXIuZ2V0U3RhdGVNYW5hZ2VyKGVudGl0eSk7CiAg\nICAgICAgaWYgKHNtID09IG51bGwKICAgICAgICAgICAgJiYgIUltcGxIZWxw\nZXIuaXNNYW5hZ2VkVHlwZShnZXRDb25maWd1cmF0aW9uKCksIGVudGl0eS5n\nZXRDbGFzcygpKSkKICAgICAgICAgICAgdGhyb3cgbmV3IEFyZ3VtZW50RXhj\nZXB0aW9uKF9sb2MuZ2V0KCJub3QtZW50aXR5IiwKICAgICAgICAgICAgICAg\nIGVudGl0eS5nZXRDbGFzcygpKSwgbnVsbCwgbnVsbCwgdHJ1ZSk7CiAgICAg\nICAgcmV0dXJuIHNtICE9IG51bGwgJiYgIXNtLmlzRGVsZXRlZCgpOwogICAg\nfQoKICAgIHB1YmxpYyBib29sZWFuIGNvbnRhaW5zQWxsKE9iamVjdC4uLiBl\nbnRpdGllcykgewogICAgICAgIGZvciAoT2JqZWN0IGVudGl0eSA6IGVudGl0\naWVzKQogICAgICAgICAgICBpZiAoIWNvbnRhaW5zKGVudGl0eSkpCiAgICAg\nICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgcmV0dXJuIHRydWU7\nCiAgICB9CgogICAgcHVibGljIGJvb2xlYW4gY29udGFpbnNBbGwoQ29sbGVj\ndGlvbiBlbnRpdGllcykgewogICAgICAgIGZvciAoT2JqZWN0IGVudGl0eSA6\nIGVudGl0aWVzKQogICAgICAgICAgICBpZiAoIWNvbnRhaW5zKGVudGl0eSkp\nCiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgcmV0dXJu\nIHRydWU7CiAgICB9CgogICAgcHVibGljIHZvaWQgcGVyc2lzdChPYmplY3Qg\nZW50aXR5KSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAg\nICAgICAgX2Jyb2tlci5wZXJzaXN0KGVudGl0eSwgdGhpcyk7CiAgICB9Cgog\nICAgcHVibGljIHZvaWQgcGVyc2lzdEFsbChPYmplY3QuLi4gZW50aXRpZXMp\nIHsKICAgICAgICBwZXJzaXN0QWxsKEFycmF5cy5hc0xpc3QoZW50aXRpZXMp\nKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBwZXJzaXN0QWxsKENvbGxlY3Rp\nb24gZW50aXRpZXMpIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQo\nKTsKICAgICAgICBfYnJva2VyLnBlcnNpc3RBbGwoZW50aXRpZXMsIHRoaXMp\nOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHJlbW92ZShPYmplY3QgZW50aXR5\nKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAg\nX2Jyb2tlci5kZWxldGUoZW50aXR5LCB0aGlzKTsKICAgIH0KCiAgICBwdWJs\naWMgdm9pZCByZW1vdmVBbGwoT2JqZWN0Li4uIGVudGl0aWVzKSB7CiAgICAg\nICAgcmVtb3ZlQWxsKEFycmF5cy5hc0xpc3QoZW50aXRpZXMpKTsKICAgIH0K\nCiAgICBwdWJsaWMgdm9pZCByZW1vdmVBbGwoQ29sbGVjdGlvbiBlbnRpdGll\ncykgewogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAgICAg\nIF9icm9rZXIuZGVsZXRlQWxsKGVudGl0aWVzLCB0aGlzKTsKICAgIH0KCiAg\nICBwdWJsaWMgdm9pZCByZWxlYXNlKE9iamVjdCBlbnRpdHkpIHsKICAgICAg\nICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICBfYnJva2VyLnJl\nbGVhc2UoZW50aXR5LCB0aGlzKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBy\nZWxlYXNlQWxsKENvbGxlY3Rpb24gZW50aXRpZXMpIHsKICAgICAgICBhc3Nl\ncnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICBfYnJva2VyLnJlbGVhc2VB\nbGwoZW50aXRpZXMsIHRoaXMpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHJl\nbGVhc2VBbGwoT2JqZWN0Li4uIGVudGl0aWVzKSB7CiAgICAgICAgcmVsZWFz\nZUFsbChBcnJheXMuYXNMaXN0KGVudGl0aWVzKSk7CiAgICB9CgogICAgcHVi\nbGljIHZvaWQgcmVmcmVzaChPYmplY3QgZW50aXR5KSB7CiAgICAgICAgYXNz\nZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAgYXNzZXJ0VmFsaWRBdHRj\naGVkRW50aXR5KGVudGl0eSk7CiAgICAgICAgX2Jyb2tlci5hc3NlcnRXcml0\nZU9wZXJhdGlvbigpOwogICAgICAgIF9icm9rZXIucmVmcmVzaChlbnRpdHks\nIHRoaXMpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHJlZnJlc2goT2JqZWN0\nIGVudGl0eSwgTG9ja01vZGVUeXBlIG1vZGUpIHsKICAgICAgICByZWZyZXNo\nKGVudGl0eSwgbW9kZSwgbnVsbCk7CiAgICB9CgogICAgcHVibGljIHZvaWQg\ncmVmcmVzaChPYmplY3QgZW50aXR5LCBNYXA8U3RyaW5nLCBPYmplY3Q+IHBy\nb3BlcnRpZXMpIHsKICAgICAgICByZWZyZXNoKGVudGl0eSwgbnVsbCwgcHJv\ncGVydGllcyk7CiAgICB9CgogICAgcHVibGljIHZvaWQgcmVmcmVzaChPYmpl\nY3QgZW50aXR5LCBMb2NrTW9kZVR5cGUgbW9kZSwKICAgICAgICBNYXA8U3Ry\naW5nLCBPYmplY3Q+IHByb3BlcnRpZXMpIHsKICAgICAgICBhc3NlcnROb3RD\nbG9zZUludm9rZWQoKTsKICAgICAgICBhc3NlcnRWYWxpZEF0dGNoZWRFbnRp\ndHkoZW50aXR5KTsKICAgICAgICBpZiAobW9kZSAhPSBudWxsICYmIG1vZGUg\nIT0gTG9ja01vZGVUeXBlLk5PTkUpIHsKICAgICAgICAgICAgX2Jyb2tlci5h\nc3NlcnRBY3RpdmVUcmFuc2FjdGlvbigpOwogICAgICAgIH0KICAgICAgICBf\nYnJva2VyLmFzc2VydFdyaXRlT3BlcmF0aW9uKCk7CgogICAgICAgIHByb2Nl\nc3NMb2NrUHJvcGVydGllcyhwdXNoRmV0Y2hQbGFuKCksIG1vZGUsIHByb3Bl\ncnRpZXMpOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIF9icm9rZXIucmVm\ncmVzaChlbnRpdHksIHRoaXMpOwogICAgICAgIH0gZmluYWxseSB7CiAgICAg\nICAgICAgIHBvcEZldGNoUGxhbigpOwogICAgICAgIH0KICAgIH0KCiAgICBw\ndWJsaWMgdm9pZCByZWZyZXNoQWxsKCkgewogICAgICAgIGFzc2VydE5vdENs\nb3NlSW52b2tlZCgpOwogICAgICAgIF9icm9rZXIuYXNzZXJ0V3JpdGVPcGVy\nYXRpb24oKTsKICAgICAgICBfYnJva2VyLnJlZnJlc2hBbGwoX2Jyb2tlci5n\nZXRUcmFuc2FjdGlvbmFsT2JqZWN0cygpLCB0aGlzKTsKICAgIH0KCiAgICBw\ndWJsaWMgdm9pZCByZWZyZXNoQWxsKENvbGxlY3Rpb24gZW50aXRpZXMpIHsK\nICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICBfYnJv\na2VyLmFzc2VydFdyaXRlT3BlcmF0aW9uKCk7CiAgICAgICAgX2Jyb2tlci5y\nZWZyZXNoQWxsKGVudGl0aWVzLCB0aGlzKTsKICAgIH0KCiAgICBwdWJsaWMg\ndm9pZCByZWZyZXNoQWxsKE9iamVjdC4uLiBlbnRpdGllcykgewogICAgICAg\nIHJlZnJlc2hBbGwoQXJyYXlzLmFzTGlzdChlbnRpdGllcykpOwogICAgfQoK\nICAgIHB1YmxpYyB2b2lkIHJldHJpZXZlKE9iamVjdCBlbnRpdHkpIHsKICAg\nICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICBfYnJva2Vy\nLnJldHJpZXZlKGVudGl0eSwgdHJ1ZSwgdGhpcyk7CiAgICB9CgogICAgcHVi\nbGljIHZvaWQgcmV0cmlldmVBbGwoQ29sbGVjdGlvbiBlbnRpdGllcykgewog\nICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIF9icm9r\nZXIucmV0cmlldmVBbGwoZW50aXRpZXMsIHRydWUsIHRoaXMpOwogICAgfQoK\nICAgIHB1YmxpYyB2b2lkIHJldHJpZXZlQWxsKE9iamVjdC4uLiBlbnRpdGll\ncykgewogICAgICAgIHJldHJpZXZlQWxsKEFycmF5cy5hc0xpc3QoZW50aXRp\nZXMpKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBldmljdChPYmplY3QgZW50\naXR5KSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAg\nICAgX2Jyb2tlci5ldmljdChlbnRpdHksIHRoaXMpOwogICAgfQoKICAgIHB1\nYmxpYyB2b2lkIGV2aWN0QWxsKENvbGxlY3Rpb24gZW50aXRpZXMpIHsKICAg\nICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICBfYnJva2Vy\nLmV2aWN0QWxsKGVudGl0aWVzLCB0aGlzKTsKICAgIH0KCiAgICBwdWJsaWMg\ndm9pZCBldmljdEFsbChPYmplY3QuLi4gZW50aXRpZXMpIHsKICAgICAgICBl\ndmljdEFsbChBcnJheXMuYXNMaXN0KGVudGl0aWVzKSk7CiAgICB9CgogICAg\ncHVibGljIHZvaWQgZXZpY3RBbGwoKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xv\nc2VJbnZva2VkKCk7CiAgICAgICAgX2Jyb2tlci5ldmljdEFsbCh0aGlzKTsK\nICAgIH0KCiAgICBwdWJsaWMgdm9pZCBldmljdEFsbChDbGFzcyBjbHMpIHsK\nICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICBfYnJv\na2VyLmV2aWN0QWxsKF9icm9rZXIubmV3RXh0ZW50KGNscywgdHJ1ZSksIHRo\naXMpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIGV2aWN0QWxsKEV4dGVudCBl\neHRlbnQpIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAg\nICAgICBfYnJva2VyLmV2aWN0QWxsKCgoRXh0ZW50SW1wbCkgZXh0ZW50KS5n\nZXREZWxlZ2F0ZSgpLCB0aGlzKTsKICAgIH0KCiAgICBAU3VwcHJlc3NXYXJu\naW5ncygidW5jaGVja2VkIikKICAgIHB1YmxpYyA8VD4gVCBkZXRhY2hDb3B5\nKFQgZW50aXR5KSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7\nCiAgICAgICAgQ29tcGF0aWJpbGl0eSBjb21wYXQgPSB0aGlzLmdldENvbmZp\nZ3VyYXRpb24oKS4KICAgICAgICAgICAgZ2V0Q29tcGF0aWJpbGl0eUluc3Rh\nbmNlKCk7CiAgICAgICAgYm9vbGVhbiBjb3B5T25EZXRhY2ggPSBjb21wYXQu\nZ2V0Q29weU9uRGV0YWNoKCk7CiAgICAgICAgYm9vbGVhbiBjYXNjYWRlV2l0\naERldGFjaCA9IGNvbXBhdC5nZXRDYXNjYWRlV2l0aERldGFjaCgpOwogICAg\nICAgIC8vIFNldCBjb21wYXRpYmlsaXR5IG9wdGlvbnMgdG8gZ2V0IDEueCBk\nZXRhY2ggYmVoYXZpb3IKICAgICAgICBjb21wYXQuc2V0Q29weU9uRGV0YWNo\nKHRydWUpOwogICAgICAgIGNvbXBhdC5zZXRDYXNjYWRlV2l0aERldGFjaCh0\ncnVlKTsKICAgICAgICB0cnkgewogICAgICAgICAgICBUIHQgPSAoVClfYnJv\na2VyLmRldGFjaChlbnRpdHksIHRoaXMpOwogICAgICAgICAgICByZXR1cm4g\ndDsKICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICAvLyBSZXNldCBj\nb21wYXRpYmlsaXR5IG9wdGlvbnMKICAgICAgICAgICAgY29tcGF0LnNldENv\ncHlPbkRldGFjaChjb3B5T25EZXRhY2gpOwogICAgICAgICAgICBjb21wYXQu\nc2V0Q2FzY2FkZVdpdGhEZXRhY2goY2FzY2FkZVdpdGhEZXRhY2gpOwogICAg\nICAgIH0gICAgICAgIAogICAgfQoKICAgIHB1YmxpYyBPYmplY3RbXSBkZXRh\nY2hBbGwoT2JqZWN0Li4uIGVudGl0aWVzKSB7CiAgICAgICAgYXNzZXJ0Tm90\nQ2xvc2VJbnZva2VkKCk7CiAgICAgICAgcmV0dXJuIF9icm9rZXIuZGV0YWNo\nQWxsKEFycmF5cy5hc0xpc3QoZW50aXRpZXMpLCB0aGlzKTsKICAgIH0KCiAg\nICBwdWJsaWMgQ29sbGVjdGlvbiBkZXRhY2hBbGwoQ29sbGVjdGlvbiBlbnRp\ndGllcykgewogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAg\nICAgIHJldHVybiBBcnJheXMuYXNMaXN0KF9icm9rZXIuZGV0YWNoQWxsKGVu\ndGl0aWVzLCB0aGlzKSk7CiAgICB9CgogICAgQFN1cHByZXNzV2FybmluZ3Mo\nInVuY2hlY2tlZCIpCiAgICBwdWJsaWMgPFQ+IFQgbWVyZ2UoVCBlbnRpdHkp\nIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICBy\nZXR1cm4gKFQpIF9icm9rZXIuYXR0YWNoKGVudGl0eSwgdHJ1ZSwgdGhpcyk7\nCiAgICB9CgogICAgcHVibGljIE9iamVjdFtdIG1lcmdlQWxsKE9iamVjdC4u\nLiBlbnRpdGllcykgewogICAgICAgIGlmIChlbnRpdGllcy5sZW5ndGggPT0g\nMCkKICAgICAgICAgICAgcmV0dXJuIEVNUFRZX09CSkVDVFM7CiAgICAgICAg\ncmV0dXJuIG1lcmdlQWxsKEFycmF5cy5hc0xpc3QoZW50aXRpZXMpKS50b0Fy\ncmF5KCk7CiAgICB9CgogICAgcHVibGljIENvbGxlY3Rpb24gbWVyZ2VBbGwo\nQ29sbGVjdGlvbiBlbnRpdGllcykgewogICAgICAgIGFzc2VydE5vdENsb3Nl\nSW52b2tlZCgpOwogICAgICAgIHJldHVybiBBcnJheXMuYXNMaXN0KF9icm9r\nZXIuYXR0YWNoQWxsKGVudGl0aWVzLCB0cnVlLCB0aGlzKSk7CiAgICB9Cgog\nICAgcHVibGljIHZvaWQgdHJhbnNhY3Rpb25hbChPYmplY3QgZW50aXR5LCBi\nb29sZWFuIHVwZGF0ZVZlcnNpb24pIHsKICAgICAgICBhc3NlcnROb3RDbG9z\nZUludm9rZWQoKTsKICAgICAgICBfYnJva2VyLnRyYW5zYWN0aW9uYWwoZW50\naXR5LCB1cGRhdGVWZXJzaW9uLCB0aGlzKTsKICAgIH0KCiAgICBwdWJsaWMg\ndm9pZCB0cmFuc2FjdGlvbmFsQWxsKENvbGxlY3Rpb24gb2JqcywgYm9vbGVh\nbiB1cGRhdGVWZXJzaW9uKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZv\na2VkKCk7CiAgICAgICAgX2Jyb2tlci50cmFuc2FjdGlvbmFsQWxsKG9ianMs\nIHVwZGF0ZVZlcnNpb24sIHRoaXMpOwogICAgfQoKICAgIHB1YmxpYyB2b2lk\nIHRyYW5zYWN0aW9uYWxBbGwoT2JqZWN0W10gb2JqcywgYm9vbGVhbiB1cGRh\ndGVWZXJzaW9uKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7\nCiAgICAgICAgX2Jyb2tlci50cmFuc2FjdGlvbmFsQWxsKEFycmF5cy5hc0xp\nc3Qob2JqcyksIHVwZGF0ZVZlcnNpb24sIHRoaXMpOwogICAgfQoKICAgIHB1\nYmxpYyB2b2lkIG5vbnRyYW5zYWN0aW9uYWwoT2JqZWN0IGVudGl0eSkgewog\nICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIF9icm9r\nZXIubm9udHJhbnNhY3Rpb25hbChlbnRpdHksIHRoaXMpOwogICAgfQoKICAg\nIHB1YmxpYyB2b2lkIG5vbnRyYW5zYWN0aW9uYWxBbGwoQ29sbGVjdGlvbiBv\nYmpzKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAg\nICAgX2Jyb2tlci5ub250cmFuc2FjdGlvbmFsQWxsKG9ianMsIHRoaXMpOwog\nICAgfQoKICAgIHB1YmxpYyB2b2lkIG5vbnRyYW5zYWN0aW9uYWxBbGwoT2Jq\nZWN0W10gb2JqcykgewogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgp\nOwogICAgICAgIF9icm9rZXIubm9udHJhbnNhY3Rpb25hbEFsbChBcnJheXMu\nYXNMaXN0KG9ianMpLCB0aGlzKTsKICAgIH0KCiAgICBwdWJsaWMgR2VuZXJh\ndG9yIGdldE5hbWVkR2VuZXJhdG9yKFN0cmluZyBuYW1lKSB7CiAgICAgICAg\nYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAgdHJ5IHsKICAgICAg\nICAgICAgU2VxdWVuY2VNZXRhRGF0YSBtZXRhID0gX2Jyb2tlci5nZXRDb25m\naWd1cmF0aW9uKCkuCiAgICAgICAgICAgICAgICBnZXRNZXRhRGF0YVJlcG9z\naXRvcnlJbnN0YW5jZSgpLmdldFNlcXVlbmNlTWV0YURhdGEobmFtZSwKICAg\nICAgICAgICAgICAgIF9icm9rZXIuZ2V0Q2xhc3NMb2FkZXIoKSwgdHJ1ZSk7\nCiAgICAgICAgICAgIFNlcSBzZXEgPSBtZXRhLmdldEluc3RhbmNlKF9icm9r\nZXIuZ2V0Q2xhc3NMb2FkZXIoKSk7CiAgICAgICAgICAgIHJldHVybiBuZXcg\nR2VuZXJhdG9ySW1wbChzZXEsIG5hbWUsIF9icm9rZXIsIG51bGwpOwogICAg\nICAgIH0gY2F0Y2ggKFJ1bnRpbWVFeGNlcHRpb24gcmUpIHsKICAgICAgICAg\nICAgdGhyb3cgUGVyc2lzdGVuY2VFeGNlcHRpb25zLnRvUGVyc2lzdGVuY2VF\neGNlcHRpb24ocmUpOwogICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMgR2Vu\nZXJhdG9yIGdldElkR2VuZXJhdG9yKENsYXNzIGZvckNsYXNzKSB7CiAgICAg\nICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAgdHJ5IHsKICAg\nICAgICAgICAgQ2xhc3NNZXRhRGF0YSBtZXRhID0gX2Jyb2tlci5nZXRDb25m\naWd1cmF0aW9uKCkuCiAgICAgICAgICAgICAgICBnZXRNZXRhRGF0YVJlcG9z\naXRvcnlJbnN0YW5jZSgpLmdldE1ldGFEYXRhKGZvckNsYXNzLAogICAgICAg\nICAgICAgICAgX2Jyb2tlci5nZXRDbGFzc0xvYWRlcigpLCB0cnVlKTsKICAg\nICAgICAgICAgU2VxIHNlcSA9IF9icm9rZXIuZ2V0SWRlbnRpdHlTZXF1ZW5j\nZShtZXRhKTsKICAgICAgICAgICAgcmV0dXJuIChzZXEgPT0gbnVsbCkgPyBu\ndWxsIDogbmV3IEdlbmVyYXRvckltcGwoc2VxLCBudWxsLCBfYnJva2VyLAog\nICAgICAgICAgICAgICAgbWV0YSk7CiAgICAgICAgfSBjYXRjaCAoRXhjZXB0\naW9uIGUpIHsKICAgICAgICAgICAgdGhyb3cgUGVyc2lzdGVuY2VFeGNlcHRp\nb25zLnRvUGVyc2lzdGVuY2VFeGNlcHRpb24oZSk7CiAgICAgICAgfQogICAg\nfQoKICAgIHB1YmxpYyBHZW5lcmF0b3IgZ2V0RmllbGRHZW5lcmF0b3IoQ2xh\nc3MgZm9yQ2xhc3MsIFN0cmluZyBmaWVsZE5hbWUpIHsKICAgICAgICBhc3Nl\ncnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICB0cnkgewogICAgICAgICAg\nICBDbGFzc01ldGFEYXRhIG1ldGEgPSBfYnJva2VyLmdldENvbmZpZ3VyYXRp\nb24oKS4KICAgICAgICAgICAgICAgIGdldE1ldGFEYXRhUmVwb3NpdG9yeUlu\nc3RhbmNlKCkuZ2V0TWV0YURhdGEoZm9yQ2xhc3MsCiAgICAgICAgICAgICAg\nICBfYnJva2VyLmdldENsYXNzTG9hZGVyKCksIHRydWUpOwogICAgICAgICAg\nICBGaWVsZE1ldGFEYXRhIGZtZCA9IG1ldGEuZ2V0RmllbGQoZmllbGROYW1l\nKTsKICAgICAgICAgICAgaWYgKGZtZCA9PSBudWxsKQogICAgICAgICAgICAg\nICAgdGhyb3cgbmV3IEFyZ3VtZW50RXhjZXB0aW9uKF9sb2MuZ2V0KCJuby1u\nYW1lZC1maWVsZCIsCiAgICAgICAgICAgICAgICAgICAgZm9yQ2xhc3MsIGZp\nZWxkTmFtZSksIG51bGwsIG51bGwsIGZhbHNlKTsKCiAgICAgICAgICAgIFNl\ncSBzZXEgPSBfYnJva2VyLmdldFZhbHVlU2VxdWVuY2UoZm1kKTsKICAgICAg\nICAgICAgcmV0dXJuIChzZXEgPT0gbnVsbCkgPyBudWxsIDogbmV3IEdlbmVy\nYXRvckltcGwoc2VxLCBudWxsLCBfYnJva2VyLAogICAgICAgICAgICAgICAg\nbWV0YSk7CiAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAgICAg\nICAgICAgdGhyb3cgUGVyc2lzdGVuY2VFeGNlcHRpb25zLnRvUGVyc2lzdGVu\nY2VFeGNlcHRpb24oZSk7CiAgICAgICAgfQogICAgfQoKICAgIHB1YmxpYyA8\nVD4gRXh0ZW50PFQ+IGNyZWF0ZUV4dGVudChDbGFzczxUPiBjbHMsIGJvb2xl\nYW4gc3ViY2xhc3NlcykgewogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tl\nZCgpOwogICAgICAgIHJldHVybiBuZXcgRXh0ZW50SW1wbDxUPih0aGlzLCBf\nYnJva2VyLm5ld0V4dGVudChjbHMsIHN1YmNsYXNzZXMpKTsKICAgIH0KCiAg\nICBwdWJsaWMgPFQ+IFR5cGVkUXVlcnk8VD4gY3JlYXRlUXVlcnkoU3RyaW5n\nIHF1ZXJ5LCBDbGFzczxUPiByZXN1bHRDbGFzcykgewogICAgICAgIHJldHVy\nbiBuZXcgUXVlcnlJbXBsKHRoaXMsIF9yZXQsIAogICAgICAgICAgICBfYnJv\na2VyLm5ld1F1ZXJ5KEpQUUxQYXJzZXIuTEFOR19KUFFMLCBxdWVyeSkpOwog\nICAgfQogICAgCiAgICBwdWJsaWMgT3BlbkpQQVF1ZXJ5IGNyZWF0ZVF1ZXJ5\nKFN0cmluZyBxdWVyeSkgewogICAgICAgIHJldHVybiBjcmVhdGVRdWVyeShK\nUFFMUGFyc2VyLkxBTkdfSlBRTCwgcXVlcnkpOwogICAgfQoKICAgIHB1Ymxp\nYyBPcGVuSlBBUXVlcnkgY3JlYXRlUXVlcnkoU3RyaW5nIGxhbmd1YWdlLCBT\ndHJpbmcgcXVlcnkpIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQo\nKTsKICAgICAgICB0cnkgewogICAgICAgICAgICBTdHJpbmcgcWlkID0gcXVl\ncnk7CiAgICAgICAgICAgIFByZXBhcmVkUXVlcnkgcHEgPSBKUFFMUGFyc2Vy\nLkxBTkdfSlBRTC5lcXVhbHMobGFuZ3VhZ2UpCiAgICAgICAgICAgICAgICA/\nIGdldFByZXBhcmVkUXVlcnkocWlkKSA6IG51bGw7CiAgICAgICAgICAgIG9y\nZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuUXVlcnkgcSA9IChwcSA9PSBudWxs\nKQogICAgICAgICAgICAgICAgPyBfYnJva2VyLm5ld1F1ZXJ5KGxhbmd1YWdl\nLCBxdWVyeSkKICAgICAgICAgICAgICAgIDogX2Jyb2tlci5uZXdRdWVyeShw\ncS5nZXRMYW5ndWFnZSgpLCBwcSk7CiAgICAgICAgICAgIC8vIGhhdmUgdG8g\ndmFsaWRhdGUgSlBRTCBhY2NvcmRpbmcgdG8gc3BlYwogICAgICAgICAgICBp\nZiAocHEgPT0gbnVsbCAmJiBKUFFMUGFyc2VyLkxBTkdfSlBRTC5lcXVhbHMo\nbGFuZ3VhZ2UpKQogICAgICAgICAgICAgICAgcS5jb21waWxlKCk7IAogICAg\nICAgICAgICBpZiAocHEgIT0gbnVsbCkgewogICAgICAgICAgICAgICAgcHEu\nc2V0SW50byhxKTsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4g\nbmV3IFF1ZXJ5SW1wbCh0aGlzLCBfcmV0LCBxKS5zZXRJZChxaWQpOwogICAg\nICAgIH0gY2F0Y2ggKFJ1bnRpbWVFeGNlcHRpb24gcmUpIHsKICAgICAgICAg\nICAgdGhyb3cgUGVyc2lzdGVuY2VFeGNlcHRpb25zLnRvUGVyc2lzdGVuY2VF\neGNlcHRpb24ocmUpOwogICAgICAgIH0KICAgIH0KICAgIAogICAgcHVibGlj\nIE9wZW5KUEFRdWVyeSBjcmVhdGVRdWVyeShRdWVyeSBxdWVyeSkgewogICAg\nICAgIGlmIChxdWVyeSA9PSBudWxsKQogICAgICAgICAgICByZXR1cm4gY3Jl\nYXRlUXVlcnkoKFN0cmluZykgbnVsbCk7CiAgICAgICAgYXNzZXJ0Tm90Q2xv\nc2VJbnZva2VkKCk7CiAgICAgICAgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5l\nbC5RdWVyeSBxID0gKChRdWVyeUltcGwpIHF1ZXJ5KS5nZXREZWxlZ2F0ZSgp\nOwogICAgICAgIHJldHVybiBuZXcgUXVlcnlJbXBsKHRoaXMsIF9yZXQsIF9i\ncm9rZXIubmV3UXVlcnkocS5nZXRMYW5ndWFnZSgpLAogICAgICAgICAgICBx\nKSk7CiAgICB9CiAgICAKICAgIHB1YmxpYyA8VD4gVHlwZWRRdWVyeTxUPiBj\ncmVhdGVOYW1lZFF1ZXJ5KFN0cmluZyBuYW1lLCBDbGFzczxUPiByZXN1bHRD\nbGFzcykgewogICAgICAgIHRocm93IG5ldyBVbnN1cHBvcnRlZE9wZXJhdGlv\nbkV4Y2VwdGlvbigpOwogICAgfQoKICAgIHB1YmxpYyBPcGVuSlBBUXVlcnkg\nY3JlYXRlTmFtZWRRdWVyeShTdHJpbmcgbmFtZSkgewogICAgICAgIGFzc2Vy\ndE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIF9icm9rZXIuYXNzZXJ0T3Bl\nbigpOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIFF1ZXJ5TWV0YURhdGEg\nbWV0YSA9IF9icm9rZXIuZ2V0Q29uZmlndXJhdGlvbigpLgogICAgICAgICAg\nICAgICAgZ2V0TWV0YURhdGFSZXBvc2l0b3J5SW5zdGFuY2UoKS5nZXRRdWVy\neU1ldGFEYXRhKG51bGwsIG5hbWUsCiAgICAgICAgICAgICAgICBfYnJva2Vy\nLmdldENsYXNzTG9hZGVyKCksIHRydWUpOwogICAgICAgICAgICBTdHJpbmcg\ncWlkID0gbWV0YS5nZXRRdWVyeVN0cmluZygpOwogICAgICAgICAgICAKICAg\nICAgICAgICAgUHJlcGFyZWRRdWVyeSBwcSA9IEpQUUxQYXJzZXIuTEFOR19K\nUFFMLmVxdWFscyhtZXRhLmdldExhbmd1YWdlKCkpCiAgICAgICAgICAgICAg\nICA/IGdldFByZXBhcmVkUXVlcnkocWlkKSA6IG51bGw7CiAgICAgICAgICAg\nIG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuUXVlcnkgZGVsID0gKHBxID09\nIG51bGwpCiAgICAgICAgICAgICAgICA/IF9icm9rZXIubmV3UXVlcnkobWV0\nYS5nZXRMYW5ndWFnZSgpLCBtZXRhLmdldFF1ZXJ5U3RyaW5nKCkpCiAgICAg\nICAgICAgICAgICA6IF9icm9rZXIubmV3UXVlcnkocHEuZ2V0TGFuZ3VhZ2Uo\nKSwgcHEpOwogICAgICAgICAgICAKICAgICAgICAgICAgaWYgKHBxICE9IG51\nbGwpIHsKICAgICAgICAgICAgICAgIHBxLnNldEludG8oZGVsKTsKICAgICAg\nICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIG1ldGEuc2V0SW50byhk\nZWwpOwogICAgICAgICAgICAgICAgZGVsLmNvbXBpbGUoKTsKICAgICAgICAg\nICAgfQogICAgICAgICAgICAKICAgICAgICAgICAgT3BlbkpQQVF1ZXJ5IHEg\nPSBuZXcgUXVlcnlJbXBsKHRoaXMsIF9yZXQsIGRlbCkuc2V0SWQocWlkKTsK\nICAgICAgICAgICAgU3RyaW5nW10gaGludHMgPSBtZXRhLmdldEhpbnRLZXlz\nKCk7CiAgICAgICAgICAgIE9iamVjdFtdIHZhbHVlcyA9IG1ldGEuZ2V0SGlu\ndFZhbHVlcygpOwogICAgICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGhp\nbnRzLmxlbmd0aDsgaSsrKQogICAgICAgICAgICAgICAgcS5zZXRIaW50KGhp\nbnRzW2ldLCB2YWx1ZXNbaV0pOwogICAgICAgICAgICByZXR1cm4gcTsKICAg\nICAgICB9IGNhdGNoIChSdW50aW1lRXhjZXB0aW9uIHJlKSB7CiAgICAgICAg\nICAgIHRocm93IFBlcnNpc3RlbmNlRXhjZXB0aW9ucy50b1BlcnNpc3RlbmNl\nRXhjZXB0aW9uKHJlKTsKICAgICAgICB9CiAgICB9ICAgIAoKICAgIHB1Ymxp\nYyBPcGVuSlBBUXVlcnkgY3JlYXRlTmF0aXZlUXVlcnkoU3RyaW5nIHF1ZXJ5\nKSB7CiAgICAgICAgdmFsaWRhdGVTUUwocXVlcnkpOwogICAgICAgIHJldHVy\nbiBjcmVhdGVRdWVyeShRdWVyeUxhbmd1YWdlcy5MQU5HX1NRTCwgcXVlcnkp\nOwogICAgfQoKICAgIHB1YmxpYyBPcGVuSlBBUXVlcnkgY3JlYXRlTmF0aXZl\nUXVlcnkoU3RyaW5nIHF1ZXJ5LCBDbGFzcyBjbHMpIHsKICAgICAgICByZXR1\ncm4gY3JlYXRlTmF0aXZlUXVlcnkocXVlcnkpLnNldFJlc3VsdENsYXNzKGNs\ncyk7CiAgICB9CgogICAgcHVibGljIE9wZW5KUEFRdWVyeSBjcmVhdGVOYXRp\ndmVRdWVyeShTdHJpbmcgcXVlcnksIFN0cmluZyBtYXBwaW5nTmFtZSkgewog\nICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIHZhbGlk\nYXRlU1FMKHF1ZXJ5KTsKICAgICAgICBvcmcuYXBhY2hlLm9wZW5qcGEua2Vy\nbmVsLlF1ZXJ5IGtlcm5lbFF1ZXJ5ID0gX2Jyb2tlci5uZXdRdWVyeSgKICAg\nICAgICAgICAgUXVlcnlMYW5ndWFnZXMuTEFOR19TUUwsIHF1ZXJ5KTsKICAg\nICAgICBrZXJuZWxRdWVyeS5zZXRSZXN1bHRNYXBwaW5nKG51bGwsIG1hcHBp\nbmdOYW1lKTsKICAgICAgICByZXR1cm4gbmV3IFF1ZXJ5SW1wbCh0aGlzLCBf\ncmV0LCBrZXJuZWxRdWVyeSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBWYWxp\nZGF0ZSB0aGF0IHRoZSB1c2VyIHByb3ZpZGVkIFNRTC4KICAgICAqLwogICAg\ncHJpdmF0ZSBzdGF0aWMgdm9pZCB2YWxpZGF0ZVNRTChTdHJpbmcgcXVlcnkp\nIHsKICAgICAgICBpZiAoU3RyaW5nVXRpbHMudHJpbVRvTnVsbChxdWVyeSkg\nPT0gbnVsbCkKICAgICAgICAgICAgdGhyb3cgbmV3IEFyZ3VtZW50RXhjZXB0\naW9uKF9sb2MuZ2V0KCJuby1zcWwiKSwgbnVsbCwgbnVsbCwgZmFsc2UpOwog\nICAgfQogICAgCiAgICBQcmVwYXJlZFF1ZXJ5Q2FjaGUgZ2V0UHJlcGFyZWRR\ndWVyeUNhY2hlKCkgewogICAgICAgIHJldHVybiBfYnJva2VyLmdldENhY2hl\nUHJlcGFyZWRRdWVyeSgpID8KICAgICAgICAgICAgZ2V0Q29uZmlndXJhdGlv\nbigpLmdldFF1ZXJ5U1FMQ2FjaGVJbnN0YW5jZSgpIDogbnVsbDsKICAgIH0K\nICAgIAogICAgLyoqCiAgICAgKiBHZXRzIHRoZSBwcmVwYXJlZCBxdWVyeSBj\nYWNoZWQgYnkgdGhlIGdpdmVuIGtleS4gCiAgICAgKiAKICAgICAqIEByZXR1\ncm4gdGhlIGNhY2hlZCBQcmVwYXJlZFF1ZXJ5IG9yIG51bGwgaWYgbm9uZSBl\neGlzdHMuCiAgICAgKi8KICAgIFByZXBhcmVkUXVlcnkgZ2V0UHJlcGFyZWRR\ndWVyeShTdHJpbmcgaWQpIHsKICAgICAgICBQcmVwYXJlZFF1ZXJ5Q2FjaGUg\nY2FjaGUgPSBnZXRQcmVwYXJlZFF1ZXJ5Q2FjaGUoKTsKICAgICAgICByZXR1\ncm4gKGNhY2hlID09IG51bGwpID8gbnVsbCA6IGNhY2hlLmdldChpZCk7CiAg\nICB9CgogICAgcHVibGljIHZvaWQgc2V0Rmx1c2hNb2RlKEZsdXNoTW9kZVR5\ncGUgZmx1c2hNb2RlKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2Vk\nKCk7CiAgICAgICAgX2Jyb2tlci5hc3NlcnRPcGVuKCk7CiAgICAgICAgX2Jy\nb2tlci5nZXRGZXRjaENvbmZpZ3VyYXRpb24oKS5zZXRGbHVzaEJlZm9yZVF1\nZXJpZXMKICAgICAgICAgICAgKHRvRmx1c2hCZWZvcmVRdWVyaWVzKGZsdXNo\nTW9kZSkpOwogICAgfQoKICAgIHB1YmxpYyBGbHVzaE1vZGVUeXBlIGdldEZs\ndXNoTW9kZSgpIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsK\nICAgICAgICBfYnJva2VyLmFzc2VydE9wZW4oKTsKICAgICAgICByZXR1cm4g\nZnJvbUZsdXNoQmVmb3JlUXVlcmllcyhfYnJva2VyLmdldEZldGNoQ29uZmln\ndXJhdGlvbigpLgogICAgICAgICAgICBnZXRGbHVzaEJlZm9yZVF1ZXJpZXMo\nKSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBUcmFuc2xhdGUgb3VyIGludGVy\nbmFsIGZsdXNoIGNvbnN0YW50IHRvIGEgZmx1c2ggbW9kZSBlbnVtIHZhbHVl\nLgogICAgICovCiAgICBzdGF0aWMgRmx1c2hNb2RlVHlwZSBmcm9tRmx1c2hC\nZWZvcmVRdWVyaWVzKGludCBmbHVzaCkgewogICAgICAgIHN3aXRjaCAoZmx1\nc2gpIHsKICAgICAgICAgICAgY2FzZSBRdWVyeUZsdXNoTW9kZXMuRkxVU0hf\nVFJVRToKICAgICAgICAgICAgICAgIHJldHVybiBGbHVzaE1vZGVUeXBlLkFV\nVE87CiAgICAgICAgICAgIGNhc2UgUXVlcnlGbHVzaE1vZGVzLkZMVVNIX0ZB\nTFNFOgogICAgICAgICAgICAgICAgcmV0dXJuIEZsdXNoTW9kZVR5cGUuQ09N\nTUlUOwogICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgICAgcmV0\ndXJuIG51bGw7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogVHJh\nbnNsYXRlIGEgZmx1c2ggbW9kZSBlbnVtIHZhbHVlIHRvIG91ciBpbnRlcm5h\nbCBmbHVzaCBjb25zdGFudC4KICAgICAqLwogICAgc3RhdGljIGludCB0b0Zs\ndXNoQmVmb3JlUXVlcmllcyhGbHVzaE1vZGVUeXBlIGZsdXNoTW9kZSkgewog\nICAgICAgIC8vIGNob29zZSBkZWZhdWx0IGZvciBudWxsCiAgICAgICAgaWYg\nKGZsdXNoTW9kZSA9PSBudWxsKQogICAgICAgICAgICByZXR1cm4gUXVlcnlG\nbHVzaE1vZGVzLkZMVVNIX1dJVEhfQ09OTkVDVElPTjsKICAgICAgICBpZiAo\nZmx1c2hNb2RlID09IEZsdXNoTW9kZVR5cGUuQVVUTykKICAgICAgICAgICAg\ncmV0dXJuIFF1ZXJ5Rmx1c2hNb2Rlcy5GTFVTSF9UUlVFOwogICAgICAgIGlm\nIChmbHVzaE1vZGUgPT0gRmx1c2hNb2RlVHlwZS5DT01NSVQpCiAgICAgICAg\nICAgIHJldHVybiBRdWVyeUZsdXNoTW9kZXMuRkxVU0hfRkFMU0U7CiAgICAg\nICAgdGhyb3cgbmV3IEFyZ3VtZW50RXhjZXB0aW9uKGZsdXNoTW9kZS50b1N0\ncmluZygpLCBudWxsLCBudWxsLCBmYWxzZSk7CiAgICB9CgogICAgcHVibGlj\nIHZvaWQgY2xlYXIoKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2Vk\nKCk7CiAgICAgICAgX2Jyb2tlci5kZXRhY2hBbGwodGhpcywgZmFsc2UpOwog\nICAgfQoKICAgIHB1YmxpYyBPYmplY3QgZ2V0RGVsZWdhdGUoKSB7CiAgICAg\nICAgX2Jyb2tlci5hc3NlcnRPcGVuKCk7CiAgICAgICAgYXNzZXJ0Tm90Q2xv\nc2VJbnZva2VkKCk7CiAgICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CgogICAg\ncHVibGljIExvY2tNb2RlVHlwZSBnZXRMb2NrTW9kZShPYmplY3QgZW50aXR5\nKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAg\ncmV0dXJuIE1peGVkTG9ja0xldmVsc0hlbHBlci5mcm9tTG9ja0xldmVsKAog\nICAgICAgICAgICBfYnJva2VyLmdldExvY2tMZXZlbChlbnRpdHkpKTsKICAg\nIH0KCiAgICBwdWJsaWMgdm9pZCBsb2NrKE9iamVjdCBlbnRpdHksIExvY2tN\nb2RlVHlwZSBtb2RlKSB7CiAgICAgICAgbG9jayhlbnRpdHksIG1vZGUsIC0x\nKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBsb2NrKE9iamVjdCBlbnRpdHkp\nIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICBh\nc3NlcnRWYWxpZEF0dGNoZWRFbnRpdHkoZW50aXR5KTsKICAgICAgICBfYnJv\na2VyLmxvY2soZW50aXR5LCB0aGlzKTsKICAgIH0KCiAgICBwdWJsaWMgdm9p\nZCBsb2NrKE9iamVjdCBlbnRpdHksIExvY2tNb2RlVHlwZSBtb2RlLCBpbnQg\ndGltZW91dCkgewogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwog\nICAgICAgIGFzc2VydFZhbGlkQXR0Y2hlZEVudGl0eShlbnRpdHkpOwoKICAg\nICAgICBwcm9jZXNzTG9ja1Byb3BlcnRpZXMocHVzaEZldGNoUGxhbigpLCBt\nb2RlLCBudWxsKTsKICAgICAgICB0cnkgewogICAgICAgICAgICBfYnJva2Vy\nLmxvY2soZW50aXR5LCBNaXhlZExvY2tMZXZlbHNIZWxwZXIudG9Mb2NrTGV2\nZWwobW9kZSksCiAgICAgICAgICAgICAgICB0aW1lb3V0LCB0aGlzKTsKICAg\nICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICBwb3BGZXRjaFBsYW4oKTsK\nICAgICAgICB9CiAgICB9CgogICAgcHVibGljIHZvaWQgbG9jayhPYmplY3Qg\nZW50aXR5LCBMb2NrTW9kZVR5cGUgbW9kZSwKICAgICAgICBNYXA8U3RyaW5n\nLCBPYmplY3Q+IHByb3BlcnRpZXMpIHsKICAgICAgICBhc3NlcnROb3RDbG9z\nZUludm9rZWQoKTsKICAgICAgICBhc3NlcnRWYWxpZEF0dGNoZWRFbnRpdHko\nZW50aXR5KTsKICAgICAgICBfYnJva2VyLmFzc2VydEFjdGl2ZVRyYW5zYWN0\naW9uKCk7CgogICAgICAgIHByb2Nlc3NMb2NrUHJvcGVydGllcyhwdXNoRmV0\nY2hQbGFuKCksIG1vZGUsIHByb3BlcnRpZXMpOwogICAgICAgIHRyeSB7CiAg\nICAgICAgICAgIF9icm9rZXIubG9jayhlbnRpdHksIE1peGVkTG9ja0xldmVs\nc0hlbHBlci50b0xvY2tMZXZlbChtb2RlKSwKICAgICAgICAgICAgICAgIF9i\ncm9rZXIuZ2V0RmV0Y2hDb25maWd1cmF0aW9uKCkuZ2V0TG9ja1RpbWVvdXQo\nKSwgdGhpcyk7CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgcG9w\nRmV0Y2hQbGFuKCk7CiAgICAgICAgfQogICAgfQoKICAgIHB1YmxpYyB2b2lk\nIGxvY2tBbGwoQ29sbGVjdGlvbiBlbnRpdGllcykgewogICAgICAgIGFzc2Vy\ndE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIF9icm9rZXIubG9ja0FsbChl\nbnRpdGllcywgdGhpcyk7CiAgICB9CgogICAgcHVibGljIHZvaWQgbG9ja0Fs\nbChDb2xsZWN0aW9uIGVudGl0aWVzLCBMb2NrTW9kZVR5cGUgbW9kZSwgaW50\nIHRpbWVvdXQpIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsK\nICAgICAgICBfYnJva2VyLmxvY2tBbGwoZW50aXRpZXMsIE1peGVkTG9ja0xl\ndmVsc0hlbHBlci50b0xvY2tMZXZlbChtb2RlKSwKICAgICAgICAgICAgdGlt\nZW91dCwgdGhpcyk7CiAgICB9CgogICAgcHVibGljIHZvaWQgbG9ja0FsbChP\nYmplY3QuLi4gZW50aXRpZXMpIHsKICAgICAgICBsb2NrQWxsKEFycmF5cy5h\nc0xpc3QoZW50aXRpZXMpKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBsb2Nr\nQWxsKE9iamVjdFtdIGVudGl0aWVzLCBMb2NrTW9kZVR5cGUgbW9kZSwgaW50\nIHRpbWVvdXQpIHsKICAgICAgICBsb2NrQWxsKEFycmF5cy5hc0xpc3QoZW50\naXRpZXMpLCBtb2RlLCB0aW1lb3V0KTsKICAgIH0KCiAgICBwdWJsaWMgYm9v\nbGVhbiBjYW5jZWxBbGwoKSB7CiAgICAgICAgcmV0dXJuIF9icm9rZXIuY2Fu\nY2VsQWxsKCk7CiAgICB9CgogICAgcHVibGljIE9iamVjdCBnZXRDb25uZWN0\naW9uKCkgewogICAgICAgIHJldHVybiBfYnJva2VyLmdldENvbm5lY3Rpb24o\nKTsKICAgIH0KCiAgICBwdWJsaWMgQ29sbGVjdGlvbiBnZXRNYW5hZ2VkT2Jq\nZWN0cygpIHsKICAgICAgICByZXR1cm4gX2Jyb2tlci5nZXRNYW5hZ2VkT2Jq\nZWN0cygpOwogICAgfQoKICAgIHB1YmxpYyBDb2xsZWN0aW9uIGdldFRyYW5z\nYWN0aW9uYWxPYmplY3RzKCkgewogICAgICAgIHJldHVybiBfYnJva2VyLmdl\ndFRyYW5zYWN0aW9uYWxPYmplY3RzKCk7CiAgICB9CgogICAgcHVibGljIENv\nbGxlY3Rpb24gZ2V0UGVuZGluZ1RyYW5zYWN0aW9uYWxPYmplY3RzKCkgewog\nICAgICAgIHJldHVybiBfYnJva2VyLmdldFBlbmRpbmdUcmFuc2FjdGlvbmFs\nT2JqZWN0cygpOwogICAgfQoKICAgIHB1YmxpYyBDb2xsZWN0aW9uIGdldERp\ncnR5T2JqZWN0cygpIHsKICAgICAgICByZXR1cm4gX2Jyb2tlci5nZXREaXJ0\neU9iamVjdHMoKTsKICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBnZXRPcmRl\nckRpcnR5T2JqZWN0cygpIHsKICAgICAgICByZXR1cm4gX2Jyb2tlci5nZXRP\ncmRlckRpcnR5T2JqZWN0cygpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNl\ndE9yZGVyRGlydHlPYmplY3RzKGJvb2xlYW4gb3JkZXIpIHsKICAgICAgICBh\nc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICBfYnJva2VyLnNldE9y\nZGVyRGlydHlPYmplY3RzKG9yZGVyKTsKICAgIH0KCiAgICBwdWJsaWMgdm9p\nZCBkaXJ0eUNsYXNzKENsYXNzIGNscykgewogICAgICAgIGFzc2VydE5vdENs\nb3NlSW52b2tlZCgpOwogICAgICAgIF9icm9rZXIuZGlydHlUeXBlKGNscyk7\nCiAgICB9CgogICAgQFN1cHByZXNzV2FybmluZ3MoInVuY2hlY2tlZCIpCiAg\nICBwdWJsaWMgQ29sbGVjdGlvbjxDbGFzcz4gZ2V0UGVyc2lzdGVkQ2xhc3Nl\ncygpIHsKICAgICAgICByZXR1cm4gKENvbGxlY3Rpb248Q2xhc3M+KSBfYnJv\na2VyLmdldFBlcnNpc3RlZFR5cGVzKCk7CiAgICB9CgogICAgQFN1cHByZXNz\nV2FybmluZ3MoInVuY2hlY2tlZCIpCiAgICBwdWJsaWMgQ29sbGVjdGlvbjxD\nbGFzcz4gZ2V0VXBkYXRlZENsYXNzZXMoKSB7CiAgICAgICAgcmV0dXJuIChD\nb2xsZWN0aW9uPENsYXNzPikgX2Jyb2tlci5nZXRVcGRhdGVkVHlwZXMoKTsK\nICAgIH0KCiAgICBAU3VwcHJlc3NXYXJuaW5ncygidW5jaGVja2VkIikKICAg\nIHB1YmxpYyBDb2xsZWN0aW9uPENsYXNzPiBnZXRSZW1vdmVkQ2xhc3Nlcygp\nIHsKICAgICAgICByZXR1cm4gKENvbGxlY3Rpb248Q2xhc3M+KSBfYnJva2Vy\nLmdldERlbGV0ZWRUeXBlcygpOwogICAgfQoKICAgIHB1YmxpYyA8VD4gVCBj\ncmVhdGVJbnN0YW5jZShDbGFzczxUPiBjbHMpIHsKICAgICAgICBhc3NlcnRO\nb3RDbG9zZUludm9rZWQoKTsKICAgICAgICByZXR1cm4gKFQpIF9icm9rZXIu\nbmV3SW5zdGFuY2UoY2xzKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBjbG9z\nZSgpIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAgICAg\nICBfYnJva2VyLmNsb3NlKCk7CiAgICB9CgogICAgcHVibGljIGJvb2xlYW4g\naXNPcGVuKCkgewogICAgICAgIHJldHVybiAhX2Jyb2tlci5pc0Nsb3NlSW52\nb2tlZCgpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIGRpcnR5KE9iamVjdCBv\nLCBTdHJpbmcgZmllbGQpIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUludm9r\nZWQoKTsKICAgICAgICBPcGVuSlBBU3RhdGVNYW5hZ2VyIHNtID0gX2Jyb2tl\nci5nZXRTdGF0ZU1hbmFnZXIobyk7CiAgICAgICAgdHJ5IHsKICAgICAgICAg\nICAgaWYgKHNtICE9IG51bGwpCiAgICAgICAgICAgICAgICBzbS5kaXJ0eShm\naWVsZCk7CiAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAgICAg\nICAgICAgdGhyb3cgUGVyc2lzdGVuY2VFeGNlcHRpb25zLnRvUGVyc2lzdGVu\nY2VFeGNlcHRpb24oZSk7CiAgICAgICAgfQogICAgfQoKICAgIHB1YmxpYyBP\nYmplY3QgZ2V0T2JqZWN0SWQoT2JqZWN0IG8pIHsKICAgICAgICBhc3NlcnRO\nb3RDbG9zZUludm9rZWQoKTsKICAgICAgICByZXR1cm4gSlBBRmFjYWRlSGVs\ncGVyLmZyb21PcGVuSlBBT2JqZWN0SWQoX2Jyb2tlci5nZXRPYmplY3RJZChv\nKSk7CiAgICB9CgogICAgcHVibGljIGJvb2xlYW4gaXNEaXJ0eShPYmplY3Qg\nbykgewogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAgICAg\nIHJldHVybiBfYnJva2VyLmlzRGlydHkobyk7CiAgICB9CgogICAgcHVibGlj\nIGJvb2xlYW4gaXNUcmFuc2FjdGlvbmFsKE9iamVjdCBvKSB7CiAgICAgICAg\nYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAgcmV0dXJuIF9icm9r\nZXIuaXNUcmFuc2FjdGlvbmFsKG8pOwogICAgfQoKICAgIHB1YmxpYyBib29s\nZWFuIGlzUGVyc2lzdGVudChPYmplY3QgbykgewogICAgICAgIGFzc2VydE5v\ndENsb3NlSW52b2tlZCgpOwogICAgICAgIHJldHVybiBfYnJva2VyLmlzUGVy\nc2lzdGVudChvKTsKICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBpc05ld2x5\nUGVyc2lzdGVudChPYmplY3QgbykgewogICAgICAgIGFzc2VydE5vdENsb3Nl\nSW52b2tlZCgpOwogICAgICAgIHJldHVybiBfYnJva2VyLmlzTmV3KG8pOwog\nICAgfQoKICAgIHB1YmxpYyBib29sZWFuIGlzUmVtb3ZlZChPYmplY3Qgbykg\newogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIHJl\ndHVybiBfYnJva2VyLmlzRGVsZXRlZChvKTsKICAgIH0KCiAgICBwdWJsaWMg\nYm9vbGVhbiBpc0RldGFjaGVkKE9iamVjdCBlbnRpdHkpIHsKICAgICAgICBh\nc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICByZXR1cm4gX2Jyb2tl\nci5pc0RldGFjaGVkKGVudGl0eSk7CiAgICB9CgogICAgcHVibGljIE9iamVj\ndCBnZXRWZXJzaW9uKE9iamVjdCBvKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xv\nc2VJbnZva2VkKCk7CiAgICAgICAgcmV0dXJuIF9icm9rZXIuZ2V0VmVyc2lv\nbihvKTsKICAgIH0KCiAgICAvKioKICAgICAqIFRocm93IGFwcHJvcHJpYXRl\nIGV4Y2VwdGlvbiBpZiBjbG9zZSBoYXMgYmVlbiBpbnZva2VkIGJ1dCB0aGUg\nYnJva2VyCiAgICAgKiBpcyBzdGlsbCBvcGVuLiAgV2UgdGVzdCBvbmx5IGZv\nciB0aGlzIGJlY2F1c2UgaWYgdGhlIGJyb2tlciBpcyBhbHJlYWR5CiAgICAg\nKiBjbG9zZWQsIGl0IHdpbGwgdGhyb3cgaXRzIG93biBtb3JlIGluZm9ybWF0\naXZlIGV4Y2VwdGlvbiB3aGVuIHdlIAogICAgICogZGVsZWdhdGUgdGhlIHBl\nbmRpbmcgb3BlcmF0aW9uIHRvIGl0LgogICAgICovCiAgICB2b2lkIGFzc2Vy\ndE5vdENsb3NlSW52b2tlZCgpIHsKICAgICAgICBpZiAoIV9icm9rZXIuaXND\nbG9zZWQoKSAmJiBfYnJva2VyLmlzQ2xvc2VJbnZva2VkKCkpCiAgICAgICAg\nICAgIHRocm93IG5ldyBJbnZhbGlkU3RhdGVFeGNlcHRpb24oX2xvYy5nZXQo\nImNsb3NlLWludm9rZWQiKSwgbnVsbCwKICAgICAgICAgICAgICAgIG51bGws\nIHRydWUpOwogICAgfQoKICAgIC8qKgogICAgICogVGhyb3cgSWxsZWdhbEFy\nZ3VtZW50RXhjZXB0aW9uaWYgaWYgZW50aXR5IGlzIG5vdCBhIHZhbGlkIGVu\ndGl0eSBvcgogICAgICogaWYgaXQgaXMgZGV0YWNoZWQuCiAgICAgKi8KICAg\nIHZvaWQgYXNzZXJ0VmFsaWRBdHRjaGVkRW50aXR5KE9iamVjdCBlbnRpdHkp\nIHsKICAgICAgICBPcGVuSlBBU3RhdGVNYW5hZ2VyIHNtID0gX2Jyb2tlci5n\nZXRTdGF0ZU1hbmFnZXIoZW50aXR5KTsKICAgICAgICBpZiAoc20gPT0gbnVs\nbCB8fCAhc20uaXNQZXJzaXN0ZW50KCkgfHwgc20uaXNEZXRhY2hlZCgpKSB7\nCiAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRp\nb24oX2xvYy5nZXQoCiAgICAgICAgICAgICAgICAiaW52YWxpZF9lbnRpdHlf\nYXJndW1lbnQiKS5nZXRNZXNzYWdlKCkpOwogICAgICAgIH0KICAgIH0KCiAg\nICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwogICAgLy8gRmlu\nZENhbGxiYWNrcyBpbXBsZW1lbnRhdGlvbgogICAgLy8vLy8vLy8vLy8vLy8v\nLy8vLy8vLy8vLy8vLy8vLy8KCiAgICBwdWJsaWMgT2JqZWN0IHByb2Nlc3NB\ncmd1bWVudChPYmplY3QgYXJnKSB7CiAgICAgICAgcmV0dXJuIGFyZzsKICAg\nIH0KCiAgICBwdWJsaWMgT2JqZWN0IHByb2Nlc3NSZXR1cm4oT2JqZWN0IG9p\nZCwgT3BlbkpQQVN0YXRlTWFuYWdlciBzbSkgewogICAgICAgIHJldHVybiAo\nc20gPT0gbnVsbCB8fCBzbS5pc0RlbGV0ZWQoKSkgPyBudWxsIDogc20uZ2V0\nTWFuYWdlZEluc3RhbmNlKCk7CiAgICB9CgogICAgLy8vLy8vLy8vLy8vLy8v\nLy8vLy8vLy8vLy8vLy8vCiAgICAvLyBPcENhbGxiYWNrcyBpbXBsZW1lbnRh\ndGlvbgogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCgogICAg\ncHVibGljIGludCBwcm9jZXNzQXJndW1lbnQoaW50IG9wLCBPYmplY3Qgb2Jq\nLCBPcGVuSlBBU3RhdGVNYW5hZ2VyIHNtKSB7CiAgICAgICAgc3dpdGNoIChv\ncCkgewogICAgICAgICAgICBjYXNlIE9QX0RFTEVURToKICAgICAgICAgICAg\nICAgIC8vIGNhc2NhZGUgdGhyb3VnaCBub24tcGVyc2lzdGVudCBub24tZGV0\nYWNoZWQgaW5zdGFuY2VzCiAgICAgICAgICAgICAgICBpZiAoc20gPT0gbnVs\nbCAmJiAhX2Jyb2tlci5pc0RldGFjaGVkKG9iaikpCiAgICAgICAgICAgICAg\nICAgICAgcmV0dXJuIEFDVF9DQVNDQURFOwogICAgICAgICAgICAgICAgaWYg\nKHNtICE9IG51bGwgJiYgIXNtLmlzRGV0YWNoZWQoKSAmJiAhc20uaXNQZXJz\naXN0ZW50KCkpCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIEFDVF9DQVND\nQURFOwogICAgICAgICAgICAgICAgLy8gaWdub3JlIGRlbGV0ZWQgaW5zdGFu\nY2VzCiAgICAgICAgICAgICAgICBpZiAoc20gIT0gbnVsbCAmJiBzbS5pc0Rl\nbGV0ZWQoKSkKICAgICAgICAgICAgICAgICAgICByZXR1cm4gQUNUX05PTkU7\nCiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSBPUF9B\nVFRBQ0g6CiAgICAgICAgICAgICAgICAvLyBkaWUgb24gcmVtb3ZlZAogICAg\nICAgICAgICAgICAgaWYgKHNtICE9IG51bGwgJiYgc20uaXNEZWxldGVkKCkp\nCiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IFVzZXJFeGNlcHRpb24o\nX2xvYy5nZXQoInJlbW92ZWQiLAogICAgICAgICAgICAgICAgICAgICAgICBF\neGNlcHRpb25zLnRvU3RyaW5nKG9iaikpKS5zZXRGYWlsZWRPYmplY3Qob2Jq\nKTsKICAgICAgICAgICAgICAgIC8vIGNhc2NhZGUgdGhyb3VnaCBtYW5hZ2Vk\nIGluc3RhbmNlcwogICAgICAgICAgICAgICAgaWYgKHNtICE9IG51bGwgJiYg\nIXNtLmlzRGV0YWNoZWQoKSkKICAgICAgICAgICAgICAgICAgICByZXR1cm4g\nQUNUX0NBU0NBREU7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAg\nICAgY2FzZSBPUF9SRUZSRVNIOgogICAgICAgICAgICAgICAgLy8gZGllIG9u\nIHVubWFuYWdlZCBpbnN0YW5jZXMKICAgICAgICAgICAgICAgIGlmIChzbSA9\nPSBudWxsKQogICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBVc2VyRXhj\nZXB0aW9uKF9sb2MuZ2V0KCJub3QtbWFuYWdlZCIsCiAgICAgICAgICAgICAg\nICAgICAgICAgIEV4Y2VwdGlvbnMudG9TdHJpbmcob2JqKSkpLnNldEZhaWxl\nZE9iamVjdChvYmopOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAg\nICAgIGNhc2UgT1BfREVUQUNIOgogICAgICAgICAgICAgICAgaWYgKHNtID09\nIG51bGwgfHwgIXNtLmlzUGVyc2lzdGVudCgpIHx8IHNtLmlzRGV0YWNoZWQo\nKSkKICAgICAgICAgICAgICAgICAgICByZXR1cm4gQUNUX05PTkU7CiAgICAg\nICAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIEFD\nVF9SVU4gfCBBQ1RfQ0FTQ0FERTsKICAgIH0KCiAgICBwdWJsaWMgaW50IGhh\nc2hDb2RlKCkgewogICAgICAgIHJldHVybiAoX2Jyb2tlciA9PSBudWxsKSA/\nIDAgOiBfYnJva2VyLmhhc2hDb2RlKCk7CiAgICB9CgogICAgcHVibGljIGJv\nb2xlYW4gZXF1YWxzKE9iamVjdCBvdGhlcikgewogICAgICAgIGlmIChvdGhl\nciA9PSB0aGlzKQogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICBp\nZiAoKG90aGVyID09IG51bGwpIHx8IChvdGhlci5nZXRDbGFzcygpICE9IHRo\naXMuZ2V0Q2xhc3MoKSkpCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAg\nICAgICBpZiAoX2Jyb2tlciA9PSBudWxsKQogICAgICAgICAgICByZXR1cm4g\nZmFsc2U7CiAgICAgICAgcmV0dXJuIF9icm9rZXIuZXF1YWxzKCgoRW50aXR5\nTWFuYWdlckltcGwpIG90aGVyKS5fYnJva2VyKTsKICAgIH0KCiAgICBwdWJs\naWMgdm9pZCByZWFkRXh0ZXJuYWwoT2JqZWN0SW5wdXQgaW4pCiAgICAgICAg\ndGhyb3dzIElPRXhjZXB0aW9uLCBDbGFzc05vdEZvdW5kRXhjZXB0aW9uIHsK\nICAgICAgICB0cnkgewogICAgICAgICAgICBfcmV0ID0gUGVyc2lzdGVuY2VF\neGNlcHRpb25zLmdldFJvbGxiYWNrVHJhbnNsYXRvcih0aGlzKTsKCiAgICAg\nICAgICAgIC8vIHRoaXMgYXNzdW1lcyB0aGF0IHNlcmlhbGl6ZWQgQnJva2Vy\ncyBhcmUgZnJvbSBzb21ldGhpbmcKICAgICAgICAgICAgLy8gdGhhdCBleHRl\nbmRzIEFic3RyYWN0QnJva2VyRmFjdG9yeS4KICAgICAgICAgICAgT2JqZWN0\nIGZhY3RvcnlLZXkgPSBpbi5yZWFkT2JqZWN0KCk7CiAgICAgICAgICAgIEFi\nc3RyYWN0QnJva2VyRmFjdG9yeSBmYWN0b3J5ID0KICAgICAgICAgICAgICAg\nIEFic3RyYWN0QnJva2VyRmFjdG9yeS5nZXRQb29sZWRGYWN0b3J5Rm9yS2V5\nKGZhY3RvcnlLZXkpOwogICAgICAgICAgICBieXRlW10gYnJva2VyQnl0ZXMg\nPSAoYnl0ZVtdKSBpbi5yZWFkT2JqZWN0KCk7CiAgICAgICAgICAgIE9iamVj\ndElucHV0U3RyZWFtIGlubmVySW4gPSBuZXcgQnJva2VyQnl0ZXNJbnB1dFN0\ncmVhbShicm9rZXJCeXRlcywKICAgICAgICAgICAgICAgIGZhY3RvcnkuZ2V0\nQ29uZmlndXJhdGlvbigpKTsKCiAgICAgICAgICAgIEJyb2tlciBicm9rZXIg\nPSAoQnJva2VyKSBpbm5lckluLnJlYWRPYmplY3QoKTsKICAgICAgICAgICAg\nRW50aXR5TWFuYWdlckZhY3RvcnlJbXBsIGVtZiA9IChFbnRpdHlNYW5hZ2Vy\nRmFjdG9yeUltcGwpCiAgICAgICAgICAgICAgICBKUEFGYWNhZGVIZWxwZXIu\ndG9FbnRpdHlNYW5hZ2VyRmFjdG9yeSgKICAgICAgICAgICAgICAgICAgICBi\ncm9rZXIuZ2V0QnJva2VyRmFjdG9yeSgpKTsKICAgICAgICAgICAgYnJva2Vy\nLnB1dFVzZXJPYmplY3QoSlBBRmFjYWRlSGVscGVyLkVNX0tFWSwgdGhpcyk7\nCiAgICAgICAgICAgIGluaXRpYWxpemUoZW1mLCBicm9rZXIpOwogICAgICAg\nIH0gY2F0Y2ggKFJ1bnRpbWVFeGNlcHRpb24gcmUpIHsKICAgICAgICAgICAg\ndHJ5IHsKICAgICAgICAgICAgICAgIHJlID0gX3JldC50cmFuc2xhdGUocmUp\nOwogICAgICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkgewogICAgICAg\nICAgICAgICAgLy8gaWdub3JlCiAgICAgICAgICAgIH0KICAgICAgICAgICAg\ndGhyb3cgcmU7CiAgICAgICAgfQogICAgfQoKICAgIHB1YmxpYyB2b2lkIHdy\naXRlRXh0ZXJuYWwoT2JqZWN0T3V0cHV0IG91dCkgdGhyb3dzIElPRXhjZXB0\naW9uIHsKICAgICAgICB0cnkgewogICAgICAgICAgICAvLyB0aGlzIHJlcXVp\ncmVzIHRoYXQgb25seSBBYnN0cmFjdEJyb2tlckZhY3Rvcnktc291cmNlZAog\nICAgICAgICAgICAvLyBicm9rZXJzIGNhbiBiZSBzZXJpYWxpemVkCiAgICAg\nICAgICAgIE9iamVjdCBmYWN0b3J5S2V5ID0gKChBYnN0cmFjdEJyb2tlckZh\nY3RvcnkpIF9icm9rZXIKICAgICAgICAgICAgICAgIC5nZXRCcm9rZXJGYWN0\nb3J5KCkpLmdldFBvb2xLZXkoKTsKICAgICAgICAgICAgb3V0LndyaXRlT2Jq\nZWN0KGZhY3RvcnlLZXkpOwogICAgICAgICAgICBCeXRlQXJyYXlPdXRwdXRT\ndHJlYW0gYmFvcyA9IG5ldyBCeXRlQXJyYXlPdXRwdXRTdHJlYW0oKTsKICAg\nICAgICAgICAgT2JqZWN0T3V0cHV0U3RyZWFtIGlubmVyT3V0ID0gbmV3IE9i\namVjdE91dHB1dFN0cmVhbShiYW9zKTsKICAgICAgICAgICAgaW5uZXJPdXQu\nd3JpdGVPYmplY3QoX2Jyb2tlci5nZXREZWxlZ2F0ZSgpKTsKICAgICAgICAg\nICAgaW5uZXJPdXQuZmx1c2goKTsKICAgICAgICAgICAgb3V0LndyaXRlT2Jq\nZWN0KGJhb3MudG9CeXRlQXJyYXkoKSk7CiAgICAgICAgfSBjYXRjaCAoUnVu\ndGltZUV4Y2VwdGlvbiByZSkgewogICAgICAgICAgICB0cnkgewogICAgICAg\nICAgICAgICAgcmUgPSBfcmV0LnRyYW5zbGF0ZShyZSk7CiAgICAgICAgICAg\nIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgICAgICAvLyBp\nZ25vcmUKICAgICAgICAgICAgfQogICAgICAgICAgICB0aHJvdyByZTsKICAg\nICAgICB9CiAgICB9CgogICAgcHJpdmF0ZSBzdGF0aWMgY2xhc3MgQnJva2Vy\nQnl0ZXNJbnB1dFN0cmVhbSBleHRlbmRzIE9iamVjdElucHV0U3RyZWFtIHsK\nCiAgICAgICAgcHJpdmF0ZSBPcGVuSlBBQ29uZmlndXJhdGlvbiBjb25mOwoK\nICAgICAgICBCcm9rZXJCeXRlc0lucHV0U3RyZWFtKGJ5dGVbXSBieXRlcywg\nT3BlbkpQQUNvbmZpZ3VyYXRpb24gY29uZikKICAgICAgICAgICAgdGhyb3dz\nIElPRXhjZXB0aW9uIHsKICAgICAgICAgICAgc3VwZXIobmV3IEJ5dGVBcnJh\neUlucHV0U3RyZWFtKGJ5dGVzKSk7CiAgICAgICAgICAgIGlmIChjb25mID09\nIG51bGwpCiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3Vt\nZW50RXhjZXB0aW9uKAogICAgICAgICAgICAgICAgICAgICJJbGxlZ2FsIG51\nbGwgYXJndW1lbnQgdG8gT2JqZWN0SW5wdXRTdHJlYW1XaXRoTG9hZGVyIik7\nCiAgICAgICAgICAgIHRoaXMuY29uZiA9IGNvbmY7CiAgICAgICAgfQoKICAg\nICAgICAvKioKICAgICAgICAgKiBNYWtlIGEgcHJpbWl0aXZlIGFycmF5IGNs\nYXNzCiAgICAgICAgICovCiAgICAgICAgcHJpdmF0ZSBDbGFzcyBwcmltaXRp\ndmVUeXBlKGNoYXIgdHlwZSkgewogICAgICAgICAgICBzd2l0Y2ggKHR5cGUp\nIHsKICAgICAgICAgICAgICAgIGNhc2UgJ0InOiByZXR1cm4gYnl0ZS5jbGFz\nczsKICAgICAgICAgICAgICAgIGNhc2UgJ0MnOiByZXR1cm4gY2hhci5jbGFz\nczsKICAgICAgICAgICAgICAgIGNhc2UgJ0QnOiByZXR1cm4gZG91YmxlLmNs\nYXNzOwogICAgICAgICAgICAgICAgY2FzZSAnRic6IHJldHVybiBmbG9hdC5j\nbGFzczsKICAgICAgICAgICAgICAgIGNhc2UgJ0knOiByZXR1cm4gaW50LmNs\nYXNzOwogICAgICAgICAgICAgICAgY2FzZSAnSic6IHJldHVybiBsb25nLmNs\nYXNzOwogICAgICAgICAgICAgICAgY2FzZSAnUyc6IHJldHVybiBzaG9ydC5j\nbGFzczsKICAgICAgICAgICAgICAgIGNhc2UgJ1onOiByZXR1cm4gYm9vbGVh\nbi5jbGFzczsKICAgICAgICAgICAgICAgIGRlZmF1bHQ6IHJldHVybiBudWxs\nOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBwcm90ZWN0ZWQg\nQ2xhc3MgcmVzb2x2ZUNsYXNzKE9iamVjdFN0cmVhbUNsYXNzIGNsYXNzRGVz\nYykKICAgICAgICAgICAgdGhyb3dzIElPRXhjZXB0aW9uLCBDbGFzc05vdEZv\ndW5kRXhjZXB0aW9uIHsKCiAgICAgICAgICAgIFN0cmluZyBjbmFtZSA9IGNs\nYXNzRGVzYy5nZXROYW1lKCk7CiAgICAgICAgICAgIGlmIChjbmFtZS5zdGFy\ndHNXaXRoKCJbIikpIHsKICAgICAgICAgICAgICAgIC8vIEFuIGFycmF5CiAg\nICAgICAgICAgICAgICBDbGFzcyBjb21wb25lbnQ7CQkvLyBjb21wb25lbnQg\nY2xhc3MKICAgICAgICAgICAgICAgIGludCBkY291bnQ7CQkJICAgIC8vIGRp\nbWVuc2lvbgogICAgICAgICAgICAgICAgZm9yIChkY291bnQ9MTsgY25hbWUu\nY2hhckF0KGRjb3VudCk9PSdbJzsgZGNvdW50KyspIDsKICAgICAgICAgICAg\nICAgIGlmIChjbmFtZS5jaGFyQXQoZGNvdW50KSA9PSAnTCcpIHsKICAgICAg\nICAgICAgICAgICAgICBjb21wb25lbnQgPSBsb29rdXBDbGFzcyhjbmFtZS5z\ndWJzdHJpbmcoZGNvdW50KzEsCiAgICAgICAgICAgICAgICAgICAgICAgIGNu\nYW1lLmxlbmd0aCgpLTEpKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAg\nICAgICAgICAgICAgICAgICAgaWYgKGNuYW1lLmxlbmd0aCgpICE9IGRjb3Vu\ndCsxKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBDbGFz\nc05vdEZvdW5kRXhjZXB0aW9uKGNuYW1lKTsvLyBtYWxmb3JtZWQKICAgICAg\nICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgY29tcG9uZW50\nID0gcHJpbWl0aXZlVHlwZShjbmFtZS5jaGFyQXQoZGNvdW50KSk7CiAgICAg\nICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpbnQgZGltW10gPSBuZXcg\naW50W2Rjb3VudF07CiAgICAgICAgICAgICAgICBmb3IgKGludCBpPTA7IGk8\nZGNvdW50OyBpKyspIHsKICAgICAgICAgICAgICAgICAgICBkaW1baV09MDsK\nICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybiBBcnJh\neS5uZXdJbnN0YW5jZShjb21wb25lbnQsIGRpbSkuZ2V0Q2xhc3MoKTsKICAg\nICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHJldHVybiBsb29r\ndXBDbGFzcyhjbmFtZSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAg\nICAgIC8qKgogICAgICAgICAqIElmIHRoaXMgaXMgYSBnZW5lcmF0ZWQgc3Vi\nY2xhc3MsIGxvb2sgdXAgdGhlIGNvcnJlc3BvbmRpbmcgQ2xhc3MKICAgICAg\nICAgKiBvYmplY3QgdmlhIG1ldGFkYXRhLgogICAgICAgICAqLwogICAgICAg\nIHByaXZhdGUgQ2xhc3MgbG9va3VwQ2xhc3MoU3RyaW5nIGNsYXNzTmFtZSkK\nICAgICAgICAgICAgdGhyb3dzIENsYXNzTm90Rm91bmRFeGNlcHRpb24gewog\nICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgcmV0dXJuIENsYXNz\nLmZvck5hbWUoY2xhc3NOYW1lKTsKICAgICAgICAgICAgfSBjYXRjaCAoQ2xh\nc3NOb3RGb3VuZEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgICAgICBpZiAo\nUENFbmhhbmNlci5pc1BDU3ViY2xhc3NOYW1lKGNsYXNzTmFtZSkpIHsKICAg\nICAgICAgICAgICAgICAgICBTdHJpbmcgc3VwZXJOYW1lID0gUENFbmhhbmNl\nci50b01hbmFnZWRUeXBlTmFtZShjbGFzc05hbWUpOwogICAgICAgICAgICAg\nICAgICAgIENsYXNzTWV0YURhdGFbXSBtZXRhcyA9IGNvbmYuZ2V0TWV0YURh\ndGFSZXBvc2l0b3J5SW5zdGFuY2UoKQogICAgICAgICAgICAgICAgICAgICAg\nICAuZ2V0TWV0YURhdGFzKCk7CiAgICAgICAgICAgICAgICAgICAgZm9yIChp\nbnQgaSA9IDA7IGkgPCBtZXRhcy5sZW5ndGg7IGkrKykgewogICAgICAgICAg\nICAgICAgICAgICAgICBpZiAoc3VwZXJOYW1lLmVxdWFscygKICAgICAgICAg\nICAgICAgICAgICAgICAgICAgIG1ldGFzW2ldLmdldERlc2NyaWJlZFR5cGUo\nKS5nZXROYW1lKCkpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBy\nZXR1cm4gUENSZWdpc3RyeS5nZXRQQ1R5cGUoCiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgbWV0YXNbaV0uZ2V0RGVzY3JpYmVkVHlwZSgpKTsK\nICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAg\nIH0KCiAgICAgICAgICAgICAgICAgICAgLy8gaWYgaXQncyBub3QgZm91bmQs\nIHRyeSB0byBsb29rIGZvciBpdCBhbnl3YXlzCiAgICAgICAgICAgICAgICAg\nICAgcmV0dXJuIENsYXNzLmZvck5hbWUoY2xhc3NOYW1lKTsKICAgICAgICAg\nICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgdGhyb3cgZTsK\nICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAg\nIH0KCiAgICBwdWJsaWMgdm9pZCBkZXRhY2goT2JqZWN0IGVudGl0eSkgewog\nICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIF9icm9r\nZXIuZGV0YWNoKGVudGl0eSwgdGhpcyk7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBDcmVhdGUgYSBxdWVyeSBmcm9tIHRoZSBnaXZlbiBDcml0cmlhUXVlcnku\nCiAgICAgKiBDb21waWxlIHRvIHJlZ2lzdGVyIHRoZSBwYXJhbWV0ZXJzIGlu\nIHRoaXMgcXVlcnkuCiAgICAgKi8KICAgIHB1YmxpYyA8VD4gVHlwZWRRdWVy\neTxUPiBjcmVhdGVRdWVyeShDcml0ZXJpYVF1ZXJ5PFQ+IGNyaXRlcmlhUXVl\ncnkpIHsKICAgICAgICAoKE9wZW5KUEFDcml0ZXJpYVF1ZXJ5PFQ+KWNyaXRl\ncmlhUXVlcnkpLmNvbXBpbGUoKTsgCiAgICAgICAgCiAgICAgICAgb3JnLmFw\nYWNoZS5vcGVuanBhLmtlcm5lbC5RdWVyeSBrZXJuZWxRdWVyeSA9X2Jyb2tl\nci5uZXdRdWVyeShDcml0ZXJpYUJ1aWxkZXIuTEFOR19DUklURVJJQSwgY3Jp\ndGVyaWFRdWVyeSk7CiAgICAgICAgUXVlcnlJbXBsPFQ+IGZhY2FkZVF1ZXJ5\nID0gbmV3IFF1ZXJ5SW1wbDxUPih0aGlzLCBfcmV0LCBrZXJuZWxRdWVyeSk7\nCiAgICAgICAgU2V0PFBhcmFtZXRlckV4cHJlc3Npb248Pz4+IHBhcmFtcyA9\nIGNyaXRlcmlhUXVlcnkuZ2V0UGFyYW1ldGVycygpOwogICAgICAgIAogICAg\nICAgIGZvciAoUGFyYW1ldGVyRXhwcmVzc2lvbjw/PiBwYXJhbSA6IHBhcmFt\ncykgewogICAgICAgICAgICBmYWNhZGVRdWVyeS5kZWNsYXJlUGFyYW1ldGVy\nKHBhcmFtLCBwYXJhbSk7CiAgICAgICAgfQogICAgICAgIHJldHVybiBmYWNh\nZGVRdWVyeTsKICAgIH0KICAgIAogICAgcHVibGljIE9wZW5KUEFRdWVyeSBj\ncmVhdGVEeW5hbWljUXVlcnkoCiAgICAgICAgb3JnLmFwYWNoZS5vcGVuanBh\nLnBlcnNpc3RlbmNlLnF1ZXJ5LlF1ZXJ5RGVmaW5pdGlvbiBxZGVmKSB7CiAg\nICAgICAgU3RyaW5nIGpwcWwgPSBfZW1mLmdldER5bmFtaWNRdWVyeUJ1aWxk\nZXIoKS50b0pQUUwocWRlZik7CiAgICAgICAgcmV0dXJuIGNyZWF0ZVF1ZXJ5\nKGpwcWwpOwogICAgfQoKICAgIHB1YmxpYyBNYXA8U3RyaW5nLCBPYmplY3Q+\nIGdldFByb3BlcnRpZXMoKSB7CiAgICAgICAgTWFwIHByb3BzID0gX2Jyb2tl\nci5nZXRQcm9wZXJ0aWVzKCk7CiAgICAgICAgZm9yIChTdHJpbmcgcyA6IF9i\ncm9rZXIuZ2V0U3VwcG9ydGVkUHJvcGVydGllcygpKSB7CiAgICAgICAgICAg\nIE1ldGhvZCBnZXR0ZXIgPSBSZWZsZWN0aW9uLmZpbmRHZXR0ZXIodGhpcy5n\nZXRDbGFzcygpLCBnZXRQcm9wZXJ0eU5hbWUocyksIGZhbHNlKTsKICAgICAg\nICAgICAgaWYgKGdldHRlciAhPSBudWxsKQogICAgICAgICAgICAgICAgcHJv\ncHMucHV0KHMsIFJlZmxlY3Rpb24uZ2V0KHRoaXMsIGdldHRlcikpOwogICAg\nICAgIH0KICAgICAgICByZXR1cm4gcHJvcHM7CiAgICB9CgogICAgcHVibGlj\nIENyaXRlcmlhQnVpbGRlciBnZXRRdWVyeUJ1aWxkZXIoKSB7CiAgICAgICAg\ncmV0dXJuIF9lbWYuZ2V0UXVlcnlCdWlsZGVyKCk7CiAgICB9CgogICAgcHVi\nbGljIFNldDxTdHJpbmc+IGdldFN1cHBvcnRlZFByb3BlcnRpZXMoKSB7CiAg\nICAgICAgcmV0dXJuIF9icm9rZXIuZ2V0U3VwcG9ydGVkUHJvcGVydGllcygp\nOwogICAgfQoKICAgIHB1YmxpYyA8VD4gVCB1bndyYXAoQ2xhc3M8VD4gY2xz\nKSB7CiAgICAgICAgT2JqZWN0W10gZGVsZWdhdGVzID0gbmV3IE9iamVjdFtd\ne19icm9rZXIuZ2V0SW5uZXJtb3N0RGVsZWdhdGUoKSwKICAgICAgICAgICAg\nX2Jyb2tlci5nZXREZWxlZ2F0ZSgpLCBfYnJva2VyLCB0aGlzfTsKICAgICAg\nICBmb3IgKE9iamVjdCBvIDogZGVsZWdhdGVzKSB7CiAgICAgICAgICAgIGlm\nIChjbHMuaXNJbnN0YW5jZShvKSkKICAgICAgICAgICAgICAgIHJldHVybiAo\nVClvOwogICAgICAgIH0KICAgICAgICB0aHJvdyBuZXcgUGVyc2lzdGVuY2VF\neGNlcHRpb24oX2xvYy5nZXQoInVud3JhcC1lbS1pbnZhbGlkIiwgY2xzKQog\nICAgICAgICAgICAudG9TdHJpbmcoKSwgbnVsbCwgdGhpcywgZmFsc2UpOwog\nICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldFF1ZXJ5U1FMQ2FjaGUoYm9vbGVh\nbiBmbGFnKSB7CiAgICAgICAgX2Jyb2tlci5zZXRDYWNoZVByZXBhcmVkUXVl\ncnkoZmxhZyk7CiAgICB9CiAgICAKICAgIHB1YmxpYyBib29sZWFuIGdldFF1\nZXJ5U1FMQ2FjaGUoKSB7CiAgICAgICAgcmV0dXJuIF9icm9rZXIuZ2V0Q2Fj\naGVQcmVwYXJlZFF1ZXJ5KCk7CiAgICB9CiAgICAKICAgIFJ1bnRpbWVFeGNl\ncHRpb25UcmFuc2xhdG9yIGdldEV4Y2VwdGlvblRyYW5zbGF0b3IoKSB7CiAg\nICAgICAgcmV0dXJuIF9yZXQ7CiAgICB9CgogICAgcHJpdmF0ZSB2b2lkIHBy\nb2Nlc3NMb2NrUHJvcGVydGllcyhGZXRjaFBsYW4gZlBsYW4sIExvY2tNb2Rl\nVHlwZSBtb2RlLAogICAgICAgIE1hcDxTdHJpbmcsIE9iamVjdD4gcHJvcGVy\ndGllcykgewogICAgICAgIC8vIGhhbmRsZSBwcm9wZXJ0aWVzIGluIG1hcCBm\naXJzdAogICAgICAgIGZQbGFuLmFkZEhpbnRzKHByb3BlcnRpZXMpOwogICAg\nICAgIC8vIG92ZXJyaWRlIHdpdGggdGhlIHNwZWNpZmljIGxvY2tNb2RlLCBp\nZiBuZWVkZWQuCiAgICAgICAgaWYgKG1vZGUgIT0gbnVsbCAmJiBtb2RlICE9\nIExvY2tNb2RlVHlwZS5OT05FKSB7CiAgICAgICAgICAgIC8vIFNldCBvdmVy\ncmlkZW4gcmVhZCBsb2NrIGxldmVsCiAgICAgICAgICAgIExvY2tNb2RlVHlw\nZSBjdXJSZWFkTG9ja01vZGUgPSBmUGxhbi5nZXRSZWFkTG9ja01vZGUoKTsK\nICAgICAgICAgICAgaWYgKG1vZGUgIT0gY3VyUmVhZExvY2tNb2RlKQogICAg\nICAgICAgICAgICAgZlBsYW4uc2V0UmVhZExvY2tNb2RlKG1vZGUpOwogICAg\nICAgIH0KICAgIH0KCiAgICBwdWJsaWMgTWV0YW1vZGVsIGdldE1ldGFtb2Rl\nbCgpIHsKICAgICAgICByZXR1cm4gX2VtZi5nZXRNZXRhbW9kZWwoKTsKICAg\nIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRQcm9wZXJ0eShTdHJpbmcgcHJvcCwg\nT2JqZWN0IHZhbHVlKSB7CiAgICAgICAgU3RyaW5nIGJlYW5Qcm9wID0gZ2V0\nUHJvcGVydHlOYW1lKHByb3ApOwogICAgICAgIHRyeSB7CiAgICAgICAgICAg\nIE1ldGhvZCBzZXR0ZXIgPSBSZWZsZWN0aW9uLmZpbmRTZXR0ZXIodGhpcy5n\nZXRDbGFzcygpLCBiZWFuUHJvcCwgZmFsc2UpOwogICAgICAgICAgICBpZiAo\nc2V0dGVyICE9IG51bGwpIHsKICAgICAgICAgICAgICAgIGlmICh2YWx1ZSBp\nbnN0YW5jZW9mIFN0cmluZykgewogICAgICAgICAgICAgICAgICAgIGlmICgi\nbnVsbCIuZXF1YWxzKHZhbHVlKSkgewogICAgICAgICAgICAgICAgICAgICAg\nICB2YWx1ZSA9IG51bGw7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsK\nICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBTdHJpbmdzLnBhcnNl\nKChTdHJpbmcpIHZhbHVlLCBzZXR0ZXIuZ2V0UGFyYW1ldGVyVHlwZXMoKVsw\nXSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQog\nICAgICAgICAgICAgICAgUmVmbGVjdGlvbi5zZXQodGhpcywgc2V0dGVyLCB2\nYWx1ZSk7CiAgICAgICAgICAgIH0KICAgICAgICB9IGNhdGNoIChFeGNlcHRp\nb24gZXgpIHsKICAgICAgICAgICAgTG9nIGxvZyA9IGdldENvbmZpZ3VyYXRp\nb24oKS5nZXRMb2coT3BlbkpQQUNvbmZpZ3VyYXRpb24uTE9HX1JVTlRJTUUp\nOwogICAgICAgICAgICBpZiAobG9nLmlzV2FybkVuYWJsZWQoKSkKICAgICAg\nICAgICAgICAgIGxvZy53YXJuKF9sb2MuZ2V0KCJiYWQtZW0tcHJvcCIsIHBy\nb3AsIHZhbHVlKSk7CiAgICAgICAgfQogICAgfQogICAgCiAgICBTdHJpbmcg\nZ2V0UHJvcGVydHlOYW1lKFN0cmluZyBzKSB7CiAgICAgICAgaW50IGRvdCA9\nIHMubGFzdEluZGV4T2YoJy4nKTsKICAgICAgICByZXR1cm4gZG90ID09IC0x\nID8gcyA6IHMuc3Vic3RyaW5nKGRvdCsxKTsKICAgIH0KICAgIAogICAgcHVi\nbGljIHZvaWQgc2V0UmV0cmlldmVNb2RlKENhY2hlUmV0cmlldmVNb2RlIHJl\ndHJpZXZlTW9kZSkgeyAKICAgICAgICBfYnJva2VyLnNldENhY2hlUmV0cmll\ndmVNb2RlKHRvRGF0YUNhY2hlUmV0cmlldmVNb2RlKHJldHJpZXZlTW9kZSkp\nOwogICAgfQoKICAgIHB1YmxpYyBDYWNoZVJldHJpZXZlTW9kZSBnZXRSZXRy\naWV2ZU1vZGUoKSB7IAogICAgICAgIHJldHVybiBmcm9tRGF0YUNhY2hlUmV0\ncmlldmVNb2RlKF9icm9rZXIuZ2V0Q2FjaGVSZXRyaWV2ZU1vZGUoKSk7CiAg\nICB9CiAgICAKICAgIHB1YmxpYyB2b2lkIHNldFN0b3JlTW9kZShDYWNoZVN0\nb3JlTW9kZSBzdG9yZU1vZGUpIHsgCiAgICAgICAgX2Jyb2tlci5zZXRDYWNo\nZVN0b3JlTW9kZSh0b0RhdGFDYWNoZVN0b3JlTW9kZShzdG9yZU1vZGUpKTsK\nICAgIH0KICAgIAogICAgcHVibGljIENhY2hlU3RvcmVNb2RlIGdldFN0b3Jl\nTW9kZSgpIHsgCiAgICAgICAgcmV0dXJuIGZyb21EYXRhQ2FjaGVTdG9yZU1v\nZGUoX2Jyb2tlci5nZXRDYWNoZVN0b3JlTW9kZSgpKTsKICAgIH0KICAgIAog\nICAgcHJpdmF0ZSBmaW5hbCBEYXRhQ2FjaGVSZXRyaWV2ZU1vZGUgdG9EYXRh\nQ2FjaGVSZXRyaWV2ZU1vZGUoQ2FjaGVSZXRyaWV2ZU1vZGUgbW9kZSApIHsK\nICAgICAgICAvLyByZWxpZXMgb24gdGhlIENhY2hlUmV0cmlldmVNb2RlIGVu\ndW1zIGJlaW5nIG5lYXJseSBpZGVudGljYWwgCiAgICAgICAgcmV0dXJuIERh\ndGFDYWNoZVJldHJpZXZlTW9kZS52YWx1ZU9mKG1vZGUudG9TdHJpbmcoKSk7\nCiAgICB9CiAgICAKICAgIHByaXZhdGUgZmluYWwgRGF0YUNhY2hlU3RvcmVN\nb2RlIHRvRGF0YUNhY2hlU3RvcmVNb2RlKENhY2hlU3RvcmVNb2RlIG1vZGUg\nKSB7CiAgICAgICAgLy8gcmVsaWVzIG9uIHRoZSBDYWNoZVN0b3JlTW9kZSBl\nbnVtcyBiZWluZyBuZWFybHkgaWRlbnRpY2FsIAogICAgICAgIHJldHVybiBE\nYXRhQ2FjaGVTdG9yZU1vZGUudmFsdWVPZihtb2RlLnRvU3RyaW5nKCkpOwog\nICAgfQogICAgCiAgICBwcml2YXRlIGZpbmFsIENhY2hlUmV0cmlldmVNb2Rl\nIGZyb21EYXRhQ2FjaGVSZXRyaWV2ZU1vZGUoRGF0YUNhY2hlUmV0cmlldmVN\nb2RlIG1vZGUpIHsgCiAgICAgICAgcmV0dXJuIENhY2hlUmV0cmlldmVNb2Rl\nLnZhbHVlT2YobW9kZS50b1N0cmluZygpKTsKICAgIH0KICAgIAogICAgcHJp\ndmF0ZSBmaW5hbCBDYWNoZVN0b3JlTW9kZSBmcm9tRGF0YUNhY2hlU3RvcmVN\nb2RlKERhdGFDYWNoZVN0b3JlTW9kZSBtb2RlKSB7IAogICAgICAgIHJldHVy\nbiBDYWNoZVN0b3JlTW9kZS52YWx1ZU9mKG1vZGUudG9TdHJpbmcoKSk7CiAg\nICB9Cn0K\n","encoding":"base64"}

