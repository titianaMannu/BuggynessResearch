{"sha":"784377ce24f98f7ed0ffe246e77e13f82135e3e7","node_id":"MDQ6QmxvYjIwNjM2NDo3ODQzNzdjZTI0Zjk4ZjdlZDBmZmUyNDZlNzdlMTNmODIxMzVlM2U3","size":33310,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/784377ce24f98f7ed0ffe246e77e13f82135e3e7","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2U7CgppbXBv\ncnQgamF2YS5pby5TZXJpYWxpemFibGU7CmltcG9ydCBqYXZhLmxhbmcuYW5u\nb3RhdGlvbi5Bbm5vdGF0aW9uOwppbXBvcnQgamF2YS5sYW5nLnJlZmxlY3Qu\nQW5ub3RhdGVkRWxlbWVudDsKaW1wb3J0IGphdmEubGFuZy5yZWZsZWN0LkZp\nZWxkOwppbXBvcnQgamF2YS5sYW5nLnJlZmxlY3QuTWVtYmVyOwppbXBvcnQg\namF2YS5sYW5nLnJlZmxlY3QuTWV0aG9kOwppbXBvcnQgamF2YS5sYW5nLnJl\nZmxlY3QuTW9kaWZpZXI7CmltcG9ydCBqYXZhLnNlY3VyaXR5LkFjY2Vzc0Nv\nbnRyb2xsZXI7CmltcG9ydCBqYXZhLnV0aWwuQ29sbGVjdGlvbjsKaW1wb3J0\nIGphdmEudXRpbC5Db2xsZWN0aW9uczsKaW1wb3J0IGphdmEudXRpbC5IYXNo\nTWFwOwppbXBvcnQgamF2YS51dGlsLkhhc2hTZXQ7CmltcG9ydCBqYXZhLnV0\naWwuTWFwOwppbXBvcnQgamF2YS51dGlsLlNldDsKaW1wb3J0IGphdmEudXRp\nbC5MaXN0OwppbXBvcnQgamF2YS51dGlsLkFycmF5TGlzdDsKCmltcG9ydCBq\nYXZheC5wZXJzaXN0ZW5jZS5BY2Nlc3M7CmltcG9ydCBqYXZheC5wZXJzaXN0\nZW5jZS5BY2Nlc3NUeXBlOwppbXBvcnQgamF2YXgucGVyc2lzdGVuY2UuQmFz\naWM7CmltcG9ydCBqYXZheC5wZXJzaXN0ZW5jZS5FbGVtZW50Q29sbGVjdGlv\nbjsKaW1wb3J0IGphdmF4LnBlcnNpc3RlbmNlLkVtYmVkZGFibGU7CmltcG9y\ndCBqYXZheC5wZXJzaXN0ZW5jZS5FbWJlZGRlZDsKaW1wb3J0IGphdmF4LnBl\ncnNpc3RlbmNlLkVtYmVkZGVkSWQ7CmltcG9ydCBqYXZheC5wZXJzaXN0ZW5j\nZS5NYW55VG9NYW55OwppbXBvcnQgamF2YXgucGVyc2lzdGVuY2UuTWFueVRv\nT25lOwppbXBvcnQgamF2YXgucGVyc2lzdGVuY2UuT25lVG9NYW55OwppbXBv\ncnQgamF2YXgucGVyc2lzdGVuY2UuT25lVG9PbmU7CmltcG9ydCBqYXZheC5w\nZXJzaXN0ZW5jZS5Qb3N0TG9hZDsKaW1wb3J0IGphdmF4LnBlcnNpc3RlbmNl\nLlBvc3RQZXJzaXN0OwppbXBvcnQgamF2YXgucGVyc2lzdGVuY2UuUG9zdFJl\nbW92ZTsKaW1wb3J0IGphdmF4LnBlcnNpc3RlbmNlLlBvc3RVcGRhdGU7Cmlt\ncG9ydCBqYXZheC5wZXJzaXN0ZW5jZS5QcmVQZXJzaXN0OwppbXBvcnQgamF2\nYXgucGVyc2lzdGVuY2UuUHJlUmVtb3ZlOwppbXBvcnQgamF2YXgucGVyc2lz\ndGVuY2UuUHJlVXBkYXRlOwppbXBvcnQgamF2YXgucGVyc2lzdGVuY2UuVHJh\nbnNpZW50OwoKaW1wb3J0IG9yZy5hcGFjaGUuY29tbW9ucy5sYW5nLlN0cmlu\nZ1V0aWxzOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51dGlsLkoy\nRG9Qcml2SGVscGVyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51\ndGlsLkxvY2FsaXplcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIu\nbG9nLkxvZzsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRhLkFic3Ry\nYWN0TWV0YURhdGFEZWZhdWx0czsKaW1wb3J0IG9yZy5hcGFjaGUub3Blbmpw\nYS5tZXRhLkFjY2Vzc0NvZGU7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\nbWV0YS5DbGFzc01ldGFEYXRhOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLm1ldGEuRmllbGRNZXRhRGF0YTsKaW1wb3J0IG9yZy5hcGFjaGUub3Blbmpw\nYS5tZXRhLkphdmFUeXBlczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5t\nZXRhLk1ldGFEYXRhUmVwb3NpdG9yeTsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5tZXRhLlZhbHVlTWV0YURhdGE7CgppbXBvcnQgc3RhdGljIGphdmF4\nLnBlcnNpc3RlbmNlLkFjY2Vzc1R5cGUuRklFTEQ7CmltcG9ydCBzdGF0aWMg\namF2YXgucGVyc2lzdGVuY2UuQWNjZXNzVHlwZS5QUk9QRVJUWTsKaW1wb3J0\nIHN0YXRpYyBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuUGVyc2lz\ndGVuY2VTdHJhdGVneS4qOwoKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51\ndGlsLkludGVybmFsRXhjZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLnV0aWwuTWV0YURhdGFFeGNlcHRpb247CmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEudXRpbC5Vc2VyRXhjZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLmNvbmYuT3BlbkpQQUNvbmZpZ3VyYXRpb247CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEuZW5oYW5jZS5SZWZsZWN0aW9uOwoKLyoqCiAq\nIEpQQS1iYXNlZCBtZXRhZGF0YSBkZWZhdWx0cy4KICoKICogQGF1dGhvciBQ\nYXRyaWNrIExpbnNrZXkKICogQGF1dGhvciBBYmUgV2hpdGUKICogQGF1dGhv\nciBQaW5ha2kgUG9kZGFyCiAqIEBub2phdmFkb2MKICovCnB1YmxpYyBjbGFz\ncyBQZXJzaXN0ZW5jZU1ldGFEYXRhRGVmYXVsdHMKICAgIGV4dGVuZHMgQWJz\ndHJhY3RNZXRhRGF0YURlZmF1bHRzIHsKCiAgICBwcml2YXRlIHN0YXRpYyBm\naW5hbCBMb2NhbGl6ZXIgX2xvYyA9IExvY2FsaXplci5mb3JQYWNrYWdlCiAg\nICAgICAgKFBlcnNpc3RlbmNlTWV0YURhdGFEZWZhdWx0cy5jbGFzcyk7Cgog\nICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgTWFwPENsYXNzPD8+LCBQZXJzaXN0\nZW5jZVN0cmF0ZWd5PiBfc3RyYXRzID0KICAgICAgICBuZXcgSGFzaE1hcDxD\nbGFzczw/PiwgUGVyc2lzdGVuY2VTdHJhdGVneT4oKTsKICAgIHByaXZhdGUg\nc3RhdGljIGZpbmFsIFNldDxTdHJpbmc+IF9pZ25vcmVkQW5ub3MgPSBuZXcg\nSGFzaFNldDxTdHJpbmc+KCk7CgogICAgc3RhdGljIHsKICAgICAgICBfc3Ry\nYXRzLnB1dChCYXNpYy5jbGFzcywgQkFTSUMpOwogICAgICAgIF9zdHJhdHMu\ncHV0KE1hbnlUb09uZS5jbGFzcywgTUFOWV9PTkUpOwogICAgICAgIF9zdHJh\ndHMucHV0KE9uZVRvT25lLmNsYXNzLCBPTkVfT05FKTsKICAgICAgICBfc3Ry\nYXRzLnB1dChFbWJlZGRlZC5jbGFzcywgRU1CRURERUQpOwogICAgICAgIF9z\ndHJhdHMucHV0KEVtYmVkZGVkSWQuY2xhc3MsIEVNQkVEREVEKTsKICAgICAg\nICBfc3RyYXRzLnB1dChPbmVUb01hbnkuY2xhc3MsIE9ORV9NQU5ZKTsKICAg\nICAgICBfc3RyYXRzLnB1dChNYW55VG9NYW55LmNsYXNzLCBNQU5ZX01BTlkp\nOwogICAgICAgIF9zdHJhdHMucHV0KFBlcnNpc3RlbnQuY2xhc3MsIFBFUlMp\nOwogICAgICAgIF9zdHJhdHMucHV0KFBlcnNpc3RlbnRDb2xsZWN0aW9uLmNs\nYXNzLCBQRVJTX0NPTEwpOwogICAgICAgIF9zdHJhdHMucHV0KEVsZW1lbnRD\nb2xsZWN0aW9uLmNsYXNzLCBFTEVNX0NPTEwpOwogICAgICAgIF9zdHJhdHMu\ncHV0KFBlcnNpc3RlbnRNYXAuY2xhc3MsIFBFUlNfTUFQKTsKCiAgICAgICAg\nX2lnbm9yZWRBbm5vcy5hZGQoRGV0YWNoZWRTdGF0ZS5jbGFzcy5nZXROYW1l\nKCkpOwogICAgICAgIF9pZ25vcmVkQW5ub3MuYWRkKFBvc3RMb2FkLmNsYXNz\nLmdldE5hbWUoKSk7CiAgICAgICAgX2lnbm9yZWRBbm5vcy5hZGQoUG9zdFBl\ncnNpc3QuY2xhc3MuZ2V0TmFtZSgpKTsKICAgICAgICBfaWdub3JlZEFubm9z\nLmFkZChQb3N0UmVtb3ZlLmNsYXNzLmdldE5hbWUoKSk7CiAgICAgICAgX2ln\nbm9yZWRBbm5vcy5hZGQoUG9zdFVwZGF0ZS5jbGFzcy5nZXROYW1lKCkpOwog\nICAgICAgIF9pZ25vcmVkQW5ub3MuYWRkKFByZVBlcnNpc3QuY2xhc3MuZ2V0\nTmFtZSgpKTsKICAgICAgICBfaWdub3JlZEFubm9zLmFkZChQcmVSZW1vdmUu\nY2xhc3MuZ2V0TmFtZSgpKTsKICAgICAgICBfaWdub3JlZEFubm9zLmFkZChQ\ncmVVcGRhdGUuY2xhc3MuZ2V0TmFtZSgpKTsKICAgIH0KCgkvKioKICAgICAq\nIFNldCBvZiBJbmNsdXNpb24gRmlsdGVycyBiYXNlZCBvbiBtZW1iZXIgdHlw\nZSwgYWNjZXNzIHR5cGUgb3IgdHJhbnNpZW50CiAgICAgKiBhbm5vdGF0aW9u\ncy4gVXNlZCB0byBkZXRlcm1pbmUgdGhlIHBlcnNpc3RlbnQgZmllbGQvbWV0\naG9kcy4KICAgICAqLwogICAgcHJvdGVjdGVkIEFjY2Vzc0ZpbHRlciBwcm9w\nZXJ0eUFjY2Vzc0ZpbHRlciA9IG5ldyBBY2Nlc3NGaWx0ZXIoUFJPUEVSVFkp\nOwogICAgcHJvdGVjdGVkIEFjY2Vzc0ZpbHRlciBmaWVsZEFjY2Vzc0ZpbHRl\nciA9IG5ldyBBY2Nlc3NGaWx0ZXIoRklFTEQpOwoKICAgIHByb3RlY3RlZCBN\nZW1iZXJGaWx0ZXIgZmllbGRGaWx0ZXIgPSBuZXcgTWVtYmVyRmlsdGVyKEZp\nZWxkLmNsYXNzKTsKICAgIHByb3RlY3RlZCBNZW1iZXJGaWx0ZXIgbWV0aG9k\nRmlsdGVyID0gbmV3IE1lbWJlckZpbHRlcihNZXRob2QuY2xhc3MpOwogICAg\ncHJvdGVjdGVkIFRyYW5zaWVudEZpbHRlciBub25UcmFuc2llbnRGaWx0ZXIg\nPSBuZXcgVHJhbnNpZW50RmlsdGVyKCk7CiAgICBwcm90ZWN0ZWQgQW5ub3Rh\ndGVkRmlsdGVyIGFubm90YXRlZEZpbHRlciA9IG5ldyBBbm5vdGF0ZWRGaWx0\nZXIoKTsKICAgIHByb3RlY3RlZCBHZXR0ZXJGaWx0ZXIgZ2V0dGVyRmlsdGVy\nID0gbmV3IEdldHRlckZpbHRlcigpOwogICAgcHJvdGVjdGVkIFNldHRlckZp\nbHRlciBzZXR0ZXJGaWx0ZXIgPSBuZXcgU2V0dGVyRmlsdGVyKCk7CiAgICBw\ncml2YXRlIEJvb2xlYW4gX2lzQWJzdHJhY3RNYXBwaW5nVW5pRGlyZWN0aW9u\nYWwgPSBudWxsOwogICAgcHJpdmF0ZSBCb29sZWFuIF9pc05vbkRlZmF1bHRN\nYXBwaW5nQWxsb3dlZCA9IG51bGw7CiAgICAKICAgIHB1YmxpYyBQZXJzaXN0\nZW5jZU1ldGFEYXRhRGVmYXVsdHMoKSB7CiAgICAgICAgc2V0Q2FsbGJhY2tN\nb2RlKENBTExCQUNLX1JFVEhST1cgfCBDQUxMQkFDS19ST0xMQkFDSyB8CiAg\nICAgICAgICAgIENBTExCQUNLX0ZBSUxfRkFTVCk7CiAgICAgICAgc2V0RGF0\nYVN0b3JlT2JqZWN0SWRGaWVsZFVud3JhcHBlZCh0cnVlKTsKICAgIH0KCiAg\nICAvKioKICAgICAqIFJldHVybiB0aGUgY29kZSBmb3IgdGhlIHN0cmF0ZWd5\nIG9mIHRoZSBnaXZlbiBtZW1iZXIuIFJldHVybiBudWxsIGlmCiAgICAgKiBu\nbyBzdHJhdGVneS4KICAgICAqLwogICAgcHVibGljIHN0YXRpYyBQZXJzaXN0\nZW5jZVN0cmF0ZWd5IGdldFBlcnNpc3RlbmNlU3RyYXRlZ3kKICAgICAgICAo\nRmllbGRNZXRhRGF0YSBmbWQsIE1lbWJlciBtZW1iZXIpIHsKICAgICAgICBp\nZiAobWVtYmVyID09IG51bGwpCiAgICAgICAgICAgIHJldHVybiBudWxsOwog\nICAgICAgIEFubm90YXRlZEVsZW1lbnQgZWwgPSAoQW5ub3RhdGVkRWxlbWVu\ndCkgbWVtYmVyOwogICAgICAgIGlmICgoQWNjZXNzQ29udHJvbGxlci5kb1By\naXZpbGVnZWQoSjJEb1ByaXZIZWxwZXIKICAgICAgICAgICAgLmlzQW5ub3Rh\ndGlvblByZXNlbnRBY3Rpb24oZWwsIFRyYW5zaWVudC5jbGFzcykpKS5ib29s\nZWFuVmFsdWUoKSkKICAgICAgICAgICAgcmV0dXJuIFRSQU5TSUVOVDsKICAg\nICAgICBpZiAoZm1kICE9IG51bGwKICAgICAgICAgICAgJiYgZm1kLmdldE1h\nbmFnZW1lbnQoKSAhPSBGaWVsZE1ldGFEYXRhLk1BTkFHRV9QRVJTSVNURU5U\nKQogICAgICAgICAgICByZXR1cm4gbnVsbDsKCiAgICAgICAgLy8gbG9vayBm\nb3IgcGVyc2lzdGVuY2Ugc3RyYXRlZ3kgaW4gYW5ub3RhdGlvbiB0YWJsZQog\nICAgICAgIFBlcnNpc3RlbmNlU3RyYXRlZ3kgcHN0cmF0ID0gbnVsbDsKICAg\nICAgICBmb3IgKEFubm90YXRpb24gYW5ubyA6IGVsLmdldERlY2xhcmVkQW5u\nb3RhdGlvbnMoKSkgewogICAgICAgICAgICBpZiAocHN0cmF0ICE9IG51bGwg\nJiYgX3N0cmF0cy5jb250YWluc0tleShhbm5vLmFubm90YXRpb25UeXBlKCkp\nKQogICAgICAgICAgICAgICAgdGhyb3cgbmV3IE1ldGFEYXRhRXhjZXB0aW9u\nKF9sb2MuZ2V0KCJhbHJlYWR5LXBlcnMiLCBtZW1iZXIpKTsKICAgICAgICAg\nICAgaWYgKHBzdHJhdCA9PSBudWxsKQogICAgICAgICAgICAgICAgcHN0cmF0\nID0gX3N0cmF0cy5nZXQoYW5uby5hbm5vdGF0aW9uVHlwZSgpKTsKICAgICAg\nICB9CiAgICAgICAgaWYgKHBzdHJhdCAhPSBudWxsKQogICAgICAgICAgICBy\nZXR1cm4gcHN0cmF0OwoKICAgICAgICBDbGFzcyB0eXBlOwogICAgICAgIGlu\ndCBjb2RlOwogICAgICAgIGlmIChmbWQgIT0gbnVsbCkgewogICAgICAgICAg\nICB0eXBlID0gZm1kLmdldFR5cGUoKTsKICAgICAgICAgICAgY29kZSA9IGZt\nZC5nZXRUeXBlQ29kZSgpOwogICAgICAgIH0gZWxzZSBpZiAobWVtYmVyIGlu\nc3RhbmNlb2YgRmllbGQpIHsKICAgICAgICAgICAgdHlwZSA9ICgoRmllbGQp\nIG1lbWJlcikuZ2V0VHlwZSgpOwogICAgICAgICAgICBjb2RlID0gSmF2YVR5\ncGVzLmdldFR5cGVDb2RlKHR5cGUpOwogICAgICAgIH0gZWxzZSB7CiAgICAg\nICAgICAgIHR5cGUgPSAoKE1ldGhvZCkgbWVtYmVyKS5nZXRSZXR1cm5UeXBl\nKCk7CiAgICAgICAgICAgIGNvZGUgPSBKYXZhVHlwZXMuZ2V0VHlwZUNvZGUo\ndHlwZSk7CiAgICAgICAgfQoKICAgICAgICBzd2l0Y2ggKGNvZGUpIHsKICAg\nICAgICAgICAgY2FzZSBKYXZhVHlwZXMuQVJSQVk6CiAgICAgICAgICAgICAg\nICBpZiAodHlwZSA9PSBieXRlW10uY2xhc3MKICAgICAgICAgICAgICAgICAg\nICB8fCB0eXBlID09IGNoYXJbXS5jbGFzcwogICAgICAgICAgICAgICAgICAg\nIHx8IHR5cGUgPT0gQnl0ZVtdLmNsYXNzCiAgICAgICAgICAgICAgICAgICAg\nfHwgdHlwZSA9PSBDaGFyYWN0ZXJbXS5jbGFzcykKICAgICAgICAgICAgICAg\nICAgICByZXR1cm4gQkFTSUM7CiAgICAgICAgICAgICAgICBicmVhazsKICAg\nICAgICAgICAgY2FzZSBKYXZhVHlwZXMuQk9PTEVBTjoKICAgICAgICAgICAg\nY2FzZSBKYXZhVHlwZXMuQk9PTEVBTl9PQko6CiAgICAgICAgICAgIGNhc2Ug\nSmF2YVR5cGVzLkJZVEU6CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLkJZ\nVEVfT0JKOgogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5DSEFSOgogICAg\nICAgICAgICBjYXNlIEphdmFUeXBlcy5DSEFSX09CSjoKICAgICAgICAgICAg\nY2FzZSBKYXZhVHlwZXMuRE9VQkxFOgogICAgICAgICAgICBjYXNlIEphdmFU\neXBlcy5ET1VCTEVfT0JKOgogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5G\nTE9BVDoKICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuRkxPQVRfT0JKOgog\nICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5JTlQ6CiAgICAgICAgICAgIGNh\nc2UgSmF2YVR5cGVzLklOVF9PQko6CiAgICAgICAgICAgIGNhc2UgSmF2YVR5\ncGVzLkxPTkc6CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLkxPTkdfT0JK\nOgogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5TSE9SVDoKICAgICAgICAg\nICAgY2FzZSBKYXZhVHlwZXMuU0hPUlRfT0JKOgogICAgICAgICAgICBjYXNl\nIEphdmFUeXBlcy5TVFJJTkc6CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVz\nLkJJR0RFQ0lNQUw6CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLkJJR0lO\nVEVHRVI6CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLkRBVEU6CiAgICAg\nICAgICAgICAgICByZXR1cm4gQkFTSUM7CiAgICAgICAgICAgIGNhc2UgSmF2\nYVR5cGVzLk9CSkVDVDoKICAgICAgICAgICAgICAgIGlmIChFbnVtLmNsYXNz\nLmlzQXNzaWduYWJsZUZyb20odHlwZSkpCiAgICAgICAgICAgICAgICAgICAg\ncmV0dXJuIEJBU0lDOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAg\nfQoKICAgICAgICAvLyMjIyBFSkIzOiB3aGF0IGlmIGRlZmluZWQgaW4gWE1M\nPwogICAgICAgIGlmICgoQWNjZXNzQ29udHJvbGxlci5kb1ByaXZpbGVnZWQo\nSjJEb1ByaXZIZWxwZXIKICAgICAgICAgICAgLmlzQW5ub3RhdGlvblByZXNl\nbnRBY3Rpb24odHlwZSwgRW1iZWRkYWJsZS5jbGFzcykpKS5ib29sZWFuVmFs\ndWUoKSkKICAgICAgICAgICAgcmV0dXJuIEVNQkVEREVEOwogICAgICAgIGlm\nIChTZXJpYWxpemFibGUuY2xhc3MuaXNBc3NpZ25hYmxlRnJvbSh0eXBlKSkK\nICAgICAgICAgICAgcmV0dXJuIEJBU0lDOwogICAgICAgIHJldHVybiBudWxs\nOwogICAgfQogICAgCiAgICAvKioKICAgICAqIEF1dG8tY29uZmlndXJhdGlv\nbiBtZXRob2QgZm9yIHRoZSBkZWZhdWx0IGFjY2VzcyB0eXBlIG9mIGJhc2Ug\nY2xhc3NlcyAKICAgICAqIHdpdGggQUNDRVNTX1VOS05PV04KICAgICAqLwog\nICAgcHVibGljIHZvaWQgc2V0RGVmYXVsdEFjY2Vzc1R5cGUoU3RyaW5nIHR5\ncGUpIHsKICAgICAgICBpZiAoIlBST1BFUlRZIi5lcXVhbHModHlwZS50b1Vw\ncGVyQ2FzZSgpKSkKICAgICAgICAgICAgc2V0RGVmYXVsdEFjY2Vzc1R5cGUo\nQWNjZXNzQ29kZS5QUk9QRVJUWSk7CiAgICAgICAgZWxzZSBpZiAoIkZJRUxE\nIi5lcXVhbHModHlwZS50b1VwcGVyQ2FzZSgpKSkKICAgICAgICAgICAgc2V0\nRGVmYXVsdEFjY2Vzc1R5cGUoQWNjZXNzQ29kZS5GSUVMRCk7CiAgICAgICAg\nZWxzZQogICAgICAgIAl0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0\naW9uKF9sb2MuZ2V0KCJhY2Nlc3MtaW52YWxpZCIsIAogICAgICAgIAkgICAg\ndHlwZSkudG9TdHJpbmcoKSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBQb3B1\nbGF0ZXMgdGhlIGdpdmVuIGNsYXNzIG1ldGFkYXRhLiBUaGUgYWNjZXNzIHN0\neWxlIGRldGVybWluZXMgd2hpY2gKICAgICAqIGZpZWxkIGFuZC9vciBnZXR0\nZXIgbWV0aG9kIHdpbGwgY29udHJpYnV0ZSBhcyB0aGUgcGVyc2lzdGVudCBw\ncm9wZXJ0eQogICAgICogb2YgdGhlIGdpdmVuIGNsYXNzLiBJZiB0aGUgZ2l2\nZW4gYWNjZXNzIGlzIHVua25vd24sIHRoZW4gdGhlIGFjY2VzcwogICAgICog\ndHlwZSBpcyB0byBiZSBkZXRlcm1pbmVkIGF0IGZpcnN0LiAKICAgICAqIAog\nICAgICogQHNlZSAjZGV0ZXJtaW5lQWNjZXNzVHlwZShDbGFzc01ldGFEYXRh\nKQogICAgICovCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyB2b2lkIHBvcHVs\nYXRlKENsYXNzTWV0YURhdGEgbWV0YSwgaW50IGFjY2VzcykgewogICAgCWlm\nIChBY2Nlc3NDb2RlLmlzVW5rbm93bihhY2Nlc3MpKSB7CiAgICAJCWFjY2Vz\ncyA9IGRldGVybWluZUFjY2Vzc1R5cGUobWV0YSk7CiAgICAJfQogICAgCWlm\nIChBY2Nlc3NDb2RlLmlzVW5rbm93bihhY2Nlc3MpKSB7CiAgICAJCWVycm9y\nKG1ldGEsIF9sb2MuZ2V0KCJhY2Nlc3MtdW5rbm93biIsIG1ldGEpKTsKICAg\nIAl9CiAgICAgICAgc3VwZXIucG9wdWxhdGUobWV0YSwgYWNjZXNzKTsKICAg\nICAgICBtZXRhLnNldERldGFjaGFibGUodHJ1ZSk7CiAgICAgICAgLy8gZG8g\nbm90IGNhbGwgZ2V0KkZpZWxkcyBhcyBpdCB3aWxsIGxvY2sgZG93biB0aGUg\nZmllbGRzLgogICAgfQoKICAgIEBPdmVycmlkZQogICAgcHJvdGVjdGVkIHZv\naWQgcG9wdWxhdGUoRmllbGRNZXRhRGF0YSBmbWQpIHsKICAgICAgICBzZXRD\nYXNjYWRlTm9uZShmbWQpOwogICAgICAgIHNldENhc2NhZGVOb25lKGZtZC5n\nZXRLZXkoKSk7CiAgICAgICAgc2V0Q2FzY2FkZU5vbmUoZm1kLmdldEVsZW1l\nbnQoKSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBUdXJucyBvZmYgYXV0byBj\nYXNjYWRpbmcgb2YgcGVyc2lzdCwgcmVmcmVzaCwgYXR0YWNoLCBkZXRhY2gu\nCiAgICAgKi8KICAgIHN0YXRpYyB2b2lkIHNldENhc2NhZGVOb25lKFZhbHVl\nTWV0YURhdGEgdm1kKSB7CiAgICAgICAgdm1kLnNldENhc2NhZGVQZXJzaXN0\nKFZhbHVlTWV0YURhdGEuQ0FTQ0FERV9OT05FKTsKICAgICAgICB2bWQuc2V0\nQ2FzY2FkZVJlZnJlc2goVmFsdWVNZXRhRGF0YS5DQVNDQURFX05PTkUpOwog\nICAgICAgIHZtZC5zZXRDYXNjYWRlQXR0YWNoKFZhbHVlTWV0YURhdGEuQ0FT\nQ0FERV9OT05FKTsKICAgICAgICB2bWQuc2V0Q2FzY2FkZURldGFjaChWYWx1\nZU1ldGFEYXRhLkNBU0NBREVfTk9ORSk7CiAgICB9CiAgICAKICAgIENsYXNz\nTWV0YURhdGEgZ2V0Q2FjaGVkU3VwZXJjbGFzc01ldGFEYXRhKENsYXNzTWV0\nYURhdGEgbWV0YSkgewogICAgCWlmIChtZXRhID09IG51bGwpCiAgICAJCXJl\ndHVybiBudWxsOwogICAgCUNsYXNzPD8+IGNscyA9IG1ldGEuZ2V0RGVzY3Jp\nYmVkVHlwZSgpOwogICAgCUNsYXNzPD8+IHN1cCA9IGNscy5nZXRTdXBlcmNs\nYXNzKCk7CiAgICAJaWYgKHN1cCA9PSBudWxsIHx8ICJqYXZhLmxhbmcuT2Jq\nZWN0Ii5lcXVhbHMoCiAgICAJICAgIHN1cC5nZXROYW1lKCkpKQogICAgCQly\nZXR1cm4gbnVsbDsKICAgIAlNZXRhRGF0YVJlcG9zaXRvcnkgcmVwb3MgPSBt\nZXRhLmdldFJlcG9zaXRvcnkoKTsKICAgIAlDbGFzc01ldGFEYXRhIHN1cE1l\ndGEgPSByZXBvcy5nZXRDYWNoZWRNZXRhRGF0YShzdXApOwogICAgCWlmIChz\ndXBNZXRhID09IG51bGwpCiAgICAJCXN1cE1ldGEgPSByZXBvcy5nZXRNZXRh\nRGF0YShzdXAsIG51bGwsIGZhbHNlKTsKICAgIAlyZXR1cm4gc3VwTWV0YTsK\nICAgIH0KCiAgICAvKioKICAgICAqIFJlY3Vyc2l2ZSBoZWxwZXIgdG8gZGV0\nZXJtaW5lIGFjY2VzcyB0eXBlIGJhc2VkIG9uIGFubm90YXRpb24gcGxhY2Vt\nZW50CiAgICAgKiBvbiBtZW1iZXJzIGZvciB0aGUgZ2l2ZW4gY2xhc3Mgd2l0\naG91dCBhbiBleHBsaWNpdCBhY2Nlc3MgYW5ub3RhdGlvbi4KICAgICAqIAog\nICAgICogQHJldHVybiBtdXN0IHJldHVybiBhIG5vdC11bmtub3duIGFjY2Vz\ncyBjb2RlIAogICAgICovCiAgICBwcml2YXRlIGludCBkZXRlcm1pbmVBY2Nl\nc3NUeXBlKENsYXNzTWV0YURhdGEgbWV0YSkgewogICAgCWlmIChtZXRhID09\nIG51bGwpCiAgICAJCXJldHVybiBBY2Nlc3NDb2RlLlVOS05PV047CiAgICAg\nICAgaWYgKG1ldGEuZ2V0RGVzY3JpYmVkVHlwZSgpLmlzSW50ZXJmYWNlKCkp\nIC8vIG1hbmFnZWQgaW50ZXJmYWNlcyAKICAgICAgICAJcmV0dXJuIEFjY2Vz\nc0NvZGUuUFJPUEVSVFk7CiAgICAJaWYgKCFBY2Nlc3NDb2RlLmlzVW5rbm93\nbihtZXRhKSkKICAgIAkJcmV0dXJuIG1ldGEuZ2V0QWNjZXNzVHlwZSgpOwog\nICAgCWludCBhY2Nlc3MgPSBkZXRlcm1pbmVFeHBsaWNpdEFjY2Vzc1R5cGUo\nbWV0YS5nZXREZXNjcmliZWRUeXBlKCkpOwogICAgCWlmICghQWNjZXNzQ29k\nZS5pc1Vua25vd24oYWNjZXNzKSkKICAgIAkJcmV0dXJuIGFjY2VzczsKICAg\nIAlhY2Nlc3MgPSBkZXRlcm1pbmVJbXBsaWNpdEFjY2Vzc1R5cGUobWV0YS5n\nZXREZXNjcmliZWRUeXBlKCksCiAgICAJICAgICAgICAgICAgbWV0YS5nZXRS\nZXBvc2l0b3J5KCkuZ2V0Q29uZmlndXJhdGlvbigpKTsKICAgIAlpZiAoIUFj\nY2Vzc0NvZGUuaXNVbmtub3duKGFjY2VzcykpCiAgICAJCXJldHVybiBhY2Nl\nc3M7CiAgICAJCiAgICAJQ2xhc3NNZXRhRGF0YSBzdXAgPSBnZXRDYWNoZWRT\ndXBlcmNsYXNzTWV0YURhdGEobWV0YSk7CiAgICAJQ2xhc3NNZXRhRGF0YSB0\nbXBTdXAgPSBzdXA7CiAgICAJd2hpbGUgKHRtcFN1cCAhPSBudWxsICYmIHRt\ncFN1cC5pc0V4cGxpY2l0QWNjZXNzKCkpIHsKICAgICAgICAgICAgdG1wU3Vw\nID0gZ2V0Q2FjaGVkU3VwZXJjbGFzc01ldGFEYXRhKHRtcFN1cCk7CiAgICAg\nICAgICAgIGlmICh0bXBTdXAgIT0gbnVsbCkgewogICAgICAgICAgICAgICAg\nc3VwID0gdG1wU3VwOwogICAgICAgICAgICB9ICAgIAkgICAgCiAgICAJfQog\nICAgCWlmIChzdXAgIT0gbnVsbCAmJiAhQWNjZXNzQ29kZS5pc1Vua25vd24o\nc3VwKSkKICAgIAkJcmV0dXJuIHN1cC5nZXRBY2Nlc3NUeXBlKCk7CiAgICAJ\nCiAgICAgICAgcmV0dXJuIGdldERlZmF1bHRBY2Nlc3NUeXBlKCk7CiAgICB9\nCiAgICAKICAgIC8qKgogICAgICogRGV0ZXJtaW5lcyB0aGUgYWNjZXNzIHR5\ncGUgZm9yIHRoZSBnaXZlbiBjbGFzcyBieSBwbGFjZW1lbnQgb2YgCiAgICAg\nKiBhbm5vdGF0aW9ucyBvbiBmaWVsZCBvciBnZXR0ZXIgbWV0aG9kLiBEb2Vz\nIG5vdCBjb25zdWx0IHRoZQogICAgICogc3VwZXIgY2xhc3MuCiAgICAgKiAK\nICAgICAqIEFubm90YXRpb24gY2FuIGJlIHBsYWNlZCBvbiBlaXRoZXIgZmll\nbGRzIG9yIGdldHRlcnMgYnV0IG5vdCBvbiBib3RoLgogICAgICogSWYgbm8g\nZmllbGQgb3IgZ2V0dGVyIGlzIGFubm90YXRlZCB0aGVuIFVOS05PV04gYWNj\nZXNzIGNvZGUgaXMgcmV0dXJuZWQuCiAgICAgKi8KICAgIHByaXZhdGUgaW50\nIGRldGVybWluZUltcGxpY2l0QWNjZXNzVHlwZShDbGFzczw/PiBjbHMsIE9w\nZW5KUEFDb25maWd1cmF0aW9uCiAgICAgICAgY29uZikgewogICAgCWlmIChj\nbHMuaXNJbnRlcmZhY2UoKSkgLy8gTWFuYWdlZCBpbnRlcmZhY2VzCiAgICAJ\nCXJldHVybiBBY2Nlc3NDb2RlLlBST1BFUlRZOwogICAgICAgIEZpZWxkW10g\nYWxsRmllbGRzID0gQWNjZXNzQ29udHJvbGxlci5kb1ByaXZpbGVnZWQoSjJE\nb1ByaXZIZWxwZXIuCiAgICAgICAgICAgICAgICBnZXREZWNsYXJlZEZpZWxk\nc0FjdGlvbihjbHMpKTsKCQlNZXRob2RbXSBtZXRob2RzID0gQWNjZXNzQ29u\ndHJvbGxlci5kb1ByaXZpbGVnZWQoCgkJCQlKMkRvUHJpdkhlbHBlci5nZXRE\nZWNsYXJlZE1ldGhvZHNBY3Rpb24oY2xzKSk7CiAgICAgICAgTGlzdDxGaWVs\nZD4gZmllbGRzID0gZmlsdGVyKGFsbEZpZWxkcywgbm9uVHJhbnNpZW50Rmls\ndGVyKTsKICAgICAgICAvKgogICAgICAgICAqIE9wZW5KUEEgMS54IHBlcm1p\ndHRlZCBwcml2YXRlIHByb3BlcnRpZXMgdG8gYmUgcGVyc2lzdGVudC4gIFRo\naXMgaXMKICAgICAgICAgKiBjb250cmFyeSB0byB0aGUgSlBBIDEuMCBzcGVj\naWZpY2F0aW9uLCB3aGljaCBzdGF0ZXMgdGhhdCBwZXJzaXN0ZW50CiAgICAg\nICAgICogcHJvcGVydGllcyBtdXN0IGJlIHB1YmxpYyBvciBwcm90ZWN0ZWQu\nIE9wZW5KUEEgMi4wKyB3aWxsIGFkaGVyZQogICAgICAgICAqIHRvIHRoZSBz\ncGVjaWZpY2F0aW9uIGJ5IGRlZmF1bHQsIGJ1dCBwcm92aWRlcyBhIGNvbXBh\ndGliaWxpdHkKICAgICAgICAgKiBvcHRpb24gdG8gcHJvdmlkZSBwcmUtMi4w\nIGJlaGF2aW9yLgogICAgICAgICAqLwogICAgICAgIGdldHRlckZpbHRlci5z\nZXRJbmNsdWRlUHJpdmF0ZSgKICAgICAgICAgICAgY29uZi5nZXRDb21wYXRp\nYmlsaXR5SW5zdGFuY2UoKS5nZXRQcml2YXRlUGVyc2lzdGVudFByb3BlcnRp\nZXMoKSk7CiAgICAgICAgTGlzdDxNZXRob2Q+IGdldHRlcnMgPSBmaWx0ZXIo\nbWV0aG9kcywgZ2V0dGVyRmlsdGVyLCAKICAgICAgICAJCW5vblRyYW5zaWVu\ndEZpbHRlcik7CiAgICAgICAgaWYgKGZpZWxkcy5pc0VtcHR5KCkgJiYgZ2V0\ndGVycy5pc0VtcHR5KCkpCiAgICAgICAgCXJldHVybiBBY2Nlc3NDb2RlLkVN\nUFRZOwogICAgICAgIAogICAgICAgIGZpZWxkcyA9IGZpbHRlcihmaWVsZHMs\nIGFubm90YXRlZEZpbHRlcik7CiAgICAgICAgZ2V0dGVycyA9IGZpbHRlcihn\nZXR0ZXJzLCBhbm5vdGF0ZWRGaWx0ZXIpOwogICAgICAgIAoJCUxpc3Q8TWV0\naG9kPiBzZXR0ZXJzID0gZmlsdGVyKG1ldGhvZHMsIHNldHRlckZpbHRlcik7\nCiAgICAgICAgZ2V0dGVycyA9ICBtYXRjaEdldHRlckFuZFNldHRlcihnZXR0\nZXJzLCBzZXR0ZXJzKTsKICAgICAgICAKICAgICAgICBib29sZWFuIG1peGVk\nID0gIWZpZWxkcy5pc0VtcHR5KCkgJiYgIWdldHRlcnMuaXNFbXB0eSgpOwog\nICAgICAgIGlmIChtaXhlZCkKICAgICAgICAJdGhyb3cgbmV3IFVzZXJFeGNl\ncHRpb24oX2xvYy5nZXQoImFjY2Vzcy1taXhlZCIsIAogICAgICAgIAkJY2xz\nLCB0b0ZpZWxkTmFtZXMoZmllbGRzKSwgdG9NZXRob2ROYW1lcyhnZXR0ZXJz\nKSkpOwogICAgICAgIGlmICghZmllbGRzLmlzRW1wdHkoKSkgewogICAgICAg\nIAlyZXR1cm4gQWNjZXNzQ29kZS5GSUVMRDsKICAgICAgICB9IAogICAgICAg\nIGlmICghZ2V0dGVycy5pc0VtcHR5KCkpIHsKICAgICAgICAJcmV0dXJuIEFj\nY2Vzc0NvZGUuUFJPUEVSVFk7CiAgICAgICAgfSAKICAgICAgICByZXR1cm4g\nQWNjZXNzQ29kZS5VTktOT1dOOwogICAgfQogICAgCiAgICAvKioKICAgICAq\nIEV4cGxpY2l0IGFjY2VzcyB0eXBlLCBpZiBhbnksIGlzIGdlbmVyYWxseSBk\nZXRlY3RlZCBieSB0aGUgcGFyc2VyLiBUaGlzCiAgICAgKiBpcyBvbmx5IHVz\nZWQgZm9yIG1ldGFkYXRhIG9mIGFuIGVtYmVkZGFibGUgdHlwZSB3aGljaCBp\ncyBlbmNvdW50ZXJlZAogICAgICogYXMgYSBmaWVsZCBkdXJpbmcgc29tZSBv\ndGhlciBvd25pbmcgZW50aXR5LgogICAgICogCiAgICAgKiBAc2VlIFZhbHVl\nTWV0YURhdGEjYWRkRW1iZWRkZWRNZXRhRGF0YSgpCiAgICAgKi8KICAgIHBy\naXZhdGUgaW50IGRldGVybWluZUV4cGxpY2l0QWNjZXNzVHlwZShDbGFzczw/\nPiBjbHMpIHsKICAgICAgICBBY2Nlc3MgYWNjZXNzID0gY2xzLmdldEFubm90\nYXRpb24oQWNjZXNzLmNsYXNzKTsKICAgICAgICByZXR1cm4gYWNjZXNzID09\nIG51bGwgPyBBY2Nlc3NDb2RlLlVOS05PV04gOiAoKGFjY2Vzcy52YWx1ZSgp\nID09IAogICAgICAgICAgICBBY2Nlc3NUeXBlLkZJRUxEID8gQWNjZXNzQ29k\nZS5GSUVMRCA6IEFjY2Vzc0NvZGUuUFJPUEVSVFkpIHwKICAgICAgICAgICAg\nQWNjZXNzQ29kZS5FWFBMSUNJVCk7CiAgICB9CiAgICAKICAgIC8qKgogICAg\nICogTWF0Y2hlcyB0aGUgZ2l2ZW4gZ2V0dGVycyB3aXRoIHRoZSBnaXZlbiBz\nZXR0ZXJzLiBSZW1vdmVzIHRoZSBnZXR0ZXJzCiAgICAgKiB0aGF0IGRvIG5v\ndCBoYXZlIGEgY29ycmVzcG9uZGluZyBzZXR0ZXIuCiAgICAgKi8KICAgIHBy\naXZhdGUgTGlzdDxNZXRob2Q+IG1hdGNoR2V0dGVyQW5kU2V0dGVyKExpc3Q8\nTWV0aG9kPiBnZXR0ZXJzLCAgCiAgICAJCUxpc3Q8TWV0aG9kPiBzZXR0ZXJz\nKSB7CiAgICAgICAgQ29sbGVjdGlvbjxNZXRob2Q+IHVubWF0Y2hlZCA9ICBu\nZXcgQXJyYXlMaXN0PE1ldGhvZD4oKTsKICAgICAgIAogICAgICAgIGZvciAo\nTWV0aG9kIGdldHRlciA6IGdldHRlcnMpIHsKICAgICAgICAgICAgU3RyaW5n\nIGdldHRlck5hbWUgPSBnZXR0ZXIuZ2V0TmFtZSgpOwogICAgICAgICAgICBD\nbGFzczw/PiBnZXR0ZXJSZXR1cm5UeXBlID0gZ2V0dGVyLmdldFJldHVyblR5\ncGUoKTsKICAgICAgICAgICAgU3RyaW5nIGV4cGVjdGVkU2V0dGVyTmFtZSA9\nICJzZXQiICsgZ2V0dGVyTmFtZS5zdWJzdHJpbmcoCiAgICAgICAgICAgICAg\nICAoaXNCb29sZWFuR2V0dGVyKGdldHRlcikgPyAiaXMiIDogImdldCIpLmxl\nbmd0aCgpKTsKICAgICAgICAgICAgYm9vbGVhbiBtYXRjaGVkID0gZmFsc2U7\nCiAgICAgICAgICAgIGZvciAoTWV0aG9kIHNldHRlciA6IHNldHRlcnMpIHsK\nICAgICAgICAgICAgICAgIENsYXNzPD8+IHNldHRlckFyZ1R5cGUgPSBzZXR0\nZXIuZ2V0UGFyYW1ldGVyVHlwZXMoKVswXTsKICAgICAgICAgICAgICAgIFN0\ncmluZyBhY3R1YWxTZXR0ZXJOYW1lID0gc2V0dGVyLmdldE5hbWUoKTsKICAg\nICAgICAgICAgICAgIG1hdGNoZWQgPSBhY3R1YWxTZXR0ZXJOYW1lLmVxdWFs\ncyhleHBlY3RlZFNldHRlck5hbWUpCiAgICAgICAgICAgICAgICAgICAgJiYg\nc2V0dGVyQXJnVHlwZSA9PSBnZXR0ZXJSZXR1cm5UeXBlOwogICAgICAgICAg\nICAgICAgaWYgKG1hdGNoZWQpCiAgICAgICAgICAgICAgICAgICAgYnJlYWs7\nCiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKCFtYXRjaGVkKSB7CiAg\nICAgICAgICAgICAgICB1bm1hdGNoZWQuYWRkKGdldHRlcik7CiAgICAgICAg\nICAgIH0KCiAgICAgICAgfQogICAgICAgIGdldHRlcnMucmVtb3ZlQWxsKHVu\nbWF0Y2hlZCk7CiAgICAgICAgcmV0dXJuIGdldHRlcnM7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBHZXRzIHRoZSBmaWVsZHMgdGhhdCBhcmUgcG9zc2libGUg\nY2FuZGlkYXRlIGZvciBiZWluZyBwZXJzaXN0ZWQuIFRoZSAgCiAgICAgKiBy\nZXN1bHQgZGVwZW5kcyBvbiB0aGUgY3VycmVudCBhY2Nlc3Mgc3R5bGUgb2Yg\ndGhlIGdpdmVuIGNsYXNzLiAKICAgICAqLwogICAgTGlzdDxGaWVsZD4gZ2V0\nUGVyc2lzdGVudEZpZWxkcyhDbGFzc01ldGFEYXRhIG1ldGEpIHsKICAgIAli\nb29sZWFuIGV4cGxpY2l0ID0gbWV0YS5pc0V4cGxpY2l0QWNjZXNzKCk7CiAg\nICAJYm9vbGVhbiB1bmtub3duICA9IEFjY2Vzc0NvZGUuaXNVbmtub3duKG1l\ndGEpOwogICAgCWJvb2xlYW4gaXNGaWVsZCAgPSBBY2Nlc3NDb2RlLmlzRmll\nbGQobWV0YSk7CiAgICAJCiAgICAJaWYgKGV4cGxpY2l0IHx8IHVua25vd24g\nfHwgaXNGaWVsZCkgewogICAgCQlGaWVsZFtdIGZpZWxkcyA9IEFjY2Vzc0Nv\nbnRyb2xsZXIuZG9Qcml2aWxlZ2VkKEoyRG9Qcml2SGVscGVyLgogICAgICAg\nICAgICAgICAgZ2V0RGVjbGFyZWRGaWVsZHNBY3Rpb24obWV0YS5nZXREZXNj\ncmliZWRUeXBlKCkpKTsKICAgIAkJCiAgICAgICAgCXJldHVybiBmaWx0ZXIo\nZmllbGRzLCBmaWVsZEZpbHRlciwgbm9uVHJhbnNpZW50RmlsdGVyLCAKICAg\nICAgICAJCXVua25vd24gfHwgaXNGaWVsZCAgPyBudWxsIDogYW5ub3RhdGVk\nRmlsdGVyLCAKICAgICAgICAJICAgIGV4cGxpY2l0ID8gKGlzRmllbGQgPyBu\ndWxsIDogZmllbGRBY2Nlc3NGaWx0ZXIpIDogbnVsbCk7CiAgICAJfSAKICAg\nIAlyZXR1cm4gQ29sbGVjdGlvbnMuRU1QVFlfTElTVDsKICAgIH0KICAgIAog\nICAgLyoqCiAgICAgKiBHZXRzIHRoZSBtZXRob2RzIHRoYXQgYXJlIHBvc3Np\nYmxlIGNhbmRpZGF0ZSBmb3IgYmVpbmcgcGVyc2lzdGVkLiBUaGUgIAogICAg\nICogcmVzdWx0IGRlcGVuZHMgb24gdGhlIGN1cnJlbnQgYWNjZXNzIHN0eWxl\nIG9mIHRoZSBnaXZlbiBjbGFzcy4gCiAgICAgKi8KICAgIExpc3Q8TWV0aG9k\nPiBnZXRQZXJzaXN0ZW50TWV0aG9kcyhDbGFzc01ldGFEYXRhIG1ldGEpIHsK\nICAgIAlib29sZWFuIGV4cGxpY2l0ID0gbWV0YS5pc0V4cGxpY2l0QWNjZXNz\nKCk7CiAgICAJYm9vbGVhbiB1bmtub3duICA9IEFjY2Vzc0NvZGUuaXNVbmtu\nb3duKG1ldGEuZ2V0QWNjZXNzVHlwZSgpKTsKICAgIAlib29sZWFuIGlzUHJv\ncGVydHkgID0gQWNjZXNzQ29kZS5pc1Byb3BlcnR5KG1ldGEuZ2V0QWNjZXNz\nVHlwZSgpKTsKICAgIAkKICAgIAlpZiAoZXhwbGljaXQgfHwgdW5rbm93biB8\nfCBpc1Byb3BlcnR5KSB7CiAgICAJCU1ldGhvZFtdIHB1YmxpY01ldGhvZHMg\nPSBBY2Nlc3NDb250cm9sbGVyLmRvUHJpdmlsZWdlZCgKICAgICAgICAgICAg\nICBKMkRvUHJpdkhlbHBlci5nZXREZWNsYXJlZE1ldGhvZHNBY3Rpb24obWV0\nYS5nZXREZXNjcmliZWRUeXBlKCkpKTsKICAgICAgICAKICAgIAkJTGlzdDxN\nZXRob2Q+IGdldHRlcnMgPSBmaWx0ZXIocHVibGljTWV0aG9kcywgbWV0aG9k\nRmlsdGVyLCAKICAgICAgICAgICAgICAgIGdldHRlckZpbHRlciwgbm9uVHJh\nbnNpZW50RmlsdGVyLCAKICAgICAgICAJCXVua25vd24gfHwgaXNQcm9wZXJ0\neSA/IG51bGwgOiBhbm5vdGF0ZWRGaWx0ZXIsIAogICAgICAgICAgICAgICAg\nZXhwbGljaXQgPyAoaXNQcm9wZXJ0eSA/IG51bGwgOiBwcm9wZXJ0eUFjY2Vz\nc0ZpbHRlcikgOiBudWxsKTsKICAgIAkJTGlzdDxNZXRob2Q+IHNldHRlcnMg\nPSBmaWx0ZXIocHVibGljTWV0aG9kcywgc2V0dGVyRmlsdGVyKTsKICAgIAkJ\ncmV0dXJuIGdldHRlcnMgPSBtYXRjaEdldHRlckFuZFNldHRlcihnZXR0ZXJz\nLCBzZXR0ZXJzKTsKICAgIAl9CiAgICAgICAgCiAgICAJcmV0dXJuIENvbGxl\nY3Rpb25zLkVNUFRZX0xJU1Q7CiAgICB9CiAgICAgCiAgICAvKioKICAgICAq\nIEdldHMgdGhlIG1lbWJlcnMgdGhhdCBhcmUgYmFja2luZyBtZW1iZXJzIGZv\nciBhdHRyaWJ1dGVzIGJlaW5nIHBlcnNpc3RlZC4KICAgICAqIFVubGlrZSB7\nQGxpbmtwbGFpbiAjZ2V0UGVyc2lzdGVudEZpZWxkcyhDbGFzc01ldGFEYXRh\nKX0gYW5kIAogICAgICoge0BsaW5rcGxhaW4gI2dldFBlcnNpc3RlbnRNZXRo\nb2RzKENsYXNzTWV0YURhdGEpfSB3aGljaCByZXR1cm5zIAogICAgICogPGVt\nPnBvc3NpYmxlPC9lbT4gY2FuZGlkYXRlcywgdGhlIHJlc3VsdCBvZiB0aGlz\nIG1ldGhvZCBpcyBkZWZpbml0ZS4KICAgICAqIAogICAgICogU2lkZS1lZmZl\nY3Qgb2YgdGhpcyBtZXRob2QgaXMgaWYgdGhlIGdpdmVuIGNsYXNzIG1ldGFk\nYXRhIGhhcyAKICAgICAqIG5vIGFjY2VzcyB0eXBlIHNldCwgdGhpcyBtZXRo\nb2Qgd2lsbCBzZXQgaXQuCiAgICAgKi8KICAgIEBPdmVycmlkZQogICAgcHVi\nbGljIExpc3Q8TWVtYmVyPiBnZXRQZXJzaXN0ZW50TWVtYmVycyhDbGFzc01l\ndGFEYXRhIG1ldGEpIHsKICAgIAlMaXN0PE1lbWJlcj4gbWVtYmVycyA9IG5l\ndyBBcnJheUxpc3Q8TWVtYmVyPigpOwogICAgCUxpc3Q8RmllbGQ+IGZpZWxk\ncyAgID0gZ2V0UGVyc2lzdGVudEZpZWxkcyhtZXRhKTsKICAgIAlMaXN0PE1l\ndGhvZD4gZ2V0dGVycyA9IGdldFBlcnNpc3RlbnRNZXRob2RzKG1ldGEpOwog\nICAgCQogICAgCWJvb2xlYW4gaXNNaXhlZCA9ICFmaWVsZHMuaXNFbXB0eSgp\nICYmICFnZXR0ZXJzLmlzRW1wdHkoKTsKICAgIAlib29sZWFuIGlzRW1wdHkg\nPSBmaWVsZHMuaXNFbXB0eSgpICYmIGdldHRlcnMuaXNFbXB0eSgpOwoKICAg\nIAlib29sZWFuIGV4cGxpY2l0ICAgID0gbWV0YS5pc0V4cGxpY2l0QWNjZXNz\nKCk7CiAgICAJYm9vbGVhbiB1bmtub3duICAgICA9IEFjY2Vzc0NvZGUuaXNV\nbmtub3duKG1ldGEuZ2V0QWNjZXNzVHlwZSgpKTsKICAgIAkKICAgIAlpZiAo\naXNFbXB0eSkgewogICAgCQl3YXJuKG1ldGEsIF9sb2MuZ2V0KCJhY2Nlc3Mt\nZW1wdHkiLCBtZXRhKSk7CiAgICAJCXJldHVybiBDb2xsZWN0aW9ucy5FTVBU\nWV9MSVNUOwogICAgCX0KICAgIAlpZiAoZXhwbGljaXQpIHsKICAgIAkJaWYg\nKGlzTWl4ZWQpIHsKICAgIAkJCWFzc2VydE5vRHVwbGljYXRlKGZpZWxkcywg\nZ2V0dGVycyk7CiAgICAgICAgICAgICAgICBtZXRhLnNldEFjY2Vzc1R5cGUo\nQWNjZXNzQ29kZS5NSVhFRCB8IG1ldGEuZ2V0QWNjZXNzVHlwZSgpKTsKICAg\nIAkJCW1lbWJlcnMuYWRkQWxsKGZpZWxkcyk7CiAgICAJCQltZW1iZXJzLmFk\nZEFsbChnZXR0ZXJzKTsKICAgIAkJfSBlbHNlIHsKICAgIAkJCW1lbWJlcnMu\nYWRkQWxsKGZpZWxkcy5pc0VtcHR5KCkgPyBnZXR0ZXJzIDogZmllbGRzKTsK\nICAgIAkJfQogICAgCX0gZWxzZSB7CiAgICAJCWlmIChpc01peGVkKQogICAg\nICAgICAgICAgICAgZXJyb3IobWV0YSwgX2xvYy5nZXQoImFjY2Vzcy1taXhl\nZCIsIG1ldGEsIGZpZWxkcywgZ2V0dGVycykpOwogICAgCQlpZiAoZmllbGRz\nLmlzRW1wdHkoKSkgewogICAgCQkJbWV0YS5zZXRBY2Nlc3NUeXBlKEFjY2Vz\nc0NvZGUuUFJPUEVSVFkpOwogICAgCQkJbWVtYmVycy5hZGRBbGwoZ2V0dGVy\ncyk7CiAgICAJCX0gZWxzZSB7CiAgICAJCQltZXRhLnNldEFjY2Vzc1R5cGUo\nQWNjZXNzQ29kZS5GSUVMRCk7CiAgICAJCQltZW1iZXJzLmFkZEFsbChmaWVs\nZHMpOwogICAgCQl9CiAgICAJfQogICAgCXJldHVybiBtZW1iZXJzOwogICAg\nfQogICAgCiAgICB2b2lkIGFzc2VydE5vRHVwbGljYXRlKExpc3Q8RmllbGQ+\nIGZpZWxkcywgTGlzdDxNZXRob2Q+IGdldHRlcnMpIHsKICAgIAkKICAgIH0K\nICAgIAogICAgdm9pZCBlcnJvcihDbGFzc01ldGFEYXRhIG1ldGEsIExvY2Fs\naXplci5NZXNzYWdlIG1lc3NhZ2UpIHsKICAgIAlMb2cgbG9nID0gbWV0YS5n\nZXRSZXBvc2l0b3J5KCkuZ2V0Q29uZmlndXJhdGlvbigpCiAgICAJCS5nZXRM\nb2coT3BlbkpQQUNvbmZpZ3VyYXRpb24uTE9HX1JVTlRJTUUpOwogICAgCWxv\nZy5lcnJvcihtZXNzYWdlLnRvU3RyaW5nKCkpOwogICAgCXRocm93IG5ldyBV\nc2VyRXhjZXB0aW9uKG1lc3NhZ2UudG9TdHJpbmcoKSk7CiAgICB9CiAgICAK\nICAgIHZvaWQgd2FybihDbGFzc01ldGFEYXRhIG1ldGEsIExvY2FsaXplci5N\nZXNzYWdlIG1lc3NhZ2UpIHsKICAgIAlMb2cgbG9nID0gbWV0YS5nZXRSZXBv\nc2l0b3J5KCkuZ2V0Q29uZmlndXJhdGlvbigpCgkJLmdldExvZyhPcGVuSlBB\nQ29uZmlndXJhdGlvbi5MT0dfUlVOVElNRSk7CiAgICAJbG9nLndhcm4obWVz\nc2FnZS50b1N0cmluZygpKTsKICAgIH0KICAgIAogICAgQE92ZXJyaWRlCiAg\nICBwcm90ZWN0ZWQgTGlzdDxTdHJpbmc+IGdldEZpZWxkQWNjZXNzTmFtZXMo\nQ2xhc3NNZXRhRGF0YSBtZXRhKSB7CiAgICAJcmV0dXJuIHRvTmFtZXMoZ2V0\nUGVyc2lzdGVudEZpZWxkcyhtZXRhKSk7CiAgICB9CgogICAgQE92ZXJyaWRl\nCiAgICBwcm90ZWN0ZWQgTGlzdDxTdHJpbmc+IGdldFByb3BlcnR5QWNjZXNz\nTmFtZXMoQ2xhc3NNZXRhRGF0YSBtZXRhKSB7CiAgICAJcmV0dXJuIHRvTmFt\nZXMoZ2V0UGVyc2lzdGVudE1ldGhvZHMobWV0YSkpOwogICAgfQoKICAgIHBy\nb3RlY3RlZCBib29sZWFuIGlzRGVmYXVsdFBlcnNpc3RlbnQoQ2xhc3NNZXRh\nRGF0YSBtZXRhLCBNZW1iZXIgbWVtYmVyLAogICAgICAgIFN0cmluZyBuYW1l\nKSB7CiAgICAgICAgaW50IG1vZHMgPSBtZW1iZXIuZ2V0TW9kaWZpZXJzKCk7\nCiAgICAgICAgaWYgKE1vZGlmaWVyLmlzVHJhbnNpZW50KG1vZHMpKQogICAg\nICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgaW50IGFjY2VzcyA9IG1l\ndGEuZ2V0QWNjZXNzVHlwZSgpOyAgICAgICAgCiAgICAgICAgCiAgICAgICAg\naWYgKG1lbWJlciBpbnN0YW5jZW9mIEZpZWxkKSB7CiAgICAgICAgICAgIC8v\nIElmIG1peGVkIG9yIHVua25vd24sIGRlZmF1bHQgcHJvcGVydHkgYWNjZXNz\nLCBrZWVwIGV4cGxpY2l0IAogICAgICAgICAgICAvLyBmaWVsZCBtZW1iZXJz\nCiAgICAgICAgICAgIGlmIChBY2Nlc3NDb2RlLmlzUHJvcGVydHkoYWNjZXNz\nKSkgewogICAgICAgICAgICAgICAgaWYgKCFpc0Fubm90YXRlZEFjY2Vzcyht\nZW1iZXIsIEFjY2Vzc1R5cGUuRklFTEQpKQogICAgICAgICAgICAgICAgICAg\nIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgfQogICAgICAgIH0gICAgICAg\nIAogICAgICAgIGVsc2UgaWYgKG1lbWJlciBpbnN0YW5jZW9mIE1ldGhvZCkg\newogICAgICAgICAgICAvLyBJZiBtaXhlZCBvciB1bmtub3duLCBmaWVsZCBk\nZWZhdWx0IGFjY2Vzcywga2VlcCBleHBsaWNpdCBwcm9wZXJ0eQogICAgICAg\nICAgICAvLyBtZW1iZXJzCiAgICAgICAgICAgIGlmIChBY2Nlc3NDb2RlLmlz\nRmllbGQoYWNjZXNzKSkgewogICAgICAgICAgICAgICAgaWYgKCFpc0Fubm90\nYXRlZEFjY2VzcyhtZW1iZXIsIEFjY2Vzc1R5cGUuUFJPUEVSVFkpKQogICAg\nICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgfSAg\nICAgICAgICAgIAogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAg\nLy8gY2hlY2sgZm9yIHNldHRlcnMgZm9yIG1ldGhvZHMKICAgICAgICAgICAg\nICAgIE1ldGhvZCBzZXR0ZXIgPSAoTWV0aG9kKSBBY2Nlc3NDb250cm9sbGVy\nLmRvUHJpdmlsZWdlZCgKICAgICAgICAgICAgICAgICAgICBKMkRvUHJpdkhl\nbHBlci5nZXREZWNsYXJlZE1ldGhvZEFjdGlvbigKICAgICAgICAgICAgICAg\nICAgICAgICAgbWV0YS5nZXREZXNjcmliZWRUeXBlKCksICJzZXQiICsKICAg\nICAgICAgICAgICAgICAgICAgICAgU3RyaW5nVXRpbHMuY2FwaXRhbGl6ZShu\nYW1lKSwgbmV3IENsYXNzW10geyAKICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICgoTWV0aG9kKSBtZW1iZXIpLmdldFJldHVyblR5cGUoKSB9KSk7CiAg\nICAgICAgICAgICAgICBpZiAoc2V0dGVyID09IG51bGwgJiYgIWlzQW5ub3Rh\ndGVkVHJhbnNpZW50KG1lbWJlcikpIHsKICAgICAgICAgICAgICAgICAgICBs\nb2dOb1NldHRlcihtZXRhLCBuYW1lLCBudWxsKTsKICAgICAgICAgICAgICAg\nICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgICAgICB9CiAgICAgICAg\nICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgICAgICAv\nLyBlLmcuLCBOb1N1Y2hNZXRob2RFeGNlcHRpb24KICAgICAgICAgICAgICAg\nIGlmICghaXNBbm5vdGF0ZWRUcmFuc2llbnQobWVtYmVyKSkKICAgICAgICAg\nICAgICAgICAgICBsb2dOb1NldHRlcihtZXRhLCBuYW1lLCBlKTsKICAgICAg\nICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgfQogICAgICAg\nIH0KCiAgICAgICAgUGVyc2lzdGVuY2VTdHJhdGVneSBzdHJhdCA9IGdldFBl\ncnNpc3RlbmNlU3RyYXRlZ3kobnVsbCwgbWVtYmVyKTsKICAgICAgICBpZiAo\nc3RyYXQgPT0gbnVsbCB8fCBzdHJhdCA9PSBQZXJzaXN0ZW5jZVN0cmF0ZWd5\nLlRSQU5TSUVOVCkKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAg\nIHJldHVybiB0cnVlOwoJfQoKICAgIHByaXZhdGUgYm9vbGVhbiBpc0Fubm90\nYXRlZFRyYW5zaWVudChNZW1iZXIgbWVtYmVyKSB7CiAgICAgICAgcmV0dXJu\nIG1lbWJlciBpbnN0YW5jZW9mIEFubm90YXRlZEVsZW1lbnQKICAgICAgICAg\nICAgJiYgKEFjY2Vzc0NvbnRyb2xsZXIuZG9Qcml2aWxlZ2VkKEoyRG9Qcml2\nSGVscGVyCiAgICAgICAgICAgICAgICAuaXNBbm5vdGF0aW9uUHJlc2VudEFj\ndGlvbigoKEFubm90YXRlZEVsZW1lbnQpIG1lbWJlciksCiAgICAgICAgICAg\nICAgICAgICAgVHJhbnNpZW50LmNsYXNzKSkpLmJvb2xlYW5WYWx1ZSgpOwog\nICAgfQoKICAgIC8qKgogICAgICogTWF5IGJlIHVzZWQgdG8gZGV0ZXJtaW5l\nIGlmIG1lbWJlciBpcyBhbm5vdGF0ZWQgd2l0aCB0aGUgc3BlY2lmaWVkIAog\nICAgICogYWNjZXNzIHR5cGUuCiAgICAgKiBAcGFyYW0gbWVtYmVyIGNsYXNz\nIG1lbWJlcgogICAgICogQHBhcmFtIHR5cGUgZXhwZWN0ZWQgYWNjZXNzIHR5\ncGUKICAgICAqIEByZXR1cm4gdHJ1ZSBpZiBhY2Nlc3MgaXMgc3BlY2lmaWVk\nIG9uIG1lbWJlciBhbmQgdGhhdCBhY2Nlc3MKICAgICAqICAgICAgICAgdHlw\nZSBtYXRjaGVzIHRoZSBleHBlY3RlZCB0eXBlCiAgICAgKi8KICAgIHByaXZh\ndGUgYm9vbGVhbiBpc0Fubm90YXRlZEFjY2VzcyhNZW1iZXIgbWVtYmVyLCBB\nY2Nlc3NUeXBlIHR5cGUpIHsKICAgIAlpZiAobWVtYmVyID09IG51bGwpCiAg\nICAJCXJldHVybiBmYWxzZTsKICAgICAgICBBY2Nlc3MgYW5ubyA9IAogICAg\nICAgICAgICBBY2Nlc3NDb250cm9sbGVyLmRvUHJpdmlsZWdlZChKMkRvUHJp\ndkhlbHBlcgogICAgICAgICAgICAgICAgLmdldEFubm90YXRpb25BY3Rpb24o\nKEFubm90YXRlZEVsZW1lbnQpbWVtYmVyLCAKICAgICAgICAgICAgICAgIEFj\nY2Vzcy5jbGFzcykpOwogICAgICAgIHJldHVybiBhbm5vICE9IG51bGwgJiYg\nYW5uby52YWx1ZSgpID09IHR5cGU7CiAgICB9ICAgIAoKICAgIHByaXZhdGUg\nYm9vbGVhbiBpc0Fubm90YXRlZChNZW1iZXIgbWVtYmVyKSB7CiAgICAJcmV0\ndXJuIG1lbWJlciAhPSBudWxsICYmIG1lbWJlciBpbnN0YW5jZW9mIEFubm90\nYXRlZEVsZW1lbnQKICAgIAkgICAgJiYgYW5ub3RhdGVkRmlsdGVyLmluY2x1\nZGVzKChBbm5vdGF0ZWRFbGVtZW50KW1lbWJlcik7CiAgICB9CgogICAgcHJp\ndmF0ZSBib29sZWFuIGlzTm90VHJhbnNpZW50KE1lbWJlciBtZW1iZXIpIHsK\nICAgICAgICByZXR1cm4gbWVtYmVyICE9IG51bGwgJiYgbWVtYmVyIGluc3Rh\nbmNlb2YgQW5ub3RhdGVkRWxlbWVudAogICAgICAgICAgICAmJiBub25UcmFu\nc2llbnRGaWx0ZXIuaW5jbHVkZXMoKEFubm90YXRlZEVsZW1lbnQpbWVtYmVy\nKTsKICAgIH0KCiAgICAvKioKICAgICAqIEdldHMgZWl0aGVyIHRoZSBpbnN0\nYW5jZSBmaWVsZCBvciB0aGUgZ2V0dGVyIG1ldGhvZCBkZXBlbmRpbmcgdXBv\nbiB0aGUgCiAgICAgKiBhY2Nlc3Mgc3R5bGUgb2YgdGhlIGdpdmVuIG1ldGEt\nZGF0YS4KICAgICAqLwogICAgcHVibGljIE1lbWJlciBnZXRNZW1iZXJCeVBy\nb3BlcnR5KENsYXNzTWV0YURhdGEgbWV0YSwgU3RyaW5nIHByb3BlcnR5LCAK\nICAgIAlpbnQgYWNjZXNzLCBib29sZWFuIGFwcGx5RGVmYXVsdFJ1bGUpIHsK\nICAgIAlDbGFzczw/PiBjbHMgPSBtZXRhLmdldERlc2NyaWJlZFR5cGUoKTsK\nICAgICAgICBGaWVsZCBmaWVsZCA9IFJlZmxlY3Rpb24uZmluZEZpZWxkKGNs\ncywgcHJvcGVydHksIGZhbHNlKTs7CiAgICAgICAgTWV0aG9kIGdldHRlciA9\nIFJlZmxlY3Rpb24uZmluZEdldHRlcihjbHMsIHByb3BlcnR5LCBmYWxzZSk7\nCiAgICAgICAgTWV0aG9kIHNldHRlciA9IFJlZmxlY3Rpb24uZmluZFNldHRl\ncihjbHMsIHByb3BlcnR5LCBmYWxzZSk7CiAgICAgICAgaW50IGFjY2Vzc0Nv\nZGUgPSBBY2Nlc3NDb2RlLmlzVW5rbm93bihhY2Nlc3MpID8gbWV0YS5nZXRB\nY2Nlc3NUeXBlKCkgOgogICAgICAgIAlhY2Nlc3M7CiAgICAgICAgaWYgKGZp\nZWxkID09IG51bGwgJiYgZ2V0dGVyID09IG51bGwpCiAgICAgICAgCWVycm9y\nKG1ldGEsIF9sb2MuZ2V0KCJhY2Nlc3Mtbm8tcHJvcGVydHkiLCBjbHMsIHBy\nb3BlcnR5KSk7CiAgICAJaWYgKChpc05vdFRyYW5zaWVudChnZXR0ZXIpICYm\nIGlzQW5ub3RhdGVkKGdldHRlcikpICYmIAogICAgCSAgICAgaXNOb3RUcmFu\nc2llbnQoZmllbGQpICYmIGlzQW5ub3RhdGVkKGZpZWxkKSkKICAgIAkJdGhy\nb3cgbmV3IElsbGVnYWxTdGF0ZUV4Y2VwdGlvbihfbG9jLmdldCgiYWNjZXNz\nLWR1cGxpY2F0ZSIsIAogICAgCQkJZmllbGQsIGdldHRlcikudG9TdHJpbmco\nKSk7CiAgICAJCiAgICAgICAgaWYgKEFjY2Vzc0NvZGUuaXNGaWVsZChhY2Nl\nc3NDb2RlKSkgewogICAgICAgICAgIGlmIChpc0Fubm90YXRlZEFjY2Vzcyhn\nZXR0ZXIsIEFjY2Vzc1R5cGUuUFJPUEVSVFkpKSB7CiAgICAgICAgCSAgIG1l\ndGEuc2V0QWNjZXNzVHlwZShBY2Nlc3NDb2RlLk1JWEVEIHwgbWV0YS5nZXRB\nY2Nlc3NUeXBlKCkpOwogICAgICAgICAgICAgICByZXR1cm4gZ2V0dGVyOwog\nICAgICAgICAgIH0KICAgICAgICAgICByZXR1cm4gZmllbGQgPT0gbnVsbCA/\nIGdldHRlciA6IGZpZWxkOyAKICAgICAgICB9IGVsc2UgaWYgKEFjY2Vzc0Nv\nZGUuaXNQcm9wZXJ0eShhY2Nlc3NDb2RlKSkgewogICAgICAgICAgICBpZiAo\naXNBbm5vdGF0ZWRBY2Nlc3MoZmllbGQsIEFjY2Vzc1R5cGUuRklFTEQpKSB7\nCiAgICAgICAgIAkgICBtZXRhLnNldEFjY2Vzc1R5cGUoQWNjZXNzQ29kZS5N\nSVhFRCB8IG1ldGEuZ2V0QWNjZXNzVHlwZSgpKTsKICAgICAgICAgICAgICAg\ncmV0dXJuIGZpZWxkOwogICAgICAgICAgICB9ICAgICAgICAgICAgCiAgICAg\nICAgICAgIHJldHVybiBnZXR0ZXIgPT0gbnVsbCA/IGZpZWxkIDogZ2V0dGVy\nOwogICAgICAgIH0gZWxzZSBpZiAoQWNjZXNzQ29kZS5pc1Vua25vd24oYWNj\nZXNzQ29kZSkpIHsKICAgICAgICAJaWYgKGlzQW5ub3RhdGVkKGZpZWxkKSkg\newogICAgICAgIAkJbWV0YS5zZXRBY2Nlc3NUeXBlKEFjY2Vzc0NvZGUuRklF\nTEQpOwogICAgICAgIAkJcmV0dXJuIGZpZWxkOwogICAgICAgIAl9IGVsc2Ug\naWYgKGlzQW5ub3RhdGVkKGdldHRlcikpIHsKICAgICAgICAJCW1ldGEuc2V0\nQWNjZXNzVHlwZShBY2Nlc3NDb2RlLlBST1BFUlRZKTsKICAgICAgICAJCXJl\ndHVybiBnZXR0ZXI7CiAgICAgICAgCX0gZWxzZSB7CiAgICAgICAgCQl3YXJu\nKG1ldGEsIF9sb2MuZ2V0KCJhY2Nlc3Mtbm9uZSIsIG1ldGEsIHByb3BlcnR5\nKSk7CiAgICAgICAgCQl0aHJvdyBuZXcgSWxsZWdhbFN0YXRlRXhjZXB0aW9u\nKAogICAgICAgICAgICAgICAgICAgIF9sb2MuZ2V0KCJhY2Nlc3Mtbm9uZSIs\nIG1ldGEsIHByb3BlcnR5KS50b1N0cmluZygpKTsKICAgICAgICAJfQogICAg\nICAgIH0gZWxzZSB7CiAgICAgICAgCXRocm93IG5ldyBJbnRlcm5hbEV4Y2Vw\ndGlvbihtZXRhICsgIiAiICsgCiAgICAgICAgCQlBY2Nlc3NDb2RlLnRvQ2xh\nc3NTdHJpbmcobWV0YS5nZXRBY2Nlc3NUeXBlKCkpKTsKICAgICAgICB9CiAg\nICB9CiAgICAKICAgIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09\nPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQog\nICAgLy8gIFNlbGVjdGlvbiBGaWx0ZXJzIHNlbGVjdCBzcGVjaWZpYyBlbGVt\nZW50cyBmcm9tIGEgY29sbGVjdGlvbi4KICAgIC8vICBVc2VkIHRvIGRldGVy\nbWluZSB0aGUgcGVyc2lzdGVudCBtZW1iZXJzIG9mIGEgZ2l2ZW4gY2xhc3Mu\nCiAgICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09\nPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KICAgIAogICAg\nLyoqCiAgICAgKiBJbmNsdXNpdmUgZWxlbWVudCBmaWx0ZXJpbmcgcHJlZGlj\nYXRlLgogICAgICoKICAgICAqLwogICAgcHJpdmF0ZSBzdGF0aWMgaW50ZXJm\nYWNlIEluY2x1c2l2ZUZpbHRlcjxUIGV4dGVuZHMgQW5ub3RhdGVkRWxlbWVu\ndD4gewogICAgICAgIC8qKgogICAgICAgICAqIFJldHVybiB0cnVlIHRvIGlu\nY2x1ZGUgdGhlIGdpdmVuIGVsZW1lbnQuCiAgICAgICAgICovCiAgICAgICAg\nYm9vbGVhbiBpbmNsdWRlcyhUIGUpOwogICAgfQoKICAgIC8qKgogICAgICog\nRmlsdGVyIHRoZSBnaXZlbiBjb2xsZWN0aW9uIHdpdGggdGhlIGNvbmp1bmN0\naW9uIG9mIGZpbHRlcnMuIFRoZSBnaXZlbgogICAgICogY29sbGVjdGlvbiBp\ndHNlbGYgaXMgbm90IG1vZGlmaWVkLgogICAgICovCiAgICA8VCBleHRlbmRz\nIEFubm90YXRlZEVsZW1lbnQ+IExpc3Q8VD4gZmlsdGVyKFRbXSBhcnJheSwg\nCiAgICAJSW5jbHVzaXZlRmlsdGVyLi4uIGZpbHRlcnMpIHsKICAgICAgICBM\naXN0PFQ+IHJlc3VsdCA9IG5ldyBBcnJheUxpc3Q8VD4oKTsKICAgICAgICBm\nb3IgKFQgZSA6IGFycmF5KSB7CiAgICAgICAgICAgIGJvb2xlYW4gaW5jbHVk\nZSA9IHRydWU7CiAgICAgICAgICAgIGZvciAoSW5jbHVzaXZlRmlsdGVyIGYg\nOiBmaWx0ZXJzKSB7CiAgICAgICAgICAgICAgICBpZiAoZiAhPSBudWxsICYm\nICFmLmluY2x1ZGVzKGUpKSB7CiAgICAgICAgICAgICAgICAgICAgaW5jbHVk\nZSA9IGZhbHNlOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAg\nICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmIChpbmNs\ndWRlKQogICAgICAgICAgICAgICAgcmVzdWx0LmFkZChlKTsKICAgICAgICB9\nCiAgICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0KICAgIAogICAgPFQgZXh0\nZW5kcyBBbm5vdGF0ZWRFbGVtZW50PiBMaXN0PFQ+IGZpbHRlcihMaXN0PFQ+\nIGxpc3QsIAogICAgICAgIAlJbmNsdXNpdmVGaWx0ZXIuLi4gZmlsdGVycykg\newogICAgICAgIExpc3Q8VD4gcmVzdWx0ID0gbmV3IEFycmF5TGlzdDxUPigp\nOwogICAgICAgIGZvciAoVCBlIDogbGlzdCkgewogICAgICAgICAgICBib29s\nZWFuIGluY2x1ZGUgPSB0cnVlOwogICAgICAgICAgICBmb3IgKEluY2x1c2l2\nZUZpbHRlciBmIDogZmlsdGVycykgewogICAgICAgICAgICAgICAgaWYgKGYg\nIT0gbnVsbCAmJiAhZi5pbmNsdWRlcyhlKSkgewogICAgICAgICAgICAgICAg\nICAgIGluY2x1ZGUgPSBmYWxzZTsKICAgICAgICAgICAgICAgICAgICBicmVh\nazsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAg\nICBpZiAoaW5jbHVkZSkKICAgICAgICAgICAgICAgIHJlc3VsdC5hZGQoZSk7\nCiAgICAgICAgfQogICAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBTZWxlY3RzIGdldHRlciBtZXRob2QuIEEgZ2V0dGVyIG1l\ndGhvZCBuYW1lIHN0YXJ0cyB3aXRoICdnZXQnLCByZXR1cm5zIGEKICAgICAq\nIG5vbi12b2lkIHR5cGUgYW5kIGhhcyBubyBhcmd1bWVudC4gT3Igc3RhcnRz\nIHdpdGggJ2lzJywgcmV0dXJucyBhIGJvb2xlYW4KICAgICAqIGFuZCBoYXMg\nbm8gYXJndW1lbnQuCiAgICAgKiAKICAgICAqLwogICAgc3RhdGljIGNsYXNz\nIEdldHRlckZpbHRlciBpbXBsZW1lbnRzIEluY2x1c2l2ZUZpbHRlcjxNZXRo\nb2Q+IHsKICAgICAgICAKICAgICAgICBwcml2YXRlIGJvb2xlYW4gaW5jbHVk\nZVByaXZhdGU7ICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAKICAg\nICAgICBwdWJsaWMgYm9vbGVhbiBpbmNsdWRlcyhNZXRob2QgbWV0aG9kKSB7\nCiAgICAgICAgICAgIHJldHVybiBpc0dldHRlcihtZXRob2QsIGlzSW5jbHVk\nZVByaXZhdGUoKSk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgdm9pZCBz\nZXRJbmNsdWRlUHJpdmF0ZShib29sZWFuIGluY2x1ZGVQcml2YXRlKSB7CiAg\nICAgICAgICAgIHRoaXMuaW5jbHVkZVByaXZhdGUgPSBpbmNsdWRlUHJpdmF0\nZTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBib29sZWFuIGlzSW5jbHVk\nZVByaXZhdGUoKSB7CiAgICAgICAgICAgIHJldHVybiBpbmNsdWRlUHJpdmF0\nZTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBTZWxlY3RzIHNl\ndHRlciBtZXRob2QuIEEgc2V0dGVyIG1ldGhvZCBuYW1lIHN0YXJ0cyB3aXRo\nICdzZXQnLCByZXR1cm5zIGEKICAgICAqIHZvaWQgYW5kIGhhcyBzaW5nbGUg\nYXJndW1lbnQuCiAgICAgKiAKICAgICAqLwogICAgc3RhdGljIGNsYXNzIFNl\ndHRlckZpbHRlciBpbXBsZW1lbnRzIEluY2x1c2l2ZUZpbHRlcjxNZXRob2Q+\nIHsKICAgICAgICBwdWJsaWMgYm9vbGVhbiBpbmNsdWRlcyhNZXRob2QgbWV0\naG9kKSB7CiAgICAgICAgICAgIHJldHVybiBpc1NldHRlcihtZXRob2QpOwog\nICAgICAgIH0KICAgICAgICAvKioKICAgICAgICAgKiBBZmZpcm1zIGlmIHRo\nZSBnaXZlbiBtZXRob2QgbWF0Y2hlcyB0aGUgZm9sbG93aW5nIHNpZ25hdHVy\nZQogICAgICAgICAqIDxjb2RlPiBwdWJsaWMgdm9pZCBzZXRYWFgoVCB0KSA8\nL2NvZGU+CiAgICAgICAgICovCiAgICAgICAgcHVibGljIHN0YXRpYyBib29s\nZWFuIGlzU2V0dGVyKE1ldGhvZCBtZXRob2QpIHsKICAgICAgICAJU3RyaW5n\nIG1ldGhvZE5hbWUgPSBtZXRob2QuZ2V0TmFtZSgpOwogICAgICAgIAlyZXR1\ncm4gc3RhcnRzV2l0aChtZXRob2ROYW1lLCAic2V0IikgCiAgICAgICAgCSAg\nICAmJiBtZXRob2QuZ2V0UGFyYW1ldGVyVHlwZXMoKS5sZW5ndGggPT0gMQog\nICAgICAgIAkgICAgJiYgbWV0aG9kLmdldFJldHVyblR5cGUoKSA9PSB2b2lk\nLmNsYXNzOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIFNlbGVj\ndHMgZWxlbWVudHMgd2hpY2ggaXMgYW5ub3RhdGVkIHdpdGggQEFjY2VzcyBh\nbm5vdGF0aW9uIGFuZCB0aGF0IAogICAgICogYW5ub3RhdGlvbiBoYXMgdGhl\nIGdpdmVuIEFjY2Vzc1R5cGUgdmFsdWUuCiAgICAgKiAKICAgICAqLwogICAg\nc3RhdGljIGNsYXNzIEFjY2Vzc0ZpbHRlciBpbXBsZW1lbnRzIEluY2x1c2l2\nZUZpbHRlcjxBbm5vdGF0ZWRFbGVtZW50PiB7CiAgICAgICAgZmluYWwgQWNj\nZXNzVHlwZSB0YXJnZXQ7CgogICAgICAgIHB1YmxpYyBBY2Nlc3NGaWx0ZXIo\nQWNjZXNzVHlwZSB0YXJnZXQpIHsKICAgICAgICAgICAgdGhpcy50YXJnZXQg\nPSB0YXJnZXQ7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgYm9vbGVhbiBp\nbmNsdWRlcyhBbm5vdGF0ZWRFbGVtZW50IG9iaikgewogICAgICAgIAlBY2Nl\nc3MgYWNjZXNzID0gb2JqLmdldEFubm90YXRpb24oQWNjZXNzLmNsYXNzKTsK\nICAgICAgICAJcmV0dXJuIGFjY2VzcyAhPSBudWxsICYmIGFjY2Vzcy52YWx1\nZSgpLmVxdWFscyh0YXJnZXQpOwogICAgICAgIH0KICAgIH0KICAgIAogICAg\nLyoqCiAgICAgKiBTZWxlY3RzIGVsZW1lbnRzIHdoaWNoIGlzIGFubm90YXRl\nZCB3aXRoIEBBY2Nlc3MgYW5ub3RhdGlvbiBhbmQgdGhhdCAKICAgICAqIGFu\nbm90YXRpb24gaGFzIHRoZSBnaXZlbiBBY2Nlc3NUeXBlIHZhbHVlLgogICAg\nICogCiAgICAgKi8KICAgIHN0YXRpYyBjbGFzcyBNZW1iZXJGaWx0ZXIgaW1w\nbGVtZW50cyBJbmNsdXNpdmVGaWx0ZXI8QW5ub3RhdGVkRWxlbWVudD4gewog\nICAgICAgIGZpbmFsIENsYXNzPD8+IHRhcmdldDsKCiAgICAgICAgcHVibGlj\nIE1lbWJlckZpbHRlcihDbGFzczw/PiB0YXJnZXQpIHsKICAgICAgICAgICAg\ndGhpcy50YXJnZXQgPSB0YXJnZXQ7CiAgICAgICAgfQoKICAgICAgICBwdWJs\naWMgYm9vbGVhbiBpbmNsdWRlcyhBbm5vdGF0ZWRFbGVtZW50IG9iaikgewog\nICAgICAgIAlpbnQgbW9kcyA9ICgoTWVtYmVyKW9iaikuZ2V0TW9kaWZpZXJz\nKCk7CiAgICAgICAgCQogICAgICAgICAgICByZXR1cm4gb2JqLmdldENsYXNz\nKCkgPT0gdGFyZ2V0ICYmIAogICAgICAgICAgICAgICAgICEoTW9kaWZpZXIu\naXNTdGF0aWMobW9kcykgfHwgTW9kaWZpZXIuaXNGaW5hbChtb2RzKSAKICAg\nICAgICAgICAgICAgIHx8IE1vZGlmaWVyLmlzVHJhbnNpZW50KG1vZHMpIHx8\nIE1vZGlmaWVyLmlzTmF0aXZlKG1vZHMpKTsKICAgICAgICAgICAgICAgICAg\nCiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogU2VsZWN0cyBhbGwg\nbm9uLXRyYW5zaWVudCBlbGVtZW50LgogICAgICovCiAgICBzdGF0aWMgY2xh\nc3MgVHJhbnNpZW50RmlsdGVyIGltcGxlbWVudHMgSW5jbHVzaXZlRmlsdGVy\nPEFubm90YXRlZEVsZW1lbnQ+IHsKICAgICAgICBwdWJsaWMgYm9vbGVhbiBp\nbmNsdWRlcyhBbm5vdGF0ZWRFbGVtZW50IG9iaikgewogICAgICAgIAlyZXR1\ncm4gIW9iai5pc0Fubm90YXRpb25QcmVzZW50KFRyYW5zaWVudC5jbGFzcykg\nJiYgCiAgICAgICAgCSAgICAgICAhTW9kaWZpZXIuaXNUcmFuc2llbnQoKChN\nZW1iZXIpb2JqKS5nZXRNb2RpZmllcnMoKSk7CiAgICAgICAgfQogICAgfQog\nICAgCiAgICAvKioKICAgICAqIFNlbGVjdHMgYWxsIGVsZW1lbnQgYW5ub3Rh\ndGVkIHdpdGggPGNvZGU+amF2YXgucGVyc2lzdGVuY2UuKjwvY29kZT4gb3Ig\nCiAgICAgKiA8Y29kZT5vcmcuYXBhY2hlLm9wZW5qcGEuKjwvY29kZT4gYW5u\nb3RhdGlvbiBleGNlcHQgdGhlIGFubm90YXRpb25zCiAgICAgKiBtYXJrZWQg\ndG8gYmUgaWdub3JlZC4KICAgICAqLwogICAgc3RhdGljIGNsYXNzIEFubm90\nYXRlZEZpbHRlciBpbXBsZW1lbnRzIEluY2x1c2l2ZUZpbHRlcjxBbm5vdGF0\nZWRFbGVtZW50PiB7CiAgICAgICAgcHVibGljIGJvb2xlYW4gaW5jbHVkZXMo\nQW5ub3RhdGVkRWxlbWVudCBvYmopIHsKICAgICAgICAgICAgQW5ub3RhdGlv\nbltdIGFubm9zID0gQWNjZXNzQ29udHJvbGxlci5kb1ByaXZpbGVnZWQoSjJE\nb1ByaXZIZWxwZXIKICAgICAgICAgICAgICAgICAgICAuZ2V0QW5ub3RhdGlv\nbnNBY3Rpb24ob2JqKSk7CiAgICAgICAgCWZvciAoQW5ub3RhdGlvbiBhbm5v\nIDogYW5ub3MpIHsKICAgICAgICAJCVN0cmluZyBuYW1lID0gYW5uby5hbm5v\ndGF0aW9uVHlwZSgpLmdldE5hbWUoKTsKICAgICAgICAgICAgICAgIGlmICgo\nbmFtZS5zdGFydHNXaXRoKCJqYXZheC5wZXJzaXN0ZW5jZS4iKQogICAgICAg\nICAgICAgICAgICB8fCBuYW1lLnN0YXJ0c1dpdGgoIm9yZy5hcGFjaGUub3Bl\nbmpwYS5wZXJzaXN0ZW5jZS4iKSkKICAgICAgICAgICAgICAgICAgJiYgIV9p\nZ25vcmVkQW5ub3MuY29udGFpbnMobmFtZSkpCiAgICAgICAgICAgICAgICAJ\ncmV0dXJuIHRydWU7CiAgICAgICAgCX0KICAgICAgICAJcmV0dXJuIGZhbHNl\nOwogICAgICAgIH0KICAgIH0KICAgIAogICAgcHJpdmF0ZSB2b2lkIGxvZ05v\nU2V0dGVyKENsYXNzTWV0YURhdGEgbWV0YSwgU3RyaW5nIG5hbWUsIEV4Y2Vw\ndGlvbiBlKSB7CiAgICAgICAgTG9nIGxvZyA9IG1ldGEuZ2V0UmVwb3NpdG9y\neSgpLmdldENvbmZpZ3VyYXRpb24oKQogICAgICAgICAgICAuZ2V0TG9nKE9w\nZW5KUEFDb25maWd1cmF0aW9uLkxPR19NRVRBREFUQSk7CiAgICAgICAgaWYg\nKGxvZy5pc1dhcm5FbmFibGVkKCkpCiAgICAgICAgICAgIGxvZy53YXJuKF9s\nb2MuZ2V0KCJuby1zZXR0ZXItZm9yLWdldHRlciIsIG5hbWUsCiAgICAgICAg\nICAgICAgICBtZXRhLmdldERlc2NyaWJlZFR5cGUoKS5nZXROYW1lKCkpKTsK\nICAgICAgICBlbHNlIGlmIChsb2cuaXNUcmFjZUVuYWJsZWQoKSkKICAgICAg\nICAgICAgLy8gbG9nIHRoZSBleGNlcHRpb24sIGlmIGFueSwgaWYgd2UncmUg\naW4gdHJhY2UtbGV2ZWwgZGVidWdnaW5nCiAgICAgICAgICAgIGxvZy53YXJu\nKF9sb2MuZ2V0KCJuby1zZXR0ZXItZm9yLWdldHRlciIsIG5hbWUsCiAgICAg\nICAgICAgICAgICBtZXRhLmdldERlc2NyaWJlZFR5cGUoKS5nZXROYW1lKCkp\nLCBlKTsKICAgIH0KICAgIAogICAgcHJpdmF0ZSBMb2cgZ2V0TG9nKENsYXNz\nTWV0YURhdGEgbWV0YSkgewogICAgICAgIHJldHVybiBtZXRhLmdldFJlcG9z\naXRvcnkoKS5nZXRDb25maWd1cmF0aW9uKCkKICAgICAgICAgICAgLmdldExv\nZyhPcGVuSlBBQ29uZmlndXJhdGlvbi5MT0dfTUVUQURBVEEpOwogICAgfQog\nICAgCiAgICBTdHJpbmcgdG9GaWVsZE5hbWVzKExpc3Q8RmllbGQ+IGZpZWxk\ncykgewogICAgCXJldHVybiBmaWVsZHMudG9TdHJpbmcoKTsKICAgIH0KICAg\nIAogICAgU3RyaW5nIHRvTWV0aG9kTmFtZXMoTGlzdDxNZXRob2Q+IG1ldGhv\nZHMpIHsKICAgIAlyZXR1cm4gbWV0aG9kcy50b1N0cmluZygpOwogICAgfQog\nICAgCiAgICBwdWJsaWMgYm9vbGVhbiBpc0Fic3RyYWN0TWFwcGluZ1VuaURp\ncmVjdGlvbmFsKE9wZW5KUEFDb25maWd1cmF0aW9uIGNvbmYpIHsKICAgICAg\nICBpZiAoX2lzQWJzdHJhY3RNYXBwaW5nVW5pRGlyZWN0aW9uYWwgPT0gbnVs\nbCkKICAgICAgICAgICAgc2V0QWJzdHJhY3RNYXBwaW5nVW5pRGlyZWN0aW9u\nYWwoY29uZik7CiAgICAgICAgcmV0dXJuIF9pc0Fic3RyYWN0TWFwcGluZ1Vu\naURpcmVjdGlvbmFsOwogICAgfQogICAgCiAgICBwdWJsaWMgdm9pZCBzZXRB\nYnN0cmFjdE1hcHBpbmdVbmlEaXJlY3Rpb25hbChPcGVuSlBBQ29uZmlndXJh\ndGlvbiBjb25mKSB7CiAgICAgICAgX2lzQWJzdHJhY3RNYXBwaW5nVW5pRGly\nZWN0aW9uYWwgPSBjb25mLmdldENvbXBhdGliaWxpdHlJbnN0YW5jZSgpLmlz\nQWJzdHJhY3RNYXBwaW5nVW5pRGlyZWN0aW9uYWwoKTsKICAgIH0KICAgIAog\nICAgcHVibGljIGJvb2xlYW4gaXNOb25EZWZhdWx0TWFwcGluZ0FsbG93ZWQo\nT3BlbkpQQUNvbmZpZ3VyYXRpb24gY29uZikgewogICAgICAgIGlmIChfaXNO\nb25EZWZhdWx0TWFwcGluZ0FsbG93ZWQgPT0gbnVsbCkKICAgICAgICAgICAg\nc2V0Tm9uRGVmYXVsdE1hcHBpbmdBbGxvd2VkKGNvbmYpOwogICAgICAgIHJl\ndHVybiBfaXNOb25EZWZhdWx0TWFwcGluZ0FsbG93ZWQ7CiAgICB9CgogICAg\ncHVibGljIHZvaWQgc2V0Tm9uRGVmYXVsdE1hcHBpbmdBbGxvd2VkKE9wZW5K\nUEFDb25maWd1cmF0aW9uIGNvbmYpIHsKICAgICAgICBfaXNOb25EZWZhdWx0\nTWFwcGluZ0FsbG93ZWQgPSBjb25mLmdldENvbXBhdGliaWxpdHlJbnN0YW5j\nZSgpLgogICAgICAgICAgICBpc05vbkRlZmF1bHRNYXBwaW5nQWxsb3dlZCgp\nOwogICAgfQp9Cg==\n","encoding":"base64"}

