{"sha":"131dfe39cc9bc275c0766c9a201e1ab8ecd8864f","node_id":"MDQ6QmxvYjIwNjM2NDoxMzFkZmUzOWNjOWJjMjc1YzA3NjZjOWEyMDFlMWFiOGVjZDg4NjRm","size":70055,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/131dfe39cc9bc275c0766c9a201e1ab8ecd8864f","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2U7CgppbXBv\ncnQgamF2YS5pby5GaWxlOwppbXBvcnQgamF2YS5pby5JT0V4Y2VwdGlvbjsK\naW1wb3J0IGphdmEubGFuZy5yZWZsZWN0LkZpZWxkOwppbXBvcnQgamF2YS5s\nYW5nLnJlZmxlY3QuTWVtYmVyOwppbXBvcnQgamF2YS5sYW5nLnJlZmxlY3Qu\nTWV0aG9kOwppbXBvcnQgamF2YS5uZXQuVVJMOwppbXBvcnQgamF2YS51dGls\nLkFycmF5TGlzdDsKaW1wb3J0IGphdmEudXRpbC5Db2xsZWN0aW9uOwppbXBv\ncnQgamF2YS51dGlsLkVudW1TZXQ7CmltcG9ydCBqYXZhLnV0aWwuSGFzaE1h\ncDsKaW1wb3J0IGphdmEudXRpbC5NYXA7CmltcG9ydCBqYXZhLnV0aWwuU2V0\nOwppbXBvcnQgamF2YS51dGlsLlN0YWNrOwppbXBvcnQgamF2YXgucGVyc2lz\ndGVuY2UuQ2FzY2FkZVR5cGU7CmltcG9ydCBqYXZheC5wZXJzaXN0ZW5jZS5H\nZW5lcmF0aW9uVHlwZTsKCmltcG9ydCBzdGF0aWMgamF2YXgucGVyc2lzdGVu\nY2UuQ2FzY2FkZVR5cGUuKjsKCmltcG9ydCBvcmcuYXBhY2hlLmNvbW1vbnMu\nbGFuZy5TdHJpbmdVdGlsczsKaW1wb3J0IG9yZy54bWwuc2F4LkF0dHJpYnV0\nZXM7CmltcG9ydCBvcmcueG1sLnNheC5Mb2NhdG9yOwppbXBvcnQgb3JnLnht\nbC5zYXguU0FYRXhjZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLmNvbmYuT3BlbkpQQUNvbmZpZ3VyYXRpb247CmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEuZW5oYW5jZS5QZXJzaXN0ZW5jZUNhcGFibGU7CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEuZXZlbnQuQmVhbkxpZmVjeWNsZUNhbGxiYWNr\nczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5ldmVudC5MaWZlY3ljbGVD\nYWxsYmFja3M7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuZXZlbnQuTGlm\nZWN5Y2xlRXZlbnQ7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuZXZlbnQu\nTWV0aG9kTGlmZWN5Y2xlQ2FsbGJhY2tzOwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLmtlcm5lbC5RdWVyeUxhbmd1YWdlczsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5rZXJuZWwuanBxbC5KUFFMUGFyc2VyOwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLmxpYi5jb25mLkNvbmZpZ3VyYXRpb25zOwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi5sb2cuTG9nOwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLmxpYi5tZXRhLkNGTWV0YURhdGFQYXJzZXI7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLm1ldGEuU291cmNlVHJhY2tl\ncjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIubWV0YS5YTUxWZXJz\naW9uUGFyc2VyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51dGls\nLkxvY2FsaXplcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRhLkFj\nY2Vzc0NvZGU7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YS5DbGFz\nc01ldGFEYXRhOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuRGVs\nZWdhdGluZ01ldGFEYXRhRmFjdG9yeTsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5tZXRhLkZpZWxkTWV0YURhdGE7CmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEubWV0YS5KYXZhVHlwZXM7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEubWV0YS5MaWZlY3ljbGVNZXRhRGF0YTsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS5tZXRhLk1ldGFEYXRhQ29udGV4dDsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5tZXRhLk1ldGFEYXRhRGVmYXVsdHM7CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEubWV0YS5NZXRhRGF0YUZhY3Rvcnk7CmltcG9ydCBz\ndGF0aWMgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuTWV0YURhdGFNb2Rlcy4q\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuTWV0YURhdGFSZXBv\nc2l0b3J5OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuT3JkZXI7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YS5RdWVyeU1ldGFEYXRh\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuU2VxdWVuY2VNZXRh\nRGF0YTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRhLlZhbHVlTWV0\nYURhdGE7CmltcG9ydCBzdGF0aWMgb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNp\nc3RlbmNlLk1ldGFEYXRhVGFnLio7CmltcG9ydCBzdGF0aWMgb3JnLmFwYWNo\nZS5vcGVuanBhLnBlcnNpc3RlbmNlLlBlcnNpc3RlbmNlU3RyYXRlZ3kuKjsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLkltcGxIZWxwZXI7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5NZXRhRGF0YUV4Y2VwdGlv\nbjsKCmltcG9ydCBzZXJwLnV0aWwuTnVtYmVyczsKCi8qKgogKiBDdXN0b20g\nU0FYIHBhcnNlciB1c2VkIGJ5IHRoZSBzeXN0ZW0gdG8gcXVpY2tseSBwYXJz\nZSBwZXJzaXN0ZW5jZSAKICogbWV0YWRhdGEgZmlsZXMuIFRoaXMgcGFyc2Vy\nIG1heSBpbnZva2UgCiAqIHtAbGlua3BsYWluIEFubm90YXRpb25QZXJzaXN0\nZW5jZU1ldGFEYXRhUGFyc2VyIGFub3RoZXIgcGFyc2VyfSB0byBzY2FuIAog\nKiBzb3VyY2UgY29kZSBhbm5vdGF0aW9uLgogKgogKiBAYXV0aG9yIFN0ZXZl\nIEtpbQogKiBAYXV0aG9yIFBpbmFraSBQb2RkYXIKICogQG5vamF2YWRvYwog\nKi8KcHVibGljIGNsYXNzIFhNTFBlcnNpc3RlbmNlTWV0YURhdGFQYXJzZXIK\nICAgIGV4dGVuZHMgQ0ZNZXRhRGF0YVBhcnNlcgogICAgaW1wbGVtZW50cyBQ\nZXJzaXN0ZW5jZU1ldGFEYXRhRmFjdG9yeS5QYXJzZXIgewoKICAgIC8vIHBh\ncnNlIGNvbnN0YW50cwogICAgcHJvdGVjdGVkIHN0YXRpYyBmaW5hbCBTdHJp\nbmcgRUxFTV9QS0cgPSAicGFja2FnZSI7CiAgICBwcm90ZWN0ZWQgc3RhdGlj\nIGZpbmFsIFN0cmluZyBFTEVNX0FDQ0VTUyA9ICJhY2Nlc3MiOwogICAgcHJv\ndGVjdGVkIHN0YXRpYyBmaW5hbCBTdHJpbmcgRUxFTV9BVFRSUyA9ICJhdHRy\naWJ1dGVzIjsKICAgIHByb3RlY3RlZCBzdGF0aWMgZmluYWwgU3RyaW5nIEVM\nRU1fTElTVEVORVIgPSAiZW50aXR5LWxpc3RlbmVyIjsKICAgIHByb3RlY3Rl\nZCBzdGF0aWMgZmluYWwgU3RyaW5nIEVMRU1fQ0FTQ0FERSA9ICJjYXNjYWRl\nIjsKICAgIHByb3RlY3RlZCBzdGF0aWMgZmluYWwgU3RyaW5nIEVMRU1fQ0FT\nQ0FERV9BTEwgPSAiY2FzY2FkZS1hbGwiOwogICAgcHJvdGVjdGVkIHN0YXRp\nYyBmaW5hbCBTdHJpbmcgRUxFTV9DQVNDQURFX1BFUiA9ICJjYXNjYWRlLXBl\ncnNpc3QiOwogICAgcHJvdGVjdGVkIHN0YXRpYyBmaW5hbCBTdHJpbmcgRUxF\nTV9DQVNDQURFX01FUiA9ICJjYXNjYWRlLW1lcmdlIjsKICAgIHByb3RlY3Rl\nZCBzdGF0aWMgZmluYWwgU3RyaW5nIEVMRU1fQ0FTQ0FERV9SRU0gPSAiY2Fz\nY2FkZS1yZW1vdmUiOwogICAgcHJvdGVjdGVkIHN0YXRpYyBmaW5hbCBTdHJp\nbmcgRUxFTV9DQVNDQURFX1JFRiA9ICJjYXNjYWRlLXJlZnJlc2giOwogICAg\ncHJvdGVjdGVkIHN0YXRpYyBmaW5hbCBTdHJpbmcgRUxFTV9DQVNDQURFX0RF\nVCA9ICJjYXNjYWRlLWRldGFjaCI7CiAgICBwcm90ZWN0ZWQgc3RhdGljIGZp\nbmFsIFN0cmluZyBFTEVNX1BVX01FVEEgPSAicGVyc2lzdGVuY2UtdW5pdC1t\nZXRhZGF0YSI7CiAgICBwcm90ZWN0ZWQgc3RhdGljIGZpbmFsIFN0cmluZyBF\nTEVNX1BVX0RFRiA9ICJwZXJzaXN0ZW5jZS11bml0LWRlZmF1bHRzIjsKICAg\nIHByb3RlY3RlZCBzdGF0aWMgZmluYWwgU3RyaW5nIEVMRU1fWE1MX01BUF9N\nRVRBX0NPTVBMRVRFID0KICAgICAgICAieG1sLW1hcHBpbmctbWV0YWRhdGEt\nY29tcGxldGUiOwoKICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIE1hcDxTdHJp\nbmcsIE9iamVjdD4gX2VsZW1zID0KICAgICAgICBuZXcgSGFzaE1hcDxTdHJp\nbmcsIE9iamVjdD4oKTsKCiAgICAvLyBNYXAgZm9yIHN0b3JpbmcgZGVmZXJy\nZWQgbWV0YWRhdGEgd2hpY2ggbmVlZHMgdG8gYmUgcG9wdWxhdGVkCiAgICAv\nLyBhZnRlciBlbWJlZGRhYmxlcyBhcmUgbG9hZGVkLgogICAgcHJpdmF0ZSBz\ndGF0aWMgZmluYWwgTWFwPENsYXNzPD8+LCBBcnJheUxpc3Q8TWV0YURhdGFD\nb250ZXh0Pj4gCiAgICAgICAgX2VtYmVkZGFibGVzID0gbmV3IEhhc2hNYXA8\nQ2xhc3M8Pz4sIEFycmF5TGlzdDxNZXRhRGF0YUNvbnRleHQ+PigpOwogICAg\ncHJpdmF0ZSBzdGF0aWMgZmluYWwgTWFwPENsYXNzPD8+LCBJbnRlZ2VyPiAK\nICAgICAgICBfZW1iZWRkYWJsZUFjY2VzcyA9IG5ldyBIYXNoTWFwPENsYXNz\nPD8+LCBJbnRlZ2VyPigpOwoKICAgIHN0YXRpYyB7CiAgICAgICAgX2VsZW1z\nLnB1dChFTEVNX1BLRywgRUxFTV9QS0cpOwogICAgICAgIF9lbGVtcy5wdXQo\nRUxFTV9BQ0NFU1MsIEVMRU1fQUNDRVNTKTsKICAgICAgICBfZWxlbXMucHV0\nKEVMRU1fQVRUUlMsIEVMRU1fQVRUUlMpOwogICAgICAgIF9lbGVtcy5wdXQo\nRUxFTV9MSVNURU5FUiwgRUxFTV9MSVNURU5FUik7CiAgICAgICAgX2VsZW1z\nLnB1dChFTEVNX0NBU0NBREUsIEVMRU1fQ0FTQ0FERSk7CiAgICAgICAgX2Vs\nZW1zLnB1dChFTEVNX0NBU0NBREVfQUxMLCBFTEVNX0NBU0NBREVfQUxMKTsK\nICAgICAgICBfZWxlbXMucHV0KEVMRU1fQ0FTQ0FERV9QRVIsIEVMRU1fQ0FT\nQ0FERV9QRVIpOwogICAgICAgIF9lbGVtcy5wdXQoRUxFTV9DQVNDQURFX1JF\nTSwgRUxFTV9DQVNDQURFX1JFTSk7CiAgICAgICAgX2VsZW1zLnB1dChFTEVN\nX0NBU0NBREVfTUVSLCBFTEVNX0NBU0NBREVfTUVSKTsKICAgICAgICBfZWxl\nbXMucHV0KEVMRU1fQ0FTQ0FERV9SRUYsIEVMRU1fQ0FTQ0FERV9SRUYpOwog\nICAgICAgIF9lbGVtcy5wdXQoRUxFTV9DQVNDQURFX0RFVCwgRUxFTV9DQVND\nQURFX0RFVCk7CiAgICAgICAgX2VsZW1zLnB1dChFTEVNX1BVX01FVEEsIEVM\nRU1fUFVfTUVUQSk7CiAgICAgICAgX2VsZW1zLnB1dChFTEVNX1BVX0RFRiwg\nRUxFTV9QVV9ERUYpOwogICAgICAgIF9lbGVtcy5wdXQoRUxFTV9YTUxfTUFQ\nX01FVEFfQ09NUExFVEUsIEVMRU1fWE1MX01BUF9NRVRBX0NPTVBMRVRFKTsK\nCiAgICAgICAgX2VsZW1zLnB1dCgiZW50aXR5LWxpc3RlbmVycyIsIEVOVElU\nWV9MSVNURU5FUlMpOwogICAgICAgIF9lbGVtcy5wdXQoInByZS1wZXJzaXN0\nIiwgUFJFX1BFUlNJU1QpOwogICAgICAgIF9lbGVtcy5wdXQoInBvc3QtcGVy\nc2lzdCIsIFBPU1RfUEVSU0lTVCk7CiAgICAgICAgX2VsZW1zLnB1dCgicHJl\nLXJlbW92ZSIsIFBSRV9SRU1PVkUpOwogICAgICAgIF9lbGVtcy5wdXQoInBv\nc3QtcmVtb3ZlIiwgUE9TVF9SRU1PVkUpOwogICAgICAgIF9lbGVtcy5wdXQo\nInByZS11cGRhdGUiLCBQUkVfVVBEQVRFKTsKICAgICAgICBfZWxlbXMucHV0\nKCJwb3N0LXVwZGF0ZSIsIFBPU1RfVVBEQVRFKTsKICAgICAgICBfZWxlbXMu\ncHV0KCJwb3N0LWxvYWQiLCBQT1NUX0xPQUQpOwogICAgICAgIF9lbGVtcy5w\ndXQoImV4Y2x1ZGUtZGVmYXVsdC1saXN0ZW5lcnMiLCBFWENMVURFX0RFRkFV\nTFRfTElTVEVORVJTKTsKICAgICAgICBfZWxlbXMucHV0KCJleGNsdWRlLXN1\ncGVyY2xhc3MtbGlzdGVuZXJzIiwKICAgICAgICAgICAgRVhDTFVERV9TVVBF\nUkNMQVNTX0xJU1RFTkVSUyk7CgogICAgICAgIF9lbGVtcy5wdXQoIm5hbWVk\nLXF1ZXJ5IiwgUVVFUlkpOwogICAgICAgIF9lbGVtcy5wdXQoIm5hbWVkLW5h\ndGl2ZS1xdWVyeSIsIE5BVElWRV9RVUVSWSk7CiAgICAgICAgX2VsZW1zLnB1\ndCgicXVlcnktaGludCIsIFFVRVJZX0hJTlQpOwogICAgICAgIF9lbGVtcy5w\ndXQoInF1ZXJ5IiwgUVVFUllfU1RSSU5HKTsKCiAgICAgICAgX2VsZW1zLnB1\ndCgiZmx1c2gtbW9kZSIsIEZMVVNIX01PREUpOwogICAgICAgIF9lbGVtcy5w\ndXQoInNlcXVlbmNlLWdlbmVyYXRvciIsIFNFUV9HRU5FUkFUT1IpOwoKICAg\nICAgICBfZWxlbXMucHV0KCJpZCIsIElEKTsKICAgICAgICBfZWxlbXMucHV0\nKCJpZC1jbGFzcyIsIElEX0NMQVNTKTsKICAgICAgICBfZWxlbXMucHV0KCJl\nbWJlZGRlZC1pZCIsIEVNQkVEREVEX0lEKTsKICAgICAgICBfZWxlbXMucHV0\nKCJ2ZXJzaW9uIiwgVkVSU0lPTik7CiAgICAgICAgX2VsZW1zLnB1dCgiZ2Vu\nZXJhdGVkLXZhbHVlIiwgR0VORVJBVEVEX1ZBTFVFKTsKICAgICAgICBfZWxl\nbXMucHV0KCJtYXAta2V5IiwgTUFQX0tFWSk7CiAgICAgICAgX2VsZW1zLnB1\ndCgib3JkZXItYnkiLCBPUkRFUl9CWSk7CiAgICAgICAgX2VsZW1zLnB1dCgi\nb3JkZXItY29sdW1uIiwgT1JERVJfQ09MVU1OKTsKICAgICAgICBfZWxlbXMu\ncHV0KCJsb2IiLCBMT0IpOwoKICAgICAgICBfZWxlbXMucHV0KCJiYXNpYyIs\nIEJBU0lDKTsKICAgICAgICBfZWxlbXMucHV0KCJtYW55LXRvLW9uZSIsIE1B\nTllfT05FKTsKICAgICAgICBfZWxlbXMucHV0KCJvbmUtdG8tb25lIiwgT05F\nX09ORSk7CiAgICAgICAgX2VsZW1zLnB1dCgiZW1iZWRkZWQiLCBFTUJFRERF\nRCk7CiAgICAgICAgX2VsZW1zLnB1dCgib25lLXRvLW1hbnkiLCBPTkVfTUFO\nWSk7CiAgICAgICAgX2VsZW1zLnB1dCgibWFueS10by1tYW55IiwgTUFOWV9N\nQU5ZKTsKICAgICAgICBfZWxlbXMucHV0KCJ0cmFuc2llbnQiLCBUUkFOU0lF\nTlQpOwogICAgICAgIF9lbGVtcy5wdXQoImVsZW1lbnQtY29sbGVjdGlvbiIs\nIEVMRU1fQ09MTCk7CiAgICAgICAgX2VsZW1zLnB1dCgibWFwLWtleS1jbGFz\ncyIsIE1BUF9LRVlfQ0xBU1MpOwogICAgfQoKICAgIHByaXZhdGUgc3RhdGlj\nIGZpbmFsIExvY2FsaXplciBfbG9jID0gTG9jYWxpemVyLmZvclBhY2thZ2UK\nICAgICAgICAoWE1MUGVyc2lzdGVuY2VNZXRhRGF0YVBhcnNlci5jbGFzcyk7\nCgogICAgcHJpdmF0ZSBmaW5hbCBPcGVuSlBBQ29uZmlndXJhdGlvbiBfY29u\nZjsKICAgIHByaXZhdGUgTWV0YURhdGFSZXBvc2l0b3J5IF9yZXBvcyA9IG51\nbGw7CiAgICBwcml2YXRlIEFubm90YXRpb25QZXJzaXN0ZW5jZU1ldGFEYXRh\nUGFyc2VyIF9wYXJzZXIgPSBudWxsOwogICAgcHJpdmF0ZSBDbGFzc0xvYWRl\nciBfZW52TG9hZGVyID0gbnVsbDsKICAgIHByaXZhdGUgaW50IF9tb2RlID0g\nTU9ERV9OT05FOwogICAgcHJpdmF0ZSBib29sZWFuIF9vdmVycmlkZSA9IGZh\nbHNlOwoKICAgIHByaXZhdGUgZmluYWwgU3RhY2s8T2JqZWN0PiBfZWxlbWVu\ndHMgPSBuZXcgU3RhY2s8T2JqZWN0PigpOwogICAgcHJpdmF0ZSBmaW5hbCBT\ndGFjazxPYmplY3Q+IF9wYXJlbnRzID0gbmV3IFN0YWNrPE9iamVjdD4oKTsK\nCiAgICBwcml2YXRlIENsYXNzPD8+IF9jbHMgPSBudWxsOwogICAgLy8gTGlz\ndCBvZiBjbGFzc2VzIGN1cnJlbnRseSBiZWluZyBwYXJzZWQKICAgIHByaXZh\ndGUgQXJyYXlMaXN0PENsYXNzPD8+PiBfcGFyc2VMaXN0ID0gbmV3IEFycmF5\nTGlzdDxDbGFzczw/Pj4oKTsKICAgIHByaXZhdGUgaW50IF9maWVsZFBvcyA9\nIDA7CiAgICBwcml2YXRlIGludCBfY2xzUG9zID0gMDsKICAgIHByaXZhdGUg\naW50IF9hY2Nlc3MgPSBBY2Nlc3NDb2RlLlVOS05PV047CiAgICBwcml2YXRl\nIFBlcnNpc3RlbmNlU3RyYXRlZ3kgX3N0cmF0ZWd5ID0gbnVsbDsKICAgIHBy\naXZhdGUgU2V0PENhc2NhZGVUeXBlPiBfY2FzY2FkZXMgPSBudWxsOwogICAg\ncHJpdmF0ZSBTZXQ8Q2FzY2FkZVR5cGU+IF9wa2dDYXNjYWRlcyA9IG51bGw7\nCgogICAgcHJpdmF0ZSBDbGFzczw/PiBfbGlzdGVuZXIgPSBudWxsOwogICAg\ncHJpdmF0ZSBDb2xsZWN0aW9uPExpZmVjeWNsZUNhbGxiYWNrcz5bXSBfY2Fs\nbGJhY2tzID0gbnVsbDsKICAgIHByaXZhdGUgaW50W10gX2hpZ2hzID0gbnVs\nbDsKICAgIHByaXZhdGUgYm9vbGVhbiBfaXNYTUxNYXBwaW5nTWV0YURhdGFD\nb21wbGV0ZSA9IGZhbHNlOwoKICAgIHByaXZhdGUgU3RyaW5nIF9vcm1WZXJz\naW9uOwogICAgcHJpdmF0ZSBTdHJpbmcgX3NjaGVtYUxvY2F0aW9uOwogICAg\nCiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBTdHJpbmcgT1JNX1hTRF8xXzAg\nPSAib3JtXzFfMC54c2QiOwogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgU3Ry\naW5nIE9STV9YU0RfMl8wID0gIm9ybV8yXzAueHNkIjsKICAgIAogICAgLyoq\nCiAgICAgKiBDb25zdHJ1Y3Rvcjsgc3VwcGx5IGNvbmZpZ3VyYXRpb24uCiAg\nICAgKi8KICAgIHB1YmxpYyBYTUxQZXJzaXN0ZW5jZU1ldGFEYXRhUGFyc2Vy\nKE9wZW5KUEFDb25maWd1cmF0aW9uIGNvbmYpIHsKICAgICAgICBfY29uZiA9\nIGNvbmY7CiAgICAgICAgc2V0VmFsaWRhdGluZyh0cnVlKTsKICAgICAgICBz\nZXRMb2coY29uZi5nZXRMb2coT3BlbkpQQUNvbmZpZ3VyYXRpb24uTE9HX01F\nVEFEQVRBKSk7CiAgICAgICAgc2V0UGFyc2VDb21tZW50cyh0cnVlKTsKICAg\nICAgICBzZXRNb2RlKE1PREVfTUVUQSB8IE1PREVfTUFQUElORyB8IE1PREVf\nUVVFUlkpOwogICAgICAgIHNldFBhcnNlVGV4dCh0cnVlKTsKICAgIH0KCiAg\nICAvKioKICAgICAqIENvbmZpZ3VyYXRpb24gc3VwcGxpZWQgb24gY29uc3Ry\ndWN0aW9uLgogICAgICovCiAgICBwdWJsaWMgT3BlbkpQQUNvbmZpZ3VyYXRp\nb24gZ2V0Q29uZmlndXJhdGlvbigpIHsKICAgICAgICByZXR1cm4gX2NvbmY7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBUaGUgYW5ub3RhdGlvbiBwYXJzZXIu\nIFdoZW4gY2xhc3MgaXMgZGlzY292ZXJlZCBpbiBhbiBYTUwgZmlsZSwKICAg\nICAqIHdlIGZpcnN0IHBhcnNlIGFueSBhbm5vdGF0aW9ucyBwcmVzZW50LCB0\naGVuIG92ZXJyaWRlIHdpdGggdGhlIFhNTC4KICAgICAqLwogICAgcHVibGlj\nIEFubm90YXRpb25QZXJzaXN0ZW5jZU1ldGFEYXRhUGFyc2VyIGdldEFubm90\nYXRpb25QYXJzZXIoKSB7CiAgICAgICAgcmV0dXJuIF9wYXJzZXI7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBUaGUgYW5ub3RhdGlvbiBwYXJzZXIuIFdoZW4g\nY2xhc3MgaXMgZGlzY292ZXJlZCBpbiBhbiBYTUwgZmlsZSwKICAgICAqIHdl\nIGZpcnN0IHBhcnNlIGFueSBhbm5vdGF0aW9ucyBwcmVzZW50LCB0aGVuIG92\nZXJyaWRlIHdpdGggdGhlIFhNTC4KICAgICAqLwogICAgcHVibGljIHZvaWQg\nc2V0QW5ub3RhdGlvblBhcnNlcihBbm5vdGF0aW9uUGVyc2lzdGVuY2VNZXRh\nRGF0YVBhcnNlciBwYXJzZXIpewogICAgICAgIF9wYXJzZXIgPSBwYXJzZXI7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm5zIHRoZSByZXBvc2l0b3J5\nIGZvciB0aGlzIHBhcnNlci4gSWYgbm9uZSBoYXMgYmVlbiBzZXQsIGNyZWF0\nZXMKICAgICAqIGEgbmV3IHJlcG9zaXRvcnkgYW5kIHNldHMgaXQuCiAgICAg\nKi8KICAgIHB1YmxpYyBNZXRhRGF0YVJlcG9zaXRvcnkgZ2V0UmVwb3NpdG9y\neSgpIHsKICAgICAgICBpZiAoX3JlcG9zID09IG51bGwpIHsKICAgICAgICAg\nICAgTWV0YURhdGFSZXBvc2l0b3J5IHJlcG9zID0gX2NvbmYubmV3TWV0YURh\ndGFSZXBvc2l0b3J5SW5zdGFuY2UoKTsKICAgICAgICAgICAgTWV0YURhdGFG\nYWN0b3J5IG1kZiA9IHJlcG9zLmdldE1ldGFEYXRhRmFjdG9yeSgpOwogICAg\nICAgICAgICBpZiAobWRmIGluc3RhbmNlb2YgRGVsZWdhdGluZ01ldGFEYXRh\nRmFjdG9yeSkKICAgICAgICAgICAgICAgIG1kZiA9ICgoRGVsZWdhdGluZ01l\ndGFEYXRhRmFjdG9yeSkgbWRmKS5nZXRJbm5lcm1vc3REZWxlZ2F0ZSgpOwog\nICAgICAgICAgICBpZiAobWRmIGluc3RhbmNlb2YgUGVyc2lzdGVuY2VNZXRh\nRGF0YUZhY3RvcnkpCiAgICAgICAgICAgICAgICAoKFBlcnNpc3RlbmNlTWV0\nYURhdGFGYWN0b3J5KSBtZGYpLnNldFhNTFBhcnNlcih0aGlzKTsKICAgICAg\nICAgICAgX3JlcG9zID0gcmVwb3M7CiAgICAgICAgfQogICAgICAgIHJldHVy\nbiBfcmVwb3M7CiAgICB9CgogICAgLyoqCiAgICAgKiBTZXQgdGhlIG1ldGFk\nYXRhIHJlcG9zaXRvcnkgZm9yIHRoaXMgcGFyc2VyLgogICAgICovCiAgICBw\ndWJsaWMgdm9pZCBzZXRSZXBvc2l0b3J5KE1ldGFEYXRhUmVwb3NpdG9yeSBy\nZXBvcykgewogICAgICAgIF9yZXBvcyA9IHJlcG9zOwogICAgICAgIGlmIChy\nZXBvcyAhPSBudWxsCiAgICAgICAgICAgICYmIChyZXBvcy5nZXRWYWxpZGF0\nZSgpICYgTWV0YURhdGFSZXBvc2l0b3J5LlZBTElEQVRFX1JVTlRJTUUpICE9\nIDApCiAgICAgICAgICAgIHNldFBhcnNlQ29tbWVudHMoZmFsc2UpOwogICAg\nfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRoZSBlbnZpcm9ubWVudGFsIGNs\nYXNzIGxvYWRlciB0byBwYXNzIG9uIHRvIHBhcnNlZAogICAgICogbWV0YWRh\ndGEgaW5zdGFuY2VzLgogICAgICovCiAgICBwdWJsaWMgQ2xhc3NMb2FkZXIg\nZ2V0RW52Q2xhc3NMb2FkZXIoKSB7CiAgICAgICAgcmV0dXJuIF9lbnZMb2Fk\nZXI7CiAgICB9CgogICAgLyoqCiAgICAgKiBTZXQgdGhlIGVudmlyb25tZW50\nYWwgY2xhc3MgbG9hZGVyIHRvIHBhc3Mgb24gdG8gcGFyc2VkCiAgICAgKiBt\nZXRhZGF0YSBpbnN0YW5jZXMuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNl\ndEVudkNsYXNzTG9hZGVyKENsYXNzTG9hZGVyIGxvYWRlcikgewogICAgICAg\nIF9lbnZMb2FkZXIgPSBsb2FkZXI7CiAgICB9CgogICAgLyoqCiAgICAgKiBX\naGV0aGVyIHRvIGFsbG93IGxhdGVyIHBhcnNlcyBvZiBtYXBwaW5nIGluZm9y\nbWF0aW9uIHRvIG92ZXJyaWRlCiAgICAgKiBlYXJsaWVyIGluZm9ybWF0aW9u\nIGZvciB0aGUgc2FtZSBjbGFzcy4gRGVmYXVsdHMgdG8gZmFsc2UuIFVzZWZ1\nbAogICAgICogd2hlbiBhIHRvb2wgaXMgbWFwcGluZyBhIGNsYXNzLCBzbyB0\naGF0IC5qZG8gZmlsZSBwYXJ0aWFsIG1hcHBpbmcKICAgICAqIGluZm9ybWF0\naW9uIGNhbiBiZSB1c2VkIGV2ZW4gd2hlbiBtYXBwaW5ncyBhcmUgc3RvcmVk\nIGluIC5vcm0gZmlsZXMKICAgICAqIG9yIG90aGVyIGxvY2F0aW9ucy4KICAg\nICAqLwogICAgcHVibGljIGJvb2xlYW4gZ2V0TWFwcGluZ092ZXJyaWRlKCkg\newogICAgICAgIHJldHVybiBfb3ZlcnJpZGU7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBXaGV0aGVyIHRvIGFsbG93IGxhdGVyIHBhcnNlcyBvZiBtYXBwaW5n\nIGluZm9ybWF0aW9uIHRvIG92ZXJyaWRlCiAgICAgKiBlYXJsaWVyIGluZm9y\nbWF0aW9uIGZvciB0aGUgc2FtZSBjbGFzcy4gRGVmYXVsdHMgdG8gZmFsc2Uu\nIFVzZWZ1bAogICAgICogd2hlbiBhIHRvb2wgaXMgbWFwcGluZyBhIGNsYXNz\nLCBzbyB0aGF0IC5qZG8gZmlsZSBwYXJ0aWFsIG1hcHBpbmcKICAgICAqIGlu\nZm9ybWF0aW9uIGNhbiBiZSB1c2VkIGV2ZW4gd2hlbiBtYXBwaW5ncyBhcmUg\nc3RvcmVkIGluIC5vcm0gZmlsZXMKICAgICAqIG9yIG90aGVyIGxvY2F0aW9u\ncy4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0TWFwcGluZ092ZXJyaWRl\nKGJvb2xlYW4gb3ZlcnJpZGUpIHsKICAgICAgICBfb3ZlcnJpZGUgPSBvdmVy\ncmlkZTsKICAgIH0KCiAgICAvKioKICAgICAqIFRoZSBwYXJzZSBtb2RlIGFj\nY29yZGluZyB0byB0aGUgZXhwZWN0ZWQgZG9jdW1lbnQgdHlwZS4gVGhlCiAg\nICAgKiBtb2RlIGNvbnN0YW50cyBhY3QgYXMgYml0IGZsYWdzLCBhbmQgdGhl\ncmVmb3JlIGNhbiBiZSBjb21iaW5lZC4KICAgICAqLwogICAgcHVibGljIGlu\ndCBnZXRNb2RlKCkgewogICAgICAgIHJldHVybiBfbW9kZTsKICAgIH0KCiAg\nICAvKioKICAgICAqIFRoZSBwYXJzZSBtb2RlIGFjY29yZGluZyB0byB0aGUg\nZXhwZWN0ZWQgZG9jdW1lbnQgdHlwZS4KICAgICAqLwogICAgcHVibGljIHZv\naWQgc2V0TW9kZShpbnQgbW9kZSwgYm9vbGVhbiBvbikgewogICAgICAgIGlm\nIChtb2RlID09IE1PREVfTk9ORSkKICAgICAgICAgICAgc2V0TW9kZShNT0RF\nX05PTkUpOwogICAgICAgIGVsc2UgaWYgKG9uKQogICAgICAgICAgICBzZXRN\nb2RlKF9tb2RlIHwgbW9kZSk7CiAgICAgICAgZWxzZQogICAgICAgICAgICBz\nZXRNb2RlKF9tb2RlICYgfm1vZGUpOwogICAgfQoKICAgIC8qKgogICAgICog\nVGhlIHBhcnNlIG1vZGUgYWNjb3JkaW5nIHRvIHRoZSBleHBlY3RlZCBkb2N1\nbWVudCB0eXBlLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRNb2RlKGlu\ndCBtb2RlKSB7CiAgICAgICAgX21vZGUgPSBtb2RlOwogICAgICAgIGlmIChf\ncGFyc2VyICE9IG51bGwpCiAgICAgICAgICAgIF9wYXJzZXIuc2V0TW9kZSht\nb2RlKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBwYXJzZShVUkwgdXJsKSB0\naHJvd3MgSU9FeGNlcHRpb24gewogICAgICAgIC8vIHBlZWsgYXQgdGhlIGRv\nYyB0byBkZXRlcm1pbmUgdGhlIHZlcnNpb24KICAgICAgICBYTUxWZXJzaW9u\nUGFyc2VyIHZwID0gbmV3IFhNTFZlcnNpb25QYXJzZXIoImVudGl0eS1tYXBw\naW5ncyIpOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIHZwLnBhcnNlKHVy\nbCk7CiAgICAgICAgICAgIF9vcm1WZXJzaW9uID0gdnAuZ2V0VmVyc2lvbigp\nOwogICAgICAgICAgICBfc2NoZW1hTG9jYXRpb24gPSB2cC5nZXRTY2hlbWFM\nb2NhdGlvbigpOwogICAgICAgIH0gY2F0Y2ggKFRocm93YWJsZSB0KSB7CiAg\nICAgICAgICAgICAgICBMb2cgbG9nID0gZ2V0TG9nKCk7CiAgICAgICAgICAg\nICAgICBpZiAobG9nLmlzSW5mb0VuYWJsZWQoKSkKICAgICAgICAgICAgICAg\nICAgICBsb2cudHJhY2UoX2xvYy5nZXQoInZlcnNpb24tY2hlY2stZXJyb3Ii\nLCAKICAgICAgICAgICAgICAgICAgICAgICAgdXJsLnRvU3RyaW5nKCkpKTsK\nICAgICAgICB9ICAgICAgIAogICAgICAgIHN1cGVyLnBhcnNlKHVybCk7CiAg\nICB9CgogICAgcHVibGljIHZvaWQgcGFyc2UoRmlsZSBmaWxlKSB0aHJvd3Mg\nSU9FeGNlcHRpb24geyAgICAgICAgCiAgICAgICAgLy8gcGVlayBhdCB0aGUg\nZG9jIHRvIGRldGVybWluZSB0aGUgdmVyc2lvbgogICAgICAgIFhNTFZlcnNp\nb25QYXJzZXIgdnAgPSBuZXcgWE1MVmVyc2lvblBhcnNlcigiZW50aXR5LW1h\ncHBpbmdzIik7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgdnAucGFyc2Uo\nZmlsZSk7CiAgICAgICAgICAgIF9vcm1WZXJzaW9uID0gdnAuZ2V0VmVyc2lv\nbigpOwogICAgICAgICAgICBfc2NoZW1hTG9jYXRpb24gPSB2cC5nZXRTY2hl\nbWFMb2NhdGlvbigpOwogICAgICAgIH0gY2F0Y2ggKFRocm93YWJsZSB0KSB7\nCiAgICAgICAgICAgICAgICBMb2cgbG9nID0gZ2V0TG9nKCk7CiAgICAgICAg\nICAgICAgICBpZiAobG9nLmlzSW5mb0VuYWJsZWQoKSkKICAgICAgICAgICAg\nICAgICAgICBsb2cudHJhY2UoX2xvYy5nZXQoInZlcnNpb24tY2hlY2stZXJy\nb3IiLCAKICAgICAgICAgICAgICAgICAgICAgICAgZmlsZS50b1N0cmluZygp\nKSk7CiAgICAgICAgfSAgICAgICAKICAgICAgICBzdXBlci5wYXJzZShmaWxl\nKTsKICAgIH0KICAgIC8qKgogICAgICogQ29udmVuaWVuY2UgbWV0aG9kIGZv\nciBpbnRlcnByZXRpbmcge0BsaW5rICNnZXRNb2RlfS4KICAgICAqLwogICAg\ncHJvdGVjdGVkIGJvb2xlYW4gaXNNZXRhRGF0YU1vZGUoKSB7CiAgICAgICAg\ncmV0dXJuIChfbW9kZSAmIE1PREVfTUVUQSkgIT0gMDsKICAgIH0KCiAgICAv\nKioKICAgICAqIENvbnZlbmllbmNlIG1ldGhvZCBmb3IgaW50ZXJwcmV0aW5n\nIHtAbGluayAjZ2V0TW9kZX0uCiAgICAgKi8KICAgIHByb3RlY3RlZCBib29s\nZWFuIGlzUXVlcnlNb2RlKCkgewogICAgICAgIHJldHVybiAoX21vZGUgJiBN\nT0RFX1FVRVJZKSAhPSAwOwogICAgfQoKICAgIC8qKgogICAgICogQ29udmVu\naWVuY2UgbWV0aG9kIGZvciBpbnRlcnByZXRpbmcge0BsaW5rICNnZXRNb2Rl\nfS4KICAgICAqLwogICAgcHJvdGVjdGVkIGJvb2xlYW4gaXNNYXBwaW5nTW9k\nZSgpIHsKICAgICAgICByZXR1cm4gKF9tb2RlICYgTU9ERV9NQVBQSU5HKSAh\nPSAwOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJucyB0cnVlIGlmIHdl\nJ3JlIGluIG1hcHBpbmcgbW9kZSBvciBpbiBtZXRhZGF0YSBtb2RlIHdpdGgK\nICAgICAqIG1hcHBpbmcgb3ZlcnJpZGUgZW5hYmxlZC4KICAgICAqLwogICAg\ncHJvdGVjdGVkIGJvb2xlYW4gaXNNYXBwaW5nT3ZlcnJpZGVNb2RlKCkgewog\nICAgICAgIHJldHVybiBpc01hcHBpbmdNb2RlKCkgfHwgKF9vdmVycmlkZSAm\nJiBpc01ldGFEYXRhTW9kZSgpKTsKICAgIH0KCiAgICAvLy8vLy8vLy8vLy8v\nLy8KICAgIC8vIFhNTCBwYXJzaW5nCiAgICAvLy8vLy8vLy8vLy8vLy8KCiAg\nICAvKioKICAgICAqIFB1c2ggYSBwYXJzZSBlbGVtZW50IG9udG8gdGhlIHN0\nYWNrLgogICAgICovCiAgICBwcm90ZWN0ZWQgdm9pZCBwdXNoRWxlbWVudChP\nYmplY3QgZWxlbSkgewogICAgICAgIF9lbGVtZW50cy5wdXNoKGVsZW0pOwog\nICAgfQoKICAgIC8qKgogICAgICogUG9wIGEgcGFyc2UgZWxlbWVudCBmcm9t\nIHRoZSBzdGFjay4KICAgICAqLwogICAgcHJvdGVjdGVkIE9iamVjdCBwb3BF\nbGVtZW50KCkgewogICAgICAgIHJldHVybiBfZWxlbWVudHMucG9wKCk7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBQZWVrIGEgcGFyc2UgZWxlbWVudCBmcm9t\nIHRoZSBzdGFjay4KICAgICAqLwogICAgcHJvdGVjdGVkIE9iamVjdCBwZWVr\nRWxlbWVudCgpIHsKICAgICAgICByZXR1cm4gX2VsZW1lbnRzLnBlZWsoKTsK\nICAgIH0KICAgIAogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIGN1cnJlbnQg\nZWxlbWVudCBiZWluZyBwYXJzZWQuIE1heSBiZSBhIGNsYXNzIG1ldGFkYXRh\nLAogICAgICogZmllbGQgbWV0YWRhdGEsIHF1ZXJ5IG1ldGFkYXRhLCBldGMu\nCiAgICAgKi8KICAgIHByb3RlY3RlZCBPYmplY3QgY3VycmVudEVsZW1lbnQo\nKSB7CiAgICAgICAgaWYgKF9lbGVtZW50cy5pc0VtcHR5KCkpCiAgICAgICAg\nICAgIHJldHVybiBudWxsOwogICAgICAgIHJldHVybiBfZWxlbWVudHMucGVl\naygpOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRoZSBjdXJyZW50\nIHtAbGluayBQZXJzaXN0ZW5jZVN0cmF0ZWd5fSBpZiBhbnkuCiAgICAgKi8K\nICAgIHByb3RlY3RlZCBQZXJzaXN0ZW5jZVN0cmF0ZWd5IGN1cnJlbnRTdHJh\ndGVneSgpIHsKICAgICAgICByZXR1cm4gX3N0cmF0ZWd5OwogICAgfQoKICAg\nIC8qKgogICAgICogUmV0dXJuIHRoZSB0YWcgb2YgdGhlIGN1cnJlbnQgcGFy\nZW50IGVsZW1lbnQuCiAgICAgKi8KICAgIHByb3RlY3RlZCBPYmplY3QgY3Vy\ncmVudFBhcmVudCgpIHsKICAgICAgICBpZiAoX3BhcmVudHMuaXNFbXB0eSgp\nKQogICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICByZXR1cm4gX3Bh\ncmVudHMucGVlaygpOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHdo\nZXRoZXIgd2UncmUgcnVubmluZyB0aGUgcGFyc2VyIGF0IHJ1bnRpbWUuCiAg\nICAgKi8KICAgIHByb3RlY3RlZCBib29sZWFuIGlzUnVudGltZSgpIHsKICAg\nICAgICByZXR1cm4gKGdldFJlcG9zaXRvcnkoKS5nZXRWYWxpZGF0ZSgpCiAg\nICAgICAgICAgICYgTWV0YURhdGFSZXBvc2l0b3J5LlZBTElEQVRFX1JVTlRJ\nTUUpICE9IDA7CiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwcm90ZWN0ZWQg\nT2JqZWN0IGdldFNjaGVtYVNvdXJjZSgpIHsgICAgICAgIAogICAgICAgIC8v\nIHVzZSB0aGUgbGF0ZXN0IHNjaGVtYSBieSBkZWZhdWx0LiAgJ3Vua25vd24n\nIGRvY3Mgc2hvdWxkIHBhcnNlCiAgICAgICAgLy8gd2l0aCB0aGUgbGF0ZXN0\nIHNjaGVtYS4KICAgICAgICBTdHJpbmcgb3JteHNkID0gIm9ybV8yXzAteHNk\nLnJzcmMiOwogICAgICAgIC8vIGlmIHRoZSB2ZXJzaW9uIGFuZC9vciBzY2hl\nbWEgbG9jYXRpb24gaXMgZm9yIDEuMCwgdXNlIHRoZSAxLjAgCiAgICAgICAg\nLy8gc2NoZW1hCiAgICAgICAgaWYgKF9vcm1WZXJzaW9uICE9IG51bGwgJiYK\nICAgICAgICAgICAgX29ybVZlcnNpb24uZXF1YWxzKFhNTFZlcnNpb25QYXJz\nZXIuVkVSU0lPTl8xXzApIHx8CiAgICAgICAgICAgIChfc2NoZW1hTG9jYXRp\nb24gIT0gbnVsbCAmJiAKICAgICAgICAgICAgX3NjaGVtYUxvY2F0aW9uLmlu\nZGV4T2YoT1JNX1hTRF8xXzApICE9IC0xKSkgewogICAgICAgICAgICBvcm14\nc2QgPSAib3JtLXhzZC5yc3JjIjsKICAgICAgICB9ICAgICAgICAKICAgICAg\nICByZXR1cm4gWE1MUGVyc2lzdGVuY2VNZXRhRGF0YVBhcnNlci5jbGFzcy5n\nZXRSZXNvdXJjZUFzU3RyZWFtKG9ybXhzZCk7CiAgICB9CgogICAgQE92ZXJy\naWRlCiAgICBwcm90ZWN0ZWQgU3RyaW5nIGdldFBhY2thZ2VBdHRyaWJ1dGVO\nYW1lKCkgewogICAgICAgIHJldHVybiBudWxsOwogICAgfQoKICAgIEBPdmVy\ncmlkZQogICAgcHJvdGVjdGVkIFN0cmluZyBnZXRDbGFzc0F0dHJpYnV0ZU5h\nbWUoKSB7CiAgICAgICAgcmV0dXJuICJjbGFzcyI7CiAgICB9CgogICAgQE92\nZXJyaWRlCiAgICBwcm90ZWN0ZWQgaW50IGdldENsYXNzRWxlbWVudERlcHRo\nKCkgewogICAgICAgIHJldHVybiAxOwogICAgfQoKICAgIEBPdmVycmlkZQog\nICAgcHJvdGVjdGVkIGJvb2xlYW4gaXNDbGFzc0VsZW1lbnROYW1lKFN0cmlu\nZyBuYW1lKSB7CiAgICAgICAgcmV0dXJuICJlbnRpdHkiLmVxdWFscyhuYW1l\nKQogICAgICAgICAgICB8fCAiZW1iZWRkYWJsZSIuZXF1YWxzKG5hbWUpCiAg\nICAgICAgICAgIHx8ICJtYXBwZWQtc3VwZXJjbGFzcyIuZXF1YWxzKG5hbWUp\nOwogICAgfQoKICAgIEBPdmVycmlkZQogICAgcHJvdGVjdGVkIHZvaWQgcmVz\nZXQoKSB7CiAgICAJLy8gQWRkIGFsbCByZW1haW5pbmcgZGVmZXJyZWQgZW1i\nZWRkYWJsZSBtZXRhZGF0YQogICAgICAgIGFkZERlZmVycmVkRW1iZWRkYWJs\nZU1ldGFEYXRhKCk7CgogICAgICAgIHN1cGVyLnJlc2V0KCk7CiAgICAgICAg\nX2VsZW1lbnRzLmNsZWFyKCk7CiAgICAgICAgX3BhcmVudHMuY2xlYXIoKTsK\nICAgICAgICBfY2xzID0gbnVsbDsKICAgICAgICBfcGFyc2VMaXN0LmNsZWFy\nKCk7CiAgICAgICAgX2ZpZWxkUG9zID0gMDsKICAgICAgICBfY2xzUG9zID0g\nMDsKCiAgICAgICAgX2FjY2VzcyA9IEFjY2Vzc0NvZGUuVU5LTk9XTjsKICAg\nICAgICBfc3RyYXRlZ3kgPSBudWxsOwogICAgICAgIF9saXN0ZW5lciA9IG51\nbGw7CiAgICAgICAgX2NhbGxiYWNrcyA9IG51bGw7CiAgICAgICAgX2hpZ2hz\nID0gbnVsbDsKICAgICAgICBfY2FzY2FkZXMgPSBudWxsOwogICAgICAgIF9w\na2dDYXNjYWRlcyA9IG51bGw7CiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBw\ncm90ZWN0ZWQgYm9vbGVhbiBzdGFydFN5c3RlbUVsZW1lbnQoU3RyaW5nIG5h\nbWUsIEF0dHJpYnV0ZXMgYXR0cnMpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2Vw\ndGlvbiB7CiAgICAgICAgT2JqZWN0IHRhZyA9IChPYmplY3QpIF9lbGVtcy5n\nZXQobmFtZSk7CiAgICAgICAgYm9vbGVhbiByZXQgPSBmYWxzZTsKICAgICAg\nICBpZiAodGFnID09IG51bGwpIHsKICAgICAgICAgICAgaWYgKGlzTWFwcGlu\nZ092ZXJyaWRlTW9kZSgpKQogICAgICAgICAgICAgICAgdGFnID0gc3RhcnRT\neXN0ZW1NYXBwaW5nRWxlbWVudChuYW1lLCBhdHRycyk7CiAgICAgICAgICAg\nIHJldCA9IHRhZyAhPSBudWxsOwogICAgICAgIH0gZWxzZSBpZiAodGFnIGlu\nc3RhbmNlb2YgTWV0YURhdGFUYWcpIHsKICAgICAgICAgICAgc3dpdGNoICgo\nTWV0YURhdGFUYWcpIHRhZykgewogICAgICAgICAgICAgICAgY2FzZSBRVUVS\nWToKICAgICAgICAgICAgICAgICAgICByZXQgPSBzdGFydE5hbWVkUXVlcnko\nYXR0cnMpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAg\nICAgICAgY2FzZSBRVUVSWV9ISU5UOgogICAgICAgICAgICAgICAgICAgIHJl\ndCA9IHN0YXJ0UXVlcnlIaW50KGF0dHJzKTsKICAgICAgICAgICAgICAgICAg\nICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgTkFUSVZFX1FVRVJZOgog\nICAgICAgICAgICAgICAgICAgIHJldCA9IHN0YXJ0TmFtZWROYXRpdmVRdWVy\neShhdHRycyk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAg\nICAgICAgICBjYXNlIFFVRVJZX1NUUklORzoKICAgICAgICAgICAgICAgICAg\nICByZXQgPSBzdGFydFF1ZXJ5U3RyaW5nKGF0dHJzKTsKICAgICAgICAgICAg\nICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgU0VRX0dFTkVS\nQVRPUjoKICAgICAgICAgICAgICAgICAgICByZXQgPSBzdGFydFNlcXVlbmNl\nR2VuZXJhdG9yKGF0dHJzKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsK\nICAgICAgICAgICAgICAgIGNhc2UgRkxVU0hfTU9ERToKICAgICAgICAgICAg\nICAgICAgICByZXQgPSBzdGFydEZsdXNoTW9kZShhdHRycyk7CiAgICAgICAg\nICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIEVOVElU\nWV9MSVNURU5FUlM6CiAgICAgICAgICAgICAgICAgICAgcmV0ID0gc3RhcnRF\nbnRpdHlMaXN0ZW5lcnMoYXR0cnMpOwogICAgICAgICAgICAgICAgICAgIGJy\nZWFrOwogICAgICAgICAgICAgICAgY2FzZSBQUkVfUEVSU0lTVDoKICAgICAg\nICAgICAgICAgIGNhc2UgUE9TVF9QRVJTSVNUOgogICAgICAgICAgICAgICAg\nY2FzZSBQUkVfUkVNT1ZFOgogICAgICAgICAgICAgICAgY2FzZSBQT1NUX1JF\nTU9WRToKICAgICAgICAgICAgICAgIGNhc2UgUFJFX1VQREFURToKICAgICAg\nICAgICAgICAgIGNhc2UgUE9TVF9VUERBVEU6CiAgICAgICAgICAgICAgICBj\nYXNlIFBPU1RfTE9BRDoKICAgICAgICAgICAgICAgICAgICByZXQgPSBzdGFy\ndENhbGxiYWNrKChNZXRhRGF0YVRhZykgdGFnLCBhdHRycyk7CiAgICAgICAg\nICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBkZWZhdWx0Ogog\nICAgICAgICAgICAgICAgICAgIHdhcm5VbnN1cHBvcnRlZFRhZyhuYW1lKTsK\nICAgICAgICAgICAgfQogICAgICAgIH0gZWxzZSBpZiAodGFnID09IEVMRU1f\nUFVfTUVUQSB8fCB0YWcgPT0gRUxFTV9QVV9ERUYpCiAgICAgICAgICAgIHJl\ndCA9IGlzTWV0YURhdGFNb2RlKCk7CiAgICAgICAgZWxzZSBpZiAodGFnID09\nIEVMRU1fWE1MX01BUF9NRVRBX0NPTVBMRVRFKSB7CiAgICAgICAgICAgIHNl\ndEFubm90YXRpb25QYXJzZXIobnVsbCk7CiAgICAgICAgICAgIF9pc1hNTE1h\ncHBpbmdNZXRhRGF0YUNvbXBsZXRlID0gdHJ1ZTsKICAgICAgICB9CiAgICAg\nICAgZWxzZSBpZiAodGFnID09IEVMRU1fQUNDRVNTKQogICAgICAgICAgICBy\nZXQgPSBfbW9kZSAhPSBNT0RFX1FVRVJZOwogICAgICAgIGVsc2UgaWYgKHRh\nZyA9PSBFTEVNX0xJU1RFTkVSKQogICAgICAgICAgICByZXQgPSBzdGFydEVu\ndGl0eUxpc3RlbmVyKGF0dHJzKTsKICAgICAgICBlbHNlIGlmICh0YWcgPT0g\nRUxFTV9DQVNDQURFKQogICAgICAgICAgICByZXQgPSBpc01ldGFEYXRhTW9k\nZSgpOwogICAgICAgIGVsc2UgaWYgKHRhZyA9PSBFTEVNX0NBU0NBREVfQUxM\nIHx8IHRhZyA9PSBFTEVNX0NBU0NBREVfUEVSCiAgICAgICAgICAgIHx8IHRh\nZyA9PSBFTEVNX0NBU0NBREVfTUVSIHx8IHRhZyA9PSBFTEVNX0NBU0NBREVf\nUkVNCiAgICAgICAgICAgIHx8IHRhZyA9PSBFTEVNX0NBU0NBREVfUkVGIHx8\nIHRhZyA9PSBFTEVNX0NBU0NBREVfREVUKQogICAgICAgICAgICByZXQgPSBz\ndGFydENhc2NhZGUodGFnLCBhdHRycyk7CgogICAgICAgIGlmIChyZXQpCiAg\nICAgICAgICAgIF9wYXJlbnRzLnB1c2godGFnKTsKICAgICAgICByZXR1cm4g\ncmV0OwogICAgfQoKICAgIEBPdmVycmlkZQogICAgcHJvdGVjdGVkIHZvaWQg\nZW5kU3lzdGVtRWxlbWVudChTdHJpbmcgbmFtZSkKICAgICAgICB0aHJvd3Mg\nU0FYRXhjZXB0aW9uIHsKICAgICAgICBPYmplY3QgdGFnID0gX2VsZW1zLmdl\ndChuYW1lKTsKICAgICAgICBpZiAodGFnID09IG51bGwgJiYgaXNNYXBwaW5n\nT3ZlcnJpZGVNb2RlKCkpCiAgICAgICAgICAgIGVuZFN5c3RlbU1hcHBpbmdF\nbGVtZW50KG5hbWUpOwogICAgICAgIGVsc2UgaWYgKHRhZyBpbnN0YW5jZW9m\nIE1ldGFEYXRhVGFnKSB7CiAgICAgICAgICAgIHN3aXRjaCAoKE1ldGFEYXRh\nVGFnKSB0YWcpIHsKICAgICAgICAgICAgICAgIGNhc2UgUVVFUlk6CiAgICAg\nICAgICAgICAgICAgICAgZW5kTmFtZWRRdWVyeSgpOwogICAgICAgICAgICAg\nICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSBRVUVSWV9ISU5U\nOgogICAgICAgICAgICAgICAgICAgIGVuZFF1ZXJ5SGludCgpOwogICAgICAg\nICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSBOQVRJ\nVkVfUVVFUlk6CiAgICAgICAgICAgICAgICAgICAgZW5kTmFtZWROYXRpdmVR\ndWVyeSgpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAg\nICAgICAgY2FzZSBRVUVSWV9TVFJJTkc6CiAgICAgICAgICAgICAgICAgICAg\nZW5kUXVlcnlTdHJpbmcoKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsK\nICAgICAgICAgICAgICAgIGNhc2UgU0VRX0dFTkVSQVRPUjoKICAgICAgICAg\nICAgICAgICAgICBlbmRTZXF1ZW5jZUdlbmVyYXRvcigpOwogICAgICAgICAg\nICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgfSBlbHNl\nIGlmICh0YWcgPT0gRUxFTV9BQ0NFU1MpCiAgICAgICAgICAgIGVuZEFjY2Vz\ncygpOwogICAgICAgIGVsc2UgaWYgKHRhZyA9PSBFTEVNX0xJU1RFTkVSKQog\nICAgICAgICAgICBlbmRFbnRpdHlMaXN0ZW5lcigpOwoKICAgICAgICBfcGFy\nZW50cy5wb3AoKTsKICAgIH0KCiAgICAvKioKICAgICAqIEltcGxlbWVudCB0\nbyBwYXJzZSBhIG1hcHBpbmcgZWxlbWVudCBvdXRzaWRlIG9mIGFueSBjbGFz\ncy4KICAgICAqCiAgICAgKiBAcmV0dXJuIHRoZSB0YWcgZm9yIHRoZSBnaXZl\nbiBlbGVtZW50LCBvciBudWxsIHRvIHNraXAgdGhlIGVsZW1lbnQKICAgICAq\nLwogICAgcHJvdGVjdGVkIE9iamVjdCBzdGFydFN5c3RlbU1hcHBpbmdFbGVt\nZW50KFN0cmluZyBuYW1lLCBBdHRyaWJ1dGVzIGF0dHJzKQogICAgICAgIHRo\ncm93cyBTQVhFeGNlcHRpb24gewogICAgICAgIHJldHVybiBudWxsOwogICAg\nfQoKICAgIC8qKgogICAgICogSW1wbGVtZW50IHRvIHBhcnNlIGEgbWFwcGlu\nZyBlbGVtZW50IG91dHNpZGUgb2YgYW55IGNsYXNzLgogICAgICovCiAgICBw\ncm90ZWN0ZWQgdm9pZCBlbmRTeXN0ZW1NYXBwaW5nRWxlbWVudChTdHJpbmcg\nbmFtZSkKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgIH0KCiAg\nICBAT3ZlcnJpZGUKICAgIHByb3RlY3RlZCBib29sZWFuIHN0YXJ0Q2xhc3NF\nbGVtZW50KFN0cmluZyBuYW1lLCBBdHRyaWJ1dGVzIGF0dHJzKQogICAgICAg\nIHRocm93cyBTQVhFeGNlcHRpb24gewogICAgICAgIE9iamVjdCB0YWcgPSAo\nT2JqZWN0KSBfZWxlbXMuZ2V0KG5hbWUpOwogICAgICAgIGJvb2xlYW4gcmV0\nID0gZmFsc2U7CiAgICAgICAgaWYgKHRhZyA9PSBudWxsKSB7CiAgICAgICAg\nICAgIGlmIChpc01hcHBpbmdPdmVycmlkZU1vZGUoKSkKICAgICAgICAgICAg\nICAgIHRhZyA9IHN0YXJ0Q2xhc3NNYXBwaW5nRWxlbWVudChuYW1lLCBhdHRy\ncyk7CiAgICAgICAgICAgIHJldCA9IHRhZyAhPSBudWxsOwogICAgICAgIH0g\nZWxzZSBpZiAodGFnIGluc3RhbmNlb2YgTWV0YURhdGFUYWcpIHsKICAgICAg\nICAgICAgc3dpdGNoICgoTWV0YURhdGFUYWcpIHRhZykgewogICAgICAgICAg\nICAgICAgY2FzZSBHRU5FUkFURURfVkFMVUU6CiAgICAgICAgICAgICAgICAg\nICAgcmV0ID0gc3RhcnRHZW5lcmF0ZWRWYWx1ZShhdHRycyk7CiAgICAgICAg\nICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIElEOgog\nICAgICAgICAgICAgICAgICAgIHJldCA9IHN0YXJ0SWQoYXR0cnMpOwogICAg\nICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSBF\nTUJFRERFRF9JRDoKICAgICAgICAgICAgICAgICAgICByZXQgPSBzdGFydEVt\nYmVkZGVkSWQoYXR0cnMpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwog\nICAgICAgICAgICAgICAgY2FzZSBJRF9DTEFTUzoKICAgICAgICAgICAgICAg\nICAgICByZXQgPSBzdGFydElkQ2xhc3MoYXR0cnMpOwogICAgICAgICAgICAg\nICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSBMT0I6CiAgICAg\nICAgICAgICAgICAgICAgcmV0ID0gc3RhcnRMb2IoYXR0cnMpOwogICAgICAg\nICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSBRVUVS\nWToKICAgICAgICAgICAgICAgICAgICByZXQgPSBzdGFydE5hbWVkUXVlcnko\nYXR0cnMpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAg\nICAgICAgY2FzZSBRVUVSWV9ISU5UOgogICAgICAgICAgICAgICAgICAgIHJl\ndCA9IHN0YXJ0UXVlcnlIaW50KGF0dHJzKTsKICAgICAgICAgICAgICAgICAg\nICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgTkFUSVZFX1FVRVJZOgog\nICAgICAgICAgICAgICAgICAgIHJldCA9IHN0YXJ0TmFtZWROYXRpdmVRdWVy\neShhdHRycyk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAg\nICAgICAgICBjYXNlIFFVRVJZX1NUUklORzoKICAgICAgICAgICAgICAgICAg\nICByZXQgPSBzdGFydFF1ZXJ5U3RyaW5nKGF0dHJzKTsKICAgICAgICAgICAg\nICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgU0VRX0dFTkVS\nQVRPUjoKICAgICAgICAgICAgICAgICAgICByZXQgPSBzdGFydFNlcXVlbmNl\nR2VuZXJhdG9yKGF0dHJzKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsK\nICAgICAgICAgICAgICAgIGNhc2UgVkVSU0lPTjoKICAgICAgICAgICAgICAg\nICAgICByZXQgPSBzdGFydFZlcnNpb24oYXR0cnMpOwogICAgICAgICAgICAg\nICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSBNQVBfS0VZOgog\nICAgICAgICAgICAgICAgICAgIHJldCA9IHN0YXJ0TWFwS2V5KGF0dHJzKTsK\nICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNh\nc2UgTUFQX0tFWV9DTEFTUzoKICAgICAgICAgICAgICAgICAgICByZXQgPSBz\ndGFydE1hcEtleUNsYXNzKGF0dHJzKTsKICAgICAgICAgICAgICAgICAgICBi\ncmVhazsKICAgICAgICAgICAgICAgIGNhc2UgRkxVU0hfTU9ERToKICAgICAg\nICAgICAgICAgICAgICByZXQgPSBzdGFydEZsdXNoTW9kZShhdHRycyk7CiAg\nICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNl\nIE9SREVSX0NPTFVNTjoKICAgICAgICAgICAgICAgICAgICByZXQgPSBzdGFy\ndE9yZGVyQ29sdW1uKGF0dHJzKTsKICAgICAgICAgICAgICAgICAgICBicmVh\nazsKICAgICAgICAgICAgICAgIGNhc2UgT1JERVJfQlk6CiAgICAgICAgICAg\nICAgICBjYXNlIEVOVElUWV9MSVNURU5FUlM6CiAgICAgICAgICAgICAgICAg\nICAgcmV0ID0gaXNNZXRhRGF0YU1vZGUoKTsKICAgICAgICAgICAgICAgICAg\nICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgRVhDTFVERV9ERUZBVUxU\nX0xJU1RFTkVSUzoKICAgICAgICAgICAgICAgICAgICByZXQgPSBzdGFydEV4\nY2x1ZGVEZWZhdWx0TGlzdGVuZXJzKGF0dHJzKTsKICAgICAgICAgICAgICAg\nICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgRVhDTFVERV9TVVBF\nUkNMQVNTX0xJU1RFTkVSUzoKICAgICAgICAgICAgICAgICAgICByZXQgPSBz\ndGFydEV4Y2x1ZGVTdXBlcmNsYXNzTGlzdGVuZXJzKGF0dHJzKTsKICAgICAg\nICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgUFJF\nX1BFUlNJU1Q6CiAgICAgICAgICAgICAgICBjYXNlIFBPU1RfUEVSU0lTVDoK\nICAgICAgICAgICAgICAgIGNhc2UgUFJFX1JFTU9WRToKICAgICAgICAgICAg\nICAgIGNhc2UgUE9TVF9SRU1PVkU6CiAgICAgICAgICAgICAgICBjYXNlIFBS\nRV9VUERBVEU6CiAgICAgICAgICAgICAgICBjYXNlIFBPU1RfVVBEQVRFOgog\nICAgICAgICAgICAgICAgY2FzZSBQT1NUX0xPQUQ6CiAgICAgICAgICAgICAg\nICAgICAgcmV0ID0gc3RhcnRDYWxsYmFjaygoTWV0YURhdGFUYWcpIHRhZywg\nYXR0cnMpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAg\nICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAgICAgICB3YXJuVW5zdXBw\nb3J0ZWRUYWcobmFtZSk7CiAgICAgICAgICAgIH0KICAgICAgICB9IGVsc2Ug\naWYgKHRhZyBpbnN0YW5jZW9mIFBlcnNpc3RlbmNlU3RyYXRlZ3kpIHsKICAg\nICAgICAgICAgUGVyc2lzdGVuY2VTdHJhdGVneSBwcyA9IChQZXJzaXN0ZW5j\nZVN0cmF0ZWd5KSB0YWc7CiAgICAgICAgICAgIHJldCA9IHN0YXJ0U3RyYXRl\nZ3kocHMsIGF0dHJzKTsKICAgICAgICAgICAgaWYgKHJldCkKICAgICAgICAg\nICAgICAgIF9zdHJhdGVneSA9IHBzOwogICAgICAgIH0gZWxzZSBpZiAodGFn\nID09IEVMRU1fTElTVEVORVIpCiAgICAgICAgICAgIHJldCA9IHN0YXJ0RW50\naXR5TGlzdGVuZXIoYXR0cnMpOwogICAgICAgIGVsc2UgaWYgKHRhZyA9PSBF\nTEVNX0FUVFJTKQogICAgICAgICAgICByZXQgPSBfbW9kZSAhPSBNT0RFX1FV\nRVJZOwogICAgICAgIGVsc2UgaWYgKHRhZyA9PSBFTEVNX0NBU0NBREUpCiAg\nICAgICAgICAgIHJldCA9IGlzTWV0YURhdGFNb2RlKCk7CiAgICAgICAgZWxz\nZSBpZiAodGFnID09IEVMRU1fQ0FTQ0FERV9BTEwgfHwgdGFnID09IEVMRU1f\nQ0FTQ0FERV9QRVIKICAgICAgICAgICAgfHwgdGFnID09IEVMRU1fQ0FTQ0FE\nRV9NRVIgfHwgdGFnID09IEVMRU1fQ0FTQ0FERV9SRU0KICAgICAgICAgICAg\nfHwgdGFnID09IEVMRU1fQ0FTQ0FERV9SRUYgfHwgdGFnID09IEVMRU1fQ0FT\nQ0FERV9ERVQpCiAgICAgICAgICAgIHJldCA9IHN0YXJ0Q2FzY2FkZSh0YWcs\nIGF0dHJzKTsKCiAgICAgICAgaWYgKHJldCkKICAgICAgICAgICAgX3BhcmVu\ndHMucHVzaCh0YWcpOwogICAgICAgIHJldHVybiByZXQ7CiAgICB9CgogICAg\nQE92ZXJyaWRlCiAgICBwcm90ZWN0ZWQgdm9pZCBlbmRDbGFzc0VsZW1lbnQo\nU3RyaW5nIG5hbWUpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAg\nICAgICAgT2JqZWN0IHRhZyA9IF9lbGVtcy5nZXQobmFtZSk7CiAgICAgICAg\naWYgKHRhZyA9PSBudWxsICYmIGlzTWFwcGluZ092ZXJyaWRlTW9kZSgpKQog\nICAgICAgICAgICBlbmRDbGFzc01hcHBpbmdFbGVtZW50KG5hbWUpOwogICAg\nICAgIGVsc2UgaWYgKHRhZyBpbnN0YW5jZW9mIE1ldGFEYXRhVGFnKSB7CiAg\nICAgICAgICAgIHN3aXRjaCAoKE1ldGFEYXRhVGFnKSB0YWcpIHsKICAgICAg\nICAgICAgICAgIGNhc2UgR0VORVJBVEVEX1ZBTFVFOgogICAgICAgICAgICAg\nICAgICAgIGVuZEdlbmVyYXRlZFZhbHVlKCk7CiAgICAgICAgICAgICAgICAg\nICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIElEOgogICAgICAgICAg\nICAgICAgICAgIGVuZElkKCk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7\nCiAgICAgICAgICAgICAgICBjYXNlIEVNQkVEREVEX0lEOgogICAgICAgICAg\nICAgICAgICAgIGVuZEVtYmVkZGVkSWQoKTsKICAgICAgICAgICAgICAgICAg\nICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgSURfQ0xBU1M6CiAgICAg\nICAgICAgICAgICAgICAgZW5kSWRDbGFzcygpOwogICAgICAgICAgICAgICAg\nICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSBMT0I6CiAgICAgICAg\nICAgICAgICAgICAgZW5kTG9iKCk7CiAgICAgICAgICAgICAgICAgICAgYnJl\nYWs7CiAgICAgICAgICAgICAgICBjYXNlIFFVRVJZOgogICAgICAgICAgICAg\nICAgICAgIGVuZE5hbWVkUXVlcnkoKTsKICAgICAgICAgICAgICAgICAgICBi\ncmVhazsKICAgICAgICAgICAgICAgIGNhc2UgUVVFUllfSElOVDoKICAgICAg\nICAgICAgICAgICAgICBlbmRRdWVyeUhpbnQoKTsKICAgICAgICAgICAgICAg\nICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgTkFUSVZFX1FVRVJZ\nOgogICAgICAgICAgICAgICAgICAgIGVuZE5hbWVkTmF0aXZlUXVlcnkoKTsK\nICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNh\nc2UgUVVFUllfU1RSSU5HOgogICAgICAgICAgICAgICAgICAgIGVuZFF1ZXJ5\nU3RyaW5nKCk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAg\nICAgICAgICBjYXNlIFNFUV9HRU5FUkFUT1I6CiAgICAgICAgICAgICAgICAg\nICAgZW5kU2VxdWVuY2VHZW5lcmF0b3IoKTsKICAgICAgICAgICAgICAgICAg\nICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgVkVSU0lPTjoKICAgICAg\nICAgICAgICAgICAgICBlbmRWZXJzaW9uKCk7CiAgICAgICAgICAgICAgICAg\nICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIE9SREVSX0JZOgogICAg\nICAgICAgICAgICAgICAgIGVuZE9yZGVyQnkoKTsKICAgICAgICAgICAgICAg\nICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAgIH0gZWxzZSBpZiAo\ndGFnIGluc3RhbmNlb2YgUGVyc2lzdGVuY2VTdHJhdGVneSkKICAgICAgICAg\nICAgZW5kU3RyYXRlZ3koKFBlcnNpc3RlbmNlU3RyYXRlZ3kpIHRhZyk7CiAg\nICAgICAgZWxzZSBpZiAodGFnID09IEVMRU1fQUNDRVNTKQogICAgICAgICAg\nICBlbmRBY2Nlc3MoKTsKICAgICAgICBlbHNlIGlmICh0YWcgPT0gRUxFTV9M\nSVNURU5FUikKICAgICAgICAgICAgZW5kRW50aXR5TGlzdGVuZXIoKTsKCiAg\nICAgICAgX3BhcmVudHMucG9wKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBM\nb2cgd2FybmluZyBhYm91dCBhbiB1bnN1cHBvcnRlZCB0YWcuCiAgICAgKi8K\nICAgIHByaXZhdGUgdm9pZCB3YXJuVW5zdXBwb3J0ZWRUYWcoU3RyaW5nIG5h\nbWUpIHsKICAgICAgICBMb2cgbG9nID0gZ2V0TG9nKCk7CiAgICAgICAgaWYg\nKGxvZy5pc0luZm9FbmFibGVkKCkpCiAgICAgICAgICAgIGxvZy50cmFjZShf\nbG9jLmdldCgidW5zdXBwb3J0ZWQtdGFnIiwgbmFtZSkpOwogICAgfQoKICAg\nIC8qKgogICAgICogSW1wbGVtZW50IHRvIHBhcnNlIGEgbWFwcGluZyBlbGVt\nZW50IHdpdGhpbiBhIGNsYXNzLgogICAgICoKICAgICAqIEByZXR1cm4gdGhl\nIHRhZyBmb3IgdGhlIGdpdmVuIGVsZW1lbnQsIG9yIG51bGwgdG8gc2tpcCBl\nbGVtZW50CiAgICAgKi8KICAgIHByb3RlY3RlZCBPYmplY3Qgc3RhcnRDbGFz\nc01hcHBpbmdFbGVtZW50KFN0cmluZyBuYW1lLCBBdHRyaWJ1dGVzIGF0dHJz\nKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24gewogICAgICAgIHJldHVy\nbiBudWxsOwogICAgfQoKICAgIC8qKgogICAgICogSW1wbGVtZW50IHRvIHBh\ncnNlIGEgbWFwcGluZyBlbGVtZW50IHdpdGhpbiBhIGNsYXNzLgogICAgICov\nCiAgICBwcm90ZWN0ZWQgdm9pZCBlbmRDbGFzc01hcHBpbmdFbGVtZW50KFN0\ncmluZyBuYW1lKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24gewogICAg\nfQoKICAgIGJvb2xlYW4gaXNNZXRhRGF0YUNvbXBsZXRlKEF0dHJpYnV0ZXMg\nYXR0cnMpIHsKICAgIAlyZXR1cm4gYXR0cnMgIT0gbnVsbCAKICAgIAkgICAg\nJiYgInRydWUiLmVxdWFscyhhdHRycy5nZXRWYWx1ZSgibWV0YWRhdGEtY29t\ncGxldGUiKSk7CiAgICB9CiAgICAKICAgIHZvaWQgcmVzZXRBbm5vdGF0aW9u\nUGFyc2VyKCkgewogICAgCXNldEFubm90YXRpb25QYXJzZXIoKChQZXJzaXN0\nZW5jZU1ldGFEYXRhRmFjdG9yeSlnZXRSZXBvc2l0b3J5KCkKICAgIAkJCS5n\nZXRNZXRhRGF0YUZhY3RvcnkoKSkuZ2V0QW5ub3RhdGlvblBhcnNlcigpKTsK\nICAgIH0KICAgIAogICAgQE92ZXJyaWRlCiAgICBwcm90ZWN0ZWQgYm9vbGVh\nbiBzdGFydENsYXNzKFN0cmluZyBlbGVtLCBBdHRyaWJ1dGVzIGF0dHJzKQog\nICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24gewogICAgICAgIHN1cGVyLnN0\nYXJ0Q2xhc3MoZWxlbSwgYXR0cnMpOwogICAgICAgIGlmIChpc01ldGFEYXRh\nQ29tcGxldGUoYXR0cnMpKSB7CiAgICAgICAgCXNldEFubm90YXRpb25QYXJz\nZXIobnVsbCk7CiAgICAgICAgfSBlbHNlIGlmICghX2lzWE1MTWFwcGluZ01l\ndGFEYXRhQ29tcGxldGUpewogICAgICAgIAlyZXNldEFubm90YXRpb25QYXJz\nZXIoKTsKICAgICAgICB9CgogICAgICAgIC8vIHF1ZXJ5IG1vZGUgb25seT8K\nICAgICAgICBfY2xzID0gY2xhc3NGb3JOYW1lKGN1cnJlbnRDbGFzc05hbWUo\nKSk7CiAgICAgICAgCiAgICAgICAgLy8gUHJldmVudCBhIHJlZW50cmFudCBw\nYXJzZSBmb3IgdGhlIHNhbWUgY2xhc3MKICAgICAgICBpZiAocGFyc2VMaXN0\nQ29udGFpbnMoX2NscykpIHsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwog\nICAgICAgIH0KICAgICAgICAKICAgICAgICBpZiAoX21vZGUgPT0gTU9ERV9R\nVUVSWSkgewogICAgICAgICAgICBpZiAoX3BhcnNlciAhPSBudWxsKQogICAg\nICAgICAgICAgICAgX3BhcnNlci5wYXJzZShfY2xzKTsKICAgICAgICAgICAg\ncmV0dXJuIHRydWU7CiAgICAgICAgfQoKICAgICAgICBMb2cgbG9nID0gZ2V0\nTG9nKCk7CiAgICAgICAgaWYgKGxvZy5pc1RyYWNlRW5hYmxlZCgpKQogICAg\nICAgICAgICBsb2cudHJhY2UoX2xvYy5nZXQoInBhcnNlLWNsYXNzIiwgX2Ns\ncy5nZXROYW1lKCkpKTsKCiAgICAgICAgTWV0YURhdGFSZXBvc2l0b3J5IHJl\ncG9zID0gZ2V0UmVwb3NpdG9yeSgpOwogICAgICAgIENsYXNzTWV0YURhdGEg\nbWV0YSA9IHJlcG9zLmdldENhY2hlZE1ldGFEYXRhKF9jbHMpOwogICAgICAg\nIGlmIChtZXRhICE9IG51bGwKICAgICAgICAgICAgJiYgKChpc01ldGFEYXRh\nTW9kZSgpICYmIChtZXRhLmdldFNvdXJjZU1vZGUoKSAmIE1PREVfTUVUQSkg\nIT0gMCkKICAgICAgICAgICAgfHwgKGlzTWFwcGluZ01vZGUoKSAmJiAobWV0\nYS5nZXRTb3VyY2VNb2RlKCkgJiBNT0RFX01BUFBJTkcpICE9IDApKSkKICAg\nICAgICB7CiAgICAgICAgICAgIGlmIChsb2cuaXNXYXJuRW5hYmxlZCgpKQog\nICAgICAgICAgICAgICAgbG9nLndhcm4oX2xvYy5nZXQoImR1cC1tZXRhZGF0\nYSIsIF9jbHMsIGdldFNvdXJjZU5hbWUoKSkpOwogICAgICAgICAgICBfY2xz\nID0gbnVsbDsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0K\nCiAgICAgICAgaW50IGFjY2VzcyA9IEFjY2Vzc0NvZGUuVU5LTk9XTjsKICAg\nICAgICBpZiAobWV0YSA9PSBudWxsKSB7CiAgICAgICAgICAgIGludCBhY2Nl\nc3NDb2RlID0gdG9BY2Nlc3NUeXBlKGF0dHJzLmdldFZhbHVlKCJhY2Nlc3Mi\nKSk7CiAgICAgICAgICAgIC8vIGlmIGFjY2VzcyBub3Qgc3BlY2lmaWVkIGFu\nZCBhY2Nlc3Mgd2FzIHNwZWNpZmllZCBhdAogICAgICAgICAgICAvLyB0aGUg\nc3lzdGVtIGxldmVsLCB1c2UgdGhlIHN5c3RlbSBkZWZhdWx0ICh3aGljaCBt\nYXkgCiAgICAgICAgICAgIC8vIGJlIFVOS05PV04pCiAgICAgICAgICAgIGlm\nIChhY2Nlc3NDb2RlID09IEFjY2Vzc0NvZGUuVU5LTk9XTikKICAgICAgICAg\nICAgICAgIGFjY2Vzc0NvZGUgPSBfYWNjZXNzOwogICAgICAgICAgICBtZXRh\nID0gcmVwb3MuYWRkTWV0YURhdGEoX2NscywgYWNjZXNzQ29kZSk7CiAgICAg\nICAgICAgIG1ldGEuc2V0RW52Q2xhc3NMb2FkZXIoX2VudkxvYWRlcik7CiAg\nICAgICAgICAgIG1ldGEuc2V0U291cmNlTW9kZShNT0RFX05PTkUpOwoKICAg\nICAgICAgICAgLy8gcGFyc2UgYW5ub3RhdGlvbnMgZmlyc3Qgc28gWE1MIG92\nZXJyaWRlcyB0aGVtCiAgICAgICAgICAgIGlmIChfcGFyc2VyICE9IG51bGwp\nCiAgICAgICAgICAgICAgICBfcGFyc2VyLnBhcnNlKF9jbHMpOwogICAgICAg\nIH0KICAgICAgICBhY2Nlc3MgPSBtZXRhLmdldEFjY2Vzc1R5cGUoKTsKCiAg\nICAgICAgYm9vbGVhbiBtYXBwZWRTdXBlciA9ICJtYXBwZWQtc3VwZXJjbGFz\ncyIuZXF1YWxzKGVsZW0pOwogICAgICAgIGJvb2xlYW4gZW1iZWRkYWJsZSA9\nICJlbWJlZGRhYmxlIi5lcXVhbHMoZWxlbSk7CiAgICAgICAgaWYgKGlzTWV0\nYURhdGFNb2RlKCkpIHsKICAgICAgICAgICAgbWV0YS5zZXRTb3VyY2UoZ2V0\nU291cmNlRmlsZSgpLCBTb3VyY2VUcmFja2VyLlNSQ19YTUwpOwogICAgICAg\nICAgICBtZXRhLnNldFNvdXJjZU1vZGUoTU9ERV9NRVRBLCB0cnVlKTsKICAg\nICAgICAgICAgTG9jYXRvciBsb2NhdG9yID0gZ2V0TG9jYXRpb24oKS5nZXRM\nb2NhdG9yKCk7CiAgICAgICAgICAgIGlmIChsb2NhdG9yICE9IG51bGwpIHsK\nICAgICAgICAgICAgICAgIG1ldGEuc2V0TGluZU51bWJlcihOdW1iZXJzLnZh\nbHVlT2YobG9jYXRvci5nZXRMaW5lTnVtYmVyKCkpKTsKICAgICAgICAgICAg\nICAgIG1ldGEuc2V0Q29sTnVtYmVyKE51bWJlcnMudmFsdWVPZihsb2NhdG9y\nLmdldENvbHVtbk51bWJlcigpKSk7CiAgICAgICAgICAgIH0KICAgICAgICAg\nICAgbWV0YS5zZXRMaXN0aW5nSW5kZXgoX2Nsc1Bvcyk7CiAgICAgICAgICAg\nIFN0cmluZyBuYW1lID0gYXR0cnMuZ2V0VmFsdWUoIm5hbWUiKTsKICAgICAg\nICAgICAgaWYgKCFTdHJpbmdVdGlscy5pc0VtcHR5KG5hbWUpKQogICAgICAg\nICAgICAgICAgbWV0YS5zZXRUeXBlQWxpYXMobmFtZSk7CiAgICAgICAgICAg\nIG1ldGEuc2V0QWJzdHJhY3QobWFwcGVkU3VwZXIpOwogICAgICAgICAgICBt\nZXRhLnNldEVtYmVkZGVkT25seShtYXBwZWRTdXBlciB8fCBlbWJlZGRhYmxl\nKTsKICAgICAgICAgICAgCiAgICAgICAgICAgIGlmIChlbWJlZGRhYmxlKSB7\nCiAgICAgICAgICAgICAgICBtZXRhLnNldEVtYmVkZGFibGUoKTsKICAgICAg\nICAgICAgICAgIHNldERlZmVycmVkRW1iZWRkYWJsZUFjY2Vzc1R5cGUoX2Ns\ncywgYWNjZXNzKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICAK\nICAgICAgICBpZihhdHRycy5nZXRWYWx1ZSgiY2FjaGVhYmxlIikgIT0gbnVs\nbCkgeyAKICAgICAgICAgICAgbWV0YS5zZXRDYWNoZUVuYWJsZWQoQm9vbGVh\nbi52YWx1ZU9mKGF0dHJzLmdldFZhbHVlKCJjYWNoZWFibGUiKSkpOwogICAg\nICAgIH0KICAgICAgICAKICAgICAgICBpZiAoaXNNYXBwaW5nTW9kZSgpKQog\nICAgICAgICAgICBtZXRhLnNldFNvdXJjZU1vZGUoTU9ERV9NQVBQSU5HLCB0\ncnVlKTsKICAgICAgICBpZiAoaXNNYXBwaW5nT3ZlcnJpZGVNb2RlKCkpCiAg\nICAgICAgICAgIHN0YXJ0Q2xhc3NNYXBwaW5nKG1ldGEsIG1hcHBlZFN1cGVy\nLCBhdHRycyk7CiAgICAgICAgaWYgKGlzUXVlcnlNb2RlKCkpCiAgICAgICAg\nICAgIG1ldGEuc2V0U291cmNlTW9kZShNT0RFX1FVRVJZLCB0cnVlKTsKCiAg\nICAgICAgX2Nsc1BvcysrOwogICAgICAgIF9maWVsZFBvcyA9IDA7CiAgICAg\nICAgYWRkQ29tbWVudHMobWV0YSk7CiAgICAgICAgcHVzaEVsZW1lbnQobWV0\nYSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgQE92ZXJyaWRl\nCiAgICBwcm90ZWN0ZWQgdm9pZCBlbmRDbGFzcyhTdHJpbmcgZWxlbSkKICAg\nICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICBpZiAoX21vZGUg\nIT0gTU9ERV9RVUVSWSkgewogICAgICAgICAgICBDbGFzc01ldGFEYXRhIG1l\ndGEgPSAoQ2xhc3NNZXRhRGF0YSkgcG9wRWxlbWVudCgpOwogICAgICAgICAg\nICBzdG9yZUNhbGxiYWNrcyhtZXRhKTsKICAgICAgICAgICAgaWYgKGlzTWFw\ncGluZ092ZXJyaWRlTW9kZSgpKQogICAgICAgICAgICAgICAgZW5kQ2xhc3NN\nYXBwaW5nKG1ldGEpOwogICAgICAgIH0KICAgICAgICBfY2xzID0gbnVsbDsK\nICAgICAgICBzdXBlci5lbmRDbGFzcyhlbGVtKTsKICAgIH0KCiAgICAvKioK\nICAgICAqIEltcGxlbWVudCB0byBhZGQgbWFwcGluZyBhdHRyaWJ1dGVzIHRv\nIGNsYXNzLgogICAgICovCiAgICBwcm90ZWN0ZWQgdm9pZCBzdGFydENsYXNz\nTWFwcGluZyhDbGFzc01ldGFEYXRhIG1hcHBpbmcsCiAgICAgICAgYm9vbGVh\nbiBtYXBwZWRTdXBlciwgQXR0cmlidXRlcyBhdHRycykKICAgICAgICB0aHJv\nd3MgU0FYRXhjZXB0aW9uIHsKICAgIH0KCiAgICAvKioKICAgICAqIEltcGxl\nbWVudCB0byBmaW5hbGl6ZSBjbGFzcyBtYXBwaW5nLgogICAgICovCiAgICBw\ncm90ZWN0ZWQgdm9pZCBlbmRDbGFzc01hcHBpbmcoQ2xhc3NNZXRhRGF0YSBt\nYXBwaW5nKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24gewogICAgfQoK\nICAgIC8qKgogICAgICogRGVmYXVsdCBhY2Nlc3MgZWxlbWVudC4KICAgICAq\nLwogICAgcHJpdmF0ZSB2b2lkIGVuZEFjY2VzcygpIHsKICAgICAgICBfYWNj\nZXNzID0gdG9BY2Nlc3NUeXBlKGN1cnJlbnRUZXh0KCkpOwogICAgfQoKICAg\nIC8qKgogICAgICogUGFyc2UgdGhlIGdpdmVuIHN0cmluZyBhcyBhbiBlbnRp\ndHkgYWNjZXNzIHR5cGUsIGRlZmF1bHRpbmcgdG8gZ2l2ZW4KICAgICAqIGRl\nZmF1bHQgaWYgc3RyaW5nIGlzIGVtcHR5LgogICAgICovCiAgICBwcml2YXRl\nIGludCB0b0FjY2Vzc1R5cGUoU3RyaW5nIHN0cikgewogICAgICAgIGlmIChT\ndHJpbmdVdGlscy5pc0VtcHR5KHN0cikpCiAgICAgICAgICAgIHJldHVybiBB\nY2Nlc3NDb2RlLlVOS05PV047CiAgICAgICAgaWYgKCJQUk9QRVJUWSIuZXF1\nYWxzKHN0cikpCiAgICAgICAgICAgIHJldHVybiBBY2Nlc3NDb2RlLkVYUExJ\nQ0lUIHwgQWNjZXNzQ29kZS5QUk9QRVJUWTsKICAgICAgICByZXR1cm4gQWNj\nZXNzQ29kZS5FWFBMSUNJVCB8IEFjY2Vzc0NvZGUuRklFTEQ7CiAgICB9CiAg\nICAvKioKICAgICAqIFBhcnNlIGZsdXNoLW1vZGUgZWxlbWVudC4KICAgICAq\nLwogICAgcHJpdmF0ZSBib29sZWFuIHN0YXJ0Rmx1c2hNb2RlKEF0dHJpYnV0\nZXMgYXR0cnMpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAg\nICAgTG9nIGxvZyA9IGdldExvZygpOwogICAgICAgIGlmIChsb2cuaXNXYXJu\nRW5hYmxlZCgpKQogICAgICAgICAgICBsb2cud2FybihfbG9jLmdldCgidW5z\ndXBwb3J0ZWQiLCAiZmx1c2gtbW9kZSIsIGdldFNvdXJjZU5hbWUoKSkpOwog\nICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICAvKioKICAgICAqIFBh\ncnNlIHNlcXVlbmNlLWdlbmVyYXRvci4KICAgICAqLwogICAgcHJvdGVjdGVk\nIGJvb2xlYW4gc3RhcnRTZXF1ZW5jZUdlbmVyYXRvcihBdHRyaWJ1dGVzIGF0\ndHJzKSB7CiAgICAgICAgaWYgKCFpc01hcHBpbmdPdmVycmlkZU1vZGUoKSkK\nICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoKICAgICAgICBTdHJpbmcgbmFt\nZSA9IGF0dHJzLmdldFZhbHVlKCJuYW1lIik7CiAgICAgICAgTG9nIGxvZyA9\nIGdldExvZygpOwogICAgICAgIGlmIChsb2cuaXNUcmFjZUVuYWJsZWQoKSkK\nICAgICAgICAgICAgbG9nLnRyYWNlKF9sb2MuZ2V0KCJwYXJzZS1zZXF1ZW5j\nZSIsIG5hbWUpKTsKCiAgICAgICAgU2VxdWVuY2VNZXRhRGF0YSBtZXRhID0g\nZ2V0UmVwb3NpdG9yeSgpLmdldENhY2hlZFNlcXVlbmNlTWV0YURhdGEobmFt\nZSk7CiAgICAgICAgaWYgKG1ldGEgIT0gbnVsbCAmJiBsb2cuaXNXYXJuRW5h\nYmxlZCgpKQogICAgICAgICAgICBsb2cud2FybihfbG9jLmdldCgib3ZlcnJp\nZGUtc2VxdWVuY2UiLCBuYW1lKSk7CgogICAgICAgIG1ldGEgPSBnZXRSZXBv\nc2l0b3J5KCkuYWRkU2VxdWVuY2VNZXRhRGF0YShuYW1lKTsKICAgICAgICBT\ndHJpbmcgc2VxID0gYXR0cnMuZ2V0VmFsdWUoInNlcXVlbmNlLW5hbWUiKTsK\nICAgICAgICBTdHJpbmcgdmFsID0gYXR0cnMuZ2V0VmFsdWUoImluaXRpYWwt\ndmFsdWUiKTsKICAgICAgICBpbnQgaW5pdGlhbCA9IHZhbCA9PSBudWxsID8g\nMSA6IEludGVnZXIucGFyc2VJbnQodmFsKTsKICAgICAgICB2YWwgPSBhdHRy\ncy5nZXRWYWx1ZSgiYWxsb2NhdGlvbi1zaXplIik7CiAgICAgICAgaW50IGFs\nbG9jYXRlID0gdmFsID09IG51bGwgPyA1MCA6IEludGVnZXIucGFyc2VJbnQo\ndmFsKTsKICAgICAgICBTdHJpbmcgc2NoZW1hID0gYXR0cnMuZ2V0VmFsdWUo\nInNjaGVtYSIpOwogICAgICAgIFN0cmluZyBjYXRhbG9nID0gYXR0cnMuZ2V0\nVmFsdWUoImNhdGFsb2ciKTsKCiAgICAgICAgU3RyaW5nIGNsc05hbWUsIHBy\nb3BzOwogICAgICAgIGlmIChzZXEgPT0gbnVsbCB8fCBzZXEuaW5kZXhPZign\nKCcpID09IC0xKSB7CiAgICAgICAgICAgIGNsc05hbWUgPSBTZXF1ZW5jZU1l\ndGFEYXRhLklNUExfTkFUSVZFOwogICAgICAgICAgICBwcm9wcyA9IG51bGw7\nCiAgICAgICAgfSBlbHNlIHsgLy8gcGx1Z2luCiAgICAgICAgICAgIGNsc05h\nbWUgPSBDb25maWd1cmF0aW9ucy5nZXRDbGFzc05hbWUoc2VxKTsKICAgICAg\nICAgICAgcHJvcHMgPSBDb25maWd1cmF0aW9ucy5nZXRQcm9wZXJ0aWVzKHNl\ncSk7CiAgICAgICAgICAgIHNlcSA9IG51bGw7CiAgICAgICAgfQoKICAgICAg\nICBtZXRhLnNldFNlcXVlbmNlUGx1Z2luKENvbmZpZ3VyYXRpb25zLmdldFBs\ndWdpbihjbHNOYW1lLCBwcm9wcykpOwogICAgICAgIG1ldGEuc2V0U2VxdWVu\nY2Uoc2VxKTsKICAgICAgICBtZXRhLnNldEluaXRpYWxWYWx1ZShpbml0aWFs\nKTsKICAgICAgICBtZXRhLnNldEFsbG9jYXRlKGFsbG9jYXRlKTsKICAgICAg\nICBtZXRhLnNldFNjaGVtYShzY2hlbWEpOwogICAgICAgIG1ldGEuc2V0Q2F0\nYWxvZyhjYXRhbG9nKTsKCiAgICAgICAgT2JqZWN0IGN1ciA9IGN1cnJlbnRF\nbGVtZW50KCk7CiAgICAgICAgT2JqZWN0IHNjb3BlID0gKGN1ciBpbnN0YW5j\nZW9mIENsYXNzTWV0YURhdGEpCiAgICAgICAgICAgID8gKChDbGFzc01ldGFE\nYXRhKSBjdXIpLmdldERlc2NyaWJlZFR5cGUoKSA6IG51bGw7CiAgICAgICAg\nbWV0YS5zZXRTb3VyY2UoZ2V0U291cmNlRmlsZSgpLCBzY29wZSwgU291cmNl\nVHJhY2tlci5TUkNfWE1MKTsKICAgICAgICBMb2NhdG9yIGxvY2F0b3IgPSBn\nZXRMb2NhdGlvbigpLmdldExvY2F0b3IoKTsKICAgICAgICBpZiAobG9jYXRv\nciAhPSBudWxsKSB7CiAgICAgICAgICAgIG1ldGEuc2V0TGluZU51bWJlcihO\ndW1iZXJzLnZhbHVlT2YobG9jYXRvci5nZXRMaW5lTnVtYmVyKCkpKTsKICAg\nICAgICAgICAgbWV0YS5zZXRDb2xOdW1iZXIoTnVtYmVycy52YWx1ZU9mKGxv\nY2F0b3IuZ2V0Q29sdW1uTnVtYmVyKCkpKTsKICAgICAgICB9CiAgICAgICAg\ncmV0dXJuIHRydWU7CiAgICB9CgogICAgcHJvdGVjdGVkIHZvaWQgZW5kU2Vx\ndWVuY2VHZW5lcmF0b3IoKSB7CiAgICB9CgogICAgLyoqCiAgICAgKiBQYXJz\nZSBpZC4KICAgICAqLwogICAgcHJvdGVjdGVkIGJvb2xlYW4gc3RhcnRJZChB\ndHRyaWJ1dGVzIGF0dHJzKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24g\newogICAgICAgIEZpZWxkTWV0YURhdGEgZm1kID0gcGFyc2VGaWVsZChhdHRy\ncyk7CiAgICAgICAgZm1kLnNldEV4cGxpY2l0KHRydWUpOwogICAgICAgIGZt\nZC5zZXRQcmltYXJ5S2V5KHRydWUpOwogICAgICAgIHJldHVybiB0cnVlOwog\nICAgfQoKICAgIHByb3RlY3RlZCB2b2lkIGVuZElkKCkKICAgICAgICB0aHJv\nd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICBmaW5pc2hGaWVsZCgpOwogICAg\nfQoKICAgIC8qKgogICAgICogUGFyc2UgZW1iZWRkZWQtaWQuCiAgICAgKi8K\nICAgIHByb3RlY3RlZCBib29sZWFuIHN0YXJ0RW1iZWRkZWRJZChBdHRyaWJ1\ndGVzIGF0dHJzKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24gewogICAg\nICAgIEZpZWxkTWV0YURhdGEgZm1kID0gcGFyc2VGaWVsZChhdHRycyk7CiAg\nICAgICAgZm1kLnNldEV4cGxpY2l0KHRydWUpOwogICAgICAgIGZtZC5zZXRQ\ncmltYXJ5S2V5KHRydWUpOwogICAgICAgIGZtZC5zZXRFbWJlZGRlZCh0cnVl\nKTsKICAgICAgICBpZiAoZm1kLmdldEVtYmVkZGVkTWV0YURhdGEoKSA9PSBu\ndWxsKQovLyAgICAgICAgICAgIGZtZC5hZGRFbWJlZGRlZE1ldGFEYXRhKCk7\nCiAgICAgICAgICAgIGRlZmVyRW1iZWRkYWJsZShmbWQuZ2V0RGVjbGFyZWRU\neXBlKCksIGZtZCk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAg\ncHJvdGVjdGVkIHZvaWQgZW5kRW1iZWRkZWRJZCgpCiAgICAgICAgdGhyb3dz\nIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgZmluaXNoRmllbGQoKTsKICAgIH0K\nCiAgICAvKioKICAgICAqIFBhcnNlIGlkLWNsYXNzLgogICAgICovCiAgICBw\ncm90ZWN0ZWQgYm9vbGVhbiBzdGFydElkQ2xhc3MoQXR0cmlidXRlcyBhdHRy\ncykKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICBpZiAo\nIWlzTWV0YURhdGFNb2RlKCkpCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsK\nCiAgICAgICAgQ2xhc3NNZXRhRGF0YSBtZXRhID0gKENsYXNzTWV0YURhdGEp\nIGN1cnJlbnRFbGVtZW50KCk7CiAgICAgICAgU3RyaW5nIGNscyA9IGF0dHJz\nLmdldFZhbHVlKCJjbGFzcyIpOwogICAgICAgIENsYXNzPD8+IGlkQ2xzID0g\nbnVsbDsKICAgICAgICB0cnkgewogICAgICAgICAgICBpZENscyA9IGNsYXNz\nRm9yTmFtZShjbHMpOwogICAgICAgIH0gY2F0Y2ggKFRocm93YWJsZSB0KSB7\nCiAgICAgICAgICAgIHRocm93IGdldEV4Y2VwdGlvbihfbG9jLmdldCgiaW52\nYWxpZC1pZC1jbGFzcyIsIG1ldGEsIGNscyksIHQpOwogICAgICAgIH0KICAg\nICAgICBtZXRhLnNldE9iamVjdElkVHlwZShpZENscywgdHJ1ZSk7CiAgICAg\nICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgcHJvdGVjdGVkIHZvaWQgZW5k\nSWRDbGFzcygpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBQYXJzZSBsb2IuCiAgICAgKi8KICAgIHByb3Rl\nY3RlZCBib29sZWFuIHN0YXJ0TG9iKEF0dHJpYnV0ZXMgYXR0cnMpCiAgICAg\nICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgRmllbGRNZXRhRGF0\nYSBmbWQgPSAoRmllbGRNZXRhRGF0YSkgY3VycmVudEVsZW1lbnQoKTsKICAg\nICAgICBpbnQgdHlwZUNvZGUgPSBmbWQuaXNFbGVtZW50Q29sbGVjdGlvbigp\nID8gZm1kLmdldEVsZW1lbnQoKS5nZXREZWNsYXJlZFR5cGVDb2RlKCkgOiBm\nbWQuZ2V0RGVjbGFyZWRUeXBlQ29kZSgpOwogICAgICAgIENsYXNzIHR5cGUg\nPSBmbWQuaXNFbGVtZW50Q29sbGVjdGlvbigpID8gZm1kLmdldEVsZW1lbnQo\nKS5nZXREZWNsYXJlZFR5cGUoKSA6IGZtZC5nZXREZWNsYXJlZFR5cGUoKTsK\nICAgICAgICBpZiAodHlwZUNvZGUgIT0gSmF2YVR5cGVzLlNUUklORwogICAg\nICAgICAgICAmJiB0eXBlICE9IGNoYXJbXS5jbGFzcwogICAgICAgICAgICAm\nJiB0eXBlICE9IENoYXJhY3RlcltdLmNsYXNzCiAgICAgICAgICAgICYmIHR5\ncGUgIT0gYnl0ZVtdLmNsYXNzCiAgICAgICAgICAgICYmIHR5cGUgIT0gQnl0\nZVtdLmNsYXNzKQogICAgICAgICAgICBmbWQuc2V0U2VyaWFsaXplZCh0cnVl\nKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBwcm90ZWN0ZWQg\ndm9pZCBlbmRMb2IoKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24gewog\nICAgfQoKICAgIC8qKgogICAgICogUGFyc2UgZ2VuZXJhdGVkLXZhbHVlLgog\nICAgICovCiAgICBwcm90ZWN0ZWQgYm9vbGVhbiBzdGFydEdlbmVyYXRlZFZh\nbHVlKEF0dHJpYnV0ZXMgYXR0cnMpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2Vw\ndGlvbiB7CiAgICAgICAgaWYgKCFpc01hcHBpbmdPdmVycmlkZU1vZGUoKSkK\nICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoKICAgICAgICBTdHJpbmcgc3Ry\nYXRlZ3kgPSBhdHRycy5nZXRWYWx1ZSgic3RyYXRlZ3kiKTsKICAgICAgICBT\ndHJpbmcgZ2VuZXJhdG9yID0gYXR0cnMuZ2V0VmFsdWUoImdlbmVyYXRvciIp\nOwogICAgICAgIEdlbmVyYXRpb25UeXBlIHR5cGUgPSBTdHJpbmdVdGlscy5p\nc0VtcHR5KHN0cmF0ZWd5KQogICAgICAgICAgICA/IEdlbmVyYXRpb25UeXBl\nLkFVVE8gOiBHZW5lcmF0aW9uVHlwZS52YWx1ZU9mKHN0cmF0ZWd5KTsKCiAg\nICAgICAgRmllbGRNZXRhRGF0YSBmbWQgPSAoRmllbGRNZXRhRGF0YSkgY3Vy\ncmVudEVsZW1lbnQoKTsKICAgICAgICBBbm5vdGF0aW9uUGVyc2lzdGVuY2VN\nZXRhRGF0YVBhcnNlci5wYXJzZUdlbmVyYXRlZFZhbHVlKGZtZCwgdHlwZSwK\nICAgICAgICAgICAgZ2VuZXJhdG9yKTsKICAgICAgICByZXR1cm4gdHJ1ZTsK\nICAgIH0KCiAgICBwcm90ZWN0ZWQgdm9pZCBlbmRHZW5lcmF0ZWRWYWx1ZSgp\nCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBMYXppbHkgcGFyc2UgY2FzY2FkZXMuCiAgICAgKi8KICAgIHBy\nb3RlY3RlZCBib29sZWFuIHN0YXJ0Q2FzY2FkZShPYmplY3QgdGFnLCBBdHRy\naWJ1dGVzIGF0dHJzKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24gewog\nICAgICAgIGlmICghaXNNZXRhRGF0YU1vZGUoKSkKICAgICAgICAgICAgcmV0\ndXJuIGZhbHNlOwoKICAgICAgICBTZXQ8Q2FzY2FkZVR5cGU+IGNhc2NhZGVz\nID0gbnVsbDsKICAgICAgICBpZiAoY3VycmVudEVsZW1lbnQoKSBpbnN0YW5j\nZW9mIEZpZWxkTWV0YURhdGEpIHsKICAgICAgICAgICAgaWYgKF9jYXNjYWRl\ncyA9PSBudWxsKQogICAgICAgICAgICAgICAgX2Nhc2NhZGVzID0gRW51bVNl\ndC5ub25lT2YoQ2FzY2FkZVR5cGUuY2xhc3MpOwogICAgICAgICAgICBjYXNj\nYWRlcyA9IF9jYXNjYWRlczsKICAgICAgICB9IGVsc2UgewogICAgICAgICAg\nICBpZiAoX3BrZ0Nhc2NhZGVzID09IG51bGwpCiAgICAgICAgICAgICAgICBf\ncGtnQ2FzY2FkZXMgPSBFbnVtU2V0Lm5vbmVPZihDYXNjYWRlVHlwZS5jbGFz\ncyk7CiAgICAgICAgICAgIGNhc2NhZGVzID0gX3BrZ0Nhc2NhZGVzOwogICAg\nICAgIH0KICAgICAgICBib29sZWFuIGFsbCA9IEVMRU1fQ0FTQ0FERV9BTEwg\nPT0gdGFnOwogICAgICAgIGlmIChhbGwgfHwgRUxFTV9DQVNDQURFX1BFUiA9\nPSB0YWcpCiAgICAgICAgICAgIGNhc2NhZGVzLmFkZChQRVJTSVNUKTsKICAg\nICAgICBpZiAoYWxsIHx8IEVMRU1fQ0FTQ0FERV9SRU0gPT0gdGFnKQogICAg\nICAgICAgICBjYXNjYWRlcy5hZGQoUkVNT1ZFKTsKICAgICAgICBpZiAoYWxs\nIHx8IEVMRU1fQ0FTQ0FERV9NRVIgPT0gdGFnKQogICAgICAgICAgICBjYXNj\nYWRlcy5hZGQoTUVSR0UpOwogICAgICAgIGlmIChhbGwgfHwgRUxFTV9DQVND\nQURFX1JFRiA9PSB0YWcpCiAgICAgICAgICAgIGNhc2NhZGVzLmFkZChSRUZS\nRVNIKTsKICAgICAgICBpZiAoYWxsIHx8IEVMRU1fQ0FTQ0FERV9ERVQgPT0g\ndGFnKQogICAgICAgICAgICBjYXNjYWRlcy5hZGQoREVUQUNIKTsKICAgICAg\nICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvKioKICAgICAqIFNldCB0aGUg\nY2FjaGVkIGNhc2NhZGVzIGludG8gdGhlIGZpZWxkLgogICAgICovCiAgICBw\ncm90ZWN0ZWQgdm9pZCBzZXRDYXNjYWRlcyhGaWVsZE1ldGFEYXRhIGZtZCkg\newogICAgICAgIFNldDxDYXNjYWRlVHlwZT4gY2FzY2FkZXMgPSBfY2FzY2Fk\nZXM7CiAgICAgICAgaWYgKF9jYXNjYWRlcyA9PSBudWxsKQogICAgICAgICAg\nICBjYXNjYWRlcyA9IF9wa2dDYXNjYWRlczsKICAgICAgICBpZiAoY2FzY2Fk\nZXMgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuOwoKICAgICAgICBWYWx1\nZU1ldGFEYXRhIHZtZCA9IGZtZDsKICAgICAgICBzd2l0Y2ggKF9zdHJhdGVn\neSkgewogICAgICAgICAgICBjYXNlIE9ORV9NQU5ZOgogICAgICAgICAgICBj\nYXNlIE1BTllfTUFOWToKICAgICAgICAgICAgICAgIHZtZCA9IGZtZC5nZXRF\nbGVtZW50KCk7CiAgICAgICAgfQogICAgICAgIGZvciAoQ2FzY2FkZVR5cGUg\nY2FzY2FkZSA6IGNhc2NhZGVzKSB7CiAgICAgICAgICAgIHN3aXRjaCAoY2Fz\nY2FkZSkgewogICAgICAgICAgICAgICAgY2FzZSBQRVJTSVNUOgogICAgICAg\nICAgICAgICAgICAgIHZtZC5zZXRDYXNjYWRlUGVyc2lzdChWYWx1ZU1ldGFE\nYXRhLkNBU0NBREVfSU1NRURJQVRFKTsKICAgICAgICAgICAgICAgICAgICBi\ncmVhazsKICAgICAgICAgICAgICAgIGNhc2UgTUVSR0U6CiAgICAgICAgICAg\nICAgICAgICAgdm1kLnNldENhc2NhZGVBdHRhY2goVmFsdWVNZXRhRGF0YS5D\nQVNDQURFX0lNTUVESUFURSk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7\nCiAgICAgICAgICAgICAgICBjYXNlIERFVEFDSDoKICAgICAgICAgICAgICAg\nICAgICB2bWQuc2V0Q2FzY2FkZURldGFjaChWYWx1ZU1ldGFEYXRhLkNBU0NB\nREVfSU1NRURJQVRFKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAg\nICAgICAgICAgICAgIGNhc2UgUkVNT1ZFOgogICAgICAgICAgICAgICAgICAg\nIHZtZC5zZXRDYXNjYWRlRGVsZXRlKFZhbHVlTWV0YURhdGEuQ0FTQ0FERV9J\nTU1FRElBVEUpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAg\nICAgICAgICAgY2FzZSBSRUZSRVNIOgogICAgICAgICAgICAgICAgICAgIHZt\nZC5zZXRDYXNjYWRlUmVmcmVzaChWYWx1ZU1ldGFEYXRhLkNBU0NBREVfSU1N\nRURJQVRFKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAg\nICAgfQogICAgICAgIH0KICAgICAgICBfY2FzY2FkZXMgPSBudWxsOwogICAg\nfQoKICAgIC8qKgogICAgICogUGFyc2UgY29tbW9uIGZpZWxkIGF0dHJpYnV0\nZXMuCiAgICAgKi8KICAgIHByaXZhdGUgRmllbGRNZXRhRGF0YSBwYXJzZUZp\nZWxkKEF0dHJpYnV0ZXMgYXR0cnMpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2Vw\ndGlvbiB7CiAgICAgICAgQ2xhc3NNZXRhRGF0YSBtZXRhID0gKENsYXNzTWV0\nYURhdGEpIGN1cnJlbnRFbGVtZW50KCk7CiAgICAgICAgU3RyaW5nIG5hbWUg\nPSBhdHRycy5nZXRWYWx1ZSgibmFtZSIpOwogICAgICAgIEZpZWxkTWV0YURh\ndGEgZmllbGQgPSBtZXRhLmdldERlY2xhcmVkRmllbGQobmFtZSk7CiAgICAg\nICAgaW50IGZsZEFjY2VzcyA9IGdldEZpZWxkQWNjZXNzKGZpZWxkLCBhdHRy\ncyk7CiAgICAgICAgLy8gSWYgdGhlIGFjY2VzcyBkZWZpbmVkIGluIFhNTCBp\ncyBub3QgdGhlIHNhbWUgYXMgd2hhdCB3YXMgZGVmaW5lZAogICAgICAgIC8v\nIGJ5IGRlZmF1bHQgb3IgYW5ub3RhdGlvbiwgZmluZCB0aGUgYXBwcm9wcmlh\ndGUgYmFja2luZyBtZW1iZXIgYW5kIAogICAgICAgIC8vIHJlcGxhY2Ugd2hh\ndCBpcyBjdXJyZW50bHkgZGVmaW5lZCBpbiBtZXRhZGF0YS4KICAgICAgICBp\nZiAoKGZpZWxkID09IG51bGwgfHwgZmllbGQuZ2V0RGVjbGFyZWRUeXBlKCkg\nPT0gT2JqZWN0LmNsYXNzIHx8CiAgICAgICAgICAgICBmaWVsZC5nZXRBY2Nl\nc3NUeXBlKCkgIT0gZmxkQWNjZXNzKQogICAgICAgICAgICAmJiBtZXRhLmdl\ndERlc2NyaWJlZFR5cGUoKSAhPSBPYmplY3QuY2xhc3MpIHsKICAgICAgICAg\nICAgTWVtYmVyIG1lbWJlciA9IF9yZXBvcy5nZXRNZXRhRGF0YUZhY3Rvcnko\nKS5nZXREZWZhdWx0cygpCiAgICAgCSAgICAgICAgLmdldE1lbWJlckJ5UHJv\ncGVydHkobWV0YSwgbmFtZSwgZmxkQWNjZXNzLCBmYWxzZSk7CiAgICAgICAg\nICAgIENsYXNzPD8+IHR5cGUgPSBGaWVsZC5jbGFzcy5pc0luc3RhbmNlKG1l\nbWJlcikgPyAKICAgICAgICAgICAgICAgICgoRmllbGQpbWVtYmVyKS5nZXRU\neXBlKCkgOiAoKE1ldGhvZCltZW1iZXIpLmdldFJldHVyblR5cGUoKTsKCiAg\nICAgICAgICAgIGlmIChmaWVsZCA9PSBudWxsKSB7CiAgICAgICAgICAgICAg\nICBmaWVsZCA9IG1ldGEuYWRkRGVjbGFyZWRGaWVsZChuYW1lLCB0eXBlKTsK\nICAgICAgICAgICAgICAgIFBlcnNpc3RlbmNlTWV0YURhdGFEZWZhdWx0cy5z\nZXRDYXNjYWRlTm9uZShmaWVsZCk7CiAgICAgICAgICAgICAgICBQZXJzaXN0\nZW5jZU1ldGFEYXRhRGVmYXVsdHMuc2V0Q2FzY2FkZU5vbmUoZmllbGQuZ2V0\nS2V5KCkpOwogICAgICAgICAgICAgICAgUGVyc2lzdGVuY2VNZXRhRGF0YURl\nZmF1bHRzLnNldENhc2NhZGVOb25lKGZpZWxkLmdldEVsZW1lbnQoKSk7CiAg\nICAgICAgICAgIH0KICAgICAgICAgICAgZmllbGQuYmFja2luZ01lbWJlciht\nZW1iZXIpOwogICAgICAgIH0gZWxzZSBpZiAoZmllbGQgPT0gbnVsbCkgewog\nICAgICAgICAgICBmaWVsZCA9IG1ldGEuYWRkRGVjbGFyZWRGaWVsZChuYW1l\nLCBPYmplY3QuY2xhc3MpOwogICAgICAgICAgICBQZXJzaXN0ZW5jZU1ldGFE\nYXRhRGVmYXVsdHMuc2V0Q2FzY2FkZU5vbmUoZmllbGQpOwogICAgICAgICAg\nICBQZXJzaXN0ZW5jZU1ldGFEYXRhRGVmYXVsdHMuc2V0Q2FzY2FkZU5vbmUo\nZmllbGQuZ2V0S2V5KCkpOwogICAgICAgICAgICBQZXJzaXN0ZW5jZU1ldGFE\nYXRhRGVmYXVsdHMuc2V0Q2FzY2FkZU5vbmUoZmllbGQuZ2V0RWxlbWVudCgp\nKTsKICAgICAgICB9CgogICAgICAgIGlmIChpc01ldGFEYXRhTW9kZSgpKQog\nICAgICAgICAgICBmaWVsZC5zZXRMaXN0aW5nSW5kZXgoX2ZpZWxkUG9zKTsK\nCiAgICAgICAgX2ZpZWxkUG9zKys7CiAgICAgICAgcHVzaEVsZW1lbnQoZmll\nbGQpOwogICAgICAgIGFkZENvbW1lbnRzKGZpZWxkKTsKCiAgICAgICAgaWYg\nKGlzTWFwcGluZ092ZXJyaWRlTW9kZSgpKQogICAgICAgICAgICBzdGFydEZp\nZWxkTWFwcGluZyhmaWVsZCwgYXR0cnMpOwogICAgICAgIHJldHVybiBmaWVs\nZDsKICAgIH0KCiAgICAvKioKICAgICAqIFBvcHMgZmllbGQgZWxlbWVudC4K\nICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIGZpbmlzaEZpZWxkKCkKICAgICAg\nICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICBGaWVsZE1ldGFEYXRh\nIGZpZWxkID0gKEZpZWxkTWV0YURhdGEpIHBvcEVsZW1lbnQoKTsKICAgICAg\nICBzZXRDYXNjYWRlcyhmaWVsZCk7CiAgICAgICAgaWYgKGlzTWFwcGluZ092\nZXJyaWRlTW9kZSgpKQogICAgICAgICAgICBlbmRGaWVsZE1hcHBpbmcoZmll\nbGQpOwogICAgICAgIF9zdHJhdGVneSA9IG51bGw7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBEZXRlcm1pbmVzIGFjY2VzcyBmb3IgZmllbGQgYmFzZWQgdXBv\nbiBleGlzdGluZyBtZXRhZGF0YSBhbmQgWE1MIAogICAgICogYXR0cmlidXRl\ncy4KICAgICAqIAogICAgICogQHBhcmFtIGZpZWxkIEZpZWxkTWV0YURhdGEg\nY3VycmVudCBtZXRhZGF0YSBmb3IgZmllbGQKICAgICAqIEBwYXJhbSBhdHRy\ncyBYTUwgQXR0cmlidXRlcyBkZWZpbmVkIG9uIHRoaXMgZmllbGQKICAgICAq\nIEByZXR1cm4KICAgICAqLwogICAgcHJpdmF0ZSBpbnQgZ2V0RmllbGRBY2Nl\nc3MoRmllbGRNZXRhRGF0YSBmaWVsZCwgQXR0cmlidXRlcyBhdHRycykgewog\nICAgICAgIGlmIChhdHRycyAhPSBudWxsKSB7CiAgICAgICAgICAgIFN0cmlu\nZyBhY2Nlc3MgPSBhdHRycy5nZXRWYWx1ZSgiYWNjZXNzIik7CiAgICAgICAg\nICAgIGlmICgiUFJPUEVSVFkiLmVxdWFscyhhY2Nlc3MpKQogICAgICAgICAg\nICAgICAgcmV0dXJuIEFjY2Vzc0NvZGUuRVhQTElDSVQgfCBBY2Nlc3NDb2Rl\nLlBST1BFUlRZOwogICAgICAgICAgICBpZiAoIkZJRUxEIi5lcXVhbHMoYWNj\nZXNzKSkKICAgICAgICAgICAgICAgIHJldHVybiBBY2Nlc3NDb2RlLkVYUExJ\nQ0lUIHwgQWNjZXNzQ29kZS5GSUVMRDsKICAgICAgICB9CiAgICAgICAgLy8g\nQ2hlY2sgYWNjZXNzIGRlZmluZWQgb24gZmllbGQsIGlmIHByb3ZpZGVkCiAg\nICAgICAgaWYgKGZpZWxkICE9IG51bGwpIHsKICAgICAgICAgICAgcmV0dXJu\nIGZpZWxkLmdldEFjY2Vzc1R5cGUoKTsKICAgICAgICB9CiAgICAgICAgLy8g\nT3RoZXJ3aXNlLCBnZXQgdGhlIGRlZmF1bHQgYWNjZXNzIHR5cGUgb2YgdGhl\nIGRlY2xhcmluZyBjbGFzcwogICAgICAgIENsYXNzTWV0YURhdGEgbWV0YSA9\nIChDbGFzc01ldGFEYXRhKSBjdXJyZW50RWxlbWVudCgpOwogICAgICAgIGlm\nIChtZXRhICE9IG51bGwpIHsKICAgICAgICAgICAgcmV0dXJuIEFjY2Vzc0Nv\nZGUudG9GaWVsZENvZGUobWV0YS5nZXRBY2Nlc3NUeXBlKCkpOwogICAgICAg\nIH0KICAgICAgICByZXR1cm4gQWNjZXNzQ29kZS5VTktOT1dOOwogICAgfQog\nICAgCiAgICAvKioKICAgICAqIEltcGxlbWVudCB0byBhZGQgZmllbGQgbWFw\ncGluZyBkYXRhLiBEb2VzIG5vdGhpbmcgYnkgZGVmYXVsdC4KICAgICAqLwog\nICAgcHJvdGVjdGVkIHZvaWQgc3RhcnRGaWVsZE1hcHBpbmcoRmllbGRNZXRh\nRGF0YSBmaWVsZCwgQXR0cmlidXRlcyBhdHRycykKICAgICAgICB0aHJvd3Mg\nU0FYRXhjZXB0aW9uIHsKICAgIH0KCiAgICAvKioKICAgICAqIEltcGxlbWVu\ndCB0byBmaW5hbGl6ZSBmaWVsZCBtYXBwaW5nLiBEb2VzIG5vdGhpbmcgYnkg\nZGVmYXVsdC4KICAgICAqLwogICAgcHJvdGVjdGVkIHZvaWQgZW5kRmllbGRN\nYXBwaW5nKEZpZWxkTWV0YURhdGEgZmllbGQpCiAgICAgICAgdGhyb3dzIFNB\nWEV4Y2VwdGlvbiB7CiAgICB9CgogICAgLyoqCiAgICAgKiBQYXJzZSB2ZXJz\naW9uLgogICAgICovCiAgICBwcm90ZWN0ZWQgYm9vbGVhbiBzdGFydFZlcnNp\nb24oQXR0cmlidXRlcyBhdHRycykKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0\naW9uIHsKICAgICAgICBGaWVsZE1ldGFEYXRhIGZtZCA9IHBhcnNlRmllbGQo\nYXR0cnMpOwogICAgICAgIGZtZC5zZXRFeHBsaWNpdCh0cnVlKTsKICAgICAg\nICBmbWQuc2V0VmVyc2lvbih0cnVlKTsKICAgICAgICByZXR1cm4gdHJ1ZTsK\nICAgIH0KCiAgICBwcm90ZWN0ZWQgdm9pZCBlbmRWZXJzaW9uKCkKICAgICAg\nICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICBmaW5pc2hGaWVsZCgp\nOwogICAgfQoKICAgIC8qKgogICAgICogUGFyc2Ugc3RyYXRlZ3kgZWxlbWVu\ndC4KICAgICAqLwogICAgcHJpdmF0ZSBib29sZWFuIHN0YXJ0U3RyYXRlZ3ko\nUGVyc2lzdGVuY2VTdHJhdGVneSBzdHJhdGVneSwKICAgICAgICBBdHRyaWJ1\ndGVzIGF0dHJzKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24gewogICAg\nICAgIEZpZWxkTWV0YURhdGEgZm1kID0gcGFyc2VGaWVsZChhdHRycyk7CiAg\nICAgICAgZm1kLnNldEV4cGxpY2l0KHRydWUpOwogICAgICAgIGZtZC5zZXRN\nYW5hZ2VtZW50KEZpZWxkTWV0YURhdGEuTUFOQUdFX1BFUlNJU1RFTlQpOwoK\nICAgICAgICBTdHJpbmcgdmFsID0gYXR0cnMuZ2V0VmFsdWUoIm9wdGlvbmFs\nIik7CiAgICAgICAgaWYgKCJmYWxzZSIuZXF1YWxzKHZhbCkpCiAgICAgICAg\nICAgIGZtZC5zZXROdWxsVmFsdWUoRmllbGRNZXRhRGF0YS5OVUxMX0VYQ0VQ\nVElPTik7CiAgICAgICAgZWxzZSBpZiAoInRydWUiLmVxdWFscyh2YWwpCiAg\nICAgICAgICAgICAgICAmJiBmbWQuZ2V0TnVsbFZhbHVlKCkgPT0gRmllbGRN\nZXRhRGF0YS5OVUxMX0VYQ0VQVElPTikgewogICAgICAgICAgICAvLyBSZXNl\ndCB2YWx1ZSBpZiB0aGUgZmllbGQgd2FzIGFubm90YXRlZCB3aXRoIG9wdGlv\nbmFsPWZhbHNlLiAKICAgICAgICAgICAgLy8gT3RoZXJ3aXNlIGxlYXZlIGl0\nIGFsb25lLgogICAgICAgICAgICBmbWQuc2V0TnVsbFZhbHVlKEZpZWxkTWV0\nYURhdGEuTlVMTF9VTlNFVCk7CiAgICAgICAgfQogICAgICAgIGlmIChpc01h\ncHBpbmdPdmVycmlkZU1vZGUoKSkgewogICAgICAgICAgICB2YWwgPSBhdHRy\ncy5nZXRWYWx1ZSgibWFwcGVkLWJ5Iik7CiAgICAgICAgICAgIGlmICh2YWwg\nIT0gbnVsbCkKICAgICAgICAgICAgICAgIGZtZC5zZXRNYXBwZWRCeSh2YWwp\nOwogICAgICAgIH0KICAgICAgICBwYXJzZVN0cmF0ZWd5KGZtZCwgc3RyYXRl\nZ3ksIGF0dHJzKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBw\ncml2YXRlIHZvaWQgZW5kU3RyYXRlZ3koUGVyc2lzdGVuY2VTdHJhdGVneSBz\ndHJhdGVneSkKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAg\nICBmaW5pc2hGaWVsZCgpOwogICAgfQoKICAgIC8qKgogICAgICogUGFyc2Ug\nc3RyYXRlZ3kgc3BlY2lmaWMgYXR0cmlidXRlcy4KICAgICAqLwogICAgcHJp\ndmF0ZSB2b2lkIHBhcnNlU3RyYXRlZ3koRmllbGRNZXRhRGF0YSBmbWQsCiAg\nICAgICAgUGVyc2lzdGVuY2VTdHJhdGVneSBzdHJhdGVneSwgQXR0cmlidXRl\ncyBhdHRycykKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAg\nICBzd2l0Y2ggKHN0cmF0ZWd5KSB7CiAgICAgICAgICAgIGNhc2UgQkFTSUM6\nCiAgICAgICAgICAgICAgICBwYXJzZUJhc2ljKGZtZCwgYXR0cnMpOwogICAg\nICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgRU1CRURERUQ6\nCiAgICAgICAgICAgICAgICBwYXJzZUVtYmVkZGVkKGZtZCwgYXR0cnMpOwog\nICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgT05FX09O\nRToKICAgICAgICAgICAgICAgIHBhcnNlT25lVG9PbmUoZm1kLCBhdHRycyk7\nCiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSBNQU5Z\nX09ORToKICAgICAgICAgICAgICAgIHBhcnNlTWFueVRvT25lKGZtZCwgYXR0\ncnMpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2Ug\nTUFOWV9NQU5ZOgogICAgICAgICAgICAgICAgcGFyc2VNYW55VG9NYW55KGZt\nZCwgYXR0cnMpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAg\nIGNhc2UgT05FX01BTlk6CiAgICAgICAgICAgICAgICBwYXJzZU9uZVRvTWFu\neShmbWQsIGF0dHJzKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAg\nICAgICBjYXNlIFRSQU5TSUVOVDoKICAgICAgICAgICAgICAgIFN0cmluZyB2\nYWwgPSBhdHRycy5nZXRWYWx1ZSgiZmV0Y2giKTsKICAgICAgICAgICAgICAg\nIGlmICh2YWwgIT0gbnVsbCkgewogICAgICAgICAgICAgICAgICAgIGZtZC5z\nZXRJbkRlZmF1bHRGZXRjaEdyb3VwKCJFQUdFUiIuZXF1YWxzKHZhbCkpOwog\nICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZm1kLnNldE1hbmFn\nZW1lbnQoRmllbGRNZXRhRGF0YS5NQU5BR0VfTk9ORSk7CiAgICAgICAgICAg\nICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSBFTEVNX0NPTEw6CiAgICAg\nICAgICAgICAgICBwYXJzZUVsZW1lbnRDb2xsZWN0aW9uKGZtZCwgYXR0cnMp\nOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIFBhcnNlIGJhc2lj\nLgogICAgICovCiAgICBwcm90ZWN0ZWQgdm9pZCBwYXJzZUJhc2ljKEZpZWxk\nTWV0YURhdGEgZm1kLCBBdHRyaWJ1dGVzIGF0dHJzKQogICAgICAgIHRocm93\ncyBTQVhFeGNlcHRpb24gewogICAgICAgIFN0cmluZyB2YWwgPSBhdHRycy5n\nZXRWYWx1ZSgiZmV0Y2giKTsKICAgICAgICBpZiAodmFsICE9IG51bGwpIHsK\nICAgICAgICAgICAgZm1kLnNldEluRGVmYXVsdEZldGNoR3JvdXAoIkVBR0VS\nIi5lcXVhbHModmFsKSk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAg\nICogUGFyc2UgZW1iZWRkZWQuCiAgICAgKi8KICAgIHByb3RlY3RlZCB2b2lk\nIHBhcnNlRW1iZWRkZWQoRmllbGRNZXRhRGF0YSBmbWQsIEF0dHJpYnV0ZXMg\nYXR0cnMpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAg\nYXNzZXJ0UEMoZm1kLCAiRW1iZWRkZWQiKTsKICAgICAgICBmbWQuc2V0SW5E\nZWZhdWx0RmV0Y2hHcm91cCh0cnVlKTsKICAgICAgICBmbWQuc2V0RW1iZWRk\nZWQodHJ1ZSk7CiAgICAgICAgZm1kLnNldFNlcmlhbGl6ZWQoZmFsc2UpOyAv\nLyBvdmVycmlkZSBhbnkgTG9iIGFubm90YXRpb24KICAgICAgICAKICAgICAg\nICBpZiAoZm1kLmdldEVtYmVkZGVkTWV0YURhdGEoKSA9PSBudWxsKQovLyAg\nICAgICAgICAgIGZtZC5hZGRFbWJlZGRlZE1ldGFEYXRhKCk7CiAgICAgICAg\nICAgIGRlZmVyRW1iZWRkYWJsZShmbWQuZ2V0RGVjbGFyZWRUeXBlKCksIGZt\nZCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBUaHJvdyBwcm9wZXIgZXhjZXB0\naW9uIGlmIGdpdmVuIHZhbHVlIGlzIG5vdCBwb3NzaWJseSBwZXJzaXN0ZW5j\nZQogICAgICogY2FwYWJsZS4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIGFz\nc2VydFBDKEZpZWxkTWV0YURhdGEgZm1kLCBTdHJpbmcgYXR0cikKICAgICAg\nICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICBpZiAoIUphdmFUeXBl\ncy5tYXliZVBDKGZtZCkpCiAgICAgICAgICAgIHRocm93IGdldEV4Y2VwdGlv\nbihfbG9jLmdldCgiYmFkLW1ldGEtYW5ubyIsIGZtZCwgYXR0cikpOwogICAg\nfQoKICAgIC8qKgogICAgICogUGFyc2Ugb25lLXRvLW9uZS4KICAgICAqLwog\nICAgcHJvdGVjdGVkIHZvaWQgcGFyc2VPbmVUb09uZShGaWVsZE1ldGFEYXRh\nIGZtZCwgQXR0cmlidXRlcyBhdHRycykKICAgICAgICB0aHJvd3MgU0FYRXhj\nZXB0aW9uIHsKICAgICAgICBTdHJpbmcgdmFsID0gYXR0cnMuZ2V0VmFsdWUo\nImZldGNoIik7CiAgICAgICAgaWYgKHZhbCA9PSBudWxsIHx8ICJFQUdFUiIu\nZXF1YWxzKHZhbCkpIHsKICAgICAgICAgICAgZm1kLnNldEluRGVmYXVsdEZl\ndGNoR3JvdXAodHJ1ZSk7CiAgICAgICAgfQogICAgICAgIHZhbCA9IGF0dHJz\nLmdldFZhbHVlKCJ0YXJnZXQtZW50aXR5Iik7CiAgICAgICAgaWYgKHZhbCAh\nPSBudWxsKQogICAgICAgICAgICBmbWQuc2V0VHlwZU92ZXJyaWRlKGNsYXNz\nRm9yTmFtZSh2YWwpKTsKICAgICAgICBhc3NlcnRQQyhmbWQsICJPbmVUb09u\nZSIpOwogICAgICAgIGZtZC5zZXRTZXJpYWxpemVkKGZhbHNlKTsgLy8gb3Zl\ncnJpZGUgYW55IExvYiBhbm5vdGF0aW9uCiAgICAgICAgYm9vbGVhbiBvcnBo\nYW5SZW1vdmFsID0gQm9vbGVhbi52YWx1ZU9mKGF0dHJzLmdldFZhbHVlKAog\nICAgICAgICAgICAib3JwaGFuLXJlbW92YWwiKSk7CiAgICAgICAgc2V0T3Jw\naGFuUmVtb3ZhbChmbWQsIG9ycGhhblJlbW92YWwpOwogICAgfQoKICAgIC8q\nKgogICAgICogUGFyc2UgbWFueS10by1vbmUuCiAgICAgKi8KICAgIHByb3Rl\nY3RlZCB2b2lkIHBhcnNlTWFueVRvT25lKEZpZWxkTWV0YURhdGEgZm1kLCBB\ndHRyaWJ1dGVzIGF0dHJzKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24g\newogICAgICAgIFN0cmluZyB2YWwgPSBhdHRycy5nZXRWYWx1ZSgiZmV0Y2gi\nKTsKICAgICAgICBpZiAodmFsID09IG51bGwgfHwgIkVBR0VSIi5lcXVhbHMo\ndmFsKSkgewogICAgICAgICAgICBmbWQuc2V0SW5EZWZhdWx0RmV0Y2hHcm91\ncCh0cnVlKTsKICAgICAgICB9CiAgICAgICAgdmFsID0gYXR0cnMuZ2V0VmFs\ndWUoInRhcmdldC1lbnRpdHkiKTsKICAgICAgICBpZiAodmFsICE9IG51bGwp\nCiAgICAgICAgICAgIGZtZC5zZXRUeXBlT3ZlcnJpZGUoY2xhc3NGb3JOYW1l\nKHZhbCkpOwogICAgICAgIGFzc2VydFBDKGZtZCwgIk1hbnlUb09uZSIpOwog\nICAgICAgIGZtZC5zZXRTZXJpYWxpemVkKGZhbHNlKTsgLy8gb3ZlcnJpZGUg\nYW55IExvYiBhbm5vdGF0aW9uCiAgICB9CgogICAgLyoqCiAgICAgKiBQYXJz\nZSBtYW55LXRvLW1hbnkuCiAgICAgKi8KICAgIHByb3RlY3RlZCB2b2lkIHBh\ncnNlTWFueVRvTWFueShGaWVsZE1ldGFEYXRhIGZtZCwgQXR0cmlidXRlcyBh\ndHRycykKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICBT\ndHJpbmcgdmFsID0gYXR0cnMuZ2V0VmFsdWUoImZldGNoIik7CiAgICAgICAg\naWYgKHZhbCAhPSBudWxsKSB7CiAgICAgICAgICAgIGZtZC5zZXRJbkRlZmF1\nbHRGZXRjaEdyb3VwKCJFQUdFUiIuZXF1YWxzKHZhbCkpOwogICAgICAgIH0K\nICAgICAgICB2YWwgPSBhdHRycy5nZXRWYWx1ZSgidGFyZ2V0LWVudGl0eSIp\nOwogICAgICAgIGlmICh2YWwgIT0gbnVsbCkKICAgICAgICAgICAgZm1kLmdl\ndEVsZW1lbnQoKS5zZXREZWNsYXJlZFR5cGUoY2xhc3NGb3JOYW1lKHZhbCkp\nOwogICAgICAgIGFzc2VydFBDQ29sbGVjdGlvbihmbWQsICJNYW55VG9NYW55\nIik7CiAgICAgICAgZm1kLnNldFNlcmlhbGl6ZWQoZmFsc2UpOyAvLyBvdmVy\ncmlkZSBMb2IgaW4gYW5ub3RhdGlvbgogICAgfQoKICAgIC8qKgogICAgICog\nVGhyb3cgZXhjZXB0aW9uIGlmIGdpdmVuIGZpZWxkIG5vdCBhIGNvbGxlY3Rp\nb24gb2YgcG9zc2libGUgcGVyc2lzdGVuY2UKICAgICAqIGNhcGFibGVzLgog\nICAgICovCiAgICBwcml2YXRlIHZvaWQgYXNzZXJ0UENDb2xsZWN0aW9uKEZp\nZWxkTWV0YURhdGEgZm1kLCBTdHJpbmcgYXR0cikKICAgICAgICB0aHJvd3Mg\nU0FYRXhjZXB0aW9uIHsKICAgICAgICBzd2l0Y2ggKGZtZC5nZXREZWNsYXJl\nZFR5cGVDb2RlKCkpIHsKICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuQVJS\nQVk6CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLkNPTExFQ1RJT046CiAg\nICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLk1BUDoKICAgICAgICAgICAgICAg\nIGlmIChKYXZhVHlwZXMubWF5YmVQQyhmbWQuZ2V0RWxlbWVudCgpKSkKICAg\nICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIC8vIG5v\nIGJyZWFrCiAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgICB0\naHJvdyBnZXRFeGNlcHRpb24oX2xvYy5nZXQoImJhZC1tZXRhLWFubm8iLCBm\nbWQsIGF0dHIpKTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBQ\nYXJzZSBvbmUtdG8tbWFueS4KICAgICAqLwogICAgcHJvdGVjdGVkIHZvaWQg\ncGFyc2VPbmVUb01hbnkoRmllbGRNZXRhRGF0YSBmbWQsIEF0dHJpYnV0ZXMg\nYXR0cnMpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAg\nU3RyaW5nIHZhbCA9IGF0dHJzLmdldFZhbHVlKCJmZXRjaCIpOwogICAgICAg\nIGlmICh2YWwgIT0gbnVsbCkgewogICAgICAgICAgICBmbWQuc2V0SW5EZWZh\ndWx0RmV0Y2hHcm91cCgiRUFHRVIiLmVxdWFscyh2YWwpKTsKICAgICAgICB9\nCiAgICAgICAgdmFsID0gYXR0cnMuZ2V0VmFsdWUoInRhcmdldC1lbnRpdHki\nKTsKICAgICAgICBpZiAodmFsICE9IG51bGwpCiAgICAgICAgICAgIGZtZC5n\nZXRFbGVtZW50KCkuc2V0RGVjbGFyZWRUeXBlKGNsYXNzRm9yTmFtZSh2YWwp\nKTsKICAgICAgICBhc3NlcnRQQ0NvbGxlY3Rpb24oZm1kLCAiT25lVG9NYW55\nIik7CiAgICAgICAgZm1kLnNldFNlcmlhbGl6ZWQoZmFsc2UpOyAvLyBvdmVy\ncmlkZSBhbnkgTG9iIGFubm90YXRpb24KICAgICAgICBib29sZWFuIG9ycGhh\nblJlbW92YWwgPSBCb29sZWFuLnZhbHVlT2YoYXR0cnMuZ2V0VmFsdWUoCiAg\nICAgICAgICAgICJvcnBoYW4tcmVtb3ZhbCIpKTsKICAgICAgICBzZXRPcnBo\nYW5SZW1vdmFsKGZtZC5nZXRFbGVtZW50KCksIG9ycGhhblJlbW92YWwpOwog\nICAgfQogICAgCiAgICBwcm90ZWN0ZWQgdm9pZCBzZXRPcnBoYW5SZW1vdmFs\nKFZhbHVlTWV0YURhdGEgdm1kLCBib29sZWFuIG9ycGhhblJlbW92YWwpIHsK\nICAgICAgICBpZiAob3JwaGFuUmVtb3ZhbCkgCiAgICAgICAgICAgIHZtZC5z\nZXRDYXNjYWRlRGVsZXRlKFZhbHVlTWV0YURhdGEuQ0FTQ0FERV9BVVRPKTsK\nICAgIH0KICAgIAogICAgcHJvdGVjdGVkIHZvaWQgcGFyc2VFbGVtZW50Q29s\nbGVjdGlvbihGaWVsZE1ldGFEYXRhIGZtZCwgQXR0cmlidXRlcyBhdHRycykK\nICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICBTdHJpbmcg\ndmFsID0gYXR0cnMuZ2V0VmFsdWUoInRhcmdldC1jbGFzcyIpOwogICAgICAg\nIGlmICh2YWwgIT0gbnVsbCkKICAgICAgICAgICAgZm1kLmdldEVsZW1lbnQo\nKS5zZXREZWNsYXJlZFR5cGUoY2xhc3NGb3JOYW1lKHZhbCkpOwoKICAgICAg\nICBpZiAoZm1kLmdldERlY2xhcmVkVHlwZUNvZGUoKSAhPSBKYXZhVHlwZXMu\nQ09MTEVDVElPTiAmJgogICAgICAgICAgICBmbWQuZ2V0RGVjbGFyZWRUeXBl\nQ29kZSgpICE9IEphdmFUeXBlcy5NQVApCiAgICAgICAgICAgIHRocm93IGdl\ndEV4Y2VwdGlvbihfbG9jLmdldCgiYmFkLW1ldGEtYW5ubyIsIGZtZCwKICAg\nICAgICAgICAgICAgICAgICAiRWxlbWVudENvbGxlY3Rpb24iKSk7CgogICAg\nICAgIHZhbCA9IGF0dHJzLmdldFZhbHVlKCJmZXRjaCIpOwogICAgICAgIGlm\nICh2YWwgIT0gbnVsbCkKICAgICAgICAgICAgZm1kLnNldEluRGVmYXVsdEZl\ndGNoR3JvdXAoIkVBR0VSIi5lcXVhbHModmFsKSk7CiAgICAgICAgZm1kLnNl\ndEVsZW1lbnRDb2xsZWN0aW9uKHRydWUpOwogICAgICAgIGlmIChKYXZhVHlw\nZXMubWF5YmVQQyhmbWQuZ2V0RWxlbWVudCgpKSAmJiAhZm1kLmdldEVsZW1l\nbnQoKS5nZXREZWNsYXJlZFR5cGUoKS5pc0VudW0oKSkgewogICAgICAgICAg\nICBmbWQuZ2V0RWxlbWVudCgpLnNldEVtYmVkZGVkKHRydWUpOwogICAgICAg\nICAgICBpZiAoZm1kLmdldEVsZW1lbnQoKS5nZXRFbWJlZGRlZE1ldGFEYXRh\nKCkgPT0gbnVsbCkKLy8gICAgICAgICAgICAgICAgZm1kLmdldEVsZW1lbnQo\nKS5hZGRFbWJlZGRlZE1ldGFEYXRhKCk7CiAgICAgICAgICAgICAgICBkZWZl\nckVtYmVkZGFibGUoZm1kLmdldEVsZW1lbnQoKS5nZXREZWNsYXJlZFR5cGUo\nKSwgCiAgICAgICAgICAgICAgICAgICAgZm1kLmdldEVsZW1lbnQoKSk7CiAg\nICAgICAgfQogICAgfQogICAgCiAgICAvKioKICAgICAqIFBhcnNlIG1hcC1r\nZXkuCiAgICAgKi8KICAgIHByaXZhdGUgYm9vbGVhbiBzdGFydE1hcEtleShB\ndHRyaWJ1dGVzIGF0dHJzKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24g\newogICAgICAgIGlmICghaXNNYXBwaW5nT3ZlcnJpZGVNb2RlKCkpCiAgICAg\nICAgICAgIHJldHVybiBmYWxzZTsKCiAgICAgICAgRmllbGRNZXRhRGF0YSBm\nbWQgPSAoRmllbGRNZXRhRGF0YSkgY3VycmVudEVsZW1lbnQoKTsKICAgICAg\nICBTdHJpbmcgbWFwS2V5ID0gYXR0cnMuZ2V0VmFsdWUoIm5hbWUiKTsKICAg\nICAgICBpZiAobWFwS2V5ID09IG51bGwpCiAgICAgICAgICAgIGZtZC5nZXRL\nZXkoKS5zZXRWYWx1ZU1hcHBlZEJ5KFZhbHVlTWV0YURhdGEuTUFQUEVEX0JZ\nX1BLKTsKICAgICAgICBlbHNlCiAgICAgICAgICAgIGZtZC5nZXRLZXkoKS5z\nZXRWYWx1ZU1hcHBlZEJ5KG1hcEtleSk7CiAgICAgICAgcmV0dXJuIHRydWU7\nCiAgICB9CgogICAgCiAgICAvKioKICAgICAqIFBhcnNlIG1hcC1rZXktY2xh\nc3MuCiAgICAgKi8KICAgIHByaXZhdGUgYm9vbGVhbiBzdGFydE1hcEtleUNs\nYXNzKEF0dHJpYnV0ZXMgYXR0cnMpCiAgICB0aHJvd3MgU0FYRXhjZXB0aW9u\nIHsKICAgICAgICBpZiAoIWlzTWFwcGluZ092ZXJyaWRlTW9kZSgpKQogICAg\nICAgICAgICByZXR1cm4gZmFsc2U7CgogICAgICAgIEZpZWxkTWV0YURhdGEg\nZm1kID0gKEZpZWxkTWV0YURhdGEpIGN1cnJlbnRFbGVtZW50KCk7CiAgICAg\nICAgU3RyaW5nIG1hcEtleUNsYXNzID0gYXR0cnMuZ2V0VmFsdWUoImNsYXNz\nIik7CgogICAgICAgIGlmIChtYXBLZXlDbGFzcyAhPSBudWxsKSB7CiAgICAg\nICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBmbWQuZ2V0S2V5KCkuc2V0\nRGVjbGFyZWRUeXBlKENsYXNzLmZvck5hbWUobWFwS2V5Q2xhc3MpKTsKICAg\nICAgICAgICAgfSBjYXRjaCAoQ2xhc3NOb3RGb3VuZEV4Y2VwdGlvbiBlKSB7\nCiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhj\nZXB0aW9uKCJDbGFzcyBub3QgZm91bmQiKTsKICAgICAgICAgICAgfQogICAg\nICAgIH0gZWxzZQogICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3Vt\nZW50RXhjZXB0aW9uKAogICAgICAgICAgICAiVGhlIHZhbHVlIG9mIHRoZSBN\nYXBLZXlDbGFzcyBjYW5ub3QgYmUgbnVsbCIpOwogICAgICAgIHJldHVybiB0\ncnVlOwogICAgfQogICAgCiAgICAvKioKICAgICAqIFBhcnNlIG9yZGVyLWJ5\nLgogICAgICovCiAgICBwcml2YXRlIHZvaWQgZW5kT3JkZXJCeSgpCiAgICAg\nICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgRmllbGRNZXRhRGF0\nYSBmbWQgPSAoRmllbGRNZXRhRGF0YSkgY3VycmVudEVsZW1lbnQoKTsKICAg\nICAgICBTdHJpbmcgZGVjID0gY3VycmVudFRleHQoKTsKICAgICAgICBpZiAo\nZm1kLmlzRWxlbWVudENvbGxlY3Rpb24oKSAmJgogICAgICAgICAgICBmbWQu\nZ2V0RWxlbWVudCgpLmdldEVtYmVkZGVkTWV0YURhdGEoKSAhPSBudWxsIHx8\nCiAgICAgICAgICAgIGlzRGVmZXJyZWRFbWJlZGRhYmxlKGZtZC5nZXRFbGVt\nZW50KCkuZ2V0RGVjbGFyZWRUeXBlKCksIAogICAgICAgICAgICAgICAgZm1k\nLmdldEVsZW1lbnQoKSkpIHsKICAgICAgICAgICAgaWYgKGRlYy5sZW5ndGgo\nKSA9PSAwIHx8IGRlYy5lcXVhbHMoIkFTQyIpIHx8CiAgICAgICAgICAgICAg\nICBkZWMuZXF1YWxzKCJERVNDIikpCiAgICAgICAgICAgICAgICB0aHJvdyBu\nZXcgTWV0YURhdGFFeGNlcHRpb24oX2xvYy5nZXQoCiAgICAgICAgICAgICAg\nICAgICAgImludmFsaWQtb3JkZXJCeSIsIGZtZCkpOyAKICAgICAgICB9CiAg\nICAgICAgaWYgKFN0cmluZ1V0aWxzLmlzRW1wdHkoZGVjKSB8fCBkZWMuZXF1\nYWxzKCJBU0MiKSkKICAgICAgICAgICAgZGVjID0gT3JkZXIuRUxFTUVOVCAr\nICIgYXNjIjsKICAgICAgICBlbHNlIGlmIChkZWMuZXF1YWxzKCJERVNDIikp\nCiAgICAgICAgICAgIGRlYyA9IE9yZGVyLkVMRU1FTlQgKyAiIGRlc2MiOwog\nICAgICAgIAogICAgICAgIGZtZC5zZXRPcmRlckRlY2xhcmF0aW9uKGRlYyk7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBQYXJzZSBuYW1lZC1xdWVyeS4KICAg\nICAqLwogICAgcHJvdGVjdGVkIGJvb2xlYW4gc3RhcnROYW1lZFF1ZXJ5KEF0\ndHJpYnV0ZXMgYXR0cnMpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7\nCiAgICAgICAgaWYgKCFpc1F1ZXJ5TW9kZSgpKQogICAgICAgICAgICByZXR1\ncm4gZmFsc2U7CgogICAgICAgIFN0cmluZyBuYW1lID0gYXR0cnMuZ2V0VmFs\ndWUoIm5hbWUiKTsKICAgICAgICBMb2cgbG9nID0gZ2V0TG9nKCk7CiAgICAg\nICAgaWYgKGxvZy5pc1RyYWNlRW5hYmxlZCgpKQogICAgICAgICAgICBsb2cu\ndHJhY2UoX2xvYy5nZXQoInBhcnNlLXF1ZXJ5IiwgbmFtZSkpOwoKICAgICAg\nICBRdWVyeU1ldGFEYXRhIG1ldGEgPSBnZXRSZXBvc2l0b3J5KCkuc2VhcmNo\nUXVlcnlNZXRhRGF0YUJ5TmFtZShuYW1lKTsKICAgICAgICBpZiAobWV0YSAh\nPSBudWxsKSB7CiAgICAgICAgCUNsYXNzPD8+IGRlZlR5cGUgPSBtZXRhLmdl\ndERlZmluaW5nVHlwZSgpOwogICAgICAgICAgICBpZiAoKGRlZlR5cGUgIT0g\nX2NscykgJiYgbG9nLmlzV2FybkVuYWJsZWQoKSkgewogICAgICAgICAgICAg\nICAgbG9nLndhcm4oX2xvYy5nZXQoImR1cC1xdWVyeSIsIG5hbWUsIGN1cnJl\nbnRMb2NhdGlvbigpLAogICAgICAgICAgICAJICAgICAgICBkZWZUeXBlKSk7\nCiAgICAgICAgICAgIH0KICAgICAgICAgICAgcHVzaEVsZW1lbnQobWV0YSk7\nCiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KCiAgICAgICAg\nbWV0YSA9IGdldFJlcG9zaXRvcnkoKS5hZGRRdWVyeU1ldGFEYXRhKG51bGws\nIG5hbWUpOwogICAgICAgIG1ldGEuc2V0RGVmaW5pbmdUeXBlKF9jbHMpOwog\nICAgICAgIG1ldGEuc2V0UXVlcnlTdHJpbmcoYXR0cnMuZ2V0VmFsdWUoInF1\nZXJ5IikpOwogICAgICAgIG1ldGEuc2V0TGFuZ3VhZ2UoSlBRTFBhcnNlci5M\nQU5HX0pQUUwpOwogICAgICAgIC8qKiBUT0RPOiBVbmNvbW1lbnQgd2hlbiBv\ncm0ueHNkIGRlZmluZXMgbG9ja21vZGUgCiAgICAgICAgTG9ja01vZGVUeXBl\nIGxvY2tNb2RlID0KICAgICAgICAgICAgICAgICBMb2NrTW9kZVR5cGUudmFs\ndWVPZihhdHRycy5nZXRWYWx1ZSgibG9ja01vZGUiKSk7CiAgICAgICAgbWV0\nYS5hZGRIaW50KCJvcGVuanBhLkZldGNoUGxhbi5SZWFkTG9ja01vZGUiLCAK\nICAgICAgICAgICAgSlBBMkxvY2tMZXZlbHMudG9Mb2NrTGV2ZWwobG9ja01v\nZGUpKTsKICAgICAgICAqKi8KICAgICAgICBMb2NhdG9yIGxvY2F0b3IgPSBn\nZXRMb2NhdGlvbigpLmdldExvY2F0b3IoKTsKICAgICAgICBpZiAobG9jYXRv\nciAhPSBudWxsKSB7CiAgICAgICAgICAgIG1ldGEuc2V0TGluZU51bWJlcihO\ndW1iZXJzLnZhbHVlT2YobG9jYXRvci5nZXRMaW5lTnVtYmVyKCkpKTsKICAg\nICAgICAgICAgbWV0YS5zZXRDb2xOdW1iZXIoTnVtYmVycy52YWx1ZU9mKGxv\nY2F0b3IuZ2V0Q29sdW1uTnVtYmVyKCkpKTsKICAgICAgICB9CiAgICAgICAg\nT2JqZWN0IGN1ciA9IGN1cnJlbnRFbGVtZW50KCk7CiAgICAgICAgT2JqZWN0\nIHNjb3BlID0gKGN1ciBpbnN0YW5jZW9mIENsYXNzTWV0YURhdGEpCiAgICAg\nICAgICAgID8gKChDbGFzc01ldGFEYXRhKSBjdXIpLmdldERlc2NyaWJlZFR5\ncGUoKSA6IG51bGw7CiAgICAgICAgbWV0YS5zZXRTb3VyY2UoZ2V0U291cmNl\nRmlsZSgpLCBzY29wZSwgU291cmNlVHJhY2tlci5TUkNfWE1MKTsKICAgICAg\nICBpZiAoaXNNZXRhRGF0YU1vZGUoKSkKICAgICAgICAgICAgbWV0YS5zZXRT\nb3VyY2VNb2RlKE1PREVfTUVUQSk7CiAgICAgICAgZWxzZSBpZiAoaXNNYXBw\naW5nTW9kZSgpKQogICAgICAgICAgICBtZXRhLnNldFNvdXJjZU1vZGUoTU9E\nRV9NQVBQSU5HKTsKICAgICAgICBlbHNlCiAgICAgICAgICAgIG1ldGEuc2V0\nU291cmNlTW9kZShNT0RFX1FVRVJZKTsKICAgICAgICBwdXNoRWxlbWVudCht\nZXRhKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBwcm90ZWN0\nZWQgdm9pZCBlbmROYW1lZFF1ZXJ5KCkKICAgICAgICB0aHJvd3MgU0FYRXhj\nZXB0aW9uIHsKICAgICAgICBwb3BFbGVtZW50KCk7CiAgICB9CgogICAgcHJv\ndGVjdGVkIGJvb2xlYW4gc3RhcnRRdWVyeVN0cmluZyhBdHRyaWJ1dGVzIGF0\ndHJzKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24gewogICAgICAgIHJl\ndHVybiB0cnVlOwogICAgfQoKICAgIHByb3RlY3RlZCB2b2lkIGVuZFF1ZXJ5\nU3RyaW5nKCkKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAg\nICBRdWVyeU1ldGFEYXRhIG1ldGEgPSAoUXVlcnlNZXRhRGF0YSkgY3VycmVu\ndEVsZW1lbnQoKTsKICAgICAgICBtZXRhLnNldFF1ZXJ5U3RyaW5nKGN1cnJl\nbnRUZXh0KCkpOwogICAgfQoKICAgIC8qKgogICAgICogUGFyc2UgcXVlcnkt\naGludC4KICAgICAqLwogICAgcHJvdGVjdGVkIGJvb2xlYW4gc3RhcnRRdWVy\neUhpbnQoQXR0cmlidXRlcyBhdHRycykKICAgICAgICB0aHJvd3MgU0FYRXhj\nZXB0aW9uIHsKICAgICAgICBRdWVyeU1ldGFEYXRhIG1ldGEgPSAoUXVlcnlN\nZXRhRGF0YSkgY3VycmVudEVsZW1lbnQoKTsKICAgICAgICBtZXRhLmFkZEhp\nbnQoYXR0cnMuZ2V0VmFsdWUoIm5hbWUiKSwgYXR0cnMuZ2V0VmFsdWUoInZh\nbHVlIikpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIHByb3Rl\nY3RlZCB2b2lkIGVuZFF1ZXJ5SGludCgpCiAgICAgICAgdGhyb3dzIFNBWEV4\nY2VwdGlvbiB7CiAgICB9CgogICAgLyoqCiAgICAgKiBQYXJzZSBuYXRpdmUt\nbmFtZWQtcXVlcnkuCiAgICAgKi8KICAgIHByb3RlY3RlZCBib29sZWFuIHN0\nYXJ0TmFtZWROYXRpdmVRdWVyeShBdHRyaWJ1dGVzIGF0dHJzKQogICAgICAg\nIHRocm93cyBTQVhFeGNlcHRpb24gewogICAgICAgIGlmICghaXNRdWVyeU1v\nZGUoKSkKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoKICAgICAgICBTdHJp\nbmcgbmFtZSA9IGF0dHJzLmdldFZhbHVlKCJuYW1lIik7CiAgICAgICAgTG9n\nIGxvZyA9IGdldExvZygpOwogICAgICAgIGlmIChsb2cuaXNUcmFjZUVuYWJs\nZWQoKSkKICAgICAgICAgICAgbG9nLnRyYWNlKF9sb2MuZ2V0KCJwYXJzZS1u\nYXRpdmUtcXVlcnkiLCBuYW1lKSk7CgogICAgICAgIFF1ZXJ5TWV0YURhdGEg\nbWV0YSA9IGdldFJlcG9zaXRvcnkoKS5nZXRDYWNoZWRRdWVyeU1ldGFEYXRh\nKG51bGwsIG5hbWUpOwogICAgICAgIGlmIChtZXRhICE9IG51bGwgJiYgbG9n\nLmlzV2FybkVuYWJsZWQoKSkKICAgICAgICAgICAgbG9nLndhcm4oX2xvYy5n\nZXQoIm92ZXJyaWRlLXF1ZXJ5IiwgbmFtZSwgY3VycmVudExvY2F0aW9uKCkp\nKTsKCiAgICAgICAgbWV0YSA9IGdldFJlcG9zaXRvcnkoKS5hZGRRdWVyeU1l\ndGFEYXRhKG51bGwsIG5hbWUpOwogICAgICAgIG1ldGEuc2V0RGVmaW5pbmdU\neXBlKF9jbHMpOwogICAgICAgIG1ldGEuc2V0UXVlcnlTdHJpbmcoYXR0cnMu\nZ2V0VmFsdWUoInF1ZXJ5IikpOwogICAgICAgIG1ldGEuc2V0TGFuZ3VhZ2Uo\nUXVlcnlMYW5ndWFnZXMuTEFOR19TUUwpOwogICAgICAgIFN0cmluZyB2YWwg\nPSBhdHRycy5nZXRWYWx1ZSgicmVzdWx0LWNsYXNzIik7CiAgICAgICAgaWYg\nKHZhbCAhPSBudWxsKSB7CiAgICAgICAgICAgIENsYXNzPD8+IHR5cGUgPSBj\nbGFzc0Zvck5hbWUodmFsKTsKICAgICAgICAgICAgaWYgKEltcGxIZWxwZXIu\naXNNYW5hZ2VkVHlwZShnZXRDb25maWd1cmF0aW9uKCksIHR5cGUpKQogICAg\nICAgICAgICAgICAgbWV0YS5zZXRDYW5kaWRhdGVUeXBlKHR5cGUpOwogICAg\nICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICBtZXRhLnNldFJlc3VsdFR5\ncGUodHlwZSk7CiAgICAgICAgfQoKICAgICAgICB2YWwgPSBhdHRycy5nZXRW\nYWx1ZSgicmVzdWx0LXNldC1tYXBwaW5nIik7CiAgICAgICAgaWYgKHZhbCAh\nPSBudWxsKQogICAgICAgICAgICBtZXRhLnNldFJlc3VsdFNldE1hcHBpbmdO\nYW1lKHZhbCk7CgogICAgICAgIE9iamVjdCBjdXIgPSBjdXJyZW50RWxlbWVu\ndCgpOwogICAgICAgIE9iamVjdCBzY29wZSA9IChjdXIgaW5zdGFuY2VvZiBD\nbGFzc01ldGFEYXRhKQogICAgICAgICAgICA/ICgoQ2xhc3NNZXRhRGF0YSkg\nY3VyKS5nZXREZXNjcmliZWRUeXBlKCkgOiBudWxsOwogICAgICAgIG1ldGEu\nc2V0U291cmNlKGdldFNvdXJjZUZpbGUoKSwgc2NvcGUsIFNvdXJjZVRyYWNr\nZXIuU1JDX1hNTCk7CiAgICAgICAgTG9jYXRvciBsb2NhdG9yID0gZ2V0TG9j\nYXRpb24oKS5nZXRMb2NhdG9yKCk7CiAgICAgICAgaWYgKGxvY2F0b3IgIT0g\nbnVsbCkgewogICAgICAgICAgICBtZXRhLnNldExpbmVOdW1iZXIoTnVtYmVy\ncy52YWx1ZU9mKGxvY2F0b3IuZ2V0TGluZU51bWJlcigpKSk7CiAgICAgICAg\nICAgIG1ldGEuc2V0Q29sTnVtYmVyKE51bWJlcnMudmFsdWVPZihsb2NhdG9y\nLmdldENvbHVtbk51bWJlcigpKSk7CiAgICAgICAgfQogICAgICAgIGlmIChp\nc01ldGFEYXRhTW9kZSgpKQogICAgICAgICAgICBtZXRhLnNldFNvdXJjZU1v\nZGUoTU9ERV9NRVRBKTsKICAgICAgICBlbHNlIGlmIChpc01hcHBpbmdNb2Rl\nKCkpCiAgICAgICAgICAgIG1ldGEuc2V0U291cmNlTW9kZShNT0RFX01BUFBJ\nTkcpOwogICAgICAgIGVsc2UKICAgICAgICAgICAgbWV0YS5zZXRTb3VyY2VN\nb2RlKE1PREVfUVVFUlkpOwogICAgICAgIHB1c2hFbGVtZW50KG1ldGEpOwog\nICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIHByb3RlY3RlZCB2b2lk\nIGVuZE5hbWVkTmF0aXZlUXVlcnkoKQogICAgICAgIHRocm93cyBTQVhFeGNl\ncHRpb24gewogICAgICAgIHBvcEVsZW1lbnQoKTsKICAgIH0KCiAgICAvKioK\nICAgICAqIFN0YXJ0IGVudGl0eS1saXN0ZW5lcnMKICAgICAqLwogICAgcHJp\ndmF0ZSBib29sZWFuIHN0YXJ0RW50aXR5TGlzdGVuZXJzKEF0dHJpYnV0ZXMg\nYXR0cnMpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAg\naWYgKCFpc01ldGFEYXRhTW9kZSgpKQogICAgICAgICAgICByZXR1cm4gZmFs\nc2U7CiAgICAgICAgaWYgKGN1cnJlbnRFbGVtZW50KCkgPT0gbnVsbCkKICAg\nICAgICAgICAgcmV0dXJuIHRydWU7CgogICAgICAgIC8vIHJlc2V0IGxpc3Rl\nbmVycyBkZWNsYXJlZCBpbiBhbm5vdGF0aW9ucy4KICAgICAgICBMaWZlY3lj\nbGVNZXRhRGF0YSBtZXRhID0gKChDbGFzc01ldGFEYXRhKSBjdXJyZW50RWxl\nbWVudCgpKS4KICAgICAgICAgICAgZ2V0TGlmZWN5Y2xlTWV0YURhdGEoKTsK\nICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IExpZmVjeWNsZUV2ZW50LkFM\nTF9FVkVOVFMubGVuZ3RoOyBpKyspCiAgICAgICAgICAgIG1ldGEuc2V0RGVj\nbGFyZWRDYWxsYmFja3MoaSwgbnVsbCwgMCk7CiAgICAgICAgcmV0dXJuIHRy\ndWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBQYXJzZSBleGNsdWRlLWRlZmF1\nbHQtbGlzdGVuZXJzLgogICAgICovCiAgICBwcml2YXRlIGJvb2xlYW4gc3Rh\ncnRFeGNsdWRlRGVmYXVsdExpc3RlbmVycyhBdHRyaWJ1dGVzIGF0dHJzKQog\nICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24gewogICAgICAgIGlmICghaXNN\nZXRhRGF0YU1vZGUoKSkKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAg\nICAgIENsYXNzTWV0YURhdGEgbWV0YSA9IChDbGFzc01ldGFEYXRhKSBjdXJy\nZW50RWxlbWVudCgpOwogICAgICAgIG1ldGEuZ2V0TGlmZWN5Y2xlTWV0YURh\ndGEoKS5zZXRJZ25vcmVTeXN0ZW1MaXN0ZW5lcnModHJ1ZSk7CiAgICAgICAg\ncmV0dXJuIHRydWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBQYXJzZSBleGNs\ndWRlLXN1cGVyY2xhc3MtbGlzdGVuZXJzLgogICAgICovCiAgICBwcml2YXRl\nIGJvb2xlYW4gc3RhcnRFeGNsdWRlU3VwZXJjbGFzc0xpc3RlbmVycyhBdHRy\naWJ1dGVzIGF0dHJzKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24gewog\nICAgICAgIGlmICghaXNNZXRhRGF0YU1vZGUoKSkKICAgICAgICAgICAgcmV0\ndXJuIGZhbHNlOwogICAgICAgIENsYXNzTWV0YURhdGEgbWV0YSA9IChDbGFz\nc01ldGFEYXRhKSBjdXJyZW50RWxlbWVudCgpOwogICAgICAgIG1ldGEuZ2V0\nTGlmZWN5Y2xlTWV0YURhdGEoKS5zZXRJZ25vcmVTdXBlcmNsYXNzQ2FsbGJh\nY2tzCiAgICAgICAgICAgIChMaWZlY3ljbGVNZXRhRGF0YS5JR05PUkVfSElH\nSCk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBQYXJzZSBlbnRpdHktbGlzdGVuZXIuCiAgICAgKi8KICAgIHByaXZhdGUg\nYm9vbGVhbiBzdGFydEVudGl0eUxpc3RlbmVyKEF0dHJpYnV0ZXMgYXR0cnMp\nCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgX2xpc3Rl\nbmVyID0gY2xhc3NGb3JOYW1lKGF0dHJzLmdldFZhbHVlKCJjbGFzcyIpKTsK\nICAgICAgICBib29sZWFuIHN5c3RlbSA9IGN1cnJlbnRFbGVtZW50KCkgPT0g\nbnVsbDsKICAgICAgICBDb2xsZWN0aW9uPExpZmVjeWNsZUNhbGxiYWNrcz5b\nXSBwYXJzZWQgPQogICAgICAgICAgICBBbm5vdGF0aW9uUGVyc2lzdGVuY2VN\nZXRhRGF0YVBhcnNlci5wYXJzZUNhbGxiYWNrTWV0aG9kcyhfbGlzdGVuZXIs\nCiAgICAgICAgICAgICAgICBudWxsLCB0cnVlLCB0cnVlLCBfcmVwb3MpOwog\nICAgICAgIGlmIChwYXJzZWQgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJu\nIHRydWU7CgogICAgICAgIGlmIChfY2FsbGJhY2tzID09IG51bGwpIHsKICAg\nICAgICAgICAgX2NhbGxiYWNrcyA9IChDb2xsZWN0aW9uPExpZmVjeWNsZUNh\nbGxiYWNrcz5bXSkKICAgICAgICAgICAgICAgIG5ldyBDb2xsZWN0aW9uW0xp\nZmVjeWNsZUV2ZW50LkFMTF9FVkVOVFMubGVuZ3RoXTsKICAgICAgICAgICAg\naWYgKCFzeXN0ZW0pCiAgICAgICAgICAgICAgICBfaGlnaHMgPSBuZXcgaW50\nW0xpZmVjeWNsZUV2ZW50LkFMTF9FVkVOVFMubGVuZ3RoXTsKICAgICAgICB9\nCiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBwYXJzZWQubGVuZ3RoOyBp\nKyspIHsKICAgICAgICAgICAgaWYgKHBhcnNlZFtpXSA9PSBudWxsKQogICAg\nICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgIGlmIChfY2FsbGJh\nY2tzW2ldID09IG51bGwpCiAgICAgICAgICAgICAgICBfY2FsbGJhY2tzW2ld\nID0gcGFyc2VkW2ldOwogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAg\nICBfY2FsbGJhY2tzW2ldLmFkZEFsbChwYXJzZWRbaV0pOwogICAgICAgICAg\nICBpZiAoIXN5c3RlbSkKICAgICAgICAgICAgICAgIF9oaWdoc1tpXSArPSBw\nYXJzZWRbaV0uc2l6ZSgpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gdHJ1\nZTsKICAgIH0KCiAgICBwcml2YXRlIHZvaWQgZW5kRW50aXR5TGlzdGVuZXIo\nKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24gewogICAgICAgIC8vIHNo\nb3VsZCBiZSBpbiBlbmRFbnRpdHlMaXN0ZW5lcnMgSSB0aGluayB0byBtZXJn\nZSBjYWxsYmFja3MKICAgICAgICAvLyBpbnRvIGEgc2luZ2xlIGxpc3RlbmVy\nLiAgQnV0IHRoZW4gdGhlIHVzZXIgY2Fubm90IHJlbW92ZS4KICAgICAgICBp\nZiAoY3VycmVudEVsZW1lbnQoKSA9PSBudWxsICYmIF9jYWxsYmFja3MgIT0g\nbnVsbCkgewogICAgICAgICAgICBfcmVwb3MuYWRkU3lzdGVtTGlzdGVuZXIo\nbmV3IFBlcnNpc3RlbmNlTGlzdGVuZXJBZGFwdGVyCiAgICAgICAgICAgICAg\nICAoX2NhbGxiYWNrcykpOwogICAgICAgICAgICBfY2FsbGJhY2tzID0gbnVs\nbDsKICAgICAgICB9CiAgICAgICAgX2xpc3RlbmVyID0gbnVsbDsKICAgIH0K\nCiAgICBwcml2YXRlIGJvb2xlYW4gc3RhcnRDYWxsYmFjayhNZXRhRGF0YVRh\nZyBjYWxsYmFjaywgQXR0cmlidXRlcyBhdHRycykKICAgICAgICB0aHJvd3Mg\nU0FYRXhjZXB0aW9uIHsKICAgICAgICBpZiAoIWlzTWV0YURhdGFNb2RlKCkp\nCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICBpbnRbXSBldmVu\ndHMgPSBNZXRhRGF0YVBhcnNlcnMuZ2V0RXZlbnRUeXBlcyhjYWxsYmFjaywg\nX2NvbmYpOwogICAgICAgIGlmIChldmVudHMgPT0gbnVsbCkKICAgICAgICAg\nICAgcmV0dXJuIGZhbHNlOwoKICAgICAgICBib29sZWFuIHN5c3RlbSA9IGN1\ncnJlbnRFbGVtZW50KCkgPT0gbnVsbDsKCiAgICAgICAgLy8gSWYgaW4gYSBt\ndWx0aS1sZXZlbCBwYXJzZSwgZG8gbm90IGFkZCBzeXN0ZW0gbGV2ZWwgbGlz\ndGVuZXJzLgogICAgICAgIC8vIE90aGVyd2lzZSwgdGhleSB3aWxsIGdldCBh\nZGRlZCBtdWx0aXBsZSB0aW1lcy4KICAgICAgICBpZiAoc3lzdGVtICYmIF9w\nYXJzZUxpc3QgIT0gbnVsbCAmJiBfcGFyc2VMaXN0LnNpemUoKSA+IDApIHsK\nICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KCiAgICAgICAg\nQ2xhc3M8Pz4gdHlwZSA9IGN1cnJlbnRFbGVtZW50KCkgPT0gbnVsbCA/IG51\nbGwgOgogICAgICAgICAgICAoKENsYXNzTWV0YURhdGEpIGN1cnJlbnRFbGVt\nZW50KCkpLmdldERlc2NyaWJlZFR5cGUoKTsKICAgICAgICBpZiAodHlwZSA9\nPSBudWxsKQogICAgICAgICAgICB0eXBlID0gT2JqZWN0LmNsYXNzOwoKICAg\nICAgICBpZiAoX2NhbGxiYWNrcyA9PSBudWxsKSB7CiAgICAgICAgICAgIF9j\nYWxsYmFja3MgPSAoQ29sbGVjdGlvbjxMaWZlY3ljbGVDYWxsYmFja3M+W10p\nCiAgICAgICAgICAgICAgICBuZXcgQ29sbGVjdGlvbltMaWZlY3ljbGVFdmVu\ndC5BTExfRVZFTlRTLmxlbmd0aF07CiAgICAgICAgICAgIGlmICghc3lzdGVt\nKQogICAgICAgICAgICAgICAgX2hpZ2hzID0gbmV3IGludFtMaWZlY3ljbGVF\ndmVudC5BTExfRVZFTlRTLmxlbmd0aF07CiAgICAgICAgfQoKICAgICAgICBM\naWZlY3ljbGVDYWxsYmFja3MgYWRhcHRlcjsKICAgICAgICBpZiAoX2xpc3Rl\nbmVyICE9IG51bGwpCiAgICAgICAgICAgIGFkYXB0ZXIgPSBuZXcgQmVhbkxp\nZmVjeWNsZUNhbGxiYWNrcyhfbGlzdGVuZXIsCiAgICAgICAgICAgICAgICBh\ndHRycy5nZXRWYWx1ZSgibWV0aG9kLW5hbWUiKSwgZmFsc2UsIHR5cGUpOwog\nICAgICAgIGVsc2UKICAgICAgICAgICAgYWRhcHRlciA9IG5ldyBNZXRob2RM\naWZlY3ljbGVDYWxsYmFja3MoX2NscywKICAgICAgICAgICAgICAgIGF0dHJz\nLmdldFZhbHVlKCJtZXRob2QtbmFtZSIpLCBmYWxzZSk7CgogICAgICAgIGZv\nciAoaW50IGkgPSAwOyBpIDwgZXZlbnRzLmxlbmd0aDsgaSsrKSB7CiAgICAg\nICAgICAgIGludCBldmVudCA9IGV2ZW50c1tpXTsKICAgICAgICAgICAgaWYg\nKF9saXN0ZW5lciAhPSBudWxsKSB7CiAgICAgICAgICAgICAgICBNZXRhRGF0\nYVBhcnNlcnMudmFsaWRhdGVNZXRob2RzRm9yU2FtZUNhbGxiYWNrKF9saXN0\nZW5lciwKICAgICAgICAgICAgICAgICAgICBfY2FsbGJhY2tzW2V2ZW50XSwg\nKChCZWFuTGlmZWN5Y2xlQ2FsbGJhY2tzKSBhZGFwdGVyKS4KICAgICAgICAg\nICAgICAgICAgICBnZXRDYWxsYmFja01ldGhvZCgpLCBjYWxsYmFjaywgX2Nv\nbmYsIGdldExvZygpKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAg\nICAgICAgIE1ldGFEYXRhUGFyc2Vycy52YWxpZGF0ZU1ldGhvZHNGb3JTYW1l\nQ2FsbGJhY2soX2NscywKICAgICAgICAgICAgICAgICAgICBfY2FsbGJhY2tz\nW2V2ZW50XSwgKChNZXRob2RMaWZlY3ljbGVDYWxsYmFja3MpIGFkYXB0ZXIp\nLgogICAgICAgICAgICAgICAgICAgIGdldENhbGxiYWNrTWV0aG9kKCksIGNh\nbGxiYWNrLCBfY29uZiwgZ2V0TG9nKCkpOwoKICAgICAgICAgICAgfQogICAg\nICAgICAgICBpZiAoX2NhbGxiYWNrc1tldmVudF0gPT0gbnVsbCkKICAgICAg\nICAgICAgICAgIF9jYWxsYmFja3NbZXZlbnRdID0gbmV3IEFycmF5TGlzdDxM\naWZlY3ljbGVDYWxsYmFja3M+KDMpOwogICAgICAgICAgICBfY2FsbGJhY2tz\nW2V2ZW50XS5hZGQoYWRhcHRlcik7CiAgICAgICAgICAgIGlmICghc3lzdGVt\nICYmIF9saXN0ZW5lciAhPSBudWxsKQogICAgICAgICAgICAgICAgX2hpZ2hz\nW2V2ZW50XSsrOwogICAgICAgIH0KICAgICAgICByZXR1cm4gdHJ1ZTsKICAg\nIH0KCiAgICAvKioKICAgICAqIFN0b3JlIGxpZmVjeWNsZSBtZXRhZGF0YS4K\nICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIHN0b3JlQ2FsbGJhY2tzKENsYXNz\nTWV0YURhdGEgY2xzKSB7CiAgICAgICAgTGlmZWN5Y2xlTWV0YURhdGEgbWV0\nYSA9IGNscy5nZXRMaWZlY3ljbGVNZXRhRGF0YSgpOwogICAgICAgIENsYXNz\nPD8+IHN1cENscyA9IGNscy5nZXREZXNjcmliZWRUeXBlKCkuZ2V0U3VwZXJj\nbGFzcygpOwogICAgICAgIENvbGxlY3Rpb248TGlmZWN5Y2xlQ2FsbGJhY2tz\nPltdIHN1cENhbGxzID0gbnVsbDsKICAgICAgICBpZiAoIU9iamVjdC5jbGFz\ncy5lcXVhbHMoc3VwQ2xzKSkgewogICAgICAgICAgICBzdXBDYWxscyA9IEFu\nbm90YXRpb25QZXJzaXN0ZW5jZU1ldGFEYXRhUGFyc2VyLnBhcnNlQ2FsbGJh\nY2tNZXRob2RzCiAgICAgICAgICAgICAgICAoc3VwQ2xzLCBudWxsLCB0cnVl\nLCBmYWxzZSwgX3JlcG9zKTsKICAgICAgICB9CiAgICAgICAgaWYgKHN1cENh\nbGxzICE9IG51bGwpIHsKICAgICAgICAgICAgZm9yIChpbnQgZXZlbnQgOiBM\naWZlY3ljbGVFdmVudC5BTExfRVZFTlRTKSB7CiAgICAgICAgICAgICAgICBp\nZiAoc3VwQ2FsbHNbZXZlbnRdID09IG51bGwpCiAgICAgICAgICAgICAgICAg\nICAgY29udGludWU7CiAgICAgICAgICAgICAgICBtZXRhLnNldE5vblBDU3Vw\nZXJjbGFzc0NhbGxiYWNrcyhldmVudCwgc3VwQ2FsbHNbZXZlbnRdLnRvQXJy\nYXkKICAgICAgICAgICAgICAgICAgICAobmV3IExpZmVjeWNsZUNhbGxiYWNr\nc1tzdXBDYWxsc1tldmVudF0uc2l6ZSgpXSksIDApOwogICAgICAgICAgICB9\nCiAgICAgICAgfQogICAgICAgIGlmIChfY2FsbGJhY2tzID09IG51bGwpCiAg\nICAgICAgICAgIHJldHVybjsKCiAgICAgICAgZm9yIChpbnQgZXZlbnQgOiBM\naWZlY3ljbGVFdmVudC5BTExfRVZFTlRTKSB7CiAgICAgICAgICAgIGlmIChf\nY2FsbGJhY2tzW2V2ZW50XSA9PSBudWxsKQogICAgICAgICAgICAgICAgY29u\ndGludWU7CiAgICAgICAgICAgIG1ldGEuc2V0RGVjbGFyZWRDYWxsYmFja3Mo\nZXZlbnQsIChMaWZlY3ljbGVDYWxsYmFja3NbXSkKICAgICAgICAgICAgICAg\nIF9jYWxsYmFja3NbZXZlbnRdLnRvQXJyYXkKICAgICAgICAgICAgICAgICAg\nICAobmV3IExpZmVjeWNsZUNhbGxiYWNrc1tfY2FsbGJhY2tzW2V2ZW50XS5z\naXplKCldKSwKICAgICAgICAgICAgICAgIF9oaWdoc1tldmVudF0pOwogICAg\nICAgIH0KICAgICAgICBfY2FsbGJhY2tzID0gbnVsbDsKICAgICAgICBfaGln\naHMgPSBudWxsOwogICAgfQoKICAgIHByb3RlY3RlZCBib29sZWFuIHN0YXJ0\nT3JkZXJDb2x1bW4oQXR0cmlidXRlcyBhdHRycykKICAgICAgICB0aHJvd3Mg\nU0FYRXhjZXB0aW9uIHsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAg\nICAvKioKICAgICAqIEluc3RhbnRpYXRlIHRoZSBnaXZlbiBjbGFzcywgdGFr\naW5nIGludG8gYWNjb3VudCB0aGUgZGVmYXVsdCBwYWNrYWdlLgoJICovCglw\ncm90ZWN0ZWQgQ2xhc3M8Pz4gY2xhc3NGb3JOYW1lKFN0cmluZyBuYW1lKQoJ\nCXRocm93cyBTQVhFeGNlcHRpb24gewoJCWlmICgiRW50aXR5Ii5lcXVhbHMo\nbmFtZSkpCgkJCXJldHVybiBQZXJzaXN0ZW5jZUNhcGFibGUuY2xhc3M7CgkJ\ncmV0dXJuIHN1cGVyLmNsYXNzRm9yTmFtZShuYW1lLCBpc1J1bnRpbWUoKSk7\nCgl9CgoJLyoqCgkgKiBQcm9jZXNzIGFsbCBkZWZlcnJlZCBlbWJlZGRhYmxl\ncyB1c2luZyBhbiB1bmtub3duIGFjY2VzcyB0eXBlLgoJICovCglwcm90ZWN0\nZWQgdm9pZCBhZGREZWZlcnJlZEVtYmVkZGFibGVNZXRhRGF0YSgpIHsKCSAg\nICBpZiAoX2VtYmVkZGFibGVzICE9IG51bGwgJiYgX2VtYmVkZGFibGVzLnNp\nemUoKSA+IDApIHsKCSAgICAgICAgLy8gUmV2ZXJzZSBpdGVyYXRlIHRoZSBh\ncnJheSBvZiByZW1haW5pbmcgZGVmZXJyZWQgZW1iZWRkYWJsZXMgCgkgICAg\nICAgIC8vIHNpbmNlIGVsZW1lbnRzIHdpbGwgYmUgcmVtb3ZlZCBhcyB0aGV5\nIGFyZSBwcm9jZXNzZWQuCgkgICAgICAgIENsYXNzPD8+W10gY2xhc3NlcyA9\nIF9lbWJlZGRhYmxlcy5rZXlTZXQoKS50b0FycmF5KAoJICAgICAgICAgICAg\nbmV3IENsYXNzPD8+W19lbWJlZGRhYmxlcy5zaXplKCldKTsKCSAgICAgICAg\nZm9yIChpbnQgaSA9IGNsYXNzZXMubGVuZ3RoIC0gMSA7IGkgPj0gMDsgaS0t\nKSB7CgkgICAgICAgICAgICB0cnkgewoJICAgICAgICAgICAgICAgIEludGVn\nZXIgYWNjZXNzID0gX2VtYmVkZGFibGVBY2Nlc3MuZ2V0KGNsYXNzZXNbaV0p\nOwoJICAgICAgICAgICAgICAgIGlmIChhY2Nlc3MgPT0gbnVsbCkgewoJICAg\nICAgICAgICAgICAgICAgICBhY2Nlc3MgPSBBY2Nlc3NDb2RlLlVOS05PV047\nCgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGFkZERlZmVy\ncmVkRW1iZWRkYWJsZU1ldGFEYXRhKGNsYXNzZXNbaV0sIAoJICAgICAgICAg\nICAgICAgICAgICBhY2Nlc3MpOwoJICAgICAgICAgICAgfQoJICAgICAgICAg\nICAgY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CgkgICAgICAgICAgICAgICAgdGhy\nb3cgbmV3IE1ldGFEYXRhRXhjZXB0aW9uKAoJICAgICAgICAgICAgICAgICAg\nICBfbG9jLmdldCgibm8tZW1iZWRkYWJsZS1tZXRhZGF0YSIsIAoJICAgICAg\nICAgICAgICAgICAgICAgICAgY2xhc3Nlc1tpXS5nZXROYW1lKCkpLCBlKTsg\nCgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICB9CSAgICAKCX0KCQog\nICAgLyoqCiAgICAgKiBQcm9jZXNzIGFsbCBkZWZlcnJlZCBlbWJlZGRhYmxl\ncyBhbmQgZW1iZWRkYWJsZSBtYXBwaW5nIG92ZXJyaWRlcwogICAgICogZm9y\nIGEgZ2l2ZW4gY2xhc3MuICBUaGlzIHNob3VsZCBvbmx5IGhhcHBlbiBhZnRl\nciB0aGUgYWNjZXNzIHR5cGUgCiAgICAgKiBvZiB0aGUgZW1iZWRkYWJsZSBp\ncyBrbm93bi4KICAgICAqIAogICAgICogQHBhcmFtIGVtYmVkVHlwZSBlbWJl\nZGRhYmxlIGNsYXNzIAogICAgICogQHBhcmFtIGFjY2VzcyBjbGFzcyBsZXZl\nbCBhY2Nlc3MgZm9yIGVtYmVkZGFibGUKICAgICAqIEB0aHJvd3MgU0FYRXhj\nZXB0aW9uIAogICAgICovCiAgICBwcm90ZWN0ZWQgdm9pZCBhZGREZWZlcnJl\nZEVtYmVkZGFibGVNZXRhRGF0YShDbGFzczw/PiBlbWJlZFR5cGUsIAogICAg\nICAgIGludCBhY2Nlc3MpIHRocm93cyBTQVhFeGNlcHRpb24gewogICAgICAg\nIEFycmF5TGlzdDxNZXRhRGF0YUNvbnRleHQ+IGZtZHMgPSBfZW1iZWRkYWJs\nZXMuZ2V0KGVtYmVkVHlwZSk7CiAgICAgICAgaWYgKGZtZHMgIT0gbnVsbCAm\nJiBmbWRzLnNpemUoKSA+IDApIHsKICAgICAgICAgICAgZm9yIChNZXRhRGF0\nYUNvbnRleHQgbWQgOiBmbWRzKSB7CiAgICAgICAgICAgICAgICBpZiAobWQg\naW5zdGFuY2VvZiBGaWVsZE1ldGFEYXRhKSB7CiAgICAgICAgICAgICAgICAg\nICAgRmllbGRNZXRhRGF0YSBmbWQgPSAoRmllbGRNZXRhRGF0YSltZDsKICAg\nICAgICAgICAgICAgICAgICBmbWQuYWRkRW1iZWRkZWRNZXRhRGF0YShhY2Nl\nc3MpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZSBp\nZiAobWQgaW5zdGFuY2VvZiBWYWx1ZU1ldGFEYXRhKSB7CiAgICAgICAgICAg\nICAgICAgICAgVmFsdWVNZXRhRGF0YSB2bWQgPSAoVmFsdWVNZXRhRGF0YSlt\nZDsKICAgICAgICAgICAgICAgICAgICB2bWQuYWRkRW1iZWRkZWRNZXRhRGF0\nYShhY2Nlc3MpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAg\nICAgICAgICAgIGFwcGx5RGVmZXJyZWRFbWJlZGRhYmxlT3ZlcnJpZGVzKGVt\nYmVkVHlwZSk7CiAgICAgICAgICAgIC8vIENsZWFuIHVwIGRlZmVycmFscyBh\nZnRlciB0aGV5IGhhdmUgYmVlbiBwcm9jZXNzZWQKICAgICAgICAgICAgZm1k\ncy5jbGVhcigpOwogICAgICAgICAgICBfZW1iZWRkYWJsZXMucmVtb3ZlKGVt\nYmVkVHlwZSk7CiAgICAgICAgfQogICAgfQogICAgcHJvdGVjdGVkIHZvaWQg\nc2V0RGVmZXJyZWRFbWJlZGRhYmxlQWNjZXNzVHlwZShDbGFzczw/PiBlbWJl\nZFR5cGUsCiAgICAgICAgaW50IGFjY2VzcykgewogICAgICAgIF9lbWJlZGRh\nYmxlQWNjZXNzLnB1dChlbWJlZFR5cGUsIGFjY2Vzcyk7CiAgICB9CgogICAg\nLyoKICAgICAqIENsZWFyIGFueSBkZWZlcnJlZCBtZXRhZGF0YQogICAgICov\nCiAgICBAT3ZlcnJpZGUKICAgIHByb3RlY3RlZCB2b2lkIGNsZWFyRGVmZXJy\nZWRNZXRhRGF0YSgpIHsKICAgICAgICBfZW1iZWRkYWJsZXMuY2xlYXIoKTsK\nICAgICAgICBfZW1iZWRkYWJsZUFjY2Vzcy5jbGVhcigpOwogICAgfQoKICAg\nIC8qCiAgICAgKiBEZXRlcm1pbmVzIHdoZXRoZXIgdGhlIGVtYmVkZGFibGUg\ndHlwZSBpcyBkZWZlcnJlZC4KICAgICAqLwogICAgcHJvdGVjdGVkIGJvb2xl\nYW4gaXNEZWZlcnJlZEVtYmVkZGFibGUoQ2xhc3M8Pz4gZW1iZWRUeXBlLCAK\nICAgICAgICBNZXRhRGF0YUNvbnRleHQgZm1kKSB7CiAgICAgICAgQXJyYXlM\naXN0PE1ldGFEYXRhQ29udGV4dD4gZm1kcyA9IF9lbWJlZGRhYmxlcy5nZXQo\nZW1iZWRUeXBlKTsKICAgICAgICBpZiAoZm1kcyAhPSBudWxsKSB7CiAgICAg\nICAgICAgIHJldHVybiBmbWRzLmNvbnRhaW5zKGZtZCk7CiAgICAgICAgfQog\nICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KICAgIAogICAgLyoKICAgICAq\nIEFkZCB0aGUgZm1kIHRvIHRoZSBkZWZlciBsaXN0IGZvciBmb3IgdGhlIGdp\ndmVuIGVtYmVkZGFibGUgdHlwZQogICAgICovCiAgICBwcm90ZWN0ZWQgdm9p\nZCBkZWZlckVtYmVkZGFibGUoQ2xhc3M8Pz4gZW1iZWRUeXBlLCBNZXRhRGF0\nYUNvbnRleHQgZm1kKSB7CiAgICAgICAgQXJyYXlMaXN0PE1ldGFEYXRhQ29u\ndGV4dD4gZm1kcyA9IF9lbWJlZGRhYmxlcy5nZXQoZW1iZWRUeXBlKTsKICAg\nICAgICBpZiAoZm1kcyA9PSBudWxsKSB7CiAgICAgICAgICAgIGZtZHMgPSBu\nZXcgQXJyYXlMaXN0PE1ldGFEYXRhQ29udGV4dD4oKTsKICAgICAgICAgICAg\nX2VtYmVkZGFibGVzLnB1dChlbWJlZFR5cGUsIGZtZHMpOwogICAgICAgIH0K\nICAgICAgICBmbWRzLmFkZChmbWQpOwogICAgfQogICAgCiAgICAvKgogICAg\nICogQXBwbHkgYW55IGRlZmVycmVkIG92ZXJyaWRlcy4KICAgICAqLwogICAg\ncHJvdGVjdGVkIHZvaWQgYXBwbHlEZWZlcnJlZEVtYmVkZGFibGVPdmVycmlk\nZXMoQ2xhc3M8Pz4gY2xzKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24g\newogICAgfQoKCS8qCgkgKiBBZGQgdGhlIGFycmF5IG9mIGNsYXNzZXMgdG8g\ndGhlIGFjdGl2ZSBwYXJzZSBsaXN0LgoJICovCiAgICBwdWJsaWMgdm9pZCBh\nZGRUb1BhcnNlTGlzdChBcnJheUxpc3Q8Q2xhc3M8Pz4+IHBhcnNlTGlzdCkg\newogICAgICAgIGlmIChwYXJzZUxpc3QgPT0gbnVsbCkKICAgICAgICAgICAg\ncmV0dXJuOwogICAgICAgIF9wYXJzZUxpc3QuYWRkQWxsKHBhcnNlTGlzdCk7\nCiAgICB9CiAgICAKICAgIC8qCiAgICAgKiBBZGQgdGhlIGNsYXNzIHRvIHRo\nZSBhY3RpdmUgcGFyc2UgbGlzdC4KICAgICAqLwogICAgcHVibGljIHZvaWQg\nYWRkVG9QYXJzZUxpc3QoQ2xhc3M8Pz4gcGFyZW50Q2xzKSB7CiAgICAgICAg\naWYgKHBhcmVudENscyA9PSBudWxsKQogICAgICAgICAgICByZXR1cm47CiAg\nICAgICAgX3BhcnNlTGlzdC5hZGQocGFyZW50Q2xzKTsKICAgIH0KCiAgICAv\nKgogICAgICogV2hldGhlciB0aGUgYWN0aXZlIHBhcnNlIGxpc3QgY29udGFp\nbnMgdGhlIHNwZWNpZmllZCBjbGFzcy4KICAgICAqLwogICAgcHVibGljIGJv\nb2xlYW4gcGFyc2VMaXN0Q29udGFpbnMoQ2xhc3M8Pz4gY2xzKSB7CiAgICAg\nICAgaWYgKF9wYXJzZUxpc3Quc2l6ZSgpID09IDApCiAgICAgICAgICAgIHJl\ndHVybiBmYWxzZTsKICAgICAgICByZXR1cm4gX3BhcnNlTGlzdC5jb250YWlu\ncyhjbHMpOwogICAgfQoKICAgIC8qCiAgICAgKiBSZXR1cm5zIHRoZSBsaXN0\nIG9mIGNsYXNzZXMgYWN0aXZlbHkgYmVpbmcgcGFyc2VkLgogICAgICovCiAg\nICBwdWJsaWMgQXJyYXlMaXN0PENsYXNzPD8+PiBnZXRQYXJzZUxpc3QoKSB7\nCiAgICAgICAgcmV0dXJuIF9wYXJzZUxpc3Q7CiAgICB9CiAgICAKICAgIC8q\nCiAgICAgKiBSZXR1cm5zIGNsYXNzIGN1cnJlbnRseSBiZWluZyBwYXJzZWQu\nCiAgICAgKi8KICAgIHB1YmxpYyBDbGFzczw/PiBnZXRQYXJzZUNsYXNzKCkg\newogICAgICAgIHJldHVybiBfY2xzOwogICAgfSAgICAKfQo=\n","encoding":"base64"}

