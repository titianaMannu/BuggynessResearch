{"sha":"0d2e7a4b88849e94ee74dc6b748ff38fcc142b19","node_id":"MDQ6QmxvYjIwNjM2NDowZDJlN2E0Yjg4ODQ5ZTk0ZWU3NGRjNmI3NDhmZjM4ZmNjMTQyYjE5","size":16681,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/0d2e7a4b88849e94ee74dc6b748ff38fcc142b19","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwoKcGFj\na2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuY3JpdGVyaWE7\nCgppbXBvcnQgamF2YS51dGlsLkFycmF5TGlzdDsKaW1wb3J0IGphdmEudXRp\nbC5IYXNoTWFwOwppbXBvcnQgamF2YS51dGlsLkhhc2hTZXQ7CmltcG9ydCBq\nYXZhLnV0aWwuTGlzdDsKaW1wb3J0IGphdmEudXRpbC5NYXA7CmltcG9ydCBq\nYXZhLnV0aWwuU2V0OwoKaW1wb3J0IGphdmF4LnBlcnNpc3RlbmNlLlR1cGxl\nOwppbXBvcnQgamF2YXgucGVyc2lzdGVuY2UuVHVwbGVFbGVtZW50OwppbXBv\ncnQgamF2YXgucGVyc2lzdGVuY2UuY3JpdGVyaWEuQ29tcG91bmRTZWxlY3Rp\nb247CmltcG9ydCBqYXZheC5wZXJzaXN0ZW5jZS5jcml0ZXJpYS5FeHByZXNz\naW9uOwppbXBvcnQgamF2YXgucGVyc2lzdGVuY2UuY3JpdGVyaWEuRmV0Y2g7\nCmltcG9ydCBqYXZheC5wZXJzaXN0ZW5jZS5jcml0ZXJpYS5Kb2luOwppbXBv\ncnQgamF2YXgucGVyc2lzdGVuY2UuY3JpdGVyaWEuSm9pblR5cGU7CmltcG9y\ndCBqYXZheC5wZXJzaXN0ZW5jZS5jcml0ZXJpYS5PcmRlcjsKaW1wb3J0IGph\ndmF4LnBlcnNpc3RlbmNlLmNyaXRlcmlhLlJvb3Q7CmltcG9ydCBqYXZheC5w\nZXJzaXN0ZW5jZS5jcml0ZXJpYS5TZWxlY3Rpb247CmltcG9ydCBqYXZheC5w\nZXJzaXN0ZW5jZS5tZXRhbW9kZWwuVHlwZS5QZXJzaXN0ZW5jZVR5cGU7Cgpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5GaWxsU3RyYXRlZ3k7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLlF1ZXJ5T3BlcmF0\naW9uczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuUmVzdWx0\nU2hhcGU7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLmV4cHMu\nQWJzdHJhY3RFeHByZXNzaW9uQnVpbGRlcjsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS5rZXJuZWwuZXhwcy5FeHByZXNzaW9uRmFjdG9yeTsKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuZXhwcy5RdWVyeUV4cHJlc3Np\nb25zOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5leHBzLlZh\nbHVlOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuQ2xhc3NNZXRh\nRGF0YTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5U\ndXBsZUZhY3Rvcnk7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lz\ndGVuY2UuVHVwbGVJbXBsOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnBl\ncnNpc3RlbmNlLm1ldGEuQWJzdHJhY3RNYW5hZ2VkVHlwZTsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5tZXRhLk1lbWJlcnM7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UubWV0YS5NZXRh\nbW9kZWxJbXBsOwoKLyoqCiAqIENvbnZlcnRzIGV4cHJlc3Npb25zIG9mIGEg\nQ3JpdGVyaWFRdWVyeSB0byBrZXJuZWwgRXhwcmVzc2lvbi4KICogCiAqIAog\nKiBAYXV0aG9yIFBpbmFraSBQb2RkYXIKICogQGF1dGhvciBGYXkgV2FuZwog\nKiAKICogQHNpbmNlIDIuMC4wCiAqLwpjbGFzcyBDcml0ZXJpYUV4cHJlc3Np\nb25CdWlsZGVyIHsKICAgIAogICAgcHVibGljIFF1ZXJ5RXhwcmVzc2lvbnMg\nZ2V0UXVlcnlFeHByZXNzaW9ucyhFeHByZXNzaW9uRmFjdG9yeSBmYWN0b3J5\nLCBDcml0ZXJpYVF1ZXJ5SW1wbDw/PiBxKSB7CiAgICAgICAgUXVlcnlFeHBy\nZXNzaW9ucyBleHBzID0gbmV3IFF1ZXJ5RXhwcmVzc2lvbnMoKTsKICAgICAg\nICBleHBzLnNldENvbnRleHRzKHEuZ2V0Q29udGV4dHMoKSk7CgogICAgICAg\nIGV2YWxBY2Nlc3NQYXRocyhleHBzLCBmYWN0b3J5LCBxKTsKICAgICAgICBl\neHBzLmFsaWFzID0gbnVsbDsgICAgICAvLyBTdHJpbmcgICAKICAgICAgICBl\ndmFsRGlzdGluY3QoZXhwcywgZmFjdG9yeSwgcSk7CiAgICAgICAgZXZhbEZl\ndGNoSm9pbihleHBzLCBmYWN0b3J5LCBxKTsKICAgICAgICBldmFsQ3Jvc3NK\nb2luUm9vdHMoZXhwcywgZmFjdG9yeSwgcSk7CiAgICAgICAgZXZhbEZpbHRl\ncihleHBzLCBmYWN0b3J5LCBxKTsKICAgICAgICBldmFsR3JvdXBpbmcoZXhw\ncywgZmFjdG9yeSwgcSk7CiAgICAgICAgZXZhbE9yZGVyaW5nQW5kUHJvamVj\ndGlvbihleHBzLCBmYWN0b3J5LCBxKTsKICAgICAgICBleHBzLm9wZXJhdGlv\nbiA9IFF1ZXJ5T3BlcmF0aW9ucy5PUF9TRUxFQ1Q7CiAgICAgICAgZXhwcy5y\nYW5nZSA9IFF1ZXJ5RXhwcmVzc2lvbnMuRU1QVFlfVkFMVUVTOwogICAgICAg\nIGV4cHMucmVzdWx0Q2xhc3MgPSBxLmdldFJlc3VsdFR5cGUoKTsKICAgICAg\nICBleHBzLnNoYXBlID0gZXZhbFJlc3VsdFNoYXBlKHEpOwogICAgICAgIGV4\ncHMucGFyYW1ldGVyVHlwZXMgPSBxLmdldFBhcmFtZXRlclR5cGVzKCk7CiAg\nICAgICAgZXhwcy5pc0FnZ3JlZ2F0ZSgpOwogICAgICAgIHJldHVybiBleHBz\nOwogICAgfQoKICAgIHByb3RlY3RlZCB2b2lkIGV2YWxBY2Nlc3NQYXRocyhR\ndWVyeUV4cHJlc3Npb25zIGV4cHMsIEV4cHJlc3Npb25GYWN0b3J5IGZhY3Rv\ncnksIENyaXRlcmlhUXVlcnlJbXBsPD8+IHEpIHsKICAgICAgICBTZXQ8Q2xh\nc3NNZXRhRGF0YT4gbWV0YXMgPSBuZXcgSGFzaFNldDxDbGFzc01ldGFEYXRh\nPigpOwogICAgICAgIE1ldGFtb2RlbEltcGwgbWV0YW1vZGVsID0gcS5nZXRN\nZXRhbW9kZWwoKTsgICAgCiAgICAgICAgZm9yIChSb290PD8+IHJvb3QgOiBx\nLmdldFJvb3RzKCkpIHsKICAgICAgICAgICAgbWV0YXMuYWRkKCgoQWJzdHJh\nY3RNYW5hZ2VkVHlwZTw/Pilyb290LmdldE1vZGVsKCkpLm1ldGEpOwogICAg\nICAgICAgICBmb3IgKEpvaW48Pyw/PiBqb2luIDogcm9vdC5nZXRKb2lucygp\nKSB7CiAgICAgICAgICAgICAgICBDbGFzczw/PiBjbHMgPSBqb2luLmdldEF0\ndHJpYnV0ZSgpLmdldEphdmFUeXBlKCk7CiAgICAgICAgICAgICAgICBpZiAo\nam9pbi5nZXRBdHRyaWJ1dGUoKS5pc0Fzc29jaWF0aW9uKCkpIHsKICAgICAg\nICAgICAgICAgICAgICBDbGFzc01ldGFEYXRhIG1ldGEgPSBtZXRhbW9kZWwu\nZ2V0UmVwb3NpdG9yeSgpLmdldE1ldGFEYXRhKGNscywgbnVsbCwgdHJ1ZSk7\nCiAgICAgICAgICAgICAgICAgICAgUGVyc2lzdGVuY2VUeXBlIHR5cGUgPSBN\nZXRhbW9kZWxJbXBsLmdldFBlcnNpc3RlbmNlVHlwZShtZXRhKTsKICAgICAg\nICAgICAgICAgICAgICBpZiAodHlwZSA9PSBQZXJzaXN0ZW5jZVR5cGUuRU5U\nSVRZIHx8IHR5cGUgPT0gUGVyc2lzdGVuY2VUeXBlLkVNQkVEREFCTEUpIAog\nICAgICAgICAgICAgICAgICAgICAgICBtZXRhcy5hZGQobWV0YSk7CiAgICAg\nICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZm9yIChG\nZXRjaDw/LD8+IGZldGNoIDogcm9vdC5nZXRGZXRjaGVzKCkpIHsKICAgICAg\nICAgICAgICAgIG1ldGFzLmFkZChtZXRhbW9kZWwuZ2V0UmVwb3NpdG9yeSgp\nLmdldENhY2hlZE1ldGFEYXRhKGZldGNoLmdldEF0dHJpYnV0ZSgpLmdldEph\ndmFUeXBlKCkpKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBl\neHBzLmFjY2Vzc1BhdGggPSBtZXRhcy50b0FycmF5KG5ldyBDbGFzc01ldGFE\nYXRhW21ldGFzLnNpemUoKV0pOwogICAgfQoKICAgIHByb3RlY3RlZCB2b2lk\nIGV2YWxPcmRlcmluZ0FuZFByb2plY3Rpb24oUXVlcnlFeHByZXNzaW9ucyBl\neHBzLCBFeHByZXNzaW9uRmFjdG9yeSBmYWN0b3J5LCBDcml0ZXJpYVF1ZXJ5\nSW1wbDw/PiBxKSB7CiAgICAgICAgTWFwPEV4cHJlc3Npb25JbXBsPD8+LCBW\nYWx1ZT4gZXhwMlZhbHMgPSBldmFsT3JkZXJpbmcoZXhwcywgZmFjdG9yeSwg\ncSk7CiAgICAgICAgZXZhbFByb2plY3Rpb25zKGV4cHMsIGZhY3RvcnksIHEs\nIGV4cDJWYWxzKTsKICAgIH0KICAgIAogICAgLyoqCiAgICAgKiBFdmFsdWF0\nZXMgdGhlIG9yZGVyaW5nIGV4cHJlc3Npb25zIGJ5IGNvbnZlcnRpbmcgdGhl\nbSB0byBrZXJuZWwgdmFsdWVzLgogICAgICogU2V0cyB0aGUgb3JkZXJpbmcg\nZmllbGRzIG9mIGtlcm5lbCBRdWVyeUV4cHJlc3Npb25zLgogICAgICogICAK\nICAgICAqIEBwYXJhbSBleHBzIGtlcm5lbCBRdWVyeUV4cHJlc3Npb25zCiAg\nICAgKiBAcGFyYW0gZmFjdG9yeSBmb3Iga2VybmVsIGV4cHJlc3Npb25zCiAg\nICAgKiBAcGFyYW0gcSBhIGNyaXRlcmlhIHF1ZXJ5CiAgICAgKiAKICAgICAq\nIEByZXR1cm4gbWFwIG9mIGtlcm5lbCB2YWx1ZXMgaW5kZXhlZCBieSBjcml0\nZXJpYSBxdWVyeSBleHByZXNzaW9ucyB0aGF0IGNyZWF0ZWQgaXQuCiAgICAg\nKiBUaGVzZSBrZXJuZWwgdmFsdWVzIGFyZSByZXF1aXJlZCB0byBiZSBoZWxk\nIGluIGEgbWFwIHRvIGF2b2lkIHJlY29tcHV0aW5nIGZvciB0aGUKICAgICAq\nIHNhbWUgQ3JpdGVyaWFRdWVyeSBFeHByZXNzaW9ucyBhcHBlYXJpbmcgaW4g\nb3JkZXJpbmcgdGVybXMgYXMgd2VsbCBhcyBwcm9qZWN0aW9uCiAgICAgKiB0\nZXJtLiAKICAgICAqIAogICAgICovCiAgICBwcm90ZWN0ZWQgTWFwPEV4cHJl\nc3Npb25JbXBsPD8+LCBWYWx1ZT4gZXZhbE9yZGVyaW5nKFF1ZXJ5RXhwcmVz\nc2lvbnMgZXhwcywgRXhwcmVzc2lvbkZhY3RvcnkgZmFjdG9yeSwgCiAgICAg\nICAgQ3JpdGVyaWFRdWVyeUltcGw8Pz4gcSkgewogICAgICAgIExpc3Q8T3Jk\nZXI+IG9yZGVycyA9IHEuZ2V0T3JkZXJMaXN0KCk7CiAgICAgICAgTWV0YW1v\nZGVsSW1wbCBtb2RlbCA9IHEuZ2V0TWV0YW1vZGVsKCk7IAogICAgICAgIGlu\ndCBvcmRlcmNvdW50ID0gKG9yZGVycyA9PSBudWxsKSA/IDAgOiBvcmRlcnMu\nc2l6ZSgpOwogICAgICAgIE1hcDxFeHByZXNzaW9uSW1wbDw/PiwgVmFsdWU+\nIGV4cDJWYWxzID0gbmV3IEhhc2hNYXA8RXhwcmVzc2lvbkltcGw8Pz4sIFZh\nbHVlPigpOwogICAgICAgIGV4cHMub3JkZXJpbmcgPSBuZXcgVmFsdWVbb3Jk\nZXJjb3VudF07CiAgICAgICAgZXhwcy5vcmRlcmluZ0NsYXVzZXMgPSBuZXcg\nU3RyaW5nW29yZGVyY291bnRdOwogICAgICAgIGV4cHMub3JkZXJpbmdBbGlh\nc2VzID0gbmV3IFN0cmluZ1tvcmRlcmNvdW50XTsKICAgICAgICBleHBzLmFz\nY2VuZGluZyA9IG5ldyBib29sZWFuW29yZGVyY291bnRdOwogICAgICAgIGZv\nciAoaW50IGkgPSAwOyBpIDwgb3JkZXJjb3VudDsgaSsrKSB7CiAgICAgICAg\nICAgIE9yZGVySW1wbCBvcmRlciA9IChPcmRlckltcGwpb3JkZXJzLmdldChp\nKTsKICAgICAgICAgICAgRXhwcmVzc2lvbkltcGw8Pz4gZXhwciA9IG9yZGVy\nLmdldEV4cHJlc3Npb24oKTsKICAgICAgICAgICAgVmFsdWUgdmFsID0gRXhw\ncmVzc2lvbnMudG9WYWx1ZShleHByLCBmYWN0b3J5LCBxKTsKICAgICAgICAg\nICAgZXhwcy5vcmRlcmluZ1tpXSA9IHZhbDsKICAgICAgICAgICAgU3RyaW5n\nIGFsaWFzID0gZXhwci5nZXRBbGlhcygpOwogICAgICAgICAgICBleHBzLm9y\nZGVyaW5nQWxpYXNlc1tpXSA9IGFsaWFzOwogICAgICAgICAgICBleHBzLm9y\nZGVyaW5nQ2xhdXNlc1tpXSA9ICIiOwogICAgICAgICAgICB2YWwuc2V0QWxp\nYXMoYWxpYXMpOwogICAgICAgICAgICBleHBzLmFzY2VuZGluZ1tpXSA9IG9y\nZGVyLmlzQXNjZW5kaW5nKCk7CiAgICAgICAgICAgIGV4cDJWYWxzLnB1dChl\neHByLCB2YWwpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gZXhwMlZhbHM7\nCiAgICB9CgogICAgcHJvdGVjdGVkIHZvaWQgZXZhbEdyb3VwaW5nKFF1ZXJ5\nRXhwcmVzc2lvbnMgZXhwcywgRXhwcmVzc2lvbkZhY3RvcnkgZmFjdG9yeSwg\nQ3JpdGVyaWFRdWVyeUltcGw8Pz4gcSkgewogICAgICAgIC8vICAgIGV4cHMu\nZ3JvdXBpbmcgPSBudWxsOyAvLyBWYWx1ZVtdCiAgICAgICAgLy8gICAgZXhw\ncy5ncm91cGluZ0NsYXVzZXMgPSBudWxsOyAvLyBTdHJpbmdbXQogICAgICAg\nIExpc3Q8RXhwcmVzc2lvbjw/Pj4gZ3JvdXBzID0gcS5nZXRHcm91cExpc3Qo\nKTsKICAgICAgICBNZXRhbW9kZWxJbXBsIG1vZGVsID0gcS5nZXRNZXRhbW9k\nZWwoKTsKICAgICAgICBQcmVkaWNhdGVJbXBsIGhhdmluZyA9IHEuZ2V0R3Jv\ndXBSZXN0cmljdGlvbigpOwogICAgICAgIGlmIChncm91cHMgPT0gbnVsbCkg\nCiAgICAgICAgICAgIHJldHVybjsKICAgICAgICBpbnQgZ3JvdXBCeUNvdW50\nID0gZ3JvdXBzLnNpemUoKTsKICAgICAgICBleHBzLmdyb3VwaW5nID0gbmV3\nIFZhbHVlW2dyb3VwQnlDb3VudF07CiAgICAgICAgZm9yIChpbnQgaSA9IDA7\nIGkgPCBncm91cEJ5Q291bnQ7IGkrKykgewogICAgICAgICAgICBFeHByZXNz\naW9uPD8+IGdyb3VwQnkgPSBncm91cHMuZ2V0KGkpOyAgICAKICAgICAgICAg\nICAgZXhwcy5ncm91cGluZ1tpXSA9IEV4cHJlc3Npb25zLnRvVmFsdWUoKEV4\ncHJlc3Npb25JbXBsPD8+KWdyb3VwQnksIGZhY3RvcnksIHEpOzsKICAgICAg\nICB9CgogICAgICAgIGV4cHMuaGF2aW5nID0gaGF2aW5nID09IG51bGwgPyBu\ndWxsIDogaGF2aW5nLnRvS2VybmVsRXhwcmVzc2lvbihmYWN0b3J5LCBxKTsK\nICAgIH0KCiAgICBwcm90ZWN0ZWQgdm9pZCBldmFsRGlzdGluY3QoUXVlcnlF\neHByZXNzaW9ucyBleHBzLCBFeHByZXNzaW9uRmFjdG9yeSBmYWN0b3J5LCBD\ncml0ZXJpYVF1ZXJ5SW1wbDw/PiBxKSB7CiAgICAgICAgZXhwcy5kaXN0aW5j\ndCA9IHEuaXNEaXN0aW5jdCgpID8gUXVlcnlFeHByZXNzaW9ucy5ESVNUSU5D\nVF9UUlVFIHwgUXVlcnlFeHByZXNzaW9ucy5ESVNUSU5DVF9BVVRPCiAgICAg\nICAgICAgICAgICA6IFF1ZXJ5RXhwcmVzc2lvbnMuRElTVElOQ1RfRkFMU0U7\nCiAgICAgfQoKICAgIHByb3RlY3RlZCB2b2lkIGV2YWxDcm9zc0pvaW5Sb290\ncyhRdWVyeUV4cHJlc3Npb25zIGV4cHMsIEV4cHJlc3Npb25GYWN0b3J5IGZh\nY3RvcnksIENyaXRlcmlhUXVlcnlJbXBsPD8+IHEpIHsKICAgICAgICBTZXQ8\nUm9vdDw/Pj4gcm9vdHMgPSBxLmdldFJvb3RzKCk7CiAgICAgICAgU3VicXVl\ncnlJbXBsPD8+IHN1YlF1ZXJ5ID0gcS5nZXREZWxlZ2F0b3IoKTsKICAgICAg\nICBpZiAoc3ViUXVlcnkgPT0gbnVsbCB8fCBzdWJRdWVyeS5nZXRDb3JyZWxh\ndGVkSm9pbnMoKSA9PSBudWxsKSB7CiAgICAgICAgICAgIHEuYXNzZXJ0Um9v\ndCgpOwogICAgICAgICAgICBpZiAocm9vdHMuc2l6ZSgpID4gMSkgeyAvLyBj\ncm9zcyBqb2luCiAgICAgICAgICAgICAgICBmb3IgKFJvb3Q8Pz4gcm9vdCA6\nIHJvb3RzKSB7CiAgICAgICAgICAgICAgICAgICAgU3RyaW5nIGFsaWFzID0g\ncS5nZXRBbGlhcyhyb290KTsKICAgICAgICAgICAgICAgICAgICBWYWx1ZSB2\nYXIgPSBmYWN0b3J5Lm5ld0JvdW5kVmFyaWFibGUoYWxpYXMsIEFic3RyYWN0\nRXhwcmVzc2lvbkJ1aWxkZXIuVFlQRV9PQkpFQ1QpOwogICAgICAgICAgICAg\nICAgICAgIHZhci5zZXRNZXRhRGF0YSgoKEFic3RyYWN0TWFuYWdlZFR5cGU8\nPz4pcm9vdC5nZXRNb2RlbCgpKS5tZXRhKTsKICAgICAgICAgICAgICAgICAg\nICBxLnJlZ2lzdGVyUm9vdChyb290LCB2YXIpOwogICAgICAgICAgICAgICAg\nfQogICAgICAgICAgICB9ICAgICAgICAgCiAgICAgICAgfQogICAgfQogICAg\nCiAgICBwcm90ZWN0ZWQgdm9pZCBldmFsRmlsdGVyKFF1ZXJ5RXhwcmVzc2lv\nbnMgZXhwcywgRXhwcmVzc2lvbkZhY3RvcnkgZmFjdG9yeSwgQ3JpdGVyaWFR\ndWVyeUltcGw8Pz4gcSkgewogICAgICAgIFNldDxSb290PD8+PiByb290cyA9\nIHEuZ2V0Um9vdHMoKTsKICAgICAgICBNZXRhbW9kZWxJbXBsIG1vZGVsID0g\ncS5nZXRNZXRhbW9kZWwoKTsKICAgICAgICBQcmVkaWNhdGVJbXBsIHdoZXJl\nID0gcS5nZXRSZXN0cmljdGlvbigpOwogICAgICAgIFN1YnF1ZXJ5SW1wbDw/\nPiBzdWJRdWVyeSA9IHEuZ2V0RGVsZWdhdG9yKCk7CiAgICAgICAgb3JnLmFw\nYWNoZS5vcGVuanBhLmtlcm5lbC5leHBzLkV4cHJlc3Npb24gZmlsdGVyID0g\nbnVsbDsKICAgICAgICBpZiAoc3ViUXVlcnkgPT0gbnVsbCB8fCBzdWJRdWVy\neS5nZXRDb3JyZWxhdGVkSm9pbnMoKSA9PSBudWxsKSB7CiAgICAgICAgICAg\nIHEuYXNzZXJ0Um9vdCgpOwogICAgICAgICAgICBmb3IgKFJvb3Q8Pz4gcm9v\ndCA6IHJvb3RzKSB7CiAgICAgICAgICAgICAgICBmb3IgKEpvaW48PywgPz4g\nam9pbiA6IHJvb3QuZ2V0Sm9pbnMoKSkgewogICAgICAgICAgICAgICAgICAg\nIGZpbHRlciA9IEV4cHJlc3Npb25zLmFuZChmYWN0b3J5LCAKICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICgoRXhwcmVzc2lvbkltcGw8Pz4pam9pbiku\ndG9LZXJuZWxFeHByZXNzaW9uKGZhY3RvcnksIHEpLCBmaWx0ZXIpOwogICAg\nICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgKChSb290SW1wbDw/Pily\nb290KS5hZGRUb0NvbnRleHQoZmFjdG9yeSwgbW9kZWwsIHEpOwogICAgICAg\nICAgICB9CiAgICAgICAgfQogICAgICAgIGlmIChzdWJRdWVyeSAhPSBudWxs\nKSB7CiAgICAgICAgICAgIExpc3Q8Sm9pbjw/LD8+PiBjb3JySm9pbnMgPSBz\ndWJRdWVyeS5nZXRDb3JyZWxhdGVkSm9pbnMoKTsKICAgICAgICAgICAgZm9y\nIChpbnQgaSA9IDA7IGNvcnJKb2lucyAhPSBudWxsICYmIGkgPCBjb3JySm9p\nbnMuc2l6ZSgpOyBpKyspIHsKICAgICAgICAgICAgICAgIGZpbHRlciA9IEV4\ncHJlc3Npb25zLmFuZChmYWN0b3J5LCAoKEV4cHJlc3Npb25JbXBsPD8+KWNv\ncnJKb2lucy5nZXQoaSkpCiAgICAgICAgICAgICAgICAgICAgICAgIC50b0tl\ncm5lbEV4cHJlc3Npb24oZmFjdG9yeSwgcSksIGZpbHRlcik7CiAgICAgICAg\nICAgIH0KICAgICAgICB9CiAgICAgICAgCiAgICAgICAgaWYgKHdoZXJlICE9\nIG51bGwpIHsKICAgICAgICAgICAgZmlsdGVyID0gRXhwcmVzc2lvbnMuYW5k\nKGZhY3RvcnksIHdoZXJlLnRvS2VybmVsRXhwcmVzc2lvbihmYWN0b3J5LCBx\nKSwgZmlsdGVyKTsKICAgICAgICB9CiAgICAgICAgaWYgKGZpbHRlciA9PSBu\ndWxsKSB7CiAgICAgICAgICAgIGZpbHRlciA9IGZhY3RvcnkuZW1wdHlFeHBy\nZXNzaW9uKCk7CiAgICAgICAgfQogICAgICAgIGV4cHMuZmlsdGVyID0gZmls\ndGVyOwogICAgfQoKICAgIHByb3RlY3RlZCB2b2lkIGV2YWxQcm9qZWN0aW9u\ncyhRdWVyeUV4cHJlc3Npb25zIGV4cHMsIEV4cHJlc3Npb25GYWN0b3J5IGZh\nY3RvcnksIENyaXRlcmlhUXVlcnlJbXBsPD8+IHEsCiAgICAgICAgTWFwPEV4\ncHJlc3Npb25JbXBsPD8+LCBWYWx1ZT4gZXhwMlZhbHMpIHsKICAgICAgICBM\naXN0PFNlbGVjdGlvbjw/Pj4gc2VsZWN0aW9ucyA9IHEuZ2V0U2VsZWN0aW9u\nTGlzdCgpOwogICAgICAgIE1ldGFtb2RlbEltcGwgbW9kZWwgPSBxLmdldE1l\ndGFtb2RlbCgpOwogICAgICAgIGlmIChxLmlzRGVmYXVsdFByb2plY3Rpb24o\nKSkgewogICAgICAgICAgICBleHBzLnByb2plY3Rpb25zID0gbmV3IFZhbHVl\nWzBdOwogICAgICAgICAgICByZXR1cm4gOwogICAgICAgIH0KICAgICAgICBl\neHBzLnByb2plY3Rpb25zID0gbmV3IFZhbHVlW3NlbGVjdGlvbnMuc2l6ZSgp\nXTsKICAgICAgICBMaXN0PFZhbHVlPiBwcm9qZWN0aW9ucyA9IG5ldyBBcnJh\neUxpc3Q8VmFsdWU+KCk7CiAgICAgICAgTGlzdDxTdHJpbmc+IGFsaWFzZXMg\nPSBuZXcgQXJyYXlMaXN0PFN0cmluZz4oKTsKICAgICAgICBMaXN0PFN0cmlu\nZz4gY2xhdXNlcyA9IG5ldyBBcnJheUxpc3Q8U3RyaW5nPigpOwogICAgICAg\nIGdldFByb2plY3Rpb25zKGV4cHMsIHNlbGVjdGlvbnMsIHByb2plY3Rpb25z\nLCBhbGlhc2VzLCBjbGF1c2VzLCBmYWN0b3J5LCBxLCBtb2RlbCwgZXhwMlZh\nbHMpOwogICAgICAgIGV4cHMucHJvamVjdGlvbnMgPSBwcm9qZWN0aW9ucy50\nb0FycmF5KG5ldyBWYWx1ZVtwcm9qZWN0aW9ucy5zaXplKCldKTsKICAgICAg\nICBleHBzLnByb2plY3Rpb25BbGlhc2VzID0gYWxpYXNlcy50b0FycmF5KG5l\ndyBTdHJpbmdbYWxpYXNlcy5zaXplKCldKTsKICAgICAgICBleHBzLnByb2pl\nY3Rpb25DbGF1c2VzID0gY2xhdXNlcy50b0FycmF5KG5ldyBTdHJpbmdbY2xh\ndXNlcy5zaXplKCldKTsKICAgIH0KCiAgICAvKioKICAgICAqIFNjYW5zIHRo\nZSBwcm9qZWN0aW9uIHRlcm1zIHRvIHBvcHVsYXRlIHRoZSBrZXJuZWwgUXVl\ncnlFeHByZXNzaW9ucyBwcm9qZWN0aW9uIGNsYXVzZXMKICAgICAqIGFuZCBh\nbGlhc2VzLgogICAgICogICAKICAgICAqIEBwYXJhbSBleHBzIAogICAgICog\nQHBhcmFtIHNlbGVjdGlvbnMKICAgICAqIEBwYXJhbSBwcm9qZWN0aW9ucyBs\naXN0IG9mIGtlcm5lbCB2YWx1ZXMgZm9yIHByb2plY3Rpb25zIAogICAgICog\nQHBhcmFtIGFsaWFzZXMgbGlzdCBvZiBrZXJuZWwgcHJvamVjdGlvbiBhbGlh\nc2VzIAogICAgICogQHBhcmFtIGNsYXVzZXMgbGlzdCBvZiBrZXJuZWwgcHJv\namVjdGlvbiBjbGF1c2VzCiAgICAgKiBAcGFyYW0gZmFjdG9yeSBmb3Iga2Vy\nbmVsIGV4cHJlc3Npb25zCiAgICAgKiBAcGFyYW0gcSBhIENyaXRlcmlhIFF1\nZXJ5CiAgICAgKiBAcGFyYW0gbW9kZWwgb2YgZG9tYWluIGVudGl0aWVzCiAg\nICAgKiBAcGFyYW0gZXhwMlZhbHMgdGhlIGV2YWx1YXRlZCBrZXJuZWwgdmFs\ndWVzIGluZGV4ZWQgYnkgdGhlIENyaXRlcmlhIEV4cHJlc3Npb25zCiAgICAg\nKi8KICAgIHByaXZhdGUgdm9pZCBnZXRQcm9qZWN0aW9ucyhRdWVyeUV4cHJl\nc3Npb25zIGV4cHMsIExpc3Q8U2VsZWN0aW9uPD8+PiBzZWxlY3Rpb25zLCAK\nICAgICAgICBMaXN0PFZhbHVlPiBwcm9qZWN0aW9ucywgTGlzdDxTdHJpbmc+\nIGFsaWFzZXMsIExpc3Q8U3RyaW5nPiBjbGF1c2VzLCAKICAgICAgICBFeHBy\nZXNzaW9uRmFjdG9yeSBmYWN0b3J5LCBDcml0ZXJpYVF1ZXJ5SW1wbDw/PiBx\nLCBNZXRhbW9kZWxJbXBsIG1vZGVsLCAKICAgICAgICBNYXA8RXhwcmVzc2lv\nbkltcGw8Pz4sIFZhbHVlPiBleHAyVmFscykgewoKICAgICAgICBpZiAoc2Vs\nZWN0aW9ucy5zaXplKCkgPT0gMCAmJiBxLmdldERlbGVnYXRvcigpICE9IG51\nbGwpIHsgLy8gdGhpcyBpcyBzdWJxdWVyeQogICAgICAgICAgICBSb290PD8+\nIHIgPSBxLmdldFJvb3QoKTsKICAgICAgICAgICAgc2VsZWN0aW9ucyA9IG5l\ndyBBcnJheUxpc3Q8U2VsZWN0aW9uPD8+PigxKTsKICAgICAgICAgICAgc2Vs\nZWN0aW9ucy5hZGQocik7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIGZv\nciAoU2VsZWN0aW9uPD8+IHMgOiBzZWxlY3Rpb25zKSB7CiAgICAgICAgICAg\nIGlmIChzLmlzQ29tcG91bmRTZWxlY3Rpb24oKSkgewogICAgICAgICAgICAg\nICAgZ2V0UHJvamVjdGlvbnMoZXhwcywgcy5nZXRDb21wb3VuZFNlbGVjdGlv\nbkl0ZW1zKCksIHByb2plY3Rpb25zLCBhbGlhc2VzLCAKICAgICAgICAgICAg\nICAgICAgICBjbGF1c2VzLCBmYWN0b3J5LCBxLCBtb2RlbCwgZXhwMlZhbHMp\nOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgVmFsdWUg\ndmFsID0gKGV4cDJWYWxzICE9IG51bGwgJiYgZXhwMlZhbHMuY29udGFpbnNL\nZXkocykgCiAgICAgICAgICAgICAgICAgICAgICAgID8gZXhwMlZhbHMuZ2V0\nKHMpIDogKChFeHByZXNzaW9uSW1wbDw/PilzKS50b1ZhbHVlKGZhY3Rvcnks\nIHEpKTsKICAgICAgICAgICAgICAgIFN0cmluZyBhbGlhcyA9IHMuZ2V0QWxp\nYXMoKTsKICAgICAgICAgICAgICAgIHZhbC5zZXRBbGlhcyhhbGlhcyk7CiAg\nICAgICAgICAgICAgICBwcm9qZWN0aW9ucy5hZGQodmFsKTsKICAgICAgICAg\nICAgICAgIGFsaWFzZXMuYWRkKGFsaWFzKTsKICAgICAgICAgICAgICAgIGNs\nYXVzZXMuYWRkKGFsaWFzKTsKICAgICAgICAgICAgfSAgICAgICAgIAogICAg\nICAgIH0KICAgIH0KCiAgICBwcm90ZWN0ZWQgdm9pZCBldmFsRmV0Y2hKb2lu\nKFF1ZXJ5RXhwcmVzc2lvbnMgZXhwcywgRXhwcmVzc2lvbkZhY3RvcnkgZmFj\ndG9yeSwgQ3JpdGVyaWFRdWVyeUltcGw8Pz4gcSkgewogICAgICAgIExpc3Q8\nU3RyaW5nPiBpUGF0aHMgPSBuZXcgQXJyYXlMaXN0PFN0cmluZz4oKTsKICAg\nICAgICBMaXN0PFN0cmluZz4gb1BhdGhzID0gbmV3IEFycmF5TGlzdDxTdHJp\nbmc+KCk7CiAgICAgICAgU2V0PFJvb3Q8Pz4+IHJvb3RzID0gcS5nZXRSb290\ncygpOwogICAgICAgIGZvciAoUm9vdCByb290IDogcm9vdHMpIHsKICAgICAg\nICAgICAgU2V0PEZldGNoPiBmZXRjaGVzID0gcm9vdC5nZXRGZXRjaGVzKCk7\nCiAgICAgICAgICAgIGlmIChmZXRjaGVzID09IG51bGwpCiAgICAgICAgICAg\nICAgICBjb250aW51ZTsKICAgICAgICAgICAgZm9yIChGZXRjaDw/LD8+IGZl\ndGNoIDogZmV0Y2hlcykgewogICAgICAgICAgICAgICAgU3RyaW5nIGZQYXRo\nID0gKChNZW1iZXJzLk1lbWJlcjw/LCA/PilmZXRjaC5nZXRBdHRyaWJ1dGUo\nKSkuZm1kLmdldEZ1bGxOYW1lKGZhbHNlKTsKICAgICAgICAgICAgICAgIG9Q\nYXRocy5hZGQoZlBhdGgpOwogICAgICAgICAgICAgICAgaWYgKGZldGNoLmdl\ndEpvaW5UeXBlKCkgPT0gSm9pblR5cGUuSU5ORVIpIHsKICAgICAgICAgICAg\nICAgICAgIGlQYXRocy5hZGQoZlBhdGgpOwogICAgICAgICAgICAgICAgfSAK\nICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBpZiAoIWlQYXRocy5p\nc0VtcHR5KCkpIHsKICAgICAgICAgICAgZXhwcy5mZXRjaElubmVyUGF0aHMg\nPSBpUGF0aHMudG9BcnJheShuZXcgU3RyaW5nW2lQYXRocy5zaXplKCldKTsK\nICAgICAgICB9CiAgICAgICAgaWYgKCFvUGF0aHMuaXNFbXB0eSgpKSB7CiAg\nICAgICAgICAgIGV4cHMuZmV0Y2hQYXRocyA9IG9QYXRocy50b0FycmF5KG5l\ndyBTdHJpbmdbb1BhdGhzLnNpemUoKV0pOwogICAgICAgIH0KICAgIH0KCiAg\nICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09\nPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQog\nICAgLy8gUmVzdWx0IFNoYXBlIHByb2Nlc3NpbmcKICAgIC8vID09PT09PT09\nPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09\nPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiAgICAKICAgIC8qKgog\nICAgICogR2V0cyB0aGUgc2hhcGUgb2YgYSBzZWxlY3Rpb24gaXRlbS4gQ3Jl\nYXRlcyB0aGUgc2hhcGUgaWYgbmVjZXNzYXJ5LgogICAgICogCiAgICAgKiBA\ncGFyYW0gcSB0aGUgb3JpZ2luYWwgcXVlcnkKICAgICAqIEBwYXJhbSBwYXJl\nbnQgdGhlIHBhcmVudCBzaGFwZSB0aGF0IG5lc3RzIHRoaXMgZ2l2ZW4gc2Vs\nZWN0aW9uCiAgICAgKiBAcGFyYW0gcyB0aGUgc2VsZWN0aW9uIHRlcm0gZm9y\nIHdoaWNoIGEgcmVzdWx0IHNoYXBlIHRvIGJlIGNvbXB1dGVkCiAgICAgKi8K\nICAgIFJlc3VsdFNoYXBlPD8+IGdldFNoYXBlKENyaXRlcmlhUXVlcnlJbXBs\nPD8+IHEsIFJlc3VsdFNoYXBlPD8+IHBhcmVudCwgU2VsZWN0aW9uPD8+IHMp\nIHsKICAgICAgICBSZXN1bHRTaGFwZTw/PiByZXN1bHQgPSBudWxsOwogICAg\nICAgIENsYXNzPD8+IHR5cGUgPSBzLmdldEphdmFUeXBlKCk7CiAgICAgICAg\naWYgKHR5cGUgPT0gbnVsbCkKICAgICAgICAgICAgdHlwZSA9IE9iamVjdC5j\nbGFzczsKICAgICAgICBpZiAocy5pc0NvbXBvdW5kU2VsZWN0aW9uKCkpIHsK\nICAgICAgICAgICAgQ29tcG91bmRTZWxlY3Rpb248Pz4gY3MgPSAoQ29tcG91\nbmRTZWxlY3Rpb248Pz4pczsKICAgICAgICAgICAgcmVzdWx0ID0gbmV3IFJl\nc3VsdFNoYXBlKHMuZ2V0SmF2YVR5cGUoKSwgQ29tcG91bmRTZWxlY3Rpb25z\nLmdldEZpbGxTdHJhdGVneShjcykpOwogICAgICAgICAgICBMaXN0PFNlbGVj\ndGlvbjw/Pj4gdGVybXMgPSBjcy5nZXRDb21wb3VuZFNlbGVjdGlvbkl0ZW1z\nKCk7CiAgICAgICAgICAgIGZvciAoU2VsZWN0aW9uPD8+IHRlcm0gOiB0ZXJt\ncykgewogICAgICAgICAgICAgICAgcmVzdWx0Lm5lc3QoZ2V0U2hhcGUocSwg\ncmVzdWx0LCB0ZXJtKSk7CiAgICAgICAgICAgIH0KICAgICAgICB9IGVsc2Ug\newogICAgICAgICAgICBpZiAocGFyZW50LmdldFR5cGUoKS5pc0FycmF5KCkg\nJiYgcS5pc011bHRpc2VsZWN0KCkpIHsKICAgICAgICAgICAgICAgIENsYXNz\nPD8+IGNvbXBvbmVudFR5cGUgPSBwYXJlbnQuZ2V0VHlwZSgpLmdldENvbXBv\nbmVudFR5cGUoKTsKICAgICAgICAgICAgICAgIGlmIChjb21wb25lbnRUeXBl\nID09IFR1cGxlLmNsYXNzKSB7CiAgICAgICAgICAgICAgICAgICAgcmVzdWx0\nID0gbmV3IFJlc3VsdFNoYXBlKGNvbXBvbmVudFR5cGUsIAogICAgICAgICAg\nICAgICAgICAgICAgICAgbmV3IEZpbGxTdHJhdGVneS5GYWN0b3J5KG5ldyBU\ndXBsZUZhY3RvcnkocyksIFR1cGxlSW1wbC5QVVQpLCBmYWxzZSk7CiAgICAg\nICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIHJlc3Vs\ndCA9IG5ldyBSZXN1bHRTaGFwZShjb21wb25lbnRUeXBlLCBuZXcgRmlsbFN0\ncmF0ZWd5LkFzc2lnbigpLCB0cnVlKTsKICAgICAgICAgICAgICAgIH0KICAg\nICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHJlc3VsdCA9IG5l\ndyBSZXN1bHRTaGFwZSh0eXBlLCBuZXcgRmlsbFN0cmF0ZWd5LkFzc2lnbigp\nLCB0cnVlKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1\ncm4gcmVzdWx0OwogICAgfQogICAgCiAgICAvKioKICAgICAqIEJ1aWxkcyB0\naGUgcmVzdWx0IHNoYXBlIGJ5IGNyZWF0aW5nIHNoYXBlIGZvciB0aGUgY29t\ncGxldGUgcmVzdWx0IGFuZCBob3cgaXQgbmVzdHMgZWFjaCBzZWxlY3Rpb24g\ndGVybXMuCiAgICAgKiBUaGUgc2hhcGUgdmFyaWVzIGJhc2VkIG9uIHdoZXRo\nZXIgdGhlIHRlcm1zIHdlcmUgc2VsZWN0ZWQgYmFzZWQgb24gbXVsdGlzZWxl\nY3QoKSBvciBzZWxlY3QoKS4gCiAgICAgKi8KICAgIHByaXZhdGUgUmVzdWx0\nU2hhcGU8Pz4gZXZhbFJlc3VsdFNoYXBlKENyaXRlcmlhUXVlcnlJbXBsPD8+\nIHEpIHsKICAgICAgICBMaXN0PFNlbGVjdGlvbjw/Pj4gc2VsZWN0aW9ucyA9\nIHEuZ2V0U2VsZWN0aW9uTGlzdCgpOwogICAgICAgIENsYXNzPD8+IHJlc3Vs\ndENsYXNzID0gcS5nZXRSZXN1bHRUeXBlKCk7CiAgICAgICAgUmVzdWx0U2hh\ncGU8Pz4gcmVzdWx0ID0gbnVsbDsKICAgICAgICBpZiAocS5pc011bHRpc2Vs\nZWN0KCkpIHsKICAgICAgICAgICByZXN1bHQgPSBuZXcgUmVzdWx0U2hhcGUo\ncmVzdWx0Q2xhc3MsIENvbXBvdW5kU2VsZWN0aW9ucy5nZXRGaWxsU3RyYXRl\nZ3kocS5nZXRTZWxlY3Rpb24oKSkpOwogICAgICAgICAgIGZvciAoU2VsZWN0\naW9uPD8+IHRlcm0gOiBzZWxlY3Rpb25zKSB7CiAgICAgICAgICAgICAgIHJl\nc3VsdC5uZXN0KGdldFNoYXBlKHEsIHJlc3VsdCwgdGVybSkpOwogICAgICAg\nICAgIH0KICAgICAgICB9IGVsc2UgeyAvLyBub3QgbXVsdGlzZWxlY3QKICAg\nICAgICAgICAgRmlsbFN0cmF0ZWd5PD8+IHN0cmF0ZWd5ID0gbmV3IEZpbGxT\ndHJhdGVneS5Bc3NpZ24oKTsKICAgICAgICAgICAgaWYgKFR1cGxlLmNsYXNz\nLmlzQXNzaWduYWJsZUZyb20ocmVzdWx0Q2xhc3MpKSB7CiAgICAgICAgICAg\nICAgICBUdXBsZUZhY3RvcnkgZmFjdG9yeSA9IG5ldyBUdXBsZUZhY3Rvcnko\nc2VsZWN0aW9ucy50b0FycmF5KG5ldyBUdXBsZUVsZW1lbnRbc2VsZWN0aW9u\ncy5zaXplKCldKSk7CiAgICAgICAgICAgICAgICBzdHJhdGVneSA9IG5ldyBG\naWxsU3RyYXRlZ3kuRmFjdG9yeTxUdXBsZT4oZmFjdG9yeSwgIFR1cGxlSW1w\nbC5QVVQpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJlc3VsdCA9IG5l\ndyBSZXN1bHRTaGFwZShyZXN1bHRDbGFzcywgc3RyYXRlZ3kpOwogICAgICAg\nICAgICBpZiAocS5nZXRTZWxlY3Rpb25MaXN0KCkgPT0gbnVsbCkgewogICAg\nICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDsKICAgICAgICAgICAgfQogICAg\nICAgICAgICBpZiAocS5nZXRTZWxlY3Rpb25MaXN0KCkuc2l6ZSgpID09IDEp\nIHsKICAgICAgICAgICAgICAgIHJlc3VsdCA9IGdldFNoYXBlKHEsIHJlc3Vs\ndCwgcS5nZXRTZWxlY3Rpb25MaXN0KCkuZ2V0KDApKTsKICAgICAgICAgICAg\nfSBlbHNlIHsKICAgICAgICAgICAgICAgIGZvciAoU2VsZWN0aW9uPD8+IHRl\ncm0gOiBxLmdldFNlbGVjdGlvbkxpc3QoKSkgewogICAgICAgICAgICAgICAg\nICAgIHJlc3VsdC5uZXN0KGdldFNoYXBlKHEsIHJlc3VsdCwgdGVybSkpOwog\nICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAg\nCiAgICAgICAgcmV0dXJuIHJlc3VsdDsKICAgfQp9Cg==\n","encoding":"base64"}

