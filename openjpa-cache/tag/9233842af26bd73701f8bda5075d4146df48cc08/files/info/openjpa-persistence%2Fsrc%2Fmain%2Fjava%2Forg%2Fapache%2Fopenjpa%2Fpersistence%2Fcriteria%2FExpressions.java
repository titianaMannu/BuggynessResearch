{"sha":"bd85fdde280fbd28c64d168ebffd0e137cfb9818","node_id":"MDQ6QmxvYjIwNjM2NDpiZDg1ZmRkZTI4MGZiZDI4YzY0ZDE2OGViZmZkMGUxMzdjZmI5ODE4","size":66775,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/bd85fdde280fbd28c64d168ebffd0e137cfb9818","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwoKcGFj\na2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuY3JpdGVyaWE7\nCgppbXBvcnQgamF2YS51dGlsLkFycmF5TGlzdDsKaW1wb3J0IGphdmEudXRp\nbC5Db2xsZWN0aW9uOwppbXBvcnQgamF2YS51dGlsLkhhc2hTZXQ7CmltcG9y\ndCBqYXZhLnV0aWwuTGlzdDsKaW1wb3J0IGphdmEudXRpbC5TZXQ7CmltcG9y\ndCBqYXZhLnV0aWwuY29uY3VycmVudC5Db3B5T25Xcml0ZUFycmF5TGlzdDsK\naW1wb3J0IGphdmEudXRpbC5jb25jdXJyZW50LkNvcHlPbldyaXRlQXJyYXlT\nZXQ7CgppbXBvcnQgamF2YXgucGVyc2lzdGVuY2UuY3JpdGVyaWEuRXhwcmVz\nc2lvbjsKaW1wb3J0IGphdmF4LnBlcnNpc3RlbmNlLmNyaXRlcmlhLlByZWRp\nY2F0ZTsKaW1wb3J0IGphdmF4LnBlcnNpc3RlbmNlLmNyaXRlcmlhLlF1ZXJ5\nQnVpbGRlcjsKaW1wb3J0IGphdmF4LnBlcnNpc3RlbmNlLmNyaXRlcmlhLlN1\nYnF1ZXJ5OwppbXBvcnQgamF2YXgucGVyc2lzdGVuY2UuY3JpdGVyaWEuUXVl\ncnlCdWlsZGVyLlRyaW1zcGVjOwoKaW1wb3J0IG9yZy5hcGFjaGUub3Blbmpw\nYS5rZXJuZWwuZXhwcy5FeHByZXNzaW9uRmFjdG9yeTsKaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS5rZXJuZWwuZXhwcy5MaXRlcmFsOwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5leHBzLlZhbHVlOwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5qcHFsLkpQUUxFeHByZXNzaW9uQnVp\nbGRlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRhLkNsYXNzTWV0\nYURhdGE7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2Uu\nY3JpdGVyaWEuQ3JpdGVyaWFFeHByZXNzaW9uVmlzaXRvci5UcmF2ZXJzYWxT\ndHlsZTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5t\nZXRhLlR5cGVzOwoKLyoqCiAqIEV4cHJlc3Npb25zIGFjY29yZGluZyB0byBK\nUEEgMi4wLgogKiAKICogQSBmYWNhZGUgdG8gT3BlbkpQQSBrZXJuZWwgZXhw\ncmVzc2lvbnMgdG8gZW5mb3JjZSBzdHJvbmdlciB0eXBpbmcuCiAqIAogKiBA\nYXV0aG9yIFBpbmFraSBQb2RkYXIKICogQGF1dGhvciBGYXkgV2FuZwogKiAK\nICogQHNpbmNlIDIuMC4wCiAqCiAqLwpjbGFzcyBFeHByZXNzaW9ucyB7CiAg\nICBzdGF0aWMgZmluYWwgU3RyaW5nIE9QRU5fQlJBQ0UgPSAiKCI7CiAgICBz\ndGF0aWMgZmluYWwgU3RyaW5nIENMT1NFX0JSQUNFID0gIikiOwogICAgc3Rh\ndGljIGZpbmFsIFN0cmluZyBDT01NQSA9ICIsIjsKICAgIAogICAgLyoqCiAg\nICAgKiBDb252ZXJ0IHRoZSBnaXZlbiBDcml0ZXJpYSBleHByZXNzaW9uIHRv\nIGEgY29ycmVzcG9uZGluZyBrZXJuZWwgdmFsdWUgCiAgICAgKiB1c2luZyB0\naGUgZ2l2ZW4gRXhwcmVzc2lvbkZhY3RvcnkuCiAgICAgKiBIYW5kbGVzIG51\nbGwgZXhwcmVzc2lvbi4KICAgICAqLwogICAgIHN0YXRpYyBWYWx1ZSB0b1Zh\nbHVlKEV4cHJlc3Npb25JbXBsPD8+IGUsIEV4cHJlc3Npb25GYWN0b3J5IGZh\nY3RvcnksIENyaXRlcmlhUXVlcnlJbXBsPD8+IHEpIHsKICAgICAgICByZXR1\ncm4gKGUgPT0gbnVsbCkgPyBmYWN0b3J5LmdldE51bGwoKSA6IGUudG9WYWx1\nZShmYWN0b3J5LCBxKTsKICAgIH0KICAgICAKICAgICBzdGF0aWMgdm9pZCBz\nZXRJbXBsaWNpdFR5cGVzKFZhbHVlIHYxLCBWYWx1ZSB2MiwgQ2xhc3M8Pz4g\nZXhwZWN0ZWQsIENyaXRlcmlhUXVlcnlJbXBsPD8+IHEpIHsKICAgICAgICAg\nSlBRTEV4cHJlc3Npb25CdWlsZGVyLnNldEltcGxpY2l0VHlwZXModjEsIHYy\nLCBleHBlY3RlZCwgcS5nZXRNZXRhbW9kZWwoKSwgCiAgICAgICAgICAgICBx\nLmdldFBhcmFtZXRlclR5cGVzKCksIHEudG9TdHJpbmcoKSk7CiAgICAgfQog\nICAgIAogICAgIC8qKgogICAgICAqIFZpc2l0cyB0aGUgZ2l2ZW4gZXhwcmVz\nc2lvbiBhbmQgdGhlIGdpdmVuIGNoaWxkcmVuIHJlY3Vyc2l2ZWx5LgogICAg\nICAqIFRoZSBvcmRlciBvZiB0cmF2ZXJzYWwgZGVwZW5kcyBvbiB0aGUgcGFy\nZW50IGFuZCBpcyBkZXRlcm1pbmVkIGJ5IHRoZSB2aXNpdG9yLgogICAgICAq\nLwogICAgIHN0YXRpYyB2b2lkIGFjY2VwdFZpc2l0KENyaXRlcmlhRXhwcmVz\nc2lvblZpc2l0b3IgdmlzaXRvciwgQ3JpdGVyaWFFeHByZXNzaW9uIHBhcmVu\ndCwgRXhwcmVzc2lvbjw/Pi4uLmV4cHJzKSB7CiAgICAgICAgIGlmIChwYXJl\nbnQgPT0gbnVsbCkKICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgVHJh\ndmVyc2FsU3R5bGUgdHJhdmVyc2FsID0gdmlzaXRvci5nZXRUcmF2ZXJzYWxT\ndHlsZShwYXJlbnQpOwogICAgICAgICBzd2l0Y2ggKHRyYXZlcnNhbCkgewog\nICAgICAgICBjYXNlIElORklYIDogCiAgICAgICAgICAgICBpZiAoZXhwcnMg\nPT0gbnVsbCB8fCBleHBycy5sZW5ndGggPT0gMCkgewogICAgICAgICAgICAg\nICAgIHZpc2l0b3IuZW50ZXIocGFyZW50KTsKICAgICAgICAgICAgICAgICB2\naXNpdG9yLmV4aXQocGFyZW50KTsKICAgICAgICAgICAgICAgICByZXR1cm47\nCiAgICAgICAgICAgICB9CiAgICAgICAgICAgICBmb3IgKGludCBpID0gMDsg\naSA8IGV4cHJzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgICAgRXhw\ncmVzc2lvbkltcGw8Pz4gZSA9IChFeHByZXNzaW9uSW1wbDw/PilleHByc1tp\nXTsKICAgICAgICAgICAgICAgICBpZiAoZSAhPSBudWxsKSBlLmFjY2VwdFZp\nc2l0KHZpc2l0b3IpOwogICAgICAgICAgICAgICAgIGlmIChpICsgMSAhPSBl\neHBycy5sZW5ndGgpIHsKICAgICAgICAgICAgICAgICAgICAgdmlzaXRvci5l\nbnRlcihwYXJlbnQpOwogICAgICAgICAgICAgICAgICAgICB2aXNpdG9yLmV4\naXQocGFyZW50KTsKICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICB9\nCiAgICAgICAgICAgICBicmVhazsKICAgICAgICAgY2FzZSBQT1NURklYOgog\nICAgICAgICAgICAgdmlzaXRDaGlsZHJlbih2aXNpdG9yLGV4cHJzKTsKICAg\nICAgICAgICAgIHZpc2l0b3IuZW50ZXIocGFyZW50KTsKICAgICAgICAgICAg\nIHZpc2l0b3IuZXhpdChwYXJlbnQpOwogICAgICAgICAgICAgYnJlYWs7CiAg\nICAgICAgIGNhc2UgUFJFRklYIDoKICAgICAgICAgICAgIHZpc2l0b3IuZW50\nZXIocGFyZW50KTsKICAgICAgICAgICAgIHZpc2l0b3IuZXhpdChwYXJlbnQp\nOwogICAgICAgICAgICAgdmlzaXRDaGlsZHJlbih2aXNpdG9yLGV4cHJzKTsK\nICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICBjYXNlIEZVTkNUSU9OOgog\nICAgICAgICAgICAgdmlzaXRvci5lbnRlcihwYXJlbnQpOwogICAgICAgICAg\nICAgdmlzaXRDaGlsZHJlbih2aXNpdG9yLCBleHBycyk7CiAgICAgICAgICAg\nICB2aXNpdG9yLmV4aXQocGFyZW50KTsKICAgICAgICAgICAgIGJyZWFrOwog\nICAgICAgICB9CiAgICAgfQogICAgIAogICAgIHN0YXRpYyB2b2lkIHZpc2l0\nQ2hpbGRyZW4oQ3JpdGVyaWFFeHByZXNzaW9uVmlzaXRvciB2aXNpdG9yLCBF\neHByZXNzaW9uPD8+Li4uZXhwcnMpIHsKICAgICAgICAgZm9yIChpbnQgaSA9\nIDA7IGV4cHJzICE9IG51bGwgJiYgaSA8IGV4cHJzLmxlbmd0aDsgaSsrKSB7\nCiAgICAgICAgICAgICBFeHByZXNzaW9uSW1wbDw/PiBlID0gKEV4cHJlc3Np\nb25JbXBsPD8+KWV4cHJzW2ldOwogICAgICAgICAgICAgaWYgKGUgIT0gbnVs\nbCkgZS5hY2NlcHRWaXNpdCh2aXNpdG9yKTsKICAgICAgICAgfQogICAgIH0K\nICAgICAKICAgICAvKioKICAgICAgKiBSZW5kZXJzIHRoZSBnaXZlbiBleHBy\nZXNzaW9ucyBhcyBhIGxpc3Qgb2YgdmFsdWVzIHNlcGFyYXRlZCBieSB0aGUg\nZ2l2ZW4gY29ubmVjdG9yLgogICAgICAqLwogICAgIHN0YXRpYyBTdHJpbmdC\ndWlsZGVyIGFzVmFsdWUoQWxpYXNDb250ZXh0IHEsIEV4cHJlc3Npb248Pz5b\nXSBleHBzLCBTdHJpbmcgY29ubmVjdG9yKSB7CiAgICAgICAgIFN0cmluZ0J1\naWxkZXIgYnVmZmVyID0gbmV3IFN0cmluZ0J1aWxkZXIoKTsKICAgICAgICAg\naWYgKGV4cHMgPT0gbnVsbCkgcmV0dXJuIGJ1ZmZlcjsKICAgICAgICAgZm9y\nIChpbnQgaSA9IDA7IGkgPCBleHBzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAg\nICAgICBidWZmZXIuYXBwZW5kKCgoRXhwcmVzc2lvbkltcGw8Pz4pZXhwc1tp\nXSkuYXNWYWx1ZShxKSk7CiAgICAgICAgICAgICBpZiAoaSsxICE9IGV4cHMu\nbGVuZ3RoKSB7CiAgICAgICAgICAgICAgICAgYnVmZmVyLmFwcGVuZChjb25u\nZWN0b3IpOwogICAgICAgICAgICAgfQogICAgICAgICB9CiAgICAgICAgIHJl\ndHVybiBidWZmZXI7CiAgICAgfQogICAgIAogICAgIC8qKgogICAgICAqIFJl\nbmRlcnMgdGhlIGdpdmVuIGFyZ3VtZW50cyBhcyBhIGxpc3Qgb2YgdmFsdWVz\nIHNlcGFyYXRlZCBieSB0aGUgZ2l2ZW4gY29ubmVjdG9yLgogICAgICAqLwog\nICAgIHN0YXRpYyBTdHJpbmdCdWlsZGVyIGFzVmFsdWUoQWxpYXNDb250ZXh0\nIHEsIE9iamVjdC4uLnBhcmFtcykgewogICAgICAgICBTdHJpbmdCdWlsZGVy\nIGJ1ZmZlciA9IG5ldyBTdHJpbmdCdWlsZGVyKCk7CiAgICAgICAgIGlmIChw\nYXJhbXMgPT0gbnVsbCkgcmV0dXJuIGJ1ZmZlcjsKICAgICAgICAgZm9yIChp\nbnQgaSA9IDA7IGkgPCBwYXJhbXMubGVuZ3RoOyBpKyspIHsKICAgICAgICAg\nICAgIE9iamVjdCBvID0gcGFyYW1zW2ldOwogICAgICAgICAgICAgaWYgKG8g\nPT0gbnVsbCkgewogICAgICAgICAgICAgICAgIGlmIChpKzEgPCBwYXJhbXMu\nbGVuZ3RoICYmIHBhcmFtc1tpKzFdLmVxdWFscyhDT01NQSkpIHsKICAgICAg\nICAgICAgICAgICAgICAgaSsrOwogICAgICAgICAgICAgICAgIH0KICAgICAg\nICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgIH0KICAgICAgICAg\nICAgIGlmIChvIGluc3RhbmNlb2YgQ3JpdGVyaWFFeHByZXNzaW9uKSB7CiAg\nICAgICAgICAgICAgICAgYnVmZmVyLmFwcGVuZCgoKENyaXRlcmlhRXhwcmVz\nc2lvbilvKS5hc1ZhbHVlKHEpKTsKICAgICAgICAgICAgIH0gZWxzZSB7CiAg\nICAgICAgICAgICAgICAgYnVmZmVyLmFwcGVuZChvKTsKICAgICAgICAgICAg\nIH0KICAgICAgICAgfQogICAgICAgICByZXR1cm4gYnVmZmVyOwogICAgIH0K\nICAgICAKICAgICAvKioKICAgICAgKiBSZXR1cm4gYSBsaXN0IHRoYXQgaXMg\nZWl0aGVyIGVtcHR5IChpZiB0aGUgZ2l2ZW4gbGlzdCBpcyBudWxsKSBvciBh\nIGxpc3QKICAgICAgKiB3aG9zZSBtdXRhdGlvbiBkbyBub3QgaW1wYWN0IHRo\nZSBvcmlnaW5hbCBsaXN0LgogICAgICAqLwogICAgIHN0YXRpYyA8WD4gTGlz\ndDxYPiByZXR1cm5Db3B5KExpc3Q8WD4gbGlzdCkgewogICAgICAgICByZXR1\ncm4gbGlzdCA9PSBudWxsID8gbmV3IEFycmF5TGlzdDxYPigpIDogbmV3IENv\ncHlPbldyaXRlQXJyYXlMaXN0PFg+KGxpc3QpOwogICAgIH0KICAgICAKICAg\nICAvKioKICAgICAgKiBSZXR1cm4gYSBzZXQgdGhhdCBpcyBlaXRoZXIgZW1w\ndHkgKGlmIHRoZSBnaXZlbiBzZXQgaXMgbnVsbCkgb3IgYSBzZXQKICAgICAg\nKiB3aG9zZSBtdXRhdGlvbiBkbyBub3QgaW1wYWN0IHRoZSBvcmlnaW5hbCBs\naXN0LgogICAgICAqLwogICAgIHN0YXRpYyA8WD4gU2V0PFg+IHJldHVybkNv\ncHkoU2V0PFg+IHNldCkgewogICAgICAgICByZXR1cm4gc2V0ID09IG51bGwg\nPyBuZXcgSGFzaFNldDxYPigpIDogbmV3IENvcHlPbldyaXRlQXJyYXlTZXQ8\nWD4oc2V0KTsKICAgICB9CiAgICAgCiAgICAgc3RhdGljIG9yZy5hcGFjaGUu\nb3BlbmpwYS5rZXJuZWwuZXhwcy5FeHByZXNzaW9uIGFuZChFeHByZXNzaW9u\nRmFjdG9yeSBmYWN0b3J5LAogICAgICAgICAgICAgb3JnLmFwYWNoZS5vcGVu\nanBhLmtlcm5lbC5leHBzLkV4cHJlc3Npb24gZTEsIG9yZy5hcGFjaGUub3Bl\nbmpwYS5rZXJuZWwuZXhwcy5FeHByZXNzaW9uIGUyKSB7CiAgICAgICAgICAg\nICByZXR1cm4gZTEgPT0gbnVsbCA/IGUyIDogZTIgPT0gbnVsbCA/IGUxIDog\nZmFjdG9yeS5hbmQoZTEsIGUyKTsKICAgICB9CiAgICAgICAgIAoKCiAgICAg\nLyoqCiAgICAgKiBVbmFyeSBGdW5jdGlvbmFsIEV4cHJlc3Npb24gYXBwbGll\ncyBhIHVuYXJ5IGZ1bmN0aW9uIG9uIGEgaW5wdXQgb3BlcmFuZCBFeHByZXNz\naW9uLgogICAgICoKICAgICAqIEBwYXJhbSA8WD4gdGhlIHR5cGUgb2YgdGhl\nIHJlc3VsdGFudCBleHByZXNzaW9uCiAgICAgKi8KICAgIHB1YmxpYyBhYnN0\ncmFjdCBzdGF0aWMgY2xhc3MgVW5hcnlGdW5jdGlvbmFsRXhwcmVzc2lvbjxY\nPiBleHRlbmRzIEV4cHJlc3Npb25JbXBsPFg+IHsKICAgICAgICBwcm90ZWN0\nZWQgZmluYWwgRXhwcmVzc2lvbkltcGw8Pz4gZTsKICAgICAgICAvKioKICAg\nICAgICAgKiBTdXBwbHkgdGhlIHJlc3VsdGFudCB0eXBlIGFuZCBpbnB1dCBv\ncGVyYW5kIGV4cHJlc3Npb24uCiAgICAgICAgICovCiAgICAgICAgcHVibGlj\nIFVuYXJ5RnVuY3Rpb25hbEV4cHJlc3Npb24oQ2xhc3M8WD4gdCwgRXhwcmVz\nc2lvbjw/PiBlKSB7CiAgICAgICAgICAgIHN1cGVyKHQpOwogICAgICAgICAg\nICB0aGlzLmUgID0gKEV4cHJlc3Npb25JbXBsPD8+KWU7CiAgICAgICAgfQog\nICAgICAgIAogICAgICAgIHB1YmxpYyBVbmFyeUZ1bmN0aW9uYWxFeHByZXNz\naW9uKEV4cHJlc3Npb248WD4gZSkgewogICAgICAgICAgICB0aGlzKChDbGFz\nczxYPillLmdldEphdmFUeXBlKCksIGUpOwogICAgICAgIH0KICAgICAgICAK\nICAgICAgICBwdWJsaWMgdm9pZCBhY2NlcHRWaXNpdChDcml0ZXJpYUV4cHJl\nc3Npb25WaXNpdG9yIHZpc2l0b3IpIHsKICAgICAgICAgICAgRXhwcmVzc2lv\nbnMuYWNjZXB0VmlzaXQodmlzaXRvciwgdGhpcywgZSk7CiAgICAgICAgfQog\nICAgfQogICAgCiAgICAvKioKICAgICAqIEJpbmFyeSBGdW5jdGlvbmFsIEV4\ncHJlc3Npb24gYXBwbGllcyBhIGJpbmFyeSBmdW5jdGlvbiBvbiBhIHBhaXIg\nb2YgaW5wdXQgRXhwcmVzc2lvbi4KICAgICAqIAogICAgICogQHBhcmFtIDxY\nPiB0aGUgdHlwZSBvZiB0aGUgcmVzdWx0YW50IGV4cHJlc3Npb24KICAgICAq\nLwogICAgcHVibGljIGFic3RyYWN0IHN0YXRpYyBjbGFzcyBCaW5hcmF5RnVu\nY3Rpb25hbEV4cHJlc3Npb248WD4gZXh0ZW5kcyBFeHByZXNzaW9uSW1wbDxY\nPnsKICAgICAgICBwcm90ZWN0ZWQgZmluYWwgRXhwcmVzc2lvbkltcGw8Pz4g\nZTE7CiAgICAgICAgcHJvdGVjdGVkIGZpbmFsIEV4cHJlc3Npb25JbXBsPD8+\nIGUyOwogICAgICAgIAogICAgICAgIC8qKgogICAgICAgICAqIFN1cHBseSB0\naGUgcmVzdWx0YW50IHR5cGUgYW5kIHBhaXIgb2YgaW5wdXQgb3BlcmFuZCBl\neHByZXNzaW9ucy4KICAgICAgICAgKi8KICAgICAgICBwdWJsaWMgQmluYXJh\neUZ1bmN0aW9uYWxFeHByZXNzaW9uKENsYXNzPFg+IHQsIEV4cHJlc3Npb248\nPz4geCwgRXhwcmVzc2lvbjw/PiB5KSB7CiAgICAgICAgICAgIHN1cGVyKHQp\nOwogICAgICAgICAgICBlMSA9IChFeHByZXNzaW9uSW1wbDw/Pil4OwogICAg\nICAgICAgICBlMiA9IChFeHByZXNzaW9uSW1wbDw/Pil5OwogICAgICAgIH0K\nICAgICAgICAKICAgICAgICBwdWJsaWMgdm9pZCBhY2NlcHRWaXNpdChDcml0\nZXJpYUV4cHJlc3Npb25WaXNpdG9yIHZpc2l0b3IpIHsKICAgICAgICAgICAg\nRXhwcmVzc2lvbnMuYWNjZXB0VmlzaXQodmlzaXRvciwgdGhpcywgZTEsIGUy\nKTsKICAgICAgICB9CiAgICB9CiAgICAKICAgIC8qKgogICAgICogRnVuY3Rp\nb25hbCBFeHByZXNzaW9uIGFwcGxpZXMgYSBmdW5jdGlvbiBvbiBhIGxpc3Qg\nb2YgaW5wdXQgRXhwcmVzc2lvbnMuCiAgICAgKiAKICAgICAqIEBwYXJhbSA8\nWD4gdGhlIHR5cGUgb2YgdGhlIHJlc3VsdGFudCBleHByZXNzaW9uCiAgICAg\nKi8KICAgIHB1YmxpYyBhYnN0cmFjdCBzdGF0aWMgY2xhc3MgRnVuY3Rpb25h\nbEV4cHJlc3Npb248WD4gZXh0ZW5kcyBFeHByZXNzaW9uSW1wbDxYPiB7CiAg\nICAgICAgcHJvdGVjdGVkIGZpbmFsIEV4cHJlc3Npb25JbXBsPD8+W10gYXJn\nczsKICAgICAgICAKICAgICAgICAvKioKICAgICAgICAgKiBTdXBwbHkgdGhl\nIHJlc3VsdGFudCB0eXBlIGFuZCBsaXN0IG9mIGlucHV0IG9wZXJhbmQgZXhw\ncmVzc2lvbnMuCiAgICAgICAgICovCiAgICAgICAgcHVibGljIEZ1bmN0aW9u\nYWxFeHByZXNzaW9uKENsYXNzPFg+IHQsIEV4cHJlc3Npb248Pz4uLi4gYXJn\ncykgewogICAgICAgICAgICBzdXBlcih0KTsKICAgICAgICAgICAgaW50IGxl\nbiA9IGFyZ3MgPT0gbnVsbCA/IDAgOiBhcmdzLmxlbmd0aDsKICAgICAgICAg\nICAgdGhpcy5hcmdzID0gbmV3IEV4cHJlc3Npb25JbXBsPD8+W2xlbl07CiAg\nICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBhcmdzICE9IG51bGwgJiYgaSA8\nIGFyZ3MubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICAgIHRoaXMuYXJn\nc1tpXSA9IChFeHByZXNzaW9uSW1wbDw/PilhcmdzW2ldOwogICAgICAgICAg\nICB9CiAgICAgICAgfQogICAgICAgIAogICAgICAgIHB1YmxpYyB2b2lkIGFj\nY2VwdFZpc2l0KENyaXRlcmlhRXhwcmVzc2lvblZpc2l0b3IgdmlzaXRvcikg\newogICAgICAgICAgICBFeHByZXNzaW9ucy5hY2NlcHRWaXNpdCh2aXNpdG9y\nLCB0aGlzLCBhcmdzKTsKICAgICAgICB9CiAgICB9CiAgIAogICAgLyoqCiAg\nICAgKiBCaW5hcnkgTG9naWNhbCBFeHByZXNzaW9uIGFwcGxpZXMgYSBmdW5j\ndGlvbiBvbiBhIHBhaXIgb2YgaW5wdXQgRXhwcmVzc2lvbiB0byBnZW5lcmF0\nZSBhIFByZWRpY2F0ZQogICAgICogaS5lLiBhbiBleHByZXNzaW9uIHdob3Nl\nIHJlc3VsdGFudCB0eXBlIGlzIEJvb2xlYW4uCiAgICAgKgogICAgICovCiAg\nIHB1YmxpYyBzdGF0aWMgYWJzdHJhY3QgY2xhc3MgQmluYXJ5TG9naWNhbEV4\ncHJlc3Npb24gZXh0ZW5kcyBQcmVkaWNhdGVJbXBsIHsKICAgICAgICBwcm90\nZWN0ZWQgZmluYWwgRXhwcmVzc2lvbkltcGw8Pz4gZTE7CiAgICAgICAgcHJv\ndGVjdGVkIGZpbmFsIEV4cHJlc3Npb25JbXBsPD8+IGUyOwogICAgICAgIAog\nICAgICAgIHB1YmxpYyBCaW5hcnlMb2dpY2FsRXhwcmVzc2lvbihFeHByZXNz\naW9uPD8+IHgsIEV4cHJlc3Npb248Pz4geSkgewogICAgICAgICAgICBzdXBl\ncigpOwogICAgICAgICAgICBlMSA9IChFeHByZXNzaW9uSW1wbDw/Pil4Owog\nICAgICAgICAgICBlMiA9IChFeHByZXNzaW9uSW1wbDw/Pil5OwogICAgICAg\nIH0KICAgICAgICAgICAgICAgIAogICAgICAgIHB1YmxpYyB2b2lkIGFjY2Vw\ndFZpc2l0KENyaXRlcmlhRXhwcmVzc2lvblZpc2l0b3IgdmlzaXRvcikgewog\nICAgICAgICAgICBFeHByZXNzaW9ucy5hY2NlcHRWaXNpdCh2aXNpdG9yLCB0\naGlzLCBlMSwgZTIpOwogICAgICAgIH0KICAgIH0KICAgIAogICAgCiAgICBw\ndWJsaWMgc3RhdGljIGNsYXNzIEFiczxYPiBleHRlbmRzIFVuYXJ5RnVuY3Rp\nb25hbEV4cHJlc3Npb248WD4gewogICAgICAgIHB1YmxpYyAgQWJzKEV4cHJl\nc3Npb248WD4geCkgewogICAgICAgICAgICBzdXBlcih4KTsKICAgICAgICB9\nCgogICAgICAgIEBPdmVycmlkZQogICAgICAgIHB1YmxpYyBWYWx1ZSB0b1Zh\nbHVlKEV4cHJlc3Npb25GYWN0b3J5IGZhY3RvcnksIENyaXRlcmlhUXVlcnlJ\nbXBsPD8+IHEpIHsKICAgICAgICAgICAgcmV0dXJuIGZhY3RvcnkuYWJzKEV4\ncHJlc3Npb25zLnRvVmFsdWUoZSwgZmFjdG9yeSwgcSkpOwogICAgICAgIH0K\nICAgICAgICAKICAgICAgICBwdWJsaWMgU3RyaW5nQnVpbGRlciBhc1ZhbHVl\nKEFsaWFzQ29udGV4dCBxKSB7CiAgICAgICAgICAgIHJldHVybiBFeHByZXNz\naW9ucy5hc1ZhbHVlKHEsICJBQlMiLCBPUEVOX0JSQUNFLCBlLCBDTE9TRV9C\nUkFDRSk7CiAgICAgICAgfQogICAgfQogICAgCiAgICBwdWJsaWMgc3RhdGlj\nIGNsYXNzIENvdW50IGV4dGVuZHMgVW5hcnlGdW5jdGlvbmFsRXhwcmVzc2lv\nbjxMb25nPiB7CiAgICAgICAgcHJpdmF0ZSBib29sZWFuIF9kaXN0aW5jdDsg\nCiAgICAgICAgcHVibGljICBDb3VudChFeHByZXNzaW9uPD8+IHgpIHsKICAg\nICAgICAgICAgdGhpcyh4LCBmYWxzZSk7CiAgICAgICAgfQogICAgICAgIAog\nICAgICAgIHB1YmxpYyAgQ291bnQoRXhwcmVzc2lvbjw/PiB4LCBib29sZWFu\nIGRpc3RpbmN0KSB7CiAgICAgICAgICAgIHN1cGVyKExvbmcuY2xhc3MsIHgp\nOwogICAgICAgICAgICBfZGlzdGluY3QgPSBkaXN0aW5jdDsKICAgICAgICAg\nICAgCiAgICAgICAgfQoKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBwdWJs\naWMgVmFsdWUgdG9WYWx1ZShFeHByZXNzaW9uRmFjdG9yeSBmYWN0b3J5LCBD\ncml0ZXJpYVF1ZXJ5SW1wbDw/PiBxKSB7CiAgICAgICAgICAgIFZhbHVlIHYg\nPSBmYWN0b3J5LmNvdW50KEV4cHJlc3Npb25zLnRvVmFsdWUoZSwgZmFjdG9y\neSwgcSkpOwogICAgICAgICAgICByZXR1cm4gX2Rpc3RpbmN0ID8gZmFjdG9y\neS5kaXN0aW5jdCh2KSA6IHY7CiAgICAgICAgfQogICAgICAgIAogICAgICAg\nIEBPdmVycmlkZQogICAgICAgIHB1YmxpYyBTdHJpbmdCdWlsZGVyIGFzVmFs\ndWUoQWxpYXNDb250ZXh0IHEpIHsKICAgICAgICAgICAgcmV0dXJuIEV4cHJl\nc3Npb25zLmFzVmFsdWUocSwgIkNPVU5UIiwgT1BFTl9CUkFDRSwgX2Rpc3Rp\nbmN0ID8gIkRJU1RJTkNUIitPUEVOX0JSQUNFIDogIiIsIAogICAgICAgICAg\nICAgICAgZSwgX2Rpc3RpbmN0ID8gQ0xPU0VfQlJBQ0UgOiAiIiwgQ0xPU0Vf\nQlJBQ0UpOwogICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMgc3RhdGljIGNs\nYXNzIEF2ZyBleHRlbmRzIFVuYXJ5RnVuY3Rpb25hbEV4cHJlc3Npb248RG91\nYmxlPiB7CiAgICAgICAgcHVibGljICBBdmcoRXhwcmVzc2lvbjw/PiB4KSB7\nCiAgICAgICAgICAgIHN1cGVyKERvdWJsZS5jbGFzcywgeCk7CiAgICAgICAg\nfQoKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBwdWJsaWMgVmFsdWUgdG9W\nYWx1ZShFeHByZXNzaW9uRmFjdG9yeSBmYWN0b3J5LCBDcml0ZXJpYVF1ZXJ5\nSW1wbDw/PiBxKSB7CiAgICAgICAgICAgIHJldHVybiBmYWN0b3J5LmF2ZyhF\neHByZXNzaW9ucy50b1ZhbHVlKGUsIGZhY3RvcnksIHEpKTsKICAgICAgICB9\nCiAgICAgICAgCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgcHVibGljIFN0\ncmluZ0J1aWxkZXIgYXNWYWx1ZShBbGlhc0NvbnRleHQgcSkgewogICAgICAg\nICAgICByZXR1cm4gRXhwcmVzc2lvbnMuYXNWYWx1ZShxLCAiQVZHIiwgT1BF\nTl9CUkFDRSwgZSwgQ0xPU0VfQlJBQ0UpOwogICAgICAgIH0KICAgIH0KICAg\nIAogICAgcHVibGljIHN0YXRpYyBjbGFzcyBTcXJ0IGV4dGVuZHMgVW5hcnlG\ndW5jdGlvbmFsRXhwcmVzc2lvbjxEb3VibGU+IHsKICAgICAgICBwdWJsaWMg\nIFNxcnQoRXhwcmVzc2lvbjw/IGV4dGVuZHMgTnVtYmVyPiB4KSB7CiAgICAg\nICAgICAgIHN1cGVyKERvdWJsZS5jbGFzcywgeCk7CiAgICAgICAgfQoKICAg\nICAgICBAT3ZlcnJpZGUKICAgICAgICBwdWJsaWMgVmFsdWUgdG9WYWx1ZShF\neHByZXNzaW9uRmFjdG9yeSBmYWN0b3J5LCBDcml0ZXJpYVF1ZXJ5SW1wbDw/\nPiBxKSB7CiAgICAgICAgICAgIHJldHVybiBmYWN0b3J5LnNxcnQoRXhwcmVz\nc2lvbnMudG9WYWx1ZShlLCBmYWN0b3J5LCBxKSk7CiAgICAgICAgfQogICAg\nICAgIAogICAgICAgIHB1YmxpYyBTdHJpbmdCdWlsZGVyIGFzVmFsdWUoQWxp\nYXNDb250ZXh0IHEpIHsKICAgICAgICAgICAgcmV0dXJuIEV4cHJlc3Npb25z\nLmFzVmFsdWUocSwgIlNRUlQiLCBPUEVOX0JSQUNFLCBlLCBDTE9TRV9CUkFD\nRSk7CiAgICAgICAgfQogICAgfQogICAgCiAgICBwdWJsaWMgc3RhdGljIGNs\nYXNzIE1heDxYPiBleHRlbmRzIFVuYXJ5RnVuY3Rpb25hbEV4cHJlc3Npb248\nWD4gewogICAgICAgIHB1YmxpYyAgTWF4KEV4cHJlc3Npb248WD4geCkgewog\nICAgICAgICAgICBzdXBlcih4KTsKICAgICAgICB9CgogICAgICAgIEBPdmVy\ncmlkZQogICAgICAgIHB1YmxpYyBWYWx1ZSB0b1ZhbHVlKEV4cHJlc3Npb25G\nYWN0b3J5IGZhY3RvcnksIENyaXRlcmlhUXVlcnlJbXBsPD8+IHEpIHsKICAg\nICAgICAgICAgcmV0dXJuIGZhY3RvcnkubWF4KEV4cHJlc3Npb25zLnRvVmFs\ndWUoZSwgZmFjdG9yeSwgcSkpOwogICAgICAgIH0KICAgICAgICAKICAgICAg\nICBwdWJsaWMgU3RyaW5nQnVpbGRlciBhc1ZhbHVlKEFsaWFzQ29udGV4dCBx\nKSB7CiAgICAgICAgICAgIHJldHVybiBFeHByZXNzaW9ucy5hc1ZhbHVlKHEs\nICJNQVgiLCBPUEVOX0JSQUNFLCBlLCBDTE9TRV9CUkFDRSk7CiAgICAgICAg\nfQogICAgfQoKICAgIHB1YmxpYyBzdGF0aWMgY2xhc3MgTWluPFg+IGV4dGVu\nZHMgVW5hcnlGdW5jdGlvbmFsRXhwcmVzc2lvbjxYPiB7CiAgICAgICAgcHVi\nbGljICBNaW4oRXhwcmVzc2lvbjxYPiB4KSB7CiAgICAgICAgICAgIHN1cGVy\nKHgpOwogICAgICAgIH0KCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgcHVi\nbGljIFZhbHVlIHRvVmFsdWUoRXhwcmVzc2lvbkZhY3RvcnkgZmFjdG9yeSwg\nQ3JpdGVyaWFRdWVyeUltcGw8Pz4gcSkgewogICAgICAgICAgICByZXR1cm4g\nZmFjdG9yeS5taW4oRXhwcmVzc2lvbnMudG9WYWx1ZShlLCBmYWN0b3J5LCBx\nKSk7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIHB1YmxpYyBTdHJpbmdC\ndWlsZGVyIGFzVmFsdWUoQWxpYXNDb250ZXh0IHEpIHsKICAgICAgICAgICAg\ncmV0dXJuIEV4cHJlc3Npb25zLmFzVmFsdWUocSwgIk1JTiIsIE9QRU5fQlJB\nQ0UsIGUsIENMT1NFX0JSQUNFKTsKICAgICAgICB9CiAgICB9CiAgICAKICAg\nIHB1YmxpYyBzdGF0aWMgY2xhc3MgU2l6ZSBleHRlbmRzIFVuYXJ5RnVuY3Rp\nb25hbEV4cHJlc3Npb248SW50ZWdlcj4gewogICAgICAgIHB1YmxpYyAgU2l6\nZShFeHByZXNzaW9uPD8gZXh0ZW5kcyBDb2xsZWN0aW9uPD8+PiB4KSB7CiAg\nICAgICAgICAgIHN1cGVyKEludGVnZXIuY2xhc3MsIHgpOwogICAgICAgIH0K\nICAgICAgICAKICAgICAgICBwdWJsaWMgIFNpemUoQ29sbGVjdGlvbjw/PiB4\nKSB7CiAgICAgICAgICAgIHRoaXMobmV3IENvbnN0YW50PENvbGxlY3Rpb248\nPz4+KHgpKTsKICAgICAgICB9CgogICAgICAgIEBPdmVycmlkZQogICAgICAg\nIHB1YmxpYyBWYWx1ZSB0b1ZhbHVlKEV4cHJlc3Npb25GYWN0b3J5IGZhY3Rv\ncnksIENyaXRlcmlhUXVlcnlJbXBsPD8+IHEpIHsKICAgICAgICAgICAgVmFs\ndWUgdmFsID0gRXhwcmVzc2lvbnMudG9WYWx1ZShlLCBmYWN0b3J5LCBxKTsK\nICAgICAgICAgICAgaWYgKHZhbCBpbnN0YW5jZW9mIExpdGVyYWwgJiYgKChM\naXRlcmFsKXZhbCkuZ2V0UGFyc2VUeXBlKCkgPT0gTGl0ZXJhbC5UWVBFX0NP\nTExFQ1RJT04pCiAgICAgICAgICAgICAgICByZXR1cm4gZmFjdG9yeS5uZXdM\naXRlcmFsKCgoQ29sbGVjdGlvbikoKExpdGVyYWwpdmFsKS5nZXRWYWx1ZSgp\nKS5zaXplKCksIAogICAgICAgICAgICAgICAgICAgIExpdGVyYWwuVFlQRV9O\nVU1CRVIpOwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgIHJldHVybiBm\nYWN0b3J5LnNpemUodmFsKTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAg\ncHVibGljIFN0cmluZ0J1aWxkZXIgYXNWYWx1ZShBbGlhc0NvbnRleHQgcSkg\newogICAgICAgICAgICByZXR1cm4gRXhwcmVzc2lvbnMuYXNWYWx1ZShxLCAi\nU0laRSIsIE9QRU5fQlJBQ0UsIGUsIENMT1NFX0JSQUNFKTsKICAgICAgICB9\nCiAgICB9CiAgICAKICAgIHB1YmxpYyBzdGF0aWMgY2xhc3MgRGF0YWJhc2VG\ndW5jdGlvbjxUPiBleHRlbmRzIEZ1bmN0aW9uYWxFeHByZXNzaW9uPFQ+IHsK\nICAgICAgICBwcml2YXRlIGZpbmFsIFN0cmluZyBmdW5jdGlvbk5hbWU7CiAg\nICAgICAgcHJpdmF0ZSBmaW5hbCBDbGFzczxUPiByZXN1bHRUeXBlOwogICAg\nICAgCiAgICAgICAgcHVibGljICBEYXRhYmFzZUZ1bmN0aW9uKFN0cmluZyBu\nYW1lLCBDbGFzczxUPiByZXN1bHRUeXBlLCBFeHByZXNzaW9uPD8+Li4uIGV4\ncHMpIHsKICAgICAgICAgICAgc3VwZXIocmVzdWx0VHlwZSwgZXhwcyk7CiAg\nICAgICAgICAgIGZ1bmN0aW9uTmFtZSA9IG5hbWU7CiAgICAgICAgICAgIHRo\naXMucmVzdWx0VHlwZSA9IHJlc3VsdFR5cGU7CiAgICAgICAgfQogICAgICAg\nIAogICAgICAgIEBPdmVycmlkZQogICAgICAgIHB1YmxpYyBWYWx1ZSB0b1Zh\nbHVlKEV4cHJlc3Npb25GYWN0b3J5IGZhY3RvcnksIENyaXRlcmlhUXVlcnlJ\nbXBsPD8+IHEpIHsKICAgICAgICAgICAgcmV0dXJuIGZhY3RvcnkubmV3RnVu\nY3Rpb24oZnVuY3Rpb25OYW1lLCBnZXRKYXZhVHlwZSgpLCAKICAgICAgICAg\nICAgICAgIG5ldyBFeHByZXNzaW9ucy5MaXN0QXJndW1lbnQocmVzdWx0VHlw\nZSwgYXJncykudG9WYWx1ZShmYWN0b3J5LCBxKSk7CiAgICAgICAgfQogICAg\nICAgIAogICAgICAgIHB1YmxpYyBTdHJpbmdCdWlsZGVyIGFzVmFsdWUoQWxp\nYXNDb250ZXh0IHEpIHsKICAgICAgICAgICAgcmV0dXJuIEV4cHJlc3Npb25z\nLmFzVmFsdWUocSwgZnVuY3Rpb25OYW1lLCBPUEVOX0JSQUNFLCBFeHByZXNz\naW9ucy5hc1ZhbHVlKHEsIGFyZ3MsIENPTU1BKSwgQ0xPU0VfQlJBQ0UpOwog\nICAgICAgIH0KICAgIH0KCiAgICAKICAgIHB1YmxpYyBzdGF0aWMgY2xhc3Mg\nVHlwZTxYIGV4dGVuZHMgQ2xhc3M+IGV4dGVuZHMgVW5hcnlGdW5jdGlvbmFs\nRXhwcmVzc2lvbjxYPiB7CiAgICAgICAgcHVibGljIFR5cGUoUGF0aEltcGw8\nPywgPz4gcGF0aCkgewogICAgICAgICAgICBzdXBlcigoQ2xhc3MpQ2xhc3Mu\nY2xhc3MsIHBhdGgpOwogICAgICAgIH0KICAgICAgICAKICAgICAgICBAT3Zl\ncnJpZGUKICAgICAgICBwdWJsaWMgVmFsdWUgdG9WYWx1ZShFeHByZXNzaW9u\nRmFjdG9yeSBmYWN0b3J5LCBDcml0ZXJpYVF1ZXJ5SW1wbDw/PiBxKSB7CiAg\nICAgICAgICAgIHJldHVybiBmYWN0b3J5LnR5cGUoRXhwcmVzc2lvbnMudG9W\nYWx1ZShlLCBmYWN0b3J5LCBxKSk7CiAgICAgICAgfQogICAgICAgIAogICAg\nICAgIEBPdmVycmlkZQogICAgICAgIHB1YmxpYyBTdHJpbmdCdWlsZGVyIGFz\nVmFsdWUoQWxpYXNDb250ZXh0IHEpIHsKICAgICAgICAgICAgcmV0dXJuIEV4\ncHJlc3Npb25zLmFzVmFsdWUocSwgIlRZUEUiLCBPUEVOX0JSQUNFLCBlLCBD\nTE9TRV9CUkFDRSk7CiAgICAgICAgfQogICAgfQoKICAgIHB1YmxpYyBzdGF0\naWMgY2xhc3MgQ2FzdDxCPiBleHRlbmRzIFVuYXJ5RnVuY3Rpb25hbEV4cHJl\nc3Npb248Qj4gewogICAgICAgIHB1YmxpYyBDYXN0KEV4cHJlc3Npb248Pz4g\neCwgQ2xhc3M8Qj4gYikgewogICAgICAgICAgICBzdXBlcihiLCB4KTsKICAg\nICAgICB9CgogICAgICAgIEBPdmVycmlkZQogICAgICAgIHB1YmxpYyBWYWx1\nZSB0b1ZhbHVlKEV4cHJlc3Npb25GYWN0b3J5IGZhY3RvcnksIENyaXRlcmlh\nUXVlcnlJbXBsPD8+IHEpIHsKICAgICAgICAgICAgcmV0dXJuIGZhY3Rvcnku\nY2FzdChFeHByZXNzaW9ucy50b1ZhbHVlKGUsIGZhY3RvcnksIHEpLCBnZXRK\nYXZhVHlwZSgpKTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgQE92ZXJy\naWRlCiAgICAgICAgcHVibGljIFN0cmluZ0J1aWxkZXIgYXNWYWx1ZShBbGlh\nc0NvbnRleHQgcSkgewogICAgICAgICAgICByZXR1cm4gRXhwcmVzc2lvbnMu\nYXNWYWx1ZShxLCBPUEVOX0JSQUNFLCBnZXRKYXZhVHlwZSgpLmdldFNpbXBs\nZU5hbWUoKSwgQ0xPU0VfQlJBQ0UsIGUpOwogICAgICAgIH0KICAgIH0KICAg\nIAogICAgcHVibGljIHN0YXRpYyBjbGFzcyBDb25jYXQgZXh0ZW5kcyBCaW5h\ncmF5RnVuY3Rpb25hbEV4cHJlc3Npb248U3RyaW5nPiB7CiAgICAgICAgcHVi\nbGljIENvbmNhdChFeHByZXNzaW9uPFN0cmluZz4geCwgRXhwcmVzc2lvbjxT\ndHJpbmc+IHkpIHsKICAgICAgICAgICAgc3VwZXIoU3RyaW5nLmNsYXNzLCB4\nLCB5KTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgcHVibGljIENvbmNh\ndChFeHByZXNzaW9uPFN0cmluZz4geCwgU3RyaW5nIHkpIHsKICAgICAgICAg\nICAgdGhpcyh4LCBuZXcgQ29uc3RhbnQ8U3RyaW5nPih5KSk7CiAgICAgICAg\nfQogICAgICAgIAogICAgICAgIHB1YmxpYyBDb25jYXQoU3RyaW5nIHgsIEV4\ncHJlc3Npb248U3RyaW5nPiB5KSB7CiAgICAgICAgICAgIHRoaXMobmV3IENv\nbnN0YW50PFN0cmluZz4oeCksIHkpOwogICAgICAgIH0KICAgICAgICAKICAg\nICAgICBAT3ZlcnJpZGUKICAgICAgICBwdWJsaWMgVmFsdWUgdG9WYWx1ZShF\neHByZXNzaW9uRmFjdG9yeSBmYWN0b3J5LCBDcml0ZXJpYVF1ZXJ5SW1wbDw/\nPiBxKSB7CiAgICAgICAgICAgIHJldHVybiBmYWN0b3J5LmNvbmNhdCgKICAg\nICAgICAgICAgICAgIEV4cHJlc3Npb25zLnRvVmFsdWUoZTEsIGZhY3Rvcnks\nIHEpLCAKICAgICAgICAgICAgICAgIEV4cHJlc3Npb25zLnRvVmFsdWUoZTIs\nIGZhY3RvcnksIHEpKTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgQE92\nZXJyaWRlCiAgICAgICAgcHVibGljIFN0cmluZ0J1aWxkZXIgYXNWYWx1ZShB\nbGlhc0NvbnRleHQgcSkgewogICAgICAgICAgICByZXR1cm4gRXhwcmVzc2lv\nbnMuYXNWYWx1ZShxLCAiQ09OQ0FUIiwgT1BFTl9CUkFDRSwgZTEsIENPTU1B\nLCBlMiwgQ0xPU0VfQlJBQ0UpOwogICAgICAgIH0KICAgIH0KICAgIAogICAg\ncHVibGljIHN0YXRpYyBjbGFzcyBTdWJzdHJpbmcgZXh0ZW5kcyBVbmFyeUZ1\nbmN0aW9uYWxFeHByZXNzaW9uPFN0cmluZz4gewogICAgICAgIHByaXZhdGUg\nRXhwcmVzc2lvbkltcGw8SW50ZWdlcj4gZnJvbTsKICAgICAgICBwcml2YXRl\nIEV4cHJlc3Npb25JbXBsPEludGVnZXI+IGxlbjsKICAgICAgICAKICAgICAg\nICBwdWJsaWMgU3Vic3RyaW5nKEV4cHJlc3Npb248U3RyaW5nPiBzLCBFeHBy\nZXNzaW9uPEludGVnZXI+IGZyb20sIEV4cHJlc3Npb248SW50ZWdlcj4gbGVu\nKSB7CiAgICAgICAgICAgIHN1cGVyKFN0cmluZy5jbGFzcywgcyk7CiAgICAg\nICAgICAgIHRoaXMuZnJvbSA9IChFeHByZXNzaW9uSW1wbDxJbnRlZ2VyPilm\ncm9tOwogICAgICAgICAgICB0aGlzLmxlbiAgPSAoRXhwcmVzc2lvbkltcGw8\nSW50ZWdlcj4pbGVuOwogICAgICAgIH0KICAgICAgICAKICAgICAgICBwdWJs\naWMgU3Vic3RyaW5nKEV4cHJlc3Npb248U3RyaW5nPiBzLCBFeHByZXNzaW9u\nPEludGVnZXI+IGZyb20pIHsKICAgICAgICAgICAgdGhpcyhzLCAoRXhwcmVz\nc2lvbkltcGw8SW50ZWdlcj4pZnJvbSwgbnVsbCk7CiAgICAgICAgfQoKICAg\nICAgICBwdWJsaWMgU3Vic3RyaW5nKEV4cHJlc3Npb248U3RyaW5nPiBzKSB7\nCiAgICAgICAgICAgIHRoaXMocywgKEV4cHJlc3Npb248SW50ZWdlcj4pbnVs\nbCwgKEV4cHJlc3Npb248SW50ZWdlcj4pbnVsbCk7CiAgICAgICAgfQogICAg\nICAgIAogICAgICAgIHB1YmxpYyBTdWJzdHJpbmcoRXhwcmVzc2lvbjxTdHJp\nbmc+IHMsIEludGVnZXIgZnJvbSkgewogICAgICAgICAgICB0aGlzKHMsIG5l\ndyBDb25zdGFudDxJbnRlZ2VyPihmcm9tKSwgbnVsbCk7CiAgICAgICAgfQog\nICAgICAgIAogICAgICAgIHB1YmxpYyBTdWJzdHJpbmcoRXhwcmVzc2lvbjxT\ndHJpbmc+IHMsIEludGVnZXIgZnJvbSwgSW50ZWdlciBsZW4pIHsKICAgICAg\nICAgICAgdGhpcyhzLCBuZXcgQ29uc3RhbnQ8SW50ZWdlcj4oZnJvbSksIG5l\ndyBDb25zdGFudDxJbnRlZ2VyPihsZW4pKTsKICAgICAgICB9CiAgICAgICAg\nCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgcHVibGljIFZhbHVlIHRvVmFs\ndWUoRXhwcmVzc2lvbkZhY3RvcnkgZmFjdG9yeSwgQ3JpdGVyaWFRdWVyeUlt\ncGw8Pz4gcSkgewogICAgICAgICAgICByZXR1cm4gSlBRTEV4cHJlc3Npb25C\ndWlsZGVyLmNvbnZlcnRTdWJzdHJpbmdBcmd1bWVudHMoZmFjdG9yeSwgCiAg\nICAgICAgICAgICAgICBFeHByZXNzaW9ucy50b1ZhbHVlKGUsIGZhY3Rvcnks\nIHEpLCAKICAgICAgICAgICAgICAgIGZyb20gPT0gbnVsbCA/IG51bGwgOiBm\ncm9tLnRvVmFsdWUoZmFjdG9yeSwgcSksIAogICAgICAgICAgICAgICAgbGVu\nID09IG51bGwgPyBudWxsIDogbGVuLnRvVmFsdWUoZmFjdG9yeSwgcSkpOwog\nICAgICAgIH0KICAgICAgICAKICAgICAgICBwdWJsaWMgdm9pZCBhY2NlcHRW\naXNpdChDcml0ZXJpYUV4cHJlc3Npb25WaXNpdG9yIHZpc2l0b3IpIHsKICAg\nICAgICAgICAgc3VwZXIuYWNjZXB0VmlzaXQodmlzaXRvcik7CiAgICAgICAg\nICAgIEV4cHJlc3Npb25zLmFjY2VwdFZpc2l0KHZpc2l0b3IsIGZyb20sIGxl\nbik7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIEBPdmVycmlkZQogICAg\nICAgIHB1YmxpYyBTdHJpbmdCdWlsZGVyIGFzVmFsdWUoQWxpYXNDb250ZXh0\nIHEpIHsKICAgICAgICAgICAgcmV0dXJuIEV4cHJlc3Npb25zLmFzVmFsdWUo\ncSwgIlNVQlNUUklORyIsIE9QRU5fQlJBQ0UsIGUsIENPTU1BLCBmcm9tLCBD\nT01NQSwgbGVuLCBDTE9TRV9CUkFDRSk7CiAgICAgICAgfQogICAgfQoKICAg\nIHB1YmxpYyBzdGF0aWMgY2xhc3MgTG9jYXRlIGV4dGVuZHMgRXhwcmVzc2lv\nbkltcGw8SW50ZWdlcj4gewogICAgICAgIHByaXZhdGUgRXhwcmVzc2lvbklt\ncGw8U3RyaW5nPiBwYXR0ZXJuOwogICAgICAgIHByaXZhdGUgRXhwcmVzc2lv\nbkltcGw8SW50ZWdlcj4gZnJvbTsKICAgICAgICBwcml2YXRlIEV4cHJlc3Np\nb25JbXBsPFN0cmluZz4gcGF0aDsKICAgICAgICAKICAgICAgICBwdWJsaWMg\nTG9jYXRlKEV4cHJlc3Npb248U3RyaW5nPiBwYXRoLCBFeHByZXNzaW9uPFN0\ncmluZz4gcGF0dGVybiwgRXhwcmVzc2lvbjxJbnRlZ2VyPiBmcm9tKSB7CiAg\nICAgICAgICAgIHN1cGVyKEludGVnZXIuY2xhc3MpOwogICAgICAgICAgICB0\naGlzLnBhdGggPSAoRXhwcmVzc2lvbkltcGw8U3RyaW5nPilwYXRoOwogICAg\nICAgICAgICB0aGlzLnBhdHRlcm4gPSAoRXhwcmVzc2lvbkltcGw8U3RyaW5n\nPilwYXR0ZXJuOwogICAgICAgICAgICB0aGlzLmZyb20gPSAoRXhwcmVzc2lv\nbkltcGw8SW50ZWdlcj4pZnJvbTsKICAgICAgICB9CgogICAgICAgIHB1Ymxp\nYyBMb2NhdGUoRXhwcmVzc2lvbjxTdHJpbmc+IHBhdGgsIEV4cHJlc3Npb248\nU3RyaW5nPiBwYXR0ZXJuKSB7CiAgICAgICAgICAgIHRoaXMocGF0aCwgcGF0\ndGVybiwgbnVsbCk7CiAgICAgICAgIH0KICAgICAgICAKICAgICAgICBwdWJs\naWMgTG9jYXRlKEV4cHJlc3Npb248U3RyaW5nPiBwYXRoLCBTdHJpbmcgcGF0\ndGVybikgewogICAgICAgICAgICB0aGlzKHBhdGgsIG5ldyBDb25zdGFudDxT\ndHJpbmc+KHBhdHRlcm4pLCBudWxsKTsKICAgICAgICB9CiAgICAgICAgCiAg\nICAgICAgcHVibGljIExvY2F0ZShTdHJpbmcgcGF0aCwgRXhwcmVzc2lvbjxT\ndHJpbmc+IHBhdHRlcm4pIHsKICAgICAgICAgICAgdGhpcyhuZXcgQ29uc3Rh\nbnQ8U3RyaW5nPihwYXRoKSwgcGF0dGVybiwgbnVsbCk7CiAgICAgICAgfQog\nICAgICAgIAogICAgICAgIHB1YmxpYyBMb2NhdGUoRXhwcmVzc2lvbjxTdHJp\nbmc+IHBhdGgsIFN0cmluZyBwYXR0ZXJuLCBpbnQgZnJvbSkgewogICAgICAg\nICAgICB0aGlzKHBhdGgsIG5ldyBDb25zdGFudDxTdHJpbmc+KHBhdHRlcm4p\nLCBuZXcgQ29uc3RhbnQ8SW50ZWdlcj4oZnJvbSkpOwogICAgICAgIH0KCiAg\nICAgICAgQE92ZXJyaWRlCiAgICAgICAgcHVibGljIFZhbHVlIHRvVmFsdWUo\nRXhwcmVzc2lvbkZhY3RvcnkgZmFjdG9yeSwgQ3JpdGVyaWFRdWVyeUltcGw8\nPz4gcSkgewogICAgICAgICAgICBWYWx1ZSBsb2NhdGVTZWFyY2ggPSBwYXRo\nLnRvVmFsdWUoZmFjdG9yeSwgcSk7CiAgICAgICAgICAgIFZhbHVlIGxvY2F0\nZUZyb21JbmRleCA9IChmcm9tID09IG51bGwgPyBudWxsIDogRXhwcmVzc2lv\nbnMudG9WYWx1ZShmcm9tLCBmYWN0b3J5LCBxKSk7CiAgICAgICAgICAgIFZh\nbHVlIGxvY2F0ZVBhdGggPSBFeHByZXNzaW9ucy50b1ZhbHVlKHBhdHRlcm4s\nIGZhY3RvcnksIHEpOwogICAgICAgICAgICAKICAgICAgICAgICAgcmV0dXJu\nIGZhY3RvcnkuYWRkKGZhY3RvcnkuaW5kZXhPZihsb2NhdGVTZWFyY2gsCiAg\nICAgICAgICAgICAgICAgICAgbG9jYXRlRnJvbUluZGV4ID09IG51bGwgPyBs\nb2NhdGVQYXRoCiAgICAgICAgICAgICAgICAgICAgICAgIDogZmFjdG9yeS5u\nZXdBcmd1bWVudExpc3QobG9jYXRlUGF0aCwKICAgICAgICAgICAgICAgICAg\nICAgICAgICAgIGZhY3Rvcnkuc3VidHJhY3QobG9jYXRlRnJvbUluZGV4LCAK\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nZmFjdG9yeS5uZXdMaXRlcmFsKEludGVnZXIudmFsdWVPZigxKSwgTGl0ZXJh\nbC5UWVBFX05VTUJFUikpKSksCiAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgIGZhY3RvcnkubmV3TGl0ZXJhbChJbnRlZ2Vy\nLnZhbHVlT2YoMSksIExpdGVyYWwuVFlQRV9OVU1CRVIpKTsKICAgICAgICB9\nCiAgICAgICAgCiAgICAgICAgcHVibGljIHZvaWQgYWNjZXB0VmlzaXQoQ3Jp\ndGVyaWFFeHByZXNzaW9uVmlzaXRvciB2aXNpdG9yKSB7CiAgICAgICAgICAg\nIEV4cHJlc3Npb25zLmFjY2VwdFZpc2l0KHZpc2l0b3IsIHRoaXMsIHBhdHRl\ncm4sIGZyb20sIHBhdGgpOwogICAgICAgIH0KICAgICAgICAKICAgICAgICBA\nT3ZlcnJpZGUKICAgICAgICBwdWJsaWMgU3RyaW5nQnVpbGRlciBhc1ZhbHVl\nKEFsaWFzQ29udGV4dCBxKSB7CiAgICAgICAgICAgIHJldHVybiBFeHByZXNz\naW9ucy5hc1ZhbHVlKHEsICJMT0NBVEUiLCBPUEVOX0JSQUNFLCBwYXR0ZXJu\nLCBDT01NQSwgcGF0aCwgQ0xPU0VfQlJBQ0UpOwogICAgICAgIH0KICAgIH0K\nICAgIAogICAgcHVibGljIHN0YXRpYyBjbGFzcyBUcmltIGV4dGVuZHMgQmlu\nYXJheUZ1bmN0aW9uYWxFeHByZXNzaW9uPFN0cmluZz4gewogICAgICAgIHN0\nYXRpYyBFeHByZXNzaW9uPENoYXJhY3Rlcj4gZGVmYXVsdFRyaW0gPSBuZXcg\nQ29uc3RhbnQ8Q2hhcmFjdGVyPihDaGFyYWN0ZXIuY2xhc3MsIG5ldyBDaGFy\nYWN0ZXIoJyAnKSk7CiAgICAgICAgc3RhdGljIFRyaW1zcGVjIGRlZmF1bHRT\ncGVjID0gVHJpbXNwZWMuQk9USDsKICAgICAgICBwcml2YXRlIFRyaW1zcGVj\nIHRzOwogICAgICAgIAogICAgICAgIHB1YmxpYyBUcmltKEV4cHJlc3Npb248\nU3RyaW5nPiB4LCBFeHByZXNzaW9uPENoYXJhY3Rlcj4geSwgVHJpbXNwZWMg\ndHMpIHsKICAgICAgICAgICAgc3VwZXIoU3RyaW5nLmNsYXNzLCB4LCB5KTsK\nICAgICAgICAgICAgdGhpcy50cyA9IHRzOwogICAgICAgIH0KICAgICAgICAK\nICAgICAgICBwdWJsaWMgVHJpbShFeHByZXNzaW9uPFN0cmluZz4geCwgRXhw\ncmVzc2lvbjxDaGFyYWN0ZXI+IHkpIHsKICAgICAgICAgICAgdGhpcyh4LCB5\nLCBkZWZhdWx0U3BlYyk7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIHB1\nYmxpYyBUcmltKEV4cHJlc3Npb248U3RyaW5nPiB4KSB7CiAgICAgICAgICAg\nIHRoaXMoeCwgZGVmYXVsdFRyaW0sIGRlZmF1bHRTcGVjKTsKICAgICAgICB9\nCiAgICAgICAgCiAgICAgICAgcHVibGljIFRyaW0oRXhwcmVzc2lvbjxTdHJp\nbmc+IHgsIENoYXJhY3RlciB0KSB7CiAgICAgICAgICAgIHRoaXMoeCwgbmV3\nIENvbnN0YW50PENoYXJhY3Rlcj4oQ2hhcmFjdGVyLmNsYXNzLCB0KSwgZGVm\nYXVsdFNwZWMpOwogICAgICAgIH0KICAgICAgICAKICAgICAgICBwdWJsaWMg\nVHJpbShFeHByZXNzaW9uPFN0cmluZz4geCwgQ2hhcmFjdGVyIHQsIFRyaW1z\ncGVjIHRzKSB7CiAgICAgICAgICAgIHRoaXMoeCwgbmV3IENvbnN0YW50PENo\nYXJhY3Rlcj4oQ2hhcmFjdGVyLmNsYXNzLCB0KSwgdHMpOwogICAgICAgIH0K\nICAgICAgICAKICAgICAgICBwdWJsaWMgVHJpbShFeHByZXNzaW9uPFN0cmlu\nZz4geCwgVHJpbXNwZWMgdHMpIHsKICAgICAgICAgICAgdGhpcyh4LCBkZWZh\ndWx0VHJpbSwgdHMpOwogICAgICAgIH0KCiAgICAgICAgQE92ZXJyaWRlCiAg\nICAgICAgcHVibGljIFZhbHVlIHRvVmFsdWUoRXhwcmVzc2lvbkZhY3Rvcnkg\nZmFjdG9yeSwgQ3JpdGVyaWFRdWVyeUltcGw8Pz4gcSkgewogICAgICAgICAg\nICBCb29sZWFuIHNwZWMgPSBudWxsOwogICAgICAgICAgICBpZiAodHMgIT0g\nbnVsbCkgewogICAgICAgICAgICAgICAgc3dpdGNoICh0cykgewogICAgICAg\nICAgICAgICAgY2FzZSBMRUFESU5HICA6IHNwZWMgPSB0cnVlOyAgYnJlYWs7\nCiAgICAgICAgICAgICAgICBjYXNlIFRSQUlMSU5HIDogc3BlYyA9IGZhbHNl\nOyBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgQk9USCAgICAgOiBzcGVj\nID0gbnVsbDsgIGJyZWFrOwogICAgICAgICAgICAgICAgfQogICAgICAgICAg\nICB9CiAgICAgICAgICAgIHJldHVybiBmYWN0b3J5LnRyaW0oCiAgICAgICAg\nICAgICAgICBFeHByZXNzaW9ucy50b1ZhbHVlKGUxLCBmYWN0b3J5LCBxKSwg\nCiAgICAgICAgICAgICAgICBFeHByZXNzaW9ucy50b1ZhbHVlKGUyLCBmYWN0\nb3J5LCBxKSwgc3BlYyk7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIEBP\ndmVycmlkZQogICAgICAgIHB1YmxpYyBTdHJpbmdCdWlsZGVyIGFzVmFsdWUo\nQWxpYXNDb250ZXh0IHEpIHsKICAgICAgICAgICAgcmV0dXJuIEV4cHJlc3Np\nb25zLmFzVmFsdWUocSwgIlRSSU0iLCBPUEVOX0JSQUNFLCBlMSwgQ09NTUEs\nIGUyLCBDTE9TRV9CUkFDRSk7CiAgICAgICAgfSAgICAgICAgCiAgICB9CiAg\nICAKICAgIHB1YmxpYyBzdGF0aWMgY2xhc3MgU3VtPE4gZXh0ZW5kcyBOdW1i\nZXI+IGV4dGVuZHMgQmluYXJheUZ1bmN0aW9uYWxFeHByZXNzaW9uPE4+IHsK\nICAgICAgICBwdWJsaWMgU3VtKEV4cHJlc3Npb248PyBleHRlbmRzIE51bWJl\ncj4geCwgRXhwcmVzc2lvbjw/IGV4dGVuZHMgTnVtYmVyPiB5KSB7CiAgICAg\nICAgICAgIHN1cGVyKChDbGFzczxOPil4LmdldEphdmFUeXBlKCksIHgsIHkp\nOwogICAgICAgIH0KICAgICAgICAKICAgICAgICBwdWJsaWMgU3VtKEV4cHJl\nc3Npb248PyBleHRlbmRzIE51bWJlcj4geCkgewogICAgICAgICAgICB0aGlz\nKHgsIChFeHByZXNzaW9uPD8gZXh0ZW5kcyBOdW1iZXI+KW51bGwpOwogICAg\nICAgIH0KCiAgICAgICAgcHVibGljIFN1bShFeHByZXNzaW9uPD8gZXh0ZW5k\ncyBOdW1iZXI+IHgsIE51bWJlciB5KSB7CiAgICAgICAgICAgIHRoaXMoeCwg\nbmV3IENvbnN0YW50PE51bWJlcj4oTnVtYmVyLmNsYXNzLCB5KSk7CiAgICAg\nICAgfQoKICAgICAgICBwdWJsaWMgU3VtKE51bWJlciB4LCBFeHByZXNzaW9u\nPD8gZXh0ZW5kcyBOdW1iZXI+IHkpIHsKICAgICAgICAgICAgdGhpcyhuZXcg\nQ29uc3RhbnQ8TnVtYmVyPihOdW1iZXIuY2xhc3MsIHgpLCB5KTsKICAgICAg\nICB9CiAgICAgICAgCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgcHVibGlj\nIFZhbHVlIHRvVmFsdWUoRXhwcmVzc2lvbkZhY3RvcnkgZmFjdG9yeSwgQ3Jp\ndGVyaWFRdWVyeUltcGw8Pz4gcSkgewogICAgICAgICAgICByZXR1cm4gKGUy\nID09IG51bGwpIAogICAgICAgICAgICA/ICAgZmFjdG9yeS5zdW0oRXhwcmVz\nc2lvbnMudG9WYWx1ZShlMSwgZmFjdG9yeSwgcSkpCiAgICAgICAgICAgIDog\nICBmYWN0b3J5LmFkZCgKICAgICAgICAgICAgICAgICAgIEV4cHJlc3Npb25z\nLnRvVmFsdWUoZTEsIGZhY3RvcnksIHEpLCAKICAgICAgICAgICAgICAgICAg\nIEV4cHJlc3Npb25zLnRvVmFsdWUoZTIsIGZhY3RvcnksIHEpKTsKICAgICAg\nICB9CiAgICAgICAgCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgcHVibGlj\nIFN0cmluZ0J1aWxkZXIgYXNWYWx1ZShBbGlhc0NvbnRleHQgcSkgewogICAg\nICAgICAgICByZXR1cm4gZTIgPT0gbnVsbCAKICAgICAgICAgICAgICAgPyBF\neHByZXNzaW9ucy5hc1ZhbHVlKHEsICJTVU0iLCBPUEVOX0JSQUNFLCBlMSwg\nQ0xPU0VfQlJBQ0UpCiAgICAgICAgICAgICAgIDogRXhwcmVzc2lvbnMuYXNW\nYWx1ZShxLCBlMSwgIiArICIsIGUyKTsKICAgICAgICB9ICAgICAgICAKICAg\nICB9CiAgICAKICAgIHB1YmxpYyBzdGF0aWMgY2xhc3MgUHJvZHVjdDxOIGV4\ndGVuZHMgTnVtYmVyPiBleHRlbmRzIEJpbmFyYXlGdW5jdGlvbmFsRXhwcmVz\nc2lvbjxOPiB7CiAgICAgICAgcHVibGljIFByb2R1Y3QoRXhwcmVzc2lvbjw/\nIGV4dGVuZHMgTnVtYmVyPiB4LCBFeHByZXNzaW9uPD8gZXh0ZW5kcyBOdW1i\nZXI+IHkpIHsKICAgICAgICAgICAgc3VwZXIoKENsYXNzPE4+KXguZ2V0SmF2\nYVR5cGUoKSwgeCwgeSk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgUHJv\nZHVjdChFeHByZXNzaW9uPD8gZXh0ZW5kcyBOdW1iZXI+IHgsIE51bWJlciB5\nKSB7CiAgICAgICAgICAgIHRoaXMoeCwgbmV3IENvbnN0YW50PE51bWJlcj4o\nTnVtYmVyLmNsYXNzLCB5KSk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMg\nUHJvZHVjdChOdW1iZXIgeCwgRXhwcmVzc2lvbjw/IGV4dGVuZHMgTnVtYmVy\nPiB5KSB7CiAgICAgICAgICAgIHRoaXMobmV3IENvbnN0YW50PE51bWJlcj4o\nTnVtYmVyLmNsYXNzLCB4KSwgeSk7CiAgICAgICAgfQogICAgICAgIAogICAg\nICAgIEBPdmVycmlkZQogICAgICAgIHB1YmxpYyBWYWx1ZSB0b1ZhbHVlKEV4\ncHJlc3Npb25GYWN0b3J5IGZhY3RvcnksIENyaXRlcmlhUXVlcnlJbXBsPD8+\nIHEpIHsKICAgICAgICAgICAgcmV0dXJuIGZhY3RvcnkubXVsdGlwbHkoCiAg\nICAgICAgICAgICAgICBFeHByZXNzaW9ucy50b1ZhbHVlKGUxLCBmYWN0b3J5\nLCBxKSwgCiAgICAgICAgICAgICAgICBFeHByZXNzaW9ucy50b1ZhbHVlKGUy\nLCBmYWN0b3J5LCBxKSk7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIEBP\ndmVycmlkZQogICAgICAgIHB1YmxpYyBTdHJpbmdCdWlsZGVyIGFzVmFsdWUo\nQWxpYXNDb250ZXh0IHEpIHsKICAgICAgICAgICAgcmV0dXJuIEV4cHJlc3Np\nb25zLmFzVmFsdWUocSwgZTEsICIgKiAiICxlMik7CiAgICAgICAgfSAgICAg\nICAgCiAgICB9CiAgICAKICAgIHB1YmxpYyBzdGF0aWMgY2xhc3MgRGlmZjxO\nIGV4dGVuZHMgTnVtYmVyPiBleHRlbmRzIEJpbmFyYXlGdW5jdGlvbmFsRXhw\ncmVzc2lvbjxOPiB7CiAgICAgICAgcHVibGljIERpZmYoRXhwcmVzc2lvbjw/\nIGV4dGVuZHMgTnVtYmVyPiB4LCBFeHByZXNzaW9uPD8gZXh0ZW5kcyBOdW1i\nZXI+IHkpIHsKICAgICAgICAgICAgc3VwZXIoKENsYXNzPE4+KXguZ2V0SmF2\nYVR5cGUoKSwgeCwgeSk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgRGlm\nZihFeHByZXNzaW9uPD8gZXh0ZW5kcyBOdW1iZXI+IHgsIE51bWJlciB5KSB7\nCiAgICAgICAgICAgIHRoaXMoeCwgbmV3IENvbnN0YW50PE51bWJlcj4oTnVt\nYmVyLmNsYXNzLCB5KSk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgRGlm\nZihOdW1iZXIgeCwgRXhwcmVzc2lvbjw/IGV4dGVuZHMgTnVtYmVyPiB5KSB7\nCiAgICAgICAgICAgIHRoaXMobmV3IENvbnN0YW50PE51bWJlcj4oTnVtYmVy\nLmNsYXNzLCB4KSwgeSk7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIEBP\ndmVycmlkZQogICAgICAgIHB1YmxpYyBWYWx1ZSB0b1ZhbHVlKEV4cHJlc3Np\nb25GYWN0b3J5IGZhY3RvcnksIENyaXRlcmlhUXVlcnlJbXBsPD8+IHEpIHsK\nICAgICAgICAgICAgcmV0dXJuIGZhY3Rvcnkuc3VidHJhY3QoCiAgICAgICAg\nICAgICAgICBFeHByZXNzaW9ucy50b1ZhbHVlKGUxLCBmYWN0b3J5LCBxKSwg\nCiAgICAgICAgICAgICAgICBFeHByZXNzaW9ucy50b1ZhbHVlKGUyLCBmYWN0\nb3J5LCBxKSk7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIEBPdmVycmlk\nZQogICAgICAgIHB1YmxpYyBTdHJpbmdCdWlsZGVyIGFzVmFsdWUoQWxpYXND\nb250ZXh0IHEpIHsKICAgICAgICAgICAgcmV0dXJuIEV4cHJlc3Npb25zLmFz\nVmFsdWUocSwgZTEsICIgLSAiICxlMik7CiAgICAgICAgfSAgICAgICAgCiAg\nICB9CgogICAgCiAgICBwdWJsaWMgc3RhdGljIGNsYXNzIFF1b3RpZW50PE4g\nZXh0ZW5kcyBOdW1iZXI+IGV4dGVuZHMgQmluYXJheUZ1bmN0aW9uYWxFeHBy\nZXNzaW9uPE4+IHsKICAgICAgICBwdWJsaWMgUXVvdGllbnQoRXhwcmVzc2lv\nbjw/IGV4dGVuZHMgTnVtYmVyPiB4LCBFeHByZXNzaW9uPD8gZXh0ZW5kcyBO\ndW1iZXI+IHkpIHsKICAgICAgICAgICAgc3VwZXIoKENsYXNzPE4+KXguZ2V0\nSmF2YVR5cGUoKSwgeCwgeSk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMg\nUXVvdGllbnQoRXhwcmVzc2lvbjw/IGV4dGVuZHMgTnVtYmVyPiB4LCBOdW1i\nZXIgeSkgewogICAgICAgICAgICB0aGlzKHgsIG5ldyBDb25zdGFudDxOdW1i\nZXI+KHkpKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBRdW90aWVudChO\ndW1iZXIgeCwgRXhwcmVzc2lvbjw/IGV4dGVuZHMgTnVtYmVyPiB5KSB7CiAg\nICAgICAgICAgIHRoaXMobmV3IENvbnN0YW50PE51bWJlcj4oeCksIHkpOwog\nICAgICAgIH0KICAgICAgICAKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBw\ndWJsaWMgVmFsdWUgdG9WYWx1ZShFeHByZXNzaW9uRmFjdG9yeSBmYWN0b3J5\nLCBDcml0ZXJpYVF1ZXJ5SW1wbDw/PiBxKSB7CiAgICAgICAgICAgIHJldHVy\nbiBmYWN0b3J5LmRpdmlkZSgKICAgICAgICAgICAgICAgIEV4cHJlc3Npb25z\nLnRvVmFsdWUoZTEsIGZhY3RvcnksIHEpLCAKICAgICAgICAgICAgICAgIEV4\ncHJlc3Npb25zLnRvVmFsdWUoZTIsIGZhY3RvcnksIHEpKTsKICAgICAgICB9\nCiAgICAgICAgCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgcHVibGljIFN0\ncmluZ0J1aWxkZXIgYXNWYWx1ZShBbGlhc0NvbnRleHQgcSkgewogICAgICAg\nICAgICByZXR1cm4gRXhwcmVzc2lvbnMuYXNWYWx1ZShxLCBlMSwgIiUiICxl\nMik7CiAgICAgICAgfSAgICAgICAgCiAgICB9CgogICAgcHVibGljIHN0YXRp\nYyBjbGFzcyBNb2QgZXh0ZW5kcyBCaW5hcmF5RnVuY3Rpb25hbEV4cHJlc3Np\nb248SW50ZWdlcj4gewogICAgICAgIHB1YmxpYyAgTW9kKEV4cHJlc3Npb248\nSW50ZWdlcj4geCwgRXhwcmVzc2lvbjxJbnRlZ2VyPiB5KSB7CiAgICAgICAg\nICAgIHN1cGVyKEludGVnZXIuY2xhc3MsIHgseSk7CiAgICAgICAgfQogICAg\nICAgIHB1YmxpYyAgTW9kKEV4cHJlc3Npb248SW50ZWdlcj4geCwgSW50ZWdl\nciB5KSB7CiAgICAgICAgICAgIHRoaXMoeCxuZXcgQ29uc3RhbnQ8SW50ZWdl\ncj4oSW50ZWdlci5jbGFzcywgeSkpOwogICAgICAgIH0KICAgICAgICBwdWJs\naWMgIE1vZChJbnRlZ2VyIHgsIEV4cHJlc3Npb248SW50ZWdlcj4geSkgewog\nICAgICAgICAgICB0aGlzKG5ldyBDb25zdGFudDxJbnRlZ2VyPihJbnRlZ2Vy\nLmNsYXNzLCB4KSx5KTsKICAgICAgICB9CgogICAgICAgIEBPdmVycmlkZQog\nICAgICAgIHB1YmxpYyBWYWx1ZSB0b1ZhbHVlKEV4cHJlc3Npb25GYWN0b3J5\nIGZhY3RvcnksIENyaXRlcmlhUXVlcnlJbXBsPD8+IHEpIHsKICAgICAgICAg\nICAgcmV0dXJuIGZhY3RvcnkubW9kKAogICAgICAgICAgICAgICAgRXhwcmVz\nc2lvbnMudG9WYWx1ZShlMSwgZmFjdG9yeSwgcSksIAogICAgICAgICAgICAg\nICAgRXhwcmVzc2lvbnMudG9WYWx1ZShlMiwgZmFjdG9yeSwgcSkpOwogICAg\nICAgIH0KICAgICAgICAKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBwdWJs\naWMgU3RyaW5nQnVpbGRlciBhc1ZhbHVlKEFsaWFzQ29udGV4dCBxKSB7CiAg\nICAgICAgICAgIHJldHVybiBFeHByZXNzaW9ucy5hc1ZhbHVlKHEsICJNT0Qi\nLCBPUEVOX0JSQUNFLCBlMSwgQ09NTUEsIGUyLCBDTE9TRV9CUkFDRSk7CiAg\nICAgICAgfSAgICAgICAgCiAgICB9CgogICAgcHVibGljIHN0YXRpYyBjbGFz\ncyBDdXJyZW50RGF0ZSBleHRlbmRzIEV4cHJlc3Npb25JbXBsPGphdmEuc3Fs\nLkRhdGU+IHsKICAgICAgICBwdWJsaWMgIEN1cnJlbnREYXRlKCkgewogICAg\nICAgICAgICBzdXBlcihqYXZhLnNxbC5EYXRlLmNsYXNzKTsKICAgICAgICB9\nCgogICAgICAgIEBPdmVycmlkZQogICAgICAgIHB1YmxpYyBWYWx1ZSB0b1Zh\nbHVlKEV4cHJlc3Npb25GYWN0b3J5IGZhY3RvcnksIENyaXRlcmlhUXVlcnlJ\nbXBsPD8+IHEpIHsKICAgICAgICAgICAgcmV0dXJuIGZhY3RvcnkuZ2V0Q3Vy\ncmVudERhdGUoKTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgQE92ZXJy\naWRlCiAgICAgICAgcHVibGljIFN0cmluZ0J1aWxkZXIgYXNWYWx1ZShBbGlh\nc0NvbnRleHQgcSkgewogICAgICAgICAgICByZXR1cm4gbmV3IFN0cmluZ0J1\naWxkZXIoIkNVUlJFTlRfREFURSIpOwogICAgICAgIH0KICAgIH0KICAgIAog\nICAgcHVibGljIHN0YXRpYyBjbGFzcyBDdXJyZW50VGltZSBleHRlbmRzIEV4\ncHJlc3Npb25JbXBsPGphdmEuc3FsLlRpbWU+IHsKICAgICAgICBwdWJsaWMg\nIEN1cnJlbnRUaW1lKCkgewogICAgICAgICAgICBzdXBlcihqYXZhLnNxbC5U\naW1lLmNsYXNzKTsKICAgICAgICB9CgogICAgICAgIEBPdmVycmlkZQogICAg\nICAgIHB1YmxpYyBWYWx1ZSB0b1ZhbHVlKEV4cHJlc3Npb25GYWN0b3J5IGZh\nY3RvcnksIENyaXRlcmlhUXVlcnlJbXBsPD8+IHEpIHsKICAgICAgICAgICAg\ncmV0dXJuIGZhY3RvcnkuZ2V0Q3VycmVudFRpbWUoKTsKICAgICAgICB9CiAg\nICAgICAgCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgcHVibGljIFN0cmlu\nZ0J1aWxkZXIgYXNWYWx1ZShBbGlhc0NvbnRleHQgcSkgewogICAgICAgICAg\nICByZXR1cm4gbmV3IFN0cmluZ0J1aWxkZXIoIkNVUlJFTlRfVElNRSIpOwog\nICAgICAgIH0KICAgIH0KICAgIAogICAgcHVibGljIHN0YXRpYyBjbGFzcyBD\ndXJyZW50VGltZXN0YW1wIGV4dGVuZHMgRXhwcmVzc2lvbkltcGw8amF2YS5z\ncWwuVGltZXN0YW1wPiB7CiAgICAgICAgcHVibGljICBDdXJyZW50VGltZXN0\nYW1wKCkgewogICAgICAgICAgICBzdXBlcihqYXZhLnNxbC5UaW1lc3RhbXAu\nY2xhc3MpOwogICAgICAgIH0KCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAg\ncHVibGljIFZhbHVlIHRvVmFsdWUoRXhwcmVzc2lvbkZhY3RvcnkgZmFjdG9y\neSwgQ3JpdGVyaWFRdWVyeUltcGw8Pz4gcSkgewogICAgICAgICAgICByZXR1\ncm4gZmFjdG9yeS5nZXRDdXJyZW50VGltZXN0YW1wKCk7CiAgICAgICAgfQog\nICAgICAgIAogICAgICAgIEBPdmVycmlkZQogICAgICAgIHB1YmxpYyBTdHJp\nbmdCdWlsZGVyIGFzVmFsdWUoQWxpYXNDb250ZXh0IHEpIHsKICAgICAgICAg\nICAgcmV0dXJuIG5ldyBTdHJpbmdCdWlsZGVyKCJDVVJSRU5UX1RJTUVTVEFN\nUCIpOwogICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMgc3RhdGljIGNsYXNz\nIEVxdWFsIGV4dGVuZHMgQmluYXJ5TG9naWNhbEV4cHJlc3Npb24gewogICAg\nICAgIHB1YmxpYyA8WCxZPiBFcXVhbChFeHByZXNzaW9uPFg+IHgsIEV4cHJl\nc3Npb248WT4geSkgewogICAgICAgICAgICBzdXBlcih4LHkpOwogICAgICAg\nIH0KICAgICAgICAKICAgICAgICBwdWJsaWMgPFg+IEVxdWFsKEV4cHJlc3Np\nb248WD4geCwgT2JqZWN0IHkpIHsKICAgICAgICAgICAgdGhpcyh4LCBuZXcg\nQ29uc3RhbnQoeSkpOwogICAgICAgIH0KCiAgICAgICAgQE92ZXJyaWRlCiAg\nICAgICAgcHVibGljIFByZWRpY2F0ZUltcGwgbmVnYXRlKCkgewogICAgICAg\nICAgICByZXR1cm4gbmV3IE5vdEVxdWFsKGUxLCBlMikubWFya05lZ2F0ZWQo\nKTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgQE92ZXJyaWRlCiAgICAg\nICAgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5leHBzLkV4cHJlc3Npb24g\ndG9LZXJuZWxFeHByZXNzaW9uKEV4cHJlc3Npb25GYWN0b3J5IGZhY3Rvcnks\nIENyaXRlcmlhUXVlcnlJbXBsPD8+IHEpewogICAgICAgICAgICBWYWx1ZSB2\nYWwxID0gRXhwcmVzc2lvbnMudG9WYWx1ZShlMSwgZmFjdG9yeSwgcSk7CiAg\nICAgICAgICAgIFZhbHVlIHZhbDIgPSBFeHByZXNzaW9ucy50b1ZhbHVlKGUy\nLCBmYWN0b3J5LCBxKTsKICAgICAgICAgICAgRXhwcmVzc2lvbnMuc2V0SW1w\nbGljaXRUeXBlcyh2YWwxLCB2YWwyLCBlMS5nZXRKYXZhVHlwZSgpLCBxKTsK\nICAgICAgICAgICAgcmV0dXJuIGZhY3RvcnkuZXF1YWwodmFsMSwgdmFsMik7\nCiAgICAgICAgfQogICAgICAgIAogICAgICAgIEBPdmVycmlkZQogICAgICAg\nIHB1YmxpYyBTdHJpbmdCdWlsZGVyIGFzVmFsdWUoQWxpYXNDb250ZXh0IHEp\nIHsKICAgICAgICAgICAgcmV0dXJuIEV4cHJlc3Npb25zLmFzVmFsdWUocSwg\nZTEsICIgPSAiLCBlMik7CiAgICAgICAgfSAgICAgICAgCiAgICB9CiAgICAK\nICAgIHB1YmxpYyBzdGF0aWMgY2xhc3MgTm90RXF1YWwgZXh0ZW5kcyBCaW5h\ncnlMb2dpY2FsRXhwcmVzc2lvbiB7CiAgICAgICAgcHVibGljIDxYLFk+IE5v\ndEVxdWFsKEV4cHJlc3Npb248WD4geCwgRXhwcmVzc2lvbjxZPiB5KSB7CiAg\nICAgICAgICAgIHN1cGVyKHgseSk7CiAgICAgICAgfQogICAgICAgIAogICAg\nICAgIHB1YmxpYyA8WD4gTm90RXF1YWwoRXhwcmVzc2lvbjxYPiB4LCBPYmpl\nY3QgeSkgewogICAgICAgICAgICB0aGlzKHgsIG5ldyBDb25zdGFudCh5KSk7\nCiAgICAgICAgfQogICAgICAgIAogICAgICAgIEBPdmVycmlkZQogICAgICAg\nIHB1YmxpYyBQcmVkaWNhdGVJbXBsIG5lZ2F0ZSgpIHsKICAgICAgICAgICAg\ncmV0dXJuIG5ldyBFcXVhbChlMSwgZTIpLm1hcmtOZWdhdGVkKCk7CiAgICAg\nICAgfQogICAgICAgIAogICAgICAgIEBPdmVycmlkZQogICAgICAgIG9yZy5h\ncGFjaGUub3BlbmpwYS5rZXJuZWwuZXhwcy5FeHByZXNzaW9uIHRvS2VybmVs\nRXhwcmVzc2lvbihFeHByZXNzaW9uRmFjdG9yeSBmYWN0b3J5LCBDcml0ZXJp\nYVF1ZXJ5SW1wbDw/PiBxKXsKICAgICAgICAgICAgVmFsdWUgdmFsMSA9IEV4\ncHJlc3Npb25zLnRvVmFsdWUoZTEsIGZhY3RvcnksIHEpOwogICAgICAgICAg\nICBWYWx1ZSB2YWwyID0gRXhwcmVzc2lvbnMudG9WYWx1ZShlMiwgZmFjdG9y\neSwgcSk7CiAgICAgICAgICAgIEV4cHJlc3Npb25zLnNldEltcGxpY2l0VHlw\nZXModmFsMSwgdmFsMiwgZTEuZ2V0SmF2YVR5cGUoKSwgcSk7CiAgICAgICAg\nICAgIHJldHVybiBmYWN0b3J5Lm5vdEVxdWFsKHZhbDEsIHZhbDIpOwogICAg\nICAgIH0KICAgICAgICAKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBwdWJs\naWMgU3RyaW5nQnVpbGRlciBhc1ZhbHVlKEFsaWFzQ29udGV4dCBxKSB7CiAg\nICAgICAgICAgIHJldHVybiBFeHByZXNzaW9ucy5hc1ZhbHVlKHEsIGUxLCAi\nIDw+ICIsIGUyKTsKICAgICAgICB9ICAgICAgICAKICAgIH0KICAgIAogICAg\ncHVibGljIHN0YXRpYyBjbGFzcyBHcmVhdGVyVGhhbiBleHRlbmRzIEJpbmFy\neUxvZ2ljYWxFeHByZXNzaW9uIHsKICAgICAgICBwdWJsaWMgPFgsWT4gR3Jl\nYXRlclRoYW4oRXhwcmVzc2lvbjxYPiB4LCBFeHByZXNzaW9uPFk+IHkpIHsK\nICAgICAgICAgICAgc3VwZXIoeCx5KTsKICAgICAgICB9CiAgICAgICAgCiAg\nICAgICAgcHVibGljIDxYPiBHcmVhdGVyVGhhbihFeHByZXNzaW9uPFg+IHgs\nIE9iamVjdCB5KSB7CiAgICAgICAgICAgIHRoaXMoeCwgbmV3IENvbnN0YW50\nKHkpKTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgQE92ZXJyaWRlCiAg\nICAgICAgcHVibGljIFByZWRpY2F0ZUltcGwgbmVnYXRlKCkgewogICAgICAg\nICAgICByZXR1cm4gbmV3IExlc3NUaGFuRXF1YWwoZTEsIGUyKS5tYXJrTmVn\nYXRlZCgpOwogICAgICAgIH0KICAgICAgICAKICAgICAgICBAT3ZlcnJpZGUK\nICAgICAgICBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLmV4cHMuRXhwcmVz\nc2lvbiB0b0tlcm5lbEV4cHJlc3Npb24oRXhwcmVzc2lvbkZhY3RvcnkgZmFj\ndG9yeSwgQ3JpdGVyaWFRdWVyeUltcGw8Pz4gcSl7CiAgICAgICAgICAgIFZh\nbHVlIHZhbDEgPSBFeHByZXNzaW9ucy50b1ZhbHVlKGUxLCBmYWN0b3J5LCBx\nKTsKICAgICAgICAgICAgVmFsdWUgdmFsMiA9IEV4cHJlc3Npb25zLnRvVmFs\ndWUoZTIsIGZhY3RvcnksIHEpOyAKICAgICAgICAgICAgRXhwcmVzc2lvbnMu\nc2V0SW1wbGljaXRUeXBlcyh2YWwxLCB2YWwyLCBlMS5nZXRKYXZhVHlwZSgp\nLCBxKTsgCiAgICAgICAgICAgIHJldHVybiBmYWN0b3J5LmdyZWF0ZXJUaGFu\nKHZhbDEsIHZhbDIpOwogICAgICAgIH0KICAgICAgICAKICAgICAgICBAT3Zl\ncnJpZGUKICAgICAgICBwdWJsaWMgU3RyaW5nQnVpbGRlciBhc1ZhbHVlKEFs\naWFzQ29udGV4dCBxKSB7CiAgICAgICAgICAgIHJldHVybiBFeHByZXNzaW9u\ncy5hc1ZhbHVlKHEsIGUxLCAiID4gIiwgZTIpOwogICAgICAgIH0gICAgICAg\nIAogICAgfQogICAgCiAgICBwdWJsaWMgc3RhdGljIGNsYXNzIEdyZWF0ZXJU\naGFuRXF1YWwgZXh0ZW5kcyBCaW5hcnlMb2dpY2FsRXhwcmVzc2lvbiB7CiAg\nICAgICAgcHVibGljIDxYLFk+IEdyZWF0ZXJUaGFuRXF1YWwoRXhwcmVzc2lv\nbjxYPiB4LCBFeHByZXNzaW9uPFk+IHkpIHsKICAgICAgICAgICAgc3VwZXIo\neCx5KTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgcHVibGljIDxYPiBH\ncmVhdGVyVGhhbkVxdWFsKEV4cHJlc3Npb248WD4geCwgT2JqZWN0IHkpIHsK\nICAgICAgICAgICAgdGhpcyh4LCBuZXcgQ29uc3RhbnQoeSkpOwogICAgICAg\nIH0KICAgICAgICAKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBwdWJsaWMg\nUHJlZGljYXRlSW1wbCBuZWdhdGUoKSB7CiAgICAgICAgICAgIHJldHVybiBu\nZXcgTGVzc1RoYW4oZTEsIGUyKS5tYXJrTmVnYXRlZCgpOwogICAgICAgIH0K\nICAgICAgICAKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBvcmcuYXBhY2hl\nLm9wZW5qcGEua2VybmVsLmV4cHMuRXhwcmVzc2lvbiB0b0tlcm5lbEV4cHJl\nc3Npb24oRXhwcmVzc2lvbkZhY3RvcnkgZmFjdG9yeSwgQ3JpdGVyaWFRdWVy\neUltcGw8Pz4gcSl7CiAgICAgICAgICAgIFZhbHVlIHZhbDEgPSBFeHByZXNz\naW9ucy50b1ZhbHVlKGUxLCBmYWN0b3J5LCBxKTsKICAgICAgICAgICAgVmFs\ndWUgdmFsMiA9IEV4cHJlc3Npb25zLnRvVmFsdWUoZTIsIGZhY3RvcnksIHEp\nOyAKICAgICAgICAgICAgRXhwcmVzc2lvbnMuc2V0SW1wbGljaXRUeXBlcyh2\nYWwxLCB2YWwyLCBlMS5nZXRKYXZhVHlwZSgpLCBxKTsgCiAgICAgICAgICAg\nIHJldHVybiBmYWN0b3J5LmdyZWF0ZXJUaGFuRXF1YWwodmFsMSwgdmFsMik7\nCiAgICAgICAgfQogICAgICAgIAogICAgICAgIEBPdmVycmlkZQogICAgICAg\nIHB1YmxpYyBTdHJpbmdCdWlsZGVyIGFzVmFsdWUoQWxpYXNDb250ZXh0IHEp\nIHsKICAgICAgICAgICAgcmV0dXJuIEV4cHJlc3Npb25zLmFzVmFsdWUocSwg\nZTEsICIgPj0gIiwgZTIpOwogICAgICAgIH0gICAgICAgIAogICAgfQogICAK\nICAgIHB1YmxpYyBzdGF0aWMgY2xhc3MgTGVzc1RoYW4gZXh0ZW5kcyBCaW5h\ncnlMb2dpY2FsRXhwcmVzc2lvbiB7CiAgICAgICAgcHVibGljIDxYLFk+IExl\nc3NUaGFuKEV4cHJlc3Npb248WD4geCwgRXhwcmVzc2lvbjxZPiB5KSB7CiAg\nICAgICAgICAgIHN1cGVyKHgseSk7CiAgICAgICAgfQogICAgICAgIAogICAg\nICAgIHB1YmxpYyA8WD4gTGVzc1RoYW4oRXhwcmVzc2lvbjxYPiB4LCBPYmpl\nY3QgeSkgewogICAgICAgICAgICB0aGlzKHgsIG5ldyBDb25zdGFudCh5KSk7\nCiAgICAgICAgfQogICAgICAgIAogICAgICAgIEBPdmVycmlkZQogICAgICAg\nIHB1YmxpYyBQcmVkaWNhdGVJbXBsIG5lZ2F0ZSgpIHsKICAgICAgICAgICAg\ncmV0dXJuIG5ldyBHcmVhdGVyVGhhbkVxdWFsKGUxLCBlMikubWFya05lZ2F0\nZWQoKTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgQE92ZXJyaWRlCiAg\nICAgICAgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5leHBzLkV4cHJlc3Np\nb24gdG9LZXJuZWxFeHByZXNzaW9uKEV4cHJlc3Npb25GYWN0b3J5IGZhY3Rv\ncnksIENyaXRlcmlhUXVlcnlJbXBsPD8+IHEpewogICAgICAgICAgICBWYWx1\nZSB2YWwxID0gRXhwcmVzc2lvbnMudG9WYWx1ZShlMSwgZmFjdG9yeSwgcSk7\nCiAgICAgICAgICAgIFZhbHVlIHZhbDIgPSBFeHByZXNzaW9ucy50b1ZhbHVl\nKGUyLCBmYWN0b3J5LCBxKTsgCiAgICAgICAgICAgIEV4cHJlc3Npb25zLnNl\ndEltcGxpY2l0VHlwZXModmFsMSwgdmFsMiwgZTEuZ2V0SmF2YVR5cGUoKSwg\ncSk7IAogICAgICAgICAgICByZXR1cm4gZmFjdG9yeS5sZXNzVGhhbih2YWwx\nLCB2YWwyKTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgQE92ZXJyaWRl\nCiAgICAgICAgcHVibGljIFN0cmluZ0J1aWxkZXIgYXNWYWx1ZShBbGlhc0Nv\nbnRleHQgcSkgewogICAgICAgICAgICByZXR1cm4gRXhwcmVzc2lvbnMuYXNW\nYWx1ZShxLCBlMSwgIiA8ICIsIGUyKTsKICAgICAgICB9ICAgICAgICAKICAg\nIH0KICAgIAogICAgcHVibGljIHN0YXRpYyBjbGFzcyBMZXNzVGhhbkVxdWFs\nIGV4dGVuZHMgQmluYXJ5TG9naWNhbEV4cHJlc3Npb24gewogICAgICAgIHB1\nYmxpYyA8WCxZPiBMZXNzVGhhbkVxdWFsKEV4cHJlc3Npb248WD4geCwgRXhw\ncmVzc2lvbjxZPiB5KSB7CiAgICAgICAgICAgIHN1cGVyKHgseSk7CiAgICAg\nICAgfQogICAgICAgIAogICAgICAgIHB1YmxpYyA8WD4gTGVzc1RoYW5FcXVh\nbChFeHByZXNzaW9uPFg+IHgsIE9iamVjdCB5KSB7CiAgICAgICAgICAgIHRo\naXMoeCwgbmV3IENvbnN0YW50KHkpKTsKICAgICAgICB9CiAgICAgICAgCiAg\nICAgICAgQE92ZXJyaWRlCiAgICAgICAgcHVibGljIFByZWRpY2F0ZUltcGwg\nbmVnYXRlKCkgewogICAgICAgICAgICByZXR1cm4gbmV3IEdyZWF0ZXJUaGFu\nKGUxLCBlMikubWFya05lZ2F0ZWQoKTsKICAgICAgICB9CiAgICAgICAgCiAg\nICAgICAgQE92ZXJyaWRlCiAgICAgICAgb3JnLmFwYWNoZS5vcGVuanBhLmtl\ncm5lbC5leHBzLkV4cHJlc3Npb24gdG9LZXJuZWxFeHByZXNzaW9uKEV4cHJl\nc3Npb25GYWN0b3J5IGZhY3RvcnksIENyaXRlcmlhUXVlcnlJbXBsPD8+IHEp\newogICAgICAgICAgICBWYWx1ZSB2YWwxID0gRXhwcmVzc2lvbnMudG9WYWx1\nZShlMSwgZmFjdG9yeSwgcSk7CiAgICAgICAgICAgIFZhbHVlIHZhbDIgPSBF\neHByZXNzaW9ucy50b1ZhbHVlKGUyLCBmYWN0b3J5LCBxKTsgCiAgICAgICAg\nICAgIEV4cHJlc3Npb25zLnNldEltcGxpY2l0VHlwZXModmFsMSwgdmFsMiwg\nZTEuZ2V0SmF2YVR5cGUoKSwgcSk7IAogICAgICAgICAgICByZXR1cm4gZmFj\ndG9yeS5sZXNzVGhhbkVxdWFsKHZhbDEsIHZhbDIpOwogICAgICAgIH0KICAg\nICAgICAKICAgICAgICAKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBwdWJs\naWMgU3RyaW5nQnVpbGRlciBhc1ZhbHVlKEFsaWFzQ29udGV4dCBxKSB7CiAg\nICAgICAgICAgIHJldHVybiBFeHByZXNzaW9ucy5hc1ZhbHVlKHEsIGUxLCAi\nIDw9ICIsIGUyKTsKICAgICAgICB9ICAgICAgICAKICAgIH0KCiAgICBwdWJs\naWMgc3RhdGljIGNsYXNzIEJldHdlZW48WSBleHRlbmRzIENvbXBhcmFibGU8\nWT4+IGV4dGVuZHMgUHJlZGljYXRlSW1wbC5BbmQgewogICAgICAgIHByaXZh\ndGUgZmluYWwgRXhwcmVzc2lvbkltcGw8PyBleHRlbmRzIFk+IGU7CiAgICAg\nICAgcHJpdmF0ZSBmaW5hbCBFeHByZXNzaW9uSW1wbDw/IGV4dGVuZHMgWT4g\ndjE7CiAgICAgICAgcHJpdmF0ZSBmaW5hbCBFeHByZXNzaW9uSW1wbDw/IGV4\ndGVuZHMgWT4gdjI7CiAgICAgICAgCiAgICAgICAgcHVibGljIEJldHdlZW4o\nRXhwcmVzc2lvbjw/IGV4dGVuZHMgWT4gdiwgRXhwcmVzc2lvbjw/IGV4dGVu\nZHMgWT4geCwgRXhwcmVzc2lvbjw/IGV4dGVuZHMgWT4geSkgewogICAgICAg\nICAgICBzdXBlcihuZXcgR3JlYXRlclRoYW5FcXVhbCh2LHgpLCBuZXcgTGVz\nc1RoYW5FcXVhbCh2LHkpKTsKICAgICAgICAgICAgZSA9IChFeHByZXNzaW9u\nSW1wbDw/IGV4dGVuZHMgWT4pdjsKICAgICAgICAgICAgdjEgPSAoRXhwcmVz\nc2lvbkltcGw8PyBleHRlbmRzIFk+KXg7CiAgICAgICAgICAgIHYyID0gKEV4\ncHJlc3Npb25JbXBsPD8gZXh0ZW5kcyBZPil5OwogICAgICAgIH0KICAgICAg\nICAKICAgICAgICBwdWJsaWMgQmV0d2VlbihFeHByZXNzaW9uPD8gZXh0ZW5k\ncyBZPiB2LCBZIHgsIFkgeSkgewogICAgICAgICAgICB0aGlzKHYsIG5ldyBD\nb25zdGFudDxZPih4KSwgbmV3IENvbnN0YW50PFk+KHkpKTsKICAgICAgICB9\nCiAgICAgICAgCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgcHVibGljIFN0\ncmluZ0J1aWxkZXIgYXNWYWx1ZShBbGlhc0NvbnRleHQgcSkgewogICAgICAg\nICAgICByZXR1cm4gRXhwcmVzc2lvbnMuYXNWYWx1ZShxLCBlLCAiIEJFVFdF\nRU4gIiwgdjEsICIgQU5EICIsIHYyKTsKICAgICAgICB9CiAgICB9CiAgICAK\nICAgIHB1YmxpYyBzdGF0aWMgY2xhc3MgQ29uc3RhbnQ8WD4gZXh0ZW5kcyBF\neHByZXNzaW9uSW1wbDxYPiB7CiAgICAgICAgcHVibGljIGZpbmFsIE9iamVj\ndCBhcmc7CiAgICAgICAgcHVibGljIENvbnN0YW50KENsYXNzPFg+IHQsIFgg\neCkgewogICAgICAgICAgICBzdXBlcih0KTsKICAgICAgICAgICAgdGhpcy5h\ncmcgPSB4OwogICAgICAgIH0KICAgICAgICAKICAgICAgICBwdWJsaWMgQ29u\nc3RhbnQoWCB4KSB7CiAgICAgICAgICAgIHRoaXMoeCA9PSBudWxsID8gbnVs\nbCA6IChDbGFzczxYPil4LmdldENsYXNzKCksIHgpOwogICAgICAgIH0KICAg\nICAgICAKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBwdWJsaWMgVmFsdWUg\ndG9WYWx1ZShFeHByZXNzaW9uRmFjdG9yeSBmYWN0b3J5LCBDcml0ZXJpYVF1\nZXJ5SW1wbDw/PiBxKSB7CiAgICAgICAgICAgIE9iamVjdCB2YWx1ZSA9IGFy\nZzsKICAgICAgICAgICAgQ2xhc3M8Pz4gbGl0ZXJhbENsYXNzID0gZ2V0SmF2\nYVR5cGUoKTsKICAgICAgICAgICAgaWYgKGFyZyBpbnN0YW5jZW9mIFBhcmFt\nZXRlckV4cHJlc3Npb25JbXBsKSB7CiAgICAgICAgICAgICAgICByZXR1cm4g\nKChQYXJhbWV0ZXJFeHByZXNzaW9uSW1wbClhcmcpLnRvVmFsdWUoZmFjdG9y\neSwgcSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaW50IGxpdGVyYWxU\neXBlID0gTGl0ZXJhbC5UWVBFX1VOS05PV047CiAgICAgICAgICAgIGlmIChO\ndW1iZXIuY2xhc3MuaXNBc3NpZ25hYmxlRnJvbShsaXRlcmFsQ2xhc3MpKSB7\nCiAgICAgICAgICAgICAgICBsaXRlcmFsVHlwZSA9IExpdGVyYWwuVFlQRV9O\nVU1CRVI7CiAgICAgICAgICAgIH0gZWxzZSBpZiAoQm9vbGVhbi5jbGFzcy5p\nc0Fzc2lnbmFibGVGcm9tKGxpdGVyYWxDbGFzcykpIHsKICAgICAgICAgICAg\nICAgIGxpdGVyYWxUeXBlID0gTGl0ZXJhbC5UWVBFX0JPT0xFQU47CiAgICAg\nICAgICAgIH0gZWxzZSBpZiAoU3RyaW5nLmNsYXNzLmlzQXNzaWduYWJsZUZy\nb20obGl0ZXJhbENsYXNzKSkgewogICAgICAgICAgICAgICAgbGl0ZXJhbFR5\ncGUgPSBMaXRlcmFsLlRZUEVfU1RSSU5HOwogICAgICAgICAgICB9IGVsc2Ug\naWYgKEVudW0uY2xhc3MuaXNBc3NpZ25hYmxlRnJvbShsaXRlcmFsQ2xhc3Mp\nKSB7CiAgICAgICAgICAgICAgICBsaXRlcmFsVHlwZSA9IExpdGVyYWwuVFlQ\nRV9FTlVNOwogICAgICAgICAgICB9IGVsc2UgaWYgKENsYXNzLmNsYXNzLmlz\nQXNzaWduYWJsZUZyb20obGl0ZXJhbENsYXNzKSkgewogICAgICAgICAgICAg\nICAgbGl0ZXJhbFR5cGUgPSBMaXRlcmFsLlRZUEVfQ0xBU1M7CiAgICAgICAg\nICAgICAgICBMaXRlcmFsIGxpdCA9IGZhY3RvcnkubmV3VHlwZUxpdGVyYWwo\ndmFsdWUsIExpdGVyYWwuVFlQRV9DTEFTUyk7CiAgICAgICAgICAgICAgICBD\nbGFzc01ldGFEYXRhIGNhbiA9ICgoVHlwZXMuRW50aXR5PFg+KXEuZ2V0Um9v\ndCgpLmdldE1vZGVsKCkpLm1ldGE7CiAgICAgICAgICAgICAgICBDbGFzczw/\nPiBjYW5kaWRhdGUgPSBjYW4uZ2V0RGVzY3JpYmVkVHlwZSgpOwogICAgICAg\nICAgICAgICAgaWYgKGNhbmRpZGF0ZS5pc0Fzc2lnbmFibGVGcm9tKChDbGFz\ncyl2YWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgIGxpdC5zZXRNZXRhRGF0\nYShxLmdldE1ldGFtb2RlbCgpLmdldFJlcG9zaXRvcnkoKS5nZXRNZXRhRGF0\nYSgoQ2xhc3M8Pz4pdmFsdWUsIG51bGwsIHRydWUpKTsKICAgICAgICAgICAg\nICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgbGl0LnNldE1ldGFE\nYXRhKGNhbik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBy\nZXR1cm4gbGl0OwogICAgICAgICAgICB9IGVsc2UgaWYgKENvbGxlY3Rpb24u\nY2xhc3MuaXNBc3NpZ25hYmxlRnJvbShsaXRlcmFsQ2xhc3MpKSB7CiAgICAg\nICAgICAgICAgICBsaXRlcmFsVHlwZSA9IExpdGVyYWwuVFlQRV9DT0xMRUNU\nSU9OOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiBmYWN0b3J5\nLm5ld0xpdGVyYWwodmFsdWUsIGxpdGVyYWxUeXBlKTsKICAgICAgICB9CiAg\nICAgICAgCiAgICAgICAgcHVibGljIHZvaWQgYWNjZXB0VmlzaXQoQ3JpdGVy\naWFFeHByZXNzaW9uVmlzaXRvciB2aXNpdG9yKSB7CiAgICAgICAgICAgIEV4\ncHJlc3Npb25zLmFjY2VwdFZpc2l0KHZpc2l0b3IsIHRoaXMsIGFyZyBpbnN0\nYW5jZW9mIEV4cHJlc3Npb24gPyAoKEV4cHJlc3Npb24pYXJnKSA6IG51bGwp\nOwogICAgICAgIH0KICAgICAgICAKICAgICAgICBwdWJsaWMgU3RyaW5nQnVp\nbGRlciBhc1ZhbHVlKEFsaWFzQ29udGV4dCBxKSB7CiAgICAgICAgICAgIGlm\nIChhcmcgPT0gbnVsbCkKICAgICAgICAgICAgICAgIHJldHVybiBuZXcgU3Ry\naW5nQnVpbGRlcigiTlVMTCIpOwogICAgICAgICAgICBDbGFzczw/PiBsaXRl\ncmFsQ2xhc3MgPSBnZXRKYXZhVHlwZSgpOwogICAgICAgICAgICBpZiAoYXJn\nIGluc3RhbmNlb2YgUGFyYW1ldGVyRXhwcmVzc2lvbkltcGwpIHsKICAgICAg\nICAgICAgICAgIHJldHVybiAoKFBhcmFtZXRlckV4cHJlc3Npb25JbXBsPD8+\nKWFyZykuYXNWYWx1ZShxKTsKICAgICAgICAgICAgfSBlbHNlIGlmIChOdW1i\nZXIuY2xhc3MuaXNBc3NpZ25hYmxlRnJvbShsaXRlcmFsQ2xhc3MpKSB7CiAg\nICAgICAgICAgICAgICByZXR1cm4gbmV3IFN0cmluZ0J1aWxkZXIoYXJnLnRv\nU3RyaW5nKCkpOwogICAgICAgICAgICB9IGVsc2UgaWYgKEJvb2xlYW4uY2xh\nc3MuaXNBc3NpZ25hYmxlRnJvbShsaXRlcmFsQ2xhc3MpKSB7CiAgICAgICAg\nICAgICAgICByZXR1cm4gbmV3IFN0cmluZ0J1aWxkZXIoYXJnLnRvU3RyaW5n\nKCkpOwogICAgICAgICAgICB9IGVsc2UgaWYgKFN0cmluZy5jbGFzcy5pc0Fz\nc2lnbmFibGVGcm9tKGxpdGVyYWxDbGFzcykpIHsKICAgICAgICAgICAgICAg\nIHJldHVybiBuZXcgU3RyaW5nQnVpbGRlcigiJyIpLmFwcGVuZChhcmcudG9T\ndHJpbmcoKSkuYXBwZW5kKCInIik7CiAgICAgICAgICAgIH0gZWxzZSBpZiAo\nRW51bS5jbGFzcy5pc0Fzc2lnbmFibGVGcm9tKGxpdGVyYWxDbGFzcykpIHsK\nICAgICAgICAgICAgICAgIHJldHVybiBuZXcgU3RyaW5nQnVpbGRlcihhcmcu\ndG9TdHJpbmcoKSk7CiAgICAgICAgICAgIH0gZWxzZSBpZiAoQ2xhc3MuY2xh\nc3MuaXNBc3NpZ25hYmxlRnJvbShsaXRlcmFsQ2xhc3MpKSB7CiAgICAgICAg\nICAgICAgICByZXR1cm4gbmV3IFN0cmluZ0J1aWxkZXIoKChDbGFzcylhcmcp\nLmdldFNpbXBsZU5hbWUoKSk7CiAgICAgICAgICAgIH0gZWxzZSBpZiAoQ29s\nbGVjdGlvbi5jbGFzcy5pc0Fzc2lnbmFibGVGcm9tKGxpdGVyYWxDbGFzcykp\nIHsKICAgICAgICAgICAgICAgIHJldHVybiBuZXcgU3RyaW5nQnVpbGRlcigo\nKENvbGxlY3Rpb24pYXJnKS50b1N0cmluZygpKTsKICAgICAgICAgICAgfQog\nICAgICAgICAgICByZXR1cm4gbmV3IFN0cmluZ0J1aWxkZXIoYXJnLnRvU3Ry\naW5nKCkpOwogICAgICAgIH0KICAgIH0KICAgIAogICAgcHVibGljIHN0YXRp\nYyBjbGFzcyBJc0VtcHR5IGV4dGVuZHMgUHJlZGljYXRlSW1wbCB7CiAgICAg\nICAgZmluYWwgRXhwcmVzc2lvbkltcGw8Pz4gY29sbGVjdGlvbjsKICAgICAg\nICBwdWJsaWMgSXNFbXB0eShFeHByZXNzaW9uPD8+IGNvbGxlY3Rpb24pIHsK\nICAgICAgICAgICAgc3VwZXIoKTsKICAgICAgICAgICAgdGhpcy5jb2xsZWN0\naW9uID0gKEV4cHJlc3Npb25JbXBsPD8+KWNvbGxlY3Rpb247CiAgICAgICAg\nfQogICAgICAgIAogICAgICAgIEBPdmVycmlkZQogICAgICAgIHB1YmxpYyBQ\ncmVkaWNhdGVJbXBsIG5lZ2F0ZSgpIHsKICAgICAgICAgICAgcmV0dXJuIG5l\ndyBJc05vdEVtcHR5KGNvbGxlY3Rpb24pLm1hcmtOZWdhdGVkKCk7CiAgICAg\nICAgfQogICAgICAgIAogICAgICAgIEBPdmVycmlkZQogICAgICAgIFZhbHVl\nIHRvVmFsdWUoRXhwcmVzc2lvbkZhY3RvcnkgZmFjdG9yeSwgQ3JpdGVyaWFR\ndWVyeUltcGw8Pz4gcSkgewogICAgICAgICAgICByZXR1cm4gRXhwcmVzc2lv\nbnMudG9WYWx1ZShjb2xsZWN0aW9uLCBmYWN0b3J5LCBxKTsKICAgICAgICB9\nCiAgICAgICAgCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgb3JnLmFwYWNo\nZS5vcGVuanBhLmtlcm5lbC5leHBzLkV4cHJlc3Npb24gdG9LZXJuZWxFeHBy\nZXNzaW9uKEV4cHJlc3Npb25GYWN0b3J5IGZhY3RvcnksIENyaXRlcmlhUXVl\ncnlJbXBsPD8+IHEpewogICAgICAgICAgICBWYWx1ZSB2YWwgPSBFeHByZXNz\naW9ucy50b1ZhbHVlKGNvbGxlY3Rpb24sIGZhY3RvcnksIHEpOwogICAgICAg\nICAgICByZXR1cm4gZmFjdG9yeS5pc0VtcHR5KHZhbCk7CiAgICAgICAgfQog\nICAgICAgIAogICAgICAgIHB1YmxpYyB2b2lkIGFjY2VwdFZpc2l0KENyaXRl\ncmlhRXhwcmVzc2lvblZpc2l0b3IgdmlzaXRvcikgewogICAgICAgICAgICBz\ndXBlci5hY2NlcHRWaXNpdCh2aXNpdG9yKTsKICAgICAgICAgICAgRXhwcmVz\nc2lvbnMuYWNjZXB0VmlzaXQodmlzaXRvciwgY29sbGVjdGlvbik7CiAgICAg\nICAgfQogICAgICAgIAogICAgICAgIEBPdmVycmlkZQogICAgICAgIHB1Ymxp\nYyBTdHJpbmdCdWlsZGVyIGFzVmFsdWUoQWxpYXNDb250ZXh0IHEpIHsKICAg\nICAgICAgICAgcmV0dXJuIEV4cHJlc3Npb25zLmFzVmFsdWUocSwgY29sbGVj\ndGlvbiwgIiBJUyBFTVBUWSIpOwogICAgICAgIH0KICAgIH0KICAgIAogICAg\ncHVibGljIHN0YXRpYyBjbGFzcyBJc05vdEVtcHR5IGV4dGVuZHMgUHJlZGlj\nYXRlSW1wbCB7CiAgICAgICAgZmluYWwgRXhwcmVzc2lvbkltcGw8Pz4gY29s\nbGVjdGlvbjsKICAgICAgICBwdWJsaWMgSXNOb3RFbXB0eShFeHByZXNzaW9u\nPD8+IGNvbGxlY3Rpb24pIHsKICAgICAgICAgICAgc3VwZXIoKTsKICAgICAg\nICAgICAgdGhpcy5jb2xsZWN0aW9uID0gKEV4cHJlc3Npb25JbXBsPD8+KWNv\nbGxlY3Rpb247CiAgICAgICAgfQogICAgICAgIAogICAgICAgIEBPdmVycmlk\nZQogICAgICAgIHB1YmxpYyBQcmVkaWNhdGVJbXBsIG5lZ2F0ZSgpIHsKICAg\nICAgICAgICAgcmV0dXJuIG5ldyBJc0VtcHR5KGNvbGxlY3Rpb24pLm1hcmtO\nZWdhdGVkKCk7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIEBPdmVycmlk\nZQogICAgICAgIFZhbHVlIHRvVmFsdWUoRXhwcmVzc2lvbkZhY3RvcnkgZmFj\ndG9yeSwgQ3JpdGVyaWFRdWVyeUltcGw8Pz4gcSkgewogICAgICAgICAgICBy\nZXR1cm4gRXhwcmVzc2lvbnMudG9WYWx1ZShjb2xsZWN0aW9uLCBmYWN0b3J5\nLCBxKTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgQE92ZXJyaWRlCiAg\nICAgICAgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5leHBzLkV4cHJlc3Np\nb24gdG9LZXJuZWxFeHByZXNzaW9uKEV4cHJlc3Npb25GYWN0b3J5IGZhY3Rv\ncnksIENyaXRlcmlhUXVlcnlJbXBsPD8+IHEpewogICAgICAgICAgICBWYWx1\nZSB2YWwgPSBFeHByZXNzaW9ucy50b1ZhbHVlKGNvbGxlY3Rpb24sIGZhY3Rv\ncnksIHEpOwogICAgICAgICAgICAvLyBmYWN0b3J5LmlzTm90RW1wdHkoKSBu\nb3QgdXNlZCB0byBtYXRjaCBKUFFMCiAgICAgICAgICAgIHJldHVybiBmYWN0\nb3J5Lm5vdChmYWN0b3J5LmlzRW1wdHkodmFsKSk7CiAgICAgICAgfQogICAg\nICAgIAogICAgICAgIHB1YmxpYyB2b2lkIGFjY2VwdFZpc2l0KENyaXRlcmlh\nRXhwcmVzc2lvblZpc2l0b3IgdmlzaXRvcikgewogICAgICAgICAgICBzdXBl\nci5hY2NlcHRWaXNpdCh2aXNpdG9yKTsKICAgICAgICAgICAgRXhwcmVzc2lv\nbnMuYWNjZXB0VmlzaXQodmlzaXRvciwgY29sbGVjdGlvbik7CiAgICAgICAg\nfQogICAgICAgIAogICAgICAgIEBPdmVycmlkZQogICAgICAgIHB1YmxpYyBT\ndHJpbmdCdWlsZGVyIGFzVmFsdWUoQWxpYXNDb250ZXh0IHEpIHsKICAgICAg\nICAgICAgcmV0dXJuIEV4cHJlc3Npb25zLmFzVmFsdWUocSwgY29sbGVjdGlv\nbiwgIiBJUyBOT1QgRU1QVFkiKTsKICAgICAgICB9CiAgICB9CgogICAgCiAg\nICBwdWJsaWMgc3RhdGljIGNsYXNzIEluZGV4IGV4dGVuZHMgVW5hcnlGdW5j\ndGlvbmFsRXhwcmVzc2lvbjxJbnRlZ2VyPiB7CiAgICAgICAgcHVibGljIElu\nZGV4KEpvaW5zLkxpc3Q8Pyw/PiBlKSB7CiAgICAgICAgICAgIHN1cGVyKElu\ndGVnZXIuY2xhc3MsIGUpOwogICAgICAgIH0KICAgICAgICAKICAgICAgICBA\nT3ZlcnJpZGUKICAgICAgICBwdWJsaWMgb3JnLmFwYWNoZS5vcGVuanBhLmtl\ncm5lbC5leHBzLlZhbHVlIHRvVmFsdWUoRXhwcmVzc2lvbkZhY3RvcnkgZmFj\ndG9yeSwgQ3JpdGVyaWFRdWVyeUltcGw8Pz4gcSkgewogICAgICAgICAgICBW\nYWx1ZSB2ID0gRXhwcmVzc2lvbnMudG9WYWx1ZShlLCBmYWN0b3J5LCBxKTsK\nICAgICAgICAgICAgQ2xhc3NNZXRhRGF0YSBtZXRhID0gKChQYXRoSW1wbDw/\nLD8+KWUpLl9tZW1iZXIuZm1kLmdldEVsZW1lbnQoKS5nZXRUeXBlTWV0YURh\ndGEoKTsKICAgICAgICAgICAgdi5zZXRNZXRhRGF0YShtZXRhKTsKICAgICAg\nICAgICAgcmV0dXJuIGZhY3RvcnkuaW5kZXgodik7CiAgICAgICAgfQogICAg\nICAgIAogICAgICAgIEBPdmVycmlkZQogICAgICAgIHB1YmxpYyBTdHJpbmdC\ndWlsZGVyIGFzVmFsdWUoQWxpYXNDb250ZXh0IHEpIHsKICAgICAgICAgICAg\ncmV0dXJuIEV4cHJlc3Npb25zLmFzVmFsdWUocSwgIklOREVYIiwgT1BFTl9C\nUkFDRSwgZSwgQ0xPU0VfQlJBQ0UpOwogICAgICAgIH0KICAgIH0KICAgIAog\nICAgcHVibGljIHN0YXRpYyBjbGFzcyBJc01lbWJlcjxFPiBleHRlbmRzIFBy\nZWRpY2F0ZUltcGwgewogICAgICAgIGZpbmFsIEV4cHJlc3Npb25JbXBsPEU+\nIGVsZW1lbnQ7CiAgICAgICAgZmluYWwgRXhwcmVzc2lvbkltcGw8Pz4gY29s\nbGVjdGlvbjsKICAgICAgICAKICAgICAgICBwdWJsaWMgSXNNZW1iZXIoRXhw\ncmVzc2lvbjxFPiBlbGVtZW50LCBFeHByZXNzaW9uPD8+IGNvbGxlY3Rpb24p\nIHsKICAgICAgICAgICAgc3VwZXIoKTsKICAgICAgICAgICAgdGhpcy5lbGVt\nZW50ID0gKEV4cHJlc3Npb25JbXBsPEU+KWVsZW1lbnQ7CiAgICAgICAgICAg\nIHRoaXMuY29sbGVjdGlvbiA9IChFeHByZXNzaW9uSW1wbDw/Piljb2xsZWN0\naW9uOwogICAgICAgIH0KICAgICAgICAKICAgICAgICBwdWJsaWMgSXNNZW1i\nZXIoRSBlbGVtZW50LCBFeHByZXNzaW9uPD8+IGNvbGxlY3Rpb24pIHsKICAg\nICAgICAgICAgdGhpcyhuZXcgQ29uc3RhbnQ8RT4oZWxlbWVudCksIGNvbGxl\nY3Rpb24pOwogICAgICAgIH0KICAgICAgICAKICAgICAgICBAT3ZlcnJpZGUK\nICAgICAgICBwdWJsaWMgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5leHBz\nLkV4cHJlc3Npb24gdG9LZXJuZWxFeHByZXNzaW9uKAogICAgICAgICAgICBF\neHByZXNzaW9uRmFjdG9yeSBmYWN0b3J5LCBDcml0ZXJpYVF1ZXJ5SW1wbDw/\nPiBxKSB7CiAgICAgICAgICAgIG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwu\nZXhwcy5FeHByZXNzaW9uIGNvbnRhaW5zID0gZmFjdG9yeS5jb250YWlucygK\nICAgICAgICAgICAgICAgIEV4cHJlc3Npb25zLnRvVmFsdWUoY29sbGVjdGlv\nbiwgZmFjdG9yeSwgcSksIAogICAgICAgICAgICAgICAgRXhwcmVzc2lvbnMu\ndG9WYWx1ZShlbGVtZW50LCBmYWN0b3J5LCBxKSk7CiAgICAgICAgICAgIHJl\ndHVybiBjb250YWluczsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgcHVi\nbGljIHZvaWQgYWNjZXB0VmlzaXQoQ3JpdGVyaWFFeHByZXNzaW9uVmlzaXRv\nciB2aXNpdG9yKSB7CiAgICAgICAgICAgIHN1cGVyLmFjY2VwdFZpc2l0KHZp\nc2l0b3IpOwogICAgICAgICAgICBFeHByZXNzaW9ucy5hY2NlcHRWaXNpdCh2\naXNpdG9yLCBjb2xsZWN0aW9uLCBlbGVtZW50KTsKICAgICAgICB9CiAgICAg\nICAgCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgcHVibGljIFN0cmluZ0J1\naWxkZXIgYXNWYWx1ZShBbGlhc0NvbnRleHQgcSkgewogICAgICAgICAgICBy\nZXR1cm4gRXhwcmVzc2lvbnMuYXNWYWx1ZShxLCBlbGVtZW50LCAiTUVNQkVS\nIE9GICIsIGNvbGxlY3Rpb24pOwogICAgICAgIH0KICAgIH0KICAgIAogICAg\ncHVibGljIHN0YXRpYyBjbGFzcyBMaWtlIGV4dGVuZHMgUHJlZGljYXRlSW1w\nbCB7CiAgICAgICAgcHVibGljIHN0YXRpYyBmaW5hbCBTdHJpbmcgTUFUQ0hf\nTVVMVElDSEFSICA9ICIlIjsKICAgICAgICBwdWJsaWMgc3RhdGljIGZpbmFs\nIFN0cmluZyBNQVRDSF9TSU5HTEVDSEFSID0gIl8iOwogICAgICAgIAogICAg\nICAgIGZpbmFsIEV4cHJlc3Npb25JbXBsPFN0cmluZz4gc3RyOwogICAgICAg\nIGZpbmFsIEV4cHJlc3Npb25JbXBsPFN0cmluZz4gcGF0dGVybjsKICAgICAg\nICBmaW5hbCBFeHByZXNzaW9uSW1wbDxDaGFyYWN0ZXI+IGVzY2FwZUNoYXI7\nCiAgICAgICAgCiAgICAgICAgcHVibGljIExpa2UoRXhwcmVzc2lvbjxTdHJp\nbmc+IHgsIEV4cHJlc3Npb248U3RyaW5nPiBwYXR0ZXJuLCBFeHByZXNzaW9u\nPENoYXJhY3Rlcj4gZXNjYXBlQ2hhcikgewogICAgICAgICAgICBzdXBlcigp\nOwogICAgICAgICAgICB0aGlzLnN0ciA9IChFeHByZXNzaW9uSW1wbDxTdHJp\nbmc+KXg7CiAgICAgICAgICAgIHRoaXMucGF0dGVybiA9IChFeHByZXNzaW9u\nSW1wbDxTdHJpbmc+KXBhdHRlcm47CiAgICAgICAgICAgIHRoaXMuZXNjYXBl\nQ2hhciA9IChFeHByZXNzaW9uSW1wbDxDaGFyYWN0ZXI+KWVzY2FwZUNoYXI7\nCiAgICAgICAgfQogICAgICAgIAogICAgICAgIHB1YmxpYyBMaWtlKEV4cHJl\nc3Npb248U3RyaW5nPiB4LCBFeHByZXNzaW9uPFN0cmluZz4gcGF0LCBjaGFy\nIGVzYykgewogICAgICAgICAgICB0aGlzKHgsIHBhdCwgbmV3IENvbnN0YW50\nPENoYXJhY3Rlcj4oQ2hhcmFjdGVyLmNsYXNzLCBlc2MpKTsKICAgICAgICB9\nCiAgICAgICAgCiAgICAgICAgcHVibGljIExpa2UoRXhwcmVzc2lvbjxTdHJp\nbmc+IHgsIEV4cHJlc3Npb248U3RyaW5nPiBwYXR0ZXJuKSB7CiAgICAgICAg\nICAgIHRoaXMoeCwgcGF0dGVybiwgbnVsbCk7CiAgICAgICAgfQogICAgICAg\nIAogICAgICAgIHB1YmxpYyBMaWtlKEV4cHJlc3Npb248U3RyaW5nPiB4LCBT\ndHJpbmcgcGF0dGVybikgewogICAgICAgICAgICB0aGlzKHgsIG5ldyBDb25z\ndGFudDxTdHJpbmc+KHBhdHRlcm4pLCBudWxsKTsKICAgICAgICB9CiAgICAg\nICAgCiAgICAgICAgcHVibGljIExpa2UoRXhwcmVzc2lvbjxTdHJpbmc+IHgs\nIFN0cmluZyBwYXQsICAKICAgICAgICAgICAgRXhwcmVzc2lvbjxDaGFyYWN0\nZXI+IGVzYykgewogICAgICAgICAgICB0aGlzKHgsIG5ldyBDb25zdGFudDxT\ndHJpbmc+KHBhdCksIGVzYyk7CiAgICAgICAgfQogICAgICAgIAogICAgICAg\nIHB1YmxpYyBMaWtlKEV4cHJlc3Npb248U3RyaW5nPiB4LCBTdHJpbmcgcGF0\nLCAgQ2hhcmFjdGVyIGVzYykgewogICAgICAgICAgICB0aGlzKHgsIG5ldyBD\nb25zdGFudDxTdHJpbmc+KHBhdCksIG5ldyBDb25zdGFudDxDaGFyYWN0ZXI+\nKGVzYykpOwogICAgICAgIH0KCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAg\ncHVibGljIG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuZXhwcy5FeHByZXNz\naW9uIHRvS2VybmVsRXhwcmVzc2lvbigKICAgICAgICAgICAgRXhwcmVzc2lv\nbkZhY3RvcnkgZmFjdG9yeSwgQ3JpdGVyaWFRdWVyeUltcGw8Pz4gcSkgewog\nICAgICAgICAgICBTdHJpbmcgZXNjYXBlU3RyID0gZXNjYXBlQ2hhciA9PSBu\ndWxsID8gbnVsbCA6CiAgICAgICAgICAgICAgICAoKENoYXJhY3RlcikoKExp\ndGVyYWwpRXhwcmVzc2lvbnMudG9WYWx1ZSgKICAgICAgICAgICAgICAgICAg\nICBlc2NhcGVDaGFyLCBmYWN0b3J5LCBxKSkuZ2V0VmFsdWUoKSkudG9TdHJp\nbmcoKTsKICAgICAgICAgICAgCiAgICAgICAgICAgIHJldHVybiBmYWN0b3J5\nLm1hdGNoZXMoCiAgICAgICAgICAgICAgICBFeHByZXNzaW9ucy50b1ZhbHVl\nKHN0ciwgZmFjdG9yeSwgcSksIAogICAgICAgICAgICAgICAgRXhwcmVzc2lv\nbnMudG9WYWx1ZShwYXR0ZXJuLCBmYWN0b3J5LCBxKSwgCiAgICAgICAgICAg\nICAgICBNQVRDSF9TSU5HTEVDSEFSLCBNQVRDSF9NVUxUSUNIQVIsIGVzY2Fw\nZVN0cik7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIHB1YmxpYyB2b2lk\nIGFjY2VwdFZpc2l0KENyaXRlcmlhRXhwcmVzc2lvblZpc2l0b3IgdmlzaXRv\ncikgewogICAgICAgICAgICBFeHByZXNzaW9ucy5hY2NlcHRWaXNpdCh2aXNp\ndG9yLCB0aGlzLCBzdHIsIHBhdHRlcm4sIGVzY2FwZUNoYXIpOwogICAgICAg\nIH0KICAgICAgICAKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBwdWJsaWMg\nU3RyaW5nQnVpbGRlciBhc1ZhbHVlKEFsaWFzQ29udGV4dCBxKSB7CiAgICAg\nICAgICAgIHJldHVybiBFeHByZXNzaW9ucy5hc1ZhbHVlKHEsIHN0ciwgIiBM\nSUtFICIsIHBhdHRlcm4pOwogICAgICAgIH0gICAgICAgIAogICAgfQogICAg\nCiAgICBwdWJsaWMgc3RhdGljIGNsYXNzIENvYWxlc2NlPFQ+IGV4dGVuZHMg\nRXhwcmVzc2lvbkltcGw8VD4gaW1wbGVtZW50cyBRdWVyeUJ1aWxkZXIuQ29h\nbGVzY2U8VD4gewogICAgICAgIHByaXZhdGUgZmluYWwgTGlzdDxFeHByZXNz\naW9uPD8gZXh0ZW5kcyBUPj4gdmFsdWVzID0gbmV3IEFycmF5TGlzdDxFeHBy\nZXNzaW9uPD8gZXh0ZW5kcyBUPj4oKTsKICAgICAgICAKICAgICAgICBwdWJs\naWMgQ29hbGVzY2UoQ2xhc3M8VD4gY2xzKSB7CiAgICAgICAgICAgIHN1cGVy\nKGNscyk7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIHB1YmxpYyBDb2Fs\nZXNjZTxUPiB2YWx1ZShUIHZhbHVlKSB7CiAgICAgICAgICAgIHZhbHVlcy5h\nZGQobmV3IENvbnN0YW50PFQ+KHZhbHVlKSk7CiAgICAgICAgICAgIHJldHVy\nbiB0aGlzOwogICAgICAgIH0KICAgICAgICAKICAgICAgICBwdWJsaWMgQ29h\nbGVzY2U8VD4gdmFsdWUoRXhwcmVzc2lvbjw/IGV4dGVuZHMgVD4gdmFsdWUp\nIHsKICAgICAgICAgICAgdmFsdWVzLmFkZCh2YWx1ZSk7IAogICAgICAgICAg\nICByZXR1cm4gdGhpczsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgQE92\nZXJyaWRlCiAgICAgICAgcHVibGljIG9yZy5hcGFjaGUub3BlbmpwYS5rZXJu\nZWwuZXhwcy5WYWx1ZSB0b1ZhbHVlKAogICAgICAgICAgICBFeHByZXNzaW9u\nRmFjdG9yeSBmYWN0b3J5LCBDcml0ZXJpYVF1ZXJ5SW1wbDw/PiBxKSB7CiAg\nICAgICAgICAgIFZhbHVlW10gdnMgPSBuZXcgVmFsdWVbdmFsdWVzLnNpemUo\nKV07CiAgICAgICAgICAgIGludCBpID0gMDsKICAgICAgICAgICAgZm9yIChF\neHByZXNzaW9uPD8+IGUgOiB2YWx1ZXMpCiAgICAgICAgICAgICAgICB2c1tp\nKytdID0gRXhwcmVzc2lvbnMudG9WYWx1ZSgoRXhwcmVzc2lvbkltcGw8Pz4p\nZSwgZmFjdG9yeSwgcSk7CiAgICAgICAgICAgIHJldHVybiBmYWN0b3J5LmNv\nYWxlc2NlRXhwcmVzc2lvbih2cyk7CiAgICAgICAgfQogICAgICAgIAogICAg\nICAgIHB1YmxpYyB2b2lkIGFjY2VwdFZpc2l0KENyaXRlcmlhRXhwcmVzc2lv\nblZpc2l0b3IgdmlzaXRvcikgewogICAgICAgICAgICBFeHByZXNzaW9ucy5h\nY2NlcHRWaXNpdCh2aXNpdG9yLCB0aGlzLCB2YWx1ZXMudG9BcnJheShuZXcg\nRXhwcmVzc2lvbkltcGxbdmFsdWVzLnNpemUoKV0pKTsKICAgICAgICB9CiAg\nICAgICAgCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgcHVibGljIFN0cmlu\nZ0J1aWxkZXIgYXNWYWx1ZShBbGlhc0NvbnRleHQgcSkgewogICAgICAgICAg\nICByZXR1cm4gRXhwcmVzc2lvbnMuYXNWYWx1ZShxLCAiQ09BTEVTQ0UiLCBP\nUEVOX0JSQUNFLCBFeHByZXNzaW9ucy5hc1ZhbHVlKHEsIHZhbHVlcyA9PSBu\ndWxsIAogICAgICAgICAgICAgICAgICAgID8gbnVsbCA6IHZhbHVlcy50b0Fy\ncmF5KG5ldyBFeHByZXNzaW9uPD8+W3ZhbHVlcy5zaXplKCldKSwgQ09NTUEp\nLCBDTE9TRV9CUkFDRSk7CiAgICAgICAgfSAgICAgICAgCiAgICB9CiAgICAK\nICAgIHB1YmxpYyBzdGF0aWMgY2xhc3MgTnVsbGlmPFQ+IGV4dGVuZHMgRXhw\ncmVzc2lvbkltcGw8VD4gewogICAgICAgIHByaXZhdGUgRXhwcmVzc2lvbjxU\nPiB2YWwxOwogICAgICAgIHByaXZhdGUgRXhwcmVzc2lvbjw/PiB2YWwyOwoK\nICAgICAgICBwdWJsaWMgTnVsbGlmKEV4cHJlc3Npb248VD4geCwgRXhwcmVz\nc2lvbjw/PiB5KSB7CiAgICAgICAgICAgIHN1cGVyKChDbGFzczxUPil4Lmdl\ndEphdmFUeXBlKCkpOwogICAgICAgICAgICB2YWwxID0geDsKICAgICAgICAg\nICAgdmFsMiA9IHk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgTnVsbGlm\nKEV4cHJlc3Npb248VD4geCwgVCB5KSB7CiAgICAgICAgICAgIHRoaXMoeCwg\nbmV3IENvbnN0YW50PFQ+KHkpKTsKICAgICAgICB9CgogICAgICAgIEBPdmVy\ncmlkZQogICAgICAgIHB1YmxpYyBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVs\nLmV4cHMuVmFsdWUgdG9WYWx1ZSgKICAgICAgICAgICAgRXhwcmVzc2lvbkZh\nY3RvcnkgZmFjdG9yeSwgQ3JpdGVyaWFRdWVyeUltcGw8Pz4gcSkgewogICAg\nICAgICAgICBWYWx1ZSB2YWx1ZTEgPSBFeHByZXNzaW9ucy50b1ZhbHVlKChF\neHByZXNzaW9uSW1wbDw/Pil2YWwxLCBmYWN0b3J5LCBxKTsgCiAgICAgICAg\nICAgIFZhbHVlIHZhbHVlMiA9IEV4cHJlc3Npb25zLnRvVmFsdWUoKEV4cHJl\nc3Npb25JbXBsPD8+KXZhbDIsIGZhY3RvcnksIHEpOyAKICAgICAgICAgICAg\ncmV0dXJuIGZhY3RvcnkubnVsbElmRXhwcmVzc2lvbih2YWx1ZTEsIHZhbHVl\nMik7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIHB1YmxpYyB2b2lkIGFj\nY2VwdFZpc2l0KENyaXRlcmlhRXhwcmVzc2lvblZpc2l0b3IgdmlzaXRvcikg\newogICAgICAgICAgICBFeHByZXNzaW9ucy5hY2NlcHRWaXNpdCh2aXNpdG9y\nLCB0aGlzLCB2YWwxLCB2YWwyKTsKICAgICAgICB9CiAgICAgICAgCiAgICAg\nICAgQE92ZXJyaWRlCiAgICAgICAgcHVibGljIFN0cmluZ0J1aWxkZXIgYXNW\nYWx1ZShBbGlhc0NvbnRleHQgcSkgewogICAgICAgICAgICByZXR1cm4gRXhw\ncmVzc2lvbnMuYXNWYWx1ZShxLCAiTlVMTElGIiwgT1BFTl9CUkFDRSwgdmFs\nMSwgQ09NTUEsIHZhbDIsIENMT1NFX0JSQUNFKTsKICAgICAgICB9ICAgICAg\nICAKICAgIH0KCiAgICBwdWJsaWMgc3RhdGljIGNsYXNzIElzTnVsbCBleHRl\nbmRzIFByZWRpY2F0ZUltcGwgewogICAgICAgIGZpbmFsIEV4cHJlc3Npb25J\nbXBsPD8+IGU7CiAgICAgICAgcHVibGljIElzTnVsbChFeHByZXNzaW9uSW1w\nbDw/PiBlKSB7CiAgICAgICAgICAgIHN1cGVyKCk7CiAgICAgICAgICAgIHRo\naXMuZSA9IGU7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIEBPdmVycmlk\nZQogICAgICAgIHB1YmxpYyBQcmVkaWNhdGVJbXBsIG5lZ2F0ZSgpIHsKICAg\nICAgICAgICAgcmV0dXJuIG5ldyBJc05vdE51bGwoZSkubWFya05lZ2F0ZWQo\nKTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgQE92ZXJyaWRlCiAgICAg\nICAgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5leHBzLkV4cHJlc3Npb24g\ndG9LZXJuZWxFeHByZXNzaW9uKAogICAgICAgICAgICBFeHByZXNzaW9uRmFj\ndG9yeSBmYWN0b3J5LCBDcml0ZXJpYVF1ZXJ5SW1wbDw/PiBxKSB7CiAgICAg\nICAgICAgIHJldHVybiBmYWN0b3J5LmVxdWFsKAogICAgICAgICAgICAgICAg\nRXhwcmVzc2lvbnMudG9WYWx1ZShlLCBmYWN0b3J5LCBxKSwgCiAgICAgICAg\nICAgICAgICBmYWN0b3J5LmdldE51bGwoKSk7CiAgICAgICAgfQogICAgICAg\nIAogICAgICAgIHB1YmxpYyB2b2lkIGFjY2VwdFZpc2l0KENyaXRlcmlhRXhw\ncmVzc2lvblZpc2l0b3IgdmlzaXRvcikgewogICAgICAgICAgICBzdXBlci5h\nY2NlcHRWaXNpdCh2aXNpdG9yKTsKICAgICAgICAgICAgRXhwcmVzc2lvbnMu\nYWNjZXB0VmlzaXQodmlzaXRvciwgZSk7CiAgICAgICAgfQogICAgICAgIAog\nICAgICAgIEBPdmVycmlkZQogICAgICAgIHB1YmxpYyBTdHJpbmdCdWlsZGVy\nIGFzVmFsdWUoQWxpYXNDb250ZXh0IHEpIHsKICAgICAgICAgICAgcmV0dXJu\nIEV4cHJlc3Npb25zLmFzVmFsdWUocSwgZSwgIiBJUyBOVUxMIik7CiAgICAg\nICAgfQogICAgfQogICAgCiAgICBwdWJsaWMgc3RhdGljIGNsYXNzIElzTm90\nTnVsbCBleHRlbmRzIFByZWRpY2F0ZUltcGwgewogICAgICAgIGZpbmFsIEV4\ncHJlc3Npb25JbXBsPD8+IGU7CiAgICAgICAgcHVibGljIElzTm90TnVsbChF\neHByZXNzaW9uSW1wbDw/PiBlKSB7CiAgICAgICAgICAgIHN1cGVyKCk7CiAg\nICAgICAgICAgIHRoaXMuZSA9IGU7CiAgICAgICAgfQogICAgICAgIAogICAg\nICAgIEBPdmVycmlkZQogICAgICAgIHB1YmxpYyBQcmVkaWNhdGVJbXBsIG5l\nZ2F0ZSgpIHsKICAgICAgICAgICAgcmV0dXJuIG5ldyBJc051bGwoZSkubWFy\na05lZ2F0ZWQoKTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgQE92ZXJy\naWRlCiAgICAgICAgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5leHBzLkV4\ncHJlc3Npb24gdG9LZXJuZWxFeHByZXNzaW9uKAogICAgICAgICAgICBFeHBy\nZXNzaW9uRmFjdG9yeSBmYWN0b3J5LCBDcml0ZXJpYVF1ZXJ5SW1wbDw/PiBx\nKSB7CiAgICAgICAgICAgIHJldHVybiBmYWN0b3J5Lm5vdEVxdWFsKAogICAg\nICAgICAgICAgICAgRXhwcmVzc2lvbnMudG9WYWx1ZShlLCBmYWN0b3J5LCBx\nKSwgCiAgICAgICAgICAgICAgICBmYWN0b3J5LmdldE51bGwoKSk7CiAgICAg\nICAgfQogICAgICAgIAogICAgICAgIHB1YmxpYyB2b2lkIGFjY2VwdFZpc2l0\nKENyaXRlcmlhRXhwcmVzc2lvblZpc2l0b3IgdmlzaXRvcikgewogICAgICAg\nICAgICBzdXBlci5hY2NlcHRWaXNpdCh2aXNpdG9yKTsKICAgICAgICAgICAg\nRXhwcmVzc2lvbnMuYWNjZXB0VmlzaXQodmlzaXRvciwgZSk7CiAgICAgICAg\nfQogICAgICAgIAogICAgICAgIEBPdmVycmlkZQogICAgICAgIHB1YmxpYyBT\ndHJpbmdCdWlsZGVyIGFzVmFsdWUoQWxpYXNDb250ZXh0IHEpIHsKICAgICAg\nICAgICAgcmV0dXJuIEV4cHJlc3Npb25zLmFzVmFsdWUocSwgZSwgIiBJUyBO\nT1QgTlVMTCIpOwogICAgICAgIH0KICAgIH0KICAgIAogICAgCiAgICBwdWJs\naWMgc3RhdGljIGNsYXNzIEluPFQ+IGV4dGVuZHMgUHJlZGljYXRlSW1wbC5P\nciBpbXBsZW1lbnRzIFF1ZXJ5QnVpbGRlci5JbjxUPiB7CiAgICAgICAgZmlu\nYWwgRXhwcmVzc2lvbkltcGw8VD4gZTsKICAgICAgICBwdWJsaWMgSW4oRXhw\ncmVzc2lvbjw/PiBlKSB7CiAgICAgICAgICAgIHN1cGVyKCk7CiAgICAgICAg\nICAgIHRoaXMuZSA9IChFeHByZXNzaW9uSW1wbDxUPillOwogICAgICAgIH0K\nICAgICAgICAKICAgICAgICBwdWJsaWMgRXhwcmVzc2lvbjxUPiBnZXRFeHBy\nZXNzaW9uKCkgewogICAgICAgICAgICByZXR1cm4gZTsKICAgICAgICB9Cgog\nICAgICAgIHB1YmxpYyBJbjxUPiB2YWx1ZShUIHZhbHVlKSB7CiAgICAgICAg\nICAgIGFkZChuZXcgRXhwcmVzc2lvbnMuRXF1YWwoZSx2YWx1ZSkpOwogICAg\nICAgICAgICByZXR1cm4gdGhpczsKICAgICAgICB9CgogICAgICAgIHB1Ymxp\nYyBJbjxUPiB2YWx1ZShFeHByZXNzaW9uPD8gZXh0ZW5kcyBUPiB2YWx1ZSkg\newogICAgICAgICAgICBhZGQobmV3IEV4cHJlc3Npb25zLkVxdWFsKGUsdmFs\ndWUpKTsKICAgICAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgICAgfQogICAg\nICAgIAogICAgICAgIEBPdmVycmlkZQogICAgICAgIHB1YmxpYyBQcmVkaWNh\ndGVJbXBsIG5lZ2F0ZSgpIHsKICAgICAgICAgICAgSW48VD4gbm90SW4gPSBu\nZXcgSW48VD4oZSk7CiAgICAgICAgICAgIG5vdEluLm1hcmtOZWdhdGVkKCk7\nCiAgICAgICAgICAgIGZvciAoUHJlZGljYXRlIGUgOiBfZXhwcykgewogICAg\nICAgICAgICAgICAgbm90SW4uYWRkKGUpOwogICAgICAgICAgICB9CiAgICAg\nICAgICAgIHJldHVybiBub3RJbjsKICAgICAgICB9CiAgICAgICAgCiAgICAg\nICAgQE92ZXJyaWRlCiAgICAgICAgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5l\nbC5leHBzLkV4cHJlc3Npb24gdG9LZXJuZWxFeHByZXNzaW9uKAogICAgICAg\nICAgICBFeHByZXNzaW9uRmFjdG9yeSBmYWN0b3J5LCBDcml0ZXJpYVF1ZXJ5\nSW1wbDw/PiBxKSB7CiAgICAgICAgICAgIG9yZy5hcGFjaGUub3BlbmpwYS5r\nZXJuZWwuZXhwcy5FeHByZXNzaW9uIGluRXhwciA9IG51bGw7CiAgICAgICAg\nICAgIGlmIChfZXhwcy5zaXplKCkgPT0gMSkgewogICAgICAgICAgICAgICAg\nRXhwcmVzc2lvbnMuRXF1YWwgZSA9IChFeHByZXNzaW9ucy5FcXVhbClfZXhw\ncy5nZXQoMCk7CiAgICAgICAgICAgICAgICBFeHByZXNzaW9uSW1wbDw/PiBl\nMiA9IGUuZTI7CiAgICAgICAgICAgICAgICBFeHByZXNzaW9uSW1wbDw/PiBl\nMSA9IGUuZTE7CiAgICAgICAgICAgICAgICBWYWx1ZSB2YWwyID0gRXhwcmVz\nc2lvbnMudG9WYWx1ZShlMiwgZmFjdG9yeSwgcSk7CiAgICAgICAgICAgICAg\nICBpZiAoISh2YWwyIGluc3RhbmNlb2YgTGl0ZXJhbCkpIHsKICAgICAgICAg\nICAgICAgICAgICBWYWx1ZSB2YWwxID0gRXhwcmVzc2lvbnMudG9WYWx1ZShl\nMSwgZmFjdG9yeSwgcSk7CiAgICAgICAgICAgICAgICAgICAgRXhwcmVzc2lv\nbnMuc2V0SW1wbGljaXRUeXBlcyh2YWwxLCB2YWwyLCBlMS5nZXRKYXZhVHlw\nZSgpLCBxKTsKICAgICAgICAgICAgICAgICAgICBpbkV4cHIgPSBmYWN0b3J5\nLmNvbnRhaW5zKHZhbDIsIHZhbDEpOwogICAgICAgICAgICAgICAgICAgIHJl\ndHVybiBpc05lZ2F0ZWQoKSA/IGZhY3Rvcnkubm90KGluRXhwcikgOiBpbkV4\ncHI7CiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCgoTGl0ZXJhbCl2YWwy\nKS5nZXRQYXJzZVR5cGUoKSA9PSBMaXRlcmFsLlRZUEVfQ09MTEVDVElPTikg\newogICAgICAgICAgICAgICAgICAgIENvbGxlY3Rpb24gY29sbCA9IChDb2xs\nZWN0aW9uKSgoTGl0ZXJhbCl2YWwyKS5nZXRWYWx1ZSgpOwogICAgICAgICAg\nICAgICAgICAgIF9leHBzLmNsZWFyKCk7CiAgICAgICAgICAgICAgICAgICAg\nZm9yIChPYmplY3QgdiA6IGNvbGwpIHsKICAgICAgICAgICAgICAgICAgICAg\nICAgYWRkKG5ldyBFeHByZXNzaW9ucy5FcXVhbChlMSx2KSk7CiAgICAgICAg\nICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9\nIAogICAgICAgICAgICBpbkV4cHIgPSBzdXBlci50b0tlcm5lbEV4cHJlc3Np\nb24oZmFjdG9yeSwgcSk7IAogICAgICAgICAgICBJc05vdE51bGwgbm90TnVs\nbCA9IG5ldyBFeHByZXNzaW9ucy5Jc05vdE51bGwoZSk7CiAgICAgICAgICAg\nIAogICAgICAgICAgICByZXR1cm4gZmFjdG9yeS5hbmQoaW5FeHByLCBub3RO\ndWxsLnRvS2VybmVsRXhwcmVzc2lvbihmYWN0b3J5LCBxKSk7CiAgICAgICAg\nfQogICAgICAgIAogICAgICAgIHB1YmxpYyB2b2lkIGFjY2VwdFZpc2l0KENy\naXRlcmlhRXhwcmVzc2lvblZpc2l0b3IgdmlzaXRvcikgewogICAgICAgICAg\nICBzdXBlci5hY2NlcHRWaXNpdCh2aXNpdG9yKTsKICAgICAgICAgICAgRXhw\ncmVzc2lvbnMuYWNjZXB0VmlzaXQodmlzaXRvciwgdGhpcywgZSk7CiAgICAg\nICAgfQogICAgICAgIAogICAgICAgIEBPdmVycmlkZQogICAgICAgIHB1Ymxp\nYyBTdHJpbmdCdWlsZGVyIGFzVmFsdWUoQWxpYXNDb250ZXh0IHEpIHsKICAg\nICAgICAgICAgU3RyaW5nQnVpbGRlciBidWZmZXIgPSBFeHByZXNzaW9ucy5h\nc1ZhbHVlKHEsIGUsICIgSU4gIiwgT1BFTl9CUkFDRSk7CiAgICAgICAgICAg\nIGZvciAoaW50IGkgPSAwOyBpIDwgX2V4cHMuc2l6ZSgpOyBpKyspIHsKICAg\nICAgICAgICAgICAgIGJ1ZmZlci5hcHBlbmQoKChFcXVhbClfZXhwcy5nZXQo\naSkpLmUyLmFzVmFsdWUocSkpLmFwcGVuZChpKzEgPT0gX2V4cHMuc2l6ZSgp\nID8gQ0xPU0VfQlJBQ0UgOiBDT01NQSk7CiAgICAgICAgICAgIH0KICAgICAg\nICAgICAgcmV0dXJuIGJ1ZmZlcjsKICAgICAgICB9ICAgICAgICAKICAgIH0K\nICAgIAogICAgcHVibGljIHN0YXRpYyBjbGFzcyBDYXNlPFQ+IGV4dGVuZHMg\nRXhwcmVzc2lvbkltcGw8VD4gaW1wbGVtZW50cyBRdWVyeUJ1aWxkZXIuQ2Fz\nZTxUPiB7CiAgICAgICAgcHJpdmF0ZSBmaW5hbCBMaXN0PEV4cHJlc3Npb248\nPyBleHRlbmRzIFQ+PiB0aGVucyA9IG5ldyBBcnJheUxpc3Q8RXhwcmVzc2lv\nbjw/IGV4dGVuZHMgVD4+KCk7CiAgICAgICAgcHJpdmF0ZSBmaW5hbCBMaXN0\nPEV4cHJlc3Npb248Qm9vbGVhbj4+IHdoZW5zID0gbmV3IEFycmF5TGlzdDxF\neHByZXNzaW9uPEJvb2xlYW4+PigpOwogICAgICAgIHByaXZhdGUgRXhwcmVz\nc2lvbjw/IGV4dGVuZHMgVD4gb3RoZXJ3aXNlOwoKICAgICAgICBwdWJsaWMg\nQ2FzZShDbGFzczxUPiBjbHMpIHsKICAgICAgICAgICAgc3VwZXIoY2xzKTsK\nICAgICAgICB9CgogICAgICAgIHB1YmxpYyBDYXNlPFQ+IHdoZW4oRXhwcmVz\nc2lvbjxCb29sZWFuPiB3aGVuLCBFeHByZXNzaW9uPD8gZXh0ZW5kcyBUPiB0\naGVuKSB7CiAgICAgICAgICAgIHdoZW5zLmFkZCh3aGVuKTsKICAgICAgICAg\nICAgdGhlbnMuYWRkKHRoZW4pOwogICAgICAgICAgICByZXR1cm4gdGhpczsK\nICAgICAgICB9CgogICAgICAgIHB1YmxpYyBDYXNlPFQ+IHdoZW4oRXhwcmVz\nc2lvbjxCb29sZWFuPiB3aGVuLCBUIHRoZW4pIHsKICAgICAgICAgICAgcmV0\ndXJuIHdoZW4od2hlbiwgbmV3IEV4cHJlc3Npb25zLkNvbnN0YW50PFQ+KHRo\nZW4pKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBDYXNlPFQ+IG90aGVy\nd2lzZShFeHByZXNzaW9uPD8gZXh0ZW5kcyBUPiBvdGhlcndpc2UpIHsKICAg\nICAgICAgICAgdGhpcy5vdGhlcndpc2UgPSBvdGhlcndpc2U7CiAgICAgICAg\nICAgIHJldHVybiB0aGlzOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIENh\nc2U8VD4gb3RoZXJ3aXNlKFQgb3RoZXJ3aXNlKSB7CiAgICAgICAgICAgIHJl\ndHVybiBvdGhlcndpc2UobmV3IEV4cHJlc3Npb25zLkNvbnN0YW50PFQ+KG90\naGVyd2lzZSkpOwogICAgICAgIH0KCiAgICAgICAgQE92ZXJyaWRlCiAgICAg\nICAgcHVibGljIG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuZXhwcy5WYWx1\nZSB0b1ZhbHVlKAogICAgICAgICAgICBFeHByZXNzaW9uRmFjdG9yeSBmYWN0\nb3J5LCBDcml0ZXJpYVF1ZXJ5SW1wbDw/PiBxKSB7CiAgICAgICAgICAgIGlu\ndCBzaXplID0gd2hlbnMuc2l6ZSgpOwogICAgICAgICAgICBvcmcuYXBhY2hl\nLm9wZW5qcGEua2VybmVsLmV4cHMuRXhwcmVzc2lvbltdIGV4cHMgPSBuZXcg\nb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5leHBzLkV4cHJlc3Npb25bc2l6\nZV07CiAgICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgc2l6ZTsgaSsr\nKSB7CiAgICAgICAgICAgICAgICBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVs\nLmV4cHMuRXhwcmVzc2lvbiBleHByID0gCiAgICAgICAgICAgICAgICAgICAg\nKChFeHByZXNzaW9uSW1wbDw/Pil3aGVucy5nZXQoaSkpLnRvS2VybmVsRXhw\ncmVzc2lvbihmYWN0b3J5LCBxKTsKICAgICAgICAgICAgICAgIFZhbHVlIGFj\ndGlvbiA9IEV4cHJlc3Npb25zLnRvVmFsdWUoKEV4cHJlc3Npb25JbXBsPD8+\nKXRoZW5zLmdldChpKSwgZmFjdG9yeSwgcSk7CiAgICAgICAgICAgICAgICBl\neHBzW2ldID0gZmFjdG9yeS53aGVuQ29uZGl0aW9uKGV4cHIsIGFjdGlvbik7\nCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIFZhbHVlIG90aGVyID0gRXhw\ncmVzc2lvbnMudG9WYWx1ZSgoRXhwcmVzc2lvbkltcGw8Pz4pb3RoZXJ3aXNl\nLCBmYWN0b3J5LCBxKTsKICAgICAgICAgICAgcmV0dXJuIGZhY3RvcnkuZ2Vu\nZXJhbENhc2VFeHByZXNzaW9uKGV4cHMsIG90aGVyKTsKICAgICAgICB9CiAg\nICAgICAgCiAgICAgICAgcHVibGljIHZvaWQgYWNjZXB0VmlzaXQoQ3JpdGVy\naWFFeHByZXNzaW9uVmlzaXRvciB2aXNpdG9yKSB7CiAgICAgICAgICAgIHZp\nc2l0b3IuZW50ZXIodGhpcyk7CiAgICAgICAgICAgIGZvciAoaW50IGkgPSAw\nOyBpIDwgd2hlbnMuc2l6ZSgpOyBpKyspIHsKICAgICAgICAgICAgICAgIEV4\ncHJlc3Npb25zLnZpc2l0Q2hpbGRyZW4odmlzaXRvciwgd2hlbnMuZ2V0KGkp\nKTsKICAgICAgICAgICAgICAgIEV4cHJlc3Npb25zLnZpc2l0Q2hpbGRyZW4o\ndmlzaXRvciwgdGhlbnMuZ2V0KGkpKTsKICAgICAgICAgICAgfQogICAgICAg\nICAgICBFeHByZXNzaW9ucy52aXNpdENoaWxkcmVuKHZpc2l0b3IsIG90aGVy\nd2lzZSk7CiAgICAgICAgICAgIHZpc2l0b3IuZXhpdCh0aGlzKTsKICAgICAg\nICB9CiAgICAgICAgCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgcHVibGlj\nIFN0cmluZ0J1aWxkZXIgYXNWYWx1ZShBbGlhc0NvbnRleHQgcSkgewogICAg\nICAgICAgICBTdHJpbmdCdWlsZGVyIGJ1ZmZlciA9IG5ldyBTdHJpbmdCdWls\nZGVyKCJDQVNFICIpOwogICAgICAgICAgICBpbnQgc2l6ZSA9IHdoZW5zLnNp\nemUoKTsKICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBzaXplOyBp\nKyspIHsKICAgICAgICAgICAgICAgIGJ1ZmZlci5hcHBlbmQoRXhwcmVzc2lv\nbnMuYXNWYWx1ZShxLCAiIFdIRU4gIiwgd2hlbnMuZ2V0KGkpLCAiIFRIRU4g\nIiwgdGhlbnMuZ2V0KGkpKSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAg\nYnVmZmVyLmFwcGVuZChFeHByZXNzaW9ucy5hc1ZhbHVlKHEsICIgRUxTRSAi\nLCBvdGhlcndpc2UsICIgRU5EIikpOwogICAgICAgICAgICByZXR1cm4gYnVm\nZmVyOwogICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMgc3RhdGljIGNsYXNz\nIFNpbXBsZUNhc2U8QyxSPiBleHRlbmRzIEV4cHJlc3Npb25JbXBsPFI+IGlt\ncGxlbWVudHMgUXVlcnlCdWlsZGVyLlNpbXBsZUNhc2U8QyxSPiB7CiAgICAg\nICAgcHJpdmF0ZSBmaW5hbCBMaXN0PEV4cHJlc3Npb248PyBleHRlbmRzIFI+\nPiB0aGVucyA9IG5ldyBBcnJheUxpc3Q8RXhwcmVzc2lvbjw/IGV4dGVuZHMg\nUj4+KCk7CiAgICAgICAgcHJpdmF0ZSBmaW5hbCBMaXN0PEV4cHJlc3Npb248\nQz4+IHdoZW5zID0gbmV3IEFycmF5TGlzdDxFeHByZXNzaW9uPEM+PigpOwog\nICAgICAgIHByaXZhdGUgRXhwcmVzc2lvbjw/IGV4dGVuZHMgUj4gb3RoZXJ3\naXNlOwogICAgICAgIHByaXZhdGUgRXhwcmVzc2lvbjxDPiBjYXNlT3BlcmFu\nZDsKCiAgICAgICAgcHVibGljIFNpbXBsZUNhc2UoQ2xhc3M8Uj4gY2xzKSB7\nCiAgICAgICAgICAgIHN1cGVyKGNscyk7CiAgICAgICAgfQogICAgICAgIAog\nICAgICAgIHB1YmxpYyBTaW1wbGVDYXNlKEV4cHJlc3Npb248Qz4gZXhwcikg\newogICAgICAgICAgICBzdXBlcihudWxsKTsKICAgICAgICAgICAgdGhpcy5j\nYXNlT3BlcmFuZCA9IGV4cHI7CiAgICAgICAgfQogICAgICAgIAogICAgICAg\nIHB1YmxpYyBFeHByZXNzaW9uPEM+IGdldEV4cHJlc3Npb24oKSB7CiAgICAg\nICAgICAgIHJldHVybiBjYXNlT3BlcmFuZDsKICAgICAgICB9CgogICAgICAg\nIHB1YmxpYyBTaW1wbGVDYXNlPEMsUj4gd2hlbihFeHByZXNzaW9uPEM+IHdo\nZW4sIEV4cHJlc3Npb248PyBleHRlbmRzIFI+IHRoZW4pIHsKICAgICAgICAg\nICAgd2hlbnMuYWRkKHdoZW4pOwogICAgICAgICAgICB0aGVucy5hZGQodGhl\nbik7CiAgICAgICAgICAgIHJldHVybiB0aGlzOwogICAgICAgIH0KCiAgICAg\nICAgcHVibGljIFNpbXBsZUNhc2U8QyxSPiB3aGVuKEMgd2hlbiwgRXhwcmVz\nc2lvbjw/IGV4dGVuZHMgUj4gdGhlbikgewogICAgICAgICAgICByZXR1cm4g\nd2hlbihuZXcgQ29uc3RhbnQ8Qz4od2hlbiksIHRoZW4pOwogICAgICAgIH0K\nCiAgICAgICAgcHVibGljIFNpbXBsZUNhc2U8QyxSPiB3aGVuKEMgd2hlbiwg\nUiB0aGVuKSB7CiAgICAgICAgICAgIHJldHVybiB3aGVuKHdoZW4sIG5ldyBF\neHByZXNzaW9ucy5Db25zdGFudDxSPih0aGVuKSk7CiAgICAgICAgfQoKICAg\nICAgICBwdWJsaWMgU2ltcGxlQ2FzZTxDLFI+IG90aGVyd2lzZShFeHByZXNz\naW9uPD8gZXh0ZW5kcyBSPiBvdGhlcndpc2UpIHsKICAgICAgICAgICAgdGhp\ncy5vdGhlcndpc2UgPSBvdGhlcndpc2U7CiAgICAgICAgICAgIHJldHVybiB0\naGlzOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIFNpbXBsZUNhc2U8QyxS\nPiBvdGhlcndpc2UoUiBvdGhlcndpc2UpIHsKICAgICAgICAgICAgcmV0dXJu\nIG90aGVyd2lzZShuZXcgRXhwcmVzc2lvbnMuQ29uc3RhbnQ8Uj4ob3RoZXJ3\naXNlKSk7CiAgICAgICAgfQoKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBw\ndWJsaWMgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5leHBzLlZhbHVlIHRv\nVmFsdWUoCiAgICAgICAgICAgICAgICBFeHByZXNzaW9uRmFjdG9yeSBmYWN0\nb3J5LCBDcml0ZXJpYVF1ZXJ5SW1wbDw/PiBxKSB7CiAgICAgICAgICAgIFZh\nbHVlIGNhc2VPcGVyYW5kRXhwciA9IEV4cHJlc3Npb25zLnRvVmFsdWUoKEV4\ncHJlc3Npb25JbXBsPD8+KWNhc2VPcGVyYW5kLCBmYWN0b3J5LCBxKTsKICAg\nICAgICAgICAgaW50IHNpemUgPSB3aGVucy5zaXplKCk7CiAgICAgICAgICAg\nIG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuZXhwcy5FeHByZXNzaW9uW10g\nZXhwcyA9IG5ldyBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLmV4cHMuRXhw\ncmVzc2lvbltzaXplXTsKICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkg\nPCBzaXplOyBpKyspIHsKICAgICAgICAgICAgICAgIFZhbHVlIHdoZW4gPSBF\neHByZXNzaW9ucy50b1ZhbHVlKChFeHByZXNzaW9uSW1wbDxDPil3aGVucy5n\nZXQoaSksIGZhY3RvcnksIHEpOwogICAgICAgICAgICAgICAgVmFsdWUgYWN0\naW9uID0gRXhwcmVzc2lvbnMudG9WYWx1ZSgoRXhwcmVzc2lvbkltcGw8Pz4p\ndGhlbnMuZ2V0KGkpLCBmYWN0b3J5LCBxKTsKICAgICAgICAgICAgICAgIGV4\ncHNbaV0gPSBmYWN0b3J5LndoZW5TY2FsYXIod2hlbiwgYWN0aW9uKTsKICAg\nICAgICAgICAgfQoKICAgICAgICAgICAgVmFsdWUgb3RoZXIgPSBFeHByZXNz\naW9ucy50b1ZhbHVlKChFeHByZXNzaW9uSW1wbDw/PilvdGhlcndpc2UsIGZh\nY3RvcnksIHEpOwogICAgICAgICAgICByZXR1cm4gZmFjdG9yeS5zaW1wbGVD\nYXNlRXhwcmVzc2lvbihjYXNlT3BlcmFuZEV4cHIsIGV4cHMsIG90aGVyKTsK\nICAgICAgICB9CiAgICAgICAgCiAgICAgICAgcHVibGljIHZvaWQgYWNjZXB0\nVmlzaXQoQ3JpdGVyaWFFeHByZXNzaW9uVmlzaXRvciB2aXNpdG9yKSB7CiAg\nICAgICAgICAgIHZpc2l0b3IuZW50ZXIodGhpcyk7CiAgICAgICAgICAgIEV4\ncHJlc3Npb25zLnZpc2l0Q2hpbGRyZW4odmlzaXRvciwgY2FzZU9wZXJhbmQp\nOwogICAgICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IHdoZW5zLnNpemUo\nKTsgaSsrKSB7CiAgICAgICAgICAgICAgICBFeHByZXNzaW9ucy52aXNpdENo\naWxkcmVuKHZpc2l0b3IsIHdoZW5zLmdldChpKSk7CiAgICAgICAgICAgICAg\nICBFeHByZXNzaW9ucy52aXNpdENoaWxkcmVuKHZpc2l0b3IsIHRoZW5zLmdl\ndChpKSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgRXhwcmVzc2lvbnMu\ndmlzaXRDaGlsZHJlbih2aXNpdG9yLCBvdGhlcndpc2UpOwogICAgICAgICAg\nICB2aXNpdG9yLmV4aXQodGhpcyk7CiAgICAgICAgfQogICAgICAgIAogICAg\nICAgIEBPdmVycmlkZQogICAgICAgIHB1YmxpYyBTdHJpbmdCdWlsZGVyIGFz\nVmFsdWUoQWxpYXNDb250ZXh0IHEpIHsKICAgICAgICAgICAgU3RyaW5nQnVp\nbGRlciBidWZmZXIgPSBuZXcgU3RyaW5nQnVpbGRlcigiQ0FTRSAiKTsKICAg\nICAgICAgICAgaW50IHNpemUgPSB3aGVucy5zaXplKCk7CiAgICAgICAgICAg\nIGZvciAoaW50IGkgPSAwOyBpIDwgc2l6ZTsgaSsrKSB7CiAgICAgICAgICAg\nICAgICBidWZmZXIuYXBwZW5kKEV4cHJlc3Npb25zLmFzVmFsdWUocSwgIiBX\nSEVOICIsIHdoZW5zLmdldChpKSwgIiBUSEVOICIsIHRoZW5zLmdldChpKSkp\nOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGJ1ZmZlci5hcHBlbmQoRXhw\ncmVzc2lvbnMuYXNWYWx1ZShxLCAiIEVMU0UgIiwgb3RoZXJ3aXNlLCAiIEVO\nRCIpKTsKICAgICAgICAgICAgcmV0dXJuIGJ1ZmZlcjsKICAgICAgICB9CiAg\nICB9CgogICAgcHVibGljIHN0YXRpYyBjbGFzcyBMb3dlciBleHRlbmRzIFVu\nYXJ5RnVuY3Rpb25hbEV4cHJlc3Npb248U3RyaW5nPiB7CiAgICAgICAgcHVi\nbGljIExvd2VyKEV4cHJlc3Npb248U3RyaW5nPiB4KSB7CiAgICAgICAgICAg\nIHN1cGVyKFN0cmluZy5jbGFzcywgeCk7CiAgICAgICAgfQogICAgICAgIAog\nICAgICAgIEBPdmVycmlkZQogICAgICAgIHB1YmxpYyBWYWx1ZSB0b1ZhbHVl\nKEV4cHJlc3Npb25GYWN0b3J5IGZhY3RvcnksIENyaXRlcmlhUXVlcnlJbXBs\nPD8+IHEpIHsKICAgICAgICAgICAgcmV0dXJuIGZhY3RvcnkudG9Mb3dlckNh\nc2UoRXhwcmVzc2lvbnMudG9WYWx1ZShlLCBmYWN0b3J5LCBxKSk7CiAgICAg\nICAgfQogICAgICAgIAogICAgICAgIEBPdmVycmlkZQogICAgICAgIHB1Ymxp\nYyBTdHJpbmdCdWlsZGVyIGFzVmFsdWUoQWxpYXNDb250ZXh0IHEpIHsKICAg\nICAgICAgICAgcmV0dXJuIEV4cHJlc3Npb25zLmFzVmFsdWUocSwgIkxPV0VS\nIiwgT1BFTl9CUkFDRSwgZSwgQ0xPU0VfQlJBQ0UpOwogICAgICAgIH0KICAg\nIH0KCiAgICBwdWJsaWMgc3RhdGljIGNsYXNzIFVwcGVyIGV4dGVuZHMgVW5h\ncnlGdW5jdGlvbmFsRXhwcmVzc2lvbjxTdHJpbmc+IHsKICAgICAgICBwdWJs\naWMgVXBwZXIoRXhwcmVzc2lvbjxTdHJpbmc+IHgpIHsKICAgICAgICAgICAg\nc3VwZXIoU3RyaW5nLmNsYXNzLCB4KTsKICAgICAgICB9CiAgICAgICAgCiAg\nICAgICAgQE92ZXJyaWRlCiAgICAgICAgcHVibGljIFZhbHVlIHRvVmFsdWUo\nRXhwcmVzc2lvbkZhY3RvcnkgZmFjdG9yeSwgQ3JpdGVyaWFRdWVyeUltcGw8\nPz4gcSkgewogICAgICAgICAgICByZXR1cm4gZmFjdG9yeS50b1VwcGVyQ2Fz\nZShFeHByZXNzaW9ucy50b1ZhbHVlKGUsIGZhY3RvcnksIHEpKTsKICAgICAg\nICB9CiAgICAgICAgCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgcHVibGlj\nIFN0cmluZ0J1aWxkZXIgYXNWYWx1ZShBbGlhc0NvbnRleHQgcSkgewogICAg\nICAgICAgICByZXR1cm4gRXhwcmVzc2lvbnMuYXNWYWx1ZShxLCAiVVBQRVIi\nLCBPUEVOX0JSQUNFLCBlLCBDTE9TRV9CUkFDRSk7CiAgICAgICAgfQogICAg\nfQoKICAgIHB1YmxpYyBzdGF0aWMgY2xhc3MgTGVuZ3RoIGV4dGVuZHMgVW5h\ncnlGdW5jdGlvbmFsRXhwcmVzc2lvbjxJbnRlZ2VyPiB7CiAgICAgICAgcHVi\nbGljIExlbmd0aChFeHByZXNzaW9uPFN0cmluZz4geCkgewogICAgICAgICAg\nICBzdXBlcihJbnRlZ2VyLmNsYXNzLCB4KTsKICAgICAgICB9CiAgICAgICAg\nCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgcHVibGljIFZhbHVlIHRvVmFs\ndWUoRXhwcmVzc2lvbkZhY3RvcnkgZmFjdG9yeSwgQ3JpdGVyaWFRdWVyeUlt\ncGw8Pz4gcSkgewogICAgICAgICAgICByZXR1cm4gZmFjdG9yeS5zdHJpbmdM\nZW5ndGgoRXhwcmVzc2lvbnMudG9WYWx1ZShlLCBmYWN0b3J5LCBxKSk7CiAg\nICAgICAgfQogICAgICAgIAogICAgICAgIEBPdmVycmlkZQogICAgICAgIHB1\nYmxpYyBTdHJpbmdCdWlsZGVyIGFzVmFsdWUoQWxpYXNDb250ZXh0IHEpIHsK\nICAgICAgICAgICAgcmV0dXJuIEV4cHJlc3Npb25zLmFzVmFsdWUocSwgIkxF\nTkdUSCIsIE9QRU5fQlJBQ0UsIGUsIENMT1NFX0JSQUNFKTsKICAgICAgICB9\nCiAgICB9CiAgICAKICAgIHB1YmxpYyBzdGF0aWMgYWJzdHJhY3QgY2xhc3Mg\nU3VicXVlcnlQcmVkaWNhdGU8WD4gZXh0ZW5kcyBQcmVkaWNhdGVJbXBsIHsK\nICAgICAgICBmaW5hbCBTdWJxdWVyeUltcGw8WD4gZTsKICAgICAgICAKICAg\nICAgICBwdWJsaWMgU3VicXVlcnlQcmVkaWNhdGUoU3VicXVlcnk8WD4geCkg\newogICAgICAgICAgICBzdXBlcigpOwogICAgICAgICAgICBlID0gKFN1YnF1\nZXJ5SW1wbDxYPil4OwogICAgICAgIH0KICAgICAgICAKICAgICAgICBwdWJs\naWMgdm9pZCBhY2NlcHRWaXNpdChDcml0ZXJpYUV4cHJlc3Npb25WaXNpdG9y\nIHZpc2l0b3IpIHsKICAgICAgICAgICAgRXhwcmVzc2lvbnMuYWNjZXB0Vmlz\naXQodmlzaXRvciwgdGhpcywgZSk7CiAgICAgICAgfQogICAgfQogICAgIAog\nICAgcHVibGljIHN0YXRpYyBhYnN0cmFjdCBjbGFzcyBTdWJxdWVyeUV4cHJl\nc3Npb248WD4gZXh0ZW5kcyBFeHByZXNzaW9uSW1wbDxYPiB7CiAgICAgICAg\nZmluYWwgU3VicXVlcnlJbXBsPFg+IGU7CiAgICAgICAgCiAgICAgICAgcHVi\nbGljIFN1YnF1ZXJ5RXhwcmVzc2lvbihTdWJxdWVyeTxYPiB4KSB7CiAgICAg\nICAgICAgIHN1cGVyKChDbGFzczxYPil4LmdldEphdmFUeXBlKCkpOwogICAg\nICAgICAgICBlID0gKFN1YnF1ZXJ5SW1wbDxYPil4OwogICAgICAgIH0KICAg\nICAgICAKICAgICAgICBwdWJsaWMgdm9pZCBhY2NlcHRWaXNpdChDcml0ZXJp\nYUV4cHJlc3Npb25WaXNpdG9yIHZpc2l0b3IpIHsKICAgICAgICAgICAgRXhw\ncmVzc2lvbnMuYWNjZXB0VmlzaXQodmlzaXRvciwgdGhpcywgZSk7CiAgICAg\nICAgfQogICAgfQoKICAgIHB1YmxpYyBzdGF0aWMgY2xhc3MgRXhpc3RzPFg+\nIGV4dGVuZHMgU3VicXVlcnlQcmVkaWNhdGU8WD4gewogICAgICAgIHB1Ymxp\nYyBFeGlzdHMoU3VicXVlcnk8WD4geCkgewogICAgICAgICAgICBzdXBlcih4\nKTsKICAgICAgICB9CgogICAgICAgIEBPdmVycmlkZQogICAgICAgIG9yZy5h\ncGFjaGUub3BlbmpwYS5rZXJuZWwuZXhwcy5FeHByZXNzaW9uIHRvS2VybmVs\nRXhwcmVzc2lvbigKICAgICAgICAgICAgRXhwcmVzc2lvbkZhY3RvcnkgZmFj\ndG9yeSwgQ3JpdGVyaWFRdWVyeUltcGw8Pz4gcSkgewogICAgICAgICAgICBv\ncmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLmV4cHMuRXhwcmVzc2lvbiBleGlz\ndHMgPSAKICAgICAgICAgICAgICAgIGZhY3RvcnkuaXNOb3RFbXB0eShFeHBy\nZXNzaW9ucy50b1ZhbHVlKGUsIGZhY3RvcnksIHEpKTsKICAgICAgICAgICAg\ncmV0dXJuIGV4aXN0czsKICAgICAgICB9ICAgICAgICAKICAgICAgICAKICAg\nICAgICBAT3ZlcnJpZGUKICAgICAgICBwdWJsaWMgU3RyaW5nQnVpbGRlciBh\nc1ZhbHVlKEFsaWFzQ29udGV4dCBxKSB7CiAgICAgICAgICAgIHJldHVybiBF\neHByZXNzaW9ucy5hc1ZhbHVlKHEsICIgRVhJU1RTIiwgT1BFTl9CUkFDRSwg\nZSwgQ0xPU0VfQlJBQ0UpOwogICAgICAgIH0KICAgIH0KICAgIAogICAgcHVi\nbGljIHN0YXRpYyBjbGFzcyBBbGw8WD4gZXh0ZW5kcyBTdWJxdWVyeUV4cHJl\nc3Npb248WD4gewogICAgICAgIHB1YmxpYyBBbGwoU3VicXVlcnk8WD4geCkg\newogICAgICAgICAgICBzdXBlcih4KTsKICAgICAgICB9CiAgICAgICAgCiAg\nICAgICAgQE92ZXJyaWRlCiAgICAgICAgcHVibGljIFZhbHVlIHRvVmFsdWUo\nRXhwcmVzc2lvbkZhY3RvcnkgZmFjdG9yeSwgQ3JpdGVyaWFRdWVyeUltcGw8\nPz4gcSkgewogICAgICAgICAgICByZXR1cm4gZmFjdG9yeS5hbGwoRXhwcmVz\nc2lvbnMudG9WYWx1ZShlLCBmYWN0b3J5LCBxKSk7CiAgICAgICAgfQogICAg\nICAgIAogICAgICAgIEBPdmVycmlkZQogICAgICAgIHB1YmxpYyBTdHJpbmdC\ndWlsZGVyIGFzVmFsdWUoQWxpYXNDb250ZXh0IHEpIHsKICAgICAgICAgICAg\ncmV0dXJuIEV4cHJlc3Npb25zLmFzVmFsdWUocSwgIkFMTCIsIE9QRU5fQlJB\nQ0UsIGUsIENMT1NFX0JSQUNFKTsKICAgICAgICB9CiAgICB9CgogICAgcHVi\nbGljIHN0YXRpYyBjbGFzcyBBbnk8WD4gZXh0ZW5kcyBTdWJxdWVyeUV4cHJl\nc3Npb248WD4gewogICAgICAgIHB1YmxpYyBBbnkoU3VicXVlcnk8WD4geCkg\newogICAgICAgICAgICBzdXBlcih4KTsKICAgICAgICB9CiAgICAgICAgCiAg\nICAgICAgQE92ZXJyaWRlCiAgICAgICAgcHVibGljIFZhbHVlIHRvVmFsdWUo\nRXhwcmVzc2lvbkZhY3RvcnkgZmFjdG9yeSwgQ3JpdGVyaWFRdWVyeUltcGw8\nPz4gcSkgewogICAgICAgICAgICByZXR1cm4gZmFjdG9yeS5hbnkoRXhwcmVz\nc2lvbnMudG9WYWx1ZShlLCBmYWN0b3J5LCBxKSk7CiAgICAgICAgfQogICAg\nICAgIAogICAgICAgIEBPdmVycmlkZQogICAgICAgIHB1YmxpYyBTdHJpbmdC\ndWlsZGVyIGFzVmFsdWUoQWxpYXNDb250ZXh0IHEpIHsKICAgICAgICAgICAg\ncmV0dXJuIEV4cHJlc3Npb25zLmFzVmFsdWUocSwgIkFOWSIsIE9QRU5fQlJB\nQ0UsIGUsIENMT1NFX0JSQUNFKTsKICAgICAgICB9CiAgICB9CgogICAgcHVi\nbGljIHN0YXRpYyBjbGFzcyBOb3QgZXh0ZW5kcyBQcmVkaWNhdGVJbXBsIHsK\nICAgICAgICBwcm90ZWN0ZWQgZmluYWwgRXhwcmVzc2lvbkltcGw8Qm9vbGVh\nbj4gZTsKICAgICAgICBwdWJsaWMgTm90KEV4cHJlc3Npb248Qm9vbGVhbj4g\nbmUpIHsKICAgICAgICAgICAgc3VwZXIoKTsKICAgICAgICAgICAgZSA9IChF\neHByZXNzaW9uSW1wbDxCb29sZWFuPiluZTsKICAgICAgICB9CiAgICAgICAg\nCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgcHVibGljIG9yZy5hcGFjaGUu\nb3BlbmpwYS5rZXJuZWwuZXhwcy5FeHByZXNzaW9uIHRvS2VybmVsRXhwcmVz\nc2lvbigKICAgICAgICAgIEV4cHJlc3Npb25GYWN0b3J5IGZhY3RvcnksIENy\naXRlcmlhUXVlcnlJbXBsPD8+IHEpIHsKICAgICAgICAgICAgcmV0dXJuIGZh\nY3Rvcnkubm90KGUudG9LZXJuZWxFeHByZXNzaW9uKGZhY3RvcnksIHEpKTsK\nICAgICAgICB9ICAgICAgICAKICAgICAgICAKICAgICAgICBwdWJsaWMgdm9p\nZCBhY2NlcHRWaXNpdChDcml0ZXJpYUV4cHJlc3Npb25WaXNpdG9yIHZpc2l0\nb3IpIHsKICAgICAgICAgICAgRXhwcmVzc2lvbnMuYWNjZXB0VmlzaXQodmlz\naXRvciwgdGhpcywgZSk7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIEBP\ndmVycmlkZQogICAgICAgIHB1YmxpYyBTdHJpbmdCdWlsZGVyIGFzVmFsdWUo\nQWxpYXNDb250ZXh0IHEpIHsKICAgICAgICAgICAgcmV0dXJuIEV4cHJlc3Np\nb25zLmFzVmFsdWUocSwgIk5PVCAiLCBlKTsKICAgICAgICB9CiAgICB9CiAg\nICAKICAgIHB1YmxpYyBzdGF0aWMgY2xhc3MgQ2FzdEFzPFk+IGV4dGVuZHMg\nRXhwcmVzc2lvbkltcGw8WT4gewogICAgICAgIHByb3RlY3RlZCBmaW5hbCBF\neHByZXNzaW9uSW1wbDw/PiBhY3R1YWw7CiAgICAgICAgcHVibGljIENhc3RB\ncyhDbGFzczxZPiBjYXN0LCBFeHByZXNzaW9uSW1wbDw/PiBhY3R1YWwpIHsK\nICAgICAgICAgICAgc3VwZXIoY2FzdCk7CiAgICAgICAgICAgIHRoaXMuYWN0\ndWFsID0gYWN0dWFsOwogICAgICAgIH0KICAgICAgICAKICAgICAgICBAT3Zl\ncnJpZGUKICAgICAgICBwdWJsaWMgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5l\nbC5leHBzLlZhbHVlIHRvVmFsdWUoCiAgICAgICAgICBFeHByZXNzaW9uRmFj\ndG9yeSBmYWN0b3J5LCBDcml0ZXJpYVF1ZXJ5SW1wbDw/PiBxKSB7CiAgICAg\nICAgICAgIG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuZXhwcy5WYWx1ZSBl\nID0gYWN0dWFsLnRvVmFsdWUoZmFjdG9yeSwgcSk7CiAgICAgICAgICAgIGUu\nc2V0SW1wbGljaXRUeXBlKGdldEphdmFUeXBlKCkpOwogICAgICAgICAgICBy\nZXR1cm4gZTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgcHVibGljIHZv\naWQgYWNjZXB0VmlzaXQoQ3JpdGVyaWFFeHByZXNzaW9uVmlzaXRvciB2aXNp\ndG9yKSB7CiAgICAgICAgICAgIEV4cHJlc3Npb25zLmFjY2VwdFZpc2l0KHZp\nc2l0b3IsIHRoaXMsIGFjdHVhbCk7CiAgICAgICAgfQogICAgICAgIAogICAg\nICAgIEBPdmVycmlkZQogICAgICAgIHB1YmxpYyBTdHJpbmdCdWlsZGVyIGFz\nVmFsdWUoQWxpYXNDb250ZXh0IHEpIHsKICAgICAgICAgICAgcmV0dXJuIGFj\ndHVhbC5hc1ZhbHVlKHEpOwogICAgICAgIH0KICAgIH0KICAgIAogICAgLyoq\nCiAgICAgKiBBbiBleHByZXNzaW9uIHRoYXQgaXMgY29tcG9zZWQgb2Ygb25l\nIG9yIG1vcmUgZXhwcmVzc2lvbnMuCiAgICAgKgogICAgICogQHBhcmFtIDxU\nPgogICAgICovCiAgICBwdWJsaWMgc3RhdGljIGNsYXNzIExpc3RBcmd1bWVu\ndDxUPiBleHRlbmRzIEV4cHJlc3Npb25JbXBsPFQ+IHsKICAgICAgICBwcml2\nYXRlIGZpbmFsIEV4cHJlc3Npb25JbXBsPD8+W10gX2FyZ3M7CiAgICAgICAg\ncHVibGljIExpc3RBcmd1bWVudChDbGFzczxUPiBjbHMsIEV4cHJlc3Npb25J\nbXBsPD8+Li4uIGFyZ3MpIHsKICAgICAgICAgICAgc3VwZXIoY2xzKTsKICAg\nICAgICAgICAgX2FyZ3MgPSBhcmdzOwogICAgICAgIH0KICAgICAgICAKICAg\nICAgICBAT3ZlcnJpZGUKICAgICAgICBwdWJsaWMgb3JnLmFwYWNoZS5vcGVu\nanBhLmtlcm5lbC5leHBzLkFyZ3VtZW50cyB0b1ZhbHVlKAogICAgICAgICAg\nRXhwcmVzc2lvbkZhY3RvcnkgZmFjdG9yeSwgQ3JpdGVyaWFRdWVyeUltcGw8\nPz4gcSkgewogICAgICAgICAgICBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVs\nLmV4cHMuVmFsdWVbXSBrdnMgPSBuZXcgb3JnLmFwYWNoZS5vcGVuanBhLmtl\ncm5lbC5leHBzLlZhbHVlW19hcmdzLmxlbmd0aF07CiAgICAgICAgICAgIGlu\ndCBpID0gMDsKICAgICAgICAgICAgZm9yIChFeHByZXNzaW9uSW1wbDw/PiBh\ncmcgOiBfYXJncykgewogICAgICAgICAgICAgICAga3ZzW2krK10gPSBhcmcu\ndG9WYWx1ZShmYWN0b3J5LCBxKTsKICAgICAgICAgICAgfQogICAgICAgICAg\nICBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLmV4cHMuQXJndW1lbnRzIGUg\nPSBmYWN0b3J5Lm5ld0FyZ3VtZW50TGlzdChrdnMpOwogICAgICAgICAgICBl\nLnNldEltcGxpY2l0VHlwZShnZXRKYXZhVHlwZSgpKTsKICAgICAgICAgICAg\ncmV0dXJuIGU7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIHB1YmxpYyB2\nb2lkIGFjY2VwdFZpc2l0KENyaXRlcmlhRXhwcmVzc2lvblZpc2l0b3Igdmlz\naXRvcikgewogICAgICAgICAgICBFeHByZXNzaW9ucy5hY2NlcHRWaXNpdCh2\naXNpdG9yLCB0aGlzLCBfYXJncyk7CiAgICAgICAgfQogICAgfQp9Cg==\n","encoding":"base64"}

