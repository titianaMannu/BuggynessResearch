{"sha":"827b55f0e3d9949f1317be57fa343b98b0210103","node_id":"MDQ6QmxvYjIwNjM2NDo4MjdiNTVmMGUzZDk5NDlmMTMxN2JlNTdmYTM0M2I5OGIwMjEwMTAz","size":26893,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/827b55f0e3d9949f1317be57fa343b98b0210103","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNr\nYWdlIG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5jcml0ZXJpYTsK\nCmltcG9ydCBqYXZheC5wZXJzaXN0ZW5jZS5jcml0ZXJpYS5BYnN0cmFjdFF1\nZXJ5OwppbXBvcnQgamF2YXgucGVyc2lzdGVuY2UuY3JpdGVyaWEuQ29sbGVj\ndGlvbkpvaW47CmltcG9ydCBqYXZheC5wZXJzaXN0ZW5jZS5jcml0ZXJpYS5F\neHByZXNzaW9uOwppbXBvcnQgamF2YXgucGVyc2lzdGVuY2UuY3JpdGVyaWEu\nSm9pbjsKaW1wb3J0IGphdmF4LnBlcnNpc3RlbmNlLmNyaXRlcmlhLkpvaW5U\neXBlOwppbXBvcnQgamF2YXgucGVyc2lzdGVuY2UuY3JpdGVyaWEuTGlzdEpv\naW47CmltcG9ydCBqYXZheC5wZXJzaXN0ZW5jZS5jcml0ZXJpYS5NYXBKb2lu\nOwppbXBvcnQgamF2YXgucGVyc2lzdGVuY2UuY3JpdGVyaWEuUGF0aDsKaW1w\nb3J0IGphdmF4LnBlcnNpc3RlbmNlLmNyaXRlcmlhLlBsdXJhbEpvaW47Cmlt\ncG9ydCBqYXZheC5wZXJzaXN0ZW5jZS5jcml0ZXJpYS5TZXRKb2luOwppbXBv\ncnQgamF2YXgucGVyc2lzdGVuY2UubWV0YW1vZGVsLkF0dHJpYnV0ZTsKaW1w\nb3J0IGphdmF4LnBlcnNpc3RlbmNlLm1ldGFtb2RlbC5Db2xsZWN0aW9uQXR0\ncmlidXRlOwppbXBvcnQgamF2YXgucGVyc2lzdGVuY2UubWV0YW1vZGVsLkxp\nc3RBdHRyaWJ1dGU7CmltcG9ydCBqYXZheC5wZXJzaXN0ZW5jZS5tZXRhbW9k\nZWwuTWFwQXR0cmlidXRlOwppbXBvcnQgamF2YXgucGVyc2lzdGVuY2UubWV0\nYW1vZGVsLlBsdXJhbEF0dHJpYnV0ZTsKaW1wb3J0IGphdmF4LnBlcnNpc3Rl\nbmNlLm1ldGFtb2RlbC5TZXRBdHRyaWJ1dGU7CmltcG9ydCBqYXZheC5wZXJz\naXN0ZW5jZS5tZXRhbW9kZWwuVHlwZTsKCmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEua2VybmVsLmV4cHMuQWJzdHJhY3RFeHByZXNzaW9uQnVpbGRlcjsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuZXhwcy5FeHByZXNz\naW9uRmFjdG9yeTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwu\nZXhwcy5WYWx1ZTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRhLkNs\nYXNzTWV0YURhdGE7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YS5G\naWVsZE1ldGFEYXRhOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEu\nSmF2YVR5cGVzOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNpc3Rl\nbmNlLm1ldGEuQWJzdHJhY3RNYW5hZ2VkVHlwZTsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5tZXRhLk1lbWJlcnM7CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UubWV0YS5NZW1iZXJzLktl\neUF0dHJpYnV0ZUltcGw7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEucGVy\nc2lzdGVuY2UubWV0YS5NZW1iZXJzLk1hcEF0dHJpYnV0ZUltcGw7CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UubWV0YS5NZW1iZXJz\nLk1lbWJlcjsKCi8qKgogKiBJbXBsZW1lbnRzIHN0cm9uZ2x5LXR5cGVkIEpv\naW4gZXhwcmVzc2lvbnMgdmlhIHNpbmd1bGFyIGFuZCBwbHVyYWwgYXR0cmli\ndXRlcy4KICogCiAqIEBhdXRob3IgRmF5IFdhbmcKICogQGF1dGhvciBQaW5h\na2kgUG9kZGFyCiAqIAogKiBAc2luY2UgMi4wLjAKICogCiAqLwphYnN0cmFj\ndCBjbGFzcyBKb2lucyB7CiAgIAogICAgLyoqCiAgICAgKiBKb2luIGEgc2lu\nZ2xlLXZhbHVlZCBhdHRyaWJ1dGUuCiAgICAgKiAKICAgICAqCiAgICAgKiBA\ncGFyYW0gPFo+IHR5cGUgZnJvbSB3aGljaCBqb2luaW5nCiAgICAgKiBAcGFy\nYW0gPFg+IHR5cGUgb2YgdGhlIGF0dHJpYnV0ZSBiZWluZyBqb2luZWQKICAg\nICAqLwogICAgc3RhdGljIGNsYXNzIFNpbmd1bGFySm9pbjxaLFg+IGV4dGVu\nZHMgRnJvbUltcGw8WixYPiBpbXBsZW1lbnRzIEpvaW48WixYPiB7CiAgICAg\nICAgcHJpdmF0ZSBmaW5hbCBKb2luVHlwZSBqb2luVHlwZTsKICAgICAgICBw\ncml2YXRlIGJvb2xlYW4gYWxsb3dOdWxsID0gZmFsc2U7CiAgICAgICAgCiAg\nICAgICAgcHVibGljIFNpbmd1bGFySm9pbihGcm9tSW1wbDw/LFo+IGZyb20s\nIE1lbWJlcnMuU2luZ3VsYXJBdHRyaWJ1dGVJbXBsPD8gc3VwZXIgWiwgWD4g\nbWVtYmVyLCBKb2luVHlwZSBqdCkgewogICAgICAgICAgICBzdXBlcihmcm9t\nLCBtZW1iZXIsIG1lbWJlci5nZXRKYXZhVHlwZSgpKTsKICAgICAgICAgICAg\nam9pblR5cGUgPSBqdDsKICAgICAgICAgICAgYWxsb3dOdWxsID0gam9pblR5\ncGUgIT0gSm9pblR5cGUuSU5ORVI7CiAgICAgICAgfQogICAgICAgIAogICAg\nICAgIHB1YmxpYyBKb2luVHlwZSBnZXRKb2luVHlwZSgpIHsKICAgICAgICAg\nICAgcmV0dXJuIGpvaW5UeXBlOwogICAgICAgIH0KCiAgICAgICAgcHVibGlj\nIEZyb21JbXBsPD8sIFo+IGdldFBhcmVudCgpIHsKICAgICAgICAgICAgcmV0\ndXJuIChGcm9tSW1wbDw/LCBaPikgX3BhcmVudDsKICAgICAgICB9CiAgICAg\nICAgCiAgICAgICAgcHVibGljIE1lbWJlcjw/IGV4dGVuZHMgWiwgWD4gZ2V0\nTWVtYmVyKCkgewogICAgICAgICAgICByZXR1cm4gKE1lbWJlcjw/IGV4dGVu\nZHMgWiwgWD4pIF9tZW1iZXI7CiAgICAgICAgfQogICAgICAgIAogICAgICAg\nIC8qKgogICAgICAgICAqIFJldHVybiB0aGUgbWV0YW1vZGVsIGF0dHJpYnV0\nZSBjb3JyZXNwb25kaW5nIHRvIHRoZSBqb2luLgogICAgICAgICAqIEByZXR1\ncm4gbWV0YW1vZGVsIGF0dHJpYnV0ZSB0eXBlIGNvcnJlc3BvbmRpbmcgdG8g\ndGhlIGpvaW4KICAgICAgICAgKi8KICAgICAgICBwdWJsaWMgQXR0cmlidXRl\nPD8gc3VwZXIgWiwgPz4gZ2V0QXR0cmlidXRlKCkgewogICAgICAgICAgICBy\nZXR1cm4gIChBdHRyaWJ1dGU8PyBzdXBlciBaLCA/PiApX21lbWJlcjsKICAg\nICAgICB9CiAgICAgICAgCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgcHVi\nbGljIFZhbHVlIHRvVmFsdWUoRXhwcmVzc2lvbkZhY3RvcnkgZmFjdG9yeSwg\nQ3JpdGVyaWFRdWVyeUltcGw8Pz4gYykgewogICAgICAgICAgICBDbGFzc01l\ndGFEYXRhIG1ldGEgPSBfbWVtYmVyLmZtZC5nZXREZWNsYXJlZFR5cGVNZXRh\nRGF0YSgpOwogICAgICAgICAgICBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVs\nLmV4cHMuUGF0aCBwYXRoID0gbnVsbDsKICAgICAgICAgICAgU3VicXVlcnlJ\nbXBsPD8+IHN1YnF1ZXJ5ID0gYy5nZXREZWxlZ2F0b3IoKTsKICAgICAgICAg\nICAgUGF0aEltcGw8Pyw/PiBwYXJlbnQgPSBnZXRJbm5lcm1vc3RQYXJlbnRQ\nYXRoKCk7CiAgICAgICAgICAgIFZhbHVlIHZhbCA9IGMuZ2V0UmVnaXN0ZXJl\nZFZhbHVlKHRoaXMpOwogICAgICAgICAgICBpZiAodmFsICE9IG51bGwpCiAg\nICAgICAgICAgICAgICByZXR1cm4gdmFsOwogICAgICAgICAgICBlbHNlIGlm\nIChwYXJlbnQuaW5TdWJxdWVyeShzdWJxdWVyeSkpIHsKICAgICAgICAgICAg\nICAgIG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuZXhwcy5TdWJxdWVyeSBz\ndWJRID0gc3VicXVlcnkuZ2V0U3ViUSgpOwogICAgICAgICAgICAgICAgcGF0\naCA9IGZhY3RvcnkubmV3UGF0aChzdWJRKTsKICAgICAgICAgICAgICAgIHBh\ndGguc2V0TWV0YURhdGEoc3ViUS5nZXRNZXRhRGF0YSgpKTsKICAgICAgICAg\nICAgICAgIHBhdGguc2V0U2NoZW1hQWxpYXMoYy5nZXRBbGlhcyh0aGlzKSk7\nCiAgICAgICAgICAgICAgICBwYXRoLmdldChfbWVtYmVyLmZtZCwgYWxsb3dO\ndWxsKTsgCiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBw\nYXRoID0gKG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuZXhwcy5QYXRoKSBf\ncGFyZW50LnRvVmFsdWUoZmFjdG9yeSwgYyk7CiAgICAgICAgICAgICAgICBw\nYXRoLmdldChfbWVtYmVyLmZtZCwgYWxsb3dOdWxsKTsKICAgICAgICAgICAg\nICAgIHBhdGguc2V0TWV0YURhdGEobWV0YSk7CiAgICAgICAgICAgICAgICBw\nYXRoLnNldEltcGxpY2l0VHlwZShtZXRhLmdldERlc2NyaWJlZFR5cGUoKSk7\nCiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIHBhdGg7CiAgICAg\nICAgfQogICAgICAgIAogICAgICAgIEBPdmVycmlkZQogICAgICAgIHB1Ymxp\nYyBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLmV4cHMuRXhwcmVzc2lvbiB0\nb0tlcm5lbEV4cHJlc3Npb24oRXhwcmVzc2lvbkZhY3RvcnkgZmFjdG9yeSwg\nCiAgICAgICAgICAgIENyaXRlcmlhUXVlcnlJbXBsPD8+IGMpIHsKICAgICAg\nICAgICAgQ2xhc3NNZXRhRGF0YSBtZXRhID0gX21lbWJlci5mbWQuZ2V0RGVj\nbGFyZWRUeXBlTWV0YURhdGEoKTsKICAgICAgICAgICAgb3JnLmFwYWNoZS5v\ncGVuanBhLmtlcm5lbC5leHBzLlBhdGggcGF0aCA9IG51bGw7CiAgICAgICAg\nICAgIFN1YnF1ZXJ5SW1wbDw/PiBzdWJxdWVyeSA9IGMuZ2V0RGVsZWdhdG9y\nKCk7CiAgICAgICAgICAgIFBhdGhJbXBsPD8sPz4gcGFyZW50ID0gZ2V0SW5u\nZXJtb3N0UGFyZW50UGF0aCgpOwogICAgICAgICAgICBvcmcuYXBhY2hlLm9w\nZW5qcGEua2VybmVsLmV4cHMuRXhwcmVzc2lvbiBmaWx0ZXIgPSBudWxsOwog\nICAgICAgICAgICBQYXRoSW1wbDw/LD8+IGNvcnJlbGF0ZWRQYXJlbnRQYXRo\nID0gbnVsbDsKICAgICAgICAgICAgYm9vbGVhbiBiaW5kID0gdHJ1ZTsKICAg\nICAgICAgICAgamF2YS51dGlsLkxpc3Q8Sm9pbjw/LD8+PiBjb3JySm9pbnMg\nPSBudWxsOwogICAgICAgICAgICBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVs\nLmV4cHMuRXhwcmVzc2lvbiBqb2luID0gbnVsbDsKICAgICAgICAgICAgaWYg\nKCFpc0NvcnJlbGF0ZWQoKSkgewogICAgICAgICAgICAgICAgaWYgKHN1YnF1\nZXJ5ICE9IG51bGwpIHsKICAgICAgICAgICAgICAgICAgICBjb3JySm9pbnMg\nPSBzdWJxdWVyeS5nZXRDb3JyZWxhdGVkSm9pbnMoKTsKICAgICAgICAgICAg\nICAgICAgICBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLmV4cHMuU3VicXVl\ncnkgc3ViUSA9IHN1YnF1ZXJ5LmdldFN1YlEoKTsKICAgICAgICAgICAgICAg\nICAgICBpZiAoKGNvcnJKb2lucyAhPSBudWxsICYmIGNvcnJKb2lucy5jb250\nYWlucyhfcGFyZW50KSkgfHwgCiAgICAgICAgICAgICAgICAgICAgICAgIChj\nb3JySm9pbnMgPT0gbnVsbCAmJiBwYXJlbnQuaW5TdWJxdWVyeShzdWJxdWVy\neSkgJiYgX3BhcmVudC5nZXRDb3JyZWxhdGVkUGF0aCgpICE9IG51bGwpKSB7\nIAogICAgICAgICAgICAgICAgICAgICAgICBwYXRoID0gZmFjdG9yeS5uZXdQ\nYXRoKHN1YlEpOwogICAgICAgICAgICAgICAgICAgICAgICBjb3JyZWxhdGVk\nUGFyZW50UGF0aCA9IF9wYXJlbnQuZ2V0Q29ycmVsYXRlZFBhdGgoKTsKICAg\nICAgICAgICAgICAgICAgICAgICAgYmluZCA9IGZhbHNlOwogICAgICAgICAg\nICAgICAgICAgIH0gZWxzZSB7IAogICAgICAgICAgICAgICAgICAgICAgICBp\nZiAoYy5pc1JlZ2lzdGVyZWQoX3BhcmVudCkpIHsgCiAgICAgICAgICAgICAg\nICAgICAgICAgICAgICBWYWx1ZSB2YXIgPSBjLmdldFJlZ2lzdGVyZWRWYXJp\nYWJsZShfcGFyZW50KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBh\ndGggPSBmYWN0b3J5Lm5ld1BhdGgodmFyKTsKICAgICAgICAgICAgICAgICAg\nICAgICAgfSBlbHNlIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgcGF0\naCA9IGZhY3RvcnkubmV3UGF0aChzdWJRKTsKICAgICAgICAgICAgICAgICAg\nICAgICAgcGF0aC5zZXRNZXRhRGF0YShtZXRhKTsKICAgICAgICAgICAgICAg\nICAgICAgICAgcGF0aC5nZXQoX21lbWJlci5mbWQsIGZhbHNlKTsKICAgICAg\nICAgICAgICAgICAgICAgICAgcGF0aC5zZXRTY2hlbWFBbGlhcyhjLmdldEFs\naWFzKF9wYXJlbnQpKTsKICAgICAgICAgICAgICAgICAgICB9IAogICAgICAg\nICAgICAgICAgfSBlbHNlIGlmIChjLmlzUmVnaXN0ZXJlZChfcGFyZW50KSkg\newogICAgICAgICAgICAgICAgICAgIFZhbHVlIHZhciA9IGMuZ2V0UmVnaXN0\nZXJlZFZhcmlhYmxlKF9wYXJlbnQpOwogICAgICAgICAgICAgICAgICAgIHBh\ndGggPSBmYWN0b3J5Lm5ld1BhdGgodmFyKTsKICAgICAgICAgICAgICAgICAg\nICBwYXRoLnNldE1ldGFEYXRhKG1ldGEpOwogICAgICAgICAgICAgICAgICAg\nIHBhdGguZ2V0KF9tZW1iZXIuZm1kLCBmYWxzZSk7CiAgICAgICAgICAgICAg\nICB9IGVsc2UgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICBwYXRo\nID0gKG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuZXhwcy5QYXRoKXRvVmFs\ndWUoZmFjdG9yeSwgYyk7CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAg\nICAgIENsYXNzPD8+IHR5cGUgPSBtZXRhID09IG51bGwgPyBBYnN0cmFjdEV4\ncHJlc3Npb25CdWlsZGVyLlRZUEVfT0JKRUNUIDogbWV0YS5nZXREZXNjcmli\nZWRUeXBlKCk7CiAgICAgICAgICAgICAgICBWYWx1ZSB2YXIgPSBudWxsOwog\nICAgICAgICAgICAgICAgaWYgKGJpbmQpIHsKICAgICAgICAgICAgICAgICAg\nICB2YXIgPSBmYWN0b3J5Lm5ld0JvdW5kVmFyaWFibGUoYy5nZXRBbGlhcyh0\naGlzKSx0eXBlKTsKICAgICAgICAgICAgICAgICAgICBqb2luID0gZmFjdG9y\neS5iaW5kVmFyaWFibGUodmFyLCBwYXRoKTsKICAgICAgICAgICAgICAgICAg\nICBjLnJlZ2lzdGVyVmFyaWFibGUodGhpcywgdmFyLCBwYXRoKTsKICAgICAg\nICAgICAgICAgIH0KICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAg\naWYgKCFfbWVtYmVyLmZtZC5pc1R5cGVQQygpKSB7IC8vIG11bHRpLXZhbHVl\nZCByZWxhdGlvbgogICAgICAgICAgICAgICAgICAgIHNldEltcGxpY2l0Q29u\ndGFpbnNUeXBlcyhwYXRoLCB2YXIsIEFic3RyYWN0RXhwcmVzc2lvbkJ1aWxk\nZXIuQ09OVEFJTlNfVFlQRV9FTEVNRU5UKTsKICAgICAgICAgICAgICAgICAg\nICBqb2luID0gZmFjdG9yeS5jb250YWlucyhwYXRoLCB2YXIpOwogICAgICAg\nICAgICAgICAgfSAgICAgICAgICAgICAgICAKICAgICAgICAgICAgfQogICAg\nICAgICAgICBpZiAoZ2V0Sm9pbnMoKSAhPSBudWxsKSB7CiAgICAgICAgICAg\nICAgICBmb3IgKEpvaW48PywgPz4gam9pbjEgOiBnZXRKb2lucygpKSB7CiAg\nICAgICAgICAgICAgICAgICAgZmlsdGVyID0gRXhwcmVzc2lvbnMuYW5kKGZh\nY3RvcnksIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICgoRnJvbUlt\ncGw8Pyw/Pilqb2luMSkudG9LZXJuZWxFeHByZXNzaW9uKGZhY3RvcnksIGMp\nLCBmaWx0ZXIpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAg\nICAgICAgICAgIG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuZXhwcy5FeHBy\nZXNzaW9uIGV4cHIgPSBFeHByZXNzaW9ucy5hbmQoZmFjdG9yeSwgam9pbiwg\nZmlsdGVyKTsKICAgICAgICAgICAgCiAgICAgICAgICAgIGlmIChjb3JyZWxh\ndGVkUGFyZW50UGF0aCA9PSBudWxsKSB7CiAgICAgICAgICAgICAgICByZXR1\ncm4gZXhwcjsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAg\nIG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuZXhwcy5QYXRoIHBhcmVudFBh\ndGggPSBudWxsOwogICAgICAgICAgICAgICAgaWYgKGNvcnJKb2lucyAhPSBu\ndWxsICYmIGNvcnJKb2lucy5jb250YWlucyhfcGFyZW50KSkgewogICAgICAg\nICAgICAgICAgICAgIFZhbHVlIHZhciA9IGdldFZhcmlhYmxlRm9yQ29yclBh\ndGgoc3VicXVlcnksIGNvcnJlbGF0ZWRQYXJlbnRQYXRoKTsKICAgICAgICAg\nICAgICAgICAgICBwYXJlbnRQYXRoID0gZmFjdG9yeS5uZXdQYXRoKHZhcik7\nCiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAg\nIHBhcmVudFBhdGggPSAob3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5leHBz\nLlBhdGgpY29ycmVsYXRlZFBhcmVudFBhdGgudG9WYWx1ZShmYWN0b3J5LCBj\nKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHBhcmVudFBh\ndGguZ2V0KF9tZW1iZXIuZm1kLCBhbGxvd051bGwpOwogICAgICAgICAgICAg\nICAgcGFyZW50UGF0aC5zZXRTY2hlbWFBbGlhcyhjLmdldEFsaWFzKGNvcnJl\nbGF0ZWRQYXJlbnRQYXRoKSk7CiAgICAgICAgICAgICAgICBpZiAoYy5jdHgo\nKS5nZXRQYXJlbnQoKSAhPSBudWxsICYmIGMuY3R4KCkuZ2V0VmFyaWFibGUo\ncGFyZW50UGF0aC5nZXRTY2hlbWFBbGlhcygpKSA9PSBudWxsKSAKICAgICAg\nICAgICAgICAgICAgICBwYXJlbnRQYXRoLnNldFN1YnF1ZXJ5Q29udGV4dChj\nLmN0eCgpLCBwYXJlbnRQYXRoLmdldFNjaGVtYUFsaWFzKCkpOwogICAgICAg\nICAgICAgICAgCiAgICAgICAgICAgICAgICBwYXRoLnNldE1ldGFEYXRhKG1l\ndGEpOwogICAgICAgICAgICAgICAgLy9maWx0ZXIgPSBiaW5kVmFyaWFibGVG\nb3JLZXlQYXRoKHBhdGgsIGFsaWFzLCBmaWx0ZXIpOwogICAgICAgICAgICAg\nICAgZmlsdGVyID0gZmFjdG9yeS5lcXVhbChwYXJlbnRQYXRoLCBwYXRoKTsK\nICAgICAgICAgICAgICAgIHJldHVybiBFeHByZXNzaW9ucy5hbmQoZmFjdG9y\neSwgZXhwciwgZmlsdGVyKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAg\nICAgICAKICAgICAgICBwcml2YXRlIFZhbHVlIGdldFZhcmlhYmxlRm9yQ29y\nclBhdGgoU3VicXVlcnlJbXBsPD8+IHN1YnF1ZXJ5LCBQYXRoSW1wbDw/LD8+\nIHBhdGgpIHsKICAgICAgICAgICAgQWJzdHJhY3RRdWVyeTw/PiBwYXJlbnQg\nPSBzdWJxdWVyeS5nZXRQYXJlbnQoKTsKICAgICAgICAgICAgaWYgKHBhcmVu\ndCBpbnN0YW5jZW9mIENyaXRlcmlhUXVlcnlJbXBsKSB7CiAgICAgICAgICAg\nICAgICByZXR1cm4gKChDcml0ZXJpYVF1ZXJ5SW1wbDw/PilwYXJlbnQpLmdl\ndFJlZ2lzdGVyZWRWYXJpYWJsZShwYXRoKTsKICAgICAgICAgICAgfQogICAg\nICAgICAgICBWYWx1ZSB2YXIgPSAoKFN1YnF1ZXJ5SW1wbDw/PilwYXJlbnQp\nLmdldERlbGVnYXRlKCkuZ2V0UmVnaXN0ZXJlZFZhcmlhYmxlKHBhdGgpOyAK\nICAgICAgICAgICAgaWYgKHZhciAhPSBudWxsKQogICAgICAgICAgICAgICAg\ncmV0dXJuIHZhcjsKICAgICAgICAgICAgcmV0dXJuIGdldFZhcmlhYmxlRm9y\nQ29yclBhdGgoKFN1YnF1ZXJ5SW1wbDw/PilwYXJlbnQsIHBhdGgpOwogICAg\nICAgIH0KICAgICAgICAKICAgICAgICAvKioKICAgICAgICAgKiBTZXQgdGhl\nIGltcGxpY2l0IHR5cGVzIG9mIHRoZSBnaXZlbiB2YWx1ZXMgYmFzZWQgb24g\ndGhlIGZhY3QgdGhhdAogICAgICAgICAqIHRoZSBmaXJzdCBpcyBzdXBwb3Nl\nZCB0byBjb250YWluIHRoZSBzZWNvbmQuCiAgICAgICAgICovCiAgICAgICAg\ncHVibGljIHZvaWQgc2V0SW1wbGljaXRDb250YWluc1R5cGVzKFZhbHVlIHZh\nbDEsIFZhbHVlIHZhbDIsIGludCBvcCkgewogICAgICAgICAgICBpZiAodmFs\nMS5nZXRUeXBlKCkgPT0gQWJzdHJhY3RFeHByZXNzaW9uQnVpbGRlci5UWVBF\nX09CSkVDVCkgewogICAgICAgICAgICAgICAgaWYgKG9wID09IEFic3RyYWN0\nRXhwcmVzc2lvbkJ1aWxkZXIuQ09OVEFJTlNfVFlQRV9FTEVNRU5UKQogICAg\nICAgICAgICAgICAgICAgIHZhbDEuc2V0SW1wbGljaXRUeXBlKENvbGxlY3Rp\nb24uY2xhc3MpOwogICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAg\nICAgICAgIHZhbDEuc2V0SW1wbGljaXRUeXBlKE1hcC5jbGFzcyk7CiAgICAg\nICAgICAgIH0KCiAgICAgICAgICAgIGlmICh2YWwyLmdldFR5cGUoKSA9PSBB\nYnN0cmFjdEV4cHJlc3Npb25CdWlsZGVyLlRZUEVfT0JKRUNUICYmIHZhbDEg\naW5zdGFuY2VvZiBQYXRoKSB7CiAgICAgICAgICAgICAgICBGaWVsZE1ldGFE\nYXRhIGZtZCA9ICgob3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5leHBzLlBh\ndGgpIHZhbDEpLmxhc3QoKTsKICAgICAgICAgICAgICAgIENsYXNzTWV0YURh\ndGEgbWV0YTsKICAgICAgICAgICAgICAgIGlmIChmbWQgIT0gbnVsbCkgewog\nICAgICAgICAgICAgICAgICAgIGlmIChvcCA9PSBBYnN0cmFjdEV4cHJlc3Np\nb25CdWlsZGVyLkNPTlRBSU5TX1RZUEVfRUxFTUVOVCB8fCAKICAgICAgICAg\nICAgICAgICAgICAgICAgb3AgPT0gQWJzdHJhY3RFeHByZXNzaW9uQnVpbGRl\nci5DT05UQUlOU19UWVBFX1ZBTFVFKSB7CiAgICAgICAgICAgICAgICAgICAg\nICAgIHZhbDIuc2V0SW1wbGljaXRUeXBlKGZtZC5nZXRFbGVtZW50KCkuZ2V0\nRGVjbGFyZWRUeXBlKCkpOwogICAgICAgICAgICAgICAgICAgICAgICBtZXRh\nID0gZm1kLmdldEVsZW1lbnQoKS5nZXREZWNsYXJlZFR5cGVNZXRhRGF0YSgp\nOwogICAgICAgICAgICAgICAgICAgICAgICBpZiAobWV0YSAhPSBudWxsKSB7\nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWwyLnNldE1ldGFEYXRh\nKG1ldGEpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAg\nICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgdmFs\nMi5zZXRJbXBsaWNpdFR5cGUoZm1kLmdldEtleSgpLmdldERlY2xhcmVkVHlw\nZSgpKTsKICAgICAgICAgICAgICAgICAgICAgICAgbWV0YSA9IGZtZC5nZXRL\nZXkoKS5nZXREZWNsYXJlZFR5cGVNZXRhRGF0YSgpOwogICAgICAgICAgICAg\nICAgICAgICAgICBpZiAobWV0YSAhPSBudWxsKSB7CiAgICAgICAgICAgICAg\nICAgICAgICAgICAgICB2YWwyLnNldE1ldGFEYXRhKG1ldGEpOwogICAgICAg\nICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAg\nICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAg\nIAogICAgICAgIEBPdmVycmlkZQogICAgICAgIHB1YmxpYyBTdHJpbmdCdWls\nZGVyIGFzVmFyaWFibGUoQWxpYXNDb250ZXh0IHEpIHsKICAgICAgICAgICAg\ncmV0dXJuIG5ldyBTdHJpbmdCdWlsZGVyKCIgIiArIGpvaW5UeXBlICsgIiBK\nT0lOICIpLmFwcGVuZChzdXBlci5hc1ZhcmlhYmxlKHEpKTsKICAgICAgICB9\nCiAgICB9CiAgICAKICAgIC8qKgogICAgICogSm9pbiBhIHBsdXJhbCBhdHRy\naWJ1dGUuCiAgICAgKiAKICAgICAqIEBwYXJhbSBaIHR5cGUgYmVpbmcgam9p\nbmVkIGZyb20KICAgICAqIEBwYXJhbSBDIEphdmEgY29sbGVjdGlvbiB0eXBl\nIG9mIHRoZSBjb250YWluZXIKICAgICAqIEBwYXJhbSBFIHR5cGUgb2YgdGhl\nIGVsZW1lbnQgYmVpbmcgam9pbmVkIHRvCiAgICAgKiAKICAgICAqLwogICAg\nc3RhdGljIGFic3RyYWN0IGNsYXNzIEFic3RyYWN0Q29sbGVjdGlvbjxaLEMs\nRT4gZXh0ZW5kcyBGcm9tSW1wbDxaLEU+IGltcGxlbWVudHMgUGx1cmFsSm9p\nbjxaLCBDLCBFPiB7CiAgICAgICAgcHJpdmF0ZSBmaW5hbCBKb2luVHlwZSBq\nb2luVHlwZTsKICAgICAgICBwcml2YXRlIGJvb2xlYW4gYWxsb3dOdWxsID0g\nZmFsc2U7CiAgICAgICAgCiAgICAgICAgcHVibGljIEFic3RyYWN0Q29sbGVj\ndGlvbihGcm9tSW1wbDw/LFo+IGZyb20sIE1lbWJlcnMuUGx1cmFsQXR0cmli\ndXRlSW1wbDw/IHN1cGVyIFosIEMsIEU+IG1lbWJlciwgCiAgICAgICAgICAg\nIEpvaW5UeXBlIGp0KSB7CiAgICAgICAgICAgIHN1cGVyKGZyb20sIG1lbWJl\nciwgbWVtYmVyLmdldEJpbmRhYmxlSmF2YVR5cGUoKSk7CiAgICAgICAgICAg\nIGpvaW5UeXBlID0ganQ7CiAgICAgICAgICAgIGFsbG93TnVsbCA9IGpvaW5U\neXBlICE9IEpvaW5UeXBlLklOTkVSOwogICAgICAgIH0KICAgICAgICAKICAg\nICAgICBwdWJsaWMgZmluYWwgSm9pblR5cGUgZ2V0Sm9pblR5cGUoKSB7CiAg\nICAgICAgICAgIHJldHVybiBqb2luVHlwZTsKICAgICAgICB9CgogICAgICAg\nIC8qKgogICAgICAgICAqIEdldHMgdGhlIHBhcmVudCBvZiB0aGlzIGpvaW4u\nCiAgICAgICAgICovCiAgICAgICAgcHVibGljIGZpbmFsIEZyb21JbXBsPD8s\nIFo+IGdldFBhcmVudCgpIHsKICAgICAgICAgICAgcmV0dXJuIChGcm9tSW1w\nbDw/LCBaPikgX3BhcmVudDsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAg\ncHVibGljIEF0dHJpYnV0ZTw/IHN1cGVyIFosIEU+IGdldEF0dHJpYnV0ZSgp\nIHsKICAgICAgICAgICAgcmV0dXJuIChNZW1iZXI8PyBzdXBlciBaLCBFPilf\nbWVtYmVyOwogICAgICAgIH0KICAgICAgICAKICAgICAgICBwdWJsaWMgUGx1\ncmFsQXR0cmlidXRlPD8gc3VwZXIgWiwgQywgRT4gZ2V0TW9kZWwoKSB7CiAg\nICAgICAgICAgIHJldHVybiAoUGx1cmFsQXR0cmlidXRlPD8gc3VwZXIgWiwg\nQywgRT4pIF9tZW1iZXIuZ2V0VHlwZSgpOwogICAgICAgIH0KICAgICAgICAK\nICAgICAgICBwdWJsaWMgQ2xhc3NNZXRhRGF0YSBnZXRNZW1iZXJDbGFzc01l\ndGFEYXRhKCkgewogICAgICAgICAgICByZXR1cm4gX21lbWJlci5mbWQuaXNF\nbGVtZW50Q29sbGVjdGlvbigpIAogICAgICAgICAgICAgICAgPyBfbWVtYmVy\nLmZtZC5nZXRFbGVtZW50KCkuZ2V0RW1iZWRkZWRNZXRhRGF0YSgpCiAgICAg\nICAgICAgICAgICA6IF9tZW1iZXIuZm1kLmdldEVsZW1lbnQoKS5nZXREZWNs\nYXJlZFR5cGVNZXRhRGF0YSgpOwogICAgICAgIH0KCiAgICAgICAgLyoqCiAg\nICAgICAgICogQ29udmVydCB0aGlzIHBhdGggdG8gYSBrZXJuZWwgcGF0aCAo\ndmFsdWUpLgogICAgICAgICAqLwogICAgICAgIEBPdmVycmlkZQogICAgICAg\nIHB1YmxpYyBWYWx1ZSB0b1ZhbHVlKEV4cHJlc3Npb25GYWN0b3J5IGZhY3Rv\ncnksIENyaXRlcmlhUXVlcnlJbXBsPD8+IGMpIHsKICAgICAgICAgICAgb3Jn\nLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5leHBzLlBhdGggcGF0aCA9IG51bGw7\nCiAgICAgICAgICAgIFN1YnF1ZXJ5SW1wbDw/PiBzdWJxdWVyeSA9IGMuZ2V0\nRGVsZWdhdG9yKCk7CiAgICAgICAgICAgIFBhdGhJbXBsPD8sPz4gcGFyZW50\nID0gZ2V0SW5uZXJtb3N0UGFyZW50UGF0aCgpOwogICAgICAgICAgICAKICAg\nICAgICAgICAgVmFsdWUgdmFyID0gYy5nZXRSZWdpc3RlcmVkVmFyaWFibGUo\ndGhpcyk7CiAgICAgICAgICAgIGlmICh2YXIgIT0gbnVsbCkgewogICAgICAg\nICAgICAgICAgIHBhdGggPSBmYWN0b3J5Lm5ld1BhdGgodmFyKTsKICAgICAg\nICAgICAgfSBlbHNlIGlmIChwYXJlbnQuaW5TdWJxdWVyeShzdWJxdWVyeSkp\nIHsKICAgICAgICAgICAgICAgIG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwu\nZXhwcy5TdWJxdWVyeSBzdWJRID0gc3VicXVlcnkuZ2V0U3ViUSgpOwogICAg\nICAgICAgICAgICAgcGF0aCA9IGZhY3RvcnkubmV3UGF0aChzdWJRKTsKICAg\nICAgICAgICAgICAgIHBhdGguc2V0TWV0YURhdGEoc3ViUS5nZXRNZXRhRGF0\nYSgpKTsKICAgICAgICAgICAgICAgIHBhdGguc2V0U2NoZW1hQWxpYXMoYy5n\nZXRBbGlhcyh0aGlzKSk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAg\nICAgICAgICBwYXRoID0gKG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuZXhw\ncy5QYXRoKSBfcGFyZW50LnRvVmFsdWUoZmFjdG9yeSwgYyk7CiAgICAgICAg\nICAgICAgICBwYXRoLmdldChfbWVtYmVyLmZtZCwgYWxsb3dOdWxsKTsKICAg\nICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gcGF0aDsKICAgICAgICB9\nCgogICAgICAgIC8qKgogICAgICAgICAqIENvbnZlcnQgdGhpcyBwYXRoIHRv\nIGEgam9pbiBleHByZXNzaW9uLgogICAgICAgICAqIAogICAgICAgICAqLwog\nICAgICAgIEBPdmVycmlkZQogICAgICAgIHB1YmxpYyBvcmcuYXBhY2hlLm9w\nZW5qcGEua2VybmVsLmV4cHMuRXhwcmVzc2lvbiB0b0tlcm5lbEV4cHJlc3Np\nb24oRXhwcmVzc2lvbkZhY3RvcnkgZmFjdG9yeSwgCiAgICAgICAgICAgIENy\naXRlcmlhUXVlcnlJbXBsPD8+IGMpIHsKICAgICAgICAgICAgQ2xhc3NNZXRh\nRGF0YSBtZXRhID0gZ2V0TWVtYmVyQ2xhc3NNZXRhRGF0YSgpOyAKICAgICAg\nICAgICAgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5leHBzLlBhdGggcGF0\naCA9IG51bGw7CiAgICAgICAgICAgIFN1YnF1ZXJ5SW1wbDw/PiBzdWJxdWVy\neSA9IGMuZ2V0RGVsZWdhdG9yKCk7CiAgICAgICAgICAgIG9yZy5hcGFjaGUu\nb3BlbmpwYS5rZXJuZWwuZXhwcy5FeHByZXNzaW9uIGZpbHRlciA9IG51bGw7\nCiAgICAgICAgICAgIGphdmEudXRpbC5MaXN0PEpvaW48Pyw/Pj4gY29yckpv\naW5zID0gbnVsbDsKICAgICAgICAgICAgYm9vbGVhbiBiaW5kID0gdHJ1ZTsK\nICAgICAgICAgICAgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5leHBzLkV4\ncHJlc3Npb24gam9pbiA9IG51bGw7CiAgICAgICAgICAgIFBhdGhJbXBsPD8s\nPz4gY29yckpvaW4gPSBnZXRDb3JyZWxhdGVkSm9pbih0aGlzKTsKICAgICAg\nICAgICAgUGF0aEltcGw8Pyw/PiBjb3JyUm9vdCA9IGdldENvcnJlbGF0ZWRS\nb290KHN1YnF1ZXJ5KTsKCiAgICAgICAgICAgIFBhdGhJbXBsPD8sPz4gY29y\ncmVsYXRlZFBhcmVudFBhdGggPSBudWxsOwogICAgICAgICAgICBpZiAoIWlz\nQ29ycmVsYXRlZCgpKSB7CiAgICAgICAgICAgICAgICBpZiAoc3VicXVlcnkg\nIT0gbnVsbCkgewogICAgICAgICAgICAgICAgICAgIGNvcnJKb2lucyA9IHN1\nYnF1ZXJ5LmdldENvcnJlbGF0ZWRKb2lucygpOwogICAgICAgICAgICAgICAg\nICAgIG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuZXhwcy5TdWJxdWVyeSBz\ndWJRID0gc3VicXVlcnkuZ2V0U3ViUSgpOwogICAgICAgICAgICAgICAgICAg\nIHBhdGggPSBmYWN0b3J5Lm5ld1BhdGgoc3ViUSk7IAogICAgICAgICAgICAg\nICAgICAgIGlmICgoY29yckpvaW4gIT0gbnVsbCB8fCBjb3JyUm9vdCAhPSBu\ndWxsKSAmJiBfcGFyZW50LmdldENvcnJlbGF0ZWRQYXRoKCkgIT0gbnVsbCkg\neyAKICAgICAgICAgICAgICAgICAgICAgICAgc3ViUS5zZXRTdWJxQWxpYXMo\nYy5nZXRBbGlhcyh0aGlzKSk7CiAgICAgICAgICAgICAgICAgICAgICAgIHBh\ndGggPSBmYWN0b3J5Lm5ld1BhdGgoc3ViUSk7CiAgICAgICAgICAgICAgICAg\nICAgICAgIGNvcnJlbGF0ZWRQYXJlbnRQYXRoID0gX3BhcmVudC5nZXRDb3Jy\nZWxhdGVkUGF0aCgpOwogICAgICAgICAgICAgICAgICAgICAgICBiaW5kID0g\nZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsgICAgCiAgICAg\nICAgICAgICAgICAgICAgICAgIGlmIChjLmlzUmVnaXN0ZXJlZChfcGFyZW50\nKSkgeyAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFZhbHVlIHZhciA9\nIGMuZ2V0UmVnaXN0ZXJlZFZhcmlhYmxlKF9wYXJlbnQpOwogICAgICAgICAg\nICAgICAgICAgICAgICAgICAgcGF0aCA9IGZhY3RvcnkubmV3UGF0aCh2YXIp\nOwogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAg\nICAgICAgICAgICAgICAgICAgcGF0aCA9IGZhY3RvcnkubmV3UGF0aChzdWJR\nKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAg\nICAgICAgICBwYXRoLnNldE1ldGFEYXRhKG1ldGEpOwogICAgICAgICAgICAg\nICAgICAgICAgICBwYXRoLmdldChfbWVtYmVyLmZtZCwgZmFsc2UpOwogICAg\nICAgICAgICAgICAgICAgICAgICBwYXRoLnNldFNjaGVtYUFsaWFzKGMuZ2V0\nQWxpYXMoX3BhcmVudCkpOwogICAgICAgICAgICAgICAgICAgIH0gCiAgICAg\nICAgICAgICAgICB9IGVsc2UgaWYgKGMuaXNSZWdpc3RlcmVkKF9wYXJlbnQp\nKSB7CiAgICAgICAgICAgICAgICAgICAgVmFsdWUgdmFyID0gYy5nZXRSZWdp\nc3RlcmVkVmFyaWFibGUoX3BhcmVudCk7CiAgICAgICAgICAgICAgICAgICAg\ncGF0aCA9IGZhY3RvcnkubmV3UGF0aCh2YXIpOwogICAgICAgICAgICAgICAg\nICAgIHBhdGguc2V0TWV0YURhdGEobWV0YSk7CiAgICAgICAgICAgICAgICAg\nICAgcGF0aC5nZXQoX21lbWJlci5mbWQsIGZhbHNlKTsKICAgICAgICAgICAg\nICAgIH0gZWxzZSB7ICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICBw\nYXRoID0gKG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuZXhwcy5QYXRoKXRv\nVmFsdWUoZmFjdG9yeSwgYyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAg\nICAgICAgICBDbGFzczw/PiB0eXBlID0gbWV0YSA9PSBudWxsID8gQWJzdHJh\nY3RFeHByZXNzaW9uQnVpbGRlci5UWVBFX09CSkVDVCA6IG1ldGEuZ2V0RGVz\nY3JpYmVkVHlwZSgpOyAKICAgICAgICAgICAgICAgIGlmIChiaW5kKSB7CiAg\nICAgICAgICAgICAgICAgICAgVmFsdWUgdmFyID0gZmFjdG9yeS5uZXdCb3Vu\nZFZhcmlhYmxlKGMuZ2V0QWxpYXModGhpcyksIHR5cGUpOwogICAgICAgICAg\nICAgICAgICAgIGpvaW4gPSBmYWN0b3J5LmJpbmRWYXJpYWJsZSh2YXIsIHBh\ndGgpOwogICAgICAgICAgICAgICAgICAgIGMucmVnaXN0ZXJWYXJpYWJsZSh0\naGlzLCB2YXIsIHBhdGgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAg\nICB9CiAgICAgICAgICAgIGlmIChnZXRKb2lucygpICE9IG51bGwpIHsKICAg\nICAgICAgICAgICAgIGZvciAoSm9pbjw/LCA/PiBqb2luMSA6IGdldEpvaW5z\nKCkpIHsKICAgICAgICAgICAgICAgICAgICBmaWx0ZXIgPSBFeHByZXNzaW9u\ncy5hbmQoZmFjdG9yeSwgCiAgICAgICAgICAgICAgICAgICAgICAgICgoRnJv\nbUltcGw8Pyw/Pilqb2luMSkudG9LZXJuZWxFeHByZXNzaW9uKGZhY3Rvcnks\nIGMpLCBmaWx0ZXIpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9\nCiAgICAgICAgICAgIG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuZXhwcy5F\neHByZXNzaW9uIGV4cHIgPSBFeHByZXNzaW9ucy5hbmQoZmFjdG9yeSwgam9p\nbiwgZmlsdGVyKTsKICAgICAgICAgICAgaWYgKGNvcnJlbGF0ZWRQYXJlbnRQ\nYXRoID09IG51bGwpIHsKICAgICAgICAgICAgICAgIHJldHVybiBleHByOwog\nICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgb3JnLmFwYWNo\nZS5vcGVuanBhLmtlcm5lbC5leHBzLlBhdGggcGFyZW50UGF0aCA9IG51bGw7\nCiAgICAgICAgICAgICAgICBpZiAoY29yckpvaW5zICE9IG51bGwgJiYgY29y\nckpvaW5zLmNvbnRhaW5zKF9wYXJlbnQpKSB7CiAgICAgICAgICAgICAgICAg\nICAgVmFsdWUgdmFyID0gZ2V0VmFyaWFibGVGb3JDb3JyUGF0aChzdWJxdWVy\neSwgY29ycmVsYXRlZFBhcmVudFBhdGgpOwogICAgICAgICAgICAgICAgICAg\nIHBhcmVudFBhdGggPSBmYWN0b3J5Lm5ld1BhdGgodmFyKTsKICAgICAgICAg\nICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgcGFyZW50UGF0\naCA9IChvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLmV4cHMuUGF0aCkgY29y\ncmVsYXRlZFBhcmVudFBhdGgudG9WYWx1ZShmYWN0b3J5LCBjKTsKICAgICAg\nICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHBhcmVudFBhdGguZ2V0KF9t\nZW1iZXIuZm1kLCBhbGxvd051bGwpOwogICAgICAgICAgICAgICAgcGFyZW50\nUGF0aC5zZXRTY2hlbWFBbGlhcyhjLmdldEFsaWFzKGNvcnJlbGF0ZWRQYXJl\nbnRQYXRoKSk7CiAgICAgICAgICAgICAgICBpZiAoYy5jdHgoKS5nZXRQYXJl\nbnQoKSAhPSBudWxsICYmIGMuY3R4KCkuZ2V0VmFyaWFibGUocGFyZW50UGF0\naC5nZXRTY2hlbWFBbGlhcygpKSA9PSBudWxsKSAKICAgICAgICAgICAgICAg\nICAgICBwYXJlbnRQYXRoLnNldFN1YnF1ZXJ5Q29udGV4dChjLmN0eCgpLCBw\nYXJlbnRQYXRoLmdldFNjaGVtYUFsaWFzKCkpOwogICAgICAgICAgICAgICAg\nCiAgICAgICAgICAgICAgICBwYXRoLnNldFNjaGVtYUFsaWFzKGMuZ2V0QWxp\nYXMoY29ycmVsYXRlZFBhcmVudFBhdGgpKTsKICAgICAgICAgICAgICAgIHBh\ndGguc2V0TWV0YURhdGEobWV0YSk7CiAgICAgICAgICAgICAgICBDbGFzczw/\nPiB0eXBlID0gbWV0YSA9PSBudWxsID8gQWJzdHJhY3RFeHByZXNzaW9uQnVp\nbGRlci5UWVBFX09CSkVDVCA6IG1ldGEuZ2V0RGVzY3JpYmVkVHlwZSgpOyAK\nICAgICAgICAgICAgICAgIFZhbHVlIHZhciA9IGZhY3RvcnkubmV3Qm91bmRW\nYXJpYWJsZShjLmdldEFsaWFzKHRoaXMpLCB0eXBlKTsKICAgICAgICAgICAg\nICAgIGpvaW4gPSBmYWN0b3J5LmJpbmRWYXJpYWJsZSh2YXIsIHBhcmVudFBh\ndGgpOwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBpZiAoX21l\nbWJlci5mbWQuZ2V0RGVjbGFyZWRUeXBlQ29kZSgpID09IEphdmFUeXBlcy5N\nQVApCiAgICAgICAgICAgICAgICAgICAgYy5yZWdpc3RlclZhcmlhYmxlKHRo\naXMsIHZhciwgcGFyZW50UGF0aCk7CiAgICAgICAgICAgICAgICAKICAgICAg\nICAgICAgICAgIGlmIChfbWVtYmVyLmZtZC5pc0VsZW1lbnRDb2xsZWN0aW9u\nKCkpIHsKICAgICAgICAgICAgICAgICAgICBmaWx0ZXIgPSBFeHByZXNzaW9u\ncy5hbmQoZmFjdG9yeSwgam9pbiwgZmlsdGVyKTsKICAgICAgICAgICAgICAg\nIH0gZWxzZSB7IAogICAgICAgICAgICAgICAgICAgIGZpbHRlciA9IGZhY3Rv\ncnkuZXF1YWwocGFyZW50UGF0aCwgcGF0aCk7CiAgICAgICAgICAgICAgICB9\nCiAgICAgICAgICAgICAgICByZXR1cm4gRXhwcmVzc2lvbnMuYW5kKGZhY3Rv\ncnksIGV4cHIsIGZpbHRlcik7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAg\nICAgICAgCiAgICAgICAgcHJpdmF0ZSBWYWx1ZSBnZXRWYXJpYWJsZUZvckNv\ncnJQYXRoKFN1YnF1ZXJ5SW1wbDw/PiBzdWJxdWVyeSwgUGF0aEltcGw8Pyw/\nPiBwYXRoKSB7CiAgICAgICAgICAgIEFic3RyYWN0UXVlcnk8Pz4gcGFyZW50\nID0gc3VicXVlcnkuZ2V0UGFyZW50KCk7CiAgICAgICAgICAgIGlmIChwYXJl\nbnQgaW5zdGFuY2VvZiBDcml0ZXJpYVF1ZXJ5SW1wbCkgewogICAgICAgICAg\nICAgICAgcmV0dXJuICgoQ3JpdGVyaWFRdWVyeUltcGw8Pz4pcGFyZW50KS5n\nZXRSZWdpc3RlcmVkVmFyaWFibGUocGF0aCk7CiAgICAgICAgICAgIH0KICAg\nICAgICAgICAgVmFsdWUgdmFyID0gKChTdWJxdWVyeUltcGw8Pz4pcGFyZW50\nKS5nZXREZWxlZ2F0ZSgpLmdldFJlZ2lzdGVyZWRWYXJpYWJsZShwYXRoKTsg\nCiAgICAgICAgICAgIGlmICh2YXIgIT0gbnVsbCkKICAgICAgICAgICAgICAg\nIHJldHVybiB2YXI7CiAgICAgICAgICAgIHJldHVybiBnZXRWYXJpYWJsZUZv\nckNvcnJQYXRoKChTdWJxdWVyeUltcGw8Pz4pcGFyZW50LCBwYXRoKTsKICAg\nICAgICB9CiAgICAgICAgCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgcHVi\nbGljIFN0cmluZ0J1aWxkZXIgYXNWYXJpYWJsZShBbGlhc0NvbnRleHQgcSkg\newogICAgICAgICAgICByZXR1cm4gbmV3IFN0cmluZ0J1aWxkZXIoIiAiICsg\nam9pblR5cGUgKyAiIEpPSU4gIikuYXBwZW5kKHN1cGVyLmFzVmFyaWFibGUo\ncSkpOwogICAgICAgIH0KICAgIH0KICAgIAogICAgLyoqCiAgICAgKiBKb2lu\nIGEgamF2YS51dGlsLkNvbGxlY3Rpb24mbHQ7RSZndDsgdHlwZSBhdHRyaWJ1\ndGUuCiAgICAgKgogICAgICogQHBhcmFtIDxaPiB0aGUgdHlwZSBmcm9tIHdo\naWNoIGJlaW5nIGpvaW5lZAogICAgICogQHBhcmFtIDxFPiB0aGUgdHlwZSBv\nZiB0aGUgdGhlIGNvbGxlY3Rpb24gYXR0cmlidXRlIGVsZW1lbnRzCiAgICAg\nKi8KICAgIHN0YXRpYyBjbGFzcyBDb2xsZWN0aW9uPFosRT4gZXh0ZW5kcyBB\nYnN0cmFjdENvbGxlY3Rpb248WixqYXZhLnV0aWwuQ29sbGVjdGlvbjxFPixF\nPiAKICAgICAgICBpbXBsZW1lbnRzIENvbGxlY3Rpb25Kb2luPFosRT4gewog\nICAgICAgIHB1YmxpYyBDb2xsZWN0aW9uKEZyb21JbXBsPD8sWj4gcGFyZW50\nLCBNZW1iZXJzLkNvbGxlY3Rpb25BdHRyaWJ1dGVJbXBsPD8gc3VwZXIgWiwg\nRT4gbWVtYmVyLCBKb2luVHlwZSBqdCkgewogICAgICAgICAgICBzdXBlcihw\nYXJlbnQsIG1lbWJlciwganQpOwogICAgICAgIH0KICAgICAgICAKICAgICAg\nICBwdWJsaWMgQ29sbGVjdGlvbkF0dHJpYnV0ZTw/IHN1cGVyIFosIEU+IGdl\ndE1vZGVsKCkgewogICAgICAgICAgICByZXR1cm4gKENvbGxlY3Rpb25BdHRy\naWJ1dGU8PyBzdXBlciBaLCBFPilfbWVtYmVyOwogICAgICAgIH0KICAgIH0K\nICAgIAogICAgLyoqCiAgICAgKiBKb2luIGEgamF2YS51dGlsLlNldCZsdDtF\nJmd0OyB0eXBlIGF0dHJpYnV0ZS4KICAgICAqCiAgICAgKiBAcGFyYW0gPFo+\nIHRoZSB0eXBlIGZyb20gd2hpY2ggYmVpbmcgam9pbmVkCiAgICAgKiBAcGFy\nYW0gPEU+IHRoZSB0eXBlIG9mIHRoZSB0aGUgc2V0IGF0dHJpYnV0ZSBlbGVt\nZW50cwogICAgICovCiAgICBzdGF0aWMgY2xhc3MgU2V0PFosRT4gZXh0ZW5k\ncyBBYnN0cmFjdENvbGxlY3Rpb248WixqYXZhLnV0aWwuU2V0PEU+LEU+IAog\nICAgICAgIGltcGxlbWVudHMgU2V0Sm9pbjxaLEU+IHsKICAgICAgICBwdWJs\naWMgU2V0KEZyb21JbXBsPD8sWj4gcGFyZW50LCBNZW1iZXJzLlNldEF0dHJp\nYnV0ZUltcGw8PyBzdXBlciBaLCBFPiBtZW1iZXIsIEpvaW5UeXBlIGp0KSB7\nCiAgICAgICAgICAgIHN1cGVyKHBhcmVudCwgbWVtYmVyLCBqdCk7CiAgICAg\nICAgfQogICAgICAgIAogICAgICAgIHB1YmxpYyBTZXRBdHRyaWJ1dGU8PyBz\ndXBlciBaLCBFPiBnZXRNb2RlbCgpIHsKICAgICAgICAgICAgcmV0dXJuIChT\nZXRBdHRyaWJ1dGU8PyBzdXBlciBaLCBFPilfbWVtYmVyOwogICAgICAgIH0K\nICAgIH0KICAgIAogICAgLyoqCiAgICAgKiBKb2luIGEgamF2YS51dGlsLkxp\nc3QmbHQ7RSZndDsgdHlwZSBhdHRyaWJ1dGUuCiAgICAgKgogICAgICogQHBh\ncmFtIDxaPiB0aGUgdHlwZSBmcm9tIHdoaWNoIGJlaW5nIGpvaW5lZAogICAg\nICogQHBhcmFtIDxFPiB0aGUgdHlwZSBvZiB0aGUgdGhlIGxpc3QgYXR0cmli\ndXRlIGVsZW1lbnRzCiAgICAgKi8KICAgIAogICAgc3RhdGljIGNsYXNzIExp\nc3Q8WixFPiBleHRlbmRzIEFic3RyYWN0Q29sbGVjdGlvbjxaLGphdmEudXRp\nbC5MaXN0PEU+LEU+IAogICAgICAgIGltcGxlbWVudHMgTGlzdEpvaW48WixF\nPiB7CiAgICAgICAgCiAgICAgICAgcHVibGljIExpc3QoRnJvbUltcGw8Pyxa\nPiBwYXJlbnQsIE1lbWJlcnMuTGlzdEF0dHJpYnV0ZUltcGw8PyBzdXBlciBa\nLCBFPiBtZW1iZXIsIEpvaW5UeXBlIGp0KSB7CiAgICAgICAgICAgIHN1cGVy\nKHBhcmVudCwgbWVtYmVyLCBqdCk7CiAgICAgICAgfQogICAgICAgIAogICAg\nICAgIHB1YmxpYyBMaXN0QXR0cmlidXRlPD8gc3VwZXIgWiwgRT4gZ2V0TW9k\nZWwoKSB7CiAgICAgICAgICAgIHJldHVybiAoTGlzdEF0dHJpYnV0ZTw/IHN1\ncGVyIFosIEU+KV9tZW1iZXI7CiAgICAgICAgfQogICAgICAgIAogICAgICAg\nIHB1YmxpYyBFeHByZXNzaW9uPEludGVnZXI+IGluZGV4KCkgewogICAgICAg\nICAgICByZXR1cm4gbmV3IEV4cHJlc3Npb25zLkluZGV4KHRoaXMpOwogICAg\nICAgIH0KICAgIH0KICAgIAogICAgLyoqCiAgICAgKiBKb2luIGEgamF2YS51\ndGlsLk1hcCZsdDtLLFYmZ3Q7IHR5cGUgYXR0cmlidXRlLgogICAgICoKICAg\nICAqIEBwYXJhbSA8Wj4gdGhlIHR5cGUgZnJvbSB3aGljaCBiZWluZyBqb2lu\nZWQKICAgICAqIEBwYXJhbSA8Sz4gdGhlIHR5cGUgb2YgdGhlIHRoZSBtYXAg\nYXR0cmlidXRlIGtleXMKICAgICAqIEBwYXJhbSA8Vj4gdGhlIHR5cGUgb2Yg\ndGhlIHRoZSBtYXAgYXR0cmlidXRlIHZhbHVlcwogICAgICovCiAgICAKICAg\nIHN0YXRpYyBjbGFzcyBNYXA8WixLLFY+IGV4dGVuZHMgQWJzdHJhY3RDb2xs\nZWN0aW9uPFosamF2YS51dGlsLk1hcDxLLFY+LFY+IAogICAgICAgIGltcGxl\nbWVudHMgTWFwSm9pbjxaLEssVj4gewogICAgICAgIHByaXZhdGUgS2V5Sm9p\nbjxLLFY+IF9rZXlKb2luOwogICAgICAgIAogICAgICAgIHB1YmxpYyBNYXAo\nRnJvbUltcGw8PyxaPiBwYXJlbnQsIE1lbWJlcnMuTWFwQXR0cmlidXRlSW1w\nbDw/IHN1cGVyIFosIEssVj4gbWVtYmVyLCBKb2luVHlwZSBqdCkgewogICAg\nICAgICAgICBzdXBlcihwYXJlbnQsIG1lbWJlciwganQpOwogICAgICAgIH0K\nICAgICAgICAKICAgICAgICBwdWJsaWMgTWFwQXR0cmlidXRlPD8gc3VwZXIg\nWiwgSyxWPiBnZXRNb2RlbCgpIHsKICAgICAgICAgICAgcmV0dXJuIChNYXBB\ndHRyaWJ1dGU8PyBzdXBlciBaLCBLLFY+KSBfbWVtYmVyOwogICAgICAgIH0K\nICAgICAgICAKICAgICAgICBwdWJsaWMgSm9pbjxqYXZhLnV0aWwuTWFwPEss\nIFY+LCBLPiBqb2luS2V5KCkgewogICAgICAgICAgICByZXR1cm4gam9pbktl\neShKb2luVHlwZS5JTk5FUik7CiAgICAgICAgfQogICAgICAgIAogICAgICAg\nIC8qKgogICAgICAgICAqIENyZWF0ZSBhIHBzZXVkby1hdHRyaWJ1dGUgb2Yg\nYSBwc2V1ZG8tbWFuYWdlZCB0eXBlIGZvciBqYXZhLnV0aWwuTWFwJmx0O0ss\nViZndDsgCiAgICAgICAgICogdG8gcmVwcmVzZW50IGl0cyBrZXlzIG9mIHR5\ncGUgamF2YS51dGlsLlNldCZsdDtWJmd0Oy4KICAgICAgICAgKi8KICAgICAg\nICBwdWJsaWMgSm9pbjxqYXZhLnV0aWwuTWFwPEssIFY+LCBLPiBqb2luS2V5\nKEpvaW5UeXBlIGp0KSB7CiAgICAgICAgICAgIEFic3RyYWN0TWFuYWdlZFR5\ncGU8amF2YS51dGlsLk1hcDxLLFY+PiBwc2V1ZG9Pd25lciA9IChBYnN0cmFj\ndE1hbmFnZWRUeXBlPGphdmEudXRpbC5NYXA8SyxWPj4pCiAgICAgICAgICAg\nICAgIF9tZW1iZXIub3duZXIubW9kZWwuZ2V0VHlwZShnZXRNb2RlbCgpLmdl\ndEphdmFUeXBlKCkpOwogICAgICAgICAgICBLZXlBdHRyaWJ1dGVJbXBsPGph\ndmEudXRpbC5NYXA8SyxWPiwgSz4ga2V5QXR0ciA9IAogICAgICAgICAgICAg\nIG5ldyBNZW1iZXJzLktleUF0dHJpYnV0ZUltcGw8amF2YS51dGlsLk1hcDxL\nLFY+LCBLPihwc2V1ZG9Pd25lciwgX21lbWJlci5mbWQpOwogICAgICAgICAg\nICBfa2V5Sm9pbiA9IG5ldyBLZXlKb2luPEssIFY+KChGcm9tSW1wbDw/LGph\ndmEudXRpbC5NYXA8SyxWPj4pdGhpcywga2V5QXR0ciwganQpOwogICAgICAg\nICAgICByZXR1cm4gX2tleUpvaW47CiAgICAgICAgfQogICAgICAgIAogICAg\nICAgIHB1YmxpYyBFeHByZXNzaW9uPGphdmEudXRpbC5NYXAuRW50cnk8Sywg\nVj4+IGVudHJ5KCkgewogICAgICAgICAgICByZXR1cm4gbmV3IE1hcEVudHJ5\nPEssVj4odGhpcyk7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIHB1Ymxp\nYyBQYXRoPEs+IGtleSgpIHsKICAgICAgICAgICAgcmV0dXJuIG5ldyBNYXBL\nZXk8WixLPih0aGlzKTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgcHVi\nbGljIFBhdGg8Vj4gdmFsdWUoKSB7CiAgICAgICAgICAgIHJldHVybiB0aGlz\nOwogICAgICAgIH0KICAgICAgICAgICAgICAgIAogICAgICAgIEBPdmVycmlk\nZQogICAgICAgIHB1YmxpYyBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLmV4\ncHMuRXhwcmVzc2lvbiB0b0tlcm5lbEV4cHJlc3Npb24oRXhwcmVzc2lvbkZh\nY3RvcnkgZmFjdG9yeSwgCiAgICAgICAgICAgIENyaXRlcmlhUXVlcnlJbXBs\nPD8+IGMpIHsKICAgICAgICAgICAgcmV0dXJuIChfa2V5Sm9pbiA9PSBudWxs\nKSAKICAgICAgICAgICAgICAgID8gc3VwZXIudG9LZXJuZWxFeHByZXNzaW9u\nKGZhY3RvcnksIGMpCiAgICAgICAgICAgICAgICA6IF9rZXlKb2luLnRvS2Vy\nbmVsRXhwcmVzc2lvbihmYWN0b3J5LCBjKTsKICAgICAgICB9CiAgICB9CiAg\nICAKICAgICAgIAogICBzdGF0aWMgY2xhc3MgTWFwS2V5PFosSz4gZXh0ZW5k\ncyBQYXRoSW1wbDxaLEs+IHsKICAgICAgIHByaXZhdGUgZmluYWwgTWFwPD8s\nSyw/PiBtYXA7CiAgICAgICBwcml2YXRlIGZpbmFsIE1hcEF0dHJpYnV0ZUlt\ncGw8WiwgSywgPz4gYXR0cjsKICAgICAgIAogICAgICAgcHVibGljIE1hcEtl\neShNYXA8WixLLD8+IGpvaW5NYXApewogICAgICAgICAgIHN1cGVyKCgoTWFw\nQXR0cmlidXRlPFosIEssID8+KWpvaW5NYXAuZ2V0QXR0cmlidXRlKCkpLmdl\ndEtleUphdmFUeXBlKCkpOwogICAgICAgICAgIGF0dHIgPSAoKE1hcEF0dHJp\nYnV0ZUltcGw8WiwgSywgPz4pam9pbk1hcC5nZXRBdHRyaWJ1dGUoKSk7CiAg\nICAgICAgICAgdGhpcy5tYXAgPSBqb2luTWFwOwogICAgICAgfQogICAgICAg\nCiAgICAgICBAT3ZlcnJpZGUKICAgICAgIHB1YmxpYyBUeXBlPD8+IGdldFR5\ncGUoKSB7CiAgICAgICAgICAgcmV0dXJuIGF0dHIuZ2V0S2V5VHlwZSgpOwog\nICAgICAgfQogICAgICAgCiAgICAgICAvKioKICAgICAgICAqIENvbnZlcnQg\ndGhpcyBwYXRoIHRvIGEgam9pbiBleHByZXNzaW9uLgogICAgICAgICogCiAg\nICAgICAgKi8KICAgICAgIEBPdmVycmlkZQogICAgICAgcHVibGljIFZhbHVl\nIHRvVmFsdWUoRXhwcmVzc2lvbkZhY3RvcnkgZmFjdG9yeSwgQ3JpdGVyaWFR\ndWVyeUltcGw8Pz4gYykgewogICAgICAgICAgIFZhbHVlIHZhbCA9IGMuZ2V0\nUmVnaXN0ZXJlZFZhcmlhYmxlKG1hcCk7CiAgICAgICAgICAgb3JnLmFwYWNo\nZS5vcGVuanBhLmtlcm5lbC5leHBzLlBhdGggcGF0aCA9IGZhY3RvcnkubmV3\nUGF0aCh2YWwpOwogICAgICAgICAgIHJldHVybiBmYWN0b3J5LmdldEtleShw\nYXRoKTsKICAgICAgIH0KICAgICAgIAogICAgICAgQE92ZXJyaWRlCiAgICAg\nICBwdWJsaWMgU3RyaW5nQnVpbGRlciBhc1ZhbHVlKEFsaWFzQ29udGV4dCBx\nKSB7CiAgICAgICAgICAgU3RyaW5nQnVpbGRlciBidWZmZXIgPSBuZXcgU3Ry\naW5nQnVpbGRlcigiS0VZKCIpOwogICAgICAgICAgIFZhbHVlIHZhciA9IHEu\nZ2V0UmVnaXN0ZXJlZFZhcmlhYmxlKG1hcCk7CiAgICAgICAgICAgYnVmZmVy\nLmFwcGVuZCh2YXIgIT0gbnVsbCA/IHZhci5nZXROYW1lKCkgOiBtYXAuYXNW\nYWx1ZShxKSkuYXBwZW5kKCIpIik7CiAgICAgICAgICAgcmV0dXJuIGJ1ZmZl\ncjsKICAgICAgIH0KICAgfQogICAgICAgCiAgIHN0YXRpYyBjbGFzcyBNYXBF\nbnRyeTxLLFY+IGV4dGVuZHMgRXhwcmVzc2lvbkltcGw8amF2YS51dGlsLk1h\ncC5FbnRyeTxLLFY+PiB7CiAgICAgICBwcml2YXRlIGZpbmFsIE1hcDw/LEss\nVj4gbWFwOwogICAgICAgCiAgICAgICBwdWJsaWMgTWFwRW50cnkoTWFwPD8s\nSyxWPiBqb2luTWFwKXsKICAgICAgICAgICBzdXBlcigoKE1hcEF0dHJpYnV0\nZSlqb2luTWFwLmdldEF0dHJpYnV0ZSgpKS5nZXRKYXZhVHlwZSgpKTsKICAg\nICAgICAgICB0aGlzLm1hcCA9IGpvaW5NYXA7CiAgICAgICB9CiAgICAgICAK\nICAgICAgIC8qKgogICAgICAgICogQ29udmVydCB0aGlzIHBhdGggdG8gYSBq\nb2luIGV4cHJlc3Npb24uCiAgICAgICAgKiAKICAgICAgICAqLwogICAgICAg\nQE92ZXJyaWRlCiAgICAgICBwdWJsaWMgVmFsdWUgdG9WYWx1ZShFeHByZXNz\naW9uRmFjdG9yeSBmYWN0b3J5LCBDcml0ZXJpYVF1ZXJ5SW1wbDw/PiBjKSB7\nCiAgICAgICAgICAgVmFsdWUgdmFsID0gYy5nZXRSZWdpc3RlcmVkVmFyaWFi\nbGUobWFwKTsKICAgICAgICAgICBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVs\nLmV4cHMuUGF0aCBwYXRoID0gZmFjdG9yeS5uZXdQYXRoKHZhbCk7CiAgICAg\nICAgICAgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5leHBzLlBhdGggdmFy\nID0gZmFjdG9yeS5uZXdQYXRoKHZhbCk7CiAgICAgICAgICAgcmV0dXJuIGZh\nY3RvcnkubWFwRW50cnkocGF0aCwgdmFyKTsKICAgICAgIH0KICAgICAgIAog\nICAgICAgQE92ZXJyaWRlCiAgICAgICBwdWJsaWMgU3RyaW5nQnVpbGRlciBh\nc1ZhbHVlKEFsaWFzQ29udGV4dCBxKSB7CiAgICAgICAgICAgU3RyaW5nQnVp\nbGRlciBidWZmZXIgPSBuZXcgU3RyaW5nQnVpbGRlcigiRU5UUlkoIik7CiAg\nICAgICAgICAgVmFsdWUgdmFyID0gcS5nZXRSZWdpc3RlcmVkVmFyaWFibGUo\nbWFwKTsKICAgICAgICAgICBidWZmZXIuYXBwZW5kKHZhciAhPSBudWxsID8g\ndmFyLmdldE5hbWUoKSA6IG1hcC5hc1ZhbHVlKHEpKS5hcHBlbmQoIikiKTsK\nICAgICAgICAgICByZXR1cm4gYnVmZmVyOwogICAgICAgfQogICB9CiAgIAog\nICAvKioKICAgICogQSBzcGVjaWFsaXplZCBqb2luIHZpYSBrZXkgb2YgYSBq\nYXZhLnV0aWwuTWFwJmx0O0ssViZndDsgYXR0cmlidXRlLgogICAgKiBUcmVh\ndHMgdGhlIG1hcCBrZXkgYXMgYSBwc2V1ZG8tYXR0cmlidXRlIG9mIHR5cGUg\namF2YS51dGlsLlNldCZsdDtLJmd0OyBvZiBhIHBzZWR1by1tYW5hZ2VkIHR5\ncGUgY29ycmVzcG9uZGluZwogICAgKiB0byBqYXZhLnV0aWwuTWFwJmx0O0ss\nViZndDsuIAogICAgKiAgCiAgICAqIEBwYXJhbSA8Sz4gdGhlIHR5cGUgb2Yg\ndGhlIGtleSBvZiB0aGUgb3JpZ2luYWwgamF2YS51dGlsLk1hcCBhdHRyaWJ1\ndGUgCiAgICAqIEBwYXJhbSA8Vj4gdGhlIHR5cGUgb2YgdGhlIHZhbHVlIG9m\nIHRoZSBvcmlnaW5hbCBqYXZhLnV0aWwuTWFwIGF0dHJpYnV0ZQogICAgKi8K\nICAgc3RhdGljIGNsYXNzIEtleUpvaW48SyxWPiBleHRlbmRzIEpvaW5zLlNl\ndDxqYXZhLnV0aWwuTWFwPEssIFY+LCBLPiB7CiAgICBwdWJsaWMgS2V5Sm9p\nbihGcm9tSW1wbDw/LCBqYXZhLnV0aWwuTWFwPEssIFY+PiBwYXJlbnQsIEtl\neUF0dHJpYnV0ZUltcGw8PyBzdXBlciBqYXZhLnV0aWwuTWFwPEssIFY+LCBL\nPiBtZW1iZXIsIAogICAgICAgICAgICBKb2luVHlwZSBqdCkgewogICAgICAg\nIHN1cGVyKHBhcmVudCwgbWVtYmVyLCBqdCk7CiAgICB9CiAgICAKICAgIEBP\ndmVycmlkZQogICAgcHVibGljIFZhbHVlIHRvVmFsdWUoRXhwcmVzc2lvbkZh\nY3RvcnkgZmFjdG9yeSwgQ3JpdGVyaWFRdWVyeUltcGw8Pz4gYykgewogICAg\nICAgIHJldHVybiBmYWN0b3J5LmdldEtleShnZXRQYXJlbnQoKS50b1ZhbHVl\nKGZhY3RvcnksIGMpKTsKICAgIH0KICAgfQp9Cg==\n","encoding":"base64"}

