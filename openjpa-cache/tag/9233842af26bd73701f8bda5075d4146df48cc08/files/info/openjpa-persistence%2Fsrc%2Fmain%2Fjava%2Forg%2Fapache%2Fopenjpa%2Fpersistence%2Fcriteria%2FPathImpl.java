{"sha":"d2478d1aebde063dca6d457bdd50f5bf76c7bdf1","node_id":"MDQ6QmxvYjIwNjM2NDpkMjQ3OGQxYWViZGUwNjNkY2E2ZDQ1N2JkZDUwZjViZjc2YzdiZGYx","size":11395,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/d2478d1aebde063dca6d457bdd50f5bf76c7bdf1","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwoKcGFj\na2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuY3JpdGVyaWE7\nCgppbXBvcnQgamF2YXgucGVyc2lzdGVuY2UuY3JpdGVyaWEuRXhwcmVzc2lv\nbjsKaW1wb3J0IGphdmF4LnBlcnNpc3RlbmNlLmNyaXRlcmlhLkpvaW47Cmlt\ncG9ydCBqYXZheC5wZXJzaXN0ZW5jZS5jcml0ZXJpYS5Kb2luVHlwZTsKaW1w\nb3J0IGphdmF4LnBlcnNpc3RlbmNlLmNyaXRlcmlhLlBhdGg7CmltcG9ydCBq\nYXZheC5wZXJzaXN0ZW5jZS5tZXRhbW9kZWwuQmluZGFibGU7CmltcG9ydCBq\nYXZheC5wZXJzaXN0ZW5jZS5tZXRhbW9kZWwuTWFuYWdlZFR5cGU7CmltcG9y\ndCBqYXZheC5wZXJzaXN0ZW5jZS5tZXRhbW9kZWwuTWFwQXR0cmlidXRlOwpp\nbXBvcnQgamF2YXgucGVyc2lzdGVuY2UubWV0YW1vZGVsLlBsdXJhbEF0dHJp\nYnV0ZTsKaW1wb3J0IGphdmF4LnBlcnNpc3RlbmNlLm1ldGFtb2RlbC5TaW5n\ndWxhckF0dHJpYnV0ZTsKaW1wb3J0IGphdmF4LnBlcnNpc3RlbmNlLm1ldGFt\nb2RlbC5UeXBlOwppbXBvcnQgamF2YXgucGVyc2lzdGVuY2UubWV0YW1vZGVs\nLlR5cGUuUGVyc2lzdGVuY2VUeXBlOwoKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5rZXJuZWwuZXhwcy5FeHByZXNzaW9uRmFjdG9yeTsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuZXhwcy5WYWx1ZTsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5tZXRhLkNsYXNzTWV0YURhdGE7CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEubWV0YS5GaWVsZE1ldGFEYXRhOwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNlLm1ldGEuTWVtYmVyczsK\nCi8qKgogKiBSZXByZXNlbnRzIGEgc2ltcGxlIG9yIGNvbXBvdW5kIGF0dHJp\nYnV0ZSBwYXRoIGZyb20gYSAKICogYm91bmQgdHlwZSBvciBjb2xsZWN0aW9u\nLCBhbmQgaXMgYSAicHJpbWl0aXZlIiBleHByZXNzaW9uLgogKiBAcGFyYW0g\nPFg+ICBUeXBlIHJlZmVyZW5jZWQgYnkgdGhlIHBhdGgKICovCi8qKgogKiBQ\nYXRoIGlzIGFuIGV4cHJlc3Npb24gb2Z0ZW4gcmVwcmVzZW50aW5nIGEgcGVy\nc2lzdGVudCBhdHRyaWJ1dGUgdHJhdmVyc2VkIGZyb20gYW5vdGhlciAocGFy\nZW50KSBwYXRoLgogKiBUaGUgdHlwZSBvZiB0aGUgcGF0aCBpcyB0aGUgdHlw\nZSBvZiB0aGUgcGVyc2lzdGVudCBhdHRyaWJ1dGUuCiAqIElmIHRoZSBwZXJz\naXN0ZW50IGF0dHJpYnV0ZSBpcyBiaW5kYWJsZSwgdGhlbiBmdXJ0aGVyIHBh\ndGggY2FuIGJlIHRyYXZlcnNlZCBmcm9tIHRoaXMgcGF0aC4gCiAqIAogKiBA\nYXV0aG9yIFBpbmFraSBQb2RkYXIKICogQGF1dGhvciBGYXkgV2FuZwogKiAK\nICogQHBhcmFtIDxaPiB0aGUgdHlwZSBvZiB0aGUgcGFyZW50IHBhdGggCiAq\nIEBwYXJhbSA8WD4gdGhlIHR5cGUgb2YgdGhpcyBwYXRoCiAqLwpjbGFzcyBQ\nYXRoSW1wbDxaLFg+IGV4dGVuZHMgRXhwcmVzc2lvbkltcGw8WD4gaW1wbGVt\nZW50cyBQYXRoPFg+IHsKICAgIHByb3RlY3RlZCBmaW5hbCBQYXRoSW1wbDw/\nLFo+IF9wYXJlbnQ7CiAgICBwcm90ZWN0ZWQgZmluYWwgTWVtYmVycy5NZW1i\nZXI8PyBzdXBlciBaLD8+IF9tZW1iZXI7CiAgICBwcml2YXRlIGJvb2xlYW4g\naXNFbWJlZGRlZCA9IGZhbHNlOwogICAgcHJpdmF0ZSBQYXRoSW1wbDw/LD8+\nIF9jb3JyZWxhdGVkUGF0aDsKICAgIAogICAgLyoqCiAgICAgKiBQcm90ZWN0\nZWQgY29uc3RydWN0b3IgdXNlIGJ5IHJvb3QgcGF0aCB3aGljaCBuZWl0aGVy\nIHJlcHJlc2VudCBhIG1lbWJlciBub3IgaGFzIGEgcGFyZW50LiAKICAgICAq\nLwogICAgcHJvdGVjdGVkIFBhdGhJbXBsKENsYXNzPFg+IGNscykgewogICAg\nICAgIHN1cGVyKGNscyk7CiAgICAgICAgX3BhcmVudCA9IG51bGw7CiAgICAg\nICAgX21lbWJlciA9IG51bGw7CiAgICB9CiAgICAKICAgIC8qKgogICAgICog\nQ3JlYXRlIGEgcGF0aCBmcm9tIHRoZSBnaXZlbiBub24tbnVsbCBwYXJlbnQg\ncmVwcmVzZW50aW5nIHRoZSBnaXZlbiBub24tbnVsbCBtZW1iZXIuIFRoZSBn\naXZlbiBjbGFzcyBkZW5vdGVzIAogICAgICogdGhlIHR5cGUgZXhwcmVzc2Vk\nIGJ5IHRoaXMgcGF0aC4KICAgICAqLwogICAgcHVibGljIFBhdGhJbXBsKFBh\ndGhJbXBsPD8sWj4gcGFyZW50LCBNZW1iZXJzLk1lbWJlcjw/IHN1cGVyIFos\nID8+IG1lbWJlciwgQ2xhc3M8WD4gY2xzKSB7CiAgICAgICAgc3VwZXIoY2xz\nKTsKICAgICAgICBfcGFyZW50ID0gcGFyZW50OwogICAgICAgIGlmIChfcGFy\nZW50LmlzRW1iZWRkZWQpIHsKICAgICAgICAgICAgRmllbGRNZXRhRGF0YSBm\nbWQgPSBnZXRFbWJlZGRlZEZpZWxkTWV0YURhdGEobWVtYmVyLmZtZCk7CiAg\nICAgICAgICAgIF9tZW1iZXIgPSBuZXcgTWVtYmVycy5TaW5ndWxhckF0dHJp\nYnV0ZUltcGwobWVtYmVyLm93bmVyLCBmbWQpOwogICAgICAgIH0gZWxzZSB7\nCiAgICAgICAgICAgIF9tZW1iZXIgPSBtZW1iZXI7CiAgICAgICAgfQogICAg\nICAgIGlzRW1iZWRkZWQgPSBfbWVtYmVyLmZtZC5pc0VsZW1lbnRDb2xsZWN0\naW9uKCkgPyBfbWVtYmVyLmZtZC5nZXRFbGVtZW50KCkuaXNFbWJlZGRlZCgp\nIDogCiAgICAgICAgICAgIF9tZW1iZXIuZm1kLmlzRW1iZWRkZWQoKTsKICAg\nIH0KCiAgICAvKiogCiAgICAgKiBSZXR1cm5zIHRoZSBiaW5kYWJsZSBvYmpl\nY3QgdGhhdCBjb3JyZXNwb25kcyB0byB0aGUgcGF0aCBleHByZXNzaW9uLgog\nICAgICogIAogICAgICovCiAgICBwdWJsaWMgQmluZGFibGU8WD4gZ2V0TW9k\nZWwoKSB7IAogICAgICAgIGlmIChfbWVtYmVyIGluc3RhbmNlb2YgQmluZGFi\nbGU8Pz4gPT0gZmFsc2UpIHsKICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVn\nYWxBcmd1bWVudEV4Y2VwdGlvbih0aGlzICsgIiByZXByZXNlbnRzIGEgYmFz\naWMgcGF0aCBhbmQgbm90IGEgYmluZGFibGUiKTsKICAgICAgICB9CiAgICAg\nICAgcmV0dXJuIChCaW5kYWJsZTxYPilfbWVtYmVyOwogICAgfQogICAgCiAg\nICAvKioKICAgICAqICBSZXR1cm4gdGhlIHBhcmVudCAibm9kZSIgaW4gdGhl\nIHBhdGggb3IgbnVsbCBpZiBubyBwYXJlbnQuCiAgICAgKi8KICAgIHB1Ymxp\nYyBmaW5hbCBQYXRoPFo+IGdldFBhcmVudFBhdGgoKSB7CiAgICAgICAgcmV0\ndXJuIF9wYXJlbnQ7CiAgICB9CiAgICAKICAgIC8qKgogICAgICogR2V0cyB0\naGUgcGF0aCB0aGF0IG9yaWdpbmF0ZXMgdGhpcyB0cmF2ZXJzYWwuIENhbiBi\nZSBpdHNlbGYgaWYgdGhpcyBpdHNlbGYgaXMgdGhlIG9yaWdpbi4KICAgICAq\nLwogICAgcHVibGljIFBhdGhJbXBsPD8sPz4gZ2V0SW5uZXJtb3N0UGFyZW50\nUGF0aCgpIHsKICAgICAgICByZXR1cm4gKF9wYXJlbnQgPT0gbnVsbCkgPyB0\naGlzIDogX3BhcmVudC5nZXRJbm5lcm1vc3RQYXJlbnRQYXRoKCk7CiAgICB9\nCgogICAgcHJvdGVjdGVkIEZpZWxkTWV0YURhdGEgZ2V0RW1iZWRkZWRGaWVs\nZE1ldGFEYXRhKEZpZWxkTWV0YURhdGEgZm1kKSB7CiAgICAgICAgTWVtYmVy\ncy5NZW1iZXI8Pyw/PiBtZW1iZXIgPSBnZXRJbm5lcm1vc3RNZW1iZXIoX3Bh\ncmVudCxfbWVtYmVyKTsKICAgICAgICBDbGFzc01ldGFEYXRhIGVtYmVkZGVk\nTWV0YSA9IG1lbWJlci5mbWQuaXNFbGVtZW50Q29sbGVjdGlvbigpID8gCiAg\nICAgICAgICAgICAgICBtZW1iZXIuZm1kLmdldEVsZW1lbnQoKS5nZXRFbWJl\nZGRlZE1ldGFEYXRhKCkgOgogICAgICAgICAgICAgICAgbWVtYmVyLmZtZC5n\nZXRFbWJlZGRlZE1ldGFEYXRhKCk7CiAgICAgICAgaWYgKGVtYmVkZGVkTWV0\nYSAhPSBudWxsKQogICAgICAgICAgICByZXR1cm4gZW1iZWRkZWRNZXRhLmdl\ndEZpZWxkKGZtZC5nZXROYW1lKCkpOwogICAgICAgIGVsc2UKICAgICAgICAg\nICAgcmV0dXJuIGZtZDsKICAgIH0KICAgIAogICAgcHJvdGVjdGVkIE1lbWJl\ncnMuTWVtYmVyPD8sPz4gZ2V0SW5uZXJtb3N0TWVtYmVyKFBhdGhJbXBsPD8s\nPz4gcGFyZW50LCBNZW1iZXJzLk1lbWJlcjw/LD8+IG1lbWJlcikgewogICAg\nICAgIHJldHVybiBtZW1iZXIgIT0gbnVsbCA/IG1lbWJlciA6IGdldElubmVy\nbW9zdE1lbWJlcihwYXJlbnQuX3BhcmVudCwgIHBhcmVudC5fbWVtYmVyKTsg\nCiAgICB9CiAgICAKICAgIC8qKgogICAgICogTWFrZXMgdGhpcyBwYXRoIGNv\ncnJlbGF0ZWQgdG8gdGhlIGdpdmVuIHBhdGguICAKICAgICAqLwogICAgcHVi\nbGljIHZvaWQgc2V0Q29ycmVsYXRlZFBhdGgoUGF0aEltcGw8Pyw/PiBjb3Jy\nZWxhdGVkUGF0aCkgewogICAgICAgIF9jb3JyZWxhdGVkUGF0aCA9IGNvcnJl\nbGF0ZWRQYXRoOwogICAgfQogICAgCiAgICAvKioKICAgICAqIEdldHMgdGhl\nIHBhdGggY29ycmVsYXRlZCB0byB0aGlzIHBhdGgsIGlmIGFueS4KICAgICAq\nLwogICAgcHVibGljIFBhdGhJbXBsPD8sPz4gZ2V0Q29ycmVsYXRlZFBhdGgo\nKSB7CiAgICAgICAgcmV0dXJuIF9jb3JyZWxhdGVkUGF0aDsKICAgIH0KICAg\nIAogICAgLyoqCiAgICAgKiBBZmZpcm1zIGlmIHRoaXMgcGF0aCBpcyBjb3Jy\nZWxhdGVkIHRvIGFub3RoZXIgcGF0aC4KICAgICAqLwogICAgcHVibGljIGJv\nb2xlYW4gaXNDb3JyZWxhdGVkKCkgewogICAgICAgIHJldHVybiBfY29ycmVs\nYXRlZFBhdGggIT0gbnVsbDsKICAgIH0KICAgIAogICAgLyoqCiAgICAgKiBD\nb252ZXJ0IHRoaXMgcGF0aCB0byBhIGtlcm5lbCBwYXRoLgogICAgICovCiAg\nICBAT3ZlcnJpZGUKICAgIHB1YmxpYyBWYWx1ZSB0b1ZhbHVlKEV4cHJlc3Np\nb25GYWN0b3J5IGZhY3RvcnksIENyaXRlcmlhUXVlcnlJbXBsPD8+IHEpIHsK\nICAgICAgICBpZiAocS5pc1JlZ2lzdGVyZWQodGhpcykpCiAgICAgICAgICAg\nIHJldHVybiBxLmdldFJlZ2lzdGVyZWRWYWx1ZSh0aGlzKTsKICAgICAgICBv\ncmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLmV4cHMuUGF0aCBwYXRoID0gbnVs\nbDsKICAgICAgICBTdWJxdWVyeUltcGw8Pz4gc3VicXVlcnkgPSBxLmdldERl\nbGVnYXRvcigpOwogICAgICAgIGJvb2xlYW4gYWxsb3dOdWxsID0gX3BhcmVu\ndCA9PSBudWxsID8gZmFsc2UgOiBfcGFyZW50IGluc3RhbmNlb2YgSm9pbiAK\nICAgICAgICAgICAgJiYgKChKb2luPD8sPz4pX3BhcmVudCkuZ2V0Sm9pblR5\ncGUoKSAhPSBKb2luVHlwZS5JTk5FUjsKICAgICAgICBQYXRoSW1wbDw/LD8+\nIGNvcnJKb2luID0gZ2V0Q29ycmVsYXRlZEpvaW4odGhpcyk7CiAgICAgICAg\nUGF0aEltcGw8Pyw/PiBjb3JyUm9vdCA9IGdldENvcnJlbGF0ZWRSb290KHN1\nYnF1ZXJ5KTsKICAgICAgICBpZiAoX3BhcmVudCAhPSBudWxsICYmIHEuaXNS\nZWdpc3RlcmVkKF9wYXJlbnQpKSB7CiAgICAgICAgICAgIHBhdGggPSBmYWN0\nb3J5Lm5ld1BhdGgocS5nZXRSZWdpc3RlcmVkVmFyaWFibGUoX3BhcmVudCkp\nOwogICAgICAgICAgICBwYXRoLnNldFNjaGVtYUFsaWFzKHEuZ2V0QWxpYXMo\nX3BhcmVudCkpOwogICAgICAgICAgICBwYXRoLmdldChfbWVtYmVyLmZtZCwg\nYWxsb3dOdWxsKTsKICAgICAgICB9IGVsc2UgaWYgKGNvcnJKb2luICE9IG51\nbGwgfHwgY29yclJvb3QgIT0gbnVsbCkgewogICAgICAgICAgICBvcmcuYXBh\nY2hlLm9wZW5qcGEua2VybmVsLmV4cHMuU3VicXVlcnkgc3ViUSA9IHN1YnF1\nZXJ5LmdldFN1YlEoKTsKICAgICAgICAgICAgcGF0aCA9IGZhY3RvcnkubmV3\nUGF0aChzdWJRKTsKICAgICAgICAgICAgcGF0aC5zZXRNZXRhRGF0YShzdWJR\nLmdldE1ldGFEYXRhKCkpOwogICAgICAgICAgICBwYXRoLnNldFNjaGVtYUFs\naWFzKHEuZ2V0QWxpYXMoX3BhcmVudCkpOwogICAgICAgICAgICB0cmF2ZXJz\nZVBhdGgoX3BhcmVudCwgcGF0aCwgX21lbWJlci5mbWQpOwogICAgICAgIH0g\nZWxzZSBpZiAoX3BhcmVudCAhPSBudWxsKSB7CiAgICAgICAgICAgIFZhbHVl\nIHZhbCA9IF9wYXJlbnQudG9WYWx1ZShmYWN0b3J5LCBxKTsKICAgICAgICAg\nICAgaWYgKHZhbCBpbnN0YW5jZW9mIG9yZy5hcGFjaGUub3BlbmpwYS5rZXJu\nZWwuZXhwcy5QYXRoKSB7CiAgICAgICAgICAgICAgICBwYXRoID0gKG9yZy5h\ncGFjaGUub3BlbmpwYS5rZXJuZWwuZXhwcy5QYXRoKXZhbDsKICAgICAgICAg\nICAgICAgIHBhdGguZ2V0KF9tZW1iZXIuZm1kLCBhbGxvd051bGwpOwogICAg\nICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgdmFsLnNldEFsaWFz\nKHEuZ2V0QWxpYXModGhpcykpOwogICAgICAgICAgICAgICAgcmV0dXJuIHZh\nbDsKICAgICAgICAgICAgfQogICAgICAgIH0gZWxzZSBpZiAoX3BhcmVudCA9\nPSBudWxsKSB7CiAgICAgICAgICAgIHBhdGggPSBmYWN0b3J5Lm5ld1BhdGgo\nKTsKICAgICAgICAgICAgcGF0aC5zZXRNZXRhRGF0YShxLmdldE1ldGFtb2Rl\nbCgpLmdldFJlcG9zaXRvcnkoKS5nZXRDYWNoZWRNZXRhRGF0YShnZXRKYXZh\nVHlwZSgpKSk7CiAgICAgICAgfQogICAgICAgIGlmIChfbWVtYmVyICE9IG51\nbGwgJiYgIV9tZW1iZXIuaXNDb2xsZWN0aW9uKCkpIHsKICAgICAgICAgICAg\ncGF0aC5zZXRJbXBsaWNpdFR5cGUoZ2V0SmF2YVR5cGUoKSk7CiAgICAgICAg\nfQogICAgICAgIHBhdGguc2V0QWxpYXMocS5nZXRBbGlhcyh0aGlzKSk7CiAg\nICAgICAgcmV0dXJuIHBhdGg7CiAgICB9CiAgICAKICAgIHB1YmxpYyBQYXRo\nSW1wbDw/LD8+IGdldENvcnJlbGF0ZWRSb290KFN1YnF1ZXJ5SW1wbDw/PiBz\ndWJxdWVyeSkgewogICAgICAgIGlmIChzdWJxdWVyeSA9PSBudWxsKQogICAg\nICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICBQYXRoSW1wbDw/LD8+IHJv\nb3QgPSBnZXRJbm5lcm1vc3RQYXJlbnRQYXRoKCk7CiAgICAgICAgaWYgKHN1\nYnF1ZXJ5LmdldFJvb3RzKCkgIT0gbnVsbCAmJiBzdWJxdWVyeS5nZXRSb290\ncygpLmNvbnRhaW5zKHRoaXMpKQogICAgICAgICAgICByZXR1cm4gcm9vdDsK\nICAgICAgICByZXR1cm4gbnVsbDsKICAgIH0KICAgIAogICAgCiAgICBwdWJs\naWMgUGF0aEltcGw8Pyw/PiBnZXRDb3JyZWxhdGVkSm9pbihQYXRoSW1wbDw/\nLD8+IHBhdGgpIHsKICAgICAgICBpZiAocGF0aC5fY29ycmVsYXRlZFBhdGgg\nIT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIHBhdGguX2NvcnJlbGF0ZWRQ\nYXRoOwogICAgICAgIGlmIChwYXRoLl9wYXJlbnQgPT0gbnVsbCkKICAgICAg\nICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgcmV0dXJuIGdldENvcnJlbGF0\nZWRKb2luKHBhdGguX3BhcmVudCk7CiAgICB9CiAgICAKICAgIC8qKgogICAg\nICogQWZmaXJtcyBpZiB0aGlzIHJlY2VpdmVyIG9jY3VycyBpbiB0aGUgcm9v\ndHMgb2YgdGhlIGdpdmVuIHN1YnF1ZXJ5LgogICAgICovCiAgICBwdWJsaWMg\nYm9vbGVhbiBpblN1YnF1ZXJ5KFN1YnF1ZXJ5SW1wbDw/PiBzdWJxdWVyeSkg\newogICAgICAgIHJldHVybiBzdWJxdWVyeSAhPSBudWxsICYmIChzdWJxdWVy\neS5nZXRSb290cygpID09IG51bGwgPyBmYWxzZSA6IHN1YnF1ZXJ5LmdldFJv\nb3RzKCkuY29udGFpbnModGhpcykpOwogICAgfQogICAgCiAgICBwcm90ZWN0\nZWQgdm9pZCB0cmF2ZXJzZVBhdGgoUGF0aEltcGw8Pyw/PiBwYXJlbnQsICBv\ncmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLmV4cHMuUGF0aCBwYXRoLCBGaWVs\nZE1ldGFEYXRhIGZtZCkgewogICAgICAgIGJvb2xlYW4gYWxsb3dOdWxsID0g\ncGFyZW50ID09IG51bGwgPyBmYWxzZSA6IHBhcmVudCBpbnN0YW5jZW9mIEpv\naW4gCiAgICAgICAgICAgICYmICgoSm9pbjw/LD8+KXBhcmVudCkuZ2V0Sm9p\nblR5cGUoKSAhPSBKb2luVHlwZS5JTk5FUjsKICAgICAgICBGaWVsZE1ldGFE\nYXRhIGZtZDEgPSBwYXJlbnQuX21lbWJlciA9PSBudWxsID8gbnVsbCA6IHBh\ncmVudC5fbWVtYmVyLmZtZDsKICAgICAgICBQYXRoSW1wbDw/LD8+IHBhcmVu\ndDEgPSBwYXJlbnQuX3BhcmVudDsKICAgICAgICBpZiAocGFyZW50MSA9PSBu\ndWxsIHx8IHBhcmVudDEuZ2V0Q29ycmVsYXRlZFBhdGgoKSAhPSBudWxsKSB7\nCiAgICAgICAgICAgIGlmIChmbWQgIT0gbnVsbCkgCiAgICAgICAgICAgICAg\nICBwYXRoLmdldChmbWQsIGFsbG93TnVsbCk7CiAgICAgICAgICAgIHJldHVy\nbjsKICAgICAgICB9CiAgICAgICAgdHJhdmVyc2VQYXRoKHBhcmVudDEsIHBh\ndGgsIGZtZDEpOwogICAgICAgIGlmIChmbWQgIT0gbnVsbCkgCiAgICAgICAg\nICAgIHBhdGguZ2V0KGZtZCwgYWxsb3dOdWxsKTsKICAgIH0KICAgIAogICAg\nLyoqCiAgICAgKiAgR2V0cyBhIG5ldyBwYXRoIHRoYXQgcmVwcmVzZW50cyB0\naGUgZ2l2ZW4gc2luZ2xlLXZhbHVlZCBhdHRyaWJ1dGUgZnJvbSB0aGlzIHBh\ndGguCiAgICAgKi8KICAgIHB1YmxpYyA8WT4gUGF0aDxZPiBnZXQoU2luZ3Vs\nYXJBdHRyaWJ1dGU8PyBzdXBlciBYLCBZPiBhdHRyKSB7CiAgICAgICAgcmV0\ndXJuIG5ldyBQYXRoSW1wbDxYLFk+KHRoaXMsIChNZW1iZXJzLlNpbmd1bGFy\nQXR0cmlidXRlSW1wbDw/IHN1cGVyIFgsIFk+KWF0dHIsIGF0dHIuZ2V0SmF2\nYVR5cGUoKSk7CiAgICB9CiAgICAKICAgIC8qKgogICAgICogIEdldHMgYSBu\nZXcgcGF0aCB0aGF0IHJlcHJlc2VudHMgdGhlIGdpdmVuIG11bHRpLXZhbHVl\nZCBhdHRyaWJ1dGUgZnJvbSB0aGlzIHBhdGguCiAgICAgKi8KICAgIHB1Ymxp\nYyA8RSwgQyBleHRlbmRzIGphdmEudXRpbC5Db2xsZWN0aW9uPEU+PiBFeHBy\nZXNzaW9uPEM+ICBnZXQoUGx1cmFsQXR0cmlidXRlPFgsIEMsIEU+IGNvbGwp\nIHsKICAgICAgICByZXR1cm4gbmV3IFBhdGhJbXBsPFgsQz4odGhpcywgKE1l\nbWJlcnMuUGx1cmFsQXR0cmlidXRlSW1wbDw/IHN1cGVyIFgsIEMsIEU+KWNv\nbGwsIGNvbGwuZ2V0SmF2YVR5cGUoKSk7CiAgICB9CgogICAgLyoqCiAgICAg\nKiAgR2V0cyBhIG5ldyBwYXRoIHRoYXQgcmVwcmVzZW50cyB0aGUgZ2l2ZW4g\nbWFwLXZhbHVlZCBhdHRyaWJ1dGUgZnJvbSB0aGlzIHBhdGguCiAgICAgKi8K\nICAgIHB1YmxpYyA8SywgViwgTSBleHRlbmRzIGphdmEudXRpbC5NYXA8Sywg\nVj4+IEV4cHJlc3Npb248TT4gZ2V0KE1hcEF0dHJpYnV0ZTxYLCBLLCBWPiBt\nYXApIHsKICAgICAgICByZXR1cm4gbmV3IFBhdGhJbXBsPFgsTT4odGhpcywg\nKE1lbWJlcnMuTWFwQXR0cmlidXRlSW1wbDw/IHN1cGVyIFgsSyxWPiltYXAs\nIChDbGFzczxNPiltYXAuZ2V0SmF2YVR5cGUoKSk7CiAgICB9CiAgICAKICAg\nIC8qKgogICAgICogR2V0cyBhIG5ldyBwYXRoIHRoYXQgcmVwcmVzZW50cyB0\naGUgYXR0cmlidXRlIG9mIHRoZSBnaXZlbiBuYW1lIGZyb20gdGhpcyBwYXRo\nLgogICAgICogCiAgICAgKiBAZXhjZXB0aW9uIElsbGVnYWxBcmd1bWVudEV4\nY2VwdGlvbiBpZiB0aGlzIHBhdGggcmVwcmVzZW50cyBhIGJhc2ljIGF0dHJp\nYnV0ZSB0aGF0IGlzIGNhbiBub3QgYmUgdHJhdmVyc2VkIAogICAgICogZnVy\ndGhlci4KICAgICAqLwogICAgcHVibGljIDxZPiBQYXRoPFk+IGdldChTdHJp\nbmcgYXR0TmFtZSkgewogICAgICAgIFR5cGU8Pz4gdHlwZSA9IHRoaXMuZ2V0\nVHlwZSgpOwogICAgICAgIGlmICh0eXBlLmdldFBlcnNpc3RlbmNlVHlwZSgp\nID09IFBlcnNpc3RlbmNlVHlwZS5CQVNJQykgewogICAgICAgICAgICB0aHJv\ndyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uKHRoaXMgKyAiIGlzIGEg\nYmFzaWMgcGF0aCBhbmQgY2FuIG5vdCBiZSBuYXZpZ2F0ZWQgdG8gIiArIGF0\ndE5hbWUpOwogICAgICAgIH0KICAgICAgICAKICAgICAgICBNZW1iZXJzLk1l\nbWJlcjw/IHN1cGVyIFgsIFk+IG5leHQgPSAoTWVtYmVycy5NZW1iZXI8PyBz\ndXBlciBYLCBZPikgCiAgICAgICAgICAgKChNYW5hZ2VkVHlwZTw/IHN1cGVy\nIFg+KXR5cGUpLmdldEF0dHJpYnV0ZShhdHROYW1lKTsKICAgICAgICByZXR1\ncm4gbmV3IFBhdGhJbXBsPFgsWT4odGhpcywgbmV4dCwgbmV4dC5nZXRKYXZh\nVHlwZSgpKTsKICAgIH0KICAgIAogICAgcHVibGljIFR5cGU8Pz4gZ2V0VHlw\nZSgpIHsKICAgICAgICByZXR1cm4gX21lbWJlci5nZXRUeXBlKCk7CiAgICB9\nCiAgICAKICAgIC8qKgogICAgICogR2V0IHRoZSB0eXBlKCkgZXhwcmVzc2lv\nbiBjb3JyZXNwb25kaW5nIHRvIHRoaXMgcGF0aC4gCiAgICAgKi8KICAgIHB1\nYmxpYyBFeHByZXNzaW9uPENsYXNzPD8gZXh0ZW5kcyBYPj4gdHlwZSgpIHsK\nICAgICAgICByZXR1cm4gbmV3IEV4cHJlc3Npb25zLlR5cGU8Q2xhc3M8PyBl\neHRlbmRzIFg+Pih0aGlzKTsKICAgIH0KICAgIAogICAgcHVibGljIFN0cmlu\nZ0J1aWxkZXIgYXNWYWx1ZShBbGlhc0NvbnRleHQgcSkgewogICAgICAgIFN0\ncmluZ0J1aWxkZXIgYnVmZmVyID0gbmV3IFN0cmluZ0J1aWxkZXIoKTsKICAg\nICAgICBpZiAoX3BhcmVudCAhPSBudWxsKSB7CiAgICAgICAgICAgIFZhbHVl\nIHZhciA9IHEuZ2V0UmVnaXN0ZXJlZFZhcmlhYmxlKF9wYXJlbnQpOwogICAg\nICAgICAgICBidWZmZXIuYXBwZW5kKHZhciAhPSBudWxsID8gdmFyLmdldE5h\nbWUoKSA6IF9wYXJlbnQuYXNWYWx1ZShxKSkuYXBwZW5kKCIuIik7CiAgICAg\nICAgfQogICAgICAgIGlmIChfbWVtYmVyICE9IG51bGwpIHsKICAgICAgICAg\nICAgYnVmZmVyLmFwcGVuZChfbWVtYmVyLmZtZC5nZXROYW1lKCkpOwogICAg\nICAgIH0gCiAgICAgICAgcmV0dXJuIGJ1ZmZlcjsKICAgIH0KICAgIAogICAg\ncHVibGljIFN0cmluZ0J1aWxkZXIgYXNWYXJpYWJsZShBbGlhc0NvbnRleHQg\ncSkgewogICAgICAgIFZhbHVlIHZhciA9IHEuZ2V0UmVnaXN0ZXJlZFZhcmlh\nYmxlKHRoaXMpOwogICAgICAgIHJldHVybiBhc1ZhbHVlKHEpLmFwcGVuZCgi\nICIpLmFwcGVuZCh2YXIgPT0gbnVsbCA/ICI/IiA6IHZhci5nZXROYW1lKCkp\nOwogICAgfQp9Cg==\n","encoding":"base64"}

