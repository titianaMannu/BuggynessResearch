{"sha":"2d78df440306641ac57490a1e01a31203c0d2c5b","node_id":"MDQ6QmxvYjIwNjM2NDoyZDc4ZGY0NDAzMDY2NDFhYzU3NDkwYTFlMDFhMzEyMDNjMGQyYzVi","size":9638,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/2d78df440306641ac57490a1e01a31203c0d2c5b","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuamRiYzsK\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhLkNsYXNzTWFw\ncGluZzsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLm1ldGEuRGlz\nY3JpbWluYXRvcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLm1l\ndGEuRmllbGRNYXBwaW5nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpk\nYmMubWV0YS5NYXBwaW5nRGVmYXVsdHNJbXBsOwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLmpkYmMubWV0YS5WYWx1ZU1hcHBpbmc7CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhLlZhbHVlTWFwcGluZ0ltcGw7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhLlZlcnNpb247Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhLnN0cmF0cy5GbGF0\nQ2xhc3NTdHJhdGVneTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJj\nLm1ldGEuc3RyYXRzLk11bHRpQ29sdW1uVmVyc2lvblN0cmF0ZWd5OwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0YS5zdHJhdHMuTm9uZURp\nc2NyaW1pbmF0b3JTdHJhdGVneTsKaW1wb3J0IG9yZy5hcGFjaGUub3Blbmpw\nYS5qZGJjLm1ldGEuc3RyYXRzLk5vbmVWZXJzaW9uU3RyYXRlZ3k7CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhLnN0cmF0cy5OdW1iZXJW\nZXJzaW9uU3RyYXRlZ3k7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRi\nYy5tZXRhLnN0cmF0cy5TdWJjbGFzc0pvaW5EaXNjcmltaW5hdG9yU3RyYXRl\nZ3k7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhLnN0cmF0\ncy5WYWx1ZU1hcERpc2NyaW1pbmF0b3JTdHJhdGVneTsKaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS5qZGJjLm1ldGEuc3RyYXRzLlZlcnRpY2FsQ2xhc3NT\ndHJhdGVneTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNjaGVt\nYS5Db2x1bW47CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hl\nbWEuU2NoZW1hOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2No\nZW1hLlRhYmxlOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc3Fs\nLkpvaW5TeW50YXhlczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRh\nLkZpZWxkTWV0YURhdGE7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0\nYS5KYXZhVHlwZXM7CmltcG9ydCBzZXJwLnV0aWwuU3RyaW5nczsKCi8qKgog\nKiBTdXBwbGllcyBkZWZhdWx0IG1hcHBpbmcgaW5mb3JtYXRpb24gaW4gYWNj\nb3JkYW5jZSB3aXRoIEpQQSBzcGVjLgogKgogKiBAYXV0aG9yIFN0ZXZlIEtp\nbQogKiBAYXV0aG9yIEFiZSBXaGl0ZQogKiBAbm9qYXZhZG9jCiAqLwpwdWJs\naWMgY2xhc3MgUGVyc2lzdGVuY2VNYXBwaW5nRGVmYXVsdHMKICAgIGV4dGVu\nZHMgTWFwcGluZ0RlZmF1bHRzSW1wbCB7CgogICAgcHJpdmF0ZSBib29sZWFu\nIF9wcmVwZW5kRmllbGROYW1lVG9Kb2luVGFibGVJbnZlcnNlSm9pbkNvbHVt\nbnMgPSB0cnVlOwoKICAgIHB1YmxpYyBQZXJzaXN0ZW5jZU1hcHBpbmdEZWZh\ndWx0cygpIHsKICAgICAgICBzZXREZWZhdWx0TWlzc2luZ0luZm8odHJ1ZSk7\nCiAgICAgICAgc2V0U3RvcmVFbnVtT3JkaW5hbCh0cnVlKTsKICAgICAgICBz\nZXRPcmRlckxpc3RzKGZhbHNlKTsKICAgICAgICBzZXRBZGROdWxsSW5kaWNh\ndG9yKGZhbHNlKTsKICAgICAgICBzZXREaXNjcmltaW5hdG9yQ29sdW1uTmFt\nZSgiRFRZUEUiKTsKICAgIH0KCiAgICAvKioKICAgICAqIFdoZXRoZXIgdG8g\ncHJlcGVuZCB0aGUgZmllbGQgbmFtZSB0byB0aGUgZGVmYXVsdCBuYW1lIG9m\nIGludmVyc2Ugam9pbgogICAgICogY29sdW1ucyB3aXRoaW4gam9pbiB0YWJs\nZXMuICBEZWZhdWx0cyB0byB0cnVlIHBlciBzcGVjLCBidXQgc2V0IHRvIGZh\nbHNlCiAgICAgKiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG9sZGVyIHZlcnNp\nb25zIG9mIE9wZW5KUEEuCiAgICAgKi8KICAgIHB1YmxpYyBib29sZWFuIGdl\ndFByZXBlbmRGaWVsZE5hbWVUb0pvaW5UYWJsZUludmVyc2VKb2luQ29sdW1u\ncygpIHsKICAgICAgICByZXR1cm4gX3ByZXBlbmRGaWVsZE5hbWVUb0pvaW5U\nYWJsZUludmVyc2VKb2luQ29sdW1uczsKICAgIH0KCiAgICAvKioKICAgICAq\nIFdoZXRoZXIgdG8gcHJlcGVuZCB0aGUgZmllbGQgbmFtZSB0byB0aGUgZGVm\nYXVsdCBuYW1lIG9mIGludmVyc2Ugam9pbgogICAgICogY29sdW1ucyB3aXRo\naW4gam9pbiB0YWJsZXMuICBEZWZhdWx0cyB0byB0cnVlIHBlciBzcGVjLCBi\ndXQgc2V0IHRvIGZhbHNlCiAgICAgKiBmb3IgY29tcGF0aWJpbGl0eSB3aXRo\nIG9sZGVyIHZlcnNpb25zIG9mIE9wZW5KUEEuCiAgICAgKi8KICAgIHB1Ymxp\nYyB2b2lkIHNldFByZXBlbmRGaWVsZE5hbWVUb0pvaW5UYWJsZUludmVyc2VK\nb2luQ29sdW1ucyhib29sZWFuIHZhbCkgewogICAgICAgIF9wcmVwZW5kRmll\nbGROYW1lVG9Kb2luVGFibGVJbnZlcnNlSm9pbkNvbHVtbnMgPSB2YWw7CiAg\nICB9CgogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgT2JqZWN0IGdldFN0cmF0\nZWd5KFZlcnNpb24gdmVycywgYm9vbGVhbiBhZGFwdCkgewogICAgICAgIE9i\namVjdCBzdHJhdCA9IHN1cGVyLmdldFN0cmF0ZWd5KHZlcnMsIGFkYXB0KTsK\nICAgICAgICBDbGFzc01hcHBpbmcgY2xzID0gdmVycy5nZXRDbGFzc01hcHBp\nbmcoKTsKICAgICAgICBpZiAoc3RyYXQgIT0gbnVsbCB8fCBjbHMuZ2V0Sm9p\nbmFibGVQQ1N1cGVyY2xhc3NNYXBwaW5nKCkgIT0gbnVsbAogICAgICAgICAg\nICB8fCBjbHMuZ2V0VmVyc2lvbkZpZWxkKCkgIT0gbnVsbCkKICAgICAgICAg\nICAgcmV0dXJuIHN0cmF0OwoKICAgICAgICBpbnQgbkNvbHVtbiA9IHZlcnMu\nZ2V0TWFwcGluZ0luZm8oKS5nZXRDb2x1bW5zKCkuc2l6ZSgpOwogICAgICAg\nIHN3aXRjaCAobkNvbHVtbikgewogICAgICAgICAgICBjYXNlIDAgOiByZXR1\ncm4gTm9uZVZlcnNpb25TdHJhdGVneS5nZXRJbnN0YW5jZSgpOwogICAgICAg\nICAgICBjYXNlIDEgOiByZXR1cm4gbmV3IE51bWJlclZlcnNpb25TdHJhdGVn\neSgpOwogICAgICAgICAgICBkZWZhdWx0OiByZXR1cm4gbmV3IE11bHRpQ29s\ndW1uVmVyc2lvblN0cmF0ZWd5KCk7CiAgICAgICAgfQogICAgfQoKICAgIEBP\ndmVycmlkZQogICAgcHVibGljIE9iamVjdCBnZXRTdHJhdGVneShEaXNjcmlt\naW5hdG9yIGRpc2MsIGJvb2xlYW4gYWRhcHQpIHsKICAgICAgICBPYmplY3Qg\nc3RyYXQgPSBzdXBlci5nZXRTdHJhdGVneShkaXNjLCBhZGFwdCk7CiAgICAg\nICAgQ2xhc3NNYXBwaW5nIGNscyA9IGRpc2MuZ2V0Q2xhc3NNYXBwaW5nKCk7\nCiAgICAgICAgaWYgKHN0cmF0ICE9IG51bGwgfHwgY2xzLmdldEpvaW5hYmxl\nUENTdXBlcmNsYXNzTWFwcGluZygpICE9IG51bGwKICAgICAgICAgICAgfHwg\nZGlzYy5nZXRNYXBwaW5nSW5mbygpLmdldFZhbHVlKCkgIT0gbnVsbCkKICAg\nICAgICAgICAgcmV0dXJuIHN0cmF0OwoKICAgICAgICAvLyBkb24ndCB1c2Ug\nYSBjb2x1bW4tYmFzZWQgZGlzY3JpbWluYXRvciBhcHByb2FjaCB1bmxlc3Mg\ndXNlciBoYXMgc2V0CiAgICAgICAgLy8gYSBjb2x1bW4gZXhwbGljaXRseSBv\nciBpcyB1c2luZyBmbGF0IGluaGVyaXRhbmNlIGV4cGxpY2l0bHkKICAgICAg\nICBpZiAoIWRpc2MuZ2V0TWFwcGluZ0luZm8oKS5nZXRDb2x1bW5zKCkuaXNF\nbXB0eSgpKQogICAgICAgICAgICByZXR1cm4gbmV3IFZhbHVlTWFwRGlzY3Jp\nbWluYXRvclN0cmF0ZWd5KCk7CgogICAgICAgIENsYXNzTWFwcGluZyBiYXNl\nID0gY2xzOwogICAgICAgIHdoaWxlIChiYXNlLmdldE1hcHBpbmdJbmZvKCku\nZ2V0SGllcmFyY2h5U3RyYXRlZ3koKSA9PSBudWxsCiAgICAgICAgICAgICYm\nIGJhc2UuZ2V0UENTdXBlcmNsYXNzTWFwcGluZygpICE9IG51bGwpCiAgICAg\nICAgICAgIGJhc2UgPSBiYXNlLmdldFBDU3VwZXJjbGFzc01hcHBpbmcoKTsK\nCiAgICAgICAgc3RyYXQgPSBiYXNlLmdldE1hcHBpbmdJbmZvKCkuZ2V0SGll\ncmFyY2h5U3RyYXRlZ3koKTsKICAgICAgICBpZiAoRmxhdENsYXNzU3RyYXRl\nZ3kuQUxJQVMuZXF1YWxzKHN0cmF0KSkKICAgICAgICAgICAgcmV0dXJuIG5l\ndyBWYWx1ZU1hcERpc2NyaW1pbmF0b3JTdHJhdGVneSgpOwogICAgICAgIGlm\nIChWZXJ0aWNhbENsYXNzU3RyYXRlZ3kuQUxJQVMuZXF1YWxzKHN0cmF0KQog\nICAgICAgICAgICAmJiBkaWN0LmpvaW5TeW50YXggIT0gSm9pblN5bnRheGVz\nLlNZTlRBWF9UUkFESVRJT05BTCkKICAgICAgICAgICAgcmV0dXJuIG5ldyBT\ndWJjbGFzc0pvaW5EaXNjcmltaW5hdG9yU3RyYXRlZ3koKTsKICAgICAgICBy\nZXR1cm4gTm9uZURpc2NyaW1pbmF0b3JTdHJhdGVneS5nZXRJbnN0YW5jZSgp\nOwogICAgfQoKICAgIEBPdmVycmlkZQogICAgcHVibGljIFN0cmluZyBnZXRU\nYWJsZU5hbWUoQ2xhc3NNYXBwaW5nIGNscywgU2NoZW1hIHNjaGVtYSkgewog\nICAgICAgIGlmIChjbHMuZ2V0VHlwZUFsaWFzKCkgIT0gbnVsbCkKICAgICAg\nICAgICAgcmV0dXJuIGNscy5nZXRUeXBlQWxpYXMoKTsKICAgICAgICByZXR1\ncm4gU3RyaW5ncy5nZXRDbGFzc05hbWUoY2xzLmdldERlc2NyaWJlZFR5cGUo\nKSkucmVwbGFjZSgnJCcsICdfJyk7CiAgICB9CgogICAgQE92ZXJyaWRlCiAg\nICBwdWJsaWMgU3RyaW5nIGdldFRhYmxlTmFtZShGaWVsZE1hcHBpbmcgZm0s\nIFNjaGVtYSBzY2hlbWEpIHsKICAgICAgICAvLyBiYXNlIG5hbWUgaXMgdGFi\nbGUgb2YgZGVmaW5pbmcgdHlwZSArICdfJwogICAgICAgIENsYXNzTWFwcGlu\nZyBjbG0gPSBmbS5nZXREZWZpbmluZ01hcHBpbmcoKTsKICAgICAgICBUYWJs\nZSB0YWJsZSA9IGdldFRhYmxlKGNsbSk7CiAgICAgICAgCiAgICAgICAgU3Ry\naW5nIG5hbWUgPSB0YWJsZS5nZXROYW1lKCk7CgogICAgICAgIC8vIGlmIHRo\naXMgaXMgYW4gYXNzb2NhdGlvbiB0YWJsZSwgc3BlYyBzYXlzIHRvIHN1ZmZp\neCB3aXRoIHRhYmxlIG9mCiAgICAgICAgLy8gdGhlIHJlbGF0ZWQgdHlwZS4g\nc3BlYyBkb2Vzbid0IGNvdmVyIG90aGVyIGNhc2VzOyB3ZSdyZSBnb2luZyB0\nbwogICAgICAgIC8vIHN1ZmZpeCB3aXRoIHRoZSBmaWVsZCBuYW1lCiAgICAg\nICAgQ2xhc3NNYXBwaW5nIHJlbCA9IGZtLmdldEVsZW1lbnRNYXBwaW5nKCku\nZ2V0VHlwZU1hcHBpbmcoKTsKICAgICAgICBib29sZWFuIGFzc29jID0gcmVs\nICE9IG51bGwgJiYgcmVsLmdldFRhYmxlKCkgIT0gbnVsbAogICAgICAgICAg\nICAmJiBmbS5nZXRUeXBlQ29kZSgpICE9IEphdmFUeXBlcy5NQVA7CiAgICAg\nICAgU3RyaW5nIG5hbWUyID0gbnVsbDsKICAgICAgICBpZiAoYXNzb2MpIHsK\nICAgICAgICAgICAgbmFtZTIgPSByZWwuZ2V0VGFibGUoKS5nZXROYW1lKCk7\nCiAgICAgICAgfQogICAgICAgIGVsc2UgewogICAgICAgICAgICBuYW1lMiA9\nIGZtLmdldE5hbWUoKTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgbmFt\nZSA9IGRpY3QuY29tYmluZU5hbWVzKG5hbWUsIG5hbWUyKTsKICAgICAgICAK\nICAgICAgICByZXR1cm4gbmFtZS5yZXBsYWNlKCckJywgJ18nKTsKICAgIH0K\nICAgIAogICAgcHJpdmF0ZSBUYWJsZSBnZXRUYWJsZShDbGFzc01hcHBpbmcg\nY2xtKSB7CiAgICAgICAgVGFibGUgdGFibGUgPSBjbG0uZ2V0VGFibGUoKTsK\nICAgICAgICBpZiAodGFibGUgPT0gbnVsbCkgewogICAgICAgICAgICBWYWx1\nZU1hcHBpbmdJbXBsIHZhbHVlID0KICAgICAgICAgICAgICAgICAgICAoVmFs\ndWVNYXBwaW5nSW1wbCljbG0uZ2V0RW1iZWRkaW5nTWV0YURhdGEoKTsKICAg\nICAgICAgICAgaWYgKHZhbHVlID09IG51bGwpCiAgICAgICAgICAgICAgICBy\nZXR1cm4gdGFibGU7CiAgICAgICAgICAgIEZpZWxkTWV0YURhdGEgZmllbGQg\nPSB2YWx1ZS5nZXRGaWVsZE1ldGFEYXRhKCk7CiAgICAgICAgICAgIGNsbSA9\nIChDbGFzc01hcHBpbmcpZmllbGQuZ2V0RGVmaW5pbmdNZXRhRGF0YSgpOwog\nICAgICAgICAgICByZXR1cm4gZ2V0VGFibGUoY2xtKTsKICAgICAgICB9CiAg\nICAgICAgcmV0dXJuIHRhYmxlOwogICAgfQoKICAgIEBPdmVycmlkZQogICAg\ncHVibGljIHZvaWQgcG9wdWxhdGVKb2luQ29sdW1uKEZpZWxkTWFwcGluZyBm\nbSwgVGFibGUgbG9jYWwsIFRhYmxlIGZvcmVpZ24sCiAgICAgICAgQ29sdW1u\nIGNvbCwgT2JqZWN0IHRhcmdldCwgaW50IHBvcywgaW50IGNvbHMpIHsKICAg\nICAgICAvLyBvbmx5IHVzZSBzcGVjIGRlZmF1bHRzIHdpdGggY29sdW1uIHRh\ncmdldHMKICAgICAgICBpZiAoISh0YXJnZXQgaW5zdGFuY2VvZiBDb2x1bW4p\nKQogICAgICAgICAgICByZXR1cm47CgogICAgICAgIC8vIGlmIHRoaXMgaXMg\nYSBiaWRpIHJlbGF0aW9uLCBwcmVmaXggd2l0aCBpbnZlcnNlIGZpZWxkIG5h\nbWUsIGVsc2UKICAgICAgICAvLyBwcmVmaXggd2l0aCBvd25pbmcgZW50aXR5\nIG5hbWUKICAgICAgICBGaWVsZE1hcHBpbmdbXSBpbnZlcnNlcyA9IGZtLmdl\ndEludmVyc2VNYXBwaW5ncygpOwogICAgICAgIFN0cmluZyBuYW1lOwogICAg\nICAgIGlmIChpbnZlcnNlcy5sZW5ndGggPiAwKQogICAgICAgICAgICBuYW1l\nID0gaW52ZXJzZXNbMF0uZ2V0TmFtZSgpOwogICAgICAgIGVsc2UKICAgICAg\nICAgICAgbmFtZSA9IGZtLmdldERlZmluaW5nTWFwcGluZygpLmdldFR5cGVB\nbGlhcygpOwogICAgICAgIFN0cmluZyB0YXJnZXROYW1lID0gKChDb2x1bW4p\nIHRhcmdldCkuZ2V0TmFtZSgpOwogICAgICAgIFN0cmluZyB0ZW1wTmFtZSA9\nIG51bGw7CiAgICAgICAgaWYgKChuYW1lLmxlbmd0aCgpICsgdGFyZ2V0TmFt\nZS5sZW5ndGgoKSkgPj0gZGljdC5tYXhDb2x1bW5OYW1lTGVuZ3RoKQogICAg\nICAgICAgICB0ZW1wTmFtZSA9IG5hbWUuc3Vic3RyaW5nKDAsIGRpY3QubWF4\nQ29sdW1uTmFtZUxlbmd0aAogICAgICAgICAgICAgICAgICAgIC0gdGFyZ2V0\nTmFtZS5sZW5ndGgoKSAtIDEpOwogICAgICAgIC8vIHN1ZmZpeCB3aXRoICdf\nJyArIHRhcmdldCBjb2x1bW4KICAgICAgICBpZiAodGVtcE5hbWUgPT0gbnVs\nbCkKICAgICAgICAgICAgdGVtcE5hbWUgPSBuYW1lOwogICAgICAgIG5hbWUg\nPSBkaWN0LmNvbWJpbmVOYW1lcyh0ZW1wTmFtZSwgdGFyZ2V0TmFtZSk7CiAg\nICAgICAgbmFtZSA9IGRpY3QuZ2V0VmFsaWRDb2x1bW5OYW1lKG5hbWUsIGZv\ncmVpZ24pOwogICAgICAgIGNvbC5zZXROYW1lKG5hbWUpOwogICAgfQoKICAg\nIEBPdmVycmlkZQogICAgcHVibGljIHZvaWQgcG9wdWxhdGVGb3JlaWduS2V5\nQ29sdW1uKFZhbHVlTWFwcGluZyB2bSwgU3RyaW5nIG5hbWUsCiAgICAgICAg\nVGFibGUgbG9jYWwsIFRhYmxlIGZvcmVpZ24sIENvbHVtbiBjb2wsIE9iamVj\ndCB0YXJnZXQsIGJvb2xlYW4gaW52ZXJzZSwKICAgICAgICBpbnQgcG9zLCBp\nbnQgY29scykgewogICAgICAgIGJvb2xlYW4gZWxlbSA9IHZtID09IHZtLmdl\ndEZpZWxkTWFwcGluZygpLmdldEVsZW1lbnQoKQogICAgICAgICAgICAmJiB2\nbS5nZXRGaWVsZE1hcHBpbmcoKS5nZXRUeXBlQ29kZSgpICE9IEphdmFUeXBl\ncy5NQVA7CgogICAgICAgIC8vIGlmIHRoaXMgaXMgYSBub24taW52ZXJzZSBj\nb2xsZWN0aW9uIGVsZW1lbnQga2V5LCBpdCBtdXN0IGJlIGluCiAgICAgICAg\nLy8gYSBqb2luIHRhYmxlOiBpZiB3ZSdyZSBub3QgcHJlcGVuZGluZyB0aGUg\nZmllbGQgbmFtZSwgbGVhdmUgdGhlCiAgICAgICAgLy8gZGVmYXVsdAogICAg\nICAgIGlmICghX3ByZXBlbmRGaWVsZE5hbWVUb0pvaW5UYWJsZUludmVyc2VK\nb2luQ29sdW1ucyAmJiAhaW52ZXJzZSAmJiBlbGVtKQogICAgICAgICAgICBy\nZXR1cm47CgogICAgICAgIC8vIG90aGVyd2lzZSBqcGEgYWx3YXlzIHVzZXMg\nPGZpZWxkPl88cGtjb2w+IGZvciBjb2x1bW4gbmFtZSwgZXZlbgogICAgICAg\nIC8vIHdoZW4gb25seSBvbmUgY29sCiAgICAgICAgaWYgKHRhcmdldCBpbnN0\nYW5jZW9mIENvbHVtbikgewogICAgICAgICAgICBpZiAobmFtZSA9PSBudWxs\nKSB7CiAgICAgICAgICAgICAgICBuYW1lID0gY29sLmdldE5hbWUoKTsKICAg\nICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGlmIChlbGVtKQog\nICAgICAgICAgICAgICAgICAgIG5hbWUgPSB2bS5nZXRGaWVsZE1hcHBpbmco\nKS5nZXROYW1lKCk7CiAgICAgICAgICAgICAgICBpZiAoaXNSZW1vdmVIdW5n\nYXJpYW5Ob3RhdGlvbigpKQogICAgICAgICAgICAgICAgICAgIG5hbWUgPSBy\nZW1vdmVIdW5nYXJpYW5Ob3RhdGlvbihuYW1lKTsKICAgICAgICAgICAgICAg\nIG5hbWUgPSBkaWN0LmNvbWJpbmVOYW1lcyhuYW1lLCAoKENvbHVtbil0YXJn\nZXQpLmdldE5hbWUoKSk7CgogICAgICAgICAgICAgICAgLy8gTm8gbmVlZCB0\nbyBjaGVjayBmb3IgdW5pcXVlbmVzcy4KICAgICAgICAgICAgICAgIG5hbWUg\nPSBkaWN0LmdldFZhbGlkQ29sdW1uTmFtZShuYW1lLCBsb2NhbCwgZmFsc2Up\nOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGNvbC5zZXROYW1lKG5hbWUp\nOwogICAgICAgIH0KICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyB2\nb2lkIHBvcHVsYXRlQ29sdW1ucyhWZXJzaW9uIHZlcnMsIFRhYmxlIHRhYmxl\nLCBDb2x1bW5bXSBjb2xzKSB7CiAgICAgICAgLy8gY2hlY2sgZm9yIHZlcnNp\nb24gZmllbGQgYW5kIHVzZSBpdHMgbmFtZSBhcyBjb2x1bW4gbmFtZQogICAg\nICAgIEZpZWxkTWFwcGluZyBmbSA9IHZlcnMuZ2V0Q2xhc3NNYXBwaW5nKCku\nZ2V0VmVyc2lvbkZpZWxkTWFwcGluZygpOwogICAgICAgIGlmIChmbSAhPSBu\ndWxsICYmIGNvbHMubGVuZ3RoID09IDEpCiAgICAgICAgICAgIGNvbHNbMF0u\nc2V0TmFtZShmbS5nZXROYW1lKCkpOwogICAgICAgIGVsc2UKICAgICAgICAg\nICAgc3VwZXIucG9wdWxhdGVDb2x1bW5zKHZlcnMsIHRhYmxlLCBjb2xzKTsK\nICAgIH0KfQo=\n","encoding":"base64"}

