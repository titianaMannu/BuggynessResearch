{"sha":"953e88084f9caa44d579dfc1418f154151b1d51c","node_id":"MDQ6QmxvYjIwNjM2NDo5NTNlODgwODRmOWNhYTQ0ZDU3OWRmYzE0MThmMTU0MTUxYjFkNTFj","size":14280,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/953e88084f9caa44d579dfc1418f154151b1d51c","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuY29uZjsKCmltcG9ydCBqYXZh\nLnV0aWwuSGFzaE1hcDsKaW1wb3J0IGphdmEudXRpbC5NYXA7CgppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLmxpYi5sb2cuTG9nOwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNlLk9wZW5KUEFFbnRpdHlNYW5hZ2Vy\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNlLk9wZW5K\nUEFFbnRpdHlNYW5hZ2VyRmFjdG9yeTsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5wZXJzaXN0ZW5jZS5PcGVuSlBBUGVyc2lzdGVuY2U7CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuT3BlbkpQQVF1ZXJ5Owpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNlLnF1ZXJ5LmNv\nbW1vbi5hcHBzLlFUaW1lb3V0OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLnBlcnNpc3RlbmNlLnRlc3QuU2luZ2xlRU1GVGVzdENhc2U7CgovKioKICog\nVGVzdHMgdGhlIGZvbGxvd2luZyBKUEEgMi4wIFBlcnNpc3RlbmNlIFVuaXQg\nUHJvcGVydGllcyBzY2VuYXJpb3M6CiAqICAgMSkgcGVyc2lzdGVuY2UueG1s\nIHByb3ZpZGVkIHByb3BlcnRpZXMgCiAqICAgICAgMWEpIE5vIFBVIHByb3Bl\ncnRpZXMgcHJvdmlkZWQgaXMgc2FtZSBhcyBubyB0aW1lb3V0IChKREJDIGRl\nZmluZWQpCiAqICAgICAgMWIpIFBVIHByb3ZpZGVkIHByb3BlcnRpZXMgdHJh\nbnNsYXRlZCBpbnRvIGNvbmZpZwogKiAgIDIpIE1hcCBvZiBwcm9wZXJ0aWVz\nIHByb3ZpZGVkIHRvIGNyZWF0ZUVNRigpCiAqICAgICAgMmEpIEVNRiBwcm9w\ncyBjYW4gYmUgc2V0IHdoZW4gbm8gUFUgcHJvcHMgcHJvdmlkZWQKICogICAg\nICAyYikgRU1GIHByb3BzIG92ZXJyaWRlIFBVIHNldCBwcm9wZXJ0aWVzIGlu\nIGNvbmZpZwogKiAgIDMpIFF1ZXJ5SGludHMgb3ZlcnJpZGUgZGVmYXVsdCB2\nYWx1ZXMgZnJvbSBQVSBvciBFTUYgKDJiKQogKiAgIDQpIFF1ZXJ5LnNldEhp\nbnQoKSAKICogICAgICA0YSkgY2FuIG92ZXJyaWRlIGRlZmF1bHQgdmFsdWVz\nIGZyb20gUFUgb3IgRU1GICgyYSkKICogICAgICA0YikgY2FuIG92ZXJyaWRl\nIFF1ZXJ5SGludHMgKDMpCiAqCiAqIEB2ZXJzaW9uICRSZXYkICREYXRlJAog\nKi8KcHVibGljIGNsYXNzIFRlc3RRdWVyeVByb3BlcnRpZXMgZXh0ZW5kcyBT\naW5nbGVFTUZUZXN0Q2FzZSB7CiAgICAKICAgIHByaXZhdGUgTWFwPFN0cmlu\nZyxTdHJpbmc+IHByb3BzID0gbnVsbDsKCiAgICBAT3ZlcnJpZGUKICAgIHB1\nYmxpYyB2b2lkIHNldFVwKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAg\nLy8gc2V0dXAgdXNpbmcgYSBzaW1wbGUgZW50aXR5CiAgICAgICAgc3VwZXIu\nc2V0VXAoUVRpbWVvdXQuY2xhc3MsIENMRUFSX1RBQkxFUyk7CiAgICAgICAg\nLy8gY3JlYXRlIHRoZSBNYXAgdG8gdGVzdCBvdmVycmlkZXMKICAgICAgICBw\ncm9wcyA9IG5ldyBIYXNoTWFwPFN0cmluZyxTdHJpbmc+KCk7CiAgICAgICAg\ncHJvcHMucHV0KCJqYXZheC5wZXJzaXN0ZW5jZS5sb2NrLnRpbWVvdXQiLCAi\nMTIwMDAiKTsKICAgICAgICBwcm9wcy5wdXQoImphdmF4LnBlcnNpc3RlbmNl\nLnF1ZXJ5LnRpbWVvdXQiLCAiNzAwMCIpOwogICAgfQogICAgCiAgICBwdWJs\naWMgdm9pZCB0ZXN0Tm9Qcm9wZXJ0aWVzKCkgewogICAgICAgIGdldExvZygp\nLnRyYWNlKCJ0ZXN0Tm9Qcm9wZXJ0aWVzKCkgLSBubyBwcm9wZXJ0aWVzIGlu\nIHBlcnNpc3RlbmNlLnhtbCIpOwogICAgICAgIE9wZW5KUEFFbnRpdHlNYW5h\nZ2VyRmFjdG9yeSBlbWYxID0gbnVsbCwgZW1mMiA9IG51bGw7CiAgICAgICAg\nT3BlbkpQQUVudGl0eU1hbmFnZXIgZW0xID0gbnVsbCwgZW0yID0gbnVsbDsK\nICAgICAgICAKICAgICAgICB0cnkgewogICAgICAgICAgICBPcGVuSlBBUXVl\ncnkgcTsKICAgICAgICAgICAgTWFwPFN0cmluZywgT2JqZWN0PiBoaW50czsK\nICAgICAgICAgICAgSW50ZWdlciB0aW1lb3V0OwogICAgICAgICAgICBJbnRl\nZ2VyIGxUaW1lID0gbmV3IEludGVnZXIoMCk7CiAgICAgICAgICAgIEludGVn\nZXIgcVRpbWUgPSBuZXcgSW50ZWdlcigwKTsKICAgICAgICAgICAgCiAgICAg\nICAgICAgIC8vIGNyZWF0ZSBvdXIgUFUgd2l0aG91dCBwcm9wZXJ0aWVzCiAg\nICAgICAgICAgIGVtZjEgPSBPcGVuSlBBUGVyc2lzdGVuY2UuY3JlYXRlRW50\naXR5TWFuYWdlckZhY3RvcnkoCiAgICAgICAgICAgICAgICAicXRpbWVvdXQt\nbm8tcHJvcGVydGllcyIsICJwZXJzaXN0ZW5jZTMueG1sIik7CiAgICAgICAg\nICAgIGFzc2VydE5vdE51bGwoZW1mMSk7CiAgICAgICAgICAgIGVtZjIgPSBP\ncGVuSlBBUGVyc2lzdGVuY2UuY3JlYXRlRW50aXR5TWFuYWdlckZhY3Rvcnko\nCiAgICAgICAgICAgICAgICAicXRpbWVvdXQtbm8tcHJvcGVydGllcyIsICJw\nZXJzaXN0ZW5jZTMueG1sIiwgcHJvcHMpOwogICAgICAgICAgICBhc3NlcnRO\nb3ROdWxsKGVtZjIpOwogICAgICAgICAgICAKICAgICAgICAgICAgLy89PT09\nPT09PT09PT09CiAgICAgICAgICAgIC8vIFRlc3QgZm9yIDFhKQogICAgICAg\nICAgICAvLz09PT09PT09PT09PT0KICAgICAgICAgICAgLy8gdmVyaWZ5IG5v\nIGNvbmZpZyBwcm9wZXJ0aWVzIGZyb20gcGVyc2lzdGVuY2UueG1sCiAgICAg\nICAgICAgIE9wZW5KUEFDb25maWd1cmF0aW9uIGNvbmYxID0gZW1mMS5nZXRD\nb25maWd1cmF0aW9uKCk7CiAgICAgICAgICAgIGFzc2VydE5vdE51bGwoY29u\nZjEpOwogICAgICAgICAgICBhc3NlcnRFcXVhbHMoIkV4cGVjdGVkIG5vIGRl\nZmF1bHQgbG9jayB0aW1lb3V0IiwgbFRpbWUuaW50VmFsdWUoKSwKICAgICAg\nICAgICAgICAgIGNvbmYxLmdldExvY2tUaW1lb3V0KCkpOwogICAgICAgICAg\nICBhc3NlcnRFcXVhbHMoIkV4cGVjdGVkIG5vIGRlZmF1bHQgcXVlcnkgdGlt\nZW91dCIsIHFUaW1lLmludFZhbHVlKCksCiAgICAgICAgICAgICAgICBjb25m\nMS5nZXRRdWVyeVRpbWVvdXQoKSk7CiAgICAgICAgICAgIC8vIHZlcmlmeSBR\ndWVyeSByZWNlaXZlcyBubyBwcm9wZXJ0aWVzCiAgICAgICAgICAgIGVtMSA9\nIGVtZjEuY3JlYXRlRW50aXR5TWFuYWdlcigpOwogICAgICAgICAgICBhc3Nl\ncnROb3ROdWxsKGVtMSk7CiAgICAgICAgICAgIHEgPSBlbTEuY3JlYXRlTmFt\nZWRRdWVyeSgiTm9IaW50TGlzdCIpOwogICAgICAgICAgICAvLyB2ZXJpZnkg\nbm8gUXVlcnkgaGludHMKICAgICAgICAgICAgaGludHMgPSBxLmdldEhpbnRz\nKCk7CiAgICAgICAgICAgIGFzc2VydEZhbHNlKGhpbnRzLmNvbnRhaW5zS2V5\nKCJqYXZheC5wZXJzaXN0ZW5jZS5sb2NrLnRpbWVvdXQiKSk7CiAgICAgICAg\nICAgIGFzc2VydEZhbHNlKGhpbnRzLmNvbnRhaW5zS2V5KCJqYXZheC5wZXJz\naXN0ZW5jZS5xdWVyeS50aW1lb3V0IikpOwogICAgICAgICAgICAvLyB2ZXJp\nZnkgZGVmYXVsdCBjb25maWcgdmFsdWVzIG9mIG5vIHRpbWVvdXRzCiAgICAg\nICAgICAgIHRpbWVvdXQgPSBxLmdldEZldGNoUGxhbigpLmdldExvY2tUaW1l\nb3V0KCk7CiAgICAgICAgICAgIGFzc2VydEVxdWFscygiRXhwZWN0ZWQgbm8g\nZGVmYXVsdCBsb2NrIHRpbWVvdXQiLCBsVGltZS5pbnRWYWx1ZSgpLAogICAg\nICAgICAgICAgICAgdGltZW91dC5pbnRWYWx1ZSgpKTsKICAgICAgICAgICAg\ndGltZW91dCA9IHEuZ2V0RmV0Y2hQbGFuKCkuZ2V0UXVlcnlUaW1lb3V0KCk7\nCiAgICAgICAgICAgIGFzc2VydEVxdWFscygiRXhwZWN0ZWQgbm8gZGVmYXVs\ndCBxdWVyeSB0aW1lb3V0IiwgcVRpbWUuaW50VmFsdWUoKSwKICAgICAgICAg\nICAgICAgIHRpbWVvdXQuaW50VmFsdWUoKSk7CgogICAgICAgICAgICAvLz09\nPT09PT09PT09PT0KICAgICAgICAgICAgLy8gVGVzdCBmb3IgMmEpCiAgICAg\nICAgICAgIC8vPT09PT09PT09PT09PQogICAgICAgICAgICAvLyB2ZXJpZnkg\ncHJvcGVydGllcyBpbiBNYXAgb3ZlcnJpZGUgcGVyc2lzdGVuY2UueG1sCiAg\nICAgICAgICAgIE9wZW5KUEFDb25maWd1cmF0aW9uIGNvbmYyID0gZW1mMi5n\nZXRDb25maWd1cmF0aW9uKCk7CiAgICAgICAgICAgIGFzc2VydE5vdE51bGwo\nY29uZjIpOwogICAgICAgICAgICBsVGltZSA9IDEyMDAwOwogICAgICAgICAg\nICBxVGltZSA9IDcwMDA7CiAgICAgICAgICAgIGFzc2VydEVxdWFscygiRXhw\nZWN0ZWQgTWFwIHVwZGF0ZWQgbG9jayB0aW1lb3V0IiwgbFRpbWUuaW50VmFs\ndWUoKSwKICAgICAgICAgICAgICAgIGNvbmYyLmdldExvY2tUaW1lb3V0KCkp\nOwogICAgICAgICAgICBhc3NlcnRFcXVhbHMoIkV4cGVjdGVkIE1hcCB1cGRh\ndGVkIHF1ZXJ5IHRpbWVvdXQiLCBxVGltZS5pbnRWYWx1ZSgpLAogICAgICAg\nICAgICAgICAgY29uZjIuZ2V0UXVlcnlUaW1lb3V0KCkpOwogICAgICAgICAg\nICAvLyBWZXJpZnkgUXVlcnkgcmVjZWl2ZXMgdGhlIHByb3BlcnRpZXMKICAg\nICAgICAgICAgZW0yID0gZW1mMi5jcmVhdGVFbnRpdHlNYW5hZ2VyKCk7CiAg\nICAgICAgICAgIGFzc2VydE5vdE51bGwoZW0yKTsKICAgICAgICAgICAgcSA9\nIGVtMi5jcmVhdGVOYW1lZFF1ZXJ5KCJOb0hpbnRMaXN0Iik7CiAgICAgICAg\nICAgIC8vIENhbm5vdCB2ZXJpZnkgcHJvcGVydGllcyBhcmUgcGFzc2VkIHRo\ncm91Z2ggYXMgUXVlcnkgaGludHMKICAgICAgICAgICAgLyoKICAgICAgICAg\nICAgICogRm9sbG93aW5nIHRlc3Qgd291bGQgZmFpbCwgYXMgdGhlIGNvZGUg\nY3VycmVudGx5IGRvZXMgbm90IHBhc3MKICAgICAgICAgICAgICogdGhlIHBy\nb3BlcnRpZXMgZG93biBhcyBoaW50cywgYnV0IG9ubHkgYXMgY29uZmlnIHNl\ndHRpbmdzLgogICAgICAgICAgICAgKiAKICAgICAgICAgICAgICogVGhlIHNw\nZWMgc2F5cyB0aGF0IFBVIG9yIE1hcCBwcm92aWRlZCBwcm9wZXJ0aWVzIHRv\nIHRoZSBFTUYKICAgICAgICAgICAgICogd2lsbCBiZSB1c2VkIGFzIGRlZmF1\nbHRzIGFuZCB0aGF0IFF1ZXJ5LnNldEhpbnQoKSBjYW4gYmUgdXNlZAogICAg\nICAgICAgICAgKiB0byBvdmVycmlkZSwgYnV0IHRoZXJlIGlzIG5vIHJlcXVp\ncmVtZW50IGZvciBnZXRIaW50cygpIHRvIAogICAgICAgICAgICAgKiByZXR1\ncm4gdGhlc2UgZGVmYXVsdCB2YWx1ZXMuCiAgICAgICAgICAgICAqICAKICAg\nICAgICAgICAgaGludHMgPSBxLmdldEhpbnRzKCk7CiAgICAgICAgICAgIGFz\nc2VydFRydWUoaGludHMuY29udGFpbnNLZXkoImphdmF4LnBlcnNpc3RlbmNl\nLmxvY2sudGltZW91dCIpKTsKICAgICAgICAgICAgYXNzZXJ0VHJ1ZShoaW50\ncy5jb250YWluc0tleSgiamF2YXgucGVyc2lzdGVuY2UucXVlcnkudGltZW91\ndCIpKTsKICAgICAgICAgICAgdGltZW91dCA9IG5ldyBJbnRlZ2VyKChTdHJp\nbmcpIGhpbnRzLmdldCgKICAgICAgICAgICAgICAgICJqYXZheC5wZXJzaXN0\nZW5jZS5sb2NrLnRpbWVvdXQiKSk7CiAgICAgICAgICAgIGFzc2VydEVxdWFs\ncygiRXhwZWN0ZWQgTWFwIHVwZGF0ZWQgbG9ja1RpbWVvdXQiLAogICAgICAg\nICAgICAgICAgbFRpbWUuaW50VmFsdWUoKSwgdGltZW91dC5pbnRWYWx1ZSgp\nKTsKICAgICAgICAgICAgdGltZW91dCA9IG5ldyBJbnRlZ2VyKChTdHJpbmcp\nIGhpbnRzLmdldCgKICAgICAgICAgICAgICAgICJqYXZheC5wZXJzaXN0ZW5j\nZS5xdWVyeS50aW1lb3V0IikpOwogICAgICAgICAgICBhc3NlcnRFcXVhbHMo\nIkV4cGVjdGVkIE1hcCB1cGRhdGVkIHF1ZXJ5VGltZW91dCIsCiAgICAgICAg\nICAgICAgICBxVGltZS5pbnRWYWx1ZSgpLCB0aW1lb3V0LmludFZhbHVlKCkp\nOwogICAgICAgICAgICAqLwogICAgICAgICAgICAvLyB2ZXJpZnkgaW50ZXJu\nYWwgY29uZmlnIHZhbHVlcyB3ZXJlIHVwZGF0ZWQKICAgICAgICAgICAgdGlt\nZW91dCA9IHEuZ2V0RmV0Y2hQbGFuKCkuZ2V0TG9ja1RpbWVvdXQoKTsKICAg\nICAgICAgICAgYXNzZXJ0RXF1YWxzKCJFeHBlY3RlZCBNYXAgdXBkYXRlZCBs\nb2NrIHRpbWVvdXQiLCBsVGltZS5pbnRWYWx1ZSgpLAogICAgICAgICAgICAg\nICAgdGltZW91dC5pbnRWYWx1ZSgpKTsKICAgICAgICAgICAgdGltZW91dCA9\nIHEuZ2V0RmV0Y2hQbGFuKCkuZ2V0UXVlcnlUaW1lb3V0KCk7CiAgICAgICAg\nICAgIGFzc2VydEVxdWFscygiRXhwZWN0ZWQgTWFwIHVwZGF0ZWQgcXVlcnkg\ndGltZW91dCIsIHFUaW1lLmludFZhbHVlKCksCiAgICAgICAgICAgICAgICB0\naW1lb3V0LmludFZhbHVlKCkpOwogICAgICAgICAgICAKICAgICAgICAgICAg\nLy89PT09PT09PT09PT09CiAgICAgICAgICAgIC8vIFRlc3QgZm9yIDRhKQog\nICAgICAgICAgICAvLz09PT09PT09PT09PT0KICAgICAgICAgICAgLy8gdmVy\naWZ5IHNldEhpbnQgb3ZlcnJpZGVzIE1hcCBwcm92aWRlZCBwcm9wZXJ0aWVz\nCiAgICAgICAgICAgIGxUaW1lID0gMTUwMDA7CiAgICAgICAgICAgIHFUaW1l\nID0gMTAwMDA7CiAgICAgICAgICAgIHEuc2V0SGludCgiamF2YXgucGVyc2lz\ndGVuY2UubG9jay50aW1lb3V0IiwgbFRpbWUpOwogICAgICAgICAgICBxLnNl\ndEhpbnQoImphdmF4LnBlcnNpc3RlbmNlLnF1ZXJ5LnRpbWVvdXQiLCBxVGlt\nZSk7CiAgICAgICAgICAgIGhpbnRzID0gcS5nZXRIaW50cygpOwogICAgICAg\nICAgICAvLyB2ZXJpZnkgZ2V0SGludHMgdmFsdWVzIHdlcmUgdXBkYXRlZAog\nICAgICAgICAgICB0aW1lb3V0ID0gKEludGVnZXIpIGhpbnRzLmdldCgiamF2\nYXgucGVyc2lzdGVuY2UubG9jay50aW1lb3V0Iik7CiAgICAgICAgICAgIGFz\nc2VydEVxdWFscygKICAgICAgICAgICAgICAgICJFeHBlY3RlZCBzZXRIaW50\nIHVwZGF0ZWQgamF2YXgucGVyc2lzdGVuY2UubG9jay50aW1lb3V0IiwKICAg\nICAgICAgICAgICAgIGxUaW1lLmludFZhbHVlKCksIHRpbWVvdXQuaW50VmFs\ndWUoKSk7CiAgICAgICAgICAgIHRpbWVvdXQgPSAoSW50ZWdlcikgaGludHMu\nZ2V0KCJqYXZheC5wZXJzaXN0ZW5jZS5xdWVyeS50aW1lb3V0Iik7CiAgICAg\nICAgICAgIGFzc2VydEVxdWFscygKICAgICAgICAgICAgICAgICJFeHBlY3Rl\nZCBzZXRIaW50IHVwZGF0ZWQgamF2YXgucGVyc2lzdGVuY2UucXVlcnkudGlt\nZW91dCIsCiAgICAgICAgICAgICAgICBxVGltZS5pbnRWYWx1ZSgpLCB0aW1l\nb3V0LmludFZhbHVlKCkpOwogICAgICAgICAgICAvLyB2ZXJpZnkgaW50ZXJu\nYWwgY29uZmlnIHZhbHVlcyB3ZXJlIHVwZGF0ZWQKICAgICAgICAgICAgdGlt\nZW91dCA9IHEuZ2V0RmV0Y2hQbGFuKCkuZ2V0TG9ja1RpbWVvdXQoKTsKICAg\nICAgICAgICAgYXNzZXJ0RXF1YWxzKCJFeHBlY3RlZCBzZXRIaW50IHVwZGF0\nZWQgbG9ja1RpbWVvdXQiLAogICAgICAgICAgICAgICAgbFRpbWUuaW50VmFs\ndWUoKSwgdGltZW91dC5pbnRWYWx1ZSgpKTsKICAgICAgICAgICAgdGltZW91\ndCA9IHEuZ2V0RmV0Y2hQbGFuKCkuZ2V0UXVlcnlUaW1lb3V0KCk7CiAgICAg\nICAgICAgIGFzc2VydEVxdWFscygiRXhwZWN0ZWQgc2V0SGludCB1cGRhdGVk\nIHF1ZXJ5VGltZW91dCIsCiAgICAgICAgICAgICAgICBxVGltZS5pbnRWYWx1\nZSgpLCB0aW1lb3V0LmludFZhbHVlKCkpOwogICAgICAgIH0gZmluYWxseSB7\nCiAgICAgICAgICAgIC8vIGNsZWFudXAKICAgICAgICAgICAgaWYgKChlbTEg\nIT0gbnVsbCkgJiYgZW0xLmlzT3BlbigpKQogICAgICAgICAgICAgICAgZW0x\nLmNsb3NlKCk7CiAgICAgICAgICAgIGlmIChlbWYxICE9IG51bGwpCiAgICAg\nICAgICAgICAgICBlbWYxLmNsb3NlKCk7CiAgICAgICAgICAgIGlmICgoZW0y\nICE9IG51bGwpICYmIGVtMi5pc09wZW4oKSkKICAgICAgICAgICAgICAgIGVt\nMi5jbG9zZSgpOwogICAgICAgICAgICBpZiAoZW1mMiE9IG51bGwpCiAgICAg\nICAgICAgICAgICBlbWYyLmNsb3NlKCk7CiAgICAgICAgfQogICAgfQoKICAg\nIHB1YmxpYyB2b2lkIHRlc3RXaXRoUHJvcGVydGllcygpIHsKICAgICAgICBn\nZXRMb2coKS50cmFjZSgidGVzdFdpdGhQcm9wZXJ0aWVzKCkgLSBwcm9wZXJ0\naWVzIGluIHBlcnNpc3RlbmNlLnhtbCIpOwogICAgICAgIE9wZW5KUEFFbnRp\ndHlNYW5hZ2VyRmFjdG9yeSBlbWYxID0gbnVsbCwgZW1mMiA9IG51bGw7CiAg\nICAgICAgT3BlbkpQQUVudGl0eU1hbmFnZXIgZW0xID0gbnVsbCwgZW0yID0g\nbnVsbDsKICAgICAgICAKICAgICAgICB0cnkgewogICAgICAgICAgICBPcGVu\nSlBBUXVlcnkgcTsKICAgICAgICAgICAgTWFwPFN0cmluZywgT2JqZWN0PiBo\naW50czsKICAgICAgICAgICAgSW50ZWdlciB0aW1lb3V0OwogICAgICAgICAg\nICBJbnRlZ2VyIGxUaW1lID0gbmV3IEludGVnZXIoMTAwMDApOwogICAgICAg\nICAgICBJbnRlZ2VyIHFUaW1lID0gbmV3IEludGVnZXIoNTAwMCk7CiAgICAg\nICAgICAgIAogICAgICAgICAgICAvLyBjcmVhdGUgb3VyIFBVIHdpdGggcHJv\ncGVydGllcwogICAgICAgICAgICBlbWYxID0gT3BlbkpQQVBlcnNpc3RlbmNl\nLmNyZWF0ZUVudGl0eU1hbmFnZXJGYWN0b3J5KAogICAgICAgICAgICAgICAg\nInF0aW1lb3V0LXdpdGgtcHJvcGVydGllcyIsICJwZXJzaXN0ZW5jZTMueG1s\nIik7CiAgICAgICAgICAgIGFzc2VydE5vdE51bGwoZW1mMSk7CiAgICAgICAg\nICAgIGVtZjIgPSBPcGVuSlBBUGVyc2lzdGVuY2UuY3JlYXRlRW50aXR5TWFu\nYWdlckZhY3RvcnkoCiAgICAgICAgICAgICAgICAicXRpbWVvdXQtd2l0aC1w\ncm9wZXJ0aWVzIiwgInBlcnNpc3RlbmNlMy54bWwiLCBwcm9wcyk7CiAgICAg\nICAgICAgIGFzc2VydE5vdE51bGwoZW1mMik7CiAgICAgICAgICAgIAogICAg\nICAgICAgICAvLz09PT09PT09PT09PT0KICAgICAgICAgICAgLy8gVGVzdCBm\nb3IgMWIpCiAgICAgICAgICAgIC8vPT09PT09PT09PT09PQogICAgICAgICAg\nICAvLyB2ZXJpZnkgcHJvcGVydGllcyBpbiBwZXJzaXN0ZW5jZS54bWwKICAg\nICAgICAgICAgT3BlbkpQQUNvbmZpZ3VyYXRpb24gY29uZjEgPSBlbWYxLmdl\ndENvbmZpZ3VyYXRpb24oKTsKICAgICAgICAgICAgYXNzZXJ0Tm90TnVsbChj\nb25mMSk7CiAgICAgICAgICAgIGFzc2VydEVxdWFscygiRGVmYXVsdCBQVSBs\nb2NrIHRpbWVvdXQiLCBsVGltZS5pbnRWYWx1ZSgpLAogICAgICAgICAgICAg\nICAgY29uZjEuZ2V0TG9ja1RpbWVvdXQoKSk7CiAgICAgICAgICAgIGFzc2Vy\ndEVxdWFscygiRGVmYXVsdCBQVSBxdWVyeSB0aW1lb3V0LiIsIHFUaW1lLmlu\ndFZhbHVlKCksCiAgICAgICAgICAgICAgICBjb25mMS5nZXRRdWVyeVRpbWVv\ndXQoKSk7CiAgICAgICAgICAgIC8vIHZlcmlmeSBRdWVyeSByZWNlaXZlcyB0\naGUgcHJvcGVydGllcwogICAgICAgICAgICBlbTEgPSBlbWYxLmNyZWF0ZUVu\ndGl0eU1hbmFnZXIoKTsKICAgICAgICAgICAgYXNzZXJ0Tm90TnVsbChlbTEp\nOwogICAgICAgICAgICBxID0gZW0xLmNyZWF0ZU5hbWVkUXVlcnkoIk5vSGlu\ndExpc3QiKTsgICAgCiAgICAgICAgICAgIC8vIENhbm5vdCB2ZXJpZnkgcHJv\ncGVydGllcyBhcmUgcGFzc2VkIHRocm91Z2ggYXMgUXVlcnkgaGludHMKICAg\nICAgICAgICAgLy8gICAgIFNlZSBleHBsYW5hdGlvbiBhbmQgY29tbWVudGVk\nIG91dCB0ZXN0IGluIHRlc3ROb1Byb3BlcnRpZXMoKQogICAgICAgICAgICAv\nLyB2ZXJpZnkgdGltZW91dCBwcm9wZXJ0aWVzIHN1cHBsaWVkIGluIHBlcnNp\nc3RlbmNlLnhtbAogICAgICAgICAgICB0aW1lb3V0ID0gcS5nZXRGZXRjaFBs\nYW4oKS5nZXRMb2NrVGltZW91dCgpOwogICAgICAgICAgICBhc3NlcnRFcXVh\nbHMoIkV4cGVjdGVkIGRlZmF1bHQgUFUgbG9jayB0aW1lb3V0IiwgbFRpbWUu\naW50VmFsdWUoKSwKICAgICAgICAgICAgICAgIHRpbWVvdXQuaW50VmFsdWUo\nKSk7CiAgICAgICAgICAgIHRpbWVvdXQgPSBxLmdldEZldGNoUGxhbigpLmdl\ndFF1ZXJ5VGltZW91dCgpOwogICAgICAgICAgICBhc3NlcnRFcXVhbHMoIkV4\ncGVjdGVkIGRlZmF1bHQgUFUgcXVlcnkgdGltZW91dCIsIHFUaW1lLmludFZh\nbHVlKCksCiAgICAgICAgICAgICAgICB0aW1lb3V0LmludFZhbHVlKCkpOwoK\nICAgICAgICAgICAgLy89PT09PT09PT09PT09CiAgICAgICAgICAgIC8vIFRl\nc3QgZm9yIDJiKQogICAgICAgICAgICAvLz09PT09PT09PT09PT0KICAgICAg\nICAgICAgLy8gdmVyaWZ5IHByb3BlcnRpZXMgaW4gTWFwIG92ZXJyaWRlIHBl\ncnNpc3RlbmNlLnhtbAogICAgICAgICAgICBPcGVuSlBBQ29uZmlndXJhdGlv\nbiBjb25mMiA9IGVtZjIuZ2V0Q29uZmlndXJhdGlvbigpOwogICAgICAgICAg\nICBhc3NlcnROb3ROdWxsKGNvbmYyKTsKICAgICAgICAgICAgbFRpbWUgPSAx\nMjAwMDsKICAgICAgICAgICAgcVRpbWUgPSA3MDAwOwogICAgICAgICAgICBh\nc3NlcnRFcXVhbHMoIkV4cGVjdGVkIE1hcCB1cGRhdGVkIGxvY2sgdGltZW91\ndCIsIGxUaW1lLmludFZhbHVlKCksCiAgICAgICAgICAgICAgICBjb25mMi5n\nZXRMb2NrVGltZW91dCgpKTsKICAgICAgICAgICAgYXNzZXJ0RXF1YWxzKCJF\neHBlY3RlZCBNYXAgdXBkYXRlZCBxdWVyeSB0aW1lb3V0IiwgcVRpbWUuaW50\nVmFsdWUoKSwKICAgICAgICAgICAgICAgIGNvbmYyLmdldFF1ZXJ5VGltZW91\ndCgpKTsKICAgICAgICAgICAgLy8gVmVyaWZ5IFF1ZXJ5IHJlY2VpdmVzIHRo\nZSBwcm9wZXJ0aWVzCiAgICAgICAgICAgIGVtMiA9IGVtZjIuY3JlYXRlRW50\naXR5TWFuYWdlcigpOwogICAgICAgICAgICBhc3NlcnROb3ROdWxsKGVtMik7\nCiAgICAgICAgICAgIHEgPSBlbTIuY3JlYXRlTmFtZWRRdWVyeSgiTm9IaW50\nTGlzdCIpOwogICAgICAgICAgICAvLyBDYW5ub3QgdmVyaWZ5IHByb3BlcnRp\nZXMgYXJlIHBhc3NlZCB0aHJvdWdoIGFzIFF1ZXJ5IGhpbnRzCiAgICAgICAg\nICAgIC8vICAgICBTZWUgZXhwbGFuYXRpb24gYW5kIGNvbW1lbnRlZCBvdXQg\ndGVzdCBpbiB0ZXN0Tm9Qcm9wZXJ0aWVzKCkKICAgICAgICAgICAgLy8gdmVy\naWZ5IGludGVybmFsIGNvbmZpZyB2YWx1ZXMgd2VyZSB1cGRhdGVkCiAgICAg\nICAgICAgIHRpbWVvdXQgPSBxLmdldEZldGNoUGxhbigpLmdldExvY2tUaW1l\nb3V0KCk7CiAgICAgICAgICAgIGFzc2VydEVxdWFscygiRXhwZWN0ZWQgTWFw\nIHVwZGF0ZWQgbG9ja1RpbWVvdXQiLCBsVGltZS5pbnRWYWx1ZSgpLAogICAg\nICAgICAgICAgICAgdGltZW91dC5pbnRWYWx1ZSgpKTsKICAgICAgICAgICAg\ndGltZW91dCA9IHEuZ2V0RmV0Y2hQbGFuKCkuZ2V0UXVlcnlUaW1lb3V0KCk7\nCiAgICAgICAgICAgIGFzc2VydEVxdWFscygiRXhwZWN0ZWQgTWFwIHVwZGF0\nZWQgcXVlcnlUaW1lb3V0IiwgcVRpbWUuaW50VmFsdWUoKSwKICAgICAgICAg\nICAgICAgIHRpbWVvdXQuaW50VmFsdWUoKSk7CiAgICAgICAgICAgIAogICAg\nICAgICAgICAvLz09PT09PT09PT09PT0KICAgICAgICAgICAgLy8gVGVzdCBm\nb3IgMykKICAgICAgICAgICAgLy89PT09PT09PT09PT09CiAgICAgICAgICAg\nIC8vIHZlcmlmeSBRdWVyeUhpbnRzIG92ZXJyaWRlIE1hcCBwcm92aWRlZCBw\ncm9wZXJ0aWVzCiAgICAgICAgICAgIHEgPSBlbTIuY3JlYXRlTmFtZWRRdWVy\neSgiSGludDEwMDBtc2VjIik7CiAgICAgICAgICAgIHFUaW1lID0gMTAwMDsK\nICAgICAgICAgICAgLy8gdmVyaWZ5IGdldEhpbnRzIHZhbHVlcyB3ZXJlIHVw\nZGF0ZWQKICAgICAgICAgICAgaGludHMgPSBxLmdldEhpbnRzKCk7CiAgICAg\nICAgICAgIHRpbWVvdXQgPSBuZXcgSW50ZWdlcigoU3RyaW5nKWhpbnRzLmdl\ndCgKICAgICAgICAgICAgICAgICAgICAiamF2YXgucGVyc2lzdGVuY2UucXVl\ncnkudGltZW91dCIpKTsKICAgICAgICAgICAgYXNzZXJ0RXF1YWxzKCJFeHBl\nY3RlZCBRdWVyeUhpbnRzIHVwZGF0ZWQgcXVlcnkgdGltZW91dCIsCiAgICAg\nICAgICAgICAgICBxVGltZS5pbnRWYWx1ZSgpLCB0aW1lb3V0LmludFZhbHVl\nKCkpOwogICAgICAgICAgICAvLyB2ZXJpZnkgaW50ZXJuYWwgY29uZmlnIHZh\nbHVlIHdhcyB1cGRhdGVkCiAgICAgICAgICAgIHRpbWVvdXQgPSBxLmdldEZl\ndGNoUGxhbigpLmdldFF1ZXJ5VGltZW91dCgpOwogICAgICAgICAgICBhc3Nl\ncnRFcXVhbHMoIkV4cGVjdGVkIFF1ZXJ5SGludHMgdXBkYXRlZCBxdWVyeVRp\nbWVvdXQiLAogICAgICAgICAgICAgICAgcVRpbWUuaW50VmFsdWUoKSwgdGlt\nZW91dC5pbnRWYWx1ZSgpKTsKCiAgICAgICAgICAgIC8vPT09PT09PT09PT09\nPQogICAgICAgICAgICAvLyBUZXN0IGZvciA0YikKICAgICAgICAgICAgLy89\nPT09PT09PT09PT09CiAgICAgICAgICAgIC8vIHZlcmlmeSBzZXRIaW50IG92\nZXJyaWRlcyBRdWVyeUhpbnQgcHJvdmlkZWQgcHJvcGVydGllcwogICAgICAg\nICAgICBsVGltZSA9IDE1MDAwOwogICAgICAgICAgICBxVGltZSA9IDEwMDAw\nOwogICAgICAgICAgICBxLnNldEhpbnQoImphdmF4LnBlcnNpc3RlbmNlLmxv\nY2sudGltZW91dCIsIGxUaW1lKTsKICAgICAgICAgICAgcS5zZXRIaW50KCJq\nYXZheC5wZXJzaXN0ZW5jZS5xdWVyeS50aW1lb3V0IiwgcVRpbWUpOwogICAg\nICAgICAgICAvLyB2ZXJpZnkgZ2V0SGludHMgdmFsdWVzIHdlcmUgdXBkYXRl\nZAogICAgICAgICAgICBoaW50cyA9IHEuZ2V0SGludHMoKTsKICAgICAgICAg\nICAgdGltZW91dCA9IChJbnRlZ2VyKSBoaW50cy5nZXQoImphdmF4LnBlcnNp\nc3RlbmNlLmxvY2sudGltZW91dCIpOwogICAgICAgICAgICBhc3NlcnRFcXVh\nbHMoIkV4cGVjdGVkIHNldEhpbnQgdXBkYXRlZCBsb2NrIHRpbWVvdXQiLAog\nICAgICAgICAgICAgICAgbFRpbWUuaW50VmFsdWUoKSwgdGltZW91dC5pbnRW\nYWx1ZSgpKTsKICAgICAgICAgICAgdGltZW91dCA9IChJbnRlZ2VyKSBoaW50\ncy5nZXQoImphdmF4LnBlcnNpc3RlbmNlLnF1ZXJ5LnRpbWVvdXQiKTsKICAg\nICAgICAgICAgYXNzZXJ0RXF1YWxzKCJFeHBlY3RlZCBzZXRIaW50IHVwZGF0\nZWQgcXVlcnkgdGltZW91dCIsCiAgICAgICAgICAgICAgICBxVGltZS5pbnRW\nYWx1ZSgpLCB0aW1lb3V0LmludFZhbHVlKCkpOwogICAgICAgICAgICAvLyB2\nZXJpZnkgaW50ZXJuYWwgY29uZmlnIHZhbHVlcyB3ZXJlIHVwZGF0ZWQKICAg\nICAgICAgICAgdGltZW91dCA9IHEuZ2V0RmV0Y2hQbGFuKCkuZ2V0TG9ja1Rp\nbWVvdXQoKTsKICAgICAgICAgICAgYXNzZXJ0RXF1YWxzKCJFeHBlY3RlZCBz\nZXRIaW50IHVwZGF0ZWQgbG9ja1RpbWVvdXQiLAogICAgICAgICAgICAgICAg\nbFRpbWUuaW50VmFsdWUoKSwgdGltZW91dC5pbnRWYWx1ZSgpKTsKICAgICAg\nICAgICAgdGltZW91dCA9IHEuZ2V0RmV0Y2hQbGFuKCkuZ2V0UXVlcnlUaW1l\nb3V0KCk7CiAgICAgICAgICAgIGFzc2VydEVxdWFscygiRXhwZWN0ZWQgc2V0\nSGludCB1cGRhdGVkIHF1ZXJ5VGltZW91dCIsCiAgICAgICAgICAgICAgICBx\nVGltZS5pbnRWYWx1ZSgpLCB0aW1lb3V0LmludFZhbHVlKCkpOwogICAgICAg\nIH0gZmluYWxseSB7CiAgICAgICAgICAgIC8vIGNsZWFudXAKICAgICAgICAg\nICAgaWYgKChlbTEgIT0gbnVsbCkgJiYgZW0xLmlzT3BlbigpKQogICAgICAg\nICAgICAgICAgZW0xLmNsb3NlKCk7CiAgICAgICAgICAgIGlmIChlbWYxICE9\nIG51bGwpCiAgICAgICAgICAgICAgICBlbWYxLmNsb3NlKCk7CiAgICAgICAg\nICAgIGlmICgoZW0yICE9IG51bGwpICYmIGVtMi5pc09wZW4oKSkKICAgICAg\nICAgICAgICAgIGVtMi5jbG9zZSgpOwogICAgICAgICAgICBpZiAoZW1mMiE9\nIG51bGwpCiAgICAgICAgICAgICAgICBlbWYyLmNsb3NlKCk7CiAgICAgICAg\nfQogICAgfQogICAgCn0K\n","encoding":"base64"}

