{"sha":"646f1c0bc3dabca94c894a8bf7a5597d89d9406f","node_id":"MDQ6QmxvYjIwNjM2NDo2NDZmMWMwYmMzZGFiY2E5NGM4OTRhOGJmN2E1NTk3ZDg5ZDk0MDZm","size":7070,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/646f1c0bc3dabca94c894a8bf7a5597d89d9406f","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy53cml0ZWJlaGluZDsK\nCmltcG9ydCBqYXZhLnV0aWwuQXJyYXlMaXN0OwppbXBvcnQgamF2YS51dGls\nLkhhc2hNYXA7CmltcG9ydCBqYXZhLnV0aWwuTWFwOwoKaW1wb3J0IGphdmF4\nLnBlcnNpc3RlbmNlLlBlcnNpc3RlbmNlOwoKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS5jb25mLk9wZW5KUEFDb25maWd1cmF0aW9uSW1wbDsKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5kYXRhY2FjaGUuRGF0YUNhY2hlU3RvcmVN\nYW5hZ2VyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5EZWxl\nZ2F0aW5nU3RvcmVNYW5hZ2VyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLnBlcnNpc3RlbmNlLkVudGl0eU1hbmFnZXJJbXBsOwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNlLk9wZW5KUEFFbnRpdHlNYW5hZ2Vy\nRmFjdG9yeVNQSTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS53cml0ZWJl\naGluZC5TaW1wbGVXcml0ZUJlaGluZENhY2hlOwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLndyaXRlYmVoaW5kLlNpbXBsZVdyaXRlQmVoaW5kQ2FsbGJh\nY2s7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEud3JpdGViZWhpbmQuV3Jp\ndGVCZWhpbmRDYWNoZTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS53cml0\nZWJlaGluZC5Xcml0ZUJlaGluZENhY2hlTWFuYWdlcjsKaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS53cml0ZWJlaGluZC5Xcml0ZUJlaGluZENhbGxiYWNr\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLndyaXRlYmVoaW5kLldyaXRl\nQmVoaW5kU3RvcmVNYW5hZ2VyOwoKcHVibGljIGNsYXNzIFRlc3RXcml0ZUJl\naGluZENvbmZpZ3VyYXRpb24gZXh0ZW5kcyBBYnN0cmFjdFdyaXRlQmVoaW5k\nVGVzdENhc2UgewogICAgcHVibGljIHZvaWQgdGVzdFdyaXRlQmVoaW5kU3Rv\ncmVNYW5hZ2VyQ3JlYXRlZCgpIHsKICAgICAgICBhc3NlcnROb3ROdWxsKGVt\nZik7CiAgICAgICAgYXNzZXJ0Tm90TnVsbChlbSk7CiAgICAgICAgRGVsZWdh\ndGluZ1N0b3JlTWFuYWdlciBzdG9yZU1hbmFnZXIgPSAoKEVudGl0eU1hbmFn\nZXJJbXBsKSBlbSkuZ2V0QnJva2VyKCkuZ2V0U3RvcmVNYW5hZ2VyKCk7CiAg\nICAgICAgCiAgICAgICAgc3RvcmVNYW5hZ2VyID0gKERlbGVnYXRpbmdTdG9y\nZU1hbmFnZXIpIHN0b3JlTWFuYWdlci5nZXREZWxlZ2F0ZSgpOwogICAgICAg\nIGFzc2VydFRydWUoU3RyaW5nLmZvcm1hdCgiVW5leHBlY3RlZCBTdG9yZU1h\nbmFnZXIgdHlwZSA6ICVzIiwKICAgICAgICAgICAgc3RvcmVNYW5hZ2VyLmdl\ndENsYXNzKCkuZ2V0TmFtZSgpKSwKICAgICAgICAgICAgc3RvcmVNYW5hZ2Vy\nIGluc3RhbmNlb2YgRGF0YUNhY2hlU3RvcmVNYW5hZ2VyKTsKICAgICAgICBh\nc3NlcnRUcnVlKFN0cmluZy5mb3JtYXQoIlVuZXhwZWN0ZWQgU3RvcmVNYW5h\nZ2VyIHR5cGUgOiAlcyIsCiAgICAgICAgICAgIHN0b3JlTWFuYWdlci5nZXRE\nZWxlZ2F0ZSgpLmdldENsYXNzKCkuZ2V0TmFtZSgpKSwgCiAgICAgICAgICAg\nIHN0b3JlTWFuYWdlci5nZXREZWxlZ2F0ZSgpIGluc3RhbmNlb2YgV3JpdGVC\nZWhpbmRTdG9yZU1hbmFnZXIpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHRl\nc3RXcml0ZUJlaGluZENhY2hlQ3JlYXRlZCgpIHsKICAgICAgICBhc3NlcnRO\nb3ROdWxsKCJFTUYgd2FzIG5vdCBjcmVhdGVkLiIsIGVtZik7CiAgICAgICAg\nV3JpdGVCZWhpbmRDYWNoZU1hbmFnZXIgbWFuYWdlciA9IGdldFdCQ2FjaGVN\nYW5hZ2VyKCk7CiAgICAgICAgYXNzZXJ0Tm90TnVsbCgiV3JpdGVCZWhpbmRD\nYWNoZU1hbmFnZXIgc2hvdWxkIGV4aXN0IiwgbWFuYWdlcik7CgogICAgICAg\nIFdyaXRlQmVoaW5kQ2FjaGUgd2JjYWNoZSA9IG1hbmFnZXIuZ2V0U3lzdGVt\nV3JpdGVCZWhpbmRDYWNoZSgpOwogICAgICAgIGFzc2VydE5vdE51bGwoIlN5\nc3RlbVdyaXRlQmVoaW5kQ2FjaGUgc2hvdWxkIGV4aXN0Iiwgd2JjYWNoZSk7\nCgogICAgICAgIGFzc2VydFRydWUoU3RyaW5nLmZvcm1hdCgiRXhwZWN0aW5n\nICVzIHRvIGJlIGFuIGluc3RhbmNlIG9mICVzIiwKICAgICAgICAgICAgd2Jj\nYWNoZSwgU2ltcGxlV3JpdGVCZWhpbmRDYWNoZS5jbGFzcyksCiAgICAgICAg\nICAgIHdiY2FjaGUgaW5zdGFuY2VvZiBTaW1wbGVXcml0ZUJlaGluZENhY2hl\nKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCB0ZXN0V3JpdGVCZWhpbmRDYWxs\nYmFja0NyZWF0ZWQoKSB7CiAgICAgICAgYXNzZXJ0Tm90TnVsbCgiRU1GIHdh\ncyBub3QgY3JlYXRlZC4iLCBlbWYpOwogICAgICAgIFdyaXRlQmVoaW5kQ2Fs\nbGJhY2sgY2FsbGJhY2sgPSBnZXRXQkNhbGxiYWNrKCk7CiAgICAgICAgYXNz\nZXJ0Tm90TnVsbCgiV0IgQ2FsbGJhY2sgc2hvdWxkIGV4aXN0IiwgY2FsbGJh\nY2spOwoKICAgICAgICBhc3NlcnRUcnVlKFN0cmluZy5mb3JtYXQoIkV4cGVj\ndGluZyAlcyB0byBiZSBhbiBpbnN0YW5jZSBvZiAlcyIsCiAgICAgICAgICAg\nIGNhbGxiYWNrLCBTaW1wbGVXcml0ZUJlaGluZENhbGxiYWNrLmNsYXNzKSwK\nICAgICAgICAgICAgY2FsbGJhY2sgaW5zdGFuY2VvZiBTaW1wbGVXcml0ZUJl\naGluZENhbGxiYWNrKTsKCiAgICB9CgogICAgcHVibGljIHZvaWQgdGVzdEN1\nc3RvbUNhY2hlSW5zdGFuY2VDcmVhdGVkKCkgewogICAgICAgIEhhc2hNYXA8\nU3RyaW5nLCBPYmplY3Q+IHByb3BzID0gbmV3IEhhc2hNYXA8U3RyaW5nLCBP\nYmplY3Q+KCk7CiAgICAgICAgcHJvcHMucHV0KCJvcGVuanBhLldyaXRlQmVo\naW5kQ2FjaGUiLCBDdXN0b21Xcml0ZUJlaGluZENhY2hlLmNsYXNzLmdldENh\nbm9uaWNhbE5hbWUoKSk7CiAgICAgICAgcHJvcHMucHV0KCJvcGVuanBhLldy\naXRlQmVoaW5kQ2FsbGJhY2siLCAidHJ1ZSIpOwoKICAgICAgICBXcml0ZUJl\naGluZENhY2hlTWFuYWdlciBtYW5hZ2VyID0gZ2V0V0JDYWNoZU1hbmFnZXIo\nZ2V0Q3VzdG9tRmFjdG9yeShwcm9wcykpOwogICAgICAgIGFzc2VydE5vdE51\nbGwoIldyaXRlQmVoaW5kQ2FjaGVNYW5hZ2VyIHNob3VsZCBleGlzdCIsIG1h\nbmFnZXIpOwoKICAgICAgICBXcml0ZUJlaGluZENhY2hlIHdiY2FjaGUgPSBt\nYW5hZ2VyLmdldFN5c3RlbVdyaXRlQmVoaW5kQ2FjaGUoKTsKICAgICAgICBh\nc3NlcnROb3ROdWxsKCJTeXN0ZW1Xcml0ZUJlaGluZENhY2hlIHNob3VsZCBl\neGlzdCIsIHdiY2FjaGUpOwoKICAgICAgICBhc3NlcnRUcnVlKFN0cmluZy5m\nb3JtYXQoIkV4cGVjdGluZyAlcyB0byBiZSBhbiBpbnN0YW5jZSBvZiAlcyIs\nCiAgICAgICAgICAgIHdiY2FjaGUsIEN1c3RvbVdyaXRlQmVoaW5kQ2FjaGUu\nY2xhc3MpLAogICAgICAgICAgICB3YmNhY2hlIGluc3RhbmNlb2YgQ3VzdG9t\nV3JpdGVCZWhpbmRDYWNoZSk7CiAgICB9CiAgICAKICAgIHB1YmxpYyB2b2lk\nIHRlc3RDdXN0b21DYWxsYmFja0NyZWF0ZWQoKSB7CiAgICAgICAgSGFzaE1h\ncDxTdHJpbmcsIE9iamVjdD4gcHJvcHMgPSBuZXcgSGFzaE1hcDxTdHJpbmcs\nIE9iamVjdD4oKTsKICAgICAgICBwcm9wcy5wdXQoIm9wZW5qcGEuV3JpdGVC\nZWhpbmRDYWNoZSIsIEN1c3RvbVdyaXRlQmVoaW5kQ2FjaGUuY2xhc3MuZ2V0\nQ2Fub25pY2FsTmFtZSgpKTsKICAgICAgICBwcm9wcy5wdXQoIm9wZW5qcGEu\nV3JpdGVCZWhpbmRDYWxsYmFjayIsIEN1c3RvbVdyaXRlQmVoaW5kQ2FsbGJh\nY2suY2xhc3MuZ2V0Q2Fub25pY2FsTmFtZSgpKTsKCiAgICAgICAgV3JpdGVC\nZWhpbmRDYWxsYmFjayBjYWxsYmFjayA9IGdldFdCQ2FsbGJhY2soZ2V0Q3Vz\ndG9tRmFjdG9yeShwcm9wcykpOwogICAgICAgIGFzc2VydE5vdE51bGwoIldC\nIENhbGxiYWNrIHNob3VsZCBleGlzdCIsIGNhbGxiYWNrKTsKCiAgICAgICAg\nYXNzZXJ0VHJ1ZShTdHJpbmcuZm9ybWF0KCJFeHBlY3RpbmcgJXMgdG8gYmUg\nYW4gaW5zdGFuY2Ugb2YgJXMiLAogICAgICAgICAgICBjYWxsYmFjaywgQ3Vz\ndG9tV3JpdGVCZWhpbmRDYWxsYmFjay5jbGFzcyksCiAgICAgICAgICAgIGNh\nbGxiYWNrIGluc3RhbmNlb2YgQ3VzdG9tV3JpdGVCZWhpbmRDYWxsYmFjayk7\nCiAgICB9CiAgICAKICAgIAogICAgcHVibGljIHZvaWQgdGVzdFdyaXRlQmVo\naW5kQ2FsbGJhY2tDcmVhdGVkRm9yRWFjaENvbmZpZ3VyYXRpb24oKSB7CiAg\nICAgICAgT3BlbkpQQUVudGl0eU1hbmFnZXJGYWN0b3J5U1BJIGVtZjEgPSBl\nbWY7CiAgICAgICAgQXJyYXlMaXN0PE9iamVjdD4gY2xvbmVkUHJvcHMgPSBu\nZXcgQXJyYXlMaXN0PE9iamVjdD4oKTsKICAgICAgICBmb3IoT2JqZWN0IG8g\nOiB3cml0ZUJlaGluZFByb3BzKSB7CiAgICAgICAgICAgIC8vIHF1aWNrIGFu\nZCBkaXJ0eSB3YXkgdG8gYWx0ZXIgdGhlIHByb3BlcnRpZXMsIHRoaXMgc2hv\ndWxkIHByZXZlbnQgdGhlIGNhY2hlZCBFTUYgZnJvbSBiZWluZyByZXVzZWQu\nCiAgICAgICAgICAgIGlmKG8udG9TdHJpbmcoKS5lcXVhbHMoInVuc3VwcG9y\ndGVkIikpIHsKICAgICAgICAgICAgICAgIC8vIGp1c3QgY2hhbmdlIHRoZSBy\ndW50aW1lVW5lbmhhbmNlZENsYXNzZXMgdmFsdWUuCiAgICAgICAgICAgICAg\nICBjbG9uZWRQcm9wcy5hZGQoInN1cHBvcnRlZCIpOwogICAgICAgICAgICB9\nCiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgY2xvbmVkUHJv\ncHMuYWRkKG8pOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIE9w\nZW5KUEFFbnRpdHlNYW5hZ2VyRmFjdG9yeVNQSSBlbWYyID0gY3JlYXRlRU1G\nKGNsb25lZFByb3BzLnRvQXJyYXkoKSk7IAogICAgICAgIGFzc2VydE5vdE51\nbGwoIlVuYWJsZSB0byBjcmVhdGUgZmlyc3QgRW50aXR5TWFuYWdlciAiLCBl\nbWYxKTsKICAgICAgICBhc3NlcnROb3ROdWxsKCJVbmFibGUgdG8gY3JlYXRl\nIHNlY29uZCBFbnRpdHlNYW5hZ2VyICIsIGVtZjIpOwogICAgICAgIGFzc2Vy\ndE5vdFNhbWUoIlRlc3QgaXMgaW52YWxpZCBpZiB0aGUgc2FtZSBFTUYgaXMg\ndXNlZCIsIGVtZjEsIGVtZjIpOwoKICAgICAgICBPcGVuSlBBQ29uZmlndXJh\ndGlvbkltcGwgY29uZjEgPSAoT3BlbkpQQUNvbmZpZ3VyYXRpb25JbXBsKSBl\nbWYxLmdldENvbmZpZ3VyYXRpb24oKTsKICAgICAgICBPcGVuSlBBQ29uZmln\ndXJhdGlvbkltcGwgY29uZjIgPSAoT3BlbkpQQUNvbmZpZ3VyYXRpb25JbXBs\nKSBlbWYyLmdldENvbmZpZ3VyYXRpb24oKTsKCiAgICAgICAgYXNzZXJ0Tm90\nTnVsbChjb25mMSk7CiAgICAgICAgYXNzZXJ0Tm90TnVsbChjb25mMik7CiAg\nICAgICAgYXNzZXJ0Tm90U2FtZSgiQ29uZmlndXJhdGlvbiBvYmplY3RzIGZv\nciBkaWZmZXJlbnQgRU1GcyBzaG91bGQgbm90IGJlIHRoZSBzYW1lIiwgY29u\nZjEsIGNvbmYyKTsKCiAgICAgICAgYXNzZXJ0Tm90U2FtZSgiRWFjaCBDb25m\naWd1cmF0aW9uIHNob3VsZCBoYXZlIGl0cyBvd24gV3JpdGVCZWhpbmRDYWxs\nYmFja1BsdWdpbnMiLAogICAgICAgICAgICBjb25mMS53cml0ZUJlaGluZENh\nbGxiYWNrUGx1Z2luLCBjb25mMi53cml0ZUJlaGluZENhbGxiYWNrUGx1Z2lu\nKTsKICAgICAgICAKICAgICAgICBXcml0ZUJlaGluZENhbGxiYWNrIHdiYzEg\nPSBjb25mMS5nZXRXcml0ZUJlaGluZENhbGxiYWNrSW5zdGFuY2UoKTsKICAg\nICAgICBXcml0ZUJlaGluZENhbGxiYWNrIHdiYzIgPSBjb25mMi5nZXRXcml0\nZUJlaGluZENhbGxiYWNrSW5zdGFuY2UoKTsKICAgICAgICBhc3NlcnROb3RO\ndWxsKHdiYzEpOwogICAgICAgIGFzc2VydE5vdE51bGwod2JjMik7CiAgICAg\nICAgYXNzZXJ0Tm90U2FtZSgiRWFjaCBDb25maWd1cmF0aW9uIHNob3VsZCBo\nYXZlIGl0cyBvd24gV3JpdGVCZWhpbmRDYWxsYmFjayIsIHdiYzEsIHdiYzIp\nOwogICAgfQogICAgCiAgICBwdWJsaWMgT3BlbkpQQUVudGl0eU1hbmFnZXJG\nYWN0b3J5U1BJIGdldEN1c3RvbUZhY3RvcnkoCiAgICAgICAgTWFwPFN0cmlu\nZywgT2JqZWN0PiBleHRyYVByb3BzKSB7CiAgICAgICAgTWFwPFN0cmluZywg\nT2JqZWN0PiBwcm9wcyA9IGdldFByb3BlcnRpZXNNYXAoZ2V0RGVmYXVsdFdy\naXRlQmVoaW5kUHJvcGVydGllcygpKTsKICAgICAgICBwcm9wcy5wdXRBbGwo\nZXh0cmFQcm9wcyk7CgogICAgICAgIE9wZW5KUEFFbnRpdHlNYW5hZ2VyRmFj\ndG9yeVNQSSBjdXN0b21FTUYgPQogICAgICAgICAgICAoT3BlbkpQQUVudGl0\neU1hbmFnZXJGYWN0b3J5U1BJKSBQZXJzaXN0ZW5jZS5jcmVhdGVFbnRpdHlN\nYW5hZ2VyRmFjdG9yeShnZXRQZXJzaXN0ZW5jZVVuaXROYW1lKCksIHByb3Bz\nKTsKICAgICAgICBhc3NlcnROb3ROdWxsKCJFTUYgd2FzIG5vdCBjcmVhdGVk\nLiIsIGN1c3RvbUVNRik7CiAgICAgICAgcmV0dXJuIGN1c3RvbUVNRjsKICAg\nIH0KfQo=\n","encoding":"base64"}

