{"sha":"4604dcbc408c3ccbad22a8350ad925e0142f4813","node_id":"MDQ6QmxvYjIwNjM2NDo0NjA0ZGNiYzQwOGMzY2NiYWQyMmE4MzUwYWQ5MjVlMDE0MmY0ODEz","size":15128,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/4604dcbc408c3ccbad22a8350ad925e0142f4813","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNr\nYWdlIG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWw7CgppbXBvcnQgamF2YS5p\nby5CeXRlQXJyYXlJbnB1dFN0cmVhbTsKaW1wb3J0IGphdmEuaW8uQnl0ZUFy\ncmF5T3V0cHV0U3RyZWFtOwppbXBvcnQgamF2YS5pby5JT0V4Y2VwdGlvbjsK\naW1wb3J0IGphdmEuaW8uT2JqZWN0SW5wdXRTdHJlYW07CmltcG9ydCBqYXZh\nLmlvLk9iamVjdE91dHB1dFN0cmVhbTsKaW1wb3J0IGphdmEuaW8uU2VyaWFs\naXphYmxlOwppbXBvcnQgamF2YS51dGlsLkhhc2hNYXA7CmltcG9ydCBqYXZh\nLnV0aWwuTWFwOwppbXBvcnQgamF2YXgucGVyc2lzdGVuY2UuRW50aXR5TWFu\nYWdlcjsKCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuZXZlbnQuQWJzdHJh\nY3RMaWZlY3ljbGVMaXN0ZW5lcjsKaW1wb3J0IG9yZy5hcGFjaGUub3Blbmpw\nYS5ldmVudC5BYnN0cmFjdFRyYW5zYWN0aW9uTGlzdGVuZXI7CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEuZXZlbnQuTGlmZWN5Y2xlRXZlbnQ7CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEuZXZlbnQuVHJhbnNhY3Rpb25FdmVudDsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5JbnZhbGlk\nU3RhdGVFeGNlcHRpb247CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEucGVy\nc2lzdGVuY2UuSlBBRmFjYWRlSGVscGVyOwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLnBlcnNpc3RlbmNlLk9wZW5KUEFFbnRpdHlNYW5hZ2VyOwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNlLk9wZW5KUEFFbnRp\ndHlNYW5hZ2VyRmFjdG9yeTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5w\nZXJzaXN0ZW5jZS5qZGJjLkpEQkNGZXRjaFBsYW47CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuamRiYy5Kb2luU3ludGF4OwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNlLnRlc3QuU2luZ2xl\nRU1GVGVzdENhc2U7CgovKgogKiBUbyB0ZXN0OgogKiAgLSBtYW5hZ2VkIHRy\nYW5zYWN0aW9ucwogKiAgLSBjb252ZXJ0aW5nIG5vbi1lbmhhbmNlZCBjbGFz\nc2VzIHRvIGVuaGFuY2VkIHN1YmNsYXNzZXMKICogICAgKG1heWJlIGFuIHVn\nbHkgVGhyZWFkTG9jYWwsIG1heWJlIHRocm91Z2ggUENEYXRhPykKICovCnB1\nYmxpYyBhYnN0cmFjdCBjbGFzcyBBYnN0cmFjdEJyb2tlclNlcmlhbGl6YXRp\nb25UZXN0PFQ+CiAgICBleHRlbmRzIFNpbmdsZUVNRlRlc3RDYXNlIHsKCiAg\nICBwcml2YXRlIHN0YXRpYyBMaWZlTGlzdGVuZXIgZGVzZXJpYWxpemVkTGlm\nZUxpc3RlbmVyOwogICAgcHJpdmF0ZSBzdGF0aWMgaW50IHRlc3RHbG9iYWxS\nZWZyZXNoQ291bnQgPSAwOwoKICAgIHByaXZhdGUgc3RhdGljIFR4TGlzdGVu\nZXIgZGVzZXJpYWxpemVkVHhMaXN0ZW5lcjsKICAgIHByaXZhdGUgc3RhdGlj\nIGludCB0ZXN0R2xvYmFsQmVnaW5Db3VudCA9IDA7CgoKICAgIHByaXZhdGUg\nT2JqZWN0IGlkOwoKICAgIHB1YmxpYyB2b2lkIHNldFVwKCkgewogICAgICAg\nIHRlc3RHbG9iYWxSZWZyZXNoQ291bnQgPSAwOwogICAgICAgIGRlc2VyaWFs\naXplZExpZmVMaXN0ZW5lciA9IG51bGw7CiAgICAgICAgdGVzdEdsb2JhbEJl\nZ2luQ291bnQgPSAwOwogICAgICAgIGRlc2VyaWFsaXplZFR4TGlzdGVuZXIg\nPSBudWxsOwoKICAgICAgICBzZXRVcChnZXRNYW5hZ2VkVHlwZSgpLCBnZXRT\nZWNvbmRhcnlUeXBlKCksIENMRUFSX1RBQkxFUywKICAgICAgICAgICAgIm9w\nZW5qcGEuRW50aXR5TWFuYWdlckZhY3RvcnlQb29sIiwgInRydWUiKTsKICAg\nICAgICAKICAgICAgICBUIGUgPSBuZXdNYW5hZ2VkSW5zdGFuY2UoKTsKICAg\nICAgICBPcGVuSlBBRW50aXR5TWFuYWdlciBlbSA9IGVtZi5jcmVhdGVFbnRp\ndHlNYW5hZ2VyKCk7CiAgICAgICAgZW0uZ2V0VHJhbnNhY3Rpb24oKS5iZWdp\nbigpOwogICAgICAgIGVtLnBlcnNpc3QoZSk7CiAgICAgICAgZW0uZ2V0VHJh\nbnNhY3Rpb24oKS5jb21taXQoKTsKICAgICAgICBpZCA9IGVtLmdldE9iamVj\ndElkKGUpOwogICAgICAgIGVtLmNsb3NlKCk7CiAgICB9CgogICAgQE92ZXJy\naWRlCiAgICBwdWJsaWMgdm9pZCB0ZWFyRG93bigpIHRocm93cyBFeGNlcHRp\nb24gewogICAgICAgIHN1cGVyLnRlYXJEb3duKCk7CiAgICAgICAgdGVzdEds\nb2JhbFJlZnJlc2hDb3VudCA9IDA7CiAgICAgICAgZGVzZXJpYWxpemVkTGlm\nZUxpc3RlbmVyID0gbnVsbDsKICAgICAgICB0ZXN0R2xvYmFsQmVnaW5Db3Vu\ndCA9IDA7CiAgICAgICAgZGVzZXJpYWxpemVkVHhMaXN0ZW5lciA9IG51bGw7\nCiAgICB9CgogICAgcHVibGljIHZvaWQgdGVzdEVtcHR5QnJva2VyU2VyaWFs\naXphdGlvbigpIHsKICAgICAgICBPcGVuSlBBRW50aXR5TWFuYWdlciBlbSA9\nIGVtZi5jcmVhdGVFbnRpdHlNYW5hZ2VyKCk7CiAgICAgICAgT3BlbkpQQUVu\ndGl0eU1hbmFnZXIgZW0yID0gZGVzZXJpYWxpemVFTShzZXJpYWxpemUoZW0p\nKTsKCiAgICAgICAgYXNzZXJ0VHJ1ZShlbSAhPSBlbTIpOwogICAgICAgIGFz\nc2VydFRydWUoCiAgICAgICAgICAgIEpQQUZhY2FkZUhlbHBlci50b0Jyb2tl\ncihlbSkgIT0gSlBBRmFjYWRlSGVscGVyLnRvQnJva2VyKGVtMikpOwogICAg\nICAgIGFzc2VydFNhbWUoZW0uZ2V0RW50aXR5TWFuYWdlckZhY3RvcnkoKSwg\nZW0yLmdldEVudGl0eU1hbmFnZXJGYWN0b3J5KCkpOwoKICAgICAgICBhc3Nl\ncnRTYW1lKGVtMiwgSlBBRmFjYWRlSGVscGVyLnRvQnJva2VyKGVtMikKICAg\nICAgICAgICAgLmdldFVzZXJPYmplY3QoSlBBRmFjYWRlSGVscGVyLkVNX0tF\nWSkpOwoKICAgICAgICBlbS5jbG9zZSgpOwogICAgICAgIGFzc2VydFRydWUo\nZW0yLmlzT3BlbigpKTsKICAgICAgICBlbTIuY2xvc2UoKTsKICAgIH0KCiAg\nICBwdWJsaWMgdm9pZCB0ZXN0Tm9udHJhbnNhY3Rpb25hbEJyb2tlclNlcmlh\nbGl6YXRpb24oKSB7CiAgICAgICAgT3BlbkpQQUVudGl0eU1hbmFnZXIgZW0g\nPSBlbWYuY3JlYXRlRW50aXR5TWFuYWdlcigpOwogICAgICAgIFQgZSA9IGVt\nLmZpbmQoZ2V0TWFuYWdlZFR5cGUoKSwgaWQpOwogICAgICAgIE9wZW5KUEFF\nbnRpdHlNYW5hZ2VyIGVtMiA9IGRlc2VyaWFsaXplRU0oc2VyaWFsaXplKGVt\nKSk7CgogICAgICAgIGFzc2VydEZhbHNlKGVtMi5nZXRUcmFuc2FjdGlvbigp\nLmlzQWN0aXZlKCkpOwoKICAgICAgICBhc3NlcnRGYWxzZShlbTIuY29udGFp\nbnMoZSkpOwogICAgICAgIGFzc2VydEVxdWFscygxKmdyYXBoU2l6ZSgpLCBl\nbTIuZ2V0TWFuYWdlZE9iamVjdHMoKS5zaXplKCkpOwogICAgICAgIFQgZTIg\nPSBlbTIuZmluZChnZXRNYW5hZ2VkVHlwZSgpLCBpZCk7CiAgICAgICAgYXNz\nZXJ0RXF1YWxzKGVtLmdldE9iamVjdElkKGUpLCBlbTIuZ2V0T2JqZWN0SWQo\nZTIpKTsKCiAgICAgICAgZW0uY2xvc2UoKTsKICAgICAgICBlbTIuY2xvc2Uo\nKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCB0ZXN0VW5mbHVzaGVkT3B0aW1p\nc3RpY1R4QnJva2VyU2VyaWFsaXphdGlvbigpIHsKICAgICAgICBPcGVuSlBB\nRW50aXR5TWFuYWdlciBlbSA9IGVtZi5jcmVhdGVFbnRpdHlNYW5hZ2VyKCk7\nCiAgICAgICAgVCBlID0gZW0uZmluZChnZXRNYW5hZ2VkVHlwZSgpLCBpZCk7\nCiAgICAgICAgT3BlbkpQQUVudGl0eU1hbmFnZXIgZW0yID0gbnVsbDsKICAg\nICAgICBPcGVuSlBBRW50aXR5TWFuYWdlciBlbTMgPSBudWxsOwogICAgICAg\nIHRyeSB7CiAgICAgICAgICAgIGVtLmdldFRyYW5zYWN0aW9uKCkuYmVnaW4o\nKTsKICAgICAgICAgICAgbW9kaWZ5SW5zdGFuY2UoZSk7CiAgICAgICAgICAg\nIFQgbmV3ZSA9IG5ld01hbmFnZWRJbnN0YW5jZSgpOwogICAgICAgICAgICBl\nbS5wZXJzaXN0KG5ld2UpOwogICAgICAgICAgICBlbTIgPSBkZXNlcmlhbGl6\nZUVNKHNlcmlhbGl6ZShlbSkpOwoKICAgICAgICAgICAgYXNzZXJ0VHJ1ZShl\nbTIuZ2V0VHJhbnNhY3Rpb24oKS5pc0FjdGl2ZSgpKTsKCiAgICAgICAgICAg\nIGFzc2VydEZhbHNlKGVtMi5jb250YWlucyhlKSk7CiAgICAgICAgICAgIFQg\nZTIgPSBlbTIuZmluZChnZXRNYW5hZ2VkVHlwZSgpLCBpZCk7CiAgICAgICAg\nICAgIGFzc2VydEVxdWFscyhlbS5nZXRPYmplY3RJZChlKSwgZW0yLmdldE9i\namVjdElkKGUyKSk7CgogICAgICAgICAgICBhc3NlcnRFcXVhbHMoIm1vZGlm\naWVkIiwgZ2V0TW9kaWZpZWRWYWx1ZShlMikpOwoKICAgICAgICAgICAgZW0u\nZ2V0VHJhbnNhY3Rpb24oKS5yb2xsYmFjaygpOwogICAgICAgICAgICBhc3Nl\ncnRUcnVlKGVtMi5nZXRUcmFuc2FjdGlvbigpLmlzQWN0aXZlKCkpOwogICAg\nICAgICAgICBlbTIuZ2V0VHJhbnNhY3Rpb24oKS5jb21taXQoKTsKCiAgICAg\nICAgICAgIGVtMyA9IGVtZi5jcmVhdGVFbnRpdHlNYW5hZ2VyKCk7CiAgICAg\nICAgICAgIFQgZTMgPSBlbTMuZmluZChnZXRNYW5hZ2VkVHlwZSgpLCBpZCk7\nCiAgICAgICAgICAgIGFzc2VydEVxdWFscyhnZXRNb2RpZmllZFZhbHVlKGUy\nKSwgZ2V0TW9kaWZpZWRWYWx1ZShlMykpOwogICAgICAgICAgICBhc3NlcnRU\ncnVlKDEgPCAoKE51bWJlcikgZW0zLmNyZWF0ZVF1ZXJ5KCJzZWxlY3QgY291\nbnQobykgZnJvbSAiCiAgICAgICAgICAgICAgICArIGdldE1hbmFnZWRUeXBl\nKCkuZ2V0TmFtZSgpICsgIiBvIikuZ2V0U2luZ2xlUmVzdWx0KCkpCiAgICAg\nICAgICAgICAgICAuaW50VmFsdWUoKSk7CiAgICAgICAgfSBmaW5hbGx5IHsK\nICAgICAgICAgICAgY2xvc2UoZW0pOwogICAgICAgICAgICBjbG9zZShlbTIp\nOwogICAgICAgICAgICBjbG9zZShlbTMpOwogICAgICAgIH0KICAgIH0KCiAg\nICBwdWJsaWMgdm9pZCB0ZXN0Rmx1c2hlZE9wdGltaXN0aWNUeEJyb2tlclNl\ncmlhbGl6YXRpb24oKSB7CiAgICAgICAgT3BlbkpQQUVudGl0eU1hbmFnZXIg\nZW0gPSBlbWYuY3JlYXRlRW50aXR5TWFuYWdlcigpOwogICAgICAgIFQgZSA9\nIGVtLmZpbmQoZ2V0TWFuYWdlZFR5cGUoKSwgaWQpOwogICAgICAgIGVtLmdl\ndFRyYW5zYWN0aW9uKCkuYmVnaW4oKTsKICAgICAgICBtb2RpZnlJbnN0YW5j\nZShlKTsKICAgICAgICBlbS5mbHVzaCgpOwogICAgICAgIHRyeSB7CiAgICAg\nICAgICAgIHNlcmlhbGl6ZShlbSk7CiAgICAgICAgfSBjYXRjaCAoSW52YWxp\nZFN0YXRlRXhjZXB0aW9uIGlzZSkgewogICAgICAgICAgICAvLyBleHBlY3Rl\nZAogICAgICAgICAgICBhc3NlcnRUcnVlKGlzZS5nZXRNZXNzYWdlKCkuY29u\ndGFpbnMoImZsdXNoZWQiKSk7CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAg\nICAgICAgZW0uZ2V0VHJhbnNhY3Rpb24oKS5yb2xsYmFjaygpOwogICAgICAg\nICAgICBlbS5jbG9zZSgpOwogICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMg\ndm9pZCB0ZXN0Q29ubmVjdGVkT3B0aW1pc3RpY1R4QnJva2VyU2VyaWFsaXph\ndGlvbigpIHsKICAgICAgICBNYXAgbSA9IG5ldyBIYXNoTWFwKCk7CiAgICAg\nICAgbS5wdXQoIm9wZW5qcGEuQ29ubmVjdGlvblJldGFpbk1vZGUiLCAiYWx3\nYXlzIik7CiAgICAgICAgT3BlbkpQQUVudGl0eU1hbmFnZXIgZW0gPSBlbWYu\nY3JlYXRlRW50aXR5TWFuYWdlcihtKTsKICAgICAgICB0cnkgewogICAgICAg\nICAgICBzZXJpYWxpemUoZW0pOwogICAgICAgIH0gY2F0Y2ggKEludmFsaWRT\ndGF0ZUV4Y2VwdGlvbiBpc2UpIHsKICAgICAgICAgICAgLy8gZXhwZWN0ZWQK\nICAgICAgICAgICAgYXNzZXJ0VHJ1ZShpc2UuZ2V0TWVzc2FnZSgpLmNvbnRh\naW5zKCJjb25uZWN0ZWQiKSk7CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAg\nICAgICAgZW0uY2xvc2UoKTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGlj\nIHZvaWQgdGVzdEVtcHR5UGVzc2ltaXN0aWNUeEJyb2tlclNlcmlhbGl6YXRp\nb24oKSB7CiAgICAgICAgTWFwIG0gPSBuZXcgSGFzaE1hcCgpOwogICAgICAg\nIG0ucHV0KCJvcGVuanBhLk9wdGltaXN0aWMiLCAiZmFsc2UiKTsKICAgICAg\nICBPcGVuSlBBRW50aXR5TWFuYWdlciBlbSA9IGVtZi5jcmVhdGVFbnRpdHlN\nYW5hZ2VyKG0pOwogICAgICAgIGVtLmdldFRyYW5zYWN0aW9uKCkuYmVnaW4o\nKTsKICAgICAgICB0cnkgewogICAgICAgICAgICBzZXJpYWxpemUoZW0pOwog\nICAgICAgICAgICBmYWlsKCJzaG91bGQgbm90IGJlIGFibGUgdG8gc2VyaWFs\naXplIik7CiAgICAgICAgfSBjYXRjaCAoSW52YWxpZFN0YXRlRXhjZXB0aW9u\nIGlzZSkgewogICAgICAgICAgICAvLyBleHBlY3RlZAogICAgICAgICAgICBh\nc3NlcnRUcnVlKGlzZS5nZXRNZXNzYWdlKCkuY29udGFpbnMoImRhdGFzdG9y\nZSAocGVzc2ltaXN0aWMpIikpOwogICAgICAgIH0gZmluYWxseSB7CiAgICAg\nICAgICAgIGVtLmdldFRyYW5zYWN0aW9uKCkucm9sbGJhY2soKTsKICAgICAg\nICAgICAgZW0uY2xvc2UoKTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGlj\nIHZvaWQgdGVzdE5vbkVtcHR5UGVzc2ltaXN0aWNUeEJyb2tlclNlcmlhbGl6\nYXRpb24oKSB7CiAgICAgICAgTWFwIG0gPSBuZXcgSGFzaE1hcCgpOwogICAg\nICAgIG0ucHV0KCJvcGVuanBhLk9wdGltaXN0aWMiLCAiZmFsc2UiKTsKICAg\nICAgICBPcGVuSlBBRW50aXR5TWFuYWdlciBlbSA9IGVtZi5jcmVhdGVFbnRp\ndHlNYW5hZ2VyKG0pOwogICAgICAgIFQgZSA9IGVtLmZpbmQoZ2V0TWFuYWdl\nZFR5cGUoKSwgaWQpOwogICAgICAgIGVtLmdldFRyYW5zYWN0aW9uKCkuYmVn\naW4oKTsKICAgICAgICB0cnkgewogICAgICAgICAgICBzZXJpYWxpemUoZW0p\nOwogICAgICAgICAgICBmYWlsKCJzaG91bGQgbm90IGJlIGFibGUgdG8gc2Vy\naWFsaXplIik7CiAgICAgICAgfSBjYXRjaCAoSW52YWxpZFN0YXRlRXhjZXB0\naW9uIGlzZSkgewogICAgICAgICAgICAvLyBleHBlY3RlZAogICAgICAgICAg\nICBhc3NlcnRUcnVlKGlzZS5nZXRNZXNzYWdlKCkuY29udGFpbnMoImRhdGFz\ndG9yZSAocGVzc2ltaXN0aWMpIikpOwogICAgICAgIH0gZmluYWxseSB7CiAg\nICAgICAgICAgIGVtLmdldFRyYW5zYWN0aW9uKCkucm9sbGJhY2soKTsKICAg\nICAgICAgICAgZW0uY2xvc2UoKTsKICAgICAgICB9CiAgICB9CgogICAgcHVi\nbGljIHZvaWQgdGVzdEZldGNoQ29uZmlndXJhdGlvbk11dGF0aW9ucygpIHsK\nICAgICAgICBPcGVuSlBBRW50aXR5TWFuYWdlciBlbSA9IGVtZi5jcmVhdGVF\nbnRpdHlNYW5hZ2VyKCk7CiAgICAgICAgSkRCQ0ZldGNoUGxhbiBwbGFuID0g\nKEpEQkNGZXRjaFBsYW4pIGVtLmdldEZldGNoUGxhbigpOwoKICAgICAgICBh\nc3NlcnROb3RFcXVhbHMoMTcsIHBsYW4uZ2V0TG9ja1RpbWVvdXQoKSk7CiAg\nICAgICAgYXNzZXJ0Tm90RXF1YWxzKEpvaW5TeW50YXguVFJBRElUSU9OQUws\nIHBsYW4uZ2V0Sm9pblN5bnRheCgpKTsKCiAgICAgICAgcGxhbi5zZXRMb2Nr\nVGltZW91dCgxNyk7CiAgICAgICAgcGxhbi5zZXRKb2luU3ludGF4KEpvaW5T\neW50YXguVFJBRElUSU9OQUwpOwoKICAgICAgICBPcGVuSlBBRW50aXR5TWFu\nYWdlciBlbTIgPSBkZXNlcmlhbGl6ZUVNKHNlcmlhbGl6ZShlbSkpOwogICAg\nICAgIEpEQkNGZXRjaFBsYW4gcGxhbjIgPSAoSkRCQ0ZldGNoUGxhbikgZW0y\nLmdldEZldGNoUGxhbigpOwogICAgICAgIGFzc2VydEVxdWFscygxNywgcGxh\nbjIuZ2V0TG9ja1RpbWVvdXQoKSk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKEpv\naW5TeW50YXguVFJBRElUSU9OQUwsIHBsYW4yLmdldEpvaW5TeW50YXgoKSk7\nCiAgICB9CgogICAgcHVibGljIHZvaWQgdGVzdEluTWVtb3J5U2F2ZXBvaW50\nc1dpdGhOZXdJbnN0YW5jZXMoKSB7CiAgICAgICAgZW1mLmNsb3NlKCk7CiAg\nICAgICAgT3BlbkpQQUVudGl0eU1hbmFnZXJGYWN0b3J5IGVtZiA9IGNyZWF0\nZUVNRigKICAgICAgICAgICAgZ2V0TWFuYWdlZFR5cGUoKSwgZ2V0U2Vjb25k\nYXJ5VHlwZSgpLAogICAgICAgICAgICAib3BlbmpwYS5FbnRpdHlNYW5hZ2Vy\nRmFjdG9yeVBvb2wiLCAidHJ1ZSIsCiAgICAgICAgICAgICJvcGVuanBhLlNh\ndmVwb2ludE1hbmFnZXIiLCAiaW4tbWVtIik7CiAgICAgICAgT3BlbkpQQUVu\ndGl0eU1hbmFnZXIgZW0gPSBlbWYuY3JlYXRlRW50aXR5TWFuYWdlcigpOwog\nICAgICAgIE9wZW5KUEFFbnRpdHlNYW5hZ2VyIGVtMiA9IG51bGw7CiAgICAg\nICAgdHJ5IHsKICAgICAgICAgICAgZW0uZ2V0VHJhbnNhY3Rpb24oKS5iZWdp\nbigpOwogICAgICAgICAgICBUIHQgPSBuZXdNYW5hZ2VkSW5zdGFuY2UoKTsK\nICAgICAgICAgICAgT2JqZWN0IG9yaWcgPSBnZXRNb2RpZmllZFZhbHVlKHQp\nOwogICAgICAgICAgICBlbS5wZXJzaXN0KHQpOwogICAgICAgICAgICBPYmpl\nY3QgaWQgPSBlbS5nZXRPYmplY3RJZCh0KTsKICAgICAgICAgICAgZW0uc2V0\nU2F2ZXBvaW50KCJmb28iKTsKICAgICAgICAgICAgbW9kaWZ5SW5zdGFuY2Uo\ndCk7CiAgICAgICAgICAgIGFzc2VydE5vdEVxdWFscyhvcmlnLCBnZXRNb2Rp\nZmllZFZhbHVlKHQpKTsKCiAgICAgICAgICAgIGVtMiA9IGRlc2VyaWFsaXpl\nRU0oc2VyaWFsaXplKGVtKSk7CiAgICAgICAgICAgIFQgdDIgPSBlbTIuZmlu\nZChnZXRNYW5hZ2VkVHlwZSgpLCBpZCk7CiAgICAgICAgICAgIGFzc2VydE5v\ndEVxdWFscyhvcmlnLCBnZXRNb2RpZmllZFZhbHVlKHQyKSk7CgogICAgICAg\nICAgICBlbS5yb2xsYmFja1RvU2F2ZXBvaW50KCJmb28iKTsKICAgICAgICAg\nICAgYXNzZXJ0RXF1YWxzKG9yaWcsIGdldE1vZGlmaWVkVmFsdWUodCkpOwoK\nICAgICAgICAgICAgZW0yLnJvbGxiYWNrVG9TYXZlcG9pbnQoImZvbyIpOwog\nICAgICAgICAgICBhc3NlcnRFcXVhbHMob3JpZywgZ2V0TW9kaWZpZWRWYWx1\nZSh0MikpOwogICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgIGNsb3Nl\nKGVtKTsKICAgICAgICAgICAgY2xvc2UoZW0yKTsKICAgICAgICB9CiAgICB9\nCgogICAgcHVibGljIHZvaWQgdGVzdEluTWVtb3J5U2F2ZXBvaW50c1dpdGhN\nb2RpZmllZEluc3RhbmNlcygpIHsKICAgICAgICBlbWYuY2xvc2UoKTsKICAg\nICAgICBPcGVuSlBBRW50aXR5TWFuYWdlckZhY3RvcnkgZW1mID0gY3JlYXRl\nRU1GKAogICAgICAgICAgICBnZXRNYW5hZ2VkVHlwZSgpLCBnZXRTZWNvbmRh\ncnlUeXBlKCksCiAgICAgICAgICAgICJvcGVuanBhLkVudGl0eU1hbmFnZXJG\nYWN0b3J5UG9vbCIsICJ0cnVlIiwKICAgICAgICAgICAgIm9wZW5qcGEuU2F2\nZXBvaW50TWFuYWdlciIsICJpbi1tZW0iKTsKICAgICAgICBPcGVuSlBBRW50\naXR5TWFuYWdlciBlbSA9IGVtZi5jcmVhdGVFbnRpdHlNYW5hZ2VyKCk7CiAg\nICAgICAgT3BlbkpQQUVudGl0eU1hbmFnZXIgZW0yID0gbnVsbDsKICAgICAg\nICB0cnkgewogICAgICAgICAgICBlbS5nZXRUcmFuc2FjdGlvbigpLmJlZ2lu\nKCk7CiAgICAgICAgICAgIFQgdCA9IGVtLmZpbmQoZ2V0TWFuYWdlZFR5cGUo\nKSwgaWQpOwogICAgICAgICAgICBPYmplY3Qgb3JpZyA9IGdldE1vZGlmaWVk\nVmFsdWUodCk7CiAgICAgICAgICAgIGVtLnNldFNhdmVwb2ludCgiZm9vIik7\nCiAgICAgICAgICAgIG1vZGlmeUluc3RhbmNlKHQpOwogICAgICAgICAgICBh\nc3NlcnROb3RFcXVhbHMob3JpZywgZ2V0TW9kaWZpZWRWYWx1ZSh0KSk7Cgog\nICAgICAgICAgICBlbTIgPSBkZXNlcmlhbGl6ZUVNKHNlcmlhbGl6ZShlbSkp\nOwogICAgICAgICAgICBUIHQyID0gZW0yLmZpbmQoZ2V0TWFuYWdlZFR5cGUo\nKSwgaWQpOwogICAgICAgICAgICBhc3NlcnROb3RFcXVhbHMob3JpZywgZ2V0\nTW9kaWZpZWRWYWx1ZSh0MikpOwoKICAgICAgICAgICAgZW0ucm9sbGJhY2tU\nb1NhdmVwb2ludCgiZm9vIik7CiAgICAgICAgICAgIGFzc2VydEVxdWFscyhv\ncmlnLCBnZXRNb2RpZmllZFZhbHVlKHQpKTsKCiAgICAgICAgICAgIGVtMi5y\nb2xsYmFja1RvU2F2ZXBvaW50KCJmb28iKTsKICAgICAgICAgICAgYXNzZXJ0\nRXF1YWxzKG9yaWcsIGdldE1vZGlmaWVkVmFsdWUodDIpKTsKICAgICAgICB9\nIGZpbmFsbHkgewogICAgICAgICAgICBjbG9zZShlbSk7CiAgICAgICAgICAg\nIGNsb3NlKGVtMik7CiAgICAgICAgfQogICAgfQoKICAgIHB1YmxpYyB2b2lk\nIHRlc3RFdmVudE1hbmFnZXJzKCkgewogICAgICAgIFR4TGlzdGVuZXIgdHhM\naXN0ZW5lciA9IG5ldyBUeExpc3RlbmVyKCk7CiAgICAgICAgZW1mLmFkZFRy\nYW5zYWN0aW9uTGlzdGVuZXIodHhMaXN0ZW5lcik7CiAgICAgICAgTGlmZUxp\nc3RlbmVyIGxpZmVMaXN0ZW5lciA9IG5ldyBMaWZlTGlzdGVuZXIoKTsKICAg\nICAgICBlbWYuYWRkTGlmZWN5Y2xlTGlzdGVuZXIobGlmZUxpc3RlbmVyLCBu\ndWxsKTsKCiAgICAgICAgT3BlbkpQQUVudGl0eU1hbmFnZXIgZW0gPSBlbWYu\nY3JlYXRlRW50aXR5TWFuYWdlcigpOwogICAgICAgIFQgdCA9IGVtLmZpbmQo\nZ2V0TWFuYWdlZFR5cGUoKSwgaWQpOwogICAgICAgIGFzc2VydEVxdWFscygw\nLCBsaWZlTGlzdGVuZXIucmVmcmVzaENvdW50KTsKICAgICAgICBlbS5yZWZy\nZXNoKHQpOwogICAgICAgIGFzc2VydEVxdWFscygxKmdyYXBoU2l6ZSgpLCBs\naWZlTGlzdGVuZXIucmVmcmVzaENvdW50KTsKICAgICAgICBlbS5nZXRUcmFu\nc2FjdGlvbigpLmJlZ2luKCk7CiAgICAgICAgZW0uZ2V0VHJhbnNhY3Rpb24o\nKS5jb21taXQoKTsKICAgICAgICBlbS5nZXRUcmFuc2FjdGlvbigpLmJlZ2lu\nKCk7CiAgICAgICAgZW0uZ2V0VHJhbnNhY3Rpb24oKS5jb21taXQoKTsKICAg\nICAgICBhc3NlcnRFcXVhbHMoMiwgdHhMaXN0ZW5lci5iZWdpbkNvdW50KTsK\nCiAgICAgICAgT3BlbkpQQUVudGl0eU1hbmFnZXIgZW0yID0gZGVzZXJpYWxp\nemVFTShzZXJpYWxpemUoZW0pKTsKICAgICAgICBhc3NlcnROb3ROdWxsKGRl\nc2VyaWFsaXplZExpZmVMaXN0ZW5lcik7CiAgICAgICAgYXNzZXJ0RXF1YWxz\nKDEqIGdyYXBoU2l6ZSgpLAogICAgICAgICAgICBkZXNlcmlhbGl6ZWRMaWZl\nTGlzdGVuZXIucmVmcmVzaENvdW50KTsKICAgICAgICBhc3NlcnROb3RTYW1l\nKGxpZmVMaXN0ZW5lciwgZGVzZXJpYWxpemVkTGlmZUxpc3RlbmVyKTsKICAg\nICAgICBUIHQyID0gZW0yLmZpbmQoZ2V0TWFuYWdlZFR5cGUoKSwgaWQpOwog\nICAgICAgIGVtMi5yZWZyZXNoKHQyKTsKICAgICAgICBhc3NlcnRFcXVhbHMo\nMiogZ3JhcGhTaXplKCksCiAgICAgICAgICAgIGRlc2VyaWFsaXplZExpZmVM\naXN0ZW5lci5yZWZyZXNoQ291bnQpOwoKICAgICAgICAvLyBpZiB0aGlzIGlz\nIDMqcmVmcmVzaE11bHRpcGxpZXIoKSwgdGhhdCBtZWFucyB0aGF0IHRoZXJl\nIGFyZQogICAgICAgIC8vIGV4dHJhIHJlZ2lzdGVyZWQgbGlzdGVuZXJzCiAg\nICAgICAgYXNzZXJ0RXF1YWxzKDIqIGdyYXBoU2l6ZSgpLCB0ZXN0R2xvYmFs\nUmVmcmVzaENvdW50KTsKCgogICAgICAgIGFzc2VydE5vdE51bGwoZGVzZXJp\nYWxpemVkVHhMaXN0ZW5lcik7CiAgICAgICAgYXNzZXJ0RXF1YWxzKDIsIGRl\nc2VyaWFsaXplZFR4TGlzdGVuZXIuYmVnaW5Db3VudCk7CiAgICAgICAgYXNz\nZXJ0Tm90U2FtZSh0eExpc3RlbmVyLCBkZXNlcmlhbGl6ZWRUeExpc3RlbmVy\nKTsKICAgICAgICBlbTIuZ2V0VHJhbnNhY3Rpb24oKS5iZWdpbigpOwogICAg\nICAgIGVtMi5nZXRUcmFuc2FjdGlvbigpLnJvbGxiYWNrKCk7CiAgICAgICAg\nYXNzZXJ0RXF1YWxzKDMsIGRlc2VyaWFsaXplZFR4TGlzdGVuZXIuYmVnaW5D\nb3VudCk7CgogICAgICAgIC8vIGlmIHRoaXMgaXMgNCwgdGhhdCBtZWFucyB0\naGF0IHRoZXJlIGFyZSBleHRyYSByZWdpc3RlcmVkIGxpc3RlbmVycwogICAg\nICAgIGFzc2VydEVxdWFscygzLCB0ZXN0R2xvYmFsQmVnaW5Db3VudCk7CiAg\nICB9CgogICAgYnl0ZVtdIHNlcmlhbGl6ZShPYmplY3QgbykgewogICAgICAg\nIHRyeSB7CiAgICAgICAgICAgIEJ5dGVBcnJheU91dHB1dFN0cmVhbSBiYW9z\nID0gbmV3IEJ5dGVBcnJheU91dHB1dFN0cmVhbSgpOwogICAgICAgICAgICBP\nYmplY3RPdXRwdXRTdHJlYW0gb29zID0gbmV3IE9iamVjdE91dHB1dFN0cmVh\nbShiYW9zKTsKICAgICAgICAgICAgb29zLndyaXRlT2JqZWN0KG8pOwogICAg\nICAgICAgICBvb3MuZmx1c2goKTsKICAgICAgICAgICAgcmV0dXJuIGJhb3Mu\ndG9CeXRlQXJyYXkoKTsKICAgICAgICB9IGNhdGNoIChJT0V4Y2VwdGlvbiBp\nb2UpIHsKICAgICAgICAgICAgdGhyb3cgbmV3IFJ1bnRpbWVFeGNlcHRpb24o\naW9lKTsKICAgICAgICB9CiAgICB9CgogICAgT3BlbkpQQUVudGl0eU1hbmFn\nZXIgZGVzZXJpYWxpemVFTShieXRlW10gYnl0ZXMpIHsKICAgICAgICByZXR1\ncm4gKE9wZW5KUEFFbnRpdHlNYW5hZ2VyKSBkZXNlcmlhbGl6ZShieXRlcyk7\nCiAgICB9CgogICAgcHJpdmF0ZSBPYmplY3QgZGVzZXJpYWxpemUoYnl0ZVtd\nIGJ5dGVzKSB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgQnl0ZUFycmF5\nSW5wdXRTdHJlYW0gYmFpcyA9IG5ldyBCeXRlQXJyYXlJbnB1dFN0cmVhbShi\neXRlcyk7CiAgICAgICAgICAgIE9iamVjdElucHV0U3RyZWFtIG9pcyA9IG5l\ndyBPYmplY3RJbnB1dFN0cmVhbShiYWlzKTsKICAgICAgICAgICAgcmV0dXJu\nIG9pcy5yZWFkT2JqZWN0KCk7CiAgICAgICAgfSBjYXRjaCAoSU9FeGNlcHRp\nb24gaW9lKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBSdW50aW1lRXhjZXB0\naW9uKGlvZSk7CiAgICAgICAgfSBjYXRjaCAoQ2xhc3NOb3RGb3VuZEV4Y2Vw\ndGlvbiBlKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBSdW50aW1lRXhjZXB0\naW9uKGUpOwogICAgICAgIH0KICAgIH0KCiAgICB2b2lkIGNsb3NlKEVudGl0\neU1hbmFnZXIgZW0pIHsKICAgICAgICBpZiAoZW0gIT0gbnVsbCAmJiBlbS5p\nc09wZW4oKSAmJiBlbS5nZXRUcmFuc2FjdGlvbigpLmlzQWN0aXZlKCkpCiAg\nICAgICAgICAgIGVtLmdldFRyYW5zYWN0aW9uKCkucm9sbGJhY2soKTsKICAg\nICAgICBpZiAoZW0gIT0gbnVsbCAmJiBlbS5pc09wZW4oKSkKICAgICAgICAg\nICAgZW0uY2xvc2UoKTsKICAgIH0KCiAgICBwcm90ZWN0ZWQgYWJzdHJhY3Qg\nQ2xhc3M8VD4gZ2V0TWFuYWdlZFR5cGUoKTsKCiAgICBwcm90ZWN0ZWQgYWJz\ndHJhY3QgVCBuZXdNYW5hZ2VkSW5zdGFuY2UoKTsKCiAgICBwcm90ZWN0ZWQg\nYWJzdHJhY3Qgdm9pZCBtb2RpZnlJbnN0YW5jZShUIHQpOwoKICAgIHByb3Rl\nY3RlZCBhYnN0cmFjdCBPYmplY3QgZ2V0TW9kaWZpZWRWYWx1ZShUIHQpOwoK\nICAgIC8qKgogICAgICogVGhlIG51bWJlciBvZiBpbnN0YW5jZXMgaW4gdGhl\nIGdyYXBoIGNyZWF0ZWQKICAgICAqIGJ5IHtAbGluayAjbmV3TWFuYWdlZElu\nc3RhbmNlKCl9IG9mIHR5cGUgVC4KICAgICAqLwogICAgcHJvdGVjdGVkIGlu\ndCBncmFwaFNpemUoKSB7CiAgICAgICAgcmV0dXJuIDE7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBBbiBhZGRpdGlvbmFsIHR5cGUgdGhhdCBtdXN0IGJlIGF2\nYWlsYWJsZSBpbiB0aGlzIFBDLiBNYXkgYmUgbnVsbC4KICAgICAqLwogICAg\ncHJvdGVjdGVkIENsYXNzPD8+IGdldFNlY29uZGFyeVR5cGUoKSB7CiAgICAg\nICAgcmV0dXJuIG51bGw7CiAgICB9CgogICAgcHJpdmF0ZSBzdGF0aWMgY2xh\nc3MgVHhMaXN0ZW5lcgogICAgICAgIGV4dGVuZHMgQWJzdHJhY3RUcmFuc2Fj\ndGlvbkxpc3RlbmVyCiAgICAgICAgaW1wbGVtZW50cyBTZXJpYWxpemFibGUg\newoKICAgICAgICBwcml2YXRlIGludCBiZWdpbkNvdW50ID0gMDsKCiAgICAg\nICAgcHVibGljIFR4TGlzdGVuZXIoKSB7CgogICAgICAgIH0KCiAgICAgICAg\nQE92ZXJyaWRlCiAgICAgICAgcHVibGljIHZvaWQgYWZ0ZXJCZWdpbihUcmFu\nc2FjdGlvbkV2ZW50IGV2ZW50KSB7CiAgICAgICAgICAgIGJlZ2luQ291bnQr\nKzsKICAgICAgICAgICAgdGVzdEdsb2JhbEJlZ2luQ291bnQrKzsKICAgICAg\nICB9CgogICAgICAgIHByaXZhdGUgdm9pZCByZWFkT2JqZWN0KE9iamVjdElu\ncHV0U3RyZWFtIGluKQogICAgICAgICAgICB0aHJvd3MgQ2xhc3NOb3RGb3Vu\nZEV4Y2VwdGlvbiwgSU9FeGNlcHRpb24gewogICAgICAgICAgICBpbi5kZWZh\ndWx0UmVhZE9iamVjdCgpOwogICAgICAgICAgICBkZXNlcmlhbGl6ZWRUeExp\nc3RlbmVyID0gdGhpczsKICAgICAgICB9CiAgICB9CgogICAgcHJpdmF0ZSBz\ndGF0aWMgY2xhc3MgTGlmZUxpc3RlbmVyCiAgICAgICAgZXh0ZW5kcyBBYnN0\ncmFjdExpZmVjeWNsZUxpc3RlbmVyCiAgICAgICAgaW1wbGVtZW50cyBTZXJp\nYWxpemFibGUgewoKICAgICAgICBwcml2YXRlIGludCByZWZyZXNoQ291bnQg\nPSAwOwoKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBwdWJsaWMgdm9pZCBh\nZnRlclJlZnJlc2goTGlmZWN5Y2xlRXZlbnQgZXZlbnQpIHsKICAgICAgICAg\nICAgcmVmcmVzaENvdW50Kys7CiAgICAgICAgICAgIHRlc3RHbG9iYWxSZWZy\nZXNoQ291bnQrKzsKICAgICAgICB9CgogICAgICAgIHByaXZhdGUgdm9pZCBy\nZWFkT2JqZWN0KE9iamVjdElucHV0U3RyZWFtIGluKQogICAgICAgICAgICB0\naHJvd3MgQ2xhc3NOb3RGb3VuZEV4Y2VwdGlvbiwgSU9FeGNlcHRpb24gewog\nICAgICAgICAgICBpbi5kZWZhdWx0UmVhZE9iamVjdCgpOwogICAgICAgICAg\nICBkZXNlcmlhbGl6ZWRMaWZlTGlzdGVuZXIgPSB0aGlzOwogICAgICAgIH0K\nICAgIH0KfQo=\n","encoding":"base64"}

