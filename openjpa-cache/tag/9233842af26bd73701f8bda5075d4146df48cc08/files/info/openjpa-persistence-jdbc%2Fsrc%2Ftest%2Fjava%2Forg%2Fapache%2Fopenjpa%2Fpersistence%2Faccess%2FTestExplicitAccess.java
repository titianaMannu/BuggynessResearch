{"sha":"604fddae1b9ce3b59c51b280c8b2f557e01ba690","node_id":"MDQ6QmxvYjIwNjM2NDo2MDRmZGRhZTFiOWNlM2I1OWM1MWIyODBjOGIyZjU1N2UwMWJhNjkw","size":43652,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/604fddae1b9ce3b59c51b280c8b2f557e01ba690","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNr\nYWdlIG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5hY2Nlc3M7Cgpp\nbXBvcnQgamF2YS5sYW5nLnJlZmxlY3QuTWV0aG9kOwppbXBvcnQgamF2YS51\ndGlsLkFycmF5TGlzdDsKaW1wb3J0IGphdmEudXRpbC5Db2xsZWN0aW9uOwpp\nbXBvcnQgamF2YS51dGlsLkRhdGU7CmltcG9ydCBqYXZhLnV0aWwuSGFzaE1h\ncDsKaW1wb3J0IGphdmEudXRpbC5NYXA7CmltcG9ydCBqYXZhLnV0aWwuUmFu\nZG9tOwoKaW1wb3J0IGphdmF4LnBlcnNpc3RlbmNlLlF1ZXJ5OwoKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5tZXRhLkFjY2Vzc0NvZGU7CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEubWV0YS5DbGFzc01ldGFEYXRhOwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuTWV0YURhdGFSZXBvc2l0b3J5Owpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNlLkFyZ3VtZW50\nRXhjZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNpc3Rl\nbmNlLk9wZW5KUEFFbnRpdHlNYW5hZ2VyU1BJOwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLnBlcnNpc3RlbmNlLnRlc3QuU2luZ2xlRU1GVGVzdENhc2U7\nCgpwdWJsaWMgY2xhc3MgVGVzdEV4cGxpY2l0QWNjZXNzIGV4dGVuZHMgU2lu\nZ2xlRU1GVGVzdENhc2UgewoKICAgIHB1YmxpYyB2b2lkIHNldFVwKCkgewog\nICAgICAgIHNldFVwKENMRUFSX1RBQkxFUywgCiAgICAgICAgICAgIFByb3BB\nY2Nlc3MuY2xhc3MsIEZpZWxkQWNjZXNzLmNsYXNzLAogICAgICAgICAgICBE\nZWZGaWVsZE1peGVkUHJvcEFjY2Vzcy5jbGFzcyAsIERlZlByb3BNaXhlZEZp\nZWxkQWNjZXNzLmNsYXNzLAogICAgICAgICAgICBBYnN0cmFjdE1hcHBlZFN1\ncGVyRmllbGQuY2xhc3MsIFByb3BlcnR5U3ViLmNsYXNzLAogICAgICAgICAg\nICBNYXBwZWRTdXBlckZpZWxkLmNsYXNzLCBQcm9wZXJ0eVN1YjIuY2xhc3Ms\nCiAgICAgICAgICAgIFN1cGVyRmllbGRFbnRpdHkuY2xhc3MsIFByb3BlcnR5\nU3ViMy5jbGFzcywKICAgICAgICAgICAgQWJzdHJhY3RNYXBwZWRTdXBlclBy\nb3BlcnR5LmNsYXNzLCBGaWVsZFN1Yi5jbGFzcywKICAgICAgICAgICAgTWFw\ncGVkU3VwZXJQcm9wZXJ0eS5jbGFzcywgRmllbGRTdWIyLmNsYXNzLAogICAg\nICAgICAgICBTdXBlclByb3BlcnR5RW50aXR5LmNsYXNzLCBGaWVsZFN1YjMu\nY2xhc3MsCiAgICAgICAgICAgIE1peGVkTWFwcGVkU3VwZXIuY2xhc3MsIE1p\neGVkRmllbGRTdWIuY2xhc3MsCiAgICAgICAgICAgIEZpZWxkRW1iZWRFbnRp\ndHkuY2xhc3MsIEVtYmVkRmllbGRBY2Nlc3MuY2xhc3MsCiAgICAgICAgICAg\nIFByb3BFbWJlZEVudGl0eS5jbGFzcywgRW1iZWRQcm9wQWNjZXNzLmNsYXNz\nLAogICAgICAgICAgICBQcm9wTWl4ZWRFbnRpdHkuY2xhc3MsIEVtYmVkTWl4\nZWRBY2Nlc3MuY2xhc3MsCiAgICAgICAgICAgIE1peGVkTmVzdGVkRW1iZWRF\nbnRpdHkuY2xhc3MsIEVtYmVkSW5uZXJQcm9wLmNsYXNzLAogICAgICAgICAg\nICBFbWJlZE91dGVyRmllbGQuY2xhc3MsIE1peGVkTXVsdEVtYmVkRW50aXR5\nLmNsYXNzLAogICAgICAgICAgICBGaWVsZEFjY2Vzc1Byb3BTdHJhdHNFbnRp\ndHkuY2xhc3MsIAogICAgICAgICAgICBQcm9wQWNjZXNzRmllbGRTdHJhdHNF\nbnRpdHkuY2xhc3MsCiAgICAgICAgICAgIEVtYmVkSWQuY2xhc3MsIE1lbnVJ\ndGVtLmNsYXNzLCBJbmdyZWRpZW50LmNsYXNzLCBRdWFudGl0eS5jbGFzcyk7\nCiAgICB9CgogICAgCiAgICAvKioKICAgICAqIFZhbGlkYXRlcyB0aGUgdXNl\nIG9mIGZpZWxkIGxldmVsIGFjY2VzcyBvbiBhbgogICAgICogZW50aXR5LCBt\nYXBwZWRzdXBlcmNsYXNzLCBhbmQgZW1iZWRkYWJsZSBhdCB0aGUKICAgICAq\nIGNsYXNzIGxldmVsLgogICAgICovCiAgICBwdWJsaWMgdm9pZCB0ZXN0Q2xh\nc3NTcGVjaWZpZWRGaWVsZEFjY2VzcygpIHsKCiAgICAgICAgT3BlbkpQQUVu\ndGl0eU1hbmFnZXJTUEkgZW0gPSBlbWYuY3JlYXRlRW50aXR5TWFuYWdlcigp\nOwogICAgICAgIAogICAgICAgIEZpZWxkQWNjZXNzIGZhID0gbmV3IEZpZWxk\nQWNjZXNzKCk7CiAgICAgICAgLy8gU2V0IHRoZSBwZXJzaXN0ZW50IGZpZWxk\nIHRocm91Z2ggYSBtaXNuYW1lZCBzZXR0ZXIgICAgICAgICAKICAgICAgICBm\nYS5zZXRTdHJpbmdGaWVsZCgiRmllbGRBY2Nlc3MiKTsKICAgICAgICAKICAg\nICAgICBlbS5nZXRUcmFuc2FjdGlvbigpLmJlZ2luKCk7CiAgICAgICAgZW0u\ncGVyc2lzdChmYSk7CiAgICAgICAgZW0uZ2V0VHJhbnNhY3Rpb24oKS5jb21t\naXQoKTsKICAgICAgICBlbS5jbGVhcigpOwogICAgICAgIAogICAgICAgIC8v\nIFRoaXMgdmFsdWUgb2YgYSBwZXJzaXN0ZW50IGZpZWxkIHdhcyBzZXQgdXNp\nbmcgdGhlIHNldHRlcgogICAgICAgIC8vIGFib3ZlLCBidXQgdGhpcyBxdWVy\neSB3aWxsIHVzZSB0aGUgZmllbGQgbmFtZSB0byB2ZXJpZnkgdGhhdAogICAg\nICAgIC8vIGZpZWxkIGFjY2VzcyBpcyBpbiB1c2UuCiAgICAgICAgUXVlcnkg\ncXJ5ID0gZW0uY3JlYXRlTmFtZWRRdWVyeSgiRmllbGRBY2Nlc3MucXVlcnki\nKTsKICAgICAgICBxcnkuc2V0UGFyYW1ldGVyKCJpZCIsIGZhLmdldElkKCkp\nOwogICAgICAgIHFyeS5zZXRQYXJhbWV0ZXIoInN0clZhbCIsICJGaWVsZEFj\nY2VzcyIpOwogICAgICAgIEZpZWxkQWNjZXNzIGZhMiA9IChGaWVsZEFjY2Vz\ncylxcnkuZ2V0U2luZ2xlUmVzdWx0KCk7CiAgICAgICAgYXNzZXJ0RXF1YWxz\nKGZhLmdldElkKCksIGZhMi5nZXRJZCgpKTsKICAgICAgICAKICAgICAgICBl\nbS5jbG9zZSgpOwogICAgfQoKICAgIC8qKgogICAgICogVmFsaWRhdGVzIHRo\nZSB1c2Ugb2YgcHJvcGVydHkgbGV2ZWwgYWNjZXNzIG9uIGFuCiAgICAgKiBl\nbnRpdHksIG1hcHBlZHN1cGVyY2xhc3MsIGFuZCBlbWJlZGRhYmxlIGF0IHRo\nZQogICAgICogY2xhc3MgbGV2ZWwuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lk\nIHRlc3RDbGFzc1NwZWNpZmllZFByb3BlcnR5QWNjZXNzKCkgewoKICAgICAg\nICBPcGVuSlBBRW50aXR5TWFuYWdlclNQSSBlbSA9IGVtZi5jcmVhdGVFbnRp\ndHlNYW5hZ2VyKCk7CiAgICAgICAgCiAgICAgICAgUHJvcEFjY2VzcyBwYSA9\nIG5ldyBQcm9wQWNjZXNzKCk7CiAgICAgICAgLy8gU2V0IHRoZSBwZXJzaXN0\nZW50IGZpZWxkIHRocm91Z2ggYSBtaXNuYW1lZCBzZXR0ZXIgICAgICAgICAK\nICAgICAgICBwYS5zZXRTdHJQcm9wKCJQcm9wZXJ0eUFjY2VzcyIpOwogICAg\nICAgIAogICAgICAgIGVtLmdldFRyYW5zYWN0aW9uKCkuYmVnaW4oKTsKICAg\nICAgICBlbS5wZXJzaXN0KHBhKTsKICAgICAgICBlbS5nZXRUcmFuc2FjdGlv\nbigpLmNvbW1pdCgpOwogICAgICAgIGVtLmNsZWFyKCk7CiAgICAgICAgCiAg\nICAgICAgLy8gVGhpcyB2YWx1ZSBvZiBhIHBlcnNpc3RlbnQgZmllbGQgd2Fz\nIHNldCB1c2luZyB0aGUgc2V0dGVyCiAgICAgICAgLy8gYWJvdmUsIGJ1dCB0\naGlzIHF1ZXJ5IHdpbGwgdXNlIHRoZSBmaWVsZCBuYW1lIHRvIHZlcmlmeSB0\naGF0CiAgICAgICAgLy8gZmllbGQgYWNjZXNzIGlzIGluIHVzZS4KICAgICAg\nICBRdWVyeSBxcnkgPSBlbS5jcmVhdGVOYW1lZFF1ZXJ5KCJQcm9wZXJ0eUFj\nY2Vzcy5xdWVyeSIpOwogICAgICAgIHFyeS5zZXRQYXJhbWV0ZXIoImlkIiwg\ncGEuZ2V0SWQoKSk7CiAgICAgICAgcXJ5LnNldFBhcmFtZXRlcigic3RyVmFs\nIiwgIlByb3BlcnR5QWNjZXNzIik7CiAgICAgICAgUHJvcEFjY2VzcyBwYTIg\nPSAoUHJvcEFjY2VzcylxcnkuZ2V0U2luZ2xlUmVzdWx0KCk7CiAgICAgICAg\nYXNzZXJ0RXF1YWxzKHBhLCBwYTIpOwogICAgfQogICAgCiAgICAvKioKICAg\nICAqIFZhbGlkYXRlcyB0aGUgdXNlIG9mIGV4cGxpY2l0IGZpZWxkIGFjY2Vz\ncyBvbiBhbiBlbnRpdHksIAogICAgICogbWFwcGVkc3VwZXJjbGFzcywgYW5k\nIGVtYmVkZGFibGUgd2l0aCBwcm9wZXJ0eSBhY2Nlc3MKICAgICAqIGRlZmlu\nZWQgYXQgdGhlIGNsYXNzIGxldmVsIGFuZCBmaWVsZCBhY2Nlc3MgZGVmaW5l\nZAogICAgICogb24gc3BlY2lmaWMgbWV0aG9kcy4gCiAgICAgKi8gICAgCiAg\nICBwdWJsaWMgdm9pZCB0ZXN0Q2xhc3NTcGVjaWZpZWRNaXhlZFNpbmdsZVBD\nRmllbGRBY2Nlc3MoKSB7CgogICAgICAgIE9wZW5KUEFFbnRpdHlNYW5hZ2Vy\nU1BJIGVtID0gZW1mLmNyZWF0ZUVudGl0eU1hbmFnZXIoKTsKICAgICAgICAK\nICAgICAgICBEZWZGaWVsZE1peGVkUHJvcEFjY2VzcyBkZm1wYSA9IG5ldyBE\nZWZGaWVsZE1peGVkUHJvcEFjY2VzcygpOwogICAgICAgIC8vIENhbGwgbm9u\nLVBDIHNldHRlcgogICAgICAgIGRmbXBhLnNldFN0ckZpZWxkKCJOb25QQ1Nl\ndHRlciIpOwogICAgICAgIC8vIENhbGwgc2V0dGVyIHdpdGggcHJvcGVydHkg\nYWNjZXNzCiAgICAgICAgZGZtcGEuc2V0U3RyaW5nRmllbGQoIkRGTVBBIik7\nCiAgICAgICAgCiAgICAgICAgZW0uZ2V0VHJhbnNhY3Rpb24oKS5iZWdpbigp\nOwogICAgICAgIGVtLnBlcnNpc3QoZGZtcGEpOwogICAgICAgIGVtLmdldFRy\nYW5zYWN0aW9uKCkuY29tbWl0KCk7CiAgICAgICAgZW0uY2xlYXIoKTsKICAg\nICAgICAKICAgICAgICAvLyBUaGlzIHZhbHVlIG9mIGEgcGVyc2lzdGVudCBw\ncm9wZXJ0eSB3YXMgc2V0IHVzaW5nIHRoZSBzZXR0ZXIKICAgICAgICAvLyBh\nYm92ZSwgYnV0IHRoaXMgcXVlcnkgd2lsbCB1c2UgdGhlIHByb3BlcnR5IG5h\nbWUgdG8gdmVyaWZ5IHRoYXQKICAgICAgICAvLyBwcm9wZXR5IGFjY2VzcyBp\ncyBpbiB1c2UuCiAgICAgICAgUXVlcnkgcXJ5ID0gZW0uY3JlYXRlTmFtZWRR\ndWVyeSgiREZNUEEucXVlcnkiKTsKICAgICAgICBxcnkuc2V0UGFyYW1ldGVy\nKCJpZCIsIGRmbXBhLmdldElkKCkpOwogICAgICAgIHFyeS5zZXRQYXJhbWV0\nZXIoInN0clZhbCIsICJERk1QQSIpOwogICAgICAgIERlZkZpZWxkTWl4ZWRQ\ncm9wQWNjZXNzIGRmbXBhMiA9IAogICAgICAgICAgICAoRGVmRmllbGRNaXhl\nZFByb3BBY2Nlc3MpcXJ5LmdldFNpbmdsZVJlc3VsdCgpOwogICAgICAgIGFz\nc2VydEVxdWFscyhkZm1wYSwgZGZtcGEyKTsKICAgICAgICBhc3NlcnRFcXVh\nbHMoZGZtcGEyLmdldFN0cmluZ0ZpZWxkKCksICJERk1QQSIpOwoKICAgICAg\nICB0cnkgewogICAgICAgICAgICBxcnkgPSBlbS5jcmVhdGVOYW1lZFF1ZXJ5\nKCJERk1QQS5iYWRRdWVyeSIpOwogICAgICAgICAgICBxcnkuc2V0UGFyYW1l\ndGVyKCJpZCIsIGRmbXBhLmdldElkKCkpOwogICAgICAgICAgICBxcnkuc2V0\nUGFyYW1ldGVyKCJzdHJWYWwiLCAiREZNUEEiKTsKICAgICAgICAgICAgcXJ5\nLmdldFNpbmdsZVJlc3VsdCgpOwogICAgICAgICAgICBmYWlsKCJVc2FnZSBv\nZiB0aGlzIHF1ZXJ5IHNob3VsZCBoYXZlIHRocm93biBhbiBleGNlcHRpb24i\nKTsKICAgICAgICB9CiAgICAgICAgY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAg\nICAgICAgICAgIGFzc2VydEV4Y2VwdGlvbk1lc3NhZ2UoZSwgQXJndW1lbnRF\neGNlcHRpb24uY2xhc3MsCiAgICAgICAgICAgICAgICAiTm8gZmllbGQgbmFt\nZWQgXCJzdHJGaWVsZFwiIGluIFwiRGVmRmllbGRNaXhlZFByb3BBY2Nlc3Nc\nIiIsCiAgICAgICAgICAgICAgICAiW2lkLCBzdHJpbmdGaWVsZCwgdmVyc2lv\nbl0iKTsKICAgICAgICB9CgogICAgICAgIGVtLmNsb3NlKCk7CiAgICB9CiAg\nICAKICAgIC8qKgogICAgICogVmFsaWRhdGVzIHRoZSB1c2Ugb2YgZXhwbGlj\naXQgcHJvcGVydHkgYWNjZXNzIG9uIGFuIGVudGl0eSwgCiAgICAgKiBtYXBw\nZWRzdXBlcmNsYXNzLCBhbmQgZW1iZWRkYWJsZSB3aXRoIGZpZWxkIGFjY2Vz\ncwogICAgICogZGVmaW5lZCBhdCB0aGUgY2xhc3MgbGV2ZWwgYW5kIHByb3Bl\ncnR5IGFjY2VzcyBkZWZpbmVkCiAgICAgKiBvbiBzcGVjaWZpYyBtZXRob2Rz\nLiAKICAgICAqLyAgICAKICAgIHB1YmxpYyB2b2lkIHRlc3RDbGFzc1NwZWNp\nZmllZE1peGVkU2luZ2xlUENQcm9wZXJ0eUFjY2VzcygpIHsKCiAgICAgICAg\nT3BlbkpQQUVudGl0eU1hbmFnZXJTUEkgZW0gPSBlbWYuY3JlYXRlRW50aXR5\nTWFuYWdlcigpOwogICAgICAgIAogICAgICAgIERlZlByb3BNaXhlZEZpZWxk\nQWNjZXNzIGRwbWZhID0gbmV3IERlZlByb3BNaXhlZEZpZWxkQWNjZXNzKCk7\nCiAgICAgICAgLy8gQ2FsbCBzZXR0ZXIgd2l0aCB1bmRlcmx5aW5nIGZpZWxk\nIGFjY2VzcwogICAgICAgIGRwbWZhLnNldFN0clByb3AoIkRQTUZBIik7CiAg\nICAgICAgCiAgICAgICAgZW0uZ2V0VHJhbnNhY3Rpb24oKS5iZWdpbigpOwog\nICAgICAgIGVtLnBlcnNpc3QoZHBtZmEpOwogICAgICAgIGVtLmdldFRyYW5z\nYWN0aW9uKCkuY29tbWl0KCk7CiAgICAgICAgZW0uY2xlYXIoKTsKICAgICAg\nICAKICAgICAgICAvLyBUaGlzIHZhbHVlIG9mIGEgcGVyc2lzdGVudCBmaWVs\nZCB3YXMgc2V0IHVzaW5nIHRoZSBzZXR0ZXIKICAgICAgICAvLyBhYm92ZSwg\nYnV0IHRoaXMgcXVlcnkgd2lsbCB1c2UgdGhlIHByb3BlcnR5IG5hbWUgdG8g\ndmVyaWZ5IHRoYXQKICAgICAgICAvLyBwcm9wZXR5IGFjY2VzcyBpcyBpbiB1\nc2UuCiAgICAgICAgUXVlcnkgcXJ5ID0gZW0uY3JlYXRlTmFtZWRRdWVyeSgi\nRFBNRkEucXVlcnkiKTsKICAgICAgICBxcnkuc2V0UGFyYW1ldGVyKCJpZCIs\nIGRwbWZhLmdldElkKCkpOwogICAgICAgIHFyeS5zZXRQYXJhbWV0ZXIoInN0\nclZhbCIsICJEUE1GQSIpOwogICAgICAgIERlZlByb3BNaXhlZEZpZWxkQWNj\nZXNzIGRwbWZhMiA9IAogICAgICAgICAgICAoRGVmUHJvcE1peGVkRmllbGRB\nY2Nlc3MpcXJ5LmdldFNpbmdsZVJlc3VsdCgpOwogICAgICAgIGFzc2VydEVx\ndWFscyhkcG1mYSwgZHBtZmEyKTsKICAgICAgICBhc3NlcnRFcXVhbHMoZHBt\nZmEyLmdldFN0clByb3AoKSwgIkRQTUZBIik7CgogICAgICAgIHRyeSB7CiAg\nICAgICAgICAgIHFyeSA9IGVtLmNyZWF0ZU5hbWVkUXVlcnkoIkRQTUZBLmJh\nZFF1ZXJ5Iik7CiAgICAgICAgICAgIHFyeS5zZXRQYXJhbWV0ZXIoImlkIiwg\nZHBtZmEuZ2V0SWQoKSk7CiAgICAgICAgICAgIHFyeS5zZXRQYXJhbWV0ZXIo\nInN0clZhbCIsICJEUE1GQSIpOwogICAgICAgICAgICBxcnkuZ2V0U2luZ2xl\nUmVzdWx0KCk7CiAgICAgICAgICAgIGZhaWwoIlVzYWdlIG9mIHRoaXMgcXVl\ncnkgc2hvdWxkIGhhdmUgdGhyb3duIGFuIGV4Y2VwdGlvbiIpOwogICAgICAg\nIH0KICAgICAgICBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAg\nYXNzZXJ0RXhjZXB0aW9uTWVzc2FnZShlLCBBcmd1bWVudEV4Y2VwdGlvbi5j\nbGFzcywKICAgICAgICAgICAgICAgICJObyBmaWVsZCBuYW1lZCBcInN0clBy\nb3BcIiBpbiBcIkRlZlByb3BNaXhlZEZpZWxkQWNjZXNzXCIiLAogICAgICAg\nICAgICAgICAgIltpZCwgc3RyRmllbGQsIHZlcnNpb25dIik7CiAgICAgICAg\nfQoKICAgICAgICBlbS5jbG9zZSgpOwogICAgfQogICAgCiAgICAvKioKICAg\nICAqIFZhbGlkYXRlcyB0aGF0IGEgbWFwcGVkIHN1cGVyY2xhc3MgdXNpbmcg\nZmllbGQgYWNjZXNzIGFuZCBhbiBlbnRpdHkKICAgICAqIHN1YmNsYXNzIHVz\naW5nIHByb3BlcnR5IGFjY2VzcyBnZXQgbWFwcGVkIHByb3Blcmx5LgogICAg\nICovCiAgICBwdWJsaWMgdm9pZCB0ZXN0QWJzdHJhY3RNYXBwZWRTdXBlckZp\nZWxkKCkgewogICAgICAgIE9wZW5KUEFFbnRpdHlNYW5hZ2VyU1BJIGVtID0g\nZW1mLmNyZWF0ZUVudGl0eU1hbmFnZXIoKTsKICAgICAgICAKICAgICAgICBQ\ncm9wZXJ0eVN1YiBwcyA9IG5ldyBQcm9wZXJ0eVN1YigpOwogICAgICAgIC8v\nIENhbGwgc3VwZXIgc2V0dGVyIHdpdGggdW5kZXJseWluZyBmaWVsZCBhY2Nl\nc3MKICAgICAgICBwcy5zZXROYW1lKCJBYnNNYXBwZWRTdXBlck5hbWUiKTsK\nICAgICAgICAvLyBDYWxsIGJhc2Ugc2V0dGVyIHdpdGggcHJvcGVydHkgYWNj\nZXNzCiAgICAgICAgRGF0ZSBub3cgPSBuZXcgRGF0ZSgpOwogICAgICAgIHBz\nLnNldENyZWF0ZURhdGUobm93KTsKICAgICAgICAKICAgICAgICBlbS5nZXRU\ncmFuc2FjdGlvbigpLmJlZ2luKCk7CiAgICAgICAgZW0ucGVyc2lzdChwcyk7\nCiAgICAgICAgZW0uZ2V0VHJhbnNhY3Rpb24oKS5jb21taXQoKTsKICAgICAg\nICBlbS5jbGVhcigpOwogICAgICAgIAogICAgICAgIC8vIFRoaXMgdmFsdWUg\nb2YgYSBwZXJzaXN0ZW50IGZpZWxkIHdhcyBzZXQgdXNpbmcgdGhlIHNldHRl\ncgogICAgICAgIC8vIGFib3ZlLCBidXQgdGhpcyBxdWVyeSB3aWxsIHVzZSB0\naGUgcHJvcGVydHkgbmFtZSB0byB2ZXJpZnkgdGhhdAogICAgICAgIC8vIHBy\nb3BldHkgYWNjZXNzIGlzIGluIHVzZS4KICAgICAgICBRdWVyeSBxcnkgPSBl\nbS5jcmVhdGVOYW1lZFF1ZXJ5KCJQcm9wZXJ0eVN1Yi5xdWVyeSIpOwogICAg\nICAgIHFyeS5zZXRQYXJhbWV0ZXIoImlkIiwgcHMuZ2V0SWQoKSk7CiAgICAg\nICAgcXJ5LnNldFBhcmFtZXRlcigibmFtZSIsICJBYnNNYXBwZWRTdXBlck5h\nbWUiKTsKICAgICAgICBxcnkuc2V0UGFyYW1ldGVyKCJjcnREYXRlIiwgbm93\nKTsKICAgICAgICBQcm9wZXJ0eVN1YiBwczIgPSAKICAgICAgICAgICAgKFBy\nb3BlcnR5U3ViKXFyeS5nZXRTaW5nbGVSZXN1bHQoKTsKICAgICAgICBhc3Nl\ncnRFcXVhbHMocHMsIHBzMik7CiAgICAgICAgYXNzZXJ0RXF1YWxzKHBzMi5n\nZXROYW1lKCksICJBYnNNYXBwZWRTdXBlck5hbWUiKTsKICAgICAgICBhc3Nl\ncnRFcXVhbHMocHMyLmdldENyZWF0ZURhdGUoKS50b1N0cmluZygpLCBub3cu\ndG9TdHJpbmcoKSk7CgogICAgICAgIHRyeSB7CiAgICAgICAgICAgIHFyeSA9\nIGVtLmNyZWF0ZU5hbWVkUXVlcnkoIlByb3BlcnR5U3ViLmJhZFF1ZXJ5Iik7\nCiAgICAgICAgICAgIHFyeS5zZXRQYXJhbWV0ZXIoImlkIiwgcHMuZ2V0SWQo\nKSk7CiAgICAgICAgICAgIHFyeS5zZXRQYXJhbWV0ZXIoIm5hbWUiLCAiQWJz\nTWFwcGVkU3VwZXJOYW1lIik7CiAgICAgICAgICAgIHFyeS5zZXRQYXJhbWV0\nZXIoImNydERhdGUiLCBub3cpOwogICAgICAgICAgICBxcnkuZ2V0U2luZ2xl\nUmVzdWx0KCk7CiAgICAgICAgICAgIGZhaWwoIlVzYWdlIG9mIHRoaXMgcXVl\ncnkgc2hvdWxkIGhhdmUgdGhyb3duIGFuIGV4Y2VwdGlvbiIpOwogICAgICAg\nIH0KICAgICAgICBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAg\nYXNzZXJ0RXhjZXB0aW9uTWVzc2FnZShlLCBBcmd1bWVudEV4Y2VwdGlvbi5j\nbGFzcywKICAgICAgICAgICAgICAgICJObyBmaWVsZCBuYW1lZCBcImNydERh\ndGVcIiBpbiBcIlByb3BlcnR5U3ViXCIiLAogICAgICAgICAgICAgICAgIltj\ncmVhdGVEYXRlLCBpZCwgbmFtZV0iKTsKICAgICAgICB9CgogICAgICAgIGVt\nLmNsb3NlKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBWYWxpZGF0ZXMgdGhh\ndCBhIG1hcHBlZCBzdXBlcmNsYXNzIHVzaW5nIHByb3BlcnR5IGFjY2VzcyBh\nbmQgYW4gZW50aXR5CiAgICAgKiBzdWJjbGFzcyB1c2luZyBmaWVsZCBhY2Nl\nc3MgZ2V0IG1hcHBlZCBwcm9wZXJseS4KICAgICAqLwogICAgcHVibGljIHZv\naWQgdGVzdEFic3RyYWN0TWFwcGVkU3VwZXJQcm9wZXJ0eSgpIHsKICAgICAg\nICBPcGVuSlBBRW50aXR5TWFuYWdlclNQSSBlbSA9IGVtZi5jcmVhdGVFbnRp\ndHlNYW5hZ2VyKCk7CiAgICAgICAgCiAgICAgICAgRmllbGRTdWIgZnMgPSBu\nZXcgRmllbGRTdWIoKTsKICAgICAgICAvLyBDYWxsIHN1cGVyIHNldHRlciB3\naXRoIHVuZGVybHlpbmcgZmllbGQgYWNjZXNzCiAgICAgICAgZnMuc2V0TmFt\nZSgiQWJzTWFwcGVkU3VwZXJOYW1lIik7CiAgICAgICAgLy8gQ2FsbCBiYXNl\nIHNldHRlciB3aXRoIHByb3BlcnR5IGFjY2VzcwogICAgICAgIERhdGUgbm93\nID0gbmV3IERhdGUoKTsKICAgICAgICBmcy5zZXRDcmVhdGVEYXRlKG5vdyk7\nCiAgICAgICAgCiAgICAgICAgZW0uZ2V0VHJhbnNhY3Rpb24oKS5iZWdpbigp\nOwogICAgICAgIGVtLnBlcnNpc3QoZnMpOwogICAgICAgIGVtLmdldFRyYW5z\nYWN0aW9uKCkuY29tbWl0KCk7CiAgICAgICAgZW0uY2xlYXIoKTsKICAgICAg\nICAKICAgICAgICAvLyBUaGlzIHZhbHVlIG9mIGEgcGVyc2lzdGVudCBmaWVs\nZCB3YXMgc2V0IHVzaW5nIHRoZSBzZXR0ZXIKICAgICAgICAvLyBhYm92ZSwg\nYnV0IHRoaXMgcXVlcnkgd2lsbCB1c2UgdGhlIHByb3BlcnR5IG5hbWUgdG8g\ndmVyaWZ5IHRoYXQKICAgICAgICAvLyBwcm9wZXR5IGFjY2VzcyBpcyBpbiB1\nc2UuCiAgICAgICAgUXVlcnkgcXJ5ID0gZW0uY3JlYXRlTmFtZWRRdWVyeSgi\nRmllbGRTdWIucXVlcnkiKTsKICAgICAgICBxcnkuc2V0UGFyYW1ldGVyKCJp\nZCIsIGZzLmdldElkKCkpOwogICAgICAgIHFyeS5zZXRQYXJhbWV0ZXIoIm5h\nbWUiLCAiQWJzTWFwcGVkU3VwZXJOYW1lIik7CiAgICAgICAgcXJ5LnNldFBh\ncmFtZXRlcigiY3J0RGF0ZSIsIG5vdyk7CiAgICAgICAgRmllbGRTdWIgZnMy\nID0gCiAgICAgICAgICAgIChGaWVsZFN1YilxcnkuZ2V0U2luZ2xlUmVzdWx0\nKCk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKGZzLCBmczIpOwogICAgICAgIGFz\nc2VydEVxdWFscyhmczIuZ2V0TmFtZSgpLCAiQWJzTWFwcGVkU3VwZXJOYW1l\nIik7CiAgICAgICAgYXNzZXJ0RXF1YWxzKGZzMi5nZXRDcmVhdGVEYXRlKCku\ndG9TdHJpbmcoKSwgbm93LnRvU3RyaW5nKCkpOwoKICAgICAgICB0cnkgewog\nICAgICAgICAgICBxcnkgPSBlbS5jcmVhdGVOYW1lZFF1ZXJ5KCJGaWVsZFN1\nYi5iYWRRdWVyeSIpOwogICAgICAgICAgICBxcnkuc2V0UGFyYW1ldGVyKCJp\nZCIsIGZzLmdldElkKCkpOwogICAgICAgICAgICBxcnkuc2V0UGFyYW1ldGVy\nKCJuYW1lIiwgIkFic01hcHBlZFN1cGVyTmFtZSIpOwogICAgICAgICAgICBx\ncnkuc2V0UGFyYW1ldGVyKCJjcnREYXRlIiwgbm93KTsKICAgICAgICAgICAg\ncXJ5LmdldFNpbmdsZVJlc3VsdCgpOwogICAgICAgICAgICBmYWlsKCJVc2Fn\nZSBvZiB0aGlzIHF1ZXJ5IHNob3VsZCBoYXZlIHRocm93biBhbiBleGNlcHRp\nb24iKTsKICAgICAgICB9CiAgICAgICAgY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7\nCiAgICAgICAgICAgIGFzc2VydEV4Y2VwdGlvbk1lc3NhZ2UoZSwgQXJndW1l\nbnRFeGNlcHRpb24uY2xhc3MsCiAgICAgICAgICAgICAgICAiTm8gZmllbGQg\nbmFtZWQgXCJjcmVhdGVEYXRlXCIgaW4gXCJGaWVsZFN1YlwiIiwKICAgICAg\nICAgICAgICAgICJbY3J0RGF0ZSwgaWQsIG5hbWVdIik7CiAgICAgICAgfQoK\nICAgICAgICBlbS5jbG9zZSgpOwogICAgfQoKICAgIC8qKgogICAgICogVmFs\naWRhdGVzIHRoYXQgYW4gbWFwcGVkIHN1cGVyY2xhc3MgdXNpbmcgZmllbGQg\nYWNjZXNzIGFuZCBhbiAKICAgICAqIGVudGl0eSBzdWJjbGFzcyB1c2luZyBw\ncm9wZXJ0eSBhY2Nlc3MgZ2V0IG1hcHBlZCBwcm9wZXJseS4KICAgICAqIFRo\nZSBzdWJjbGFzcyB1c2VzIGEgc3RvcmFnZSBmaWVsZCBpbiB0aGUgc3VwZXJj\nbGFzcy4gCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHRlc3RNYXBwZWRTdXBl\nckZpZWxkKCkgewogICAgICAgIE9wZW5KUEFFbnRpdHlNYW5hZ2VyU1BJIGVt\nID0gZW1mLmNyZWF0ZUVudGl0eU1hbmFnZXIoKTsKICAgICAgICAKICAgICAg\nICBQcm9wZXJ0eVN1YjIgcHMgPSBuZXcgUHJvcGVydHlTdWIyKCk7CiAgICAg\nICAgLy8gQ2FsbCBzdXBlciBzZXR0ZXIgd2l0aCB1bmRlcmx5aW5nIGZpZWxk\nIGFjY2VzcwogICAgICAgIHBzLnNldE5hbWUoIk1hcHBlZFN1cGVyTmFtZSIp\nOwogICAgICAgIC8vIENhbGwgYmFzZSBzZXR0ZXIgd2l0aCBwcm9wZXJ0eSBh\nY2Nlc3MKICAgICAgICBEYXRlIG5vdyA9IG5ldyBEYXRlKCk7CiAgICAgICAg\ncHMuc2V0Q3JlYXRlRGF0ZShub3cpOwogICAgICAgIAogICAgICAgIGVtLmdl\ndFRyYW5zYWN0aW9uKCkuYmVnaW4oKTsKICAgICAgICBlbS5wZXJzaXN0KHBz\nKTsKICAgICAgICBlbS5nZXRUcmFuc2FjdGlvbigpLmNvbW1pdCgpOwogICAg\nICAgIGVtLmNsZWFyKCk7CiAgICAgICAgCiAgICAgICAgLy8gVGhpcyB2YWx1\nZSBvZiBhIHBlcnNpc3RlbnQgZmllbGQgd2FzIHNldCB1c2luZyB0aGUgc2V0\ndGVyCiAgICAgICAgLy8gYWJvdmUsIGJ1dCB0aGlzIHF1ZXJ5IHdpbGwgdXNl\nIHRoZSBwcm9wZXJ0eSBuYW1lIHRvIHZlcmlmeSB0aGF0CiAgICAgICAgLy8g\ncHJvcGV0eSBhY2Nlc3MgaXMgaW4gdXNlLgogICAgICAgIFF1ZXJ5IHFyeSA9\nIGVtLmNyZWF0ZU5hbWVkUXVlcnkoIlByb3BlcnR5U3ViMi5xdWVyeSIpOwog\nICAgICAgIHFyeS5zZXRQYXJhbWV0ZXIoImlkIiwgcHMuZ2V0SWQoKSk7CiAg\nICAgICAgcXJ5LnNldFBhcmFtZXRlcigibmFtZSIsICJNYXBwZWRTdXBlck5h\nbWUiKTsKICAgICAgICBxcnkuc2V0UGFyYW1ldGVyKCJjcnREYXRlIiwgbm93\nKTsKICAgICAgICBQcm9wZXJ0eVN1YjIgcHMyID0gCiAgICAgICAgICAgIChQ\ncm9wZXJ0eVN1YjIpcXJ5LmdldFNpbmdsZVJlc3VsdCgpOwogICAgICAgIGFz\nc2VydEVxdWFscyhwcywgcHMyKTsKICAgICAgICBhc3NlcnRFcXVhbHMocHMy\nLmdldE5hbWUoKSwgIk1hcHBlZFN1cGVyTmFtZSIpOwogICAgICAgIGFzc2Vy\ndEVxdWFscyhwczIuZ2V0Q3JlYXRlRGF0ZSgpLnRvU3RyaW5nKCksIG5vdy50\nb1N0cmluZygpKTsKCiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgcXJ5ID0g\nZW0uY3JlYXRlTmFtZWRRdWVyeSgiUHJvcGVydHlTdWIyLmJhZFF1ZXJ5Iik7\nCiAgICAgICAgICAgIHFyeS5zZXRQYXJhbWV0ZXIoImlkIiwgcHMuZ2V0SWQo\nKSk7CiAgICAgICAgICAgIHFyeS5zZXRQYXJhbWV0ZXIoIm5hbWUiLCAiTWFw\ncGVkU3VwZXJOYW1lIik7CiAgICAgICAgICAgIHFyeS5zZXRQYXJhbWV0ZXIo\nImNydERhdGUiLCBub3cpOwogICAgICAgICAgICBxcnkuZ2V0U2luZ2xlUmVz\ndWx0KCk7CiAgICAgICAgICAgIGZhaWwoIlVzYWdlIG9mIHRoaXMgcXVlcnkg\nc2hvdWxkIGhhdmUgdGhyb3duIGFuIGV4Y2VwdGlvbiIpOwogICAgICAgIH0K\nICAgICAgICBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgYXNz\nZXJ0RXhjZXB0aW9uTWVzc2FnZShlLCBBcmd1bWVudEV4Y2VwdGlvbi5jbGFz\ncywKICAgICAgICAgICAgICAgICAgICAiTm8gZmllbGQgbmFtZWQgXCJjcnRE\nYXRlXCIgaW4gXCJQcm9wZXJ0eVN1YjJcIiIsCiAgICAgICAgICAgICAgICAg\nICAgIltjcmVhdGVEYXRlLCBpZCwgbmFtZV0iKTsKICAgICAgICB9CgogICAg\nICAgIGVtLmNsb3NlKCk7ICAgICAgICAKICAgIH0KCiAgICAvKioKICAgICAq\nIFZhbGlkYXRlcyB0aGF0IGFuIG1hcHBlZCBzdXBlcmNsYXNzIHVzaW5nIGZp\nZWxkIGFjY2VzcyBhbmQgYW4gCiAgICAgKiBlbnRpdHkgc3ViY2xhc3MgdXNp\nbmcgcHJvcGVydHkgYWNjZXNzIGdldCBtYXBwZWQgcHJvcGVybHkuCiAgICAg\nKiBUaGUgc3ViY2xhc3MgdXNlcyBhIHN0b3JhZ2UgZmllbGQgaW4gdGhlIHN1\ncGVyY2xhc3MuIAogICAgICovCiAgICBwdWJsaWMgdm9pZCB0ZXN0TWFwcGVk\nU3VwZXJQcm9wZXJ0eSgpIHsKICAgICAgICBPcGVuSlBBRW50aXR5TWFuYWdl\nclNQSSBlbSA9IGVtZi5jcmVhdGVFbnRpdHlNYW5hZ2VyKCk7CiAgICAgICAg\nCiAgICAgICAgRmllbGRTdWIyIGZzID0gbmV3IEZpZWxkU3ViMigpOwogICAg\nICAgIC8vIENhbGwgc3VwZXIgc2V0dGVyIHdpdGggdW5kZXJseWluZyBmaWVs\nZCBhY2Nlc3MKICAgICAgICBmcy5zZXROYW1lKCJNYXBwZWRTdXBlck5hbWUi\nKTsKICAgICAgICAvLyBDYWxsIGJhc2Ugc2V0dGVyIHdpdGggcHJvcGVydHkg\nYWNjZXNzCiAgICAgICAgRGF0ZSBub3cgPSBuZXcgRGF0ZSgpOwogICAgICAg\nIGZzLnNldENyZWF0ZURhdGUobm93KTsKICAgICAgICAKICAgICAgICBlbS5n\nZXRUcmFuc2FjdGlvbigpLmJlZ2luKCk7CiAgICAgICAgZW0ucGVyc2lzdChm\ncyk7CiAgICAgICAgZW0uZ2V0VHJhbnNhY3Rpb24oKS5jb21taXQoKTsKICAg\nICAgICBlbS5jbGVhcigpOwogICAgICAgIAogICAgICAgIC8vIFRoaXMgdmFs\ndWUgb2YgYSBwZXJzaXN0ZW50IGZpZWxkIHdhcyBzZXQgdXNpbmcgdGhlIHNl\ndHRlcgogICAgICAgIC8vIGFib3ZlLCBidXQgdGhpcyBxdWVyeSB3aWxsIHVz\nZSB0aGUgcHJvcGVydHkgbmFtZSB0byB2ZXJpZnkgdGhhdAogICAgICAgIC8v\nIHByb3BldHkgYWNjZXNzIGlzIGluIHVzZS4KICAgICAgICBRdWVyeSBxcnkg\nPSBlbS5jcmVhdGVOYW1lZFF1ZXJ5KCJGaWVsZFN1YjIucXVlcnkiKTsKICAg\nICAgICBxcnkuc2V0UGFyYW1ldGVyKCJpZCIsIGZzLmdldElkKCkpOwogICAg\nICAgIHFyeS5zZXRQYXJhbWV0ZXIoIm5hbWUiLCAiTWFwcGVkU3VwZXJOYW1l\nIik7CiAgICAgICAgcXJ5LnNldFBhcmFtZXRlcigiY3J0RGF0ZSIsIG5vdyk7\nCiAgICAgICAgRmllbGRTdWIyIGZzMiA9IAogICAgICAgICAgICAoRmllbGRT\ndWIyKXFyeS5nZXRTaW5nbGVSZXN1bHQoKTsKICAgICAgICBhc3NlcnRFcXVh\nbHMoZnMsIGZzMik7CiAgICAgICAgYXNzZXJ0RXF1YWxzKGZzMi5nZXROYW1l\nKCksICJNYXBwZWRTdXBlck5hbWUiKTsKICAgICAgICBhc3NlcnRFcXVhbHMo\nZnMyLmdldENyZWF0ZURhdGUoKS50b1N0cmluZygpLCBub3cudG9TdHJpbmco\nKSk7CgogICAgICAgIHRyeSB7CiAgICAgICAgICAgIHFyeSA9IGVtLmNyZWF0\nZU5hbWVkUXVlcnkoIkZpZWxkU3ViMi5iYWRRdWVyeSIpOwogICAgICAgICAg\nICBxcnkuc2V0UGFyYW1ldGVyKCJpZCIsIGZzLmdldElkKCkpOwogICAgICAg\nICAgICBxcnkuc2V0UGFyYW1ldGVyKCJuYW1lIiwgIk1hcHBlZFN1cGVyTmFt\nZSIpOwogICAgICAgICAgICBxcnkuc2V0UGFyYW1ldGVyKCJjcnREYXRlIiwg\nbm93KTsKICAgICAgICAgICAgcXJ5LmdldFNpbmdsZVJlc3VsdCgpOwogICAg\nICAgICAgICBmYWlsKCJVc2FnZSBvZiB0aGlzIHF1ZXJ5IHNob3VsZCBoYXZl\nIHRocm93biBhbiBleGNlcHRpb24iKTsKICAgICAgICB9CiAgICAgICAgY2F0\nY2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgIGFzc2VydEV4Y2VwdGlv\nbk1lc3NhZ2UoZSwgQXJndW1lbnRFeGNlcHRpb24uY2xhc3MsCiAgICAgICAg\nICAgICAgICAgICAgIk5vIGZpZWxkIG5hbWVkIFwiY3JlYXRlRGF0ZVwiIGlu\nIFwiRmllbGRTdWIyXCIiLAogICAgICAgICAgICAgICAgICAgICJbY3J0RGF0\nZSwgaWQsIG5hbWVdIik7CiAgICAgICAgfQoKICAgICAgICBlbS5jbG9zZSgp\nOyAgICAgICAgCiAgICB9CgogICAgLyoqCiAgICAgKiBWYWxpZGF0ZXMgdGhh\ndCBhIG1peCBvZiBhY2Nlc3MgdHlwZXMgY2FuIGJlIHVzZWQgd2l0aGluIG11\nbHRpcGxlIAogICAgICogcGVyc2lzdGVudCBjbGFzc2VzIHdpdGhpbiBhbiBp\nbmhlcml0YW5jZSBoaWVyYXJjaHkgdGhhdCB1c2VzIAogICAgICogTWFwcGVk\nU3VwZXJjbGFzcy4KICAgICAqLwogICAgcHVibGljIHZvaWQgdGVzdE1peGVk\nTWFwcGVkU3VwZXIoKSB7CiAgICAgICAgT3BlbkpQQUVudGl0eU1hbmFnZXJT\nUEkgZW0gPSBlbWYuY3JlYXRlRW50aXR5TWFuYWdlcigpOwogICAgICAgIAog\nICAgICAgIE1peGVkRmllbGRTdWIgZnMgPSBuZXcgTWl4ZWRGaWVsZFN1Yigp\nOwogICAgICAgIC8vIENhbGwgc3VwZXIgc2V0dGVyIHdpdGggdW5kZXJseWlu\nZyBmaWVsZCBhY2Nlc3MKICAgICAgICBmcy5zZXROYW1lKCJNaXhlZE1hcHBl\nZFN1cGVyTmFtZSIpOwogICAgICAgIGZzLnNldE15RmllbGRQcm9wKCJNeUZp\nZWxkTmFtZSIpOwogICAgICAgIC8vIENhbGwgYmFzZSBzZXR0ZXIgd2l0aCBw\ncm9wZXJ0eSBhY2Nlc3MKICAgICAgICBEYXRlIG5vdyA9IG5ldyBEYXRlKCk7\nCiAgICAgICAgZnMuc2V0Q3JlYXRlRGF0ZShub3cpOwogICAgICAgIAogICAg\nICAgIGVtLmdldFRyYW5zYWN0aW9uKCkuYmVnaW4oKTsKICAgICAgICBlbS5w\nZXJzaXN0KGZzKTsKICAgICAgICBlbS5nZXRUcmFuc2FjdGlvbigpLmNvbW1p\ndCgpOwogICAgICAgIGVtLmNsZWFyKCk7CiAgICAgICAgCiAgICAgICAgLy8g\nVGhpcyB2YWx1ZSBvZiBhIHBlcnNpc3RlbnQgZmllbGQgd2FzIHNldCB1c2lu\nZyB0aGUgc2V0dGVyCiAgICAgICAgLy8gYWJvdmUsIGJ1dCB0aGlzIHF1ZXJ5\nIHdpbGwgdXNlIHRoZSBwcm9wZXJ0eSBuYW1lIHRvIHZlcmlmeSB0aGF0CiAg\nICAgICAgLy8gcHJvcGV0eSBhY2Nlc3MgaXMgaW4gdXNlLgogICAgICAgIFF1\nZXJ5IHFyeSA9IGVtLmNyZWF0ZU5hbWVkUXVlcnkoIk1peGVkRmllbGRTdWIu\ncXVlcnkiKTsKICAgICAgICBxcnkuc2V0UGFyYW1ldGVyKCJpZCIsIGZzLmdl\ndElkKCkpOwogICAgICAgIHFyeS5zZXRQYXJhbWV0ZXIoIm5hbWUiLCAiTWl4\nZWRNYXBwZWRTdXBlck5hbWUiKTsKICAgICAgICBxcnkuc2V0UGFyYW1ldGVy\nKCJjcnREYXRlIiwgbm93KTsKICAgICAgICBxcnkuc2V0UGFyYW1ldGVyKCJt\neUZpZWxkIiwgIk15RmllbGROYW1lIik7CiAgICAgICAgTWl4ZWRGaWVsZFN1\nYiBmczIgPSAKICAgICAgICAgICAgKE1peGVkRmllbGRTdWIpcXJ5LmdldFNp\nbmdsZVJlc3VsdCgpOwogICAgICAgIGFzc2VydEVxdWFscyhmcywgZnMyKTsK\nICAgICAgICBhc3NlcnRFcXVhbHMoZnMyLmdldE5hbWUoKSwgIk1peGVkTWFw\ncGVkU3VwZXJOYW1lIik7CiAgICAgICAgYXNzZXJ0RXF1YWxzKGZzMi5nZXRD\ncmVhdGVEYXRlKCkudG9TdHJpbmcoKSwgbm93LnRvU3RyaW5nKCkpOwoKICAg\nICAgICB0cnkgewogICAgICAgICAgICBxcnkgPSBlbS5jcmVhdGVOYW1lZFF1\nZXJ5KCJNaXhlZEZpZWxkU3ViLmJhZFF1ZXJ5Iik7CiAgICAgICAgICAgIHFy\neS5zZXRQYXJhbWV0ZXIoImlkIiwgZnMuZ2V0SWQoKSk7CiAgICAgICAgICAg\nIHFyeS5zZXRQYXJhbWV0ZXIoIm5hbWUiLCAiTWl4ZWRNYXBwZWRTdXBlck5h\nbWUiKTsKICAgICAgICAgICAgcXJ5LnNldFBhcmFtZXRlcigibXlGaWVsZCIs\nICJNeUZpZWxkTmFtZSIpOwogICAgICAgICAgICBxcnkuZ2V0U2luZ2xlUmVz\ndWx0KCk7CiAgICAgICAgICAgIGZhaWwoIlVzYWdlIG9mIHRoaXMgcXVlcnkg\nc2hvdWxkIGhhdmUgdGhyb3duIGFuIGV4Y2VwdGlvbiIpOwogICAgICAgIH0K\nICAgICAgICBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgYXNz\nZXJ0RXhjZXB0aW9uTWVzc2FnZShlLCBBcmd1bWVudEV4Y2VwdGlvbi5jbGFz\ncywKICAgICAgICAgICAgICAgICAgICAiTm8gZmllbGQgbmFtZWQgXCJteUZp\nZWxkUHJvcFwiIGluIFwiTWl4ZWRGaWVsZFN1YlwiIiwKICAgICAgICAgICAg\nICAgICAgICAiW2NyZWF0ZURhdGUsIG1pZCwgbXlGaWVsZCwgbmFtZV0iKTsK\nICAgICAgICB9CgogICAgICAgIGVtLmNsb3NlKCk7ICAgICAgICAKICAgICAg\nICAKICAgIH0KICAgIAogICAgLyoqCiAgICAgKiBWYWxpZGF0ZXMgdGhhdCBh\nIG1peCBvZiBhY2Nlc3MgdHlwZXMgY2FuIGJlIHVzZWQgd2l0aGluCiAgICAg\nKiBhbiBpbmhlcml0YW5jZSBoaWVyYXJjaHkgd2hpY2ggdXNlcyBkZWZhdWx0\nIEVudGl0eSBpbmhlcml0YW5jZS4KICAgICAqIE5PVEU6IGJlIHN1cmUgdG8g\ndGVzdCB3aXRoIGFsbCBmb3JtcyBvZiBpbmhlcml0YW5jZS4KICAgICAqLwog\nICAgcHVibGljIHZvaWQgdGVzdEVudGl0eUZpZWxkRGVmYXVsdEluaGVyaXRh\nbmNlKCkgewogICAgICAgIE9wZW5KUEFFbnRpdHlNYW5hZ2VyU1BJIGVtID0g\nZW1mLmNyZWF0ZUVudGl0eU1hbmFnZXIoKTsKICAgICAgICAKICAgICAgICBG\naWVsZFN1YjMgZnMgPSBuZXcgRmllbGRTdWIzKCk7CiAgICAgICAgLy8gQ2Fs\nbCBzdXBlciBzZXR0ZXIgd2l0aCB1bmRlcmx5aW5nIGZpZWxkIGFjY2Vzcwog\nICAgICAgIGZzLnNldE5hbWUoIkVudGl0eVN1cGVyTmFtZSIpOwogICAgICAg\nIC8vIENhbGwgYmFzZSBzZXR0ZXIgd2l0aCBwcm9wZXJ0eSBhY2Nlc3MKICAg\nICAgICBEYXRlIG5vdyA9IG5ldyBEYXRlKCk7CiAgICAgICAgZnMuc2V0Q3Jl\nYXRlRGF0ZShub3cpOwoKICAgICAgICBTdXBlclByb3BlcnR5RW50aXR5IHNw\nZSA9IG5ldyBTdXBlclByb3BlcnR5RW50aXR5KCk7CiAgICAgICAgc3BlLnNl\ndE5hbWUoIlN1cGVyUHJvcGVydHlFbnRpdHkiKTsKICAgICAgICAKICAgICAg\nICBlbS5nZXRUcmFuc2FjdGlvbigpLmJlZ2luKCk7CiAgICAgICAgZW0ucGVy\nc2lzdChmcyk7CiAgICAgICAgZW0ucGVyc2lzdChzcGUpOwogICAgICAgIGVt\nLmdldFRyYW5zYWN0aW9uKCkuY29tbWl0KCk7CiAgICAgICAgZW0uY2xlYXIo\nKTsKICAgICAgICAKICAgICAgICAvLyBUaGlzIHZhbHVlIG9mIGEgcGVyc2lz\ndGVudCBmaWVsZCB3YXMgc2V0IHVzaW5nIHRoZSBzZXR0ZXIKICAgICAgICAv\nLyBhYm92ZSwgYnV0IHRoaXMgcXVlcnkgd2lsbCB1c2UgdGhlIHByb3BlcnR5\nIG5hbWUgdG8gdmVyaWZ5IHRoYXQKICAgICAgICAvLyBwcm9wZXR5IGFjY2Vz\ncyBpcyBpbiB1c2UuCiAgICAgICAgUXVlcnkgcXJ5ID0gZW0uY3JlYXRlTmFt\nZWRRdWVyeSgiRmllbGRTdWIzLnF1ZXJ5Iik7CiAgICAgICAgcXJ5LnNldFBh\ncmFtZXRlcigiaWQiLCBmcy5nZXRJZCgpKTsKICAgICAgICBxcnkuc2V0UGFy\nYW1ldGVyKCJuYW1lIiwgIkVudGl0eVN1cGVyTmFtZSIpOwogICAgICAgIHFy\neS5zZXRQYXJhbWV0ZXIoImNydERhdGUiLCBub3cpOwogICAgICAgIEZpZWxk\nU3ViMyBmczIgPSAKICAgICAgICAgICAgKEZpZWxkU3ViMylxcnkuZ2V0U2lu\nZ2xlUmVzdWx0KCk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKGZzLCBmczIpOwog\nICAgICAgIGFzc2VydEVxdWFscyhmczIuZ2V0TmFtZSgpLCAiRW50aXR5U3Vw\nZXJOYW1lIik7CiAgICAgICAgYXNzZXJ0RXF1YWxzKGZzMi5nZXRDcmVhdGVE\nYXRlKCkudG9TdHJpbmcoKSwgbm93LnRvU3RyaW5nKCkpOwoKICAgICAgICB0\ncnkgewogICAgICAgICAgICBxcnkgPSBlbS5jcmVhdGVOYW1lZFF1ZXJ5KCJG\naWVsZFN1YjMuYmFkUXVlcnkiKTsKICAgICAgICAgICAgcXJ5LnNldFBhcmFt\nZXRlcigiaWQiLCBmcy5nZXRJZCgpKTsKICAgICAgICAgICAgcXJ5LnNldFBh\ncmFtZXRlcigibmFtZSIsICJFbnRpdHlTdXBlck5hbWUiKTsKICAgICAgICAg\nICAgcXJ5LnNldFBhcmFtZXRlcigiY3J0RGF0ZSIsIG5vdyk7CiAgICAgICAg\nICAgIHFyeS5nZXRTaW5nbGVSZXN1bHQoKTsKICAgICAgICAgICAgZmFpbCgi\nVXNhZ2Ugb2YgdGhpcyBxdWVyeSBzaG91bGQgaGF2ZSB0aHJvd24gYW4gZXhj\nZXB0aW9uIik7CiAgICAgICAgfQogICAgICAgIGNhdGNoIChFeGNlcHRpb24g\nZSkgewogICAgICAgICAgICBhc3NlcnRFeGNlcHRpb25NZXNzYWdlKGUsIEFy\nZ3VtZW50RXhjZXB0aW9uLmNsYXNzLAogICAgICAgICAgICAgICAgICAgICJO\nbyBmaWVsZCBuYW1lZCBcImNyZWF0ZURhdGVcIiBpbiBcIkZpZWxkU3ViM1wi\nIiwKICAgICAgICAgICAgICAgICAgICAiW2NydERhdGUsIGlkLCBuYW1lXSIp\nOwogICAgICAgIH0KCiAgICAgICAgcXJ5ID0gZW0uY3JlYXRlTmFtZWRRdWVy\neSgiU3VwZXJQcm9wZXJ0eUVudGl0eS5xdWVyeSIpOwogICAgICAgIHFyeS5z\nZXRQYXJhbWV0ZXIoImlkIiwgc3BlLmdldElkKCkpOwogICAgICAgIHFyeS5z\nZXRQYXJhbWV0ZXIoIm5hbWUiLCAiU3VwZXJQcm9wZXJ0eUVudGl0eSIpOwog\nICAgICAgIFN1cGVyUHJvcGVydHlFbnRpdHkgc3BlMiA9IAogICAgICAgICAg\nICAoU3VwZXJQcm9wZXJ0eUVudGl0eSlxcnkuZ2V0U2luZ2xlUmVzdWx0KCk7\nCiAgICAgICAgYXNzZXJ0RXF1YWxzKHNwZSwgc3BlMik7CiAgICAgICAgYXNz\nZXJ0RXF1YWxzKHNwZTIuZ2V0TmFtZSgpLCAiU3VwZXJQcm9wZXJ0eUVudGl0\neSIpOwoKICAgICAgICB0cnkgewogICAgICAgICAgICAvLyBUaGlzIHF1ZXJ5\nIGVuc3VyZXMgdGhhdCBhIHN1YmNsYXNzIHByb3BlcnR5IGRpZG4ndCBzb21l\naG93IGdldAogICAgICAgICAgICAvLyBwaWNrZWQgdXAgYnkgdGhlIHN1cGVy\nY2xhc3Mgd2hpbGUgYnVpbGRpbmcgZmllbGQgbWV0YWRhdGEgdXNpbmcKICAg\nICAgICAgICAgLy8gZXhwbGljaXQgYWNjZXNzLgogICAgICAgICAgICBxcnkg\nPSBlbS5jcmVhdGVOYW1lZFF1ZXJ5KCJTdXBlclByb3BlcnR5RW50aXR5LmJh\nZFF1ZXJ5Iik7CiAgICAgICAgICAgIHFyeS5zZXRQYXJhbWV0ZXIoImlkIiwg\nc3BlLmdldElkKCkpOwogICAgICAgICAgICBxcnkuc2V0UGFyYW1ldGVyKCJu\nYW1lIiwgIlN1cGVyUHJvcGVydHlFbnRpdHkiKTsKICAgICAgICAgICAgcXJ5\nLnNldFBhcmFtZXRlcigiY3J0RGF0ZSIsIG5vdyk7CiAgICAgICAgICAgIHFy\neS5nZXRTaW5nbGVSZXN1bHQoKTsKICAgICAgICAgICAgZmFpbCgiVXNhZ2Ug\nb2YgdGhpcyBxdWVyeSBzaG91bGQgaGF2ZSB0aHJvd24gYW4gZXhjZXB0aW9u\nIik7CiAgICAgICAgfQogICAgICAgIGNhdGNoIChFeGNlcHRpb24gZSkgewog\nICAgICAgICAgICBhc3NlcnRFeGNlcHRpb25NZXNzYWdlKGUsIEFyZ3VtZW50\nRXhjZXB0aW9uLmNsYXNzLAogICAgICAgICAgICAgICAgICAgICJObyBmaWVs\nZCBuYW1lZCBcImNydERhdGVcIiBpbiBcIlN1cGVyUHJvcGVydHlFbnRpdHlc\nIiIsCiAgICAgICAgICAgICAgICAgICAgIltpZCwgbmFtZV0iKTsKICAgICAg\nICB9ICAgICAgICAKICAgICAgICAKICAgICAgICBlbS5jbG9zZSgpOyAgICAg\nICAgCiAgICB9CgogICAgLyoqCiAgICAgKiBWYWxpZGF0ZXMgdGhhdCBhIG1p\neCBvZiBhY2Nlc3MgdHlwZXMgY2FuIGJlIHVzZWQgd2l0aGluCiAgICAgKiBh\nbiBpbmhlcml0YW5jZSBoaWVyYXJjaHkgd2hpY2ggdXNlcyBkZWZhdWx0IEVu\ndGl0eSBpbmhlcml0YW5jZS4KICAgICAqIE5PVEU6IGJlIHN1cmUgdG8gdGVz\ndCB3aXRoIGFsbCBmb3JtcyBvZiBpbmhlcml0YW5jZS4KICAgICAqLwogICAg\ncHVibGljIHZvaWQgdGVzdEVudGl0eVByb3BlcnR5RGVmYXVsdEluaGVyaXRh\nbmNlKCkgewogICAgICAgIE9wZW5KUEFFbnRpdHlNYW5hZ2VyU1BJIGVtID0g\nZW1mLmNyZWF0ZUVudGl0eU1hbmFnZXIoKTsKICAgICAgICAKICAgICAgICBQ\ncm9wZXJ0eVN1YjMgcHMgPSBuZXcgUHJvcGVydHlTdWIzKCk7CiAgICAgICAg\nLy8gQ2FsbCBzdXBlciBzZXR0ZXIgd2l0aCB1bmRlcmx5aW5nIGZpZWxkIGFj\nY2VzcwogICAgICAgIHBzLnNldE5hbWUoIkVudGl0eVN1cGVyTmFtZSIpOwog\nICAgICAgIC8vIENhbGwgYmFzZSBzZXR0ZXIgd2l0aCBwcm9wZXJ0eSBhY2Nl\nc3MKICAgICAgICBEYXRlIG5vdyA9IG5ldyBEYXRlKCk7CiAgICAgICAgcHMu\nc2V0Q3JlYXRlRGF0ZShub3cpOwoKICAgICAgICBTdXBlckZpZWxkRW50aXR5\nIHNmZSA9IG5ldyBTdXBlckZpZWxkRW50aXR5KCk7CiAgICAgICAgc2ZlLnNl\ndE5hbWUoIlN1cGVyRmllbGRFbnRpdHkiKTsKICAgICAgICAKICAgICAgICBl\nbS5nZXRUcmFuc2FjdGlvbigpLmJlZ2luKCk7CiAgICAgICAgZW0ucGVyc2lz\ndChwcyk7CiAgICAgICAgZW0ucGVyc2lzdChzZmUpOwogICAgICAgIGVtLmdl\ndFRyYW5zYWN0aW9uKCkuY29tbWl0KCk7CiAgICAgICAgZW0uY2xlYXIoKTsK\nICAgICAgICAKICAgICAgICAvLyBUaGlzIHZhbHVlIG9mIGEgcGVyc2lzdGVu\ndCBmaWVsZCB3YXMgc2V0IHVzaW5nIHRoZSBzZXR0ZXIKICAgICAgICAvLyBh\nYm92ZSwgYnV0IHRoaXMgcXVlcnkgd2lsbCB1c2UgdGhlIHByb3BlcnR5IG5h\nbWUgdG8gdmVyaWZ5IHRoYXQKICAgICAgICAvLyBwcm9wZXR5IGFjY2VzcyBp\ncyBpbiB1c2UuCiAgICAgICAgUXVlcnkgcXJ5ID0gZW0uY3JlYXRlTmFtZWRR\ndWVyeSgiUHJvcGVydHlTdWIzLnF1ZXJ5Iik7CiAgICAgICAgcXJ5LnNldFBh\ncmFtZXRlcigiaWQiLCBwcy5nZXRJZCgpKTsKICAgICAgICBxcnkuc2V0UGFy\nYW1ldGVyKCJuYW1lIiwgIkVudGl0eVN1cGVyTmFtZSIpOwogICAgICAgIHFy\neS5zZXRQYXJhbWV0ZXIoImNydERhdGUiLCBub3cpOwogICAgICAgIFByb3Bl\ncnR5U3ViMyBwczIgPSAKICAgICAgICAgICAgKFByb3BlcnR5U3ViMylxcnku\nZ2V0U2luZ2xlUmVzdWx0KCk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKHBzLCBw\nczIpOwogICAgICAgIGFzc2VydEVxdWFscyhwczIuZ2V0TmFtZSgpLCAiRW50\naXR5U3VwZXJOYW1lIik7CiAgICAgICAgYXNzZXJ0RXF1YWxzKHBzMi5nZXRD\ncmVhdGVEYXRlKCkudG9TdHJpbmcoKSwgbm93LnRvU3RyaW5nKCkpOwoKICAg\nICAgICB0cnkgewogICAgICAgICAgICBxcnkgPSBlbS5jcmVhdGVOYW1lZFF1\nZXJ5KCJQcm9wZXJ0eVN1YjMuYmFkUXVlcnkiKTsKICAgICAgICAgICAgcXJ5\nLnNldFBhcmFtZXRlcigiaWQiLCBwcy5nZXRJZCgpKTsKICAgICAgICAgICAg\ncXJ5LnNldFBhcmFtZXRlcigibmFtZSIsICJFbnRpdHlTdXBlck5hbWUiKTsK\nICAgICAgICAgICAgcXJ5LnNldFBhcmFtZXRlcigiY3J0RGF0ZSIsIG5vdyk7\nCiAgICAgICAgICAgIHFyeS5nZXRTaW5nbGVSZXN1bHQoKTsKICAgICAgICAg\nICAgZmFpbCgiVXNhZ2Ugb2YgdGhpcyBxdWVyeSBzaG91bGQgaGF2ZSB0aHJv\nd24gYW4gZXhjZXB0aW9uIik7CiAgICAgICAgfQogICAgICAgIGNhdGNoIChF\neGNlcHRpb24gZSkgewogICAgICAgICAgICBhc3NlcnRFeGNlcHRpb25NZXNz\nYWdlKGUsIEFyZ3VtZW50RXhjZXB0aW9uLmNsYXNzLAogICAgICAgICAgICAg\nICAgICAgICJObyBmaWVsZCBuYW1lZCBcImNydERhdGVcIiBpbiBcIlByb3Bl\ncnR5U3ViM1wiIiwKICAgICAgICAgICAgICAgICAgICAiW2NyZWF0ZURhdGUs\nIGlkLCBuYW1lXSIpOwogICAgICAgIH0KCiAgICAgICAgcXJ5ID0gZW0uY3Jl\nYXRlTmFtZWRRdWVyeSgiU3VwZXJGaWVsZEVudGl0eS5xdWVyeSIpOwogICAg\nICAgIHFyeS5zZXRQYXJhbWV0ZXIoImlkIiwgc2ZlLmdldElkKCkpOwogICAg\nICAgIHFyeS5zZXRQYXJhbWV0ZXIoIm5hbWUiLCAiU3VwZXJGaWVsZEVudGl0\neSIpOwogICAgICAgIFN1cGVyRmllbGRFbnRpdHkgc2ZlMiA9IAogICAgICAg\nICAgICAoU3VwZXJGaWVsZEVudGl0eSlxcnkuZ2V0U2luZ2xlUmVzdWx0KCk7\nCiAgICAgICAgYXNzZXJ0RXF1YWxzKHNmZTIsIHNmZTIpOwogICAgICAgIGFz\nc2VydEVxdWFscyhzZmUyLmdldE5hbWUoKSwgIlN1cGVyRmllbGRFbnRpdHki\nKTsKCiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgLy8gVGhpcyBxdWVyeSBl\nbnN1cmVzIHRoYXQgYSBzdWJjbGFzcyBwcm9wZXJ0eSBkaWRuJ3Qgc29tZWhv\ndyBnZXQKICAgICAgICAgICAgLy8gcGlja2VkIHVwIGJ5IHRoZSBzdXBlcmNs\nYXNzIHdoaWxlIGJ1aWxkaW5nIGZpZWxkIG1ldGFkYXRhIHVzaW5nCiAgICAg\nICAgICAgIC8vIGV4cGxpY2l0IGFjY2Vzcy4KICAgICAgICAgICAgcXJ5ID0g\nZW0uY3JlYXRlTmFtZWRRdWVyeSgiU3VwZXJGaWVsZEVudGl0eS5iYWRRdWVy\neSIpOwogICAgICAgICAgICBxcnkuc2V0UGFyYW1ldGVyKCJpZCIsIHNmZS5n\nZXRJZCgpKTsKICAgICAgICAgICAgcXJ5LnNldFBhcmFtZXRlcigibmFtZSIs\nICJTdXBlckZpZWxkRW50aXR5Iik7CiAgICAgICAgICAgIHFyeS5zZXRQYXJh\nbWV0ZXIoImNydERhdGUiLCBub3cpOwogICAgICAgICAgICBxcnkuZ2V0U2lu\nZ2xlUmVzdWx0KCk7CiAgICAgICAgICAgIGZhaWwoIlVzYWdlIG9mIHRoaXMg\ncXVlcnkgc2hvdWxkIGhhdmUgdGhyb3duIGFuIGV4Y2VwdGlvbiIpOwogICAg\nICAgIH0KICAgICAgICBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICAg\nICAgYXNzZXJ0RXhjZXB0aW9uTWVzc2FnZShlLCBBcmd1bWVudEV4Y2VwdGlv\nbi5jbGFzcywKICAgICAgICAgICAgICAgICAgICAiTm8gZmllbGQgbmFtZWQg\nXCJjcnREYXRlXCIgaW4gXCJTdXBlckZpZWxkRW50aXR5XCIiLAogICAgICAg\nICAgICAgICAgICAgICJbaWQsIG5hbWVdIik7CiAgICAgICAgfSAgICAgICAg\nCiAgICAgICAgZW0uY2xvc2UoKTsgICAgICAgIAogICAgfQoKICAgIC8qKgog\nICAgICogVmFsaWRhdGVzIGFuIGVtYmVkZGFibGUgd2l0aCBmaWVsZCBhY2Nl\nc3MgY2FuIGJlIHVzZWQgd2l0aGluIGFuCiAgICAgKiBlbnRpdHkgd2l0aCBw\ncm9wZXJ0eSBhY2Nlc3MKICAgICAqLwogICAgcHVibGljIHZvaWQgdGVzdEVt\nYmVkZGFibGVzRmllbGQoKSB7CiAgICAgICAgT3BlbkpQQUVudGl0eU1hbmFn\nZXJTUEkgZW0gPSBlbWYuY3JlYXRlRW50aXR5TWFuYWdlcigpOwogICAgICAg\nIAogICAgICAgIEVtYmVkRmllbGRBY2Nlc3MgZWZhID0gbmV3IEVtYmVkRmll\nbGRBY2Nlc3MoKTsKICAgICAgICBlZmEuc2V0Rmlyc3ROYW1lKCJKIik7CiAg\nICAgICAgZWZhLnNldExhc3ROYW1lKCJUb2xraWVuIik7CiAgICAgICAgCiAg\nICAgICAgUHJvcEVtYmVkRW50aXR5IHBlID0gbmV3IFByb3BFbWJlZEVudGl0\neSgpOwogICAgICAgIHBlLnNldE5hbWUoIlByb3BFbWJlZEVudGl0eSIpOwog\nICAgICAgIHBlLnNldEVtYmVkUHJvcChlZmEpOwogICAgICAgIAogICAgICAg\nIGVtLmdldFRyYW5zYWN0aW9uKCkuYmVnaW4oKTsKICAgICAgICBlbS5wZXJz\naXN0KHBlKTsKICAgICAgICBlbS5nZXRUcmFuc2FjdGlvbigpLmNvbW1pdCgp\nOwogICAgICAgIAogICAgICAgIGVtLmNsZWFyKCk7CiAgICAgICAgCiAgICAg\nICAgUXVlcnkgcXJ5ID0gZW0uY3JlYXRlTmFtZWRRdWVyeSgiUHJvcEVtYmVk\nRW50aXR5LnF1ZXJ5Iik7CiAgICAgICAgcXJ5LnNldFBhcmFtZXRlcigiaWQi\nLCBwZS5nZXRJZCgpKTsKICAgICAgICBxcnkuc2V0UGFyYW1ldGVyKCJuYW1l\nIiwgIlByb3BFbWJlZEVudGl0eSIpOwogICAgICAgIHFyeS5zZXRQYXJhbWV0\nZXIoImZpcnN0TmFtZSIsICJKIik7CiAgICAgICAgcXJ5LnNldFBhcmFtZXRl\ncigibGFzdE5hbWUiLCAiVG9sa2llbiIpOwogICAgICAgIFByb3BFbWJlZEVu\ndGl0eSBwZTIgPSAoUHJvcEVtYmVkRW50aXR5KXFyeS5nZXRTaW5nbGVSZXN1\nbHQoKTsKICAgICAgICBhc3NlcnRFcXVhbHMocGUsIHBlMik7CiAgICAgICAg\nYXNzZXJ0RXF1YWxzKGVmYSwgcGUyLmdldEVtYmVkUHJvcCgpKTsKCiAgICAg\nICAgdHJ5IHsKICAgICAgICAgICAgcXJ5ID0gZW0uY3JlYXRlTmFtZWRRdWVy\neSgiUHJvcEVtYmVkRW50aXR5LmJhZFF1ZXJ5Iik7CiAgICAgICAgICAgIHFy\neS5zZXRQYXJhbWV0ZXIoImlkIiwgcGUuZ2V0SWQoKSk7CiAgICAgICAgICAg\nIHFyeS5zZXRQYXJhbWV0ZXIoIm5hbWUiLCAiUHJvcEVtYmVkRW50aXR5Iik7\nCiAgICAgICAgICAgIHFyeS5zZXRQYXJhbWV0ZXIoImZpcnN0TmFtZSIsICJK\nIik7CiAgICAgICAgICAgIHFyeS5zZXRQYXJhbWV0ZXIoImxhc3ROYW1lIiwg\nIlRvbGtpZW4iKTsKICAgICAgICAgICAgcXJ5LmdldFNpbmdsZVJlc3VsdCgp\nOwogICAgICAgICAgICBmYWlsKCJRdWVyeSBleGVjdXRpb24gc2hvdWxkIGhh\ndmUgZmFpbGVkLiIpOwogICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7\nCiAgICAgICAgICAgIGFzc2VydEV4Y2VwdGlvbk1lc3NhZ2UoZSwgQXJndW1l\nbnRFeGNlcHRpb24uY2xhc3MsCiAgICAgICAgICAgICAgICAgICAgIk5vIGZp\nZWxkIG5hbWVkIFwiZmlyc3ROYW1lXCIgaW4gXCJFbWJlZEZpZWxkQWNjZXNz\nXCIiLAogICAgICAgICAgICAgICAgICAgICJbZk5hbWUsIGxOYW1lXSIpOwog\nICAgICAgIH0KCiAgICAgICAgZW0uY2xvc2UoKTsKICAgIH0KCiAgICAvKioK\nICAgICAqIFZhbGlkYXRlcyBhbiBlbWJlZGRhYmxlIHdpdGggcHJvcGVydHkg\nYWNjZXNzIGNhbiBiZSB1c2VkIHdpdGhpbiBhbgogICAgICogZW50aXR5IHdp\ndGggZmllbGQgYWNjZXNzCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHRlc3RF\nbWJlZGRhYmxlc1Byb3BlcnR5KCkgewogICAgICAgIE9wZW5KUEFFbnRpdHlN\nYW5hZ2VyU1BJIGVtID0gZW1mLmNyZWF0ZUVudGl0eU1hbmFnZXIoKTsKICAg\nICAgICAKICAgICAgICBFbWJlZFByb3BBY2Nlc3MgZXBhID0gbmV3IEVtYmVk\nUHJvcEFjY2VzcygpOwogICAgICAgIGVwYS5zZXRGaXJzdE5hbWUoIldhbHQi\nKTsKICAgICAgICBlcGEuc2V0TGFzdE5hbWUoIldoaXRtYW4iKTsKICAgICAg\nICAKICAgICAgICBGaWVsZEVtYmVkRW50aXR5IGZlID0gbmV3IEZpZWxkRW1i\nZWRFbnRpdHkoKTsKICAgICAgICBmZS5zZXROYW1lKCJGaWVsZEVtYmVkRW50\naXR5Iik7CiAgICAgICAgZmUuc2V0RVBBKGVwYSk7CiAgICAgICAgCiAgICAg\nICAgZW0uZ2V0VHJhbnNhY3Rpb24oKS5iZWdpbigpOwogICAgICAgIGVtLnBl\ncnNpc3QoZmUpOwogICAgICAgIGVtLmdldFRyYW5zYWN0aW9uKCkuY29tbWl0\nKCk7CiAgICAgICAgCiAgICAgICAgZW0uY2xlYXIoKTsKICAgICAgICAKICAg\nICAgICBRdWVyeSBxcnkgPSBlbS5jcmVhdGVOYW1lZFF1ZXJ5KCJGaWVsZEVt\nYmVkRW50aXR5LnF1ZXJ5Iik7CiAgICAgICAgcXJ5LnNldFBhcmFtZXRlcigi\naWQiLCBmZS5nZXRJZCgpKTsKICAgICAgICBxcnkuc2V0UGFyYW1ldGVyKCJu\nYW1lIiwgIkZpZWxkRW1iZWRFbnRpdHkiKTsKICAgICAgICBxcnkuc2V0UGFy\nYW1ldGVyKCJmaXJzdE5hbWUiLCAiV2FsdCIpOwogICAgICAgIHFyeS5zZXRQ\nYXJhbWV0ZXIoImxhc3ROYW1lIiwgIldoaXRtYW4iKTsKICAgICAgICBGaWVs\nZEVtYmVkRW50aXR5IGZlMiA9IChGaWVsZEVtYmVkRW50aXR5KXFyeS5nZXRT\naW5nbGVSZXN1bHQoKTsKICAgICAgICBhc3NlcnRFcXVhbHMoZmUsIGZlMik7\nCiAgICAgICAgYXNzZXJ0RXF1YWxzKGVwYSwgZmUyLmdldEVQQSgpKTsKCiAg\nICAgICAgdHJ5IHsKICAgICAgICAgICAgcXJ5ID0gZW0uY3JlYXRlTmFtZWRR\ndWVyeSgiRmllbGRFbWJlZEVudGl0eS5iYWRRdWVyeSIpOwogICAgICAgICAg\nICBxcnkuc2V0UGFyYW1ldGVyKCJpZCIsIGZlLmdldElkKCkpOwogICAgICAg\nICAgICBxcnkuc2V0UGFyYW1ldGVyKCJuYW1lIiwgIkZpZWxkRW1iZWRFbnRp\ndHkiKTsKICAgICAgICAgICAgcXJ5LnNldFBhcmFtZXRlcigiZmlyc3ROYW1l\nIiwgIldhbHQiKTsKICAgICAgICAgICAgcXJ5LnNldFBhcmFtZXRlcigibGFz\ndE5hbWUiLCAiV2hpdG1hbiIpOwogICAgICAgICAgICBxcnkuZ2V0U2luZ2xl\nUmVzdWx0KCk7CiAgICAgICAgICAgIGZhaWwoIlF1ZXJ5IGV4ZWN1dGlvbiBz\naG91bGQgaGF2ZSBmYWlsZWQuIik7CiAgICAgICAgfSBjYXRjaCAoRXhjZXB0\naW9uIGUpIHsKICAgICAgICAgICAgYXNzZXJ0RXhjZXB0aW9uTWVzc2FnZShl\nLCBBcmd1bWVudEV4Y2VwdGlvbi5jbGFzcywKICAgICAgICAgICAgICAgICAg\nICAiTm8gZmllbGQgbmFtZWQgXCJmTmFtZVwiIGluIFwiRW1iZWRQcm9wQWNj\nZXNzXCIiLAogICAgICAgICAgICAgICAgICAgICJbZmlyc3ROYW1lLCBsYXN0\nTmFtZV0iKTsKICAgICAgICB9CgogICAgICAgIGVtLmNsb3NlKCk7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBWYWxpZGF0ZXMgYW4gZW1iZWRkYWJsZSB3aXRo\nIG1peGVkIGFjY2VzcyBjYW4gYmUgdXNlZCB3aXRoaW4gYW4KICAgICAqIGVu\ndGl0eSB3aXRoIG1peGVkIGFjY2VzcwogICAgICovCiAgICBwdWJsaWMgdm9p\nZCB0ZXN0TWl4ZWRFbWJlZGRhYmxlcygpIHsKICAgICAgICBPcGVuSlBBRW50\naXR5TWFuYWdlclNQSSBlbSA9IGVtZi5jcmVhdGVFbnRpdHlNYW5hZ2VyKCk7\nCiAgICAgICAgCiAgICAgICAgRW1iZWRNaXhlZEFjY2VzcyBlbWEgPSBuZXcg\nRW1iZWRNaXhlZEFjY2VzcygpOwogICAgICAgIGVtYS5zZXRGaXJzdE5hbWUo\nIkoiKTsKICAgICAgICBlbWEuc2V0TGFzdE5hbWUoIlRvbGtpZW4iKTsKICAg\nICAgICBlbWEuc2V0TWlkZGxlTmFtZSgiUiIpOwogICAgICAgIAogICAgICAg\nIFByb3BNaXhlZEVudGl0eSBwbSA9IG5ldyBQcm9wTWl4ZWRFbnRpdHkoKTsK\nICAgICAgICBwbS5zZXROYW1lKCJQcm9wTWl4ZWRFbnRpdHkiKTsKICAgICAg\nICBwbS5zZXRFbWJlZFByb3AoZW1hKTsKICAgICAgICAKICAgICAgICBlbS5n\nZXRUcmFuc2FjdGlvbigpLmJlZ2luKCk7CiAgICAgICAgZW0ucGVyc2lzdChw\nbSk7CiAgICAgICAgZW0uZ2V0VHJhbnNhY3Rpb24oKS5jb21taXQoKTsKICAg\nICAgICAKICAgICAgICBlbS5jbGVhcigpOwogICAgICAgIAogICAgICAgIFF1\nZXJ5IHFyeSA9IGVtLmNyZWF0ZU5hbWVkUXVlcnkoIlByb3BNaXhlZEVudGl0\neS5xdWVyeSIpOwogICAgICAgIHFyeS5zZXRQYXJhbWV0ZXIoImlkIiwgcG0u\nZ2V0SWQoKSk7CiAgICAgICAgcXJ5LnNldFBhcmFtZXRlcigibmFtZSIsICJQ\ncm9wTWl4ZWRFbnRpdHkiKTsKICAgICAgICBxcnkuc2V0UGFyYW1ldGVyKCJm\naXJzdE5hbWUiLCAiSiIpOwogICAgICAgIHFyeS5zZXRQYXJhbWV0ZXIoImxh\nc3ROYW1lIiwgIlRvbGtpZW4iKTsKICAgICAgICBxcnkuc2V0UGFyYW1ldGVy\nKCJtaWRkbGVOYW1lIiwgIlIiKTsKICAgICAgICBQcm9wTWl4ZWRFbnRpdHkg\ncG0yID0gKFByb3BNaXhlZEVudGl0eSlxcnkuZ2V0U2luZ2xlUmVzdWx0KCk7\nCiAgICAgICAgYXNzZXJ0RXF1YWxzKHBtLCBwbTIpOwogICAgICAgIGFzc2Vy\ndEVxdWFscyhlbWEsIHBtMi5nZXRFbWJlZFByb3AoKSk7CgogICAgICAgIHRy\neSB7CiAgICAgICAgICAgIHFyeSA9IGVtLmNyZWF0ZU5hbWVkUXVlcnkoIlBy\nb3BNaXhlZEVudGl0eS5iYWRRdWVyeSIpOwogICAgICAgICAgICBxcnkuc2V0\nUGFyYW1ldGVyKCJpZCIsIHBtLmdldElkKCkpOwogICAgICAgICAgICBxcnku\nc2V0UGFyYW1ldGVyKCJuYW1lIiwgIlByb3BNaXhlZEVudGl0eSIpOwogICAg\nICAgICAgICBxcnkuc2V0UGFyYW1ldGVyKCJmaXJzdE5hbWUiLCAiSiIpOwog\nICAgICAgICAgICBxcnkuc2V0UGFyYW1ldGVyKCJsYXN0TmFtZSIsICJUb2xr\naWVuIik7CiAgICAgICAgICAgIHFyeS5zZXRQYXJhbWV0ZXIoIm1pZGRsZU5h\nbWUiLCAiUiIpOwogICAgICAgICAgICBxcnkuZ2V0U2luZ2xlUmVzdWx0KCk7\nCiAgICAgICAgICAgIGZhaWwoIlF1ZXJ5IGV4ZWN1dGlvbiBzaG91bGQgaGF2\nZSBmYWlsZWQuIik7CiAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsK\nICAgICAgICAgICAgYXNzZXJ0RXhjZXB0aW9uTWVzc2FnZShlLCBBcmd1bWVu\ndEV4Y2VwdGlvbi5jbGFzcywKICAgICAgICAgICAgICAgICJObyBmaWVsZCBu\nYW1lZCBcIm1pZGRsZU5hbWVcIiBpbiBcIkVtYmVkTWl4ZWRBY2Nlc3NcIiIs\nCiAgICAgICAgICAgICAgICAiW2ZpcnN0TmFtZSwgbGFzdE5hbWUsIG1OYW1l\nXSIpOwogICAgICAgIH0KCiAgICAgICAgZW0uY2xvc2UoKTsKICAgIH0KCiAg\nICAvKioKICAgICAqIFZhbGlkYXRlcyB0aGF0IGEgbWl4IG9mIGFjY2VzcyB0\neXBlcyBjYW4gYmUgdXNlZCB3aXRoaW4KICAgICAqIGFuIGVtYmVkZGFibGUg\nc3RhY2suCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHRlc3ROZXN0ZWRFbWJl\nZGRhYmxlcygpIHsKICAgICAgICBPcGVuSlBBRW50aXR5TWFuYWdlclNQSSBl\nbSA9IGVtZi5jcmVhdGVFbnRpdHlNYW5hZ2VyKCk7CiAgICAgICAgCiAgICAg\nICAgRW1iZWRJbm5lclByb3AgZWlwID0gbmV3IEVtYmVkSW5uZXJQcm9wKCk7\nCiAgICAgICAgZWlwLnNldElubmVyTmFtZSgiSW5uZXIiKTsKICAgICAgICBF\nbWJlZE91dGVyRmllbGQgZW9mID0gbmV3IEVtYmVkT3V0ZXJGaWVsZCgpOwog\nICAgICAgIGVvZi5zZXRPdXRlck5hbWUoIk91dGVyIik7CiAgICAgICAgZWlw\nLnNldE91dGVyRmllbGQoZW9mKTsKICAgICAgICAgICAgICAgIAogICAgICAg\nIE1peGVkTmVzdGVkRW1iZWRFbnRpdHkgcG0gPSBuZXcgTWl4ZWROZXN0ZWRF\nbWJlZEVudGl0eSgpOwogICAgICAgIHBtLnNldE5hbWUoIk1peGVkTmVzdGVk\nRW1iZWRFbnRpdHkiKTsKICAgICAgICBwbS5zZXRFbWJlZFByb3AoZWlwKTsK\nICAgICAgICAKICAgICAgICBlbS5nZXRUcmFuc2FjdGlvbigpLmJlZ2luKCk7\nCiAgICAgICAgZW0ucGVyc2lzdChwbSk7CiAgICAgICAgZW0uZ2V0VHJhbnNh\nY3Rpb24oKS5jb21taXQoKTsKICAgICAgICAKICAgICAgICBlbS5jbGVhcigp\nOwogICAgICAgIAogICAgICAgIFF1ZXJ5IHFyeSA9IGVtLmNyZWF0ZU5hbWVk\nUXVlcnkoIk1peGVkTmVzdGVkRW1iZWRFbnRpdHkucXVlcnkiKTsKICAgICAg\nICBxcnkuc2V0UGFyYW1ldGVyKCJpZCIsIHBtLmdldElkKCkpOwogICAgICAg\nIHFyeS5zZXRQYXJhbWV0ZXIoIm5hbWUiLCAiTWl4ZWROZXN0ZWRFbWJlZEVu\ndGl0eSIpOwogICAgICAgIHFyeS5zZXRQYXJhbWV0ZXIoImlubmVyTmFtZSIs\nICJJbm5lciIpOwogICAgICAgIHFyeS5zZXRQYXJhbWV0ZXIoIm91dGVyTmFt\nZSIsICJPdXRlciIpOwogICAgICAgIE1peGVkTmVzdGVkRW1iZWRFbnRpdHkg\ncG0yID0gCiAgICAgICAgICAgIChNaXhlZE5lc3RlZEVtYmVkRW50aXR5KXFy\neS5nZXRTaW5nbGVSZXN1bHQoKTsKICAgICAgICBhc3NlcnRFcXVhbHMocG0s\nIHBtMik7CiAgICAgICAgYXNzZXJ0RXF1YWxzKGVpcCwgcG0yLmdldEVtYmVk\nUHJvcCgpKTsKCiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgcXJ5ID0gZW0u\nY3JlYXRlTmFtZWRRdWVyeSgiTWl4ZWROZXN0ZWRFbWJlZEVudGl0eS5iYWRR\ndWVyeSIpOwogICAgICAgICAgICBxcnkuc2V0UGFyYW1ldGVyKCJpZCIsIHBt\nLmdldElkKCkpOwogICAgICAgICAgICBxcnkuc2V0UGFyYW1ldGVyKCJuYW1l\nIiwgIk1peGVkTmVzdGVkRW1iZWRFbnRpdHkiKTsKICAgICAgICAgICAgcXJ5\nLnNldFBhcmFtZXRlcigiaW5uZXJOYW1lIiwgIklubmVyIik7CiAgICAgICAg\nICAgIHFyeS5zZXRQYXJhbWV0ZXIoIm91dGVyTmFtZSIsICJPdXRlciIpOwog\nICAgICAgICAgICBxcnkuZ2V0U2luZ2xlUmVzdWx0KCk7CiAgICAgICAgICAg\nIGZhaWwoIlF1ZXJ5IGV4ZWN1dGlvbiBzaG91bGQgaGF2ZSBmYWlsZWQuIik7\nCiAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAg\nYXNzZXJ0RXhjZXB0aW9uTWVzc2FnZShlLCBBcmd1bWVudEV4Y2VwdGlvbi5j\nbGFzcywKICAgICAgICAgICAgICAgICJObyBmaWVsZCBuYW1lZCBcIm91dGVy\nTmFtZVwiIGluIFwiRW1iZWRPdXRlckZpZWxkXCIiLAogICAgICAgICAgICAg\nICAgIltvdXROYW1lXSIpOwogICAgICAgIH0KCiAgICAgICAgZW0uY2xvc2Uo\nKTsKICAgIH0KCiAgICAvKioKICAgICAqIFZhbGlkYXRlcyB0aGF0IGEgbWl4\nIG9mIGFjY2VzcyB0eXBlcyBjYW4gYmUgdXNlZCBieSBhbgogICAgICogYW4g\nZW50aXR5IHdpdGggbXVsaXRwbGUgZW1iZWRkYWJsZXMuCiAgICAgKi8KICAg\nIHB1YmxpYyB2b2lkIHRlc3RNdWx0aXBsZUVtYmVkZGFibGVzKCkgewogICAg\nICAgIE9wZW5KUEFFbnRpdHlNYW5hZ2VyU1BJIGVtID0gZW1mLmNyZWF0ZUVu\ndGl0eU1hbmFnZXIoKTsKICAgICAgICAKICAgICAgICBFbWJlZEZpZWxkQWNj\nZXNzIGVmYSA9IG5ldyBFbWJlZEZpZWxkQWNjZXNzKCk7CiAgICAgICAgZWZh\nLnNldEZpcnN0TmFtZSgiRmlyc3QiKTsKICAgICAgICBlZmEuc2V0TGFzdE5h\nbWUoIkxhc3QiKTsKICAgICAgICAKICAgICAgICBFbWJlZFByb3BBY2Nlc3Mg\nZXBhID0gbmV3IEVtYmVkUHJvcEFjY2VzcygpOwogICAgICAgIGVwYS5zZXRG\naXJzdE5hbWUoImZuYW1lIik7CiAgICAgICAgZXBhLnNldExhc3ROYW1lKCJs\nbmFtZSIpOwogICAgICAgICAgICAgICAgCiAgICAgICAgTWl4ZWRNdWx0RW1i\nZWRFbnRpdHkgcG0gPSBuZXcgTWl4ZWRNdWx0RW1iZWRFbnRpdHkoKTsKICAg\nICAgICBwbS5zZXROYW1lKCJNaXhlZE11bHRFbWJlZEVudGl0eSIpOwogICAg\nICAgIHBtLnNldEVtYmVkUHJvcChlcGEpOwogICAgICAgIHBtLnNldEVtYmVk\nRmllbGQoZWZhKTsKICAgICAgICAKICAgICAgICBlbS5nZXRUcmFuc2FjdGlv\nbigpLmJlZ2luKCk7CiAgICAgICAgZW0ucGVyc2lzdChwbSk7CiAgICAgICAg\nZW0uZ2V0VHJhbnNhY3Rpb24oKS5jb21taXQoKTsKICAgICAgICAKICAgICAg\nICBlbS5jbGVhcigpOwogICAgICAgIAogICAgICAgIFF1ZXJ5IHFyeSA9IGVt\nLmNyZWF0ZU5hbWVkUXVlcnkoIk1peGVkTXVsdEVtYmVkRW50aXR5LnF1ZXJ5\nIik7CiAgICAgICAgcXJ5LnNldFBhcmFtZXRlcigiaWQiLCBwbS5nZXRJZCgp\nKTsKICAgICAgICBxcnkuc2V0UGFyYW1ldGVyKCJuYW1lIiwgIk1peGVkTXVs\ndEVtYmVkRW50aXR5Iik7CiAgICAgICAgcXJ5LnNldFBhcmFtZXRlcigiZmly\nc3ROYW1lIiwgImZuYW1lIik7CiAgICAgICAgcXJ5LnNldFBhcmFtZXRlcigi\nbGFzdE5hbWUiLCAibG5hbWUiKTsKICAgICAgICBxcnkuc2V0UGFyYW1ldGVy\nKCJmTmFtZSIsICJGaXJzdCIpOwogICAgICAgIHFyeS5zZXRQYXJhbWV0ZXIo\nImxOYW1lIiwgIkxhc3QiKTsKICAgICAgICBNaXhlZE11bHRFbWJlZEVudGl0\neSBwbTIgPSAKICAgICAgICAgICAgKE1peGVkTXVsdEVtYmVkRW50aXR5KXFy\neS5nZXRTaW5nbGVSZXN1bHQoKTsKICAgICAgICBhc3NlcnRFcXVhbHMocG0s\nIHBtMik7CiAgICAgICAgYXNzZXJ0RXF1YWxzKGVwYSwgcG0yLmdldEVtYmVk\nUHJvcCgpKTsKICAgICAgICBhc3NlcnRFcXVhbHMoZWZhLCBwbTIuZ2V0RW1i\nZWRGaWVsZCgpKTsKCiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgcXJ5ID0g\nZW0uY3JlYXRlTmFtZWRRdWVyeSgiTWl4ZWRNdWx0RW1iZWRFbnRpdHkuYmFk\nUXVlcnkxIik7CiAgICAgICAgICAgIHFyeS5zZXRQYXJhbWV0ZXIoImlkIiwg\ncG0uZ2V0SWQoKSk7CiAgICAgICAgICAgIHFyeS5zZXRQYXJhbWV0ZXIoIm5h\nbWUiLCAiTWl4ZWRNdWx0RW1iZWRFbnRpdHkiKTsKICAgICAgICAgICAgcXJ5\nLnNldFBhcmFtZXRlcigiZXBhIiwgZXBhKTsKICAgICAgICAgICAgcXJ5Lmdl\ndFNpbmdsZVJlc3VsdCgpOwogICAgICAgICAgICBmYWlsKCJRdWVyeSBleGVj\ndXRpb24gc2hvdWxkIGhhdmUgZmFpbGVkLiIpOwogICAgICAgIH0gY2F0Y2gg\nKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgIGFzc2VydEV4Y2VwdGlvbk1l\nc3NhZ2UoZSwgQXJndW1lbnRFeGNlcHRpb24uY2xhc3MsCiAgICAgICAgICAg\nICAgICAiTm8gZmllbGQgbmFtZWQgXCJlcGFcIiBpbiBcIk1peGVkTXVsdEVt\nYmVkRW50aXR5XCIiLAogICAgICAgICAgICAgICAgIltlbWJlZEZpZWxkLCBl\nbWJlZFByb3AsIG1pZCwgbmFtZV0iKTsKICAgICAgICB9CgogICAgICAgIHRy\neSB7CiAgICAgICAgICAgIHFyeSA9IGVtLmNyZWF0ZU5hbWVkUXVlcnkoIk1p\neGVkTXVsdEVtYmVkRW50aXR5LmJhZFF1ZXJ5MiIpOwogICAgICAgICAgICBx\ncnkuc2V0UGFyYW1ldGVyKCJpZCIsIHBtLmdldElkKCkpOwogICAgICAgICAg\nICBxcnkuc2V0UGFyYW1ldGVyKCJuYW1lIiwgIk1peGVkTXVsdEVtYmVkRW50\naXR5Iik7CiAgICAgICAgICAgIHFyeS5zZXRQYXJhbWV0ZXIoImVwYSIsIGVw\nYSk7CiAgICAgICAgICAgIHFyeS5zZXRQYXJhbWV0ZXIoImZpcnN0TmFtZSIs\nICJGaXJzdCIpOwogICAgICAgICAgICBxcnkuc2V0UGFyYW1ldGVyKCJsYXN0\nTmFtZSIsICJMYXN0Iik7CiAgICAgICAgICAgIHFyeS5nZXRTaW5nbGVSZXN1\nbHQoKTsKICAgICAgICAgICAgZmFpbCgiUXVlcnkgZXhlY3V0aW9uIHNob3Vs\nZCBoYXZlIGZhaWxlZC4iKTsKICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24g\nZSkgewogICAgICAgICAgICAvLyBubyBzdXBwb3J0OiBjb25kaXRpb25hbCBl\neHByZXNzaW9uYWwgZXhwcmVzc2lvbiBvdmVyIGVtYmVkZGFibGUKICAgICAg\nICAgICAgYXNzZXJ0RXhjZXB0aW9uKGUsIEFyZ3VtZW50RXhjZXB0aW9uLmNs\nYXNzKTsKICAgICAgICB9CgogICAgICAgIGVtLmNsb3NlKCk7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBWYWxpZGF0ZXMgZXhwbGljaXQgcHJvcGVydHkgYWNj\nZXNzIGNhbiBiZSBhcHBsaWVkIHRvIGFsbCB0aGUgYWNjZXNzCiAgICAgKiBz\ndHJhdGVnaWVzIGZyb20gd2l0aGluIGFuIGVudGl0eSB3aXRoIGV4cGxpY2l0\nIGZpZWxkIGFjY2VzcyAoZXhjZXB0IGZvcgogICAgICogdGhlIGlkIGZpZWxk\nLCB3aGljaCBpcyBmaWVsZCBkZWZhdWx0KQogICAgICovCiAgICBwdWJsaWMg\ndm9pZCB0ZXN0UHJvcGVydHlBY2Nlc3NTdHJhdGVnaWVzKCkgewogICAgICAg\nIE9wZW5KUEFFbnRpdHlNYW5hZ2VyU1BJIGVtID0gZW1mLmNyZWF0ZUVudGl0\neU1hbmFnZXIoKTsKCiAgICAgICAgUHJvcEFjY2Vzc0ZpZWxkU3RyYXRzRW50\naXR5IHBhID0gbmV3IFByb3BBY2Nlc3NGaWVsZFN0cmF0c0VudGl0eSgpOwog\nICAgICAgIAogICAgICAgIC8vIExvYWQgYWxsIHBlcnNpc3RlbnQgZmllbGRz\nCiAgICAgICAgRW1iZWRJZCBlaWQgPSBuZXcgRW1iZWRJZCgpOwogICAgICAg\nIGVpZC5zZXRJZChuZXcgUmFuZG9tKCkubmV4dEludCgpKTsKICAgICAgICBl\naWQuc2V0Q29kZSgiSWRDb2RlIik7ICAgICAgICAKICAgICAgICBwYS5zZXRF\nbWJlZElkKGVpZCk7IC8vIGVtYmVkZGVkIGlkCiAgICAgICAgCiAgICAgICAg\nQ29sbGVjdGlvbjxFbWJlZFByb3BBY2Nlc3M+IGVsYyA9IG5ldyBBcnJheUxp\nc3Q8RW1iZWRQcm9wQWNjZXNzPigpOwogICAgICAgIEVtYmVkUHJvcEFjY2Vz\ncyBlcGExID0gbmV3IEVtYmVkUHJvcEFjY2VzcygiQWJlIiwgIkxpbmNvbG4i\nKTsKICAgICAgICBFbWJlZFByb3BBY2Nlc3MgZXBhMiA9IG5ldyBFbWJlZFBy\nb3BBY2Nlc3MoIkpvaG4iLCAiS2VubmVkeSIpOwogICAgICAgIGVsYy5hZGQo\nZXBhMSk7CiAgICAgICAgZWxjLmFkZChlcGEyKTsgICAgICAgICAgICAgICAg\nCiAgICAgICAgcGEuc2V0RWxlbWVudENvbGxlY3Rpb24oZWxjKTsgLy8gZWxl\nbWVudCBjb2xsZWN0aW9uIG9mIGVtYmVkZGFibGVzCiAgICAgICAgCiAgICAg\nICAgRW1iZWRGaWVsZEFjY2VzcyBlZmEgPSBuZXcgRW1iZWRGaWVsZEFjY2Vz\ncygpOwogICAgICAgIGVmYS5zZXRGaXJzdE5hbWUoIlRoZSIpOwogICAgICAg\nIGVmYS5zZXRMYXN0TmFtZSgiUHJlc2lkZW50Iik7CiAgICAgICAgcGEuc2V0\nRW1iZWRGaWVsZChlZmEpOyAvLyBlbWJlZGRlZAogICAgICAgIAogICAgICAg\nIHBhLnNldE5hbWUoIlByb3BBY2Nlc3NGaWVsZFN0cmF0c0VudGl0eSIpOyAg\nLy8gYmFzaWMKICAgICAgICAKICAgICAgICBQcm9wQWNjZXNzIHByb3BhID0g\nbmV3IFByb3BBY2Nlc3MoKTsKICAgICAgICBwcm9wYS5zZXRTdHJQcm9wKCJQ\ncm9wQWNjZXNzIik7CiAgICAgICAgcGEuc2V0TWFueVRvT25lKHByb3BhKTsg\nLy8gbWFueSB0byBvbmUKICAgICAgICAKICAgICAgICBDb2xsZWN0aW9uPEZp\nZWxkQWNjZXNzPiBmYWMgPSBuZXcgQXJyYXlMaXN0PEZpZWxkQWNjZXNzPigp\nOwogICAgICAgIEZpZWxkQWNjZXNzIGZhID0gbmV3IEZpZWxkQWNjZXNzKCk7\nCiAgICAgICAgZmEuc2V0U3RyRmllbGQoIkZpZWxkQWNjZXNzIik7CiAgICAg\nICAgZmFjLmFkZChmYSk7CiAgICAgICAgcGEuc2V0T25lVG9NYW55KGZhYyk7\nIC8vIG9uZSB0byBtYW55CiAgICAgICAgCiAgICAgICAgUHJvcEFjY2VzcyBw\nYTIgPSBuZXcgUHJvcEFjY2VzcygpOwogICAgICAgIHBhMi5zZXRTdHJQcm9w\nKCJQcm9wQWNjZXNzMiIpOwogICAgICAgIHBhLnNldE9uZVRvT25lKHBhMik7\nIC8vIG9uZSB0byBvbmUKICAgICAgIAogICAgICAgIGVtLmdldFRyYW5zYWN0\naW9uKCkuYmVnaW4oKTsKICAgICAgICBlbS5wZXJzaXN0KHBhKTsKICAgICAg\nICBlbS5nZXRUcmFuc2FjdGlvbigpLmNvbW1pdCgpOwogICAgICAgIAogICAg\nICAgIGVtLmNsZWFyKCk7CiAgICAgICAgLy8gVmVyaWZ5IGxpc3Qgb2YgcGVy\nc2lzdGVudCBmaWVsZHMKICAgICAgICBQcm9wQWNjZXNzRmllbGRTdHJhdHNF\nbnRpdHkgbmV3cGEgPSAKICAgICAgICAgICAgZW0uZmluZChQcm9wQWNjZXNz\nRmllbGRTdHJhdHNFbnRpdHkuY2xhc3MsIGVpZCk7CiAgICAgICAgYXNzZXJ0\nTm90TnVsbChuZXdwYSk7CiAgICAgICAgLy8gc2ltcGxlIGtleSB2YWxpZGF0\naW9uCiAgICAgICAgYXNzZXJ0RXF1YWxzKG5ld3BhLmdldEVtYmVkSWQoKSwg\nZWlkKTsKCiAgICAgICAgLy8gVmVyaWZ5IHRoZSBwZXJzaXN0ZW50IG1lbWJl\nciBuYW1lcwogICAgICAgIE1ldGFEYXRhUmVwb3NpdG9yeSBtZHIgPSAKICAg\nICAgICAgICAgZW0uZ2V0Q29uZmlndXJhdGlvbigpLmdldE1ldGFEYXRhUmVw\nb3NpdG9yeUluc3RhbmNlKCk7CiAgICAgICAgCiAgICAgICAgQ2xhc3NNZXRh\nRGF0YSBjbWQgPSBtZHIuZ2V0TWV0YURhdGEoUHJvcEFjY2Vzc0ZpZWxkU3Ry\nYXRzRW50aXR5LmNsYXNzLCAKICAgICAgICAgICAgbnVsbCwgdHJ1ZSk7CiAg\nICAgICAgLy8gQXNzZXJ0IGV4cGVjdGVkIHBlcnNpc3RlbnQgZmllbGRzIGFu\nZCBwcm9wZXJ0aWVzIHdlcmUgY3JlYXRlZAogICAgICAgIGFzc2VydE5vdE51\nbGwoY21kLmdldEZpZWxkKCJlbWJlZElkIikpOwogICAgICAgIGFzc2VydE5v\ndE51bGwoY21kLmdldEZpZWxkKCJtMm9uZSIpKTsKICAgICAgICBhc3NlcnRO\nb3ROdWxsKGNtZC5nZXRGaWVsZCgib25lMm0iKSk7CiAgICAgICAgYXNzZXJ0\nTm90TnVsbChjbWQuZ2V0RmllbGQoIm9uZTJvbmUiKSk7CiAgICAgICAgYXNz\nZXJ0Tm90TnVsbChjbWQuZ2V0RmllbGQoImVjb2xsIikpOwogICAgICAgIGFz\nc2VydE5vdE51bGwoY21kLmdldEZpZWxkKCJlbWJlZCIpKTsKICAgICAgICBh\nc3NlcnROb3ROdWxsKGNtZC5nZXRGaWVsZCgidmVyIikpOwogICAgICAgIGFz\nc2VydE5vdE51bGwoY21kLmdldEZpZWxkKCJtMm0iKSk7CgogICAgICAgIC8v\nIE5hbWUgaGFzIGEgbWF0Y2hpbmcgZ2V0dGVyL3NldHRlci4gIE1ha2Ugc3Vy\nZSB0aGUgYWNjZXNzIHR5cGUKICAgICAgICAvLyBpcyBmaWVsZCAmIG5vdCBw\ncm9wZXJ0eQogICAgICAgIGFzc2VydE5vdE51bGwoY21kLmdldEZpZWxkKCJu\nYW1lIikpOwogICAgICAgIGFzc2VydFRydWUoKGNtZC5nZXRGaWVsZCgibmFt\nZSIpLmdldEFjY2Vzc1R5cGUoKSAmIEFjY2Vzc0NvZGUuRklFTEQpID09IAog\nICAgICAgICAgICBBY2Nlc3NDb2RlLkZJRUxEKTsKCiAgICAgICAgLy8gQXNz\nZXJ0IG1hcHBpbmdzIHdlcmUgbm90IGNyZWF0ZWQgZm9yIGZpZWxkcyBvciBw\ncm9wZXJ0aWVzIHdoaWNoIAogICAgICAgIC8vIHNob3VsZCBub3QgYmUgcGVy\nc2lzdGVudAogICAgICAgIGFzc2VydE51bGwoY21kLmdldEZpZWxkKCJlaWQi\nKSk7CiAgICAgICAgYXNzZXJ0TnVsbChjbWQuZ2V0RmllbGQoImVsZW1lbnRD\nb2xsZWN0aW9uIikpOwogICAgICAgIGFzc2VydE51bGwoY21kLmdldEZpZWxk\nKCJlbWJlZEZpZWxkIikpOwogICAgICAgIGFzc2VydE51bGwoY21kLmdldEZp\nZWxkKCJ2ZXJzaW9uIikpOwogICAgICAgIGFzc2VydE51bGwoY21kLmdldEZp\nZWxkKCJtYW55VG9PbmUiKSk7CiAgICAgICAgYXNzZXJ0TnVsbChjbWQuZ2V0\nRmllbGQoIm9uZVRvTWFueSIpKTsKICAgICAgICBhc3NlcnROdWxsKGNtZC5n\nZXRGaWVsZCgib25lVG9PbmUiKSk7CiAgICAgICAgYXNzZXJ0TnVsbChjbWQu\nZ2V0RmllbGQoIm1hbnlUb01hbnkiKSk7CiAgICAgICAgCiAgICAgICAgZW0u\nY2xvc2UoKTsKICAgIH0KCiAgICAvKioKICAgICAqIFZhbGlkYXRlcyBleHBs\naWNpdCBmaWVsZCBhY2Nlc3MgY2FuIGJlIGFwcGxpZWQgdG8gYWxsIHRoZSBh\nY2Nlc3MKICAgICAqIHN0cmF0ZWdpZXMgZnJvbSB3aXRoaW4gYW4gZW50aXR5\nIHdpdGggZXhwbGljaXQgcHJvcGVydHkgYWNjZXNzIChleGNlcHQKICAgICAq\nIGZvciB0aGUgaWQgZmllbGQsIHdoaWNoIGlzIHByb3BlcnR5IGRlZmF1bHQp\nCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHRlc3RGaWVsZEFjY2Vzc1N0cmF0\nZWdpZXMoKSB7CiAgICAgICAgT3BlbkpQQUVudGl0eU1hbmFnZXJTUEkgZW0g\nPSBlbWYuY3JlYXRlRW50aXR5TWFuYWdlcigpOwoKICAgICAgICBGaWVsZEFj\nY2Vzc1Byb3BTdHJhdHNFbnRpdHkgZmEgPSBuZXcgRmllbGRBY2Nlc3NQcm9w\nU3RyYXRzRW50aXR5KCk7CiAgICAgICAgCiAgICAgICAgLy8gTG9hZCBhbGwg\ncGVyc2lzdGVudCBmaWVsZHMKICAgICAgICBFbWJlZElkIGVpZCA9IG5ldyBF\nbWJlZElkKCk7CiAgICAgICAgZWlkLnNldElkKG5ldyBSYW5kb20oKS5uZXh0\nSW50KCkpOwogICAgICAgIGVpZC5zZXRDb2RlKCJJZENvZGUiKTsgICAgICAg\nIAogICAgICAgIGZhLnNldEVtYmVkSWQoZWlkKTsgLy8gZW1iZWRkZWQgaWQK\nICAgICAgICAKICAgICAgICBDb2xsZWN0aW9uPEVtYmVkUHJvcEFjY2Vzcz4g\nZWxjID0gbmV3IEFycmF5TGlzdDxFbWJlZFByb3BBY2Nlc3M+KCk7CiAgICAg\nICAgRW1iZWRQcm9wQWNjZXNzIGVwYTEgPSBuZXcgRW1iZWRQcm9wQWNjZXNz\nKCJHZW9yZ2UiLCAiV2FzaGluZ3RvbiIpOwogICAgICAgIEVtYmVkUHJvcEFj\nY2VzcyBlcGEyID0gbmV3IEVtYmVkUHJvcEFjY2VzcygiSmFtZXMiLCAiQ2Fy\ndGVyIik7CiAgICAgICAgZWxjLmFkZChlcGExKTsKICAgICAgICBlbGMuYWRk\nKGVwYTIpOyAgICAgICAgICAgICAgICAKICAgICAgICBmYS5zZXRFbGVtZW50\nQ29sbGVjdGlvbihlbGMpOyAvLyBlbGVtZW50IGNvbGxlY3Rpb24gb2YgZW1i\nZWRkYWJsZXMKICAgICAgICAKICAgICAgICBFbWJlZEZpZWxkQWNjZXNzIGVm\nYSA9IG5ldyBFbWJlZEZpZWxkQWNjZXNzKCk7CiAgICAgICAgZWZhLnNldEZp\ncnN0TmFtZSgiVGhlIik7CiAgICAgICAgZWZhLnNldExhc3ROYW1lKCJQcmVz\naWRlbnQiKTsKICAgICAgICBmYS5zZXRFbWJlZEZpZWxkKGVmYSk7IC8vIGVt\nYmVkZGVkCiAgICAgICAgCiAgICAgICAgZmEuc2V0TmFtZSgiRmllbGRBY2Nl\nc3NQcm9wU3RyYXRzRW50aXR5Iik7ICAvLyBiYXNpYwogICAgICAgIAogICAg\nICAgIFByb3BBY2Nlc3MgcHJvcGEgPSBuZXcgUHJvcEFjY2VzcygpOwogICAg\nICAgIHByb3BhLnNldFN0clByb3AoIlByb3BBY2Nlc3MiKTsKICAgICAgICBm\nYS5zZXRNYW55VG9PbmUocHJvcGEpOyAvLyBtYW55IHRvIG9uZQogICAgICAg\nIAogICAgICAgIENvbGxlY3Rpb248RmllbGRBY2Nlc3M+IGZhYyA9IG5ldyBB\ncnJheUxpc3Q8RmllbGRBY2Nlc3M+KCk7CiAgICAgICAgRmllbGRBY2Nlc3Mg\nZmFlID0gbmV3IEZpZWxkQWNjZXNzKCk7CiAgICAgICAgZmFlLnNldFN0ckZp\nZWxkKCJGaWVsZEFjY2VzcyIpOwogICAgICAgIGZhYy5hZGQoZmFlKTsKICAg\nICAgICBmYS5zZXRPbmVUb01hbnkoZmFjKTsgLy8gb25lIHRvIG1hbnkKICAg\nICAgICAKICAgICAgICBQcm9wQWNjZXNzIHBhID0gbmV3IFByb3BBY2Nlc3Mo\nKTsKICAgICAgICBwYS5zZXRTdHJQcm9wKCJQcm9wQWNjZXNzIik7CiAgICAg\nICAgZmEuc2V0T25lVG9PbmUocGEpOyAvLyBvbmUgdG8gb25lCiAgICAgICAK\nICAgICAgICBlbS5nZXRUcmFuc2FjdGlvbigpLmJlZ2luKCk7CiAgICAgICAg\nZW0ucGVyc2lzdChmYSk7CiAgICAgICAgZW0uZ2V0VHJhbnNhY3Rpb24oKS5j\nb21taXQoKTsKICAgICAgICAKICAgICAgICBlbS5jbGVhcigpOwogICAgICAg\nIC8vIFZlcmlmeSBsaXN0IG9mIHBlcnNpc3RlbnQgZmllbGRzCiAgICAgICAg\nRmllbGRBY2Nlc3NQcm9wU3RyYXRzRW50aXR5IG5ld3BhID0gCiAgICAgICAg\nICAgIGVtLmZpbmQoRmllbGRBY2Nlc3NQcm9wU3RyYXRzRW50aXR5LmNsYXNz\nLCBlaWQpOwogICAgICAgIGFzc2VydE5vdE51bGwobmV3cGEpOwogICAgICAg\nIC8vIHNpbXBsZSBrZXkgdmFsaWRhdGlvbgogICAgICAgIGFzc2VydEVxdWFs\ncyhuZXdwYS5nZXRFbWJlZElkKCksIGVpZCk7CgogICAgICAgIC8vIFZlcmlm\neSB0aGUgcGVyc2lzdGVudCBtZW1iZXIgbmFtZXMKICAgICAgICBNZXRhRGF0\nYVJlcG9zaXRvcnkgbWRyID0gCiAgICAgICAgICAgIGVtLmdldENvbmZpZ3Vy\nYXRpb24oKS5nZXRNZXRhRGF0YVJlcG9zaXRvcnlJbnN0YW5jZSgpOwogICAg\nICAgIAogICAgICAgIENsYXNzTWV0YURhdGEgY21kID0gbWRyLmdldE1ldGFE\nYXRhKEZpZWxkQWNjZXNzUHJvcFN0cmF0c0VudGl0eS5jbGFzcywgCiAgICAg\nICAgICAgIG51bGwsIHRydWUpOwogICAgICAgIC8vIEFzc2VydCBleHBlY3Rl\nZCBwZXJzaXN0ZW50IGZpZWxkcyBhbmQgcHJvcGVydGllcyB3ZXJlIGNyZWF0\nZWQKICAgICAgICBhc3NlcnROb3ROdWxsKGNtZC5nZXRGaWVsZCgiZWlkIikp\nOwogICAgICAgIGFzc2VydE5vdE51bGwoY21kLmdldEZpZWxkKCJlbGVtZW50\nQ29sbGVjdGlvbiIpKTsKICAgICAgICBhc3NlcnROb3ROdWxsKGNtZC5nZXRG\naWVsZCgiZW1iZWRGaWVsZCIpKTsKICAgICAgICBhc3NlcnROb3ROdWxsKGNt\nZC5nZXRGaWVsZCgidmVyc2lvbiIpKTsKICAgICAgICBhc3NlcnROb3ROdWxs\nKGNtZC5nZXRGaWVsZCgibWFueVRvT25lIikpOwogICAgICAgIGFzc2VydE5v\ndE51bGwoY21kLmdldEZpZWxkKCJvbmVUb01hbnkiKSk7CiAgICAgICAgYXNz\nZXJ0Tm90TnVsbChjbWQuZ2V0RmllbGQoIm9uZVRvT25lIikpOwogICAgICAg\nIGFzc2VydE5vdE51bGwoY21kLmdldEZpZWxkKCJtYW55VG9NYW55IikpOwoK\nICAgICAgICAvLyBOYW1lIGhhcyBhIG1hdGNoaW5nIGdldHRlci9zZXR0ZXIu\nICBNYWtlIHN1cmUgdGhlIGFjY2VzcyB0eXBlCiAgICAgICAgLy8gaXMgcHJv\ncGVydHkgJiBub3QgZmllbGQKICAgICAgICBhc3NlcnROb3ROdWxsKGNtZC5n\nZXRGaWVsZCgibmFtZSIpKTsKICAgICAgICBhc3NlcnRUcnVlKChjbWQuZ2V0\nRmllbGQoIm5hbWUiKS5nZXRBY2Nlc3NUeXBlKCkgJiBBY2Nlc3NDb2RlLlBS\nT1BFUlRZKQogICAgICAgICAgICA9PSBBY2Nlc3NDb2RlLlBST1BFUlRZKTsK\nCiAgICAgICAgLy8gQXNzZXJ0IG1hcHBpbmdzIHdlcmUgbm90IGNyZWF0ZWQg\nZm9yIGZpZWxkcyBvciBwcm9wZXJ0aWVzIHdoaWNoIAogICAgICAgIC8vIHNo\nb3VsZCBub3QgYmUgcGVyc2lzdGVudAogICAgICAgIGFzc2VydE51bGwoY21k\nLmdldEZpZWxkKCJlbWJlZElkIikpOwogICAgICAgIGFzc2VydE51bGwoY21k\nLmdldEZpZWxkKCJtMm9uZSIpKTsKICAgICAgICBhc3NlcnROdWxsKGNtZC5n\nZXRGaWVsZCgib25lMm0iKSk7CiAgICAgICAgYXNzZXJ0TnVsbChjbWQuZ2V0\nRmllbGQoIm9uZTJvbmUiKSk7CiAgICAgICAgYXNzZXJ0TnVsbChjbWQuZ2V0\nRmllbGQoImVjb2xsIikpOwogICAgICAgIGFzc2VydE51bGwoY21kLmdldEZp\nZWxkKCJlbWJlZCIpKTsKICAgICAgICBhc3NlcnROdWxsKGNtZC5nZXRGaWVs\nZCgidmVyIikpOwogICAgICAgIGFzc2VydE51bGwoY21kLmdldEZpZWxkKCJt\nMm0iKSk7CiAgICAgICAgCiAgICAgICAgZW0uY2xvc2UoKTsKICAgIH0KCiAg\nICAvKioKICAgICAqIFZlcmlmaWVzIHRoZSB1c2Ugb2YgYSBtYXAgb2YgZW1i\nZWRkYWJsZXMgY29udGFpbmluZyBhIG5lc3RlZAogICAgICogbWl4ZWQgYWNj\nZXNzIGVtYmVkZGFibGUuIAogICAgICovCiAgICBwdWJsaWMgdm9pZCB0ZXN0\nTWFwV2l0aE5lc3RlZEVtYmVkZGFibGUoKSB7CiAgICAgICAgT3BlbkpQQUVu\ndGl0eU1hbmFnZXJTUEkgZW0gPSBlbWYuY3JlYXRlRW50aXR5TWFuYWdlcigp\nOwogICAgICAgIAogICAgICAgIE1lbnVJdGVtIG1pID0gbmV3IE1lbnVJdGVt\nKCk7CiAgICAgICAgbWkuc2V0TmFtZSgiUEIgJiBKIFNhbmR3aWNoIik7CiAg\nICAgICAgCiAgICAgICAgTWFwPFN0cmluZywgSW5ncmVkaWVudD4gaW5ncmVk\naWVudHMgPSBuZXcgSGFzaE1hcDxTdHJpbmcsIEluZ3JlZGllbnQ+KCk7CiAg\nICAgICAgbWkuc2V0SW5ncmVkaWVudHMoaW5ncmVkaWVudHMpOwogICAgICAg\nIAogICAgICAgIEluZ3JlZGllbnQgaTEgPSBuZXcgSW5ncmVkaWVudCgiUGVh\nbnV0IEJ1dHRlciIpOwogICAgICAgIGkxLnNldERlc2NyaXB0aW9uKCJFZGli\nbGUgYnJvd24gcGFzdGUsIG1hZGUgZnJvbSBwZWFudXRzIik7CiAgICAgICAg\nUXVhbnRpdHkgcTEgPSBuZXcgUXVhbnRpdHkoMS4wLCAiVGJzcCIpOwogICAg\nICAgIGkxLnNldFF1YW50aXR5KHExKTsKICAgICAgICBpbmdyZWRpZW50cy5w\ndXQoIlBlYW51dCBCdXR0ZXIiLCBpMSk7CiAgICAgICAgCiAgICAgICAgSW5n\ncmVkaWVudCBpMiA9IG5ldyBJbmdyZWRpZW50KCJKZWxseSIpOwogICAgICAg\nIGkyLnNldERlc2NyaXB0aW9uKCJTd2VldCBnZWwsIG1hZGUgZnJvbSBmcnVp\ndCIpOwogICAgICAgIFF1YW50aXR5IHEyID0gbmV3IFF1YW50aXR5KDEuNSwg\nIlRic3AiKTsKICAgICAgICBpMi5zZXRRdWFudGl0eShxMik7CiAgICAgICAg\naW5ncmVkaWVudHMucHV0KCJKZWxseSIsIGkyKTsKCiAgICAgICAgSW5ncmVk\naWVudCBpMyA9IG5ldyBJbmdyZWRpZW50KCJCcmVhZCIpOwogICAgICAgIGkz\nLnNldERlc2NyaXB0aW9uKCJCYWtlZCBtYXRlcmlhbCwgbWFkZSBmcm9tIGZs\nb3VyIGFuZCB3YXRlciIpOwogICAgICAgIFF1YW50aXR5IHEzID0gbmV3IFF1\nYW50aXR5KDIuMCwgIlNsaWNlIik7CiAgICAgICAgaTMuc2V0UXVhbnRpdHko\ncTMpOwogICAgICAgIGluZ3JlZGllbnRzLnB1dCgiQnJlYWQiLCBpMyk7Cgog\nICAgICAgIGVtLmdldFRyYW5zYWN0aW9uKCkuYmVnaW4oKTsKICAgICAgICBl\nbS5wZXJzaXN0KG1pKTsKICAgICAgICBlbS5nZXRUcmFuc2FjdGlvbigpLmNv\nbW1pdCgpOwogICAgICAgIGVtLmNsZWFyKCk7CiAgICAgICAgCiAgICAgICAg\nTWVudUl0ZW0gbWkyID0gZW0uZmluZChNZW51SXRlbS5jbGFzcywgbWkuZ2V0\nSWQoKSk7CiAgICAgICAgCiAgICAgICAgYXNzZXJ0RXF1YWxzKG1pMi5nZXRJ\nZCgpLCBtaS5nZXRJZCgpKTsKICAgICAgICBNYXA8U3RyaW5nLCBJbmdyZWRp\nZW50PiBpbmcyID0gbWkyLmdldEluZ3JlZGllbnRzKCk7CiAgICAgICAgYXNz\nZXJ0VHJ1ZShpbmcyLmNvbnRhaW5zS2V5KCJQZWFudXQgQnV0dGVyIikpOwog\nICAgICAgIFF1YW50aXR5IHEgPSBpbmcyLmdldCgiUGVhbnV0IEJ1dHRlciIp\nLmdldFF1YW50aXR5KCk7CiAgICAgICAgYXNzZXJ0Tm90TnVsbChxKTsKICAg\nICAgICBhc3NlcnRFcXVhbHMoMS4wLCBxLmdldEFtb3VudCgpKTsKICAgICAg\nICBhc3NlcnRFcXVhbHMoIlRic3AiLCBxLmdldFVuaXRPZk1lYXN1cmUoKSk7\nCiAgICAgICAgYXNzZXJ0VHJ1ZShpbmcyLmNvbnRhaW5zS2V5KCJKZWxseSIp\nKTsKICAgICAgICBxID0gaW5nMi5nZXQoIkplbGx5IikuZ2V0UXVhbnRpdHko\nKTsKICAgICAgICBhc3NlcnROb3ROdWxsKHEpOwogICAgICAgIGFzc2VydEVx\ndWFscygxLjUsIHEuZ2V0QW1vdW50KCkpOwogICAgICAgIGFzc2VydEVxdWFs\ncygiVGJzcCIsIHEuZ2V0VW5pdE9mTWVhc3VyZSgpKTsKICAgICAgICBhc3Nl\ncnRUcnVlKGluZzIuY29udGFpbnNLZXkoIkJyZWFkIikpOwogICAgICAgIHEg\nPSBpbmcyLmdldCgiQnJlYWQiKS5nZXRRdWFudGl0eSgpOwogICAgICAgIGFz\nc2VydE5vdE51bGwocSk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKDIuMCwgcS5n\nZXRBbW91bnQoKSk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKCJTbGljZSIsIHEu\nZ2V0VW5pdE9mTWVhc3VyZSgpKTsKCiAgICAgICAgZW0ucmVtb3ZlKG1pMik7\nCiAgICAgICAgCiAgICAgICAgZW0uY2xvc2UoKTsKICAgIH0KICAgIAogICAg\nLyoKICAgICAqIFNpbXBsZSBtZXRob2QgdG8gdmVyaWZ5IGlmIGFuIGV4Y2Vw\ndGlvbiBpcyBvZiB0aGUgY29ycmVjdCB0eXBlIGFuZAogICAgICogdGhhdCBp\ndCBjb250YWlucyB0aGUgZXhwZWN0ZWQgbWVzc2FnZSBmcmFnbWVudHMuCiAg\nICAgKi8KICAgIHByaXZhdGUgYm9vbGVhbiB2ZXJpZnlFeGNlcHRpb24oRXhj\nZXB0aW9uIGUsIENsYXNzIGMsIFN0cmluZy4uLnN0cmluZ3MpIHsKICAgICAg\nICBpZiAoYy5pc0luc3RhbmNlKGUpKSB7CiAgICAgICAgICAgIFN0cmluZyBl\neE1lc3NhZ2UgPSBlLmdldE1lc3NhZ2UoKTsKICAgICAgICAgICAgZm9yIChT\ndHJpbmcgbXNnIDogc3RyaW5ncykgewogICAgICAgICAgICAgICAgaWYgKCFl\neE1lc3NhZ2UuY29udGFpbnMobXNnKSkKICAgICAgICAgICAgICAgICAgICBy\nZXR1cm4gZmFsc2U7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJu\nIHRydWU7CiAgICAgICAgfQogICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0K\nfQo=\n","encoding":"base64"}

