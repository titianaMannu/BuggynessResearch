{"sha":"85832a883bf87728931c3142a31f606fbb1b2860","node_id":"MDQ6QmxvYjIwNjM2NDo4NTgzMmE4ODNiZjg3NzI4OTMxYzMxNDJhMzFmNjA2ZmJiMWIyODYw","size":42384,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/85832a883bf87728931c3142a31f606fbb1b2860","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwovKgog\nKiBMaWNlbnNlZCB0byB0aGUgQXBhY2hlIFNvZnR3YXJlIEZvdW5kYXRpb24g\nKEFTRikgdW5kZXIgb25lCiAqIG9yIG1vcmUgY29udHJpYnV0b3IgbGljZW5z\nZSBhZ3JlZW1lbnRzLiAgU2VlIHRoZSBOT1RJQ0UgZmlsZQogKiBkaXN0cmli\ndXRlZCB3aXRoIHRoaXMgd29yayBmb3IgYWRkaXRpb25hbCBpbmZvcm1hdGlv\nbgogKiByZWdhcmRpbmcgY29weXJpZ2h0IG93bmVyc2hpcC4gIFRoZSBBU0Yg\nbGljZW5zZXMgdGhpcyBmaWxlCiAqIHRvIHlvdSB1bmRlciB0aGUgQXBhY2hl\nIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUKICogIkxpY2Vuc2UiKTsgeW91\nIG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZQog\nKiB3aXRoIHRoZSBMaWNlbnNlLiAgWW91IG1heSBvYnRhaW4gYSBjb3B5IG9m\nIHRoZSBMaWNlbnNlIGF0CiAqCiAqIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9s\naWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVxdWlyZWQgYnkg\nYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsCiAqIHNv\nZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3Ry\naWJ1dGVkIG9uIGFuCiAqICJBUyBJUyIgQkFTSVMsIFdJVEhPVVQgV0FSUkFO\nVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWQogKiBLSU5ELCBlaXRoZXIgZXhw\ncmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUKICog\nc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZCBs\naW1pdGF0aW9ucwogKiB1bmRlciB0aGUgTGljZW5zZS4gICAgCiAqLwpwYWNr\nYWdlIG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5jb21tb24udXRp\nbHM7CgppbXBvcnQgamF2YS5iZWFucy5CZWFuSW5mbzsKaW1wb3J0IGphdmEu\nYmVhbnMuSW50cm9zcGVjdG9yOwppbXBvcnQgamF2YS5iZWFucy5Qcm9wZXJ0\neURlc2NyaXB0b3I7CmltcG9ydCBqYXZhLmlvLkJ5dGVBcnJheUlucHV0U3Ry\nZWFtOwppbXBvcnQgamF2YS5pby5CeXRlQXJyYXlPdXRwdXRTdHJlYW07Cmlt\ncG9ydCBqYXZhLmlvLklPRXhjZXB0aW9uOwppbXBvcnQgamF2YS5pby5PYmpl\nY3RJbnB1dFN0cmVhbTsKaW1wb3J0IGphdmEuaW8uT2JqZWN0T3V0cHV0U3Ry\nZWFtOwppbXBvcnQgamF2YS5pby5QcmludFN0cmVhbTsKaW1wb3J0IGphdmEu\naW8uUHJpbnRXcml0ZXI7CmltcG9ydCBqYXZhLmlvLlN0cmluZ1dyaXRlcjsK\naW1wb3J0IGphdmEubGFuZy5yZWZsZWN0Lkludm9jYXRpb25UYXJnZXRFeGNl\ncHRpb247CmltcG9ydCBqYXZhLmxhbmcucmVmbGVjdC5NZXRob2Q7CmltcG9y\ndCBqYXZhLm1hdGguQmlnRGVjaW1hbDsKaW1wb3J0IGphdmEubWF0aC5CaWdJ\nbnRlZ2VyOwppbXBvcnQgamF2YS5uZXQuVVJMOwppbXBvcnQgamF2YS51dGls\nLkFycmF5TGlzdDsKaW1wb3J0IGphdmEudXRpbC5BcnJheXM7CmltcG9ydCBq\nYXZhLnV0aWwuQ29sbGVjdGlvbjsKaW1wb3J0IGphdmEudXRpbC5Db2xsZWN0\naW9uczsKaW1wb3J0IGphdmEudXRpbC5Db21wYXJhdG9yOwppbXBvcnQgamF2\nYS51dGlsLkRhdGU7CmltcG9ydCBqYXZhLnV0aWwuRW51bVNldDsKaW1wb3J0\nIGphdmEudXRpbC5IYXNoTWFwOwppbXBvcnQgamF2YS51dGlsLkl0ZXJhdG9y\nOwppbXBvcnQgamF2YS51dGlsLkxpbmtlZExpc3Q7CmltcG9ydCBqYXZhLnV0\naWwuTGlzdDsKaW1wb3J0IGphdmEudXRpbC5MaXN0SXRlcmF0b3I7CmltcG9y\ndCBqYXZhLnV0aWwuTWFwOwppbXBvcnQgamF2YS51dGlsLk5vU3VjaEVsZW1l\nbnRFeGNlcHRpb247CmltcG9ydCBqYXZhLnV0aWwuU3RyaW5nVG9rZW5pemVy\nOwppbXBvcnQgamF2YS51dGlsLk1hcC5FbnRyeTsKCmltcG9ydCBqYXZheC5t\nYW5hZ2VtZW50LkludHJvc3BlY3Rpb25FeGNlcHRpb247CmltcG9ydCBqYXZh\neC5wZXJzaXN0ZW5jZS5FbnRpdHlNYW5hZ2VyOwppbXBvcnQgamF2YXgucGVy\nc2lzdGVuY2UuRW50aXR5TWFuYWdlckZhY3Rvcnk7CmltcG9ydCBqYXZheC5w\nZXJzaXN0ZW5jZS5RdWVyeTsKCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\nY29uZi5PcGVuSlBBQ29uZmlndXJhdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS5rZXJuZWwuQnJva2VyRmFjdG9yeTsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5rZXJuZWwuT3BlbkpQQVN0YXRlTWFuYWdlcjsKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5saWIubG9nLkxvZzsKaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS5tZXRhLkNsYXNzTWV0YURhdGE7CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuSlBBRmFjYWRlSGVscGVyOwpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNlLk9wZW5KUEFF\nbnRpdHlNYW5hZ2VyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNp\nc3RlbmNlLk9wZW5KUEFFbnRpdHlNYW5hZ2VyRmFjdG9yeTsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5PcGVuSlBBUGVyc2lzdGVu\nY2U7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UudGVz\ndC5BYnN0cmFjdENhY2hlZEVNRlRlc3RDYXNlOwppbXBvcnQgb3JnLmFwYWNo\nZS5yZWdleHAuUkU7CmltcG9ydCBvcmcuYXBhY2hlLnJlZ2V4cC5SRVN5bnRh\neEV4Y2VwdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUucmVnZXhwLlJFVXRpbDsK\nCnB1YmxpYyBhYnN0cmFjdCBjbGFzcyBBYnN0cmFjdFRlc3RDYXNlIGV4dGVu\nZHMgQWJzdHJhY3RDYWNoZWRFTUZUZXN0Q2FzZSB7CgogICAgcHJpdmF0ZSBT\ndHJpbmcgcGVyc2lzdGVuY2VYbWxSZXNvdXJjZTsKICAgIHByaXZhdGUgTWFw\nPE1hcCxPcGVuSlBBRW50aXR5TWFuYWdlckZhY3Rvcnk+IGVtZnMgPQogICAg\nICAgIG5ldyBIYXNoTWFwPE1hcCxPcGVuSlBBRW50aXR5TWFuYWdlckZhY3Rv\ncnk+KCk7CiAgICBwcml2YXRlIE9wZW5KUEFFbnRpdHlNYW5hZ2VyIGN1cnJl\nbnRFbnRpdHlNYW5hZ2VyOwogICAgcHJpdmF0ZSBPYmplY3RbXSBwcm9wczsK\nCiAgICBwcm90ZWN0ZWQgZW51bSBQbGF0Zm9ybSB7CiAgICAgICAgRU1QUkVT\nUywKICAgICAgICBIWVBFUlNPTklDLAogICAgICAgIFBPU1RHUkVTUUwsCiAg\nICAgICAgTVlTUUwsCiAgICAgICAgU1FMU0VSVkVSLAogICAgICAgIERCMiwK\nICAgICAgICBPUkFDTEUsCiAgICAgICAgREVSQlksCiAgICAgICAgSU5GT1JN\nSVgsCiAgICAgICAgUE9JTlRCQVNFLAogICAgICAgIFNZQkFTRSwKICAgICAg\nICBJTkdSRVMsCiAgICB9CgogICAgcHJvdGVjdGVkIFN0cmluZyBtdWx0aVRo\ncmVhZEV4ZWN1dGluZyA9IG51bGw7CiAgICBwcm90ZWN0ZWQgYm9vbGVhbiBp\nblRpbWVvdXRUaHJlYWQgPSBmYWxzZTsKCgogICAgcHVibGljIEFic3RyYWN0\nVGVzdENhc2UoU3RyaW5nIG5hbWUsIFN0cmluZyBzKSB7CiAgICAgICAgc2V0\nTmFtZShuYW1lKTsKICAgICAgICBwZXJzaXN0ZW5jZVhtbFJlc291cmNlID0g\nY29tcHV0ZVBlcnNpc3RlbmNlWG1sUmVzb3VyY2Uocyk7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBVc2UgdGhlIGdpdmVuIHBlcnNpc3RlbnQgdHlwZXMgZHVy\naW5nIHRoZSB0ZXN0LgogICAgICogCiAgICAgKiBAcGFyYW0gcHJvcHMKICAg\nICAqICAgICAgICAgICAgbGlzdCBvZiBwZXJzaXN0ZW50IHR5cGVzIHVzZWQg\naW4gdGVzdGluZyBhbmQvb3IgY29uZmlndXJhdGlvbiB2YWx1ZXMgaW4gdGhl\nIGZvcm0KICAgICAqICAgICAgICAgICAga2V5LHZhbHVlLGtleSx2YWx1ZS4u\nLgogICAgICovCiAgICBwcm90ZWN0ZWQgdm9pZCBzZXRVcChPYmplY3QuLi4g\ncHJvcHMpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIHN1cGVyLnNldFVw\nKCk7CiAgICAgICAgdGhpcy5wcm9wcyA9IHByb3BzOwogICAgfQoKICAgIHB1\nYmxpYyB2b2lkIHRlYXJEb3duKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAg\nICAgdHJ5IHsKICAgICAgICAgICAgc3VwZXIudGVhckRvd24oKTsKICAgICAg\nICB9IGZpbmFsbHkgewogICAgICAgICAgICBmb3IgKEVudGl0eU1hbmFnZXJG\nYWN0b3J5IGVtZiA6IGVtZnMudmFsdWVzKCkpIHsKICAgICAgICAgICAgICAg\nIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgY2xvc2VFTUYoZW1mKTsKICAg\nICAgICAgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAg\nICAgICAgICAgICAgZS5wcmludFN0YWNrVHJhY2UoKTsKICAgICAgICAgICAg\nICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICBwdWJs\naWMgQWJzdHJhY3RUZXN0Q2FzZSgpIHsKICAgIH0KCiAgICBwdWJsaWMgQWJz\ndHJhY3RUZXN0Q2FzZShTdHJpbmcgbmFtZSkgewogICAgICAgIHNldE5hbWUo\nbmFtZSk7CiAgICB9CgogICAgcHJvdGVjdGVkIFN0cmluZyBjb21wdXRlUGVy\nc2lzdGVuY2VYbWxSZXNvdXJjZShTdHJpbmcgcykgewogICAgICAgIFN0cmlu\nZyByZXNvdXJjZU5hbWUgPSBnZXRDbGFzcygpLmdldFBhY2thZ2UoKS5nZXRO\nYW1lKCkKICAgICAgICAgICAgLnJlcGxhY2VBbGwoIlxcLiIsICIvIik7CiAg\nICAgICAgcmVzb3VyY2VOYW1lICs9ICIvY29tbW9uL2FwcHMvTUVUQS1JTkYv\ncGVyc2lzdGVuY2UueG1sIjsKICAgICAgICBVUkwgcmVzb3VyY2UgPSBnZXRD\nbGFzcygpLmdldENsYXNzTG9hZGVyKCkuZ2V0UmVzb3VyY2UocmVzb3VyY2VO\nYW1lKTsKICAgICAgICBpZiAocmVzb3VyY2UgIT0gbnVsbCkKICAgICAgICAg\nICAgcmV0dXJuIHJlc291cmNlTmFtZTsKICAgICAgICByZXR1cm4gZGVmYXVs\ndFBlcnNpc3RlbmNlWG1sUmVzb3VyY2UoKTsKICAgIH0KCiAgICBwcm90ZWN0\nZWQgU3RyaW5nIGRlZmF1bHRQZXJzaXN0ZW5jZVhtbFJlc291cmNlKCkgewog\nICAgICAgIHJldHVybiAib3JnL2FwYWNoZS9vcGVuanBhL3BlcnNpc3RlbmNl\nLyIgKwogICAgICAgICAgICAiY29tbW9uL2FwcHMvTUVUQS1JTkYvcGVyc2lz\ndGVuY2UueG1sIjsKICAgIH0KCiAgICBwcm90ZWN0ZWQgT3BlbkpQQVN0YXRl\nTWFuYWdlciBnZXRTdGF0ZU1hbmFnZXIoT2JqZWN0IG9iaiwKICAgICAgICBF\nbnRpdHlNYW5hZ2VyIGVtKSB7CiAgICAgICAgcmV0dXJuIEpQQUZhY2FkZUhl\nbHBlci50b0Jyb2tlcihlbSkuZ2V0U3RhdGVNYW5hZ2VyKG9iaik7CiAgICB9\nCgogICAgcHJvdGVjdGVkIGludCBkZWxldGVBbGwoQ2xhc3MgdHlwZSwgRW50\naXR5TWFuYWdlciBlbSkgewogICAgICAgIENsYXNzTWV0YURhdGEgbWV0YSA9\nIEpQQUZhY2FkZUhlbHBlci5nZXRNZXRhRGF0YShlbSwgdHlwZSk7CiAgICAg\nICAgaWYgKG1ldGEgIT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIGVtLmNy\nZWF0ZVF1ZXJ5KCJkZWxldGUgZnJvbSAiICsgbWV0YS5nZXRUeXBlQWxpYXMo\nKSkKICAgICAgICAgICAgICAgIC5leGVjdXRlVXBkYXRlKCk7CiAgICAgICAg\nZWxzZQogICAgICAgICAgICByZXR1cm4gLTE7CiAgICB9CgogICAgcHJvdGVj\ndGVkIGludCBkZWxldGVBbGwoQ2xhc3MuLi4gdHlwZXMpIHsKICAgICAgICBF\nbnRpdHlNYW5hZ2VyIGVtID0gZ2V0RW1mKCkuY3JlYXRlRW50aXR5TWFuYWdl\ncigpOwogICAgICAgIGVtLmdldFRyYW5zYWN0aW9uKCkuYmVnaW4oKTsKICAg\nICAgICBpbnQgcmV0ID0gMDsKICAgICAgICBmb3IgKENsYXNzIHR5cGUgOiB0\neXBlcykKICAgICAgICAgICAgcmV0ICs9IGRlbGV0ZUFsbCh0eXBlLCBlbSk7\nCiAgICAgICAgZW0uZ2V0VHJhbnNhY3Rpb24oKS5jb21taXQoKTsKICAgICAg\nICBlbS5jbG9zZSgpOwogICAgICAgIHJldHVybiByZXQ7CiAgICB9CgogICAg\ncHJvdGVjdGVkIE9wZW5KUEFFbnRpdHlNYW5hZ2VyRmFjdG9yeSBnZXRFbWYo\nTWFwIG1hcCkgewogICAgICAgIGlmIChtYXAgPT0gbnVsbCkKICAgICAgICAg\nICAgbWFwID0gbmV3IEhhc2hNYXAoKTsKICAgICAgICBDb2xsZWN0aW9uIGtl\neXMgPSBuZXcgQXJyYXlMaXN0KCk7CiAgICAgICAgZm9yIChPYmplY3Qga2V5\nIDogbWFwLmtleVNldCgpKQogICAgICAgICAgICBpZiAoa2V5LnRvU3RyaW5n\nKCkuc3RhcnRzV2l0aCgia29kbyIpKQogICAgICAgICAgICAgICAga2V5cy5h\nZGQoa2V5KTsKICAgICAgICBpZiAoa2V5cy5zaXplKCkgPiAwKQogICAgICAg\nICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uKAogICAg\nICAgICAgICAgICAgImtvZG8tcHJlZml4ZWQgcHJvcGVydGllcyBtdXN0IGJl\nIGNvbnZlcnRlZCB0byBvcGVuanBhLiAiICsKICAgICAgICAgICAgICAgICAg\nICAiUHJvcGVydGllczogIiArIGtleXMpOwoKICAgICAgICBhZGRQcm9wZXJ0\naWVzKG1hcCk7CgogICAgICAgIE9wZW5KUEFFbnRpdHlNYW5hZ2VyRmFjdG9y\neSBlbWYgPSBlbWZzLmdldChtYXApOwogICAgICAgIGlmIChlbWYgIT0gbnVs\nbCkgewogICAgICAgICAgICByZXR1cm4gZW1mOwogICAgICAgIH0KCiAgICAg\nICAgaWYgKHByb3BzICE9IG51bGwpIHsKICAgICAgICAgICAgLy8gSm9pbiBw\ncm9wZXJ0aWVzIHBhc3NlZCBpbiBzZXRVcCAodXN1YWxseSBlbnRpdGllcykg\nd2l0aCB0aGUgZ2l2ZW4gbWFwIGFuZCB1c2UgdGhlbSB0byBjcmVhdGUgRU1G\nLgogICAgICAgICAgICBPYmplY3RbXSBwcm9wc0FuZE1hcCA9IG5ldyBPYmpl\nY3RbcHJvcHMubGVuZ3RoICsgbWFwLnNpemUoKSAqIDJdOwogICAgICAgICAg\nICBTeXN0ZW0uYXJyYXljb3B5KHByb3BzLCAwLCBwcm9wc0FuZE1hcCwgMCwg\ncHJvcHMubGVuZ3RoKTsKICAgICAgICAgICAgaW50IGkgPSBwcm9wcy5sZW5n\ndGg7CiAgICAgICAgICAgIGZvciAoT2JqZWN0IG8gOiBtYXAuZW50cnlTZXQo\nKSkgewogICAgICAgICAgICAgICAgRW50cnkgbWFwRW50cnkgPSAoRW50cnkp\nIG87CiAgICAgICAgICAgICAgICBwcm9wc0FuZE1hcFtpKytdID0gbWFwRW50\ncnkuZ2V0S2V5KCk7CiAgICAgICAgICAgICAgICBwcm9wc0FuZE1hcFtpKytd\nID0gbWFwRW50cnkuZ2V0VmFsdWUoKTsKICAgICAgICAgICAgfQogICAgICAg\nICAgICBlbWYgPSBjcmVhdGVFTUYocHJvcHNBbmRNYXApOwogICAgICAgIH0g\nZWxzZSB7CiAgICAgICAgICAgIGVtZiA9IE9wZW5KUEFQZXJzaXN0ZW5jZS5j\ncmVhdGVFbnRpdHlNYW5hZ2VyRmFjdG9yeSgiVGVzdENvbnYiLCBwZXJzaXN0\nZW5jZVhtbFJlc291cmNlLCBtYXApOwogICAgICAgIH0KICAgICAgICBlbWZz\nLnB1dChtYXAsIGVtZik7CiAgICAgICAgcmV0dXJuIGVtZjsKICAgIH0KCiAg\nICBwcm90ZWN0ZWQgdm9pZCBhZGRQcm9wZXJ0aWVzKE1hcCBtYXApIHsKICAg\nICAgICBpZiAoIW1hcC5jb250YWluc0tleSgib3BlbmpwYS5qZGJjLlN5bmNo\ncm9uaXplTWFwcGluZ3MiKSkKICAgICAgICAgICAgbWFwLnB1dCgib3Blbmpw\nYS5qZGJjLlN5bmNocm9uaXplTWFwcGluZ3MiLAogICAgICAgICAgICAgICAg\nImJ1aWxkU2NoZW1hKEZvcmVpZ25LZXlzPXRydWUsIiArCiAgICAgICAgICAg\nICAgICAgICAgIlNjaGVtYUFjdGlvbj0nYWRkLGRlbGV0ZVRhYmxlQ29udGVu\ndHMnKSIpOwogICAgfQoKICAgIHByb3RlY3RlZCBPcGVuSlBBRW50aXR5TWFu\nYWdlckZhY3RvcnkgZ2V0RW1mKCkgewogICAgICAgIE1hcCBtID0gbmV3IEhh\nc2hNYXAoKTsKICAgICAgICByZXR1cm4gZ2V0RW1mKG0pOwogICAgfQoKICAg\nIHByb3RlY3RlZCBCcm9rZXJGYWN0b3J5IGdldEJyb2tlckZhY3RvcnkoKSB7\nCiAgICAgICAgcmV0dXJuIEpQQUZhY2FkZUhlbHBlci50b0Jyb2tlckZhY3Rv\ncnkoZ2V0RW1mKCkpOwogICAgfQoKICAgIHByb3RlY3RlZCBCcm9rZXJGYWN0\nb3J5IGdldEJyb2tlckZhY3RvcnkoU3RyaW5nW10gYXJncykgewogICAgICAg\nIGlmIChhcmdzLmxlbmd0aCAlIDIgIT0gMCkKICAgICAgICAgICAgdGhyb3cg\nbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbigKICAgICAgICAgICAgICAg\nICJvZGQgbnVtYmVyIG9mIGVsZW1lbnRzIGluIGFyZyBhcnJheSIpOwogICAg\nICAgIE1hcCBtYXAgPSBuZXcgSGFzaE1hcCgpOwogICAgICAgIGZvciAoaW50\nIGkgPSAwOyBpIDwgYXJncy5sZW5ndGg7IGkgPSBpICsgMikKICAgICAgICAg\nICAgbWFwLnB1dChhcmdzW2ldLCBhcmdzW2krMV0pOwogICAgICAgIHJldHVy\nbiBKUEFGYWNhZGVIZWxwZXIudG9Ccm9rZXJGYWN0b3J5KGdldEVtZihtYXAp\nKTsKICAgIH0KCiAgICBwcm90ZWN0ZWQgT3BlbkpQQUVudGl0eU1hbmFnZXIg\nY3VycmVudEVudGl0eU1hbmFnZXIoKSB7CiAgICAgICAgaWYgKGN1cnJlbnRF\nbnRpdHlNYW5hZ2VyID09IG51bGwgfHwgIWN1cnJlbnRFbnRpdHlNYW5hZ2Vy\nLmlzT3BlbigpKQogICAgICAgICAgICBjdXJyZW50RW50aXR5TWFuYWdlciA9\nIGdldEVtZigpLmNyZWF0ZUVudGl0eU1hbmFnZXIoKTsKICAgICAgICByZXR1\ncm4gY3VycmVudEVudGl0eU1hbmFnZXI7CiAgICB9CgogICAgcHJvdGVjdGVk\nIHZvaWQgc3RhcnRUeChFbnRpdHlNYW5hZ2VyIGVtKSB7CiAgICAgICAgZW0u\nZ2V0VHJhbnNhY3Rpb24oKS5iZWdpbigpOwogICAgfQoKICAgIHByb3RlY3Rl\nZCBib29sZWFuIGlzQWN0aXZlVHgoRW50aXR5TWFuYWdlciBlbSkgewogICAg\nICAgIHJldHVybiBlbS5nZXRUcmFuc2FjdGlvbigpLmlzQWN0aXZlKCk7CiAg\nICB9CgogICAgcHJvdGVjdGVkIHZvaWQgZW5kVHgoRW50aXR5TWFuYWdlciBl\nbSkgewogICAgICAgIGlmIChlbS5nZXRUcmFuc2FjdGlvbigpLmlzQWN0aXZl\nKCkpIHsKICAgICAgICAgICAgaWYgKGVtLmdldFRyYW5zYWN0aW9uKCkuZ2V0\nUm9sbGJhY2tPbmx5KCkpCiAgICAgICAgICAgICAgICBlbS5nZXRUcmFuc2Fj\ndGlvbigpLnJvbGxiYWNrKCk7CiAgICAgICAgICAgIGVsc2UKICAgICAgICAg\nICAgICAgIGVtLmdldFRyYW5zYWN0aW9uKCkuY29tbWl0KCk7CiAgICAgICAg\nfQogICAgfQoKICAgIHByb3RlY3RlZCB2b2lkIHJvbGxiYWNrVHgoRW50aXR5\nTWFuYWdlciBlbSkgewogICAgICAgIGVtLmdldFRyYW5zYWN0aW9uKCkucm9s\nbGJhY2soKTsKICAgIH0KCiAgICBwcm90ZWN0ZWQgdm9pZCBlbmRFbShFbnRp\ndHlNYW5hZ2VyIGVtKSB7CiAgICAgICAgaWYgKGVtLmlzT3BlbigpKQogICAg\nICAgICAgICBlbS5jbG9zZSgpOwogICAgICAgIGlmIChlbSA9PSBjdXJyZW50\nRW50aXR5TWFuYWdlcikKICAgICAgICBjdXJyZW50RW50aXR5TWFuYWdlciA9\nIG51bGw7CiAgICB9CgogICAgcHJvdGVjdGVkIE9iamVjdCBnZXRTdGFja1Ry\nYWNlKFRocm93YWJsZSB0KSB7CiAgICAgICAgdGhyb3cgbmV3IFVuc3VwcG9y\ndGVkT3BlcmF0aW9uRXhjZXB0aW9uKCk7CiAgICB9CgogICAgcHJvdGVjdGVk\nIE9wZW5KUEFDb25maWd1cmF0aW9uIGdldENvbmZpZ3VyYXRpb24oKSB7CiAg\nICAgICAgcmV0dXJuIGdldEVtZigpLmdldENvbmZpZ3VyYXRpb24oKTsKICAg\nIH0KCiAgICBwcm90ZWN0ZWQgUGxhdGZvcm0gZ2V0Q3VycmVudFBsYXRmb3Jt\nKCkgewogICAgICAgIHRocm93IG5ldyBVbnN1cHBvcnRlZE9wZXJhdGlvbkV4\nY2VwdGlvbigpOwogICAgfQoKICAgIHByb3RlY3RlZCB2b2lkIGJ1ZyhpbnQg\naWQsIFN0cmluZyBzKSB7CiAgICAgICAgYnVnKGlkLCBudWxsLCBzKTsKICAg\nIH0KICAgIAogICAgcHJvdGVjdGVkIHZvaWQgYnVnKFBsYXRmb3JtIHBsYXRm\nb3JtLCBpbnQgaWQsIFRocm93YWJsZSB0LCBTdHJpbmcgcykgewogICAgICAg\nIGJ1ZyhFbnVtU2V0Lm9mKHBsYXRmb3JtKSwgaWQsIHQsIHMpOwogICAgfQoK\nICAgIHByb3RlY3RlZCB2b2lkIGJ1ZyhFbnVtU2V0PFBsYXRmb3JtPiBwbGF0\nZm9ybXMsIGludCBpZCwgVGhyb3dhYmxlIHQsCiAgICAgICAgICAgIFN0cmlu\nZyBzKSB7CiAgICAgICAgaWYgKHBsYXRmb3Jtcy5jb250YWlucyhnZXRDdXJy\nZW50UGxhdGZvcm0oKSkpCiAgICAgICAgICAgIGJ1ZyhpZCwgdCwgcyk7CiAg\nICAgICAgZWxzZQogICAgICAgICAgICBmYWlsKFN0cmluZy5mb3JtYXQoCiAg\nICAgICAgICAgICAgICAiYnVnICVzIGlzIHVuZXhwZWN0ZWRseSBvY2N1cnJp\nbmcgb24gcGxhdGZvcm0gJXMiLAogICAgICAgICAgICAgICAgaWQsIGdldEN1\ncnJlbnRQbGF0Zm9ybSgpKSk7CiAgICB9CgogICAgcHJvdGVjdGVkIHZvaWQg\nYnVnKGludCBpZCwgVGhyb3dhYmxlIHQsIFN0cmluZyBzKSB7CiAgICAgICAg\naWYgKHQgIT0gbnVsbCkgewogICAgICAgICAgICBpZiAodCBpbnN0YW5jZW9m\nIFJ1bnRpbWVFeGNlcHRpb24pCiAgICAgICAgICAgICAgICB0aHJvdyAoUnVu\ndGltZUV4Y2VwdGlvbikgdDsKICAgICAgICAgICAgZWxzZQogICAgICAgICAg\nICAgICAgdGhyb3cgbmV3IFJ1bnRpbWVFeGNlcHRpb24odCk7CiAgICAgICAg\nfSBlbHNlIHsKICAgICAgICAgICAgZmFpbChzKTsKICAgICAgICB9CiAgICB9\nCgogICAgLyoqCiAgICAgKiBTdXBwb3J0IG1ldGhvZCB0byBnZXQgYSByYW5k\nb20gSW50ZWdlciBmb3IgdGVzdGluZy4KICAgICAqLwogICAgcHVibGljIHN0\nYXRpYyBJbnRlZ2VyIHJhbmRvbUludCgpIHsKICAgICAgICByZXR1cm4gbmV3\nIEludGVnZXIoKGludCkgKE1hdGgucmFuZG9tKCkgKiBJbnRlZ2VyLk1BWF9W\nQUxVRSkpOwogICAgfQoKICAgIC8qKgogICAgICogU3VwcG9ydCBtZXRob2Qg\ndG8gZ2V0IGEgcmFuZG9tIENoYXJhY3RlciBmb3IgdGVzdGluZy4KICAgICAq\nLwogICAgcHVibGljIHN0YXRpYyBDaGFyYWN0ZXIgcmFuZG9tQ2hhcigpIHsK\nICAgICAgICBjaGFyIFtdIFRFU1RfQ0hBUl9BUlJBWSA9IG5ldyBjaGFyIFtd\newogICAgICAgICAgICAnYScsICdiJywgJ2MnLCAnZCcsICdlJywgJ2YnLCAn\nZycsICdoJywgJ2knLAogICAgICAgICAgICAnaicsICdrJywgJ2wnLCAnbScs\nICduJywgJ28nLCAncCcsICdxJywgJ3InLAogICAgICAgICAgICAncycsICd0\nJywgJ3UnLCAndicsICd3JywgJ3gnLCAneScsICd6JywgJzEnLAogICAgICAg\nICAgICAnMicsICczJywgJzQnLCAnNScsICc2JywgJzcnLCAnOCcsICc5JyB9\nOwoKICAgICAgICByZXR1cm4gbmV3IENoYXJhY3RlcihURVNUX0NIQVJfQVJS\nQVlbCiAgICAgICAgICAgICAgICAoaW50KSAoTWF0aC5yYW5kb20oKSAqIFRF\nU1RfQ0hBUl9BUlJBWS5sZW5ndGgpXSk7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBTdXBwb3J0IG1ldGhvZCB0byBnZXQgYSByYW5kb20gTG9uZyBmb3IgdGVz\ndGluZy4KICAgICAqLwogICAgcHVibGljIHN0YXRpYyBMb25nIHJhbmRvbUxv\nbmcoKSB7CiAgICAgICAgcmV0dXJuIG5ldyBMb25nKChsb25nKSAoTWF0aC5y\nYW5kb20oKSAqIExvbmcuTUFYX1ZBTFVFKSk7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBTdXBwb3J0IG1ldGhvZCB0byBnZXQgYSByYW5kb20gU2hvcnQgZm9y\nIHRlc3RpbmcuCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0aWMgU2hvcnQgcmFu\nZG9tU2hvcnQoKSB7CiAgICAgICAgcmV0dXJuIG5ldyBTaG9ydCgoc2hvcnQp\nIChNYXRoLnJhbmRvbSgpICogU2hvcnQuTUFYX1ZBTFVFKSk7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBTdXBwb3J0IG1ldGhvZCB0byBnZXQgYSByYW5kb20g\nRG91YmxlIGZvciB0ZXN0aW5nLgogICAgICovCiAgICBwdWJsaWMgc3RhdGlj\nIERvdWJsZSByYW5kb21Eb3VibGUoKSB7CiAgICAgICAgcmV0dXJuIG5ldyBE\nb3VibGUoKGRvdWJsZSkgKE1hdGgucm91bmQoTWF0aC5yYW5kb20oKSAqIDUw\nMDBkKSkgLyAxMDAwZCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBTdXBwb3J0\nIG1ldGhvZCB0byBnZXQgYSByYW5kb20gRmxvYXQgZm9yIHRlc3RpbmcuCiAg\nICAgKi8KICAgIHB1YmxpYyBzdGF0aWMgRmxvYXQgcmFuZG9tRmxvYXQoKSB7\nCiAgICAgICAgcmV0dXJuIG5ldyBGbG9hdCgoZmxvYXQpIChNYXRoLnJvdW5k\nKE1hdGgucmFuZG9tKCkgKiA1MDAwZikpIC8gMTAwMGYpOwogICAgfQoKICAg\nIC8qKgogICAgICogU3VwcG9ydCBtZXRob2QgdG8gZ2V0IGEgcmFuZG9tIEJ5\ndGUgZm9yIHRlc3RpbmcuCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0aWMgQnl0\nZSByYW5kb21CeXRlKCkgewogICAgICAgIHJldHVybiBuZXcgQnl0ZSgoYnl0\nZSkgKE1hdGgucmFuZG9tKCkgKiBCeXRlLk1BWF9WQUxVRSkpOwogICAgfQoK\nICAgIC8qKgogICAgICogU3VwcG9ydCBtZXRob2QgdG8gZ2V0IGEgcmFuZG9t\nIEJvb2xlYW4gZm9yIHRlc3RpbmcuCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0\naWMgQm9vbGVhbiByYW5kb21Cb29sZWFuKCkgewogICAgICAgIHJldHVybiBu\nZXcgQm9vbGVhbihNYXRoLnJhbmRvbSgpID4gMC41ID8gdHJ1ZSA6IGZhbHNl\nKTsKICAgIH0KCiAgICAvKioKICAgICAqIFN1cHBvcnQgbWV0aG9kIHRvIGdl\ndCBhIHJhbmRvbSBEYXRlIGZvciB0ZXN0aW5nLgogICAgICovCiAgICBwdWJs\naWMgc3RhdGljIERhdGUgcmFuZG9tRGF0ZSgpIHsKICAgICAgICBsb25nIG1p\nbGxpcyA9IChsb25nKSAoTWF0aC5yYW5kb20oKSAqIFN5c3RlbS5jdXJyZW50\nVGltZU1pbGxpcygpKTsKCiAgICAgICAgLy8gcm91bmQgbWlsbGlzIHRvIHRo\nZSBuZWFyZXN0IDEwMDA6IHRoaXMgaXMgYmVjYXVzZSBzb21lCiAgICAgICAg\nLy8gZGF0YWJhc2VzIGRvIG5vdCBzdG9yZSB0aGUgbWlsbGlzZWNvbmRzIGNv\ncnJlY3RseSAoZS5nLiwgTXlTUUwpLgogICAgICAgIC8vIFRoaXMgaXMgYSBy\nZWFsbHkgYSBidWcgd2Ugc2hvdWxkIGZpeC4gRkMgIzI3LgogICAgICAgIG1p\nbGxpcyAtPSAobWlsbGlzICUgMTAwMCk7CgogICAgICAgIHJldHVybiBuZXcg\nRGF0ZShtaWxsaXMpOwogICAgfQoKICAgIC8qKgogICAgICogU3VwcG9ydCBt\nZXRob2QgdG8gZ2V0IGEgcmFuZG9tIFN0cmluZyBmb3IgdGVzdGluZy4KICAg\nICAqLwogICAgcHVibGljIHN0YXRpYyBTdHJpbmcgcmFuZG9tU3RyaW5nKCkg\newogICAgICAgIC8vIGRlZmF1bHQgdG8gYSBzbWFsbCBzdHJpbmcsIGluIGNh\nc2UgY29sdW1uIHNpemVzIGFyZQogICAgICAgIC8vIGxpbWl0ZWQgKHN1Y2gg\nYXMgd2l0aCBhIHN0cmluZyBwcmltYXJ5IGtleSkKICAgICAgICByZXR1cm4g\ncmFuZG9tU3RyaW5nKDUwKTsKICAgIH0KCiAgICAvKioKICAgICAqIFN1cHBv\ncnQgbWV0aG9kIHRvIGdldCBhIHJhbmRvbSBTdHJpbmcgZm9yIHRlc3Rpbmcu\nCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0aWMgU3RyaW5nIHJhbmRvbVN0cmlu\nZyhpbnQgbGVuKSB7CiAgICAgICAgU3RyaW5nQnVmZmVyIGJ1ZiA9IG5ldyBT\ndHJpbmdCdWZmZXIoKTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IChp\nbnQpIChNYXRoLnJhbmRvbSgpICogbGVuKSArIDE7IGkrKykKICAgICAgICAg\nICAgYnVmLmFwcGVuZChyYW5kb21DaGFyKCkpOwogICAgICAgIHJldHVybiBi\ndWYudG9TdHJpbmcoKTsKICAgIH0KCiAgICAvKioKICAgICAqIFN1cHBvcnQg\nbWV0aG9kIHRvIGdldCBhIHJhbmRvbSBjbG9iIGZvciB0ZXN0aW5nLgogICAg\nICovCiAgICBwdWJsaWMgc3RhdGljIFN0cmluZyByYW5kb21DbG9iKCkgewog\nICAgICAgIFN0cmluZ0J1ZmZlciBzYnVmID0gbmV3IFN0cmluZ0J1ZmZlcigp\nOwogICAgICAgIHdoaWxlIChzYnVmLmxlbmd0aCgpIDwgKDUgKiAxMDI0KSkg\nLy8gYXQgbGVhc3QgNUsKICAgICAgICB7CiAgICAgICAgICAgIHNidWYuYXBw\nZW5kKHJhbmRvbVN0cmluZygxMDI0KSk7CiAgICAgICAgfQoKICAgICAgICBy\nZXR1cm4gc2J1Zi50b1N0cmluZygpOwogICAgfQoKICAgIC8qKgogICAgICog\nU3VwcG9ydCBtZXRob2QgdG8gZ2V0IGEgcmFuZG9tIEJpZ0ludGVnZXIgZm9y\nIHRlc3RpbmcuCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0aWMgQmlnSW50ZWdl\nciByYW5kb21CaWdJbnRlZ2VyKCkgewogICAgICAgIC8vIHRvbyBtYW55IG9m\nIG91ciB0ZXN0IGRhdGFiYXNlcyBkb24ndCBzdXBwb3J0IGJpZ2ludHMgPiBN\nQVhfTE9ORzoKICAgICAgICAvLyBJIGRvbid0IGxpa2UgaXQsIGJ1dCBmb3Ig\nbm93LCBsZXQncyBvbmx5IHRlc3QgYmVsb3cgTUFYX0xPTkcKICAgICAgICBC\naWdJbnRlZ2VyIGxuZyA9IG5ldyBCaWdJbnRlZ2VyKAogICAgICAgICAgICAg\nICAgKChsb25nKSAoTWF0aC5yYW5kb20oKSAqIExvbmcuTUFYX1ZBTFVFKSkg\nKyAiIik7CgogICAgICAgIEJpZ0ludGVnZXIgbXVsdGlwbGllciA9IG5ldyBC\naWdJbnRlZ2VyKCIxIik7CiAgICAgICAgLy8gKDEgKyAoaW50KShNYXRoLnJh\nbmRvbSAoKSAqIDEwMDAwKSkgKyAiIik7CiAgICAgICAgaWYgKE1hdGgucmFu\nZG9tKCkgPCAwLjUpCiAgICAgICAgICAgIG11bHRpcGxpZXIgPSBtdWx0aXBs\naWVyLm11bHRpcGx5KG5ldyBCaWdJbnRlZ2VyKCItMSIpKTsKCiAgICAgICAg\ncmV0dXJuIGxuZy5tdWx0aXBseShtdWx0aXBsaWVyKTsKICAgIH0KCiAgICAv\nKioKICAgICAqIFN1cHBvcnQgbWV0aG9kIHRvIGdldCBhIHJhbmRvbSBCaWdE\nZWNpbWFsIGZvciB0ZXN0aW5nLgogICAgICovCiAgICBwdWJsaWMgc3RhdGlj\nIEJpZ0RlY2ltYWwgcmFuZG9tQmlnRGVjaW1hbCgpIHsKICAgICAgICBCaWdJ\nbnRlZ2VyIHN0YXJ0ID0gcmFuZG9tQmlnSW50ZWdlcigpOwogICAgICAgIFN0\ncmluZyBzdHIgPSBzdGFydC50b1N0cmluZygpOwogICAgICAgIC8vIHRydW5j\nYXRlIG9mZiB0aGUgbGFzdCA4IGRpZ2l0czogd2Ugc3RpbGwgZ2V0IHNvbWUK\nICAgICAgICAvLyBvdmVyZmxvd3Mgd2l0aCBsYW1lIGRhdGFiYXNlcy4KICAg\nICAgICBmb3IgKGludCBpID0gMDsgaSA8IDg7IGkrKykKICAgICAgICAgICAg\naWYgKHN0ci5sZW5ndGgoKSA+IDIpCiAgICAgICAgICAgICAgICBzdHIgPSBz\ndHIuc3Vic3RyaW5nKDAsIHN0ci5sZW5ndGgoKSAtIDEpOwogICAgICAgIHN0\nYXJ0ID0gbmV3IEJpZ0ludGVnZXIoc3RyKTsKCiAgICAgICAgU3RyaW5nIHZh\nbCA9IHN0YXJ0ICsgIi4iCiAgICAgICAgICAgICAgICArICgoaW50KSAoTWF0\naC5yYW5kb20oKSAqIDEwKSkKICAgICAgICAgICAgICAgICsgKChpbnQpIChN\nYXRoLnJhbmRvbSgpICogMTApKQogICAgICAgICAgICAgICAgKyAoKGludCkg\nKE1hdGgucmFuZG9tKCkgKiAxMCkpCiAgICAgICAgICAgICAgICArICgoaW50\nKSAoTWF0aC5yYW5kb20oKSAqIDEwKSkKICAgICAgICAgICAgICAgICsgKChp\nbnQpIChNYXRoLnJhbmRvbSgpICogMTApKQogICAgICAgICAgICAgICAgKyAo\nKGludCkgKE1hdGgucmFuZG9tKCkgKiAxMCkpCiAgICAgICAgICAgICAgICAr\nICgoaW50KSAoTWF0aC5yYW5kb20oKSAqIDEwKSkKICAgICAgICAgICAgICAg\nICsgKChpbnQpIChNYXRoLnJhbmRvbSgpICogMTApKQogICAgICAgICAgICAg\nICAgKyAoKGludCkgKE1hdGgucmFuZG9tKCkgKiAxMCkpCiAgICAgICAgICAg\nICAgICArICgoaW50KSAoTWF0aC5yYW5kb20oKSAqIDEwKSk7CgogICAgICAg\nIHJldHVybiBuZXcgQmlnRGVjaW1hbCh2YWwpOwogICAgfQoKICAgIC8qKgog\nICAgICogU3VwcG9ydCBtZXRob2QgdG8gZ2V0IGEgcmFuZG9tIGJsb2IgZm9y\nIHRlc3RpbmcuCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0aWMgYnl0ZVtdIHJh\nbmRvbUJsb2IoKSB7CiAgICAgICAgLy8gdXAgdG8gMTAwSyBibG9iCiAgICAg\nICAgYnl0ZSBbXSBibG9iID0gbmV3IGJ5dGUgWyhpbnQpIChNYXRoLnJhbmRv\nbSgpICogMTAyNCAqIDEwMCldOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBp\nIDwgYmxvYi5sZW5ndGg7IGkrKykKICAgICAgICAgICAgYmxvYltpXSA9IHJh\nbmRvbUJ5dGUoKS5ieXRlVmFsdWUoKTsKCiAgICAgICAgcmV0dXJuIGJsb2I7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBJbnZva2Ugc2V0dGVycyBmb3IgcGlt\naXRpdmVzIGFuZCBwcmltaXRpdmUgd3JhcHBlcnMgb24gdGhlCiAgICAgKiBz\ncGVjaWZpZWQgb2JqZWN0LgogICAgICovCiAgICBwdWJsaWMgc3RhdGljIE9i\namVjdCByYW5kb21pemVCZWFuKE9iamVjdCBiZWFuKQogICAgdGhyb3dzIElu\ndHJvc3BlY3Rpb25FeGNlcHRpb24sIElsbGVnYWxBY2Nlc3NFeGNlcHRpb24s\nCiAgICAgICAgSW52b2NhdGlvblRhcmdldEV4Y2VwdGlvbiwgamF2YS5iZWFu\ncy5JbnRyb3NwZWN0aW9uRXhjZXB0aW9uIHsKICAgICAgICBCZWFuSW5mbyBp\nbmZvID0gSW50cm9zcGVjdG9yLmdldEJlYW5JbmZvKGJlYW4uZ2V0Q2xhc3Mo\nKSk7CiAgICAgICAgUHJvcGVydHlEZXNjcmlwdG9yW10gcHJvcHMgPSBpbmZv\nLmdldFByb3BlcnR5RGVzY3JpcHRvcnMoKTsKICAgICAgICBmb3IgKGludCBp\nID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIE1l\ndGhvZCB3cml0ZSA9IHByb3BzW2ldLmdldFdyaXRlTWV0aG9kKCk7CiAgICAg\nICAgICAgIGlmICh3cml0ZSA9PSBudWxsKQogICAgICAgICAgICAgICAgY29u\ndGludWU7CgogICAgICAgICAgICBDbGFzcyBbXSBwYXJhbXMgPSB3cml0ZS5n\nZXRQYXJhbWV0ZXJUeXBlcygpOwogICAgICAgICAgICBpZiAocGFyYW1zID09\nIG51bGwgfHwgcGFyYW1zLmxlbmd0aCAhPSAxKQogICAgICAgICAgICAgICAg\nY29udGludWU7CgogICAgICAgICAgICBDbGFzcyBwYXJhbVR5cGUgPSBwYXJh\nbXNbMF07CiAgICAgICAgICAgIE9iamVjdCBhcmcgPSBudWxsOwoKICAgICAg\nICAgICAgaWYgKHBhcmFtVHlwZSA9PSBib29sZWFuLmNsYXNzIHx8IHBhcmFt\nVHlwZSA9PSBCb29sZWFuLmNsYXNzKQogICAgICAgICAgICAgICAgYXJnID0g\ncmFuZG9tQm9vbGVhbigpOwogICAgICAgICAgICBlbHNlIGlmIChwYXJhbVR5\ncGUgPT0gYnl0ZS5jbGFzcyB8fCBwYXJhbVR5cGUgPT0gQnl0ZS5jbGFzcykK\nICAgICAgICAgICAgICAgIGFyZyA9IHJhbmRvbUJ5dGUoKTsKICAgICAgICAg\nICAgZWxzZSBpZiAocGFyYW1UeXBlID09IGNoYXIuY2xhc3MgfHwgcGFyYW1U\neXBlID09IENoYXJhY3Rlci5jbGFzcykKICAgICAgICAgICAgICAgIGFyZyA9\nIHJhbmRvbUNoYXIoKTsKICAgICAgICAgICAgZWxzZSBpZiAocGFyYW1UeXBl\nID09IHNob3J0LmNsYXNzIHx8IHBhcmFtVHlwZSA9PSBTaG9ydC5jbGFzcykK\nICAgICAgICAgICAgICAgIGFyZyA9IHJhbmRvbVNob3J0KCk7CiAgICAgICAg\nICAgIGVsc2UgaWYgKHBhcmFtVHlwZSA9PSBpbnQuY2xhc3MgfHwgcGFyYW1U\neXBlID09IEludGVnZXIuY2xhc3MpCiAgICAgICAgICAgICAgICBhcmcgPSBy\nYW5kb21JbnQoKTsKICAgICAgICAgICAgZWxzZSBpZiAocGFyYW1UeXBlID09\nIGxvbmcuY2xhc3MgfHwgcGFyYW1UeXBlID09IExvbmcuY2xhc3MpCiAgICAg\nICAgICAgICAgICBhcmcgPSByYW5kb21Mb25nKCk7CiAgICAgICAgICAgIGVs\nc2UgaWYgKHBhcmFtVHlwZSA9PSBkb3VibGUuY2xhc3MgfHwgcGFyYW1UeXBl\nID09IERvdWJsZS5jbGFzcykKICAgICAgICAgICAgICAgIGFyZyA9IHJhbmRv\nbURvdWJsZSgpOwogICAgICAgICAgICBlbHNlIGlmIChwYXJhbVR5cGUgPT0g\nZmxvYXQuY2xhc3MgfHwgcGFyYW1UeXBlID09IEZsb2F0LmNsYXNzKQogICAg\nICAgICAgICAgICAgYXJnID0gcmFuZG9tRmxvYXQoKTsKICAgICAgICAgICAg\nZWxzZSBpZiAocGFyYW1UeXBlID09IFN0cmluZy5jbGFzcykKICAgICAgICAg\nICAgICAgIGFyZyA9IHJhbmRvbVN0cmluZygpOwogICAgICAgICAgICBlbHNl\nIGlmIChwYXJhbVR5cGUgPT0gQmlnSW50ZWdlci5jbGFzcykKICAgICAgICAg\nICAgICAgIGFyZyA9IHJhbmRvbUJpZ0ludGVnZXIoKTsKICAgICAgICAgICAg\nZWxzZSBpZiAocGFyYW1UeXBlID09IEJpZ0RlY2ltYWwuY2xhc3MpCiAgICAg\nICAgICAgICAgICBhcmcgPSByYW5kb21CaWdEZWNpbWFsKCk7CiAgICAgICAg\nICAgIGVsc2UgaWYgKHBhcmFtVHlwZSA9PSBEYXRlLmNsYXNzKQogICAgICAg\nICAgICAgICAgYXJnID0gcmFuZG9tRGF0ZSgpOwoKICAgICAgICAgICAgaWYg\nKGFyZyAhPSBudWxsKQogICAgICAgICAgICAgICAgd3JpdGUuaW52b2tlKGJl\nYW4sIG5ldyBPYmplY3QgW117IGFyZyB9KTsKICAgICAgICB9CgogICAgICAg\nIHJldHVybiBiZWFuOwogICAgfQoKICAgIHByb3RlY3RlZCB2b2lkIGFzc2Vy\ndFNpemUoaW50IHNpemUsIENvbGxlY3Rpb24gYykgewogICAgICAgIGFzc2Vy\ndEVxdWFscyhzaXplLCBjLnNpemUoKSk7CiAgICB9CgogICAgcHJvdGVjdGVk\nIHZvaWQgYXNzZXJ0U2l6ZShpbnQgc2l6ZSwgUXVlcnkgcSkgewogICAgICAg\nIGFzc2VydEVxdWFscyhzaXplLCBxLmdldFJlc3VsdExpc3QoKS5zaXplKCkp\nOwogICAgfQoKICAgIC8qKgogICAgICogU2VyaWFsaXplIGFuZCBkZXNlcmlh\nbGl6ZSB0aGUgb2JqZWN0LgogICAgICoKICAgICAqIEBwYXJhbSB2YWxpZGF0\nZUVxdWFsaXR5IG1ha2Ugc3VyZSB0aGUgaGFzaENvZGUgYW5kIGVxdWFscwog\nICAgICogbWV0aG9kcyBob2xkIHRydWUKICAgICAqLwogICAgcHVibGljIHN0\nYXRpYyBPYmplY3Qgcm91bmR0cmlwKE9iamVjdCBvcmlnLCBib29sZWFuIHZh\nbGlkYXRlRXF1YWxpdHkpCiAgICAgICAgdGhyb3dzIElPRXhjZXB0aW9uLCBD\nbGFzc05vdEZvdW5kRXhjZXB0aW9uIHsKICAgICAgICBhc3NlcnROb3ROdWxs\nKG9yaWcpOwoKICAgICAgICBCeXRlQXJyYXlPdXRwdXRTdHJlYW0gYm91dCA9\nIG5ldyBCeXRlQXJyYXlPdXRwdXRTdHJlYW0oKTsKICAgICAgICBPYmplY3RP\ndXRwdXRTdHJlYW0gb3V0ID0gbmV3IE9iamVjdE91dHB1dFN0cmVhbShib3V0\nKTsKICAgICAgICBvdXQud3JpdGVPYmplY3Qob3JpZyk7CiAgICAgICAgQnl0\nZUFycmF5SW5wdXRTdHJlYW0gYmluID0gbmV3IEJ5dGVBcnJheUlucHV0U3Ry\nZWFtKAogICAgICAgICAgICBib3V0LnRvQnl0ZUFycmF5KCkpOwogICAgICAg\nIE9iamVjdElucHV0U3RyZWFtIGluID0gbmV3IE9iamVjdElucHV0U3RyZWFt\nKGJpbik7CiAgICAgICAgT2JqZWN0IHJlc3VsdCA9IGluLnJlYWRPYmplY3Qo\nKTsKCiAgICAgICAgaWYgKHZhbGlkYXRlRXF1YWxpdHkpIHsKICAgICAgICAg\nICAgYXNzZXJ0RXF1YWxzKG9yaWcuaGFzaENvZGUoKSwgcmVzdWx0Lmhhc2hD\nb2RlKCkpOwogICAgICAgICAgICBhc3NlcnRFcXVhbHMob3JpZywgcmVzdWx0\nKTsKICAgICAgICB9CgogICAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBAcmV0dXJuIHRydWUgaWYgdGhlIHNwZWNpZmllZCBp\nbnB1dCBtYXRjaGVzIHRoZSByZWd1bGFyIGV4cHJlc3Npb24gcmVnZXguCiAg\nICAgKi8KICAgIHB1YmxpYyBzdGF0aWMgYm9vbGVhbiBtYXRjaGVzKFN0cmlu\nZyByZWdleCwgU3RyaW5nIGlucHV0KQogICAgICAgIHRocm93cyBSRVN5bnRh\neEV4Y2VwdGlvbiB7CiAgICAgICAgUkUgcmUgPSBSRVV0aWwuY3JlYXRlUkUo\ncmVnZXgpOwogICAgICAgIHJldHVybiByZS5tYXRjaChpbnB1dCk7CiAgICB9\nCgogICAgcHVibGljIHN0YXRpYyB2b2lkIGFzc2VydE1hdGNoZXMoU3RyaW5n\nIHJlZ2V4LCBTdHJpbmcgaW5wdXQpIHsKICAgICAgICB0cnkgewogICAgICAg\nICAgICBpZiAoIShtYXRjaGVzKHJlZ2V4LCBpbnB1dCkpKQogICAgICAgICAg\nICAgICAgZmFpbCgiRXhwZWN0ZWQgcmVndWxhciBleHByZXNzaW9uOiA8IiAr\nIHJlZ2V4ICsgIj4iCiAgICAgICAgICAgICAgICAgICAgKyAiIGRpZCBub3Qg\nbWF0Y2g6IDwiICsgaW5wdXQgKyAiPiIpOwogICAgICAgIH0gY2F0Y2ggKFJF\nU3ludGF4RXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgdGhyb3cgbmV3IEls\nbGVnYWxBcmd1bWVudEV4Y2VwdGlvbihlLnRvU3RyaW5nKCkpOwogICAgICAg\nIH0KICAgIH0KCiAgICBwdWJsaWMgc3RhdGljIHZvaWQgYXNzZXJ0Tm90TWF0\nY2hlcyhTdHJpbmcgcmVnZXgsIFN0cmluZyBpbnB1dCkgewogICAgICAgIHRy\neSB7CiAgICAgICAgICAgIGlmIChtYXRjaGVzKHJlZ2V4LCBpbnB1dCkpCiAg\nICAgICAgICAgICAgICBmYWlsKCJSZWd1bGFyIGV4cHJlc3Npb246IDwiICsg\ncmVnZXggKyAiPiIKICAgICAgICAgICAgICAgICAgICArICIgc2hvdWxkIG5v\ndCBtYXRjaDogPCIgKyBpbnB1dCArICI+Iik7CiAgICAgICAgfSBjYXRjaCAo\nUkVTeW50YXhFeGNlcHRpb24gZSkgewogICAgICAgICAgICB0aHJvdyBuZXcg\nSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uKGUudG9TdHJpbmcoKSk7CiAgICAg\nICAgfQogICAgfQoKICAgIC8qKgogICAgICogQ2hlY2sgdGhlIGxpc3QgaWYg\nc3RyaW5ncyBhbmQgcmV0dXJuIHRoZSBvbmVzIHRoYXQgbWF0Y2gKICAgICAq\nIHRoZSBzcGVjaWZpZWQgbWF0Y2guCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0\naWMgTGlzdCBtYXRjaGVzKFN0cmluZyByZWdleCwgQ29sbGVjdGlvbiBpbnB1\ndCkKICAgICAgICB0aHJvd3MgUkVTeW50YXhFeGNlcHRpb24gewogICAgICAg\nIExpc3QgbWF0Y2hlcyA9IG5ldyBBcnJheUxpc3QoKTsKICAgICAgICBmb3Ig\nKEl0ZXJhdG9yIGkgPSBpbnB1dC5pdGVyYXRvcigpOyBpLmhhc05leHQoKTsp\nIHsKICAgICAgICAgICAgU3RyaW5nIGNoZWNrID0gKFN0cmluZykgaS5uZXh0\nKCk7CiAgICAgICAgICAgIGlmIChtYXRjaGVzKHJlZ2V4LCBjaGVjaykpCiAg\nICAgICAgICAgICAgICBtYXRjaGVzLmFkZChjaGVjayk7CiAgICAgICAgfQoK\nICAgICAgICByZXR1cm4gbWF0Y2hlczsKICAgIH0KCiAgICAvKioKICAgICAq\nIEFzc2VydCB0aGF0IHRoZSBzcGVjaWZpZWQgY29sbGVjdGlvbiBvZiBTdHJp\nbmdzIGNvbnRhaW5zIGF0IGxlYXN0CiAgICAgKiBvbmUgc3RyaW5nIHRoYXQg\nbWF0Y2hlcyB0aGUgc3BlY2lmaWVkIHJlZ3VsYXIgZXhwcmVzc2lvbi4KICAg\nICAqLwogICAgcHVibGljIHN0YXRpYyB2b2lkIGFzc2VydE1hdGNoZXMoU3Ry\naW5nIHJlZ2V4LCBDb2xsZWN0aW9uIGlucHV0KSB7CiAgICAgICAgdHJ5IHsK\nICAgICAgICAgICAgaWYgKG1hdGNoZXMocmVnZXgsIGlucHV0KS5zaXplKCkg\nPT0gMCkKICAgICAgICAgICAgICAgIGZhaWwoIlRoZSBzcGVjaWZpZWQgbGlz\ndCBvZiBzaXplICIgKyBpbnB1dC5zaXplKCkKICAgICAgICAgICAgICAgICAg\nICArICIgZGlkIG5vdCBjb250YWluIGFueSBzdHJpbmdzIHRoYXQgbWF0Y2gg\ndGhlIgogICAgICAgICAgICAgICAgICAgICsgIiBzcGVjaWZpZWQgcmVndWxh\nciBleHByZXNzaW9uKFwiIiArIHJlZ2V4ICsgIlwiKSIpOwogICAgICAgIH0g\nY2F0Y2ggKFJFU3ludGF4RXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgdGhy\nb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbihlLnRvU3RyaW5nKCkp\nOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIEFzc2VydCB0aGF0\nIHRoZSBzcGVjaWZpZWQgY29sbGVjdGlvbiBvZiBTdHJpbmdzIGRvZXMgbm90\nIG1hdGNoCiAgICAgKiB0aGUgc3BlY2lmaWVkIHJlZ3VsYXIgZXhwcmVzc2lv\nbi4KICAgICAqLwogICAgcHVibGljIHN0YXRpYyB2b2lkIGFzc2VydE5vdE1h\ndGNoZXMoU3RyaW5nIHJlZ2V4LCBDb2xsZWN0aW9uIGlucHV0KSB7CiAgICAg\nICAgdHJ5IHsKICAgICAgICAgICAgTGlzdCBtYXRjaGVzOwoKICAgICAgICAg\nICAgaWYgKCgobWF0Y2hlcyA9IG1hdGNoZXMocmVnZXgsIGlucHV0KSkpLnNp\nemUoKSA+IDApCiAgICAgICAgICAgICAgICBmYWlsKCJUaGUgc3BlY2lmaWVk\nIGxpc3Qgb2Ygc2l6ZSAiICsgaW5wdXQuc2l6ZSgpCiAgICAgICAgICAgICAg\nICAgICAgKyAiIGRpZCBjb250YWluIG9uZSBvciBtb3JlIHN0cmluZ3MgdGhh\ndCBtYXRjaHMgdGhlIgogICAgICAgICAgICAgICAgICAgICsgIiBzcGVjaWZp\nZWQgaWxsZWdhbCByZWd1bGFyIGV4cHJlc3Npb24iCiAgICAgICAgICAgICAg\nICAgICAgKyAiIChcIiIgKyByZWdleCArICJcIikuIgogICAgICAgICAgICAg\nICAgICAgICsgIiBGaXJzdCBleGFtcGxlIG9mIGEgbWF0Y2hpbmcgbWVzc2Fn\nZSBpczogIgogICAgICAgICAgICAgICAgICAgICsgbWF0Y2hlcy5pdGVyYXRv\ncigpLm5leHQoKSk7CiAgICAgICAgfSBjYXRjaCAoUkVTeW50YXhFeGNlcHRp\nb24gZSkgewogICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50\nRXhjZXB0aW9uKGUudG9TdHJpbmcoKSk7CiAgICAgICAgfQogICAgfQoKICAg\nIHByb3RlY3RlZCBMb2cgZ2V0TG9nKCkgewogICAgICAgIHJldHVybiBnZXRD\nb25maWd1cmF0aW9uKCkuZ2V0TG9nKCJUZXN0cyIpOwogICAgfQoKICAgIC8v\nLy8vLy8vLy8vLy8vLy8vLy8KICAgIC8vIE11bHRpIHRocmVhZGluZwogICAg\nLy8vLy8vLy8vLy8vLy8vLy8vLwoKICAgIC8qKgogICAgICogUmUtZXhlY3V0\nZSB0aGUgaW52b2tpbmcgbWV0aG9kIGEgcmFuZG9tIG51bWJlciBvZiB0aW1l\ncwogICAgICogaW4gYSByYW5kb20gbnVtYmVyIG9mIFRocmVhZHMuCiAgICAg\nKi8KICAgIHB1YmxpYyB2b2lkIG10dGVzdCgpIHRocm93cyBUaHJlYWRpbmdF\neGNlcHRpb24gewogICAgICAgIC8vIDYgaXRlcmF0aW9ucyBpbiA4IHRocmVh\nZHMgaXMgYSBnb29kIHRyYWRlLW9mZiBiZXR3ZWVuCiAgICAgICAgLy8gdGVz\ndHMgdGFraW5nIHdheSB0b28gbG9uZyBhbmQgaGF2aW5nIGEgZGVjZW50IGNo\nYW5jZSBvZgogICAgICAgIC8vIGlkZW50aWZ5aW5nIE1UIHByb2JsZW1zLgog\nICAgICAgIGludCBpdGVyYXRpb25zID0gNjsKICAgICAgICBpbnQgdGhyZWFk\ncyA9IDg7CgogICAgICAgIG10dGVzdCh0aHJlYWRzLCBpdGVyYXRpb25zKTsK\nICAgIH0KCiAgICAvKioKICAgICAqIEV4ZWN1dGUgdGhlIGNhbGxpbmcgbWV0\naG9kIDxjb2RlPml0ZXJhdGlvbnM8L2NvZGU+CiAgICAgKiB0aW1lcyBpbiA8\nY29kZT50aHJlYWRzPC9jb2RlPiBUaHJlYWRzLgogICAgICovCiAgICBwdWJs\naWMgdm9pZCBtdHRlc3QoaW50IHRocmVhZHMsIGludCBpdGVyYXRpb25zKSB7\nCiAgICAgICAgbXR0ZXN0KDAsIHRocmVhZHMsIGl0ZXJhdGlvbnMpOwogICAg\nfQoKICAgIHB1YmxpYyB2b2lkIG10dGVzdChpbnQgc2VyaWFsQ291bnQsIGlu\ndCB0aHJlYWRzLCBpbnQgaXRlcmF0aW9ucykKICAgICAgICB0aHJvd3MgVGhy\nZWFkaW5nRXhjZXB0aW9uIHsKICAgICAgICBTdHJpbmcgbWV0aG9kTmFtZSA9\nIGNhbGxpbmdNZXRob2QoIm10dGVzdCIpOwogICAgICAgIG10dGVzdChzZXJp\nYWxDb3VudCwgdGhyZWFkcywgaXRlcmF0aW9ucywgbWV0aG9kTmFtZSwgbmV3\nIE9iamVjdCBbMF0pOwogICAgfQoKICAgIC8qKgogICAgICogRXhlY3V0ZSBh\nIHRlc3QgbWV0aG9kIGluIG11bHRpcGxlIHRocmVhZHMuCiAgICAgKgogICAg\nICogQHBhcmFtIHRocmVhZHMgdGhlIG51bWJlciBvZiBUaHJlYWRzIHRvIHJ1\nbiBpbgogICAgICogQHBhcmFtIGl0ZXJhdGlvbnMgdGhlIG51bWJlciBvZiB0\naW1lcyB0aGUgbWV0aG9kIHNob3VsZAogICAgICogYmUgZXhlY3V0ZSBpbiBh\nIHNpbmdsZSBUaHJlYWQKICAgICAqIEBwYXJhbSBtZXRob2QgdGhlIG5hbWUg\nb2YgdGhlIG1ldGhvZCB0byBleGVjdXRlCiAgICAgKiBAcGFyYW0gYXJncyB0\naGUgYXJndW1lbnRzIHRvIHBhc3MgdG8gdGhlIG1ldGhvZAogICAgICogQHRo\ncm93cyBUaHJlYWRpbmdFeGNlcHRpb24gaWYgYW4gZXJyb3JzIG9jY3VyIGlu\nCiAgICAgKiBhbnkgb2YgdGhlIFRocmVhZHMuIFRoZSBhY3R1YWwgZXhjZXB0\naW9ucwogICAgICogd2lsbCBiZSBlbWJlZGRlZCBpbiB0aGUgZXhjZXB0aW9u\nLiBOb3RlIHRoYXQKICAgICAqIHRoaXMgbWVhbnMgdGhhdCBhc3NlcnQoKSBm\nYWlsdXJlcyB3aWxsIGJlCiAgICAgKiB0cmVhdGVkIGFzIGVycm9ycyByYXRo\nZXIgdGhhbiB3YXJuaW5ncy4KICAgICAqIEBhdXRob3IgTWFyYyBQcnVkJ2hv\nbW1lYXV4CiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIG10dGVzdChpbnQgdGhy\nZWFkcywgaW50IGl0ZXJhdGlvbnMsIGZpbmFsIFN0cmluZyBtZXRob2QsCiAg\nICAgICAgZmluYWwgT2JqZWN0IFtdIGFyZ3MpIHRocm93cyBUaHJlYWRpbmdF\neGNlcHRpb24gewogICAgICAgIG10dGVzdCgwLCB0aHJlYWRzLCBpdGVyYXRp\nb25zLCBtZXRob2QsIGFyZ3MpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIG10\ndGVzdChpbnQgc2VyaWFsQ291bnQsCiAgICAgICAgaW50IHRocmVhZHMsIGlu\ndCBpdGVyYXRpb25zLCBmaW5hbCBTdHJpbmcgbWV0aG9kLCBmaW5hbCBPYmpl\nY3QgW10gYXJncykKICAgICAgICB0aHJvd3MgVGhyZWFkaW5nRXhjZXB0aW9u\nIHsKICAgICAgICBpZiAobXVsdGlUaHJlYWRFeGVjdXRpbmcgIT0gbnVsbCAm\nJiBtdWx0aVRocmVhZEV4ZWN1dGluZy5lcXVhbHMobWV0aG9kKSkKICAgICAg\nICB7CiAgICAgICAgICAgIC8vIHdlIGFyZSBjdXJyZW50bHkgZXhlY3V0aW5n\nIGluIG11bHRpLXRocmVhZGVkIG1vZGU6CiAgICAgICAgICAgIC8vIGRvbid0\nIGRlYWRsb2NrIQogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAg\nICAgICBtdWx0aVRocmVhZEV4ZWN1dGluZyA9IG1ldGhvZDsKCiAgICAgICAg\ndHJ5IHsKICAgICAgICAgICAgQ2xhc3MgW10gcGFyYW1DbGFzc2VzID0gbmV3\nIENsYXNzIFthcmdzLmxlbmd0aF07CiAgICAgICAgICAgIGZvciAoaW50IGkg\nPSAwOyBpIDwgcGFyYW1DbGFzc2VzLmxlbmd0aDsgaSsrKQogICAgICAgICAg\nICAgICAgcGFyYW1DbGFzc2VzW2ldID0gYXJnc1tpXS5nZXRDbGFzcygpOwoK\nICAgICAgICAgICAgZmluYWwgTWV0aG9kIG1ldGg7CgogICAgICAgICAgICB0\ncnkgewogICAgICAgICAgICAgICAgbWV0aCA9IGdldENsYXNzKCkuZ2V0TWV0\naG9kKG1ldGhvZCwgcGFyYW1DbGFzc2VzKTsKICAgICAgICAgICAgfSBjYXRj\naCAoTm9TdWNoTWV0aG9kRXhjZXB0aW9uIG5zbWUpIHsKICAgICAgICAgICAg\nICAgIHRocm93IG5ldyBUaHJlYWRpbmdFeGNlcHRpb24obnNtZS50b1N0cmlu\nZygpLCBuc21lKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgZmluYWwg\nT2JqZWN0IHRoaXogPSB0aGlzOwoKICAgICAgICAgICAgbXR0ZXN0KCJyZWZs\nZWN0aW9uIGludm9jYXRpb246ICgiICsgbWV0aG9kICsgIikiLAogICAgICAg\nICAgICAgICAgc2VyaWFsQ291bnQsIHRocmVhZHMsIGl0ZXJhdGlvbnMsIG5l\ndyBWb2xhdGlsZVJ1bm5hYmxlKCkgewogICAgICAgICAgICAgICAgcHVibGlj\nIHZvaWQgcnVuKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgICAgICAg\nICAgICAgbWV0aC5pbnZva2UodGhpeiwgYXJncyk7CiAgICAgICAgICAgICAg\nICB9CiAgICAgICAgICAgIH0pOwogICAgICAgIH0gZmluYWxseSB7CiAgICAg\nICAgICAgIG11bHRpVGhyZWFkRXhlY3V0aW5nID0gbnVsbDsKICAgICAgICB9\nCiAgICB9CgogICAgcHVibGljIHZvaWQgbXR0ZXN0KFN0cmluZyB0aXRsZSwg\nZmluYWwgaW50IHRocmVhZHMsIGZpbmFsIGludCBpdGVyYXRpb25zLAogICAg\nICAgIGZpbmFsIFZvbGF0aWxlUnVubmFibGUgcnVubmVyKSB0aHJvd3MgVGhy\nZWFkaW5nRXhjZXB0aW9uIHsKICAgICAgICBtdHRlc3QodGl0bGUsIDAsIHRo\ncmVhZHMsIGl0ZXJhdGlvbnMsIHJ1bm5lcik7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBFeGVjdXRlIGEgdGVzdCBtZXRob2QgaW4gbXVsdGlwbGUgdGhyZWFk\ncy4KICAgICAqCiAgICAgKiBAcGFyYW0gdGl0bGUgYSBkZXNjcmlwdGlvbiBv\nZiB0aGUgdGVzdCwgZm9yIGluY2x1c2lvbiBpbiB0aGUKICAgICAqIGVycm9y\nIG1lc3NhZ2UKICAgICAqIEBwYXJhbSBzZXJpYWxDb3VudCB0aGUgbnVtYmVy\nIG9mIHRpbWVzIHRvIHJ1biB0aGUgbWV0aG9kCiAgICAgKiBzZXJpYWxseSBi\nZWZvcmUgc3Bhd25pbmcgdGhyZWFkcy4KICAgICAqIEBwYXJhbSB0aHJlYWRz\nIHRoZSBudW1iZXIgb2YgVGhyZWFkcyB0byBydW4gaW4KICAgICAqIEBwYXJh\nbSBpdGVyYXRpb25zIHRoZSBudW1iZXIgb2YgdGltZXMgdGhlIG1ldGhvZCBz\naG91bGQKICAgICAqIEBwYXJhbSBydW5uZXIgdGhlIFZvbGF0aWxlUnVubmFi\nbGUgdGhhdCB3aWxsIGV4ZWN1dGUKICAgICAqIHRoZSBhY3R1YWwgdGVzdCBm\ncm9tIHdpdGhpbiB0aGUgVGhyZWFkLgogICAgICogQHRocm93cyBUaHJlYWRp\nbmdFeGNlcHRpb24gaWYgYW4gZXJyb3JzIG9jY3VyIGluCiAgICAgKiBhbnkg\nb2YgdGhlIFRocmVhZHMuIFRoZSBhY3R1YWwgZXhjZXB0aW9ucwogICAgICog\nd2lsbCBiZSBlbWJlZGRlZCBpbiB0aGUgZXhjZXB0aW9uLiBOb3RlIHRoYXQK\nICAgICAqIHRoaXMgbWVhbnMgdGhhdCBhc3NlcnQoKSBmYWlsdXJlcyB3aWxs\nIGJlCiAgICAgKiB0cmVhdGVkIGFzIGVycm9ycyByYXRoZXIgdGhhbiB3YXJu\naW5ncy4KICAgICAqIEBhdXRob3IgTWFyYyBQcnVkJ2hvbW1lYXV4IGJlIGV4\nZWN1dGUgaW4gYSBzaW5nbGUgVGhyZWFkCiAgICAgKiBAYXV0aG9yIE1hcmMg\nUHJ1ZCdob21tZWF1eAogICAgICovCiAgICBwdWJsaWMgdm9pZCBtdHRlc3Qo\nU3RyaW5nIHRpdGxlLCBmaW5hbCBpbnQgc2VyaWFsQ291bnQsCiAgICAgICAg\nZmluYWwgaW50IHRocmVhZHMsIGZpbmFsIGludCBpdGVyYXRpb25zLCBmaW5h\nbCBWb2xhdGlsZVJ1bm5hYmxlIHJ1bm5lcikKICAgICAgICB0aHJvd3MgVGhy\nZWFkaW5nRXhjZXB0aW9uIHsKICAgICAgICBmaW5hbCBMaXN0IGV4Y2VwdGlv\nbnMgPSBDb2xsZWN0aW9ucy5zeW5jaHJvbml6ZWRMaXN0KG5ldyBMaW5rZWRM\naXN0KCkpOwoKICAgICAgICBUaHJlYWQgW10gcnVubmVycyA9IG5ldyBUaHJl\nYWQgW3RocmVhZHNdOwoKICAgICAgICBmaW5hbCBsb25nIHN0YXJ0TWlsbGlz\nID0gU3lzdGVtLmN1cnJlbnRUaW1lTWlsbGlzKCkgKyAxMDAwOwoKICAgICAg\nICBmb3IgKGludCBpID0gMTsgaSA8PSB0aHJlYWRzOyBpKyspIHsKICAgICAg\nICAgICAgZmluYWwgaW50IHRoaXNUaHJlYWQgPSBpOwoKICAgICAgICAgICAg\ncnVubmVyc1tpIC0gMV0gPQogICAgICAgICAgICAgICAgbmV3IFRocmVhZCh0\naXRsZSArICIgWyIgKyBpICsgIiBvZiAiICsgdGhyZWFkcyArICJdIikgewog\nICAgICAgICAgICAgICAgICAgIHB1YmxpYyB2b2lkIHJ1bigpIHsKICAgICAg\nICAgICAgICAgICAgICAgICAgLy8gZG8gb3VyIGJlc3QgdG8gaGF2ZSBhbGwg\ndGhyZWFkcyBzdGFydCBhdCB0aGUgZXhhY3QKICAgICAgICAgICAgICAgICAg\nICAgICAgLy8gc2FtZSB0aW1lLiBUaGlzIGlzIGltcGVyZmVjdCwgYnV0IHRo\nZSBjbG9zZXIgd2UKICAgICAgICAgICAgICAgICAgICAgICAgLy8gZ2V0IHRv\nIGV2ZXJ5b25lIHN0YXJ0aW5nIGF0IHRoZSBzYW1lIHRpbWUsIHRoZQogICAg\nICAgICAgICAgICAgICAgICAgICAvLyBiZXR0ZXIgY2hhbmNlIHdlIGhhdmUg\nZm9yIGlkZW50aWZ5aW5nIE1UIHByb2JsZW1zLgogICAgICAgICAgICAgICAg\nICAgICAgICB3aGlsZSAoU3lzdGVtLmN1cnJlbnRUaW1lTWlsbGlzKCkgPCBz\ndGFydE1pbGxpcykKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHlpZWxk\nKCk7CgogICAgICAgICAgICAgICAgICAgICAgICBpbnQgdGhpc0l0ZXJhdGlv\nbiA9IDE7CiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAg\nICAgICAgICAgICAgICAgICAgICBmb3IgKDsgdGhpc0l0ZXJhdGlvbiA8PSBp\ndGVyYXRpb25zOyB0aGlzSXRlcmF0aW9uKyspCiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nLy8gZ28gZ28gZ28hCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\ncnVubmVyLnJ1bigpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQog\nICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChUaHJvd2FibGUgZXJy\nb3IpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN5bmNocm9uaXpl\nZCAoZXhjZXB0aW9ucykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgIC8vIGVtYmVkIHRoZSBleGNlcHRpb24gaW50byBzb21ldGhpbmcgdGhh\ndCBnaXZlcwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHVz\nIHNvbWUgbW9yZSBpbmZvcm1hdGlvbiBhYm91dCB0aGUgdGhyZWFkaW5nCiAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gZW52aXJvbm1lbnQK\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBleGNlcHRpb25zLmFk\nZChuZXcgVGhyZWFkaW5nRXhjZXB0aW9uKCJ0aHJlYWQ9IgogICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICArIHRoaXMudG9TdHJpbmcoKQog\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICArICI7dGhyZWFk\nTnVtPSIgKyB0aGlzVGhyZWFkCiAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICsgIjttYXhUaHJlYWRzPSIgKyB0aHJlYWRzCiAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICsgIjtpdGVyYXRpb249IiAr\nIHRoaXNJdGVyYXRpb24KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgKyAiO21heEl0ZXJhdGlvbnM9IiArIGl0ZXJhdGlvbnMsIGVycm9y\nKSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAg\nICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAg\nICAgICAgICB9OwogICAgICAgIH0KCiAgICAgICAgLy8gc3RhcnQgdGhlIHNl\ncmlhbCB0ZXN0cyhkb2VzIG5vdCBzcGF3biB0aGUgdGhyZWFkcykKICAgICAg\nICBmb3IgKGludCBpID0gMDsgaSA8IHNlcmlhbENvdW50OyBpKyspIHsKICAg\nICAgICAgICAgcnVubmVyc1swXS5ydW4oKTsKICAgICAgICB9CgogICAgICAg\nIC8vIHN0YXJ0IHRoZSBtdWx0aXRocmVhZGVkCiAgICAgICAgZm9yIChpbnQg\naSA9IDA7IGkgPCB0aHJlYWRzOyBpKyspIHsKICAgICAgICAgICAgcnVubmVy\nc1tpXS5zdGFydCgpOwogICAgICAgIH0KCiAgICAgICAgLy8gd2FpdCBmb3Ig\ndGhlbSBhbGwgdG8gY29tcGxldGUKICAgICAgICBmb3IgKGludCBpID0gMDsg\naSA8IHRocmVhZHM7IGkrKykgewogICAgICAgICAgICB0cnkgewogICAgICAg\nICAgICAgICAgcnVubmVyc1tpXS5qb2luKCk7CiAgICAgICAgICAgIH0gY2F0\nY2ggKEludGVycnVwdGVkRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgfQog\nICAgICAgIH0KCiAgICAgICAgaWYgKGV4Y2VwdGlvbnMuc2l6ZSgpID09IDAp\nCiAgICAgICAgICAgIHJldHVybjsgLy8gc3dlZWVlZWVlZXQ6IG5vIGVycm9y\ncwoKICAgICAgICAvLyBlbWJlZCBhbGwgdGhlIGV4Y2VwdGlvbnMgdGhhdCB3\nZXJlIHRocm93cyBpbnRvIGEKICAgICAgICAvLyBUaHJlYWRpbmdFeGNlcHRp\nb24KICAgICAgICBUaHJvd2FibGUgW10gZXJyb3JzID0gKFRocm93YWJsZSBb\nXSkgZXhjZXB0aW9ucy50b0FycmF5KAogICAgICAgICAgICBuZXcgVGhyb3dh\nYmxlIFswXSk7CiAgICAgICAgdGhyb3cgbmV3IFRocmVhZGluZ0V4Y2VwdGlv\nbigiVGhlICIKICAgICAgICAgICAgKyBlcnJvcnMubGVuZ3RoICsgIiBlbWJl\nZGRlZCBlcnJvcnMgIgogICAgICAgICAgICArICJvY2N1cmVkIGluIHRoZSBl\neGVjdXRpb24gb2YgIiArIGl0ZXJhdGlvbnMgKyAiIGl0ZXJhdGlvbnMgIgog\nICAgICAgICAgICArICJvZiAiICsgdGhyZWFkcyArICIgdGhyZWFkczogWyIg\nKyB0aXRsZSArICJdIiwgZXJyb3JzKTsKICAgIH0KCiAgICAvKioKICAgICAq\nIENoZWNrIHRvIHNlZSBpZiB3ZSBhcmUgaW4gdGhlIHRvcC1sZXZlbCBleGVj\ndXRpb24gc3RhY2suCiAgICAgKi8KICAgIHB1YmxpYyBib29sZWFuIGlzUm9v\ndFRocmVhZCgpIHsKICAgICAgICByZXR1cm4gbXVsdGlUaHJlYWRFeGVjdXRp\nbmcgPT0gbnVsbDsKICAgIH0KCiAgICAvKioKICAgICAqIEEgUnVubmFibGUg\ndGhhdCBjYW4gdGhyb3cgYW4gRXhjZXB0aW9uOiB1c2VkIHRvIHRlc3QgY2Fz\nZXMuCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0aWMgaW50ZXJmYWNlIFZvbGF0\naWxlUnVubmFibGUgewoKICAgICAgICBwdWJsaWMgdm9pZCBydW4oKSB0aHJv\nd3MgRXhjZXB0aW9uOwogICAgfQoKICAgIC8qKgogICAgICogRXhjZXB0aW9u\nIGZvciBlcnJvcnMgY2F1Z2h0IGR1cmluZyB0aHJlYWRpbmcgdGVzdHMuCiAg\nICAgKi8KICAgIHB1YmxpYyBjbGFzcyBUaHJlYWRpbmdFeGNlcHRpb24gZXh0\nZW5kcyBSdW50aW1lRXhjZXB0aW9uIHsKCiAgICAgICAgcHJpdmF0ZSBmaW5h\nbCBUaHJvd2FibGVbXSBfbmVzdGVkOwoKICAgICAgICBwdWJsaWMgVGhyZWFk\naW5nRXhjZXB0aW9uKFN0cmluZyBtc2csIFRocm93YWJsZSBuZXN0ZWQpIHsK\nICAgICAgICAgICAgc3VwZXIobXNnKTsKICAgICAgICAgICAgaWYgKG5lc3Rl\nZCA9PSBudWxsKQogICAgICAgICAgICAgICAgX25lc3RlZCA9IG5ldyBUaHJv\nd2FibGVbMF07CiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIF9u\nZXN0ZWQgPSBuZXcgVGhyb3dhYmxlW117IG5lc3RlZCB9OwogICAgICAgIH0K\nCiAgICAgICAgcHVibGljIFRocmVhZGluZ0V4Y2VwdGlvbihTdHJpbmcgbXNn\nLCBUaHJvd2FibGVbXSBuZXN0ZWQpIHsKICAgICAgICAgICAgc3VwZXIobXNn\nKTsKICAgICAgICAgICAgaWYgKG5lc3RlZCA9PSBudWxsKQogICAgICAgICAg\nICAgICAgX25lc3RlZCA9IG5ldyBUaHJvd2FibGVbMF07CiAgICAgICAgICAg\nIGVsc2UKICAgICAgICAgICAgICAgIF9uZXN0ZWQgPSBuZXN0ZWQ7CiAgICAg\nICAgfQoKICAgICAgICBwdWJsaWMgdm9pZCBwcmludFN0YWNrVHJhY2UoKSB7\nCiAgICAgICAgICAgIHByaW50U3RhY2tUcmFjZShTeXN0ZW0ub3V0KTsKICAg\nICAgICB9CgogICAgICAgIHB1YmxpYyB2b2lkIHByaW50U3RhY2tUcmFjZShQ\ncmludFN0cmVhbSBvdXQpIHsKICAgICAgICAgICAgcHJpbnRTdGFja1RyYWNl\nKG5ldyBQcmludFdyaXRlcihvdXQpKTsKICAgICAgICB9CgogICAgICAgIHB1\nYmxpYyB2b2lkIHByaW50U3RhY2tUcmFjZShQcmludFdyaXRlciBvdXQpIHsK\nICAgICAgICAgICAgc3VwZXIucHJpbnRTdGFja1RyYWNlKG91dCk7CiAgICAg\nICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgX25lc3RlZC5sZW5ndGg7IGkr\nKykgewogICAgICAgICAgICAgICAgb3V0LnByaW50KCJOZXN0ZWQgVGhyb3dh\nYmxlICMiICsgKGkgKyAxKSArICI6ICIpOwogICAgICAgICAgICAgICAgX25l\nc3RlZFtpXS5wcmludFN0YWNrVHJhY2Uob3V0KTsKICAgICAgICAgICAgfQog\nICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgbGFz\ndCBtZXRob2QgbmFtZSB0aGF0IGNhbGxlZCB0aGlzIG9uZSBieQogICAgICog\ncGFyc2luZyB0aGUgY3VycmVudCBzdGFjayB0cmFjZS4KICAgICAqCiAgICAg\nKiBAcGFyYW0gZXhjbHVkZSBhIG1ldGhvZCBuYW1lIHRvIHNraXAKICAgICAq\nIEB0aHJvd3MgSWxsZWdhbFN0YXRlRXhjZXB0aW9uIElmIHRoZSBjYWxsaW5n\nIG1ldGhvZCBjb3VsZCBub3QgYmUKICAgICAqIGlkZW50aWZpZWQuCiAgICAg\nKiBAYXV0aG9yIE1hcmMgUHJ1ZCdob21tZWF1eAogICAgICovCiAgICBwdWJs\naWMgU3RyaW5nIGNhbGxpbmdNZXRob2QoU3RyaW5nIGV4Y2x1ZGUpIHsKICAg\nICAgICAvLyBkZXRlcm1pbmUgdGhlIGN1cnJlbnRseSBleGVjdXRpbmcgbWV0\naG9kIGJ5CiAgICAgICAgLy8gbG9va2luZyBhdCB0aGUgc3RhY2sgdHJhY2su\nIEhhY2tpc2gsIGJ1dCBjb252ZW5pZW50LgogICAgICAgIFN0cmluZ1dyaXRl\nciBzdyA9IG5ldyBTdHJpbmdXcml0ZXIoKTsKICAgICAgICBuZXcgRXhjZXB0\naW9uKCkucHJpbnRTdGFja1RyYWNlKG5ldyBQcmludFdyaXRlcihzdykpOwog\nICAgICAgIGZvciAoU3RyaW5nVG9rZW5pemVyIHN0YWNrVHJhY2UgPSBuZXcg\nU3RyaW5nVG9rZW5pemVyKHN3LnRvU3RyaW5nKCksCiAgICAgICAgICAgIFN5\nc3RlbS5nZXRQcm9wZXJ0eSgibGluZS5zZXBhcmF0b3IiKSk7CiAgICAgICAg\nICAgIHN0YWNrVHJhY2UuaGFzTW9yZVRva2VucygpOykgewogICAgICAgICAg\nICBTdHJpbmcgbGluZSA9IHN0YWNrVHJhY2UubmV4dFRva2VuKCkudHJpbSgp\nOwoKICAgICAgICAgICAgLy8gbm90IGEgc3RhY2sgdHJhY2UgZWxlbWVudAog\nICAgICAgICAgICBpZiAoIShsaW5lLnN0YXJ0c1dpdGgoImF0ICIpKSkKICAg\nICAgICAgICAgICAgIGNvbnRpbnVlOwoKICAgICAgICAgICAgU3RyaW5nIGZ1\nbGxNZXRob2ROYW1lID0gbGluZS5zdWJzdHJpbmcoMCwgbGluZS5pbmRleE9m\nKCIoIikpOwoKICAgICAgICAgICAgU3RyaW5nIHNob3J0TWV0aG9kTmFtZSA9\nIGZ1bGxNZXRob2ROYW1lLnN1YnN0cmluZygKICAgICAgICAgICAgICAgIGZ1\nbGxNZXRob2ROYW1lLmxhc3RJbmRleE9mKCIuIikgKyAxKTsKCiAgICAgICAg\nICAgIC8vIHNraXAgb3VyIG93biBtZXRob2RzIQogICAgICAgICAgICBpZiAo\nc2hvcnRNZXRob2ROYW1lLmVxdWFscygiY2FsbGluZ01ldGhvZCIpKQogICAg\nICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgIGlmIChleGNsdWRl\nICE9IG51bGwgJiYgc2hvcnRNZXRob2ROYW1lLmVxdWFscyhleGNsdWRlKSkK\nICAgICAgICAgICAgICAgIGNvbnRpbnVlOwoKICAgICAgICAgICAgcmV0dXJu\nIHNob3J0TWV0aG9kTmFtZTsKICAgICAgICB9CgogICAgICAgIHRocm93IG5l\ndyBJbGxlZ2FsU3RhdGVFeGNlcHRpb24oIkNvdWxkIG5vdCBpZGVudGlmeSBj\nYWxsaW5nICIKICAgICAgICAgICAgKyAibWV0aG9kIGluIHN0YWNrIHRyYWNl\nIik7CiAgICB9CgogICAgLy8vLy8vLy8vLwogICAgLy8gVGltaW5nCiAgICAv\nLy8vLy8vLy8vCgogICAgLyoqCiAgICAgKiBTbGVlcCB0aGUgY3VycmVudCBU\naHJlYWQgZm9yIGEgcmFuZG9tIGFtb3VudCBvZiB0aW1lIGZyb20gMC0xMDAw\nIG1zLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzbGVlcFJhbmRvbSgpIHsK\nICAgICAgICBzbGVlcFJhbmRvbSgxMDAwKTsKICAgIH0KCiAgICAvKioKICAg\nICAqIFNsZWVwIHRoZSBjdXJyZW50IFRocmVhZCBmb3IgYSByYW5kb20gYW1v\ndW50IG9mIHRpbWUgZnJvbQogICAgICogMC08Y29kZT5tYXg8L2NvZGU+IG1z\nLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzbGVlcFJhbmRvbShpbnQgbWF4\nKSB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgVGhyZWFkLmN1cnJlbnRU\naHJlYWQoKS5zbGVlcCgobG9uZykgKE1hdGgucmFuZG9tKCkgKiBtYXgpKTsK\nICAgICAgICB9IGNhdGNoIChJbnRlcnJ1cHRlZEV4Y2VwdGlvbiBleCkgewog\nICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIFJlLXJ1biB0aGlzIG1l\ndGhvZCBpbiB0aGUgY3VycmVudCB0aHJlYWQsIHRpbWluZyBvdXQKICAgICAq\nIGFmdGVyIHRoZSBzcGVjaWZpZWQgbnVtYmVyIG9mIHNlY29uZHMuCiAgICAg\nKiBVc2FnZToKICAgICAqIDxwcmU+IHB1YmxpYyB2b2lkIHRpbWVPdXRPcGVy\nYXRpb24oKSB7IGlmICh0aW1lb3V0KDUgKiAxMDAwKSkgcmV0dXJuOwogICAg\nICogIFRocmVhZC5jdXJyZW50VGhyZWFkKCkuc2xlZXAoMTAgKiAxMDAwKTsg\nfQogICAgICogPC9wcmU+CiAgICAgKiA8cC8+CiAgICAgKiA8cC8+CiAgICAg\nKiA8c3Ryb25nPldhcm5pbmc8L3N0cm9uZz4gdGhpcyBtZXRob2Qgc2hvdWxk\nIGJlIHVzZWQgc3BhcmluZ2x5LAogICAgICogYW5kIG9ubHkgd2hlbiB5b3Ug\nZXhwZWN0IHRoYXQgYSB0aW1lb3V0IHdpbGwgPHN0cm9uZz5ub3Q8L3N0cm9u\nZz4KICAgICAqIG9jY3VyLiBJdCB1dGlsaXplZCB0aGUgZGVwcmVjYXRlZCB7\nQGxpbmsgVGhyZWFkI3N0b3AoKX0gYW5kCiAgICAgKiB7QGxpbmsgVGhyZWFk\nI2ludGVycnVwdH0gbWV0aG9kcywgd2hpY2ggY2FuIGxlYXZlIG1vbml0b3Jz\nIGluIGFuCiAgICAgKiBpbnZhbGlkIHN0YXRlLiBJdCBpcyBvbmx5IHVzZWQg\nYmVjYXVzZSBpdCBwcm92aWRlcyBtb3JlCiAgICAgKiBtZWFuaW5nZnVsIGlu\nZm9ybWF0aW9uIHRoYW4ganVzdCBzZWVpbmcgdGhhdCB0aGUgZW50aXJlIGF1\ndG9idWlsZAogICAgICogdGltZWQgb3V0LgogICAgICoKICAgICAqIEBwYXJh\nbSBtaWxsaXMgdGhlIG51bWJlciBvZiBtaWxsaXNlY29uZHMgd2Ugc2hvdWxk\nIHdhaXQuCiAgICAgKiBAcmV0dXJuIHRydWUgaWYgd2UgYXJlIGFyZSBpbiB0\naGUgdGhyZWFkIHRoYXQgcmVxdWVzdGVkIHRoZQogICAgICogICAgICAgICB0\naW1lb3V0LCBmYWxzZSBpZiB3ZSBhcmUgaW4gdGhlIHRpbWVvdXQgdGhyZWFk\nIGl0c2VsZi4KICAgICAqLwogICAgcHVibGljIGJvb2xlYW4gdGltZW91dChs\nb25nIG1pbGxpcykgdGhyb3dzIFRocm93YWJsZSB7CiAgICAgICAgU3RyaW5n\nIG1ldGhvZE5hbWUgPSBjYWxsaW5nTWV0aG9kKCJ0aW1lb3V0Iik7CiAgICAg\nICAgcmV0dXJuIHRpbWVvdXQobWlsbGlzLCBtZXRob2ROYW1lKTsKICAgIH0K\nCiAgICAvKioKICAgICAqIEBzZWUgI3RpbWVvdXQobG9uZykKICAgICAqLwog\nICAgcHVibGljIGJvb2xlYW4gdGltZW91dChsb25nIG1pbGxpcywgU3RyaW5n\nIG1ldGhvZE5hbWUpIHRocm93cyBUaHJvd2FibGUgewogICAgICAgIC8vIHdl\nIGFyZSBpbiB0aGUgdGltaW5nIG91dC10aHJlYWQ6IGRvIG5vdGhpbmcgc28g\ndGhlCiAgICAgICAgLy8gYWN0dWFsIHRlc3QgbWV0aG9kIGNhbiBydW4KICAg\nICAgICBpZiAoaW5UaW1lb3V0VGhyZWFkKQogICAgICAgICAgICByZXR1cm4g\nZmFsc2U7CgogICAgICAgIGluVGltZW91dFRocmVhZCA9IHRydWU7CiAgICAg\nICAgbG9uZyBlbmRUaW1lID0gU3lzdGVtLmN1cnJlbnRUaW1lTWlsbGlzKCkg\nKyBtaWxsaXM7CgogICAgICAgIHRyeSB7CiAgICAgICAgICAgIGZpbmFsIE1l\ndGhvZCBtZXRob2QgPSBnZXRDbGFzcygpLgogICAgICAgICAgICAgICAgZ2V0\nTWV0aG9kKG1ldGhvZE5hbWUsIChDbGFzc1tdKSBudWxsKTsKICAgICAgICAg\nICAgZmluYWwgT2JqZWN0IHRoeiA9IHRoaXM7CgogICAgICAgICAgICAvLyBz\ncGF3biB0aHJlYWQKICAgICAgICAgICAgVGltZU91dFRocmVhZCB0b3QgPSBu\nZXcgVGltZU91dFRocmVhZCgiVGltZU91dFRocmVhZCBbIgogICAgICAgICAg\nICAgICAgKyBtZXRob2ROYW1lICsgIl0gKCIgKyBtaWxsaXMgKyAibXMpIikg\newogICAgICAgICAgICAgICAgcHVibGljIHZvaWQgcnVuKCkgewogICAgICAg\nICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgICAgIG1l\ndGhvZC5pbnZva2UodGh6LCAoT2JqZWN0W10pIG51bGwpOwogICAgICAgICAg\nICAgICAgICAgIH0gY2F0Y2ggKFRocm93YWJsZSB0KSB7CiAgICAgICAgICAg\nICAgICAgICAgICAgIHRocm93YWJsZSA9IHQ7CiAgICAgICAgICAgICAgICAg\nICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgICAgICAgICAgICAgY29tcGxl\ndGVkID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAg\nICAgICB9CiAgICAgICAgICAgIH07CgogICAgICAgICAgICB0b3Quc3RhcnQo\nKTsKCiAgICAgICAgICAgIC8vIHdhaXQgZm9yIHRoZSBjb21wbGV0aW9uIG9y\nIGEgdGltZW91dCB0byBvY2N1cgogICAgICAgICAgICB0b3Quam9pbihtaWxs\naXMpOwoKICAgICAgICAgICAgLy8gaGF2ZSB3ZSB0aW1lZCBvdXQ/IEtpbGwg\ndGhlIHRocmVhZCBhbmQgdGhyb3cgYW4gZXhjZXB0aW9uCiAgICAgICAgICAg\nIGlmIChTeXN0ZW0uY3VycmVudFRpbWVNaWxsaXMoKSA+PSBlbmRUaW1lKSB7\nCiAgICAgICAgICAgICAgICAvLyBpZiB3ZSBhcmUgd2FpdGluZyBvbiBhIG1v\nbml0b3IsIHRoaXMgd2lsbCBnaXZlCiAgICAgICAgICAgICAgICAvLyB1cyBh\nIHVzZWZ1bCBzdGFjayB0cmFjZS4KICAgICAgICAgICAgICAgIHRyeSB7CiAg\nICAgICAgICAgICAgICAgICAgdG90LmludGVycnVwdCgpOwogICAgICAgICAg\nICAgICAgfSBjYXRjaCAoVGhyb3dhYmxlIGUpIHsKICAgICAgICAgICAgICAg\nIH0KICAgICAgICAgICAgICAgIFRocmVhZC5jdXJyZW50VGhyZWFkKCkuc2xl\nZXAoNTAwKTsKCiAgICAgICAgICAgICAgICAvLyB0cnkgdG8ga2lsbCB0aGUg\ndGhyZWFkCiAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAg\nICAgIHRvdC5zdG9wKCk7CiAgICAgICAgICAgICAgICB9IGNhdGNoIChUaHJv\nd2FibGUgZSkgewogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAg\nVGhyZWFkLmN1cnJlbnRUaHJlYWQoKS5zbGVlcCg1MDApOwoKICAgICAgICAg\nICAgICAgIHRocm93IG5ldyBPcGVyYXRpb25UaW1lZE91dEV4Y2VwdGlvbigi\nRXhlY3V0aW9uIG9mIFwiIgogICAgICAgICAgICAgICAgICAgICsgbWV0aG9k\nTmFtZSArICJcIiB0aW1lZCBvdXQgYWZ0ZXIgIgogICAgICAgICAgICAgICAg\nICAgICsgbWlsbGlzICsgIiBtaWxsaXNlY29uZHMiLCB0b3QudGhyb3dhYmxl\nKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gdGhyb3cgYW55IGV4\nY2VwdGlvbnMgdGhhdCBtYXkgaGF2ZSBvY2N1cmVkCiAgICAgICAgICAgIGlm\nICh0b3QudGhyb3dhYmxlICE9IG51bGwpCiAgICAgICAgICAgICAgICB0aHJv\ndyB0b3QudGhyb3dhYmxlOwoKICAgICAgICAgICAgLy8gSSBndWVzcyBldmVy\neXRoaW5nIHdhcyBPSwogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAg\nICB9IGZpbmFsbHkgewogICAgICAgICAgICBpblRpbWVvdXRUaHJlYWQgPSBm\nYWxzZTsKICAgICAgICB9CiAgICB9CgogICAgcHJpdmF0ZSBzdGF0aWMgY2xh\nc3MgVGltZU91dFRocmVhZCBleHRlbmRzIFRocmVhZCB7CgogICAgICAgIHB1\nYmxpYyBUaHJvd2FibGUgdGhyb3dhYmxlID0gbnVsbDsKICAgICAgICBwdWJs\naWMgYm9vbGVhbiBjb21wbGV0ZWQgPSBmYWxzZTsKCiAgICAgICAgcHVibGlj\nIFRpbWVPdXRUaHJlYWQoU3RyaW5nIG5hbWUpIHsKICAgICAgICAgICAgc3Vw\nZXIobmFtZSk7CiAgICAgICAgICAgIHNldERhZW1vbih0cnVlKTsKICAgICAg\nICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBJbmRpY2F0ZXMgdGhhdCBhIHRp\nbWVvdXQgb2NjdXJlZC4KICAgICAqLwogICAgcHVibGljIHN0YXRpYyBjbGFz\ncyBPcGVyYXRpb25UaW1lZE91dEV4Y2VwdGlvbiBleHRlbmRzIFJ1bnRpbWVF\neGNlcHRpb24gewoKICAgICAgICBwcml2YXRlIGZpbmFsIFRocm93YWJsZSBf\nZXJyOwoKICAgICAgICBwdWJsaWMgT3BlcmF0aW9uVGltZWRPdXRFeGNlcHRp\nb24oU3RyaW5nIG1zZywgVGhyb3dhYmxlIHRocm93YWJsZSkgewogICAgICAg\nICAgICBzdXBlcihtc2cpOwogICAgICAgICAgICBfZXJyID0gdGhyb3dhYmxl\nOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIHZvaWQgcHJpbnRTdGFja1Ry\nYWNlKCkgewogICAgICAgICAgICBwcmludFN0YWNrVHJhY2UoU3lzdGVtLm91\ndCk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgdm9pZCBwcmludFN0YWNr\nVHJhY2UoUHJpbnRTdHJlYW0gb3V0KSB7CiAgICAgICAgICAgIHByaW50U3Rh\nY2tUcmFjZShuZXcgUHJpbnRXcml0ZXIob3V0KSk7CiAgICAgICAgfQoKICAg\nICAgICBwdWJsaWMgdm9pZCBwcmludFN0YWNrVHJhY2UoUHJpbnRXcml0ZXIg\nb3V0KSB7CiAgICAgICAgICAgIHN1cGVyLnByaW50U3RhY2tUcmFjZShvdXQp\nOwogICAgICAgICAgICBpZiAoX2VyciAhPSBudWxsKSB7CiAgICAgICAgICAg\nICAgICBvdXQucHJpbnQoIk5lc3RlZCBUaHJvd2FibGU6ICIpOwogICAgICAg\nICAgICAgICAgX2Vyci5wcmludFN0YWNrVHJhY2Uob3V0KTsKICAgICAgICAg\nICAgfQogICAgICAgIH0KICAgIH0KCiAgICAvLy8vLy8vLy8vLy8vLy8KICAg\nIC8vIENvbGxlY3Rpb25zCiAgICAvLy8vLy8vLy8vLy8vLy8KCiAgICAvKioK\nICAgICAqIFZhbGlkYXRlIHRoYXQgdGhlIHNwZWNpZmllZCB7QGxpbmsgQ29s\nbGVjdGlvbn0gZnVsZmlsbHMgdGhlCiAgICAgKiBDb2xsZWN0aW9uIGNvbnRy\nYWN0IGFzIHNwZWNpZmllZCBieSB0aGUgQ29sbGVjdGlvbnMgQVBJLgogICAg\nICogPHAvPgogICAgICogPHN0cm9uZz5Ob3RlPC9zdHJvbmc+OiBkb2VzIG5v\ndCB2YWxpZGF0ZSBtdXRhYmxlIG9wZXJhdGlvbnMKICAgICAqLwogICAgcHVi\nbGljIHN0YXRpYyB2b2lkIHZhbGlkYXRlQ29sbGVjdGlvbihDb2xsZWN0aW9u\nIGNvbGxlY3Rpb24pIHsKICAgICAgICBpbnQgc2l6ZSA9IGNvbGxlY3Rpb24u\nc2l6ZSgpOwogICAgICAgIGludCBpdGVyYXRlZCA9IDA7CiAgICAgICAgLy8g\nZW5zdXJlIHdlIGNhbiB3YWxrIGFsb25nIHRoZSBpdGVyYXRvcgogICAgICAg\nIGZvciAoSXRlcmF0b3IgaSA9IGNvbGxlY3Rpb24uaXRlcmF0b3IoKTsgaS5o\nYXNOZXh0KCk7KSB7CiAgICAgICAgICAgIGl0ZXJhdGVkKys7CiAgICAgICAg\nICAgIGkubmV4dCgpOwogICAgICAgIH0KCiAgICAgICAgLy8gZW5zdXJlIHRo\nZSBudW1iZXIgb2YgdmFsdWVzIGl0ZXJhdGVkIGlzIHRoZSBzYW1lIGFzIHRo\nZSBsaXN0IHNpemUKICAgICAgICBhc3NlcnRFcXVhbHMoc2l6ZSwgaXRlcmF0\nZWQpOwoKICAgICAgICAvLyBhbHNvIHZhbGlkYXRlIHRoZSBsaXN0CiAgICAg\nICAgaWYgKGNvbGxlY3Rpb24gaW5zdGFuY2VvZiBMaXN0KSB7CiAgICAgICAg\nICAgIExpc3QgbGwgPSBuZXcgQXJyYXlMaXN0KCk7CiAgICAgICAgICAgIGZv\nciAoaW50IGkgPSAwOyBpIDwgMTAwOyBpKyspCiAgICAgICAgICAgICAgICBs\nbC5hZGQobmV3IEludGVnZXIoaSkpOwogICAgICAgICAgICB2YWxpZGF0ZUxp\nc3QoKExpc3QpIGxsKTsKICAgICAgICAgICAgdmFsaWRhdGVMaXN0KChMaXN0\nKSBjb2xsZWN0aW9uKTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAg\nKiBWYWxpZGF0ZSB0aGF0IHRoZSBzcGVjaWZpZWQge0BsaW5rIExpc3R9IGZ1\nbGZpbGxzIHRoZQogICAgICogTGlzdCBjb250cmFjdCBhcyBzcGVjaWZpZWQg\nYnkgdGhlIENvbGxlY3Rpb25zIEFQSS4KICAgICAqIDxwLz4KICAgICAqIDxz\ndHJvbmc+Tm90ZTwvc3Ryb25nPjogZG9lcyBub3QgdmFsaWRhdGUgbXV0YWJs\nZSBvcGVyYXRpb25zCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0aWMgdm9pZCB2\nYWxpZGF0ZUxpc3QoTGlzdCBsaXN0KSB7CiAgICAgICAgT2JqZWN0IFtdIGNv\ncmVWYWx1ZXMgPSBsaXN0LnRvQXJyYXkoKTsKICAgICAgICBPYmplY3QgW10g\ndmFsdWVzMSA9IG5ldyBPYmplY3QgW2xpc3Quc2l6ZSgpXTsKICAgICAgICBP\nYmplY3QgW10gdmFsdWVzMiA9IG5ldyBPYmplY3QgW2xpc3Quc2l6ZSgpXTsK\nICAgICAgICBPYmplY3QgW10gdmFsdWVzMyA9IG5ldyBPYmplY3QgW2xpc3Qu\nc2l6ZSgpXTsKICAgICAgICBPYmplY3QgW10gdmFsdWVzNCA9IG5ldyBPYmpl\nY3QgW2xpc3Quc2l6ZSgpXTsKCiAgICAgICAgLy8gZmlsbCBzZXF1ZW50aWFs\nIGluZGV4IGFjY2VzcyBsaXN0CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkg\nPCBsaXN0LnNpemUoKTsgaSsrKQogICAgICAgICAgICB2YWx1ZXMxW2ldID0g\nbGlzdC5nZXQoaSk7CgogICAgICAgIC8vIGZpbGwgc2VxdWVudGlhbCBsaXN0\nCiAgICAgICAgaW50IGluZGV4ID0gMDsKICAgICAgICBMaXN0SXRlcmF0b3Ig\naXRlcjsKICAgICAgICBmb3IgKGl0ZXIgPSBsaXN0Lmxpc3RJdGVyYXRvcigw\nKTsgaXRlci5oYXNOZXh0KCk7KSB7CiAgICAgICAgICAgIGFzc2VydEVxdWFs\ncyhpbmRleCwgaXRlci5uZXh0SW5kZXgoKSk7CiAgICAgICAgICAgIGFzc2Vy\ndEVxdWFscyhpbmRleCwgaXRlci5wcmV2aW91c0luZGV4KCkgKyAxKTsKICAg\nICAgICAgICAgdmFsdWVzMltpbmRleF0gPSBpdGVyLm5leHQoKTsKICAgICAg\nICAgICAgYXNzZXJ0VHJ1ZShsaXN0LmNvbnRhaW5zKHZhbHVlczJbaW5kZXhd\nKSk7CiAgICAgICAgICAgIGluZGV4Kys7CiAgICAgICAgfQoKICAgICAgICAv\nLyBlbnN1cmUgTm9TdWNoRWxlbWVudEV4Y2VwdGlvbiBpcyB0aHJvd24gYXMg\nYXBwcm9wcmlhdGUKICAgICAgICB0cnkgewogICAgICAgICAgICBpdGVyLm5l\neHQoKTsKICAgICAgICAgICAgZmFpbCgibmV4dCgpIHNob3VsZCBoYXZlIHJl\nc3VsdGVkIGluIGEgTm9TdWNoRWxlbWVudEV4Y2VwdGlvbiIpOwogICAgICAg\nIH0gY2F0Y2ggKE5vU3VjaEVsZW1lbnRFeGNlcHRpb24gZSkgewogICAgICAg\nIH0gLy8gYXMgZXhwZWN0ZWQKCiAgICAgICAgLy8gZmlsbCByZXZlcnNlIHNl\ncXVlbnRpYWwgbGlzdAogICAgICAgIGludCBiYWNrID0gMDsKICAgICAgICBm\nb3IgKGl0ZXIgPSBsaXN0Lmxpc3RJdGVyYXRvcihsaXN0LnNpemUoKSk7IGl0\nZXIuaGFzUHJldmlvdXMoKTspIHsKICAgICAgICAgICAgYXNzZXJ0RXF1YWxz\nKGluZGV4LCBpdGVyLnByZXZpb3VzSW5kZXgoKSArIDEpOwogICAgICAgICAg\nICBhc3NlcnRFcXVhbHMoaW5kZXgsIGl0ZXIubmV4dEluZGV4KCkpOwogICAg\nICAgICAgICB2YWx1ZXMzWy0taW5kZXhdID0gaXRlci5wcmV2aW91cygpOwog\nICAgICAgICAgICBiYWNrKys7CiAgICAgICAgfQogICAgICAgIGFzc2VydEVx\ndWFscyhsaXN0LnNpemUoKSwgYmFjayk7CgogICAgICAgIC8vIGVuc3VyZSBO\nb1N1Y2hFbGVtZW50RXhjZXB0aW9uIGlzIHRocm93biBhcyBhcHByb3ByaWF0\nZQogICAgICAgIHRyeSB7CiAgICAgICAgICAgIGl0ZXIucHJldmlvdXMoKTsK\nICAgICAgICAgICAgZmFpbCgicHJldmlvdXMoKSBzaG91bGQgaGF2ZSByZXN1\nbHRlZCBpbiBhICIKICAgICAgICAgICAgICAgICsgIk5vU3VjaEVsZW1lbnRF\neGNlcHRpb24iKTsKICAgICAgICB9IGNhdGNoIChOb1N1Y2hFbGVtZW50RXhj\nZXB0aW9uIGUpIHsKICAgICAgICB9IC8vIGFzIGV4cGVjdGVkCgogICAgICAg\nIC8vIGZpbGwgcmFuZG9tIGFjY2VzcyBsaXN0CiAgICAgICAgTGlzdCBpbmRp\nY2VzID0gbmV3IExpbmtlZExpc3QoKTsKICAgICAgICBmb3IgKGludCBpID0g\nMDsgaSA8IGxpc3Quc2l6ZSgpOyBpKyspCiAgICAgICAgICAgIGluZGljZXMu\nYWRkKG5ldyBJbnRlZ2VyKGkpKTsKCiAgICAgICAgZm9yIChpbnQgaSA9IDA7\nIGkgPCBsaXN0LnNpemUoKTsgaSsrKSB7CiAgICAgICAgICAgIGludCByYW5k\nID0gKGludCkgKE1hdGgucmFuZG9tKCkgKiBpbmRpY2VzLnNpemUoKSk7CiAg\nICAgICAgICAgIEludGVnZXIgcmFuZEluZGV4ID0gKEludGVnZXIpIGluZGlj\nZXMucmVtb3ZlKHJhbmQpOwogICAgICAgICAgICB2YWx1ZXM0W3JhbmRJbmRl\neC5pbnRWYWx1ZSgpXSA9IGxpc3QuZ2V0KHJhbmRJbmRleC5pbnRWYWx1ZSgp\nKTsKICAgICAgICB9CgogICAgICAgIGFzc2VydEVxdWFscyhBcnJheXMuYXNM\naXN0KGNvcmVWYWx1ZXMpLCBBcnJheXMuYXNMaXN0KHZhbHVlczEpKTsKICAg\nICAgICBhc3NlcnRJZGVudGljYWwoQXJyYXlzLmFzTGlzdChjb3JlVmFsdWVz\nKSwgQXJyYXlzLmFzTGlzdCh2YWx1ZXMxKSk7CiAgICAgICAgYXNzZXJ0RXF1\nYWxzKEFycmF5cy5hc0xpc3QoY29yZVZhbHVlcyksIEFycmF5cy5hc0xpc3Qo\ndmFsdWVzMikpOwogICAgICAgIGFzc2VydElkZW50aWNhbChBcnJheXMuYXNM\naXN0KGNvcmVWYWx1ZXMpLCBBcnJheXMuYXNMaXN0KHZhbHVlczIpKTsKICAg\nICAgICBhc3NlcnRFcXVhbHMoQXJyYXlzLmFzTGlzdChjb3JlVmFsdWVzKSwg\nQXJyYXlzLmFzTGlzdCh2YWx1ZXM0KSk7CiAgICAgICAgYXNzZXJ0SWRlbnRp\nY2FsKEFycmF5cy5hc0xpc3QoY29yZVZhbHVlcyksIEFycmF5cy5hc0xpc3Qo\ndmFsdWVzNCkpOwogICAgICAgIGFzc2VydEVxdWFscyhBcnJheXMuYXNMaXN0\nKGNvcmVWYWx1ZXMpLCBBcnJheXMuYXNMaXN0KHZhbHVlczMpKTsKICAgICAg\nICBhc3NlcnRJZGVudGljYWwoQXJyYXlzLmFzTGlzdChjb3JlVmFsdWVzKSwg\nQXJyYXlzLmFzTGlzdCh2YWx1ZXMzKSk7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBBc3NlcnQgdGhhdCB0aGUgZ2l2ZW4gTGlzdCBjb250YWluIHRoZSBleGFj\ndCBzYW1lCiAgICAgKiBlbGVtZW50cy4gVGhpcyBpcyBkaWZmZXJlbnQgdGhh\nbiB0aGUgbm9ybWFsIExpc3QgY29udHJhY3QsIHdoaWNoCiAgICAgKiBzdGF0\nZXMgdGhhdCBsaXN0MS5lcXVhbHMobGlzdDIpIGlmIGVhY2ggZWxlbWVudCBl\nMS5lcXVhbHMoZTIpLgogICAgICogVGhpcyBtZXRob2QgYXNzZXJ0cyB0aGF0\nIGUxID09IG4yLgogICAgICovCiAgICBwdWJsaWMgc3RhdGljIHZvaWQgYXNz\nZXJ0SWRlbnRpY2FsKExpc3QgYzEsIExpc3QgYzIpIHsKICAgICAgICBhc3Nl\ncnRFcXVhbHMoYzEuc2l6ZSgpLCBjMi5zaXplKCkpOwogICAgICAgIGZvciAo\nSXRlcmF0b3IgaTEgPSBjMS5pdGVyYXRvcigpLCBpMiA9IGMyLml0ZXJhdG9y\nKCk7CiAgICAgICAgICAgIGkxLmhhc05leHQoKSAmJiBpMi5oYXNOZXh0KCk7\nKQogICAgICAgICAgICBhc3NlcnRUcnVlKGkxLm5leHQoKSA9PSBpMi5uZXh0\nKCkpOwogICAgfQoKICAgIC8qKgogICAgICogQXNzZXJ0IHRoYXQgdGhlIGNv\nbGxlY3Rpb24gcGFyYW1ldGVyIGlzIGFscmVhZHkgb3JkZXJlZAogICAgICog\nYWNjb3JkaW5nIHRvIHRoZSBzcGVjaWZpZWQgY29tcGFyYXRvci4KICAgICAq\nLwogICAgcHVibGljIHZvaWQgYXNzZXJ0T3JkZXJlZChDb2xsZWN0aW9uIGMs\nIENvbXBhcmF0b3IgY29tcCkgewogICAgICAgIExpc3QgbDEgPSBuZXcgTGlu\na2VkTGlzdChjKTsKICAgICAgICBMaXN0IGwyID0gbmV3IExpbmtlZExpc3Qo\nYyk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKGwxLCBsMik7CiAgICAgICAgQ29s\nbGVjdGlvbnMuc29ydChsMiwgY29tcCk7CiAgICAgICAgYXNzZXJ0RXF1YWxz\nKGwxLCBsMik7CiAgICAgICAgQ29sbGVjdGlvbnMuc29ydChsMSwgY29tcCk7\nCiAgICAgICAgYXNzZXJ0RXF1YWxzKGwxLCBsMik7CiAgICB9Cn0K\n","encoding":"base64"}

