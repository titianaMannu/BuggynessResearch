{"sha":"04b6e2e63c1eb4b37f92296a4416d0ac311b6d82","node_id":"MDQ6QmxvYjIwNjM2NDowNGI2ZTJlNjNjMWViNGIzN2Y5MjI5NmE0NDE2ZDBhYzMxMWI2ZDgy","size":5029,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/04b6e2e63c1eb4b37f92296a4416d0ac311b6d82","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuY29tcGF0\nOwoKaW1wb3J0IGphdmEudXRpbC5JdGVyYXRvcjsKaW1wb3J0IGphdmEudXRp\nbC5MaXN0OwppbXBvcnQgamF2YXgucGVyc2lzdGVuY2UuRW50aXR5TWFuYWdl\ncjsKCmltcG9ydCBqdW5pdC50ZXh0dWkuVGVzdFJ1bm5lcjsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5jb25mLk9wZW5KUEFWZXJzaW9uOwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNlLkFyZ3VtZW50RXhjZXB0\naW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNlLnRl\nc3QuU2luZ2xlRU1GVGVzdENhc2U7CgovKioKICogPGI+Q29tcGF0aWJsZSB0\nZXN0Y2FzZXM8L2I+IGFyZSB1c2VkIHRvIHRlc3QgdmFyaW91cyBiYWNrd2Fy\nZHMgY29tcGF0aWJpbGl0eSBzY2VuYXJpb3MgYmV0d2VlbiBKUEEgMi4wIGFu\nZCBKUEEgMS4yCiAqIAogKiA8cD5UaGUgZm9sbG93aW5nIHNjZW5hcmlvcyBh\ncmUgdGVzdGVkOgogKiA8b2w+CiAqIDxsaT5xdWVyeS5zZXRQYXJhbWV0ZXIo\nKQogKiA8L29sPgogKiA8cD4gCiAqIDxiPk5vdGUocyk6PC9iPgogKiA8dWw+\nCiAqIDxsaT5UaGUgcHJvcGVyIG9wZW5qcGEuQ29tcGF0aWJpbGl0eSB2YWx1\nZShzKSBtdXN0IGJlIHByb3ZpZGVkIGluIG9yZGVyIGZvciB0aGUgdGVzdGNh\nc2UocykgdG8gc3VjY2VlZAogKiA8L3VsPgogKi8KcHVibGljIGNsYXNzIFRl\nc3REdXBOYW1lZFF1ZXJ5IGV4dGVuZHMgU2luZ2xlRU1GVGVzdENhc2UgewoK\nICAgIHB1YmxpYyB2b2lkIHNldFVwKCkgewogICAgICAgIHNldFVwKFNpbXBs\nZUVudGl0eS5jbGFzcywgU2ltcGxlRW50aXR5Mi5jbGFzcywgQ0xFQVJfVEFC\nTEVTKTsKCiAgICAgICAgRW50aXR5TWFuYWdlciBlbSA9IGVtZi5jcmVhdGVF\nbnRpdHlNYW5hZ2VyKCk7CiAgICAgICAgZW0uZ2V0VHJhbnNhY3Rpb24oKS5i\nZWdpbigpOwogICAgICAgIGVtLnBlcnNpc3QobmV3IFNpbXBsZUVudGl0eSgi\nTmFtZSBPbmUiLCAiVmFsdWUgT25lIikpOwogICAgICAgIGVtLnBlcnNpc3Qo\nbmV3IFNpbXBsZUVudGl0eSgiTmFtZSBUd28iLCAiVmFsdWUgVHdvIikpOwog\nICAgICAgIGVtLnBlcnNpc3QobmV3IFNpbXBsZUVudGl0eTIoIk5hbWUyIE9u\nZSIsICJWYWx1ZTIgT25lIikpOwogICAgICAgIGVtLnBlcnNpc3QobmV3IFNp\nbXBsZUVudGl0eTIoIk5hbWUyIFR3byIsICJWYWx1ZTIgVHdvIikpOwogICAg\nICAgIGVtLmdldFRyYW5zYWN0aW9uKCkuY29tbWl0KCk7CiAgICAgICAgZW0u\nY2xvc2UoKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCB0ZXN0U2ltcGxlUXVl\ncnkoKSB7CiAgICAgICAgc2ltcGxlUXVlcnkoZmFsc2UsICJGaW5kT25lIiwg\nIkZpbmRBbGwiLCAiTmFtZSBPbmUiLCAiVmFsdWUgT25lIiwKICAgICAgICAg\nICAgIk5hbWUgVHdvIiwgIlZhbHVlIFR3byIpOwogICAgICAgIHNpbXBsZVF1\nZXJ5KHRydWUsICJGaW5kMk9uZSIsICJGaW5kMkFsbCIsICJOYW1lMiBPbmUi\nLCAiVmFsdWUyIE9uZSIsCiAgICAgICAgICAgICJOYW1lMiBUd28iLCAiVmFs\ndWUyIFR3byIpOwoKICAgICAgICBzaW1wbGVRdWVyeShmYWxzZSwgIkZpbmRY\nVHdvIiwgbnVsbCwgIk5hbWUgVHdvIiwgIlZhbHVlIFR3byIsIG51bGwsCiAg\nICAgICAgICAgIG51bGwpOwogICAgfQoKICAgIHByaXZhdGUgdm9pZCBzaW1w\nbGVRdWVyeShib29sZWFuIHNpbXBsZTIsIFN0cmluZyBmaW5kT25lUU5hbWUs\nCiAgICAgICAgU3RyaW5nIGZpbmRBbGxRTmFtZSwgU3RyaW5nIG5hbWVPbmUs\nIFN0cmluZyBWYWx1ZU9uZSwgU3RyaW5nIG5hbWVUd28sCiAgICAgICAgU3Ry\naW5nIFZhbHVlVHdvKSB7CiAgICAgICAgRW50aXR5TWFuYWdlciBlbSA9IGVt\nZi5jcmVhdGVFbnRpdHlNYW5hZ2VyKCk7CgogICAgICAgIHRyeSB7CiAgICAg\nICAgICAgIExpc3QgbGlzdCA9IGVtLmNyZWF0ZU5hbWVkUXVlcnkoZmluZE9u\nZVFOYW1lKS5zZXRQYXJhbWV0ZXIoMSwgbmFtZU9uZSkuZ2V0UmVzdWx0TGlz\ndCgpOwogICAgICAgICAgICBhc3NlcnROb3ROdWxsKGxpc3QpOwogICAgICAg\nICAgICBhc3NlcnRFcXVhbHMobGlzdC5zaXplKCksIDEpOwogICAgICAgICAg\nICBPYmplY3QgbyA9IGxpc3QuZ2V0KDApOwogICAgICAgICAgICBhc3NlcnRT\nYW1lKG8uZ2V0Q2xhc3MoKSwgc2ltcGxlMiA/IFNpbXBsZUVudGl0eTIuY2xh\nc3MgOiBTaW1wbGVFbnRpdHkuY2xhc3MpOwogICAgICAgICAgICBhc3NlcnRF\ncXVhbHMoc2ltcGxlMiA/ICgoU2ltcGxlRW50aXR5MikgbykuZ2V0VmFsdWUo\nKQogICAgICAgICAgICAgICAgOiAoKFNpbXBsZUVudGl0eSkgbykuZ2V0VmFs\ndWUoKSwgVmFsdWVPbmUpOwoKICAgICAgICAgICAgaWYgKGZpbmRBbGxRTmFt\nZSAhPSBudWxsKSB7CiAgICAgICAgICAgICAgICBsaXN0ID0gZW0uY3JlYXRl\nTmFtZWRRdWVyeShmaW5kQWxsUU5hbWUpLmdldFJlc3VsdExpc3QoKTsKICAg\nICAgICAgICAgICAgIGFzc2VydE5vdE51bGwobGlzdCk7CiAgICAgICAgICAg\nICAgICBhc3NlcnRFcXVhbHMobGlzdC5zaXplKCksIDIpOwogICAgICAgICAg\nICAgICAgZm9yIChJdGVyYXRvciByZXN1bHRJdGVyID0gbGlzdC5pdGVyYXRv\ncigpOyByZXN1bHRJdGVyLmhhc05leHQoKTspIHsKICAgICAgICAgICAgICAg\nICAgICBvID0gcmVzdWx0SXRlci5uZXh0KCk7CiAgICAgICAgICAgICAgICAg\nICAgYXNzZXJ0U2FtZShvLmdldENsYXNzKCksIHNpbXBsZTIgPyBTaW1wbGVF\nbnRpdHkyLmNsYXNzCiAgICAgICAgICAgICAgICAgICAgICAgIDogU2ltcGxl\nRW50aXR5LmNsYXNzKTsKICAgICAgICAgICAgICAgICAgICBTdHJpbmcgbiA9\nIG51bGw7CiAgICAgICAgICAgICAgICAgICAgU3RyaW5nIHYgPSBudWxsOwog\nICAgICAgICAgICAgICAgICAgIGlmIChzaW1wbGUyKSB7CiAgICAgICAgICAg\nICAgICAgICAgICAgIG4gPSAoKFNpbXBsZUVudGl0eTIpIG8pLmdldE5hbWUo\nKTsKICAgICAgICAgICAgICAgICAgICAgICAgdiA9ICgoU2ltcGxlRW50aXR5\nMikgbykuZ2V0VmFsdWUoKTsKICAgICAgICAgICAgICAgICAgICB9IGVsc2Ug\newogICAgICAgICAgICAgICAgICAgICAgICBuID0gKChTaW1wbGVFbnRpdHkp\nIG8pLmdldE5hbWUoKTsKICAgICAgICAgICAgICAgICAgICAgICAgdiA9ICgo\nU2ltcGxlRW50aXR5KSBvKS5nZXRWYWx1ZSgpOwogICAgICAgICAgICAgICAg\nICAgIH0KICAgICAgICAgICAgICAgICAgICBpZiAobi5lcXVhbHMobmFtZU9u\nZSkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgYXNzZXJ0VHJ1ZSh2LmVx\ndWFscyhWYWx1ZU9uZSkpOwogICAgICAgICAgICAgICAgICAgIH0gZWxzZSBp\nZiAobi5lcXVhbHMobmFtZVR3bykpIHsKICAgICAgICAgICAgICAgICAgICAg\nICAgYXNzZXJ0VHJ1ZSh2LmVxdWFscyhWYWx1ZVR3bykpOwogICAgICAgICAg\nICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGFz\nc2VydFRydWUoZmFsc2UpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAg\nICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0gY2F0Y2ggKEFy\nZ3VtZW50RXhjZXB0aW9uIGFlKSB7CiAgICAgICAgICAgIGlmICgoT3BlbkpQ\nQVZlcnNpb24uTUFKT1JfUkVMRUFTRSA9PSAxKSAmJgogICAgICAgICAgICAg\nICAgIChPcGVuSlBBVmVyc2lvbi5NSU5PUl9SRUxFQVNFID49IDMpKSB7CiAg\nICAgICAgICAgICAgICAvLyBuZXcgYmVoYXZpb3IgLSBleHBlY3RlZCBleGNl\ncHRpb24KICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIC8v\nIHVuZXhwZWN0ZWQgZXhjZXB0aW9uCiAgICAgICAgICAgICAgIHRocm93IGFl\nOwogICAgICAgICAgICB9CiAgICAgICAgfSBjYXRjaCAoSWxsZWdhbEFyZ3Vt\nZW50RXhjZXB0aW9uIGlhZSkgewogICAgICAgICAgICBpZiAoT3BlbkpQQVZl\ncnNpb24uTUFKT1JfUkVMRUFTRSA+PSAyKSB7CiAgICAgICAgICAgICAgICAv\nLyBleHBlY3RlZCBleGNlcHRpb24gZm9yIG5ldyBiZWhhdmlvcgogICAgICAg\nICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgLy8gdW5leHBlY3RlZCBl\neGNlcHRpb24KICAgICAgICAgICAgICAgIHRocm93IGlhZTsKICAgICAgICAg\nICAgfQogICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgIGVtLmNsb3Nl\nKCk7CiAgICAgICAgfQogICAgfQoKICAgIHB1YmxpYyBzdGF0aWMgdm9pZCBt\nYWluKFN0cmluZ1tdIGFyZ3MpIHsKICAgICAgICBUZXN0UnVubmVyLnJ1bihU\nZXN0RHVwTmFtZWRRdWVyeS5jbGFzcyk7CiAgICB9Cn0KCg==\n","encoding":"base64"}

