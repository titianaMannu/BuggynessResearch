{"sha":"4601886c24fa4899f5c3fba2b8d777c0e5d8f7d3","node_id":"MDQ6QmxvYjIwNjM2NDo0NjAxODg2YzI0ZmE0ODk5ZjVjM2ZiYTJiOGQ3NzdjMGU1ZDhmN2Qz","size":14863,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/4601886c24fa4899f5c3fba2b8d777c0e5d8f7d3","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwogcGFj\na2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuY3JpdGVyaWE7\nCgppbXBvcnQgamF2YS5pby5QcmludFdyaXRlcjsKaW1wb3J0IGphdmEuaW8u\nU3RyaW5nV3JpdGVyOwppbXBvcnQgamF2YS5sYW5nLnJlZmxlY3QuTWV0aG9k\nOwppbXBvcnQgamF2YS51dGlsLkFycmF5TGlzdDsKaW1wb3J0IGphdmEudXRp\nbC5IYXNoTWFwOwppbXBvcnQgamF2YS51dGlsLkxpc3Q7CmltcG9ydCBqYXZh\nLnV0aWwuTWFwOwoKaW1wb3J0IGphdmF4LnBlcnNpc3RlbmNlLkVudGl0eU1h\nbmFnZXI7CmltcG9ydCBqYXZheC5wZXJzaXN0ZW5jZS5QZXJzaXN0ZW5jZTsK\naW1wb3J0IGphdmF4LnBlcnNpc3RlbmNlLlF1ZXJ5OwppbXBvcnQgamF2YXgu\ncGVyc2lzdGVuY2UuY3JpdGVyaWEuQ3JpdGVyaWFRdWVyeTsKCmltcG9ydCBq\ndW5pdC5mcmFtZXdvcmsuVGVzdENhc2U7CgppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLmpkYmMuY29uZi5KREJDQ29uZmlndXJhdGlvbjsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNxbC5EQkRpY3Rpb25hcnk7CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zcWwuRGVyYnlEaWN0aW9uYXJ5\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi5qZGJjLkFic3RyYWN0\nSkRCQ0xpc3RlbmVyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi5q\nZGJjLkpEQkNFdmVudDsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIu\namRiYy5KREJDTGlzdGVuZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\nbGliLmpkYmMuUmVwb3J0aW5nU1FMRXhjZXB0aW9uOwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNlLk9wZW5KUEFFbnRpdHlNYW5hZ2Vy\nRmFjdG9yeVNQSTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0\nZW5jZS50ZXN0LkFsbG93RmFpbHVyZTsKCnB1YmxpYyBhYnN0cmFjdCBjbGFz\ncyBBYnN0cmFjdENyaXRlcmlhVGVzdENhc2UgZXh0ZW5kcyBUZXN0Q2FzZSB7\nCgogICAgcHJvdGVjdGVkIGFic3RyYWN0IFNRTEF1ZGl0b3IgZ2V0QXVkaXRv\ncigpOwoKICAgIHByb3RlY3RlZCBhYnN0cmFjdCBPcGVuSlBBRW50aXR5TWFu\nYWdlckZhY3RvcnlTUEkgZ2V0RW50aXR5TWFuYWdlckZhY3RvcnkoKTsKICAg\nIAogICAgcHJvdGVjdGVkIGFic3RyYWN0IEVudGl0eU1hbmFnZXIgZ2V0RW50\naXR5TWFuYWdlcigpOwogICAgcHJpdmF0ZSBEQkRpY3Rpb25hcnkgZGljdCA9\nIG51bGw7CgogICAgcHVibGljIERCRGljdGlvbmFyeSBnZXREaWN0aW9uYXJ5\nKCkgewogICAgICAgIHJldHVybiBkaWN0OwogICAgfQoKICAgIC8qKgogICAg\nICogQ3JlYXRlIGFuIGVudGl0eSBtYW5hZ2VyIGZhY3RvcnkgZm9yIHBlcnNp\nc3RlbmNlIHVuaXQgPGNvZGU+cHU8L2NvZGU+LiBQdXQge0BsaW5rICNDTEVB\nUl9UQUJMRVN9IGluIHRoaXMgbGlzdCB0bwogICAgICogdGVsbCB0aGUgdGVz\ndCBmcmFtZXdvcmsgdG8gZGVsZXRlIGFsbCB0YWJsZSBjb250ZW50cyBiZWZv\ncmUgcnVubmluZyB0aGUgdGVzdHMuCiAgICAgKiAKICAgICAqIEBwYXJhbSBw\ncm9wcwogICAgICogICAgICAgICAgICBsaXN0IG9mIHBlcnNpc3RlbnQgdHlw\nZXMgdXNlZCBpbiB0ZXN0aW5nIGFuZC9vciBjb25maWd1cmF0aW9uIHZhbHVl\ncyBpbiB0aGUgZm9ybQogICAgICogICAgICAgICAgICBrZXksdmFsdWUsa2V5\nLHZhbHVlLi4uCiAgICAgKi8KICAgIHByb3RlY3RlZCBPcGVuSlBBRW50aXR5\nTWFuYWdlckZhY3RvcnlTUEkgY3JlYXRlTmFtZWRFTUYoQ2xhc3M8Pz4uLi4g\ndHlwZXMpIHsKICAgICAgICBNYXA8T2JqZWN0LCBPYmplY3Q+IG1hcCA9IG5l\ndyBIYXNoTWFwPE9iamVjdCwgT2JqZWN0PigpOwogICAgICAgIG1hcC5wdXQo\nIm9wZW5qcGEuamRiYy5TeW5jaHJvbml6ZU1hcHBpbmdzIiwgImJ1aWxkU2No\nZW1hKEZvcmVpZ25LZXlzPXRydWUsIiArICJTY2hlbWFBY3Rpb249J2FkZCcp\nIik7CiAgICAgICAgbWFwLnB1dCgib3BlbmpwYS5qZGJjLlF1ZXJ5U1FMQ2Fj\naGUiLCAiZmFsc2UiKTsKICAgICAgICBtYXAucHV0KCJvcGVuanBhLkR5bmFt\naWNFbmhhbmNlbWVudEFnZW50IiwgImZhbHNlIik7CiAgICAgICAgbWFwLnB1\ndCgib3BlbmpwYS5SdW50aW1lVW5lbmhhbmNlZENsYXNzZXMiLCAidW5zdXBw\nb3J0ZWQiKTsKICAgICAgICBtYXAucHV0KCJvcGVuanBhLkNvbXBhdGliaWxp\ndHkiLCAiUXVvdGVkTnVtYmVyc0luUXVlcmllcz10cnVlIik7CiAgICAgICAg\nbWFwLnB1dCgib3BlbmpwYS5qZGJjLkpEQkNMaXN0ZW5lcnMiLCBuZXcgSkRC\nQ0xpc3RlbmVyW10geyBnZXRBdWRpdG9yKCkgfSk7CgogICAgICAgIFN0cmlu\nZ0J1ZmZlciBidWYgPSBuZXcgU3RyaW5nQnVmZmVyKCk7CiAgICAgICAgZm9y\nIChDbGFzczw/PiBjIDogdHlwZXMpIHsKICAgICAgICAgICAgaWYgKGJ1Zi5s\nZW5ndGgoKSA+IDApCiAgICAgICAgICAgICAgICBidWYuYXBwZW5kKCI7Iik7\nCiAgICAgICAgICAgIGJ1Zi5hcHBlbmQoYy5nZXROYW1lKCkpOwogICAgICAg\nIH0KCiAgICAgICAgbWFwLnB1dCgib3BlbmpwYS5NZXRhRGF0YUZhY3Rvcnki\nLCAianBhKFR5cGVzPSIgKyBidWYudG9TdHJpbmcoKSArICIpIik7CgogICAg\nICAgIE1hcDxPYmplY3QsIE9iamVjdD4gY29uZmlnID0gbmV3IEhhc2hNYXA8\nT2JqZWN0LCBPYmplY3Q+KFN5c3RlbS5nZXRQcm9wZXJ0aWVzKCkpOwogICAg\nICAgIGNvbmZpZy5wdXRBbGwobWFwKTsKICAgICAgICByZXR1cm4gKE9wZW5K\nUEFFbnRpdHlNYW5hZ2VyRmFjdG9yeVNQSSkgUGVyc2lzdGVuY2UuY3JlYXRl\nRW50aXR5TWFuYWdlckZhY3RvcnkoInRlc3QiLCBjb25maWcpOwogICAgfQoK\nICAgIHZvaWQgc2V0RGljdGlvbmFyeSgpIHsKICAgICAgICBKREJDQ29uZmln\ndXJhdGlvbiBjb25mID0gKEpEQkNDb25maWd1cmF0aW9uKSBnZXRFbnRpdHlN\nYW5hZ2VyRmFjdG9yeSgpLmdldENvbmZpZ3VyYXRpb24oKTsKICAgICAgICBk\naWN0ID0gY29uZi5nZXREQkRpY3Rpb25hcnlJbnN0YW5jZSgpOwogICAgICAg\nIGlmIChkaWN0IGluc3RhbmNlb2YgRGVyYnlEaWN0aW9uYXJ5KSB7CiAgICAg\nICAgICAgIGRpY3QucmVxdWlyZXNDYXN0Rm9yQ29tcGFyaXNvbnMgPSBmYWxz\nZTsKICAgICAgICAgICAgZGljdC5yZXF1aXJlc0Nhc3RGb3JNYXRoRnVuY3Rp\nb25zID0gZmFsc2U7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICog\nRXhlY3V0ZXMgdGhlIGdpdmVuIENyaXRlcmlhUXVlcnkgYW5kIEpQUUwgc3Ry\naW5nIGFuZCBjb21wYXJlIHRoZWlyIHJlc3BlY3RpdmUgU1FMcyBmb3IgZXF1\nYWxpdHkuCiAgICAgKi8KICAgIHZvaWQgYXNzZXJ0RXF1aXZhbGVuY2UoQ3Jp\ndGVyaWFRdWVyeTw/PiBjLCBTdHJpbmcganBxbCwgU3RyaW5nIGV4cGVjdGVk\nU1FMKSB7CiAgICAgICAgYXNzZXJ0RXF1aXZhbGVuY2UoYywganBxbCwgbnVs\nbCwgbnVsbCwgZXhwZWN0ZWRTUUwpOwogICAgfQoKICAgIC8qKgogICAgICog\nRXhlY3V0ZXMgdGhlIGdpdmVuIENyaXRlcmlhUXVlcnkgYW5kIEpQUUwgc3Ry\naW5nIGFuZCBjb21wYXJlIHRoZWlyIHJlc3BlY3RpdmUgU1FMcyBmb3IgZXF1\nYWxpdHkuCiAgICAgKi8KICAgIHZvaWQgYXNzZXJ0RXF1aXZhbGVuY2UoQ3Jp\ndGVyaWFRdWVyeTw/PiBjLCBTdHJpbmcganBxbCkgewogICAgICAgIFN5c3Rl\nbS5lcnIucHJpbnRsbigiSlBRTCA6IiArIGpwcWwpOwogICAgICAgIFN5c3Rl\nbS5lcnIucHJpbnRsbigiQ0pRTCA6IiArICgoQ3JpdGVyaWFRdWVyeUltcGw8\nPz4pYykudG9DUUwoKSk7CiAgICAgICAgYXNzZXJ0RXF1aXZhbGVuY2UoYywg\nanBxbCwgbnVsbCwgbnVsbCwgbnVsbCk7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBFeGVjdXRlcyB0aGUgZ2l2ZW4gQ3JpdGVyaWFRdWVyeSBhbmQgSlBRTCBz\ndHJpbmcgYW5kIGNvbXBhcmUgdGhlaXIgcmVzcGVjdGl2ZSBTUUxzIGZvciBl\ncXVhbGl0eS4gU2V0cyB0aGUKICAgICAqIHN1cHBsaWVkIHBhcmFtZXRlcnMs\nIGlmIGFueS4KICAgICAqLwogICAgdm9pZCBhc3NlcnRFcXVpdmFsZW5jZShD\ncml0ZXJpYVF1ZXJ5PD8+IGMsIFN0cmluZyBqcHFsLCBTdHJpbmdbXSBwYXJh\nbU5hbWVzLCBPYmplY3RbXSBwYXJhbXMpIHsKICAgICAgICBhc3NlcnRFcXVp\ndmFsZW5jZShjLCBqcHFsLCBwYXJhbU5hbWVzLCBwYXJhbXMsIG51bGwpOwog\nICAgfQogICAgCiAgICAvKioKICAgICAqIEV4ZWN1dGVzIHRoZSBnaXZlbiBD\ncml0ZXJpYVF1ZXJ5IGFuZCBKUFFMIHN0cmluZyBhbmQgY29tcGFyZSB0aGVp\nciByZXNwZWN0aXZlIFNRTHMgZm9yIGVxdWFsaXR5LiBTZXRzIHRoZQogICAg\nICogc3VwcGxpZWQgcGFyYW1ldGVycywgaWYgYW55LgogICAgICovCiAgICB2\nb2lkIGFzc2VydEVxdWl2YWxlbmNlKENyaXRlcmlhUXVlcnk8Pz4gYywgU3Ry\naW5nIGpwcWwsIFN0cmluZ1tdIHBhcmFtTmFtZXMsIE9iamVjdFtdIHBhcmFt\ncywKICAgICAgICBTdHJpbmcgZXhwZWN0ZWRTUUwpIHsKICAgICAgICBRdWVy\neSBjUSA9IGdldEVudGl0eU1hbmFnZXIoKS5jcmVhdGVRdWVyeShjKTsKICAg\nICAgICBRdWVyeSBqUSA9IGdldEVudGl0eU1hbmFnZXIoKS5jcmVhdGVRdWVy\neShqcHFsKTsKICAgICAgICBzZXRQYXJhbWV0ZXJzKGNRLCBwYXJhbU5hbWVz\nLCBwYXJhbXMpOwogICAgICAgIHNldFBhcmFtZXRlcnMoalEsIHBhcmFtTmFt\nZXMsIHBhcmFtcyk7CgogICAgICAgIGV4ZWN1dGVBbmRDb21wYXJlU1FMKGpw\ncWwsIGNRLCBqUSwgZXhwZWN0ZWRTUUwpOwogICAgfQoKICAgIC8qKgogICAg\nICogRXhlY3V0ZXMgdGhlIGdpdmVuIENyaXRlcmlhUXVlcnkgYW5kIEpQUUwg\nc3RyaW5nIGFuZCBjb21wYXJlIHRoZWlyIHJlc3BlY3RpdmUgU1FMcyBmb3Ig\nZXF1YWxpdHkuCiAgICAgKi8KICAgIHZvaWQgYXNzZXJ0RXF1aXZhbGVuY2Uo\nQ3JpdGVyaWFRdWVyeTw/PiBjLCBTdHJpbmcganBxbCwgT2JqZWN0W10gcGFy\nYW1zKSB7CiAgICAgICAgUXVlcnkgalEgPSBnZXRFbnRpdHlNYW5hZ2VyKCku\nY3JlYXRlUXVlcnkoanBxbCk7CiAgICAgICAgUXVlcnkgY1EgPSBnZXRFbnRp\ndHlNYW5hZ2VyKCkuY3JlYXRlUXVlcnkoYyk7CiAgICAgICAgc2V0UGFyYW1l\ndGVycyhjUSwgcGFyYW1zKTsKICAgICAgICBzZXRQYXJhbWV0ZXJzKGpRLCBw\nYXJhbXMpOwoKICAgICAgICBleGVjdXRlQW5kQ29tcGFyZVNRTChqcHFsLCBj\nUSwgalEsIG51bGwpOwogICAgfQoKICAgIC8qKgogICAgICogRXhlY3V0ZSB0\naGUgdHdvIGdpdmVuIHF1ZXJpZXMuIFRoZSBmaXJzdCBxdWVyeSBvcmlnaW5h\ndGVkIGZyb20gYSBKUFFMIHN0cmluZyBtdXN0IGJlIHdlbGwtZm9ybWVkLiBU\naGUgc2Vjb25kCiAgICAgKiBxdWVyeSBvcmlnaW5hdGVkIGZyb20gYSBDcml0\nZXJpYSBpcyBiZWluZyB0ZXN0ZWQuCiAgICAgKiAKICAgICAqIEBwYXJhbSBz\ncWxzCiAgICAgKiAgICAgICAgICAgIFRoZSB0YXJnZXQgU1FMIGZvciB0aGUg\ncXVlcmllcyB3aWxsIGJlIGZpbGxlZC1pbiB0aGUgZ2l2ZW4gYXJyYXkuCiAg\nICAgKiBAcmV0dXJuIHRydWUgaWYgYm90aCBxdWVyaWVzIGV4ZWN1dGUgc3Vj\nY2Vzc2Z1bGx5LgogICAgICovCiAgICB2b2lkIGV4ZWN1dGVBbmRDb21wYXJl\nU1FMKFN0cmluZyBqcHFsLCBRdWVyeSBjUSwgUXVlcnkgalEsIFN0cmluZyBl\neHBlY3RlZFNRTCkgewogICAgICAgIExpc3Q8U3RyaW5nPiBqU1FMID0gbnVs\nbDsKICAgICAgICBMaXN0PFN0cmluZz4gY1NRTCA9IG51bGw7CiAgICAgICAg\ndHJ5IHsKICAgICAgICAgICAgalNRTCA9IGV4ZWN1dGVRdWVyeUFuZENvbGxl\nY3RTUUwoalEpOwogICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAg\nICAgICAgICAgIFN0cmluZ1dyaXRlciB3ID0gbmV3IFN0cmluZ1dyaXRlcigp\nOwogICAgICAgICAgICBlLnByaW50U3RhY2tUcmFjZShuZXcgUHJpbnRXcml0\nZXIodykpOwogICAgICAgICAgICBmYWlsKCJKUFFMICIgKyBqcHFsICsgIiBm\nYWlsZWQgdG8gZXhlY3V0ZVxyXG4iICsgdyk7CiAgICAgICAgfQogICAgICAg\nIGdldEVudGl0eU1hbmFnZXIoKS5jbGVhcigpOwogICAgICAgIHRyeSB7CiAg\nICAgICAgICAgIGNTUUwgPSBleGVjdXRlUXVlcnlBbmRDb2xsZWN0U1FMKGNR\nKTsKICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkgewogICAgICAgICAg\nICBTdHJpbmdXcml0ZXIgdyA9IG5ldyBTdHJpbmdXcml0ZXIoKTsKICAgICAg\nICAgICAgZS5wcmludFN0YWNrVHJhY2UobmV3IFByaW50V3JpdGVyKHcpKTsK\nICAgICAgICAgICAgZmFpbCgiQ3JpdGVyaWFRdWVyeSBjb3JyZXNwb25kaW5n\nIHRvICIgKyBqcHFsICsgIiBmYWlsZWQgdG8gZXhlY3V0ZVxyXG4iICsgdyk7\nCiAgICAgICAgfQoKICAgICAgICBpZiAoalNRTC5zaXplKCkgIT0gY1NRTC5z\naXplKCkpIHsKICAgICAgICAgICAgcHJpbnRTUUwoIlRhcmdldCBTUUwgZm9y\nIEpQUUwiLCBqU1FMKTsKICAgICAgICAgICAgcHJpbnRTUUwoIlRhcmdldCBT\nUUwgZm9yIENyaXRlcmlhUXVlcnkiLCBjU1FMKTsKICAgICAgICAgICAgYXNz\nZXJ0RXF1YWxzKCJOby4gb2YgU1FMIGdlbmVyYXRlZCBmb3IgSlBRTCBhbmQg\nQ3JpdGVyaWFRdWVyeSBmb3IgIiArIGpwcWwgKyAiIGlzIGRpZmZlcmVudCIs\nIGpTUUwuc2l6ZSgpLAogICAgICAgICAgICAgICAgY1NRTC5zaXplKCkpOwog\nICAgICAgIH0KCiAgICAgICAgaWYgKCEoZGljdCBpbnN0YW5jZW9mIERlcmJ5\nRGljdGlvbmFyeSkpCiAgICAgICAgICAgIHJldHVybjsKCiAgICAgICAgZm9y\nIChpbnQgaSA9IDA7IGkgPCBqU1FMLnNpemUoKTsgaSsrKSB7CiAgICAgICAg\nICAgIGlmICghalNRTC5nZXQoaSkuZXF1YWxzKGNTUUwuZ2V0KGkpKSkgewog\nICAgICAgICAgICAgICAgcHJpbnRTUUwoIlRhcmdldCBTUUwgZm9yIEpQUUwi\nLCBqU1FMKTsKICAgICAgICAgICAgICAgIHByaW50U1FMKCJUYXJnZXQgU1FM\nIGZvciBDcml0ZXJpYVF1ZXJ5IiwgY1NRTCk7CiAgICAgICAgICAgICAgICBh\nc3NlcnRFcXVhbHMoaSArICItdGggU1FMIGZvciBKUFFMIGFuZCBDcml0ZXJp\nYVF1ZXJ5IGZvciAiICsganBxbCArICIgaXMgZGlmZmVyZW50IiwgalNRTC5n\nZXQoaSksIGNTUUwKICAgICAgICAgICAgICAgICAgICAuZ2V0KGkpKTsKICAg\nICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgKGV4cGVjdGVkU1FM\nICE9IG51bGwpIHsKICAgICAgICAgICAgYXNzZXJ0RXF1YWxzKCJTUUwgZm9y\nIEpQUUwgYW5kIEV4cGVjdGVkU1FMIGZvciAiICsganBxbCArICIgaXMgZGlm\nZmVyZW50IiwgalNRTC5nZXQoMCksIAogICAgICAgICAgICAgICAgICAgIGV4\ncGVjdGVkU1FMKTsKICAgICAgICAgICAgCiAgICAgICAgfQogICAgfQoKICAg\nIHZvaWQgZXhlY3V0ZUFuZENvbXBhcmVTUUwoU3RyaW5nIGpwcWwsIFN0cmlu\nZyBleHBlY3RlZFNRTCkgewogICAgICAgIFF1ZXJ5IGpRID0gZ2V0RW50aXR5\nTWFuYWdlcigpLmNyZWF0ZVF1ZXJ5KGpwcWwpOwoKICAgICAgICBMaXN0PFN0\ncmluZz4galNRTCA9IG51bGw7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAg\nalNRTCA9IGV4ZWN1dGVRdWVyeUFuZENvbGxlY3RTUUwoalEpOwogICAgICAg\nIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgIFN0cmluZ1dy\naXRlciB3ID0gbmV3IFN0cmluZ1dyaXRlcigpOwogICAgICAgICAgICBlLnBy\naW50U3RhY2tUcmFjZShuZXcgUHJpbnRXcml0ZXIodykpOwogICAgICAgICAg\nICBmYWlsKCJKUFFMICIgKyBqcHFsICsgIiBmYWlsZWQgdG8gZXhlY3V0ZVxy\nXG4iICsgdyk7CiAgICAgICAgfQoKICAgICAgICBpZiAoIShkaWN0IGluc3Rh\nbmNlb2YgRGVyYnlEaWN0aW9uYXJ5KSkKICAgICAgICAgICAgcmV0dXJuOwoK\nICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGpTUUwuc2l6ZSgpOyBpKysp\nIHsKICAgICAgICAgICAgaWYgKCFqU1FMLmdldChpKS5lcXVhbHMoZXhwZWN0\nZWRTUUwpKSB7CiAgICAgICAgICAgICAgICBwcmludFNRTCgiU1FMIGZvciBK\nUFFMIiwgalNRTC5nZXQoaSkpOwogICAgICAgICAgICAgICAgcHJpbnRTUUwo\nIkV4cGVjdGVkIFNRTCIsIGV4cGVjdGVkU1FMKTsKICAgICAgICAgICAgICAg\nIGFzc2VydEVxdWFscyhpICsgIi10aCBFeHBlY3RlZCBTUUwgYW5kIFNRTCBm\nb3IgSlBRTDogIiArIGpwcWwgKyAiIGFyZSBkaWZmZXJlbnQiLCBleHBlY3Rl\nZFNRTCwgalNRTAogICAgICAgICAgICAgICAgICAgIC5nZXQoaSkpOwogICAg\nICAgICAgICB9CiAgICAgICAgfQogICAgfQoKICAgIHZvaWQgZXhlY3V0ZUFu\nZENvbXBhcmVTUUwoUXVlcnkgalEsIFN0cmluZyBleHBlY3RlZFNRTCkgewog\nICAgICAgIExpc3Q8U3RyaW5nPiBqU1FMID0gbnVsbDsKICAgICAgICB0cnkg\newogICAgICAgICAgICBqU1FMID0gZXhlY3V0ZVF1ZXJ5QW5kQ29sbGVjdFNR\nTChqUSk7CiAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAgICAg\nICAgICAgU3RyaW5nV3JpdGVyIHcgPSBuZXcgU3RyaW5nV3JpdGVyKCk7CiAg\nICAgICAgICAgIGUucHJpbnRTdGFja1RyYWNlKG5ldyBQcmludFdyaXRlcih3\nKSk7CiAgICAgICAgICAgIGZhaWwody50b1N0cmluZygpKTsKICAgICAgICB9\nCgogICAgICAgIGlmICghKGRpY3QgaW5zdGFuY2VvZiBEZXJieURpY3Rpb25h\ncnkpKQogICAgICAgICAgICByZXR1cm47CgogICAgICAgIFN0cmluZyBqU3Fs\nID0galNRTC5nZXQoMCkudHJpbSgpOwogICAgICAgIGlmIChqU3FsLmluZGV4\nT2YoIm9wdGltaXplIGZvciAxIHJvdyIpICE9IC0xKQogICAgICAgICAgICBq\nU3FsID0galNxbC5zdWJzdHJpbmcoMCwgalNxbC5pbmRleE9mKCJvcHRpbWl6\nZSBmb3IgMSByb3ciKSkudHJpbSgpOwoKICAgICAgICBpZiAoIWpTcWwuZXF1\nYWxzKGV4cGVjdGVkU1FMKSkgewogICAgICAgICAgICBwcmludFNRTCgiU1FM\nIGZvciBKUFFMIiwgalNxbCk7CiAgICAgICAgICAgIGFzc2VydEVxdWFscyhl\neHBlY3RlZFNRTCwgalNxbCk7CiAgICAgICAgfQogICAgfQoKICAgIHZvaWQg\nZXhlY3V0ZUV4cGVjdEZhaWwoQ3JpdGVyaWFRdWVyeTw/PiBjLCBTdHJpbmcg\nanBxbCkgewogICAgICAgIHRyeSB7CiAgICAgICAgICAgIFF1ZXJ5IGNRID0g\nZ2V0RW50aXR5TWFuYWdlcigpLmNyZWF0ZVF1ZXJ5KGMpOwogICAgICAgICAg\nICBleGVjdXRlUXVlcnlBbmRDb2xsZWN0U1FMKGNRKTsKICAgICAgICAgICAg\nZmFpbCgiQ3JpdGVyaWFRdWVyeSBjb3JyZXNwb25kaW5nIHRvICIgKyBqcHFs\nICsgIiBpcyBleHBlY3RlZCB0byBmYWlsXHJcbiIpOwogICAgICAgIH0gY2F0\nY2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgIC8vIGV4cGVjdGVkCiAg\nICAgICAgfQogICAgfQoKICAgIHZvaWQgZXhlY3V0ZUV4cGVjdEZhaWwoQ3Jp\ndGVyaWFRdWVyeTw/PiBjLCBTdHJpbmcganBxbCwgU3RyaW5nW10gcGFyYW1O\nYW1lcywgT2JqZWN0W10gcGFyYW1zKSB7CiAgICAgICAgdHJ5IHsKICAgICAg\nICAgICAgUXVlcnkgY1EgPSBnZXRFbnRpdHlNYW5hZ2VyKCkuY3JlYXRlUXVl\ncnkoYyk7CiAgICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgcGFyYW1z\nLmxlbmd0aDsgaSsrKQogICAgICAgICAgICAgICAgY1Euc2V0UGFyYW1ldGVy\nKHBhcmFtTmFtZXNbaV0sIHBhcmFtc1tpXSk7CiAgICAgICAgICAgIGV4ZWN1\ndGVRdWVyeUFuZENvbGxlY3RTUUwoY1EpOwogICAgICAgICAgICBmYWlsKCJD\ncml0ZXJpYVF1ZXJ5IGNvcnJlc3BvbmRpbmcgdG8gIiArIGpwcWwgKyAiIGlz\nIGV4cGVjdGVkIHRvIGZhaWxcclxuIik7CiAgICAgICAgfSBjYXRjaCAoRXhj\nZXB0aW9uIGUpIHsKICAgICAgICAgICAgLy8gZXhwZWN0ZWQKICAgICAgICB9\nCiAgICB9CgogICAgdm9pZCBleGVjdXRlRXhwZWN0RmFpbChTdHJpbmcganBx\nbCkgewogICAgICAgIHRyeSB7CiAgICAgICAgICAgIFF1ZXJ5IGpRID0gZ2V0\nRW50aXR5TWFuYWdlcigpLmNyZWF0ZVF1ZXJ5KGpwcWwpOwogICAgICAgICAg\nICBleGVjdXRlUXVlcnlBbmRDb2xsZWN0U1FMKGpRKTsKICAgICAgICAgICAg\nZmFpbCgiSlBRTCAiICsganBxbCArICIgaXMgZXhwZWN0ZWQgdG8gRmFpbGVk\nIHRvIGV4ZWN1dGVcclxuIik7CiAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9u\nIGUpIHsKICAgICAgICAgICAgLy8gZXhwZWN0ZWQKICAgICAgICB9CiAgICB9\nCgogICAgdm9pZCBleGVjdXRlRXhwZWN0RmFpbChTdHJpbmcganBxbCwgU3Ry\naW5nW10gcGFyYW1OYW1lcywgT2JqZWN0W10gcGFyYW1zKSB7CiAgICAgICAg\ndHJ5IHsKICAgICAgICAgICAgUXVlcnkgalEgPSBnZXRFbnRpdHlNYW5hZ2Vy\nKCkuY3JlYXRlUXVlcnkoanBxbCk7CiAgICAgICAgICAgIGZvciAoaW50IGkg\nPSAwOyBpIDwgcGFyYW1zLmxlbmd0aDsgaSsrKQogICAgICAgICAgICAgICAg\nalEuc2V0UGFyYW1ldGVyKHBhcmFtTmFtZXNbaV0sIHBhcmFtc1tpXSk7CiAg\nICAgICAgICAgIGV4ZWN1dGVRdWVyeUFuZENvbGxlY3RTUUwoalEpOwogICAg\nICAgICAgICBmYWlsKCJKUFFMICIgKyBqcHFsICsgIiBpcyBleHBlY3RlZCB0\nbyBGYWlsZWQgdG8gZXhlY3V0ZVxyXG4iKTsKICAgICAgICB9IGNhdGNoIChF\neGNlcHRpb24gZSkgewogICAgICAgICAgICAvLyBleHBlY3RlZAogICAgICAg\nIH0KICAgIH0KCiAgICB2b2lkIHByaW50U1FMKFN0cmluZyBoZWFkZXIsIFN0\ncmluZyBzcWwpIHsKICAgICAgICBTeXN0ZW0uZXJyLnByaW50bG4oaGVhZGVy\nKTsKICAgICAgICBTeXN0ZW0uZXJyLnByaW50bG4oc3FsKTsKICAgIH0KCiAg\nICB2b2lkIHByaW50U1FMKFN0cmluZyBoZWFkZXIsIExpc3Q8U3RyaW5nPiBz\ncWxzKSB7CiAgICAgICAgU3lzdGVtLmVyci5wcmludGxuKGhlYWRlcik7CiAg\nICAgICAgZm9yIChpbnQgaSA9IDA7IHNxbHMgIT0gbnVsbCAmJiBpIDwgc3Fs\ncy5zaXplKCk7IGkrKykgewogICAgICAgICAgICBTeXN0ZW0uZXJyLnByaW50\nbG4oaSArICI6IiArIHNxbHMuZ2V0KGkpKTsKICAgICAgICB9CiAgICB9Cgog\nICAgdm9pZCBzZXRQYXJhbWV0ZXJzKFF1ZXJ5IHEsIFN0cmluZ1tdIHBhcmFt\nTmFtZXMsIE9iamVjdFtdIHBhcmFtcykgewogICAgICAgIGZvciAoaW50IGkg\nPSAwOyBwYXJhbU5hbWVzICE9IG51bGwgJiYgaSA8IHBhcmFtTmFtZXMubGVu\nZ3RoOyBpKyspCiAgICAgICAgICAgIHEuc2V0UGFyYW1ldGVyKHBhcmFtTmFt\nZXNbaV0sIHBhcmFtc1tpXSk7CiAgICB9CgogICAgdm9pZCBzZXRQYXJhbWV0\nZXJzKFF1ZXJ5IHEsIE9iamVjdFtdIHBhcmFtcykgewogICAgICAgIGZvciAo\naW50IGkgPSAwOyBwYXJhbXMgIT0gbnVsbCAmJiBpIDwgcGFyYW1zLmxlbmd0\naDsgaSsrKQogICAgICAgICAgICBxLnNldFBhcmFtZXRlcihpICsgMSwgcGFy\nYW1zW2ldKTsKICAgIH0KCiAgICAvKioKICAgICAqIEV4ZWN1dGUgdGhlIGdp\ndmVuIHF1ZXJ5IGFuZCByZXR1cm4gdGhlIGdlbmVyYXRlZCBTUUwuIElmIHRo\nZSBxdWVyeSBleGVjdXRpb24gZmFpbCBiZWNhdXNlIHRoZSBnZW5lcmF0ZWQg\nU1FMIGlzCiAgICAgKiBpbGwtZm9ybWVkLCB0aGVuIHJhaXNlZCBleGNlcHRp\nb24gc2hvdWxkIGNhcnJ5IHRoZSBpbGwtZm9ybWVkIFNRTCBmb3IgZGlhZ25v\nc2lzLgogICAgICovCiAgICBMaXN0PFN0cmluZz4gZXhlY3V0ZVF1ZXJ5QW5k\nQ29sbGVjdFNRTChRdWVyeSBxKSB7CiAgICAgICAgZ2V0QXVkaXRvcigpLmNs\nZWFyKCk7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgcS5nZXRSZXN1bHRM\naXN0KCk7CiAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAgICAg\nICAgICAgdGhyb3cgbmV3IFJ1bnRpbWVFeGNlcHRpb24oZXh0cmFjdFNRTChl\nKSwgZSk7CiAgICAgICAgfQogICAgICAgIGFzc2VydEZhbHNlKGdldEF1ZGl0\nb3IoKS5nZXRTUUxzKCkuaXNFbXB0eSgpKTsKICAgICAgICByZXR1cm4gZ2V0\nQXVkaXRvcigpLmdldFNRTHMoKTsKICAgIH0KCiAgICB2b2lkIGV4ZWN1dGVB\nbmRDb21wYXJlU1FMKENyaXRlcmlhUXVlcnk8Pz4gcSwgU3RyaW5nIGV4cGVj\ndGVkU1FMKSB7CiAgICAgICAgZXhlY3V0ZUFuZENvbXBhcmVTUUwoZ2V0RW50\naXR5TWFuYWdlcigpLmNyZWF0ZVF1ZXJ5KHEpLCBleHBlY3RlZFNRTCk7CiAg\nICB9CgogICAgU3RyaW5nIGV4dHJhY3RTUUwoRXhjZXB0aW9uIGUpIHsKICAg\nICAgICBUaHJvd2FibGUgdCA9IGUuZ2V0Q2F1c2UoKTsKICAgICAgICBpZiAo\ndCBpbnN0YW5jZW9mIFJlcG9ydGluZ1NRTEV4Y2VwdGlvbikgewogICAgICAg\nICAgICByZXR1cm4gKChSZXBvcnRpbmdTUUxFeGNlcHRpb24pIHQpLmdldFNR\nTCgpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gIkNhbiBub3QgZXh0cmFj\ndCBTUUwgZnJvbSBleGNlcHRpb24gIiArIGU7CiAgICB9CgogICAgQE92ZXJy\naWRlCiAgICBwdWJsaWMgdm9pZCBydW5CYXJlKCkgdGhyb3dzIFRocm93YWJs\nZSB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgc3VwZXIucnVuQmFyZSgp\nOwogICAgICAgIH0gY2F0Y2ggKFRocm93YWJsZSB0KSB7CiAgICAgICAgICAg\nIEFsbG93RmFpbHVyZSBhbGxvd0ZhaWx1cmUgPSBnZXRBbGxvd0ZhaWx1cmUo\nKTsKICAgICAgICAgICAgaWYgKGFsbG93RmFpbHVyZSAhPSBudWxsICYmIGFs\nbG93RmFpbHVyZS52YWx1ZSgpKSB7CiAgICAgICAgICAgICAgICBTeXN0ZW0u\nZXJyLnByaW50bG4oIioqKiBGQUlMRUQgKGJ1dCBpZ25vcmVkKTogIiArIHRo\naXMpOwogICAgICAgICAgICAgICAgU3lzdGVtLmVyci5wcmludGxuKCIqKiog\nICAgICAgICAgICAgIFJlYXNvbiA6ICIgKyBhbGxvd0ZhaWx1cmUubWVzc2Fn\nZSgpKTsKICAgICAgICAgICAgICAgIFN5c3RlbS5lcnIucHJpbnRsbigiU3Rh\nY2t0cmFjZSBvZiBmYWlsdXJlIik7CiAgICAgICAgICAgICAgICB0LnByaW50\nU3RhY2tUcmFjZSgpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAg\nICAgICAgdGhyb3cgdDsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0K\nCiAgICAvKioKICAgICAqIEFmZmlybXMgaWYgdGhlIHRlc3QgY2FzZSBvciB0\naGUgdGVzdCBtZXRob2QgaXMgYW5ub3RhdGVkIHdpdGgKICAgICAqIAogICAg\nICogQEFsbG93RmFpbHVyZS4gTWV0aG9kIGxldmVsIGFubm90YXRpb24gaGFz\nIGhpZ2hlciBwcmVjZWRlbmNlIHRoYW4gQ2xhc3MgbGV2ZWwgYW5ub3RhdGlv\nbi4KICAgICAqIAogICAgICogICAgICAgICAgICAgICAgU2V0IC1ESWdub3Jl\nQWxsb3dGYWlsdXJlPXRydWUgdG8gaWdub3JlIHRoaXMgZGlyZWN0aXZlIGFs\ndG9nZXRoZXIuCiAgICAgKi8KICAgIHByb3RlY3RlZCBBbGxvd0ZhaWx1cmUg\nZ2V0QWxsb3dGYWlsdXJlKCkgewogICAgICAgIGlmIChCb29sZWFuLmdldEJv\nb2xlYW4oIklnbm9yZUFsbG93RmFpbHVyZSIpKSB7CiAgICAgICAgICAgIHJl\ndHVybiBudWxsOwogICAgICAgIH0KICAgICAgICB0cnkgewogICAgICAgICAg\nICBNZXRob2QgcnVuTWV0aG9kID0gZ2V0Q2xhc3MoKS5nZXRNZXRob2QoZ2V0\nTmFtZSgpLCAoQ2xhc3NbXSkgbnVsbCk7CiAgICAgICAgICAgIEFsbG93RmFp\nbHVyZSBhbm5vID0gcnVuTWV0aG9kLmdldEFubm90YXRpb24oQWxsb3dGYWls\ndXJlLmNsYXNzKTsKICAgICAgICAgICAgaWYgKGFubm8gIT0gbnVsbCkgewog\nICAgICAgICAgICAgICAgcmV0dXJuIGFubm87CiAgICAgICAgICAgIH0KICAg\nICAgICB9IGNhdGNoIChTZWN1cml0eUV4Y2VwdGlvbiBlKSB7CiAgICAgICAg\nICAgIC8vIGlnbm9yZQogICAgICAgIH0gY2F0Y2ggKE5vU3VjaE1ldGhvZEV4\nY2VwdGlvbiBlKSB7CiAgICAgICAgICAgIC8vIGlnbm9yZQogICAgICAgIH0K\nICAgICAgICByZXR1cm4gZ2V0Q2xhc3MoKS5nZXRBbm5vdGF0aW9uKEFsbG93\nRmFpbHVyZS5jbGFzcyk7CiAgICB9CgogICAgcHVibGljIGNsYXNzIFNRTEF1\nZGl0b3IgZXh0ZW5kcyBBYnN0cmFjdEpEQkNMaXN0ZW5lciB7CiAgICAgICAg\ncHJpdmF0ZSBMaXN0PFN0cmluZz4gc3FscyA9IG5ldyBBcnJheUxpc3Q8U3Ry\naW5nPigpOwoKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBwdWJsaWMgdm9p\nZCBiZWZvcmVFeGVjdXRlU3RhdGVtZW50KEpEQkNFdmVudCBldmVudCkgewog\nICAgICAgICAgICBpZiAoZXZlbnQuZ2V0U1FMKCkgIT0gbnVsbCAmJiBzcWxz\nICE9IG51bGwpIHsKICAgICAgICAgICAgICAgIHNxbHMuYWRkKGV2ZW50Lmdl\ndFNRTCgpKTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgdm9p\nZCBjbGVhcigpIHsKICAgICAgICAgICAgc3Fscy5jbGVhcigpOwogICAgICAg\nIH0KCiAgICAgICAgTGlzdDxTdHJpbmc+IGdldFNRTHMoKSB7CiAgICAgICAg\nICAgIHJldHVybiBuZXcgQXJyYXlMaXN0PFN0cmluZz4oc3Fscyk7CiAgICAg\nICAgfQogICAgfQp9Cg==\n","encoding":"base64"}

