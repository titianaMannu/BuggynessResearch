{"sha":"e4a85cd953bc4b031cb17a8cc40c836f3002b54c","node_id":"MDQ6QmxvYjIwNjM2NDplNGE4NWNkOTUzYmM0YjAzMWNiMTdhOGNjNDBjODM2ZjMwMDJiNTRj","size":17918,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/e4a85cd953bc4b031cb17a8cc40c836f3002b54c","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNr\nYWdlIG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5jcml0ZXJpYS5y\nZXN1bHRzOwoKaW1wb3J0IGphdmEubGFuZy5yZWZsZWN0LkFycmF5OwppbXBv\ncnQgamF2YS51dGlsLkxpc3Q7CgppbXBvcnQgamF2YXgucGVyc2lzdGVuY2Uu\nVHVwbGU7CmltcG9ydCBqYXZheC5wZXJzaXN0ZW5jZS5jcml0ZXJpYS5Db21w\nb3VuZFNlbGVjdGlvbjsKaW1wb3J0IGphdmF4LnBlcnNpc3RlbmNlLmNyaXRl\ncmlhLkNyaXRlcmlhUXVlcnk7CmltcG9ydCBqYXZheC5wZXJzaXN0ZW5jZS5j\ncml0ZXJpYS5Kb2luOwppbXBvcnQgamF2YXgucGVyc2lzdGVuY2UuY3JpdGVy\naWEuUm9vdDsKCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVu\nY2UuY3JpdGVyaWEuQ3JpdGVyaWFUZXN0OwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLnBlcnNpc3RlbmNlLmNyaXRlcmlhLlBlcnNvbjsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5jcml0ZXJpYS5QZXJzb25f\nOwoKCi8qKgogKiBUZXN0IHZhcmlhdGlvbnMgb2Yge0BsaW5rIENyaXRlcmlh\nUXVlcnkjbXVsdGlzZWxlY3QoamF2YS51dGlsLkxpc3QpfSBhcmd1bWVudHMu\nCiAqIAogKiBAYXV0aG9yIFBpbmFraSBQb2RkYXIKICoKICovCgpwdWJsaWMg\nY2xhc3MgVGVzdE11bHRpc2VsZWN0IGV4dGVuZHMgQ3JpdGVyaWFUZXN0IHsK\nICAgIHByaXZhdGUgc3RhdGljIGJvb2xlYW4gaW5pdGlhbGl6ZWQgPSBmYWxz\nZTsKICAgIAogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgdm9pZCBzZXRVcCgp\nIHsKICAgICAgICBzdXBlci5zZXRVcCgpOwogICAgICAgIGlmICghaW5pdGlh\nbGl6ZWQpIHsKICAgICAgICAgICAgY2xlYXJEYXRhKCk7CiAgICAgICAgICAg\nIGNyZWF0ZURhdGEoKTsKICAgICAgICAgICAgaW5pdGlhbGl6ZWQgPSB0cnVl\nOwogICAgICAgIH0KICAgIH0KICAgIAogICAgdm9pZCBjbGVhckRhdGEoKSB7\nCiAgICAgICAgZW0uZ2V0VHJhbnNhY3Rpb24oKS5iZWdpbigpOwogICAgICAg\nIGVtLmNyZWF0ZVF1ZXJ5KCJERUxFVEUgRlJPTSBGb28gZiIpLmV4ZWN1dGVV\ncGRhdGUoKTsKICAgICAgICBlbS5jcmVhdGVRdWVyeSgiREVMRVRFIEZST00g\nQmFyIGIiKS5leGVjdXRlVXBkYXRlKCk7CiAgICAgICAgZW0uY3JlYXRlUXVl\ncnkoIkRFTEVURSBGUk9NIFBlcnNvbiBwIikuZXhlY3V0ZVVwZGF0ZSgpOwog\nICAgICAgIGVtLmdldFRyYW5zYWN0aW9uKCkuY29tbWl0KCk7CiAgICB9CiAg\nICAKICAgIHZvaWQgY3JlYXRlRGF0YSgpIHsKICAgICAgICBlbS5nZXRUcmFu\nc2FjdGlvbigpLmJlZ2luKCk7CiAgICAgICAgUGVyc29uIHAgPSBuZXcgUGVy\nc29uKCJUZXN0IFJlc3VsdCBTaGFwZSIpOwogICAgICAgIGVtLnBlcnNpc3Qo\ncCk7CiAgICAgICAgCiAgICAgICAgRm9vIGZvbyA9IG5ldyBGb28oMTAwTCwg\nIlRlc3QgRm9vIik7CiAgICAgICAgQmFyIGJhciA9IG5ldyBCYXIoMjAwTCwg\nIlRlc3QgQmFyIik7CiAgICAgICAgZm9vLnNldEJhcihiYXIpOwogICAgICAg\nIGVtLnBlcnNpc3QoZm9vKTsKICAgICAgICBlbS5wZXJzaXN0KGJhcik7CiAg\nICAgICAgZW0uZ2V0VHJhbnNhY3Rpb24oKS5jb21taXQoKTsKICAgIH0KICAg\nIAogICAgLyoqCiAgICAqIElmIHRoZSB0eXBlIG9mIHRoZSBjcml0ZXJpYSBx\ndWVyeSBpcyBDcml0ZXJpYVF1ZXJ5PFR1cGxlPgogICAgKiAoaS5lLiwgYSBj\ncml0ZXJpYSBxdWVyeSBvYmplY3QgY3JlYXRlZCBieSBlaXRoZXIgdGhlIAog\nICAgKiBjcmVhdGVUdXBsZVF1ZXJ5IG1ldGhvZCBvciBieSBwYXNzaW5nIGEg\nVHVwbGUgY2xhc3MgYXJndW1lbnQgCiAgICAqIHRvIHRoZSBjcmVhdGVRdWVy\neSBtZXRob2QpLCBhIFR1cGxlIG9iamVjdCBjb3JyZXNwb25kaW5nIHRvIAog\nICAgKiB0aGUgZWxlbWVudHMgb2YgdGhlIGxpc3QgcGFzc2VkIHRvIHRoZSBt\ndWx0aXNlbGVjdCBtZXRob2QgCiAgICAqIHdpbGwgYmUgaW5zdGFudGlhdGVk\nIGFuZCByZXR1cm5lZCBmb3IgZWFjaCByb3cgdGhhdCByZXN1bHRzIAogICAg\nKiBmcm9tIHRoZSBxdWVyeSBleGVjdXRpb24uCiAgICAqICovCiAgICAKICAg\nIHB1YmxpYyB2b2lkIHRlc3RUdXBsZVF1ZXJ5KCkgewogICAgICAgIENyaXRl\ncmlhUXVlcnk8VHVwbGU+IHEgPSBjYi5jcmVhdGVUdXBsZVF1ZXJ5KCk7CiAg\nICAgICAgUm9vdDxQZXJzb24+IHAgPSBxLmZyb20oUGVyc29uLmNsYXNzKTsg\nCiAgICAgICAgcS5tdWx0aXNlbGVjdChwLmdldChQZXJzb25fLm5hbWUpLCBw\nLmdldChQZXJzb25fLmlkKSk7CiAgICAgICAgCiAgICAgICAgYXNzZXJ0UmVz\ndWx0KHEsIFR1cGxlLmNsYXNzLCBTdHJpbmcuY2xhc3MsIEludGVnZXIuY2xh\nc3MpOwogICAgfQogICAgCiAgICBwdWJsaWMgdm9pZCB0ZXN0VHVwbGVRdWVy\neUV4cGxpY2l0KCkgewogICAgICAgIENyaXRlcmlhUXVlcnk8VHVwbGU+IHEg\nPSBjYi5jcmVhdGVRdWVyeShUdXBsZS5jbGFzcyk7CiAgICAgICAgUm9vdDxQ\nZXJzb24+IHAgPSBxLmZyb20oUGVyc29uLmNsYXNzKTsgCiAgICAgICAgcS5t\ndWx0aXNlbGVjdChwLmdldChQZXJzb25fLm5hbWUpLCBwLmdldChQZXJzb25f\nLmlkKSk7CiAgICAgICAgCiAgICAgICAgYXNzZXJ0UmVzdWx0KHEsIFR1cGxl\nLmNsYXNzLCBTdHJpbmcuY2xhc3MsIEludGVnZXIuY2xhc3MpOwogICAgfQog\nIAogICAgLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09\nPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQogICAgCiAgICAv\nKioKICAgICAqIElmIHRoZSB0eXBlIG9mIHRoZSBjcml0ZXJpYSBxdWVyeSBp\ncyBDcml0ZXJpYVF1ZXJ5PFg+IGZvcgogICAgICogc29tZSB1c2VyLWRlZmlu\nZWQgY2xhc3MgWCAoaS5lLiwgYSBjcml0ZXJpYSBxdWVyeSBvYmplY3QKICAg\nICAqIGNyZWF0ZWQgYnkgcGFzc2luZyBhIFggY2xhc3MgYXJndW1lbnQgdG8g\ndGhlIGNyZWF0ZVF1ZXJ5IAogICAgICogbWV0aG9kKSwgdGhlbiB0aGUgZWxl\nbWVudHMgb2YgdGhlIGxpc3QgcGFzc2VkIHRvIHRoZQogICAgICogbXVsdGlz\nZWxlY3QgbWV0aG9kIHdpbGwgYmUgcGFzc2VkIHRvIHRoZSBYIGNvbnN0cnVj\ndG9yIGFuZCAKICAgICAqIGFuIGluc3RhbmNlIG9mIHR5cGUgWCB3aWxsIGJl\nIHJldHVybmVkIGZvciBlYWNoIHJvdy4gIAogICAgICovCiAgICBwdWJsaWMg\ndm9pZCB0ZXN0VXNlclJlc3VsdFF1ZXJ5V2l0aEV4cGxpY3RQcm9qZWN0aW9u\nT2ZDb25zdHJ1Y3RvckFyZ3VtZW50cygpIHsKICAgICAgICBDcml0ZXJpYVF1\nZXJ5PFBlcnNvbj4gcSA9IGNiLmNyZWF0ZVF1ZXJ5KFBlcnNvbi5jbGFzcyk7\nCiAgICAgICAgUm9vdDxQZXJzb24+IHAgPSBxLmZyb20oUGVyc29uLmNsYXNz\nKTsgCiAgICAgICAgcS5tdWx0aXNlbGVjdChwLmdldChQZXJzb25fLm5hbWUp\nKTsKICAgICAgICAKICAgICAgICBhc3NlcnRSZXN1bHQocSwgUGVyc29uLmNs\nYXNzKTsKICAgIH0KICAgIAogICAgcHVibGljIHZvaWQgdGVzdFVzZXJSZXN1\nbHRRdWVyeVdpdGhJbXBsaWNpdFByb2plY3Rpb24oKSB7CiAgICAgICAgQ3Jp\ndGVyaWFRdWVyeTxQZXJzb24+IHEgPSBjYi5jcmVhdGVRdWVyeShQZXJzb24u\nY2xhc3MpOwogICAgICAgIHEuZnJvbShQZXJzb24uY2xhc3MpOyAKICAgICAg\nICAKICAgICAgICBhc3NlcnRSZXN1bHQocSwgUGVyc29uLmNsYXNzKTsKICAg\nIH0KCiAgICBwdWJsaWMgdm9pZCB0ZXN0VXNlclJlc3VsdFF1ZXJ5V2l0aE1p\nc21hdGNoUHJvamVjdGlvbk9mQ29uc3RydWN0b3JBcmd1bWVudHMoKSB7CiAg\nICAgICAgQ3JpdGVyaWFRdWVyeTxQZXJzb24+IHEgPSBjYi5jcmVhdGVRdWVy\neShQZXJzb24uY2xhc3MpOwogICAgICAgIFJvb3Q8UGVyc29uPiBwID0gcS5m\ncm9tKFBlcnNvbi5jbGFzcyk7IAogICAgICAgIHEubXVsdGlzZWxlY3QocC5n\nZXQoUGVyc29uXy5uYW1lKSwgcC5nZXQoUGVyc29uXy5pZCkpOwogICAgICAg\nIAogICAgICAgIGZhaWwoIlBlcnNvbiBoYXMgbm8gY29uc3RyY3V0b3Igd2l0\naCAobmFtZSxpZCkiLCBxKTsKICAgIH0KICAgIAogICAgcHVibGljIHZvaWQg\ndGVzdE11bHRpcGxlQ29uc3RydWN0b3JXaXRoQWxpYXNSZXBlYXRlZEFuZElu\nT3JkZXJpbmdDbGF1c2UoKSB7CiAgICAgICAgLy8gU0VMRUNUIE5FVyhwLm5h\nbWUpLCBwLmlkLCBORVcocC5uYW1lKSwgcC5uYW1lIEZST00gUGVyc29uIHAg\nT1JERVIgQlkgcC5uYW1lCiAgICAgICAgQ3JpdGVyaWFRdWVyeTxUdXBsZT4g\ncSA9IGNiLmNyZWF0ZVR1cGxlUXVlcnkoKTsKICAgICAgICBSb290PFBlcnNv\nbj4gcCA9IHEuZnJvbShQZXJzb24uY2xhc3MpOyAKICAgICAgICBxLm11bHRp\nc2VsZWN0KAogICAgICAgICAgICBjYi5jb25zdHJ1Y3QoUGVyc29uLmNsYXNz\nLCBwLmdldChQZXJzb25fLm5hbWUpKSwKICAgICAgICAgICAgcC5nZXQoUGVy\nc29uXy5pZCksCiAgICAgICAgICAgIGNiLmNvbnN0cnVjdChQZXJzb24uY2xh\nc3MsIHAuZ2V0KFBlcnNvbl8ubmFtZSkpLAogICAgICAgICAgICBwLmdldChQ\nZXJzb25fLm5hbWUpKQogICAgICAgICAgICAub3JkZXJCeShjYi5hc2MocC5n\nZXQoUGVyc29uXy5uYW1lKSkpOwogICAgICAgIAogICAgICAgIExpc3Q8VHVw\nbGU+IHR1cGxlcyA9IGVtLmNyZWF0ZVF1ZXJ5KHEpLmdldFJlc3VsdExpc3Qo\nKTsKICAgICAgICBhc3NlcnRUcnVlKCF0dXBsZXMuaXNFbXB0eSgpKTsKICAg\nICAgICBmb3IgKFR1cGxlIHJvdyA6IHR1cGxlcykgewogICAgICAgICAgICBh\nc3NlcnRFcXVhbHMoNCwgcm93LmdldEVsZW1lbnRzKCkuc2l6ZSgpKTsKICAg\nICAgICAgICAgCiAgICAgICAgICAgIGFzc2VydEVxdWFscyhQZXJzb24uY2xh\nc3MsICByb3cuZ2V0KDApLmdldENsYXNzKCkpOwogICAgICAgICAgICBhc3Nl\ncnRFcXVhbHMoSW50ZWdlci5jbGFzcywgcm93LmdldCgxKS5nZXRDbGFzcygp\nKTsKICAgICAgICAgICAgYXNzZXJ0RXF1YWxzKFBlcnNvbi5jbGFzcywgIHJv\ndy5nZXQoMikuZ2V0Q2xhc3MoKSk7CiAgICAgICAgICAgIGFzc2VydEVxdWFs\ncyhTdHJpbmcuY2xhc3MsICByb3cuZ2V0KDMpLmdldENsYXNzKCkpOwogICAg\nICAgICAgICAKICAgICAgICAgICAgYXNzZXJ0RXF1YWxzKCgoUGVyc29uKXJv\ndy5nZXQoMCkpLmdldE5hbWUoKSwgKChQZXJzb24pcm93LmdldCgyKSkuZ2V0\nTmFtZSgpKTsKICAgICAgICAgICAgYXNzZXJ0RXF1YWxzKCgoUGVyc29uKXJv\ndy5nZXQoMCkpLmdldE5hbWUoKSwgcm93LmdldCgzKSk7CiAgICAgICAgfQog\nICAgfQogICAgCiAgICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09\nPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiAg\nICAvKioKICAgICAqIElmIHRoZSB0eXBlIG9mIHRoZSBjcml0ZXJpYSBxdWVy\neSBpcyBDcml0ZXJpYVF1ZXJ5PFhbXT4gZm9yCiAgICAgKiBzb21lIGNsYXNz\nIFgsIGFuIGluc3RhbmNlIG9mIHR5cGUgWFtdIHdpbGwgYmUgcmV0dXJuZWQg\nZm9yIAogICAgICogZWFjaCByb3cuICAgVGhlIGVsZW1lbnRzIG9mIHRoZSBh\ncnJheSB3aWxsIGNvcnJlc3BvbmQgdG8gdGhlIAogICAgICogZWxlbWVudHMg\nb2YgdGhlIGxpc3QgcGFzc2VkIHRvIHRoZSBtdWx0aXNlbGVjdCBtZXRob2Qu\nICAKICAgICAqLwogICAgCiAgICBwdWJsaWMgdm9pZCB0ZXN0VXNlckNsYXNz\nQXJyYXkoKSB7CiAgICAgICAgQ3JpdGVyaWFRdWVyeTxQZXJzb25bXT4gcSA9\nIGNiLmNyZWF0ZVF1ZXJ5KFBlcnNvbltdLmNsYXNzKTsKICAgICAgICBSb290\nPFBlcnNvbj4gcCA9IHEuZnJvbShQZXJzb24uY2xhc3MpOyAKICAgICAgICBx\nLm11bHRpc2VsZWN0KHAscCk7CiAgICAgICAgCiAgICAgICAgYXNzZXJ0UmVz\ndWx0KHEsIFBlcnNvbltdLmNsYXNzLCBQZXJzb24uY2xhc3MsIFBlcnNvbi5j\nbGFzcyk7CiAgICB9CiAgICAKICAgIHB1YmxpYyB2b2lkIHRlc3RCYXNpY0Ns\nYXNzQXJyYXkoKSB7CiAgICAgICAgQ3JpdGVyaWFRdWVyeTxTdHJpbmdbXT4g\ncSA9IGNiLmNyZWF0ZVF1ZXJ5KFN0cmluZ1tdLmNsYXNzKTsKICAgICAgICBS\nb290PFBlcnNvbj4gcCA9IHEuZnJvbShQZXJzb24uY2xhc3MpOyAKICAgICAg\nICBxLm11bHRpc2VsZWN0KHAuZ2V0KFBlcnNvbl8ubmFtZSksIHAuZ2V0KFBl\ncnNvbl8ubmFtZSkpOwogICAgICAgIAogICAgICAgIGFzc2VydFJlc3VsdChx\nLCBTdHJpbmdbXS5jbGFzcyk7CiAgICB9CiAgICAKICAgIHB1YmxpYyB2b2lk\nIHRlc3RUdXBsZUFycmF5KCkgewogICAgICAgIENyaXRlcmlhUXVlcnk8VHVw\nbGVbXT4gcSA9IGNiLmNyZWF0ZVF1ZXJ5KFR1cGxlW10uY2xhc3MpOwogICAg\nICAgIFJvb3Q8UGVyc29uPiBwID0gcS5mcm9tKFBlcnNvbi5jbGFzcyk7IAog\nICAgICAgIHEubXVsdGlzZWxlY3QocC5nZXQoUGVyc29uXy5uYW1lKSwgcC5n\nZXQoUGVyc29uXy5pZCksIHAuZ2V0KFBlcnNvbl8ubmFtZSkpOwogICAgICAg\nIAogICAgICAgIGFzc2VydFJlc3VsdChxLCBUdXBsZVtdLmNsYXNzLCBTdHJp\nbmcuY2xhc3MsIEludGVnZXIuY2xhc3MsIFN0cmluZy5jbGFzcyk7CiAgICB9\nCi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09\nPT09PT09PT09PT09PT09PT09PT09PT09ICAgIAogICAgLyoqCiAgICAgKiBJ\nZiB0aGUgdHlwZSBvZiB0aGUgY3JpdGVyaWEgcXVlcnkgaXMgQ3JpdGVyaWFR\ndWVyeTxPYmplY3Q+CiAgICAgKiBvciBpZiB0aGUgY3JpdGVyaWEgcXVlcnkg\nd2FzIGNyZWF0ZWQgd2l0aG91dCBzcGVjaWZ5aW5nIGEgCiAgICAgKiB0eXBl\nLCBhbmQgdGhlIGxpc3QgcGFzc2VkIHRvIHRoZSBtdWx0aXNlbGVjdCBtZXRo\nb2QgY29udGFpbnMgCiAgICAgKiBvbmx5IGEgc2luZ2xlIGVsZW1lbnQsIGFu\nIGluc3RhbmNlIG9mIHR5cGUgT2JqZWN0IHdpbGwgYmUgCiAgICAgKiByZXR1\ncm5lZCBmb3IgZWFjaCByb3cuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHRl\nc3RTaW5nbGVPYmplY3QoKSB7CiAgICAgICAgQ3JpdGVyaWFRdWVyeTxPYmpl\nY3Q+IHEgPSBjYi5jcmVhdGVRdWVyeShPYmplY3QuY2xhc3MpOwogICAgICAg\nIFJvb3Q8UGVyc29uPiBwID0gcS5mcm9tKFBlcnNvbi5jbGFzcyk7CiAgICAg\nICAgcS5tdWx0aXNlbGVjdChwKTsKICAgICAgICAKICAgICAgICBhc3NlcnRS\nZXN1bHQocSwgT2JqZWN0LmNsYXNzKTsKICAgIH0KICAgIAogICAgcHVibGlj\nIHZvaWQgdGVzdFNpbmdsZU9iamVjdFZpYUNvbnN0cnVjdG9yKCkgewogICAg\nICAgIENyaXRlcmlhUXVlcnk8T2JqZWN0PiBxID0gY2IuY3JlYXRlUXVlcnko\nT2JqZWN0LmNsYXNzKTsKICAgICAgICBSb290PFBlcnNvbj4gcCA9IHEuZnJv\nbShQZXJzb24uY2xhc3MpOwogICAgICAgIHEubXVsdGlzZWxlY3QoY2IuY29u\nc3RydWN0KFBlcnNvbi5jbGFzcywgcC5nZXQoUGVyc29uXy5uYW1lKSkpOwog\nICAgICAgIAogICAgICAgIGFzc2VydFJlc3VsdChxLCBPYmplY3QuY2xhc3Mp\nOwogICAgfQogICAgCiAgICBwdWJsaWMgdm9pZCB0ZXN0U2luZ2xlT2JqZWN0\nQXNQcm9wZXJ0eSgpIHsKICAgICAgICBDcml0ZXJpYVF1ZXJ5PE9iamVjdD4g\ncSA9IGNiLmNyZWF0ZVF1ZXJ5KE9iamVjdC5jbGFzcyk7CiAgICAgICAgUm9v\ndDxQZXJzb24+IHAgPSBxLmZyb20oUGVyc29uLmNsYXNzKTsKICAgICAgICBx\nLm11bHRpc2VsZWN0KHAuZ2V0KFBlcnNvbl8ubmFtZSkpOwogICAgICAgIAog\nICAgICAgIGFzc2VydFJlc3VsdChxLCBPYmplY3QuY2xhc3MpOwogICAgfQog\nICAgCiAgICBwdWJsaWMgdm9pZCB0ZXN0U2luZ2xlT2JqZWN0SW1wbGljaXQo\nKSB7CiAgICAgICAgQ3JpdGVyaWFRdWVyeTw/PiBxID0gY2IuY3JlYXRlUXVl\ncnkoKTsKICAgICAgICBSb290PFBlcnNvbj4gcCA9IHEuZnJvbShQZXJzb24u\nY2xhc3MpOwogICAgICAgIHEubXVsdGlzZWxlY3QocCk7CiAgICAgICAgCiAg\nICAgICAgYXNzZXJ0UmVzdWx0KHEsIE9iamVjdC5jbGFzcyk7CiAgICB9CiAg\nICAKICAgIHB1YmxpYyB2b2lkIHRlc3RTaW5nbGVPYmplY3RWaWFDb25zdHJ1\nY3RvckltcGxpY2l0KCkgewogICAgICAgIENyaXRlcmlhUXVlcnk8Pz4gcSA9\nIGNiLmNyZWF0ZVF1ZXJ5KCk7CiAgICAgICAgUm9vdDxQZXJzb24+IHAgPSBx\nLmZyb20oUGVyc29uLmNsYXNzKTsKICAgICAgICBxLm11bHRpc2VsZWN0KGNi\nLmNvbnN0cnVjdChQZXJzb24uY2xhc3MsIHAuZ2V0KFBlcnNvbl8ubmFtZSkp\nKTsKICAgICAgICAKICAgICAgICBhc3NlcnRSZXN1bHQocSwgT2JqZWN0LmNs\nYXNzKTsKICAgIH0KICAgIAogICAgcHVibGljIHZvaWQgdGVzdFNpbmdsZU9i\namVjdEFzUHJvcGVydHlJbXBsaWNpdCgpIHsKICAgICAgICBDcml0ZXJpYVF1\nZXJ5PD8+IHEgPSBjYi5jcmVhdGVRdWVyeSgpOwogICAgICAgIFJvb3Q8UGVy\nc29uPiBwID0gcS5mcm9tKFBlcnNvbi5jbGFzcyk7CiAgICAgICAgcS5tdWx0\naXNlbGVjdChwLmdldChQZXJzb25fLm5hbWUpKTsKICAgICAgICAKICAgICAg\nICBhc3NlcnRSZXN1bHQocSwgT2JqZWN0LmNsYXNzKTsKICAgIH0KCi8vID09\nPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09\nPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiAgICAvKioKICAg\nICAqIElmIHRoZSB0eXBlIG9mIHRoZSBjcml0ZXJpYSBxdWVyeSBpcyBDcml0\nZXJpYVF1ZXJ5PE9iamVjdD4KICAgICAqIG9yIGlmIHRoZSBjcml0ZXJpYSBx\ndWVyeSB3YXMgY3JlYXRlZCB3aXRob3V0IHNwZWNpZnlpbmcgYSAKICAgICAq\nIHR5cGUsIGFuZCB0aGUgbGlzdCBwYXNzZWQgdG8gdGhlIG11bHRpc2VsZWN0\nIG1ldGhvZCBjb250YWlucyAKICAgICAqIG1vcmUgdGhhbiBvbmUgZWxlbWVu\ndCwgYW4gaW5zdGFuY2Ugb2YgdHlwZSBPYmplY3RbXSB3aWxsIGJlIAogICAg\nICogaW5zdGFudGlhdGVkIGFuZCByZXR1cm5lZCBmb3IgZWFjaCByb3cuICBU\naGUgZWxlbWVudHMgb2YgdGhlIAogICAgICogYXJyYXkgd2lsbCBjb3JyZXNw\nb25kIHRvIHRoZSBlbGVtZW50cyBvZiB0aGUgbGlzdCBwYXNzZWQgdG8KICAg\nICAqIHRoZSBtdWx0aXNlbGVjdCBtZXRob2QuCiAgICAgKi8KICAgIHB1Ymxp\nYyB2b2lkIHRlc3RTaW5nbGVPYmplY3RNdWx0aXBsZVByb2plY3Rpb25zKCkg\newogICAgICAgIENyaXRlcmlhUXVlcnk8T2JqZWN0PiBxID0gY2IuY3JlYXRl\nUXVlcnkoT2JqZWN0LmNsYXNzKTsKICAgICAgICBSb290PFBlcnNvbj4gcCA9\nIHEuZnJvbShQZXJzb24uY2xhc3MpOwogICAgICAgIHEubXVsdGlzZWxlY3Qo\ncC5nZXQoUGVyc29uXy5uYW1lKSwgcC5nZXQoUGVyc29uXy5pZCkpOwogICAg\nICAgIAogICAgICAgIGFzc2VydFJlc3VsdChxLCBPYmplY3RbXS5jbGFzcywg\nU3RyaW5nLmNsYXNzLCBJbnRlZ2VyLmNsYXNzKTsKICAgIH0KICAgIAogICAg\ncHVibGljIHZvaWQgdGVzdFNpbmdsZU9iamVjdE11bHRpcGxlUHJvamVjdGlv\nbnNBbmRDb25zdHJ1Y3RvcigpIHsKICAgICAgICBDcml0ZXJpYVF1ZXJ5PE9i\namVjdD4gcSA9IGNiLmNyZWF0ZVF1ZXJ5KE9iamVjdC5jbGFzcyk7CiAgICAg\nICAgUm9vdDxQZXJzb24+IHAgPSBxLmZyb20oUGVyc29uLmNsYXNzKTsKICAg\nICAgICBxLm11bHRpc2VsZWN0KGNiLmNvbnN0cnVjdChQZXJzb24uY2xhc3Ms\nIHAuZ2V0KFBlcnNvbl8ubmFtZSkpLCBwLmdldChQZXJzb25fLmlkKSwgcC5n\nZXQoUGVyc29uXy5uYW1lKSk7CiAgICAgICAgCiAgICAgICAgYXNzZXJ0UmVz\ndWx0KHEsIE9iamVjdFtdLmNsYXNzLCBQZXJzb24uY2xhc3MsIEludGVnZXIu\nY2xhc3MsIFN0cmluZy5jbGFzcyk7CiAgICB9CiAgICAKICAgIC8qKgogICAg\nICogQW4gZWxlbWVudCBvZiB0aGUgbGlzdCBwYXNzZWQgdG8gdGhlIG11bHRp\nc2VsZWN0IG1ldGhvZCAKICAgICAqIG11c3Qgbm90IGJlIGEgdHVwbGUtIG9y\nIGFycmF5LXZhbHVlZCBjb21wb3VuZCBzZWxlY3Rpb24gaXRlbS4gCiAgICAg\nKiAKICAgICAqLwogICAgLy8gVGhpcyB0ZXN0IGlzIHJldGlyZWQgYmVjYXVz\nZSB3ZSBhcmUgbm93IHN1cHBvcnRpbmcgYXJiaXRyYXJ5IG5lc3RpbmcgCiAg\nICBwdWJsaWMgdm9pZCB4dGVzdFR1cGxlQ2FuTm90QmVOZXN0ZWQoKSB7CiAg\nICAgICAgQ3JpdGVyaWFRdWVyeTxUdXBsZT4gcSA9IGNiLmNyZWF0ZVR1cGxl\nUXVlcnkoKTsKICAgICAgICBSb290PFBlcnNvbj4gcCA9IHEuZnJvbShQZXJz\nb24uY2xhc3MpOwogICAgICAgIAogICAgICAgIENvbXBvdW5kU2VsZWN0aW9u\nPFR1cGxlPiB0dXBsZTEgPSBjYi50dXBsZShwLmdldChQZXJzb25fLm5hbWUp\nLCBwLmdldChQZXJzb25fLmlkKSk7CiAgICAgICAgQ29tcG91bmRTZWxlY3Rp\nb248VHVwbGU+IHR1cGxlMiA9IGNiLnR1cGxlKHAuZ2V0KFBlcnNvbl8uaWQp\nLCBwLmdldChQZXJzb25fLm5hbWUpKTsKICAgICAgICAKICAgICAgICB0cnkg\newogICAgICAgICAgICBjYi50dXBsZSh0dXBsZTEsIHR1cGxlMik7CiAgICAg\nICAgICAgIGZhaWwoIkV4cGVjdGVkIGV4Y2VwdGlvbiB3aGlsZSBuZXN0aW5n\nIHR1cGxlcyIpOwogICAgICAgIH0gY2F0Y2ggKElsbGVnYWxBcmd1bWVudEV4\nY2VwdGlvbiBlKSB7CiAgICAgICAgICAgIAogICAgICAgIH0KICAgIH0KICAg\nIAogICAgcHVibGljIHZvaWQgdGVzdE11bHRpQ29uc3RydWN0b3IoKSB7CiAg\nICAgICAgLy8gU0VMRUNUIE5FVyBGb28oZi5maWQsZi5maW50KSwgYiwgTkVX\nIEZvb0JhcihmLmZpZCwgYi5iaWQpIGZyb20gRm9vIGYgSk9JTiBmLmJhciBi\nIFdIRVJFIGYuYj1iCiAgICAgICAgQ3JpdGVyaWFRdWVyeTxPYmplY3RbXT4g\ncSA9IGNiLmNyZWF0ZVF1ZXJ5KE9iamVjdFtdLmNsYXNzKTsKICAgICAgICBS\nb290PEZvbz4gZiA9IHEuZnJvbShGb28uY2xhc3MpOwogICAgICAgIEpvaW48\nRm9vLCBCYXI+IGIgPSBmLmpvaW4oRm9vXy5iYXIpOwogICAgICAgIHEubXVs\ndGlzZWxlY3QoY2IuY29uc3RydWN0KEZvby5jbGFzcywgZi5nZXQoRm9vXy5m\naWQpLCBmLmdldChGb29fLmZzdHJpbmcpKSwgCiAgICAgICAgICAgICAgICAg\nICAgICBiLCAKICAgICAgICAgICAgICAgICAgICAgIGNiLmNvbnN0cnVjdChG\nb29CYXIuY2xhc3MsIGYuZ2V0KEZvb18uZmlkKSwgYi5nZXQoQmFyXy5iaWQp\nKSk7CiAgICAgICAgcS53aGVyZShjYi5lcXVhbChmLmdldChGb29fLmZpZCks\nIDEwMEwpKTsKICAgICAgICAKICAgICAgICBMaXN0PE9iamVjdFtdPiByZXN1\nbHQgPSBlbS5jcmVhdGVRdWVyeShxKS5nZXRSZXN1bHRMaXN0KCk7CiAgICAg\nICAgYXNzZXJ0RmFsc2UocmVzdWx0LmlzRW1wdHkoKSk7CiAgICAgICAgZm9y\nIChPYmplY3RbXSByb3cgOiByZXN1bHQpIHsKICAgICAgICAgICAgYXNzZXJ0\nRXF1YWxzKDMsIHJvdy5sZW5ndGgpOwogICAgICAgICAgICBhc3NlcnRUcnVl\nKCIwLXRoIGVsZW1lbnQgIiArIHJvd1swXS5nZXRDbGFzcygpICsgIiBpcyBu\nb3QgRm9vIiwgcm93WzBdIGluc3RhbmNlb2YgRm9vKTsKICAgICAgICAgICAg\nYXNzZXJ0VHJ1ZSgiMS1zdCBlbGVtZW50ICIgKyByb3dbMV0uZ2V0Q2xhc3Mo\nKSArICIgaXMgbm90IEJhciIsIHJvd1sxXSBpbnN0YW5jZW9mIEJhcik7CiAg\nICAgICAgICAgIGFzc2VydFRydWUoIjItbmQgZWxlbWVudCAiICsgcm93WzJd\nLmdldENsYXNzKCkgKyAiIGlzIG5vdCBGb29CYXIiLCByb3dbMl0gaW5zdGFu\nY2VvZiBGb29CYXIpOwogICAgICAgIH0KICAgIH0KICAgIAogICAgcHVibGlj\nIHZvaWQgdGVzdFNlbGVjdFNpbmdsZVRlcm1XaXRoTXVsdGlzZWxlY3RPYmpl\nY3RBcnJheSgpIHsKICAgICAgICBDcml0ZXJpYVF1ZXJ5PE9iamVjdFtdPiBx\nID0gY2IuY3JlYXRlUXVlcnkoT2JqZWN0W10uY2xhc3MpOwogICAgICAgIFJv\nb3Q8Rm9vPiBmID0gcS5mcm9tKEZvby5jbGFzcyk7CiAgICAgICAgcS5tdWx0\naXNlbGVjdChmKTsKICAgICAgICAKICAgICAgICBhc3NlcnRSZXN1bHQocSwg\nT2JqZWN0W10uY2xhc3MsIEZvby5jbGFzcyk7CiAgICB9CiAgICAKICAgIHB1\nYmxpYyB2b2lkIHRlc3RTZWxlY3RTaW5nbGVUZXJtV2l0aE11bHRpc2VsZWN0\nT2JqZWN0KCkgewogICAgICAgIENyaXRlcmlhUXVlcnk8T2JqZWN0PiBxID0g\nY2IuY3JlYXRlUXVlcnkoT2JqZWN0LmNsYXNzKTsKICAgICAgICBSb290PEZv\nbz4gZiA9IHEuZnJvbShGb28uY2xhc3MpOwogICAgICAgIHEubXVsdGlzZWxl\nY3QoZik7CiAgICAgICAgCiAgICAgICAgYXNzZXJ0UmVzdWx0KHEsIEZvby5j\nbGFzcyk7CiAgICB9CiAgICAKICAgIHB1YmxpYyB2b2lkIHRlc3RTZWxlY3RT\naW5nbGVUZXJtV2l0aE11bHRpc2VsZWN0VHVwbGUoKSB7CiAgICAgICAgQ3Jp\ndGVyaWFRdWVyeTxUdXBsZT4gcSA9IGNiLmNyZWF0ZVF1ZXJ5KFR1cGxlLmNs\nYXNzKTsKICAgICAgICBSb290PEZvbz4gZiA9IHEuZnJvbShGb28uY2xhc3Mp\nOwogICAgICAgIHEubXVsdGlzZWxlY3QoZik7CiAgICAgICAgCiAgICAgICAg\nYXNzZXJ0UmVzdWx0KHEsIFR1cGxlLmNsYXNzLCBGb28uY2xhc3MpOwogICAg\nfQogICAgCiAgICBwdWJsaWMgdm9pZCB0ZXN0U2VsZWN0U2luZ2xlVGVybVdp\ndGhNdWx0aXNlbGVjdFR1cGxlQXJyYXkoKSB7CiAgICAgICAgQ3JpdGVyaWFR\ndWVyeTxUdXBsZVtdPiBxID0gY2IuY3JlYXRlUXVlcnkoVHVwbGVbXS5jbGFz\ncyk7CiAgICAgICAgUm9vdDxGb28+IGYgPSBxLmZyb20oRm9vLmNsYXNzKTsK\nICAgICAgICBxLm11bHRpc2VsZWN0KGYpOwogICAgICAgIAogICAgICAgIGFz\nc2VydFJlc3VsdChxLCBUdXBsZVtdLmNsYXNzLCBGb28uY2xhc3MpOwogICAg\nfQogICAgCiAgICBwdWJsaWMgdm9pZCB0ZXN0U2FuaXR5KCkgewogICAgICAg\nIENyaXRlcmlhUXVlcnk8Rm9vPiBxID0gY2IuY3JlYXRlUXVlcnkoRm9vLmNs\nYXNzKTsKICAgICAgICBSb290PEZvbz4gZiA9IHEuZnJvbShGb28uY2xhc3Mp\nOwogICAgICAgIAogICAgICAgIGFzc2VydFJlc3VsdChxLCBGb28uY2xhc3Mp\nOwogICAgfQogICAgCiAgICBwdWJsaWMgdm9pZCB0ZXN0U2FuaXR5MigpIHsK\nICAgICAgICBDcml0ZXJpYVF1ZXJ5PEZvbz4gcSA9IGNiLmNyZWF0ZVF1ZXJ5\nKEZvby5jbGFzcyk7CiAgICAgICAgUm9vdDxGb28+IGYgPSBxLmZyb20oRm9v\nLmNsYXNzKTsKICAgICAgICBxLnNlbGVjdChmKTsKICAgICAgICBhc3NlcnRS\nZXN1bHQocSwgRm9vLmNsYXNzKTsKICAgIH0KICAgIAogICAgcHVibGljIHZv\naWQgdGVzdERlZXBseU5lc3RlZFNoYXBlKCkgewogICAgICAgIENyaXRlcmlh\nUXVlcnk8VHVwbGU+IHEgPSBjYi5jcmVhdGVRdWVyeShUdXBsZS5jbGFzcyk7\nCiAgICAgICAgUm9vdDxGb28+IGZvbyA9IHEuZnJvbShGb28uY2xhc3MpOwog\nICAgICAgIHEubXVsdGlzZWxlY3QoY2IuY29uc3RydWN0KEZvby5jbGFzcywg\nZm9vLmdldChGb29fLmZsb25nKSwgZm9vLmdldChGb29fLmZzdHJpbmcpKSwg\nCiAgICAgICAgICAgICAgICAgY2IudHVwbGUoZm9vLCBjYi5hcnJheShmb28u\nZ2V0KEZvb18uZmludCksIGNiLnR1cGxlKGZvby5nZXQoRm9vXy5mc3RyaW5n\nKSkpKSk7CiAgICAgICAgTGlzdDxUdXBsZT4gcmVzdWx0ID0gZW0uY3JlYXRl\nUXVlcnkocSkuZ2V0UmVzdWx0TGlzdCgpOwogICAgICAgIGFzc2VydEZhbHNl\nKHJlc3VsdC5pc0VtcHR5KCkpOwogICAgICAgIFR1cGxlIHR1cGxlID0gcmVz\ndWx0LmdldCgwKTsKICAgICAgICAKICAgICAgICBhc3NlcnRFcXVhbHMoRm9v\nLmNsYXNzLCAgIHR1cGxlLmdldCgwKS5nZXRDbGFzcygpKTsKICAgICAgICBh\nc3NlcnRUcnVlKFR1cGxlLmNsYXNzLmlzQXNzaWduYWJsZUZyb20odHVwbGUu\nZ2V0KDEpLmdldENsYXNzKCkpKTsKICAgICAgICBUdXBsZSB0dXBsZTIgPSAo\nVHVwbGUpdHVwbGUuZ2V0KDEpOwogICAgICAgIGFzc2VydEVxdWFscyhGb28u\nY2xhc3MsICAgdHVwbGUyLmdldCgwKS5nZXRDbGFzcygpKTsKICAgICAgICBh\nc3NlcnRFcXVhbHMoT2JqZWN0W10uY2xhc3MsIHR1cGxlMi5nZXQoMSkuZ2V0\nQ2xhc3MoKSk7CiAgICAgICAgT2JqZWN0W10gbGV2ZWwzID0gKE9iamVjdFtd\nKXR1cGxlMi5nZXQoMSk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKEludGVnZXIu\nY2xhc3MsIGxldmVsM1swXS5nZXRDbGFzcygpKTsKICAgICAgICBhc3NlcnRU\ncnVlKFR1cGxlLmNsYXNzLmlzQXNzaWduYWJsZUZyb20obGV2ZWwzWzFdLmdl\ndENsYXNzKCkpKTsKICAgICAgICBUdXBsZSB0dXBsZTQgPSAoVHVwbGUpbGV2\nZWwzWzFdOwogICAgICAgIGFzc2VydEVxdWFscyhTdHJpbmcuY2xhc3MsIHR1\ncGxlNC5nZXQoMCkuZ2V0Q2xhc3MoKSk7CiAgICB9CiAgICAKICAgIHB1Ymxp\nYyB2b2lkIHRlc3RDb25zdHJ1Y3RvckZhaWxzRmFzdCgpIHsKICAgICAgICBD\ncml0ZXJpYVF1ZXJ5PFR1cGxlPiBxID0gY2IuY3JlYXRlUXVlcnkoVHVwbGUu\nY2xhc3MpOwogICAgICAgIFJvb3Q8Rm9vPiBmb28gPSBxLmZyb20oRm9vLmNs\nYXNzKTsKICAgICAgICB0cnkgewogICAgICAgICAgICBxLm11bHRpc2VsZWN0\nKGNiLmNvbnN0cnVjdChGb28uY2xhc3MsIGZvby5nZXQoRm9vXy5mbG9uZykp\nKTsKICAgICAgICAgICAgZmFpbCgiRXhwZWN0ZWQgSWxsZWdhbEFyZ3VtZW50\nRXhjZXB0aW9uIGJlY3Vhc2UgRm9vKGxvbmcpIGlzIG5vdCBhIHZhbGlkIGNv\nbnN0cnVjdG9yIik7CiAgICAgICAgfSBjYXRjaCAoSWxsZWdhbEFyZ3VtZW50\nRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgLy8gZ29vZCAtLSBidXQgcHJp\nbnQgdGhlIGVycm9yIG1lc3NhZ2UgdG8gY2hlY2sgaXQgaXMgaW5mb3JtYXRp\ndmUgZW5vdWdoCiAgICAgICAgICAgIFN5c3RlbS5lcnIucHJpbnRsbihlKTsK\nICAgICAgICB9CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgcS5tdWx0aXNl\nbGVjdChjYi5jb25zdHJ1Y3QoRm9vLmNsYXNzKSk7CiAgICAgICAgICAgIGZh\naWwoIkV4cGVjdGVkIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiBiZWN1YXNl\nIEZvbygpIGlzIG5vdCBhIHZhbGlkIGNvbnN0cnVjdG9yIik7CiAgICAgICAg\nfSBjYXRjaCAoSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uIGUpIHsKICAgICAg\nICAgICAgLy8gZ29vZCAtLSBidXQgcHJpbnQgdGhlIGVycm9yIG1lc3NhZ2Ug\ndG8gY2hlY2sgaXQgaXMgaW5mb3JtYXRpdmUgZW5vdWdoCiAgICAgICAgICAg\nIFN5c3RlbS5lcnIucHJpbnRsbihlKTsKICAgICAgICB9CiAgICAgICAgCiAg\nICB9CiAgICAKLy8gPT09PT09PT09PT09PT09IGFzc2VydGlvbnMgYnkgcmVz\ndWx0IHR5cGVzID09PT09PT09PT09PT09PT09PT09PT09PQogICAgCiAgICB2\nb2lkIGFzc2VydFJlc3VsdChDcml0ZXJpYVF1ZXJ5PD8+IHEsIENsYXNzPD8+\nIHJlc3VsdENsYXNzKSB7CiAgICAgICAgYXNzZXJ0UmVzdWx0KHEsIHJlc3Vs\ndENsYXNzLCAoQ2xhc3M8Pz5bXSludWxsKTsKICAgIH0KICAgIC8qKgogICAg\nICogQXNzZXJ0IHRoZSBxdWVyeSByZXN1bHQgZWxlbWVudHMgYnkgdGhlaXIg\ndHlwZXMgCiAgICAgKi8KICAgIHZvaWQgYXNzZXJ0UmVzdWx0KENyaXRlcmlh\nUXVlcnk8Pz4gcSwgQ2xhc3M8Pz4gcmVzdWx0Q2xhc3MsIENsYXNzPD8+Li4u\nIGFycmF5RWxlbWVudENsYXNzZXMpIHsKICAgICAgICBMaXN0PD8+IHJlc3Vs\ndCA9IGVtLmNyZWF0ZVF1ZXJ5KHEpLmdldFJlc3VsdExpc3QoKTsKICAgICAg\nICBhc3NlcnRGYWxzZShyZXN1bHQuaXNFbXB0eSgpKTsKICAgICAgICBmb3Ig\nKE9iamVjdCByb3cgOiByZXN1bHQpIHsKICAgICAgICAgICAgYXNzZXJ0VHJ1\nZSh0b0NsYXNzKHJvdykgKyAiIGRvZXMgbm90IG1hdGNoIGFjdHVhbCByZXN1\nbHQgIiArIHRvU3RyaW5nKHJlc3VsdENsYXNzKSwgCiAgICAgICAgICAgICAg\nICByZXN1bHRDbGFzcy5pc0luc3RhbmNlKHJvdykpOwogICAgICAgICAgICBp\nZiAocmVzdWx0Q2xhc3MuaXNBcnJheSgpICYmIGFycmF5RWxlbWVudENsYXNz\nZXMgIT0gbnVsbCkgewogICAgICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7\nIGkgPCBhcnJheUVsZW1lbnRDbGFzc2VzLmxlbmd0aDsgaSsrKSB7CiAgICAg\nICAgICAgICAgICAgICAgT2JqZWN0IGVsZW1lbnQgPSBBcnJheS5nZXQocm93\nLCBpKTsKICAgICAgICAgICAgICAgICAgICBpZiAoVHVwbGUuY2xhc3MuaXNJ\nbnN0YW5jZShlbGVtZW50KSkgewogICAgICAgICAgICAgICAgICAgICAgICBh\nc3NlcnRFcXVhbHMoYXJyYXlFbGVtZW50Q2xhc3Nlc1tpXSwgVHVwbGUuY2xh\nc3MuY2FzdChlbGVtZW50KS5nZXQoMCkuZ2V0Q2xhc3MoKSk7IAogICAgICAg\nICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgYXNz\nZXJ0VHJ1ZShpICsgIi10aCBhcnJheSBlbGVtZW50ICIgKyB0b1N0cmluZyhh\ncnJheUVsZW1lbnRDbGFzc2VzW2ldKSArIAogICAgICAgICAgICAgICAgICAg\nICAgICIgZG9lcyBub3QgbWF0Y2ggYWN0dWFsIHJlc3VsdCAiICsgdG9DbGFz\ncyhlbGVtZW50KSwgYXJyYXlFbGVtZW50Q2xhc3Nlc1tpXS5pc0luc3RhbmNl\nKGVsZW1lbnQpKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAg\nICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKHJlc3VsdENs\nYXNzID09IFR1cGxlLmNsYXNzICYmIGFycmF5RWxlbWVudENsYXNzZXMgIT0g\nbnVsbCkgewogICAgICAgICAgICAgICAgVHVwbGUgdHVwbGUgPSAoVHVwbGUp\ncm93OwogICAgICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBhcnJh\neUVsZW1lbnRDbGFzc2VzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAg\nICAgICAgT2JqZWN0IGVsZW1lbnQgPSB0dXBsZS5nZXQoaSk7CiAgICAgICAg\nICAgICAgICAgICAgYXNzZXJ0VHJ1ZShpICsgIi10aCB0dXBsZSBlbGVtZW50\nICIgKyB0b1N0cmluZyhhcnJheUVsZW1lbnRDbGFzc2VzW2ldKSArIAogICAg\nICAgICAgICAgICAgICAgICAgICIgZG9lcyBub3QgbWF0Y2ggYWN0dWFsIHJl\nc3VsdCAiICsgdG9DbGFzcyhlbGVtZW50KSwgYXJyYXlFbGVtZW50Q2xhc3Nl\nc1tpXS5pc0luc3RhbmNlKGVsZW1lbnQpKTsKICAgICAgICAgICAgICAgIH0K\nICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KICAgIAogICAgCiAgICB2\nb2lkIGZhaWwoU3RyaW5nIG1zZywgQ3JpdGVyaWFRdWVyeTw/PiBxKSB7CiAg\nICAgICAgdHJ5IHsKICAgICAgICAgICAgZW0uY3JlYXRlUXVlcnkocSkuZ2V0\nUmVzdWx0TGlzdCgpOwogICAgICAgICAgICBmYWlsKCJFeHBlY3RlZCB0byBm\nYWlsICIgKyBtc2cpOwogICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7\nCiAgICAgICAgICAgIC8vIHRoaXMgaXMgYW4gZXhwZWN0ZWQgZXhjZXB0aW9u\nCiAgICAgICAgfQogICAgfQogICAgCiAgICBTdHJpbmcgdG9DbGFzcyhPYmpl\nY3QgbykgewogICAgICAgcmV0dXJuIHRvU3RyaW5nKG8uZ2V0Q2xhc3MoKSk7\nCiAgICB9CiAgICAKICAgIFN0cmluZyB0b1N0cmluZyhDbGFzczw/PiBjbHMp\nIHsKICAgICAgICByZXR1cm4gY2xzLmlzQXJyYXkoKSA/IHRvU3RyaW5nKGNs\ncy5nZXRDb21wb25lbnRUeXBlKCkpKyJbXSIgOiBjbHMudG9TdHJpbmcoKTsK\nICAgIH0KfQo=\n","encoding":"base64"}

