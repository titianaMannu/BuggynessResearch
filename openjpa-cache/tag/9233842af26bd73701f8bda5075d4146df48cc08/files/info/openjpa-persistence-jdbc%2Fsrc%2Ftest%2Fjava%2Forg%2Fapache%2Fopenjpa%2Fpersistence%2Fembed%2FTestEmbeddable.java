{"sha":"aa94b6216d6cdf196998125e3531c1048da7dd78","node_id":"MDQ6QmxvYjIwNjM2NDphYTk0YjYyMTZkNmNkZjE5Njk5ODEyNWUzNTMxYzEwNDhkYTdkZDc4","size":101204,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/aa94b6216d6cdf196998125e3531c1048da7dd78","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNr\nYWdlIG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5lbWJlZDsKCmlt\ncG9ydCBqYXZhLmlvLklPRXhjZXB0aW9uOwppbXBvcnQgamF2YS5zcWwuU1FM\nRXhjZXB0aW9uOwppbXBvcnQgamF2YS5zcWwuVGltZXN0YW1wOwppbXBvcnQg\namF2YS51dGlsLkNhbGVuZGFyOwppbXBvcnQgamF2YS51dGlsLkNvbGxlY3Rp\nb247CmltcG9ydCBqYXZhLnV0aWwuRGF0ZTsKaW1wb3J0IGphdmEudXRpbC5H\ncmVnb3JpYW5DYWxlbmRhcjsKaW1wb3J0IGphdmEudXRpbC5IYXNoTWFwOwpp\nbXBvcnQgamF2YS51dGlsLkxpc3Q7CmltcG9ydCBqYXZhLnV0aWwuTWFwOwpp\nbXBvcnQgamF2YS51dGlsLlNldDsKCmltcG9ydCBqYXZheC5wZXJzaXN0ZW5j\nZS5FbnRpdHlNYW5hZ2VyOwppbXBvcnQgamF2YXgucGVyc2lzdGVuY2UuRW50\naXR5TWFuYWdlckZhY3Rvcnk7CmltcG9ydCBqYXZheC5wZXJzaXN0ZW5jZS5F\nbnRpdHlUcmFuc2FjdGlvbjsKaW1wb3J0IGphdmF4LnBlcnNpc3RlbmNlLlF1\nZXJ5OwoKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLmNvbmYuSkRC\nQ0NvbmZpZ3VyYXRpb247CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRi\nYy5tZXRhLk1hcHBpbmdUb29sOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLmpkYmMubWV0YS5NYXBwaW5nVG9vbC5GbGFnczsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5qZGJjLnNxbC5EQkRpY3Rpb25hcnk7CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEuamRiYy5zcWwuT3JhY2xlRGljdGlvbmFyeTsKaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5Bcmd1bWVudEV4\nY2VwdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5j\nZS5PcGVuSlBBRW50aXR5TWFuYWdlclNQSTsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS5wZXJzaXN0ZW5jZS50ZXN0LlNRTExpc3RlbmVyVGVzdENhc2U7\nCgpwdWJsaWMgY2xhc3MgVGVzdEVtYmVkZGFibGUgZXh0ZW5kcyBTUUxMaXN0\nZW5lclRlc3RDYXNlIHsKICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIENhbGVu\nZGFyIGNhbCA9IG5ldyBHcmVnb3JpYW5DYWxlbmRhcigpOwogICAgcHJpdmF0\nZSBzdGF0aWMgZmluYWwgSW50ZWdlciB0aW1lSGFzaCA9IG5ldyBJbnRlZ2Vy\nKGNhbC5oYXNoQ29kZSgpKTsKICAgIHB1YmxpYyBpbnQgbnVtRW1iZWRkYWJs\nZXMgPSAxOwogICAgcHVibGljIGludCBudW1CYXNpY1R5cGVzID0gMTsKICAg\nIHB1YmxpYyBpbnQgbnVtUHJvZ3JhbU1hbmFnZXJzID0gMjsKICAgIHB1Ymxp\nYyBpbnQgbnVtTmlja05hbWVzID0gMzsKICAgIHB1YmxpYyBpbnQgbnVtRW1w\nbG95ZWVzUGVyUGhvbmVOdW1iZXIgPSAxOwogICAgcHVibGljIGludCBudW1Q\naG9uZU51bWJlcnNQZXJFbXBsb3llZSA9IDI7CiAgICBwdWJsaWMgaW50IG51\nbUVtcGxveWVlc1BlclByb2dyYW1NYW5hZ2VyID0gMjsKICAgIHB1YmxpYyBp\nbnQgbnVtRW1wbG95ZWVzID0gbnVtUHJvZ3JhbU1hbmFnZXJzCiAgICAgICAg\nKiBudW1FbXBsb3llZXNQZXJQcm9ncmFtTWFuYWdlcjsKICAgIHB1YmxpYyBp\nbnQgbnVtUGhvbmVOdW1iZXJzID0gbnVtRW1wbG95ZWVzICogbnVtUGhvbmVO\ndW1iZXJzUGVyRW1wbG95ZWU7CiAgICBwdWJsaWMgaW50IG51bURlcGFydG1l\nbnRzID0gMjsKICAgIHB1YmxpYyBpbnQgbnVtRW1wbG95ZWVzUGVyRGVwdCA9\nIDI7CiAgICBwdWJsaWMgaW50IG51bUl0ZW1zID0gMjsKICAgIHB1YmxpYyBp\nbnQgbnVtSW1hZ2VzUGVySXRlbSA9IDM7CiAgICBwdWJsaWMgaW50IG51bUNv\nbXBhbnkgPSAyOwogICAgcHVibGljIGludCBudW1EaXZpc2lvbnNQZXJDbyA9\nIDI7CiAgICBwdWJsaWMgaW50IElEID0gMTsKICAgIHB1YmxpYyBpbnQgaXRl\nbUlkID0gMTsKICAgIHB1YmxpYyBpbnQgY29tcElkID0gMTsKICAgIHB1Ymxp\nYyBpbnQgZGl2SWQgPSAxOwogICAgcHVibGljIGludCB2cElkID0gMTsKICAg\nIHB1YmxpYyBpbnQgZGVwdElkID0gMTsKICAgIHB1YmxpYyBpbnQgZW1wSWQg\nPSAxOwogICAgcHVibGljIGludCBwaG9uZUlkID0gMTsKICAgIHB1YmxpYyBp\nbnQgcG1JZCA9IDE7CiAgICBwdWJsaWMgaW50IHBhcmtpbmdTcG90SWQgPSAx\nOwogICAgcHVibGljIE1hcDxJbnRlZ2VyLCBQaG9uZU51bWJlcj4gcGhvbmVz\nID0KICAgICAgICBuZXcgSGFzaE1hcDxJbnRlZ2VyLCBQaG9uZU51bWJlcj4o\nKTsKICAgIHB1YmxpYyBNYXA8SW50ZWdlciwgRW1wbG95ZWU+IGVtcGxveWVl\ncyA9IG5ldyBIYXNoTWFwPEludGVnZXIsIEVtcGxveWVlPigpOwoKICAgIHB1\nYmxpYyB2b2lkIHNldFVwKCkgewogICAgICAgIHNldFVwKEVtYmVkLmNsYXNz\nLCBFbWJlZF9Db2xsX0VtYmVkLmNsYXNzLCBFbWJlZF9Db2xsX0ludGVnZXIu\nY2xhc3MsIAogICAgICAgICAgICBFbWJlZF9FbWJlZC5jbGFzcywgRW1iZWRf\nRW1iZWRfVG9NYW55LmNsYXNzLCBFbWJlZF9Ub01hbnkuY2xhc3MsIAogICAg\nICAgICAgICBFbWJlZF9Ub09uZS5jbGFzcywgRW50aXR5QV9Db2xsX0VtYmVk\nX1RvT25lLmNsYXNzLCAKICAgICAgICAgICAgRW50aXR5QV9Db2xsX1N0cmlu\nZy5jbGFzcywgRW50aXR5QV9FbWJlZF9Db2xsX0VtYmVkLmNsYXNzLCAKICAg\nICAgICAgICAgRW50aXR5QV9FbWJlZF9Db2xsX0ludGVnZXIuY2xhc3MsIEVu\ndGl0eUFfRW1iZWRfRW1iZWQuY2xhc3MsIAogICAgICAgICAgICBFbnRpdHlB\nX0VtYmVkX0VtYmVkX1RvTWFueS5jbGFzcywgRW50aXR5QV9FbWJlZF9Ub01h\nbnkuY2xhc3MsIAogICAgICAgICAgICBFbnRpdHlBX0VtYmVkX1RvT25lLmNs\nYXNzLCBFbnRpdHlCMS5jbGFzcywgCiAgICAgICAgICAgIEVudGl0eUFfQ29s\nbF9FbWJlZF9FbWJlZC5jbGFzcywgQ29udGFjdEluZm8uY2xhc3MsCiAgICAg\nICAgICAgIEVtcGxveWVlLmNsYXNzLCBKb2JJbmZvLmNsYXNzLCBMb2NhdGlv\nbkRldGFpbHMuY2xhc3MsCiAgICAgICAgICAgIFBhcmtpbmdTcG90LmNsYXNz\nLCBQaG9uZU51bWJlci5jbGFzcywgUHJvZ3JhbU1hbmFnZXIuY2xhc3MsCiAg\nICAgICAgICAgIERlcGFydG1lbnQxLmNsYXNzLCBFbXBsb3llZTEuY2xhc3Ms\nIERlcGFydG1lbnQyLmNsYXNzLAogICAgICAgICAgICBFbXBsb3llZTIuY2xh\nc3MsIEVtcGxveWVlUEsyLmNsYXNzLCBEZXBhcnRtZW50My5jbGFzcywKICAg\nICAgICAgICAgRW1wbG95ZWUzLmNsYXNzLCBFbXBsb3llZU5hbWUzLmNsYXNz\nLCBJdGVtMS5jbGFzcywgSXRlbTIuY2xhc3MsCiAgICAgICAgICAgIEl0ZW0z\nLmNsYXNzLCBJdGVtNC5jbGFzcywgSXRlbTUuY2xhc3MsIEZpbGVOYW1lNC5j\nbGFzcywgCiAgICAgICAgICAgIENvbXBhbnkxLmNsYXNzLCBDb21wYW55Mi5j\nbGFzcywgRGl2aXNpb24uY2xhc3MsICAgCiAgICAgICAgICAgIFZpY2VQcmVz\naWRlbnQuY2xhc3MsIEVudGl0eUFfRW1iZWRfTWFwcGVkVG9PbmUuY2xhc3Ms\nCiAgICAgICAgICAgIEVtYmVkX01hcHBlZFRvT25lLmNsYXNzLCBFbWJlZF9N\nYXBwZWRUb09uZUNhc2NhZGVEZWxldGUuY2xhc3MsIAogICAgICAgICAgICBF\nbnRpdHlBX0VtYmVkX01hcHBlZFRvT25lQ2FzY2FkZURlbGV0ZS5jbGFzcywg\nRW50aXR5QjIuY2xhc3MsIAogICAgICAgICAgICBCb29rLmNsYXNzLCBMaXN0\naW5nLmNsYXNzLCBTZWxsZXIuY2xhc3MsCiAgICAgICAgICAgIEVudGl0eUFf\nRW1iZWRfQ29sbF9NYXAuY2xhc3MsIEVtYmVkX0NvbGxfTWFwLmNsYXNzLAog\nICAgICAgICAgICBFbnRpdHlBX0VtYmVkX0NvbXBsZXguY2xhc3MsIENMRUFS\nX1RBQkxFUyk7CiAgICAgICAgICAgIHNxbC5jbGVhcigpOwogICAgICAgICAg\nICBEQkRpY3Rpb25hcnkgZGljdCA9ICgoSkRCQ0NvbmZpZ3VyYXRpb24pZW1m\nLmdldENvbmZpZ3VyYXRpb24oKSkuZ2V0REJEaWN0aW9uYXJ5SW5zdGFuY2Uo\nKTsKICAgICAgICAgICAgaWYgKGRpY3QuZ2V0Q2xhc3MoKS5nZXROYW1lKCku\naW5kZXhPZigib3JhY2xlIikgIT0gLTEpIHsKICAgICAgICAgICAgICAgICgo\nT3JhY2xlRGljdGlvbmFyeSlkaWN0KS51c2VUcmlnZ2Vyc0ZvckF1dG9Bc3Np\nZ24gPSB0cnVlOwogICAgICAgICAgICB9CiAgICB9CgogICAgcHVibGljIHZv\naWQgdGVzdEVudGl0eUFfRW1iZWRfQ29sbF9NYXAoKSB7CiAgICAgICAgcXVl\ncnlFbnRpdHlBX0VtYmVkX0NvbGxfTWFwKCk7CiAgICB9CgogICAgcHVibGlj\nIHZvaWQgcXVlcnlFbnRpdHlBX0VtYmVkX0NvbGxfTWFwKCkgewogICAgICAg\nIEVudGl0eU1hbmFnZXIgZW0gPSBlbWYuY3JlYXRlRW50aXR5TWFuYWdlcigp\nOwogICAgICAgIFN0cmluZyBxdWVyeVtdID0gewogICAgICAgICAgICAgICAg\nInNlbGVjdCBlIGZyb20gRW50aXR5QV9FbWJlZF9Db2xsX01hcCBhIGpvaW4g\nYS5lbWJlZCBlICIgKwogICAgICAgICAgICAgICAgImpvaW4gZS5tYXBLZXlJ\nbnRlZ2VyIGkgd2hlcmUgdmFsdWUoaSkgPiAwICIsCiAgICAgICAgICAgIH07\nCiAgICAgICAgTGlzdCBycyA9IG51bGw7CiAgICAgICAgZm9yIChpbnQgaSA9\nIDA7IGkgPCBxdWVyeS5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBycyA9\nIGVtLmNyZWF0ZVF1ZXJ5KHF1ZXJ5W2ldKS5nZXRSZXN1bHRMaXN0KCk7CiAg\nICAgICAgICAgIGVtLmNsZWFyKCk7CiAgICAgICAgfSAgICAgICAgCiAgICB9\nCgogICAgcHVibGljIHZvaWQgdGVzdEVudGl0eUFfQ29sbF9TdHJpbmcoKSB7\nCiAgICAgICAgY3JlYXRlRW50aXR5QV9Db2xsX1N0cmluZygpOwogICAgICAg\nIHF1ZXJ5RW50aXR5QV9Db2xsX1N0cmluZygpOwogICAgICAgIGZpbmRFbnRp\ndHlBX0NvbGxfU3RyaW5nKCk7CiAgICB9CgogICAgcHVibGljIHZvaWQgdGVz\ndEVudGl0eUFfRW1iZWRfVG9PbmUoKSB7CiAgICAgICAgY3JlYXRlRW50aXR5\nQV9FbWJlZF9Ub09uZSgpOwogICAgICAgIHF1ZXJ5RW50aXR5QV9FbWJlZF9U\nb09uZSgpOwogICAgICAgIGZpbmRFbnRpdHlBX0VtYmVkX1RvT25lKCk7CiAg\nICB9CgogICAgcHVibGljIHZvaWQgdGVzdEVudGl0eUFfRW1iZWRfTWFwcGVk\nVG9PbmUoKSB7CiAgICAgICAgY3JlYXRlRW50aXR5QV9FbWJlZF9NYXBwZWRU\nb09uZSgpOwogICAgICAgIHF1ZXJ5RW50aXR5QV9FbWJlZF9NYXBwZWRUb09u\nZSgpOwogICAgICAgIGZpbmRFbnRpdHlBX0VtYmVkX01hcHBlZFRvT25lKCk7\nCiAgICB9CgogICAgcHVibGljIHZvaWQgdGVzdEVudGl0eUFfQ29sbF9FbWJl\nZF9Ub09uZSgpIHsKICAgICAgICBjcmVhdGVFbnRpdHlBX0NvbGxfRW1iZWRf\nVG9PbmUoKTsKICAgICAgICBxdWVyeUVudGl0eUFfQ29sbF9FbWJlZF9Ub09u\nZSgpOwogICAgICAgIGZpbmRFbnRpdHlBX0NvbGxfRW1iZWRfVG9PbmUoKTsK\nICAgIH0KCiAgICBwdWJsaWMgdm9pZCB0ZXN0RW50aXR5QV9FbWJlZF9Ub01h\nbnkoKSB7CiAgICAgICAgY3JlYXRlRW50aXR5QV9FbWJlZF9Ub01hbnkoKTsK\nICAgICAgICBxdWVyeUVudGl0eUFfRW1iZWRfVG9NYW55KCk7CiAgICAgICAg\nZmluZEVudGl0eUFfRW1iZWRfVG9NYW55KCk7CiAgICB9CgogICAgcHVibGlj\nIHZvaWQgdGVzdEVudGl0eUFfRW1iZWRfRW1iZWRfVG9NYW55KCkgewogICAg\nICAgIGNyZWF0ZUVudGl0eUFfRW1iZWRfRW1iZWRfVG9NYW55KCk7CiAgICAg\nICAgcXVlcnlFbnRpdHlBX0VtYmVkX0VtYmVkX1RvTWFueSgpOwogICAgICAg\nIGZpbmRFbnRpdHlBX0VtYmVkX0VtYmVkX1RvTWFueSgpOwogICAgfQoKICAg\nIHB1YmxpYyB2b2lkIHRlc3RFbnRpdHlBX0VtYmVkX0NvbGxfSW50ZWdlcigp\nIHsKICAgICAgICBjcmVhdGVFbnRpdHlBX0VtYmVkX0NvbGxfSW50ZWdlcigp\nOwogICAgICAgIHF1ZXJ5RW50aXR5QV9FbWJlZF9Db2xsX0ludGVnZXIoKTsK\nICAgICAgICBmaW5kRW50aXR5QV9FbWJlZF9Db2xsX0ludGVnZXIoKTsKICAg\nIH0KCiAgICBwdWJsaWMgdm9pZCB0ZXN0RW50aXR5QV9FbWJlZF9FbWJlZCgp\nIHsKICAgICAgICBjcmVhdGVFbnRpdHlBX0VtYmVkX0VtYmVkKCk7CiAgICAg\nICAgcXVlcnlFbnRpdHlBX0VtYmVkX0VtYmVkKCk7CiAgICAgICAgZmluZEVu\ndGl0eUFfRW1iZWRfRW1iZWQoKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCB0\nZXN0RW50aXR5QV9Db2xsX0VtYmVkX0VtYmVkKCkgewogICAgICAgIGNyZWF0\nZUVudGl0eUFfQ29sbF9FbWJlZF9FbWJlZCgpOwogICAgICAgIHF1ZXJ5RW50\naXR5QV9Db2xsX0VtYmVkX0VtYmVkKCk7CiAgICAgICAgZmluZEVudGl0eUFf\nQ29sbF9FbWJlZF9FbWJlZCgpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHRl\nc3RFbnRpdHlBX0VtYmVkX0NvbGxfRW1iZWQoKSB7CiAgICAgICAgY3JlYXRl\nRW50aXR5QV9FbWJlZF9Db2xsX0VtYmVkKCk7CiAgICAgICAgcXVlcnlFbnRp\ndHlBX0VtYmVkX0NvbGxfRW1iZWQoKTsKICAgICAgICBmaW5kRW50aXR5QV9F\nbWJlZF9Db2xsX0VtYmVkKCk7CiAgICB9CiAgICAKICAgIHB1YmxpYyB2b2lk\nIHRlc3RFbXBsb3llZSgpIHsKICAgICAgICBjcmVhdGVFbXBsb3llZU9iaigp\nOwogICAgICAgIHF1ZXJ5RW1wbG95ZWVPYmooKTsKICAgICAgICBmaW5kRW1w\nbG95ZWVPYmooKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCB0ZXN0TWFwS2V5\nKCkgewogICAgICAgIGNyZWF0ZU9iak1hcEtleSgpOwogICAgICAgIHF1ZXJ5\nT2JqTWFwS2V5KCk7CiAgICAgICAgZmluZE9iak1hcEtleSgpOwogICAgfQog\nICAgCiAgICBwdWJsaWMgdm9pZCB0ZXN0TWFwS2V5Q2xhc3MoKSB7CiAgICAg\nICAgY3JlYXRlT2JqTWFwS2V5Q2xhc3MoKTsKICAgICAgICBxdWVyeU9iak1h\ncEtleUNsYXNzKCk7CiAgICAgICAgZmluZE9iak1hcEtleUNsYXNzKCk7CiAg\nICB9CgogICAgcHVibGljIHZvaWQgdGVzdE1hcEtleUVudW1lcmF0ZWQoKSB7\nCiAgICAgICAgY3JlYXRlT2JqTWFwS2V5RW51bWVyYXRlZCgpOwogICAgICAg\nIGZpbmRPYmpNYXBLZXlFbnVtZXJhdGVkKCk7CiAgICB9CgogICAgcHVibGlj\nIHZvaWQgdGVzdE1hcEtleVRlbXBvcmFsKCkgewogICAgICAgIGNyZWF0ZU9i\nak1hcEtleVRlbXBvcmFsKCk7CiAgICAgICAgZmluZE9iak1hcEtleVRlbXBv\ncmFsKCk7CiAgICAgICAgcXVlcnlPYmpNYXBLZXlUZW1wb3JhbCgpOwogICAg\nfQoKICAgIHB1YmxpYyB2b2lkIHRlc3RFbnRpdHlBX0VtYmVkX01hcHBlZFRv\nT25lQ2FzY2FkZURlbGV0ZSgpIHsKICAgICAgICBjcmVhdGVFbnRpdHlBX0Vt\nYmVkX01hcHBlZFRvT25lQ2FzY2FkZURlbGV0ZSgpOwogICAgICAgIHVwZGF0\nZUVudGl0eUFfRW1iZWRfTWFwcGVkVG9PbmVDYXNjYWRlRGVsZXRlKCk7CiAg\nICB9CiAgICAKICAgIHB1YmxpYyB2b2lkIHRlc3RFbWJlZGRhYmxlQ29udGFp\nbmluZ1JlbGF0aW9uV2l0aEdlbmVyYXRlZEtleSgpIAogICAgICAgIHRocm93\ncyBJT0V4Y2VwdGlvbiwgU1FMRXhjZXB0aW9uIHsKICAgICAgICBjcmVhdGVF\nbWJlZGRhYmxlQ29udGFpbmluZ1JlbGF0aW9uV2l0aEdlbmVyYXRlZEtleSgp\nOwogICAgfQoKICAgIC8qCiAgICAgKiBDcmVhdGUgRW50aXR5QV9Db2xsX1N0\ncmluZwogICAgICovCiAgICBwdWJsaWMgdm9pZCBjcmVhdGVFbnRpdHlBX0Nv\nbGxfU3RyaW5nKCkgewogICAgICAgIEVudGl0eU1hbmFnZXIgZW0gPSBlbWYu\nY3JlYXRlRW50aXR5TWFuYWdlcigpOwogICAgICAgIEVudGl0eVRyYW5zYWN0\naW9uIHRyYW4gPSBlbS5nZXRUcmFuc2FjdGlvbigpOwogICAgICAgIGNyZWF0\nZUVudGl0eUFfQ29sbF9TdHJpbmcoZW0sIElEKTsKICAgICAgICB0cmFuLmJl\nZ2luKCk7CiAgICAgICAgZW0uZmx1c2goKTsKICAgICAgICB0cmFuLmNvbW1p\ndCgpOwogICAgICAgIGVtLmNsb3NlKCk7CiAgICB9CgogICAgcHVibGljIHZv\naWQgY3JlYXRlRW50aXR5QV9Db2xsX1N0cmluZyhFbnRpdHlNYW5hZ2VyIGVt\nLCBpbnQgaWQpIHsKICAgICAgICBFbnRpdHlBX0NvbGxfU3RyaW5nIGEgPSBu\nZXcgRW50aXR5QV9Db2xsX1N0cmluZygpOwogICAgICAgIGEuc2V0SWQoaWQp\nOwogICAgICAgIGEuc2V0TmFtZSgiYSIgKyBpZCk7CiAgICAgICAgYS5zZXRB\nZ2UoaWQpOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgbnVtQmFzaWNU\neXBlczsgaSsrKQogICAgICAgICAgICBhLmFkZE5pY2tOYW1lKCJuaWNrTmFt\nZV8iICsgaWQgKyBpKTsKICAgICAgICBhLmFkZENyZWRpdFJhdGluZyhFbnRp\ndHlBX0NvbGxfU3RyaW5nLkNyZWRpdFJhdGluZy5QT09SKTsKICAgICAgICBh\nLmFkZFRpbWVzdGFtcChuZXcgVGltZXN0YW1wKFN5c3RlbS5jdXJyZW50VGlt\nZU1pbGxpcygpKSk7CiAgICAgICAgYS5hZGRMb2IoImxvYiIpOwogICAgICAg\nIGVtLnBlcnNpc3QoYSk7CiAgICB9CgogICAgLyoKICAgICAqIENyZWF0ZSBF\nbnRpdHlBX0VtYmVkX1RvT25lCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIGNy\nZWF0ZUVudGl0eUFfRW1iZWRfVG9PbmUoKSB7CiAgICAgICAgRW50aXR5TWFu\nYWdlciBlbSA9IGVtZi5jcmVhdGVFbnRpdHlNYW5hZ2VyKCk7CiAgICAgICAg\nRW50aXR5VHJhbnNhY3Rpb24gdHJhbiA9IGVtLmdldFRyYW5zYWN0aW9uKCk7\nCiAgICAgICAgY3JlYXRlRW50aXR5QV9FbWJlZF9Ub09uZShlbSwgSUQpOwog\nICAgICAgIHRyYW4uYmVnaW4oKTsKICAgICAgICBlbS5mbHVzaCgpOwogICAg\nICAgIHRyYW4uY29tbWl0KCk7CiAgICAgICAgZW0uY2xvc2UoKTsKICAgIH0K\nCiAgICBwdWJsaWMgdm9pZCBjcmVhdGVFbnRpdHlBX0VtYmVkX1RvT25lKEVu\ndGl0eU1hbmFnZXIgZW0sIGludCBpZCkgewogICAgICAgIEVudGl0eUFfRW1i\nZWRfVG9PbmUgYSA9IG5ldyBFbnRpdHlBX0VtYmVkX1RvT25lKCk7CiAgICAg\nICAgYS5zZXRJZChpZCk7CiAgICAgICAgYS5zZXROYW1lKCJhIiArIGlkKTsK\nICAgICAgICBhLnNldEFnZShpZCk7CiAgICAgICAgRW1iZWRfVG9PbmUgZW1i\nZWQgPSBjcmVhdGVFbWJlZF9Ub09uZShlbSwgaWQpOwogICAgICAgIGEuc2V0\nRW1iZWQoZW1iZWQpOwogICAgICAgIGVtLnBlcnNpc3QoYSk7CiAgICB9Cgog\nICAgcHVibGljIEVtYmVkX1RvT25lIGNyZWF0ZUVtYmVkX1RvT25lKEVudGl0\neU1hbmFnZXIgZW0sIGludCBpZCkgewogICAgICAgIEVtYmVkX1RvT25lIGVt\nYmVkID0gbmV3IEVtYmVkX1RvT25lKCk7CiAgICAgICAgZW1iZWQuc2V0TmFt\nZTEoIm5hbWUxIik7CiAgICAgICAgZW1iZWQuc2V0TmFtZTIoIm5hbWUyIik7\nCiAgICAgICAgZW1iZWQuc2V0TmFtZTMoIm5hbWUzIik7CiAgICAgICAgRW50\naXR5QjEgYiA9IG5ldyBFbnRpdHlCMSgpOwogICAgICAgIGIuc2V0SWQoaWQp\nOwogICAgICAgIGIuc2V0TmFtZSgiYiIgKyBpZCk7CiAgICAgICAgZW1iZWQu\nc2V0RW50aXR5QihiKTsKICAgICAgICBlbS5wZXJzaXN0KGIpOwogICAgICAg\nIHJldHVybiBlbWJlZDsKICAgIH0KCiAgICAvKgogICAgICogQ3JlYXRlIEVu\ndGl0eUFfRW1iZWRfTWFwcGVkVG9PbmUKICAgICAqLwogICAgcHVibGljIHZv\naWQgY3JlYXRlRW50aXR5QV9FbWJlZF9NYXBwZWRUb09uZSgpIHsKICAgICAg\nICBFbnRpdHlNYW5hZ2VyIGVtID0gZW1mLmNyZWF0ZUVudGl0eU1hbmFnZXIo\nKTsKICAgICAgICBFbnRpdHlUcmFuc2FjdGlvbiB0cmFuID0gZW0uZ2V0VHJh\nbnNhY3Rpb24oKTsKICAgICAgICBjcmVhdGVFbnRpdHlBX0VtYmVkX01hcHBl\nZFRvT25lKGVtLCBJRCk7CiAgICAgICAgdHJhbi5iZWdpbigpOwogICAgICAg\nIGVtLmZsdXNoKCk7CiAgICAgICAgdHJhbi5jb21taXQoKTsKICAgICAgICBl\nbS5jbG9zZSgpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIGNyZWF0ZUVudGl0\neUFfRW1iZWRfTWFwcGVkVG9PbmUoRW50aXR5TWFuYWdlciBlbSwgaW50IGlk\nKSB7CiAgICAgICAgRW50aXR5QV9FbWJlZF9NYXBwZWRUb09uZSBhID0gbmV3\nIEVudGl0eUFfRW1iZWRfTWFwcGVkVG9PbmUoKTsKICAgICAgICBhLnNldElk\nKGlkKTsKICAgICAgICBhLnNldE5hbWUoImEiICsgaWQpOwogICAgICAgIGEu\nc2V0QWdlKGlkKTsKICAgICAgICBFbWJlZF9NYXBwZWRUb09uZSBlbWJlZCA9\nIGNyZWF0ZUVtYmVkX01hcHBlZFRvT25lKGVtLCBpZCwgYSk7CiAgICAgICAg\nYS5zZXRFbWJlZChlbWJlZCk7CiAgICAgICAgZW0ucGVyc2lzdChhKTsKICAg\nIH0KCiAgICBwdWJsaWMgRW1iZWRfTWFwcGVkVG9PbmUgY3JlYXRlRW1iZWRf\nTWFwcGVkVG9PbmUoRW50aXR5TWFuYWdlciBlbSwgaW50IGlkLCAKICAgICAg\nICBFbnRpdHlBX0VtYmVkX01hcHBlZFRvT25lIGEpIHsKICAgICAgICBFbWJl\nZF9NYXBwZWRUb09uZSBlbWJlZCA9IG5ldyBFbWJlZF9NYXBwZWRUb09uZSgp\nOwogICAgICAgIGVtYmVkLnNldE5hbWUxKCJuYW1lMSIpOwogICAgICAgIGVt\nYmVkLnNldE5hbWUyKCJuYW1lMiIpOwogICAgICAgIGVtYmVkLnNldE5hbWUz\nKCJuYW1lMyIpOwogICAgICAgIEVudGl0eUIxIGIgPSBuZXcgRW50aXR5QjEo\nKTsKICAgICAgICBiLnNldElkKGlkKTsKICAgICAgICBiLnNldE5hbWUoImJt\nIiArIGlkKTsKICAgICAgICBiLnNldEVudGl0eUEoYSk7CiAgICAgICAgZW1i\nZWQuc2V0TWFwcGVkRW50aXR5QihiKTsKICAgICAgICBlbS5wZXJzaXN0KGIp\nOwogICAgICAgIHJldHVybiBlbWJlZDsKICAgIH0KCiAgICAvKgogICAgICog\nQ3JlYXRlIEVudGl0eUFfRW1iZWRfTWFwcGVkVG9PbmVDYXNjYWRlRGVsZXRl\nCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIGNyZWF0ZUVudGl0eUFfRW1iZWRf\nTWFwcGVkVG9PbmVDYXNjYWRlRGVsZXRlKCkgewogICAgICAgIEVudGl0eU1h\nbmFnZXIgZW0gPSBlbWYuY3JlYXRlRW50aXR5TWFuYWdlcigpOwogICAgICAg\nIEVudGl0eVRyYW5zYWN0aW9uIHRyYW4gPSBlbS5nZXRUcmFuc2FjdGlvbigp\nOwogICAgICAgIGNyZWF0ZUVudGl0eUFfRW1iZWRfTWFwcGVkVG9PbmVDYXNj\nYWRlRGVsZXRlKGVtLCBJRCk7CiAgICAgICAgdHJhbi5iZWdpbigpOwogICAg\nICAgIGVtLmZsdXNoKCk7CiAgICAgICAgdHJhbi5jb21taXQoKTsKICAgICAg\nICBlbS5jbG9zZSgpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIGNyZWF0ZUVu\ndGl0eUFfRW1iZWRfTWFwcGVkVG9PbmVDYXNjYWRlRGVsZXRlKEVudGl0eU1h\nbmFnZXIgZW0sIAogICAgICAgIGludCBpZCkgewogICAgICAgIEVudGl0eUFf\nRW1iZWRfTWFwcGVkVG9PbmVDYXNjYWRlRGVsZXRlIGEgPSAKICAgICAgICAg\nICAgbmV3IEVudGl0eUFfRW1iZWRfTWFwcGVkVG9PbmVDYXNjYWRlRGVsZXRl\nKCk7CiAgICAgICAgYS5zZXRJZChpZCk7CiAgICAgICAgYS5zZXROYW1lKCJh\nIiArIGlkKTsKICAgICAgICBhLnNldEFnZShpZCk7CiAgICAgICAgRW1iZWRf\nTWFwcGVkVG9PbmVDYXNjYWRlRGVsZXRlIGVtYmVkID0gCiAgICAgICAgICAg\nIGNyZWF0ZUVtYmVkX01hcHBlZFRvT25lRGVsZXRlQ2FzY2FkZShlbSwgaWQs\nIGEpOwogICAgICAgIGEuc2V0RW1iZWQoZW1iZWQpOwogICAgICAgIGVtLnBl\ncnNpc3QoYSk7CiAgICB9CgogICAgcHVibGljIEVtYmVkX01hcHBlZFRvT25l\nQ2FzY2FkZURlbGV0ZSBjcmVhdGVFbWJlZF9NYXBwZWRUb09uZURlbGV0ZUNh\nc2NhZGUoCiAgICAgICAgRW50aXR5TWFuYWdlciBlbSwgaW50IGlkLCBFbnRp\ndHlBX0VtYmVkX01hcHBlZFRvT25lQ2FzY2FkZURlbGV0ZSBhKSB7CiAgICAg\nICAgRW1iZWRfTWFwcGVkVG9PbmVDYXNjYWRlRGVsZXRlIGVtYmVkID0KICAg\nICAgICAgICAgbmV3IEVtYmVkX01hcHBlZFRvT25lQ2FzY2FkZURlbGV0ZSgp\nOwogICAgICAgIGVtYmVkLnNldE5hbWUxKCJuYW1lMSIpOwogICAgICAgIGVt\nYmVkLnNldE5hbWUyKCJuYW1lMiIpOwogICAgICAgIGVtYmVkLnNldE5hbWUz\nKCJuYW1lMyIpOwogICAgICAgIEVudGl0eUIyIGIgPSBuZXcgRW50aXR5QjIo\nKTsKICAgICAgICBiLnNldElkKGlkKTsKICAgICAgICBiLnNldE5hbWUoImJt\nIiArIGlkKTsKICAgICAgICBiLnNldEVudGl0eUEoYSk7CiAgICAgICAgZW1i\nZWQuc2V0TWFwcGVkRW50aXR5QihiKTsKICAgICAgICBlbS5wZXJzaXN0KGIp\nOwogICAgICAgIHJldHVybiBlbWJlZDsKICAgIH0KICAgIAogICAgLyoKICAg\nICAqIFVwZGF0ZSBFbnRpdHlBX0VtYmVkX01hcHBlZFRvT25lQ2FzY2FkZURl\nbGV0ZQogICAgICovCiAgICBwdWJsaWMgdm9pZCB1cGRhdGVFbnRpdHlBX0Vt\nYmVkX01hcHBlZFRvT25lQ2FzY2FkZURlbGV0ZSgpIHsKICAgICAgICBFbnRp\ndHlNYW5hZ2VyIGVtID0gZW1mLmNyZWF0ZUVudGl0eU1hbmFnZXIoKTsKICAg\nICAgICBFbnRpdHlUcmFuc2FjdGlvbiB0cmFuID0gZW0uZ2V0VHJhbnNhY3Rp\nb24oKTsKICAgICAgICB1cGRhdGVFbnRpdHlBX0VtYmVkX01hcHBlZFRvT25l\nQ2FzY2FkZURlbGV0ZShlbSwgSUQpOwogICAgICAgIHRyYW4uYmVnaW4oKTsK\nICAgICAgICBlbS5mbHVzaCgpOwogICAgICAgIHRyYW4uY29tbWl0KCk7CiAg\nICAgICAgZW0uY2xlYXIoKTsKICAgICAgICAKICAgICAgICBFbnRpdHlBX0Vt\nYmVkX01hcHBlZFRvT25lQ2FzY2FkZURlbGV0ZSBhID0gCiAgICAgICAgICAg\nIGVtLmZpbmQoRW50aXR5QV9FbWJlZF9NYXBwZWRUb09uZUNhc2NhZGVEZWxl\ndGUuY2xhc3MsIElEKTsKICAgICAgICBhc3NlcnROb3ROdWxsKGEpOwogICAg\nICAgIAogICAgICAgIEVudGl0eUIyIGIyID0gZW0uZmluZChFbnRpdHlCMi5j\nbGFzcywgSUQpOwogICAgICAgIGFzc2VydE5vdE51bGwoYjIpOwogICAgICAg\nIAogICAgICAgIGVtLmNsb3NlKCk7CiAgICB9CgogICAgcHVibGljIHZvaWQg\ndXBkYXRlRW50aXR5QV9FbWJlZF9NYXBwZWRUb09uZUNhc2NhZGVEZWxldGUo\nRW50aXR5TWFuYWdlciBlbSwgCiAgICAgICAgaW50IGlkKSB7CiAgICAgICAg\nRW50aXR5QV9FbWJlZF9NYXBwZWRUb09uZUNhc2NhZGVEZWxldGUgYSA9IAog\nICAgICAgICAgICBlbS5maW5kKEVudGl0eUFfRW1iZWRfTWFwcGVkVG9PbmVD\nYXNjYWRlRGVsZXRlLmNsYXNzLCBpZCk7CiAgICAgICAgYS5zZXROYW1lKCJu\nZXdhIiArIGlkKTsKICAgICAgICBhLnNldEFnZShpZCArIDEpOwogICAgICAg\nIEVtYmVkX01hcHBlZFRvT25lQ2FzY2FkZURlbGV0ZSBlbWJlZCA9IAogICAg\nICAgICAgICBjcmVhdGVFbWJlZF9NYXBwZWRUb09uZURlbGV0ZUNhc2NhZGUo\nZW0sIGlkKzEsIGEpOwogICAgICAgIGEuc2V0RW1iZWQoZW1iZWQpOwogICAg\nfQogICAgCiAgICAvKgogICAgICogQ3JlYXRlIEVudGl0eUFfQ29sbF9FbWJl\nZF9Ub09uZQogICAgICovCiAgICBwdWJsaWMgdm9pZCBjcmVhdGVFbnRpdHlB\nX0NvbGxfRW1iZWRfVG9PbmUoKSB7CiAgICAgICAgRW50aXR5TWFuYWdlciBl\nbSA9IGVtZi5jcmVhdGVFbnRpdHlNYW5hZ2VyKCk7CiAgICAgICAgRW50aXR5\nVHJhbnNhY3Rpb24gdHJhbiA9IGVtLmdldFRyYW5zYWN0aW9uKCk7CiAgICAg\nICAgY3JlYXRlRW50aXR5QV9Db2xsX0VtYmVkX1RvT25lKGVtLCBJRCk7CiAg\nICAgICAgdHJhbi5iZWdpbigpOwogICAgICAgIGVtLmZsdXNoKCk7CiAgICAg\nICAgdHJhbi5jb21taXQoKTsKICAgICAgICBlbS5jbG9zZSgpOwogICAgfQoK\nICAgIHB1YmxpYyB2b2lkIGNyZWF0ZUVudGl0eUFfQ29sbF9FbWJlZF9Ub09u\nZShFbnRpdHlNYW5hZ2VyIGVtLCBpbnQgaWQpIHsKICAgICAgICBFbnRpdHlB\nX0NvbGxfRW1iZWRfVG9PbmUgYSA9IG5ldyBFbnRpdHlBX0NvbGxfRW1iZWRf\nVG9PbmUoKTsKICAgICAgICBhLnNldElkKGlkKTsKICAgICAgICBhLnNldE5h\nbWUoImEiICsgaWQpOwogICAgICAgIGEuc2V0QWdlKGlkKTsKICAgICAgICBm\nb3IgKGludCBpID0gMDsgaSA8IG51bUVtYmVkZGFibGVzOyBpKyspIHsKICAg\nICAgICAgICAgRW1iZWRfVG9PbmUgZW1iZWQgPSBjcmVhdGVFbWJlZF9Ub09u\nZShlbSwgaStpZCk7CiAgICAgICAgICAgIGEuYWRkRW1iZWQxVG9PbmUoZW1i\nZWQpOwogICAgICAgIH0KICAgICAgICBlbS5wZXJzaXN0KGEpOwogICAgfQoK\nICAgIC8qCiAgICAgKiBDcmVhdGUgRW50aXR5QV9FbWJlZF9Ub01hbnkKICAg\nICAqLwogICAgcHVibGljIHZvaWQgY3JlYXRlRW50aXR5QV9FbWJlZF9Ub01h\nbnkoKSB7CiAgICAgICAgRW50aXR5TWFuYWdlciBlbSA9IGVtZi5jcmVhdGVF\nbnRpdHlNYW5hZ2VyKCk7CiAgICAgICAgRW50aXR5VHJhbnNhY3Rpb24gdHJh\nbiA9IGVtLmdldFRyYW5zYWN0aW9uKCk7CiAgICAgICAgY3JlYXRlRW50aXR5\nQV9FbWJlZF9Ub01hbnkoZW0sIElEKTsKICAgICAgICB0cmFuLmJlZ2luKCk7\nCiAgICAgICAgZW0uZmx1c2goKTsKICAgICAgICB0cmFuLmNvbW1pdCgpOwog\nICAgICAgIGVtLmNsb3NlKCk7CiAgICB9CgogICAgcHVibGljIHZvaWQgY3Jl\nYXRlRW50aXR5QV9FbWJlZF9Ub01hbnkoRW50aXR5TWFuYWdlciBlbSwgaW50\nIGlkKSB7CiAgICAgICAgRW50aXR5QV9FbWJlZF9Ub01hbnkgYSA9IG5ldyBF\nbnRpdHlBX0VtYmVkX1RvTWFueSgpOwogICAgICAgIGEuc2V0SWQoaWQpOwog\nICAgICAgIGEuc2V0TmFtZSgiYSIgKyBpZCk7CiAgICAgICAgYS5zZXRBZ2Uo\naWQpOwogICAgICAgIEVtYmVkX1RvTWFueSBlbWJlZCA9IGNyZWF0ZUVtYmVk\nX1RvTWFueShlbSwgaWQpOwogICAgICAgIGEuc2V0RW1iZWQoZW1iZWQpOwog\nICAgICAgIGVtLnBlcnNpc3QoYSk7CiAgICB9CgogICAgcHVibGljIEVtYmVk\nX1RvTWFueSBjcmVhdGVFbWJlZF9Ub01hbnkoRW50aXR5TWFuYWdlciBlbSwg\naW50IGlkKSB7CiAgICAgICAgRW1iZWRfVG9NYW55IGVtYmVkID0gbmV3IEVt\nYmVkX1RvTWFueSgpOwogICAgICAgIGVtYmVkLnNldE5hbWUxKCJuYW1lMSIp\nOwogICAgICAgIGVtYmVkLnNldE5hbWUyKCJuYW1lMiIpOwogICAgICAgIGVt\nYmVkLnNldE5hbWUzKCJuYW1lMyIpOwogICAgICAgIGZvciAoaW50IGkgPSAw\nOyBpIDwgbnVtRW1iZWRkYWJsZXM7IGkrKykgewogICAgICAgICAgICBFbnRp\ndHlCMSBiID0gbmV3IEVudGl0eUIxKCk7CiAgICAgICAgICAgIGIuc2V0SWQo\naWQgKyBpKTsKICAgICAgICAgICAgYi5zZXROYW1lKCJiIiArIGlkICsgaSk7\nCiAgICAgICAgICAgIGVtYmVkLmFkZEVudGl0eUIoYik7CiAgICAgICAgICAg\nIGVtLnBlcnNpc3QoYik7CiAgICAgICAgfQogICAgICAgIHJldHVybiBlbWJl\nZDsKICAgIH0KCiAgIC8qCiAgICAgKiBDcmVhdGUgRW50aXR5QV9FbWJlZF9F\nbWJlZF9Ub01hbnkKICAgICAqLwogICAgcHVibGljIHZvaWQgY3JlYXRlRW50\naXR5QV9FbWJlZF9FbWJlZF9Ub01hbnkoKSB7CiAgICAgICAgRW50aXR5TWFu\nYWdlciBlbSA9IGVtZi5jcmVhdGVFbnRpdHlNYW5hZ2VyKCk7CiAgICAgICAg\nRW50aXR5VHJhbnNhY3Rpb24gdHJhbiA9IGVtLmdldFRyYW5zYWN0aW9uKCk7\nCiAgICAgICAgY3JlYXRlRW50aXR5QV9FbWJlZF9FbWJlZF9Ub01hbnkoZW0s\nIElEKTsKICAgICAgICB0cmFuLmJlZ2luKCk7CiAgICAgICAgZW0uZmx1c2go\nKTsKICAgICAgICB0cmFuLmNvbW1pdCgpOwogICAgICAgIGVtLmNsb3NlKCk7\nCiAgICB9CgogICAgcHVibGljIHZvaWQgY3JlYXRlRW50aXR5QV9FbWJlZF9F\nbWJlZF9Ub01hbnkoRW50aXR5TWFuYWdlciBlbSwgaW50IGlkKSB7CiAgICAg\nICAgRW50aXR5QV9FbWJlZF9FbWJlZF9Ub01hbnkgYSA9IG5ldyBFbnRpdHlB\nX0VtYmVkX0VtYmVkX1RvTWFueSgpOwogICAgICAgIGEuc2V0SWQoaWQpOwog\nICAgICAgIGEuc2V0TmFtZSgiYSIgKyBpZCk7CiAgICAgICAgYS5zZXRBZ2Uo\naWQpOwogICAgICAgIEVtYmVkX0VtYmVkX1RvTWFueSBlbWJlZCA9IGNyZWF0\nZUVtYmVkX0VtYmVkX1RvTWFueShlbSwgaWQpOwogICAgICAgIGEuc2V0RW1i\nZWQoZW1iZWQpOwogICAgICAgIGVtLnBlcnNpc3QoYSk7CiAgICB9CgogICAg\ncHVibGljIEVtYmVkX0VtYmVkX1RvTWFueSBjcmVhdGVFbWJlZF9FbWJlZF9U\nb01hbnkoRW50aXR5TWFuYWdlciBlbSwKICAgICAgICAgICAgaW50IGlkKSB7\nCiAgICAgICAgRW1iZWRfRW1iZWRfVG9NYW55IGVtYmVkID0gbmV3IEVtYmVk\nX0VtYmVkX1RvTWFueSgpOwogICAgICAgIGVtYmVkLnNldEludFZhbDEoMSk7\nCiAgICAgICAgZW1iZWQuc2V0SW50VmFsMigyKTsKICAgICAgICBlbWJlZC5z\nZXRJbnRWYWwzKDMpOwogICAgICAgIEVtYmVkX1RvTWFueSBlbWJlZF9Ub01h\nbnkgPSBjcmVhdGVFbWJlZF9Ub01hbnkoZW0sIGlkKTsKICAgICAgICBlbWJl\nZC5zZXRFbWJlZChlbWJlZF9Ub01hbnkpOwogICAgICAgIHJldHVybiBlbWJl\nZDsKICAgIH0KICAgIAogICAgLyoKICAgICAqIENyZWF0ZSBFbnRpdHlBX0Vt\nYmVkX0NvbGxfSW50ZWdlcgogICAgICovCiAgICBwdWJsaWMgdm9pZCBjcmVh\ndGVFbnRpdHlBX0VtYmVkX0NvbGxfSW50ZWdlcigpIHsKICAgICAgICBFbnRp\ndHlNYW5hZ2VyIGVtID0gZW1mLmNyZWF0ZUVudGl0eU1hbmFnZXIoKTsKICAg\nICAgICBFbnRpdHlUcmFuc2FjdGlvbiB0cmFuID0gZW0uZ2V0VHJhbnNhY3Rp\nb24oKTsKICAgICAgICBjcmVhdGVFbnRpdHlBX0VtYmVkX0NvbGxfSW50ZWdl\ncihlbSwgSUQpOwogICAgICAgIHRyYW4uYmVnaW4oKTsKICAgICAgICBlbS5m\nbHVzaCgpOwogICAgICAgIHRyYW4uY29tbWl0KCk7CiAgICAgICAgZW0uY2xv\nc2UoKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBjcmVhdGVFbnRpdHlBX0Vt\nYmVkX0NvbGxfSW50ZWdlcihFbnRpdHlNYW5hZ2VyIGVtLCBpbnQgaWQpIHsK\nICAgICAgICBFbnRpdHlBX0VtYmVkX0NvbGxfSW50ZWdlciBhID0gbmV3IEVu\ndGl0eUFfRW1iZWRfQ29sbF9JbnRlZ2VyKCk7CiAgICAgICAgYS5zZXRJZChp\nZCk7CiAgICAgICAgYS5zZXROYW1lKCJhIiArIGlkKTsKICAgICAgICBhLnNl\ndEFnZShpZCk7CiAgICAgICAgRW1iZWRfQ29sbF9JbnRlZ2VyIGVtYmVkID0g\nY3JlYXRlRW1iZWRfQ29sbF9JbnRlZ2VyKGVtLCBpZCk7CiAgICAgICAgYS5z\nZXRFbWJlZChlbWJlZCk7CiAgICAgICAgZW0ucGVyc2lzdChhKTsKICAgIH0K\nCiAgICBwdWJsaWMgRW1iZWRfQ29sbF9JbnRlZ2VyIGNyZWF0ZUVtYmVkX0Nv\nbGxfSW50ZWdlcihFbnRpdHlNYW5hZ2VyIGVtLAogICAgICAgICAgICBpbnQg\naWQpIHsKICAgICAgICBFbWJlZF9Db2xsX0ludGVnZXIgZW1iZWQgPSBuZXcg\nRW1iZWRfQ29sbF9JbnRlZ2VyKCk7CiAgICAgICAgZW1iZWQuc2V0SW50VmFs\nMShpZCoxMCArIDEpOwogICAgICAgIGVtYmVkLnNldEludFZhbDIoaWQqMTAg\nKyAyKTsKICAgICAgICBlbWJlZC5zZXRJbnRWYWwzKGlkKjEwICsgMyk7CiAg\nICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBudW1CYXNpY1R5cGVzOyBpKysp\nIHsKICAgICAgICAgICAgZW1iZWQuYWRkT3RoZXJJbnRWYWwoaWQgKiAxMDAg\nKyBpKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGVtYmVkOwogICAgfQoK\nICAgIC8qCiAgICAgKiBDcmVhdGUgRW50aXR5QV9FbWJlZF9FbWJlZAogICAg\nICovCiAgICBwdWJsaWMgdm9pZCBjcmVhdGVFbnRpdHlBX0VtYmVkX0VtYmVk\nKCkgewogICAgICAgIEVudGl0eU1hbmFnZXIgZW0gPSBlbWYuY3JlYXRlRW50\naXR5TWFuYWdlcigpOwogICAgICAgIEVudGl0eVRyYW5zYWN0aW9uIHRyYW4g\nPSBlbS5nZXRUcmFuc2FjdGlvbigpOwogICAgICAgIGNyZWF0ZUVudGl0eUFf\nRW1iZWRfRW1iZWQoZW0sIElEKTsKICAgICAgICB0cmFuLmJlZ2luKCk7CiAg\nICAgICAgZW0uZmx1c2goKTsKICAgICAgICB0cmFuLmNvbW1pdCgpOwogICAg\nICAgIGVtLmNsb3NlKCk7CiAgICB9CgogICAgcHVibGljIHZvaWQgY3JlYXRl\nRW50aXR5QV9FbWJlZF9FbWJlZChFbnRpdHlNYW5hZ2VyIGVtLCBpbnQgaWQp\nIHsKICAgICAgICBFbnRpdHlBX0VtYmVkX0VtYmVkIGEgPSBuZXcgRW50aXR5\nQV9FbWJlZF9FbWJlZCgpOwogICAgICAgIGEuc2V0SWQoaWQpOwogICAgICAg\nIGEuc2V0TmFtZSgiYSIgKyBpZCk7CiAgICAgICAgYS5zZXRBZ2UoaWQpOwog\nICAgICAgIEVtYmVkX0VtYmVkIGVtYmVkID0gY3JlYXRlRW1iZWRfRW1iZWQo\nZW0sIGlkLCAwKTsKICAgICAgICBhLnNldEVtYmVkKGVtYmVkKTsKICAgICAg\nICBlbS5wZXJzaXN0KGEpOwogICAgfQoKICAgIHB1YmxpYyBFbWJlZF9FbWJl\nZCBjcmVhdGVFbWJlZF9FbWJlZChFbnRpdHlNYW5hZ2VyIGVtLCBpbnQgaWQs\nIGludCBpZHgpIHsKICAgICAgICBFbWJlZF9FbWJlZCBlbWJlZCA9IG5ldyBF\nbWJlZF9FbWJlZCgpOwogICAgICAgIGVtYmVkLnNldEludFZhbDEoaWQgKiAx\nMDAgKyBpZHggKiAxMCArIDEpOwogICAgICAgIGVtYmVkLnNldEludFZhbDIo\naWQgKiAxMDAgKyBpZHggKiAxMCArIDIpOwogICAgICAgIGVtYmVkLnNldElu\ndFZhbDMoaWQgKiAxMDAgKyBpZHggKiAxMCArIDMpOwogICAgICAgIEVtYmVk\nIGVtYmVkMSA9IGNyZWF0ZUVtYmVkKGlkLCBpZHgpOwogICAgICAgIGVtYmVk\nLnNldEVtYmVkKGVtYmVkMSk7CiAgICAgICAgcmV0dXJuIGVtYmVkOwogICAg\nfQoKICAgIHB1YmxpYyBFbWJlZCBjcmVhdGVFbWJlZChpbnQgaWQsIGludCBp\nZHgpIHsKICAgICAgICBFbWJlZCBlbWJlZCA9IG5ldyBFbWJlZCgpOwogICAg\nICAgIGVtYmVkLnNldEludFZhbDEoaWQgKiAxMDAgKyBpZHggKiAxMCArIDQp\nOwogICAgICAgIGVtYmVkLnNldEludFZhbDIoaWQgKiAxMDAgKyBpZHggKiAx\nMCArIDUpOwogICAgICAgIGVtYmVkLnNldEludFZhbDMoaWQgKiAxMDAgKyBp\nZHggKiAxMCArIDYpOwogICAgICAgIHJldHVybiBlbWJlZDsKICAgIH0KCiAg\nICAvKgogICAgICogQ3JlYXRlIEVudGl0eUFfQ29sbF9FbWJlZF9FbWJlZAog\nICAgICovCiAgICBwdWJsaWMgdm9pZCBjcmVhdGVFbnRpdHlBX0NvbGxfRW1i\nZWRfRW1iZWQoKSB7CiAgICAgICAgRW50aXR5TWFuYWdlciBlbSA9IGVtZi5j\ncmVhdGVFbnRpdHlNYW5hZ2VyKCk7CiAgICAgICAgRW50aXR5VHJhbnNhY3Rp\nb24gdHJhbiA9IGVtLmdldFRyYW5zYWN0aW9uKCk7CiAgICAgICAgY3JlYXRl\nRW50aXR5QV9Db2xsX0VtYmVkX0VtYmVkKGVtLCBJRCk7CiAgICAgICAgdHJh\nbi5iZWdpbigpOwogICAgICAgIGVtLmZsdXNoKCk7CiAgICAgICAgdHJhbi5j\nb21taXQoKTsKICAgICAgICBlbS5jbG9zZSgpOwogICAgfQoKICAgIHB1Ymxp\nYyB2b2lkIGNyZWF0ZUVudGl0eUFfQ29sbF9FbWJlZF9FbWJlZChFbnRpdHlN\nYW5hZ2VyIGVtLCBpbnQgaWQpIHsKICAgICAgICBFbnRpdHlBX0NvbGxfRW1i\nZWRfRW1iZWQgYSA9IG5ldyBFbnRpdHlBX0NvbGxfRW1iZWRfRW1iZWQoKTsK\nICAgICAgICBhLnNldElkKGlkKTsKICAgICAgICBhLnNldE5hbWUoImEiICsg\naWQpOwogICAgICAgIGEuc2V0QWdlKGlkKTsKICAgICAgICBmb3IgKGludCBp\nID0gMDsgaSA8IG51bUVtYmVkZGFibGVzOyBpKyspIHsKICAgICAgICAgICAg\nRW1iZWRfRW1iZWQgZW1iZWQgPSBjcmVhdGVFbWJlZF9FbWJlZChlbSwgaWQs\nIGkpOwogICAgICAgICAgICBhLmFkZEVtYmVkKGVtYmVkKTsKICAgICAgICB9\nCiAgICAgICAgZW0ucGVyc2lzdChhKTsKICAgIH0KCiAgICAvKgogICAgICog\nQ3JlYXRlIEVudGl0eUFfRW1iZWRfQ29sbF9FbWJlZAogICAgICovCiAgICBw\ndWJsaWMgdm9pZCBjcmVhdGVFbnRpdHlBX0VtYmVkX0NvbGxfRW1iZWQoKSB7\nCiAgICAgICAgRW50aXR5TWFuYWdlciBlbSA9IGVtZi5jcmVhdGVFbnRpdHlN\nYW5hZ2VyKCk7CiAgICAgICAgRW50aXR5VHJhbnNhY3Rpb24gdHJhbiA9IGVt\nLmdldFRyYW5zYWN0aW9uKCk7CiAgICAgICAgY3JlYXRlRW50aXR5QV9FbWJl\nZF9Db2xsX0VtYmVkKGVtLCBJRCk7CiAgICAgICAgdHJhbi5iZWdpbigpOwog\nICAgICAgIGVtLmZsdXNoKCk7CiAgICAgICAgdHJhbi5jb21taXQoKTsKICAg\nICAgICBlbS5jbG9zZSgpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIGNyZWF0\nZUVudGl0eUFfRW1iZWRfQ29sbF9FbWJlZChFbnRpdHlNYW5hZ2VyIGVtLCBp\nbnQgaWQpIHsKICAgICAgICBFbnRpdHlBX0VtYmVkX0NvbGxfRW1iZWQgYSA9\nIG5ldyBFbnRpdHlBX0VtYmVkX0NvbGxfRW1iZWQoKTsKICAgICAgICBhLnNl\ndElkKGlkKTsKICAgICAgICBhLnNldE5hbWUoImEiICsgaWQpOwogICAgICAg\nIGEuc2V0QWdlKGlkKTsKICAgICAgICBFbWJlZF9Db2xsX0VtYmVkIGVtYmVk\nID0gY3JlYXRlRW1iZWRfQ29sbF9FbWJlZChlbSwgaWQpOwogICAgICAgIGEu\nc2V0RW1iZWQoZW1iZWQpOwogICAgICAgIGVtLnBlcnNpc3QoYSk7CiAgICB9\nCgogICAgcHVibGljIEVtYmVkX0NvbGxfRW1iZWQgY3JlYXRlRW1iZWRfQ29s\nbF9FbWJlZChFbnRpdHlNYW5hZ2VyIGVtLCBpbnQgaWQpIHsKICAgICAgICBF\nbWJlZF9Db2xsX0VtYmVkIGVtYmVkID0gbmV3IEVtYmVkX0NvbGxfRW1iZWQo\nKTsKICAgICAgICBlbWJlZC5zZXRJbnRWYWwxKGlkICogMTAgKyAxKTsKICAg\nICAgICBlbWJlZC5zZXRJbnRWYWwyKGlkICogMTAgKyAyKTsKICAgICAgICBl\nbWJlZC5zZXRJbnRWYWwzKGlkICogMTAgKyAzKTsKICAgICAgICBmb3IgKGlu\ndCBpID0gMDsgaSA8IG51bUVtYmVkZGFibGVzOyBpKyspIHsKICAgICAgICAg\nICAgRW1iZWQgZW1iZWQxID0gY3JlYXRlRW1iZWQoaWQsIGkpOwogICAgICAg\nICAgICBlbWJlZC5hZGRFbWJlZChlbWJlZDEpOwogICAgICAgIH0KICAgICAg\nICByZXR1cm4gZW1iZWQ7CiAgICB9CgogICAgLyoKICAgICAqIENyZWF0ZSBF\nbXBsb3llZQogICAgICovCiAgICBwdWJsaWMgdm9pZCBjcmVhdGVFbXBsb3ll\nZU9iaigpIHsKICAgICAgICBFbnRpdHlNYW5hZ2VyIGVtID0gZW1mLmNyZWF0\nZUVudGl0eU1hbmFnZXIoKTsKICAgICAgICBFbnRpdHlUcmFuc2FjdGlvbiB0\ncmFuID0gZW0uZ2V0VHJhbnNhY3Rpb24oKTsKICAgICAgICBjcmVhdGVQaG9u\nZU51bWJlcnMoZW0pOwogICAgICAgIGNyZWF0ZUVtcGxveWVlcyhlbSk7CiAg\nICAgICAgY3JlYXRlUHJvZ3JhbU1hbmFnZXJzKGVtKTsKICAgICAgICAKICAg\nICAgICB0cmFuLmJlZ2luKCk7CiAgICAgICAgZW0uZmx1c2goKTsKICAgICAg\nICB0cmFuLmNvbW1pdCgpOwogICAgICAgIGVtLmNsb3NlKCk7CiAgICB9CiAg\nICAKICAgIHB1YmxpYyB2b2lkIGNyZWF0ZVByb2dyYW1NYW5hZ2VycyhFbnRp\ndHlNYW5hZ2VyIGVtKSB7CiAgICAgICAgZW1wSWQgPSAxOwogICAgICAgIGZv\nciAoaW50IGkgPSAwOyBpIDwgbnVtUHJvZ3JhbU1hbmFnZXJzOyBpKyspCiAg\nICAgICAgICAgIGNyZWF0ZVByb2dyYW1NYW5hZ2VyKGVtLCBwbUlkKyspOwog\nICAgfQogICAgCiAgICBwdWJsaWMgdm9pZCBjcmVhdGVQcm9ncmFtTWFuYWdl\ncihFbnRpdHlNYW5hZ2VyIGVtLCBpbnQgaWQpIHsKICAgICAgICBQcm9ncmFt\nTWFuYWdlciBwbSA9IG5ldyBQcm9ncmFtTWFuYWdlcigpOwogICAgICAgIHBt\nLnNldElkKGlkKTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IG51bUVt\ncGxveWVlc1BlclByb2dyYW1NYW5hZ2VyOyBpKyspIHsKICAgICAgICAgICAg\nRW1wbG95ZWUgZSA9IGVtcGxveWVlcy5nZXQoZW1wSWQrKyk7CiAgICAgICAg\nICAgIHBtLmFkZE1hbmFnZShlKTsKICAgICAgICAgICAgSm9iSW5mbyBqb2JJ\nbmZvID0gbmV3IEpvYkluZm8oKTsKICAgICAgICAgICAgam9iSW5mby5zZXRK\nb2JEZXNjcmlwdGlvbigiam9iRGVzY3JpcHRpb24iICsgZS5nZXRFbXBJZCgp\nKTsKICAgICAgICAgICAgam9iSW5mby5zZXRQcm9ncmFtTWFuYWdlcihwbSk7\nCiAgICAgICAgICAgIGUuc2V0Sm9iSW5mbyhqb2JJbmZvKTsKICAgICAgICB9\nCiAgICAgICAgZW0ucGVyc2lzdChwbSk7CiAgICB9CiAgICAKICAgIHB1Ymxp\nYyB2b2lkIGNyZWF0ZUVtcGxveWVlcyhFbnRpdHlNYW5hZ2VyIGVtKSB7CiAg\nICAgICAgcGhvbmVJZCA9IDE7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkg\nPCBudW1FbXBsb3llZXM7IGkrKykgewogICAgICAgICAgICBFbXBsb3llZSBl\nID0gY3JlYXRlRW1wbG95ZWUoZW0sIGVtcElkKyspOwogICAgICAgICAgICBl\nbXBsb3llZXMucHV0KGUuZ2V0RW1wSWQoKSwgZSk7CiAgICAgICAgfQogICAg\nfQoKICAgIHB1YmxpYyBFbXBsb3llZSBjcmVhdGVFbXBsb3llZShFbnRpdHlN\nYW5hZ2VyIGVtLCBpbnQgaWQpIHsKICAgICAgICBFbXBsb3llZSBlID0gbmV3\nIEVtcGxveWVlKCk7CiAgICAgICAgZS5zZXRFbXBJZChpZCk7CiAgICAgICAg\nQ29udGFjdEluZm8gY29udGFjdEluZm8gPSBuZXcgQ29udGFjdEluZm8oKTsK\nICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IG51bVBob25lTnVtYmVyc1Bl\nckVtcGxveWVlOyBpKyspIHsgCiAgICAgICAgICAgIFBob25lTnVtYmVyIHBo\nb25lTnVtYmVyID0gcGhvbmVzLmdldChwaG9uZUlkKyspOwogICAgICAgICAg\nICBjb250YWN0SW5mby5hZGRQaG9uZU51bWJlcihwaG9uZU51bWJlcik7CiAg\nICAgICAgICAgIGUuc2V0Q29udGFjdEluZm8oY29udGFjdEluZm8pOwogICAg\nICAgICAgICBwaG9uZU51bWJlci5hZGRFbXBsb3llZXMoZSk7CiAgICAgICAg\nICAgIGVtLnBlcnNpc3QocGhvbmVOdW1iZXIpOwogICAgICAgIH0KICAgICAg\nICBQYXJraW5nU3BvdCBwYXJraW5nU3BvdCA9IGNyZWF0ZVBhcmtpbmdTcG90\nKGVtLCBwYXJraW5nU3BvdElkKyspOwogICAgICAgIExvY2F0aW9uRGV0YWls\ncyBsb2NhdGlvbiA9IG5ldyBMb2NhdGlvbkRldGFpbHMoKTsKICAgICAgICBs\nb2NhdGlvbi5zZXRPZmZpY2VOdW1iZXIoaWQpOwogICAgICAgIGxvY2F0aW9u\nLnNldFBhcmtpbmdTcG90KHBhcmtpbmdTcG90KTsKICAgICAgICBlLnNldExv\nY2F0aW9uRGV0YWlscyhsb2NhdGlvbik7CiAgICAgICAgcGFya2luZ1Nwb3Qu\nc2V0QXNzaWduZWRUbyhlKTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8\nIG51bU5pY2tOYW1lczsgaSsrKQogICAgICAgICAgICBlLmFkZE5pY2tOYW1l\nKCJuaWNrTmFtZSIgKyBpZCArIGkpOwogICAgICAgIGVtLnBlcnNpc3QocGFy\na2luZ1Nwb3QpOwogICAgICAgIGVtLnBlcnNpc3QoZSk7CiAgICAgICAgcmV0\ndXJuIGU7CiAgICB9CiAgICAKICAgIHB1YmxpYyB2b2lkIGNyZWF0ZVBob25l\nTnVtYmVycyhFbnRpdHlNYW5hZ2VyIGVtKSB7CiAgICAgICAgZm9yIChpbnQg\naSA9IDA7IGkgPCBudW1QaG9uZU51bWJlcnM7IGkrKykgewogICAgICAgICAg\nICBQaG9uZU51bWJlciBwID0gbmV3IFBob25lTnVtYmVyKCk7CiAgICAgICAg\nICAgIHAuc2V0TnVtYmVyKHBob25lSWQrKyk7CiAgICAgICAgICAgIHBob25l\ncy5wdXQocC5nZXROdW1iZXIoKSwgcCk7CiAgICAgICAgICAgIGVtLnBlcnNp\nc3QocCk7CiAgICAgICAgfQogICAgfSAgICAKICAgIAogICAgcHVibGljIFBh\ncmtpbmdTcG90IGNyZWF0ZVBhcmtpbmdTcG90KEVudGl0eU1hbmFnZXIgZW0s\nIGludCBpZCkgewogICAgICAgIFBhcmtpbmdTcG90IHAgPSBuZXcgUGFya2lu\nZ1Nwb3QoKTsKICAgICAgICBwLnNldElkKGlkKTsKICAgICAgICBwLnNldEdh\ncmFnZSgiZ2FyYWdlIiArIGlkKTsKICAgICAgICBlbS5wZXJzaXN0KHApOwog\nICAgICAgIHJldHVybiBwOwogICAgfSAgICAKCiAgICBwdWJsaWMgdm9pZCBm\naW5kRW1wbG95ZWVPYmooKSB7CiAgICAgICAgRW50aXR5TWFuYWdlciBlbSA9\nIGVtZi5jcmVhdGVFbnRpdHlNYW5hZ2VyKCk7CiAgICAgICAgUHJvZ3JhbU1h\nbmFnZXIgcG0gPSBlbS5maW5kKFByb2dyYW1NYW5hZ2VyLmNsYXNzLCAxKTsK\nICAgICAgICBhc3NlcnRQcm9ncmFtTWFuYWdlcihwbSk7CgogICAgICAgIHBt\nID0gZW0uZmluZChQcm9ncmFtTWFuYWdlci5jbGFzcywgMik7CiAgICAgICAg\nYXNzZXJ0UHJvZ3JhbU1hbmFnZXIocG0pOwoKICAgICAgICBFbXBsb3llZSBl\nID0gZW0uZmluZChFbXBsb3llZS5jbGFzcywgMSk7CiAgICAgICAgYXNzZXJ0\nRW1wbG95ZWUoZSk7CiAgICAgICAgCiAgICAgICAgUGhvbmVOdW1iZXIgcCA9\nIGVtLmZpbmQoUGhvbmVOdW1iZXIuY2xhc3MsIDEpOwogICAgICAgIGFzc2Vy\ndFBob25lTnVtYmVyKHApOwogICAgICAgIAogICAgICAgIFBhcmtpbmdTcG90\nIHBzID0gZW0uZmluZChQYXJraW5nU3BvdC5jbGFzcywgMSk7CiAgICAgICAg\nYXNzZXJ0UGFya2luZ1Nwb3QocHMpOwogICAgICAgCiAgICAgICAgZW0uY2xv\nc2UoKTsKICAgIH0KICAgIAogICAgcHVibGljIHZvaWQgcXVlcnlFbXBsb3ll\nZU9iaigpIHsKICAgICAgICBxdWVyeVByb2dyYW1NYW5hZ2VyKGVtZik7CiAg\nICAgICAgcXVlcnlFbXBsb3llZU9iaihlbWYpOwogICAgICAgIHF1ZXJ5UGhv\nbmVOdW1iZXIoZW1mKTsKICAgICAgICBxdWVyeVBhcmtpbmdTcG90KGVtZik7\nCiAgICB9CiAgICAKICAgIHB1YmxpYyB2b2lkIHF1ZXJ5UGFya2luZ1Nwb3Qo\nRW50aXR5TWFuYWdlckZhY3RvcnkgZW1mKSB7CiAgICAgICAgRW50aXR5TWFu\nYWdlciBlbSA9IGVtZi5jcmVhdGVFbnRpdHlNYW5hZ2VyKCk7CiAgICAgICAg\nRW50aXR5VHJhbnNhY3Rpb24gdHJhbiA9IGVtLmdldFRyYW5zYWN0aW9uKCk7\nCiAgICAgICAgdHJhbi5iZWdpbigpOwogICAgICAgIFF1ZXJ5IHEgPSBlbS5j\ncmVhdGVRdWVyeSgic2VsZWN0IHAgZnJvbSBQYXJraW5nU3BvdCBwIik7CiAg\nICAgICAgTGlzdDxQYXJraW5nU3BvdD4gcHMgPSBxLmdldFJlc3VsdExpc3Qo\nKTsKICAgICAgICBmb3IgKFBhcmtpbmdTcG90IHAgOiBwcyl7CiAgICAgICAg\nICAgIGFzc2VydFBhcmtpbmdTcG90KHApOwogICAgICAgIH0KICAgICAgICB0\ncmFuLmNvbW1pdCgpOwogICAgICAgIGVtLmNsb3NlKCk7CiAgICB9CiAgICAK\nICAgIHB1YmxpYyB2b2lkIHF1ZXJ5UHJvZ3JhbU1hbmFnZXIoRW50aXR5TWFu\nYWdlckZhY3RvcnkgZW1mKSB7CiAgICAgICAgRW50aXR5TWFuYWdlciBlbSA9\nIGVtZi5jcmVhdGVFbnRpdHlNYW5hZ2VyKCk7CiAgICAgICAgRW50aXR5VHJh\nbnNhY3Rpb24gdHJhbiA9IGVtLmdldFRyYW5zYWN0aW9uKCk7CiAgICAgICAg\ndHJhbi5iZWdpbigpOwogICAgICAgIFF1ZXJ5IHEgPSBlbS5jcmVhdGVRdWVy\neSgic2VsZWN0IHBtIGZyb20gUHJvZ3JhbU1hbmFnZXIgcG0iKTsKICAgICAg\nICBMaXN0PFByb2dyYW1NYW5hZ2VyPiBwbXMgPSBxLmdldFJlc3VsdExpc3Qo\nKTsKICAgICAgICBmb3IgKFByb2dyYW1NYW5hZ2VyIHBtIDogcG1zKXsKICAg\nICAgICAgICAgYXNzZXJ0UHJvZ3JhbU1hbmFnZXIocG0pOwogICAgICAgIH0K\nICAgICAgICB0cmFuLmNvbW1pdCgpOwogICAgICAgIGVtLmNsb3NlKCk7CiAg\nICB9CgogICAgcHVibGljIHZvaWQgcXVlcnlQaG9uZU51bWJlcihFbnRpdHlN\nYW5hZ2VyRmFjdG9yeSBlbWYpIHsKICAgICAgICBFbnRpdHlNYW5hZ2VyIGVt\nID0gZW1mLmNyZWF0ZUVudGl0eU1hbmFnZXIoKTsKICAgICAgICBFbnRpdHlU\ncmFuc2FjdGlvbiB0cmFuID0gZW0uZ2V0VHJhbnNhY3Rpb24oKTsKICAgICAg\nICB0cmFuLmJlZ2luKCk7CiAgICAgICAgUXVlcnkgcSA9IGVtLmNyZWF0ZVF1\nZXJ5KCJzZWxlY3QgcCBmcm9tIFBob25lTnVtYmVyIHAiKTsKICAgICAgICBM\naXN0PFBob25lTnVtYmVyPiBwcyA9IHEuZ2V0UmVzdWx0TGlzdCgpOwogICAg\nICAgIGZvciAoUGhvbmVOdW1iZXIgcCA6IHBzKXsKICAgICAgICAgICAgYXNz\nZXJ0UGhvbmVOdW1iZXIocCk7CiAgICAgICAgfQogICAgICAgIHRyYW4uY29t\nbWl0KCk7CiAgICAgICAgZW0uY2xvc2UoKTsKICAgIH0KCiAgICBwdWJsaWMg\ndm9pZCBxdWVyeUVtcGxveWVlT2JqKEVudGl0eU1hbmFnZXJGYWN0b3J5IGVt\nZikgewogICAgICAgIEVudGl0eU1hbmFnZXIgZW0gPSBlbWYuY3JlYXRlRW50\naXR5TWFuYWdlcigpOwogICAgICAgIEVudGl0eVRyYW5zYWN0aW9uIHRyYW4g\nPSBlbS5nZXRUcmFuc2FjdGlvbigpOwogICAgICAgIHRyYW4uYmVnaW4oKTsK\nICAgICAgICBRdWVyeSBxID0gZW0uY3JlYXRlUXVlcnkoInNlbGVjdCBlIGZy\nb20gRW1wbG95ZWUgZSIpOwogICAgICAgIExpc3Q8RW1wbG95ZWU+IGVzID0g\ncS5nZXRSZXN1bHRMaXN0KCk7CiAgICAgICAgZm9yIChFbXBsb3llZSBlIDog\nZXMpewogICAgICAgICAgICBhc3NlcnRFbXBsb3llZShlKTsKICAgICAgICB9\nCiAgICAgICAgdHJhbi5jb21taXQoKTsKICAgICAgICBlbS5jbGVhcigpOwog\nICAgICAgIC8vIHRlc3QgcmFuZ2UgdmFyaWFibGUgb3ZlciBlbGVtZW50IGNv\nbGxlY3Rpb24KICAgICAgICBTdHJpbmdbXSBxdWVyeSA9IHsKICAgICAgICAg\nICAgInNlbGVjdCBlIGZyb20gRW1wbG95ZWUgZSwgaW4gKGUubmlja05hbWVz\nKSBuICIgKwogICAgICAgICAgICAgICAgIiB3aGVyZSBuIGxpa2UgJyUxJyIs\nICAKICAgICAgICB9OwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgcXVl\ncnkubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgZXMgPSBlbS5jcmVhdGVR\ndWVyeShxdWVyeVtpXSkuZ2V0UmVzdWx0TGlzdCgpOwogICAgICAgICAgICBm\nb3IgKEVtcGxveWVlIGUgOiBlcyl7CiAgICAgICAgICAgICAgICBhc3NlcnRF\nbXBsb3llZShlKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBl\nbS5jbG9zZSgpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIGFzc2VydFByb2dy\nYW1NYW5hZ2VyKFByb2dyYW1NYW5hZ2VyIHBtKSB7CiAgICAgICAgaW50IGlk\nID0gcG0uZ2V0SWQoKTsKICAgICAgICBDb2xsZWN0aW9uPEVtcGxveWVlPiBl\ncyA9IHBtLmdldE1hbmFnZXMoKTsKICAgICAgICBhc3NlcnRFcXVhbHMobnVt\nRW1wbG95ZWVzUGVyUHJvZ3JhbU1hbmFnZXIsIGVzLnNpemUoKSk7CiAgICAg\nICAgZm9yIChFbXBsb3llZSBlIDogZXMpIHsKICAgICAgICAgICAgYXNzZXJ0\nRW1wbG95ZWUoZSk7CiAgICAgICAgfQogICAgfQogICAgCiAgICBwdWJsaWMg\ndm9pZCBhc3NlcnRFbXBsb3llZShFbXBsb3llZSBlKSB7CiAgICAgICAgaW50\nIGlkID0gZS5nZXRFbXBJZCgpOwogICAgICAgIENvbnRhY3RJbmZvIGMgPSBl\nLmdldENvbnRhY3RJbmZvKCk7CiAgICAgICAgTGlzdDxQaG9uZU51bWJlcj4g\ncGhvbmVzID0gYy5nZXRQaG9uZU51bWJlcnMoKTsKICAgICAgICBhc3NlcnRF\ncXVhbHMobnVtUGhvbmVOdW1iZXJzUGVyRW1wbG95ZWUsIHBob25lcy5zaXpl\nKCkpOwogICAgICAgIGZvciAoUGhvbmVOdW1iZXIgcCA6IHBob25lcykgewog\nICAgICAgICAgICBhc3NlcnRQaG9uZU51bWJlcihwKTsKICAgICAgICB9CiAg\nICAgICAgCiAgICAgICAgTG9jYXRpb25EZXRhaWxzIGxvYyA9IGUuZ2V0TG9j\nYXRpb25EZXRhaWxzKCk7CiAgICAgICAgaW50IG9mZmljZU51bWJlciA9IGxv\nYy5nZXRPZmZpY2VOdW1iZXIoKTsKICAgICAgICBQYXJraW5nU3BvdCBwID0g\nbG9jLmdldFBhcmtpbmdTcG90KCk7CiAgICAgICAgYXNzZXJ0UGFya2luZ1Nw\nb3QocCk7CiAgICAgICAgUHJvZ3JhbU1hbmFnZXIgcG0gPSBlLmdldEpvYklu\nZm8oKS5nZXRQcm9ncmFtTWFuYWdlcigpOwogICAgICAgIFNldDxTdHJpbmc+\nIG5pY2tOYW1lcyA9IGUuZ2V0Tmlja05hbWVzKCk7CiAgICAgICAgYXNzZXJ0\nRXF1YWxzKG51bU5pY2tOYW1lcywgbmlja05hbWVzLnNpemUoKSk7CiAgICAg\nICAgCiAgICB9CiAgICAKICAgIHB1YmxpYyB2b2lkIGFzc2VydFBob25lTnVt\nYmVyKFBob25lTnVtYmVyIHApIHsKICAgICAgICBpbnQgbnVtYmVyID0gcC5n\nZXROdW1iZXIoKTsKICAgICAgICBDb2xsZWN0aW9uPEVtcGxveWVlPiBlcyA9\nIHAuZ2V0RW1wbG95ZWVzKCk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKG51bUVt\ncGxveWVlc1BlclBob25lTnVtYmVyLCBlcy5zaXplKCkpOwogICAgfQogICAg\nCiAgICBwdWJsaWMgdm9pZCBhc3NlcnRQYXJraW5nU3BvdChQYXJraW5nU3Bv\ndCBwKSB7CiAgICAgICAgU3RyaW5nIGdhcmFnZSA9IHAuZ2V0R2FyYWdlKCk7\nCiAgICAgICAgRW1wbG95ZWUgZSA9IHAuZ2V0QXNzaWduZWRUbygpOwogICAg\nfQogICAgCiAgICAvKgogICAgICogRmluZCBFbnRpdHlBX0NvbGxfU3RyaW5n\nCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIGZpbmRFbnRpdHlBX0NvbGxfU3Ry\naW5nKCkgewogICAgICAgIEVudGl0eU1hbmFnZXIgZW0gPSBlbWYuY3JlYXRl\nRW50aXR5TWFuYWdlcigpOwogICAgICAgIEVudGl0eUFfQ29sbF9TdHJpbmcg\nYSA9IGVtLmZpbmQoRW50aXR5QV9Db2xsX1N0cmluZy5jbGFzcywgSUQpOwog\nICAgICAgIGNoZWNrRW50aXR5QV9Db2xsX1N0cmluZyhhKTsKICAgICAgICBl\nbS5jbG9zZSgpOwogICAgfQoKICAgIC8qCiAgICAgKiBGaW5kIEVudGl0eUFf\nRW1iZWRfVG9PbmUKICAgICAqLwogICAgcHVibGljIHZvaWQgZmluZEVudGl0\neUFfRW1iZWRfVG9PbmUoKSB7CiAgICAgICAgRW50aXR5TWFuYWdlciBlbSA9\nIGVtZi5jcmVhdGVFbnRpdHlNYW5hZ2VyKCk7CiAgICAgICAgRW50aXR5QV9F\nbWJlZF9Ub09uZSBhID0gZW0uZmluZChFbnRpdHlBX0VtYmVkX1RvT25lLmNs\nYXNzLCBJRCk7CiAgICAgICAgY2hlY2tFbnRpdHlBX0VtYmVkX1RvT25lKGEp\nOwogICAgICAgIGVtLmdldFRyYW5zYWN0aW9uKCkuYmVnaW4oKTsKICAgICAg\nICBlbS5yZW1vdmUoYSk7CiAgICAgICAgZW0uZ2V0VHJhbnNhY3Rpb24oKS5j\nb21taXQoKTsKICAgICAgICAvL2RlbGV0ZSBjYXNjYWRlCiAgICAgICAgRW50\naXR5QjEgYiA9IGVtLmZpbmQoRW50aXR5QjEuY2xhc3MsIElEKTsKICAgICAg\nICBhc3NlcnROdWxsKGIpOwogICAgICAgIGVtLmNsb3NlKCk7CiAgICB9Cgog\nICAgLyoKICAgICAqIEZpbmQgRW50aXR5QV9FbWJlZF9NYXBwZWRUb09uZQog\nICAgICovCiAgICBwdWJsaWMgdm9pZCBmaW5kRW50aXR5QV9FbWJlZF9NYXBw\nZWRUb09uZSgpIHsKICAgICAgICBFbnRpdHlNYW5hZ2VyIGVtID0gZW1mLmNy\nZWF0ZUVudGl0eU1hbmFnZXIoKTsKICAgICAgICBFbnRpdHlBX0VtYmVkX01h\ncHBlZFRvT25lIGEgPQogICAgICAgICAgICBlbS5maW5kKEVudGl0eUFfRW1i\nZWRfTWFwcGVkVG9PbmUuY2xhc3MsIElEKTsKICAgICAgICBjaGVja0VudGl0\neUFfRW1iZWRfTWFwcGVkVG9PbmUoYSk7CiAgICAgICAgZW0uY2xvc2UoKTsK\nICAgIH0KCiAgICAvKgogICAgICogRmluZCBFbnRpdHlBX0NvbGxfRW1iZWRf\nVG9PbmUKICAgICAqLwogICAgcHVibGljIHZvaWQgZmluZEVudGl0eUFfQ29s\nbF9FbWJlZF9Ub09uZSgpIHsKICAgICAgICBFbnRpdHlNYW5hZ2VyIGVtID0g\nZW1mLmNyZWF0ZUVudGl0eU1hbmFnZXIoKTsKICAgICAgICBFbnRpdHlBX0Nv\nbGxfRW1iZWRfVG9PbmUgYSA9CiAgICAgICAgICAgIGVtLmZpbmQoRW50aXR5\nQV9Db2xsX0VtYmVkX1RvT25lLmNsYXNzLCBJRCk7CiAgICAgICAgY2hlY2tF\nbnRpdHlBX0NvbGxfRW1iZWRfVG9PbmUoYSk7CiAgICAgICAgZW0uY2xvc2Uo\nKTsKICAgIH0KCiAgICAvKgogICAgICogRmluZCBFbnRpdHlBX0VtYmVkX1Rv\nTWFueQogICAgICovCiAgICBwdWJsaWMgdm9pZCBmaW5kRW50aXR5QV9FbWJl\nZF9Ub01hbnkoKSB7CiAgICAgICAgRW50aXR5TWFuYWdlciBlbSA9IGVtZi5j\ncmVhdGVFbnRpdHlNYW5hZ2VyKCk7CiAgICAgICAgRW50aXR5QV9FbWJlZF9U\nb01hbnkgYSA9IGVtLmZpbmQoRW50aXR5QV9FbWJlZF9Ub01hbnkuY2xhc3Ms\nIElEKTsKICAgICAgICBjaGVja0VudGl0eUFfRW1iZWRfVG9NYW55KGEpOwog\nICAgICAgIGVtLmNsb3NlKCk7CiAgICB9CgogICAgLyoKICAgICAqIEZpbmQg\nRW50aXR5QV9FbWJlZF9FbWJlZF9Ub01hbnkKICAgICAqLwogICAgcHVibGlj\nIHZvaWQgZmluZEVudGl0eUFfRW1iZWRfRW1iZWRfVG9NYW55KCkgewogICAg\nICAgIEVudGl0eU1hbmFnZXIgZW0gPSBlbWYuY3JlYXRlRW50aXR5TWFuYWdl\ncigpOwogICAgICAgIEVudGl0eUFfRW1iZWRfRW1iZWRfVG9NYW55IGEgPQog\nICAgICAgICAgICBlbS5maW5kKEVudGl0eUFfRW1iZWRfRW1iZWRfVG9NYW55\nLmNsYXNzLCBJRCk7CiAgICAgICAgY2hlY2tFbnRpdHlBX0VtYmVkX0VtYmVk\nX1RvTWFueShhKTsKICAgICAgICBlbS5jbG9zZSgpOwogICAgfQoKICAgIC8q\nCiAgICAgKiBGaW5kIEVudGl0eUFfRW1iZWRfQ29sbF9JbnRlZ2VyCiAgICAg\nKi8KICAgIHB1YmxpYyB2b2lkIGZpbmRFbnRpdHlBX0VtYmVkX0NvbGxfSW50\nZWdlcigpIHsKICAgICAgICBFbnRpdHlNYW5hZ2VyIGVtID0gZW1mLmNyZWF0\nZUVudGl0eU1hbmFnZXIoKTsKICAgICAgICBFbnRpdHlBX0VtYmVkX0NvbGxf\nSW50ZWdlciBhID0KICAgICAgICAgICAgZW0uZmluZChFbnRpdHlBX0VtYmVk\nX0NvbGxfSW50ZWdlci5jbGFzcywgSUQpOwogICAgICAgIGNoZWNrRW50aXR5\nQV9FbWJlZF9Db2xsX0ludGVnZXIoYSk7CiAgICAgICAgZW0uY2xvc2UoKTsK\nICAgIH0KCiAgICAvKgogICAgICogRmluZCBFbnRpdHlBX0VtYmVkX0VtYmVk\nCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIGZpbmRFbnRpdHlBX0VtYmVkX0Vt\nYmVkKCkgewogICAgICAgIEVudGl0eU1hbmFnZXIgZW0gPSBlbWYuY3JlYXRl\nRW50aXR5TWFuYWdlcigpOwogICAgICAgIEVudGl0eUFfRW1iZWRfRW1iZWQg\nYSA9IGVtLmZpbmQoRW50aXR5QV9FbWJlZF9FbWJlZC5jbGFzcywgSUQpOwog\nICAgICAgIGNoZWNrRW50aXR5QV9FbWJlZF9FbWJlZChhKTsKICAgICAgICBl\nbS5jbG9zZSgpOwogICAgfQoKICAgIC8qCiAgICAgKiBGaW5kIEVudGl0eUFf\nQ29sbF9FbWJlZF9FbWJlZAogICAgICovCiAgICBwdWJsaWMgdm9pZCBmaW5k\nRW50aXR5QV9Db2xsX0VtYmVkX0VtYmVkKCkgewogICAgICAgIEVudGl0eU1h\nbmFnZXIgZW0gPSBlbWYuY3JlYXRlRW50aXR5TWFuYWdlcigpOwogICAgICAg\nIEVudGl0eUFfQ29sbF9FbWJlZF9FbWJlZCBhID0KICAgICAgICAgICAgZW0u\nZmluZChFbnRpdHlBX0NvbGxfRW1iZWRfRW1iZWQuY2xhc3MsIElEKTsKICAg\nICAgICBjaGVja0VudGl0eUFfQ29sbF9FbWJlZF9FbWJlZChhKTsKICAgICAg\nICAKICAgICAgICBlbS5jbGVhcigpOwogICAgICAgIGVtLmdldFRyYW5zYWN0\naW9uKCkuYmVnaW4oKTsKICAgICAgICBFbWJlZF9FbWJlZCBlbWJlZCA9IGNy\nZWF0ZUVtYmVkX0VtYmVkKGVtLCBJRCwgMTAwKTsKICAgICAgICBhLmFkZEVt\nYmVkKGVtYmVkKTsKICAgICAgICBlbS5tZXJnZShhKTsKICAgICAgICBlbS5n\nZXRUcmFuc2FjdGlvbigpLmNvbW1pdCgpOwogICAgICAgIGVtLmNsb3NlKCk7\nCiAgICB9CgogICAgLyoKICAgICAqIEZpbmQgRW50aXR5QV9FbWJlZF9Db2xs\nX0VtYmVkCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIGZpbmRFbnRpdHlBX0Vt\nYmVkX0NvbGxfRW1iZWQoKSB7CiAgICAgICAgRW50aXR5TWFuYWdlciBlbSA9\nIGVtZi5jcmVhdGVFbnRpdHlNYW5hZ2VyKCk7CiAgICAgICAgRW50aXR5QV9F\nbWJlZF9Db2xsX0VtYmVkIGEgPQogICAgICAgICAgICBlbS5maW5kKEVudGl0\neUFfRW1iZWRfQ29sbF9FbWJlZC5jbGFzcywgSUQpOwogICAgICAgIGNoZWNr\nRW50aXR5QV9FbWJlZF9Db2xsX0VtYmVkKGEpOwogICAgICAgIGVtLmNsb3Nl\nKCk7CiAgICB9CgogICAgLyoKICAgICAqIGNoZWNrIEVudGl0eUFfQ29sbF9T\ndHJpbmcKICAgICAqLwogICAgcHVibGljIHZvaWQgY2hlY2tFbnRpdHlBX0Nv\nbGxfU3RyaW5nKEVudGl0eUFfQ29sbF9TdHJpbmcgYSkgewogICAgICAgIGlu\ndCBpZCA9IGEuZ2V0SWQoKTsKICAgICAgICBTdHJpbmcgbmFtZSA9IGEuZ2V0\nTmFtZSgpOwogICAgICAgIGludCBhZ2UgPSBhLmdldEFnZSgpOwogICAgICAg\nIGFzc2VydEVxdWFscygxLCBpZCk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKCJh\nIiArIGlkICxuYW1lKTsKICAgICAgICBhc3NlcnRFcXVhbHMoMSwgYWdlKTsK\nICAgICAgICBTZXQ8U3RyaW5nPiBuaWNrTmFtZXMgPSBhLmdldE5pY2tOYW1l\ncygpOwogICAgICAgIGZvciAoU3RyaW5nIG5pY2tOYW1lIDogbmlja05hbWVz\nKQogICAgICAgICAgICBhc3NlcnRFcXVhbHMoIm5pY2tOYW1lXyIgKyBpZCAr\nICIwIiwgbmlja05hbWUpOwogICAgICAgIExpc3Q8RW50aXR5QV9Db2xsX1N0\ncmluZy5DcmVkaXRSYXRpbmc+IGNyID0gYS5nZXRDcmVkaXRSYXRpbmcoKTsK\nICAgICAgICBmb3IgKEVudGl0eUFfQ29sbF9TdHJpbmcuQ3JlZGl0UmF0aW5n\nIGMgOiBjcikKICAgICAgICAgICAgYXNzZXJ0RXF1YWxzKCJQT09SIiwgYy50\nb1N0cmluZygpKTsKICAgIH0KCiAgICAvKgogICAgICogY2hlY2sgRW50aXR5\nQV9FbWJlZF9Ub09uZQogICAgICovCiAgICBwdWJsaWMgdm9pZCBjaGVja0Vu\ndGl0eUFfRW1iZWRfVG9PbmUoRW50aXR5QV9FbWJlZF9Ub09uZSBhKSB7CiAg\nICAgICAgaW50IGlkID0gYS5nZXRJZCgpOwogICAgICAgIFN0cmluZyBuYW1l\nID0gYS5nZXROYW1lKCk7CiAgICAgICAgaW50IGFnZSA9IGEuZ2V0QWdlKCk7\nCiAgICAgICAgYXNzZXJ0RXF1YWxzKDEsIGlkKTsKICAgICAgICBhc3NlcnRF\ncXVhbHMoImEiICsgaWQgLG5hbWUpOwogICAgICAgIGFzc2VydEVxdWFscygx\nLCBhZ2UpOwogICAgICAgIEVtYmVkX1RvT25lIGVtYmVkID0gYS5nZXRFbWJl\nZCgpOwogICAgICAgIGNoZWNrRW1iZWRfVG9PbmUoZW1iZWQpOwogICAgfQoK\nICAgIC8qCiAgICAgKiBjaGVjayBFbnRpdHlBX0VtYmVkX01hcHBlZFRvT25l\nCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIGNoZWNrRW50aXR5QV9FbWJlZF9N\nYXBwZWRUb09uZShFbnRpdHlBX0VtYmVkX01hcHBlZFRvT25lIGEpIHsKICAg\nICAgICBpbnQgaWQgPSBhLmdldElkKCk7CiAgICAgICAgU3RyaW5nIG5hbWUg\nPSBhLmdldE5hbWUoKTsKICAgICAgICBpbnQgYWdlID0gYS5nZXRBZ2UoKTsK\nICAgICAgICBhc3NlcnRFcXVhbHMoMSwgaWQpOwogICAgICAgIGFzc2VydEVx\ndWFscygiYSIgKyBpZCAsbmFtZSk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKDEs\nIGFnZSk7CiAgICAgICAgRW1iZWRfTWFwcGVkVG9PbmUgZW1iZWQgPSBhLmdl\ndEVtYmVkKCk7CiAgICAgICAgY2hlY2tFbWJlZF9NYXBwZWRUb09uZShlbWJl\nZCk7CiAgICB9CgogICAgLyoKICAgICAqIGNoZWNrIEVudGl0eUFfQ29sbF9F\nbWJlZF9Ub09uZQogICAgICovCiAgICBwdWJsaWMgdm9pZCBjaGVja0VudGl0\neUFfQ29sbF9FbWJlZF9Ub09uZShFbnRpdHlBX0NvbGxfRW1iZWRfVG9PbmUg\nYSkgewogICAgICAgIGludCBpZCA9IGEuZ2V0SWQoKTsKICAgICAgICBTdHJp\nbmcgbmFtZSA9IGEuZ2V0TmFtZSgpOwogICAgICAgIGludCBhZ2UgPSBhLmdl\ndEFnZSgpOwogICAgICAgIGFzc2VydEVxdWFscygxLCBpZCk7CiAgICAgICAg\nYXNzZXJ0RXF1YWxzKCJhIiArIGlkICxuYW1lKTsKICAgICAgICBhc3NlcnRF\ncXVhbHMoMSwgYWdlKTsKICAgICAgICBTZXQ8RW1iZWRfVG9PbmU+IGVtYmVk\ncyA9IGEuZ2V0RW1iZWQxVG9PbmVzKCk7CiAgICAgICAgZm9yIChFbWJlZF9U\nb09uZSBlbWJlZCA6IGVtYmVkcykKICAgICAgICAgICAgY2hlY2tFbWJlZF9U\nb09uZShlbWJlZCk7CiAgICB9CgogICAgcHVibGljIHZvaWQgY2hlY2tFbWJl\nZF9Ub09uZShFbWJlZF9Ub09uZSBlbWJlZCkgewogICAgICAgIFN0cmluZyBu\nYW1lMSA9IGVtYmVkLmdldE5hbWUxKCk7CiAgICAgICAgU3RyaW5nIG5hbWUy\nID0gZW1iZWQuZ2V0TmFtZTIoKTsKICAgICAgICBTdHJpbmcgbmFtZTMgPSBl\nbWJlZC5nZXROYW1lMygpOwogICAgICAgIGFzc2VydEVxdWFscygibmFtZTEi\nLCBuYW1lMSk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKCJuYW1lMiIsIG5hbWUy\nKTsKICAgICAgICBhc3NlcnRFcXVhbHMoIm5hbWUzIiwgbmFtZTMpOwogICAg\nICAgIEVudGl0eUIxIGIgPSBlbWJlZC5nZXRFbnRpdHlCKCk7CiAgICAgICAg\nYXNzZXJ0RXF1YWxzKDEsIGIuZ2V0SWQoKSk7CiAgICAgICAgYXNzZXJ0RXF1\nYWxzKCJiIiArIGIuZ2V0SWQoKSwgYi5nZXROYW1lKCkpOwogICAgfQoKICAg\nIHB1YmxpYyB2b2lkIGNoZWNrRW1iZWRfTWFwcGVkVG9PbmUoRW1iZWRfTWFw\ncGVkVG9PbmUgZW1iZWQpIHsKICAgICAgICBTdHJpbmcgbmFtZTEgPSBlbWJl\nZC5nZXROYW1lMSgpOwogICAgICAgIFN0cmluZyBuYW1lMiA9IGVtYmVkLmdl\ndE5hbWUyKCk7CiAgICAgICAgU3RyaW5nIG5hbWUzID0gZW1iZWQuZ2V0TmFt\nZTMoKTsKICAgICAgICBhc3NlcnRFcXVhbHMoIm5hbWUxIiwgbmFtZTEpOwog\nICAgICAgIGFzc2VydEVxdWFscygibmFtZTIiLCBuYW1lMik7CiAgICAgICAg\nYXNzZXJ0RXF1YWxzKCJuYW1lMyIsIG5hbWUzKTsKICAgICAgICBFbnRpdHlC\nMSBiID0gZW1iZWQuZ2V0TWFwcGVkRW50aXR5QigpOwogICAgICAgIGFzc2Vy\ndEVxdWFscygxLCBiLmdldElkKCkpOwogICAgICAgIGFzc2VydEVxdWFscygi\nYm0iICsgYi5nZXRJZCgpLCBiLmdldE5hbWUoKSk7CiAgICB9CgogICAgLyoK\nICAgICAqIGNoZWNrIEVudGl0eUFfRW1iZWRfVG9NYW55CiAgICAgKi8KICAg\nIHB1YmxpYyB2b2lkIGNoZWNrRW50aXR5QV9FbWJlZF9Ub01hbnkoRW50aXR5\nQV9FbWJlZF9Ub01hbnkgYSkgewogICAgICAgIGludCBpZCA9IGEuZ2V0SWQo\nKTsKICAgICAgICBTdHJpbmcgbmFtZSA9IGEuZ2V0TmFtZSgpOwogICAgICAg\nIGludCBhZ2UgPSBhLmdldEFnZSgpOwogICAgICAgIGFzc2VydEVxdWFscygx\nLCBpZCk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKCJhIiArIGlkICxuYW1lKTsK\nICAgICAgICBhc3NlcnRFcXVhbHMoMSwgYWdlKTsKICAgICAgICBFbWJlZF9U\nb01hbnkgZW1iZWQgPSBhLmdldEVtYmVkKCk7CiAgICAgICAgY2hlY2tFbWJl\nZF9Ub01hbnkoZW1iZWQpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIGNoZWNr\nRW1iZWRfVG9NYW55KEVtYmVkX1RvTWFueSBlbWJlZCkgewogICAgICAgIFN0\ncmluZyBuYW1lMSA9IGVtYmVkLmdldE5hbWUxKCk7CiAgICAgICAgU3RyaW5n\nIG5hbWUyID0gZW1iZWQuZ2V0TmFtZTIoKTsKICAgICAgICBTdHJpbmcgbmFt\nZTMgPSBlbWJlZC5nZXROYW1lMygpOwogICAgICAgIGFzc2VydEVxdWFscygi\nbmFtZTEiLCBuYW1lMSk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKCJuYW1lMiIs\nIG5hbWUyKTsKICAgICAgICBhc3NlcnRFcXVhbHMoIm5hbWUzIiwgbmFtZTMp\nOwogICAgICAgIExpc3Q8RW50aXR5QjE+IGJzID0gZW1iZWQuZ2V0RW50aXR5\nQnMoKTsKICAgICAgICBmb3IgKEVudGl0eUIxIGIgOiBicykgewogICAgICAg\nICAgICBhc3NlcnRFcXVhbHMoMSwgYi5nZXRJZCgpKTsKICAgICAgICAgICAg\nYXNzZXJ0RXF1YWxzKCJiIiArIGIuZ2V0SWQoKSArICIwIiwgYi5nZXROYW1l\nKCkpOwogICAgICAgIH0KICAgIH0KCiAgICAvKgogICAgICogY2hlY2sgRW50\naXR5QV9FbWJlZF9FbWJlZF9Ub01hbnkKICAgICAqLwogICAgcHVibGljIHZv\naWQgY2hlY2tFbnRpdHlBX0VtYmVkX0VtYmVkX1RvTWFueShFbnRpdHlBX0Vt\nYmVkX0VtYmVkX1RvTWFueSBhKSB7CiAgICAgICAgaW50IGlkID0gYS5nZXRJ\nZCgpOwogICAgICAgIFN0cmluZyBuYW1lID0gYS5nZXROYW1lKCk7CiAgICAg\nICAgaW50IGFnZSA9IGEuZ2V0QWdlKCk7CiAgICAgICAgYXNzZXJ0RXF1YWxz\nKDEsIGlkKTsKICAgICAgICBhc3NlcnRFcXVhbHMoImEiICsgaWQgLG5hbWUp\nOwogICAgICAgIGFzc2VydEVxdWFscygxLCBhZ2UpOwogICAgICAgIEVtYmVk\nX0VtYmVkX1RvTWFueSBlbWJlZCA9IGEuZ2V0RW1iZWQoKTsKICAgICAgICBj\naGVja0VtYmVkX0VtYmVkX1RvTWFueShlbWJlZCk7CiAgICB9CiAgICAKICAg\nIHB1YmxpYyB2b2lkIGNoZWNrRW1iZWRfRW1iZWRfVG9NYW55KEVtYmVkX0Vt\nYmVkX1RvTWFueSBlbWJlZCkgewogICAgICAgIGludCBpbnRWYWwxID0gZW1i\nZWQuZ2V0SW50VmFsMSgpOwogICAgICAgIGludCBpbnRWYWwyID0gZW1iZWQu\nZ2V0SW50VmFsMigpOwogICAgICAgIGludCBpbnRWYWwzID0gZW1iZWQuZ2V0\nSW50VmFsMygpOwogICAgICAgIGFzc2VydEVxdWFscygxLCBpbnRWYWwxKTsK\nICAgICAgICBhc3NlcnRFcXVhbHMoMiwgaW50VmFsMik7CiAgICAgICAgYXNz\nZXJ0RXF1YWxzKDMsIGludFZhbDMpOwogICAgICAgIEVtYmVkX1RvTWFueSBl\nbWJlZDEgPSBlbWJlZC5nZXRFbWJlZCgpOwogICAgICAgIGNoZWNrRW1iZWRf\nVG9NYW55KGVtYmVkMSk7CiAgICB9CiAgICAKICAgIC8qCiAgICAgKiBjaGVj\nayBFbnRpdHlBX0VtYmVkX0NvbGxfSW50ZWdlcgogICAgICovCiAgICBwdWJs\naWMgdm9pZCBjaGVja0VudGl0eUFfRW1iZWRfQ29sbF9JbnRlZ2VyKEVudGl0\neUFfRW1iZWRfQ29sbF9JbnRlZ2VyIGEpIHsKICAgICAgICBpbnQgaWQgPSBh\nLmdldElkKCk7CiAgICAgICAgU3RyaW5nIG5hbWUgPSBhLmdldE5hbWUoKTsK\nICAgICAgICBpbnQgYWdlID0gYS5nZXRBZ2UoKTsKICAgICAgICBhc3NlcnRF\ncXVhbHMoMSwgaWQpOwogICAgICAgIGFzc2VydEVxdWFscygiYSIgKyBpZCAs\nbmFtZSk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKDEsIGFnZSk7CiAgICAgICAg\nRW1iZWRfQ29sbF9JbnRlZ2VyIGVtYmVkID0gYS5nZXRFbWJlZCgpOwogICAg\nICAgIGNoZWNrRW1iZWRfSW50ZWdlcnMoZW1iZWQpOwogICAgfQoKICAgIHB1\nYmxpYyB2b2lkIGNoZWNrRW1iZWRfSW50ZWdlcnMoRW1iZWRfQ29sbF9JbnRl\nZ2VyIGVtYmVkKSB7CiAgICAgICAgaW50IGludFZhbDEgPSBlbWJlZC5nZXRJ\nbnRWYWwxKCk7CiAgICAgICAgaW50IGludFZhbDIgPSBlbWJlZC5nZXRJbnRW\nYWwyKCk7CiAgICAgICAgaW50IGludFZhbDMgPSBlbWJlZC5nZXRJbnRWYWwz\nKCk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKDExLCBpbnRWYWwxKTsKICAgICAg\nICBhc3NlcnRFcXVhbHMoMTIsIGludFZhbDIpOwogICAgICAgIGFzc2VydEVx\ndWFscygxMywgaW50VmFsMyk7CiAgICAgICAgU2V0PEludGVnZXI+IGludFZh\nbHMgPSBlbWJlZC5nZXRPdGhlckludFZhbHMoKTsKICAgICAgICBmb3IgKElu\ndGVnZXIgaW50VmFsIDogaW50VmFscykgewogICAgICAgICAgICBhc3NlcnRF\ncXVhbHMoMTAwLCBpbnRWYWwuaW50VmFsdWUoKSk7CiAgICAgICAgfQogICAg\nfQoKICAgIC8qCiAgICAgKiBjaGVjayBFbnRpdHlBX0VtYmVkX0VtYmVkCiAg\nICAgKi8KICAgIHB1YmxpYyB2b2lkIGNoZWNrRW50aXR5QV9FbWJlZF9FbWJl\nZChFbnRpdHlBX0VtYmVkX0VtYmVkIGEpIHsKICAgICAgICBpbnQgaWQgPSBh\nLmdldElkKCk7CiAgICAgICAgU3RyaW5nIG5hbWUgPSBhLmdldE5hbWUoKTsK\nICAgICAgICBpbnQgYWdlID0gYS5nZXRBZ2UoKTsKICAgICAgICBhc3NlcnRF\ncXVhbHMoMSwgaWQpOwogICAgICAgIGFzc2VydEVxdWFscygiYSIgKyBpZCAs\nbmFtZSk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKDEsIGFnZSk7CiAgICAgICAg\nRW1iZWRfRW1iZWQgZW1iZWQgPSBhLmdldEVtYmVkKCk7CiAgICAgICAgY2hl\nY2tFbWJlZF9FbWJlZChlbWJlZCk7CiAgICB9CgogICAgcHVibGljIHZvaWQg\nY2hlY2tFbWJlZF9FbWJlZChFbWJlZF9FbWJlZCBlbWJlZCkgewogICAgICAg\nIGludCBpbnRWYWwxID0gZW1iZWQuZ2V0SW50VmFsMSgpOwogICAgICAgIGlu\ndCBpbnRWYWwyID0gZW1iZWQuZ2V0SW50VmFsMigpOwogICAgICAgIGludCBp\nbnRWYWwzID0gZW1iZWQuZ2V0SW50VmFsMygpOwogICAgICAgIGFzc2VydEVx\ndWFscygxMDEsIGludFZhbDEpOwogICAgICAgIGFzc2VydEVxdWFscygxMDIs\nIGludFZhbDIpOwogICAgICAgIGFzc2VydEVxdWFscygxMDMsIGludFZhbDMp\nOwogICAgICAgIEVtYmVkIGVtYmVkMSA9IGVtYmVkLmdldEVtYmVkKCk7CiAg\nICAgICAgY2hlY2tFbWJlZChlbWJlZDEpOwogICAgfQoKICAgIHB1YmxpYyB2\nb2lkIGNoZWNrRW1iZWQoRW1iZWQgZW1iZWQpIHsKICAgICAgICBpbnQgaW50\nVmFsMSA9IGVtYmVkLmdldEludFZhbDEoKTsKICAgICAgICBpbnQgaW50VmFs\nMiA9IGVtYmVkLmdldEludFZhbDIoKTsKICAgICAgICBpbnQgaW50VmFsMyA9\nIGVtYmVkLmdldEludFZhbDMoKTsKICAgICAgICBhc3NlcnRFcXVhbHMoMTA0\nLCBpbnRWYWwxKTsKICAgICAgICBhc3NlcnRFcXVhbHMoMTA1LCBpbnRWYWwy\nKTsKICAgICAgICBhc3NlcnRFcXVhbHMoMTA2LCBpbnRWYWwzKTsKICAgIH0K\nCiAgICAvKgogICAgICogY2hlY2sgRW50aXR5QV9Db2xsX0VtYmVkX0VtYmVk\nCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIGNoZWNrRW50aXR5QV9Db2xsX0Vt\nYmVkX0VtYmVkKEVudGl0eUFfQ29sbF9FbWJlZF9FbWJlZCBhKSB7CiAgICAg\nICAgaW50IGlkID0gYS5nZXRJZCgpOwogICAgICAgIFN0cmluZyBuYW1lID0g\nYS5nZXROYW1lKCk7CiAgICAgICAgaW50IGFnZSA9IGEuZ2V0QWdlKCk7CiAg\nICAgICAgYXNzZXJ0RXF1YWxzKDEsIGlkKTsKICAgICAgICBhc3NlcnRFcXVh\nbHMoImEiICsgaWQgLG5hbWUpOwogICAgICAgIGFzc2VydEVxdWFscygxLCBh\nZ2UpOwogICAgICAgIExpc3Q8RW1iZWRfRW1iZWQ+IGVtYmVkcyA9IGEuZ2V0\nRW1iZWRzKCk7CiAgICAgICAgZm9yIChFbWJlZF9FbWJlZCBlbWJlZCA6IGVt\nYmVkcykKICAgICAgICAgICAgY2hlY2tFbWJlZF9FbWJlZChlbWJlZCk7CiAg\nICB9CgogICAgLyoKICAgICAqIGNoZWNrIEVudGl0eUFfRW1iZWRfQ29sbF9F\nbWJlZAogICAgICovCiAgICBwdWJsaWMgdm9pZCBjaGVja0VudGl0eUFfRW1i\nZWRfQ29sbF9FbWJlZChFbnRpdHlBX0VtYmVkX0NvbGxfRW1iZWQgYSkgewog\nICAgICAgIGludCBpZCA9IGEuZ2V0SWQoKTsKICAgICAgICBTdHJpbmcgbmFt\nZSA9IGEuZ2V0TmFtZSgpOwogICAgICAgIGludCBhZ2UgPSBhLmdldEFnZSgp\nOwogICAgICAgIGFzc2VydEVxdWFscygxLCBpZCk7CiAgICAgICAgYXNzZXJ0\nRXF1YWxzKCJhIiArIGlkICxuYW1lKTsKICAgICAgICBhc3NlcnRFcXVhbHMo\nMSwgYWdlKTsKICAgICAgICBFbWJlZF9Db2xsX0VtYmVkIGVtYmVkID0gYS5n\nZXRFbWJlZCgpOwogICAgICAgIGNoZWNrRW1iZWRfQ29sbF9FbWJlZChlbWJl\nZCk7CiAgICB9CgogICAgcHVibGljIHZvaWQgY2hlY2tFbWJlZF9Db2xsX0Vt\nYmVkKEVtYmVkX0NvbGxfRW1iZWQgZW1iZWQpIHsKICAgICAgICBpbnQgaW50\nVmFsMSA9IGVtYmVkLmdldEludFZhbDEoKTsKICAgICAgICBpbnQgaW50VmFs\nMiA9IGVtYmVkLmdldEludFZhbDIoKTsKICAgICAgICBpbnQgaW50VmFsMyA9\nIGVtYmVkLmdldEludFZhbDMoKTsKICAgICAgICBhc3NlcnRFcXVhbHMoMTEs\nIGludFZhbDEpOwogICAgICAgIGFzc2VydEVxdWFscygxMiwgaW50VmFsMik7\nCiAgICAgICAgYXNzZXJ0RXF1YWxzKDEzLCBpbnRWYWwzKTsKICAgICAgICBM\naXN0PEVtYmVkPiBlbWJlZHMgPSBlbWJlZC5nZXRFbWJlZHMoKTsKICAgICAg\nICBmb3IgKEVtYmVkIGVtYmVkMSA6IGVtYmVkcykKICAgICAgICAgICAgY2hl\nY2tFbWJlZChlbWJlZDEpOwogICAgfQoKICAgIC8qCiAgICAgKiBRdWVyeSBF\nbnRpdHlBX0NvbGxfU3RyaW5nCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHF1\nZXJ5RW50aXR5QV9Db2xsX1N0cmluZygpIHsKICAgICAgICBFbnRpdHlNYW5h\nZ2VyIGVtID0gZW1mLmNyZWF0ZUVudGl0eU1hbmFnZXIoKTsKICAgICAgICBT\ndHJpbmdbXSBxdWVyeSA9IHsKICAgICAgICAgICAgInNlbGVjdCBlIGZyb20g\nIiArCiAgICAgICAgICAgICAgICAiIEVudGl0eUFfQ29sbF9TdHJpbmcgYSAi\nICsKICAgICAgICAgICAgICAgICIgLCBpbiAoYS5uaWNrTmFtZXMpIGUgb3Jk\nZXIgYnkgYS5pZCIsCiAgICAgICAgICAgICJzZWxlY3QgZSBmcm9tICIgKwog\nICAgICAgICAgICAgICAgIiBFbnRpdHlBX0NvbGxfU3RyaW5nIGEgIiArCiAg\nICAgICAgICAgICAgICAiICwgaW4gKGEubmlja05hbWVzKSBlIG9yZGVyIGJ5\nIGEuaWQiLAogICAgICAgICAgICAic2VsZWN0IGUgZnJvbSAiICsKICAgICAg\nICAgICAgICAgICIgRW50aXR5QV9Db2xsX1N0cmluZyBhICIgKwogICAgICAg\nICAgICAgICAgIiAsIGluIChhLm5pY2tOYW1lcykgZSBvcmRlciBieSBlIiwK\nICAgICAgICAgICAgInNlbGVjdCBhIGZyb20gIiArCiAgICAgICAgICAgICAg\nICAiIEVudGl0eUFfQ29sbF9TdHJpbmcgYSAiICsKICAgICAgICAgICAgICAg\nICIgV0hFUkUgYS5uaWNrTmFtZXMgSVMgRU1QVFkgb3JkZXIgYnkgYSIsCiAg\nICAgICAgICAgICJzZWxlY3QgYSBmcm9tICIgKwogICAgICAgICAgICAgICAg\nIiBFbnRpdHlBX0NvbGxfU3RyaW5nIGEgIiArCiAgICAgICAgICAgICAgICAi\nIFdIRVJFIGV4aXN0cyAoc2VsZWN0IG4gZnJvbSBFbnRpdHlBX0NvbGxfU3Ry\naW5nIGEsICIgKwogICAgICAgICAgICAgICAgIiBpbiAoYS5uaWNrTmFtZXMp\nIG4gd2hlcmUgbiBsaWtlICclMScpICIgKwogICAgICAgICAgICAgICAgIiBv\ncmRlciBieSBhIiwKICAgICAgICB9OwogICAgICAgIExpc3QgcnMgPSBudWxs\nOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgcXVlcnkubGVuZ3RoOyBp\nKyspIHsKICAgICAgICAgICAgcnMgPSBlbS5jcmVhdGVRdWVyeShxdWVyeVtp\nXSkuZ2V0UmVzdWx0TGlzdCgpOwogICAgICAgICAgICBzd2l0Y2ggKGkpIHsK\nICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICBjYXNlIDE6CiAgICAg\nICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgIGFzc2VydFRydWUocnMu\nc2l6ZSgpID4gMCk7CiAgICAgICAgICAgICAgICBPYmplY3Qgb2JqID0gcnMu\nZ2V0KDApOwogICAgICAgICAgICAgICAgYXNzZXJ0VHJ1ZShvYmogaW5zdGFu\nY2VvZiBTdHJpbmcpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAg\nICAgIGNhc2UgMzoKICAgICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICAg\nICAgYXNzZXJ0VHJ1ZShycy5zaXplKCkgPT0gMCk7CiAgICAgICAgICAgIH0K\nICAgICAgICAgICAgZW0uY2xlYXIoKTsKICAgICAgICB9CiAgICAgICAgRW50\naXR5VHJhbnNhY3Rpb24gdHJhbiA9IGVtLmdldFRyYW5zYWN0aW9uKCk7CiAg\nICAgICAgdHJhbi5iZWdpbigpOwogICAgICAgIFF1ZXJ5IHEgPSBlbS5jcmVh\ndGVRdWVyeSgic2VsZWN0IGEgZnJvbSBFbnRpdHlBX0NvbGxfU3RyaW5nIGEi\nKTsKICAgICAgICBMaXN0PEVudGl0eUFfQ29sbF9TdHJpbmc+IGFzID0gcS5n\nZXRSZXN1bHRMaXN0KCk7CiAgICAgICAgZm9yIChFbnRpdHlBX0NvbGxfU3Ry\naW5nIGEgOiBhcykgewogICAgICAgICAgICBjaGVja0VudGl0eUFfQ29sbF9T\ndHJpbmcoYSk7CiAgICAgICAgfQogICAgICAgIHRyYW4uY29tbWl0KCk7CiAg\nICAgICAgZW0uY2xvc2UoKTsKICAgIH0KCiAgICAvKgogICAgICogUXVlcnkg\nRW50aXR5QV9FbWJlZF9Ub09uZQogICAgICovCiAgICBwdWJsaWMgdm9pZCBx\ndWVyeUVudGl0eUFfRW1iZWRfVG9PbmUoKSB7CiAgICAgICAgRW50aXR5TWFu\nYWdlciBlbSA9IGVtZi5jcmVhdGVFbnRpdHlNYW5hZ2VyKCk7CiAgICAgICAg\nLy8gdGVzdCBzZWxlY3QgZW1iZWQgb2JqZWN0CiAgICAgICAgU3RyaW5nW10g\ncXVlcnkgPSB7CiAgICAgICAgICAgICJzZWxlY3QgYS5lbWJlZCBmcm9tICIg\nKwogICAgICAgICAgICAgICAgIiBFbnRpdHlBX0VtYmVkX1RvT25lIGEgIiwK\nICAgICAgICAgICAgInNlbGVjdCBhLmVtYmVkIGZyb20gIiArCiAgICAgICAg\nICAgICAgICAiIEVudGl0eUFfRW1iZWRfVG9PbmUgYSAiLAogICAgICAgICAg\nICAic2VsZWN0IGUgZnJvbSBFbnRpdHlBX0VtYmVkX1RvT25lIGEgIiArCiAg\nICAgICAgICAgICAgICAiIGpvaW4gYS5lbWJlZCBlIGpvaW4gZS5iIGIgd2hl\ncmUgZS5iLmlkID4gMCBvcmRlciBieSBhLmlkIiwKICAgICAgICAgICAgInNl\nbGVjdCBlIGZyb20gRW50aXR5QV9FbWJlZF9Ub09uZSBhICIgKwogICAgICAg\nICAgICAgICAgIiBqb2luIGEuZW1iZWQgZSBqb2luIGUuYiBiIHdoZXJlIGUu\nYi5pZCA+IDAgb3JkZXIgYnkgYS5pZCIsCiAgICAgICAgICAgICJzZWxlY3Qg\nYS5lbWJlZCBmcm9tICIgKwogICAgICAgICAgICAgICAgIiBFbnRpdHlBX0Vt\nYmVkX1RvT25lIGEgT1JERVIgQlkgYS5lbWJlZCIsCiAgICAgICAgICAgICJz\nZWxlY3QgYS5lbWJlZCBmcm9tICIgKwogICAgICAgICAgICAgICAgIiBFbnRp\ndHlBX0VtYmVkX1RvT25lIGEgV0hFUkUgYS5lbWJlZC5iIElTIE5PVCBOVUxM\nICIgKwogICAgICAgICAgICAgICAgIiBPUkRFUiBCWSBhLmVtYmVkIiwKICAg\nICAgICAgICAgInNlbGVjdCBhLmVtYmVkIGZyb20gIiArCiAgICAgICAgICAg\nICAgICAiIEVudGl0eUFfRW1iZWRfVG9PbmUgYSBXSEVSRSBleGlzdHMgIiAr\nCiAgICAgICAgICAgICAgICAiIChzZWxlY3QgYSBmcm9tIEVudGl0eUFfRW1i\nZWRfVG9PbmUgYSAiICsKICAgICAgICAgICAgICAgICIgd2hlcmUgYS5lbWJl\nZC5iIElTIE5PVCBOVUxMKSAiICsKICAgICAgICAgICAgICAgICIgT1JERVIg\nQlkgYS5lbWJlZCIsCiAgICAgICAgfTsKICAgICAgICBmb3IgKGludCBpID0g\nMDsgaSA8IHF1ZXJ5Lmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIExpc3Q8\nT2JqZWN0W10+IHJzID0gbnVsbDsKICAgICAgICAgICAgcnMgPSBlbS5jcmVh\ndGVRdWVyeShxdWVyeVtpXSkuZ2V0UmVzdWx0TGlzdCgpOwogICAgICAgICAg\nICBhc3NlcnRUcnVlKHJzLnNpemUoKSA+IDApOwogICAgICAgICAgICBPYmpl\nY3Qgb2JqID0gcnMuZ2V0KDApOwogICAgICAgICAgICBhc3NlcnRUcnVlKG9i\naiBpbnN0YW5jZW9mIEVtYmVkX1RvT25lKTsKICAgICAgICAgICAgYXNzZXJ0\nVHJ1ZSgoKEVtYmVkX1RvT25lKSBvYmopLmdldEVudGl0eUIoKSAhPSBudWxs\nKTsKICAgICAgICAgICAgZW0uY2xlYXIoKTsKICAgICAgICB9CiAgICAgICAg\nRW50aXR5VHJhbnNhY3Rpb24gdHJhbiA9IGVtLmdldFRyYW5zYWN0aW9uKCk7\nCiAgICAgICAgdHJhbi5iZWdpbigpOwogICAgICAgIFF1ZXJ5IHEgPSBlbS5j\ncmVhdGVRdWVyeSgic2VsZWN0IGEgZnJvbSBFbnRpdHlBX0VtYmVkX1RvT25l\nIGEiKTsKICAgICAgICBMaXN0PEVudGl0eUFfRW1iZWRfVG9PbmU+IGFzID0g\ncS5nZXRSZXN1bHRMaXN0KCk7CiAgICAgICAgZm9yIChFbnRpdHlBX0VtYmVk\nX1RvT25lIGEgOiBhcykgewogICAgICAgICAgICBjaGVja0VudGl0eUFfRW1i\nZWRfVG9PbmUoYSk7CiAgICAgICAgfQogICAgICAgIHRyYW4uY29tbWl0KCk7\nCiAgICAgICAgZW0uY2xvc2UoKTsKICAgIH0KCiAgICAvKgogICAgICogUXVl\ncnkgRW50aXR5QV9FbWJlZF9NYXBwZWRUb09uZQogICAgICovCiAgICBwdWJs\naWMgdm9pZCBxdWVyeUVudGl0eUFfRW1iZWRfTWFwcGVkVG9PbmUoKSB7CiAg\nICAgICAgRW50aXR5TWFuYWdlciBlbSA9IGVtZi5jcmVhdGVFbnRpdHlNYW5h\nZ2VyKCk7CiAgICAgICAgLy8gdGVzdCBzZWxlY3QgZW1iZWQgb2JqZWN0CiAg\nICAgICAgU3RyaW5nW10gcXVlcnkgPSB7CiAgICAgICAgICAgICJzZWxlY3Qg\nYS5lbWJlZCBmcm9tICIgKwogICAgICAgICAgICAgICAgIiBFbnRpdHlBX0Vt\nYmVkX01hcHBlZFRvT25lIGEgIiwKICAgICAgICAgICAgInNlbGVjdCBlIGZy\nb20gRW50aXR5QV9FbWJlZF9NYXBwZWRUb09uZSBhICIgKwogICAgICAgICAg\nICAgICAgIiBqb2luIGEuZW1iZWQgZSBqb2luIGUuYm0gYm0gd2hlcmUgZS5i\nbS5pZCA+IDAgb3JkZXIgYnkgYS5pZCIsCiAgICAgICAgICAgICJzZWxlY3Qg\nYS5lbWJlZCBhcyBlIGZyb20gIiArCiAgICAgICAgICAgICAgICAiIEVudGl0\neUFfRW1iZWRfTWFwcGVkVG9PbmUgYSBPUkRFUiBCWSBlIiwKICAgICAgICAg\nICAgInNlbGVjdCBhLmVtYmVkIGZyb20gIiArCiAgICAgICAgICAgICAgICAi\nIEVudGl0eUFfRW1iZWRfTWFwcGVkVG9PbmUgYSBXSEVSRSBhLmVtYmVkLmJt\nIElTIE5PVCBOVUxMIiwKICAgICAgICAgICAgInNlbGVjdCBhLmVtYmVkIGZy\nb20gIiArCiAgICAgICAgICAgICAgICAiIEVudGl0eUFfRW1iZWRfTWFwcGVk\nVG9PbmUgYSAiICsKICAgICAgICAgICAgICAgICIgV0hFUkUgZXhpc3RzICIg\nKwogICAgICAgICAgICAgICAgIiAoc2VsZWN0IGEgZnJvbSBFbnRpdHlBX0Vt\nYmVkX01hcHBlZFRvT25lIGEgIiArCiAgICAgICAgICAgICAgICAiIHdoZXJl\nIGEuZW1iZWQuYm0gSVMgTk9UIE5VTEwpIiwKICAgICAgICB9OwogICAgICAg\nIGZvciAoaW50IGkgPSAwOyBpIDwgcXVlcnkubGVuZ3RoOyBpKyspIHsKICAg\nICAgICAgICAgTGlzdDxPYmplY3RbXT4gcnMgPSBudWxsOwogICAgICAgICAg\nICBycyA9IGVtLmNyZWF0ZVF1ZXJ5KHF1ZXJ5W2ldKS5nZXRSZXN1bHRMaXN0\nKCk7CiAgICAgICAgICAgIGFzc2VydFRydWUocnMuc2l6ZSgpID4gMCk7CiAg\nICAgICAgICAgIE9iamVjdCBvYmogPSBycy5nZXQoMCk7CiAgICAgICAgICAg\nIGFzc2VydFRydWUob2JqIGluc3RhbmNlb2YgRW1iZWRfTWFwcGVkVG9PbmUp\nOwogICAgICAgICAgICBhc3NlcnRUcnVlKCgoRW1iZWRfTWFwcGVkVG9PbmUp\nIG9iaikuZ2V0TWFwcGVkRW50aXR5QigpICE9IG51bGwpOwogICAgICAgICAg\nICBlbS5jbGVhcigpOwogICAgICAgIH0KICAgICAgICBTdHJpbmdbXSBxdWVy\neTIgPSB7CiAgICAgICAgICAgIC8vIGVtYmVkZGFibGUgaW4gY29uZGl0aW9u\nYWwgZXhwcmVzc2lvbiBzaG91bGQgZmFpbAogICAgICAgICAgICAic2VsZWN0\nIGEuZW1iZWQgZnJvbSAiICsKICAgICAgICAgICAgICAgICIgRW50aXR5QV9F\nbWJlZF9NYXBwZWRUb09uZSBhICIgKwogICAgICAgICAgICAgICAgIiBXSEVS\nRSBleGlzdHMgIiArCiAgICAgICAgICAgICAgICAiIChzZWxlY3QgZSBmcm9t\nIEVudGl0eUFfRW1iZWRfTWFwcGVkVG9PbmUgYSIgKwogICAgICAgICAgICAg\nICAgIiBqb2luIGEuZW1iZWQgZSAiICsKICAgICAgICAgICAgICAgICIgd2hl\ncmUgZS5ibSBJUyBOT1QgTlVMTCkiLAogICAgICAgICAgICAic2VsZWN0IGEu\nZW1iZWQgZnJvbSAiICsKICAgICAgICAgICAgICAgICIgRW50aXR5QV9FbWJl\nZF9NYXBwZWRUb09uZSBhICIgKwogICAgICAgICAgICAgICAgIiBXSEVSRSBl\neGlzdHMgIiArCiAgICAgICAgICAgICAgICAiIChzZWxlY3QgYS5lbWJlZCBm\ncm9tIEVudGl0eUFfRW1iZWRfTWFwcGVkVG9PbmUgYSAiICsKICAgICAgICAg\nICAgICAgICIgd2hlcmUgYS5lbWJlZC5ibSBJUyBOT1QgTlVMTCkiLAogICAg\nICAgIH07CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBxdWVyeTIubGVu\nZ3RoOyBpKyspIHsKICAgICAgICAgICAgTGlzdDxPYmplY3RbXT4gcnMgPSBu\ndWxsOwogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgcnMgPSBl\nbS5jcmVhdGVRdWVyeShxdWVyeTJbaV0pLmdldFJlc3VsdExpc3QoKTsKICAg\nICAgICAgICAgfSBjYXRjaCAoQXJndW1lbnRFeGNlcHRpb24gZSkgewogICAg\nICAgICAgICAgICAgLy8gYXMgZXhwZWN0ZWQKICAgICAgICAgICAgfQogICAg\nICAgIH0KCiAgICAgICAgRW50aXR5VHJhbnNhY3Rpb24gdHJhbiA9IGVtLmdl\ndFRyYW5zYWN0aW9uKCk7CiAgICAgICAgdHJhbi5iZWdpbigpOwogICAgICAg\nIFF1ZXJ5IHEgPSBlbS5jcmVhdGVRdWVyeSgic2VsZWN0IGEgZnJvbSBFbnRp\ndHlBX0VtYmVkX01hcHBlZFRvT25lIGEiKTsKICAgICAgICBMaXN0PEVudGl0\neUFfRW1iZWRfTWFwcGVkVG9PbmU+IGFzID0gcS5nZXRSZXN1bHRMaXN0KCk7\nCiAgICAgICAgZm9yIChFbnRpdHlBX0VtYmVkX01hcHBlZFRvT25lIGEgOiBh\ncykgewogICAgICAgICAgICBjaGVja0VudGl0eUFfRW1iZWRfTWFwcGVkVG9P\nbmUoYSk7CiAgICAgICAgfQogICAgICAgIHRyYW4uY29tbWl0KCk7CiAgICAg\nICAgZW0uY2xvc2UoKTsKICAgIH0KCiAgICAvKgogICAgICogUXVlcnkgRW50\naXR5QV9Db2xsX0VtYmVkX1RvT25lCiAgICAgKi8KICAgIHB1YmxpYyB2b2lk\nIHF1ZXJ5RW50aXR5QV9Db2xsX0VtYmVkX1RvT25lKCkgewogICAgICAgIEVu\ndGl0eU1hbmFnZXIgZW0gPSBlbWYuY3JlYXRlRW50aXR5TWFuYWdlcigpOwog\nICAgICAgIC8vIHRlc3Qgc2VsZWN0IGVtYmVkIG9iamVjdCBmcm9tIGVsZW1l\nbnQgY29sbGVjdGlvbgogICAgICAgIFN0cmluZ1tdIHF1ZXJ5ID0gewogICAg\nICAgICAgICAic2VsZWN0IGUsIGUuYiBmcm9tICIgKwogICAgICAgICAgICAg\nICAgIiBFbnRpdHlBX0NvbGxfRW1iZWRfVG9PbmUgYSAiICsKICAgICAgICAg\nICAgICAgICIgLCBpbiAoYS5lbWJlZDFzKSBlIG9yZGVyIGJ5IGUubmFtZTEi\nLAogICAgICAgICAgICAic2VsZWN0IGUsIGEuaWQgZnJvbSBFbnRpdHlBX0Nv\nbGxfRW1iZWRfVG9PbmUgYSAiICsKICAgICAgICAgICAgICAgICIgLCBpbiAo\nYS5lbWJlZDFzKSBlIHdoZXJlIGUuYi5pZCA+IDAgb3JkZXIgYnkgYS5pZCIs\nCiAgICAgICAgICAgICJzZWxlY3QgZSwgZS5iLmlkICBmcm9tICIgKwogICAg\nICAgICAgICAgICAgIiBFbnRpdHlBX0NvbGxfRW1iZWRfVG9PbmUgYSAiICsK\nICAgICAgICAgICAgICAgICIgLCBpbiAoYS5lbWJlZDFzKSBlIHdoZXJlIGUu\nbmFtZTEgbGlrZSAnJTEnIiArCiAgICAgICAgICAgICAgICAiIG9yZGVyIGJ5\nIGUubmFtZTMiLAogICAgICAgICAgICAic2VsZWN0IGUsIGUuYi5pZCAgZnJv\nbSAiICsKICAgICAgICAgICAgICAgICIgRW50aXR5QV9Db2xsX0VtYmVkX1Rv\nT25lIGEgIiArCiAgICAgICAgICAgICAgICAiICwgaW4gKGEuZW1iZWQxcykg\nZSB3aGVyZSBlLm5hbWUxIGxpa2UgJyUxJyIgKwogICAgICAgICAgICAgICAg\nIiBvcmRlciBieSBlIiwKICAgICAgICAgICAgInNlbGVjdCBlLCBlLmIuaWQg\nIGZyb20gIiArCiAgICAgICAgICAgICAgICAiIEVudGl0eUFfQ29sbF9FbWJl\nZF9Ub09uZSBhICIgKwogICAgICAgICAgICAgICAgIiAsIGluIChhLmVtYmVk\nMXMpIGUgd2hlcmUgZS5uYW1lMSBsaWtlICclMScgYW5kIiArCiAgICAgICAg\nICAgICAgICAiIGEuZW1iZWQxcyBJUyBOT1QgRU1QVFkgYW5kICIgKwogICAg\nICAgICAgICAgICAgIiBlLmIgSVMgTk9UIE5VTEwgIiArCiAgICAgICAgICAg\nICAgICAiIG9yZGVyIGJ5IGUiLAogICAgICAgICAgICAvLyB0aGUgZm9sbG93\naW5nIHF1ZXJ5IHdvcmtzIGluIERCMiBidXQgbm90IGluIERlcmJ5OgogICAg\nICAgICAgICAvLyBiZWNhdXNlIERlcmJ5IHN1YnF1ZXJ5IGlzIG9ubHkgYWxs\nb3dlZCB0byAKICAgICAgICAgICAgLy8gcmV0dXJuIGEgc2luZ2xlIGNvbHVt\nbi4gCiAgICAgICAgICAgIC8qCiAgICAgICAgICAgICJzZWxlY3QgZSwgZS5i\nLmlkICBmcm9tICIgKwogICAgICAgICAgICAgICAgIiBFbnRpdHlBX0NvbGxf\nRW1iZWRfVG9PbmUgYSAiICsKICAgICAgICAgICAgICAgICIgLCBpbiAoYS5l\nbWJlZDFzKSBlIHdoZXJlICIgKwogICAgICAgICAgICAgICAgIiBleGlzdHMg\nKHNlbGVjdCBhLmVtYmVkMXMgZnJvbSAiICsKICAgICAgICAgICAgICAgICIg\nRW50aXR5QV9Db2xsX0VtYmVkX1RvT25lIGEpIGFuZCAiICsKICAgICAgICAg\nICAgICAgICIgZXhpc3RzIChzZWxlY3QgZS5iIGZyb20gYS5lbWJlZDFzIGUp\nICIgKwogICAgICAgICAgICAgICAgIiBvcmRlciBieSBlIiwKICAgICAgICAg\nICAgKi8KICAgICAgICB9OwogICAgICAgIExpc3Q8T2JqZWN0W10+IHJzID0g\nbnVsbDsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IHF1ZXJ5Lmxlbmd0\naDsgaSsrKSB7CiAgICAgICAgICAgIHJzID0gZW0uY3JlYXRlUXVlcnkocXVl\ncnlbaV0pLmdldFJlc3VsdExpc3QoKTsKICAgICAgICAgICAgYXNzZXJ0VHJ1\nZShycy5zaXplKCkgPiAwKTsKICAgICAgICAgICAgT2JqZWN0IG9iaiA9ICgo\nT2JqZWN0W10pIHJzLmdldCgwKSlbMF07CiAgICAgICAgICAgIGFzc2VydFRy\ndWUob2JqIGluc3RhbmNlb2YgRW1iZWRfVG9PbmUpOwogICAgICAgICAgICBh\nc3NlcnRUcnVlKCgoRW1iZWRfVG9PbmUpIG9iaikuZ2V0RW50aXR5QigpICE9\nIG51bGwpOwogICAgICAgICAgICBzd2l0Y2ggKGkpIHsKICAgICAgICAgICAg\nY2FzZSAwOgogICAgICAgICAgICAgICAgT2JqZWN0IGIgPSAoKE9iamVjdFtd\nKSBycy5nZXQoMCkpWzFdOwogICAgICAgICAgICAgICAgYXNzZXJ0VHJ1ZShi\nIGluc3RhbmNlb2YgRW50aXR5QjEpOwogICAgICAgICAgICAgICAgYXNzZXJ0\nRXF1YWxzKCgoRW50aXR5QjEpIGIpLmdldElkKCksCiAgICAgICAgICAgICAg\nICAgICAgKChFbWJlZF9Ub09uZSkgb2JqKS5nZXRFbnRpdHlCKCkuZ2V0SWQo\nKSk7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAg\nICAgICAgICBlbS5jbGVhcigpOwogICAgICAgIH0KICAgICAgICBFbnRpdHlU\ncmFuc2FjdGlvbiB0cmFuID0gZW0uZ2V0VHJhbnNhY3Rpb24oKTsKICAgICAg\nICB0cmFuLmJlZ2luKCk7CiAgICAgICAgUXVlcnkgcSA9IGVtLmNyZWF0ZVF1\nZXJ5KCJzZWxlY3QgYSBmcm9tIEVudGl0eUFfQ29sbF9FbWJlZF9Ub09uZSBh\nIik7CiAgICAgICAgTGlzdDxFbnRpdHlBX0NvbGxfRW1iZWRfVG9PbmU+IGFz\nID0gcS5nZXRSZXN1bHRMaXN0KCk7CiAgICAgICAgZm9yIChFbnRpdHlBX0Nv\nbGxfRW1iZWRfVG9PbmUgYSA6IGFzKSB7CiAgICAgICAgICAgIGNoZWNrRW50\naXR5QV9Db2xsX0VtYmVkX1RvT25lKGEpOwogICAgICAgIH0KICAgICAgICB0\ncmFuLmNvbW1pdCgpOwogICAgICAgIGVtLmNsb3NlKCk7CiAgICB9CgogICAg\nLyoKICAgICAqIFF1ZXJ5IEVudGl0eUFfRW1iZWRfVG9NYW55CiAgICAgKi8K\nICAgIHB1YmxpYyB2b2lkIHF1ZXJ5RW50aXR5QV9FbWJlZF9Ub01hbnkoKSB7\nCiAgICAgICAgRW50aXR5TWFuYWdlciBlbSA9IGVtZi5jcmVhdGVFbnRpdHlN\nYW5hZ2VyKCk7CiAgICAgICAgLy8gdGVzdCBzZWxlY3QgZW1iZWRkYWJsZQog\nICAgICAgIFN0cmluZyBxdWVyeVtdID0gewogICAgICAgICAgICAic2VsZWN0\nIGEuZW1iZWQgZnJvbSBFbnRpdHlBX0VtYmVkX1RvTWFueSBhIiwKICAgICAg\nICAgICAgInNlbGVjdCBlIGZyb20gRW50aXR5QV9FbWJlZF9Ub01hbnkgYSBq\nb2luIGEuZW1iZWQgZSIsCiAgICAgICAgICAgICJzZWxlY3QgYiBmcm9tIEVu\ndGl0eUFfRW1iZWRfVG9NYW55IGEgam9pbiBhLmVtYmVkLmJzIiArCiAgICAg\nICAgICAgICAgICAiIGIiLAogICAgICAgICAgICAic2VsZWN0IGUgZnJvbSBF\nbnRpdHlBX0VtYmVkX1RvTWFueSBhIGpvaW4gYS5lbWJlZCBlICIgKwogICAg\nICAgICAgICAgICAgIiB3aGVyZSBlLm5hbWUxIGxpa2UgJyUxJyIsCiAgICAg\nICAgICAgICJzZWxlY3QgYS5lbWJlZCBmcm9tIEVudGl0eUFfRW1iZWRfVG9N\nYW55IGEgT1JERVIgQlkgYS5lbWJlZCIsCiAgICAgICAgICAgICJzZWxlY3Qg\nZSBmcm9tIEVudGl0eUFfRW1iZWRfVG9NYW55IGEgam9pbiBhLmVtYmVkIGUg\nT1JERVIgQlkgZSIsCiAgICAgICAgICAgICJzZWxlY3QgYiBmcm9tIEVudGl0\neUFfRW1iZWRfVG9NYW55IGEgam9pbiBhLmVtYmVkLmJzIiArCiAgICAgICAg\nICAgICAgICAiIGIgT1JERVIgQlkgYiIsCiAgICAgICAgICAgICJzZWxlY3Qg\nZSBmcm9tIEVudGl0eUFfRW1iZWRfVG9NYW55IGEgam9pbiBhLmVtYmVkIGUg\nIiArCiAgICAgICAgICAgICAgICAiIFdIRVJFIGUuYnMgSVMgTk9UIEVNUFRZ\nIE9SREVSIEJZIGUiLAogICAgICAgICAgICAic2VsZWN0IGEgZnJvbSBFbnRp\ndHlBX0VtYmVkX1RvTWFueSBhICIgKwogICAgICAgICAgICAgICAgIiBXSEVS\nRSBleGlzdHMgKHNlbGVjdCBhIGZyb20gRW50aXR5QV9FbWJlZF9Ub01hbnkg\nYSIgKwogICAgICAgICAgICAgICAgIiB3aGVyZSBhLmVtYmVkLmJzIElTIE5P\nVCBFTVBUWSkgT1JERVIgQlkgYSIsCiAgICAgICAgICAgICJzZWxlY3QgYSBm\ncm9tIEVudGl0eUFfRW1iZWRfVG9NYW55IGEgIiArCiAgICAgICAgICAgICAg\nICAiIFdIRVJFIGV4aXN0cyAoc2VsZWN0IGEgZnJvbSBFbnRpdHlBX0VtYmVk\nX1RvTWFueSBhIiArCiAgICAgICAgICAgICAgICAiIHdoZXJlIGEuZW1iZWQu\nYnMgSVMgTk9UIEVNUFRZKSBPUkRFUiBCWSBhIiwKICAgICAgICAgICAgfTsK\nICAgICAgICBMaXN0IHJzID0gbnVsbDsKICAgICAgICBmb3IgKGludCBpID0g\nMDsgaSA8IHF1ZXJ5Lmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIHJzID0g\nZW0uY3JlYXRlUXVlcnkocXVlcnlbaV0pLmdldFJlc3VsdExpc3QoKTsKICAg\nICAgICAgICAgYXNzZXJ0VHJ1ZShycy5zaXplKCkgPiAwKTsKICAgICAgICAg\nICAgT2JqZWN0IG9iaiA9IHJzLmdldCgwKTsKICAgICAgICAgICAgc3dpdGNo\nIChpKSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgY2FzZSAx\nOgogICAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgIGNhc2UgNToKICAg\nICAgICAgICAgY2FzZSA3OgogICAgICAgICAgICAgICAgYXNzZXJ0VHJ1ZShv\nYmogaW5zdGFuY2VvZiBFbWJlZF9Ub01hbnkpOwogICAgICAgICAgICAgICAg\nYXNzZXJ0VHJ1ZSgoKEVtYmVkX1RvTWFueSkgb2JqKS5nZXRFbnRpdHlCcygp\nLnNpemUoKSA+IDApOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAg\nICAgIGNhc2UgMjoKICAgICAgICAgICAgY2FzZSA2OgogICAgICAgICAgICAg\nICAgYXNzZXJ0VHJ1ZShvYmogaW5zdGFuY2VvZiBFbnRpdHlCMSk7CiAgICAg\nICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSA4OgogICAgICAg\nICAgICBjYXNlIDk6CiAgICAgICAgICAgICAgICBhc3NlcnRUcnVlKG9iaiBp\nbnN0YW5jZW9mIEVudGl0eUFfRW1iZWRfVG9NYW55KTsKICAgICAgICAgICAg\nICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVtLmNsZWFy\nKCk7CiAgICAgICAgfQogICAgICAgIEVudGl0eVRyYW5zYWN0aW9uIHRyYW4g\nPSBlbS5nZXRUcmFuc2FjdGlvbigpOwogICAgICAgIHRyYW4uYmVnaW4oKTsK\nICAgICAgICBRdWVyeSBxID0gZW0uY3JlYXRlUXVlcnkoInNlbGVjdCBhIGZy\nb20gRW50aXR5QV9FbWJlZF9Ub01hbnkgYSIpOwogICAgICAgIExpc3Q8RW50\naXR5QV9FbWJlZF9Ub01hbnk+IGFzID0gcS5nZXRSZXN1bHRMaXN0KCk7CiAg\nICAgICAgZm9yIChFbnRpdHlBX0VtYmVkX1RvTWFueSBhIDogYXMpIHsKICAg\nICAgICAgICAgY2hlY2tFbnRpdHlBX0VtYmVkX1RvTWFueShhKTsKICAgICAg\nICB9CiAgICAgICAgdHJhbi5jb21taXQoKTsKICAgICAgICBlbS5jbG9zZSgp\nOwogICAgfQoKICAgIC8qCiAgICAgKiBRdWVyeSBFbnRpdHlBX0VtYmVkX0Vt\nYmVkX1RvTWFueQogICAgICovCiAgICBwdWJsaWMgdm9pZCBxdWVyeUVudGl0\neUFfRW1iZWRfRW1iZWRfVG9NYW55KCkgewogICAgICAgIEVudGl0eU1hbmFn\nZXIgZW0gPSBlbWYuY3JlYXRlRW50aXR5TWFuYWdlcigpOwogICAgICAgIC8v\nIHRlc3Qgc2VsZWN0IGVtYmVkZGFibGUKICAgICAgICBTdHJpbmcgcXVlcnlb\nXSA9IHsKICAgICAgICAgICAgInNlbGVjdCBhLmVtYmVkIGZyb20gRW50aXR5\nQV9FbWJlZF9FbWJlZF9Ub01hbnkgYSIsCiAgICAgICAgICAgICJzZWxlY3Qg\nYS5lbWJlZCBmcm9tIEVudGl0eUFfRW1iZWRfRW1iZWRfVG9NYW55IGEiICsK\nICAgICAgICAgICAgICAgICIgd2hlcmUgYS5lbWJlZC5lbWJlZC5uYW1lMSBs\naWtlICclMScgIiwKICAgICAgICAgICAgInNlbGVjdCBhLmVtYmVkLmVtYmVk\nIGZyb20gRW50aXR5QV9FbWJlZF9FbWJlZF9Ub01hbnkgYSIsCiAgICAgICAg\nICAgICJzZWxlY3QgYiBmcm9tIEVudGl0eUFfRW1iZWRfRW1iZWRfVG9NYW55\nIGEgam9pbiBhLmVtYmVkLmVtYmVkLmJzIiArCiAgICAgICAgICAgICAgICAi\nIGIiLAogICAgICAgICAgICAic2VsZWN0IGEuZW1iZWQuZW1iZWQgZnJvbSBF\nbnRpdHlBX0VtYmVkX0VtYmVkX1RvTWFueSBhICIgKwogICAgICAgICAgICAg\nICAgIiB3aGVyZSBhLmVtYmVkLmVtYmVkLm5hbWUxIGxpa2UgJyUxJyIsCiAg\nICAgICAgICAgICJzZWxlY3QgZTIgZnJvbSBFbnRpdHlBX0VtYmVkX0VtYmVk\nX1RvTWFueSBhICIgKwogICAgICAgICAgICAgICAgIiBsZWZ0IGpvaW4gYS5l\nbWJlZCBlMSBsZWZ0IGpvaW4gZTEuZW1iZWQgZTIiLAogICAgICAgICAgICAi\nc2VsZWN0IGUyIGZyb20gRW50aXR5QV9FbWJlZF9FbWJlZF9Ub01hbnkgYSAi\nICsKICAgICAgICAgICAgICAgICIgam9pbiBhLmVtYmVkIGUxIGpvaW4gZTEu\nZW1iZWQgZTIiLAogICAgICAgICAgICAic2VsZWN0IGEuZW1iZWQgYXMgZSBm\ncm9tIEVudGl0eUFfRW1iZWRfRW1iZWRfVG9NYW55IGEgT1JERVIgQlkgZSIs\nCiAgICAgICAgICAgICJzZWxlY3QgYS5lbWJlZC5lbWJlZCBhcyBlIGZyb20g\nRW50aXR5QV9FbWJlZF9FbWJlZF9Ub01hbnkgYSAiICsKICAgICAgICAgICAg\nICAgICIgd2hlcmUgYS5lbWJlZC5lbWJlZC5uYW1lMSBsaWtlICclMScgT1JE\nRVIgQlkgZSIsCiAgICAgICAgICAgICJzZWxlY3QgYS5lbWJlZCBmcm9tIEVu\ndGl0eUFfRW1iZWRfRW1iZWRfVG9NYW55IGEgIiArCiAgICAgICAgICAgICAg\nICAiIHdoZXJlIGEuZW1iZWQuZW1iZWQuYnMgSVMgTk9UIEVNUFRZIiwKICAg\nICAgICAgICAgInNlbGVjdCBhLmVtYmVkIGZyb20gRW50aXR5QV9FbWJlZF9F\nbWJlZF9Ub01hbnkgYSAiICsKICAgICAgICAgICAgICAgICIgd2hlcmUgZXhp\nc3RzIChzZWxlY3QgYS5lbWJlZC5lbWJlZC5icyBmcm9tICIgKwogICAgICAg\nICAgICAgICAgIiBFbnRpdHlBX0VtYmVkX0VtYmVkX1RvTWFueSBhKSIsCiAg\nICAgICAgICAgICJzZWxlY3QgYiBmcm9tIEVudGl0eUFfRW1iZWRfRW1iZWRf\nVG9NYW55IGEgam9pbiBhLmVtYmVkLmVtYmVkLmJzIiArCiAgICAgICAgICAg\nICAgICAiIGIiLAogICAgICAgIH07CiAgICAgICAgTGlzdCBycyA9IG51bGw7\nCiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBxdWVyeS5sZW5ndGg7IGkr\nKykgewogICAgICAgICAgICBycyA9IGVtLmNyZWF0ZVF1ZXJ5KHF1ZXJ5W2ld\nKS5nZXRSZXN1bHRMaXN0KCk7CiAgICAgICAgICAgIGFzc2VydFRydWUocnMu\nc2l6ZSgpID4gMCk7CiAgICAgICAgICAgIE9iamVjdCBvYmogPSBycy5nZXQo\nMCk7CiAgICAgICAgICAgIHN3aXRjaCAoaSkgewogICAgICAgICAgICBjYXNl\nIDA6CiAgICAgICAgICAgIGNhc2UgMToKICAgICAgICAgICAgY2FzZSA3Ogog\nICAgICAgICAgICBjYXNlIDk6CiAgICAgICAgICAgIGNhc2UgMTA6CiAgICAg\nICAgICAgICAgICBhc3NlcnRUcnVlKG9iaiBpbnN0YW5jZW9mIEVtYmVkX0Vt\nYmVkX1RvTWFueSk7CiAgICAgICAgICAgICAgICBhc3NlcnRUcnVlKCgoRW1i\nZWRfRW1iZWRfVG9NYW55KSBvYmopLmdldEVtYmVkKCkuZ2V0RW50aXR5QnMo\nKS4KICAgICAgICAgICAgICAgICAgICBzaXplKCkgPiAwKTsKICAgICAgICAg\nICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAg\nIGNhc2UgNDoKICAgICAgICAgICAgY2FzZSA1OgogICAgICAgICAgICBjYXNl\nIDY6CiAgICAgICAgICAgIGNhc2UgODoKICAgICAgICAgICAgICAgIGFzc2Vy\ndFRydWUob2JqIGluc3RhbmNlb2YgRW1iZWRfVG9NYW55KTsKICAgICAgICAg\nICAgICAgIGFzc2VydFRydWUoKChFbWJlZF9Ub01hbnkpIG9iaikuZ2V0RW50\naXR5QnMoKS5zaXplKCkgPiAwKTsKICAgICAgICAgICAgICAgIGJyZWFrOwog\nICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgIGNhc2UgMTE6CiAgICAg\nICAgICAgICAgICBhc3NlcnRUcnVlKG9iaiBpbnN0YW5jZW9mIEVudGl0eUIx\nKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9ICAgICAg\nICAKICAgICAgICAgICAgZW0uY2xlYXIoKTsKICAgICAgICB9CiAgICAgICAg\nRW50aXR5VHJhbnNhY3Rpb24gdHJhbiA9IGVtLmdldFRyYW5zYWN0aW9uKCk7\nCiAgICAgICAgdHJhbi5iZWdpbigpOwogICAgICAgIFF1ZXJ5IHEgPSBlbS5j\ncmVhdGVRdWVyeSgic2VsZWN0IGEgZnJvbSBFbnRpdHlBX0VtYmVkX0VtYmVk\nX1RvTWFueSBhIik7CiAgICAgICAgTGlzdDxFbnRpdHlBX0VtYmVkX0VtYmVk\nX1RvTWFueT4gYXMgPSBxLmdldFJlc3VsdExpc3QoKTsKICAgICAgICBmb3Ig\nKEVudGl0eUFfRW1iZWRfRW1iZWRfVG9NYW55IGEgOiBhcykgewogICAgICAg\nICAgICBjaGVja0VudGl0eUFfRW1iZWRfRW1iZWRfVG9NYW55KGEpOwogICAg\nICAgIH0KICAgICAgICB0cmFuLmNvbW1pdCgpOwogICAgICAgIGVtLmNsb3Nl\nKCk7CiAgICB9CgogICAgLyoKICAgICAqIFF1ZXJ5IEVudGl0eUFfRW1iZWRf\nQ29sbF9JbnRlZ2VyCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHF1ZXJ5RW50\naXR5QV9FbWJlZF9Db2xsX0ludGVnZXIoKSB7CiAgICAgICAgRW50aXR5TWFu\nYWdlciBlbSA9IGVtZi5jcmVhdGVFbnRpdHlNYW5hZ2VyKCk7CiAgICAgICAg\nLy8gdGVzdCBzZWxlY3QgZW1iZWQgb2JqZWN0IGZyb20gZWxlbWVudCBjb2xs\nZWN0aW9uIGluIGVtYmVkZGFibGUgb2JqZWN0CiAgICAgICAgU3RyaW5nW10g\ncXVlcnkgPSB7CiAgICAgICAgICAgICJzZWxlY3QgZSwgYS5pZCBmcm9tICIg\nKwogICAgICAgICAgICAgICAgIiBFbnRpdHlBX0VtYmVkX0NvbGxfSW50ZWdl\nciBhICIgKwogICAgICAgICAgICAgICAgIiAsIGluIChhLmVtYmVkLm90aGVy\nSW50VmFscykgZSBvcmRlciBieSBlIiwKICAgICAgICAgICAgInNlbGVjdCBl\nLCBhLmlkIGZyb20gIiArCiAgICAgICAgICAgICAgICAiIEVudGl0eUFfRW1i\nZWRfQ29sbF9JbnRlZ2VyIGEgIiArCiAgICAgICAgICAgICAgICAiICwgaW4g\nKGEuZW1iZWQub3RoZXJJbnRWYWxzKSBlIG9yZGVyIGJ5IGUiLAogICAgICAg\nICAgICAic2VsZWN0IGUsIGEuaWQgZnJvbSAiICsKICAgICAgICAgICAgICAg\nICIgRW50aXR5QV9FbWJlZF9Db2xsX0ludGVnZXIgYSAiICsKICAgICAgICAg\nICAgICAgICIgLCBpbiAoYS5lbWJlZC5vdGhlckludFZhbHMpIGUgb3JkZXIg\nYnkgYS5pZCIsCiAgICAgICAgICAgICJzZWxlY3QgZSwgYS5lbWJlZC5pbnRW\nYWwxIGZyb20gRW50aXR5QV9FbWJlZF9Db2xsX0ludGVnZXIgYSAiICsKICAg\nICAgICAgICAgICAgICIgLCBpbiAoYS5lbWJlZC5vdGhlckludFZhbHMpIGUg\nb3JkZXIgYnkgYS5pZCIsCiAgICAgICAgICAgICJzZWxlY3QgZSwgYS5lbWJl\nZC5pbnRWYWwyIGZyb20gIiArCiAgICAgICAgICAgICAgICAiIEVudGl0eUFf\nRW1iZWRfQ29sbF9JbnRlZ2VyIGEgIiArCiAgICAgICAgICAgICAgICAiICwg\naW4gKGEuZW1iZWQub3RoZXJJbnRWYWxzKSBlIG9yZGVyIGJ5IGUiLAogICAg\nICAgICAgICAic2VsZWN0IGUsIGEuZW1iZWQuaW50VmFsMiBmcm9tICIgKwog\nICAgICAgICAgICAgICAgIiBFbnRpdHlBX0VtYmVkX0NvbGxfSW50ZWdlciBh\nICIgKwogICAgICAgICAgICAgICAgIiAsIGluIChhLmVtYmVkLm90aGVySW50\nVmFscykgZSAiICsKICAgICAgICAgICAgICAgICIgV0hFUkUgYS5lbWJlZC5v\ndGhlckludFZhbHMgSVMgTk9UIEVNUFRZIG9yZGVyIGJ5IGUiLAogICAgICAg\nICAgICAic2VsZWN0IGUsIGEuZW1iZWQuaW50VmFsMiBmcm9tICIgKwogICAg\nICAgICAgICAgICAgIiBFbnRpdHlBX0VtYmVkX0NvbGxfSW50ZWdlciBhICIg\nKwogICAgICAgICAgICAgICAgIiAsIGluIChhLmVtYmVkLm90aGVySW50VmFs\ncykgZSAiICsKICAgICAgICAgICAgICAgICIgV0hFUkUgZXhpc3RzIChzZWxl\nY3QgYSBmcm9tICIgKwogICAgICAgICAgICAgICAgIiBFbnRpdHlBX0VtYmVk\nX0NvbGxfSW50ZWdlciBhICIgKwogICAgICAgICAgICAgICAgIiAsIGluIChh\nLmVtYmVkLm90aGVySW50VmFscykgZSAiICsKICAgICAgICAgICAgICAgICIg\nd2hlcmUgZSA+IDApIG9yZGVyIGJ5IGUiLAogICAgICAgICAgICAic2VsZWN0\nIGUsIGEwLmludFZhbDIgZnJvbSBFbnRpdHlBX0VtYmVkX0NvbGxfSW50ZWdl\nciBhICIgKwogICAgICAgICAgICAgICAgIkpPSU4gYS5lbWJlZCBhMCBKT0lO\nIGEwLm90aGVySW50VmFscyBlIFdIRVJFIGV4aXN0cyAoc2VsZWN0IGEgZnJv\nbSAiICsKICAgICAgICAgICAgICAgICIgRW50aXR5QV9FbWJlZF9Db2xsX0lu\ndGVnZXIgYSBKT0lOIGEuZW1iZWQgYTAgSk9JTiBhMC5vdGhlckludFZhbHMg\nZSAiICsKICAgICAgICAgICAgICAgICIgd2hlcmUgZSA+IDApIG9yZGVyIGJ5\nIGUiLAogICAgICAgIH07CiAgICAgICAgTGlzdDxPYmplY3RbXT4gcnMgPSBu\ndWxsOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgcXVlcnkubGVuZ3Ro\nOyBpKyspIHsKICAgICAgICAgICAgcnMgPSBlbS5jcmVhdGVRdWVyeShxdWVy\neVtpXSkuZ2V0UmVzdWx0TGlzdCgpOwogICAgICAgICAgICBhc3NlcnRUcnVl\nKHJzLnNpemUoKSA+IDApOwogICAgICAgICAgICBPYmplY3Qgb2JqID0gKChP\nYmplY3RbXSkgcnMuZ2V0KDApKVswXTsKICAgICAgICAgICAgYXNzZXJ0VHJ1\nZShvYmogaW5zdGFuY2VvZiBJbnRlZ2VyKTsKICAgICAgICAgICAgZW0uY2xl\nYXIoKTsKICAgICAgICB9CgogICAgICAgIEVudGl0eVRyYW5zYWN0aW9uIHRy\nYW4gPSBlbS5nZXRUcmFuc2FjdGlvbigpOwogICAgICAgIHRyYW4uYmVnaW4o\nKTsKICAgICAgICBRdWVyeSBxID0gZW0uY3JlYXRlUXVlcnkoInNlbGVjdCBh\nIGZyb20gRW50aXR5QV9FbWJlZF9Db2xsX0ludGVnZXIgYSIpOwogICAgICAg\nIExpc3Q8RW50aXR5QV9FbWJlZF9Db2xsX0ludGVnZXI+IGFzID0gcS5nZXRS\nZXN1bHRMaXN0KCk7CiAgICAgICAgZm9yIChFbnRpdHlBX0VtYmVkX0NvbGxf\nSW50ZWdlciBhIDogYXMpIHsKICAgICAgICAgICAgY2hlY2tFbnRpdHlBX0Vt\nYmVkX0NvbGxfSW50ZWdlcihhKTsKICAgICAgICB9CiAgICAgICAgdHJhbi5j\nb21taXQoKTsKICAgICAgICBlbS5jbG9zZSgpOwogICAgfQoKICAgIC8qCiAg\nICAgKiBRdWVyeSBFbnRpdHlBX0VtYmVkX0VtYmVkCiAgICAgKi8KICAgIHB1\nYmxpYyB2b2lkIHF1ZXJ5RW50aXR5QV9FbWJlZF9FbWJlZCgpIHsKICAgICAg\nICBFbnRpdHlNYW5hZ2VyIGVtID0gZW1mLmNyZWF0ZUVudGl0eU1hbmFnZXIo\nKTsKICAgICAgICAvLyB0ZXN0IHNlbGVjdCBlbWJlZGRhYmxlCiAgICAgICAg\nU3RyaW5nIHF1ZXJ5W10gPSB7CiAgICAgICAgICAgICJzZWxlY3QgYS5lbWJl\nZCBmcm9tIEVudGl0eUFfRW1iZWRfRW1iZWQgYSIsCiAgICAgICAgICAgICJz\nZWxlY3QgYS5lbWJlZC5lbWJlZCBmcm9tIEVudGl0eUFfRW1iZWRfRW1iZWQg\nYSIsCiAgICAgICAgICAgICJzZWxlY3QgYS5lbWJlZCBhcyBlIGZyb20gRW50\naXR5QV9FbWJlZF9FbWJlZCBhIE9SREVSIEJZIGUiLAogICAgICAgIH07CiAg\nICAgICAgU3RyaW5nIHF1ZXJ5MltdID0gewogICAgICAgICAgICAic2VsZWN0\nIGEuZW1iZWQgZnJvbSBFbnRpdHlBX0VtYmVkX0VtYmVkIGEgV0hFUkUgYS5l\nbWJlZC5lbWJlZCAiICsKICAgICAgICAgICAgICAgICIgSVMgTk9UIE5VTEwi\nLAogICAgICAgICAgICAic2VsZWN0IGEuZW1iZWQgZnJvbSBFbnRpdHlBX0Vt\nYmVkX0VtYmVkIGEgIiArICIgV0hFUkUgZXhpc3RzICIgKwogICAgICAgICAg\nICAgICAgIiAoc2VsZWN0IGEuZW1iZWQuZW1iZWQgZnJvbSBFbnRpdHlBX0Vt\nYmVkX0VtYmVkIGEiICsKICAgICAgICAgICAgICAgICIgd2hlcmUgYS5lbWJl\nZCBJUyBOT1QgTlVMTCkgIiwKICAgICAgICB9OwogICAgICAgIExpc3QgcnMg\nPSBudWxsOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgcXVlcnkubGVu\nZ3RoOyBpKyspIHsKICAgICAgICAgICAgcnMgPSBlbS5jcmVhdGVRdWVyeShx\ndWVyeVtpXSkuZ2V0UmVzdWx0TGlzdCgpOwogICAgICAgICAgICBhc3NlcnRU\ncnVlKHJzLnNpemUoKSA+IDApOwogICAgICAgICAgICBzd2l0Y2ggKGkpIHsK\nICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICBjYXNlIDI6CiAgICAg\nICAgICAgICAgICBhc3NlcnRUcnVlKHJzLmdldCgwKSBpbnN0YW5jZW9mIEVt\nYmVkX0VtYmVkKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAg\nICBjYXNlIDE6CiAgICAgICAgICAgICAgICBhc3NlcnRUcnVlKHJzLmdldCgw\nKSBpbnN0YW5jZW9mIEVtYmVkKTsKICAgICAgICAgICAgICAgIGJyZWFrOwog\nICAgICAgICAgICB9CiAgICAgICAgICAgIGVtLmNsZWFyKCk7CiAgICAgICAg\nfQogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgcXVlcnkyLmxlbmd0aDsg\naSsrKSB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBycyA9\nIGVtLmNyZWF0ZVF1ZXJ5KHF1ZXJ5MltpXSkuZ2V0UmVzdWx0TGlzdCgpOwog\nICAgICAgICAgICB9IGNhdGNoKEFyZ3VtZW50RXhjZXB0aW9uIGUpIHsKICAg\nICAgICAgICAgICAgIC8vIGFzIGV4cGVjdGVkOiBjb21wYXJpc29uIG92ZXIg\nZW1iZWRkZWQgb2JqZWN0IGlzIG5vdCBhbGxvd2VkCiAgICAgICAgICAgIH0K\nICAgICAgICB9CiAgICAgICAgRW50aXR5VHJhbnNhY3Rpb24gdHJhbiA9IGVt\nLmdldFRyYW5zYWN0aW9uKCk7CiAgICAgICAgdHJhbi5iZWdpbigpOwogICAg\nICAgIFF1ZXJ5IHEgPSBlbS5jcmVhdGVRdWVyeSgic2VsZWN0IGEgZnJvbSBF\nbnRpdHlBX0VtYmVkX0VtYmVkIGEiKTsKICAgICAgICBMaXN0PEVudGl0eUFf\nRW1iZWRfRW1iZWQ+IGFzID0gcS5nZXRSZXN1bHRMaXN0KCk7CiAgICAgICAg\nZm9yIChFbnRpdHlBX0VtYmVkX0VtYmVkIGEgOiBhcykgewogICAgICAgICAg\nICBjaGVja0VudGl0eUFfRW1iZWRfRW1iZWQoYSk7CiAgICAgICAgfQogICAg\nICAgIHRyYW4uY29tbWl0KCk7CiAgICAgICAgZW0uY2xvc2UoKTsKICAgIH0K\nCiAgICAvKgogICAgICogUXVlcnkgRW50aXR5QV9Db2xsX0VtYmVkX0VtYmVk\nCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHF1ZXJ5RW50aXR5QV9Db2xsX0Vt\nYmVkX0VtYmVkKCkgewogICAgICAgIEVudGl0eU1hbmFnZXIgZW0gPSBlbWYu\nY3JlYXRlRW50aXR5TWFuYWdlcigpOwogICAgICAgIC8vIHRlc3Qgc2VsZWN0\nIGVtYmVkIG9iamVjdCBmcm9tIGVsZW1lbnQgY29sbGVjdGlvbgogICAgICAg\nIFN0cmluZ1tdIHF1ZXJ5ID0gewogICAgICAgICAgICAic2VsZWN0IGUsIGUu\naW50VmFsMSwgZS5lbWJlZC5pbnRWYWwyIGZyb20gIiArCiAgICAgICAgICAg\nICAgICAiIEVudGl0eUFfQ29sbF9FbWJlZF9FbWJlZCBhICIgKwogICAgICAg\nICAgICAgICAgIiAsIGluIChhLmVtYmVkcykgZSBvcmRlciBieSBlLmludFZh\nbDMiLAogICAgICAgICAgICAic2VsZWN0IGUsIGUuaW50VmFsMSwgZS5lbWJl\nZC5pbnRWYWwyIGZyb20gIiArCiAgICAgICAgICAgICAgICAiIEVudGl0eUFf\nQ29sbF9FbWJlZF9FbWJlZCBhICIgKwogICAgICAgICAgICAgICAgIiAsIGlu\nIChhLmVtYmVkcykgZSBvcmRlciBieSBlLmludFZhbDMiLAogICAgICAgICAg\nICAic2VsZWN0IGUsIGEuaWQgZnJvbSBFbnRpdHlBX0NvbGxfRW1iZWRfRW1i\nZWQgYSAiICsKICAgICAgICAgICAgICAgICIgLCBpbiAoYS5lbWJlZHMpIGUg\nb3JkZXIgYnkgYS5pZCIsCiAgICAgICAgICAgICJzZWxlY3QgZSwgYS5pZCBm\ncm9tIEVudGl0eUFfQ29sbF9FbWJlZF9FbWJlZCBhICIgKwogICAgICAgICAg\nICAgICAgIiAsIGluIChhLmVtYmVkcykgZSBvcmRlciBieSBlIGRlc2MiLAog\nICAgICAgICAgICAic2VsZWN0IGUsIGUuaW50VmFsMSwgZS5lbWJlZC5pbnRW\nYWwyIGZyb20gIiArCiAgICAgICAgICAgICAgICAiIEVudGl0eUFfQ29sbF9F\nbWJlZF9FbWJlZCBhICIgKwogICAgICAgICAgICAgICAgIiAsIGluIChhLmVt\nYmVkcykgZSBXSEVSRSBhLmVtYmVkcyBJUyBOT1QgRU1QVFkgIiArCiAgICAg\nICAgICAgICAgICAiIG9yZGVyIGJ5IGUuaW50VmFsMyIsCiAgICAgICAgICAg\nIC8vIHRoZSBmb2xsb3dpbmcgcXVlcnkgd29ya3MgaW4gREIyIGJ1dCBub3Qg\naW4gRGVyYnksCiAgICAgICAgICAgIC8vIGJlY2F1c2UgRGVyYnkgc3VicXVl\ncnkgaXMgb25seSBhbGxvd2VkIHRvIAogICAgICAgICAgICAvLyByZXR1cm4g\nYSBzaW5nbGUgY29sdW1uLiAKICAgICAgICAgICAgLyoKICAgICAgICAgICAg\nInNlbGVjdCBlLCBlLmludFZhbDEsIGUuZW1iZWQuaW50VmFsMiBmcm9tICIg\nKwogICAgICAgICAgICAgICAgIiBFbnRpdHlBX0NvbGxfRW1iZWRfRW1iZWQg\nYSAiICsKICAgICAgICAgICAgICAgICIgLCBpbiAoYS5lbWJlZHMpIGUgV0hF\nUkUgZXhpc3RzIChzZWxlY3QgYS5lbWJlZHMgIiArCiAgICAgICAgICAgICAg\nICAiIGZyb20gRW50aXR5QV9Db2xsX0VtYmVkX0VtYmVkIGEpICIgKwogICAg\nICAgICAgICAgICAgIiBvcmRlciBieSBlLmludFZhbDMiLAogICAgICAgICAg\nICAqLwogICAgICAgIH07CiAgICAgICAgU3RyaW5nW10gcXVlcnkyID0gewog\nICAgICAgICAgICAic2VsZWN0IGUsIGUuaW50VmFsMSwgZS5lbWJlZC5pbnRW\nYWwyIGZyb20gIiArCiAgICAgICAgICAgICAgICAiIEVudGl0eUFfQ29sbF9F\nbWJlZF9FbWJlZCBhICIgKwogICAgICAgICAgICAgICAgIiAsIGluIChhLmVt\nYmVkcykgZSBXSEVSRSBlLmludFZhbDEgPCBBTlkgKHNlbGVjdCBlMi5pbnRW\nYWwyICIgKwogICAgICAgICAgICAgICAgIiBmcm9tIEVudGl0eUFfQ29sbF9F\nbWJlZF9FbWJlZCBhMSwgaW4gKGExLmVtYmVkcykgZTIpICIgKwogICAgICAg\nICAgICAgICAgIiBvcmRlciBieSBlLmludFZhbDMiLAogICAgICAgICAgICAi\nc2VsZWN0IGUsIGUuaW50VmFsMSwgZS5lbWJlZC5pbnRWYWwyIGZyb20gIiAr\nCiAgICAgICAgICAgICAgICAiIEVudGl0eUFfQ29sbF9FbWJlZF9FbWJlZCBh\nICIgKwogICAgICAgICAgICAgICAgIiAsIGluIChhLmVtYmVkcykgZSBXSEVS\nRSBlLmludFZhbDEgPCBBTEwgKHNlbGVjdCBlMi5pbnRWYWwyICIgKwogICAg\nICAgICAgICAgICAgIiBmcm9tIEVudGl0eUFfQ29sbF9FbWJlZF9FbWJlZCBh\nMSwgaW4gKGExLmVtYmVkcykgZTIpICIgKwogICAgICAgICAgICAgICAgIiBv\ncmRlciBieSBlLmludFZhbDMiLAogICAgICAgICAgICAic2VsZWN0IGUsIGUu\naW50VmFsMSwgZS5lbWJlZC5pbnRWYWwyIGZyb20gIiArCiAgICAgICAgICAg\nICAgICAiIEVudGl0eUFfQ29sbF9FbWJlZF9FbWJlZCBhICIgKwogICAgICAg\nICAgICAgICAgIiAsIGluIChhLmVtYmVkcykgZSBXSEVSRSBlLmludFZhbDEg\nPD0gU09NRSAiICsKICAgICAgICAgICAgICAgICIgKHNlbGVjdCBlMi5pbnRW\nYWwyICIgKwogICAgICAgICAgICAgICAgIiBmcm9tIEVudGl0eUFfQ29sbF9F\nbWJlZF9FbWJlZCBhMSwgaW4gKGExLmVtYmVkcykgZTIpICIgKwogICAgICAg\nICAgICAgICAgIiBvcmRlciBieSBlLmludFZhbDMiLAogICAgICAgICAgICAi\nc2VsZWN0IGUsIGUuaW50VmFsMSwgZS5lbWJlZC5pbnRWYWwyIGZyb20gIiAr\nCiAgICAgICAgICAgICAgICAiIEVudGl0eUFfQ29sbF9FbWJlZF9FbWJlZCBh\nICIgKwogICAgICAgICAgICAgICAgIiAsIGluIChhLmVtYmVkcykgZSBXSEVS\nRSBlLmludFZhbDEgPiBBTEwgKHNlbGVjdCBlMi5pbnRWYWwyICIgKwogICAg\nICAgICAgICAgICAgIiBmcm9tIEVudGl0eUFfQ29sbF9FbWJlZF9FbWJlZCBh\nMSwgaW4gKGExLmVtYmVkcykgZTIpICIgKwogICAgICAgICAgICAgICAgIiBv\ncmRlciBieSBlLmludFZhbDMiLAogICAgICAgICAgICAvLyBub24tY29yZWxh\ndGVkIHN1YnF1ZXJ5OgogICAgICAgICAgICAvLyBGaXhlZCBpbiBPUEVOSlBB\nLTExODU6IGtub3duIHByb2JsZW0gaW4gdGFibGUgYWxpYXMgcmVzb2x1dGlv\nbiBmb3Igc3VicXVlcnkKICAgICAgICAgICAgLy8gICAgICAgdGhlIGdlbmFy\nYXRlZCBTUUwgc3VicXVlcnkgc2hvdWxkIGJlIG5vbi1jb3JlbGF0ZWQsCiAg\nICAgICAgICAgIC8vICAgICAgIGJ1dCBnZW5lcmF0ZWQgY29yZWxhdGVkIHN1\nYnF1ZXJ5LgogICAgICAgICAgICAic2VsZWN0IGUsIGUuaW50VmFsMSwgZS5l\nbWJlZC5pbnRWYWwyIGZyb20gIiArCiAgICAgICAgICAgICAgICAiIEVudGl0\neUFfQ29sbF9FbWJlZF9FbWJlZCBhICIgKwogICAgICAgICAgICAgICAgIiAs\nIGluIChhLmVtYmVkcykgZSBXSEVSRSBlLmludFZhbDEgPCBBTlkgKHNlbGVj\ndCBlLmludFZhbDIgIiArCiAgICAgICAgICAgICAgICAiIGZyb20gRW50aXR5\nQV9Db2xsX0VtYmVkX0VtYmVkIGEsIGluIChhLmVtYmVkcykgZSkgIiArCiAg\nICAgICAgICAgICAgICAiIG9yZGVyIGJ5IGUuaW50VmFsMyIsCiAgICAgICAg\nICAgICJzZWxlY3QgZSwgZS5pbnRWYWwxLCBlLmVtYmVkLmludFZhbDIgZnJv\nbSAiICsKICAgICAgICAgICAgICAgICIgRW50aXR5QV9Db2xsX0VtYmVkX0Vt\nYmVkIGEgIiArCiAgICAgICAgICAgICAgICAiICwgaW4gKGEuZW1iZWRzKSBl\nIFdIRVJFIGUuaW50VmFsMSA8IEFMTCAoc2VsZWN0IGUuaW50VmFsMiAiICsK\nICAgICAgICAgICAgICAgICIgZnJvbSBFbnRpdHlBX0NvbGxfRW1iZWRfRW1i\nZWQgYSwgaW4gKGEuZW1iZWRzKSBlKSAiICsKICAgICAgICAgICAgICAgICIg\nb3JkZXIgYnkgZS5pbnRWYWwzIiwKICAgICAgICAgICAgInNlbGVjdCBlLCBl\nLmludFZhbDEsIGUuZW1iZWQuaW50VmFsMiBmcm9tICIgKwogICAgICAgICAg\nICAgICAgIiBFbnRpdHlBX0NvbGxfRW1iZWRfRW1iZWQgYSAiICsKICAgICAg\nICAgICAgICAgICIgLCBpbiAoYS5lbWJlZHMpIGUgV0hFUkUgZS5pbnRWYWwx\nIDw9IFNPTUUgIiArCiAgICAgICAgICAgICAgICAiIChzZWxlY3QgZS5pbnRW\nYWwyICIgKwogICAgICAgICAgICAgICAgIiBmcm9tIEVudGl0eUFfQ29sbF9F\nbWJlZF9FbWJlZCBhLCBpbiAoYS5lbWJlZHMpIGUpICIgKwogICAgICAgICAg\nICAgICAgIiBvcmRlciBieSBlLmludFZhbDMiLAogICAgICAgICAgICAic2Vs\nZWN0IGUsIGUuaW50VmFsMSwgZS5lbWJlZC5pbnRWYWwyIGZyb20gIiArCiAg\nICAgICAgICAgICAgICAiIEVudGl0eUFfQ29sbF9FbWJlZF9FbWJlZCBhICIg\nKwogICAgICAgICAgICAgICAgIiAsIGluIChhLmVtYmVkcykgZSBXSEVSRSBl\nLmludFZhbDEgPiBBTEwgKHNlbGVjdCBlLmludFZhbDIgIiArCiAgICAgICAg\nICAgICAgICAiIGZyb20gRW50aXR5QV9Db2xsX0VtYmVkX0VtYmVkIGEsIGlu\nIChhLmVtYmVkcykgZSkgIiArCiAgICAgICAgICAgICAgICAiIG9yZGVyIGJ5\nIGUuaW50VmFsMyIsCiAgICAgICAgICAgIC8vIGNvcmVsYXRlZCBzdWJxdWVy\neToKICAgICAgICAgICAgLy8gRml4ZWQgaW4gT1BFTkpQQS0xMTg1OiBrbm93\nbiBwcm9ibGVtIGluIHRhYmxlIGFsaWFzIHJlc29sdXRpb24gZm9yIHN1YnF1\nZXJ5CiAgICAgICAgICAgIC8vICAgICAgIHRoZSBnZW5hcmF0ZWQgU1FMIHN1\nYnF1ZXJ5IHNob3VsZCBiZSBjb3JlbGF0ZWQsCiAgICAgICAgICAgIC8vICAg\nICAgIGJ1dCBnZW5lcmF0ZWQgbm9uLWNvcmVsYXRlZCBzdWJxdWVyeS4KICAg\nICAgICAgICAgInNlbGVjdCBlLCBlLmludFZhbDEsIGUuZW1iZWQuaW50VmFs\nMiBmcm9tICIgKwogICAgICAgICAgICAgICAgIiBFbnRpdHlBX0NvbGxfRW1i\nZWRfRW1iZWQgYSAiICsKICAgICAgICAgICAgICAgICIgLCBpbiAoYS5lbWJl\nZHMpIGUgV0hFUkUgZS5pbnRWYWwxIDwgQU5ZIChzZWxlY3QgZTIuaW50VmFs\nMiAiICsKICAgICAgICAgICAgICAgICIgZnJvbSBpbihhLmVtYmVkcykgZTIp\nICIgKwogICAgICAgICAgICAgICAgIiBvcmRlciBieSBlLmludFZhbDMiLAog\nICAgICAgICAgICAic2VsZWN0IGUsIGUuaW50VmFsMSwgZS5lbWJlZC5pbnRW\nYWwyIGZyb20gIiArCiAgICAgICAgICAgICAgICAiIEVudGl0eUFfQ29sbF9F\nbWJlZF9FbWJlZCBhICIgKwogICAgICAgICAgICAgICAgIiAsIGluIChhLmVt\nYmVkcykgZSBXSEVSRSBlLmludFZhbDEgPCBBTEwgKHNlbGVjdCBlMi5pbnRW\nYWwyICIgKwogICAgICAgICAgICAgICAgIiBmcm9tIGEuZW1iZWRzIGUyKSAi\nICsKICAgICAgICAgICAgICAgICIgb3JkZXIgYnkgZS5pbnRWYWwzIiwKICAg\nICAgICAgICAgInNlbGVjdCBlLCBlLmludFZhbDEsIGUuZW1iZWQuaW50VmFs\nMiBmcm9tICIgKwogICAgICAgICAgICAgICAgIiBFbnRpdHlBX0NvbGxfRW1i\nZWRfRW1iZWQgYSAiICsKICAgICAgICAgICAgICAgICIgLCBpbiAoYS5lbWJl\nZHMpIGUgV0hFUkUgZS5pbnRWYWwxIDw9IFNPTUUgIiArCiAgICAgICAgICAg\nICAgICAiIChzZWxlY3QgZTIuaW50VmFsMiAiICsKICAgICAgICAgICAgICAg\nICIgZnJvbSBpbihhLmVtYmVkcykgZTIpICIgKwogICAgICAgICAgICAgICAg\nIiBvcmRlciBieSBlLmludFZhbDMiLAogICAgICAgICAgICAic2VsZWN0IGUs\nIGUuaW50VmFsMSwgZS5lbWJlZC5pbnRWYWwyIGZyb20gIiArCiAgICAgICAg\nICAgICAgICAiIEVudGl0eUFfQ29sbF9FbWJlZF9FbWJlZCBhICIgKwogICAg\nICAgICAgICAgICAgIiAsIGluIChhLmVtYmVkcykgZSBXSEVSRSBlLmludFZh\nbDEgPiBBTEwgKHNlbGVjdCBlMi5pbnRWYWwyICIgKwogICAgICAgICAgICAg\nICAgIiBmcm9tIGEuZW1iZWRzIGUyKSAiICsKICAgICAgICAgICAgICAgICIg\nb3JkZXIgYnkgZS5pbnRWYWwzIiwKICAgICAgICB9OwogICAgICAgIFN0cmlu\nZ1tdIHF1ZXJ5MyA9IHsKICAgICAgICAgICAgLy8gcXVlcnkgd2l0aCBwYXJh\nbWV0ZXIgb2YgZW1iZWRkYWJsZSBvYmplY3QKICAgICAgICAgICAgInNlbGVj\ndCBlLCBlLmludFZhbDEsIGUuZW1iZWQuaW50VmFsMiBmcm9tICIgKwogICAg\nICAgICAgICAgICAgIiBFbnRpdHlBX0NvbGxfRW1iZWRfRW1iZWQgYSAiICsK\nICAgICAgICAgICAgICAgICIgLCBpbiAoYS5lbWJlZHMpIGUgV0hFUkUgPzEg\nTUVNQkVSIE9GIGEuZW1iZWRzICIgKwogICAgICAgICAgICAgICAgIiBvcmRl\nciBieSBlLmludFZhbDMiLAogICAgICAgICAgICAic2VsZWN0IGUsIGUuaW50\nVmFsMSwgZS5lbWJlZC5pbnRWYWwyIGZyb20gIiArCiAgICAgICAgICAgICAg\nICAiIEVudGl0eUFfQ29sbF9FbWJlZF9FbWJlZCBhICIgKwogICAgICAgICAg\nICAgICAgIiBsZWZ0IGpvaW4gYS5lbWJlZHMgZSBXSEVSRSA/MSBNRU1CRVIg\nT0YgYS5lbWJlZHMgIiArCiAgICAgICAgICAgICAgICAiIG9yZGVyIGJ5IGUu\naW50VmFsMyIsCiAgICAgICAgICAgICJzZWxlY3QgZSwgZS5pbnRWYWwxLCBl\nLmVtYmVkLmludFZhbDIgZnJvbSAiICsKICAgICAgICAgICAgICAgICIgRW50\naXR5QV9Db2xsX0VtYmVkX0VtYmVkIGEgIiArCiAgICAgICAgICAgICAgICAi\nICwgaW4gKGEuZW1iZWRzKSBlIFdIRVJFID8xID0gZSAiICsKICAgICAgICAg\nICAgICAgICIgb3JkZXIgYnkgZS5pbnRWYWwzIiwKICAgICAgICB9OwoKICAg\nICAgICBMaXN0IHJzID0gbnVsbDsKICAgICAgICBPYmplY3Qgb2JqID0gbnVs\nbDsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IHF1ZXJ5Lmxlbmd0aDsg\naSsrKSB7CiAgICAgICAgICAgIHJzID0gZW0uY3JlYXRlUXVlcnkocXVlcnlb\naV0pLmdldFJlc3VsdExpc3QoKTsKICAgICAgICAgICAgYXNzZXJ0VHJ1ZShy\ncy5zaXplKCkgPiAwKTsKICAgICAgICAgICAgb2JqID0gKChPYmplY3RbXSkg\ncnMuZ2V0KDApKVswXTsKICAgICAgICAgICAgYXNzZXJ0VHJ1ZShvYmogaW5z\ndGFuY2VvZiBFbWJlZF9FbWJlZCk7CiAgICAgICAgfQogICAgICAgIGZvciAo\naW50IGkgPSAwOyBpIDwgcXVlcnkyLmxlbmd0aDsgaSsrKSB7CiAgICAgICAg\nICAgIHJzID0gZW0uY3JlYXRlUXVlcnkocXVlcnkyW2ldKS5nZXRSZXN1bHRM\naXN0KCk7CiAgICAgICAgICAgIGlmIChycy5zaXplKCkgPiAwKSB7CiAgICAg\nICAgICAgICAgICBvYmogPSAoKE9iamVjdFtdKSBycy5nZXQoMCkpWzBdOwog\nICAgICAgICAgICAgICAgYXNzZXJ0VHJ1ZShvYmogaW5zdGFuY2VvZiBFbWJl\nZF9FbWJlZCk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgZm9y\nIChpbnQgaSA9IDA7IGkgPCBxdWVyeTMubGVuZ3RoOyBpKyspIHsKICAgICAg\nICAgICAgdHJ5IHsKICAgICAgICAgICAgcnMgPSBlbS5jcmVhdGVRdWVyeShx\ndWVyeTNbaV0pLnNldFBhcmFtZXRlcigxLCBvYmopLmdldFJlc3VsdExpc3Qo\nKTsKICAgICAgICAgICAgfSBjYXRjaChBcmd1bWVudEV4Y2VwdGlvbiBlKSB7\nCiAgICAgICAgICAgICAgICAvLyBhcyBleHBlY3RlZDogY29tcGFyaXNvbiBv\ndmVyIGVtYmVkZGVkIG9iamVjdCBpcyBub3QgYWxsb3dlZAogICAgICAgICAg\nICB9CiAgICAgICAgfQoKICAgICAgICBlbS5jbGVhcigpOwoKICAgICAgICBF\nbnRpdHlUcmFuc2FjdGlvbiB0cmFuID0gZW0uZ2V0VHJhbnNhY3Rpb24oKTsK\nICAgICAgICB0cmFuLmJlZ2luKCk7CiAgICAgICAgUXVlcnkgcSA9IGVtLmNy\nZWF0ZVF1ZXJ5KCJzZWxlY3QgYSBmcm9tIEVudGl0eUFfQ29sbF9FbWJlZF9F\nbWJlZCBhIik7CiAgICAgICAgTGlzdDxFbnRpdHlBX0NvbGxfRW1iZWRfRW1i\nZWQ+IGFzID0gcS5nZXRSZXN1bHRMaXN0KCk7CiAgICAgICAgZm9yIChFbnRp\ndHlBX0NvbGxfRW1iZWRfRW1iZWQgYSA6IGFzKSB7CiAgICAgICAgICAgIGNo\nZWNrRW50aXR5QV9Db2xsX0VtYmVkX0VtYmVkKGEpOwogICAgICAgIH0KICAg\nICAgICB0cmFuLmNvbW1pdCgpOwogICAgICAgIGVtLmNsb3NlKCk7CiAgICB9\nCgogICAgLyoKICAgICAqIFF1ZXJ5IEVudGl0eUFfRW1iZWRfQ29sbF9FbWJl\nZAogICAgICovCiAgICBwdWJsaWMgdm9pZCBxdWVyeUVudGl0eUFfRW1iZWRf\nQ29sbF9FbWJlZCgpIHsKICAgICAgICBFbnRpdHlNYW5hZ2VyIGVtID0gZW1m\nLmNyZWF0ZUVudGl0eU1hbmFnZXIoKTsKICAgICAgICAvLyB0ZXN0IHNlbGVj\ndCBlbWJlZCBvYmplY3QgZnJvbSBlbGVtZW50IGNvbGxlY3Rpb24gaW4gZW1i\nZWRkYWJsZSBvYmplY3QKICAgICAgICBTdHJpbmdbXSBxdWVyeSA9IHsKICAg\nICAgICAgICAgInNlbGVjdCBlLCBlLmludFZhbDEsIGUuaW50VmFsMiBmcm9t\nICIgKwogICAgICAgICAgICAgICAgIiBFbnRpdHlBX0VtYmVkX0NvbGxfRW1i\nZWQgYSAiICsKICAgICAgICAgICAgICAgICIgLCBpbiAoYS5lbWJlZC5lbWJl\nZHMpIGUgb3JkZXIgYnkgZSIsCiAgICAgICAgICAgICJzZWxlY3QgZSwgZS5p\nbnRWYWwxIGZyb20gIiArCiAgICAgICAgICAgICAgICAiIEVudGl0eUFfRW1i\nZWRfQ29sbF9FbWJlZCBhICIgKwogICAgICAgICAgICAgICAgIiAsIGluIChh\nLmVtYmVkLmVtYmVkcykgZSBvcmRlciBieSBlLmludFZhbDMiLAogICAgICAg\nICAgICAic2VsZWN0IGUsIGEuaWQgZnJvbSBFbnRpdHlBX0VtYmVkX0NvbGxf\nRW1iZWQgYSAiICsKICAgICAgICAgICAgICAgICIgLCBpbiAoYS5lbWJlZC5l\nbWJlZHMpIGUgb3JkZXIgYnkgYS5pZCIsCiAgICAgICAgICAgICJzZWxlY3Qg\nZSwgZS5pbnRWYWwxLCBlLmludFZhbDIgZnJvbSAiICsKICAgICAgICAgICAg\nICAgICIgRW50aXR5QV9FbWJlZF9Db2xsX0VtYmVkIGEgIiArCiAgICAgICAg\nICAgICAgICAiICwgaW4gKGEuZW1iZWQuZW1iZWRzKSBlIG9yZGVyIGJ5IGUu\naW50VmFsMyIsCiAgICAgICAgICAgICJzZWxlY3QgZSwgZS5pbnRWYWwxLCBl\nLmludFZhbDIgZnJvbSAiICsKICAgICAgICAgICAgICAgICIgRW50aXR5QV9F\nbWJlZF9Db2xsX0VtYmVkIGEgIiArCiAgICAgICAgICAgICAgICAiICwgaW4g\nKGEuZW1iZWQuZW1iZWRzKSBlIHdoZXJlIGEuZW1iZWQuZW1iZWRzIElTIE5P\nVCBFTVBUWSIgKwogICAgICAgICAgICAgICAgIiBvcmRlciBieSBlIiwKICAg\nICAgICAgICAgInNlbGVjdCBlLCBlLmludFZhbDEsIGUuaW50VmFsMiBmcm9t\nICIgKwogICAgICAgICAgICAgICAgIiBFbnRpdHlBX0VtYmVkX0NvbGxfRW1i\nZWQgYSAiICsKICAgICAgICAgICAgICAgICIgLCBpbiAoYS5lbWJlZC5lbWJl\nZHMpIGUgd2hlcmUgZXhpc3RzIChzZWxlY3QgZS5pbnRWYWwxICIgKwogICAg\nICAgICAgICAgICAgIiBmcm9tIEVudGl0eUFfRW1iZWRfQ29sbF9FbWJlZCBh\nLCBpbiAoYS5lbWJlZC5lbWJlZHMpIGUgIiArCiAgICAgICAgICAgICAgICAi\nIHdoZXJlIGUuaW50VmFsMiA9IDEwNSkgIiArCiAgICAgICAgICAgICAgICAi\nIG9yZGVyIGJ5IGUiLAogICAgICAgICAgICAic2VsZWN0IGUsIGEgZnJvbSAi\nICsKICAgICAgICAgICAgICAgICIgRW50aXR5QV9FbWJlZF9Db2xsX0VtYmVk\nIGEgIiArCiAgICAgICAgICAgICAgICAiICwgaW4gKGEuZW1iZWQuZW1iZWRz\nKSBlICIgKwogICAgICAgICAgICAgICAgIiB3aGVyZSBlLmludFZhbDEgPSBT\nT01FICIgKwogICAgICAgICAgICAgICAgIiAoc2VsZWN0IGUyLmludFZhbDEg\nZnJvbSAiICsKICAgICAgICAgICAgICAgICIgRW50aXR5QV9FbWJlZF9Db2xs\nX0VtYmVkIGEyICIgKwogICAgICAgICAgICAgICAgIiAsIGluIChhMi5lbWJl\nZC5lbWJlZHMpIGUyKSAiICsKICAgICAgICAgICAgICAgICIgb3JkZXIgYnkg\nZSIsCiAgICAgICAgfTsKICAgICAgICBTdHJpbmdbXSBxdWVyeTIgPSB7CiAg\nICAgICAgICAgICJzZWxlY3QgZSwgYSBmcm9tICIgKwogICAgICAgICAgICAg\nICAgIiBFbnRpdHlBX0VtYmVkX0NvbGxfRW1iZWQgYSAiICsKICAgICAgICAg\nICAgICAgICIgLCBpbiAoYS5lbWJlZC5lbWJlZHMpIGUgIiArCiAgICAgICAg\nICAgICAgICAiIHdoZXJlIGUgPSA/MSBvcmRlciBieSBlIiwKICAgICAgICB9\nOwogICAgICAgIExpc3Q8T2JqZWN0W10+IHJzID0gbnVsbDsKICAgICAgICBF\nbnRpdHlBX0VtYmVkX0NvbGxfRW1iZWQgZWEgPSBudWxsOwogICAgICAgIE9i\namVjdCBvYmogPSBudWxsOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwg\ncXVlcnkubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgcnMgPSBlbS5jcmVh\ndGVRdWVyeShxdWVyeVtpXSkuZ2V0UmVzdWx0TGlzdCgpOwogICAgICAgICAg\nICBhc3NlcnRUcnVlKHJzLnNpemUoKSA+IDApOwogICAgICAgICAgICBvYmog\nPSAoKE9iamVjdFtdKSBycy5nZXQoMCkpWzBdOwogICAgICAgICAgICBhc3Nl\ncnRUcnVlKG9iaiBpbnN0YW5jZW9mIEVtYmVkKTsKICAgICAgICAgICAgaWYg\nKGkgPT0gcXVlcnkubGVuZ3RoLTEpCiAgICAgICAgICAgICAgICBlYSA9IChF\nbnRpdHlBX0VtYmVkX0NvbGxfRW1iZWQpICgoT2JqZWN0W10pIHJzLmdldCgw\nKSlbMV07CiAgICAgICAgfQoKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8\nIHF1ZXJ5Mi5sZW5ndGg7IGkrKykgewogICAgICAgICAgICB0cnkgewogICAg\nICAgICAgICBycyA9IGVtLmNyZWF0ZVF1ZXJ5KHF1ZXJ5MltpXSkuCiAgICAg\nICAgICAgICAgICBzZXRQYXJhbWV0ZXIoMSwgKEVtYmVkKSBvYmopLgogICAg\nICAgICAgICAgICAgZ2V0UmVzdWx0TGlzdCgpOwogICAgICAgICAgICB9IGNh\ndGNoIChBcmd1bWVudEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgICAgICAv\nLyBleHBlY3RlZCBleGNlcHRpb246IGNvbXBhcmlzb24gb3ZlciBlbWJlZGRl\nZCBvYmplY3QgaXMgbm90IGFsbG93ZWQKICAgICAgICAgICAgfQogICAgICAg\nIH0KICAgICAgICB0cnkgewogICAgICAgICAgICBycyA9IGVtLmNyZWF0ZVF1\nZXJ5KCJzZWxlY3QgYSBmcm9tICIgKwogICAgICAgICAgICAgICAgIiBFbnRp\ndHlBX0VtYmVkX0NvbGxfRW1iZWQgYSAiICsKICAgICAgICAgICAgICAgICIg\nd2hlcmUgYS5lbWJlZCA9ID8xIG9yZGVyIGJ5IGUiKS4KICAgICAgICAgICAg\nICAgIHNldFBhcmFtZXRlcigxLCBlYS5nZXRFbWJlZCgpKS4KICAgICAgICAg\nICAgICAgIGdldFJlc3VsdExpc3QoKTsKICAgICAgICB9IGNhdGNoIChBcmd1\nbWVudEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgIC8vIGV4cGVjdGVkIGV4\nY2VwdGlvbjogY29tcGFyaXNvbiBvdmVyIGVtYmVkZGVkIG9iamVjdCBpcyBu\nb3QgYWxsb3dlZAogICAgICAgIH0KICAgICAgICBlbS5jbGVhcigpOwoKICAg\nICAgICBFbnRpdHlUcmFuc2FjdGlvbiB0cmFuID0gZW0uZ2V0VHJhbnNhY3Rp\nb24oKTsKICAgICAgICB0cmFuLmJlZ2luKCk7CiAgICAgICAgUXVlcnkgcSA9\nIGVtLmNyZWF0ZVF1ZXJ5KCJzZWxlY3QgYSBmcm9tIEVudGl0eUFfRW1iZWRf\nQ29sbF9FbWJlZCBhIik7CiAgICAgICAgTGlzdDxFbnRpdHlBX0VtYmVkX0Nv\nbGxfRW1iZWQ+IGFzID0gcS5nZXRSZXN1bHRMaXN0KCk7CiAgICAgICAgZm9y\nIChFbnRpdHlBX0VtYmVkX0NvbGxfRW1iZWQgYSA6IGFzKSB7CiAgICAgICAg\nICAgIGNoZWNrRW50aXR5QV9FbWJlZF9Db2xsX0VtYmVkKGEpOwogICAgICAg\nIH0KICAgICAgICB0cmFuLmNvbW1pdCgpOwogICAgICAgIGVtLmNsb3NlKCk7\nCiAgICB9CiAgICAKICAgIHB1YmxpYyB2b2lkIGNyZWF0ZU9iak1hcEtleSgp\nIHsKICAgICAgICBFbnRpdHlNYW5hZ2VyIGVtID0gZW1mLmNyZWF0ZUVudGl0\neU1hbmFnZXIoKTsKICAgICAgICBFbnRpdHlUcmFuc2FjdGlvbiB0cmFuID0g\nZW0uZ2V0VHJhbnNhY3Rpb24oKTsKICAgICAgICBmb3IgKGludCBpID0gMDsg\naSA8IG51bURlcGFydG1lbnRzOyBpKyspCiAgICAgICAgICAgIGNyZWF0ZURl\ncGFydG1lbnQxKGVtLCBkZXB0SWQrKyk7CiAgICAgICAgZm9yIChpbnQgaSA9\nIDA7IGkgPCBudW1EZXBhcnRtZW50czsgaSsrKQogICAgICAgICAgICBjcmVh\ndGVEZXBhcnRtZW50MihlbSwgZGVwdElkKyspOwogICAgICAgIGZvciAoaW50\nIGkgPSAwOyBpIDwgbnVtRGVwYXJ0bWVudHM7IGkrKykKICAgICAgICAgICAg\nY3JlYXRlRGVwYXJ0bWVudDMoZW0sIGRlcHRJZCsrKTsKICAgICAgICB0cmFu\nLmJlZ2luKCk7CiAgICAgICAgZW0uZmx1c2goKTsKICAgICAgICB0cmFuLmNv\nbW1pdCgpOwogICAgICAgIGVtLmNsb3NlKCk7CiAgICB9CgogICAgcHVibGlj\nIHZvaWQgY3JlYXRlT2JqTWFwS2V5RW51bWVyYXRlZCgpIHsKICAgICAgICBF\nbnRpdHlNYW5hZ2VyIGVtID0gZW1mLmNyZWF0ZUVudGl0eU1hbmFnZXIoKTsK\nICAgICAgICBFbnRpdHlUcmFuc2FjdGlvbiB0cmFuID0gZW0uZ2V0VHJhbnNh\nY3Rpb24oKTsKICAgICAgICBJdGVtNCBpdGVtID0gbmV3IEl0ZW00KCk7CiAg\nICAgICAgaXRlbS5zZXRJZCgxKTsKICAgICAgICBGaWxlTmFtZTQgZmlsZU5h\nbWUxID0gbmV3IEZpbGVOYW1lNCgiZmlsZSIgKyAxLCAiZmlsZSIgKyAxKTsK\nICAgICAgICBpdGVtLmFkZEltYWdlKEl0ZW00LkNhdGFnb3J5LkExLCBmaWxl\nTmFtZTEpOwoKICAgICAgICBGaWxlTmFtZTQgZmlsZU5hbWUyID0gbmV3IEZp\nbGVOYW1lNCgiZmlsZSIgKyAyLCAiZmlsZSIgKyAyKTsKICAgICAgICBpdGVt\nLmFkZEltYWdlKEl0ZW00LkNhdGFnb3J5LkEyLCBmaWxlTmFtZTIpOwoKICAg\nICAgICBGaWxlTmFtZTQgZmlsZU5hbWUzID0gbmV3IEZpbGVOYW1lNCgiZmls\nZSIgKyAzLCAiZmlsZSIgKyAzKTsKICAgICAgICBpdGVtLmFkZEltYWdlKEl0\nZW00LkNhdGFnb3J5LkEzLCBmaWxlTmFtZTMpOwoKICAgICAgICBlbS5wZXJz\naXN0KGl0ZW0pOwogICAgICAgIHRyYW4uYmVnaW4oKTsKICAgICAgICBlbS5m\nbHVzaCgpOwogICAgICAgIHRyYW4uY29tbWl0KCk7CiAgICAgICAgZW0uY2xv\nc2UoKTsKICAgIH0KICAgIAogICAgcHVibGljIHZvaWQgY3JlYXRlT2JqTWFw\nS2V5VGVtcG9yYWwoKSB7CiAgICAgICAgRW50aXR5TWFuYWdlciBlbSA9IGVt\nZi5jcmVhdGVFbnRpdHlNYW5hZ2VyKCk7CiAgICAgICAgRW50aXR5VHJhbnNh\nY3Rpb24gdHJhbiA9IGVtLmdldFRyYW5zYWN0aW9uKCk7CiAgICAgICAgSXRl\nbTUgaXRlbSA9IG5ldyBJdGVtNSgpOwogICAgICAgIGl0ZW0uc2V0SWQoMSk7\nCiAgICAgICAgbG9uZyB0cyA9IFN5c3RlbS5jdXJyZW50VGltZU1pbGxpcygp\nOwogICAgICAgIFRpbWVzdGFtcCB0czEgPSBuZXcgVGltZXN0YW1wKHRzKTsK\nICAgICAgICBUaW1lc3RhbXAgdHMyID0gbmV3IFRpbWVzdGFtcCh0cysxMDAw\nMDAwKTsKICAgICAgICBUaW1lc3RhbXAgdHMzID0gbmV3IFRpbWVzdGFtcCh0\ncysyMDAwMDAwKTsKICAgICAgICAKICAgICAgICBGaWxlTmFtZTQgZmlsZU5h\nbWUxID0gbmV3IEZpbGVOYW1lNCgiZmlsZSIgKyAxLCAiZmlsZSIgKyAxKTsK\nICAgICAgICBpdGVtLmFkZEltYWdlKHRzMSwgZmlsZU5hbWUxKTsKCiAgICAg\nICAgRmlsZU5hbWU0IGZpbGVOYW1lMiA9IG5ldyBGaWxlTmFtZTQoImZpbGUi\nICsgMiwgImZpbGUiICsgMik7CiAgICAgICAgaXRlbS5hZGRJbWFnZSh0czIs\nIGZpbGVOYW1lMik7CgogICAgICAgIEZpbGVOYW1lNCBmaWxlTmFtZTMgPSBu\nZXcgRmlsZU5hbWU0KCJmaWxlIiArIDMsICJmaWxlIiArIDMpOwogICAgICAg\nIGl0ZW0uYWRkSW1hZ2UodHMzLCBmaWxlTmFtZTMpOwoKICAgICAgICBlbS5w\nZXJzaXN0KGl0ZW0pOwogICAgICAgIHRyYW4uYmVnaW4oKTsKICAgICAgICBl\nbS5mbHVzaCgpOwogICAgICAgIHRyYW4uY29tbWl0KCk7CiAgICAgICAgZW0u\nY2xvc2UoKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBjcmVhdGVPYmpNYXBL\nZXlDbGFzcygpIHsKICAgICAgICBFbnRpdHlNYW5hZ2VyIGVtID0gZW1mLmNy\nZWF0ZUVudGl0eU1hbmFnZXIoKTsKICAgICAgICBFbnRpdHlUcmFuc2FjdGlv\nbiB0cmFuID0gZW0uZ2V0VHJhbnNhY3Rpb24oKTsKICAgICAgICBmb3IgKGlu\ndCBpID0gMDsgaSA8IG51bUl0ZW1zOyBpKyspCiAgICAgICAgICAgIGNyZWF0\nZUl0ZW0xKGVtLCBpdGVtSWQrKyk7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7\nIGkgPCBudW1JdGVtczsgaSsrKQogICAgICAgICAgICBjcmVhdGVJdGVtMihl\nbSwgaXRlbUlkKyspOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgbnVt\nSXRlbXM7IGkrKykKICAgICAgICAgICAgY3JlYXRlSXRlbTMoZW0sIGl0ZW1J\nZCsrKTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IG51bUNvbXBhbnk7\nIGkrKykKICAgICAgICAgICAgY3JlYXRlQ29tcGFueTEoZW0sIGNvbXBJZCsr\nKTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IG51bUNvbXBhbnk7IGkr\nKykKICAgICAgICAgICAgY3JlYXRlQ29tcGFueTIoZW0sIGNvbXBJZCsrKTsK\nICAgICAgICB0cmFuLmJlZ2luKCk7CiAgICAgICAgZW0uZmx1c2goKTsKICAg\nICAgICB0cmFuLmNvbW1pdCgpOwogICAgICAgIGJvb2xlYW4gZm91bmQgPSBm\nYWxzZTsKICAgICAgICBmb3IgKFN0cmluZyBzcWxTdHIgOiBzcWwpIHsKICAg\nICAgICAgICAgaWYgKHNxbFN0ci50b1VwcGVyQ2FzZSgpLmluZGV4T2YoIklU\nRU0yX1hYWCIpICE9IC0xKSB7CiAgICAgICAgICAgICAgICBmb3VuZCA9IHRy\ndWU7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfSAKICAg\nICAgICAgICAgaWYgKHNxbFN0ci50b1VwcGVyQ2FzZSgpLmluZGV4T2YoIklU\nRU0yX0lNQUdFUyIpICE9IC0xKSB7CiAgICAgICAgICAgICAgICBmb3VuZCA9\nIGZhbHNlOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0K\nICAgICAgICB9CiAgICAgICAgaWYgKCFmb3VuZCkgewogICAgICAgICAgICBm\nYWlsKCJUYWJsZSBuYW1lIElURU0yX0lNRyBzcGVjaWZpZWQgaW4gdGhlIE1h\ncEtleUNvbHVtbiBhbm5vdGF0aW9uIGlzIG5vdCBob25vcmVkIik7CiAgICAg\nICAgfQogICAgICAgIGVtLmNsb3NlKCk7CiAgICB9CgogICAgcHVibGljIHZv\naWQgY3JlYXRlSXRlbTEoRW50aXR5TWFuYWdlciBlbSwgaW50IGlkKSB7CiAg\nICAgICAgSXRlbTEgaXRlbSA9IG5ldyBJdGVtMSgpOwogICAgICAgIGl0ZW0u\nc2V0SWQoaWQpOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgbnVtSW1h\nZ2VzUGVySXRlbTsgaSsrKSB7CiAgICAgICAgICAgIGl0ZW0uYWRkSW1hZ2Uo\nImltYWdlIiArIGlkICsgaSwgImZpbGUiICsgaWQgKyBpKTsKICAgICAgICB9\nCiAgICAgICAgZW0ucGVyc2lzdChpdGVtKTsKICAgIH0KICAgIAogICAgcHVi\nbGljIHZvaWQgY3JlYXRlSXRlbTIoRW50aXR5TWFuYWdlciBlbSwgaW50IGlk\nKSB7CiAgICAgICAgSXRlbTIgaXRlbSA9IG5ldyBJdGVtMigpOwogICAgICAg\nIGl0ZW0uc2V0SWQoaWQpOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwg\nbnVtSW1hZ2VzUGVySXRlbTsgaSsrKSB7CiAgICAgICAgICAgIGl0ZW0uYWRk\nSW1hZ2UoImltYWdlIiArIGlkICsgaSwgImZpbGUiICsgaWQgKyBpKTsKICAg\nICAgICB9CiAgICAgICAgZW0ucGVyc2lzdChpdGVtKTsKICAgIH0KCiAgICBw\ndWJsaWMgdm9pZCBjcmVhdGVJdGVtMyhFbnRpdHlNYW5hZ2VyIGVtLCBpbnQg\naWQpIHsKICAgICAgICBJdGVtMyBpdGVtID0gbmV3IEl0ZW0zKCk7CiAgICAg\nICAgaXRlbS5zZXRJZChpZCk7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkg\nPCBudW1JbWFnZXNQZXJJdGVtOyBpKyspIHsKICAgICAgICAgICAgaXRlbS5h\nZGRJbWFnZSgiaW1hZ2UiICsgaWQgKyBpLCAiZmlsZSIgKyBpZCArIGkpOwog\nICAgICAgIH0KICAgICAgICBlbS5wZXJzaXN0KGl0ZW0pOwogICAgfQoKICAg\nIHB1YmxpYyB2b2lkIGNyZWF0ZUNvbXBhbnkxKEVudGl0eU1hbmFnZXIgZW0s\nIGludCBpZCkgewogICAgICAgIENvbXBhbnkxIGMgPSBuZXcgQ29tcGFueTEo\nKTsKICAgICAgICBjLnNldElkKGlkKTsKICAgICAgICBmb3IgKGludCBpID0g\nMDsgaSA8IG51bURpdmlzaW9uc1BlckNvOyBpKyspIHsKICAgICAgICAgICAg\nRGl2aXNpb24gZCA9IGNyZWF0ZURpdmlzaW9uKGVtLCBkaXZJZCsrKTsKICAg\nICAgICAgICAgVmljZVByZXNpZGVudCB2cCA9IGNyZWF0ZVZpY2VQcmVzaWRl\nbnQoZW0sIHZwSWQrKyk7CiAgICAgICAgICAgIGMuYWRkVG9Pcmdhbml6YXRp\nb24oZCwgdnApOwogICAgICAgICAgICBlbS5wZXJzaXN0KGQpOwogICAgICAg\nICAgICBlbS5wZXJzaXN0KHZwKTsKICAgICAgICB9CiAgICAgICAgZW0ucGVy\nc2lzdChjKTsKICAgIH0KICAgIAogICAgcHVibGljIHZvaWQgY3JlYXRlQ29t\ncGFueTIoRW50aXR5TWFuYWdlciBlbSwgaW50IGlkKSB7CiAgICAgICAgQ29t\ncGFueTIgYyA9IG5ldyBDb21wYW55MigpOwogICAgICAgIGMuc2V0SWQoaWQp\nOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgbnVtRGl2aXNpb25zUGVy\nQ287IGkrKykgewogICAgICAgICAgICBEaXZpc2lvbiBkID0gY3JlYXRlRGl2\naXNpb24oZW0sIGRpdklkKyspOwogICAgICAgICAgICBWaWNlUHJlc2lkZW50\nIHZwID0gY3JlYXRlVmljZVByZXNpZGVudChlbSwgdnBJZCsrKTsKICAgICAg\nICAgICAgYy5hZGRUb09yZ2FuaXphdGlvbihkLCB2cCk7CiAgICAgICAgICAg\nIGVtLnBlcnNpc3QoZCk7CiAgICAgICAgICAgIGVtLnBlcnNpc3QodnApOwog\nICAgICAgIH0KICAgICAgICBlbS5wZXJzaXN0KGMpOwogICAgfQoKICAgIHB1\nYmxpYyBEaXZpc2lvbiBjcmVhdGVEaXZpc2lvbihFbnRpdHlNYW5hZ2VyIGVt\nLCBpbnQgaWQpIHsKICAgICAgICBEaXZpc2lvbiBkID0gbmV3IERpdmlzaW9u\nKCk7CiAgICAgICAgZC5zZXRJZChpZCk7CiAgICAgICAgZC5zZXROYW1lKCJk\nIiArIGlkKTsKICAgICAgICByZXR1cm4gZDsKICAgIH0KICAgIAogICAgcHVi\nbGljIFZpY2VQcmVzaWRlbnQgY3JlYXRlVmljZVByZXNpZGVudChFbnRpdHlN\nYW5hZ2VyIGVtLCBpbnQgaWQpIHsKICAgICAgICBWaWNlUHJlc2lkZW50IHZw\nID0gbmV3IFZpY2VQcmVzaWRlbnQoKTsKICAgICAgICB2cC5zZXRJZChpZCk7\nCiAgICAgICAgdnAuc2V0TmFtZSgidnAiICsgaWQpOwogICAgICAgIHJldHVy\nbiB2cDsKICAgIH0gICAgCgogICAgcHVibGljIHZvaWQgY3JlYXRlRGVwYXJ0\nbWVudDEoRW50aXR5TWFuYWdlciBlbSwgaW50IGlkKSB7CiAgICAgICAgRGVw\nYXJ0bWVudDEgZCA9IG5ldyBEZXBhcnRtZW50MSgpOwogICAgICAgIGQuc2V0\nRGVwdElkKGlkKTsKICAgICAgICBNYXAgZW1wcyA9IG5ldyBIYXNoTWFwKCk7\nCiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBudW1FbXBsb3llZXNQZXJE\nZXB0OyBpKyspIHsKICAgICAgICAgICAgRW1wbG95ZWUxIGUgPSBjcmVhdGVF\nbXBsb3llZTEoZW0sIGVtcElkKyspOwogICAgICAgICAgICAvL2QuYWRkRW1w\nbG95ZWUxKGUpOwogICAgICAgICAgICBlbXBzLnB1dChlLmdldEVtcElkKCks\nIGUpOwogICAgICAgICAgICBlLnNldERlcGFydG1lbnQoZCk7CiAgICAgICAg\nICAgIGVtLnBlcnNpc3QoZSk7CiAgICAgICAgfQogICAgICAgIGQuc2V0RW1w\nTWFwKGVtcHMpOwogICAgICAgIGVtLnBlcnNpc3QoZCk7CiAgICB9CiAgICAK\nICAgIHB1YmxpYyBFbXBsb3llZTEgY3JlYXRlRW1wbG95ZWUxKEVudGl0eU1h\nbmFnZXIgZW0sIGludCBpZCkgewogICAgICAgIEVtcGxveWVlMSBlID0gbmV3\nIEVtcGxveWVlMSgpOwogICAgICAgIGUuc2V0RW1wSWQoaWQpOwogICAgICAg\nIHJldHVybiBlOwogICAgfQogICAgCiAgICBwdWJsaWMgdm9pZCBjcmVhdGVE\nZXBhcnRtZW50MihFbnRpdHlNYW5hZ2VyIGVtLCBpbnQgaWQpIHsKICAgICAg\nICBEZXBhcnRtZW50MiBkID0gbmV3IERlcGFydG1lbnQyKCk7CiAgICAgICAg\nZC5zZXREZXB0SWQoaWQpOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwg\nbnVtRW1wbG95ZWVzUGVyRGVwdDsgaSsrKSB7CiAgICAgICAgICAgIEVtcGxv\neWVlMiBlID0gY3JlYXRlRW1wbG95ZWUyKGVtLCBlbXBJZCsrKTsKICAgICAg\nICAgICAgZC5hZGRFbXBsb3llZShlKTsKICAgICAgICAgICAgZS5zZXREZXBh\ncnRtZW50KGQpOwogICAgICAgICAgICBlbS5wZXJzaXN0KGUpOwogICAgICAg\nIH0KICAgICAgICBlbS5wZXJzaXN0KGQpOwogICAgfQogICAgCiAgICBwdWJs\naWMgRW1wbG95ZWUyIGNyZWF0ZUVtcGxveWVlMihFbnRpdHlNYW5hZ2VyIGVt\nLCBpbnQgaWQpIHsKICAgICAgICBFbXBsb3llZTIgZSA9IG5ldyBFbXBsb3ll\nZTIoImUiICsgaWQsIG5ldyBEYXRlKCkpOwogICAgICAgIHJldHVybiBlOwog\nICAgfQogICAgCiAgICBwdWJsaWMgdm9pZCBjcmVhdGVEZXBhcnRtZW50MyhF\nbnRpdHlNYW5hZ2VyIGVtLCBpbnQgaWQpIHsKICAgICAgICBEZXBhcnRtZW50\nMyBkID0gbmV3IERlcGFydG1lbnQzKCk7CiAgICAgICAgZC5zZXREZXB0SWQo\naWQpOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgbnVtRW1wbG95ZWVz\nUGVyRGVwdDsgaSsrKSB7CiAgICAgICAgICAgIEVtcGxveWVlMyBlID0gY3Jl\nYXRlRW1wbG95ZWUzKGVtLCBlbXBJZCsrKTsKICAgICAgICAgICAgZC5hZGRF\nbXBsb3llZShlKTsKICAgICAgICAgICAgZS5zZXREZXBhcnRtZW50KGQpOwog\nICAgICAgICAgICBlbS5wZXJzaXN0KGUpOwogICAgICAgIH0KICAgICAgICBl\nbS5wZXJzaXN0KGQpOwogICAgfQogICAgCiAgICBwdWJsaWMgRW1wbG95ZWUz\nIGNyZWF0ZUVtcGxveWVlMyhFbnRpdHlNYW5hZ2VyIGVtLCBpbnQgaWQpIHsK\nICAgICAgICBFbXBsb3llZTMgZSA9IG5ldyBFbXBsb3llZTMoKTsKICAgICAg\nICBFbXBsb3llZU5hbWUzIG5hbWUgPSBuZXcgRW1wbG95ZWVOYW1lMygiZiIg\nKyBpZCwgImwiICsgaWQpOwogICAgICAgIGUuc2V0RW1wSWQoaWQpOwogICAg\nICAgIGUuc2V0TmFtZShuYW1lKTsKICAgICAgICByZXR1cm4gZTsKICAgIH0K\nCiAgICBwdWJsaWMgdm9pZCBmaW5kT2JqTWFwS2V5KCkgewogICAgICAgIEVu\ndGl0eU1hbmFnZXIgZW0gPSBlbWYuY3JlYXRlRW50aXR5TWFuYWdlcigpOwog\nICAgICAgIERlcGFydG1lbnQxIGQxID0gZW0uZmluZChEZXBhcnRtZW50MS5j\nbGFzcywgMSk7CiAgICAgICAgYXNzZXJ0RGVwYXJ0bWVudDEoZDEpOwogICAg\nICAgIAogICAgICAgIEVtcGxveWVlMSBlMSA9IGVtLmZpbmQoRW1wbG95ZWUx\nLmNsYXNzLCAxKTsKICAgICAgICBhc3NlcnRFbXBsb3llZTEoZTEpOwogICAg\nICAgIAogICAgICAgIERlcGFydG1lbnQyIGQyID0gZW0uZmluZChEZXBhcnRt\nZW50Mi5jbGFzcywgMyk7CiAgICAgICAgYXNzZXJ0RGVwYXJ0bWVudDIoZDIp\nOwogICAgICAgIAogICAgICAgIE1hcCBlbXBzID0gZDIuZ2V0RW1wTWFwKCk7\nCiAgICAgICAgU2V0PEVtcGxveWVlUEsyPiBrZXlzID0gZW1wcy5rZXlTZXQo\nKTsKICAgICAgICBmb3IgKEVtcGxveWVlUEsyIGtleSA6IGtleXMpIHsKICAg\nICAgICAgICAgRW1wbG95ZWUyIGUyID0gZW0uZmluZChFbXBsb3llZTIuY2xh\nc3MsIGtleSk7CiAgICAgICAgICAgIGFzc2VydEVtcGxveWVlMihlMik7CiAg\nICAgICAgfQogICAgICAgIAogICAgICAgIERlcGFydG1lbnQzIGQzID0gZW0u\nZmluZChEZXBhcnRtZW50My5jbGFzcywgNSk7CiAgICAgICAgYXNzZXJ0RGVw\nYXJ0bWVudDMoZDMpOwogICAgICAgIAogICAgICAgIEVtcGxveWVlMyBlMyA9\nIGVtLmZpbmQoRW1wbG95ZWUzLmNsYXNzLCA5KTsKICAgICAgICBhc3NlcnRF\nbXBsb3llZTMoZTMpOwogICAgICAgIAogICAgICAgIGVtLmNsb3NlKCk7CiAg\nICB9CiAgICAKICAgIHB1YmxpYyB2b2lkIGFzc2VydERlcGFydG1lbnQxKERl\ncGFydG1lbnQxIGQpIHsKICAgICAgICBpbnQgaWQgPSBkLmdldERlcHRJZCgp\nOwogICAgICAgIE1hcDxJbnRlZ2VyLCBFbXBsb3llZTE+IGVzID0gZC5nZXRF\nbXBNYXAoKTsKICAgICAgICBhc3NlcnRFcXVhbHMoMixlcy5zaXplKCkpOwog\nICAgICAgIFNldCBrZXlzID0gZXMua2V5U2V0KCk7CiAgICAgICAgZm9yIChP\nYmplY3Qgb2JqIDoga2V5cykgewogICAgICAgICAgICBJbnRlZ2VyIGVtcElk\nID0gKEludGVnZXIpIG9iajsKICAgICAgICAgICAgRW1wbG95ZWUxIGUgPSBl\ncy5nZXQoZW1wSWQpOwogICAgICAgICAgICBhc3NlcnRFcXVhbHMoZW1wSWQu\naW50VmFsdWUoKSwgZS5nZXRFbXBJZCgpKTsKICAgICAgICB9CiAgICB9CiAg\nICAKICAgIHB1YmxpYyB2b2lkIGFzc2VydERlcGFydG1lbnQyKERlcGFydG1l\nbnQyIGQpIHsKICAgICAgICBpbnQgaWQgPSBkLmdldERlcHRJZCgpOwogICAg\nICAgIE1hcDxFbXBsb3llZVBLMiwgRW1wbG95ZWUyPiBlcyA9IGQuZ2V0RW1w\nTWFwKCk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKDIsZXMuc2l6ZSgpKTsKICAg\nICAgICBTZXQ8RW1wbG95ZWVQSzI+IGtleXMgPSBlcy5rZXlTZXQoKTsKICAg\nICAgICBmb3IgKEVtcGxveWVlUEsyIHBrIDoga2V5cykgewogICAgICAgICAg\nICBFbXBsb3llZTIgZSA9IGVzLmdldChwayk7CiAgICAgICAgICAgIGFzc2Vy\ndEVxdWFscyhwaywgZS5nZXRFbXBQSygpKTsKICAgICAgICB9CiAgICB9ICAg\nCgogICAgcHVibGljIHZvaWQgYXNzZXJ0RGVwYXJ0bWVudDMoRGVwYXJ0bWVu\ndDMgZCkgewogICAgICAgIGludCBpZCA9IGQuZ2V0RGVwdElkKCk7CiAgICAg\nICAgTWFwPEVtcGxveWVlTmFtZTMsIEVtcGxveWVlMz4gZXMgPSBkLmdldEVt\ncGxveWVlcygpOwogICAgICAgIGFzc2VydEVxdWFscygyLGVzLnNpemUoKSk7\nCiAgICAgICAgU2V0PEVtcGxveWVlTmFtZTM+IGtleXMgPSBlcy5rZXlTZXQo\nKTsKICAgICAgICBmb3IgKEVtcGxveWVlTmFtZTMga2V5IDoga2V5cykgewog\nICAgICAgICAgICBFbXBsb3llZTMgZSA9IGVzLmdldChrZXkpOwogICAgICAg\nICAgICBhc3NlcnRFcXVhbHMoa2V5LCBlLmdldE5hbWUoKSk7CiAgICAgICAg\nfQogICAgfQogICAgCiAgICBwdWJsaWMgdm9pZCBhc3NlcnRFbXBsb3llZTEo\nRW1wbG95ZWUxIGUpIHsKICAgICAgICBpbnQgaWQgPSBlLmdldEVtcElkKCk7\nCiAgICAgICAgRGVwYXJ0bWVudDEgZCA9IGUuZ2V0RGVwYXJ0bWVudCgpOwog\nICAgICAgIGFzc2VydERlcGFydG1lbnQxKGQpOwogICAgfQogICAgCiAgICBw\ndWJsaWMgdm9pZCBhc3NlcnRFbXBsb3llZTIoRW1wbG95ZWUyIGUpIHsKICAg\nICAgICBFbXBsb3llZVBLMiBwayA9IGUuZ2V0RW1wUEsoKTsKICAgICAgICBE\nZXBhcnRtZW50MiBkID0gZS5nZXREZXBhcnRtZW50KCk7CiAgICAgICAgYXNz\nZXJ0RGVwYXJ0bWVudDIoZCk7CiAgICB9CiAgICAKICAgIHB1YmxpYyB2b2lk\nIGFzc2VydEVtcGxveWVlMyhFbXBsb3llZTMgZSkgewogICAgICAgIGludCBp\nZCA9IGUuZ2V0RW1wSWQoKTsKICAgICAgICBEZXBhcnRtZW50MyBkID0gZS5n\nZXREZXBhcnRtZW50KCk7CiAgICAgICAgYXNzZXJ0RGVwYXJ0bWVudDMoZCk7\nCiAgICB9CgogICAgcHVibGljIHZvaWQgcXVlcnlPYmpNYXBLZXkoKSB7CiAg\nICAgICAgcXVlcnlEZXBhcnRtZW50KGVtZik7CiAgICAgICAgcXVlcnlFbXBs\nb3llZShlbWYpOwogICAgfQogICAgCiAgICBwdWJsaWMgdm9pZCBxdWVyeURl\ncGFydG1lbnQoRW50aXR5TWFuYWdlckZhY3RvcnkgZW1mKSB7CiAgICAgICAg\nRW50aXR5TWFuYWdlciBlbSA9IGVtZi5jcmVhdGVFbnRpdHlNYW5hZ2VyKCk7\nCiAgICAgICAgRW50aXR5VHJhbnNhY3Rpb24gdHJhbiA9IGVtLmdldFRyYW5z\nYWN0aW9uKCk7CiAgICAgICAgdHJhbi5iZWdpbigpOwogICAgICAgIFF1ZXJ5\nIHExID0gZW0uY3JlYXRlUXVlcnkoInNlbGVjdCBkIGZyb20gRGVwYXJ0bWVu\ndDEgZCIpOwogICAgICAgIExpc3Q8RGVwYXJ0bWVudDE+IGRzMSA9IHExLmdl\ndFJlc3VsdExpc3QoKTsKICAgICAgICBmb3IgKERlcGFydG1lbnQxIGQgOiBk\nczEpewogICAgICAgICAgICBhc3NlcnREZXBhcnRtZW50MShkKTsKICAgICAg\nICB9CiAgICAgICAgCiAgICAgICAgUXVlcnkgcTIgPSBlbS5jcmVhdGVRdWVy\neSgic2VsZWN0IGQgZnJvbSBEZXBhcnRtZW50MiBkIik7CiAgICAgICAgTGlz\ndDxEZXBhcnRtZW50Mj4gZHMyID0gcTIuZ2V0UmVzdWx0TGlzdCgpOwogICAg\nICAgIGZvciAoRGVwYXJ0bWVudDIgZCA6IGRzMil7CiAgICAgICAgICAgIGFz\nc2VydERlcGFydG1lbnQyKGQpOwogICAgICAgIH0KCiAgICAgICAgUXVlcnkg\ncTMgPSBlbS5jcmVhdGVRdWVyeSgic2VsZWN0IGQgZnJvbSBEZXBhcnRtZW50\nMyBkIik7CiAgICAgICAgTGlzdDxEZXBhcnRtZW50Mz4gZHMzID0gcTMuZ2V0\nUmVzdWx0TGlzdCgpOwogICAgICAgIGZvciAoRGVwYXJ0bWVudDMgZCA6IGRz\nMyl7CiAgICAgICAgICAgIGFzc2VydERlcGFydG1lbnQzKGQpOwogICAgICAg\nIH0KICAgICAgICAKICAgICAgICB0cmFuLmNvbW1pdCgpOwoKICAgICAgICBT\ndHJpbmcgcXVlcnlbXSA9IHsKICAgICAgICAgICAgInNlbGVjdCBkIGZyb20g\nRGVwYXJ0bWVudDEgZCBqb2luIGQuZW1wTWFwIGUgIiArCiAgICAgICAgICAg\nICAgICAiIHdoZXJlIEtFWShlKSA+IDEgb3JkZXIgYnkgZCIsCiAgICAgICAg\nICAgICJzZWxlY3QgZCBmcm9tIERlcGFydG1lbnQxIGQgam9pbiBkLmVtcE1h\ncCBlIiArCiAgICAgICAgICAgICAgICAiIHdoZXJlIGQuZGVwdElkID0gS0VZ\nKGUpIG9yZGVyIGJ5IGQiLAogICAgICAgICAgICAic2VsZWN0IGQgZnJvbSBE\nZXBhcnRtZW50MSBkICIgKwogICAgICAgICAgICAgICAgIiB3aGVyZSBkLmRl\ncHRJZCA8IEFOWSAiICsKICAgICAgICAgICAgICAgICIgKHNlbGVjdCBLRVko\nZSkgZnJvbSBpbihkLmVtcE1hcCkgZSkgIiArCiAgICAgICAgICAgICAgICAi\nIG9yZGVyIGJ5IGQiLAogICAgICAgICAgICAic2VsZWN0IGQgZnJvbSBEZXBh\ncnRtZW50MSBkICIgKwogICAgICAgICAgICAgICAgIiB3aGVyZSBkLmRlcHRJ\nZCA8IFNPTUUgIiArCiAgICAgICAgICAgICAgICAiIChzZWxlY3QgS0VZKGUp\nIGZyb20gRGVwYXJ0bWVudDEgZDEsIGluKGQxLmVtcE1hcCkgZSkgIiArCiAg\nICAgICAgICAgICAgICAiIG9yZGVyIGJ5IGQiLAogICAgICAgIH07CiAgICAg\nICAgZm9yIChpbnQgaSA9IDA7IGkgPCBxdWVyeS5sZW5ndGg7IGkrKykgewog\nICAgICAgICAgICBkczEgPSBlbS5jcmVhdGVRdWVyeShxdWVyeVtpXSkuZ2V0\nUmVzdWx0TGlzdCgpOwogICAgICAgICAgICBhc3NlcnREZXBhcnRtZW50MShk\nczEuZ2V0KDApKTsKICAgICAgICB9CiAgICAgICAgZW0uY2xvc2UoKTsKICAg\nIH0KCiAgICBwdWJsaWMgdm9pZCBxdWVyeUVtcGxveWVlKEVudGl0eU1hbmFn\nZXJGYWN0b3J5IGVtZikgewogICAgICAgIEVudGl0eU1hbmFnZXIgZW0gPSBl\nbWYuY3JlYXRlRW50aXR5TWFuYWdlcigpOwogICAgICAgIEVudGl0eVRyYW5z\nYWN0aW9uIHRyYW4gPSBlbS5nZXRUcmFuc2FjdGlvbigpOwogICAgICAgIHRy\nYW4uYmVnaW4oKTsKICAgICAgICBRdWVyeSBxMSA9IGVtLmNyZWF0ZVF1ZXJ5\nKCJzZWxlY3QgZSBmcm9tIEVtcGxveWVlMSBlIik7CiAgICAgICAgTGlzdDxF\nbXBsb3llZTE+IGVzMSA9IHExLmdldFJlc3VsdExpc3QoKTsKICAgICAgICBm\nb3IgKEVtcGxveWVlMSBlIDogZXMxKXsKICAgICAgICAgICAgYXNzZXJ0RW1w\nbG95ZWUxKGUpOwogICAgICAgIH0KCiAgICAgICAgUXVlcnkgcTIgPSBlbS5j\ncmVhdGVRdWVyeSgic2VsZWN0IGUgZnJvbSBFbXBsb3llZTIgZSIpOwogICAg\nICAgIExpc3Q8RW1wbG95ZWUyPiBlczIgPSBxMi5nZXRSZXN1bHRMaXN0KCk7\nCiAgICAgICAgZm9yIChFbXBsb3llZTIgZSA6IGVzMil7CiAgICAgICAgICAg\nIGFzc2VydEVtcGxveWVlMihlKTsKICAgICAgICB9CgogICAgICAgIFF1ZXJ5\nIHEzID0gZW0uY3JlYXRlUXVlcnkoInNlbGVjdCBlIGZyb20gRW1wbG95ZWUz\nIGUiKTsKICAgICAgICBMaXN0PEVtcGxveWVlMz4gZXMzID0gcTMuZ2V0UmVz\ndWx0TGlzdCgpOwogICAgICAgIGZvciAoRW1wbG95ZWUzIGUgOiBlczMpewog\nICAgICAgICAgICBhc3NlcnRFbXBsb3llZTMoZSk7CiAgICAgICAgfQogICAg\nICAgIHRyYW4uY29tbWl0KCk7CiAgICAgICAgZW0uY2xvc2UoKTsKICAgIH0K\nICAgIAogICAgcHVibGljIHZvaWQgZmluZE9iak1hcEtleUNsYXNzKCkgewog\nICAgICAgIEVudGl0eU1hbmFnZXIgZW0gPSBlbWYuY3JlYXRlRW50aXR5TWFu\nYWdlcigpOwogICAgICAgIAogICAgICAgIEl0ZW0xIGl0ZW0xID0gZW0uZmlu\nZChJdGVtMS5jbGFzcywgMSk7CiAgICAgICAgYXNzZXJ0SXRlbTEoaXRlbTEp\nOwogICAgICAgIAogICAgICAgIEl0ZW0yIGl0ZW0yID0gZW0uZmluZChJdGVt\nMi5jbGFzcywgMyk7CiAgICAgICAgYXNzZXJ0SXRlbTIoaXRlbTIpOwogICAg\nICAgIAogICAgICAgIEl0ZW0zIGl0ZW0zID0gZW0uZmluZChJdGVtMy5jbGFz\ncywgNSk7CiAgICAgICAgYXNzZXJ0SXRlbTMoaXRlbTMpOwoKICAgICAgICBD\nb21wYW55MSBjMSA9IGVtLmZpbmQoQ29tcGFueTEuY2xhc3MsIDEpOwogICAg\nICAgIGFzc2VydENvbXBhbnkxKGMxKTsKICAgICAgICAKICAgICAgICBDb21w\nYW55MiBjMiA9IGVtLmZpbmQoQ29tcGFueTIuY2xhc3MsIDMpOwogICAgICAg\nIGFzc2VydENvbXBhbnkyKGMyKTsKCiAgICAgICAgRGl2aXNpb24gZCA9IGVt\nLmZpbmQoRGl2aXNpb24uY2xhc3MsIDEpOwogICAgICAgIGFzc2VydERpdmlz\naW9uKGQpOwogICAgICAgIAogICAgICAgIFZpY2VQcmVzaWRlbnQgdnAgPSBl\nbS5maW5kKFZpY2VQcmVzaWRlbnQuY2xhc3MsIDEpOwogICAgICAgIGFzc2Vy\ndFZpY2VQcmVzaWRlbnQodnApOwogICAgfQogICAgCiAgICBwdWJsaWMgdm9p\nZCBhc3NlcnRJdGVtMShJdGVtMSBpdGVtKSB7CiAgICAgICAgaW50IGlkID0g\naXRlbS5nZXRJZCgpOwogICAgICAgIE1hcCBpbWFnZXMgPSBpdGVtLmdldElt\nYWdlcygpOwogICAgICAgIGFzc2VydEVxdWFscyhudW1JbWFnZXNQZXJJdGVt\nLCBpbWFnZXMuc2l6ZSgpKTsKICAgIH0KICAgIAogICAgcHVibGljIHZvaWQg\nYXNzZXJ0SXRlbTIoSXRlbTIgaXRlbSkgewogICAgICAgIGludCBpZCA9IGl0\nZW0uZ2V0SWQoKTsKICAgICAgICBNYXAgaW1hZ2VzID0gaXRlbS5nZXRJbWFn\nZXMoKTsKICAgICAgICBhc3NlcnRFcXVhbHMobnVtSW1hZ2VzUGVySXRlbSwg\naW1hZ2VzLnNpemUoKSk7CiAgICB9CgogICAgcHVibGljIHZvaWQgYXNzZXJ0\nSXRlbTMoSXRlbTMgaXRlbSkgewogICAgICAgIGludCBpZCA9IGl0ZW0uZ2V0\nSWQoKTsKICAgICAgICBNYXAgaW1hZ2VzID0gaXRlbS5nZXRJbWFnZXMoKTsK\nICAgICAgICBhc3NlcnRFcXVhbHMobnVtSW1hZ2VzUGVySXRlbSwgaW1hZ2Vz\nLnNpemUoKSk7CiAgICB9CgogICAgcHVibGljIHZvaWQgYXNzZXJ0Q29tcGFu\neTEoQ29tcGFueTEgYykgewogICAgICAgIGludCBpZCA9IGMuZ2V0SWQoKTsK\nICAgICAgICBNYXAgb3JnYW5pemF0aW9uID0gYy5nZXRPcmdhbml6YXRpb24o\nKTsKICAgICAgICBhc3NlcnRFcXVhbHMoMixvcmdhbml6YXRpb24uc2l6ZSgp\nKTsKICAgIH0KICAgIAogICAgcHVibGljIHZvaWQgYXNzZXJ0Q29tcGFueTIo\nQ29tcGFueTIgYykgewogICAgICAgIGludCBpZCA9IGMuZ2V0SWQoKTsKICAg\nICAgICBNYXAgb3JnYW5pemF0aW9uID0gYy5nZXRPcmdhbml6YXRpb24oKTsK\nICAgICAgICBhc3NlcnRFcXVhbHMoMixvcmdhbml6YXRpb24uc2l6ZSgpKTsK\nICAgIH0gICAgCiAgICAKICAgIHB1YmxpYyB2b2lkIGFzc2VydERpdmlzaW9u\nKERpdmlzaW9uIGQpIHsKICAgICAgICBpbnQgaWQgPSBkLmdldElkKCk7CiAg\nICAgICAgU3RyaW5nIG5hbWUgPSBkLmdldE5hbWUoKTsKICAgIH0KCiAgICBw\ndWJsaWMgdm9pZCBhc3NlcnRWaWNlUHJlc2lkZW50KFZpY2VQcmVzaWRlbnQg\ndnApIHsKICAgICAgICBpbnQgaWQgPSB2cC5nZXRJZCgpOwogICAgICAgIFN0\ncmluZyBuYW1lID0gdnAuZ2V0TmFtZSgpOwogICAgfQoKICAgIHB1YmxpYyB2\nb2lkIHF1ZXJ5T2JqTWFwS2V5Q2xhc3MoKSB7CiAgICAgICAgcXVlcnlJdGVt\nKGVtZik7CiAgICAgICAgcXVlcnlDb21wYW55KGVtZik7CiAgICAgICAgcXVl\ncnlEaXZpc2lvbihlbWYpOwogICAgICAgIHF1ZXJ5VmljZVByZXNpZGVudChl\nbWYpOwogICAgfQogICAgCiAgICBwdWJsaWMgdm9pZCBmaW5kT2JqTWFwS2V5\nRW51bWVyYXRlZCgpIHsKICAgICAgICBFbnRpdHlNYW5hZ2VyIGVtID0gZW1m\nLmNyZWF0ZUVudGl0eU1hbmFnZXIoKTsKICAgICAgICBJdGVtNCBpdGVtID0g\nZW0uZmluZChJdGVtNC5jbGFzcywgMSk7CiAgICAgICAgRmlsZU5hbWU0IGZp\nbGVOYW1lMSA9IGl0ZW0uZ2V0SW1hZ2UoSXRlbTQuQ2F0YWdvcnkuQTEpOwog\nICAgICAgIGFzc2VydEVxdWFscygiZmlsZTEiLCBmaWxlTmFtZTEuZ2V0Rk5h\nbWUoKSk7ICAgICAgIAogICAgICAgIGFzc2VydEVxdWFscygiZmlsZTEiLCBm\naWxlTmFtZTEuZ2V0TE5hbWUoKSk7ICAgICAgIAogICAgICAgIAogICAgICAg\nIEZpbGVOYW1lNCBmaWxlTmFtZTIgPSBpdGVtLmdldEltYWdlKEl0ZW00LkNh\ndGFnb3J5LkEyKTsKICAgICAgICBhc3NlcnRFcXVhbHMoImZpbGUyIiwgZmls\nZU5hbWUyLmdldEZOYW1lKCkpOyAgICAgICAKICAgICAgICBhc3NlcnRFcXVh\nbHMoImZpbGUyIiwgZmlsZU5hbWUyLmdldExOYW1lKCkpOyAgICAgICAKICAg\nICAgICAKICAgICAgICBGaWxlTmFtZTQgZmlsZU5hbWUzID0gaXRlbS5nZXRJ\nbWFnZShJdGVtNC5DYXRhZ29yeS5BMyk7CiAgICAgICAgYXNzZXJ0RXF1YWxz\nKCJmaWxlMyIsIGZpbGVOYW1lMy5nZXRGTmFtZSgpKTsgICAgICAgCiAgICAg\nICAgYXNzZXJ0RXF1YWxzKCJmaWxlMyIsIGZpbGVOYW1lMy5nZXRMTmFtZSgp\nKTsgICAgICAgCiAgICB9CgogICAgcHVibGljIHZvaWQgZmluZE9iak1hcEtl\neVRlbXBvcmFsKCkgewogICAgICAgIEVudGl0eU1hbmFnZXIgZW0gPSBlbWYu\nY3JlYXRlRW50aXR5TWFuYWdlcigpOwogICAgICAgIEl0ZW01IGl0ZW0gPSBl\nbS5maW5kKEl0ZW01LmNsYXNzLCAxKTsKICAgICAgICBhc3NlcnRFcXVhbHMo\nMywgaXRlbS5nZXRJbWFnZXMoKS5zaXplKCkpOwogICAgfQogICAgCiAgICBw\ndWJsaWMgdm9pZCBxdWVyeU9iak1hcEtleVRlbXBvcmFsKCkgewogICAgICAg\nIEVudGl0eU1hbmFnZXIgZW0gPSBlbWYuY3JlYXRlRW50aXR5TWFuYWdlcigp\nOwogICAgICAgIFN0cmluZyBqcHFsID0gIlNFTEVDVCBWQUxVRShpbWcpIEZS\nT00gSXRlbTUgaXRlbSwgSU4gKGl0ZW0uaW1hZ2VzKSBpbWcgIiArIAogICAg\nICAgICAgICAiV0hFUkUgaW1nLmZOYW1lID0gOmZOYW1lIGFuZCBpdGVtLmlk\nID0gOmlkIjsKICAgICAgICBRdWVyeSBxID0gZW0uY3JlYXRlUXVlcnkoanBx\nbCk7CiAgICAgICAgcS5zZXRQYXJhbWV0ZXIoImZOYW1lIiwgImZpbGUxIik7\nCiAgICAgICAgcS5zZXRQYXJhbWV0ZXIoImlkIiwgMSk7CiAgICAgICAgTGlz\ndCBjb2xsID0gcS5nZXRSZXN1bHRMaXN0KCk7CiAgICAgICAgYXNzZXJ0RXF1\nYWxzKDEsIGNvbGwuc2l6ZSgpKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBx\ndWVyeUl0ZW0oRW50aXR5TWFuYWdlckZhY3RvcnkgZW1mKSB7CiAgICAgICAg\nRW50aXR5TWFuYWdlciBlbSA9IGVtZi5jcmVhdGVFbnRpdHlNYW5hZ2VyKCk7\nCiAgICAgICAgRW50aXR5VHJhbnNhY3Rpb24gdHJhbiA9IGVtLmdldFRyYW5z\nYWN0aW9uKCk7CiAgICAgICAgdHJhbi5iZWdpbigpOwogICAgICAgIFF1ZXJ5\nIHExID0gZW0uY3JlYXRlUXVlcnkoInNlbGVjdCBpIGZyb20gSXRlbTEgaSIp\nOwogICAgICAgIExpc3Q8SXRlbTE+IGlzMSA9IHExLmdldFJlc3VsdExpc3Qo\nKTsKICAgICAgICBmb3IgKEl0ZW0xIGl0ZW0gOiBpczEpewogICAgICAgICAg\nICBhc3NlcnRJdGVtMShpdGVtKTsKICAgICAgICB9CiAgICAgICAgCiAgICAg\nICAgUXVlcnkgcTIgPSBlbS5jcmVhdGVRdWVyeSgic2VsZWN0IGkgZnJvbSBJ\ndGVtMiBpIik7CiAgICAgICAgTGlzdDxJdGVtMj4gaXMyID0gcTIuZ2V0UmVz\ndWx0TGlzdCgpOwogICAgICAgIGZvciAoSXRlbTIgaXRlbSA6IGlzMil7CiAg\nICAgICAgICAgIGFzc2VydEl0ZW0yKGl0ZW0pOwogICAgICAgIH0KCiAgICAg\nICAgUXVlcnkgcTMgPSBlbS5jcmVhdGVRdWVyeSgic2VsZWN0IGkgZnJvbSBJ\ndGVtMyBpIik7CiAgICAgICAgTGlzdDxJdGVtMz4gaXMzID0gcTMuZ2V0UmVz\ndWx0TGlzdCgpOwogICAgICAgIGZvciAoSXRlbTMgaXRlbSA6IGlzMyl7CiAg\nICAgICAgICAgIGFzc2VydEl0ZW0zKGl0ZW0pOwogICAgICAgIH0KCiAgICAg\nICAgdHJhbi5jb21taXQoKTsKCiAgICAgICAgU3RyaW5nIGltYWdlS2V5MSA9\nIChTdHJpbmcpIGlzMS5nZXQoMCkuZ2V0SW1hZ2VzKCkuCiAgICAgICAgICAg\nIGtleVNldCgpLnRvQXJyYXkoKVswXTsKICAgICAgICBTdHJpbmcgaW1hZ2VL\nZXkyID0gKFN0cmluZykgaXMyLmdldCgwKS5nZXRJbWFnZXMoKS4KICAgICAg\nICAgICAga2V5U2V0KCkudG9BcnJheSgpWzBdOwogICAgICAgIFN0cmluZyBp\nbWFnZUtleTMgPSAoU3RyaW5nKSBpczMuZ2V0KDApLmdldEltYWdlcygpLgog\nICAgICAgICAgICBrZXlTZXQoKS50b0FycmF5KClbMF07CiAgICAgICAgU3Ry\naW5nW10gcXVlcnkgPSB7CiAgICAgICAgICAgICJzZWxlY3QgaSBmcm9tIEl0\nZW0xIGkiICsKICAgICAgICAgICAgICAgICIgd2hlcmUgPzEgPSBhbnkgIiAr\nCiAgICAgICAgICAgICAgICAiIChzZWxlY3QgS0VZKGUpIGZyb20gSXRlbTEg\naSwgaW4oaS5pbWFnZXMpIGUpICIgKwogICAgICAgICAgICAgICAgIiBvcmRl\nciBieSBpIiwKICAgICAgICAgICAgInNlbGVjdCBpIGZyb20gSXRlbTEgaSIg\nKwogICAgICAgICAgICAgICAgIiB3aGVyZSBleGlzdHMgIiArCiAgICAgICAg\nICAgICAgICAiIChzZWxlY3QgZSBmcm9tIEl0ZW0xIGksIGluKGkuaW1hZ2Vz\nKSBlIiArCiAgICAgICAgICAgICAgICAiICAgd2hlcmUgPzEgPSBLRVkoZSkp\nICIgKwogICAgICAgICAgICAgICAgIiBvcmRlciBieSBpIiwKICAgICAgICB9\nOwogICAgICAgIFN0cmluZ1tdIHF1ZXJ5MiA9IHsKICAgICAgICAgICAgInNl\nbGVjdCBpIGZyb20gSXRlbTIgaSIgKwogICAgICAgICAgICAgICAgIiB3aGVy\nZSA/MSA9IGFueSAiICsKICAgICAgICAgICAgICAgICIgKHNlbGVjdCBLRVko\nZSkgZnJvbSBJdGVtMiBpLCBpbihpLmltYWdlcykgZSkgIiArCiAgICAgICAg\nICAgICAgICAiIG9yZGVyIGJ5IGkiLAogICAgICAgICAgICAic2VsZWN0IGkg\nZnJvbSBJdGVtMiBpIiArCiAgICAgICAgICAgICAgICAiIHdoZXJlIGV4aXN0\ncyAiICsKICAgICAgICAgICAgICAgICIgKHNlbGVjdCBlIGZyb20gSXRlbTIg\naSwgaW4oaS5pbWFnZXMpIGUiICsKICAgICAgICAgICAgICAgICIgICB3aGVy\nZSA/MSA9IEtFWShlKSkgIiArCiAgICAgICAgICAgICAgICAiIG9yZGVyIGJ5\nIGkiLAogICAgICAgIH07CiAgICAgICAgU3RyaW5nW10gcXVlcnkzID0gewog\nICAgICAgICAgICAic2VsZWN0IGkgZnJvbSBJdGVtMyBpIiArCiAgICAgICAg\nICAgICAgICAiIHdoZXJlID8xID0gYW55ICIgKwogICAgICAgICAgICAgICAg\nIiAoc2VsZWN0IEtFWShlKSBmcm9tIEl0ZW0zIGksIGluKGkuaW1hZ2VzKSBl\nKSAiICsKICAgICAgICAgICAgICAgICIgb3JkZXIgYnkgaSIsCiAgICAgICAg\nICAgICJzZWxlY3QgaSBmcm9tIEl0ZW0zIGkiICsKICAgICAgICAgICAgICAg\nICIgd2hlcmUgZXhpc3RzICIgKwogICAgICAgICAgICAgICAgIiAoc2VsZWN0\nIGUgZnJvbSBJdGVtMyBpLCBpbihpLmltYWdlcykgZSIgKwogICAgICAgICAg\nICAgICAgIiAgIHdoZXJlID8xID0gS0VZKGUpKSAiICsKICAgICAgICAgICAg\nICAgICIgb3JkZXIgYnkgaSIsCiAgICAgICAgfTsKCiAgICAgICAgZm9yIChp\nbnQgaSA9IDA7IGkgPCBxdWVyeS5sZW5ndGg7IGkrKykgewogICAgICAgICAg\nICBRdWVyeSBxID0gZW0uY3JlYXRlUXVlcnkocXVlcnlbaV0pOwogICAgICAg\nICAgICBxLnNldFBhcmFtZXRlcigxLCBpbWFnZUtleTEpOwogICAgICAgICAg\nICBpczEgPSBxLmdldFJlc3VsdExpc3QoKTsKICAgICAgICAgICAgZm9yIChJ\ndGVtMSBpdGVtIDogaXMxKXsKICAgICAgICAgICAgICAgIGFzc2VydEl0ZW0x\nKGl0ZW0pOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGZvciAo\naW50IGkgPSAwOyBpIDwgcXVlcnkyLmxlbmd0aDsgaSsrKSB7CiAgICAgICAg\nICAgIFF1ZXJ5IHEgPSBlbS5jcmVhdGVRdWVyeShxdWVyeTJbaV0pOwogICAg\nICAgICAgICBxLnNldFBhcmFtZXRlcigxLCBpbWFnZUtleTIpOwogICAgICAg\nICAgICBpczIgPSBxLmdldFJlc3VsdExpc3QoKTsKICAgICAgICAgICAgZm9y\nIChJdGVtMiBpdGVtIDogaXMyKXsKICAgICAgICAgICAgICAgIGFzc2VydEl0\nZW0yKGl0ZW0pOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGZv\nciAoaW50IGkgPSAwOyBpIDwgcXVlcnkzLmxlbmd0aDsgaSsrKSB7CiAgICAg\nICAgICAgIFF1ZXJ5IHEgPSBlbS5jcmVhdGVRdWVyeShxdWVyeTNbaV0pOwog\nICAgICAgICAgICBxLnNldFBhcmFtZXRlcigxLCBpbWFnZUtleTMpOwogICAg\nICAgICAgICBpczMgPSBxLmdldFJlc3VsdExpc3QoKTsKICAgICAgICAgICAg\nZm9yIChJdGVtMyBpdGVtIDogaXMzKXsKICAgICAgICAgICAgICAgIGFzc2Vy\ndEl0ZW0zKGl0ZW0pOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAg\nIGVtLmNsb3NlKCk7CiAgICB9CgogICAgcHVibGljIHZvaWQgcXVlcnlDb21w\nYW55KEVudGl0eU1hbmFnZXJGYWN0b3J5IGVtZikgewogICAgICAgIEVudGl0\neU1hbmFnZXIgZW0gPSBlbWYuY3JlYXRlRW50aXR5TWFuYWdlcigpOwogICAg\nICAgIEVudGl0eVRyYW5zYWN0aW9uIHRyYW4gPSBlbS5nZXRUcmFuc2FjdGlv\nbigpOwogICAgICAgIHRyYW4uYmVnaW4oKTsKICAgICAgICBRdWVyeSBxMSA9\nIGVtLmNyZWF0ZVF1ZXJ5KCJzZWxlY3QgYyBmcm9tIENvbXBhbnkxIGMiKTsK\nICAgICAgICBMaXN0PENvbXBhbnkxPiBjczEgPSBxMS5nZXRSZXN1bHRMaXN0\nKCk7CiAgICAgICAgZm9yIChDb21wYW55MSBjIDogY3MxKXsKICAgICAgICAg\nICAgYXNzZXJ0Q29tcGFueTEoYyk7CiAgICAgICAgfQogICAgICAgIFF1ZXJ5\nIHEyID0gZW0uY3JlYXRlUXVlcnkoInNlbGVjdCBjIGZyb20gQ29tcGFueTIg\nYyIpOwogICAgICAgIExpc3Q8Q29tcGFueTI+IGNzMiA9IHEyLmdldFJlc3Vs\ndExpc3QoKTsKICAgICAgICBmb3IgKENvbXBhbnkyIGMgOiBjczIpewogICAg\nICAgICAgICBhc3NlcnRDb21wYW55MihjKTsKICAgICAgICB9CiAgICAgICAg\ndHJhbi5jb21taXQoKTsKCiAgICAgICAgZW0uY2xlYXIoKTsKICAgICAgICAv\nLyB0ZXN0IEtFWShlKSBpbiBzdWJxdWVyeQogICAgICAgIERpdmlzaW9uIGQx\nID0gKERpdmlzaW9uKSAoKENvbXBhbnkxKSBjczEuZ2V0KDApKS5nZXRPcmdh\nbml6YXRpb24oKS4KICAgICAgICAgICAga2V5U2V0KCkudG9BcnJheSgpWzBd\nOwogICAgICAgIERpdmlzaW9uIGQyID0gKERpdmlzaW9uKSAoKENvbXBhbnky\nKSBjczIuZ2V0KDApKS5nZXRPcmdhbml6YXRpb24oKS4KICAgICAgICAgICAg\na2V5U2V0KCkudG9BcnJheSgpWzBdOwogICAgICAgIFN0cmluZ1tdIHF1ZXJ5\nID0gewogICAgICAgICAgICAic2VsZWN0IGMgZnJvbSBDb21wYW55MSBjLCBp\nbihjLm9yZ2FuaXphdGlvbikgZCAiICsKICAgICAgICAgICAgICAgICIgd2hl\ncmUgS0VZKGQpID0gPzEiLAogICAgICAgICAgICAic2VsZWN0IGMgZnJvbSBD\nb21wYW55MSBjICIgKwogICAgICAgICAgICAgICAgIiB3aGVyZSA/MSA9ICIg\nKwogICAgICAgICAgICAgICAgIiAoc2VsZWN0IEtFWShkKSBmcm9tIENvbXBh\nbnkxIGMsIGluKGMub3JnYW5pemF0aW9uKSBkIiArCiAgICAgICAgICAgICAg\nICAiICAgd2hlcmUgZC5pZCA9IDEpIiArCiAgICAgICAgICAgICAgICAiIG9y\nZGVyIGJ5IGMgIiwgIAogICAgICAgICAgICAic2VsZWN0IGMgZnJvbSBDb21w\nYW55MSBjIHdoZXJlIGV4aXN0cyIgKwogICAgICAgICAgICAgICAgIiAoc2Vs\nZWN0IGQgZnJvbSBpbihjLm9yZ2FuaXphdGlvbikgZCIgKwogICAgICAgICAg\nICAgICAgIiAgd2hlcmUgS0VZKGQpID0gPzEpIiArCiAgICAgICAgICAgICAg\nICAiIG9yZGVyIGJ5IGMgIiwgIAogICAgICAgICAgICAic2VsZWN0IGMgZnJv\nbSBDb21wYW55MSBjIHdoZXJlIGV4aXN0cyIgKwogICAgICAgICAgICAgICAg\nIiAoc2VsZWN0IGQgZnJvbSBjLm9yZ2FuaXphdGlvbiBkIiArCiAgICAgICAg\nICAgICAgICAiICB3aGVyZSBLRVkoZCkgPSA/MSkiICsKICAgICAgICAgICAg\nICAgICIgb3JkZXIgYnkgYyAiLCAgCiAgICAgICAgfTsKICAgICAgICBmb3Ig\nKGludCBpID0gMDsgaSA8IHF1ZXJ5Lmxlbmd0aDsgaSsrKSB7CiAgICAgICAg\nICAgIFF1ZXJ5IHEgPSBlbS5jcmVhdGVRdWVyeShxdWVyeVtpXSk7CiAgICAg\nICAgICAgIHEuc2V0UGFyYW1ldGVyKDEsIGQxKTsKICAgICAgICAgICAgY3Mx\nID0gcS5nZXRSZXN1bHRMaXN0KCk7CiAgICAgICAgICAgIGZvciAoQ29tcGFu\neTEgYyA6IGNzMSl7CiAgICAgICAgICAgICAgICBhc3NlcnRDb21wYW55MShj\nKTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgU3RyaW5nW10g\ncXVlcnkyID0gewogICAgICAgICAgICAic2VsZWN0IGMgZnJvbSBDb21wYW55\nMiBjIiArCiAgICAgICAgICAgICAgICAiIHdoZXJlID8xID0gIiArCiAgICAg\nICAgICAgICAgICAiIChzZWxlY3QgS0VZKGQpIGZyb20gQ29tcGFueTIgYywg\naW4oYy5vcmdhbml6YXRpb24pIGQiICsKICAgICAgICAgICAgICAgICIgICB3\naGVyZSBkLmlkID0gMykiICsKICAgICAgICAgICAgICAgICIgb3JkZXIgYnkg\nYyAiLCAgCiAgICAgICAgICAgICJzZWxlY3QgYyBmcm9tIENvbXBhbnkyIGMg\nd2hlcmUgZXhpc3RzIiArCiAgICAgICAgICAgICAgICAiIChzZWxlY3QgZCBm\ncm9tIGluKGMub3JnYW5pemF0aW9uKSBkIiArCiAgICAgICAgICAgICAgICAi\nICB3aGVyZSBLRVkoZCkgPSA/MSkiICsKICAgICAgICAgICAgICAgICIgb3Jk\nZXIgYnkgYyAiLCAgCiAgICAgICAgICAgICJzZWxlY3QgYyBmcm9tIENvbXBh\nbnkyIGMgd2hlcmUgZXhpc3RzIiArCiAgICAgICAgICAgICAgICAiIChzZWxl\nY3QgZCBmcm9tIGMub3JnYW5pemF0aW9uIGQiICsKICAgICAgICAgICAgICAg\nICIgIHdoZXJlIEtFWShkKSA9ID8xKSIgKwogICAgICAgICAgICAgICAgIiBv\ncmRlciBieSBjICIsICAKICAgICAgICB9OwoKICAgICAgICBmb3IgKGludCBp\nID0gMDsgaSA8IHF1ZXJ5Mi5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBR\ndWVyeSBxID0gZW0uY3JlYXRlUXVlcnkocXVlcnkyW2ldKTsKICAgICAgICAg\nICAgcS5zZXRQYXJhbWV0ZXIoMSwgZDIpOwogICAgICAgICAgICBjczIgPSBx\nLmdldFJlc3VsdExpc3QoKTsKICAgICAgICAgICAgZm9yIChDb21wYW55MiBj\nIDogY3MyKXsKICAgICAgICAgICAgICAgIGFzc2VydENvbXBhbnkyKGMpOwog\nICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGVtLmNsb3NlKCk7CiAg\nICB9CgogICAgcHVibGljIHZvaWQgcXVlcnlEaXZpc2lvbihFbnRpdHlNYW5h\nZ2VyRmFjdG9yeSBlbWYpIHsKICAgICAgICBFbnRpdHlNYW5hZ2VyIGVtID0g\nZW1mLmNyZWF0ZUVudGl0eU1hbmFnZXIoKTsKICAgICAgICBFbnRpdHlUcmFu\nc2FjdGlvbiB0cmFuID0gZW0uZ2V0VHJhbnNhY3Rpb24oKTsKICAgICAgICB0\ncmFuLmJlZ2luKCk7CiAgICAgICAgUXVlcnkgcSA9IGVtLmNyZWF0ZVF1ZXJ5\nKCJzZWxlY3QgZCBmcm9tIERpdmlzaW9uIGQiKTsKICAgICAgICBMaXN0PERp\ndmlzaW9uPiBkcyA9IHEuZ2V0UmVzdWx0TGlzdCgpOwogICAgICAgIGZvciAo\nRGl2aXNpb24gZCA6IGRzKXsKICAgICAgICAgICAgYXNzZXJ0RGl2aXNpb24o\nZCk7CiAgICAgICAgfQogICAgICAgIHRyYW4uY29tbWl0KCk7CiAgICAgICAg\nZW0uY2xvc2UoKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBxdWVyeVZpY2VQ\ncmVzaWRlbnQoRW50aXR5TWFuYWdlckZhY3RvcnkgZW1mKSB7CiAgICAgICAg\nRW50aXR5TWFuYWdlciBlbSA9IGVtZi5jcmVhdGVFbnRpdHlNYW5hZ2VyKCk7\nCiAgICAgICAgRW50aXR5VHJhbnNhY3Rpb24gdHJhbiA9IGVtLmdldFRyYW5z\nYWN0aW9uKCk7CiAgICAgICAgdHJhbi5iZWdpbigpOwogICAgICAgIFF1ZXJ5\nIHEgPSBlbS5jcmVhdGVRdWVyeSgic2VsZWN0IHZwIGZyb20gVmljZVByZXNp\nZGVudCB2cCIpOwogICAgICAgIExpc3Q8VmljZVByZXNpZGVudD4gdnBzID0g\ncS5nZXRSZXN1bHRMaXN0KCk7CiAgICAgICAgZm9yIChWaWNlUHJlc2lkZW50\nIHZwIDogdnBzKXsKICAgICAgICAgICAgYXNzZXJ0VmljZVByZXNpZGVudCh2\ncCk7CiAgICAgICAgfQogICAgICAgIHRyYW4uY29tbWl0KCk7CiAgICAgICAg\nZW0uY2xvc2UoKTsKICAgIH0KICAgIAogICAgLyoqCiAgICAgKiBUbyBydW4g\ndGhpcyBtZXRob2Qgb24gT3JhY2xlIHJlcXVpcmVzIHRoZSB1c2VyIHRvIGhh\ndmUgdGhlIGF1dGhvcml0eQogICAgICogdG8gY3JlYXRlIHRyaWdnZXJzLiAg\nZXguICBHUkFOVCBDUkVBVEUgVFJJR0dFUiBUTyAiU0NPVFQiCiAgICAgKi8K\nICAgIHB1YmxpYyB2b2lkIGNyZWF0ZUVtYmVkZGFibGVDb250YWluaW5nUmVs\nYXRpb25XaXRoR2VuZXJhdGVkS2V5KCkgCiAgICAgICAgdGhyb3dzIElPRXhj\nZXB0aW9uLCBTUUxFeGNlcHRpb24gewogICAgICAgIEVudGl0eU1hbmFnZXIg\nZW0gPSBlbWYuY3JlYXRlRW50aXR5TWFuYWdlcigpOwogICAgICAgIAogICAg\nICAgIE9wZW5KUEFFbnRpdHlNYW5hZ2VyU1BJIG9qZW0gPSAoT3BlbkpQQUVu\ndGl0eU1hbmFnZXJTUEkpZW07CiAgICAgICAgSkRCQ0NvbmZpZ3VyYXRpb24g\nY29uZiA9IChKREJDQ29uZmlndXJhdGlvbikgb2plbS5nZXRDb25maWd1cmF0\naW9uKCk7CiAgICAgICAgREJEaWN0aW9uYXJ5IGRpY3QgPSBjb25mLmdldERC\nRGljdGlvbmFyeUluc3RhbmNlKCk7CiAgICAgICAgaWYgKGRpY3QgaW5zdGFu\nY2VvZiBPcmFjbGVEaWN0aW9uYXJ5KSB7CiAgICAgICAgICAgIHJlY3JlYXRl\nT3JhY2xlQXJ0aWZhY3RzKChPcmFjbGVEaWN0aW9uYXJ5KWRpY3QsIGNvbmYp\nOyAgICAgICAgICAgICAgICAKICAgICAgICB9CiAgICAgICAgRW50aXR5VHJh\nbnNhY3Rpb24gdHJhbiA9IGVtLmdldFRyYW5zYWN0aW9uKCk7CiAgICAgICAg\nCiAgICAgICAgQm9vayBiID0gbmV3IEJvb2soMTU5MDU5NjQ1NSk7CiAgICAg\nICAgU2VsbGVyIGJvYiA9IG5ldyBTZWxsZXIoIkJvYidzIGJvb2tzISIpOwog\nICAgICAgIFNlbGxlciBqaW0gPSBuZXcgU2VsbGVyKCJKaW0ncyBib29rcyEi\nKTsKICAgICAgICBTZWxsZXIgbWlrZSA9IG5ldyBTZWxsZXIoIk1pa2VzJ3Mg\nYm9va3MhIik7CiAgICAgICAgYi5hZGRMaXN0aW5nKG5ldyBMaXN0aW5nKGJv\nYiAsIDQ0LjE1KSk7CiAgICAgICAgYi5hZGRMaXN0aW5nKG5ldyBMaXN0aW5n\nKGppbSAsIDM0LjE1KSk7CiAgICAgICAgYi5hZGRMaXN0aW5nKG5ldyBMaXN0\naW5nKG1pa2UgLCAxNC4xNSkpOwogICAgICAgIGVtLmdldFRyYW5zYWN0aW9u\nKCkuYmVnaW4oKTsKICAgICAgICBlbS5wZXJzaXN0KGIpOwogICAgICAgIGVt\nLmdldFRyYW5zYWN0aW9uKCkuY29tbWl0KCk7CiAgICAgICAgaW50IGlkID0g\nYi5nZXRJZCgpOwogICAgICAgIGVtLmNsZWFyKCk7CiAgICAgICAgQm9vayBi\nMiA9IGVtLmZpbmQoQm9vay5jbGFzcywgaWQpOwogICAgICAgIFNldDxMaXN0\naW5nPiBsaXN0aW5ncyA9IGIyLmdldExpc3RpbmdzKCk7CiAgICAgICAgZm9y\nIChMaXN0aW5nIGxpc3RpbmcgOiBsaXN0aW5ncykgewogICAgICAgICAgICBT\nZWxsZXIgc2VsbGVyID0gbGlzdGluZy5nZXRTZWxsZXIoKTsKICAgICAgICAg\nICAgYXNzZXJ0Tm90TnVsbChzZWxsZXIpOwogICAgICAgICAgICBhc3NlcnRU\ncnVlKHNlbGxlci5nZXRJZCgpICE9IDApOwogICAgICAgIH0KICAgIH0KCiAg\nICAvKgogICAgICogVGhpcyBtZXRob2QgdXNlcyB0aGUgbWFwcGluZyB0b29s\nIHRvIHJlZ2VuZXJhdGUgT3JhY2xlIGRiIGFydGlmYWN0cwogICAgICogd2l0\naCB0aGUgdXNlVHJpZ2dlcnNGb3JBdXRvQXNzaWduIGRiIG9wdGlvbiBlbmFi\nbGVkLgogICAgICovCiAgICBwcml2YXRlIHZvaWQgcmVjcmVhdGVPcmFjbGVB\ncnRpZmFjdHMoT3JhY2xlRGljdGlvbmFyeSBkaWN0LCAKICAgICAgICBKREJD\nQ29uZmlndXJhdGlvbiBjb25mKSB0aHJvd3MgSU9FeGNlcHRpb24sIFNRTEV4\nY2VwdGlvbiB7CiAgICAgICAgZGljdC51c2VUcmlnZ2Vyc0ZvckF1dG9Bc3Np\nZ24gPSB0cnVlOwogICAgICAgIEZsYWdzIGZsYWdzID0gbmV3IE1hcHBpbmdU\nb29sLkZsYWdzKCk7CiAgICAgICAgZmxhZ3MuZHJvcFRhYmxlcyA9IHRydWU7\nCiAgICAgICAgZmxhZ3Muc2NoZW1hQWN0aW9uID0gImRyb3AsYWRkIjsKICAg\nICAgICBmbGFncy5zZXF1ZW5jZXMgPSB0cnVlOwogICAgICAgIGZsYWdzLmln\nbm9yZUVycm9ycyA9IHRydWU7CiAgICAgICAgZmxhZ3MuZHJvcFNlcXVlbmNl\ncyA9IHRydWU7CiAgICAgICAgTWFwcGluZ1Rvb2wucnVuKCAKICAgICAgICAg\nICAgY29uZiwgCiAgICAgICAgICAgIG5ldyBTdHJpbmdbXSB7ICJvcmcuYXBh\nY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuZW1iZWQuQm9vayIgfSwKICAgICAg\nICAgICAgZmxhZ3MsCiAgICAgICAgICAgIGNvbmYuZ2V0Q2xhc3NSZXNvbHZl\nckluc3RhbmNlKCkuCiAgICAgICAgICAgIGdldENsYXNzTG9hZGVyKE1hcHBp\nbmdUb29sLmNsYXNzLCBudWxsKSk7ICAgICAgICAKICAgIH0KCiAgICAvKgog\nICAgICogRW50aXR5QV9FbWJlZF9Db21wbGV4IHJvdXRpbmVzCiAgICAgKi8K\nICAgIHB1YmxpYyB2b2lkIHRlc3RFbnRpdHlBX0VtYmVkX0NvbXBsZXgoKSB7\nCiAgICAgICAgZ2V0TG9nKCkudHJhY2UoInRlc3RFbnRpdHlBX0VtYmVkX0Nv\nbXBsZXgoKSAtIGVudGVyZWQiKTsKICAgICAgICBjcmVhdGVFbnRpdHlBX0Vt\nYmVkX0NvbXBsZXgobnVsbCk7CiAgICAgICAgcXVlcnlFbnRpdHlBX0VtYmVk\nX0NvbXBsZXgobnVsbCk7CiAgICAgICAgZmluZEVudGl0eUFfRW1iZWRfQ29t\ncGxleChudWxsKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCB0ZXN0RW50aXR5\nQV9FbWJlZF9Db21wbGV4MigpIHsKICAgICAgICBnZXRMb2coKS50cmFjZSgi\ndGVzdEVudGl0eUFfRW1iZWRfQ29tcGxleDIoKSAtIGVudGVyZWQiKTsKICAg\nICAgICBFbnRpdHlNYW5hZ2VyIGVtID0gZW1mLmNyZWF0ZUVudGl0eU1hbmFn\nZXIoKTsKICAgICAgICBlbS5jbGVhcigpOwogICAgICAgIGNyZWF0ZUVudGl0\neUFfRW1iZWRfQ29tcGxleChlbSk7CiAgICAgICAgZW0uY2xlYXIoKTsKICAg\nICAgICAvL3F1ZXJ5RW50aXR5QV9FbWJlZF9Db21wbGV4KGVtKTsKICAgICAg\nICAvL2VtLmNsZWFyKCk7CiAgICAgICAgZmluZEVudGl0eUFfRW1iZWRfQ29t\ncGxleChlbSk7CiAgICAgICAgZW0uY2xlYXIoKTsKICAgICAgICB1cGRhdGVF\nbnRpdHlBX0VtYmVkX0NvbXBsZXgoZW0pOwogICAgICAgIGVtLmNsZWFyKCk7\nCiAgICAgICAgZmluZEVudGl0eUFfRW1iZWRfQ29tcGxleChlbSk7CiAgICAg\nICAgZW0uY2xlYXIoKTsKICAgICAgICByZW1vdmVFbnRpdHlBX0VtYmVkX0Nv\nbXBsZXgoZW0pOwogICAgICAgIGVtLmNsb3NlKCk7CiAgICB9CgogICAgcHVi\nbGljIHZvaWQgY3JlYXRlRW50aXR5QV9FbWJlZF9Db21wbGV4KEVudGl0eU1h\nbmFnZXIgZW0pIHsKICAgICAgICBCb29sZWFuIGVtQ2xvc2UgPSBmYWxzZTsK\nICAgICAgICBpZiAoZW0gPT0gbnVsbCkgewogICAgICAgICAgICBlbSA9IGVt\nZi5jcmVhdGVFbnRpdHlNYW5hZ2VyKCk7CiAgICAgICAgICAgIGVtQ2xvc2Ug\nPSB0cnVlOwogICAgICAgIH0KICAgICAgICBlbS5nZXRUcmFuc2FjdGlvbigp\nLmJlZ2luKCk7CiAgICAgICAgY3JlYXRlRW50aXR5QV9FbWJlZF9Db21wbGV4\nKGVtLCBJRCk7CiAgICAgICAgLy9lbS5nZXRUcmFuc2FjdGlvbigpLmJlZ2lu\nKCk7CiAgICAgICAgZW0uZmx1c2goKTsKICAgICAgICBlbS5nZXRUcmFuc2Fj\ndGlvbigpLmNvbW1pdCgpOwogICAgICAgIGlmIChlbUNsb3NlKSB7CiAgICAg\nICAgICAgIGVtLmNsb3NlKCk7CiAgICAgICAgfQogICAgfQoKICAgIHB1Ymxp\nYyB2b2lkIGNyZWF0ZUVudGl0eUFfRW1iZWRfQ29tcGxleChFbnRpdHlNYW5h\nZ2VyIGVtLCBpbnQgaWQpIHsKICAgICAgICBnZXRMb2coKS50cmFjZSgiY3Jl\nYXRlRW50aXR5QV9FbWJlZF9Db21wbGV4KCkgLSBlbnRlcmVkIik7CiAgICAg\nICAgRW50aXR5QV9FbWJlZF9Db21wbGV4IGEgPSBuZXcgRW50aXR5QV9FbWJl\nZF9Db21wbGV4KCk7CiAgICAgICAgYS5zZXRJZChpZCk7CiAgICAgICAgYS5z\nZXROYW1lKCJhIiArIGlkKTsKICAgICAgICBhLnNldEFnZShpZCk7CiAgICAg\nICAgZm9yIChpbnQgaSA9IDA7IGkgPCBudW1CYXNpY1R5cGVzOyBpKyspIHsK\nICAgICAgICAgICAgYS5hZGROaWNrTmFtZSgibmlja05hbWVfIiArIGlkICsg\naSk7CiAgICAgICAgfQogICAgICAgIGEuYWRkQ3JlZGl0UmF0aW5nKEVudGl0\neUFfRW1iZWRfQ29tcGxleC5DcmVkaXRSYXRpbmcuUE9PUik7CiAgICAgICAg\nYS5hZGRUaW1lc3RhbXAobmV3IFRpbWVzdGFtcChjYWwuZ2V0VGltZUluTWls\nbGlzKCkpKTsKICAgICAgICBhLmFkZExvYigibG9iXzAiKTsKICAgICAgICBh\nLnNldEVtYmVkKGNyZWF0ZUVtYmVkX0VtYmVkKGVtLCBudW1FbWJlZGRhYmxl\ncywgMCkpOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgbnVtRW1iZWRk\nYWJsZXM7IGkrKykgewogICAgICAgICAgICBFbWJlZF9FbWJlZCBlbWJlZCA9\nIGNyZWF0ZUVtYmVkX0VtYmVkKGVtLCBpZCwgaSk7CiAgICAgICAgICAgIGEu\nYWRkRW1iZWQoZW1iZWQpOwogICAgICAgIH0KICAgICAgICBmb3IgKGludCBp\nID0gMDsgaSA8IG51bUVtYmVkZGFibGVzOyBpKyspIHsKICAgICAgICAgICAg\nRW1iZWRfVG9PbmUgZW1iZWQgPSBjcmVhdGVFbWJlZF9Ub09uZShlbSwgaStp\nZCk7CiAgICAgICAgICAgIGEuYWRkRW1iZWQxVG9PbmVzKGVtYmVkKTsKICAg\nICAgICB9CiAgICAgICAgYS5zZXRUcmFuc2llbnRKYXZhVmFsdWUodGltZUhh\nc2gpOwogICAgICAgIGEuc2V0VHJhbnNpZW50VmFsdWUodGltZUhhc2gpOwog\nICAgICAgIGVtLnBlcnNpc3QoYSk7CiAgICB9CgogICAgcHVibGljIHZvaWQg\nY2hlY2tFbnRpdHlBX0VtYmVkX0NvbXBsZXgoRW50aXR5QV9FbWJlZF9Db21w\nbGV4IGEpIHsKICAgICAgICBnZXRMb2coKS50cmFjZSgiY2hlY2tFbnRpdHlB\nX0VtYmVkX0NvbXBsZXgoKSAtIGVudGVyZWQiKTsKICAgICAgICBpbnQgaWQg\nPSBhLmdldElkKCk7CiAgICAgICAgU3RyaW5nIG5hbWUgPSBhLmdldE5hbWUo\nKTsKICAgICAgICBpbnQgYWdlID0gYS5nZXRBZ2UoKTsKICAgICAgICBhc3Nl\ncnRFcXVhbHMoSUQsIGlkKTsKICAgICAgICBhc3NlcnRFcXVhbHMoImEiICsg\naWQgLG5hbWUpOwogICAgICAgIGFzc2VydEVxdWFscyhJRCwgYWdlKTsKICAg\nICAgICBTZXQ8U3RyaW5nPiBuaWNrTmFtZXMgPSBhLmdldE5pY2tOYW1lcygp\nOwogICAgICAgIGZvciAoU3RyaW5nIG5pY2tOYW1lIDogbmlja05hbWVzKSB7\nCiAgICAgICAgICAgIGFzc2VydEVxdWFscygibmlja05hbWVfIiArIGlkICsg\nIjAiLCBuaWNrTmFtZSk7CiAgICAgICAgfQogICAgICAgIExpc3Q8RW50aXR5\nQV9FbWJlZF9Db21wbGV4LkNyZWRpdFJhdGluZz4gY3IgPSBhLmdldENyZWRp\ndFJhdGluZygpOwogICAgICAgIGZvciAoRW50aXR5QV9FbWJlZF9Db21wbGV4\nLkNyZWRpdFJhdGluZyBjIDogY3IpIHsKICAgICAgICAgICAgYXNzZXJ0RXF1\nYWxzKCJQT09SIiwgYy50b1N0cmluZygpKTsKICAgICAgICB9CiAgICAgICAg\nTGlzdDxUaW1lc3RhbXA+IHRzdGFtcHMgPSBhLmdldFRpbWVzdGFtcHMoKTsK\nICAgICAgICBmb3IgKFRpbWVzdGFtcCB0cyA6IHRzdGFtcHMpIHsKICAgICAg\nICAgICAgYXNzZXJ0Tm90RXF1YWxzKDAsIHRzLmdldFRpbWUoKSk7CiAgICAg\nICAgfQogICAgICAgIExpc3Q8U3RyaW5nPiBsb2JzID0gYS5nZXRMb2JzKCk7\nCiAgICAgICAgaW50IGkgPSAwOwogICAgICAgIGZvciAoU3RyaW5nIGxvYiA6\nIGxvYnMpIHsKICAgICAgICAgICAgYXNzZXJ0RXF1YWxzKCJsb2JfIiArIGkr\nKywgbG9iKTsKICAgICAgICB9CiAgICAgICAgRW1iZWRfRW1iZWQgZW1iZWRk\nZWQgPSBhLmdldEVtYmVkKCk7CiAgICAgICAgY2hlY2tFbWJlZF9FbWJlZChl\nbWJlZGRlZCk7CiAgICAgICAgTGlzdDxFbWJlZF9FbWJlZD4gZW1iZWRzID0g\nYS5nZXRFbWJlZHMoKTsKICAgICAgICBmb3IgKEVtYmVkX0VtYmVkIGVtYmVk\nIDogZW1iZWRzKSB7CiAgICAgICAgICAgIGNoZWNrRW1iZWRfRW1iZWQoZW1i\nZWQpOwogICAgICAgIH0KICAgICAgICBTZXQ8RW1iZWRfVG9PbmU+IGVtYmVk\nT25lcyA9IGEuZ2V0RW1iZWQxVG9PbmVzKCk7CiAgICAgICAgZm9yIChFbWJl\nZF9Ub09uZSBlbWJlZCA6IGVtYmVkT25lcykgewogICAgICAgICAgICBjaGVj\na0VtYmVkX1RvT25lKGVtYmVkKTsKICAgICAgICB9CiAgICAgICAgYXNzZXJ0\nTm90RXF1YWxzKGEuZ2V0VHJhbnNpZW50SmF2YVZhbHVlKCksIHRpbWVIYXNo\nKTsKICAgICAgICBhc3NlcnROb3RFcXVhbHMoYS5nZXRUcmFuc2llbnRWYWx1\nZSgpLCB0aW1lSGFzaCk7CiAgICB9CgogICAgcHVibGljIHZvaWQgZmluZEVu\ndGl0eUFfRW1iZWRfQ29tcGxleChFbnRpdHlNYW5hZ2VyIGVtKSB7CiAgICAg\nICAgQm9vbGVhbiBlbUNsb3NlID0gZmFsc2U7CiAgICAgICAgZ2V0TG9nKCku\ndHJhY2UoImZpbmRFbnRpdHlBX0VtYmVkX0NvbXBsZXgoKSAtIGVudGVyZWQi\nKTsKICAgICAgICBpZiAoZW0gPT0gbnVsbCkgewogICAgICAgICAgICBlbSA9\nIGVtZi5jcmVhdGVFbnRpdHlNYW5hZ2VyKCk7CiAgICAgICAgICAgIGVtQ2xv\nc2UgPSB0cnVlOwogICAgICAgIH0KICAgICAgICBFbnRpdHlBX0VtYmVkX0Nv\nbXBsZXggYSA9IGVtLmZpbmQoRW50aXR5QV9FbWJlZF9Db21wbGV4LmNsYXNz\nLCBJRCk7CiAgICAgICAgY2hlY2tFbnRpdHlBX0VtYmVkX0NvbXBsZXgoYSk7\nCiAgICAgICAgaWYgKGVtQ2xvc2UpIHsKICAgICAgICAgICAgZW0uY2xvc2Uo\nKTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGljIHZvaWQgdXBkYXRlRW50\naXR5QV9FbWJlZF9Db21wbGV4KEVudGl0eU1hbmFnZXIgZW0pIHsKICAgICAg\nICBCb29sZWFuIGVtQ2xvc2UgPSBmYWxzZTsKICAgICAgICBnZXRMb2coKS50\ncmFjZSgidXBkYXRlRW50aXR5QV9FbWJlZF9Db21wbGV4KCkgLSBlbnRlcmVk\nIik7CiAgICAgICAgaWYgKGVtID09IG51bGwpIHsKICAgICAgICAgICAgZW0g\nPSBlbWYuY3JlYXRlRW50aXR5TWFuYWdlcigpOwogICAgICAgICAgICBlbUNs\nb3NlID0gdHJ1ZTsKICAgICAgICB9CiAgICAgICAgZW0uZ2V0VHJhbnNhY3Rp\nb24oKS5iZWdpbigpOwogICAgICAgIEVudGl0eUFfRW1iZWRfQ29tcGxleCBh\nID0gZW0uZmluZChFbnRpdHlBX0VtYmVkX0NvbXBsZXguY2xhc3MsIElEKTsK\nICAgICAgICBjaGVja0VudGl0eUFfRW1iZWRfQ29tcGxleChhKTsKICAgICAg\nICBmb3IgKGludCBpID0gMTsgaSA8IG51bUVtYmVkZGFibGVzOyBpKyspIHsK\nICAgICAgICAgICAgYS5hZGRMb2IoImxvYl8iICsgaSk7CiAgICAgICAgfQog\nICAgICAgIGEuc2V0VHJhbnNpZW50SmF2YVZhbHVlKDIwMDkpOwogICAgICAg\nIGEuc2V0VHJhbnNpZW50VmFsdWUoMjAwOSk7CiAgICAgICAgZW0ucGVyc2lz\ndChhKTsKICAgICAgICBlbS5mbHVzaCgpOwogICAgICAgIGVtLmdldFRyYW5z\nYWN0aW9uKCkuY29tbWl0KCk7CiAgICAgICAgaWYgKGVtQ2xvc2UpIHsKICAg\nICAgICAgICAgZW0uY2xvc2UoKTsKICAgICAgICB9CiAgICB9CgogICAgcHVi\nbGljIHZvaWQgcmVtb3ZlRW50aXR5QV9FbWJlZF9Db21wbGV4KEVudGl0eU1h\nbmFnZXIgZW0pIHsKICAgICAgICBCb29sZWFuIGVtQ2xvc2UgPSBmYWxzZTsK\nICAgICAgICBnZXRMb2coKS50cmFjZSgicmVtb3ZlRW50aXR5QV9FbWJlZF9D\nb21wbGV4KCkgLSBlbnRlcmVkIik7CiAgICAgICAgaWYgKGVtID09IG51bGwp\nIHsKICAgICAgICAgICAgZW0gPSBlbWYuY3JlYXRlRW50aXR5TWFuYWdlcigp\nOwogICAgICAgICAgICBlbUNsb3NlID0gdHJ1ZTsKICAgICAgICB9CiAgICAg\nICAgZW0uZ2V0VHJhbnNhY3Rpb24oKS5iZWdpbigpOwogICAgICAgIEVudGl0\neUFfRW1iZWRfQ29tcGxleCBhID0gZW0uZmluZChFbnRpdHlBX0VtYmVkX0Nv\nbXBsZXguY2xhc3MsIElEKTsKICAgICAgICBjaGVja0VudGl0eUFfRW1iZWRf\nQ29tcGxleChhKTsKICAgICAgICBlbS5yZW1vdmUoYSk7CiAgICAgICAgZW0u\nZmx1c2goKTsKICAgICAgICBlbS5nZXRUcmFuc2FjdGlvbigpLmNvbW1pdCgp\nOwogICAgICAgIGVtLmNsZWFyKCk7CiAgICAgICAgYSA9IGVtLmZpbmQoRW50\naXR5QV9FbWJlZF9Db21wbGV4LmNsYXNzLCBJRCk7CiAgICAgICAgYXNzZXJ0\nTnVsbCgiRW50aXR5IHNob3VsZCBubyBsb25nZXIgZXhpc3QiLCBhKTsKICAg\nICAgICBpZiAoZW1DbG9zZSkgewogICAgICAgICAgICBlbS5jbG9zZSgpOwog\nICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMgdm9pZCBxdWVyeUVudGl0eUFf\nRW1iZWRfQ29tcGxleChFbnRpdHlNYW5hZ2VyIGVtKSB7CiAgICAgICAgQm9v\nbGVhbiBlbUNsb3NlID0gZmFsc2U7CiAgICAgICAgZ2V0TG9nKCkudHJhY2Uo\nInF1ZXJ5RW50aXR5QV9FbWJlZF9Db21wbGV4KCkgLSBlbnRlcmVkIik7CiAg\nICAgICAgaWYgKGVtID09IG51bGwpIHsKICAgICAgICAgICAgZW0gPSBlbWYu\nY3JlYXRlRW50aXR5TWFuYWdlcigpOwogICAgICAgICAgICBlbUNsb3NlID0g\ndHJ1ZTsKICAgICAgICB9CiAgICAgICAgU3RyaW5nW10gcXVlcnkgPSB7CiAg\nICAgICAgICAgICJzZWxlY3QgZSBmcm9tICIgKwogICAgICAgICAgICAgICAg\nIiBFbnRpdHlBX0VtYmVkX0NvbXBsZXggYSAiICsKICAgICAgICAgICAgICAg\nICIgLCBpbiAoYS5uaWNrTmFtZXMpIGUgb3JkZXIgYnkgYS5pZCIsCiAgICAg\nICAgICAgICJzZWxlY3QgZSBmcm9tICIgKwogICAgICAgICAgICAgICAgIiBF\nbnRpdHlBX0VtYmVkX0NvbXBsZXggYSAiICsKICAgICAgICAgICAgICAgICIg\nLCBpbiAoYS5uaWNrTmFtZXMpIGUgb3JkZXIgYnkgYS5pZCIsCiAgICAgICAg\nICAgICJzZWxlY3QgZSBmcm9tICIgKwogICAgICAgICAgICAgICAgIiBFbnRp\ndHlBX0VtYmVkX0NvbXBsZXggYSAiICsKICAgICAgICAgICAgICAgICIgLCBp\nbiAoYS5uaWNrTmFtZXMpIGUgb3JkZXIgYnkgZSIsCiAgICAgICAgICAgICJz\nZWxlY3QgYSBmcm9tICIgKwogICAgICAgICAgICAgICAgIiBFbnRpdHlBX0Vt\nYmVkX0NvbXBsZXggYSAiICsKICAgICAgICAgICAgICAgICIgV0hFUkUgYS5u\naWNrTmFtZXMgSVMgRU1QVFkgb3JkZXIgYnkgYSIsCiAgICAgICAgICAgICJz\nZWxlY3QgYSBmcm9tICIgKwogICAgICAgICAgICAgICAgIiBFbnRpdHlBX0Vt\nYmVkX0NvbXBsZXggYSAiICsKICAgICAgICAgICAgICAgICIgV0hFUkUgZXhp\nc3RzIChzZWxlY3QgbiBmcm9tIEVudGl0eUFfRW1iZWRfQ29tcGxleCBhLCAi\nICsKICAgICAgICAgICAgICAgICIgaW4gKGEubmlja05hbWVzKSBuIHdoZXJl\nIG4gbGlrZSAnJTEnKSAiICsKICAgICAgICAgICAgICAgICIgb3JkZXIgYnkg\nYSIsCiAgICAgICAgfTsKICAgICAgICBMaXN0IHJzID0gbnVsbDsKICAgICAg\nICBmb3IgKGludCBpID0gMDsgaSA8IHF1ZXJ5Lmxlbmd0aDsgaSsrKSB7CiAg\nICAgICAgICAgIHJzID0gZW0uY3JlYXRlUXVlcnkocXVlcnlbaV0pLmdldFJl\nc3VsdExpc3QoKTsKICAgICAgICAgICAgc3dpdGNoIChpKSB7CiAgICAgICAg\nICAgIGNhc2UgMDoKICAgICAgICAgICAgY2FzZSAxOgogICAgICAgICAgICBj\nYXNlIDI6CiAgICAgICAgICAgICAgICBhc3NlcnRUcnVlKHJzLnNpemUoKSA+\nIDApOwogICAgICAgICAgICAgICAgT2JqZWN0IG9iaiA9IHJzLmdldCgwKTsK\nICAgICAgICAgICAgICAgIGFzc2VydFRydWUob2JqIGluc3RhbmNlb2YgU3Ry\naW5nKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNl\nIDM6CiAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgICAgIGFzc2Vy\ndFRydWUocnMuc2l6ZSgpID09IDApOwogICAgICAgICAgICB9CiAgICAgICAg\nICAgIGVtLmNsZWFyKCk7CiAgICAgICAgfQogICAgICAgIGVtLmdldFRyYW5z\nYWN0aW9uKCkuYmVnaW4oKTsKICAgICAgICBRdWVyeSBxID0gZW0uY3JlYXRl\nUXVlcnkoInNlbGVjdCBhIGZyb20gRW50aXR5QV9FbWJlZF9Db21wbGV4IGEi\nKTsKICAgICAgICBMaXN0PEVudGl0eUFfRW1iZWRfQ29tcGxleD4gYXMgPSBx\nLmdldFJlc3VsdExpc3QoKTsKICAgICAgICBmb3IgKEVudGl0eUFfRW1iZWRf\nQ29tcGxleCBhIDogYXMpIHsKICAgICAgICAgICAgY2hlY2tFbnRpdHlBX0Vt\nYmVkX0NvbXBsZXgoYSk7CiAgICAgICAgfQogICAgICAgIGVtLmdldFRyYW5z\nYWN0aW9uKCkuY29tbWl0KCk7CiAgICAgICAgaWYgKGVtQ2xvc2UpIHsKICAg\nICAgICAgICAgZW0uY2xvc2UoKTsKICAgICAgICB9CiAgICB9CiAgICAKfQo=\n","encoding":"base64"}

