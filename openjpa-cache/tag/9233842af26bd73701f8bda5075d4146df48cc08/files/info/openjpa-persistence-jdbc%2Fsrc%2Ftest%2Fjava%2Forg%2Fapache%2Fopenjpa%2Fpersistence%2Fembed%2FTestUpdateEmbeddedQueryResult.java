{"sha":"32f50ee040477be89618d54261fb3c408693ee74","node_id":"MDQ6QmxvYjIwNjM2NDozMmY1MGVlMDQwNDc3YmU4OTYxOGQ1NDI2MWZiM2M0MDg2OTNlZTc0","size":7504,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/32f50ee040477be89618d54261fb3c408693ee74","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNr\nYWdlIG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5lbWJlZDsKCmlt\ncG9ydCBqYXZhLnV0aWwuTGlzdDsKCmltcG9ydCBqYXZheC5wZXJzaXN0ZW5j\nZS5FbnRpdHlNYW5hZ2VyOwppbXBvcnQgamF2YXgucGVyc2lzdGVuY2UuRW50\naXR5VHJhbnNhY3Rpb247CgppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnBl\ncnNpc3RlbmNlLkFyZ3VtZW50RXhjZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLnBlcnNpc3RlbmNlLlJvbGxiYWNrRXhjZXB0aW9uOwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNlLnRlc3QuU2luZ2xl\nRU1GVGVzdENhc2U7CgpwdWJsaWMgY2xhc3MgVGVzdFVwZGF0ZUVtYmVkZGVk\nUXVlcnlSZXN1bHQgZXh0ZW5kcyBTaW5nbGVFTUZUZXN0Q2FzZSB7CiAgIAog\nICAgcHVibGljIGludCBJRCA9IDE7CgogICAgcHVibGljIHZvaWQgc2V0VXAo\nKSB7CiAgICAgICAgc2V0VXAoRW1iZWQuY2xhc3MsCiAgICAgICAgICAgIEVt\nYmVkX0VtYmVkLmNsYXNzLCAKICAgICAgICAgICAgRW50aXR5QV9FbWJlZF9F\nbWJlZC5jbGFzcywKICAgICAgICAgICAgQmFzZUVudGl0eS5jbGFzcywgQWRk\ncmVzcy5jbGFzcywgR2VvY29kZS5jbGFzcywKICAgICAgICAgICAgRFJPUF9U\nQUJMRVMpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHRlc3RVcGRhdGVFbWJl\nZGRlZCgpIHsKICAgICAgICBFbnRpdHlNYW5hZ2VyIGVtID0gZW1mLmNyZWF0\nZUVudGl0eU1hbmFnZXIoKTsKICAgICAgICBBZGRyZXNzIGEgPSBuZXcgQWRk\ncmVzcygpOwogICAgICAgIGEuc2V0U3RyZWV0QWRkcmVzcygiNTU1IEJhaWxl\neSBBdmUiKTsKICAgICAgICBhLnNldENpdHkoIlNhbiBKb3NlIik7CiAgICAg\nICAgYS5zZXRTdGF0ZSgiQ0EiKTsKICAgICAgICBhLnNldFppcCgxMjk1NSk7\nCiAgICAgICAgR2VvY29kZSBnID0gbmV3IEdlb2NvZGUoKTsKICAgICAgICBn\nLnNldExhdGl0dWRlKDEuMGYpOwogICAgICAgIGcuc2V0TG9uZ3RpdHVkZSgy\nLjBmKTsKICAgICAgICBhLnNldEdlb2NvZGUoZyk7CiAgICAgICAgZW0uZ2V0\nVHJhbnNhY3Rpb24oKS5iZWdpbigpOyAgICAgICAgCiAgICAgICAgZW0ucGVy\nc2lzdChhKTsKICAgICAgICBlbS5nZXRUcmFuc2FjdGlvbigpLmNvbW1pdCgp\nOwoKICAgICAgICBlbS5jbGVhcigpOwogICAgICAgIGVtLmdldFRyYW5zYWN0\naW9uKCkuYmVnaW4oKTsKICAgICAgICBTdHJpbmcgcXVlcnkgPSAic2VsZWN0\nIGFkZHJlc3MgZnJvbSBBZGRyZXNzIGFkZHJlc3MiICsKICAgICAgICAgICAg\nIiB3aGVyZSBhZGRyZXNzLnN0cmVldEFkZHJlc3MgPSAnNTU1IEJhaWxleSBB\ndmUnIjsKICAgICAgICBMaXN0PEFkZHJlc3M+IGxpc3QgPSAoTGlzdDxBZGRy\nZXNzPikgZW0uY3JlYXRlUXVlcnkocXVlcnkpLmdldFJlc3VsdExpc3QoKTsK\nICAgICAgICBBZGRyZXNzIGExID0gbGlzdC5nZXQoMCk7CgogICAgICAgIGFz\nc2VydEVxdWFscyhhMS5nZXRHZW9jb2RlKCkuZ2V0TGF0aXR1ZGUoKSwxLjBm\nKTsKICAgICAgICAKICAgICAgICBMb25nIGlkID0gYTEuZ2V0SWQoKTsKCiAg\nICAgICAgZyA9IG5ldyBHZW9jb2RlKCk7CiAgICAgICAgZy5zZXRMYXRpdHVk\nZSgzLjBmKTsKICAgICAgICBnLnNldExvbmd0aXR1ZGUoNC4wZik7CiAgICAg\nICAgYTEuc2V0R2VvY29kZShnKTsKCiAgICAgICAgZW0uZ2V0VHJhbnNhY3Rp\nb24oKS5jb21taXQoKTsKCiAgICAgICAgQWRkcmVzcyBhMiA9IGVtLmZpbmQo\nQWRkcmVzcy5jbGFzcywgaWQpOwogICAgICAgIGFzc2VydEVxdWFscyhhMi5n\nZXRHZW9jb2RlKCkuZ2V0TGF0aXR1ZGUoKSwzLjBmKTsKCiAgICAgICAgZW0u\nZ2V0VHJhbnNhY3Rpb24oKS5iZWdpbigpOwogICAgICAgIGcuc2V0TGF0aXR1\nZGUoNS4wZik7CiAgICAgICAgYTIuc2V0R2VvY29kZShnKTsKICAgICAgICBl\nbS5nZXRUcmFuc2FjdGlvbigpLmNvbW1pdCgpOwoKICAgICAgICBlbS5jbGVh\ncigpOwogICAgICAgIEFkZHJlc3MgYTMgPSBlbS5maW5kKEFkZHJlc3MuY2xh\nc3MsIGlkKTsKICAgICAgICBhc3NlcnRFcXVhbHMoYTMuZ2V0R2VvY29kZSgp\nLmdldExhdGl0dWRlKCksNS4wZik7CgogICAgICAgIGVtLmNsZWFyKCk7CiAg\nICAgICAgcXVlcnkgPSAic2VsZWN0IGEuZ2VvY29kZSBmcm9tIEFkZHJlc3Mg\nYSB3aGVyZSBhLmlkID0gPzEiOwogICAgICAgIExpc3Q8R2VvY29kZT4gcnMg\nPSBlbS5jcmVhdGVRdWVyeShxdWVyeSkuc2V0UGFyYW1ldGVyKDEsIGlkKS5n\nZXRSZXN1bHRMaXN0KCk7CiAgICAgICAgR2VvY29kZSBnMiA9IHJzLmdldCgw\nKTsKICAgICAgICBlbS5nZXRUcmFuc2FjdGlvbigpLmJlZ2luKCk7CiAgICAg\nICAgdHJ5IHsKICAgICAgICAgICAgZzIuc2V0TGF0aXR1ZGUoNy4wZik7CiAg\nICAgICAgfSBjYXRjaCAoQXJndW1lbnRFeGNlcHRpb24gZSkgewogICAgICAg\nICAgICAvL2FzIGV4cGVjdGVkOiB1cGRhdGUgb2YgZW1iZWRkYWJsZSBmaWVs\nZCBpbiBxdWVyeSByZXN1bHQgaXMgbm90IGFsbG93ZWQuCiAgICAgICAgfQoK\nICAgICAgICB0cnkgewogICAgICAgICAgICBlbS5nZXRUcmFuc2FjdGlvbigp\nLmNvbW1pdCgpOwogICAgICAgIH0gY2F0Y2ggKFJvbGxiYWNrRXhjZXB0aW9u\nIGUpIHsKICAgICAgICAgICAgLy9hcyBleHBlY3RlZDogdXBkYXRlIG9mIGVt\nYmVkZGFibGUgZmllbGQgaW4gcXVlcnkgcmVzdWx0IGlzIG5vdCBhbGxvd2Vk\nLgogICAgICAgIH0KICAgICAgICBlbS5jbG9zZSgpOwogICAgfQoKICAgIHB1\nYmxpYyB2b2lkIHRlc3RFbnRpdHlBX0VtYmVkX0VtYmVkX3VwZGF0ZSgpIHsK\nICAgICAgICBjcmVhdGVFbnRpdHlBX0VtYmVkX0VtYmVkKCk7CiAgICAgICAg\ndXBkYXRlRW1iZWRkZWRfRW50aXR5QV9FbWJlZF9FbWJlZCgpOwogICAgfQoK\nICAgIC8qCiAgICAgKiBDcmVhdGUgRW50aXR5QV9FbWJlZF9FbWJlZAogICAg\nICovCiAgICBwdWJsaWMgdm9pZCBjcmVhdGVFbnRpdHlBX0VtYmVkX0VtYmVk\nKCkgewogICAgICAgIEVudGl0eU1hbmFnZXIgZW0gPSBlbWYuY3JlYXRlRW50\naXR5TWFuYWdlcigpOwogICAgICAgIEVudGl0eVRyYW5zYWN0aW9uIHRyYW4g\nPSBlbS5nZXRUcmFuc2FjdGlvbigpOwogICAgICAgIGNyZWF0ZUVudGl0eUFf\nRW1iZWRfRW1iZWQoZW0sIElEKTsKICAgICAgICB0cmFuLmJlZ2luKCk7CiAg\nICAgICAgZW0uZmx1c2goKTsKICAgICAgICB0cmFuLmNvbW1pdCgpOwogICAg\nICAgIGVtLmNsb3NlKCk7CiAgICB9CgogICAgcHVibGljIHZvaWQgY3JlYXRl\nRW50aXR5QV9FbWJlZF9FbWJlZChFbnRpdHlNYW5hZ2VyIGVtLCBpbnQgaWQp\nIHsKICAgICAgICBFbnRpdHlBX0VtYmVkX0VtYmVkIGEgPSBuZXcgRW50aXR5\nQV9FbWJlZF9FbWJlZCgpOwogICAgICAgIGEuc2V0SWQoaWQpOwogICAgICAg\nIGEuc2V0TmFtZSgiYSIgKyBpZCk7CiAgICAgICAgYS5zZXRBZ2UoaWQpOwog\nICAgICAgIEVtYmVkX0VtYmVkIGVtYmVkID0gY3JlYXRlRW1iZWRfRW1iZWQo\nZW0sIGlkLCAwKTsKICAgICAgICBhLnNldEVtYmVkKGVtYmVkKTsKICAgICAg\nICBlbS5wZXJzaXN0KGEpOwogICAgfQoKICAgIHB1YmxpYyBFbWJlZF9FbWJl\nZCBjcmVhdGVFbWJlZF9FbWJlZChFbnRpdHlNYW5hZ2VyIGVtLCBpbnQgaWQs\nIGludCBpZHgpIHsKICAgICAgICBFbWJlZF9FbWJlZCBlbWJlZCA9IG5ldyBF\nbWJlZF9FbWJlZCgpOwogICAgICAgIGVtYmVkLnNldEludFZhbDEoaWQgKiAx\nMDAgKyBpZHggKiAxMCArIDEpOwogICAgICAgIGVtYmVkLnNldEludFZhbDIo\naWQgKiAxMDAgKyBpZHggKiAxMCArIDIpOwogICAgICAgIGVtYmVkLnNldElu\ndFZhbDMoaWQgKiAxMDAgKyBpZHggKiAxMCArIDMpOwogICAgICAgIEVtYmVk\nIGVtYmVkMSA9IGNyZWF0ZUVtYmVkKGlkLCBpZHgpOwogICAgICAgIGVtYmVk\nLnNldEVtYmVkKGVtYmVkMSk7CiAgICAgICAgcmV0dXJuIGVtYmVkOwogICAg\nfQoKICAgIHB1YmxpYyBFbWJlZCBjcmVhdGVFbWJlZChpbnQgaWQsIGludCBp\nZHgpIHsKICAgICAgICBFbWJlZCBlbWJlZCA9IG5ldyBFbWJlZCgpOwogICAg\nICAgIGVtYmVkLnNldEludFZhbDEoaWQgKiAxMDAgKyBpZHggKiAxMCArIDQp\nOwogICAgICAgIGVtYmVkLnNldEludFZhbDIoaWQgKiAxMDAgKyBpZHggKiAx\nMCArIDUpOwogICAgICAgIGVtYmVkLnNldEludFZhbDMoaWQgKiAxMDAgKyBp\nZHggKiAxMCArIDYpOwogICAgICAgIHJldHVybiBlbWJlZDsKICAgIH0KCiAg\nICAvKgogICAgICogCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHRlc3RCdWxr\nVXBkYXRlRW1iZWRkZWRGaWVsZCgpIHsKICAgICAgICBFbnRpdHlNYW5hZ2Vy\nIGVtID0gZW1mLmNyZWF0ZUVudGl0eU1hbmFnZXIoKTsKICAgICAgICBTdHJp\nbmcgdXBkYXRlID0gIlVQREFURSBFbnRpdHlBX0VtYmVkX0VtYmVkIGEgc2V0\nIGEuZW1iZWQuZW1iZWQuaW50VmFsMSA9ID8xLCIgKwogICAgICAgICAgICAg\nICAgIiBhLmVtYmVkLmVtYmVkLmludFZhbDIgPSA/MiB3aGVyZSBhLmlkID0g\nMTAiOwogICAgICAgIGVtLmdldFRyYW5zYWN0aW9uKCkuYmVnaW4oKTsKICAg\nICAgICBpbnQgY291bnQgPSBlbS5jcmVhdGVRdWVyeSh1cGRhdGUpLnNldFBh\ncmFtZXRlcigxLCAxMDApLnNldFBhcmFtZXRlcigyLCAyMDApLmV4ZWN1dGVV\ncGRhdGUoKTsKICAgICAgICBlbS5nZXRUcmFuc2FjdGlvbigpLmNvbW1pdCgp\nOwogICAgICAgIGFzc2VydEVxdWFscyhjb3VudCwgMCk7CgogICAgICAgIC8v\nIHRlc3QgaW52YWxpZCBidWxrIHVwZGF0ZSBlbWJlZGRhYmxlIGZpZWxkCiAg\nICAgICAgdXBkYXRlID0gIlVQREFURSBFbnRpdHlBX0VtYmVkX0VtYmVkIGEg\nc2V0IGEuZW1iZWQuZW1iZWQgPSA/MSI7CiAgICAgICAgRW1iZWQgZW1iZWQx\nID0gY3JlYXRlRW1iZWQoSUQsIDEwKTsKICAgICAgICB0cnkgewogICAgICAg\nIGludCB1cGRhdGVDb3VudCA9IGVtLmNyZWF0ZVF1ZXJ5KHVwZGF0ZSkuc2V0\nUGFyYW1ldGVyKDEsIGVtYmVkMSkuZXhlY3V0ZVVwZGF0ZSgpOwogICAgICAg\nIH0gY2F0Y2ggKEFyZ3VtZW50RXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAg\nLy8gYXMgZXhwZWN0ZWQ6IEJ1bGsgdXBkYXRlIG9mIGVtYmVkZGFibGUgZmll\nbGQgaXMgbm90IGFsbG93ZWQuCiAgICAgICAgfQogICAgICAgIGVtLmNsb3Nl\nKCk7CiAgICB9CgogICAgLyoKICAgICAqIHVwZGF0ZSBlbWJlZGRlZCBvYmpl\nY3QgcmV0dXJuZWQgZnJvbSBxdWVyeQogICAgICovCiAgICBwdWJsaWMgdm9p\nZCB1cGRhdGVFbWJlZGRlZF9FbnRpdHlBX0VtYmVkX0VtYmVkKCkgewogICAg\nICAgIEVudGl0eU1hbmFnZXIgZW0gPSBlbWYuY3JlYXRlRW50aXR5TWFuYWdl\ncigpOwogICAgICAgIC8vIHRlc3QgdXBkYXRlIGVtYmVkZGVkIG9iamVjdCBy\nZXR1cm5lZCBmcm9tIHF1ZXJ5CiAgICAgICAgU3RyaW5nIHF1ZXJ5W10gPSB7\nCiAgICAgICAgICAgICJzZWxlY3QgYS5lbWJlZCBmcm9tIEVudGl0eUFfRW1i\nZWRfRW1iZWQgYSIsCiAgICAgICAgICAgICJzZWxlY3QgYS5lbWJlZC5lbWJl\nZCBmcm9tIEVudGl0eUFfRW1iZWRfRW1iZWQgYSIsCiAgICAgICAgICAgICJz\nZWxlY3QgYS5lbWJlZCBhcyBlIGZyb20gRW50aXR5QV9FbWJlZF9FbWJlZCBh\nIE9SREVSIEJZIGUiLAogICAgICAgIH07CiAgICAgICAgTGlzdCBycyA9IG51\nbGw7CiAgICAgICAgRW1iZWRfRW1iZWQgZW1iZWRlbWJlZCA9IG51bGw7CiAg\nICAgICAgRW1iZWQgZW1iZWQgPSBudWxsOwogICAgICAgIEVudGl0eVRyYW5z\nYWN0aW9uIHRyYW4gPSBlbS5nZXRUcmFuc2FjdGlvbigpOwogICAgICAgIHRy\nYW4uYmVnaW4oKTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IHF1ZXJ5\nLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIHJzID0gZW0uY3JlYXRlUXVl\ncnkocXVlcnlbaV0pLmdldFJlc3VsdExpc3QoKTsKICAgICAgICAgICAgYXNz\nZXJ0VHJ1ZShycy5zaXplKCkgPiAwKTsKICAgICAgICAgICAgdHJ5IHsKICAg\nICAgICAgICAgICAgIHN3aXRjaCAoaSkgewogICAgICAgICAgICAgICAgY2Fz\nZSAwOgogICAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAg\nICAgIGVtYmVkZW1iZWQgPSAoRW1iZWRfRW1iZWQpIHJzLmdldCgwKTsKICAg\nICAgICAgICAgICAgICAgICBlbWJlZGVtYmVkLmdldEVtYmVkKCkuc2V0SW50\nVmFsMSgxMTExKTsKICAgICAgICAgICAgICAgICAgICBlbWJlZGVtYmVkLnNl\ndEVtYmVkKGVtYmVkKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAg\nICAgICAgICAgICAgIGNhc2UgMToKICAgICAgICAgICAgICAgICAgICBlbWJl\nZCA9IChFbWJlZCkgcnMuZ2V0KDApOwogICAgICAgICAgICAgICAgICAgIGVt\nYmVkLnNldEludFZhbDEoMTExMSk7CiAgICAgICAgICAgICAgICAgICAgYnJl\nYWs7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gY2F0Y2goQXJn\ndW1lbnRFeGNlcHRpb24gZSkgewogICAgICAgICAgICAgICAgLy8gYXMgZXhw\nZWN0ZWQ6CiAgICAgICAgICAgICAgICAvLyBVcGRhdGUgb2YgZW1iZWRkZWQg\nb2JqZWN0IHJldHVybmVkIGZyb20gcXVlcnkgcmVzdWx0IGlzIG5vdCBhbGxv\nd2VkLgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHRyeSB7CiAg\nICAgICAgICAgIHRyYW4uY29tbWl0KCk7CiAgICAgICAgfSBjYXRjaChSb2xs\nYmFja0V4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgIC8vIGFzIGV4cGVjdGVk\nOgogICAgICAgICAgICAvLyBVcGRhdGUgb2YgZW1iZWRkZWQgb2JqZWN0IHJl\ndHVybmVkIGZyb20gcXVlcnkgcmVzdWx0IGlzIG5vdCBhbGxvd2VkLgogICAg\nICAgIH0KICAgICAgICBlbS5jbG9zZSgpOwogICAgfQp9Cg==\n","encoding":"base64"}

