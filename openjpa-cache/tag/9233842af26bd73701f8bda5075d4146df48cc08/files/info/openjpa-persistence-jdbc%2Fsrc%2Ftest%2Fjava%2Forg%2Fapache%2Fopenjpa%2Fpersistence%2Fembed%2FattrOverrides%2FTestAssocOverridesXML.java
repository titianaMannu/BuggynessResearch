{"sha":"4ef3d45634406eb500423790af05e863f26fcbea","node_id":"MDQ6QmxvYjIwNjM2NDo0ZWYzZDQ1NjM0NDA2ZWI1MDA0MjM3OTBhZjA1ZTg2M2YyNmZjYmVh","size":4969,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/4ef3d45634406eb500423790af05e863f26fcbea","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuZW1iZWQu\nYXR0ck92ZXJyaWRlczsKCmltcG9ydCBqYXZhLnV0aWwuQXJyYXlMaXN0Owpp\nbXBvcnQgamF2YS51dGlsLkFycmF5czsKaW1wb3J0IGphdmEudXRpbC5IYXNo\nTWFwOwppbXBvcnQgamF2YS51dGlsLkxpc3Q7CgppbXBvcnQgamF2YXgucGVy\nc2lzdGVuY2UuRW50aXR5TWFuYWdlcjsKCmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEubGliLmpkYmMuQWJzdHJhY3RKREJDTGlzdGVuZXI7CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEubGliLmpkYmMuSkRCQ0V2ZW50OwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLmxpYi5qZGJjLkpEQkNMaXN0ZW5lcjsKaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5PcGVuSlBBRW50\naXR5TWFuYWdlckZhY3RvcnlTUEk7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEucGVyc2lzdGVuY2UuT3BlbkpQQVBlcnNpc3RlbmNlOwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNlLmpkYmMuU1FMU25pZmZlcjsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS50ZXN0LkFi\nc3RyYWN0UGVyc2lzdGVuY2VUZXN0Q2FzZTsKCnB1YmxpYyBjbGFzcyBUZXN0\nQXNzb2NPdmVycmlkZXNYTUwgIGV4dGVuZHMgQWJzdHJhY3RQZXJzaXN0ZW5j\nZVRlc3RDYXNleyAKCiAgICBwcm90ZWN0ZWQgTGlzdDxTdHJpbmc+IF9zcWwg\nPSBuZXcgQXJyYXlMaXN0PFN0cmluZz4oKTsKCiAgICAvKioKICAgICAqIFRl\nc3QgYXNzb2NpYXRpb24gb3ZlcnJpZGVzIGRlZmluZWQgd2l0aGluIGFuIGVt\nYmVkZGVkIG9mIGFuIGVsZW1lbnQKICAgICAqIGNvbGxlY3Rpb24KICAgICAq\nLwogICAgcHVibGljIHZvaWQgdGVzdEVsZW1lbnRDb2xsZWN0aW9uQXNzb2NP\ndmVycmlkZXMoKSB7CgogICAgICAgIF9zcWwuY2xlYXIoKTsKICAgICAgICBI\nYXNoTWFwPFN0cmluZywgT2JqZWN0PiBwcm9wcyA9IG5ldyBIYXNoTWFwPFN0\ncmluZywgT2JqZWN0PigpOwogICAgICAgIHByb3BzLnB1dCgib3BlbmpwYS5q\nZGJjLkpEQkNMaXN0ZW5lcnMiLCAKICAgICAgICAgICAgbmV3IEpEQkNMaXN0\nZW5lcltdIHsgbmV3IFNRTExpc3RlbmVyKCkgfSk7CiAgICAgICAgT3BlbkpQ\nQUVudGl0eU1hbmFnZXJGYWN0b3J5U1BJIGVtZjEgPSAKICAgICAgICAgICAg\nKE9wZW5KUEFFbnRpdHlNYW5hZ2VyRmFjdG9yeVNQSSlPcGVuSlBBUGVyc2lz\ndGVuY2UuCiAgICAgICAgICAgIGNyZWF0ZUVudGl0eU1hbmFnZXJGYWN0b3J5\nKCJBc3NvY092ZXJQVSIsCiAgICAgICAgICAgICJvcmcvYXBhY2hlL29wZW5q\ncGEvcGVyc2lzdGVuY2UvZW1iZWQvIiArCiAgICAgICAgICAgICJlbWJlZC1w\nZXJzaXN0ZW5jZS54bWwiLCBwcm9wcyk7CgogICAgICAgIEVudGl0eU1hbmFn\nZXIgZW0gPSBlbWYxLmNyZWF0ZUVudGl0eU1hbmFnZXIoKTsKCiAgICAgICAg\nWE1MQXNzb2NPdmVyRW50aXR5QSBlYSA9IG5ldyBYTUxBc3NvY092ZXJFbnRp\ndHlBKCk7CiAgICAgICAgWE1MQXNzb2NPdmVyRW50aXR5QiBlYiA9IG5ldyBY\nTUxBc3NvY092ZXJFbnRpdHlCKCk7CiAgICAgICAgWE1MQXNzb2NPdmVyRW50\naXR5QiBtZWIgPSBuZXcgWE1MQXNzb2NPdmVyRW50aXR5QigpOwogICAgICAg\nIFhNTEFzc29jT3ZlckVtYmVkIGVtYiA9IG5ldyBYTUxBc3NvY092ZXJFbWJl\nZCgpOwogICAgICAgIGViLnNldE5hbWUoIlhNTEFzc29jT3ZlckVudGl0eUIi\nKTsKICAgICAgICBtZWIuc2V0TmFtZSgiWE1MQXNzb2NPdmVyRW50aXR5Qk0y\nMSIpOwogICAgICAgIExpc3Q8WE1MQXNzb2NPdmVyRW50aXR5QT4gZWFMaXN0\nMSA9IG5ldyBBcnJheUxpc3Q8WE1MQXNzb2NPdmVyRW50aXR5QT4oKTsKICAg\nICAgICBlYUxpc3QxLmFkZChlYSk7CiAgICAgICAgTGlzdDxYTUxBc3NvY092\nZXJFbnRpdHlBPiBlYUxpc3QyID0gbmV3IEFycmF5TGlzdDxYTUxBc3NvY092\nZXJFbnRpdHlBPigpOyAgICAgICAgCiAgICAgICAgZWFMaXN0Mi5hZGQoZWEp\nOwogICAgICAgIGViLnNldEVhTGlzdChlYUxpc3QxKTsKICAgICAgICBtZWIu\nc2V0RWFMaXN0KGVhTGlzdDIpOwogICAgICAgIGVtYi5zZXROYW1lKCJYTUxB\nc3NvY092ZXJFbWJlZCIpOwogICAgICAgIGVtYi5zZXRFYihlYik7CiAgICAg\nICAgZW1iLnNldE1lYihtZWIpOwogICAgICAgIExpc3Q8WE1MQXNzb2NPdmVy\nRW1iZWQ+IGVtYkxpc3QgPSBuZXcgQXJyYXlMaXN0PFhNTEFzc29jT3ZlckVt\nYmVkPigpOwogICAgICAgIGVtYkxpc3QuYWRkKGVtYik7CiAgICAgICAgZWEu\nc2V0RW1iQShlbWJMaXN0KTsKICAgICAgICAKICAgICAgICBlbS5nZXRUcmFu\nc2FjdGlvbigpLmJlZ2luKCk7CiAgICAgICAgZW0ucGVyc2lzdChlYSk7CiAg\nICAgICAgZW0uZ2V0VHJhbnNhY3Rpb24oKS5jb21taXQoKTsKICAgICAgICBl\nbS5jbG9zZSgpOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIGFzc2VydFNR\nTEZyYWdubWVudHMoX3NxbCwgIkNSRUFURSBUQUJMRSBYTUxfRU1CQUxJU1Qg\nLioiICsKICAgICAgICAgICAgICAgICIgLiplbWJhX2VudGIuKmVtYmFfbWVu\ndGIiKTsKICAgICAgICAKICAgICAgICB9IAogICAgICAgIGZpbmFsbHkgewog\nICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgaWYgKGVtZjEgIT0g\nbnVsbCkKICAgICAgICAgICAgICAgICAgICBjbGVhbnVwRU1GKGVtZjEpOwog\nICAgICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkgewogICAgICAgICAg\nICAgICAgZmFpbChlLmdldE1lc3NhZ2UoKSk7CiAgICAgICAgICAgIH0KICAg\nICAgICB9CiAgICB9CgogICAgdm9pZCBhc3NlcnRTUUxGcmFnbm1lbnRzKExp\nc3Q8U3RyaW5nPiBsaXN0LCBTdHJpbmcuLi4ga2V5cykgewogICAgICAgIGlm\nIChTUUxTbmlmZmVyLm1hdGNoZXMobGlzdCwga2V5cykpCiAgICAgICAgICAg\nIHJldHVybjsKICAgICAgICBmYWlsKCJOb25lIG9mIHRoZSBmb2xsb3dpbmcg\nIiArIGxpc3Quc2l6ZSgpICsgIiBTUUwgXHJcbiIgKyAKICAgICAgICAgICAg\nICAgIHRvU3RyaW5nKGxpc3QpICsgIlxyXG4gY29udGFpbnMgYWxsIGtleXMg\nXHJcbiIKICAgICAgICAgICAgICAgICsgdG9TdHJpbmcoQXJyYXlzLmFzTGlz\ndChrZXlzKSkpOwogICAgfQoKICAgIHByaXZhdGUgc3RhdGljIFN0cmluZyB0\nb1N0cmluZyhMaXN0PFN0cmluZz4gbGlzdCkgewogICAgICAgIFN0cmluZ0J1\nZmZlciBidWYgPSBuZXcgU3RyaW5nQnVmZmVyKCk7CiAgICAgICAgZm9yIChT\ndHJpbmcgcyA6IGxpc3QpCiAgICAgICAgICAgIGJ1Zi5hcHBlbmQocykuYXBw\nZW5kKCJcclxuIik7CiAgICAgICAgcmV0dXJuIGJ1Zi50b1N0cmluZygpOwog\nICAgfQogICAgCiAgICAvKioKICAgICAqIENsb3NlcyBhIHNwZWNpZmljIGVu\ndGl0eSBtYW5hZ2VyIGZhY3RvcnkgYW5kIGNsZWFucyB1cCAKICAgICAqIGFz\nc29jaWF0ZWQgdGFibGVzLgogICAgICovCiAgICBwcml2YXRlIHZvaWQgY2xl\nYW51cEVNRihPcGVuSlBBRW50aXR5TWFuYWdlckZhY3RvcnlTUEkgZW1mMSkg\nCiAgICAgIHRocm93cyBFeGNlcHRpb24gewoKICAgICAgICBpZiAoZW1mMSA9\nPSBudWxsKQogICAgICAgICAgICByZXR1cm47CgogICAgICAgIHRyeSB7CiAg\nICAgICAgICAgIGNsZWFyKGVtZjEpOwogICAgICAgIH0gY2F0Y2ggKEV4Y2Vw\ndGlvbiBlKSB7CiAgICAgICAgICAgIC8vIGlmIGEgdGVzdCBmYWlsZWQsIHN3\nYWxsb3cgYW55IGV4Y2VwdGlvbnMgdGhhdCBoYXBwZW4KICAgICAgICAgICAg\nLy8gZHVyaW5nIHRlYXItZG93biwgYXMgdGhlc2UganVzdCBtYXNrIHRoZSBv\ncmlnaW5hbCBwcm9ibGVtLgogICAgICAgICAgICBpZiAodGVzdFJlc3VsdC53\nYXNTdWNjZXNzZnVsKCkpCiAgICAgICAgICAgICAgICB0aHJvdyBlOwogICAg\nICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgIGNsb3NlRU1GKGVtZjEpOwog\nICAgICAgIH0KICAgIH0gICAgCgogICAgcHVibGljIGNsYXNzIFNRTExpc3Rl\nbmVyCiAgICAgICAgZXh0ZW5kcyBBYnN0cmFjdEpEQkNMaXN0ZW5lciB7Cgog\nICAgICAgIEBPdmVycmlkZQogICAgICAgIHB1YmxpYyB2b2lkIGJlZm9yZUV4\nZWN1dGVTdGF0ZW1lbnQoSkRCQ0V2ZW50IGV2ZW50KSB7CiAgICAgICAgICAg\nIGlmIChldmVudC5nZXRTUUwoKSAhPSBudWxsICYmIF9zcWwgIT0gbnVsbCkg\newogICAgICAgICAgICAgICAgX3NxbC5hZGQoZXZlbnQuZ2V0U1FMKCkpOwog\nICAgICAgIH0KICAgIH0KfQp9Cg==\n","encoding":"base64"}

