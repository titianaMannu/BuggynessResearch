{"sha":"b0e24264daf159da2233d3e75d2844adaca0de61","node_id":"MDQ6QmxvYjIwNjM2NDpiMGUyNDI2NGRhZjE1OWRhMjIzM2QzZTc1ZDI4NDRhZGFjYTBkZTYx","size":14013,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/b0e24264daf159da2233d3e75d2844adaca0de61","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuamRiYy5v\ncmRlcjsKCmltcG9ydCBqYXZhLmlvLkJ5dGVBcnJheUlucHV0U3RyZWFtOwpp\nbXBvcnQgamF2YS5pby5CeXRlQXJyYXlPdXRwdXRTdHJlYW07CmltcG9ydCBq\nYXZhLmlvLklucHV0U3RyZWFtUmVhZGVyOwppbXBvcnQgamF2YS5pby5PdXRw\ndXRTdHJlYW1Xcml0ZXI7CmltcG9ydCBqYXZhLnNxbC5Db25uZWN0aW9uOwpp\nbXBvcnQgamF2YS5zcWwuRGF0YWJhc2VNZXRhRGF0YTsKaW1wb3J0IGphdmEu\ndXRpbC5BcnJheUxpc3Q7CmltcG9ydCBqYXZhLnV0aWwuTGlua2VkSGFzaFNl\ndDsKaW1wb3J0IGphdmEudXRpbC5MaXN0OwppbXBvcnQgamF2YS51dGlsLlNl\ndDsKCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuY29uZi5PcGVuSlBBQ29u\nZmlndXJhdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLmNv\nbmYuSkRCQ0NvbmZpZ3VyYXRpb247CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEuamRiYy5tZXRhLkNsYXNzTWFwcGluZzsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS5qZGJjLm1ldGEuRmllbGRNYXBwaW5nOwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1hLkNvbHVtbjsKaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS5qZGJjLnNxbC5EQkRpY3Rpb25hcnk7CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEubGliLm1ldGEuTWV0YURhdGFTZXJpYWxpemVy\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuQ2xhc3NNZXRhRGF0\nYTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRhLk1ldGFEYXRhUmVw\nb3NpdG9yeTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5j\nZS5Bcmd1bWVudEV4Y2VwdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUub3Blbmpw\nYS5wZXJzaXN0ZW5jZS5PcGVuSlBBRW50aXR5TWFuYWdlckZhY3RvcnlTUEk7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuT3BlbkpQ\nQUVudGl0eU1hbmFnZXJTUEk7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\ncGVyc2lzdGVuY2UuT3BlbkpQQVBlcnNpc3RlbmNlOwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNlLmpkYmMuWE1MUGVyc2lzdGVuY2VN\nYXBwaW5nUGFyc2VyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNp\nc3RlbmNlLmpkYmMuWE1MUGVyc2lzdGVuY2VNYXBwaW5nU2VyaWFsaXplcjsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS50ZXN0LkFi\nc3RyYWN0Q2FjaGVkRU1GVGVzdENhc2U7CmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEucGVyc2lzdGVuY2UudGVzdC5QZXJzaXN0ZW5jZVRlc3RDYXNlOwoK\ncHVibGljIGNsYXNzIFRlc3RPcmRlckNvbHVtblhNTCBleHRlbmRzIEFic3Ry\nYWN0Q2FjaGVkRU1GVGVzdENhc2UgeyAgICAgICAKCiAgICAvKgogICAgICog\nVmFsaWRhdGVzIHRoZSB1c2Ugb2YgdGhlIG51bGxhYmxlIGF0dHJpYnV0ZSBv\nbiBPcmRlckNvbHVtbiB0aHJvdWdoCiAgICAgKiBhbiBlbnRpdHkgZGVmaW5l\nZCBpbiBvcm0ueG1sCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHRlc3RPcmRl\nckNvbHVtbk51bGxhYmxlRmFsc2UoKSB7CiAgICAgICAgCiAgICAgICAgT3Bl\nbkpQQUVudGl0eU1hbmFnZXJGYWN0b3J5U1BJIGVtZjEgPSAKICAgICAgICAg\nICAgKE9wZW5KUEFFbnRpdHlNYW5hZ2VyRmFjdG9yeVNQSSlPcGVuSlBBUGVy\nc2lzdGVuY2UuCiAgICAgICAgICAgIGNyZWF0ZUVudGl0eU1hbmFnZXJGYWN0\nb3J5KCJCYXNlTm9OdWxsVGVzdCIsCiAgICAgICAgICAgICJvcmcvYXBhY2hl\nL29wZW5qcGEvcGVyc2lzdGVuY2UvamRiYy9vcmRlci8iICsKICAgICAgICAg\nICAgIm9yZGVyLXBlcnNpc3RlbmNlLTQueG1sIik7CgogICAgICAgIE9wZW5K\nUEFDb25maWd1cmF0aW9uIGNvbmYgPSBlbWYxLmdldENvbmZpZ3VyYXRpb24o\nKTsKICAgICAgICBNZXRhRGF0YVJlcG9zaXRvcnkgcmVwb3MgPSBjb25mLmdl\ndE1ldGFEYXRhUmVwb3NpdG9yeUluc3RhbmNlKCk7CgogICAgICAgIC8vIEZv\ncmNlIGVudGl0eSByZXNvbHV0aW9uCiAgICAgICAgcmVwb3MuZ2V0TWV0YURh\ndGEoQmFzZVRlc3RFbnRpdHkyLmNsYXNzLCBudWxsLCB0cnVlKTsKICAgICAg\nICAKICAgICAgICBPcGVuSlBBRW50aXR5TWFuYWdlclNQSSBlbSA9IGVtZjEu\nY3JlYXRlRW50aXR5TWFuYWdlcigpOwoKICAgICAgICB2YWxpZGF0ZU9yZGVy\nQ29sdW1uTnVsbGFibGUoZW1mMSwgQmFzZVRlc3RFbnRpdHkyLmNsYXNzLCAK\nICAgICAgICAgICAgIm9uZTJNZWxlbXMiLCBmYWxzZSk7CgogICAgICAgIHZh\nbGlkYXRlT3JkZXJDb2x1bW5OdWxsYWJsZShlbWYxLCBCYXNlVGVzdEVudGl0\neTIuY2xhc3MsIAogICAgICAgICAgICAgICAgImNvbGxlbGVtcyIsIGZhbHNl\nKTsKCiAgICAgICAgdmFsaWRhdGVPcmRlckNvbHVtbk51bGxhYmxlKGVtZjEs\nIEJhc2VUZXN0RW50aXR5Mi5jbGFzcywgCiAgICAgICAgICAgICAgICAibTJt\nZWxlbXMiLCBmYWxzZSk7CgogICAgICAgIGVtLmNsb3NlKCk7CiAgICAgICAg\ndHJ5IHsKICAgICAgICAgICAgaWYgKGVtZjEgIT0gbnVsbCkKICAgICAgICAg\nICAgICAgIGNsZWFudXBFTUYoZW1mMSk7CiAgICAgICAgfSBjYXRjaCAoRXhj\nZXB0aW9uIGUpIHsKICAgICAgICAgICAgZS5wcmludFN0YWNrVHJhY2UoKTsK\nICAgICAgICAgICAgZmFpbChlLmdldE1lc3NhZ2UoKSk7CiAgICAgICAgfSAg\nICAgICAgCiAgICB9CiAgICAKICAgIC8qCiAgICAgKiBWYWxpZGF0ZXMgdGhl\nIHVzZSBvZiB0aGUgY29sdW1uRGVmaW5pdGlvbiBhdHRyaWJ1dGUgb24gT3Jk\nZXJDb2x1bW4uCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHRlc3RPcmRlckNv\nbHVtbkNvbHVtbkRlZmluaXRpb24oKSB7CgogICAgICAgIE9wZW5KUEFFbnRp\ndHlNYW5hZ2VyRmFjdG9yeVNQSSBlbWYxID0gCiAgICAgICAgICAgIChPcGVu\nSlBBRW50aXR5TWFuYWdlckZhY3RvcnlTUEkpT3BlbkpQQVBlcnNpc3RlbmNl\nLgogICAgICAgICAgICBjcmVhdGVFbnRpdHlNYW5hZ2VyRmFjdG9yeSgiQ29s\nRGVmVGVzdCIsCiAgICAgICAgICAgICJvcmcvYXBhY2hlL29wZW5qcGEvcGVy\nc2lzdGVuY2UvamRiYy9vcmRlci8iICsKICAgICAgICAgICAgIm9yZGVyLXBl\ncnNpc3RlbmNlLTIueG1sIik7CgogICAgICAgIC8vIENyZWF0ZSB0aGUgRU0u\nICBUaGlzIHdpbGwgc3BhcmsgdGhlIG1hcHBpbmcgdG9vbC4KICAgICAgICBP\ncGVuSlBBRW50aXR5TWFuYWdlclNQSSBlbSA9IGVtZjEuY3JlYXRlRW50aXR5\nTWFuYWdlcigpOyAgICAgICAgCiAgICAgICAgLy8gCiAgICAgICAgLy8gQ3Jl\nYXRlIGEgY29sbGVjdGlvbiB1c2luZyBhIGN1c3RvbSBjb2x1bW4gZGVmaW5p\ndGlvbgogICAgICAgIHZhbGlkYXRlT3JkZXJDb2x1bW5EZWYoZW1mMSwgQ29s\nRGVmVGVzdEVudGl0eS5jbGFzcywgCiAgICAgICAgICAgICJvbmUyTWNvbGRl\nZiIsICJJTlRFR0VSIik7CgogICAgICAgIHZhbGlkYXRlT3JkZXJDb2x1bW5E\nZWYoZW1mMSwgQ29sRGVmVGVzdEVudGl0eS5jbGFzcywgCiAgICAgICAgICAg\nICJjb2xsY29sZGVmIiwgIklOVEVHRVIiKTsKCiAgICAgICAgdmFsaWRhdGVP\ncmRlckNvbHVtbkRlZihlbWYxLCBDb2xEZWZUZXN0RW50aXR5LmNsYXNzLCAK\nICAgICAgICAgICAgIm0ybWNvbGRlZiIsICJJTlRFR0VSIik7CgogICAgICAg\nIC8vIEFkZCBhbmQgcXVlcnkgc29tZSB2YWx1ZXMKICAgICAgICBDb2xEZWZU\nZXN0RW50aXR5IGNkZW50ID0gbmV3IENvbERlZlRlc3RFbnRpdHkoKTsKICAg\nICAgICAKICAgICAgICBDb2xEZWZUZXN0RWxlbWVudCBjZGVsMSA9IG5ldyBD\nb2xEZWZUZXN0RWxlbWVudCgiRWxlbWVudDEiKTsKICAgICAgICBDb2xEZWZU\nZXN0RWxlbWVudCBjZGVsMiA9IG5ldyBDb2xEZWZUZXN0RWxlbWVudCgiRWxl\nbWVudDIiKTsKICAgICAgICBDb2xEZWZUZXN0RWxlbWVudCBjZGVsMyA9IG5l\ndyBDb2xEZWZUZXN0RWxlbWVudCgiRWxlbWVudDMiKTsKICAgICAgICAKICAg\nICAgICBMaXN0PENvbERlZlRlc3RFbGVtZW50PiBvbmUyTWNvbGRlZiA9IAog\nICAgICAgICAgICBuZXcgQXJyYXlMaXN0PENvbERlZlRlc3RFbGVtZW50Pigp\nOwogICAgICAgIG9uZTJNY29sZGVmLmFkZChjZGVsMyk7CiAgICAgICAgb25l\nMk1jb2xkZWYuYWRkKGNkZWwyKTsKICAgICAgICBvbmUyTWNvbGRlZi5hZGQo\nY2RlbDEpOwogICAgICAgIGNkZW50LnNldE9uZTJNY29sZGVmKG9uZTJNY29s\nZGVmKTsKCiAgICAgICAgU2V0PENvbERlZlRlc3RFbGVtZW50PiBjb2xsY29s\nZGVmID0gCiAgICAgICAgICAgIG5ldyBMaW5rZWRIYXNoU2V0PENvbERlZlRl\nc3RFbGVtZW50PigpOwogICAgICAgIGNvbGxjb2xkZWYuYWRkKGNkZWwxKTsK\nICAgICAgICBjb2xsY29sZGVmLmFkZChjZGVsMik7CiAgICAgICAgY29sbGNv\nbGRlZi5hZGQoY2RlbDMpOwogICAgICAgIGNkZW50LnNldENvbGxjb2xkZWYo\nY29sbGNvbGRlZik7CiAgICAgICAgCiAgICAgICAgTGlzdDxDb2xEZWZUZXN0\nRWxlbWVudD4gbTJtY29sZGVmID0gbmV3IEFycmF5TGlzdDxDb2xEZWZUZXN0\nRWxlbWVudD4oKTsKICAgICAgICBtMm1jb2xkZWYuYWRkKGNkZWwyKTsKICAg\nICAgICBtMm1jb2xkZWYuYWRkKGNkZWwxKTsKICAgICAgICBtMm1jb2xkZWYu\nYWRkKGNkZWwzKTsKICAgICAgICBjZGVudC5zZXRNMm1jb2xkZWYobTJtY29s\nZGVmKTsKICAgICAgICAKICAgICAgICBlbS5nZXRUcmFuc2FjdGlvbigpLmJl\nZ2luKCk7CiAgICAgICAgZW0ucGVyc2lzdChjZGVudCk7CiAgICAgICAgZW0u\nZ2V0VHJhbnNhY3Rpb24oKS5jb21taXQoKTsKICAgICAgICAKICAgICAgICBl\nbS5jbG9zZSgpOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIGlmIChlbWYx\nICE9IG51bGwpCiAgICAgICAgICAgICAgICBjbGVhbnVwRU1GKGVtZjEpOwog\nICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgIGZh\naWwoZS5nZXRNZXNzYWdlKCkpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioK\nICAgICAqIFZhbGlkYXRlcyB0aGUgdXNlIG9mIHRoZSB0YWJsZSBhdHRyaWJ1\ndGUgZGVmaW5lZCBpbiBYTUwKICAgICAqLwogICAgcHVibGljIHZvaWQgdGVz\ndE9yZGVyQ29sdW1uVGFibGVYTUwoKSB7ICAgCiAgICAgICAgCiAgICAgICAg\nT3BlbkpQQUVudGl0eU1hbmFnZXJGYWN0b3J5U1BJIGVtZjEgPSAKICAgICAg\nICAgICAgKE9wZW5KUEFFbnRpdHlNYW5hZ2VyRmFjdG9yeVNQSSlPcGVuSlBB\nUGVyc2lzdGVuY2UuCiAgICAgICAgICAgIGNyZWF0ZUVudGl0eU1hbmFnZXJG\nYWN0b3J5KCJUYWJsZVRlc3QiLCAKICAgICAgICAgICAgIm9yZy9hcGFjaGUv\nb3BlbmpwYS9wZXJzaXN0ZW5jZS9qZGJjL29yZGVyLyIgKwogICAgICAgICAg\nICAib3JkZXItcGVyc2lzdGVuY2UtNS54bWwiKTsKICAgICAgICAKICAgICAg\nICBPcGVuSlBBRW50aXR5TWFuYWdlclNQSSBlbSA9IGVtZjEuY3JlYXRlRW50\naXR5TWFuYWdlcigpOwogICAgICAgIAogICAgICAgIHZhbGlkYXRlT3JkZXJD\nb2x1bW5UYWJsZShlbWYxLCBCYXNlVGVzdEVudGl0eTMuY2xhc3MsICJvbmUy\nTWVsZW1zIiwgCiAgICAgICAgICAgICJ4bWxfbzJtX3RhYmxlIiwgIm9uZTJN\nT3JkZXIiKTsgCiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgdmFsaWRh\ndGVPcmRlckNvbHVtblRhYmxlKGVtZjEsIEJhc2VUZXN0RW50aXR5My5jbGFz\ncywgIm0ybWVsZW1zIiwgCiAgICAgICAgICAgICAieG1sX20ybV90YWJsZSIs\nICJtMm1vcmRlciIpOyAKCiAgICAgICAgdmFsaWRhdGVPcmRlckNvbHVtblRh\nYmxlKGVtZjEsIEJhc2VUZXN0RW50aXR5My5jbGFzcywgImNvbGxlbGVtcyIs\nIAogICAgICAgICAgICAgInhtbF9jb2xsX3RhYmxlIiwgImNvbGxlbGVtc19P\nUkRFUiIpOyAKICAgICAgICAKICAgICAgICBlbS5jbG9zZSgpOwogICAgICAg\nIHRyeSB7CiAgICAgICAgICAgIGlmIChlbWYxICE9IG51bGwpCiAgICAgICAg\nICAgICAgICBjbGVhbnVwRU1GKGVtZjEpOwogICAgICAgIH0gY2F0Y2ggKEV4\nY2VwdGlvbiBlKSB7CiAgICAgICAgICAgIGZhaWwoZS5nZXRNZXNzYWdlKCkp\nOwogICAgICAgIH0gICAgICAgIAogICAgfQoKICAgIAogICAgLyoKICAgICAq\nIFZhbGlkYXRlcyBPcmRlckJ5IGFuZCBPcmRlckNvbHVtbiBzaG91bGQgbm90\nIGJlIHNwZWNpZmllZCB0b2dldGhlciBwZXIgCiAgICAgKiB0aGUgSlBBIDIu\nMCBzcGVjLgogICAgICovCiAgICBwdWJsaWMgdm9pZCB0ZXN0T3JkZXJDb2x1\nbW5PcmRlckJ5KCkgewogICAgICAgIAogICAgICAgIE9wZW5KUEFFbnRpdHlN\nYW5hZ2VyRmFjdG9yeVNQSSBlbWYxID0gbnVsbDsKICAgICAgICBPcGVuSlBB\nRW50aXR5TWFuYWdlclNQSSBlbSA9IG51bGw7CiAgICAgICAgdHJ5IHsKICAg\nICAgICAgICAgZW1mMSA9IChPcGVuSlBBRW50aXR5TWFuYWdlckZhY3RvcnlT\nUEkpT3BlbkpQQVBlcnNpc3RlbmNlLgogICAgICAgICAgICAgICAgY3JlYXRl\nRW50aXR5TWFuYWdlckZhY3RvcnkoIk9iT2NUZXN0IiwgCiAgICAgICAgICAg\nICAgICAgICAgIm9yZy9hcGFjaGUvb3BlbmpwYS9wZXJzaXN0ZW5jZS9qZGJj\nL29yZGVyLyIgKwogICAgICAgICAgICAgICAgICAgICJvcmRlci1wZXJzaXN0\nZW5jZS0zLnhtbCIpOwogICAgICAgIAogICAgICAgICAgICBlbSA9IGVtZjEu\nY3JlYXRlRW50aXR5TWFuYWdlcigpOwogICAgICAgICAgICAKICAgICAgICAg\nICAgT2JPY0VudGl0eSBlbnQgPSBuZXcgT2JPY0VudGl0eSgpOwogICAgICAg\nICAgICBMaXN0PEludGVnZXI+IGludExpc3QgPSBuZXcgQXJyYXlMaXN0PElu\ndGVnZXI+KCk7CiAgICAgICAgICAgIGludExpc3QuYWRkKG5ldyBJbnRlZ2Vy\nKDEwKSk7CiAgICAgICAgICAgIGludExpc3QuYWRkKG5ldyBJbnRlZ2VyKDIw\nKSk7CiAgICAgICAgICAgIGVudC5zZXRJbnRMaXN0KGludExpc3QpOwogICAg\nICAgICAgICAKICAgICAgICAgICAgZW0uZ2V0VHJhbnNhY3Rpb24oKS5iZWdp\nbigpOwogICAgICAgICAgICBlbS5wZXJzaXN0KGludExpc3QpOwogICAgICAg\nICAgICBlbS5nZXRUcmFuc2FjdGlvbigpLmNvbW1pdCgpOwoKICAgICAgICAg\nICAgZW0uY2xvc2UoKTsKICAgICAgICAgICAgZW0gPSBudWxsOwogICAgICAg\nICAgICBmYWlsKCJBbiBleGNlcHRpb24gc2hvdWxkIGhhdmUgYmVlbiB0aHJv\nd24uIik7CiAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAgICAg\nICAgICAgYXNzZXJ0RXhjZXB0aW9uKGUsIEFyZ3VtZW50RXhjZXB0aW9uLmNs\nYXNzKTsKICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICBpZiAoZW0g\nIT0gbnVsbCkKICAgICAgICAgICAgICAgIGVtLmNsb3NlKCk7CiAgICAgICAg\nfQogICAgICAgIHRyeSB7CiAgICAgICAgICAgIGlmIChlbWYxICE9IG51bGwp\nCiAgICAgICAgICAgICAgICBjbGVhbnVwRU1GKGVtZjEpOwogICAgICAgIH0g\nY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgIGZhaWwoZS5nZXRN\nZXNzYWdlKCkpOwogICAgICAgIH0gICAgICAgIAogICAgfQogICAgCiAgICBw\ndWJsaWMgdm9pZCB0ZXN0T3JkZXJDb2x1bW5NZXRhRGF0YVNlcmlhbGl6YXRp\nb24oKSAKICAgICAgICB0aHJvd3MgRXhjZXB0aW9uIHsKCiAgICAgICAgT3Bl\nbkpQQUVudGl0eU1hbmFnZXJGYWN0b3J5U1BJIGVtZjEgPSAKICAgICAgICAg\nICAgKE9wZW5KUEFFbnRpdHlNYW5hZ2VyRmFjdG9yeVNQSSlPcGVuSlBBUGVy\nc2lzdGVuY2UuCiAgICAgICAgICAgIGNyZWF0ZUVudGl0eU1hbmFnZXJGYWN0\nb3J5KCJCYXNlVGVzdCIsIAogICAgICAgICAgICAib3JnL2FwYWNoZS9vcGVu\nanBhL3BlcnNpc3RlbmNlL2pkYmMvb3JkZXIvIiArCiAgICAgICAgICAgICJv\ncmRlci1wZXJzaXN0ZW5jZS54bWwiKTsKCiAgICAgICAgT3BlbkpQQUNvbmZp\nZ3VyYXRpb24gY29uZiA9IGVtZjEuZ2V0Q29uZmlndXJhdGlvbigpOwogICAg\nICAgIE1ldGFEYXRhUmVwb3NpdG9yeSByZXBvcyA9IGNvbmYubmV3TWV0YURh\ndGFSZXBvc2l0b3J5SW5zdGFuY2UoKTsKCiAgICAgICAgLy8gRm9yY2UgZW50\naXR5IHJlc29sdXRpb24KICAgICAgICByZXBvcy5nZXRNZXRhRGF0YShCYXNl\nVGVzdEVudGl0eTEuY2xhc3MsIG51bGwsIHRydWUpOwoKICAgICAgICBYTUxQ\nZXJzaXN0ZW5jZU1hcHBpbmdTZXJpYWxpemVyIHNlciA9CiAgICAgICAgICAg\nIG5ldyBYTUxQZXJzaXN0ZW5jZU1hcHBpbmdTZXJpYWxpemVyKChKREJDQ29u\nZmlndXJhdGlvbiljb25mKTsKICAgICAgICBzZXIuYWRkQWxsKHJlcG9zKTsK\nICAgICAgICBCeXRlQXJyYXlPdXRwdXRTdHJlYW0gb3V0ID0gbmV3IEJ5dGVB\ncnJheU91dHB1dFN0cmVhbSgpOwogICAgICAgIHNlci5zZXJpYWxpemUobmV3\nIE91dHB1dFN0cmVhbVdyaXRlcihvdXQpLCBNZXRhRGF0YVNlcmlhbGl6ZXIu\nUFJFVFRZKTsKICAgICAgICBieXRlW10gYnl0ZXMgPSBvdXQudG9CeXRlQXJy\nYXkoKTsKICAgICAgICAKICAgICAgICBYTUxQZXJzaXN0ZW5jZU1hcHBpbmdQ\nYXJzZXIgcGFyc2VyID0KICAgICAgICAgICAgbmV3IFhNTFBlcnNpc3RlbmNl\nTWFwcGluZ1BhcnNlcigoSkRCQ0NvbmZpZ3VyYXRpb24pY29uZik7CiAgICAg\nICAgcGFyc2VyLnBhcnNlKG5ldyBJbnB1dFN0cmVhbVJlYWRlcgogICAgICAg\nICAgICAobmV3IEJ5dGVBcnJheUlucHV0U3RyZWFtKGJ5dGVzKSksICJieXRl\ncyIpOwogICAgICAgIE1ldGFEYXRhUmVwb3NpdG9yeSBtZHIyID0gcGFyc2Vy\nLmdldFJlcG9zaXRvcnkoKTsKCiAgICAgICAgQ2xhc3NNZXRhRGF0YSBfZW50\naXR5TWV0YTIgPSAKICAgICAgICAgICAgbWRyMi5nZXRNZXRhRGF0YShCYXNl\nVGVzdEVudGl0eTEuY2xhc3MsIG51bGwsIHRydWUpOwoKICAgICAgICAvLyBB\nc3NlcnQgbWV0YWRhdGEgaXMgcG9wdWxhdGVkIGNvcnJlY3RseQogICAgICAg\nIEZpZWxkTWFwcGluZyBmbSA9IChGaWVsZE1hcHBpbmcpX2VudGl0eU1ldGEy\nLmdldEZpZWxkKCJvbmUyTWVsZW1zIik7CiAgICAgICAgQ29sdW1uIG9jID0g\nZm0uZ2V0T3JkZXJDb2x1bW4oKTsKICAgICAgICBhc3NlcnROb3ROdWxsKG9j\nKTsKICAgICAgICBhc3NlcnRFcXVhbHMob2MuZ2V0TmFtZSgpLCJvbmUyTU9y\nZGVyIik7CgogICAgICAgIGZtID0gKEZpZWxkTWFwcGluZylfZW50aXR5TWV0\nYTIuZ2V0RmllbGQoIm0ybWVsZW1zIik7CiAgICAgICAgb2MgPSBmbS5nZXRP\ncmRlckNvbHVtbigpOwogICAgICAgIGFzc2VydE5vdE51bGwob2MpOwogICAg\nICAgIGFzc2VydEVxdWFscyhvYy5nZXROYW1lKCksIm0ybW9yZGVyIik7Cgog\nICAgICAgIGZtID0gKEZpZWxkTWFwcGluZylfZW50aXR5TWV0YTIuZ2V0Rmll\nbGQoImNvbGxlbGVtcyIpOwogICAgICAgIG9jID0gZm0uZ2V0T3JkZXJDb2x1\nbW4oKTsKICAgICAgICBhc3NlcnROb3ROdWxsKG9jKTsKICAgICAgICBhc3Nl\ncnRFcXVhbHMob2MuZ2V0TmFtZSgpLCJjb2xsZWxlbXNfT1JERVIiKTsKCiAg\nICAgICAgdHJ5IHsKICAgICAgICAgICAgaWYgKGVtZjEgIT0gbnVsbCkKICAg\nICAgICAgICAgICAgIGNsZWFudXBFTUYoZW1mMSk7CiAgICAgICAgfSBjYXRj\naCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgZmFpbChlLmdldE1lc3Nh\nZ2UoKSk7CiAgICAgICAgfSAgICAgICAgCiAgICB9CiAgICAgICAgICAgICAg\nIAogICAgcHJpdmF0ZSBDb2x1bW4gZ2V0T3JkZXJDb2x1bW4oT3BlbkpQQUVu\ndGl0eU1hbmFnZXJGYWN0b3J5U1BJIGVtZjEsIAogICAgICAgIENsYXNzIGNs\nYXp6LCBTdHJpbmcgZmllbGROYW1lKSB7CiAgICAgICAgSkRCQ0NvbmZpZ3Vy\nYXRpb24gY29uZiA9IChKREJDQ29uZmlndXJhdGlvbikgZW1mMS5nZXRDb25m\naWd1cmF0aW9uKCk7CiAgICAgICAgQ2xhc3NNYXBwaW5nIGNscyA9IGNvbmYu\nZ2V0TWFwcGluZ1JlcG9zaXRvcnlJbnN0YW5jZSgpLgogICAgICAgICAgICBn\nZXRNYXBwaW5nKGNsYXp6LCBudWxsLCB0cnVlKTsKICAgICAgICBGaWVsZE1h\ncHBpbmcgZm0gPSBjbHMuZ2V0RmllbGRNYXBwaW5nKGZpZWxkTmFtZSk7CiAg\nICAgICAgQ29sdW1uIG9jID0gZm0uZ2V0T3JkZXJDb2x1bW4oKTsKICAgICAg\nICBhc3NlcnROb3ROdWxsKG9jKTsKICAgICAgICByZXR1cm4gb2M7CiAgICB9\nCgogICAgcHJpdmF0ZSB2b2lkIHZhbGlkYXRlT3JkZXJDb2x1bW5UYWJsZSgK\nICAgICAgICAgICAgT3BlbkpQQUVudGl0eU1hbmFnZXJGYWN0b3J5U1BJIGVt\nZjEsIAogICAgICAgICAgICBDbGFzcyBjbGF6eiwgU3RyaW5nIGZpZWxkTmFt\nZSwgU3RyaW5nIHRhYmxlTmFtZSwgCiAgICAgICAgICAgIFN0cmluZyBjb2x1\nbW5OYW1lKSB7ICAgICAgICAKICAgICAgICAgICAgQ29sdW1uIG9jID0gZ2V0\nT3JkZXJDb2x1bW4oZW1mMSwgY2xhenosIGZpZWxkTmFtZSk7CiAgICAgICAg\nICAgIC8vIFZlcmlmeSB0aGUgb2MgaGFzIHRoZSBjb3JyZWN0IHRhYmxlIG5h\nbWUKICAgICAgICAgICAgYXNzZXJ0VHJ1ZShvYy5nZXRUYWJsZU5hbWUoKS5l\ncXVhbHNJZ25vcmVDYXNlKHRhYmxlTmFtZSkpOwogICAgICAgICAgICAvLyBW\nZXJpZnkgdGhlIHRhYmxlIGV4aXN0cyBpbiB0aGUgZGIKICAgICAgICAgICAg\nYXNzZXJ0VHJ1ZSh0YWJsZUFuZENvbHVtbkV4aXN0cyhlbWYxLCBudWxsLCB0\nYWJsZU5hbWUsIG51bGwsIAogICAgICAgICAgICAgICAgY29sdW1uTmFtZSkp\nOwogICAgfQoKICAgIHByaXZhdGUgdm9pZCB2YWxpZGF0ZU9yZGVyQ29sdW1u\nRGVmKAogICAgICAgICAgICBPcGVuSlBBRW50aXR5TWFuYWdlckZhY3RvcnlT\nUEkgZW1mMSwgQ2xhc3MgY2xhenosIFN0cmluZyBmaWVsZE5hbWUsIAogICAg\nICAgICAgICBTdHJpbmcgdHlwZSkgeyAgICAgICAgCiAgICAgICAgICAgIENv\nbHVtbiBvYyA9IGdldE9yZGVyQ29sdW1uKGVtZjEsIGNsYXp6LCBmaWVsZE5h\nbWUpOwogICAgICAgICAgICBhc3NlcnRFcXVhbHModHlwZSwgb2MuZ2V0VHlw\nZU5hbWUoKSk7CiAgICB9CgogICAgcHJpdmF0ZSB2b2lkIHZhbGlkYXRlT3Jk\nZXJDb2x1bW5OdWxsYWJsZSgKICAgICAgICAgICAgT3BlbkpQQUVudGl0eU1h\nbmFnZXJGYWN0b3J5U1BJIGVtZjEsIENsYXNzIGNsYXp6LCBTdHJpbmcgZmll\nbGROYW1lLCAKICAgICAgICAgICAgYm9vbGVhbiBudWxsYWJsZSkgewogICAg\nICAgICAgICBDb2x1bW4gb2MgPSBnZXRPcmRlckNvbHVtbihlbWYxLCBjbGF6\neiwgZmllbGROYW1lKTsKICAgICAgICAgICAgYXNzZXJ0RXF1YWxzKG51bGxh\nYmxlLCAhb2MuaXNOb3ROdWxsKCkpOwogICAgfQoKCiAgICAvKioKICAgICAq\nIE1ldGhvZCB0byB2ZXJpZnkgYSB0YWJsZSB3YXMgY3JlYXRlZCBmb3IgdGhl\nIGdpdmVuIG5hbWUgYW5kIHNjaGVtYQogICAgICovCiAgICBwcml2YXRlIGJv\nb2xlYW4gdGFibGVBbmRDb2x1bW5FeGlzdHMoT3BlbkpQQUVudGl0eU1hbmFn\nZXJGYWN0b3J5U1BJIGVtZjEsIAogICAgICAgICAgICBPcGVuSlBBRW50aXR5\nTWFuYWdlclNQSSBlbSwgU3RyaW5nIHRhYmxlTmFtZSwgU3RyaW5nIHNjaGVt\nYU5hbWUsCiAgICAgICAgICAgIFN0cmluZyBjb2x1bW5OYW1lKSB7CiAgICAg\nICAgSkRCQ0NvbmZpZ3VyYXRpb24gY29uZiA9IChKREJDQ29uZmlndXJhdGlv\nbikgZW1mMS5nZXRDb25maWd1cmF0aW9uKCk7CiAgICAgICAgREJEaWN0aW9u\nYXJ5IGRpY3QgPSBjb25mLmdldERCRGljdGlvbmFyeUluc3RhbmNlKCk7CiAg\nICAgICAgT3BlbkpQQUVudGl0eU1hbmFnZXJTUEkgZW0xID0gZW07CiAgICAg\nICAgICAgICAgICAKICAgICAgICAvLyBJZiBubyBlbSBzdXBwbGllZCwgY3Jl\nYXRlIG9uZQogICAgICAgIGlmIChlbTEgPT0gbnVsbCkgewogICAgICAgICAg\nICBlbTEgPSBlbWYxLmNyZWF0ZUVudGl0eU1hbmFnZXIoKTsKICAgICAgICB9\nCiAgICAgICAgQ29ubmVjdGlvbiBjb25uID0gKENvbm5lY3Rpb24pZW0xLmdl\ndENvbm5lY3Rpb24oKTsKICAgICAgICB0cnkgewogICAgICAgICAgICBEYXRh\nYmFzZU1ldGFEYXRhIGRibWQgPSBjb25uLmdldE1ldGFEYXRhKCk7CiAgICAg\nICAgICAgIC8vIChtZXRhLCBjYXRhbG9nLCBzY2hlbWFOYW1lLCB0YWJsZU5h\nbWUsIGNvbm4pCiAgICAgICAgICAgIENvbHVtbltdIGNvbHMgPSBkaWN0Lmdl\ndENvbHVtbnMoZGJtZCwgbnVsbCwgbnVsbCwgCiAgICAgICAgICAgICAgICAg\nICAgdGFibGVOYW1lLCBjb2x1bW5OYW1lLCBjb25uKTsKICAgICAgICAgICAg\naWYgKGNvbHMgIT0gbnVsbCAmJiBjb2xzLmxlbmd0aCA9PSAxKSB7CiAgICAg\nICAgICAgICAgICBDb2x1bW4gY29sID0gY29sc1swXTsKICAgICAgICAgICAg\nICAgIFN0cmluZyBjb2xOYW1lID0gY29sLmdldE5hbWUoKTsKICAgICAgICAg\nICAgICAgIGlmIChjb2wuZ2V0VGFibGVOYW1lKCkuZXF1YWxzSWdub3JlQ2Fz\nZSh0YWJsZU5hbWUpICYmCiAgICAgICAgICAgICAgICAgICAgKHNjaGVtYU5h\nbWUgPT0gbnVsbCB8fCAKICAgICAgICAgICAgICAgICAgICBjb2wuZ2V0U2No\nZW1hTmFtZSgpLmVxdWFsc0lnbm9yZUNhc2Uoc2NoZW1hTmFtZSkpICYmCiAg\nICAgICAgICAgICAgICAgICAgY29sTmFtZS5lcXVhbHNJZ25vcmVDYXNlKGNv\nbHVtbk5hbWUpKQogICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwog\nICAgICAgICAgICB9CiAgICAgICAgfSBjYXRjaCAoVGhyb3dhYmxlIGUpIHsK\nICAgICAgICAgICAgZmFpbCgiVW5hYmxlIHRvIGdldCBjb2x1bW4gaW5mb3Jt\nYXRpb24uIik7CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgaWYg\nKGVtID09IG51bGwpIHsKICAgICAgICAgICAgICAgIGVtMS5jbG9zZSgpOwog\nICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiBmYWxzZTsK\nICAgIH0KICAgIC8qKgogICAgICogQ2xvc2VzIGEgc3BlY2lmaWMgZW50aXR5\nIG1hbmFnZXIgZmFjdG9yeSBhbmQgY2xlYW5zIHVwIAogICAgICogYXNzb2Np\nYXRlZCB0YWJsZXMuCiAgICAgKi8KICAgIHByaXZhdGUgdm9pZCBjbGVhbnVw\nRU1GKE9wZW5KUEFFbnRpdHlNYW5hZ2VyRmFjdG9yeVNQSSBlbWYxKSAKICAg\nICAgdGhyb3dzIEV4Y2VwdGlvbiB7CgogICAgICAgIGlmIChlbWYxID09IG51\nbGwpCiAgICAgICAgICAgIHJldHVybjsKCiAgICAgICAgdHJ5IHsKICAgICAg\nICAgICAgY2xlYXIoZW1mMSk7CiAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9u\nIGUpIHsKICAgICAgICAgICAgLy8gaWYgYSB0ZXN0IGZhaWxlZCwgc3dhbGxv\ndyBhbnkgZXhjZXB0aW9ucyB0aGF0IGhhcHBlbgogICAgICAgICAgICAvLyBk\ndXJpbmcgdGVhci1kb3duLCBhcyB0aGVzZSBqdXN0IG1hc2sgdGhlIG9yaWdp\nbmFsIHByb2JsZW0uCiAgICAgICAgICAgIGlmICh0ZXN0UmVzdWx0Lndhc1N1\nY2Nlc3NmdWwoKSkKICAgICAgICAgICAgICAgIHRocm93IGU7CiAgICAgICAg\nfSBmaW5hbGx5IHsKICAgICAgICAgICAgY2xvc2VFTUYoZW1mMSk7CiAgICAg\nICAgfQogICAgfSAgICAKIH0K\n","encoding":"base64"}

