{"sha":"30b67b0a79378651f9a584f5e13c5961f161add2","node_id":"MDQ6QmxvYjIwNjM2NDozMGI2N2IwYTc5Mzc4NjUxZjlhNTg0ZjVlMTNjNTk2MWYxNjFhZGQy","size":6392,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/30b67b0a79378651f9a584f5e13c5961f161add2","content":"LyoKICogVGVzdEV4dGVudHMyLmphdmEKICoKICogQ3JlYXRlZCBvbiBPY3Rv\nYmVyIDEwLCAyMDA2LCA1OjMwIFBNCiAqCiAqIFRvIGNoYW5nZSB0aGlzIHRl\nbXBsYXRlLCBjaG9vc2UgVG9vbHMgfCBUZW1wbGF0ZSBNYW5hZ2VyCiAqIGFu\nZCBvcGVuIHRoZSB0ZW1wbGF0ZSBpbiB0aGUgZWRpdG9yLgogKi8KCi8qCiAq\nIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRhdGlvbiAo\nQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBsaWNlbnNl\nIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRpc3RyaWJ1\ndGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9ybWF0aW9u\nCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhlIEFTRiBs\naWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBBcGFjaGUg\nTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIpOyB5b3Ug\nbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlCiAq\nIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2Yg\ndGhlIExpY2Vuc2UgYXQKICoKICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xp\nY2Vuc2VzL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBh\ncHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywKICogc29m\ndHdhcmUgZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJp\nYnV0ZWQgb24gYW4KICogIkFTIElTIiBCQVNJUywgV0lUSE9VVCBXQVJSQU5U\nSUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZCiAqIEtJTkQsIGVpdGhlciBleHBy\nZXNzIG9yIGltcGxpZWQuICBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZQogKiBz\ncGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kIGxp\nbWl0YXRpb25zCiAqIHVuZGVyIHRoZSBMaWNlbnNlLiAgICAKICovCnBhY2th\nZ2Ugb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNlLmtlcm5lbDsKCmlt\ncG9ydCBqYXZhLnV0aWwuSXRlcmF0b3I7CgoKCmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEucGVyc2lzdGVuY2Uua2VybmVsLmNvbW1vbi5hcHBzLlJ1bnRp\nbWVUZXN0MTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5j\nZS5rZXJuZWwuY29tbW9uLmFwcHMuUnVudGltZVRlc3QyOwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNlLmtlcm5lbC5jb21tb24uYXBw\ncy5SdW50aW1lVGVzdDM7CgppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnBl\ncnNpc3RlbmNlLkV4dGVudDsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5w\nZXJzaXN0ZW5jZS5PcGVuSlBBRW50aXR5TWFuYWdlcjsKCnB1YmxpYyBjbGFz\ncyBUZXN0RXh0ZW50czIgZXh0ZW5kcyBCYXNlS2VybmVsVGVzdCB7CgogICAg\ncHJpdmF0ZSBPYmplY3QgX29pZDEgPSBudWxsOwogICAgcHJpdmF0ZSBPYmpl\nY3QgX29pZDIgPSBudWxsOwogICAgcHJpdmF0ZSBPYmplY3QgX29pZDMgPSBu\ndWxsOwoKICAgIHB1YmxpYyBUZXN0RXh0ZW50czIoU3RyaW5nIG5hbWUpIHsK\nICAgICAgICBzdXBlcihuYW1lKTsKICAgIH0KCiAgICAvKioKICAgICAqIENy\nZWF0ZXMgYSBuZXcgaW5zdGFuY2Ugb2YgVGVzdEV4dGVudHMyCiAgICAgKi8K\nICAgIHB1YmxpYyBUZXN0RXh0ZW50czIoKSB7CiAgICB9CgogICAgcHVibGlj\nIHZvaWQgc2V0VXAoKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBzdXBl\nci5zZXRVcChSdW50aW1lVGVzdDEuY2xhc3MsIFJ1bnRpbWVUZXN0Mi5jbGFz\ncywgUnVudGltZVRlc3QzLmNsYXNzKTsKCiAgICAgICAgUnVudGltZVRlc3Qx\nIHRlc3QxID0gbmV3IFJ1bnRpbWVUZXN0MSgpOwogICAgICAgIHRlc3QxLnNl\ndEludEZpZWxkKDEpOwogICAgICAgIFJ1bnRpbWVUZXN0MiB0ZXN0MiA9IG5l\ndyBSdW50aW1lVGVzdDIoKTsKICAgICAgICB0ZXN0Mi5zZXRJbnRGaWVsZCgy\nKTsKICAgICAgICB0ZXN0Mi5zZXRJbnRGaWVsZDIoMik7CiAgICAgICAgUnVu\ndGltZVRlc3QzIHRlc3QzID0gbmV3IFJ1bnRpbWVUZXN0MygpOwogICAgICAg\nIHRlc3QzLnNldEludEZpZWxkKDMpOwogICAgICAgIHRlc3QzLnNldEludEZp\nZWxkMygzKTsKCiAgICAgICAgT3BlbkpQQUVudGl0eU1hbmFnZXIgcG0gPSBn\nZXRQTSgpOwogICAgICAgIHN0YXJ0VHgocG0pOwogICAgICAgIHBtLnBlcnNp\nc3QodGVzdDEpOwogICAgICAgIHBtLnBlcnNpc3QodGVzdDIpOwogICAgICAg\nIHBtLnBlcnNpc3QodGVzdDMpOwogICAgICAgIF9vaWQxID0gcG0uZ2V0T2Jq\nZWN0SWQodGVzdDEpOwogICAgICAgIF9vaWQyID0gcG0uZ2V0T2JqZWN0SWQo\ndGVzdDIpOwogICAgICAgIF9vaWQzID0gcG0uZ2V0T2JqZWN0SWQodGVzdDMp\nOwogICAgICAgIGVuZFR4KHBtKTsKICAgICAgICBlbmRFbShwbSk7CiAgICB9\nCgogICAgcHVibGljIHZvaWQgdGVzdFByb3BlcnRpZXMoKSB7CiAgICAgICAg\nT3BlbkpQQUVudGl0eU1hbmFnZXIgcG0gPSBnZXRQTSgpOwogICAgICAgIEV4\ndGVudCBleHQgPSBwbS5jcmVhdGVFeHRlbnQoUnVudGltZVRlc3QyLmNsYXNz\nLCBmYWxzZSk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKHBtLCBleHQuZ2V0RW50\naXR5TWFuYWdlcigpKTsKICAgICAgICBhc3NlcnRFcXVhbHMoUnVudGltZVRl\nc3QyLmNsYXNzLCBleHQuZ2V0RWxlbWVudENsYXNzKCkpOwogICAgICAgIGFz\nc2VydFRydWUoIWV4dC5oYXNTdWJjbGFzc2VzKCkpOwoKICAgICAgICBleHQg\nPSBwbS5jcmVhdGVFeHRlbnQoUnVudGltZVRlc3QxLmNsYXNzLCB0cnVlKTsK\nICAgICAgICBhc3NlcnRFcXVhbHMocG0sIGV4dC5nZXRFbnRpdHlNYW5hZ2Vy\nKCkpOwogICAgICAgIGFzc2VydEVxdWFscyhSdW50aW1lVGVzdDEuY2xhc3Ms\nIGV4dC5nZXRFbGVtZW50Q2xhc3MoKSk7CiAgICAgICAgYXNzZXJ0VHJ1ZShl\neHQuaGFzU3ViY2xhc3NlcygpKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCB0\nZXN0Tm9TdWJjbGFzc2VzKCkgewogICAgICAgIE9wZW5KUEFFbnRpdHlNYW5h\nZ2VyIHBtID0gZ2V0UE0oKTsKICAgICAgICBFeHRlbnQgZXh0ID0gcG0uY3Jl\nYXRlRXh0ZW50KFJ1bnRpbWVUZXN0MS5jbGFzcywgZmFsc2UpOwogICAgICAg\nIEl0ZXJhdG9yIGl0ciA9IGV4dC5pdGVyYXRvcigpOwogICAgICAgIGFzc2Vy\ndFRydWUoaXRyLmhhc05leHQoKSk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKF9v\naWQxLCBwbS5nZXRPYmplY3RJZChpdHIubmV4dCgpKSk7CiAgICAgICAgYXNz\nZXJ0VHJ1ZSghaXRyLmhhc05leHQoKSk7CiAgICAgICAgZXh0LmNsb3NlQWxs\nKCk7CiAgICB9CgogICAgcHVibGljIHZvaWQgdGVzdFN1YmNsYXNzZXMoKSB7\nCiAgICAgICAgT3BlbkpQQUVudGl0eU1hbmFnZXIgcG0gPSBnZXRQTSgpOwog\nICAgICAgIEV4dGVudCBleHQgPSBwbS5jcmVhdGVFeHRlbnQoUnVudGltZVRl\nc3QxLmNsYXNzLCB0cnVlKTsKCiAgICAgICAgaW50IHRlc3QxQ291bnQgPSAw\nOwogICAgICAgIGludCB0ZXN0MkNvdW50ID0gMDsKICAgICAgICBpbnQgdGVz\ndDNDb3VudCA9IDA7CiAgICAgICAgT2JqZWN0IG5leHQ7CiAgICAgICAgZm9y\nIChJdGVyYXRvciBpdHIgPSBleHQuaXRlcmF0b3IoKTsgaXRyLmhhc05leHQo\nKTspIHsKICAgICAgICAgICAgbmV4dCA9IHBtLmdldE9iamVjdElkKGl0ci5u\nZXh0KCkpOwogICAgICAgICAgICBpZiAoX29pZDEuZXF1YWxzKG5leHQpKQog\nICAgICAgICAgICAgICAgdGVzdDFDb3VudCsrOwogICAgICAgICAgICBlbHNl\nIGlmIChfb2lkMi5lcXVhbHMobmV4dCkpCiAgICAgICAgICAgICAgICB0ZXN0\nMkNvdW50Kys7CiAgICAgICAgICAgIGVsc2UgaWYgKF9vaWQzLmVxdWFscyhu\nZXh0KSkKICAgICAgICAgICAgICAgIHRlc3QzQ291bnQrKzsKICAgICAgICB9\nCiAgICAgICAgZXh0LmNsb3NlQWxsKCk7CiAgICAgICAgYXNzZXJ0RXF1YWxz\nKDEsIHRlc3QxQ291bnQpOwogICAgICAgIGFzc2VydEVxdWFscygxLCB0ZXN0\nMkNvdW50KTsKICAgICAgICBhc3NlcnRFcXVhbHMoMSwgdGVzdDNDb3VudCk7\nCiAgICB9CgogICAgcHVibGljIHZvaWQgdGVzdENvbnRhaW5zTmV3bHlQZXJz\naXN0ZWQoKSB7CiAgICAgICAgUnVudGltZVRlc3QxIHRlc3QxID0gbmV3IFJ1\nbnRpbWVUZXN0MSgpOwogICAgICAgIFJ1bnRpbWVUZXN0MSB0ZXN0MiA9IG5l\ndyBSdW50aW1lVGVzdDIoKTsKCiAgICAgICAgT3BlbkpQQUVudGl0eU1hbmFn\nZXIgcG0gPSBnZXRQTSgpOwoKICAgICAgICAvLyBwY2w6IDE0IE9jdCAyMDAz\nOiBkZWZhdWx0IGluIDMuMCBpcyBub3cgdHJ1ZSwgYnV0IHRoaXMgdGVzdAog\nICAgICAgIC8vIGFzc3VtZXMgZmFsc2Ugc29tZXdoZXJlLgoKICAgICAgICBw\nbS5zZXRJZ25vcmVDaGFuZ2VzKGZhbHNlKTsKICAgICAgICBzdGFydFR4KHBt\nKTsKICAgICAgICB0cnkgewogICAgICAgICAgICBwbS5wZXJzaXN0KHRlc3Qx\nKTsKICAgICAgICAgICAgcG0ucGVyc2lzdCh0ZXN0Mik7CiAgICAgICAgICAg\nIE9iamVjdCBuZXdPaWQgPSBwbS5nZXRPYmplY3RJZCh0ZXN0MSk7CgogICAg\nICAgICAgICBFeHRlbnQgZXh0ID0gcG0uY3JlYXRlRXh0ZW50KFJ1bnRpbWVU\nZXN0MS5jbGFzcywgZmFsc2UpOwogICAgICAgICAgICBib29sZWFuIGZvdW5k\nT2lkMSA9IGZhbHNlOwogICAgICAgICAgICBib29sZWFuIGZvdW5kTmV3ID0g\nZmFsc2U7CiAgICAgICAgICAgIE9iamVjdCBuZXh0OwogICAgICAgICAgICBm\nb3IgKEl0ZXJhdG9yIGl0ciA9IGV4dC5pdGVyYXRvcigpOyBpdHIuaGFzTmV4\ndCgpOykgewogICAgICAgICAgICAgICAgbmV4dCA9IHBtLmdldE9iamVjdElk\nKGl0ci5uZXh0KCkpOwogICAgICAgICAgICAgICAgaWYgKF9vaWQxLmVxdWFs\ncyhuZXh0KSkKICAgICAgICAgICAgICAgICAgICBmb3VuZE9pZDEgPSB0cnVl\nOwogICAgICAgICAgICAgICAgZWxzZSBpZiAobmV3T2lkLmVxdWFscyhuZXh0\nKSkKICAgICAgICAgICAgICAgICAgICBmb3VuZE5ldyA9IHRydWU7CiAgICAg\nICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgZmFpbCgiQmFk\nIG9iamVjdCBpbiBleHRlbnQuIik7CiAgICAgICAgICAgIH0KICAgICAgICAg\nICAgZXh0LmNsb3NlQWxsKCk7CiAgICAgICAgICAgIGFzc2VydFRydWUoZm91\nbmRPaWQxKTsKICAgICAgICAgICAgYXNzZXJ0VHJ1ZShmb3VuZE5ldyk7CiAg\nICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgcm9sbGJhY2tUeChwbSk7\nCiAgICAgICAgfQogICAgfQoKICAgIHB1YmxpYyB2b2lkIHRlc3ROb3RDb250\nYWluc05ld2x5RGVsZXRlZCgpIHsKICAgICAgICBPcGVuSlBBRW50aXR5TWFu\nYWdlciBwbSA9IGdldFBNKCk7CgogICAgICAgIC8vIHBjbDogMTQgT2N0IDIw\nMDM6IGRlZmF1bHQgaW4gMy4wIGlzIG5vdyB0cnVlLCBidXQgdGhpcyB0ZXN0\nCiAgICAgICAgLy8gYXNzdW1lcyBmYWxzZSBzb21ld2hlcmUuCiAgICAgICAg\ncG0uc2V0SWdub3JlQ2hhbmdlcyhmYWxzZSk7CiAgICAgICAgc3RhcnRUeChw\nbSk7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgUnVudGltZVRlc3QyIHRl\nc3QyID0KICAgICAgICAgICAgICAgIHBtLmZpbmQoUnVudGltZVRlc3QyLmNs\nYXNzLCBfb2lkMik7CiAgICAgICAgICAgIHBtLnJlbW92ZSh0ZXN0Mik7CiAg\nICAgICAgICAgIFJ1bnRpbWVUZXN0MSB0ZXN0MSA9IG5ldyBSdW50aW1lVGVz\ndDEoKTsKICAgICAgICAgICAgcG0ucGVyc2lzdCh0ZXN0MSk7CiAgICAgICAg\nICAgIHBtLnJlbW92ZSh0ZXN0MSk7CgogICAgICAgICAgICBFeHRlbnQgZXh0\nID0gcG0uY3JlYXRlRXh0ZW50KFJ1bnRpbWVUZXN0MS5jbGFzcywgdHJ1ZSk7\nCiAgICAgICAgICAgIGJvb2xlYW4gZm91bmRPaWQxID0gZmFsc2U7CiAgICAg\nICAgICAgIGJvb2xlYW4gZm91bmRPaWQzID0gZmFsc2U7CiAgICAgICAgICAg\nIE9iamVjdCBuZXh0OwogICAgICAgICAgICBmb3IgKEl0ZXJhdG9yIGl0ciA9\nIGV4dC5pdGVyYXRvcigpOyBpdHIuaGFzTmV4dCgpOykgewogICAgICAgICAg\nICAgICAgbmV4dCA9IHBtLmdldE9iamVjdElkKGl0ci5uZXh0KCkpOwogICAg\nICAgICAgICAgICAgaWYgKF9vaWQxLmVxdWFscyhuZXh0KSkKICAgICAgICAg\nICAgICAgICAgICBmb3VuZE9pZDEgPSB0cnVlOwogICAgICAgICAgICAgICAg\nZWxzZSBpZiAoX29pZDMuZXF1YWxzKG5leHQpKQogICAgICAgICAgICAgICAg\nICAgIGZvdW5kT2lkMyA9IHRydWU7CiAgICAgICAgICAgICAgICBlbHNlCiAg\nICAgICAgICAgICAgICAgICAgZmFpbCgiQmFkIG9iamVjdCBpbiBleHRlbnQu\nIik7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZXh0LmNsb3NlQWxsKCk7\nCiAgICAgICAgICAgIGFzc2VydFRydWUoZm91bmRPaWQxKTsKICAgICAgICAg\nICAgYXNzZXJ0VHJ1ZShmb3VuZE9pZDMpOwogICAgICAgIH0gZmluYWxseSB7\nCiAgICAgICAgICAgIHJvbGxiYWNrVHgocG0pOwogICAgICAgIH0KICAgIH0K\nfQo=\n","encoding":"base64"}

