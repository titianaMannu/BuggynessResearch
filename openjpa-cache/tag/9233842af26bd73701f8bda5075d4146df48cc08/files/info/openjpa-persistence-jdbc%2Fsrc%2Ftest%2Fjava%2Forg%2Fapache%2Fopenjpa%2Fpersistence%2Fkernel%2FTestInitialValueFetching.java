{"sha":"9f7d706c0fedb7589de08e15cc29b5233b48d09a","node_id":"MDQ6QmxvYjIwNjM2NDo5ZjdkNzA2YzBmZWRiNzU4OWRlMDhlMTVjYzI5YjUyMzNiNDhkMDlh","size":6679,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/9f7d706c0fedb7589de08e15cc29b5233b48d09a","content":"LyoKICogVGVzdEluaXRpYWxWYWx1ZUZldGNoaW5nLmphdmEKICoKICogQ3Jl\nYXRlZCBvbiBPY3RvYmVyIDEyLCAyMDA2LCAxMTo1OCBBTQogKgogKiBUbyBj\naGFuZ2UgdGhpcyB0ZW1wbGF0ZSwgY2hvb3NlIFRvb2xzIHwgVGVtcGxhdGUg\nTWFuYWdlcgogKiBhbmQgb3BlbiB0aGUgdGVtcGxhdGUgaW4gdGhlIGVkaXRv\nci4KICovCi8qCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUg\nRm91bmRhdGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmli\ndXRvciBsaWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxl\nCiAqIGRpc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFs\nIGluZm9ybWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlw\nLiAgVGhlIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVy\nIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGlj\nZW5zZSIpOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBj\nb21wbGlhbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFp\nbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogaHR0cDovL3d3dy5h\ncGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyBy\nZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3Jp\ndGluZywKICogc29mdHdhcmUgZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vu\nc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4KICogIkFTIElTIiBCQVNJUywgV0lU\nSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZCiAqIEtJTkQs\nIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuICBTZWUgdGhlIExpY2Vuc2Ug\nZm9yIHRoZQogKiBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlz\nc2lvbnMgYW5kIGxpbWl0YXRpb25zCiAqIHVuZGVyIHRoZSBMaWNlbnNlLiAg\nICAKICovCnBhY2thZ2Ugb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNl\nLmtlcm5lbDsKCmltcG9ydCBqYXZhLnV0aWwuRGF0ZTsKaW1wb3J0IGphdmEu\ndXRpbC5IYXNoTWFwOwppbXBvcnQgamF2YS51dGlsLkxpc3Q7CmltcG9ydCBq\nYXZhLnV0aWwuTWFwOwoKCgppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnBl\ncnNpc3RlbmNlLmtlcm5lbC5jb21tb24uYXBwcy5SdW50aW1lVGVzdDE7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2Uua2VybmVsLmNv\nbW1vbi5hcHBzLlJ1bnRpbWVUZXN0MjsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5wZXJzaXN0ZW5jZS5rZXJuZWwuY29tbW9uLmFwcHMuUnVudGltZVRl\nc3QzOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNlLnRl\nc3QuQWxsb3dGYWlsdXJlOwoKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5r\nZXJuZWwuT3BlbkpQQVN0YXRlTWFuYWdlcjsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS5tZXRhLkZpZWxkTWV0YURhdGE7CmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEucGVyc2lzdGVuY2UuT3BlbkpQQUVudGl0eU1hbmFnZXI7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuT3BlbkpQQUVu\ndGl0eU1hbmFnZXJGYWN0b3J5OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLnBlcnNpc3RlbmNlLk9wZW5KUEFRdWVyeTsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS5wZXJzaXN0ZW5jZS5SZXN0b3JlU3RhdGVUeXBlOwoKcHVibGlj\nIGNsYXNzIFRlc3RJbml0aWFsVmFsdWVGZXRjaGluZyBleHRlbmRzIEJhc2VL\nZXJuZWxUZXN0IHsKCiAgICAvKioKICAgICAqIENyZWF0ZXMgYSBuZXcgaW5z\ndGFuY2Ugb2YgVGVzdEluaXRpYWxWYWx1ZUZldGNoaW5nCiAgICAgKi8KICAg\nIHB1YmxpYyBUZXN0SW5pdGlhbFZhbHVlRmV0Y2hpbmcoU3RyaW5nIG5hbWUp\nIHsKICAgICAgICBzdXBlcihuYW1lKTsKICAgIH0KCiAgICBwdWJsaWMgdm9p\nZCBzZXRVcCgpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIHN1cGVyLnNl\ndFVwKFJ1bnRpbWVUZXN0MS5jbGFzcywgUnVudGltZVRlc3QyLmNsYXNzLCBS\ndW50aW1lVGVzdDMuY2xhc3MpOwogICAgICAgIE9wZW5KUEFFbnRpdHlNYW5h\nZ2VyIHBtID0gZ2V0UE0oKTsKICAgICAgICBzdGFydFR4KHBtKTsKICAgICAg\nICBSdW50aW1lVGVzdDEgcnQxID0gbmV3IFJ1bnRpbWVUZXN0MSgiVGVzdElu\naXRpYWxWYWx1ZUZldGNoaW5nIiwgMTApOwogICAgICAgIHBtLnBlcnNpc3Qo\ncnQxKTsKCiAgICAgICAgcnQxLnNldERhdGVGaWVsZChuZXcgRGF0ZSgpKTsK\nICAgICAgICBlbmRUeChwbSk7CiAgICAgICAgZW5kRW0ocG0pOwogICAgfQoK\nICAgIHB1YmxpYyB2b2lkIHRlc3RJbml0aWFsVmFsdWVTdHJpbmcoKSB7CiAg\nICAgICAgT3BlbkpQQUVudGl0eU1hbmFnZXIgcG0gPSBnZXRQTSgpOwogICAg\nICAgIHN0YXJ0VHgocG0pOwogICAgICAgIFJ1bnRpbWVUZXN0MSBydDEgPSBn\nZXRPYmplY3QocG0pOwogICAgICAgIE9wZW5KUEFTdGF0ZU1hbmFnZXIgc20g\nPSBnZXRTdGF0ZU1hbmFnZXIocnQxLCBwbSk7CiAgICAgICAgRmllbGRNZXRh\nRGF0YSBmbWQgPSBzbS5nZXRNZXRhRGF0YSgpLmdldEZpZWxkKCJzdHJpbmdG\naWVsZCIpOwogICAgICAgIGFzc2VydEVxdWFscygiVGVzdEluaXRpYWxWYWx1\nZUZldGNoaW5nIiwKICAgICAgICAgICAgc20uZmV0Y2hJbml0aWFsRmllbGQo\nZm1kLmdldEluZGV4KCkpKTsKICAgICAgICBydDEuc2V0U3RyaW5nRmllbGQo\nIlRlc3RJbml0aWFsVmFsdWVGZXRjaGluZy0yIik7CiAgICAgICAgYXNzZXJ0\nRXF1YWxzKCJUZXN0SW5pdGlhbFZhbHVlRmV0Y2hpbmciLAogICAgICAgICAg\nICBzbS5mZXRjaEluaXRpYWxGaWVsZChmbWQuZ2V0SW5kZXgoKSkpOwogICAg\nICAgIGVuZFR4KHBtKTsKICAgICAgICBhc3NlcnRFcXVhbHMoIlRlc3RJbml0\naWFsVmFsdWVGZXRjaGluZy0yIiwKICAgICAgICAgICAgc20uZmV0Y2hJbml0\naWFsRmllbGQoZm1kLmdldEluZGV4KCkpKTsKICAgICAgICBlbmRFbShwbSk7\nCiAgICB9CgogICAgcHVibGljIHZvaWQgdGVzdEluaXRpYWxWYWx1ZUludCgp\nIHsKICAgICAgICBPcGVuSlBBRW50aXR5TWFuYWdlciBwbSA9IGdldFBNKCk7\nCiAgICAgICAgc3RhcnRUeChwbSk7CiAgICAgICAgUnVudGltZVRlc3QxIHJ0\nMSA9IGdldE9iamVjdChwbSk7CiAgICAgICAgT3BlbkpQQVN0YXRlTWFuYWdl\nciBzbSA9IGdldFN0YXRlTWFuYWdlcihydDEsIHBtKTsKICAgICAgICBGaWVs\nZE1ldGFEYXRhIGZtZCA9IHNtLmdldE1ldGFEYXRhKCkuZ2V0RmllbGQoImlu\ndEZpZWxkMSIpOwogICAgICAgIGFzc2VydEVxdWFscygxMCwKICAgICAgICAg\nICAgKChJbnRlZ2VyKSBzbS5mZXRjaEluaXRpYWxGaWVsZChmbWQuZ2V0SW5k\nZXgoKSkpLmludFZhbHVlKCkpOwogICAgICAgIHJ0MS5zZXRJbnRGaWVsZDEo\nMTEpOwogICAgICAgIGFzc2VydEVxdWFscygxMCwKICAgICAgICAgICAgKChJ\nbnRlZ2VyKSBzbS5mZXRjaEluaXRpYWxGaWVsZChmbWQuZ2V0SW5kZXgoKSkp\nLmludFZhbHVlKCkpOwogICAgICAgIGVuZFR4KHBtKTsKICAgICAgICBhc3Nl\ncnRFcXVhbHMoMTEsCiAgICAgICAgICAgICgoSW50ZWdlcikgc20uZmV0Y2hJ\nbml0aWFsRmllbGQoZm1kLmdldEluZGV4KCkpKS5pbnRWYWx1ZSgpKTsKICAg\nICAgICBlbmRFbShwbSk7CiAgICB9CgogICAgQEFsbG93RmFpbHVyZQogICAg\ncHVibGljIHZvaWQgdGVzdEluaXRpYWxWYWx1ZU11dGFibGVWYWx1ZUZhaWx1\ncmVzKCkgewogICAgICAgIE1hcCBwcm9wcyA9IG5ldyBIYXNoTWFwKCk7CiAg\nICAgICAgcHJvcHMucHV0KCJvcGVuanBhLlJlc3RvcmVNdXRhYmxlVmFsdWVz\nIiwgImZhbHNlIik7CiAgICAgICAgT3BlbkpQQUVudGl0eU1hbmFnZXJGYWN0\nb3J5IHBtZiA9IGdldEVtZihwcm9wcyk7CgogICAgICAgIE9wZW5KUEFFbnRp\ndHlNYW5hZ2VyIHBtID0gcG1mLmNyZWF0ZUVudGl0eU1hbmFnZXIoKTsKICAg\nICAgICBSdW50aW1lVGVzdDEgcnQxID0gZ2V0T2JqZWN0KHBtKTsKCiAgICAg\nICAgcnQxLmdldERhdGVGaWVsZCgpOwogICAgICAgIE9wZW5KUEFTdGF0ZU1h\nbmFnZXIgc20gPSBnZXRTdGF0ZU1hbmFnZXIocnQxLCBwbSk7CiAgICAgICAg\nRmllbGRNZXRhRGF0YSBmbWQgPSBzbS5nZXRNZXRhRGF0YSgpLmdldEZpZWxk\nKCJkYXRlRmllbGQiKTsKICAgICAgICB0cnkgewogICAgICAgICAgICBzbS5m\nZXRjaEluaXRpYWxGaWVsZChmbWQuZ2V0SW5kZXgoKSk7CiAgICAgICAgICAg\nIGZhaWwoInNob3VsZCBnZXQgYW4gZXhjZXB0aW9uIGlmIFJlc3RvcmVNdXRh\nYmxlVmFsdWVzIGlzIGZhbHNlIik7CiAgICAgICAgfSBjYXRjaCAob3JnLmFw\nYWNoZS5vcGVuanBhLnV0aWwuVXNlckV4Y2VwdGlvbiBlKSB7CiAgICAgICAg\nICAgIC8vIGV4cGVjdGVkCiAgICAgICAgfQogICAgICAgIGVuZEVtKHBtKTsK\nICAgICAgICBwbWYuY2xvc2UoKTsKICAgIH0KCiAgICBAQWxsb3dGYWlsdXJl\nCiAgICBwdWJsaWMgdm9pZCB0ZXN0SW5pdGlhbFZhbHVlRGF0ZSgpIHsKICAg\nICAgICBNYXAgcHJvcHMgPSBuZXcgSGFzaE1hcCgpOwogICAgICAgIHByb3Bz\nLnB1dCgib3BlbmpwYS5SZXN0b3JlU3RhdGUiLCAiYWxsIik7CiAgICAgICAg\nT3BlbkpQQUVudGl0eU1hbmFnZXJGYWN0b3J5IHBtZiA9IGdldEVtZihwcm9w\ncyk7CiAgICAgICAgT3BlbkpQQUVudGl0eU1hbmFnZXIgcG0gPSBwbWYuY3Jl\nYXRlRW50aXR5TWFuYWdlcigpOwogICAgICAgIHN0YXJ0VHgocG0pOwogICAg\nICAgIFJ1bnRpbWVUZXN0MSBydDEgPSBnZXRPYmplY3QocG0pOwoKICAgICAg\nICBEYXRlIGQgPSBydDEuZ2V0RGF0ZUZpZWxkKCk7CgogICAgICAgIE9wZW5K\nUEFTdGF0ZU1hbmFnZXIgc20gPSBnZXRTdGF0ZU1hbmFnZXIocnQxLCBwbSk7\nCiAgICAgICAgRmllbGRNZXRhRGF0YSBmbWQgPSBzbS5nZXRNZXRhRGF0YSgp\nLmdldEZpZWxkKCJkYXRlRmllbGQiKTsKICAgICAgICBhc3NlcnRFcXVhbHMo\nZCwgc20uZmV0Y2hJbml0aWFsRmllbGQoZm1kLmdldEluZGV4KCkpKTsKCiAg\nICAgICAgLy8gPT0gc2hvdWxkIHBhc3MgaGVyZSBzaW5jZSB3ZSBoYXZlbid0\nIG1hZGUgYW55IG1vZGlmaWNhdGlvbnMuCiAgICAgICAgYXNzZXJ0VHJ1ZSgi\nbXV0YWJsZSBvYmplY3QgZmFpbHMgPT0gdGVzdDsgc2hvdWxkIG5vdCIsCiAg\nICAgICAgICAgIGQgPT0gc20uZmV0Y2hJbml0aWFsRmllbGQoZm1kLmdldElu\nZGV4KCkpKTsKCiAgICAgICAgRGF0ZSBkMiA9IG5ldyBEYXRlKCk7CiAgICAg\nICAgcnQxLnNldERhdGVGaWVsZChkMik7CiAgICAgICAgYXNzZXJ0RXF1YWxz\nKGQsIHNtLmZldGNoSW5pdGlhbEZpZWxkKGZtZC5nZXRJbmRleCgpKSk7CiAg\nICAgICAgZW5kVHgocG0pOwogICAgICAgIGFzc2VydEVxdWFscyhkMiwgc20u\nZmV0Y2hJbml0aWFsRmllbGQoZm1kLmdldEluZGV4KCkpKTsKICAgICAgICBh\nc3NlcnRUcnVlKCJtdXRhYmxlIG9iamVjdCBwYXNzZXMgPT0gdGVzdDsgc2hv\ndWxkIG5vdCIsCiAgICAgICAgICAgIGQyICE9IHNtLmZldGNoSW5pdGlhbEZp\nZWxkKGZtZC5nZXRJbmRleCgpKSk7CiAgICAgICAgZW5kRW0ocG0pOwogICAg\nfQoKICAgIHB1YmxpYyB2b2lkIHRlc3RJbml0aWFsVmFsdWVFeGNlcHRpb25z\nKCkgewogICAgICAgIE9wZW5KUEFFbnRpdHlNYW5hZ2VyIHBtID0gZ2V0UE0o\nKTsKICAgICAgICBwbS5zZXRSZXN0b3JlU3RhdGUoUmVzdG9yZVN0YXRlVHlw\nZS5OT05FKTsKICAgICAgICBzdGFydFR4KHBtKTsKICAgICAgICBSdW50aW1l\nVGVzdDEgcnQxID0gZ2V0T2JqZWN0KHBtKTsKICAgICAgICBPcGVuSlBBU3Rh\ndGVNYW5hZ2VyIHNtID0gZ2V0U3RhdGVNYW5hZ2VyKHJ0MSwgcG0pOwogICAg\nICAgIEZpZWxkTWV0YURhdGEgZm1kID0gc20uZ2V0TWV0YURhdGEoKS5nZXRG\naWVsZCgic3RyaW5nRmllbGQiKTsKICAgICAgICB0cnkgewogICAgICAgICAg\nICBzbS5mZXRjaEluaXRpYWxGaWVsZChmbWQuZ2V0SW5kZXgoKSk7CiAgICAg\nICAgICAgIGZhaWwoImV4Y2VwdGlvbiBzaG91bGQgYmUgdGhyb3duIGJ5IEtv\nZG9TTS5mZXRjaEluaXRpYWxGaWVsZCIpOwogICAgICAgIH0gY2F0Y2ggKG9y\nZy5hcGFjaGUub3BlbmpwYS51dGlsLlVzZXJFeGNlcHRpb24gZSkgewogICAg\nICAgICAgICAvLyBleHBlY3RlZCBjYXNlCiAgICAgICAgfQogICAgICAgIGVu\nZFR4KHBtKTsKICAgICAgICBlbmRFbShwbSk7CiAgICB9CgogICAgcHJpdmF0\nZSBSdW50aW1lVGVzdDEgZ2V0T2JqZWN0KE9wZW5KUEFFbnRpdHlNYW5hZ2Vy\nIHBtKSB7Ci8vICAgICAgICByZXR1cm4gKFJ1bnRpbWVUZXN0MSkgKChDb2xs\nZWN0aW9uKSAKLy8gICAgICAgIAkJcG0uY3JlYXRlTmF0aXZlUXVlcnkoICJz\ndHJpbmdGaWVsZCA9PSAiCi8vICAgICAgICAgICAgICArIlwiVGVzdEluaXRp\nYWxWYWx1ZUZldGNoaW5nXCIiLFJ1bnRpbWVUZXN0MS5jbGFzcykKLy8gICAg\nICAgICAgICAgIC5nZXRSZXN1bHRMaXN0KCkpLml0ZXJhdG9yKCkubmV4dCgp\nOwoKICAgICAgICBPcGVuSlBBUXVlcnkgcSA9IHBtLmNyZWF0ZVF1ZXJ5KCJT\nRUxFQ1QgbyBGUk9NIFJ1bnRpbWVUZXN0MSBvICIKICAgICAgICAgICAgICAg\nICsgIldIRVJFIG8uc3RyaW5nRmllbGQgPSBcJ1Rlc3RJbml0aWFsVmFsdWVG\nZXRjaGluZ1wnIik7CiAgICAgICAgTGlzdCBsID0gcS5nZXRSZXN1bHRMaXN0\nKCk7CgogICAgICAgIHJldHVybiAoUnVudGltZVRlc3QxKSBsLml0ZXJhdG9y\nKCkubmV4dCgpOwogICAgfQp9Cg==\n","encoding":"base64"}

