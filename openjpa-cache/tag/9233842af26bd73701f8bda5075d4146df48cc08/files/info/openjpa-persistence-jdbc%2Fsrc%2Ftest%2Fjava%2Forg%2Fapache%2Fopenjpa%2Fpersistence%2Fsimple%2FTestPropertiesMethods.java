{"sha":"21f12bf7b5bba739ec59ada658323d3cff84e308","node_id":"MDQ6QmxvYjIwNjM2NDoyMWYxMmJmN2I1YmJhNzM5ZWM1OWFkYTY1ODMyM2QzY2ZmODRlMzA4","size":11815,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/21f12bf7b5bba739ec59ada658323d3cff84e308","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2Uuc2ltcGxl\nOwoKaW1wb3J0IGphdmEudXRpbC5BcnJheXM7CmltcG9ydCBqYXZhLnV0aWwu\nSGFzaE1hcDsKaW1wb3J0IGphdmEudXRpbC5NYXA7CmltcG9ydCBqYXZhLnV0\naWwuU2V0OwoKaW1wb3J0IGphdmF4LnBlcnNpc3RlbmNlLkVudGl0eU1hbmFn\nZXI7CmltcG9ydCBqYXZheC5wZXJzaXN0ZW5jZS5FbnRpdHlNYW5hZ2VyRmFj\ndG9yeTsKaW1wb3J0IGphdmF4LnBlcnNpc3RlbmNlLlBlcnNpc3RlbmNlOwoK\naW1wb3J0IGp1bml0LmZyYW1ld29yay5UZXN0Q2FzZTsKCmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEubGliLmNvbmYuUHJvZHVjdERlcml2YXRpb25zOwpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi5jb25mLlZhbHVlOwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNlLkF1dG9DbGVhclR5\ncGU7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuT3Bl\nbkpQQUVudGl0eU1hbmFnZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\ncGVyc2lzdGVuY2UuT3BlbkpQQVBlcnNpc3RlbmNlOwoKLyoqCiAqIFRoaXMg\ndGVzdCBjYXNlIHRlc3RzIHRoZSBnZXRQcm9wZXJ0aWVzKCkgYW5kIGdldFN1\ncHBvcnRlZFByb3BlcnRpZXMoKSBtZXRob2RzCiAqIGZvciB0aGUgRW50aXR5\nTWFuYWdlciBhbmQgRW50aXR5TWFuYWdlckZhY3RvcnkuCiAqIAogKiBAYXV0\naG9yIERpYW5uZSBSaWNoYXJkcwogKiBAYXV0aG9yIFBpbmFraSBQb2RkYXIK\nICogCiAqLwpwdWJsaWMgY2xhc3MgVGVzdFByb3BlcnRpZXNNZXRob2RzIGV4\ndGVuZHMgVGVzdENhc2UgewogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgU3Ry\naW5nIFVOSVRfTkFNRSA9ICJ0ZXN0IjsKICAgIHByaXZhdGUgc3RhdGljIEVu\ndGl0eU1hbmFnZXJGYWN0b3J5IGVtZjsKICAgIHByaXZhdGUgT3BlbkpQQUVu\ndGl0eU1hbmFnZXIgZW07CiAgICAKICAgIEBTdXBwcmVzc1dhcm5pbmdzKCJ1\nbmNoZWNrZWQiKQogICAgcHVibGljIHZvaWQgc2V0VXAoKSB0aHJvd3MgRXhj\nZXB0aW9uIHsKICAgICAgICBpZiAoZW1mID09IG51bGwpIHsKICAgICAgICAg\nICAgTWFwIGNvbmZpZyA9IG5ldyBIYXNoTWFwKCk7CiAgICAgICAgICAgIGNv\nbmZpZy5wdXRBbGwoU3lzdGVtLmdldFByb3BlcnRpZXMoKSk7CiAgICAgICAg\nICAgIAovKiBudW1lcmljICAgKi8gY29uZmlnLnB1dCgib3BlbmpwYS5EYXRh\nQ2FjaGVUaW1lb3V0IiwgMzAwKTsKLyogbnVtIGVudW0gICovIGNvbmZpZy5w\ndXQoIm9wZW5qcGEuQXV0b0NsZWFyIiwgMCk7Ci8qIGhpZGRlbiAgICAqLyBj\nb25maWcucHV0KCJvcGVuanBhLkNvbm5lY3Rpb24yUGFzc3dvcmQiLCAieHl6\nIik7Ci8qIHBsdWctaW4gICAqLyBjb25maWcucHV0KCJvcGVuanBhLlByb3h5\nTWFuYWdlciIsICJkZWZhdWx0KFRyYWNrQ2hhbmdlcz1mYWxzZSkiKTsKLyog\nbm8gZnVua3kgICovIGNvbmZpZy5wdXQoIm9wZW5qcGEuRHluYW1pY0VuaGFu\nY2VtZW50QWdlbnQiLCAiZmFsc2UiKTsKCi8vIGZvbGxvd2luZyBwcm9wZXJ0\naWVzIGFyZSBub3QgdXNlZCBiZWN1YXNlIHRoYXQgbWFrZXMgdGhlIHRlc3Qg\nZGVwZW5kZW50IG9uIGRhdGFiYXNlIHNwZWNpZmljcwovKiBlcXVpdiBrZXkg\nKi8gLy9jb25maWcucHV0KCJqYXZheC5wZXJzaXN0ZW5jZS5qZGJjLnVybCIs\nICJqZGJjOmRlcmJ5OnRhcmdldC9kYXRhYmFzZS90ZXN0O2NyZWF0ZT10cnVl\nIik7IAovKiBwcmltZSB1c2UgKi8gLy9jb25maWcucHV0KCJvcGVuanBhLkNv\nbm5lY3Rpb25Vc2VyTmFtZSIsICJyb290Iik7CiAgICAgICAgICAgIAogICAg\nICAgICAgICBlbWYgPSBQZXJzaXN0ZW5jZS5jcmVhdGVFbnRpdHlNYW5hZ2Vy\nRmFjdG9yeShVTklUX05BTUUsIGNvbmZpZyk7CiAgICAgICAgICAgIGFzc2Vy\ndE5vdE51bGwoZW1mKTsKICAgICAgICB9CiAgICAgICAgZW0gPSBPcGVuSlBB\nUGVyc2lzdGVuY2UuY2FzdChlbWYuY3JlYXRlRW50aXR5TWFuYWdlcigpKTsK\nICAgIH0KICAgIAovLyAgICBwdWJsaWMgdm9pZCB0ZXN0UHJvcGVydGllcygp\nIHsKLy8gICAgICAgIHByaW50KCJFTUYgUHJvcGVydGllcyIsIGVtZi5nZXRQ\ncm9wZXJ0aWVzKCkpOwovLyAgICAgICAgcHJpbnQoIkVNRiBTdXBwb3J0ZWQg\nUHJvcGVydGllcyIsIGVtZi5nZXRTdXBwb3J0ZWRQcm9wZXJ0aWVzKCkpOwov\nLyAgICAgICAgcHJpbnQoIkVNIFByb3BlcnRpZXMiLCBlbS5nZXRQcm9wZXJ0\naWVzKCkpOwovLyAgICAgICAgcHJpbnQoIkVNIFN1cHBvcnRlZCBQcm9wZXJ0\naWVzIiwgZW1mLmdldFN1cHBvcnRlZFByb3BlcnRpZXMoKSk7Ci8vICAgIH0K\nICAgIAogICAgcHVibGljIHZvaWQgdGVzdENvbmZpZ3VyYXRpb25QcmVmaXhl\ncygpIHsKICAgICAgICBTdHJpbmdbXSBwcmVmaXhlcyA9IFByb2R1Y3REZXJp\ndmF0aW9ucy5nZXRDb25maWd1cmF0aW9uUHJlZml4ZXMoKTsKICAgICAgICBh\nc3NlcnRFcXVhbHMoIm9wZW5qcGEiLCBwcmVmaXhlc1swXSk7CiAgICAgICAg\nYXNzZXJ0VHJ1ZShBcnJheXMuYXNMaXN0KHByZWZpeGVzKS5jb250YWlucygi\namF2YXgucGVyc2lzdGVuY2UiKSk7CiAgICB9CiAgICAKICAgIHB1YmxpYyB2\nb2lkIHRlc3RFTU51bWVyaWNQcm9wZXJ0eVZhbHVlRm9yRW51bVR5cGVJc1Jl\ndHVybmVkQXNTdHJpbmcoKSB7CiAgICAgICAgTWFwPFN0cmluZywgT2JqZWN0\nPiBwcm9wcyA9IGVtLmdldFByb3BlcnRpZXMoKTsKCiAgICAgICAgYXNzZXJ0\nUHJvcGVydHkoIm9wZW5qcGEuQXV0b0NsZWFyIiwgcHJvcHMsIEF1dG9DbGVh\nclR5cGUuREFUQVNUT1JFKTsKICAgICAgICBhc3NlcnRQcm9wZXJ0eSgib3Bl\nbmpwYS5JZ25vcmVDaGFuZ2VzIiwgcHJvcHMsIEJvb2xlYW4uRkFMU0UpOwog\nICAgfQoKICAgIHB1YmxpYyB2b2lkIHRlc3RFTVBsdWdpblByb3BlcnR5UGFy\nYW1ldGVySXNQcmVzZXJ2ZWQoKSB7CiAgICAgICAgTWFwPFN0cmluZyxPYmpl\nY3Q+IHByb3BzID0gZW1mLmdldFByb3BlcnRpZXMoKTsKICAgICAgICBPYmpl\nY3QgdmFsID0gcHJvcHMuZ2V0KCJvcGVuanBhLlByb3h5TWFuYWdlciIpOwog\nICAgICAgIGFzc2VydE5vdE51bGwodmFsKTsKICAgICAgICBhc3NlcnRUcnVl\nKHZhbCBpbnN0YW5jZW9mIFN0cmluZyk7CiAgICAgICAgU3RyaW5nIHByb3h5\nTWFuYWdlciA9IChTdHJpbmcpdmFsOwogICAgICAgIGFzc2VydEVxdWFscygi\nZGVmYXVsdChUcmFja0NoYW5nZXM9ZmFsc2UpIiwgcHJveHlNYW5hZ2VyKTsK\nICAgIH0KICAgIAogICAgLyoqCiAgICAgKiBUZXN0IHRoZSBFbnRpdHlNYW5h\nZ2VyRmFjdG9yeSBnZXRQcm9wZXJ0aWVzKCkgbWV0aG9kLgogICAgICovCiAg\nICBwdWJsaWMgdm9pZCB0ZXN0RmFjdG9yeVByb3BlcnRpZXNDb250YWluRGVm\nYXVsdFZhbHVlKCkgewogICAgICAgIE1hcDxTdHJpbmcsIE9iamVjdD4gcHJv\ncHMgPSBlbWYuZ2V0UHJvcGVydGllcygpOwoKICAgICAgICBhc3NlcnRFcXVh\nbHMoImRlZmF1bHQiLCBwcm9wcy5nZXQoIm9wZW5qcGEuRGF0YUNhY2hlTWFu\nYWdlciIpKTsKICAgICAgICBhc3NlcnRFcXVhbHMoMzAwLCBwcm9wcy5nZXQo\nIm9wZW5qcGEuRGF0YUNhY2hlVGltZW91dCIpKTsKICAgIH0KICAgIAogICAg\ncHVibGljIHZvaWQgdGVzdEZhY3RvcnlQcm9wZXJ0aWVzQ29udGFpblVzZXJT\ncGVjaWZpZWRWYWx1ZSgpIHsKICAgICAgICBNYXA8U3RyaW5nLCBPYmplY3Q+\nIHByb3BzID0gZW1mLmdldFByb3BlcnRpZXMoKTsKICAgICAgICBhc3NlcnRF\ncXVhbHMobmV3IEludGVnZXIoMzAwKSwgcHJvcHMuZ2V0KCJvcGVuanBhLkRh\ndGFDYWNoZVRpbWVvdXQiKSk7CiAgICB9CgogICAgcHVibGljIHZvaWQgdGVz\ndEZhY3RvcnlQcm9wZXJ0aWVzQWRkUGxhdGZvcm1PclZlbmRvcigpIHsKICAg\nICAgICBNYXA8U3RyaW5nLCBPYmplY3Q+IHByb3BzID0gZW1mLmdldFByb3Bl\ncnRpZXMoKTsKICAgICAgICBhc3NlcnRUcnVlKHByb3BzLmNvbnRhaW5zS2V5\nKCJQbGF0Zm9ybSIpKTsKICAgICAgICBhc3NlcnROb3ROdWxsKHByb3BzLmNv\nbnRhaW5zS2V5KCJWZW5kb3JOYW1lIikpOwogICAgfQoKICAgIC8qKgogICAg\nICogVGVzdCB0aGUgRW50aXR5TWFuYWdlckZhY3RvcnkgZ2V0U3VwcG9ydGVk\nUHJvcGVydGllcygpIG1ldGhvZC4KICAgICAqLwogICAgcHVibGljIHZvaWQg\ndGVzdEZhY3RvcnlTdXBwb3J0ZWRQcm9wZXJ0aWVzKCkgewogICAgICAgIFNl\ndDxTdHJpbmc+IHByb3BzID0gZW1mLmdldFN1cHBvcnRlZFByb3BlcnRpZXMo\nKTsKICAgICAgICBhc3NlcnRUcnVlKHByb3BzLmNvbnRhaW5zKCJvcGVuanBh\nLklnbm9yZUNoYW5nZXMiKSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBUZXN0\nIHRoZSBFbnRpdHlNYW5hZ2VyIGdldFN1cHBvcnRlZFByb3BlcnRpZXMoKSBt\nZXRob2QuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHRlc3RFTUdldFN1cHBv\ncnRlZFByb3BlcnRpZXMoKSB7CiAgICAgICAgU2V0PFN0cmluZz4gZW1TdXBw\nb3J0ZWRQcm9wZXJ0aWVzID0gZW0uZ2V0U3VwcG9ydGVkUHJvcGVydGllcygp\nOwogICAgICAgIGFzc2VydE5vdE51bGwoZW1TdXBwb3J0ZWRQcm9wZXJ0aWVz\nKTsKICAgICAgICBhc3NlcnRUcnVlKGVtU3VwcG9ydGVkUHJvcGVydGllcy5j\nb250YWlucygib3BlbmpwYS5BdXRvRGV0YWNoIikpOwogICAgICAgIAogICAg\nICAgIC8vIE1ha2Ugc3VyZSB0aGUgYWxsIHBvc3NpYmxlIGtleXMgYXJlIHJl\ndHVybmVkCiAgICAgICAgYXNzZXJ0VHJ1ZShlbVN1cHBvcnRlZFByb3BlcnRp\nZXMuY29udGFpbnMoImphdmF4LnBlcnNpc3RlbmNlLmxvY2sudGltZW91dCIp\nKTsKICAgICAgICBhc3NlcnRUcnVlKGVtU3VwcG9ydGVkUHJvcGVydGllcy5j\nb250YWlucygib3BlbmpwYS5Mb2NrVGltZW91dCIpKTsKICAgICAgICAKICAg\nICAgICAvLyBNYWtlIHN1cmUgdGhlIHNwZWMgcHJvcGVydHkgZm9yIHF1ZXJ5\nIHRpbWVvdXQsIHRoYXQgb25seSBoYXMgb25lCiAgICAgICAgLy8ga2V5LCBp\ncyByZXR1cm5lZC4KICAgICAgICBhc3NlcnRUcnVlKGVtU3VwcG9ydGVkUHJv\ncGVydGllcy5jb250YWlucygiamF2YXgucGVyc2lzdGVuY2UucXVlcnkudGlt\nZW91dCIpKTsKICAgICAgICBhc3NlcnRGYWxzZShlbVN1cHBvcnRlZFByb3Bl\ncnRpZXMuY29udGFpbnMoIm9wZW5qcGEuamF2YXgucGVyc2lzdGVuY2UucXVl\ncnkudGltZW91dCIpKTsKICAgIH0KICAgIAogICAgLyoqCiAgICAgKiBQcm9w\nZXJ0eSB2YWx1ZXMgcHJlc2VydmUgdGhlIHR5cGUgaW4gd2hpY2ggdGhleSB3\nZXJlIHNwZWNpZmllZCBpbiB0aGUgZmFjYWRlLgogICAgICogRW51bWVyYXRl\nZCBwcm9wZXJ0eSBzdWNoIGFzIEF1dG9DbGVhciBoYXMgZGlmZmVyZW50IHJl\ncHJlc2VudGF0aW9uIGluIGtlcm5lbAogICAgICogKGFzIGludCkgYW5kIGlu\nIGZhY2FkZSAoYXMgZW51bSkuIFRoZSB0ZXN0IHZlcmlmaWVzIHRoYXQge0Bs\naW5rIEVudGl0eU1hbmFnZXIjZ2V0UHJvcGVydGllcygpfSAKICAgICAqIHJl\ndHVybiBlbnVtIHR5cGUgcmF0aGVyIHRoYW4gYW4gaW50ZWdlci4KICAgICAq\nLwogICAgcHVibGljIHZvaWQgdGVzdEVNRlByb3BlcnR5VmFsdWVUeXBlSXNQ\ncmVzZXJ2ZWQoKSB7CiAgICAgICAgTWFwPFN0cmluZywgT2JqZWN0PiBwcm9w\ncyA9IGVtZi5nZXRQcm9wZXJ0aWVzKCk7CiAgICAgICAgCiAgICAgICAgT2Jq\nZWN0IGF1dG9DbGVhciA9IHByb3BzLmdldCgib3BlbmpwYS5BdXRvQ2xlYXIi\nKTsKICAgICAgICBwcmludCgiRU1GIFByb3BlcnRpZXMgIiwgcHJvcHMpOwog\nICAgICAgIGFzc2VydFRydWUoIkF1dG9DbGVhciAiICsgYXV0b0NsZWFyICsg\nIiBpcyBvZiAiICsgYXV0b0NsZWFyLmdldENsYXNzKCksIGF1dG9DbGVhciBp\nbnN0YW5jZW9mIEF1dG9DbGVhclR5cGUpOwogICAgICAgIGFzc2VydEVxdWFs\ncyhBdXRvQ2xlYXJUeXBlLkRBVEFTVE9SRSwgYXV0b0NsZWFyKTsKICAgICAg\nICAKICAgICAgICBPYmplY3QgaWdub3JlQ2hhbmdlcyA9IHByb3BzLmdldCgi\nb3BlbmpwYS5JZ25vcmVDaGFuZ2VzIik7CiAgICAgICAgYXNzZXJ0VHJ1ZShp\nZ25vcmVDaGFuZ2VzIGluc3RhbmNlb2YgQm9vbGVhbik7CiAgICB9CgogICAg\ncHVibGljIHZvaWQgdGVzdEVNRlBsdWdpblByb3BlcnR5UGFyYW1ldGVySXNQ\ncmVzZXJ2ZWQoKSB7CiAgICAgICAgTWFwPFN0cmluZyxPYmplY3Q+IHByb3Bz\nID0gZW1mLmdldFByb3BlcnRpZXMoKTsKICAgICAgICBPYmplY3QgdmFsID0g\ncHJvcHMuZ2V0KCJvcGVuanBhLlByb3h5TWFuYWdlciIpOwogICAgICAgIGFz\nc2VydE5vdE51bGwodmFsKTsKICAgICAgICBhc3NlcnRUcnVlKHZhbCBpbnN0\nYW5jZW9mIFN0cmluZyk7CiAgICAgICAgU3RyaW5nIHByb3h5TWFuYWdlciA9\nIChTdHJpbmcpdmFsOwogICAgICAgIGFzc2VydEVxdWFscygiZGVmYXVsdChU\ncmFja0NoYW5nZXM9ZmFsc2UpIiwgcHJveHlNYW5hZ2VyKTsKICAgIH0KICAg\nIAogICAgLyoqCiAgICAgKiBDZXJ0YWluIGxvZ2ljYWwgcHJvcGVydHkgc3Vj\naCBhcyBDb25uZWN0aW9uVXNlck5hbWUgY2FuIGFwcGVhciB1bmRlciBkaWZm\nZXJlbnQKICAgICAqIGtleXMgc3VjaCBhcyBvcGVuanBhLkNvbm5lY3Rpb25V\nc2VyTmFtZSBvciBqYXZheC5wZXJzaXN0ZW5jZS5qZGJjLnVzZXIuCiAgICAg\nKiBUaGUga2V5IHVuZGVyIHdoaWNoIHRoZSBwcm9wZXJ0eSB2YWx1ZSBhcHBl\nYXJzIGRlcGVuZHMgb24gdGhlIGtleSB1bmRlciB3aGljaAogICAgICogcHJv\ncGVydHkgdmFsdWUgd2FzIGxvYWRlZCBpbnRvIHRoZSBjb25maWd1cmF0aW9u\nLiAgCiAgICAgKiAKICAgICAqLwogICAgLy8gTm90IHJ1biBiZWNhdXNlIHRo\nYXQgbWFrZXMgdGhlc2UgdGVzdHMgZGF0YWJhc2Ugc3BlY2lmaWMKICAgIHB1\nYmxpYyB2b2lkIHh0ZXN0TG9hZEtleVdpdGhFcXVpdmFsZW50UHJvcGVydHlL\nZXkoKSB7CiAgICAgICAgTWFwPFN0cmluZywgT2JqZWN0PiBwcm9wcyA9IGVt\nZi5nZXRQcm9wZXJ0aWVzKCk7CgogICAgICAgIC8vIFRoaXMgcHJvcGVydHkg\nd2FzIGxvYWRlZCB3aXRoIGVxdWl2YWxlbnQgamF2YXguIGtleQogICAgICAg\nIGFzc2VydEZhbHNlKHByb3BzLmNvbnRhaW5zS2V5KCJvcGVuanBhLkNvbm5l\nY3Rpb25VUkwiKSk7CiAgICAgICAgYXNzZXJ0VHJ1ZShwcm9wcy5jb250YWlu\nc0tleSgiamF2YXgucGVyc2lzdGVuY2UuamRiYy51cmwiKSk7CiAgICB9CiAg\nICAKICAgIC8vIE5vdCBydW4gYmVjYXVzZSB0aGF0IG1ha2VzIHRoZXNlIHRl\nc3RzIGRhdGFiYXNlIHNwZWNpZmljCiAgICBwdWJsaWMgdm9pZCB4dGVzdExv\nYWRLZXlXaXRoUHJpbWFyeVByb3BlcnR5S2V5KCkgewogICAgICAgIE1hcDxT\ndHJpbmcsIE9iamVjdD4gcHJvcHMgPSBlbWYuZ2V0UHJvcGVydGllcygpOwoK\nICAgICAgICAvLyBUaGlzIHByb3BlcnR5IHdhcyBsb2FkZWQgd2l0aCBwcmlt\nYXJ5IG9wZW5qcGEuIGtleQogICAgICAgIGFzc2VydFRydWUocHJvcHMuY29u\ndGFpbnNLZXkoIm9wZW5qcGEuQ29ubmVjdGlvblVzZXJOYW1lIikpOwogICAg\nICAgIGFzc2VydEZhbHNlKHByb3BzLmNvbnRhaW5zS2V5KCJqYXZheC5wZXJz\naXN0ZW5jZS5qZGJjLnVzZXIiKSk7CiAgICB9CiAgICAKICAgIC8qKgogICAg\nICogUHJvcGVydHkgdmFsdWVzIHByZXNlcnZlIHRoZSB0eXBlIGluIHdoaWNo\nIHRoZXkgd2VyZSBzcGVjaWZpZWQgaW4gdGhlIGZhY2FkZS4KICAgICAqIEVu\ndW1lcmF0ZWQgcHJvcGVydHkgc3VjaCBhcyBBdXRvQ2xlYXIgaGFzIGRpZmZl\ncmVudCByZXByZXNlbnRhdGlvbiBpbiBrZXJuZWwKICAgICAqIChhcyBpbnQp\nIGFuZCBpbiBmYWNhZGUgKGFzIGVudW0pLiBUaGUgdGVzdCB2ZXJpZmllcyB0\naGF0IHtAbGluayBFbnRpdHlNYW5hZ2VyI2dldFByb3BlcnRpZXMoKX0gCiAg\nICAgKiByZXR1cm4gZW51bSB0eXBlIHJhdGhlciB0aGFuIGFuIGludGVnZXIu\nCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHRlc3RQcm9wZXJ0eVZhbHVlVHlw\nZUlzUHJlc2VydmVkKCkgewogICAgICAgIE1hcDxTdHJpbmcsIE9iamVjdD4g\ncHJvcHMgPSBlbS5nZXRQcm9wZXJ0aWVzKCk7CiAgICAgICAgYXNzZXJ0UHJv\ncGVydHkoIm9wZW5qcGEuQXV0b0NsZWFyIiwgcHJvcHMsIEF1dG9DbGVhclR5\ncGUuREFUQVNUT1JFKTsKICAgICAgICBhc3NlcnRQcm9wZXJ0eSgib3Blbmpw\nYS5JZ25vcmVDaGFuZ2VzIiwgcHJvcHMsIEJvb2xlYW4uRkFMU0UpOwogICAg\nfQoKICAgIHB1YmxpYyB2b2lkIHRlc3RQbHVnaW5Qcm9wZXJ0eVBhcmFtZXRl\ncklzUHJlc2VydmVkKCkgewogICAgICAgIE1hcDxTdHJpbmcsT2JqZWN0PiBw\ncm9wcyA9IGVtZi5nZXRQcm9wZXJ0aWVzKCk7CiAgICAgICAgYXNzZXJ0UHJv\ncGVydHkoIm9wZW5qcGEuUHJveHlNYW5hZ2VyIiwgcHJvcHMsICJkZWZhdWx0\nKFRyYWNrQ2hhbmdlcz1mYWxzZSkiKTsKICAgIH0KICAgIAogICAgLyoqCiAg\nICAgKiBUZXN0IHRoYXQgcHJvcGVydHkgdmFsdWUgY2hhbmdlcyBhcmUgcmVm\nbGVjdGVkIHdoZW4gbXV0YXRlZCBkaXJlY3RseS4KICAgICAqLwogICAgcHVi\nbGljIHZvaWQgdGVzdENoYW5nZVByb3BlcnR5VmFsdWUoKSB7CiAgICAgICAg\nTWFwPFN0cmluZywgT2JqZWN0PiBwcm9wcyA9IGVtLmdldFByb3BlcnRpZXMo\nKTsKICAgICAgICBCb29sZWFuIG9yaWdpbmFsID0gKEJvb2xlYW4pcHJvcHMu\nZ2V0KCJvcGVuanBhLklnbm9yZUNoYW5nZXMiKTsKICAgICAgICBhc3NlcnRO\nb3ROdWxsKG9yaWdpbmFsKTsKICAgICAgICAKICAgICAgICBCb29sZWFuIGlu\ndmVydCA9ICFvcmlnaW5hbC5ib29sZWFuVmFsdWUoKTsKICAgICAgICBlbS5z\nZXRJZ25vcmVDaGFuZ2VzKGludmVydCk7CiAgICAgICAgCiAgICAgICAgYXNz\nZXJ0UHJvcGVydHkoIm9wZW5qcGEuSWdub3JlQ2hhbmdlcyIsIGVtLmdldFBy\nb3BlcnRpZXMoKSwgaW52ZXJ0KTsKICAgIH0KICAgIAogICAgLyoqCiAgICAg\nKiBUZXN0IHRoYXQgcHJvcGVydHkgdmFsdWUgY2hhbmdlcyBhcmUgcmVmbGVj\ndGVkIHdoZW4gaW5zdGFudGlhdGVkIHdpdGggY29uZmlndXJhdGlvbi4KICAg\nICAqLwogICAgcHVibGljIHZvaWQgdGVzdENvbmZpZ3VyZWRQcm9wZXJ0eVZh\nbHVlKCkgewogICAgICAgIE1hcDxTdHJpbmcsIE9iamVjdD4gcHJvcHMgPSBl\nbS5nZXRQcm9wZXJ0aWVzKCk7CiAgICAgICAgQm9vbGVhbiBvcmlnaW5hbCA9\nIChCb29sZWFuKXByb3BzLmdldCgib3BlbmpwYS5JZ25vcmVDaGFuZ2VzIik7\nCiAgICAgICAgYXNzZXJ0Tm90TnVsbChvcmlnaW5hbCk7CiAgICAgICAgCiAg\nICAgICAgTWFwPFN0cmluZyxCb29sZWFuPiBjb25maWcgPSBuZXcgSGFzaE1h\ncDxTdHJpbmcsIEJvb2xlYW4+KCk7CiAgICAgICAgQm9vbGVhbiBpbnZlcnQg\nPSAhb3JpZ2luYWwuYm9vbGVhblZhbHVlKCk7CiAgICAgICAgY29uZmlnLnB1\ndCgib3BlbmpwYS5JZ25vcmVDaGFuZ2VzIiwgaW52ZXJ0KTsKICAgICAgICAK\nICAgICAgICBFbnRpdHlNYW5hZ2VyIGVtMiA9IGVtZi5jcmVhdGVFbnRpdHlN\nYW5hZ2VyKGNvbmZpZyk7CiAgICAgICAgYXNzZXJ0UHJvcGVydHkoIm9wZW5q\ncGEuSWdub3JlQ2hhbmdlcyIsIGVtMi5nZXRQcm9wZXJ0aWVzKCksIGludmVy\ndCk7CiAgICB9CgogICAgCiAgICBwdWJsaWMgdm9pZCB0ZXN0RXF1aXZhbGVu\ndEtleXNBcmVQcmVzZW50SW5TdXBwb3J0ZWRQcm9wZXJ0aWVzKCkgewogICAg\nICAgIFNldDxTdHJpbmc+IGtleXMgPSBlbS5nZXRTdXBwb3J0ZWRQcm9wZXJ0\naWVzKCk7CiAgICAgICAgYXNzZXJ0VHJ1ZShrZXlzLmNvbnRhaW5zKCJvcGVu\nanBhLkNvbm5lY3Rpb25VUkwiKSk7CiAgICAgICAgYXNzZXJ0VHJ1ZShrZXlz\nLmNvbnRhaW5zKCJqYXZheC5wZXJzaXN0ZW5jZS5qZGJjLnVybCIpKTsKICAg\nIH0KICAgIAogICAgcHVibGljIHZvaWQgdGVzdFBhc3N3b3JkVmFsdWVzQXJl\nSW52aXNpYmxlKCkgewogICAgICAgIE1hcDxTdHJpbmcsIE9iamVjdD4gcHJv\ncHMgPSBlbS5nZXRQcm9wZXJ0aWVzKCk7CiAgICAgICAgYXNzZXJ0UHJvcGVy\ndHkoIm9wZW5qcGEuQ29ubmVjdGlvbjJQYXNzd29yZCIsIHByb3BzLCBWYWx1\nZS5JTlZJU0lCTEUpOwogICAgfQogICAgCiAgICB2b2lkIGFzc2VydFByb3Bl\ncnR5KFN0cmluZyBwcm9wLCBNYXAgcHJvcHMpIHsKICAgICAgICBhc3NlcnRQ\ncm9wZXJ0eShwcm9wLCBwcm9wcywgbnVsbCk7CiAgICB9CiAgICAKICAgIHZv\naWQgYXNzZXJ0UHJvcGVydHkoU3RyaW5nIHByb3AsIE1hcCBwcm9wcywgT2Jq\nZWN0IGV4cGVjdGVkKSB7CiAgICAgICAgYXNzZXJ0VHJ1ZShwcm9wICsgIiBu\nb3QgcHJlc2VudCIsIHByb3BzLmNvbnRhaW5zS2V5KHByb3ApKTsKICAgICAg\nICBPYmplY3QgYWN0dWFsID0gcHJvcHMuZ2V0KHByb3ApOwogICAgICAgIGlm\nIChleHBlY3RlZCAhPSBudWxsKSB7CiAgICAgICAgICAgIGFzc2VydFRydWUo\ncHJvcCArICI6IEFjdHVhbCAiICsgYWN0dWFsLmdldENsYXNzKCkgKyAiIGRv\nZXMgbm90IG1hdGNoIGV4cGVjdGVkICIgKyBleHBlY3RlZC5nZXRDbGFzcygp\nLAogICAgICAgICAgICAgICAgZXhwZWN0ZWQuZ2V0Q2xhc3MoKS5pc0Fzc2ln\nbmFibGVGcm9tKGFjdHVhbC5nZXRDbGFzcygpKSk7CiAgICAgICAgICAgIGFz\nc2VydEVxdWFscyhwcm9wICsgIiB2YWx1ZSBkb2VzIG5vdCBtYXRjaCIsIGV4\ncGVjdGVkLCBhY3R1YWwpOwogICAgICAgIH0KICAgIH0KICAgIAogICAgdm9p\nZCBwcmludChTdHJpbmcgbWVzc2FnZSwgTWFwPFN0cmluZywgT2JqZWN0PiBw\ncm9wcykgewogICAgICAgIFN5c3RlbS5lcnIucHJpbnRsbihtZXNzYWdlKTsK\nICAgICAgICBmb3IgKE1hcC5FbnRyeTxTdHJpbmcsIE9iamVjdD4gZSA6IHBy\nb3BzLmVudHJ5U2V0KCkpIHsKICAgICAgICAgICAgU3lzdGVtLmVyci5wcmlu\ndGxuKGUuZ2V0S2V5KCkgKyAiOiIgKyBlLmdldFZhbHVlKCkgKyAiIFsiICsg\nKGUuZ2V0VmFsdWUoKSA9PSBudWxsID8KICAgICAgICAgICAgICAgICAgICAi\nIiA6IGUuZ2V0VmFsdWUoKS5nZXRDbGFzcygpLmdldFNpbXBsZU5hbWUoKSkg\nKyAiXSIpOwogICAgICAgIH0KICAgIH0KICAgIHZvaWQgcHJpbnQoU3RyaW5n\nIG1lc3NhZ2UsIFNldDxTdHJpbmc+IHByb3BzKSB7CiAgICAgICAgU3lzdGVt\nLmVyci5wcmludGxuKG1lc3NhZ2UpOwogICAgICAgIGZvciAoU3RyaW5nIHAg\nOiBwcm9wcykgewogICAgICAgICAgICBTeXN0ZW0uZXJyLnByaW50bG4ocCk7\nCiAgICAgICAgfQogICAgfQogICAgCgp9Cg==\n","encoding":"base64"}

