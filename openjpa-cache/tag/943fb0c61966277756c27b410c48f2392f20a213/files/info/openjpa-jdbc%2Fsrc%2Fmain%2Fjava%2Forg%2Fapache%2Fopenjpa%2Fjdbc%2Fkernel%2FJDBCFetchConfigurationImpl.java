{"sha":"5ee4b2f216e0ad0f5475157bd4ea80b1a2b5efb2","node_id":"MDQ6QmxvYjIwNjM2NDo1ZWU0YjJmMjE2ZTBhZDBmNTQ3NTE1N2JkNGVhODBiMWEyYjVlZmIy","size":12559,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/5ee4b2f216e0ad0f5475157bd4ea80b1a2b5efb2","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5rZXJuZWw7CgppbXBv\ncnQgamF2YS5pby5TZXJpYWxpemFibGU7CmltcG9ydCBqYXZhLnNxbC5SZXN1\nbHRTZXQ7CmltcG9ydCBqYXZhLnNxbC5Db25uZWN0aW9uOwppbXBvcnQgamF2\nYS51dGlsLkNvbGxlY3Rpb247CmltcG9ydCBqYXZhLnV0aWwuQ29sbGVjdGlv\nbnM7CmltcG9ydCBqYXZhLnV0aWwuSGFzaFNldDsKaW1wb3J0IGphdmEudXRp\nbC5JdGVyYXRvcjsKaW1wb3J0IGphdmEudXRpbC5TZXQ7CgppbXBvcnQgb3Jn\nLmFwYWNoZS5jb21tb25zLmxhbmcuU3RyaW5nVXRpbHM7CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEuY29uZi5PcGVuSlBBQ29uZmlndXJhdGlvbjsKaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLmNvbmYuSkRCQ0NvbmZpZ3Vy\nYXRpb247CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhLkNs\nYXNzTWFwcGluZzsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwu\nRmV0Y2hDb25maWd1cmF0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLmtlcm5lbC5GZXRjaENvbmZpZ3VyYXRpb25JbXBsOwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLmtlcm5lbC5TdG9yZUNvbnRleHQ7CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEubGliLnJvcC5FYWdlclJlc3VsdExpc3Q7CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnJvcC5MaXN0UmVzdWx0T2JqZWN0\nUHJvdmlkZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnJvcC5S\nZXN1bHRMaXN0OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi5yb3Au\nUmVzdWx0T2JqZWN0UHJvdmlkZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEubGliLnJvcC5TaW1wbGVSZXN1bHRMaXN0OwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLmxpYi5yb3AuU29mdFJhbmRvbUFjY2Vzc1Jlc3VsdExpc3Q7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnJvcC5XaW5kb3dSZXN1\nbHRMaXN0OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51dGlsLkxv\nY2FsaXplcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRhLkZpZWxk\nTWV0YURhdGE7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5Vc2Vy\nRXhjZXB0aW9uOwoKLyoqCiAqIEpEQkMgZXh0ZW5zaW9ucyB0byBPcGVuSlBB\nJ3Mge0BsaW5rIEZldGNoQ29uZmlndXJhdGlvbn0uCiAqCiAqIEBhdXRob3Ig\nQWJlIFdoaXRlCiAqIEBub2phdmFkb2MKICovCnB1YmxpYyBjbGFzcyBKREJD\nRmV0Y2hDb25maWd1cmF0aW9uSW1wbAogICAgZXh0ZW5kcyBGZXRjaENvbmZp\nZ3VyYXRpb25JbXBsCiAgICBpbXBsZW1lbnRzIEpEQkNGZXRjaENvbmZpZ3Vy\nYXRpb24gewoKICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIExvY2FsaXplciBf\nbG9jID0gTG9jYWxpemVyLmZvclBhY2thZ2UKICAgICAgICAoSkRCQ0ZldGNo\nQ29uZmlndXJhdGlvbkltcGwuY2xhc3MpOwoKICAgIC8qKgogICAgICogQ29u\nZmlndXJhYmxlIEpEQkMgc3RhdGUgc2hhcmVkIHRocm91Z2hvdXQgYSB0cmF2\nZXJzYWwgY2hhaW4uCiAgICAgKi8KICAgIHByaXZhdGUgc3RhdGljIGNsYXNz\nIEpEQkNDb25maWd1cmF0aW9uU3RhdGUgaW1wbGVtZW50cyBTZXJpYWxpemFi\nbGUgewogICAgICAgIHB1YmxpYyBpbnQgZWFnZXJNb2RlID0gMDsKICAgICAg\nICBwdWJsaWMgaW50IHN1YmNsYXNzTW9kZSA9IDA7CiAgICAgICAgcHVibGlj\nIGludCB0eXBlID0gMDsKICAgICAgICBwdWJsaWMgaW50IGRpcmVjdGlvbiA9\nIDA7CiAgICAgICAgcHVibGljIGludCBzaXplID0gMDsKICAgICAgICBwdWJs\naWMgaW50IHN5bnRheCA9IDA7CiAgICAgICAgcHVibGljIFNldCBqb2lucyA9\nIG51bGw7CiAgICAgICAgcHVibGljIFNldCBmZXRjaElubmVySm9pbnMgPSBu\ndWxsOwogICAgICAgIHB1YmxpYyBpbnQgaXNvbGF0aW9uTGV2ZWwgPSAtMTsK\nICAgIH0KCiAgICBwcml2YXRlIGZpbmFsIEpEQkNDb25maWd1cmF0aW9uU3Rh\ndGUgX3N0YXRlOwoKICAgIHB1YmxpYyBKREJDRmV0Y2hDb25maWd1cmF0aW9u\nSW1wbCgpIHsKICAgICAgICB0aGlzKG51bGwsIG51bGwpOwogICAgfQoKICAg\nIHByaXZhdGUgSkRCQ0ZldGNoQ29uZmlndXJhdGlvbkltcGwoQ29uZmlndXJh\ndGlvblN0YXRlIHN0YXRlLCAKICAgICAgICBKREJDQ29uZmlndXJhdGlvblN0\nYXRlIGpzdGF0ZSkgewogICAgICAgIHN1cGVyKHN0YXRlKTsKICAgICAgICBf\nc3RhdGUgPSAoanN0YXRlID09IG51bGwpID8gbmV3IEpEQkNDb25maWd1cmF0\naW9uU3RhdGUoKSA6IGpzdGF0ZTsKICAgIH0KCiAgICBwcm90ZWN0ZWQgRmV0\nY2hDb25maWd1cmF0aW9uSW1wbCBuZXdJbnN0YW5jZShDb25maWd1cmF0aW9u\nU3RhdGUgc3RhdGUpIHsKICAgICAgICBKREJDQ29uZmlndXJhdGlvblN0YXRl\nIGpzdGF0ZSA9IChzdGF0ZSA9PSBudWxsKSA/IG51bGwgOiBfc3RhdGU7CiAg\nICAgICAgcmV0dXJuIG5ldyBKREJDRmV0Y2hDb25maWd1cmF0aW9uSW1wbChz\ndGF0ZSwganN0YXRlKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRDb250\nZXh0KFN0b3JlQ29udGV4dCBjdHgpIHsKICAgICAgICBzdXBlci5zZXRDb250\nZXh0KGN0eCk7CiAgICAgICAgSkRCQ0NvbmZpZ3VyYXRpb24gY29uZiA9IGdl\ndEpEQkNDb25maWd1cmF0aW9uKCk7CiAgICAgICAgaWYgKGNvbmYgPT0gbnVs\nbCkKICAgICAgICAgICAgcmV0dXJuOwoKICAgICAgICBzZXRFYWdlckZldGNo\nTW9kZShjb25mLmdldEVhZ2VyRmV0Y2hNb2RlQ29uc3RhbnQoKSk7CiAgICAg\nICAgc2V0U3ViY2xhc3NGZXRjaE1vZGUoY29uZi5nZXRTdWJjbGFzc0ZldGNo\nTW9kZUNvbnN0YW50KCkpOwogICAgICAgIHNldFJlc3VsdFNldFR5cGUoY29u\nZi5nZXRSZXN1bHRTZXRUeXBlQ29uc3RhbnQoKSk7CiAgICAgICAgc2V0RmV0\nY2hEaXJlY3Rpb24oY29uZi5nZXRGZXRjaERpcmVjdGlvbkNvbnN0YW50KCkp\nOwogICAgICAgIHNldExSU1NpemUoY29uZi5nZXRMUlNTaXplQ29uc3RhbnQo\nKSk7CiAgICAgICAgc2V0Sm9pblN5bnRheChjb25mLmdldERCRGljdGlvbmFy\neUluc3RhbmNlKCkuam9pblN5bnRheCk7CiAgICB9CgogICAgcHVibGljIHZv\naWQgY29weShGZXRjaENvbmZpZ3VyYXRpb24gZmV0Y2gpIHsKICAgICAgICBz\ndXBlci5jb3B5KGZldGNoKTsKICAgICAgICBKREJDRmV0Y2hDb25maWd1cmF0\naW9uIGpmID0gKEpEQkNGZXRjaENvbmZpZ3VyYXRpb24pIGZldGNoOwogICAg\nICAgIHNldEVhZ2VyRmV0Y2hNb2RlKGpmLmdldEVhZ2VyRmV0Y2hNb2RlKCkp\nOwogICAgICAgIHNldFN1YmNsYXNzRmV0Y2hNb2RlKGpmLmdldFN1YmNsYXNz\nRmV0Y2hNb2RlKCkpOwogICAgICAgIHNldFJlc3VsdFNldFR5cGUoamYuZ2V0\nUmVzdWx0U2V0VHlwZSgpKTsKICAgICAgICBzZXRGZXRjaERpcmVjdGlvbihq\nZi5nZXRGZXRjaERpcmVjdGlvbigpKTsKICAgICAgICBzZXRMUlNTaXplKGpm\nLmdldExSU1NpemUoKSk7CiAgICAgICAgc2V0Sm9pblN5bnRheChqZi5nZXRK\nb2luU3ludGF4KCkpOwogICAgICAgIGFkZEpvaW5zKGpmLmdldEpvaW5zKCkp\nOwogICAgfQoKICAgIHB1YmxpYyBpbnQgZ2V0RWFnZXJGZXRjaE1vZGUoKSB7\nCiAgICAgICAgcmV0dXJuIF9zdGF0ZS5lYWdlck1vZGU7CiAgICB9CgogICAg\ncHVibGljIEpEQkNGZXRjaENvbmZpZ3VyYXRpb24gc2V0RWFnZXJGZXRjaE1v\nZGUoaW50IG1vZGUpIHsKICAgICAgICBpZiAobW9kZSA9PSBERUZBVUxUKSB7\nCiAgICAgICAgICAgIEpEQkNDb25maWd1cmF0aW9uIGNvbmYgPSBnZXRKREJD\nQ29uZmlndXJhdGlvbigpOwogICAgICAgICAgICBpZiAoY29uZiAhPSBudWxs\nKQogICAgICAgICAgICAgICAgbW9kZSA9IGNvbmYuZ2V0RWFnZXJGZXRjaE1v\nZGVDb25zdGFudCgpOwogICAgICAgIH0KICAgICAgICBpZiAobW9kZSAhPSBE\nRUZBVUxUKQogICAgICAgICAgICBfc3RhdGUuZWFnZXJNb2RlID0gbW9kZTsK\nICAgICAgICByZXR1cm4gdGhpczsKICAgIH0KCiAgICBwdWJsaWMgaW50IGdl\ndFN1YmNsYXNzRmV0Y2hNb2RlKCkgewogICAgICAgIHJldHVybiBfc3RhdGUu\nc3ViY2xhc3NNb2RlOwogICAgfQoKICAgIHB1YmxpYyBpbnQgZ2V0U3ViY2xh\nc3NGZXRjaE1vZGUoQ2xhc3NNYXBwaW5nIGNscykgewogICAgICAgIGlmIChj\nbHMgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIF9zdGF0ZS5zdWJjbGFz\nc01vZGU7CiAgICAgICAgaW50IG1vZGUgPSBjbHMuZ2V0U3ViY2xhc3NGZXRj\naE1vZGUoKTsKICAgICAgICBpZiAobW9kZSA9PSBERUZBVUxUKQogICAgICAg\nICAgICByZXR1cm4gX3N0YXRlLnN1YmNsYXNzTW9kZTsKICAgICAgICByZXR1\ncm4gTWF0aC5taW4obW9kZSwgX3N0YXRlLnN1YmNsYXNzTW9kZSk7CiAgICB9\nCgogICAgcHVibGljIEpEQkNGZXRjaENvbmZpZ3VyYXRpb24gc2V0U3ViY2xh\nc3NGZXRjaE1vZGUoaW50IG1vZGUpIHsKICAgICAgICBpZiAobW9kZSA9PSBE\nRUZBVUxUKSB7CiAgICAgICAgICAgIEpEQkNDb25maWd1cmF0aW9uIGNvbmYg\nPSBnZXRKREJDQ29uZmlndXJhdGlvbigpOwogICAgICAgICAgICBpZiAoY29u\nZiAhPSBudWxsKQogICAgICAgICAgICAgICAgbW9kZSA9IGNvbmYuZ2V0U3Vi\nY2xhc3NGZXRjaE1vZGVDb25zdGFudCgpOwogICAgICAgIH0KICAgICAgICBp\nZiAobW9kZSAhPSBERUZBVUxUKQogICAgICAgICAgICBfc3RhdGUuc3ViY2xh\nc3NNb2RlID0gbW9kZTsKICAgICAgICByZXR1cm4gdGhpczsKICAgIH0KCiAg\nICBwdWJsaWMgaW50IGdldFJlc3VsdFNldFR5cGUoKSB7CiAgICAgICAgcmV0\ndXJuIF9zdGF0ZS50eXBlOwogICAgfQoKICAgIHB1YmxpYyBKREJDRmV0Y2hD\nb25maWd1cmF0aW9uIHNldFJlc3VsdFNldFR5cGUoaW50IHR5cGUpIHsKICAg\nICAgICBpZiAodHlwZSA9PSBERUZBVUxUKSB7CiAgICAgICAgICAgIEpEQkND\nb25maWd1cmF0aW9uIGNvbmYgPSBnZXRKREJDQ29uZmlndXJhdGlvbigpOwog\nICAgICAgICAgICBpZiAoY29uZiAhPSBudWxsKQogICAgICAgICAgICAgICAg\nX3N0YXRlLnR5cGUgPSBjb25mLmdldFJlc3VsdFNldFR5cGVDb25zdGFudCgp\nOwogICAgICAgIH0gZWxzZQogICAgICAgICAgICBfc3RhdGUudHlwZSA9IHR5\ncGU7CiAgICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CgogICAgcHVibGljIGlu\ndCBnZXRGZXRjaERpcmVjdGlvbigpIHsKICAgICAgICByZXR1cm4gX3N0YXRl\nLmRpcmVjdGlvbjsKICAgIH0KCiAgICBwdWJsaWMgSkRCQ0ZldGNoQ29uZmln\ndXJhdGlvbiBzZXRGZXRjaERpcmVjdGlvbihpbnQgZGlyZWN0aW9uKSB7CiAg\nICAgICAgaWYgKGRpcmVjdGlvbiA9PSBERUZBVUxUKSB7CiAgICAgICAgICAg\nIEpEQkNDb25maWd1cmF0aW9uIGNvbmYgPSBnZXRKREJDQ29uZmlndXJhdGlv\nbigpOwogICAgICAgICAgICBpZiAoY29uZiAhPSBudWxsKQogICAgICAgICAg\nICAgICAgX3N0YXRlLmRpcmVjdGlvbiA9IGNvbmYuZ2V0RmV0Y2hEaXJlY3Rp\nb25Db25zdGFudCgpOwogICAgICAgIH0gZWxzZQogICAgICAgICAgICBfc3Rh\ndGUuZGlyZWN0aW9uID0gZGlyZWN0aW9uOwogICAgICAgIHJldHVybiB0aGlz\nOwogICAgfQoKICAgIHB1YmxpYyBpbnQgZ2V0TFJTU2l6ZSgpIHsKICAgICAg\nICByZXR1cm4gX3N0YXRlLnNpemU7CiAgICB9CgogICAgcHVibGljIEpEQkNG\nZXRjaENvbmZpZ3VyYXRpb24gc2V0TFJTU2l6ZShpbnQgc2l6ZSkgewogICAg\nICAgIGlmIChzaXplID09IERFRkFVTFQpIHsKICAgICAgICAgICAgSkRCQ0Nv\nbmZpZ3VyYXRpb24gY29uZiA9IGdldEpEQkNDb25maWd1cmF0aW9uKCk7CiAg\nICAgICAgICAgIGlmIChjb25mICE9IG51bGwpCiAgICAgICAgICAgICAgICBf\nc3RhdGUuc2l6ZSA9IGNvbmYuZ2V0TFJTU2l6ZUNvbnN0YW50KCk7CiAgICAg\nICAgfSBlbHNlCiAgICAgICAgICAgIF9zdGF0ZS5zaXplID0gc2l6ZTsKICAg\nICAgICByZXR1cm4gdGhpczsKICAgIH0KCiAgICBwdWJsaWMgaW50IGdldEpv\naW5TeW50YXgoKSB7CiAgICAgICAgcmV0dXJuIF9zdGF0ZS5zeW50YXg7CiAg\nICB9CgogICAgcHVibGljIEpEQkNGZXRjaENvbmZpZ3VyYXRpb24gc2V0Sm9p\nblN5bnRheChpbnQgc3ludGF4KSB7CiAgICAgICAgaWYgKHN5bnRheCA9PSBE\nRUZBVUxUKSB7CiAgICAgICAgICAgIEpEQkNDb25maWd1cmF0aW9uIGNvbmYg\nPSBnZXRKREJDQ29uZmlndXJhdGlvbigpOwogICAgICAgICAgICBpZiAoY29u\nZiAhPSBudWxsKQogICAgICAgICAgICAgICAgX3N0YXRlLnN5bnRheCA9IGNv\nbmYuZ2V0REJEaWN0aW9uYXJ5SW5zdGFuY2UoKS5qb2luU3ludGF4OwogICAg\nICAgIH0gZWxzZQogICAgICAgICAgICBfc3RhdGUuc3ludGF4ID0gc3ludGF4\nOwogICAgICAgIHJldHVybiB0aGlzOwogICAgfQoKICAgIHB1YmxpYyBSZXN1\nbHRMaXN0IG5ld1Jlc3VsdExpc3QoUmVzdWx0T2JqZWN0UHJvdmlkZXIgcm9w\nKSB7CiAgICAgICAgLy8gaWYgYnVpbHQgYXJvdW5kIGEgbGlzdCwganVzdCB1\nc2UgYSBzaW1wbGUgd3JhcHBlcgogICAgICAgIGlmIChyb3AgaW5zdGFuY2Vv\nZiBMaXN0UmVzdWx0T2JqZWN0UHJvdmlkZXIpCiAgICAgICAgICAgIHJldHVy\nbiBuZXcgU2ltcGxlUmVzdWx0TGlzdChyb3ApOwoKICAgICAgICAvLyBpZiBi\ndWlsdCBhcm91bmQgYSBwYWdpbmcgbGlzdCwgdXNlIGEgd2luZG93IHByb3Zp\nZGVyIHdpdGggdGhlCiAgICAgICAgLy8gc2FtZSB3aW5kb3cgc2l6ZQogICAg\nICAgIGlmIChyb3AgaW5zdGFuY2VvZiBQYWdpbmdSZXN1bHRPYmplY3RQcm92\naWRlcikKICAgICAgICAgICAgcmV0dXJuIG5ldyBXaW5kb3dSZXN1bHRMaXN0\nKHJvcCwgKChQYWdpbmdSZXN1bHRPYmplY3RQcm92aWRlcikKICAgICAgICAg\nICAgICAgIHJvcCkuZ2V0UGFnZVNpemUoKSk7CgogICAgICAgIC8vIGlmIGZl\ndGNoIHNpemUgPCAwIGp1c3QgcmVhZCBpbiBhbGwgcmVzdWx0cyBpbW1lZGlh\ndGVseQogICAgICAgIGlmIChnZXRGZXRjaEJhdGNoU2l6ZSgpIDwgMCkKICAg\nICAgICAgICAgcmV0dXJuIG5ldyBFYWdlclJlc3VsdExpc3Qocm9wKTsKCiAg\nICAgICAgLy8gaWYgZm93YXJkIG9ubHkgb3IgZm9yd2FyZCBkaXJlY3Rpb24g\ndXNlIGEgZm9yd2FyZCB3aW5kb3cKICAgICAgICBpZiAoX3N0YXRlLnR5cGUg\nPT0gUmVzdWx0U2V0LlRZUEVfRk9SV0FSRF9PTkxZCiAgICAgICAgICAgIHx8\nIF9zdGF0ZS5kaXJlY3Rpb24gPT0gUmVzdWx0U2V0LkZFVENIX0ZPUldBUkQK\nICAgICAgICAgICAgfHwgIXJvcC5zdXBwb3J0c1JhbmRvbUFjY2VzcygpKSB7\nCiAgICAgICAgICAgIGlmIChnZXRGZXRjaEJhdGNoU2l6ZSgpID4gMCAmJiBn\nZXRGZXRjaEJhdGNoU2l6ZSgpIDw9IDUwKQogICAgICAgICAgICAgICAgcmV0\ndXJuIG5ldyBXaW5kb3dSZXN1bHRMaXN0KHJvcCwgZ2V0RmV0Y2hCYXRjaFNp\nemUoKSk7CiAgICAgICAgICAgIHJldHVybiBuZXcgV2luZG93UmVzdWx0TGlz\ndChyb3AsIDUwKTsKICAgICAgICB9CgogICAgICAgIC8vIGlmIHNraXBwaW5n\nIGFyb3VuZCB1c2UgYSBjYWNoaW5nIHJhbmRvbSBhY2Nlc3MgbGlzdAogICAg\nICAgIGlmIChfc3RhdGUuZGlyZWN0aW9uID09IFJlc3VsdFNldC5GRVRDSF9V\nTktOT1dOKQogICAgICAgICAgICByZXR1cm4gbmV3IFNvZnRSYW5kb21BY2Nl\nc3NSZXN1bHRMaXN0KHJvcCk7CgogICAgICAgIC8vIHNjcm9sbGluZyByZXZl\ncnNlLi4uIGp1c3QgdXNlIG5vbi1jYWNoaW5nIHNpbXBsZSByZXN1bHQgbGlz\ndAogICAgICAgIHJldHVybiBuZXcgU2ltcGxlUmVzdWx0TGlzdChyb3ApOwog\nICAgfQoKICAgIHB1YmxpYyBTZXQgZ2V0Sm9pbnMoKSB7CiAgICAgICAgcmV0\ndXJuIChfc3RhdGUuam9pbnMgPT0gbnVsbCkgPyBDb2xsZWN0aW9ucy5FTVBU\nWV9TRVQgOiBfc3RhdGUuam9pbnM7CiAgICB9CgogICAgcHVibGljIGJvb2xl\nYW4gaGFzSm9pbihTdHJpbmcgZmllbGQpIHsKICAgICAgICByZXR1cm4gX3N0\nYXRlLmpvaW5zICE9IG51bGwgJiYgX3N0YXRlLmpvaW5zLmNvbnRhaW5zKGZp\nZWxkKTsKICAgIH0KCiAgICBwdWJsaWMgSkRCQ0ZldGNoQ29uZmlndXJhdGlv\nbiBhZGRKb2luKFN0cmluZyBqb2luKSB7CiAgICAgICAgaWYgKFN0cmluZ1V0\naWxzLmlzRW1wdHkoam9pbikpCiAgICAgICAgICAgIHRocm93IG5ldyBVc2Vy\nRXhjZXB0aW9uKF9sb2MuZ2V0KCJudWxsLWpvaW4iKSk7CiAgICAgICAgCiAg\nICAgICAgbG9jaygpOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIGlmIChf\nc3RhdGUuam9pbnMgPT0gbnVsbCkKICAgICAgICAgICAgICAgIF9zdGF0ZS5q\nb2lucyA9IG5ldyBIYXNoU2V0KCk7CiAgICAgICAgICAgIF9zdGF0ZS5qb2lu\ncy5hZGQoam9pbik7CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAg\ndW5sb2NrKCk7CiAgICAgICAgfQogICAgICAgIHJldHVybiB0aGlzOwogICAg\nfQoKICAgIHB1YmxpYyBKREJDRmV0Y2hDb25maWd1cmF0aW9uIGFkZEpvaW5z\nKENvbGxlY3Rpb24gam9pbnMpIHsKICAgICAgICBpZiAoam9pbnMgPT0gbnVs\nbCB8fCBqb2lucy5pc0VtcHR5KCkpCiAgICAgICAgICAgIHJldHVybiB0aGlz\nOwogICAgICAgIGZvciAoSXRlcmF0b3IgaXRyID0gam9pbnMuaXRlcmF0b3Io\nKTsgaXRyLmhhc05leHQoKTspCiAgICAgICAgICAgIGFkZEpvaW4oKFN0cmlu\nZykgaXRyLm5leHQoKSk7CiAgICAgICAgcmV0dXJuIHRoaXM7CiAgICB9Cgog\nICAgcHVibGljIEpEQkNGZXRjaENvbmZpZ3VyYXRpb24gcmVtb3ZlSm9pbihT\ndHJpbmcgZmllbGQpIHsKICAgICAgICBsb2NrKCk7CiAgICAgICAgdHJ5IHsK\nICAgICAgICAgICAgaWYgKF9zdGF0ZS5qb2lucyAhPSBudWxsKQogICAgICAg\nICAgICAgICAgX3N0YXRlLmpvaW5zLnJlbW92ZShmaWVsZCk7CiAgICAgICAg\nfSBmaW5hbGx5IHsKICAgICAgICAgICAgdW5sb2NrKCk7CiAgICAgICAgfQog\nICAgICAgIHJldHVybiB0aGlzOwogICAgfQoKICAgIHB1YmxpYyBKREJDRmV0\nY2hDb25maWd1cmF0aW9uIHJlbW92ZUpvaW5zKENvbGxlY3Rpb24gam9pbnMp\nIHsKICAgICAgICBsb2NrKCk7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAg\naWYgKF9zdGF0ZS5qb2lucyAhPSBudWxsKQogICAgICAgICAgICAgICAgX3N0\nYXRlLmpvaW5zLnJlbW92ZUFsbChqb2lucyk7CiAgICAgICAgfSBmaW5hbGx5\nIHsKICAgICAgICAgICAgdW5sb2NrKCk7CiAgICAgICAgfQogICAgICAgIHJl\ndHVybiB0aGlzOwogICAgfQoKICAgIHB1YmxpYyBKREJDRmV0Y2hDb25maWd1\ncmF0aW9uIGNsZWFySm9pbnMoKSB7CiAgICAgICAgbG9jaygpOwogICAgICAg\nIHRyeSB7CiAgICAgICAgICAgIGlmIChfc3RhdGUuam9pbnMgIT0gbnVsbCkK\nICAgICAgICAgICAgICAgIF9zdGF0ZS5qb2lucy5jbGVhcigpOwogICAgICAg\nIH0gZmluYWxseSB7CiAgICAgICAgICAgIHVubG9jaygpOwogICAgICAgIH0K\nICAgICAgICByZXR1cm4gdGhpczsKICAgIH0KCiAgICBwdWJsaWMgaW50IGdl\ndElzb2xhdGlvbigpIHsKICAgICAgICByZXR1cm4gX3N0YXRlLmlzb2xhdGlv\nbkxldmVsOwogICAgfQoKICAgIHB1YmxpYyBKREJDRmV0Y2hDb25maWd1cmF0\naW9uIHNldElzb2xhdGlvbihpbnQgbGV2ZWwpIHsKICAgICAgICBpZiAobGV2\nZWwgIT0gLTEgJiYgbGV2ZWwgIT0gREVGQVVMVAogICAgICAgICAgICAmJiBs\nZXZlbCAhPSBDb25uZWN0aW9uLlRSQU5TQUNUSU9OX05PTkUKICAgICAgICAg\nICAgJiYgbGV2ZWwgIT0gQ29ubmVjdGlvbi5UUkFOU0FDVElPTl9SRUFEX1VO\nQ09NTUlUVEVECiAgICAgICAgICAgICYmIGxldmVsICE9IENvbm5lY3Rpb24u\nVFJBTlNBQ1RJT05fUkVBRF9DT01NSVRURUQKICAgICAgICAgICAgJiYgbGV2\nZWwgIT0gQ29ubmVjdGlvbi5UUkFOU0FDVElPTl9SRVBFQVRBQkxFX1JFQUQK\nICAgICAgICAgICAgJiYgbGV2ZWwgIT0gQ29ubmVjdGlvbi5UUkFOU0FDVElP\nTl9TRVJJQUxJWkFCTEUpCiAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2Fs\nQXJndW1lbnRFeGNlcHRpb24oCiAgICAgICAgICAgICAgICBfbG9jLmdldCgi\nYmFkLWxldmVsIiwgbmV3IEludGVnZXIobGV2ZWwpKS5nZXRNZXNzYWdlKCkp\nOwoKICAgICAgICBpZiAobGV2ZWwgPT0gREVGQVVMVCkKICAgICAgICAgICAg\nX3N0YXRlLmlzb2xhdGlvbkxldmVsID0gLTE7CiAgICAgICAgZWxzZQogICAg\nICAgICAgICBfc3RhdGUuaXNvbGF0aW9uTGV2ZWwgPSBsZXZlbDsKICAgICAg\nICByZXR1cm4gdGhpczsKICAgIH0KCiAgICBwdWJsaWMgSkRCQ0ZldGNoQ29u\nZmlndXJhdGlvbiB0cmF2ZXJzZUpEQkMoRmllbGRNZXRhRGF0YSBmbSkgewog\nICAgICAgIHJldHVybiAoSkRCQ0ZldGNoQ29uZmlndXJhdGlvbikgdHJhdmVy\nc2UoZm0pOwogICAgfQoKICAgIC8qKgogICAgICogQWNjZXNzIEpEQkMgY29u\nZmlndXJhdGlvbiBpbmZvcm1hdGlvbi4gTWF5IHJldHVybiBudWxsIGlmIG5v\ndCBhCiAgICAgKiBKREJDIGJhY2stZW5kIChwb3NzaWJsZSB0byBnZXQgYSBK\nREJDRmV0Y2hDb25maWd1cmF0aW9uIG9uIG5vbi1KREJDCiAgICAgKiBiYWNr\nIGVuZCBpbiByZW1vdGUgY2xpZW50KS4KICAgICAqLwogICAgcHJpdmF0ZSBK\nREJDQ29uZmlndXJhdGlvbiBnZXRKREJDQ29uZmlndXJhdGlvbigpIHsKICAg\nICAgICBTdG9yZUNvbnRleHQgY3R4ID0gZ2V0Q29udGV4dCgpOwogICAgICAg\nIGlmIChjdHggPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAg\nICAgICAgT3BlbkpQQUNvbmZpZ3VyYXRpb24gY29uZiA9IGN0eC5nZXRDb25m\naWd1cmF0aW9uKCk7CiAgICAgICAgaWYgKCEoY29uZiBpbnN0YW5jZW9mIEpE\nQkNDb25maWd1cmF0aW9uKSkKICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAg\nICAgICAgcmV0dXJuIChKREJDQ29uZmlndXJhdGlvbikgY29uZjsKICAgIH0K\nCiAgICBwdWJsaWMgU2V0IGdldEZldGNoSW5uZXJKb2lucygpIHsKICAgICAg\nICByZXR1cm4gKF9zdGF0ZS5mZXRjaElubmVySm9pbnMgPT0gbnVsbCkgPyBD\nb2xsZWN0aW9ucy5FTVBUWV9TRVQKICAgICAgICAgICAgOiBfc3RhdGUuZmV0\nY2hJbm5lckpvaW5zOwogICAgfQoKICAgIHB1YmxpYyBib29sZWFuIGhhc0Zl\ndGNoSW5uZXJKb2luKFN0cmluZyBmaWVsZCkgewogICAgICAgIHJldHVybiBf\nc3RhdGUuZmV0Y2hJbm5lckpvaW5zICE9IG51bGwgJiYKICAgICAgICAgICAg\nX3N0YXRlLmZldGNoSW5uZXJKb2lucy5jb250YWlucyhmaWVsZCk7CiAgICB9\nCgogICAgcHVibGljIEpEQkNGZXRjaENvbmZpZ3VyYXRpb24gYWRkRmV0Y2hJ\nbm5lckpvaW4oU3RyaW5nIGpvaW4pIHsKICAgICAgICBpZiAoU3RyaW5nVXRp\nbHMuaXNFbXB0eShqb2luKSkKICAgICAgICAgICAgdGhyb3cgbmV3IFVzZXJF\neGNlcHRpb24oX2xvYy5nZXQoIm51bGwtam9pbiIpKTsKICAgICAgICAKICAg\nICAgICBsb2NrKCk7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgaWYgKF9z\ndGF0ZS5mZXRjaElubmVySm9pbnMgPT0gbnVsbCkKICAgICAgICAgICAgICAg\nIF9zdGF0ZS5mZXRjaElubmVySm9pbnMgPSBuZXcgSGFzaFNldCgpOwogICAg\nICAgICAgICBfc3RhdGUuZmV0Y2hJbm5lckpvaW5zLmFkZChqb2luKTsKICAg\nICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICB1bmxvY2soKTsKICAgICAg\nICB9CiAgICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CgogICAgcHVibGljIEpE\nQkNGZXRjaENvbmZpZ3VyYXRpb24gYWRkRmV0Y2hJbm5lckpvaW5zKENvbGxl\nY3Rpb24gam9pbnMpIHsKICAgICAgICBpZiAoam9pbnMgPT0gbnVsbCB8fCBq\nb2lucy5pc0VtcHR5KCkpCiAgICAgICAgICAgIHJldHVybiB0aGlzOwogICAg\nICAgIGZvciAoSXRlcmF0b3IgaXRyID0gam9pbnMuaXRlcmF0b3IoKTsgaXRy\nLmhhc05leHQoKTspCiAgICAgICAgICAgIGFkZEZldGNoSW5uZXJKb2luKChT\ndHJpbmcpIGl0ci5uZXh0KCkpOwogICAgICAgIHJldHVybiB0aGlzOwogICAg\nfQp9Cg==\n","encoding":"base64"}

