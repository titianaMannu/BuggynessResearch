{"sha":"bb4ce7f5b7d3537919186ea4063e580260006c4b","node_id":"MDQ6QmxvYjIwNjM2NDpiYjRjZTdmNWI3ZDM1Mzc5MTkxODZlYTQwNjNlNTgwMjYwMDA2YzRi","size":27125,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/bb4ce7f5b7d3537919186ea4063e580260006c4b","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5rZXJuZWw7CgppbXBv\ncnQgamF2YS5zcWwuQ29ubmVjdGlvbjsKaW1wb3J0IGphdmEuc3FsLlByZXBh\ncmVkU3RhdGVtZW50OwppbXBvcnQgamF2YS5zcWwuU1FMRXhjZXB0aW9uOwpp\nbXBvcnQgamF2YS51dGlsLkFycmF5TGlzdDsKaW1wb3J0IGphdmEudXRpbC5B\ncnJheXM7CmltcG9ydCBqYXZhLnV0aWwuQml0U2V0OwppbXBvcnQgamF2YS51\ndGlsLkNvbGxlY3Rpb247CmltcG9ydCBqYXZhLnV0aWwuSGFzaE1hcDsKaW1w\nb3J0IGphdmEudXRpbC5MaXN0OwppbXBvcnQgamF2YS51dGlsLk1hcDsKaW1w\nb3J0IGphdmEudXRpbC5JdGVyYXRvcjsKCmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEuZXZlbnQuTGlmZWN5Y2xlRXZlbnRNYW5hZ2VyOwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLmpkYmMua2VybmVsLmV4cHMuRXhwQ29udGV4dDsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLmtlcm5lbC5leHBzLkdl\ndENvbHVtbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLmtlcm5l\nbC5leHBzLkpEQkNFeHByZXNzaW9uRmFjdG9yeTsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5qZGJjLmtlcm5lbC5leHBzLkpEQkNTdHJpbmdDb250YWlu\nczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLmtlcm5lbC5leHBz\nLkpEQkNXaWxkY2FyZE1hdGNoOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLmpkYmMua2VybmVsLmV4cHMuUXVlcnlFeHByZXNzaW9uc1N0YXRlOwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMua2VybmVsLmV4cHMuU1FMRW1i\nZWQ7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5rZXJuZWwuZXhw\ncy5TUUxFeHByZXNzaW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpk\nYmMua2VybmVsLmV4cHMuU1FMVmFsdWU7CmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEuamRiYy5tZXRhLkNsYXNzTWFwcGluZzsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5qZGJjLm1ldGEuRmllbGRNYXBwaW5nOwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0YS5zdHJhdHMuVmVydGljYWxDbGFz\nc1N0cmF0ZWd5OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2No\nZW1hLkNvbHVtbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNj\naGVtYS5UYWJsZTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNx\nbC5EQkRpY3Rpb25hcnk7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRi\nYy5zcWwuU1FMQnVmZmVyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpk\nYmMuc3FsLlNRTEV4Y2VwdGlvbnM7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEuamRiYy5zcWwuU2VsZWN0OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLmpkYmMuc3FsLlVuaW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmtl\ncm5lbC5FeHByZXNzaW9uU3RvcmVRdWVyeTsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS5rZXJuZWwuT3JkZXJpbmdNZXJnZWRSZXN1bHRPYmplY3RQcm92\naWRlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuUXVlcnlI\naW50czsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuZXhwcy5F\neHByZXNzaW9uRmFjdG9yeTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5r\nZXJuZWwuZXhwcy5FeHByZXNzaW9uUGFyc2VyOwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLmtlcm5lbC5leHBzLkZpbHRlckxpc3RlbmVyOwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5leHBzLlF1ZXJ5RXhwcmVzc2lv\nbnM7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnJvcC5NZXJnZWRS\nZXN1bHRPYmplY3RQcm92aWRlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3Blbmpw\nYS5saWIucm9wLlJhbmdlUmVzdWx0T2JqZWN0UHJvdmlkZXI7CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEubGliLnJvcC5SZXN1bHRPYmplY3RQcm92aWRl\ncjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIudXRpbC5Mb2NhbGl6\nZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YS5DbGFzc01ldGFE\nYXRhOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuVmFsdWVNZXRh\nRGF0YTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRhLkZpZWxkTWV0\nYURhdGE7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5Vc2VyRXhj\nZXB0aW9uOwppbXBvcnQgc2VycC51dGlsLk51bWJlcnM7CgovKioKICogSkRC\nQyBxdWVyeSBpbXBsZW1lbnRhdGlvbi4KICoKICogQGF1dGhvciBBYmUgV2hp\ndGUKICogQG5vamF2YWRvYwogKi8KcHVibGljIGNsYXNzIEpEQkNTdG9yZVF1\nZXJ5IAogICAgZXh0ZW5kcyBFeHByZXNzaW9uU3RvcmVRdWVyeSB7CgogICAg\ncHJpdmF0ZSBzdGF0aWMgZmluYWwgVGFibGUgSU5WQUxJRCA9IG5ldyBUYWJs\nZSgpOwoKICAgIC8vIGFkZCBhbGwgc3RhbmRhcmQgZmlsdGVyIGFuZCBhZ2dy\nZWdhdGUgbGlzdGVuZXJzIHRvIHRoZXNlIG1hcHMKICAgIHByaXZhdGUgc3Rh\ndGljIGZpbmFsIE1hcCBfbGlzdGVuZXJzID0gbmV3IEhhc2hNYXAoKTsKCiAg\nICBzdGF0aWMgewogICAgICAgIC8vIGRlcHJlY2F0ZWQgZXh0ZW5zaW9ucwog\nICAgICAgIF9saXN0ZW5lcnMucHV0KEpEQkNTdHJpbmdDb250YWlucy5UQUcs\nIG5ldyBKREJDU3RyaW5nQ29udGFpbnMoKSk7CiAgICAgICAgX2xpc3RlbmVy\ncy5wdXQoSkRCQ1dpbGRjYXJkTWF0Y2guVEFHLCBuZXcgSkRCQ1dpbGRjYXJk\nTWF0Y2goKSk7CiAgICAgICAgX2xpc3RlbmVycy5wdXQoU1FMRXhwcmVzc2lv\nbi5UQUcsIG5ldyBTUUxFeHByZXNzaW9uKCkpOwogICAgICAgIF9saXN0ZW5l\ncnMucHV0KFNRTFZhbHVlLlRBRywgbmV3IFNRTFZhbHVlKCkpOwoKICAgICAg\nICAvLyBqZGJjLXNwZWNpZmljIGV4dGVuc2lvbnMKICAgICAgICBfbGlzdGVu\nZXJzLnB1dChHZXRDb2x1bW4uVEFHLCBuZXcgR2V0Q29sdW1uKCkpOwogICAg\nICAgIF9saXN0ZW5lcnMucHV0KFNRTEVtYmVkLlRBRywgbmV3IFNRTEVtYmVk\nKCkpOwogICAgfQoKICAgIHByaXZhdGUgZmluYWwgdHJhbnNpZW50IEpEQkNT\ndG9yZSBfc3RvcmU7CgogICAgLyoqCiAgICAgKiBDb25zdHJ1Y3Rvci4gU3Vw\ncGx5IHN0b3JlIG1hbmFnZXIuCiAgICAgKi8KICAgIHB1YmxpYyBKREJDU3Rv\ncmVRdWVyeShKREJDU3RvcmUgc3RvcmUsIEV4cHJlc3Npb25QYXJzZXIgcGFy\nc2VyKSB7CiAgICAgICAgc3VwZXIocGFyc2VyKTsKICAgICAgICBfc3RvcmUg\nPSBzdG9yZTsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgc3Rv\ncmUuCiAgICAgKi8KICAgIHB1YmxpYyBKREJDU3RvcmUgZ2V0U3RvcmUoKSB7\nCiAgICAgICAgcmV0dXJuIF9zdG9yZTsKICAgIH0KCiAgICBwdWJsaWMgRmls\ndGVyTGlzdGVuZXIgZ2V0RmlsdGVyTGlzdGVuZXIoU3RyaW5nIHRhZykgewog\nICAgICAgIHJldHVybiAoRmlsdGVyTGlzdGVuZXIpIF9saXN0ZW5lcnMuZ2V0\nKHRhZyk7CiAgICB9CgogICAgcHVibGljIE9iamVjdCBuZXdDb21waWxhdGlv\nbktleSgpIHsKICAgICAgICBKREJDRmV0Y2hDb25maWd1cmF0aW9uIGZldGNo\nID0gKEpEQkNGZXRjaENvbmZpZ3VyYXRpb24pIGN0eAogICAgICAgICAgICAu\nZ2V0RmV0Y2hDb25maWd1cmF0aW9uKCk7CiAgICAgICAgcmV0dXJuIE51bWJl\ncnMudmFsdWVPZihmZXRjaC5nZXRKb2luU3ludGF4KCkpOwogICAgfQoKICAg\nIHB1YmxpYyBib29sZWFuIHN1cHBvcnRzRGF0YVN0b3JlRXhlY3V0aW9uKCkg\newogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIHByb3RlY3RlZCBD\nbGFzc01ldGFEYXRhW10gZ2V0SW5kZXBlbmRlbnRFeHByZXNzaW9uQ2FuZGlk\nYXRlcygKICAgICAgICBDbGFzc01ldGFEYXRhIG1ldGEsIGJvb2xlYW4gc3Vi\nY2xhc3NlcykgewogICAgICAgIGlmICghc3ViY2xhc3NlcykKICAgICAgICAg\nICAgcmV0dXJuIG5ldyBDbGFzc01hcHBpbmdbXSB7IChDbGFzc01hcHBpbmcp\nIG1ldGEgfTsKICAgICAgICByZXR1cm4gKChDbGFzc01hcHBpbmcpIG1ldGEp\nLmdldEluZGVwZW5kZW50QXNzaWduYWJsZU1hcHBpbmdzKCk7CiAgICB9Cgog\nICAgcHJvdGVjdGVkIEV4cHJlc3Npb25GYWN0b3J5IGdldEV4cHJlc3Npb25G\nYWN0b3J5KENsYXNzTWV0YURhdGEgbWV0YSkgewogICAgICAgIHJldHVybiBu\nZXcgSkRCQ0V4cHJlc3Npb25GYWN0b3J5KChDbGFzc01hcHBpbmcpIG1ldGEp\nOwogICAgfQoKICAgIHByb3RlY3RlZCBSZXN1bHRPYmplY3RQcm92aWRlciBl\neGVjdXRlUXVlcnkoRXhlY3V0b3IgZXgsCiAgICAgICAgQ2xhc3NNZXRhRGF0\nYSBiYXNlLCBDbGFzc01ldGFEYXRhW10gbWV0YXMsIGJvb2xlYW4gc3ViY2xh\nc3NlcywKICAgICAgICBFeHByZXNzaW9uRmFjdG9yeVtdIGZhY3RzLCBRdWVy\neUV4cHJlc3Npb25zW10gZXhwcywgT2JqZWN0W10gcGFyYW1zLAogICAgICAg\nIFJhbmdlIHJhbmdlKSB7CiAgICAgICAgaWYgKG1ldGFzLmxlbmd0aCA+IDEg\nJiYgZXhwc1swXS5pc0FnZ3JlZ2F0ZSgpKQogICAgICAgICAgICB0aHJvdyBu\nZXcgVXNlckV4Y2VwdGlvbihMb2NhbGl6ZXIuZm9yUGFja2FnZShKREJDU3Rv\ncmVRdWVyeS5jbGFzcykuCiAgICAgICAgICAgICAgICBnZXQoIm11bHQtbWFw\ncGluZy1hZ2dyZWdhdGUiLCBBcnJheXMuYXNMaXN0KG1ldGFzKSkpOwoKICAg\nICAgICBDbGFzc01hcHBpbmdbXSBtYXBwaW5ncyA9IChDbGFzc01hcHBpbmdb\nXSkgbWV0YXM7CiAgICAgICAgSkRCQ0ZldGNoQ29uZmlndXJhdGlvbiBmZXRj\naCA9IChKREJDRmV0Y2hDb25maWd1cmF0aW9uKSAKICAgICAgICAgICAgY3R4\nLmdldEZldGNoQ29uZmlndXJhdGlvbigpOwogICAgICAgIGlmIChleHBzWzBd\nLmZldGNoUGF0aHMgIT0gbnVsbCkgewogICAgICAgICAgICBmZXRjaC5hZGRG\naWVsZHMoQXJyYXlzLmFzTGlzdChleHBzWzBdLmZldGNoUGF0aHMpKTsKICAg\nICAgICAgICAgZmV0Y2guYWRkSm9pbnMoQXJyYXlzLmFzTGlzdChleHBzWzBd\nLmZldGNoUGF0aHMpKTsKICAgICAgICB9CiAgICAgICAgaWYgKGV4cHNbMF0u\nZmV0Y2hJbm5lclBhdGhzICE9IG51bGwpCiAgICAgICAgICAgIGZldGNoLmFk\nZEZldGNoSW5uZXJKb2lucyhBcnJheXMuYXNMaXN0KGV4cHNbMF0uZmV0Y2hJ\nbm5lclBhdGhzKSk7CgogICAgICAgIGludCBlYWdlciA9IGNhbGN1bGF0ZUVh\nZ2VyTW9kZShleHBzWzBdLCByYW5nZS5zdGFydCwgcmFuZ2UuZW5kKTsKICAg\nICAgICBpbnQgc3ViY2xhc3NNb2RlID0gZmV0Y2guZ2V0U3ViY2xhc3NGZXRj\naE1vZGUoKENsYXNzTWFwcGluZykgYmFzZSk7CiAgICAgICAgREJEaWN0aW9u\nYXJ5IGRpY3QgPSBfc3RvcmUuZ2V0REJEaWN0aW9uYXJ5KCk7CiAgICAgICAg\nbG9uZyBzdGFydCA9IChtYXBwaW5ncy5sZW5ndGggPT0gMSAmJiBkaWN0LnN1\ncHBvcnRzU2VsZWN0U3RhcnRJbmRleCkgCiAgICAgICAgICAgID8gcmFuZ2Uu\nc3RhcnQgOiAwTDsKICAgICAgICBsb25nIGVuZCA9IChkaWN0LnN1cHBvcnRz\nU2VsZWN0RW5kSW5kZXgpID8gcmFuZ2UuZW5kIDogTG9uZy5NQVhfVkFMVUU7\nCgogICAgICAgIFF1ZXJ5RXhwcmVzc2lvbnNTdGF0ZVtdIHN0YXRlcyA9IG5l\ndyBRdWVyeUV4cHJlc3Npb25zU3RhdGVbZXhwcy5sZW5ndGhdOwogICAgICAg\nIGZvciAoaW50IGkgPSAwOyBpIDwgc3RhdGVzLmxlbmd0aDsgaSsrKQogICAg\nICAgICAgICBzdGF0ZXNbaV0gPSBuZXcgUXVlcnlFeHByZXNzaW9uc1N0YXRl\nKCk7CiAgICAgICAgRXhwQ29udGV4dCBjdHggPSBuZXcgRXhwQ29udGV4dChf\nc3RvcmUsIHBhcmFtcywgZmV0Y2gpOwoKICAgICAgICAvLyBhZGQgc2VsZWN0\ncyB3aXRoIHBvcHVsYXRlIFdIRVJFIGNvbmRpdGlvbnMgdG8gbGlzdAogICAg\nICAgIExpc3Qgc2VscyA9IG5ldyBBcnJheUxpc3QobWFwcGluZ3MubGVuZ3Ro\nKTsKICAgICAgICBMaXN0IHNlbE1hcHBpbmdzID0gbmV3IEFycmF5TGlzdCht\nYXBwaW5ncy5sZW5ndGgpOwogICAgICAgIEJpdFNldCBzdWJjbGFzc0JpdHMg\nPSBuZXcgQml0U2V0KCk7CiAgICAgICAgQml0U2V0IG5leHRCaXRzID0gbmV3\nIEJpdFNldCgpOwogICAgICAgIGJvb2xlYW4gdW5pb25hYmxlID0gY3JlYXRl\nV2hlcmVTZWxlY3RzKHNlbHMsIG1hcHBpbmdzLCBzZWxNYXBwaW5ncywKICAg\nICAgICAgICAgc3ViY2xhc3Nlcywgc3ViY2xhc3NCaXRzLCBuZXh0Qml0cywg\nZmFjdHMsIGV4cHMsIHN0YXRlcywgY3R4LAogICAgICAgICAgICBzdWJjbGFz\nc01vZGUpCiAgICAgICAgICAgICYmIHN1YmNsYXNzTW9kZSA9PSBKREJDRmV0\nY2hDb25maWd1cmF0aW9uLkVBR0VSX0pPSU4KICAgICAgICAgICAgJiYgc3Rh\ncnQgPT0gMAogICAgICAgICAgICAmJiBlbmQgPT0gTG9uZy5NQVhfVkFMVUU7\nCgogICAgICAgIC8vIHdlIG1pZ2h0IHdhbnQgdG8gdXNlIGxycyBzZXR0aW5n\ncyBpZiB3ZSBjYW4ndCB1c2UgdGhlIHJhbmdlCiAgICAgICAgaWYgKHNlbHMu\nc2l6ZSgpID4gMSkKICAgICAgICAgICAgc3RhcnQgPSAwTDsKICAgICAgICBi\nb29sZWFuIGxycyA9IHJhbmdlLmxycyB8fCAoZmV0Y2guZ2V0RmV0Y2hCYXRj\naFNpemUoKSA+PSAwIAogICAgICAgICAgICAmJiAoc3RhcnQgIT0gcmFuZ2Uu\nc3RhcnQgfHwgZW5kICE9IHJhbmdlLmVuZCkpOwoKICAgICAgICBSZXN1bHRP\nYmplY3RQcm92aWRlcltdIHJvcHMgPSBudWxsOwogICAgICAgIFJlc3VsdE9i\namVjdFByb3ZpZGVyIHJvcCA9IG51bGw7CiAgICAgICAgaWYgKHVuaW9uYWJs\nZSkgewogICAgICAgICAgICBVbmlvbiB1bmlvbiA9IF9zdG9yZS5nZXRTUUxG\nYWN0b3J5KCkubmV3VW5pb24oCiAgICAgICAgICAgICAgICAoU2VsZWN0W10p\nIHNlbHMudG9BcnJheShuZXcgU2VsZWN0W3NlbHMuc2l6ZSgpXSkpOwogICAg\nICAgICAgICBCaXRTZXRbXSBwYWdlZCA9IHBvcHVsYXRlVW5pb24odW5pb24s\nIG1hcHBpbmdzLCBzdWJjbGFzc2VzLCBmYWN0cywKICAgICAgICAgICAgICAg\nIGV4cHMsIHN0YXRlcywgY3R4LCBscnMsIGVhZ2VyLCBzdGFydCwgZW5kKTsK\nICAgICAgICAgICAgdW5pb24uc2V0TFJTKGxycyk7CiAgICAgICAgICAgIHJv\ncCA9IGV4ZWN1dGVVbmlvbih1bmlvbiwgbWFwcGluZ3MsIGV4cHMsIHN0YXRl\ncywgY3R4LCBwYWdlZCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAg\naWYgKHNlbHMuc2l6ZSgpID4gMSkKICAgICAgICAgICAgICAgIHJvcHMgPSBu\nZXcgUmVzdWx0T2JqZWN0UHJvdmlkZXJbc2Vscy5zaXplKCldOwoKICAgICAg\nICAgICAgU2VsZWN0IHNlbDsKICAgICAgICAgICAgQml0U2V0IHBhZ2VkOwog\nICAgICAgICAgICBmb3IgKGludCBpID0gMCwgaWR4ID0gMDsgaSA8IHNlbHMu\nc2l6ZSgpOyBpKyspIHsKICAgICAgICAgICAgICAgIHNlbCA9IChTZWxlY3Qp\nIHNlbHMuZ2V0KGkpOwogICAgICAgICAgICAgICAgcGFnZWQgPSBwb3B1bGF0\nZVNlbGVjdChzZWwsIChDbGFzc01hcHBpbmcpIHNlbE1hcHBpbmdzLmdldChp\nKSwKICAgICAgICAgICAgICAgICAgICBzdWJjbGFzc0JpdHMuZ2V0KGkpLCAo\nSkRCQ0V4cHJlc3Npb25GYWN0b3J5KSBmYWN0c1tpZHhdLAogICAgICAgICAg\nICAgICAgICAgIGV4cHNbaWR4XSwgc3RhdGVzW2lkeF0sIGN0eCwgbHJzLCBl\nYWdlciwgc3RhcnQsIGVuZCk7CgogICAgICAgICAgICAgICAgcm9wID0gZXhl\nY3V0ZVNlbGVjdChzZWwsIChDbGFzc01hcHBpbmcpIHNlbE1hcHBpbmdzLmdl\ndChpKSwKICAgICAgICAgICAgICAgICAgICBleHBzW2lkeF0sIHN0YXRlc1tp\nZHhdLCBjdHgsIHBhZ2VkLCBzdGFydCwgZW5kKTsKICAgICAgICAgICAgICAg\nIGlmIChyb3BzICE9IG51bGwpCiAgICAgICAgICAgICAgICAgICAgcm9wc1tp\nXSA9IHJvcDsKCiAgICAgICAgICAgICAgICBpZiAobmV4dEJpdHMuZ2V0KGkp\nKQogICAgICAgICAgICAgICAgICAgIGlkeCsrOwogICAgICAgICAgICB9CiAg\nICAgICAgfQoKICAgICAgICBpZiAocm9wcyAhPSBudWxsKSB7CiAgICAgICAg\nICAgIGlmIChleHBzWzBdLmFzY2VuZGluZy5sZW5ndGggPT0gMCkKICAgICAg\nICAgICAgICAgIHJvcCA9IG5ldyBNZXJnZWRSZXN1bHRPYmplY3RQcm92aWRl\ncihyb3BzKTsKICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICBy\nb3AgPSBuZXcgT3JkZXJpbmdNZXJnZWRSZXN1bHRPYmplY3RQcm92aWRlcihy\nb3BzLAogICAgICAgICAgICAgICAgICAgIGV4cHNbMF0uYXNjZW5kaW5nLCBl\neCwgdGhpcywgcGFyYW1zKTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAg\nICAgICAgLy8gbmVlZCB0byBmYWtlIHJlc3VsdCByYW5nZT8KICAgICAgICBp\nZiAoKHJvcHMgIT0gbnVsbCAmJiByYW5nZS5lbmQgIT0gTG9uZy5NQVhfVkFM\nVUUpIAogICAgICAgICAgICB8fCBzdGFydCAhPSByYW5nZS5zdGFydCB8fCBl\nbmQgIT0gcmFuZ2UuZW5kKQogICAgICAgICAgICByb3AgPSBuZXcgUmFuZ2VS\nZXN1bHRPYmplY3RQcm92aWRlcihyb3AsIHJhbmdlLnN0YXJ0LCByYW5nZS5l\nbmQpOwogICAgICAgIHJldHVybiByb3A7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBTZWxlY3QgZGF0YSBmb3IgdGhlIGdpdmVuIHVuaW9uLCByZXR1cm5pbmcg\ncGFnZWQgZmllbGRzLgogICAgICovCiAgICBwcml2YXRlIEJpdFNldFtdIHBv\ncHVsYXRlVW5pb24oVW5pb24gdW5pb24sIGZpbmFsIENsYXNzTWFwcGluZ1td\nIG1hcHBpbmdzLAogICAgICAgIGZpbmFsIGJvb2xlYW4gc3ViY2xhc3Nlcywg\nZmluYWwgRXhwcmVzc2lvbkZhY3RvcnlbXSBmYWN0cywKICAgICAgICBmaW5h\nbCBRdWVyeUV4cHJlc3Npb25zW10gZXhwcywgZmluYWwgUXVlcnlFeHByZXNz\naW9uc1N0YXRlW10gc3RhdGVzLAogICAgICAgIGZpbmFsIEV4cENvbnRleHQg\nY3R4LCBmaW5hbCBib29sZWFuIGxycywgZmluYWwgaW50IGVhZ2VyLAogICAg\nICAgIGZpbmFsIGxvbmcgc3RhcnQsIGZpbmFsIGxvbmcgZW5kKSB7CiAgICAg\nICAgZmluYWwgQml0U2V0W10gcGFnZWQgPSAoZXhwc1swXS5wcm9qZWN0aW9u\ncy5sZW5ndGggPiAwKSA/IG51bGwKICAgICAgICAgICAgOiBuZXcgQml0U2V0\nW21hcHBpbmdzLmxlbmd0aF07CiAgICAgICAgdW5pb24uc2VsZWN0KG5ldyBV\nbmlvbi5TZWxlY3RvcigpIHsKICAgICAgICAgICAgcHVibGljIHZvaWQgc2Vs\nZWN0KFNlbGVjdCBzZWwsIGludCBpZHgpIHsKICAgICAgICAgICAgICAgIEJp\ndFNldCBiaXRzID0gcG9wdWxhdGVTZWxlY3Qoc2VsLCBtYXBwaW5nc1tpZHhd\nLCBzdWJjbGFzc2VzLAogICAgICAgICAgICAgICAgICAgIChKREJDRXhwcmVz\nc2lvbkZhY3RvcnkpIGZhY3RzW2lkeF0sIGV4cHNbaWR4XSwgc3RhdGVzW2lk\neF0sCiAgICAgICAgICAgICAgICAgICAgY3R4LCAgbHJzLCBlYWdlciwgc3Rh\ncnQsIGVuZCk7CiAgICAgICAgICAgICAgICBpZiAocGFnZWQgIT0gbnVsbCkK\nICAgICAgICAgICAgICAgICAgICBwYWdlZFtpZHhdID0gYml0czsKICAgICAg\nICAgICAgfQogICAgICAgIH0pOwogICAgICAgIHJldHVybiBwYWdlZDsKICAg\nIH0KCiAgICAvKioKICAgICAqIFNlbGVjdCBkYXRhIGZvciB0aGUgZ2l2ZW4g\nc2VsZWN0LCByZXR1cm5pbmcgcGFnZWQgZmllbGRzLgogICAgICovCiAgICBw\ncml2YXRlIEJpdFNldCBwb3B1bGF0ZVNlbGVjdChTZWxlY3Qgc2VsLCBDbGFz\nc01hcHBpbmcgbWFwcGluZywKICAgICAgICBib29sZWFuIHN1YmNsYXNzZXMs\nIEpEQkNFeHByZXNzaW9uRmFjdG9yeSBmYWN0LCBRdWVyeUV4cHJlc3Npb25z\nIGV4cHMsCiAgICAgICAgUXVlcnlFeHByZXNzaW9uc1N0YXRlIHN0YXRlLCBF\neHBDb250ZXh0IGN0eCwgYm9vbGVhbiBscnMsIGludCBlYWdlciwKICAgICAg\nICBsb25nIHN0YXJ0LCBsb25nIGVuZCkgewogICAgICAgIHNlbC5zZXRMUlMo\nbHJzKTsKICAgICAgICBzZWwuc2V0UmFuZ2Uoc3RhcnQsIGVuZCk7CgogICAg\nICAgIEJpdFNldCBwYWdlZCA9IG51bGw7CiAgICAgICAgaWYgKGV4cHMucHJv\namVjdGlvbnMubGVuZ3RoID09IDApIHsKICAgICAgICAgICAgcGFnZWQgPSBQ\nYWdpbmdSZXN1bHRPYmplY3RQcm92aWRlci5nZXRQYWdlZEZpZWxkcyhzZWws\nIG1hcHBpbmcsCiAgICAgICAgICAgICAgICBfc3RvcmUsIGN0eC5mZXRjaCwg\nZWFnZXIsIGVuZCAtIHN0YXJ0KTsKICAgICAgICAgICAgaWYgKHBhZ2VkICE9\nIG51bGwpCiAgICAgICAgICAgICAgICBlYWdlciA9IEpEQkNGZXRjaENvbmZp\nZ3VyYXRpb24uRUFHRVJfSk9JTjsKICAgICAgICB9CgogICAgICAgIGZhY3Qu\nZ2V0U2VsZWN0Q29uc3RydWN0b3IoKS5zZWxlY3Qoc2VsLCBjdHgsIG1hcHBp\nbmcsIHN1YmNsYXNzZXMsIGV4cHMsCiAgICAgICAgICAgIHN0YXRlLCBlYWdl\ncik7CiAgICAgICAgcmV0dXJuIHBhZ2VkOwogICAgfQoKICAgIC8qKgogICAg\nICogRXhlY3V0ZSB0aGUgZ2l2ZW4gdW5pb24uCiAgICAgKi8KICAgIHByaXZh\ndGUgUmVzdWx0T2JqZWN0UHJvdmlkZXIgZXhlY3V0ZVVuaW9uKFVuaW9uIHVu\naW9uLAogICAgICAgIENsYXNzTWFwcGluZ1tdIG1hcHBpbmdzLCBRdWVyeUV4\ncHJlc3Npb25zW10gZXhwcywgCiAgICAgICAgUXVlcnlFeHByZXNzaW9uc1N0\nYXRlW10gc3RhdGVzLCBFeHBDb250ZXh0IGN0eCwgQml0U2V0W10gcGFnZWQp\nIHsKICAgICAgICBpZiAoZXhwc1swXS5wcm9qZWN0aW9ucy5sZW5ndGggPiAw\nKQogICAgICAgICAgICByZXR1cm4gbmV3IFByb2plY3Rpb25SZXN1bHRPYmpl\nY3RQcm92aWRlcih1bmlvbiwgZXhwcywgc3RhdGVzLCBjdHgpOwoKICAgICAg\nICBpZiAocGFnZWQgIT0gbnVsbCkKICAgICAgICAgICAgZm9yIChpbnQgaSA9\nIDA7IGkgPCBwYWdlZC5sZW5ndGg7IGkrKykKICAgICAgICAgICAgICAgIGlm\nIChwYWdlZFtpXSAhPSBudWxsKQogICAgICAgICAgICAgICAgICAgIHJldHVy\nbiBuZXcgUGFnaW5nUmVzdWx0T2JqZWN0UHJvdmlkZXIodW5pb24sIG1hcHBp\nbmdzLAogICAgICAgICAgICAgICAgICAgICAgICBfc3RvcmUsIGN0eC5mZXRj\naCwgcGFnZWQsIExvbmcuTUFYX1ZBTFVFKTsKCiAgICAgICAgcmV0dXJuIG5l\ndyBJbnN0YW5jZVJlc3VsdE9iamVjdFByb3ZpZGVyKHVuaW9uLCBtYXBwaW5n\nc1swXSwgX3N0b3JlLAogICAgICAgICAgICBjdHguZmV0Y2gpOwogICAgfQoK\nICAgIC8qKgogICAgICogRXhlY3V0ZSB0aGUgZ2l2ZW4gc2VsZWN0LgogICAg\nICovCiAgICBwcml2YXRlIFJlc3VsdE9iamVjdFByb3ZpZGVyIGV4ZWN1dGVT\nZWxlY3QoU2VsZWN0IHNlbCwgQ2xhc3NNYXBwaW5nIG1hcHBpbmcsCiAgICAg\nICAgUXVlcnlFeHByZXNzaW9ucyBleHBzLCBRdWVyeUV4cHJlc3Npb25zU3Rh\ndGUgc3RhdGUsIEV4cENvbnRleHQgY3R4LCAKICAgICAgICBCaXRTZXQgcGFn\nZWQsIGxvbmcgc3RhcnQsIGxvbmcgZW5kKSB7CiAgICAgICAgaWYgKGV4cHMu\ncHJvamVjdGlvbnMubGVuZ3RoID4gMCkKICAgICAgICAgICAgcmV0dXJuIG5l\ndyBQcm9qZWN0aW9uUmVzdWx0T2JqZWN0UHJvdmlkZXIoc2VsLCBleHBzLCBz\ndGF0ZSwgY3R4KTsKICAgICAgICBpZiAocGFnZWQgIT0gbnVsbCkKICAgICAg\nICAgICAgcmV0dXJuIG5ldyBQYWdpbmdSZXN1bHRPYmplY3RQcm92aWRlcihz\nZWwsIG1hcHBpbmcsIF9zdG9yZSwgCiAgICAgICAgICAgICAgICBjdHguZmV0\nY2gsIHBhZ2VkLCBlbmQgLSBzdGFydCk7CiAgICAgICAgcmV0dXJuIG5ldyBJ\nbnN0YW5jZVJlc3VsdE9iamVjdFByb3ZpZGVyKHNlbCwgbWFwcGluZywgX3N0\nb3JlLCAKICAgICAgICAgICAgY3R4LmZldGNoKTsKICAgIH0KCiAgICAvKioK\nICAgICAqIEdlbmVyYXRlIHRoZSBzZWxlY3RzIHdpdGggV0hFUkUgY29uZGl0\naW9ucyBuZWVkZWQgdG8gZXhlY3V0ZSB0aGUgcXVlcnkKICAgICAqIGZvciB0\naGUgZ2l2ZW4gbWFwcGluZ3MuCiAgICAgKi8KICAgIHByaXZhdGUgYm9vbGVh\nbiBjcmVhdGVXaGVyZVNlbGVjdHMoTGlzdCBzZWxzLCBDbGFzc01hcHBpbmdb\nXSBtYXBwaW5ncywKICAgICAgICBMaXN0IHNlbE1hcHBpbmdzLCBib29sZWFu\nIHN1YmNsYXNzZXMsIEJpdFNldCBzdWJjbGFzc0JpdHMsCiAgICAgICAgQml0\nU2V0IG5leHRCaXRzLCBFeHByZXNzaW9uRmFjdG9yeVtdIGZhY3RzLCBRdWVy\neUV4cHJlc3Npb25zW10gZXhwcywKICAgICAgICBRdWVyeUV4cHJlc3Npb25z\nU3RhdGVbXSBzdGF0ZXMsIEV4cENvbnRleHQgY3R4LCBpbnQgc3ViY2xhc3NN\nb2RlKSB7CiAgICAgICAgTnVtYmVyIG9wdEhpbnQgPSAoTnVtYmVyKSBjdHgu\nZmV0Y2guZ2V0SGludAogICAgICAgICAgICAoUXVlcnlIaW50cy5ISU5UX1JF\nU1VMVF9DT1VOVCk7CiAgICAgICAgQ2xhc3NNYXBwaW5nW10gdmVydHM7CiAg\nICAgICAgYm9vbGVhbiB1bmlvbmFibGUgPSB0cnVlOwogICAgICAgIFNlbGVj\ndCBzZWw7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBtYXBwaW5ncy5s\nZW5ndGg7IGkrKykgewogICAgICAgICAgICAvLyBkZXRlcm1pbmUgdmVydGlj\nYWwgbWFwcGluZ3MgdG8gc2VsZWN0IHNlcGFyYXRlbHkKICAgICAgICAgICAg\ndmVydHMgPSBnZXRWZXJ0aWNhbE1hcHBpbmdzKG1hcHBpbmdzW2ldLCBzdWJj\nbGFzc2VzLCBleHBzW2ldLAogICAgICAgICAgICAgICAgc3ViY2xhc3NNb2Rl\nKTsKICAgICAgICAgICAgaWYgKHZlcnRzLmxlbmd0aCA9PSAxICYmIHN1YmNs\nYXNzZXMpCiAgICAgICAgICAgICAgICBzdWJjbGFzc0JpdHMuc2V0KHNlbHMu\nc2l6ZSgpKTsKCiAgICAgICAgICAgIC8vIGNyZWF0ZSBjcml0ZXJpYSBzZWxl\nY3QgYW5kIGNsb25lIGZvciBlYWNoIHZlcnQgbWFwcGluZwogICAgICAgICAg\nICBzZWwgPSAoKEpEQkNFeHByZXNzaW9uRmFjdG9yeSkgZmFjdHNbaV0pLmdl\ndFNlbGVjdENvbnN0cnVjdG9yKCkuCiAgICAgICAgICAgICAgICBldmFsdWF0\nZShjdHgsIG51bGwsIG51bGwsIGV4cHNbaV0sIHN0YXRlc1tpXSk7CiAgICAg\nICAgICAgIGlmIChvcHRIaW50ICE9IG51bGwpCiAgICAgICAgICAgICAgIHNl\nbC5zZXRFeHBlY3RlZFJlc3VsdENvdW50KG9wdEhpbnQuaW50VmFsdWUoKSwg\ndHJ1ZSk7CiAgICAgICAgICAgIGVsc2UgaWYgKHRoaXMuY3R4LmlzVW5pcXVl\nKCkpCiAgICAgICAgICAgICAgICBzZWwuc2V0RXhwZWN0ZWRSZXN1bHRDb3Vu\ndCgxLCBmYWxzZSk7CiAgICAgICAgICAgIGZvciAoaW50IGogPSAwOyBqIDwg\ndmVydHMubGVuZ3RoOyBqKyspIHsKICAgICAgICAgICAgICAgIHNlbE1hcHBp\nbmdzLmFkZCh2ZXJ0c1tqXSk7CiAgICAgICAgICAgICAgICBpZiAoaiA9PSB2\nZXJ0cy5sZW5ndGggLSAxKSB7CiAgICAgICAgICAgICAgICAgICAgbmV4dEJp\ndHMuc2V0KHNlbHMuc2l6ZSgpKTsKICAgICAgICAgICAgICAgICAgICBzZWxz\nLmFkZChzZWwpOwogICAgICAgICAgICAgICAgfSBlbHNlCiAgICAgICAgICAg\nICAgICAgICAgc2Vscy5hZGQoc2VsLmZ1bGxDbG9uZSgxKSk7CiAgICAgICAg\nICAgIH0KCiAgICAgICAgICAgIC8vIHR1cm4gb2ZmIHVuaW9uaW5nIGlmIGEg\nZ2l2ZW4gaW5kZXBlbmRlbnQgbWFwcGluZyByZXF1aXJlcwogICAgICAgICAg\nICAvLyBtdWx0aXBsZSBzZWxlY3RzLCBvciBpZiB3ZSdyZSB1c2luZyBGUk9N\nIHNlbGVjdHMKICAgICAgICAgICAgaWYgKHZlcnRzLmxlbmd0aCA+IDEgfHwg\nc2VsLmdldEZyb21TZWxlY3QoKSAhPSBudWxsKQogICAgICAgICAgICAgICAg\ndW5pb25hYmxlID0gZmFsc2U7CiAgICAgICAgfQogICAgICAgIHJldHVybiB1\nbmlvbmFibGU7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gYWxsIHRo\nZSB2ZXJ0aWNhbCBtYXBwaW5ncyB0byBzZWxlY3Qgc2VwYXJhdGVseS4gRGVw\nZW5kcyBvbgogICAgICogc3ViY2xhc3MgZmV0Y2ggbW9kZSBhbmQgdGhlIHR5\ncGUgb2YgcXVlcnkuCiAgICAgKi8KICAgIHByaXZhdGUgQ2xhc3NNYXBwaW5n\nW10gZ2V0VmVydGljYWxNYXBwaW5ncyhDbGFzc01hcHBpbmcgbWFwcGluZywK\nICAgICAgICBib29sZWFuIHN1YmNsYXNzZXMsIFF1ZXJ5RXhwcmVzc2lvbnMg\nZXhwcywgaW50IHN1YmNsYXNzTW9kZSkgewogICAgICAgIGlmICghc3ViY2xh\nc3NlcyB8fCBleHBzLnByb2plY3Rpb25zLmxlbmd0aCA+IDApCiAgICAgICAg\nICAgIHJldHVybiBuZXcgQ2xhc3NNYXBwaW5nW10geyBtYXBwaW5nIH07Cgog\nICAgICAgIGlmIChzdWJjbGFzc01vZGUgIT0gSkRCQ0ZldGNoQ29uZmlndXJh\ndGlvbi5FQUdFUl9QQVJBTExFTAogICAgICAgICAgICB8fCAhaGFzVmVydGlj\nYWxTdWJjbGFzc2VzKG1hcHBpbmcpKQogICAgICAgICAgICByZXR1cm4gbmV3\nIENsYXNzTWFwcGluZ1tdIHsgbWFwcGluZyB9OwoKICAgICAgICBMaXN0IHN1\nYnMgPSBuZXcgQXJyYXlMaXN0KDQpOwogICAgICAgIGFkZFN1YmNsYXNzZXMo\nbWFwcGluZywgc3Vicyk7CiAgICAgICAgcmV0dXJuIChDbGFzc01hcHBpbmdb\nXSkgc3Vicy50b0FycmF5KG5ldyBDbGFzc01hcHBpbmdbc3Vicy5zaXplKCld\nKTsKICAgIH0KCiAgICAvKioKICAgICAqIFJlY3Vyc2l2ZSBoZWxwZXIgdG8g\nYWRkIG1hcHBpbmdzIGZvciBzdWJjbGFzc2VzIHRvIHRoZSBnaXZlbiBsaXN0\nLgogICAgICovCiAgICBwcml2YXRlIHZvaWQgYWRkU3ViY2xhc3NlcyhDbGFz\nc01hcHBpbmcgbWFwcGluZywgQ29sbGVjdGlvbiBzdWJzKSB7CiAgICAgICAg\nLy8gcG9zc2libGUgZnV0dXJlIG9wdGltaXphdGlvbnM6CiAgICAgICAgLy8g\nLSBpZiBubyBmaWVsZHMgaW4gbWV0YSBvciBpdHMgc3ViY2xhc3NlcyAoYW5k\nIG5vdCBpbiBhbgogICAgICAgIC8vICAgYWxyZWFkeS1zZWxlY3RlZCB0YWJs\nZSkgYXJlIGluIHRoZSBjdXJyZW50IGZldGNoCiAgICAgICAgLy8gICBjb25m\naWd1cmF0aW9uLCBzdG9wIGNyZWF0aW5nIG5ldyBleGVjdXRvcnMKICAgICAg\nICAvLyAtIGFsbG93IGFuIGV4ZWN1dG9yIHRvIHNlbGVjdCBhIHJhbmdlIG9m\nIHN1YmNsYXNzZXMsIHJhdGhlcgogICAgICAgIC8vICAgdGhhbiBqdXN0IGFs\nbCBzdWJjbGFzc2VzIC8gbm8gc3ViY2xhc3NlczsgdGhpcyB3b3VsZAogICAg\nICAgIC8vICAgYWxsb3cgdXMgdG8gZG8ganVzdCBvbmUgcXVlcnkgcGVyIGFj\ndHVhbCB2ZXJ0aWNhbGx5LW1hcHBlZAogICAgICAgIC8vICAgc3ViY2xhc3Ms\nIHJhdGhlciB0aGFuIG9uZSBwZXIgbWFwcGVkIHN1YmNsYXNzLCBhcyBpcyBo\nYXBwZW5pbmcgbm93CgogICAgICAgIHN1YnMuYWRkKG1hcHBpbmcpOwogICAg\nICAgIGlmICghaGFzVmVydGljYWxTdWJjbGFzc2VzKG1hcHBpbmcpKQogICAg\nICAgICAgICByZXR1cm47CgogICAgICAgIC8vIHJlY3Vyc2Ugb24gaW1tZWRp\nYXRlIHN1YmNsYXNzZXMKICAgICAgICBDbGFzc01hcHBpbmdbXSBzdWJNYXBw\naW5ncyA9IG1hcHBpbmcuZ2V0Sm9pbmFibGVQQ1N1YmNsYXNzTWFwcGluZ3Mo\nKTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IHN1Yk1hcHBpbmdzLmxl\nbmd0aDsgaSsrKQogICAgICAgICAgICBpZiAoc3ViTWFwcGluZ3NbaV0uZ2V0\nSm9pbmFibGVQQ1N1cGVyY2xhc3NNYXBwaW5nKCkgPT0gbWFwcGluZykKICAg\nICAgICAgICAgICAgIGFkZFN1YmNsYXNzZXMoc3ViTWFwcGluZ3NbaV0sIHN1\nYnMpOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHdoZXRoZXIgdGhl\nIGdpdmVuIGNsYXNzIGhhcyBhbnkgdmVydGljYWwgc3ViY2xhc3Nlcy4KICAg\nICAqLwogICAgcHJpdmF0ZSBzdGF0aWMgYm9vbGVhbiBoYXNWZXJ0aWNhbFN1\nYmNsYXNzZXMoQ2xhc3NNYXBwaW5nIG1hcHBpbmcpIHsKICAgICAgICBDbGFz\nc01hcHBpbmdbXSBzdWJzID0gbWFwcGluZy5nZXRKb2luYWJsZVBDU3ViY2xh\nc3NNYXBwaW5ncygpOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgc3Vi\ncy5sZW5ndGg7IGkrKykKICAgICAgICAgICAgaWYgKHN1YnNbaV0uZ2V0U3Ry\nYXRlZ3koKSBpbnN0YW5jZW9mIFZlcnRpY2FsQ2xhc3NTdHJhdGVneSkKICAg\nICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIHJldHVybiBmYWxz\nZTsKICAgIH0KCiAgICAvKioKICAgICAqIFRoZSBlYWdlciBtb2RlIGRlcGVu\nZHMgb24gdGhlIHVuaXF1ZSBzZXR0aW5nIGFuZCByYW5nZS4gSWYgdGhlIHJh\nbmdlCiAgICAgKiBwcm9kdWNlcyAwIHJlc3VsdHMsIHVzZSBlYWdlciBzZXR0\naW5nIG9mIG5vbmUuIElmIGl0IHByb2R1Y2VzIDEgcmVzdWx0CiAgICAgKiBv\nciB0aGUgcXVlcnkgaXMgdW5pcXVlLCB1c2UgYW4gZWFnZXIgc2V0dGluZyBv\nZiBzaW5nbGUuIE90aGVyd2lzZSB1c2UKICAgICAqIGFuIGVhZ2VyIG1vZGUg\nb2YgbXVsdGlwbGUuCiAgICAgKi8KICAgIHByaXZhdGUgaW50IGNhbGN1bGF0\nZUVhZ2VyTW9kZShRdWVyeUV4cHJlc3Npb25zIGV4cHMsIGxvbmcgc3RhcnQs\nCiAgICAgICAgbG9uZyBlbmQpIHsKICAgICAgICBpZiAoZXhwcy5wcm9qZWN0\naW9ucy5sZW5ndGggPiAwIHx8IHN0YXJ0ID49IGVuZCkKICAgICAgICAgICAg\ncmV0dXJuIEVhZ2VyRmV0Y2hNb2Rlcy5FQUdFUl9OT05FOwogICAgICAgIGlm\nIChlbmQgLSBzdGFydCA9PSAxIHx8IGN0eC5pc1VuaXF1ZSgpKQogICAgICAg\nICAgICByZXR1cm4gRWFnZXJGZXRjaE1vZGVzLkVBR0VSX0pPSU47CiAgICAg\nICAgcmV0dXJuIEVhZ2VyRmV0Y2hNb2Rlcy5FQUdFUl9QQVJBTExFTDsKICAg\nIH0KCiAgICBwcm90ZWN0ZWQgTnVtYmVyIGV4ZWN1dGVEZWxldGUoRXhlY3V0\nb3IgZXgsIENsYXNzTWV0YURhdGEgYmFzZSwKICAgICAgICBDbGFzc01ldGFE\nYXRhW10gbWV0YXMsIGJvb2xlYW4gc3ViY2xhc3NlcywgRXhwcmVzc2lvbkZh\nY3RvcnlbXSBmYWN0cywKICAgICAgICBRdWVyeUV4cHJlc3Npb25zW10gZXhw\ncywgT2JqZWN0W10gcGFyYW1zKSB7CiAgICAgICAgcmV0dXJuIGV4ZWN1dGVC\ndWxrT3BlcmF0aW9uKGV4LCBiYXNlLCBtZXRhcywgc3ViY2xhc3NlcywgZmFj\ndHMsIGV4cHMsCiAgICAgICAgICAgIHBhcmFtcywgbnVsbCk7CiAgICB9Cgog\nICAgcHJvdGVjdGVkIE51bWJlciBleGVjdXRlVXBkYXRlKEV4ZWN1dG9yIGV4\nLCBDbGFzc01ldGFEYXRhIGJhc2UsCiAgICAgICAgQ2xhc3NNZXRhRGF0YVtd\nIG1ldGFzLCBib29sZWFuIHN1YmNsYXNzZXMsIEV4cHJlc3Npb25GYWN0b3J5\nW10gZmFjdHMsCiAgICAgICAgUXVlcnlFeHByZXNzaW9uc1tdIGV4cHMsIE9i\namVjdFtdIHBhcmFtcykgewogICAgICAgIHJldHVybiBleGVjdXRlQnVsa09w\nZXJhdGlvbihleCwgYmFzZSwgbWV0YXMsIHN1YmNsYXNzZXMsIGZhY3RzLCBl\neHBzLAogICAgICAgICAgICBwYXJhbXMsIGV4cHNbMF0udXBkYXRlcyk7CiAg\nICB9CgogICAgcHJpdmF0ZSBOdW1iZXIgZXhlY3V0ZUJ1bGtPcGVyYXRpb24o\nRXhlY3V0b3IgZXgsIENsYXNzTWV0YURhdGEgYmFzZSwKICAgICAgICBDbGFz\nc01ldGFEYXRhW10gbWV0YXMsIGJvb2xlYW4gc3ViY2xhc3NlcywgRXhwcmVz\nc2lvbkZhY3RvcnlbXSBmYWN0cywKICAgICAgICBRdWVyeUV4cHJlc3Npb25z\nW10gZXhwcywgT2JqZWN0W10gcGFyYW1zLCBNYXAgdXBkYXRlcykgewogICAg\nICAgIC8vIHdlIGNhbm5vdCBleGVjdXRlIGEgYnVsayBkZWxldGUgc3RhdGVt\nZW50IHdoZW4gaGF2ZSBtYXBwaW5ncyBpbgogICAgICAgIC8vIG11bHRpcGxl\nIHRhYmxlcywgc28gaW5kaWNhdGUgd2Ugd2FudCB0byB1c2UgaW4tbWVtb3J5\nIHdpdGggbnVsbAogICAgICAgIENsYXNzTWFwcGluZ1tdIG1hcHBpbmdzID0g\nKENsYXNzTWFwcGluZ1tdKSBtZXRhczsKCiAgICAgICAgLy8gc3BlY2lmaWNh\ndGlvbiBvZiB0aGUgInVwZGF0ZXMiIG1hcCBpbmRpY2F0ZXMgdGhhdCB0aGlz\nIGlzCiAgICAgICAgLy8gYW4gdXBkYXRlIHF1ZXJ5OyBvdGhlcndpc2UsIHRo\naXMgaXMgYSBkZWxldGUgc3RhdGVtZW50CiAgICAgICAgYm9vbGVhbiBpc1Vw\nZGF0ZSA9IHVwZGF0ZXMgIT0gbnVsbCAmJiB1cGRhdGVzLnNpemUoKSA+IDA7\nCgogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgbWFwcGluZ3MubGVuZ3Ro\nOyBpKyspIHsKICAgICAgICAgICAgaWYgKCFpc1NpbmdsZVRhYmxlTWFwcGlu\nZyhtYXBwaW5nc1tpXSwgc3ViY2xhc3NlcykgJiYgIWlzVXBkYXRlKQogICAg\nICAgICAgICAgICAgcmV0dXJuIG51bGw7CgogICAgICAgICAgICBpZiAoIWlz\nVXBkYXRlKSB7CiAgICAgICAgICAgICAgICAvLyBpZiB0aGVyZSBhcmUgYW55\nIGRlbGV0ZSBjYWxsYmFja3MsIHdlIG5lZWQgdG8KICAgICAgICAgICAgICAg\nIC8vIGV4ZWN1dGUgaW4tbWVtb3J5IHNvIHRoZSBjYWxsYmFja3MgYXJlIGlu\ndm9rZWQKICAgICAgICAgICAgICAgIExpZmVjeWNsZUV2ZW50TWFuYWdlciBt\nZ3IgPSBjdHguZ2V0U3RvcmVDb250ZXh0KCkuZ2V0QnJva2VyKCkKICAgICAg\nICAgICAgICAgICAgICAuZ2V0TGlmZWN5Y2xlRXZlbnRNYW5hZ2VyKCk7CiAg\nICAgICAgICAgICAgICBpZiAobWdyLmhhc0RlbGV0ZUxpc3RlbmVycyhudWxs\nLCBtYXBwaW5nc1tpXSkpCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51\nbGw7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIEpEQkNGZXRj\naENvbmZpZ3VyYXRpb24gZmV0Y2ggPSAoSkRCQ0ZldGNoQ29uZmlndXJhdGlv\nbikgCiAgICAgICAgICAgIGN0eC5nZXRGZXRjaENvbmZpZ3VyYXRpb24oKTsK\nICAgICAgICBFeHBDb250ZXh0IGN0eCA9IG5ldyBFeHBDb250ZXh0KF9zdG9y\nZSwgcGFyYW1zLCBmZXRjaCk7CiAgICAgICAgREJEaWN0aW9uYXJ5IGRpY3Qg\nPSBfc3RvcmUuZ2V0REJEaWN0aW9uYXJ5KCk7CiAgICAgICAgUXVlcnlFeHBy\nZXNzaW9uc1N0YXRlW10gc3RhdGUgPSBuZXcgUXVlcnlFeHByZXNzaW9uc1N0\nYXRlW2V4cHMubGVuZ3RoXTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8\nIHN0YXRlLmxlbmd0aDsgaSsrKQogICAgICAgICAgICBzdGF0ZVtpXSA9IG5l\ndyBRdWVyeUV4cHJlc3Npb25zU3RhdGUoKTsKCiAgICAgICAgU1FMQnVmZmVy\nW10gc3FsID0gbmV3IFNRTEJ1ZmZlclttYXBwaW5ncy5sZW5ndGhdOwogICAg\nICAgIEpEQkNFeHByZXNzaW9uRmFjdG9yeSBqZGJjRmFjdG9yeTsKICAgICAg\nICBTZWxlY3Qgc2VsOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgbWFw\ncGluZ3MubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgamRiY0ZhY3Rvcnkg\nPSAoSkRCQ0V4cHJlc3Npb25GYWN0b3J5KSBmYWN0c1tpXTsKICAgICAgICAg\nICAgc2VsID0gamRiY0ZhY3RvcnkuZ2V0U2VsZWN0Q29uc3RydWN0b3IoKS5l\ndmFsdWF0ZShjdHgsIG51bGwsIG51bGwsCiAgICAgICAgICAgICAgICBleHBz\nW2ldLCBzdGF0ZVtpXSk7CiAgICAgICAgICAgIGpkYmNGYWN0b3J5LmdldFNl\nbGVjdENvbnN0cnVjdG9yKCkuc2VsZWN0KHNlbCwgY3R4LCBtYXBwaW5nc1tp\nXSwgCiAgICAgICAgICAgICAgICBzdWJjbGFzc2VzLCBleHBzW2ldLCBzdGF0\nZVtpXSwgCiAgICAgICAgICAgICAgICBKREJDRmV0Y2hDb25maWd1cmF0aW9u\nLkVBR0VSX05PTkUpOwoKICAgICAgICAgICAgLy8gVGhlIGJ1bGsgb3BlcmF0\naW9uIHdpbGwgcmV0dXJuIG51bGwgdG8gaW5kaWNhdGUgdGhhdCB0aGUgZGF0\nYWJhc2UKICAgICAgICAgICAgLy8gZG9lcyBub3Qgc3VwcG9ydCB0aGUgcmVx\ndWVzdCBidWxrIGRlbGV0ZSBvcGVyYXRpb247IGluCiAgICAgICAgICAgIC8v\nIHRoaXMgY2FzZSwgd2UgbmVlZCB0byBwZXJmb3JtIHRoZSBxdWVyeSBpbi1t\nZW1vcnkgYW5kCiAgICAgICAgICAgIC8vIG1hbnVhbGx5IGRlbGV0ZSB0aGUg\naW5zdGFuY2VzCiAgICAgICAgICAgIGlmICghaXNVcGRhdGUpCiAgICAgICAg\nICAgICAgICBzcWxbaV0gPSBkaWN0LnRvRGVsZXRlKG1hcHBpbmdzW2ldLCBz\nZWwsIHBhcmFtcyk7CiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAg\nIHNxbFtpXSA9IGRpY3QudG9VcGRhdGUobWFwcGluZ3NbaV0sIHNlbCwgX3N0\nb3JlLCBwYXJhbXMsCiAgICAgICAgICAgICAgICAgICAgdXBkYXRlcyk7Cgog\nICAgICAgICAgICBpZiAoc3FsW2ldID09IG51bGwpCiAgICAgICAgICAgICAg\nICByZXR1cm4gbnVsbDsKICAgICAgICB9CgogICAgICAgIC8vIHdlIG5lZWQg\ndG8gbWFrZSBzdXJlIHdlIGhhdmUgYW4gYWN0aXZlIHN0b3JlIGNvbm5lY3Rp\nb24KICAgICAgICBfc3RvcmUuZ2V0Q29udGV4dCgpLmJlZ2luU3RvcmUoKTsK\nCiAgICAgICAgQ29ubmVjdGlvbiBjb25uID0gX3N0b3JlLmdldENvbm5lY3Rp\nb24oKTsKICAgICAgICBsb25nIGNvdW50ID0gMDsKICAgICAgICB0cnkgewog\nICAgICAgICAgICBQcmVwYXJlZFN0YXRlbWVudCBzdG1udDsKICAgICAgICAg\nICAgZm9yIChpbnQgaSA9IDA7IGkgPCBzcWwubGVuZ3RoOyBpKyspIHsKICAg\nICAgICAgICAgICAgIHN0bW50ID0gbnVsbDsKICAgICAgICAgICAgICAgIHRy\neSB7CiAgICAgICAgICAgICAgICAgICAgc3RtbnQgPSBzcWxbaV0ucHJlcGFy\nZVN0YXRlbWVudChjb25uKTsKICAgICAgICAgICAgICAgICAgICBjb3VudCAr\nPSBzdG1udC5leGVjdXRlVXBkYXRlKCk7CiAgICAgICAgICAgICAgICB9IGZp\nbmFsbHkgewogICAgICAgICAgICAgICAgICAgIGlmIChzdG1udCAhPSBudWxs\nKQogICAgICAgICAgICAgICAgICAgICAgICB0cnkgeyBzdG1udC5jbG9zZSgp\nOyB9IGNhdGNoIChTUUxFeGNlcHRpb24gc2UpIHt9CiAgICAgICAgICAgICAg\nICB9CiAgICAgICAgICAgIH0KICAgICAgICB9IGNhdGNoIChTUUxFeGNlcHRp\nb24gc2UpIHsKICAgICAgICAgICAgdGhyb3cgU1FMRXhjZXB0aW9ucy5nZXRT\ndG9yZShzZSwgY3R4LCBfc3RvcmUuZ2V0REJEaWN0aW9uYXJ5KCkpOwogICAg\nICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgIHRyeSB7IGNvbm4uY2xvc2Uo\nKTsgfSBjYXRjaCAoU1FMRXhjZXB0aW9uIHNlKSB7fQogICAgICAgIH0KICAg\nICAgICByZXR1cm4gTnVtYmVycy52YWx1ZU9mKGNvdW50KTsKICAgIH0KCiAg\nICAvKioKICAgICAqIFdoZXRoZXIgdGhlIGdpdmVuIG1hcHBpbmcgb2NjdXBp\nZXMgb25seSBvbmUgdGFibGUuCiAgICAgKi8KICAgIHByaXZhdGUgYm9vbGVh\nbiBpc1NpbmdsZVRhYmxlTWFwcGluZyhDbGFzc01hcHBpbmcgbWFwcGluZywK\nICAgICAgICBib29sZWFuIHN1YmNsYXNzZXMpIHsKICAgICAgICBDbGFzc01h\ncHBpbmcgcm9vdCA9IG1hcHBpbmc7CiAgICAgICAgd2hpbGUgKHJvb3QuZ2V0\nSm9pbmFibGVQQ1N1cGVyY2xhc3NNYXBwaW5nKCkgIT0gbnVsbCkKICAgICAg\nICAgICAgcm9vdCA9IHJvb3QuZ2V0Sm9pbmFibGVQQ1N1cGVyY2xhc3NNYXBw\naW5nKCk7CiAgICAgICAgaWYgKGhhc1ZlcnRpY2FsU3ViY2xhc3Nlcyhyb290\nKSkKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoKICAgICAgICAvLyB3ZSBj\nYW5ub3QgZXhlY3V0ZSBhIGJ1bGsgZGVsZXRlIGlmIGFueSBvZiB0aGUKICAg\nICAgICAvLyBmaWVsZCBtYXBwaW5ncyBmb3IgdGhlIGNhbmRpZGF0ZXMgaGF2\nZSBjb2x1bW5zCiAgICAgICAgLy8gaW4gYW55IG90aGVyIHRhYmxlLCBzaW5j\nZSBidWxrIGRlbGV0aW5nIGp1c3QgZnJvbSB0aGUKICAgICAgICAvLyBjbGFz\ncyB3aWxsIGxlYXZlIGRhbmdsaW5nIHJlbGF0aW9uczsgd2UgbWlnaHQgYmUg\nYWJsZQogICAgICAgIC8vIHRvIGlzc3VlIGJ1bGsgZGVsZXRlcyBzZXBhcmF0\nZWx5IGZvciB0aGUgam9pbnMgKHBvc3NpYmx5CiAgICAgICAgLy8gdXNpbmcg\nYSB0ZW1wb3JhcnkgdGFibGUgdG8gc2VsZWN0IHRoZSBwcmltYXJ5IGtleXMg\nZm9yCiAgICAgICAgLy8gYWxsIHRoZSByZWxhdGVkIHRhYmxlcyBhbmQgdGhl\nbiBpc3NpbmcgYSBkZWxldGUgYWdhaW5zdCB0aG9zZQogICAgICAgIC8vIGtl\neXMpLCBidXQgdGhhdCBsb2dpYyBpcyBub3QgY3VycmVudGx5IGltcGxlbWVu\ndGVkCiAgICAgICAgVGFibGUgdGFibGUgPSBnZXRUYWJsZShtYXBwaW5nLmdl\ndEZpZWxkTWFwcGluZ3MoKSwgbnVsbCk7CiAgICAgICAgaWYgKHRhYmxlID09\nIElOVkFMSUQpCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCiAgICAgICAg\naWYgKHN1YmNsYXNzZXMpIHsKICAgICAgICAgICAgLy8gaWYgd2UgYXJlIGlu\nY2x1ZGluZyBzdWJjbGFzc2VzLCB3ZSBhbHNvIG5lZWQgdG8gZ2F0aGVyCiAg\nICAgICAgICAgIC8vIGFsbCB0aGUgbWFwcGluZ3MgZm9yIGFsbCBrbm93biBz\ndWJjbGFzc2VzCiAgICAgICAgICAgIENsYXNzTWFwcGluZ1tdIHN1YnMgPSBt\nYXBwaW5nLmdldEpvaW5hYmxlUENTdWJjbGFzc01hcHBpbmdzKCk7CiAgICAg\nICAgICAgIGZvciAoaW50IGkgPSAwOyBzdWJzICE9IG51bGwgJiYgaSA8IHN1\nYnMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICAgIHRhYmxlID0gZ2V0\nVGFibGUoc3Vic1tpXS5nZXREZWZpbmVkRmllbGRNYXBwaW5ncygpLCB0YWJs\nZSk7CiAgICAgICAgICAgICAgICBpZiAodGFibGUgPT0gSU5WQUxJRCkKICAg\nICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgIH0K\nICAgICAgICB9CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBSZXR1cm4gdGhlIHNpbmdsZSB0YWJsZSBmb3IgdGhlIGdpdmVu\nIGZpZWxkcywgb3IgSU5WQUxJRCBpZiB0aGV5CiAgICAgKiB1c2UgbXVsdGlw\nbGUgdGFibGVzLgogICAgICovCiAgICBwcml2YXRlIFRhYmxlIGdldFRhYmxl\nKEZpZWxkTWFwcGluZ1tdIGZpZWxkcywgVGFibGUgdGFibGUpIHsKICAgICAg\nICBmb3IgKGludCBpID0gMDsgaSA8IGZpZWxkcy5sZW5ndGg7IGkrKykgewog\nICAgICAgICAgICB0YWJsZSA9IGdldFRhYmxlKGZpZWxkc1tpXSwgdGFibGUp\nOwogICAgICAgICAgICBpZiAodGFibGUgPT0gSU5WQUxJRCkKICAgICAgICAg\nICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgICByZXR1cm4gdGFibGU7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIHRhYmxlIGZvciB0\naGUgZmllbGQgaWYgdGhlIGdpdmVuIHRhYmxlIGhhc24ndCBiZWVuIHNldAog\nICAgICogeWV0LCBvciBpZiB0aGUgdGFibGVzIG1hdGNoLiBJZiB0aGUgZmll\nbGQgdXNlcyBhIGRpZmZlcmVudCB0YWJsZSwKICAgICAqIHJldHVybnMgSU5W\nQUxJRC4gQWxzbyByZXR1cm5zIElOVkFMSUQgaWYgZmllbGQgaXMgZGVwZW5k\nZW50LgogICAgICovCiAgICBwcml2YXRlIFRhYmxlIGdldFRhYmxlKEZpZWxk\nTWFwcGluZyBmbSwgVGFibGUgdGFibGUpIHsKICAgICAgICBpZiAoZm0uZ2V0\nQ2FzY2FkZURlbGV0ZSgpICE9IFZhbHVlTWV0YURhdGEuQ0FTQ0FERV9OT05F\nKQogICAgICAgICAgICByZXR1cm4gSU5WQUxJRDsKCiAgICAgICAgQ29sdW1u\nW10gY29sdW1ucyA9IGZtLmdldENvbHVtbnMoKTsKICAgICAgICBmb3IgKGlu\ndCBpID0gMDsgY29sdW1ucyAhPSBudWxsICYmIGkgPCBjb2x1bW5zLmxlbmd0\naDsgaSsrKSB7CiAgICAgICAgICAgIGlmICh0YWJsZSA9PSBudWxsKQogICAg\nICAgICAgICAgICAgdGFibGUgPSBjb2x1bW5zW2ldLmdldFRhYmxlKCk7CiAg\nICAgICAgICAgIGVsc2UgaWYgKHRhYmxlICE9IGNvbHVtbnNbaV0uZ2V0VGFi\nbGUoKSkKICAgICAgICAgICAgICAgIHJldHVybiBJTlZBTElEOwogICAgICAg\nIH0KICAgICAgICByZXR1cm4gdGFibGU7CiAgICB9CgogICAgcHJvdGVjdGVk\nIE51bWJlciBleGVjdXRlVXBkYXRlKENsYXNzTWV0YURhdGEgYmFzZSwgQ2xh\nc3NNZXRhRGF0YVtdIG1ldGFzLAogICAgICAgIGJvb2xlYW4gc3ViY2xhc3Nl\ncywgRXhwcmVzc2lvbkZhY3RvcnlbXSBmYWN0cywKICAgICAgICBRdWVyeUV4\ncHJlc3Npb25zW10gcGFyc2VkLCBPYmplY3RbXSBwYXJhbXMpIHsKICAgICAg\nICByZXR1cm4gbnVsbDsKICAgIH0KCiAgICBwcm90ZWN0ZWQgU3RyaW5nW10g\nZ2V0RGF0YVN0b3JlQWN0aW9ucyhDbGFzc01ldGFEYXRhIGJhc2UsCiAgICAg\nICAgQ2xhc3NNZXRhRGF0YVtdIG1ldGFzLCBib29sZWFuIHN1YmNsYXNzZXMs\nIEV4cHJlc3Npb25GYWN0b3J5W10gZmFjdHMsCiAgICAgICAgUXVlcnlFeHBy\nZXNzaW9uc1tdIGV4cHMsIE9iamVjdFtdIHBhcmFtcywgUmFuZ2UgcmFuZ2Up\nIHsKICAgICAgICBDbGFzc01hcHBpbmdbXSBtYXBwaW5ncyA9IChDbGFzc01h\ncHBpbmdbXSkgbWV0YXM7CiAgICAgICAgSkRCQ0ZldGNoQ29uZmlndXJhdGlv\nbiBmZXRjaCA9IChKREJDRmV0Y2hDb25maWd1cmF0aW9uKSBjdHguCiAgICAg\nICAgICAgIGdldEZldGNoQ29uZmlndXJhdGlvbigpOwogICAgICAgIGlmIChl\neHBzWzBdLmZldGNoUGF0aHMgIT0gbnVsbCkgewogICAgICAgICAgICBmZXRj\naC5hZGRGaWVsZHMoQXJyYXlzLmFzTGlzdChleHBzWzBdLmZldGNoUGF0aHMp\nKTsKICAgICAgICAgICAgZmV0Y2guYWRkSm9pbnMoQXJyYXlzLmFzTGlzdChl\neHBzWzBdLmZldGNoUGF0aHMpKTsKICAgICAgICB9CiAgICAgICAgaWYgKGV4\ncHNbMF0uZmV0Y2hJbm5lclBhdGhzICE9IG51bGwpCiAgICAgICAgICAgIGZl\ndGNoLmFkZEZldGNoSW5uZXJKb2lucyhBcnJheXMuYXNMaXN0KGV4cHNbMF0u\nZmV0Y2hJbm5lclBhdGhzKSk7CgogICAgICAgIGludCBlYWdlciA9IGNhbGN1\nbGF0ZUVhZ2VyTW9kZShleHBzWzBdLCByYW5nZS5zdGFydCwgcmFuZ2UuZW5k\nKTsKICAgICAgICBlYWdlciA9IE1hdGgubWluKGVhZ2VyLCBKREJDRmV0Y2hD\nb25maWd1cmF0aW9uLkVBR0VSX0pPSU4pOwogICAgICAgIGludCBzdWJjbGFz\nc01vZGUgPSBmZXRjaC5nZXRTdWJjbGFzc0ZldGNoTW9kZSgoQ2xhc3NNYXBw\naW5nKSBiYXNlKTsKICAgICAgICBEQkRpY3Rpb25hcnkgZGljdCA9IF9zdG9y\nZS5nZXREQkRpY3Rpb25hcnkoKTsKICAgICAgICBsb25nIHN0YXJ0ID0gKG1h\ncHBpbmdzLmxlbmd0aCA9PSAxICYmIGRpY3Quc3VwcG9ydHNTZWxlY3RTdGFy\ndEluZGV4KSAKICAgICAgICAgICAgPyByYW5nZS5zdGFydCA6IDBMOwogICAg\nICAgIGxvbmcgZW5kID0gKGRpY3Quc3VwcG9ydHNTZWxlY3RFbmRJbmRleCkg\nPyByYW5nZS5lbmQgOiBMb25nLk1BWF9WQUxVRTsKCiAgICAgICAgUXVlcnlF\neHByZXNzaW9uc1N0YXRlW10gc3RhdGVzID0gbmV3IFF1ZXJ5RXhwcmVzc2lv\nbnNTdGF0ZVtleHBzLmxlbmd0aF07CiAgICAgICAgZm9yIChpbnQgaSA9IDA7\nIGkgPCBzdGF0ZXMubGVuZ3RoOyBpKyspCiAgICAgICAgICAgIHN0YXRlc1tp\nXSA9IG5ldyBRdWVyeUV4cHJlc3Npb25zU3RhdGUoKTsKICAgICAgICBFeHBD\nb250ZXh0IGN0eCA9IG5ldyBFeHBDb250ZXh0KF9zdG9yZSwgcGFyYW1zLCBm\nZXRjaCk7CgogICAgICAgIC8vIGFkZCBzZWxlY3RzIHdpdGggcG9wdWxhdGUg\nV0hFUkUgY29uZGl0aW9ucyB0byBsaXN0CiAgICAgICAgTGlzdCBzZWxzID0g\nbmV3IEFycmF5TGlzdChtYXBwaW5ncy5sZW5ndGgpOwogICAgICAgIExpc3Qg\nc2VsTWFwcGluZ3MgPSBuZXcgQXJyYXlMaXN0KG1hcHBpbmdzLmxlbmd0aCk7\nCiAgICAgICAgQml0U2V0IHN1YmNsYXNzQml0cyA9IG5ldyBCaXRTZXQoKTsK\nICAgICAgICBCaXRTZXQgbmV4dEJpdHMgPSBuZXcgQml0U2V0KCk7CiAgICAg\nICAgYm9vbGVhbiB1bmlvbmFibGUgPSBjcmVhdGVXaGVyZVNlbGVjdHMoc2Vs\ncywgbWFwcGluZ3MsIHNlbE1hcHBpbmdzLAogICAgICAgICAgICBzdWJjbGFz\nc2VzLCBzdWJjbGFzc0JpdHMsIG5leHRCaXRzLCBmYWN0cywgZXhwcywgc3Rh\ndGVzLCBjdHgsIAogICAgICAgICAgICBzdWJjbGFzc01vZGUpICYmIHN1YmNs\nYXNzTW9kZSA9PSBKREJDRmV0Y2hDb25maWd1cmF0aW9uLkVBR0VSX0pPSU47\nCiAgICAgICAgaWYgKHNlbHMuc2l6ZSgpID4gMSkKICAgICAgICAgICAgc3Rh\ncnQgPSAwTDsKCiAgICAgICAgaWYgKHVuaW9uYWJsZSkgewogICAgICAgICAg\nICBVbmlvbiB1bmlvbiA9IF9zdG9yZS5nZXRTUUxGYWN0b3J5KCkubmV3VW5p\nb24oCiAgICAgICAgICAgICAgICAoU2VsZWN0W10pIHNlbHMudG9BcnJheShu\nZXcgU2VsZWN0W3NlbHMuc2l6ZSgpXSkpOwogICAgICAgICAgICBwb3B1bGF0\nZVVuaW9uKHVuaW9uLCBtYXBwaW5ncywgc3ViY2xhc3NlcywgZmFjdHMsIGV4\ncHMsIHN0YXRlcywgY3R4LAogICAgICAgICAgICAgICAgZmFsc2UsIGVhZ2Vy\nLCBzdGFydCwgZW5kKTsKICAgICAgICAgICAgaWYgKHVuaW9uLmlzVW5pb24o\nKSkKICAgICAgICAgICAgICAgIHJldHVybiBuZXcgU3RyaW5nW10ge3VuaW9u\nLnRvU2VsZWN0KGZhbHNlLCBmZXRjaCkuZ2V0U1FMKHRydWUpfTsKICAgICAg\nICAgICAgc2VscyA9IEFycmF5cy5hc0xpc3QodW5pb24uZ2V0U2VsZWN0cygp\nKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBTZWxlY3Qgc2VsOwog\nICAgICAgICAgICBmb3IgKGludCBpID0gMCwgaWR4ID0gMDsgaSA8IHNlbHMu\nc2l6ZSgpOyBpKyspIHsKICAgICAgICAgICAgICAgIHNlbCA9IChTZWxlY3Qp\nIHNlbHMuZ2V0KGkpOwogICAgICAgICAgICAgICAgcG9wdWxhdGVTZWxlY3Qo\nc2VsLCAoQ2xhc3NNYXBwaW5nKSBzZWxNYXBwaW5ncy5nZXQoaSksCiAgICAg\nICAgICAgICAgICAgICAgc3ViY2xhc3NCaXRzLmdldChpKSwgKEpEQkNFeHBy\nZXNzaW9uRmFjdG9yeSkgZmFjdHNbaWR4XSwKICAgICAgICAgICAgICAgICAg\nICBleHBzW2lkeF0sIHN0YXRlc1tpZHhdLCBjdHgsIGZhbHNlLCBlYWdlciwg\nc3RhcnQsIGVuZCk7CiAgICAgICAgICAgICAgICBpZiAobmV4dEJpdHMuZ2V0\nKGkpKQogICAgICAgICAgICAgICAgICAgIGlkeCsrOwogICAgICAgICAgICB9\nCiAgICAgICAgfQoKICAgICAgICBTdHJpbmdbXSBzcWwgPSBuZXcgU3RyaW5n\nW3NlbHMuc2l6ZSgpXTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IHNl\nbHMuc2l6ZSgpOyBpKyspCiAgICAgICAgICAgIHNxbFtpXSA9ICgoU2VsZWN0\nKSBzZWxzLmdldChpKSkudG9TZWxlY3QoZmFsc2UsIGZldGNoKS5nZXRTUUwo\ndHJ1ZSk7CiAgICAgICAgcmV0dXJuIHNxbDsKICAgIH0KfQo=\n","encoding":"base64"}

