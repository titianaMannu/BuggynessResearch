{"sha":"0c16de678fb8826717af41d7f6c205bc68d0c99c","node_id":"MDQ6QmxvYjIwNjM2NDowYzE2ZGU2NzhmYjg4MjY3MTdhZjQxZDdmNmMyMDViYzY4ZDBjOTlj","size":12446,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/0c16de678fb8826717af41d7f6c205bc68d0c99c","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5rZXJuZWw7CgppbXBv\ncnQgamF2YS5pby5JT0V4Y2VwdGlvbjsKaW1wb3J0IGphdmEuaW8uU3RyZWFt\nVG9rZW5pemVyOwppbXBvcnQgamF2YS5pby5TdHJpbmdSZWFkZXI7CmltcG9y\ndCBqYXZhLnNxbC5Db25uZWN0aW9uOwppbXBvcnQgamF2YS5zcWwuUHJlcGFy\nZWRTdGF0ZW1lbnQ7CmltcG9ydCBqYXZhLnNxbC5TUUxFeGNlcHRpb247Cmlt\ncG9ydCBqYXZhLnV0aWwuQXJyYXlMaXN0OwppbXBvcnQgamF2YS51dGlsLkFy\ncmF5czsKaW1wb3J0IGphdmEudXRpbC5Db2xsZWN0aW9uczsKaW1wb3J0IGph\ndmEudXRpbC5JdGVyYXRvcjsKaW1wb3J0IGphdmEudXRpbC5MaXN0OwoKaW1w\nb3J0IG9yZy5hcGFjaGUuY29tbW9ucy5sYW5nLlN0cmluZ1V0aWxzOwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0YS5DbGFzc01hcHBpbmc7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhLk1hcHBpbmdS\nZXBvc2l0b3J5OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0\nYS5RdWVyeVJlc3VsdE1hcHBpbmc7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEuamRiYy5zcWwuREJEaWN0aW9uYXJ5OwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLmpkYmMuc3FsLlJlc3VsdFNldFJlc3VsdDsKaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS5qZGJjLnNxbC5TUUxCdWZmZXI7CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEuamRiYy5zcWwuU1FMRXhjZXB0aW9uczsKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuQWJzdHJhY3RTdG9yZVF1ZXJ5\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5RdWVyeUNvbnRl\neHQ7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLlN0b3JlUXVl\ncnk7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnJvcC5SYW5nZVJl\nc3VsdE9iamVjdFByb3ZpZGVyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLmxpYi5yb3AuUmVzdWx0T2JqZWN0UHJvdmlkZXI7CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEubGliLnV0aWwuTG9jYWxpemVyOwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLm1ldGEuQ2xhc3NNZXRhRGF0YTsKaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS51dGlsLlVzZXJFeGNlcHRpb247CmltcG9ydCBzZXJw\nLnV0aWwuTnVtYmVyczsKCi8qKgogKiBBIFNRTCBxdWVyeS4KICoKICogQGF1\ndGhvciBBYmUgV2hpdGUKICogQG5vamF2YWRvYwogKi8KcHVibGljIGNsYXNz\nIFNRTFN0b3JlUXVlcnkKICAgIGV4dGVuZHMgQWJzdHJhY3RTdG9yZVF1ZXJ5\nIHsKCiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBMb2NhbGl6ZXIgX2xvYyA9\nIExvY2FsaXplci5mb3JQYWNrYWdlCiAgICAgICAgKFNRTFN0b3JlUXVlcnku\nY2xhc3MpOwoKICAgIHByaXZhdGUgdHJhbnNpZW50IGZpbmFsIEpEQkNTdG9y\nZSBfc3RvcmU7CgogICAgLyoqCiAgICAgKiBDb25zdHJ1Y3QgYSBxdWVyeSBt\nYW5hZ2VkIGJ5IHRoZSBnaXZlbiBjb250ZXh0LgogICAgICovCiAgICBwdWJs\naWMgU1FMU3RvcmVRdWVyeShKREJDU3RvcmUgc3RvcmUpIHsKICAgICAgICBf\nc3RvcmUgPSBzdG9yZTsKICAgIH0KCiAgICBwdWJsaWMgSkRCQ1N0b3JlIGdl\ndFN0b3JlKCkgewogICAgICAgIHJldHVybiBfc3RvcmU7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBVdGlsaXR5IG1ldGhvZCB0byBzdWJzdGl0dXRlICc/bnVt\nJyBmb3IgcGFyYW1ldGVycyBpbiB0aGUgZ2l2ZW4gU1FMCiAgICAgKiBzdGF0\nZW1lbnQsIGFuZCByZS1vcmRlciB0aGUgPGNvZGU+cGFyYW1zPC9jb2RlPiBh\ncnJheSB0byBtYXRjaAogICAgICogdGhlIG9yZGVyIG9mIHRoZSBzcGVjaWZp\nZWQgcGFyYW1ldGVycy4KICAgICAqLwogICAgcHJpdmF0ZSBzdGF0aWMgU3Ry\naW5nIHN1YnN0aXR1dGVQYXJhbXMoU3RyaW5nIHNxbCwgTGlzdCBwYXJhbXMp\nCiAgICAgICAgdGhyb3dzIElPRXhjZXB0aW9uIHsKICAgICAgICAvLyBpZiB0\naGVyZSdzIG5vICI/MSIgcG9zaXRpb25hbCBwYXJhbWV0ZXIsIHRoZW4gd2Ug\nZG9uJ3QgbmVlZCB0bwogICAgICAgIC8vIHBlcmZvcm0gdGhlIHBhcnNpbmcg\ncHJvY2VzcwogICAgICAgIGlmIChzcWwuaW5kZXhPZigiPzEiKSA9PSAtMSkK\nICAgICAgICAgICAgcmV0dXJuIHNxbDsKCiAgICAgICAgTGlzdCBwYXJhbU9y\nZGVyID0gbmV3IEFycmF5TGlzdCgpOwogICAgICAgIFN0cmVhbVRva2VuaXpl\nciB0b2sgPSBuZXcgU3RyZWFtVG9rZW5pemVyKG5ldyBTdHJpbmdSZWFkZXIo\nc3FsKSk7CiAgICAgICAgdG9rLnJlc2V0U3ludGF4KCk7CiAgICAgICAgdG9r\nLnF1b3RlQ2hhcignXCcnKTsKICAgICAgICB0b2sud29yZENoYXJzKCcwJywg\nJzknKTsKICAgICAgICB0b2sud29yZENoYXJzKCc/JywgJz8nKTsKCiAgICAg\nICAgU3RyaW5nQnVmZmVyIGJ1ZiA9IG5ldyBTdHJpbmdCdWZmZXIoc3FsLmxl\nbmd0aCgpKTsKICAgICAgICBmb3IgKGludCB0dHlwZTsgKHR0eXBlID0gdG9r\nLm5leHRUb2tlbigpKSAhPSBTdHJlYW1Ub2tlbml6ZXIuVFRfRU9GOykgewog\nICAgICAgICAgICBzd2l0Y2ggKHR0eXBlKSB7CiAgICAgICAgICAgICAgICBj\nYXNlIFN0cmVhbVRva2VuaXplci5UVF9XT1JEOgogICAgICAgICAgICAgICAg\nICAgIC8vIGEgdG9rZW4gaXMgYSBwb3NpdGlvbmFsIHBhcmFtZXRlciBpZiBp\ndCBzdGFydHMgd2l0aAogICAgICAgICAgICAgICAgICAgIC8vIGEgIj8iIGFu\nZCB0aGUgcmVzdCBvZiB0aGUgdG9rZW4gYXJlIGFsbCBudW1iZXJzCiAgICAg\nICAgICAgICAgICAgICAgaWYgKHRvay5zdmFsLnN0YXJ0c1dpdGgoIj8iKSAm\nJiB0b2suc3ZhbC5sZW5ndGgoKSA+IDEgJiYKICAgICAgICAgICAgICAgICAg\nICAgICAgdG9rLnN2YWwuc3Vic3RyaW5nKDEpLmluZGV4T2YoIj8iKSA9PSAt\nMSkgewogICAgICAgICAgICAgICAgICAgICAgICBidWYuYXBwZW5kKCI/Iik7\nCiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtT3JkZXIuYWRkKEludGVn\nZXIudmFsdWVPZih0b2suc3ZhbC5zdWJzdHJpbmcoMSkpKTsKICAgICAgICAg\nICAgICAgICAgICB9IGVsc2UKICAgICAgICAgICAgICAgICAgICAgICAgYnVm\nLmFwcGVuZCh0b2suc3ZhbCk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7\nCiAgICAgICAgICAgICAgICBjYXNlJ1wnJzoKICAgICAgICAgICAgICAgICAg\nICBidWYuYXBwZW5kKCdcJycpOwogICAgICAgICAgICAgICAgICAgIGlmICh0\nb2suc3ZhbCAhPSBudWxsKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGJ1\nZi5hcHBlbmQodG9rLnN2YWwpOwogICAgICAgICAgICAgICAgICAgICAgICBi\ndWYuYXBwZW5kKCdcJycpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAg\nICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGRlZmF1bHQ6\nCiAgICAgICAgICAgICAgICAgICAgYnVmLmFwcGVuZCgoY2hhcikgdHR5cGUp\nOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAvLyBub3cgZ28g\ndGhyb3VnaCB0aGUgcGFyYW1PcmRlciBsaXN0IGFuZCByZS1vcmRlciB0aGUg\ncGFyYW1zIGFycmF5CiAgICAgICAgTGlzdCB0cmFuc2xhdGVkID0gbmV3IEFy\ncmF5TGlzdCgpOwogICAgICAgIGZvciAoSXRlcmF0b3IgaSA9IHBhcmFtT3Jk\nZXIuaXRlcmF0b3IoKTsgaS5oYXNOZXh0KCk7KSB7CiAgICAgICAgICAgIGlu\ndCBpbmRleCA9ICgoTnVtYmVyKSBpLm5leHQoKSkuaW50VmFsdWUoKSAtIDE7\nCiAgICAgICAgICAgIGlmIChpbmRleCA+PSBwYXJhbXMuc2l6ZSgpKQogICAg\nICAgICAgICAgICAgdGhyb3cgbmV3IFVzZXJFeGNlcHRpb24oX2xvYy5nZXQo\nInNxbHF1ZXJ5LW1pc3NpbmctcGFyYW1zIiwKICAgICAgICAgICAgICAgICAg\nICBzcWwsIFN0cmluZy52YWx1ZU9mKGluZGV4KSwgcGFyYW1zKSk7CiAgICAg\nICAgICAgIHRyYW5zbGF0ZWQuYWRkKHBhcmFtcy5nZXQoaW5kZXgpKTsKICAg\nICAgICB9CgogICAgICAgIC8vIHRyYW5zZmVyIHRoZSB0cmFuc2xhdGVkIGxp\nc3QgaW50byB0aGUgb3JpZ2luYWwgcGFyYW1zIGxpc3QKICAgICAgICBwYXJh\nbXMuY2xlYXIoKTsKICAgICAgICBwYXJhbXMuYWRkQWxsKHRyYW5zbGF0ZWQp\nOwogICAgICAgIHJldHVybiBidWYudG9TdHJpbmcoKTsKICAgIH0KCiAgICBw\ndWJsaWMgYm9vbGVhbiBzdXBwb3J0c1BhcmFtZXRlckRlY2xhcmF0aW9ucygp\nIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgcHVibGljIGJv\nb2xlYW4gc3VwcG9ydHNEYXRhU3RvcmVFeGVjdXRpb24oKSB7CiAgICAgICAg\ncmV0dXJuIHRydWU7CiAgICB9CgogICAgcHVibGljIEV4ZWN1dG9yIG5ld0Rh\ndGFTdG9yZUV4ZWN1dG9yKENsYXNzTWV0YURhdGEgbWV0YSwKICAgICAgICBi\nb29sZWFuIHN1YmNsYXNzZXMpIHsKICAgICAgICByZXR1cm4gbmV3IFNRTEV4\nZWN1dG9yKHRoaXMsIG1ldGEpOwogICAgfQoKICAgIHB1YmxpYyBib29sZWFu\nIHJlcXVpcmVzQ2FuZGlkYXRlVHlwZSgpIHsKICAgICAgICByZXR1cm4gZmFs\nc2U7CiAgICB9CgogICAgcHVibGljIGJvb2xlYW4gcmVxdWlyZXNQYXJhbWV0\nZXJEZWNsYXJhdGlvbnMoKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAg\nfQoKICAgIC8qKgogICAgICogRXhlY3V0ZXMgdGhlIGZpbHRlciBhcyBhIFNR\nTCBxdWVyeS4KICAgICAqLwogICAgcHJpdmF0ZSBzdGF0aWMgY2xhc3MgU1FM\nRXhlY3V0b3IKICAgICAgICBleHRlbmRzIEFic3RyYWN0RXhlY3V0b3IgewoK\nICAgICAgICBwcml2YXRlIGZpbmFsIENsYXNzTWV0YURhdGEgX21ldGE7CiAg\nICAgICAgcHJpdmF0ZSBmaW5hbCBib29sZWFuIF9zZWxlY3Q7CiAgICAgICAg\ncHJpdmF0ZSBmaW5hbCBib29sZWFuIF9jYWxsOyAgIC8vIG5hdGl2ZSBjYWxs\nIHN0b3JlZCBwcm9jZWR1cmUKICAgICAgICBwcml2YXRlIGZpbmFsIFF1ZXJ5\nUmVzdWx0TWFwcGluZyBfcmVzdWx0TWFwcGluZzsKCiAgICAgICAgcHVibGlj\nIFNRTEV4ZWN1dG9yKFNRTFN0b3JlUXVlcnkgcSwgQ2xhc3NNZXRhRGF0YSBj\nYW5kaWRhdGUpIHsKICAgICAgICAgICAgUXVlcnlDb250ZXh0IGN0eCA9IHEu\nZ2V0Q29udGV4dCgpOwogICAgICAgICAgICBTdHJpbmcgcmVzdWx0TWFwcGlu\nZyA9IGN0eC5nZXRSZXN1bHRNYXBwaW5nTmFtZSgpOwogICAgICAgICAgICBp\nZiAocmVzdWx0TWFwcGluZyA9PSBudWxsKQogICAgICAgICAgICAgICAgX3Jl\nc3VsdE1hcHBpbmcgPSBudWxsOwogICAgICAgICAgICBlbHNlIHsKICAgICAg\nICAgICAgICAgIENsYXNzTG9hZGVyIGVudkxvYWRlciA9IGN0eC5nZXRTdG9y\nZUNvbnRleHQoKS5nZXRDbGFzc0xvYWRlcigpOwogICAgICAgICAgICAgICAg\nTWFwcGluZ1JlcG9zaXRvcnkgcmVwb3MgPSBxLmdldFN0b3JlKCkuZ2V0Q29u\nZmlndXJhdGlvbigpLgogICAgICAgICAgICAgICAgICAgIGdldE1hcHBpbmdS\nZXBvc2l0b3J5SW5zdGFuY2UoKTsKICAgICAgICAgICAgICAgIF9yZXN1bHRN\nYXBwaW5nID0gcmVwb3MuZ2V0UXVlcnlSZXN1bHRNYXBwaW5nCiAgICAgICAg\nICAgICAgICAgICAgKGN0eC5nZXRSZXN1bHRNYXBwaW5nU2NvcGUoKSwgcmVz\ndWx0TWFwcGluZywgZW52TG9hZGVyLAogICAgICAgICAgICAgICAgICAgICAg\nICB0cnVlKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBfbWV0YSA9IGNh\nbmRpZGF0ZTsKCiAgICAgICAgICAgIFN0cmluZyBzcWwgPSBTdHJpbmdVdGls\ncy50cmltVG9OdWxsKGN0eC5nZXRRdWVyeVN0cmluZygpKTsKICAgICAgICAg\nICAgaWYgKHNxbCA9PSBudWxsKQogICAgICAgICAgICAgICAgdGhyb3cgbmV3\nIFVzZXJFeGNlcHRpb24oX2xvYy5nZXQoIm5vLXNxbCIpKTsKICAgICAgICAg\nICAgX3NlbGVjdCA9IHEuZ2V0U3RvcmUoKS5nZXREQkRpY3Rpb25hcnkoKS5p\nc1NlbGVjdChzcWwpOwogICAgICAgICAgICBfY2FsbCA9IHNxbC5sZW5ndGgo\nKSA+IDQKICAgICAgICAgICAgICAgICYmIHNxbC5zdWJzdHJpbmcoMCwgNCku\nZXF1YWxzSWdub3JlQ2FzZSgiY2FsbCIpOwogICAgICAgIH0KCiAgICAgICAg\ncHVibGljIGludCBnZXRPcGVyYXRpb24oU3RvcmVRdWVyeSBxKSB7CiAgICAg\nICAgICAgcmV0dXJuIF9zZWxlY3QgPyBPUF9TRUxFQ1QgOiAKICAgICAgICAg\nICAgICAgIChxLmdldENvbnRleHQoKS5nZXRDYW5kaWRhdGVUeXBlKCkgIT0g\nbnVsbAogICAgICAgICAgICAgICAgICAgICAgICB8fCBxLmdldENvbnRleHQo\nKS5nZXRSZXN1bHRUeXBlKCkgIT0gbnVsbAogICAgICAgICAgICAgICAgICAg\nICAgICB8fCBxLmdldENvbnRleHQoKS5nZXRSZXN1bHRNYXBwaW5nTmFtZSgp\nICE9IG51bGwgCiAgICAgICAgICAgICAgICAgICAgICAgIHx8IHEuZ2V0Q29u\ndGV4dCgpLmdldFJlc3VsdE1hcHBpbmdTY29wZSgpICE9IG51bGwpCiAgICAg\nICAgICAgICAgICAgICAgICAgID8gT1BfU0VMRUNUIDogT1BfVVBEQVRFOwog\nICAgICAgIH0KCiAgICAgICAgcHVibGljIE51bWJlciBleGVjdXRlVXBkYXRl\nKFN0b3JlUXVlcnkgcSwgT2JqZWN0W10gcGFyYW1zKSB7CiAgICAgICAgICAg\nIEpEQkNTdG9yZSBzdG9yZSA9ICgoU1FMU3RvcmVRdWVyeSkgcSkuZ2V0U3Rv\ncmUoKTsKICAgICAgICAgICAgREJEaWN0aW9uYXJ5IGRpY3QgPSBzdG9yZS5n\nZXREQkRpY3Rpb25hcnkoKTsKICAgICAgICAgICAgU3RyaW5nIHNxbCA9IHEu\nZ2V0Q29udGV4dCgpLmdldFF1ZXJ5U3RyaW5nKCk7CgogICAgICAgICAgICBM\naXN0IHBhcmFtTGlzdDsKICAgICAgICAgICAgaWYgKHBhcmFtcy5sZW5ndGgg\nPiAwKSB7CiAgICAgICAgICAgICAgICBwYXJhbUxpc3QgPSBuZXcgQXJyYXlM\naXN0KEFycmF5cy5hc0xpc3QocGFyYW1zKSk7CiAgICAgICAgICAgICAgICB0\ncnkgewogICAgICAgICAgICAgICAgICAgIHNxbCA9IHN1YnN0aXR1dGVQYXJh\nbXMoc3FsLCBwYXJhbUxpc3QpOwogICAgICAgICAgICAgICAgfSBjYXRjaCAo\nSU9FeGNlcHRpb24gaW9lKSB7CiAgICAgICAgICAgICAgICAgICAgdGhyb3cg\nbmV3IFVzZXJFeGNlcHRpb24oaW9lKTsKICAgICAgICAgICAgICAgIH0KICAg\nICAgICAgICAgfSBlbHNlCiAgICAgICAgICAgICAgICBwYXJhbUxpc3QgPSBD\nb2xsZWN0aW9ucy5FTVBUWV9MSVNUOwoKICAgICAgICAgICAgU1FMQnVmZmVy\nIGJ1ZiA9IG5ldyBTUUxCdWZmZXIoZGljdCkuYXBwZW5kKHNxbCk7CiAgICAg\nICAgICAgIAogICAgICAgICAgICAvLyB3ZSBuZWVkIHRvIG1ha2Ugc3VyZSB3\nZSBoYXZlIGFuIGFjdGl2ZSBzdG9yZSBjb25uZWN0aW9uCiAgICAgICAgICAg\nIHN0b3JlLmdldENvbnRleHQoKS5iZWdpblN0b3JlKCk7CiAgICAgICAgICAg\nIENvbm5lY3Rpb24gY29ubiA9IHN0b3JlLmdldENvbm5lY3Rpb24oKTsKICAg\nICAgICAgICAgSkRCQ0ZldGNoQ29uZmlndXJhdGlvbiBmZXRjaCA9IChKREJD\nRmV0Y2hDb25maWd1cmF0aW9uKQogICAgICAgICAgICAgICAgcS5nZXRDb250\nZXh0KCkuZ2V0RmV0Y2hDb25maWd1cmF0aW9uKCk7CgogICAgICAgICAgICBQ\ncmVwYXJlZFN0YXRlbWVudCBzdG1udCA9IG51bGw7CiAgICAgICAgICAgIHRy\neSB7CiAgICAgICAgICAgICAgICBzdG1udCA9IGJ1Zi5wcmVwYXJlQ2FsbChj\nb25uKTsKCiAgICAgICAgICAgICAgICBpbnQgaW5kZXggPSAwOwogICAgICAg\nICAgICAgICAgZm9yIChJdGVyYXRvciBpID0gcGFyYW1MaXN0Lml0ZXJhdG9y\nKCk7IGkuaGFzTmV4dCgpOykKICAgICAgICAgICAgICAgICAgICBkaWN0LnNl\ndFVua25vd24oc3RtbnQsICsraW5kZXgsIGkubmV4dCgpLCBudWxsKTsKICAg\nICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgaW50IGNvdW50ID0gMDsK\nICAgICAgICAgICAgICAgIGlmIChfY2FsbCAmJiBzdG1udC5leGVjdXRlKCkg\nPT0gZmFsc2UpIHsKICAgICAgICAgICAgICAgICAgICBjb3VudCA9IHN0bW50\nLmdldFVwZGF0ZUNvdW50KCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAg\nICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAvLyBuYXRpdmUg\naW5zZXJ0LCB1cGRhdGUsIGRlbGV0ZQogICAgICAgICAgICAgICAgICAgIGNv\ndW50ID0gc3RtbnQuZXhlY3V0ZVVwZGF0ZSgpOwogICAgICAgICAgICAgICAg\nfQogICAgICAgICAgICAgICAgcmV0dXJuIE51bWJlcnMudmFsdWVPZihjb3Vu\ndCk7CiAgICAgICAgICAgIH0gY2F0Y2ggKFNRTEV4Y2VwdGlvbiBzZSkgewog\nICAgICAgICAgICAgICAgdGhyb3cgU1FMRXhjZXB0aW9ucy5nZXRTdG9yZShz\nZSwgZGljdCk7CiAgICAgICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAg\nICAgICBpZihzdG1udCAhPSBudWxsKSB7CiAgICAgICAgICAgICAgICAgICAg\ndHJ5IHsKICAgICAgICAgICAgICAgICAgICAgICAgc3RtbnQuY2xvc2UoKTsg\nCiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoU1FMRXhjZXB0aW9uIHNl\nKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNhZmUgdG8gaWdub3Jl\nLCB3ZSdyZSBqdXN0IGNsZWFuaW5nIHVwLgogICAgICAgICAgICAgICAgICAg\nIH0KICAgICAgICAgICAgICAgICAgICBmaW5hbGx5IHsKICAgICAgICAgICAg\nICAgICAgICAgICAgc3RtbnQgPSBudWxsOwogICAgICAgICAgICAgICAgICAg\nIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHRyeSB7IGNv\nbm4uY2xvc2UoKTsgfSBjYXRjaCAoU1FMRXhjZXB0aW9uIHNlKSB7fQogICAg\nICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgUmVzdWx0T2Jq\nZWN0UHJvdmlkZXIgZXhlY3V0ZVF1ZXJ5KFN0b3JlUXVlcnkgcSwKICAgICAg\nICAgICAgT2JqZWN0W10gcGFyYW1zLCBSYW5nZSByYW5nZSkgewogICAgICAg\nICAgICBKREJDU3RvcmUgc3RvcmUgPSAoKFNRTFN0b3JlUXVlcnkpIHEpLmdl\ndFN0b3JlKCk7CiAgICAgICAgICAgIERCRGljdGlvbmFyeSBkaWN0ID0gc3Rv\ncmUuZ2V0REJEaWN0aW9uYXJ5KCk7CiAgICAgICAgICAgIFN0cmluZyBzcWwg\nPSBxLmdldENvbnRleHQoKS5nZXRRdWVyeVN0cmluZygpOwoKICAgICAgICAg\nICAgTGlzdCBwYXJhbUxpc3Q7CiAgICAgICAgICAgIGlmIChwYXJhbXMubGVu\nZ3RoID4gMCkgewogICAgICAgICAgICAgICAgcGFyYW1MaXN0ID0gbmV3IEFy\ncmF5TGlzdChBcnJheXMuYXNMaXN0KHBhcmFtcykpOwogICAgICAgICAgICAg\nICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICBzcWwgPSBzdWJzdGl0dXRl\nUGFyYW1zKHNxbCwgcGFyYW1MaXN0KTsKICAgICAgICAgICAgICAgIH0gY2F0\nY2ggKElPRXhjZXB0aW9uIGlvZSkgewogICAgICAgICAgICAgICAgICAgIHRo\ncm93IG5ldyBVc2VyRXhjZXB0aW9uKGlvZSk7CiAgICAgICAgICAgICAgICB9\nCiAgICAgICAgICAgIH0gZWxzZQogICAgICAgICAgICAgICAgcGFyYW1MaXN0\nID0gQ29sbGVjdGlvbnMuRU1QVFlfTElTVDsKCiAgICAgICAgICAgIFNRTEJ1\nZmZlciBidWYgPSBuZXcgU1FMQnVmZmVyKGRpY3QpLmFwcGVuZChzcWwpOwog\nICAgICAgICAgICBDb25uZWN0aW9uIGNvbm4gPSBzdG9yZS5nZXRDb25uZWN0\naW9uKCk7CiAgICAgICAgICAgIEpEQkNGZXRjaENvbmZpZ3VyYXRpb24gZmV0\nY2ggPSAoSkRCQ0ZldGNoQ29uZmlndXJhdGlvbikKICAgICAgICAgICAgICAg\nIHEuZ2V0Q29udGV4dCgpLmdldEZldGNoQ29uZmlndXJhdGlvbigpOwoKICAg\nICAgICAgICAgUmVzdWx0T2JqZWN0UHJvdmlkZXIgcm9wOwogICAgICAgICAg\nICBQcmVwYXJlZFN0YXRlbWVudCBzdG1udCA9IG51bGw7CiAgICAgICAgICAg\nIHRyeSB7CiAgICAgICAgICAgICAgICAvLyB1c2UgdGhlIHJpZ2h0IG1ldGhv\nZCBkZXBlbmRpbmcgb24gc2VsIHZzLiBwcm9jLCBscnMgc2V0dGluZwogICAg\nICAgICAgICAgICAgaWYgKF9zZWxlY3QgJiYgIXJhbmdlLmxycykKICAgICAg\nICAgICAgICAgICAgICBzdG1udCA9IGJ1Zi5wcmVwYXJlU3RhdGVtZW50KGNv\nbm4pOwogICAgICAgICAgICAgICAgZWxzZSBpZiAoX3NlbGVjdCkKICAgICAg\nICAgICAgICAgICAgICBzdG1udCA9IGJ1Zi5wcmVwYXJlU3RhdGVtZW50KGNv\nbm4sIGZldGNoLCAtMSwgLTEpOwogICAgICAgICAgICAgICAgZWxzZSBpZiAo\nIXJhbmdlLmxycykKICAgICAgICAgICAgICAgICAgICBzdG1udCA9IGJ1Zi5w\ncmVwYXJlQ2FsbChjb25uKTsKICAgICAgICAgICAgICAgIGVsc2UKICAgICAg\nICAgICAgICAgICAgICBzdG1udCA9IGJ1Zi5wcmVwYXJlQ2FsbChjb25uLCBm\nZXRjaCwgLTEsIC0xKTsKCiAgICAgICAgICAgICAgICBpbnQgaW5kZXggPSAw\nOwogICAgICAgICAgICAgICAgZm9yIChJdGVyYXRvciBpID0gcGFyYW1MaXN0\nLml0ZXJhdG9yKCk7IGkuaGFzTmV4dCgpOykKICAgICAgICAgICAgICAgICAg\nICBkaWN0LnNldFVua25vd24oc3RtbnQsICsraW5kZXgsIGkubmV4dCgpLCBu\ndWxsKTsKCiAgICAgICAgICAgICAgICBSZXN1bHRTZXRSZXN1bHQgcmVzID0g\nbmV3IFJlc3VsdFNldFJlc3VsdChjb25uLCBzdG1udCwKICAgICAgICAgICAg\nICAgICAgICBzdG1udC5leGVjdXRlUXVlcnkoKSwgc3RvcmUpOwogICAgICAg\nICAgICAgICAgaWYgKF9yZXN1bHRNYXBwaW5nICE9IG51bGwpCiAgICAgICAg\nICAgICAgICAgICAgcm9wID0gbmV3IE1hcHBlZFF1ZXJ5UmVzdWx0T2JqZWN0\nUHJvdmlkZXIoX3Jlc3VsdE1hcHBpbmcsCiAgICAgICAgICAgICAgICAgICAg\nICAgIHN0b3JlLCBmZXRjaCwgcmVzKTsKICAgICAgICAgICAgICAgIGVsc2Ug\naWYgKHEuZ2V0Q29udGV4dCgpLmdldENhbmRpZGF0ZVR5cGUoKSAhPSBudWxs\nKQogICAgICAgICAgICAgICAgICAgIHJvcCA9IG5ldyBHZW5lcmljUmVzdWx0\nT2JqZWN0UHJvdmlkZXIoKENsYXNzTWFwcGluZykgX21ldGEsCiAgICAgICAg\nICAgICAgICAgICAgICAgIHN0b3JlLCBmZXRjaCwgcmVzKTsKICAgICAgICAg\nICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICByb3AgPSBuZXcgU1FM\nUHJvamVjdGlvblJlc3VsdE9iamVjdFByb3ZpZGVyKHN0b3JlLCBmZXRjaCwK\nICAgICAgICAgICAgICAgICAgICAgICAgcmVzLCBxLmdldENvbnRleHQoKS5n\nZXRSZXN1bHRUeXBlKCkpOwogICAgICAgICAgICB9IGNhdGNoIChTUUxFeGNl\ncHRpb24gc2UpIHsKICAgICAgICAgICAgICAgIGlmIChzdG1udCAhPSBudWxs\nKQogICAgICAgICAgICAgICAgICAgIHRyeSB7IHN0bW50LmNsb3NlKCk7IH0g\nY2F0Y2ggKFNRTEV4Y2VwdGlvbiBzZTIpIHt9CiAgICAgICAgICAgICAgICB0\ncnkgeyBjb25uLmNsb3NlKCk7IH0gY2F0Y2ggKFNRTEV4Y2VwdGlvbiBzZTIp\nIHt9CiAgICAgICAgICAgICAgICB0aHJvdyBTUUxFeGNlcHRpb25zLmdldFN0\nb3JlKHNlLCBkaWN0KTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYg\nKHJhbmdlLnN0YXJ0ICE9IDAgfHwgcmFuZ2UuZW5kICE9IExvbmcuTUFYX1ZB\nTFVFKQogICAgICAgICAgICAgICAgcm9wID0gbmV3IFJhbmdlUmVzdWx0T2Jq\nZWN0UHJvdmlkZXIocm9wLCByYW5nZS5zdGFydCxyYW5nZS5lbmQpOwogICAg\nICAgICAgICByZXR1cm4gcm9wOwogICAgICAgIH0KCiAgICAgICAgcHVibGlj\nIFN0cmluZ1tdIGdldERhdGFTdG9yZUFjdGlvbnMoU3RvcmVRdWVyeSBxLCBP\nYmplY3RbXSBwYXJhbXMsCiAgICAgICAgICAgIFJhbmdlIHJhbmdlKSB7CiAg\nICAgICAgICAgIHJldHVybiBuZXcgU3RyaW5nW117IHEuZ2V0Q29udGV4dCgp\nLmdldFF1ZXJ5U3RyaW5nKCkgfTsKICAgICAgICB9CgogICAgICAgIHB1Ymxp\nYyBib29sZWFuIGlzUGFja2luZyhTdG9yZVF1ZXJ5IHEpIHsKICAgICAgICAg\nICAgcmV0dXJuIHEuZ2V0Q29udGV4dCgpLmdldENhbmRpZGF0ZVR5cGUoKSA9\nPSBudWxsOwogICAgICAgIH0KICAgIH0KfQo=\n","encoding":"base64"}

