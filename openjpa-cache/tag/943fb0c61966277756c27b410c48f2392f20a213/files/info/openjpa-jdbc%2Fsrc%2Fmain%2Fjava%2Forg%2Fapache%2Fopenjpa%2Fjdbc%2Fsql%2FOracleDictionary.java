{"sha":"b46aa17e01af9b9f12d944051af37a9e447c87c4","node_id":"MDQ6QmxvYjIwNjM2NDpiNDZhYTE3ZTAxYWY5YjlmMTJkOTQ0MDUxYWYzN2E5ZTQ0N2M4N2M0","size":43323,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/b46aa17e01af9b9f12d944051af37a9e447c87c4","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zcWw7CgppbXBvcnQg\namF2YS5sYW5nLnJlZmxlY3QuSW52b2NhdGlvblRhcmdldEV4Y2VwdGlvbjsK\naW1wb3J0IGphdmEubGFuZy5yZWZsZWN0Lk1ldGhvZDsKaW1wb3J0IGphdmEu\nc2VjdXJpdHkuQWNjZXNzQ29udHJvbGxlcjsKaW1wb3J0IGphdmEuc3FsLkJs\nb2I7CmltcG9ydCBqYXZhLnNxbC5DbG9iOwppbXBvcnQgamF2YS5zcWwuQ29u\nbmVjdGlvbjsKaW1wb3J0IGphdmEuc3FsLkRhdGFiYXNlTWV0YURhdGE7Cmlt\ncG9ydCBqYXZhLnNxbC5QcmVwYXJlZFN0YXRlbWVudDsKaW1wb3J0IGphdmEu\nc3FsLlJlc3VsdFNldDsKaW1wb3J0IGphdmEuc3FsLlNRTEV4Y2VwdGlvbjsK\naW1wb3J0IGphdmEuc3FsLlN0YXRlbWVudDsKaW1wb3J0IGphdmEuc3FsLlRp\nbWVzdGFtcDsKaW1wb3J0IGphdmEuc3FsLlR5cGVzOwppbXBvcnQgamF2YS51\ndGlsLkFycmF5TGlzdDsKaW1wb3J0IGphdmEudXRpbC5BcnJheXM7CmltcG9y\ndCBqYXZhLnV0aWwuQ2FsZW5kYXI7CmltcG9ydCBqYXZhLnV0aWwuSXRlcmF0\nb3I7CmltcG9ydCBqYXZhLnV0aWwuTGlzdDsKaW1wb3J0IGphdmEudXRpbC5N\nYXA7CgppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMua2VybmVsLkpE\nQkNGZXRjaENvbmZpZ3VyYXRpb247CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEuamRiYy5rZXJuZWwuZXhwcy5GaWx0ZXJWYWx1ZTsKaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS5qZGJjLnNjaGVtYS5Db2x1bW47CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hlbWEuRm9yZWlnbktleTsKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNjaGVtYS5JbmRleDsKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNjaGVtYS5QcmltYXJ5S2V5Owpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1hLlNlcXVlbmNl\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1hLlRhYmxl\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc3FsLlNlbGVjdDsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIuamRiYy5EZWxlZ2F0aW5n\nRGF0YWJhc2VNZXRhRGF0YTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5s\naWIuamRiYy5EZWxlZ2F0aW5nUHJlcGFyZWRTdGF0ZW1lbnQ7CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuSjJEb1ByaXZIZWxwZXI7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuTG9jYWxpemVyOwpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuU3RvcmVFeGNlcHRpb247\nCgppbXBvcnQgc2VycC51dGlsLk51bWJlcnM7CgovKioKICogRGljdGlvbmFy\neSBmb3IgT3JhY2xlLgogKi8KcHVibGljIGNsYXNzIE9yYWNsZURpY3Rpb25h\ncnkKICAgIGV4dGVuZHMgREJEaWN0aW9uYXJ5IHsKCiAgICBwdWJsaWMgc3Rh\ndGljIGZpbmFsIFN0cmluZyBTRUxFQ1RfSElOVCA9ICJvcGVuanBhLmhpbnQu\nT3JhY2xlU2VsZWN0SGludCI7CiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIFN0\ncmluZyBWRU5ET1JfT1JBQ0xFID0gIm9yYWNsZSI7CgogICAgcHJpdmF0ZSBz\ndGF0aWMgZmluYWwgaW50IEJFSEFWRV9PVEhFUiA9IDA7CiAgICBwcml2YXRl\nIHN0YXRpYyBmaW5hbCBpbnQgQkVIQVZFX09SQUNMRSA9IDE7CiAgICBwcml2\nYXRlIHN0YXRpYyBmaW5hbCBpbnQgQkVIQVZFX0RBVEFESVJFQ1QzMSA9IDI7\nCgogICAgcHJpdmF0ZSBzdGF0aWMgQmxvYiBFTVBUWV9CTE9CID0gbnVsbDsK\nICAgIHByaXZhdGUgc3RhdGljIENsb2IgRU1QVFlfQ0xPQiA9IG51bGw7Cgog\nICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgTG9jYWxpemVyIF9sb2MgPSBMb2Nh\nbGl6ZXIuZm9yUGFja2FnZQogICAgICAgIChPcmFjbGVEaWN0aW9uYXJ5LmNs\nYXNzKTsKCiAgICAvKioKICAgICAqIElmIHRydWUsIHRoZW4gc2ltdWxhdGUg\nYXV0by1hc3NpZ25lZCB2YWx1ZXMgaW4gT3JhY2xlIGJ5CiAgICAgKiB1c2lu\nZyBhIHRyaWdnZXIgdGhhdCBpbnNlcnRzIGEgc2VxdWVuY2UgdmFsdWUgaW50\nbyB0aGUKICAgICAqIHByaW1hcnkga2V5IHZhbHVlIHdoZW4gYSByb3cgaXMg\naW5zZXJ0ZWQuCiAgICAgKi8KICAgIHB1YmxpYyBib29sZWFuIHVzZVRyaWdn\nZXJzRm9yQXV0b0Fzc2lnbiA9IGZhbHNlOwoKICAgIC8qKgogICAgICogVGhl\nIGdsb2JhbCBzZXF1ZW5jZSBuYW1lIHRvIHVzZSBmb3IgYXV0b2Fzc2lnbiBz\naW11bGF0aW9uLgogICAgICovCiAgICBwdWJsaWMgU3RyaW5nIGF1dG9Bc3Np\nZ25TZXF1ZW5jZU5hbWUgPSBudWxsOwoKICAgIC8qKgogICAgICogRmxhZyB0\nbyB1c2UgT3BlbkpQQSAwLjMgc3R5bGUgbmFtaW5nIGZvciBhdXRvIGFzc2ln\nbiBzZXF1ZW5jZSBuYW1lIGFuZAogICAgICogdHJpZ2dlciBuYW1lIGZvciBi\nYWNrd2FyZHMgY29tcGF0aWJpbGl0eS4KICAgICAqLwogICAgcHVibGljIGJv\nb2xlYW4gb3BlbmpwYTNHZW5lcmF0ZWRLZXlOYW1lcyA9IGZhbHNlOwoKICAg\nIC8qKgogICAgICogSWYgdHJ1ZSwgdGhlbiBPcGVuSlBBIHdpbGwgYXR0ZW1w\ndCB0byB1c2UgdGhlIHNwZWNpYWwKICAgICAqIE9yYWNsZVByZXBhcmVkU3Rh\ndGVtZW50LnNldEZvcm1PZlVzZSBtZXRob2QgdG8KICAgICAqIGNvbmZpZ3Vy\nZSBzdGF0ZW1lbnRzIHRoYXQgaXQgZGV0ZWN0cyBhcmUgb3BlcmF0aW5nIG9u\nIHVuaWNvZGUgZmllbGRzLgogICAgICovCiAgICBwdWJsaWMgYm9vbGVhbiB1\nc2VTZXRGb3JtT2ZVc2VGb3JVbmljb2RlID0gdHJ1ZTsKCiAgICAvLyBzb21l\nIG9yYWNsZSBkcml2ZXJzIGhhdmUgcHJvYmxlbXMgd2l0aCBzZWxlY3QgZm9y\nIHVwZGF0ZTsgd2FybiB0aGUKICAgIC8vIGZpcnN0IHRpbWUgbG9ja2luZyBp\ncyBhdHRlbXB0ZWQKICAgIHByaXZhdGUgYm9vbGVhbiBfY2hlY2tlZFVwZGF0\nZUJ1ZyA9IGZhbHNlOwogICAgcHJpdmF0ZSBib29sZWFuIF93YXJuZWRDaGFy\nQ29sdW1uID0gZmFsc2U7CiAgICBwcml2YXRlIGJvb2xlYW4gX3dhcm5lZE5j\naGFyQ29sdW1uID0gZmFsc2U7CiAgICBwcml2YXRlIGludCBfZHJpdmVyQmVo\nYXZpb3IgPSAtMTsKCiAgICAvLyBjYWNoZSBsb2IgbWV0aG9kcwogICAgcHJp\ndmF0ZSBNZXRob2QgX3B1dEJ5dGVzID0gbnVsbDsKICAgIHByaXZhdGUgTWV0\naG9kIF9wdXRTdHJpbmcgPSBudWxsOwogICAgcHJpdmF0ZSBNZXRob2QgX3B1\ndENoYXJzID0gbnVsbDsKCiAgICBwdWJsaWMgT3JhY2xlRGljdGlvbmFyeSgp\nIHsKICAgICAgICBwbGF0Zm9ybSA9ICJPcmFjbGUiOwogICAgICAgIHZhbGlk\nYXRpb25TUUwgPSAiU0VMRUNUIFNZU0RBVEUgRlJPTSBEVUFMIjsKICAgICAg\nICBuZXh0U2VxdWVuY2VRdWVyeSA9ICJTRUxFQ1QgezB9Lk5FWFRWQUwgRlJP\nTSBEVUFMIjsKICAgICAgICBzdHJpbmdMZW5ndGhGdW5jdGlvbiA9ICJMRU5H\nVEgoezB9KSI7CiAgICAgICAgam9pblN5bnRheCA9IFNZTlRBWF9EQVRBQkFT\nRTsKICAgICAgICBtYXhUYWJsZU5hbWVMZW5ndGggPSAzMDsKICAgICAgICBt\nYXhDb2x1bW5OYW1lTGVuZ3RoID0gMzA7CiAgICAgICAgbWF4SW5kZXhOYW1l\nTGVuZ3RoID0gMzA7CiAgICAgICAgbWF4Q29uc3RyYWludE5hbWVMZW5ndGgg\nPSAzMDsKICAgICAgICBtYXhFbWJlZGRlZEJsb2JTaXplID0gNDAwMDsKICAg\nICAgICBtYXhFbWJlZGRlZENsb2JTaXplID0gNDAwMDsKICAgICAgICBpbkNs\nYXVzZUxpbWl0ID0gMTAwMDsKCiAgICAgICAgc3VwcG9ydHNEZWZlcnJlZENv\nbnN0cmFpbnRzID0gdHJ1ZTsKICAgICAgICBzdXBwb3J0c0xvY2tpbmdXaXRo\nRGlzdGluY3RDbGF1c2UgPSBmYWxzZTsKICAgICAgICBzdXBwb3J0c1NlbGVj\ndFN0YXJ0SW5kZXggPSB0cnVlOwogICAgICAgIHN1cHBvcnRzU2VsZWN0RW5k\nSW5kZXggPSB0cnVlOwoKICAgICAgICBzeXN0ZW1TY2hlbWFTZXQuYWRkQWxs\nKEFycmF5cy5hc0xpc3QobmV3IFN0cmluZ1tdewogICAgICAgICAgICAiQ1RY\nU1lTIiwgIk1EU1lTIiwgIlNZUyIsICJTWVNURU0iLCAiV0tTWVMiLCAiV01T\nWVMiLCAiWERCIiwKICAgICAgICB9KSk7CgogICAgICAgIHN1cHBvcnRzWE1M\nQ29sdW1uID0gdHJ1ZTsKICAgICAgICB4bWxUeXBlTmFtZSA9ICJYTUxUeXBl\nIjsKICAgICAgICBiaWdpbnRUeXBlTmFtZSA9ICJOVU1CRVJ7MH0iOwogICAg\nICAgIGJpdFR5cGVOYW1lID0gIk5VTUJFUnswfSI7CiAgICAgICAgZGVjaW1h\nbFR5cGVOYW1lID0gIk5VTUJFUnswfSI7CiAgICAgICAgZG91YmxlVHlwZU5h\nbWUgPSAiTlVNQkVSezB9IjsKICAgICAgICBpbnRlZ2VyVHlwZU5hbWUgPSAi\nTlVNQkVSezB9IjsKICAgICAgICBudW1lcmljVHlwZU5hbWUgPSAiTlVNQkVS\nezB9IjsKICAgICAgICBzbWFsbGludFR5cGVOYW1lID0gIk5VTUJFUnswfSI7\nCiAgICAgICAgdGlueWludFR5cGVOYW1lID0gIk5VTUJFUnswfSI7CiAgICAg\nICAgbG9uZ1ZhcmNoYXJUeXBlTmFtZSA9ICJMT05HIjsKICAgICAgICBiaW5h\ncnlUeXBlTmFtZSA9ICJCTE9CIjsKICAgICAgICB2YXJiaW5hcnlUeXBlTmFt\nZSA9ICJCTE9CIjsKICAgICAgICBsb25nVmFyYmluYXJ5VHlwZU5hbWUgPSAi\nQkxPQiI7CiAgICAgICAgdGltZVR5cGVOYW1lID0gIkRBVEUiOwogICAgICAg\nIHZhcmNoYXJUeXBlTmFtZSA9ICJWQVJDSEFSMnswfSI7CiAgICAgICAgZml4\nZWRTaXplVHlwZU5hbWVTZXQuYWRkQWxsKEFycmF5cy5hc0xpc3QobmV3IFN0\ncmluZ1tdewogICAgICAgICAgICAiTE9ORyBSQVciLCAiUkFXIiwgIkxPTkci\nLCAiUkVGIiwKICAgICAgICB9KSk7CiAgICAgICAgcmVzZXJ2ZWRXb3JkU2V0\nLmFkZEFsbChBcnJheXMuYXNMaXN0KG5ldyBTdHJpbmdbXXsKICAgICAgICAg\nICAgIkFDQ0VTUyIsICJBVURJVCIsICJDTFVTVEVSIiwgIkNPTU1FTlQiLCAi\nQ09NUFJFU1MiLCAiRVhDTFVTSVZFIiwKICAgICAgICAgICAgIkZJTEUiLCAi\nSURFTlRJRklFRCIsICJJTkNSRU1FTlQiLCAiSU5ERVgiLCAiSU5JVElBTCIs\nICJMT0NLIiwKICAgICAgICAgICAgIkxPTkciLCAiTUFYRVhURU5UUyIsICJN\nSU5VUyIsICJNT0RFIiwgIk5PQVVESVQiLCAiTk9DT01QUkVTUyIsCiAgICAg\nICAgICAgICJOT1dBSVQiLCAiT0ZGTElORSIsICJPTkxJTkUiLCAiUENURlJF\nRSIsICJST1ciLAogICAgICAgIH0pKTsKICAgICAgICAKICAgICAgICBzZWxl\nY3RXb3JkU2V0LmFkZCgiV0lUSCIpOwogICAgfQoKICAgIHB1YmxpYyB2b2lk\nIGVuZENvbmZpZ3VyYXRpb24oKSB7CiAgICAgICAgc3VwZXIuZW5kQ29uZmln\ndXJhdGlvbigpOwogICAgICAgIGlmICh1c2VUcmlnZ2Vyc0ZvckF1dG9Bc3Np\nZ24pCiAgICAgICAgICAgIHN1cHBvcnRzQXV0b0Fzc2lnbiA9IHRydWU7CiAg\nICB9CgogICAgcHVibGljIHZvaWQgY29ubmVjdGVkQ29uZmlndXJhdGlvbihD\nb25uZWN0aW9uIGNvbm4pCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7\nCiAgICAgICAgc3VwZXIuY29ubmVjdGVkQ29uZmlndXJhdGlvbihjb25uKTsK\nICAgICAgICBpZiAoZHJpdmVyVmVuZG9yID09IG51bGwpIHsKICAgICAgICAg\nICAgRGF0YWJhc2VNZXRhRGF0YSBtZXRhID0gY29ubi5nZXRNZXRhRGF0YSgp\nOwogICAgICAgICAgICBTdHJpbmcgdXJsID0gKG1ldGEuZ2V0VVJMKCkgPT0g\nbnVsbCkgPyAiIiA6IG1ldGEuZ2V0VVJMKCk7CiAgICAgICAgICAgIFN0cmlu\nZyBkcml2ZXJOYW1lID0gbWV0YS5nZXREcml2ZXJOYW1lKCk7CiAgICAgICAg\nICAgIFN0cmluZyBtZXRhZGF0YUNsYXNzTmFtZTsKICAgICAgICAgICAgaWYg\nKG1ldGEgaW5zdGFuY2VvZiBEZWxlZ2F0aW5nRGF0YWJhc2VNZXRhRGF0YSkK\nICAgICAgICAgICAgICAgIG1ldGFkYXRhQ2xhc3NOYW1lID0gKChEZWxlZ2F0\naW5nRGF0YWJhc2VNZXRhRGF0YSkgbWV0YSkuCiAgICAgICAgICAgICAgICAg\nICAgZ2V0SW5uZXJtb3N0RGVsZWdhdGUoKS5nZXRDbGFzcygpLmdldE5hbWUo\nKTsKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgbWV0YWRhdGFD\nbGFzc05hbWUgPSBtZXRhLmdldENsYXNzKCkuZ2V0TmFtZSgpOwoKICAgICAg\nICAgICAgLy8gY2hlY2sgYm90aCB0aGUgZHJpdmVyIGNsYXNzIG5hbWUgYW5k\nIHRoZSBVUkwgZm9yIGtub3duIHBhdHRlcm5zCiAgICAgICAgICAgIGlmICht\nZXRhZGF0YUNsYXNzTmFtZS5zdGFydHNXaXRoKCJvcmFjbGUuIikKICAgICAg\nICAgICAgICAgIHx8IHVybC5pbmRleE9mKCJqZGJjOm9yYWNsZToiKSAhPSAt\nMQogICAgICAgICAgICAgICAgfHwgIk9yYWNsZSBKREJDIGRyaXZlciIuZXF1\nYWxzKGRyaXZlck5hbWUpKSB7CiAgICAgICAgICAgICAgICBkcml2ZXJWZW5k\nb3IgPSBWRU5ET1JfT1JBQ0xFICsgbWV0YS5nZXREcml2ZXJNYWpvclZlcnNp\nb24oKQogICAgICAgICAgICAgICAgICAgICsgbWV0YS5nZXREcml2ZXJNaW5v\nclZlcnNpb24oKTsKCiAgICAgICAgICAgICAgICBTdHJpbmcgcHJvZHVjdFZl\ncnNpb24gPSBtZXRhLmdldERhdGFiYXNlUHJvZHVjdFZlcnNpb24oKQogICAg\nICAgICAgICAgICAgICAgIC5zcGxpdCgiUmVsZWFzZSAiLDApWzFdLnNwbGl0\nKCJcXC4iLDApWzBdOwogICAgICAgICAgICAgICAgaW50IHJlbGVhc2UgPSBJ\nbnRlZ2VyLnBhcnNlSW50KHByb2R1Y3RWZXJzaW9uKTsKICAgICAgICAgICAg\nICAgIAogICAgICAgICAgICAgICAgLy8gd2FybiBzcWw5MgogICAgICAgICAg\nICAgICAgaWYgKHJlbGVhc2UgPD0gOCkgewogICAgICAgICAgICAgICAgICAg\nIGlmIChqb2luU3ludGF4ID09IFNZTlRBWF9TUUw5MiAmJiBsb2cuaXNXYXJu\nRW5hYmxlZCgpKQogICAgICAgICAgICAgICAgICAgICAgICBsb2cud2Fybihf\nbG9jLmdldCgib3JhY2xlLXN5bnRheCIpKTsKICAgICAgICAgICAgICAgICAg\nICBqb2luU3ludGF4ID0gU1lOVEFYX0RBVEFCQVNFOwogICAgICAgICAgICAg\nICAgICAgIGRhdGVUeXBlTmFtZSA9ICJEQVRFIjsgLy8gYWRkZWQgb3JhY2xl\nIDkKICAgICAgICAgICAgICAgICAgICB0aW1lc3RhbXBUeXBlTmFtZSA9ICJE\nQVRFIjsgLy8gYWRkZWQgb3JhY2xlIDkKICAgICAgICAgICAgICAgICAgICBz\ndXBwb3J0c1hNTENvbHVtbiA9IGZhbHNlOwogICAgICAgICAgICAgICAgfQog\nICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgIC8vIHNl\nbGVjdCBvZiBhbiB4bWwgY29sdW1uIHJlcXVpcmVzICIuZ2V0U3RyaW5nVmFs\nKCkiCiAgICAgICAgICAgICAgICAgICAgLy8gc3VmZml4LiBlZy4gdDAueG1s\nY29sLmdldFN0cmluZ1ZhbCgpCiAgICAgICAgICAgICAgICAgICAgZ2V0U3Ry\naW5nVmFsID0gIi5nZXRTdHJpbmdWYWwoKSI7CiAgICAgICAgICAgIH0gZWxz\nZSBpZiAobWV0YWRhdGFDbGFzc05hbWUuc3RhcnRzV2l0aCgiY29tLmRkdGVr\nLiIpCiAgICAgICAgICAgICAgICB8fCB1cmwuaW5kZXhPZigiamRiYzpkYXRh\nZGlyZWN0Om9yYWNsZToiKSAhPSAtMQogICAgICAgICAgICAgICAgfHwgIk9y\nYWNsZSIuZXF1YWxzKGRyaXZlck5hbWUpKSB7CiAgICAgICAgICAgICAgICBk\ncml2ZXJWZW5kb3IgPSBWRU5ET1JfREFUQURJUkVDVCArIG1ldGEuZ2V0RHJp\ndmVyTWFqb3JWZXJzaW9uKCkKICAgICAgICAgICAgICAgICAgICArIG1ldGEu\nZ2V0RHJpdmVyTWlub3JWZXJzaW9uKCk7CiAgICAgICAgICAgIH0gZWxzZQog\nICAgICAgICAgICAgICAgZHJpdmVyVmVuZG9yID0gVkVORE9SX09USEVSOwog\nICAgICAgIH0KICAgICAgICBjYWNoZURyaXZlckJlaGF2aW9yKGRyaXZlclZl\nbmRvcik7CiAgICB9CgogICAgLyoqCiAgICAgKiBDYWNoZSBjb25zdGFudCBm\nb3IgZHJpdmVycyB3aXRoIGJlaGF2aW9ycyB3ZSBoYXZlIHRvIGRlYWwgd2l0\naC4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIGNhY2hlRHJpdmVyQmVoYXZp\nb3IoU3RyaW5nIGRyaXZlclZlbmRvcikgewogICAgICAgIGlmIChfZHJpdmVy\nQmVoYXZpb3IgIT0gLTEpCiAgICAgICAgICAgIHJldHVybjsKCiAgICAgICAg\nZHJpdmVyVmVuZG9yID0gZHJpdmVyVmVuZG9yLnRvTG93ZXJDYXNlKCk7CiAg\nICAgICAgaWYgKGRyaXZlclZlbmRvci5zdGFydHNXaXRoKFZFTkRPUl9PUkFD\nTEUpKQogICAgICAgICAgICBfZHJpdmVyQmVoYXZpb3IgPSBCRUhBVkVfT1JB\nQ0xFOwogICAgICAgIGVsc2UgaWYgKGRyaXZlclZlbmRvci5lcXVhbHMoVkVO\nRE9SX0RBVEFESVJFQ1QgKyAiMzAiKQogICAgICAgICAgICB8fCBkcml2ZXJW\nZW5kb3IuZXF1YWxzKFZFTkRPUl9EQVRBRElSRUNUICsgIjMxIikpCiAgICAg\nICAgICAgIF9kcml2ZXJCZWhhdmlvciA9IEJFSEFWRV9EQVRBRElSRUNUMzE7\nCiAgICAgICAgZWxzZQogICAgICAgICAgICBfZHJpdmVyQmVoYXZpb3IgPSBC\nRUhBVkVfT1RIRVI7CiAgICB9CgogICAgLyoqCiAgICAgKiBFbnN1cmUgdGhh\ndCB0aGUgZHJpdmVyIHZlbmRvciBoYXMgYmVlbiBzZXQsIGFuZCBpZiBub3Qs\nIHNldCBpdCBub3cuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIGVuc3VyZURy\naXZlclZlbmRvcigpIHsKICAgICAgICBpZiAoZHJpdmVyVmVuZG9yICE9IG51\nbGwpIHsKICAgICAgICAgICAgY2FjaGVEcml2ZXJCZWhhdmlvcihkcml2ZXJW\nZW5kb3IpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAg\nICBpZiAobG9nLmlzSW5mb0VuYWJsZWQoKSkKICAgICAgICAgICAgbG9nLmlu\nZm8oX2xvYy5nZXQoIm9yYWNsZS1jb25uZWN0aW5nLWZvci1kcml2ZXIiKSk7\nCiAgICAgICAgQ29ubmVjdGlvbiBjb25uID0gbnVsbDsKICAgICAgICB0cnkg\newogICAgICAgICAgICBjb25uID0gY29uZi5nZXREYXRhU291cmNlMihudWxs\nKS5nZXRDb25uZWN0aW9uKCk7CiAgICAgICAgICAgIGNvbm5lY3RlZENvbmZp\nZ3VyYXRpb24oY29ubik7CiAgICAgICAgfSBjYXRjaCAoU1FMRXhjZXB0aW9u\nIHNlKSB7CiAgICAgICAgICAgIHRocm93IFNRTEV4Y2VwdGlvbnMuZ2V0U3Rv\ncmUoc2UsIHRoaXMpOwogICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAg\nIGlmIChjb25uICE9IG51bGwpCiAgICAgICAgICAgICAgICB0cnkgewogICAg\nICAgICAgICAgICAgICAgIGNvbm4uY2xvc2UoKTsKICAgICAgICAgICAgICAg\nIH0gY2F0Y2ggKFNRTEV4Y2VwdGlvbiBzZSkgewogICAgICAgICAgICAgICAg\nfQogICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBzdXBwb3J0\nc0xvY2tpbmcoU2VsZWN0IHNlbCkgewogICAgICAgIGlmICghc3VwZXIuc3Vw\ncG9ydHNMb2NraW5nKHNlbCkpCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsK\nICAgICAgICByZXR1cm4gIXJlcXVpcmVzU3Vic2VsZWN0Rm9yUmFuZ2Uoc2Vs\nLmdldFN0YXJ0SW5kZXgoKSwKICAgICAgICAgICAgc2VsLmdldEVuZEluZGV4\nKCksIHNlbC5pc0Rpc3RpbmN0KCksIHNlbC5nZXRPcmRlcmluZygpKTsKICAg\nIH0KCiAgICBwcm90ZWN0ZWQgU1FMQnVmZmVyIGdldFNlbGVjdHMoU2VsZWN0\nIHNlbCwgYm9vbGVhbiBkaXN0aW5jdElkZW50aWZpZXJzLAogICAgICAgIGJv\nb2xlYW4gZm9yVXBkYXRlKSB7CiAgICAgICAgLy8gaWYgcmFuZ2UgZG9lc24n\ndCByZXF1aXJlIGEgc3Vic2VsZWN0IGNhbiB1c2Ugc3VwZXIKICAgICAgICBp\nZiAoIXJlcXVpcmVzU3Vic2VsZWN0Rm9yUmFuZ2Uoc2VsLmdldFN0YXJ0SW5k\nZXgoKSwKICAgICAgICAgICAgc2VsLmdldEVuZEluZGV4KCksIHNlbC5pc0Rp\nc3RpbmN0KCksIHNlbC5nZXRPcmRlcmluZygpKSkKICAgICAgICAgICAgcmV0\ndXJuIHN1cGVyLmdldFNlbGVjdHMoc2VsLCBkaXN0aW5jdElkZW50aWZpZXJz\nLCBmb3JVcGRhdGUpOwoKICAgICAgICAvLyBpZiB0aGVyZSBhcmUgbm8gam9p\nbnMgaW52b2x2ZWQgb3Igd2UncmUgdXNpbmcgYSBmcm9tIHNlbGVjdCBzbwog\nICAgICAgIC8vIHRoYXQgYWxsIGNvbHMgYWxyZWFkeSBoYXZlIHVuaXF1ZSBh\nbGlhc2VzLCBjYW4gdXNlIHN1cGVyCiAgICAgICAgaWYgKHNlbC5nZXRGcm9t\nU2VsZWN0KCkgIT0gbnVsbCB8fCBzZWwuZ2V0VGFibGVBbGlhc2VzKCkuc2l6\nZSgpIDwgMikKICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmdldFNlbGVjdHMo\nc2VsLCBkaXN0aW5jdElkZW50aWZpZXJzLCBmb3JVcGRhdGUpOwoKICAgICAg\nICAvLyBzaW5jZSBub25lIG9mIHRoZSBjb25kaXRpb25zIGFib3ZlIHdlcmUg\nbWV0LCB3ZSdyZSBkZWFsaW5nIHdpdGgKICAgICAgICAvLyBhIHNlbGVjdCB0\naGF0IHVzZXMgam9pbnMgYW5kIHJlcXVpcmVzIHN1YnNlbGVjdHMgdG8gc2Vs\nZWN0IHRoZQogICAgICAgIC8vIHByb3BlciByYW5nZTsgYWxpYXMgYWxsIGNv\nbHVtbiB2YWx1ZXMgc28gdGhhdCB0aGV5IGFyZSB1bmlxdWUgd2l0aGluCiAg\nICAgICAgLy8gdGhlIHN1YnNlbGVjdAogICAgICAgIFNRTEJ1ZmZlciBzZWxl\nY3RTUUwgPSBuZXcgU1FMQnVmZmVyKHRoaXMpOwogICAgICAgIExpc3QgYWxp\nYXNlczsKICAgICAgICBpZiAoZGlzdGluY3RJZGVudGlmaWVycykKICAgICAg\nICAgICAgYWxpYXNlcyA9IHNlbC5nZXRJZGVudGlmaWVyQWxpYXNlcygpOwog\nICAgICAgIGVsc2UKICAgICAgICAgICAgYWxpYXNlcyA9IHNlbC5nZXRTZWxl\nY3RBbGlhc2VzKCk7CgogICAgICAgIE9iamVjdCBhbGlhczsKICAgICAgICBp\nbnQgaSA9IDA7CiAgICAgICAgZm9yIChJdGVyYXRvciBpdHIgPSBhbGlhc2Vz\nLml0ZXJhdG9yKCk7IGl0ci5oYXNOZXh0KCk7IGkrKykgewogICAgICAgICAg\nICBhbGlhcyA9IGl0ci5uZXh0KCk7CiAgICAgICAgICAgIGlmIChhbGlhcyBp\nbnN0YW5jZW9mIFNRTEJ1ZmZlcikKICAgICAgICAgICAgICAgIHNlbGVjdFNR\nTC5hcHBlbmQoKFNRTEJ1ZmZlcikgYWxpYXMpOwogICAgICAgICAgICBlbHNl\nCiAgICAgICAgICAgICAgICBzZWxlY3RTUUwuYXBwZW5kKGFsaWFzLnRvU3Ry\naW5nKCkpOwogICAgICAgICAgICBzZWxlY3RTUUwuYXBwZW5kKCIgQVMgYyIp\nLmFwcGVuZChTdHJpbmcudmFsdWVPZihpKSk7CiAgICAgICAgICAgIGlmIChp\ndHIuaGFzTmV4dCgpKQogICAgICAgICAgICAgICAgc2VsZWN0U1FMLmFwcGVu\nZCgiLCAiKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHNlbGVjdFNRTDsK\nICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBjYW5PdXRlckpvaW4oaW50IHN5\nbnRheCwgRm9yZWlnbktleSBmaykgewogICAgICAgIGlmICghc3VwZXIuY2Fu\nT3V0ZXJKb2luKHN5bnRheCwgZmspKQogICAgICAgICAgICByZXR1cm4gZmFs\nc2U7CiAgICAgICAgaWYgKGZrICE9IG51bGwgJiYgc3ludGF4ID09IFNZTlRB\nWF9EQVRBQkFTRSkgewogICAgICAgICAgICBpZiAoZmsuZ2V0Q29uc3RhbnRz\nKCkubGVuZ3RoID4gMCkKICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsK\nICAgICAgICAgICAgaWYgKGZrLmdldFByaW1hcnlLZXlDb25zdGFudHMoKS5s\nZW5ndGggPiAwKQogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAg\nICAgIH0KICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBwdWJsaWMg\nU1FMQnVmZmVyIHRvTmF0aXZlSm9pbihKb2luIGpvaW4pIHsKICAgICAgICBp\nZiAoam9pbi5nZXRUeXBlKCkgIT0gSm9pbi5UWVBFX09VVEVSKQogICAgICAg\nICAgICByZXR1cm4gdG9UcmFkaXRpb25hbEpvaW4oam9pbik7CgogICAgICAg\nIEZvcmVpZ25LZXkgZmsgPSBqb2luLmdldEZvcmVpZ25LZXkoKTsKICAgICAg\nICBpZiAoZmsgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIG51bGw7Cgog\nICAgICAgIGJvb2xlYW4gaW52ZXJzZSA9IGpvaW4uaXNGb3JlaWduS2V5SW52\nZXJzZWQoKTsKICAgICAgICBDb2x1bW5bXSBmcm9tID0gKGludmVyc2UpID8g\nZmsuZ2V0UHJpbWFyeUtleUNvbHVtbnMoKQogICAgICAgICAgICA6IGZrLmdl\ndENvbHVtbnMoKTsKICAgICAgICBDb2x1bW5bXSB0byA9IChpbnZlcnNlKSA/\nIGZrLmdldENvbHVtbnMoKQogICAgICAgICAgICA6IGZrLmdldFByaW1hcnlL\nZXlDb2x1bW5zKCk7CgogICAgICAgIC8vIGRvIGNvbHVtbiBqb2lucwogICAg\nICAgIFNRTEJ1ZmZlciBidWYgPSBuZXcgU1FMQnVmZmVyKHRoaXMpOwogICAg\nICAgIGludCBjb3VudCA9IDA7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkg\nPCBmcm9tLmxlbmd0aDsgaSsrLCBjb3VudCsrKSB7CiAgICAgICAgICAgIGlm\nIChjb3VudCA+IDApCiAgICAgICAgICAgICAgICBidWYuYXBwZW5kKCIgQU5E\nICIpOwogICAgICAgICAgICBidWYuYXBwZW5kKGpvaW4uZ2V0QWxpYXMxKCkp\nLmFwcGVuZCgiLiIpLmFwcGVuZChmcm9tW2ldKTsKICAgICAgICAgICAgYnVm\nLmFwcGVuZCgiID0gIik7CiAgICAgICAgICAgIGJ1Zi5hcHBlbmQoam9pbi5n\nZXRBbGlhczIoKSkuYXBwZW5kKCIuIikuYXBwZW5kKHRvW2ldKTsKICAgICAg\nICAgICAgYnVmLmFwcGVuZCgiKCspIik7CiAgICAgICAgfQoKICAgICAgICAv\nLyBjaGVjayBjb25zdGFudCBqb2lucwogICAgICAgIGlmIChmay5nZXRDb25z\ndGFudENvbHVtbnMoKS5sZW5ndGggPiAwKQogICAgICAgICAgICB0aHJvdyBu\nZXcgU3RvcmVFeGNlcHRpb24oX2xvYy5nZXQoIm9yYWNsZS1jb25zdGFudCIs\nCiAgICAgICAgICAgICAgICBqb2luLmdldFRhYmxlMSgpLCBqb2luLmdldFRh\nYmxlMigpKSkuc2V0RmF0YWwodHJ1ZSk7CgogICAgICAgIGlmIChmay5nZXRD\nb25zdGFudFByaW1hcnlLZXlDb2x1bW5zKCkubGVuZ3RoID4gMCkKICAgICAg\nICAgICAgdGhyb3cgbmV3IFN0b3JlRXhjZXB0aW9uKF9sb2MuZ2V0KCJvcmFj\nbGUtY29uc3RhbnQiLAogICAgICAgICAgICAgICAgam9pbi5nZXRUYWJsZTEo\nKSwgam9pbi5nZXRUYWJsZTIoKSkpLnNldEZhdGFsKHRydWUpOwogICAgICAg\nIHJldHVybiBidWY7CiAgICB9CgogICAgcHVibGljIFNRTEJ1ZmZlciB0b1Nl\nbGVjdChTUUxCdWZmZXIgc2VsZWN0LCBKREJDRmV0Y2hDb25maWd1cmF0aW9u\nIGZldGNoLAogICAgICAgIFNRTEJ1ZmZlciB0YWJsZXMsIFNRTEJ1ZmZlciB3\naGVyZSwgU1FMQnVmZmVyIGdyb3VwLAogICAgICAgIFNRTEJ1ZmZlciBoYXZp\nbmcsIFNRTEJ1ZmZlciBvcmRlciwKICAgICAgICBib29sZWFuIGRpc3RpbmN0\nLCBib29sZWFuIGZvclVwZGF0ZSwgbG9uZyBzdGFydCwgbG9uZyBlbmQsCiAg\nICAgICAgU2VsZWN0IHNlbCkgewogICAgICAgIGlmICghX2NoZWNrZWRVcGRh\ndGVCdWcpIHsKICAgICAgICAgICAgZW5zdXJlRHJpdmVyVmVuZG9yKCk7CiAg\nICAgICAgICAgIGlmIChmb3JVcGRhdGUgJiYgX2RyaXZlckJlaGF2aW9yID09\nIEJFSEFWRV9EQVRBRElSRUNUMzEpCiAgICAgICAgICAgICAgICBsb2cud2Fy\nbihfbG9jLmdldCgiZGQtbG9jay1idWciKSk7CiAgICAgICAgICAgIF9jaGVj\na2VkVXBkYXRlQnVnID0gdHJ1ZTsKICAgICAgICB9CgogICAgICAgIC8vIGlm\nIG5vIHJhbmdlLCB1c2Ugc3RhbmRhcmQgc2VsZWN0CiAgICAgICAgaWYgKHN0\nYXJ0ID09IDAgJiYgZW5kID09IExvbmcuTUFYX1ZBTFVFKQogICAgICAgICAg\nICByZXR1cm4gc3VwZXIudG9TZWxlY3Qoc2VsZWN0LCBmZXRjaCwgdGFibGVz\nLCB3aGVyZSwgZ3JvdXAsIGhhdmluZywKICAgICAgICAgICAgICAgIG9yZGVy\nLCBkaXN0aW5jdCwgZm9yVXBkYXRlLCAwLCBMb25nLk1BWF9WQUxVRSwgc2Vs\nKTsKCiAgICAgICAgLy8gaWYgbm8gc2tpcCwgb3JkZXJpbmcsIG9yIGRpc3Rp\nbmN0IGNhbiB1c2Ugcm93bnVtIGRpcmVjdGx5CiAgICAgICAgU1FMQnVmZmVy\nIGJ1ZiA9IG5ldyBTUUxCdWZmZXIodGhpcyk7CiAgICAgICAgaWYgKCFyZXF1\naXJlc1N1YnNlbGVjdEZvclJhbmdlKHN0YXJ0LCBlbmQsIGRpc3RpbmN0LCBv\ncmRlcikpIHsKICAgICAgICAgICAgaWYgKHdoZXJlICE9IG51bGwgJiYgIXdo\nZXJlLmlzRW1wdHkoKSkKICAgICAgICAgICAgICAgIGJ1Zi5hcHBlbmQod2hl\ncmUpLmFwcGVuZCgiIEFORCAiKTsKICAgICAgICAgICAgYnVmLmFwcGVuZCgi\nUk9XTlVNIDw9ICIpLmFwcGVuZFZhbHVlKGVuZCk7CiAgICAgICAgICAgIHJl\ndHVybiBzdXBlci50b1NlbGVjdChzZWxlY3QsIGZldGNoLCB0YWJsZXMsIGJ1\nZiwgZ3JvdXAsIGhhdmluZywKICAgICAgICAgICAgICAgIG9yZGVyLCBkaXN0\naW5jdCwgZm9yVXBkYXRlLCAwLCBMb25nLk1BWF9WQUxVRSwgc2VsKTsKICAg\nICAgICB9CgogICAgICAgIC8vIGlmIHRoZXJlIGlzIG9yZGVyaW5nLCBza2lw\nLCBvciBkaXN0aW5jdCB3ZSBoYXZlIHRvIHVzZSBzdWJzZWxlY3RzCiAgICAg\nICAgU1FMQnVmZmVyIG5ld3NlbCA9IHN1cGVyLnRvU2VsZWN0KHNlbGVjdCwg\nZmV0Y2gsIHRhYmxlcywgd2hlcmUsCiAgICAgICAgICAgIGdyb3VwLCBoYXZp\nbmcsIG9yZGVyLCBkaXN0aW5jdCwgZm9yVXBkYXRlLCAwLCBMb25nLk1BWF9W\nQUxVRSwKICAgICAgICAgICAgc2VsKTsKCiAgICAgICAgLy8gaWYgbm8gc2tp\ncCwgY2FuIHVzZSBzaW5nbGUgbmVzdGVkIHN1YnNlbGVjdAogICAgICAgIGlm\nIChzdGFydCA9PSAwKSB7CiAgICAgICAgICAgIGJ1Zi5hcHBlbmQoZ2V0U2Vs\nZWN0T3BlcmF0aW9uKGZldGNoKSArICIgKiBGUk9NICgiKTsKICAgICAgICAg\nICAgYnVmLmFwcGVuZChuZXdzZWwpOwogICAgICAgICAgICBidWYuYXBwZW5k\nKCIpIFdIRVJFIFJPV05VTSA8PSAiKS5hcHBlbmRWYWx1ZShlbmQpOwogICAg\nICAgICAgICByZXR1cm4gYnVmOwogICAgICAgIH0KCiAgICAgICAgLy8gd2l0\naCBhIHNraXAsIHdlIGhhdmUgdG8gdXNlIGEgZG91YmxlLW5lc3RlZCBzdWJz\nZWxlY3QgdG8gcHV0CiAgICAgICAgLy8gd2hlcmUgY29uZGl0aW9ucyBvbiB0\naGUgcm93bnVtCiAgICAgICAgYnVmLmFwcGVuZChnZXRTZWxlY3RPcGVyYXRp\nb24oZmV0Y2gpCiAgICAgICAgICAgICsgIiAqIEZST00gKFNFTEVDVCByLios\nIFJPV05VTSBSTlVNIEZST00gKCIpOwogICAgICAgIGJ1Zi5hcHBlbmQobmV3\nc2VsKTsKICAgICAgICBidWYuYXBwZW5kKCIpIHIiKTsKICAgICAgICBpZiAo\nZW5kICE9IExvbmcuTUFYX1ZBTFVFKQogICAgICAgICAgICBidWYuYXBwZW5k\nKCIgV0hFUkUgUk9XTlVNIDw9ICIpLmFwcGVuZFZhbHVlKGVuZCk7CiAgICAg\nICAgYnVmLmFwcGVuZCgiKSBXSEVSRSBSTlVNID4gIikuYXBwZW5kVmFsdWUo\nc3RhcnQpOwogICAgICAgIHJldHVybiBidWY7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBSZXR1cm4gdHJ1ZSBpZiB0aGUgc2VsZWN0IHdpdGggdGhlIGdpdmVu\nIHBhcmFtZXRlcnMgbmVlZHMgYQogICAgICogc3Vic2VsZWN0IHRvIGFwcGx5\nIGEgcmFuZ2UuCiAgICAgKi8KICAgIHByaXZhdGUgYm9vbGVhbiByZXF1aXJl\nc1N1YnNlbGVjdEZvclJhbmdlKGxvbmcgc3RhcnQsIGxvbmcgZW5kLAogICAg\nICAgIGJvb2xlYW4gZGlzdGluY3QsIFNRTEJ1ZmZlciBvcmRlcikgewogICAg\nICAgIGlmIChzdGFydCA9PSAwICYmIGVuZCA9PSBMb25nLk1BWF9WQUxVRSkK\nICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIHJldHVybiBzdGFy\ndCAhPSAwIHx8IGRpc3RpbmN0IHx8IChvcmRlciAhPSBudWxsICYmICFvcmRl\nci5pc0VtcHR5KCkpOwogICAgfQoKICAgIC8qKgogICAgICogQ2hlY2sgdG8g\nc2VlIGlmIHdlIGhhdmUgc2V0IHRoZSB7QGxpbmsgI1NFTEVDVF9ISU5UfSBp\nbiB0aGUKICAgICAqIGZldGNoIGNvbmZpZ3VyYWl0b24sIGFuZCBpZiBzbywg\nYXBwZW5kIHRoZSBPcmFjaGUgaGludCBhZnRlciB0aGUKICAgICAqICJTRUxF\nQ1QiIHBhcnQgb2YgdGhlIHF1ZXJ5LgogICAgICovCiAgICBwdWJsaWMgU3Ry\naW5nIGdldFNlbGVjdE9wZXJhdGlvbihKREJDRmV0Y2hDb25maWd1cmF0aW9u\nIGZldGNoKSB7CiAgICAgICAgT2JqZWN0IGhpbnQgPSBmZXRjaCA9PSBudWxs\nID8gbnVsbCA6IGZldGNoLmdldEhpbnQoU0VMRUNUX0hJTlQpOwogICAgICAg\nIFN0cmluZyBzZWxlY3QgPSAiU0VMRUNUIjsKICAgICAgICBpZiAoaGludCAh\nPSBudWxsKQogICAgICAgICAgICBzZWxlY3QgKz0gIiAiICsgaGludDsKICAg\nICAgICByZXR1cm4gc2VsZWN0OwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHN1\nYnN0cmluZyhTUUxCdWZmZXIgYnVmLCBGaWx0ZXJWYWx1ZSBzdHIsIEZpbHRl\nclZhbHVlIHN0YXJ0LAogICAgICAgIEZpbHRlclZhbHVlIGVuZCkgewogICAg\nICAgIGJ1Zi5hcHBlbmQoIlNVQlNUUigiKTsKICAgICAgICBzdHIuYXBwZW5k\nVG8oYnVmKTsKICAgICAgICBidWYuYXBwZW5kKCIsICgiKTsKICAgICAgICBz\ndGFydC5hcHBlbmRUbyhidWYpOwogICAgICAgIGJ1Zi5hcHBlbmQoIiArIDEp\nIik7CiAgICAgICAgaWYgKGVuZCAhPSBudWxsKSB7CiAgICAgICAgICAgIGJ1\nZi5hcHBlbmQoIiwgKCIpOwogICAgICAgICAgICBlbmQuYXBwZW5kVG8oYnVm\nKTsKICAgICAgICAgICAgYnVmLmFwcGVuZCgiIC0gIik7CiAgICAgICAgICAg\nIHN0YXJ0LmFwcGVuZFRvKGJ1Zik7CiAgICAgICAgICAgIGJ1Zi5hcHBlbmQo\nIikiKTsKICAgICAgICB9CiAgICAgICAgYnVmLmFwcGVuZCgiKSIpOwogICAg\nfQoKICAgIHB1YmxpYyB2b2lkIHNldFN0cmluZyhQcmVwYXJlZFN0YXRlbWVu\ndCBzdG1udCwgaW50IGlkeCwgU3RyaW5nIHZhbCwKICAgICAgICBDb2x1bW4g\nY29sKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIC8v\nIG9yYWNsZSBOQ0hBUi9OVkFSQ0hBUi9OQ0xPQiB1bmljb2RlIGNvbHVtbnMg\ncmVxdWlyZSBzb21lCiAgICAgICAgLy8gc3BlY2lhbCBoYW5kbGluZyB0byBj\nb25maWd1cmUgdGhlbSBjb3JyZWN0bHk7IHNlZToKICAgICAgICAvLyBodHRw\nOi8vd3d3Lm9yYWNsZS5jb20vdGVjaG5vbG9neS9zYW1wbGVfY29kZS90ZWNo\nL2phdmEvCiAgICAgICAgLy8gc3Fsal9qZGJjL2ZpbGVzLzlpX2pkYmMvTkNI\nQVJzdXBwb3J0NFVuaWNvZGVTYW1wbGUvUmVhZG1lLmh0bWwKICAgICAgICBT\ndHJpbmcgdHlwZU5hbWUgPSAoY29sID09IG51bGwpID8gbnVsbCA6IGNvbC5n\nZXRUeXBlTmFtZSgpOwogICAgICAgIGlmICh1c2VTZXRGb3JtT2ZVc2VGb3JV\nbmljb2RlICYmIHR5cGVOYW1lICE9IG51bGwgJiYKICAgICAgICAgICAgKHR5\ncGVOYW1lLnRvTG93ZXJDYXNlKCkuc3RhcnRzV2l0aCgibnZhcmNoYXIiKSB8\nfAogICAgICAgICAgICAgICAgdHlwZU5hbWUudG9Mb3dlckNhc2UoKS5zdGFy\ndHNXaXRoKCJuY2hhciIpIHx8CiAgICAgICAgICAgICAgICB0eXBlTmFtZS50\nb0xvd2VyQ2FzZSgpLnN0YXJ0c1dpdGgoIm5jbG9iIikpKSB7CiAgICAgICAg\nICAgIFN0YXRlbWVudCBpbm5lciA9IHN0bW50OwogICAgICAgICAgICBpZiAo\naW5uZXIgaW5zdGFuY2VvZiBEZWxlZ2F0aW5nUHJlcGFyZWRTdGF0ZW1lbnQp\nCiAgICAgICAgICAgICAgICBpbm5lciA9ICgoRGVsZWdhdGluZ1ByZXBhcmVk\nU3RhdGVtZW50KSBpbm5lcikuCiAgICAgICAgICAgICAgICAgICAgZ2V0SW5u\nZXJtb3N0RGVsZWdhdGUoKTsKICAgICAgICAgICAgaWYgKGlzT3JhY2xlUHJl\ncGFyZWRTdGF0ZW1lbnQoaW5uZXIpKSB7CiAgICAgICAgICAgICAgICB0cnkg\newogICAgICAgICAgICAgICAgICAgIGlubmVyLmdldENsYXNzKCkuZ2V0TWV0\naG9kKCJzZXRGb3JtT2ZVc2UiLAogICAgICAgICAgICAgICAgICAgICAgICBu\nZXcgQ2xhc3NbXXsgaW50LmNsYXNzLCBzaG9ydC5jbGFzcyB9KS4KICAgICAg\nICAgICAgICAgICAgICAgICAgaW52b2tlKGlubmVyLAogICAgICAgICAgICAg\nICAgICAgICAgICAgICAgbmV3IE9iamVjdFtdewogICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgIG5ldyBJbnRlZ2VyKGlkeCksCiAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgQ2xhc3MuZm9yTmFtZQogICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAoIm9yYWNsZS5qZGJjLk9yYWNs\nZVByZXBhcmVkU3RhdGVtZW50IikuCiAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgIGdldEZpZWxkKCJGT1JNX05DSEFSIikuZ2V0KG51bGwp\nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAg\nICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB9IGNhdGNoIChFeGNl\ncHRpb24gZSkgewogICAgICAgICAgICAgICAgICAgIGxvZy53YXJuKGUpOwog\nICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGVsc2UgaWYgKCFfd2Fy\nbmVkTmNoYXJDb2x1bW4gJiYgbG9nLmlzV2FybkVuYWJsZWQoKSkgewogICAg\nICAgICAgICAgICAgX3dhcm5lZE5jaGFyQ29sdW1uID0gdHJ1ZTsKICAgICAg\nICAgICAgICAgIGxvZy53YXJuKF9sb2MuZ2V0KCJ1bmNvbmZpZ3VyZWQtbmNo\nYXItY29scyIpKTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAg\nLy8gY2FsbCBzZXRGaXhlZENIQVIgZm9yIGZpeGVkIHdpZHRoIGNoYXJhY3Rl\nciBjb2x1bW5zIHRvIGdldCBwYWRkaW5nCiAgICAgICAgLy8gc2VtYW50aWNz\nCiAgICAgICAgaWYgKGNvbCAhPSBudWxsICYmIGNvbC5nZXRUeXBlKCkgPT0g\nVHlwZXMuQ0hBUgogICAgICAgICAgICAmJiB2YWwgIT0gbnVsbCAmJiB2YWwu\nbGVuZ3RoKCkgIT0gY29sLmdldFNpemUoKSkgewogICAgICAgICAgICBTdGF0\nZW1lbnQgaW5uZXIgPSBzdG1udDsKICAgICAgICAgICAgaWYgKGlubmVyIGlu\nc3RhbmNlb2YgRGVsZWdhdGluZ1ByZXBhcmVkU3RhdGVtZW50KQogICAgICAg\nICAgICAgICAgaW5uZXIgPSAoKERlbGVnYXRpbmdQcmVwYXJlZFN0YXRlbWVu\ndCkgaW5uZXIpLgogICAgICAgICAgICAgICAgICAgIGdldElubmVybW9zdERl\nbGVnYXRlKCk7CiAgICAgICAgICAgIGlmIChpc09yYWNsZVByZXBhcmVkU3Rh\ndGVtZW50KGlubmVyKSkgewogICAgICAgICAgICAgICAgdHJ5IHsKICAgICAg\nICAgICAgICAgICAgICBpbm5lci5nZXRDbGFzcygpLmdldE1ldGhvZCgic2V0\nRml4ZWRDSEFSIiwKICAgICAgICAgICAgICAgICAgICAgICAgbmV3IENsYXNz\nW117IGludC5jbGFzcywgU3RyaW5nLmNsYXNzIH0pLgogICAgICAgICAgICAg\nICAgICAgICAgICBpbnZva2UoaW5uZXIsIG5ldyBPYmplY3RbXXsgbmV3IElu\ndGVnZXIoaWR4KSwgdmFsIH0pOwogICAgICAgICAgICAgICAgICAgIHJldHVy\nbjsKICAgICAgICAgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAg\nICAgICAgICAgICAgICAgICAgbG9nLndhcm4oZSk7CiAgICAgICAgICAgICAg\nICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmICghX3dhcm5lZENo\nYXJDb2x1bW4gJiYgbG9nLmlzV2FybkVuYWJsZWQoKSkgewogICAgICAgICAg\nICAgICAgX3dhcm5lZENoYXJDb2x1bW4gPSB0cnVlOwogICAgICAgICAgICAg\nICAgbG9nLndhcm4oX2xvYy5nZXQoInVucGFkZGVkLWNoYXItY29scyIpKTsK\nICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBzdXBlci5zZXRTdHJp\nbmcoc3RtbnQsIGlkeCwgdmFsLCBjb2wpOwogICAgfQoKICAgIHB1YmxpYyB2\nb2lkIHNldE51bGwoUHJlcGFyZWRTdGF0ZW1lbnQgc3RtbnQsIGludCBpZHgs\nIGludCBjb2xUeXBlLAogICAgICAgIENvbHVtbiBjb2wpCiAgICAgICAgdGhy\nb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgaWYgKGNvbFR5cGUgPT0gVHlw\nZXMuQkxPQiAmJiBfZHJpdmVyQmVoYXZpb3IgPT0gQkVIQVZFX09SQUNMRSkK\nICAgICAgICAgICAgc3RtbnQuc2V0QmxvYihpZHgsIGdldEVtcHR5QmxvYigp\nKTsKICAgICAgICBlbHNlIGlmIChjb2xUeXBlID09IFR5cGVzLkNMT0IgJiYg\nX2RyaXZlckJlaGF2aW9yID09IEJFSEFWRV9PUkFDTEUKICAgICAgICAgICAg\nJiYgIWNvbC5pc1hNTCgpKQogICAgICAgICAgICBzdG1udC5zZXRDbG9iKGlk\neCwgZ2V0RW1wdHlDbG9iKCkpOwogICAgICAgIGVsc2UgaWYgKChjb2xUeXBl\nID09IFR5cGVzLlNUUlVDVCB8fCBjb2xUeXBlID09IFR5cGVzLk9USEVSKQog\nICAgICAgICAgICAmJiBjb2wgIT0gbnVsbCAmJiBjb2wuZ2V0VHlwZU5hbWUo\nKSAhPSBudWxsKQogICAgICAgICAgICBzdG1udC5zZXROdWxsKGlkeCwgVHlw\nZXMuU1RSVUNULCBjb2wuZ2V0VHlwZU5hbWUoKSk7CiAgICAgICAgICAgIC8v\nIHNvbWUgdmVyc2lvbnMgb2YgdGhlIE9yYWNsZSBKREJDIGRyaXZlciB3aWxs\nIGZhaWwgaWYgY2FsbGluZwogICAgICAgICAgICAvLyBzZXROdWxsIHdpdGgg\nREFURTsgc2VlIGJ1ZyAjMTE3MQogICAgICAgIGVsc2UgaWYgKGNvbFR5cGUg\nPT0gVHlwZXMuREFURSkKICAgICAgICAgICAgc3VwZXIuc2V0TnVsbChzdG1u\ndCwgaWR4LCBUeXBlcy5USU1FU1RBTVAsIGNvbCk7CiAgICAgICAgLy8gdGhl\nIE9yYWNsZSBkcml2ZXIgZG9lcyBub3Qgc3VwcG9ydCBUeXBlcy5PVEhFUiB3\naXRoIHNldE51bGwKICAgICAgICBlbHNlIGlmIChjb2xUeXBlID09IFR5cGVz\nLk9USEVSIHx8IGNvbC5pc1hNTCgpKQogICAgICAgICAgICBzdXBlci5zZXRO\ndWxsKHN0bW50LCBpZHgsIFR5cGVzLk5VTEwsIGNvbCk7CiAgICAgICAgZWxz\nZQogICAgICAgICAgICBzdXBlci5zZXROdWxsKHN0bW50LCBpZHgsIGNvbFR5\ncGUsIGNvbCk7CiAgICB9CgogICAgcHVibGljIFN0cmluZyBnZXRDbG9iU3Ry\naW5nKFJlc3VsdFNldCBycywgaW50IGNvbHVtbikKICAgICAgICB0aHJvd3Mg\nU1FMRXhjZXB0aW9uIHsKICAgICAgICBpZiAoX2RyaXZlckJlaGF2aW9yICE9\nIEJFSEFWRV9PUkFDTEUpCiAgICAgICAgICAgIHJldHVybiBzdXBlci5nZXRD\nbG9iU3RyaW5nKHJzLCBjb2x1bW4pOwoKICAgICAgICBDbG9iIGNsb2IgPSBn\nZXRDbG9iKHJzLCBjb2x1bW4pOwogICAgICAgIGlmIChjbG9iID09IG51bGwp\nCiAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgIGlmIChjbG9iLmdl\ndENsYXNzKCkuZ2V0TmFtZSgpLmVxdWFscygib3JhY2xlLnNxbC5DTE9CIikp\nIHsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIGlmICgoKEJv\nb2xlYW4pIENsYXNzLmZvck5hbWUoIm9yYWNsZS5zcWwuQ0xPQiIpLgogICAg\nICAgICAgICAgICAgICAgIGdldE1ldGhvZCgiaXNFbXB0eUxvYiIsIG5ldyBD\nbGFzc1swXSkuCiAgICAgICAgICAgICAgICAgICAgaW52b2tlKGNsb2IsIG5l\ndyBPYmplY3RbMF0pKS4KICAgICAgICAgICAgICAgICAgICBib29sZWFuVmFs\ndWUoKSkKICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAg\nICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgICAg\nIC8vIHBvc3NpYmx5IGRpZmZlcmVudCB2ZXJzaW9uIG9mIHRoZSBkcml2ZXIK\nICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBpZiAoY2xvYi5sZW5n\ndGgoKSA9PSAwKQogICAgICAgICAgICByZXR1cm4gbnVsbDsKCiAgICAgICAg\nLy8gdW5saWtlbHkgdGhhdCB3ZSdsbCBoYXZlIHN0cmluZ3Mgb3ZlciA0IGJp\nbGxpb24gY2hhcnMKICAgICAgICByZXR1cm4gY2xvYi5nZXRTdWJTdHJpbmco\nMSwgKGludCkgY2xvYi5sZW5ndGgoKSk7CiAgICB9CgogICAgcHVibGljIFRp\nbWVzdGFtcCBnZXRUaW1lc3RhbXAoUmVzdWx0U2V0IHJzLCBpbnQgY29sdW1u\nLCBDYWxlbmRhciBjYWwpCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7\nCiAgICAgICAgaWYgKGNhbCA9PSBudWxsKSB7CiAgICAgICAgICAgIHRyeSB7\nCiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZ2V0VGltZXN0YW1wKHJz\nLCBjb2x1bW4sIGNhbCk7CiAgICAgICAgICAgIH0gY2F0Y2ggKEFycmF5SW5k\nZXhPdXRPZkJvdW5kc0V4Y2VwdGlvbiBhZSkgewogICAgICAgICAgICAgICAg\nLy8gQ1IyOTU2MDQ6IGlzc3VlIGEgd2FybmluZyB0aGlzIHRoaXMgYnVnIGNh\nbiBiZSBnb3R0ZW4KICAgICAgICAgICAgICAgIC8vIGFyb3VuZCB3aXRoIFN1\ncHBvcnRzVGltZXN0YW1wTmFub3M9ZmFsc2UKICAgICAgICAgICAgICAgIGxv\nZy53YXJuKF9sb2MuZ2V0KCJvcmFjbGUtdGltZXN0YW1wLWJ1ZyIpLCBhZSk7\nCiAgICAgICAgICAgICAgICB0aHJvdyBhZTsKICAgICAgICAgICAgfQogICAg\nICAgIH0KCiAgICAgICAgLy8gaGFuZGxlIE9yYWNsZSBidWcgd2hlcmUgbmFu\nb3Mgbm90IHJldHVybmVkIGZyb20gY2FsbCB3aXRoIENhbGVuZGFyCiAgICAg\nICAgLy8gcGFyYW1ldGVyCiAgICAgICAgVGltZXN0YW1wIHRzID0gcnMuZ2V0\nVGltZXN0YW1wKGNvbHVtbiwgY2FsKTsKICAgICAgICBpZiAodHMgIT0gbnVs\nbCAmJiB0cy5nZXROYW5vcygpID09IDApCiAgICAgICAgICAgIHRzLnNldE5h\nbm9zKHJzLmdldFRpbWVzdGFtcChjb2x1bW4pLmdldE5hbm9zKCkpOwogICAg\nICAgIHJldHVybiB0czsKICAgIH0KCiAgICBwdWJsaWMgT2JqZWN0IGdldE9i\namVjdChSZXN1bHRTZXQgcnMsIGludCBjb2x1bW4sIE1hcCBtYXApCiAgICAg\nICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgLy8gcmVjZW50IG9y\nYWNsZSBkcml2ZXJzIHJldHVybiBvcmFjbGUtc3BlY2lmaWMgdHlwZXMgZm9y\nIHRpbWVzdGFtcHMKICAgICAgICAvLyBhbmQgZGF0ZXMKICAgICAgICBPYmpl\nY3Qgb2JqID0gc3VwZXIuZ2V0T2JqZWN0KHJzLCBjb2x1bW4sIG1hcCk7CiAg\nICAgICAgaWYgKG9iaiA9PSBudWxsKQogICAgICAgICAgICByZXR1cm4gbnVs\nbDsKICAgICAgICBpZiAoIm9yYWNsZS5zcWwuREFURSIuZXF1YWxzKG9iai5n\nZXRDbGFzcygpLmdldE5hbWUoKSkpCiAgICAgICAgICAgIG9iaiA9IGNvbnZl\ncnRGcm9tT3JhY2xlVHlwZShvYmosICJkYXRlVmFsdWUiKTsKICAgICAgICBl\nbHNlIGlmICgib3JhY2xlLnNxbC5USU1FU1RBTVAiLmVxdWFscyhvYmouZ2V0\nQ2xhc3MoKS5nZXROYW1lKCkpKQogICAgICAgICAgICBvYmogPSBjb252ZXJ0\nRnJvbU9yYWNsZVR5cGUob2JqLCAidGltZXN0YW1wVmFsdWUiKTsKICAgICAg\nICByZXR1cm4gb2JqOwogICAgfQoKICAgIC8qKgogICAgICogQ29udmVydCBh\nbiBvYmplY3QgZnJvbSBpdHMgcHJvcHJpZXRhcnkgT3JhY2xlIHR5cGUgdG8g\ndGhlIHN0YW5kYXJkCiAgICAgKiBKYXZhIHR5cGUuCiAgICAgKi8KICAgIHBy\naXZhdGUgc3RhdGljIE9iamVjdCBjb252ZXJ0RnJvbU9yYWNsZVR5cGUoT2Jq\nZWN0IG9iaiwKICAgICAgICBTdHJpbmcgY29udmVydE1ldGhvZCkKICAgICAg\nICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICB0cnkgewogICAgICAg\nICAgICBNZXRob2QgbSA9IG9iai5nZXRDbGFzcygpLmdldE1ldGhvZChjb252\nZXJ0TWV0aG9kLCAoQ2xhc3NbXSkgbnVsbCk7CiAgICAgICAgICAgIHJldHVy\nbiBtLmludm9rZShvYmosIChPYmplY3RbXSkgbnVsbCk7CiAgICAgICAgfSBj\nYXRjaCAoVGhyb3dhYmxlIHQpIHsKICAgICAgICAgICAgaWYgKHQgaW5zdGFu\nY2VvZiBJbnZvY2F0aW9uVGFyZ2V0RXhjZXB0aW9uKQogICAgICAgICAgICAg\nICAgdCA9ICgoSW52b2NhdGlvblRhcmdldEV4Y2VwdGlvbikgdCkuZ2V0VGFy\nZ2V0RXhjZXB0aW9uKCk7CiAgICAgICAgICAgIGlmICh0IGluc3RhbmNlb2Yg\nU1FMRXhjZXB0aW9uKQogICAgICAgICAgICAgICAgdGhyb3coU1FMRXhjZXB0\naW9uKSB0OwogICAgICAgICAgICB0aHJvdyBuZXcgU1FMRXhjZXB0aW9uKHQu\nZ2V0TWVzc2FnZSgpKTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGljIENv\nbHVtbltdIGdldENvbHVtbnMoRGF0YWJhc2VNZXRhRGF0YSBtZXRhLCBTdHJp\nbmcgY2F0YWxvZywKICAgICAgICBTdHJpbmcgc2NoZW1hTmFtZSwgU3RyaW5n\nIHRhYmxlTmFtZSwgU3RyaW5nIGNvbHVtbk5hbWUsIENvbm5lY3Rpb24gY29u\nbikKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBDb2x1\nbW5bXSBjb2xzID0gc3VwZXIuZ2V0Q29sdW1ucyhtZXRhLCBjYXRhbG9nLCBz\nY2hlbWFOYW1lLCB0YWJsZU5hbWUsCiAgICAgICAgICAgIGNvbHVtbk5hbWUs\nIGNvbm4pOwoKICAgICAgICBmb3IgKGludCBpID0gMDsgY29scyAhPSBudWxs\nICYmIGkgPCBjb2xzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGlmIChj\nb2xzW2ldLmdldFR5cGVOYW1lKCkgPT0gbnVsbCkKICAgICAgICAgICAgICAg\nIGNvbnRpbnVlOwogICAgICAgICAgICBpZiAoY29sc1tpXS5nZXRUeXBlTmFt\nZSgpLnRvVXBwZXJDYXNlKCkuc3RhcnRzV2l0aCgiVElNRVNUQU1QIikpCiAg\nICAgICAgICAgICAgICBjb2xzW2ldLnNldFR5cGUoVHlwZXMuVElNRVNUQU1Q\nKTsKICAgICAgICAgICAgZWxzZSBpZiAoIkJMT0IiLmVxdWFsc0lnbm9yZUNh\nc2UoY29sc1tpXS5nZXRUeXBlTmFtZSgpKSkKICAgICAgICAgICAgICAgIGNv\nbHNbaV0uc2V0VHlwZShUeXBlcy5CTE9CKTsKICAgICAgICAgICAgZWxzZSBp\nZiAoIkNMT0IiLmVxdWFsc0lnbm9yZUNhc2UoY29sc1tpXS5nZXRUeXBlTmFt\nZSgpKQogICAgICAgICAgICAgICAgfHwgIk5DTE9CIi5lcXVhbHNJZ25vcmVD\nYXNlKGNvbHNbaV0uZ2V0VHlwZU5hbWUoKSkpCiAgICAgICAgICAgICAgICBj\nb2xzW2ldLnNldFR5cGUoVHlwZXMuQ0xPQik7CiAgICAgICAgICAgIGVsc2Ug\naWYgKCJGTE9BVCIuZXF1YWxzSWdub3JlQ2FzZShjb2xzW2ldLmdldFR5cGVO\nYW1lKCkpKQogICAgICAgICAgICAgICAgY29sc1tpXS5zZXRUeXBlKFR5cGVz\nLkZMT0FUKTsKICAgICAgICAgICAgZWxzZSBpZiAoIk5WQVJDSEFSIi5lcXVh\nbHNJZ25vcmVDYXNlKGNvbHNbaV0uZ2V0VHlwZU5hbWUoKSkpCiAgICAgICAg\nICAgICAgICBjb2xzW2ldLnNldFR5cGUoVHlwZXMuVkFSQ0hBUik7CiAgICAg\nICAgICAgIGVsc2UgaWYgKCJOQ0hBUiIuZXF1YWxzSWdub3JlQ2FzZShjb2xz\nW2ldLmdldFR5cGVOYW1lKCkpKQogICAgICAgICAgICAgICAgY29sc1tpXS5z\nZXRUeXBlKFR5cGVzLkNIQVIpOwogICAgICAgIH0KICAgICAgICByZXR1cm4g\nY29sczsKICAgIH0KCiAgICBwdWJsaWMgUHJpbWFyeUtleVtdIGdldFByaW1h\ncnlLZXlzKERhdGFiYXNlTWV0YURhdGEgbWV0YSwKICAgICAgICBTdHJpbmcg\nY2F0YWxvZywgU3RyaW5nIHNjaGVtYU5hbWUsIFN0cmluZyB0YWJsZU5hbWUs\nIENvbm5lY3Rpb24gY29ubikKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9u\nIHsKICAgICAgICBTdHJpbmdCdWZmZXIgYnVmID0gbmV3IFN0cmluZ0J1ZmZl\ncigpOwogICAgICAgIGJ1Zi5hcHBlbmQoIlNFTEVDVCB0MC5PV05FUiBBUyBU\nQUJMRV9TQ0hFTSwgIikuCiAgICAgICAgICAgIGFwcGVuZCgidDAuVEFCTEVf\nTkFNRSBBUyBUQUJMRV9OQU1FLCAiKS4KICAgICAgICAgICAgYXBwZW5kKCJ0\nMC5DT0xVTU5fTkFNRSBBUyBDT0xVTU5fTkFNRSwgIikuCiAgICAgICAgICAg\nIGFwcGVuZCgidDAuQ09OU1RSQUlOVF9OQU1FIEFTIFBLX05BTUUgIikuCiAg\nICAgICAgICAgIGFwcGVuZCgiRlJPTSBBTExfQ09OU19DT0xVTU5TIHQwLCBB\nTExfQ09OU1RSQUlOVFMgdDEgIikuCiAgICAgICAgICAgIGFwcGVuZCgiV0hF\nUkUgdDAuT1dORVIgPSB0MS5PV05FUiAiKS4KICAgICAgICAgICAgYXBwZW5k\nKCJBTkQgdDAuQ09OU1RSQUlOVF9OQU1FID0gdDEuQ09OU1RSQUlOVF9OQU1F\nICIpLgogICAgICAgICAgICBhcHBlbmQoIkFORCB0MS5DT05TVFJBSU5UX1RZ\nUEUgPSAnUCciKTsKICAgICAgICBpZiAoc2NoZW1hTmFtZSAhPSBudWxsKQog\nICAgICAgICAgICBidWYuYXBwZW5kKCIgQU5EIHQwLk9XTkVSID0gPyIpOwog\nICAgICAgIGlmICh0YWJsZU5hbWUgIT0gbnVsbCkKICAgICAgICAgICAgYnVm\nLmFwcGVuZCgiIEFORCB0MC5UQUJMRV9OQU1FID0gPyIpOwoKICAgICAgICBQ\ncmVwYXJlZFN0YXRlbWVudCBzdG1udCA9IGNvbm4ucHJlcGFyZVN0YXRlbWVu\ndChidWYudG9TdHJpbmcoKSk7CiAgICAgICAgUmVzdWx0U2V0IHJzID0gbnVs\nbDsKICAgICAgICB0cnkgewogICAgICAgICAgICBpbnQgaWR4ID0gMTsKICAg\nICAgICAgICAgaWYgKHNjaGVtYU5hbWUgIT0gbnVsbCkKICAgICAgICAgICAg\nICAgIHNldFN0cmluZyhzdG1udCwgaWR4KyssIHNjaGVtYU5hbWUudG9VcHBl\nckNhc2UoKSwgbnVsbCk7CiAgICAgICAgICAgIGlmICh0YWJsZU5hbWUgIT0g\nbnVsbCkKICAgICAgICAgICAgICAgIHNldFN0cmluZyhzdG1udCwgaWR4Kyss\nIHRhYmxlTmFtZS50b1VwcGVyQ2FzZSgpLCBudWxsKTsKCiAgICAgICAgICAg\nIHJzID0gc3RtbnQuZXhlY3V0ZVF1ZXJ5KCk7CiAgICAgICAgICAgIExpc3Qg\ncGtMaXN0ID0gbmV3IEFycmF5TGlzdCgpOwogICAgICAgICAgICB3aGlsZSAo\ncnMgIT0gbnVsbCAmJiBycy5uZXh0KCkpCiAgICAgICAgICAgICAgICBwa0xp\nc3QuYWRkKG5ld1ByaW1hcnlLZXkocnMpKTsKICAgICAgICAgICAgcmV0dXJu\nIChQcmltYXJ5S2V5W10pIHBrTGlzdC50b0FycmF5CiAgICAgICAgICAgICAg\nICAobmV3IFByaW1hcnlLZXlbcGtMaXN0LnNpemUoKV0pOwogICAgICAgIH0g\nZmluYWxseSB7CiAgICAgICAgICAgIGlmIChycyAhPSBudWxsKQogICAgICAg\nICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICBycy5jbG9zZSgp\nOwogICAgICAgICAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAg\nICAgICAgICAgICAgIH0KICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAg\nICAgIHN0bW50LmNsb3NlKCk7CiAgICAgICAgICAgIH0gY2F0Y2ggKEV4Y2Vw\ndGlvbiBlKSB7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAg\ncHVibGljIEluZGV4W10gZ2V0SW5kZXhJbmZvKERhdGFiYXNlTWV0YURhdGEg\nbWV0YSwgU3RyaW5nIGNhdGFsb2csCiAgICAgICAgU3RyaW5nIHNjaGVtYU5h\nbWUsIFN0cmluZyB0YWJsZU5hbWUsIGJvb2xlYW4gdW5pcXVlLCBib29sZWFu\nIGFwcHJveCwKICAgICAgICBDb25uZWN0aW9uIGNvbm4pCiAgICAgICAgdGhy\nb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgU3RyaW5nQnVmZmVyIGJ1ZiA9\nIG5ldyBTdHJpbmdCdWZmZXIoKTsKICAgICAgICBidWYuYXBwZW5kKCJTRUxF\nQ1QgdDAuSU5ERVhfT1dORVIgQVMgVEFCTEVfU0NIRU0sICIpLgogICAgICAg\nICAgICBhcHBlbmQoInQwLlRBQkxFX05BTUUgQVMgVEFCTEVfTkFNRSwgIiku\nCiAgICAgICAgICAgIGFwcGVuZCgiREVDT0RFKHQxLlVOSVFVRU5FU1MsICdV\nTklRVUUnLCAwLCAnTk9OVU5JUVVFJywgMSkgIikuCiAgICAgICAgICAgIGFw\ncGVuZCgiQVMgTk9OX1VOSVFVRSwgIikuCiAgICAgICAgICAgIGFwcGVuZCgi\ndDAuSU5ERVhfTkFNRSBBUyBJTkRFWF9OQU1FLCAiKS4KICAgICAgICAgICAg\nYXBwZW5kKCJ0MC5DT0xVTU5fTkFNRSBBUyBDT0xVTU5fTkFNRSAiKS4KICAg\nICAgICAgICAgYXBwZW5kKCJGUk9NIEFMTF9JTkRfQ09MVU1OUyB0MCwgQUxM\nX0lOREVYRVMgdDEgIikuCiAgICAgICAgICAgIGFwcGVuZCgiV0hFUkUgdDAu\nSU5ERVhfT1dORVIgPSB0MS5PV05FUiAiKS4KICAgICAgICAgICAgYXBwZW5k\nKCJBTkQgdDAuSU5ERVhfTkFNRSA9IHQxLklOREVYX05BTUUiKTsKICAgICAg\nICBpZiAoc2NoZW1hTmFtZSAhPSBudWxsKQogICAgICAgICAgICBidWYuYXBw\nZW5kKCIgQU5EIHQwLlRBQkxFX09XTkVSID0gPyIpOwogICAgICAgIGlmICh0\nYWJsZU5hbWUgIT0gbnVsbCkKICAgICAgICAgICAgYnVmLmFwcGVuZCgiIEFO\nRCB0MC5UQUJMRV9OQU1FID0gPyIpOwoKICAgICAgICBQcmVwYXJlZFN0YXRl\nbWVudCBzdG1udCA9IGNvbm4ucHJlcGFyZVN0YXRlbWVudChidWYudG9TdHJp\nbmcoKSk7CiAgICAgICAgUmVzdWx0U2V0IHJzID0gbnVsbDsKICAgICAgICB0\ncnkgewogICAgICAgICAgICBpbnQgaWR4ID0gMTsKICAgICAgICAgICAgaWYg\nKHNjaGVtYU5hbWUgIT0gbnVsbCkKICAgICAgICAgICAgICAgIHNldFN0cmlu\nZyhzdG1udCwgaWR4KyssIHNjaGVtYU5hbWUudG9VcHBlckNhc2UoKSwgbnVs\nbCk7CiAgICAgICAgICAgIGlmICh0YWJsZU5hbWUgIT0gbnVsbCkKICAgICAg\nICAgICAgICAgIHNldFN0cmluZyhzdG1udCwgaWR4KyssIHRhYmxlTmFtZS50\nb1VwcGVyQ2FzZSgpLCBudWxsKTsKCiAgICAgICAgICAgIHJzID0gc3RtbnQu\nZXhlY3V0ZVF1ZXJ5KCk7CiAgICAgICAgICAgIExpc3QgaWR4TGlzdCA9IG5l\ndyBBcnJheUxpc3QoKTsKICAgICAgICAgICAgd2hpbGUgKHJzICE9IG51bGwg\nJiYgcnMubmV4dCgpKQogICAgICAgICAgICAgICAgaWR4TGlzdC5hZGQobmV3\nSW5kZXgocnMpKTsKICAgICAgICAgICAgcmV0dXJuIChJbmRleFtdKSBpZHhM\naXN0LnRvQXJyYXkobmV3IEluZGV4W2lkeExpc3Quc2l6ZSgpXSk7CiAgICAg\nICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgaWYgKHJzICE9IG51bGwpCiAg\nICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgIHJzLmNs\nb3NlKCk7CiAgICAgICAgICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkg\newogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB0cnkgewogICAgICAg\nICAgICAgICAgc3RtbnQuY2xvc2UoKTsKICAgICAgICAgICAgfSBjYXRjaCAo\nRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0K\nCiAgICBwdWJsaWMgRm9yZWlnbktleVtdIGdldEltcG9ydGVkS2V5cyhEYXRh\nYmFzZU1ldGFEYXRhIG1ldGEsIFN0cmluZyBjYXRhbG9nLAogICAgICAgIFN0\ncmluZyBzY2hlbWFOYW1lLCBTdHJpbmcgdGFibGVOYW1lLCBDb25uZWN0aW9u\nIGNvbm4pCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAg\nU3RyaW5nQnVmZmVyIGRlbEFjdGlvbiA9IG5ldyBTdHJpbmdCdWZmZXIoIkRF\nQ09ERSh0MS5ERUxFVEVfUlVMRSIpLgogICAgICAgICAgICBhcHBlbmQoIiwg\nJ05PIEFDVElPTicsICIpLmFwcGVuZChtZXRhLmltcG9ydGVkS2V5Tm9BY3Rp\nb24pLgogICAgICAgICAgICBhcHBlbmQoIiwgJ1JFU1RSSUNUJywgIikuYXBw\nZW5kKG1ldGEuaW1wb3J0ZWRLZXlSZXN0cmljdCkuCiAgICAgICAgICAgIGFw\ncGVuZCgiLCAnQ0FTQ0FERScsICIpLmFwcGVuZChtZXRhLmltcG9ydGVkS2V5\nQ2FzY2FkZSkuCiAgICAgICAgICAgIGFwcGVuZCgiLCAnU0VUIE5VTEwnLCAi\nKS5hcHBlbmQobWV0YS5pbXBvcnRlZEtleVNldE51bGwpLgogICAgICAgICAg\nICBhcHBlbmQoIiwgJ1NFVCBERUZBVUxUJywgIikuYXBwZW5kKG1ldGEuaW1w\nb3J0ZWRLZXlTZXREZWZhdWx0KS4KICAgICAgICAgICAgYXBwZW5kKCIpIik7\nCgogICAgICAgIFN0cmluZ0J1ZmZlciBidWYgPSBuZXcgU3RyaW5nQnVmZmVy\nKCk7CiAgICAgICAgYnVmLmFwcGVuZCgiU0VMRUNUIHQyLk9XTkVSIEFTIFBL\nVEFCTEVfU0NIRU0sICIpLgogICAgICAgICAgICBhcHBlbmQoInQyLlRBQkxF\nX05BTUUgQVMgUEtUQUJMRV9OQU1FLCAiKS4KICAgICAgICAgICAgYXBwZW5k\nKCJ0Mi5DT0xVTU5fTkFNRSBBUyBQS0NPTFVNTl9OQU1FLCAiKS4KICAgICAg\nICAgICAgYXBwZW5kKCJ0MC5PV05FUiBBUyBGS1RBQkxFX1NDSEVNLCAiKS4K\nICAgICAgICAgICAgYXBwZW5kKCJ0MC5UQUJMRV9OQU1FIEFTIEZLVEFCTEVf\nTkFNRSwgIikuCiAgICAgICAgICAgIGFwcGVuZCgidDAuQ09MVU1OX05BTUUg\nQVMgRktDT0xVTU5fTkFNRSwgIikuCiAgICAgICAgICAgIGFwcGVuZCgidDAu\nUE9TSVRJT04gQVMgS0VZX1NFUSwgIikuCiAgICAgICAgICAgIGFwcGVuZChk\nZWxBY3Rpb24pLmFwcGVuZCgiIEFTIERFTEVURV9SVUxFLCAiKS4KICAgICAg\nICAgICAgYXBwZW5kKCJ0MC5DT05TVFJBSU5UX05BTUUgQVMgRktfTkFNRSwg\nIikuCiAgICAgICAgICAgIGFwcGVuZCgiREVDT0RFKHQxLkRFRkVSUkVELCAn\nREVGRVJSRUQnLCAiKS4KICAgICAgICAgICAgYXBwZW5kKG1ldGEuaW1wb3J0\nZWRLZXlJbml0aWFsbHlEZWZlcnJlZCkuCiAgICAgICAgICAgIGFwcGVuZCgi\nLCAnSU1NRURJQVRFJywgIikuCiAgICAgICAgICAgIGFwcGVuZChtZXRhLmlt\ncG9ydGVkS2V5SW5pdGlhbGx5SW1tZWRpYXRlKS4KICAgICAgICAgICAgYXBw\nZW5kKCIpIEFTIERFRkVSUkFCSUxJVFkgIikuCiAgICAgICAgICAgIGFwcGVu\nZCgiRlJPTSBBTExfQ09OU19DT0xVTU5TIHQwLCBBTExfQ09OU1RSQUlOVFMg\ndDEsICIpLgogICAgICAgICAgICBhcHBlbmQoIkFMTF9DT05TX0NPTFVNTlMg\ndDIgIikuCiAgICAgICAgICAgIGFwcGVuZCgiV0hFUkUgdDAuT1dORVIgPSB0\nMS5PV05FUiAiKS4KICAgICAgICAgICAgYXBwZW5kKCJBTkQgdDAuQ09OU1RS\nQUlOVF9OQU1FID0gdDEuQ09OU1RSQUlOVF9OQU1FICIpLgogICAgICAgICAg\nICBhcHBlbmQoIkFORCB0MS5DT05TVFJBSU5UX1RZUEUgPSAnUicgIikuCiAg\nICAgICAgICAgIGFwcGVuZCgiQU5EIHQxLlJfT1dORVIgPSB0Mi5PV05FUiAi\nKS4KICAgICAgICAgICAgYXBwZW5kKCJBTkQgdDEuUl9DT05TVFJBSU5UX05B\nTUUgPSB0Mi5DT05TVFJBSU5UX05BTUUgIikuCiAgICAgICAgICAgIGFwcGVu\nZCgiQU5EIHQwLlBPU0lUSU9OID0gdDIuUE9TSVRJT04iKTsKICAgICAgICBp\nZiAoc2NoZW1hTmFtZSAhPSBudWxsKQogICAgICAgICAgICBidWYuYXBwZW5k\nKCIgQU5EIHQwLk9XTkVSID0gPyIpOwogICAgICAgIGlmICh0YWJsZU5hbWUg\nIT0gbnVsbCkKICAgICAgICAgICAgYnVmLmFwcGVuZCgiIEFORCB0MC5UQUJM\nRV9OQU1FID0gPyIpOwogICAgICAgIGJ1Zi5hcHBlbmQoIiBPUkRFUiBCWSB0\nMi5PV05FUiwgdDIuVEFCTEVfTkFNRSwgdDAuUE9TSVRJT04iKTsKCiAgICAg\nICAgUHJlcGFyZWRTdGF0ZW1lbnQgc3RtbnQgPSBjb25uLnByZXBhcmVTdGF0\nZW1lbnQoYnVmLnRvU3RyaW5nKCkpOwogICAgICAgIFJlc3VsdFNldCBycyA9\nIG51bGw7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgaW50IGlkeCA9IDE7\nCiAgICAgICAgICAgIGlmIChzY2hlbWFOYW1lICE9IG51bGwpCiAgICAgICAg\nICAgICAgICBzZXRTdHJpbmcoc3RtbnQsIGlkeCsrLCBzY2hlbWFOYW1lLnRv\nVXBwZXJDYXNlKCksIG51bGwpOwogICAgICAgICAgICBpZiAodGFibGVOYW1l\nICE9IG51bGwpCiAgICAgICAgICAgICAgICBzZXRTdHJpbmcoc3RtbnQsIGlk\neCsrLCB0YWJsZU5hbWUudG9VcHBlckNhc2UoKSwgbnVsbCk7CgogICAgICAg\nICAgICBycyA9IHN0bW50LmV4ZWN1dGVRdWVyeSgpOwogICAgICAgICAgICBM\naXN0IGZrTGlzdCA9IG5ldyBBcnJheUxpc3QoKTsKICAgICAgICAgICAgd2hp\nbGUgKHJzICE9IG51bGwgJiYgcnMubmV4dCgpKQogICAgICAgICAgICAgICAg\nZmtMaXN0LmFkZChuZXdGb3JlaWduS2V5KHJzKSk7CiAgICAgICAgICAgIHJl\ndHVybiAoRm9yZWlnbktleVtdKSBma0xpc3QudG9BcnJheQogICAgICAgICAg\nICAgICAgKG5ldyBGb3JlaWduS2V5W2ZrTGlzdC5zaXplKCldKTsKICAgICAg\nICB9IGZpbmFsbHkgewogICAgICAgICAgICBpZiAocnMgIT0gbnVsbCkKICAg\nICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgcnMuY2xv\nc2UoKTsKICAgICAgICAgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7\nCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAg\nICAgICAgICBzdG1udC5jbG9zZSgpOwogICAgICAgICAgICB9IGNhdGNoIChF\neGNlcHRpb24gZSkgewogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQoK\nICAgIHB1YmxpYyBTdHJpbmdbXSBnZXRDcmVhdGVUYWJsZVNRTChUYWJsZSB0\nYWJsZSkgewogICAgICAgIC8vIG9ubHkgb3ZlcnJpZGUgaWYgd2UgYXJlIHNp\nbXVsYXRpbmcgYXV0by1pbmNyZW1lbmV0IHdpdGggdHJpZ2dlcnMKICAgICAg\nICBTdHJpbmdbXSBjcmVhdGUgPSBzdXBlci5nZXRDcmVhdGVUYWJsZVNRTCh0\nYWJsZSk7CiAgICAgICAgaWYgKCF1c2VUcmlnZ2Vyc0ZvckF1dG9Bc3NpZ24p\nCiAgICAgICAgICAgIHJldHVybiBjcmVhdGU7CgogICAgICAgIENvbHVtbltd\nIGNvbHMgPSB0YWJsZS5nZXRDb2x1bW5zKCk7CiAgICAgICAgTGlzdCBzZXFz\nID0gbnVsbDsKICAgICAgICBTdHJpbmcgc2VxLCB0cmlnOwogICAgICAgIGZv\nciAoaW50IGkgPSAwOyBjb2xzICE9IG51bGwgJiYgaSA8IGNvbHMubGVuZ3Ro\nOyBpKyspIHsKICAgICAgICAgICAgaWYgKCFjb2xzW2ldLmlzQXV0b0Fzc2ln\nbmVkKCkpCiAgICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAg\naWYgKHNlcXMgPT0gbnVsbCkKICAgICAgICAgICAgICAgIHNlcXMgPSBuZXcg\nQXJyYXlMaXN0KDQpOwoKICAgICAgICAgICAgc2VxID0gYXV0b0Fzc2lnblNl\ncXVlbmNlTmFtZTsKICAgICAgICAgICAgaWYgKHNlcSA9PSBudWxsKSB7CiAg\nICAgICAgICAgICAgICBpZiAob3BlbmpwYTNHZW5lcmF0ZWRLZXlOYW1lcykK\nICAgICAgICAgICAgICAgICAgICBzZXEgPSBnZXRPcGVuSlBBM0dlbmVyYXRl\nZEtleVNlcXVlbmNlTmFtZShjb2xzW2ldKTsKICAgICAgICAgICAgICAgIGVs\nc2UKICAgICAgICAgICAgICAgICAgICBzZXEgPSBnZXRHZW5lcmF0ZWRLZXlT\nZXF1ZW5jZU5hbWUoY29sc1tpXSk7CiAgICAgICAgICAgICAgICBzZXFzLmFk\nZCgiQ1JFQVRFIFNFUVVFTkNFICIgKyBzZXEgKyAiIFNUQVJUIFdJVEggMSIp\nOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmIChvcGVuanBhM0dlbmVy\nYXRlZEtleU5hbWVzKQogICAgICAgICAgICAgICAgdHJpZyA9IGdldE9wZW5K\nUEEzR2VuZXJhdGVkS2V5VHJpZ2dlck5hbWUoY29sc1tpXSk7CiAgICAgICAg\nICAgIGVsc2UKICAgICAgICAgICAgICAgIHRyaWcgPSBnZXRHZW5lcmF0ZWRL\nZXlUcmlnZ2VyTmFtZShjb2xzW2ldKTsKCiAgICAgICAgICAgIC8vIGNyZWF0\nZSB0aGUgdHJpZ2dlciB0aGF0IHdpbGwgaW5zZXJ0IG5ldyB2YWx1ZXMgaW50\nbwogICAgICAgICAgICAvLyB0aGUgdGFibGUgd2hlbmV2ZXIgYSByb3cgaXMg\nY3JlYXRlZAogICAgICAgICAgICBzZXFzLmFkZCgiQ1JFQVRFIE9SIFJFUExB\nQ0UgVFJJR0dFUiAiICsgdHJpZwogICAgICAgICAgICAgICAgKyAiIEJFRk9S\nRSBJTlNFUlQgT04gIiArIHRhYmxlLmdldE5hbWUoKQogICAgICAgICAgICAg\nICAgKyAiIEZPUiBFQUNIIFJPVyBCRUdJTiBTRUxFQ1QgIiArIHNlcSArICIu\nbmV4dHZhbCBJTlRPICIKICAgICAgICAgICAgICAgICsgIjpuZXcuIiArIGNv\nbHNbaV0uZ2V0TmFtZSgpICsgIiBGUk9NIERVQUw7ICIKICAgICAgICAgICAg\nICAgICsgIkVORCAiICsgdHJpZyArICI7Iik7CiAgICAgICAgfQogICAgICAg\nIGlmIChzZXFzID09IG51bGwpCiAgICAgICAgICAgIHJldHVybiBjcmVhdGU7\nCgogICAgICAgIC8vIGNvbWJpbmUgY3JlYXRlIHRhYmxlIHNxbCBhbmQgY3Jl\nYXRlIHNlcWVuY2VzIHNxbAogICAgICAgIFN0cmluZ1tdIHNxbCA9IG5ldyBT\ndHJpbmdbY3JlYXRlLmxlbmd0aCArIHNlcXMuc2l6ZSgpXTsKICAgICAgICBT\neXN0ZW0uYXJyYXljb3B5KGNyZWF0ZSwgMCwgc3FsLCAwLCBjcmVhdGUubGVu\nZ3RoKTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IHNlcXMuc2l6ZSgp\nOyBpKyspCiAgICAgICAgICAgIHNxbFtjcmVhdGUubGVuZ3RoICsgaV0gPSAo\nU3RyaW5nKSBzZXFzLmdldChpKTsKICAgICAgICByZXR1cm4gc3FsOwogICAg\nfQoKICAgIHB1YmxpYyBTdHJpbmdbXSBnZXRDcmVhdGVTZXF1ZW5jZVNRTChT\nZXF1ZW5jZSBzZXEpIHsKICAgICAgICBTdHJpbmdbXSBzcWwgPSBzdXBlci5n\nZXRDcmVhdGVTZXF1ZW5jZVNRTChzZXEpOwogICAgICAgIGlmIChzZXEuZ2V0\nQWxsb2NhdGUoKSA+IDEpCiAgICAgICAgICAgIHNxbFswXSArPSAiIENBQ0hF\nICIgKyBzZXEuZ2V0QWxsb2NhdGUoKTsKICAgICAgICByZXR1cm4gc3FsOwog\nICAgfQoKICAgIHByb3RlY3RlZCBTdHJpbmcgZ2V0U2VxdWVuY2VzU1FMKFN0\ncmluZyBzY2hlbWFOYW1lLCBTdHJpbmcgc2VxdWVuY2VOYW1lKSB7CiAgICAg\nICAgU3RyaW5nQnVmZmVyIGJ1ZiA9IG5ldyBTdHJpbmdCdWZmZXIoKTsKICAg\nICAgICBidWYuYXBwZW5kKCJTRUxFQ1QgU0VRVUVOQ0VfT1dORVIgQVMgU0VR\nVUVOQ0VfU0NIRU1BLCAiKS4KICAgICAgICAgICAgYXBwZW5kKCJTRVFVRU5D\nRV9OQU1FIEZST00gQUxMX1NFUVVFTkNFUyIpOwogICAgICAgIGlmIChzY2hl\nbWFOYW1lICE9IG51bGwgfHwgc2VxdWVuY2VOYW1lICE9IG51bGwpCiAgICAg\nICAgICAgIGJ1Zi5hcHBlbmQoIiBXSEVSRSAiKTsKICAgICAgICBpZiAoc2No\nZW1hTmFtZSAhPSBudWxsKSB7CiAgICAgICAgICAgIGJ1Zi5hcHBlbmQoIlNF\nUVVFTkNFX09XTkVSID0gPyIpOwogICAgICAgICAgICBpZiAoc2VxdWVuY2VO\nYW1lICE9IG51bGwpCiAgICAgICAgICAgICAgICBidWYuYXBwZW5kKCIgQU5E\nICIpOwogICAgICAgIH0KICAgICAgICBpZiAoc2VxdWVuY2VOYW1lICE9IG51\nbGwpCiAgICAgICAgICAgIGJ1Zi5hcHBlbmQoIlNFUVVFTkNFX05BTUUgPSA/\nIik7CiAgICAgICAgcmV0dXJuIGJ1Zi50b1N0cmluZygpOwogICAgfQoKICAg\nIHB1YmxpYyBib29sZWFuIGlzU3lzdGVtU2VxdWVuY2UoU3RyaW5nIG5hbWUs\nIFN0cmluZyBzY2hlbWEsCiAgICAgICAgYm9vbGVhbiB0YXJnZXRTY2hlbWEp\nIHsKICAgICAgICBpZiAoc3VwZXIuaXNTeXN0ZW1TZXF1ZW5jZShuYW1lLCBz\nY2hlbWEsIHRhcmdldFNjaGVtYSkpCiAgICAgICAgICAgIHJldHVybiB0cnVl\nOwoKICAgICAgICAvLyBmaWx0ZXIgb3V0IGdlbmVyYXRlZCBzZXF1ZW5jZXMg\ndXNlZCBmb3IgYXV0by1hc3NpZ24KICAgICAgICByZXR1cm4gKGF1dG9Bc3Np\nZ25TZXF1ZW5jZU5hbWUgIT0gbnVsbAogICAgICAgICAgICAmJiBuYW1lLmVx\ndWFsc0lnbm9yZUNhc2UoYXV0b0Fzc2lnblNlcXVlbmNlTmFtZSkpCiAgICAg\nICAgICAgIHx8IChhdXRvQXNzaWduU2VxdWVuY2VOYW1lID09IG51bGwKICAg\nICAgICAgICAgJiYgbmFtZS50b1VwcGVyQ2FzZSgpLnN0YXJ0c1dpdGgoIlNU\nXyIpKTsKICAgIH0KCiAgICBwdWJsaWMgT2JqZWN0IGdldEdlbmVyYXRlZEtl\neShDb2x1bW4gY29sLCBDb25uZWN0aW9uIGNvbm4pCiAgICAgICAgdGhyb3dz\nIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgaWYgKCF1c2VUcmlnZ2Vyc0ZvckF1\ndG9Bc3NpZ24pCiAgICAgICAgICAgIHJldHVybiBOdW1iZXJzLnZhbHVlT2Yo\nMEwpOwoKICAgICAgICAvLyBpZiB3ZSBzaW11bGF0ZSBhdXRvLWFzc2lnbmVk\nIGNvbHVtbnMgdXNpbmcgdHJpZ2dlcnMgYW5kCiAgICAgICAgLy8gc2VxdWVu\nY2VzLCB0aGVuIHJldHVybiB0aGUgY3VycmVudCB2YWx1ZSBvZiB0aGUgc2Vx\ndWVuY2UKICAgICAgICAvLyBmcm9tIGF1dG9Bc3NpZ25TZXF1ZW5jZU5hbWUK\nICAgICAgICBTdHJpbmcgc2VxID0gYXV0b0Fzc2lnblNlcXVlbmNlTmFtZTsK\nICAgICAgICBpZiAoc2VxID09IG51bGwgJiYgb3BlbmpwYTNHZW5lcmF0ZWRL\nZXlOYW1lcykKICAgICAgICAgICAgc2VxID0gZ2V0T3BlbkpQQTNHZW5lcmF0\nZWRLZXlTZXF1ZW5jZU5hbWUoY29sKTsKICAgICAgICBlbHNlIGlmIChzZXEg\nPT0gbnVsbCkKICAgICAgICAgICAgc2VxID0gZ2V0R2VuZXJhdGVkS2V5U2Vx\ndWVuY2VOYW1lKGNvbCk7CiAgICAgICAgUHJlcGFyZWRTdGF0ZW1lbnQgc3Rt\nbnQgPSBjb25uLnByZXBhcmVTdGF0ZW1lbnQoIlNFTEVDVCAiICsgc2VxCiAg\nICAgICAgICAgICsgIi5jdXJydmFsIEZST00gRFVBTCIpOwogICAgICAgIFJl\nc3VsdFNldCBycyA9IG51bGw7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAg\ncnMgPSBzdG1udC5leGVjdXRlUXVlcnkoKTsKICAgICAgICAgICAgcnMubmV4\ndCgpOwogICAgICAgICAgICByZXR1cm4gTnVtYmVycy52YWx1ZU9mKHJzLmdl\ndExvbmcoMSkpOwogICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgIGlm\nIChycyAhPSBudWxsKQogICAgICAgICAgICAgICAgdHJ5IHsgcnMuY2xvc2Uo\nKTsgfSBjYXRjaCAoU1FMRXhjZXB0aW9uIHNlKSB7fQogICAgICAgICAgICB0\ncnkgeyBzdG1udC5jbG9zZSgpOyB9IGNhdGNoIChTUUxFeGNlcHRpb24gc2Up\nIHt9CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogVHJpZ2dlciBu\nYW1lIGZvciBzaW11bGF0aW5nIGF1dG8tYXNzaWduIHZhbHVlcyBvbiB0aGUg\nZ2l2ZW4gY29sdW1uLgogICAgICovCiAgICBwcm90ZWN0ZWQgU3RyaW5nIGdl\ndEdlbmVyYXRlZEtleVRyaWdnZXJOYW1lKENvbHVtbiBjb2wpIHsKICAgICAg\nICAvLyByZXBsYWNlIHRyYWlsaW5nIF9TRVEgd2l0aCBfVFJHCiAgICAgICAg\nU3RyaW5nIHNlcU5hbWUgPSBnZXRHZW5lcmF0ZWRLZXlTZXF1ZW5jZU5hbWUo\nY29sKTsKICAgICAgICByZXR1cm4gc2VxTmFtZS5zdWJzdHJpbmcoMCwgc2Vx\nTmFtZS5sZW5ndGgoKSAtIDMpICsgIlRSRyI7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBSZXR1cm5zIGEgT3BlbkpQQSAzLWNvbXBhdGlibGUgbmFtZSBmb3Ig\nYW4gYXV0by1hc3NpZ24gc2VxdWVuY2UuCiAgICAgKi8KICAgIHByb3RlY3Rl\nZCBTdHJpbmcgZ2V0T3BlbkpQQTNHZW5lcmF0ZWRLZXlTZXF1ZW5jZU5hbWUo\nQ29sdW1uIGNvbCkgewogICAgICAgIFRhYmxlIHRhYmxlID0gY29sLmdldFRh\nYmxlKCk7CiAgICAgICAgcmV0dXJuIG1ha2VOYW1lVmFsaWQoIlNFUV8iICsg\ndGFibGUuZ2V0TmFtZSgpLCB0YWJsZS5nZXRTY2hlbWEoKS4KICAgICAgICAg\nICAgZ2V0U2NoZW1hR3JvdXAoKSwgbWF4VGFibGVOYW1lTGVuZ3RoLCBOQU1F\nX0FOWSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm5zIGEgT3BlbkpQ\nQSAzLWNvbXBhdGlibGUgbmFtZSBmb3IgYW4gYXV0by1hc3NpZ24gdHJpZ2dl\nci4KICAgICAqLwogICAgcHJvdGVjdGVkIFN0cmluZyBnZXRPcGVuSlBBM0dl\nbmVyYXRlZEtleVRyaWdnZXJOYW1lKENvbHVtbiBjb2wpIHsKICAgICAgICBU\nYWJsZSB0YWJsZSA9IGNvbC5nZXRUYWJsZSgpOwogICAgICAgIHJldHVybiBt\nYWtlTmFtZVZhbGlkKCJUUklHXyIgKyB0YWJsZS5nZXROYW1lKCksIHRhYmxl\nLmdldFNjaGVtYSgpLgogICAgICAgICAgICBnZXRTY2hlbWFHcm91cCgpLCBt\nYXhUYWJsZU5hbWVMZW5ndGgsIE5BTUVfQU5ZKTsKICAgIH0KCiAgICAvKioK\nICAgICAqIEludm9rZSBPcmFjbGUncyA8Y29kZT5wdXRCeXRlczwvY29kZT4g\nbWV0aG9kIG9uIHRoZSBnaXZlbiBCTE9CIG9iamVjdC4KICAgICAqIFVzZXMg\ncmVmbGVjdGlvbiBpbiBjYXNlIHRoZSBibG9iIGlzIHdyYXBwZWQgaW4gYW5v\ndGhlcgogICAgICogdmVuZG9yLXNwZWNpZmljIGNsYXNzOyBmb3IgZXhhbXBs\nZSBXZWJsb2dpYyB3cmFwcyBvcmFjbGUgdGhpbiBkcml2ZXIKICAgICAqIGxv\nYnMgaW4gaXRzIG93biBpbnRlcmZhY2VzIHdpdGggdGhlIHNhbWUgbWV0aG9k\ncy4KICAgICAqLwogICAgcHVibGljIHZvaWQgcHV0Qnl0ZXMoT2JqZWN0IGJs\nb2IsIGJ5dGVbXSBkYXRhKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24g\newogICAgICAgIGlmIChibG9iID09IG51bGwpCiAgICAgICAgICAgIHJldHVy\nbjsKICAgICAgICBpZiAoX3B1dEJ5dGVzID09IG51bGwpIHsKICAgICAgICAg\nICAgdHJ5IHsKICAgICAgICAgICAgICAgIF9wdXRCeXRlcyA9IGJsb2IuZ2V0\nQ2xhc3MoKS5nZXRNZXRob2QoInB1dEJ5dGVzIiwKICAgICAgICAgICAgICAg\nICAgICBuZXcgQ2xhc3NbXXsgbG9uZy5jbGFzcywgYnl0ZVtdLmNsYXNzIH0p\nOwogICAgICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkgewogICAgICAg\nICAgICAgICAgdGhyb3cgbmV3IFN0b3JlRXhjZXB0aW9uKGUpOwogICAgICAg\nICAgICB9CiAgICAgICAgfQogICAgICAgIGludm9rZVB1dExvYk1ldGhvZChf\ncHV0Qnl0ZXMsIGJsb2IsIGRhdGEpOwogICAgfQoKICAgIC8qKgogICAgICog\nSW52b2tlIE9yYWNsZSdzIDxjb2RlPnB1dFN0cmluZzwvY29kZT4gbWV0aG9k\nIG9uIHRoZSBnaXZlbiBDTE9CIG9iamVjdC4KICAgICAqIFVzZXMgcmVmbGVj\ndGlvbiBpbiBjYXNlIHRoZSBjbG9iIGlzIHdyYXBwZWQgaW4gYW5vdGhlcgog\nICAgICogdmVuZG9yLXNwZWNpZmljIGNsYXNzOyBmb3IgZXhhbXBsZSBXZWJs\nb2dpYyB3cmFwcyBvcmFjbGUgdGhpbiBkcml2ZXIKICAgICAqIGxvYnMgaW4g\naXRzIG93biBpbnRlcmZhY2VzIHdpdGggdGhlIHNhbWUgbWV0aG9kcy4KICAg\nICAqLwogICAgcHVibGljIHZvaWQgcHV0U3RyaW5nKE9iamVjdCBjbG9iLCBT\ndHJpbmcgZGF0YSkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAg\nICAgICBpZiAoX3B1dFN0cmluZyA9PSBudWxsKSB7CiAgICAgICAgICAgIHRy\neSB7CiAgICAgICAgICAgICAgICBfcHV0U3RyaW5nID0gY2xvYi5nZXRDbGFz\ncygpLmdldE1ldGhvZCgicHV0U3RyaW5nIiwKICAgICAgICAgICAgICAgICAg\nICBuZXcgQ2xhc3NbXXsgbG9uZy5jbGFzcywgU3RyaW5nLmNsYXNzIH0pOwog\nICAgICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkgewogICAgICAgICAg\nICAgICAgdGhyb3cgbmV3IFN0b3JlRXhjZXB0aW9uKGUpOwogICAgICAgICAg\nICB9CiAgICAgICAgfQogICAgICAgIGludm9rZVB1dExvYk1ldGhvZChfcHV0\nU3RyaW5nLCBjbG9iLCBkYXRhKTsKICAgIH0KCiAgICAvKioKICAgICAqIElu\ndm9rZSBPcmFjbGUncyA8Y29kZT5wdXRDaGFyczwvY29kZT4gbWV0aG9kIG9u\nIHRoZSBnaXZlbiBDTE9CCiAgICAgKiBvYmplY3QuIFVzZXMgcmVmbGVjdGlv\nbiBpbiBjYXNlIHRoZSBjbG9iIGlzIHdyYXBwZWQgaW4gYW5vdGhlcgogICAg\nICogdmVuZG9yLXNwZWNpZmljIGNsYXNzOyBmb3IgZXhhbXBsZSBXZWJsb2dp\nYyB3cmFwcyBvcmFjbGUgdGhpbiBkcml2ZXIKICAgICAqIGxvYnMgaW4gaXRz\nIG93biBpbnRlcmZhY2VzIHdpdGggdGhlIHNhbWUgbWV0aG9kcy4KICAgICAq\nLwogICAgcHVibGljIHZvaWQgcHV0Q2hhcnMoT2JqZWN0IGNsb2IsIGNoYXJb\nXSBkYXRhKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAg\nIGlmIChfcHV0Q2hhcnMgPT0gbnVsbCkgewogICAgICAgICAgICB0cnkgewog\nICAgICAgICAgICAgICAgX3B1dENoYXJzID0gY2xvYi5nZXRDbGFzcygpLmdl\ndE1ldGhvZCgicHV0Q2hhcnMiLAogICAgICAgICAgICAgICAgICAgIG5ldyBD\nbGFzc1tdeyBsb25nLmNsYXNzLCBjaGFyW10uY2xhc3MgfSk7CiAgICAgICAg\nICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgICAgICB0\naHJvdyBuZXcgU3RvcmVFeGNlcHRpb24oZSk7CiAgICAgICAgICAgIH0KICAg\nICAgICB9CiAgICAgICAgaW52b2tlUHV0TG9iTWV0aG9kKF9wdXRDaGFycywg\nY2xvYiwgZGF0YSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBJbnZva2UgdGhl\nIGdpdmVuIExPQiBtZXRob2Qgb24gdGhlIGdpdmVuIHRhcmdldCB3aXRoIHRo\nZSBnaXZlbiBkYXRhLgogICAgICovCiAgICBwcml2YXRlIHN0YXRpYyB2b2lk\nIGludm9rZVB1dExvYk1ldGhvZChNZXRob2QgbWV0aG9kLCBPYmplY3QgdGFy\nZ2V0LAogICAgICAgIE9iamVjdCBkYXRhKQogICAgICAgIHRocm93cyBTUUxF\neGNlcHRpb24gewogICAgICAgIHRyeSB7CiAgICAgICAgICAgIG1ldGhvZC5p\nbnZva2UodGFyZ2V0LCBuZXcgT2JqZWN0W117IE51bWJlcnMudmFsdWVPZigx\nTCksIGRhdGEgfSk7CiAgICAgICAgfSBjYXRjaCAoSW52b2NhdGlvblRhcmdl\ndEV4Y2VwdGlvbiBpdGUpIHsKICAgICAgICAgICAgVGhyb3dhYmxlIHQgPSBp\ndGUuZ2V0VGFyZ2V0RXhjZXB0aW9uKCk7CiAgICAgICAgICAgIGlmICh0IGlu\nc3RhbmNlb2YgU1FMRXhjZXB0aW9uKQogICAgICAgICAgICAgICAgdGhyb3co\nU1FMRXhjZXB0aW9uKSB0OwogICAgICAgICAgICB0aHJvdyBuZXcgU3RvcmVF\neGNlcHRpb24odCk7CiAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsK\nICAgICAgICAgICAgdGhyb3cgbmV3IFN0b3JlRXhjZXB0aW9uKGUpOwogICAg\nICAgIH0KICAgIH0KCiAgICBwcml2YXRlIENsb2IgZ2V0RW1wdHlDbG9iKCkK\nICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBpZiAoRU1Q\nVFlfQ0xPQiAhPSBudWxsKQogICAgICAgICAgICByZXR1cm4gRU1QVFlfQ0xP\nQjsKICAgICAgICB0cnkgewogICAgICAgICAgICByZXR1cm4gRU1QVFlfQ0xP\nQiA9IChDbG9iKSBDbGFzcy5mb3JOYW1lKCJvcmFjbGUuc3FsLkNMT0IiLCB0\ncnVlLAogICAgICAgICAgICAgICAgICAgIChDbGFzc0xvYWRlcikgQWNjZXNz\nQ29udHJvbGxlci5kb1ByaXZpbGVnZWQoSjJEb1ByaXZIZWxwZXIKICAgICAg\nICAgICAgICAgICAgICAgICAgICAgIC5nZXRDb250ZXh0Q2xhc3NMb2FkZXJB\nY3Rpb24oKSkpCiAgICAgICAgICAgICAgICAuZ2V0TWV0aG9kKCJlbXB0eV9s\nb2IiLCBuZXcgQ2xhc3NbMF0pLgogICAgICAgICAgICAgICAgaW52b2tlKG51\nbGwsIG5ldyBPYmplY3RbMF0pOwogICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlv\nbiBlKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBTUUxFeGNlcHRpb24oZS5n\nZXRNZXNzYWdlKCkpOwogICAgICAgIH0KICAgIH0KCiAgICBwcml2YXRlIEJs\nb2IgZ2V0RW1wdHlCbG9iKCkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9u\nIHsKICAgICAgICBpZiAoRU1QVFlfQkxPQiAhPSBudWxsKQogICAgICAgICAg\nICByZXR1cm4gRU1QVFlfQkxPQjsKICAgICAgICB0cnkgewogICAgICAgICAg\nICByZXR1cm4gRU1QVFlfQkxPQiA9IChCbG9iKSBDbGFzcy5mb3JOYW1lKCJv\ncmFjbGUuc3FsLkJMT0IiLCB0cnVlLAogICAgICAgICAgICAgICAgICAgIChD\nbGFzc0xvYWRlcikgQWNjZXNzQ29udHJvbGxlci5kb1ByaXZpbGVnZWQoSjJE\nb1ByaXZIZWxwZXIKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5nZXRD\nb250ZXh0Q2xhc3NMb2FkZXJBY3Rpb24oKSkpLgogICAgICAgICAgICAgICAg\nZ2V0TWV0aG9kKCJlbXB0eV9sb2IiLCBuZXcgQ2xhc3NbMF0pLgogICAgICAg\nICAgICAgICAgaW52b2tlKG51bGwsIG5ldyBPYmplY3RbMF0pOwogICAgICAg\nIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgIHRocm93IG5l\ndyBTUUxFeGNlcHRpb24oZS5nZXRNZXNzYWdlKCkpOwogICAgICAgIH0KICAg\nIH0KCiAgICBwcml2YXRlIHN0YXRpYyBib29sZWFuIGlzT3JhY2xlUHJlcGFy\nZWRTdGF0ZW1lbnQoU3RhdGVtZW50IHN0bW50KSB7CiAgICAgICAgdHJ5IHsK\nICAgICAgICAgICAgcmV0dXJuIENsYXNzLmZvck5hbWUoIm9yYWNsZS5qZGJj\nLk9yYWNsZVByZXBhcmVkU3RhdGVtZW50IikuCiAgICAgICAgICAgICAgICBp\nc0luc3RhbmNlKHN0bW50KTsKICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24g\nZSkgewogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQogICAg\nfQogICAgCiAgICAvKioKICAgICAqIElmIHRoaXMgZGljdGlvbmFyeSBzdXBw\nb3J0cyBYTUwgdHlwZSwKICAgICAqIHVzZSB0aGlzIG1ldGhvZCB0byBhcHBl\nbmQgeG1sIHByZWRpY2F0ZS4KICAgICAqIAogICAgICogQHBhcmFtIGJ1ZiB0\naGUgU1FMIGJ1ZmZlciB0byB3cml0ZSB0aGUgY29tcGFyaXNvbgogICAgICog\nQHBhcmFtIG9wIHRoZSBjb21wYXJpc29uIG9wZXJhdGlvbiB0byBwZXJmb3Jt\nCiAgICAgKiBAcGFyYW0gbGhzIHRoZSBsZWZ0IGhhbmQgc2lkZSBvZiB0aGUg\nY29tcGFyaXNvbgogICAgICogQHBhcmFtIHJocyB0aGUgcmlnaHQgaGFuZCBz\naWRlIG9mIHRoZSBjb21wYXJpc29uCiAgICAgKi8KICAgIHB1YmxpYyB2b2lk\nIGFwcGVuZFhtbENvbXBhcmlzb24oU1FMQnVmZmVyIGJ1ZiwgU3RyaW5nIG9w\nLCBGaWx0ZXJWYWx1ZSBsaHMsCiAgICAgICAgRmlsdGVyVmFsdWUgcmhzLCBi\nb29sZWFuIGxoc3htbCwgYm9vbGVhbiByaHN4bWwpIHsKICAgICAgICBzdXBl\nci5hcHBlbmRYbWxDb21wYXJpc29uKGJ1Ziwgb3AsIGxocywgcmhzLCBsaHN4\nbWwsIHJoc3htbCk7CiAgICAgICAgaWYgKGxoc3htbCAmJiByaHN4bWwpCiAg\nICAgICAgICAgIGFwcGVuZFhtbENvbXBhcmlzb24yKGJ1Ziwgb3AsIGxocywg\ncmhzKTsKICAgICAgICBlbHNlIGlmIChsaHN4bWwpCiAgICAgICAgICAgIGFw\ncGVuZFhtbENvbXBhcmlzb24xKGJ1Ziwgb3AsIGxocywgcmhzKTsKICAgICAg\nICBlbHNlIAogICAgICAgICAgICBhcHBlbmRYbWxDb21wYXJpc29uMShidWYs\nIG9wLCByaHMsIGxocyk7CiAgICB9CiAgICAKICAgIC8qKgogICAgICogQXBw\nZW5kIGFuIHhtbCBjb21wYXJpc29uIHByZWRpY2F0ZQogICAgICoKICAgICAq\nIEBwYXJhbSBidWYgdGhlIFNRTCBidWZmZXIgdG8gd3JpdGUgdGhlIGNvbXBh\ncmlzb24KICAgICAqIEBwYXJhbSBvcCB0aGUgY29tcGFyaXNvbiBvcGVyYXRp\nb24gdG8gcGVyZm9ybQogICAgICogQHBhcmFtIGxocyB0aGUgbGVmdCBoYW5k\nIHNpZGUgb2YgdGhlIGNvbXBhcmlzb24gKG1hcHMgdG8geG1sIGNvbHVtbikK\nICAgICAqIEBwYXJhbSByaHMgdGhlIHJpZ2h0IGhhbmQgc2lkZSBvZiB0aGUg\nY29tcGFyaXNvbgogICAgICovCiAgICBwcml2YXRlIHZvaWQgYXBwZW5kWG1s\nQ29tcGFyaXNvbjEoU1FMQnVmZmVyIGJ1ZiwgU3RyaW5nIG9wLAogICAgICAg\nIEZpbHRlclZhbHVlIGxocywgRmlsdGVyVmFsdWUgcmhzKSB7CiAgICAgICAg\nYXBwZW5kWG1sRXh0cmFjdFZhbHVlKGJ1ZiwgbGhzKTsKICAgICAgICBidWYu\nYXBwZW5kKCIgIikuYXBwZW5kKG9wKS5hcHBlbmQoIiAiKTsKICAgICAgICBy\naHMuYXBwZW5kVG8oYnVmKTsKICAgIH0KICAgIAogICAgLyoqCiAgICAgKiBB\ncHBlbmQgYW4geG1sIGNvbXBhcmlzb24gcHJlZGljYXRlIChib3RoIG9wZXJh\nbmRzIG1hcCB0byB4bWwgY29sdW1uKQogICAgICoKICAgICAqIEBwYXJhbSBi\ndWYgdGhlIFNRTCBidWZmZXIgdG8gd3JpdGUgdGhlIGNvbXBhcmlzb24KICAg\nICAqIEBwYXJhbSBvcCB0aGUgY29tcGFyaXNvbiBvcGVyYXRpb24gdG8gcGVy\nZm9ybQogICAgICogQHBhcmFtIGxocyB0aGUgbGVmdCBoYW5kIHNpZGUgb2Yg\ndGhlIGNvbXBhcmlzb24gKG1hcHMgdG8geG1sIGNvbHVtbikKICAgICAqIEBw\nYXJhbSByaHMgdGhlIHJpZ2h0IGhhbmQgc2lkZSBvZiB0aGUgY29tcGFyaXNv\nbiAobWFwcyB0byB4bWwgY29sdW1uKQogICAgICovCiAgICBwcml2YXRlIHZv\naWQgYXBwZW5kWG1sQ29tcGFyaXNvbjIoU1FMQnVmZmVyIGJ1ZiwgU3RyaW5n\nIG9wLCAKICAgICAgICBGaWx0ZXJWYWx1ZSBsaHMsIEZpbHRlclZhbHVlIHJo\ncykgewogICAgICAgIGFwcGVuZFhtbEV4dHJhY3RWYWx1ZShidWYsIGxocyk7\nCiAgICAgICAgYnVmLmFwcGVuZCgiICIpLmFwcGVuZChvcCkuYXBwZW5kKCIg\nIik7CiAgICAgICAgYXBwZW5kWG1sRXh0cmFjdFZhbHVlKGJ1ZiwgcmhzKTsK\nICAgIH0KICAgIAogICAgcHJpdmF0ZSB2b2lkIGFwcGVuZFhtbEV4dHJhY3RW\nYWx1ZShTUUxCdWZmZXIgYnVmLCBGaWx0ZXJWYWx1ZSB2YWwpIHsKICAgICAg\nICBidWYuYXBwZW5kKCJleHRyYWN0VmFsdWUoIikuCiAgICAgICAgICAgIGFw\ncGVuZCh2YWwuZ2V0Q29sdW1uQWxpYXMoCiAgICAgICAgICAgIHZhbC5nZXRG\naWVsZE1hcHBpbmcoKS5nZXRDb2x1bW5zKClbMF0pKS4KICAgICAgICAgICAg\nYXBwZW5kKCIsJy8qLyIpOwogICAgICAgIHZhbC5hcHBlbmRUbyhidWYpOwog\nICAgICAgIGJ1Zi5hcHBlbmQoIicpIik7CiAgICB9Cn0K\n","encoding":"base64"}

