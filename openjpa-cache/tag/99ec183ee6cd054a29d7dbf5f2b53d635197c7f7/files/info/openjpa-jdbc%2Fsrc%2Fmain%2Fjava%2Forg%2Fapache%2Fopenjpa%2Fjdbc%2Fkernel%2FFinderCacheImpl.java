{"sha":"98bb6d4137bd3714ff2593e04a3e7d0eab455c91","node_id":"MDQ6QmxvYjIwNjM2NDo5OGJiNmQ0MTM3YmQzNzE0ZmYyNTkzZTA0YTNlN2QwZWFiNDU1Yzkx","size":13195,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/98bb6d4137bd3714ff2593e04a3e7d0eab455c91","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5rZXJuZWw7CgppbXBv\ncnQgamF2YS51dGlsLkFycmF5TGlzdDsKaW1wb3J0IGphdmEudXRpbC5Db2xs\nZWN0aW9uOwppbXBvcnQgamF2YS51dGlsLkNvbGxlY3Rpb25zOwppbXBvcnQg\namF2YS51dGlsLkhhc2hNYXA7CmltcG9ydCBqYXZhLnV0aWwuTGlzdDsKaW1w\nb3J0IGphdmEudXRpbC5NYXA7CmltcG9ydCBqYXZhLnV0aWwuU2V0OwppbXBv\ncnQgamF2YS51dGlsLlRyZWVNYXA7CmltcG9ydCBqYXZhLnV0aWwuY29uY3Vy\ncmVudC5sb2Nrcy5SZWVudHJhbnRMb2NrOwoKaW1wb3J0IG9yZy5hcGFjaGUu\nY29tbW9ucy5sYW5nLlN0cmluZ1V0aWxzOwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLmpkYmMubWV0YS5DbGFzc01hcHBpbmc7CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEuamRiYy5zcWwuUmVzdWx0OwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLmpkYmMuc3FsLlNlbGVjdEV4ZWN1dG9yOwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5GZXRjaENvbmZpZ3VyYXRpb247Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLkZpbmRlckNhY2hlOwpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5GaW5kZXJRdWVyeTsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuUXVlcnlIaW50czsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuUXVlcnlTdGF0aXN0\naWNzOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi5jb25mLkNvbmZp\nZ3VyYXRpb247CgovKioKICogSW1wbGVtZW50YXRpb24gb2YgRmluZGVyQ2Fj\naGUgZm9yIEpEQkMuCiAqIAogKiBAYXV0aG9yIFBpbmFraSBQb2RkYXIKICog\nCiAqIEBzaW5jZSAyLjAuMAogKgogKi8KcHVibGljIGNsYXNzIEZpbmRlckNh\nY2hlSW1wbCAKICAgIGltcGxlbWVudHMgRmluZGVyQ2FjaGU8Q2xhc3NNYXBw\naW5nLCBTZWxlY3RFeGVjdXRvciwgUmVzdWx0PiB7CiAgICBwcml2YXRlIHN0\nYXRpYyBmaW5hbCBTdHJpbmcgUEFUVEVSTl9TRVBBUkFUT1IgPSAiXFw7IjsK\nICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIFN0cmluZyBFWExVREVEX0JZX1VT\nRVIgPSAiRXhjbHVkZWQgYnkgdXNlciI7CiAgICAgCiAgICBwcml2YXRlIGZp\nbmFsIE1hcDxDbGFzc01hcHBpbmcsIEZpbmRlclF1ZXJ5PENsYXNzTWFwcGlu\nZywgU2VsZWN0RXhlY3V0b3IsIFJlc3VsdD4+IF9kZWxlZ2F0ZTsKICAgIC8v\nIEtleTogY2xhc3MgbmFtZSBWYWx1ZTogUmVhc29uIHdoeSBleGNsdWRlZAog\nICAgcHJpdmF0ZSBmaW5hbCBNYXA8U3RyaW5nLCBTdHJpbmc+IF91bmNhY2hh\nYmxlczsKICAgIHByaXZhdGUgTGlzdDxTdHJpbmc+IF9leGNsdXNpb25QYXR0\nZXJuczsKICAgIHByaXZhdGUgUXVlcnlTdGF0aXN0aWNzPENsYXNzTWFwcGlu\nZz4gX3N0YXRzOwogICAgcHJpdmF0ZSBSZWVudHJhbnRMb2NrIF9sb2NrID0g\nbmV3IFJlZW50cmFudExvY2soKTsKICAgIAogICAgcHVibGljIEZpbmRlckNh\nY2hlSW1wbCgpIHsKICAgICAgICBfZGVsZWdhdGUgPSBuZXcgSGFzaE1hcDxD\nbGFzc01hcHBpbmcsIEZpbmRlclF1ZXJ5PENsYXNzTWFwcGluZywgU2VsZWN0\nRXhlY3V0b3IsIFJlc3VsdD4+KCk7CiAgICAgICAgX3VuY2FjaGFibGVzID0g\nbmV3IEhhc2hNYXA8U3RyaW5nLCBTdHJpbmc+KCk7CiAgICAgICAgX3N0YXRz\nID0gbmV3IFF1ZXJ5U3RhdGlzdGljcy5EZWZhdWx0PENsYXNzTWFwcGluZz4o\nKTsKICAgIH0KICAgIAogICAgLyoqCiAgICAgKiBHZXQgYSBtYXAtb3JpZW50\nZWQgdmlldyBvZiB0aGUgY2FjaGUuCiAgICAgKiAKICAgICAqIEByZXR1cm4g\nYSBtYXAgb2YgdGhlIHF1ZXJ5IHN0cmluZyB3aXRoIGNsYXNzIG5hbWVzIGFz\nIGtleS4gCiAgICAgKi8KICAgIHB1YmxpYyBNYXA8U3RyaW5nLCBTdHJpbmc+\nIGdldE1hcFZpZXcoKSB7CiAgICAgICAgbG9jaygpOwogICAgICAgIHRyeSB7\nCiAgICAgICAgICAgIE1hcDxTdHJpbmcsIFN0cmluZz4gdmlldyA9IG5ldyBU\ncmVlTWFwPFN0cmluZywgU3RyaW5nPigpOwogICAgICAgICAgICBmb3IgKENs\nYXNzTWFwcGluZyBtYXBwaW5nIDogX2RlbGVnYXRlLmtleVNldCgpKSB7CiAg\nICAgICAgICAgICAgICB2aWV3LnB1dChtYXBwaW5nLmdldERlc2NyaWJlZFR5\ncGUoKS5nZXROYW1lKCksIAogICAgICAgICAgICAgICAgICAgIF9kZWxlZ2F0\nZS5nZXQobWFwcGluZykuZ2V0UXVlcnlTdHJpbmcoKSk7CiAgICAgICAgICAg\nIH0KICAgICAgICAgICAgcmV0dXJuIHZpZXc7CiAgICAgICAgfSBmaW5hbGx5\nIHsKICAgICAgICAgICAgdW5sb2NrKCk7CiAgICAgICAgfQogICAgfQoKICAg\nIC8qKgogICAgICogR2V0cyBiYXNpYyBzdGF0aXN0aWNzIG9mIGV4ZWN1dGlv\nbiBhbmQgaGl0IGNvdW50IG9mIGZpbmRlciBxdWVyaWVzLiAKICAgICAqLwog\nICAgcHVibGljIFF1ZXJ5U3RhdGlzdGljczxDbGFzc01hcHBpbmc+IGdldFN0\nYXRpc3RpY3MoKSB7CiAgICAgICAgcmV0dXJuIF9zdGF0czsKICAgIH0KCiAg\nICAvKioKICAgICAqIEdldHMgdGhlIGZpbmRlciBxdWVyeSBmb3IgdGhlIGdp\ndmVuIG1hcHBpbmcuIFRoZSBnZXQgb3BlcmF0aW9uIGNhbiBiZQogICAgICog\nY29udHJvbGxlZCBieSBGZXRjaENvbmZpZ3VyYXRpb24gaGludHMuIAogICAg\nICoge0BsaW5rIFF1ZXJ5SGludHMjSElOVF9JR05PUkVfRklOREVSIEhJTlRf\nSUdOT1JFX0ZJTkRFUn0gd2lsbCBpZ25vcmUKICAgICAqIGFueSBjYWNoZWQg\nZmluZGVyIHRoYXQgbWF5IGV4aXN0IGluIHRoaXMgY2FjaGUgYW5kIHdpbGwg\ncmV0dXJuIG51bGwuCiAgICAgKiB7QGxpbmsgUXVlcnlIaW50cyNISU5UX0lO\nVkFMSURBVEVfRklOREVSIEhJTlRfSU5WQUxJREFURV9GSU5ERVJ9IHdpbGwg\nCiAgICAgKiBpbnZhbGlkYXRlIGFueSBjYWNoZWQgZmluZGVyIHRoYXQgbWF5\nIGV4aXN0IGluIHRoaXMgY2FjaGUgYW5kIHdpbGwgcmV0dXJuCiAgICAgKiBu\ndWxsLgogICAgICogCiAgICAgKi8KICAgIHB1YmxpYyBGaW5kZXJRdWVyeTxD\nbGFzc01hcHBpbmcsU2VsZWN0RXhlY3V0b3IsUmVzdWx0PiAKICAgICAgICBn\nZXQoQ2xhc3NNYXBwaW5nIG1hcHBpbmcsIEZldGNoQ29uZmlndXJhdGlvbiBm\nZXRjaCkgewogICAgICAgIGlmIChmZXRjaC5nZXRSZWFkTG9ja0xldmVsKCkg\nIT0gMCkgewogICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICB9CiAg\nICAgICAgYm9vbGVhbiBpZ25vcmUgPSBpc0hpbnRlZChmZXRjaCwgUXVlcnlI\naW50cy5ISU5UX0lHTk9SRV9GSU5ERVIpOwogICAgICAgIGJvb2xlYW4gaW52\nYWxpZGF0ZSA9IGlzSGludGVkKGZldGNoLCBRdWVyeUhpbnRzLkhJTlRfSU5W\nQUxJREFURV9GSU5ERVIpOwogICAgICAgIGlmIChpbnZhbGlkYXRlKSB7CiAg\nICAgICAgICAgIGludmFsaWRhdGUobWFwcGluZyk7CiAgICAgICAgfQogICAg\nICAgIGlmIChpZ25vcmUpIHsKICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAg\nICAgICAgfQogICAgICAgIEZpbmRlclF1ZXJ5PENsYXNzTWFwcGluZywgU2Vs\nZWN0RXhlY3V0b3IsIFJlc3VsdD4gcmVzdWx0ID0gX2RlbGVnYXRlLmdldCht\nYXBwaW5nKTsKICAgICAgICBfc3RhdHMucmVjb3JkRXhlY3V0aW9uKG1hcHBp\nbmcpOwogICAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9CiAgICAKICAgIC8q\nKgogICAgICogQ2FjaGUgYSBGaW5kZXIgUXVlcnkgZm9yIHRoZSBnaXZlbiBt\nYXBwaW5nIGFuZCBzZWxlY3QuIFRoZSBwdXQgb3BlcmF0aW9uIAogICAgICog\nY2FuIGJlIGNvbnRyb2xsZWQgYnkgRmV0Y2hDb25maWd1cmF0aW9uIGhpbnRz\nLiAKICAgICAqIElmIG5vIGVudHJ5IGV4aXN0cyBmb3IgdGhlIGdpdmVuIG1h\ncHBpbmcgdGhlbiBhbiBhdHRlbXB0IGlzIG1hZGUgdG8gCiAgICAgKiBjcmVh\ndGUgYSBuZXcgRmluZGVyUXVlcnkuIFRoZSBhdHRlbXB0LCBob3dldmVyLCBt\nYXkgbm90IGJlIHN1Y2Nlc3NmdWwKICAgICAqIGJlY2F1c2UgYWxsIFNlbGVj\ndHMgY2FuIG5vdCBiZSBjYWNoZWQuCiAgICAgKiBAc2VlIEZpbmRlclF1ZXJ5\nSW1wbCNuZXdGaW5kZXIoQ2xhc3NNYXBwaW5nLCBTZWxlY3QpLgogICAgICog\nIAogICAgICogSWYgYSBlbnRyeSBmb3IgdGhlIGdpdmVuIG1hcHBpbmcgZXhp\nc3RzIHRoZW4gdGhlIHZhbHVlIG9mCiAgICAgKiB7QGxpbmsgUXVlcnlIaW50\ncyNISU5UX1JFQ0FDSEVfRklOREVSIEhJTlRfUkVDQUNIRV9GSU5ERVJ9IGhp\nbnQgCiAgICAgKiBkZXRlcm1pbmVzIHdoZXRoZXIgdGhlIGV4aXN0aW5nIGVu\ndHJ5IGlzIHJldHVybmVkIG9yIGEgbmV3IEZpbmRlclF1ZXJ5IAogICAgICog\nd2l0aCB0aGUgZ2l2ZW4gYXJndW1lbnQgb3ZlcndyaXRlcyB0aGUgZXhpc3Rp\nbmcgb25lLgogICAgICogCiAgICAgKiBAcGFyYW0gbWFwcGluZyB0aGUgY2xh\nc3MgZm9yIHdoaWNoIHRoZSBmaW5kZXIgaXMgdG8gYmUgY2FjaGVkCiAgICAg\nKiBAcGFyYW0gc2VsZWN0IHRoZSBmaW5kZXIgcXVlcnkKICAgICAqIEBwYXJh\nbSBmZXRjaCBtYXkgY29udGFpbiBoaW50cyB0byBjb250cm9sIGNhY2hlIG9w\nZXJhdGlvbgogICAgICovCiAgICBwdWJsaWMgRmluZGVyUXVlcnk8Q2xhc3NN\nYXBwaW5nLCBTZWxlY3RFeGVjdXRvciwgUmVzdWx0PiBjYWNoZQogICAgICAg\nKENsYXNzTWFwcGluZyBtYXBwaW5nLCBTZWxlY3RFeGVjdXRvciBzZWxlY3Qs\nIEZldGNoQ29uZmlndXJhdGlvbiBmZXRjaCkgewogICAgICAgIGxvY2soKTsK\nICAgICAgICB0cnkgewogICAgICAgICAgICBpZiAoZmV0Y2guZ2V0UmVhZExv\nY2tMZXZlbCgpICE9IDApIHsKICAgICAgICAgICAgICAgIHJldHVybiBudWxs\nOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGJvb2xlYW4gcmVjYWNoZSA9\nIGlzSGludGVkKGZldGNoLCBRdWVyeUhpbnRzLkhJTlRfUkVDQUNIRV9GSU5E\nRVIpOwogICAgICAgICAgICBpZiAoaXNFeGNsdWRlZChtYXBwaW5nKSkgewog\nICAgICAgICAgICAgICAgcmV0dXJuIHJlY2FjaGUgPyBwdXQobWFwcGluZywg\nc2VsZWN0KSA6IG51bGw7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYg\nKF9kZWxlZ2F0ZS5jb250YWluc0tleShtYXBwaW5nKSkgewogICAgICAgICAg\nICAgICAgcmV0dXJuIHJlY2FjaGUgPyBwdXQobWFwcGluZywgc2VsZWN0KSA6\nIF9kZWxlZ2F0ZS5nZXQobWFwcGluZyk7CiAgICAgICAgICAgIH0KICAgICAg\nICAgICAgcmV0dXJuIHB1dChtYXBwaW5nLCBzZWxlY3QpOwogICAgICAgIH0g\nZmluYWxseSB7CiAgICAgICAgICAgIHVubG9jaygpOwogICAgICAgIH0KICAg\nIH0KICAgIAogICAgLyoqCiAgICAgKiBDcmVhdGVzIGFuZCBwdXRzIGEgRmlu\nZGVyUXVlcnkgaW4gdGhlIGludGVybmFsIG1hcCBpbmRleGVkIGJ5IHRoZQog\nICAgICogZ2l2ZW4gQ2xhc3NNYXBwaW5nLgogICAgICogSWYgYSBuZXcgRmlu\nZGVyUXVlcnkgY2FuIG5vdCBiZSBjcmVhdGVkIGZvciB0aGUgZ2l2ZW4gU2Vs\nZWN0IChiZWNhdXNlCiAgICAgKiBzb21lIFNlbGVjdCBhcmUgbm90IGNhY2hl\nZCksIHRoZW4gdGhlIG1hcHBpbmcgaXMgbWFya2VkIGludmFsaWQuCiAgICAg\nKiAgCiAgICAqLwogICAgcHJpdmF0ZSBGaW5kZXJRdWVyeTxDbGFzc01hcHBp\nbmcsIFNlbGVjdEV4ZWN1dG9yLCBSZXN1bHQ+IHB1dChDbGFzc01hcHBpbmcg\nbWFwcGluZywgU2VsZWN0RXhlY3V0b3Igc2VsZWN0KSB7CiAgICAgICAgRmlu\nZGVyUXVlcnk8Q2xhc3NNYXBwaW5nLCBTZWxlY3RFeGVjdXRvciwgUmVzdWx0\nPiBmaW5kZXIgPSBGaW5kZXJRdWVyeUltcGwubmV3RmluZGVyKG1hcHBpbmcs\nIHNlbGVjdCk7CiAgICAgICAgaWYgKGZpbmRlciAhPSBudWxsKSB7CiAgICAg\nICAgICAgIF9kZWxlZ2F0ZS5wdXQobWFwcGluZywgZmluZGVyKTsKICAgICAg\nICB9IGVsc2UgewogICAgICAgICAgICBpbnZhbGlkYXRlKG1hcHBpbmcpOwog\nICAgICAgIH0KICAgICAgICByZXR1cm4gZmluZGVyOwogICAgfQogICAgCiAg\nICAvKioKICAgICAqIEFmZmlybXMgaWYgdGhlIGdpdmVuIG1hcHBpbmcgaXMg\nZXhjbHVkZWQgZnJvbSBiZWluZyBjYWNoZWQuCiAgICAgKi8KICAgIHB1Ymxp\nYyBib29sZWFuIGlzRXhjbHVkZWQoQ2xhc3NNYXBwaW5nIG1hcHBpbmcpIHsK\nICAgICAgICByZXR1cm4gbWFwcGluZyAhPSBudWxsICYmIGlzRXhjbHVkZWQo\nbWFwcGluZy5nZXREZXNjcmliZWRUeXBlKCkuZ2V0TmFtZSgpKTsKICAgIH0K\nCiAgICAvKioKICAgICAqIFNlYXJjaGVzIHRoZSBleGNsdXNpb24gcGF0dGVy\nbnMgdG8gZmluZCBvdXQgaWYgdGhlIGdpdmVuIHN0cmluZyBtYXRjaGVzCiAg\nICAgKiBhbnkgZWxlbWVudC4KICAgICAqLwogICAgcHJpdmF0ZSBib29sZWFu\nIGlzRXhjbHVkZWQoU3RyaW5nIHRhcmdldCkgewogICAgICAgIGlmIChfZXhj\nbHVzaW9uUGF0dGVybnMgIT0gbnVsbCAmJiBfZXhjbHVzaW9uUGF0dGVybnMu\nY29udGFpbnModGFyZ2V0KSkKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAg\nICAgICAgcmV0dXJuIGdldE1hdGNoZWRFeGNsdXNpb25QYXR0ZXJuKHRhcmdl\ndCkgIT0gbnVsbDsKICAgIH0KCiAgICAvKioKICAgICAqIEFkZHMgYSBwYXR0\nZXJuIGZvciBleGNsdXNpb24uIEFueSBjYWNoZWQgZmluZGVyIHdob3NlIGNs\nYXNzIG5hbWUKICAgICAqIG1hdGNoZXMgdGhlIGdpdmVuIHBhdHRlcm4gd2ls\nbCBiZSBtYXJrZWQgaW52YWxpZGF0ZWQgYXMgYSBzaWRlLWVmZmVjdC4KICAg\nICAqLwogICAgcHVibGljIHZvaWQgYWRkRXhjbHVzaW9uUGF0dGVybihTdHJp\nbmcgcGF0dGVybikgewogICAgICAgIGxvY2soKTsKICAgICAgICB0cnkgewog\nICAgICAgICAgICBpZiAoX2V4Y2x1c2lvblBhdHRlcm5zID09IG51bGwpCiAg\nICAgICAgICAgICAgICBfZXhjbHVzaW9uUGF0dGVybnMgPSBuZXcgQXJyYXlM\naXN0PFN0cmluZz4oKTsKICAgICAgICAgICAgX2V4Y2x1c2lvblBhdHRlcm5z\nLmFkZChwYXR0ZXJuKTsKICAgICAgICAgICAgQ29sbGVjdGlvbjxDbGFzc01h\ncHBpbmc+IGludmFsaWRNYXBwaW5ncyA9IGdldE1hdGNoZWRLZXlzKHBhdHRl\ncm4sIAogICAgICAgICAgICAgICAgICAgIF9kZWxlZ2F0ZS5rZXlTZXQoKSk7\nCiAgICAgICAgICAgIGZvciAoQ2xhc3NNYXBwaW5nIGludmFsaWRNYXBwaW5n\nIDogaW52YWxpZE1hcHBpbmdzKQogICAgICAgICAgICAgICAgbWFya1VuY2Fj\naGFibGUoaW52YWxpZE1hcHBpbmcsIHBhdHRlcm4pOwogICAgICAgIH0gZmlu\nYWxseSB7CiAgICAgICAgICAgIHVubG9jaygpOwogICAgICAgIH0KICAgIH0K\nICAgIC8qKgogICAgICogUmVtb3ZlcyBhIHBhdHRlcm4gZm9yIGV4Y2x1c2lv\nbi4gQW55IHF1ZXJ5IGlkZW50aWZpZXIgbWFya2VkIGFzIG5vdCAKICAgICAq\nIGNhY2hhYmxlIGR1ZSB0byB0aGUgZ2l2ZW4gcGF0dGVybiB3aWxsIG5vdyBi\nZSByZW1vdmVkIGZyb20gdGhlIGxpc3Qgb2YKICAgICAqIHVuY2FjaGFibGVz\nIGFzIGEgc2lkZS1lZmZlY3QuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHJl\nbW92ZUV4Y2x1c2lvblBhdHRlcm4oU3RyaW5nIHBhdHRlcm4pIHsKICAgICAg\nICBsb2NrKCk7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgaWYgKF9leGNs\ndXNpb25QYXR0ZXJucyA9PSBudWxsKQogICAgICAgICAgICAgICAgcmV0dXJu\nOwogICAgICAgICAgICBfZXhjbHVzaW9uUGF0dGVybnMucmVtb3ZlKHBhdHRl\ncm4pOwogICAgICAgICAgICBDb2xsZWN0aW9uPFN0cmluZz4gcmVib3JucyA9\nIGdldE1hdGNoZWRLZXlzKHBhdHRlcm4sIAogICAgICAgICAgICAgICAgX3Vu\nY2FjaGFibGVzLmtleVNldCgpKTsKICAgICAgICAgICAgZm9yIChTdHJpbmcg\ncmVib3JuS2V5IDogcmVib3JucykKICAgICAgICAgICAgICAgIF91bmNhY2hh\nYmxlcy5yZW1vdmUocmVib3JuS2V5KTsKICAgICAgICB9IGZpbmFsbHkgewog\nICAgICAgICAgICB1bmxvY2soKTsKICAgICAgICB9CiAgICB9CiAgICAKICAg\nIC8qKgogICAgICogR2V0cyB0aGUgcGF0dGVybiB0aGF0IG1hdGNoZXMgdGhl\nIGdpdmVuIGlkZW50aWZpZXIuCiAgICAgKi8KICAgIHByaXZhdGUgU3RyaW5n\nIGdldE1hdGNoZWRFeGNsdXNpb25QYXR0ZXJuKFN0cmluZyBpZCkgewogICAg\nICAgIGlmIChfZXhjbHVzaW9uUGF0dGVybnMgPT0gbnVsbCB8fCBfZXhjbHVz\naW9uUGF0dGVybnMuaXNFbXB0eSgpKQogICAgICAgICAgICByZXR1cm4gbnVs\nbDsKICAgICAgICBmb3IgKFN0cmluZyBwYXR0ZXJuIDogX2V4Y2x1c2lvblBh\ndHRlcm5zKQogICAgICAgICAgICBpZiAobWF0Y2hlcyhwYXR0ZXJuLCBpZCkp\nCiAgICAgICAgICAgICAgICByZXR1cm4gcGF0dGVybjsKICAgICAgICByZXR1\ncm4gbnVsbDsKICAgIH0KICAgIAogICAgLyoqCiAgICAgKiBHZXRzIHRoZSBl\nbGVtZW50cyBvZiB0aGUgZ2l2ZW4gc2V0IHRoYXQgbWF0Y2ggdGhlIGdpdmVu\nIHBhdHRlcm4uIAogICAgICovCiAgICBwcml2YXRlIENvbGxlY3Rpb248Q2xh\nc3NNYXBwaW5nPiBnZXRNYXRjaGVkS2V5cyhTdHJpbmcgcGF0dGVybiwgU2V0\nPENsYXNzTWFwcGluZz4gc2V0KSB7CiAgICAgICAgTGlzdDxDbGFzc01hcHBp\nbmc+IHJlc3VsdCA9IG5ldyBBcnJheUxpc3Q8Q2xhc3NNYXBwaW5nPigpOwog\nICAgICAgIGZvciAoQ2xhc3NNYXBwaW5nIGVudHJ5IDogc2V0KSB7CiAgICAg\nICAgICAgIGlmIChtYXRjaGVzKHBhdHRlcm4sIGVudHJ5KSkgewogICAgICAg\nICAgICAgICAgcmVzdWx0LmFkZChlbnRyeSk7CiAgICAgICAgICAgIH0KICAg\nICAgICB9CiAgICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0KICAgIAogICAg\nLyoqCiAgICAgKiBHZXRzIHRoZSBlbGVtZW50cyBvZiB0aGUgZ2l2ZW4gbGlz\ndCB3aGljaCBtYXRjaCB0aGUgZ2l2ZW4gcGF0dGVybi4gCiAgICAgKi8KICAg\nIHByaXZhdGUgQ29sbGVjdGlvbjxTdHJpbmc+IGdldE1hdGNoZWRLZXlzKFN0\ncmluZyBwYXR0ZXJuLCBDb2xsZWN0aW9uPFN0cmluZz4gY29sbCkgewogICAg\nICAgIExpc3Q8U3RyaW5nPiByZXN1bHQgPSBuZXcgQXJyYXlMaXN0PFN0cmlu\nZz4oKTsKICAgICAgICBmb3IgKFN0cmluZyBrZXkgOiBjb2xsKSB7CiAgICAg\nICAgICAgIGlmIChtYXRjaGVzKHBhdHRlcm4sIGtleSkpIHsKICAgICAgICAg\nICAgICAgIHJlc3VsdC5hZGQoa2V5KTsKICAgICAgICAgICAgfQogICAgICAg\nIH0KICAgICAgICByZXR1cm4gcmVzdWx0OwogICAgfQoKICAgIGJvb2xlYW4g\nbWF0Y2hlcyhTdHJpbmcgcGF0dGVybiwgQ2xhc3NNYXBwaW5nIG1hcHBpbmcp\nIHsKICAgICAgICByZXR1cm4gbWF0Y2hlcyhwYXR0ZXJuLCBtYXBwaW5nLmdl\ndERlc2NyaWJlZFR5cGUoKS5nZXROYW1lKCkpOwogICAgfQogICAgCiAgICBi\nb29sZWFuIG1hdGNoZXMoU3RyaW5nIHBhdHRlcm4sIFN0cmluZyB0YXJnZXQp\nIHsKICAgICAgICByZXR1cm4gdGFyZ2V0ICE9IG51bGwgJiYgKHRhcmdldC5l\ncXVhbHMocGF0dGVybikgCiAgICAgICAgICB8fCB0YXJnZXQubWF0Y2hlcyhw\nYXR0ZXJuKSk7CiAgICB9CiAgICAKICAgIHB1YmxpYyBib29sZWFuIGludmFs\naWRhdGUoQ2xhc3NNYXBwaW5nIG1hcHBpbmcpIHsKICAgICAgICBsb2NrKCk7\nCiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgcmV0dXJuIF9kZWxlZ2F0ZS5y\nZW1vdmUobWFwcGluZykgIT0gbnVsbDsKICAgICAgICB9IGZpbmFsbHkgewog\nICAgICAgICAgICB1bmxvY2soKTsKICAgICAgICB9CiAgICB9CgogICAgcHVi\nbGljIEZpbmRlclF1ZXJ5PENsYXNzTWFwcGluZywgU2VsZWN0RXhlY3V0b3Is\nIFJlc3VsdD4gbWFya1VuY2FjaGFibGUoQ2xhc3NNYXBwaW5nIG1hcHBpbmcp\nIHsKICAgICAgICByZXR1cm4gbWFya1VuY2FjaGFibGUobWFwcGluZy5nZXRE\nZXNjcmliZWRUeXBlKCkuZ2V0TmFtZSgpKTsKICAgIH0KCiAgICBwdWJsaWMg\nRmluZGVyUXVlcnk8Q2xhc3NNYXBwaW5nLCBTZWxlY3RFeGVjdXRvciwgUmVz\ndWx0PiBtYXJrVW5jYWNoYWJsZShTdHJpbmcgaWQpIHsKICAgICAgICByZXR1\ncm4gbWFya1VuY2FjaGFibGUoaWQsIEVYTFVERURfQllfVVNFUik7CiAgICB9\nCiAgICAKICAgIHByaXZhdGUgRmluZGVyUXVlcnk8Q2xhc3NNYXBwaW5nLCBT\nZWxlY3RFeGVjdXRvciwgUmVzdWx0PiBtYXJrVW5jYWNoYWJsZShTdHJpbmcg\nY2xzLCBTdHJpbmcgcmVhc29uKSB7CiAgICAgICAgbG9jaygpOwogICAgICAg\nIHRyeSB7CiAgICAgICAgICAgIGJvb2xlYW4gZXhjbHVkZWRCeVVzZXIgPSBf\ndW5jYWNoYWJsZXMuZ2V0KGNscykgPT0gRVhMVURFRF9CWV9VU0VSOwogICAg\nICAgICAgICBpZiAoIWV4Y2x1ZGVkQnlVc2VyKQogICAgICAgICAgICAgICAg\nX3VuY2FjaGFibGVzLnB1dChjbHMsIHJlYXNvbik7CiAgICAgICAgICAgIHJl\ndHVybiBfZGVsZWdhdGUucmVtb3ZlKHNlYXJjaE1hcHBpbmdCeU5hbWUoY2xz\nKSk7CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgdW5sb2NrKCk7\nCiAgICAgICAgfQogICAgfQogICAgCiAgICBwcml2YXRlIEZpbmRlclF1ZXJ5\nPENsYXNzTWFwcGluZywgU2VsZWN0RXhlY3V0b3IsIFJlc3VsdD4gbWFya1Vu\nY2FjaGFibGUoQ2xhc3NNYXBwaW5nIG1hcHBpbmcsIFN0cmluZyByZWFzb24p\nIHsKICAgICAgICBsb2NrKCk7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAg\nU3RyaW5nIGNscyA9IG1hcHBpbmcuZ2V0RGVzY3JpYmVkVHlwZSgpLmdldE5h\nbWUoKTsKICAgICAgICAgICAgYm9vbGVhbiBleGNsdWRlZEJ5VXNlciA9IF91\nbmNhY2hhYmxlcy5nZXQoY2xzKSA9PSBFWExVREVEX0JZX1VTRVI7CiAgICAg\nICAgICAgIGlmICghZXhjbHVkZWRCeVVzZXIpCiAgICAgICAgICAgICAgICBf\ndW5jYWNoYWJsZXMucHV0KGNscywgcmVhc29uKTsKICAgICAgICAgICAgcmV0\ndXJuIF9kZWxlZ2F0ZS5yZW1vdmUobWFwcGluZyk7CiAgICAgICAgfSBmaW5h\nbGx5IHsKICAgICAgICAgICAgdW5sb2NrKCk7CiAgICAgICAgfQogICAgfQog\nICAgCiAgICBDbGFzc01hcHBpbmcgc2VhcmNoTWFwcGluZ0J5TmFtZShTdHJp\nbmcgY2xzKSB7CiAgICAgICAgZm9yIChDbGFzc01hcHBpbmcgbWFwcGluZyA6\nIF9kZWxlZ2F0ZS5rZXlTZXQoKSkKICAgICAgICAgICAgaWYgKG1hdGNoZXMo\nY2xzLCBtYXBwaW5nKSkKICAgICAgICAgICAgICAgIHJldHVybiBtYXBwaW5n\nOwogICAgICAgIHJldHVybiBudWxsOwogICAgfQoKICAgIAogICAgcHVibGlj\nIHZvaWQgc2V0RXhjbHVkZXMoU3RyaW5nIGV4Y2x1ZGVzKSB7CiAgICAgICAg\nbG9jaygpOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIGlmIChTdHJpbmdV\ndGlscy5pc0VtcHR5KGV4Y2x1ZGVzKSkKICAgICAgICAgICAgICAgIHJldHVy\nbjsKICAgICAgICAgICAgaWYgKF9leGNsdXNpb25QYXR0ZXJucyA9PSBudWxs\nKQogICAgICAgICAgICAgICAgX2V4Y2x1c2lvblBhdHRlcm5zID0gbmV3IEFy\ncmF5TGlzdDxTdHJpbmc+KCk7CiAgICAgICAgICAgIFN0cmluZ1tdIHBhdHRl\ncm5zID0gZXhjbHVkZXMuc3BsaXQoUEFUVEVSTl9TRVBBUkFUT1IpOwogICAg\nICAgICAgICBmb3IgKFN0cmluZyBwYXR0ZXJuIDogcGF0dGVybnMpCiAgICAg\nICAgICAgICAgICBhZGRFeGNsdXNpb25QYXR0ZXJuKHBhdHRlcm4pOwogICAg\nICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgIHVubG9jaygpOwogICAgICAg\nIH0KICAgIH0KCiAgICBAU3VwcHJlc3NXYXJuaW5ncygidW5jaGVja2VkIikK\nICAgIHB1YmxpYyBMaXN0PFN0cmluZz4gZ2V0RXhjbHVkZXMoKSB7CiAgICAg\nICAgcmV0dXJuIChMaXN0PFN0cmluZz4pX2V4Y2x1c2lvblBhdHRlcm5zID09\nIG51bGwgCiAgICAgICAgICAgID8gQ29sbGVjdGlvbnMuRU1QVFlfTElTVCAK\nICAgICAgICAgICAgOiBDb2xsZWN0aW9ucy51bm1vZGlmaWFibGVMaXN0KF9l\neGNsdXNpb25QYXR0ZXJucyk7CiAgICB9CiAgICAKICAgIGJvb2xlYW4gaXNI\naW50ZWQoRmV0Y2hDb25maWd1cmF0aW9uIGZldGNoLCBTdHJpbmcgaGludCkg\newogICAgICAgIGlmIChmZXRjaCA9PSBudWxsKQogICAgICAgICAgICByZXR1\ncm4gZmFsc2U7CiAgICAgICAgT2JqZWN0IHJlc3VsdCA9IGZldGNoLmdldEhp\nbnQoaGludCk7CiAgICAgICAgcmV0dXJuIHJlc3VsdCAhPSBudWxsICYmICJ0\ncnVlIi5lcXVhbHNJZ25vcmVDYXNlKHJlc3VsdC50b1N0cmluZygpKTsKICAg\nIH0KICAgICAgICAKICAgIHZvaWQgbG9jaygpIHsKICAgICAgICBpZiAoX2xv\nY2sgIT0gbnVsbCkKICAgICAgICAgICAgX2xvY2subG9jaygpOwogICAgfQoK\nICAgIHZvaWQgdW5sb2NrKCkgewogICAgICAgIGlmIChfbG9jayAhPSBudWxs\nICYmIF9sb2NrLmlzTG9ja2VkKCkpCiAgICAgICAgICAgIF9sb2NrLnVubG9j\naygpOwogICAgfQogICAgIAogICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0t\nLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgLy8gIENvbmZp\nZ3VyYXRpb24gY29udHJhY3QKICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0t\nLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgIHB1YmxpYyB2\nb2lkIHN0YXJ0Q29uZmlndXJhdGlvbigpIHsKICAgIH0KICAgIAogICAgcHVi\nbGljIHZvaWQgc2V0Q29uZmlndXJhdGlvbihDb25maWd1cmF0aW9uIGNvbmYp\nIHsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBlbmRDb25maWd1cmF0aW9uKCkg\newogICAgfQp9Cg==\n","encoding":"base64"}

