{"sha":"963410acd13598869b5f7ef4661d6a04b54cebc8","node_id":"MDQ6QmxvYjIwNjM2NDo5NjM0MTBhY2QxMzU5ODg2OWI1ZjdlZjQ2NjFkNmEwNGI1NGNlYmM4","size":36167,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/963410acd13598869b5f7ef4661d6a04b54cebc8","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YTsKCmltcG9ydCBqYXZh\nLmlvLkZpbGU7CmltcG9ydCBqYXZhLmlvLkZpbGVOb3RGb3VuZEV4Y2VwdGlv\nbjsKaW1wb3J0IGphdmEuaW8uSU9FeGNlcHRpb247CmltcG9ydCBqYXZhLmlv\nLklucHV0U3RyZWFtOwppbXBvcnQgamF2YS5uZXQuTWFsZm9ybWVkVVJMRXhj\nZXB0aW9uOwppbXBvcnQgamF2YS5uZXQuVVJMOwppbXBvcnQgamF2YS5zZWN1\ncml0eS5BY2Nlc3NDb250cm9sbGVyOwppbXBvcnQgamF2YS5zZWN1cml0eS5Q\ncml2aWxlZ2VkQWN0aW9uRXhjZXB0aW9uOwppbXBvcnQgamF2YS51dGlsLkFy\ncmF5TGlzdDsKaW1wb3J0IGphdmEudXRpbC5BcnJheXM7CmltcG9ydCBqYXZh\nLnV0aWwuQ29sbGVjdGlvbjsKaW1wb3J0IGphdmEudXRpbC5IYXNoTWFwOwpp\nbXBvcnQgamF2YS51dGlsLkhhc2hTZXQ7CmltcG9ydCBqYXZhLnV0aWwuSXRl\ncmF0b3I7CmltcG9ydCBqYXZhLnV0aWwuTGlzdDsKaW1wb3J0IGphdmEudXRp\nbC5NYXA7CmltcG9ydCBqYXZhLnV0aWwuU2V0OwppbXBvcnQgamF2YS51dGls\nLnppcC5aaXBGaWxlOwppbXBvcnQgamF2YS51dGlsLnppcC5aaXBJbnB1dFN0\ncmVhbTsKCmltcG9ydCBvcmcuYXBhY2hlLmNvbW1vbnMubGFuZy5TdHJpbmdV\ndGlsczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5jb25mLk9wZW5KUEFD\nb25maWd1cmF0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmNvbmYu\nT3BlbkpQQUNvbmZpZ3VyYXRpb25JbXBsOwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLmxpYi5tZXRhLkNsYXNzQXJnUGFyc2VyOwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLmxpYi5tZXRhLkNsYXNzcGF0aE1ldGFEYXRhSXRlcmF0\nb3I7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLm1ldGEuRmlsZU1l\ndGFEYXRhSXRlcmF0b3I7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGli\nLm1ldGEuTWV0YURhdGFGaWx0ZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEubGliLm1ldGEuTWV0YURhdGFJdGVyYXRvcjsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5saWIubWV0YS5NZXRhRGF0YVBhcnNlcjsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5saWIubWV0YS5NZXRhRGF0YVNlcmlhbGl6ZXI7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLm1ldGEuUmVzb3VyY2VN\nZXRhRGF0YUl0ZXJhdG9yOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxp\nYi5tZXRhLlVSTE1ldGFEYXRhSXRlcmF0b3I7CmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEubGliLm1ldGEuWmlwRmlsZU1ldGFEYXRhSXRlcmF0b3I7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLm1ldGEuWmlwU3RyZWFtTWV0\nYURhdGFJdGVyYXRvcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIu\ndXRpbC5GaWxlczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIudXRp\nbC5KMkRvUHJpdkhlbHBlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5s\naWIudXRpbC5Mb2NhbGl6ZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\ndXRpbC5HZW5lcmFsRXhjZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLnV0aWwuVXNlckV4Y2VwdGlvbjsKaW1wb3J0IHNlcnAudXRpbC5TdHJp\nbmdzOwoKLyoqCiAqIEJhc2UgY2xhc3MgZm9yIGZhY3RvcnkgaW1wbGVtZW50\nYXRpb25zIGJ1aWx0IGFyb3VuZCBYTUwgbWV0YWRhdGEgZmlsZXMKICogaW4g\ndGhlIGNvbW1vbiBmb21hdC4KICoKICogQGF1dGhvciBBYmUgV2hpdGUKICog\nQHNpbmNlIDAuNC4wCiAqLwpwdWJsaWMgYWJzdHJhY3QgY2xhc3MgQWJzdHJh\nY3RDRk1ldGFEYXRhRmFjdG9yeQogICAgZXh0ZW5kcyBBYnN0cmFjdE1ldGFE\nYXRhRmFjdG9yeSB7CgogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgTG9jYWxp\nemVyIF9sb2MgPSBMb2NhbGl6ZXIuZm9yUGFja2FnZQogICAgICAgIChBYnN0\ncmFjdE1ldGFEYXRhRmFjdG9yeS5jbGFzcyk7CgogICAgcHJvdGVjdGVkIENv\nbGxlY3Rpb248RmlsZT4gZmlsZXMgPSBudWxsOwogICAgcHJvdGVjdGVkIENv\nbGxlY3Rpb248VVJMPiB1cmxzID0gbnVsbDsKICAgIHByb3RlY3RlZCBDb2xs\nZWN0aW9uPFN0cmluZz4gcnNyY3MgPSBudWxsOwogICAgcHJvdGVjdGVkIENv\nbGxlY3Rpb248U3RyaW5nPiBjcGF0aCA9IG51bGw7CgogICAgcHJpdmF0ZSBT\nZXQ8U3RyaW5nPiBfdHlwZU5hbWVzID0gbnVsbDsKICAgIHB1YmxpYyBzdGF0\naWMgZmluYWwgU3RyaW5nIFBFUlNJU1RFTkNFX1VOSVRfUk9PVF9VUkwgPSAi\nUGVyc2lzdGVuY2VVbml0Um9vdFVybCI7CiAgICBwdWJsaWMgc3RhdGljIGZp\nbmFsIFN0cmluZyBNQVBQSU5HX0ZJTEVfTkFNRVMgPSAiTWFwcGluZ0ZpbGVO\nYW1lcyI7CiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIFN0cmluZyBKQVJfRklM\nRV9VUkxTID0gIkphckZpbGVzIjsKCiAgICAvKioKICAgICAqIFNldCBvZiB7\nQGxpbmsgRmlsZX1zIG9mIG1ldGFkYXRhIGZpbGVzIG9yIGRpcmVjdG9yaWVz\nIHN1cHBsaWVkIGJ5IHVzZXIuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNl\ndEZpbGVzKENvbGxlY3Rpb248RmlsZT4gZmlsZXMpIHsKICAgICAgICB0aGlz\nLmZpbGVzID0gZmlsZXM7CiAgICB9CgogICAgLyoqCiAgICAgKiBTZXQgb2Yg\nc2VtaWNvbG9uLXNlcGFyYXRlZCB7QGxpbmsgRmlsZX1zIG9mIG1ldGFkYXRh\nIGZpbGVzIG9yCiAgICAgKiBkaXJlY3RvcmllcyBzdXBwbGllZCBieSB1c2Vy\nIHZpYSBhdXRvLWNvbmZpZ3VyYXRpb24uCiAgICAgKi8KICAgIHB1YmxpYyB2\nb2lkIHNldEZpbGVzKFN0cmluZyBmaWxlcykgewogICAgICAgIGlmIChTdHJp\nbmdVdGlscy5pc0VtcHR5KGZpbGVzKSkKICAgICAgICAgICAgdGhpcy5maWxl\ncyA9IG51bGw7CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIFN0cmluZ1td\nIHN0cnMgPSBTdHJpbmdzLnNwbGl0KGZpbGVzLCAiOyIsIDApOwogICAgICAg\nICAgICB0aGlzLmZpbGVzID0gbmV3IEhhc2hTZXQ8RmlsZT4oKGludCkgKHN0\ncnMubGVuZ3RoICogMS4zMyArIDEpKTsKCiAgICAgICAgICAgIEZpbGUgZmls\nZTsKICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBzdHJzLmxlbmd0\naDsgaSsrKSB7CiAgICAgICAgICAgICAgICBmaWxlID0gbmV3IEZpbGUoc3Ry\nc1tpXSk7CiAgICAgICAgICAgICAgICBpZiAoKEFjY2Vzc0NvbnRyb2xsZXIu\nZG9Qcml2aWxlZ2VkKAogICAgICAgICAgICAgICAgICAgIEoyRG9Qcml2SGVs\ncGVyLmV4aXN0c0FjdGlvbihmaWxlKSkpLmJvb2xlYW5WYWx1ZSgpKQogICAg\nICAgICAgICAgICAgICAgIHRoaXMuZmlsZXMuYWRkKGZpbGUpOwogICAgICAg\nICAgICB9CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogU2V0IG9m\nIHtAbGluayBVUkx9cyBvZiBtZXRhZGF0YSBmaWxlcyBvciBqYXJzIHN1cHBs\naWVkIGJ5IHVzZXIuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldFVSTHMo\nQ29sbGVjdGlvbjxVUkw+IHVybHMpIHsKICAgICAgICB0aGlzLnVybHMgPSB1\ncmxzOwogICAgfQoKICAgIC8qKgogICAgICogU2V0IG9mIHNlbWljb2xvbi1z\nZXBhcmF0ZWQge0BsaW5rIFVSTH1zIG9mIG1ldGFkYXRhIGZpbGVzIG9yIGph\ncnMKICAgICAqIHN1cHBsaWVkIGJ5IHVzZXIgdmlhIGF1dG8tY29uZmlndXJh\ndGlvbi4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0VVJMcyhTdHJpbmcg\ndXJscykgewogICAgICAgIGlmIChTdHJpbmdVdGlscy5pc0VtcHR5KHVybHMp\nKQogICAgICAgICAgICB0aGlzLnVybHMgPSBudWxsOwogICAgICAgIGVsc2Ug\newogICAgICAgICAgICBTdHJpbmdbXSBzdHJzID0gU3RyaW5ncy5zcGxpdCh1\ncmxzLCAiOyIsIDApOwogICAgICAgICAgICB0aGlzLnVybHMgPSBuZXcgSGFz\naFNldDxVUkw+KChpbnQpIChzdHJzLmxlbmd0aCAqIDEuMzMgKyAxKSk7CiAg\nICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBmb3IgKGludCBpID0g\nMDsgaSA8IHN0cnMubGVuZ3RoOyBpKyspCiAgICAgICAgICAgICAgICAgICAg\ndGhpcy51cmxzLmFkZChuZXcgVVJMKHN0cnNbaV0pKTsKICAgICAgICAgICAg\nfSBjYXRjaCAoTWFsZm9ybWVkVVJMRXhjZXB0aW9uIG11ZSkgewogICAgICAg\nICAgICAgICAgdGhyb3cgbmV3IFVzZXJFeGNlcHRpb24obXVlKTsKICAgICAg\nICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIFNldCBv\nZiByZXNvdXJjZSBwYXRocyBvZiBtZXRhZGF0YSBmaWxlcyBvciBqYXJzIHN1\ncHBsaWVkIGJ5IHVzZXIuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldFJl\nc291cmNlcyhDb2xsZWN0aW9uPFN0cmluZz4gcnNyY3MpIHsKICAgICAgICB0\naGlzLnJzcmNzID0gcnNyY3M7CiAgICB9CgogICAgLyoqCiAgICAgKiBTZXQg\nb2Ygc2VtaWNvbG9uLXNlcGFyYXRlZCByZXNvdXJjZSBwYXRocyBvZiBtZXRh\nZGF0YSBmaWxlcyBvciBqYXJzCiAgICAgKiBzdXBwbGllZCBieSB1c2VyIHZp\nYSBhdXRvLWNvbmZpZ3VyYXRpb24uCiAgICAgKi8KICAgIHB1YmxpYyB2b2lk\nIHNldFJlc291cmNlcyhTdHJpbmcgcnNyY3MpIHsKICAgICAgICAvLyBrZWVw\nIGxpc3QgbXV0YWJsZSBzbyBzdWJjbGFzc2VzIGNhbiBhZGQgaW1wbGljaXQg\nbG9jYXRpb25zCiAgICAgICAgdGhpcy5yc3JjcyA9IChTdHJpbmdVdGlscy5p\nc0VtcHR5KHJzcmNzKSkgPyBudWxsCiAgICAgICAgICA6IG5ldyBBcnJheUxp\nc3Q8U3RyaW5nPihBcnJheXMuYXNMaXN0KFN0cmluZ3Muc3BsaXQocnNyY3Ms\nICI7IiwgMCkpKTsKICAgIH0KCiAgICAvKioKICAgICAqIFNldCBvZiBjbGFz\nc3BhdGggZGlyZWN0b3JpZXMgb3IgamFycyB0byBzY2FuIGZvciBtZXRhZGF0\nYSBzdXBwbGllZAogICAgICogYnkgdXNlci4KICAgICAqLwogICAgcHVibGlj\nIHZvaWQgc2V0Q2xhc3NwYXRoU2NhbihDb2xsZWN0aW9uPFN0cmluZz4gY3Bh\ndGgpIHsKICAgICAgICB0aGlzLmNwYXRoID0gY3BhdGg7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBTZXQgb2YgY2xhc3NwYXRoIGRpcmVjdG9yaWVzIG9yIGph\ncnMgdG8gc2NhbiBmb3IgbWV0YWRhdGEgc3VwcGxpZWQKICAgICAqIGJ5IHVz\nZXIgdmlhIGF1dG8tY29uZmlndXJhdGlvbi4KICAgICAqLwogICAgcHVibGlj\nIHZvaWQgc2V0Q2xhc3NwYXRoU2NhbihTdHJpbmcgY3BhdGgpIHsKICAgICAg\nICAvLyBrZWVwIGxpc3QgbXV0YWJsZSBzbyBzdWJjbGFzc2VzIGNhbiBhZGQg\naW1wbGljaXQgbG9jYXRpb25zCiAgICAgICAgdGhpcy5jcGF0aCA9IChTdHJp\nbmdVdGlscy5pc0VtcHR5KGNwYXRoKSkgPyBudWxsCiAgICAgICAgICA6IG5l\ndyBBcnJheUxpc3Q8U3RyaW5nPihBcnJheXMuYXNMaXN0KFN0cmluZ3Muc3Bs\naXQoY3BhdGgsICI7IiwgMCkpKTsKICAgIH0KCiAgICBwdWJsaWMgYm9vbGVh\nbiBzdG9yZShDbGFzc01ldGFEYXRhW10gbWV0YXMsIFF1ZXJ5TWV0YURhdGFb\nXSBxdWVyaWVzLAogICAgICAgIFNlcXVlbmNlTWV0YURhdGFbXSBzZXFzLCBp\nbnQgbW9kZSwgTWFwPEZpbGUsU3RyaW5nPiBvdXRwdXQpIHsKICAgICAgICBp\nZiAobW9kZSA9PSBNT0RFX05PTkUpCiAgICAgICAgICAgIHJldHVybiB0cnVl\nOwogICAgICAgIGlmIChpc01hcHBpbmdPbmx5RmFjdG9yeSgpICYmIChtb2Rl\nICYgTU9ERV9NQVBQSU5HKSA9PSAwKQogICAgICAgICAgICByZXR1cm4gdHJ1\nZTsKCiAgICAgICAgaWYgKCFzdHJpY3QgJiYgKG1vZGUgJiBNT0RFX01FVEEp\nICE9IDApCiAgICAgICAgICAgIG1vZGUgfD0gTU9ERV9NQVBQSU5HOwogICAg\nICAgIENsYXNzPD8+IGNscyA9IChtZXRhcy5sZW5ndGggPT0gMCkgPyBudWxs\nIDogbWV0YXNbMF0uZ2V0RGVzY3JpYmVkVHlwZSgpOwogICAgICAgIENsYXNz\nTG9hZGVyIGxvYWRlciA9IHJlcG9zLmdldENvbmZpZ3VyYXRpb24oKS4KICAg\nICAgICAgICAgZ2V0Q2xhc3NSZXNvbHZlckluc3RhbmNlKCkuZ2V0Q2xhc3NM\nb2FkZXIoY2xzLCBudWxsKTsKICAgICAgICBNYXA8U3RyaW5nLENsYXNzTWV0\nYURhdGE+IGNsc05hbWVzID0gbmV3IEhhc2hNYXA8U3RyaW5nLENsYXNzTWV0\nYURhdGE+CiAgICAgICAgCSgoaW50KSAobWV0YXMubGVuZ3RoICogMS4zMyAr\nIDEpKTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IG1ldGFzLmxlbmd0\naDsgaSsrKQogICAgICAgICAgICBjbHNOYW1lcy5wdXQobWV0YXNbaV0uZ2V0\nRGVzY3JpYmVkVHlwZSgpLmdldE5hbWUoKSwgbWV0YXNbaV0pOwoKICAgICAg\nICAvLyBhc3NpZ24gZGVmYXVsdCBmaWxlcyBpZiBpbiBtZXRhZGF0YSBtb2Rl\nIChpbiBvdGhlciBtb2RlcyB3ZSBhc3N1bWUKICAgICAgICAvLyB0aGUgZmls\nZXMgd291bGQgaGF2ZSB0byBiZSByZWFkIGFscmVhZHkgdG8gY3JlYXRlIHRo\nZSBtZXRhZGF0YXMpCiAgICAgICAgU2V0IG1ldGFGaWxlcyA9IG51bGw7CiAg\nICAgICAgU2V0IHF1ZXJ5RmlsZXMgPSBudWxsOwogICAgICAgIGlmIChpc01h\ncHBpbmdPbmx5RmFjdG9yeSgpIHx8IChtb2RlICYgTU9ERV9NRVRBKSAhPSAw\nKQogICAgICAgICAgICBtZXRhRmlsZXMgPSBhc3NpZ25EZWZhdWx0TWV0YURh\ndGFGaWxlcyhtZXRhcywgcXVlcmllcywgc2VxcywgbW9kZSwKICAgICAgICAg\nICAgICAgIGNsc05hbWVzKTsKICAgICAgICBpZiAoIWlzTWFwcGluZ09ubHlG\nYWN0b3J5KCkgJiYgKG1vZGUgJiBNT0RFX1FVRVJZKSAhPSAwKQogICAgICAg\nICAgICBxdWVyeUZpbGVzID0gYXNzaWduRGVmYXVsdFF1ZXJ5RmlsZXMocXVl\ncmllcywgY2xzTmFtZXMpOwoKICAgICAgICAvLyBwYXJzZSBhbGwgZmlsZXMg\ndG8gYmUgc3VyZSB3ZSBkb24ndCBkZWxldGUgZXhpc3RpbmcgbWV0YWRhdGEg\nd2hlbgogICAgICAgIC8vIHdyaXRpbmcgb3V0IG5ldyBtZXRhZGF0YSwgdGhl\nbiBzZXJpYWxpemUKICAgICAgICBTZXJpYWxpemVyIHNlcjsKICAgICAgICBQ\nYXJzZXIgcGFyc2VyOwogICAgICAgIGlmIChtb2RlICE9IE1PREVfUVVFUlkp\nIHsKICAgICAgICAgICAgaW50IHNlcm1vZGUgPSAoaXNNYXBwaW5nT25seUZh\nY3RvcnkoKSkgPyBtb2RlIDogbW9kZSB8IE1PREVfTUVUQTsKICAgICAgICAg\nICAgaWYgKChtb2RlICYgTU9ERV9BTk5fTUFQUElORykgIT0gMCkKICAgICAg\nICAgICAgICAgIHNlciA9IG5ld0Fubm90YXRpb25TZXJpYWxpemVyKCk7CiAg\nICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIHNlciA9IG5ld1Nlcmlh\nbGl6ZXIoKTsKICAgICAgICAgICAgc2VyLnNldE1vZGUoc2VybW9kZSk7CiAg\nICAgICAgICAgIGlmIChtZXRhRmlsZXMgIT0gbnVsbCkgewogICAgICAgICAg\nICAgICAgcGFyc2VyID0gbmV3UGFyc2VyKGZhbHNlKTsKICAgICAgICAgICAg\nICAgIHBhcnNlci5zZXRNb2RlKHNlcm1vZGUpOwogICAgICAgICAgICAgICAg\ncGFyc2VyLnNldENsYXNzTG9hZGVyKGxvYWRlcik7CiAgICAgICAgICAgICAg\nICBwYXJzZShwYXJzZXIsIG1ldGFGaWxlcyk7CgogICAgICAgICAgICAgICAg\nTWV0YURhdGFSZXBvc2l0b3J5IHByID0gcGFyc2VyLmdldFJlcG9zaXRvcnko\nKTsKICAgICAgICAgICAgICAgIHByLnNldFNvdXJjZU1vZGUobW9kZSk7CiAg\nICAgICAgICAgICAgICBpZiAoaXNNYXBwaW5nT25seUZhY3RvcnkoKSkKICAg\nICAgICAgICAgICAgICAgICBwci5zZXRSZXNvbHZlKE1PREVfTk9ORSk7CiAg\nICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgcHIuc2V0\nUmVzb2x2ZShNT0RFX01BUFBJTkcsIGZhbHNlKTsKICAgICAgICAgICAgICAg\nIHNlci5hZGRBbGwocHIpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBm\nb3IgKGludCBpID0gMDsgaSA8IG1ldGFzLmxlbmd0aDsgaSsrKQogICAgICAg\nICAgICAgICAgc2VyLmFkZE1ldGFEYXRhKG1ldGFzW2ldKTsKICAgICAgICAg\nICAgaWYgKChtb2RlICYgTU9ERV9NQVBQSU5HKSAhPSAwKQogICAgICAgICAg\nICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBzZXFzLmxlbmd0aDsgaSsrKQog\nICAgICAgICAgICAgICAgICAgIHNlci5hZGRTZXF1ZW5jZU1ldGFEYXRhKHNl\ncXNbaV0pOwogICAgICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IHF1ZXJp\nZXMubGVuZ3RoOyBpKyspCiAgICAgICAgICAgICAgICBpZiAocXVlcmllc1tp\nXS5nZXRTb3VyY2VNb2RlKCkgIT0gTU9ERV9RVUVSWQogICAgICAgICAgICAg\nICAgICAgICYmIChxdWVyaWVzW2ldLmdldFNvdXJjZU1vZGUoKSAmIG1vZGUp\nICE9IDApCiAgICAgICAgICAgICAgICAgICAgc2VyLmFkZFF1ZXJ5TWV0YURh\ndGEocXVlcmllc1tpXSk7CgogICAgICAgICAgICBpbnQgZmxhZ3MgPSBzZXIu\nUFJFVFRZOwogICAgICAgICAgICBpZiAoKHN0b3JlICYgU1RPUkVfVkVSQk9T\nRSkgIT0gMCkKICAgICAgICAgICAgICAgIGZsYWdzIHw9IHNlci5WRVJCT1NF\nOwogICAgICAgICAgICBzZXJpYWxpemUoc2VyLCBvdXRwdXQsIGZsYWdzKTsK\nICAgICAgICB9CgogICAgICAgIC8vIGRvIHdlIGhhdmUgYW55IHF1ZXJpZXMg\nc3RvcmVkIGluIHF1ZXJ5IGZpbGVzPwogICAgICAgIGlmICghaXNNYXBwaW5n\nT25seUZhY3RvcnkoKSkgewogICAgICAgICAgICBib29sZWFuIHFGaWxlcyA9\nIHF1ZXJ5RmlsZXMgIT0gbnVsbDsKICAgICAgICAgICAgZm9yIChpbnQgaSA9\nIDA7ICFxRmlsZXMgJiYgaSA8IHF1ZXJpZXMubGVuZ3RoOyBpKyspCiAgICAg\nICAgICAgICAgICBxRmlsZXMgPSBxdWVyaWVzW2ldLmdldFNvdXJjZU1vZGUo\nKSA9PSBNT0RFX1FVRVJZOwogICAgICAgICAgICBpZiAocUZpbGVzKSB7CiAg\nICAgICAgICAgICAgICBpZiAoKG1vZGUgJiBNT0RFX0FOTl9NQVBQSU5HKSAh\nPSAwKQogICAgICAgICAgICAgICAgICAgIHNlciA9IG5ld0Fubm90YXRpb25T\nZXJpYWxpemVyKCk7CiAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAg\nICAgICAgICAgc2VyID0gbmV3U2VyaWFsaXplcigpOwogICAgICAgICAgICAg\nICAgc2VyLnNldE1vZGUoTU9ERV9RVUVSWSk7CiAgICAgICAgICAgICAgICBp\nZiAocXVlcnlGaWxlcyAhPSBudWxsKSB7CiAgICAgICAgICAgICAgICAgICAg\ncGFyc2VyID0gbmV3UGFyc2VyKGZhbHNlKTsKICAgICAgICAgICAgICAgICAg\nICBwYXJzZXIuc2V0TW9kZShNT0RFX1FVRVJZKTsKICAgICAgICAgICAgICAg\nICAgICBwYXJzZXIuc2V0Q2xhc3NMb2FkZXIobG9hZGVyKTsKICAgICAgICAg\nICAgICAgICAgICBwYXJzZShwYXJzZXIsIHF1ZXJ5RmlsZXMpOwogICAgICAg\nICAgICAgICAgICAgIHNlci5hZGRBbGwocGFyc2VyLmdldFJlcG9zaXRvcnko\nKSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBmb3IgKGlu\ndCBpID0gMDsgaSA8IHF1ZXJpZXMubGVuZ3RoOyBpKyspCiAgICAgICAgICAg\nICAgICAgICAgaWYgKHF1ZXJpZXNbaV0uZ2V0U291cmNlTW9kZSgpID09IE1P\nREVfUVVFUlkpCiAgICAgICAgICAgICAgICAgICAgICAgIHNlci5hZGRRdWVy\neU1ldGFEYXRhKHF1ZXJpZXNbaV0pOwogICAgICAgICAgICAgICAgc2VyaWFs\naXplKHNlciwgb3V0cHV0LCBzZXIuUFJFVFRZKTsKICAgICAgICAgICAgfQog\nICAgICAgIH0KICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBwdWJs\naWMgYm9vbGVhbiBkcm9wKENsYXNzW10gY2xzLCBpbnQgbW9kZSwgQ2xhc3NM\nb2FkZXIgZW52TG9hZGVyKSB7CiAgICAgICAgaWYgKG1vZGUgPT0gTU9ERV9O\nT05FKQogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICBpZiAoaXNN\nYXBwaW5nT25seUZhY3RvcnkoKSAmJiAobW9kZSAmIE1PREVfTUFQUElORykg\nPT0gMCkKICAgICAgICAgICAgcmV0dXJuIHRydWU7CgogICAgICAgIFBhcnNl\nciBwYXJzZXIgPSBuZXdQYXJzZXIoZmFsc2UpOwogICAgICAgIE1ldGFEYXRh\nUmVwb3NpdG9yeSBwciA9IHBhcnNlci5nZXRSZXBvc2l0b3J5KCk7CiAgICAg\nICAgcHIuc2V0U291cmNlTW9kZShNT0RFX01BUFBJTkcsIGZhbHNlKTsKICAg\nICAgICBwci5zZXRSZXNvbHZlKE1PREVfTUFQUElORywgZmFsc2UpOwoKICAg\nICAgICAvLyBwYXJzZSBtZXRhZGF0YSBmb3IgYWxsIHRoZXNlIGNsYXNzZXMK\nICAgICAgICBpZiAoKG1vZGUgJiAoTU9ERV9NRVRBIHwgTU9ERV9NQVBQSU5H\nKSkgIT0gMCkgewogICAgICAgICAgICBwYXJzZXIuc2V0TW9kZSgoaXNNYXBw\naW5nT25seUZhY3RvcnkoKSkgPyBtb2RlCiAgICAgICAgICAgICAgICA6IE1P\nREVfTUVUQSB8IE1PREVfTUFQUElORyB8IE1PREVfUVVFUlkpOwogICAgICAg\nICAgICBwYXJzZShwYXJzZXIsIGNscyk7CiAgICAgICAgfQogICAgICAgIGlm\nICghaXNNYXBwaW5nT25seUZhY3RvcnkoKSAmJiAobW9kZSAmIE1PREVfUVVF\nUlkpICE9IDApIHsKICAgICAgICAgICAgcGFyc2VyLnNldE1vZGUoTU9ERV9R\nVUVSWSk7CiAgICAgICAgICAgIHBhcnNlKHBhcnNlciwgY2xzKTsKICAgICAg\nICB9CgogICAgICAgIC8vIHJlbW92ZSBtZXRhZGF0YXMgZnJvbSByZXBvc2l0\nb3J5IG9yIGNsZWFyIHRoZWlyIG1hcHBpbmdzCiAgICAgICAgU2V0IGZpbGVz\nID0gbmV3IEhhc2hTZXQoKTsKICAgICAgICBTZXQgY2xzTmFtZXMgPSBudWxs\nOwogICAgICAgIGlmICgobW9kZSAmIChNT0RFX01FVEEgfCBNT0RFX01BUFBJ\nTkcpKSAhPSAwKSB7CiAgICAgICAgICAgIGNsc05hbWVzID0gbmV3IEhhc2hT\nZXQoKGludCkgKGNscy5sZW5ndGggKiAxLjMzICsgMSkpOwogICAgICAgICAg\nICBDbGFzc01ldGFEYXRhIG1ldGE7CiAgICAgICAgICAgIGZvciAoaW50IGkg\nPSAwOyBpIDwgY2xzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgICBp\nZiAoY2xzW2ldID09IG51bGwpCiAgICAgICAgICAgICAgICAgICAgY2xzTmFt\nZXMuYWRkKG51bGwpOwogICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAg\nICAgICAgICAgIGNsc05hbWVzLmFkZChjbHNbaV0uZ2V0TmFtZSgpKTsKICAg\nICAgICAgICAgICAgIG1ldGEgPSBwci5nZXRNZXRhRGF0YShjbHNbaV0sIGVu\ndkxvYWRlciwgZmFsc2UpOwogICAgICAgICAgICAgICAgaWYgKG1ldGEgIT0g\nbnVsbCkgewogICAgICAgICAgICAgICAgICAgIGlmIChnZXRTb3VyY2VGaWxl\nKG1ldGEpICE9IG51bGwpCiAgICAgICAgICAgICAgICAgICAgICAgIGZpbGVz\nLmFkZChnZXRTb3VyY2VGaWxlKG1ldGEpKTsKICAgICAgICAgICAgICAgICAg\nICBpZiAoKG1vZGUgJiBNT0RFX01FVEEpICE9IDApCiAgICAgICAgICAgICAg\nICAgICAgICAgIHByLnJlbW92ZU1ldGFEYXRhKG1ldGEpOwogICAgICAgICAg\nICAgICAgICAgIGVsc2UgaWYgKCFpc01hcHBpbmdPbmx5RmFjdG9yeSgpKQog\nICAgICAgICAgICAgICAgICAgICAgICBjbGVhck1hcHBpbmcobWV0YSk7CiAg\nICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAg\nICAgIC8vIHJlbW92ZSBxdWVyeSBtb2RlIG1ldGFkYXRhcyBzbyB3ZSBjYW4g\nc3RvcmUgdGhlbSBzZXBhcmF0ZWx5CiAgICAgICAgUXVlcnlNZXRhRGF0YVtd\nIHF1ZXJpZXMgPSBwci5nZXRRdWVyeU1ldGFEYXRhcygpOwogICAgICAgIExp\nc3QgcXFzID0gKCFpc01hcHBpbmdPbmx5RmFjdG9yeSgpICYmIChtb2RlICYg\nTU9ERV9RVUVSWSkgPT0gMCkKICAgICAgICAgICAgPyBudWxsIDogbmV3IEFy\ncmF5TGlzdCgpOwogICAgICAgIGJvb2xlYW4gcmVtOwogICAgICAgIENsYXNz\nIGRlZjsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IHF1ZXJpZXMubGVu\nZ3RoOyBpKyspIHsKICAgICAgICAgICAgaWYgKCFpc01hcHBpbmdPbmx5RmFj\ndG9yeSgpICYmIHF1ZXJpZXNbaV0uZ2V0U291cmNlRmlsZSgpICE9IG51bGwp\nCiAgICAgICAgICAgICAgICBmaWxlcy5hZGQocXVlcmllc1tpXS5nZXRTb3Vy\nY2VGaWxlKCkpOwogICAgICAgICAgICBkZWYgPSBxdWVyaWVzW2ldLmdldERl\nZmluaW5nVHlwZSgpOwogICAgICAgICAgICByZW0gPSAocXVlcmllc1tpXS5n\nZXRTb3VyY2VNb2RlKCkgJiBtb2RlKSAhPSAwCiAgICAgICAgICAgICAgICAm\nJiBjbHNOYW1lcy5jb250YWlucygoZGVmID09IG51bGwpID8gbnVsbCA6IGRl\nZi5nZXROYW1lKCkpOwogICAgICAgICAgICBpZiAocmVtIHx8ICghaXNNYXBw\naW5nT25seUZhY3RvcnkoKQogICAgICAgICAgICAgICAgJiYgcXVlcmllc1tp\nXS5nZXRTb3VyY2VNb2RlKCkgPT0gTU9ERV9RVUVSWSkpCiAgICAgICAgICAg\nICAgICBwci5yZW1vdmVRdWVyeU1ldGFEYXRhKHF1ZXJpZXNbaV0pOwogICAg\nICAgICAgICBpZiAocXFzICE9IG51bGwgJiYgcXVlcmllc1tpXS5nZXRTb3Vy\nY2VNb2RlKCkgPT0gTU9ERV9RVUVSWSAmJiAhcmVtKQogICAgICAgICAgICAg\nICAgcXFzLmFkZChxdWVyaWVzW2ldKTsKICAgICAgICB9CgogICAgICAgIC8v\nIHdyaXRlIG5ldyBtZXRhZGF0YSB3aXRob3V0IHJlbW92ZWQgaW5zdGFuY2Vz\nCiAgICAgICAgYmFja3VwQW5kRGVsZXRlKGZpbGVzKTsKICAgICAgICBTZXJp\nYWxpemVyIHNlcjsKICAgICAgICBpZiAoKG1vZGUgJiAoTU9ERV9NRVRBIHwg\nTU9ERV9NQVBQSU5HKSkgIT0gMCkgewogICAgICAgICAgICBzZXIgPSBuZXdT\nZXJpYWxpemVyKCk7CiAgICAgICAgICAgIHNlci5zZXRNb2RlKChpc01hcHBp\nbmdPbmx5RmFjdG9yeSgpKSA/IG1vZGUgOiBtb2RlIHwgTU9ERV9NRVRBKTsK\nICAgICAgICAgICAgc2VyLmFkZEFsbChwcik7CiAgICAgICAgICAgIC8vIHJl\nbW92ZSBmcm9tIHNlcmlhbGl6ZXIgcmF0aGVyIHRoYW4gZnJvbSByZXBvc2l0\nb3J5IGFib3ZlIHNvIHRoYXQKICAgICAgICAgICAgLy8gY2FsbGluZyBjb2Rl\nIGNhbiB0YWtlIGFkdmFudGFnZSBvZiBtZXRhZGF0YSBzdGlsbCBpbiByZXBv\ncwogICAgICAgICAgICBpZiAoaXNNYXBwaW5nT25seUZhY3RvcnkoKSkKICAg\nICAgICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgY2xzLmxlbmd0aDsg\naSsrKQogICAgICAgICAgICAgICAgICAgIHNlci5yZW1vdmVNZXRhRGF0YShw\nci5nZXRNZXRhRGF0YShjbHNbaV0sIGVudkxvYWRlciwKICAgICAgICAgICAg\nICAgICAgICAgICAgZmFsc2UpKTsKICAgICAgICAgICAgc2VyaWFsaXplKHNl\nciwgbnVsbCwgU2VyaWFsaXplci5QUkVUVFkpOwogICAgICAgIH0KICAgICAg\nICBpZiAocXFzICE9IG51bGwgJiYgIXFxcy5pc0VtcHR5KCkpIHsKICAgICAg\nICAgICAgc2VyID0gbmV3U2VyaWFsaXplcigpOwogICAgICAgICAgICBzZXIu\nc2V0TW9kZShNT0RFX1FVRVJZKTsKICAgICAgICAgICAgZm9yIChpbnQgaSA9\nIDA7IGkgPCBxcXMuc2l6ZSgpOyBpKyspCiAgICAgICAgICAgICAgICBzZXIu\nYWRkUXVlcnlNZXRhRGF0YSgoUXVlcnlNZXRhRGF0YSkgcXFzLmdldChpKSk7\nCiAgICAgICAgICAgIHNlcmlhbGl6ZShzZXIsIG51bGwsIFNlcmlhbGl6ZXIu\nUFJFVFRZKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBBc3NpZ24gZGVmYXVsdCBzb3VyY2UgZmlsZXMg\ndG8gdGhlIGdpdmVuIG1ldGFkYXRhcy4KICAgICAqCiAgICAgKiBAcGFyYW0g\nY2xzTmFtZXMgbWFwIG9mIGNsYXNzIG5hbWVzIHRvIG1ldGFkYXRhcwogICAg\nICogQHJldHVybiBzZXQgb2YgZXhpc3RpbmcgZmlsZXMgdXNlZCBieSB0aGVz\nZSBtZXRhZGF0YXMsIG9yCiAgICAgKiBudWxsIGlmIG5vIGV4aXN0aW5nIGZp\nbGVzCiAgICAgKi8KICAgIHByaXZhdGUgU2V0IGFzc2lnbkRlZmF1bHRNZXRh\nRGF0YUZpbGVzKENsYXNzTWV0YURhdGFbXSBtZXRhcywKICAgICAgICBRdWVy\neU1ldGFEYXRhW10gcXVlcmllcywgU2VxdWVuY2VNZXRhRGF0YVtdIHNlcXMs\nIGludCBtb2RlLAogICAgICAgIE1hcCBjbHNOYW1lcykgewogICAgICAgIFNl\ndCBmaWxlcyA9IG51bGw7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBt\nZXRhcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBpZiAoZ2V0U291cmNl\nRmlsZShtZXRhc1tpXSkgPT0gbnVsbCkKICAgICAgICAgICAgICAgIHNldFNv\ndXJjZUZpbGUobWV0YXNbaV0sIGRlZmF1bHRTb3VyY2VGaWxlKG1ldGFzW2ld\nKSk7CiAgICAgICAgICAgIGlmICgoQWNjZXNzQ29udHJvbGxlci5kb1ByaXZp\nbGVnZWQoSjJEb1ByaXZIZWxwZXIKICAgICAgICAgICAgICAgIC5leGlzdHNB\nY3Rpb24oZ2V0U291cmNlRmlsZShtZXRhc1tpXSkpKSkuYm9vbGVhblZhbHVl\nKCkpIHsKICAgICAgICAgICAgICAgIGlmIChmaWxlcyA9PSBudWxsKQogICAg\nICAgICAgICAgICAgICAgIGZpbGVzID0gbmV3IEhhc2hTZXQoKTsKICAgICAg\nICAgICAgICAgIGZpbGVzLmFkZChnZXRTb3VyY2VGaWxlKG1ldGFzW2ldKSk7\nCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgZm9yIChpbnQgaSA9\nIDA7IGkgPCBxdWVyaWVzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGlm\nIChxdWVyaWVzW2ldLmdldFNvdXJjZU1vZGUoKSA9PSBNT0RFX1FVRVJZCiAg\nICAgICAgICAgICAgICB8fCAobW9kZSAmIHF1ZXJpZXNbaV0uZ2V0U291cmNl\nTW9kZSgpKSA9PSAwKQogICAgICAgICAgICAgICAgY29udGludWU7CiAgICAg\nICAgICAgIGlmIChxdWVyaWVzW2ldLmdldFNvdXJjZUZpbGUoKSA9PSBudWxs\nKQogICAgICAgICAgICAgICAgcXVlcmllc1tpXS5zZXRTb3VyY2UoZGVmYXVs\ndFNvdXJjZUZpbGUocXVlcmllc1tpXSwKICAgICAgICAgICAgICAgICAgICBj\nbHNOYW1lcyksIHF1ZXJpZXNbaV0uZ2V0U291cmNlU2NvcGUoKSwKICAgICAg\nICAgICAgICAgICAgICBxdWVyaWVzW2ldLmdldFNvdXJjZVR5cGUoKSk7CiAg\nICAgICAgICAgIGlmICgoQWNjZXNzQ29udHJvbGxlci5kb1ByaXZpbGVnZWQo\nCiAgICAgICAgICAgICAgICBKMkRvUHJpdkhlbHBlci5leGlzdHNBY3Rpb24o\ncXVlcmllc1tpXS5nZXRTb3VyY2VGaWxlKCkpKSkKICAgICAgICAgICAgICAg\nIC5ib29sZWFuVmFsdWUoKSkgewogICAgICAgICAgICAgICAgaWYgKGZpbGVz\nID09IG51bGwpCiAgICAgICAgICAgICAgICAgICAgZmlsZXMgPSBuZXcgSGFz\naFNldCgpOwogICAgICAgICAgICAgICAgZmlsZXMuYWRkKHF1ZXJpZXNbaV0u\nZ2V0U291cmNlRmlsZSgpKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAg\nICAgICBpZiAoKG1vZGUgJiBNT0RFX01BUFBJTkcpICE9IDApIHsKICAgICAg\nICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBzZXFzLmxlbmd0aDsgaSsrKSB7\nCiAgICAgICAgICAgICAgICBpZiAoZ2V0U291cmNlRmlsZShzZXFzW2ldKSA9\nPSBudWxsKQogICAgICAgICAgICAgICAgICAgIHNldFNvdXJjZUZpbGUoc2Vx\nc1tpXSwgZGVmYXVsdFNvdXJjZUZpbGUoc2Vxc1tpXSwKICAgICAgICAgICAg\nICAgICAgICAgICAgY2xzTmFtZXMpKTsKICAgICAgICAgICAgICAgIGlmICgo\nQWNjZXNzQ29udHJvbGxlci5kb1ByaXZpbGVnZWQoCiAgICAgICAgICAgICAg\nICAgICAgSjJEb1ByaXZIZWxwZXIuZXhpc3RzQWN0aW9uKGdldFNvdXJjZUZp\nbGUoc2Vxc1tpXSkpKSkKICAgICAgICAgICAgICAgICAgICAuYm9vbGVhblZh\nbHVlKCkpIHsKICAgICAgICAgICAgICAgICAgICBpZiAoZmlsZXMgPT0gbnVs\nbCkKICAgICAgICAgICAgICAgICAgICAgICAgZmlsZXMgPSBuZXcgSGFzaFNl\ndCgpOwogICAgICAgICAgICAgICAgICAgIGZpbGVzLmFkZChnZXRTb3VyY2VG\naWxlKHNlcXNbaV0pKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAg\nfQogICAgICAgIH0KICAgICAgICByZXR1cm4gZmlsZXM7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBBc3NpZ24gZGVmYXVsdCBzb3VyY2UgZmlsZXMgdG8gdGhl\nIGdpdmVuIHF1ZXJpZXMuCiAgICAgKgogICAgICogQHBhcmFtIGNsc05hbWVz\nIG1hcCBvZiBjbGFzcyBuYW1lcyB0byBtZXRhZGF0YXMKICAgICAqIEByZXR1\ncm4gc2V0IG9mIGV4aXN0aW5nIGZpbGVzIHVzZWQgYnkgdGhlc2UgbWV0YWRh\ndGFzLCBvcgogICAgICogbnVsbCBpZiBubyBleGlzdGluZyBmaWxlcwogICAg\nICovCiAgICBwcml2YXRlIFNldCBhc3NpZ25EZWZhdWx0UXVlcnlGaWxlcyhR\ndWVyeU1ldGFEYXRhW10gcXVlcmllcywKICAgICAgICBNYXAgY2xzTmFtZXMp\nIHsKICAgICAgICBTZXQgZmlsZXMgPSBudWxsOwogICAgICAgIGZvciAoaW50\nIGkgPSAwOyBpIDwgcXVlcmllcy5sZW5ndGg7IGkrKykgewogICAgICAgICAg\nICBpZiAocXVlcmllc1tpXS5nZXRTb3VyY2VNb2RlKCkgIT0gTU9ERV9RVUVS\nWSkKICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICBpZiAo\ncXVlcmllc1tpXS5nZXRTb3VyY2VGaWxlKCkgPT0gbnVsbCkKICAgICAgICAg\nICAgICAgIHF1ZXJpZXNbaV0uc2V0U291cmNlKGRlZmF1bHRTb3VyY2VGaWxl\nKHF1ZXJpZXNbaV0sIGNsc05hbWVzKSwKICAgICAgICAgICAgICAgICAgICBx\ndWVyaWVzW2ldLmdldFNvdXJjZVNjb3BlKCksIHF1ZXJpZXNbaV0uZ2V0U291\ncmNlVHlwZSgpKTsKICAgICAgICAgICAgaWYgKChBY2Nlc3NDb250cm9sbGVy\nLmRvUHJpdmlsZWdlZCgKICAgICAgICAgICAgICAgIEoyRG9Qcml2SGVscGVy\nLmV4aXN0c0FjdGlvbihxdWVyaWVzW2ldLmdldFNvdXJjZUZpbGUoKSkpKQog\nICAgICAgICAgICAgICAgLmJvb2xlYW5WYWx1ZSgpKSB7CiAgICAgICAgICAg\nICAgICBpZiAoZmlsZXMgPT0gbnVsbCkKICAgICAgICAgICAgICAgICAgICBm\naWxlcyA9IG5ldyBIYXNoU2V0KCk7CiAgICAgICAgICAgICAgICBmaWxlcy5h\nZGQocXVlcmllc1tpXS5nZXRTb3VyY2VGaWxlKCkpOwogICAgICAgICAgICB9\nCiAgICAgICAgfQogICAgICAgIHJldHVybiBmaWxlczsKICAgIH0KCiAgICAv\nKioKICAgICAqIFJldHVybiB0cnVlIGlmIHRoaXMgZmFjdG9yeSBkZWFscyBv\nbmx5IHdpdGggbWFwcGluZyBkYXRhLCBhbmQgcmVsaWVzCiAgICAgKiBvbiBh\nIHNlcGFyYXRlIGZhY3RvcnkgZm9yIG1ldGFkYXRhLgogICAgICovCiAgICBw\ncm90ZWN0ZWQgYm9vbGVhbiBpc01hcHBpbmdPbmx5RmFjdG9yeSgpIHsKICAg\nICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgLyoqCiAgICAgKiBQYXJz\nZSBhbGwgZ2l2ZW4gZmlsZXMuCiAgICAgKi8KICAgIHByb3RlY3RlZCB2b2lk\nIHBhcnNlKE1ldGFEYXRhUGFyc2VyIHBhcnNlciwgQ29sbGVjdGlvbiBmaWxl\ncykgewogICAgICAgIHRyeSB7CiAgICAgICAgICAgIGZvciAoSXRlcmF0b3Ig\naXRyID0gZmlsZXMuaXRlcmF0b3IoKTsgaXRyLmhhc05leHQoKTspCiAgICAg\nICAgICAgICAgICBwYXJzZXIucGFyc2UoKEZpbGUpIGl0ci5uZXh0KCkpOwog\nICAgICAgIH0gY2F0Y2ggKElPRXhjZXB0aW9uIGlvZSkgewogICAgICAgICAg\nICB0aHJvdyBuZXcgR2VuZXJhbEV4Y2VwdGlvbihpb2UpOwogICAgICAgIH0K\nICAgIH0KCiAgICAvKioKICAgICAqIFBhcnNlIGFsbCBnaXZlbiBjbGFzc3Nl\ncy4KICAgICAqLwogICAgcHJvdGVjdGVkIHZvaWQgcGFyc2UoTWV0YURhdGFQ\nYXJzZXIgcGFyc2VyLCBDbGFzc1tdIGNscykgewogICAgICAgIHRyeSB7CiAg\nICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgY2xzLmxlbmd0aDsgaSsr\nKQogICAgICAgICAgICAgICAgcGFyc2VyLnBhcnNlKGNsc1tpXSwgaXNQYXJz\nZVRvcERvd24oKSk7CiAgICAgICAgfSBjYXRjaCAoSU9FeGNlcHRpb24gaW9l\nKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBHZW5lcmFsRXhjZXB0aW9uKGlv\nZSk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogV2hldGhlciB0\nbyBwYXJzZSBjbGFzc2VzIHRvcCBkb3duLiBEZWZhdWx0cyB0byBmYWxzZS4K\nICAgICAqLwogICAgcHJvdGVjdGVkIGJvb2xlYW4gaXNQYXJzZVRvcERvd24o\nKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIC8qKgogICAg\nICogVGVsbCB0aGUgZ2l2ZW4gc2VyaWFsaWVyIHRvIHdyaXRlIGl0cyBtZXRh\nZGF0YXMuCiAgICAgKi8KICAgIHByb3RlY3RlZCB2b2lkIHNlcmlhbGl6ZShN\nZXRhRGF0YVNlcmlhbGl6ZXIgc2VyLCBNYXA8RmlsZSwgU3RyaW5nPiBvdXRw\ndXQsCiAgICAgICAgaW50IGZsYWdzKSB7CiAgICAgICAgdHJ5IHsKICAgICAg\nICAgICAgaWYgKG91dHB1dCA9PSBudWxsKQogICAgICAgICAgICAgICAgc2Vy\nLnNlcmlhbGl6ZShmbGFncyk7CiAgICAgICAgICAgIGVsc2UKICAgICAgICAg\nICAgICAgIHNlci5zZXJpYWxpemUob3V0cHV0LCBmbGFncyk7CiAgICAgICAg\nfSBjYXRjaCAoSU9FeGNlcHRpb24gaW9lKSB7CiAgICAgICAgICAgIHRocm93\nIG5ldyBHZW5lcmFsRXhjZXB0aW9uKGlvZSk7CiAgICAgICAgfQogICAgfQoK\nICAgIC8qKgogICAgICogQmFja3VwIGFuZCBkZWxldGUgdGhlIHNvdXJjZSBm\naWxlcyBmb3IgdGhlIGdpdmVuIG1ldGFkYXRhcy4KICAgICAqLwogICAgcHJv\ndGVjdGVkIHZvaWQgYmFja3VwQW5kRGVsZXRlKENvbGxlY3Rpb24gZmlsZXMp\nIHsKICAgICAgICBGaWxlIGZpbGU7CiAgICAgICAgZm9yIChJdGVyYXRvciBp\ndHIgPSBmaWxlcy5pdGVyYXRvcigpOyBpdHIuaGFzTmV4dCgpOykgewogICAg\nICAgICAgICBmaWxlID0gKEZpbGUpIGl0ci5uZXh0KCk7CiAgICAgICAgICAg\nIGlmIChGaWxlcy5iYWNrdXAoZmlsZSwgZmFsc2UpICE9IG51bGwpCiAgICAg\nICAgICAgICAgICBBY2Nlc3NDb250cm9sbGVyCiAgICAgICAgICAgICAgICAg\nICAgLmRvUHJpdmlsZWdlZChKMkRvUHJpdkhlbHBlci5kZWxldGVBY3Rpb24o\nZmlsZSkpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIENsZWFy\nIG1hcHBpbmcgaW5mb3JtYXRpb24gZnJvbSB0aGUgZ2l2ZW4gbWV0YWRhdGEu\nCiAgICAgKi8KICAgIHByb3RlY3RlZCB2b2lkIGNsZWFyTWFwcGluZyhDbGFz\nc01ldGFEYXRhIG1ldGEpIHsKICAgICAgICBtZXRhLnNldFNvdXJjZU1vZGUo\nTU9ERV9NQVBQSU5HLCBmYWxzZSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBS\nZXR1cm4gdGhlIGN1cnJlbnQgc291cmNlIGZpbGUgb2YgdGhlIGdpdmVuIG1l\ndGFkYXRhLgogICAgICovCiAgICBwcm90ZWN0ZWQgRmlsZSBnZXRTb3VyY2VG\naWxlKENsYXNzTWV0YURhdGEgbWV0YSkgewogICAgICAgIHJldHVybiBtZXRh\nLmdldFNvdXJjZUZpbGUoKTsKICAgIH0KCiAgICAvKioKICAgICAqIFNldCB0\naGUgY3VycmVudCBzb3VyY2UgZmlsZSBvZiB0aGUgZ2l2ZW4gbWV0YWRhdGEu\nCiAgICAgKi8KICAgIHByb3RlY3RlZCB2b2lkIHNldFNvdXJjZUZpbGUoQ2xh\nc3NNZXRhRGF0YSBtZXRhLCBGaWxlIHNvdXJjZUZpbGUpIHsKICAgICAgICBt\nZXRhLnNldFNvdXJjZShzb3VyY2VGaWxlLCBtZXRhLmdldFNvdXJjZVR5cGUo\nKSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIGN1cnJlbnQg\nc291cmNlIGZpbGUgb2YgdGhlIGdpdmVuIG1ldGFkYXRhLgogICAgICovCiAg\nICBwcm90ZWN0ZWQgRmlsZSBnZXRTb3VyY2VGaWxlKFNlcXVlbmNlTWV0YURh\ndGEgbWV0YSkgewogICAgICAgIHJldHVybiBtZXRhLmdldFNvdXJjZUZpbGUo\nKTsKICAgIH0KCiAgICAvKioKICAgICAqIFNldCB0aGUgY3VycmVudCBzb3Vy\nY2UgZmlsZSBvZiB0aGUgZ2l2ZW4gbWV0YWRhdGEuCiAgICAgKi8KICAgIHBy\nb3RlY3RlZCB2b2lkIHNldFNvdXJjZUZpbGUoU2VxdWVuY2VNZXRhRGF0YSBt\nZXRhLCBGaWxlIHNvdXJjZUZpbGUpIHsKICAgICAgICBtZXRhLnNldFNvdXJj\nZShzb3VyY2VGaWxlLCBtZXRhLmdldFNvdXJjZVNjb3BlKCksCiAgICAgICAg\nICAgIG1ldGEuZ2V0U291cmNlVHlwZSgpKTsKICAgIH0KCiAgICAvKioKICAg\nICAqIFJldHVybiB0aGUgZGVmYXVsdCBmaWxlIGZvciB0aGUgZ2l2ZW4gbWV0\nYWRhdGEuCiAgICAgKi8KICAgIHByb3RlY3RlZCBhYnN0cmFjdCBGaWxlIGRl\nZmF1bHRTb3VyY2VGaWxlKENsYXNzTWV0YURhdGEgbWV0YSk7CgogICAgLyoq\nCiAgICAgKiBSZXR1cm4gYSBkZWZhdWx0IGZpbGUgZm9yIHRoZSBnaXZlbiBx\ndWVyeS4KICAgICAqLwogICAgcHJvdGVjdGVkIGFic3RyYWN0IEZpbGUgZGVm\nYXVsdFNvdXJjZUZpbGUoUXVlcnlNZXRhRGF0YSBxdWVyeSwKICAgICAgICBN\nYXAgY2xzTmFtZXMpOwoKICAgIC8qKgogICAgICogUmV0dXJuIGEgZGVmYXVs\ndCBmaWxlIGZvciB0aGUgZ2l2ZW4gc2VxdWVuY2UuCiAgICAgKi8KICAgIHBy\nb3RlY3RlZCBhYnN0cmFjdCBGaWxlIGRlZmF1bHRTb3VyY2VGaWxlKFNlcXVl\nbmNlTWV0YURhdGEgc2VxLAogICAgICAgIE1hcCBjbHNOYW1lcyk7CgogICAg\nLyoqCiAgICAgKiBDcmVhdGUgYSBuZXcgbWV0YWRhdGEgcGFyc2VyLgogICAg\nICoKICAgICAqIEBwYXJhbSBsb2FkaW5nIGlmIHRydWUsIHRoaXMgd2lsbCBi\nZSB0aGUgY2FjaGVkIHBhcnNlciB1c2VkIGZvcgogICAgICogbG9hZGluZyBt\nZXRhZGF0YQogICAgICovCiAgICBwcm90ZWN0ZWQgYWJzdHJhY3QgUGFyc2Vy\nIG5ld1BhcnNlcihib29sZWFuIGxvYWRpbmcpOwoKICAgIC8qKgogICAgICog\nQ3JlYXRlIGEgbmV3IG1ldGFkYXRhIHNlcmlhbGl6ZXIuCiAgICAgKi8KICAg\nIHByb3RlY3RlZCBhYnN0cmFjdCBTZXJpYWxpemVyIG5ld1NlcmlhbGl6ZXIo\nKTsKCiAgICAvKioKICAgICAqIENyZWF0ZSBhIG5ldyBhbm5vdGF0aW9uIG1l\ndGFkYXRhIHNlcmlhbGl6ZXIuCiAgICAgKi8KICAgIHByb3RlY3RlZCBhYnN0\ncmFjdCBTZXJpYWxpemVyIG5ld0Fubm90YXRpb25TZXJpYWxpemVyKCk7Cgog\nICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIG1ldGFkYXRhIHRoYXQgZGVmaW5l\ncyB0aGUgZ2l2ZW4gcXVlcnksIGlmIGFueS4KICAgICAqCiAgICAgKiBAcGFy\nYW0gY2xzTmFtZXMgbWFwIG9mIGNsYXNzIG5hbWVzIHRvIG1ldGFkYXRhcwog\nICAgICovCiAgICBwcm90ZWN0ZWQgQ2xhc3NNZXRhRGF0YSBnZXREZWZpbmlu\nZ01ldGFEYXRhKFF1ZXJ5TWV0YURhdGEgcXVlcnksCiAgICAgICAgTWFwIGNs\nc05hbWVzKSB7CiAgICAgICAgQ2xhc3MgZGVmID0gcXVlcnkuZ2V0RGVmaW5p\nbmdUeXBlKCk7CiAgICAgICAgaWYgKGRlZiAhPSBudWxsKQogICAgICAgICAg\nICByZXR1cm4gKENsYXNzTWV0YURhdGEpIGNsc05hbWVzLmdldChkZWYuZ2V0\nTmFtZSgpKTsKCiAgICAgICAgTWFwLkVudHJ5IGVudHJ5OwogICAgICAgIFN0\ncmluZyBwa2c7CiAgICAgICAgZm9yIChJdGVyYXRvciBpdHIgPSBjbHNOYW1l\ncy5lbnRyeVNldCgpLml0ZXJhdG9yKCk7IGl0ci5oYXNOZXh0KCk7KSB7CiAg\nICAgICAgICAgIGVudHJ5ID0gKE1hcC5FbnRyeSkgaXRyLm5leHQoKTsKICAg\nICAgICAgICAgcGtnID0gU3RyaW5ncy5nZXRQYWNrYWdlTmFtZSgoU3RyaW5n\nKSBlbnRyeS5nZXRLZXkoKSk7CiAgICAgICAgICAgIGlmIChwa2cubGVuZ3Ro\nKCkgPT0gMCkKICAgICAgICAgICAgICAgIHJldHVybiAoQ2xhc3NNZXRhRGF0\nYSkgZW50cnkuZ2V0VmFsdWUoKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJu\nIG51bGw7CiAgICB9CgogICAgcHVibGljIFNldDxTdHJpbmc+IGdldFBlcnNp\nc3RlbnRUeXBlTmFtZXMoYm9vbGVhbiBkZXZwYXRoLCAKICAgIAlDbGFzc0xv\nYWRlciBlbnZMb2FkZXIpIHsKICAgICAgICAvLyBzb21lIGNvbmZpZ3VyZWQg\nbG9jYXRpb25zIG1pZ2h0IGJlIGltcGxpY2l0IGluIHNwZWMsIHNvIHJldHVy\nbgogICAgICAgIC8vIG51bGwgaWYgd2UgZG9uJ3QgZmluZCBhbnkgY2xhc3Nl\ncywgcmF0aGVyIHRoYW4gaWYgd2UgZG9uJ3QgaGF2ZQogICAgICAgIC8vIGFu\neSBsb2NhdGlvbnMKICAgICAgICBpZiAoX3R5cGVOYW1lcyAhPSBudWxsKQog\nICAgICAgICAgICByZXR1cm4gKF90eXBlTmFtZXMuaXNFbXB0eSgpKSA/IG51\nbGwgOiBfdHlwZU5hbWVzOwoKICAgICAgICB0cnkgewogICAgICAgICAgICBD\nbGFzc0xvYWRlciBsb2FkZXIgPSByZXBvcy5nZXRDb25maWd1cmF0aW9uKCku\nCiAgICAgICAgICAgICAgICBnZXRDbGFzc1Jlc29sdmVySW5zdGFuY2UoKS5n\nZXRDbGFzc0xvYWRlcihnZXRDbGFzcygpLAogICAgICAgICAgICAgICAgZW52\nTG9hZGVyKTsKICAgICAgICAgICAgbG9uZyBzdGFydCA9IFN5c3RlbS5jdXJy\nZW50VGltZU1pbGxpcygpOwoKICAgICAgICAgICAgU2V0IG5hbWVzID0gcGFy\nc2VQZXJzaXN0ZW50VHlwZU5hbWVzKGxvYWRlcik7CiAgICAgICAgICAgIGlm\nIChuYW1lcy5pc0VtcHR5KCkgJiYgZGV2cGF0aCkKICAgICAgICAgICAgICAg\nIHNjYW4obmV3IENsYXNzcGF0aE1ldGFEYXRhSXRlcmF0b3IobnVsbCwgbmV3\nTWV0YURhdGFGaWx0ZXIoKSksCiAgICAgICAgICAgICAgICAgICAgbmV3Q2xh\nc3NBcmdQYXJzZXIoKSwgbmFtZXMsIGZhbHNlLCBudWxsKTsKICAgICAgICAg\nICAgZWxzZSAvLyB3ZSBkb24ndCBjYWNoZSBhIGZ1bGwgZGV2IGNwIHNjYW4K\nICAgICAgICAgICAgICAgIF90eXBlTmFtZXMgPSBuYW1lczsKCiAgICAgICAg\nICAgIGlmIChsb2cuaXNUcmFjZUVuYWJsZWQoKSkKICAgICAgICAgICAgICAg\nIGxvZy50cmFjZShfbG9jLmdldCgiZm91bmQtcGNzIiwgU3RyaW5nLnZhbHVl\nT2YobmFtZXMuc2l6ZSgpKSwKICAgICAgICAgICAgICAgICAgICBTdHJpbmcu\ndmFsdWVPZihTeXN0ZW0uY3VycmVudFRpbWVNaWxsaXMoKSAtIHN0YXJ0KSkp\nOwogICAgICAgICAgICByZXR1cm4gKG5hbWVzLmlzRW1wdHkoKSkgPyBudWxs\nIDogbmFtZXM7CiAgICAgICAgfSBjYXRjaCAoSU9FeGNlcHRpb24gaW9lKSB7\nCiAgICAgICAgICAgIHRocm93IG5ldyBHZW5lcmFsRXhjZXB0aW9uKGlvZSk7\nCiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogUGFyc2UgcGVyc2lz\ndGVudCB0eXBlIG5hbWVzLgogICAgICovCiAgICBwcm90ZWN0ZWQgU2V0PFN0\ncmluZz4gcGFyc2VQZXJzaXN0ZW50VHlwZU5hbWVzKENsYXNzTG9hZGVyIGxv\nYWRlcikKICAgICAgICB0aHJvd3MgSU9FeGNlcHRpb24gewogICAgICAgIENs\nYXNzQXJnUGFyc2VyIGNwYXJzZXIgPSBuZXdDbGFzc0FyZ1BhcnNlcigpOwog\nICAgICAgIFN0cmluZ1tdIGNsc3M7CiAgICAgICAgU2V0PFN0cmluZz4gbmFt\nZXMgPSBuZXcgSGFzaFNldDxTdHJpbmc+KCk7CiAgICAgICAgaWYgKGZpbGVz\nICE9IG51bGwpIHsKICAgICAgICAgICAgRmlsZSBmaWxlOwogICAgICAgICAg\nICBmb3IgKEl0ZXJhdG9yIGl0ciA9IGZpbGVzLml0ZXJhdG9yKCk7IGl0ci5o\nYXNOZXh0KCk7KSB7CiAgICAgICAgICAgICAgICBmaWxlID0gKEZpbGUpIGl0\nci5uZXh0KCk7CiAgICAgICAgICAgICAgICBpZiAoKEFjY2Vzc0NvbnRyb2xs\nZXIuZG9Qcml2aWxlZ2VkKEoyRG9Qcml2SGVscGVyCiAgICAgICAgICAgICAg\nICAgICAgLmlzRGlyZWN0b3J5QWN0aW9uKGZpbGUpKSkuYm9vbGVhblZhbHVl\nKCkpIHsKICAgICAgICAgICAgICAgICAgICBpZiAobG9nLmlzVHJhY2VFbmFi\nbGVkKCkpCiAgICAgICAgICAgICAgICAgICAgICAgIGxvZy50cmFjZShfbG9j\nLmdldCgic2Nhbm5pbmctZGlyZWN0b3J5IiwgZmlsZSkpOwogICAgICAgICAg\nICAgICAgICAgIHNjYW4obmV3IEZpbGVNZXRhRGF0YUl0ZXJhdG9yKGZpbGUs\nIG5ld01ldGFEYXRhRmlsdGVyKCkpLAogICAgICAgICAgICAgICAgICAgICAg\nICBjcGFyc2VyLCBuYW1lcywgdHJ1ZSwgZmlsZSk7CiAgICAgICAgICAgICAg\nICB9IGVsc2UgaWYgKGZpbGUuZ2V0TmFtZSgpLmVuZHNXaXRoKCIuamFyIikp\nIHsKICAgICAgICAgICAgICAgICAgICBpZiAobG9nLmlzVHJhY2VFbmFibGVk\nKCkpCiAgICAgICAgICAgICAgICAgICAgICAgIGxvZy50cmFjZShfbG9jLmdl\ndCgic2Nhbm5pbmctamFyIiwgZmlsZSkpOwogICAgICAgICAgICAgICAgICAg\nIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgICAgIFppcEZpbGUgekZpbGUg\nPSBBY2Nlc3NDb250cm9sbGVyCiAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAuZG9Qcml2aWxlZ2VkKEoyRG9Qcml2SGVscGVyCiAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgLm5ld1ppcEZpbGVBY3Rpb24oZmlsZSkpOwog\nICAgICAgICAgICAgICAgICAgICAgICBzY2FuKG5ldyBaaXBGaWxlTWV0YURh\ndGFJdGVyYXRvcih6RmlsZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAg\nIG5ld01ldGFEYXRhRmlsdGVyKCkpLCBjcGFyc2VyLCBuYW1lcywgdHJ1ZSwg\nZmlsZSk7CiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoUHJpdmlsZWdl\nZEFjdGlvbkV4Y2VwdGlvbiBwYWUpIHsKICAgICAgICAgICAgICAgICAgICAg\nICAgdGhyb3cgKElPRXhjZXB0aW9uKSBwYWUuZ2V0RXhjZXB0aW9uKCk7CiAg\nICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSBlbHNlIHsK\nICAgICAgICAgICAgICAgICAgICBpZiAobG9nLmlzVHJhY2VFbmFibGVkKCkp\nCiAgICAgICAgICAgICAgICAgICAgICAgIGxvZy50cmFjZShfbG9jLmdldCgi\nc2Nhbm5pbmctZmlsZSIsIGZpbGUpKTsKICAgICAgICAgICAgICAgICAgICBj\nbHNzID0gY3BhcnNlci5wYXJzZVR5cGVOYW1lcyhuZXcgRmlsZU1ldGFEYXRh\nSXRlcmF0b3IKICAgICAgICAgICAgICAgICAgICAgICAgKGZpbGUpKTsKICAg\nICAgICAgICAgICAgICAgICBMaXN0PFN0cmluZz4gbmV3TmFtZXMgPSBBcnJh\neXMuYXNMaXN0KGNsc3MpOwogICAgICAgICAgICAgICAgICAgIGlmIChsb2cu\naXNUcmFjZUVuYWJsZWQoKSkKICAgICAgICAgICAgICAgICAgICAgICAgbG9n\nLnRyYWNlKF9sb2MuZ2V0KCJzY2FuLWZvdW5kLW5hbWVzIiwgbmV3TmFtZXMs\nIGZpbGUpKTsKICAgICAgICAgICAgICAgICAgICBuYW1lcy5hZGRBbGwobmV3\nTmFtZXMpOwogICAgICAgICAgICAgICAgICAgIEZpbGUgZiA9IEFjY2Vzc0Nv\nbnRyb2xsZXIKICAgICAgICAgICAgICAgICAgICAgICAgLmRvUHJpdmlsZWdl\nZChKMkRvUHJpdkhlbHBlcgogICAgICAgICAgICAgICAgICAgICAgICAgICAg\nLmdldEFic29sdXRlRmlsZUFjdGlvbihmaWxlKSk7CiAgICAgICAgICAgICAg\nICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICAgICAgbWFwUGVyc2lz\ndGVudFR5cGVOYW1lcyhBY2Nlc3NDb250cm9sbGVyCiAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAuZG9Qcml2aWxlZ2VkKEoyRG9Qcml2SGVscGVyLnRv\nVVJMQWN0aW9uKGYpKSwgY2xzcyk7CiAgICAgICAgICAgICAgICAgICAgfSBj\nYXRjaCAoUHJpdmlsZWdlZEFjdGlvbkV4Y2VwdGlvbiBwYWUpIHsKICAgICAg\nICAgICAgICAgICAgICAgICAgdGhyb3cgKEZpbGVOb3RGb3VuZEV4Y2VwdGlv\nbikgcGFlLmdldEV4Y2VwdGlvbigpOwogICAgICAgICAgICAgICAgICAgIH0K\nICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAg\nICAgICBVUkwgdXJsOwogICAgICAgIGlmICh1cmxzICE9IG51bGwpIHsKICAg\nICAgICAgICAgZm9yIChJdGVyYXRvciBpdHIgPSB1cmxzLml0ZXJhdG9yKCk7\nIGl0ci5oYXNOZXh0KCk7KSB7CiAgICAgICAgICAgICAgICB1cmwgPSAoVVJM\nKSBpdHIubmV4dCgpOwogICAgICAgICAgICAgICAgaWYgKCJmaWxlIi5lcXVh\nbHModXJsLmdldFByb3RvY29sKCkpKSB7CiAgICAgICAgICAgICAgICAgICAg\nRmlsZSBmaWxlID0gQWNjZXNzQ29udHJvbGxlcgogICAgICAgICAgICAgICAg\nICAgICAgICAuZG9Qcml2aWxlZ2VkKEoyRG9Qcml2SGVscGVyCiAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAuZ2V0QWJzb2x1dGVGaWxlQWN0aW9uKG5l\ndyBGaWxlKHVybC5nZXRGaWxlKCkpKSk7IAogICAgICAgICAgICAgICAgICAg\nIGlmIChmaWxlcyAhPSBudWxsICYmIGZpbGVzLmNvbnRhaW5zKGZpbGUpKSB7\nCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAg\nICAgICAgICAgIH0gZWxzZSBpZiAoKEFjY2Vzc0NvbnRyb2xsZXIKICAgICAg\nICAgICAgICAgICAgICAgICAgLmRvUHJpdmlsZWdlZChKMkRvUHJpdkhlbHBl\nci5pc0RpcmVjdG9yeUFjdGlvbihmaWxlKSkpCiAgICAgICAgICAgICAgICAg\nICAgICAgIC5ib29sZWFuVmFsdWUoKSkgewogICAgICAgICAgICAgICAgICAg\nICAgICBpZiAobG9nLmlzVHJhY2VFbmFibGVkKCkpCiAgICAgICAgICAgICAg\nICAgICAgICAgICAgICBsb2cudHJhY2UoX2xvYy5nZXQoInNjYW5uaW5nLWRp\ncmVjdG9yeSIsIGZpbGUpKTsKICAgICAgICAgICAgICAgICAgICAgICAgc2Nh\nbigKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBGaWxlTWV0YURh\ndGFJdGVyYXRvcihmaWxlLCBuZXdNZXRhRGF0YUZpbHRlcigpKSwKICAgICAg\nICAgICAgICAgICAgICAgICAgICAgIGNwYXJzZXIsIG5hbWVzLCB0cnVlLCBm\naWxlKTsKICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7CiAgICAg\nICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAg\nICAgICAgaWYgKCJqYXIiLmVxdWFscyh1cmwuZ2V0UHJvdG9jb2woKSkKICAg\nICAgICAgICAgICAgICAgICAmJiB1cmwuZ2V0UGF0aCgpLmVuZHNXaXRoKCIh\nLyIpKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKGxvZy5pc1RyYWNlRW5h\nYmxlZCgpKQogICAgICAgICAgICAgICAgICAgICAgICBsb2cudHJhY2UoX2xv\nYy5nZXQoInNjYW5uaW5nLWphci11cmwiLCB1cmwpKTsKICAgICAgICAgICAg\nICAgICAgICBzY2FuKG5ldyBaaXBGaWxlTWV0YURhdGFJdGVyYXRvcih1cmws\nCiAgICAgICAgICAgICAgICAgICAgICAgIG5ld01ldGFEYXRhRmlsdGVyKCkp\nLCBjcGFyc2VyLCBuYW1lcywgdHJ1ZSwgdXJsKTsKICAgICAgICAgICAgICAg\nIH0gZWxzZSBpZiAodXJsLmdldFBhdGgoKS5lbmRzV2l0aCgiLmphciIpKSB7\nCiAgICAgICAgICAgICAgICAgICAgaWYgKGxvZy5pc1RyYWNlRW5hYmxlZCgp\nKQogICAgICAgICAgICAgICAgICAgICAgICBsb2cudHJhY2UoX2xvYy5nZXQo\nInNjYW5uaW5nLWphci1hdC11cmwiLCB1cmwpKTsKICAgICAgICAgICAgICAg\nICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgICAgICBJbnB1dFN0cmVh\nbSBpcyA9IChJbnB1dFN0cmVhbSkKICAgICAgICAgICAgICAgICAgICAgICAg\nICAgIEFjY2Vzc0NvbnRyb2xsZXIuZG9Qcml2aWxlZ2VkKAogICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgIEoyRG9Qcml2SGVscGVyLm9wZW5TdHJl\nYW1BY3Rpb24odXJsKSk7CiAgICAgICAgICAgICAgICAgICAgICAgIHNjYW4o\nbmV3IFppcFN0cmVhbU1ldGFEYXRhSXRlcmF0b3IoCiAgICAgICAgICAgICAg\nICAgICAgICAgICAgICBuZXcgWmlwSW5wdXRTdHJlYW0oaXMpLAogICAgICAg\nICAgICAgICAgICAgICAgICAgICAgbmV3TWV0YURhdGFGaWx0ZXIoKSksIGNw\nYXJzZXIsIG5hbWVzLCB0cnVlLCB1cmwpOwogICAgICAgICAgICAgICAgICAg\nIH0gY2F0Y2ggKFByaXZpbGVnZWRBY3Rpb25FeGNlcHRpb24gcGFlKSB7CiAg\nICAgICAgICAgICAgICAgICAgICAgIHRocm93IChJT0V4Y2VwdGlvbikgcGFl\nLmdldEV4Y2VwdGlvbigpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAg\nICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKGxv\nZy5pc1RyYWNlRW5hYmxlZCgpKQogICAgICAgICAgICAgICAgICAgICAgICBs\nb2cudHJhY2UoX2xvYy5nZXQoInNjYW5uaW5nLXVybCIsIHVybCkpOwogICAg\nICAgICAgICAgICAgICAgIGNsc3MgPSBjcGFyc2VyLnBhcnNlVHlwZU5hbWVz\nKG5ldyBVUkxNZXRhRGF0YUl0ZXJhdG9yKHVybCkpOwogICAgICAgICAgICAg\nICAgICAgIExpc3Q8U3RyaW5nPiBuZXdOYW1lcyA9IEFycmF5cy5hc0xpc3Qo\nY2xzcyk7CiAgICAgICAgICAgICAgICAgICAgaWYgKGxvZy5pc1RyYWNlRW5h\nYmxlZCgpKQogICAgICAgICAgICAgICAgICAgICAgICBsb2cudHJhY2UoX2xv\nYy5nZXQoInNjYW4tZm91bmQtbmFtZXMiLCBuZXdOYW1lcywgdXJsKSk7CiAg\nICAgICAgICAgICAgICAgICAgbmFtZXMuYWRkQWxsKG5ld05hbWVzKTsKICAg\nICAgICAgICAgICAgICAgICBtYXBQZXJzaXN0ZW50VHlwZU5hbWVzKHVybCwg\nY2xzcyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAg\nICB9CiAgICAgICAgaWYgKHJzcmNzICE9IG51bGwpIHsKICAgICAgICAgICAg\nU3RyaW5nIHJzcmM7CiAgICAgICAgICAgIE1ldGFEYXRhSXRlcmF0b3IgbWl0\ncjsKICAgICAgICAgICAgZm9yIChJdGVyYXRvciBpdHIgPSByc3Jjcy5pdGVy\nYXRvcigpOyBpdHIuaGFzTmV4dCgpOykgewogICAgICAgICAgICAgICAgcnNy\nYyA9IChTdHJpbmcpIGl0ci5uZXh0KCk7CiAgICAgICAgICAgICAgICBpZiAo\ncnNyYy5lbmRzV2l0aCgiLmphciIpKSB7CiAgICAgICAgICAgICAgICAgICAg\ndXJsID0gQWNjZXNzQ29udHJvbGxlci5kb1ByaXZpbGVnZWQoCiAgICAgICAg\nICAgICAgICAgICAgICAgIEoyRG9Qcml2SGVscGVyLmdldFJlc291cmNlQWN0\naW9uKGxvYWRlciwgcnNyYykpOyAKICAgICAgICAgICAgICAgICAgICBpZiAo\ndXJsICE9IG51bGwpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGxv\nZy5pc1RyYWNlRW5hYmxlZCgpKQogICAgICAgICAgICAgICAgICAgICAgICAg\nICAgbG9nLnRyYWNlKF9sb2MuZ2V0KCJzY2FubmluZy1qYXItc3RyZWFtLXVy\nbCIsIHVybCkpOwogICAgICAgICAgICAgICAgICAgICAgICB0cnkgewogICAg\nICAgICAgICAgICAgICAgICAgICAgICAgSW5wdXRTdHJlYW0gaXMgPSAoSW5w\ndXRTdHJlYW0pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQWNj\nZXNzQ29udHJvbGxlci5kb1ByaXZpbGVnZWQoCiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgIEoyRG9Qcml2SGVscGVyLm9wZW5TdHJlYW1B\nY3Rpb24odXJsKSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY2Fu\nKG5ldyBaaXBTdHJlYW1NZXRhRGF0YUl0ZXJhdG9yCiAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgKG5ldyBaaXBJbnB1dFN0cmVhbShpcyksCiAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3TWV0YURhdGFGaWx0\nZXIoKSksIGNwYXJzZXIsIG5hbWVzLCB0cnVlLAogICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgIHVybCk7CiAgICAgICAgICAgICAgICAgICAgICAg\nIH0gY2F0Y2ggKFByaXZpbGVnZWRBY3Rpb25FeGNlcHRpb24gcGFlKSB7CiAg\nICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyAoSU9FeGNlcHRpb24p\nIHBhZS5nZXRFeGNlcHRpb24oKTsKICAgICAgICAgICAgICAgICAgICAgICAg\nfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0gZWxz\nZSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKGxvZy5pc1RyYWNlRW5hYmxl\nZCgpKQogICAgICAgICAgICAgICAgICAgICAgICBsb2cudHJhY2UoX2xvYy5n\nZXQoInNjYW5uaW5nLXJlc291cmNlIiwgcnNyYykpOwogICAgICAgICAgICAg\nICAgICAgIG1pdHIgPSBuZXcgUmVzb3VyY2VNZXRhRGF0YUl0ZXJhdG9yKHJz\ncmMsIGxvYWRlcik7CiAgICAgICAgICAgICAgICAgICAgT3BlbkpQQUNvbmZp\nZ3VyYXRpb24gY29uZiA9IHJlcG9zLmdldENvbmZpZ3VyYXRpb24oKTsKICAg\nICAgICAgICAgICAgICAgICBNYXAgcGVNYXAgPSBudWxsOwogICAgICAgICAg\nICAgICAgICAgIGlmIChjb25mIGluc3RhbmNlb2YgT3BlbkpQQUNvbmZpZ3Vy\nYXRpb25JbXBsKQogICAgICAgICAgICAgICAgICAgICAgICBwZU1hcCA9ICgo\nT3BlbkpQQUNvbmZpZ3VyYXRpb25JbXBsKWNvbmYpLmdldFBlcnNpc3RlbmNl\nRW52aXJvbm1lbnQoKTsKICAgICAgICAgICAgICAgICAgICBVUkwgcHVVcmwg\nPSBwZU1hcCA9PSBudWxsID8gbnVsbCA6IChVUkwpIHBlTWFwLmdldChQRVJT\nSVNURU5DRV9VTklUX1JPT1RfVVJMKTsKICAgICAgICAgICAgICAgICAgICBM\naXN0PFN0cmluZz4gbWFwcGluZ0ZpbGVOYW1lcyA9IAogICAgICAgICAgICAg\nICAgICAgICAgICBwZU1hcCA9PSBudWxsID8gbnVsbCA6IChMaXN0PFN0cmlu\nZz4pIHBlTWFwLmdldChNQVBQSU5HX0ZJTEVfTkFNRVMpOwogICAgICAgICAg\nICAgICAgICAgIExpc3Q8VVJMPiBqYXJzID0gcGVNYXAgPT0gbnVsbCA/IG51\nbGwgOiAoTGlzdDxVUkw+KXBlTWFwLmdldChKQVJfRklMRV9VUkxTKTsKICAg\nICAgICAgICAgICAgICAgICBTdHJpbmcgcHVVcmxTdHJpbmcgPSBwdVVybCA9\nPSBudWxsID8gbnVsbCA6IHB1VXJsLnRvU3RyaW5nKCk7CiAgICAgICAgICAg\nICAgICAgICAgaWYgKGxvZy5pc1RyYWNlRW5hYmxlZCgpKQogICAgICAgICAg\nICAgICAgICAgICAgICBsb2cudHJhY2UoX2xvYy5nZXQoInB1LXJvb3QtdXJs\nIiwgcHVVcmxTdHJpbmcpKTsKCiAgICAgICAgICAgICAgICAgICAgTGlzdDxV\nUkw+IHVybHMgPSBuZXcgQXJyYXlMaXN0PFVSTD4oMyk7CiAgICAgICAgICAg\nICAgICAgICAgd2hpbGUgKG1pdHIuaGFzTmV4dCgpKSB7CiAgICAgICAgICAg\nICAgICAgICAgICAgIHVybCA9IChVUkwpIG1pdHIubmV4dCgpOwogICAgICAg\nICAgICAgICAgICAgICAgICBTdHJpbmcgdXJsU3RyaW5nID0gdXJsLnRvU3Ry\naW5nKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChsb2cuaXNUcmFj\nZUVuYWJsZWQoKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvZy50\ncmFjZShfbG9jLmdldCgicmVzb3VyY2UtdXJsIiwgdXJsU3RyaW5nKSk7CiAg\nICAgICAgICAgICAgICAgICAgICAgIGlmIChwZU1hcCAhPSBudWxsKSB7CiAg\nICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocHVVcmxTdHJpbmcgIT0g\nbnVsbCAmJiB1cmxTdHJpbmcuaW5kZXhPZihwdVVybFN0cmluZykgIT0gLTEp\nIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVybHMuYWRkKHVy\nbCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobWFwcGluZ0Zp\nbGVOYW1lcyAhPSBudWxsICYmIG1hcHBpbmdGaWxlTmFtZXMuc2l6ZSgpICE9\nIDApIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKFN0\ncmluZyBtYXBwaW5nRmlsZU5hbWUgOiBtYXBwaW5nRmlsZU5hbWVzKSB7CiAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChsb2cuaXNU\ncmFjZUVuYWJsZWQoKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgIGxvZy50cmFjZShfbG9jLmdldCgibWFwcGluZy1maWxlLW5h\nbWUiLCBtYXBwaW5nRmlsZU5hbWUpKTsKICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgaWYgKHVybFN0cmluZy5pbmRleE9mKG1hcHBpbmdG\naWxlTmFtZSkgIT0gLTEpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICB1cmxzLmFkZCh1cmwpOwogICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0K\nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoamFycyAhPSBudWxs\nICYmIGphcnMuc2l6ZSgpICE9IDApIHsKICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICBmb3IgKFVSTCBqYXJVcmwgOiBqYXJzKSB7CiAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChsb2cuaXNUcmFjZUVu\nYWJsZWQoKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgIGxvZy50cmFjZShfbG9jLmdldCgiamFyLWZpbGUtdXJsIiwgamFyVXJs\nKSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh1\ncmxTdHJpbmcuaW5kZXhPZihqYXJVcmwudG9TdHJpbmcoKSkgIT0gLTEpCiAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cmxzLmFk\nZCh1cmwpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAg\nICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAg\nICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVy\nbHMuYWRkKHVybCk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAg\nICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgbWl0ci5jbG9z\nZSgpOwoKICAgICAgICAgICAgICAgICAgICBmb3IgKE9iamVjdCBvYmogOiB1\ncmxzKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHVybCA9IChVUkwpIG9i\najsKICAgICAgICAgICAgICAgICAgICAgICAgY2xzcyA9IGNwYXJzZXIucGFy\nc2VUeXBlTmFtZXMobmV3IFVSTE1ldGFEYXRhSXRlcmF0b3IKICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICh1cmwpKTsKICAgICAgICAgICAgICAgICAg\nICAgICAgTGlzdDxTdHJpbmc+IG5ld05hbWVzID0gQXJyYXlzLmFzTGlzdChj\nbHNzKTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGxvZy5pc1RyYWNl\nRW5hYmxlZCgpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9nLnRy\nYWNlKF9sb2MuZ2V0KCJzY2FuLWZvdW5kLW5hbWVzIiwgbmV3TmFtZXMsCiAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJzcmMpKTsKICAg\nICAgICAgICAgICAgICAgICAgICAgbmFtZXMuYWRkQWxsKG5ld05hbWVzKTsK\nICAgICAgICAgICAgICAgICAgICAgICAgbWFwUGVyc2lzdGVudFR5cGVOYW1l\ncyh1cmwsIGNsc3MpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAg\nICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBpZiAo\nY3BhdGggIT0gbnVsbCkgewogICAgICAgICAgICBTdHJpbmdbXSBkaXJzID0g\nKFN0cmluZ1tdKSBjcGF0aC50b0FycmF5KG5ldyBTdHJpbmdbY3BhdGguc2l6\nZSgpXSk7CiAgICAgICAgICAgIHNjYW4obmV3IENsYXNzcGF0aE1ldGFEYXRh\nSXRlcmF0b3IoZGlycywgbmV3TWV0YURhdGFGaWx0ZXIoKSksCiAgICAgICAg\nICAgICAgICBjcGFyc2VyLCBuYW1lcywgdHJ1ZSwgZGlycyk7CiAgICAgICAg\nfQogICAgICAgIGlmICh0eXBlcyAhPSBudWxsKQogICAgICAgICAgICBuYW1l\ncy5hZGRBbGwodHlwZXMpOwoKICAgICAgICBpZiAobG9nLmlzVHJhY2VFbmFi\nbGVkKCkpCiAgICAgICAgICAgIGxvZy50cmFjZShfbG9jLmdldCgicGFyc2Ut\nZm91bmQtbmFtZXMiLCBuYW1lcykpOwogICAgICAgIAogICAgICAgIHJldHVy\nbiBuYW1lczsKICAgIH0KCiAgICAvKioKICAgICAqIFNjYW4gZm9yIHBlcnNp\nc3RlbnQgdHlwZSBuYW1lcyB1c2luZyB0aGUgZ2l2ZW4gbWV0YWRhdGEgaXRl\ncmF0b3IuCiAgICAgKi8KICAgIHByaXZhdGUgdm9pZCBzY2FuKE1ldGFEYXRh\nSXRlcmF0b3IgbWl0ciwgQ2xhc3NBcmdQYXJzZXIgY3BhcnNlciwgU2V0IG5h\nbWVzLAogICAgICAgIGJvb2xlYW4gbWFwTmFtZXMsIE9iamVjdCBkZWJ1Z0Nv\nbnRleHQpCiAgICAgICAgdGhyb3dzIElPRXhjZXB0aW9uIHsKICAgICAgICBN\nYXAgbWFwOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIG1hcCA9IGNwYXJz\nZXIubWFwVHlwZU5hbWVzKG1pdHIpOwogICAgICAgIH0gZmluYWxseSB7CiAg\nICAgICAgICAgIG1pdHIuY2xvc2UoKTsKICAgICAgICB9CgogICAgICAgIE1h\ncC5FbnRyeSBlbnRyeTsKICAgICAgICBmb3IgKEl0ZXJhdG9yIGl0ciA9IG1h\ncC5lbnRyeVNldCgpLml0ZXJhdG9yKCk7IGl0ci5oYXNOZXh0KCk7KSB7CiAg\nICAgICAgICAgIGVudHJ5ID0gKE1hcC5FbnRyeSkgaXRyLm5leHQoKTsKICAg\nICAgICAgICAgaWYgKG1hcE5hbWVzKQogICAgICAgICAgICAgICAgbWFwUGVy\nc2lzdGVudFR5cGVOYW1lcyhlbnRyeS5nZXRLZXkoKSwgKFN0cmluZ1tdKQog\nICAgICAgICAgICAgICAgICAgIGVudHJ5LmdldFZhbHVlKCkpOwogICAgICAg\nICAgICBMaXN0IG5ld05hbWVzID0gQXJyYXlzLmFzTGlzdCgoU3RyaW5nW10p\nIGVudHJ5LmdldFZhbHVlKCkpOwogICAgICAgICAgICBpZiAobG9nLmlzVHJh\nY2VFbmFibGVkKCkpCiAgICAgICAgICAgICAgICBsb2cudHJhY2UoX2xvYy5n\nZXQoInNjYW4tZm91bmQtbmFtZXMiLCBuZXdOYW1lcywgZGVidWdDb250ZXh0\nKSk7CiAgICAgICAgICAgIG5hbWVzLmFkZEFsbChuZXdOYW1lcyk7CiAgICAg\nICAgfQogICAgfQoKICAgIC8qKgogICAgICogSW1wbGVtZW50IHRoaXMgbWV0\naG9kIHRvIG1hcCBtZXRhZGF0YSByZXNvdXJjZXMgdG8gdGhlIHBlcnNpc3Rl\nbnQKICAgICAqIHR5cGVzIGNvbnRhaW5lZCB3aXRoaW4gdGhlbS4gVGhlIG1l\ndGhvZCB3aWxsIGJlIGNhbGxlZCB3aGVuCiAgICAgKiB7QGxpbmsgI2dldFBl\ncnNpc3RlbnRUeXBlTmFtZXN9IGlzIGludm9rZWQuCiAgICAgKi8KICAgIHBy\nb3RlY3RlZCB2b2lkIG1hcFBlcnNpc3RlbnRUeXBlTmFtZXMoT2JqZWN0IHJz\ncmMsIFN0cmluZ1tdIG5hbWVzKSB7CiAgICB9CgogICAgLyoqCiAgICAgKiBS\nZXR1cm4gYSBtZXRhZGF0YSBmaWx0ZXIgdGhhdCBpZGVudGlmaWVzIG1ldGFk\nYXRhIHJlc291cmNlcyB3aGVuCiAgICAgKiBwZXJmb3JtaW5nIGphciBhbmQg\nY2xhc3NwYXRoIHNjYW5zLgogICAgICovCiAgICBwcm90ZWN0ZWQgYWJzdHJh\nY3QgTWV0YURhdGFGaWx0ZXIgbmV3TWV0YURhdGFGaWx0ZXIoKTsKCiAgICBw\ndWJsaWMgdm9pZCBjbGVhcigpIHsKICAgICAgICBzdXBlci5jbGVhcigpOwog\nICAgICAgIF90eXBlTmFtZXMgPSBudWxsOwogICAgfQoKICAgIC8qKgogICAg\nICogSW50ZXJuYWwgcGFyc2VyIGludGVyZmFjZS4KICAgICAqLwogICAgcHVi\nbGljIHN0YXRpYyBpbnRlcmZhY2UgUGFyc2VyCiAgICAgICAgZXh0ZW5kcyBN\nZXRhRGF0YVBhcnNlciB7CgogICAgICAgIC8qKgogICAgICAgICAqIFJldHVy\nbnMgdGhlIHJlcG9zaXRvcnkgZm9yIHRoaXMgcGFyc2VyLiBJZiBub25lIGhh\ncyBiZWVuIHNldCwKICAgICAgICAgKiBjcmVhdGVzIGEgbmV3IHJlcG9zaXRv\ncnkgYW5kIHNldHMgaXQuCiAgICAgICAgICovCiAgICAgICAgcHVibGljIE1l\ndGFEYXRhUmVwb3NpdG9yeSBnZXRSZXBvc2l0b3J5KCk7CgogICAgICAgIC8q\nKgogICAgICAgICAqIFRoZSBwYXJzZSBtb2RlIGFjY29yZGluZyB0byB0aGUg\nZXhwZWN0ZWQgZG9jdW1lbnQgdHlwZS4KICAgICAgICAgKi8KICAgICAgICBw\ndWJsaWMgdm9pZCBzZXRNb2RlKGludCBtb2RlKTsKICAgIH0KCiAgICAvKioK\nICAgICAqIEludGVybmFsIHNlcmlhbGl6ZXIgaW50ZXJmYWNlLgogICAgICov\nCiAgICBwdWJsaWMgc3RhdGljIGludGVyZmFjZSBTZXJpYWxpemVyCiAgICAg\nICAgZXh0ZW5kcyBNZXRhRGF0YVNlcmlhbGl6ZXIgewoKICAgICAgICAvKioK\nICAgICAgICAgKiBUaGUgc2VyaWFsaXphdGlvbiBtb2RlIGFjY29yZGluZyB0\nbyB0aGUgZXhwZWN0ZWQgZG9jdW1lbnQgdHlwZS4gVGhlCiAgICAgICAgICog\nbW9kZSBjb25zdGFudHMgYWN0IGFzIGJpdCBmbGFncywgYW5kIHRoZXJlZm9y\nZSBjYW4gYmUgY29tYmluZWQuCiAgICAgICAgICovCiAgICAgICAgcHVibGlj\nIHZvaWQgc2V0TW9kZShpbnQgbW9kZSk7CgogICAgICAgIC8qKgogICAgICAg\nICAqIEFkZCBhIGNsYXNzIG1ldGEgZGF0YSB0byB0aGUgc2V0IHRvIGJlIHNl\ncmlhbGl6ZWQuCiAgICAgICAgICovCiAgICAgICAgcHVibGljIHZvaWQgYWRk\nTWV0YURhdGEoQ2xhc3NNZXRhRGF0YSBtZXRhKTsKCiAgICAgICAgLyoqCiAg\nICAgICAgICogUmVtb3ZlIGEgY2xhc3MgbWV0YSBkYXRhIGZyb20gdGhlIHNl\ndCB0byBiZSBzZXJpYWxpemVkLgogICAgICAgICAqLwogICAgICAgIHB1Ymxp\nYyBib29sZWFuIHJlbW92ZU1ldGFEYXRhKENsYXNzTWV0YURhdGEgbWV0YSk7\nCgogICAgICAgIC8qKgogICAgICAgICAqIEFkZCBhIHNlcXVlbmNlIG1ldGEg\nZGF0YSB0byB0aGUgc2V0IHRvIGJlIHNlcmlhbGl6ZWQuCiAgICAgICAgICov\nCiAgICAgICAgcHVibGljIHZvaWQgYWRkU2VxdWVuY2VNZXRhRGF0YShTZXF1\nZW5jZU1ldGFEYXRhIG1ldGEpOwoKICAgICAgICAvKioKICAgICAgICAgKiBB\nZGQgYSBxdWVyeSBtZXRhIGRhdGEgdG8gdGhlIHNldCB0byBiZSBzZXJpYWxp\nemVkLgogICAgICAgICAqLwogICAgICAgIHB1YmxpYyB2b2lkIGFkZFF1ZXJ5\nTWV0YURhdGEoUXVlcnlNZXRhRGF0YSBtZXRhKTsKCiAgICAgICAgLyoqCiAg\nICAgICAgICogQWRkIGFsbCBjb21wb25lbnRzIGluIHRoZSBnaXZlbiByZXBv\nc2l0b3J5IHRvIHRoZSBzZXQgdG8gYmUKICAgICAgICAgKiBzZXJpYWxpemVk\nLgogICAgICAgICAqLwogICAgICAgIHB1YmxpYyB2b2lkIGFkZEFsbCAoTWV0\nYURhdGFSZXBvc2l0b3J5IHJlcG9zKTsKICAgIH0KfQo=\n","encoding":"base64"}

