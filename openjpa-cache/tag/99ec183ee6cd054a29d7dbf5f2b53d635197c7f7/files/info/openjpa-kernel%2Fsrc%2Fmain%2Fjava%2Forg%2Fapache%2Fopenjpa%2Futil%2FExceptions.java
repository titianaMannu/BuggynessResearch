{"sha":"4c3f0c36295c8c98ff39c01abc5f1cd835a42d08","node_id":"MDQ6QmxvYjIwNjM2NDo0YzNmMGMzNjI5NWM4Yzk4ZmYzOWMwMWFiYzVmMWNkODM1YTQyZDA4","size":9870,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/4c3f0c36295c8c98ff39c01abc5f1cd835a42d08","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbDsKCmltcG9ydCBqYXZh\nLmlvLk9iamVjdE91dHB1dFN0cmVhbTsKaW1wb3J0IGphdmEuaW8uT3V0cHV0\nU3RyZWFtOwppbXBvcnQgamF2YS5pby5QcmludFN0cmVhbTsKaW1wb3J0IGph\ndmEuaW8uUHJpbnRXcml0ZXI7CmltcG9ydCBqYXZhLmlvLlNlcmlhbGl6YWJs\nZTsKaW1wb3J0IGphdmEudXRpbC5Db2xsZWN0aW9uOwppbXBvcnQgamF2YS51\ndGlsLkl0ZXJhdG9yOwoKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5jb25m\nLk9wZW5KUEFWZXJzaW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmVu\naGFuY2UuUGVyc2lzdGVuY2VDYXBhYmxlOwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLmxpYi51dGlsLkoyRG9Qcml2SGVscGVyOwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLmxpYi51dGlsLkphdmFWZXJzaW9uczsKCi8qKgogKiBV\ndGlsaXR5IG1ldGhvZHMgZm9yIGV4dGVybmFsaXppbmcgYW5kIGhhbmRsaW5n\nIGV4Y2VwdGlvbnMuCiAqCiAqIEBhdXRob3IgTWFyYyBQcnVkJ2hvbW1lYXV4\nCiAqIEBzaW5jZSAwLjIuNQogKiBAbm9qYXZhZG9jCiAqLwpwdWJsaWMgY2xh\nc3MgRXhjZXB0aW9ucyB7CgogICAgcHVibGljIHN0YXRpYyBmaW5hbCBUaHJv\nd2FibGVbXSBFTVBUWV9USFJPV0FCTEVTID0gbmV3IFRocm93YWJsZVswXTsK\nCiAgICBzdGF0aWMgZmluYWwgU3RyaW5nIFNFUCA9IEoyRG9Qcml2SGVscGVy\nLmdldExpbmVTZXBhcmF0b3IoKTsKCiAgICBwcml2YXRlIHN0YXRpYyBmaW5h\nbCBPdXRwdXRTdHJlYW0gREVWX05VTEwgPSBuZXcgT3V0cHV0U3RyZWFtKCkg\newogICAgICAgIHB1YmxpYyB2b2lkIHdyaXRlKGludCBiKSB7CiAgICAgICAg\nfQogICAgfTsKCiAgICAvKioKICAgICAqIFRlc3QgdG8gc2VlIGlmIHRoZSBz\ncGVjaWZpZWQgb2JqZWN0IHdpbGwgYmUgYWJsZSB0byBiZSBzZXJpYWxpemVk\nLiBUaGlzCiAgICAgKiB3aWxsIGNoZWNrIGlmIHRoZSBvYmplY3QgaW1wbGVt\nZW50cyB7QGxpbmsgU2VyaWFsaXphYmxlfSwgYW5kIGlmIHNvLAogICAgICog\nd2lsbCB0cnkgdG8gcGVyZm9ybSBhbiBhY3R1YWwgc2VyaWFsaXphdGlvbi4g\nVGhpcyBpcyBpbiBjYXNlIHRoZSBvYmplY3QKICAgICAqIGhhcyBmaWVsZHMg\nd2hpY2gsIGluIHR1cm4sIGFyZSBub3Qgc2VyaWFsaXphYmxlLgogICAgICoK\nICAgICAqIEBwYXJhbSBvYiB0aGUgb2JqZWN0IHRvIHRlc3QKICAgICAqIEBy\nZXR1cm4gdHJ1ZSBpZiB0aGUgb2JqZWN0IHdpbGwgYmUgYWJsZSB0byBiZSBz\nZXJpYWxpemVkCiAgICAgKi8KICAgIHByaXZhdGUgc3RhdGljIGJvb2xlYW4g\naXNTZXJpYWxpemFibGUoT2JqZWN0IG9iKSB7CiAgICAgICAgaWYgKCEob2Ig\naW5zdGFuY2VvZiBTZXJpYWxpemFibGUpKQogICAgICAgICAgICByZXR1cm4g\nZmFsc2U7CgogICAgICAgIC8vIGRvbid0IHNlcmlhbGl6ZSBwZXJzaXN0ZW50\nIG9iamVjdHMgZXhjZXB0aW9ucyB0byBwcmV2ZW50CiAgICAgICAgLy8gcmVh\nZGluZyBpbiBhbGwgdGhlIHN0YXRlCiAgICAgICAgaWYgKCFJbXBsSGVscGVy\nLmlzTWFuYWdlZFR5cGUobnVsbCwgb2IuZ2V0Q2xhc3MoKSkpCiAgICAgICAg\nICAgIHJldHVybiBmYWxzZTsKCiAgICAgICAgLy8gbm93IGRvIGFuIGFjdHVh\nbCB0ZXN0IHRvIHNlZSBpZiB3ZSB3aWxsIGJlCiAgICAgICAgLy8gYWJsZSB0\nbyBwZXJmb3JtIHRoZSBzZXJpYWxpemF0aW9uCiAgICAgICAgdHJ5IHsKICAg\nICAgICAgICAgbmV3IE9iamVjdE91dHB1dFN0cmVhbShERVZfTlVMTCkud3Jp\ndGVPYmplY3Qob2IpOwogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAg\nICB9IGNhdGNoIChUaHJvd2FibGUgdCkgewogICAgICAgICAgICByZXR1cm4g\nZmFsc2U7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogU2FmZWx5\nIHN0cmluZ2lmeSB0aGUgZ2l2ZW4gb2JqZWN0LgogICAgICovCiAgICBwdWJs\naWMgc3RhdGljIFN0cmluZyB0b1N0cmluZyhPYmplY3Qgb2IpIHsKICAgICAg\nICBpZiAob2IgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuICJudWxsIjsK\nCiAgICAgICAgLy8gZG9uJ3QgdGFrZSBvaWQgb2YgbmV3IG9iamVjdHMgc2lu\nY2UgaXQgY2FuIGNhdXNlIGEgZmx1c2ggaWYgYXV0by1pbmMKICAgICAgICAv\nLyBhbmQgdGhlIGlkIGlzIG1lYW5pbmdsZXNzIGFueXdheQogICAgICAgIE9i\namVjdCBvaWQgPSBnZXRPYmplY3RJZChvYik7CgogICAgICAgIGlmIChvaWQg\nIT0gbnVsbCkgewogICAgICAgICAgICBpZiAob2lkIGluc3RhbmNlb2YgSWQp\nCiAgICAgICAgICAgICAgICByZXR1cm4gb2lkLnRvU3RyaW5nKCk7CiAgICAg\nICAgICAgIHJldHVybiBvYi5nZXRDbGFzcygpLmdldE5hbWUoKSArICItIiAr\nIG9pZC50b1N0cmluZygpOwogICAgICAgIH0KCiAgICAgICAgaWYgKEltcGxI\nZWxwZXIuaXNNYW5hZ2VkVHlwZShudWxsLCBvYi5nZXRDbGFzcygpKSkgewog\nICAgICAgICAgICAvLyBuZXZlciBjYWxsIHRvU3RyaW5nKCkgb24gYSBQZXJz\naXN0ZW5jZUNhcGFibGUsIHNpbmNlCiAgICAgICAgICAgIC8vIGl0IG1heSBh\nY2Nlc3MgcGVyc2lzdGVudCBmaWVsZHM7IGZhbGwtYmFjayB0byB1c2luZwog\nICAgICAgICAgICAvLyB0aGUgc3RhbmRhcmQgb2JqZWN0IHN0cmluZ2lmaWNh\ndGlvbiBtZWNoYW5pc20uIE5ldwogICAgICAgICAgICAvLyBpbnN0YW5jZXMg\ndGhhdCB1c2UgcHJveHlpbmcgKHByb3BlcnR5LWFjY2VzcyBpbnN0YW5jZXMs\nCiAgICAgICAgICAgIC8vIGZvciBleGFtcGxlKSB0aGF0IHdlcmUgY3JlYXRl\nZCB3aXRoIHRoZSAnbmV3JyBrZXl3b3JkCiAgICAgICAgICAgIC8vIHdpbGwg\nbm90IGVuZCB1cCBpbiB0aGlzIGNvZGUsIHdoaWNoIGlzIG9rIHNpbmNlIHRo\nZXkKICAgICAgICAgICAgLy8gZG9uJ3QgZG8gbGF6eSBsb2FkaW5nIGFueXdh\neXMsIHNvIHRoZXkgd2lsbCBzdHJpbmdpZnkKICAgICAgICAgICAgLy8gc2Fm\nZWx5LgogICAgICAgICAgICByZXR1cm4gb2IuZ2V0Q2xhc3MoKS5nZXROYW1l\nKCkgKyAiQCIKICAgICAgICAgICAgICAgICsgSW50ZWdlci50b0hleFN0cmlu\nZyhTeXN0ZW0uaWRlbnRpdHlIYXNoQ29kZShvYikpOwogICAgICAgIH0KCiAg\nICAgICAgdHJ5IHsKICAgICAgICAgICAgU3RyaW5nIHMgPSBvYi50b1N0cmlu\nZygpOwogICAgICAgICAgICBpZiAocy5pbmRleE9mKG9iLmdldENsYXNzKCku\nZ2V0TmFtZSgpKSA9PSAtMSkKICAgICAgICAgICAgICAgIHMgKz0gIiBbIiAr\nIG9iLmdldENsYXNzKCkuZ2V0TmFtZSgpICsgIl0iOwogICAgICAgICAgICBy\nZXR1cm4gczsKICAgICAgICB9IGNhdGNoIChUaHJvd2FibGUgdCkgewogICAg\nICAgICAgICByZXR1cm4gb2IuZ2V0Q2xhc3MoKS5nZXROYW1lKCk7CiAgICAg\nICAgfQogICAgfQoKICAgIC8qKgogICAgICogU2FmZWx5IHN0cmluZ2lmeSB0\naGUgZ2l2ZW4gb2JqZWN0cy4KICAgICAqLwogICAgcHVibGljIHN0YXRpYyBT\ndHJpbmcgdG9TdHJpbmcoQ29sbGVjdGlvbiBmYWlsZWQpIHsKICAgICAgICBT\ndHJpbmdCdWlsZGVyIGJ1ZiA9IG5ldyBTdHJpbmdCdWlsZGVyKCk7CiAgICAg\nICAgYnVmLmFwcGVuZCgiWyIpOwogICAgICAgIGZvciAoSXRlcmF0b3IgaXRy\nID0gZmFpbGVkLml0ZXJhdG9yKCk7IGl0ci5oYXNOZXh0KCk7KSB7CiAgICAg\nICAgICAgIGJ1Zi5hcHBlbmQoRXhjZXB0aW9ucy50b1N0cmluZyhpdHIubmV4\ndCgpKSk7CiAgICAgICAgICAgIGlmIChpdHIuaGFzTmV4dCgpKQogICAgICAg\nICAgICAgICAgYnVmLmFwcGVuZCgiLCAiKTsKICAgICAgICB9CiAgICAgICAg\nYnVmLmFwcGVuZCgiXSIpOwogICAgICAgIHJldHVybiBidWYudG9TdHJpbmco\nKTsKICAgIH0KCiAgICAvKioKICAgICAqIFN0cmluZ2lmeSB0aGUgZ2l2ZW4g\nZXhjZXB0aW9uLgogICAgICovCiAgICBwdWJsaWMgc3RhdGljIFN0cmluZyB0\nb1N0cmluZyhFeGNlcHRpb25JbmZvIGUpIHsKICAgICAgICBpbnQgdHlwZSA9\nIGUuZ2V0VHlwZSgpOwogICAgICAgIFN0cmluZ0J1aWxkZXIgYnVmID0gbmV3\nIFN0cmluZ0J1aWxkZXIoKTsKICAgICAgICBidWYuYXBwZW5kKCI8IikuCiAg\nICAgICAgICAgIGFwcGVuZChPcGVuSlBBVmVyc2lvbi5WRVJTSU9OX0lEKS4K\nICAgICAgICAgICAgYXBwZW5kKCcgJykuCiAgICAgICAgICAgIGFwcGVuZChl\nLmlzRmF0YWwoKSA/ICJmYXRhbCAiIDogIm5vbmZhdGFsICIpLgogICAgICAg\nICAgICBhcHBlbmQgKHR5cGUgPT0gRXhjZXB0aW9uSW5mby5HRU5FUkFMID8g\nImdlbmVyYWwgZXJyb3IiIDoKICAgICAgICAgICAgICAgIHR5cGUgPT0gRXhj\nZXB0aW9uSW5mby5JTlRFUk5BTCA/ICJpbnRlcm5hbCBlcnJvciIgOgogICAg\nICAgICAgICAgICAgdHlwZSA9PSBFeGNlcHRpb25JbmZvLlNUT1JFID8gInN0\nb3JlIGVycm9yIiA6CiAgICAgICAgICAgICAgICB0eXBlID09IEV4Y2VwdGlv\nbkluZm8uVU5TVVBQT1JURUQgPyAidW5zdXBwb3J0ZWQgZXJyb3IiIDoKICAg\nICAgICAgICAgICAgIHR5cGUgPT0gRXhjZXB0aW9uSW5mby5VU0VSID8gInVz\nZXIgZXJyb3IiIDoKICAgICAgICAgICAgICAgICh0eXBlICsgIiBlcnJvciIp\nKS4KICAgICAgICAgICAgYXBwZW5kKCI+ICIpOwogICAgICAgIGJ1Zi5hcHBl\nbmQoZS5nZXRDbGFzcygpLmdldE5hbWUoKSkuYXBwZW5kKCI6ICIpLgogICAg\nICAgICAgICBhcHBlbmQoZS5nZXRNZXNzYWdlKCkpOwogICAgICAgIE9iamVj\ndCBmYWlsZWQgPSBlLmdldEZhaWxlZE9iamVjdCgpOwogICAgICAgIGlmIChm\nYWlsZWQgIT0gbnVsbCkKICAgICAgICAgICAgYnVmLmFwcGVuZChTRVApLmFw\ncGVuZCgiRmFpbGVkT2JqZWN0OiAiKS4KICAgICAgICAgICAgICAgIGFwcGVu\nZCh0b1N0cmluZyhmYWlsZWQpKTsKICAgICAgICByZXR1cm4gYnVmLnRvU3Ry\naW5nKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBQcmludCB0aGUgc3RhY2sg\ndHJhY2Ugb2YgdGhlIGV4Y2VwdGlvbidzIG5lc3RlZCB0aHJvd2FibGVzLgog\nICAgICovCiAgICBwdWJsaWMgc3RhdGljIHZvaWQgcHJpbnROZXN0ZWRUaHJv\nd2FibGVzKEV4Y2VwdGlvbkluZm8gZSwgUHJpbnRTdHJlYW0gb3V0KSB7CiAg\nICAgICAgLy8gaWYgdGhpcyBpcyBKYXZhIDEuNCBhbmQgdGhlcmUgaXMgZXhh\nY3RseSBhIHNpbmdsZQogICAgICAgIC8vIGV4Y2VwdGlvbiwgdGhlbiBkZWZl\nciB0byAxLjQncyBiZWhhdmlvciBvZiBwcmludGluZwogICAgICAgIC8vIG91\ndCB0aGUgcmVzdWx0IG9mIGdldENhdXNlKCkuIFRoaXMgZGVmZXJyYWwgaGFw\ncGVucyBpbgogICAgICAgIC8vIHRoZSBjYWxsaW5nIGNvZGUuCiAgICAgICAg\nVGhyb3dhYmxlW10gbmVzdGVkID0gZS5nZXROZXN0ZWRUaHJvd2FibGVzKCk7\nCiAgICAgICAgaW50IGkgPSAoSmF2YVZlcnNpb25zLlZFUlNJT04gPj0gNCkg\nPyAxIDogMDsKICAgICAgICBpZiAoaSA8IG5lc3RlZC5sZW5ndGgpIHsKICAg\nICAgICAgICAgb3V0LnByaW50bG4oIk5lc3RlZFRocm93YWJsZXM6Iik7CiAg\nICAgICAgICAgIGZvciAoOyBpIDwgbmVzdGVkLmxlbmd0aDsgaSsrKQogICAg\nICAgICAgICAgICAgLy8gZ3VhcmQgYWdhaW5zdCBhIG5hc3R5IG51bGwgaW4g\ndGhlIGFycmF5CiAgICAgICAgICAgICAgICBpZiAobmVzdGVkW2ldICE9IG51\nbGwpCiAgICAgICAgICAgICAgICAgICAgbmVzdGVkW2ldLnByaW50U3RhY2tU\ncmFjZShvdXQpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIFBy\naW50IHRoZSBzdGFjayB0cmFjZSBvZiB0aGUgZXhjZXB0aW9uJ3MgbmVzdGVk\nIHRocm93YWJsZXMuCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0aWMgdm9pZCBw\ncmludE5lc3RlZFRocm93YWJsZXMoRXhjZXB0aW9uSW5mbyBlLCBQcmludFdy\naXRlciBvdXQpIHsKICAgICAgICAvLyBpZiB0aGlzIGlzIEphdmEgMS40IGFu\nZCB0aGVyZSBpcyBleGFjdGx5IGEgc2luZ2xlCiAgICAgICAgLy8gZXhjZXB0\naW9uLCB0aGVuIGRlZmVyIHRvIDEuNCdzIGJlaGF2aW9yIG9mIHByaW50aW5n\nCiAgICAgICAgLy8gb3V0IHRoZSByZXN1bHQgb2YgZ2V0Q2F1c2UoKS4gVGhp\ncyBkZWZlcnJhbCBoYXBwZW5zIGluCiAgICAgICAgLy8gdGhlIGNhbGxpbmcg\nY29kZS4KICAgICAgICBUaHJvd2FibGVbXSBuZXN0ZWQgPSBlLmdldE5lc3Rl\nZFRocm93YWJsZXMoKTsKICAgICAgICBpbnQgaSA9IChKYXZhVmVyc2lvbnMu\nVkVSU0lPTiA+PSA0KSA/IDEgOiAwOwogICAgICAgIGlmIChpIDwgbmVzdGVk\nLmxlbmd0aCkgewogICAgICAgICAgICBvdXQucHJpbnRsbigiTmVzdGVkVGhy\nb3dhYmxlczoiKTsKICAgICAgICAgICAgZm9yICg7IGkgPCBuZXN0ZWQubGVu\nZ3RoOyBpKyspCiAgICAgICAgICAgICAgICAvLyBndWFyZCBhZ2FpbnN0IGEg\nbmFzdHkgbnVsbCBpbiB0aGUgYXJyYXkKICAgICAgICAgICAgICAgIGlmIChu\nZXN0ZWRbaV0gIT0gbnVsbCkKICAgICAgICAgICAgICAgICAgICBuZXN0ZWRb\naV0ucHJpbnRTdGFja1RyYWNlKG91dCk7CiAgICAgICAgfQogICAgfQoKICAg\nIC8qKgogICAgICogQ29udmVydCB0aGUgc3BlY2lmaWVkIGZhaWxlZCBvYmpl\nY3QgaW50byBhIHNlcmlhbGl6YWJsZQogICAgICogb2JqZWN0IGZvciB3aGVu\nIHdlIGFyZSBzZXJpYWxpemluZyBhbiBFeGNlcHRpb24uIEl0IHdpbGwKICAg\nICAqIHRyeSB0aGUgZm9sbG93aW5nOgogICAgICogPHVsPgogICAgICogPGxp\nPmlmIHRoZSBvYmplY3QgY2FuIGJlIHNlcmlhbGl6ZWQsIHJldHVybiB0aGUg\nb2JqZWN0IGl0c2VsZjwvbGk+CiAgICAgKiA8bGk+aWYgdGhlIG9iamVjdCBo\nYXMgYSBzZXJpYWxpemFibGUgb2lkLCByZXR1cm4gdGhlIG9pZDwvbGk+CiAg\nICAgKiA8bGk+aWYgdGhlIG9iamVjdCBoYXMgYSBub24tc2VyaWFsaXphYmxl\nIG9pZCwgcmV0dXJuIHRoZSBvaWQncwogICAgICogdG9TdHJpbmcgYW5kIHRo\nZSBvYmplY3QgY2xhc3M8L2xpPgogICAgICogPGxpPnJldHVybiB0aGUgb2Jq\nZWN0J3MgdG9TdHJpbmc8L2xpPgogICAgICogPC91bD4KICAgICAqCiAgICAg\nKiBAcGFyYW0gb2IgdGhlIG9iamVjdCB0byBjb252ZXJ0CiAgICAgKiBAcmV0\ndXJuIHNvbWUgc2VyaWFsaXplZCByZXByZXNlbnRhdGlvbiBvZiB0aGUgb2Jq\nZWN0CiAgICAgKi8KICAgIHB1YmxpYyBzdGF0aWMgT2JqZWN0IHJlcGxhY2VG\nYWlsZWRPYmplY3QoT2JqZWN0IG9iKSB7CiAgICAgICAgaWYgKG9iID09IG51\nbGwpCiAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgIGlmIChpc1Nl\ncmlhbGl6YWJsZShvYikpCiAgICAgICAgICAgIHJldHVybiBvYjsKCiAgICAg\nICAgLy8gZG9uJ3QgdGFrZSBvaWQgb2YgbmV3IG9iamVjdHMgc2luY2UgaXQg\nY2FuIGNhdXNlIGEgZmx1c2ggaWYgYXV0by1pbmMKICAgICAgICAvLyBhbmQg\ndGhlIGlkIGlzIG1lYW5pbmdsZXNzIGFueXdheQogICAgICAgIE9iamVjdCBv\naWQgPSBnZXRPYmplY3RJZChvYik7CiAgICAgICAgaWYgKG9pZCAhPSBudWxs\nICYmIGlzU2VyaWFsaXphYmxlKG9pZCkpCiAgICAgICAgICAgIHJldHVybiBv\naWQ7CgogICAgICAgIC8vIGxhc3QgZGl0Y2g6IHN0cmluZ2lmeSB0aGUgb2Jq\nZWN0CiAgICAgICAgcmV0dXJuIHRvU3RyaW5nKG9iKTsKICAgIH0KCiAgICAv\nKioKICAgICAqIENvbnZlcnQgdGhlIHNwZWNpZmllZCB0aHJvd2FibGVzIGlu\ndG8gYSBzZXJpYWx6YWJsZSBhcnJheS4gSWYKICAgICAqIGFueSBvZiB0aGUg\nbmVzdGVkIHRocm93YWJsZXMgY2Fubm90IGJlIHNlcmlhbGl6ZWQsIHRoZXkg\nd2lsbAogICAgICogYmUgY29udmVydGVkIGludG8gYSBFeGNlcHRpb24gd2l0\naCB0aGUgb3JpZ2luYWwgbWVzc2FnZS4KICAgICAqLwogICAgcHVibGljIHN0\nYXRpYyBUaHJvd2FibGVbXSByZXBsYWNlTmVzdGVkVGhyb3dhYmxlcyhUaHJv\nd2FibGVbXSBuZXN0ZWQpIHsKICAgICAgICBpZiAobmVzdGVkID09IG51bGwg\nfHwgbmVzdGVkLmxlbmd0aCA9PSAwKQogICAgICAgICAgICByZXR1cm4gbmVz\ndGVkOwogICAgICAgIGlmIChpc1NlcmlhbGl6YWJsZShuZXN0ZWQpKQogICAg\nICAgICAgICByZXR1cm4gbmVzdGVkOwoKICAgICAgICBUaHJvd2FibGVbXSBu\nZXdOZXN0ZWQgPSBuZXcgVGhyb3dhYmxlW25lc3RlZC5sZW5ndGhdOwogICAg\nICAgIGZvciAoaW50IGkgPSAwOyBpIDwgbmVzdGVkLmxlbmd0aDsgaSsrKSB7\nCiAgICAgICAgICAgIGlmIChpc1NlcmlhbGl6YWJsZShuZXN0ZWRbaV0pKQog\nICAgICAgICAgICAgICAgbmV3TmVzdGVkW2ldID0gbmVzdGVkW2ldOwogICAg\nICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAvLyBndWFyZCBhZ2FpbnN0\nIGEgbmFzdHkgbnVsbCBpbiB0aGUgYXJyYXkgYnkgdXNpbmcgdmFsdWVPZgog\nICAgICAgICAgICAgICAgLy8gaW5zdGVhZCBvZiB0b1N0cmluZyB0byBwcmV2\nZW50IHRocm93aW5nIHlldCBhbm90aGVyIAogICAgICAgICAgICAgICAgLy8g\nZXhjZXB0aW9uCiAgICAgICAgICAgICAgICBuZXdOZXN0ZWRbaV0gPSBuZXcg\nRXhjZXB0aW9uKFN0cmluZy52YWx1ZU9mKG5lc3RlZFtpXSkpOwogICAgICAg\nIH0KICAgICAgICByZXR1cm4gbmV3TmVzdGVkOwogICAgfQoKICAgIC8qKgog\nICAgICogUmV0dXJuIHRoZSBvYmplY3QgaWQgZm9yIDxjb2RlPm9iPC9jb2Rl\nPiBpZiBpdCBoYXMgb25lLCBvcgogICAgICogPGNvZGU+bnVsbDwvY29kZT4g\nb3RoZXJ3aXNlLgogICAgICovCiAgICBwcml2YXRlIHN0YXRpYyBPYmplY3Qg\nZ2V0T2JqZWN0SWQoT2JqZWN0IG9iKSB7CiAgICAgICAgaWYgKCFJbXBsSGVs\ncGVyLmlzTWFuYWdlYWJsZShvYikpCiAgICAgICAgICAgIHJldHVybiBudWxs\nOwoKICAgICAgICBQZXJzaXN0ZW5jZUNhcGFibGUgcGMgPSBJbXBsSGVscGVy\nLnRvUGVyc2lzdGVuY2VDYXBhYmxlKG9iLCBudWxsKTsKICAgICAgICBpZiAo\ncGMgPT0gbnVsbCB8fCBwYy5wY0lzTmV3KCkpCiAgICAgICAgICAgIHJldHVy\nbiBudWxsOwogICAgICAgIGVsc2UKICAgICAgICAgICAgcmV0dXJuIHBjLnBj\nRmV0Y2hPYmplY3RJZCgpOwoJfQogICAgCiAgICBwdWJsaWMgc3RhdGljIFN0\ncmluZyB0b0NsYXNzTmFtZShDbGFzczw/PiBjbHMpIHsKICAgICAgICBpZiAo\nY2xzID09IG51bGwpIHJldHVybiAiIjsKICAgICAgICBpZiAoY2xzLmlzQXJy\nYXkoKSkKICAgICAgICAgICAgcmV0dXJuIHRvQ2xhc3NOYW1lKGNscy5nZXRD\nb21wb25lbnRUeXBlKCkpKyJbXSI7CiAgICAgICAgcmV0dXJuIGNscy5nZXRO\nYW1lKCk7CiAgICB9Cn0K\n","encoding":"base64"}

