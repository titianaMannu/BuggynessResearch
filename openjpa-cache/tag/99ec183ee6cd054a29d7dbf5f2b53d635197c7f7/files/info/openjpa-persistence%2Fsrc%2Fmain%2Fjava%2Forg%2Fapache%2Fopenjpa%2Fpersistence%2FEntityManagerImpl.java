{"sha":"9509216269b7822a04e40deb55f99761c662c223","node_id":"MDQ6QmxvYjIwNjM2NDo5NTA5MjE2MjY5Yjc4MjJhMDRlNDBkZWI1NWY5OTc2MWM2NjJjMjIz","size":59804,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/9509216269b7822a04e40deb55f99761c662c223","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2U7CgppbXBv\ncnQgamF2YS5pby5CeXRlQXJyYXlJbnB1dFN0cmVhbTsKaW1wb3J0IGphdmEu\naW8uQnl0ZUFycmF5T3V0cHV0U3RyZWFtOwppbXBvcnQgamF2YS5pby5FeHRl\ncm5hbGl6YWJsZTsKaW1wb3J0IGphdmEuaW8uSU9FeGNlcHRpb247CmltcG9y\ndCBqYXZhLmlvLk9iamVjdElucHV0OwppbXBvcnQgamF2YS5pby5PYmplY3RJ\nbnB1dFN0cmVhbTsKaW1wb3J0IGphdmEuaW8uT2JqZWN0T3V0cHV0OwppbXBv\ncnQgamF2YS5pby5PYmplY3RPdXRwdXRTdHJlYW07CmltcG9ydCBqYXZhLmlv\nLk9iamVjdFN0cmVhbUNsYXNzOwppbXBvcnQgamF2YS5sYW5nLnJlZmxlY3Qu\nQXJyYXk7CmltcG9ydCBqYXZhLmxhbmcucmVmbGVjdC5GaWVsZDsKaW1wb3J0\nIGphdmEubGFuZy5yZWZsZWN0Lk1ldGhvZDsKaW1wb3J0IGphdmEudXRpbC5B\ncnJheXM7CmltcG9ydCBqYXZhLnV0aWwuQ29sbGVjdGlvbjsKaW1wb3J0IGph\ndmEudXRpbC5FbnVtU2V0OwppbXBvcnQgamF2YS51dGlsLklkZW50aXR5SGFz\naE1hcDsKaW1wb3J0IGphdmEudXRpbC5NYXA7CmltcG9ydCBqYXZhLnV0aWwu\nU2V0OwoKaW1wb3J0IGphdmF4LnBlcnNpc3RlbmNlLkNhY2hlUmV0cmlldmVN\nb2RlOwppbXBvcnQgamF2YXgucGVyc2lzdGVuY2UuQ2FjaGVTdG9yZU1vZGU7\nCmltcG9ydCBqYXZheC5wZXJzaXN0ZW5jZS5FbnRpdHlNYW5hZ2VyOwppbXBv\ncnQgamF2YXgucGVyc2lzdGVuY2UuRmx1c2hNb2RlVHlwZTsKaW1wb3J0IGph\ndmF4LnBlcnNpc3RlbmNlLkxvY2tNb2RlVHlwZTsKaW1wb3J0IGphdmF4LnBl\ncnNpc3RlbmNlLlF1ZXJ5OwppbXBvcnQgamF2YXgucGVyc2lzdGVuY2UuVHlw\nZWRRdWVyeTsKaW1wb3J0IGphdmF4LnBlcnNpc3RlbmNlLmNyaXRlcmlhLkNy\naXRlcmlhUXVlcnk7CmltcG9ydCBqYXZheC5wZXJzaXN0ZW5jZS5jcml0ZXJp\nYS5QYXJhbWV0ZXJFeHByZXNzaW9uOwppbXBvcnQgamF2YXgucGVyc2lzdGVu\nY2UubWV0YW1vZGVsLk1ldGFtb2RlbDsKCmltcG9ydCBvcmcuYXBhY2hlLmNv\nbW1vbnMubGFuZy5TdHJpbmdVdGlsczsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5jb25mLkNvbXBhdGliaWxpdHk7CmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEuY29uZi5PcGVuSlBBQ29uZmlndXJhdGlvbjsKaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS5lZS5NYW5hZ2VkUnVudGltZTsKaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS5lbmhhbmNlLlBDRW5oYW5jZXI7CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEuZW5oYW5jZS5QQ1JlZ2lzdHJ5OwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLmVuaGFuY2UuUmVmbGVjdGlvbjsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuQWJzdHJhY3RCcm9rZXJGYWN0b3J5\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5Ccm9rZXI7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLkRhdGFDYWNoZVJldHJp\nZXZlTW9kZTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuRGF0\nYUNhY2hlU3RvcmVNb2RlOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmtl\ncm5lbC5EZWxlZ2F0aW5nQnJva2VyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLmtlcm5lbC5GZXRjaENvbmZpZ3VyYXRpb247CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEua2VybmVsLkZpbmRDYWxsYmFja3M7CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEua2VybmVsLk9wQ2FsbGJhY2tzOwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5PcGVuSlBBU3RhdGVNYW5hZ2VyOwpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5QcmVwYXJlZFF1ZXJ5\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5QcmVwYXJlZFF1\nZXJ5Q2FjaGU7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLlF1\nZXJ5Rmx1c2hNb2RlczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJu\nZWwuUXVlcnlMYW5ndWFnZXM7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\na2VybmVsLlNlcTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwu\nanBxbC5KUFFMUGFyc2VyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxp\nYi5sb2cuTG9nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51dGls\nLkNsb3NlYWJsZTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIudXRp\nbC5Mb2NhbGl6ZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YS5D\nbGFzc01ldGFEYXRhOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEu\nRmllbGRNZXRhRGF0YTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRh\nLlF1ZXJ5TWV0YURhdGE7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0\nYS5TZXF1ZW5jZU1ldGFEYXRhOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLnBlcnNpc3RlbmNlLmNyaXRlcmlhLkNyaXRlcmlhQnVpbGRlckltcGw7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuY3JpdGVyaWEu\nT3BlbkpQQUNyaXRlcmlhQnVpbGRlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5wZXJzaXN0ZW5jZS5jcml0ZXJpYS5PcGVuSlBBQ3JpdGVyaWFRdWVy\neTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS52YWxp\nZGF0aW9uLlZhbGlkYXRpb25VdGlsczsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS51dGlsLkV4Y2VwdGlvbnM7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEudXRpbC5JbXBsSGVscGVyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLnV0aWwuUnVudGltZUV4Y2VwdGlvblRyYW5zbGF0b3I7CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEudXRpbC5Vc2VyRXhjZXB0aW9uOwoKaW1wb3J0IHNl\ncnAudXRpbC5TdHJpbmdzOwoKLyoqCiAqIEltcGxlbWVudGF0aW9uIG9mIHtA\nbGluayBFbnRpdHlNYW5hZ2VyfSBpbnRlcmZhY2UuCiAqCiAqIEBhdXRob3Ig\nUGF0cmljayBMaW5za2V5CiAqIEBhdXRob3IgQWJlIFdoaXRlCiAqIEBub2ph\ndmFkb2MKICovCnB1YmxpYyBjbGFzcyBFbnRpdHlNYW5hZ2VySW1wbAogICAg\naW1wbGVtZW50cyBPcGVuSlBBRW50aXR5TWFuYWdlclNQSSwgRXh0ZXJuYWxp\nemFibGUsCiAgICBGaW5kQ2FsbGJhY2tzLCBPcENhbGxiYWNrcywgQ2xvc2Vh\nYmxlLCBPcGVuSlBBRW50aXR5VHJhbnNhY3Rpb24gewoKICAgIHByaXZhdGUg\nc3RhdGljIGZpbmFsIExvY2FsaXplciBfbG9jID0gTG9jYWxpemVyLmZvclBh\nY2thZ2UoRW50aXR5TWFuYWdlckltcGwuY2xhc3MpOwogICAgcHJpdmF0ZSBz\ndGF0aWMgZmluYWwgT2JqZWN0W10gRU1QVFlfT0JKRUNUUyA9IG5ldyBPYmpl\nY3RbMF07CgogICAgcHJpdmF0ZSBEZWxlZ2F0aW5nQnJva2VyIF9icm9rZXI7\nCiAgICBwcml2YXRlIEVudGl0eU1hbmFnZXJGYWN0b3J5SW1wbCBfZW1mOwog\nICAgcHJpdmF0ZSBNYXA8RmV0Y2hDb25maWd1cmF0aW9uLEZldGNoUGxhbj4g\nX3BsYW5zID0gbmV3IElkZW50aXR5SGFzaE1hcDxGZXRjaENvbmZpZ3VyYXRp\nb24sRmV0Y2hQbGFuPigxKTsKICAgIHByaXZhdGUgUnVudGltZUV4Y2VwdGlv\nblRyYW5zbGF0b3IgX3JldCA9IFBlcnNpc3RlbmNlRXhjZXB0aW9ucy5nZXRS\nb2xsYmFja1RyYW5zbGF0b3IodGhpcyk7CgogICAgcHVibGljIEVudGl0eU1h\nbmFnZXJJbXBsKCkgewogICAgICAgIC8vIGZvciBFeHRlcm5hbGl6YWJsZQog\nICAgfQoKICAgIC8qKgogICAgICogQ29uc3RydWN0b3I7IHN1cHBseSBmYWN0\nb3J5IGFuZCBkZWxlZ2F0ZS4KICAgICAqLwogICAgcHVibGljIEVudGl0eU1h\nbmFnZXJJbXBsKEVudGl0eU1hbmFnZXJGYWN0b3J5SW1wbCBmYWN0b3J5LCBC\ncm9rZXIgYnJva2VyKSB7CiAgICAgICAgaW5pdGlhbGl6ZShmYWN0b3J5LCBi\ncm9rZXIpOwogICAgfQoKICAgIHByaXZhdGUgdm9pZCBpbml0aWFsaXplKEVu\ndGl0eU1hbmFnZXJGYWN0b3J5SW1wbCBmYWN0b3J5LCBCcm9rZXIgYnJva2Vy\nKSB7CiAgICAgICAgX2VtZiA9IGZhY3Rvcnk7CiAgICAgICAgX2Jyb2tlciA9\nIG5ldyBEZWxlZ2F0aW5nQnJva2VyKGJyb2tlciwgX3JldCk7CiAgICAgICAg\nX2Jyb2tlci5zZXRJbXBsaWNpdEJlaGF2aW9yKHRoaXMsIF9yZXQpOwogICAg\nfQoKICAgIC8qKgogICAgICogQnJva2VyIGRlbGVnYXRlLgogICAgICovCiAg\nICBwdWJsaWMgQnJva2VyIGdldEJyb2tlcigpIHsKICAgICAgICByZXR1cm4g\nX2Jyb2tlci5nZXREZWxlZ2F0ZSgpOwogICAgfQoKICAgIHB1YmxpYyBPcGVu\nSlBBRW50aXR5TWFuYWdlckZhY3RvcnkgZ2V0RW50aXR5TWFuYWdlckZhY3Rv\ncnkoKSB7CiAgICAgICAgcmV0dXJuIF9lbWY7CiAgICB9CgogICAgcHVibGlj\nIE9wZW5KUEFDb25maWd1cmF0aW9uIGdldENvbmZpZ3VyYXRpb24oKSB7CiAg\nICAgICAgcmV0dXJuIF9icm9rZXIuZ2V0Q29uZmlndXJhdGlvbigpOwogICAg\nfQoKICAgIHB1YmxpYyBGZXRjaFBsYW4gZ2V0RmV0Y2hQbGFuKCkgewogICAg\nICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIF9icm9rZXIu\nbG9jaygpOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIEZldGNoQ29uZmln\ndXJhdGlvbiBmYyA9IF9icm9rZXIuZ2V0RmV0Y2hDb25maWd1cmF0aW9uKCk7\nCiAgICAgICAgICAgIEZldGNoUGxhbiBmcCA9IF9wbGFucy5nZXQoZmMpOwog\nICAgICAgICAgICBpZiAoZnAgPT0gbnVsbCkgewogICAgICAgICAgICAgICAg\nZnAgPSBfZW1mLnRvRmV0Y2hQbGFuKF9icm9rZXIsIGZjKTsKICAgICAgICAg\nICAgICAgIF9wbGFucy5wdXQoZmMsIGZwKTsKICAgICAgICAgICAgfQogICAg\nICAgICAgICByZXR1cm4gZnA7CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAg\nICAgICAgX2Jyb2tlci51bmxvY2soKTsKICAgICAgICB9CiAgICB9CgogICAg\ncHVibGljIEZldGNoUGxhbiBwdXNoRmV0Y2hQbGFuKCkgewogICAgICAgIGFz\nc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIF9icm9rZXIubG9jaygp\nOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIF9icm9rZXIucHVzaEZldGNo\nQ29uZmlndXJhdGlvbigpOwogICAgICAgICAgICByZXR1cm4gZ2V0RmV0Y2hQ\nbGFuKCk7CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgX2Jyb2tl\nci51bmxvY2soKTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGljIHZvaWQg\ncG9wRmV0Y2hQbGFuKCkgewogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tl\nZCgpOwogICAgICAgIF9icm9rZXIubG9jaygpOwogICAgICAgIHRyeSB7CiAg\nICAgICAgICAgIF9icm9rZXIucG9wRmV0Y2hDb25maWd1cmF0aW9uKCk7CiAg\nICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgX2Jyb2tlci51bmxvY2so\nKTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGljIENvbm5lY3Rpb25SZXRh\naW5Nb2RlIGdldENvbm5lY3Rpb25SZXRhaW5Nb2RlKCkgewogICAgICAgIHJl\ndHVybiBDb25uZWN0aW9uUmV0YWluTW9kZS5mcm9tS2VybmVsQ29uc3RhbnQo\nCiAgICAgICAgICAgIF9icm9rZXIuZ2V0Q29ubmVjdGlvblJldGFpbk1vZGUo\nKSk7CiAgICB9CgogICAgcHVibGljIGJvb2xlYW4gaXNUcmFuc2FjdGlvbk1h\nbmFnZWQoKSB7CiAgICAgICAgcmV0dXJuIF9icm9rZXIuaXNNYW5hZ2VkKCk7\nCiAgICB9CgogICAgcHVibGljIGJvb2xlYW4gaXNNYW5hZ2VkKCkgewogICAg\nICAgIHJldHVybiBfYnJva2VyLmlzTWFuYWdlZCgpOwogICAgfQoKICAgIHB1\nYmxpYyBNYW5hZ2VkUnVudGltZSBnZXRNYW5hZ2VkUnVudGltZSgpIHsKICAg\nICAgICByZXR1cm4gX2Jyb2tlci5nZXRNYW5hZ2VkUnVudGltZSgpOwogICAg\nfQoKICAgIHB1YmxpYyBib29sZWFuIGdldFN5bmNXaXRoTWFuYWdlZFRyYW5z\nYWN0aW9ucygpIHsKICAgICAgICByZXR1cm4gX2Jyb2tlci5nZXRTeW5jV2l0\naE1hbmFnZWRUcmFuc2FjdGlvbnMoKTsKICAgIH0KCiAgICBwdWJsaWMgdm9p\nZCBzZXRTeW5jV2l0aE1hbmFnZWRUcmFuc2FjdGlvbnMoYm9vbGVhbiBzeW5j\nKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAg\nX2Jyb2tlci5zZXRTeW5jV2l0aE1hbmFnZWRUcmFuc2FjdGlvbnMoc3luYyk7\nCiAgICB9CgogICAgcHVibGljIENsYXNzTG9hZGVyIGdldENsYXNzTG9hZGVy\nKCkgewogICAgICAgIHJldHVybiBfYnJva2VyLmdldENsYXNzTG9hZGVyKCk7\nCiAgICB9CgogICAgcHVibGljIFN0cmluZyBnZXRDb25uZWN0aW9uVXNlck5h\nbWUoKSB7CiAgICAgICAgcmV0dXJuIF9icm9rZXIuZ2V0Q29ubmVjdGlvblVz\nZXJOYW1lKCk7CiAgICB9CgogICAgcHVibGljIFN0cmluZyBnZXRDb25uZWN0\naW9uUGFzc3dvcmQoKSB7CiAgICAgICAgcmV0dXJuIF9icm9rZXIuZ2V0Q29u\nbmVjdGlvblBhc3N3b3JkKCk7CiAgICB9CgogICAgcHVibGljIGJvb2xlYW4g\nZ2V0TXVsdGl0aHJlYWRlZCgpIHsKICAgICAgICByZXR1cm4gX2Jyb2tlci5n\nZXRNdWx0aXRocmVhZGVkKCk7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0\nTXVsdGl0aHJlYWRlZChib29sZWFuIG11bHRpdGhyZWFkZWQpIHsKICAgICAg\nICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICBfYnJva2VyLnNl\ndE11bHRpdGhyZWFkZWQobXVsdGl0aHJlYWRlZCk7CiAgICB9CgogICAgcHVi\nbGljIGJvb2xlYW4gZ2V0SWdub3JlQ2hhbmdlcygpIHsKICAgICAgICByZXR1\ncm4gX2Jyb2tlci5nZXRJZ25vcmVDaGFuZ2VzKCk7CiAgICB9CgogICAgcHVi\nbGljIHZvaWQgc2V0SWdub3JlQ2hhbmdlcyhib29sZWFuIHZhbCkgewogICAg\nICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIF9icm9rZXIu\nc2V0SWdub3JlQ2hhbmdlcyh2YWwpOwogICAgfQoKICAgIHB1YmxpYyBib29s\nZWFuIGdldE5vbnRyYW5zYWN0aW9uYWxSZWFkKCkgewogICAgICAgIHJldHVy\nbiBfYnJva2VyLmdldE5vbnRyYW5zYWN0aW9uYWxSZWFkKCk7CiAgICB9Cgog\nICAgcHVibGljIHZvaWQgc2V0Tm9udHJhbnNhY3Rpb25hbFJlYWQoYm9vbGVh\nbiB2YWwpIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAg\nICAgICBfYnJva2VyLnNldE5vbnRyYW5zYWN0aW9uYWxSZWFkKHZhbCk7CiAg\nICB9CgogICAgcHVibGljIGJvb2xlYW4gZ2V0Tm9udHJhbnNhY3Rpb25hbFdy\naXRlKCkgewogICAgICAgIHJldHVybiBfYnJva2VyLmdldE5vbnRyYW5zYWN0\naW9uYWxXcml0ZSgpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldE5vbnRy\nYW5zYWN0aW9uYWxXcml0ZShib29sZWFuIHZhbCkgewogICAgICAgIGFzc2Vy\ndE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIF9icm9rZXIuc2V0Tm9udHJh\nbnNhY3Rpb25hbFdyaXRlKHZhbCk7CiAgICB9CgogICAgcHVibGljIGJvb2xl\nYW4gZ2V0T3B0aW1pc3RpYygpIHsKICAgICAgICByZXR1cm4gX2Jyb2tlci5n\nZXRPcHRpbWlzdGljKCk7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0T3B0\naW1pc3RpYyhib29sZWFuIHZhbCkgewogICAgICAgIGFzc2VydE5vdENsb3Nl\nSW52b2tlZCgpOwogICAgICAgIF9icm9rZXIuc2V0T3B0aW1pc3RpYyh2YWwp\nOwogICAgfQoKICAgIHB1YmxpYyBSZXN0b3JlU3RhdGVUeXBlIGdldFJlc3Rv\ncmVTdGF0ZSgpIHsKICAgICAgICByZXR1cm4gUmVzdG9yZVN0YXRlVHlwZS5m\ncm9tS2VybmVsQ29uc3RhbnQoX2Jyb2tlci5nZXRSZXN0b3JlU3RhdGUoKSk7\nCiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0UmVzdG9yZVN0YXRlKFJlc3Rv\ncmVTdGF0ZVR5cGUgdmFsKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZv\na2VkKCk7CiAgICAgICAgX2Jyb2tlci5zZXRSZXN0b3JlU3RhdGUodmFsLnRv\nS2VybmVsQ29uc3RhbnQoKSk7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0\nUmVzdG9yZVN0YXRlKGludCByZXN0b3JlKSB7CiAgICAgICAgYXNzZXJ0Tm90\nQ2xvc2VJbnZva2VkKCk7CiAgICAgICAgX2Jyb2tlci5zZXRSZXN0b3JlU3Rh\ndGUocmVzdG9yZSk7CiAgICB9CgogICAgcHVibGljIGJvb2xlYW4gZ2V0UmV0\nYWluU3RhdGUoKSB7CiAgICAgICAgcmV0dXJuIF9icm9rZXIuZ2V0UmV0YWlu\nU3RhdGUoKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRSZXRhaW5TdGF0\nZShib29sZWFuIHZhbCkgewogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tl\nZCgpOwogICAgICAgIF9icm9rZXIuc2V0UmV0YWluU3RhdGUodmFsKTsKICAg\nIH0KCiAgICBwdWJsaWMgQXV0b0NsZWFyVHlwZSBnZXRBdXRvQ2xlYXIoKSB7\nCiAgICAgICAgcmV0dXJuIEF1dG9DbGVhclR5cGUuZnJvbUtlcm5lbENvbnN0\nYW50KF9icm9rZXIuZ2V0QXV0b0NsZWFyKCkpOwogICAgfQoKICAgIHB1Ymxp\nYyB2b2lkIHNldEF1dG9DbGVhcihBdXRvQ2xlYXJUeXBlIHZhbCkgewogICAg\nICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIF9icm9rZXIu\nc2V0QXV0b0NsZWFyKHZhbC50b0tlcm5lbENvbnN0YW50KCkpOwogICAgfQoK\nICAgIHB1YmxpYyB2b2lkIHNldEF1dG9DbGVhcihpbnQgYXV0b0NsZWFyKSB7\nCiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAgX2Jy\nb2tlci5zZXRBdXRvQ2xlYXIoYXV0b0NsZWFyKTsKICAgIH0KCiAgICBwdWJs\naWMgRGV0YWNoU3RhdGVUeXBlIGdldERldGFjaFN0YXRlKCkgewogICAgICAg\nIHJldHVybiBEZXRhY2hTdGF0ZVR5cGUuZnJvbUtlcm5lbENvbnN0YW50KF9i\ncm9rZXIuZ2V0RGV0YWNoU3RhdGUoKSk7CiAgICB9CgogICAgcHVibGljIHZv\naWQgc2V0RGV0YWNoU3RhdGUoRGV0YWNoU3RhdGVUeXBlIHR5cGUpIHsKICAg\nICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICBfYnJva2Vy\nLnNldERldGFjaFN0YXRlKHR5cGUudG9LZXJuZWxDb25zdGFudCgpKTsKICAg\nIH0KCiAgICBwdWJsaWMgdm9pZCBzZXREZXRhY2hTdGF0ZShpbnQgZGV0YWNo\nKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAg\nX2Jyb2tlci5zZXREZXRhY2hTdGF0ZShkZXRhY2gpOwogICAgfQoKICAgIHB1\nYmxpYyBFbnVtU2V0PEF1dG9EZXRhY2hUeXBlPiBnZXRBdXRvRGV0YWNoKCkg\newogICAgICAgIHJldHVybiBBdXRvRGV0YWNoVHlwZS50b0VudW1TZXQoX2Jy\nb2tlci5nZXRBdXRvRGV0YWNoKCkpOwogICAgfQoKICAgIHB1YmxpYyB2b2lk\nIHNldEF1dG9EZXRhY2goQXV0b0RldGFjaFR5cGUgZmxhZykgewogICAgICAg\nIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIF9icm9rZXIuc2V0\nQXV0b0RldGFjaChBdXRvRGV0YWNoVHlwZS5mcm9tRW51bVNldChFbnVtU2V0\nLm9mKGZsYWcpKSk7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0QXV0b0Rl\ndGFjaChFbnVtU2V0PEF1dG9EZXRhY2hUeXBlPiBmbGFncykgewogICAgICAg\nIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIF9icm9rZXIuc2V0\nQXV0b0RldGFjaChBdXRvRGV0YWNoVHlwZS5mcm9tRW51bVNldChmbGFncykp\nOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldEF1dG9EZXRhY2goaW50IGF1\ndG9EZXRhY2hGbGFncykgewogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tl\nZCgpOwogICAgICAgIF9icm9rZXIuc2V0QXV0b0RldGFjaChhdXRvRGV0YWNo\nRmxhZ3MpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldEF1dG9EZXRhY2go\nQXV0b0RldGFjaFR5cGUgdmFsdWUsIGJvb2xlYW4gb24pIHsKICAgICAgICBh\nc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICBfYnJva2VyLnNldEF1\ndG9EZXRhY2goQXV0b0RldGFjaFR5cGUuZnJvbUVudW1TZXQoRW51bVNldC5v\nZih2YWx1ZSkpLG9uKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRBdXRv\nRGV0YWNoKGludCBmbGFnLCBib29sZWFuIG9uKSB7CiAgICAgICAgYXNzZXJ0\nTm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAgX2Jyb2tlci5zZXRBdXRvRGV0\nYWNoKGZsYWcsIG9uKTsKICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBnZXRF\ndmljdEZyb21TdG9yZUNhY2hlKCkgewogICAgICAgIHJldHVybiBfYnJva2Vy\nLmdldEV2aWN0RnJvbURhdGFDYWNoZSgpOwogICAgfQoKICAgIHB1YmxpYyB2\nb2lkIHNldEV2aWN0RnJvbVN0b3JlQ2FjaGUoYm9vbGVhbiBldmljdCkgewog\nICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIF9icm9r\nZXIuc2V0RXZpY3RGcm9tRGF0YUNhY2hlKGV2aWN0KTsKICAgIH0KCiAgICBw\ndWJsaWMgYm9vbGVhbiBnZXRQb3B1bGF0ZVN0b3JlQ2FjaGUoKSB7CiAgICAg\nICAgcmV0dXJuIF9icm9rZXIuZ2V0UG9wdWxhdGVEYXRhQ2FjaGUoKTsKICAg\nIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRQb3B1bGF0ZVN0b3JlQ2FjaGUoYm9v\nbGVhbiBjYWNoZSkgewogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgp\nOwogICAgICAgIF9icm9rZXIuc2V0UG9wdWxhdGVEYXRhQ2FjaGUoY2FjaGUp\nOwogICAgfQoKICAgIHB1YmxpYyBib29sZWFuIGlzVHJhY2tDaGFuZ2VzQnlU\neXBlKCkgewogICAgICAgIHJldHVybiBfYnJva2VyLmlzVHJhY2tDaGFuZ2Vz\nQnlUeXBlKCk7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0VHJhY2tDaGFu\nZ2VzQnlUeXBlKGJvb2xlYW4gdHJhY2tCeVR5cGUpIHsKICAgICAgICBhc3Nl\ncnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICBfYnJva2VyLnNldFRyYWNr\nQ2hhbmdlc0J5VHlwZSh0cmFja0J5VHlwZSk7CiAgICB9CgogICAgcHVibGlj\nIGJvb2xlYW4gaXNMYXJnZVRyYW5zYWN0aW9uKCkgewogICAgICAgIHJldHVy\nbiBpc1RyYWNrQ2hhbmdlc0J5VHlwZSgpOwogICAgfQoKICAgIHB1YmxpYyB2\nb2lkIHNldExhcmdlVHJhbnNhY3Rpb24oYm9vbGVhbiB2YWx1ZSkgewogICAg\nICAgIHNldFRyYWNrQ2hhbmdlc0J5VHlwZSh2YWx1ZSk7CiAgICB9CgogICAg\ncHVibGljIE9iamVjdCBnZXRVc2VyT2JqZWN0KE9iamVjdCBrZXkpIHsKICAg\nICAgICByZXR1cm4gX2Jyb2tlci5nZXRVc2VyT2JqZWN0KGtleSk7CiAgICB9\nCgogICAgcHVibGljIE9iamVjdCBwdXRVc2VyT2JqZWN0KE9iamVjdCBrZXks\nIE9iamVjdCB2YWwpIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQo\nKTsKICAgICAgICByZXR1cm4gX2Jyb2tlci5wdXRVc2VyT2JqZWN0KGtleSwg\ndmFsKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBhZGRUcmFuc2FjdGlvbkxp\nc3RlbmVyKE9iamVjdCBsaXN0ZW5lcikgewogICAgICAgIGFzc2VydE5vdENs\nb3NlSW52b2tlZCgpOwogICAgICAgIF9icm9rZXIuYWRkVHJhbnNhY3Rpb25M\naXN0ZW5lcihsaXN0ZW5lcik7CiAgICB9CgogICAgcHVibGljIHZvaWQgcmVt\nb3ZlVHJhbnNhY3Rpb25MaXN0ZW5lcihPYmplY3QgbGlzdGVuZXIpIHsKICAg\nICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICBfYnJva2Vy\nLnJlbW92ZVRyYW5zYWN0aW9uTGlzdGVuZXIobGlzdGVuZXIpOwogICAgfQoK\nICAgIHB1YmxpYyBFbnVtU2V0PENhbGxiYWNrTW9kZT4gZ2V0VHJhbnNhY3Rp\nb25MaXN0ZW5lckNhbGxiYWNrTW9kZXMoKSB7CiAgICAgICAgcmV0dXJuIENh\nbGxiYWNrTW9kZS50b0VudW1TZXQoCiAgICAgICAgICAgIF9icm9rZXIuZ2V0\nVHJhbnNhY3Rpb25MaXN0ZW5lckNhbGxiYWNrTW9kZSgpKTsKICAgIH0KCiAg\nICBwdWJsaWMgdm9pZCBzZXRUcmFuc2FjdGlvbkxpc3RlbmVyQ2FsbGJhY2tN\nb2RlKENhbGxiYWNrTW9kZSBtb2RlKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xv\nc2VJbnZva2VkKCk7CiAgICAgICAgX2Jyb2tlci5zZXRUcmFuc2FjdGlvbkxp\nc3RlbmVyQ2FsbGJhY2tNb2RlKAogICAgICAgICAgICBDYWxsYmFja01vZGUu\nZnJvbUVudW1TZXQoRW51bVNldC5vZihtb2RlKSkpOwogICAgfQoKICAgIHB1\nYmxpYyB2b2lkIHNldFRyYW5zYWN0aW9uTGlzdGVuZXJDYWxsYmFja01vZGUo\nRW51bVNldDxDYWxsYmFja01vZGU+IG1vZGVzKXsKICAgICAgICBhc3NlcnRO\nb3RDbG9zZUludm9rZWQoKTsKICAgICAgICBfYnJva2VyLnNldFRyYW5zYWN0\naW9uTGlzdGVuZXJDYWxsYmFja01vZGUoCiAgICAgICAgICAgIENhbGxiYWNr\nTW9kZS5mcm9tRW51bVNldChtb2RlcykpOwogICAgfQoKICAgIHB1YmxpYyBp\nbnQgZ2V0VHJhbnNhY3Rpb25MaXN0ZW5lckNhbGxiYWNrTW9kZSgpIHsKICAg\nICAgICByZXR1cm4gX2Jyb2tlci5nZXRUcmFuc2FjdGlvbkxpc3RlbmVyQ2Fs\nbGJhY2tNb2RlKCk7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0VHJhbnNh\nY3Rpb25MaXN0ZW5lckNhbGxiYWNrTW9kZShpbnQgY2FsbGJhY2tNb2RlKSB7\nCiAgICAgICAgdGhyb3cgbmV3IFVuc3VwcG9ydGVkT3BlcmF0aW9uRXhjZXB0\naW9uKCk7CiAgICB9CgogICAgcHVibGljIHZvaWQgYWRkTGlmZWN5Y2xlTGlz\ndGVuZXIoT2JqZWN0IGxpc3RlbmVyLCBDbGFzcy4uLiBjbGFzc2VzKSB7CiAg\nICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAgX2Jyb2tl\nci5hZGRMaWZlY3ljbGVMaXN0ZW5lcihsaXN0ZW5lciwgY2xhc3Nlcyk7CiAg\nICB9CgogICAgcHVibGljIHZvaWQgcmVtb3ZlTGlmZWN5Y2xlTGlzdGVuZXIo\nT2JqZWN0IGxpc3RlbmVyKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZv\na2VkKCk7CiAgICAgICAgX2Jyb2tlci5yZW1vdmVMaWZlY3ljbGVMaXN0ZW5l\ncihsaXN0ZW5lcik7CiAgICB9CgogICAgcHVibGljIEVudW1TZXQ8Q2FsbGJh\nY2tNb2RlPiBnZXRMaWZlY3ljbGVMaXN0ZW5lckNhbGxiYWNrTW9kZXMoKSB7\nCiAgICAgICAgcmV0dXJuIENhbGxiYWNrTW9kZS50b0VudW1TZXQoCiAgICAg\nICAgICAgIF9icm9rZXIuZ2V0TGlmZWN5Y2xlTGlzdGVuZXJDYWxsYmFja01v\nZGUoKSk7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0TGlmZWN5Y2xlTGlz\ndGVuZXJDYWxsYmFja01vZGUoQ2FsbGJhY2tNb2RlIG1vZGUpIHsKICAgICAg\nICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICBfYnJva2VyLnNl\ndExpZmVjeWNsZUxpc3RlbmVyQ2FsbGJhY2tNb2RlKAogICAgICAgICAgICBD\nYWxsYmFja01vZGUuZnJvbUVudW1TZXQoRW51bVNldC5vZihtb2RlKSkpOwog\nICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldExpZmVjeWNsZUxpc3RlbmVyQ2Fs\nbGJhY2tNb2RlKEVudW1TZXQ8Q2FsbGJhY2tNb2RlPiBtb2RlcykgewogICAg\nICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIF9icm9rZXIu\nc2V0TGlmZWN5Y2xlTGlzdGVuZXJDYWxsYmFja01vZGUoCiAgICAgICAgICAg\nIENhbGxiYWNrTW9kZS5mcm9tRW51bVNldChtb2RlcykpOwogICAgfQoKICAg\nIHB1YmxpYyBpbnQgZ2V0TGlmZWN5Y2xlTGlzdGVuZXJDYWxsYmFja01vZGUo\nKSB7CiAgICAgICAgcmV0dXJuIF9icm9rZXIuZ2V0TGlmZWN5Y2xlTGlzdGVu\nZXJDYWxsYmFja01vZGUoKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRM\naWZlY3ljbGVMaXN0ZW5lckNhbGxiYWNrTW9kZShpbnQgY2FsbGJhY2tNb2Rl\nKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAg\nX2Jyb2tlci5zZXRMaWZlY3ljbGVMaXN0ZW5lckNhbGxiYWNrTW9kZShjYWxs\nYmFja01vZGUpOwogICAgfQoKICAgIEBTdXBwcmVzc1dhcm5pbmdzKCJ1bmNo\nZWNrZWQiKQogICAgcHVibGljIDxUPiBUIGdldFJlZmVyZW5jZShDbGFzczxU\nPiBjbHMsIE9iamVjdCBvaWQpIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUlu\ndm9rZWQoKTsKICAgICAgICBvaWQgPSBfYnJva2VyLm5ld09iamVjdElkKGNs\ncywgb2lkKTsKICAgICAgICByZXR1cm4gKFQpIF9icm9rZXIuZmluZChvaWQs\nIGZhbHNlLCB0aGlzKTsKICAgIH0KCiAgICBAU3VwcHJlc3NXYXJuaW5ncygi\ndW5jaGVja2VkIikKICAgIHB1YmxpYyA8VD4gVCBmaW5kKENsYXNzPFQ+IGNs\ncywgT2JqZWN0IG9pZCkgewogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tl\nZCgpOwogICAgICAgIGlmIChvaWQgPT0gbnVsbCkKICAgICAgICAJcmV0dXJu\nIG51bGw7CiAgICAgICAgb2lkID0gX2Jyb2tlci5uZXdPYmplY3RJZChjbHMs\nIG9pZCk7CiAgICAgICAgcmV0dXJuIChUKSBfYnJva2VyLmZpbmQob2lkLCB0\ncnVlLCB0aGlzKTsKICAgIH0KCiAgICBwdWJsaWMgPFQ+IFQgZmluZChDbGFz\nczxUPiBjbHMsIE9iamVjdCBvaWQsIExvY2tNb2RlVHlwZSBtb2RlKSB7CiAg\nICAgICAgcmV0dXJuIGZpbmQoY2xzLCBvaWQsIG1vZGUsIG51bGwpOwogICAg\nfQoKICAgIHB1YmxpYyA8VD4gVCBmaW5kKENsYXNzPFQ+IGNscywgT2JqZWN0\nIG9pZCwgCiAgICAgICAgTWFwPFN0cmluZywgT2JqZWN0PiBwcm9wZXJ0aWVz\nKXsKICAgICAgICByZXR1cm4gZmluZChjbHMsIG9pZCwgbnVsbCwgcHJvcGVy\ndGllcyk7CiAgICB9CgogICAgQFN1cHByZXNzV2FybmluZ3MoInVuY2hlY2tl\nZCIpCiAgICBwdWJsaWMgPFQ+IFQgZmluZChDbGFzczxUPiBjbHMsIE9iamVj\ndCBvaWQsIExvY2tNb2RlVHlwZSBtb2RlLCBNYXA8U3RyaW5nLCBPYmplY3Q+\nIHByb3BlcnRpZXMpIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQo\nKTsKICAgICAgICBjb25maWd1cmVDdXJyZW50RmV0Y2hQbGFuKHB1c2hGZXRj\naFBsYW4oKSwgcHJvcGVydGllcywgbW9kZSwgdHJ1ZSk7CiAgICAgICAgdHJ5\nIHsKICAgICAgICAgICAgb2lkID0gX2Jyb2tlci5uZXdPYmplY3RJZChjbHMs\nIG9pZCk7CiAgICAgICAgICAgIHJldHVybiAoVCkgX2Jyb2tlci5maW5kKG9p\nZCwgdHJ1ZSwgdGhpcyk7CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAg\nICAgcG9wRmV0Y2hQbGFuKCk7CiAgICAgICAgfQogICAgfQoKICAgIEBTdXBw\ncmVzc1dhcm5pbmdzKCJ1bmNoZWNrZWQiKQogICAgcHVibGljIDxUPiBUW10g\nZmluZEFsbChDbGFzczxUPiBjbHMsIE9iamVjdC4uLiBvaWRzKSB7CiAgICAg\nICAgaWYgKG9pZHMubGVuZ3RoID09IDApCiAgICAgICAgICAgIHJldHVybiAo\nVFtdKSBBcnJheS5uZXdJbnN0YW5jZShjbHMsIDApOwogICAgICAgIENvbGxl\nY3Rpb248VD4gcmV0ID0gZmluZEFsbChjbHMsIEFycmF5cy5hc0xpc3Qob2lk\ncykpOwogICAgICAgIHJldHVybiByZXQudG9BcnJheSgoVFtdKSBBcnJheS5u\nZXdJbnN0YW5jZShjbHMsIHJldC5zaXplKCkpKTsKICAgIH0KCiAgICBAU3Vw\ncHJlc3NXYXJuaW5ncygidW5jaGVja2VkIikKICAgIHB1YmxpYyA8VD4gQ29s\nbGVjdGlvbjxUPiBmaW5kQWxsKGZpbmFsIENsYXNzPFQ+IGNscywgQ29sbGVj\ndGlvbiBvaWRzKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7\nCiAgICAgICAgT2JqZWN0W10gb2JqcyA9IF9icm9rZXIuZmluZEFsbChvaWRz\nLCB0cnVlLCBuZXcgRmluZENhbGxiYWNrcygpIHsKICAgICAgICAgICAgcHVi\nbGljIE9iamVjdCBwcm9jZXNzQXJndW1lbnQoT2JqZWN0IG9pZCkgewogICAg\nICAgICAgICAgICAgcmV0dXJuIF9icm9rZXIubmV3T2JqZWN0SWQoY2xzLCBv\naWQpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBwdWJsaWMgT2JqZWN0\nIHByb2Nlc3NSZXR1cm4oT2JqZWN0IG9pZCwgT3BlbkpQQVN0YXRlTWFuYWdl\nciBzbSkgewogICAgICAgICAgICAgICAgcmV0dXJuIEVudGl0eU1hbmFnZXJJ\nbXBsLnRoaXMucHJvY2Vzc1JldHVybihvaWQsIHNtKTsKICAgICAgICAgICAg\nfQogICAgICAgIH0pOwogICAgICAgIHJldHVybiAoQ29sbGVjdGlvbjxUPikg\nQXJyYXlzLmFzTGlzdChvYmpzKTsKICAgIH0KCiAgICBAU3VwcHJlc3NXYXJu\naW5ncygidW5jaGVja2VkIikKICAgIHB1YmxpYyA8VD4gVCBmaW5kQ2FjaGVk\nKENsYXNzPFQ+IGNscywgT2JqZWN0IG9pZCkgewogICAgICAgIGFzc2VydE5v\ndENsb3NlSW52b2tlZCgpOwogICAgICAgIHJldHVybiAoVCkgX2Jyb2tlci5m\naW5kQ2FjaGVkKF9icm9rZXIubmV3T2JqZWN0SWQoY2xzLCBvaWQpLCB0aGlz\nKTsKICAgIH0KCiAgICBwdWJsaWMgQ2xhc3MgZ2V0T2JqZWN0SWRDbGFzcyhD\nbGFzcyBjbHMpIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsK\nICAgICAgICBpZiAoY2xzID09IG51bGwpCiAgICAgICAgICAgIHJldHVybiBu\ndWxsOwogICAgICAgIHJldHVybiBKUEFGYWNhZGVIZWxwZXIuZnJvbU9wZW5K\nUEFPYmplY3RJZENsYXNzCiAgICAgICAgICAgICAgICAoX2Jyb2tlci5nZXRP\nYmplY3RJZFR5cGUoY2xzKSk7CiAgICB9CgogICAgcHVibGljIE9wZW5KUEFF\nbnRpdHlUcmFuc2FjdGlvbiBnZXRUcmFuc2FjdGlvbigpIHsKICAgICAgICBp\nZiAoX2Jyb2tlci5pc01hbmFnZWQoKSkKICAgICAgICAgICAgdGhyb3cgbmV3\nIEludmFsaWRTdGF0ZUV4Y2VwdGlvbihfbG9jLmdldCgiZ2V0LW1hbmFnZWQt\ndHJhbnMiKSwKICAgICAgICAgICAgICAgIG51bGwsIG51bGwsIGZhbHNlKTsK\nICAgICAgICByZXR1cm4gdGhpczsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBq\nb2luVHJhbnNhY3Rpb24oKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZv\na2VkKCk7CiAgICAgICAgaWYgKCFfYnJva2VyLnN5bmNXaXRoTWFuYWdlZFRy\nYW5zYWN0aW9uKCkpCiAgICAgICAgICAgIHRocm93IG5ldyBUcmFuc2FjdGlv\nblJlcXVpcmVkRXhjZXB0aW9uKF9sb2MuZ2V0CiAgICAgICAgICAgICAgICAo\nIm5vLW1hbmFnZWQtdHJhbnMiKSwgbnVsbCwgbnVsbCwgZmFsc2UpOwogICAg\nfQoKICAgIHB1YmxpYyB2b2lkIGJlZ2luKCkgewogICAgICAgIF9icm9rZXIu\nYmVnaW4oKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBjb21taXQoKSB7CiAg\nICAgICAgdHJ5IHsKICAgICAgICAgICAgX2Jyb2tlci5jb21taXQoKTsKICAg\nICAgICB9IGNhdGNoIChSb2xsYmFja0V4Y2VwdGlvbiBlKSB7CiAgICAgICAg\nICAgIHRocm93IGU7CiAgICAgICAgfSBjYXRjaCAoSWxsZWdhbFN0YXRlRXhj\nZXB0aW9uIGUpIHsKICAgICAgICAgICAgdGhyb3cgZTsKICAgICAgICB9IGNh\ndGNoIChFeGNlcHRpb24gZSkgewogICAgICAgIAkvLyBQZXIgSlBBIDIuMCBz\ncGVjLCBpZiB0aGUgZXhjZXB0aW9uIHdhcyBkdWUgdG8gYSBKU1ItMzAzIAog\nICAgICAgICAgICAvLyBjb25zdHJhaW50IHZpb2xhdGlvbiwgdGhlIENvbnN0\ncmFpbnRWaW9sYXRpb25FeGNlcHRpb24gc2hvdWxkIGJlIAogICAgICAgICAg\nICAvLyB0aHJvd24uICBTaW5jZSBKU1ItMzAzIGlzIG9wdGlvbmFsLCB0aGUg\nY2FzdCB0byBSdW50aW1lRXhjZXB0aW9uIAogICAgICAgICAgICAvLyBwcmV2\nZW50cyB0aGUgaW50cm9kdWN0aW9uIG9mIGEgcnVudGltZSBkZXBlbmRlbmN5\nIG9uIHRoZSBCViBBUEkuCiAgICAgICAgICAgIGlmIChWYWxpZGF0aW9uVXRp\nbHMuaXNDb25zdHJhaW50VmlvbGF0aW9uRXhjZXB0aW9uKGUpKQogICAgICAg\nICAgICAgICAgdGhyb3cgKFJ1bnRpbWVFeGNlcHRpb24pZTsKICAgICAgICAg\nICAgLy8gUm9sbGJhY2tFeGNlcHRpb25zIGFyZSBzcGVjaWFsIGFuZCBhcmVu\nJ3QgaGFuZGxlZCBieSB0aGUKICAgICAgICAgICAgLy8gbm9ybWFsIGV4Y2Vw\ndGlvbiB0cmFuc2xhdG9yLCBzaW5jZSB0aGUgc3BlYyBzYXlzIHRoZXkKICAg\nICAgICAgICAgLy8gc2hvdWxkIGJlIHRocm93biB3aGVuZXZlciB0aGUgY29t\nbWl0IGZhaWxzIGZvciBhbnkgcmVhc29uIGF0CiAgICAgICAgICAgIC8vIGFs\nbCwgd2hlcmFzIHRoZSBleGNlcHRpb24gdHJhbnNsYXRvciBoYW5kbGVzIGV4\nY2VwdGlvbnMgdGhhdAogICAgICAgICAgICAvLyBhcmUgY2F1c2VkIGZvciBz\ncGVjaWZpYyByZWFzb25zCiAgICAgICAgICAgIHRocm93IG5ldyBSb2xsYmFj\na0V4Y2VwdGlvbihlKTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGljIHZv\naWQgcm9sbGJhY2soKSB7CiAgICAgICAgX2Jyb2tlci5yb2xsYmFjaygpOwog\nICAgfQoKICAgIHB1YmxpYyB2b2lkIGNvbW1pdEFuZFJlc3VtZSgpIHsKICAg\nICAgICBfYnJva2VyLmNvbW1pdEFuZFJlc3VtZSgpOwogICAgfQoKICAgIHB1\nYmxpYyB2b2lkIHJvbGxiYWNrQW5kUmVzdW1lKCkgewogICAgICAgIF9icm9r\nZXIucm9sbGJhY2tBbmRSZXN1bWUoKTsKICAgIH0KCiAgICBwdWJsaWMgVGhy\nb3dhYmxlIGdldFJvbGxiYWNrQ2F1c2UoKSB7CiAgICAgICAgaWYgKCFpc0Fj\ndGl2ZSgpKQogICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbFN0YXRlRXhj\nZXB0aW9uKF9sb2MuZ2V0KCJuby10cmFuc2FjdGlvbiIpCiAgICAgICAgICAg\nICAgICAuZ2V0TWVzc2FnZSgpKTsKCiAgICAgICAgcmV0dXJuIF9icm9rZXIu\nZ2V0Um9sbGJhY2tDYXVzZSgpOwogICAgfQoKICAgIHB1YmxpYyBib29sZWFu\nIGdldFJvbGxiYWNrT25seSgpIHsKICAgICAgICBpZiAoIWlzQWN0aXZlKCkp\nCiAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsU3RhdGVFeGNlcHRpb24o\nX2xvYy5nZXQoIm5vLXRyYW5zYWN0aW9uIikKICAgICAgICAgICAgICAgIC5n\nZXRNZXNzYWdlKCkpOwoKICAgICAgICByZXR1cm4gX2Jyb2tlci5nZXRSb2xs\nYmFja09ubHkoKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRSb2xsYmFj\na09ubHkoKSB7CiAgICAgICAgX2Jyb2tlci5zZXRSb2xsYmFja09ubHkoKTsK\nICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRSb2xsYmFja09ubHkoVGhyb3dh\nYmxlIGNhdXNlKSB7CiAgICAgICAgX2Jyb2tlci5zZXRSb2xsYmFja09ubHko\nY2F1c2UpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldFNhdmVwb2ludChT\ndHJpbmcgbmFtZSkgewogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgp\nOwogICAgICAgIF9icm9rZXIuc2V0U2F2ZXBvaW50KG5hbWUpOwogICAgfQoK\nICAgIHB1YmxpYyB2b2lkIHJvbGxiYWNrVG9TYXZlcG9pbnQoKSB7CiAgICAg\nICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAgX2Jyb2tlci5y\nb2xsYmFja1RvU2F2ZXBvaW50KCk7CiAgICB9CgogICAgcHVibGljIHZvaWQg\ncm9sbGJhY2tUb1NhdmVwb2ludChTdHJpbmcgbmFtZSkgewogICAgICAgIGFz\nc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIF9icm9rZXIucm9sbGJh\nY2tUb1NhdmVwb2ludChuYW1lKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBy\nZWxlYXNlU2F2ZXBvaW50KCkgewogICAgICAgIGFzc2VydE5vdENsb3NlSW52\nb2tlZCgpOwogICAgICAgIF9icm9rZXIucmVsZWFzZVNhdmVwb2ludCgpOwog\nICAgfQoKICAgIHB1YmxpYyB2b2lkIHJlbGVhc2VTYXZlcG9pbnQoU3RyaW5n\nIG5hbWUpIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAg\nICAgICBfYnJva2VyLnJlbGVhc2VTYXZlcG9pbnQobmFtZSk7CiAgICB9Cgog\nICAgcHVibGljIHZvaWQgZmx1c2goKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xv\nc2VJbnZva2VkKCk7CiAgICAgICAgX2Jyb2tlci5hc3NlcnRPcGVuKCk7CiAg\nICAgICAgX2Jyb2tlci5hc3NlcnRBY3RpdmVUcmFuc2FjdGlvbigpOwogICAg\nICAgIF9icm9rZXIuZmx1c2goKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBw\ncmVGbHVzaCgpIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsK\nICAgICAgICBfYnJva2VyLnByZUZsdXNoKCk7CiAgICB9CgogICAgcHVibGlj\nIHZvaWQgdmFsaWRhdGVDaGFuZ2VzKCkgewogICAgICAgIGFzc2VydE5vdENs\nb3NlSW52b2tlZCgpOwogICAgICAgIF9icm9rZXIudmFsaWRhdGVDaGFuZ2Vz\nKCk7CiAgICB9CgogICAgcHVibGljIGJvb2xlYW4gaXNBY3RpdmUoKSB7CiAg\nICAgICAgcmV0dXJuIGlzT3BlbigpICYmIF9icm9rZXIuaXNBY3RpdmUoKTsK\nICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBpc1N0b3JlQWN0aXZlKCkgewog\nICAgICAgIHJldHVybiBfYnJva2VyLmlzU3RvcmVBY3RpdmUoKTsKICAgIH0K\nCiAgICBwdWJsaWMgdm9pZCBiZWdpblN0b3JlKCkgewogICAgICAgIF9icm9r\nZXIuYmVnaW5TdG9yZSgpOwogICAgfQoKICAgIHB1YmxpYyBib29sZWFuIGNv\nbnRhaW5zKE9iamVjdCBlbnRpdHkpIHsKICAgICAgICBhc3NlcnROb3RDbG9z\nZUludm9rZWQoKTsKICAgICAgICBpZiAoZW50aXR5ID09IG51bGwpCiAgICAg\nICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICBPcGVuSlBBU3RhdGVNYW5h\nZ2VyIHNtID0gX2Jyb2tlci5nZXRTdGF0ZU1hbmFnZXIoZW50aXR5KTsKICAg\nICAgICBpZiAoc20gPT0gbnVsbAogICAgICAgICAgICAmJiAhSW1wbEhlbHBl\nci5pc01hbmFnZWRUeXBlKGdldENvbmZpZ3VyYXRpb24oKSwgZW50aXR5Lmdl\ndENsYXNzKCkpKQogICAgICAgICAgICB0aHJvdyBuZXcgQXJndW1lbnRFeGNl\ncHRpb24oX2xvYy5nZXQoIm5vdC1lbnRpdHkiLAogICAgICAgICAgICAgICAg\nZW50aXR5LmdldENsYXNzKCkpLCBudWxsLCBudWxsLCB0cnVlKTsKICAgICAg\nICByZXR1cm4gc20gIT0gbnVsbCAmJiAhc20uaXNEZWxldGVkKCk7CiAgICB9\nCgogICAgcHVibGljIGJvb2xlYW4gY29udGFpbnNBbGwoT2JqZWN0Li4uIGVu\ndGl0aWVzKSB7CiAgICAgICAgZm9yIChPYmplY3QgZW50aXR5IDogZW50aXRp\nZXMpCiAgICAgICAgICAgIGlmICghY29udGFpbnMoZW50aXR5KSkKICAgICAg\nICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICByZXR1cm4gdHJ1ZTsK\nICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBjb250YWluc0FsbChDb2xsZWN0\naW9uIGVudGl0aWVzKSB7CiAgICAgICAgZm9yIChPYmplY3QgZW50aXR5IDog\nZW50aXRpZXMpCiAgICAgICAgICAgIGlmICghY29udGFpbnMoZW50aXR5KSkK\nICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICByZXR1cm4g\ndHJ1ZTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBwZXJzaXN0KE9iamVjdCBl\nbnRpdHkpIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAg\nICAgICBfYnJva2VyLnBlcnNpc3QoZW50aXR5LCB0aGlzKTsKICAgIH0KCiAg\nICBwdWJsaWMgdm9pZCBwZXJzaXN0QWxsKE9iamVjdC4uLiBlbnRpdGllcykg\newogICAgICAgIHBlcnNpc3RBbGwoQXJyYXlzLmFzTGlzdChlbnRpdGllcykp\nOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHBlcnNpc3RBbGwoQ29sbGVjdGlv\nbiBlbnRpdGllcykgewogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgp\nOwogICAgICAgIF9icm9rZXIucGVyc2lzdEFsbChlbnRpdGllcywgdGhpcyk7\nCiAgICB9CgogICAgcHVibGljIHZvaWQgcmVtb3ZlKE9iamVjdCBlbnRpdHkp\nIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICBf\nYnJva2VyLmRlbGV0ZShlbnRpdHksIHRoaXMpOwogICAgfQoKICAgIHB1Ymxp\nYyB2b2lkIHJlbW92ZUFsbChPYmplY3QuLi4gZW50aXRpZXMpIHsKICAgICAg\nICByZW1vdmVBbGwoQXJyYXlzLmFzTGlzdChlbnRpdGllcykpOwogICAgfQoK\nICAgIHB1YmxpYyB2b2lkIHJlbW92ZUFsbChDb2xsZWN0aW9uIGVudGl0aWVz\nKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAg\nX2Jyb2tlci5kZWxldGVBbGwoZW50aXRpZXMsIHRoaXMpOwogICAgfQoKICAg\nIHB1YmxpYyB2b2lkIHJlbGVhc2UoT2JqZWN0IGVudGl0eSkgewogICAgICAg\nIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIF9icm9rZXIucmVs\nZWFzZShlbnRpdHksIHRoaXMpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHJl\nbGVhc2VBbGwoQ29sbGVjdGlvbiBlbnRpdGllcykgewogICAgICAgIGFzc2Vy\ndE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIF9icm9rZXIucmVsZWFzZUFs\nbChlbnRpdGllcywgdGhpcyk7CiAgICB9CgogICAgcHVibGljIHZvaWQgcmVs\nZWFzZUFsbChPYmplY3QuLi4gZW50aXRpZXMpIHsKICAgICAgICByZWxlYXNl\nQWxsKEFycmF5cy5hc0xpc3QoZW50aXRpZXMpKTsKICAgIH0KCiAgICBwdWJs\naWMgdm9pZCByZWZyZXNoKE9iamVjdCBlbnRpdHkpIHsKICAgICAgICByZWZy\nZXNoKGVudGl0eSwgbnVsbCwgbnVsbCk7CiAgICB9CgogICAgcHVibGljIHZv\naWQgcmVmcmVzaChPYmplY3QgZW50aXR5LCBMb2NrTW9kZVR5cGUgbW9kZSkg\newogICAgICAgIHJlZnJlc2goZW50aXR5LCBtb2RlLCBudWxsKTsKICAgIH0K\nCiAgICBwdWJsaWMgdm9pZCByZWZyZXNoKE9iamVjdCBlbnRpdHksIE1hcDxT\ndHJpbmcsIE9iamVjdD4gcHJvcGVydGllcykgewogICAgICAgIHJlZnJlc2go\nZW50aXR5LCBudWxsLCBwcm9wZXJ0aWVzKTsKICAgIH0KCiAgICBwdWJsaWMg\ndm9pZCByZWZyZXNoKE9iamVjdCBlbnRpdHksIExvY2tNb2RlVHlwZSBtb2Rl\nLCBNYXA8U3RyaW5nLCBPYmplY3Q+IHByb3BlcnRpZXMpIHsKICAgICAgICBh\nc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICBhc3NlcnRWYWxpZEF0\ndGNoZWRFbnRpdHkoInJlZnJlc2giLCBlbnRpdHkpOwoKICAgICAgICBfYnJv\na2VyLmFzc2VydFdyaXRlT3BlcmF0aW9uKCk7CiAgICAgICAgY29uZmlndXJl\nQ3VycmVudEZldGNoUGxhbihwdXNoRmV0Y2hQbGFuKCksIHByb3BlcnRpZXMs\nIG1vZGUsIHRydWUpOwogICAgICAgIERhdGFDYWNoZVJldHJpZXZlTW9kZSBy\nbW9kZSA9IGdldEZldGNoUGxhbigpLmdldENhY2hlUmV0cmlldmVNb2RlKCk7\nCiAgICAgICAgaWYgKERhdGFDYWNoZVJldHJpZXZlTW9kZS5VU0UuZXF1YWxz\nKHJtb2RlKSB8fCBybW9kZSA9PSBudWxsKSB7CiAgICAgICAgICAgIGdldEZl\ndGNoUGxhbigpLnNldENhY2hlUmV0cmlldmVNb2RlKERhdGFDYWNoZVJldHJp\nZXZlTW9kZS5CWVBBU1MpOwogICAgICAgICAgICBpZiAocm1vZGUgIT0gbnVs\nbCkgewogICAgICAgICAgICAgICAgTG9nIGxvZyA9IF9icm9rZXIuZ2V0Q29u\nZmlndXJhdGlvbigpLmdldENvbmZpZ3VyYXRpb25Mb2coKTsKICAgICAgICAg\nICAgICAgIGxvZy53YXJuKF9sb2MuZ2V0KCJjYWNoZS1yZXRyaWV2ZS1vdmVy\ncmlkZSIsIEV4Y2VwdGlvbnMudG9TdHJpbmcoZW50aXR5KSkpOwogICAgICAg\nICAgICB9CiAgICAgICAgICAgICAgICAKICAgICAgICB9CiAgICAgICAgdHJ5\nIHsKICAgICAgICAgICAgX2Jyb2tlci5yZWZyZXNoKGVudGl0eSwgdGhpcyk7\nCiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgcG9wRmV0Y2hQbGFu\nKCk7CiAgICAgICAgfQogICAgfQoKICAgIHB1YmxpYyB2b2lkIHJlZnJlc2hB\nbGwoKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAg\nICAgX2Jyb2tlci5hc3NlcnRXcml0ZU9wZXJhdGlvbigpOwogICAgICAgIF9i\ncm9rZXIucmVmcmVzaEFsbChfYnJva2VyLmdldFRyYW5zYWN0aW9uYWxPYmpl\nY3RzKCksIHRoaXMpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHJlZnJlc2hB\nbGwoQ29sbGVjdGlvbiBlbnRpdGllcykgewogICAgICAgIGFzc2VydE5vdENs\nb3NlSW52b2tlZCgpOwogICAgICAgIF9icm9rZXIuYXNzZXJ0V3JpdGVPcGVy\nYXRpb24oKTsKICAgICAgICBfYnJva2VyLnJlZnJlc2hBbGwoZW50aXRpZXMs\nIHRoaXMpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHJlZnJlc2hBbGwoT2Jq\nZWN0Li4uIGVudGl0aWVzKSB7CiAgICAgICAgcmVmcmVzaEFsbChBcnJheXMu\nYXNMaXN0KGVudGl0aWVzKSk7CiAgICB9CgogICAgcHVibGljIHZvaWQgcmV0\ncmlldmUoT2JqZWN0IGVudGl0eSkgewogICAgICAgIGFzc2VydE5vdENsb3Nl\nSW52b2tlZCgpOwogICAgICAgIF9icm9rZXIucmV0cmlldmUoZW50aXR5LCB0\ncnVlLCB0aGlzKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCByZXRyaWV2ZUFs\nbChDb2xsZWN0aW9uIGVudGl0aWVzKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xv\nc2VJbnZva2VkKCk7CiAgICAgICAgX2Jyb2tlci5yZXRyaWV2ZUFsbChlbnRp\ndGllcywgdHJ1ZSwgdGhpcyk7CiAgICB9CgogICAgcHVibGljIHZvaWQgcmV0\ncmlldmVBbGwoT2JqZWN0Li4uIGVudGl0aWVzKSB7CiAgICAgICAgcmV0cmll\ndmVBbGwoQXJyYXlzLmFzTGlzdChlbnRpdGllcykpOwogICAgfQoKICAgIHB1\nYmxpYyB2b2lkIGV2aWN0KE9iamVjdCBlbnRpdHkpIHsKICAgICAgICBhc3Nl\ncnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICBfYnJva2VyLmV2aWN0KGVu\ndGl0eSwgdGhpcyk7CiAgICB9CgogICAgcHVibGljIHZvaWQgZXZpY3RBbGwo\nQ29sbGVjdGlvbiBlbnRpdGllcykgewogICAgICAgIGFzc2VydE5vdENsb3Nl\nSW52b2tlZCgpOwogICAgICAgIF9icm9rZXIuZXZpY3RBbGwoZW50aXRpZXMs\nIHRoaXMpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIGV2aWN0QWxsKE9iamVj\ndC4uLiBlbnRpdGllcykgewogICAgICAgIGV2aWN0QWxsKEFycmF5cy5hc0xp\nc3QoZW50aXRpZXMpKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBldmljdEFs\nbCgpIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAgICAg\nICBfYnJva2VyLmV2aWN0QWxsKHRoaXMpOwogICAgfQoKICAgIHB1YmxpYyB2\nb2lkIGV2aWN0QWxsKENsYXNzIGNscykgewogICAgICAgIGFzc2VydE5vdENs\nb3NlSW52b2tlZCgpOwogICAgICAgIF9icm9rZXIuZXZpY3RBbGwoX2Jyb2tl\nci5uZXdFeHRlbnQoY2xzLCB0cnVlKSwgdGhpcyk7CiAgICB9CgogICAgcHVi\nbGljIHZvaWQgZXZpY3RBbGwoRXh0ZW50IGV4dGVudCkgewogICAgICAgIGFz\nc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIF9icm9rZXIuZXZpY3RB\nbGwoKChFeHRlbnRJbXBsKSBleHRlbnQpLmdldERlbGVnYXRlKCksIHRoaXMp\nOwogICAgfQoKICAgIEBTdXBwcmVzc1dhcm5pbmdzKCJ1bmNoZWNrZWQiKQog\nICAgcHVibGljIDxUPiBUIGRldGFjaENvcHkoVCBlbnRpdHkpIHsKICAgICAg\nICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICBDb21wYXRpYmls\naXR5IGNvbXBhdCA9IHRoaXMuZ2V0Q29uZmlndXJhdGlvbigpLgogICAgICAg\nICAgICBnZXRDb21wYXRpYmlsaXR5SW5zdGFuY2UoKTsKICAgICAgICBib29s\nZWFuIGNvcHlPbkRldGFjaCA9IGNvbXBhdC5nZXRDb3B5T25EZXRhY2goKTsK\nICAgICAgICBib29sZWFuIGNhc2NhZGVXaXRoRGV0YWNoID0gY29tcGF0Lmdl\ndENhc2NhZGVXaXRoRGV0YWNoKCk7CiAgICAgICAgLy8gU2V0IGNvbXBhdGli\naWxpdHkgb3B0aW9ucyB0byBnZXQgMS54IGRldGFjaCBiZWhhdmlvcgogICAg\nICAgIGNvbXBhdC5zZXRDb3B5T25EZXRhY2godHJ1ZSk7CiAgICAgICAgY29t\ncGF0LnNldENhc2NhZGVXaXRoRGV0YWNoKHRydWUpOwogICAgICAgIHRyeSB7\nCiAgICAgICAgICAgIFQgdCA9IChUKV9icm9rZXIuZGV0YWNoKGVudGl0eSwg\ndGhpcyk7CiAgICAgICAgICAgIHJldHVybiB0OwogICAgICAgIH0gZmluYWxs\neSB7CiAgICAgICAgICAgIC8vIFJlc2V0IGNvbXBhdGliaWxpdHkgb3B0aW9u\ncwogICAgICAgICAgICBjb21wYXQuc2V0Q29weU9uRGV0YWNoKGNvcHlPbkRl\ndGFjaCk7CiAgICAgICAgICAgIGNvbXBhdC5zZXRDYXNjYWRlV2l0aERldGFj\naChjYXNjYWRlV2l0aERldGFjaCk7CiAgICAgICAgfSAgICAgICAgCiAgICB9\nCgogICAgcHVibGljIE9iamVjdFtdIGRldGFjaEFsbChPYmplY3QuLi4gZW50\naXRpZXMpIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAg\nICAgICByZXR1cm4gX2Jyb2tlci5kZXRhY2hBbGwoQXJyYXlzLmFzTGlzdChl\nbnRpdGllcyksIHRoaXMpOwogICAgfQoKICAgIHB1YmxpYyBDb2xsZWN0aW9u\nIGRldGFjaEFsbChDb2xsZWN0aW9uIGVudGl0aWVzKSB7CiAgICAgICAgYXNz\nZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAgcmV0dXJuIEFycmF5cy5h\nc0xpc3QoX2Jyb2tlci5kZXRhY2hBbGwoZW50aXRpZXMsIHRoaXMpKTsKICAg\nIH0KCiAgICBAU3VwcHJlc3NXYXJuaW5ncygidW5jaGVja2VkIikKICAgIHB1\nYmxpYyA8VD4gVCBtZXJnZShUIGVudGl0eSkgewogICAgICAgIGFzc2VydE5v\ndENsb3NlSW52b2tlZCgpOwogICAgICAgIHJldHVybiAoVCkgX2Jyb2tlci5h\ndHRhY2goZW50aXR5LCB0cnVlLCB0aGlzKTsKICAgIH0KCiAgICBwdWJsaWMg\nT2JqZWN0W10gbWVyZ2VBbGwoT2JqZWN0Li4uIGVudGl0aWVzKSB7CiAgICAg\nICAgaWYgKGVudGl0aWVzLmxlbmd0aCA9PSAwKQogICAgICAgICAgICByZXR1\ncm4gRU1QVFlfT0JKRUNUUzsKICAgICAgICByZXR1cm4gbWVyZ2VBbGwoQXJy\nYXlzLmFzTGlzdChlbnRpdGllcykpLnRvQXJyYXkoKTsKICAgIH0KCiAgICBw\ndWJsaWMgQ29sbGVjdGlvbiBtZXJnZUFsbChDb2xsZWN0aW9uIGVudGl0aWVz\nKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAg\ncmV0dXJuIEFycmF5cy5hc0xpc3QoX2Jyb2tlci5hdHRhY2hBbGwoZW50aXRp\nZXMsIHRydWUsIHRoaXMpKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCB0cmFu\nc2FjdGlvbmFsKE9iamVjdCBlbnRpdHksIGJvb2xlYW4gdXBkYXRlVmVyc2lv\nbikgewogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAgICAg\nIF9icm9rZXIudHJhbnNhY3Rpb25hbChlbnRpdHksIHVwZGF0ZVZlcnNpb24s\nIHRoaXMpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHRyYW5zYWN0aW9uYWxB\nbGwoQ29sbGVjdGlvbiBvYmpzLCBib29sZWFuIHVwZGF0ZVZlcnNpb24pIHsK\nICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICBfYnJv\na2VyLnRyYW5zYWN0aW9uYWxBbGwob2JqcywgdXBkYXRlVmVyc2lvbiwgdGhp\ncyk7CiAgICB9CgogICAgcHVibGljIHZvaWQgdHJhbnNhY3Rpb25hbEFsbChP\nYmplY3RbXSBvYmpzLCBib29sZWFuIHVwZGF0ZVZlcnNpb24pIHsKICAgICAg\nICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICBfYnJva2VyLnRy\nYW5zYWN0aW9uYWxBbGwoQXJyYXlzLmFzTGlzdChvYmpzKSwgdXBkYXRlVmVy\nc2lvbiwgdGhpcyk7CiAgICB9CgogICAgcHVibGljIHZvaWQgbm9udHJhbnNh\nY3Rpb25hbChPYmplY3QgZW50aXR5KSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xv\nc2VJbnZva2VkKCk7CiAgICAgICAgX2Jyb2tlci5ub250cmFuc2FjdGlvbmFs\nKGVudGl0eSwgdGhpcyk7CiAgICB9CgogICAgcHVibGljIHZvaWQgbm9udHJh\nbnNhY3Rpb25hbEFsbChDb2xsZWN0aW9uIG9ianMpIHsKICAgICAgICBhc3Nl\ncnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICBfYnJva2VyLm5vbnRyYW5z\nYWN0aW9uYWxBbGwob2JqcywgdGhpcyk7CiAgICB9CgogICAgcHVibGljIHZv\naWQgbm9udHJhbnNhY3Rpb25hbEFsbChPYmplY3RbXSBvYmpzKSB7CiAgICAg\nICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAgX2Jyb2tlci5u\nb250cmFuc2FjdGlvbmFsQWxsKEFycmF5cy5hc0xpc3Qob2JqcyksIHRoaXMp\nOwogICAgfQoKICAgIHB1YmxpYyBHZW5lcmF0b3IgZ2V0TmFtZWRHZW5lcmF0\nb3IoU3RyaW5nIG5hbWUpIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUludm9r\nZWQoKTsKICAgICAgICB0cnkgewogICAgICAgICAgICBTZXF1ZW5jZU1ldGFE\nYXRhIG1ldGEgPSBfYnJva2VyLmdldENvbmZpZ3VyYXRpb24oKS4KICAgICAg\nICAgICAgICAgIGdldE1ldGFEYXRhUmVwb3NpdG9yeUluc3RhbmNlKCkuZ2V0\nU2VxdWVuY2VNZXRhRGF0YShuYW1lLAogICAgICAgICAgICAgICAgX2Jyb2tl\nci5nZXRDbGFzc0xvYWRlcigpLCB0cnVlKTsKICAgICAgICAgICAgU2VxIHNl\ncSA9IG1ldGEuZ2V0SW5zdGFuY2UoX2Jyb2tlci5nZXRDbGFzc0xvYWRlcigp\nKTsKICAgICAgICAgICAgcmV0dXJuIG5ldyBHZW5lcmF0b3JJbXBsKHNlcSwg\nbmFtZSwgX2Jyb2tlciwgbnVsbCk7CiAgICAgICAgfSBjYXRjaCAoUnVudGlt\nZUV4Y2VwdGlvbiByZSkgewogICAgICAgICAgICB0aHJvdyBQZXJzaXN0ZW5j\nZUV4Y2VwdGlvbnMudG9QZXJzaXN0ZW5jZUV4Y2VwdGlvbihyZSk7CiAgICAg\nICAgfQogICAgfQoKICAgIHB1YmxpYyBHZW5lcmF0b3IgZ2V0SWRHZW5lcmF0\nb3IoQ2xhc3MgZm9yQ2xhc3MpIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUlu\ndm9rZWQoKTsKICAgICAgICB0cnkgewogICAgICAgICAgICBDbGFzc01ldGFE\nYXRhIG1ldGEgPSBfYnJva2VyLmdldENvbmZpZ3VyYXRpb24oKS4KICAgICAg\nICAgICAgICAgIGdldE1ldGFEYXRhUmVwb3NpdG9yeUluc3RhbmNlKCkuZ2V0\nTWV0YURhdGEoZm9yQ2xhc3MsCiAgICAgICAgICAgICAgICBfYnJva2VyLmdl\ndENsYXNzTG9hZGVyKCksIHRydWUpOwogICAgICAgICAgICBTZXEgc2VxID0g\nX2Jyb2tlci5nZXRJZGVudGl0eVNlcXVlbmNlKG1ldGEpOwogICAgICAgICAg\nICByZXR1cm4gKHNlcSA9PSBudWxsKSA/IG51bGwgOiBuZXcgR2VuZXJhdG9y\nSW1wbChzZXEsIG51bGwsIF9icm9rZXIsCiAgICAgICAgICAgICAgICBtZXRh\nKTsKICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkgewogICAgICAgICAg\nICB0aHJvdyBQZXJzaXN0ZW5jZUV4Y2VwdGlvbnMudG9QZXJzaXN0ZW5jZUV4\nY2VwdGlvbihlKTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGljIEdlbmVy\nYXRvciBnZXRGaWVsZEdlbmVyYXRvcihDbGFzcyBmb3JDbGFzcywgU3RyaW5n\nIGZpZWxkTmFtZSkgewogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgp\nOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIENsYXNzTWV0YURhdGEgbWV0\nYSA9IF9icm9rZXIuZ2V0Q29uZmlndXJhdGlvbigpLgogICAgICAgICAgICAg\nICAgZ2V0TWV0YURhdGFSZXBvc2l0b3J5SW5zdGFuY2UoKS5nZXRNZXRhRGF0\nYShmb3JDbGFzcywKICAgICAgICAgICAgICAgIF9icm9rZXIuZ2V0Q2xhc3NM\nb2FkZXIoKSwgdHJ1ZSk7CiAgICAgICAgICAgIEZpZWxkTWV0YURhdGEgZm1k\nID0gbWV0YS5nZXRGaWVsZChmaWVsZE5hbWUpOwogICAgICAgICAgICBpZiAo\nZm1kID09IG51bGwpCiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgQXJndW1l\nbnRFeGNlcHRpb24oX2xvYy5nZXQoIm5vLW5hbWVkLWZpZWxkIiwKICAgICAg\nICAgICAgICAgICAgICBmb3JDbGFzcywgZmllbGROYW1lKSwgbnVsbCwgbnVs\nbCwgZmFsc2UpOwoKICAgICAgICAgICAgU2VxIHNlcSA9IF9icm9rZXIuZ2V0\nVmFsdWVTZXF1ZW5jZShmbWQpOwogICAgICAgICAgICByZXR1cm4gKHNlcSA9\nPSBudWxsKSA/IG51bGwgOiBuZXcgR2VuZXJhdG9ySW1wbChzZXEsIG51bGws\nIF9icm9rZXIsCiAgICAgICAgICAgICAgICBtZXRhKTsKICAgICAgICB9IGNh\ndGNoIChFeGNlcHRpb24gZSkgewogICAgICAgICAgICB0aHJvdyBQZXJzaXN0\nZW5jZUV4Y2VwdGlvbnMudG9QZXJzaXN0ZW5jZUV4Y2VwdGlvbihlKTsKICAg\nICAgICB9CiAgICB9CgogICAgcHVibGljIDxUPiBFeHRlbnQ8VD4gY3JlYXRl\nRXh0ZW50KENsYXNzPFQ+IGNscywgYm9vbGVhbiBzdWJjbGFzc2VzKSB7CiAg\nICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAgcmV0dXJu\nIG5ldyBFeHRlbnRJbXBsPFQ+KHRoaXMsIF9icm9rZXIubmV3RXh0ZW50KGNs\ncywgc3ViY2xhc3NlcykpOwogICAgfQoKICAgIEBTdXBwcmVzc1dhcm5pbmdz\nKCJ1bmNoZWNrZWQiKQogICAgcHVibGljIDxUPiBUeXBlZFF1ZXJ5PFQ+IGNy\nZWF0ZVF1ZXJ5KFN0cmluZyBxdWVyeSwgQ2xhc3M8VD4gcmVzdWx0Q2xhc3Mp\nIHsKICAgICAgICByZXR1cm4gY3JlYXRlUXVlcnkocXVlcnkpLnNldFJlc3Vs\ndENsYXNzKHJlc3VsdENsYXNzKTsKICAgIH0KICAgIAogICAgcHVibGljIE9w\nZW5KUEFRdWVyeSBjcmVhdGVRdWVyeShTdHJpbmcgcXVlcnkpIHsKICAgICAg\nICByZXR1cm4gY3JlYXRlUXVlcnkoSlBRTFBhcnNlci5MQU5HX0pQUUwsIHF1\nZXJ5KTsKICAgIH0KCiAgICBwdWJsaWMgT3BlbkpQQVF1ZXJ5IGNyZWF0ZVF1\nZXJ5KFN0cmluZyBsYW5ndWFnZSwgU3RyaW5nIHF1ZXJ5KSB7CiAgICAgICAg\nYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAgdHJ5IHsKICAgICAg\nICAgICAgU3RyaW5nIHFpZCA9IHF1ZXJ5OwogICAgICAgICAgICBQcmVwYXJl\nZFF1ZXJ5IHBxID0gSlBRTFBhcnNlci5MQU5HX0pQUUwuZXF1YWxzKGxhbmd1\nYWdlKQogICAgICAgICAgICAgICAgPyBnZXRQcmVwYXJlZFF1ZXJ5KHFpZCkg\nOiBudWxsOwogICAgICAgICAgICBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVs\nLlF1ZXJ5IHEgPSAocHEgPT0gbnVsbCB8fCAhcHEuaXNJbml0aWFsaXplZCgp\nKQogICAgICAgICAgICAgICAgPyBfYnJva2VyLm5ld1F1ZXJ5KGxhbmd1YWdl\nLCBxdWVyeSkKICAgICAgICAgICAgICAgIDogX2Jyb2tlci5uZXdRdWVyeShw\ncS5nZXRMYW5ndWFnZSgpLCBwcSk7CiAgICAgICAgICAgIC8vIGhhdmUgdG8g\ndmFsaWRhdGUgSlBRTCBhY2NvcmRpbmcgdG8gc3BlYwogICAgICAgICAgICBp\nZiAocHEgPT0gbnVsbCAmJiBKUFFMUGFyc2VyLkxBTkdfSlBRTC5lcXVhbHMo\nbGFuZ3VhZ2UpKQogICAgICAgICAgICAgICAgcS5jb21waWxlKCk7IAogICAg\nICAgICAgICBpZiAocHEgIT0gbnVsbCkgewogICAgICAgICAgICAgICAgcHEu\nc2V0SW50byhxKTsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4g\nbmV3IFF1ZXJ5SW1wbCh0aGlzLCBfcmV0LCBxKS5zZXRJZChxaWQpOwogICAg\nICAgIH0gY2F0Y2ggKFJ1bnRpbWVFeGNlcHRpb24gcmUpIHsKICAgICAgICAg\nICAgdGhyb3cgUGVyc2lzdGVuY2VFeGNlcHRpb25zLnRvUGVyc2lzdGVuY2VF\neGNlcHRpb24ocmUpOwogICAgICAgIH0KICAgIH0KICAgIAogICAgcHVibGlj\nIE9wZW5KUEFRdWVyeSBjcmVhdGVRdWVyeShRdWVyeSBxdWVyeSkgewogICAg\nICAgIGlmIChxdWVyeSA9PSBudWxsKQogICAgICAgICAgICByZXR1cm4gY3Jl\nYXRlUXVlcnkoKFN0cmluZykgbnVsbCk7CiAgICAgICAgYXNzZXJ0Tm90Q2xv\nc2VJbnZva2VkKCk7CiAgICAgICAgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5l\nbC5RdWVyeSBxID0gKChRdWVyeUltcGwpIHF1ZXJ5KS5nZXREZWxlZ2F0ZSgp\nOwogICAgICAgIHJldHVybiBuZXcgUXVlcnlJbXBsKHRoaXMsIF9yZXQsIF9i\ncm9rZXIubmV3UXVlcnkocS5nZXRMYW5ndWFnZSgpLAogICAgICAgICAgICBx\nKSk7CiAgICB9CiAgICAKICAgIEBTdXBwcmVzc1dhcm5pbmdzKCJ1bmNoZWNr\nZWQiKQogICAgcHVibGljIDxUPiBUeXBlZFF1ZXJ5PFQ+IGNyZWF0ZU5hbWVk\nUXVlcnkoU3RyaW5nIG5hbWUsIENsYXNzPFQ+IHJlc3VsdENsYXNzKSB7CiAg\nICAgICAgcmV0dXJuIGNyZWF0ZU5hbWVkUXVlcnkobmFtZSkuc2V0UmVzdWx0\nQ2xhc3MocmVzdWx0Q2xhc3MpOwogICAgfQoKICAgIHB1YmxpYyBPcGVuSlBB\nUXVlcnkgY3JlYXRlTmFtZWRRdWVyeShTdHJpbmcgbmFtZSkgewogICAgICAg\nIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIF9icm9rZXIuYXNz\nZXJ0T3BlbigpOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIFF1ZXJ5TWV0\nYURhdGEgbWV0YSA9IF9icm9rZXIuZ2V0Q29uZmlndXJhdGlvbigpLgogICAg\nICAgICAgICAgICAgZ2V0TWV0YURhdGFSZXBvc2l0b3J5SW5zdGFuY2UoKS5n\nZXRRdWVyeU1ldGFEYXRhKG51bGwsIG5hbWUsCiAgICAgICAgICAgICAgICBf\nYnJva2VyLmdldENsYXNzTG9hZGVyKCksIHRydWUpOwogICAgICAgICAgICBT\ndHJpbmcgcWlkID0gbWV0YS5nZXRRdWVyeVN0cmluZygpOwogICAgICAgICAg\nICAKICAgICAgICAgICAgUHJlcGFyZWRRdWVyeSBwcSA9IEpQUUxQYXJzZXIu\nTEFOR19KUFFMLmVxdWFscyhtZXRhLmdldExhbmd1YWdlKCkpCiAgICAgICAg\nICAgICAgICA/IGdldFByZXBhcmVkUXVlcnkocWlkKSA6IG51bGw7CiAgICAg\nICAgICAgIG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuUXVlcnkgZGVsID0g\nKHBxID09IG51bGwgfHwgIXBxLmlzSW5pdGlhbGl6ZWQoKSkKICAgICAgICAg\nICAgICAgID8gX2Jyb2tlci5uZXdRdWVyeShtZXRhLmdldExhbmd1YWdlKCks\nIG1ldGEuZ2V0UXVlcnlTdHJpbmcoKSkKICAgICAgICAgICAgICAgIDogX2Jy\nb2tlci5uZXdRdWVyeShwcS5nZXRMYW5ndWFnZSgpLCBwcSk7CiAgICAgICAg\nICAgIAogICAgICAgICAgICBpZiAocHEgIT0gbnVsbCkgewogICAgICAgICAg\nICAgICAgcHEuc2V0SW50byhkZWwpOwogICAgICAgICAgICB9IGVsc2Ugewog\nICAgICAgICAgICAgICAgbWV0YS5zZXRJbnRvKGRlbCk7CiAgICAgICAgICAg\nICAgICBkZWwuY29tcGlsZSgpOwogICAgICAgICAgICB9CiAgICAgICAgICAg\nIAogICAgICAgICAgICBPcGVuSlBBUXVlcnkgcSA9IG5ldyBRdWVyeUltcGwo\ndGhpcywgX3JldCwgZGVsKS5zZXRJZChxaWQpOwogICAgICAgICAgICBTdHJp\nbmdbXSBoaW50cyA9IG1ldGEuZ2V0SGludEtleXMoKTsKICAgICAgICAgICAg\nT2JqZWN0W10gdmFsdWVzID0gbWV0YS5nZXRIaW50VmFsdWVzKCk7CiAgICAg\nICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgaGludHMubGVuZ3RoOyBpKysp\nCiAgICAgICAgICAgICAgICBxLnNldEhpbnQoaGludHNbaV0sIHZhbHVlc1tp\nXSk7CiAgICAgICAgICAgIHJldHVybiBxOwogICAgICAgIH0gY2F0Y2ggKFJ1\nbnRpbWVFeGNlcHRpb24gcmUpIHsKICAgICAgICAgICAgdGhyb3cgUGVyc2lz\ndGVuY2VFeGNlcHRpb25zLnRvUGVyc2lzdGVuY2VFeGNlcHRpb24ocmUpOwog\nICAgICAgIH0KICAgIH0gICAgCgogICAgcHVibGljIE9wZW5KUEFRdWVyeSBj\ncmVhdGVOYXRpdmVRdWVyeShTdHJpbmcgcXVlcnkpIHsKICAgICAgICB2YWxp\nZGF0ZVNRTChxdWVyeSk7CiAgICAgICAgcmV0dXJuIGNyZWF0ZVF1ZXJ5KFF1\nZXJ5TGFuZ3VhZ2VzLkxBTkdfU1FMLCBxdWVyeSk7CiAgICB9CgogICAgcHVi\nbGljIE9wZW5KUEFRdWVyeSBjcmVhdGVOYXRpdmVRdWVyeShTdHJpbmcgcXVl\ncnksIENsYXNzIGNscykgewogICAgICAgIHJldHVybiBjcmVhdGVOYXRpdmVR\ndWVyeShxdWVyeSkuc2V0UmVzdWx0Q2xhc3MoY2xzKTsKICAgIH0KCiAgICBw\ndWJsaWMgT3BlbkpQQVF1ZXJ5IGNyZWF0ZU5hdGl2ZVF1ZXJ5KFN0cmluZyBx\ndWVyeSwgU3RyaW5nIG1hcHBpbmdOYW1lKSB7CiAgICAgICAgYXNzZXJ0Tm90\nQ2xvc2VJbnZva2VkKCk7CiAgICAgICAgdmFsaWRhdGVTUUwocXVlcnkpOwog\nICAgICAgIG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuUXVlcnkga2VybmVs\nUXVlcnkgPSBfYnJva2VyLm5ld1F1ZXJ5KAogICAgICAgICAgICBRdWVyeUxh\nbmd1YWdlcy5MQU5HX1NRTCwgcXVlcnkpOwogICAgICAgIGtlcm5lbFF1ZXJ5\nLnNldFJlc3VsdE1hcHBpbmcobnVsbCwgbWFwcGluZ05hbWUpOwogICAgICAg\nIHJldHVybiBuZXcgUXVlcnlJbXBsKHRoaXMsIF9yZXQsIGtlcm5lbFF1ZXJ5\nKTsKICAgIH0KCiAgICAvKioKICAgICAqIFZhbGlkYXRlIHRoYXQgdGhlIHVz\nZXIgcHJvdmlkZWQgU1FMLgogICAgICovCiAgICBwcml2YXRlIHN0YXRpYyB2\nb2lkIHZhbGlkYXRlU1FMKFN0cmluZyBxdWVyeSkgewogICAgICAgIGlmIChT\ndHJpbmdVdGlscy50cmltVG9OdWxsKHF1ZXJ5KSA9PSBudWxsKQogICAgICAg\nICAgICB0aHJvdyBuZXcgQXJndW1lbnRFeGNlcHRpb24oX2xvYy5nZXQoIm5v\nLXNxbCIpLCBudWxsLCBudWxsLCBmYWxzZSk7CiAgICB9CiAgICAKICAgIFBy\nZXBhcmVkUXVlcnlDYWNoZSBnZXRQcmVwYXJlZFF1ZXJ5Q2FjaGUoKSB7CiAg\nICAgICAgcmV0dXJuIF9icm9rZXIuZ2V0Q2FjaGVQcmVwYXJlZFF1ZXJ5KCkg\nPwogICAgICAgICAgICBnZXRDb25maWd1cmF0aW9uKCkuZ2V0UXVlcnlTUUxD\nYWNoZUluc3RhbmNlKCkgOiBudWxsOwogICAgfQogICAgCiAgICAvKioKICAg\nICAqIEdldHMgdGhlIHByZXBhcmVkIHF1ZXJ5IGNhY2hlZCBieSB0aGUgZ2l2\nZW4ga2V5LiAKICAgICAqIAogICAgICogQHJldHVybiB0aGUgY2FjaGVkIFBy\nZXBhcmVkUXVlcnkgb3IgbnVsbCBpZiBub25lIGV4aXN0cy4KICAgICAqLwog\nICAgUHJlcGFyZWRRdWVyeSBnZXRQcmVwYXJlZFF1ZXJ5KFN0cmluZyBpZCkg\newogICAgICAgIFByZXBhcmVkUXVlcnlDYWNoZSBjYWNoZSA9IGdldFByZXBh\ncmVkUXVlcnlDYWNoZSgpOwogICAgICAgIHJldHVybiAoY2FjaGUgPT0gbnVs\nbCkgPyBudWxsIDogY2FjaGUuZ2V0KGlkKTsKICAgIH0KCiAgICBwdWJsaWMg\ndm9pZCBzZXRGbHVzaE1vZGUoRmx1c2hNb2RlVHlwZSBmbHVzaE1vZGUpIHsK\nICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICBfYnJv\na2VyLmFzc2VydE9wZW4oKTsKICAgICAgICBfYnJva2VyLmdldEZldGNoQ29u\nZmlndXJhdGlvbigpLnNldEZsdXNoQmVmb3JlUXVlcmllcwogICAgICAgICAg\nICAodG9GbHVzaEJlZm9yZVF1ZXJpZXMoZmx1c2hNb2RlKSk7CiAgICB9Cgog\nICAgcHVibGljIEZsdXNoTW9kZVR5cGUgZ2V0Rmx1c2hNb2RlKCkgewogICAg\nICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIF9icm9rZXIu\nYXNzZXJ0T3BlbigpOwogICAgICAgIHJldHVybiBmcm9tRmx1c2hCZWZvcmVR\ndWVyaWVzKF9icm9rZXIuZ2V0RmV0Y2hDb25maWd1cmF0aW9uKCkuCiAgICAg\nICAgICAgIGdldEZsdXNoQmVmb3JlUXVlcmllcygpKTsKICAgIH0KCiAgICAv\nKioKICAgICAqIFRyYW5zbGF0ZSBvdXIgaW50ZXJuYWwgZmx1c2ggY29uc3Rh\nbnQgdG8gYSBmbHVzaCBtb2RlIGVudW0gdmFsdWUuCiAgICAgKi8KICAgIHN0\nYXRpYyBGbHVzaE1vZGVUeXBlIGZyb21GbHVzaEJlZm9yZVF1ZXJpZXMoaW50\nIGZsdXNoKSB7CiAgICAgICAgc3dpdGNoIChmbHVzaCkgewogICAgICAgICAg\nICBjYXNlIFF1ZXJ5Rmx1c2hNb2Rlcy5GTFVTSF9UUlVFOgogICAgICAgICAg\nICAgICAgcmV0dXJuIEZsdXNoTW9kZVR5cGUuQVVUTzsKICAgICAgICAgICAg\nY2FzZSBRdWVyeUZsdXNoTW9kZXMuRkxVU0hfRkFMU0U6CiAgICAgICAgICAg\nICAgICByZXR1cm4gRmx1c2hNb2RlVHlwZS5DT01NSVQ7CiAgICAgICAgICAg\nIGRlZmF1bHQ6CiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAg\nICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBUcmFuc2xhdGUgYSBmbHVzaCBt\nb2RlIGVudW0gdmFsdWUgdG8gb3VyIGludGVybmFsIGZsdXNoIGNvbnN0YW50\nLgogICAgICovCiAgICBzdGF0aWMgaW50IHRvRmx1c2hCZWZvcmVRdWVyaWVz\nKEZsdXNoTW9kZVR5cGUgZmx1c2hNb2RlKSB7CiAgICAgICAgLy8gY2hvb3Nl\nIGRlZmF1bHQgZm9yIG51bGwKICAgICAgICBpZiAoZmx1c2hNb2RlID09IG51\nbGwpCiAgICAgICAgICAgIHJldHVybiBRdWVyeUZsdXNoTW9kZXMuRkxVU0hf\nV0lUSF9DT05ORUNUSU9OOwogICAgICAgIGlmIChmbHVzaE1vZGUgPT0gRmx1\nc2hNb2RlVHlwZS5BVVRPKQogICAgICAgICAgICByZXR1cm4gUXVlcnlGbHVz\naE1vZGVzLkZMVVNIX1RSVUU7CiAgICAgICAgaWYgKGZsdXNoTW9kZSA9PSBG\nbHVzaE1vZGVUeXBlLkNPTU1JVCkKICAgICAgICAgICAgcmV0dXJuIFF1ZXJ5\nRmx1c2hNb2Rlcy5GTFVTSF9GQUxTRTsKICAgICAgICB0aHJvdyBuZXcgQXJn\ndW1lbnRFeGNlcHRpb24oZmx1c2hNb2RlLnRvU3RyaW5nKCksIG51bGwsIG51\nbGwsIGZhbHNlKTsKICAgIH0KCiAgICAvKgogICAgICogVXNlZCBieSBKYXZh\nIEVFIENvbnRhaW5lcnMgdGhhdCB3aXNoIHRvIHBvb2wgT3BlbkpQQSBFbnRp\ndHlNYW5hZ2Vycy4gIFRoZSBzcGVjaWZpY2F0aW9uCiAgICAgKiBkb2Vzbid0\nIGFsbG93IHRoZSBjbG9zaW5nIG9mIGNvbm5lY3Rpb25zIHdpdGggdGhlIGNs\nZWFyKCkgbWV0aG9kLiAgQnkgaW50cm9kdWNpbmcgdGhpcwogICAgICogbmV3\nIG1ldGhvZCwgd2UgY2FuIGRvIGFkZGl0aW9uYWwgcHJvY2Vzc2luZyAoYW5k\nIG1heWJlIG1vcmUgZWZmaWNpZW50IHByb2Nlc3NpbmcpIHRvIAogICAgICog\ncHJvcGVybHkgcHJlcGFyZSBhbiBFTSBmb3IgcG9vbGluZy4KICAgICAqLwog\nICAgcHVibGljIHZvaWQgcHJlcGFyZUZvclBvb2xpbmcoKSB7CiAgICAgICAg\nYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAgY2xlYXIoKTsKICAg\nICAgICBfYnJva2VyLmxvY2soKTsgIC8vIHNpbmNlIHRoaXMgZGlyZWN0IGNs\nb3NlIHBhdGggaXMgbm90IHByb3RlY3RlZC4uLgogICAgICAgIHRyeSB7CiAg\nICAgICAgICAgIF9icm9rZXIuZ2V0U3RvcmVNYW5hZ2VyKCkuY2xvc2UoKTsK\nICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICBfYnJva2VyLnVubG9j\naygpOwogICAgICAgIH0KICAgIH0KICAgIAogICAgcHVibGljIHZvaWQgY2xl\nYXIoKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAg\nICAgX2Jyb2tlci5kZXRhY2hBbGwodGhpcywgZmFsc2UpOwogICAgICAgIF9w\nbGFucy5jbGVhcigpOwogICAgfQoKICAgIHB1YmxpYyBPYmplY3QgZ2V0RGVs\nZWdhdGUoKSB7CiAgICAgICAgX2Jyb2tlci5hc3NlcnRPcGVuKCk7CiAgICAg\nICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAgICAgcmV0dXJuIHRo\naXM7CiAgICB9CgogICAgcHVibGljIExvY2tNb2RlVHlwZSBnZXRMb2NrTW9k\nZShPYmplY3QgZW50aXR5KSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZv\na2VkKCk7CiAgICAgICAgX2Jyb2tlci5hc3NlcnRBY3RpdmVUcmFuc2FjdGlv\nbigpOwogICAgICAgIGFzc2VydFZhbGlkQXR0Y2hlZEVudGl0eSgiZ2V0TG9j\na01vZGUiLCBlbnRpdHkpOwogICAgICAgIHJldHVybiBNaXhlZExvY2tMZXZl\nbHNIZWxwZXIuZnJvbUxvY2tMZXZlbCgKICAgICAgICAgICAgX2Jyb2tlci5n\nZXRMb2NrTGV2ZWwoZW50aXR5KSk7CiAgICB9CgogICAgcHVibGljIHZvaWQg\nbG9jayhPYmplY3QgZW50aXR5LCBMb2NrTW9kZVR5cGUgbW9kZSkgewogICAg\nICAgIGxvY2soZW50aXR5LCBtb2RlLCAtMSk7CiAgICB9CgogICAgcHVibGlj\nIHZvaWQgbG9jayhPYmplY3QgZW50aXR5KSB7CiAgICAgICAgYXNzZXJ0Tm90\nQ2xvc2VJbnZva2VkKCk7CiAgICAgICAgYXNzZXJ0VmFsaWRBdHRjaGVkRW50\naXR5KCJsb2NrIiwgZW50aXR5KTsKICAgICAgICBfYnJva2VyLmxvY2soZW50\naXR5LCB0aGlzKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBsb2NrKE9iamVj\ndCBlbnRpdHksIExvY2tNb2RlVHlwZSBtb2RlLCBpbnQgdGltZW91dCkgewog\nICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIGFzc2Vy\ndFZhbGlkQXR0Y2hlZEVudGl0eSgibG9jayIsIGVudGl0eSk7CgogICAgICAg\nIGNvbmZpZ3VyZUN1cnJlbnRGZXRjaFBsYW4ocHVzaEZldGNoUGxhbigpLCBu\ndWxsLCBtb2RlLCBmYWxzZSk7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAg\nX2Jyb2tlci5sb2NrKGVudGl0eSwgTWl4ZWRMb2NrTGV2ZWxzSGVscGVyLnRv\nTG9ja0xldmVsKG1vZGUpLCAgdGltZW91dCwgdGhpcyk7CiAgICAgICAgfSBm\naW5hbGx5IHsKICAgICAgICAgICAgcG9wRmV0Y2hQbGFuKCk7CiAgICAgICAg\nfQogICAgfQoKICAgIHB1YmxpYyB2b2lkIGxvY2soT2JqZWN0IGVudGl0eSwg\nTG9ja01vZGVUeXBlIG1vZGUsIE1hcDxTdHJpbmcsIE9iamVjdD4gcHJvcGVy\ndGllcykgewogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAg\nICAgIGFzc2VydFZhbGlkQXR0Y2hlZEVudGl0eSgibG9jayIsIGVudGl0eSk7\nCiAgICAgICAgX2Jyb2tlci5hc3NlcnRBY3RpdmVUcmFuc2FjdGlvbigpOwoK\nICAgICAgICBjb25maWd1cmVDdXJyZW50RmV0Y2hQbGFuKHB1c2hGZXRjaFBs\nYW4oKSwgcHJvcGVydGllcywgbW9kZSwgZmFsc2UpOwogICAgICAgIHRyeSB7\nCiAgICAgICAgICAgIF9icm9rZXIubG9jayhlbnRpdHksIE1peGVkTG9ja0xl\ndmVsc0hlbHBlci50b0xvY2tMZXZlbChtb2RlKSwKICAgICAgICAgICAgICAg\nIF9icm9rZXIuZ2V0RmV0Y2hDb25maWd1cmF0aW9uKCkuZ2V0TG9ja1RpbWVv\ndXQoKSwgdGhpcyk7CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAg\ncG9wRmV0Y2hQbGFuKCk7CiAgICAgICAgfQogICAgfQoKICAgIHB1YmxpYyB2\nb2lkIGxvY2tBbGwoQ29sbGVjdGlvbiBlbnRpdGllcykgewogICAgICAgIGFz\nc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIF9icm9rZXIubG9ja0Fs\nbChlbnRpdGllcywgdGhpcyk7CiAgICB9CgogICAgcHVibGljIHZvaWQgbG9j\na0FsbChDb2xsZWN0aW9uIGVudGl0aWVzLCBMb2NrTW9kZVR5cGUgbW9kZSwg\naW50IHRpbWVvdXQpIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQo\nKTsKICAgICAgICBfYnJva2VyLmxvY2tBbGwoZW50aXRpZXMsIE1peGVkTG9j\na0xldmVsc0hlbHBlci50b0xvY2tMZXZlbChtb2RlKSwKICAgICAgICAgICAg\ndGltZW91dCwgdGhpcyk7CiAgICB9CgogICAgcHVibGljIHZvaWQgbG9ja0Fs\nbChPYmplY3QuLi4gZW50aXRpZXMpIHsKICAgICAgICBsb2NrQWxsKEFycmF5\ncy5hc0xpc3QoZW50aXRpZXMpKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBs\nb2NrQWxsKE9iamVjdFtdIGVudGl0aWVzLCBMb2NrTW9kZVR5cGUgbW9kZSwg\naW50IHRpbWVvdXQpIHsKICAgICAgICBsb2NrQWxsKEFycmF5cy5hc0xpc3Qo\nZW50aXRpZXMpLCBtb2RlLCB0aW1lb3V0KTsKICAgIH0KCiAgICBwdWJsaWMg\nYm9vbGVhbiBjYW5jZWxBbGwoKSB7CiAgICAgICAgcmV0dXJuIF9icm9rZXIu\nY2FuY2VsQWxsKCk7CiAgICB9CgogICAgcHVibGljIE9iamVjdCBnZXRDb25u\nZWN0aW9uKCkgewogICAgICAgIHJldHVybiBfYnJva2VyLmdldENvbm5lY3Rp\nb24oKTsKICAgIH0KCiAgICBwdWJsaWMgQ29sbGVjdGlvbiBnZXRNYW5hZ2Vk\nT2JqZWN0cygpIHsKICAgICAgICByZXR1cm4gX2Jyb2tlci5nZXRNYW5hZ2Vk\nT2JqZWN0cygpOwogICAgfQoKICAgIHB1YmxpYyBDb2xsZWN0aW9uIGdldFRy\nYW5zYWN0aW9uYWxPYmplY3RzKCkgewogICAgICAgIHJldHVybiBfYnJva2Vy\nLmdldFRyYW5zYWN0aW9uYWxPYmplY3RzKCk7CiAgICB9CgogICAgcHVibGlj\nIENvbGxlY3Rpb24gZ2V0UGVuZGluZ1RyYW5zYWN0aW9uYWxPYmplY3RzKCkg\newogICAgICAgIHJldHVybiBfYnJva2VyLmdldFBlbmRpbmdUcmFuc2FjdGlv\nbmFsT2JqZWN0cygpOwogICAgfQoKICAgIHB1YmxpYyBDb2xsZWN0aW9uIGdl\ndERpcnR5T2JqZWN0cygpIHsKICAgICAgICByZXR1cm4gX2Jyb2tlci5nZXRE\naXJ0eU9iamVjdHMoKTsKICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBnZXRP\ncmRlckRpcnR5T2JqZWN0cygpIHsKICAgICAgICByZXR1cm4gX2Jyb2tlci5n\nZXRPcmRlckRpcnR5T2JqZWN0cygpOwogICAgfQoKICAgIHB1YmxpYyB2b2lk\nIHNldE9yZGVyRGlydHlPYmplY3RzKGJvb2xlYW4gb3JkZXIpIHsKICAgICAg\nICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICBfYnJva2VyLnNl\ndE9yZGVyRGlydHlPYmplY3RzKG9yZGVyKTsKICAgIH0KCiAgICBwdWJsaWMg\ndm9pZCBkaXJ0eUNsYXNzKENsYXNzIGNscykgewogICAgICAgIGFzc2VydE5v\ndENsb3NlSW52b2tlZCgpOwogICAgICAgIF9icm9rZXIuZGlydHlUeXBlKGNs\ncyk7CiAgICB9CgogICAgQFN1cHByZXNzV2FybmluZ3MoInVuY2hlY2tlZCIp\nCiAgICBwdWJsaWMgQ29sbGVjdGlvbjxDbGFzcz4gZ2V0UGVyc2lzdGVkQ2xh\nc3NlcygpIHsKICAgICAgICByZXR1cm4gKENvbGxlY3Rpb248Q2xhc3M+KSBf\nYnJva2VyLmdldFBlcnNpc3RlZFR5cGVzKCk7CiAgICB9CgogICAgQFN1cHBy\nZXNzV2FybmluZ3MoInVuY2hlY2tlZCIpCiAgICBwdWJsaWMgQ29sbGVjdGlv\nbjxDbGFzcz4gZ2V0VXBkYXRlZENsYXNzZXMoKSB7CiAgICAgICAgcmV0dXJu\nIChDb2xsZWN0aW9uPENsYXNzPikgX2Jyb2tlci5nZXRVcGRhdGVkVHlwZXMo\nKTsKICAgIH0KCiAgICBAU3VwcHJlc3NXYXJuaW5ncygidW5jaGVja2VkIikK\nICAgIHB1YmxpYyBDb2xsZWN0aW9uPENsYXNzPiBnZXRSZW1vdmVkQ2xhc3Nl\ncygpIHsKICAgICAgICByZXR1cm4gKENvbGxlY3Rpb248Q2xhc3M+KSBfYnJv\na2VyLmdldERlbGV0ZWRUeXBlcygpOwogICAgfQoKICAgIHB1YmxpYyA8VD4g\nVCBjcmVhdGVJbnN0YW5jZShDbGFzczxUPiBjbHMpIHsKICAgICAgICBhc3Nl\ncnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICByZXR1cm4gKFQpIF9icm9r\nZXIubmV3SW5zdGFuY2UoY2xzKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBj\nbG9zZSgpIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAg\nICAgICBfYnJva2VyLmNsb3NlKCk7CiAgICAgICAgX3BsYW5zLmNsZWFyKCk7\nCiAgICB9CgogICAgcHVibGljIGJvb2xlYW4gaXNPcGVuKCkgewogICAgICAg\nIHJldHVybiAhX2Jyb2tlci5pc0Nsb3NlSW52b2tlZCgpOwogICAgfQoKICAg\nIHB1YmxpYyB2b2lkIGRpcnR5KE9iamVjdCBvLCBTdHJpbmcgZmllbGQpIHsK\nICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsKICAgICAgICBPcGVu\nSlBBU3RhdGVNYW5hZ2VyIHNtID0gX2Jyb2tlci5nZXRTdGF0ZU1hbmFnZXIo\nbyk7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgaWYgKHNtICE9IG51bGwp\nCiAgICAgICAgICAgICAgICBzbS5kaXJ0eShmaWVsZCk7CiAgICAgICAgfSBj\nYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgdGhyb3cgUGVyc2lz\ndGVuY2VFeGNlcHRpb25zLnRvUGVyc2lzdGVuY2VFeGNlcHRpb24oZSk7CiAg\nICAgICAgfQogICAgfQoKICAgIHB1YmxpYyBPYmplY3QgZ2V0T2JqZWN0SWQo\nT2JqZWN0IG8pIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsK\nICAgICAgICByZXR1cm4gSlBBRmFjYWRlSGVscGVyLmZyb21PcGVuSlBBT2Jq\nZWN0SWQoX2Jyb2tlci5nZXRPYmplY3RJZChvKSk7CiAgICB9CgogICAgcHVi\nbGljIGJvb2xlYW4gaXNEaXJ0eShPYmplY3QgbykgewogICAgICAgIGFzc2Vy\ndE5vdENsb3NlSW52b2tlZCgpOwogICAgICAgIHJldHVybiBfYnJva2VyLmlz\nRGlydHkobyk7CiAgICB9CgogICAgcHVibGljIGJvb2xlYW4gaXNUcmFuc2Fj\ndGlvbmFsKE9iamVjdCBvKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZv\na2VkKCk7CiAgICAgICAgcmV0dXJuIF9icm9rZXIuaXNUcmFuc2FjdGlvbmFs\nKG8pOwogICAgfQoKICAgIHB1YmxpYyBib29sZWFuIGlzUGVyc2lzdGVudChP\nYmplY3QgbykgewogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwog\nICAgICAgIHJldHVybiBfYnJva2VyLmlzUGVyc2lzdGVudChvKTsKICAgIH0K\nCiAgICBwdWJsaWMgYm9vbGVhbiBpc05ld2x5UGVyc2lzdGVudChPYmplY3Qg\nbykgewogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOwogICAgICAg\nIHJldHVybiBfYnJva2VyLmlzTmV3KG8pOwogICAgfQoKICAgIHB1YmxpYyBi\nb29sZWFuIGlzUmVtb3ZlZChPYmplY3QgbykgewogICAgICAgIGFzc2VydE5v\ndENsb3NlSW52b2tlZCgpOwogICAgICAgIHJldHVybiBfYnJva2VyLmlzRGVs\nZXRlZChvKTsKICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBpc0RldGFjaGVk\nKE9iamVjdCBlbnRpdHkpIHsKICAgICAgICBhc3NlcnROb3RDbG9zZUludm9r\nZWQoKTsKICAgICAgICByZXR1cm4gX2Jyb2tlci5pc0RldGFjaGVkKGVudGl0\neSk7CiAgICB9CgogICAgcHVibGljIE9iamVjdCBnZXRWZXJzaW9uKE9iamVj\ndCBvKSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7CiAgICAg\nICAgcmV0dXJuIF9icm9rZXIuZ2V0VmVyc2lvbihvKTsKICAgIH0KCiAgICAv\nKioKICAgICAqIFRocm93IGFwcHJvcHJpYXRlIGV4Y2VwdGlvbiBpZiBjbG9z\nZSBoYXMgYmVlbiBpbnZva2VkIGJ1dCB0aGUgYnJva2VyCiAgICAgKiBpcyBz\ndGlsbCBvcGVuLiAgV2UgdGVzdCBvbmx5IGZvciB0aGlzIGJlY2F1c2UgaWYg\ndGhlIGJyb2tlciBpcyBhbHJlYWR5CiAgICAgKiBjbG9zZWQsIGl0IHdpbGwg\ndGhyb3cgaXRzIG93biBtb3JlIGluZm9ybWF0aXZlIGV4Y2VwdGlvbiB3aGVu\nIHdlIAogICAgICogZGVsZWdhdGUgdGhlIHBlbmRpbmcgb3BlcmF0aW9uIHRv\nIGl0LgogICAgICovCiAgICB2b2lkIGFzc2VydE5vdENsb3NlSW52b2tlZCgp\nIHsKICAgICAgICBpZiAoIV9icm9rZXIuaXNDbG9zZWQoKSAmJiBfYnJva2Vy\nLmlzQ2xvc2VJbnZva2VkKCkpCiAgICAgICAgICAgIHRocm93IG5ldyBJbnZh\nbGlkU3RhdGVFeGNlcHRpb24oX2xvYy5nZXQoImNsb3NlLWludm9rZWQiKSwg\nbnVsbCwKICAgICAgICAgICAgICAgIG51bGwsIHRydWUpOwogICAgfQoKICAg\nIC8qKgogICAgICogVGhyb3cgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uaWYg\naWYgZW50aXR5IGlzIG5vdCBhIHZhbGlkIGVudGl0eSBvcgogICAgICogaWYg\naXQgaXMgZGV0YWNoZWQuCiAgICAgKi8KICAgIHZvaWQgYXNzZXJ0VmFsaWRB\ndHRjaGVkRW50aXR5KFN0cmluZyBjYWxsLCBPYmplY3QgZW50aXR5KSB7CiAg\nICAgICAgT3BlbkpQQVN0YXRlTWFuYWdlciBzbSA9IF9icm9rZXIuZ2V0U3Rh\ndGVNYW5hZ2VyKGVudGl0eSk7CiAgICAgICAgaWYgKHNtID09IG51bGwgfHwg\nIXNtLmlzUGVyc2lzdGVudCgpIHx8IHNtLmlzRGV0YWNoZWQoKSkgewogICAg\nICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uKF9s\nb2MuZ2V0KCJpbnZhbGlkX2VudGl0eV9hcmd1bWVudCIsIAogICAgICAgICAg\nICAgICAgY2FsbCwgZW50aXR5ID09IG51bGwgPyAibnVsbCIgOiBFeGNlcHRp\nb25zLnRvU3RyaW5nKGVudGl0eSkpLmdldE1lc3NhZ2UoKSk7CiAgICAgICAg\nfQogICAgfQoKICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v\nCiAgICAvLyBGaW5kQ2FsbGJhY2tzIGltcGxlbWVudGF0aW9uCiAgICAvLy8v\nLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwoKICAgIHB1YmxpYyBPYmpl\nY3QgcHJvY2Vzc0FyZ3VtZW50KE9iamVjdCBhcmcpIHsKICAgICAgICByZXR1\ncm4gYXJnOwogICAgfQoKICAgIHB1YmxpYyBPYmplY3QgcHJvY2Vzc1JldHVy\nbihPYmplY3Qgb2lkLCBPcGVuSlBBU3RhdGVNYW5hZ2VyIHNtKSB7CiAgICAg\nICAgcmV0dXJuIChzbSA9PSBudWxsIHx8IHNtLmlzRGVsZXRlZCgpKSA/IG51\nbGwgOiBzbS5nZXRNYW5hZ2VkSW5zdGFuY2UoKTsKICAgIH0KCiAgICAvLy8v\nLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KICAgIC8vIE9wQ2FsbGJhY2tz\nIGltcGxlbWVudGF0aW9uCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v\nLy8vLy8KCiAgICBwdWJsaWMgaW50IHByb2Nlc3NBcmd1bWVudChpbnQgb3As\nIE9iamVjdCBvYmosIE9wZW5KUEFTdGF0ZU1hbmFnZXIgc20pIHsKICAgICAg\nICBzd2l0Y2ggKG9wKSB7CiAgICAgICAgICAgIGNhc2UgT1BfREVMRVRFOgog\nICAgICAgICAgICAgICAgLy8gY2FzY2FkZSB0aHJvdWdoIG5vbi1wZXJzaXN0\nZW50IG5vbi1kZXRhY2hlZCBpbnN0YW5jZXMKICAgICAgICAgICAgICAgIGlm\nIChzbSA9PSBudWxsICYmICFfYnJva2VyLmlzRGV0YWNoZWQob2JqKSkKICAg\nICAgICAgICAgICAgICAgICByZXR1cm4gQUNUX0NBU0NBREU7CiAgICAgICAg\nICAgICAgICBpZiAoc20gIT0gbnVsbCAmJiAhc20uaXNEZXRhY2hlZCgpICYm\nICFzbS5pc1BlcnNpc3RlbnQoKSkKICAgICAgICAgICAgICAgICAgICByZXR1\ncm4gQUNUX0NBU0NBREU7CiAgICAgICAgICAgICAgICAvLyBpZ25vcmUgZGVs\nZXRlZCBpbnN0YW5jZXMKICAgICAgICAgICAgICAgIGlmIChzbSAhPSBudWxs\nICYmIHNtLmlzRGVsZXRlZCgpKQogICAgICAgICAgICAgICAgICAgIHJldHVy\nbiBBQ1RfTk9ORTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAg\nICBjYXNlIE9QX0FUVEFDSDoKICAgICAgICAgICAgICAgIC8vIGRpZSBvbiBy\nZW1vdmVkCiAgICAgICAgICAgICAgICBpZiAoc20gIT0gbnVsbCAmJiBzbS5p\nc0RlbGV0ZWQoKSkKICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgVXNl\nckV4Y2VwdGlvbihfbG9jLmdldCgicmVtb3ZlZCIsCiAgICAgICAgICAgICAg\nICAgICAgICAgIEV4Y2VwdGlvbnMudG9TdHJpbmcob2JqKSkpLnNldEZhaWxl\nZE9iamVjdChvYmopOwogICAgICAgICAgICAgICAgLy8gY2FzY2FkZSB0aHJv\ndWdoIG1hbmFnZWQgaW5zdGFuY2VzCiAgICAgICAgICAgICAgICBpZiAoc20g\nIT0gbnVsbCAmJiAhc20uaXNEZXRhY2hlZCgpKQogICAgICAgICAgICAgICAg\nICAgIHJldHVybiBBQ1RfQ0FTQ0FERTsKICAgICAgICAgICAgICAgIGJyZWFr\nOwogICAgICAgICAgICBjYXNlIE9QX1JFRlJFU0g6CiAgICAgICAgICAgICAg\nICAvLyBkaWUgb24gdW5tYW5hZ2VkIGluc3RhbmNlcwogICAgICAgICAgICAg\nICAgaWYgKHNtID09IG51bGwpCiAgICAgICAgICAgICAgICAgICAgdGhyb3cg\nbmV3IFVzZXJFeGNlcHRpb24oX2xvYy5nZXQoIm5vdC1tYW5hZ2VkIiwKICAg\nICAgICAgICAgICAgICAgICAgICAgRXhjZXB0aW9ucy50b1N0cmluZyhvYmop\nKSkuc2V0RmFpbGVkT2JqZWN0KG9iaik7CiAgICAgICAgICAgICAgICBicmVh\nazsKICAgICAgICAgICAgY2FzZSBPUF9ERVRBQ0g6CiAgICAgICAgICAgICAg\nICBpZiAoc20gPT0gbnVsbCB8fCAhc20uaXNQZXJzaXN0ZW50KCkgfHwgc20u\naXNEZXRhY2hlZCgpKQogICAgICAgICAgICAgICAgICAgIHJldHVybiBBQ1Rf\nTk9ORTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAg\nICByZXR1cm4gQUNUX1JVTiB8IEFDVF9DQVNDQURFOwogICAgfQoKICAgIHB1\nYmxpYyBpbnQgaGFzaENvZGUoKSB7CiAgICAgICAgcmV0dXJuIChfYnJva2Vy\nID09IG51bGwpID8gMCA6IF9icm9rZXIuaGFzaENvZGUoKTsKICAgIH0KCiAg\nICBwdWJsaWMgYm9vbGVhbiBlcXVhbHMoT2JqZWN0IG90aGVyKSB7CiAgICAg\nICAgaWYgKG90aGVyID09IHRoaXMpCiAgICAgICAgICAgIHJldHVybiB0cnVl\nOwogICAgICAgIGlmICgob3RoZXIgPT0gbnVsbCkgfHwgKG90aGVyLmdldENs\nYXNzKCkgIT0gdGhpcy5nZXRDbGFzcygpKSkKICAgICAgICAgICAgcmV0dXJu\nIGZhbHNlOwogICAgICAgIGlmIChfYnJva2VyID09IG51bGwpCiAgICAgICAg\nICAgIHJldHVybiBmYWxzZTsKICAgICAgICByZXR1cm4gX2Jyb2tlci5lcXVh\nbHMoKChFbnRpdHlNYW5hZ2VySW1wbCkgb3RoZXIpLl9icm9rZXIpOwogICAg\nfQoKICAgIHB1YmxpYyB2b2lkIHJlYWRFeHRlcm5hbChPYmplY3RJbnB1dCBp\nbikKICAgICAgICB0aHJvd3MgSU9FeGNlcHRpb24sIENsYXNzTm90Rm91bmRF\neGNlcHRpb24gewogICAgICAgIHRyeSB7CiAgICAgICAgICAgIF9yZXQgPSBQ\nZXJzaXN0ZW5jZUV4Y2VwdGlvbnMuZ2V0Um9sbGJhY2tUcmFuc2xhdG9yKHRo\naXMpOwoKICAgICAgICAgICAgLy8gdGhpcyBhc3N1bWVzIHRoYXQgc2VyaWFs\naXplZCBCcm9rZXJzIGFyZSBmcm9tIHNvbWV0aGluZwogICAgICAgICAgICAv\nLyB0aGF0IGV4dGVuZHMgQWJzdHJhY3RCcm9rZXJGYWN0b3J5LgogICAgICAg\nICAgICBPYmplY3QgZmFjdG9yeUtleSA9IGluLnJlYWRPYmplY3QoKTsKICAg\nICAgICAgICAgQWJzdHJhY3RCcm9rZXJGYWN0b3J5IGZhY3RvcnkgPQogICAg\nICAgICAgICAgICAgQWJzdHJhY3RCcm9rZXJGYWN0b3J5LmdldFBvb2xlZEZh\nY3RvcnlGb3JLZXkoZmFjdG9yeUtleSk7CiAgICAgICAgICAgIGJ5dGVbXSBi\ncm9rZXJCeXRlcyA9IChieXRlW10pIGluLnJlYWRPYmplY3QoKTsKICAgICAg\nICAgICAgT2JqZWN0SW5wdXRTdHJlYW0gaW5uZXJJbiA9IG5ldyBCcm9rZXJC\neXRlc0lucHV0U3RyZWFtKGJyb2tlckJ5dGVzLAogICAgICAgICAgICAgICAg\nZmFjdG9yeS5nZXRDb25maWd1cmF0aW9uKCkpOwoKICAgICAgICAgICAgQnJv\na2VyIGJyb2tlciA9IChCcm9rZXIpIGlubmVySW4ucmVhZE9iamVjdCgpOwog\nICAgICAgICAgICBFbnRpdHlNYW5hZ2VyRmFjdG9yeUltcGwgZW1mID0gKEVu\ndGl0eU1hbmFnZXJGYWN0b3J5SW1wbCkKICAgICAgICAgICAgICAgIEpQQUZh\nY2FkZUhlbHBlci50b0VudGl0eU1hbmFnZXJGYWN0b3J5KAogICAgICAgICAg\nICAgICAgICAgIGJyb2tlci5nZXRCcm9rZXJGYWN0b3J5KCkpOwogICAgICAg\nICAgICBicm9rZXIucHV0VXNlck9iamVjdChKUEFGYWNhZGVIZWxwZXIuRU1f\nS0VZLCB0aGlzKTsKICAgICAgICAgICAgaW5pdGlhbGl6ZShlbWYsIGJyb2tl\ncik7CiAgICAgICAgfSBjYXRjaCAoUnVudGltZUV4Y2VwdGlvbiByZSkgewog\nICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgcmUgPSBfcmV0LnRy\nYW5zbGF0ZShyZSk7CiAgICAgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBl\nKSB7CiAgICAgICAgICAgICAgICAvLyBpZ25vcmUKICAgICAgICAgICAgfQog\nICAgICAgICAgICB0aHJvdyByZTsKICAgICAgICB9CiAgICB9CgogICAgcHVi\nbGljIHZvaWQgd3JpdGVFeHRlcm5hbChPYmplY3RPdXRwdXQgb3V0KSB0aHJv\nd3MgSU9FeGNlcHRpb24gewogICAgICAgIHRyeSB7CiAgICAgICAgICAgIC8v\nIHRoaXMgcmVxdWlyZXMgdGhhdCBvbmx5IEFic3RyYWN0QnJva2VyRmFjdG9y\neS1zb3VyY2VkCiAgICAgICAgICAgIC8vIGJyb2tlcnMgY2FuIGJlIHNlcmlh\nbGl6ZWQKICAgICAgICAgICAgT2JqZWN0IGZhY3RvcnlLZXkgPSAoKEFic3Ry\nYWN0QnJva2VyRmFjdG9yeSkgX2Jyb2tlcgogICAgICAgICAgICAgICAgLmdl\ndEJyb2tlckZhY3RvcnkoKSkuZ2V0UG9vbEtleSgpOwogICAgICAgICAgICBv\ndXQud3JpdGVPYmplY3QoZmFjdG9yeUtleSk7CiAgICAgICAgICAgIEJ5dGVB\ncnJheU91dHB1dFN0cmVhbSBiYW9zID0gbmV3IEJ5dGVBcnJheU91dHB1dFN0\ncmVhbSgpOwogICAgICAgICAgICBPYmplY3RPdXRwdXRTdHJlYW0gaW5uZXJP\ndXQgPSBuZXcgT2JqZWN0T3V0cHV0U3RyZWFtKGJhb3MpOwogICAgICAgICAg\nICBpbm5lck91dC53cml0ZU9iamVjdChfYnJva2VyLmdldERlbGVnYXRlKCkp\nOwogICAgICAgICAgICBpbm5lck91dC5mbHVzaCgpOwogICAgICAgICAgICBv\ndXQud3JpdGVPYmplY3QoYmFvcy50b0J5dGVBcnJheSgpKTsKICAgICAgICB9\nIGNhdGNoIChSdW50aW1lRXhjZXB0aW9uIHJlKSB7CiAgICAgICAgICAgIHRy\neSB7CiAgICAgICAgICAgICAgICByZSA9IF9yZXQudHJhbnNsYXRlKHJlKTsK\nICAgICAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICAg\nICAgICAgIC8vIGlnbm9yZQogICAgICAgICAgICB9CiAgICAgICAgICAgIHRo\ncm93IHJlOwogICAgICAgIH0KICAgIH0KCiAgICBwcml2YXRlIHN0YXRpYyBj\nbGFzcyBCcm9rZXJCeXRlc0lucHV0U3RyZWFtIGV4dGVuZHMgT2JqZWN0SW5w\ndXRTdHJlYW0gewoKICAgICAgICBwcml2YXRlIE9wZW5KUEFDb25maWd1cmF0\naW9uIGNvbmY7CgogICAgICAgIEJyb2tlckJ5dGVzSW5wdXRTdHJlYW0oYnl0\nZVtdIGJ5dGVzLCBPcGVuSlBBQ29uZmlndXJhdGlvbiBjb25mKQogICAgICAg\nICAgICB0aHJvd3MgSU9FeGNlcHRpb24gewogICAgICAgICAgICBzdXBlcihu\nZXcgQnl0ZUFycmF5SW5wdXRTdHJlYW0oYnl0ZXMpKTsKICAgICAgICAgICAg\naWYgKGNvbmYgPT0gbnVsbCkKICAgICAgICAgICAgICAgIHRocm93IG5ldyBJ\nbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24oCiAgICAgICAgICAgICAgICAgICAg\nIklsbGVnYWwgbnVsbCBhcmd1bWVudCB0byBPYmplY3RJbnB1dFN0cmVhbVdp\ndGhMb2FkZXIiKTsKICAgICAgICAgICAgdGhpcy5jb25mID0gY29uZjsKICAg\nICAgICB9CgogICAgICAgIC8qKgogICAgICAgICAqIE1ha2UgYSBwcmltaXRp\ndmUgYXJyYXkgY2xhc3MKICAgICAgICAgKi8KICAgICAgICBwcml2YXRlIENs\nYXNzIHByaW1pdGl2ZVR5cGUoY2hhciB0eXBlKSB7CiAgICAgICAgICAgIHN3\naXRjaCAodHlwZSkgewogICAgICAgICAgICAgICAgY2FzZSAnQic6IHJldHVy\nbiBieXRlLmNsYXNzOwogICAgICAgICAgICAgICAgY2FzZSAnQyc6IHJldHVy\nbiBjaGFyLmNsYXNzOwogICAgICAgICAgICAgICAgY2FzZSAnRCc6IHJldHVy\nbiBkb3VibGUuY2xhc3M7CiAgICAgICAgICAgICAgICBjYXNlICdGJzogcmV0\ndXJuIGZsb2F0LmNsYXNzOwogICAgICAgICAgICAgICAgY2FzZSAnSSc6IHJl\ndHVybiBpbnQuY2xhc3M7CiAgICAgICAgICAgICAgICBjYXNlICdKJzogcmV0\ndXJuIGxvbmcuY2xhc3M7CiAgICAgICAgICAgICAgICBjYXNlICdTJzogcmV0\ndXJuIHNob3J0LmNsYXNzOwogICAgICAgICAgICAgICAgY2FzZSAnWic6IHJl\ndHVybiBib29sZWFuLmNsYXNzOwogICAgICAgICAgICAgICAgZGVmYXVsdDog\ncmV0dXJuIG51bGw7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAg\nIHByb3RlY3RlZCBDbGFzczw/PiByZXNvbHZlQ2xhc3MoT2JqZWN0U3RyZWFt\nQ2xhc3MgY2xhc3NEZXNjKQogICAgICAgICAgICB0aHJvd3MgSU9FeGNlcHRp\nb24sIENsYXNzTm90Rm91bmRFeGNlcHRpb24gewoKICAgICAgICAgICAgU3Ry\naW5nIGNuYW1lID0gY2xhc3NEZXNjLmdldE5hbWUoKTsKICAgICAgICAgICAg\naWYgKGNuYW1lLnN0YXJ0c1dpdGgoIlsiKSkgewogICAgICAgICAgICAgICAg\nLy8gQW4gYXJyYXkKICAgICAgICAgICAgICAgIENsYXNzPD8+IGNvbXBvbmVu\ndDsJCS8vIGNvbXBvbmVudCBjbGFzcwogICAgICAgICAgICAgICAgaW50IGRj\nb3VudDsJCQkgICAgLy8gZGltZW5zaW9uCiAgICAgICAgICAgICAgICBmb3Ig\nKGRjb3VudD0xOyBjbmFtZS5jaGFyQXQoZGNvdW50KT09J1snOyBkY291bnQr\nKykgOwogICAgICAgICAgICAgICAgaWYgKGNuYW1lLmNoYXJBdChkY291bnQp\nID09ICdMJykgewogICAgICAgICAgICAgICAgICAgIGNvbXBvbmVudCA9IGxv\nb2t1cENsYXNzKGNuYW1lLnN1YnN0cmluZyhkY291bnQrMSwKICAgICAgICAg\nICAgICAgICAgICAgICAgY25hbWUubGVuZ3RoKCktMSkpOwogICAgICAgICAg\nICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBpZiAoY25hbWUu\nbGVuZ3RoKCkgIT0gZGNvdW50KzEpIHsKICAgICAgICAgICAgICAgICAgICAg\nICAgdGhyb3cgbmV3IENsYXNzTm90Rm91bmRFeGNlcHRpb24oY25hbWUpOy8v\nIG1hbGZvcm1lZAogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAg\nICAgICAgICBjb21wb25lbnQgPSBwcmltaXRpdmVUeXBlKGNuYW1lLmNoYXJB\ndChkY291bnQpKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAg\nIGludCBkaW1bXSA9IG5ldyBpbnRbZGNvdW50XTsKICAgICAgICAgICAgICAg\nIGZvciAoaW50IGk9MDsgaTxkY291bnQ7IGkrKykgewogICAgICAgICAgICAg\nICAgICAgIGRpbVtpXT0wOwogICAgICAgICAgICAgICAgfQogICAgICAgICAg\nICAgICAgcmV0dXJuIEFycmF5Lm5ld0luc3RhbmNlKGNvbXBvbmVudCwgZGlt\nKS5nZXRDbGFzcygpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAg\nICAgICAgcmV0dXJuIGxvb2t1cENsYXNzKGNuYW1lKTsKICAgICAgICAgICAg\nfQogICAgICAgIH0KCiAgICAgICAgLyoqCiAgICAgICAgICogSWYgdGhpcyBp\ncyBhIGdlbmVyYXRlZCBzdWJjbGFzcywgbG9vayB1cCB0aGUgY29ycmVzcG9u\nZGluZyBDbGFzcwogICAgICAgICAqIG9iamVjdCB2aWEgbWV0YWRhdGEuCiAg\nICAgICAgICovCiAgICAgICAgcHJpdmF0ZSBDbGFzczw/PiBsb29rdXBDbGFz\ncyhTdHJpbmcgY2xhc3NOYW1lKQogICAgICAgICAgICB0aHJvd3MgQ2xhc3NO\nb3RGb3VuZEV4Y2VwdGlvbiB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAg\nICAgICAgICByZXR1cm4gQ2xhc3MuZm9yTmFtZShjbGFzc05hbWUpOwogICAg\nICAgICAgICB9IGNhdGNoIChDbGFzc05vdEZvdW5kRXhjZXB0aW9uIGUpIHsK\nICAgICAgICAgICAgICAgIGlmIChQQ0VuaGFuY2VyLmlzUENTdWJjbGFzc05h\nbWUoY2xhc3NOYW1lKSkgewogICAgICAgICAgICAgICAgICAgIFN0cmluZyBz\ndXBlck5hbWUgPSBQQ0VuaGFuY2VyLnRvTWFuYWdlZFR5cGVOYW1lKGNsYXNz\nTmFtZSk7CiAgICAgICAgICAgICAgICAgICAgQ2xhc3NNZXRhRGF0YVtdIG1l\ndGFzID0gY29uZi5nZXRNZXRhRGF0YVJlcG9zaXRvcnlJbnN0YW5jZSgpCiAg\nICAgICAgICAgICAgICAgICAgICAgIC5nZXRNZXRhRGF0YXMoKTsKICAgICAg\nICAgICAgICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IG1ldGFzLmxlbmd0\naDsgaSsrKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdXBlck5h\nbWUuZXF1YWxzKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgbWV0YXNb\naV0uZ2V0RGVzY3JpYmVkVHlwZSgpLmdldE5hbWUoKSkpIHsKICAgICAgICAg\nICAgICAgICAgICAgICAgICAgIHJldHVybiBQQ1JlZ2lzdHJ5LmdldFBDVHlw\nZSgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXRhc1tpXS5n\nZXREZXNjcmliZWRUeXBlKCkpOwogICAgICAgICAgICAgICAgICAgICAgICB9\nCiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAv\nLyBpZiBpdCdzIG5vdCBmb3VuZCwgdHJ5IHRvIGxvb2sgZm9yIGl0IGFueXdh\neXMKICAgICAgICAgICAgICAgICAgICByZXR1cm4gQ2xhc3MuZm9yTmFtZShj\nbGFzc05hbWUpOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAg\nICAgICAgICAgICB0aHJvdyBlOwogICAgICAgICAgICAgICAgfQogICAgICAg\nICAgICB9CiAgICAgICAgfQogICAgfQoKICAgIHB1YmxpYyB2b2lkIGRldGFj\naChPYmplY3QgZW50aXR5KSB7CiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZv\na2VkKCk7CiAgICAgICAgX2Jyb2tlci5kZXRhY2goZW50aXR5LCB0aGlzKTsK\nICAgIH0KCiAgICAvKioKICAgICAqIENyZWF0ZSBhIHF1ZXJ5IGZyb20gdGhl\nIGdpdmVuIENyaXRyaWFRdWVyeS4KICAgICAqIENvbXBpbGUgdG8gcmVnaXN0\nZXIgdGhlIHBhcmFtZXRlcnMgaW4gdGhpcyBxdWVyeS4KICAgICAqLwogICAg\ncHVibGljIDxUPiBUeXBlZFF1ZXJ5PFQ+IGNyZWF0ZVF1ZXJ5KENyaXRlcmlh\nUXVlcnk8VD4gY3JpdGVyaWFRdWVyeSkgewogICAgICAgICgoT3BlbkpQQUNy\naXRlcmlhUXVlcnk8VD4pY3JpdGVyaWFRdWVyeSkuY29tcGlsZSgpOyAKICAg\nICAgICAKICAgICAgICBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLlF1ZXJ5\nIGtlcm5lbFF1ZXJ5ID1fYnJva2VyLm5ld1F1ZXJ5KENyaXRlcmlhQnVpbGRl\nckltcGwuTEFOR19DUklURVJJQSwgY3JpdGVyaWFRdWVyeSk7CiAgICAgICAg\nCiAgICAgICAgUXVlcnlJbXBsPFQ+IGZhY2FkZVF1ZXJ5ID0gbmV3IFF1ZXJ5\nSW1wbDxUPih0aGlzLCBfcmV0LCBrZXJuZWxRdWVyeSk7CiAgICAgICAgU2V0\nPFBhcmFtZXRlckV4cHJlc3Npb248Pz4+IHBhcmFtcyA9IGNyaXRlcmlhUXVl\ncnkuZ2V0UGFyYW1ldGVycygpOwogICAgICAgIAogICAgICAgIGZvciAoUGFy\nYW1ldGVyRXhwcmVzc2lvbjw/PiBwYXJhbSA6IHBhcmFtcykgewogICAgICAg\nICAgICBmYWNhZGVRdWVyeS5kZWNsYXJlUGFyYW1ldGVyKHBhcmFtLCBwYXJh\nbSk7CiAgICAgICAgfQogICAgICAgIHJldHVybiBmYWNhZGVRdWVyeTsKICAg\nIH0KICAgIAogICAgcHVibGljIE9wZW5KUEFRdWVyeSBjcmVhdGVEeW5hbWlj\nUXVlcnkoCiAgICAgICAgb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNl\nLnF1ZXJ5LlF1ZXJ5RGVmaW5pdGlvbiBxZGVmKSB7CiAgICAgICAgU3RyaW5n\nIGpwcWwgPSBfZW1mLmdldER5bmFtaWNRdWVyeUJ1aWxkZXIoKS50b0pQUUwo\ncWRlZik7CiAgICAgICAgcmV0dXJuIGNyZWF0ZVF1ZXJ5KGpwcWwpOwogICAg\nfQoKICAgIC8qKgogICAgICogR2V0IHRoZSBwcm9wZXJ0aWVzIHVzZWQgY3Vy\ncmVudGx5IGJ5IHRoaXMgZW50aXR5IG1hbmFnZXIuCiAgICAgKiBUaGUgcHJv\ncGVydHkga2V5cyBhbmQgdGhlaXIgdmFsdWVzIGFyZSBoYXJ2ZXN0ZWQgZnJv\nbSBrZXJuZWwgYXJ0aWZhY3RzIG5hbWVseQogICAgICogdGhlIEJyb2tlciBh\nbmQgRmV0Y2hQbGFuIGJ5IHJlZmxlY3Rpb24uCiAgICAgKiBUaGVzZSBwcm9w\nZXJ0eSBrZXlzIGFuZCB2YWx1ZXMgdGhhdCBkZW5vdGUgdGhlIGJlYW4gcHJv\ncGVydGllcy92YWx1ZXMgb2YgdGhlIGtlcm5lbCBhcnRpZmFjdHMKICAgICAq\nIGFyZSBjb252ZXJ0ZWQgdG8gdGhlIG9yaWdpbmFsIGtleXMvdmFsdWVzIHRo\nYXQgdXNlciB1c2VkIHRvIHNldCB0aGUgcHJvcGVydGllcy4KICAgICAqICAg\nIAogICAgICovCiAgICBwdWJsaWMgTWFwPFN0cmluZywgT2JqZWN0PiBnZXRQ\ncm9wZXJ0aWVzKCkgewogICAgICAgIE1hcDxTdHJpbmcsT2JqZWN0PiBwcm9w\ncyA9IF9icm9rZXIuZ2V0UHJvcGVydGllcygpOwogICAgICAgIGZvciAoU3Ry\naW5nIHMgOiBfYnJva2VyLmdldFN1cHBvcnRlZFByb3BlcnRpZXMoKSkgewog\nICAgICAgICAgICBTdHJpbmcga2VybmVsS2V5ID0gZ2V0QmVhblByb3BlcnR5\nTmFtZShzKTsKICAgICAgICAgICAgTWV0aG9kIGdldHRlciA9IFJlZmxlY3Rp\nb24uZmluZEdldHRlcih0aGlzLmdldENsYXNzKCksIGtlcm5lbEtleSwgZmFs\nc2UpOwogICAgICAgICAgICBpZiAoZ2V0dGVyICE9IG51bGwpIHsKICAgICAg\nICAgICAgICAgIFN0cmluZyB1c2VyS2V5ID0gSlBBUHJvcGVydGllcy5nZXRV\nc2VyTmFtZShrZXJuZWxLZXkpOwogICAgICAgICAgICAgICAgT2JqZWN0IGt2\nYWx1ZSAgPSBSZWZsZWN0aW9uLmdldCh0aGlzLCBnZXR0ZXIpOwogICAgICAg\nICAgICAgICAgcHJvcHMucHV0KHVzZXJLZXkuZXF1YWxzKGtlcm5lbEtleSkg\nPyBzIDogdXNlcktleSwgSlBBUHJvcGVydGllcy5jb252ZXJ0VG9Vc2VyVmFs\ndWUodXNlcktleSwga3ZhbHVlKSk7CiAgICAgICAgICAgIH0KICAgICAgICB9\nCiAgICAgICAgRmV0Y2hQbGFuIGZldGNoID0gZ2V0RmV0Y2hQbGFuKCk7CiAg\nICAgICAgQ2xhc3M8Pz4gZmV0Y2hUeXBlID0gZmV0Y2guZ2V0Q2xhc3MoKTsK\nICAgICAgICBTZXQ8U3RyaW5nPiBmUHJvcGVydGllcyA9IFJlZmxlY3Rpb24u\nZ2V0QmVhblN0eWxlUHJvcGVydHlOYW1lcyhmZXRjaFR5cGUpOwogICAgICAg\nIGZvciAoU3RyaW5nIHMgOiBmUHJvcGVydGllcykgewogICAgICAgICAgICBT\ndHJpbmcga2VybmVsS2V5ID0gZ2V0QmVhblByb3BlcnR5TmFtZShzKTsKICAg\nICAgICAgICAgTWV0aG9kIGdldHRlciA9IFJlZmxlY3Rpb24uZmluZEdldHRl\ncihmZXRjaFR5cGUsIGtlcm5lbEtleSwgZmFsc2UpOwogICAgICAgICAgICBp\nZiAoZ2V0dGVyICE9IG51bGwpIHsKICAgICAgICAgICAgICAgIFN0cmluZyB1\nc2VyS2V5ID0gSlBBUHJvcGVydGllcy5nZXRVc2VyTmFtZShrZXJuZWxLZXkp\nOwogICAgICAgICAgICAgICAgT2JqZWN0IGt2YWx1ZSAgPSBSZWZsZWN0aW9u\nLmdldChmZXRjaCwgZ2V0dGVyKTsKICAgICAgICAgICAgICAgIHByb3BzLnB1\ndCh1c2VyS2V5LmVxdWFscyhrZXJuZWxLZXkpID8gcyA6IHVzZXJLZXksIEpQ\nQVByb3BlcnRpZXMuY29udmVydFRvVXNlclZhbHVlKHVzZXJLZXksIGt2YWx1\nZSkpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiBw\ncm9wczsKICAgIH0KCiAgICBwdWJsaWMgT3BlbkpQQUNyaXRlcmlhQnVpbGRl\nciBnZXRDcml0ZXJpYUJ1aWxkZXIoKSB7CiAgICAgICAgcmV0dXJuIF9lbWYu\nZ2V0Q3JpdGVyaWFCdWlsZGVyKCk7CiAgICB9CgogICAgcHVibGljIFNldDxT\ndHJpbmc+IGdldFN1cHBvcnRlZFByb3BlcnRpZXMoKSB7CiAgICAgICAgcmV0\ndXJuIF9icm9rZXIuZ2V0U3VwcG9ydGVkUHJvcGVydGllcygpOwogICAgfQoK\nICAgIC8qKgogICAgICogVW53cmFwcyB0aGlzIHJlY2VpdmVyIHRvIGFuIGlu\nc3RhbmNlIG9mIHRoZSBnaXZlbiBjbGFzcywgaWYgcG9zc2libGUuCiAgICAg\nKiAKICAgICAqIEBleGNlcHRpb24gaWYgdGhlIGdpdmVuIGNsYXNzIGlzIG51\nbGwsIGdlbmVyaWMgPGNvZGU+T2JqZWN0LmNsYXNzPC9jb2RlPiBvciBhIGNs\nYXNzCiAgICAgKiB0aGF0IGlzIG5vdCB3cmFwcGVkIGJ5IHRoaXMgcmVjZWl2\nZXIuICAKICAgICAqLwogICAgcHVibGljIDxUPiBUIHVud3JhcChDbGFzczxU\nPiBjbHMpIHsKICAgICAgICBPYmplY3RbXSBkZWxlZ2F0ZXMgPSBuZXcgT2Jq\nZWN0W117X2Jyb2tlci5nZXRJbm5lcm1vc3REZWxlZ2F0ZSgpLAogICAgICAg\nICAgICBfYnJva2VyLmdldERlbGVnYXRlKCksIF9icm9rZXIsIHRoaXN9Owog\nICAgICAgIGZvciAoT2JqZWN0IG8gOiBkZWxlZ2F0ZXMpIHsKICAgICAgICAg\nICAgaWYgKGNscyAhPSBudWxsICYmIGNscyAhPSBPYmplY3QuY2xhc3MgJiYg\nY2xzLmlzSW5zdGFuY2UobykpCiAgICAgICAgICAgICAgICByZXR1cm4gKFQp\nbzsKICAgICAgICB9CiAgICAgICAgLy8gU2V0IHRoaXMgdHJhbnNhY3Rpb24g\ndG8gcm9sbGJhY2sgb25seSAoYXMgcGVyIHNwZWMpIGhlcmUgYmVjYXVzZSB0\naGUgcmFpc2VkIGV4Y2VwdGlvbiAKICAgICAgICAvLyBkb2VzIG5vdCBnbyB0\naHJvdWdoIG5vcm1hbCBleGNlcHRpb24gdHJhbnNsYXRpb24gcGF0aHdheXMK\nICAgICAgICBSdW50aW1lRXhjZXB0aW9uIGV4ID0gbmV3IElsbGVnYWxBcmd1\nbWVudEV4Y2VwdGlvbihfbG9jLmdldCgidW53cmFwLWVtLWludmFsaWQiLCBj\nbHMpLnRvU3RyaW5nKCkpOwogICAgICAgIHNldFJvbGxiYWNrT25seShleCk7\nCiAgICAgICAgdGhyb3cgZXg7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0\nUXVlcnlTUUxDYWNoZShib29sZWFuIGZsYWcpIHsKICAgICAgICBfYnJva2Vy\nLnNldENhY2hlUHJlcGFyZWRRdWVyeShmbGFnKTsKICAgIH0KICAgIAogICAg\ncHVibGljIGJvb2xlYW4gZ2V0UXVlcnlTUUxDYWNoZSgpIHsKICAgICAgICBy\nZXR1cm4gX2Jyb2tlci5nZXRDYWNoZVByZXBhcmVkUXVlcnkoKTsKICAgIH0K\nICAgIAogICAgUnVudGltZUV4Y2VwdGlvblRyYW5zbGF0b3IgZ2V0RXhjZXB0\naW9uVHJhbnNsYXRvcigpIHsKICAgICAgICByZXR1cm4gX3JldDsKICAgIH0K\nCiAgICAvKioKICAgICAqIFBvcHVsYXRlIHRoZSBnaXZlbiBGZXRjaFBsYW4g\nd2l0aCB0aGUgZ2l2ZW4gcHJvcGVydGllcy4gCiAgICAgKiBPcHRpb25hbGx5\nIG92ZXJyaWRlcyB0aGUgZ2l2ZW4gbG9jayBtb2RlLgogICAgICovCiAgICBw\ncml2YXRlIHZvaWQgY29uZmlndXJlQ3VycmVudEZldGNoUGxhbihGZXRjaFBs\nYW4gZmV0Y2gsIE1hcDxTdHJpbmcsIE9iamVjdD4gcHJvcGVydGllcywgCiAg\nICAgICAgICAgIExvY2tNb2RlVHlwZSBsb2NrLCBib29sZWFuIHJlcXVpcmVz\nVHhuKSB7CiAgICAgICAgLy8gaGFuZGxlIHByb3BlcnRpZXMgaW4gbWFwIGZp\ncnN0CiAgICAgICAgY29uZmlndXJlQ3VycmVudENhY2hlTW9kZXMoZmV0Y2gs\nIHByb3BlcnRpZXMpOwogICAgICAgIGlmIChwcm9wZXJ0aWVzICE9IG51bGwp\nIHsKICAgICAgICAgICAgZm9yIChNYXAuRW50cnk8U3RyaW5nLCBPYmplY3Q+\nIGVudHJ5IDogcHJvcGVydGllcy5lbnRyeVNldCgpKQogICAgICAgICAgICAg\nICAgZmV0Y2guc2V0SGludChlbnRyeS5nZXRLZXkoKSwgZW50cnkuZ2V0VmFs\ndWUoKSk7CiAgICAgICAgfQogICAgICAgIC8vIG92ZXJyaWRlIHdpdGggdGhl\nIHNwZWNpZmljIGxvY2tNb2RlLCBpZiBuZWVkZWQuCiAgICAgICAgaWYgKGxv\nY2sgIT0gbnVsbCAmJiBsb2NrICE9IExvY2tNb2RlVHlwZS5OT05FKSB7CiAg\nICAgICAgICAgIGlmIChyZXF1aXJlc1R4bikgewogICAgICAgICAgICAgICAg\nX2Jyb2tlci5hc3NlcnRBY3RpdmVUcmFuc2FjdGlvbigpOwogICAgICAgICAg\nICB9CiAgICAgICAgICAgIC8vIE92ZXJyaWRlIHJlYWQgbG9jayBsZXZlbAog\nICAgICAgICAgICBMb2NrTW9kZVR5cGUgY3VyUmVhZExvY2tNb2RlID0gZmV0\nY2guZ2V0UmVhZExvY2tNb2RlKCk7CiAgICAgICAgICAgIGlmIChsb2NrICE9\nIGN1clJlYWRMb2NrTW9kZSkKICAgICAgICAgICAgICAgIGZldGNoLnNldFJl\nYWRMb2NrTW9kZShsb2NrKTsKICAgICAgICB9CiAgICB9CiAgICAKICAgIHBy\naXZhdGUgdm9pZCBjb25maWd1cmVDdXJyZW50Q2FjaGVNb2RlcyhGZXRjaFBs\nYW4gZmV0Y2gsIE1hcDxTdHJpbmcsIE9iamVjdD4gcHJvcGVydGllcykgewog\nICAgICAgIGlmIChwcm9wZXJ0aWVzID09IG51bGwpCiAgICAgICAgICAgIHJl\ndHVybjsKICAgICAgICBDYWNoZVJldHJpZXZlTW9kZSByTW9kZSA9IEpQQVBy\nb3BlcnRpZXMuZ2V0RW51bVZhbHVlKENhY2hlUmV0cmlldmVNb2RlLmNsYXNz\nLCAKICAgICAgICAgICAgICAgIEpQQVByb3BlcnRpZXMuQ0FDSEVfUkVUUklF\nVkVfTU9ERSwgcHJvcGVydGllcyk7CiAgICAgICAgaWYgKHJNb2RlICE9IG51\nbGwpIHsKICAgICAgICAgICAgZmV0Y2guc2V0Q2FjaGVSZXRyaWV2ZU1vZGUo\nSlBBUHJvcGVydGllcy5jb252ZXJ0VG9LZW5lbFZhbHVlKERhdGFDYWNoZVJl\ndHJpZXZlTW9kZS5jbGFzcywgCiAgICAgICAgICAgICAgICAgICAgSlBBUHJv\ncGVydGllcy5DQUNIRV9SRVRSSUVWRV9NT0RFLCByTW9kZSkpOwogICAgICAg\nICAgICBwcm9wZXJ0aWVzLnJlbW92ZShKUEFQcm9wZXJ0aWVzLkNBQ0hFX1JF\nVFJJRVZFX01PREUpOwogICAgICAgIH0KICAgICAgICBDYWNoZVN0b3JlTW9k\nZSBzTW9kZSA9IEpQQVByb3BlcnRpZXMuZ2V0RW51bVZhbHVlKENhY2hlU3Rv\ncmVNb2RlLmNsYXNzLCAKICAgICAgICAgICAgICAgIEpQQVByb3BlcnRpZXMu\nQ0FDSEVfU1RPUkVfTU9ERSwgcHJvcGVydGllcyk7CiAgICAgICAgaWYgKHNN\nb2RlICE9IG51bGwpIHsKICAgICAgICAgICAgZmV0Y2guc2V0Q2FjaGVTdG9y\nZU1vZGUoSlBBUHJvcGVydGllcy5jb252ZXJ0VG9LZW5lbFZhbHVlKERhdGFD\nYWNoZVN0b3JlTW9kZS5jbGFzcywgCiAgICAgICAgICAgICAgICAgICAgSlBB\nUHJvcGVydGllcy5DQUNIRV9TVE9SRV9NT0RFLCBzTW9kZSkpOwogICAgICAg\nICAgICBwcm9wZXJ0aWVzLnJlbW92ZShKUEFQcm9wZXJ0aWVzLkNBQ0hFX1NU\nT1JFX01PREUpOwogICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMgTWV0YW1v\nZGVsIGdldE1ldGFtb2RlbCgpIHsKICAgICAgICByZXR1cm4gX2VtZi5nZXRN\nZXRhbW9kZWwoKTsKICAgIH0KCiAgICAvKioKICAgICAqIFNldHMgdGhlIGdp\ndmVuIHByb3BlcnR5IHRvIHRoZSBnaXZlbiB2YWx1ZSwgcmVmbGVjdGl2ZWx5\nLgogICAgICogCiAgICAgKiBUaGUgcHJvcGVydHkga2V5IGlzIHRyYW5zcG9z\nZWQgdG8gYSBiZWFuLXN0eWxlIHByb3BlcnR5LgogICAgICogVGhlIHZhbHVl\nIGlzIGNvbnZlcnRlZCB0byBhIHR5cGUgY29uc3VtYWJsZSBieSB0aGUga2Vy\nbmVsLgogICAgICogQWZ0ZXIgcmVxdWlzaXRlIHRyYW5zZm9ybWF0aW9uLCBp\nZiB0aGUgdmFsdWUgY2FuIG5vdCBiZSBzZXQKICAgICAqIG9uIGVpdGhlciB0\naGlzIGluc3RhbmNlIG9yIGl0cyBmZXRjaCBwbGFuIGJ5IHJlZmxlY3Rpb24s\nCiAgICAgKiB0aGVuIGFuIHdhcm5pbmcgbWVzc2FnZSAobm90IGFuIGV4Y2Vw\ndGlvbiBhcyBwZXIgSlBBIHNwZWNpZmljYXRpb24pIGlzIGlzc3VlZC4KICAg\nICAqLwogICAgcHVibGljIHZvaWQgc2V0UHJvcGVydHkoU3RyaW5nIHByb3As\nIE9iamVjdCB2YWx1ZSkgewogICAgICAgIGlmICghc2V0S2VybmVsUHJvcGVy\ndHkodGhpcywgcHJvcCwgdmFsdWUpKSB7CiAgICAgICAgICAgIGlmICghc2V0\nS2VybmVsUHJvcGVydHkodGhpcy5nZXRGZXRjaFBsYW4oKSwgcHJvcCwgdmFs\ndWUpKSB7CiAgICAgICAgICAgICAgICBMb2cgbG9nID0gZ2V0Q29uZmlndXJh\ndGlvbigpLmdldExvZyhPcGVuSlBBQ29uZmlndXJhdGlvbi5MT0dfUlVOVElN\nRSk7CiAgICAgICAgICAgICAgICBpZiAobG9nLmlzV2FybkVuYWJsZWQoKSkg\newogICAgICAgICAgICAgICAgICAgIGxvZy53YXJuKF9sb2MuZ2V0KCJpZ25v\ncmVkLWVtLXByb3AiLCBwcm9wLCB2YWx1ZSA9PSBudWxsID8gIiIgOiB2YWx1\nZS5nZXRDbGFzcygpKyI6IiArIHZhbHVlKSk7CiAgICAgICAgICAgICAgICAg\nfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQogICAgCiAgICAvKioK\nICAgICAqIEF0dGVtcHQgdG8gc2V0IHRoZSBnaXZlbiBwcm9wZXJ0eSBhbmQg\ndmFsdWUgdG8gdGhlIGdpdmVuIHRhcmdldCBpbnN0YW5jZS4KICAgICAqIFRo\nZSBvcmlnaW5hbCBwcm9wZXJ0eSBpcyB0cmFuc3Bvc2VkIHRvIGEgYmVhbi1z\ndHlsZSBwcm9wZXJ0eSBuYW1lLgogICAgICogVGhlIG9yaWdpbmFsIHZhbHVl\nIGlzIHRyYW5zZm9ybWVkIHRvIGEgdHlwZSBjb25zdW1hYmxlIGJ5IHRoZSB0\nYXJnZXQuCiAgICAgKiAgCiAgICAgKiBAcmV0dXJuIGlmIHRoZSBwcm9wZXJ0\neSBjYW4gYmUgc2V0IHRvIHRoZSBnaXZlbiB0YXJnZXQuCiAgICAgKi8KICAg\nIHByaXZhdGUgYm9vbGVhbiBzZXRLZXJuZWxQcm9wZXJ0eShPYmplY3QgdGFy\nZ2V0LCBTdHJpbmcgb3JpZ2luYWwsIE9iamVjdCB2YWx1ZSkgewogICAgICAg\nIFN0cmluZyBiZWFuUHJvcCA9IGdldEJlYW5Qcm9wZXJ0eU5hbWUob3JpZ2lu\nYWwpOwogICAgICAgIEpQQVByb3BlcnRpZXMucmVjb3JkKGJlYW5Qcm9wLCBv\ncmlnaW5hbCk7CiAgICAgICAgQ2xhc3M8Pz4ga1R5cGUgID0gbnVsbDsKICAg\nICAgICBPYmplY3QgICBrVmFsdWUgPSBudWxsOwogICAgICAgIE1ldGhvZCBz\nZXR0ZXIgPSBSZWZsZWN0aW9uLmZpbmRTZXR0ZXIodGFyZ2V0LmdldENsYXNz\nKCksIGJlYW5Qcm9wLCBmYWxzZSk7CiAgICAgICAgaWYgKHNldHRlciAhPSBu\ndWxsKSB7CiAgICAgICAgICAgIGtUeXBlICA9IHNldHRlci5nZXRQYXJhbWV0\nZXJUeXBlcygpWzBdOwogICAgICAgICAgICBrVmFsdWUgPSBjb252ZXJ0VXNl\nclZhbHVlKG9yaWdpbmFsLCB2YWx1ZSwga1R5cGUpOwogICAgICAgICAgICBS\nZWZsZWN0aW9uLnNldCh0YXJnZXQsIHNldHRlciwga1ZhbHVlKTsKICAgICAg\nICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAg\nICAgRmllbGQgZmllbGQgPSBSZWZsZWN0aW9uLmZpbmRGaWVsZCh0YXJnZXQu\nZ2V0Q2xhc3MoKSwgYmVhblByb3AsIGZhbHNlKTsKICAgICAgICAgICAgaWYg\nKGZpZWxkICE9IG51bGwpIHsKICAgICAgICAgICAgICAgIGtUeXBlICA9IGZp\nZWxkLmdldFR5cGUoKTsKICAgICAgICAgICAgICAgIGtWYWx1ZSA9IGNvbnZl\ncnRVc2VyVmFsdWUob3JpZ2luYWwsIHZhbHVlLCBrVHlwZSk7CiAgICAgICAg\nICAgICAgICBSZWZsZWN0aW9uLnNldCh0YXJnZXQsIGZpZWxkLCBrVmFsdWUp\nOwogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgIH0K\nICAgICAgICB9CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQogICAgCiAg\nICAvKioKICAgICAqIEV4dHJhY3QgYSBiZWFuLXN0eWxlIHByb3BlcnR5IG5h\nbWUgZnJvbSB0aGUgZ2l2ZW4gc3RyaW5nLgogICAgICogSWYgdGhlIGdpdmVu\nIHN0cmluZyBpcyA8Y29kZT4iYS5iLnh5eiI8L2NvZGU+IHRoZW4gcmV0dXJu\ncyA8Y29kZT4ieHl6IjwvY29kZT4gCiAgICAgKi8KICAgIFN0cmluZyBnZXRC\nZWFuUHJvcGVydHlOYW1lKFN0cmluZyB1c2VyKSB7CiAgICAgICAgU3RyaW5n\nIHJlc3VsdCA9IHVzZXI7CiAgICAgICAgaWYgKEpQQVByb3BlcnRpZXMuaXNW\nYWxpZEtleSh1c2VyKSkgewogICAgICAgICAgICByZXN1bHQgPSBKUEFQcm9w\nZXJ0aWVzLmdldEJlYW5Qcm9wZXJ0eSh1c2VyKTsKICAgICAgICB9IGVsc2Ug\newogICAgICAgICAgICBpbnQgZG90ID0gdXNlci5sYXN0SW5kZXhPZignLicp\nOwogICAgICAgICAgICBpZiAoZG90ICE9IC0xKQogICAgICAgICAgICAgICAg\ncmVzdWx0ID0gdXNlci5zdWJzdHJpbmcoZG90KzEpOwogICAgICAgIH0KICAg\nICAgICByZXR1cm4gcmVzdWx0OyAKICAgIH0KICAgIAogICAgCiAgICAvKioK\nICAgICAqIENvbnZlcnQgdGhlIGdpdmVuIHZhbHVlIHRvIGEgdmFsdWUgY29u\nc3VtYWJsZSBieSBPcGVuSlBBIGtlcm5lbCBjb25zdHJ1Y3RzLgogICAgICov\nCiAgICBPYmplY3QgY29udmVydFVzZXJWYWx1ZShTdHJpbmcga2V5LCBPYmpl\nY3QgdmFsdWUsIENsYXNzPD8+IHRhcmdldFR5cGUpIHsKICAgICAgICBpZiAo\nSlBBUHJvcGVydGllcy5pc1ZhbGlkS2V5KGtleSkpIAogICAgICAgICAgICBy\nZXR1cm4gSlBBUHJvcGVydGllcy5jb252ZXJ0VG9LZW5lbFZhbHVlKHRhcmdl\ndFR5cGUsIGtleSwgdmFsdWUpOwogICAgICAgIGlmICh2YWx1ZSBpbnN0YW5j\nZW9mIFN0cmluZykgewogICAgICAgICAgICBpZiAoIm51bGwiLmVxdWFscyh2\nYWx1ZSkpIHsKICAgICAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAg\nICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgcmV0dXJuIFN0cmluZ3Mu\ncGFyc2UoKFN0cmluZykgdmFsdWUsIHRhcmdldFR5cGUpOwogICAgICAgICAg\nICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiB2YWx1ZTsKICAgIH0KfQo=\n","encoding":"base64"}

