{"sha":"0b3d559e03b3844803441602e52409cfe622aa40","node_id":"MDQ6QmxvYjIwNjM2NDowYjNkNTU5ZTAzYjM4NDQ4MDM0NDE2MDJlNTI0MDljZmU2MjJhYTQw","size":15370,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/0b3d559e03b3844803441602e52409cfe622aa40","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNr\nYWdlIG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5qZGJjLnF1ZXJ5\nOwoKaW1wb3J0IGphdmEudXRpbC5MaXN0OwoKaW1wb3J0IGphdmF4LnBlcnNp\nc3RlbmNlLkVudGl0eU1hbmFnZXI7CmltcG9ydCBqYXZheC5wZXJzaXN0ZW5j\nZS5RdWVyeTsKCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5jb25m\nLkpEQkNDb25maWd1cmF0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLmpkYmMuc3FsLkRlcmJ5RGljdGlvbmFyeTsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS5wZXJzaXN0ZW5jZS5PcGVuSlBBRW50aXR5TWFuYWdlckZhY3Rv\ncnlTUEk7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2Uu\namRiYy5xdWVyeS5kb21haW4uQXBwbGljYW50OwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLnBlcnNpc3RlbmNlLmpkYmMucXVlcnkuZG9tYWluLkdhbWU7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuamRiYy5x\ndWVyeS5wcm9jZWR1cmUuRGVyYnlQcm9jZWR1cmVMaXN0OwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNlLmpkYmMucXVlcnkucHJvY2Vk\ndXJlLkFic3RyYWN0UHJvY2VkdXJlTGlzdDsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS5wZXJzaXN0ZW5jZS50ZXN0LkFsbG93RmFpbHVyZTsKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS50ZXN0LlNpbmdsZUVN\nRlRlc3RDYXNlOwoKLyoqCiAqIFRlc3RzIHRoYXQgTmF0aXZlIHF1ZXJpZXMg\ndXNlIG9ubHkgMS1iYXNlZCBwb3NpdGlvbmFsIHBhcmFtZXRlcnMgYW5kIAog\nKiBkaXNhbGxvd3MgbmFtZWQgcGFyYW1ldGVycy4KICogCiAqIE9yaWdpbmFs\nbHkgcmVwb3J0ZWQgaW4gCiAqIDxBIEhSRT0iaHR0cDovL2lzc3Vlcy5hcGFj\naGUub3JnL2ppcmEvYnJvd3NlL09QRU5KUEEtOTE4Pk9QRU5KUEEtOTE4PC9B\nPgogKiAgCiAqLwpwdWJsaWMgY2xhc3MgVGVzdE5hdGl2ZVF1ZXJ5UHJvY2Vk\ndXJlcyBleHRlbmRzIFNpbmdsZUVNRlRlc3RDYXNlIHsKICAgIEFic3RyYWN0\nUHJvY2VkdXJlTGlzdCBwcm9jZWR1cmVMaXN0ID0gbnVsbDsKICAgIAogICAg\nQE92ZXJyaWRlCiAgICBwdWJsaWMgdm9pZCBzZXRVcCgpIHRocm93cyBFeGNl\ncHRpb24gewogICAgICAgIHN1cGVyLnNldFVwKEFwcGxpY2FudC5jbGFzcywg\nR2FtZS5jbGFzcywgQ0xFQVJfVEFCTEVTKTsKCiAgICAgICAgLy8gRmlndXJl\nIG91dCB3aGljaCBEQiB3ZSBoYXZlIGFuZCBnZXQgdGhlIHByb3BlciBEQiBQ\ncm9jZWR1cmUgTGlzdAogICAgICAgIE9wZW5KUEFFbnRpdHlNYW5hZ2VyRmFj\ndG9yeVNQSSBvanBhRW1mID0KICAgICAgICAgICAgKE9wZW5KUEFFbnRpdHlN\nYW5hZ2VyRmFjdG9yeVNQSSkgZW1mOwogICAgICAgIEpEQkNDb25maWd1cmF0\naW9uIGNvbmYgPSAoSkRCQ0NvbmZpZ3VyYXRpb24pIG9qcGFFbWYuZ2V0Q29u\nZmlndXJhdGlvbigpOwogICAgICAgIGlmIChjb25mLmdldERCRGljdGlvbmFy\neUluc3RhbmNlKCkgaW5zdGFuY2VvZiBEZXJieURpY3Rpb25hcnkpIHsKICAg\nICAgICAgICAgcHJvY2VkdXJlTGlzdCA9IG5ldyBEZXJieVByb2NlZHVyZUxp\nc3QoKTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgaWYgKHByb2NlZHVy\nZUxpc3QgIT0gbnVsbCkgewogICAgICAgICAgICBFbnRpdHlNYW5hZ2VyIGVt\nID0gZW1mLmNyZWF0ZUVudGl0eU1hbmFnZXIoKTsKICAgICAgICAgICAgTGlz\ndDxTdHJpbmc+IGNyZWF0ZUxpc3QgPSBwcm9jZWR1cmVMaXN0LmdldENyZWF0\nZVByb2NlZHVyZUxpc3QoKTsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAg\nICAgICAgIGZvciAoU3RyaW5nIGNyZWF0ZVByb2NlZHVyZSA6IGNyZWF0ZUxp\nc3QpIHsKICAgICAgICAgICAgICAgICAgICBlbS5nZXRUcmFuc2FjdGlvbigp\nLmJlZ2luKCk7CiAgICAgICAgICAgICAgICAgICAgUXVlcnkgcXVlcnkgPSBl\nbS5jcmVhdGVOYXRpdmVRdWVyeShjcmVhdGVQcm9jZWR1cmUpOwogICAgICAg\nICAgICAgICAgICAgIHF1ZXJ5LmV4ZWN1dGVVcGRhdGUoKTsKICAgICAgICAg\nICAgICAgICAgICBlbS5nZXRUcmFuc2FjdGlvbigpLmNvbW1pdCgpOwogICAg\nICAgICAgICAgICAgfQogICAgICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24g\nZSkgewogICAgICAgICAgICAgICAgZS5wcmludFN0YWNrVHJhY2UoKTsKICAg\nICAgICAgICAgICAgIGVtLmdldFRyYW5zYWN0aW9uKCkuY29tbWl0KCk7CiAg\nICAgICAgICAgIH0KICAgICAgICAgICAgZW0uY2xlYXIoKTsKICAgICAgICAg\nICAgZW0uY2xvc2UoKTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGljIHZv\naWQgdGVhckRvd24oKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBpZiAo\ncHJvY2VkdXJlTGlzdCAhPSBudWxsKSB7CiAgICAgICAgICAgIEVudGl0eU1h\nbmFnZXIgZW0gPSBlbWYuY3JlYXRlRW50aXR5TWFuYWdlcigpOwogICAgICAg\nICAgICBMaXN0PFN0cmluZz4gZHJvcExpc3QgPSBwcm9jZWR1cmVMaXN0Lmdl\ndERyb3BQcm9jZWR1cmVMaXN0KCk7CiAgICAgICAgICAgIHRyeSB7CiAgICAg\nICAgICAgICAgICBmb3IgKFN0cmluZyBkcm9wUHJvY2VkdXJlIDogZHJvcExp\nc3QpIHsKICAgICAgICAgICAgICAgICAgICBlbS5nZXRUcmFuc2FjdGlvbigp\nLmJlZ2luKCk7CiAgICAgICAgICAgICAgICAgICAgUXVlcnkgcXVlcnkgPSBl\nbS5jcmVhdGVOYXRpdmVRdWVyeShkcm9wUHJvY2VkdXJlKTsKICAgICAgICAg\nICAgICAgICAgICBxdWVyeS5leGVjdXRlVXBkYXRlKCk7CiAgICAgICAgICAg\nICAgICAgICAgZW0uZ2V0VHJhbnNhY3Rpb24oKS5jb21taXQoKTsKICAgICAg\nICAgICAgICAgIH0KICAgICAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUp\nIHsKICAgICAgICAgICAgICAgIGUucHJpbnRTdGFja1RyYWNlKCk7CiAgICAg\nICAgICAgICAgICBlbS5nZXRUcmFuc2FjdGlvbigpLmNvbW1pdCgpOwogICAg\nICAgICAgICB9CiAgICAgICAgICAgIGVtLmNsZWFyKCk7CiAgICAgICAgICAg\nIGVtLmNsb3NlKCk7CiAgICAgICAgfQogICAgICAgIHN1cGVyLnRlYXJEb3du\nKCk7CiAgICB9CgogICAgcHVibGljIHZvaWQgdGVzdE5vUmV0dXJuTm9QYXJh\nbVByb2NlZHVyZSgpIHsKICAgICAgICBpZiAocHJvY2VkdXJlTGlzdCAhPSBu\ndWxsKSB7CiAgICAgICAgICAgIEVudGl0eU1hbmFnZXIgZW0gPSBlbWYuY3Jl\nYXRlRW50aXR5TWFuYWdlcigpOwoKICAgICAgICAgICAgQXBwbGljYW50IGFw\ncGxpY2FudDEgPSBuZXcgQXBwbGljYW50KCk7CiAgICAgICAgICAgIGFwcGxp\nY2FudDEuc2V0TmFtZSgiQ2hhcmxpZSIpOwogICAgICAgICAgICBBcHBsaWNh\nbnQgYXBwbGljYW50MiA9IG5ldyBBcHBsaWNhbnQoKTsKICAgICAgICAgICAg\nYXBwbGljYW50Mi5zZXROYW1lKCJTbm9vcHkiKTsKCiAgICAgICAgICAgIGVt\nLmdldFRyYW5zYWN0aW9uKCkuYmVnaW4oKTsKICAgICAgICAgICAgZW0ucGVy\nc2lzdChhcHBsaWNhbnQxKTsKICAgICAgICAgICAgZW0ucGVyc2lzdChhcHBs\naWNhbnQyKTsKICAgICAgICAgICAgZW0uZ2V0VHJhbnNhY3Rpb24oKS5jb21t\naXQoKTsKCiAgICAgICAgICAgIFN0cmluZyBzcWwgPSBwcm9jZWR1cmVMaXN0\nLmNhbGxBZGRYVG9DaGFybGllKCk7CgogICAgICAgICAgICAvLyBxdWVyeS5n\nZXRTaW5nbGVSZXN1bHQoKSBhbmQgcXVlcnkuZ2V0UmVzdWx0TGlzdCgpIGJv\ndGggdGhyb3cgYW4KICAgICAgICAgICAgLy8gZXhjZXB0aW9uOgogICAgICAg\nICAgICAvLyBTdGF0ZW1lbnQuZXhlY3V0ZVF1ZXJ5KCkgY2Fubm90IGJlIGNh\nbGxlZCB3aXRoIGEgc3RhdGVtZW50IHRoYXQKICAgICAgICAgICAgLy8gcmV0\ndXJucyBhIHJvdyBjb3VudAogICAgICAgICAgICB0cnkgewogICAgICAgICAg\nICAgICAgZW0uZ2V0VHJhbnNhY3Rpb24oKS5iZWdpbigpOwogICAgICAgICAg\nICAgICAgUXVlcnkgcXVlcnkgPSBlbS5jcmVhdGVOYXRpdmVRdWVyeShzcWwp\nOwogICAgICAgICAgICAgICAgcXVlcnkuZ2V0U2luZ2xlUmVzdWx0KCk7CiAg\nICAgICAgICAgICAgICBlbS5nZXRUcmFuc2FjdGlvbigpLmNvbW1pdCgpOwog\nICAgICAgICAgICAgICAgZmFpbCgiRXhwZWN0ZWQgZXhjZXB0aW9uLiBnZXRT\naW5nbGVSZXN1bHQoKSB3aXRoIG5vIHJldHVybnMgIiArCiAgICAgICAgICAg\nICAgICAJCSJzaG91bGQgZmFpbC4iKTsKICAgICAgICAgICAgfSBjYXRjaCAo\nRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgICAgIC8vRXhwZWN0ZWQgZXhj\nZXB0aW9uCiAgICAgICAgICAgICAgICBlbS5nZXRUcmFuc2FjdGlvbigpLnJv\nbGxiYWNrKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgdHJ5IHsKICAg\nICAgICAgICAgICAgIGVtLmdldFRyYW5zYWN0aW9uKCkuYmVnaW4oKTsKICAg\nICAgICAgICAgICAgIFF1ZXJ5IHF1ZXJ5ID0gZW0uY3JlYXRlTmF0aXZlUXVl\ncnkoc3FsKTsKICAgICAgICAgICAgICAgIHF1ZXJ5LmdldFJlc3VsdExpc3Qo\nKTsKICAgICAgICAgICAgICAgIGVtLmdldFRyYW5zYWN0aW9uKCkuY29tbWl0\nKCk7CiAgICAgICAgICAgICAgICBmYWlsKCJFeHBlY3RlZCBleGNlcHRpb24u\nIGdldFJlc3VsdExpc3QoKSB3aXRoIG5vIHJldHVybnMgIiArCiAgICAgICAg\nICAgICAgICAJCSJzaG91bGQgZmFpbC4iKTsKICAgICAgICAgICAgfSBjYXRj\naCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgICAgIC8vRXhwZWN0ZWQg\nZXhjZXB0aW9uCiAgICAgICAgICAgICAgICBlbS5nZXRUcmFuc2FjdGlvbigp\nLnJvbGxiYWNrKCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIFRo\naXMgb25lIHNob3VsZCB3b3JrIHByb3Blcmx5CiAgICAgICAgICAgIHRyeSB7\nCiAgICAgICAgICAgICAgICBlbS5nZXRUcmFuc2FjdGlvbigpLmJlZ2luKCk7\nCiAgICAgICAgICAgICAgICBRdWVyeSBxdWVyeSA9IGVtLmNyZWF0ZU5hdGl2\nZVF1ZXJ5KHNxbCk7CiAgICAgICAgICAgICAgICBxdWVyeS5leGVjdXRlVXBk\nYXRlKCk7CiAgICAgICAgICAgICAgICBlbS5nZXRUcmFuc2FjdGlvbigpLmNv\nbW1pdCgpOwogICAgICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkgewog\nICAgICAgICAgICAgICAgZW0uZ2V0VHJhbnNhY3Rpb24oKS5yb2xsYmFjaygp\nOwogICAgICAgICAgICAgICAgZmFpbCgiQ2F1Z2h0IHVuZXhwZWN0ZWQgZXhj\nZXB0aW9uIGV4ZWN1dGluZyBzdG9yZWQgcHJvY2VkdXJlOiAiCiAgICAgICAg\nICAgICAgICAgICAgKyBlLmdldE1lc3NhZ2UoKSk7CiAgICAgICAgICAgIH0K\nCiAgICAgICAgICAgIC8vIHJlZnJlc2ggdGhlIGRhdGEKICAgICAgICAgICAg\nZW0uY2xlYXIoKTsKICAgICAgICAgICAgZW0uY2xvc2UoKTsKICAgICAgICAg\nICAgZW0gPSBlbWYuY3JlYXRlRW50aXR5TWFuYWdlcigpOwogICAgICAgICAg\nICBhcHBsaWNhbnQxID0gZW0uZmluZChBcHBsaWNhbnQuY2xhc3MsIGFwcGxp\nY2FudDEuZ2V0SWQoKSk7CiAgICAgICAgICAgIGFwcGxpY2FudDIgPSBlbS5m\naW5kKEFwcGxpY2FudC5jbGFzcywgYXBwbGljYW50Mi5nZXRJZCgpKTsKCiAg\nICAgICAgICAgIC8vIHZlcmlmeSBvbmUgY2hhbmdlZCBhbmQgb25lIGRpZG4n\ndAogICAgICAgICAgICBhc3NlcnRFcXVhbHMoIkNoYXJsaWV4IiwgYXBwbGlj\nYW50MS5nZXROYW1lKCkpOwogICAgICAgICAgICBhc3NlcnRFcXVhbHMoIlNu\nb29weSIsIGFwcGxpY2FudDIuZ2V0TmFtZSgpKTsKICAgICAgICAKICAgICAg\nICAgICAgZW0uY2xlYXIoKTsKICAgICAgICAgICAgZW0uY2xvc2UoKTsKICAg\nICAgICB9CiAgICB9CgogICAgQEFsbG93RmFpbHVyZSh2YWx1ZT10cnVlLCBt\nZXNzYWdlPSJXYWl0aW5nIGZvciByZXNvbHV0aW9uIGZvciBKSVJBIERFUkJZ\nLTQ1NTgiKQogICAgcHVibGljIHZvaWQgdGVzdE5vUmV0dXJuTXVsdGlQYXJh\nbVByb2NlZHVyZSgpIHsKICAgICAgICBpZiAocHJvY2VkdXJlTGlzdCAhPSBu\ndWxsKSB7CiAgICAgICAgICAgIEVudGl0eU1hbmFnZXIgZW0gPSBlbWYuY3Jl\nYXRlRW50aXR5TWFuYWdlcigpOwoKICAgICAgICAgICAgQXBwbGljYW50IGFw\ncGxpY2FudDEgPSBuZXcgQXBwbGljYW50KCk7CiAgICAgICAgICAgIGFwcGxp\nY2FudDEuc2V0TmFtZSgiQ2hhcmxpZSIpOwogICAgICAgICAgICBBcHBsaWNh\nbnQgYXBwbGljYW50MiA9IG5ldyBBcHBsaWNhbnQoKTsKICAgICAgICAgICAg\nYXBwbGljYW50Mi5zZXROYW1lKCJTbm9vcHkiKTsKCiAgICAgICAgICAgIGVt\nLmdldFRyYW5zYWN0aW9uKCkuYmVnaW4oKTsKICAgICAgICAgICAgZW0ucGVy\nc2lzdChhcHBsaWNhbnQxKTsKICAgICAgICAgICAgZW0ucGVyc2lzdChhcHBs\naWNhbnQyKTsKICAgICAgICAgICAgZW0uZ2V0VHJhbnNhY3Rpb24oKS5jb21t\naXQoKTsKCiAgICAgICAgICAgIFN0cmluZyBzcWwgPSBwcm9jZWR1cmVMaXN0\nLmNhbGxBZGRTdWZmaXhUb05hbWUoKTsKCiAgICAgICAgICAgIC8vIHF1ZXJ5\nLmdldFNpbmdsZVJlc3VsdCgpIGFuZCBxdWVyeS5nZXRSZXN1bHRMaXN0KCkg\nYm90aCB0aHJvdyBhbgogICAgICAgICAgICAvLyBleGNlcHRpb246CiAgICAg\nICAgICAgIC8vIFN0YXRlbWVudC5leGVjdXRlUXVlcnkoKSBjYW5ub3QgYmUg\nY2FsbGVkIHdpdGggYSBzdGF0ZW1lbnQgdGhhdAogICAgICAgICAgICAvLyBy\nZXR1cm5zIGEgcm93IGNvdW50CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAg\nICAgICAgICBlbS5nZXRUcmFuc2FjdGlvbigpLmJlZ2luKCk7CiAgICAgICAg\nICAgICAgICBRdWVyeSBxdWVyeSA9IGVtLmNyZWF0ZU5hdGl2ZVF1ZXJ5KHNx\nbCk7CiAgICAgICAgICAgICAgICBxdWVyeS5zZXRQYXJhbWV0ZXIoMSwgIkNo\nYXJsaWUiKTsKICAgICAgICAgICAgICAgIHF1ZXJ5LnNldFBhcmFtZXRlcigy\nLCAieCIpOwogICAgICAgICAgICAgICAgcXVlcnkuZ2V0U2luZ2xlUmVzdWx0\nKCk7CiAgICAgICAgICAgICAgICBlbS5nZXRUcmFuc2FjdGlvbigpLmNvbW1p\ndCgpOwogICAgICAgICAgICAgICAgZmFpbCgiRXhwZWN0ZWQgZXhjZXB0aW9u\nLiBnZXRTaW5nbGVSZXN1bHQoKSB3aXRoIG5vIHJldHVybnMgIiArCiAgICAg\nICAgICAgICAgICAJCSJzaG91bGQgZmFpbC4iKTsKICAgICAgICAgICAgfSBj\nYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgICAgIC8vRXhwZWN0\nZWQgZXhjZXB0aW9uCiAgICAgICAgICAgICAgICBlbS5nZXRUcmFuc2FjdGlv\nbigpLnJvbGxiYWNrKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgdHJ5\nIHsKICAgICAgICAgICAgICAgIGVtLmdldFRyYW5zYWN0aW9uKCkuYmVnaW4o\nKTsKICAgICAgICAgICAgICAgIFF1ZXJ5IHF1ZXJ5ID0gZW0uY3JlYXRlTmF0\naXZlUXVlcnkoc3FsKTsKICAgICAgICAgICAgICAgIHF1ZXJ5LnNldFBhcmFt\nZXRlcigxLCAiQ2hhcmxpZSIpOwogICAgICAgICAgICAgICAgcXVlcnkuc2V0\nUGFyYW1ldGVyKDIsICJ4Iik7CiAgICAgICAgICAgICAgICBxdWVyeS5nZXRS\nZXN1bHRMaXN0KCk7CiAgICAgICAgICAgICAgICBlbS5nZXRUcmFuc2FjdGlv\nbigpLmNvbW1pdCgpOwogICAgICAgICAgICAgICAgZmFpbCgiRXhwZWN0ZWQg\nZXhjZXB0aW9uLiBnZXRSZXN1bHRMaXN0KCkgd2l0aCBubyByZXR1cm5zICIg\nKwogICAgICAgICAgICAgICAgCQkic2hvdWxkIGZhaWwuIik7CiAgICAgICAg\nICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgICAgICAv\nL0V4cGVjdGVkIGV4Y2VwdGlvbgogICAgICAgICAgICAgICAgZW0uZ2V0VHJh\nbnNhY3Rpb24oKS5yb2xsYmFjaygpOwogICAgICAgICAgICB9CgogICAgICAg\nICAgICAvLyBUaGlzIG9uZSBzaG91bGQgd29yayBwcm9wZXJseQogICAgICAg\nICAgICB0cnkgewogICAgICAgICAgICAgICAgZW0uZ2V0VHJhbnNhY3Rpb24o\nKS5iZWdpbigpOwogICAgICAgICAgICAgICAgUXVlcnkgcXVlcnkgPSBlbS5j\ncmVhdGVOYXRpdmVRdWVyeShzcWwpOwogICAgICAgICAgICAgICAgcXVlcnku\nc2V0UGFyYW1ldGVyKDEsICJDaGFybGllIik7CiAgICAgICAgICAgICAgICBx\ndWVyeS5zZXRQYXJhbWV0ZXIoMiwgIngiKTsKICAgICAgICAgICAgICAgIHF1\nZXJ5LmV4ZWN1dGVVcGRhdGUoKTsKICAgICAgICAgICAgICAgIGVtLmdldFRy\nYW5zYWN0aW9uKCkuY29tbWl0KCk7CiAgICAgICAgICAgIH0gY2F0Y2ggKEV4\nY2VwdGlvbiBlKSB7CiAgICAgICAgICAgICAgICBlbS5nZXRUcmFuc2FjdGlv\nbigpLnJvbGxiYWNrKCk7CiAgICAgICAgICAgICAgICBmYWlsKCJDYXVnaHQg\ndW5leHBlY3RlZCBleGNlcHRpb24gZXhlY3V0aW5nIHN0b3JlZCBwcm9jZWR1\ncmU6ICIKICAgICAgICAgICAgICAgICAgICArIGUuZ2V0TWVzc2FnZSgpKTsK\nICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gcmVmcmVzaCB0aGUgZGF0\nYQogICAgICAgICAgICBlbS5jbGVhcigpOwogICAgICAgICAgICBlbS5jbG9z\nZSgpOwogICAgICAgICAgICBlbSA9IGVtZi5jcmVhdGVFbnRpdHlNYW5hZ2Vy\nKCk7CiAgICAgICAgICAgIGFwcGxpY2FudDEgPSBlbS5maW5kKEFwcGxpY2Fu\ndC5jbGFzcywgYXBwbGljYW50MS5nZXRJZCgpKTsKICAgICAgICAgICAgYXBw\nbGljYW50MiA9IGVtLmZpbmQoQXBwbGljYW50LmNsYXNzLCBhcHBsaWNhbnQy\nLmdldElkKCkpOwoKICAgICAgICAgICAgLy8gdmVyaWZ5IG9uZSBjaGFuZ2Vk\nIGFuZCBvbmUgZGlkbid0CiAgICAgICAgICAgIGFzc2VydEVxdWFscygiQ2hh\ncmxpZXgiLCBhcHBsaWNhbnQxLmdldE5hbWUoKSk7CiAgICAgICAgICAgIGFz\nc2VydEVxdWFscygiU25vb3B5IiwgYXBwbGljYW50Mi5nZXROYW1lKCkpOwog\nICAgICAgIAogICAgICAgICAgICBlbS5jbGVhcigpOwogICAgICAgICAgICBl\nbS5jbG9zZSgpOwogICAgICAgIH0KICAgIH0KCiAgICAKICAgIHB1YmxpYyB2\nb2lkIHRlc3RPbmVSZXR1cm5Ob1BhcmFtUHJvY2VkdXJlKCkgewogICAgICAg\nIGlmIChwcm9jZWR1cmVMaXN0ICE9IG51bGwpIHsKICAgICAgICAgICAgRW50\naXR5TWFuYWdlciBlbSA9IGVtZi5jcmVhdGVFbnRpdHlNYW5hZ2VyKCk7Cgog\nICAgICAgICAgICBBcHBsaWNhbnQgYXBwbGljYW50MSA9IG5ldyBBcHBsaWNh\nbnQoKTsKICAgICAgICAgICAgYXBwbGljYW50MS5zZXROYW1lKCJDaGFybGll\nIik7CiAgICAgICAgICAgIEFwcGxpY2FudCBhcHBsaWNhbnQyID0gbmV3IEFw\ncGxpY2FudCgpOwogICAgICAgICAgICBhcHBsaWNhbnQyLnNldE5hbWUoIlNu\nb29weSIpOwoKICAgICAgICAgICAgZW0uZ2V0VHJhbnNhY3Rpb24oKS5iZWdp\nbigpOwogICAgICAgICAgICBlbS5wZXJzaXN0KGFwcGxpY2FudDEpOwogICAg\nICAgICAgICBlbS5nZXRUcmFuc2FjdGlvbigpLmNvbW1pdCgpOwoKICAgICAg\nICAgICAgU3RyaW5nIHNxbCA9IHByb2NlZHVyZUxpc3QuY2FsbEdldEFsbEFw\ncGxpY2FudHMoKTsKCiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAg\nICBlbS5nZXRUcmFuc2FjdGlvbigpLmJlZ2luKCk7CiAgICAgICAgICAgICAg\nICBRdWVyeSBxdWVyeSA9IGVtLmNyZWF0ZU5hdGl2ZVF1ZXJ5KHNxbCwgQXBw\nbGljYW50LmNsYXNzKTsKICAgICAgICAgICAgICAgIEFwcGxpY2FudCBhcHAg\nPSAoQXBwbGljYW50KXF1ZXJ5LmdldFNpbmdsZVJlc3VsdCgpOwogICAgICAg\nICAgICAgICAgZW0uZ2V0VHJhbnNhY3Rpb24oKS5jb21taXQoKTsKICAgICAg\nICAgICAgICAgIGFzc2VydEVxdWFscygiQ2hhcmxpZSIsIGFwcC5nZXROYW1l\nKCkpOwogICAgICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkgewogICAg\nICAgICAgICAgICAgZW0uZ2V0VHJhbnNhY3Rpb24oKS5yb2xsYmFjaygpOwog\nICAgICAgICAgICAgICAgZmFpbCgiQ2F1Z2h0IHVuZXhwZWN0ZWQgZXhjZXB0\naW9uIGV4ZWN1dGluZyBzdG9yZWQgcHJvY2VkdXJlOiAiCiAgICAgICAgICAg\nICAgICAgICAgKyBlLmdldE1lc3NhZ2UoKSk7CiAgICAgICAgICAgIH0KCiAg\nICAgICAgICAgIGVtLmdldFRyYW5zYWN0aW9uKCkuYmVnaW4oKTsKICAgICAg\nICAgICAgZW0ucGVyc2lzdChhcHBsaWNhbnQyKTsKICAgICAgICAgICAgZW0u\nZ2V0VHJhbnNhY3Rpb24oKS5jb21taXQoKTsKICAgICAgICAgICAgCiAgICAg\nICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBlbS5nZXRUcmFuc2FjdGlv\nbigpLmJlZ2luKCk7CiAgICAgICAgICAgICAgICBRdWVyeSBxdWVyeSA9IGVt\nLmNyZWF0ZU5hdGl2ZVF1ZXJ5KHNxbCwgQXBwbGljYW50LmNsYXNzKTsKICAg\nICAgICAgICAgICAgIExpc3Q8QXBwbGljYW50PiBhcHBMaXN0ID0gcXVlcnku\nZ2V0UmVzdWx0TGlzdCgpOwogICAgICAgICAgICAgICAgZW0uZ2V0VHJhbnNh\nY3Rpb24oKS5jb21taXQoKTsKICAgICAgICAgICAgICAgIGFzc2VydEVxdWFs\ncygyLCBhcHBMaXN0LnNpemUoKSk7CiAgICAgICAgICAgICAgICBmb3IgKEFw\ncGxpY2FudCBhIDogYXBwTGlzdCkgewogICAgICAgICAgICAgICAgICAgIGlm\nICghYS5nZXROYW1lKCkuZXF1YWxzKCJDaGFybGllIikKICAgICAgICAgICAg\nICAgICAgICAgICAgJiYgIWEuZ2V0TmFtZSgpLmVxdWFscygiU25vb3B5Iikp\nCiAgICAgICAgICAgICAgICAgICAgICAgIGZhaWwoImZvdW5kIGludmFsaWQg\nYXBwbGljYW50ICIgKyBhLmdldE5hbWUoKSk7CiAgICAgICAgICAgICAgICB9\nCiAgICAgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAg\nICAgICAgICBlbS5nZXRUcmFuc2FjdGlvbigpLnJvbGxiYWNrKCk7CiAgICAg\nICAgICAgICAgICBmYWlsKCJDYXVnaHQgdW5leHBlY3RlZCBleGNlcHRpb24g\nZXhlY3V0aW5nIHN0b3JlZCBwcm9jZWR1cmU6ICIKICAgICAgICAgICAgICAg\nICAgICArIGUuZ2V0TWVzc2FnZSgpKTsKICAgICAgICAgICAgfQoKICAgICAg\nICAgICAgLy8gVGhpcyBvbmUgc2hvdWxkIGZhaWwgc2luY2Ugd2UgYXJlIGRv\naW5nIHNlbGVjdCBpbiBzdGVhZCBvZiB1cGRhdGUKICAgICAgICAgICAgdHJ5\nIHsKICAgICAgICAgICAgICAgIGVtLmdldFRyYW5zYWN0aW9uKCkuYmVnaW4o\nKTsKICAgICAgICAgICAgICAgIFF1ZXJ5IHF1ZXJ5ID0gZW0uY3JlYXRlTmF0\naXZlUXVlcnkoc3FsLCBBcHBsaWNhbnQuY2xhc3MpOwogICAgICAgICAgICAg\nICAgcXVlcnkuZXhlY3V0ZVVwZGF0ZSgpOwogICAgICAgICAgICAgICAgZW0u\nZ2V0VHJhbnNhY3Rpb24oKS5jb21taXQoKTsKICAgICAgICAgICAgICAgIGZh\naWwoIkV4cGVjdGVkIGV4Y2VwdGlvbi4gZXhlY3V0ZVVwZGF0ZSgpIHdpdGgg\ncXVlcnkgcHJvY2VkdXJlICIKICAgICAgICAgICAgICAgICAgICArICJzaG91\nbGQgZmFpbC4iKTsKICAgICAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUp\nIHsKICAgICAgICAgICAgICAgIC8vIEV4cGVjdGVkIGV4Y2VwdGlvbgogICAg\nICAgICAgICAgICAgZW0uZ2V0VHJhbnNhY3Rpb24oKS5yb2xsYmFjaygpOwog\nICAgICAgICAgICB9CgogICAgICAgICAgICAvLyByZWZyZXNoIHRoZSBkYXRh\nCiAgICAgICAgICAgIGVtLmNsZWFyKCk7CiAgICAgICAgICAgIGVtLmNsb3Nl\nKCk7CiAgICAgICAgICAgIGVtID0gZW1mLmNyZWF0ZUVudGl0eU1hbmFnZXIo\nKTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGljIHZvaWQgdGVzdE9uZVJl\ndHVybk11bHRpUGFyYW1Qcm9jZWR1cmUoKSB7CiAgICAgICAgaWYgKHByb2Nl\nZHVyZUxpc3QgIT0gbnVsbCkgewogICAgICAgICAgICBFbnRpdHlNYW5hZ2Vy\nIGVtID0gZW1mLmNyZWF0ZUVudGl0eU1hbmFnZXIoKTsKCiAgICAgICAgICAg\nIEFwcGxpY2FudCBhcHBsaWNhbnQxID0gbmV3IEFwcGxpY2FudCgpOwogICAg\nICAgICAgICBhcHBsaWNhbnQxLnNldE5hbWUoIkNoYXJsaWUiKTsKICAgICAg\nICAgICAgQXBwbGljYW50IGFwcGxpY2FudDIgPSBuZXcgQXBwbGljYW50KCk7\nCiAgICAgICAgICAgIGFwcGxpY2FudDIuc2V0TmFtZSgiU25vb3B5Iik7CiAg\nICAgICAgICAgIEFwcGxpY2FudCBhcHBsaWNhbnQzID0gbmV3IEFwcGxpY2Fu\ndCgpOwogICAgICAgICAgICBhcHBsaWNhbnQzLnNldE5hbWUoIkxpbnVzIik7\nCiAgICAgICAgICAgIEFwcGxpY2FudCBhcHBsaWNhbnQ0ID0gbmV3IEFwcGxp\nY2FudCgpOwogICAgICAgICAgICBhcHBsaWNhbnQ0LnNldE5hbWUoIkx1Y3ki\nKTsKCiAgICAgICAgICAgIGVtLmdldFRyYW5zYWN0aW9uKCkuYmVnaW4oKTsK\nICAgICAgICAgICAgZW0ucGVyc2lzdChhcHBsaWNhbnQxKTsKICAgICAgICAg\nICAgZW0ucGVyc2lzdChhcHBsaWNhbnQzKTsKICAgICAgICAgICAgZW0ucGVy\nc2lzdChhcHBsaWNhbnQ0KTsKICAgICAgICAgICAgZW0uZ2V0VHJhbnNhY3Rp\nb24oKS5jb21taXQoKTsKCiAgICAgICAgICAgIFN0cmluZyBzcWwgPSBwcm9j\nZWR1cmVMaXN0LmNhbGxHZXRUd29BcHBsaWNhbnRzKCk7CgogICAgICAgICAg\nICB0cnkgewogICAgICAgICAgICAgICAgZW0uZ2V0VHJhbnNhY3Rpb24oKS5i\nZWdpbigpOwogICAgICAgICAgICAgICAgUXVlcnkgcXVlcnkgPSBlbS5jcmVh\ndGVOYXRpdmVRdWVyeShzcWwsIEFwcGxpY2FudC5jbGFzcyk7CiAgICAgICAg\nICAgICAgICBxdWVyeS5zZXRQYXJhbWV0ZXIoMSwgIkNoYXJsaWUiKTsKICAg\nICAgICAgICAgICAgIHF1ZXJ5LnNldFBhcmFtZXRlcigyLCAiU25vb3B5Iik7\nCiAgICAgICAgICAgICAgICBBcHBsaWNhbnQgYXBwID0gKEFwcGxpY2FudClx\ndWVyeS5nZXRTaW5nbGVSZXN1bHQoKTsKICAgICAgICAgICAgICAgIGVtLmdl\ndFRyYW5zYWN0aW9uKCkuY29tbWl0KCk7CiAgICAgICAgICAgICAgICBhc3Nl\ncnRFcXVhbHMoIkNoYXJsaWUiLCBhcHAuZ2V0TmFtZSgpKTsKICAgICAgICAg\nICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgICAgIGVt\nLmdldFRyYW5zYWN0aW9uKCkucm9sbGJhY2soKTsKICAgICAgICAgICAgICAg\nIGZhaWwoIkNhdWdodCB1bmV4cGVjdGVkIGV4Y2VwdGlvbiBleGVjdXRpbmcg\nc3RvcmVkIHByb2NlZHVyZTogIgogICAgICAgICAgICAgICAgICAgICsgZS5n\nZXRNZXNzYWdlKCkpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBlbS5n\nZXRUcmFuc2FjdGlvbigpLmJlZ2luKCk7CiAgICAgICAgICAgIGVtLnBlcnNp\nc3QoYXBwbGljYW50Mik7CiAgICAgICAgICAgIGVtLmdldFRyYW5zYWN0aW9u\nKCkuY29tbWl0KCk7CiAgICAgICAgICAgIAogICAgICAgICAgICB0cnkgewog\nICAgICAgICAgICAgICAgZW0uZ2V0VHJhbnNhY3Rpb24oKS5iZWdpbigpOwog\nICAgICAgICAgICAgICAgUXVlcnkgcXVlcnkgPSBlbS5jcmVhdGVOYXRpdmVR\ndWVyeShzcWwsIEFwcGxpY2FudC5jbGFzcyk7CiAgICAgICAgICAgICAgICBx\ndWVyeS5zZXRQYXJhbWV0ZXIoMSwgIkNoYXJsaWUiKTsKICAgICAgICAgICAg\nICAgIHF1ZXJ5LnNldFBhcmFtZXRlcigyLCAiU25vb3B5Iik7CiAgICAgICAg\nICAgICAgICBMaXN0PEFwcGxpY2FudD4gYXBwTGlzdCA9IHF1ZXJ5LmdldFJl\nc3VsdExpc3QoKTsKICAgICAgICAgICAgICAgIGVtLmdldFRyYW5zYWN0aW9u\nKCkuY29tbWl0KCk7CiAgICAgICAgICAgICAgICBhc3NlcnRFcXVhbHMoMiwg\nYXBwTGlzdC5zaXplKCkpOwogICAgICAgICAgICAgICAgZm9yIChBcHBsaWNh\nbnQgYSA6IGFwcExpc3QpIHsKICAgICAgICAgICAgICAgICAgICBpZiAoIWEu\nZ2V0TmFtZSgpLmVxdWFscygiQ2hhcmxpZSIpCiAgICAgICAgICAgICAgICAg\nICAgICAgICYmICFhLmdldE5hbWUoKS5lcXVhbHMoIlNub29weSIpKQogICAg\nICAgICAgICAgICAgICAgICAgICBmYWlsKCJmb3VuZCBpbnZhbGlkIGFwcGxp\nY2FudCAiICsgYS5nZXROYW1lKCkpOwogICAgICAgICAgICAgICAgfQogICAg\nICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkgewogICAgICAgICAgICAg\nICAgZW0uZ2V0VHJhbnNhY3Rpb24oKS5yb2xsYmFjaygpOwogICAgICAgICAg\nICAgICAgZmFpbCgiQ2F1Z2h0IHVuZXhwZWN0ZWQgZXhjZXB0aW9uIGV4ZWN1\ndGluZyBzdG9yZWQgcHJvY2VkdXJlOiAiCiAgICAgICAgICAgICAgICAgICAg\nKyBlLmdldE1lc3NhZ2UoKSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAg\nIC8vIFRoaXMgb25lIHNob3VsZCBmYWlsIHNpbmNlIHdlIGFyZSBkb2luZyBz\nZWxlY3QgaW4gc3RlYWQgb2YgdXBkYXRlCiAgICAgICAgICAgIHRyeSB7CiAg\nICAgICAgICAgICAgICBlbS5nZXRUcmFuc2FjdGlvbigpLmJlZ2luKCk7CiAg\nICAgICAgICAgICAgICBRdWVyeSBxdWVyeSA9IGVtLmNyZWF0ZU5hdGl2ZVF1\nZXJ5KHNxbCwgQXBwbGljYW50LmNsYXNzKTsKICAgICAgICAgICAgICAgIHF1\nZXJ5LnNldFBhcmFtZXRlcigxLCAiQ2hhcmxpZSIpOwogICAgICAgICAgICAg\nICAgcXVlcnkuc2V0UGFyYW1ldGVyKDIsICJTbm9vcHkiKTsKICAgICAgICAg\nICAgICAgIHF1ZXJ5LmV4ZWN1dGVVcGRhdGUoKTsKICAgICAgICAgICAgICAg\nIGVtLmdldFRyYW5zYWN0aW9uKCkuY29tbWl0KCk7CiAgICAgICAgICAgICAg\nICBmYWlsKCJFeHBlY3RlZCBleGNlcHRpb24uIGV4ZWN1dGVVcGRhdGUoKSB3\naXRoIHF1ZXJ5IHByb2NlZHVyZSAiCiAgICAgICAgICAgICAgICAgICAgKyAi\nc2hvdWxkIGZhaWwuIik7CiAgICAgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlv\nbiBlKSB7CiAgICAgICAgICAgICAgICAvLyBFeHBlY3RlZCBleGNlcHRpb24K\nICAgICAgICAgICAgICAgIGVtLmdldFRyYW5zYWN0aW9uKCkucm9sbGJhY2so\nKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gcmVmcmVzaCB0aGUg\nZGF0YQogICAgICAgICAgICBlbS5jbGVhcigpOwogICAgICAgICAgICBlbS5j\nbG9zZSgpOwogICAgICAgICAgICBlbSA9IGVtZi5jcmVhdGVFbnRpdHlNYW5h\nZ2VyKCk7CiAgICAgICAgfQogICAgfQp9Cg==\n","encoding":"base64"}

