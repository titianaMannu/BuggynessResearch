{"sha":"8c2d39b6811ec5f2f3a57aa0f4098a298c18fb00","node_id":"MDQ6QmxvYjIwNjM2NDo4YzJkMzliNjgxMWVjNWYyZjNhNTdhYTBmNDA5OGEyOThjMThmYjAw","size":11867,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/8c2d39b6811ec5f2f3a57aa0f4098a298c18fb00","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5rZXJuZWw7CgppbXBv\ncnQgamF2YS5zcWwuQ29ubmVjdGlvbjsKaW1wb3J0IGphdmEuc3FsLlByZXBh\ncmVkU3RhdGVtZW50OwppbXBvcnQgamF2YS5zcWwuUmVzdWx0U2V0OwppbXBv\ncnQgamF2YS5zcWwuU1FMRXhjZXB0aW9uOwppbXBvcnQgamF2YS50ZXh0Lk1l\nc3NhZ2VGb3JtYXQ7CgppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmNvbmYu\nT3BlbkpQQUNvbmZpZ3VyYXRpb247CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEuamRiYy5jb25mLkpEQkNDb25maWd1cmF0aW9uOwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLmpkYmMuY29uZi5KREJDQ29uZmlndXJhdGlvbkltcGw7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhLkNsYXNzTWFw\ncGluZzsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNjaGVtYS5T\nY2hlbWE7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hlbWEu\nU2NoZW1hR3JvdXA7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5z\nY2hlbWEuU2NoZW1hVG9vbDsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5q\nZGJjLnNjaGVtYS5TY2hlbWFzOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLmpkYmMuc2NoZW1hLlNlcXVlbmNlOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLmpkYmMuc3FsLkRCRGljdGlvbmFyeTsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS5saWIuY29uZi5Db25maWd1cmFibGU7CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEubGliLmNvbmYuQ29uZmlndXJhdGlvbjsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5saWIuY29uZi5Db25maWd1cmF0aW9uczsKaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIubG9nLkxvZzsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5saWIudXRpbC5Mb2NhbGl6ZXI7CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuT3B0aW9uczsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS51dGlsLk1ldGFEYXRhRXhjZXB0aW9uOwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuVXNlckV4Y2VwdGlvbjsKCmlt\ncG9ydCBzZXJwLnV0aWwuTnVtYmVyczsKaW1wb3J0IHNlcnAudXRpbC5TdHJp\nbmdzOwoKLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v\nLy8vLy8vLy8vLy8vLy8vLy8vLy8KLy8gTk9URTogRG8gbm90IGNoYW5nZSBw\ncm9wZXJ0eSBuYW1lczsgc2VlIFNlcXVlbmNlTWV0YURhdGEKLy8gYW5kIFNl\ncXVlbmNlTWFwcGluZyBmb3Igc3RhbmRhcmQgcHJvcGVydHkgbmFtZXMuCi8v\nLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v\nLy8vLy8vLy8vLy8vLwoKLyoqCiAqIHtAbGluayBKREJDU2VxfSBpbXBsZW1l\nbnRhdGlvbiB0aGF0IHVzZXMgYSBkYXRhYmFzZSBzZXF1ZW5jZXMKICogdG8g\nZ2VuZXJhdGUgbnVtYmVycy4KICoKICogQHNlZSBKREJDU2VxCiAqIEBzZWUg\nQWJzdHJhY3RKREJDU2VxCiAqLwpwdWJsaWMgY2xhc3MgTmF0aXZlSkRCQ1Nl\ncQogICAgZXh0ZW5kcyBBYnN0cmFjdEpEQkNTZXEKICAgIGltcGxlbWVudHMg\nQ29uZmlndXJhYmxlIHsKCiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIFN0cmlu\nZyBBQ1RJT05fRFJPUCA9ICJkcm9wIjsKICAgIHB1YmxpYyBzdGF0aWMgZmlu\nYWwgU3RyaW5nIEFDVElPTl9BREQgPSAiYWRkIjsKICAgIHB1YmxpYyBzdGF0\naWMgZmluYWwgU3RyaW5nIEFDVElPTl9HRVQgPSAiZ2V0IjsKCiAgICBwcml2\nYXRlIHN0YXRpYyBMb2NhbGl6ZXIgX2xvYyA9IExvY2FsaXplci5mb3JQYWNr\nYWdlKE5hdGl2ZUpEQkNTZXEuY2xhc3MpOwoKICAgIHByaXZhdGUgSkRCQ0Nv\nbmZpZ3VyYXRpb24gX2NvbmYgPSBudWxsOwogICAgcHJpdmF0ZSBTdHJpbmcg\nX3NlcU5hbWUgPSAiT1BFTkpQQV9TRVFVRU5DRSI7CiAgICBwcml2YXRlIGlu\ndCBfaW5jcmVtZW50ID0gMTsKICAgIHByaXZhdGUgaW50IF9pbml0aWFsID0g\nMTsKICAgIHByaXZhdGUgaW50IF9hbGxvY2F0ZSA9IDA7CiAgICBwcml2YXRl\nIFNlcXVlbmNlIF9zZXEgPSBudWxsOwogICAgcHJpdmF0ZSBTdHJpbmcgX3Nl\nbGVjdCA9IG51bGw7CgogICAgLy8gZm9yIGRlcHJlY2F0ZWQgYXV0by1jb25m\naWd1cmF0aW9uIHN1cHBvcnQKICAgIHByaXZhdGUgU3RyaW5nIF9mb3JtYXQg\nPSBudWxsOwogICAgcHJpdmF0ZSBTdHJpbmcgX3RhYmxlTmFtZSA9ICJEVUFM\nIjsKICAgIHByaXZhdGUgYm9vbGVhbiBfc3ViVGFibGUgPSBmYWxzZTsKCiAg\nICAvKioKICAgICAqIFRoZSBzZXF1ZW5jZSBuYW1lLiBEZWZhdWx0cyB0byA8\nY29kZT5PUEVOSlBBX1NFUVVFTkNFPC9jb2RlPi4KICAgICAqLwogICAgcHVi\nbGljIFN0cmluZyBnZXRTZXF1ZW5jZSgpIHsKICAgICAgICByZXR1cm4gX3Nl\ncU5hbWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBUaGUgc2VxdWVuY2UgbmFt\nZS4gRGVmYXVsdHMgdG8gPGNvZGU+T1BFTkpQQV9TRVFVRU5DRTwvY29kZT4u\nCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldFNlcXVlbmNlKFN0cmluZyBz\nZXFOYW1lKSB7CiAgICAgICAgX3NlcU5hbWUgPSBzZXFOYW1lOwogICAgfQoK\nICAgIC8qKgogICAgICogQGRlcHJlY2F0ZWQgVXNlIHtAbGluayAjc2V0U2Vx\ndWVuY2V9LiBSZXRhaW5lZCBmb3IKICAgICAqIGJhY2t3YXJkcy1jb21wYXRp\nYmlsaXR5IGZvciBhdXRvLWNvbmZpZ3VyYXRpb24uCiAgICAgKi8KICAgIEBE\nZXByZWNhdGVkCiAgICBwdWJsaWMgdm9pZCBzZXRTZXF1ZW5jZU5hbWUoU3Ry\naW5nIHNlcU5hbWUpIHsKICAgICAgICBzZXRTZXF1ZW5jZShzZXFOYW1lKTsK\nICAgIH0KCiAgICAvKioKICAgICAqIEBzZWUgU2VxdWVuY2UjZ2V0SW5pdGlh\nbFZhbHVlCiAgICAgKi8KICAgIHB1YmxpYyBpbnQgZ2V0SW5pdGlhbFZhbHVl\nKCkgewogICAgICAgIHJldHVybiBfaW5pdGlhbDsKICAgIH0KCiAgICAvKioK\nICAgICAqIEBzZWUgU2VxdWVuY2Ujc2V0SW5pdGlhbFZhbHVlCiAgICAgKi8K\nICAgIHB1YmxpYyB2b2lkIHNldEluaXRpYWxWYWx1ZShpbnQgaW5pdGlhbCkg\newogICAgICAgIF9pbml0aWFsID0gaW5pdGlhbDsKICAgIH0KCiAgICAvKioK\nICAgICAqIEBzZWUgU2VxdWVuY2UjZ2V0QWxsb2NhdGUKICAgICAqLwogICAg\ncHVibGljIGludCBnZXRBbGxvY2F0ZSgpIHsKICAgICAgICByZXR1cm4gX2Fs\nbG9jYXRlOwogICAgfQoKICAgIC8qKgogICAgICogQHNlZSBTZXF1ZW5jZSNz\nZXRBbGxvY2F0ZQogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRBbGxvY2F0\nZShpbnQgYWxsb2NhdGUpIHsKICAgICAgICBfYWxsb2NhdGUgPSBhbGxvY2F0\nZTsKICAgIH0KCiAgICAvKioKICAgICAqIEBzZWUgU2VxdWVuY2UjZ2V0SW5j\ncmVtZW50CiAgICAgKi8KICAgIHB1YmxpYyBpbnQgZ2V0SW5jcmVtZW50KCkg\newogICAgICAgIHJldHVybiBfaW5jcmVtZW50OwogICAgfQoKICAgIC8qKgog\nICAgICogQHNlZSBTZXF1ZW5jZSNzZXRJbmNyZW1lbnQKICAgICAqLwogICAg\ncHVibGljIHZvaWQgc2V0SW5jcmVtZW50KGludCBpbmNyZW1lbnQpIHsKICAg\nICAgICBfaW5jcmVtZW50ID0gaW5jcmVtZW50OwogICAgfQoKICAgIC8qKgog\nICAgICogQGRlcHJlY2F0ZWQgUmV0YWluZWQgZm9yIGJhY2t3YXJkcy1jb21w\nYXRpYmlsaXR5IGZvciBhdXRvLWNvbmZpZ3VyYXRpb24uCiAgICAgKi8KICAg\nIEBEZXByZWNhdGVkCiAgICBwdWJsaWMgdm9pZCBzZXRUYWJsZU5hbWUoU3Ry\naW5nIHRhYmxlKSB7CiAgICAgICAgX3RhYmxlTmFtZSA9IHRhYmxlOwogICAg\nfQoKICAgIC8qKgogICAgICogQGRlcHJlY2F0ZWQgUmV0YWluZWQgZm9yIGJh\nY2t3YXJkcy1jb21wYXRpYmlsaXR5IGZvciBhdXRvLWNvbmZpZ3VyYXRpb24u\nCiAgICAgKi8KICAgIEBEZXByZWNhdGVkCiAgICBwdWJsaWMgdm9pZCBzZXRG\nb3JtYXQoU3RyaW5nIGZvcm1hdCkgewogICAgICAgIF9mb3JtYXQgPSBmb3Jt\nYXQ7CiAgICAgICAgX3N1YlRhYmxlID0gdHJ1ZTsKICAgIH0KCiAgICBAT3Zl\ncnJpZGUKICAgIHB1YmxpYyB2b2lkIGFkZFNjaGVtYShDbGFzc01hcHBpbmcg\nbWFwcGluZywgU2NoZW1hR3JvdXAgZ3JvdXApIHsKICAgICAgICAvLyBzZXF1\nZW5jZSBhbHJlYWR5IGV4aXN0cz8KICAgICAgICBpZiAoZ3JvdXAuaXNLbm93\nblNlcXVlbmNlKF9zZXFOYW1lKSkKICAgICAgICAgICAgcmV0dXJuOwoKICAg\nICAgICBTdHJpbmcgc2NoZW1hTmFtZSA9IFN0cmluZ3MuZ2V0UGFja2FnZU5h\nbWUoX3NlcU5hbWUpOwogICAgICAgIGlmIChzY2hlbWFOYW1lLmxlbmd0aCgp\nID09IDApCiAgICAgICAgICAgIHNjaGVtYU5hbWUgPSBTY2hlbWFzLmdldE5l\nd1RhYmxlU2NoZW1hKF9jb25mKTsKCiAgICAgICAgLy8gY3JlYXRlIHRhYmxl\nIGluIHRoaXMgZ3JvdXAKICAgICAgICBTY2hlbWEgc2NoZW1hID0gZ3JvdXAu\nZ2V0U2NoZW1hKHNjaGVtYU5hbWUpOwogICAgICAgIGlmIChzY2hlbWEgPT0g\nbnVsbCkKICAgICAgICAgICAgc2NoZW1hID0gZ3JvdXAuYWRkU2NoZW1hKHNj\naGVtYU5hbWUpOwogICAgICAgIHNjaGVtYS5pbXBvcnRTZXF1ZW5jZShfc2Vx\nKTsKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyBKREJDQ29uZmln\ndXJhdGlvbiBnZXRDb25maWd1cmF0aW9uKCkgewogICAgICAgIHJldHVybiBf\nY29uZjsKICAgIH0KICAgIAogICAgcHVibGljIHZvaWQgc2V0Q29uZmlndXJh\ndGlvbihDb25maWd1cmF0aW9uIGNvbmYpIHsKICAgICAgICBfY29uZiA9IChK\nREJDQ29uZmlndXJhdGlvbikgY29uZjsKICAgIH0KCiAgICBwdWJsaWMgdm9p\nZCBzdGFydENvbmZpZ3VyYXRpb24oKSB7CiAgICB9CgogICAgcHVibGljIHZv\naWQgZW5kQ29uZmlndXJhdGlvbigpIHsKICAgICAgICBidWlsZFNlcXVlbmNl\nKCk7CgogICAgICAgIERCRGljdGlvbmFyeSBkaWN0ID0gX2NvbmYuZ2V0REJE\naWN0aW9uYXJ5SW5zdGFuY2UoKTsKICAgICAgICBpZiAoX2Zvcm1hdCA9PSBu\ndWxsKSB7CiAgICAgICAgICAgIF9mb3JtYXQgPSBkaWN0Lm5leHRTZXF1ZW5j\nZVF1ZXJ5OwogICAgICAgICAgICBpZiAoX2Zvcm1hdCA9PSBudWxsKQogICAg\nICAgICAgICAgICAgdGhyb3cgbmV3IE1ldGFEYXRhRXhjZXB0aW9uKF9sb2Mu\nZ2V0KCJuby1zZXEtc3FsIiwgX3NlcU5hbWUpKTsKICAgICAgICB9CiAgICAg\nICAgaWYgKF90YWJsZU5hbWUgPT0gbnVsbCkKICAgICAgICAgICAgX3RhYmxl\nTmFtZSA9ICJEVUFMIjsKCiAgICAgICAgU3RyaW5nIG5hbWUgPSBkaWN0Lmdl\ndEZ1bGxOYW1lKF9zZXEpOwogICAgICAgIE9iamVjdFtdIHN1YnMgPSAoX3N1\nYlRhYmxlKSA/IG5ldyBPYmplY3RbXXsgbmFtZSwgX3RhYmxlTmFtZSB9CiAg\nICAgICAgICAgIDogbmV3IE9iamVjdFtdeyBuYW1lIH07CiAgICAgICAgX3Nl\nbGVjdCA9IE1lc3NhZ2VGb3JtYXQuZm9ybWF0KF9mb3JtYXQsIHN1YnMpOwog\nICAgICAgIAogICAgICAgIHR5cGUgPSBkaWN0Lm5hdGl2ZVNlcXVlbmNlVHlw\nZTsKICAgIH0KICAgIAogICAgQE92ZXJyaWRlCiAgICBwcm90ZWN0ZWQgT2Jq\nZWN0IG5leHRJbnRlcm5hbChKREJDU3RvcmUgc3RvcmUsIENsYXNzTWFwcGlu\nZyBtYXBwaW5nKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAg\nICAgIENvbm5lY3Rpb24gY29ubiA9IGdldENvbm5lY3Rpb24oc3RvcmUpOwog\nICAgICAgIHRyeSB7CiAgICAgICAgICAgIHJldHVybiBOdW1iZXJzLnZhbHVl\nT2YoZ2V0U2VxdWVuY2UoY29ubikpOwogICAgICAgIH0gZmluYWxseSB7CiAg\nICAgICAgICAgIGNsb3NlQ29ubmVjdGlvbihjb25uKTsKICAgICAgICB9CiAg\nICB9CgogICAgLyoqCiAgICAgKiBDcmVhdGVzIHRoZSBzZXF1ZW5jZSBvYmpl\nY3QuCiAgICAgKi8KICAgIHByaXZhdGUgdm9pZCBidWlsZFNlcXVlbmNlKCkg\newogICAgICAgIFN0cmluZyBzZXFOYW1lID0gU3RyaW5ncy5nZXRDbGFzc05h\nbWUoX3NlcU5hbWUpOwogICAgICAgIFN0cmluZyBzY2hlbWFOYW1lID0gU3Ry\naW5ncy5nZXRQYWNrYWdlTmFtZShfc2VxTmFtZSk7CiAgICAgICAgaWYgKHNj\naGVtYU5hbWUubGVuZ3RoKCkgPT0gMCkKICAgICAgICAgICAgc2NoZW1hTmFt\nZSA9IFNjaGVtYXMuZ2V0TmV3VGFibGVTY2hlbWEoX2NvbmYpOwoKICAgICAg\nICAvLyBidWlsZCB0aGUgc2VxdWVuY2UgaW4gb25lIG9mIHRoZSBkZXNpZ25h\ndGVkIHNjaGVtYXMKICAgICAgICBTY2hlbWFHcm91cCBncm91cCA9IG5ldyBT\nY2hlbWFHcm91cCgpOwogICAgICAgIFNjaGVtYSBzY2hlbWEgPSBncm91cC5h\nZGRTY2hlbWEoc2NoZW1hTmFtZSk7CgogICAgICAgIF9zZXEgPSBzY2hlbWEu\nYWRkU2VxdWVuY2Uoc2VxTmFtZSk7CiAgICAgICAgX3NlcS5zZXRJbml0aWFs\nVmFsdWUoX2luaXRpYWwpOwogICAgICAgIF9zZXEuc2V0SW5jcmVtZW50KF9p\nbmNyZW1lbnQpOwogICAgICAgIF9zZXEuc2V0QWxsb2NhdGUoX2FsbG9jYXRl\nKTsKICAgIH0KCiAgICAvKioKICAgICAqIENyZWF0ZXMgdGhlIHNlcXVlbmNl\nIGluIHRoZSBEQi4KICAgICAqLwogICAgcHVibGljIHZvaWQgcmVmcmVzaFNl\ncXVlbmNlKCkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAg\nICBMb2cgbG9nID0gX2NvbmYuZ2V0TG9nKE9wZW5KUEFDb25maWd1cmF0aW9u\nLkxPR19SVU5USU1FKTsKICAgICAgICBpZiAobG9nLmlzSW5mb0VuYWJsZWQo\nKSkKICAgICAgICAgICAgbG9nLmluZm8oX2xvYy5nZXQoIm1ha2UtbmF0aXZl\nLXNlcSIpKTsKCiAgICAgICAgLy8gY3JlYXRlIHRoZSBzZXF1ZW5jZQogICAg\nICAgIFNjaGVtYVRvb2wgdG9vbCA9IG5ldyBTY2hlbWFUb29sKF9jb25mKTsK\nICAgICAgICB0b29sLnNldElnbm9yZUVycm9ycyh0cnVlKTsKICAgICAgICB0\nb29sLmNyZWF0ZVNlcXVlbmNlKF9zZXEpOwogICAgfQoKICAgIC8qKgogICAg\nICogRHJvcHMgdGhlIHNlcXVlbmNlIGluIHRoZSBEQi4KICAgICAqLwogICAg\ncHVibGljIHZvaWQgZHJvcFNlcXVlbmNlKCkKICAgICAgICB0aHJvd3MgU1FM\nRXhjZXB0aW9uIHsKICAgICAgICBMb2cgbG9nID0gX2NvbmYuZ2V0TG9nKE9w\nZW5KUEFDb25maWd1cmF0aW9uLkxPR19SVU5USU1FKTsKICAgICAgICBpZiAo\nbG9nLmlzSW5mb0VuYWJsZWQoKSkKICAgICAgICAgICAgbG9nLmluZm8oX2xv\nYy5nZXQoImRyb3AtbmF0aXZlLXNlcSIpKTsKCiAgICAgICAgLy8gZHJvcCB0\naGUgdGFibGUKICAgICAgICBTY2hlbWFUb29sIHRvb2wgPSBuZXcgU2NoZW1h\nVG9vbChfY29uZik7CiAgICAgICAgdG9vbC5zZXRJZ25vcmVFcnJvcnModHJ1\nZSk7CiAgICAgICAgdG9vbC5kcm9wU2VxdWVuY2UoX3NlcSk7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIG5leHQgc2VxdWVuY2UgdmFsdWUu\nCiAgICAgKi8KICAgIHByaXZhdGUgbG9uZyBnZXRTZXF1ZW5jZShDb25uZWN0\naW9uIGNvbm4pCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAg\nICAgUHJlcGFyZWRTdGF0ZW1lbnQgc3RtbnQgPSBudWxsOwogICAgICAgIFJl\nc3VsdFNldCBycyA9IG51bGw7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAg\nc3RtbnQgPSBjb25uLnByZXBhcmVTdGF0ZW1lbnQoX3NlbGVjdCk7CiAgICAg\nICAgICAgIHN5bmNocm9uaXplZCh0aGlzKSB7CiAgICAgICAgICAgICAgICBy\ncyA9IHN0bW50LmV4ZWN1dGVRdWVyeSgpOwogICAgICAgICAgICB9CiAgICAg\nICAgICAgIGlmIChycy5uZXh0KCkpCiAgICAgICAgICAgICAgICByZXR1cm4g\ncnMuZ2V0TG9uZygxKTsKCiAgICAgICAgICAgIC8vIG5vIHJvdyAhPwogICAg\nICAgICAgICB0aHJvdyBuZXcgVXNlckV4Y2VwdGlvbihfbG9jLmdldCgiaW52\nYWxpZC1zZXEtc3FsIiwgX3NlbGVjdCkpOwogICAgICAgIH0gZmluYWxseSB7\nCiAgICAgICAgICAgIC8vIGNsZWFuIHVwIG91ciByZXNvdXJjZXMKICAgICAg\nICAgICAgaWYgKHJzICE9IG51bGwpCiAgICAgICAgICAgICAgICB0cnkgeyBy\ncy5jbG9zZSgpOyB9IGNhdGNoIChTUUxFeGNlcHRpb24gc2UpIHt9CiAgICAg\nICAgICAgIGlmIChzdG1udCAhPSBudWxsKQogICAgICAgICAgICAgICAgdHJ5\nIHsgc3RtbnQuY2xvc2UoKTsgfSBjYXRjaCAoU1FMRXhjZXB0aW9uIHNlKSB7\nfQogICAgICAgIH0KICAgIH0KCiAgICAvLy8vLy8vLy8KICAgIC8vIE1haW4K\nICAgIC8vLy8vLy8vLwoKICAgIC8qKgogICAgICogVXNhZ2U6IGphdmEgb3Jn\nLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1hLk5hdGl2ZUpEQkNTZXF1ZW5j\nZSBbb3B0aW9uXSoKICAgICAqIC1hY3Rpb24vLWEgJmx0O2FkZCB8IGRyb3Ag\nfCBnZXQmZ3Q7CiAgICAgKiAgV2hlcmUgdGhlIGZvbGxvd2luZyBvcHRpb25z\nIGFyZSByZWNvZ25pemVkLgogICAgICogPHVsPgogICAgICogPGxpPjxpPi1w\ncm9wZXJ0aWVzLy1wICZsdDtwcm9wZXJ0aWVzIGZpbGUgb3IgcmVzb3VyY2Um\nZ3Q7PC9pPjogVGhlCiAgICAgKiBwYXRoIG9yIHJlc291cmNlIG5hbWUgb2Yg\nYSBPcGVuSlBBIHByb3BlcnRpZXMgZmlsZSBjb250YWluaW5nCiAgICAgKiBp\nbmZvcm1hdGlvbiBzdWNoIGFzIHRoZSBsaWNlbnNlIGtleQlhbmQgY29ubmVj\ndGlvbiBkYXRhIGFzCiAgICAgKiBvdXRsaW5lZCBpbiB7QGxpbmsgSkRCQ0Nv\nbmZpZ3VyYXRpb259LiBPcHRpb25hbC48L2xpPgogICAgICogPGxpPjxpPi0m\nbHQ7cHJvcGVydHkgbmFtZSZndDsgJmx0O3Byb3BlcnR5IHZhbHVlJmd0Ozwv\naT46IEFsbCBiZWFuCiAgICAgKiBwcm9wZXJ0aWVzIG9mIHRoZSBPcGVuSlBB\nIHtAbGluayBKREJDQ29uZmlndXJhdGlvbn0gY2FuIGJlIHNldCBieQogICAg\nICogdXNpbmcgdGhlaXIJbmFtZXMgYW5kIHN1cHBseWluZyBhIHZhbHVlLiBG\nb3IgZXhhbXBsZToKICAgICAqIDxjb2RlPi1saWNlbnNlS2V5IGFkc2xmamE4\nM3IzbGthZGY8L2NvZGU+PC9saT4KICAgICAqIDwvdWw+CiAgICAgKiAgVGhl\nIHZhcmlvdXMgYWN0aW9ucyBhcmUgYXMgZm9sbG93cy4KICAgICAqIDx1bD4K\nICAgICAqIDxsaT48aT5hZGQ8L2k+OiBDcmVhdGUgdGhlIHNlcXVlbmNlLjwv\nbGk+CiAgICAgKiA8bGk+PGk+ZHJvcDwvaT46IERyb3AgdGhlIHNlcXVlbmNl\nLjwvbGk+CiAgICAgKiA8bGk+PGk+Z2V0PC9pPjogUHJpbnQgdGhlIG5leHQg\nc2VxdWVuY2UgdmFsdWUuPC9saT4KICAgICAqIDwvdWw+CiAgICAgKi8KICAg\nIHB1YmxpYyBzdGF0aWMgdm9pZCBtYWluKFN0cmluZ1tdIGFyZ3MpCiAgICAg\nICAgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgT3B0aW9ucyBvcHRzID0g\nbmV3IE9wdGlvbnMoKTsKICAgICAgICBmaW5hbCBTdHJpbmdbXSBhcmd1bWVu\ndHMgPSBvcHRzLnNldEZyb21DbWRMaW5lKGFyZ3MpOwogICAgICAgIGJvb2xl\nYW4gcmV0ID0gQ29uZmlndXJhdGlvbnMucnVuQWdhaW5zdEFsbEFuY2hvcnMo\nb3B0cywKICAgICAgICAgICAgbmV3IENvbmZpZ3VyYXRpb25zLlJ1bm5hYmxl\nKCkgewogICAgICAgICAgICBwdWJsaWMgYm9vbGVhbiBydW4oT3B0aW9ucyBv\ncHRzKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICAgICAgICAgIEpEQkND\nb25maWd1cmF0aW9uIGNvbmYgPSBuZXcgSkRCQ0NvbmZpZ3VyYXRpb25JbXBs\nKCk7CiAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAg\nIHJldHVybiBOYXRpdmVKREJDU2VxLnJ1bihjb25mLCBhcmd1bWVudHMsIG9w\ndHMpOwogICAgICAgICAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAg\nICAgICAgICBjb25mLmNsb3NlKCk7CiAgICAgICAgICAgICAgICB9CiAgICAg\nICAgICAgIH0KICAgICAgICB9KTsKICAgICAgICBpZiAoIXJldCkKICAgICAg\nICAgICAgU3lzdGVtLm91dC5wcmludGxuKF9sb2MuZ2V0KCJuYXRpdmUtc2Vx\nLXVzYWdlIikpOwogICAgfQoKICAgIC8qKgogICAgICogUnVuIHRoZSB0b29s\nLiBSZXR1cm5zIGZhbHNlIGlmIGludmFsaWQgb3B0aW9ucyB3ZXJlIGdpdmVu\nLgogICAgICovCiAgICBwdWJsaWMgc3RhdGljIGJvb2xlYW4gcnVuKEpEQkND\nb25maWd1cmF0aW9uIGNvbmYsIFN0cmluZ1tdIGFyZ3MsCiAgICAgICAgT3B0\naW9ucyBvcHRzKQogICAgICAgIHRocm93cyBFeGNlcHRpb24gewogICAgICAg\nIFN0cmluZyBhY3Rpb24gPSBvcHRzLnJlbW92ZVByb3BlcnR5KCJhY3Rpb24i\nLCAiYSIsIG51bGwpOwogICAgICAgIENvbmZpZ3VyYXRpb25zLnBvcHVsYXRl\nQ29uZmlndXJhdGlvbihjb25mLCBvcHRzKTsKICAgICAgICByZXR1cm4gcnVu\nKGNvbmYsIGFyZ3MsIGFjdGlvbik7CiAgICB9CgogICAgLyoqCiAgICAgKiBS\ndW4gdGhlIHRvb2wuIFJldHVybiBmYWxzZSBpZiBhbiBpbnZhbGlkIG9wdGlv\nbiB3YXMgZ2l2ZW4uCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0aWMgYm9vbGVh\nbiBydW4oSkRCQ0NvbmZpZ3VyYXRpb24gY29uZiwgU3RyaW5nW10gYXJncywK\nICAgICAgICBTdHJpbmcgYWN0aW9uKQogICAgICAgIHRocm93cyBFeGNlcHRp\nb24gewogICAgICAgIGlmIChhcmdzLmxlbmd0aCAhPSAwKQogICAgICAgICAg\nICByZXR1cm4gZmFsc2U7CgogICAgICAgIE5hdGl2ZUpEQkNTZXEgc2VxID0g\nbmV3IE5hdGl2ZUpEQkNTZXEoKTsKICAgICAgICBTdHJpbmcgcHJvcHMgPSBD\nb25maWd1cmF0aW9ucy5nZXRQcm9wZXJ0aWVzKGNvbmYuZ2V0U2VxdWVuY2Uo\nKSk7CiAgICAgICAgQ29uZmlndXJhdGlvbnMuY29uZmlndXJlSW5zdGFuY2Uo\nc2VxLCBjb25mLCBwcm9wcyk7CgogICAgICAgIGlmIChBQ1RJT05fRFJPUC5l\ncXVhbHMoYWN0aW9uKSkKICAgICAgICAgICAgc2VxLmRyb3BTZXF1ZW5jZSgp\nOwogICAgICAgIGVsc2UgaWYgKEFDVElPTl9BREQuZXF1YWxzKGFjdGlvbikp\nCiAgICAgICAgICAgIHNlcS5yZWZyZXNoU2VxdWVuY2UoKTsKICAgICAgICBl\nbHNlIGlmIChBQ1RJT05fR0VULmVxdWFscyhhY3Rpb24pKSB7CiAgICAgICAg\nICAgIENvbm5lY3Rpb24gY29ubiA9IGNvbmYuZ2V0RGF0YVNvdXJjZTIobnVs\nbCkuZ2V0Q29ubmVjdGlvbigpOwogICAgICAgICAgICB0cnkgewogICAgICAg\nICAgICAgICAgbG9uZyBjdXIgPSBzZXEuZ2V0U2VxdWVuY2UoY29ubik7CiAg\nICAgICAgICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oY3VyKTsKICAgICAg\nICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgICAgIHRyeSB7IGNvbm4u\nY2xvc2UoKTsgfSBjYXRjaCAoU1FMRXhjZXB0aW9uIHNlKSB7fQogICAgICAg\nICAgICB9CiAgICAgICAgfSBlbHNlCiAgICAgICAgICAgIHJldHVybiBmYWxz\nZTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KfQo=\n","encoding":"base64"}

