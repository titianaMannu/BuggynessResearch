{"sha":"dd15e30c548420973c17eae46d888e15c4873b8c","node_id":"MDQ6QmxvYjIwNjM2NDpkZDE1ZTMwYzU0ODQyMDk3M2MxN2VhZTQ2ZDg4OGUxNWM0ODczYjhj","size":8974,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/dd15e30c548420973c17eae46d888e15c4873b8c","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNr\nYWdlIG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLm1ldGEuc3RyYXRzOwoKaW1w\nb3J0IGphdmEuc3FsLio7CmltcG9ydCBqYXZhLnV0aWwuKjsKCmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuKjsKCmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEua2VybmVsLio7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEudXRpbC4qOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuKjsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLm1ldGEuKjsKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLmtlcm5lbC4qOwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1hLio7CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEuamRiYy5zcWwuKjsKCi8qKgogKiA8cD5NYXBwaW5nIGZv\nciBhIGNvbGxlY3Rpb24gb2YgdmFsdWVzIGluIGEgc2VwYXJhdGUgdGFibGUg\nY29udHJvbGxlZCBieSBhCiAqIHtAbGluayBWYWx1ZUhhbmRsZXJ9LjwvcD4K\nICoKICogQGF1dGhvciBBYmUgV2hpdGUKICogQHNpbmNlIDAuNC4wLCAxLjEu\nMAogKi8KcHVibGljIGNsYXNzIEhhbmRsZXJDb2xsZWN0aW9uVGFibGVGaWVs\nZFN0cmF0ZWd5CiAgICBleHRlbmRzIFN0b3JlQ29sbGVjdGlvbkZpZWxkU3Ry\nYXRlZ3kKICAgIGltcGxlbWVudHMgTFJTQ29sbGVjdGlvbkZpZWxkU3RyYXRl\nZ3kgewoKICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIExvY2FsaXplciBfbG9j\nID0gTG9jYWxpemVyLmZvclBhY2thZ2UKICAgICAgICAoSGFuZGxlckNvbGxl\nY3Rpb25UYWJsZUZpZWxkU3RyYXRlZ3kuY2xhc3MpOwoKICAgIHByaXZhdGUg\nQ29sdW1uW10gX2NvbHMgPSBudWxsOwogICAgcHJpdmF0ZSBDb2x1bW5JTyBf\naW8gPSBudWxsOwogICAgcHJpdmF0ZSBib29sZWFuIF9sb2FkID0gZmFsc2U7\nCiAgICBwcml2YXRlIGJvb2xlYW4gX2xvYiA9IGZhbHNlOwogICAgcHJpdmF0\nZSBib29sZWFuIF9lbWJlZCA9IGZhbHNlOwoKICAgIHB1YmxpYyBGaWVsZE1h\ncHBpbmcgZ2V0RmllbGRNYXBwaW5nKCkgewogICAgICAgIHJldHVybiBmaWVs\nZDsKICAgIH0KCiAgICBwdWJsaWMgQ2xhc3NNYXBwaW5nW10gZ2V0SW5kZXBl\nbmRlbnRFbGVtZW50TWFwcGluZ3MoYm9vbGVhbiB0cmF2ZXJzZSkgewogICAg\nICAgIHJldHVybiBDbGFzc01hcHBpbmcuRU1QVFlfTUFQUElOR1M7CiAgICB9\nCgogICAgcHVibGljIENvbHVtbltdIGdldEVsZW1lbnRDb2x1bW5zKENsYXNz\nTWFwcGluZyBlbGVtKSB7CiAgICAgICAgcmV0dXJuIF9jb2xzOwogICAgfQoK\nICAgIHB1YmxpYyBGb3JlaWduS2V5IGdldEpvaW5Gb3JlaWduS2V5KENsYXNz\nTWFwcGluZyBlbGVtKSB7CiAgICAgICAgcmV0dXJuIGZpZWxkLmdldEpvaW5G\nb3JlaWduS2V5KCk7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2VsZWN0RWxl\nbWVudChTZWxlY3Qgc2VsLCBDbGFzc01hcHBpbmcgZWxlbSwgSkRCQ1N0b3Jl\nIHN0b3JlLAogICAgICAgIEpEQkNGZXRjaENvbmZpZ3VyYXRpb24gZmV0Y2gs\nIGludCBlYWdlck1vZGUsIEpvaW5zIGpvaW5zKSB7CiAgICAgICAgc2VsLnNl\nbGVjdChfY29scywgam9pbnMpOwogICAgfQoKICAgIHB1YmxpYyBPYmplY3Qg\nbG9hZEVsZW1lbnQoT3BlbkpQQVN0YXRlTWFuYWdlciBzbSwgSkRCQ1N0b3Jl\nIHN0b3JlLAogICAgICAgIEpEQkNGZXRjaENvbmZpZ3VyYXRpb24gZmV0Y2gs\nIFJlc3VsdCByZXMsIEpvaW5zIGpvaW5zKQogICAgICAgIHRocm93cyBTUUxF\neGNlcHRpb24gewogICAgICAgIHJldHVybiBIYW5kbGVyU3RyYXRlZ2llcy5s\nb2FkT2JqZWN0KGZpZWxkLmdldEVsZW1lbnRNYXBwaW5nKCksCiAgICAgICAg\nICAgIHNtLCBzdG9yZSwgZmV0Y2gsIHJlcywgam9pbnMsIF9jb2xzLCBfbG9h\nZCk7CiAgICB9CgogICAgcHJvdGVjdGVkIEpvaW5zIGpvaW4oSm9pbnMgam9p\nbnMsIENsYXNzTWFwcGluZyBlbGVtKSB7CiAgICAgICAgcmV0dXJuIGpvaW4o\nam9pbnMsIGZhbHNlKTsKICAgIH0KCiAgICBwdWJsaWMgSm9pbnMgam9pbkVs\nZW1lbnRSZWxhdGlvbihKb2lucyBqb2lucywgQ2xhc3NNYXBwaW5nIGVsZW0p\nIHsKICAgICAgICByZXR1cm4gam9pblJlbGF0aW9uKGpvaW5zLCBmYWxzZSwg\nZmFsc2UpOwogICAgfQoKICAgIHByb3RlY3RlZCBQcm94eSBuZXdMUlNQcm94\neSgpIHsKICAgICAgICByZXR1cm4gbmV3IExSU1Byb3h5Q29sbGVjdGlvbih0\naGlzKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBtYXAoYm9vbGVhbiBhZGFw\ndCkgewogICAgICAgIGlmIChmaWVsZC5nZXRUeXBlQ29kZSgpICE9IEphdmFU\neXBlcy5DT0xMRUNUSU9OCiAgICAgICAgICAgICYmIGZpZWxkLmdldFR5cGVD\nb2RlKCkgIT0gSmF2YVR5cGVzLkFSUkFZKQogICAgICAgICAgICB0aHJvdyBu\nZXcgTWV0YURhdGFFeGNlcHRpb24oX2xvYy5nZXQoIm5vdC1jb2xsIiwgZmll\nbGQpKTsKCiAgICAgICAgYXNzZXJ0Tm90TWFwcGVkQnkoKTsKICAgICAgICBm\naWVsZC5nZXRWYWx1ZUluZm8oKS5hc3NlcnROb1NjaGVtYUNvbXBvbmVudHMo\nZmllbGQsICFhZGFwdCk7CiAgICAgICAgZmllbGQuZ2V0S2V5TWFwcGluZygp\nLmdldFZhbHVlSW5mbygpLmFzc2VydE5vU2NoZW1hQ29tcG9uZW50cwogICAg\nICAgICAgICAoZmllbGQuZ2V0S2V5KCksICFhZGFwdCk7CgogICAgICAgIFZh\nbHVlTWFwcGluZyBlbGVtID0gZmllbGQuZ2V0RWxlbWVudE1hcHBpbmcoKTsK\nICAgICAgICBpZiAoZWxlbS5nZXRIYW5kbGVyKCkgPT0gbnVsbCkKICAgICAg\nICAgICAgdGhyb3cgbmV3IE1ldGFEYXRhRXhjZXB0aW9uKF9sb2MuZ2V0KCJu\nby1oYW5kbGVyIiwgZWxlbSkpOwoKICAgICAgICBmaWVsZC5tYXBKb2luKGFk\nYXB0LCB0cnVlKTsKICAgICAgICBfaW8gPSBuZXcgQ29sdW1uSU8oKTsKICAg\nICAgICBfY29scyA9IEhhbmRsZXJTdHJhdGVnaWVzLm1hcChlbGVtLCAiZWxl\nbWVudCIsIF9pbywgYWRhcHQpOwoKICAgICAgICBGaWVsZE1hcHBpbmdJbmZv\nIGZpbmZvID0gZmllbGQuZ2V0TWFwcGluZ0luZm8oKTsKICAgICAgICBDb2x1\nbW4gb3JkZXJDb2wgPSBmaW5mby5nZXRPcmRlckNvbHVtbihmaWVsZCwgZmll\nbGQuZ2V0VGFibGUoKSwgYWRhcHQpOwogICAgICAgIGZpZWxkLnNldE9yZGVy\nQ29sdW1uKG9yZGVyQ29sKTsKICAgICAgICBmaWVsZC5zZXRPcmRlckNvbHVt\nbklPKGZpbmZvLmdldENvbHVtbklPKCkpOwogICAgICAgIGZpZWxkLm1hcFBy\naW1hcnlLZXkoYWRhcHQpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIGluaXRp\nYWxpemUoKSB7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7ICFfbG9iICYmIGkg\nPCBfY29scy5sZW5ndGg7IGkrKykKICAgICAgICAgICAgX2xvYiA9IF9jb2xz\nW2ldLmlzTG9iKCk7CgogICAgICAgIFZhbHVlTWFwcGluZyBlbGVtID0gZmll\nbGQuZ2V0RWxlbWVudE1hcHBpbmcoKTsKICAgICAgICBfZW1iZWQgPSBlbGVt\nLmdldEVtYmVkZGVkTWV0YURhdGEoKSAhPSBudWxsOwogICAgICAgIF9sb2Fk\nID0gZWxlbS5nZXRIYW5kbGVyKCkub2JqZWN0VmFsdWVSZXF1aXJlc0xvYWQo\nZWxlbSk7CiAgICB9CgogICAgcHVibGljIHZvaWQgaW5zZXJ0KE9wZW5KUEFT\ndGF0ZU1hbmFnZXIgc20sIEpEQkNTdG9yZSBzdG9yZSwgUm93TWFuYWdlciBy\nbSkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBpbnNl\ncnQoc20sIHN0b3JlLCBybSwgc20uZmV0Y2hPYmplY3QoZmllbGQuZ2V0SW5k\nZXgoKSkpOwogICAgfQoKICAgIHByaXZhdGUgdm9pZCBpbnNlcnQoT3BlbkpQ\nQVN0YXRlTWFuYWdlciBzbSwgSkRCQ1N0b3JlIHN0b3JlLCBSb3dNYW5hZ2Vy\nIHJtLAogICAgICAgIE9iamVjdCB2YWxzKQogICAgICAgIHRocm93cyBTUUxF\neGNlcHRpb24gewogICAgICAgIENvbGxlY3Rpb24gY29sbDsKICAgICAgICBp\nZiAoZmllbGQuZ2V0VHlwZUNvZGUoKSA9PSBKYXZhVHlwZXMuQVJSQVkpCiAg\nICAgICAgICAgIGNvbGwgPSBKYXZhVHlwZXMudG9MaXN0KHZhbHMsIGZpZWxk\nLmdldEVsZW1lbnQoKS5nZXRUeXBlKCksCiAgICAgICAgICAgICAgICBmYWxz\nZSk7CiAgICAgICAgZWxzZQogICAgICAgICAgICBjb2xsID0gKENvbGxlY3Rp\nb24pIHZhbHM7CiAgICAgICAgaWYgKGNvbGwgPT0gbnVsbCB8fCBjb2xsLmlz\nRW1wdHkoKSkKICAgICAgICAgICAgcmV0dXJuOwoKICAgICAgICBSb3cgcm93\nID0gcm0uZ2V0U2Vjb25kYXJ5Um93KGZpZWxkLmdldFRhYmxlKCksIFJvdy5B\nQ1RJT05fSU5TRVJUKTsKICAgICAgICByb3cuc2V0Rm9yZWlnbktleShmaWVs\nZC5nZXRKb2luRm9yZWlnbktleSgpLCBmaWVsZC5nZXRKb2luQ29sdW1uSU8o\nKSwKICAgICAgICAgICAgc20pOwoKICAgICAgICBWYWx1ZU1hcHBpbmcgZWxl\nbSA9IGZpZWxkLmdldEVsZW1lbnRNYXBwaW5nKCk7CiAgICAgICAgQ29sdW1u\nIG9yZGVyID0gZmllbGQuZ2V0T3JkZXJDb2x1bW4oKTsKICAgICAgICBib29s\nZWFuIHNldE9yZGVyID0gZmllbGQuZ2V0T3JkZXJDb2x1bW5JTygpLmlzSW5z\nZXJ0YWJsZShvcmRlciwgZmFsc2UpOwogICAgICAgIGludCBpZHggPSAwOwog\nICAgICAgIGZvciAoSXRlcmF0b3IgaXRyID0gY29sbC5pdGVyYXRvcigpOyBp\ndHIuaGFzTmV4dCgpOyBpZHgrKykgewogICAgICAgICAgICBIYW5kbGVyU3Ry\nYXRlZ2llcy5zZXQoZWxlbSwgaXRyLm5leHQoKSwgc3RvcmUsIHJvdywgX2Nv\nbHMsCiAgICAgICAgICAgICAgICBfaW8sIHRydWUpOwogICAgICAgICAgICBp\nZiAoc2V0T3JkZXIpCiAgICAgICAgICAgICAgICByb3cuc2V0SW50KG9yZGVy\nLCBpZHgpOwogICAgICAgICAgICBybS5mbHVzaFNlY29uZGFyeVJvdyhyb3cp\nOwogICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMgdm9pZCB1cGRhdGUoT3Bl\nbkpQQVN0YXRlTWFuYWdlciBzbSwgSkRCQ1N0b3JlIHN0b3JlLCBSb3dNYW5h\nZ2VyIHJtKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAg\nIE9iamVjdCBvYmogPSBzbS5mZXRjaE9iamVjdChmaWVsZC5nZXRJbmRleCgp\nKTsKICAgICAgICBDaGFuZ2VUcmFja2VyIGN0ID0gbnVsbDsKICAgICAgICBp\nZiAob2JqIGluc3RhbmNlb2YgUHJveHkpIHsKICAgICAgICAgICAgUHJveHkg\ncHJveHkgPSAoUHJveHkpIG9iajsKICAgICAgICAgICAgaWYgKFByb3hpZXMu\naXNPd25lcihwcm94eSwgc20sIGZpZWxkLmdldEluZGV4KCkpKQogICAgICAg\nICAgICAgICAgY3QgPSBwcm94eS5nZXRDaGFuZ2VUcmFja2VyKCk7CiAgICAg\nICAgfQoKICAgICAgICAvLyBpZiBubyBmaW5lLWdyYWluZWQgY2hhbmdlIHRy\nYWNraW5nIHRoZW4ganVzdCBkZWxldGUgYW5kIHJlaW5zZXJ0CiAgICAgICAg\naWYgKGN0ID09IG51bGwgfHwgIWN0LmlzVHJhY2tpbmcoKSkgewogICAgICAg\nICAgICBkZWxldGUoc20sIHN0b3JlLCBybSk7CiAgICAgICAgICAgIGluc2Vy\ndChzbSwgc3RvcmUsIHJtLCBvYmopOwogICAgICAgICAgICByZXR1cm47CiAg\nICAgICAgfQoKICAgICAgICAvLyBkZWxldGUgdGhlIHJlbW92ZXMKICAgICAg\nICBWYWx1ZU1hcHBpbmcgZWxlbSA9IGZpZWxkLmdldEVsZW1lbnRNYXBwaW5n\nKCk7CiAgICAgICAgQ29sbGVjdGlvbiByZW0gPSBjdC5nZXRSZW1vdmVkKCk7\nCiAgICAgICAgaWYgKCFyZW0uaXNFbXB0eSgpKSB7CiAgICAgICAgICAgIFJv\ndyBkZWxSb3cgPSBybS5nZXRTZWNvbmRhcnlSb3coZmllbGQuZ2V0VGFibGUo\nKSwKICAgICAgICAgICAgICAgIFJvdy5BQ1RJT05fREVMRVRFKTsKICAgICAg\nICAgICAgZGVsUm93LndoZXJlRm9yZWlnbktleShmaWVsZC5nZXRKb2luRm9y\nZWlnbktleSgpLCBzbSk7CiAgICAgICAgICAgIGZvciAoSXRlcmF0b3IgaXRy\nID0gcmVtLml0ZXJhdG9yKCk7IGl0ci5oYXNOZXh0KCk7KSB7CiAgICAgICAg\nICAgICAgICBIYW5kbGVyU3RyYXRlZ2llcy53aGVyZShlbGVtLCBpdHIubmV4\ndCgpLCBzdG9yZSwgZGVsUm93LAogICAgICAgICAgICAgICAgICAgIF9jb2xz\nKTsKICAgICAgICAgICAgICAgIHJtLmZsdXNoU2Vjb25kYXJ5Um93KGRlbFJv\ndyk7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIC8vIGluc2Vy\ndCB0aGUgYWRkcwogICAgICAgIENvbGxlY3Rpb24gYWRkID0gY3QuZ2V0QWRk\nZWQoKTsKICAgICAgICBpZiAoIWFkZC5pc0VtcHR5KCkpIHsKICAgICAgICAg\nICAgUm93IGFkZFJvdyA9IHJtLmdldFNlY29uZGFyeVJvdyhmaWVsZC5nZXRU\nYWJsZSgpLAogICAgICAgICAgICAgICAgUm93LkFDVElPTl9JTlNFUlQpOwog\nICAgICAgICAgICBhZGRSb3cuc2V0Rm9yZWlnbktleShmaWVsZC5nZXRKb2lu\nRm9yZWlnbktleSgpLAogICAgICAgICAgICAgICAgZmllbGQuZ2V0Sm9pbkNv\nbHVtbklPKCksIHNtKTsKCiAgICAgICAgICAgIGludCBzZXEgPSBjdC5nZXRO\nZXh0U2VxdWVuY2UoKTsKICAgICAgICAgICAgQ29sdW1uIG9yZGVyID0gZmll\nbGQuZ2V0T3JkZXJDb2x1bW4oKTsKICAgICAgICAgICAgYm9vbGVhbiBzZXRP\ncmRlciA9IGZpZWxkLmdldE9yZGVyQ29sdW1uSU8oKS5pc0luc2VydGFibGUo\nb3JkZXIsCiAgICAgICAgICAgICAgICBmYWxzZSk7CiAgICAgICAgICAgIGZv\nciAoSXRlcmF0b3IgaXRyID0gYWRkLml0ZXJhdG9yKCk7IGl0ci5oYXNOZXh0\nKCk7IHNlcSsrKSB7CiAgICAgICAgICAgICAgICBIYW5kbGVyU3RyYXRlZ2ll\ncy5zZXQoZWxlbSwgaXRyLm5leHQoKSwgc3RvcmUsIGFkZFJvdywgX2NvbHMs\nCiAgICAgICAgICAgICAgICAgICAgX2lvLCB0cnVlKTsKICAgICAgICAgICAg\nICAgIGlmIChzZXRPcmRlcikKICAgICAgICAgICAgICAgICAgICBhZGRSb3cu\nc2V0SW50KG9yZGVyLCBzZXEpOwogICAgICAgICAgICAgICAgcm0uZmx1c2hT\nZWNvbmRhcnlSb3coYWRkUm93KTsKICAgICAgICAgICAgfQogICAgICAgICAg\nICBpZiAob3JkZXIgIT0gbnVsbCkKICAgICAgICAgICAgICAgIGN0LnNldE5l\neHRTZXF1ZW5jZShzZXEpOwogICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMg\ndm9pZCBkZWxldGUoT3BlbkpQQVN0YXRlTWFuYWdlciBzbSwgSkRCQ1N0b3Jl\nIHN0b3JlLCBSb3dNYW5hZ2VyIHJtKQogICAgICAgIHRocm93cyBTUUxFeGNl\ncHRpb24gewogICAgICAgIFJvdyByb3cgPSBybS5nZXRBbGxSb3dzKGZpZWxk\nLmdldFRhYmxlKCksIFJvdy5BQ1RJT05fREVMRVRFKTsKICAgICAgICByb3cu\nd2hlcmVGb3JlaWduS2V5KGZpZWxkLmdldEpvaW5Gb3JlaWduS2V5KCksIHNt\nKTsKICAgICAgICBybS5mbHVzaEFsbFJvd3Mocm93KTsKICAgIH0KCiAgICBw\ndWJsaWMgaW50IHN1cHBvcnRzU2VsZWN0KFNlbGVjdCBzZWwsIGludCB0eXBl\nLCBPcGVuSlBBU3RhdGVNYW5hZ2VyIHNtLAogICAgICAgIEpEQkNTdG9yZSBz\ndG9yZSwgSkRCQ0ZldGNoQ29uZmlndXJhdGlvbiBmZXRjaCkgewogICAgICAg\nIC8vIGNhbid0IGRvIGFueSBjb21iaW5lZCBzZWxlY3Qgd2l0aCBsb2JzLCBz\naW5jZSB0aGV5IGRvbid0IGFsbG93CiAgICAgICAgLy8gc2VsZWN0IGRpc3Rp\nbmN0LiAgY2FudCBzZWxlY3QgZWFnZXIgcGFyYWxsZWwgb24gZW1iZWRkZWQs\nIGJlY2F1c2UKICAgICAgICAvLyBkdXJpbmcgcGFyYWxsZWwgcmVzdWx0IHBy\nb2Nlc3NpbmcgdGhlIG93bmluZyBzbSB3b24ndCBiZSBhdmFpbGFibGUKICAg\nICAgICAvLyBmb3IgZWFjaCBlbGVtCiAgICAgICAgaWYgKF9sb2IgfHwgKF9l\nbWJlZCAmJiB0eXBlID09IFNlbGVjdC5FQUdFUl9QQVJBTExFTCkpCiAgICAg\nICAgICAgIHJldHVybiAwOwogICAgICAgIHJldHVybiBzdXBlci5zdXBwb3J0\nc1NlbGVjdChzZWwsIHR5cGUsIHNtLCBzdG9yZSwgZmV0Y2gpOwogICAgfQoK\nICAgIHB1YmxpYyBPYmplY3QgdG9EYXRhU3RvcmVWYWx1ZShPYmplY3QgdmFs\nLCBKREJDU3RvcmUgc3RvcmUpIHsKICAgICAgICByZXR1cm4gSGFuZGxlclN0\ncmF0ZWdpZXMudG9EYXRhU3RvcmVWYWx1ZShmaWVsZC5nZXRFbGVtZW50TWFw\ncGluZygpLAogICAgICAgICAgICB2YWwsIF9jb2xzLCBzdG9yZSk7CiAgICB9\nCgogICAgcHVibGljIEpvaW5zIGpvaW4oSm9pbnMgam9pbnMsIGJvb2xlYW4g\nZm9yY2VPdXRlcikgewogICAgICAgIHJldHVybiBmaWVsZC5qb2luKGpvaW5z\nLCBmb3JjZU91dGVyLCB0cnVlKTsKICAgIH0KCiAgICBwdWJsaWMgSm9pbnMg\nam9pblJlbGF0aW9uKEpvaW5zIGpvaW5zLCBib29sZWFuIGZvcmNlT3V0ZXIs\nCiAgICAgICAgYm9vbGVhbiB0cmF2ZXJzZSkgewogICAgICAgIGlmICh0cmF2\nZXJzZSkKICAgICAgICAgICAgSGFuZGxlclN0cmF0ZWdpZXMuYXNzZXJ0Sm9p\nbmFibGUoZmllbGQuZ2V0RWxlbWVudE1hcHBpbmcoKSk7CiAgICAgICAgcmV0\ndXJuIGpvaW5zOwogICAgfQp9Cg==\n","encoding":"base64"}

