{"sha":"0fed898fe8195931a9d1971a2d953046b9f7cb1a","node_id":"MDQ6QmxvYjIwNjM2NDowZmVkODk4ZmU4MTk1OTMxYTlkMTk3MWEyZDk1MzA0NmI5ZjdjYjFh","size":8961,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/0fed898fe8195931a9d1971a2d953046b9f7cb1a","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNr\nYWdlIG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLm1ldGEuc3RyYXRzOwoKaW1w\nb3J0IGphdmEuc3FsLio7CmltcG9ydCBqYXZhLnV0aWwuKjsKCmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEuamRiYy5rZXJuZWwuKjsKaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS5qZGJjLm1ldGEuKjsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS5qZGJjLnNjaGVtYS4qOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLmpkYmMuc3FsLio7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEua2Vy\nbmVsLio7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuKjsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLio7CgovKioKICogTWFw\ncGluZyBmb3IgYSBtYXAgb2Yga2V5cyBhbmQgdmFsdWVzIGJvdGggY29udHJv\nbGxlZCBieQogKiB7QGxpbmsgVmFsdWVIYW5kbGVyfXMuCiAqCiAqIEBhdXRo\nb3IgQWJlIFdoaXRlCiAqIEBzaW5jZSAwLjQuMCwgMS4xLjAKICovCnB1Ymxp\nYyBjbGFzcyBIYW5kbGVySGFuZGxlck1hcFRhYmxlRmllbGRTdHJhdGVneQog\nICAgZXh0ZW5kcyBNYXBUYWJsZUZpZWxkU3RyYXRlZ3kgewoKICAgIHByaXZh\ndGUgc3RhdGljIGZpbmFsIExvY2FsaXplciBfbG9jID0gTG9jYWxpemVyLmZv\nclBhY2thZ2UKICAgICAgICAoSGFuZGxlckhhbmRsZXJNYXBUYWJsZUZpZWxk\nU3RyYXRlZ3kuY2xhc3MpOwoKICAgIHByaXZhdGUgQ29sdW1uW10gX2tjb2xz\nID0gbnVsbDsKICAgIHByaXZhdGUgQ29sdW1uSU8gX2tpbyA9IG51bGw7CiAg\nICBwcml2YXRlIGJvb2xlYW4gX2tsb2FkID0gZmFsc2U7CiAgICBwcml2YXRl\nIENvbHVtbltdIF92Y29scyA9IG51bGw7CiAgICBwcml2YXRlIENvbHVtbklP\nIF92aW8gPSBudWxsOwogICAgcHJpdmF0ZSBib29sZWFuIF92bG9hZCA9IGZh\nbHNlOwoKICAgIHB1YmxpYyBDb2x1bW5bXSBnZXRLZXlDb2x1bW5zKENsYXNz\nTWFwcGluZyBjbHMpIHsKICAgICAgICByZXR1cm4gX2tjb2xzOwogICAgfQoK\nICAgIHB1YmxpYyBDb2x1bW5bXSBnZXRWYWx1ZUNvbHVtbnMoQ2xhc3NNYXBw\naW5nIGNscykgewogICAgICAgIHJldHVybiBfdmNvbHM7CiAgICB9CgogICAg\ncHVibGljIHZvaWQgc2VsZWN0S2V5KFNlbGVjdCBzZWwsIENsYXNzTWFwcGlu\nZyBjbHMsIE9wZW5KUEFTdGF0ZU1hbmFnZXIgc20sCiAgICAgICAgSkRCQ1N0\nb3JlIHN0b3JlLCBKREJDRmV0Y2hDb25maWd1cmF0aW9uIGZldGNoLCBKb2lu\ncyBqb2lucykgewogICAgICAgIHNlbC5zZWxlY3QoX2tjb2xzLCBqb2lucyk7\nCiAgICB9CgogICAgcHVibGljIHZvaWQgc2VsZWN0VmFsdWUoU2VsZWN0IHNl\nbCwgQ2xhc3NNYXBwaW5nIGNscywKICAgICAgICBPcGVuSlBBU3RhdGVNYW5h\nZ2VyIHNtLAogICAgICAgIEpEQkNTdG9yZSBzdG9yZSwgSkRCQ0ZldGNoQ29u\nZmlndXJhdGlvbiBmZXRjaCwgSm9pbnMgam9pbnMpIHsKICAgICAgICBzZWwu\nc2VsZWN0KF92Y29scywgam9pbnMpOwogICAgfQoKICAgIHB1YmxpYyBSZXN1\nbHRbXSBnZXRSZXN1bHRzKE9wZW5KUEFTdGF0ZU1hbmFnZXIgc20sIEpEQkNT\ndG9yZSBzdG9yZSwKICAgICAgICBKREJDRmV0Y2hDb25maWd1cmF0aW9uIGZl\ndGNoLCBpbnQgZWFnZXJNb2RlLCBKb2luc1tdIGpvaW5zLCBib29sZWFuIGxy\ncykKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBTZWxl\nY3Qgc2VsID0gc3RvcmUuZ2V0U1FMRmFjdG9yeSgpLm5ld1NlbGVjdCgpOwog\nICAgICAgIHNlbC5zZXRMUlMobHJzKTsKICAgICAgICBzZWwuc2VsZWN0KF9r\nY29scyk7CiAgICAgICAgc2VsLnNlbGVjdChfdmNvbHMpOwogICAgICAgIHNl\nbC53aGVyZUZvcmVpZ25LZXkoZmllbGQuZ2V0Sm9pbkZvcmVpZ25LZXkoKSwg\nc20uZ2V0T2JqZWN0SWQoKSwKICAgICAgICAgICAgZmllbGQuZ2V0RGVmaW5p\nbmdNYXBwaW5nKCksIHN0b3JlKTsKICAgICAgICBSZXN1bHQgcmVzID0gc2Vs\nLmV4ZWN1dGUoc3RvcmUsIGZldGNoKTsKICAgICAgICByZXR1cm4gbmV3IFJl\nc3VsdFtdeyByZXMsIHJlcyB9OwogICAgfQoKICAgIHB1YmxpYyBPYmplY3Qg\nbG9hZEtleShPcGVuSlBBU3RhdGVNYW5hZ2VyIHNtLCBKREJDU3RvcmUgc3Rv\ncmUsCiAgICAgICAgSkRCQ0ZldGNoQ29uZmlndXJhdGlvbiBmZXRjaCwgUmVz\ndWx0IHJlcywgSm9pbnMgam9pbnMpCiAgICAgICAgdGhyb3dzIFNRTEV4Y2Vw\ndGlvbiB7CiAgICAgICAgcmV0dXJuIEhhbmRsZXJTdHJhdGVnaWVzLmxvYWRP\nYmplY3QoZmllbGQuZ2V0S2V5TWFwcGluZygpLAogICAgICAgICAgICBzbSwg\nc3RvcmUsIGZldGNoLCByZXMsIGpvaW5zLCBfa2NvbHMsIF9rbG9hZCk7CiAg\nICB9CgogICAgcHVibGljIE9iamVjdCBsb2FkVmFsdWUoT3BlbkpQQVN0YXRl\nTWFuYWdlciBzbSwgSkRCQ1N0b3JlIHN0b3JlLAogICAgICAgIEpEQkNGZXRj\naENvbmZpZ3VyYXRpb24gZmV0Y2gsIFJlc3VsdCByZXMsIEpvaW5zIGpvaW5z\nKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIHJldHVy\nbiBIYW5kbGVyU3RyYXRlZ2llcy5sb2FkT2JqZWN0KGZpZWxkLmdldEVsZW1l\nbnRNYXBwaW5nKCksCiAgICAgICAgICAgIHNtLCBzdG9yZSwgZmV0Y2gsIHJl\ncywgam9pbnMsIF92Y29scywgX3Zsb2FkKTsKICAgIH0KCiAgICBwdWJsaWMg\ndm9pZCBtYXAoYm9vbGVhbiBhZGFwdCkgewogICAgICAgIHN1cGVyLm1hcChh\nZGFwdCk7CgogICAgICAgIFZhbHVlTWFwcGluZyBrZXkgPSBmaWVsZC5nZXRL\nZXlNYXBwaW5nKCk7CiAgICAgICAgaWYgKGtleS5nZXRIYW5kbGVyKCkgPT0g\nbnVsbCkKICAgICAgICAgICAgdGhyb3cgbmV3IE1ldGFEYXRhRXhjZXB0aW9u\nKF9sb2MuZ2V0KCJuby1oYW5kbGVyIiwga2V5KSk7CiAgICAgICAgVmFsdWVN\nYXBwaW5nIHZhbCA9IGZpZWxkLmdldEVsZW1lbnRNYXBwaW5nKCk7CiAgICAg\nICAgaWYgKHZhbC5nZXRIYW5kbGVyKCkgPT0gbnVsbCkKICAgICAgICAgICAg\ndGhyb3cgbmV3IE1ldGFEYXRhRXhjZXB0aW9uKF9sb2MuZ2V0KCJuby1oYW5k\nbGVyIiwgdmFsKSk7CiAgICAgICAgYXNzZXJ0Tm90TWFwcGVkQnkoKTsKCiAg\nICAgICAgZmllbGQubWFwSm9pbihhZGFwdCwgdHJ1ZSk7CiAgICAgICAgX2tp\nbyA9IG5ldyBDb2x1bW5JTygpOwogICAgICAgIERCRGljdGlvbmFyeSBkaWN0\nID0gZmllbGQuZ2V0TWFwcGluZ1JlcG9zaXRvcnkoKS5nZXREQkRpY3Rpb25h\ncnkoKTsKICAgICAgICBfa2NvbHMgPSBIYW5kbGVyU3RyYXRlZ2llcy5tYXAo\na2V5LCAKICAgICAgICAgICAgZGljdC5nZXRWYWxpZENvbHVtbk5hbWUoImtl\neSIsIGZpZWxkLmdldFRhYmxlKCkpLCBfa2lvLCBhZGFwdCk7CgogICAgICAg\nIF92aW8gPSBuZXcgQ29sdW1uSU8oKTsKICAgICAgICBfdmNvbHMgPSBIYW5k\nbGVyU3RyYXRlZ2llcy5tYXAodmFsLCAidmFsdWUiLCBfdmlvLCBhZGFwdCk7\nCiAgICAgICAgZmllbGQubWFwUHJpbWFyeUtleShhZGFwdCk7CiAgICB9Cgog\nICAgcHVibGljIHZvaWQgaW5pdGlhbGl6ZSgpIHsKICAgICAgICBfa2xvYWQg\nPSBmaWVsZC5nZXRLZXlNYXBwaW5nKCkuZ2V0SGFuZGxlcigpLgogICAgICAg\nICAgICBvYmplY3RWYWx1ZVJlcXVpcmVzTG9hZChmaWVsZC5nZXRLZXlNYXBw\naW5nKCkpOwogICAgICAgIF92bG9hZCA9IGZpZWxkLmdldEVsZW1lbnRNYXBw\naW5nKCkuZ2V0SGFuZGxlcigpLgogICAgICAgICAgICBvYmplY3RWYWx1ZVJl\ncXVpcmVzTG9hZChmaWVsZC5nZXRFbGVtZW50TWFwcGluZygpKTsKICAgIH0K\nCiAgICBwdWJsaWMgdm9pZCBpbnNlcnQoT3BlbkpQQVN0YXRlTWFuYWdlciBz\nbSwgSkRCQ1N0b3JlIHN0b3JlLCBSb3dNYW5hZ2VyIHJtKQogICAgICAgIHRo\ncm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIGluc2VydChzbSwgc3RvcmUs\nIHJtLCAoTWFwKSBzbS5mZXRjaE9iamVjdChmaWVsZC5nZXRJbmRleCgpKSk7\nCiAgICB9CgogICAgcHJpdmF0ZSB2b2lkIGluc2VydChPcGVuSlBBU3RhdGVN\nYW5hZ2VyIHNtLCBKREJDU3RvcmUgc3RvcmUsIFJvd01hbmFnZXIgcm0sCiAg\nICAgICAgTWFwIG1hcCkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsK\nICAgICAgICBpZiAobWFwID09IG51bGwgfHwgbWFwLmlzRW1wdHkoKSkKICAg\nICAgICAgICAgcmV0dXJuOwoKICAgICAgICBSb3cgcm93ID0gcm0uZ2V0U2Vj\nb25kYXJ5Um93KGZpZWxkLmdldFRhYmxlKCksIFJvdy5BQ1RJT05fSU5TRVJU\nKTsKICAgICAgICByb3cuc2V0Rm9yZWlnbktleShmaWVsZC5nZXRKb2luRm9y\nZWlnbktleSgpLCBmaWVsZC5nZXRKb2luQ29sdW1uSU8oKSwKICAgICAgICAg\nICAgc20pOwoKICAgICAgICBWYWx1ZU1hcHBpbmcga2V5ID0gZmllbGQuZ2V0\nS2V5TWFwcGluZygpOwogICAgICAgIFZhbHVlTWFwcGluZyB2YWwgPSBmaWVs\nZC5nZXRFbGVtZW50TWFwcGluZygpOwogICAgICAgIE1hcC5FbnRyeSBlbnRy\neTsKICAgICAgICBmb3IgKEl0ZXJhdG9yIGl0ciA9IG1hcC5lbnRyeVNldCgp\nLml0ZXJhdG9yKCk7IGl0ci5oYXNOZXh0KCk7KSB7CiAgICAgICAgICAgIGVu\ndHJ5ID0gKE1hcC5FbnRyeSkgaXRyLm5leHQoKTsKICAgICAgICAgICAgSGFu\nZGxlclN0cmF0ZWdpZXMuc2V0KGtleSwgZW50cnkuZ2V0S2V5KCksIHN0b3Jl\nLCByb3csIF9rY29scywKICAgICAgICAgICAgICAgIF9raW8sIHRydWUpOwog\nICAgICAgICAgICBIYW5kbGVyU3RyYXRlZ2llcy5zZXQodmFsLCBlbnRyeS5n\nZXRWYWx1ZSgpLCBzdG9yZSwgcm93LCBfdmNvbHMsCiAgICAgICAgICAgICAg\nICBfdmlvLCB0cnVlKTsKICAgICAgICAgICAgcm0uZmx1c2hTZWNvbmRhcnlS\nb3cocm93KTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGljIHZvaWQgdXBk\nYXRlKE9wZW5KUEFTdGF0ZU1hbmFnZXIgc20sIEpEQkNTdG9yZSBzdG9yZSwg\nUm93TWFuYWdlciBybSkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsK\nICAgICAgICBNYXAgbWFwID0gKE1hcCkgc20uZmV0Y2hPYmplY3QoZmllbGQu\nZ2V0SW5kZXgoKSk7CiAgICAgICAgQ2hhbmdlVHJhY2tlciBjdCA9IG51bGw7\nCiAgICAgICAgaWYgKG1hcCBpbnN0YW5jZW9mIFByb3h5KSB7CiAgICAgICAg\nICAgIFByb3h5IHByb3h5ID0gKFByb3h5KSBtYXA7CiAgICAgICAgICAgIGlm\nIChQcm94aWVzLmlzT3duZXIocHJveHksIHNtLCBmaWVsZC5nZXRJbmRleCgp\nKSkKICAgICAgICAgICAgICAgIGN0ID0gcHJveHkuZ2V0Q2hhbmdlVHJhY2tl\ncigpOwogICAgICAgIH0KCiAgICAgICAgLy8gaWYgbm8gZmluZS1ncmFpbmVk\nIGNoYW5nZSB0cmFja2luZyB0aGVuIGp1c3QgZGVsZXRlIGFuZCByZWluc2Vy\ndAogICAgICAgIGlmIChjdCA9PSBudWxsIHx8ICFjdC5pc1RyYWNraW5nKCkp\nIHsKICAgICAgICAgICAgZGVsZXRlKHNtLCBzdG9yZSwgcm0pOwogICAgICAg\nICAgICBpbnNlcnQoc20sIHN0b3JlLCBybSwgbWFwKTsKICAgICAgICAgICAg\ncmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgLy8gZGVsZXRlIHRoZSByZW1v\ndmVzCiAgICAgICAgVmFsdWVNYXBwaW5nIGtleSA9IGZpZWxkLmdldEtleU1h\ncHBpbmcoKTsKICAgICAgICBDb2xsZWN0aW9uIHJlbSA9IGN0LmdldFJlbW92\nZWQoKTsKICAgICAgICBpZiAoIXJlbS5pc0VtcHR5KCkpIHsKICAgICAgICAg\nICAgUm93IGRlbFJvdyA9IHJtLmdldFNlY29uZGFyeVJvdyhmaWVsZC5nZXRU\nYWJsZSgpLAogICAgICAgICAgICAgICAgUm93LkFDVElPTl9ERUxFVEUpOwog\nICAgICAgICAgICBkZWxSb3cud2hlcmVGb3JlaWduS2V5KGZpZWxkLmdldEpv\naW5Gb3JlaWduS2V5KCksIHNtKTsKICAgICAgICAgICAgZm9yIChJdGVyYXRv\nciBpdHIgPSByZW0uaXRlcmF0b3IoKTsgaXRyLmhhc05leHQoKTspIHsKICAg\nICAgICAgICAgICAgIEhhbmRsZXJTdHJhdGVnaWVzLndoZXJlKGtleSwgaXRy\nLm5leHQoKSwgc3RvcmUsIGRlbFJvdywKICAgICAgICAgICAgICAgICAgICBf\na2NvbHMpOwogICAgICAgICAgICAgICAgcm0uZmx1c2hTZWNvbmRhcnlSb3co\nZGVsUm93KTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgLy8g\naW5zZXJ0IHRoZSBhZGRzCiAgICAgICAgVmFsdWVNYXBwaW5nIHZhbCA9IGZp\nZWxkLmdldEVsZW1lbnRNYXBwaW5nKCk7CiAgICAgICAgQ29sbGVjdGlvbiBh\nZGQgPSBjdC5nZXRBZGRlZCgpOwogICAgICAgIE9iamVjdCBta2V5OwogICAg\nICAgIGlmICghYWRkLmlzRW1wdHkoKSkgewogICAgICAgICAgICBSb3cgYWRk\nUm93ID0gcm0uZ2V0U2Vjb25kYXJ5Um93KGZpZWxkLmdldFRhYmxlKCksCiAg\nICAgICAgICAgICAgICBSb3cuQUNUSU9OX0lOU0VSVCk7CiAgICAgICAgICAg\nIGFkZFJvdy5zZXRGb3JlaWduS2V5KGZpZWxkLmdldEpvaW5Gb3JlaWduS2V5\nKCksCiAgICAgICAgICAgICAgICBmaWVsZC5nZXRKb2luQ29sdW1uSU8oKSwg\nc20pOwoKICAgICAgICAgICAgZm9yIChJdGVyYXRvciBpdHIgPSBhZGQuaXRl\ncmF0b3IoKTsgaXRyLmhhc05leHQoKTspIHsKICAgICAgICAgICAgICAgIG1r\nZXkgPSBpdHIubmV4dCgpOwogICAgICAgICAgICAgICAgSGFuZGxlclN0cmF0\nZWdpZXMuc2V0KGtleSwgbWtleSwgc3RvcmUsIGFkZFJvdywgX2tjb2xzLAog\nICAgICAgICAgICAgICAgICAgIF9raW8sIHRydWUpOwogICAgICAgICAgICAg\nICAgSGFuZGxlclN0cmF0ZWdpZXMuc2V0KHZhbCwgbWFwLmdldChta2V5KSwg\nc3RvcmUsIGFkZFJvdywKICAgICAgICAgICAgICAgICAgICBfdmNvbHMsIF92\naW8sIHRydWUpOwogICAgICAgICAgICAgICAgcm0uZmx1c2hTZWNvbmRhcnlS\nb3coYWRkUm93KTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAg\nLy8gdXBkYXRlIHRoZSBjaGFuZ2VzCiAgICAgICAgQ29sbGVjdGlvbiBjaGFu\nZ2UgPSBjdC5nZXRDaGFuZ2VkKCk7CiAgICAgICAgaWYgKCFjaGFuZ2UuaXNF\nbXB0eSgpKSB7CiAgICAgICAgICAgIFJvdyBjaGFuZ2VSb3cgPSBybS5nZXRT\nZWNvbmRhcnlSb3coZmllbGQuZ2V0VGFibGUoKSwKICAgICAgICAgICAgICAg\nIFJvdy5BQ1RJT05fVVBEQVRFKTsKICAgICAgICAgICAgY2hhbmdlUm93Lndo\nZXJlRm9yZWlnbktleShmaWVsZC5nZXRKb2luRm9yZWlnbktleSgpLCBzbSk7\nCgogICAgICAgICAgICBmb3IgKEl0ZXJhdG9yIGl0ciA9IGNoYW5nZS5pdGVy\nYXRvcigpOyBpdHIuaGFzTmV4dCgpOykgewogICAgICAgICAgICAgICAgbWtl\neSA9IGl0ci5uZXh0KCk7CiAgICAgICAgICAgICAgICBIYW5kbGVyU3RyYXRl\nZ2llcy53aGVyZShrZXksIG1rZXksIHN0b3JlLCBjaGFuZ2VSb3csIF9rY29s\ncyk7CiAgICAgICAgICAgICAgICBIYW5kbGVyU3RyYXRlZ2llcy5zZXQodmFs\nLCBtYXAuZ2V0KG1rZXkpLCBzdG9yZSwgY2hhbmdlUm93LAogICAgICAgICAg\nICAgICAgICAgIF92Y29scywgX3ZpbywgdHJ1ZSk7CiAgICAgICAgICAgICAg\nICBybS5mbHVzaFNlY29uZGFyeVJvdyhjaGFuZ2VSb3cpOwogICAgICAgICAg\nICB9CiAgICAgICAgfQogICAgfQoKICAgIHB1YmxpYyBPYmplY3QgdG9EYXRh\nU3RvcmVWYWx1ZShPYmplY3QgdmFsLCBKREJDU3RvcmUgc3RvcmUpIHsKICAg\nICAgICByZXR1cm4gSGFuZGxlclN0cmF0ZWdpZXMudG9EYXRhU3RvcmVWYWx1\nZShmaWVsZC5nZXRFbGVtZW50TWFwcGluZygpLAogICAgICAgICAgICB2YWws\nIF92Y29scywgc3RvcmUpOwogICAgfQoKICAgIHB1YmxpYyBPYmplY3QgdG9L\nZXlEYXRhU3RvcmVWYWx1ZShPYmplY3QgdmFsLCBKREJDU3RvcmUgc3RvcmUp\nIHsKICAgICAgICByZXR1cm4gSGFuZGxlclN0cmF0ZWdpZXMudG9EYXRhU3Rv\ncmVWYWx1ZShmaWVsZC5nZXRLZXlNYXBwaW5nKCksIHZhbCwKICAgICAgICAg\nICAgX2tjb2xzLCBzdG9yZSk7CiAgICB9CgogICAgcHVibGljIEpvaW5zIGpv\naW5SZWxhdGlvbihKb2lucyBqb2lucywgYm9vbGVhbiBmb3JjZU91dGVyLAog\nICAgICAgIGJvb2xlYW4gdHJhdmVyc2UpIHsKICAgICAgICBpZiAodHJhdmVy\nc2UpCiAgICAgICAgICAgIEhhbmRsZXJTdHJhdGVnaWVzLmFzc2VydEpvaW5h\nYmxlKGZpZWxkLmdldEVsZW1lbnRNYXBwaW5nKCkpOwogICAgICAgIHJldHVy\nbiBqb2luczsKICAgIH0KCiAgICBwdWJsaWMgSm9pbnMgam9pbktleVJlbGF0\naW9uKEpvaW5zIGpvaW5zLCBib29sZWFuIGZvcmNlT3V0ZXIsCiAgICAgICAg\nYm9vbGVhbiB0cmF2ZXJzZSkgewogICAgICAgIGlmICh0cmF2ZXJzZSkKICAg\nICAgICAgICAgSGFuZGxlclN0cmF0ZWdpZXMuYXNzZXJ0Sm9pbmFibGUoZmll\nbGQuZ2V0S2V5TWFwcGluZygpKTsKICAgICAgICByZXR1cm4gam9pbnM7CiAg\nICB9Cn0K\n","encoding":"base64"}

