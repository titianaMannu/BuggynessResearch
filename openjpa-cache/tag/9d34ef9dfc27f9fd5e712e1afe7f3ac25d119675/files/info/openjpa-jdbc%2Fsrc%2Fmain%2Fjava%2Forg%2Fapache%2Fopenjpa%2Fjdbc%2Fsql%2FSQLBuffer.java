{"sha":"307194c2a4c15d745ab990880ea9a56bddbe8e48","node_id":"MDQ6QmxvYjIwNjM2NDozMDcxOTRjMmE0YzE1ZDc0NWFiOTkwODgwZWE5YTU2YmRkYmU4ZTQ4","size":20728,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/307194c2a4c15d745ab990880ea9a56bddbe8e48","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zcWw7CgppbXBvcnQg\namF2YS5pby5TZXJpYWxpemFibGU7CmltcG9ydCBqYXZhLnNxbC5DYWxsYWJs\nZVN0YXRlbWVudDsKaW1wb3J0IGphdmEuc3FsLkNvbm5lY3Rpb247CmltcG9y\ndCBqYXZhLnNxbC5QcmVwYXJlZFN0YXRlbWVudDsKaW1wb3J0IGphdmEuc3Fs\nLlJlc3VsdFNldDsKaW1wb3J0IGphdmEuc3FsLlNRTEV4Y2VwdGlvbjsKaW1w\nb3J0IGphdmEudXRpbC5BcnJheUxpc3Q7CmltcG9ydCBqYXZhLnV0aWwuQ29s\nbGVjdGlvbnM7CmltcG9ydCBqYXZhLnV0aWwuSXRlcmF0b3I7CmltcG9ydCBq\nYXZhLnV0aWwuTGlzdDsKCmltcG9ydCBvcmcuYXBhY2hlLmNvbW1vbnMubGFu\nZy5PYmplY3RVdGlsczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJj\nLmtlcm5lbC5KREJDRmV0Y2hDb25maWd1cmF0aW9uOwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLmpkYmMua2VybmVsLmV4cHMuVmFsOwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1hLkNvbHVtbjsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNjaGVtYS5Gb3JlaWduS2V5OwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1hLlNlcXVlbmNlOwpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1hLlRhYmxlOwpp\nbXBvcnQgc2VycC51dGlsLk51bWJlcnM7CgovKioKICogQnVmZmVyIGZvciBT\nUUwgc3RhdGVtZW50cyB0aGF0IGNhbiBiZSB1c2VkIHRvIGNyZWF0ZQogKiBq\nYXZhLnNxbC5QcmVwYXJlZFN0YXRlbWVudHMuCiAqCiAqIEBhdXRob3IgTWFy\nYyBQcnVkJ2hvbW1lYXV4CiAqIEBhdXRob3IgQWJlIFdoaXRlCiAqIEBzaW5j\nZSAwLjIuNAogKi8KcHVibGljIGZpbmFsIGNsYXNzIFNRTEJ1ZmZlcgogICAg\naW1wbGVtZW50cyBTZXJpYWxpemFibGUsIENsb25lYWJsZSB7CgogICAgcHJp\ndmF0ZSBzdGF0aWMgZmluYWwgU3RyaW5nIFBBUkFNRVRFUl9UT0tFTiA9ICI/\nIjsKCiAgICBwcml2YXRlIGZpbmFsIERCRGljdGlvbmFyeSBfZGljdDsKICAg\nIHByaXZhdGUgZmluYWwgU3RyaW5nQnVpbGRlciBfc3FsID0gbmV3IFN0cmlu\nZ0J1aWxkZXIoKTsKICAgIHByaXZhdGUgTGlzdCBfc3Vic2VscyA9IG51bGw7\nCiAgICBwcml2YXRlIExpc3QgX3BhcmFtcyA9IG51bGw7CiAgICBwcml2YXRl\nIExpc3QgX2NvbHMgPSBudWxsOwoKICAgIC8qKgogICAgICogRGVmYXVsdCBj\nb25zdHJ1Y3Rvci4KICAgICAqLwogICAgcHVibGljIFNRTEJ1ZmZlcihEQkRp\nY3Rpb25hcnkgZGljdCkgewogICAgICAgIF9kaWN0ID0gZGljdDsKICAgIH0K\nCiAgICAvKioKICAgICAqIENvcHkgY29uc3RydWN0b3IuCiAgICAgKi8KICAg\nIHB1YmxpYyBTUUxCdWZmZXIoU1FMQnVmZmVyIGJ1ZikgewogICAgICAgIF9k\naWN0ID0gYnVmLl9kaWN0OwogICAgICAgIGFwcGVuZChidWYpOwogICAgfQoK\nICAgIC8qKgogICAgICogUGVyZm9ybSBhIHNoYWxsb3cgY2xvbmUgb2YgdGhp\ncyBTUUwgQnVmZmVyLgogICAgICovCiAgICBwdWJsaWMgT2JqZWN0IGNsb25l\nKCkgewogICAgICAgIHJldHVybiBuZXcgU1FMQnVmZmVyKHRoaXMpOwogICAg\nfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRydWUgaWYgdGhlIGJ1ZmZlciBp\ncyBlbXRweS4KICAgICAqLwogICAgcHVibGljIGJvb2xlYW4gaXNFbXB0eSgp\nIHsKICAgICAgICByZXR1cm4gX3NxbC5sZW5ndGgoKSA9PSAwOwogICAgfQoK\nICAgIC8qKgogICAgICogQXBwZW5kIGFsbCBTUUwgYW5kIHBhcmFtZXRlcnMg\nb2YgdGhlIGdpdmVuIGJ1ZmZlci4KICAgICAqLwogICAgcHVibGljIFNRTEJ1\nZmZlciBhcHBlbmQoU1FMQnVmZmVyIGJ1ZikgewogICAgICAgIGFwcGVuZChi\ndWYsIF9zcWwubGVuZ3RoKCksIChfcGFyYW1zID09IG51bGwpID8gMCA6IF9w\nYXJhbXMuc2l6ZSgpLAogICAgICAgICAgICB0cnVlKTsKICAgICAgICByZXR1\ncm4gdGhpczsKICAgIH0KCiAgICAvKioKICAgICAqIEFwcGVuZCBhbGwgU1FM\nIGFuZCBwYXJhbWV0ZXJzIG9mIHRoZSBnaXZlbiBidWZmZXIgYXQgdGhlIGdp\ndmVuIHBvc2l0aW9ucy4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIGFwcGVu\nZChTUUxCdWZmZXIgYnVmLCBpbnQgc3FsSW5kZXgsIGludCBwYXJhbUluZGV4\nLAogICAgICAgIGJvb2xlYW4gc3Vic2VscykgewogICAgICAgIGlmIChzdWJz\nZWxzKSB7CiAgICAgICAgICAgIC8vIG9ubHkgYWxsb3cgYXBwZW5kaW5nIG9m\nIGJ1ZmZlcnMgd2l0aCBzdWJzZWxlY3RzLCBub3QgaW5zZXJ0aW9uCiAgICAg\nICAgICAgIGlmIChfc3Vic2VscyAhPSBudWxsICYmICFfc3Vic2Vscy5pc0Vt\ncHR5KCkKICAgICAgICAgICAgICAgICYmIHNxbEluZGV4ICE9IF9zcWwubGVu\nZ3RoKCkpCiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbFN0YXRl\nRXhjZXB0aW9uKCk7CiAgICAgICAgICAgIGlmIChidWYuX3N1YnNlbHMgIT0g\nbnVsbCAmJiAhYnVmLl9zdWJzZWxzLmlzRW1wdHkoKSkgewogICAgICAgICAg\nICAgICAgaWYgKHNxbEluZGV4ICE9IF9zcWwubGVuZ3RoKCkpCiAgICAgICAg\nICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxTdGF0ZUV4Y2VwdGlvbigp\nOwogICAgICAgICAgICAgICAgaWYgKF9zdWJzZWxzID09IG51bGwpCiAgICAg\nICAgICAgICAgICAgICAgX3N1YnNlbHMgPSBuZXcgQXJyYXlMaXN0KGJ1Zi5f\nc3Vic2Vscy5zaXplKCkpOwogICAgICAgICAgICAgICAgZm9yIChpbnQgaSA9\nIDA7IGkgPCBidWYuX3N1YnNlbHMuc2l6ZSgpOyBpKyspCiAgICAgICAgICAg\nICAgICAgICAgX3N1YnNlbHMuYWRkKCgoU3Vic2VsZWN0KSBidWYuX3N1YnNl\nbHMuZ2V0KGkpKS4KICAgICAgICAgICAgICAgICAgICAgICAgY2xvbmUoc3Fs\nSW5kZXgsIHBhcmFtSW5kZXgpKTsKICAgICAgICAgICAgfQogICAgICAgIH0K\nCiAgICAgICAgaWYgKHNxbEluZGV4ID09IF9zcWwubGVuZ3RoKCkpCiAgICAg\nICAgICAgIF9zcWwuYXBwZW5kKGJ1Zi5fc3FsLnRvU3RyaW5nKCkpOwogICAg\nICAgIGVsc2UKICAgICAgICAgICAgX3NxbC5pbnNlcnQoc3FsSW5kZXgsIGJ1\nZi5fc3FsLnRvU3RyaW5nKCkpOwoKICAgICAgICBpZiAoYnVmLl9wYXJhbXMg\nIT0gbnVsbCkgewogICAgICAgICAgICBpZiAoX3BhcmFtcyA9PSBudWxsKQog\nICAgICAgICAgICAgICAgX3BhcmFtcyA9IG5ldyBBcnJheUxpc3QoKTsKICAg\nICAgICAgICAgaWYgKF9jb2xzID09IG51bGwgJiYgYnVmLl9jb2xzICE9IG51\nbGwpIHsKICAgICAgICAgICAgICAgIF9jb2xzID0gbmV3IEFycmF5TGlzdCgp\nOwogICAgICAgICAgICAgICAgd2hpbGUgKF9jb2xzLnNpemUoKSA8IF9wYXJh\nbXMuc2l6ZSgpKQogICAgICAgICAgICAgICAgICAgIF9jb2xzLmFkZChudWxs\nKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKHBhcmFtSW5kZXgg\nPT0gX3BhcmFtcy5zaXplKCkpIHsKICAgICAgICAgICAgICAgIF9wYXJhbXMu\nYWRkQWxsKGJ1Zi5fcGFyYW1zKTsKICAgICAgICAgICAgICAgIGlmIChidWYu\nX2NvbHMgIT0gbnVsbCkKICAgICAgICAgICAgICAgICAgICBfY29scy5hZGRB\nbGwoYnVmLl9jb2xzKTsKICAgICAgICAgICAgICAgIGVsc2UgaWYgKF9jb2xz\nICE9IG51bGwpCiAgICAgICAgICAgICAgICAgICAgd2hpbGUgKF9jb2xzLnNp\nemUoKSA8IF9wYXJhbXMuc2l6ZSgpKQogICAgICAgICAgICAgICAgICAgICAg\nICBfY29scy5hZGQobnVsbCk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAg\nICAgICAgICAgICBfcGFyYW1zLmFkZEFsbChwYXJhbUluZGV4LCBidWYuX3Bh\ncmFtcyk7CiAgICAgICAgICAgICAgICBpZiAoYnVmLl9jb2xzICE9IG51bGwp\nCiAgICAgICAgICAgICAgICAgICAgX2NvbHMuYWRkQWxsKHBhcmFtSW5kZXgs\nIGJ1Zi5fY29scyk7CiAgICAgICAgICAgICAgICBlbHNlIGlmIChfY29scyAh\nPSBudWxsKQogICAgICAgICAgICAgICAgICAgIHdoaWxlIChfY29scy5zaXpl\nKCkgPCBfcGFyYW1zLnNpemUoKSkKICAgICAgICAgICAgICAgICAgICAgICAg\nX2NvbHMuYWRkKHBhcmFtSW5kZXgsIG51bGwpOwogICAgICAgICAgICB9CiAg\nICAgICAgfQogICAgfQoKICAgIHB1YmxpYyBTUUxCdWZmZXIgYXBwZW5kKFRh\nYmxlIHRhYmxlKSB7CiAgICAgICAgX3NxbC5hcHBlbmQoX2RpY3QuZ2V0RnVs\nbE5hbWUodGFibGUsIGZhbHNlKSk7CiAgICAgICAgcmV0dXJuIHRoaXM7CiAg\nICB9CgogICAgcHVibGljIFNRTEJ1ZmZlciBhcHBlbmQoU2VxdWVuY2Ugc2Vx\nKSB7CiAgICAgICAgX3NxbC5hcHBlbmQoX2RpY3QuZ2V0RnVsbE5hbWUoc2Vx\nKSk7CiAgICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CgogICAgcHVibGljIFNR\nTEJ1ZmZlciBhcHBlbmQoQ29sdW1uIGNvbCkgewogICAgICAgIF9zcWwuYXBw\nZW5kKGNvbC5nZXROYW1lKCkpOwogICAgICAgIHJldHVybiB0aGlzOwogICAg\nfQoKICAgIHB1YmxpYyBTUUxCdWZmZXIgYXBwZW5kKFN0cmluZyBzKSB7CiAg\nICAgICAgX3NxbC5hcHBlbmQocyk7CiAgICAgICAgcmV0dXJuIHRoaXM7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBBcHBlbmQgYSBzdWJzZWxlY3QuIFRoaXMg\nZGVsYXlzIHJlc29sdXRpb24gb2YgdGhlIHNlbGVjdCBTUUwuCiAgICAgKi8K\nICAgIHB1YmxpYyBTUUxCdWZmZXIgYXBwZW5kKFNlbGVjdCBzZWwsIEpEQkNG\nZXRjaENvbmZpZ3VyYXRpb24gZmV0Y2gpIHsKICAgICAgICByZXR1cm4gYXBw\nZW5kKHNlbCwgZmV0Y2gsIGZhbHNlKTsKICAgIH0KCiAgICAvKioKICAgICAq\nIEFwcGVuZCBhIHN1YnNlbGVjdCBjb3VudC4gVGhpcyBkZWxheXMgcmVzb2x1\ndGlvbiBvZiB0aGUgc2VsZWN0IFNRTC4KICAgICAqLwogICAgcHVibGljIFNR\nTEJ1ZmZlciBhcHBlbmRDb3VudChTZWxlY3Qgc2VsLCBKREJDRmV0Y2hDb25m\naWd1cmF0aW9uIGZldGNoKSB7CiAgICAgICAgcmV0dXJuIGFwcGVuZChzZWws\nIGZldGNoLCB0cnVlKTsKICAgIH0KCiAgICAvKioKICAgICAqIEFwcGVuZCBh\nIHN1YnNlbGVjdC4gVGhpcyBkZWxheXMgcmVzb2x1dGlvbiBvZiB0aGUgc2Vs\nZWN0IFNRTC4KICAgICAqLwogICAgcHJpdmF0ZSBTUUxCdWZmZXIgYXBwZW5k\nKFNlbGVjdCBzZWwsIEpEQkNGZXRjaENvbmZpZ3VyYXRpb24gZmV0Y2gsCiAg\nICAgICAgYm9vbGVhbiBjb3VudCkgewogICAgICAgIF9zcWwuYXBwZW5kKCIo\nIik7CiAgICAgICAgU3Vic2VsZWN0IHN1YiA9IG5ldyBTdWJzZWxlY3QoKTsK\nICAgICAgICBzdWIuc2VsZWN0ID0gc2VsOwogICAgICAgIHN1Yi5mZXRjaCA9\nIGZldGNoOwogICAgICAgIHN1Yi5jb3VudCA9IGNvdW50OwogICAgICAgIHN1\nYi5zcWxJbmRleCA9IF9zcWwubGVuZ3RoKCk7CiAgICAgICAgc3ViLnBhcmFt\nSW5kZXggPSAoX3BhcmFtcyA9PSBudWxsKSA/IDAgOiBfcGFyYW1zLnNpemUo\nKTsKICAgICAgICBfc3FsLmFwcGVuZCgiKSIpOwoKICAgICAgICBpZiAoX3N1\nYnNlbHMgPT0gbnVsbCkKICAgICAgICAgICAgX3N1YnNlbHMgPSBuZXcgQXJy\nYXlMaXN0KDIpOwogICAgICAgIF9zdWJzZWxzLmFkZChzdWIpOwogICAgICAg\nIHJldHVybiB0aGlzOwogICAgfQoKICAgIC8qKgogICAgICogUmVwbGFjZSBh\nIHN1YnNlbGVjdC4KICAgICAqLwogICAgcHVibGljIGJvb2xlYW4gcmVwbGFj\nZShTZWxlY3Qgb2xkLCBTZWxlY3Qgc2VsKSB7CiAgICAgICAgaWYgKF9zdWJz\nZWxzID09IG51bGwpCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAg\nICBTdWJzZWxlY3Qgc3ViOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwg\nX3N1YnNlbHMuc2l6ZSgpOyBpKyspIHsKICAgICAgICAgICAgc3ViID0gKFN1\nYnNlbGVjdCkgX3N1YnNlbHMuZ2V0KGkpOwogICAgICAgICAgICBpZiAoc3Vi\nLnNlbGVjdCA9PSBvbGQpIHsKICAgICAgICAgICAgICAgIHN1Yi5zZWxlY3Qg\nPSBzZWw7CiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAg\nICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4gZmFsc2U7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBBcHBlbmQgYSBwYXJhbWV0ZXIgdmFsdWUuCiAgICAg\nKi8KICAgIHB1YmxpYyBTUUxCdWZmZXIgYXBwZW5kVmFsdWUoT2JqZWN0IG8p\nIHsKICAgICAgICByZXR1cm4gYXBwZW5kVmFsdWUobywgbnVsbCk7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBBcHBlbmQgYSBwYXJhbWV0ZXIgdmFsdWUgZm9y\nIGEgc3BlY2lmaWMgY29sdW1uLgogICAgICovCiAgICBwdWJsaWMgU1FMQnVm\nZmVyIGFwcGVuZFZhbHVlKE9iamVjdCBvLCBDb2x1bW4gY29sKSB7CiAgICAg\nICAgaWYgKG8gPT0gbnVsbCkKICAgICAgICAgICAgX3NxbC5hcHBlbmQoIk5V\nTEwiKTsKICAgICAgICBlbHNlIGlmIChvIGluc3RhbmNlb2YgUmF3KQogICAg\nICAgICAgICBfc3FsLmFwcGVuZChvLnRvU3RyaW5nKCkpOwogICAgICAgIGVs\nc2UgewogICAgICAgICAgICBfc3FsLmFwcGVuZChQQVJBTUVURVJfVE9LRU4p\nOwoKICAgICAgICAgICAgLy8gaW5pdGlhbGl6ZSBwYXJhbSBhbmQgY29sIGxp\nc3RzOyB3ZSBob2xkIG9mZiBvbiBjb2wgbGlzdCB1bnRpbAogICAgICAgICAg\nICAvLyB3ZSBnZXQgdGhlIGZpcnN0IG5vbi1udWxsIGNvbAogICAgICAgICAg\nICBpZiAoX3BhcmFtcyA9PSBudWxsKQogICAgICAgICAgICAgICAgX3BhcmFt\ncyA9IG5ldyBBcnJheUxpc3QoKTsKICAgICAgICAgICAgaWYgKGNvbCAhPSBu\ndWxsICYmIF9jb2xzID09IG51bGwpIHsKICAgICAgICAgICAgICAgIF9jb2xz\nID0gbmV3IEFycmF5TGlzdCgpOwogICAgICAgICAgICAgICAgd2hpbGUgKF9j\nb2xzLnNpemUoKSA8IF9wYXJhbXMuc2l6ZSgpKQogICAgICAgICAgICAgICAg\nICAgIF9jb2xzLmFkZChudWxsKTsKICAgICAgICAgICAgfQoKICAgICAgICAg\nICAgX3BhcmFtcy5hZGQobyk7CiAgICAgICAgICAgIGlmIChfY29scyAhPSBu\ndWxsKQogICAgICAgICAgICAgICAgX2NvbHMuYWRkKGNvbCk7CiAgICAgICAg\nICAgIGlmIChjb2wgPT0gbnVsbCkKICAgICAgICAgICAgICAgIHJldHVybiB0\naGlzOwogICAgICAgICAgICBib29sZWFuIGlzRksgPSBmYWxzZTsKICAgICAg\nICAgICAgRm9yZWlnbktleVtdIGZrcyA9IGNvbC5nZXRUYWJsZSgpLmdldEZv\ncmVpZ25LZXlzKCk7CiAgICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwg\nZmtzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgICBDb2x1bW5bXSBj\nb2xzID0gZmtzW2ldLmdldENvbHVtbnMoKTsKICAgICAgICAgICAgICAgIGZv\nciAoaW50IGogPSAwOyBqIDwgY29scy5sZW5ndGg7IGorKykgewogICAgICAg\nICAgICAgICAgICAgIGlmIChjb2xzW2pdID09IGNvbCkgewogICAgICAgICAg\nICAgICAgICAgICAgICBpc0ZLID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAg\nICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAg\nICAgICAgfQogICAgICAgICAgICAgICAgaWYgKGlzRkspCiAgICAgICAgICAg\nICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAg\nICAgcmV0dXJuIHRoaXM7CiAgICB9CgogICAgLyoqCiAgICAgKiBBcHBlbmQg\nYSBwYXJhbWV0ZXIgdmFsdWUuCiAgICAgKi8KICAgIHB1YmxpYyBTUUxCdWZm\nZXIgYXBwZW5kVmFsdWUoYm9vbGVhbiBiKSB7CiAgICAgICAgcmV0dXJuIGFw\ncGVuZFZhbHVlKGIsIG51bGwpOwogICAgfQoKICAgIC8qKgogICAgICogQXBw\nZW5kIGEgcGFyYW1ldGVyIHZhbHVlLgogICAgICovCiAgICBwdWJsaWMgU1FM\nQnVmZmVyIGFwcGVuZFZhbHVlKGJvb2xlYW4gYiwgQ29sdW1uIGNvbCkgewog\nICAgICAgIHJldHVybiBhcHBlbmRWYWx1ZSgoYikgPyBCb29sZWFuLlRSVUUg\nOiBCb29sZWFuLkZBTFNFLCBjb2wpOwogICAgfQoKICAgIC8qKgogICAgICog\nQXBwZW5kIGEgcGFyYW1ldGVyIHZhbHVlLgogICAgICovCiAgICBwdWJsaWMg\nU1FMQnVmZmVyIGFwcGVuZFZhbHVlKGJ5dGUgYikgewogICAgICAgIHJldHVy\nbiBhcHBlbmRWYWx1ZShiLCBudWxsKTsKICAgIH0KCiAgICAvKioKICAgICAq\nIEFwcGVuZCBhIHBhcmFtZXRlciB2YWx1ZS4KICAgICAqLwogICAgcHVibGlj\nIFNRTEJ1ZmZlciBhcHBlbmRWYWx1ZShieXRlIGIsIENvbHVtbiBjb2wpIHsK\nICAgICAgICByZXR1cm4gYXBwZW5kVmFsdWUobmV3IEJ5dGUoYiksIGNvbCk7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBBcHBlbmQgYSBwYXJhbWV0ZXIgdmFs\ndWUuCiAgICAgKi8KICAgIHB1YmxpYyBTUUxCdWZmZXIgYXBwZW5kVmFsdWUo\nY2hhciBjKSB7CiAgICAgICAgcmV0dXJuIGFwcGVuZFZhbHVlKGMsIG51bGwp\nOwogICAgfQoKICAgIC8qKgogICAgICogQXBwZW5kIGEgcGFyYW1ldGVyIHZh\nbHVlLgogICAgICovCiAgICBwdWJsaWMgU1FMQnVmZmVyIGFwcGVuZFZhbHVl\nKGNoYXIgYywgQ29sdW1uIGNvbCkgewogICAgICAgIHJldHVybiBhcHBlbmRW\nYWx1ZShuZXcgQ2hhcmFjdGVyKGMpLCBjb2wpOwogICAgfQoKICAgIC8qKgog\nICAgICogQXBwZW5kIGEgcGFyYW1ldGVyIHZhbHVlLgogICAgICovCiAgICBw\ndWJsaWMgU1FMQnVmZmVyIGFwcGVuZFZhbHVlKGRvdWJsZSBkKSB7CiAgICAg\nICAgcmV0dXJuIGFwcGVuZFZhbHVlKGQsIG51bGwpOwogICAgfQoKICAgIC8q\nKgogICAgICogQXBwZW5kIGEgcGFyYW1ldGVyIHZhbHVlLgogICAgICovCiAg\nICBwdWJsaWMgU1FMQnVmZmVyIGFwcGVuZFZhbHVlKGRvdWJsZSBkLCBDb2x1\nbW4gY29sKSB7CiAgICAgICAgcmV0dXJuIGFwcGVuZFZhbHVlKG5ldyBEb3Vi\nbGUoZCksIGNvbCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBBcHBlbmQgYSBw\nYXJhbWV0ZXIgdmFsdWUuCiAgICAgKi8KICAgIHB1YmxpYyBTUUxCdWZmZXIg\nYXBwZW5kVmFsdWUoZmxvYXQgZikgewogICAgICAgIHJldHVybiBhcHBlbmRW\nYWx1ZShmLCBudWxsKTsKICAgIH0KCiAgICAvKioKICAgICAqIEFwcGVuZCBh\nIHBhcmFtZXRlciB2YWx1ZS4KICAgICAqLwogICAgcHVibGljIFNRTEJ1ZmZl\nciBhcHBlbmRWYWx1ZShmbG9hdCBmLCBDb2x1bW4gY29sKSB7CiAgICAgICAg\ncmV0dXJuIGFwcGVuZFZhbHVlKG5ldyBGbG9hdChmKSwgY29sKTsKICAgIH0K\nCiAgICAvKioKICAgICAqIEFwcGVuZCBhIHBhcmFtZXRlciB2YWx1ZS4KICAg\nICAqLwogICAgcHVibGljIFNRTEJ1ZmZlciBhcHBlbmRWYWx1ZShpbnQgaSkg\newogICAgICAgIHJldHVybiBhcHBlbmRWYWx1ZShpLCBudWxsKTsKICAgIH0K\nCiAgICAvKioKICAgICAqIEFwcGVuZCBhIHBhcmFtZXRlciB2YWx1ZS4KICAg\nICAqLwogICAgcHVibGljIFNRTEJ1ZmZlciBhcHBlbmRWYWx1ZShpbnQgaSwg\nQ29sdW1uIGNvbCkgewogICAgICAgIHJldHVybiBhcHBlbmRWYWx1ZShOdW1i\nZXJzLnZhbHVlT2YoaSksIGNvbCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBB\ncHBlbmQgYSBwYXJhbWV0ZXIgdmFsdWUuCiAgICAgKi8KICAgIHB1YmxpYyBT\nUUxCdWZmZXIgYXBwZW5kVmFsdWUobG9uZyBsKSB7CiAgICAgICAgcmV0dXJu\nIGFwcGVuZFZhbHVlKGwsIG51bGwpOwogICAgfQoKICAgIC8qKgogICAgICog\nQXBwZW5kIGEgcGFyYW1ldGVyIHZhbHVlLgogICAgICovCiAgICBwdWJsaWMg\nU1FMQnVmZmVyIGFwcGVuZFZhbHVlKGxvbmcgbCwgQ29sdW1uIGNvbCkgewog\nICAgICAgIHJldHVybiBhcHBlbmRWYWx1ZShOdW1iZXJzLnZhbHVlT2YobCks\nIGNvbCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBBcHBlbmQgYSBwYXJhbWV0\nZXIgdmFsdWUuCiAgICAgKi8KICAgIHB1YmxpYyBTUUxCdWZmZXIgYXBwZW5k\nVmFsdWUoc2hvcnQgcykgewogICAgICAgIHJldHVybiBhcHBlbmRWYWx1ZShz\nLCBudWxsKTsKICAgIH0KCiAgICAvKioKICAgICAqIEFwcGVuZCBhIHBhcmFt\nZXRlciB2YWx1ZS4KICAgICAqLwogICAgcHVibGljIFNRTEJ1ZmZlciBhcHBl\nbmRWYWx1ZShzaG9ydCBzLCBDb2x1bW4gY29sKSB7CiAgICAgICAgcmV0dXJu\nIGFwcGVuZFZhbHVlKG5ldyBTaG9ydChzKSwgY29sKTsKICAgIH0KCiAgICAv\nKioKICAgICAqIFJldHVybiB0aGUgbGlzdCBvZiBwYXJhbWV0ZXIgdmFsdWVz\nLgogICAgICovCiAgICBwdWJsaWMgTGlzdCBnZXRQYXJhbWV0ZXJzKCkgewog\nICAgICAgIHJldHVybiAoX3BhcmFtcyA9PSBudWxsKSA/IENvbGxlY3Rpb25z\nLkVNUFRZX0xJU1QgOiBfcGFyYW1zOwogICAgfQoKICAgIC8qKgogICAgICog\nUmV0dXJuIHRoZSBTUUwgZm9yIHRoaXMgYnVmZmVyLgogICAgICovCiAgICBw\ndWJsaWMgU3RyaW5nIGdldFNRTCgpIHsKICAgICAgICByZXR1cm4gZ2V0U1FM\nKGZhbHNlKTsKICAgIH0KICAgIAogICAgLyoqCiAgICAgKiBSZXR1cm5zIHRo\nZSBTUUwgZm9yIHRoaXMgYnVmZmVyLgogICAgICoKICAgICAqIEBwYXJhbSBy\nZXBsYWNlUGFyYW1zIGlmIHRydWUsIHRoZW4gcmVwbGFjZSBwYXJhbWV0ZXJz\nIHdpdGggdGhlCiAgICAgKiBhY3R1YWwgcGFyYW1ldGVyIHZhbHVlcwogICAg\nICovCiAgICBwdWJsaWMgU3RyaW5nIGdldFNRTChib29sZWFuIHJlcGxhY2VQ\nYXJhbXMpIHsKICAgICAgICByZXNvbHZlU3Vic2VsZWN0cygpOwogICAgICAg\nIFN0cmluZyBzcWwgPSBfc3FsLnRvU3RyaW5nKCk7CiAgICAgICAgaWYgKCFy\nZXBsYWNlUGFyYW1zIHx8IF9wYXJhbXMgPT0gbnVsbCB8fCBfcGFyYW1zLmlz\nRW1wdHkoKSkKICAgICAgICAgICAgcmV0dXJuIHNxbDsKCiAgICAgICAgU3Ry\naW5nQnVpbGRlciBidWYgPSBuZXcgU3RyaW5nQnVpbGRlcigpOwogICAgICAg\nIEl0ZXJhdG9yIHBpID0gX3BhcmFtcy5pdGVyYXRvcigpOwogICAgICAgIGZv\nciAoaW50IGkgPSAwOyBpIDwgc3FsLmxlbmd0aCgpOyBpKyspIHsKICAgICAg\nICAgICAgaWYgKHNxbC5jaGFyQXQoaSkgIT0gJz8nKSB7CiAgICAgICAgICAg\nICAgICBidWYuYXBwZW5kKHNxbC5jaGFyQXQoaSkpOwogICAgICAgICAgICAg\nICAgY29udGludWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIE9iamVj\ndCBwYXJhbSA9IHBpLmhhc05leHQoKSA/IHBpLm5leHQoKSA6IG51bGw7CiAg\nICAgICAgICAgIGlmIChwYXJhbSA9PSBudWxsKQogICAgICAgICAgICAgICAg\nYnVmLmFwcGVuZCgiTlVMTCIpOwogICAgICAgICAgICBlbHNlIGlmIChwYXJh\nbSBpbnN0YW5jZW9mIE51bWJlciB8fCBwYXJhbSBpbnN0YW5jZW9mIEJvb2xl\nYW4pCiAgICAgICAgICAgICAgICBidWYuYXBwZW5kKHBhcmFtKTsKICAgICAg\nICAgICAgZWxzZSBpZiAocGFyYW0gaW5zdGFuY2VvZiBTdHJpbmcgfHwgcGFy\nYW0gaW5zdGFuY2VvZiBDaGFyYWN0ZXIpCiAgICAgICAgICAgICAgICBidWYu\nYXBwZW5kKCInIikuYXBwZW5kKHBhcmFtKS5hcHBlbmQoIiciKTsKICAgICAg\nICAgICAgZWxzZQogICAgICAgICAgICAgICAgYnVmLmFwcGVuZCgiPyIpOwog\nICAgICAgIH0KICAgICAgICByZXR1cm4gYnVmLnRvU3RyaW5nKCk7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBSZXNvbHZlIG91ciBkZWxheWVkIHN1YnNlbGVj\ndHMuCiAgICAgKi8KICAgIHByaXZhdGUgdm9pZCByZXNvbHZlU3Vic2VsZWN0\ncygpIHsKICAgICAgICBpZiAoX3N1YnNlbHMgPT0gbnVsbCB8fCBfc3Vic2Vs\ncy5pc0VtcHR5KCkpCiAgICAgICAgICAgIHJldHVybjsKCiAgICAgICAgLy8g\nYWRkIHN1YnNlbHMgYmFja3dhcmRzIHNvIHRoYXQgdGhlIHN0b3JlZCBpbnNl\ncnRpb24gcG9pbnRzIG9mCiAgICAgICAgLy8gbGF0ZXIgc3Vic2VscyByZW1h\naW4gdmFsaWQKICAgICAgICBTdWJzZWxlY3Qgc3ViOwogICAgICAgIFNRTEJ1\nZmZlciBidWY7CiAgICAgICAgZm9yIChpbnQgaSA9IF9zdWJzZWxzLnNpemUo\nKSAtIDE7IGkgPj0gMDsgaS0tKSB7CiAgICAgICAgICAgIHN1YiA9IChTdWJz\nZWxlY3QpIF9zdWJzZWxzLmdldChpKTsKICAgICAgICAgICAgaWYgKHN1Yi5j\nb3VudCkKICAgICAgICAgICAgICAgIGJ1ZiA9IHN1Yi5zZWxlY3QudG9TZWxl\nY3RDb3VudCgpOwogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICBi\ndWYgPSBzdWIuc2VsZWN0LnRvU2VsZWN0KGZhbHNlLCBzdWIuZmV0Y2gpOwog\nICAgICAgICAgICBidWYucmVzb2x2ZVN1YnNlbGVjdHMoKTsKICAgICAgICAg\nICAgYXBwZW5kKGJ1Ziwgc3ViLnNxbEluZGV4LCBzdWIucGFyYW1JbmRleCwg\nZmFsc2UpOwogICAgICAgIH0KICAgICAgICBfc3Vic2Vscy5jbGVhcigpOwog\nICAgfQoKICAgIC8qKgogICAgICogQ3JlYXRlIGFuZCBwb3B1bGF0ZSB0aGUg\ncGFyYW1ldGVycyBvZiBhIHByZXBhcmVkIHN0YXRlbWVudCB1c2luZwogICAg\nICogdGhlIFNRTCBpbiB0aGlzIGJ1ZmZlci4KICAgICAqLwogICAgcHVibGlj\nIFByZXBhcmVkU3RhdGVtZW50IHByZXBhcmVTdGF0ZW1lbnQoQ29ubmVjdGlv\nbiBjb25uKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAg\nIHJldHVybiBwcmVwYXJlU3RhdGVtZW50KGNvbm4sIFJlc3VsdFNldC5UWVBF\nX0ZPUldBUkRfT05MWSwKICAgICAgICAgICAgUmVzdWx0U2V0LkNPTkNVUl9S\nRUFEX09OTFkpOwogICAgfQoKICAgIC8qKgogICAgICogQ3JlYXRlIGFuZCBw\nb3B1bGF0ZSB0aGUgcGFyYW1ldGVycyBvZiBhIHByZXBhcmVkIHN0YXRlbWVu\ndCB1c2luZwogICAgICogdGhlIFNRTCBpbiB0aGlzIGJ1ZmZlci4KICAgICAq\nLwogICAgcHVibGljIFByZXBhcmVkU3RhdGVtZW50IHByZXBhcmVTdGF0ZW1l\nbnQoQ29ubmVjdGlvbiBjb25uLCBpbnQgcnNUeXBlLAogICAgICAgIGludCBy\nc0NvbmN1ciwgTGlzdCBwYXJtcykKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0\naW9uIHsKICAgICAgICByZXR1cm4gcHJlcGFyZVN0YXRlbWVudChjb25uLCBu\ndWxsLCByc1R5cGUsIHJzQ29uY3VyLCBwYXJtcyk7CiAgICB9CiAgICAKICAg\nIC8qKgogICAgICogQ3JlYXRlIGFuZCBwb3B1bGF0ZSB0aGUgcGFyYW1ldGVy\ncyBvZiBhIHByZXBhcmVkIHN0YXRlbWVudCB1c2luZwogICAgICogdGhlIFNR\nTCBpbiB0aGlzIGJ1ZmZlci4KICAgICAqLwogICAgcHVibGljIFByZXBhcmVk\nU3RhdGVtZW50IHByZXBhcmVTdGF0ZW1lbnQoQ29ubmVjdGlvbiBjb25uLCBp\nbnQgcnNUeXBlLAogICAgICAgIGludCByc0NvbmN1cikKICAgICAgICB0aHJv\nd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICByZXR1cm4gcHJlcGFyZVN0YXRl\nbWVudChjb25uLCByc1R5cGUsIHJzQ29uY3VyLCBudWxsKTsKICAgIH0KCiAg\nICAvKioKICAgICAqIENyZWF0ZSBhbmQgcG9wdWxhdGUgdGhlIHBhcmFtZXRl\ncnMgb2YgYSBwcmVwcmVkIHN0YXRlbWVudCB1c2luZyB0aGUKICAgICAqIFNR\nTCBpbiB0aGlzIGJ1ZmZlciBhbmQgdGhlIGdpdmVuIGZldGNoIGNvbmZpZ3Vy\nYXRpb24uCiAgICAgKi8KICAgIHB1YmxpYyBQcmVwYXJlZFN0YXRlbWVudCBw\ncmVwYXJlU3RhdGVtZW50KENvbm5lY3Rpb24gY29ubiwKICAgICAgICBKREJD\nRmV0Y2hDb25maWd1cmF0aW9uIGZldGNoLCBpbnQgcnNUeXBlLCBpbnQgcnND\nb25jdXIpCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAg\ncmV0dXJuIHByZXBhcmVTdGF0ZW1lbnQoY29ubiwgZmV0Y2gsIHJzVHlwZSwg\ncnNDb25jdXIsIG51bGwpOwogICAgfQogICAgCiAgICAvKioKICAgICAqIENy\nZWF0ZSBhbmQgcG9wdWxhdGUgdGhlIHBhcmFtZXRlcnMgb2YgYSBwcmVwcmVk\nIHN0YXRlbWVudCB1c2luZyB0aGUKICAgICAqIFNRTCBpbiB0aGlzIGJ1ZmZl\nciBhbmQgdGhlIGdpdmVuIGZldGNoIGNvbmZpZ3VyYXRpb24uCiAgICAgKi8K\nICAgIHB1YmxpYyBQcmVwYXJlZFN0YXRlbWVudCBwcmVwYXJlU3RhdGVtZW50\nKENvbm5lY3Rpb24gY29ubiwKICAgICAgICBKREJDRmV0Y2hDb25maWd1cmF0\naW9uIGZldGNoLCBpbnQgcnNUeXBlLCBpbnQgcnNDb25jdXIsIExpc3QgcGFy\nbXMpCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgaWYg\nKHJzVHlwZSA9PSAtMSAmJiBmZXRjaCA9PSBudWxsKQogICAgICAgICAgICBy\nc1R5cGUgPSBSZXN1bHRTZXQuVFlQRV9GT1JXQVJEX09OTFk7CiAgICAgICAg\nZWxzZSBpZiAocnNUeXBlID09IC0xKQogICAgICAgICAgICByc1R5cGUgPSBm\nZXRjaC5nZXRSZXN1bHRTZXRUeXBlKCk7CiAgICAgICAgaWYgKHJzQ29uY3Vy\nID09IC0xKQogICAgICAgICAgICByc0NvbmN1ciA9IFJlc3VsdFNldC5DT05D\nVVJfUkVBRF9PTkxZOwoKICAgICAgICBQcmVwYXJlZFN0YXRlbWVudCBzdG1u\ndDsKICAgICAgICBpZiAocnNUeXBlID09IFJlc3VsdFNldC5UWVBFX0ZPUldB\nUkRfT05MWQogICAgICAgICAgICAmJiByc0NvbmN1ciA9PSBSZXN1bHRTZXQu\nQ09OQ1VSX1JFQURfT05MWSkKICAgICAgICAgICAgc3RtbnQgPSBjb25uLnBy\nZXBhcmVTdGF0ZW1lbnQoZ2V0U1FMKCkpOwogICAgICAgIGVsc2UKICAgICAg\nICAgICAgc3RtbnQgPSBjb25uLnByZXBhcmVTdGF0ZW1lbnQoZ2V0U1FMKCks\nIHJzVHlwZSwgcnNDb25jdXIpOwogICAgICAgIHRyeSB7CiAgICAgICAgICAg\nIHNldFBhcmFtZXRlcnMoc3RtbnQsIHBhcm1zKTsKICAgICAgICAgICAgaWYg\nKGZldGNoICE9IG51bGwpIHsKICAgICAgICAgICAgICAgIGlmIChmZXRjaC5n\nZXRGZXRjaEJhdGNoU2l6ZSgpID4gMCkKICAgICAgICAgICAgICAgICAgICBz\ndG1udC5zZXRGZXRjaFNpemUoZmV0Y2guZ2V0RmV0Y2hCYXRjaFNpemUoKSk7\nCiAgICAgICAgICAgICAgICBpZiAocnNUeXBlICE9IFJlc3VsdFNldC5UWVBF\nX0ZPUldBUkRfT05MWQogICAgICAgICAgICAgICAgICAgICYmIGZldGNoLmdl\ndEZldGNoRGlyZWN0aW9uKCkgIT0gUmVzdWx0U2V0LkZFVENIX0ZPUldBUkQp\nCiAgICAgICAgICAgICAgICAgICAgc3RtbnQuc2V0RmV0Y2hEaXJlY3Rpb24o\nZmV0Y2guZ2V0RmV0Y2hEaXJlY3Rpb24oKSk7CiAgICAgICAgICAgIH0KICAg\nICAgICAgICAgcmV0dXJuIHN0bW50OwogICAgICAgIH0gY2F0Y2ggKFNRTEV4\nY2VwdGlvbiBzZSkgewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAg\nICAgc3RtbnQuY2xvc2UoKTsKICAgICAgICAgICAgfSBjYXRjaCAoU1FMRXhj\nZXB0aW9uIHNlMikgewogICAgICAgICAgICB9CiAgICAgICAgICAgIHRocm93\nIHNlOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIENyZWF0ZSBh\nbmQgcG9wdWxhdGUgdGhlIHBhcmFtZXRlcnMgb2YgYSBwcmVwYXJlZCBzdGF0\nZW1lbnQgdXNpbmcKICAgICAqIHRoZSBTUUwgaW4gdGhpcyBidWZmZXIuCiAg\nICAgKi8KICAgIHB1YmxpYyBDYWxsYWJsZVN0YXRlbWVudCBwcmVwYXJlQ2Fs\nbChDb25uZWN0aW9uIGNvbm4pCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlv\nbiB7CiAgICAgICAgcmV0dXJuIHByZXBhcmVDYWxsKGNvbm4sIFJlc3VsdFNl\ndC5UWVBFX0ZPUldBUkRfT05MWSwKICAgICAgICAgICAgUmVzdWx0U2V0LkNP\nTkNVUl9SRUFEX09OTFkpOwogICAgfQoKICAgIC8qKgogICAgICogQ3JlYXRl\nIGFuZCBwb3B1bGF0ZSB0aGUgcGFyYW1ldGVycyBvZiBhIHByZXBhcmVkIHN0\nYXRlbWVudCB1c2luZwogICAgICogdGhlIFNRTCBpbiB0aGlzIGJ1ZmZlci4K\nICAgICAqLwogICAgcHVibGljIENhbGxhYmxlU3RhdGVtZW50IHByZXBhcmVD\nYWxsKENvbm5lY3Rpb24gY29ubiwgaW50IHJzVHlwZSwKICAgICAgICBpbnQg\ncnNDb25jdXIpCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAg\nICAgcmV0dXJuIHByZXBhcmVDYWxsKGNvbm4sIG51bGwsIHJzVHlwZSwgcnND\nb25jdXIpOwogICAgfQoKICAgIC8qKgogICAgICogQ3JlYXRlIGFuZCBwb3B1\nbGF0ZSB0aGUgcGFyYW1ldGVycyBvZiBhIHByZXByZWQgc3RhdGVtZW50IHVz\naW5nIHRoZQogICAgICogU1FMIGluIHRoaXMgYnVmZmVyIGFuZCB0aGUgZ2l2\nZW4gZmV0Y2ggY29uZmlndXJhdGlvbi4KICAgICAqLwogICAgcHVibGljIENh\nbGxhYmxlU3RhdGVtZW50IHByZXBhcmVDYWxsKENvbm5lY3Rpb24gY29ubiwK\nICAgICAgICBKREJDRmV0Y2hDb25maWd1cmF0aW9uIGZldGNoLCBpbnQgcnNU\neXBlLCBpbnQgcnNDb25jdXIpCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlv\nbiB7CiAgICAgICAgaWYgKHJzVHlwZSA9PSAtMSAmJiBmZXRjaCA9PSBudWxs\nKQogICAgICAgICAgICByc1R5cGUgPSBSZXN1bHRTZXQuVFlQRV9GT1JXQVJE\nX09OTFk7CiAgICAgICAgZWxzZSBpZiAocnNUeXBlID09IC0xKQogICAgICAg\nICAgICByc1R5cGUgPSBmZXRjaC5nZXRSZXN1bHRTZXRUeXBlKCk7CiAgICAg\nICAgaWYgKHJzQ29uY3VyID09IC0xKQogICAgICAgICAgICByc0NvbmN1ciA9\nIFJlc3VsdFNldC5DT05DVVJfUkVBRF9PTkxZOwoKICAgICAgICBDYWxsYWJs\nZVN0YXRlbWVudCBzdG1udDsKICAgICAgICBpZiAocnNUeXBlID09IFJlc3Vs\ndFNldC5UWVBFX0ZPUldBUkRfT05MWQogICAgICAgICAgICAmJiByc0NvbmN1\nciA9PSBSZXN1bHRTZXQuQ09OQ1VSX1JFQURfT05MWSkKICAgICAgICAgICAg\nc3RtbnQgPSBjb25uLnByZXBhcmVDYWxsKGdldFNRTCgpKTsKICAgICAgICBl\nbHNlCiAgICAgICAgICAgIHN0bW50ID0gY29ubi5wcmVwYXJlQ2FsbChnZXRT\nUUwoKSwgcnNUeXBlLCByc0NvbmN1cik7CiAgICAgICAgdHJ5IHsKICAgICAg\nICAgICAgc2V0UGFyYW1ldGVycyhzdG1udCk7CiAgICAgICAgICAgIGlmIChm\nZXRjaCAhPSBudWxsKSB7CiAgICAgICAgICAgICAgICBpZiAoZmV0Y2guZ2V0\nRmV0Y2hCYXRjaFNpemUoKSA+IDApCiAgICAgICAgICAgICAgICAgICAgc3Rt\nbnQuc2V0RmV0Y2hTaXplKGZldGNoLmdldEZldGNoQmF0Y2hTaXplKCkpOwog\nICAgICAgICAgICAgICAgaWYgKHJzVHlwZSAhPSBSZXN1bHRTZXQuVFlQRV9G\nT1JXQVJEX09OTFkKICAgICAgICAgICAgICAgICAgICAmJiBmZXRjaC5nZXRG\nZXRjaERpcmVjdGlvbigpICE9IFJlc3VsdFNldC5GRVRDSF9GT1JXQVJEKQog\nICAgICAgICAgICAgICAgICAgIHN0bW50LnNldEZldGNoRGlyZWN0aW9uKGZl\ndGNoLmdldEZldGNoRGlyZWN0aW9uKCkpOwogICAgICAgICAgICB9CiAgICAg\nICAgICAgIHJldHVybiBzdG1udDsKICAgICAgICB9IGNhdGNoIChTUUxFeGNl\ncHRpb24gc2UpIHsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAg\nIHN0bW50LmNsb3NlKCk7CiAgICAgICAgICAgIH0gY2F0Y2ggKFNRTEV4Y2Vw\ndGlvbiBzZTIpIHsKICAgICAgICAgICAgfQogICAgICAgICAgICB0aHJvdyBz\nZTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBQb3B1bGF0ZSB0\naGUgcGFyYW1ldGVycyBvZiBhbiBleGlzdGluZyBQcmVwYXJlZFN0YXRlbWVu\ndAogICAgICogd2l0aCB2YWx1ZXMgZnJvbSB0aGlzIGJ1ZmZlci4KICAgICAq\nLwogICAgcHVibGljIHZvaWQgc2V0UGFyYW1ldGVycyhQcmVwYXJlZFN0YXRl\nbWVudCBwcykKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAg\nICBzZXRQYXJhbWV0ZXJzKHBzLCBudWxsKTsKICAgIH0KICAgIAogICAgLyoq\nCiAgICAgKiBQb3B1bGF0ZSB0aGUgcGFyYW1ldGVycyBvZiBhbiBleGlzdGlu\nZyBQcmVwYXJlZFN0YXRlbWVudAogICAgICogd2l0aCB2YWx1ZXMgZnJvbSB0\naGlzIGJ1ZmZlci4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0UGFyYW1l\ndGVycyhQcmVwYXJlZFN0YXRlbWVudCBwcywgTGlzdCBjYWNoZVBhcmFtcykK\nICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBMaXN0IHBh\ncmFtcyA9ICgoY2FjaGVQYXJhbXMgIT0gbnVsbCAmJiBjYWNoZVBhcmFtcy5z\naXplKCkgPiAwKSA/IAogICAgICAgICAgICBjYWNoZVBhcmFtcyA6IF9wYXJh\nbXMpOyAgICAKICAgICAgICAKICAgICAgICBpZiAocGFyYW1zID09IG51bGwp\nCiAgICAgICAgICAgIHJldHVybjsKCiAgICAgICAgQ29sdW1uIGNvbDsKICAg\nICAgICBmb3IgKGludCBpID0gMDsgaSA8IHBhcmFtcy5zaXplKCk7IGkrKykg\newogICAgICAgICAgICBjb2wgPSAoX2NvbHMgPT0gbnVsbCkgPyBudWxsIDog\nKENvbHVtbikgX2NvbHMuZ2V0KGkpOwogICAgICAgICAgICBfZGljdC5zZXRV\nbmtub3duKHBzLCBpICsgMSwgcGFyYW1zLmdldChpKSwgY29sKTsKICAgICAg\nICB9CiAgICB9CgogICAgcHVibGljIGludCBoYXNoQ29kZSgpIHsKICAgICAg\nICBpbnQgaGFzaCA9IF9zcWwuaGFzaENvZGUoKTsKICAgICAgICByZXR1cm4g\nKF9wYXJhbXMgPT0gbnVsbCkgPyBoYXNoIDogaGFzaCBeIF9wYXJhbXMuaGFz\naENvZGUoKTsKICAgIH0KCiAgICAvKioKICAgICAqIENvbXBhcmUgaW50ZXJu\nYWwgU1FMIHdpdGhvdXQgcmVzb2x2aW5nIHN1YnNlbGVjdHMgb3Igc3RyaW5n\naWZ5aW5nCiAgICAgKiBwYXJhbWV0ZXJzLgogICAgICovCiAgICBwdWJsaWMg\nYm9vbGVhbiBzcWxFcXVhbHMoU3RyaW5nIHNxbCkgewogICAgICAgIHJldHVy\nbiBfc3FsLnRvU3RyaW5nKCkuZXF1YWxzKHNxbCk7CiAgICB9CgogICAgcHVi\nbGljIGJvb2xlYW4gZXF1YWxzKE9iamVjdCBvdGhlcikgewogICAgICAgIGlm\nIChvdGhlciA9PSB0aGlzKQogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAg\nICAgICBpZiAoIShvdGhlciBpbnN0YW5jZW9mIFNRTEJ1ZmZlcikpCiAgICAg\nICAgICAgIHJldHVybiBmYWxzZTsKCiAgICAgICAgU1FMQnVmZmVyIGJ1ZiA9\nIChTUUxCdWZmZXIpIG90aGVyOwogICAgICAgIHJldHVybiBfc3FsLmVxdWFs\ncyhidWYuX3NxbCkKICAgICAgICAgICAgJiYgT2JqZWN0VXRpbHMuZXF1YWxz\nKF9wYXJhbXMsIGJ1Zi5fcGFyYW1zKTsKICAgIH0KCiAgICAvKioKICAgICAq\nIFJlcGxhY2UgU1FMICc/JyB3aXRoIENBU1Qgc3RyaW5nIGlmIHJlcXVpcmVk\nIGJ5IERCIHBsYXRmb3JtCiAgICAgKiBAcGFyYW0gb3BlcgogICAgICogQHBh\ncmFtIHZhbAogICAgICovCiAgICBwdWJsaWMgdm9pZCBhZGRDYXN0Rm9yUGFy\nYW0oU3RyaW5nIG9wZXIsIFZhbCB2YWwpIHsKICAgICAgICBpZiAoX3NxbC5j\naGFyQXQoX3NxbC5sZW5ndGgoKSAtIDEpID09ICc/JykgewogICAgICAgICAg\nICBTdHJpbmcgY2FzdFN0cmluZyA9IF9kaWN0LmFkZENhc3RBc1R5cGUob3Bl\nciwgdmFsKTsKICAgICAgICAgICAgaWYgKGNhc3RTdHJpbmcgIT0gbnVsbCkK\nICAgICAgICAgICAgICAgIF9zcWwucmVwbGFjZShfc3FsLmxlbmd0aCgpIC0g\nMSwgX3NxbC5sZW5ndGgoKSwgY2FzdFN0cmluZyk7CiAgICAgICAgfQogICAg\nfQoKICAgIC8qKgogICAgICogUmVwbGFjZSBjdXJyZW50IGJ1ZmZlciBzdHJp\nbmcgd2l0aCB0aGUgbmV3IHN0cmluZwogICAgICogCiAgICAgKiBAcGFyYW0g\nc3RhcnQgcmVwbGFjZSBzdGFydCBwb3NpdGlvbgogICAgICogQHBhcmFtIGVu\nZCByZXBsYWNlIGVuZCBwb3NpdGlvbgogICAgICogQHBhcmFtIG5ld1N0cmlu\nZwogICAgICovCiAgICBwdWJsaWMgdm9pZCByZXBsYWNlU3FsU3RyaW5nKGlu\ndCBzdGFydCwgaW50IGVuZCwgU3RyaW5nIG5ld1N0cmluZykgewogICAgICAg\nIF9zcWwucmVwbGFjZShzdGFydCwgZW5kLCBuZXdTdHJpbmcpOwogICAgfQog\nICAgCiAgICAvKioKICAgICAqIFJlcHJlc2VudHMgYSBzdWJzZWxlY3QuCiAg\nICAgKi8KICAgIHByaXZhdGUgc3RhdGljIGNsYXNzIFN1YnNlbGVjdCB7Cgog\nICAgICAgIHB1YmxpYyBTZWxlY3Qgc2VsZWN0OwogICAgICAgIHB1YmxpYyBK\nREJDRmV0Y2hDb25maWd1cmF0aW9uIGZldGNoOwogICAgICAgIHB1YmxpYyBi\nb29sZWFuIGNvdW50OwogICAgICAgIHB1YmxpYyBpbnQgc3FsSW5kZXg7CiAg\nICAgICAgcHVibGljIGludCBwYXJhbUluZGV4OwoKICAgICAgICBwdWJsaWMg\nU3Vic2VsZWN0IGNsb25lKGludCBzcWxJbmRleCwgaW50IHBhcmFtSW5kZXgp\nIHsKICAgICAgICAgICAgaWYgKHNxbEluZGV4ID09IDAgJiYgcGFyYW1JbmRl\neCA9PSAwKQogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXM7CgogICAgICAg\nICAgICBTdWJzZWxlY3Qgc3ViID0gbmV3IFN1YnNlbGVjdCgpOwogICAgICAg\nICAgICBzdWIuc2VsZWN0ID0gc2VsZWN0OwogICAgICAgICAgICBzdWIuZmV0\nY2ggPSBmZXRjaDsKICAgICAgICAgICAgc3ViLmNvdW50ID0gY291bnQ7CiAg\nICAgICAgICAgIHN1Yi5zcWxJbmRleCA9IHRoaXMuc3FsSW5kZXggKyBzcWxJ\nbmRleDsKICAgICAgICAgICAgc3ViLnBhcmFtSW5kZXggPSB0aGlzLnBhcmFt\nSW5kZXggKyBwYXJhbUluZGV4OwogICAgICAgICAgICByZXR1cm4gc3ViOwog\nICAgICAgIH0KICAgIH0KICAgIAogICAgcHVibGljIHZvaWQgc2V0UGFyYW1l\ndGVycyhMaXN0IHBhcmFtcykgewogICAgICAgIF9wYXJhbXMgPSBwYXJhbXM7\nCiAgICB9CiAgICAKICAgIHB1YmxpYyBMaXN0IGdldENvbHVtbnMoKSB7CiAg\nICAgICAgcmV0dXJuIF9jb2xzOwogICAgfQp9Cg==\n","encoding":"base64"}

