{"sha":"854f1a64843d8521f52481bd35c43975ca4ce3db","node_id":"MDQ6QmxvYjIwNjM2NDo4NTRmMWE2NDg0M2Q4NTIxZjUyNDgxYmQzNWM0Mzk3NWNhNGNlM2Ri","size":7052,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/854f1a64843d8521f52481bd35c43975ca4ce3db","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNr\nYWdlIG9yZy5hcGFjaGUub3BlbmpwYS5jb25mOwoKaW1wb3J0IGphdmEudXRp\nbC5Db2xsZWN0aW9uOwppbXBvcnQgamF2YS51dGlsLkl0ZXJhdG9yOwppbXBv\ncnQgamF2YS51dGlsLk1hcDsKCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\na2VybmVsLkJvb3RzdHJhcDsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5r\nZXJuZWwuQnJva2VyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5l\nbC5Ccm9rZXJGYWN0b3J5OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmtl\ncm5lbC5RdWVyeTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIudXRp\nbC5PcHRpb25zOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi5sb2cu\nTG9nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi5jb25mLk1hcENv\nbmZpZ3VyYXRpb25Qcm92aWRlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3Blbmpw\nYS5saWIuY29uZi5Db25maWd1cmF0aW9uUHJvdmlkZXI7CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEubWV0YS5DbGFzc01ldGFEYXRhOwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLm1ldGEuTWV0YURhdGFSZXBvc2l0b3J5OwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuUXVlcnlNZXRhRGF0YTsKaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRhLlNlcXVlbmNlTWV0YURhdGE7\nCgovKioKICogUGVyZm9ybXMgbWFpbnRlbmFuY2UgdGFza3Mgb24gdGhlIG1l\ndGFkYXRhIGNhY2hlcyBhY2Nlc3NpYmxlIHZpYSB0aGUKICoge0BsaW5rIENh\nY2hlTWFyc2hhbGxlcn0gYXJjaGl0ZWN0dXJlLgogKgogKiBAc2luY2UgMS4x\nLjAKICovCnB1YmxpYyBjbGFzcyBNZXRhRGF0YUNhY2hlTWFpbnRlbmFuY2Ug\newoKICAgIHByaXZhdGUgZmluYWwgQnJva2VyRmFjdG9yeSBmYWN0b3J5Owog\nICAgcHJpdmF0ZSBmaW5hbCBPcGVuSlBBQ29uZmlndXJhdGlvbiBjb25mOwog\nICAgcHJpdmF0ZSBmaW5hbCBib29sZWFuIGRldnBhdGg7CiAgICBwcml2YXRl\nIExvZyBsb2c7CgogICAgcHVibGljIHN0YXRpYyB2b2lkIG1haW4oU3RyaW5n\nW10gYXJncykgewogICAgICAgIE9wdGlvbnMgb3B0cyA9IG5ldyBPcHRpb25z\nKCk7CiAgICAgICAgYXJncyA9IG9wdHMuc2V0RnJvbUNtZExpbmUoYXJncyk7\nCiAgICAgICAgYm9vbGVhbiBkZXZwYXRoID0gb3B0cy5nZXRCb29sZWFuUHJv\ncGVydHkoInNjYW5EZXZQYXRoIiwgIlNjYW5EZXZQYXRoIiwKICAgICAgICAg\nICAgdHJ1ZSk7CgogICAgICAgIENvbmZpZ3VyYXRpb25Qcm92aWRlciBjcCA9\nIG5ldyBNYXBDb25maWd1cmF0aW9uUHJvdmlkZXIob3B0cyk7CiAgICAgICAg\nQnJva2VyRmFjdG9yeSBmYWN0b3J5ID0gQm9vdHN0cmFwLm5ld0Jyb2tlckZh\nY3RvcnkoY3AsIG51bGwpOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIE1l\ndGFEYXRhQ2FjaGVNYWludGVuYW5jZSBtYWludCA9IG5ldyBNZXRhRGF0YUNh\nY2hlTWFpbnRlbmFuY2UoCiAgICAgICAgICAgICAgICBmYWN0b3J5LCBkZXZw\nYXRoKTsKCiAgICAgICAgICAgIGlmIChhcmdzLmxlbmd0aCAhPSAxKSB7CiAg\nICAgICAgICAgICAgICB1c2FnZSgpOwogICAgICAgICAgICAgICAgcmV0dXJu\nOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoInN0b3JlIi5lcXVh\nbHMoYXJnc1swXSkpCiAgICAgICAgICAgICAgICBtYWludC5zdG9yZSgpOwog\nICAgICAgICAgICBlbHNlIGlmICgiZHVtcCIuZXF1YWxzKGFyZ3NbMF0pKQog\nICAgICAgICAgICAgICAgbWFpbnQuZHVtcCgpOwogICAgICAgICAgICBlbHNl\nCiAgICAgICAgICAgICAgICB1c2FnZSgpOwogICAgICAgIH0gZmluYWxseSB7\nCiAgICAgICAgICAgIGZhY3RvcnkuY2xvc2UoKTsKICAgICAgICB9CiAgICB9\nCgogICAgLyoqCiAgICAgKiBAZGVwcmVjYXRlZCBsb2dnaW5nIGlzIHJvdXRl\nZCB0byB0aGUgbG9nZ2luZyBzeXN0ZW0gbm93LgogICAgICovCiAgICBwdWJs\naWMgTWV0YURhdGFDYWNoZU1haW50ZW5hbmNlKEJyb2tlckZhY3RvcnkgZmFj\ndG9yeSwgYm9vbGVhbiBkZXZwYXRoLAogICAgICAgIGJvb2xlYW4gdmVyYm9z\nZSkgewogICAgICAgIHRoaXMoZmFjdG9yeSwgZGV2cGF0aCk7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBAcGFyYW0gZmFjdG9yeSBUaGUge0BsaW5rIEJyb2tl\nckZhY3Rvcnl9IGZvciB3aGljaCBjYWNoZWQgbWV0YWRhdGEKICAgICAqIHNo\nb3VsZCBiZSBidWlsdC4KICAgICAqIEBwYXJhbSBkZXZwYXRoIFdoZXRoZXIg\nb3Igbm90IHRvIHNjYW4gdGhlIGRldmVsb3BtZW50IGVudmlyb25tZW50IHBh\ndGhzCiAgICAgKiB0byBmaW5kIHBlcnNpc3RlbnQgdHlwZXMgdG8gc3RvcmUu\nCiAgICAgKi8KICAgIHB1YmxpYyBNZXRhRGF0YUNhY2hlTWFpbnRlbmFuY2Uo\nQnJva2VyRmFjdG9yeSBmYWN0b3J5LCBib29sZWFuIGRldnBhdGgpIHsKICAg\nICAgICB0aGlzLmZhY3RvcnkgPSBmYWN0b3J5OwogICAgICAgIHRoaXMuY29u\nZiA9IGZhY3RvcnkuZ2V0Q29uZmlndXJhdGlvbigpOwogICAgICAgIHRoaXMu\nZGV2cGF0aCA9IGRldnBhdGg7CiAgICAgICAgdGhpcy5sb2cgPSBjb25mLmdl\ndExvZyhPcGVuSlBBQ29uZmlndXJhdGlvbi5MT0dfVE9PTCk7CiAgICB9Cgog\nICAgcHVibGljIHZvaWQgc2V0TG9nKExvZyBsb2cpIHsKICAgICAgICB0aGlz\nLmxvZyA9IGxvZzsKICAgIH0KCiAgICBwcml2YXRlIHN0YXRpYyBpbnQgdXNh\nZ2UoKSB7CiAgICAgICAgU3lzdGVtLmVyci5wcmludGxuKCJVc2FnZTogamF2\nYSBNZXRhRGF0YUNhY2hlTWFpbnRlbmFuY2UgIiArCiAgICAgICAgICAgICJb\nLXNjYW5EZXZQYXRoIHR8Zl0gWy08b3BlbmpwYS5Qcm9wZXJ0eU5hbWU+IHZh\nbHVlXSBzdG9yZSB8IGR1bXAiKTsKICAgICAgICByZXR1cm4gLTE7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBUaGUgbWV0YWRhdGEgcmVwb3NpdG9yeSBmb3Ig\ndGhlIGZhY3RvcnkgdGhhdCB0aGlzIGluc3RhbmNlIHdhcwogICAgICogY29u\nc3RydWN0ZWQgd2l0aCB3aWxsIGJlIHNlcmlhbGl6ZWQsIGFsb25nIHdpdGgg\nYW55IHF1ZXJ5CiAgICAgKiBjb21waWxhdGlvbnMgZXRjLiB0aGF0IGhhdmUg\nYmVlbiBjcmVhdGVkIGZvciB0aGUgZmFjdG9yeS4KICAgICAqLwogICAgcHVi\nbGljIHZvaWQgc3RvcmUoKSB7CiAgICAgICAgTWV0YURhdGFSZXBvc2l0b3J5\nIHJlcG9zID0gY29uZi5nZXRNZXRhRGF0YVJlcG9zaXRvcnlJbnN0YW5jZSgp\nOwogICAgICAgIHJlcG9zLnNldFNvdXJjZU1vZGUoTWV0YURhdGFSZXBvc2l0\nb3J5Lk1PREVfQUxMKTsKICAgICAgICBDb2xsZWN0aW9uIHR5cGVzID0gcmVw\nb3MubG9hZFBlcnNpc3RlbnRUeXBlcyhkZXZwYXRoLCBudWxsKTsKICAgICAg\nICBmb3IgKEl0ZXJhdG9yIGl0ZXIgPSB0eXBlcy5pdGVyYXRvcigpOyBpdGVy\nLmhhc05leHQoKTsgKQogICAgICAgICAgICByZXBvcy5nZXRNZXRhRGF0YSgo\nQ2xhc3MpIGl0ZXIubmV4dCgpLCBudWxsLCB0cnVlKTsKCiAgICAgICAgbG9h\nZFF1ZXJpZXMoKTsKCiAgICAgICAgbG9nLmluZm8oIlRoZSBmb2xsb3dpbmcg\nZGF0YSB3aWxsIGJlIHN0b3JlZDogIik7CiAgICAgICAgbG9nKHJlcG9zLCBj\nb25mLmdldFF1ZXJ5Q29tcGlsYXRpb25DYWNoZUluc3RhbmNlKCkpOwoKICAg\nICAgICBDYWNoZU1hcnNoYWxsZXJzVmFsdWUuZ2V0TWFyc2hhbGxlckJ5SWQo\nY29uZiwgZ2V0Q2xhc3MoKS5nZXROYW1lKCkpCiAgICAgICAgICAgIC5zdG9y\nZShuZXcgT2JqZWN0W10gewogICAgICAgICAgICAgICAgcmVwb3MsIGNvbmYu\nZ2V0UXVlcnlDb21waWxhdGlvbkNhY2hlSW5zdGFuY2UoKQogICAgICAgICAg\nICB9KTsKICAgIH0KCiAgICBwcml2YXRlIHZvaWQgbG9hZFF1ZXJpZXMoKSB7\nCiAgICAgICAgQnJva2VyIGJyb2tlciA9IGZhY3RvcnkubmV3QnJva2VyKCk7\nCiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgUXVlcnlNZXRhRGF0YVtdIHFt\nZHMgPQogICAgICAgICAgICAgICAgY29uZi5nZXRNZXRhRGF0YVJlcG9zaXRv\ncnlJbnN0YW5jZSgpLmdldFF1ZXJ5TWV0YURhdGFzKCk7CiAgICAgICAgICAg\nIGZvciAoaW50IGkgPSAwOyBpIDwgcW1kcy5sZW5ndGg7IGkrKykKICAgICAg\nICAgICAgICAgIGxvYWRRdWVyeShicm9rZXIsIHFtZHNbaV0pOwogICAgICAg\nIH0gZmluYWxseSB7CiAgICAgICAgICAgIGJyb2tlci5jbG9zZSgpOwogICAg\nICAgIH0KICAgIH0KCiAgICBwcml2YXRlIHZvaWQgbG9hZFF1ZXJ5KEJyb2tl\nciBicm9rZXIsIFF1ZXJ5TWV0YURhdGEgcW1kKSB7CiAgICAgICAgdHJ5IHsK\nICAgICAgICAgICAgUXVlcnkgcSA9IGJyb2tlci5uZXdRdWVyeShxbWQuZ2V0\nTGFuZ3VhZ2UoKSwgbnVsbCk7CiAgICAgICAgICAgIHFtZC5zZXRJbnRvKHEp\nOwogICAgICAgICAgICBxLmNvbXBpbGUoKTsKICAgICAgICB9IGNhdGNoIChF\neGNlcHRpb24gZSkgewogICAgICAgICAgICBpZiAobG9nLmlzVHJhY2VFbmFi\nbGVkKCkpIHsKICAgICAgICAgICAgICAgIGxvZy53YXJuKCJTa2lwcGluZyBu\nYW1lZCBxdWVyeSAiICsgcW1kLmdldE5hbWUoKSArICI6ICIKICAgICAgICAg\nICAgICAgICAgICArIGUuZ2V0TWVzc2FnZSgpLCBlKTsKICAgICAgICAgICAg\nfSBlbHNlIHsKICAgICAgICAgICAgICAgIGxvZy53YXJuKCJTa2lwcGluZyBu\nYW1lZCBxdWVyeSAiICsgcW1kLmdldE5hbWUoKSArICI6ICIKICAgICAgICAg\nICAgICAgICAgICArIGUuZ2V0TWVzc2FnZSgpKTsKICAgICAgICAgICAgfQog\nICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMgdm9pZCBkdW1wKCkgewogICAg\nICAgIE9iamVjdFtdIG9zID0gKE9iamVjdFtdKQogICAgICAgICAgICBDYWNo\nZU1hcnNoYWxsZXJzVmFsdWUuZ2V0TWFyc2hhbGxlckJ5SWQoY29uZiwgZ2V0\nQ2xhc3MoKS5nZXROYW1lKCkpCiAgICAgICAgICAgIC5sb2FkKCk7CiAgICAg\nICAgaWYgKG9zID09IG51bGwpIHsKICAgICAgICAgICAgbG9nLmluZm8oIk5v\nIGNhY2hlZCBkYXRhIHdhcyBmb3VuZCIpOwogICAgICAgICAgICByZXR1cm47\nCiAgICAgICAgfQogICAgICAgIE1ldGFEYXRhUmVwb3NpdG9yeSByZXBvcyA9\nIChNZXRhRGF0YVJlcG9zaXRvcnkpIG9zWzBdOwogICAgICAgIE1hcCBxY2Mg\nPSAoTWFwKSBvc1sxXTsKCiAgICAgICAgbG9nLmluZm8oIlRoZSBmb2xsb3dp\nbmcgZGF0YSB3YXMgZm91bmQ6ICIpOwogICAgICAgIGxvZyhyZXBvcywgcWNj\nKTsKICAgIH0KCiAgICBwcml2YXRlIHZvaWQgbG9nKE1ldGFEYXRhUmVwb3Np\ndG9yeSByZXBvcywgTWFwIHFjYykgewogICAgICAgIENsYXNzTWV0YURhdGFb\nXSBtZXRhcyA9IHJlcG9zLmdldE1ldGFEYXRhcygpOwogICAgICAgIGxvZy5p\nbmZvKCIgIFR5cGVzOiAiICsgbWV0YXMubGVuZ3RoKTsKICAgICAgICBpZiAo\nbG9nLmlzVHJhY2VFbmFibGVkKCkpCiAgICAgICAgICAgIGZvciAoaW50IGkg\nPSAwOyBpIDwgbWV0YXMubGVuZ3RoOyBpKyspCiAgICAgICAgICAgICAgICBs\nb2cudHJhY2UoIiAgICAiICsgbWV0YXNbaV0uZ2V0RGVzY3JpYmVkVHlwZSgp\nLmdldE5hbWUoKSk7CgogICAgICAgIFF1ZXJ5TWV0YURhdGFbXSBxbWRzID0g\ncmVwb3MuZ2V0UXVlcnlNZXRhRGF0YXMoKTsKICAgICAgICBsb2cuaW5mbygi\nICBRdWVyaWVzOiAiICsgcW1kcy5sZW5ndGgpOwogICAgICAgIGlmIChsb2cu\naXNUcmFjZUVuYWJsZWQoKSkKICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7\nIGkgPCBxbWRzLmxlbmd0aDsgaSsrKQogICAgICAgICAgICAgICAgbG9nLnRy\nYWNlKCIgICAgIiArIHFtZHNbaV0uZ2V0TmFtZSgpICsgIjogIgogICAgICAg\nICAgICAgICAgICAgICsgcW1kc1tpXS5nZXRRdWVyeVN0cmluZygpKTsKCiAg\nICAgICAgU2VxdWVuY2VNZXRhRGF0YVtdIHNtZHMgPSByZXBvcy5nZXRTZXF1\nZW5jZU1ldGFEYXRhcygpOwogICAgICAgIGxvZy5pbmZvKCIgIFNlcXVlbmNl\nczogIiArIHNtZHMubGVuZ3RoKTsKICAgICAgICBpZiAobG9nLmlzVHJhY2VF\nbmFibGVkKCkpCiAgICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgc21k\ncy5sZW5ndGg7IGkrKykKICAgICAgICAgICAgICAgIGxvZy50cmFjZSgiICAg\nICIgKyBzbWRzW2ldLmdldE5hbWUoKSk7CgogICAgICAgIGxvZy5pbmZvKCIg\nIENvbXBpbGVkIHF1ZXJpZXM6ICIKICAgICAgICAgICAgKyAocWNjID09IG51\nbGwgPyAiMCIgOiAiIiArIHFjYy5zaXplKCkpKTsKICAgICAgICBpZiAobG9n\nLmlzVHJhY2VFbmFibGVkKCkgJiYgcWNjICE9IG51bGwpCiAgICAgICAgICAg\nIGZvciAoSXRlcmF0b3IgaXRlciA9IHFjYy5rZXlTZXQoKS5pdGVyYXRvcigp\nOyBpdGVyLmhhc05leHQoKTsgKQogICAgICAgICAgICAgICAgbG9nLnRyYWNl\nKCIgICAgIiArIGl0ZXIubmV4dCgpKTsKICAgIH0KfQo=\n","encoding":"base64"}

