{"sha":"f7f4d44cffc234752c58d0975cdd1e6a1f203eab","node_id":"MDQ6QmxvYjIwNjM2NDpmN2Y0ZDQ0Y2ZmYzIzNDc1MmM1OGQwOTc1Y2RkMWU2YTFmMjAzZWFi","size":12572,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/f7f4d44cffc234752c58d0975cdd1e6a1f203eab","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNr\nYWdlIG9yZy5hcGFjaGUub3BlbmpwYS5lbmhhbmNlOwoKaW1wb3J0IGphdmEu\naW8uRmlsZTsKaW1wb3J0IGphdmEuaW8uSU9FeGNlcHRpb247CmltcG9ydCBq\nYXZhLnV0aWwuQXJyYXlMaXN0OwppbXBvcnQgamF2YS51dGlsLkNvbGxlY3Rp\nb247CmltcG9ydCBqYXZhLnV0aWwuQ29sbGVjdGlvbnM7CmltcG9ydCBqYXZh\nLnV0aWwuSGFzaE1hcDsKaW1wb3J0IGphdmEudXRpbC5IYXNoU2V0OwppbXBv\ncnQgamF2YS51dGlsLkl0ZXJhdG9yOwppbXBvcnQgamF2YS51dGlsLkxpc3Q7\nCmltcG9ydCBqYXZhLnV0aWwuTWFwOwppbXBvcnQgamF2YS51dGlsLlNldDsK\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuY29uZi5PcGVuSlBBQ29uZmln\ndXJhdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIubG9nLkxv\nZzsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIudXRpbC5CeXRlY29k\nZVdyaXRlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIudXRpbC5K\nYXZhVmVyc2lvbnM7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0\naWwuTG9jYWxpemVyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51\ndGlsLkZpbGVzOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51dGls\nLkxvY2FsaXplci5NZXNzYWdlOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLm1ldGEuQ2xhc3NNZXRhRGF0YTsKaW1wb3J0IG9yZy5hcGFjaGUub3Blbmpw\nYS5tZXRhLkZpZWxkTWV0YURhdGE7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEubWV0YS5KYXZhVHlwZXM7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\ndXRpbC5HZW5lcmF0ZWRDbGFzc2VzOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLnV0aWwuSW1wbEhlbHBlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3Blbmpw\nYS51dGlsLkludGVybmFsRXhjZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLnV0aWwuVXNlckV4Y2VwdGlvbjsKaW1wb3J0IHNlcnAuYnl0ZWNv\nZGUuQkNDbGFzczsKCi8qKgogKiBSZWRlZmluZXMgdGhlIG1ldGhvZCBib2Rp\nZXMgb2YgZXhpc3RpbmcgdW5lbmhhbmNlZCBjbGFzc2VzIHRvIG1ha2UgdGhl\nbQogKiBub3RpZnkgc3RhdGUgbWFuYWdlcnMgb2YgbXV0YXRpb25zLgogKgog\nKiBAc2luY2UgMS4wLjAKICovCnB1YmxpYyBjbGFzcyBNYW5hZ2VkQ2xhc3NT\ndWJjbGFzc2VyIHsKICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIExvY2FsaXpl\nciBfbG9jID0gTG9jYWxpemVyLmZvclBhY2thZ2UoCiAgICAgICAgTWFuYWdl\nZENsYXNzU3ViY2xhc3Nlci5jbGFzcyk7CgogICAgLyoqCiAgICAgKiBGb3Ig\nZWFjaCBlbGVtZW50IGluIDxjb2RlPmNsYXNzZXM8L2NvZGU+LCBjcmVhdGVz\nIGFuZCByZWdpc3RlcnMgYQogICAgICogbmV3IHN1YmNsYXNzIHRoYXQgaW1w\nbGVtZW50cyB7QGxpbmsgUGVyc2lzdGVuY2VDYXBhYmxlfSwgYW5kIHByZXBh\ncmVzCiAgICAgKiBPcGVuSlBBIHRvIGhhbmRsZSBuZXcgaW5zdGFuY2VzIG9m\nIHRoZSB1bmVuaGFuY2VkIHR5cGUuIElmIHRoaXMgaXMKICAgICAqIGludm9r\nZWQgaW4gYSBKYXZhIDYgZW52aXJvbm1lbnQsIHRoaXMgbWV0aG9kIHdpbGwg\ncmVkZWZpbmUgdGhlIG1ldGhvZHMKICAgICAqIGZvciBlYWNoIGNsYXNzIGlu\nIHRoZSBhcmd1bWVudCBsaXN0IHN1Y2ggdGhhdCBmaWVsZCBhY2Nlc3NlcyBh\ncmUKICAgICAqIGludGVyY2VwdGVkIGluLWxpbmUuIElmIGludm9rZWQgaW4g\nYSBKYXZhIDUgZW52aXJvbm1lbnQsIHRoaXMKICAgICAqIHJlZGVmaW5pdGlv\nbiBpcyBub3QgcG9zc2libGU7IGluIHRoZXNlIGNvbnRleHRzLCB3aGVuIHVz\naW5nIGZpZWxkCiAgICAgKiBhY2Nlc3MsIE9wZW5KUEEgd2lsbCBuZWVkIHRv\nIGRvIHN0YXRlIGNvbXBhcmlzb25zIHRvIGRldGVjdCBhbnkgY2hhbmdlCiAg\nICAgKiB0byBhbnkgaW5zdGFuY2UgYXQgYW55IHRpbWUsIGFuZCB3aGVuIHVz\naW5nIHByb3BlcnR5IGFjY2VzcywgT3BlbkpQQQogICAgICogd2lsbCBuZWVk\nIHRvIGRvIHN0YXRlIGNvbXBhcmlzb25zIHRvIGRldGVjdCBjaGFuZ2VzIHRv\nIG5ld2x5IGluc2VydGVkCiAgICAgKiBpbnN0YW5jZXMgYWZ0ZXIgYSBmbHVz\naCBoYXMgYmVlbiBjYWxsZWQuCiAgICAgKgogICAgICogQHJldHVybiB0aGUg\nbmV3IHN1YmNsYXNzZXMsIG9yIDxjb2RlPm51bGw8L2NvZGU+IGlmIDxjb2Rl\nPmNsYXNzZXM8L2NvZGU+CiAgICAgKiBpcyA8Y29kZT5udWxsPC9jb2RlPi4K\nICAgICAqIEB0aHJvd3MgVXNlckV4Y2VwdGlvbiBpZiA8Y29kZT5jb25mPC9j\nb2RlPiByZXF1aXJlcyBidWlsZC10aW1lCiAgICAgKiBlbmhhbmNlbWVudCBh\nbmQgPGNvZGU+Y2xhc3NlczwvY29kZT4gaW5jbHVkZXMgdW5lbmhhbmNlZCB0\neXBlcy4KICAgICAqCiAgICAgKiBAc2luY2UgMS4wLjAKICAgICAqLwogICAg\ncHVibGljIHN0YXRpYyBMaXN0PENsYXNzPiBwcmVwYXJlVW5lbmhhbmNlZENs\nYXNzZXMoCiAgICAgICAgZmluYWwgT3BlbkpQQUNvbmZpZ3VyYXRpb24gY29u\nZiwKICAgICAgICBmaW5hbCBDb2xsZWN0aW9uPD8gZXh0ZW5kcyBDbGFzcz4g\nY2xhc3NlcywKICAgICAgICBmaW5hbCBDbGFzc0xvYWRlciBlbnZMb2FkZXIp\nIHsKICAgICAgICBpZiAoY2xhc3NlcyA9PSBudWxsKQogICAgICAgICAgICBy\nZXR1cm4gbnVsbDsKICAgICAgICBpZiAoY2xhc3Nlcy5zaXplKCkgPT0gMCkK\nICAgICAgICAgICAgcmV0dXJuIENvbGxlY3Rpb25zLkVNUFRZX0xJU1Q7Cgog\nICAgICAgIExvZyBsb2cgPSBjb25mLmdldExvZyhPcGVuSlBBQ29uZmlndXJh\ndGlvbi5MT0dfRU5IQU5DRSk7CiAgICAgICAgaWYgKGNvbmYuZ2V0UnVudGlt\nZVVuZW5oYW5jZWRDbGFzc2VzQ29uc3RhbnQoKQogICAgICAgICAgICAhPSBS\ndW50aW1lVW5lbmhhbmNlZENsYXNzc2VzTW9kZXMuU1VQUE9SVEVEKSB7CiAg\nICAgICAgICAgIENvbGxlY3Rpb24gdW5lbmhhbmNlZCA9IG5ldyBBcnJheUxp\nc3QoKTsKICAgICAgICAgICAgZm9yIChDbGFzcyBjbHMgOiBjbGFzc2VzKQog\nICAgICAgICAgICAgICAgaWYgKCFQZXJzaXN0ZW5jZUNhcGFibGUuY2xhc3Mu\naXNBc3NpZ25hYmxlRnJvbShjbHMpKQogICAgICAgICAgICAgICAgICAgIHVu\nZW5oYW5jZWQuYWRkKGNscyk7CiAgICAgICAgICAgIGlmICh1bmVuaGFuY2Vk\nLnNpemUoKSA+IDApIHsKICAgICAgICAgICAgICAgIE1lc3NhZ2UgbXNnID0g\nX2xvYy5nZXQoInJ1bnRpbWUtb3B0aW1pemF0aW9uLWRpc2FibGVkIiwKICAg\nICAgICAgICAgICAgICAgICB1bmVuaGFuY2VkKTsKICAgICAgICAgICAgICAg\nIGlmIChjb25mLmdldFJ1bnRpbWVVbmVuaGFuY2VkQ2xhc3Nlc0NvbnN0YW50\nKCkKICAgICAgICAgICAgICAgICAgICA9PSBSdW50aW1lVW5lbmhhbmNlZENs\nYXNzc2VzTW9kZXMuV0FSTikKICAgICAgICAgICAgICAgICAgICBsb2cud2Fy\nbihtc2cpOwogICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAg\nICAgIHRocm93IG5ldyBVc2VyRXhjZXB0aW9uKG1zZyk7CiAgICAgICAgICAg\nIH0KICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgfQoKICAgICAg\nICBib29sZWFuIHJlZGVmaW5lID0gQ2xhc3NSZWRlZmluZXIuY2FuUmVkZWZp\nbmVDbGFzc2VzKCk7CiAgICAgICAgaWYgKHJlZGVmaW5lKQogICAgICAgICAg\nICBsb2cuaW5mbyhfbG9jLmdldCgiZW5oYW5jZS1hbmQtc3ViY2xhc3MtYW5k\nLXJlZGVmLXN0YXJ0IiwKICAgICAgICAgICAgICAgIGNsYXNzZXMpKTsKICAg\nICAgICBlbHNlCiAgICAgICAgICAgIGxvZy5pbmZvKF9sb2MuZ2V0KCJlbmhh\nbmNlLWFuZC1zdWJjbGFzcy1uby1yZWRlZi1zdGFydCIsCiAgICAgICAgICAg\nICAgICBjbGFzc2VzKSk7CgogICAgICAgIGZpbmFsIE1hcDxDbGFzcywgYnl0\nZVtdPiBtYXAgPSBuZXcgSGFzaE1hcDxDbGFzcywgYnl0ZVtdPigpOwogICAg\nICAgIGZpbmFsIExpc3Qgc3VicyA9IG5ldyBBcnJheUxpc3QoY2xhc3Nlcy5z\naXplKCkpOwogICAgICAgIGZpbmFsIExpc3QgaW50cyA9IG5ldyBBcnJheUxp\nc3QoY2xhc3Nlcy5zaXplKCkpOwogICAgICAgIFNldDxDbGFzcz4gdW5zcGVj\naWZpZWQgPSBudWxsOwogICAgICAgIGZvciAoSXRlcmF0b3IgaXRlciA9IGNs\nYXNzZXMuaXRlcmF0b3IoKTsgaXRlci5oYXNOZXh0KCk7ICkgewogICAgICAg\nICAgICBmaW5hbCBDbGFzcyBjbHMgPSAoQ2xhc3MpIGl0ZXIubmV4dCgpOwog\nICAgICAgICAgICBmaW5hbCBQQ0VuaGFuY2VyIGVuaGFuY2VyID0gbmV3IFBD\nRW5oYW5jZXIoY29uZiwgY2xzKTsgCgogICAgICAgICAgICBlbmhhbmNlci5z\nZXRCeXRlY29kZVdyaXRlcihuZXcgQnl0ZWNvZGVXcml0ZXIoKSB7CiAgICAg\nICAgICAgICAgICBwdWJsaWMgdm9pZCB3cml0ZShCQ0NsYXNzIGJjKSB0aHJv\nd3MgSU9FeGNlcHRpb24gewogICAgICAgICAgICAgICAgICAgIE1hbmFnZWRD\nbGFzc1N1YmNsYXNzZXIud3JpdGUoYmMsIGVuaGFuY2VyLCBtYXAsCiAgICAg\nICAgICAgICAgICAgICAgICAgIGNscywgc3VicywgaW50cyk7CiAgICAgICAg\nICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBpZiAocmVk\nZWZpbmUpCiAgICAgICAgICAgICAgICBlbmhhbmNlci5zZXRSZWRlZmluZSh0\ncnVlKTsKICAgICAgICAgICAgZW5oYW5jZXIuc2V0Q3JlYXRlU3ViY2xhc3Mo\ndHJ1ZSk7CiAgICAgICAgICAgIGVuaGFuY2VyLnNldEFkZERlZmF1bHRDb25z\ndHJ1Y3Rvcih0cnVlKTsKCiAgICAgICAgICAgIC8vIHNldCB0aGlzIGJlZm9y\nZSBlbmhhbmNlbWVudCBhcyB3ZWxsIGFzIGFmdGVyIHNpbmNlIGVuaGFuY2Vt\nZW50CiAgICAgICAgICAgIC8vIHVzZXMgYSBkaWZmZXJlbnQgbWV0YWRhdGEg\ncmVwb3NpdG9yeSwgYW5kIHRoZSBtZXRhZGF0YSBjb25maWcKICAgICAgICAg\nICAgLy8gbWF0dGVycyBpbiB0aGUgZW5oYW5jZW1lbnQgY29udHJhY3QuIERv\nbid0IGRvIGFueSB3YXJuaW5nIGhlcmUsCiAgICAgICAgICAgIC8vIHNpbmNl\nIHdlJ2xsIGlzc3VlIHdhcm5pbmdzIHdoZW4gd2UgZG8gdGhlIGZpbmFsIG1l\ndGFkYXRhCiAgICAgICAgICAgIC8vIHJlY29uZmlndXJhdGlvbiBhdCB0aGUg\nZW5kIG9mIHRoaXMgbWV0aG9kLgogICAgICAgICAgICBjb25maWd1cmVNZXRh\nRGF0YShlbmhhbmNlci5nZXRNZXRhRGF0YSgpLCBjb25mLCByZWRlZmluZSwg\nZmFsc2UpOwoKICAgICAgICAgICAgdW5zcGVjaWZpZWQgPSBjb2xsZWN0UmVs\nYXRlZFVuc3BlY2lmaWVkVHlwZXMoZW5oYW5jZXIuZ2V0TWV0YURhdGEoKSwK\nICAgICAgICAgICAgICAgIGNsYXNzZXMsIHVuc3BlY2lmaWVkKTsKCiAgICAg\nICAgICAgIGludCBydW5SZXN1bHQgPSBlbmhhbmNlci5ydW4oKTsKICAgICAg\nICAgICAgaWYgKHJ1blJlc3VsdCA9PSBQQ0VuaGFuY2VyLkVOSEFOQ0VfUEMp\nIHsKICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAg\nZW5oYW5jZXIucmVjb3JkKCk7CiAgICAgICAgICAgICAgICB9IGNhdGNoIChJ\nT0V4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgICAgICAgICAgLy8gb3VyIGlt\ncGwgb2YgQnl0ZWNvZGVXcml0ZXIgZG9lc24ndCB0aHJvdyBJT0V4Y2VwdGlv\nbgogICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBJbnRlcm5hbEV4Y2Vw\ndGlvbihlKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAg\nICAgIH0KCiAgICAgICAgaWYgKHVuc3BlY2lmaWVkICE9IG51bGwgJiYgIXVu\nc3BlY2lmaWVkLmlzRW1wdHkoKSkKICAgICAgICAgICAgdGhyb3cgbmV3IFVz\nZXJFeGNlcHRpb24oX2xvYy5nZXQoInVuc3BlY2lmaWVkLXVuZW5oYW5jZWQt\ndHlwZXMiLAogICAgICAgICAgICAgICAgY2xhc3NlcywgdW5zcGVjaWZpZWQp\nKTsKCiAgICAgICAgQ2xhc3NSZWRlZmluZXIucmVkZWZpbmVDbGFzc2VzKGNv\nbmYsIG1hcCk7CiAgICAgICAgZm9yIChDbGFzcyBjbHMgOiBtYXAua2V5U2V0\nKCkpIHsKICAgICAgICAgICAgc2V0SW50ZXJjZXB0aW5nKGNvbmYsIGVudkxv\nYWRlciwgY2xzKTsKICAgICAgICAgICAgY29uZmlndXJlTWV0YURhdGEoY29u\nZiwgZW52TG9hZGVyLCBjbHMsIHJlZGVmaW5lKTsKICAgICAgICB9CiAgICAg\nICAgZm9yIChDbGFzcyBjbHMgOiAoQ29sbGVjdGlvbjxDbGFzcz4pIHN1YnMp\nCiAgICAgICAgICAgIGNvbmZpZ3VyZU1ldGFEYXRhKGNvbmYsIGVudkxvYWRl\nciwgY2xzLCByZWRlZmluZSk7CiAgICAgICAgZm9yIChDbGFzcyBjbHMgOiAo\nQ29sbGVjdGlvbjxDbGFzcz4pIGludHMpCiAgICAgICAgICAgIHNldEludGVy\nY2VwdGluZyhjb25mLCBlbnZMb2FkZXIsIGNscyk7CgogICAgICAgIHJldHVy\nbiBzdWJzOwogICAgfQoKICAgIHByaXZhdGUgc3RhdGljIFNldDxDbGFzcz4g\nY29sbGVjdFJlbGF0ZWRVbnNwZWNpZmllZFR5cGVzKENsYXNzTWV0YURhdGEg\nbWV0YSwKICAgICAgICBDb2xsZWN0aW9uPD8gZXh0ZW5kcyBDbGFzcz4gY2xh\nc3NlcywgU2V0PENsYXNzPiB1bnNwZWNpZmllZCkgewogICAgICAgIHVuc3Bl\nY2lmaWVkID0gY29sbGVjdFVuc3BlY2lmaWVkVHlwZShtZXRhLmdldFBDU3Vw\nZXJjbGFzcygpLCBjbGFzc2VzLAogICAgICAgICAgICB1bnNwZWNpZmllZCk7\nCgogICAgICAgIGZvciAoRmllbGRNZXRhRGF0YSBmbWQgOiBtZXRhLmdldEZp\nZWxkcygpKSB7CiAgICAgICAgICAgIGlmIChmbWQuaXNUcmFuc2llbnQoKSkK\nICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICBpZiAoZm1k\nLmlzVHlwZVBDKCkpCiAgICAgICAgICAgICAgICB1bnNwZWNpZmllZCA9IGNv\nbGxlY3RVbnNwZWNpZmllZFR5cGUoZm1kLmdldFR5cGUoKSwgY2xhc3NlcywK\nICAgICAgICAgICAgICAgICAgICB1bnNwZWNpZmllZCk7CiAgICAgICAgICAg\nIGlmIChmbWQuZ2V0RWxlbWVudCgpICE9IG51bGwgJiYgZm1kLmdldEVsZW1l\nbnQoKS5pc1R5cGVQQygpKQogICAgICAgICAgICAgICAgdW5zcGVjaWZpZWQg\nPSBjb2xsZWN0VW5zcGVjaWZpZWRUeXBlKGZtZC5nZXRFbGVtZW50KCkuZ2V0\nVHlwZSgpLAogICAgICAgICAgICAgICAgICAgIGNsYXNzZXMsIHVuc3BlY2lm\naWVkKTsKICAgICAgICAgICAgaWYgKGZtZC5nZXRLZXkoKSAhPSBudWxsICYm\nIGZtZC5nZXRLZXkoKS5pc1R5cGVQQygpKQogICAgICAgICAgICAgICAgdW5z\ncGVjaWZpZWQgPSBjb2xsZWN0VW5zcGVjaWZpZWRUeXBlKGZtZC5nZXRLZXko\nKS5nZXRUeXBlKCksCiAgICAgICAgICAgICAgICAgICAgY2xhc3NlcywgdW5z\ncGVjaWZpZWQpOwogICAgICAgICAgICBpZiAoZm1kLmdldFZhbHVlKCkgIT0g\nbnVsbCAmJiBmbWQuZ2V0VmFsdWUoKS5pc1R5cGVQQygpKQogICAgICAgICAg\nICAgICAgdW5zcGVjaWZpZWQgPSBjb2xsZWN0VW5zcGVjaWZpZWRUeXBlKGZt\nZC5nZXRWYWx1ZSgpLmdldFR5cGUoKSwKICAgICAgICAgICAgICAgICAgICBj\nbGFzc2VzLCB1bnNwZWNpZmllZCk7CiAgICAgICAgfQogICAgICAgIHJldHVy\nbiB1bnNwZWNpZmllZDsKICAgIH0KCiAgICBwcml2YXRlIHN0YXRpYyBTZXQ8\nQ2xhc3M+IGNvbGxlY3RVbnNwZWNpZmllZFR5cGUoQ2xhc3MgY2xzLAogICAg\nICAgIENvbGxlY3Rpb248PyBleHRlbmRzIENsYXNzPiBjbGFzc2VzLCBTZXQ8\nQ2xhc3M+IHVuc3BlY2lmaWVkKSB7CiAgICAgICAgaWYgKGNscyAhPSBudWxs\nICYmICFjbGFzc2VzLmNvbnRhaW5zKGNscykKICAgICAgICAgICAgJiYgIUlt\ncGxIZWxwZXIuaXNNYW5hZ2VkVHlwZShudWxsLCBjbHMpKSB7CiAgICAgICAg\nICAgIGlmICh1bnNwZWNpZmllZCA9PSBudWxsKQogICAgICAgICAgICAgICAg\ndW5zcGVjaWZpZWQgPSBuZXcgSGFzaFNldDxDbGFzcz4oKTsKICAgICAgICAg\nICAgdW5zcGVjaWZpZWQuYWRkKGNscyk7CiAgICAgICAgfQogICAgICAgIHJl\ndHVybiB1bnNwZWNpZmllZDsKICAgIH0KCiAgICBwcml2YXRlIHN0YXRpYyB2\nb2lkIGNvbmZpZ3VyZU1ldGFEYXRhKE9wZW5KUEFDb25maWd1cmF0aW9uIGNv\nbmYsCiAgICAgICAgQ2xhc3NMb2FkZXIgZW52TG9hZGVyLCBDbGFzcyBjbHMs\nIGJvb2xlYW4gcmVkZWZpbmVBdmFpbGFibGUpIHsKICAgICAgICBDbGFzc01l\ndGFEYXRhIG1ldGEgPSBjb25mLmdldE1ldGFEYXRhUmVwb3NpdG9yeUluc3Rh\nbmNlKCkKICAgICAgICAgICAgLmdldE1ldGFEYXRhKGNscywgZW52TG9hZGVy\nLCB0cnVlKTsKICAgICAgICBjb25maWd1cmVNZXRhRGF0YShtZXRhLCBjb25m\nLCByZWRlZmluZUF2YWlsYWJsZSwgdHJ1ZSk7CiAgICB9CgogICAgcHJpdmF0\nZSBzdGF0aWMgdm9pZCBjb25maWd1cmVNZXRhRGF0YShDbGFzc01ldGFEYXRh\nIG1ldGEsCiAgICAgICAgT3BlbkpQQUNvbmZpZ3VyYXRpb24gY29uZiwgYm9v\nbGVhbiByZWRlZmluZUF2YWlsYWJsZSwgYm9vbGVhbiB3YXJuKSB7CgogICAg\nICAgIHNldERldGFjaGVkU3RhdGUobWV0YSk7CgogICAgICAgIGlmICh3YXJu\nICYmIG1ldGEuZ2V0QWNjZXNzVHlwZSgpID09IENsYXNzTWV0YURhdGEuQUND\nRVNTX0ZJRUxECiAgICAgICAgICAgICYmICFyZWRlZmluZUF2YWlsYWJsZSkg\newogICAgICAgICAgICAvLyBvbmx5IHdhcm4gYWJvdXQgZGVjbGFyZWQgZmll\nbGRzOyBzdXBlcmNsYXNzIGZpZWxkcyB3aWxsIGJlCiAgICAgICAgICAgIC8v\nIHdhcm5lZCBhYm91dCB3aGVuIHRoZSBzdXBlcmNsYXNzIGlzIGhhbmRsZWQK\nICAgICAgICAgICAgZm9yIChGaWVsZE1ldGFEYXRhIGZtZCA6IG1ldGEuZ2V0\nRGVjbGFyZWRGaWVsZHMoKSkgewogICAgICAgICAgICAgICAgc3dpdGNoIChm\nbWQuZ2V0VHlwZUNvZGUoKSkgewogICAgICAgICAgICAgICAgICAgIGNhc2Ug\nSmF2YVR5cGVzLkNPTExFQ1RJT046CiAgICAgICAgICAgICAgICAgICAgY2Fz\nZSBKYXZhVHlwZXMuTUFQOgogICAgICAgICAgICAgICAgICAgICAgICAvLyB3\nZSBjYW4gbGF6aWx5IGxvYWQgdGhlc2UsIHNpbmNlIHdlIG93biB0aGUKICAg\nICAgICAgICAgICAgICAgICAgICAgLy8gcmVsYXRpb25zaGlwIGNvbnRhaW5l\ncgogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAg\nICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgICAgICAgICAgICBpZiAo\nIWZtZC5pc0luRGVmYXVsdEZldGNoR3JvdXAoKQogICAgICAgICAgICAgICAg\nICAgICAgICAgICAgJiYgIShmbWQuaXNWZXJzaW9uKCkgfHwgZm1kLmlzUHJp\nbWFyeUtleSgpKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgTG9n\nIGxvZyA9IGNvbmYuZ2V0TG9nKAogICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgIE9wZW5KUEFDb25maWd1cmF0aW9uLkxPR19FTkhBTkNFKTsKICAg\nICAgICAgICAgICAgICAgICAgICAgICAgIGxvZy53YXJuKF9sb2MuZ2V0KCJz\ndWJjbGFzc2VyLWZldGNoLWdyb3VwLW92ZXJyaWRlIiwKICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICBtZXRhLmdldERlc2NyaWJlZFR5cGUoKS5n\nZXROYW1lKCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm1k\nLmdldE5hbWUoKSkpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm1k\nLnNldEluRGVmYXVsdEZldGNoR3JvdXAodHJ1ZSk7CiAgICAgICAgICAgICAg\nICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQog\nICAgICAgIH0KICAgIH0KCiAgICBwcml2YXRlIHN0YXRpYyB2b2lkIHdyaXRl\nKEJDQ2xhc3MgYmMsIFBDRW5oYW5jZXIgZW5oYW5jZXIsCiAgICAgICAgTWFw\nPENsYXNzLCBieXRlW10+IG1hcCwgQ2xhc3MgY2xzLCBMaXN0IHN1YnMsIExp\nc3QgaW50cykKICAgICAgICB0aHJvd3MgSU9FeGNlcHRpb24gewoKICAgICAg\nICBpZiAoYmMgPT0gZW5oYW5jZXIuZ2V0TWFuYWdlZFR5cGVCeXRlY29kZSgp\nKSB7CiAgICAgICAgICAgIC8vIGlmIGl0IHdhcyBhbHJlYWR5IGRlZmluZWQs\nIGRvbid0IHB1dCBpdCBpbiB0aGUgbWFwLAogICAgICAgICAgICAvLyBidXQg\nZG8gc2V0IHRoZSBtZXRhZGF0YSBhY2NvcmRpbmdseS4KICAgICAgICAgICAg\naWYgKGVuaGFuY2VyLmlzQWxyZWFkeVJlZGVmaW5lZCgpKQogICAgICAgICAg\nICAgICAgaW50cy5hZGQoYmMuZ2V0VHlwZSgpKTsKICAgICAgICAgICAgZWxz\nZSBpZiAoSmF2YVZlcnNpb25zLlZFUlNJT04gPj0gNSkgewogICAgICAgICAg\nICAgICAgbWFwLnB1dChiYy5nZXRUeXBlKCksIGJjLnRvQnl0ZUFycmF5KCkp\nOwogICAgICAgICAgICAgICAgZGVidWdCeXRlY29kZXMoYmMpOwogICAgICAg\nICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgaWYgKCFlbmhh\nbmNlci5pc0FscmVhZHlTdWJjbGFzc2VkKCkpIHsKICAgICAgICAgICAgICAg\nIGRlYnVnQnl0ZWNvZGVzKGJjKTsKICAgICAgICAgICAgICAgIAogICAgICAg\nICAgICAgICAgLy8gdGhpcyBpcyB0aGUgbmV3IHN1YmNsYXNzCiAgICAgICAg\nICAgICAgICBDbGFzc0xvYWRlciBsb2FkZXIgPSBHZW5lcmF0ZWRDbGFzc2Vz\nLmdldE1vc3REZXJpdmVkTG9hZGVyKAogICAgICAgICAgICAgICAgICAgIGNs\ncywgUGVyc2lzdGVuY2VDYXBhYmxlLmNsYXNzKTsKICAgICAgICAgICAgICAg\nIHN1YnMuYWRkKEdlbmVyYXRlZENsYXNzZXMubG9hZEJDQ2xhc3MoYmMsIGxv\nYWRlcikpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQoKICAgIHBy\naXZhdGUgc3RhdGljIHZvaWQgZGVidWdCeXRlY29kZXMoQkNDbGFzcyBiYykg\ndGhyb3dzIElPRXhjZXB0aW9uIHsKICAgICAgICAvLyBXcml0ZSB0aGUgYnl0\nZWNvZGVzIHRvIGRpc2sgZm9yIGRlYnVnZ2luZyBwdXJwb3Nlcy4KICAgICAg\nICBpZiAoInRydWUiLmVxdWFscyhTeXN0ZW0uZ2V0UHJvcGVydHkoCiAgICAg\nICAgICAgIE1hbmFnZWRDbGFzc1N1YmNsYXNzZXIuY2xhc3MuZ2V0TmFtZSgp\nICsgIi5kdW1wQnl0ZWNvZGVzIikpKQogICAgICAgIHsKICAgICAgICAgICAg\nRmlsZSB0bXAgPSBuZXcgRmlsZShTeXN0ZW0uZ2V0UHJvcGVydHkoImphdmEu\naW8udG1wZGlyIikpOwogICAgICAgICAgICBGaWxlIGRpciA9IG5ldyBGaWxl\nKHRtcCwgIm9wZW5qcGEiKTsKICAgICAgICAgICAgZGlyID0gbmV3IEZpbGUo\nZGlyLCAicGNzdWJjbGFzc2VzIik7CiAgICAgICAgICAgIGRpci5ta2RpcnMo\nKTsKICAgICAgICAgICAgZGlyID0gRmlsZXMuZ2V0UGFja2FnZUZpbGUoZGly\nLCBiYy5nZXRQYWNrYWdlTmFtZSgpLCB0cnVlKTsKICAgICAgICAgICAgRmls\nZSBmID0gbmV3IEZpbGUoZGlyLCBiYy5nZXRDbGFzc05hbWUoKSArICIuY2xh\nc3MiKTsKICAgICAgICAgICAgU3lzdGVtLmVyci5wcmludGxuKCJXcml0aW5n\nIHRvICIgKyBmKTsKICAgICAgICAgICAgYmMud3JpdGUoZik7CiAgICAgICAg\nfQogICAgfQoKICAgIHByaXZhdGUgc3RhdGljIHZvaWQgc2V0SW50ZXJjZXB0\naW5nKE9wZW5KUEFDb25maWd1cmF0aW9uIGNvbmYsCiAgICAgICAgQ2xhc3NM\nb2FkZXIgZW52TG9hZGVyLCBDbGFzcyBjbHMpIHsKICAgICAgICBDbGFzc01l\ndGFEYXRhIG1ldGEgPSBjb25mLmdldE1ldGFEYXRhUmVwb3NpdG9yeUluc3Rh\nbmNlKCkKICAgICAgICAgICAgLmdldE1ldGFEYXRhKGNscywgZW52TG9hZGVy\nLCB0cnVlKTsKICAgICAgICBtZXRhLnNldEludGVyY2VwdGluZyh0cnVlKTsK\nICAgIH0KCiAgICAvKioKICAgICAqIElmIHRoZSBtZXRhZGF0YSBpcyBjb25m\naWd1cmVkIHRvIHVzZSBhIHN5bnRoZXRpYwogICAgICogZGV0YWNoZWQgc3Rh\ndGUsIHJlc2V0IGl0IHRvIG5vdCB1c2UgYSBkZXRhY2hlZAogICAgICogc3Rh\ndGUgZmllbGQsIHNpbmNlIHdlIGNhbid0IGFkZCBmaWVsZHMgd2hlbiByZWRl\nZmluaW5nLgogICAgICovCiAgICBwcml2YXRlIHN0YXRpYyB2b2lkIHNldERl\ndGFjaGVkU3RhdGUoQ2xhc3NNZXRhRGF0YSBtZXRhKSB7CiAgICAgICAgaWYg\nKENsYXNzTWV0YURhdGEuU1lOVEhFVElDLmVxdWFscyhtZXRhLmdldERldGFj\naGVkU3RhdGUoKSkpCiAgICAgICAgICAgIG1ldGEuc2V0RGV0YWNoZWRTdGF0\nZShudWxsKTsKICAgIH0KfQo=\n","encoding":"base64"}

