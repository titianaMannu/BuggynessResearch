{"sha":"dd95fa2373bcaeb3004ad6b707946bd68f72d661","node_id":"MDQ6QmxvYjIwNjM2NDpkZDk1ZmEyMzczYmNhZWIzMDA0YWQ2YjcwNzk0NmJkNjhmNzJkNjYx","size":41580,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/dd95fa2373bcaeb3004ad6b707946bd68f72d661","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuZW5oYW5jZTsKCmltcG9ydCBq\nYXZhLnV0aWwuQml0U2V0OwppbXBvcnQgamF2YS51dGlsLkNvbGxlY3Rpb247\nCmltcG9ydCBqYXZhLnV0aWwuSXRlcmF0b3I7CmltcG9ydCBqYXZhLnV0aWwu\nTGlua2VkTGlzdDsKaW1wb3J0IGphdmEudXRpbC5NYXA7CgppbXBvcnQgb3Jn\nLmFwYWNoZS5jb21tb25zLmxhbmcuU3RyaW5nVXRpbHM7CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEuY29uZi5PcGVuSlBBQ29uZmlndXJhdGlvbjsKaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuQWJzdHJhY3RQQ0RhdGE7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLkZldGNoQ29uZmln\ndXJhdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuT3Bl\nbkpQQVN0YXRlTWFuYWdlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5r\nZXJuZWwuUENEYXRhOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5l\nbC5TdG9yZUNvbnRleHQ7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGli\nLmxvZy5Mb2c7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwu\nTG9jYWxpemVyOwppbXBvcnQgamF2YS51dGlsLmNvbmN1cnJlbnQuQ29uY3Vy\ncmVudEhhc2hNYXA7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YS5D\nbGFzc01ldGFEYXRhOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEu\nRmllbGRNZXRhRGF0YTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRh\nLkphdmFUeXBlczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLklu\ndGVybmFsRXhjZXB0aW9uOwppbXBvcnQgc2VycC5ieXRlY29kZS5CQ0NsYXNz\nOwppbXBvcnQgc2VycC5ieXRlY29kZS5CQ0ZpZWxkOwppbXBvcnQgc2VycC5i\neXRlY29kZS5CQ01ldGhvZDsKaW1wb3J0IHNlcnAuYnl0ZWNvZGUuQ29kZTsK\naW1wb3J0IHNlcnAuYnl0ZWNvZGUuQ29uc3RhbnRzOwppbXBvcnQgc2VycC5i\neXRlY29kZS5FeGNlcHRpb25IYW5kbGVyOwppbXBvcnQgc2VycC5ieXRlY29k\nZS5JbnN0cnVjdGlvbjsKaW1wb3J0IHNlcnAuYnl0ZWNvZGUuSnVtcEluc3Ry\ndWN0aW9uOwppbXBvcnQgc2VycC5ieXRlY29kZS5Mb29rdXBTd2l0Y2hJbnN0\ncnVjdGlvbjsKCi8qKgogKiBHZW5lcmF0ZXMge0BsaW5rIFBDRGF0YX0gaW5z\ndGFuY2VzIHdoaWNoIGF2b2lkIHByaW1pdHZlIHdyYXBwZXJzCiAqIHRvIG9w\ndGltaXplIG1lbW9yeSB1c2UgYW5kIHBlcmZvcm1hbmNlIGF0IHRoZSBjb3N0\nIG9mIHNsaWdodGx5IGhpZ2hlcgogKiBzdGFydHVwIHRpbWUuCiAqCiAqIEBh\ndXRob3IgU3RldmUgS2ltCiAqIEBub2phdmFkb2MKICogQHNpbmNlIDAuMy4y\nCiAqLwpwdWJsaWMgY2xhc3MgUENEYXRhR2VuZXJhdG9yCiAgICBleHRlbmRz\nIER5bmFtaWNTdG9yYWdlR2VuZXJhdG9yIHsKCiAgICBwcml2YXRlIHN0YXRp\nYyBmaW5hbCBMb2NhbGl6ZXIgX2xvYyA9IExvY2FsaXplci5mb3JQYWNrYWdl\nCiAgICAgICAgKFBDRGF0YUdlbmVyYXRvci5jbGFzcyk7CgogICAgcHJvdGVj\ndGVkIHN0YXRpYyBmaW5hbCBTdHJpbmcgUE9TVEZJWCA9ICIkb3BlbmpwYXBj\nZGF0YSI7CgogICAgcHJpdmF0ZSBmaW5hbCBNYXAgX2dlbmVyYXRlZCA9IG5l\ndyBDb25jdXJyZW50SGFzaE1hcCgpOwogICAgcHJpdmF0ZSBmaW5hbCBPcGVu\nSlBBQ29uZmlndXJhdGlvbiBfY29uZjsKICAgIHByaXZhdGUgZmluYWwgTG9n\nIF9sb2c7CgogICAgcHVibGljIFBDRGF0YUdlbmVyYXRvcihPcGVuSlBBQ29u\nZmlndXJhdGlvbiBjb25mKSB7CiAgICAgICAgX2NvbmYgPSBjb25mOwogICAg\nICAgIF9sb2cgPSBfY29uZi5nZXRMb2dGYWN0b3J5KCkuZ2V0TG9nKE9wZW5K\nUEFDb25maWd1cmF0aW9uLkxPR19FTkhBTkNFKTsKICAgIH0KCiAgICAvKioK\nICAgICAqIFJldHVybiB0aGUgY29uZmlndXJhdGlvbi4KICAgICAqLwogICAg\ncHVibGljIE9wZW5KUEFDb25maWd1cmF0aW9uIGdldENvbmZpZ3VyYXRpb24o\nKSB7CiAgICAgICAgcmV0dXJuIF9jb25mOwogICAgfQoKICAgIC8qKgogICAg\nICogUmV0dXJuIGEge0BsaW5rIFBDRGF0YX0gaW5zdGFuY2UgZm9yIHRoZSBn\naXZlbiBvaWQgYW5kIG1ldGFkYXRhLgogICAgICovCiAgICBwdWJsaWMgUENE\nYXRhIGdlbmVyYXRlUENEYXRhKE9iamVjdCBvaWQsIENsYXNzTWV0YURhdGEg\nbWV0YSkgewogICAgICAgIGlmIChtZXRhID09IG51bGwpCiAgICAgICAgICAg\nIHJldHVybiBudWxsOwogICAgICAgIENsYXNzIHR5cGUgPSBtZXRhLmdldERl\nc2NyaWJlZFR5cGUoKTsKICAgICAgICBEeW5hbWljU3RvcmFnZSBzdG9yYWdl\nID0gKER5bmFtaWNTdG9yYWdlKSBfZ2VuZXJhdGVkLmdldCh0eXBlKTsKICAg\nICAgICBpZiAoc3RvcmFnZSA9PSBudWxsKSB7CiAgICAgICAgICAgIHN0b3Jh\nZ2UgPSBnZW5lcmF0ZVN0b3JhZ2UobWV0YSk7CiAgICAgICAgICAgIF9nZW5l\ncmF0ZWQucHV0KHR5cGUsIHN0b3JhZ2UpOwogICAgICAgICAgICBpZiAoX2xv\nZy5pc1RyYWNlRW5hYmxlZCgpKQogICAgICAgICAgICAgICAgX2xvZy50cmFj\nZShfbG9jLmdldCgicGNkYXRhLWNyZWF0ZWQiLCB0eXBlLmdldE5hbWUoKSwg\nbWV0YSkpOwogICAgICAgIH0KICAgICAgICBEeW5hbWljUENEYXRhIGRhdGEg\nPSAoRHluYW1pY1BDRGF0YSkgc3RvcmFnZS5uZXdJbnN0YW5jZSgpOwogICAg\nICAgIGRhdGEuc2V0SWQob2lkKTsKICAgICAgICBkYXRhLnNldFN0b3JhZ2VH\nZW5lcmF0b3IodGhpcyk7CiAgICAgICAgZmluaXNoKGRhdGEsIG1ldGEpOwog\nICAgICAgIHJldHVybiBkYXRhOwogICAgfQoKICAgIC8qKgogICAgICogQWN0\ndWFsbHkgZ2VuZXJhdGUgdGhlIGZhY3RvcnkgaW5zdGFuY2UuCiAgICAgKi8K\nICAgIHByaXZhdGUgRHluYW1pY1N0b3JhZ2UgZ2VuZXJhdGVTdG9yYWdlKENs\nYXNzTWV0YURhdGEgbWV0YSkgewogICAgICAgIGlmIChfbG9nLmlzVHJhY2VF\nbmFibGVkKCkpCiAgICAgICAgICAgIF9sb2cudHJhY2UoX2xvYy5nZXQoInBj\nZGF0YS1nZW5lcmF0ZSIsIG1ldGEpKTsKCiAgICAgICAgRmllbGRNZXRhRGF0\nYVtdIGZpZWxkcyA9IG1ldGEuZ2V0RmllbGRzKCk7CiAgICAgICAgaW50W10g\ndHlwZXMgPSBuZXcgaW50W2ZpZWxkcy5sZW5ndGhdOwogICAgICAgIGZvciAo\naW50IGkgPSAwOyBpIDwgdHlwZXMubGVuZ3RoOyBpKyspCiAgICAgICAgICAg\nIHR5cGVzW2ldID0gcmVwbGFjZVR5cGUoZmllbGRzW2ldKTsKICAgICAgICBy\nZXR1cm4gZ2VuZXJhdGVTdG9yYWdlKHR5cGVzLCBtZXRhKTsKICAgIH0KCiAg\nICAvKioKICAgICAqIFBlcmZvcm0gYW55IGZpbmFsIGFjdGlvbnMgYmVmb3Jl\nIHRoZSBwY2RhdGEgaXMgcmV0dXJuZWQgdG8gY2xpZW50IGNvZGUuCiAgICAg\nKi8KICAgIHByb3RlY3RlZCB2b2lkIGZpbmlzaChEeW5hbWljUENEYXRhIGRh\ndGEsIENsYXNzTWV0YURhdGEgbWV0YSkgewogICAgfQoKICAgIHByb3RlY3Rl\nZCBpbnQgZ2V0Q3JlYXRlRmllbGRNZXRob2RzKGludCB0eXBlQ29kZSkgewog\nICAgICAgIGlmICh0eXBlQ29kZSA+PSBKYXZhVHlwZXMuT0JKRUNUKQogICAg\nICAgICAgICByZXR1cm4gUE9MSUNZX1NJTEVOVDsKICAgICAgICAvLyBkb24n\ndCBib3RoZXIgY3JlYXRpbmcgc2V0L2dldDxQcmltaXRpdmU+IG1ldGhvZHMK\nICAgICAgICByZXR1cm4gUE9MSUNZX0VNUFRZOwogICAgfQoKICAgIHByb3Rl\nY3RlZCB2b2lkIGRlY2xhcmVDbGFzc2VzKEJDQ2xhc3MgYmMpIHsKICAgICAg\nICBzdXBlci5kZWNsYXJlQ2xhc3NlcyhiYyk7CiAgICAgICAgYmMuZGVjbGFy\nZUludGVyZmFjZShEeW5hbWljUENEYXRhLmNsYXNzKTsKICAgICAgICBiYy5z\nZXRTdXBlcmNsYXNzKEFic3RyYWN0UENEYXRhLmNsYXNzKTsKICAgIH0KCiAg\nICBwcm90ZWN0ZWQgZmluYWwgU3RyaW5nIGdldENsYXNzTmFtZShPYmplY3Qg\nb2JqKSB7CiAgICAgICAgcmV0dXJuIGdldFVuaXF1ZU5hbWUoKChDbGFzc01l\ndGFEYXRhKSBvYmopLmdldERlc2NyaWJlZFR5cGUoKSk7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBDcmVhdGVzIGEgdW5pcXVlIG5hbWUgZm9yIHRoZSBnaXZl\nbiB0eXBlJ3MgcGNkYXRhIGltcGxlbWVudGF0aW9uLgogICAgICovCiAgICBw\ncm90ZWN0ZWQgU3RyaW5nIGdldFVuaXF1ZU5hbWUoQ2xhc3MgdHlwZSkgewog\nICAgICAgIHJldHVybiB0eXBlLmdldE5hbWUoKSArICIkIiArIFN5c3RlbS5p\nZGVudGl0eUhhc2hDb2RlKHR5cGUpICsgUE9TVEZJWDsKICAgIH0KCiAgICBw\ncm90ZWN0ZWQgZmluYWwgdm9pZCBkZWNvcmF0ZShPYmplY3Qgb2JqLCBCQ0Ns\nYXNzIGJjLCBpbnRbXSB0eXBlcykgewogICAgICAgIHN1cGVyLmRlY29yYXRl\nKG9iaiwgYmMsIHR5cGVzKTsKICAgICAgICBDbGFzc01ldGFEYXRhIG1ldGEg\nPSAoQ2xhc3NNZXRhRGF0YSkgb2JqOwoKICAgICAgICBlbmhhbmNlQ29uc3Ry\ndWN0b3IoYmMpOwogICAgICAgIGFkZEJhc2VGaWVsZHMoYmMpOwogICAgICAg\nIGFkZEltcGxEYXRhTWV0aG9kcyhiYywgbWV0YSk7CiAgICAgICAgYWRkRmll\nbGRJbXBsRGF0YU1ldGhvZHMoYmMsIG1ldGEpOwogICAgICAgIGFkZFZlcnNp\nb25NZXRob2RzKGJjKTsKICAgICAgICBhZGRHZXRUeXBlKGJjLCBtZXRhKTsK\nICAgICAgICBhZGRMb2FkTWV0aG9kKGJjLCBtZXRhKTsKICAgICAgICBhZGRM\nb2FkV2l0aEZpZWxkc01ldGhvZChiYywgbWV0YSk7CiAgICAgICAgYWRkU3Rv\ncmVNZXRob2RzKGJjLCBtZXRhKTsKICAgICAgICBhZGROZXdFbWJlZGRlZChi\nYyk7CiAgICAgICAgYWRkR2V0RGF0YShiYyk7CiAgICAgICAgZGVjb3JhdGUo\nYmMsIG1ldGEpOwogICAgfQoKICAgIC8qKgogICAgICogQXBwbHkgYWRkaXRp\nb25hbCBkZWNvcmF0aW9uIHRvIGdlbmVyYXRlZCBjbGFzcy4KICAgICAqLwog\nICAgcHJvdGVjdGVkIHZvaWQgZGVjb3JhdGUoQkNDbGFzcyBiYywgQ2xhc3NN\nZXRhRGF0YSBtZXRhKSB7CiAgICB9CgogICAgLyoqCiAgICAgKiBFbmhhbmNl\nIGNvbnN0cnVjdG9yIHRvIGluaXRpYWxpemUgZmllbGRzCiAgICAgKi8KICAg\nIHByaXZhdGUgdm9pZCBlbmhhbmNlQ29uc3RydWN0b3IoQkNDbGFzcyBiYykg\newogICAgICAgIEJDTWV0aG9kIGNvbnMgPSBiYy5nZXREZWNsYXJlZE1ldGhv\nZCgiPGluaXQ+IiwgKFN0cmluZ1tdKSBudWxsKTsKICAgICAgICBDb2RlIGNv\nZGUgPSBjb25zLmdldENvZGUoZmFsc2UpOwogICAgICAgIGNvZGUuYWZ0ZXJM\nYXN0KCk7CiAgICAgICAgY29kZS5wcmV2aW91cygpOwoKICAgICAgICAvLyBw\ncml2YXRlIEJpdFNldCBsb2FkZWQgPSBuZXcgQml0U2V0KCk7CiAgICAgICAg\nQkNGaWVsZCBsb2FkZWQgPSBhZGRCZWFuRmllbGQoYmMsICJsb2FkZWQiLCBC\naXRTZXQuY2xhc3MpOwogICAgICAgIGxvYWRlZC5zZXRGaW5hbCh0cnVlKTsK\nICAgICAgICBjb2RlLmFsb2FkKCkuc2V0VGhpcygpOwogICAgICAgIGNvZGUu\nYW5ldygpLnNldFR5cGUoQml0U2V0LmNsYXNzKTsKICAgICAgICBjb2RlLmR1\ncCgpOwogICAgICAgIGNvZGUuY29uc3RhbnQoKS5zZXRWYWx1ZShiYy5nZXRG\naWVsZHMoKS5sZW5ndGgpOwogICAgICAgIGNvZGUuaW52b2tlc3BlY2lhbCgp\nLnNldE1ldGhvZChCaXRTZXQuY2xhc3MsICI8aW5pdD4iLCB2b2lkLmNsYXNz\nLAogICAgICAgICAgICBuZXcgQ2xhc3NbXXsgaW50LmNsYXNzIH0pOwogICAg\nICAgIGNvZGUucHV0ZmllbGQoKS5zZXRGaWVsZChsb2FkZWQpOwoKICAgICAg\nICBjb2RlLmNhbGN1bGF0ZU1heFN0YWNrKCk7CiAgICAgICAgY29kZS5jYWxj\ndWxhdGVNYXhMb2NhbHMoKTsKICAgIH0KCiAgICAvKioKICAgICAqIEhhdmUg\ndG8gbG9hZCB0aGUgdHlwZSBzaW5jZSBpdCBtYXkgbm90IGJlIGF2YWlsYWJs\nZSB0byB0aGUKICAgICAqIHNhbWUgY2xhc3Nsb2FkZXIgKGkuZS4gcmFyIHZz\nLiBlYXIpLiBUaGUgY29udGV4dCBjbGFzc2xvYWRlcgogICAgICogKGkuZS4g\ndGhlIHVzZXIgYXBwIGNsYXNzbG9hZGVyKSBzaG91bGQgYmUgZmluZS4KICAg\nICAqLwogICAgcHJpdmF0ZSB2b2lkIGFkZEdldFR5cGUoQkNDbGFzcyBiYywg\nQ2xhc3NNZXRhRGF0YSBtZXRhKSB7CiAgICAgICAgQkNGaWVsZCB0eXBlID0g\nYmMuZGVjbGFyZUZpZWxkKCJ0eXBlIiwgQ2xhc3MuY2xhc3MpOwogICAgICAg\nIHR5cGUuc2V0U3RhdGljKHRydWUpOwogICAgICAgIHR5cGUubWFrZVByaXZh\ndGUoKTsKICAgICAgICAvLyBwdWJsaWMgQ2xhc3MgZ2V0VHlwZSgpIHsKICAg\nICAgICBCQ01ldGhvZCBnZXR0ZXIgPSBiYy5kZWNsYXJlTWV0aG9kKCJnZXRU\neXBlIiwgQ2xhc3MuY2xhc3MsIG51bGwpOwogICAgICAgIGdldHRlci5tYWtl\nUHVibGljKCk7CiAgICAgICAgQ29kZSBjb2RlID0gZ2V0dGVyLmdldENvZGUo\ndHJ1ZSk7CiAgICAgICAgLy8gaWYgKHR5cGUgPT0gbnVsbCkgewogICAgICAg\nIC8vIAkJdHJ5IHsKICAgICAgICAvLyAJCQl0eXBlID0gQ2xhc3MuZm9yTmFt\nZQogICAgICAgIC8vIAkJCQkobWV0YS5nZXREZXNjcmliZWRUeXBlKCkuZ2V0\nTmFtZSgpLCB0cnVlLAogICAgICAgIC8vIAkJCQlUaHJlYWQuY3VycmVudFRo\ncmVhZCgpLmdldENvbnRleHRDbGFzc0xvYWRlcigpKTsKICAgICAgICAvLyAJ\nCX0gY2F0Y2ggKENsYXNzTm90Rm91bmRFeGNlcHRpb24gY25mZSkgewogICAg\nICAgIC8vIAkJCXRocm93IG5ldyBJbnRlcm5hbEV4Y2VwdGlvbigpOwogICAg\nICAgIC8vIAkJfQogICAgICAgIC8vIH0KICAgICAgICBjb2RlLmdldHN0YXRp\nYygpLnNldEZpZWxkKHR5cGUpOwoKICAgICAgICBDb2xsZWN0aW9uIGp1bXBz\nID0gbmV3IExpbmtlZExpc3QoKTsKICAgICAgICBqdW1wcy5hZGQoY29kZS5p\nZm5vbm51bGwoKSk7CiAgICAgICAgRXhjZXB0aW9uSGFuZGxlciBoYW5kbGVy\nID0gY29kZS5hZGRFeGNlcHRpb25IYW5kbGVyKCk7CgogICAgICAgIGhhbmRs\nZXIuc2V0VHJ5U3RhcnQoY29kZS5jb25zdGFudCgpLnNldFZhbHVlCiAgICAg\nICAgICAgIChtZXRhLmdldERlc2NyaWJlZFR5cGUoKS5nZXROYW1lKCkpKTsK\nICAgICAgICBjb2RlLmNvbnN0YW50KCkuc2V0VmFsdWUodHJ1ZSk7CiAgICAg\nICAgY29kZS5pbnZva2VzdGF0aWMoKS5zZXRNZXRob2QoVGhyZWFkLmNsYXNz\nLCAiY3VycmVudFRocmVhZCIsCiAgICAgICAgICAgIFRocmVhZC5jbGFzcywg\nbnVsbCk7CiAgICAgICAgY29kZS5pbnZva2V2aXJ0dWFsKCkuc2V0TWV0aG9k\nKFRocmVhZC5jbGFzcywgImdldENvbnRleHRDbGFzc0xvYWRlciIsCiAgICAg\nICAgICAgIENsYXNzTG9hZGVyLmNsYXNzLCBudWxsKTsKICAgICAgICBjb2Rl\nLmludm9rZXN0YXRpYygpLnNldE1ldGhvZChDbGFzcy5jbGFzcywgImZvck5h\nbWUiLCBDbGFzcy5jbGFzcywKICAgICAgICAgICAgbmV3IENsYXNzW117IFN0\ncmluZy5jbGFzcywgYm9vbGVhbi5jbGFzcywgQ2xhc3NMb2FkZXIuY2xhc3Mg\nfSk7CiAgICAgICAgY29kZS5wdXRzdGF0aWMoKS5zZXRGaWVsZCh0eXBlKTsK\nICAgICAgICBJbnN0cnVjdGlvbiBnbzIgPSBjb2RlLmdvMigpOwogICAgICAg\nIGp1bXBzLmFkZChnbzIpOwogICAgICAgIGhhbmRsZXIuc2V0VHJ5RW5kKGdv\nMik7CiAgICAgICAgaGFuZGxlci5zZXRDYXRjaChDbGFzc05vdEZvdW5kRXhj\nZXB0aW9uLmNsYXNzKTsKICAgICAgICBoYW5kbGVyLnNldEhhbmRsZXJTdGFy\ndCh0aHJvd0V4Y2VwdGlvbgogICAgICAgICAgICAoY29kZSwgSW50ZXJuYWxF\neGNlcHRpb24uY2xhc3MpKTsKICAgICAgICBzZXRUYXJnZXQoY29kZS5nZXRz\ndGF0aWMoKS5zZXRGaWVsZCh0eXBlKSwganVtcHMpOwogICAgICAgIGNvZGUu\nYXJldHVybigpOwoKICAgICAgICBjb2RlLmNhbGN1bGF0ZU1heFN0YWNrKCk7\nCiAgICAgICAgY29kZS5jYWxjdWxhdGVNYXhMb2NhbHMoKTsKICAgIH0KCiAg\nICAvKioKICAgICAqIERlY2xhcmUgc3RhbmRhcmQgZHluYW1pYyBwY2RhdGEg\nZmllbGRzLgogICAgICovCiAgICBwcml2YXRlIHZvaWQgYWRkQmFzZUZpZWxk\ncyhCQ0NsYXNzIGJjKSB7CiAgICAgICAgYWRkQmVhbkZpZWxkKGJjLCAiaWQi\nLCBPYmplY3QuY2xhc3MpOwogICAgICAgIEJDRmllbGQgZmllbGQgPSBhZGRC\nZWFuRmllbGQoYmMsICJzdG9yYWdlR2VuZXJhdG9yIiwKICAgICAgICAgICAg\nUENEYXRhR2VuZXJhdG9yLmNsYXNzKTsKICAgICAgICBmaWVsZC5zZXRBY2Nl\nc3NGbGFncyhmaWVsZC5nZXRBY2Nlc3NGbGFncygpCiAgICAgICAgICAgIHwg\nQ29uc3RhbnRzLkFDQ0VTU19UUkFOU0lFTlQpOwogICAgfQoKICAgIC8qKgog\nICAgICogQWRkIG1ldGhvZHMgZm9yIGxvYWRpbmcgYW5kIHN0b3JpbmcgY2xh\nc3MtbGV2ZWwgaW1wbCBkYXRhLgogICAgICovCiAgICBwcml2YXRlIHZvaWQg\nYWRkSW1wbERhdGFNZXRob2RzKEJDQ2xhc3MgYmMsIENsYXNzTWV0YURhdGEg\nbWV0YSkgewogICAgICAgIC8vIHZvaWQgc3RvcmVJbXBsRGF0YShPcGVuSlBB\nU3RhdGVNYW5hZ2VyKTsKICAgICAgICBCQ01ldGhvZCBtZXRoID0gYmMuZGVj\nbGFyZU1ldGhvZCgic3RvcmVJbXBsRGF0YSIsIHZvaWQuY2xhc3MsCiAgICAg\nICAgICAgIG5ldyBDbGFzc1tdeyBPcGVuSlBBU3RhdGVNYW5hZ2VyLmNsYXNz\nIH0pOwogICAgICAgIENvZGUgY29kZSA9IG1ldGguZ2V0Q29kZSh0cnVlKTsK\nCiAgICAgICAgQkNGaWVsZCBpbXBsID0gbnVsbDsKICAgICAgICBpZiAoIXVz\nZXNJbXBsRGF0YShtZXRhKSkKICAgICAgICAgICAgY29kZS52cmV0dXJuKCk7\nCiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIC8vIGlmIChzbS5pc0ltcGxE\nYXRhQ2FjaGVhYmxlKCkpCiAgICAgICAgICAgIC8vIAkJc2V0SW1wbERhdGEo\nc20uZ2V0SW1wbERhdGEoKSk7CiAgICAgICAgICAgIGltcGwgPSBhZGRCZWFu\nRmllbGQoYmMsICJpbXBsRGF0YSIsIE9iamVjdC5jbGFzcyk7CiAgICAgICAg\nICAgIGNvZGUuYWxvYWQoKS5zZXRQYXJhbSgwKTsKICAgICAgICAgICAgY29k\nZS5pbnZva2VpbnRlcmZhY2UoKS5zZXRNZXRob2QoT3BlbkpQQVN0YXRlTWFu\nYWdlci5jbGFzcywKICAgICAgICAgICAgICAgICJpc0ltcGxEYXRhQ2FjaGVh\nYmxlIiwgYm9vbGVhbi5jbGFzcywgbnVsbCk7CiAgICAgICAgICAgIEp1bXBJ\nbnN0cnVjdGlvbiBpZmlucyA9IGNvZGUuaWZlcSgpOwogICAgICAgICAgICBj\nb2RlLmFsb2FkKCkuc2V0VGhpcygpOwogICAgICAgICAgICBjb2RlLmFsb2Fk\nKCkuc2V0UGFyYW0oMCk7CiAgICAgICAgICAgIGNvZGUuaW52b2tlaW50ZXJm\nYWNlKCkuc2V0TWV0aG9kKE9wZW5KUEFTdGF0ZU1hbmFnZXIuY2xhc3MsCiAg\nICAgICAgICAgICAgICAiZ2V0SW1wbERhdGEiLCBPYmplY3QuY2xhc3MsIG51\nbGwpOwogICAgICAgICAgICBjb2RlLmludm9rZXZpcnR1YWwoKS5zZXRNZXRo\nb2QoInNldEltcGxEYXRhIiwgdm9pZC5jbGFzcywKICAgICAgICAgICAgICAg\nIG5ldyBDbGFzc1tdeyBPYmplY3QuY2xhc3MgfSk7CiAgICAgICAgICAgIGlm\naW5zLnNldFRhcmdldChjb2RlLnZyZXR1cm4oKSk7CiAgICAgICAgfQogICAg\nICAgIGNvZGUuY2FsY3VsYXRlTWF4U3RhY2soKTsKICAgICAgICBjb2RlLmNh\nbGN1bGF0ZU1heExvY2FscygpOwoKICAgICAgICAvLyB2b2lkIGxvYWRJbXBs\nRGF0YShPcGVuSlBBU3RhdGVNYW5hZ2VyKTsKICAgICAgICBtZXRoID0gYmMu\nZGVjbGFyZU1ldGhvZCgibG9hZEltcGxEYXRhIiwgdm9pZC5jbGFzcywKICAg\nICAgICAgICAgbmV3IENsYXNzW117IE9wZW5KUEFTdGF0ZU1hbmFnZXIuY2xh\nc3MgfSk7CiAgICAgICAgY29kZSA9IG1ldGguZ2V0Q29kZSh0cnVlKTsKICAg\nICAgICBpZiAoIXVzZXNJbXBsRGF0YShtZXRhKSkKICAgICAgICAgICAgY29k\nZS52cmV0dXJuKCk7CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIC8vIGlm\nIChzbS5nZXRJbXBsRGF0YSgpID09IG51bGwgJiYgaW1wbERhdGEgIT0gbnVs\nbCkKICAgICAgICAgICAgLy8gCQlzbS5zZXRJbXBsRGF0YShpbXBsLCB0cnVl\nKTsKICAgICAgICAgICAgY29kZS5hbG9hZCgpLnNldFBhcmFtKDApOwogICAg\nICAgICAgICBjb2RlLmludm9rZWludGVyZmFjZSgpLnNldE1ldGhvZChPcGVu\nSlBBU3RhdGVNYW5hZ2VyLmNsYXNzLAogICAgICAgICAgICAgICAgImdldElt\ncGxEYXRhIiwgT2JqZWN0LmNsYXNzLCBudWxsKTsKICAgICAgICAgICAgSnVt\ncEluc3RydWN0aW9uIGlmaW5zID0gY29kZS5pZm5vbm51bGwoKTsKICAgICAg\nICAgICAgY29kZS5hbG9hZCgpLnNldFRoaXMoKTsKICAgICAgICAgICAgY29k\nZS5nZXRmaWVsZCgpLnNldEZpZWxkKGltcGwpOwogICAgICAgICAgICBKdW1w\nSW5zdHJ1Y3Rpb24gaWZpbnMyID0gY29kZS5pZm51bGwoKTsKICAgICAgICAg\nICAgY29kZS5hbG9hZCgpLnNldFBhcmFtKDApOwogICAgICAgICAgICBjb2Rl\nLmFsb2FkKCkuc2V0VGhpcygpOwogICAgICAgICAgICBjb2RlLmdldGZpZWxk\nKCkuc2V0RmllbGQoaW1wbCk7CiAgICAgICAgICAgIGNvZGUuY29uc3RhbnQo\nKS5zZXRWYWx1ZSh0cnVlKTsKICAgICAgICAgICAgY29kZS5pbnZva2VpbnRl\ncmZhY2UoKS5zZXRNZXRob2QoT3BlbkpQQVN0YXRlTWFuYWdlci5jbGFzcywK\nICAgICAgICAgICAgICAgICJzZXRJbXBsRGF0YSIsIHZvaWQuY2xhc3MsCiAg\nICAgICAgICAgICAgICBuZXcgQ2xhc3NbXXsgT2JqZWN0LmNsYXNzLCBib29s\nZWFuLmNsYXNzIH0pOwogICAgICAgICAgICBJbnN0cnVjdGlvbiBpbnMgPSBj\nb2RlLnZyZXR1cm4oKTsKICAgICAgICAgICAgaWZpbnMuc2V0VGFyZ2V0KGlu\ncyk7CiAgICAgICAgICAgIGlmaW5zMi5zZXRUYXJnZXQoaW5zKTsKICAgICAg\nICB9CiAgICAgICAgY29kZS5jYWxjdWxhdGVNYXhTdGFjaygpOwogICAgICAg\nIGNvZGUuY2FsY3VsYXRlTWF4TG9jYWxzKCk7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBBZGQgbWV0aG9kcyBmb3IgbG9hZGluZyBhbmQgc3RvcmluZyBjbGFz\ncy1sZXZlbCBpbXBsIGRhdGEuCiAgICAgKi8KICAgIHByaXZhdGUgdm9pZCBh\nZGRGaWVsZEltcGxEYXRhTWV0aG9kcyhCQ0NsYXNzIGJjLCBDbGFzc01ldGFE\nYXRhIG1ldGEpIHsKICAgICAgICAvLyBwdWJsaWMgdm9pZCBsb2FkSW1wbERh\ndGEoT3BlbkpQQVN0YXRlTWFuYWdlciBzbSwgaW50IGkpCiAgICAgICAgQkNN\nZXRob2QgbWV0aCA9IGJjLmRlY2xhcmVNZXRob2QoImxvYWRJbXBsRGF0YSIs\nIHZvaWQuY2xhc3MsCiAgICAgICAgICAgIG5ldyBDbGFzc1tdeyBPcGVuSlBB\nU3RhdGVNYW5hZ2VyLmNsYXNzLCBpbnQuY2xhc3MgfSk7CiAgICAgICAgbWV0\naC5tYWtlUHJpdmF0ZSgpOwogICAgICAgIENvZGUgY29kZSA9IG1ldGguZ2V0\nQ29kZSh0cnVlKTsKCiAgICAgICAgaW50IGNvdW50ID0gY291bnRJbXBsRGF0\nYUZpZWxkcyhtZXRhKTsKICAgICAgICBCQ0ZpZWxkIGltcGwgPSBudWxsOwog\nICAgICAgIGlmIChjb3VudCA9PSAwKQogICAgICAgICAgICBjb2RlLnZyZXR1\ncm4oKTsKICAgICAgICBlbHNlIHsKICAgICAgICAgICAgLy8gT2JqZWN0W10g\nZmllbGRJbXBsCiAgICAgICAgICAgIGltcGwgPSBiYy5kZWNsYXJlRmllbGQo\nImZpZWxkSW1wbCIsIE9iamVjdFtdLmNsYXNzKTsKICAgICAgICAgICAgaW1w\nbC5tYWtlUHJpdmF0ZSgpOwoKICAgICAgICAgICAgLy8gaWYgKGZpZWxkSW1w\nbCAhPSBudWxsKQogICAgICAgICAgICBjb2RlLmFsb2FkKCkuc2V0VGhpcygp\nOwogICAgICAgICAgICBjb2RlLmdldGZpZWxkKCkuc2V0RmllbGQoaW1wbCk7\nCiAgICAgICAgICAgIEp1bXBJbnN0cnVjdGlvbiBpZmlucyA9IGNvZGUuaWZu\nb25udWxsKCk7CiAgICAgICAgICAgIGNvZGUudnJldHVybigpOwoKICAgICAg\nICAgICAgLy8gT2JqZWN0IG9iaiA9IG51bGw7CiAgICAgICAgICAgIGludCBv\nYmogPSBjb2RlLmdldE5leHRMb2NhbHNJbmRleCgpOwogICAgICAgICAgICBp\nZmlucy5zZXRUYXJnZXQoY29kZS5jb25zdGFudCgpLnNldE51bGwoKSk7CiAg\nICAgICAgICAgIGNvZGUuYXN0b3JlKCkuc2V0TG9jYWwob2JqKTsKCiAgICAg\nICAgICAgIC8vIGVzdGFibGlzaCBzd2l0Y2ggdGFyZ2V0LCB0aGVuIG1vdmUg\nYmVmb3JlIGl0CiAgICAgICAgICAgIEluc3RydWN0aW9uIHRhcmdldCA9IGNv\nZGUuYWxvYWQoKS5zZXRMb2NhbChvYmopOwogICAgICAgICAgICBjb2RlLnBy\nZXZpb3VzKCk7CgogICAgICAgICAgICAvLyBzd2l0Y2goaSkKICAgICAgICAg\nICAgY29kZS5pbG9hZCgpLnNldFBhcmFtKDEpOwogICAgICAgICAgICBMb29r\ndXBTd2l0Y2hJbnN0cnVjdGlvbiBsc3dpdGNoID0gY29kZS5sb29rdXBzd2l0\nY2goKTsKICAgICAgICAgICAgRmllbGRNZXRhRGF0YVtdIGZpZWxkcyA9IG1l\ndGEuZ2V0RmllbGRzKCk7CiAgICAgICAgICAgIGludCBjYWNoZWFibGUgPSAw\nOwogICAgICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGZpZWxkcy5sZW5n\ndGg7IGkrKykgewogICAgICAgICAgICAgICAgaWYgKCF1c2VzSW1wbERhdGEo\nZmllbGRzW2ldKSkKICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsKICAg\nICAgICAgICAgICAgIC8vIGNhc2UgeDogb2JqID0gZmllbGRJbXBsW3ldOyBi\ncmVhazsKICAgICAgICAgICAgICAgIGxzd2l0Y2guYWRkQ2FzZShpLCBjb2Rl\nLmFsb2FkKCkuc2V0VGhpcygpKTsKICAgICAgICAgICAgICAgIGNvZGUuZ2V0\nZmllbGQoKS5zZXRGaWVsZChpbXBsKTsKICAgICAgICAgICAgICAgIGNvZGUu\nY29uc3RhbnQoKS5zZXRWYWx1ZShjYWNoZWFibGUrKyk7CiAgICAgICAgICAg\nICAgICBjb2RlLmFhbG9hZCgpOwogICAgICAgICAgICAgICAgY29kZS5hc3Rv\ncmUoKS5zZXRMb2NhbChvYmopOwogICAgICAgICAgICAgICAgY29kZS5nbzIo\nKS5zZXRUYXJnZXQodGFyZ2V0KTsKICAgICAgICAgICAgfQogICAgICAgICAg\nICBsc3dpdGNoLnNldERlZmF1bHRUYXJnZXQodGFyZ2V0KTsKCiAgICAgICAg\nICAgIC8vIGlmIChvYmogIT0gbnVsbCkKICAgICAgICAgICAgY29kZS5uZXh0\nKCk7ICAgIC8vIGp1bXAgYmFjayBvdmVyIHRhcmdldAogICAgICAgICAgICBp\nZmlucyA9IGNvZGUuaWZub25udWxsKCk7CiAgICAgICAgICAgIGNvZGUudnJl\ndHVybigpOwoKICAgICAgICAgICAgLy8gc20uc2V0SW1wbERhdGEoaW5kZXgs\nIGltcGwpOwogICAgICAgICAgICBpZmlucy5zZXRUYXJnZXQoY29kZS5hbG9h\nZCgpLnNldFBhcmFtKDApKTsKICAgICAgICAgICAgY29kZS5pbG9hZCgpLnNl\ndFBhcmFtKDEpOwogICAgICAgICAgICBjb2RlLmFsb2FkKCkuc2V0TG9jYWwo\nb2JqKTsKICAgICAgICAgICAgY29kZS5pbnZva2VpbnRlcmZhY2UoKS5zZXRN\nZXRob2QoT3BlbkpQQVN0YXRlTWFuYWdlci5jbGFzcywKICAgICAgICAgICAg\nICAgICJzZXRJbXBsRGF0YSIsIHZvaWQuY2xhc3MsCiAgICAgICAgICAgICAg\nICBuZXcgQ2xhc3NbXXsgaW50LmNsYXNzLCBPYmplY3QuY2xhc3MgfSk7CiAg\nICAgICAgICAgIGNvZGUudnJldHVybigpOwogICAgICAgIH0KICAgICAgICBj\nb2RlLmNhbGN1bGF0ZU1heExvY2FscygpOwogICAgICAgIGNvZGUuY2FsY3Vs\nYXRlTWF4U3RhY2soKTsKCiAgICAgICAgLy8gdm9pZCBzdG9yZUltcGxEYXRh\nKE9wZW5KUEFTdGF0ZU1hbmFnZXIgc20sIGludCBpbmRleCwgYm9vbGVhbiBs\nb2FkZWQpCiAgICAgICAgbWV0aCA9IGJjLmRlY2xhcmVNZXRob2QoInN0b3Jl\nSW1wbERhdGEiLCB2b2lkLmNsYXNzLAogICAgICAgICAgICBuZXcgQ2xhc3Nb\nXXsgT3BlbkpQQVN0YXRlTWFuYWdlci5jbGFzcywgaW50LmNsYXNzLCBib29s\nZWFuLmNsYXNzIH0pOwogICAgICAgIGNvZGUgPSBtZXRoLmdldENvZGUodHJ1\nZSk7CiAgICAgICAgaWYgKGNvdW50ID09IDApCiAgICAgICAgICAgIGNvZGUu\ndnJldHVybigpOwogICAgICAgIGVsc2UgewogICAgICAgICAgICAvLyBpbnQg\nYXJySWR4ID0gLTE7CiAgICAgICAgICAgIC8vIHN3aXRjaChpbmRleCkKICAg\nICAgICAgICAgaW50IGFycklkeCA9IGNvZGUuZ2V0TmV4dExvY2Fsc0luZGV4\nKCk7CiAgICAgICAgICAgIGNvZGUuY29uc3RhbnQoKS5zZXRWYWx1ZSgtMSk7\nCiAgICAgICAgICAgIGNvZGUuaXN0b3JlKCkuc2V0TG9jYWwoYXJySWR4KTsK\nICAgICAgICAgICAgY29kZS5pbG9hZCgpLnNldFBhcmFtKDEpOwogICAgICAg\nICAgICBMb29rdXBTd2l0Y2hJbnN0cnVjdGlvbiBsc3dpdGNoID0gY29kZS5s\nb29rdXBzd2l0Y2goKTsKCiAgICAgICAgICAgIC8vIGVzdGFibGlzaCBzd2l0\nY2ggdGFyZ2V0LCB0aGVuIG1vdmUgYmVmb3JlIGl0CiAgICAgICAgICAgIElu\nc3RydWN0aW9uIHN3aXRjaFRhcmdldCA9IGNvZGUuaWxvYWQoKS5zZXRMb2Nh\nbChhcnJJZHgpOwogICAgICAgICAgICBjb2RlLnByZXZpb3VzKCk7CgogICAg\nICAgICAgICBGaWVsZE1ldGFEYXRhW10gZmllbGRzID0gbWV0YS5nZXRGaWVs\nZHMoKTsKICAgICAgICAgICAgaW50IGNhY2hlYWJsZSA9IDA7CiAgICAgICAg\nICAgIGZvciAoaW50IGkgPSAwOyBpIDwgZmllbGRzLmxlbmd0aDsgaSsrKSB7\nCiAgICAgICAgICAgICAgICBpZiAoIXVzZXNJbXBsRGF0YShmaWVsZHNbaV0p\nKQogICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICAg\nICAgLy8gY2FzZSB4OiBhcnJJZHggPSB5OyBicmVhazsKICAgICAgICAgICAg\nICAgIGxzd2l0Y2guYWRkQ2FzZShpLCBjb2RlLmNvbnN0YW50KCkuc2V0VmFs\ndWUoY2FjaGVhYmxlKyspKTsKICAgICAgICAgICAgICAgIGNvZGUuaXN0b3Jl\nKCkuc2V0TG9jYWwoYXJySWR4KTsKICAgICAgICAgICAgICAgIGNvZGUuZ28y\nKCkuc2V0VGFyZ2V0KHN3aXRjaFRhcmdldCk7CiAgICAgICAgICAgIH0KICAg\nICAgICAgICAgbHN3aXRjaC5zZXREZWZhdWx0VGFyZ2V0KHN3aXRjaFRhcmdl\ndCk7CiAgICAgICAgICAgIGNvZGUubmV4dCgpOyAgICAvLyBzdGVwIG92ZXIg\nc3dpdGNoIHRhcmdldAoKICAgICAgICAgICAgLy8gaWYgKGFycklkeCAhPSAt\nMSkKICAgICAgICAgICAgY29kZS5jb25zdGFudCgpLnNldFZhbHVlKC0xKTsK\nICAgICAgICAgICAgSnVtcEluc3RydWN0aW9uIGlmaW5zID0gY29kZS5pZmlj\nbXBuZSgpOwogICAgICAgICAgICBjb2RlLnZyZXR1cm4oKTsKCiAgICAgICAg\nICAgIC8vIGNyZWF0ZSBudWxsIHRhcmdldCwgdGhlbiBtb3ZlIGJlZm9yZSBp\ndAogICAgICAgICAgICBJbnN0cnVjdGlvbiBudWxsVGFyZ2V0ID0gY29kZS5h\nbG9hZCgpLnNldFRoaXMoKTsKICAgICAgICAgICAgY29kZS5wcmV2aW91cygp\nOwoKICAgICAgICAgICAgLy8gaWYgKGxvYWRlZCkKICAgICAgICAgICAgaWZp\nbnMuc2V0VGFyZ2V0KGNvZGUuaWxvYWQoKS5zZXRQYXJhbSgyKSk7CiAgICAg\nICAgICAgIGNvZGUuaWZlcSgpLnNldFRhcmdldChudWxsVGFyZ2V0KTsKCiAg\nICAgICAgICAgIC8vIE9iamVjdCBvYmogPSBzbS5nZXRJbXBsRGF0YShpbmRl\neCkKICAgICAgICAgICAgaW50IG9iaiA9IGNvZGUuZ2V0TmV4dExvY2Fsc0lu\nZGV4KCk7CiAgICAgICAgICAgIGNvZGUuYWxvYWQoKS5zZXRQYXJhbSgwKTsK\nICAgICAgICAgICAgY29kZS5pbG9hZCgpLnNldFBhcmFtKDEpOwogICAgICAg\nICAgICBjb2RlLmludm9rZWludGVyZmFjZSgpLnNldE1ldGhvZChPcGVuSlBB\nU3RhdGVNYW5hZ2VyLmNsYXNzLAogICAgICAgICAgICAgICAgImdldEltcGxE\nYXRhIiwgT2JqZWN0LmNsYXNzLCBuZXcgQ2xhc3NbXXsgaW50LmNsYXNzIH0p\nOwogICAgICAgICAgICBjb2RlLmFzdG9yZSgpLnNldExvY2FsKG9iaik7Cgog\nICAgICAgICAgICAvLyBpZiAob2JqICE9IG51bGwpCiAgICAgICAgICAgIGNv\nZGUuYWxvYWQoKS5zZXRMb2NhbChvYmopOwogICAgICAgICAgICBjb2RlLmlm\nbnVsbCgpLnNldFRhcmdldChudWxsVGFyZ2V0KTsKCiAgICAgICAgICAgIC8v\nIGlmIChmaWVsZEltcGwgPT0gbnVsbCkKICAgICAgICAgICAgLy8gCQlmaWVs\nZEltcGwgPSBuZXcgT2JqZWN0W2ZpZWxkc107CiAgICAgICAgICAgIGNvZGUu\nYWxvYWQoKS5zZXRUaGlzKCk7CiAgICAgICAgICAgIGNvZGUuZ2V0ZmllbGQo\nKS5zZXRGaWVsZChpbXBsKTsKICAgICAgICAgICAgaWZpbnMgPSBjb2RlLmlm\nbm9ubnVsbCgpOwogICAgICAgICAgICBjb2RlLmFsb2FkKCkuc2V0VGhpcygp\nOwogICAgICAgICAgICBjb2RlLmNvbnN0YW50KCkuc2V0VmFsdWUoY291bnQp\nOwogICAgICAgICAgICBjb2RlLmFuZXdhcnJheSgpLnNldFR5cGUoT2JqZWN0\nLmNsYXNzKTsKICAgICAgICAgICAgY29kZS5wdXRmaWVsZCgpLnNldEZpZWxk\nKGltcGwpOwoKICAgICAgICAgICAgLy8gZmllbGRJbXBsW2FycklkeF0gPSBv\nYmo7CiAgICAgICAgICAgIC8vIHJldHVybjsKICAgICAgICAgICAgaWZpbnMu\nc2V0VGFyZ2V0KGNvZGUuYWxvYWQoKS5zZXRUaGlzKCkpOwogICAgICAgICAg\nICBjb2RlLmdldGZpZWxkKCkuc2V0RmllbGQoaW1wbCk7CiAgICAgICAgICAg\nIGNvZGUuaWxvYWQoKS5zZXRMb2NhbChhcnJJZHgpOwogICAgICAgICAgICBj\nb2RlLmFsb2FkKCkuc2V0TG9jYWwob2JqKTsKICAgICAgICAgICAgY29kZS5h\nYXN0b3JlKCk7CiAgICAgICAgICAgIGNvZGUudnJldHVybigpOwoKICAgICAg\nICAgICAgLy8gaWYgKGZpZWxkSW1wbCAhPSBudWxsKQogICAgICAgICAgICAv\nLyAJCWZpZWxkSW1wbFtpbmRleF0gPSBudWxsOwogICAgICAgICAgICBjb2Rl\nLm5leHQoKTsgLy8gc3RlcCBvdmVyIG51bGxUYXJnZXQKICAgICAgICAgICAg\nY29kZS5nZXRmaWVsZCgpLnNldEZpZWxkKGltcGwpOwogICAgICAgICAgICBp\nZmlucyA9IGNvZGUuaWZub25udWxsKCk7CiAgICAgICAgICAgIGNvZGUudnJl\ndHVybigpOwogICAgICAgICAgICBpZmlucy5zZXRUYXJnZXQoY29kZS5hbG9h\nZCgpLnNldFRoaXMoKSk7CiAgICAgICAgICAgIGNvZGUuZ2V0ZmllbGQoKS5z\nZXRGaWVsZChpbXBsKTsKICAgICAgICAgICAgY29kZS5pbG9hZCgpLnNldExv\nY2FsKGFycklkeCk7CiAgICAgICAgICAgIGNvZGUuY29uc3RhbnQoKS5zZXRO\ndWxsKCk7CiAgICAgICAgICAgIGNvZGUuYWFzdG9yZSgpOwogICAgICAgICAg\nICBjb2RlLnZyZXR1cm4oKTsKICAgICAgICB9CiAgICAgICAgY29kZS5jYWxj\ndWxhdGVNYXhTdGFjaygpOwogICAgICAgIGNvZGUuY2FsY3VsYXRlTWF4TG9j\nYWxzKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBBZGQgbWV0aG9kcyBmb3Ig\nbG9hZGluZyBhbmQgc3RvcmluZyB2ZXJzaW9uIGRhdGEuCiAgICAgKi8KICAg\nIHByb3RlY3RlZCB2b2lkIGFkZFZlcnNpb25NZXRob2RzKEJDQ2xhc3MgYmMp\nIHsKICAgICAgICAvLyB2b2lkIHN0b3JlVmVyc2lvbihPcGVuSlBBU3RhdGVN\nYW5hZ2VyIHNtKTsKICAgICAgICBhZGRCZWFuRmllbGQoYmMsICJ2ZXJzaW9u\nIiwgT2JqZWN0LmNsYXNzKTsKICAgICAgICBCQ01ldGhvZCBtZXRoID0gYmMu\nZGVjbGFyZU1ldGhvZCgic3RvcmVWZXJzaW9uIiwgdm9pZC5jbGFzcywKICAg\nICAgICAgICAgbmV3IENsYXNzW117IE9wZW5KUEFTdGF0ZU1hbmFnZXIuY2xh\nc3MgfSk7CiAgICAgICAgQ29kZSBjb2RlID0gbWV0aC5nZXRDb2RlKHRydWUp\nOwoKICAgICAgICAvLyB2ZXJzaW9uID0gc20uZ2V0VmVyc2lvbigpOwogICAg\nICAgIGNvZGUuYWxvYWQoKS5zZXRUaGlzKCk7CiAgICAgICAgY29kZS5hbG9h\nZCgpLnNldFBhcmFtKDApOwogICAgICAgIGNvZGUuaW52b2tlaW50ZXJmYWNl\nKCkKICAgICAgICAgICAgLnNldE1ldGhvZChPcGVuSlBBU3RhdGVNYW5hZ2Vy\nLmNsYXNzLCAiZ2V0VmVyc2lvbiIsCiAgICAgICAgICAgICAgICBPYmplY3Qu\nY2xhc3MsIG51bGwpOwogICAgICAgIGNvZGUucHV0ZmllbGQoKS5zZXRGaWVs\nZCgidmVyc2lvbiIsIE9iamVjdC5jbGFzcyk7CiAgICAgICAgY29kZS52cmV0\ndXJuKCk7CiAgICAgICAgY29kZS5jYWxjdWxhdGVNYXhTdGFjaygpOwogICAg\nICAgIGNvZGUuY2FsY3VsYXRlTWF4TG9jYWxzKCk7CgogICAgICAgIC8vIHZv\naWQgbG9hZFZlcnNpb24oT3BlbkpQQVN0YXRlTWFuYWdlciBzbSkKICAgICAg\nICBtZXRoID0gYmMuZGVjbGFyZU1ldGhvZCgibG9hZFZlcnNpb24iLCB2b2lk\nLmNsYXNzLAogICAgICAgICAgICBuZXcgQ2xhc3NbXXsgT3BlbkpQQVN0YXRl\nTWFuYWdlci5jbGFzcyB9KTsKICAgICAgICBjb2RlID0gbWV0aC5nZXRDb2Rl\nKHRydWUpOwoKICAgICAgICAvLyBpZiAoc20uZ2V0VmVyc2lvbigpID09IG51\nbGwpCiAgICAgICAgLy8gCQlzbS5zZXRWZXJzaW9uKHZlcnNpb24pOwogICAg\nICAgIGNvZGUuYWxvYWQoKS5zZXRQYXJhbSgwKTsKICAgICAgICBjb2RlLmlu\ndm9rZWludGVyZmFjZSgpLnNldE1ldGhvZChPcGVuSlBBU3RhdGVNYW5hZ2Vy\nLmNsYXNzLAogICAgICAgICAgICAiZ2V0VmVyc2lvbiIsIE9iamVjdC5jbGFz\ncywgbnVsbCk7CiAgICAgICAgSnVtcEluc3RydWN0aW9uIGlmaW5zID0gY29k\nZS5pZm5vbm51bGwoKTsKICAgICAgICBjb2RlLmFsb2FkKCkuc2V0UGFyYW0o\nMCk7CiAgICAgICAgY29kZS5hbG9hZCgpLnNldFRoaXMoKTsKICAgICAgICBj\nb2RlLmdldGZpZWxkKCkuc2V0RmllbGQoInZlcnNpb24iLCBPYmplY3QuY2xh\nc3MpOwogICAgICAgIGNvZGUuaW52b2tlaW50ZXJmYWNlKCkKICAgICAgICAg\nICAgLnNldE1ldGhvZChPcGVuSlBBU3RhdGVNYW5hZ2VyLmNsYXNzLCAic2V0\nVmVyc2lvbiIsCiAgICAgICAgICAgICAgICB2b2lkLmNsYXNzLCBuZXcgQ2xh\nc3NbXXsgT2JqZWN0LmNsYXNzIH0pOwogICAgICAgIGlmaW5zLnNldFRhcmdl\ndChjb2RlLnZyZXR1cm4oKSk7CiAgICAgICAgY29kZS5jYWxjdWxhdGVNYXhT\ndGFjaygpOwogICAgICAgIGNvZGUuY2FsY3VsYXRlTWF4TG9jYWxzKCk7CiAg\nICB9CgogICAgcHJpdmF0ZSB2b2lkIGFkZExvYWRNZXRob2QoQkNDbGFzcyBi\nYywgQ2xhc3NNZXRhRGF0YSBtZXRhKSB7CiAgICAgICAgLy8gcHVibGljIHZv\naWQgbG9hZChPcGVuSlBBU3RhdGVNYW5hZ2VyIHNtLCBGZXRjaENvbmZpZ3Vy\nYXRpb24gZmV0Y2gsCiAgICAgICAgLy8gCQlPYmplY3QgY29udGV4dCkKICAg\nICAgICBDb2RlIGNvZGUgPSBhZGRMb2FkTWV0aG9kKGJjLCBmYWxzZSk7CiAg\nICAgICAgRmllbGRNZXRhRGF0YVtdIGZtZHMgPSBtZXRhLmdldEZpZWxkcygp\nOwogICAgICAgIENvbGxlY3Rpb24ganVtcHMgPSBuZXcgTGlua2VkTGlzdCgp\nOwogICAgICAgIENvbGxlY3Rpb24ganVtcHMyOwoJCQogICAgICAgIGludCBs\nb2NhbCA9IGNvZGUuZ2V0TmV4dExvY2Fsc0luZGV4KCk7CiAgICAgICAgY29k\nZS5jb25zdGFudCgpLnNldE51bGwoKTsKICAgICAgICBjb2RlLmFzdG9yZSgp\nLnNldExvY2FsKGxvY2FsKTsKICAgICAgICBpbnQgaW50ZXIgPSBjb2RlLmdl\ndE5leHRMb2NhbHNJbmRleCgpOwogICAgICAgIGNvZGUuY29uc3RhbnQoKS5z\nZXROdWxsKCk7CiAgICAgICAgY29kZS5hc3RvcmUoKS5zZXRMb2NhbChpbnRl\ncik7CgogICAgICAgIGludCBvYmplY3RDb3VudCA9IDA7CiAgICAgICAgYm9v\nbGVhbiBpbnRlcm1lZGlhdGU7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkg\nPCBmbWRzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGp1bXBzMiA9IG5l\ndyBMaW5rZWRMaXN0KCk7CiAgICAgICAgICAgIGludGVybWVkaWF0ZSA9IHVz\nZXNJbnRlcm1lZGlhdGUoZm1kc1tpXSk7CiAgICAgICAgICAgIHNldFRhcmdl\ndChjb2RlLmFsb2FkKCkuc2V0VGhpcygpLCBqdW1wcyk7CiAgICAgICAgICAg\nIC8vIGlmIChsb2FkZWQuZ2V0KGkpKSBvciAoIWxvYWRlZC5nZXQoaSkpIGRl\ncGVuZGluZyBvbiBpbnRlciByZXNwCiAgICAgICAgICAgIGNvZGUuZ2V0Zmll\nbGQoKS5zZXRGaWVsZCgibG9hZGVkIiwgQml0U2V0LmNsYXNzKTsKICAgICAg\nICAgICAgY29kZS5jb25zdGFudCgpLnNldFZhbHVlKGkpOwogICAgICAgICAg\nICBjb2RlLmludm9rZXZpcnR1YWwoKS5zZXRNZXRob2QoQml0U2V0LmNsYXNz\nLCAiZ2V0IiwKICAgICAgICAgICAgICAgIGJvb2xlYW4uY2xhc3MsIG5ldyBD\nbGFzc1tdeyBpbnQuY2xhc3MgfSk7CiAgICAgICAgICAgIGp1bXBzLmFkZChj\nb2RlLmlmbmUoKSk7CgogICAgICAgICAgICBpZiAoaW50ZXJtZWRpYXRlKQog\nICAgICAgICAgICAgICAgYWRkTG9hZEludGVybWVkaWF0ZShjb2RlLCBpLCBv\nYmplY3RDb3VudCwganVtcHMyLCBpbnRlcik7CiAgICAgICAgICAgIGp1bXBz\nMi5hZGQoY29kZS5nbzIoKSk7CgogICAgICAgICAgICAvLyBpZiAoZmV0Y2gu\ncmVxdWlyZXNGZXRjaChmbWRzW2ldKSE9RmV0Y2hDb25maWd1cmF0aW9uLkZF\nVENIX05PTkUpCiAgICAgICAgICAgIHNldFRhcmdldChjb2RlLmFsb2FkKCku\nc2V0UGFyYW0oMSksIGp1bXBzKTsKICAgICAgICAgICAgY29kZS5hbG9hZCgp\nLnNldFBhcmFtKDApOwogICAgICAgICAgICBjb2RlLmludm9rZWludGVyZmFj\nZSgpLnNldE1ldGhvZChPcGVuSlBBU3RhdGVNYW5hZ2VyLmNsYXNzLAogICAg\nICAgICAgICAgICAgImdldE1ldGFEYXRhIiwgQ2xhc3NNZXRhRGF0YS5jbGFz\ncywgbnVsbCk7CiAgICAgICAgICAgIGNvZGUuY29uc3RhbnQoKS5zZXRWYWx1\nZShmbWRzW2ldLmdldEluZGV4KCkpOwogICAgICAgICAgICBjb2RlLmludm9r\nZXZpcnR1YWwoKS5zZXRNZXRob2QoQ2xhc3NNZXRhRGF0YS5jbGFzcywKICAg\nICAgICAgICAgICAgICJnZXRGaWVsZCIsIEZpZWxkTWV0YURhdGEuY2xhc3Ms\nIG5ldyBDbGFzc1tde2ludC5jbGFzc30pOwogICAgICAgICAgICBjb2RlLmlu\ndm9rZWludGVyZmFjZSgpLnNldE1ldGhvZCAoRmV0Y2hDb25maWd1cmF0aW9u\nLmNsYXNzLCAKICAgICAgICAgICAgICAgICJyZXF1aXJlc0ZldGNoIiwgaW50\nLmNsYXNzLCBuZXcgQ2xhc3NbXXtGaWVsZE1ldGFEYXRhLmNsYXNzfSk7CiAg\nICAgICAgICAgIGNvZGUuY29uc3RhbnQoKS5zZXRWYWx1ZShGZXRjaENvbmZp\nZ3VyYXRpb24uRkVUQ0hfTk9ORSk7CiAgICAgICAgICAgIGp1bXBzMi5hZGQo\nY29kZS5pZmljbXBlcSgpKTsKICAgICAgICAgICAgYWRkTG9hZChiYywgY29k\nZSwgZm1kc1tpXSwgb2JqZWN0Q291bnQsIGxvY2FsLCBmYWxzZSk7CgogICAg\nICAgICAgICBqdW1wcyA9IGp1bXBzMjsKICAgICAgICAgICAgaWYgKHJlcGxh\nY2VUeXBlKGZtZHNbaV0pID49IEphdmFUeXBlcy5PQkpFQ1QpCiAgICAgICAg\nICAgICAgICBvYmplY3RDb3VudCsrOwogICAgICAgIH0KICAgICAgICBzZXRU\nYXJnZXQoY29kZS52cmV0dXJuKCksIGp1bXBzKTsKICAgICAgICBjb2RlLmNh\nbGN1bGF0ZU1heFN0YWNrKCk7CiAgICAgICAgY29kZS5jYWxjdWxhdGVNYXhM\nb2NhbHMoKTsKICAgIH0KCiAgICBwcml2YXRlIHZvaWQgYWRkTG9hZFdpdGhG\naWVsZHNNZXRob2QoQkNDbGFzcyBiYywgQ2xhc3NNZXRhRGF0YSBtZXRhKSB7\nCiAgICAgICAgQ29kZSBjb2RlID0gYWRkTG9hZE1ldGhvZChiYywgdHJ1ZSk7\nCiAgICAgICAgLy8gcHVibGljIHZvaWQgbG9hZChPcGVuSlBBU3RhdGVNYW5h\nZ2VyIHNtLCBCaXRTZXQgZmllbGRzLAogICAgICAgIC8vIAkJRmV0Y2hDb25m\naWd1cmF0aW9uIGZldGNoLCBPYmplY3QgY29ubikKICAgICAgICBGaWVsZE1l\ndGFEYXRhW10gZm1kcyA9IG1ldGEuZ2V0RmllbGRzKCk7CiAgICAgICAgQ29s\nbGVjdGlvbiBqdW1wcyA9IG5ldyBMaW5rZWRMaXN0KCk7CiAgICAgICAgQ29s\nbGVjdGlvbiBqdW1wczI7CiAgICAgICAgaW50IG9iamVjdENvdW50ID0gMDsK\nICAgICAgICBib29sZWFuIGludGVybWVkaWF0ZTsKICAgICAgICBpbnQgbG9j\nYWwgPSBjb2RlLmdldE5leHRMb2NhbHNJbmRleCgpOwogICAgICAgIGNvZGUu\nY29uc3RhbnQoKS5zZXROdWxsKCk7CiAgICAgICAgY29kZS5hc3RvcmUoKS5z\nZXRMb2NhbChsb2NhbCk7CiAgICAgICAgaW50IGludGVyID0gY29kZS5nZXRO\nZXh0TG9jYWxzSW5kZXgoKTsKICAgICAgICBjb2RlLmNvbnN0YW50KCkuc2V0\nTnVsbCgpOwogICAgICAgIGNvZGUuYXN0b3JlKCkuc2V0TG9jYWwoaW50ZXIp\nOwoKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGZtZHMubGVuZ3RoOyBp\nKyspIHsKICAgICAgICAgICAganVtcHMyID0gbmV3IExpbmtlZExpc3QoKTsK\nICAgICAgICAgICAgaW50ZXJtZWRpYXRlID0gdXNlc0ludGVybWVkaWF0ZShm\nbWRzW2ldKTsKICAgICAgICAgICAgLy8gaWYgKGZpZWxkcy5nZXQoaSkpCiAg\nICAgICAgICAgIC8vIHsKICAgICAgICAgICAgLy8gCQlpZiAobG9hZGVkLmdl\ndChpKSkKICAgICAgICAgICAgc2V0VGFyZ2V0KGNvZGUuYWxvYWQoKS5zZXRQ\nYXJhbSgxKSwganVtcHMpOwogICAgICAgICAgICBjb2RlLmNvbnN0YW50KCku\nc2V0VmFsdWUoaSk7CiAgICAgICAgICAgIGNvZGUuaW52b2tldmlydHVhbCgp\nLnNldE1ldGhvZChCaXRTZXQuY2xhc3MsICJnZXQiLAogICAgICAgICAgICAg\nICAgYm9vbGVhbi5jbGFzcywgbmV3IENsYXNzW117IGludC5jbGFzcyB9KTsK\nICAgICAgICAgICAganVtcHMyLmFkZChjb2RlLmlmZXEoKSk7CiAgICAgICAg\nICAgIGNvZGUuYWxvYWQoKS5zZXRUaGlzKCk7CiAgICAgICAgICAgIGNvZGUu\nZ2V0ZmllbGQoKS5zZXRGaWVsZCgibG9hZGVkIiwgQml0U2V0LmNsYXNzKTsK\nICAgICAgICAgICAgY29kZS5jb25zdGFudCgpLnNldFZhbHVlKGkpOwogICAg\nICAgICAgICBjb2RlLmludm9rZXZpcnR1YWwoKS5zZXRNZXRob2QoQml0U2V0\nLmNsYXNzLCAiZ2V0IiwKICAgICAgICAgICAgICAgIGJvb2xlYW4uY2xhc3Ms\nIG5ldyBDbGFzc1tdeyBpbnQuY2xhc3MgfSk7CiAgICAgICAgICAgIGlmIChp\nbnRlcm1lZGlhdGUpCiAgICAgICAgICAgICAgICBqdW1wcy5hZGQoY29kZS5p\nZmVxKCkpOwogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICBqdW1w\nczIuYWRkKGNvZGUuaWZlcSgpKTsKCiAgICAgICAgICAgIGFkZExvYWQoYmMs\nIGNvZGUsIGZtZHNbaV0sIG9iamVjdENvdW50LCBsb2NhbCwgdHJ1ZSk7CiAg\nICAgICAgICAgIGlmICh1c2VzSW1wbERhdGEoZm1kc1tpXSkpIHsKICAgICAg\nICAgICAgICAgIC8vIGxvYWRJbXBsRGF0YShzbSwgaSk7CiAgICAgICAgICAg\nICAgICBjb2RlLmFsb2FkKCkuc2V0VGhpcygpOwogICAgICAgICAgICAgICAg\nY29kZS5hbG9hZCgpLnNldFBhcmFtKDApOwogICAgICAgICAgICAgICAgY29k\nZS5jb25zdGFudCgpLnNldFZhbHVlKGkpOwogICAgICAgICAgICAgICAgY29k\nZS5pbnZva2V2aXJ0dWFsKCkuc2V0TWV0aG9kKCJsb2FkSW1wbERhdGEiLCB2\nb2lkLmNsYXNzLAogICAgICAgICAgICAgICAgICAgIG5ldyBDbGFzc1tdeyBP\ncGVuSlBBU3RhdGVNYW5hZ2VyLmNsYXNzLCBpbnQuY2xhc3MgfSk7CiAgICAg\nICAgICAgIH0KCiAgICAgICAgICAgIC8vIGZpZWxkcy5jbGVhcihpKTsKICAg\nICAgICAgICAgY29kZS5hbG9hZCgpLnNldFBhcmFtKDEpOwogICAgICAgICAg\nICBjb2RlLmNvbnN0YW50KCkuc2V0VmFsdWUoaSk7CiAgICAgICAgICAgIGNv\nZGUuaW52b2tldmlydHVhbCgpLnNldE1ldGhvZChCaXRTZXQuY2xhc3MsICJj\nbGVhciIsIHZvaWQuY2xhc3MsCiAgICAgICAgICAgICAgICBuZXcgQ2xhc3Nb\nXSB7IGludC5jbGFzcyB9KTsKCiAgICAgICAgICAgIGp1bXBzMi5hZGQoY29k\nZS5nbzIoKSk7CgogICAgICAgICAgICBpZiAoaW50ZXJtZWRpYXRlKQogICAg\nICAgICAgICAgICAgc2V0VGFyZ2V0KGFkZExvYWRJbnRlcm1lZGlhdGUKICAg\nICAgICAgICAgICAgICAgICAoY29kZSwgaSwgb2JqZWN0Q291bnQsIGp1bXBz\nMiwgaW50ZXIpLCBqdW1wcyk7CgogICAgICAgICAgICBqdW1wcyA9IGp1bXBz\nMjsKICAgICAgICAgICAgaWYgKHJlcGxhY2VUeXBlKGZtZHNbaV0pID49IEph\ndmFUeXBlcy5PQkpFQ1QpCiAgICAgICAgICAgICAgICBvYmplY3RDb3VudCsr\nOwogICAgICAgIH0KICAgICAgICBzZXRUYXJnZXQoY29kZS52cmV0dXJuKCks\nIGp1bXBzKTsKICAgICAgICBjb2RlLmNhbGN1bGF0ZU1heFN0YWNrKCk7CiAg\nICAgICAgY29kZS5jYWxjdWxhdGVNYXhMb2NhbHMoKTsKICAgIH0KCiAgICAv\nKioKICAgICAqIERlY2xhcmUgYW5kIHN0YXJ0IHRoZSBiYXNlIGxvYWQgbWV0\naG9kLgogICAgICovCiAgICBwcml2YXRlIENvZGUgYWRkTG9hZE1ldGhvZChC\nQ0NsYXNzIGJjLCBib29sZWFuIGZpZWxkcykgewogICAgICAgIENsYXNzW10g\nYXJncyA9IG51bGw7CiAgICAgICAgaWYgKGZpZWxkcykKICAgICAgICAgICAg\nYXJncyA9IG5ldyBDbGFzc1tdeyBPcGVuSlBBU3RhdGVNYW5hZ2VyLmNsYXNz\nLCBCaXRTZXQuY2xhc3MsCiAgICAgICAgICAgICAgICBGZXRjaENvbmZpZ3Vy\nYXRpb24uY2xhc3MsIE9iamVjdC5jbGFzcyB9OwogICAgICAgIGVsc2UKICAg\nICAgICAgICAgYXJncyA9IG5ldyBDbGFzc1tdeyBPcGVuSlBBU3RhdGVNYW5h\nZ2VyLmNsYXNzLAogICAgICAgICAgICAgICAgRmV0Y2hDb25maWd1cmF0aW9u\nLmNsYXNzLCBPYmplY3QuY2xhc3MgfTsKICAgICAgICBCQ01ldGhvZCBsb2Fk\nID0gYmMuZGVjbGFyZU1ldGhvZCgibG9hZCIsIHZvaWQuY2xhc3MsIGFyZ3Mp\nOwogICAgICAgIENvZGUgY29kZSA9IGxvYWQuZ2V0Q29kZSh0cnVlKTsKCiAg\nICAgICAgLy9sb2FkVmVyc2lvbihzbSk7CiAgICAgICAgY29kZS5hbG9hZCgp\nLnNldFRoaXMoKTsKICAgICAgICBjb2RlLmFsb2FkKCkuc2V0UGFyYW0oMCk7\nCiAgICAgICAgY29kZS5pbnZva2V2aXJ0dWFsKCkuc2V0TWV0aG9kKCJsb2Fk\nVmVyc2lvbiIsIHZvaWQuY2xhc3MsCiAgICAgICAgICAgIG5ldyBDbGFzc1td\neyBPcGVuSlBBU3RhdGVNYW5hZ2VyLmNsYXNzIH0pOwoKICAgICAgICAvL2xv\nYWRJbXBsRGF0YShzbSk7CiAgICAgICAgY29kZS5hbG9hZCgpLnNldFRoaXMo\nKTsKICAgICAgICBjb2RlLmFsb2FkKCkuc2V0UGFyYW0oMCk7CiAgICAgICAg\nY29kZS5pbnZva2V2aXJ0dWFsKCkuc2V0TWV0aG9kKCJsb2FkSW1wbERhdGEi\nLCB2b2lkLmNsYXNzLAogICAgICAgICAgICBuZXcgQ2xhc3NbXXsgT3BlbkpQ\nQVN0YXRlTWFuYWdlci5jbGFzcyB9KTsKICAgICAgICByZXR1cm4gY29kZTsK\nICAgIH0KCiAgICAvKioKICAgICAqIEFkZCB0aGUgZmllbGQgbG9hZC4KICAg\nICAqLwogICAgcHJpdmF0ZSBJbnN0cnVjdGlvbiBhZGRMb2FkKEJDQ2xhc3Mg\nYmMsIENvZGUgY29kZSwgRmllbGRNZXRhRGF0YSBmbWQsCiAgICAgICAgaW50\nIG9iamVjdENvdW50LCBpbnQgbG9jYWwsIGJvb2xlYW4gZmllbGRzKSB7CiAg\nICAgICAgaW50IGluZGV4ID0gZm1kLmdldEluZGV4KCk7CiAgICAgICAgaW50\nIHR5cGVDb2RlID0gcmVwbGFjZVR5cGUoZm1kKTsKICAgICAgICBJbnN0cnVj\ndGlvbiBmaXJzdDsKICAgICAgICBpZiAodHlwZUNvZGUgPCBKYXZhVHlwZXMu\nT0JKRUNUKSB7CiAgICAgICAgICAgIC8vIHNtLnN0b3JlPHR5cGU+KGksIGZp\nZWxkPGk+KQogICAgICAgICAgICBDbGFzcyB0eXBlID0gZm9yVHlwZShmbWQu\nZ2V0VHlwZUNvZGUoKSk7CiAgICAgICAgICAgIGZpcnN0ID0gY29kZS5hbG9h\nZCgpLnNldFBhcmFtKDApOwogICAgICAgICAgICBjb2RlLmNvbnN0YW50KCku\nc2V0VmFsdWUoaW5kZXgpOwogICAgICAgICAgICBjb2RlLmFsb2FkKCkuc2V0\nVGhpcygpOwogICAgICAgICAgICBjb2RlLmdldGZpZWxkKCkuc2V0RmllbGQo\nZ2V0RmllbGROYW1lKGluZGV4KSwgdHlwZSk7CiAgICAgICAgICAgIGNvZGUu\naW52b2tlaW50ZXJmYWNlKCkuc2V0TWV0aG9kKE9wZW5KUEFTdGF0ZU1hbmFn\nZXIuY2xhc3MsCiAgICAgICAgICAgICAgICAic3RvcmUiICsgU3RyaW5nVXRp\nbHMuY2FwaXRhbGl6ZSh0eXBlLmdldE5hbWUoKSksCiAgICAgICAgICAgICAg\nICB2b2lkLmNsYXNzLCBuZXcgQ2xhc3NbXXsgaW50LmNsYXNzLCB0eXBlIH0p\nOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIC8vIGZtZCA9IHNtLmdl\ndE1ldGFEYXRhKCkuZ2V0RmllbGQoaSk7CiAgICAgICAgICAgIGludCBvZmZz\nZXQgPSBmaWVsZHMgPyAxIDogMDsKICAgICAgICAgICAgZmlyc3QgPSBjb2Rl\nLmFsb2FkKCkuc2V0UGFyYW0oMCk7CiAgICAgICAgICAgIGNvZGUuaW52b2tl\naW50ZXJmYWNlKCkuc2V0TWV0aG9kKE9wZW5KUEFTdGF0ZU1hbmFnZXIuY2xh\nc3MsCiAgICAgICAgICAgICAgICAiZ2V0TWV0YURhdGEiLCBDbGFzc01ldGFE\nYXRhLmNsYXNzLCBudWxsKTsKICAgICAgICAgICAgY29kZS5jb25zdGFudCgp\nLnNldFZhbHVlKGZtZC5nZXRJbmRleCgpKTsKICAgICAgICAgICAgY29kZS5p\nbnZva2V2aXJ0dWFsKCkuc2V0TWV0aG9kKENsYXNzTWV0YURhdGEuY2xhc3Ms\nICJnZXRGaWVsZCIsCiAgICAgICAgICAgICAgICBGaWVsZE1ldGFEYXRhLmNs\nYXNzLCBuZXcgQ2xhc3NbXXsgaW50LmNsYXNzIH0pOwogICAgICAgICAgICBj\nb2RlLmFzdG9yZSgpLnNldExvY2FsKGxvY2FsKTsKICAgICAgICAgICAgLy8g\nc20uc3RvcmVGaWVsZChpLCB0b0ZpZWxkKHNtLCBmbWQsIG9iamVjdHNbb2Jq\nZWN0Q291bnRdLAogICAgICAgICAgICAvLyAJCWZldGNoLCBjb250ZXh0KTsK\nICAgICAgICAgICAgY29kZS5hbG9hZCgpLnNldFBhcmFtKDApOwogICAgICAg\nICAgICBjb2RlLmNvbnN0YW50KCkuc2V0VmFsdWUoaW5kZXgpOwogICAgICAg\nICAgICBjb2RlLmFsb2FkKCkuc2V0VGhpcygpOwogICAgICAgICAgICBjb2Rl\nLmFsb2FkKCkuc2V0UGFyYW0oMCk7CiAgICAgICAgICAgIGNvZGUuYWxvYWQo\nKS5zZXRMb2NhbChsb2NhbCk7CiAgICAgICAgICAgIGNvZGUuYWxvYWQoKS5z\nZXRUaGlzKCk7CiAgICAgICAgICAgIGNvZGUuZ2V0ZmllbGQoKS5zZXRGaWVs\nZCgib2JqZWN0cyIsIE9iamVjdFtdLmNsYXNzKTsKICAgICAgICAgICAgY29k\nZS5jb25zdGFudCgpLnNldFZhbHVlKG9iamVjdENvdW50KTsKICAgICAgICAg\nICAgY29kZS5hYWxvYWQoKTsKICAgICAgICAgICAgY29kZS5hbG9hZCgpLnNl\ndFBhcmFtKDEgKyBvZmZzZXQpOwogICAgICAgICAgICBjb2RlLmFsb2FkKCku\nc2V0UGFyYW0oMiArIG9mZnNldCk7CiAgICAgICAgICAgIGNvZGUuaW52b2tl\ndmlydHVhbCgpLnNldE1ldGhvZChiYy5nZXROYW1lKCksICJ0b0ZpZWxkIiwK\nICAgICAgICAgICAgICAgIE9iamVjdC5jbGFzcy5nZXROYW1lKCksIHRvU3Ry\naW5ncyhuZXcgQ2xhc3NbXXsgCiAgICAgICAgICAgICAgICBPcGVuSlBBU3Rh\ndGVNYW5hZ2VyLmNsYXNzLCBGaWVsZE1ldGFEYXRhLmNsYXNzLAogICAgICAg\nICAgICAgICAgT2JqZWN0LmNsYXNzLCBGZXRjaENvbmZpZ3VyYXRpb24uY2xh\nc3MsIE9iamVjdC5jbGFzcyB9KSk7CiAgICAgICAgICAgIGNvZGUuaW52b2tl\naW50ZXJmYWNlKCkuc2V0TWV0aG9kKE9wZW5KUEFTdGF0ZU1hbmFnZXIuY2xh\nc3MsCiAgICAgICAgICAgICAgICAic3RvcmVGaWVsZCIsIHZvaWQuY2xhc3Ms\nCiAgICAgICAgICAgICAgICBuZXcgQ2xhc3NbXXsgaW50LmNsYXNzLCBPYmpl\nY3QuY2xhc3MgfSk7CiAgICAgICAgfQogICAgICAgIHJldHVybiBmaXJzdDsK\nICAgIH0KCiAgICAvKioKICAgICAqIExvYWQgaW50ZXJtZWRpYXRlIGRhdGEg\naWYgcG9zc2libGUuCiAgICAgKi8KICAgIHByaXZhdGUgSW5zdHJ1Y3Rpb24g\nYWRkTG9hZEludGVybWVkaWF0ZShDb2RlIGNvZGUsIGludCBpbmRleCwKICAg\nICAgICBpbnQgb2JqZWN0Q291bnQsIENvbGxlY3Rpb24ganVtcHMyLCBpbnQg\naW50ZXIpIHsKICAgICAgICAvLyB7CiAgICAgICAgLy8gCQlPYmplY3QgaW50\nZXIgPSBvYmplY3RzW29iamVjdENvdW50XTsKICAgICAgICBJbnN0cnVjdGlv\nbiBmaXJzdCA9IGNvZGUuYWxvYWQoKS5zZXRUaGlzKCk7CiAgICAgICAgY29k\nZS5nZXRmaWVsZCgpLnNldEZpZWxkKCJvYmplY3RzIiwgT2JqZWN0W10uY2xh\nc3MpOwogICAgICAgIGNvZGUuY29uc3RhbnQoKS5zZXRWYWx1ZShvYmplY3RD\nb3VudCk7CiAgICAgICAgY29kZS5hYWxvYWQoKTsKICAgICAgICBjb2RlLmFz\ndG9yZSgpLnNldExvY2FsKGludGVyKTsKICAgICAgICAvLyAJCWlmIChpbnRl\nciAhPSBudWxsICYmICFzbS5nZXRMb2FkZWQoKS5nZXQoaW5kZXgpKQogICAg\nICAgIGNvZGUuYWxvYWQoKS5zZXRMb2NhbChpbnRlcik7CiAgICAgICAganVt\ncHMyLmFkZChjb2RlLmlmbnVsbCgpKTsKICAgICAgICBjb2RlLmFsb2FkKCku\nc2V0UGFyYW0oMCk7CiAgICAgICAgY29kZS5pbnZva2VpbnRlcmZhY2UoKS5z\nZXRNZXRob2QoT3BlbkpQQVN0YXRlTWFuYWdlci5jbGFzcywKICAgICAgICAg\nICAgImdldExvYWRlZCIsIEJpdFNldC5jbGFzcywgbnVsbCk7CiAgICAgICAg\nY29kZS5jb25zdGFudCgpLnNldFZhbHVlKGluZGV4KTsKICAgICAgICBjb2Rl\nLmludm9rZXZpcnR1YWwoKS5zZXRNZXRob2QoQml0U2V0LmNsYXNzLCAiZ2V0\nIiwKICAgICAgICAgICAgYm9vbGVhbi5jbGFzcywgbmV3IENsYXNzW117IGlu\ndC5jbGFzcyB9KTsKICAgICAgICBqdW1wczIuYWRkKGNvZGUuaWZuZSgpKTsK\nICAgICAgICAvLwkJCXNtLnNldEludGVybWVkaWF0ZShpbmRleCwgaW50ZXIp\nOwogICAgICAgIC8vCX0gIC8vIGVuZCBlbHNlCiAgICAgICAgY29kZS5hbG9h\nZCgpLnNldFBhcmFtKDApOwogICAgICAgIGNvZGUuY29uc3RhbnQoKS5zZXRW\nYWx1ZShpbmRleCk7CiAgICAgICAgY29kZS5hbG9hZCgpLnNldExvY2FsKGlu\ndGVyKTsKICAgICAgICBjb2RlLmludm9rZWludGVyZmFjZSgpLnNldE1ldGhv\nZChPcGVuSlBBU3RhdGVNYW5hZ2VyLmNsYXNzLAogICAgICAgICAgICAic2V0\nSW50ZXJtZWRpYXRlIiwgdm9pZC5jbGFzcywKICAgICAgICAgICAgbmV3IENs\nYXNzW117IGludC5jbGFzcywgT2JqZWN0LmNsYXNzIH0pOwogICAgICAgIHJl\ndHVybiBmaXJzdDsKICAgIH0KCiAgICBwcml2YXRlIHZvaWQgYWRkU3RvcmVN\nZXRob2RzKEJDQ2xhc3MgYmMsIENsYXNzTWV0YURhdGEgbWV0YSkgewogICAg\nICAgIC8vIGkuZS4gdm9pZCBzdG9yZShPcGVuSlBBU3RhdGVNYW5hZ2VyIHNt\nLCBCaXRTZXQgZmllbGRzKTsKICAgICAgICBhZGRTdG9yZU1ldGhvZChiYywg\nbWV0YSwgdHJ1ZSk7CiAgICAgICAgLy8gaS5lLiB2b2lkIHN0b3JlKE9wZW5K\nUEFTdGF0ZU1hbmFnZXIgc20pOwogICAgICAgIGFkZFN0b3JlTWV0aG9kKGJj\nLCBtZXRhLCBmYWxzZSk7CiAgICB9CgogICAgcHJpdmF0ZSB2b2lkIGFkZFN0\nb3JlTWV0aG9kKEJDQ2xhc3MgYmMsIENsYXNzTWV0YURhdGEgbWV0YSwKICAg\nICAgICBib29sZWFuIGZpZWxkcykgewogICAgICAgIEJDTWV0aG9kIHN0b3Jl\nOwogICAgICAgIGlmIChmaWVsZHMpCiAgICAgICAgICAgIHN0b3JlID0gYmMu\nZGVjbGFyZU1ldGhvZCgic3RvcmUiLCB2b2lkLmNsYXNzLAogICAgICAgICAg\nICAgICAgbmV3IENsYXNzW117IE9wZW5KUEFTdGF0ZU1hbmFnZXIuY2xhc3Ms\nIEJpdFNldC5jbGFzcyB9KTsKICAgICAgICBlbHNlCiAgICAgICAgICAgIHN0\nb3JlID0gYmMuZGVjbGFyZU1ldGhvZCgic3RvcmUiLCB2b2lkLmNsYXNzLAog\nICAgICAgICAgICAgICAgbmV3IENsYXNzW117IE9wZW5KUEFTdGF0ZU1hbmFn\nZXIuY2xhc3MgfSk7CiAgICAgICAgQ29kZSBjb2RlID0gc3RvcmUuZ2V0Q29k\nZSh0cnVlKTsKCiAgICAgICAgLy8gaW5pdGlhbGl6ZSgpOwogICAgICAgIGNv\nZGUuYWxvYWQoKS5zZXRUaGlzKCk7CiAgICAgICAgY29kZS5pbnZva2V2aXJ0\ndWFsKCkuc2V0TWV0aG9kKCJpbml0aWFsaXplIiwgdm9pZC5jbGFzcywgbnVs\nbCk7CgogICAgICAgIC8vIHN0b3JlVmVyc2lvbihzbSk7CiAgICAgICAgY29k\nZS5hbG9hZCgpLnNldFRoaXMoKTsKICAgICAgICBjb2RlLmFsb2FkKCkuc2V0\nUGFyYW0oMCk7CiAgICAgICAgY29kZS5pbnZva2V2aXJ0dWFsKCkuc2V0TWV0\naG9kKCJzdG9yZVZlcnNpb24iLCB2b2lkLmNsYXNzLAogICAgICAgICAgICBu\nZXcgQ2xhc3NbXXsgT3BlbkpQQVN0YXRlTWFuYWdlci5jbGFzcyB9KTsKCiAg\nICAgICAgLy8gc3RvcmVJbXBsRGF0YShzbSk7CiAgICAgICAgY29kZS5hbG9h\nZCgpLnNldFRoaXMoKTsKICAgICAgICBjb2RlLmFsb2FkKCkuc2V0UGFyYW0o\nMCk7CiAgICAgICAgY29kZS5pbnZva2V2aXJ0dWFsKCkuc2V0TWV0aG9kKCJz\ndG9yZUltcGxEYXRhIiwgdm9pZC5jbGFzcywKICAgICAgICAgICAgbmV3IENs\nYXNzW117IE9wZW5KUEFTdGF0ZU1hbmFnZXIuY2xhc3MgfSk7CgogICAgICAg\nIEZpZWxkTWV0YURhdGFbXSBmbWRzID0gbWV0YS5nZXRGaWVsZHMoKTsKICAg\nICAgICBDb2xsZWN0aW9uIGp1bXBzID0gbmV3IExpbmtlZExpc3QoKTsKICAg\nICAgICBpbnQgb2JqZWN0Q291bnQgPSAwOwogICAgICAgIGZvciAoaW50IGkg\nPSAwOyBpIDwgZm1kcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBpZiAo\nZmllbGRzKSB7CiAgICAgICAgICAgICAgICAvLyAgaWYgKGZpZWxkcyAhPSBu\ndWxsICYmIGZpZWxkcy5nZXQoaW5kZXgpKQogICAgICAgICAgICAgICAgc2V0\nVGFyZ2V0KGNvZGUuYWxvYWQoKS5zZXRQYXJhbSgxKSwganVtcHMpOwogICAg\nICAgICAgICAgICAganVtcHMuYWRkKGNvZGUuaWZudWxsKCkpOwogICAgICAg\nICAgICAgICAgY29kZS5hbG9hZCgpLnNldFBhcmFtKDEpOwogICAgICAgICAg\nICAgICAgY29kZS5jb25zdGFudCgpLnNldFZhbHVlKGkpOwogICAgICAgICAg\nICAgICAgY29kZS5pbnZva2V2aXJ0dWFsKCkuc2V0TWV0aG9kKEJpdFNldC5j\nbGFzcywgImdldCIsCiAgICAgICAgICAgICAgICAgICAgYm9vbGVhbi5jbGFz\ncywgbmV3IENsYXNzW117IGludC5jbGFzcyB9KTsKICAgICAgICAgICAgICAg\nIGp1bXBzLmFkZChjb2RlLmlmZXEoKSk7CiAgICAgICAgICAgIH0gZWxzZSB7\nCiAgICAgICAgICAgICAgICAvLyBpZiAoc20uZ2V0TG9hZGVkKCkuZ2V0KGlu\nZGV4KSkpCiAgICAgICAgICAgICAgICBzZXRUYXJnZXQoY29kZS5hbG9hZCgp\nLnNldFBhcmFtKDApLCBqdW1wcyk7CiAgICAgICAgICAgICAgICBjb2RlLmlu\ndm9rZWludGVyZmFjZSgpLnNldE1ldGhvZChPcGVuSlBBU3RhdGVNYW5hZ2Vy\nLmNsYXNzLAogICAgICAgICAgICAgICAgICAgICJnZXRMb2FkZWQiLCBCaXRT\nZXQuY2xhc3MsIG51bGwpOwogICAgICAgICAgICAgICAgY29kZS5jb25zdGFu\ndCgpLnNldFZhbHVlKGkpOwogICAgICAgICAgICAgICAgY29kZS5pbnZva2V2\naXJ0dWFsKCkuc2V0TWV0aG9kKEJpdFNldC5jbGFzcywgImdldCIsCiAgICAg\nICAgICAgICAgICAgICAgYm9vbGVhbi5jbGFzcywgbmV3IENsYXNzW117IGlu\ndC5jbGFzcyB9KTsKICAgICAgICAgICAgICAgIGp1bXBzLmFkZChjb2RlLmlm\nZXEoKSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgYWRkU3RvcmUoYmMs\nIGNvZGUsIGZtZHNbaV0sIG9iamVjdENvdW50KTsKICAgICAgICAgICAgaWYg\nKHVzZXNJbnRlcm1lZGlhdGUoZm1kc1tpXSkpIHsKICAgICAgICAgICAgICAg\nIEp1bXBJbnN0cnVjdGlvbiBlbHNlSW5zID0gY29kZS5nbzIoKTsKICAgICAg\nICAgICAgICAgIC8vIGVsc2UgaWYgKCFsb2FkZWQuZ2V0KGluZGV4KSkKICAg\nICAgICAgICAgICAgIHNldFRhcmdldChjb2RlLmFsb2FkKCkuc2V0VGhpcygp\nLCBqdW1wcyk7CiAgICAgICAgICAgICAgICBqdW1wcy5hZGQoZWxzZUlucyk7\nCiAgICAgICAgICAgICAgICBjb2RlLmdldGZpZWxkKCkuc2V0RmllbGQoImxv\nYWRlZCIsIEJpdFNldC5jbGFzcyk7CiAgICAgICAgICAgICAgICBjb2RlLmNv\nbnN0YW50KCkuc2V0VmFsdWUoaSk7CiAgICAgICAgICAgICAgICBjb2RlLmlu\ndm9rZXZpcnR1YWwoKS5zZXRNZXRob2QoQml0U2V0LmNsYXNzLCAiZ2V0IiwK\nICAgICAgICAgICAgICAgICAgICBib29sZWFuLmNsYXNzLCBuZXcgQ2xhc3Nb\nXXsgaW50LmNsYXNzIH0pOwogICAgICAgICAgICAgICAganVtcHMuYWRkKGNv\nZGUuaWZuZSgpKTsKICAgICAgICAgICAgICAgIC8vIE9iamVjdCB2YWwgPSBz\nbS5nZXRJbnRlcm1lZGlhdGUoaW5kZXgpOwogICAgICAgICAgICAgICAgLy8g\naWYgKHZhbCAhPSBudWxsKQogICAgICAgICAgICAgICAgLy8gCQlvYmplY3Rz\nW29iamVjdENvdW50XSA9IHZhbDsKICAgICAgICAgICAgICAgIGNvZGUuYWxv\nYWQoKS5zZXRQYXJhbSgwKTsKICAgICAgICAgICAgICAgIGNvZGUuY29uc3Rh\nbnQoKS5zZXRWYWx1ZShpKTsKICAgICAgICAgICAgICAgIGNvZGUuaW52b2tl\naW50ZXJmYWNlKCkuc2V0TWV0aG9kKE9wZW5KUEFTdGF0ZU1hbmFnZXIuY2xh\nc3MsCiAgICAgICAgICAgICAgICAgICAgImdldEludGVybWVkaWF0ZSIsIE9i\namVjdC5jbGFzcywgbmV3IENsYXNzW117IGludC5jbGFzcyB9KTsKICAgICAg\nICAgICAgICAgIGludCBsb2NhbCA9IGNvZGUuZ2V0TmV4dExvY2Fsc0luZGV4\nKCk7CiAgICAgICAgICAgICAgICBjb2RlLmFzdG9yZSgpLnNldExvY2FsKGxv\nY2FsKTsKICAgICAgICAgICAgICAgIGNvZGUuYWxvYWQoKS5zZXRMb2NhbChs\nb2NhbCk7CiAgICAgICAgICAgICAgICBqdW1wcy5hZGQoY29kZS5pZm51bGwo\nKSk7CiAgICAgICAgICAgICAgICBjb2RlLmFsb2FkKCkuc2V0VGhpcygpOwog\nICAgICAgICAgICAgICAgY29kZS5nZXRmaWVsZCgpLnNldEZpZWxkKCJvYmpl\nY3RzIiwgT2JqZWN0W10uY2xhc3MpOwogICAgICAgICAgICAgICAgY29kZS5j\nb25zdGFudCgpLnNldFZhbHVlKG9iamVjdENvdW50KTsKICAgICAgICAgICAg\nICAgIGNvZGUuYWxvYWQoKS5zZXRMb2NhbChsb2NhbCk7CiAgICAgICAgICAg\nICAgICBjb2RlLmFhc3RvcmUoKTsKICAgICAgICAgICAgfQogICAgICAgICAg\nICBpZiAocmVwbGFjZVR5cGUoZm1kc1tpXSkgPj0gSmF2YVR5cGVzLk9CSkVD\nVCkKICAgICAgICAgICAgICAgIG9iamVjdENvdW50Kys7CiAgICAgICAgfQog\nICAgICAgIHNldFRhcmdldChjb2RlLnZyZXR1cm4oKSwganVtcHMpOwogICAg\nICAgIGNvZGUuY2FsY3VsYXRlTWF4TG9jYWxzKCk7CiAgICAgICAgY29kZS5j\nYWxjdWxhdGVNYXhTdGFjaygpOwogICAgfQoKICAgIHByaXZhdGUgdm9pZCBh\nZGRTdG9yZShCQ0NsYXNzIGJjLCBDb2RlIGNvZGUsIEZpZWxkTWV0YURhdGEg\nZm1kLAogICAgICAgIGludCBvYmplY3RDb3VudCkgewogICAgICAgIGludCB0\neXBlQ29kZSA9IHJlcGxhY2VUeXBlKGZtZCk7CiAgICAgICAgaW50IGluZGV4\nID0gZm1kLmdldEluZGV4KCk7CiAgICAgICAgaWYgKHR5cGVDb2RlIDwgSmF2\nYVR5cGVzLk9CSkVDVCkgewogICAgICAgICAgICBDbGFzcyB0eXBlID0gZm9y\nVHlwZSh0eXBlQ29kZSk7CiAgICAgICAgICAgIC8vIGZpZWxkPGk+ID0gc20u\nZmV0Y2g8VHlwZT4oaW5kZXgpCiAgICAgICAgICAgIGNvZGUuYWxvYWQoKS5z\nZXRUaGlzKCk7CiAgICAgICAgICAgIGNvZGUuYWxvYWQoKS5zZXRQYXJhbSgw\nKTsKICAgICAgICAgICAgY29kZS5jb25zdGFudCgpLnNldFZhbHVlKGluZGV4\nKTsKICAgICAgICAgICAgY29kZS5pbnZva2VpbnRlcmZhY2UoKS5zZXRNZXRo\nb2QoT3BlbkpQQVN0YXRlTWFuYWdlci5jbGFzcywKICAgICAgICAgICAgICAg\nICJmZXRjaCIgKyBTdHJpbmdVdGlscy5jYXBpdGFsaXplKHR5cGUuZ2V0TmFt\nZSgpKSwgdHlwZSwKICAgICAgICAgICAgICAgIG5ldyBDbGFzc1tdeyBpbnQu\nY2xhc3MgfSk7CiAgICAgICAgICAgIGNvZGUucHV0ZmllbGQoKS5zZXRGaWVs\nZChnZXRGaWVsZE5hbWUoaW5kZXgpLCB0eXBlKTsKICAgICAgICAgICAgY29k\nZS5hbG9hZCgpLnNldFRoaXMoKTsKICAgICAgICAgICAgY29kZS5nZXRmaWVs\nZCgpLnNldEZpZWxkKCJsb2FkZWQiLCBCaXRTZXQuY2xhc3MpOwogICAgICAg\nICAgICBjb2RlLmNvbnN0YW50KCkuc2V0VmFsdWUoaW5kZXgpOwogICAgICAg\nICAgICBjb2RlLmludm9rZXZpcnR1YWwoKS5zZXRNZXRob2QoQml0U2V0LmNs\nYXNzLCAic2V0Iiwgdm9pZC5jbGFzcywKICAgICAgICAgICAgICAgIG5ldyBD\nbGFzc1tdeyBpbnQuY2xhc3MgfSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAg\nICAgICAgLy8gT2JqZWN0IHZhbCA9IHRvRGF0YShzbS5nZXRNZXRhRGF0YSgp\nLmdldEZpZWxkKGluZGV4KSwKICAgICAgICAgICAgLy8gCQlzbS5mZXRjaEZp\nZWxkKGluZGV4LCBmYWxzZSksIHNtLmdldENvbnRleHQoKSk7CiAgICAgICAg\nICAgIGludCBsb2NhbCA9IGNvZGUuZ2V0TmV4dExvY2Fsc0luZGV4KCk7CiAg\nICAgICAgICAgIGNvZGUuYWxvYWQoKS5zZXRUaGlzKCk7CiAgICAgICAgICAg\nIGNvZGUuYWxvYWQoKS5zZXRQYXJhbSgwKTsKICAgICAgICAgICAgY29kZS5p\nbnZva2VpbnRlcmZhY2UoKS5zZXRNZXRob2QoT3BlbkpQQVN0YXRlTWFuYWdl\nci5jbGFzcywKICAgICAgICAgICAgICAgICJnZXRNZXRhRGF0YSIsIENsYXNz\nTWV0YURhdGEuY2xhc3MsIG51bGwpOwogICAgICAgICAgICBjb2RlLmNvbnN0\nYW50KCkuc2V0VmFsdWUoZm1kLmdldEluZGV4KCkpOwogICAgICAgICAgICBj\nb2RlLmludm9rZXZpcnR1YWwoKS5zZXRNZXRob2QoQ2xhc3NNZXRhRGF0YS5j\nbGFzcywKICAgICAgICAgICAgICAgICJnZXRGaWVsZCIsIEZpZWxkTWV0YURh\ndGEuY2xhc3MsIG5ldyBDbGFzc1tdeyBpbnQuY2xhc3MgfSk7CiAgICAgICAg\nICAgIGNvZGUuYWxvYWQoKS5zZXRQYXJhbSgwKTsKICAgICAgICAgICAgY29k\nZS5jb25zdGFudCgpLnNldFZhbHVlKGZtZC5nZXRJbmRleCgpKTsKICAgICAg\nICAgICAgY29kZS5jb25zdGFudCgpLnNldFZhbHVlKGZhbHNlKTsKICAgICAg\nICAgICAgY29kZS5pbnZva2VpbnRlcmZhY2UoKS5zZXRNZXRob2QoT3BlbkpQ\nQVN0YXRlTWFuYWdlci5jbGFzcywKICAgICAgICAgICAgICAgICJmZXRjaEZp\nZWxkIiwgT2JqZWN0LmNsYXNzLCBuZXcgQ2xhc3NbXQogICAgICAgICAgICAg\nICAgeyBpbnQuY2xhc3MsIGJvb2xlYW4uY2xhc3MgfSk7CiAgICAgICAgICAg\nIGNvZGUuYWxvYWQoKS5zZXRQYXJhbSgwKTsKICAgICAgICAgICAgY29kZS5p\nbnZva2VpbnRlcmZhY2UoKS5zZXRNZXRob2QoT3BlbkpQQVN0YXRlTWFuYWdl\nci5jbGFzcywKICAgICAgICAgICAgICAgICJnZXRDb250ZXh0IiwgU3RvcmVD\nb250ZXh0LmNsYXNzLCBudWxsKTsKICAgICAgICAgICAgY29kZS5pbnZva2V2\naXJ0dWFsKCkuc2V0TWV0aG9kKGJjLmdldE5hbWUoKSwgInRvRGF0YSIsCiAg\nICAgICAgICAgICAgICBPYmplY3QuY2xhc3MuZ2V0TmFtZSgpLCB0b1N0cmlu\nZ3MobmV3IENsYXNzIFtdewogICAgICAgICAgICAgICAgRmllbGRNZXRhRGF0\nYS5jbGFzcywgT2JqZWN0LmNsYXNzLCBTdG9yZUNvbnRleHQuY2xhc3MgfSkp\nOwogICAgICAgICAgICBjb2RlLmFzdG9yZSgpLnNldExvY2FsKGxvY2FsKTsK\nCiAgICAgICAgICAgIC8vIGlmICh2YWwgPT0gTlVMTCkgewogICAgICAgICAg\nICAvLyAJCXZhbCA9IG51bGw7CiAgICAgICAgICAgIC8vIAkJbG9hZGVkLmNs\nZWFyKGluZGV4KTsKICAgICAgICAgICAgLy8gCX0gZWxzZQogICAgICAgICAg\nICAvLyAJCWxvYWRlZC5zZXQoaW5kZXgpOwogICAgICAgICAgICAvLyAJb2Jq\nZWN0c1tvYmplY3RDb3VudF0gPSB2YWw7CiAgICAgICAgICAgIGNvZGUuYWxv\nYWQoKS5zZXRMb2NhbChsb2NhbCk7CiAgICAgICAgICAgIGNvZGUuZ2V0c3Rh\ndGljKCkuc2V0RmllbGQoQWJzdHJhY3RQQ0RhdGEuY2xhc3MsICJOVUxMIiwK\nICAgICAgICAgICAgICAgIE9iamVjdC5jbGFzcyk7CiAgICAgICAgICAgIEp1\nbXBJbnN0cnVjdGlvbiBpZmlucyA9IGNvZGUuaWZhY21wbmUoKTsKICAgICAg\nICAgICAgY29kZS5jb25zdGFudCgpLnNldE51bGwoKTsKICAgICAgICAgICAg\nY29kZS5hc3RvcmUoKS5zZXRMb2NhbChsb2NhbCk7CiAgICAgICAgICAgIGNv\nZGUuYWxvYWQoKS5zZXRUaGlzKCk7CiAgICAgICAgICAgIGNvZGUuZ2V0Zmll\nbGQoKS5zZXRGaWVsZCgibG9hZGVkIiwgQml0U2V0LmNsYXNzKTsKICAgICAg\nICAgICAgY29kZS5jb25zdGFudCgpLnNldFZhbHVlKGluZGV4KTsKICAgICAg\nICAgICAgY29kZS5pbnZva2V2aXJ0dWFsKCkuc2V0TWV0aG9kKEJpdFNldC5j\nbGFzcywgImNsZWFyIiwgdm9pZC5jbGFzcywKICAgICAgICAgICAgICAgIG5l\ndyBDbGFzc1tdeyBpbnQuY2xhc3MgfSk7CiAgICAgICAgICAgIEp1bXBJbnN0\ncnVjdGlvbiBnbzIgPSBjb2RlLmdvMigpOwogICAgICAgICAgICBpZmlucy5z\nZXRUYXJnZXQoY29kZS5hbG9hZCgpLnNldFRoaXMoKSk7CiAgICAgICAgICAg\nIGNvZGUuZ2V0ZmllbGQoKS5zZXRGaWVsZCgibG9hZGVkIiwgQml0U2V0LmNs\nYXNzKTsKICAgICAgICAgICAgY29kZS5jb25zdGFudCgpLnNldFZhbHVlKGlu\nZGV4KTsKICAgICAgICAgICAgY29kZS5pbnZva2V2aXJ0dWFsKCkuc2V0TWV0\naG9kKEJpdFNldC5jbGFzcywgInNldCIsIHZvaWQuY2xhc3MsCiAgICAgICAg\nICAgICAgICBuZXcgQ2xhc3NbXXsgaW50LmNsYXNzIH0pOwogICAgICAgICAg\nICBnbzIuc2V0VGFyZ2V0KGNvZGUuYWxvYWQoKS5zZXRUaGlzKCkpOwogICAg\nICAgICAgICBjb2RlLmdldGZpZWxkKCkuc2V0RmllbGQoIm9iamVjdHMiLCBP\nYmplY3RbXS5jbGFzcyk7CiAgICAgICAgICAgIGNvZGUuY29uc3RhbnQoKS5z\nZXRWYWx1ZShvYmplY3RDb3VudCk7CiAgICAgICAgICAgIGNvZGUuYWxvYWQo\nKS5zZXRMb2NhbChsb2NhbCk7CiAgICAgICAgICAgIGNvZGUuYWFzdG9yZSgp\nOwogICAgICAgIH0KICAgICAgICBpZiAoIXVzZXNJbXBsRGF0YShmbWQpKQog\nICAgICAgICAgICByZXR1cm47CgogICAgICAgIC8vIHN0b3JlSW1wbERhdGEo\nc20sIGksIGxvYWRlZC5nZXQoaSk7CiAgICAgICAgY29kZS5hbG9hZCgpLnNl\ndFRoaXMoKTsKICAgICAgICBjb2RlLmFsb2FkKCkuc2V0UGFyYW0oMCk7CiAg\nICAgICAgY29kZS5jb25zdGFudCgpLnNldFZhbHVlKGluZGV4KTsKICAgICAg\nICBjb2RlLmFsb2FkKCkuc2V0VGhpcygpOwogICAgICAgIGNvZGUuZ2V0Zmll\nbGQoKS5zZXRGaWVsZCgibG9hZGVkIiwgQml0U2V0LmNsYXNzKTsKICAgICAg\nICBjb2RlLmNvbnN0YW50KCkuc2V0VmFsdWUoaW5kZXgpOwogICAgICAgIGNv\nZGUuaW52b2tldmlydHVhbCgpLnNldE1ldGhvZChCaXRTZXQuY2xhc3MsICJn\nZXQiLCBib29sZWFuLmNsYXNzLAogICAgICAgICAgICBuZXcgQ2xhc3NbXXsg\naW50LmNsYXNzIH0pOwogICAgICAgIGNvZGUuaW52b2tldmlydHVhbCgpLnNl\ndE1ldGhvZCgic3RvcmVJbXBsRGF0YSIsIHZvaWQuY2xhc3MsCiAgICAgICAg\nICAgIG5ldyBDbGFzc1tdeyBPcGVuSlBBU3RhdGVNYW5hZ2VyLmNsYXNzLCBp\nbnQuY2xhc3MsIGJvb2xlYW4uY2xhc3MgfSk7CiAgICB9CgogICAgcHJpdmF0\nZSB2b2lkIGFkZE5ld0VtYmVkZGVkKEJDQ2xhc3MgYmMpIHsKICAgICAgICAv\nLyB2b2lkIG5ld0VtYmVkZGVkUENEYXRhKE9wZW5KUEFTdGF0ZU1hbmFnZXIg\nZW1iZWRkZWQpCiAgICAgICAgQkNNZXRob2QgbWV0aCA9IGJjLmRlY2xhcmVN\nZXRob2QoIm5ld0VtYmVkZGVkUENEYXRhIiwgUENEYXRhLmNsYXNzLAogICAg\nICAgICAgICBuZXcgQ2xhc3NbXXsgT3BlbkpQQVN0YXRlTWFuYWdlci5jbGFz\ncyB9KTsKICAgICAgICBDb2RlIGNvZGUgPSBtZXRoLmdldENvZGUodHJ1ZSk7\nCiAgICAgICAgLy8gcmV0dXJuIGdldFN0b3JhZ2VHZW5lcmF0b3IoKS5nZW5l\ncmF0ZVBDRGF0YQogICAgICAgIC8vIAkJKHNtLmdldElkKCksIHNtLmdldE1l\ndGFEYXRhKCkpOwogICAgICAgIGNvZGUuYWxvYWQoKS5zZXRUaGlzKCk7CiAg\nICAgICAgY29kZS5nZXRmaWVsZCgpLnNldEZpZWxkKCJzdG9yYWdlR2VuZXJh\ndG9yIiwgUENEYXRhR2VuZXJhdG9yLmNsYXNzKTsKICAgICAgICBjb2RlLmFs\nb2FkKCkuc2V0UGFyYW0oMCk7CiAgICAgICAgY29kZS5pbnZva2VpbnRlcmZh\nY2UoKS5zZXRNZXRob2QoT3BlbkpQQVN0YXRlTWFuYWdlci5jbGFzcywKICAg\nICAgICAgICAgImdldElkIiwgT2JqZWN0LmNsYXNzLCBudWxsKTsKICAgICAg\nICBjb2RlLmFsb2FkKCkuc2V0UGFyYW0oMCk7CiAgICAgICAgY29kZS5pbnZv\na2VpbnRlcmZhY2UoKS5zZXRNZXRob2QoT3BlbkpQQVN0YXRlTWFuYWdlci5j\nbGFzcywKICAgICAgICAgICAgImdldE1ldGFEYXRhIiwgQ2xhc3NNZXRhRGF0\nYS5jbGFzcywgbnVsbCk7CiAgICAgICAgY29kZS5pbnZva2V2aXJ0dWFsKCku\nc2V0TWV0aG9kKFBDRGF0YUdlbmVyYXRvci5jbGFzcywKICAgICAgICAgICAg\nImdlbmVyYXRlUENEYXRhIiwgUENEYXRhLmNsYXNzLCBuZXcgQ2xhc3NbXQog\nICAgICAgICAgICB7IE9iamVjdC5jbGFzcywgQ2xhc3NNZXRhRGF0YS5jbGFz\ncyB9KTsKICAgICAgICBjb2RlLmFyZXR1cm4oKTsKICAgICAgICBjb2RlLmNh\nbGN1bGF0ZU1heExvY2FscygpOwogICAgICAgIGNvZGUuY2FsY3VsYXRlTWF4\nU3RhY2soKTsKICAgIH0KCiAgICBwcml2YXRlIHZvaWQgYWRkR2V0RGF0YShC\nQ0NsYXNzIGJjKSB7CiAgICAgICAgLy8gcmV0dXJuIGdldE9iamVjdEZpZWxk\nKGkpOwogICAgICAgIEJDTWV0aG9kIG1ldGhvZCA9IGJjLmRlY2xhcmVNZXRo\nb2QoImdldERhdGEiLCBPYmplY3QuY2xhc3MsCiAgICAgICAgICAgIG5ldyBD\nbGFzc1tdeyBpbnQuY2xhc3MgfSk7CiAgICAgICAgQ29kZSBjb2RlID0gbWV0\naG9kLmdldENvZGUodHJ1ZSk7CiAgICAgICAgY29kZS5hbG9hZCgpLnNldFRo\naXMoKTsKICAgICAgICBjb2RlLmlsb2FkKCkuc2V0UGFyYW0oMCk7CiAgICAg\nICAgY29kZS5pbnZva2V2aXJ0dWFsKCkuc2V0TWV0aG9kKCJnZXRPYmplY3Qi\nLCBPYmplY3QuY2xhc3MsCiAgICAgICAgICAgIG5ldyBDbGFzc1tdeyBpbnQu\nY2xhc3MgfSk7CiAgICAgICAgY29kZS5hcmV0dXJuKCk7CiAgICAgICAgY29k\nZS5jYWxjdWxhdGVNYXhMb2NhbHMoKTsKICAgICAgICBjb2RlLmNhbGN1bGF0\nZU1heFN0YWNrKCk7CiAgICB9CgogICAgLy8vLy8vLy8vLy8vLwogICAgLy8g\nVXRpbGl0aWVzCiAgICAvLy8vLy8vLy8vLy8vCgogICAgLyoqCiAgICAgKiBS\nZXR1cm4gYSB2YWxpZCB7QGxpbmsgSmF2YVR5cGVzfSBjb25zdGFudCBmb3Ig\ndGhlIGdpdmVuIGZpZWxkCiAgICAgKi8KICAgIHByb3RlY3RlZCBpbnQgcmVw\nbGFjZVR5cGUoRmllbGRNZXRhRGF0YSBmbWQpIHsKICAgICAgICBpZiAodXNl\nc0ludGVybWVkaWF0ZShmbWQpKQogICAgICAgICAgICByZXR1cm4gSmF2YVR5\ncGVzLk9CSkVDVDsKICAgICAgICByZXR1cm4gZm1kLmdldFR5cGVDb2RlKCk7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBXaGV0aGVyIHRoZSBnaXZlbiBmaWVs\nZCB1c2VzIGEgY2FjaGVhYmxlIGludGVybWVkaWF0ZSB2YWx1ZS4KICAgICAq\nLwogICAgcHJvdGVjdGVkIGJvb2xlYW4gdXNlc0ludGVybWVkaWF0ZShGaWVs\nZE1ldGFEYXRhIGZtZCkgewogICAgICAgIHJldHVybiBmbWQudXNlc0ludGVy\nbWVkaWF0ZSgpOwogICAgfQoKICAgIC8qKgogICAgICogV2hldGhlciB0aGUg\nZ2l2ZW4gdHlwZSBtaWdodCBoYXZlIGNhY2hlYWJsZSBjbGFzcy1sZXZlbCBp\nbXBsIGRhdGEuCiAgICAgKi8KICAgIHByb3RlY3RlZCBib29sZWFuIHVzZXNJ\nbXBsRGF0YShDbGFzc01ldGFEYXRhIG1ldGEpIHsKICAgICAgICByZXR1cm4g\ndHJ1ZTsKICAgIH0KCiAgICAvKioKICAgICAqIFdoZXRoZXIgdGhlIGdpdmVu\nIGZpZWxkIG1pZ2h0IGhhdmUgY2FjaGVhYmxlIGltcGwgZGF0YS4KICAgICAq\nLwogICAgcHJvdGVjdGVkIGJvb2xlYW4gdXNlc0ltcGxEYXRhKEZpZWxkTWV0\nYURhdGEgZm1kKSB7CiAgICAgICAgcmV0dXJuIGZtZC51c2VzSW1wbERhdGEo\nKSA9PSBudWxsOwogICAgfQoKICAgIC8qKgogICAgICogVGhlIG51bWJlciBv\nZiBmaWVsZHMgd2l0aCBjYWNoZWFibGUgaW1wbCBkYXRhLgogICAgICovCiAg\nICBwcml2YXRlIGludCBjb3VudEltcGxEYXRhRmllbGRzKENsYXNzTWV0YURh\ndGEgbWV0YSkgewogICAgICAgIEZpZWxkTWV0YURhdGFbXSBmbWRzID0gbWV0\nYS5nZXRGaWVsZHMoKTsKICAgICAgICBpbnQgY291bnQgPSAwOwogICAgICAg\nIGZvciAoaW50IGkgPSAwOyBpIDwgZm1kcy5sZW5ndGg7IGkrKykKICAgICAg\nICAgICAgaWYgKHVzZXNJbXBsRGF0YShmbWRzW2ldKSkKICAgICAgICAgICAg\nICAgIGNvdW50Kys7CiAgICAgICAgcmV0dXJuIGNvdW50OwogICAgfQoKICAg\nIC8qKgogICAgICogQWRkIG1ldGhvZCB3aGljaCBkZWZlcnMgdG8gQWJzdHJh\nY3RQQ0RhdGEuCiAgICAgKi8KICAgIHByb3RlY3RlZCB2b2lkIGNhbGxBYnN0\ncmFjdFBDRGF0YShCQ0NsYXNzIGJjLCBTdHJpbmcgbmFtZSwgQ2xhc3MgcmV0\nVHlwZSwKICAgICAgICBDbGFzc1tdIGFyZ3MpIHsKICAgICAgICBCQ01ldGhv\nZCBtZXRoID0gYmMuZGVjbGFyZU1ldGhvZChuYW1lLCByZXRUeXBlLCBhcmdz\nKTsKICAgICAgICBDb2RlIGNvZGUgPSBtZXRoLmdldENvZGUodHJ1ZSk7CiAg\nICAgICAgY29kZS5hbG9hZCgpLnNldFRoaXMoKTsKICAgICAgICBmb3IgKGlu\ndCBpID0gMDsgaSA8IGFyZ3MubGVuZ3RoOyBpKyspCiAgICAgICAgICAgIGNv\nZGUueGxvYWQoKS5zZXRQYXJhbShpKS5zZXRUeXBlKGFyZ3NbaV0pOwogICAg\nICAgIGNvZGUuaW52b2tldmlydHVhbCgpLnNldE1ldGhvZChBYnN0cmFjdFBD\nRGF0YS5jbGFzcywgbmFtZSwgcmV0VHlwZSwKICAgICAgICAgICAgYXJncyk7\nCiAgICAgICAgaWYgKCF2b2lkLmNsYXNzLmVxdWFscyhyZXRUeXBlKSkKICAg\nICAgICAgICAgY29kZS54cmV0dXJuKCkuc2V0VHlwZShyZXRUeXBlKTsKICAg\nICAgICBjb2RlLmNhbGN1bGF0ZU1heExvY2FscygpOwogICAgICAgIGNvZGUu\nY2FsY3VsYXRlTWF4U3RhY2soKTsKICAgIH0KCiAgICAvKioKICAgICAqIFNl\ndCB0aGUgY29sbGVjdGlvbiBvZiB7QGxpbmsgSnVtcEluc3RydWN0aW9ufXMg\ndG8gdGhlIGdpdmVuIGluc3RydWN0aW9uLAogICAgICogY2xlYXJpbmcgdGhl\nIGNvbGxlY3Rpb24gaW4gdGhlIHByb2Nlc3MuCiAgICAgKi8KICAgIHByb3Rl\nY3RlZCB2b2lkIHNldFRhcmdldChJbnN0cnVjdGlvbiBpbnMsIENvbGxlY3Rp\nb24ganVtcHMpIHsKICAgICAgICBmb3IgKEl0ZXJhdG9yIGl0ID0ganVtcHMu\naXRlcmF0b3IoKTsgaXQuaGFzTmV4dCgpOykKICAgICAgICAgICAgKChKdW1w\nSW5zdHJ1Y3Rpb24pIGl0Lm5leHQoKSkuc2V0VGFyZ2V0KGlucyk7CiAgICAg\nICAganVtcHMuY2xlYXIoKTsKICAgIH0KCiAgICAvKioKICAgICAqIFRyYW5z\nZm9ybSB0aGUgZ2l2ZW4gYXJyYXkgb2YgY2xhc3NlcyB0byBzdHJpbmdzLgog\nICAgICovCiAgICBwcml2YXRlIHN0YXRpYyBTdHJpbmdbXSB0b1N0cmluZ3Mo\nQ2xhc3NbXSBjbHMpIHsKICAgICAgICBTdHJpbmdbXSBzdHJpbmdzID0gbmV3\nIFN0cmluZ1tjbHMubGVuZ3RoXTsKICAgICAgICBmb3IgKGludCBpID0gMDsg\naSA8IHN0cmluZ3MubGVuZ3RoOyBpKyspCiAgICAgICAgICAgIHN0cmluZ3Nb\naV0gPSBjbHNbaV0uZ2V0TmFtZSgpOwogICAgICAgIHJldHVybiBzdHJpbmdz\nOwogICAgfQoKICAgIC8qKgogICAgICogRHluYW1pYyB7QGxpbmsgUENEYXRh\nfXMgZ2VuZXJhdGVkIHdpbGwgaW1wbGVtZW50IHRoaXMgaW50ZXJmYWNlCiAg\nICAgKiB0byBzaW1wbGlmeSBpbml0aWFsaXphdGlvbi4KICAgICAqLwogICAg\ncHVibGljIHN0YXRpYyBpbnRlcmZhY2UgRHluYW1pY1BDRGF0YSBleHRlbmRz\nIFBDRGF0YSB7CgogICAgICAgIHB1YmxpYyB2b2lkIHNldElkKE9iamVjdCBv\naWQpOwoKICAgICAgICBwdWJsaWMgUENEYXRhR2VuZXJhdG9yIGdldFN0b3Jh\nZ2VHZW5lcmF0b3IoKTsKCiAgICAgICAgcHVibGljIHZvaWQgc2V0U3RvcmFn\nZUdlbmVyYXRvciAoUENEYXRhR2VuZXJhdG9yIGdlbmVyYXRvcik7Cgl9Cn0K\n","encoding":"base64"}

