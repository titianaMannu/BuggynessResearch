{"sha":"d3bce1033e51876f7dfcb0ea500663fefa881cd3","node_id":"MDQ6QmxvYjIwNjM2NDpkM2JjZTEwMzNlNTE4NzZmN2RmY2IwZWE1MDA2NjNmZWZhODgxY2Qz","size":13253,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/d3bce1033e51876f7dfcb0ea500663fefa881cd3","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNr\nYWdlIG9yZy5hcGFjaGUub3BlbmpwYS5lbmhhbmNlOwoKaW1wb3J0IGphdmEu\naW8uSU9FeGNlcHRpb247CmltcG9ydCBqYXZhLmlvLk9iamVjdElucHV0U3Ry\nZWFtOwppbXBvcnQgamF2YS5pby5PYmplY3RPdXRwdXRTdHJlYW07CmltcG9y\ndCBqYXZhLmlvLlNlcmlhbGl6YWJsZTsKaW1wb3J0IGphdmEubGFuZy5yZWZs\nZWN0LkZpZWxkOwppbXBvcnQgamF2YS5sYW5nLnJlZmxlY3QuTWV0aG9kOwoK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5jb25mLk9wZW5KUEFDb25maWd1\ncmF0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5PcGVu\nSlBBU3RhdGVNYW5hZ2VyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmtl\ncm5lbC5TdGF0ZU1hbmFnZXJJbXBsOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLm1ldGEuQ2xhc3NNZXRhRGF0YTsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5tZXRhLkZpZWxkTWV0YURhdGE7CmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEubWV0YS5KYXZhVHlwZXM7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEudXRpbC5BcHBsaWNhdGlvbklkczsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS51dGlsLkltcGxIZWxwZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEudXRpbC5JbnRlcm5hbEV4Y2VwdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS51dGlsLk9iamVjdElkOwoKLyoqCiAqIEltcGxlbWVudGF0aW9u\nIG9mIHRoZSB7QGxpbmsgUGVyc2lzdGVuY2VDYXBhYmxlfSBpbnRlcmZhY2Ug\ndGhhdCBjYW4gaGFuZGxlCiAqIHRoZSBwZXJzaXN0ZW5jZS1jYXBhYmxlIGNv\nbnRyYWN0IGZvciBpbnN0YW5jZXMgdGhhdCB3ZXJlIG5vdCBlbmhhbmNlZAog\nKiBiZWZvcmUgY2xhc3MgbG9hZCB0aW1lLgogKgogKiBAc2luY2UgMS4wLjAK\nICovCnB1YmxpYyBjbGFzcyBSZWZsZWN0aW5nUGVyc2lzdGVuY2VDYXBhYmxl\nCiAgICBpbXBsZW1lbnRzIFBlcnNpc3RlbmNlQ2FwYWJsZSwgTWFuYWdlZElu\nc3RhbmNlUHJvdmlkZXIsIFNlcmlhbGl6YWJsZSB7CgogICAgcHJpdmF0ZSBP\nYmplY3QgbzsKICAgIHByaXZhdGUgU3RhdGVNYW5hZ2VyIHNtOwoKICAgIC8v\nIHRoaXMgd2lsbCBiZSByZWNvbnN0aXR1dGVkIGluIHJlYWRPYmplY3QoKQog\nICAgcHJpdmF0ZSB0cmFuc2llbnQgUGVyc2lzdGVuY2VDYXBhYmxlIHBjU3Vi\nY2xhc3NJbnN0YW5jZTsKCiAgICAvLyB0aGlzIHdpbGwgcmVjb25zdGl0dXRl\nZCBieSBhIGNhbGwgdG8gcGNSZXBsYWNlU3RhdGVNYW5hZ2VyKCkgYnkgdGhl\nCiAgICAvLyBpbnN0YW5jZSB0aGF0IGhhcyBhIHJlZmVyZW5jZSB0byB0aGUg\nZGVzZXJpYWxpemVkIGRhdGEKICAgIHByaXZhdGUgdHJhbnNpZW50IENsYXNz\nTWV0YURhdGEgbWV0YTsKCiAgICBwcml2YXRlIGJvb2xlYW4gc2VyaWFsaXph\ndGlvblVzZXJWaXNpYmxlID0gdHJ1ZTsKCiAgICBwdWJsaWMgUmVmbGVjdGlu\nZ1BlcnNpc3RlbmNlQ2FwYWJsZShPYmplY3QgbywgT3BlbkpQQUNvbmZpZ3Vy\nYXRpb24gY29uZikgewogICAgICAgIHRoaXMubyA9IG87CiAgICAgICAgQ2xh\nc3MgdHlwZSA9IG8uZ2V0Q2xhc3MoKTsKICAgICAgICBwY1N1YmNsYXNzSW5z\ndGFuY2UgPSBQQ1JlZ2lzdHJ5Lm5ld0luc3RhbmNlKHR5cGUsIG51bGwsIGZh\nbHNlKTsKICAgICAgICBtZXRhID0gY29uZi5nZXRNZXRhRGF0YVJlcG9zaXRv\ncnlJbnN0YW5jZSgpCiAgICAgICAgICAgIC5nZXRNZXRhRGF0YSh0eXBlLCBu\ndWxsLCB0cnVlKTsKICAgIH0KCiAgICBwdWJsaWMgaW50IHBjR2V0RW5oYW5j\nZW1lbnRDb250cmFjdFZlcnNpb24oKSB7CiAgICAgICAgcmV0dXJuIFBDRW5o\nYW5jZXIuRU5IQU5DRVJfVkVSU0lPTjsKICAgIH0KCiAgICBwdWJsaWMgT2Jq\nZWN0IHBjR2V0R2VuZXJpY0NvbnRleHQoKSB7CiAgICAgICAgaWYgKHNtID09\nIG51bGwpCiAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgIGVsc2UK\nICAgICAgICAgICAgcmV0dXJuIHNtLmdldEdlbmVyaWNDb250ZXh0KCk7CiAg\nICB9CgogICAgcHVibGljIFN0YXRlTWFuYWdlciBwY0dldFN0YXRlTWFuYWdl\ncigpIHsKICAgICAgICByZXR1cm4gc207CiAgICB9CgogICAgcHVibGljIHZv\naWQgcGNSZXBsYWNlU3RhdGVNYW5hZ2VyKFN0YXRlTWFuYWdlciBzbSkgewog\nICAgICAgIHRoaXMuc20gPSBzbTsKICAgICAgICBpZiAobWV0YSA9PSBudWxs\nICYmIHNtIGluc3RhbmNlb2YgT3BlbkpQQVN0YXRlTWFuYWdlcikKICAgICAg\nICAgICAgbWV0YSA9ICgoT3BlbkpQQVN0YXRlTWFuYWdlcikgc20pLmdldE1l\ndGFEYXRhKCk7CiAgICB9CgogICAgcHVibGljIHZvaWQgcGNQcm92aWRlRmll\nbGQoaW50IGkpIHsKICAgICAgICBPYmplY3QgdmFsdWUgPSBnZXRWYWx1ZShp\nLCBvKTsKICAgICAgICBzd2l0Y2ggKG1ldGEuZ2V0RmllbGQoaSkuZ2V0VHlw\nZUNvZGUoKSkgewogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5CT09MRUFO\nOgogICAgICAgICAgICAgICAgc20ucHJvdmlkZWRCb29sZWFuRmllbGQodGhp\ncywgaSwgdmFsdWUgPT0gbnVsbCA/IGZhbHNlIDoKICAgICAgICAgICAgICAg\nICAgICAoKEJvb2xlYW4pIHZhbHVlKS5ib29sZWFuVmFsdWUoKSk7CiAgICAg\nICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMu\nQllURToKICAgICAgICAgICAgICAgIHNtLnByb3ZpZGVkQnl0ZUZpZWxkKHRo\naXMsIGksIHZhbHVlID09IG51bGwgPyAwIDoKICAgICAgICAgICAgICAgICAg\nICAoKEJ5dGUpIHZhbHVlKS5ieXRlVmFsdWUoKSk7CiAgICAgICAgICAgICAg\nICBicmVhazsKICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuQ0hBUjoKICAg\nICAgICAgICAgICAgIHNtLnByb3ZpZGVkQ2hhckZpZWxkKHRoaXMsIGksIHZh\nbHVlID09IG51bGwgPyAwIDoKICAgICAgICAgICAgICAgICAgICAoKENoYXJh\nY3RlcikgdmFsdWUpLmNoYXJWYWx1ZSgpKTsKICAgICAgICAgICAgICAgIGJy\nZWFrOwogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5ET1VCTEU6CiAgICAg\nICAgICAgICAgICBzbS5wcm92aWRlZERvdWJsZUZpZWxkKHRoaXMsIGksIHZh\nbHVlID09IG51bGwgPyAwIDoKICAgICAgICAgICAgICAgICAgICAoKERvdWJs\nZSkgdmFsdWUpLmRvdWJsZVZhbHVlKCkpOwogICAgICAgICAgICAgICAgYnJl\nYWs7CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLkZMT0FUOgogICAgICAg\nICAgICAgICAgc20ucHJvdmlkZWRGbG9hdEZpZWxkKHRoaXMsIGksIHZhbHVl\nID09IG51bGwgPyAwIDoKICAgICAgICAgICAgICAgICAgICAoKEZsb2F0KSB2\nYWx1ZSkuZmxvYXRWYWx1ZSgpKTsKICAgICAgICAgICAgICAgIGJyZWFrOwog\nICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5JTlQ6CiAgICAgICAgICAgICAg\nICBzbS5wcm92aWRlZEludEZpZWxkKHRoaXMsIGksIHZhbHVlID09IG51bGwg\nPyAwIDoKICAgICAgICAgICAgICAgICAgICAoKEludGVnZXIpIHZhbHVlKS5p\nbnRWYWx1ZSgpKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAg\nICBjYXNlIEphdmFUeXBlcy5MT05HOgogICAgICAgICAgICAgICAgc20ucHJv\ndmlkZWRMb25nRmllbGQodGhpcywgaSwgdmFsdWUgPT0gbnVsbCA/IDAgOgog\nICAgICAgICAgICAgICAgICAgICgoTG9uZykgdmFsdWUpLmxvbmdWYWx1ZSgp\nKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIEph\ndmFUeXBlcy5TSE9SVDoKICAgICAgICAgICAgICAgIHNtLnByb3ZpZGVkU2hv\ncnRGaWVsZCh0aGlzLCBpLCB2YWx1ZSA9PSBudWxsID8gMCA6CiAgICAgICAg\nICAgICAgICAgICAgKChTaG9ydCkgdmFsdWUpLnNob3J0VmFsdWUoKSk7CiAg\nICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSBKYXZhVHlw\nZXMuU1RSSU5HOgogICAgICAgICAgICAgICAgc20ucHJvdmlkZWRTdHJpbmdG\naWVsZCh0aGlzLCBpLCAoU3RyaW5nKSB2YWx1ZSk7CiAgICAgICAgICAgICAg\nICBicmVhazsKICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAg\nIHNtLnByb3ZpZGVkT2JqZWN0RmllbGQodGhpcywgaSwgdmFsdWUpOwogICAg\nICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgfQoKICAgIHB1Ymxp\nYyB2b2lkIHBjUHJvdmlkZUZpZWxkcyhpbnRbXSBmaWVsZEluZGljZXMpIHsK\nICAgICAgICBmb3IoaW50IGkgPSAwOyBpIDwgZmllbGRJbmRpY2VzLmxlbmd0\naDsgaSsrKQogICAgICAgICAgICBwY1Byb3ZpZGVGaWVsZChmaWVsZEluZGlj\nZXNbaV0pOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHBjUmVwbGFjZUZpZWxk\nKGludCBpKSB7CiAgICAgICAgc3dpdGNoKG1ldGEuZ2V0RmllbGQoaSkuZ2V0\nVHlwZUNvZGUoKSkgewogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5CT09M\nRUFOOgogICAgICAgICAgICAgICAgc2V0VmFsdWUoaSwgbywgQm9vbGVhbi52\nYWx1ZU9mKAogICAgICAgICAgICAgICAgICAgIHNtLnJlcGxhY2VCb29sZWFu\nRmllbGQodGhpcywgaSkpKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAg\nICAgICAgICBjYXNlIEphdmFUeXBlcy5CWVRFOgogICAgICAgICAgICAgICAg\nc2V0VmFsdWUoaSwgbywgbmV3IEJ5dGUoc20ucmVwbGFjZUJ5dGVGaWVsZCh0\naGlzLCBpKSkpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAg\nIGNhc2UgSmF2YVR5cGVzLkNIQVI6CiAgICAgICAgICAgICAgICBzZXRWYWx1\nZShpLCBvLCBuZXcgQ2hhcmFjdGVyKHNtLnJlcGxhY2VDaGFyRmllbGQodGhp\ncywgaSkpKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBj\nYXNlIEphdmFUeXBlcy5ET1VCTEU6CiAgICAgICAgICAgICAgICBzZXRWYWx1\nZShpLCBvLCBuZXcgRG91YmxlKHNtLnJlcGxhY2VEb3VibGVGaWVsZCh0aGlz\nLCBpKSkpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNh\nc2UgSmF2YVR5cGVzLkZMT0FUOgogICAgICAgICAgICAgICAgc2V0VmFsdWUo\naSwgbywgbmV3IEZsb2F0KHNtLnJlcGxhY2VGbG9hdEZpZWxkKHRoaXMsIGkp\nKSk7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSBK\nYXZhVHlwZXMuSU5UOgogICAgICAgICAgICAgICAgc2V0VmFsdWUoaSwgbywg\nbmV3IEludGVnZXIoc20ucmVwbGFjZUludEZpZWxkKHRoaXMsIGkpKSk7CiAg\nICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSBKYXZhVHlw\nZXMuTE9ORzoKICAgICAgICAgICAgICAgIHNldFZhbHVlKGksIG8sIG5ldyBM\nb25nKHNtLnJlcGxhY2VMb25nRmllbGQodGhpcywgaSkpKTsKICAgICAgICAg\nICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5TSE9S\nVDoKICAgICAgICAgICAgICAgIHNldFZhbHVlKGksIG8sIG5ldyBTaG9ydChz\nbS5yZXBsYWNlU2hvcnRGaWVsZCh0aGlzLCBpKSkpOwogICAgICAgICAgICAg\nICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLlNUUklORzoK\nICAgICAgICAgICAgICAgIHNldFZhbHVlKGksIG8sIHNtLnJlcGxhY2VTdHJp\nbmdGaWVsZCh0aGlzLCBpKSk7CiAgICAgICAgICAgICAgICBicmVhazsKICAg\nICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAgIHNldFZhbHVlKGks\nIG8sIHNtLnJlcGxhY2VPYmplY3RGaWVsZCh0aGlzLCBpKSk7CiAgICAgICAg\nICAgICAgICBicmVhazsKICAgICAgICB9CiAgICB9CgogICAgcHVibGljIHZv\naWQgcGNSZXBsYWNlRmllbGRzKGludFtdIGZpZWxkSW5kaWNlcykgewogICAg\nICAgIGZvcihpbnQgaSA9IDA7IGkgPCBmaWVsZEluZGljZXMubGVuZ3RoOyBp\nKyspCiAgICAgICAgICAgIHBjUmVwbGFjZUZpZWxkKGZpZWxkSW5kaWNlc1tp\nXSk7CiAgICB9CgogICAgcHVibGljIHZvaWQgcGNDb3B5RmllbGQoT2JqZWN0\nIGZyb21PYmplY3QsIGludCBpKSB7CiAgICAgICAgLy8gdGhpcyBkb2Vzbid0\nIG5lZWQgc3dpdGNoIHRyZWF0bWVudCBiZWNhdXNlIHdlJ3JlIGp1c3QKICAg\nICAgICAvLyByZWZsZWN0aW5nIG9uIGJvdGggc2lkZXMsIGJ5cGFzc2luZyBm\naWVsZCBtYW5hZ2Vycy4KICAgICAgICBzZXRWYWx1ZShpLCBvLCBnZXRWYWx1\nZShpLCBmcm9tT2JqZWN0KSk7CiAgICB9CgogICAgcHVibGljIHZvaWQgcGND\nb3B5RmllbGRzKE9iamVjdCBmcm9tT2JqZWN0LCBpbnRbXSBmaWVsZEluZGlj\nZXMpIHsKICAgICAgICBpZiAoZnJvbU9iamVjdCBpbnN0YW5jZW9mIFJlZmxl\nY3RpbmdQZXJzaXN0ZW5jZUNhcGFibGUpCiAgICAgICAgICAgIGZyb21PYmpl\nY3QgPSAoKFJlZmxlY3RpbmdQZXJzaXN0ZW5jZUNhcGFibGUpIGZyb21PYmpl\nY3QpCiAgICAgICAgICAgICAgICAuZ2V0TWFuYWdlZEluc3RhbmNlKCk7CiAg\nICAgICAgCiAgICAgICAgZm9yKGludCBpID0gMDsgaSA8IGZpZWxkSW5kaWNl\ncy5sZW5ndGg7IGkrKykKICAgICAgICAgICAgcGNDb3B5RmllbGQoZnJvbU9i\namVjdCwgZmllbGRJbmRpY2VzW2ldKTsKICAgIH0KCiAgICBwdWJsaWMgdm9p\nZCBwY0RpcnR5KFN0cmluZyBmaWVsZE5hbWUpIHsKICAgICAgICBpZiAoc20g\nIT0gbnVsbCkKICAgICAgICAgICAgc20uZGlydHkoZmllbGROYW1lKTsKICAg\nIH0KCiAgICBwdWJsaWMgT2JqZWN0IHBjRmV0Y2hPYmplY3RJZCgpIHsKICAg\nICAgICBpZiAoc20gIT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIHNtLmZl\ndGNoT2JqZWN0SWQoKTsKICAgICAgICBlbHNlCiAgICAgICAgICAgIHJldHVy\nbiBudWxsOwogICAgfQoKICAgIHB1YmxpYyBPYmplY3QgcGNHZXRWZXJzaW9u\nKCkgewogICAgICAgIGlmIChzbSA9PSBudWxsKQogICAgICAgICAgICByZXR1\ncm4gbnVsbDsKICAgICAgICBlbHNlCiAgICAgICAgICAgIHJldHVybiBzbS5n\nZXRWZXJzaW9uKCk7CiAgICB9CgogICAgcHVibGljIGJvb2xlYW4gcGNJc0Rp\ncnR5KCkgewogICAgICAgIGlmIChzbSA9PSBudWxsKQogICAgICAgICAgICBy\nZXR1cm4gZmFsc2U7CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIGlmIChz\nbSBpbnN0YW5jZW9mIFN0YXRlTWFuYWdlckltcGwpCiAgICAgICAgICAgICAg\nICAoKFN0YXRlTWFuYWdlckltcGwpIHNtKS5kaXJ0eUNoZWNrKCk7CiAgICAg\nICAgICAgIHJldHVybiBzbS5pc0RpcnR5KCk7CiAgICAgICAgfQogICAgfQoK\nICAgIHB1YmxpYyBib29sZWFuIHBjSXNUcmFuc2FjdGlvbmFsKCkgewogICAg\nICAgIGlmIChzbSA9PSBudWxsKQogICAgICAgICAgICByZXR1cm4gZmFsc2U7\nCiAgICAgICAgZWxzZQogICAgICAgICAgICByZXR1cm4gc20uaXNUcmFuc2Fj\ndGlvbmFsKCk7CiAgICB9CgogICAgcHVibGljIGJvb2xlYW4gcGNJc1BlcnNp\nc3RlbnQoKSB7CiAgICAgICAgaWYgKHNtID09IG51bGwpCiAgICAgICAgICAg\nIHJldHVybiBmYWxzZTsKICAgICAgICBlbHNlCiAgICAgICAgICAgIHJldHVy\nbiBzbS5pc1BlcnNpc3RlbnQoKTsKICAgIH0KCiAgICBwdWJsaWMgYm9vbGVh\nbiBwY0lzTmV3KCkgewogICAgICAgIGlmIChzbSA9PSBudWxsKQogICAgICAg\nICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgZWxzZQogICAgICAgICAgICBy\nZXR1cm4gc20uaXNOZXcoKTsKICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBw\nY0lzRGVsZXRlZCgpIHsKICAgICAgICBpZiAoc20gPT0gbnVsbCkKICAgICAg\nICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIGVsc2UKICAgICAgICAgICAg\ncmV0dXJuIHNtLmlzRGVsZXRlZCgpOwogICAgfQoKICAgIC8vIG51bGwgPT0g\ndW5rbm93bgogICAgcHVibGljIEJvb2xlYW4gcGNJc0RldGFjaGVkKCkgewog\nICAgICAgIGlmIChzbSAhPSBudWxsKQogICAgICAgICAgICByZXR1cm4gQm9v\nbGVhbi52YWx1ZU9mKHNtLmlzRGV0YWNoZWQoKSk7CgogICAgICAgIC8vICMj\nIyMjIHdlIGNvdWxkIGRvIGEgbG90IG1vcmUgaGVyZSBpZiBhIGRldGFjaGVk\nIHN0YXRlIGZpZWxkCiAgICAgICAgLy8gIyMjIyMgd2FzIHNwZWNpZmllZC4K\nICAgICAgICByZXR1cm4gbnVsbDsKICAgIH0KCiAgICBwdWJsaWMgUGVyc2lz\ndGVuY2VDYXBhYmxlIHBjTmV3SW5zdGFuY2UoU3RhdGVNYW5hZ2VyIHNtLCBi\nb29sZWFuIGNsZWFyKSB7CiAgICAgICAgcmV0dXJuIHBjU3ViY2xhc3NJbnN0\nYW5jZS5wY05ld0luc3RhbmNlKHNtLCBjbGVhcik7CiAgICB9CgogICAgcHVi\nbGljIFBlcnNpc3RlbmNlQ2FwYWJsZSBwY05ld0luc3RhbmNlKFN0YXRlTWFu\nYWdlciBzbSwgT2JqZWN0IG9pZCwKICAgICAgICBib29sZWFuIGNsZWFyKSB7\nCiAgICAgICAgcmV0dXJuIHBjU3ViY2xhc3NJbnN0YW5jZS5wY05ld0luc3Rh\nbmNlKHNtLCBvaWQsIGNsZWFyKTsKICAgIH0KCiAgICBwdWJsaWMgT2JqZWN0\nIHBjTmV3T2JqZWN0SWRJbnN0YW5jZSgpIHsKICAgICAgICBGaWVsZE1ldGFE\nYXRhW10gcGtGaWVsZHMgPSBtZXRhLmdldFByaW1hcnlLZXlGaWVsZHMoKTsK\nICAgICAgICBPYmplY3RbXSBwa3MgPSBuZXcgT2JqZWN0W3BrRmllbGRzLmxl\nbmd0aF07CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBwa0ZpZWxkcy5s\nZW5ndGg7IGkrKykKICAgICAgICAgICAgcGtzW2ldID0gZ2V0VmFsdWUocGtG\naWVsZHNbaV0uZ2V0SW5kZXgoKSwgbyk7CiAgICAgICAgcmV0dXJuIEFwcGxp\nY2F0aW9uSWRzLmZyb21QS1ZhbHVlcyhwa3MsIG1ldGEpOwogICAgfQogICAg\nCiAgICBwdWJsaWMgT2JqZWN0IHBjTmV3T2JqZWN0SWRJbnN0YW5jZShPYmpl\nY3Qgb2lkKSB7CiAgICAgICAgcmV0dXJuIHBjU3ViY2xhc3NJbnN0YW5jZS5w\nY05ld09iamVjdElkSW5zdGFuY2Uob2lkKTsKICAgIH0KCiAgICBwdWJsaWMg\ndm9pZCBwY0NvcHlLZXlGaWVsZHNUb09iamVjdElkKE9iamVjdCBvaWQpIHsK\nICAgICAgICBPYmplY3QgdGFyZ2V0OwogICAgICAgIGlmIChvaWQgaW5zdGFu\nY2VvZiBPYmplY3RJZCkKICAgICAgICAgICAgdGFyZ2V0ID0gKChPYmplY3RJ\nZCkgb2lkKS5nZXRJZCgpOwogICAgICAgIGVsc2UKICAgICAgICAgICAgdGFy\nZ2V0ID0gb2lkOwoKICAgICAgICBGaWVsZE1ldGFEYXRhW10gcGtzID0gbWV0\nYS5nZXRQcmltYXJ5S2V5RmllbGRzKCk7CiAgICAgICAgZm9yIChpbnQgaSA9\nIDA7IGkgPCBwa3MubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgT2JqZWN0\nIHZhbCA9IGdldFZhbHVlKHBrc1tpXS5nZXRJbmRleCgpLCBvKTsKICAgICAg\nICAgICAgRmllbGQgZiA9IFJlZmxlY3Rpb24uZmluZEZpZWxkKHRhcmdldC5n\nZXRDbGFzcygpLCBwa3NbaV0uZ2V0TmFtZSgpLAogICAgICAgICAgICAgICAg\ndHJ1ZSk7CiAgICAgICAgICAgIFJlZmxlY3Rpb24uc2V0KHRhcmdldCwgZiwg\ndmFsKTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGljIHZvaWQgcGNDb3B5\nS2V5RmllbGRzVG9PYmplY3RJZChGaWVsZFN1cHBsaWVyIHN1cHBsaWVyLCBP\nYmplY3Qgb2JqKSB7CiAgICAgICAgLy8gVGhpcyBpcyBvbmx5IGV2ZXIgaW52\nb2tlZCBhZ2FpbnN0IFBDcyBpbiB0aGUgUENSZWdpc3RyeS4gU3VjaCBQQ3MK\nICAgICAgICAvLyB3aWxsIGFsd2F5cyBiZSBlbmhhbmNlZCB0eXBlcyBvciBz\ndWJ0eXBlcyBvZiB1c2VyIHR5cGVzLCBhbmQgd2lsbAogICAgICAgIC8vIG5l\ndmVyIGJlIGEgUmVmbGVjdGluZ1BlcnNpc3RlbmNlQ2FwYWJsZS4KICAgICAg\nICB0aHJvdyBuZXcgSW50ZXJuYWxFeGNlcHRpb24oKTsKICAgIH0KCiAgICBw\ndWJsaWMgdm9pZCBwY0NvcHlLZXlGaWVsZHNGcm9tT2JqZWN0SWQoRmllbGRD\nb25zdW1lciBjb25zdW1lciwKICAgICAgICBPYmplY3Qgb2JqKSB7CiAgICAg\nICAgLy8gVGhpcyBpcyBvbmx5IGV2ZXIgaW52b2tlZCBhZ2FpbnN0IFBDcyBp\nbiB0aGUgUENSZWdpc3RyeS4gU3VjaCBQQ3MKICAgICAgICAvLyB3aWxsIGFs\nd2F5cyBiZSBlbmhhbmNlZCB0eXBlcyBvciBzdWJ0eXBlcyBvZiB1c2VyIHR5\ncGVzLCBhbmQgd2lsbAogICAgICAgIC8vIG5ldmVyIGJlIGEgUmVmbGVjdGlu\nZ1BlcnNpc3RlbmNlQ2FwYWJsZS4KICAgICAgICB0aHJvdyBuZXcgSW50ZXJu\nYWxFeGNlcHRpb24oKTsKICAgIH0KCiAgICBwdWJsaWMgT2JqZWN0IHBjR2V0\nRGV0YWNoZWRTdGF0ZSgpIHsKICAgICAgICAvLyAjIyMjIyB3ZSBjYW4gaW1w\nbGVtZW50IHRoaXMgaWYgYSBzdGF0ZSBmaWVsZCBoYXMgYmVlbiBzZXQKICAg\nICAgICByZXR1cm4gbnVsbDsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBwY1Nl\ndERldGFjaGVkU3RhdGUoT2JqZWN0IHN0YXRlKSB7CiAgICAgICAgLy8gU3Rh\ndGVNYW5hZ2VySW1wbCB3aWxsIGludm9rZSB0aGlzIHdpdGggbnVsbCBkdXJp\nbmcgaW5zdGFuY2UKICAgICAgICAvLyBpbml0aWFsaXphdGlvbgogICAgICAg\nIGlmIChzdGF0ZSAhPSBudWxsKQogICAgICAgICAgICB0aHJvdyBuZXcgVW5z\ndXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb24oKTsKICAgICAgICAvLyAjIyMj\nIyB3ZSBjYW4gaW1wbGVtZW50IHRoaXMgaWYgYSBzdGF0ZSBmaWVsZCBoYXMg\nYmVlbiBzZXQKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBwY1NldFNlcmlhbGl6\nYXRpb25Vc2VyVmlzaWJsZShib29sZWFuIHVzZXJWaXNpYmxlKSB7CiAgICAg\nICAgc2VyaWFsaXphdGlvblVzZXJWaXNpYmxlID0gdXNlclZpc2libGU7CiAg\nICB9CgogICAgcHVibGljIGJvb2xlYW4gcGNJc1NlcmlhbGl6YXRpb25Vc2Vy\nVmlzaWJsZSgpIHsKICAgICAgICByZXR1cm4gc2VyaWFsaXphdGlvblVzZXJW\naXNpYmxlOwogICAgfQoKICAgIHB1YmxpYyBPYmplY3QgZ2V0TWFuYWdlZElu\nc3RhbmNlKCkgewogICAgICAgIHJldHVybiBvOwogICAgfQoKICAgIHByaXZh\ndGUgT2JqZWN0IGdldFZhbHVlKGludCBpLCBPYmplY3QgbykgewogICAgICAg\nIGlmIChtZXRhLmdldEFjY2Vzc1R5cGUoKSA9PSBDbGFzc01ldGFEYXRhLkFD\nQ0VTU19QUk9QRVJUWSkgewogICAgICAgICAgICBGaWVsZCBmaWVsZCA9IFJl\nZmxlY3Rpb24uZmluZEZpZWxkKG1ldGEuZ2V0RGVzY3JpYmVkVHlwZSgpLAog\nICAgICAgICAgICAgICAgdG9GaWVsZE5hbWUoaSksIHRydWUpOwogICAgICAg\nICAgICByZXR1cm4gUmVmbGVjdGlvbi5nZXQobywgZmllbGQpOwogICAgICAg\nIH0gZWxzZSB7CiAgICAgICAgICAgIEZpZWxkIGZpZWxkID0gKEZpZWxkKSBt\nZXRhLmdldEZpZWxkKGkpLmdldEJhY2tpbmdNZW1iZXIoKTsKICAgICAgICAg\nICAgcmV0dXJuIFJlZmxlY3Rpb24uZ2V0KG8sIGZpZWxkKTsKICAgICAgICB9\nCiAgICB9CgogICAgcHJpdmF0ZSBTdHJpbmcgdG9GaWVsZE5hbWUoaW50IGkp\nIHsKICAgICAgICBpZiAocGNTdWJjbGFzc0luc3RhbmNlIGluc3RhbmNlb2Yg\nQXR0cmlidXRlVHJhbnNsYXRvcikKICAgICAgICAgICAgcmV0dXJuICgoQXR0\ncmlidXRlVHJhbnNsYXRvcikgcGNTdWJjbGFzc0luc3RhbmNlKQogICAgICAg\nICAgICAgICAgLnBjQXR0cmlidXRlSW5kZXhUb0ZpZWxkTmFtZShpKTsKICAg\nICAgICBlbHNlCiAgICAgICAgICAgIHJldHVybiBtZXRhLmdldEZpZWxkKGkp\nLmdldE5hbWUoKTsKICAgIH0KCiAgICBwcml2YXRlIHZvaWQgc2V0VmFsdWUo\naW50IGksIE9iamVjdCBvLCBPYmplY3QgdmFsKSB7CiAgICAgICAgaWYgKG1l\ndGEuZ2V0QWNjZXNzVHlwZSgpID09IENsYXNzTWV0YURhdGEuQUNDRVNTX1BS\nT1BFUlRZKSB7CiAgICAgICAgICAgIGlmICghbWV0YS5pc0ludGVyY2VwdGlu\nZygpKSB7CiAgICAgICAgICAgICAgICBNZXRob2QgbWV0aCA9IFJlZmxlY3Rp\nb24uZmluZFNldHRlcihtZXRhLmdldERlc2NyaWJlZFR5cGUoKSwKICAgICAg\nICAgICAgICAgICAgICBtZXRhLmdldEZpZWxkKGkpLmdldE5hbWUoKSwgdHJ1\nZSk7CiAgICAgICAgICAgICAgICBSZWZsZWN0aW9uLnNldChvLCBtZXRoLCB2\nYWwpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgRmll\nbGQgZmllbGQgPSBSZWZsZWN0aW9uLmZpbmRGaWVsZChtZXRhLmdldERlc2Ny\naWJlZFR5cGUoKSwKICAgICAgICAgICAgICAgICAgICB0b0ZpZWxkTmFtZShp\nKSwgdHJ1ZSk7CiAgICAgICAgICAgICAgICBSZWZsZWN0aW9uLnNldChvLCBm\naWVsZCwgdmFsKTsKICAgICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAg\nICAgICAgICAgIEZpZWxkIGZpZWxkID0gKEZpZWxkKSBtZXRhLmdldEZpZWxk\nKGkpLmdldEJhY2tpbmdNZW1iZXIoKTsKICAgICAgICAgICAgUmVmbGVjdGlv\nbi5zZXQobywgZmllbGQsIHZhbCk7CiAgICAgICAgfQogICAgfQoKICAgIHBy\naXZhdGUgdm9pZCB3cml0ZU9iamVjdChPYmplY3RPdXRwdXRTdHJlYW0gb3V0\nKSB0aHJvd3MgSU9FeGNlcHRpb24gewogICAgICAgIG91dC5kZWZhdWx0V3Jp\ndGVPYmplY3QoKTsKICAgICAgICBvdXQud3JpdGVPYmplY3QobWV0YS5nZXRE\nZXNjcmliZWRUeXBlKCkpOwogICAgfQoKICAgIHByaXZhdGUgdm9pZCByZWFk\nT2JqZWN0KE9iamVjdElucHV0U3RyZWFtIGluKQogICAgICAgIHRocm93cyBD\nbGFzc05vdEZvdW5kRXhjZXB0aW9uLCBJT0V4Y2VwdGlvbiB7CiAgICAgICAg\naW4uZGVmYXVsdFJlYWRPYmplY3QoKTsKICAgICAgICBDbGFzcyB0eXBlID0g\nKENsYXNzKSBpbi5yZWFkT2JqZWN0KCk7CiAgICAgICAgcGNTdWJjbGFzc0lu\nc3RhbmNlID0gUENSZWdpc3RyeS5uZXdJbnN0YW5jZSh0eXBlLCBudWxsLCBm\nYWxzZSk7CiAgICAgICAgSW1wbEhlbHBlci5yZWdpc3RlclBlcnNpc3RlbmNl\nQ2FwYWJsZSh0aGlzKTsKICAgIH0KfQo=\n","encoding":"base64"}

