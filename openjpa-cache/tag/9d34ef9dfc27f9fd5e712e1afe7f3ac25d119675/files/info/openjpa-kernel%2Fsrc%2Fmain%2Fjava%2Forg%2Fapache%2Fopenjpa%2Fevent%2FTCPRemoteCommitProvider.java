{"sha":"079d80239f3b1dc8179ae77eaff57ce13703d992","node_id":"MDQ6QmxvYjIwNjM2NDowNzlkODAyMzlmM2IxZGM4MTc5YWU3N2VhZmY1N2NlMTM3MDNkOTky","size":34575,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/079d80239f3b1dc8179ae77eaff57ce13703d992","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuZXZlbnQ7CgppbXBvcnQgamF2\nYS5pby5CdWZmZXJlZElucHV0U3RyZWFtOwppbXBvcnQgamF2YS5pby5CeXRl\nQXJyYXlPdXRwdXRTdHJlYW07CmltcG9ydCBqYXZhLmlvLkVPRkV4Y2VwdGlv\nbjsKaW1wb3J0IGphdmEuaW8uSU9FeGNlcHRpb247CmltcG9ydCBqYXZhLmlv\nLklucHV0U3RyZWFtOwppbXBvcnQgamF2YS5pby5PYmplY3RJbnB1dFN0cmVh\nbTsKaW1wb3J0IGphdmEuaW8uT2JqZWN0T3V0cHV0U3RyZWFtOwppbXBvcnQg\namF2YS5pby5PdXRwdXRTdHJlYW07CmltcG9ydCBqYXZhLm5ldC5JbmV0QWRk\ncmVzczsKaW1wb3J0IGphdmEubmV0LlNlcnZlclNvY2tldDsKaW1wb3J0IGph\ndmEubmV0LlNvY2tldDsKaW1wb3J0IGphdmEubmV0LlNvY2tldEV4Y2VwdGlv\nbjsKaW1wb3J0IGphdmEubmV0LlVua25vd25Ib3N0RXhjZXB0aW9uOwppbXBv\ncnQgamF2YS5zZWN1cml0eS5BY2Nlc3NDb250cm9sbGVyOwppbXBvcnQgamF2\nYS5zZWN1cml0eS5Qcml2aWxlZ2VkQWN0aW9uRXhjZXB0aW9uOwppbXBvcnQg\namF2YS51dGlsLkFycmF5TGlzdDsKaW1wb3J0IGphdmEudXRpbC5BcnJheXM7\nCmltcG9ydCBqYXZhLnV0aWwuSGFzaE1hcDsKaW1wb3J0IGphdmEudXRpbC5I\nYXNoU2V0OwppbXBvcnQgamF2YS51dGlsLkl0ZXJhdG9yOwppbXBvcnQgamF2\nYS51dGlsLkxpbmtlZExpc3Q7CmltcG9ydCBqYXZhLnV0aWwuTWFwOwppbXBv\ncnQgamF2YS51dGlsLlNldDsKaW1wb3J0IGphdmEudXRpbC5MaXN0OwppbXBv\ncnQgamF2YS51dGlsLkNvbGxlY3Rpb25zOwoKaW1wb3J0IG9yZy5hcGFjaGUu\nY29tbW9ucy5wb29sLlBvb2xhYmxlT2JqZWN0RmFjdG9yeTsKaW1wb3J0IG9y\nZy5hcGFjaGUuY29tbW9ucy5wb29sLmltcGwuR2VuZXJpY09iamVjdFBvb2w7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLmNvbmYuQ29uZmlndXJh\nYmxlOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi5sb2cuTG9nOwpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51dGlsLkoyRG9Qcml2SGVs\ncGVyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51dGlsLkxvY2Fs\naXplcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLkdlbmVyYWxF\neGNlcHRpb247CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5JbnRl\ncm5hbEV4Y2VwdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGls\nLlNlcmlhbGl6YXRpb247CmltcG9ydCBqYXZhLnV0aWwuY29uY3VycmVudC5s\nb2Nrcy5SZWVudHJhbnRMb2NrOwoKaW1wb3J0IHNlcnAudXRpbC5TdHJpbmdz\nOwoKLyoqCiAqIFRDUC1iYXNlZCBpbXBsZW1lbnRhdGlvbiBvZiB7QGxpbmsg\nUmVtb3RlQ29tbWl0UHJvdmlkZXJ9IHRoYXQKICogbGlzdGVucyBmb3Igb2Jq\nZWN0IG1vZGlmaWNhdGlvbnMgYW5kIHByb3BhZ2F0ZXMgdGhvc2UgY2hhbmdl\ncyB0bwogKiBvdGhlciBSZW1vdGVDb21taXRQcm92aWRlcnMgb3ZlciBUQ1Ag\nc29ja2V0cy4KICoKICogQGF1dGhvciBCcmlhbiBMZWFpcgogKiBAYXV0aG9y\nIFBhdHJpY2sgTGluc2tleQogKiBAc2luY2UgMC4yLjUuMAogKi8KcHVibGlj\nIGNsYXNzIFRDUFJlbW90ZUNvbW1pdFByb3ZpZGVyCiAgICBleHRlbmRzIEFi\nc3RyYWN0UmVtb3RlQ29tbWl0UHJvdmlkZXIKICAgIGltcGxlbWVudHMgQ29u\nZmlndXJhYmxlIHsKCiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBpbnQgREVG\nQVVMVF9QT1JUID0gNTYzNjsKCiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBM\nb2NhbGl6ZXIgc19sb2MgPSBMb2NhbGl6ZXIuZm9yUGFja2FnZQogICAgICAg\nIChUQ1BSZW1vdGVDb21taXRQcm92aWRlci5jbGFzcyk7CiAgICBwcml2YXRl\nIHN0YXRpYyBsb25nIHNfaWRTZXF1ZW5jZSA9IFN5c3RlbS5jdXJyZW50VGlt\nZU1pbGxpcygpOwoKICAgIC8vCUEgbWFwIG9mIGxpc3RlbiBwb3J0cyB0byBs\naXN0ZW5lcnMgaW4gdGhpcyBKVk0uIFdlIG1pZ2h0CiAgICAvLwl3YW50IHRv\nIGxvb2sgaW50byBhbGxvd2luZyBzYW1lIHBvcnQsIGRpZmZlcmVudCBpbnRl\ncmZhY2UgLS0KICAgIC8vCXRoYXQgaXMgbm90IGN1cnJlbnRseSBwb3NzaWJs\nZSBpbiBhIHNpbmdsZSBKVk0uCiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBN\nYXAgc19wb3J0TGlzdGVuZXJNYXAgPSBuZXcgSGFzaE1hcCgpOwoKICAgIHBy\naXZhdGUgbG9uZyBfaWQ7CiAgICBwcml2YXRlIGJ5dGVbXSBfbG9jYWxob3N0\nOwogICAgcHJpdmF0ZSBpbnQgX3BvcnQgPSBERUZBVUxUX1BPUlQ7CiAgICBw\ncml2YXRlIGludCBfbWF4QWN0aXZlID0gMjsKICAgIHByaXZhdGUgaW50IF9t\nYXhJZGxlID0gMjsKICAgIHByaXZhdGUgaW50IF9yZWNvdmVyeVRpbWVNaWxs\naXMgPSAxNTAwMDsKICAgIHByaXZhdGUgVENQUG9ydExpc3RlbmVyIF9saXN0\nZW5lcjsKICAgIHByaXZhdGUgQnJvYWRjYXN0UXVldWUgX2Jyb2FkY2FzdFF1\nZXVlID0gbmV3IEJyb2FkY2FzdFF1ZXVlKCk7CiAgICBwcml2YXRlIGZpbmFs\nIExpc3QgX2Jyb2FkY2FzdFRocmVhZHMgPSBDb2xsZWN0aW9ucy5zeW5jaHJv\nbml6ZWRMaXN0KAogICAgICAgIG5ldyBMaW5rZWRMaXN0KCkpOwoKICAgIHBy\naXZhdGUgQXJyYXlMaXN0IF9hZGRyZXNzZXMgPSBuZXcgQXJyYXlMaXN0KCk7\nCiAgICBwcml2YXRlIFJlZW50cmFudExvY2sgX2FkZHJlc3Nlc0xvY2s7Cgog\nICAgcHVibGljIFRDUFJlbW90ZUNvbW1pdFByb3ZpZGVyKCkKICAgICAgICB0\naHJvd3MgVW5rbm93bkhvc3RFeGNlcHRpb24gewogICAgICAgIC8vIG9idGFp\nbiBhIHVuaXF1ZSBJRC4KICAgICAgICBzeW5jaHJvbml6ZWQgKFRDUFJlbW90\nZUNvbW1pdFByb3ZpZGVyLmNsYXNzKSB7CiAgICAgICAgICAgIF9pZCA9IHNf\naWRTZXF1ZW5jZSsrOwogICAgICAgIH0KCiAgICAgICAgLy8gY2FjaGUgdGhl\nIGxvY2FsIElQIGFkZHJlc3MuCiAgICAgICAgX2xvY2FsaG9zdCA9IEluZXRB\nZGRyZXNzLmdldExvY2FsSG9zdCgpLmdldEFkZHJlc3MoKTsKICAgICAgICBf\nYWRkcmVzc2VzTG9jayA9IG5ldyBSZWVudHJhbnRMb2NrKCk7CiAgICAgICAg\nc2V0TnVtQnJvYWRjYXN0VGhyZWFkcygyKTsKICAgIH0KCiAgICAvKioKICAg\nICAqIFRoZSBwb3J0IHRoYXQgdGhpcyBwcm92aWRlciBzaG91bGQgbGlzdGVu\nIG9uLgogICAgICovCiAgICBwdWJsaWMgaW50IGdldFBvcnQoKSB7CiAgICAg\nICAgcmV0dXJuIF9wb3J0OwogICAgfQoKICAgIC8qKgogICAgICogVGhlIHBv\ncnQgdGhhdCB0aGlzIHByb3ZpZGVyIHNob3VsZCBsaXN0ZW4gb24uIFNldCBv\nbmNlIG9ubHkuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldFBvcnQoaW50\nIHBvcnQpIHsKICAgICAgICBfcG9ydCA9IHBvcnQ7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBUaGUgbnVtYmVyIG9mIG1pbGxpc2Vjb25kcyB0byB3YWl0IGJl\nZm9yZSByZXRyeWluZwogICAgICogdG8gcmVjb25uZWN0IHRvIGEgcGVlciBh\nZnRlciBpdCBiZWNvbWVzIHVucmVhY2hhYmxlLgogICAgICovCiAgICBwdWJs\naWMgdm9pZCBzZXRSZWNvdmVyeVRpbWVNaWxsaXMoaW50IHJlY292ZXJ5dGlt\nZSkgewogICAgICAgIF9yZWNvdmVyeVRpbWVNaWxsaXMgPSByZWNvdmVyeXRp\nbWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBUaGUgbnVtYmVyIG9mIG1pbGxp\nc2Vjb25kcyB0byB3YWl0IGJlZm9yZSByZXRyeWluZwogICAgICogdG8gcmVj\nb25uZWN0IHRvIGEgcGVlciBhZnRlciBpdCBiZWNvbWVzIHVucmVhY2hhYmxl\nLgogICAgICovCiAgICBwdWJsaWMgaW50IGdldFJlY292ZXJ5VGltZU1pbGxp\ncygpIHsKICAgICAgICByZXR1cm4gX3JlY292ZXJ5VGltZU1pbGxpczsKICAg\nIH0KCiAgICAvKioKICAgICAqIFRoZSBtYXhpbXVtIG51bWJlciBvZiBzb2Nr\nZXRzIHRoYXQgdGhpcyBwcm92aWRlciBjYW4KICAgICAqIHNpbWV0YW5lb3Vz\nbHkgb3BlbiB0byBlYWNoIHBlZXIgaW4gdGhlIGNsdXN0ZXIuCiAgICAgKi8K\nICAgIHB1YmxpYyB2b2lkIHNldE1heEFjdGl2ZShpbnQgbWF4QWN0aXZlKSB7\nCiAgICAgICAgX21heEFjdGl2ZSA9IG1heEFjdGl2ZTsKICAgIH0KCiAgICAv\nKioKICAgICAqIFRoZSBtYXhpbXVtIG51bWJlciBvZiBzb2NrZXRzIHRoYXQg\ndGhpcyBwcm92aWRlciBjYW4KICAgICAqIHNpbWV0YW5lb3VzbHkgb3BlbiB0\nbyBlYWNoIHBlZXIgaW4gdGhlIGNsdXN0ZXIuCiAgICAgKi8KICAgIHB1Ymxp\nYyBpbnQgZ2V0TWF4QWN0aXZlKCkgewogICAgICAgIHJldHVybiBfbWF4QWN0\naXZlOwogICAgfQoKICAgIC8qKgogICAgICogVGhlIG51bWJlciBvZiBpZGxl\nIHNvY2tldHMgdGhhdCB0aGlzIHByb3ZpZGVyIGNhbiBrZWVwIG9wZW4KICAg\nICAqIHRvIGVhY2ggcGVlciBpbiB0aGUgY2x1c3Rlci4KICAgICAqLwogICAg\ncHVibGljIHZvaWQgc2V0TWF4SWRsZShpbnQgbWF4SWRsZSkgewogICAgICAg\nIF9tYXhJZGxlID0gbWF4SWRsZTsKICAgIH0KCiAgICAvKioKICAgICAqIFRo\nZSBudW1iZXIgb2YgaWRsZSBzb2NrZXRzIHRoYXQgdGhpcyBwcm92aWRlciBj\nYW4ga2VlcCBvcGVuCiAgICAgKiB0byBlYWNoIHBlZXIgaW4gdGhlIGNsdXN0\nZXIuCiAgICAgKi8KICAgIHB1YmxpYyBpbnQgZ2V0TWF4SWRsZSgpIHsKICAg\nICAgICByZXR1cm4gX21heElkbGU7CiAgICB9CgogICAgLyoqCiAgICAgKiBU\naGUgbnVtYmVyIG9mIHdvcmtlciB0aHJlYWRzIHRoYXQgYXJlIHVzZWQgZm9y\nCiAgICAgKiB0cmFuc21pdHRpbmcgcGFja2V0cyB0byBwZWVycyBpbiB0aGUg\nY2x1c3Rlci4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0TnVtQnJvYWRj\nYXN0VGhyZWFkcyhpbnQgbnVtQnJvYWRjYXN0VGhyZWFkcykgewogICAgICAg\nIHN5bmNocm9uaXplZCAoX2Jyb2FkY2FzdFRocmVhZHMpIHsKICAgICAgICAg\nICAgaW50IGN1ciA9IF9icm9hZGNhc3RUaHJlYWRzLnNpemUoKTsKICAgICAg\nICAgICAgaWYgKGN1ciA+IG51bUJyb2FkY2FzdFRocmVhZHMpIHsKICAgICAg\nICAgICAgICAgIC8vIE5vdGlmeSB0aGUgZXh0cmEgd29ya2VyIHRocmVhZHMg\nc28gdGhleSBzdG9wIHRoZW1zZWx2ZXMKICAgICAgICAgICAgICAgIC8vIFRo\ncmVhZHMgd2lsbCBub3QgZW5kIHVudGlsIHRoZXkgc2VuZCBhbm90aGVyIHBr\nLgogICAgICAgICAgICAgICAgZm9yIChpbnQgaSA9IG51bUJyb2FkY2FzdFRo\ncmVhZHM7IGkgPCBjdXI7IGkrKykgewogICAgICAgICAgICAgICAgICAgIEJy\nb2FkY2FzdFdvcmtlclRocmVhZCB3b3JrZXIgPSAoQnJvYWRjYXN0V29ya2Vy\nVGhyZWFkKQogICAgICAgICAgICAgICAgICAgICAgICBfYnJvYWRjYXN0VGhy\nZWFkcy5yZW1vdmUoMCk7CiAgICAgICAgICAgICAgICAgICAgd29ya2VyLnNl\ndFJ1bm5pbmcoZmFsc2UpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAg\nICB9IGVsc2UgaWYgKGN1ciA8IG51bUJyb2FkY2FzdFRocmVhZHMpIHsKICAg\nICAgICAgICAgICAgIC8vIENyZWF0ZSBhZGRpdGlvbmFsIHdvcmtlciB0aHJl\nYWRzCiAgICAgICAgICAgICAgICBmb3IgKGludCBpID0gY3VyOyBpIDwgbnVt\nQnJvYWRjYXN0VGhyZWFkczsgaSsrKSB7CiAgICAgICAgICAgICAgICAgICAg\nQnJvYWRjYXN0V29ya2VyVGhyZWFkIHd0ID0gbmV3IEJyb2FkY2FzdFdvcmtl\nclRocmVhZCgpOwogICAgICAgICAgICAgICAgICAgIHd0LnNldERhZW1vbih0\ncnVlKTsKICAgICAgICAgICAgICAgICAgICB3dC5zdGFydCgpOwogICAgICAg\nICAgICAgICAgICAgIF9icm9hZGNhc3RUaHJlYWRzLmFkZCh3dCk7CiAgICAg\nICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBUaGUgbnVtYmVyIG9mIHdvcmtlciB0aHJlYWRzIHRo\nYXQgYXJlIHVzZWQgZm9yCiAgICAgKiB0cmFuc21pdHRpbmcgcGFja2V0cyB0\nbyBwZWVycyBpbiB0aGUgY2x1c3Rlci4KICAgICAqLwogICAgcHVibGljIGlu\ndCBnZXROdW1Ccm9hZGNhc3RUaHJlYWRzKCkgewogICAgICAgIHJldHVybiBf\nYnJvYWRjYXN0VGhyZWFkcy5zaXplKCk7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBTZXRzIHRoZSBsaXN0IG9mIGFkZHJlc3NlcyBvZiBwZWVycyB0byB3aGlj\naCB0aGlzIHByb3ZpZGVyIHdpbGwKICAgICAqIHNlbmQgZXZlbnRzIHRvLiBU\naGUgcGVlcnMgYXJlIHNlbWljb2xvbi1zZXBhcmF0ZWQgPGNvZGU+bmFtZXM8\nL2NvZGU+CiAgICAgKiBsaXN0IGluIHRoZSBmb3JtIG9mICJteWhvc3QxOnBv\ncnRBO215aG9zdDI6cG9ydEIiLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBz\nZXRBZGRyZXNzZXMoU3RyaW5nIG5hbWVzKQogICAgICAgIHRocm93cyBVbmtu\nb3duSG9zdEV4Y2VwdGlvbiB7CiAgICAgICAgLy8gTllJLiBDb3VsZCBsb29r\nIGZvciBlcXVpdmFsZW5jZSBvZiBhZGRyZXNzZXMgYW5kIGF2b2lkCiAgICAg\nICAgLy8gY2hhbmdpbmcgdGhvc2UgdGhhdCBkaWRuJ3QgY2hhbmdlLgoKICAg\nICAgICBfYWRkcmVzc2VzTG9jay5sb2NrKCk7CiAgICAgICAgdHJ5IHsKICAg\nICAgICAgICAgZm9yIChJdGVyYXRvciBpdGVyID0gX2FkZHJlc3Nlcy5pdGVy\nYXRvcigpOyBpdGVyLmhhc05leHQoKTspIHsKICAgICAgICAgICAgICAgICgo\nSG9zdEFkZHJlc3MpIGl0ZXIubmV4dCgpKS5jbG9zZSgpOwogICAgICAgICAg\nICB9CiAgICAgICAgICAgIFN0cmluZ1tdIHRva3MgPSBTdHJpbmdzLnNwbGl0\nKG5hbWVzLCAiOyIsIDApOwogICAgICAgICAgICBfYWRkcmVzc2VzID0gbmV3\nIEFycmF5TGlzdCh0b2tzLmxlbmd0aCk7CgogICAgICAgICAgICBJbmV0QWRk\ncmVzcyBsb2NhbGhvc3QgPSBJbmV0QWRkcmVzcy5nZXRMb2NhbEhvc3QoKTsK\nICAgICAgICAgICAgU3RyaW5nIGxvY2FsaG9zdE5hbWUgPSBsb2NhbGhvc3Qu\nZ2V0SG9zdE5hbWUoKTsKCiAgICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBp\nIDwgdG9rcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgU3RyaW5n\nIGhvc3QgPSB0b2tzW2ldOwogICAgICAgICAgICAgICAgU3RyaW5nIGhvc3Ru\nYW1lOwogICAgICAgICAgICAgICAgaW50IHRtcFBvcnQ7CiAgICAgICAgICAg\nICAgICBpbnQgY29sb24gPSBob3N0LmluZGV4T2YoJzonKTsKICAgICAgICAg\nICAgICAgIGlmIChjb2xvbiAhPSAtMSkgewogICAgICAgICAgICAgICAgICAg\nIGhvc3RuYW1lID0gaG9zdC5zdWJzdHJpbmcoMCwgY29sb24pOwogICAgICAg\nICAgICAgICAgICAgIHRtcFBvcnQgPSBJbnRlZ2VyLnBhcnNlSW50KGhvc3Qu\nc3Vic3RyaW5nKGNvbG9uICsgMSkpOwogICAgICAgICAgICAgICAgfSBlbHNl\nIHsKICAgICAgICAgICAgICAgICAgICBob3N0bmFtZSA9IGhvc3Q7CiAgICAg\nICAgICAgICAgICAgICAgdG1wUG9ydCA9IERFRkFVTFRfUE9SVDsKICAgICAg\nICAgICAgICAgIH0KICAgICAgICAgICAgICAgIEluZXRBZGRyZXNzIHRtcEFk\nZHJlc3MgPSAoSW5ldEFkZHJlc3MpIEFjY2Vzc0NvbnRyb2xsZXIKICAgICAg\nICAgICAgICAgICAgICAuZG9Qcml2aWxlZ2VkKEoyRG9Qcml2SGVscGVyLmdl\ndEJ5TmFtZUFjdGlvbihob3N0bmFtZSkpOyAKCiAgICAgICAgICAgICAgICAv\nLyBibGVhaXI6IEZvciBlYWNoIGFkZHJlc3Mgd2Ugd291bGQgcmF0aGVyIG1h\na2UgdXNlIG9mCiAgICAgICAgICAgICAgICAvLyB0aGUgamRrMS40IGlzTGlu\na0xvY2FsQWRkcmVzcyAoKSB8fCBpc0xvb3BiYWNrQWRkcmVzcyAoKS4KICAg\nICAgICAgICAgICAgIC8vIChUaG91Z2ggaW4gcHJhY3RpY2Ugb24gd2luMzIg\ndGhleSBkb24ndCB3b3JrIGFueXdheXMhKQogICAgICAgICAgICAgICAgLy8g\nSW5zdGVhZCB3ZSB3aWxsIGNoZWNrIGhvc3RuYW1lLiBOb3QgcGVyZmVjdCwg\nYnV0CiAgICAgICAgICAgICAgICAvLyBpdCB3aWxsIG1hdGNoIG9mdGVuIGVu\nb3VnaCAocGVvcGxlIHdpbGwgdHlwaWNhbGx5CiAgICAgICAgICAgICAgICAv\nLyB1c2UgdGhlIEROUyBtYWNoaW5lIG5hbWVzIGFuZCBiZSBjdXR0aW5nL3Bh\nc3RpbmcuKQogICAgICAgICAgICAgICAgaWYgKGxvY2FsaG9zdE5hbWUuZXF1\nYWxzKGhvc3RuYW1lKSkgewogICAgICAgICAgICAgICAgICAgIC8vIFRoaXMg\nc3RyaW5nIG1hdGNoZXMgdGhlIGhvc3RuYW1lIGZvciBmb3Igb3Vyc2VsdmVz\nLCB3ZQogICAgICAgICAgICAgICAgICAgIC8vIGRvbid0IGFjdHVhbGx5IG5l\nZWQgdG8gc2VuZCBvdXJzZWx2ZXMgbWVzc2FnZXMuCiAgICAgICAgICAgICAg\nICAgICAgaWYgKGxvZy5pc1RyYWNlRW5hYmxlZCgpKSB7CiAgICAgICAgICAg\nICAgICAgICAgICAgIGxvZy50cmFjZShzX2xvYy5nZXQoInRjcC1hZGRyZXNz\nLWFzc2VsZiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0bXBBZGRy\nZXNzLmdldEhvc3ROYW1lKCkgKyAiOiIgKyB0bXBQb3J0KSk7CiAgICAgICAg\nICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAg\nICAgICAgICAgICAgICBIb3N0QWRkcmVzcyBuZXdBZGRyZXNzID0gbmV3IEhv\nc3RBZGRyZXNzKGhvc3QpOwogICAgICAgICAgICAgICAgICAgIF9hZGRyZXNz\nZXMuYWRkKG5ld0FkZHJlc3MpOwogICAgICAgICAgICAgICAgICAgIGlmIChs\nb2cuaXNUcmFjZUVuYWJsZWQoKSkgewogICAgICAgICAgICAgICAgICAgICAg\nICBsb2cudHJhY2Uoc19sb2MuZ2V0KCJ0Y3AtYWRkcmVzcy1zZXQiLAogICAg\nICAgICAgICAgICAgICAgICAgICAgICAgbmV3QWRkcmVzcy5fYWRkcmVzcy5n\nZXRIb3N0TmFtZSgpICsgIjoiCiAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgKyBuZXdBZGRyZXNzLl9wb3J0KSk7CiAgICAgICAgICAgICAgICAg\nICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAg\nfSBjYXRjaCAoUHJpdmlsZWdlZEFjdGlvbkV4Y2VwdGlvbiBwYWUpIHsKICAg\nICAgICAgICAgdGhyb3cgKFVua25vd25Ib3N0RXhjZXB0aW9uKSBwYWUuZ2V0\nRXhjZXB0aW9uKCk7CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAg\nX2FkZHJlc3Nlc0xvY2sudW5sb2NrKCk7CiAgICAgICAgfQogICAgfQoKICAg\nIC8vIC0tLS0tLS0tLS0gQ29uZmlndXJhYmxlIGltcGxlbWVudGF0aW9uIC0t\nLS0tLS0tLS0KCiAgICAvKioKICAgICAqIFN1YmNsYXNzZXMgdGhhdCBuZWVk\nIHRvIHBlcmZvcm0gYWN0aW9ucyBpbgogICAgICoge0BsaW5rIENvbmZpZ3Vy\nYWJsZSNlbmRDb25maWd1cmF0aW9ufSBtdXN0IGludm9rZSB0aGlzIG1ldGhv\nZC4KICAgICAqLwogICAgcHVibGljIHZvaWQgZW5kQ29uZmlndXJhdGlvbigp\nIHsKICAgICAgICBzdXBlci5lbmRDb25maWd1cmF0aW9uKCk7CiAgICAgICAg\nc3luY2hyb25pemVkIChzX3BvcnRMaXN0ZW5lck1hcCkgewogICAgICAgICAg\nICAvLyBzZWUgaWYgYSBsaXN0ZW5lciBleGlzdHMgZm9yIHRoaXMgcG9ydC4K\nICAgICAgICAgICAgX2xpc3RlbmVyID0gKFRDUFBvcnRMaXN0ZW5lcikgc19w\nb3J0TGlzdGVuZXJNYXAuZ2V0CiAgICAgICAgICAgICAgICAoU3RyaW5nLnZh\nbHVlT2YoX3BvcnQpKTsKCiAgICAgICAgICAgIGlmIChfbGlzdGVuZXIgPT0g\nbnVsbCB8fAogICAgICAgICAgICAgICAgKCFfbGlzdGVuZXIuaXNSdW5uaW5n\nKCkgJiYgX2xpc3RlbmVyLl9wb3J0ID09IF9wb3J0KSkgewogICAgICAgICAg\nICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICBfbGlzdGVuZXIgPSBu\nZXcgVENQUG9ydExpc3RlbmVyKF9wb3J0LCBsb2cpOwogICAgICAgICAgICAg\nICAgICAgIF9saXN0ZW5lci5saXN0ZW4oKTsKICAgICAgICAgICAgICAgICAg\nICBzX3BvcnRMaXN0ZW5lck1hcC5wdXQoU3RyaW5nLnZhbHVlT2YoX3BvcnQp\nLCBfbGlzdGVuZXIpOwogICAgICAgICAgICAgICAgfSBjYXRjaCAoRXhjZXB0\naW9uIGUpIHsKICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgR2VuZXJh\nbEV4Y2VwdGlvbihzX2xvYy5nZXQoInRjcC1pbml0LWV4Y2VwdGlvbiIsCiAg\nICAgICAgICAgICAgICAgICAgICAgIFN0cmluZy52YWx1ZU9mKF9wb3J0KSks\nIGUpLnNldEZhdGFsKHRydWUpOwogICAgICAgICAgICAgICAgfQogICAgICAg\nICAgICB9IGVsc2UgaWYgKF9saXN0ZW5lci5pc1J1bm5pbmcoKSkgewogICAg\nICAgICAgICAgICAgaWYgKF9saXN0ZW5lci5fcG9ydCAhPSBfcG9ydCkgewog\nICAgICAgICAgICAgICAgICAgIC8vIHRoaXMgcmVhbGx5IHNob3VsZG4ndCBi\nZSBhYmxlIHRvIGhhcHBlbi4KICAgICAgICAgICAgICAgICAgICB0aHJvdyBu\nZXcgR2VuZXJhbEV4Y2VwdGlvbihzX2xvYy5nZXQKICAgICAgICAgICAgICAg\nICAgICAgICAgKCJ0Y3Atbm90LWVxdWFsIiwgU3RyaW5nLnZhbHVlT2YoX3Bv\ncnQpKSkuCiAgICAgICAgICAgICAgICAgICAgICAgIHNldEZhdGFsKHRydWUp\nOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGVsc2UKICAgICAg\nICAgICAgICAgIHRocm93IG5ldyBJbnRlcm5hbEV4Y2VwdGlvbihzX2xvYy5n\nZXQoInRjcC1saXN0ZW5lci1icm9rZW4iKSk7CiAgICAgICAgICAgIF9saXN0\nZW5lci5hZGRQcm92aWRlcih0aGlzKTsKICAgICAgICB9CgogICAgICAgIF9h\nZGRyZXNzZXNMb2NrLmxvY2soKTsKICAgICAgICB0cnkgewogICAgICAgICAg\nICBIb3N0QWRkcmVzcyBjdXJBZGRyZXNzOwogICAgICAgICAgICBmb3IgKEl0\nZXJhdG9yIGl0ZXIgPSBfYWRkcmVzc2VzLml0ZXJhdG9yKCk7CiAgICAgICAg\nICAgICAgICBpdGVyLmhhc05leHQoKTspIHsKICAgICAgICAgICAgICAgIGN1\nckFkZHJlc3MgPSAoSG9zdEFkZHJlc3MpIGl0ZXIubmV4dCgpOwogICAgICAg\nICAgICAgICAgY3VyQWRkcmVzcy5zZXRNYXhBY3RpdmUoX21heEFjdGl2ZSk7\nCiAgICAgICAgICAgICAgICBjdXJBZGRyZXNzLnNldE1heElkbGUoX21heElk\nbGUpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGZpbmFsbHkg\newogICAgICAgICAgICBfYWRkcmVzc2VzTG9jay51bmxvY2soKTsKICAgICAg\nICB9CiAgICB9CgogICAgLy8gLS0tLS0tLS0tLSBSZW1vdGVDb21taXRQcm92\naWRlciBpbXBsZW1lbnRhdGlvbiAtLS0tLS0tLS0tCgogICAgLy8gcHJlIDMu\nMy40CT0gPG5vIHZlcnNpb24gbnVtYmVyIHRyYW5zbWl0dGVkPgogICAgLy8g\nMy4zIFByZXZpZXcgCT0gMHgxNDI4YWNmZDsKICAgIC8vIDMuNCAJCQk9IDB4\nMTQyOGFjZmY7CiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBsb25nIFBST1RP\nQ09MX1ZFUlNJT04gPSAweDE0MjhhY2ZmOwoKICAgIHB1YmxpYyB2b2lkIGJy\nb2FkY2FzdChSZW1vdGVDb21taXRFdmVudCBldmVudCkgewogICAgICAgIHRy\neSB7CiAgICAgICAgICAgIC8vIGJ1aWxkIGEgcGFja2V0IG5vdGlmeWluZyBv\ndGhlciBKVk1zIG9mIG9iamVjdCBjaGFuZ2VzLgogICAgICAgICAgICBCeXRl\nQXJyYXlPdXRwdXRTdHJlYW0gYmFvcyA9IG5ldyBCeXRlQXJyYXlPdXRwdXRT\ndHJlYW0oKTsKICAgICAgICAgICAgT2JqZWN0T3V0cHV0U3RyZWFtIG9vcyA9\nIG5ldyBPYmplY3RPdXRwdXRTdHJlYW0oYmFvcyk7CgogICAgICAgICAgICBv\nb3Mud3JpdGVMb25nKFBST1RPQ09MX1ZFUlNJT04pOwogICAgICAgICAgICBv\nb3Mud3JpdGVMb25nKF9pZCk7CiAgICAgICAgICAgIG9vcy53cml0ZUludChf\ncG9ydCk7CiAgICAgICAgICAgIG9vcy53cml0ZU9iamVjdChfbG9jYWxob3N0\nKTsKICAgICAgICAgICAgb29zLndyaXRlT2JqZWN0KGV2ZW50KTsKICAgICAg\nICAgICAgb29zLmZsdXNoKCk7CgogICAgICAgICAgICBieXRlW10gYnl0ZXMg\nPSBiYW9zLnRvQnl0ZUFycmF5KCk7CiAgICAgICAgICAgIGJhb3MuY2xvc2Uo\nKTsKICAgICAgICAgICAgaWYgKF9icm9hZGNhc3RUaHJlYWRzLmlzRW1wdHko\nKSkKICAgICAgICAgICAgICAgIHNlbmRVcGRhdGVQYWNrZXQoYnl0ZXMpOwog\nICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICBfYnJvYWRjYXN0UXVl\ndWUuYWRkUGFja2V0KGJ5dGVzKTsKICAgICAgICB9IGNhdGNoIChJT0V4Y2Vw\ndGlvbiBpb2UpIHsKICAgICAgICAgICAgaWYgKGxvZy5pc1dhcm5FbmFibGVk\nKCkpCiAgICAgICAgICAgICAgICBsb2cud2FybihzX2xvYy5nZXQoInRjcC1w\nYXlsb2FkLWNyZWF0ZS1lcnJvciIpLCBpb2UpOwogICAgICAgIH0KICAgIH0K\nCiAgICAvKioKICAgICAqIFNlbmRzIGEgY2hhbmdlIG5vdGlmaWNhdGlvbiBw\nYWNrZXQgdG8gb3RoZXIgbWFjaGluZXMgaW4gdGhpcwogICAgICogcHJvdmlk\nZXIgY2x1c3Rlci4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIHNlbmRVcGRh\ndGVQYWNrZXQoYnl0ZVtdIGJ5dGVzKSB7CiAgICAgICAgX2FkZHJlc3Nlc0xv\nY2subG9jaygpOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIGZvciAoSXRl\ncmF0b3IgaXRlciA9IF9hZGRyZXNzZXMuaXRlcmF0b3IoKTsgaXRlci5oYXNO\nZXh0KCk7KQogICAgICAgICAgICAgICAgKChIb3N0QWRkcmVzcykgaXRlci5u\nZXh0KCkpLnNlbmRVcGRhdGVQYWNrZXQoYnl0ZXMpOwogICAgICAgIH0gZmlu\nYWxseSB7CiAgICAgICAgICAgIF9hZGRyZXNzZXNMb2NrLnVubG9jaygpOwog\nICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMgdm9pZCBjbG9zZSgpIHsKICAg\nICAgICBpZiAoX2xpc3RlbmVyICE9IG51bGwpCiAgICAgICAgICAgIF9saXN0\nZW5lci5yZW1vdmVQcm92aWRlcih0aGlzKTsKCiAgICAgICAgLy8gUmVtb3Zl\nIEJyb2FkY2FzdCBUaHJlYWRzIHRoZW4gY2xvc2Ugc29ja2V0cy4KICAgICAg\nICBfYnJvYWRjYXN0UXVldWUuY2xvc2UoKTsKCiAgICAgICAgLy8gV2FpdCBm\nb3IgX2Jyb2FkY2FzdFRocmVhZHMgdG8gZ2V0IGNsZWFuZWQgdXAuCiAgICAg\nICAgd2hpbGUoIV9icm9hZGNhc3RUaHJlYWRzLmlzRW1wdHkoKSkgewogICAg\nICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgVGhyZWFkLnNsZWVwKDUw\nMCk7CiAgICAgICAgICAgIH0gY2F0Y2ggKEludGVycnVwdGVkRXhjZXB0aW9u\nIGllKSB7CiAgICAgICAgICAgICAgICAvLyBJZ25vcmUuCiAgICAgICAgICAg\nIH0KICAgICAgICB9CiAgICAgICAgCiAgICAgICAgX2FkZHJlc3Nlc0xvY2su\nbG9jaygpOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIGZvciAoSXRlcmF0\nb3IgaXRlciA9IF9hZGRyZXNzZXMuaXRlcmF0b3IoKTsgaXRlci5oYXNOZXh0\nKCk7KQogICAgICAgICAgICAgICAgKChIb3N0QWRkcmVzcykgaXRlci5uZXh0\nKCkpLmNsb3NlKCk7CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAg\nX2FkZHJlc3Nlc0xvY2sudW5sb2NrKCk7CiAgICAgICAgfQogICAgfQoKICAg\nIC8qKgogICAgICogVXRpbGl0eSBjbGFzcyB0byBob2xkIG1lc3NhZ2VzIHRv\nIGJlIHNlbnQuIFRoaXMKICAgICAqIGFsbG93cyBjYWxscyB0byBicm9hZGNh\nc3QgKCkgdG8gcmV0dXJuIHdpdGhvdXQKICAgICAqIHdhaXRpbmcgZm9yIHRo\nZSBzZW5kIHRvIGNvbXBsZXRlLgogICAgICovCiAgICBwcml2YXRlIHN0YXRp\nYyBjbGFzcyBCcm9hZGNhc3RRdWV1ZSB7CgogICAgICAgIHByaXZhdGUgTGlu\na2VkTGlzdCBfcGFja2V0UXVldWUgPSBuZXcgTGlua2VkTGlzdCgpOwogICAg\nICAgIHByaXZhdGUgYm9vbGVhbiBfY2xvc2VkID0gZmFsc2U7CgogICAgICAg\nIHB1YmxpYyBzeW5jaHJvbml6ZWQgdm9pZCBjbG9zZSgpIHsKICAgICAgICAg\nICAgX2Nsb3NlZCA9IHRydWU7CiAgICAgICAgICAgIG5vdGlmeUFsbCgpOwog\nICAgICAgIH0KCiAgICAgICAgcHVibGljIHN5bmNocm9uaXplZCBib29sZWFu\nIGlzQ2xvc2VkKCkgewogICAgICAgICAgICByZXR1cm4gX2Nsb3NlZDsKICAg\nICAgICB9CgogICAgICAgIHB1YmxpYyBzeW5jaHJvbml6ZWQgdm9pZCBhZGRQ\nYWNrZXQoYnl0ZVtdIGJ5dGVzKSB7CiAgICAgICAgICAgIF9wYWNrZXRRdWV1\nZS5hZGRMYXN0KGJ5dGVzKTsKICAgICAgICAgICAgbm90aWZ5KCk7CiAgICAg\nICAgfQoKICAgICAgICAvKioKICAgICAgICAgKiBAcmV0dXJuIHRoZSBieXRl\ncyBkZWZpbmluZyB0aGUgcGFja2V0IHRvIHByb2Nlc3MsIG9yCiAgICAgICAg\nICogPGNvZGU+bnVsbDwvY29kZT4gaWYgdGhlIHF1ZXVlIGlzIGVtcHR5Lgog\nICAgICAgICAqLwogICAgICAgIHB1YmxpYyBzeW5jaHJvbml6ZWQgYnl0ZVtd\nIHJlbW92ZVBhY2tldCgpCiAgICAgICAgICAgIHRocm93cyBJbnRlcnJ1cHRl\nZEV4Y2VwdGlvbiB7CiAgICAgICAgICAgIC8vIG9ubHkgd2FpdCBpZiB0aGUg\ncXVldWUgaXMgc3RpbGwgb3Blbi4gVGhpcyBhbGxvd3MgcHJvY2Vzc2luZwog\nICAgICAgICAgICAvLyBvZiBldmVudHMgaW4gdGhlIHF1ZXVlIHRvIGNvbnRp\nbnVlLCB3aGlsZSBhdm9pZGluZyBzbGVlcGluZwogICAgICAgICAgICAvLyBk\ndXJpbmcgc2h1dGRvd24uCiAgICAgICAgICAgIHdoaWxlICghX2Nsb3NlZCAm\nJiBfcGFja2V0UXVldWUuaXNFbXB0eSgpKQogICAgICAgICAgICAgICAgd2Fp\ndCgpOwogICAgICAgICAgICBpZiAoX3BhY2tldFF1ZXVlLmlzRW1wdHkoKSkK\nICAgICAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgICAgICBlbHNl\nCiAgICAgICAgICAgICAgICByZXR1cm4gKGJ5dGVbXSkgX3BhY2tldFF1ZXVl\nLnJlbW92ZUZpcnN0KCk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAg\nICogVGhyZWFkcyB0byBicm9hZGNhc3QgcGFja2V0cyBwbGFjZWQgaW4gdGhl\nIHtAbGluayBCcm9hZGNhc3RRdWV1ZX0uCiAgICAgKi8KICAgIHByaXZhdGUg\nY2xhc3MgQnJvYWRjYXN0V29ya2VyVGhyZWFkCiAgICAgICAgZXh0ZW5kcyBU\naHJlYWQgewoKICAgICAgICBwcml2YXRlIGJvb2xlYW4gX2tlZXBSdW5uaW5n\nID0gdHJ1ZTsKCiAgICAgICAgcHVibGljIHZvaWQgcnVuKCkgewogICAgICAg\nICAgICB3aGlsZSAoX2tlZXBSdW5uaW5nKSB7CiAgICAgICAgICAgICAgICB0\ncnkgewogICAgICAgICAgICAgICAgICAgIC8vIFRoaXMgd2lsbCBibG9jayB1\nbnRpbCB0aGVyZSBpcyBhIHBhY2tldCB0byBzZW5kLCBvcgogICAgICAgICAg\nICAgICAgICAgIC8vIHVudGlsIHRoZSBxdWV1ZSBpcyBjbG9zZWQuCiAgICAg\nICAgICAgICAgICAgICAgYnl0ZVtdIGJ5dGVzID0gX2Jyb2FkY2FzdFF1ZXVl\nLnJlbW92ZVBhY2tldCgpOwogICAgICAgICAgICAgICAgICAgIGlmIChieXRl\ncyAhPSBudWxsKQogICAgICAgICAgICAgICAgICAgICAgICBzZW5kVXBkYXRl\nUGFja2V0KGJ5dGVzKTsKICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChf\nYnJvYWRjYXN0UXVldWUuaXNDbG9zZWQoKSkKICAgICAgICAgICAgICAgICAg\nICAgICAgX2tlZXBSdW5uaW5nID0gZmFsc2U7CiAgICAgICAgICAgICAgICB9\nIGNhdGNoIChJbnRlcnJ1cHRlZEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAg\nICAgICAgICAgLy8gRW5kIHRoZSB0aHJlYWQuCiAgICAgICAgICAgICAgICAg\nICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAg\nICAgICAgICAgcmVtb3ZlKCk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMg\ndm9pZCBzZXRSdW5uaW5nKGJvb2xlYW4ga2VlcFJ1bm5pbmcpIHsKICAgICAg\nICAgICAgX2tlZXBSdW5uaW5nID0ga2VlcFJ1bm5pbmc7CiAgICAgICAgfQog\nICAgICAgIAogICAgICAgIHByaXZhdGUgdm9pZCByZW1vdmUoKSB7CiAgICAg\nICAgICAgIF9icm9hZGNhc3RUaHJlYWRzLnJlbW92ZSh0aGlzKTsKICAgICAg\nICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXNwb25zaWJsZSBmb3IgbGlz\ndGVuaW5nIGZvciBpbmNvbWluZyBwYWNrZXRzIGFuZCBwcm9jZXNzaW5nIHRo\nZW0uCiAgICAgKi8KICAgIHByaXZhdGUgc3RhdGljIGNsYXNzIFRDUFBvcnRM\naXN0ZW5lcgogICAgICAgIGltcGxlbWVudHMgUnVubmFibGUgewoKICAgICAg\nICBwcml2YXRlIGZpbmFsIExvZyBfbG9nOwogICAgICAgIHByaXZhdGUgU2Vy\ndmVyU29ja2V0IF9yZWNlaXZlU29ja2V0OwogICAgICAgIHByaXZhdGUgVGhy\nZWFkIF9hY2NlcHRUaHJlYWQ7CiAgICAgICAgcHJpdmF0ZSBTZXQgX3JlY2Vp\ndmVyVGhyZWFkcyA9IG5ldyBIYXNoU2V0KCk7CiAgICAgICAgcHJpdmF0ZSBm\naW5hbCBTZXQgX3Byb3ZpZGVycyA9IG5ldyBIYXNoU2V0KCk7CgogICAgICAg\nIC8qKgogICAgICAgICAqIENhY2hlIHRoZSBsb2NhbCBJUCBhZGRyZXNzCiAg\nICAgICAgICovCiAgICAgICAgcHJpdmF0ZSBieXRlW10gX2xvY2FsaG9zdDsK\nCiAgICAgICAgLyoqCiAgICAgICAgICogVGhlIHBvcnQgdGhhdCB0aGlzIGxp\nc3RlbmVyIHNob3VsZCBsaXN0ZW4gb24uIENvbmZpZ3VyZWQKICAgICAgICAg\nKiBieSBUQ1BSZW1vdGVDb21taXRQcm92aWRlci4KICAgICAgICAgKi8KICAg\nICAgICBwcml2YXRlIGludCBfcG9ydDsKCiAgICAgICAgLyoqCiAgICAgICAg\nICogU2hvdWxkIGJlIHNldCB0byA8Y29kZT50cnVlPC9jb2RlPiBvbmNlIHRo\nZSBsaXN0ZW5lciBpcyBsaXN0ZW5pbmcuCiAgICAgICAgICovCiAgICAgICAg\ncHJpdmF0ZSBib29sZWFuIF9pc1J1bm5pbmcgPSBmYWxzZTsKCiAgICAgICAg\nLyoqCiAgICAgICAgICogQ29uc3RydWN0IGEgbmV3IFRDUFBvcnRMaXN0ZW5l\nciBjb25maWd1cmVkIHRvIHVzZSB0aGUgc3BlY2lmaWVkIHBvcnQuCiAgICAg\nICAgICovCiAgICAgICAgcHJpdmF0ZSBUQ1BQb3J0TGlzdGVuZXIoaW50IHBv\ncnQsIExvZyBsb2cpCiAgICAgICAgICAgIHRocm93cyBJT0V4Y2VwdGlvbiB7\nCiAgICAgICAgICAgIF9wb3J0ID0gcG9ydDsKICAgICAgICAgICAgX2xvZyA9\nIGxvZzsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIF9yZWNl\naXZlU29ja2V0ID0gKFNlcnZlclNvY2tldCkgQWNjZXNzQ29udHJvbGxlcgog\nICAgICAgICAgICAgICAgICAgIC5kb1ByaXZpbGVnZWQoSjJEb1ByaXZIZWxw\nZXIubmV3U2VydmVyU29ja2V0QWN0aW9uKF9wb3J0KSk7CiAgICAgICAgICAg\nIH0gY2F0Y2ggKFByaXZpbGVnZWRBY3Rpb25FeGNlcHRpb24gcGFlKSB7CiAg\nICAgICAgICAgICAgICB0aHJvdyAoSU9FeGNlcHRpb24pIHBhZS5nZXRFeGNl\ncHRpb24oKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBfbG9jYWxob3N0\nID0gSW5ldEFkZHJlc3MuZ2V0TG9jYWxIb3N0KCkuZ2V0QWRkcmVzcygpOwoK\nICAgICAgICAgICAgaWYgKF9sb2cuaXNUcmFjZUVuYWJsZWQoKSkKICAgICAg\nICAgICAgICAgIF9sb2cuaW5mbyhzX2xvYy5nZXQoInRjcC1zdGFydC1saXN0\nZW5lciIsCiAgICAgICAgICAgICAgICAgICAgU3RyaW5nLnZhbHVlT2YoX3Bv\ncnQpKSk7CiAgICAgICAgfQoKICAgICAgICBwcml2YXRlIHZvaWQgbGlzdGVu\nKCkgewogICAgICAgICAgICBfYWNjZXB0VGhyZWFkID0gbmV3IFRocmVhZCh0\naGlzKTsKICAgICAgICAgICAgX2FjY2VwdFRocmVhZC5zZXREYWVtb24odHJ1\nZSk7CiAgICAgICAgICAgIF9hY2NlcHRUaHJlYWQuc3RhcnQoKTsKICAgICAg\nICB9CgogICAgICAgIC8qKgogICAgICAgICAqIEFsbCBwcm92aWRlcnMgYWRk\nZWQgaGVyZSB3aWxsIGJlIG5vdGlmaWVkIG9mIGFueSBpbmNvbWluZwogICAg\nICAgICAqIHByb3ZpZGVyIG1lc3NhZ2VzLiBUaGVyZSB3aWxsIGJlIG9uZSBv\nZiB0aGVzZSBwZXIKICAgICAgICAgKiBCcm9rZXJGYWN0b3J5IGluIGEgZ2l2\nZW4gSlZNLgogICAgICAgICAqIHtAbGluayBUQ1BSZW1vdGVDb21taXRQcm92\naWRlciNlbmRDb25maWd1cmF0aW9ufSBpbnZva2VzCiAgICAgICAgICogPGNv\nZGU+YWRkUHJvdmlkZXI8L2NvZGU+IHdpdGggPGNvZGU+dGhpczwvY29kZT4g\ndXBvbgogICAgICAgICAqIGNvbXBsZXRpb24gb2YgY29uZmlndXJhdGlvbi4K\nICAgICAgICAgKi8KICAgICAgICBwcml2YXRlIHZvaWQgYWRkUHJvdmlkZXIo\nVENQUmVtb3RlQ29tbWl0UHJvdmlkZXIgcHJvdmlkZXIpIHsKICAgICAgICAg\nICAgc3luY2hyb25pemVkIChfcHJvdmlkZXJzKSB7CiAgICAgICAgICAgICAg\nICBfcHJvdmlkZXJzLmFkZChwcm92aWRlcik7CiAgICAgICAgICAgIH0KICAg\nICAgICB9CgogICAgICAgIC8qKgogICAgICAgICAqIFJlbW92ZSBhIHByb3Zp\nZGVyIGZyb20gdGhlIGxpc3Qgb2YgcHJvdmlkZXJzIHRvIG5vdGlmeSBvZgog\nICAgICAgICAqIGNvbW1pdCBldmVudHMuCiAgICAgICAgICovCiAgICAgICAg\ncHJpdmF0ZSBzeW5jaHJvbml6ZWQgdm9pZCByZW1vdmVQcm92aWRlcgogICAg\nICAgICAgICAoVENQUmVtb3RlQ29tbWl0UHJvdmlkZXIgcHJvdmlkZXIpIHsK\nICAgICAgICAgICAgc3luY2hyb25pemVkIChfcHJvdmlkZXJzKSB7CiAgICAg\nICAgICAgICAgICBfcHJvdmlkZXJzLnJlbW92ZShwcm92aWRlcik7CgogICAg\nICAgICAgICAgICAgLy8gaWYgdGhlIHByb3ZpZGVyIGxpc3QgaXMgZW1wdHks\nIHNodXQgZG93biB0aGUgdGhyZWFkLgogICAgICAgICAgICAgICAgaWYgKF9w\ncm92aWRlcnMuc2l6ZSgpID09IDApIHsKICAgICAgICAgICAgICAgICAgICBf\naXNSdW5uaW5nID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgdHJ5IHsK\nICAgICAgICAgICAgICAgICAgICAgICAgX3JlY2VpdmVTb2NrZXQuY2xvc2Uo\nKTsKICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChJT0V4Y2VwdGlvbiBp\nb2UpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKF9sb2cuaXNXYXJu\nRW5hYmxlZCgpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgX2xvZy53\nYXJuKHNfbG9jLmdldCgidGNwLWNsb3NlLWVycm9yIiksIGlvZSk7CiAgICAg\nICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIF9hY2NlcHRU\naHJlYWQuaW50ZXJydXB0KCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAg\nICAgIH0KICAgICAgICB9CgogICAgICAgIHByaXZhdGUgYm9vbGVhbiBpc1J1\nbm5pbmcoKSB7CiAgICAgICAgICAgIHN5bmNocm9uaXplZCAoX3Byb3ZpZGVy\ncykgewogICAgICAgICAgICAgICAgcmV0dXJuIF9pc1J1bm5pbmc7CiAgICAg\nICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHB1YmxpYyB2b2lkIHJ1bigp\nIHsKICAgICAgICAgICAgc3luY2hyb25pemVkIChfcHJvdmlkZXJzKSB7CiAg\nICAgICAgICAgICAgICBfaXNSdW5uaW5nID0gdHJ1ZTsKICAgICAgICAgICAg\nfQoKICAgICAgICAgICAgU29ja2V0IHMgPSBudWxsOwogICAgICAgICAgICB3\naGlsZSAoX2lzUnVubmluZykgewogICAgICAgICAgICAgICAgdHJ5IHsKICAg\nICAgICAgICAgICAgICAgICBzID0gbnVsbDsKICAgICAgICAgICAgICAgICAg\nICAvLyBCbG9jaywgd2FpdGluZyB0byBhY2NlcHQgbmV3IGNvbm5lY3Rpb24g\nZnJvbSBhIHBlZXIKICAgICAgICAgICAgICAgICAgICBzID0gKFNvY2tldCkg\nQWNjZXNzQ29udHJvbGxlci5kb1ByaXZpbGVnZWQoSjJEb1ByaXZIZWxwZXIK\nICAgICAgICAgICAgICAgICAgICAgICAgLmFjY2VwdEFjdGlvbihfcmVjZWl2\nZVNvY2tldCkpOwogICAgICAgICAgICAgICAgICAgIGlmIChfbG9nLmlzVHJh\nY2VFbmFibGVkKCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgX2xvZy50\ncmFjZShzX2xvYy5nZXQoInRjcC1yZWNlaXZlZC1jb25uZWN0aW9uIiwKICAg\nICAgICAgICAgICAgICAgICAgICAgICAgIHMuZ2V0SW5ldEFkZHJlc3MoKS5n\nZXRIb3N0QWRkcmVzcygpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgKyAiOiIgKyBzLmdldFBvcnQoKSkpOwogICAgICAgICAgICAgICAgICAg\nIH0KICAgICAgICAgICAgICAgICAgICBSZWNlaXZlU29ja2V0SGFuZGxlciBz\naCA9IG5ldyBSZWNlaXZlU29ja2V0SGFuZGxlcihzKTsKICAgICAgICAgICAg\nICAgICAgICBUaHJlYWQgcmVjZWl2ZXJUaHJlYWQgPSBuZXcgVGhyZWFkKHNo\nKTsKICAgICAgICAgICAgICAgICAgICByZWNlaXZlclRocmVhZC5zZXREYWVt\nb24odHJ1ZSk7CiAgICAgICAgICAgICAgICAgICAgcmVjZWl2ZXJUaHJlYWQu\nc3RhcnQoKTsKICAgICAgICAgICAgICAgICAgICBfcmVjZWl2ZXJUaHJlYWRz\nLmFkZChyZWNlaXZlclRocmVhZCk7CiAgICAgICAgICAgICAgICB9IGNhdGNo\nIChFeGNlcHRpb24gZSkgewogICAgICAgICAgICAgICAgICAgIGlmIChlIGlu\nc3RhbmNlb2YgUHJpdmlsZWdlZEFjdGlvbkV4Y2VwdGlvbikKICAgICAgICAg\nICAgICAgICAgICAgICAgZSA9ICgoUHJpdmlsZWdlZEFjdGlvbkV4Y2VwdGlv\nbikgZSkuZ2V0RXhjZXB0aW9uKCk7CiAgICAgICAgICAgICAgICAgICAgaWYg\nKCEoZSBpbnN0YW5jZW9mIFNvY2tldEV4Y2VwdGlvbikgfHwgX2lzUnVubmlu\nZykKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKF9sb2cuaXNXYXJuRW5h\nYmxlZCgpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgX2xvZy53YXJu\nKHNfbG9jLmdldCgidGNwLWFjY2VwdC1lcnJvciIpLCBlKTsKCiAgICAgICAg\nICAgICAgICAgICAgLy8gTm9taW5hbCBjYXNlIChJbnRlcnJ1cHRlZEV4Y2Vw\ndGlvbikgYmVjYXVzZSBjbG9zZSAoKQogICAgICAgICAgICAgICAgICAgIC8v\nIGNhbGxzIF9hY2NlcHRUaHJlYWQuaW50ZXJydXB0ICgpOwogICAgICAgICAg\nICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChz\nICE9IG51bGwpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzLmNsb3Nl\nKCk7CiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGVl\nKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChfbG9nLmlzV2FybkVu\nYWJsZWQoKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9sb2cud2Fy\nbihzX2xvYy5nZXQoInRjcC1jbG9zZS1lcnJvciIpLCBlKTsKICAgICAgICAg\nICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0K\nCiAgICAgICAgICAgIC8vIFdlIGFyZSBkb25lIGxpc3RlbmluZy4gSW50ZXJy\ndXB0IGFueSB3b3JrZXIgdGhyZWFkcy4KICAgICAgICAgICAgVGhyZWFkIHdv\ncmtlcjsKICAgICAgICAgICAgZm9yIChJdGVyYXRvciBpdGVyID0gX3JlY2Vp\ndmVyVGhyZWFkcy5pdGVyYXRvcigpOwogICAgICAgICAgICAgICAgaXRlci5o\nYXNOZXh0KCk7KSB7CiAgICAgICAgICAgICAgICB3b3JrZXIgPSAoVGhyZWFk\nKSBpdGVyLm5leHQoKTsKICAgICAgICAgICAgICAgIC8vIEZZSSwgdGhlIHdv\ncmtlciB0aHJlYWRzIGFyZSBibG9ja2VkCiAgICAgICAgICAgICAgICAvLyBy\nZWFkaW5nIGZyb20gdGhlIHNvY2tldCdzIElucHV0U3RyZWFtLiBJbnB1dFN0\ncmVhbXMKICAgICAgICAgICAgICAgIC8vIGFyZW4ndCBpbnRlcnJ1cHRhYmxl\nLCBzbyB0aGlzIGludGVycnVwdCBpc24ndAogICAgICAgICAgICAgICAgLy8g\ncmVhbGx5IGdvaW5nIHRvIGJlIGRlbGl2ZXJlZCB1bnRpbCBzb21ldGhpbmcg\nYnJlYWtzCiAgICAgICAgICAgICAgICAvLyB0aGUgSW5wdXRTdHJlYW0uCiAg\nICAgICAgICAgICAgICB3b3JrZXIuaW50ZXJydXB0KCk7CiAgICAgICAgICAg\nIH0KICAgICAgICAgICAgc3luY2hyb25pemVkIChfcHJvdmlkZXJzKSB7CiAg\nICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgIGlmIChf\naXNSdW5uaW5nKQogICAgICAgICAgICAgICAgICAgICAgICBfcmVjZWl2ZVNv\nY2tldC5jbG9zZSgpOwogICAgICAgICAgICAgICAgfSBjYXRjaCAoRXhjZXB0\naW9uIGUpIHsKICAgICAgICAgICAgICAgICAgICBpZiAoX2xvZy5pc1dhcm5F\nbmFibGVkKCkpCiAgICAgICAgICAgICAgICAgICAgICAgIF9sb2cud2Fybihz\nX2xvYy5nZXQoInRjcC1jbG9zZS1lcnJvciIpLCBlKTsKICAgICAgICAgICAg\nICAgIH0KICAgICAgICAgICAgICAgIF9pc1J1bm5pbmcgPSBmYWxzZTsKICAg\nICAgICAgICAgICAgIGlmIChfbG9nLmlzVHJhY2VFbmFibGVkKCkpCiAgICAg\nICAgICAgICAgICAgICAgX2xvZy50cmFjZShzX2xvYy5nZXQoInRjcC1jbG9z\nZS1saXN0ZW5lciIsCiAgICAgICAgICAgICAgICAgICAgICAgIF9wb3J0ICsg\nIiIpKTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgLyoqCiAg\nICAgICAgICogVXRpbGl0eSBjbGFzcyB0aGF0IGFjdHMgYXMgYSB3b3JrZXIg\ndGhyZWFkIHRvIHJlY2VpdmUgRXZlbnRzCiAgICAgICAgICogZnJvbSBicm9h\nZGNhc3RlcnMuCiAgICAgICAgICovCiAgICAgICAgcHJpdmF0ZSBjbGFzcyBS\nZWNlaXZlU29ja2V0SGFuZGxlcgogICAgICAgICAgICBpbXBsZW1lbnRzIFJ1\nbm5hYmxlIHsKCiAgICAgICAgICAgIHByaXZhdGUgSW5wdXRTdHJlYW0gX2lu\nOwogICAgICAgICAgICBwcml2YXRlIFNvY2tldCBfczsKCiAgICAgICAgICAg\nIHByaXZhdGUgUmVjZWl2ZVNvY2tldEhhbmRsZXIoU29ja2V0IHMpIHsKICAg\nICAgICAgICAgICAgIC8vIFdlIGFyZSB0aGUgcmVjZWl2aW5nIGVuZCBhbmQg\nd2UgZG9uJ3Qgc2VuZCBhbnkgbWVzc2FnZXMKICAgICAgICAgICAgICAgIC8v\nIGJhY2sgdG8gdGhlIGJyb2FkY2FzdGVyLiBUdXJuIG9mZiBOYWdsZSdzIHNv\nIHRoYXQKICAgICAgICAgICAgICAgIC8vIHdlIHdpbGwgc2VuZCBhY2sgcGFj\na2V0cyB3aXRob3V0IHdhaXRpbmcuCiAgICAgICAgICAgICAgICBfcyA9IHM7\nCiAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgIF9z\nLnNldFRjcE5vRGVsYXkodHJ1ZSk7CiAgICAgICAgICAgICAgICAgICAgX2lu\nID0gbmV3IEJ1ZmZlcmVkSW5wdXRTdHJlYW0ocy5nZXRJbnB1dFN0cmVhbSgp\nKTsKICAgICAgICAgICAgICAgIH0gY2F0Y2ggKElPRXhjZXB0aW9uIGlvZSkg\newogICAgICAgICAgICAgICAgICAgIGlmIChfbG9nLmlzSW5mb0VuYWJsZWQo\nKSkKICAgICAgICAgICAgICAgICAgICAgICAgX2xvZy5pbmZvKHNfbG9jLmdl\ndCgidGNwLXNvY2tldC1vcHRpb24tZXJyb3IiKSwgaW9lKTsKICAgICAgICAg\nICAgICAgICAgICBfcyA9IG51bGw7CiAgICAgICAgICAgICAgICB9IGNhdGNo\nIChFeGNlcHRpb24gZSkgewogICAgICAgICAgICAgICAgICAgIGlmIChfbG9n\nLmlzV2FybkVuYWJsZWQoKSkKICAgICAgICAgICAgICAgICAgICAgICAgX2xv\nZy53YXJuKHNfbG9jLmdldCgidGNwLXJlY2VpdmUtZXJyb3IiKSwgZSk7CiAg\nICAgICAgICAgICAgICAgICAgX3MgPSBudWxsOwogICAgICAgICAgICAgICAg\nfQogICAgICAgICAgICB9CgogICAgICAgICAgICBwdWJsaWMgdm9pZCBydW4o\nKSB7CiAgICAgICAgICAgICAgICBpZiAoX3MgPT0gbnVsbCkKICAgICAgICAg\nICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB3aGlsZSAoX2lz\nUnVubmluZyAmJiBfcyAhPSBudWxsKSB7CiAgICAgICAgICAgICAgICAgICAg\ndHJ5IHsKICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGhpcyB3aWxsIGJs\nb2NrIG91ciB0aHJlYWQsIHdhaXRpbmcgdG8gcmVhZAogICAgICAgICAgICAg\nICAgICAgICAgICAvLyB0aGUgbmV4dCBFdmVudC1vYmplY3QtbWVzc2FnZS4K\nICAgICAgICAgICAgICAgICAgICAgICAgaGFuZGxlKF9pbik7CiAgICAgICAg\nICAgICAgICAgICAgfSBjYXRjaCAoRU9GRXhjZXB0aW9uIGVvZikgewogICAg\nICAgICAgICAgICAgICAgICAgICAvLyBFT0ZFeGNlcHRpb24gcmFpc2VkIHdo\nZW4gcGVlciBpcyBwcm9wZXJseQogICAgICAgICAgICAgICAgICAgICAgICAv\nLyBjbG9zaW5nIGl0cyBlbmQuCiAgICAgICAgICAgICAgICAgICAgICAgIGlm\nIChfbG9nLmlzVHJhY2VFbmFibGVkKCkpIHsKICAgICAgICAgICAgICAgICAg\nICAgICAgICAgIF9sb2cudHJhY2Uoc19sb2MuZ2V0KCJ0Y3AtY2xvc2Utc29j\na2V0IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfcy5nZXRJ\nbmV0QWRkcmVzcygpLmdldEhvc3RBZGRyZXNzKCkKICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgKyAiOiIgKyBfcy5nZXRQb3J0KCkpKTsK\nICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAg\nICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChUaHJv\nd2FibGUgZSkgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoX2xvZy5p\nc1dhcm5FbmFibGVkKCkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBf\nbG9nLndhcm4oc19sb2MuZ2V0KCJ0Y3AtcmVjZWl2ZS1lcnJvciIpLCBlKTsK\nICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAg\nICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgLy8g\nV2UgYXJlIGRvbmUgcmVjZWl2aW5nIG9uIHRoaXMgc29ja2V0IGFuZCB0aGlz\nIHdvcmtlcgogICAgICAgICAgICAgICAgLy8gdGhyZWFkIGlzIHRlcm1pbmF0\naW5nLgogICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAg\nICBfaW4uY2xvc2UoKTsKICAgICAgICAgICAgICAgICAgICBpZiAoX3MgIT0g\nbnVsbCkKICAgICAgICAgICAgICAgICAgICAgICAgX3MuY2xvc2UoKTsKICAg\nICAgICAgICAgICAgIH0gY2F0Y2ggKElPRXhjZXB0aW9uIGUpIHsKICAgICAg\nICAgICAgICAgICAgICBfbG9nLndhcm4oc19sb2MuZ2V0KCJ0Y3AtY2xvc2Ut\nc29ja2V0LWVycm9yIiwKICAgICAgICAgICAgICAgICAgICAgICAgX3MuZ2V0\nSW5ldEFkZHJlc3MoKS5nZXRIb3N0QWRkcmVzcygpICsgIjoiCiAgICAgICAg\nICAgICAgICAgICAgICAgICAgICArIF9zLmdldFBvcnQoKSksIGUpOwogICAg\nICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICAvKioK\nICAgICAgICAgICAgICogUHJvY2VzcyBhbiB7QGxpbmsgSW5wdXRTdHJlYW19\nIGNvbnRhaW5pbmcgb2JqZWN0cyB3cml0dGVuCiAgICAgICAgICAgICAqIGJ5\nIHtAbGluayBUQ1BSZW1vdGVDb21taXRQcm92aWRlciNicm9hZGNhc3QoUmVt\nb3RlQ29tbWl0RXZlbnQpfS4KICAgICAgICAgICAgICovCiAgICAgICAgICAg\nIHByaXZhdGUgdm9pZCBoYW5kbGUoSW5wdXRTdHJlYW0gaW4pCiAgICAgICAg\nICAgICAgICB0aHJvd3MgSU9FeGNlcHRpb24sIENsYXNzTm90Rm91bmRFeGNl\ncHRpb24gewogICAgICAgICAgICAgICAgLy8gVGhpcyB3aWxsIGJsb2NrIHdh\naXRpbmcgZm9yIHRoZSBuZXh0CiAgICAgICAgICAgICAgICBPYmplY3RJbnB1\ndFN0cmVhbSBvaXMgPSAKICAgICAgICAgICAgICAgICAgICBuZXcgU2VyaWFs\naXphdGlvbi5DbGFzc1Jlc29sdmluZ09iamVjdElucHV0U3RyZWFtKGluKTsK\nCiAgICAgICAgICAgICAgICBsb25nIHByb3RvY29sVmVyc2lvbiA9IG9pcy5y\nZWFkTG9uZygpOwogICAgICAgICAgICAgICAgaWYgKHByb3RvY29sVmVyc2lv\nbiAhPSBQUk9UT0NPTF9WRVJTSU9OKSB7CiAgICAgICAgICAgICAgICAgICAg\naWYgKF9sb2cuaXNXYXJuRW5hYmxlZCgpKSB7CiAgICAgICAgICAgICAgICAg\nICAgICAgIF9sb2cud2FybihzX2xvYy5nZXQoInRjcC13cm9uZy12ZXJzaW9u\nLWVycm9yIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9zLmdldElu\nZXRBZGRyZXNzKCkuZ2V0SG9zdEFkZHJlc3MoKSArICI6IgogICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICsgX3MuZ2V0UG9ydCgpKSk7CiAgICAg\nICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgICAg\nICB9CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgbG9uZyBz\nZW5kZXJJZCA9IG9pcy5yZWFkTG9uZygpOwogICAgICAgICAgICAgICAgaW50\nIHNlbmRlclBvcnQgPSBvaXMucmVhZEludCgpOwogICAgICAgICAgICAgICAg\nYnl0ZVtdIHNlbmRlckFkZHJlc3MgPSAoYnl0ZVtdKSBvaXMucmVhZE9iamVj\ndCgpOwogICAgICAgICAgICAgICAgUmVtb3RlQ29tbWl0RXZlbnQgcmNlID0g\nKFJlbW90ZUNvbW1pdEV2ZW50KSBvaXMucmVhZE9iamVjdCgpOwogICAgICAg\nICAgICAgICAgaWYgKF9sb2cuaXNUcmFjZUVuYWJsZWQoKSkgewogICAgICAg\nICAgICAgICAgICAgIF9sb2cudHJhY2Uoc19sb2MuZ2V0KCJ0Y3AtcmVjZWl2\nZWQtZXZlbnQiLAogICAgICAgICAgICAgICAgICAgICAgICBfcy5nZXRJbmV0\nQWRkcmVzcygpLmdldEhvc3RBZGRyZXNzKCkgKyAiOiIKICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICsgX3MuZ2V0UG9ydCgpKSk7CiAgICAgICAgICAg\nICAgICB9CgogICAgICAgICAgICAgICAgYm9vbGVhbiBmcm9tU2VsZiA9IHNl\nbmRlclBvcnQgPT0gX3BvcnQgJiYKICAgICAgICAgICAgICAgICAgICBBcnJh\neXMuZXF1YWxzKHNlbmRlckFkZHJlc3MsIF9sb2NhbGhvc3QpOwogICAgICAg\nICAgICAgICAgVENQUmVtb3RlQ29tbWl0UHJvdmlkZXIgcHJvdmlkZXI7CiAg\nICAgICAgICAgICAgICBzeW5jaHJvbml6ZWQgKF9wcm92aWRlcnMpIHsKICAg\nICAgICAgICAgICAgICAgICAvLyBibGVhaXI6IFdlJ3JlIGl0ZXJhdGluZywg\nYnV0IGN1cnJlbmx0eSB0aGVyZSBjYW4gcmVhbGx5CiAgICAgICAgICAgICAg\nICAgICAgLy8gb25seSBiZSBhIHNpbmdsZSBwcm92aWRlci4KICAgICAgICAg\nICAgICAgICAgICBmb3IgKEl0ZXJhdG9yIGl0ZXIgPSBfcHJvdmlkZXJzLml0\nZXJhdG9yKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZXIuaGFzTmV4\ndCgpOykgewogICAgICAgICAgICAgICAgICAgICAgICBwcm92aWRlciA9IChU\nQ1BSZW1vdGVDb21taXRQcm92aWRlcikgaXRlci5uZXh0KCk7CiAgICAgICAg\nICAgICAgICAgICAgICAgIGlmIChzZW5kZXJJZCAhPSBwcm92aWRlci5faWQg\nfHwgIWZyb21TZWxmKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJv\ndmlkZXIuZXZlbnRNYW5hZ2VyLmZpcmVFdmVudChyY2UpOwogICAgICAgICAg\nICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQog\nICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIFV0aWxpdHkgY2xhc3Mg\ndG8gc3RvcmUgYW4gSW5ldEFkZHJlc3MgYW5kIGFuIGludC4gTm90IHVzaW5n\nCiAgICAgKiBJbmV0U29ja2V0QWRkcmVzcyBiZWNhdXNlIGl0J3MgYSBKREsx\nLjQgQVBJLiBUaGlzIGFsc28KICAgICAqIHByb3ZpZGVzIGEgd3JhcHBlciBh\ncm91bmQgdGhlIHNvY2tldChzKSBhc3NvY2lhdGVkIHdpdGggdGhpcyBhZGRy\nZXNzLgogICAgICovCiAgICBwcml2YXRlIGNsYXNzIEhvc3RBZGRyZXNzIHsK\nCiAgICAgICAgcHJpdmF0ZSBJbmV0QWRkcmVzcyBfYWRkcmVzczsKICAgICAg\nICBwcml2YXRlIGludCBfcG9ydDsKICAgICAgICBwcml2YXRlIGxvbmcgX3Rp\nbWVMYXN0RXJyb3I7IC8vIG1pbGxpcwogICAgICAgIHByaXZhdGUgYm9vbGVh\nbiBfaXNBdmFpbGFibGU7IC8vIGlzIHBlZXIgdGhvdWdodCB0byBiZSB1cAog\nICAgICAgIHByaXZhdGUgaW50IF9pbmZvc0lzc3VlZCA9IDA7IC8vIGxpbWl0\nIGxvZyBlbnRyaWVzCgogICAgICAgIHByaXZhdGUgR2VuZXJpY09iamVjdFBv\nb2wgX3NvY2tldFBvb2w7IC8vIHJldXNhYmxlIG9wZW4gc29ja2V0cwoKICAg\nICAgICAvKioKICAgICAgICAgKiBDb25zdHJ1Y3QgYSBuZXcgaG9zdCBhZGRy\nZXNzIGZyb20gYSBzdHJpbmcgb2YgdGhlIGZvcm0KICAgICAgICAgKiAiaG9z\ndDpwb3J0IiBvciBvZiB0aGUgZm9ybSAiaG9zdCIuCiAgICAgICAgICovCiAg\nICAgICAgcHJpdmF0ZSBIb3N0QWRkcmVzcyhTdHJpbmcgaG9zdCkKICAgICAg\nICAgICAgdGhyb3dzIFVua25vd25Ib3N0RXhjZXB0aW9uIHsKICAgICAgICAg\nICAgaW50IGNvbG9uID0gaG9zdC5pbmRleE9mKCc6Jyk7CiAgICAgICAgICAg\nIHRyeSB7CiAgICAgICAgICAgICAgICBpZiAoY29sb24gIT0gLTEpIHsKICAg\nICAgICAgICAgICAgICAgICBfYWRkcmVzcyA9IChJbmV0QWRkcmVzcykgQWNj\nZXNzQ29udHJvbGxlcgogICAgICAgICAgICAgICAgICAgICAgICAuZG9Qcml2\naWxlZ2VkKEoyRG9Qcml2SGVscGVyLmdldEJ5TmFtZUFjdGlvbihob3N0CiAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAuc3Vic3RyaW5nKDAsIGNvbG9u\nKSkpOwogICAgICAgICAgICAgICAgICAgIF9wb3J0ID0gSW50ZWdlci5wYXJz\nZUludChob3N0LnN1YnN0cmluZyhjb2xvbiArIDEpKTsKICAgICAgICAgICAg\nICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgX2FkZHJlc3MgPSAo\nSW5ldEFkZHJlc3MpIEFjY2Vzc0NvbnRyb2xsZXIKICAgICAgICAgICAgICAg\nICAgICAgICAgLmRvUHJpdmlsZWdlZChKMkRvUHJpdkhlbHBlci5nZXRCeU5h\nbWVBY3Rpb24oaG9zdCkpOwogICAgICAgICAgICAgICAgICAgIF9wb3J0ID0g\nREVGQVVMVF9QT1JUOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9\nIGNhdGNoIChQcml2aWxlZ2VkQWN0aW9uRXhjZXB0aW9uIHBhZSkgewogICAg\nICAgICAgICAgICAgdGhyb3cgKFVua25vd25Ib3N0RXhjZXB0aW9uKSBwYWUu\nZ2V0RXhjZXB0aW9uKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgLy8g\nLTEgbWF4IHdhaXQgPT0gYXMgbG9uZyBhcyBpdCB0YWtlcwogICAgICAgICAg\nICBfc29ja2V0UG9vbCA9IG5ldyBHZW5lcmljT2JqZWN0UG9vbAogICAgICAg\nICAgICAgICAgKG5ldyBTb2NrZXRQb29sYWJsZU9iamVjdEZhY3RvcnkoKSwg\nX21heEFjdGl2ZSwKICAgICAgICAgICAgICAgICAgICBHZW5lcmljT2JqZWN0\nUG9vbC5XSEVOX0VYSEFVU1RFRF9CTE9DSywgLTEpOwogICAgICAgICAgICBf\naXNBdmFpbGFibGUgPSB0cnVlOwogICAgICAgIH0KCiAgICAgICAgcHJpdmF0\nZSB2b2lkIHNldE1heEFjdGl2ZShpbnQgbWF4QWN0aXZlKSB7CiAgICAgICAg\nICAgIF9zb2NrZXRQb29sLnNldE1heEFjdGl2ZShtYXhBY3RpdmUpOwogICAg\nICAgIH0KCiAgICAgICAgcHJpdmF0ZSB2b2lkIHNldE1heElkbGUoaW50IG1h\neElkbGUpIHsKICAgICAgICAgICAgX3NvY2tldFBvb2wuc2V0TWF4SWRsZSht\nYXhJZGxlKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyB2b2lkIGNsb3Nl\nKCkgewogICAgICAgICAgICAvLyBDbG9zZSB0aGUgcG9vbCBvZiBzb2NrZXRz\nIHRvIHRoaXMgcGVlci4gVGhpcwogICAgICAgICAgICAvLyB3aWxsIGNsb3Nl\nIGFsbCBzb2NrZXRzIGluIHRoZSBwb29sLgogICAgICAgICAgICB0cnkgewog\nICAgICAgICAgICAgICAgX3NvY2tldFBvb2wuY2xvc2UoKTsKICAgICAgICAg\nICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgICAgIGlm\nIChsb2cuaXNXYXJuRW5hYmxlZCgpKSB7CiAgICAgICAgICAgICAgICAgICAg\nbG9nLndhcm4oc19sb2MuZ2V0KCJ0Y3AtY2xvc2UtcG9vbC1lcnJvciIpLCBl\nKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0K\nCiAgICAgICAgcHJpdmF0ZSB2b2lkIHNlbmRVcGRhdGVQYWNrZXQoYnl0ZVtd\nIGJ5dGVzKSB7CiAgICAgICAgICAgIGlmICghX2lzQXZhaWxhYmxlKSB7CiAg\nICAgICAgICAgICAgICBsb25nIG5vdyA9IFN5c3RlbS5jdXJyZW50VGltZU1p\nbGxpcygpOwogICAgICAgICAgICAgICAgaWYgKG5vdyAtIF90aW1lTGFzdEVy\ncm9yIDwgX3JlY292ZXJ5VGltZU1pbGxpcykKICAgICAgICAgICAgICAgICAg\nICAvLyBOb3QgZW5vdWdoIHRpbWUgaGFzIHBhc3NlZCBzaW5jZSB0aGUgbGFz\ndCBlcnJvcgogICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAg\nICAgfQogICAgICAgICAgICBTb2NrZXQgcyA9IG51bGw7CiAgICAgICAgICAg\nIHRyeSB7CiAgICAgICAgICAgICAgICBzID0gZ2V0U29ja2V0KCk7CiAgICAg\nICAgICAgICAgICBPdXRwdXRTdHJlYW0gb3MgPSBzLmdldE91dHB1dFN0cmVh\nbSgpOwogICAgICAgICAgICAgICAgb3Mud3JpdGUoYnl0ZXMpOwogICAgICAg\nICAgICAgICAgb3MuZmx1c2goKTsKCiAgICAgICAgICAgICAgICBpZiAobG9n\nLmlzVHJhY2VFbmFibGVkKCkpIHsKICAgICAgICAgICAgICAgICAgICBsb2cu\ndHJhY2Uoc19sb2MuZ2V0KCJ0Y3Atc2VudC11cGRhdGUiLAogICAgICAgICAg\nICAgICAgICAgICAgICBfYWRkcmVzcy5nZXRIb3N0QWRkcmVzcygpICsgIjoi\nICsgX3BvcnQsCiAgICAgICAgICAgICAgICAgICAgICAgIFN0cmluZy52YWx1\nZU9mKHMuZ2V0TG9jYWxQb3J0KCkpKSk7CiAgICAgICAgICAgICAgICB9CiAg\nICAgICAgICAgICAgICBfaXNBdmFpbGFibGUgPSB0cnVlOwogICAgICAgICAg\nICAgICAgX2luZm9zSXNzdWVkID0gMDsKICAgICAgICAgICAgICAgIC8vIFJl\ndHVybiB0aGUgc29ja2V0IHRvIHRoZSBwb29sOyB0aGUgc29ja2V0IGlzCiAg\nICAgICAgICAgICAgICAvLyBzdGlsbCBnb29kLgogICAgICAgICAgICAgICAg\ncmV0dXJuU29ja2V0KHMpOwogICAgICAgICAgICB9IGNhdGNoIChFeGNlcHRp\nb24gZSkgewogICAgICAgICAgICAgICAgLy8gVGhlcmUgaGFzIGJlZW4gYSBw\ncm9ibGVtIHNlbmRpbmcgdG8gdGhlIHBlZXIuCiAgICAgICAgICAgICAgICAv\nLyBUaGUgT1Mgc29ja2V0IHRoYXQgd2FzIGJlaW5nIHVzZWQgaXMgY2FuIG5v\nIGxvbmdlcgogICAgICAgICAgICAgICAgLy8gYmUgdXNlZC4KICAgICAgICAg\nICAgICAgIGlmIChzICE9IG51bGwpCiAgICAgICAgICAgICAgICAgICAgdGhp\ncy5jbG9zZVNvY2tldChzKTsKICAgICAgICAgICAgICAgIHRoaXMuY2xlYXJB\nbGxTb2NrZXRzKCk7CgogICAgICAgICAgICAgICAgaWYgKF9pc0F2YWlsYWJs\nZSkgewogICAgICAgICAgICAgICAgICAgIC8vIExvZyBhIHdhcm5pbmcsIHRo\nZSBwZWVyIHdhcyB1cCBhbmQgaGFzIG5vdyBnb25lIGRvd24KICAgICAgICAg\nICAgICAgICAgICBpZiAobG9nLmlzV2FybkVuYWJsZWQoKSkgewogICAgICAg\nICAgICAgICAgICAgICAgICBsb2cud2FybihzX2xvYy5nZXQoInRjcC1zZW5k\nLWVycm9yIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9hZGRyZXNz\nLmdldEhvc3RBZGRyZXNzKCkgKyAiOiIgKyBfcG9ydCksIGUpOwogICAgICAg\nICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBfaXNBdmFpbGFi\nbGUgPSBmYWxzZTsKICAgICAgICAgICAgICAgICAgICAvLyBPbmNlIGVub3Vn\naCB0aW1lIGhhcyBwYXNzZWQgd2Ugd2lsbCBsb2cgYW5vdGhlciB3YXJuaW5n\nCiAgICAgICAgICAgICAgICAgICAgX3RpbWVMYXN0RXJyb3IgPSBTeXN0ZW0u\nY3VycmVudFRpbWVNaWxsaXMoKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7\nCiAgICAgICAgICAgICAgICAgICAgbG9uZyBub3cgPSBTeXN0ZW0uY3VycmVu\ndFRpbWVNaWxsaXMoKTsKICAgICAgICAgICAgICAgICAgICBpZiAobm93IC0g\nX3RpbWVMYXN0RXJyb3IgPiBfcmVjb3ZlcnlUaW1lTWlsbGlzKSB7CiAgICAg\nICAgICAgICAgICAgICAgICAgIGlmIChfaW5mb3NJc3N1ZWQgPCA1KSB7CiAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBFbm91Z2ggdGltZSBoYXMg\ncGFzc2VkLCBhbmQgcGVlciBpcyBzdGlsbCBkb3duCiAgICAgICAgICAgICAg\nICAgICAgICAgICAgICBfdGltZUxhc3RFcnJvciA9IFN5c3RlbS5jdXJyZW50\nVGltZU1pbGxpcygpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8g\nV2Ugd2VyZSB0cnlpbmcgdG8gcmVlc3RhYmxpc2ggdGhlIGNvbm5lY3Rpb24s\nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBidXQgd2UgZmFpbGVk\nIGFnYWluLiBMb2cgYSBtZXNzYWdlLCBidXQKICAgICAgICAgICAgICAgICAg\nICAgICAgICAgIC8vIGxvd2VyIHNldmVyaXR5LiBUaGlzIGxvZyB3aWxsIG9j\nY3VyIHBlcmlvZGljYWxseQogICAgICAgICAgICAgICAgICAgICAgICAgICAg\nLy8gZm9yIDUgdGltZXMgdW50aWwgdGhlIHBlZXIgY29tZXMgYmFjay4KICAg\nICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChsb2cuaXNJbmZvRW5hYmxl\nZCgpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9nLmlu\nZm8oc19sb2MuZ2V0KCJ0Y3Atc2VuZC1zdGlsbC1lcnJvciIsCiAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9hZGRyZXNzLmdldEhvc3RB\nZGRyZXNzKCkgKyAiOiIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICsgX3BvcnQpLCBlKTsKICAgICAgICAgICAgICAgICAgICAg\nICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9pbmZvc0lz\nc3VlZCsrOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAg\nICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAg\nICAgICAgfQoKICAgICAgICBwcml2YXRlIFNvY2tldCBnZXRTb2NrZXQoKQog\nICAgICAgICAgICB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICAgICAgcmV0\ndXJuIChTb2NrZXQpIF9zb2NrZXRQb29sLmJvcnJvd09iamVjdCgpOwogICAg\nICAgIH0KCiAgICAgICAgcHJpdmF0ZSB2b2lkIHJldHVyblNvY2tldChTb2Nr\nZXQgcykKICAgICAgICAgICAgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAg\nICAgIF9zb2NrZXRQb29sLnJldHVybk9iamVjdChzKTsKICAgICAgICB9Cgog\nICAgICAgIHByaXZhdGUgdm9pZCBjbGVhckFsbFNvY2tldHMoKSB7CiAgICAg\nICAgICAgIF9zb2NrZXRQb29sLmNsZWFyKCk7CiAgICAgICAgfQoKICAgICAg\nICBwcml2YXRlIHZvaWQgY2xvc2VTb2NrZXQoU29ja2V0IHMpIHsKICAgICAg\nICAgICAgLy8gQWxsIHNvY2tldHMgY29tZSBmcm9tIHRoZSBwb29sLgogICAg\nICAgICAgICAvLyBUaGlzIHNvY2tldCBpcyBubyBsb25nZXIgdXNhYmxlLCBz\nbyBkZWxldGUgaXQgZnJvbSB0aGUKICAgICAgICAgICAgLy8gcG9vbC4KICAg\nICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIF9zb2NrZXRQb29sLmlu\ndmFsaWRhdGVPYmplY3Qocyk7CiAgICAgICAgICAgIH0gY2F0Y2ggKEV4Y2Vw\ndGlvbiBlKSB7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIC8q\nKgogICAgICAgICAqIEZhY3RvcnkgZm9yIHBvb2xlZCBzb2NrZXRzLgogICAg\nICAgICAqLwogICAgICAgIHByaXZhdGUgY2xhc3MgU29ja2V0UG9vbGFibGVP\nYmplY3RGYWN0b3J5CiAgICAgICAgICAgIGltcGxlbWVudHMgUG9vbGFibGVP\nYmplY3RGYWN0b3J5IHsKCiAgICAgICAgICAgIHB1YmxpYyBPYmplY3QgbWFr\nZU9iamVjdCgpCiAgICAgICAgICAgICAgICB0aHJvd3MgSU9FeGNlcHRpb24g\newogICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICBT\nb2NrZXQgcyA9IChTb2NrZXQpIEFjY2Vzc0NvbnRyb2xsZXIKICAgICAgICAg\nICAgICAgICAgICAgICAgLmRvUHJpdmlsZWdlZChKMkRvUHJpdkhlbHBlci5u\nZXdTb2NrZXRBY3Rpb24oX2FkZHJlc3MsCiAgICAgICAgICAgICAgICAgICAg\nICAgICAgICBfcG9ydCkpOwogICAgICAgICAgICAgICAgICAgIGlmIChsb2cu\naXNUcmFjZUVuYWJsZWQoKSkgewogICAgICAgICAgICAgICAgICAgICAgICBs\nb2cudHJhY2Uoc19sb2MuZ2V0KCJ0Y3Atb3Blbi1jb25uZWN0aW9uIiwgX2Fk\nZHJlc3MKICAgICAgICAgICAgICAgICAgICAgICAgICAgICsgIjoiICsgX3Bv\ncnQsICIiICsgcy5nZXRMb2NhbFBvcnQoKSkpOwogICAgICAgICAgICAgICAg\nICAgIH0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gczsKICAgICAgICAg\nICAgICAgIH0gY2F0Y2ggKFByaXZpbGVnZWRBY3Rpb25FeGNlcHRpb24gcGFl\nKSB7CiAgICAgICAgICAgICAgICAgICAgdGhyb3cgKElPRXhjZXB0aW9uKSBw\nYWUuZ2V0RXhjZXB0aW9uKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAg\nICAgIH0KCiAgICAgICAgICAgIHB1YmxpYyB2b2lkIGRlc3Ryb3lPYmplY3Qo\nT2JqZWN0IG9iaikgewogICAgICAgICAgICAgICAgLy8gc2lsZW50Q2xvc2Ug\nKCkuCiAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAg\nIFNvY2tldCBzID0gKFNvY2tldCkgb2JqOwogICAgICAgICAgICAgICAgICAg\nIGlmIChsb2cuaXNUcmFjZUVuYWJsZWQoKSkKICAgICAgICAgICAgICAgICAg\nICAgICAgbG9nLnRyYWNlKHNfbG9jLmdldCgidGNwLWNsb3NlLXNlbmRpbmct\nc29ja2V0IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9hZGRyZXNz\nICsgIjoiICsgX3BvcnQsICIiICsgcy5nZXRMb2NhbFBvcnQoKSkpOwogICAg\nICAgICAgICAgICAgICAgIHMuY2xvc2UoKTsKICAgICAgICAgICAgICAgIH0g\nY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgICAgICAgICAgbG9n\nLndhcm4oc19sb2MuZ2V0KCJ0Y3AtY2xvc2Utc29ja2V0LWVycm9yIiwKICAg\nICAgICAgICAgICAgICAgICAgICAgX2FkZHJlc3MuZ2V0SG9zdEFkZHJlc3Mo\nKSArICI6IiArIF9wb3J0KSwgZSk7CiAgICAgICAgICAgICAgICB9CiAgICAg\nICAgICAgIH0KCiAgICAgICAgICAgIHB1YmxpYyBib29sZWFuIHZhbGlkYXRl\nT2JqZWN0KE9iamVjdCBvYmopIHsKICAgICAgICAgICAgICAgIHJldHVybiB0\ncnVlOwogICAgICAgICAgICB9CgogICAgICAgICAgICBwdWJsaWMgdm9pZCBh\nY3RpdmF0ZU9iamVjdCAoT2JqZWN0IHZhbHVlKQoJCQl7CgkJCX0KCgkJCXB1\nYmxpYyB2b2lkIHBhc3NpdmF0ZU9iamVjdCAoT2JqZWN0IHZhbHVlKQoJCQl7\nCgkJCX0KCQl9Cgl9Cn0K\n","encoding":"base64"}

