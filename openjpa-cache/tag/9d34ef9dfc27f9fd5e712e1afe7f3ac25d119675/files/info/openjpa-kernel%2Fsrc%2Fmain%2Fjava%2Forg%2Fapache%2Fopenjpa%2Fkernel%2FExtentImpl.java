{"sha":"5d300f96c55f2b1f87e9a919b79fb540cd93ea56","node_id":"MDQ6QmxvYjIwNjM2NDo1ZDMwMGY5NmM1NWYyYjFmODdlOWE5MTliNzlmYjU0MGNkOTNlYTU2","size":10329,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/5d300f96c55f2b1f87e9a919b79fb540cd93ea56","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsOwoKaW1wb3J0IGph\ndmEudXRpbC5BcnJheUxpc3Q7CmltcG9ydCBqYXZhLnV0aWwuSXRlcmF0b3I7\nCmltcG9ydCBqYXZhLnV0aWwuTGlzdDsKaW1wb3J0IGphdmEudXRpbC5Ob1N1\nY2hFbGVtZW50RXhjZXB0aW9uOwoKaW1wb3J0IG9yZy5hcGFjaGUuY29tbW9u\ncy5jb2xsZWN0aW9ucy5QcmVkaWNhdGU7CmltcG9ydCBvcmcuYXBhY2hlLmNv\nbW1vbnMuY29sbGVjdGlvbnMuaXRlcmF0b3JzLkZpbHRlckl0ZXJhdG9yOwpp\nbXBvcnQgb3JnLmFwYWNoZS5jb21tb25zLmNvbGxlY3Rpb25zLml0ZXJhdG9y\ncy5JdGVyYXRvckNoYWluOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxp\nYi5yb3AuUmVzdWx0T2JqZWN0UHJvdmlkZXI7CmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEubGliLnJvcC5SZXN1bHRPYmplY3RQcm92aWRlckl0ZXJhdG9y\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51dGlsLkNsb3NlYWJs\nZTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIudXRpbC5SZWZlcmVu\nY2VIYXNoU2V0OwppbXBvcnQgamF2YS51dGlsLmNvbmN1cnJlbnQubG9ja3Mu\nUmVlbnRyYW50TG9jazsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRh\nLkNsYXNzTWV0YURhdGE7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0\nYS5NZXRhRGF0YVJlcG9zaXRvcnk7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEudXRpbC5HZW5lcmFsRXhjZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLnV0aWwuSW1wbEhlbHBlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS51dGlsLk9wZW5KUEFFeGNlcHRpb247CgovKioKICogUmVwcmVzZW50\nYXRpb24gb2YgYWxsIG1lbWJlcnMgb2YgYSBwZXJzaXN0ZW50IGNsYXNzLgog\nKgogKiBAYXV0aG9yIEFiZSBXaGl0ZQogKiBAYXV0aG9yIFBhdHJpY2sgTGlu\nc2tleQogKiBAbm9qYXZhZG9jCiAqLwpwdWJsaWMgY2xhc3MgRXh0ZW50SW1w\nbAogICAgaW1wbGVtZW50cyBFeHRlbnQgewoKICAgIHByaXZhdGUgc3RhdGlj\nIGZpbmFsIENsYXNzTWV0YURhdGFbXSBFTVBUWV9NRVRBUyA9IG5ldyBDbGFz\nc01ldGFEYXRhWzBdOwoKICAgIHByaXZhdGUgZmluYWwgQnJva2VyIF9icm9r\nZXI7CiAgICBwcml2YXRlIGZpbmFsIENsYXNzIF90eXBlOwogICAgcHJpdmF0\nZSBmaW5hbCBib29sZWFuIF9zdWJzOwogICAgcHJpdmF0ZSBmaW5hbCBGZXRj\naENvbmZpZ3VyYXRpb24gX2ZjOwogICAgcHJpdmF0ZSBmaW5hbCBSZWVudHJh\nbnRMb2NrIF9sb2NrOwogICAgcHJpdmF0ZSBib29sZWFuIF9pZ25vcmUgPSBm\nYWxzZTsKCiAgICAvLyBzZXQgb2Ygb3BlbiBpdGVyYXRvcnMKICAgIHByaXZh\ndGUgUmVmZXJlbmNlSGFzaFNldCBfb3Blbkl0cnMgPSBudWxsOwoKICAgIC8q\nKgogICAgICogQ29uc3RydWN0b3IuCiAgICAgKgogICAgICogQHBhcmFtIGJy\nb2tlciB0aGUgb3duaW5nIGJyb2tlcgogICAgICogQHBhcmFtIHR5cGUgdGhl\nIGNhbmRpZGF0ZSBjbGFzcwogICAgICogQHBhcmFtIHN1YnMgd2hldGhlciBz\ndWJjbGFzc2VzIGFyZSBpbmNsdWRlZCBpbiB0aGUgZXh0ZW50CiAgICAgKi8K\nICAgIEV4dGVudEltcGwoQnJva2VyIGJyb2tlciwgQ2xhc3MgdHlwZSwgYm9v\nbGVhbiBzdWJzLAogICAgICAgIEZldGNoQ29uZmlndXJhdGlvbiBmZXRjaCkg\newogICAgICAgIF9icm9rZXIgPSBicm9rZXI7CiAgICAgICAgX3R5cGUgPSB0\neXBlOwogICAgICAgIF9zdWJzID0gc3ViczsKICAgICAgICBpZiAoZmV0Y2gg\nIT0gbnVsbCkKICAgICAgICAgICAgX2ZjID0gZmV0Y2g7CiAgICAgICAgZWxz\nZQogICAgICAgICAgICBfZmMgPSAoRmV0Y2hDb25maWd1cmF0aW9uKSBicm9r\nZXIuZ2V0RmV0Y2hDb25maWd1cmF0aW9uKCkuY2xvbmUoKTsKICAgICAgICBf\naWdub3JlID0gYnJva2VyLmdldElnbm9yZUNoYW5nZXMoKTsKICAgICAgICBp\nZiAoYnJva2VyLmdldE11bHRpdGhyZWFkZWQoKSkKICAgICAgICAgICAgX2xv\nY2sgPSBuZXcgUmVlbnRyYW50TG9jaygpOwogICAgICAgIGVsc2UKICAgICAg\nICAgICAgX2xvY2sgPSBudWxsOwogICAgfQoKICAgIHB1YmxpYyBGZXRjaENv\nbmZpZ3VyYXRpb24gZ2V0RmV0Y2hDb25maWd1cmF0aW9uKCkgewogICAgICAg\nIHJldHVybiBfZmM7CiAgICB9CgogICAgcHVibGljIGJvb2xlYW4gZ2V0SWdu\nb3JlQ2hhbmdlcygpIHsKICAgICAgICByZXR1cm4gX2lnbm9yZTsKICAgIH0K\nCiAgICBwdWJsaWMgdm9pZCBzZXRJZ25vcmVDaGFuZ2VzKGJvb2xlYW4gaWdu\nb3JlQ2hhbmdlcykgewogICAgICAgIF9icm9rZXIuYXNzZXJ0T3BlbigpOwog\nICAgICAgIF9pZ25vcmUgPSBpZ25vcmVDaGFuZ2VzOwogICAgfQoKICAgIHB1\nYmxpYyBMaXN0IGxpc3QoKSB7CiAgICAgICAgTGlzdCBsaXN0ID0gbmV3IEFy\ncmF5TGlzdCgpOwogICAgICAgIEl0ZXJhdG9yIGl0ciA9IGl0ZXJhdG9yKCk7\nCiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgd2hpbGUgKGl0ci5oYXNOZXh0\nKCkpCiAgICAgICAgICAgICAgICBsaXN0LmFkZChpdHIubmV4dCgpKTsKICAg\nICAgICAgICAgcmV0dXJuIGxpc3Q7CiAgICAgICAgfSBmaW5hbGx5IHsKICAg\nICAgICAgICAgSW1wbEhlbHBlci5jbG9zZShpdHIpOwogICAgICAgIH0KICAg\nIH0KCiAgICBwdWJsaWMgSXRlcmF0b3IgaXRlcmF0b3IoKSB7CiAgICAgICAg\nX2Jyb2tlci5hc3NlcnROb250cmFuc2FjdGlvbmFsUmVhZCgpOwogICAgICAg\nIENsb3NlYWJsZUl0ZXJhdG9yIGNpdHIgPSBudWxsOwogICAgICAgIHRyeSB7\nCiAgICAgICAgICAgIC8vIGNyZWF0ZSBhbiBpdGVyYXRvciBjaGFpbjsgYWRk\nIHBuZXcgb2JqZWN0cyBpZiB0cmFuc2FjdGlvbmFsCiAgICAgICAgICAgIENs\nb3NlYWJsZUl0ZXJhdG9yQ2hhaW4gY2hhaW4gPSBuZXcgQ2xvc2VhYmxlSXRl\ncmF0b3JDaGFpbigpOwogICAgICAgICAgICBib29sZWFuIHRyYW5zID0gIV9p\nZ25vcmUgJiYgX2Jyb2tlci5pc0FjdGl2ZSgpOwogICAgICAgICAgICBpZiAo\ndHJhbnMpCiAgICAgICAgICAgICAgICBjaGFpbi5hZGRJdGVyYXRvcihuZXcg\nRmlsdGVyTmV3SXRlcmF0b3IoKSk7CgogICAgICAgICAgICAvLyBhZGQgZGF0\nYWJhc2UgaXRlcmF0b3JzIGZvciBlYWNoIGltcGxlbWVudGluZyBjbGFzcwog\nICAgICAgICAgICBNZXRhRGF0YVJlcG9zaXRvcnkgcmVwb3MgPSBfYnJva2Vy\nLmdldENvbmZpZ3VyYXRpb24oKS4KICAgICAgICAgICAgICAgIGdldE1ldGFE\nYXRhUmVwb3NpdG9yeUluc3RhbmNlKCk7CiAgICAgICAgICAgIENsYXNzTWV0\nYURhdGEgbWV0YSA9IHJlcG9zLmdldE1ldGFEYXRhKF90eXBlLAogICAgICAg\nICAgICAgICAgX2Jyb2tlci5nZXRDbGFzc0xvYWRlcigpLCBmYWxzZSk7Cgog\nICAgICAgICAgICBDbGFzc01ldGFEYXRhW10gbWV0YXM7CiAgICAgICAgICAg\nIGlmIChtZXRhICE9IG51bGwgJiYgKCFfc3VicyB8fCAhbWV0YS5pc01hbmFn\nZWRJbnRlcmZhY2UoKSkKICAgICAgICAgICAgICAgICYmIChtZXRhLmlzTWFw\ncGVkKCkgfHwgKF9zdWJzCiAgICAgICAgICAgICAgICAmJiBtZXRhLmdldE1h\ncHBlZFBDU3ViY2xhc3NNZXRhRGF0YXMoKS5sZW5ndGggPiAwKSkpCiAgICAg\nICAgICAgICAgICBtZXRhcyA9IG5ldyBDbGFzc01ldGFEYXRhW117IG1ldGEg\nfTsKICAgICAgICAgICAgZWxzZSBpZiAoX3N1YnMgJiYgKG1ldGEgPT0gbnVs\nbCB8fCBtZXRhLmlzTWFuYWdlZEludGVyZmFjZSgpKSkKICAgICAgICAgICAg\nICAgIG1ldGFzID0gcmVwb3MuZ2V0SW1wbGVtZW50b3JNZXRhRGF0YXMoX3R5\ncGUsCiAgICAgICAgICAgICAgICAgICAgX2Jyb2tlci5nZXRDbGFzc0xvYWRl\ncigpLCBmYWxzZSk7CiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAg\nIG1ldGFzID0gRU1QVFlfTUVUQVM7CgogICAgICAgICAgICBSZXN1bHRPYmpl\nY3RQcm92aWRlciByb3A7CiAgICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBp\nIDwgbWV0YXMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICAgIHJvcCA9\nIF9icm9rZXIuZ2V0U3RvcmVNYW5hZ2VyKCkuZXhlY3V0ZUV4dGVudChtZXRh\nc1tpXSwKICAgICAgICAgICAgICAgICAgICBfc3VicywgX2ZjKTsKICAgICAg\nICAgICAgICAgIGlmIChyb3AgIT0gbnVsbCkKICAgICAgICAgICAgICAgICAg\nICBjaGFpbi5hZGRJdGVyYXRvcihuZXcgUmVzdWx0T2JqZWN0UHJvdmlkZXJJ\ndGVyYXRvcihyb3ApKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8g\nZmlsdGVyIGRlbGV0ZWQgb2JqZWN0cyBpZiB0cmFuc2FjdGlvbmFsCiAgICAg\nICAgICAgIGlmICh0cmFucykKICAgICAgICAgICAgICAgIGNpdHIgPSBuZXcg\nRmlsdGVyRGVsZXRlZEl0ZXJhdG9yKGNoYWluKTsKICAgICAgICAgICAgZWxz\nZQogICAgICAgICAgICAgICAgY2l0ciA9IGNoYWluOwogICAgICAgICAgICBj\naXRyLnNldFJlbW92ZU9uQ2xvc2UodGhpcyk7CiAgICAgICAgfSBjYXRjaCAo\nT3BlbkpQQUV4Y2VwdGlvbiBrZSkgewogICAgICAgICAgICB0aHJvdyBrZTsK\nICAgICAgICB9IGNhdGNoIChSdW50aW1lRXhjZXB0aW9uIHJlKSB7CiAgICAg\nICAgICAgIHRocm93IG5ldyBHZW5lcmFsRXhjZXB0aW9uKHJlKTsKICAgICAg\nICB9CgogICAgICAgIGxvY2soKTsKICAgICAgICB0cnkgewogICAgICAgICAg\nICBpZiAoX29wZW5JdHJzID09IG51bGwpCiAgICAgICAgICAgICAgICBfb3Bl\nbkl0cnMgPSBuZXcgUmVmZXJlbmNlSGFzaFNldChSZWZlcmVuY2VIYXNoU2V0\nLldFQUspOwogICAgICAgICAgICBfb3Blbkl0cnMuYWRkKGNpdHIpOwogICAg\nICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgIHVubG9jaygpOwogICAgICAg\nIH0KICAgICAgICByZXR1cm4gY2l0cjsKICAgIH0KCiAgICBwdWJsaWMgQnJv\na2VyIGdldEJyb2tlcigpIHsKICAgICAgICByZXR1cm4gX2Jyb2tlcjsKICAg\nIH0KCiAgICBwdWJsaWMgQ2xhc3MgZ2V0RWxlbWVudFR5cGUoKSB7CiAgICAg\nICAgcmV0dXJuIF90eXBlOwogICAgfQoKICAgIHB1YmxpYyBib29sZWFuIGhh\nc1N1YmNsYXNzZXMoKSB7CiAgICAgICAgcmV0dXJuIF9zdWJzOwogICAgfQoK\nICAgIHB1YmxpYyB2b2lkIGNsb3NlQWxsKCkgewogICAgICAgIGlmIChfb3Bl\nbkl0cnMgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuOwoKICAgICAgICBs\nb2NrKCk7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgQ2xvc2VhYmxlSXRl\ncmF0b3IgY2l0cjsKICAgICAgICAgICAgZm9yIChJdGVyYXRvciBpdHIgPSBf\nb3Blbkl0cnMuaXRlcmF0b3IoKTsgaXRyLmhhc05leHQoKTspIHsKICAgICAg\nICAgICAgICAgIGNpdHIgPSAoQ2xvc2VhYmxlSXRlcmF0b3IpIGl0ci5uZXh0\nKCk7CiAgICAgICAgICAgICAgICBjaXRyLnNldFJlbW92ZU9uQ2xvc2UobnVs\nbCk7CiAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAg\nIGNpdHIuY2xvc2UoKTsKICAgICAgICAgICAgICAgIH0gY2F0Y2ggKEV4Y2Vw\ndGlvbiBlKSB7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAg\nICAgICAgICAgX29wZW5JdHJzLmNsZWFyKCk7CiAgICAgICAgfSBjYXRjaCAo\nT3BlbkpQQUV4Y2VwdGlvbiBrZSkgewogICAgICAgICAgICB0aHJvdyBrZTsK\nICAgICAgICB9IGNhdGNoIChSdW50aW1lRXhjZXB0aW9uIHJlKSB7CiAgICAg\nICAgICAgIHRocm93IG5ldyBHZW5lcmFsRXhjZXB0aW9uKHJlKTsKICAgICAg\nICB9IGZpbmFsbHkgewogICAgICAgICAgICB1bmxvY2soKTsKICAgICAgICB9\nCiAgICB9CgogICAgcHVibGljIHZvaWQgbG9jaygpIHsKICAgICAgICBpZiAo\nX2xvY2sgIT0gbnVsbCkKICAgICAgICAgICAgX2xvY2subG9jaygpOwogICAg\nfQoKICAgIHB1YmxpYyB2b2lkIHVubG9jaygpIHsKICAgICAgICBpZiAoX2xv\nY2sgIT0gbnVsbCkKICAgICAgICAgICAgX2xvY2sudW5sb2NrKCk7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBDbG9zZWFibGUgaXRlcmF0b3IuCiAgICAgKi8K\nICAgIHByaXZhdGUgc3RhdGljIGludGVyZmFjZSBDbG9zZWFibGVJdGVyYXRv\ncgogICAgICAgIGV4dGVuZHMgQ2xvc2VhYmxlLCBJdGVyYXRvciB7CgogICAg\nICAgIC8qKgogICAgICAgICAqIFNldCB0aGUgZXh0ZW50IHRvIHJlbW92ZSBz\nZWxmIGZyb20gb24gY2xvc2UuCiAgICAgICAgICovCiAgICAgICAgcHVibGlj\nIHZvaWQgc2V0UmVtb3ZlT25DbG9zZShFeHRlbnRJbXBsIGV4dGVudCk7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBDbG9zZWFibGUge0BsaW5rIEl0ZXJhdG9y\nQ2hhaW59LgogICAgICovCiAgICBwcml2YXRlIHN0YXRpYyBjbGFzcyBDbG9z\nZWFibGVJdGVyYXRvckNoYWluCiAgICAgICAgZXh0ZW5kcyBJdGVyYXRvckNo\nYWluCiAgICAgICAgaW1wbGVtZW50cyBDbG9zZWFibGVJdGVyYXRvciB7Cgog\nICAgICAgIHByaXZhdGUgRXh0ZW50SW1wbCBfZXh0ZW50ID0gbnVsbDsKICAg\nICAgICBwcml2YXRlIGJvb2xlYW4gX2Nsb3NlZCA9IGZhbHNlOwoKICAgICAg\nICBwdWJsaWMgYm9vbGVhbiBoYXNOZXh0KCkgewogICAgICAgICAgICByZXR1\ncm4gKF9jbG9zZWQpID8gZmFsc2UgOiBzdXBlci5oYXNOZXh0KCk7CiAgICAg\nICAgfQoKICAgICAgICBwdWJsaWMgT2JqZWN0IG5leHQoKSB7CiAgICAgICAg\nICAgIGlmIChfY2xvc2VkKQogICAgICAgICAgICAgICAgdGhyb3cgbmV3IE5v\nU3VjaEVsZW1lbnRFeGNlcHRpb24oKTsKICAgICAgICAgICAgcmV0dXJuIHN1\ncGVyLm5leHQoKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyB2b2lkIHJl\nbW92ZSgpIHsKICAgICAgICAgICAgdGhyb3cgbmV3IFVuc3VwcG9ydGVkT3Bl\ncmF0aW9uRXhjZXB0aW9uKCk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMg\ndm9pZCBzZXRSZW1vdmVPbkNsb3NlKEV4dGVudEltcGwgZXh0ZW50KSB7CiAg\nICAgICAgICAgIF9leHRlbnQgPSBleHRlbnQ7CiAgICAgICAgfQoKICAgICAg\nICBwdWJsaWMgdm9pZCBjbG9zZSgpCiAgICAgICAgICAgIHRocm93cyBFeGNl\ncHRpb24gewogICAgICAgICAgICBpZiAoX2V4dGVudCAhPSBudWxsICYmIF9l\neHRlbnQuX29wZW5JdHJzICE9IG51bGwpIHsKICAgICAgICAgICAgICAgIF9l\neHRlbnQubG9jaygpOwogICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAg\nICAgICAgICAgICBfZXh0ZW50Ll9vcGVuSXRycy5yZW1vdmUodGhpcyk7CiAg\nICAgICAgICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICAgICAgICAg\nIF9leHRlbnQudW5sb2NrKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAg\nICAgIH0KCiAgICAgICAgICAgIF9jbG9zZWQgPSB0cnVlOwogICAgICAgICAg\nICBmb3IgKEl0ZXJhdG9yIGl0ciA9IGdldEl0ZXJhdG9ycygpLml0ZXJhdG9y\nKCk7IGl0ci5oYXNOZXh0KCk7KQogICAgICAgICAgICAgICAgKChDbG9zZWFi\nbGUpIGl0ci5uZXh0KCkpLmNsb3NlKCk7CiAgICAgICAgfQogICAgfQoKICAg\nIC8qKgogICAgICoge0BsaW5rIEZpbHRlckl0ZXJhdG9yfSB0aGF0IHNraXBz\nIGRlbGV0ZWQgb2JqZWN0cy4KICAgICAqLwogICAgcHJpdmF0ZSBzdGF0aWMg\nY2xhc3MgRmlsdGVyRGVsZXRlZEl0ZXJhdG9yCiAgICAgICAgZXh0ZW5kcyBG\naWx0ZXJJdGVyYXRvcgogICAgICAgIGltcGxlbWVudHMgQ2xvc2VhYmxlSXRl\ncmF0b3IsIFByZWRpY2F0ZSB7CgogICAgICAgIHByaXZhdGUgRXh0ZW50SW1w\nbCBfZXh0ZW50ID0gbnVsbDsKICAgICAgICBwcml2YXRlIGJvb2xlYW4gX2Ns\nb3NlZCA9IGZhbHNlOwoKICAgICAgICBwdWJsaWMgRmlsdGVyRGVsZXRlZEl0\nZXJhdG9yKEl0ZXJhdG9yIGl0cikgewogICAgICAgICAgICBzdXBlcihpdHIp\nOwogICAgICAgICAgICBzZXRQcmVkaWNhdGUodGhpcyk7CiAgICAgICAgfQoK\nICAgICAgICBwdWJsaWMgYm9vbGVhbiBoYXNOZXh0KCkgewogICAgICAgICAg\nICByZXR1cm4gKF9jbG9zZWQpID8gZmFsc2UgOiBzdXBlci5oYXNOZXh0KCk7\nCiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgT2JqZWN0IG5leHQoKSB7CiAg\nICAgICAgICAgIGlmIChfY2xvc2VkKQogICAgICAgICAgICAgICAgdGhyb3cg\nbmV3IE5vU3VjaEVsZW1lbnRFeGNlcHRpb24oKTsKICAgICAgICAgICAgcmV0\ndXJuIHN1cGVyLm5leHQoKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyB2\nb2lkIHJlbW92ZSgpIHsKICAgICAgICAgICAgdGhyb3cgbmV3IFVuc3VwcG9y\ndGVkT3BlcmF0aW9uRXhjZXB0aW9uKCk7CiAgICAgICAgfQoKICAgICAgICBw\ndWJsaWMgdm9pZCBzZXRSZW1vdmVPbkNsb3NlKEV4dGVudEltcGwgZXh0ZW50\nKSB7CiAgICAgICAgICAgIF9leHRlbnQgPSBleHRlbnQ7CiAgICAgICAgfQoK\nICAgICAgICBwdWJsaWMgdm9pZCBjbG9zZSgpCiAgICAgICAgICAgIHRocm93\ncyBFeGNlcHRpb24gewogICAgICAgICAgICBpZiAoX2V4dGVudCAhPSBudWxs\nICYmIF9leHRlbnQuX29wZW5JdHJzICE9IG51bGwpIHsKICAgICAgICAgICAg\nICAgIF9leHRlbnQubG9jaygpOwogICAgICAgICAgICAgICAgdHJ5IHsKICAg\nICAgICAgICAgICAgICAgICBfZXh0ZW50Ll9vcGVuSXRycy5yZW1vdmUodGhp\ncyk7CiAgICAgICAgICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICAg\nICAgICAgIF9leHRlbnQudW5sb2NrKCk7CiAgICAgICAgICAgICAgICB9CiAg\nICAgICAgICAgIH0KCiAgICAgICAgICAgIF9jbG9zZWQgPSB0cnVlOwogICAg\nICAgICAgICAoKENsb3NlYWJsZSkgZ2V0SXRlcmF0b3IoKSkuY2xvc2UoKTsK\nICAgICAgICB9CgogICAgICAgIHB1YmxpYyBib29sZWFuIGV2YWx1YXRlKE9i\namVjdCBvKSB7CiAgICAgICAgICAgIHJldHVybiAhX2V4dGVudC5fYnJva2Vy\nLmlzRGVsZXRlZChvKTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAg\nKiBJdGVyYXRvciBvdmVyIGFsbCBuZXcgb2JqZWN0cyBpbiB0aGlzIGV4dGVu\ndC4gVGhpcyBpdGVyYXRvciBpcyBhbHdheXMKICAgICAqIHdyYXBwZWQsIHNv\nIGl0IGRvZXNuJ3QgbmVlZCB0byBrZWVwIHRyYWNrIG9mIHdoZXRoZXIgaXQn\ncyBjbG9zZWQuCiAgICAgKi8KICAgIHByaXZhdGUgY2xhc3MgRmlsdGVyTmV3\nSXRlcmF0b3IKICAgICAgICBleHRlbmRzIEZpbHRlckl0ZXJhdG9yCiAgICAg\nICAgaW1wbGVtZW50cyBDbG9zZWFibGUsIFByZWRpY2F0ZSB7CgogICAgICAg\nIHB1YmxpYyBGaWx0ZXJOZXdJdGVyYXRvcigpIHsKICAgICAgICAgICAgc3Vw\nZXIoX2Jyb2tlci5nZXRUcmFuc2FjdGlvbmFsT2JqZWN0cygpLml0ZXJhdG9y\nKCkpOwogICAgICAgICAgICBzZXRQcmVkaWNhdGUodGhpcyk7CiAgICAgICAg\nfQoKICAgICAgICBwdWJsaWMgdm9pZCBjbG9zZSgpIHsKICAgICAgICB9Cgog\nICAgICAgIHB1YmxpYyBib29sZWFuIGV2YWx1YXRlKE9iamVjdCBvKSB7CiAg\nICAgICAgICAgIGlmICghX2Jyb2tlci5pc05ldyhvKSkKICAgICAgICAgICAg\nICAgIHJldHVybiBmYWxzZTsKCiAgICAgICAgICAgIENsYXNzIHR5cGUgPSBv\nLmdldENsYXNzKCk7CiAgICAgICAgICAgIGlmICghX3N1YnMgJiYgdHlwZSAh\nPSBfdHlwZSkKICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAg\nICAgICAgaWYgKF9zdWJzICYmICFfdHlwZS5pc0Fzc2lnbmFibGVGcm9tKHR5\ncGUpKQogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAg\nICByZXR1cm4gdHJ1ZTsKCQl9Cgl9Cn0K\n","encoding":"base64"}

