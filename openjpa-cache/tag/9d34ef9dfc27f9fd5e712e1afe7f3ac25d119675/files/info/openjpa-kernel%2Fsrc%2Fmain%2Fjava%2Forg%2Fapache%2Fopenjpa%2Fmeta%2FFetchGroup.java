{"sha":"22cc0c736135c53610c163baa098d22a3d6ce901","node_id":"MDQ6QmxvYjIwNjM2NDoyMmNjMGM3MzYxMzVjNTM2MTBjMTYzYmFhMDk4ZDIyYTNkNmNlOTAx","size":12259,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/22cc0c736135c53610c163baa098d22a3d6ce901","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YTsKCmltcG9ydCBqYXZh\nLmlvLlNlcmlhbGl6YWJsZTsKaW1wb3J0IGphdmEudXRpbC5BcnJheUxpc3Q7\nCmltcG9ydCBqYXZhLnV0aWwuQ29sbGVjdGlvbnM7CmltcG9ydCBqYXZhLnV0\naWwuSGFzaE1hcDsKaW1wb3J0IGphdmEudXRpbC5IYXNoU2V0OwppbXBvcnQg\namF2YS51dGlsLkl0ZXJhdG9yOwppbXBvcnQgamF2YS51dGlsLkxpc3Q7Cmlt\ncG9ydCBqYXZhLnV0aWwuTWFwOwppbXBvcnQgamF2YS51dGlsLlNldDsKCmlt\ncG9ydCBvcmcuYXBhY2hlLmNvbW1vbnMubGFuZy5TdHJpbmdVdGlsczsKaW1w\nb3J0IG9yZy5hcGFjaGUuY29tbW9ucy5sYW5nLk9iamVjdFV0aWxzOwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51dGlsLkxvY2FsaXplcjsKaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLk1ldGFEYXRhRXhjZXB0aW9u\nOwppbXBvcnQgc2VycC51dGlsLk51bWJlcnM7CgovKioKICogQ2FwdHVyZXMg\nZmV0Y2ggZ3JvdXAgbWV0YWRhdGEuCiAqLwpwdWJsaWMgY2xhc3MgRmV0Y2hH\ncm91cCAKICAgIGltcGxlbWVudHMgU2VyaWFsaXphYmxlIHsKCiAgICAvKioK\nICAgICAqIE5hbWUgb2YgdGhlIGRlZmF1bHQgZmV0Y2ggZ3JvdXAuCiAgICAg\nKi8KICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgU3RyaW5nIE5BTUVfREVGQVVM\nVCA9ICJkZWZhdWx0IjsKCiAgICAvKioKICAgICAqIE5hbWUgb2YgdGhlICJh\nbGwiIGZldGNoIGdyb3VwLgogICAgICovCiAgICBwdWJsaWMgc3RhdGljIGZp\nbmFsIFN0cmluZyBOQU1FX0FMTCA9ICJhbGwiOwoKICAgIC8qKgogICAgICog\nRGVmYXVsdCBmaWVsZCByZWN1cnNpb24gZGVwdGguCiAgICAgKi8KICAgIHB1\nYmxpYyBzdGF0aWMgZmluYWwgaW50IFJFQ1VSU0lPTl9ERVBUSF9ERUZBVUxU\nID0gMTsKCiAgICAvKioKICAgICAqIEluZmluaXRlIGRlcHRoLgogICAgICov\nCglwdWJsaWMgc3RhdGljIGZpbmFsIGludCBERVBUSF9JTkZJTklURSA9IC0x\nOwoKICAgIC8qKgogICAgICogIFN0YW5kYXJkIGRlZmF1bHQgZmV0Y2ggZ3Jv\ndXAuCiAgICAgKi8KICAgIHN0YXRpYyBmaW5hbCBGZXRjaEdyb3VwIERFRkFV\nTFQgPSBuZXcgRmV0Y2hHcm91cChOQU1FX0RFRkFVTFQsIHRydWUpOwoKICAg\nIC8qKgogICAgICogIFN0YW5kYXJkICJhbGwiIGZldGNoIGdyb3VwLgogICAg\nICovCiAgICBzdGF0aWMgZmluYWwgRmV0Y2hHcm91cCBBTEwgPSBuZXcgRmV0\nY2hHcm91cChOQU1FX0FMTCwgZmFsc2UpOwoKICAgIHByaXZhdGUgc3RhdGlj\nIGZpbmFsIExvY2FsaXplciBfbG9jID0gTG9jYWxpemVyLmZvclBhY2thZ2UK\nICAgICAgICAoRmV0Y2hHcm91cC5jbGFzcyk7CgogICAgcHJpdmF0ZSBmaW5h\nbCBTdHJpbmcgX25hbWU7CiAgICBwcml2YXRlIGZpbmFsIENsYXNzTWV0YURh\ndGEgX21ldGE7CiAgICBwcml2YXRlIGZpbmFsIGJvb2xlYW4gX3JlYWRPbmx5\nOwogICAgcHJpdmF0ZSBMaXN0IF9pbmNsdWRlczsKICAgIHByaXZhdGUgU2V0\nICBfY29udGFpbmVkQnk7CiAgICBwcml2YXRlIE1hcCBfZGVwdGhzOwogICAg\ncHJpdmF0ZSBCb29sZWFuIF9wb3N0TG9hZDsKCiAgICAvKioKICAgICAqIENv\nbnN0cnVjdG9yOyBzdXBwbHkgaW1tdXRhYmxlIG5hbWUuCiAgICAgKgogICAg\nICogQHBhcmFtIG5hbWUgbXVzdCBub3QgYnkgbnVsbCBvciBlbXB0eS4KICAg\nICAqLwogICAgRmV0Y2hHcm91cChDbGFzc01ldGFEYXRhIGNtLCBTdHJpbmcg\nbmFtZSkgewogICAgICAgIF9tZXRhID0gY207CiAgICAgICAgX25hbWUgPSBu\nYW1lOwogICAgICAgIF9yZWFkT25seSA9IGZhbHNlOwogICAgfQoKICAgIC8q\nKgogICAgICogSW50ZXJuYWwgY29uc3RydWN0b3IgZm9yIGJ1aWx0aW4gZmV0\nY2ggZ3JvdXBzLgogICAgICovCiAgICBwcml2YXRlIEZldGNoR3JvdXAoU3Ry\naW5nIG5hbWUsIGJvb2xlYW4gcG9zdExvYWQpIHsKICAgICAgICBfbWV0YSA9\nIG51bGw7CiAgICAgICAgX25hbWUgPSBuYW1lOwogICAgICAgIF9wb3N0TG9h\nZCA9IChwb3N0TG9hZCkgPyBCb29sZWFuLlRSVUUgOiBCb29sZWFuLkZBTFNF\nOwogICAgICAgIF9yZWFkT25seSA9IHRydWU7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBDb3B5IHN0YXRlIGZyb20gdGhlIGdpdmVuIGZldGNoIGdyb3VwLgog\nICAgICovCiAgICB2b2lkIGNvcHkoRmV0Y2hHcm91cCBmZykgewogICAgICAg\nIGlmIChmZy5faW5jbHVkZXMgIT0gbnVsbCkKICAgICAgICAgICAgZm9yIChJ\ndGVyYXRvciBpdHIgPSBmZy5faW5jbHVkZXMuaXRlcmF0b3IoKTsgaXRyLmhh\nc05leHQoKTspCiAgICAgICAgICAgICAgICBhZGREZWNsYXJlZEluY2x1ZGUo\nKFN0cmluZykgaXRyLm5leHQoKSk7CiAgICAgICAgaWYgKGZnLl9jb250YWlu\nZWRCeSAhPSBudWxsKSAKICAgICAgICAJdGhpcy5fY29udGFpbmVkQnkgPSBu\nZXcgSGFzaFNldChmZy5fY29udGFpbmVkQnkpOwogICAgICAgIAogICAgICAg\nIGlmIChmZy5fZGVwdGhzICE9IG51bGwpIHsKICAgICAgICAgICAgTWFwLkVu\ndHJ5IGVudHJ5OwogICAgICAgICAgICBmb3IgKEl0ZXJhdG9yIGl0ciA9IGZn\nLl9kZXB0aHMuZW50cnlTZXQoKS5pdGVyYXRvcigpOyAKICAgICAgICAgICAg\nICAgIGl0ci5oYXNOZXh0KCk7KSB7CiAgICAgICAgICAgICAgICBlbnRyeSA9\nIChNYXAuRW50cnkpIGl0ci5uZXh0KCk7CiAgICAgICAgICAgICAgICBzZXRS\nZWN1cnNpb25EZXB0aCgoRmllbGRNZXRhRGF0YSkgZW50cnkuZ2V0S2V5KCks\nICgoTnVtYmVyKSAKICAgICAgICAgICAgICAgICAgICBlbnRyeS5nZXRWYWx1\nZSgpKS5pbnRWYWx1ZSgpKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAg\nICAgICBpZiAoZmcuX3Bvc3RMb2FkICE9IG51bGwpCiAgICAgICAgICAgIF9w\nb3N0TG9hZCA9IGZnLl9wb3N0TG9hZDsKICAgIH0KCiAgICAvKioKICAgICAq\nIEZldGNoIGdyb3VwIG5hbWUuCiAgICAgKi8KICAgIHB1YmxpYyBTdHJpbmcg\nZ2V0TmFtZSgpIHsKICAgICAgICByZXR1cm4gX25hbWU7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBJbmNsdWRlcyBnaXZlbiBmZXRjaCBncm91cCB3aXRoaW4g\ndGhpcyByZWNlaXZlci4KICAgICAqLwogICAgcHVibGljIHZvaWQgYWRkRGVj\nbGFyZWRJbmNsdWRlKFN0cmluZyBmZ05hbWUpIHsKICAgICAgICBpZiAoX3Jl\nYWRPbmx5KQogICAgICAgICAgICB0aHJvdyBuZXcgVW5zdXBwb3J0ZWRPcGVy\nYXRpb25FeGNlcHRpb24oKTsKICAgICAgICBpZiAoU3RyaW5nVXRpbHMuaXNF\nbXB0eShmZ05hbWUpKQogICAgICAgICAgICB0aHJvdyBuZXcgTWV0YURhdGFF\neGNlcHRpb24oX2xvYy5nZXQoIm51bGwtaW5jbHVkZS1mZyIsIHRoaXMpKTsK\nICAgICAgICBpZiAoX2luY2x1ZGVzID09IG51bGwpCiAgICAgICAgICAgIF9p\nbmNsdWRlcyA9IG5ldyBBcnJheUxpc3QoKTsKICAgICAgICBpZiAoIV9pbmNs\ndWRlcy5jb250YWlucyhmZ05hbWUpKQogICAgICAgICAgICBfaW5jbHVkZXMu\nYWRkKGZnTmFtZSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBBZmZpcm1zIGlm\nIGdpdmVuIGZldGNoIGdyb3VwIGlzIGluY2x1ZGVkIGJ5IHRoaXMgcmVjZWl2\nZXIuICBJbmNsdWRlcwogICAgICogc3VwZXJjbGFzcyBkZWZpbml0aW9uIG9m\nIGZldGNoIGdyb3VwIGFuZCBvcHRpb25hbGx5IG90aGVyIGluY2x1ZGVkIAog\nICAgICogZ3JvdXBzLgogICAgICoKICAgICAqIEBwYXJhbSByZWN1cnNlIGlm\nIHRydWUgdGhlbiByZWN1cnNpdmVseSBjaGVja3Mgd2l0aGluIHRoZSBpbmNs\ndWRlZAogICAgICogZmVjdGggZ3JvdXBzCiAgICAgKi8KICAgIHB1YmxpYyBi\nb29sZWFuIGluY2x1ZGVzKFN0cmluZyBmZ05hbWUsIGJvb2xlYW4gcmVjdXJz\nZSkgewogICAgICAgIC8vIGNoZWNrIG91ciBpbmNsdWRlcwogICAgICAgIGlm\nIChfaW5jbHVkZXMgIT0gbnVsbCkgewogICAgICAgICAgICBpZiAoX2luY2x1\nZGVzLmNvbnRhaW5zKGZnTmFtZSkpCiAgICAgICAgICAgICAgICByZXR1cm4g\ndHJ1ZTsKICAgICAgICAgICAgaWYgKHJlY3Vyc2UgJiYgX21ldGEhPW51bGwp\nIHsKICAgICAgICAgICAgICAgIEZldGNoR3JvdXAgZmc7CiAgICAgICAgICAg\nICAgICBmb3IgKEl0ZXJhdG9yIGkgPSBfaW5jbHVkZXMuaXRlcmF0b3IoKTsg\naS5oYXNOZXh0KCk7KSB7CiAgICAgICAgICAgICAgICAgICAgZmcgPSBfbWV0\nYS5nZXRGZXRjaEdyb3VwKChTdHJpbmcpIGkubmV4dCgpKTsKICAgICAgICAg\nICAgICAgICAgICBpZiAoZmcgIT0gbnVsbCAmJiBmZy5pbmNsdWRlcyhmZ05h\nbWUsIHRydWUpKQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1\nZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0K\nICAgICAgICBpZiAoX21ldGEgIT0gbnVsbCkgewogICAgICAgICAgICAvLyBj\naGVjayBzdXBlcmNsYXNzIGluY2x1ZGVzCiAgICAgICAgICAgIENsYXNzTWV0\nYURhdGEgc3VwID0gX21ldGEuZ2V0UENTdXBlcmNsYXNzTWV0YURhdGEoKTsK\nICAgICAgICAgICAgaWYgKHN1cCAhPSBudWxsKSB7CiAgICAgICAgICAgICAg\nICBGZXRjaEdyb3VwIHN1cEZHID0gc3VwLmdldEZldGNoR3JvdXAoX25hbWUp\nOwogICAgICAgICAgICAgICAgaWYgKHN1cEZHICE9IG51bGwpCiAgICAgICAg\nICAgICAgICAgICAgcmV0dXJuIHN1cEZHLmluY2x1ZGVzKGZnTmFtZSwgcmVj\ndXJzZSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJu\nIGZhbHNlOwogICAgfQogICAgCiAgICAvKioKICAgICAqIEFkZHMgdGhpcyBy\nZWNlaXZlciBhcyBvbmUgb2YgdGhlIGluY2x1ZGVkIGZldGNoIGdyb3VwcyBv\nZiB0aGUgZ2l2ZW4KICAgICAqIHBhcmVudC4gCiAgICAgKiBUaGUgcGFyZW50\nIGZlY3RoIGdyb3VwIHdpbGwgaW5jbHVkZSB0aGlzIHJlY2VpdmVyIGFzIGEg\nc2lkZS1lZmZlY3Qgb2YKICAgICAqIHRoaXMgY2FsbC4KICAgICAqIAogICAg\nICogQHNlZSAjaW5jbHVkZXMoU3RyaW5nLCBib29sZWFuKQogICAgICogQHNl\nZSAjYWRkRGVjbGFyZWRJbmNsdWRlKFN0cmluZykgCiAgICAgKiAKICAgICAq\nIEByZXR1cm4gdHJ1ZSBpZiBnaXZlbiBwYXJlbnQgaXMgYSBuZXcgYWRkaXRp\nb24uIGZhbHNlIG90aHJ3aXNlLgogICAgICogQHNpbmNlIDEuMS4wCiAgICAg\nKi8KICAgIHB1YmxpYyBib29sZWFuIGFkZENvbnRhaW5lZEJ5KEZldGNoR3Jv\ndXAgcGFyZW50KSB7CiAgICAJcGFyZW50LmFkZERlY2xhcmVkSW5jbHVkZSh0\naGlzLmdldE5hbWUoKSk7CiAgICAJaWYgKF9jb250YWluZWRCeT09bnVsbCkK\nICAgIAkJX2NvbnRhaW5lZEJ5ID0gbmV3IEhhc2hTZXQoKTsKICAgIAlyZXR1\ncm4gX2NvbnRhaW5lZEJ5LmFkZChwYXJlbnQuZ2V0TmFtZSgpKTsKICAgIH0K\nICAgIAogICAgLyoqCiAgICAgKiBHZXRzIHRoZSBuYW1lIG9mIHRoZSBmZXRj\naCBncm91cHMgaW4gd2hpY2ggdGhpcyByZWNlaXZlciBoYXMgYmVlbgogICAg\nICogaW5jbHVkZWQuCiAgICAgKiAKICAgICAqIEBzZWUgI2FkZENvbnRhaW5l\nZEJ5KEZldGNoR3JvdXApCiAgICAgKiBAc2luY2UgMS4xLjAKICAgICAqLwog\nICAgcHVibGljIFNldCBnZXRDb250YWluZWRCeSgpIHsKICAgIAlyZXR1cm4g\nKF9jb250YWluZWRCeSA9PSBudWxsKSA/IENvbGxlY3Rpb25zLkVNUFRZX1NF\nVCA6CiAgICAgICAgICAgIENvbGxlY3Rpb25zLnVubW9kaWZpYWJsZVNldChf\nY29udGFpbmVkQnkpOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRo\nZSBmZXRjaCBncm91cCBuYW1lcyBkZWNsYXJlZCBpbmNsdWRlZCBieSB0aGlz\nIGdyb3VwLgogICAgICovCiAgICBwdWJsaWMgU3RyaW5nW10gZ2V0RGVjbGFy\nZWRJbmNsdWRlcygpIHsKICAgICAgICAvLyBvbmx5IHVzZWQgZHVyaW5nIHNl\ncmlhbGl6YXRpb247IG5vIG5lZWQgdG8gY2FjaGUKICAgICAgICByZXR1cm4g\nKF9pbmNsdWRlcyA9PSBudWxsKSA/IG5ldyBTdHJpbmdbMF0KICAgICAgICAg\nICAgOiAoU3RyaW5nW10pIF9pbmNsdWRlcy50b0FycmF5KG5ldyBTdHJpbmdb\nX2luY2x1ZGVzLnNpemUoKV0pOwogICAgfQoKICAgIC8qKgogICAgICogUmVj\ndXJzaW9uIGRlcHRoIGZvciB0aGUgZ2l2ZW4gZmllbGQuICBUaGlzIGlzIHRo\nZSBkZXB0aCBvZiByZWxhdGlvbnMgb2YKICAgICAqIHRoZSBzYW1lIGNsYXNz\nIGFzIHRoaXMgb25lIHdlIGNhbiBmZXRjaCB0aHJvdWdoIHRoZSBnaXZlbiBm\naWVsZC4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0UmVjdXJzaW9uRGVw\ndGgoRmllbGRNZXRhRGF0YSBmbSwgaW50IGRlcHRoKSB7CiAgICAgICAgaWYg\nKF9yZWFkT25seSkKICAgICAgICAgICAgdGhyb3cgbmV3IFVuc3VwcG9ydGVk\nT3BlcmF0aW9uRXhjZXB0aW9uKCk7CiAgICAgICAgaWYgKGRlcHRoIDwgLTEp\nCiAgICAgICAgICAgIHRocm93IG5ldyBNZXRhRGF0YUV4Y2VwdGlvbihfbG9j\nLmdldCgiaW52YWxpZC1mZy1kZXB0aCIsIF9uYW1lLCBmbSwgCiAgICAgICAg\nICAgICAgICBOdW1iZXJzLnZhbHVlT2YoZGVwdGgpKSk7CiAgICAgICAgaWYg\nKF9kZXB0aHMgPT0gbnVsbCkKICAgICAgICAgICAgX2RlcHRocyA9IG5ldyBI\nYXNoTWFwKCk7CiAgICAgICAgX2RlcHRocy5wdXQoZm0sIE51bWJlcnMudmFs\ndWVPZihkZXB0aCkpOwogICAgfQoKICAgIC8qKgogICAgICogUmVjdXJzaW9u\nIGRlcHRoIGZvciB0aGUgZ2l2ZW4gZmllbGQuICBUaGlzIGlzIHRoZSBkZXB0\naCBvZiByZWxhdGlvbnMgb2YKICAgICAqIHRoZSBzYW1lIGNsYXNzIGFzIHRo\naXMgb25lIHdlIGNhbiBmZXRjaCB0aHJvdWdoIHRoZSBnaXZlbiBmaWVsZC4K\nICAgICAqLwogICAgcHVibGljIGludCBnZXRSZWN1cnNpb25EZXB0aChGaWVs\nZE1ldGFEYXRhIGZtKSB7CiAgICAgICAgTnVtYmVyIGRlcHRoID0gZmluZFJl\nY3Vyc2lvbkRlcHRoKGZtKTsKICAgICAgICByZXR1cm4gKGRlcHRoID09IG51\nbGwpID8gUkVDVVJTSU9OX0RFUFRIX0RFRkFVTFQgOiBkZXB0aC5pbnRWYWx1\nZSgpOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRoZSByZWN1cnNp\nb24gZGVwdGggZGVjbGFyZWQgZm9yIHRoZSBnaXZlbiBmaWVsZCwgb3IgCiAg\nICAgKiAwIGlmIG5vbmUuCiAgICAgKi8KICAgIHB1YmxpYyBpbnQgZ2V0RGVj\nbGFyZWRSZWN1cnNpb25EZXB0aChGaWVsZE1ldGFEYXRhIGZtKSB7CiAgICAg\nICAgTnVtYmVyIGRlcHRoID0gKF9kZXB0aHMgPT0gbnVsbCkgPyBudWxsIDog\nKE51bWJlcikgX2RlcHRocy5nZXQoZm0pOwogICAgICAgIHJldHVybiAoZGVw\ndGggPT0gbnVsbCkgPyAwIDogZGVwdGguaW50VmFsdWUoKTsKICAgIH0KCiAg\nICAvKioKICAgICAqIEhlbHBlciB0byBmaW5kIHJlY3Vyc2lvbiBkZXB0aCBy\nZWN1cnNpdmVseSBpbiBvdXIgaW5jbHVkZXMuCiAgICAgKi8KICAgIHByaXZh\ndGUgTnVtYmVyIGZpbmRSZWN1cnNpb25EZXB0aChGaWVsZE1ldGFEYXRhIGZt\nKSB7IAogICAgICAgIE51bWJlciBkZXB0aCA9IChfZGVwdGhzID09IG51bGwp\nID8gbnVsbCA6IChOdW1iZXIpIF9kZXB0aHMuZ2V0KGZtKTsKICAgICAgICBp\nZiAoZGVwdGggIT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIGRlcHRoOwoK\nICAgICAgICAvLyBjaGVjayBmb3Igc3VwZXJjbGFzcyBkZWNsYXJhdGlvbiBv\nZiBkZXB0aAogICAgICAgIE51bWJlciBtYXggPSBudWxsOwogICAgICAgIGlm\nIChfbWV0YSAhPSBudWxsICYmIGZtLmdldERlY2xhcmluZ01ldGFEYXRhKCkg\nIT0gX21ldGEpIHsKICAgICAgICAgICAgQ2xhc3NNZXRhRGF0YSBzdXAgPSBf\nbWV0YS5nZXRQQ1N1cGVyY2xhc3NNZXRhRGF0YSgpOwogICAgICAgICAgICBp\nZiAoc3VwICE9IG51bGwpIHsKICAgICAgICAgICAgICAgIEZldGNoR3JvdXAg\nc3VwRkcgPSBzdXAuZ2V0RmV0Y2hHcm91cChfbmFtZSk7CiAgICAgICAgICAg\nICAgICBpZiAoc3VwRkcgIT0gbnVsbCkKICAgICAgICAgICAgICAgICAgICBt\nYXggPSBzdXBGRy5maW5kUmVjdXJzaW9uRGVwdGgoZm0pOwogICAgICAgICAg\nICB9CiAgICAgICAgfQogICAgICAgIGlmIChfaW5jbHVkZXMgPT0gbnVsbCkK\nICAgICAgICAgICAgcmV0dXJuIG1heDsKCiAgICAgICAgLy8gZmluZCBsYXJn\nZXN0IGluY2x1ZGVkIGRlcHRoCiAgICAgICAgRmV0Y2hHcm91cCBmZzsKICAg\nICAgICBmb3IgKEl0ZXJhdG9yIGl0ciA9IF9pbmNsdWRlcy5pdGVyYXRvcigp\nOyBpdHIuaGFzTmV4dCgpOykgewogICAgICAgICAgICBmZyA9IF9tZXRhLmdl\ndEZldGNoR3JvdXAoKFN0cmluZykgaXRyLm5leHQoKSk7CiAgICAgICAgICAg\nIGRlcHRoID0gKGZnID09IG51bGwpID8gbnVsbCA6IGZnLmZpbmRSZWN1cnNp\nb25EZXB0aChmbSk7CiAgICAgICAgICAgIGlmIChkZXB0aCAhPSBudWxsICYm\nIChtYXggPT0gbnVsbCAKICAgICAgICAgICAgICAgIHx8IGRlcHRoLmludFZh\nbHVlKCkgPiBtYXguaW50VmFsdWUoKSkpCiAgICAgICAgICAgICAgICBtYXgg\nPSBkZXB0aDsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIG1heDsKICAgIH0K\nCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgZmllbGRzIHdpdGggZGVjbGFy\nZWQgcmVjdXJzaW9uIGRlcHRocyBpbiB0aGlzIGdyb3VwLgogICAgICovCiAg\nICBwdWJsaWMgRmllbGRNZXRhRGF0YVtdIGdldERlY2xhcmVkUmVjdXJzaW9u\nRGVwdGhGaWVsZHMoKSB7CiAgICAgICAgLy8gdXNlZCBpbiBzZXJpYWxpemF0\naW9uIG9ubHk7IG5vIG5lZWQgdG8gY2FjaGUKICAgICAgICBpZiAoX2RlcHRo\ncyA9PSBudWxsKQogICAgICAgICAgICByZXR1cm4gbmV3IEZpZWxkTWV0YURh\ndGFbMF07CiAgICAgICAgIHJldHVybiAoRmllbGRNZXRhRGF0YVtdKSBfZGVw\ndGhzLmtleVNldCgpLnRvQXJyYXkKICAgICAgICAgICAgKG5ldyBGaWVsZE1l\ndGFEYXRhW19kZXB0aHMuc2l6ZSgpXSk7CiAgICB9IAoKICAgIC8qKgogICAg\nICogV2hldGhlciBsb2FkaW5nIHRoaXMgZmV0Y2ggZ3JvdXAgY2F1c2VzIGEg\ncG9zdC1sb2FkIGNhbGxiYWNrIG9uIHRoZQogICAgICogbG9hZGVkIGluc3Rh\nbmNlLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRQb3N0TG9hZCAoYm9v\nbGVhbiBmbGFnKSB7CiAgICAgICAgaWYgKF9yZWFkT25seSAmJiBmbGFnICE9\nIGlzUG9zdExvYWQoKSkKICAgICAgICAgICAgdGhyb3cgbmV3IFVuc3VwcG9y\ndGVkT3BlcmF0aW9uRXhjZXB0aW9uKCk7CiAgICAJX3Bvc3RMb2FkID0gKGZs\nYWcpID8gQm9vbGVhbi5UUlVFIDogQm9vbGVhbi5GQUxTRTsKICAgIH0KCiAg\nICAvKioKICAgICAqIFdoZXRoZXIgbG9hZGluZyB0aGlzIGZldGNoIGdyb3Vw\nIGNhdXNlcyBhIHBvc3QtbG9hZCBjYWxsYmFjayBvbiB0aGUKICAgICAqIGxv\nYWRlZCBpbnN0YW5jZS4KICAgICAqLwogICAgcHVibGljIGJvb2xlYW4gaXNQ\nb3N0TG9hZCAoKSB7CiAgICAJaWYgKF9wb3N0TG9hZCAhPSBudWxsKQogICAg\nICAgICAgICByZXR1cm4gX3Bvc3RMb2FkLmJvb2xlYW5WYWx1ZSgpOwoKICAg\nICAgICBpZiAoX21ldGEgIT0gbnVsbCkgewogICAgICAgICAgICBDbGFzc01l\ndGFEYXRhIHN1cCA9IF9tZXRhLmdldFBDU3VwZXJjbGFzc01ldGFEYXRhKCk7\nCiAgICAgICAgICAgIGlmIChzdXAgIT0gbnVsbCkgewogICAgICAgICAgICAg\nICAgRmV0Y2hHcm91cCBzdXBGRyA9IHN1cC5nZXRGZXRjaEdyb3VwKF9uYW1l\nKTsKICAgICAgICAgICAgICAgIGlmIChzdXBGRyAhPSBudWxsICYmIHN1cEZH\nLmlzUG9zdExvYWQoKSkKICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1\nZTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgKF9pbmNs\ndWRlcyA9PSBudWxsKQogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAg\nICAgRmV0Y2hHcm91cCBmZzsKICAgICAgICBmb3IgKEl0ZXJhdG9yIGl0ciA9\nIF9pbmNsdWRlcy5pdGVyYXRvcigpOyBpdHIuaGFzTmV4dCgpOykgewogICAg\nICAgICAgICBmZyA9IF9tZXRhLmdldEZldGNoR3JvdXAoKFN0cmluZykgaXRy\nLm5leHQoKSk7CiAgICAgICAgICAgIGlmIChmZyAhPSBudWxsICYmIGZnLmlz\nUG9zdExvYWQoKSkKICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAg\nICAgIH0KICAgICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBXaGV0aGVyIHRoZSBwb3N0LWxvYWQgdmFsdWUgaXMgZGVjbGFyZWQg\nZm9yIHRoaXMgZ3JvdXAuICAKICAgICAqLwogICAgcHVibGljIGJvb2xlYW4g\naXNQb3N0TG9hZEV4cGxpY2l0KCkgewogICAgICAgIHJldHVybiBfcG9zdExv\nYWQgIT0gbnVsbDsKICAgIH0KCiAgICAvKioKICAgICAqIFJlc29sdmUgYW5k\nIHZhbGlkYXRlIGZldGNoIGdyb3VwIG1ldGFkYXRhLgogICAgICovCiAgICBw\ndWJsaWMgdm9pZCByZXNvbHZlKCkgewogICAgICAgIGlmIChfaW5jbHVkZXMg\nPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuOwoKICAgICAgICAvLyB2YWxp\nZGF0ZSBpbmNsdWRlcwogICAgICAgIFN0cmluZyBuYW1lOwogICAgICAgIEZl\ndGNoR3JvdXAgZmc7CiAgICAgICAgZm9yIChJdGVyYXRvciBpdHIgPSBfaW5j\nbHVkZXMuaXRlcmF0b3IoKTsgaXRyLmhhc05leHQoKTspIHsKICAgICAgICAg\nICAgbmFtZSA9IChTdHJpbmcpIGl0ci5uZXh0KCk7CiAgICAgICAgICAgIGlm\nIChuYW1lLmVxdWFscyhfbmFtZSkpCiAgICAgICAgICAgICAgICB0aHJvdyBu\nZXcgTWV0YURhdGFFeGNlcHRpb24oX2xvYy5nZXQoImN5Y2xpYy1mZyIsIHRo\naXMsIG5hbWUpKTsKICAgICAgICAgICAgZmcgPSBfbWV0YS5nZXRGZXRjaEdy\nb3VwKG5hbWUpOwogICAgICAgICAgICBpZiAoZmcgPT0gbnVsbCkKICAgICAg\nICAgICAgICAgIHRocm93IG5ldyBNZXRhRGF0YUV4Y2VwdGlvbihfbG9jLmdl\ndCgiYmFkLWZnLWluY2x1ZGUiLCB0aGlzLAogICAgICAgICAgICAgICAgICAg\nIG5hbWUpKTsKICAgICAgICAgICAgaWYgKGZnLmluY2x1ZGVzKF9uYW1lLCB0\ncnVlKSkKICAgICAgICAgICAgICAgIHRocm93IG5ldyBNZXRhRGF0YUV4Y2Vw\ndGlvbihfbG9jLmdldCgiY3ljbGljLWZnIiwgdGhpcywgbmFtZSkpOwogICAg\nICAgIH0KICAgIH0KICAgIAogICAgLyoqCiAgICAgKiBBZmZpcm1zIGVxdWFs\naXR5IGlmIHRoZSBvdGhlciBoYXMgdGhlIHNhbWUgbmFtZSBhbmQgZGVjbGFy\naW5nIHR5cGUuCiAgICAgKi8KICAgIHB1YmxpYyBib29sZWFuIGVxdWFscyhP\nYmplY3Qgb3RoZXIpIHsKICAgICAgICBpZiAob3RoZXIgPT0gdGhpcykKICAg\nICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgaWYgKCEob3RoZXIgaW5z\ndGFuY2VvZiBGZXRjaEdyb3VwKSkKICAgICAgICAgICAgcmV0dXJuIGZhbHNl\nOwogICAgICAgIEZldGNoR3JvdXAgdGhhdCA9IChGZXRjaEdyb3VwKSBvdGhl\ncjsKICAgICAgICByZXR1cm4gX25hbWUuZXF1YWxzKHRoYXQuX25hbWUpCiAg\nICAgICAgICAgICYmIE9iamVjdFV0aWxzLmVxdWFscyhfbWV0YSwgdGhhdC5f\nbWV0YSk7CiAgICB9CgogICAgcHVibGljIGludCBoYXNoQ29kZSgpIHsKICAg\nICAgICByZXR1cm4gX25hbWUuaGFzaENvZGUoKSArICgoX21ldGEgPT0gbnVs\nbCkgPyAwIDogX21ldGEuaGFzaENvZGUoKSk7CiAgICB9CgogICAgcHVibGlj\nIFN0cmluZyB0b1N0cmluZygpIHsKICAgICAgICByZXR1cm4gKChfbWV0YSA9\nPSBudWxsKSA/ICJCdWlsdGluIiA6IF9tZXRhLnRvU3RyaW5nICgpKSArICIu\nIiArIF9uYW1lOwogICAgfQp9Cg==\n","encoding":"base64"}

