{"sha":"24c258087591b23bd6cbe13f6daa48e01689aecf","node_id":"MDQ6QmxvYjIwNjM2NDoyNGMyNTgwODc1OTFiMjNiZDZjYmUxM2Y2ZGFhNDhlMDE2ODlhZWNm","size":11834,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/24c258087591b23bd6cbe13f6daa48e01689aecf","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEubGliLmxvZzsKCmltcG9ydCBq\nYXZhLmlvLkZpbGU7CmltcG9ydCBqYXZhLmlvLkZpbGVPdXRwdXRTdHJlYW07\nCmltcG9ydCBqYXZhLmlvLklPRXhjZXB0aW9uOwppbXBvcnQgamF2YS5pby5Q\ncmludFN0cmVhbTsKaW1wb3J0IGphdmEuaW8uUHJpbnRXcml0ZXI7CmltcG9y\ndCBqYXZhLmlvLlN0cmluZ1dyaXRlcjsKaW1wb3J0IGphdmEuc2VjdXJpdHku\nQWNjZXNzQ29udHJvbGxlcjsKaW1wb3J0IGphdmEuc2VjdXJpdHkuUHJpdmls\nZWdlZEFjdGlvbkV4Y2VwdGlvbjsKaW1wb3J0IGphdmEudXRpbC5IYXNoTWFw\nOwppbXBvcnQgamF2YS51dGlsLkl0ZXJhdG9yOwppbXBvcnQgamF2YS51dGls\nLkxvY2FsZTsKaW1wb3J0IGphdmEudXRpbC5NYXA7CgppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLmxpYi5jb25mLkNvbmZpZ3VyYWJsZTsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5saWIuY29uZi5Db25maWd1cmF0aW9uOwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi5jb25mLkdlbmVyaWNDb25maWd1\ncmFibGU7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuRmls\nZXM7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuSjJEb1By\naXZIZWxwZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwu\nTG9jYWxpemVyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51dGls\nLk9wdGlvbnM7CmltcG9ydCBqYXZhLnV0aWwuY29uY3VycmVudC5Db25jdXJy\nZW50SGFzaE1hcDsKCi8qKgogKiBEZWZhdWx0IHtAbGluayBMb2dGYWN0b3J5\nfSBpbXBsZW1lbnRhdGlvbi4gRm9yIGVhc2Ugb2YgYXV0b21hdGljCiAqIGNv\nbmZpZ3VyYXRpb24sIHRoaXMgaW1wbGVtZW50YXRpb24ga2V5cyBvbiBvbmx5\nIHRoZSBsYXN0IGRvdC1zZXBhcmF0ZWQKICogdG9rZW4gb2YgdGhlIGxvZyBj\naGFubmVsIG5hbWUuCiAqCiAqIEBhdXRob3IgUGF0cmljayBMaW5za2V5CiAq\nLwpwdWJsaWMgY2xhc3MgTG9nRmFjdG9yeUltcGwgCiAgICBpbXBsZW1lbnRz\nIExvZ0ZhY3RvcnksIEdlbmVyaWNDb25maWd1cmFibGUsIENvbmZpZ3VyYWJs\nZSB7CgogICAgcHJpdmF0ZSBzdGF0aWMgTG9jYWxpemVyIF9sb2MgPSBMb2Nh\nbGl6ZXIuZm9yUGFja2FnZShMb2dGYWN0b3J5SW1wbC5jbGFzcyk7CiAgICBw\ncml2YXRlIHN0YXRpYyBMb2NhbGl6ZXIgX2xvY0VuID0gTG9jYWxpemVyLmZv\nclBhY2thZ2UoCiAgICAgICAgTG9nRmFjdG9yeUltcGwuY2xhc3MsIExvY2Fs\nZS5FTkdMSVNIKTsKCiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIFN0cmluZyBU\nUkFDRV9TVFIgPSBfbG9jRW4uZ2V0KCJsb2ctdHJhY2UiKS5nZXRNZXNzYWdl\nKCk7CiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIFN0cmluZyBJTkZPX1NUUiA9\nIF9sb2NFbi5nZXQoImxvZy1pbmZvIikuZ2V0TWVzc2FnZSgpOwogICAgcHVi\nbGljIHN0YXRpYyBmaW5hbCBTdHJpbmcgV0FSTl9TVFIgPSBfbG9jRW4uZ2V0\nKCJsb2ctd2FybiIpLmdldE1lc3NhZ2UoKTsKICAgIHB1YmxpYyBzdGF0aWMg\nZmluYWwgU3RyaW5nIEVSUk9SX1NUUiA9IF9sb2NFbi5nZXQoImxvZy1lcnJv\nciIpLmdldE1lc3NhZ2UoKTsKICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgU3Ry\naW5nIEZBVEFMX1NUUiA9IF9sb2NFbi5nZXQoImxvZy1mYXRhbCIpLmdldE1l\nc3NhZ2UoKTsKCiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIFN0cmluZyBTVERP\nVVQgPSAic3Rkb3V0IjsKICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgU3RyaW5n\nIFNUREVSUiA9ICJzdGRlcnIiOwoKICAgIHByaXZhdGUgc3RhdGljIGZpbmFs\nIFN0cmluZyBORVdMSU5FID0gSjJEb1ByaXZIZWxwZXIuZ2V0TGluZVNlcGFy\nYXRvcigpOwoKICAgIC8qKgogICAgICogVGhlIHRpbWUgYXQgd2hpY2ggdGhp\ncyBmYWN0b3J5IHdhcyBpbml0aWFsaXplZC4KICAgICAqLwogICAgcHJvdGVj\ndGVkIGZpbmFsIGxvbmcgaW5pdGlhbGl6YXRpb25NaWxsaXM7CgogICAgLyoq\nCiAgICAgKiBUaGUge0BsaW5rIExvZ31zIHRoYXQgdGhpcyBmYWN0b3J5IG1h\nbmFnZXMsIGtleWVkIGJ5IGxvZyBjaGFubmVsIG5hbWUuCiAgICAgKi8KICAg\nIHByaXZhdGUgTWFwIF9sb2dzID0gbmV3IENvbmN1cnJlbnRIYXNoTWFwKCk7\nIC8vIDxTdHJpbmcsTG9nPgoKICAgIC8qKgogICAgICogVGhlIGRlZmF1bHQg\nbG9nZ2luZyBsZXZlbC4KICAgICAqLwogICAgcHJpdmF0ZSBzaG9ydCBfZGVm\nYXVsdExvZ0xldmVsID0gTG9nLklORk87CgogICAgLyoqCiAgICAgKiBTdG9y\nYWdlIGZvciBsb2dnaW5nIGxldmVsIGNvbmZpZ3VyYXRpb24gc3BlY2lmaWVk\nIGF0IGNvbmZpZ3VyYXRpb24gdGltZS4KICAgICAqLwogICAgcHJpdmF0ZSBN\nYXAgX2NvbmZpZ3VyZWRMZXZlbHMgPSBuZXcgSGFzaE1hcCgpOyAvLyA8U3Ry\naW5nLEludGVnZXI+CgogICAgLyoqCiAgICAgKiBUaGUgc3RyZWFtIHRvIHdy\naXRlIHRvLiBEZWZhdWx0cyB0byBTeXN0ZW0uZXJyLgogICAgICovCiAgICBw\ncml2YXRlIFByaW50U3RyZWFtIF9vdXQgPSBTeXN0ZW0uZXJyOwoKICAgIC8q\nKgogICAgICogQSB0b2tlbiB0byBhZGQgdG8gYWxsIGxvZyBtZXNzYWdlcy4g\nSWYgPGNvZGU+bnVsbDwvY29kZT4sIHRoZSAKICAgICAqIGNvbmZpZ3VyYXRp\nb24ncyBpZCB3aWxsIGJlIHVzZWQuCiAgICAgKi8KICAgIHByaXZhdGUgU3Ry\naW5nIF9kaWFnQ29udGV4dCA9IG51bGw7CiAgICBwcml2YXRlIGJvb2xlYW4g\nX2RpYWdDb250ZXh0Q29tcHV0ZWQgPSBmYWxzZTsKICAgIAogICAgcHJpdmF0\nZSBDb25maWd1cmF0aW9uIF9jb25mOwoKCiAgICBwdWJsaWMgTG9nRmFjdG9y\neUltcGwoKSB7CiAgICAgICAgaW5pdGlhbGl6YXRpb25NaWxsaXMgPSBTeXN0\nZW0uY3VycmVudFRpbWVNaWxsaXMoKTsKICAgIH0KCiAgICBwdWJsaWMgTG9n\nIGdldExvZyhTdHJpbmcgY2hhbm5lbCkgewogICAgICAgIC8vIG5vIGxvY2tp\nbmc7IG9rIGlmIHNhbWUgbG9nIGNyZWF0ZWQgbXVsdGlwbGUgdGltZXMKICAg\nICAgICBMb2dJbXBsIGwgPSAoTG9nSW1wbCkgX2xvZ3MuZ2V0KGNoYW5uZWwp\nOwogICAgICAgIGlmIChsID09IG51bGwpIHsKICAgICAgICAgICAgbCA9IG5l\nd0xvZ0ltcGwoKTsKICAgICAgICAgICAgbC5zZXRDaGFubmVsKGNoYW5uZWwp\nOwogICAgICAgICAgICBTaG9ydCBsdmwgPSAoU2hvcnQpIF9jb25maWd1cmVk\nTGV2ZWxzLmdldChzaG9ydGVuKGNoYW5uZWwpKTsKICAgICAgICAgICAgbC5z\nZXRMZXZlbChsdmwgPT0gbnVsbCA/IF9kZWZhdWx0TG9nTGV2ZWwgOiBsdmwu\nc2hvcnRWYWx1ZSgpKTsKICAgICAgICAgICAgX2xvZ3MucHV0KGNoYW5uZWws\nIGwpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gbDsKICAgIH0KCiAgICAv\nKioKICAgICAqIENyZWF0ZSBhIG5ldyBsb2cuIFRoZSBsb2cgd2lsbCBiZSBj\nYWNoZWQuCiAgICAgKi8KICAgIHByb3RlY3RlZCBMb2dJbXBsIG5ld0xvZ0lt\ncGwoKSB7CiAgICAgICAgcmV0dXJuIG5ldyBMb2dJbXBsKCk7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBUaGUgc3RyaW5nIG5hbWUgb2YgdGhlIGRlZmF1bHQg\nbGV2ZWwgZm9yIHVuY29uZmlndXJlZCBsb2cgY2hhbm5lbHM7CiAgICAgKiB1\nc2VkIGZvciBhdXRvbWF0aWMgY29uZmlndXJhdGlvbi4KICAgICAqLwogICAg\ncHVibGljIHZvaWQgc2V0RGVmYXVsdExldmVsKFN0cmluZyBsZXZlbCkgewog\nICAgICAgIF9kZWZhdWx0TG9nTGV2ZWwgPSBnZXRMZXZlbChsZXZlbCk7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBUaGUgZGVmYXVsdCBsZXZlbCBmb3IgdW5j\nb25maWd1cmVkIGxvZyBjaGFubmVscy4KICAgICAqLwogICAgcHVibGljIHNo\nb3J0IGdldERlZmF1bHRMZXZlbCgpIHsKICAgICAgICByZXR1cm4gX2RlZmF1\nbHRMb2dMZXZlbDsKICAgIH0KCiAgICAvKioKICAgICAqIFRoZSBkZWZhdWx0\nIGxldmVsIGZvciB1bmNvbmZpZ3VyZWQgbG9nIGNoYW5uZWxzLgogICAgICov\nCiAgICBwdWJsaWMgdm9pZCBzZXREZWZhdWx0TGV2ZWwoc2hvcnQgbGV2ZWwp\nIHsKICAgICAgICBfZGVmYXVsdExvZ0xldmVsID0gbGV2ZWw7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBBIHN0cmluZyB0byBwcmVmaXggYWxsIGxvZyBtZXNz\nYWdlcyB3aXRoLiBTZXQgdG8KICAgICAqIDxjb2RlPm51bGw8L2NvZGU+IHRv\nIHVzZSB0aGUgY29uZmlndXJhdGlvbidzIElkIHByb3BlcnR5IHNldHRpbmcu\nCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldERpYWdub3N0aWNDb250ZXh0\nKFN0cmluZyB2YWwpIHsKICAgICAgICBfZGlhZ0NvbnRleHQgPSB2YWw7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBBIHN0cmluZyB0byBwcmVmaXggYWxsIGxv\nZyBtZXNzYWdlcyB3aXRoLiBTZXQgdG8KICAgICAqIDxjb2RlPm51bGw8L2Nv\nZGU+IHRvIHVzZSB0aGUgY29uZmlndXJhdGlvbidzIElkIHByb3BlcnR5IHNl\ndHRpbmcuCiAgICAgKi8KICAgIHB1YmxpYyBTdHJpbmcgZ2V0RGlhZ25vc3Rp\nY0NvbnRleHQoKSB7CiAgICAgICAgaWYgKCFfZGlhZ0NvbnRleHRDb21wdXRl\nZCkgewogICAgICAgICAgICAvLyB0aGlzIGluaXRpYWxpemF0aW9uIGhhcyB0\nbyBoYXBwZW4gbGF6aWx5IGJlY2F1c2UgdGhlcmUgaXMgbm8KICAgICAgICAg\nICAgLy8gZ3VhcmFudGVlIHRoYXQgY29uZi5nZXRJZCgpIHdpbGwgYmUgcG9w\ndWxhdGVkIGJ5IHRoZSB0aW1lIHRoYXQKICAgICAgICAgICAgLy8gZW5kQ29u\nZmlndXJhdGlvbigpIGlzIGNhbGxlZC4KICAgICAgICAgICAgaWYgKF9kaWFn\nQ29udGV4dCA9PSBudWxsICYmIF9jb25mICE9IG51bGwpIHsKICAgICAgICAg\nICAgICAgIF9kaWFnQ29udGV4dCA9IF9jb25mLmdldElkKCk7CiAgICAgICAg\nICAgIH0KICAgICAgICAgICAgaWYgKCIiLmVxdWFscyhfZGlhZ0NvbnRleHQp\nKQogICAgICAgICAgICAgICAgX2RpYWdDb250ZXh0ID0gbnVsbDsKICAgICAg\nICAgICAgX2RpYWdDb250ZXh0Q29tcHV0ZWQgPSB0cnVlOwogICAgICAgIH0K\nICAgICAgICByZXR1cm4gX2RpYWdDb250ZXh0OwogICAgfQoKICAgIC8qKgog\nICAgICogVGhlIHN0cmVhbSB0byB3cml0ZSB0by4gUmVjb2duaXplZCB2YWx1\nZXMgYXJlOiA8Y29kZT5zdGRvdXQ8L2NvZGU+CiAgICAgKiBhbmQgPGNvZGU+\nc3RkZXJyPC9jb2RlPi4gQW55IG90aGVyIHZhbHVlIHdpbGwgYmUgY29uc2lk\nZXJlZCBhIGZpbGUgbmFtZS4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0\nRmlsZShTdHJpbmcgZmlsZSkgewogICAgICAgIGlmIChTVERPVVQuZXF1YWxz\nKGZpbGUpKQogICAgICAgICAgICBfb3V0ID0gU3lzdGVtLm91dDsKICAgICAg\nICBlbHNlIGlmIChTVERFUlIuZXF1YWxzKGZpbGUpKQogICAgICAgICAgICBf\nb3V0ID0gU3lzdGVtLmVycjsKICAgICAgICBlbHNlIHsKICAgICAgICAgICAg\nRmlsZSBmID0gRmlsZXMuZ2V0RmlsZShmaWxlLCBudWxsKTsKICAgICAgICAg\nICAgdHJ5IHsKICAgICAgICAgICAgICAgIF9vdXQgPSBuZXcgUHJpbnRTdHJl\nYW0oKEZpbGVPdXRwdXRTdHJlYW0pCiAgICAgICAgICAgICAgICAgICAgQWNj\nZXNzQ29udHJvbGxlci5kb1ByaXZpbGVnZWQoCiAgICAgICAgICAgICAgICAg\nICAgICAgIEoyRG9Qcml2SGVscGVyLm5ld0ZpbGVPdXRwdXRTdHJlYW1BY3Rp\nb24oCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAoU3RyaW5nKSBBY2Nl\nc3NDb250cm9sbGVyLmRvUHJpdmlsZWdlZCgKICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICBKMkRvUHJpdkhlbHBlci5nZXRDYW5vbmljYWxQYXRo\nQWN0aW9uKGYpKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRydWUp\nKSk7CiAgICAgICAgICAgIH0gY2F0Y2ggKFByaXZpbGVnZWRBY3Rpb25FeGNl\ncHRpb24gcGFlKSB7CiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdh\nbEFyZ3VtZW50RXhjZXB0aW9uKF9sb2MuZ2V0KCJsb2ctYmFkLWZpbGUiLAog\nICAgICAgICAgICAgICAgICAgICAgICBmaWxlKSArICIgIiArIHBhZS5nZXRF\neGNlcHRpb24oKSk7CiAgICAgICAgICAgIH0gY2F0Y2ggKElPRXhjZXB0aW9u\nIGlvZSkgewogICAgICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1\nbWVudEV4Y2VwdGlvbihfbG9jLmdldCgibG9nLWJhZC1maWxlIiwKICAgICAg\nICAgICAgICAgICAgICBmaWxlKSArICIgIiArIGlvZS50b1N0cmluZygpKTsK\nICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAq\nIFRoZSBzdHJlYW0gdG8gd3JpdGUgdG8uCiAgICAgKi8KICAgIHB1YmxpYyBQ\ncmludFN0cmVhbSBnZXRTdHJlYW0oKSB7CiAgICAgICAgcmV0dXJuIF9vdXQ7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBUaGUgc3RyZWFtIHRvIHdyaXRlIHRv\nLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRTdHJlYW0oUHJpbnRTdHJl\nYW0gc3RyZWFtKSB7CiAgICAgICAgaWYgKHN0cmVhbSA9PSBudWxsKQogICAg\nICAgICAgICB0aHJvdyBuZXcgTnVsbFBvaW50ZXJFeGNlcHRpb24oInN0cmVh\nbSA9PSBudWxsIik7CiAgICAgICAgX291dCA9IHN0cmVhbTsKICAgIH0KCiAg\nICAvKioKICAgICAqIFJldHVybnMgYSBzdHJpbmcgcmVwcmVzZW50YXRpb24g\nb2YgdGhlIHNwZWNpZmllZCBsb2cgbGV2ZWwgY29uc3RhbnQuCiAgICAgKi8K\nICAgIHB1YmxpYyBzdGF0aWMgU3RyaW5nIGdldExldmVsTmFtZShzaG9ydCBs\nZXZlbCkgewogICAgICAgIHN3aXRjaCAobGV2ZWwpIHsKICAgICAgICAgICAg\nY2FzZSBMb2cuVFJBQ0U6CiAgICAgICAgICAgICAgICByZXR1cm4gVFJBQ0Vf\nU1RSOwogICAgICAgICAgICBjYXNlIExvZy5JTkZPOgogICAgICAgICAgICAg\nICAgcmV0dXJuIElORk9fU1RSOwogICAgICAgICAgICBjYXNlIExvZy5XQVJO\nOgogICAgICAgICAgICAgICAgcmV0dXJuIFdBUk5fU1RSOwogICAgICAgICAg\nICBjYXNlIExvZy5FUlJPUjoKICAgICAgICAgICAgICAgIHJldHVybiBFUlJP\nUl9TVFI7CiAgICAgICAgICAgIGNhc2UgTG9nLkZBVEFMOgogICAgICAgICAg\nICAgICAgcmV0dXJuIEZBVEFMX1NUUjsKICAgICAgICAgICAgZGVmYXVsdDoK\nICAgICAgICAgICAgICAgIHJldHVybiBfbG9jRW4uZ2V0KCJsb2ctdW5rbm93\nbiIpLmdldE1lc3NhZ2UoKTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAg\nICAgKiBSZXR1cm5zIGEgc3ltYm9saWMgY29uc3RhbnQgZm9yIHRoZSBzcGVj\naWZpZWQgc3RyaW5nIGxldmVsLgogICAgICovCiAgICBwdWJsaWMgc3RhdGlj\nIHNob3J0IGdldExldmVsKFN0cmluZyBzdHIpIHsKICAgICAgICBzdHIgPSBz\ndHIudG9VcHBlckNhc2UoTG9jYWxlLkVOR0xJU0gpLnRyaW0oKTsKICAgICAg\nICBzaG9ydCB2YWwgPSBUUkFDRV9TVFIuZXF1YWxzKHN0cikgPyBMb2cuVFJB\nQ0UgOgogICAgICAgICAgICBJTkZPX1NUUi5lcXVhbHMoc3RyKSA/IExvZy5J\nTkZPIDoKICAgICAgICAgICAgICAgIFdBUk5fU1RSLmVxdWFscyhzdHIpID8g\nTG9nLldBUk4gOgogICAgICAgICAgICAgICAgICAgIEVSUk9SX1NUUi5lcXVh\nbHMoc3RyKSA/IExvZy5FUlJPUiA6CiAgICAgICAgICAgICAgICAgICAgICAg\nIEZBVEFMX1NUUi5lcXVhbHMoc3RyKSA/IExvZy5GQVRBTCA6IC0xOwoKICAg\nICAgICBpZiAodmFsID09IC0xKQogICAgICAgICAgICB0aHJvdyBuZXcgSWxs\nZWdhbEFyZ3VtZW50RXhjZXB0aW9uCiAgICAgICAgICAgICAgICAoX2xvYy5n\nZXQoImxvZy1iYWQtY29uc3RhbnQiLCBzdHIpLmdldE1lc3NhZ2UoKSk7Cgog\nICAgICAgIHJldHVybiB2YWw7CiAgICB9CgogICAgLy8gLS0tLS0tLS0tLSBD\nb25maWd1cmFibGUgaW1wbGVtZW50YXRpb24gLS0tLS0tLS0tLQogICAgCiAg\nICBwdWJsaWMgdm9pZCBzZXRDb25maWd1cmF0aW9uKENvbmZpZ3VyYXRpb24g\nY29uZikgewogICAgICAgIF9jb25mID0gY29uZjsKICAgIH0KICAgIAogICAg\ncHVibGljIHZvaWQgc3RhcnRDb25maWd1cmF0aW9uKCkgewogICAgfQoKICAg\nIHB1YmxpYyB2b2lkIGVuZENvbmZpZ3VyYXRpb24oKSB7CiAgICB9CgogICAg\nLy8gLS0tLS0tLS0tLSBHZW5lcmljQ29uZmlndXJhYmxlIGltcGxlbWVudGF0\naW9uIC0tLS0tLS0tLS0KCiAgICBwdWJsaWMgdm9pZCBzZXRJbnRvKE9wdGlv\nbnMgb3B0cykgewogICAgICAgIGlmICghb3B0cy5pc0VtcHR5KCkpIHsKICAg\nICAgICAgICAgTWFwLkVudHJ5IGU7CiAgICAgICAgICAgIGZvciAoSXRlcmF0\nb3IgaXRlciA9IG9wdHMuZW50cnlTZXQoKS5pdGVyYXRvcigpOyBpdGVyLmhh\nc05leHQoKTspIHsKICAgICAgICAgICAgICAgIGUgPSAoTWFwLkVudHJ5KSBp\ndGVyLm5leHQoKTsKICAgICAgICAgICAgICAgIF9jb25maWd1cmVkTGV2ZWxz\nLnB1dChzaG9ydGVuKChTdHJpbmcpIGUuZ2V0S2V5KCkpLAogICAgICAgICAg\nICAgICAgICAgIG5ldyBTaG9ydChnZXRMZXZlbCgoU3RyaW5nKSBlLmdldFZh\nbHVlKCkpKSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgb3B0cy5jbGVh\ncigpOwogICAgICAgIH0KICAgIH0KCiAgICBwcml2YXRlIHN0YXRpYyBTdHJp\nbmcgc2hvcnRlbihTdHJpbmcgY2hhbm5lbCkgewogICAgICAgIHJldHVybiBj\naGFubmVsLnN1YnN0cmluZyhjaGFubmVsLmxhc3RJbmRleE9mKCcuJykgKyAx\nKTsKICAgIH0KCiAgICAvKioKICAgICAqIEEgc2ltcGxlIGltcGxlbWVudGF0\naW9uIG9mIHRoZSB7QGxpbmsgTG9nfSBpbnRlcmZhY2UuIFdyaXRlcwogICAg\nICogb3V0cHV0IHRvIHN0ZGVyci4KICAgICAqLwogICAgcHVibGljIGNsYXNz\nIExvZ0ltcGwgZXh0ZW5kcyBBYnN0cmFjdExvZyB7CgogICAgICAgIHByaXZh\ndGUgc2hvcnQgX2xldmVsID0gSU5GTzsKICAgICAgICBwcml2YXRlIFN0cmlu\nZyBfY2hhbm5lbDsKCiAgICAgICAgcHJvdGVjdGVkIGJvb2xlYW4gaXNFbmFi\nbGVkKHNob3J0IGxldmVsKSB7CiAgICAgICAgICAgIHJldHVybiBsZXZlbCA+\nPSBfbGV2ZWw7CiAgICAgICAgfQoKICAgICAgICBwcm90ZWN0ZWQgdm9pZCBs\nb2coc2hvcnQgbGV2ZWwsIFN0cmluZyBtZXNzYWdlLCBUaHJvd2FibGUgdCkg\newogICAgICAgICAgICBTdHJpbmcgbXNnID0gZm9ybWF0TWVzc2FnZShsZXZl\nbCwgbWVzc2FnZSwgdCk7CiAgICAgICAgICAgIHN5bmNocm9uaXplZCAoX291\ndCkgewogICAgICAgICAgICAgICAgX291dC5wcmludChtc2cpOwogICAgICAg\nICAgICB9CiAgICAgICAgfQoKICAgICAgICAvKioKICAgICAgICAgKiBDb252\nZXJ0IDxjb2RlPm1lc3NhZ2U8L2NvZGU+IGludG8gYSBzdHJpbmcgcmVhZHkg\ndG8gYmUgd3JpdHRlbiB0bwogICAgICAgICAqIHRoZSBsb2cuIFRoZSBzdHJp\nbmcgc2hvdWxkIGluY2x1ZGUgdGhlIHRlcm1pbmF0aW5nIG5ld2xpbmUuCiAg\nICAgICAgICoKICAgICAgICAgKiBAcGFyYW0gdCBtYXkgYmUgbnVsbAogICAg\nICAgICAqLwogICAgICAgIHByb3RlY3RlZCBTdHJpbmcgZm9ybWF0TWVzc2Fn\nZShzaG9ydCBsZXZlbCwgU3RyaW5nIG1lc3NhZ2UsCiAgICAgICAgICAgIFRo\ncm93YWJsZSB0KSB7CiAgICAgICAgICAgIC8vIHdlIHdyaXRlIHRvIGEgU3Ry\naW5nQnVmZmVyIGFuZCB0aGVuIGZsdXNoIGl0IGFsbCBhdAogICAgICAgICAg\nICAvLyBvbmNlIGFzIGEgc2luZ2xlIGxpbmUsIHNpbmNlIHNvbWUgZW52aXJv\nbm1lbnRzKGUuZy4sIEpCb3NzKQogICAgICAgICAgICAvLyBvdmVycmlkZSB0\naGUgU3lzdGVtIG91dHB1dCBzdHJlYW0gdG8gZmx1c2ggYW55IGNhbGxzCiAg\nICAgICAgICAgIC8vIHRvIHdyaXRlIHdpdGhvdXQgcmVnYXJkIHRvIGxpbmUg\nYnJlYWtzLCBtYWtpbmcgdGhlCiAgICAgICAgICAgIC8vIG91dHB1dCBpbmNv\nbXByZWhlbnNpYmUuCiAgICAgICAgICAgIFN0cmluZ0J1ZmZlciBidWYgPSBu\nZXcgU3RyaW5nQnVmZmVyKCk7CgogICAgICAgICAgICBidWYuYXBwZW5kKGdl\ndE9mZnNldCgpKTsKICAgICAgICAgICAgYnVmLmFwcGVuZCgiICAiKTsKICAg\nICAgICAgICAgaWYgKGdldERpYWdub3N0aWNDb250ZXh0KCkgIT0gbnVsbCkK\nICAgICAgICAgICAgICAgIGJ1Zi5hcHBlbmQoZ2V0RGlhZ25vc3RpY0NvbnRl\neHQoKSkuYXBwZW5kKCIgICIpOwogICAgICAgICAgICBidWYuYXBwZW5kKGdl\ndExldmVsTmFtZShsZXZlbCkpOwogICAgICAgICAgICBpZiAobGV2ZWwgPT0g\nSU5GTyB8fCBsZXZlbCA9PSBXQVJOKQogICAgICAgICAgICAgICAgYnVmLmFw\ncGVuZCgiICIpOwogICAgICAgICAgICBidWYuYXBwZW5kKCIgIFsiKTsKICAg\nICAgICAgICAgYnVmLmFwcGVuZChUaHJlYWQuY3VycmVudFRocmVhZCgpLmdl\ndE5hbWUoKSk7CiAgICAgICAgICAgIGJ1Zi5hcHBlbmQoIl0gIik7CiAgICAg\nICAgICAgIGJ1Zi5hcHBlbmQoX2NoYW5uZWwpOwogICAgICAgICAgICBidWYu\nYXBwZW5kKCIgLSAiKTsKICAgICAgICAgICAgYnVmLmFwcGVuZChtZXNzYWdl\nKTsKICAgICAgICAgICAgYnVmLmFwcGVuZChORVdMSU5FKTsKCiAgICAgICAg\nICAgIGlmICh0ICE9IG51bGwpIHsKICAgICAgICAgICAgICAgIFN0cmluZ1dy\naXRlciBzd3JpdGVyID0gbmV3IFN0cmluZ1dyaXRlcigpOwogICAgICAgICAg\nICAgICAgUHJpbnRXcml0ZXIgcHdyaXRlciA9IG5ldyBQcmludFdyaXRlcihz\nd3JpdGVyKTsKICAgICAgICAgICAgICAgIHQucHJpbnRTdGFja1RyYWNlKHB3\ncml0ZXIpOwogICAgICAgICAgICAgICAgcHdyaXRlci5mbHVzaCgpOwogICAg\nICAgICAgICAgICAgYnVmLmFwcGVuZChzd3JpdGVyLnRvU3RyaW5nKCkpOwog\nICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiBidWYudG9TdHJpbmco\nKTsKICAgICAgICB9CgogICAgICAgIHByaXZhdGUgbG9uZyBnZXRPZmZzZXQo\nKSB7CiAgICAgICAgICAgIHJldHVybiBTeXN0ZW0uY3VycmVudFRpbWVNaWxs\naXMoKSAtIGluaXRpYWxpemF0aW9uTWlsbGlzOwogICAgICAgIH0KCiAgICAg\nICAgcHVibGljIHZvaWQgc2V0Q2hhbm5lbChTdHJpbmcgdmFsKSB7CiAgICAg\nICAgICAgIF9jaGFubmVsID0gdmFsOwogICAgICAgIH0KCiAgICAgICAgcHVi\nbGljIFN0cmluZyBnZXRDaGFubmVsKCkgewogICAgICAgICAgICByZXR1cm4g\nX2NoYW5uZWw7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgdm9pZCBzZXRM\nZXZlbChzaG9ydCB2YWwpIHsKICAgICAgICAgICAgX2xldmVsID0gdmFsOwog\nICAgICAgIH0KCiAgICAgICAgcHVibGljIHNob3J0IGdldExldmVsKCkgewog\nICAgICAgICAgICByZXR1cm4gX2xldmVsOwogICAgICAgIH0KICAgIH0KfQo=\n","encoding":"base64"}

