{"sha":"e5dadba9ad3c167c40956e52b231945d82e484c5","node_id":"MDQ6QmxvYjIwNjM2NDplNWRhZGJhOWFkM2MxNjdjNDA5NTZlNTJiMjMxOTQ1ZDgyZTQ4NGM1","size":12845,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/e5dadba9ad3c167c40956e52b231945d82e484c5","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNr\nYWdlIG9yZy5hcGFjaGUub3BlbmpwYS5saWIudXRpbC5jb25jdXJyZW50OwoK\naW1wb3J0IGphdmEudXRpbC5jb25jdXJyZW50LkNvbmN1cnJlbnRIYXNoTWFw\nOwppbXBvcnQgamF2YS51dGlsLkVudW1lcmF0aW9uOwppbXBvcnQgamF2YS51\ndGlsLlNldDsKaW1wb3J0IGphdmEudXRpbC5Db2xsZWN0aW9uOwppbXBvcnQg\namF2YS51dGlsLkFic3RyYWN0U2V0OwppbXBvcnQgamF2YS51dGlsLkl0ZXJh\ndG9yOwppbXBvcnQgamF2YS51dGlsLkFic3RyYWN0Q29sbGVjdGlvbjsKaW1w\nb3J0IGphdmEudXRpbC5SYW5kb207CmltcG9ydCBqYXZhLnV0aWwuSGFzaFNl\ndDsKaW1wb3J0IGphdmEudXRpbC5UcmVlU2V0OwoKaW1wb3J0IG9yZy5hcGFj\naGUuY29tbW9ucy5jb2xsZWN0aW9ucy5zZXQuTWFwQmFja2VkU2V0OwoKLyoq\nCiAqIEEgc3ViY2xhc3Mgb2Yge0BsaW5rIENvbmN1cnJlbnRIYXNoTWFwfSB0\naGF0IGFsbG93cyBudWxsIGtleXMgYW5kIHZhbHVlcy4KICogSW4gZXhjaGFu\nZ2UsIGl0IHdlYWtlbnMgdGhlIGNvbnRyYWN0IG9mIHtAbGluayAjcHV0SWZB\nYnNlbnR9IGFuZCB0aGUgb3RoZXIKICogY29uY3VycmVudCBtZXRob2RzIGFk\nZGVkIGluIHtAbGluayAjQ29uY3VycmVudEhhc2hNYXB9LgogKgogKiBAc2lu\nY2UgMS4xLjAKICovCnB1YmxpYyBjbGFzcyBOdWxsU2FmZUNvbmN1cnJlbnRI\nYXNoTWFwIGV4dGVuZHMgQ29uY3VycmVudEhhc2hNYXAgewoKICAgIHByaXZh\ndGUgZW51bSBNYXJrZXJzIHsKICAgICAgICBOVUxMLAogICAgICAgIE1BUF9C\nQUNLRURfU0VUX0RVTU1ZX1ZBTAogICAgfQoKICAgIC8vIFRoZSBzZWNvbmQg\nYXJndW1lbnQgaXMgdXNlZCB3aXRoaW4gTWFwQmFja2VkU2V0IGFzIHRoZSB2\nYWx1ZSBmb3IKICAgIC8vIGFsbCB0aGUga2V5LXZhbCBwYWlycyB0aGF0IGFy\nZSBwdXQgaW50byB0aGUgdW5kZXJseWluZyBNYXAuIFRoaXMKICAgIC8vIGlz\nIHJlcXVpcmVkIGZvciBvdXIgdXNhZ2Ugc2luY2UgQ29uY3VycmVudEhhc2hN\nYXAgZG9lcyBub3QgYWxsb3cKICAgIC8vIG51bGwgdmFsdWVzLgogICAgcHJp\ndmF0ZSBTZXQgcmFuZG9tS2V5cyA9IE1hcEJhY2tlZFNldC5kZWNvcmF0ZSgK\nICAgICAgICBuZXcgQ29uY3VycmVudEhhc2hNYXAoKSwgTWFya2Vycy5NQVBf\nQkFDS0VEX1NFVF9EVU1NWV9WQUwpOwoKICAgIHByaXZhdGUgUmFuZG9tIHJh\nbmRvbSA9IG5ldyBSYW5kb20oKTsKCiAgICBwdWJsaWMgTnVsbFNhZmVDb25j\ndXJyZW50SGFzaE1hcChpbnQgc2l6ZSwgZmxvYXQgbG9hZCwKICAgICAgICBp\nbnQgY29uY3VycmVuY3lMZXZlbCkgewogICAgICAgIHN1cGVyKHNpemUsIGxv\nYWQsIGNvbmN1cnJlbmN5TGV2ZWwpOwogICAgfQoKICAgIHB1YmxpYyBOdWxs\nU2FmZUNvbmN1cnJlbnRIYXNoTWFwKCkgewogICAgfQoKICAgIC8qKgogICAg\nICogUmV0dXJucyBpbnRlcm5hbCByZXByZXNlbnRhdGlvbiBmb3Igb2JqZWN0\nLgogICAgICovCiAgICBwcml2YXRlIHN0YXRpYyBPYmplY3QgbWFza051bGwo\nT2JqZWN0IG8pIHsKICAgICAgICByZXR1cm4gKG8gPT0gbnVsbCA/IE1hcmtl\ncnMuTlVMTCA6IG8pOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJucyBv\nYmplY3QgcmVwcmVzZW50ZWQgYnkgc3BlY2lmaWVkIGludGVybmFsIHJlcHJl\nc2VudGF0aW9uLgogICAgICovCiAgICBwcml2YXRlIHN0YXRpYyBPYmplY3Qg\ndW5tYXNrTnVsbChPYmplY3QgbykgewogICAgICAgIHJldHVybiAobyA9PSBN\nYXJrZXJzLk5VTEwgPyBudWxsIDogbyk7CiAgICB9CgogICAgcHVibGljIEVu\ndHJ5IHJlbW92ZVJhbmRvbSgpIHsKICAgICAgICAvLyB0aGlzIGRvZXNuJ3Qg\nanVzdCB1c2UgcmFuZG9tRW50cnlJdGVyYXRvcigpIGJlY2F1c2UgdGhhdCBp\ndGVyYXRvcgogICAgICAgIC8vIGhhcyB3ZWFrZXIgY29uY3VycmVuY3kgZ3Vh\ncmFudGVlcyB0aGFuIHRoaXMgbWV0aG9kLiBJbiBwYXJ0aWN1bGFyLAogICAg\nICAgIC8vIHRoaXMgbWV0aG9kIHdpbGwgY29udGludWUgdG8gYXR0ZW1wdCB0\nbyByZW1vdmUgcmFuZG9tIGVudHJpZXMgZXZlbgogICAgICAgIC8vIGFzIG90\naGVyIHRocmVhZHMgcmVtb3ZlIHRoZSBzYW1lIGVudHJpZXMsIHdoZXJlYXMg\ndGhlIHJhbmRvbQogICAgICAgIC8vIGl0ZXJhdG9yIG1heSByZXR1cm4gdmFs\ndWVzIHRoYXQgaGF2ZSBiZWVuIHJlbW92ZWQuCgogICAgICAgIGZvciAoSXRl\ncmF0b3IgaXRlciA9IHJhbmRvbUtleXMuaXRlcmF0b3IoKTsgaXRlci5oYXNO\nZXh0KCk7ICkgewogICAgICAgICAgICAvLyByYW5kb21LZXlzIGNvbnRhaW5z\nIG51bGwtbWFza2VkIGRhdGEKICAgICAgICAgICAgT2JqZWN0IGtleSA9IGl0\nZXIubmV4dCgpOwogICAgICAgICAgICBpZiAoa2V5ICE9IG51bGwgJiYgcmFu\nZG9tS2V5cy5yZW1vdmUoa2V5KSkgewogICAgICAgICAgICAgICAgT2JqZWN0\nIHZhbCA9IHN1cGVyLnJlbW92ZShrZXkpOwogICAgICAgICAgICAgICAgaWYg\nKHZhbCAhPSBudWxsKQogICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcg\nRW50cnlJbXBsKHVubWFza051bGwoa2V5KSwgdW5tYXNrTnVsbCh2YWwpKTsK\nICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgLy8gaWYgcmFuZG9t\nS2V5cyBpcyBlbXB0eSwgZmFsbCBiYWNrIHRvIG5vbi1yYW5kb20gYmVoYXZp\nb3IuCiAgICAgICAgZm9yIChJdGVyYXRvciBpdGVyID0gc3VwZXIua2V5U2V0\nKCkuaXRlcmF0b3IoKTsgaXRlci5oYXNOZXh0KCk7ICkgewogICAgICAgICAg\nICBPYmplY3Qga2V5ID0gaXRlci5uZXh0KCk7CiAgICAgICAgICAgIGlmIChr\nZXkgPT0gbnVsbCkKICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAg\nICAgICBPYmplY3QgdmFsID0gc3VwZXIucmVtb3ZlKGtleSk7CiAgICAgICAg\nICAgIGlmICh2YWwgIT0gbnVsbCkKICAgICAgICAgICAgICAgIHJldHVybiBu\nZXcgRW50cnlJbXBsKHVubWFza051bGwoa2V5KSwgdW5tYXNrTnVsbCh2YWwp\nKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBUaGUgcmV0dXJuZWQgZGF0YSBzdHJ1Y3R1cmUgc2hvdWxk\nIG5vdCBiZSBzaGFyZWQgYW1vbmcgbXVsdGlwbGUKICAgICAqIHRocmVhZHMu\nCiAgICAgKi8KICAgIHB1YmxpYyBJdGVyYXRvcjxFbnRyeT4gcmFuZG9tRW50\ncnlJdGVyYXRvcigpIHsKICAgICAgICByZXR1cm4gbmV3IEl0ZXJhdG9yPEVu\ndHJ5PigpIHsKCiAgICAgICAgICAgIEl0ZXJhdG9yIHJhbmRvbUl0ZXIgPSBy\nYW5kb21LZXlzLml0ZXJhdG9yKCk7CiAgICAgICAgICAgIEl0ZXJhdG9yIG5v\nblJhbmRvbUl0ZXIgPSBOdWxsU2FmZUNvbmN1cnJlbnRIYXNoTWFwLnN1cGVy\nLmtleVNldCgpCiAgICAgICAgICAgICAgICAuaXRlcmF0b3IoKTsKCiAgICAg\nICAgICAgIFNldCByZXR1cm5lZCA9IG5ldyBIYXNoU2V0KCk7CiAgICAgICAg\nICAgIEVudHJ5IG5leHQ7CiAgICAgICAgICAgIGJvb2xlYW4gbmV4dFNldCA9\nIGZhbHNlOwoKICAgICAgICAgICAgcHVibGljIGJvb2xlYW4gaGFzTmV4dCgp\nIHsKICAgICAgICAgICAgICAgIC8vIHdlJ3ZlIHNldCB0aGUgbmV4dCB2YWx1\nZSBhbmQgd2UgaGF2ZW4ndCByZXR1cm5lZCBpdCB5ZXQKICAgICAgICAgICAg\nICAgIGlmIChuZXh0U2V0KQogICAgICAgICAgICAgICAgICAgIHJldHVybiB0\ncnVlOwoKICAgICAgICAgICAgICAgIC8vIGNvbXB1dGUgdGhlIG5leHQgdmFs\ndWUuIElmIHRoZSBjb21wdXRhdGlvbiByZXR1cm5zIG51bGwsCiAgICAgICAg\nICAgICAgICAvLyByZXR1cm4gZmFsc2UuIEVsc2UsIHN0b3JlIHRoZSBuZXh0\nIHZhbHVlIGFuZCByZXR1cm4gdHJ1ZS4KICAgICAgICAgICAgICAgIE9iamVj\ndCBuZXh0S2V5OwogICAgICAgICAgICAgICAgT2JqZWN0IG5leHRWYWx1ZTsK\nICAgICAgICAgICAgICAgIGlmIChyYW5kb21JdGVyLmhhc05leHQoKSkgewog\nICAgICAgICAgICAgICAgICAgIG5leHRLZXkgPSByYW5kb21JdGVyLm5leHQo\nKTsKICAgICAgICAgICAgICAgICAgICBuZXh0VmFsdWUgPSBOdWxsU2FmZUNv\nbmN1cnJlbnRIYXNoTWFwLnN1cGVyLmdldChuZXh0S2V5KTsKICAgICAgICAg\nICAgICAgICAgICBpZiAobmV4dFZhbHVlICE9IG51bGwpIHsKICAgICAgICAg\nICAgICAgICAgICAgICAgcmV0dXJuZWQuYWRkKG5leHRLZXkpOwogICAgICAg\nICAgICAgICAgICAgICAgICBuZXh0ID0gbmV3IEVudHJ5SW1wbCh1bm1hc2tO\ndWxsKG5leHRLZXkpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5t\nYXNrTnVsbChuZXh0VmFsdWUpKTsKICAgICAgICAgICAgICAgICAgICAgICAg\nbmV4dFNldCA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVy\nbiB0cnVlOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAg\nIH0KCiAgICAgICAgICAgICAgICB3aGlsZSAobm9uUmFuZG9tSXRlci5oYXNO\nZXh0KCkpIHsKICAgICAgICAgICAgICAgICAgICBuZXh0S2V5ID0gbm9uUmFu\nZG9tSXRlci5uZXh0KCk7CgogICAgICAgICAgICAgICAgICAgIGlmIChyZXR1\ncm5lZC5jb250YWlucyhuZXh0S2V5KSkKICAgICAgICAgICAgICAgICAgICAg\nICAgY29udGludWU7CgogICAgICAgICAgICAgICAgICAgIG5leHRWYWx1ZSA9\nIE51bGxTYWZlQ29uY3VycmVudEhhc2hNYXAuc3VwZXIuZ2V0KG5leHRLZXkp\nOwogICAgICAgICAgICAgICAgICAgIGlmIChuZXh0VmFsdWUgIT0gbnVsbCkg\newogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm5lZC5hZGQobmV4dEtl\neSk7CiAgICAgICAgICAgICAgICAgICAgICAgIG5leHQgPSBuZXcgRW50cnlJ\nbXBsKHVubWFza051bGwobmV4dEtleSksCiAgICAgICAgICAgICAgICAgICAg\nICAgICAgICB1bm1hc2tOdWxsKG5leHRWYWx1ZSkpOwogICAgICAgICAgICAg\nICAgICAgICAgICBuZXh0U2V0ID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAg\nICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgICAgICAgICAgfQogICAg\nICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwog\nICAgICAgICAgICB9CgogICAgICAgICAgICBwdWJsaWMgRW50cnkgbmV4dCgp\nIHsKICAgICAgICAgICAgICAgIC8vIGhhc05leHQoKSB3aWxsIGluaXRpYWxp\nemUgdGhpcy5uZXh0CiAgICAgICAgICAgICAgICBpZiAoIW5leHRTZXQgJiYg\nIWhhc05leHQoKSkKICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDsK\nCiAgICAgICAgICAgICAgICAvLyBpZiB3ZSBnZXQgaGVyZSwgdGhlbiB3ZSdy\nZSBhYm91dCB0byByZXR1cm4gYSBuZXh0IHZhbHVlCiAgICAgICAgICAgICAg\nICBuZXh0U2V0ID0gZmFsc2U7CiAgICAgICAgICAgICAgICAKICAgICAgICAg\nICAgICAgIGlmIChjb250YWluc0tleShuZXh0LmdldEtleSgpKSkKICAgICAg\nICAgICAgICAgICAgICByZXR1cm4gbmV4dDsKCiAgICAgICAgICAgICAgICAv\nLyBzb21ldGhpbmcgaGFzIGNoYW5nZWQgc2luY2UgdGhlIGxhc3QgaXRlcmF0\naW9uIChwcmVzdW1hYmx5CiAgICAgICAgICAgICAgICAvLyBkdWUgdG8gbXVs\ndGktdGhyZWFkZWQgYWNjZXNzIHRvIHRoZSB1bmRlcmx5aW5nIGRhdGEKICAg\nICAgICAgICAgICAgIC8vIHN0cnVjdHVyZSk7IHJlY3Vyc2UKICAgICAgICAg\nICAgICAgIHJldHVybiBuZXh0KCk7CiAgICAgICAgICAgIH0KCiAgICAgICAg\nICAgIHB1YmxpYyB2b2lkIHJlbW92ZSgpIHsKICAgICAgICAgICAgICAgIHRo\ncm93IG5ldyBVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbigpOwogICAg\nICAgICAgICB9CiAgICAgICAgfTsKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAg\nIHB1YmxpYyBPYmplY3QgcmVtb3ZlKE9iamVjdCBrZXkpIHsKICAgICAgICBP\nYmplY3QgbWFza2VkS2V5ID0gbWFza051bGwoa2V5KTsKICAgICAgICBPYmpl\nY3QgdmFsID0gdW5tYXNrTnVsbChzdXBlci5yZW1vdmUobWFza2VkS2V5KSk7\nCiAgICAgICAgcmFuZG9tS2V5cy5yZW1vdmUobWFza2VkS2V5KTsKICAgICAg\nICByZXR1cm4gdmFsOwogICAgfQoKICAgIEBPdmVycmlkZQogICAgcHVibGlj\nIGJvb2xlYW4gcmVtb3ZlKE9iamVjdCBrZXksIE9iamVjdCB2YWx1ZSkgewog\nICAgICAgIE9iamVjdCBtYXNrZWRLZXkgPSBtYXNrTnVsbChrZXkpOwogICAg\nICAgIGJvb2xlYW4gdmFsID0gc3VwZXIucmVtb3ZlKG1hc2tlZEtleSwgbWFz\na051bGwodmFsdWUpKTsKICAgICAgICByYW5kb21LZXlzLnJlbW92ZShtYXNr\nZWRLZXkpOwogICAgICAgIHJldHVybiB2YWw7CiAgICB9CgogICAgQE92ZXJy\naWRlCiAgICBwdWJsaWMgYm9vbGVhbiByZXBsYWNlKE9iamVjdCBrZXksIE9i\namVjdCBvbGRWYWx1ZSwgT2JqZWN0IG5ld1ZhbHVlKSB7CiAgICAgICAgcmV0\ndXJuIHN1cGVyLnJlcGxhY2UobWFza051bGwoa2V5KSwgbWFza051bGwob2xk\nVmFsdWUpLAogICAgICAgICAgICBtYXNrTnVsbChuZXdWYWx1ZSkpOwogICAg\nfQoKICAgIEBPdmVycmlkZQogICAgcHVibGljIE9iamVjdCByZXBsYWNlKE9i\namVjdCBrZXksIE9iamVjdCB2YWx1ZSkgewogICAgICAgIHJldHVybiB1bm1h\nc2tOdWxsKHN1cGVyLnJlcGxhY2UobWFza051bGwoa2V5KSwgbWFza051bGwo\ndmFsdWUpKSk7CiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgT2Jq\nZWN0IHB1dElmQWJzZW50KE9iamVjdCBrZXksIE9iamVjdCB2YWx1ZSkgewog\nICAgICAgIE9iamVjdCBtYXNrZWRLZXkgPSBtYXNrTnVsbChrZXkpOwogICAg\nICAgIE9iamVjdCBzdXBlclZhbCA9IHN1cGVyLnB1dElmQWJzZW50KG1hc2tl\nZEtleSwgbWFza051bGwodmFsdWUpKTsKICAgICAgICBhZGRSYW5kb21LZXko\nbWFza2VkS2V5KTsKICAgICAgICByZXR1cm4gdW5tYXNrTnVsbChzdXBlclZh\nbCk7CiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgT2JqZWN0IHB1\ndChPYmplY3Qga2V5LCBPYmplY3QgdmFsdWUpIHsKICAgICAgICBPYmplY3Qg\nbWFza2VkS2V5ID0gbWFza051bGwoa2V5KTsKICAgICAgICBPYmplY3Qgc3Vw\nZXJWYWwgPSBzdXBlci5wdXQobWFza2VkS2V5LCBtYXNrTnVsbCh2YWx1ZSkp\nOwogICAgICAgIGFkZFJhbmRvbUtleShtYXNrZWRLZXkpOwogICAgICAgIHJl\ndHVybiB1bm1hc2tOdWxsKHN1cGVyVmFsKTsKICAgIH0KCiAgICAvKioKICAg\nICAqIFBvdGVudGlhbGx5IGFkZHMgPGNvZGU+bWFza2VkS2V5PC9jY29kZT4g\ndG8gdGhlIHNldCBvZiByYW5kb20ga2V5cwogICAgICogdG8gYmUgcmVtb3Zl\nZCBieSB7QGxpbmsgI3JlbW92ZVJhbmRvbSgpfS4KICAgICAqCiAgICAgKiBA\nc2luY2UgMS4xLjAKICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIGFkZFJhbmRv\nbUtleShPYmplY3QgbWFza2VkS2V5KSB7CiAgICAgICAgLy8gQWRkIG9uZSBp\nbiBldmVyeSB0aHJlZSBrZXlzIHRvIHRoZSBzZXQuIE9ubHkgZG8gdGhpcyB3\naGVuCiAgICAgICAgLy8gdGhlcmUgYXJlIGxlc3MgdGhhbiAxNiBlbGVtZW50\ncyBpbiB0aGUgcmFuZG9tIGtleSBzZXQ7IHRoaXMKICAgICAgICAvLyBtZWFu\ncyB0aGF0IHRoZSBhbGdvcml0aG0gd2lsbCBiZSBwc2V1ZG8tcmFuZG9tIGZv\nciB1cCB0bwogICAgICAgIC8vIDE2IHJlbW92ZXMgKGVpdGhlciB2aWEgcmVt\nb3ZlUmFuZG9tKCkgb3Igbm9ybWFsIHJlbW92ZSgpCiAgICAgICAgLy8gY2Fs\nbHMpIHRoYXQgaGF2ZSBubyBpbnRlcnZlbmluZyBwdXQoKSBjYWxscy4KICAg\nICAgICBpZiAocmFuZG9tICE9IG51bGwgJiYgcmFuZG9tS2V5cy5zaXplKCkg\nPCAxNiAmJiByYW5kb20ubmV4dEludCgxMCkgPCAzKQogICAgICAgICAgICBy\nYW5kb21LZXlzLmFkZChtYXNrZWRLZXkpOwogICAgfQoKICAgIEBPdmVycmlk\nZQogICAgcHVibGljIE9iamVjdCBnZXQoT2JqZWN0IGtleSkgewogICAgICAg\nIHJldHVybiB1bm1hc2tOdWxsKHN1cGVyLmdldChtYXNrTnVsbChrZXkpKSk7\nCiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgYm9vbGVhbiBjb250\nYWluc0tleShPYmplY3Qga2V5KSB7CiAgICAgICAgcmV0dXJuIHN1cGVyLmNv\nbnRhaW5zS2V5KG1hc2tOdWxsKGtleSkpOwogICAgfQoKICAgIEBPdmVycmlk\nZQogICAgcHVibGljIGJvb2xlYW4gY29udGFpbnNWYWx1ZShPYmplY3QgdmFs\ndWUpIHsKICAgICAgICByZXR1cm4gc3VwZXIuY29udGFpbnNWYWx1ZShtYXNr\nTnVsbCh2YWx1ZSkpOwogICAgfQoKICAgIEBPdmVycmlkZQogICAgcHVibGlj\nIGJvb2xlYW4gY29udGFpbnMoT2JqZWN0IHZhbHVlKSB7CiAgICAgICAgdGhy\nb3cgbmV3IFVuc3VwcG9ydGVkT3BlcmF0aW9uRXhjZXB0aW9uKCk7CiAgICB9\nCgogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgRW51bWVyYXRpb24gZWxlbWVu\ndHMoKSB7CiAgICAgICAgdGhyb3cgbmV3IFVuc3VwcG9ydGVkT3BlcmF0aW9u\nRXhjZXB0aW9uKCk7CiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMg\nU2V0IGVudHJ5U2V0KCkgewogICAgICAgIHJldHVybiBuZXcgVHJhbnNsYXRp\nbmdTZXQoc3VwZXIuZW50cnlTZXQoKSkgewogICAgICAgICAgICBwcm90ZWN0\nZWQgT2JqZWN0IHVubWFzayhPYmplY3QgaW50ZXJuYWwpIHsKICAgICAgICAg\nICAgICAgIGZpbmFsIEVudHJ5IGUgPSAoRW50cnkpIGludGVybmFsOwogICAg\nICAgICAgICAgICAgcmV0dXJuIG5ldyBFbnRyeSgpIHsKCiAgICAgICAgICAg\nICAgICAgICAgcHVibGljIE9iamVjdCBnZXRLZXkoKSB7CiAgICAgICAgICAg\nICAgICAgICAgICAgIHJldHVybiB1bm1hc2tOdWxsKGUuZ2V0S2V5KCkpOwog\nICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgcHVi\nbGljIE9iamVjdCBnZXRWYWx1ZSgpIHsKICAgICAgICAgICAgICAgICAgICAg\nICAgcmV0dXJuIHVubWFza051bGwoZS5nZXRWYWx1ZSgpKTsKICAgICAgICAg\nICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIHB1YmxpYyBPYmpl\nY3Qgc2V0VmFsdWUoT2JqZWN0IHZhbHVlKSB7CiAgICAgICAgICAgICAgICAg\nICAgICAgIHJldHVybiB1bm1hc2tOdWxsKGUuc2V0VmFsdWUobWFza051bGwo\ndmFsdWUpKSk7CiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAg\nICAgICAgICBAT3ZlcnJpZGUKICAgICAgICAgICAgICAgICAgICBwdWJsaWMg\naW50IGhhc2hDb2RlKCkgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1\ncm4gZS5oYXNoQ29kZSgpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAg\nICAgICAgICAgIH07CiAgICAgICAgICAgIH0KICAgICAgICB9OwogICAgfQoK\nICAgIEBPdmVycmlkZQogICAgcHVibGljIEVudW1lcmF0aW9uIGtleXMoKSB7\nCiAgICAgICAgdGhyb3cgbmV3IFVuc3VwcG9ydGVkT3BlcmF0aW9uRXhjZXB0\naW9uKCk7CiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgU2V0IGtl\neVNldCgpIHsKICAgICAgICByZXR1cm4gbmV3IFRyYW5zbGF0aW5nU2V0KHN1\ncGVyLmtleVNldCgpKSB7CiAgICAgICAgICAgIHByb3RlY3RlZCBPYmplY3Qg\ndW5tYXNrKE9iamVjdCBpbnRlcm5hbCkgewogICAgICAgICAgICAgICAgcmV0\ndXJuIHVubWFza051bGwoaW50ZXJuYWwpOwogICAgICAgICAgICB9CiAgICAg\nICAgfTsKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyBDb2xsZWN0\naW9uIHZhbHVlcygpIHsKICAgICAgICByZXR1cm4gbmV3IFRyYW5zbGF0aW5n\nQ29sbGVjdGlvbihzdXBlci52YWx1ZXMoKSkgewoKICAgICAgICAgICAgcHJv\ndGVjdGVkIE9iamVjdCB1bm1hc2soT2JqZWN0IGludGVybmFsKSB7CiAgICAg\nICAgICAgICAgICByZXR1cm4gdW5tYXNrTnVsbChpbnRlcm5hbCk7CiAgICAg\nICAgICAgIH0KICAgICAgICB9OwogICAgfQoKICAgIHByaXZhdGUgYWJzdHJh\nY3QgY2xhc3MgVHJhbnNsYXRpbmdTZXQgZXh0ZW5kcyBBYnN0cmFjdFNldCB7\nCgogICAgICAgIHByaXZhdGUgU2V0IGJhY2tpbmdTZXQ7CgogICAgICAgIHBy\naXZhdGUgVHJhbnNsYXRpbmdTZXQoU2V0IGJhY2tpbmcpIHsKICAgICAgICAg\nICAgdGhpcy5iYWNraW5nU2V0ID0gYmFja2luZzsKICAgICAgICB9CgogICAg\nICAgIHByb3RlY3RlZCBhYnN0cmFjdCBPYmplY3QgdW5tYXNrKE9iamVjdCBp\nbnRlcm5hbCk7CgogICAgICAgIHB1YmxpYyBJdGVyYXRvciBpdGVyYXRvcigp\nIHsKICAgICAgICAgICAgZmluYWwgSXRlcmF0b3IgaXRlcmF0b3IgPSBiYWNr\naW5nU2V0Lml0ZXJhdG9yKCk7CiAgICAgICAgICAgIHJldHVybiBuZXcgSXRl\ncmF0b3IoKSB7CiAgICAgICAgICAgICAgICBwdWJsaWMgYm9vbGVhbiBoYXNO\nZXh0KCkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBpdGVyYXRvci5o\nYXNOZXh0KCk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAg\ncHVibGljIE9iamVjdCBuZXh0KCkgewogICAgICAgICAgICAgICAgICAgIHJl\ndHVybiB1bm1hc2soaXRlcmF0b3IubmV4dCgpKTsKICAgICAgICAgICAgICAg\nIH0KCiAgICAgICAgICAgICAgICBwdWJsaWMgdm9pZCByZW1vdmUoKSB7CiAg\nICAgICAgICAgICAgICAgICAgaXRlcmF0b3IucmVtb3ZlKCk7CiAgICAgICAg\nICAgICAgICB9CiAgICAgICAgICAgIH07CiAgICAgICAgfQoKICAgICAgICBw\ndWJsaWMgaW50IHNpemUoKSB7CiAgICAgICAgICAgIHJldHVybiBiYWNraW5n\nU2V0LnNpemUoKTsKICAgICAgICB9CiAgICB9CgogICAgcHJpdmF0ZSBhYnN0\ncmFjdCBjbGFzcyBUcmFuc2xhdGluZ0NvbGxlY3Rpb24gZXh0ZW5kcyBBYnN0\ncmFjdENvbGxlY3Rpb24gewoKICAgICAgICBwcml2YXRlIENvbGxlY3Rpb24g\nYmFja2luZ0NvbGxlY3Rpb247CgogICAgICAgIHByaXZhdGUgVHJhbnNsYXRp\nbmdDb2xsZWN0aW9uKENvbGxlY3Rpb24gYmFja2luZykgewogICAgICAgICAg\nICB0aGlzLmJhY2tpbmdDb2xsZWN0aW9uID0gYmFja2luZzsKICAgICAgICB9\nCgogICAgICAgIHByb3RlY3RlZCBhYnN0cmFjdCBPYmplY3QgdW5tYXNrKE9i\namVjdCBpbnRlcm5hbCk7CgogICAgICAgIHB1YmxpYyBJdGVyYXRvciBpdGVy\nYXRvcigpIHsKICAgICAgICAgICAgZmluYWwgSXRlcmF0b3IgaXRlcmF0b3Ig\nPSBiYWNraW5nQ29sbGVjdGlvbi5pdGVyYXRvcigpOwogICAgICAgICAgICBy\nZXR1cm4gbmV3IEl0ZXJhdG9yKCkgewogICAgICAgICAgICAgICAgcHVibGlj\nIGJvb2xlYW4gaGFzTmV4dCgpIHsKICAgICAgICAgICAgICAgICAgICByZXR1\ncm4gaXRlcmF0b3IuaGFzTmV4dCgpOwogICAgICAgICAgICAgICAgfQoKICAg\nICAgICAgICAgICAgIHB1YmxpYyBPYmplY3QgbmV4dCgpIHsKICAgICAgICAg\nICAgICAgICAgICByZXR1cm4gdW5tYXNrKGl0ZXJhdG9yLm5leHQoKSk7CiAg\nICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcHVibGljIHZvaWQg\ncmVtb3ZlKCkgewogICAgICAgICAgICAgICAgICAgIGl0ZXJhdG9yLnJlbW92\nZSgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9OwogICAgICAg\nIH0KCiAgICAgICAgcHVibGljIGludCBzaXplKCkgewogICAgICAgICAgICBy\nZXR1cm4gYmFja2luZ0NvbGxlY3Rpb24uc2l6ZSgpOwogICAgICAgIH0KICAg\nIH0KCiAgICBwcml2YXRlIGNsYXNzIEVudHJ5SW1wbCBpbXBsZW1lbnRzIEVu\ndHJ5IHsKCiAgICAgICAgZmluYWwgT2JqZWN0IGtleTsKICAgICAgICBmaW5h\nbCBPYmplY3QgdmFsOwoKICAgICAgICBwcml2YXRlIEVudHJ5SW1wbChPYmpl\nY3Qga2V5LCBPYmplY3QgdmFsKSB7CiAgICAgICAgICAgIHRoaXMua2V5ID0g\na2V5OwogICAgICAgICAgICB0aGlzLnZhbCA9IHZhbDsKICAgICAgICB9Cgog\nICAgICAgIHB1YmxpYyBPYmplY3QgZ2V0S2V5KCkgewogICAgICAgICAgICBy\nZXR1cm4ga2V5OwogICAgICAgIH0KCiAgICAgICAgcHVibGljIE9iamVjdCBn\nZXRWYWx1ZSgpIHsKICAgICAgICAgICAgcmV0dXJuIHZhbDsKICAgICAgICB9\nCgogICAgICAgIHB1YmxpYyBPYmplY3Qgc2V0VmFsdWUoT2JqZWN0IHZhbHVl\nKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBVbnN1cHBvcnRlZE9wZXJhdGlv\nbkV4Y2VwdGlvbigpOwogICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMgaW50\nZXJmYWNlIEtleUZpbHRlciB7CgogICAgICAgIC8qKgogICAgICAgICAqIEBw\nYXJhbSBrZXkgbWF5IGJlIG51bGwKICAgICAgICAgKiBAcmV0dXJuIHdoZXRo\nZXIgb3Igbm90IDxjb2RlPmtleTwvY29kZT4gc2h1b2xkIGJlIGV4Y2x1ZGVk\nCiAgICAgICAgICovCiAgICAgICAgcHVibGljIGJvb2xlYW4gZXhjbHVkZShP\nYmplY3Qga2V5KTsKICAgIH0KfQo=\n","encoding":"base64"}

