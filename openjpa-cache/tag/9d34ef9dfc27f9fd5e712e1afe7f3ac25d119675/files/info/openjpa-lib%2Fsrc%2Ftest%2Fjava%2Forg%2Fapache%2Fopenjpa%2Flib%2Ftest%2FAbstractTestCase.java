{"sha":"49a389f0b97f54634eba55fb5023a18f5c47f72e","node_id":"MDQ6QmxvYjIwNjM2NDo0OWEzODlmMGI5N2Y1NDYzNGViYTU1ZmI1MDIzYTE4ZjVjNDdmNzJl","size":36693,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/49a389f0b97f54634eba55fb5023a18f5c47f72e","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnRlc3Q7CgppbXBvcnQg\namF2YS5iZWFucy5CZWFuSW5mbzsKaW1wb3J0IGphdmEuYmVhbnMuSW50cm9z\ncGVjdGlvbkV4Y2VwdGlvbjsKaW1wb3J0IGphdmEuYmVhbnMuSW50cm9zcGVj\ndG9yOwppbXBvcnQgamF2YS5iZWFucy5Qcm9wZXJ0eURlc2NyaXB0b3I7Cmlt\ncG9ydCBqYXZhLmlvLkJ5dGVBcnJheUlucHV0U3RyZWFtOwppbXBvcnQgamF2\nYS5pby5CeXRlQXJyYXlPdXRwdXRTdHJlYW07CmltcG9ydCBqYXZhLmlvLkZp\nbGU7CmltcG9ydCBqYXZhLmlvLkZpbGVJbnB1dFN0cmVhbTsKaW1wb3J0IGph\ndmEuaW8uRmlsZU5vdEZvdW5kRXhjZXB0aW9uOwppbXBvcnQgamF2YS5pby5G\naWxlT3V0cHV0U3RyZWFtOwppbXBvcnQgamF2YS5pby5JT0V4Y2VwdGlvbjsK\naW1wb3J0IGphdmEuaW8uSW5wdXRTdHJlYW07CmltcG9ydCBqYXZhLmlvLk9i\namVjdElucHV0U3RyZWFtOwppbXBvcnQgamF2YS5pby5PYmplY3RPdXRwdXRT\ndHJlYW07CmltcG9ydCBqYXZhLmlvLlByaW50U3RyZWFtOwppbXBvcnQgamF2\nYS5pby5QcmludFdyaXRlcjsKaW1wb3J0IGphdmEuaW8uU3RyaW5nV3JpdGVy\nOwppbXBvcnQgamF2YS5sYW5nLnJlZmxlY3QuSW52b2NhdGlvblRhcmdldEV4\nY2VwdGlvbjsKaW1wb3J0IGphdmEubGFuZy5yZWZsZWN0Lk1ldGhvZDsKaW1w\nb3J0IGphdmEubWF0aC5CaWdEZWNpbWFsOwppbXBvcnQgamF2YS5tYXRoLkJp\nZ0ludGVnZXI7CmltcG9ydCBqYXZhLm5ldC5VUkw7CmltcG9ydCBqYXZhLnRl\neHQuTnVtYmVyRm9ybWF0OwppbXBvcnQgamF2YS51dGlsLkFycmF5TGlzdDsK\naW1wb3J0IGphdmEudXRpbC5BcnJheXM7CmltcG9ydCBqYXZhLnV0aWwuQ29s\nbGVjdGlvbjsKaW1wb3J0IGphdmEudXRpbC5Db2xsZWN0aW9uczsKaW1wb3J0\nIGphdmEudXRpbC5Db21wYXJhdG9yOwppbXBvcnQgamF2YS51dGlsLkRhdGU7\nCmltcG9ydCBqYXZhLnV0aWwuSGFzaE1hcDsKaW1wb3J0IGphdmEudXRpbC5J\ndGVyYXRvcjsKaW1wb3J0IGphdmEudXRpbC5MaW5rZWRMaXN0OwppbXBvcnQg\namF2YS51dGlsLkxpc3Q7CmltcG9ydCBqYXZhLnV0aWwuTGlzdEl0ZXJhdG9y\nOwppbXBvcnQgamF2YS51dGlsLk1hcDsKaW1wb3J0IGphdmEudXRpbC5Ob1N1\nY2hFbGVtZW50RXhjZXB0aW9uOwppbXBvcnQgamF2YS51dGlsLlN0cmluZ1Rv\na2VuaXplcjsKCmltcG9ydCBqdW5pdC5mcmFtZXdvcmsuVGVzdENhc2U7Cmlt\ncG9ydCBqdW5pdC5mcmFtZXdvcmsuVGVzdFJlc3VsdDsKaW1wb3J0IGp1bml0\nLnRleHR1aS5UZXN0UnVubmVyOwppbXBvcnQgb3JnLmFwYWNoZS5yZWdleHAu\nUkU7CmltcG9ydCBvcmcuYXBhY2hlLnJlZ2V4cC5SRVN5bnRheEV4Y2VwdGlv\nbjsKaW1wb3J0IG9yZy5hcGFjaGUucmVnZXhwLlJFVXRpbDsKaW1wb3J0IG9y\nZy5hcGFjaGUudG9vbHMuYW50LkFudENsYXNzTG9hZGVyOwppbXBvcnQgb3Jn\nLmFwYWNoZS50b29scy5hbnQuUHJvamVjdDsKaW1wb3J0IG9yZy5hcGFjaGUu\ndG9vbHMuYW50LlByb2plY3RIZWxwZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEubGliLmxvZy5Mb2c7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\nbGliLmxvZy5Mb2dGYWN0b3J5SW1wbDsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5saWIudXRpbC5Mb2NhbGl6ZXI7CgovKioKICogVGVzdENhc2UgZnJh\nbWV3b3JrIHRvIHJ1biB2YXJpb3VzIHRlc3RzIGFnYWluc3Qgc29sYXJtZXRy\naWMgY29kZS4KICogVGhpcyBjbGFzcyBjb250YWlucyB2YXJpb3VzIHV0aWxp\ndHkgbWV0aG9kcyBmb3IgdGhlIGZvbGxvd2luZyBmdW5jdGlvbnM6CiAqIDx1\nbD4KICogPGxpPlVzaW5nIG11bHRpcGxlLCBpc29sYXRlZCBDbGFzc0xvYWRl\ncnM8L2xpPgogKiA8bGk+UnVubmluZyBhIHRlc3QgaW4gbXVsdGlwbGUgY29u\nY3VycmVudCB0aHJlYWRzPC9saT4KICogPGxpPkFzc2VydGlvbiBoZWxwZXJz\nPC9saT4KICogPGxpPkNyZWF0aW5nIHJhbmRvbSBTdHJpbmdzLCBudW1iZXJz\nLCBldGMuPC9saT4KICogPC91bD4KICoKICogQGF1dGhvciBNYXJjIFBydWQn\naG9tbWVhdXgKICogQGF1dGhvciBQYXRyaWNrIExpbnNrZXkKICovCnB1Ymxp\nYyBhYnN0cmFjdCBjbGFzcyBBYnN0cmFjdFRlc3RDYXNlIGV4dGVuZHMgVGVz\ndENhc2UgewoKICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgU3RyaW5nIFRFU1Rf\nTUVUSE9EUyA9CiAgICAgICAgU3lzdGVtLmdldFByb3BlcnR5KEFic3RyYWN0\nVGVzdENhc2UuY2xhc3MuZ2V0TmFtZSgpICsgIi50ZXN0TWV0aG9kcyIpOwog\nICAgcHVibGljIHN0YXRpYyBmaW5hbCBsb25nIFBMQVRGT1JNX0FMTCA9IDIg\nPDwgMTsKICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgbG9uZyBQTEFURk9STV9V\nTktOT1dOID0gMiA8PCAyOwoKICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgU3Ry\naW5nIFNLSVBfVE9LRU4gPSAiU09MQVJTS0lQIjsKICAgIHB1YmxpYyBzdGF0\naWMgZmluYWwgU3RyaW5nIFNLSVBfREVMSU1JVEVSID0gInwiOwoKICAgIHBy\naXZhdGUgc3RhdGljIGZpbmFsIExvY2FsaXplciBfbG9jID0KICAgICAgICBM\nb2NhbGl6ZXIuZm9yUGFja2FnZShBYnN0cmFjdFRlc3RDYXNlLmNsYXNzKTsK\nCiAgICBwcml2YXRlIExvZyBsb2cgPSBudWxsOwoKICAgIHByaXZhdGUgc3Rh\ndGljIE1hcCBfdGltZXMgPSBuZXcgSGFzaE1hcCgpOwoKICAgIHByaXZhdGUg\nc3RhdGljIEFic3RyYWN0VGVzdENhc2UgX2xhc3RUZXN0ID0gbnVsbDsKCiAg\nICBwcml2YXRlIHN0YXRpYyBXYXRjaGRvZ1RocmVhZCBfd2F0Y2hkb2cgPSBu\nZXcgV2F0Y2hkb2dUaHJlYWQoKTsKICAgIHByaXZhdGUgbG9uZyBfdGltZW91\ndDsKCiAgICAvKioKICAgICAqIENvbnN0cnVjdG9yLiBDcmVhdGUgYSB0ZXN0\nIGNhc2Ugd2l0aCB0aGUgc3BlY2lmaWVkIG5hbWUuCiAgICAgKi8KICAgIHB1\nYmxpYyBBYnN0cmFjdFRlc3RDYXNlKFN0cmluZyB0ZXN0KSB7CiAgICAgICAg\nc3VwZXIodGVzdCk7CiAgICB9CgogICAgcHVibGljIEFic3RyYWN0VGVzdENh\nc2UoKSB7CiAgICB9CgogICAgcHJvdGVjdGVkIGZpbmFsIExvZyBnZXRMb2co\nKSB7CiAgICAgICAgaWYgKGxvZyA9PSBudWxsKQogICAgICAgICAgICBsb2cg\nPSBuZXdMb2coKTsKICAgICAgICByZXR1cm4gbG9nOwogICAgfQoKICAgIHBy\nb3RlY3RlZCBMb2cgbmV3TG9nKCkgewogICAgICAgIC8vIHRoaXMgaW1wbGVt\nZW50YXRpb24gbGVhdmVzIG11Y2ggdG8gYmUgZGVzaXJlZCwgYXMgaXQganVz\ndAogICAgICAgIC8vIGNyZWF0ZXMgYSBuZXcgTG9nRmFjdG9yeUltcGwgZWFj\naCB0aW1lLCBhbmQgZG9lcyBub3QgYXBwbHkKICAgICAgICAvLyBhbnkgY29u\nZmlndXJhdGlvbnMuCiAgICAgICAgcmV0dXJuIG5ldyBMb2dGYWN0b3J5SW1w\nbCgpLmdldExvZyhnZXRMb2dOYW1lKCkpOwogICAgfQoKICAgIHByb3RlY3Rl\nZCBTdHJpbmcgZ2V0TG9nTmFtZSgpIHsKICAgICAgICByZXR1cm4gImNvbS5z\nb2xhcm1ldHJpYy5SdW50aW1lIjsKICAgIH0KCiAgICAvKioKICAgICAqIENh\nbGxlZCBiZWZvcmUgdGhlIHdhdGNoZG9nIHRocmVhZCBpcyBhYm91dCB0byBr\naWxsIHRoZSBlbnRpcmUKICAgICAqIEpWTSBkdWUgdG8gYSB0ZXN0IGNhc2Un\ncyB0aW1lb3V0LiBUaGlzIG1ldGhvZCBvZmZlcnMgdGhlCiAgICAgKiBhYmls\naXR5IHRvIHRyeSB0byByZXNvbHZlIHdoYXRldmVyIGNvbnRlbnRpb24gaXMg\ndGFraW5nIHBsYWNlCiAgICAgKiBpbiB0aGUgdGVzdC4gSXQgd2lsbCBiZSBn\naXZlbiAxMCBzZWNvbmRzIHRvIHRyeSB0byBlbmQgdGhlCiAgICAgKiB0ZXN0\nIHBlYWNlZnVsbHkgYmVmb3JlIHRoZSB3YXRjaGRvZyBleGl0cyB0aGUgSlZN\nLgogICAgICovCiAgICBwcm90ZWN0ZWQgdm9pZCBwcmVUaW1lb3V0KCkgewog\nICAgfQoKICAgIHB1YmxpYyB2b2lkIHJ1bihUZXN0UmVzdWx0IHJlc3VsdCkg\newogICAgICAgIGlmIChza2lwVGVzdCgpKSB7CiAgICAgICAgICAgIC8vIGtl\nZXAgdHJhY2sgb2YgdGhlIHRlc3RzIHdlIHNraXAgc28gdGhhdCB3ZSBjYW4g\nZ2V0IGFuCiAgICAgICAgICAgIC8vIGlkZWEgaW4gdGhlIGF1dG9idWlsZCBz\ndGF0dXMKICAgICAgICAgICAgU3lzdGVtLmVyci5wcmludGxuKFNLSVBfVE9L\nRU4gKyBTS0lQX0RFTElNSVRFUgogICAgICAgICAgICAgICAgKyAoIiIgKyBn\nZXRDbGFzcygpLmdldE5hbWUoKSkKICAgICAgICAgICAgICAgICsgIi4iICsg\nZ2V0TmFtZSgpICsgU0tJUF9ERUxJTUlURVIpOwogICAgICAgICAgICByZXR1\ncm47CiAgICAgICAgfQoKICAgICAgICBpZiAoX2xhc3RUZXN0ICE9IG51bGwg\nJiYgX2xhc3RUZXN0LmdldENsYXNzKCkgIT0gZ2V0Q2xhc3MoKSkgewogICAg\nICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgX2xhc3RUZXN0LnRlYXJE\nb3duVGVzdENsYXNzKCk7CiAgICAgICAgICAgIH0gY2F0Y2ggKFRocm93YWJs\nZSB0KSB7CiAgICAgICAgICAgICAgICBnZXRMb2coKS5lcnJvcihudWxsLCB0\nKTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgKF9sYXN0\nVGVzdCA9PSBudWxsIHx8IF9sYXN0VGVzdC5nZXRDbGFzcygpICE9IGdldENs\nYXNzKCkpIHsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIHNl\ndFVwVGVzdENsYXNzKCk7CiAgICAgICAgICAgIH0gY2F0Y2ggKFRocm93YWJs\nZSB0KSB7CiAgICAgICAgICAgICAgICBnZXRMb2coKS5lcnJvcihudWxsLCB0\nKTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgX2xhc3RUZXN0\nID0gdGhpczsKCiAgICAgICAgLy8gaW5mb3JtIHRoZSB3YXRjaGRvZyB0aHJl\nYWQgdGhhdCB3ZSBhcmUgZW50ZXJpbmcgdGhlIHRlc3QKICAgICAgICBfd2F0\nY2hkb2cuZW50ZXJpbmdUZXN0KHRoaXMpOwogICAgICAgIHRyeSB7CiAgICAg\nICAgICAgIHN1cGVyLnJ1bihyZXN1bHQpOwogICAgICAgIH0gZmluYWxseSB7\nCiAgICAgICAgICAgIF93YXRjaGRvZy5sZWF2aW5nVGVzdCh0aGlzKTsKICAg\nICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBJZiB0aGlzIHRlc3Qgc2hv\ndWxkIGJlIHNraXBwZWQgZ2l2ZW4gdGhlIGN1cnJlbnQKICAgICAqIGVudmly\nb25tZW50LCByZXR1cm4gPGNvZGU+dHJ1ZTwvY29kZT4uIFRoaXMgYWxsb3dz\nIGEgdW5pdCB0ZXN0CiAgICAgKiBjbGFzcyB0byBkaXNhYmxlIHRlc3QgY2Fz\nZXMgb24gYSBwZXItbWV0aG9kIGdyYW51bGFyaXR5LCBhbmQKICAgICAqIHBy\nZXZlbnRzIHRoZSB0ZXN0IGZyb20gc2hvd2luZyB1cCBhcyBhIHBhc3NlZCB0\nZXN0IGp1c3QKICAgICAqIGJlY2F1c2UgaXQgd2FzIHNraXBwZWQuCiAgICAg\nKiBGb3IgZXhhbXBsZSwgaWYgYSBwYXJ0aWN1bGFyIHRlc3QgY2FzZSBtZXRo\nb2Qgc2hvdWxkIG5vdCBiZQogICAgICogcnVuIGFnYWluc3QgYSBjZXJ0YWlu\nIGRhdGFiYXNlLCB0aGlzIG1ldGhvZCBjb3VsZCBjaGVjayB0aGUKICAgICAq\nIG5hbWUgb2YgdGhlIHRlc3QgcmVzdWx0IGFuZCB0aGUgY3VycmVudCBkYXRh\nYmFzZSBjb25maWd1cmF0aW9uCiAgICAgKiBpbiBvcmRlciB0byBtYWtlIHRo\nZSBkZWNpc2lvbjoKICAgICAqIDxwLz4KICAgICAqIDxjb2RlPiBwcm90ZWN0\nZWQgYm9vbGVhbiBza2lwVGVzdCgpIHsKICAgICAqIC8vIGRvbid0IHJ1biB3\naXRoIHBvaW50YmFzZTogaXQgdXNlcyBhIERhdGFTb3VyY2UsIHdoaWNoCiAg\nICAgKiAvLyBjYW4ndCBiZSB0cmFuc2xhdGVkIGludG8gYSBKQm9zcyBEYXRh\nU291cmNlIGNvbmZpZ3VyYXRpb24uCiAgICAgKiBpZiAoInRlc3RKQm9zcyIu\nZXF1YWxzKGdldE5hbWUoKSkgJiYKICAgICAqIGdldEN1cnJlbnRQbGF0Zm9y\nbSgpID09IFBMQVRGT1JNX1BPSU5UQkFTRSkKICAgICAqIHJldHVybiB0cnVl\nOwogICAgICogfQogICAgICogPC9jb2RlPgogICAgICogSWYgeW91IHdhbnQg\ndG8gZGlzYWJsZSBleGVjdXRpb24gb2YgYW4gZW50aXJlIHRlc3QgY2FzZQog\nICAgICogY2xhc3MgZm9yIGEgZ2l2ZW4gZGF0YWJhc2UsIHlvdSBtaWdodCB3\nYW50IHRvIGFkZCB0aGUgY2xhc3MgdG8KICAgICAqIHRoZSBleGNsdWRlZCB0\nZXN0IGxpc3QgaW4gdGhhdCBkYXRhYmFzZSdzIHByb3BlcnRpZXMgZmlsZS4K\nICAgICAqLwogICAgcHJvdGVjdGVkIGJvb2xlYW4gc2tpcFRlc3QoKSB7CiAg\nICAgICAgaWYgKFRFU1RfTUVUSE9EUyAhPSBudWxsICYmIFRFU1RfTUVUSE9E\nUy5sZW5ndGgoKSA+IDApCiAgICAgICAgICAgIHJldHVybiBURVNUX01FVEhP\nRFMuaW5kZXhPZihnZXROYW1lKCkpID09IC0xOwoKICAgICAgICByZXR1cm4g\nZmFsc2U7CiAgICB9CgogICAgLyoqCiAgICAgKiBUaGlzIG1ldGhvZCBpcyBj\nYWxsZWQgYmVmb3JlIHRoZSBmaXJzdCB0ZXN0IGluIHRoaXMgdGVzdCBjbGFz\ncwogICAgICogaXMgZXhlY3V0ZWQuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lk\nIHNldFVwVGVzdENsYXNzKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBUaGlzIG1ldGhvZCBpcyBjYWxsZWQgYWZ0ZXIgdGhl\nIGxhc3QgdGVzdCBpbiB0aGlzIHRlc3QgY2xhc3MKICAgICAqIGlzIGV4ZWN1\ndGVkLiBJdCBjYW4gYmUgdXNlZCB0byBkbyB0aGluZ3MgbGlrZSBjbGVhbiB1\ncAogICAgICogbGFyZ2UsIHNsb3cgcHJvY2Vzc2VzIHRoYXQgbWF5IGhhdmUg\nYmVlbiBzdGFydGVkLgogICAgICovCiAgICBwdWJsaWMgdm9pZCB0ZWFyRG93\nblRlc3RDbGFzcygpIHRocm93cyBFeGNlcHRpb24gewogICAgfQoKICAgIHB1\nYmxpYyB2b2lkIHRlYXJEb3duKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAg\nICAgaWYgKCJ0cnVlIi5lcXVhbHMoU3lzdGVtLmdldFByb3BlcnR5KCJtZW1p\nbmZvIikpKQogICAgICAgICAgICBwcmludE1lbW9yeUluZm8oKTsKCiAgICAg\nICAgc3VwZXIudGVhckRvd24oKTsKICAgIH0KCiAgICAvLy8vLy8vLy8vLy8v\nLy8vLy8vLy8vLy8vLwogICAgLy8gR2VuZXJhdGluZyByYW5kb20gZGF0YQog\nICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KCiAgICAvKioKICAgICAq\nIFN1cHBvcnQgbWV0aG9kIHRvIGdldCBhIHJhbmRvbSBJbnRlZ2VyIGZvciB0\nZXN0aW5nLgogICAgICovCiAgICBwdWJsaWMgc3RhdGljIEludGVnZXIgcmFu\nZG9tSW50KCkgewogICAgICAgIHJldHVybiBuZXcgSW50ZWdlcigoaW50KSAo\nTWF0aC5yYW5kb20oKSAqIEludGVnZXIuTUFYX1ZBTFVFKSk7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBTdXBwb3J0IG1ldGhvZCB0byBnZXQgYSByYW5kb20g\nQ2hhcmFjdGVyIGZvciB0ZXN0aW5nLgogICAgICovCiAgICBwdWJsaWMgc3Rh\ndGljIENoYXJhY3RlciByYW5kb21DaGFyKCkgewogICAgICAgIGNoYXIgW10g\nVEVTVF9DSEFSX0FSUkFZID0gbmV3IGNoYXIgW117CiAgICAgICAgICAgICdh\nJywgJ2InLCAnYycsICdkJywgJ2UnLCAnZicsICdnJywgJ2gnLCAnaScsCiAg\nICAgICAgICAgICdqJywgJ2snLCAnbCcsICdtJywgJ24nLCAnbycsICdwJywg\nJ3EnLCAncicsCiAgICAgICAgICAgICdzJywgJ3QnLCAndScsICd2JywgJ3cn\nLCAneCcsICd5JywgJ3onLCAnMScsCiAgICAgICAgICAgICcyJywgJzMnLCAn\nNCcsICc1JywgJzYnLCAnNycsICc4JywgJzknIH07CgogICAgICAgIHJldHVy\nbiBuZXcgQ2hhcmFjdGVyKFRFU1RfQ0hBUl9BUlJBWVsKICAgICAgICAgICAg\nKGludCkgKE1hdGgucmFuZG9tKCkgKiBURVNUX0NIQVJfQVJSQVkubGVuZ3Ro\nKV0pOwogICAgfQoKICAgIC8qKgogICAgICogU3VwcG9ydCBtZXRob2QgdG8g\nZ2V0IGEgcmFuZG9tIExvbmcgZm9yIHRlc3RpbmcuCiAgICAgKi8KICAgIHB1\nYmxpYyBzdGF0aWMgTG9uZyByYW5kb21Mb25nKCkgewogICAgICAgIHJldHVy\nbiBuZXcgTG9uZygobG9uZykgKE1hdGgucmFuZG9tKCkgKiBMb25nLk1BWF9W\nQUxVRSkpOwogICAgfQoKICAgIC8qKgogICAgICogU3VwcG9ydCBtZXRob2Qg\ndG8gZ2V0IGEgcmFuZG9tIFNob3J0IGZvciB0ZXN0aW5nLgogICAgICovCiAg\nICBwdWJsaWMgc3RhdGljIFNob3J0IHJhbmRvbVNob3J0KCkgewogICAgICAg\nIHJldHVybiBuZXcgU2hvcnQoKHNob3J0KSAoTWF0aC5yYW5kb20oKSAqIFNo\nb3J0Lk1BWF9WQUxVRSkpOwogICAgfQoKICAgIC8qKgogICAgICogU3VwcG9y\ndCBtZXRob2QgdG8gZ2V0IGEgcmFuZG9tIERvdWJsZSBmb3IgdGVzdGluZy4K\nICAgICAqLwogICAgcHVibGljIHN0YXRpYyBEb3VibGUgcmFuZG9tRG91Ymxl\nKCkgewogICAgICAgIHJldHVybiBuZXcgRG91YmxlKChkb3VibGUpIChNYXRo\nLnJvdW5kKE1hdGgucmFuZG9tKCkgKiA1MDAwZCkpIC8gMTAwMGQpOwogICAg\nfQoKICAgIC8qKgogICAgICogU3VwcG9ydCBtZXRob2QgdG8gZ2V0IGEgcmFu\nZG9tIEZsb2F0IGZvciB0ZXN0aW5nLgogICAgICovCiAgICBwdWJsaWMgc3Rh\ndGljIEZsb2F0IHJhbmRvbUZsb2F0KCkgewogICAgICAgIHJldHVybiBuZXcg\nRmxvYXQoKGZsb2F0KSAoTWF0aC5yb3VuZChNYXRoLnJhbmRvbSgpICogNTAw\nMGYpKSAvIDEwMDBmKTsKICAgIH0KCiAgICAvKioKICAgICAqIFN1cHBvcnQg\nbWV0aG9kIHRvIGdldCBhIHJhbmRvbSBCeXRlIGZvciB0ZXN0aW5nLgogICAg\nICovCiAgICBwdWJsaWMgc3RhdGljIEJ5dGUgcmFuZG9tQnl0ZSgpIHsKICAg\nICAgICByZXR1cm4gbmV3IEJ5dGUoKGJ5dGUpIChNYXRoLnJhbmRvbSgpICog\nQnl0ZS5NQVhfVkFMVUUpKTsKICAgIH0KCiAgICAvKioKICAgICAqIFN1cHBv\ncnQgbWV0aG9kIHRvIGdldCBhIHJhbmRvbSBCb29sZWFuIGZvciB0ZXN0aW5n\nLgogICAgICovCiAgICBwdWJsaWMgc3RhdGljIEJvb2xlYW4gcmFuZG9tQm9v\nbGVhbigpIHsKICAgICAgICByZXR1cm4gbmV3IEJvb2xlYW4oTWF0aC5yYW5k\nb20oKSA+IDAuNSA/IHRydWUgOiBmYWxzZSk7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBTdXBwb3J0IG1ldGhvZCB0byBnZXQgYSByYW5kb20gRGF0ZSBmb3Ig\ndGVzdGluZy4KICAgICAqLwogICAgcHVibGljIHN0YXRpYyBEYXRlIHJhbmRv\nbURhdGUoKSB7CiAgICAgICAgbG9uZyBtaWxsaXMgPSAobG9uZykgKE1hdGgu\ncmFuZG9tKCkgKiBTeXN0ZW0uY3VycmVudFRpbWVNaWxsaXMoKSk7CgogICAg\nICAgIC8vIHJvdW5kIG1pbGxpcyB0byB0aGUgbmVhcmVzdCAxMDAwOiB0aGlz\nIGlzIGJlY2F1c2Ugc29tZQogICAgICAgIC8vIGRhdGFiYXNlcyBkbyBub3Qg\nc3RvcmUgdGhlIG1pbGxpc2Vjb25kcyBjb3JyZWN0bHkoZS5nLiwgTXlTUUwp\nLgogICAgICAgIC8vIFRoaXMgaXMgYSByZWFsbHkgYSBidWcgd2Ugc2hvdWxk\nIGZpeC4gRkMgIzI3LgogICAgICAgIG1pbGxpcyAtPSAobWlsbGlzICUgMTAw\nMCk7CgogICAgICAgIHJldHVybiBuZXcgRGF0ZShtaWxsaXMpOwogICAgfQoK\nICAgIC8qKgogICAgICogU3VwcG9ydCBtZXRob2QgdG8gZ2V0IGEgcmFuZG9t\nIFN0cmluZyBmb3IgdGVzdGluZy4KICAgICAqLwogICAgcHVibGljIHN0YXRp\nYyBTdHJpbmcgcmFuZG9tU3RyaW5nKCkgewogICAgICAgIC8vIGRlZmF1bHQg\ndG8gYSBzbWFsbCBzdHJpbmcsIGluIGNhc2UgY29sdW1uIHNpemVzIGFyZQog\nICAgICAgIC8vIGxpbWl0ZWQoc3VjaCBhcyB3aXRoIGEgc3RyaW5nIHByaW1h\ncnkga2V5KQogICAgICAgIHJldHVybiByYW5kb21TdHJpbmcoNTApOwogICAg\nfQoKICAgIC8qKgogICAgICogU3VwcG9ydCBtZXRob2QgdG8gZ2V0IGEgcmFu\nZG9tIFN0cmluZyBmb3IgdGVzdGluZy4KICAgICAqLwogICAgcHVibGljIHN0\nYXRpYyBTdHJpbmcgcmFuZG9tU3RyaW5nKGludCBsZW4pIHsKICAgICAgICBT\ndHJpbmdCdWZmZXIgYnVmID0gbmV3IFN0cmluZ0J1ZmZlcigpOwogICAgICAg\nIGZvciAoaW50IGkgPSAwOyBpIDwgKGludCkgKE1hdGgucmFuZG9tKCkgKiBs\nZW4pICsgMTsgaSsrKQogICAgICAgICAgICBidWYuYXBwZW5kKHJhbmRvbUNo\nYXIoKSk7CiAgICAgICAgcmV0dXJuIGJ1Zi50b1N0cmluZygpOwogICAgfQoK\nICAgIC8qKgogICAgICogU3VwcG9ydCBtZXRob2QgdG8gZ2V0IGEgcmFuZG9t\nIGNsb2IgZm9yIHRlc3RpbmcuCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0aWMg\nU3RyaW5nIHJhbmRvbUNsb2IoKSB7CiAgICAgICAgU3RyaW5nQnVmZmVyIHNi\ndWYgPSBuZXcgU3RyaW5nQnVmZmVyKCk7CiAgICAgICAgd2hpbGUgKHNidWYu\nbGVuZ3RoKCkgPCAoNSAqIDEwMjQpKSB7IC8vIGF0IGxlYXN0IDVLCiAgICAg\nICAgICAgIHNidWYuYXBwZW5kKHJhbmRvbVN0cmluZygxMDI0KSk7CiAgICAg\nICAgfQoKICAgICAgICByZXR1cm4gc2J1Zi50b1N0cmluZygpOwogICAgfQoK\nICAgIC8qKgogICAgICogU3VwcG9ydCBtZXRob2QgdG8gZ2V0IGEgcmFuZG9t\nIEJpZ0ludGVnZXIgZm9yIHRlc3RpbmcuCiAgICAgKi8KICAgIHB1YmxpYyBz\ndGF0aWMgQmlnSW50ZWdlciByYW5kb21CaWdJbnRlZ2VyKCkgewogICAgICAg\nIC8vIHRvbyBtYW55IG9mIG91ciB0ZXN0IGRhdGFiYXNlcyBkb24ndCBzdXBw\nb3J0IGJpZ2ludHMgPiBNQVhfTE9ORzoKICAgICAgICAvLyBJIGRvbid0IGxp\na2UgaXQsIGJ1dCBmb3Igbm93LCBsZXQncyBvbmx5IHRlc3QgYmVsb3cgTUFY\nX0xPTkcKICAgICAgICBCaWdJbnRlZ2VyIGxuZyA9IG5ldyBCaWdJbnRlZ2Vy\nKAogICAgICAgICAgICAoKGxvbmcpIChNYXRoLnJhbmRvbSgpICogTG9uZy5N\nQVhfVkFMVUUpKSArICIiKTsKCiAgICAgICAgQmlnSW50ZWdlciBtdWx0aXBs\naWVyID0gbmV3IEJpZ0ludGVnZXIoIjEiKTsKICAgICAgICAvLyAoMSArIChp\nbnQpKE1hdGgucmFuZG9tKCkgKiAxMDAwMCkpICsgIiIpOwogICAgICAgIGlm\nIChNYXRoLnJhbmRvbSgpIDwgMC41KQogICAgICAgICAgICBtdWx0aXBsaWVy\nID0gbXVsdGlwbGllci5tdWx0aXBseShuZXcgQmlnSW50ZWdlcigiLTEiKSk7\nCgogICAgICAgIHJldHVybiBsbmcubXVsdGlwbHkobXVsdGlwbGllcik7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBTdXBwb3J0IG1ldGhvZCB0byBnZXQgYSBy\nYW5kb20gQmlnRGVjaW1hbCBmb3IgdGVzdGluZy4KICAgICAqLwogICAgcHVi\nbGljIHN0YXRpYyBCaWdEZWNpbWFsIHJhbmRvbUJpZ0RlY2ltYWwoKSB7CiAg\nICAgICAgQmlnSW50ZWdlciBzdGFydCA9IHJhbmRvbUJpZ0ludGVnZXIoKTsK\nICAgICAgICBTdHJpbmcgc3RyID0gc3RhcnQudG9TdHJpbmcoKTsKICAgICAg\nICAvLyB0cnVuY2F0ZSBvZmYgdGhlIGxhc3QgOCBkaWdpdHM6IHdlIHN0aWxs\nIGdldCBzb21lCiAgICAgICAgLy8gb3ZlcmZsb3dzIHdpdGggbGFtZSBkYXRh\nYmFzZXMuCiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCA4OyBpKyspCiAg\nICAgICAgICAgIGlmIChzdHIubGVuZ3RoKCkgPiAyKQogICAgICAgICAgICAg\nICAgc3RyID0gc3RyLnN1YnN0cmluZygwLCBzdHIubGVuZ3RoKCkgLSAxKTsK\nICAgICAgICBzdGFydCA9IG5ldyBCaWdJbnRlZ2VyKHN0cik7CgogICAgICAg\nIFN0cmluZyB2YWwgPSBzdGFydCArICIuIiArICgoaW50KSAoTWF0aC5yYW5k\nb20oKSAqIDEwKSkKICAgICAgICAgICAgKyAoKGludCkgKE1hdGgucmFuZG9t\nKCkgKiAxMCkpCiAgICAgICAgICAgICsgKChpbnQpIChNYXRoLnJhbmRvbSgp\nICogMTApKQogICAgICAgICAgICArICgoaW50KSAoTWF0aC5yYW5kb20oKSAq\nIDEwKSkKICAgICAgICAgICAgKyAoKGludCkgKE1hdGgucmFuZG9tKCkgKiAx\nMCkpCiAgICAgICAgICAgICsgKChpbnQpIChNYXRoLnJhbmRvbSgpICogMTAp\nKQogICAgICAgICAgICArICgoaW50KSAoTWF0aC5yYW5kb20oKSAqIDEwKSkK\nICAgICAgICAgICAgKyAoKGludCkgKE1hdGgucmFuZG9tKCkgKiAxMCkpCiAg\nICAgICAgICAgICsgKChpbnQpIChNYXRoLnJhbmRvbSgpICogMTApKQogICAg\nICAgICAgICArICgoaW50KSAoTWF0aC5yYW5kb20oKSAqIDEwKSk7CgogICAg\nICAgIHJldHVybiBuZXcgQmlnRGVjaW1hbCh2YWwpOwogICAgfQoKICAgIC8q\nKgogICAgICogU3VwcG9ydCBtZXRob2QgdG8gZ2V0IGEgcmFuZG9tIGJsb2Ig\nZm9yIHRlc3RpbmcuCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0aWMgYnl0ZVtd\nIHJhbmRvbUJsb2IoKSB7CiAgICAgICAgLy8gdXAgdG8gMTAwSyBibG9iCiAg\nICAgICAgYnl0ZSBbXSBibG9iID0gbmV3IGJ5dGUgWyhpbnQpIChNYXRoLnJh\nbmRvbSgpICogMTAyNCAqIDEwMCldOwogICAgICAgIGZvciAoaW50IGkgPSAw\nOyBpIDwgYmxvYi5sZW5ndGg7IGkrKykKICAgICAgICAgICAgYmxvYltpXSA9\nIHJhbmRvbUJ5dGUoKS5ieXRlVmFsdWUoKTsKCiAgICAgICAgcmV0dXJuIGJs\nb2I7CiAgICB9CgogICAgLyoqCiAgICAgKiBJbnZva2Ugc2V0dGVycyBmb3Ig\ncGltaXRpdmVzIGFuZCBwcmltaXRpdmUgd3JhcHBlcnMgb24gdGhlCiAgICAg\nKiBzcGVjaWZpZWQgb2JqZWN0LgogICAgICovCiAgICBwdWJsaWMgc3RhdGlj\nIE9iamVjdCByYW5kb21pemVCZWFuKE9iamVjdCBiZWFuKQogICAgICAgIHRo\ncm93cyBJbnRyb3NwZWN0aW9uRXhjZXB0aW9uLCBJbGxlZ2FsQWNjZXNzRXhj\nZXB0aW9uLAogICAgICAgIEludm9jYXRpb25UYXJnZXRFeGNlcHRpb24gewog\nICAgICAgIEJlYW5JbmZvIGluZm8gPSBJbnRyb3NwZWN0b3IuZ2V0QmVhbklu\nZm8oYmVhbi5nZXRDbGFzcygpKTsKICAgICAgICBQcm9wZXJ0eURlc2NyaXB0\nb3IgW10gcHJvcHMgPSBpbmZvLmdldFByb3BlcnR5RGVzY3JpcHRvcnMoKTsK\nICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsr\nKSB7CiAgICAgICAgICAgIE1ldGhvZCB3cml0ZSA9IHByb3BzW2ldLmdldFdy\naXRlTWV0aG9kKCk7CiAgICAgICAgICAgIGlmICh3cml0ZSA9PSBudWxsKQog\nICAgICAgICAgICAgICAgY29udGludWU7CgogICAgICAgICAgICBDbGFzcyBb\nXSBwYXJhbXMgPSB3cml0ZS5nZXRQYXJhbWV0ZXJUeXBlcygpOwogICAgICAg\nICAgICBpZiAocGFyYW1zID09IG51bGwgfHwgcGFyYW1zLmxlbmd0aCAhPSAx\nKQogICAgICAgICAgICAgICAgY29udGludWU7CgogICAgICAgICAgICBDbGFz\ncyBwYXJhbVR5cGUgPSBwYXJhbXNbMF07CiAgICAgICAgICAgIE9iamVjdCBh\ncmcgPSBudWxsOwoKICAgICAgICAgICAgaWYgKHBhcmFtVHlwZSA9PSBib29s\nZWFuLmNsYXNzIHx8IHBhcmFtVHlwZSA9PSBCb29sZWFuLmNsYXNzKQogICAg\nICAgICAgICAgICAgYXJnID0gcmFuZG9tQm9vbGVhbigpOwogICAgICAgICAg\nICBlbHNlIGlmIChwYXJhbVR5cGUgPT0gYnl0ZS5jbGFzcyB8fCBwYXJhbVR5\ncGUgPT0gQnl0ZS5jbGFzcykKICAgICAgICAgICAgICAgIGFyZyA9IHJhbmRv\nbUJ5dGUoKTsKICAgICAgICAgICAgZWxzZSBpZiAocGFyYW1UeXBlID09IGNo\nYXIuY2xhc3MgfHwgcGFyYW1UeXBlID09IENoYXJhY3Rlci5jbGFzcykKICAg\nICAgICAgICAgICAgIGFyZyA9IHJhbmRvbUNoYXIoKTsKICAgICAgICAgICAg\nZWxzZSBpZiAocGFyYW1UeXBlID09IHNob3J0LmNsYXNzIHx8IHBhcmFtVHlw\nZSA9PSBTaG9ydC5jbGFzcykKICAgICAgICAgICAgICAgIGFyZyA9IHJhbmRv\nbVNob3J0KCk7CiAgICAgICAgICAgIGVsc2UgaWYgKHBhcmFtVHlwZSA9PSBp\nbnQuY2xhc3MgfHwgcGFyYW1UeXBlID09IEludGVnZXIuY2xhc3MpCiAgICAg\nICAgICAgICAgICBhcmcgPSByYW5kb21JbnQoKTsKICAgICAgICAgICAgZWxz\nZSBpZiAocGFyYW1UeXBlID09IGxvbmcuY2xhc3MgfHwgcGFyYW1UeXBlID09\nIExvbmcuY2xhc3MpCiAgICAgICAgICAgICAgICBhcmcgPSByYW5kb21Mb25n\nKCk7CiAgICAgICAgICAgIGVsc2UgaWYgKHBhcmFtVHlwZSA9PSBkb3VibGUu\nY2xhc3MgfHwgcGFyYW1UeXBlID09IERvdWJsZS5jbGFzcykKICAgICAgICAg\nICAgICAgIGFyZyA9IHJhbmRvbURvdWJsZSgpOwogICAgICAgICAgICBlbHNl\nIGlmIChwYXJhbVR5cGUgPT0gZmxvYXQuY2xhc3MgfHwgcGFyYW1UeXBlID09\nIEZsb2F0LmNsYXNzKQogICAgICAgICAgICAgICAgYXJnID0gcmFuZG9tRmxv\nYXQoKTsKICAgICAgICAgICAgZWxzZSBpZiAocGFyYW1UeXBlID09IFN0cmlu\nZy5jbGFzcykKICAgICAgICAgICAgICAgIGFyZyA9IHJhbmRvbVN0cmluZygp\nOwogICAgICAgICAgICBlbHNlIGlmIChwYXJhbVR5cGUgPT0gQmlnSW50ZWdl\nci5jbGFzcykKICAgICAgICAgICAgICAgIGFyZyA9IHJhbmRvbUJpZ0ludGVn\nZXIoKTsKICAgICAgICAgICAgZWxzZSBpZiAocGFyYW1UeXBlID09IEJpZ0Rl\nY2ltYWwuY2xhc3MpCiAgICAgICAgICAgICAgICBhcmcgPSByYW5kb21CaWdE\nZWNpbWFsKCk7CiAgICAgICAgICAgIGVsc2UgaWYgKHBhcmFtVHlwZSA9PSBE\nYXRlLmNsYXNzKQogICAgICAgICAgICAgICAgYXJnID0gcmFuZG9tRGF0ZSgp\nOwoKICAgICAgICAgICAgaWYgKGFyZyAhPSBudWxsKQogICAgICAgICAgICAg\nICAgd3JpdGUuaW52b2tlKGJlYW4sIG5ldyBPYmplY3QgW117IGFyZyB9KTsK\nICAgICAgICB9CgogICAgICAgIHJldHVybiBiZWFuOwogICAgfQoKICAgIC8q\nKgogICAgICogVXRpbGl0eSBtZXRob2QgdG8gc3RhcnQgYSBwcm9maWxlLgog\nICAgICoKICAgICAqIEBzZWUgI2VuZFByb2ZpbGUoU3RyaW5nKQogICAgICov\nCiAgICBwdWJsaWMgdm9pZCBzdGFydFByb2ZpbGUoU3RyaW5nIG5hbWUpIHsK\nICAgICAgICBfdGltZXMucHV0KG5hbWUsIG5ldyBMb25nKFN5c3RlbS5jdXJy\nZW50VGltZU1pbGxpcygpKSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBVdGls\naXR5IHRvIGVuZCB0aGUgcHJvZmlsZSBhbmQgcHJpbnQgb3V0IHRoZSB0aW1l\nLiBFeGFtcGxlIHVzYWdlOgogICAgICogPHAvPgogICAgICogPHByZT48Y29k\nZT4gc3RhcnRQcm9maWxlKCJTb21lIGxvbmcgdGFzayIpOyBkb1NvbWVMb25n\nVGFzaygpOwogICAgICogZW5kUHJvZmlsZSgiU29tZSBsb25nIHRhc2siKTsK\nICAgICAqIDwvY29kZT48L3ByZT4KICAgICAqCiAgICAgKiBAcGFyYW0gbmFt\nZQogICAgICogQHJldHVybiB0aGUgYW1vdW50IG9mIHRpbWUgdGhhdCB0aGlz\nIHByb2ZpbGUgaW52b2NhdGlvbiB0b29rLCBvcgogICAgICogICAgICAgICAt\nMSBpZiA8Y29kZT5uYW1lPC9jb2RlPiB3YXMgbmV2ZXIgc3RhcnRlZC4KICAg\nICAqLwogICAgcHVibGljIGxvbmcgZW5kUHJvZmlsZShTdHJpbmcgbmFtZSkg\newogICAgICAgIExvbmcgdGltZSA9IChMb25nKSBfdGltZXMucmVtb3ZlKG5h\nbWUpOwoKICAgICAgICBsb25nIGVsYXBzZWQgPSAtMTsKICAgICAgICBpZiAo\ndGltZSAhPSBudWxsKQogICAgICAgICAgICBlbGFwc2VkID0gU3lzdGVtLmN1\ncnJlbnRUaW1lTWlsbGlzKCkgLSB0aW1lLmxvbmdWYWx1ZSgpOwoKICAgICAg\nICBnZXRMb2coKS5pbmZvKF9sb2MuZ2V0KCJwcm9maWxlLWluZm8iLCBuYW1l\nLAogICAgICAgICAgICAodGltZSA9PSBudWxsID8gIj8/PyIgOiAiIiArIGVs\nYXBzZWQpKSk7CiAgICAgICAgcmV0dXJuIGVsYXBzZWQ7CiAgICB9CgogICAg\nLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwogICAgLy8gQ2xhc3NMb2FkZXIg\nZnVuY3Rpb25zCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCgogICAg\nLyoqCiAgICAgKiBDcmVhdGUgYSBDbGFzc0xvYWRlciB0aGF0IHdpbGwgbm90\nIHVzZSB0aGUgcGFyZW50CiAgICAgKiBDbGFzc0xvYWRlciB0byByZXNvbHZl\nIGNsYXNzZXMuIFRoaXMgaXMgdXNlZnVsIGZvcgogICAgICogdGVzdGluZyBp\nbnRlcmFjdGlvbnMgYmV0d2VlbiBLb2RvIGluIHJ1bm5pbmcKICAgICAqIGlu\nIENsYXNzTG9hZGVyQSBhbmQgaW5zdGFuY2VzIGluIENsYXNzTG9hZGVyQi4K\nICAgICAqLwogICAgcHVibGljIENsYXNzTG9hZGVyIGNyZWF0ZUlzb2xhdGVk\nQ2xhc3NMb2FkZXIoKSB7CiAgICAgICAgcmV0dXJuIG5ldyBJc29sYXRlZENs\nYXNzTG9hZGVyKCk7CiAgICB9CgogICAgcHVibGljIE5lc3RlZENsYXNzTG9h\nZGVyIGNyZWF0ZU5lc3RlZENsYXNzTG9hZGVyKCkgewogICAgICAgIHJldHVy\nbiBuZXcgTmVzdGVkQ2xhc3NMb2FkZXIoZmFsc2UpOwogICAgfQoKICAgIHB1\nYmxpYyBOZXN0ZWRDbGFzc0xvYWRlciBjcmVhdGVOZXN0ZWRQYXJlbnRDbGFz\nc0xvYWRlcigpIHsKICAgICAgICByZXR1cm4gbmV3IE5lc3RlZENsYXNzTG9h\nZGVyKHRydWUpOwogICAgfQoKICAgIC8qKgogICAgICogUmVsb2FkIHRoZSBz\ncGVjaWZpZWQgY2xhc3MgaW4gYW4gaXNvbGF0ZWQgQ2xhc3NMb2FkZXIuCiAg\nICAgKgogICAgICogQHBhcmFtIHRhcmdldCB0aGUgdGFyZ2V0IGNsYXNzIHRv\nIGxvYWQKICAgICAqIEByZXR1cm4gdGhlIENsYXNzIGFzIHJlbG9hZGVkIGlu\nIGFuIG5ldyBDbGFzc0xvYWRlcgogICAgICovCiAgICBwdWJsaWMgQ2xhc3Mg\naXNvbGF0ZShDbGFzcyB0YXJnZXQpIHRocm93cyBDbGFzc05vdEZvdW5kRXhj\nZXB0aW9uIHsKICAgICAgICBDbGFzcyByZXN1bHQgPSBpc29sYXRlKHRhcmdl\ndC5nZXROYW1lKCkpOwogICAgICAgIGFzc2VydFRydWUocmVzdWx0ICE9IHRh\ncmdldCk7CiAgICAgICAgYXNzZXJ0Tm90RXF1YWxzKHJlc3VsdCwgdGFyZ2V0\nKTsKICAgICAgICBhc3NlcnRUcnVlKHJlc3VsdC5nZXRDbGFzc0xvYWRlcigp\nICE9IHRhcmdldC5nZXRDbGFzc0xvYWRlcigpKTsKICAgICAgICByZXR1cm4g\ncmVzdWx0OwogICAgfQoKICAgIHB1YmxpYyBDbGFzcyBpc29sYXRlKFN0cmlu\nZyB0YXJnZXQpIHRocm93cyBDbGFzc05vdEZvdW5kRXhjZXB0aW9uIHsKICAg\nICAgICBDbGFzc0xvYWRlciBpbCA9IGNyZWF0ZUlzb2xhdGVkQ2xhc3NMb2Fk\nZXIoKTsKICAgICAgICBDbGFzcyByZXN1bHQgPSBpbC5sb2FkQ2xhc3ModGFy\nZ2V0KTsKICAgICAgICBhc3NlcnRFcXVhbHMocmVzdWx0LmdldE5hbWUoKSwg\ndGFyZ2V0KTsKCiAgICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0KCiAgICBw\ndWJsaWMgQ2xhc3MgbmVzdChDbGFzcyB0YXJnZXQpIHRocm93cyBDbGFzc05v\ndEZvdW5kRXhjZXB0aW9uIHsKICAgICAgICBDbGFzc0xvYWRlciBpbCA9IGNy\nZWF0ZU5lc3RlZENsYXNzTG9hZGVyKCk7CiAgICAgICAgQ2xhc3MgcmVzdWx0\nID0gaWwubG9hZENsYXNzKHRhcmdldC5nZXROYW1lKCkpOwogICAgICAgIGFz\nc2VydFRydWUocmVzdWx0ICE9IHRhcmdldCk7CiAgICAgICAgYXNzZXJ0Tm90\nRXF1YWxzKHJlc3VsdCwgdGFyZ2V0KTsKICAgICAgICBhc3NlcnRUcnVlKHJl\nc3VsdC5nZXRDbGFzc0xvYWRlcigpICE9IHRhcmdldC5nZXRDbGFzc0xvYWRl\ncigpKTsKICAgICAgICBhc3NlcnRFcXVhbHMocmVzdWx0LmdldE5hbWUoKSwg\ndGFyZ2V0LmdldE5hbWUoKSk7CgogICAgICAgIHJldHVybiByZXN1bHQ7CiAg\nICB9CgogICAgcHVibGljIE9iamVjdCBpc29sYXRlTmV3KENsYXNzIHRhcmdl\ndCkKICAgICAgICB0aHJvd3MgQ2xhc3NOb3RGb3VuZEV4Y2VwdGlvbiwgSWxs\nZWdhbEFjY2Vzc0V4Y2VwdGlvbiwKICAgICAgICBJbnN0YW50aWF0aW9uRXhj\nZXB0aW9uIHsKICAgICAgICByZXR1cm4gaXNvbGF0ZSh0YXJnZXQpLm5ld0lu\nc3RhbmNlKCk7CiAgICB9CgogICAgcHJpdmF0ZSBzdGF0aWMgY2xhc3MgTmVz\ndGVkQ2xhc3NMb2FkZXIgZXh0ZW5kcyBBbnRDbGFzc0xvYWRlciB7CgogICAg\nICAgIHB1YmxpYyBOZXN0ZWRDbGFzc0xvYWRlcihib29sZWFuIHVzZVBhcmVu\ndCkgewogICAgICAgICAgICBzdXBlcihDbGFzc0xvYWRlci5nZXRTeXN0ZW1D\nbGFzc0xvYWRlcigpLCB1c2VQYXJlbnQpOwoKICAgICAgICAgICAgZm9yIChT\ndHJpbmdUb2tlbml6ZXIgY2x0b2sgPSBuZXcgU3RyaW5nVG9rZW5pemVyKAog\nICAgICAgICAgICAgICAgU3lzdGVtLmdldFByb3BlcnR5KCJqYXZhLmNsYXNz\nLnBhdGgiKSwgRmlsZS5wYXRoU2VwYXJhdG9yKTsKICAgICAgICAgICAgICAg\nIGNsdG9rLmhhc01vcmVUb2tlbnMoKTspIHsKICAgICAgICAgICAgICAgIFN0\ncmluZyBwYXRoID0gY2x0b2submV4dFRva2VuKCk7CgogICAgICAgICAgICAg\nICAgLy8gb25seSBsb2FkIHRlc3QgcGF0aHMsIG5vdCBqYXIgZmlsZXMKICAg\nICAgICAgICAgICAgIGlmIChwYXRoLmluZGV4T2YoIi5qYXIiKSAhPSAtMSkK\nICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgICAg\nIGlmIChwYXRoLmluZGV4T2YoIi56aXAiKSAhPSAtMSkKICAgICAgICAgICAg\nICAgICAgICBjb250aW51ZTsKCiAgICAgICAgICAgICAgICBhZGRQYXRoRWxl\nbWVudChwYXRoKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgdHJ5IHsK\nICAgICAgICAgICAgICAgIGlmICghdXNlUGFyZW50KSB7CiAgICAgICAgICAg\nICAgICAgICAgYXNzZXJ0VHJ1ZShsb2FkQ2xhc3MKICAgICAgICAgICAgICAg\nICAgICAgICAgKEFic3RyYWN0VGVzdENhc2UuY2xhc3MuZ2V0TmFtZSgpKS5n\nZXRDbGFzc0xvYWRlcigpCiAgICAgICAgICAgICAgICAgICAgICAgICE9IEFi\nc3RyYWN0VGVzdENhc2UuY2xhc3MuZ2V0Q2xhc3NMb2FkZXIoKSk7CiAgICAg\nICAgICAgICAgICB9CiAgICAgICAgICAgIH0gY2F0Y2ggKENsYXNzTm90Rm91\nbmRFeGNlcHRpb24gY25mZSkgewogICAgICAgICAgICAgICAgZmFpbChjbmZl\nLnRvU3RyaW5nKCkpOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAg\nICBwdWJsaWMgQ2xhc3MgZmluZENsYXNzKFN0cmluZyBuYW1lKSB0aHJvd3Mg\nQ2xhc3NOb3RGb3VuZEV4Y2VwdGlvbiB7CiAgICAgICAgICAgIC8vIGRvbid0\nIGlzb2xhdGUgUEMgYW5kIHJlbGF0ZWQgY2xhc3NlcyBpbiBrb2RvLmVuaG5h\nY2UKICAgICAgICAgICAgaWYgKG5hbWUuaW5kZXhPZigiLmVuaGFuY2UuIikg\nIT0gLTEpCiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgQ2xhc3NOb3RGb3Vu\nZEV4Y2VwdGlvbihuYW1lKTsKICAgICAgICAgICAgaWYgKG5hbWUuaW5kZXhP\nZigiL2VuaGFuY2UvIikgIT0gLTEpCiAgICAgICAgICAgICAgICB0aHJvdyBu\nZXcgQ2xhc3NOb3RGb3VuZEV4Y2VwdGlvbihuYW1lKTsKICAgICAgICAgICAg\ncmV0dXJuIHN1cGVyLmZpbmRDbGFzcyhuYW1lKTsKICAgICAgICB9CiAgICB9\nCgogICAgLyoqCiAgICAgKiBBIENsYXNzTG9hZGVyIHRoYXQgaXMgY29tcGxl\ndGVseSBpc29sYXRlZCB3aXRoIHJlc3BlY3QgdG8KICAgICAqIGFueSBjbGFz\nc2VzIHRoYXQgYXJlIGxvYWRlZCBpbiB0aGUgU3lzdGVtIENsYXNzTG9hZGVy\nLgogICAgICoKICAgICAqIEBhdXRob3IgTWFyYyBQcnVkJ2hvbW1lYXV4CiAg\nICAgKi8KICAgIHByaXZhdGUgc3RhdGljIGNsYXNzIElzb2xhdGVkQ2xhc3NM\nb2FkZXIgZXh0ZW5kcyBOZXN0ZWRDbGFzc0xvYWRlciB7CgogICAgICAgIHB1\nYmxpYyBJc29sYXRlZENsYXNzTG9hZGVyKCkgewogICAgICAgICAgICBzdXBl\ncihmYWxzZSk7CiAgICAgICAgICAgIHNldElzb2xhdGVkKGZhbHNlKTsKICAg\nICAgICB9CiAgICB9CgogICAgLy8vLy8vLy8vLy8vLy8vCiAgICAvLyBDb2xs\nZWN0aW9ucwogICAgLy8vLy8vLy8vLy8vLy8vCgogICAgLyoqCiAgICAgKiBW\nYWxpZGF0ZSB0aGF0IHRoZSBzcGVjaWZpZWQge0BsaW5rIENvbGxlY3Rpb259\nIGZ1bGZpbGxzIHRoZQogICAgICogQ29sbGVjdGlvbiBjb250cmFjdCBhcyBz\ncGVjaWZpZWQgYnkgdGhlIENvbGxlY3Rpb25zIEFQSS4KICAgICAqIDxwLz4K\nICAgICAqIDxzdHJvbmc+Tm90ZTwvc3Ryb25nPjogZG9lcyBub3QgdmFsaWRh\ndGUgbXV0YWJsZSBvcGVyYXRpb25zCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0\naWMgdm9pZCB2YWxpZGF0ZUNvbGxlY3Rpb24oQ29sbGVjdGlvbiBjb2xsZWN0\naW9uKSB7CiAgICAgICAgaW50IHNpemUgPSBjb2xsZWN0aW9uLnNpemUoKTsK\nICAgICAgICBpbnQgaXRlcmF0ZWQgPSAwOwogICAgICAgIC8vIGVuc3VyZSB3\nZSBjYW4gd2FsayBhbG9uZyB0aGUgaXRlcmF0b3IKICAgICAgICBmb3IgKEl0\nZXJhdG9yIGkgPSBjb2xsZWN0aW9uLml0ZXJhdG9yKCk7IGkuaGFzTmV4dCgp\nOykgewogICAgICAgICAgICBpdGVyYXRlZCsrOwogICAgICAgICAgICBpLm5l\neHQoKTsKICAgICAgICB9CgogICAgICAgIC8vIGVuc3VyZSB0aGUgbnVtYmVy\nIG9mIHZhbHVlcyBpdGVyYXRlZCBpcyB0aGUgc2FtZSBhcyB0aGUgbGlzdCBz\naXplCiAgICAgICAgYXNzZXJ0RXF1YWxzKHNpemUsIGl0ZXJhdGVkKTsKCiAg\nICAgICAgLy8gYWxzbyB2YWxpZGF0ZSB0aGUgbGlzdAogICAgICAgIGlmIChj\nb2xsZWN0aW9uIGluc3RhbmNlb2YgTGlzdCkgewogICAgICAgICAgICBMaXN0\nIGxsID0gbmV3IEFycmF5TGlzdCgpOwogICAgICAgICAgICBmb3IgKGludCBp\nID0gMDsgaSA8IDEwMDsgaSsrKQogICAgICAgICAgICAgICAgbGwuYWRkKG5l\ndyBJbnRlZ2VyKGkpKTsKICAgICAgICAgICAgdmFsaWRhdGVMaXN0KChMaXN0\nKSBsbCk7CiAgICAgICAgICAgIHZhbGlkYXRlTGlzdCgoTGlzdCkgY29sbGVj\ndGlvbik7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogVmFsaWRh\ndGUgdGhhdCB0aGUgc3BlY2lmaWVkIHtAbGluayBMaXN0fSBmdWxmaWxscyB0\naGUKICAgICAqIExpc3QgY29udHJhY3QgYXMgc3BlY2lmaWVkIGJ5IHRoZSBD\nb2xsZWN0aW9ucyBBUEkuCiAgICAgKiA8cC8+CiAgICAgKiA8c3Ryb25nPk5v\ndGU8L3N0cm9uZz46IGRvZXMgbm90IHZhbGlkYXRlIG11dGFibGUgb3BlcmF0\naW9ucwogICAgICovCiAgICBwdWJsaWMgc3RhdGljIHZvaWQgdmFsaWRhdGVM\naXN0KExpc3QgbGlzdCkgewogICAgICAgIE9iamVjdCBbXSBjb3JlVmFsdWVz\nID0gbGlzdC50b0FycmF5KCk7CiAgICAgICAgT2JqZWN0IFtdIHZhbHVlczEg\nPSBuZXcgT2JqZWN0IFtsaXN0LnNpemUoKV07CiAgICAgICAgT2JqZWN0IFtd\nIHZhbHVlczIgPSBuZXcgT2JqZWN0IFtsaXN0LnNpemUoKV07CiAgICAgICAg\nT2JqZWN0IFtdIHZhbHVlczMgPSBuZXcgT2JqZWN0IFtsaXN0LnNpemUoKV07\nCiAgICAgICAgT2JqZWN0IFtdIHZhbHVlczQgPSBuZXcgT2JqZWN0IFtsaXN0\nLnNpemUoKV07CgogICAgICAgIC8vIGZpbGwgc2VxdWVudGlhbCBpbmRleCBh\nY2Nlc3MgbGlzdAogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgbGlzdC5z\naXplKCk7IGkrKykKICAgICAgICAgICAgdmFsdWVzMVtpXSA9IGxpc3QuZ2V0\nKGkpOwoKICAgICAgICAvLyBmaWxsIHNlcXVlbnRpYWwgbGlzdAogICAgICAg\nIGludCBpbmRleCA9IDA7CiAgICAgICAgTGlzdEl0ZXJhdG9yIGl0ZXI7CiAg\nICAgICAgZm9yIChpdGVyID0gbGlzdC5saXN0SXRlcmF0b3IoMCk7IGl0ZXIu\naGFzTmV4dCgpOykgewogICAgICAgICAgICBhc3NlcnRFcXVhbHMoaW5kZXgs\nIGl0ZXIubmV4dEluZGV4KCkpOwogICAgICAgICAgICBhc3NlcnRFcXVhbHMo\naW5kZXgsIGl0ZXIucHJldmlvdXNJbmRleCgpICsgMSk7CiAgICAgICAgICAg\nIHZhbHVlczJbaW5kZXhdID0gaXRlci5uZXh0KCk7CiAgICAgICAgICAgIGFz\nc2VydFRydWUobGlzdC5jb250YWlucyh2YWx1ZXMyW2luZGV4XSkpOwogICAg\nICAgICAgICBpbmRleCsrOwogICAgICAgIH0KCiAgICAgICAgLy8gZW5zdXJl\nIE5vU3VjaEVsZW1lbnRFeGNlcHRpb24gaXMgdGhyb3duIGFzIGFwcHJvcHJp\nYXRlCiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgaXRlci5uZXh0KCk7CiAg\nICAgICAgICAgIGZhaWwoIm5leHQoKSBzaG91bGQgaGF2ZSByZXN1bHRlZCBp\nbiBhIE5vU3VjaEVsZW1lbnRFeGNlcHRpb24iKTsKICAgICAgICB9IGNhdGNo\nIChOb1N1Y2hFbGVtZW50RXhjZXB0aW9uIGUpIHsKICAgICAgICB9IC8vIGFz\nIGV4cGVjdGVkCgogICAgICAgIC8vIGZpbGwgcmV2ZXJzZSBzZXF1ZW50aWFs\nIGxpc3QKICAgICAgICBpbnQgYmFjayA9IDA7CiAgICAgICAgZm9yIChpdGVy\nID0gbGlzdC5saXN0SXRlcmF0b3IobGlzdC5zaXplKCkpOyBpdGVyLmhhc1By\nZXZpb3VzKCk7KSB7CiAgICAgICAgICAgIGFzc2VydEVxdWFscyhpbmRleCwg\naXRlci5wcmV2aW91c0luZGV4KCkgKyAxKTsKICAgICAgICAgICAgYXNzZXJ0\nRXF1YWxzKGluZGV4LCBpdGVyLm5leHRJbmRleCgpKTsKICAgICAgICAgICAg\ndmFsdWVzM1stLWluZGV4XSA9IGl0ZXIucHJldmlvdXMoKTsKICAgICAgICAg\nICAgYmFjaysrOwogICAgICAgIH0KICAgICAgICBhc3NlcnRFcXVhbHMobGlz\ndC5zaXplKCksIGJhY2spOwoKICAgICAgICAvLyBlbnN1cmUgTm9TdWNoRWxl\nbWVudEV4Y2VwdGlvbiBpcyB0aHJvd24gYXMgYXBwcm9wcmlhdGUKICAgICAg\nICB0cnkgewogICAgICAgICAgICBpdGVyLnByZXZpb3VzKCk7CiAgICAgICAg\nICAgIGZhaWwoInByZXZpb3VzKCkgc2hvdWxkIGhhdmUgcmVzdWx0ZWQgaW4g\nYSAiCiAgICAgICAgICAgICAgICArICJOb1N1Y2hFbGVtZW50RXhjZXB0aW9u\nIik7CiAgICAgICAgfSBjYXRjaCAoTm9TdWNoRWxlbWVudEV4Y2VwdGlvbiBl\nKSB7CiAgICAgICAgfSAvLyBhcyBleHBlY3RlZAoKICAgICAgICAvLyBmaWxs\nIHJhbmRvbSBhY2Nlc3MgbGlzdAogICAgICAgIExpc3QgaW5kaWNlcyA9IG5l\ndyBMaW5rZWRMaXN0KCk7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBs\naXN0LnNpemUoKTsgaSsrKQogICAgICAgICAgICBpbmRpY2VzLmFkZChuZXcg\nSW50ZWdlcihpKSk7CgogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgbGlz\ndC5zaXplKCk7IGkrKykgewogICAgICAgICAgICBpbnQgcmFuZCA9IChpbnQp\nIChNYXRoLnJhbmRvbSgpICogaW5kaWNlcy5zaXplKCkpOwogICAgICAgICAg\nICBJbnRlZ2VyIHJhbmRJbmRleCA9IChJbnRlZ2VyKSBpbmRpY2VzLnJlbW92\nZShyYW5kKTsKICAgICAgICAgICAgdmFsdWVzNFtyYW5kSW5kZXguaW50VmFs\ndWUoKV0gPSBsaXN0LmdldChyYW5kSW5kZXguaW50VmFsdWUoKSk7CiAgICAg\nICAgfQoKICAgICAgICBhc3NlcnRFcXVhbHMoQXJyYXlzLmFzTGlzdChjb3Jl\nVmFsdWVzKSwgQXJyYXlzLmFzTGlzdCh2YWx1ZXMxKSk7CiAgICAgICAgYXNz\nZXJ0SWRlbnRpY2FsKEFycmF5cy5hc0xpc3QoY29yZVZhbHVlcyksIEFycmF5\ncy5hc0xpc3QodmFsdWVzMSkpOwogICAgICAgIGFzc2VydEVxdWFscyhBcnJh\neXMuYXNMaXN0KGNvcmVWYWx1ZXMpLCBBcnJheXMuYXNMaXN0KHZhbHVlczIp\nKTsKICAgICAgICBhc3NlcnRJZGVudGljYWwoQXJyYXlzLmFzTGlzdChjb3Jl\nVmFsdWVzKSwgQXJyYXlzLmFzTGlzdCh2YWx1ZXMyKSk7CiAgICAgICAgYXNz\nZXJ0RXF1YWxzKEFycmF5cy5hc0xpc3QoY29yZVZhbHVlcyksIEFycmF5cy5h\nc0xpc3QodmFsdWVzNCkpOwogICAgICAgIGFzc2VydElkZW50aWNhbChBcnJh\neXMuYXNMaXN0KGNvcmVWYWx1ZXMpLCBBcnJheXMuYXNMaXN0KHZhbHVlczQp\nKTsKICAgICAgICBhc3NlcnRFcXVhbHMoQXJyYXlzLmFzTGlzdChjb3JlVmFs\ndWVzKSwgQXJyYXlzLmFzTGlzdCh2YWx1ZXMzKSk7CiAgICAgICAgYXNzZXJ0\nSWRlbnRpY2FsKEFycmF5cy5hc0xpc3QoY29yZVZhbHVlcyksIEFycmF5cy5h\nc0xpc3QodmFsdWVzMykpOwogICAgfQoKICAgIC8qKgogICAgICogQXNzZXJ0\nIHRoYXQgdGhlIGdpdmVuIExpc3QgY29udGFpbiB0aGUgZXhhY3Qgc2FtZQog\nICAgICogZWxlbWVudHMuIFRoaXMgaXMgZGlmZmVyZW50IHRoYW4gdGhlIG5v\ncm1hbCBMaXN0IGNvbnRyYWN0LCB3aGljaAogICAgICogc3RhdGVzIHRoYXQg\nbGlzdDEuZXF1YWxzKGxpc3QyKSBpZiBlYWNoIGVsZW1lbnQgZTEuZXF1YWxz\nKGUyKS4KICAgICAqIFRoaXMgbWV0aG9kIGFzc2VydHMgdGhhdCBlMSA9PSBu\nMi4KICAgICAqLwogICAgcHVibGljIHN0YXRpYyB2b2lkIGFzc2VydElkZW50\naWNhbChMaXN0IGMxLCBMaXN0IGMyKSB7CiAgICAgICAgYXNzZXJ0RXF1YWxz\nKGMxLnNpemUoKSwgYzIuc2l6ZSgpKTsKICAgICAgICBmb3IgKEl0ZXJhdG9y\nIGkxID0gYzEuaXRlcmF0b3IoKSwgaTIgPSBjMi5pdGVyYXRvcigpOwogICAg\nICAgICAgICBpMS5oYXNOZXh0KCkgJiYgaTIuaGFzTmV4dCgpOykKICAgICAg\nICAgICAgYXNzZXJ0VHJ1ZShpMS5uZXh0KCkgPT0gaTIubmV4dCgpKTsKICAg\nIH0KCiAgICAvKioKICAgICAqIEFzc2VydCB0aGF0IHRoZSBjb2xsZWN0aW9u\nIHBhcmFtZXRlciBpcyBhbHJlYWR5IG9yZGVyZWQKICAgICAqIGFjY29yZGlu\nZyB0byB0aGUgc3BlY2lmaWVkIGNvbXBhcmF0b3IuCiAgICAgKi8KICAgIHB1\nYmxpYyB2b2lkIGFzc2VydE9yZGVyZWQoQ29sbGVjdGlvbiBjLCBDb21wYXJh\ndG9yIGNvbXApIHsKICAgICAgICBMaXN0IGwxID0gbmV3IExpbmtlZExpc3Qo\nYyk7CiAgICAgICAgTGlzdCBsMiA9IG5ldyBMaW5rZWRMaXN0KGMpOwogICAg\nICAgIGFzc2VydEVxdWFscyhsMSwgbDIpOwogICAgICAgIENvbGxlY3Rpb25z\nLnNvcnQobDIsIGNvbXApOwogICAgICAgIGFzc2VydEVxdWFscyhsMSwgbDIp\nOwogICAgICAgIENvbGxlY3Rpb25zLnNvcnQobDEsIGNvbXApOwogICAgICAg\nIGFzc2VydEVxdWFscyhsMSwgbDIpOwogICAgfQoKICAgIC8vLy8vLy8vLy8v\nLy8vLy8vLy8vCiAgICAvLyBBc3NlcnRpb24gSGVscGVycwogICAgLy8vLy8v\nLy8vLy8vLy8vLy8vLy8KCiAgICBwdWJsaWMgdm9pZCBhc3NlcnROb3RFcXVh\nbHMoT2JqZWN0IGEsIE9iamVjdCBiKSB7CiAgICAgICAgaWYgKGEgPT0gbnVs\nbCAmJiBiICE9IG51bGwpCiAgICAgICAgICAgIHJldHVybjsKICAgICAgICBp\nZiAoYSAhPSBudWxsICYmIGIgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJu\nOwogICAgICAgIGlmICghKGEuZXF1YWxzKGIpKSkKICAgICAgICAgICAgcmV0\ndXJuOwogICAgICAgIGlmICghKGIuZXF1YWxzKGEpKSkKICAgICAgICAgICAg\ncmV0dXJuOwoKICAgICAgICBmYWlsKCJleHBlY3RlZCAhPCIgKyBhICsgIj4u\nZXF1YWxzKDwiICsgYiArICI+KSIpOwogICAgfQoKICAgIHB1YmxpYyB2b2lk\nIGFzc2VydFNpemUoaW50IHNpemUsIE9iamVjdCBvYikgewogICAgICAgIGlm\nIChvYiA9PSBudWxsKSB7CiAgICAgICAgICAgIGFzc2VydEVxdWFscyhzaXpl\nLCAwKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAg\naWYgKG9iIGluc3RhbmNlb2YgQ29sbGVjdGlvbikKICAgICAgICAgICAgb2Ig\nPSAoKENvbGxlY3Rpb24pIG9iKS5pdGVyYXRvcigpOwogICAgICAgIGlmIChv\nYiBpbnN0YW5jZW9mIEl0ZXJhdG9yKSB7CiAgICAgICAgICAgIEl0ZXJhdG9y\nIGkgPSAoSXRlcmF0b3IpIG9iOwogICAgICAgICAgICBpbnQgY291bnQgPSAw\nOwogICAgICAgICAgICB3aGlsZSAoaS5oYXNOZXh0KCkpIHsKICAgICAgICAg\nICAgICAgIGNvdW50Kys7CiAgICAgICAgICAgICAgICBpLm5leHQoKTsKICAg\nICAgICAgICAgfQoKICAgICAgICAgICAgYXNzZXJ0RXF1YWxzKHNpemUsIGNv\ndW50KTsKICAgICAgICB9IGVsc2UKICAgICAgICAgICAgZmFpbCgiYXNzZXJ0\nU2l6ZTogZXhwZWN0ZWQgQ29sbGVjdGlvbiwgSXRlcmF0b3IsICIKICAgICAg\nICAgICAgICAgICsgIlF1ZXJ5LCBvciBFeHRlbnQsIGJ1dCBnb3QgIiArIG9i\nLmdldENsYXNzKCkuZ2V0TmFtZSgpKTsKICAgIH0KCiAgICAvLy8vLy8vLy8v\nLy8vLy8vLy8vLy8KICAgIC8vIEdlbmVyaWMgdXRpbGl0aWVzCiAgICAvLy8v\nLy8vLy8vLy8vLy8vLy8vLy8KCiAgICBwdWJsaWMgdm9pZCBjb3B5KEZpbGUg\nZnJvbSwgRmlsZSB0bykgdGhyb3dzIElPRXhjZXB0aW9uIHsKICAgICAgICBj\nb3B5KG5ldyBGaWxlSW5wdXRTdHJlYW0oZnJvbSksIHRvKTsKICAgIH0KCiAg\nICBwdWJsaWMgdm9pZCBjb3B5KElucHV0U3RyZWFtIGluLCBGaWxlIHRvKSB0\naHJvd3MgSU9FeGNlcHRpb24gewogICAgICAgIEZpbGVPdXRwdXRTdHJlYW0g\nZm91dCA9IG5ldyBGaWxlT3V0cHV0U3RyZWFtKHRvKTsKCiAgICAgICAgYnl0\nZVtdIGIgPSBuZXcgYnl0ZVsxMDI0XTsKCiAgICAgICAgZm9yIChpbnQgbiA9\nIDA7IChuID0gaW4ucmVhZChiKSkgIT0gLTE7KQogICAgICAgICAgICBmb3V0\nLndyaXRlKGIsIDAsIG4pOwogICAgfQoKICAgIC8qKgogICAgICogUHJpbnQg\nb3V0IGluZm9ybWF0aW9uIG9uIG1lbW9yeSB1c2FnZS4KICAgICAqLwogICAg\ncHVibGljIHZvaWQgcHJpbnRNZW1vcnlJbmZvKCkgewogICAgICAgIFJ1bnRp\nbWUgcnQgPSBSdW50aW1lLmdldFJ1bnRpbWUoKTsKICAgICAgICBsb25nIHRv\ndGFsID0gcnQudG90YWxNZW1vcnkoKTsKICAgICAgICBsb25nIGZyZWUgPSBy\ndC5mcmVlTWVtb3J5KCk7CiAgICAgICAgbG9uZyB1c2VkID0gdG90YWwgLSBm\ncmVlOwoKICAgICAgICBOdW1iZXJGb3JtYXQgbmYgPSBOdW1iZXJGb3JtYXQu\nZ2V0SW5zdGFuY2UoKTsKICAgICAgICBnZXRMb2coKS53YXJuKF9sb2MuZ2V0\nKCJtZW0taW5mbyIsCiAgICAgICAgICAgIG5mLmZvcm1hdCh1c2VkKSwKICAg\nICAgICAgICAgbmYuZm9ybWF0KHRvdGFsKSwKICAgICAgICAgICAgbmYuZm9y\nbWF0KGZyZWUpKSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gYSBs\naXN0IG9mIGFsbCB2YWx1ZXMgaXRlcmF0ZWQgYnkgdGhlIGdpdmVuIGl0ZXJh\ndG9yLgogICAgICovCiAgICBwdWJsaWMgc3RhdGljIExpc3QgaXRlcmF0b3JU\nb0xpc3QoSXRlcmF0b3IgaSkgewogICAgICAgIExpbmtlZExpc3QgbGlzdCA9\nIG5ldyBMaW5rZWRMaXN0KCk7CiAgICAgICAgd2hpbGUgKGkuaGFzTmV4dCgp\nKQogICAgICAgICAgICBsaXN0LmFkZChpLm5leHQoKSk7CiAgICAgICAgcmV0\ndXJuIGxpc3Q7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gYW4gYXJy\nYXkgb2YgdGhlIG9iamVjdHMgaXRlcmF0ZWQgYnkgdGhlIGdpdmVuIGl0ZXJh\ndG9yLgogICAgICovCiAgICBwdWJsaWMgc3RhdGljIE9iamVjdCBbXSBpdGVy\nYXRvclRvQXJyYXkoSXRlcmF0b3IgaSwgQ2xhc3MgW10gY2xhenopIHsKICAg\nICAgICByZXR1cm4gaXRlcmF0b3JUb0xpc3QoaSkudG9BcnJheShjbGF6eik7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBSdW4gYW50IG9uIHRoZSBzcGVjaWZp\nZWQgYnVpbGQgZmlsZS4KICAgICAqCiAgICAgKiBAcGFyYW0gYnVpbGRGaWxl\nIHRoZSBidWlsZCBmaWxlIHRvIHVzZQogICAgICogQHBhcmFtIHRhcmdldCB0\naGUgbmFtZSBvZiB0aGUgdGFyZ2V0IHRvIGludm9rZQogICAgICovCiAgICBw\ndWJsaWMgdm9pZCBhbnQoRmlsZSBidWlsZEZpbGUsIFN0cmluZyB0YXJnZXQp\nIHsKICAgICAgICBhc3NlcnRUcnVlKGJ1aWxkRmlsZS5pc0ZpbGUoKSk7Cgog\nICAgICAgIFByb2plY3QgcHJvamVjdCA9IG5ldyBQcm9qZWN0KCk7CiAgICAg\nICAgcHJvamVjdC5pbml0KCk7CiAgICAgICAgcHJvamVjdC5zZXRVc2VyUHJv\ncGVydHkoImFudC5maWxlIiwgYnVpbGRGaWxlLmdldEFic29sdXRlUGF0aCgp\nKTsKICAgICAgICBQcm9qZWN0SGVscGVyLmNvbmZpZ3VyZVByb2plY3QocHJv\namVjdCwgYnVpbGRGaWxlKTsKICAgICAgICBwcm9qZWN0LmV4ZWN1dGVUYXJn\nZXQodGFyZ2V0KTsKICAgIH0KCiAgICAvKioKICAgICAqIFNlcmlhbGl6ZSBh\nbmQgZGVzZXJpYWxpemUgdGhlIG9iamVjdC4KICAgICAqCiAgICAgKiBAcGFy\nYW0gdmFsaWRhdGVFcXVhbGl0eSBtYWtlIHN1cmUgdGhlIGhhc2hDb2RlIGFu\nZCBlcXVhbHMKICAgICAqIG1ldGhvZHMgaG9sZCB0cnVlCiAgICAgKi8KICAg\nIHB1YmxpYyBzdGF0aWMgT2JqZWN0IHJvdW5kdHJpcChPYmplY3Qgb3JpZywg\nYm9vbGVhbiB2YWxpZGF0ZUVxdWFsaXR5KQogICAgICAgIHRocm93cyBJT0V4\nY2VwdGlvbiwgQ2xhc3NOb3RGb3VuZEV4Y2VwdGlvbiB7CiAgICAgICAgYXNz\nZXJ0Tm90TnVsbChvcmlnKTsKCiAgICAgICAgQnl0ZUFycmF5T3V0cHV0U3Ry\nZWFtIGJvdXQgPSBuZXcgQnl0ZUFycmF5T3V0cHV0U3RyZWFtKCk7CiAgICAg\nICAgT2JqZWN0T3V0cHV0U3RyZWFtIG91dCA9IG5ldyBPYmplY3RPdXRwdXRT\ndHJlYW0oYm91dCk7CiAgICAgICAgb3V0LndyaXRlT2JqZWN0KG9yaWcpOwog\nICAgICAgIEJ5dGVBcnJheUlucHV0U3RyZWFtIGJpbiA9IG5ldyBCeXRlQXJy\nYXlJbnB1dFN0cmVhbSgKICAgICAgICAgICAgYm91dC50b0J5dGVBcnJheSgp\nKTsKICAgICAgICBPYmplY3RJbnB1dFN0cmVhbSBpbiA9IG5ldyBPYmplY3RJ\nbnB1dFN0cmVhbShiaW4pOwogICAgICAgIE9iamVjdCByZXN1bHQgPSBpbi5y\nZWFkT2JqZWN0KCk7CgogICAgICAgIGlmICh2YWxpZGF0ZUVxdWFsaXR5KSB7\nCiAgICAgICAgICAgIGFzc2VydEVxdWFscyhvcmlnLCByZXN1bHQpOwogICAg\nICAgICAgICBhc3NlcnRFcXVhbHMob3JpZy5oYXNoQ29kZSgpLCByZXN1bHQu\naGFzaENvZGUoKSk7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gcmVzdWx0\nOwogICAgfQoKICAgIC8qKgogICAgICogQHJldHVybiB0cnVlIGlmIHRoZSBz\ncGVjaWZpZWQgaW5wdXQgbWF0Y2hlcyB0aGUgcmVndWxhciBleHByZXNzaW9u\nIHJlZ2V4LgogICAgICovCiAgICBwdWJsaWMgc3RhdGljIGJvb2xlYW4gbWF0\nY2hlcyhTdHJpbmcgcmVnZXgsIFN0cmluZyBpbnB1dCkKICAgICAgICB0aHJv\nd3MgUkVTeW50YXhFeGNlcHRpb24gewogICAgICAgIFJFIHJlID0gUkVVdGls\nLmNyZWF0ZVJFKHJlZ2V4KTsKICAgICAgICByZXR1cm4gcmUubWF0Y2goaW5w\ndXQpOwogICAgfQoKICAgIHB1YmxpYyBzdGF0aWMgdm9pZCBhc3NlcnRNYXRj\naGVzKFN0cmluZyByZWdleCwgU3RyaW5nIGlucHV0KSB7CiAgICAgICAgdHJ5\nIHsKICAgICAgICAgICAgaWYgKCEobWF0Y2hlcyhyZWdleCwgaW5wdXQpKSkK\nICAgICAgICAgICAgICAgIGZhaWwoIkV4cGVjdGVkIHJlZ3VsYXIgZXhwcmVz\nc2lvbjogPCIgKyByZWdleCArICI+IgogICAgICAgICAgICAgICAgICAgICsg\nIiBkaWQgbm90IG1hdGNoOiA8IiArIGlucHV0ICsgIj4iKTsKICAgICAgICB9\nIGNhdGNoIChSRVN5bnRheEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgIHRo\ncm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24oZS50b1N0cmluZygp\nKTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGljIHN0YXRpYyB2b2lkIGFz\nc2VydE5vdE1hdGNoZXMoU3RyaW5nIHJlZ2V4LCBTdHJpbmcgaW5wdXQpIHsK\nICAgICAgICB0cnkgewogICAgICAgICAgICBpZiAobWF0Y2hlcyhyZWdleCwg\naW5wdXQpKQogICAgICAgICAgICAgICAgZmFpbCgiUmVndWxhciBleHByZXNz\naW9uOiA8IiArIHJlZ2V4ICsgIj4iCiAgICAgICAgICAgICAgICAgICAgKyAi\nIHNob3VsZCBub3QgbWF0Y2g6IDwiICsgaW5wdXQgKyAiPiIpOwogICAgICAg\nIH0gY2F0Y2ggKFJFU3ludGF4RXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAg\ndGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbihlLnRvU3RyaW5n\nKCkpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIENoZWNrIHRo\nZSBsaXN0IGlmIHN0cmluZ3MgYW5kIHJldHVybiB0aGUgb25lcyB0aGF0IG1h\ndGNoCiAgICAgKiB0aGUgc3BlY2lmaWVkIG1hdGNoLgogICAgICovCiAgICBw\ndWJsaWMgc3RhdGljIExpc3QgbWF0Y2hlcyhTdHJpbmcgcmVnZXgsIENvbGxl\nY3Rpb24gaW5wdXQpCiAgICAgICAgdGhyb3dzIFJFU3ludGF4RXhjZXB0aW9u\nIHsKICAgICAgICBMaXN0IG1hdGNoZXMgPSBuZXcgQXJyYXlMaXN0KCk7CiAg\nICAgICAgZm9yIChJdGVyYXRvciBpID0gaW5wdXQuaXRlcmF0b3IoKTsgaS5o\nYXNOZXh0KCk7KSB7CiAgICAgICAgICAgIFN0cmluZyBjaGVjayA9IChTdHJp\nbmcpIGkubmV4dCgpOwogICAgICAgICAgICBpZiAobWF0Y2hlcyhyZWdleCwg\nY2hlY2spKQogICAgICAgICAgICAgICAgbWF0Y2hlcy5hZGQoY2hlY2spOwog\nICAgICAgIH0KCiAgICAgICAgcmV0dXJuIG1hdGNoZXM7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBBc3NlcnQgdGhhdCB0aGUgc3BlY2lmaWVkIGNvbGxlY3Rp\nb24gb2YgU3RyaW5ncyBjb250YWlucyBhdCBsZWFzdAogICAgICogb25lIHN0\ncmluZyB0aGF0IG1hdGNoZXMgdGhlIHNwZWNpZmllZCByZWd1bGFyIGV4cHJl\nc3Npb24uCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0aWMgdm9pZCBhc3NlcnRN\nYXRjaGVzKFN0cmluZyByZWdleCwgQ29sbGVjdGlvbiBpbnB1dCkgewogICAg\nICAgIHRyeSB7CiAgICAgICAgICAgIGlmIChtYXRjaGVzKHJlZ2V4LCBpbnB1\ndCkuc2l6ZSgpID09IDApCiAgICAgICAgICAgICAgICBmYWlsKCJUaGUgc3Bl\nY2lmaWVkIGxpc3Qgb2Ygc2l6ZSAiICsgaW5wdXQuc2l6ZSgpCiAgICAgICAg\nICAgICAgICAgICAgKyAiIGRpZCBub3QgY29udGFpbiBhbnkgc3RyaW5ncyB0\naGF0IG1hdGNoIHRoZSIKICAgICAgICAgICAgICAgICAgICArICIgc3BlY2lm\naWVkIHJlZ3VsYXIgZXhwcmVzc2lvbihcIiIgKyByZWdleCArICJcIikiKTsK\nICAgICAgICB9IGNhdGNoIChSRVN5bnRheEV4Y2VwdGlvbiBlKSB7CiAgICAg\nICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24oZS50\nb1N0cmluZygpKTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBB\nc3NlcnQgdGhhdCB0aGUgc3BlY2lmaWVkIGNvbGxlY3Rpb24gb2YgU3RyaW5n\ncyBkb2VzIG5vdCBtYXRjaAogICAgICogdGhlIHNwZWNpZmllZCByZWd1bGFy\nIGV4cHJlc3Npb24uCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0aWMgdm9pZCBh\nc3NlcnROb3RNYXRjaGVzKFN0cmluZyByZWdleCwgQ29sbGVjdGlvbiBpbnB1\ndCkgewogICAgICAgIHRyeSB7CiAgICAgICAgICAgIExpc3QgbWF0Y2hlczsK\nCiAgICAgICAgICAgIGlmICgoKG1hdGNoZXMgPSBtYXRjaGVzKHJlZ2V4LCBp\nbnB1dCkpKS5zaXplKCkgPiAwKQogICAgICAgICAgICAgICAgZmFpbCgiVGhl\nIHNwZWNpZmllZCBsaXN0IG9mIHNpemUgIiArIGlucHV0LnNpemUoKQogICAg\nICAgICAgICAgICAgICAgICsgIiBkaWQgY29udGFpbiBvbmUgb3IgbW9yZSBz\ndHJpbmdzIHRoYXQgbWF0Y2hzIHRoZSIKICAgICAgICAgICAgICAgICAgICAr\nICIgc3BlY2lmaWVkIGlsbGVnYWwgcmVndWxhciBleHByZXNzaW9uIgogICAg\nICAgICAgICAgICAgICAgICsgIiAoXCIiICsgcmVnZXggKyAiXCIpLiIKICAg\nICAgICAgICAgICAgICAgICArICIgRmlyc3QgZXhhbXBsZSBvZiBhIG1hdGNo\naW5nIG1lc3NhZ2UgaXM6ICIKICAgICAgICAgICAgICAgICAgICArIG1hdGNo\nZXMuaXRlcmF0b3IoKS5uZXh0KCkpOwogICAgICAgIH0gY2F0Y2ggKFJFU3lu\ndGF4RXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVn\nYWxBcmd1bWVudEV4Y2VwdGlvbihlLnRvU3RyaW5nKCkpOwogICAgICAgIH0K\nICAgIH0KCiAgICAvKioKICAgICAqIFRvIGJlIGNhbGxlZCBieSB0aGUgY2hp\nbGQuIEUuZy46CiAgICAgKiA8Y29kZT4gcHVibGljIHN0YXRpYyB2b2lkIG1h\naW4oU3RyaW5nIFtdIGFyZ3MpIHsgbWFpbihUZXN0QnVnMzc1LmNsYXNzKTsK\nICAgICAqIH0KICAgICAqIDwvY29kZT4KICAgICAqLwogICAgcHVibGljIHN0\nYXRpYyB2b2lkIG1haW4oQ2xhc3MgYykgewogICAgICAgIFRlc3RSdW5uZXIu\ncnVuKGMpOwogICAgfQoKICAgIC8qKgogICAgICogVG8gYmUgY2FsbGVkIGJ5\nIGNoaWxkLiBGaWd1cmVzIG91dCB0aGUgY2xhc3MgZnJvbSB0aGUgY2FsbGlu\nZyBjb250ZXh0LgogICAgICovCiAgICBwdWJsaWMgc3RhdGljIHZvaWQgbWFp\nbigpIHsKICAgICAgICBTdHJpbmcgY2FsbGVyID0gbmV3IFNlY3VyaXR5TWFu\nYWdlcigpIHsKICAgICAgICAgICAgcHVibGljIFN0cmluZyB0b1N0cmluZygp\nIHsKICAgICAgICAgICAgICAgIHJldHVybiBnZXRDbGFzc0NvbnRleHQoKVsy\nXS5nZXROYW1lKCk7CiAgICAgICAgICAgIH0KICAgICAgICB9LnRvU3RyaW5n\nKCk7CgogICAgICAgIHRyeSB7CiAgICAgICAgICAgIG1haW4oQ2xhc3MuZm9y\nTmFtZShjYWxsZXIpKTsKICAgICAgICB9IGNhdGNoIChDbGFzc05vdEZvdW5k\nRXhjZXB0aW9uIGNuZmUpIHsKICAgICAgICAgICAgdGhyb3cgbmV3IFJ1bnRp\nbWVFeGNlcHRpb24oY25mZS50b1N0cmluZygpKTsKICAgICAgICB9CiAgICB9\nCgogICAgLyoqCiAgICAgKiBSZXR1cm5zIHRoZSBqYXIgZmlsZSBpbiB3aGlj\naCB0aGUgY2xhc3MgaXMgY29udGFpbmVkLgogICAgICoKICAgICAqIEByZXR1\ncm4gdGhlIGphciBmaWxlLCBvciBub25lIGlmIHRoZSBjbGFzcyBpcyBub3Qg\naW4gYSBqYXIKICAgICAqIEB0aHJvd3MgRmlsZU5vdEZvdW5kRXhjZXB0aW9u\nIGlmIHRoZSBqYXIgZmlsZSBjYW5ub3QgbG9jYXRlZAogICAgICovCiAgICBw\ndWJsaWMgc3RhdGljIEZpbGUgZ2V0SmFyRmlsZShDbGFzcyBjbGF6eikgdGhy\nb3dzIEZpbGVOb3RGb3VuZEV4Y2VwdGlvbiB7CiAgICAgICAgVVJMIHVybCA9\nIGNsYXp6LmdldFJlc291cmNlKGNsYXp6LmdldE5hbWUoKS5zdWJzdHJpbmco\nCiAgICAgICAgICAgIGNsYXp6LmdldE5hbWUoKS5sYXN0SW5kZXhPZigiLiIp\nICsgMSkgKyAiLmNsYXNzIik7CiAgICAgICAgaWYgKHVybCA9PSBudWxsKQog\nICAgICAgICAgICB0aHJvdyBuZXcgRmlsZU5vdEZvdW5kRXhjZXB0aW9uKGNs\nYXp6LnRvU3RyaW5nKCkpOwoKICAgICAgICBTdHJpbmcgZmlsZSA9IHVybC5n\nZXRGaWxlKCk7CiAgICAgICAgaWYgKGZpbGUgPT0gbnVsbCkKICAgICAgICAg\nICAgdGhyb3cgbmV3IEZpbGVOb3RGb3VuZEV4Y2VwdGlvbih1cmwudG9TdHJp\nbmcoKSk7CiAgICAgICAgaW50IGluZGV4ID0gZmlsZS5pbmRleE9mKCIhIik7\nCiAgICAgICAgaWYgKGluZGV4ID09IC0xKQogICAgICAgICAgICB0aHJvdyBu\nZXcgRmlsZU5vdEZvdW5kRXhjZXB0aW9uKGZpbGUpOwoKICAgICAgICBmaWxl\nID0gZmlsZS5zdWJzdHJpbmcoMCwgaW5kZXgpOwogICAgICAgIGZpbGUgPSBm\naWxlLnN1YnN0cmluZygiZmlsZToiLmxlbmd0aCgpKTsKCiAgICAgICAgRmls\nZSBmID0gbmV3IEZpbGUoZmlsZSk7CiAgICAgICAgaWYgKCEoZi5pc0ZpbGUo\nKSkpCiAgICAgICAgICAgIHRocm93IG5ldyBGaWxlTm90Rm91bmRFeGNlcHRp\nb24oZmlsZSk7CgogICAgICAgIHJldHVybiBmLmdldEFic29sdXRlRmlsZSgp\nOwogICAgfQoKICAgIC8qKgogICAgICogVGhlIG51bWJlciBvZiBtaWxsaXNl\nY29uZHMgZWFjaCB0ZXN0IGNhc2Ugd2lsbCBoYXZlIGZvciBhIHRpbWVvdXQu\nCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldFRpbWVvdXQobG9uZyB0aW1l\nb3V0KSB7CiAgICAgICAgX3RpbWVvdXQgPSB0aW1lb3V0OwogICAgfQoKICAg\nIC8qKgogICAgICogVGhlIG51bWJlciBvZiBtaWxsaXNlY29uZHMgZWFjaCB0\nZXN0IGNhc2Ugd2lsbCBoYXZlIGZvciBhIHRpbWVvdXQuCiAgICAgKi8KICAg\nIHB1YmxpYyBsb25nIGdldFRpbWVvdXQoKSB7CiAgICAgICAgcmV0dXJuIF90\naW1lb3V0OwogICAgfQoKICAgIC8qKgogICAgICogQSB3YXRjaGRvZyB0aGF0\nIGp1c3QgZXhpdHMgdGhlIEpWTSBpZiBhIHRlc3QgaGFzIG5vdCBjb21wbGV0\nZWQgaW4KICAgICAqIGEgY2VydGFpbiBhbW91bnQgb2YgdGltZS4gVGhpcyBz\ncGVlZHMgdXAgdGhlIG1lY2hhbmlzbSBvZiBkZXRlcm1pbmluZwogICAgICog\naWYgYSB0aW1lb3V0IGhhcyBvY2N1cnJlZCwgc2luY2Ugd2UgY2FuIGV4aXQg\ndGhlIGVudGlyZSB0ZXN0IHJ1bgogICAgICogaWYgYSB0ZXN0IGhhc24ndCBj\nb21wbGV0ZWQgaW4gYSBzaG9ydGVkIGFtb3VudCBvZiB0aW1lIHRoYW4KICAg\nICAqIHRoZSBnbG9iYWwgdGVzdCB0aW1lb3V0LgogICAgICoKICAgICAqIEBh\ndXRob3IgTWFyYyBQcnVkJ2hvbW1lYXV4CiAgICAgKi8KICAgIHByaXZhdGUg\nc3RhdGljIGNsYXNzIFdhdGNoZG9nVGhyZWFkIGV4dGVuZHMgVGhyZWFkIHsK\nCiAgICAgICAgcHJpdmF0ZSBmaW5hbCBsb25nIF90aW1lb3V0bXM7CiAgICAg\nICAgcHJpdmF0ZSBsb25nIF9lbmR0aW1lID0gLTE7CiAgICAgICAgcHJpdmF0\nZSBBYnN0cmFjdFRlc3RDYXNlIF9jdXJ0ZXN0ID0gbnVsbDsKCiAgICAgICAg\ncHVibGljIFdhdGNoZG9nVGhyZWFkKCkgewogICAgICAgICAgICBzdXBlcigi\nS29kbyB0ZXN0IGNhc2Ugd2F0Y2hkb2cgdGhyZWFkIik7CiAgICAgICAgICAg\nIHNldERhZW1vbih0cnVlKTsKCiAgICAgICAgICAgIGludCB0aW1lb3V0TWlu\nID0gbmV3IEludGVnZXIKICAgICAgICAgICAgICAgIChTeXN0ZW0uZ2V0UHJv\ncGVydHkoImF1dG9idWlsZC50ZXN0Y2FzZS50aW1lb3V0IiwgIjIwIikpCiAg\nICAgICAgICAgICAgICAuaW50VmFsdWUoKTsKCiAgICAgICAgICAgIF90aW1l\nb3V0bXMgPSB0aW1lb3V0TWluICogNjAgKiAxMDAwOwogICAgICAgIH0KCiAg\nICAgICAgcHVibGljIHZvaWQgcnVuKCkgewogICAgICAgICAgICB3aGlsZSAo\ndHJ1ZSkgewogICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAg\nICAgICBzbGVlcCgyMDApOwogICAgICAgICAgICAgICAgfSBjYXRjaCAoSW50\nZXJydXB0ZWRFeGNlcHRpb24gaWUpIHsKICAgICAgICAgICAgICAgIH0KCiAg\nICAgICAgICAgICAgICBpZiAoX2VuZHRpbWUgPiAwICYmIFN5c3RlbS5jdXJy\nZW50VGltZU1pbGxpcygpID4gX2VuZHRpbWUpIHsKICAgICAgICAgICAgICAg\nICAgICBUaHJlYWQgcHJlVGltZW91dCA9IG5ldyBUaHJlYWQKICAgICAgICAg\nICAgICAgICAgICAgICAgKCJBdHRlbXB0aW5nIHByZS10aW1lb3V0IGZvciAi\nICsgX2N1cnRlc3QpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcHVibGlj\nIHZvaWQgcnVuKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgX2N1\ncnRlc3QucHJlVGltZW91dCgpOwogICAgICAgICAgICAgICAgICAgICAgICB9\nCiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICBw\ncmVUaW1lb3V0LnN0YXJ0KCk7CgogICAgICAgICAgICAgICAgICAgIC8vIHdh\naXQgYSBsaXR0bGUgd2hpbGUgZm9yIHRoZSBwcmUtdGltZW91dAogICAgICAg\nICAgICAgICAgICAgIC8vIHRocmVhZCB0byBjb21wbGV0ZQogICAgICAgICAg\nICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHByZVRp\nbWVvdXQuam9pbigxMCAqIDEwMDApOwogICAgICAgICAgICAgICAgICAgIH0g\nY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgICAgICAgICAgfQoK\nICAgICAgICAgICAgICAgICAgICAvLyBnaXZlIGl0IGEgZmV3IG1vcmUgc2Vj\nb25kcy4uLgogICAgICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAg\nICAgICAgICAgICAgIHNsZWVwKDUgKiAxMDAwKTsKICAgICAgICAgICAgICAg\nICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkgewogICAgICAgICAgICAgICAg\nICAgIH0KCiAgICAgICAgICAgICAgICAgICAgLy8gbmV3IGVuZHRpbWU/IHJl\nc3VtZS4uLgogICAgICAgICAgICAgICAgICAgIGlmIChTeXN0ZW0uY3VycmVu\ndFRpbWVNaWxsaXMoKSA8IF9lbmR0aW1lKQogICAgICAgICAgICAgICAgICAg\nICAgICBjb250aW51ZTsKCiAgICAgICAgICAgICAgICAgICAgbmV3IEV4Y2Vw\ndGlvbigidGVzdCBjYXNlICIKICAgICAgICAgICAgICAgICAgICAgICAgKyAo\nX2N1cnRlc3QgIT0gbnVsbCA/IF9jdXJ0ZXN0LmdldE5hbWUoKQogICAgICAg\nICAgICAgICAgICAgICAgICA6ICJVTktOT1dOIikgKyAiIHRpbWVkIG91dCBh\nZnRlciAiCiAgICAgICAgICAgICAgICAgICAgICAgICsgX3RpbWVvdXRtcyAr\nICJtcyIpLnByaW50U3RhY2tUcmFjZSgpOwoKICAgICAgICAgICAgICAgICAg\nICAvLyBhbHNvIHJ1biAia2lsbGFsbCAtUVVJVCBqYXZhIiB0byB0cnkgdG8g\nZ3JhYgogICAgICAgICAgICAgICAgICAgIC8vIGEgc3RhY2sgdHJhY2UKICAg\nICAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgICAg\nICBSdW50aW1lLmdldFJ1bnRpbWUoKS5leGVjCiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAobmV3IFN0cmluZ1tdeyAia2lsbGFsbCIsICItUVVJVCIs\nICJqYXZhIiB9KTsKICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChFeGNl\ncHRpb24gZSkgewogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAg\nICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICAgICAgc2xlZXAo\nMTAwMCk7CiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoSW50ZXJydXB0\nZWRFeGNlcHRpb24gaWUpIHsKICAgICAgICAgICAgICAgICAgICB9CgogICAg\nICAgICAgICAgICAgICAgIC8vIG5vdyBhY3R1YWxseSBleGl0CiAgICAgICAg\nICAgICAgICAgICAgU3lzdGVtLmV4aXQoMTExKTsKICAgICAgICAgICAgICAg\nIH0KICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgcHVibGljIHN5\nbmNocm9uaXplZCB2b2lkIGVudGVyaW5nVGVzdChBYnN0cmFjdFRlc3RDYXNl\nIHRlc3QpIHsKICAgICAgICAgICAgbG9uZyB0aW1lb3V0ID0gdGVzdC5nZXRU\naW1lb3V0KCk7CiAgICAgICAgICAgIGlmICh0aW1lb3V0IDw9IDApCiAgICAg\nICAgICAgICAgICB0aW1lb3V0ID0gX3RpbWVvdXRtczsKCiAgICAgICAgICAg\nIF9lbmR0aW1lID0gU3lzdGVtLmN1cnJlbnRUaW1lTWlsbGlzKCkgKyB0aW1l\nb3V0OwogICAgICAgICAgICBfY3VydGVzdCA9IHRlc3Q7CgogICAgICAgICAg\nICBpZiAoIWlzQWxpdmUoKSkKICAgICAgICAgICAgICAgIHN0YXJ0KCk7CiAg\nICAgICAgfQoKICAgICAgICBwdWJsaWMgc3luY2hyb25pemVkIHZvaWQgbGVh\ndmluZ1Rlc3QoQWJzdHJhY3RUZXN0Q2FzZSB0ZXN0KSB7CiAgICAgICAgICAg\nIF9lbmR0aW1lID0gLTE7CiAgICAgICAgICAgIF9jdXJ0ZXN0ID0gbnVsbDsK\nICAgICAgICB9CiAgICB9Cn0K\n","encoding":"base64"}

