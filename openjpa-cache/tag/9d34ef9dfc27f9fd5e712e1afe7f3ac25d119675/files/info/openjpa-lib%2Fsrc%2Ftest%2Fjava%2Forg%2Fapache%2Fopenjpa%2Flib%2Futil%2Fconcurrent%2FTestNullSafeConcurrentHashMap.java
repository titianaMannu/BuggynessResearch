{"sha":"a39620107e864578a1cdb44e391b902778e5b1ea","node_id":"MDQ6QmxvYjIwNjM2NDphMzk2MjAxMDdlODY0NTc4YTFjZGI0NGUzOTFiOTAyNzc4ZTViMWVh","size":5999,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/a39620107e864578a1cdb44e391b902778e5b1ea","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNr\nYWdlIG9yZy5hcGFjaGUub3BlbmpwYS5saWIudXRpbC5jb25jdXJyZW50OwoK\naW1wb3J0IGphdmEuaW8uSU9FeGNlcHRpb247CmltcG9ydCBqYXZhLnV0aWwu\nU2V0OwppbXBvcnQgamF2YS51dGlsLkNvbGxlY3Rpb247CmltcG9ydCBqYXZh\nLnV0aWwuTWFwOwppbXBvcnQgamF2YS51dGlsLkhhc2hNYXA7CmltcG9ydCBq\nYXZhLnV0aWwuTWFwLkVudHJ5OwoKaW1wb3J0IG9yZy5hcGFjaGUub3Blbmpw\nYS5saWIudGVzdC5BYnN0cmFjdFRlc3RDYXNlOwoKcHVibGljIGNsYXNzIFRl\nc3ROdWxsU2FmZUNvbmN1cnJlbnRIYXNoTWFwIGV4dGVuZHMgQWJzdHJhY3RU\nZXN0Q2FzZSB7CgogICAgcHJpdmF0ZSBOdWxsU2FmZUNvbmN1cnJlbnRIYXNo\nTWFwIG5ld01hcCgpIHsKICAgICAgICByZXR1cm4gbmV3IE51bGxTYWZlQ29u\nY3VycmVudEhhc2hNYXAoKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCB0ZXN0\nUmVtb3ZlUmFuZG9tSXNOb3RUb3RhbGx5RGV0ZXJtaW5pc3RpYygpIHsKICAg\nICAgICByZW1vdmVIZWxwZXIoZmFsc2UpOwogICAgfQoKICAgIHB1YmxpYyB2\nb2lkIHRlc3RSYW5kb21JdGVyYXRvcklzTm90VG90YWxseURldGVybWluaXN0\naWMoKSB7CiAgICAgICAgcmVtb3ZlSGVscGVyKHRydWUpOwogICAgfQoKICAg\nIHByaXZhdGUgdm9pZCByZW1vdmVIZWxwZXIoYm9vbGVhbiBpdGVyKSB7CiAg\nICAgICAgTWFwPFN0cmluZyxJbnRlZ2VyPiByZW1vdmVkQ291bnRzID0gbmV3\nIEhhc2hNYXAoKTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IDEwMDA7\nIGkrKykgewogICAgICAgICAgICBOdWxsU2FmZUNvbmN1cnJlbnRIYXNoTWFw\nIG0gPSBuZXcgTnVsbFNhZmVDb25jdXJyZW50SGFzaE1hcCgpOwogICAgICAg\nICAgICBtLnB1dCgiYSIsICJBIik7CiAgICAgICAgICAgIG0ucHV0KCJiIiwg\nIkIiKTsKICAgICAgICAgICAgbS5wdXQoImMiLCAiQyIpOwogICAgICAgICAg\nICBtLnB1dCgiZCIsICJEIik7CiAgICAgICAgICAgIG0ucHV0KCJlIiwgIkUi\nKTsKICAgICAgICAgICAgbS5wdXQoImYiLCAiRiIpOwogICAgICAgICAgICBt\nLnB1dCgiZyIsICJHIik7CgogICAgICAgICAgICBTdHJpbmcgcmVtb3ZlZDsK\nICAgICAgICAgICAgaWYgKGl0ZXIpIHsKICAgICAgICAgICAgICAgIHJlbW92\nZWQgPSAoU3RyaW5nKSBtLnJlbW92ZVJhbmRvbSgpLmdldEtleSgpOwogICAg\nICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgcmVtb3ZlZCA9IChT\ndHJpbmcpICgoRW50cnkpIG0ucmFuZG9tRW50cnlJdGVyYXRvcigpLm5leHQo\nKSkKICAgICAgICAgICAgICAgICAgICAuZ2V0S2V5KCk7CiAgICAgICAgICAg\nICAgICBtLnJlbW92ZShyZW1vdmVkKTsKICAgICAgICAgICAgfQoKICAgICAg\nICAgICAgSW50ZWdlciBjb3VudCA9IHJlbW92ZWRDb3VudHMuZ2V0KHJlbW92\nZWQpOwogICAgICAgICAgICBpZiAoY291bnQgPT0gbnVsbCkKICAgICAgICAg\nICAgICAgIHJlbW92ZWRDb3VudHMucHV0KHJlbW92ZWQsIDEpOwogICAgICAg\nICAgICBlbHNlCiAgICAgICAgICAgICAgICByZW1vdmVkQ291bnRzLnB1dChy\nZW1vdmVkLCBjb3VudC5pbnRWYWx1ZSgpICsgMSk7CiAgICAgICAgfQoKICAg\nICAgICAvLyBhc3N1bWUgdGhhdCBvdmVyIDEwMDAgcnVucywgZXZlcnkgZWxl\nbWVudCBzaG91bGQgYmUgcmVtb3ZlZCBhdAogICAgICAgIC8vIGxlYXN0IG9u\nY2UsIGFuZCBubyBlbGVtZW50IHNob3VsZCBiZSByZW1vdmVkIG1vcmUgdGhh\nbiAzMCUgb2YKICAgICAgICAvLyB0aGUgdGltZQogICAgICAgIGFzc2VydEVx\ndWFscyg3LCByZW1vdmVkQ291bnRzLnNpemUoKSk7CiAgICAgICAgZm9yIChF\nbnRyeTxTdHJpbmcsSW50ZWdlcj4gZW50cnkgOiByZW1vdmVkQ291bnRzLmVu\ndHJ5U2V0KCkpIHsKICAgICAgICAgICAgaWYgKGVudHJ5LmdldFZhbHVlKCkg\nPT0gMCkKICAgICAgICAgICAgICAgIGZhaWwoImVsZW1lbnQgIiArIGVudHJ5\nLmdldEtleSgpICsgIiB3YXMgbmV2ZXIgcmVtb3ZlZCIpOwogICAgICAgICAg\nICBpZiAoZW50cnkuZ2V0VmFsdWUoKSA+IDUwMCkKICAgICAgICAgICAgICAg\nIGZhaWwoImVsZW1lbnQgIiArIGVudHJ5LmdldEtleSgpICsgIiB3YXMgcmVt\nb3ZlZCAiCiAgICAgICAgICAgICAgICAgICAgKyBlbnRyeS5nZXRWYWx1ZSgp\nICsgIiB0aW1lczsgdGhpcyBpcyBncmVhdGVyIHRoYW4gdGhlICIKICAgICAg\nICAgICAgICAgICAgICArICJ0aHJlc2hvbGQgb2YgNTAwLiIpOwogICAgICAg\nIH0KICAgIH0KCiAgICBwdWJsaWMgdm9pZCB0ZXN0TnVsbEtleXMoKSB0aHJv\nd3MgQ2xhc3NOb3RGb3VuZEV4Y2VwdGlvbiwgSU9FeGNlcHRpb24gewogICAg\nICAgIGhlbHBlcihudWxsLCAidmFsdWUgMCIsICJ2YWx1ZSAxIiwgInZhbHVl\nIDIiKTsKICAgIH0KCiAgICBwcml2YXRlIHZvaWQgaGVscGVyKE9iamVjdCBr\nZXksIE9iamVjdCB2YWx1ZTAsCiAgICAgICAgT2JqZWN0IHZhbHVlMSwgT2Jq\nZWN0IHZhbHVlMikKICAgICAgICB0aHJvd3MgSU9FeGNlcHRpb24sIENsYXNz\nTm90Rm91bmRFeGNlcHRpb24gewoKICAgICAgICBOdWxsU2FmZUNvbmN1cnJl\nbnRIYXNoTWFwIG0gPSBuZXdNYXAoKTsKCiAgICAgICAgLy8gaW5pdGlhbCBw\ndXQKICAgICAgICBtLnB1dChrZXksIHZhbHVlMCk7CgogICAgICAgIC8vIGdl\ndCBldGMuCiAgICAgICAgYXNzZXJ0RXF1YWxzKHZhbHVlMCwgbS5nZXQoa2V5\nKSk7CiAgICAgICAgYXNzZXJ0VHJ1ZShtLmNvbnRhaW5zS2V5KGtleSkpOwog\nICAgICAgIGFzc2VydFRydWUobS5jb250YWluc1ZhbHVlKHZhbHVlMCkpOwoK\nICAgICAgICAvLyBrZXlTZXQKICAgICAgICBTZXQga2V5cyA9IG0ua2V5U2V0\nKCk7CiAgICAgICAgYXNzZXJ0VHJ1ZShrZXlzLmNvbnRhaW5zKGtleSkpOwog\nICAgICAgIGFzc2VydEVxdWFscygxLCBrZXlzLnNpemUoKSk7CiAgICAgICAg\nYXNzZXJ0RXF1YWxzKGtleSwga2V5cy5pdGVyYXRvcigpLm5leHQoKSk7Cgog\nICAgICAgIC8vIGVudHJ5U2V0CiAgICAgICAgU2V0IGVudHJpZXMgPSBtLmVu\ndHJ5U2V0KCk7CiAgICAgICAgRW50cnkgZSA9IChFbnRyeSkgZW50cmllcy5p\ndGVyYXRvcigpLm5leHQoKTsKICAgICAgICBhc3NlcnRFcXVhbHMoa2V5LCBl\nLmdldEtleSgpKTsKICAgICAgICBhc3NlcnRFcXVhbHModmFsdWUwLCBlLmdl\ndFZhbHVlKCkpOwoKICAgICAgICAvLyB2YWx1ZXMKICAgICAgICBDb2xsZWN0\naW9uIHZhbHVlcyA9IG0udmFsdWVzKCk7CiAgICAgICAgYXNzZXJ0RXF1YWxz\nKDEsIHZhbHVlcy5zaXplKCkpOwogICAgICAgIGFzc2VydEVxdWFscyh2YWx1\nZTAsIHZhbHVlcy5pdGVyYXRvcigpLm5leHQoKSk7CgogICAgICAgIC8vIHNl\ncmlhbGl6YWJpbGl0eQogICAgICAgIGFzc2VydEVxdWFscyhtLCByb3VuZHRy\naXAobSwgdHJ1ZSkpOwoKICAgICAgICAvLyBwdXQKICAgICAgICBhc3NlcnRF\ncXVhbHModmFsdWUwLCBtLnB1dChrZXksIHZhbHVlMSkpOwoKICAgICAgICAv\nLyByZW1vdmUKICAgICAgICBhc3NlcnRFcXVhbHModmFsdWUxLCBtLnB1dChr\nZXksIHZhbHVlMSkpOwogICAgICAgIGFzc2VydEVxdWFscyh2YWx1ZTEsIG0u\ncmVtb3ZlKGtleSkpOwogICAgICAgIG0ucHV0KGtleSwgdmFsdWUxKTsKCiAg\nICAgICAgLy8gQ29uY3VycmVudE1hcCBzdHVmZgogICAgICAgIGFzc2VydEZh\nbHNlKG0ucmVtb3ZlKCJpbnZhbGlkIGtleSIsIHZhbHVlMCkpOwogICAgICAg\nIGFzc2VydFRydWUobS5yZW1vdmUoa2V5LCB2YWx1ZTEpKTsKICAgICAgICBh\nc3NlcnROdWxsKG0ucHV0SWZBYnNlbnQoa2V5LCB2YWx1ZTApKTsgLy8gbnVs\nbCA9PSBwcmV2IHVuc2V0CgogICAgICAgIC8vIHZhbHVlMCBtaWdodCBiZSBu\ndWxsOyBjYW4ndCBkaXNhbWJpZ3VhdGUgZnJvbSBhYm92ZSBpbiBPcGVuSlBB\nCiAgICAgICAgLy8gaW50ZXJwcmV0YXRpb24KICAgICAgICBhc3NlcnRFcXVh\nbHModmFsdWUwLCBtLnB1dElmQWJzZW50KGtleSwgImludmFsaWQgdmFsdWUi\nKSk7CgogICAgICAgIC8vIHJlcGxhY2UKICAgICAgICBhc3NlcnRFcXVhbHMo\ndmFsdWUwLCBtLnJlcGxhY2Uoa2V5LCB2YWx1ZTEpKTsKICAgICAgICBhc3Nl\ncnRUcnVlKG0ucmVwbGFjZShrZXksIHZhbHVlMSwgdmFsdWUyKSk7CgogICAg\nICAgIC8vIHB1dEFsbC4gTm90ZSB0aGF0IENvbmN1cnJlbnRIYXNoTWFwIGhh\ncHBlbnMgdG8gZGVsZWdhdGUgdG8gcHV0KCkKICAgICAgICAvLyBmcm9tIHdp\ndGhpbiBwdXRBbGwoKSBjYWxscy4gVGhpcyB0ZXN0IHNob3VsZCBoZWxwIGVu\nc3VyZSB0aGF0IHdlCiAgICAgICAgLy8gZmluZCBvdXQgaWYgdGhhdCBjaGFu\nZ2VzLgogICAgICAgIG0gPSBuZXdNYXAoKTsKICAgICAgICBNYXAgcHV0QWxs\nQXJnID0gbmV3IEhhc2hNYXAoKTsKICAgICAgICBwdXRBbGxBcmcucHV0KGtl\neSwgdmFsdWUwKTsKICAgICAgICBwdXRBbGxBcmcucHV0KCJhbm90aGVyIGtl\neSIsIHZhbHVlMSk7CiAgICAgICAgbS5wdXRBbGwocHV0QWxsQXJnKTsKICAg\nICAgICBhc3NlcnRFcXVhbHModmFsdWUwLCBtLmdldChrZXkpKTsKICAgICAg\nICBhc3NlcnRFcXVhbHModmFsdWUxLCBtLmdldCgiYW5vdGhlciBrZXkiKSk7\nCiAgICB9CgogICAgcHVibGljIHZvaWQgdGVzdE51bGxWYWx1ZXMoKSB0aHJv\nd3MgQ2xhc3NOb3RGb3VuZEV4Y2VwdGlvbiwgSU9FeGNlcHRpb24gewogICAg\nICAgIG51bGxWYWxzSGVscGVyKCJmb28iKTsKICAgIH0KCiAgICBwcml2YXRl\nIHZvaWQgbnVsbFZhbHNIZWxwZXIoT2JqZWN0IGtleSkKICAgICAgICB0aHJv\nd3MgSU9FeGNlcHRpb24sIENsYXNzTm90Rm91bmRFeGNlcHRpb24gewogICAg\nICAgIGhlbHBlcihrZXksIG51bGwsIG51bGwsIG51bGwpOwogICAgICAgIGhl\nbHBlcihrZXksICJiYXIiLCAiYmF6IiwgInF1dXgiKTsKCiAgICAgICAgaGVs\ncGVyKGtleSwgImJhciIsICJiYXoiLCBudWxsKTsKICAgICAgICBoZWxwZXIo\na2V5LCBudWxsLCAiYmF6IiwgInF1dXgiKTsKICAgICAgICBoZWxwZXIoa2V5\nLCAiYmFyIiwgbnVsbCwgInF1dXgiKTsKCiAgICAgICAgaGVscGVyKGtleSwg\nImJhciIsIG51bGwsIG51bGwpOwogICAgICAgIGhlbHBlcihrZXksIG51bGws\nICJiYXoiLCBudWxsKTsKICAgICAgICBoZWxwZXIoa2V5LCBudWxsLCBudWxs\nLCAicXV1eCIpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHRlc3ROdWxsS2V5\nc0FuZFZhbHVlcygpCiAgICAgICAgdGhyb3dzIENsYXNzTm90Rm91bmRFeGNl\ncHRpb24sIElPRXhjZXB0aW9uIHsKICAgICAgICBudWxsVmFsc0hlbHBlcihu\ndWxsKTsKICAgIH0KfQo=\n","encoding":"base64"}

