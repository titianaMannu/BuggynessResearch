{"sha":"0b446c0836128120930005157c584cb26f5a2cea","node_id":"MDQ6QmxvYjIwNjM2NDowYjQ0NmMwODM2MTI4MTIwOTMwMDA1MTU3YzU4NGNiMjZmNWEyY2Vh","size":22230,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/0b446c0836128120930005157c584cb26f5a2cea","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNr\nYWdlIG9yZy5hcGFjaGUub3BlbmpwYS5lbmhhbmNlOwoKaW1wb3J0IGphdmEu\naW8uSU9FeGNlcHRpb247CmltcG9ydCBqYXZhLmlvLkJ5dGVBcnJheU91dHB1\ndFN0cmVhbTsKaW1wb3J0IGphdmEuaW8uT2JqZWN0T3V0cHV0U3RyZWFtOwpp\nbXBvcnQgamF2YS5pby5PYmplY3RJbnB1dFN0cmVhbTsKaW1wb3J0IGphdmEu\naW8uQnl0ZUFycmF5SW5wdXRTdHJlYW07CmltcG9ydCBqYXZhLnV0aWwuTGlz\ndDsKaW1wb3J0IGphdmEudXRpbC5Db2xsZWN0aW9uczsKaW1wb3J0IGphdmEu\nbGFuZy5yZWZsZWN0LkZpZWxkOwoKaW1wb3J0IG9yZy5hcGFjaGUub3Blbmpw\nYS5wZXJzaXN0ZW5jZS50ZXN0LlNpbmdsZUVNRlRlc3RDYXNlOwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNlLk9wZW5KUEFFbnRpdHlN\nYW5hZ2VyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNl\nLkpQQUZhY2FkZUhlbHBlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5r\nZXJuZWwuT3BlbkpQQVN0YXRlTWFuYWdlcjsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS5tZXRhLkNsYXNzTWV0YURhdGE7CmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEudXRpbC5JbXBsSGVscGVyOwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLmV2ZW50LkFic3RyYWN0TGlmZWN5Y2xlTGlzdGVuZXI7CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEuZXZlbnQuTGlmZWN5Y2xlRXZlbnQ7Cgpw\ndWJsaWMgYWJzdHJhY3QgY2xhc3MgQWJzdHJhY3RVbmVuaGFuY2VkQ2xhc3NU\nZXN0CiAgICBleHRlbmRzIFNpbmdsZUVNRlRlc3RDYXNlIHsKCiAgICAvLyAj\nIyMjIyBUbyBkbzoKICAgIC8vIC0gY2xlYXJpbmcgaW4gcG5ldyBwcm9wZXJ0\neS1hY2Nlc3Mgd2l0aG91dCByZWRlZmluaXRpb24KICAgIC8vIC0gZmlndXJl\nIG91dCBob3cgdG8gYXV0by10ZXN0IHRoZSByZWRlZmluaXRpb24gY29kZSwg\nZWl0aGVyIGluIEphdmEgNQogICAgLy8gICBvciBpbiBKYXZhIDYKICAgIC8v\nIC0gcnVuIENUUyBpbiB0aGUgZm9sbG93aW5nIGNvbWJpbmF0aW9uczoKICAg\nIC8vICAgKiBKYXZhIDYKICAgIC8vICAgKiBKYXZhIDUgd2l0aCBqYXZhYWdl\nbnQKICAgIC8vICAgKiBKYXZhIDUgd2l0aG91dCBqYXZhYWdlbnQKCiAgICBw\ndWJsaWMgdm9pZCBzZXRVcCgpIHsKICAgICAgICBzZXRVcChnZXRVbmVuaGFu\nY2VkQ2xhc3MoKSwgZ2V0VW5lbmhhbmNlZFN1YmNsYXNzKCksIENMRUFSX1RB\nQkxFUyk7CiAgICAgICAgLy8gdHJpZ2dlciBjbGFzcyByZWRlZmluaXRpb24K\nICAgICAgICBlbWYuY3JlYXRlRW50aXR5TWFuYWdlcigpLmNsb3NlKCk7CiAg\nICB9CgogICAgcHJvdGVjdGVkIGFic3RyYWN0IENsYXNzPD8gZXh0ZW5kcyBV\nbmVuaGFuY2VkVHlwZT4gZ2V0VW5lbmhhbmNlZENsYXNzKCk7CgogICAgcHJv\ndGVjdGVkIGFic3RyYWN0IFVuZW5oYW5jZWRUeXBlIG5ld1VuZW5oYW5jZWRJ\nbnN0YW5jZSgpOwoKICAgIHByb3RlY3RlZCBhYnN0cmFjdCBDbGFzczw/IGV4\ndGVuZHMgVW5lbmhhbmNlZFN1YnR5cGU+IGdldFVuZW5oYW5jZWRTdWJjbGFz\ncygpOwoKICAgIHByb3RlY3RlZCBhYnN0cmFjdCBVbmVuaGFuY2VkU3VidHlw\nZSBuZXdVbmVuaGFuY2VkU3ViY2xhc3NJbnN0YW5jZSgpOwoKICAgIHByaXZh\ndGUgVW5lbmhhbmNlZFR5cGUgbmV3SW5zdGFuY2UoYm9vbGVhbiBzdWIpIHsK\nICAgICAgICByZXR1cm4gc3ViID8gbmV3VW5lbmhhbmNlZFN1YmNsYXNzSW5z\ndGFuY2UoKQogICAgICAgICAgICA6IG5ld1VuZW5oYW5jZWRJbnN0YW5jZSgp\nOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHRlc3RNZXRhRGF0YSgpIHsKICAg\nICAgICBDbGFzc01ldGFEYXRhIG1ldGEgPSBKUEFGYWNhZGVIZWxwZXIuZ2V0\nTWV0YURhdGEoZW1mLAogICAgICAgICAgICBnZXRVbmVuaGFuY2VkQ2xhc3Mo\nKSk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKENsYXNzUmVkZWZpbmVyLmNhblJl\nZGVmaW5lQ2xhc3NlcygpLAogICAgICAgICAgICBtZXRhLmlzSW50ZXJjZXB0\naW5nKCkpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHRlc3RJbXBsSGVscGVy\nQ2FsbHMoKSB7CiAgICAgICAgYXNzZXJ0VHJ1ZShJbXBsSGVscGVyLmlzTWFu\nYWdlZFR5cGUobnVsbCwgZ2V0VW5lbmhhbmNlZENsYXNzKCkpKTsKCiAgICAg\nICAgVW5lbmhhbmNlZFR5cGUgdW4gPSBuZXdVbmVuaGFuY2VkSW5zdGFuY2Uo\nKTsKICAgICAgICBhc3NlcnRGYWxzZSh1biBpbnN0YW5jZW9mIFBlcnNpc3Rl\nbmNlQ2FwYWJsZSk7CiAgICAgICAgUGVyc2lzdGVuY2VDYXBhYmxlIHBjID0g\nSW1wbEhlbHBlci50b1BlcnNpc3RlbmNlQ2FwYWJsZSh1biwKICAgICAgICAg\nICAgZW1mLmdldENvbmZpZ3VyYXRpb24oKSk7CiAgICAgICAgYXNzZXJ0Tm90\nTnVsbChwYyk7CiAgICAgICAgYXNzZXJ0VHJ1ZShJbXBsSGVscGVyLmlzTWFu\nYWdlYWJsZSh1bikpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHRlc3RCYXNp\nY1BlcnNpc3RlbmNlQ2FwYWJsZUJlaGF2aW9yKCkgewogICAgICAgIFVuZW5o\nYW5jZWRUeXBlIHVuID0gbmV3VW5lbmhhbmNlZEluc3RhbmNlKCk7CiAgICAg\nICAgdW4uc2V0U3RyaW5nRmllbGQoImJhciIpOwogICAgICAgIFBlcnNpc3Rl\nbmNlQ2FwYWJsZSBwYyA9IEltcGxIZWxwZXIudG9QZXJzaXN0ZW5jZUNhcGFi\nbGUodW4sCiAgICAgICAgICAgIGVtZi5nZXRDb25maWd1cmF0aW9uKCkpOwog\nICAgICAgIGFzc2VydEZhbHNlKHBjLnBjSXNEZWxldGVkKCkpOwogICAgICAg\nIGFzc2VydEZhbHNlKHBjLnBjSXNEaXJ0eSgpKTsKICAgICAgICBhc3NlcnRG\nYWxzZShwYy5wY0lzTmV3KCkpOwogICAgICAgIGFzc2VydEZhbHNlKHBjLnBj\nSXNQZXJzaXN0ZW50KCkpOwogICAgICAgIGFzc2VydEZhbHNlKHBjLnBjSXNU\ncmFuc2FjdGlvbmFsKCkpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHRlc3RQ\nQ1JlZ2lzdHJ5KCkgewogICAgICAgIGFzc2VydFRydWUoUENSZWdpc3RyeS5p\nc1JlZ2lzdGVyZWQoZ2V0VW5lbmhhbmNlZENsYXNzKCkpKTsKICAgICAgICBQ\nZXJzaXN0ZW5jZUNhcGFibGUgcGMgPSBQQ1JlZ2lzdHJ5Lm5ld0luc3RhbmNl\nKAogICAgICAgICAgICBnZXRVbmVuaGFuY2VkQ2xhc3MoKSwgbnVsbCwgZmFs\nc2UpOwogICAgICAgIGFzc2VydE5vdE51bGwocGMpOwogICAgICAgIGFzc2Vy\ndEVxdWFscyhwYy5nZXRDbGFzcygpLCBQQ1JlZ2lzdHJ5LmdldFBDVHlwZShn\nZXRVbmVuaGFuY2VkQ2xhc3MoKSkpOwogICAgfQoKICAgIHB1YmxpYyB2b2lk\nIHRlc3RDbGVhcmluZ09uU3VidHlwZUluc3RhbmNlKCkgewogICAgICAgIC8v\nIHRoZSBib29sZWFuIGF0IHRoZSBlbmQgb2YgbmV3SW5zdGFuY2Ugd2lsbCBj\nYXVzZSBjbGVhciB0byBiZSBpbnZva2VkCiAgICAgICAgVW5lbmhhbmNlZFR5\ncGUgdW4gPSAoVW5lbmhhbmNlZFR5cGUpCiAgICAgICAgICAgIFBDUmVnaXN0\ncnkubmV3SW5zdGFuY2UoZ2V0VW5lbmhhbmNlZENsYXNzKCksIG51bGwsIHRy\ndWUpOwogICAgICAgIGFzc2VydEVxdWFscyhudWxsLCB1bi5nZXRTdHJpbmdG\naWVsZCgpKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCB0ZXN0R2V0T2JqZWN0\nSWRPbk9wZW5KUEFUeXBlKCkgewogICAgICAgIGdldE9iamVjdElkSGVscGVy\nKHRydWUsIGZhbHNlKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCB0ZXN0R2V0\nT2JqZWN0SWRPbk9wZW5KUEFUeXBlU3ViY2xhc3MoKSB7CiAgICAgICAgZ2V0\nT2JqZWN0SWRIZWxwZXIoZmFsc2UsIGZhbHNlKTsKICAgIH0KCiAgICBwdWJs\naWMgdm9pZCB0ZXN0R2V0T2JqZWN0SWRPblVzZXJEZWZpbmVkKCkgewogICAg\nICAgIGdldE9iamVjdElkSGVscGVyKHRydWUsIHRydWUpOwogICAgfQoKICAg\nIHB1YmxpYyB2b2lkIHRlc3RHZXRPYmplY3RJZE9uVXNlckRlZmluZWRTdWJj\nbGFzcygpIHsKICAgICAgICBnZXRPYmplY3RJZEhlbHBlcihmYWxzZSwgdHJ1\nZSk7CiAgICB9CgogICAgcHJpdmF0ZSB2b2lkIGdldE9iamVjdElkSGVscGVy\nKGJvb2xlYW4gc3ViLCBib29sZWFuIHVzZXJEZWZpbmVkKSB7CiAgICAgICAg\nT3BlbkpQQUVudGl0eU1hbmFnZXIgZW0gPSBlbWYuY3JlYXRlRW50aXR5TWFu\nYWdlcigpOwogICAgICAgIGVtLmdldFRyYW5zYWN0aW9uKCkuYmVnaW4oKTsK\nICAgICAgICBVbmVuaGFuY2VkVHlwZSB1biA9IG5ld0luc3RhbmNlKHN1Yik7\nCiAgICAgICAgZW0ucGVyc2lzdCh1bik7CiAgICAgICAgZW0uZ2V0VHJhbnNh\nY3Rpb24oKS5jb21taXQoKTsKCiAgICAgICAgaWYgKCF1c2VyRGVmaW5lZCkg\newogICAgICAgICAgICBlbS5jbG9zZSgpOwogICAgICAgICAgICBlbSA9IGVt\nZi5jcmVhdGVFbnRpdHlNYW5hZ2VyKCk7CiAgICAgICAgICAgIHVuID0gZW0u\nZmluZChnZXRVbmVuaGFuY2VkQ2xhc3MoKSwgdW4uZ2V0SWQoKSk7CiAgICAg\nICAgfQoKICAgICAgICBhc3NlcnROb3ROdWxsKGVtLmdldE9iamVjdElkKHVu\nKSk7CiAgICB9CgogICAgcHVibGljIHZvaWQgdGVzdE9wZXJhdGlvbnNPblVz\nZXJEZWZpbmVkKCkgewogICAgICAgIG9wc0hlbHBlcihmYWxzZSwgdHJ1ZSk7\nCiAgICB9CgogICAgcHVibGljIHZvaWQgdGVzdFN1YmNsYXNzT3BlcmF0aW9u\nc09uVXNlckRlZmluZWQoKSB7CiAgICAgICAgb3BzSGVscGVyKHRydWUsIHRy\ndWUpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHRlc3RPcGVyYXRpb25zT25P\ncGVuSlBBRGVmaW5lZCgpIHsKICAgICAgICBvcHNIZWxwZXIoZmFsc2UsIGZh\nbHNlKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCB0ZXN0U3ViY2xhc3NPcGVy\nYXRpb25zT25PcGVuSlBBRGVmaW5lZCgpIHsKICAgICAgICBvcHNIZWxwZXIo\ndHJ1ZSwgZmFsc2UpOwogICAgfQoKICAgIHByaXZhdGUgdm9pZCBvcHNIZWxw\nZXIoYm9vbGVhbiBzdWIsIGJvb2xlYW4gdXNlckRlZmluZWQpIHsKICAgICAg\nICBPcGVuSlBBRW50aXR5TWFuYWdlciBlbSA9IG51bGw7CiAgICAgICAgdHJ5\nIHsKICAgICAgICAgICAgVW5lbmhhbmNlZFR5cGUgdW4gPSBuZXdJbnN0YW5j\nZShzdWIpOwogICAgICAgICAgICBlbSA9IGVtZi5jcmVhdGVFbnRpdHlNYW5h\nZ2VyKCk7CgogICAgICAgICAgICBlbS5nZXRUcmFuc2FjdGlvbigpLmJlZ2lu\nKCk7CiAgICAgICAgICAgIGVtLnBlcnNpc3QodW4pOwogICAgICAgICAgICB1\nbi5zZXRTdHJpbmdGaWVsZCgiYmFyIik7CiAgICAgICAgICAgIGFzc2VydEVx\ndWFscygiYmFyIiwgdW4uZ2V0U3RyaW5nRmllbGQoKSk7CiAgICAgICAgICAg\nIGFzc2VydFBlcnNpc3RlbmNlQ29udGV4dChlbSwgdW4sIHRydWUsIHRydWUs\nIHN1Yik7CiAgICAgICAgICAgIGVtLmZsdXNoKCk7CiAgICAgICAgICAgIGFz\nc2VydFBlcnNpc3RlbmNlQ29udGV4dChlbSwgdW4sIHRydWUsIHRydWUsIHN1\nYik7CiAgICAgICAgICAgIGFzc2VydFRydWUodW4uZ2V0SWQoKSAhPSAwKTsK\nICAgICAgICAgICAgVW5lbmhhbmNlZFR5cGUgdW4yID0gZW0uZmluZChnZXRV\nbmVuaGFuY2VkQ2xhc3MoKSwgdW4uZ2V0SWQoKSk7CiAgICAgICAgICAgIGFz\nc2VydFNhbWUodW4sIHVuMik7CiAgICAgICAgICAgIGVtLmdldFRyYW5zYWN0\naW9uKCkuY29tbWl0KCk7CiAgICAgICAgICAgIGFzc2VydFBlcnNpc3RlbmNl\nQ29udGV4dChlbSwgdW4sIGZhbHNlLCBmYWxzZSwgc3ViKTsKICAgICAgICAg\nICAgdW4yID0gZW0uZmluZChnZXRVbmVuaGFuY2VkQ2xhc3MoKSwgdW4uZ2V0\nSWQoKSk7CiAgICAgICAgICAgIGFzc2VydFNhbWUodW4sIHVuMik7CgogICAg\nICAgICAgICBpZiAoIXVzZXJEZWZpbmVkKSB7CiAgICAgICAgICAgICAgICBl\nbS5jbG9zZSgpOwogICAgICAgICAgICAgICAgZW0gPSBlbWYuY3JlYXRlRW50\naXR5TWFuYWdlcigpOwogICAgICAgICAgICB9CgogICAgICAgICAgICB1biA9\nIGVtLmZpbmQoZ2V0VW5lbmhhbmNlZENsYXNzKCksIHVuLmdldElkKCkpOwog\nICAgICAgICAgICBhc3NlcnROb3ROdWxsKHVuKTsKICAgICAgICAgICAgaWYg\nKCF1c2VyRGVmaW5lZCkKICAgICAgICAgICAgICAgIGFzc2VydFRydWUodW4g\naW5zdGFuY2VvZiBQZXJzaXN0ZW5jZUNhcGFibGUpOwogICAgICAgICAgICBh\nc3NlcnRFcXVhbHMoImJhciIsIHVuLmdldFN0cmluZ0ZpZWxkKCkpOwogICAg\nICAgICAgICBlbS5nZXRUcmFuc2FjdGlvbigpLmJlZ2luKCk7CiAgICAgICAg\nICAgIHVuLnNldFN0cmluZ0ZpZWxkKCJiYXoiKTsKICAgICAgICAgICAgYXNz\nZXJ0UGVyc2lzdGVuY2VDb250ZXh0KGVtLCB1biwgdHJ1ZSwgdHJ1ZSwgc3Vi\nKTsKICAgICAgICAgICAgYXNzZXJ0RXF1YWxzKCJiYXoiLCB1bi5nZXRTdHJp\nbmdGaWVsZCgpKTsKCiAgICAgICAgICAgIGlmIChzdWIpCiAgICAgICAgICAg\nICAgICAoKFVuZW5oYW5jZWRTdWJ0eXBlKSB1bikuc2V0SW50RmllbGQoMTcp\nOwoKICAgICAgICAgICAgYXNzZXJ0VHJ1ZShlbS5pc0RpcnR5KHVuKSk7CiAg\nICAgICAgICAgIAogICAgICAgICAgICBlbS5nZXRUcmFuc2FjdGlvbigpLmNv\nbW1pdCgpOwoKICAgICAgICAgICAgLy8gbWFrZSBzdXJlIHRoYXQgdGhlIHZh\nbHVlcyBhcmUgc3RpbGwgdXAtdG8tZGF0ZSBhZnRlcgogICAgICAgICAgICAv\nLyB0aGUgY29tbWl0IGhhcHBlbnMKICAgICAgICAgICAgYXNzZXJ0RXF1YWxz\nKCJiYXoiLCB1bi5nZXRTdHJpbmdGaWVsZCgpKTsKICAgICAgICAgICAgCiAg\nICAgICAgICAgIGVtLmNsb3NlKCk7CgogICAgICAgICAgICBlbSA9IGVtZi5j\ncmVhdGVFbnRpdHlNYW5hZ2VyKCk7CiAgICAgICAgICAgIHVuID0gZW0uZmlu\nZChnZXRVbmVuaGFuY2VkQ2xhc3MoKSwgdW4uZ2V0SWQoKSk7CiAgICAgICAg\nICAgIGFzc2VydE5vdE51bGwodW4pOwogICAgICAgICAgICBhc3NlcnRUcnVl\nKHVuIGluc3RhbmNlb2YgUGVyc2lzdGVuY2VDYXBhYmxlKTsKICAgICAgICAg\nICAgYXNzZXJ0RXF1YWxzKCJiYXoiLCB1bi5nZXRTdHJpbmdGaWVsZCgpKTsK\nICAgICAgICAgICAgaWYgKHN1YikKICAgICAgICAgICAgICAgIGFzc2VydEVx\ndWFscygxNywgKChVbmVuaGFuY2VkU3VidHlwZSkgdW4pLmdldEludEZpZWxk\nKCkpOwogICAgICAgICAgICBlbS5jbG9zZSgpOwogICAgICAgIH0gZmluYWxs\neSB7CiAgICAgICAgICAgIGlmIChlbSAhPSBudWxsICYmIGVtLmdldFRyYW5z\nYWN0aW9uKCkuaXNBY3RpdmUoKSkKICAgICAgICAgICAgICAgIGVtLmdldFRy\nYW5zYWN0aW9uKCkucm9sbGJhY2soKTsKICAgICAgICAgICAgaWYgKGVtICE9\nIG51bGwgJiYgZW0uaXNPcGVuKCkpCiAgICAgICAgICAgICAgICBlbS5jbG9z\nZSgpOwogICAgICAgIH0KICAgIH0KCiAgICBwcml2YXRlIHZvaWQgYXNzZXJ0\nUGVyc2lzdGVuY2VDb250ZXh0KE9wZW5KUEFFbnRpdHlNYW5hZ2VyIGVtLAog\nICAgICAgIFVuZW5oYW5jZWRUeXBlIHVuLCBib29sZWFuIHRyYW5zYWN0aW9u\nYWwsIGJvb2xlYW4gZGlydHksIGJvb2xlYW4gc3ViKSB7CiAgICAgICAgYXNz\nZXJ0RXF1YWxzKHRyYW5zYWN0aW9uYWwsIGVtLmdldFRyYW5zYWN0aW9uYWxP\nYmplY3RzKCkuY29udGFpbnModW4pKTsKICAgICAgICBhc3NlcnRFcXVhbHMo\nZGlydHksIGVtLmdldERpcnR5T2JqZWN0cygpLmNvbnRhaW5zKHVuKSk7CiAg\nICAgICAgaWYgKGRpcnR5KSB7CiAgICAgICAgICAgIENsYXNzIGNscyA9IHN1\nYiA/IGdldFVuZW5oYW5jZWRTdWJjbGFzcygpIDogZ2V0VW5lbmhhbmNlZENs\nYXNzKCk7CiAgICAgICAgICAgIGFzc2VydFRydWUoZW0uZ2V0VXBkYXRlZENs\nYXNzZXMoKS5jb250YWlucyhjbHMpCiAgICAgICAgICAgICAgICB8fCBlbS5n\nZXRQZXJzaXN0ZWRDbGFzc2VzKCkuY29udGFpbnMoY2xzKSk7CiAgICAgICAg\nfQogICAgfQoKICAgIHB1YmxpYyB2b2lkIHRlc3RSZWxhdGlvbnMoKSB7CiAg\nICAgICAgT3BlbkpQQUVudGl0eU1hbmFnZXIgZW0gPSBlbWYuY3JlYXRlRW50\naXR5TWFuYWdlcigpOwogICAgICAgIGVtLmdldFRyYW5zYWN0aW9uKCkuYmVn\naW4oKTsKICAgICAgICBVbmVuaGFuY2VkU3VidHlwZSB1biA9IG5ld1VuZW5o\nYW5jZWRTdWJjbGFzc0luc3RhbmNlKCk7CiAgICAgICAgZW0ucGVyc2lzdCh1\nbik7CiAgICAgICAgdW4uc2V0U3RyaW5nRmllbGQoImFvZXUiKTsKICAgICAg\nICBVbmVuaGFuY2VkU3VidHlwZSByZWxhdGVkID0gbmV3VW5lbmhhbmNlZFN1\nYmNsYXNzSW5zdGFuY2UoKTsKICAgICAgICB1bi5zZXRSZWxhdGVkKHJlbGF0\nZWQpOwogICAgICAgIHJlbGF0ZWQuc2V0U3RyaW5nRmllbGQoInNudGgiKTsK\nICAgICAgICBlbS5nZXRUcmFuc2FjdGlvbigpLmNvbW1pdCgpOwogICAgICAg\nIGVtLmNsb3NlKCk7CgogICAgICAgIGVtID0gZW1mLmNyZWF0ZUVudGl0eU1h\nbmFnZXIoKTsKICAgICAgICB1biA9IChVbmVuaGFuY2VkU3VidHlwZSkgZW0u\nZmluZChnZXRVbmVuaGFuY2VkQ2xhc3MoKSwgdW4uZ2V0SWQoKSk7CiAgICAg\nICAgYXNzZXJ0RXF1YWxzKCJhb2V1IiwgdW4uZ2V0U3RyaW5nRmllbGQoKSk7\nCiAgICAgICAgYXNzZXJ0Tm90TnVsbCh1bi5nZXRSZWxhdGVkKCkpOwogICAg\nICAgIGFzc2VydEVxdWFscygic250aCIsIHVuLmdldFJlbGF0ZWQoKS5nZXRT\ndHJpbmdGaWVsZCgpKTsKICAgICAgICBlbS5jbG9zZSgpOwogICAgfQoKICAg\nIHB1YmxpYyB2b2lkIHRlc3RFbmhhbmNlcigpIHRocm93cyBJT0V4Y2VwdGlv\nbiB7CiAgICAgICAgTGlzdDxDbGFzcz4gc3VicyA9ICBNYW5hZ2VkQ2xhc3NT\ndWJjbGFzc2VyLnByZXBhcmVVbmVuaGFuY2VkQ2xhc3NlcygKICAgICAgICAg\nICAgZW1mLmdldENvbmZpZ3VyYXRpb24oKSwKICAgICAgICAgICAgQ29sbGVj\ndGlvbnMuc2luZ2xldG9uKGdldFVuZW5oYW5jZWRDbGFzcygpKSwgbnVsbCk7\nCiAgICAgICAgQ2xhc3Mgc3ViID0gc3Vicy5nZXQoMCk7CiAgICAgICAgYXNz\nZXJ0Tm90TnVsbChzdWIpOwogICAgICAgIGFzc2VydEVxdWFscygib3JnLmFw\nYWNoZS5vcGVuanBhLmVuaGFuY2UuIgogICAgICAgICAgICArIGdldFVuZW5o\nYW5jZWRDbGFzcygpLmdldE5hbWUoKS5yZXBsYWNlKCcuJywgJyQnKSArICIk\ncGNzdWJjbGFzcyIsCiAgICAgICAgICAgIHN1Yi5nZXROYW1lKCkpOwogICAg\nICAgIGFzc2VydFRydWUoUGVyc2lzdGVuY2VDYXBhYmxlLmNsYXNzLmlzQXNz\naWduYWJsZUZyb20oc3ViKSk7CiAgICAgICAgYXNzZXJ0VHJ1ZShnZXRVbmVu\naGFuY2VkQ2xhc3MoKS5pc0Fzc2lnbmFibGVGcm9tKHN1YikpOwogICAgfQoK\nICAgIHB1YmxpYyB2b2lkIHRlc3RQQ1N1YmNsYXNzTmFtZSgpIHsKICAgICAg\nICBhc3NlcnRFcXVhbHMoIm9yZy5hcGFjaGUub3BlbmpwYS5lbmhhbmNlLiIK\nICAgICAgICAgICAgKyBnZXRVbmVuaGFuY2VkQ2xhc3MoKS5nZXROYW1lKCku\ncmVwbGFjZSgnLicsICckJykgKyAiJHBjc3ViY2xhc3MiLAogICAgICAgICAg\nICBQQ0VuaGFuY2VyLnRvUENTdWJjbGFzc05hbWUoZ2V0VW5lbmhhbmNlZENs\nYXNzKCkpKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCB0ZXN0RXZpY3Rpb25J\nblVzZXJDcmVhdGVkSW5zdGFuY2UoKQogICAgICAgIHRocm93cyBOb1N1Y2hG\naWVsZEV4Y2VwdGlvbiwgSWxsZWdhbEFjY2Vzc0V4Y2VwdGlvbiB7CiAgICAg\nICAgZXZpY3Rpb25IZWxwZXIodHJ1ZSk7CiAgICB9CgogICAgcHVibGljIHZv\naWQgdGVzdEV2aWN0aW9uSW5PcGVuSlBBQ3JlYXRlZEluc3RhbmNlKCkKICAg\nICAgICB0aHJvd3MgTm9TdWNoRmllbGRFeGNlcHRpb24sIElsbGVnYWxBY2Nl\nc3NFeGNlcHRpb24gewogICAgICAgIGV2aWN0aW9uSGVscGVyKGZhbHNlKTsK\nICAgIH0KCiAgICBwcml2YXRlIHZvaWQgZXZpY3Rpb25IZWxwZXIoYm9vbGVh\nbiB1c2VyRGVmaW5lZCkKICAgICAgICB0aHJvd3MgTm9TdWNoRmllbGRFeGNl\ncHRpb24sIElsbGVnYWxBY2Nlc3NFeGNlcHRpb24gewogICAgICAgIE9wZW5K\nUEFFbnRpdHlNYW5hZ2VyIGVtID0gZW1mLmNyZWF0ZUVudGl0eU1hbmFnZXIo\nKTsKICAgICAgICBVbmVuaGFuY2VkVHlwZSB1biA9IG5ld1VuZW5oYW5jZWRJ\nbnN0YW5jZSgpOwogICAgICAgIGVtLmdldFRyYW5zYWN0aW9uKCkuYmVnaW4o\nKTsKICAgICAgICBlbS5wZXJzaXN0KHVuKTsKICAgICAgICBlbS5nZXRUcmFu\nc2FjdGlvbigpLmNvbW1pdCgpOwoKICAgICAgICBpZiAoIXVzZXJEZWZpbmVk\nKSB7CiAgICAgICAgICAgIGVtLmNsb3NlKCk7CiAgICAgICAgICAgIGVtID0g\nZW1mLmNyZWF0ZUVudGl0eU1hbmFnZXIoKTsKICAgICAgICAgICAgdW4gPSBl\nbS5maW5kKGdldFVuZW5oYW5jZWRDbGFzcygpLCB1bi5nZXRJZCgpKTsKICAg\nICAgICAgICAgYXNzZXJ0VHJ1ZShnZXRVbmVuaGFuY2VkQ2xhc3MoKSAhPSB1\nbi5nZXRDbGFzcygpKTsKICAgICAgICB9CgogICAgICAgIGVtLmV2aWN0KHVu\nKTsKICAgICAgICBPcGVuSlBBU3RhdGVNYW5hZ2VyIHNtID0gKE9wZW5KUEFT\ndGF0ZU1hbmFnZXIpCiAgICAgICAgICAgIEltcGxIZWxwZXIudG9QZXJzaXN0\nZW5jZUNhcGFibGUodW4sIG51bGwpLnBjR2V0U3RhdGVNYW5hZ2VyKCk7Cgog\nICAgICAgIC8vIHdlIG9ubHkgZXhwZWN0IGxhenkgbG9hZGluZyB0byB3b3Jr\nIHdoZW4gd2UgY2FuIHJlZGVmaW5lIGNsYXNzZXMKICAgICAgICAvLyBvciB3\naGVuIGFjY2Vzc2luZyBhIHByb3BlcnR5LWFjY2VzcyByZWNvcmQgdGhhdCBP\ncGVuSlBBIGNyZWF0ZWQuCiAgICAgICAgaWYgKENsYXNzUmVkZWZpbmVyLmNh\nblJlZGVmaW5lQ2xhc3NlcygpCiAgICAgICAgICAgIHx8ICghdXNlckRlZmlu\nZWQgJiYgc20uZ2V0TWV0YURhdGEoKS5nZXRBY2Nlc3NUeXBlKCkKICAgICAg\nICAgICAgICAgICE9IENsYXNzTWV0YURhdGEuQUNDRVNTX0ZJRUxEKSkgewoK\nICAgICAgICAgICAgYXNzZXJ0RmFsc2Uoc20uZ2V0TG9hZGVkKCkKICAgICAg\nICAgICAgICAgIC5nZXQoc20uZ2V0TWV0YURhdGEoKS5nZXRGaWVsZCgic3Ry\naW5nRmllbGQiKS5nZXRJbmRleCgpKSk7CgogICAgICAgICAgICAvLyBtYWtl\nIHN1cmUgdGhhdCB0aGUgdmFsdWUgd2FzIGNsZWFyZWQuLi4KICAgICAgICAg\nICAgRmllbGQgZmllbGQgPSBnZXRVbmVuaGFuY2VkQ2xhc3MoKS5nZXREZWNs\nYXJlZEZpZWxkKAogICAgICAgICAgICAgICAgaXNGaWVsZEFjY2Vzc1Rlc3Qo\nKSA/ICJzdHJpbmdGaWVsZCIgOiAic2YiKTsKICAgICAgICAgICAgZmllbGQu\nc2V0QWNjZXNzaWJsZSh0cnVlKTsKICAgICAgICAgICAgYXNzZXJ0RXF1YWxz\nKG51bGwsIGZpZWxkLmdldCh1bikpOwoKICAgICAgICAgICAgLy8gLi4uIGFu\nZCB0aGF0IGl0IGdldHMgcmVsb2FkZWQgcHJvcGVybHkKICAgICAgICAgICAg\nYXNzZXJ0RXF1YWxzKCJmb28iLCB1bi5nZXRTdHJpbmdGaWVsZCgpKTsKICAg\nICAgICAgICAgYXNzZXJ0VHJ1ZShzbS5nZXRMb2FkZWQoKQogICAgICAgICAg\nICAgICAgLmdldChzbS5nZXRNZXRhRGF0YSgpLmdldEZpZWxkKCJzdHJpbmdG\naWVsZCIpLmdldEluZGV4KCkpKTsKICAgICAgICB9IGVsc2UgewogICAgICAg\nICAgICAvLyB1bnJlZGVmaW5lZCBwcm9wZXJ0aWVzIHdpdGggdXNlci1kZWZp\nbmVkIGluc3RhbmNlLCBvciBhbnkKICAgICAgICAgICAgLy8gdW5yZWRlZmlu\nZWQgZmllbGQgYWNjZXNzCiAgICAgICAgICAgIGFzc2VydFRydWUoc20uZ2V0\nTG9hZGVkKCkKICAgICAgICAgICAgICAgIC5nZXQoc20uZ2V0TWV0YURhdGEo\nKS5nZXRGaWVsZCgic3RyaW5nRmllbGQiKS5nZXRJbmRleCgpKSk7CgogICAg\nICAgICAgICAvLyBtYWtlIHN1cmUgdGhhdCB0aGUgdmFsdWUgd2FzIG5vdCBj\nbGVhcmVkCiAgICAgICAgICAgIEZpZWxkIGZpZWxkID0gZ2V0VW5lbmhhbmNl\nZENsYXNzKCkuZ2V0RGVjbGFyZWRGaWVsZCgKICAgICAgICAgICAgICAgIGlz\nRmllbGRBY2Nlc3NUZXN0KCkgPyAic3RyaW5nRmllbGQiIDogInNmIik7CiAg\nICAgICAgICAgIGZpZWxkLnNldEFjY2Vzc2libGUodHJ1ZSk7CiAgICAgICAg\nICAgIGFzc2VydEVxdWFscygiZm9vIiwgZmllbGQuZ2V0KHVuKSk7CiAgICAg\nICAgfQoKICAgICAgICBlbS5jbG9zZSgpOwogICAgfQoKICAgIHByb3RlY3Rl\nZCBhYnN0cmFjdCBib29sZWFuIGlzRmllbGRBY2Nlc3NUZXN0KCk7CgogICAg\ncHVibGljIHZvaWQgdGVzdExhenlMb2FkaW5nKCkKICAgICAgICB0aHJvd3Mg\nTm9TdWNoRmllbGRFeGNlcHRpb24sIElsbGVnYWxBY2Nlc3NFeGNlcHRpb24g\newogICAgICAgIE9wZW5KUEFFbnRpdHlNYW5hZ2VyIGVtID0gZW1mLmNyZWF0\nZUVudGl0eU1hbmFnZXIoKTsKICAgICAgICBVbmVuaGFuY2VkVHlwZSB1biA9\nIG5ld1VuZW5oYW5jZWRJbnN0YW5jZSgpOwogICAgICAgIGVtLmdldFRyYW5z\nYWN0aW9uKCkuYmVnaW4oKTsKICAgICAgICBlbS5wZXJzaXN0KHVuKTsKICAg\nICAgICBlbS5nZXRUcmFuc2FjdGlvbigpLmNvbW1pdCgpOwogICAgICAgIGVt\nLmNsb3NlKCk7CgogICAgICAgIGVtID0gZW1mLmNyZWF0ZUVudGl0eU1hbmFn\nZXIoKTsKICAgICAgICB1biA9IGVtLmZpbmQoZ2V0VW5lbmhhbmNlZENsYXNz\nKCksIHVuLmdldElkKCkpOwogICAgICAgIGFzc2VydFRydWUoZ2V0VW5lbmhh\nbmNlZENsYXNzKCkgIT0gdW4uZ2V0Q2xhc3MoKSk7CiAgICAgICAgT3BlbkpQ\nQVN0YXRlTWFuYWdlciBzbSA9IChPcGVuSlBBU3RhdGVNYW5hZ2VyKQogICAg\nICAgICAgICBJbXBsSGVscGVyLnRvUGVyc2lzdGVuY2VDYXBhYmxlKHVuLCBu\ndWxsKS5wY0dldFN0YXRlTWFuYWdlcigpOwoKICAgICAgICAvLyB3ZSBvbmx5\nIGV4cGVjdCBsYXp5IGxvYWRpbmcgdG8gd29yayB3aGVuIHdlIGNhbiByZWRl\nZmluZSBjbGFzc2VzCiAgICAgICAgLy8gb3Igd2hlbiBhY2Nlc3NpbmcgYSBw\ncm9wZXJ0eS1hY2Nlc3MgcmVjb3JkIHRoYXQgT3BlbkpQQSBjcmVhdGVkLgog\nICAgICAgIGlmIChDbGFzc1JlZGVmaW5lci5jYW5SZWRlZmluZUNsYXNzZXMo\nKQogICAgICAgICAgICB8fCAoc20uZ2V0TWV0YURhdGEoKS5nZXRBY2Nlc3NU\neXBlKCkgIT0gQ2xhc3NNZXRhRGF0YS5BQ0NFU1NfRklFTEQpKQogICAgICAg\nIHsKICAgICAgICAgICAgYXNzZXJ0RmFsc2Uoc20uZ2V0TG9hZGVkKCkKICAg\nICAgICAgICAgICAgIC5nZXQoc20uZ2V0TWV0YURhdGEoKS5nZXRGaWVsZCgi\nbGF6eUZpZWxkIikuZ2V0SW5kZXgoKSkpOwoKICAgICAgICAgICAgLy8gbWFr\nZSBzdXJlIHRoYXQgdGhlIHZhbHVlIHdhcyBjbGVhcmVkCiAgICAgICAgICAg\nIEZpZWxkIGZpZWxkID0gZ2V0VW5lbmhhbmNlZENsYXNzKCkuZ2V0RGVjbGFy\nZWRGaWVsZCgibGF6eUZpZWxkIik7CiAgICAgICAgICAgIGZpZWxkLnNldEFj\nY2Vzc2libGUodHJ1ZSk7CiAgICAgICAgICAgIGFzc2VydEVxdWFscyhudWxs\nLCBmaWVsZC5nZXQodW4pKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAg\nICAvLyB1bnJlZGVmaW5lZCBmaWVsZCBhY2Nlc3MKICAgICAgICAgICAgYXNz\nZXJ0VHJ1ZShzbS5nZXRMb2FkZWQoKQogICAgICAgICAgICAgICAgLmdldChz\nbS5nZXRNZXRhRGF0YSgpLmdldEZpZWxkKCJsYXp5RmllbGQiKS5nZXRJbmRl\neCgpKSk7CgogICAgICAgICAgICAvLyBtYWtlIHN1cmUgdGhhdCB0aGUgdmFs\ndWUgd2FzIGxvYWRlZCBhbHJlYWR5CiAgICAgICAgICAgIEZpZWxkIGZpZWxk\nID0gZ2V0VW5lbmhhbmNlZENsYXNzKCkuZ2V0RGVjbGFyZWRGaWVsZCgibGF6\neUZpZWxkIik7CiAgICAgICAgICAgIGZpZWxkLnNldEFjY2Vzc2libGUodHJ1\nZSk7CiAgICAgICAgICAgIGFzc2VydEVxdWFscygibGF6eSIsIGZpZWxkLmdl\ndCh1bikpOwogICAgICAgIH0KCiAgICAgICAgLy8gbWFrZSBzdXJlIHRoYXQg\ndGhlIHZhbHVlIGlzIGF2YWlsYWJsZSwgb25lIHdheSBvciBhbm90aGVyCiAg\nICAgICAgYXNzZXJ0RXF1YWxzKCJsYXp5IiwgdW4uZ2V0TGF6eUZpZWxkKCkp\nOwogICAgICAgIGFzc2VydFRydWUoc20uZ2V0TG9hZGVkKCkKICAgICAgICAg\nICAgLmdldChzbS5nZXRNZXRhRGF0YSgpLmdldEZpZWxkKCJsYXp5RmllbGQi\nKS5nZXRJbmRleCgpKSk7CgogICAgICAgIGVtLmNsb3NlKCk7CiAgICB9Cgog\nICAgcHVibGljIHZvaWQgdGVzdFNlcmlhbGl6YXRpb25PZlVzZXJEZWZpbmVk\nSW5zdGFuY2UoKQogICAgICAgIHRocm93cyBJT0V4Y2VwdGlvbiwgQ2xhc3NO\nb3RGb3VuZEV4Y2VwdGlvbiB7CiAgICAgICAgc2VyaWFsaXphdGlvbkhlbHBl\ncih0cnVlLCBmYWxzZSk7CiAgICB9CgogICAgcHVibGljIHZvaWQgdGVzdFNl\ncmlhbGl6YXRpb25PZlVzZXJEZWZpbmVkU3ViY2xhc3NJbnN0YW5jZSgpCiAg\nICAgICAgdGhyb3dzIElPRXhjZXB0aW9uLCBDbGFzc05vdEZvdW5kRXhjZXB0\naW9uIHsKICAgICAgICBzZXJpYWxpemF0aW9uSGVscGVyKHRydWUsIHRydWUp\nOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHRlc3RTZXJpYWxpemF0aW9uT2ZP\ncGVuSlBBRGVmaW5lZEluc3RhbmNlKCkKICAgICAgICB0aHJvd3MgSU9FeGNl\ncHRpb24sIENsYXNzTm90Rm91bmRFeGNlcHRpb24gewogICAgICAgIHNlcmlh\nbGl6YXRpb25IZWxwZXIoZmFsc2UsIGZhbHNlKTsKICAgIH0KCiAgICBwdWJs\naWMgdm9pZCB0ZXN0U2VyaWFsaXphdGlvbk9mT3BlbkpQQURlZmluZWRTdWJj\nbGFzc0luc3RhbmNlKCkKICAgICAgICB0aHJvd3MgSU9FeGNlcHRpb24sIENs\nYXNzTm90Rm91bmRFeGNlcHRpb24gewogICAgICAgIHNlcmlhbGl6YXRpb25I\nZWxwZXIoZmFsc2UsIHRydWUpOwogICAgfQoKICAgIHByaXZhdGUgdm9pZCBz\nZXJpYWxpemF0aW9uSGVscGVyKGJvb2xlYW4gdXNlckRlZmluZWQsIGJvb2xl\nYW4gc3ViKQogICAgICAgIHRocm93cyBJT0V4Y2VwdGlvbiwgQ2xhc3NOb3RG\nb3VuZEV4Y2VwdGlvbiB7CiAgICAgICAgT3BlbkpQQUVudGl0eU1hbmFnZXIg\nZW0gPSBlbWYuY3JlYXRlRW50aXR5TWFuYWdlcigpOwogICAgICAgIFVuZW5o\nYW5jZWRUeXBlIHVuID0gbmV3SW5zdGFuY2Uoc3ViKTsKICAgICAgICBlbS5n\nZXRUcmFuc2FjdGlvbigpLmJlZ2luKCk7CiAgICAgICAgZW0ucGVyc2lzdCh1\nbik7CgogICAgICAgIGlmIChzdWIpIHsKICAgICAgICAgICAgVW5lbmhhbmNl\nZFR5cGUgcmVsYXRlZCA9IG5ld0luc3RhbmNlKGZhbHNlKTsKICAgICAgICAg\nICAgcmVsYXRlZC5zZXRTdHJpbmdGaWVsZCgicmVsYXRlZCIpOwogICAgICAg\nICAgICAoKFVuZW5oYW5jZWRTdWJ0eXBlKSB1bikuc2V0UmVsYXRlZChyZWxh\ndGVkKTsKICAgICAgICB9CgogICAgICAgIGVtLmdldFRyYW5zYWN0aW9uKCku\nY29tbWl0KCk7CgogICAgICAgIGlmICghdXNlckRlZmluZWQpIHsKICAgICAg\nICAgICAgZW0uY2xvc2UoKTsKICAgICAgICAgICAgZW0gPSBlbWYuY3JlYXRl\nRW50aXR5TWFuYWdlcigpOwogICAgICAgIH0KCiAgICAgICAgdW4gPSBlbS5m\naW5kKGdldFVuZW5oYW5jZWRDbGFzcygpLCB1bi5nZXRJZCgpKTsKICAgICAg\nICBCeXRlQXJyYXlPdXRwdXRTdHJlYW0gb3V0ID0gbmV3IEJ5dGVBcnJheU91\ndHB1dFN0cmVhbSgpOwogICAgICAgIE9iamVjdE91dHB1dFN0cmVhbSBvb3V0\nID0gbmV3IE9iamVjdE91dHB1dFN0cmVhbShvdXQpOwogICAgICAgIG9vdXQu\nd3JpdGVPYmplY3QodW4pOwogICAgICAgIG9vdXQuZmx1c2goKTsKICAgICAg\nICBieXRlW10gYnl0ZXMgPSBvdXQudG9CeXRlQXJyYXkoKTsKCiAgICAgICAg\nT2JqZWN0SW5wdXRTdHJlYW0gb2luID0gbmV3IE9iamVjdElucHV0U3RyZWFt\nKAogICAgICAgICAgICBuZXcgQnl0ZUFycmF5SW5wdXRTdHJlYW0oYnl0ZXMp\nKTsKICAgICAgICBVbmVuaGFuY2VkVHlwZSBkZXNlcmlhbGl6ZWQgPSAoVW5l\nbmhhbmNlZFR5cGUpIG9pbi5yZWFkT2JqZWN0KCk7CgogICAgICAgIGNvcGll\nZEluc3RhbmNlSGVscGVyKHN1YiwgZW0sIHVuLCBkZXNlcmlhbGl6ZWQsIGZh\nbHNlKTsKICAgICAgICBlbS5jbG9zZSgpOwogICAgfQoKICAgIHB1YmxpYyB2\nb2lkIHRlc3RDbG9uaW5nT2ZVc2VyRGVmaW5lZEluc3RhbmNlKCkKICAgICAg\nICB0aHJvd3MgSU9FeGNlcHRpb24sIENsYXNzTm90Rm91bmRFeGNlcHRpb24s\nIENsb25lTm90U3VwcG9ydGVkRXhjZXB0aW9uIHsKICAgICAgICBjbG9uZUhl\nbHBlcih0cnVlLCBmYWxzZSk7CiAgICB9CgogICAgcHVibGljIHZvaWQgdGVz\ndENsb25pbmdPZlVzZXJEZWZpbmVkU3ViY2xhc3NJbnN0YW5jZSgpCiAgICAg\nICAgdGhyb3dzIElPRXhjZXB0aW9uLCBDbGFzc05vdEZvdW5kRXhjZXB0aW9u\nLCBDbG9uZU5vdFN1cHBvcnRlZEV4Y2VwdGlvbiB7CiAgICAgICAgY2xvbmVI\nZWxwZXIodHJ1ZSwgdHJ1ZSk7CiAgICB9CgogICAgcHVibGljIHZvaWQgdGVz\ndENsb25pbmdPZk9wZW5KUEFEZWZpbmVkSW5zdGFuY2UoKQogICAgICAgIHRo\ncm93cyBJT0V4Y2VwdGlvbiwgQ2xhc3NOb3RGb3VuZEV4Y2VwdGlvbiwgQ2xv\nbmVOb3RTdXBwb3J0ZWRFeGNlcHRpb24gewogICAgICAgIGNsb25lSGVscGVy\nKGZhbHNlLCBmYWxzZSk7CiAgICB9CgogICAgcHVibGljIHZvaWQgdGVzdENs\nb25pbmdPZk9wZW5KUEFEZWZpbmVkU3ViY2xhc3NJbnN0YW5jZSgpCiAgICAg\nICAgdGhyb3dzIElPRXhjZXB0aW9uLCBDbGFzc05vdEZvdW5kRXhjZXB0aW9u\nLCBDbG9uZU5vdFN1cHBvcnRlZEV4Y2VwdGlvbiB7CiAgICAgICAgY2xvbmVI\nZWxwZXIoZmFsc2UsIHRydWUpOwogICAgfQoKICAgIHByaXZhdGUgdm9pZCBj\nbG9uZUhlbHBlcihib29sZWFuIHVzZXJEZWZpbmVkLCBib29sZWFuIHN1YikK\nICAgICAgICB0aHJvd3MgSU9FeGNlcHRpb24sIENsYXNzTm90Rm91bmRFeGNl\ncHRpb24sIENsb25lTm90U3VwcG9ydGVkRXhjZXB0aW9uIHsKICAgICAgICBP\ncGVuSlBBRW50aXR5TWFuYWdlciBlbSA9IGVtZi5jcmVhdGVFbnRpdHlNYW5h\nZ2VyKCk7CiAgICAgICAgVW5lbmhhbmNlZFR5cGUgdW4gPSBuZXdJbnN0YW5j\nZShzdWIpOwogICAgICAgIGVtLmdldFRyYW5zYWN0aW9uKCkuYmVnaW4oKTsK\nICAgICAgICBlbS5wZXJzaXN0KHVuKTsKCiAgICAgICAgaWYgKHN1Yikgewog\nICAgICAgICAgICBVbmVuaGFuY2VkVHlwZSByZWxhdGVkID0gbmV3SW5zdGFu\nY2UoZmFsc2UpOwogICAgICAgICAgICByZWxhdGVkLnNldFN0cmluZ0ZpZWxk\nKCJyZWxhdGVkIik7CiAgICAgICAgICAgICgoVW5lbmhhbmNlZFN1YnR5cGUp\nIHVuKS5zZXRSZWxhdGVkKHJlbGF0ZWQpOwogICAgICAgIH0KCiAgICAgICAg\nZW0uZ2V0VHJhbnNhY3Rpb24oKS5jb21taXQoKTsKCiAgICAgICAgaWYgKCF1\nc2VyRGVmaW5lZCkgewogICAgICAgICAgICBlbS5jbG9zZSgpOwogICAgICAg\nICAgICBlbSA9IGVtZi5jcmVhdGVFbnRpdHlNYW5hZ2VyKCk7CiAgICAgICAg\nfQoKICAgICAgICB1biA9IGVtLmZpbmQoZ2V0VW5lbmhhbmNlZENsYXNzKCks\nIHVuLmdldElkKCkpOwogICAgICAgIFVuZW5oYW5jZWRUeXBlIGNsb25lZCA9\nIChVbmVuaGFuY2VkVHlwZSkgdW4uY2xvbmUoKTsKCiAgICAgICAgY29waWVk\nSW5zdGFuY2VIZWxwZXIoc3ViLCBlbSwgdW4sIGNsb25lZCwgdHJ1ZSk7CiAg\nICAgICAgZW0uY2xvc2UoKTsKICAgIH0KCiAgICBwcml2YXRlIHZvaWQgY29w\naWVkSW5zdGFuY2VIZWxwZXIoYm9vbGVhbiBzdWIsIE9wZW5KUEFFbnRpdHlN\nYW5hZ2VyIGVtLAogICAgICAgIFVuZW5oYW5jZWRUeXBlIHVuLCBVbmVuaGFu\nY2VkVHlwZSBjb3B5LCBib29sZWFuIHZpYUNsb25lKSB7CiAgICAgICAgYXNz\nZXJ0Tm90U2FtZSh1biwgY29weSk7CiAgICAgICAgaWYgKCF2aWFDbG9uZSkK\nICAgICAgICAgICAgYXNzZXJ0RXF1YWxzKHN1YiA/IGdldFVuZW5oYW5jZWRT\ndWJjbGFzcygpIDogZ2V0VW5lbmhhbmNlZENsYXNzKCksCiAgICAgICAgICAg\nICAgICBjb3B5LmdldENsYXNzKCkpOwogICAgICAgIGFzc2VydEVxdWFscyh1\nbi5nZXRJZCgpLCBjb3B5LmdldElkKCkpOwogICAgICAgIGFzc2VydEVxdWFs\ncyh1bi5nZXRTdHJpbmdGaWVsZCgpLCBjb3B5LmdldFN0cmluZ0ZpZWxkKCkp\nOwogICAgICAgIGlmIChzdWIpIHsKICAgICAgICAgICAgYXNzZXJ0RXF1YWxz\nKAogICAgICAgICAgICAgICAgKChVbmVuaGFuY2VkU3VidHlwZSkgdW4pLmdl\ndEludEZpZWxkKCksCiAgICAgICAgICAgICAgICAoKFVuZW5oYW5jZWRTdWJ0\neXBlKSBjb3B5KS5nZXRJbnRGaWVsZCgpKTsKICAgICAgICAgICAgYXNzZXJ0\nTm90U2FtZSgKICAgICAgICAgICAgICAgICgoVW5lbmhhbmNlZFN1YnR5cGUp\nIHVuKS5nZXRSZWxhdGVkKCksCiAgICAgICAgICAgICAgICAoKFVuZW5oYW5j\nZWRTdWJ0eXBlKSBjb3B5KS5nZXRSZWxhdGVkKCkpOwogICAgICAgICAgICBh\nc3NlcnRFcXVhbHMoCiAgICAgICAgICAgICAgICAoKFVuZW5oYW5jZWRTdWJ0\neXBlKSB1bikuZ2V0UmVsYXRlZCgpLmdldElkKCksCiAgICAgICAgICAgICAg\nICAoKFVuZW5oYW5jZWRTdWJ0eXBlKSBjb3B5KS5nZXRSZWxhdGVkKCkuZ2V0\nSWQoKSk7CiAgICAgICAgfQoKICAgICAgICBhc3NlcnRGYWxzZShlbS5pc0Rl\ndGFjaGVkKHVuKSk7CiAgICAgICAgYXNzZXJ0VHJ1ZShlbS5pc0RldGFjaGVk\nKGNvcHkpKTsKCiAgICAgICAgLyoKICAgICAgICAjIyMjIyBuZWVkIHRvIG1h\na2UgZGV0YWNobWVudCBhbGdvcml0aG0gaW4gUmVmbGVjdGluZ1BDIHNtYXJ0\nZXIKICAgICAgICAvLyBlbnN1cmUgdGhhdCByZW1vdmUoKSBjYW5ub3QgYmUg\naW52b2tlZCBvbiBhIGRldGFjaGVkIGluc3RhbmNlCiAgICAgICAgdHJ5IHsK\nICAgICAgICAgICAgZW0uZ2V0VHJhbnNhY3Rpb24oKS5iZWdpbigpOwogICAg\nICAgICAgICBlbS5yZW1vdmUoY29weSk7CiAgICAgICAgICAgIGZhaWwoInJl\nbW92ZSgpIGNhbm5vdCBiZSBpbnZva2VkIG9uIGRldGFjaGVkIGluc3RhbmNl\nIik7CiAgICAgICAgfSBjYXRjaCAoSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9u\nIGUpIHsKICAgICAgICAgICAgZW0uZ2V0VHJhbnNhY3Rpb24oKS5yb2xsYmFj\naygpOwogICAgICAgIH0KICAgICAgICAqLwoKICAgICAgICBjb3B5LnNldFN0\ncmluZ0ZpZWxkKCJvZmZsaW5lIHVwZGF0ZSIpOwoKICAgICAgICBlbS5nZXRU\ncmFuc2FjdGlvbigpLmJlZ2luKCk7CiAgICAgICAgYXNzZXJ0U2FtZSh1biwg\nZW0ubWVyZ2UoY29weSkpOwogICAgICAgIGFzc2VydFRydWUoZW0uaXNEaXJ0\neSh1bikpOwogICAgICAgIGFzc2VydEVxdWFscygib2ZmbGluZSB1cGRhdGUi\nLCB1bi5nZXRTdHJpbmdGaWVsZCgpKTsKICAgICAgICBlbS5nZXRUcmFuc2Fj\ndGlvbigpLmNvbW1pdCgpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHRlc3RM\naXN0ZW5lcnNPblVzZXJEZWZpbmVkSW5zdGFuY2UoKQogICAgICAgIHRocm93\ncyBJT0V4Y2VwdGlvbiwgQ2xhc3NOb3RGb3VuZEV4Y2VwdGlvbiwgQ2xvbmVO\nb3RTdXBwb3J0ZWRFeGNlcHRpb24gewogICAgICAgIGxpc3RlbmVySGVscGVy\nKHRydWUsIGZhbHNlKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCB0ZXN0TGlz\ndGVuZXJzT25Vc2VyRGVmaW5lZFN1YmNsYXNzSW5zdGFuY2UoKQogICAgICAg\nIHRocm93cyBJT0V4Y2VwdGlvbiwgQ2xhc3NOb3RGb3VuZEV4Y2VwdGlvbiwg\nQ2xvbmVOb3RTdXBwb3J0ZWRFeGNlcHRpb24gewogICAgICAgIGxpc3RlbmVy\nSGVscGVyKHRydWUsIHRydWUpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHRl\nc3RMaXN0ZW5lcnNPbk9wZW5KUEFEZWZpbmVkSW5zdGFuY2UoKQogICAgICAg\nIHRocm93cyBJT0V4Y2VwdGlvbiwgQ2xhc3NOb3RGb3VuZEV4Y2VwdGlvbiwg\nQ2xvbmVOb3RTdXBwb3J0ZWRFeGNlcHRpb24gewogICAgICAgIGxpc3RlbmVy\nSGVscGVyKGZhbHNlLCBmYWxzZSk7CiAgICB9CgogICAgcHVibGljIHZvaWQg\ndGVzdExpc3RlbmVyc09uT3BlbkpQQURlZmluZWRTdWJjbGFzc0luc3RhbmNl\nKCkKICAgICAgICB0aHJvd3MgSU9FeGNlcHRpb24sIENsYXNzTm90Rm91bmRF\neGNlcHRpb24sIENsb25lTm90U3VwcG9ydGVkRXhjZXB0aW9uIHsKICAgICAg\nICBsaXN0ZW5lckhlbHBlcihmYWxzZSwgdHJ1ZSk7CiAgICB9CgogICAgcHJp\ndmF0ZSB2b2lkIGxpc3RlbmVySGVscGVyKGJvb2xlYW4gdXNlckRlZmluZWQs\nIGJvb2xlYW4gc3ViKQogICAgICAgIHRocm93cyBJT0V4Y2VwdGlvbiwgQ2xh\nc3NOb3RGb3VuZEV4Y2VwdGlvbiwgQ2xvbmVOb3RTdXBwb3J0ZWRFeGNlcHRp\nb24gewogICAgICAgIExpc3RlbmVySW1wbCBsaXN0ZW5lciA9IG5ldyBMaXN0\nZW5lckltcGwoKTsKICAgICAgICBlbWYuYWRkTGlmZWN5Y2xlTGlzdGVuZXIo\nbGlzdGVuZXIsIChDbGFzc1tdKSBudWxsKTsKICAgICAgICBPcGVuSlBBRW50\naXR5TWFuYWdlciBlbSA9IGVtZi5jcmVhdGVFbnRpdHlNYW5hZ2VyKCk7CiAg\nICAgICAgVW5lbmhhbmNlZFR5cGUgdW4gPSBuZXdJbnN0YW5jZShzdWIpOwog\nICAgICAgIGVtLmdldFRyYW5zYWN0aW9uKCkuYmVnaW4oKTsKICAgICAgICBl\nbS5wZXJzaXN0KHVuKTsKICAgICAgICBlbS5nZXRUcmFuc2FjdGlvbigpLmNv\nbW1pdCgpOwoKICAgICAgICBpZiAoIXVzZXJEZWZpbmVkKSB7CiAgICAgICAg\nICAgIGVtLmNsb3NlKCk7CiAgICAgICAgICAgIGVtID0gZW1mLmNyZWF0ZUVu\ndGl0eU1hbmFnZXIoKTsKICAgICAgICB9CgogICAgICAgIGxpc3RlbmVyLmlu\ndm9rZWQgPSBmYWxzZTsKCiAgICAgICAgdW4gPSBlbS5maW5kKGdldFVuZW5o\nYW5jZWRDbGFzcygpLCB1bi5nZXRJZCgpKTsKICAgICAgICBlbS5nZXRUcmFu\nc2FjdGlvbigpLmJlZ2luKCk7CiAgICAgICAgdW4uc2V0U3RyaW5nRmllbGQo\nInVwZGF0ZWQiKTsKICAgICAgICBlbS5nZXRUcmFuc2FjdGlvbigpLmNvbW1p\ndCgpOwogICAgICAgIGFzc2VydFRydWUobGlzdGVuZXIuaW52b2tlZCk7CiAg\nICAgICAgZW0uY2xvc2UoKTsKCiAgICAgICAgYXNzZXJ0RXF1YWxzKCJ1cGRh\ndGVkIiwgbGlzdGVuZXIuc3RyaW5nRmllbGQpOwogICAgfQoKICAgIHB1Ymxp\nYyB2b2lkIHRlc3RHZXRNZXRhRGF0YU9mU3VidHlwZSgpIHsKICAgICAgICBD\nbGFzc01ldGFEYXRhIG1ldGEgPSBKUEFGYWNhZGVIZWxwZXIuZ2V0TWV0YURh\ndGEoZW1mLAogICAgICAgICAgICBnZXRVbmVuaGFuY2VkQ2xhc3MoKSk7CiAg\nICAgICAgTGlzdDxDbGFzcz4gc3VicyA9ICBNYW5hZ2VkQ2xhc3NTdWJjbGFz\nc2VyLnByZXBhcmVVbmVuaGFuY2VkQ2xhc3NlcygKICAgICAgICAgICAgZW1m\nLmdldENvbmZpZ3VyYXRpb24oKSwKICAgICAgICAgICAgQ29sbGVjdGlvbnMu\nc2luZ2xldG9uKGdldFVuZW5oYW5jZWRDbGFzcygpKSwgbnVsbCk7CiAgICAg\nICAgYXNzZXJ0U2FtZShtZXRhLCBKUEFGYWNhZGVIZWxwZXIuZ2V0TWV0YURh\ndGEoZW1mLCBzdWJzLmdldCgwKSkpOwoKICAgICAgICBtZXRhID0gSlBBRmFj\nYWRlSGVscGVyLmdldE1ldGFEYXRhKGVtZiwgZ2V0VW5lbmhhbmNlZFN1YmNs\nYXNzKCkpOwogICAgICAgIHN1YnMgPSAgTWFuYWdlZENsYXNzU3ViY2xhc3Nl\nci5wcmVwYXJlVW5lbmhhbmNlZENsYXNzZXMoCiAgICAgICAgICAgIGVtZi5n\nZXRDb25maWd1cmF0aW9uKCksCiAgICAgICAgICAgIENvbGxlY3Rpb25zLnNp\nbmdsZXRvbihnZXRVbmVuaGFuY2VkU3ViY2xhc3MoKSksIG51bGwpOwogICAg\nICAgIGFzc2VydFNhbWUobWV0YSwgSlBBRmFjYWRlSGVscGVyLmdldE1ldGFE\nYXRhKGVtZiwgc3Vicy5nZXQoMCkpKTsKICAgIH0KCiAgICBwcml2YXRlIGNs\nYXNzIExpc3RlbmVySW1wbAogICAgICAgIGV4dGVuZHMgQWJzdHJhY3RMaWZl\nY3ljbGVMaXN0ZW5lciB7CgogICAgICAgIFN0cmluZyBzdHJpbmdGaWVsZDsK\nICAgICAgICBib29sZWFuIGludm9rZWQ7CgogICAgICAgIEBPdmVycmlkZQog\nICAgICAgIHB1YmxpYyB2b2lkIGFmdGVyU3RvcmUoTGlmZWN5Y2xlRXZlbnQg\nZXZlbnQpIHsKICAgICAgICAgICAgaW52b2tlZCA9IHRydWU7CiAgICAgICAg\nICAgIHN0cmluZ0ZpZWxkID0gKChVbmVuaGFuY2VkVHlwZSkgZXZlbnQuZ2V0\nU291cmNlKCkpLmdldFN0cmluZ0ZpZWxkKCk7CiAgICAgICAgfQogICAgfQp9\n","encoding":"base64"}

