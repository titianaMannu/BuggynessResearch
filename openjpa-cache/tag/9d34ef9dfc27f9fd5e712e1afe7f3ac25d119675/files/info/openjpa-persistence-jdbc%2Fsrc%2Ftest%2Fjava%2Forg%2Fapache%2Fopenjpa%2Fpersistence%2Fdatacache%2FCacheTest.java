{"sha":"fa09b23c94bf2464987d8d4b1c25111ea72b3c4d","node_id":"MDQ6QmxvYjIwNjM2NDpmYTA5YjIzYzk0YmYyNDY0OTg3ZDhkNGIxYzI1MTExZWE3MmIzYzRk","size":57289,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/fa09b23c94bf2464987d8d4b1c25111ea72b3c4d","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuZGF0YWNh\nY2hlOwoKaW1wb3J0IGphdmEudXRpbC5BcnJheUxpc3Q7CmltcG9ydCBqYXZh\nLnV0aWwuQ29sbGVjdGlvbjsKaW1wb3J0IGphdmEudXRpbC5EYXRlOwppbXBv\ncnQgamF2YS51dGlsLkhhc2hNYXA7CmltcG9ydCBqYXZhLnV0aWwuSGFzaFNl\ndDsKaW1wb3J0IGphdmEudXRpbC5JdGVyYXRvcjsKaW1wb3J0IGphdmEudXRp\nbC5MaW5rZWRMaXN0OwppbXBvcnQgamF2YS51dGlsLkxpc3Q7CmltcG9ydCBq\nYXZhLnV0aWwuTG9jYWxlOwppbXBvcnQgamF2YS51dGlsLk1hcDsKaW1wb3J0\nIGphdmEudXRpbC5TZXQ7CmltcG9ydCBqYXZheC5wZXJzaXN0ZW5jZS5FbnRp\ndHlNYW5hZ2VyOwoKCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lz\ndGVuY2UuZGF0YWNhY2hlLmNvbW1vbi5hcHBzLkFwcElkQ2FjaGVPYmplY3Q7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuZGF0YWNh\nY2hlLmNvbW1vbi5hcHBzLkNhY2hlT2JqZWN0QTsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5kYXRhY2FjaGUuY29tbW9uLmFwcHMu\nQ2FjaGVPYmplY3RBQ2hpbGQxOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLnBlcnNpc3RlbmNlLmRhdGFjYWNoZS5jb21tb24uYXBwcy5DYWNoZU9iamVj\ndEFDaGlsZDI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVu\nY2UuZGF0YWNhY2hlLmNvbW1vbi5hcHBzLkNhY2hlT2JqZWN0QjsKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5kYXRhY2FjaGUuY29t\nbW9uLmFwcHMuQ2FjaGVPYmplY3RCQ2hpbGQxOwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLnBlcnNpc3RlbmNlLmRhdGFjYWNoZS5jb21tb24uYXBwcy5D\nYWNoZU9iamVjdEM7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lz\ndGVuY2UuZGF0YWNhY2hlLmNvbW1vbi5hcHBzLkNhY2hlT2JqZWN0RDsKaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5kYXRhY2FjaGUu\nY29tbW9uLmFwcHMuQ2FjaGVPYmplY3RFOwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLnBlcnNpc3RlbmNlLmRhdGFjYWNoZS5jb21tb24uYXBwcy5DYWNo\nZU9iamVjdEY7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVu\nY2UuZGF0YWNhY2hlLmNvbW1vbi5hcHBzLkNhY2hlT2JqZWN0RzsKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5kYXRhY2FjaGUuY29t\nbW9uLmFwcHMuQ2FjaGVPYmplY3RIOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLnBlcnNpc3RlbmNlLmRhdGFjYWNoZS5jb21tb24uYXBwcy5DYWNoZU9i\namVjdEludGVyZmFjZTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5wZXJz\naXN0ZW5jZS5kYXRhY2FjaGUuY29tbW9uLmFwcHMuQ2FjaGVPYmplY3RKOwpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNlLmRhdGFjYWNo\nZS5jb21tb24uYXBwcy5SdW50aW1lVGVzdDE7CmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEucGVyc2lzdGVuY2UuY29tbW9uLnV0aWxzLkFic3RyYWN0VGVz\ndENhc2U7CmltcG9ydCBqdW5pdC5mcmFtZXdvcmsuQXNzZXJ0aW9uRmFpbGVk\nRXJyb3I7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuZGF0YWNhY2hlLkNv\nbmN1cnJlbnREYXRhQ2FjaGU7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\nZGF0YWNhY2hlLkRhdGFDYWNoZTsKaW1wb3J0IG9yZy5hcGFjaGUub3Blbmpw\nYS5kYXRhY2FjaGUuRGVsZWdhdGluZ0RhdGFDYWNoZTsKaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS5kYXRhY2FjaGUuUXVlcnlDYWNoZTsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5kYXRhY2FjaGUuVHlwZXNDaGFuZ2VkRXZlbnQ7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuZGF0YWNhY2hlLkRhdGFDYWNo\nZU1hbmFnZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLkJy\nb2tlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuT3BlbkpQ\nQVN0YXRlTWFuYWdlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJu\nZWwuUENEYXRhOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5q\ncHFsLkpQUUxQYXJzZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0\nYS5DbGFzc01ldGFEYXRhOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1l\ndGEuRmllbGRNZXRhRGF0YTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5t\nZXRhLk1ldGFEYXRhUmVwb3NpdG9yeTsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5wZXJzaXN0ZW5jZS5FeHRlbnQ7CmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEucGVyc2lzdGVuY2UuSlBBRmFjYWRlSGVscGVyOwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNlLk9wZW5KUEFFbnRpdHlNYW5h\nZ2VyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNlLk9w\nZW5KUEFFbnRpdHlNYW5hZ2VyRmFjdG9yeTsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS5wZXJzaXN0ZW5jZS5PcGVuSlBBRW50aXR5TWFuYWdlckZhY3Rv\ncnlTUEk7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2Uu\nT3BlbkpQQVBlcnNpc3RlbmNlOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLnBlcnNpc3RlbmNlLk9wZW5KUEFRdWVyeTsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS51dGlsLkNhY2hlTWFwOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLnV0aWwuSWQ7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5J\nbXBsSGVscGVyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuT3Bl\nbkpQQUV4Y2VwdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGls\nLlByb3h5RGF0ZTsKCi8qKgogKiAjIyMgc2hvdWxkIGFkZCAxLi4xIHJlbGF0\naW9uIHRlc3QgIyMjIGFwcCBpZCBjb21wb3VuZCBrZXkgdGVzdAogKi8KcHVi\nbGljIGFic3RyYWN0IGNsYXNzIENhY2hlVGVzdCBleHRlbmRzIEFic3RyYWN0\nVGVzdENhc2UgewoKICAgIHByaXZhdGUgc3RhdGljIFN0cmluZyBPUklHX05B\nTUUgPSAib3JpZ05hbWUiOwoKICAgIHByaXZhdGUgc3RhdGljIFN0cmluZyBO\nRVdfTkFNRSA9ICJuZXdOYW1lIjsKCiAgICBwcml2YXRlIHN0YXRpYyBpbnQg\nT1JJR19BR0UgPSAzMDsKCiAgICBwcml2YXRlIHN0YXRpYyBTdHJpbmcgT1JJ\nR19QQVJFTlRfTkFNRSA9ICJvcmlnUGFyZW50TmFtZSI7CgogICAgcHJpdmF0\nZSBzdGF0aWMgaW50IE9SSUdfUEFSRU5UX0FHRSA9IDMxOwoKICAgIHByaXZh\ndGUgT3BlbkpQQUVudGl0eU1hbmFnZXJGYWN0b3J5IHRpbWVvdXRGYWN0b3J5\nID0gbnVsbDsKCiAgICBwcml2YXRlIE9wZW5KUEFFbnRpdHlNYW5hZ2VyRmFj\ndG9yeSBmYWN0b3J5ID0gbnVsbDsKCiAgICBwcml2YXRlIE9wZW5KUEFFbnRp\ndHlNYW5hZ2VyRmFjdG9yeSBmYWN0b3J5MiA9IG51bGw7CgogICAgcHJpdmF0\nZSBNZXRhRGF0YVJlcG9zaXRvcnkgcmVwb3M7CgogICAgcHJpdmF0ZSBPYmpl\nY3Qgb2lkOwoKICAgIHByaXZhdGUgT2JqZWN0IHBhcmVudE9pZDsKCiAgICBw\ncml2YXRlIE9iamVjdCBvaWR3aXRoY2xhc3M7CgogICAgcHJpdmF0ZSBPcGVu\nSlBBRW50aXR5TWFuYWdlciBlbTsKCiAgICBwcml2YXRlIENhY2hlT2JqZWN0\nQSBhOwoKICAgIHB1YmxpYyBDYWNoZVRlc3QoU3RyaW5nIHRlc3QpIHsKICAg\nICAgICBzdXBlcih0ZXN0LCAiZGF0YWNhY2hlY2FjdHVzYXBwIik7CiAgICB9\nCgogICAgcHVibGljIHZvaWQgY2xlYXIoKSB0aHJvd3MgRXhjZXB0aW9uIHsK\nICAgICAgICBPcGVuSlBBRW50aXR5TWFuYWdlciBlbSA9IChPcGVuSlBBRW50\naXR5TWFuYWdlcikgZmFjdG9yeQogICAgICAgICAgICAuY3JlYXRlRW50aXR5\nTWFuYWdlcigpOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIENsYXNzW10g\ndG9EZWxldGUgPSBuZXcgQ2xhc3NbXXsgQ2FjaGVPYmplY3RBLmNsYXNzLAog\nICAgICAgICAgICAgICAgQ2FjaGVPYmplY3RCLmNsYXNzLCBDYWNoZU9iamVj\ndEMuY2xhc3MsIENhY2hlT2JqZWN0RC5jbGFzcywKICAgICAgICAgICAgICAg\nIENhY2hlT2JqZWN0RS5jbGFzcywgQ2FjaGVPYmplY3RKLmNsYXNzLAogICAg\nICAgICAgICAgICAgQXBwSWRDYWNoZU9iamVjdC5jbGFzcywgfTsKICAgICAg\nICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCB0b0RlbGV0ZS5sZW5ndGg7IGkr\nKykgewogICAgICAgICAgICAgICAgc3RhcnRUeChlbSk7CiAgICAgICAgICAg\nICAgICBFeHRlbnQgZSA9IGVtLmNyZWF0ZUV4dGVudCh0b0RlbGV0ZVtpXSwg\ndHJ1ZSk7CiAgICAgICAgICAgICAgICBJdGVyYXRvciBpdCA9IGUuaXRlcmF0\nb3IoKTsKICAgICAgICAgICAgICAgIHdoaWxlIChpdC5oYXNOZXh0KCkpIHsK\nICAgICAgICAgICAgICAgICAgICBlbS5yZW1vdmUoaXQubmV4dCgpKTsKICAg\nICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVuZFR4KGVtKTsKICAg\nICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBjYXRjaCAoT3BlbkpQQUV4\nY2VwdGlvbiBqcGFlKSB7CiAgICAgICAgICAgIFRocm93YWJsZVtdIHRzID0g\nanBhZS5nZXROZXN0ZWRUaHJvd2FibGVzKCk7CiAgICAgICAgICAgIGZvciAo\naW50IGkgPSAwOyB0cyAhPSBudWxsICYmIGkgPCB0cy5sZW5ndGg7IGkrKykg\newogICAgICAgICAgICAgICAgdHNbaV0ucHJpbnRTdGFja1RyYWNlKCk7CiAg\nICAgICAgICAgIH0KLy8JCQlqcGFlLnByaW50U3RhY2tUcmFjZSgpOwoKICAg\nICAgICB9CiAgICAgICAgZmluYWxseSB7CiAgICAgICAgICAgIGVuZEVtKGVt\nKTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gYSBz\ndHJpbmcgYXJyYXkgb2YgZXh0cmEgY29uZmlndXJhdGlvbiBvcHRpb25zIGZv\nciB0aGUgc3BlY2lmaWVkCiAgICAgKiBjYWNoZS4KICAgICAqLwogICAgcHJv\ndGVjdGVkIGFic3RyYWN0IFN0cmluZ1tdIGdldENvbmZzKCk7CgogICAgLyoq\nCiAgICAgKiBSZXR1cm4gYSBzdHJpbmcgYXJyYXkgb2YgZXh0cmEgY29uZmln\ndXJhdGlvbiBvcHRpb25zIGZvciBhIHNlY29uZCBjYWNoZS4KICAgICAqLwog\nICAgcHJvdGVjdGVkIGFic3RyYWN0IFN0cmluZ1tdIGdldENvbmZzMigpOwoK\nICAgIC8qKgogICAgICogUmV0dXJuIHRydWUgaWYgdGhpcyBjYWNoZSBpcyBh\nIGNvaGVyZW50IG9uZSAob25lIHdoZXJlIGNoYW5nZXMgaW4gb25lCiAgICAg\nKiBjYWNoZSBhcmUgaW1tZWRpYXRlbHkgdmlzaWJsZSBlbHNld2hlcmUpOyBv\ndGhlcndpc2UgcmV0dXJucyBmYWxzZS4gSW4gdGhlCiAgICAgKiBjb250ZXh0\nIG9mIHRoaXMgdGVzdCBjbGFzcywgY29oZXJlbmNlIGlzIGEgc2luZ2xlLUpW\nTSB0aGluZyBvbmx5LgogICAgICovCiAgICBwcm90ZWN0ZWQgYm9vbGVhbiBp\nc0NhY2hlQ29oZXJlbnQoKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAg\nfQoKICAgIHB1YmxpYyB2b2lkIHNldFVwKCkgdGhyb3dzIEV4Y2VwdGlvbiB7\nCgogICAgICAgIFN0cmluZ1tdIGNvbmZzID0gZ2V0Q29uZnMoKTsKICAgICAg\nICBmb3IgKGludCBpID0gMDsgaSA8IGNvbmZzLmxlbmd0aDsgaSA9IGkgKyAy\nKSB7CiAgICAgICAgICAgIGlmICgib3BlbmpwYS5EYXRhQ2FjaGUiLmVxdWFs\ncyhjb25mc1tpXSkpCiAgICAgICAgICAgICAgICBjb25mc1tpICsgMV0gKz0K\nICAgICAgICAgICAgICAgICAgICAiLCB0cnVlKE5hbWU9bm90LXRoZS1kZWZh\ndWx0LWNhY2hlLCBDYWNoZVNpemU9MTApIjsKICAgICAgICB9CgogICAgICAg\nIFN0cmluZ1tdIGNvbmZzMiA9IGdldENvbmZzMigpOwogICAgICAgIGZvciAo\naW50IGkgPSAwOyBpIDwgY29uZnMyLmxlbmd0aDsgaSA9IGkgKyAyKSB7CiAg\nICAgICAgICAgIGlmICgib3BlbmpwYS5EYXRhQ2FjaGUiLmVxdWFscyhjb25m\nczJbaV0pKQogICAgICAgICAgICAgICAgY29uZnMyW2kgKyAxXSArPQogICAg\nICAgICAgICAgICAgICAgICIsIHRydWUoTmFtZT1ub3QtdGhlLWRlZmF1bHQt\nY2FjaGUsIENhY2hlU2l6ZT0xMCkiOwogICAgICAgIH0KCiAgICAgICAgTWFw\nIHByb3BzTWFwMSA9IG5ldyBIYXNoTWFwKCk7CiAgICAgICAgZm9yIChpbnQg\naSA9IDA7IGkgPCBjb25mcy5sZW5ndGg7IGkgKz0gMikgewogICAgICAgICAg\nICBwcm9wc01hcDEucHV0KGNvbmZzW2ldLCBjb25mc1tpICsgMV0pOwogICAg\nICAgIH0KICAgICAgICBNYXAgcHJvcHNNYXAyID0gbmV3IEhhc2hNYXAoKTsK\nICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGNvbmZzMi5sZW5ndGg7IGkg\nKz0gMikgewogICAgICAgICAgICBwcm9wc01hcDIucHV0KGNvbmZzMltpXSwg\nY29uZnMyW2kgKyAxXSk7CiAgICAgICAgfQoKICAgICAgICBmYWN0b3J5ID0g\nKE9wZW5KUEFFbnRpdHlNYW5hZ2VyRmFjdG9yeSkgZ2V0RW1mKHByb3BzTWFw\nMSk7CiAgICAgICAgZmFjdG9yeTIgPSAoT3BlbkpQQUVudGl0eU1hbmFnZXJG\nYWN0b3J5KSBnZXRFbWYocHJvcHNNYXAyKTsKCiAgICAgICAgcmVwb3MgPSBK\nUEFGYWNhZGVIZWxwZXIudG9Ccm9rZXJGYWN0b3J5KGZhY3RvcnkpLmdldENv\nbmZpZ3VyYXRpb24oKQogICAgICAgICAgICAuZ2V0TWV0YURhdGFSZXBvc2l0\nb3J5SW5zdGFuY2UoKTsKCiAgICAgICAgU3RyaW5nW10gYmlnZ2VyQ29uZnMg\nPSBuZXcgU3RyaW5nW2NvbmZzLmxlbmd0aCArIDJdOwogICAgICAgIFN5c3Rl\nbS5hcnJheWNvcHkoY29uZnMsIDAsIGJpZ2dlckNvbmZzLCAwLCBjb25mcy5s\nZW5ndGgpOwogICAgICAgIGJpZ2dlckNvbmZzW2JpZ2dlckNvbmZzLmxlbmd0\naCAtIDJdID0gIm9wZW5qcGEuRGF0YUNhY2hlVGltZW91dCI7CiAgICAgICAg\nYmlnZ2VyQ29uZnNbYmlnZ2VyQ29uZnMubGVuZ3RoIC0gMV0gPSAiMTAwMCI7\nCiAgICAgICAgTWFwIHByb3BzTWFwMyA9IG5ldyBIYXNoTWFwKCk7CiAgICAg\nICAgZm9yIChpbnQgaSA9IDA7IGkgPCBiaWdnZXJDb25mcy5sZW5ndGg7IGkg\nKz0gMikgewogICAgICAgICAgICBwcm9wc01hcDMucHV0KGJpZ2dlckNvbmZz\nW2ldLCBiaWdnZXJDb25mc1tpICsgMV0pOwogICAgICAgIH0KICAgICAgICB0\naW1lb3V0RmFjdG9yeSA9IChPcGVuSlBBRW50aXR5TWFuYWdlckZhY3Rvcnkp\nIGdldEVtZihwcm9wc01hcDMpOwoKICAgICAgICBjbGVhcigpOwoKICAgICAg\nICBPcGVuSlBBRW50aXR5TWFuYWdlciBlbSA9IChPcGVuSlBBRW50aXR5TWFu\nYWdlcikgZmFjdG9yeQogICAgICAgICAgICAuY3JlYXRlRW50aXR5TWFuYWdl\ncigpOwoKICAgICAgICBDYWNoZU9iamVjdEEgYTsKICAgICAgICBDYWNoZU9i\namVjdEEgYXBhcmVudDsKICAgICAgICB0cnkgewogICAgICAgICAgICAvLyB3\nZSBjYW4ndCBzcGVjaWZ5IHRoaXMgZm9yIFVzZXJUcmFuc2FjdGlvbgogICAg\nICAgICAgICAvKgogICAgICAgICAgICAgICAgKiBwbS5jdXJyZW50VHJhbnNh\nY3Rpb24oKS5zZXROb250cmFuc2FjdGlvbmFsUmVhZCh0cnVlKTsKICAgICAg\nICAgICAgICAgICogcG0uY3VycmVudFRyYW5zYWN0aW9uKCkuc2V0T3B0aW1p\nc3RpYyh0cnVlKTsKICAgICAgICAgICAgICAgICovCgovLwkJCWVtLnNldE5v\nbnRyYW5zYWN0aW9uYWxSZWFkKHRydWUpOwovLwkJCWVtLnNldE9wdGltaXN0\naWModHJ1ZSk7CgogICAgICAgICAgICBhID0gbmV3IENhY2hlT2JqZWN0QShP\nUklHX05BTUUsIE9SSUdfQUdFKTsKICAgICAgICAgICAgYXBhcmVudCA9IG5l\ndyBDYWNoZU9iamVjdEEoT1JJR19QQVJFTlRfTkFNRSwgT1JJR19QQVJFTlRf\nQUdFKTsKICAgICAgICAgICAgYS5zZXRSZWxhdGVkT2JqZWN0KGFwYXJlbnQp\nOwogICAgICAgICAgICBMaW5rZWRMaXN0IGNoaWxkcmVuID0gbmV3IExpbmtl\nZExpc3QoKTsKICAgICAgICAgICAgY2hpbGRyZW4uYWRkKGEpOwogICAgICAg\nICAgICBhcGFyZW50LnNldFJlbGF0ZWRDb2xsZWN0aW9uKGNoaWxkcmVuKTsK\nCiAgICAgICAgICAgIHN0YXJ0VHgoZW0pOwogICAgICAgICAgICBlbS5wZXJz\naXN0KGEpOwogICAgICAgICAgICBlbS5wZXJzaXN0KGFwYXJlbnQpOwogICAg\nICAgICAgICBvaWQgPSBlbS5nZXRPYmplY3RJZChhKTsKICAgICAgICAgICAg\nb2lkd2l0aGNsYXNzID0gbmV3IElkKENhY2hlT2JqZWN0QS5jbGFzcywgb2lk\nLnRvU3RyaW5nKCkpOwogICAgICAgICAgICBwYXJlbnRPaWQgPSBlbS5nZXRP\nYmplY3RJZChhcGFyZW50KTsKICAgICAgICAgICAgZW5kVHgoZW0pOwogICAg\nICAgIH0KICAgICAgICBmaW5hbGx5IHsKICAgICAgICAgICAgZW5kRW0oZW0p\nOwogICAgICAgIH0KCiAgICAgICAgLy8gbG9hZCBhbiBvYmplY3QgaW4gYSBz\nZXBhcmF0ZSBwbSBiZWZvcmUgdGhlIHVwZGF0ZQogICAgICAgIC8vIGhhcHBl\nbnMuIFRoaXMgc2hvdWxkIG5vdCBjaGFuZ2UsIGVsc2Ugd2UncmUgaW4KICAg\nICAgICAvLyB2aW9sYXRpb24gb2YgdGhlIHNwZWMuCiAgICAgICAgdGhpcy5l\nbSA9IGZhY3RvcnkuY3JlYXRlRW50aXR5TWFuYWdlcigpOwogICAgICAgIHN0\nYXJ0VHgodGhpcy5lbSk7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgLy8g\nT3BlbkpQQUVudGl0eU1hbmFnZXIgb3BlbkVtPShPcGVuSlBBRW50aXR5TWFu\nYWdlcikgdGhpcy5lbTsKICAgICAgICAgICAgdGhpcy5hID0gKENhY2hlT2Jq\nZWN0QSkgdGhpcy5lbS5maW5kKENhY2hlT2JqZWN0QS5jbGFzcywgb2lkKTsK\nCiAgICAgICAgICAgIC8vIGxvYWQgdGhlIHBhcmVudCBmb3IgdGVzdENvbGxl\nY3Rpb25zKCkuCiAgICAgICAgICAgIENhY2hlT2JqZWN0QSByZWwgPSB0aGlz\nLmEuZ2V0UmVsYXRlZE9iamVjdCgpOwogICAgICAgICAgICByZWwuZ2V0UmVs\nYXRlZENvbGxlY3Rpb24oKTsKICAgICAgICB9CiAgICAgICAgY2F0Y2ggKEV4\nY2VwdGlvbiBlKSB7CiAgICAgICAgICAgIGUucHJpbnRTdGFja1RyYWNlKCk7\nCiAgICAgICAgfQogICAgICAgIGZpbmFsbHkgewogICAgICAgICAgICBlbmRU\neCh0aGlzLmVtKTsKICAgICAgICAgICAgLy8gZW5kRW0odGhpcy5lbSk7CiAg\nICAgICAgfQoKICAgICAgICBlbSA9IGZhY3RvcnkuY3JlYXRlRW50aXR5TWFu\nYWdlcigpOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIHN0YXJ0VHgoZW0p\nOwogICAgICAgICAgICBhID0gKENhY2hlT2JqZWN0QSkgZW0uZmluZChDYWNo\nZU9iamVjdEEuY2xhc3MsIG9pZCk7CiAgICAgICAgICAgIGEuc2V0TmFtZShO\nRVdfTkFNRSk7CgogICAgICAgICAgICBhcGFyZW50ID0gKENhY2hlT2JqZWN0\nQSkgZW0uZmluZChDYWNoZU9iamVjdEEuY2xhc3MsIHBhcmVudE9pZCk7Cgog\nICAgICAgICAgICBDYWNoZU9iamVjdEEgYTIgPSBuZXcgQ2FjaGVPYmplY3RB\nKE9SSUdfTkFNRSwgT1JJR19BR0UpOwogICAgICAgICAgICBhMi5zZXRSZWxh\ndGVkT2JqZWN0KGFwYXJlbnQpOwogICAgICAgICAgICBhcGFyZW50LmdldFJl\nbGF0ZWRDb2xsZWN0aW9uKCkuYWRkKGEyKTsKICAgICAgICAgICAgZW0ucGVy\nc2lzdChhMik7CiAgICAgICAgICAgIGVuZFR4KGVtKTsKCiAgICAgICAgICAg\nIGFzc2VydE5ldyhhKTsKICAgICAgICB9CiAgICAgICAgZmluYWxseSB7CiAg\nICAgICAgICAgIGVuZEVtKGVtKTsKICAgICAgICB9CiAgICB9CgogICAgcHVi\nbGljIHZvaWQgdGVhckRvd24oKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAg\nICBlbmRFbShlbSk7CgogICAgICAgIHRyeSB7CiAgICAgICAgICAgIGZhY3Rv\ncnkuY2xvc2UoKTsKICAgICAgICB9CiAgICAgICAgY2F0Y2ggKEV4Y2VwdGlv\nbiBlKSB7CiAgICAgICAgfQogICAgICAgIHRyeSB7CiAgICAgICAgICAgIGZh\nY3RvcnkyLmNsb3NlKCk7CiAgICAgICAgfQogICAgICAgIGNhdGNoIChFeGNl\ncHRpb24gZSkgewogICAgICAgIH0KICAgICAgICBzdXBlci50ZWFyRG93bigp\nOwoKICAgICAgICBmYWN0b3J5ID0gbnVsbDsKICAgICAgICBmYWN0b3J5MiA9\nIG51bGw7CiAgICAgICAgdGltZW91dEZhY3RvcnkgPSBudWxsOwogICAgICAg\nIG9pZCA9IG51bGw7CiAgICAgICAgcGFyZW50T2lkID0gbnVsbDsKICAgICAg\nICBlbSA9IG51bGw7CiAgICAgICAgYSA9IG51bGw7CiAgICB9CgogICAgcHVi\nbGljIHZvaWQgdGVzdERlbGV0ZWRPbmVUb09uZVJlbGF0aW9ucygpIHRocm93\ncyBFeGNlcHRpb24gewogICAgICAgIEVudGl0eU1hbmFnZXIgZW0gPSBmYWN0\nb3J5LmNyZWF0ZUVudGl0eU1hbmFnZXIoKTsKICAgICAgICB0cnkgewogICAg\nICAgICAgICBzdGFydFR4KGVtKTsKICAgICAgICAgICAgQ2FjaGVPYmplY3RB\nIGEgPSAoQ2FjaGVPYmplY3RBKSBlbS5maW5kKENhY2hlT2JqZWN0QS5jbGFz\ncywgb2lkKTsKICAgICAgICAgICAgYXNzZXJ0Tm90TnVsbChhLmdldFJlbGF0\nZWRPYmplY3QoKSk7CiAgICAgICAgICAgIGVtLnJlbW92ZShhLmdldFJlbGF0\nZWRPYmplY3QoKSk7CiAgICAgICAgICAgIGVuZFR4KGVtKTsKICAgICAgICB9\nCiAgICAgICAgZmluYWxseSB7CiAgICAgICAgICAgIGVuZEVtKGVtKTsKICAg\nICAgICB9CgogICAgICAgIEVudGl0eU1hbmFnZXIgZW0yID0gZmFjdG9yeS5j\ncmVhdGVFbnRpdHlNYW5hZ2VyKCk7CiAgICAgICAgdHJ5IHsKICAgICAgICAg\nICAgQ2FjaGVPYmplY3RBIGEyID0gKENhY2hlT2JqZWN0QSkgZW0yLmZpbmQo\nQ2FjaGVPYmplY3RBLmNsYXNzLCBvaWQpOwogICAgICAgICAgICBhc3NlcnRO\ndWxsKGEyLmdldFJlbGF0ZWRPYmplY3QoKSk7CiAgICAgICAgfQogICAgICAg\nIGZpbmFsbHkgewogICAgICAgICAgICBlbmRFbShlbTIpOwogICAgICAgIH0K\nICAgIH0KCiAgICBwdWJsaWMgdm9pZCB0ZXN0Q2FuQ2FjaGVFeHRlbnNpb24o\nKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBEYXRhQ2FjaGUgY2FjaGUg\nPSBjYWNoZU1hbmFnZXIoZmFjdG9yeSkuZ2V0U3lzdGVtRGF0YUNhY2hlKCk7\nCgogICAgICAgIC8vIGZpcnN0LCB0ZXN0IGNhY2hpbmcgb2YgbmV3bHkgY3Jl\nYXRlZCBvYmplY3RzLgogICAgICAgIE9wZW5KUEFFbnRpdHlNYW5hZ2VyIGVt\nID0gKE9wZW5KUEFFbnRpdHlNYW5hZ2VyKSBmYWN0b3J5CiAgICAgICAgICAg\nIC5jcmVhdGVFbnRpdHlNYW5hZ2VyKCk7CiAgICAgICAgT2JqZWN0IG87CiAg\nICAgICAgT2JqZWN0IG9pZDsKICAgICAgICB0cnkgewogICAgICAgICAgICBz\ndGFydFR4KGVtKTsKICAgICAgICAgICAgbyA9IG5ldyBDYWNoZU9iamVjdEIo\nImZvbyIpOwogICAgICAgICAgICBlbS5wZXJzaXN0KG8pOwogICAgICAgICAg\nICBlbmRUeChlbSk7CiAgICAgICAgICAgIG9pZCA9IGVtLmdldE9iamVjdElk\nKG8pOwogICAgICAgICAgICBhc3NlcnROb3ROdWxsKG9pZCk7CiAgICAgICAg\nICAgIGFzc2VydE51bGwoY2FjaGUuZ2V0KG9pZCkpOwogICAgICAgIH0KICAg\nICAgICBmaW5hbGx5IHsKICAgICAgICAgICAgZW5kRW0oZW0pOwogICAgICAg\nIH0KCiAgICAgICAgLy8gbm93LCB0ZXN0IGNhY2hpbmcgb2YgZGF0YSBsb2Fk\nZWQgZnJvbSB0aGUgZGF0YSBzdG9yZS4KICAgICAgICBlbSA9IGZhY3Rvcnku\nY3JlYXRlRW50aXR5TWFuYWdlcigpOwogICAgICAgIHRyeSB7CiAgICAgICAg\nICAgIG8gPSBlbS5maW5kKENhY2hlT2JqZWN0Qi5jbGFzcywgb2lkKTsKICAg\nICAgICAgICAgYXNzZXJ0Tm90TnVsbChvKTsKICAgICAgICAgICAgYXNzZXJ0\nTnVsbChjYWNoZS5nZXQob2lkKSk7CiAgICAgICAgfQogICAgICAgIGZpbmFs\nbHkgewogICAgICAgICAgICBlbmRFbShlbSk7CiAgICAgICAgfQogICAgfQoK\nICAgIHB1YmxpYyB2b2lkIHRlc3RHZXRDYWNoZSgpIHsKICAgICAgICAvLyBm\naXJzdCwgdGVzdCBjYWNoaW5nIG9mIG5ld2x5IGNyZWF0ZWQgb2JqZWN0cy4K\nICAgICAgICBEYXRhQ2FjaGUgZGVmYXVsdENhY2hlID0gY2FjaGVNYW5hZ2Vy\nKGZhY3RvcnkpLmdldERhdGFDYWNoZSgKICAgICAgICAgICAgRGF0YUNhY2hl\nLk5BTUVfREVGQVVMVCwgZmFsc2UpOwogICAgICAgIGFzc2VydE5vdE51bGwo\nZGVmYXVsdENhY2hlKTsKCiAgICAgICAgRGF0YUNhY2hlIGNhY2hlID0gY2Fj\naGVNYW5hZ2VyKGZhY3RvcnkpLmdldFN5c3RlbURhdGFDYWNoZSgpOwogICAg\nICAgIGFzc2VydEVxdWFscyhkZWZhdWx0Q2FjaGUsIGNhY2hlKTsKCiAgICAg\nICAgQ2xhc3NNZXRhRGF0YSBhTWV0YSA9IHJlcG9zLmdldE1ldGFEYXRhKENh\nY2hlT2JqZWN0QS5jbGFzcywgbnVsbCwgdHJ1ZSk7CiAgICAgICAgQ2xhc3NN\nZXRhRGF0YSBhQ2hpbGQxTWV0YSA9IHJlcG9zLmdldE1ldGFEYXRhKENhY2hl\nT2JqZWN0QUNoaWxkMS5jbGFzcywKICAgICAgICAgICAgbnVsbCwgdHJ1ZSk7\nCiAgICAgICAgQ2xhc3NNZXRhRGF0YSBhQ2hpbGQyTWV0YSA9IHJlcG9zLmdl\ndE1ldGFEYXRhKENhY2hlT2JqZWN0QUNoaWxkMi5jbGFzcywKICAgICAgICAg\nICAgbnVsbCwgdHJ1ZSk7CiAgICAgICAgQ2xhc3NNZXRhRGF0YSBiTWV0YSA9\nIHJlcG9zLmdldE1ldGFEYXRhKENhY2hlT2JqZWN0Qi5jbGFzcywgbnVsbCwg\ndHJ1ZSk7CiAgICAgICAgQ2xhc3NNZXRhRGF0YSBiQ2hpbGQxTWV0YSA9IHJl\ncG9zLmdldE1ldGFEYXRhKENhY2hlT2JqZWN0QkNoaWxkMS5jbGFzcywKICAg\nICAgICAgICAgbnVsbCwgdHJ1ZSk7CiAgICAgICAgQ2xhc3NNZXRhRGF0YSBj\nTWV0YSA9IHJlcG9zLmdldE1ldGFEYXRhKENhY2hlT2JqZWN0Qy5jbGFzcywg\nbnVsbCwgdHJ1ZSk7CiAgICAgICAgQ2xhc3NNZXRhRGF0YSBkTWV0YSA9IHJl\ncG9zLmdldE1ldGFEYXRhKENhY2hlT2JqZWN0RC5jbGFzcywgbnVsbCwgdHJ1\nZSk7CiAgICAgICAgQ2xhc3NNZXRhRGF0YSBlTWV0YSA9IHJlcG9zLmdldE1l\ndGFEYXRhKENhY2hlT2JqZWN0RS5jbGFzcywgbnVsbCwgdHJ1ZSk7CgogICAg\nICAgIGNhY2hlID0gYU1ldGEuZ2V0RGF0YUNhY2hlKCk7CiAgICAgICAgYXNz\nZXJ0RXF1YWxzKGRlZmF1bHRDYWNoZSwgY2FjaGUpOwogICAgICAgIFN5c3Rl\nbS5vdXQucHJpbnRsbigiKioqKioqRGF0YUNhY2hlTmFtZToiCiAgICAgICAg\nICAgICsgYUNoaWxkMk1ldGEuZ2V0RGF0YUNhY2hlTmFtZSgpKTsKICAgICAg\nICBhc3NlcnROdWxsKGFDaGlsZDJNZXRhLmdldERhdGFDYWNoZSgpKTsKCiAg\nICAgICAgYXNzZXJ0TnVsbChiTWV0YS5nZXREYXRhQ2FjaGUoKSk7CgogICAg\nICAgIGFzc2VydEVxdWFscyhjTWV0YS5nZXREYXRhQ2FjaGUoKSwgZE1ldGEu\nZ2V0RGF0YUNhY2hlKCkpOwogICAgICAgIGlmIChkTWV0YS5nZXREYXRhQ2Fj\naGUoKSBpbnN0YW5jZW9mIENvbmN1cnJlbnREYXRhQ2FjaGUpIHsKICAgICAg\nICAgICAgQ29uY3VycmVudERhdGFDYWNoZSBkQ2FjaGVJbXBsID0KICAgICAg\nICAgICAgICAgIChDb25jdXJyZW50RGF0YUNhY2hlKSBkTWV0YS5nZXREYXRh\nQ2FjaGUoKTsKICAgICAgICAgICAgYXNzZXJ0RXF1YWxzKDEwLCBkQ2FjaGVJ\nbXBsLmdldENhY2hlU2l6ZSgpKTsKICAgICAgICB9CiAgICAgICAgYXNzZXJ0\nRXF1YWxzKGFNZXRhLmdldERhdGFDYWNoZSgpLCBlTWV0YS5nZXREYXRhQ2Fj\naGUoKSk7CiAgICB9CgogICAgcHVibGljIHZvaWQgdGVzdFByaW1pdGl2ZXMo\nKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICAvLyBtYWtlIHN1cmUgdGhh\ndCB0aGUgJ2EnIHRoYXQgd2FzIGZvdW5kIGJlZm9yZSBjaGFuZ2VzCiAgICAg\nICAgLy8gd2VyZSBtYWRlIGlzIHN0aWxsIHZhbGlkLgogICAgICAgIGFzc2Vy\ndE9sZChhKTsKICAgICAgICBlbS5yZWZyZXNoKGEpOwogICAgICAgIGFzc2Vy\ndE5ldyhhKTsKICAgIH0KCiAgICAvLyBGSVhNRSBTZWV0aGEgU2VwIDI1LDIw\nMDYKICAgIC8qCiAgICAgICogcHVibGljIHZvaWQgdGVzdENvbGxlY3Rpb25z\nKCkgdGhyb3dzIEV4Y2VwdGlvbiB7IENhY2hlT2JqZWN0QSBwYXJlbnQgPQog\nICAgICAqIChDYWNoZU9iamVjdEEpIGVtLmZpbmQoQ2FjaGVPYmplY3RBLmNs\nYXNzLE9SSUdfUEFSRU5UX05BTUUpOwogICAgICAqIGFzc2VydEVxdWFscygx\nLCBwYXJlbnQuZ2V0UmVsYXRlZENvbGxlY3Rpb24oKS5zaXplKCkpOwogICAg\nICAqIGVtLnJlZnJlc2gocGFyZW50KTsgYXNzZXJ0RXF1YWxzKDIsCiAgICAg\nICogcGFyZW50LmdldFJlbGF0ZWRDb2xsZWN0aW9uKCkuc2l6ZSgpKTsgfQog\nICAgICAqLwoKICAgIC8vIEZJWE1FIFNlZXRoYSBTZXAgMjUsMjAwNgogICAg\nLyoKICAgICAgKiBwdWJsaWMgdm9pZCB0ZXN0RXhwaXJlZENvbGxlY3Rpb25z\nKCkgeyBDYWNoZU9iamVjdEEgcGFyZW50ID0KICAgICAgKiAoQ2FjaGVPYmpl\nY3RBKSBlbS5maW5kKENhY2hlT2JqZWN0QS5jbGFzcyxPUklHX1BBUkVOVF9O\nQU1FKTsKICAgICAgKiBlbS5yZWZyZXNoKHBhcmVudCk7IENvbGxlY3Rpb24g\ncmVsYXRlZE9pZHMgPSBuZXcgSGFzaFNldCgpOyBmb3IgKEl0ZXJhdG9yCiAg\nICAgICogaXRlciA9IHBhcmVudC5nZXRSZWxhdGVkQ29sbGVjdGlvbigpLml0\nZXJhdG9yKCk7IGl0ZXIuaGFzTmV4dCgpOykgewogICAgICAqIHJlbGF0ZWRP\naWRzLmFkZChKRE9IZWxwZXIuZ2V0T2JqZWN0SWQoaXRlci5uZXh0KCkpKTsg\nfQogICAgICAqCiAgICAgICogQ2xhc3NNZXRhRGF0YSBtZXRhID0gcmVwb3Mu\nZ2V0TWV0YURhdGEoQ2FjaGVPYmplY3RBLmNsYXNzLCBudWxsLCB0cnVlKTsK\nICAgICAgKiBEYXRhQ2FjaGUgY2FjaGUgPSBtZXRhLmdldERhdGFDYWNoZSgp\nOwogICAgICAqICAvLyBkcm9wIHRoZSByZWxhdGVkIGRhdGEgZnJvbSB0aGUg\nY2FjaGUgZm9yIChJdGVyYXRvciBpdGVyID0KICAgICAgKiByZWxhdGVkT2lk\ncy5pdGVyYXRvcigpOyBpdGVyLmhhc05leHQoKTspIGNhY2hlLnJlbW92ZShp\ndGVyLm5leHQoKSk7CiAgICAgICoKICAgICAgKiBQZXJzaXN0ZW5jZU1hbmFn\nZXIgcG0yID0gZmFjdG9yeS5nZXRQZXJzaXN0ZW5jZU1hbmFnZXIoKTsgdHJ5\nIHsKICAgICAgKiBhc3NlcnRUcnVlKGNhY2hlLmNvbnRhaW5zKHBhcmVudE9p\nZCkpOyBwYXJlbnQgPSAoQ2FjaGVPYmplY3RBKQogICAgICAqIHBtMi5nZXRP\nYmplY3RCeUlkKHBhcmVudE9pZCwgdHJ1ZSk7CiAgICAgICoKICAgICAgKiB0\ncnkgeyBmb3IgKEl0ZXJhdG9yIGl0ZXIgPSByZWxhdGVkT2lkcy5pdGVyYXRv\ncigpOyBpdGVyLmhhc05leHQoKTspCiAgICAgICogYXNzZXJ0RmFsc2UoY2Fj\naGUuY29udGFpbnMoaXRlci5uZXh0KCkpKTsgfSBjYXRjaCAoQXNzZXJ0aW9u\nRmFpbGVkRXJyb3IKICAgICAgKiBlKSB7IGJ1Zyg0NjcsICJkYXRhIGNhY2hl\nIGNhbiBvdmVyLWVhZ2VybHkgbG9hZCByZWxhdGlvbiBkYXRhIik7IH0gfQog\nICAgICAqIGZpbmFsbHkgeyBjbG9zZShwbTIpOyB9IH0KICAgICAgKi8KCiAg\nICBwdWJsaWMgdm9pZCB0ZXN0RXhwaXJlZFJlbGF0aW9ucygpIHsKICAgICAg\nICBDYWNoZU9iamVjdEEgYSA9IChDYWNoZU9iamVjdEEpIGVtLmZpbmQoQ2Fj\naGVPYmplY3RBLmNsYXNzLCBvaWQpOwogICAgICAgIGVtLnJlZnJlc2goYSk7\nCiAgICAgICAgT2JqZWN0IHJlbGF0aW9uT2lkID0gZW0uZ2V0T2JqZWN0SWQo\nYS5nZXRSZWxhdGVkT2JqZWN0KCkpOwogICAgICAgIHJlbGF0aW9uT2lkID0g\nbmV3IElkKENhY2hlT2JqZWN0QS5jbGFzcywgcmVsYXRpb25PaWQudG9TdHJp\nbmcoKSk7CgogICAgICAgIENsYXNzTWV0YURhdGEgbWV0YSA9IHJlcG9zLmdl\ndE1ldGFEYXRhKENhY2hlT2JqZWN0QS5jbGFzcywgbnVsbCwgdHJ1ZSk7CiAg\nICAgICAgRGF0YUNhY2hlIGNhY2hlID0gbWV0YS5nZXREYXRhQ2FjaGUoKTsK\nCiAgICAgICAgLy8gZHJvcCB0aGUgcmVsYXRlZCBkYXRhIGZyb20gdGhlIGNh\nY2hlCiAgICAgICAgY2FjaGUucmVtb3ZlKHJlbGF0aW9uT2lkKTsKCiAgICAg\nICAgT3BlbkpQQUVudGl0eU1hbmFnZXIgZW0yID0gKE9wZW5KUEFFbnRpdHlN\nYW5hZ2VyKSBmYWN0b3J5CiAgICAgICAgICAgIC5jcmVhdGVFbnRpdHlNYW5h\nZ2VyKCk7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgYXNzZXJ0VHJ1ZShj\nYWNoZS5jb250YWlucyhvaWR3aXRoY2xhc3MpKTsKICAgICAgICAgICAgYSA9\nIChDYWNoZU9iamVjdEEpIGVtMi5maW5kKENhY2hlT2JqZWN0QS5jbGFzcywg\nb2lkKTsKCiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBhc3Nl\ncnRGYWxzZShjYWNoZS5jb250YWlucyhyZWxhdGlvbk9pZCkpOwogICAgICAg\nICAgICB9CiAgICAgICAgICAgIGNhdGNoIChBc3NlcnRpb25GYWlsZWRFcnJv\nciBlKSB7CiAgICAgICAgICAgICAgICAvLyBidWcoNDY3LCAiZGF0YSBjYWNo\nZSBjYW4gb3Zlci1lYWdlcmx5IGxvYWQgcmVsYXRpb24gZGF0YSIpOwogICAg\nICAgICAgICAgICAgZS5wcmludFN0YWNrVHJhY2UoKTsKICAgICAgICAgICAg\nfQogICAgICAgIH0KICAgICAgICBmaW5hbGx5IHsKICAgICAgICAgICAgZW5k\nRW0oZW0yKTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGljIHZvaWQgdGVz\ndFBDQXJyYXlzKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgT3BlbkpQ\nQUVudGl0eU1hbmFnZXIgbmV3RW0gPSAoT3BlbkpQQUVudGl0eU1hbmFnZXIp\nIGZhY3RvcnkKICAgICAgICAgICAgLmNyZWF0ZUVudGl0eU1hbmFnZXIoKTsK\nICAgICAgICB0cnkgewogICAgICAgICAgICBzdGFydFR4KG5ld0VtKTsKICAg\nICAgICAgICAgQ2FjaGVPYmplY3RBIHBhcmVudCA9IChDYWNoZU9iamVjdEEp\nIG5ld0VtLmZpbmQoQ2FjaGVPYmplY3RBLmNsYXNzLAogICAgICAgICAgICAg\nICAgcGFyZW50T2lkKTsKICAgICAgICAgICAgQ2FjaGVPYmplY3RBIGEgPSAo\nQ2FjaGVPYmplY3RBKSBuZXdFbS5maW5kKENhY2hlT2JqZWN0QS5jbGFzcywg\nb2lkKTsKICAgICAgICAgICAgYS5zZXRSZWxhdGVkQXJyYXkobmV3IENhY2hl\nT2JqZWN0QVtdeyBwYXJlbnQsIGEgfSk7CiAgICAgICAgICAgIGVuZFR4KG5l\nd0VtKTsKICAgICAgICB9CiAgICAgICAgZmluYWxseSB7CiAgICAgICAgICAg\nIGVuZEVtKG5ld0VtKTsKICAgICAgICB9CgogICAgICAgIG5ld0VtID0gKE9w\nZW5KUEFFbnRpdHlNYW5hZ2VyKSBmYWN0b3J5LmNyZWF0ZUVudGl0eU1hbmFn\nZXIoKTsKICAgICAgICB0cnkgewogICAgICAgICAgICBhID0gKENhY2hlT2Jq\nZWN0QSkgbmV3RW0uZmluZChDYWNoZU9iamVjdEEuY2xhc3MsIG9pZCk7CiAg\nICAgICAgICAgIENhY2hlT2JqZWN0QVtdIGFycmF5ID0gYS5nZXRSZWxhdGVk\nQXJyYXkoKTsKICAgICAgICAgICAgYXNzZXJ0RXF1YWxzKDIsIGFycmF5Lmxl\nbmd0aCk7CiAgICAgICAgICAgIGFzc2VydFRydWUoYXJyYXlbMF0gaW5zdGFu\nY2VvZiBDYWNoZU9iamVjdEEpOwogICAgICAgICAgICBhc3NlcnRUcnVlKGFy\ncmF5WzFdIGluc3RhbmNlb2YgQ2FjaGVPYmplY3RBKTsKCiAgICAgICAgICAg\nIE9iamVjdCBhcnJheU9pZCA9IG5ld0VtLmdldE9iamVjdElkKGFycmF5WzBd\nKTsKICAgICAgICAgICAgaWYgKCFhcnJheU9pZC5lcXVhbHMocGFyZW50T2lk\nKSAmJiAhYXJyYXlPaWQuZXF1YWxzKG9pZCkpIHsKICAgICAgICAgICAgICAg\nIGZhaWwoImFycmF5IGRvZXMgbm90IGNvbnRhaW4gY29ycmVjdCBvaWRzIik7\nCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGFycmF5T2lkID0gbmV3RW0u\nZ2V0T2JqZWN0SWQoYXJyYXlbMV0pOwogICAgICAgICAgICBpZiAoIWFycmF5\nT2lkLmVxdWFscyhwYXJlbnRPaWQpICYmICFhcnJheU9pZC5lcXVhbHMob2lk\nKSkgewogICAgICAgICAgICAgICAgZmFpbCgiYXJyYXkgZG9lcyBub3QgY29u\ndGFpbiBjb3JyZWN0IG9pZHMiKTsKICAgICAgICAgICAgfQogICAgICAgIH0K\nICAgICAgICBmaW5hbGx5IHsKICAgICAgICAgICAgZW5kRW0obmV3RW0pOwog\nICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMgdm9pZCB0ZXN0U3RyaW5nQXJy\nYXlzKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgT3BlbkpQQUVudGl0\neU1hbmFnZXIgbmV3RW0gPSAoT3BlbkpQQUVudGl0eU1hbmFnZXIpIGZhY3Rv\ncnkKICAgICAgICAgICAgLmNyZWF0ZUVudGl0eU1hbmFnZXIoKTsKICAgICAg\nICB0cnkgewogICAgICAgICAgICBzdGFydFR4KG5ld0VtKTsKICAgICAgICAg\nICAgQ2FjaGVPYmplY3RBIGEgPSAoQ2FjaGVPYmplY3RBKSBuZXdFbS5maW5k\nKENhY2hlT2JqZWN0QS5jbGFzcywgb2lkKTsKICAgICAgICAgICAgYS5zZXRT\ndHJpbmdBcnJheShuZXcgU3RyaW5nW117ICJzdHJpbmcwIiwgInN0cmluZzEi\nLCAic3RyaW5nMiIgfSk7CiAgICAgICAgICAgIGVuZFR4KG5ld0VtKTsKICAg\nICAgICB9CiAgICAgICAgZmluYWxseSB7CiAgICAgICAgICAgIGVuZEVtKG5l\nd0VtKTsKICAgICAgICB9CgogICAgICAgIG5ld0VtID0gKE9wZW5KUEFFbnRp\ndHlNYW5hZ2VyKSBmYWN0b3J5LmNyZWF0ZUVudGl0eU1hbmFnZXIoKTsKICAg\nICAgICB0cnkgewogICAgICAgICAgICBhID0gKENhY2hlT2JqZWN0QSkgbmV3\nRW0uZmluZChDYWNoZU9iamVjdEEuY2xhc3MsIG9pZCk7CiAgICAgICAgICAg\nIFN0cmluZ1tdIGFycmF5ID0gYS5nZXRTdHJpbmdBcnJheSgpOwogICAgICAg\nICAgICBhc3NlcnRFcXVhbHMoMywgYXJyYXkubGVuZ3RoKTsKICAgICAgICAg\nICAgYXNzZXJ0RXF1YWxzKCJzdHJpbmcwIiwgYXJyYXlbMF0pOwogICAgICAg\nICAgICBhc3NlcnRFcXVhbHMoInN0cmluZzEiLCBhcnJheVsxXSk7CiAgICAg\nICAgICAgIGFzc2VydEVxdWFscygic3RyaW5nMiIsIGFycmF5WzJdKTsKICAg\nICAgICB9CiAgICAgICAgZmluYWxseSB7CiAgICAgICAgICAgIGVuZEVtKG5l\nd0VtKTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGljIHZvaWQgdGVzdFBy\naW1pdGl2ZUFycmF5cygpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIE9w\nZW5KUEFFbnRpdHlNYW5hZ2VyIG5ld0VtID0gKE9wZW5KUEFFbnRpdHlNYW5h\nZ2VyKSBmYWN0b3J5CiAgICAgICAgICAgIC5jcmVhdGVFbnRpdHlNYW5hZ2Vy\nKCk7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgc3RhcnRUeChuZXdFbSk7\nCiAgICAgICAgICAgIENhY2hlT2JqZWN0QSBhID0gKENhY2hlT2JqZWN0QSkg\nbmV3RW0uZmluZChDYWNoZU9iamVjdEEuY2xhc3MsIG9pZCk7CiAgICAgICAg\nICAgIGEuc2V0UHJpbWl0aXZlQXJyYXkobmV3IGZsb2F0W117IDAsIDEsIDIg\nfSk7CiAgICAgICAgICAgIGVuZFR4KG5ld0VtKTsKICAgICAgICB9CiAgICAg\nICAgZmluYWxseSB7CiAgICAgICAgICAgIGVuZEVtKG5ld0VtKTsKICAgICAg\nICB9CgogICAgICAgIG5ld0VtID0gKE9wZW5KUEFFbnRpdHlNYW5hZ2VyKSBm\nYWN0b3J5LmNyZWF0ZUVudGl0eU1hbmFnZXIoKTsKICAgICAgICB0cnkgewog\nICAgICAgICAgICBhID0gKENhY2hlT2JqZWN0QSkgbmV3RW0uZmluZChDYWNo\nZU9iamVjdEEuY2xhc3MsIG9pZCk7CiAgICAgICAgICAgIGZsb2F0W10gYXJy\nYXkgPSBhLmdldFByaW1pdGl2ZUFycmF5KCk7CiAgICAgICAgICAgIGFzc2Vy\ndEVxdWFscygzLCBhcnJheS5sZW5ndGgpOwogICAgICAgICAgICBhc3NlcnRF\ncXVhbHMoMC4wRiwgYXJyYXlbMF0sIDApOwogICAgICAgICAgICBhc3NlcnRF\ncXVhbHMoMS4wRiwgYXJyYXlbMV0sIDApOwogICAgICAgICAgICBhc3NlcnRF\ncXVhbHMoMi4wZiwgYXJyYXlbMl0sIDApOwogICAgICAgIH0KICAgICAgICBm\naW5hbGx5IHsKICAgICAgICAgICAgZW5kRW0obmV3RW0pOwogICAgICAgIH0K\nICAgIH0KCiAgICBwdWJsaWMgdm9pZCB0ZXN0RGF0ZUFycmF5cygpIHRocm93\ncyBFeGNlcHRpb24gewogICAgICAgIE9wZW5KUEFFbnRpdHlNYW5hZ2VyIG5l\nd0VtID0gKE9wZW5KUEFFbnRpdHlNYW5hZ2VyKSBmYWN0b3J5CiAgICAgICAg\nICAgIC5jcmVhdGVFbnRpdHlNYW5hZ2VyKCk7CiAgICAgICAgQ2FjaGVPYmpl\nY3RBIGE7CiAgICAgICAgRGF0ZVtdIGRhdGVBcnJheTsKICAgICAgICB0cnkg\newogICAgICAgICAgICBzdGFydFR4KG5ld0VtKTsKICAgICAgICAgICAgYSA9\nIChDYWNoZU9iamVjdEEpIG5ld0VtLmZpbmQoQ2FjaGVPYmplY3RBLmNsYXNz\nLCBvaWQpOwogICAgICAgICAgICBkYXRlQXJyYXkgPSBuZXcgRGF0ZVtdeyBu\nZXcgRGF0ZSgpLCBuZXcgRGF0ZSgpLCBuZXcgRGF0ZSgpIH07CiAgICAgICAg\nICAgIGEuc2V0RGF0ZUFycmF5KGRhdGVBcnJheSk7CiAgICAgICAgICAgIGVu\nZFR4KG5ld0VtKTsKICAgICAgICB9CiAgICAgICAgZmluYWxseSB7CiAgICAg\nICAgICAgIGVuZEVtKG5ld0VtKTsKICAgICAgICB9CgogICAgICAgIG5ld0Vt\nID0gKE9wZW5KUEFFbnRpdHlNYW5hZ2VyKSBmYWN0b3J5LmNyZWF0ZUVudGl0\neU1hbmFnZXIoKTsKICAgICAgICB0cnkgewogICAgICAgICAgICBhID0gKENh\nY2hlT2JqZWN0QSkgbmV3RW0uZmluZChDYWNoZU9iamVjdEEuY2xhc3MsIG9p\nZCk7CiAgICAgICAgICAgIERhdGVbXSBhcnJheSA9IGEuZ2V0RGF0ZUFycmF5\nKCk7CiAgICAgICAgICAgIGlmIChhcnJheVswXSA9PSBkYXRlQXJyYXlbMF0p\nIHsKICAgICAgICAgICAgICAgIGZhaWwoImRhdGUgb2JqZWN0cyBhcmUgdGhl\nIHNhbWUiKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBmaW5h\nbGx5IHsKICAgICAgICAgICAgZW5kRW0obmV3RW0pOwogICAgICAgIH0KICAg\nIH0KCiAgICBwdWJsaWMgdm9pZCB0ZXN0RGF0ZSgpIHRocm93cyBFeGNlcHRp\nb24gewogICAgICAgIE9wZW5KUEFFbnRpdHlNYW5hZ2VyIG5ld0VtID0gKE9w\nZW5KUEFFbnRpdHlNYW5hZ2VyKSBmYWN0b3J5CiAgICAgICAgICAgIC5jcmVh\ndGVFbnRpdHlNYW5hZ2VyKCk7CiAgICAgICAgQ2FjaGVPYmplY3RBIGE7CiAg\nICAgICAgRGF0ZSBkOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIHN0YXJ0\nVHgobmV3RW0pOwogICAgICAgICAgICBhID0gKENhY2hlT2JqZWN0QSkgbmV3\nRW0uZmluZChDYWNoZU9iamVjdEEuY2xhc3MsIG9pZCk7CiAgICAgICAgICAg\nIGQgPSBuZXcgRGF0ZSgpOwogICAgICAgICAgICBhLnNldERhdGUoZCk7CiAg\nICAgICAgICAgIGVuZFR4KG5ld0VtKTsKICAgICAgICB9CiAgICAgICAgZmlu\nYWxseSB7CiAgICAgICAgICAgIGVuZEVtKG5ld0VtKTsKICAgICAgICB9Cgog\nICAgICAgIC8vIHNsZWVwIGEgYml0IHNvIHdlIGNhbiBlbnN1cmUgdGhhdCB0\naGUgZGF0ZSBkb2Vzbid0IGp1c3QKICAgICAgICAvLyBoYXBwZW4gdG8gYmUg\ndGhlIHNhbWUuCiAgICAgICAgVGhyZWFkLnNsZWVwKDEwMCk7CgogICAgICAg\nIG5ld0VtID0gKE9wZW5KUEFFbnRpdHlNYW5hZ2VyKSBmYWN0b3J5LmNyZWF0\nZUVudGl0eU1hbmFnZXIoKTsKICAgICAgICB0cnkgewogICAgICAgICAgICBh\nID0gKENhY2hlT2JqZWN0QSkgbmV3RW0uZmluZChDYWNoZU9iamVjdEEuY2xh\nc3MsIG9pZCk7CiAgICAgICAgICAgIERhdGUgZDIgPSBhLmdldERhdGUoKTsK\nICAgICAgICAgICAgaWYgKGQgPT0gZDIpIHsKICAgICAgICAgICAgICAgIGZh\naWwoImRhdGUgb2JqZWN0cyBhcmUgdGhlIHNhbWUiKTsKICAgICAgICAgICAg\nfQoKICAgICAgICAgICAgYXNzZXJ0RXF1YWxzKGQuZ2V0VGltZSgpLCBkMi5n\nZXRUaW1lKCkpOwogICAgICAgIH0KICAgICAgICBmaW5hbGx5IHsKICAgICAg\nICAgICAgZW5kRW0obmV3RW0pOwogICAgICAgIH0KICAgIH0KCiAgICBwdWJs\naWMgdm9pZCB0ZXN0TG9jYWxlKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAg\nICAgT3BlbkpQQUVudGl0eU1hbmFnZXIgbmV3RW0gPSAoT3BlbkpQQUVudGl0\neU1hbmFnZXIpIGZhY3RvcnkKICAgICAgICAgICAgLmNyZWF0ZUVudGl0eU1h\nbmFnZXIoKTsKICAgICAgICBzdGFydFR4KG5ld0VtKTsKICAgICAgICBDYWNo\nZU9iamVjdEEgYSA9IChDYWNoZU9iamVjdEEpIG5ld0VtLmZpbmQoQ2FjaGVP\nYmplY3RBLmNsYXNzLCBvaWQpOwogICAgICAgIExvY2FsZSBsID0gTG9jYWxl\nLmdldERlZmF1bHQoKTsKICAgICAgICBhLnNldExvY2FsZShsKTsKICAgICAg\nICBlbmRUeChuZXdFbSk7CgogICAgICAgIE9wZW5KUEFFbnRpdHlNYW5hZ2Vy\nIG5ld0VtMiA9IChPcGVuSlBBRW50aXR5TWFuYWdlcikgZmFjdG9yeQogICAg\nICAgICAgICAuY3JlYXRlRW50aXR5TWFuYWdlcigpOwoKICAgICAgICBhID0g\nKENhY2hlT2JqZWN0QSkgbmV3RW0yLmZpbmQoQ2FjaGVPYmplY3RBLmNsYXNz\nLCBvaWQpOwogICAgICAgIExvY2FsZSBsMiA9IGEuZ2V0TG9jYWxlKCk7CiAg\nICAgICAgLy8gbG9jYWxlcyBhcmUgaW1tdXRhYmxlIGFuZCBmaW5hbCwgc28g\ndGhlIGRpZmZlcmVudCBjYWNoZWQKICAgICAgICAvLyBjb3BpZXMgc2hvdWxk\nIGJlID09LgogICAgICAgIGlmIChsICE9IGwyKSB7CiAgICAgICAgICAgIGZh\naWwoImxvY2FsZSBvYmplY3RzIGFyZSBub3QgdGhlIHNhbWUuIik7CiAgICAg\nICAgfQoKICAgICAgICBlbmRFbShuZXdFbSk7CiAgICAgICAgZW5kRW0obmV3\nRW0yKTsKICAgIH0KCiAgICAvLyAtLS0tLS0tLS0tIFRlc3QgcXVlcnkgY2Fj\naGluZyAtLS0tLS0tLS0tCiAgICAvLyAqIEZDT3MgYXMgcGFyYW1zCiAgICAv\nLyAqIG11bHRpLXRocmVhZGVkIHN0dWZmCiAgICAvLyAqIGFjY2VzcyBwYXRo\nIHN0dWZmIChzZWUgYWxzbyBUZXN0UXVlcnlBY2Nlc3NQYXRoKQogICAgLy8g\nKiBzZXJpYWxpemFiaWxpdHkgb2YgcmV0dXJuZWQgbGlzdHMKICAgIC8vICog\nUE0uc2V0UXVlcnlDYWNoZUVuYWJsZWQgKGZhbHNlKTsKICAgIC8vICogUXVl\ncnkuc2V0UXVlcnlDYWNoZUVuYWJsZWQgKGZhbHNlKTsKICAgIC8vICogUGVz\nc2ltaXN0aWMgdHJhbnNhY3Rpb25zCgogICAgcHVibGljIHZvaWQgdGVzdEJh\nc2ljUXVlcnkoKSB7CiAgICAgICAgYmFzaWNRdWVyaWVzKGZhY3RvcnkuY3Jl\nYXRlRW50aXR5TWFuYWdlcigpLCBCb29sZWFuLkZBTFNFLCAzLCAxKTsKICAg\nICAgICBiYXNpY1F1ZXJpZXMoZmFjdG9yeS5jcmVhdGVFbnRpdHlNYW5hZ2Vy\nKCksIEJvb2xlYW4uVFJVRSwgMywgMSk7CgogICAgICAgIC8vIG1hbnVhbGx5\nIG5vdGlmeSB0aGUgY2FjaGUgb2YgY2hhbmdlcwogICAgICAgIFF1ZXJ5Q2Fj\naGUgY2FjaGUgPSBjYWNoZU1hbmFnZXIoZmFjdG9yeSkuZ2V0U3lzdGVtUXVl\ncnlDYWNoZSgpOwoKICAgICAgICAvLyB0ZXN0IHRvIHNlZSBpZiBtb2RpZnlp\nbmcgQiBjYXVzZXMgQSdzIHF1ZXJ5IGNhY2hlIHRvIGJlIGZsdXNoZWQKICAg\nICAgICBTZXQgcyA9IG5ldyBIYXNoU2V0KCk7CiAgICAgICAgcy5hZGQoQ2Fj\naGVPYmplY3RCLmNsYXNzKTsKICAgICAgICBjYWNoZS5vblR5cGVzQ2hhbmdl\nZChuZXcgVHlwZXNDaGFuZ2VkRXZlbnQodGhpcywgcykpOwogICAgICAgIGJh\nc2ljUXVlcmllcyhmYWN0b3J5LmNyZWF0ZUVudGl0eU1hbmFnZXIoKSwgQm9v\nbGVhbi5UUlVFLCAzLCAxKTsKCiAgICAgICAgLy8gdGVzdCB0byBzZWUgaWYg\nbW9kaWZ5aW5nIEEgY2F1c2VzIEEncyBxdWVyeSBjYWNoZSB0byBiZSBmbHVz\naGVkCiAgICAgICAgcy5hZGQoQ2FjaGVPYmplY3RBLmNsYXNzKTsKICAgICAg\nICBjYWNoZS5vblR5cGVzQ2hhbmdlZChuZXcgVHlwZXNDaGFuZ2VkRXZlbnQo\ndGhpcywgcykpOwogICAgICAgIGJhc2ljUXVlcmllcyhmYWN0b3J5LmNyZWF0\nZUVudGl0eU1hbmFnZXIoKSwgQm9vbGVhbi5GQUxTRSwgMywgMSk7CgogICAg\nICAgIC8vIG1ha2Ugc3VyZSB0aGF0IG5vbi1tYW51YWwgbm90aWZpY2F0aW9u\nIHdvcmtzCiAgICAgICAgRW50aXR5TWFuYWdlciBlbSA9IGZhY3RvcnkuY3Jl\nYXRlRW50aXR5TWFuYWdlcigpOwogICAgICAgIHRyeSB7CiAgICAgICAgICAg\nIHN0YXJ0VHgoZW0pOwogICAgICAgICAgICBDYWNoZU9iamVjdEEgYSA9IG5l\ndyBDYWNoZU9iamVjdEEoT1JJR19OQU1FLCBPUklHX0FHRSk7CiAgICAgICAg\nICAgIGVtLnBlcnNpc3QoYSk7CiAgICAgICAgICAgIGVuZFR4KGVtKTsKICAg\nICAgICB9CiAgICAgICAgZmluYWxseSB7CiAgICAgICAgICAgIGVuZEVtKGVt\nKTsKICAgICAgICB9CgogICAgICAgIGJhc2ljUXVlcmllcyhmYWN0b3J5LmNy\nZWF0ZUVudGl0eU1hbmFnZXIoKSwgQm9vbGVhbi5GQUxTRSwgNCwgMik7CiAg\nICB9CgogICAgcHJvdGVjdGVkIHZvaWQgYmFzaWNRdWVyaWVzKEVudGl0eU1h\nbmFnZXIgZW0sIEJvb2xlYW4gaW5DYWNoZSwgaW50IGFsbFNpemUsCiAgICAg\nICAgaW50IG9yaWdTaXplKSB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAg\nbG9uZyBzdGFydDsKICAgICAgICAgICAgbG9uZyBxMXAxOwogICAgICAgICAg\nICBsb25nIHExcDI7CiAgICAgICAgICAgIGxvbmcgcTJwMTsKICAgICAgICAg\nICAgbG9uZyBxMnAyOwoKICAgICAgICAgICAgQnJva2VyIGJyb2tlciA9IEpQ\nQUZhY2FkZUhlbHBlci50b0Jyb2tlcihlbSk7CiAgICAgICAgICAgIG9yZy5h\ncGFjaGUub3BlbmpwYS5rZXJuZWwuUXVlcnkgcSA9IGJyb2tlci5uZXdRdWVy\neSgKICAgICAgICAgICAgICAgIEpQUUxQYXJzZXIuTEFOR19KUFFMLCAiU2Vs\nZWN0IGEgRlJPTSAiCiAgICAgICAgICAgICAgICArIENhY2hlT2JqZWN0QS5j\nbGFzcy5nZXRTaW1wbGVOYW1lKCkgKyAiIGEiKTsKICAgICAgICAgICAgcS5z\nZXRDYW5kaWRhdGVFeHRlbnQoYnJva2VyLm5ld0V4dGVudChDYWNoZU9iamVj\ndEEuY2xhc3MsIGZhbHNlKSk7CiAgICAgICAgICAgIHN0YXJ0ID0gU3lzdGVt\nLmN1cnJlbnRUaW1lTWlsbGlzKCk7CiAgICAgICAgICAgIGFzc2VydEluQ2Fj\naGUocSwgaW5DYWNoZSk7CiAgICAgICAgICAgIExpc3QgbCA9IChMaXN0KSBx\nLmV4ZWN1dGUoKTsKICAgICAgICAgICAgaXRlcmF0ZShsKTsKICAgICAgICAg\nICAgcTFwMSA9IFN5c3RlbS5jdXJyZW50VGltZU1pbGxpcygpIC0gc3RhcnQ7\nCgogICAgICAgICAgICBhc3NlcnRFcXVhbHMoYWxsU2l6ZSwgbC5zaXplKCkp\nOwoKICAgICAgICAgICAgc3RhcnQgPSBTeXN0ZW0uY3VycmVudFRpbWVNaWxs\naXMoKTsKICAgICAgICAgICAgTGlzdCBsMiA9IChMaXN0KSBxLmV4ZWN1dGUo\nKTsKICAgICAgICAgICAgaXRlcmF0ZShsMik7CiAgICAgICAgICAgIHExcDIg\nPSBTeXN0ZW0uY3VycmVudFRpbWVNaWxsaXMoKSAtIHN0YXJ0OwogICAgICAg\nICAgICBhc3NlcnRFcXVhbHMoYWxsU2l6ZSwgbDIuc2l6ZSgpKTsKCiAgICAg\nICAgICAgIHEgPSBicm9rZXIubmV3UXVlcnkoSlBRTFBhcnNlci5MQU5HX0pQ\nUUwsCiAgICAgICAgICAgICAgICAic2VsZWN0IGEubmFtZSxhLmFnZSBmcm9t\nICIKICAgICAgICAgICAgICAgICAgICArIENhY2hlT2JqZWN0QS5jbGFzcy5n\nZXRTaW1wbGVOYW1lKCkKICAgICAgICAgICAgICAgICAgICArICIgYSB3aGVy\nZSBhLm5hbWUgPSA6biBBTkQgYS5hZ2UgPSA6YSIpOwogICAgICAgICAgICBx\nLnNldENhbmRpZGF0ZUV4dGVudChicm9rZXIubmV3RXh0ZW50KENhY2hlT2Jq\nZWN0QS5jbGFzcywgZmFsc2UpKTsKICAgICAgICAgICAgc3RhcnQgPSBTeXN0\nZW0uY3VycmVudFRpbWVNaWxsaXMoKTsKICAgICAgICAgICAgYXNzZXJ0SW5D\nYWNoZShxLCBpbkNhY2hlLCBuZXcgT2JqZWN0W117IE9SSUdfTkFNRSwKICAg\nICAgICAgICAgICAgIG5ldyBJbnRlZ2VyKE9SSUdfQUdFKSB9KTsKICAgICAg\nICAgICAgbCA9IChMaXN0KSBxLmV4ZWN1dGUobmV3IE9iamVjdFtdeyBPUklH\nX05BTUUsCiAgICAgICAgICAgICAgICBuZXcgSW50ZWdlcihPUklHX0FHRSkg\nfSk7CiAgICAgICAgICAgIGl0ZXJhdGUobCk7CiAgICAgICAgICAgIHEycDEg\nPSBTeXN0ZW0uY3VycmVudFRpbWVNaWxsaXMoKSAtIHN0YXJ0OwoKICAgICAg\nICAgICAgYXNzZXJ0RXF1YWxzKG9yaWdTaXplLCBsLnNpemUoKSk7CgogICAg\nICAgICAgICBzdGFydCA9IFN5c3RlbS5jdXJyZW50VGltZU1pbGxpcygpOwog\nICAgICAgICAgICBsMiA9IChMaXN0KSBxLmV4ZWN1dGUobmV3IE9iamVjdFtd\neyBPUklHX05BTUUsCiAgICAgICAgICAgICAgICBuZXcgSW50ZWdlcihPUklH\nX0FHRSkgfSk7CiAgICAgICAgICAgIGl0ZXJhdGUobDIpOwogICAgICAgICAg\nICBxMnAyID0gU3lzdGVtLmN1cnJlbnRUaW1lTWlsbGlzKCkgLSBzdGFydDsK\nCiAgICAgICAgICAgIGFzc2VydEVxdWFscyhvcmlnU2l6ZSwgbDIuc2l6ZSgp\nKTsKICAgICAgICAgICAgLy8gU3lzdGVtLm91dC5wcmludGxuICgiaW5DYWNo\nZTogIiArIGluQ2FjaGUgKyAiO1x0IHExcDE6ICIgKyBxMXAxCiAgICAgICAg\nICAgIC8vICsgIjtcdCBxMXAyOiAiICsgcTFwMiArICI7XHQgcTJwMTogIiAr\nIHEycDEgKyAiO1x0IHEycDI6ICIKICAgICAgICAgICAgLy8gKyBxMnAyKTsK\nICAgICAgICB9CiAgICAgICAgZmluYWxseSB7CiAgICAgICAgICAgIGVuZEVt\nKGVtKTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGljIHZvaWQgdGVzdE5v\nbkNhY2hlYWJsZUNsYXNzKCkgewogICAgICAgIEJyb2tlciBicm9rZXIgPSBK\nUEFGYWNhZGVIZWxwZXIudG9Ccm9rZXJGYWN0b3J5KGZhY3RvcnkpLm5ld0Jy\nb2tlcigpOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIG9yZy5hcGFjaGUu\nb3BlbmpwYS5rZXJuZWwuUXVlcnkgcSA9IGJyb2tlci5uZXdRdWVyeSgKICAg\nICAgICAgICAgICAgIEpQUUxQYXJzZXIuTEFOR19KUFFMLCAiU2VsZWN0IGEg\nRlJPTSAiCiAgICAgICAgICAgICAgICArIENhY2hlT2JqZWN0Qi5jbGFzcy5n\nZXRTaW1wbGVOYW1lKCkgKyAiIGEiKTsKCiAgICAgICAgICAgIENvbGxlY3Rp\nb24gYyA9IChDb2xsZWN0aW9uKSBxLmV4ZWN1dGUoKTsKICAgICAgICAgICAg\naXRlcmF0ZShjKTsKCiAgICAgICAgICAgIGFzc2VydEluQ2FjaGUocSwgQm9v\nbGVhbi5GQUxTRSk7CiAgICAgICAgfQogICAgICAgIGZpbmFsbHkgewogICAg\nICAgICAgICBjbG9zZShicm9rZXIpOwogICAgICAgIH0KICAgIH0KCiAgICBw\ndWJsaWMgdm9pZCB0ZXN0Tm9uQ2FjaGVhYmxlQWNjZXNzUGF0aCgpIHsKICAg\nICAgICBCcm9rZXIgYnJva2VyID0gSlBBRmFjYWRlSGVscGVyLnRvQnJva2Vy\nRmFjdG9yeShmYWN0b3J5KS5uZXdCcm9rZXIoKTsKICAgICAgICB0cnkgewog\nICAgICAgICAgICBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLlF1ZXJ5IHEg\nPSBicm9rZXIubmV3UXVlcnkoCiAgICAgICAgICAgICAgICBKUFFMUGFyc2Vy\nLkxBTkdfSlBRTCwgIlNlbGVjdCBhIEZST00gIgogICAgICAgICAgICAgICAg\nKyBDYWNoZU9iamVjdEEuY2xhc3MuZ2V0U2ltcGxlTmFtZSgpCiAgICAgICAg\nICAgICAgICArICIgYSB3aGVyZSBhLnJlbGF0ZWRCLnN0ciA9ICdmb28nIik7\nCiAgICAgICAgICAgIC8vICJyZWxhdGVkQi5zdHIgPT0gJ2ZvbyciKTsKICAg\nICAgICAgICAgcS5zZXRDYW5kaWRhdGVFeHRlbnQoYnJva2VyLm5ld0V4dGVu\ndChDYWNoZU9iamVjdEEuY2xhc3MsIGZhbHNlKSk7CgogICAgICAgICAgICBD\nb2xsZWN0aW9uIGMgPSAoQ29sbGVjdGlvbikgcS5leGVjdXRlKCk7CiAgICAg\nICAgICAgIGl0ZXJhdGUoYyk7CgogICAgICAgICAgICBhc3NlcnRJbkNhY2hl\nKHEsIEJvb2xlYW4uRkFMU0UpOwogICAgICAgIH0KICAgICAgICBmaW5hbGx5\nIHsKICAgICAgICAgICAgY2xvc2UoYnJva2VyKTsKICAgICAgICB9CiAgICB9\nCgogICAgcHVibGljIHZvaWQgdGVzdE5vbkNhY2hlYWJsZVN1YmNsYXNzZXMx\nKCkgewogICAgICAgIEJyb2tlciBicm9rZXIgPSBKUEFGYWNhZGVIZWxwZXIu\ndG9Ccm9rZXJGYWN0b3J5KGZhY3RvcnkpLm5ld0Jyb2tlcigpOwogICAgICAg\nIHRyeSB7CiAgICAgICAgICAgIC8vIGEgcXVlcnkgb24gdGhlIENhY2hlT2Jq\nZWN0QSBjbGFzcyBpbmNsdWRlcyBhbiB1bmNhY2hlYWJsZQogICAgICAgICAg\nICAvLyBjbGFzczsgaXQgc2hvdWxkIHRoZXJlZm9yZSBub3QgYmUgY2FjaGVh\nYmxlLgogICAgICAgICAgICBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLlF1\nZXJ5IHEgPSBicm9rZXIubmV3UXVlcnkoCiAgICAgICAgICAgICAgICBKUFFM\nUGFyc2VyLkxBTkdfSlBRTCwgIlNlbGVjdCBhIEZST00gIgogICAgICAgICAg\nICAgICAgKyBDYWNoZU9iamVjdEEuY2xhc3MuZ2V0U2ltcGxlTmFtZSgpICsg\nIiBhIik7CgogICAgICAgICAgICBDb2xsZWN0aW9uIGMgPSAoQ29sbGVjdGlv\nbikgcS5leGVjdXRlKCk7CiAgICAgICAgICAgIGl0ZXJhdGUoYyk7CgogICAg\nICAgICAgICBhc3NlcnRJbkNhY2hlKHEsIEJvb2xlYW4uRkFMU0UpOwogICAg\nICAgIH0KICAgICAgICBmaW5hbGx5IHsKICAgICAgICAgICAgY2xvc2UoYnJv\na2VyKTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGljIHZvaWQgdGVzdE5v\nbkNhY2hlYWJsZVN1YmNsYXNzZXMyKCkgewogICAgICAgIEJyb2tlciBicm9r\nZXIgPSBKUEFGYWNhZGVIZWxwZXIudG9Ccm9rZXJGYWN0b3J5KGZhY3Rvcnkp\nLm5ld0Jyb2tlcigpOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIC8vIGEg\ncXVlcnkgb24gdGhlIENhY2hlT2JqZWN0QSBleHRlbnQgY29uZmlndXJlZCB3\naXRob3V0CiAgICAgICAgICAgIC8vIHN1YmNsYXNzZXMgZG9lcyBub3QgaW5j\nbHVkZSBhbiB1bmNhY2hlYWJsZSBjbGFzczsgaXQgc2hvdWxkCiAgICAgICAg\nICAgIC8vIHRoZXJlZm9yZSBiZSBjYWNoZWFibGUuCiAgICAgICAgICAgIG9y\nZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuUXVlcnkgcSA9IGJyb2tlci5uZXdR\ndWVyeSgKICAgICAgICAgICAgICAgIEpQUUxQYXJzZXIuTEFOR19KUFFMLCAi\nc2VsZWN0IGEgZnJvbSAiCiAgICAgICAgICAgICAgICArIENhY2hlT2JqZWN0\nQS5jbGFzcy5nZXRTaW1wbGVOYW1lKCkgKyAiIGEiKTsKICAgICAgICAgICAg\ncS5zZXRDYW5kaWRhdGVFeHRlbnQoYnJva2VyLm5ld0V4dGVudChDYWNoZU9i\namVjdEEuY2xhc3MsIGZhbHNlKSk7CgogICAgICAgICAgICBDb2xsZWN0aW9u\nIGMgPSAoQ29sbGVjdGlvbikgcS5leGVjdXRlKCk7CiAgICAgICAgICAgIGl0\nZXJhdGUoYyk7CgogICAgICAgICAgICBhc3NlcnRJbkNhY2hlKHEsIEJvb2xl\nYW4uVFJVRSk7CiAgICAgICAgfQogICAgICAgIGZpbmFsbHkgewogICAgICAg\nICAgICBjbG9zZShicm9rZXIpOwogICAgICAgIH0KICAgIH0KCiAgICBwdWJs\naWMgdm9pZCB0ZXN0Q2FjaGVOYW1lcygpIHsKICAgICAgICBhc3NlcnRDYWNo\nZU5hbWUoQ2FjaGVPYmplY3RBLmNsYXNzLCBEYXRhQ2FjaGUuTkFNRV9ERUZB\nVUxUKTsKICAgICAgICBhc3NlcnRDYWNoZU5hbWUoQ2FjaGVPYmplY3RBQ2hp\nbGQxLmNsYXNzLCBEYXRhQ2FjaGUuTkFNRV9ERUZBVUxUKTsKICAgICAgICBh\nc3NlcnRDYWNoZU5hbWUoQ2FjaGVPYmplY3RBQ2hpbGQyLmNsYXNzLCBudWxs\nKTsKICAgICAgICBhc3NlcnRDYWNoZU5hbWUoQ2FjaGVPYmplY3RCLmNsYXNz\nLCBudWxsKTsKICAgICAgICBhc3NlcnRDYWNoZU5hbWUoQ2FjaGVPYmplY3RC\nQ2hpbGQxLmNsYXNzLCBudWxsKTsKICAgICAgICBhc3NlcnRDYWNoZU5hbWUo\nQ2FjaGVPYmplY3RDLmNsYXNzLCAibm90LXRoZS1kZWZhdWx0LWNhY2hlIik7\nCiAgICAgICAgYXNzZXJ0Q2FjaGVOYW1lKENhY2hlT2JqZWN0RC5jbGFzcywg\nIm5vdC10aGUtZGVmYXVsdC1jYWNoZSIpOwogICAgICAgIGFzc2VydENhY2hl\nTmFtZShDYWNoZU9iamVjdEUuY2xhc3MsIERhdGFDYWNoZS5OQU1FX0RFRkFV\nTFQpOwogICAgICAgIGFzc2VydENhY2hlTmFtZShDYWNoZU9iamVjdEYuY2xh\nc3MsIERhdGFDYWNoZS5OQU1FX0RFRkFVTFQpOwogICAgICAgIGFzc2VydENh\nY2hlTmFtZShDYWNoZU9iamVjdEcuY2xhc3MsIERhdGFDYWNoZS5OQU1FX0RF\nRkFVTFQpOwogICAgICAgIGFzc2VydENhY2hlTmFtZShDYWNoZU9iamVjdEgu\nY2xhc3MsIERhdGFDYWNoZS5OQU1FX0RFRkFVTFQpOwogICAgICAgIGFzc2Vy\ndENhY2hlTmFtZShDYWNoZU9iamVjdEouY2xhc3MsIERhdGFDYWNoZS5OQU1F\nX0RFRkFVTFQpOwogICAgICAgIGFzc2VydENhY2hlTmFtZShBcHBJZENhY2hl\nT2JqZWN0LmNsYXNzLCBEYXRhQ2FjaGUuTkFNRV9ERUZBVUxUKTsKICAgIH0K\nCiAgICBwcml2YXRlIHZvaWQgYXNzZXJ0Q2FjaGVOYW1lKENsYXNzIGNscywg\nU3RyaW5nIGNhY2hlTmFtZSkgewogICAgICAgIENsYXNzTWV0YURhdGEgbWV0\nYSA9IEpQQUZhY2FkZUhlbHBlci5nZXRNZXRhRGF0YShmYWN0b3J5LCBjbHMp\nOwogICAgICAgIGlmIChjYWNoZU5hbWUgPT0gbnVsbCkKICAgICAgICAgICAg\nYXNzZXJ0TnVsbChtZXRhLmdldERhdGFDYWNoZSgpKTsKICAgICAgICBlbHNl\nIHsKICAgICAgICAgICAgYXNzZXJ0Tm90TnVsbChtZXRhLmdldERhdGFDYWNo\nZSgpKTsKICAgICAgICAgICAgYXNzZXJ0RXF1YWxzKGNhY2hlTmFtZSwgbWV0\nYS5nZXREYXRhQ2FjaGUoKS5nZXROYW1lKCkpOwogICAgICAgIH0KICAgIH0K\nCiAgICAvLyBGSVhNRSBTZWV0aGEgU2VwIDI2LDIwMDYKICAgIC8vIG5vdCBh\nYmxlIHRvIHJlcGxhY2UgcG0ubmV3UXVlcnkoQ2FjaGVPYmplY3RBLmNsYXNz\nKTsKICAgIC8qCiAgICAgICogcHVibGljIHZvaWQgdGVzdFF1ZXJ5QWdncmVn\nYXRlcygpIHsgUGVyc2lzdGVuY2VNYW5hZ2VyIHBtID0KICAgICAgKiBmYWN0\nb3J5LmdldFBlcnNpc3RlbmNlTWFuYWdlcigpOyB0cnkgeyBRdWVyeSBxID0K\nICAgICAgKiBwbS5uZXdRdWVyeShDYWNoZU9iamVjdEEuY2xhc3MpOyBxLnNl\ndFJlc3VsdCgibWF4IChhZ2UpIik7IE9iamVjdCBvID0KICAgICAgKiBxLmV4\nZWN1dGUoKTsgYXNzZXJ0VHJ1ZSgibyBtdXN0IGJlIGluc3RhbmNlb2YgTnVt\nYmVyIiwgbyBpbnN0YW5jZW9mCiAgICAgICogTnVtYmVyKTsgfSBmaW5hbGx5\nIHsgY2xvc2UocG0pOyB9IH0KICAgICAgKi8KCiAgICBwdWJsaWMgdm9pZCB0\nZXN0Q2FjaGUyKCkgewogICAgICAgIE9wZW5KUEFFbnRpdHlNYW5hZ2VyIGVt\nMSA9CiAgICAgICAgICAgIChPcGVuSlBBRW50aXR5TWFuYWdlcikgZmFjdG9y\neS5jcmVhdGVFbnRpdHlNYW5hZ2VyKCk7CiAgICAgICAgT3BlbkpQQUVudGl0\neU1hbmFnZXIgZW0yID0gbnVsbDsKICAgICAgICBEYXRhQ2FjaGUgY2FjaGU7\nCgogICAgICAgIHRyeSB7CiAgICAgICAgICAgIENhY2hlT2JqZWN0QSBhMSA9\nIChDYWNoZU9iamVjdEEpIGVtMS5maW5kKENhY2hlT2JqZWN0QS5jbGFzcywg\nb2lkKTsKCiAgICAgICAgICAgIGVtMiA9IChPcGVuSlBBRW50aXR5TWFuYWdl\ncikgZmFjdG9yeTIuY3JlYXRlRW50aXR5TWFuYWdlcigpOwogICAgICAgICAg\nICBDYWNoZU9iamVjdEEgYTIgPSAoQ2FjaGVPYmplY3RBKSBlbTIuZmluZChD\nYWNoZU9iamVjdEEuY2xhc3MsIG9pZCk7CgogICAgICAgICAgICAvLyBhc3Nl\ncnQgdGhhdCB0aGUgb2lkIGlzIGluIGZhY3RvcnkyJ3MgY2FjaGUKICAgICAg\nICAgICAgLy9NZXRhRGF0YVJlcG9zaXRvcnkgcmVwb3MyID0gZmFjdG9yeTIu\nZ2V0Q29uZmlndXJhdGlvbigpLmdldE1ldGFEYXRhUmVwb3NpdG9yeUluc3Rh\nbmNlKCk7CiAgICAgICAgICAgIE1ldGFEYXRhUmVwb3NpdG9yeSByZXBvczIg\nPQogICAgICAgICAgICAgICAgKCgoKE9wZW5KUEFFbnRpdHlNYW5hZ2VyRmFj\ndG9yeVNQSSkgZmFjdG9yeTIpKS5nZXRDb25maWd1cmF0aW9uKCkpCiAgICAg\nICAgICAgICAgICAgICAgLmdldE1ldGFEYXRhUmVwb3NpdG9yeUluc3RhbmNl\nKCk7CiAgICAgICAgICAgIENsYXNzTWV0YURhdGEgbWV0YSA9IHJlcG9zMgog\nICAgICAgICAgICAgICAgLmdldE1ldGFEYXRhKENhY2hlT2JqZWN0QS5jbGFz\ncywgZW0yLmdldENsYXNzTG9hZGVyKCksIHRydWUpOwogICAgICAgICAgICBj\nYWNoZSA9IG1ldGEuZ2V0RGF0YUNhY2hlKCk7CiAgICAgICAgICAgIGFzc2Vy\ndFRydWUoY2FjaGUuY29udGFpbnMob2lkd2l0aGNsYXNzKSk7CgogICAgICAg\nICAgICAvLyBtb2RpZnkgdGhlIG9iamVjdC4KICAgICAgICAgICAgc3RhcnRU\neChlbTEpOwogICAgICAgICAgICBhMS5zZXROYW1lKGExLmdldE5hbWUoKSAr\nICIgY2hhbmdlZCIpOwogICAgICAgICAgICBlbmRUeChlbTEpOwogICAgICAg\nIH0KICAgICAgICBmaW5hbGx5IHsKICAgICAgICAgICAgaWYgKGVtMiAhPSBu\ndWxsKQogICAgICAgICAgICAgICAgZW5kRW0oZW0yKTsKICAgICAgICAgICAg\nZW5kRW0oZW0xKTsKICAgICAgICB9CgogICAgICAgIC8vIGlmIHRoZSBjYWNo\nZSBpcyBhIGNvaGVyZW50IG9uZSwgdGhlbiB0aGUgY2hhbmdlcyBzaG91bGQg\nYmUKICAgICAgICAvLyBzZWVuLiBPdGhlcndpc2UsIHRoZXkgc2hvdWxkIG5v\ndC4KICAgICAgICBpZiAoaXNDYWNoZUNvaGVyZW50KCkgfHwgZmFjdG9yeSA9\nPSBmYWN0b3J5MikKICAgICAgICAgICAgYXNzZXJ0VHJ1ZSgia2V5ICIgKyBv\naWQgKyAiIHdhcyBub3QgaW4gY2FjaGU7IHNob3VsZCBoYXZlIGJlZW4iLAog\nICAgICAgICAgICAgICAgY2FjaGUuY29udGFpbnMob2lkd2l0aGNsYXNzKSk7\nCiAgICAgICAgZWxzZQogICAgICAgICAgICBhc3NlcnRGYWxzZSgia2V5ICIg\nKyBvaWQgKyAiIHdhcyBpbiBjYWNoZTsgc2hvdWxkIG5vdCBoYXZlIGJlZW4i\nLAogICAgICAgICAgICAgICAgY2FjaGUuY29udGFpbnMob2lkd2l0aGNsYXNz\nKSk7CiAgICB9CgogICAgcHVibGljIHZvaWQgdGVzdFRpbWVvdXRzMSgpIHRo\ncm93cyBFeGNlcHRpb24gewogICAgICAgIHRpbWVvdXRzVGVzdDEoMSk7CiAg\nICB9CgogICAgcHVibGljIHZvaWQgdGltZW91dHNUZXN0MShpbnQgdHJpZXMp\nIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIC8vIHRoaXMgY3JhenkgZm9y\nIGxvb3Bpbmcgc3R1ZmYgaXMgaGVyZSBiZWNhdXNlIHdlJ3JlIHNlZWluZwog\nICAgICAgIC8vIGludGVybWl0dGVudCBmYWlsdXJlcyB3aXRoIHRoZSBnYXJi\nYWdlIGNvbGxlY3RvciBraWNraW5nIGluCiAgICAgICAgLy8gZHVyaW5nIHRl\nc3RpbmcuIFNvLCB0aGlzIGRlY3JlYXNlcyB0aGUgY2hhbmNlcyB0aGF0IHRo\nYXQKICAgICAgICAvLyB3aWxsIGhhcHBlbi4KICAgICAgICBFeGNlcHRpb24g\nZSA9IG51bGw7CiAgICAgICAgaW50IGk7CiAgICAgICAgZm9yIChpID0gMDsg\naSA8IHRyaWVzOyBpKyspIHsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAg\nICAgICAgIHRpbWVvdXRzSGVscGVyKGZhY3RvcnkpOwogICAgICAgICAgICAg\nICAgLy8gYW55IHN1Y2Nlc3NlcyB3aWxsIHBhc3MgdGhlIHRlc3QKICAgICAg\nICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAgICAgICBj\nYXRjaCAoRXhjZXB0aW9uIGV4KSB7CiAgICAgICAgICAgICAgICBlID0gZXg7\nCiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHRocm93IGU7CiAg\nICB9CgogICAgcHVibGljIHZvaWQgdGVzdFRpbWVvdXRzMigpIHRocm93cyBF\neGNlcHRpb24gewogICAgICAgIHRpbWVvdXRzVGVzdDIoMzApOwogICAgfQoK\nICAgIHB1YmxpYyB2b2lkIHRpbWVvdXRzVGVzdDIoaW50IHRyaWVzKSB0aHJv\nd3MgRXhjZXB0aW9uIHsKICAgICAgICBFcnJvciBlID0gbnVsbDsKICAgICAg\nICBmb3IgKGludCBpID0gMDsgaSA8IHRyaWVzOyBpKyspIHsKICAgICAgICAg\nICAgdHJ5IHsKICAgICAgICAgICAgICAgIHRpbWVvdXRzSGVscGVyKHRpbWVv\ndXRGYWN0b3J5KTsKICAgICAgICAgICAgICAgIC8vIGFueSBzdWNjZXNzZXMg\nd2lsbCBwYXNzIHRoZSB0ZXN0CiAgICAgICAgICAgICAgICByZXR1cm47CiAg\nICAgICAgICAgIH0KICAgICAgICAgICAgY2F0Y2ggKEFzc2VydGlvbkZhaWxl\nZEVycm9yIGFmZSkgewogICAgICAgICAgICAgICAgZSA9IGFmZTsKICAgICAg\nICAgICAgfQogICAgICAgIH0KCiAgICAgICAgdGhyb3cgZTsKICAgIH0KCiAg\nICBwcml2YXRlIHZvaWQgdGltZW91dHNIZWxwZXIoT3BlbkpQQUVudGl0eU1h\nbmFnZXJGYWN0b3J5IGZhY3RvcnkpCiAgICAgICAgdGhyb3dzIEV4Y2VwdGlv\nbiB7CiAgICAgICAgT3BlbkpQQUVudGl0eU1hbmFnZXIgZW0gPSAoT3BlbkpQ\nQUVudGl0eU1hbmFnZXIpIGZhY3RvcnkKICAgICAgICAgICAgLmNyZWF0ZUVu\ndGl0eU1hbmFnZXIoKTsKICAgICAgICB0cnkgewogICAgICAgICAgICBzdGFy\ndFR4KGVtKTsKCiAgICAgICAgICAgIENhY2hlT2JqZWN0RSBlID0gbmV3IENh\nY2hlT2JqZWN0RSgiZSIpOwogICAgICAgICAgICBlbS5wZXJzaXN0KGUpOwoK\nICAgICAgICAgICAgQ2FjaGVPYmplY3RGIGYgPSBuZXcgQ2FjaGVPYmplY3RG\nKCJmIik7CiAgICAgICAgICAgIGVtLnBlcnNpc3QoZik7CgogICAgICAgICAg\nICBDYWNoZU9iamVjdEcgZyA9IG5ldyBDYWNoZU9iamVjdEcoImciKTsKICAg\nICAgICAgICAgZW0ucGVyc2lzdChnKTsKCiAgICAgICAgICAgIENhY2hlT2Jq\nZWN0SCBoID0gbmV3IENhY2hlT2JqZWN0SCgiaCIpOwogICAgICAgICAgICBl\nbS5wZXJzaXN0KGgpOwoKICAgICAgICAgICAgZW5kVHgoZW0pOwoKICAgICAg\nICAgICAgT2JqZWN0W10gaWRzID0gbmV3IE9iamVjdFs0XTsKICAgICAgICAg\nICAgaWRzWzBdID0gbmV3IElkKENhY2hlT2JqZWN0RS5jbGFzcywgZW0uZ2V0\nT2JqZWN0SWQoZSkudG9TdHJpbmcoKSk7CiAgICAgICAgICAgIGlkc1sxXSA9\nIG5ldyBJZChDYWNoZU9iamVjdEYuY2xhc3MsIGVtLmdldE9iamVjdElkKGYp\nLnRvU3RyaW5nKCkpOwogICAgICAgICAgICBpZHNbMl0gPSBuZXcgSWQoQ2Fj\naGVPYmplY3RHLmNsYXNzLCBlbS5nZXRPYmplY3RJZChnKS50b1N0cmluZygp\nKTsKICAgICAgICAgICAgaWRzWzNdID0gbmV3IElkKENhY2hlT2JqZWN0SC5j\nbGFzcywgZW0uZ2V0T2JqZWN0SWQoaCkudG9TdHJpbmcoKSk7CgogICAgICAg\nICAgICAvLyBidWlsZCB1cCBzb21lIHF1ZXJpZXMgdG8gdGVzdAoKICAgICAg\nICAgICAgLy8gdGhpcyBvbmUgc2hvdWxkIGJlIG9ubHkgb24gdGhlIHN1cGVy\nY2xhc3MsIHNpbmNlCiAgICAgICAgICAgIC8vIENhY2hlT2JqZWN0RiBoYXMg\nYSB0aW1lb3V0LgogICAgICAgICAgICBCcm9rZXIgYnJva2VyID0gSlBBRmFj\nYWRlSGVscGVyLnRvQnJva2VyKGVtKTsKICAgICAgICAgICAgb3JnLmFwYWNo\nZS5vcGVuanBhLmtlcm5lbC5RdWVyeSBxMSA9IGJyb2tlci5uZXdRdWVyeSgK\nICAgICAgICAgICAgICAgIEpQUUxQYXJzZXIuTEFOR19KUFFMLCAic2VsZWN0\nIGEgZnJvbSAiCiAgICAgICAgICAgICAgICArIENhY2hlT2JqZWN0RS5jbGFz\ncy5nZXRTaW1wbGVOYW1lKCkgKyAiIGEiKTsKICAgICAgICAgICAgcTEuc2V0\nQ2FuZGlkYXRlRXh0ZW50KGJyb2tlci5uZXdFeHRlbnQoQ2FjaGVPYmplY3RF\nLmNsYXNzLCBmYWxzZSkpOwogICAgICAgICAgICBpdGVyYXRlKChDb2xsZWN0\naW9uKSBxMS5leGVjdXRlKCkpOwogICAgICAgICAgICBhc3NlcnRJbkNhY2hl\nKHExLCBCb29sZWFuLlRSVUUpOwoKICAgICAgICAgICAgb3JnLmFwYWNoZS5v\ncGVuanBhLmtlcm5lbC5RdWVyeSBxMiA9IGJyb2tlci5uZXdRdWVyeSgKICAg\nICAgICAgICAgICAgIEpQUUxQYXJzZXIuTEFOR19KUFFMLCAiU2VsZWN0IGEg\nRlJPTSAiCiAgICAgICAgICAgICAgICArIENhY2hlT2JqZWN0Ri5jbGFzcy5n\nZXRTaW1wbGVOYW1lKCkgKyAiIGEiKTsKICAgICAgICAgICAgaXRlcmF0ZSgo\nQ29sbGVjdGlvbikgcTIuZXhlY3V0ZSgpKTsKICAgICAgICAgICAgYXNzZXJ0\nSW5DYWNoZShxMiwgQm9vbGVhbi5UUlVFKTsKCiAgICAgICAgICAgIERhdGFD\nYWNoZSBjYWNoZSA9IGNhY2hlTWFuYWdlcihmYWN0b3J5KS5nZXREYXRhQ2Fj\naGUoCiAgICAgICAgICAgICAgICBEYXRhQ2FjaGUuTkFNRV9ERUZBVUxULCBm\nYWxzZSk7CiAgICAgICAgICAgIGNoZWNrQ2FjaGUoY2FjaGUsIGlkcywgbmV3\nIGJvb2xlYW5bXXsgdHJ1ZSwgdHJ1ZSwgdHJ1ZSwgdHJ1ZSB9KTsKCiAgICAg\nICAgICAgIC8vIHNob3VsZCBjYXVzZSBoIHRvIGJlIGRyb3BwZWQuCiAgICAg\nICAgICAgIFRocmVhZC5jdXJyZW50VGhyZWFkKCkuc2xlZXAoNTUxKTsKICAg\nICAgICAgICAgVGhyZWFkLnlpZWxkKCk7CiAgICAgICAgICAgIGNoZWNrQ2Fj\naGUoY2FjaGUsIGlkcywgbmV3IGJvb2xlYW5bXXsgdHJ1ZSwgdHJ1ZSwgdHJ1\nZSwgZmFsc2UgfSk7CgogICAgICAgICAgICAvLyBpZiB0aGlzIHJ1biBoYXMg\nYSBkZWZhdWx0IHRpbWVvdXQgKHNldCB0byAxIHNlYyBpbiB0aGUgdGVzdAog\nICAgICAgICAgICAvLyBjYXNlKSwgZSBzaG91bGQgYmUgdGltZWQgb3V0IGJ5\nIHRoaXMgcG9pbnQuCiAgICAgICAgICAgIC8vYm9vbGVhbiBlU3RhdHVzID0g\nIShmYWN0b3J5LmdldENvbmZpZ3VyYXRpb24oKS5nZXREYXRhQ2FjaGVUaW1l\nb3V0KCkgPiAwKTsKICAgICAgICAgICAgYm9vbGVhbiBlU3RhdHVzID0KICAg\nICAgICAgICAgICAgICEoKCgoT3BlbkpQQUVudGl0eU1hbmFnZXJGYWN0b3J5\nU1BJKSBmYWN0b3J5KS5nZXRDb25maWd1cmF0aW9uKCkpCiAgICAgICAgICAg\nICAgICAgICAgLmdldERhdGFDYWNoZVRpbWVvdXQoKSA+IDApOwoKICAgICAg\nICAgICAgLy8gc2hvdWxkIGNhdXNlIGYgdG8gYmUgZHJvcHBlZC4KICAgICAg\nICAgICAgVGhyZWFkLmN1cnJlbnRUaHJlYWQoKS5zbGVlcCg1NTApOwogICAg\nICAgICAgICBUaHJlYWQueWllbGQoKTsKICAgICAgICAgICAgY2hlY2tDYWNo\nZShjYWNoZSwgaWRzLAogICAgICAgICAgICAgICAgbmV3IGJvb2xlYW5bXXsg\nZVN0YXR1cywgZmFsc2UsIHRydWUsIGZhbHNlIH0pOwoKICAgICAgICAgICAg\nLy8gYXQgdGhpcyBwb2ludCwgcTIgc2hvdWxkIGJlIGRyb3BwZWQgKGJlY2F1\nc2UgaXRzIGNhbmRpZGF0ZQogICAgICAgICAgICAvLyBjbGFzcyBpcyBDYWNo\nZU9iamVjdEYpLCBhbmQgcTEgbWlnaHQgYmUgZHJvcHBlZCwgZGVwZW5kaW5n\nCiAgICAgICAgICAgIC8vIG9uIHdoZXRoZXIgb3Igbm90IHdlJ3ZlIGdvdCBh\nIHRpbWVvdXQgY29uZmlndXJlZC4KICAgICAgICAgICAgYXNzZXJ0SW5DYWNo\nZShxMSwgKGVTdGF0dXMpID8gQm9vbGVhbi5UUlVFIDogQm9vbGVhbi5GQUxT\nRSk7CiAgICAgICAgICAgIGFzc2VydEluQ2FjaGUocTIsIEJvb2xlYW4uRkFM\nU0UpOwoKICAgICAgICAgICAgLy8gc2hvdWxkIGNhdXNlIGcgdG8gYmUgZHJv\ncHBlZC4KICAgICAgICAgICAgVGhyZWFkLmN1cnJlbnRUaHJlYWQoKS5zbGVl\ncCg0MDUwKTsKICAgICAgICAgICAgVGhyZWFkLnlpZWxkKCk7CiAgICAgICAg\nICAgIGNoZWNrQ2FjaGUoY2FjaGUsIGlkcywKICAgICAgICAgICAgICAgIG5l\ndyBib29sZWFuW117IGVTdGF0dXMsIGZhbHNlLCBmYWxzZSwgZmFsc2UgfSk7\nCiAgICAgICAgfQogICAgICAgIGZpbmFsbHkgewogICAgICAgICAgICBlbmRF\nbShlbSk7CiAgICAgICAgfQogICAgfQoKICAgIHB1YmxpYyB2b2lkIHRlc3RR\ndWVyeVRpbWVvdXRzKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgcXVl\ncnlUaW1lb3V0c0hlbHBlcihmYWN0b3J5KTsKICAgICAgICBxdWVyeVRpbWVv\ndXRzSGVscGVyKHRpbWVvdXRGYWN0b3J5KTsKICAgIH0KCiAgICBwcml2YXRl\nIHZvaWQgcXVlcnlUaW1lb3V0c0hlbHBlcihPcGVuSlBBRW50aXR5TWFuYWdl\nckZhY3RvcnkgZmFjdG9yeSkKICAgICAgICB0aHJvd3MgRXhjZXB0aW9uIHsK\nICAgICAgICBPcGVuSlBBRW50aXR5TWFuYWdlciBlbSA9IChPcGVuSlBBRW50\naXR5TWFuYWdlcikgZmFjdG9yeQogICAgICAgICAgICAuY3JlYXRlRW50aXR5\nTWFuYWdlcigpOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIHN0YXJ0VHgo\nZW0pOwoKICAgICAgICAgICAgQ2FjaGVPYmplY3RFIGUgPSBuZXcgQ2FjaGVP\nYmplY3RFKCJlIik7CiAgICAgICAgICAgIGVtLnBlcnNpc3QoZSk7CgogICAg\nICAgICAgICBDYWNoZU9iamVjdEYgZiA9IG5ldyBDYWNoZU9iamVjdEYoImYi\nKTsKICAgICAgICAgICAgZW0ucGVyc2lzdChmKTsKCiAgICAgICAgICAgIGVu\nZFR4KGVtKTsKCiAgICAgICAgICAgIC8vIGJ1aWxkIHVwIHNvbWUgcXVlcmll\ncyB0byB0ZXN0CiAgICAgICAgICAgIEJyb2tlciBicm9rZXIgPSBKUEFGYWNh\nZGVIZWxwZXIudG9Ccm9rZXIoZW0pOwogICAgICAgICAgICBvcmcuYXBhY2hl\nLm9wZW5qcGEua2VybmVsLlF1ZXJ5IHExID0gYnJva2VyCiAgICAgICAgICAg\nICAgICAubmV3UXVlcnkoSlBRTFBhcnNlci5MQU5HX0pQUUwsICJTRUxFQ1Qg\nYSBGUk9NIENhY2hlT2JqZWN0RSBhIik7CgogICAgICAgICAgICBxMS5zZXRD\nYW5kaWRhdGVFeHRlbnQoYnJva2VyLm5ld0V4dGVudChDYWNoZU9iamVjdEUu\nY2xhc3MsIGZhbHNlKSk7CiAgICAgICAgICAgIGl0ZXJhdGUoKENvbGxlY3Rp\nb24pIHExLmV4ZWN1dGUoKSk7CiAgICAgICAgICAgIGFzc2VydEluQ2FjaGUo\ncTEsIEJvb2xlYW4uVFJVRSk7CgogICAgICAgICAgICBvcmcuYXBhY2hlLm9w\nZW5qcGEua2VybmVsLlF1ZXJ5IHEyID0gYnJva2VyCiAgICAgICAgICAgICAg\nICAubmV3UXVlcnkoSlBRTFBhcnNlci5MQU5HX0pQUUwsICJTRUxFQ1QgYSBG\nUk9NIENhY2hlT2JqZWN0RiBhIik7CiAgICAgICAgICAgIGl0ZXJhdGUoKENv\nbGxlY3Rpb24pIHEyLmV4ZWN1dGUoKSk7CiAgICAgICAgICAgIGFzc2VydElu\nQ2FjaGUocTIsIEJvb2xlYW4uVFJVRSk7CgogICAgICAgICAgICAvLyBpZiB0\naGlzIHJ1biBoYXMgYSBkZWZhdWx0IHRpbWVvdXQgKHNldCB0byAxIHNlYyBp\nbiB0aGUgdGVzdAogICAgICAgICAgICAvLyBjYXNlKSwgZSBzaG91bGQgYmUg\ndGltZWQgb3V0IGJ5IHRoaXMgcG9pbnQuCiAgICAgICAgICAgIC8vYm9vbGVh\nbiBlVGltZWRPdXQgPSBmYWN0b3J5LmdldENvbmZpZ3VyYXRpb24oKS5nZXRE\nYXRhQ2FjaGVUaW1lb3V0KCkgPiAwOwogICAgICAgICAgICBib29sZWFuIGVU\naW1lZE91dCA9CiAgICAgICAgICAgICAgICAoKCgoT3BlbkpQQUVudGl0eU1h\nbmFnZXJGYWN0b3J5U1BJKSBmYWN0b3J5KS5nZXRDb25maWd1cmF0aW9uKCkp\nCiAgICAgICAgICAgICAgICAgICAgLmdldERhdGFDYWNoZVRpbWVvdXQoKSA+\nIDApOwoKICAgICAgICAgICAgLy8gc2hvdWxkIGNhdXNlIGYgdG8gYmUgZHJv\ncHBlZC4KICAgICAgICAgICAgVGhyZWFkLmN1cnJlbnRUaHJlYWQoKS5zbGVl\ncCgxMDAxKTsKCiAgICAgICAgICAgIC8vIGF0IHRoaXMgcG9pbnQsIHEyIHNo\nb3VsZCBiZSBkcm9wcGVkIChiZWNhdXNlIGl0cyBjYW5kaWRhdGUKICAgICAg\nICAgICAgLy8gY2xhc3MgaXMgQ2FjaGVPYmplY3RGKSwgYW5kIHExIG1pZ2h0\nIGJlIGRyb3BwZWQsIGRlcGVuZGluZwogICAgICAgICAgICAvLyBvbiB3aGV0\naGVyIG9yIG5vdCB3ZSd2ZSBnb3QgYSB0aW1lb3V0IGNvbmZpZ3VyZWQuCiAg\nICAgICAgICAgIGFzc2VydEluQ2FjaGUocTEsIChlVGltZWRPdXQpID8gQm9v\nbGVhbi5GQUxTRSA6IEJvb2xlYW4uVFJVRSk7CiAgICAgICAgICAgIGFzc2Vy\ndEluQ2FjaGUocTIsIEJvb2xlYW4uRkFMU0UpOwogICAgICAgIH0KICAgICAg\nICBmaW5hbGx5IHsKICAgICAgICAgICAgZW5kRW0oZW0pOwogICAgICAgIH0K\nICAgIH0KCiAgICBwdWJsaWMgdm9pZCB0ZXN0UXVlcnlJbXBsaWNpdEV2aWN0\naW9ucygpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIE9wZW5KUEFFbnRp\ndHlNYW5hZ2VyIGVtID0gKE9wZW5KUEFFbnRpdHlNYW5hZ2VyKSBmYWN0b3J5\nCiAgICAgICAgICAgIC5jcmVhdGVFbnRpdHlNYW5hZ2VyKCk7CiAgICAgICAg\ndHJ5IHsKICAgICAgICAgICAgUnVudGltZVRlc3QxW10gaGVscGVyT2JqcyA9\nIG5ldyBSdW50aW1lVGVzdDFbNV07CiAgICAgICAgICAgIGhlbHBlck9ianNb\nMF0gPSBuZXcgUnVudGltZVRlc3QxKCk7CiAgICAgICAgICAgIGhlbHBlck9i\nanNbMV0gPSBuZXcgUnVudGltZVRlc3QxKCk7CiAgICAgICAgICAgIGhlbHBl\nck9ianNbMl0gPSBuZXcgUnVudGltZVRlc3QxKCk7CiAgICAgICAgICAgIGhl\nbHBlck9ianNbM10gPSBuZXcgUnVudGltZVRlc3QxKCk7CiAgICAgICAgICAg\nIGhlbHBlck9ianNbNF0gPSBuZXcgUnVudGltZVRlc3QxKCk7CiAgICAgICAg\nICAgIHN0YXJ0VHgoZW0pOwogICAgICAgICAgICBlbS5wZXJzaXN0KGhlbHBl\nck9ianNbMF0pOwogICAgICAgICAgICBlbS5wZXJzaXN0KGhlbHBlck9ianNb\nMV0pOwogICAgICAgICAgICBlbS5wZXJzaXN0KGhlbHBlck9ianNbMl0pOwog\nICAgICAgICAgICBlbS5wZXJzaXN0KGhlbHBlck9ianNbM10pOwogICAgICAg\nICAgICBlbS5wZXJzaXN0KGhlbHBlck9ianNbNF0pOwogICAgICAgICAgICBl\nbmRUeChlbSk7CgogICAgICAgICAgICBEYXRhQ2FjaGUgY2FjaGUgPSBjYWNo\nZU1hbmFnZXIoZmFjdG9yeSkuZ2V0RGF0YUNhY2hlKAogICAgICAgICAgICAg\nICAgRGF0YUNhY2hlLk5BTUVfREVGQVVMVCwgZmFsc2UpOwoKICAgICAgICAg\nICAgaWYgKCFpc09wZW5KUEFDYWNoZShjYWNoZSkpIHsKICAgICAgICAgICAg\nICAgIGJ1Zyg2MjcsICJUYW5nb3NvbCBjYWNoZSBpbXBsIG5lZWRzIG1vZGVy\nbml6YXRpb24iKTsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAg\nICAgfQoKICAgICAgICAgICAgaWYgKGNhY2hlIGluc3RhbmNlb2YgRGVsZWdh\ndGluZ0RhdGFDYWNoZSkKICAgICAgICAgICAgICAgIGNhY2hlID0gKChEZWxl\nZ2F0aW5nRGF0YUNhY2hlKSBjYWNoZSkuZ2V0SW5uZXJtb3N0RGVsZWdhdGUo\nKTsKICAgICAgICAgICAgaWYgKGNhY2hlIGluc3RhbmNlb2YgQ29uY3VycmVu\ndERhdGFDYWNoZSkgewogICAgICAgICAgICAgICAgQ2FjaGVNYXAgbWFwID0g\nKChDb25jdXJyZW50RGF0YUNhY2hlKSBjYWNoZSkuZ2V0Q2FjaGVNYXAoKTsK\nICAgICAgICAgICAgICAgIG1hcC5zZXRDYWNoZVNpemUoMyk7CiAgICAgICAg\nICAgICAgICBtYXAuc2V0U29mdFJlZmVyZW5jZVNpemUoMCk7CiAgICAgICAg\nICAgIH0gZWxzZSBpZiAoY2FjaGUgaW5zdGFuY2VvZiBDb25jdXJyZW50RGF0\nYUNhY2hlKSB7CiAgICAgICAgICAgICAgICBDYWNoZU1hcCBtYXAgPSAoKENv\nbmN1cnJlbnREYXRhQ2FjaGUpIGNhY2hlKS5nZXRDYWNoZU1hcCgpOwogICAg\nICAgICAgICAgICAgbWFwLnNldENhY2hlU2l6ZSgzKTsKICAgICAgICAgICAg\nICAgIG1hcC5zZXRTb2Z0UmVmZXJlbmNlU2l6ZSgwKTsKICAgICAgICAgICAg\nfQoKICAgICAgICAgICAgc3RhcnRUeChlbSk7CiAgICAgICAgICAgIENhY2hl\nT2JqZWN0SCBoID0gbmV3IENhY2hlT2JqZWN0SCgiaCIpOwogICAgICAgICAg\nICBlbS5wZXJzaXN0KGgpOwogICAgICAgICAgICBDYWNoZU9iamVjdEogaiA9\nIG5ldyBDYWNoZU9iamVjdEooImoiLCBoKTsKICAgICAgICAgICAgZW0ucGVy\nc2lzdChqKTsKICAgICAgICAgICAgZW5kVHgoZW0pOwogICAgICAgICAgICBP\nYmplY3QgaG9pZCA9IGVtLmdldE9iamVjdElkKGgpOwogICAgICAgICAgICBP\nYmplY3Qgam9pZCA9IGVtLmdldE9iamVjdElkKGopOwoKICAgICAgICAgICAg\nT2JqZWN0IGhvaWR3aXRoY2xhc3MgPSBuZXcgSWQoQ2FjaGVPYmplY3RILmNs\nYXNzLCBob2lkLnRvU3RyaW5nKCkpOwogICAgICAgICAgICBPYmplY3Qgam9p\nZHdpdGhjbGFzcyA9IG5ldyBJZChDYWNoZU9iamVjdEouY2xhc3MsIGpvaWQu\ndG9TdHJpbmcoKSk7CiAgICAgICAgICAgIGVuZEVtKGVtKTsKCiAgICAgICAg\nICAgIC8vIG1ha2Ugc3VyZSBqIGFuZCBoIGFyZSBpbiBjYWNoZTsgbWF5IG5v\ndCBiZSBpZiBub3QgTFJVCiAgICAgICAgICAgIGludCBhdHRlbXB0cyA9IDA7\nCiAgICAgICAgICAgIGZvciAoOyBhdHRlbXB0cyA8IDEwMCAmJiAhY2FjaGUu\nY29udGFpbnMoam9pZHdpdGhjbGFzcyk7IGF0dGVtcHRzKyspCiAgICAgICAg\nICAgIHsKICAgICAgICAgICAgICAgIGVtID0gZmFjdG9yeS5jcmVhdGVFbnRp\ndHlNYW5hZ2VyKCk7CiAgICAgICAgICAgICAgICBpZiAoIWNhY2hlLmNvbnRh\naW5zKGhvaWR3aXRoY2xhc3MpKQogICAgICAgICAgICAgICAgICAgIGVtLmZp\nbmQoQ2FjaGVPYmplY3RILmNsYXNzLCBob2lkKTsKICAgICAgICAgICAgICAg\nIGlmICghY2FjaGUuY29udGFpbnMoam9pZHdpdGhjbGFzcykpCiAgICAgICAg\nICAgICAgICAgICAgZW0uZmluZChDYWNoZU9iamVjdEouY2xhc3MsIGpvaWQp\nOwogICAgICAgICAgICAgICAgZW5kRW0oZW0pOwogICAgICAgICAgICB9CiAg\nICAgICAgICAgIGFzc2VydFRydWUoIkNvdWxkIG5vdCBnZXQgcXVlcmllZCBv\nYmplY3RzIGludG8gY2FjaGUiLAogICAgICAgICAgICAgICAgYXR0ZW1wdHMg\nPCAxMDApOwoKICAgICAgICAgICAgLy8gYnVpbGQgdXAgYSBxdWVyeSB0aGF0\nIHVzZXMgSCBpbiBpdHMgYWNjZXNzIHBhdGguLi4KICAgICAgICAgICAgZW0g\nPSBmYWN0b3J5LmNyZWF0ZUVudGl0eU1hbmFnZXIoKTsKICAgICAgICAgICAg\nQnJva2VyIGJyb2tlciA9IEpQQUZhY2FkZUhlbHBlci50b0Jyb2tlcihlbSk7\nCiAgICAgICAgICAgIG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuUXVlcnkg\ncSA9IGJyb2tlci5uZXdRdWVyeSgKICAgICAgICAgICAgICAgIEpQUUxQYXJz\nZXIuTEFOR19KUFFMLCAiU2VsZWN0IGEgRlJPTSAiCiAgICAgICAgICAgICAg\nICArIENhY2hlT2JqZWN0Si5jbGFzcy5nZXRTaW1wbGVOYW1lKCkKICAgICAg\nICAgICAgICAgICsgIiBhIHdoZXJlIGEuc3RyID0gJ2gnIik7CiAgICAgICAg\nICAgIGl0ZXJhdGUoKENvbGxlY3Rpb24pIHEuZXhlY3V0ZSgpKTsKICAgICAg\nICAgICAgYXNzZXJ0SW5DYWNoZShxLCBCb29sZWFuLlRSVUUpOwogICAgICAg\nICAgICBlbmRFbShlbSk7CgogICAgICAgICAgICAvLyBmb3JjZSBoIG91dCBv\nZiB0aGUgY2FjaGUuIHdlIG1pZ2h0IGhhdmUgdG8gdHJ5IG11bHRpcGxlIHRp\nbWVzCiAgICAgICAgICAgIC8vIGlmIHRoZSBjYWNoZSBpcyBub3QgTFJVCiAg\nICAgICAgICAgIGF0dGVtcHRzID0gMDsKICAgICAgICAgICAgZm9yICg7IGF0\ndGVtcHRzIDwgMTAwICYmIGNhY2hlLmNvbnRhaW5zKGpvaWR3aXRoY2xhc3Mp\nOyBhdHRlbXB0cysrKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBl\nbSA9IGZhY3RvcnkuY3JlYXRlRW50aXR5TWFuYWdlcigpOwogICAgICAgICAg\nICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCA1OyBpKyspCiAgICAgICAgICAg\nICAgICAgICAgZW0uZmluZChSdW50aW1lVGVzdDEuY2xhc3MsIGVtLmdldE9i\namVjdElkKGhlbHBlck9ianNbaV0pKTsKICAgICAgICAgICAgICAgIGVuZEVt\nKGVtKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBhc3NlcnRUcnVlKCJD\nb3VsZCBub3Qga2ljayBxdWVyaWVkIG9iamVjdHMgb3V0IG9mIGNhY2hlIiwK\nICAgICAgICAgICAgICAgIGF0dGVtcHRzIDwgMTAwKTsKCiAgICAgICAgICAg\nIGVtID0gZmFjdG9yeS5jcmVhdGVFbnRpdHlNYW5hZ2VyKCk7CiAgICAgICAg\nICAgIGJyb2tlciA9IEpQQUZhY2FkZUhlbHBlci50b0Jyb2tlcihlbSk7CiAg\nICAgICAgICAgIHEgPSBicm9rZXIubmV3UXVlcnkoSlBRTFBhcnNlci5MQU5H\nX0pQUUwsICJTZWxlY3QgYSBGUk9NICIKICAgICAgICAgICAgICAgICsgQ2Fj\naGVPYmplY3RKLmNsYXNzLmdldFNpbXBsZU5hbWUoKQogICAgICAgICAgICAg\nICAgKyAiIGEgd2hlcmUgYS5zdHIgPSAnaCciKTsKICAgICAgICAgICAgdHJ5\nIHsKICAgICAgICAgICAgICAgIGFzc2VydEluQ2FjaGUocSwgbnVsbCk7CiAg\nICAgICAgICAgIH0KICAgICAgICAgICAgY2F0Y2ggKEFzc2VydGlvbkZhaWxl\nZEVycm9yIGUpIHsKICAgICAgICAgICAgICAgIGJ1Zyg2MjYsICJxdWVyeSBj\nYWNoZSBpbnZhbGlkYXRpb24gaXMgYnJva2VuIik7CiAgICAgICAgICAgIH0K\nCiAgICAgICAgICAgIC8vICMjIyBzaG91bGQgdGVzdCByZW1vdGUgZXZlbnRz\nIGNhdXNpbmcgcXVlcmllcyB0byBldmljdC4KICAgICAgICB9CiAgICAgICAg\nZmluYWxseSB7CiAgICAgICAgICAgIGVuZEVtKGVtKTsKICAgICAgICB9CiAg\nICB9CgogICAgLy8gRklYTUUgU0VldGhhIFNlcCAyNiwyMDA2CiAgICAvLyBu\nb3QgYWJsZSB0byByZXBsYWNlIHBtLm5ld1F1ZXJ5KENhY2hlT2JqZWN0RS5j\nbGFzcyk7CiAgICAvKgogICAgICAqIHB1YmxpYyB2b2lkIHRlc3RBbGxlZ2Vk\nUXVlcnlPcmRlcmluZ0NoYW5nZXMoKSB0aHJvd3MgRXhjZXB0aW9uIHsgLy8K\nICAgICAgKiBpbnNwaXJlZCBieSB0c2MgMzAxMy4gcGNsOiBJIGhhdmUgbm90\nIGJlZW4gYWJsZSB0byBnZXQgdGhpcyAvLyB0ZXN0IGNhc2UKICAgICAgKiB0\nbyBhY3R1YWxseSBmYWlsLiBIb3dldmVyLCBkdXJpbmcgYW5hbHlzaXMgb2Yg\nLy8gMzAxMydzIHN0YWNrIHRyYWNlcywgSQogICAgICAqIGRpc2NvdmVyZWQg\ndGhhdCB0aGUgLy8gUXVlcnlLZXkuZXF1YWxzKCkgbWV0aG9kIGRpZCBub3Qg\nZGVhbCB3aXRoIHRoZQogICAgICAqIG9yZGVyaW5nIC8vIGZpZWxkIGNvcnJl\nY3RseSwgcG9zc2libHkgY2F1c2luZyB0aGUgcHJvYmxlbS4KICAgICAgKgog\nICAgICAqIE9wZW5KUEFFbnRpdHlNYW5hZ2VyIGVtID0gKE9wZW5KUEFFbnRp\ndHlNYW5hZ2VyKQogICAgICAqIGZhY3RvcnkuY3JlYXRlRW50aXR5TWFuYWdl\ncigpOyB0cnkgeyBzdGFydFR4KGVtLAogICAgICAqICgpKTsgQ2FjaGVPYmpl\nY3RFIGUgPSBuZXcgQ2FjaGVPYmplY3RFKCJlIik7IGVtLnBlcnNpc3QoZSk7\nCiAgICAgICogZW5kVHgoZW0pOyB9IGZpbmFsbHkgewogICAgICAqIGVuZEVt\nKGVtKTsgfQogICAgICAqCiAgICAgICogZW0gPSBmYWN0b3J5LmNyZWF0ZUVu\ndGl0eU1hbmFnZXIoKTsgUXVlcnkgcTsgQ29sbGVjdGlvbiBjOyBMaXN0IGw7\nIHRyeSB7CiAgICAgICogcSA9IGVtLmNyZWF0ZVF1ZXJ5KENhY2hlT2JqZWN0\nRS5jbGFzcyk7IHEuc2V0T3JkZXJpbmcoInN0ciBhc2NlbmRpbmciKTsgYyA9\nCiAgICAgICogKENvbGxlY3Rpb24pIHEuZXhlY3V0ZSgpOyBsID0gbmV3IExp\nbmtlZExpc3QoYyk7IGFzc2VydEVxdWFscygxLAogICAgICAqIGMuc2l6ZSgp\nKTsgfSBmaW5hbGx5IHsgZW5kRW0oZW0pOyB9CiAgICAgICoKICAgICAgKiBl\nbSA9IGZhY3RvcnkuY3JlYXRlRW50aXR5TWFuYWdlcigpOyB0cnkgeyBxID0K\nICAgICAgKiBlbS5jcmVhdGVRdWVyeShDYWNoZU9iamVjdEUuY2xhc3MpOyBx\nLnNldE9yZGVyaW5nKCJzdHIgYXNjZW5kaW5nIik7IGMgPQogICAgICAqIChD\nb2xsZWN0aW9uKSBxLmV4ZWN1dGUoKTsgbCA9IG5ldyBMaW5rZWRMaXN0KGMp\nOyBhc3NlcnRFcXVhbHMoMSwKICAgICAgKiBjLnNpemUoKSk7IH0gZmluYWxs\neSB7IGVuZEVtKGVtKTsgfQogICAgICAqCiAgICAgICogdHJ5IHsgZW0gPSBm\nYWN0b3J5LmNyZWF0ZUVudGl0eU1hbmFnZXIoKTsgcSA9CiAgICAgICogZW0u\nY3JlYXRlUXVlcnkoQ2FjaGVPYmplY3RFLmNsYXNzKTsgcS5zZXRPcmRlcmlu\nZygic3RyIGRlc2NlbmRpbmciKTsgYyA9CiAgICAgICogKENvbGxlY3Rpb24p\nIHEuZXhlY3V0ZSgpOyBhc3NlcnRFcXVhbHMoMSwgYy5zaXplKCkpOyBsID0g\nbmV3CiAgICAgICogTGlua2VkTGlzdChjKTsgfSBmaW5hbGx5IHsgZW5kRW0o\nZW0pOyB9IH0KICAgICAgKi8KCiAgICBwdWJsaWMgdm9pZCB0ZXN0QWxsZWdl\nZENvbmN1cnJlbnRNb2RpZmljYXRpb25FeGNlcHRpb24oKSB0aHJvd3MgRXhj\nZXB0aW9uIHsKICAgICAgICBPcGVuSlBBRW50aXR5TWFuYWdlciBlbSA9IChP\ncGVuSlBBRW50aXR5TWFuYWdlcikgZmFjdG9yeQogICAgICAgICAgICAuY3Jl\nYXRlRW50aXR5TWFuYWdlcigpOwogICAgICAgIENhY2hlT2JqZWN0RSBlOwog\nICAgICAgIHRyeSB7CiAgICAgICAgICAgIENsYXNzTWV0YURhdGEgbWV0YSA9\nIEpQQUZhY2FkZUhlbHBlci5nZXRNZXRhRGF0YShlbSwKICAgICAgICAgICAg\nICAgIENhY2hlT2JqZWN0RS5jbGFzcyk7CiAgICAgICAgICAgIGlmICghaXNP\ncGVuSlBBQ2FjaGUobWV0YS5nZXREYXRhQ2FjaGUoKSkpCiAgICAgICAgICAg\nICAgICByZXR1cm47CgogICAgICAgICAgICBzdGFydFR4KGVtKTsKICAgICAg\nICAgICAgZSA9IG5ldyBDYWNoZU9iamVjdEUoImUiKTsKICAgICAgICAgICAg\nZW0ucGVyc2lzdChlKTsKICAgICAgICAgICAgZW5kVHgoZW0pOwogICAgICAg\nIH0KICAgICAgICBmaW5hbGx5IHsKICAgICAgICAgICAgZW5kRW0oZW0pOwog\nICAgICAgIH0KCiAgICAgICAgZW0gPSBmYWN0b3J5LmNyZWF0ZUVudGl0eU1h\nbmFnZXIoKTsKICAgICAgICB0cnkgewogICAgICAgICAgICBzdGFydFR4KGVt\nKTsKCiAgICAgICAgICAgIC8vIGZpbmQgdGhlIG5ldyBvYmplY3QuLi4KICAg\nICAgICAgICAgT3BlbkpQQVF1ZXJ5IHEgPSBlbS5jcmVhdGVRdWVyeSgic2Vs\nZWN0IGEgRlJPTSAiCiAgICAgICAgICAgICAgICArIENhY2hlT2JqZWN0RS5j\nbGFzcy5nZXRTaW1wbGVOYW1lKCkKICAgICAgICAgICAgICAgICsgIiBhIHdo\nZXJlIGEuc3RyID0gJ2UnIik7CiAgICAgICAgICAgIGUgPSAoQ2FjaGVPYmpl\nY3RFKSAoKENvbGxlY3Rpb24pIHEuZ2V0UmVzdWx0TGlzdCgpKS5pdGVyYXRv\ncigpCiAgICAgICAgICAgICAgICAubmV4dCgpOwoKICAgICAgICAgICAgLy8g\nLi4uIGFuZCBtb2RpZnkgdGhlIGNoYW5nZWQgb2JqZWN0LgogICAgICAgICAg\nICBlLnNldFN0cigiZTIiKTsKICAgICAgICAgICAgZS5zZXRTdHIoImUzIik7\nCiAgICAgICAgICAgIGVuZFR4KGVtKTsKICAgICAgICB9CiAgICAgICAgZmlu\nYWxseSB7CiAgICAgICAgICAgIGVuZEVtKGVtKTsKICAgICAgICB9CiAgICB9\nCgogICAgcHJpdmF0ZSBib29sZWFuIGlzT3BlbkpQQUNhY2hlKERhdGFDYWNo\nZSBjYWNoZSkgewogICAgICAgIGlmIChjYWNoZSBpbnN0YW5jZW9mIERlbGVn\nYXRpbmdEYXRhQ2FjaGUpCiAgICAgICAgICAgIGNhY2hlID0gKChEZWxlZ2F0\naW5nRGF0YUNhY2hlKSBjYWNoZSkuZ2V0SW5uZXJtb3N0RGVsZWdhdGUoKTsK\nCiAgICAgICAgcmV0dXJuIGNhY2hlIGluc3RhbmNlb2YgQ29uY3VycmVudERh\ndGFDYWNoZTsKICAgIH0KCiAgICAvLyAtLS0tLS0tLS0tIHV0aWxpdHkgbWV0\naG9kcyAtLS0tLS0tLS0tCgogICAgcHJpdmF0ZSB2b2lkIGNoZWNrQ2FjaGUo\nRGF0YUNhY2hlIGNhY2hlLCBPYmplY3RbXSBpZHMsIGJvb2xlYW5bXSBzdGF0\naSkgewogICAgICAgIENhY2hlVGVzdEhlbHBlci5jaGVja0NhY2hlKHRoaXMs\nIGNhY2hlLCBpZHMsIHN0YXRpKTsKICAgIH0KCiAgICBwcml2YXRlIHZvaWQg\nYXNzZXJ0SW5DYWNoZShvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLlF1ZXJ5\nIHEsCiAgICAgICAgQm9vbGVhbiBpbkNhY2hlKSB7CiAgICAgICAgQ2FjaGVU\nZXN0SGVscGVyLmFzc2VydEluQ2FjaGUodGhpcywgcSwgaW5DYWNoZSk7CiAg\nICB9CgogICAgcHJpdmF0ZSB2b2lkIGFzc2VydEluQ2FjaGUob3JnLmFwYWNo\nZS5vcGVuanBhLmtlcm5lbC5RdWVyeSBxLAogICAgICAgIEJvb2xlYW4gaW5D\nYWNoZSwgT2JqZWN0W10gYXJncykgewogICAgICAgIENhY2hlVGVzdEhlbHBl\nci5hc3NlcnRJbkNhY2hlKHRoaXMsIHEsIGluQ2FjaGUsIGFyZ3MpOwogICAg\nfQoKICAgIHByaXZhdGUgdm9pZCBpdGVyYXRlKENvbGxlY3Rpb24gYykgewog\nICAgICAgIENhY2hlVGVzdEhlbHBlci5pdGVyYXRlKGMpOwogICAgfQoKICAg\nIHB1YmxpYyB2b2lkIHRlc3RJbnRlcmZhY2UoKSB0aHJvd3MgRXhjZXB0aW9u\nIHsKICAgICAgICBPcGVuSlBBRW50aXR5TWFuYWdlciBuZXdFbSA9CiAgICAg\nICAgICAgIChPcGVuSlBBRW50aXR5TWFuYWdlcikgZmFjdG9yeS5jcmVhdGVF\nbnRpdHlNYW5hZ2VyKCk7CiAgICAgICAgc3RhcnRUeChuZXdFbSk7CiAgICAg\nICAgQ2FjaGVPYmplY3RBIGEgPSAoQ2FjaGVPYmplY3RBKSBuZXdFbS5maW5k\nKENhY2hlT2JqZWN0QS5jbGFzcywgb2lkKTsKICAgICAgICBDYWNoZU9iamVj\ndEMgYyA9IG5ldyBDYWNoZU9iamVjdEMoImJsYWgiKTsKICAgICAgICBhLnNl\ndFJlbGF0ZWRJbnRlcmZhY2UoYyk7CiAgICAgICAgZW5kVHgobmV3RW0pOwog\nICAgICAgIE9iamVjdCBjSWQgPSBuZXdFbS5nZXRPYmplY3RJZChjKTsKICAg\nICAgICBlbmRFbShuZXdFbSk7CgogICAgICAgIG5ld0VtID0gKE9wZW5KUEFF\nbnRpdHlNYW5hZ2VyKSBmYWN0b3J5LmNyZWF0ZUVudGl0eU1hbmFnZXIoKTsK\nICAgICAgICBhID0gKENhY2hlT2JqZWN0QSkgbmV3RW0uZmluZChDYWNoZU9i\namVjdEEuY2xhc3MsIG9pZCk7CgogICAgICAgIENhY2hlT2JqZWN0SW50ZXJm\nYWNlIGMyID0gYS5nZXRSZWxhdGVkSW50ZXJmYWNlKCk7CiAgICAgICAgYXNz\nZXJ0Tm90TnVsbChjMik7CgogICAgICAgIGFzc2VydEVxdWFscyhjSWQsIG5l\nd0VtLmdldE9iamVjdElkKGMyKSk7CiAgICB9CgogICAgcHVibGljIHZvaWQg\ndGVzdFF1ZXJpZXNPbkNvbGxlY3Rpb25zRG9udFVzZUNhY2hlKCkgewogICAg\nICAgIE9wZW5KUEFFbnRpdHlNYW5hZ2VyIGVtID0gKE9wZW5KUEFFbnRpdHlN\nYW5hZ2VyKSBmYWN0b3J5CiAgICAgICAgICAgIC5jcmVhdGVFbnRpdHlNYW5h\nZ2VyKCk7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgc3RhcnRUeChlbSk7\nCiAgICAgICAgICAgIENhY2hlT2JqZWN0RSBlID0gbmV3IENhY2hlT2JqZWN0\nRSgiZSIpOwogICAgICAgICAgICBlbS5wZXJzaXN0KGUpOwogICAgICAgICAg\nICBlbmRUeChlbSk7CiAgICAgICAgfQogICAgICAgIGZpbmFsbHkgewogICAg\nICAgICAgICBlbmRFbShlbSk7CiAgICAgICAgfQoKICAgICAgICBlbSA9IChP\ncGVuSlBBRW50aXR5TWFuYWdlcikgZmFjdG9yeS5jcmVhdGVFbnRpdHlNYW5h\nZ2VyKCk7CiAgICAgICAgT3BlbkpQQVF1ZXJ5IHE7CiAgICAgICAgQ29sbGVj\ndGlvbiBjOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIHEgPSBlbS5jcmVh\ndGVRdWVyeSgic2VsZWN0IGEgRlJPTSAiCiAgICAgICAgICAgICAgICArIENh\nY2hlT2JqZWN0RS5jbGFzcy5nZXRTaW1wbGVOYW1lKCkKICAgICAgICAgICAg\nICAgICsgIiBhIHdoZXJlIGEuc3RyID0gJ2UnIik7CiAgICAgICAgICAgIGMg\nPSBuZXcgQXJyYXlMaXN0KChDb2xsZWN0aW9uKSBxLmdldFJlc3VsdExpc3Qo\nKSk7CiAgICAgICAgICAgIGFzc2VydEVxdWFscygxLCBjLnNpemUoKSk7CiAg\nICAgICAgICAgIHEuY2xvc2VBbGwoKTsKICAgICAgICB9CiAgICAgICAgZmlu\nYWxseSB7CiAgICAgICAgICAgIGVuZEVtKGVtKTsKICAgICAgICB9CgogICAg\nICAgIHRyeSB7CiAgICAgICAgICAgIGVtID0gKE9wZW5KUEFFbnRpdHlNYW5h\nZ2VyKSBmYWN0b3J5LmNyZWF0ZUVudGl0eU1hbmFnZXIoKTsKICAgICAgICAg\nICAgcSA9IGVtLmNyZWF0ZVF1ZXJ5KCJzZWxlY3QgYSBGUk9NICIKICAgICAg\nICAgICAgICAgICsgQ2FjaGVPYmplY3RFLmNsYXNzLmdldFNpbXBsZU5hbWUo\nKQogICAgICAgICAgICAgICAgKyAiIGEgd2hlcmUgYS5zdHIgPSAnZSciKTsK\nICAgICAgICAgICAgcS5zZXRDYW5kaWRhdGVDb2xsZWN0aW9uKG5ldyBBcnJh\neUxpc3QoMCkpOwogICAgICAgICAgICBjID0gKENvbGxlY3Rpb24pIHEuZ2V0\nUmVzdWx0TGlzdCgpOwogICAgICAgICAgICBhc3NlcnRFcXVhbHMoMCwgYy5z\naXplKCkpOwogICAgICAgICAgICBxLmNsb3NlQWxsKCk7CiAgICAgICAgfQog\nICAgICAgIGZpbmFsbHkgewogICAgICAgICAgICBlbmRFbShlbSk7CiAgICAg\nICAgfQogICAgfQoKICAgIHB1YmxpYyB2b2lkIHRlc3RERkdGaWVsZHNMb2Fk\nZWQxKCkgewogICAgICAgIGRmZ0ZpZWxkc0xvYWRlZEhlbHBlcihmYWxzZSk7\nCiAgICB9CgogICAgcHVibGljIHZvaWQgdGVzdERGR0ZpZWxkc0xvYWRlZDIo\nKSB7CiAgICAgICAgZGZnRmllbGRzTG9hZGVkSGVscGVyKHRydWUpOwogICAg\nfQoKICAgIHB1YmxpYyB2b2lkIGRmZ0ZpZWxkc0xvYWRlZEhlbHBlcihib29s\nZWFuIHJlbGF0ZWQpIHsKICAgICAgICBPcGVuSlBBRW50aXR5TWFuYWdlciBl\nbSA9IChPcGVuSlBBRW50aXR5TWFuYWdlcikgZmFjdG9yeQogICAgICAgICAg\nICAuY3JlYXRlRW50aXR5TWFuYWdlcigpOwogICAgICAgIHN0YXJ0VHgoZW0p\nOwogICAgICAgIE9wZW5KUEFRdWVyeSBxOwogICAgICAgIENvbGxlY3Rpb24g\nYzsKICAgICAgICB0cnkgewoKICAgICAgICAgICAgcSA9IGVtLmNyZWF0ZVF1\nZXJ5KAogICAgICAgICAgICAgICAgInNlbGVjdCBhIEZST00gIiArIENhY2hl\nT2JqZWN0QS5jbGFzcy5nZXRTaW1wbGVOYW1lKCkKICAgICAgICAgICAgICAg\nICAgICArICIgYSB3aGVyZSBhLm5hbWUgPSA6cE5hbWUiKS5zZXRQYXJhbWV0\nZXIoInBOYW1lIiwKICAgICAgICAgICAgICAgIE9SSUdfTkFNRSk7CgogICAg\nICAgICAgICBjID0gbmV3IEFycmF5TGlzdCgoQ29sbGVjdGlvbikgcS5nZXRS\nZXN1bHRMaXN0KCkpOwogICAgICAgICAgICBhc3NlcnRFcXVhbHMoMSwgYy5z\naXplKCkpOwogICAgICAgICAgICBDYWNoZU9iamVjdEEgYSA9IChDYWNoZU9i\namVjdEEpIGMuaXRlcmF0b3IoKS5uZXh0KCk7CiAgICAgICAgICAgIGlmIChy\nZWxhdGVkKQogICAgICAgICAgICAgICAgYS5nZXRSZWxhdGVkQXJyYXkoKTsK\nICAgICAgICAgICAgZW0uZGV0YWNoKGEpOwogICAgICAgICAgICBhc3NlcnRF\ncXVhbHMoT1JJR19OQU1FLCBhLmdldE5hbWUoKSk7CiAgICAgICAgICAgIHEu\nY2xvc2VBbGwoKTsKICAgICAgICB9CiAgICAgICAgZmluYWxseSB7CiAgICAg\nICAgICAgIHJvbGxiYWNrVHgoZW0pOwogICAgICAgICAgICBlbmRFbShlbSk7\nCiAgICAgICAgfQogICAgfQoKICAgIC8vIEZJWE1FIFNlZXRoYSBTZXAgMjYs\nMjAwNgogICAgLyoKICAgICAgKiBwdWJsaWMgdm9pZCB0ZXN0UXVlcmllc0Fm\ndGVyTW9kaWZpY2F0aW9uQXJlTm90SW5DYWNoZSgpIHsKICAgICAgKiBPcGVu\nSlBBRW50aXR5TWFuYWdlciBlbSA9IChPcGVuSlBBRW50aXR5TWFuYWdlcikK\nICAgICAgKiBmYWN0b3J5LmNyZWF0ZUVudGl0eU1hbmFnZXIoKTsgT3BlbkpQ\nQUVudGl0eU1hbmFnZXIgZW0yID0KICAgICAgKiAoT3BlbkpQQUVudGl0eU1h\nbmFnZXIpIGZhY3RvcnkuY3JlYXRlRW50aXR5TWFuYWdlcigpOwogICAgICAq\nCiAgICAgICogLy9GSVhNRSBTZWV0aGEgU2VwIDI2LDIwMDYgLy9lbS5zZXRJ\nZ25vcmVDYWNoZShmYWxzZSk7CiAgICAgICogLy9lbTIuc2V0SWdub3JlQ2Fj\naGUoZmFsc2UpOyAoKEZldGNoUGxhbikgZW0uZ2V0RmV0Y2hQbGFuKCkpLgog\nICAgICAqIHNldEZsdXNoQmVmb3JlUXVlcmllcyhGZXRjaFBsYW4uRkxVU0hf\nVFJVRSk7ICgoRmV0Y2hQbGFuKQogICAgICAqIGVtMi5nZXRGZXRjaFBsYW4o\nKSkuIHNldEZsdXNoQmVmb3JlUXVlcmllcyhGZXRjaFBsYW4uRkxVU0hfVFJV\nRSk7CiAgICAgICoKICAgICAgKiB0cnkgeyBzdGFydFR4KGVtKTsgQ2FjaGVP\nYmplY3RFIGUgPSBuZXcKICAgICAgKiBDYWNoZU9iamVjdEUoImUiKTsgZW0u\ncGVyc2lzdChlKTsgZW5kVHgoZW0sCiAgICAgICogKCkpOwogICAgICAqCiAg\nICAgICogc3RhcnRUeChlbSk7CiAgICAgICogIC8vIGZpcnN0LCBhIHF1ZXJ5\nIHRoYXQgc2hvdWxkIGdldCBpbnRvIHRoZSBjYWNoZS4gQnJva2VyIGJyb2tl\nciA9CiAgICAgICogSlBBRmFjYWRlSGVscGVyLnRvQnJva2VyKGVtKTsgb3Jn\nLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5RdWVyeSBxID0KICAgICAgKiBicm9r\nZXIubmV3UXVlcnkoSlBRTFBhcnNlci5MQU5HX0pQUUwsIENhY2hlT2JqZWN0\nRS5jbGFzcywgInN0ciA9PQogICAgICAqIFwiZVwiIik7IENvbGxlY3Rpb24g\nYyA9IChDb2xsZWN0aW9uKSBxLmV4ZWN1dGUoKTsgZm9yIChJdGVyYXRvciBp\ndGVyID0KICAgICAgKiBjLml0ZXJhdG9yKCk7IGl0ZXIuaGFzTmV4dCgpOykg\naXRlci5uZXh0KCk7CiAgICAgICoKICAgICAgKiBhc3NlcnRFcXVhbHMoMSwg\nYy5zaXplKCkpOyBhc3NlcnRJbkNhY2hlKHEsIEJvb2xlYW4uVFJVRSk7CiAg\nICAgICoKICAgICAgKiBCcm9rZXIgYnJva2VyMiA9IEpQQUZhY2FkZUhlbHBl\nci50b0Jyb2tlcihlbTIpOwogICAgICAqIG9yZy5hcGFjaGUub3BlbmpwYS5r\nZXJuZWwuUXVlcnkgcTIgPSBicm9rZXIyLm5ld1F1ZXJ5KHEuZ2V0TGFuZ3Vh\nZ2UoKSwKICAgICAgKiBxKTsKICAgICAgKiAgLy8gbWFrZSBzb21lIG1vZGlm\naWNhdGlvbnMgYW5kIGxvb2sgYWdhaW4uIFNob3VsZCByZXR1cm4gLy8gdHdv\nIHJlc3VsdHMuCiAgICAgICogZSA9IG5ldyBDYWNoZU9iamVjdEUoImUiKTsg\nZW0ucGVyc2lzdChlKTsKICAgICAgKgogICAgICAqIHEgPSBicm9rZXIubmV3\nUXVlcnkoSlBRTFBhcnNlci5MQU5HX0pQUUwsIENhY2hlT2JqZWN0RS5jbGFz\ncywgInN0ciA9PQogICAgICAqIFwiZVwiIik7IGMgPSAoQ29sbGVjdGlvbikg\ncS5leGVjdXRlKCk7IGFzc2VydEVxdWFscygyLCBjLnNpemUoKSk7IGZvcgog\nICAgICAqIChJdGVyYXRvciBpdGVyID0gYy5pdGVyYXRvcigpOyBpdGVyLmhh\nc05leHQoKTspIGl0ZXIubmV4dCgpOwogICAgICAqICAvLyBvcmlnaW5hbCBx\ndWVyeSBzaG91bGQgc3RpbGwgYmUgaW4gY2FjaGUgYXNzZXJ0SW5DYWNoZShx\nMiwKICAgICAgKiBCb29sZWFuLlRSVUUpOwogICAgICAqCiAgICAgICogQ29s\nbGVjdGlvbiBjMiA9IChDb2xsZWN0aW9uKSBxMi5leGVjdXRlKCk7IGFzc2Vy\ndEVxdWFscygxLCBjMi5zaXplKCkpOwogICAgICAqICAvLyBuZXcgcXVlcnkg\nc2hvdWxkIG5vdCBtYWtlIGl0IGludG8gY2FjaGUKICAgICAgKgogICAgICAq\nIHEgPSBicm9rZXIgLm5ld1F1ZXJ5KEpQUUxQYXJzZXIuTEFOR19KUFFMLCBD\nYWNoZU9iamVjdEUuY2xhc3MsIG51bGwpOyBjID0KICAgICAgKiAoQ29sbGVj\ndGlvbikgcS5leGVjdXRlKCk7IGFzc2VydEVxdWFscygyLCBjLnNpemUoKSk7\nIGZvciAoSXRlcmF0b3IgaXRlciA9CiAgICAgICogYy5pdGVyYXRvcigpOyBp\ndGVyLmhhc05leHQoKTspIGl0ZXIubmV4dCgpOwogICAgICAqCiAgICAgICog\nYXNzZXJ0SW5DYWNoZShxLCBCb29sZWFuLkZBTFNFKTsgfSBmaW5hbGx5IHsK\nICAgICAgKiByb2xsYmFja1R4KGVtKTsKICAgICAgKiBlbmRFbShlbSk7CiAg\nICAgICogZW5kRW0oZW0yKTsgfSB9CiAgICAgICovCgogICAgcHVibGljIHZv\naWQgdGVzdENhY2hlZFF1ZXJ5Q2xvc3VyZVJlbGVhc2VzUmVzb3VyY2VzKCkg\newogICAgICAgIC8vIFBlcnNpc3RlbmNlTWFuYWdlckZhY3RvcnkgZmFjdG9y\neSA9CiAgICAgICAgLy8gS29kb0hlbHBlci5jcmVhdGVFbnRpdHlNYW5hZ2Vy\nRmFjdG9yeSAoKTsKICAgICAgICBFbnRpdHlNYW5hZ2VyIGluaXRFbSA9IGZh\nY3RvcnkuY3JlYXRlRW50aXR5TWFuYWdlcigpOwogICAgICAgIHN0YXJ0VHgo\naW5pdEVtKTsKICAgICAgICBDYWNoZU9iamVjdEUgZSA9IG5ldyBDYWNoZU9i\namVjdEUoImUiKTsKICAgICAgICBpbml0RW0ucGVyc2lzdChlKTsKICAgICAg\nICBlbmRUeChpbml0RW0pOwogICAgICAgIGVuZEVtKGluaXRFbSk7CgogICAg\nICAgIEJyb2tlciBicm9rZXIgPSBKUEFGYWNhZGVIZWxwZXIudG9Ccm9rZXJG\nYWN0b3J5KGZhY3RvcnkpLm5ld0Jyb2tlcigpOwogICAgICAgIG9yZy5hcGFj\naGUub3BlbmpwYS5rZXJuZWwuUXVlcnkgcSA9IGJyb2tlci5uZXdRdWVyeSgK\nICAgICAgICAgICAgSlBRTFBhcnNlci5MQU5HX0pQUUwsICJTZWxlY3QgYSBG\nUk9NICIKICAgICAgICAgICAgKyBDYWNoZU9iamVjdEUuY2xhc3MuZ2V0U2lt\ncGxlTmFtZSgpCiAgICAgICAgICAgICsgIiBhIHdoZXJlIGEuc3RyID0gJ2Un\nIik7CiAgICAgICAgQ29sbGVjdGlvbiBjID0gKENvbGxlY3Rpb24pIHEuZXhl\nY3V0ZSgpOwogICAgICAgIGZvciAoSXRlcmF0b3IgaXRlciA9IGMuaXRlcmF0\nb3IoKTsgaXRlci5oYXNOZXh0KCk7KQogICAgICAgICAgICBpdGVyLm5leHQo\nKTsKCiAgICAgICAgYXNzZXJ0RXF1YWxzKDEsIGMuc2l6ZSgpKTsKICAgICAg\nICBhc3NlcnRJbkNhY2hlKHEsIEJvb2xlYW4uVFJVRSk7CgogICAgICAgIElt\ncGxIZWxwZXIuY2xvc2UoYyk7CgogICAgICAgIGJyb2tlci5jbG9zZSgpOwog\nICAgfQoKICAgIHB1YmxpYyB2b2lkIHRlc3RNdXRhYmxlU0NPc0FyZUNvbnZl\ncnRlZCgpIHsKICAgICAgICBPcGVuSlBBRW50aXR5TWFuYWdlciBlbTAgPSAo\nT3BlbkpQQUVudGl0eU1hbmFnZXIpIGZhY3RvcnkKICAgICAgICAgICAgLmNy\nZWF0ZUVudGl0eU1hbmFnZXIoKTsKICAgICAgICBPcGVuSlBBRW50aXR5TWFu\nYWdlciBlbTEgPSAoT3BlbkpQQUVudGl0eU1hbmFnZXIpIGZhY3RvcnkKICAg\nICAgICAgICAgLmNyZWF0ZUVudGl0eU1hbmFnZXIoKTsKCiAgICAgICAgc3Rh\ncnRUeChlbTApOwogICAgICAgIENhY2hlT2JqZWN0QSBhID0gKENhY2hlT2Jq\nZWN0QSkgZW0wLmZpbmQoQ2FjaGVPYmplY3RBLmNsYXNzLCBvaWQpOwoKICAg\nICAgICBEYXRlIGQgPSBuZXcgRGF0ZSgpOwogICAgICAgIGEuc2V0RGF0ZShk\nKTsKCiAgICAgICAgZW5kVHgoZW0wKTsKICAgICAgICBEYXRhQ2FjaGUgY2Fj\naGUgPSBjYWNoZU1hbmFnZXIoZmFjdG9yeSkuZ2V0RGF0YUNhY2hlKAogICAg\nICAgICAgICBEYXRhQ2FjaGUuTkFNRV9ERUZBVUxULCBmYWxzZSk7CiAgICAg\nICAgYXNzZXJ0VHJ1ZShjYWNoZS5jb250YWlucyhvaWR3aXRoY2xhc3MpKTsK\nICAgICAgICBjYWNoZS5yZW1vdmUob2lkd2l0aGNsYXNzKTsKCiAgICAgICAg\nYSA9IChDYWNoZU9iamVjdEEpIGVtMS5maW5kKENhY2hlT2JqZWN0QS5jbGFz\ncywgb2lkKTsKICAgICAgICBhc3NlcnRUcnVlKGNhY2hlLmNvbnRhaW5zKG9p\nZHdpdGhjbGFzcykpOwoKICAgICAgICB0cnkgewogICAgICAgICAgICBQQ0Rh\ndGEgZGF0YSA9IGNhY2hlLmdldChvaWR3aXRoY2xhc3MpOwogICAgICAgICAg\nICBDbGFzc01ldGFEYXRhIG1ldGEgPQogICAgICAgICAgICAgICAgKChPcGVu\nSlBBRW50aXR5TWFuYWdlckZhY3RvcnlTUEkpIE9wZW5KUEFQZXJzaXN0ZW5j\nZQogICAgICAgICAgICAgICAgICAgIC5jYXN0KGZhY3RvcnkpKS5nZXRDb25m\naWd1cmF0aW9uKCkKICAgICAgICAgICAgICAgICAgICAuZ2V0TWV0YURhdGFS\nZXBvc2l0b3J5SW5zdGFuY2UoKS5nZXRNZXRhRGF0YShhLmdldENsYXNzKCks\nCiAgICAgICAgICAgICAgICAgICAgbnVsbCwgZmFsc2UpOwogICAgICAgICAg\nICBGaWVsZE1ldGFEYXRhIGZtZCA9IG1ldGEuZ2V0RmllbGQoImRhdGUiKTsK\nICAgICAgICAgICAgZCA9IChEYXRlKSBkYXRhLmdldERhdGEoZm1kLmdldElu\nZGV4KCkpOwogICAgICAgICAgICBCcm9rZXIgYnJva2VyID0gSlBBRmFjYWRl\nSGVscGVyLnRvQnJva2VyKGVtMSk7CiAgICAgICAgICAgIE9wZW5KUEFTdGF0\nZU1hbmFnZXIgc20gPSBicm9rZXIuZ2V0U3RhdGVNYW5hZ2VyKGEpOwogICAg\nICAgICAgICBhc3NlcnRUcnVlKHNtID09ICgoUHJveHlEYXRlKSBhLmdldERh\ndGUoKSkuZ2V0T3duZXIoKSk7CiAgICAgICAgICAgIGFzc2VydEVxdWFscyhE\nYXRlLmNsYXNzLCBkLmdldENsYXNzKCkpOwogICAgICAgIH0KICAgICAgICBm\naW5hbGx5IHsKICAgICAgICAgICAgZW5kRW0oZW0wKTsKICAgICAgICAgICAg\nZW5kRW0oZW0xKTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGljIHZvaWQg\ndGVzdEVtcHR5UmVzdWx0c0FyZUNhY2hlZCgpIHsKICAgICAgICBCcm9rZXIg\nYnJva2VyID0gSlBBRmFjYWRlSGVscGVyLnRvQnJva2VyRmFjdG9yeShmYWN0\nb3J5KS5uZXdCcm9rZXIoKTsKICAgICAgICBvcmcuYXBhY2hlLm9wZW5qcGEu\na2VybmVsLlF1ZXJ5IHEgPSBicm9rZXIubmV3UXVlcnkoCiAgICAgICAgICAg\nIEpQUUxQYXJzZXIuTEFOR19KUFFMLCAiU2VsZWN0IGEgRlJPTSAiCiAgICAg\nICAgICAgICsgQ2FjaGVPYmplY3RBQ2hpbGQxLmNsYXNzLmdldFNpbXBsZU5h\nbWUoKQogICAgICAgICAgICArICIgYSB3aGVyZSBhLm5hbWUgPSAndGVzdEVt\ncHR5UmVzdWx0c0FyZUNhY2hlZCciKTsKICAgICAgICBDb2xsZWN0aW9uIGMg\nPSAoQ29sbGVjdGlvbikgcS5leGVjdXRlKCk7CiAgICAgICAgYXNzZXJ0RXF1\nYWxzKDAsIGMuc2l6ZSgpKTsKICAgICAgICBhc3NlcnRJbkNhY2hlKHEsIEJv\nb2xlYW4uVFJVRSk7CiAgICAgICAgYnJva2VyLmNsb3NlKCk7CiAgICB9Cgog\nICAgcHJpdmF0ZSB2b2lkIGRvYXNzZXJ0VHJ1ZShFbnRpdHlNYW5hZ2VyIGVt\nLCBTdHJpbmcgbmFtZSwgaW50IGFnZSkKICAgICAgICB0aHJvd3MgRXhjZXB0\naW9uIHsKICAgICAgICBDYWNoZU9iamVjdEEgYSA9IChDYWNoZU9iamVjdEEp\nIGVtLmZpbmQoQ2FjaGVPYmplY3RBLmNsYXNzLCBvaWQpOwogICAgICAgIGFz\nc2VydFRydWUobmFtZS5lcXVhbHMoYS5nZXROYW1lKCkpKTsKICAgICAgICBh\nc3NlcnRUcnVlKGEuZ2V0QWdlKCkgPT0gYWdlKTsKICAgICAgICBlbmRFbShl\nbSk7CiAgICB9CgogICAgcHJpdmF0ZSB2b2lkIGFzc2VydE5ldyhDYWNoZU9i\namVjdEEgYSkgewogICAgICAgIGFzc2VydFRydWUoTkVXX05BTUUuZXF1YWxz\nKGEuZ2V0TmFtZSgpKSk7CiAgICAgICAgYXNzZXJ0VHJ1ZShPUklHX0FHRSA9\nPSBhLmdldEFnZSgpKTsKICAgIH0KCiAgICBwcml2YXRlIHZvaWQgYXNzZXJ0\nT2xkKENhY2hlT2JqZWN0QSBhKSB7CiAgICAgICAgYXNzZXJ0VHJ1ZShPUklH\nX05BTUUuZXF1YWxzKGEuZ2V0TmFtZSgpKSk7CiAgICAgICAgYXNzZXJ0VHJ1\nZShPUklHX0FHRSA9PSBhLmdldEFnZSgpKTsKICAgIH0KCiAgICBwcml2YXRl\nIERhdGFDYWNoZU1hbmFnZXIgY2FjaGVNYW5hZ2VyKE9wZW5KUEFFbnRpdHlN\nYW5hZ2VyRmFjdG9yeSBmYWN0b3J5KSB7CiAgICAgICAgcmV0dXJuIENhY2hl\nVGVzdEhlbHBlcgogICAgICAgICAgICAuY2FjaGVNYW5hZ2VyKEpQQUZhY2Fk\nZUhlbHBlci50b0Jyb2tlckZhY3RvcnkoZmFjdG9yeSkpOwogICAgfQoKICAg\nIHByaXZhdGUgdm9pZCBjbG9zZShFbnRpdHlNYW5hZ2VyIGVtKSB7CiAgICAg\nICAgcm9sbGJhY2tUeChlbSk7CiAgICAgICAgZW5kRW0oZW0pOwogICAgfQoK\nICAgIHByaXZhdGUgdm9pZCBjbG9zZShCcm9rZXIgYnJva2VyKSB7CiAgICAg\nICAgaWYgKGJyb2tlci5pc0FjdGl2ZSgpKQogICAgICAgICAgICBicm9rZXIu\ncm9sbGJhY2soKTsKICAgICAgICBicm9rZXIuY2xvc2UoKTsKICAgIH0KCiAg\nICBwdWJsaWMgc3RhdGljIHZvaWQgbWFpbihTdHJpbmdbXSBhcmdzKSB0aHJv\nd3MgRXhjZXB0aW9uIHsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGFy\nZ3MubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgU3RyaW5nIHR5cGUgPSBh\ncmdzW2ldOwoKICAgICAgICAgICAgQ2FjaGVUZXN0IGM7CiAgICAgICAgICAg\nIGlmICh0eXBlLmVxdWFscygidGNwIikpIHsKICAgICAgICAgICAgICAgIGMg\nPSBuZXcgRGlzdHJpYnV0ZWRDYWNoZVRlc3QoInRpbWUgdGVzdCIsCiAgICAg\nICAgICAgICAgICAgICAgQ29uY3VycmVudERhdGFDYWNoZS5jbGFzcyk7CiAg\nICAgICAgICAgIH0gZWxzZSBpZiAodHlwZS5lcXVhbHMoImptcyIpKSB7CiAg\nICAgICAgICAgICAgICBjID0gbmV3IERpc3RyaWJ1dGVkQ2FjaGVUZXN0KCJ0\naW1lIHRlc3QiLAogICAgICAgICAgICAgICAgICAgIENvbmN1cnJlbnREYXRh\nQ2FjaGUuY2xhc3MpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAg\nICAgICAgYyA9IG5ldyBUZXN0TG9jYWxDYWNoZSgidGltZSB0ZXN0Iik7CiAg\nICAgICAgICAgIH0KCiAgICAgICAgICAgIGMuc2V0VXAoKTsKICAgICAgICAg\nICAgbG9uZyBzdGFydCA9IFN5c3RlbS5jdXJyZW50VGltZU1pbGxpcygpOwog\nICAgICAgICAgICBpbnQgY291bnQgPSAxMDAwOwogICAgICAgICAgICBmb3Ig\nKGludCBqID0gMDsgaiA8IGNvdW50OyBqKyspIHsKICAgICAgICAgICAgICAg\nIGMuZG9hc3NlcnRUcnVlKGMuZmFjdG9yeS5jcmVhdGVFbnRpdHlNYW5hZ2Vy\nKCksIE5FV19OQU1FLAogICAgICAgICAgICAgICAgICAgIE9SSUdfQUdFKTsK\nICAgICAgICAgICAgfQogICAgICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4o\nY291bnQgKyAiIGl0ZXJhdGlvbnMgaW4gIgogICAgICAgICAgICAgICAgKyAo\nU3lzdGVtLmN1cnJlbnRUaW1lTWlsbGlzKCkgLSBzdGFydCkgKyAiIG1pbGxp\ncyIpOwogICAgICAgICAgICBjLnRlYXJEb3duKCk7CiAgICAgICAgfQogICAg\nfQp9Cg==\n","encoding":"base64"}

