{"sha":"d800ec33b215895d0d4ebbbcaa9da3e93bd64e56","node_id":"MDQ6QmxvYjIwNjM2NDpkODAwZWMzM2IyMTU4OTVkMGQ0ZWJiYmNhYTlkYTNlOTNiZDY0ZTU2","size":6663,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/d800ec33b215895d0d4ebbbcaa9da3e93bd64e56","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuZGF0YWNh\nY2hlOwoKaW1wb3J0IGphdmEuc3FsLkNvbm5lY3Rpb247CmltcG9ydCBqYXZh\nLnNxbC5QcmVwYXJlZFN0YXRlbWVudDsKaW1wb3J0IGphdmEuc3FsLlNRTEV4\nY2VwdGlvbjsKaW1wb3J0IGphdmF4LnBlcnNpc3RlbmNlLkVudGl0eU1hbmFn\nZXI7CmltcG9ydCBqYXZheC5wZXJzaXN0ZW5jZS5Sb2xsYmFja0V4Y2VwdGlv\nbjsKaW1wb3J0IGphdmF4LnBlcnNpc3RlbmNlLkxvY2tNb2RlVHlwZTsKaW1w\nb3J0IGphdmF4LnNxbC5EYXRhU291cmNlOwoKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS5wZXJzaXN0ZW5jZS5PcGVuSlBBUGVyc2lzdGVuY2U7CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuT3BlbkpQQUVudGl0\neU1hbmFnZXJGYWN0b3J5U1BJOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLnBlcnNpc3RlbmNlLkpQQUZhY2FkZUhlbHBlcjsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5wZXJzaXN0ZW5jZS50ZXN0LlNpbmdsZUVNRlRlc3RDYXNl\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmV2ZW50LlJlbW90ZUNvbW1p\ndExpc3RlbmVyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmV2ZW50LlJl\nbW90ZUNvbW1pdEV2ZW50OwoKcHVibGljIGNsYXNzIFRlc3REYXRhQ2FjaGVP\ncHRpbWlzdGljTG9ja1JlY292ZXJ5CiAgICBleHRlbmRzIFNpbmdsZUVNRlRl\nc3RDYXNlIHsKCiAgICBwcml2YXRlIGludCBwazsKICAgIHByaXZhdGUgaW50\nIHJlbW90ZUNvbW1pdEV2ZW50U3RhbGVDb3VudCA9IDA7CiAgICBwcml2YXRl\nIE9iamVjdCBzdGFsZU9pZDsKCiAgICBwdWJsaWMgdm9pZCBzZXRVcCgpIHsK\nICAgICAgICBzZXRVcCgib3BlbmpwYS5EYXRhQ2FjaGUiLCAidHJ1ZSIsCiAg\nICAgICAgICAgICJvcGVuanBhLlJlbW90ZUNvbW1pdFByb3ZpZGVyIiwgInNq\ndm0iLAogICAgICAgICAgICBPcHRpbWlzdGljTG9ja0luc3RhbmNlLmNsYXNz\nKTsKCiAgICAgICAgZW1mLmdldENvbmZpZ3VyYXRpb24oKS5nZXRSZW1vdGVD\nb21taXRFdmVudE1hbmFnZXIoKS5hZGRMaXN0ZW5lcigKICAgICAgICAgICAg\nbmV3IFJlbW90ZUNvbW1pdExpc3RlbmVyKCkgewogICAgICAgICAgICAgICAg\ncHVibGljIHZvaWQgYWZ0ZXJDb21taXQoUmVtb3RlQ29tbWl0RXZlbnQgZSkg\newogICAgICAgICAgICAgICAgICAgIGlmIChlLmdldFBheWxvYWRUeXBlKCkg\nPT0KICAgICAgICAgICAgICAgICAgICAgICAgUmVtb3RlQ29tbWl0RXZlbnQu\nUEFZTE9BRF9MT0NBTF9TVEFMRV9ERVRFQ1RJT04pIHsKICAgICAgICAgICAg\nICAgICAgICAgICAgcmVtb3RlQ29tbWl0RXZlbnRTdGFsZUNvdW50Kys7CiAg\nICAgICAgICAgICAgICAgICAgICAgIHN0YWxlT2lkID0gZS5nZXRVcGRhdGVk\nT2JqZWN0SWRzKCkuaXRlcmF0b3IoKS5uZXh0KCk7CiAgICAgICAgICAgICAg\nICAgICAgfQogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHB1\nYmxpYyB2b2lkIGNsb3NlKCkgewogICAgICAgICAgICAgICAgfQogICAgICAg\nICAgICB9CiAgICAgICAgKTsKCiAgICAgICAgRW50aXR5TWFuYWdlciBlbSA9\nIGVtZi5jcmVhdGVFbnRpdHlNYW5hZ2VyKCk7CiAgICAgICAgZW0uZ2V0VHJh\nbnNhY3Rpb24oKS5iZWdpbigpOwogICAgICAgIE9wdGltaXN0aWNMb2NrSW5z\ndGFuY2Ugb2xpID0gbmV3IE9wdGltaXN0aWNMb2NrSW5zdGFuY2UoImZvbyIp\nOwogICAgICAgIGVtLnBlcnNpc3Qob2xpKTsKICAgICAgICBlbS5nZXRUcmFu\nc2FjdGlvbigpLmNvbW1pdCgpOwogICAgICAgIHBrID0gb2xpLmdldFBLKCk7\nCiAgICAgICAgZW0uY2xvc2UoKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCB0\nZXN0T3B0aW1pc3RpY0xvY2tSZWNvdmVyeSgpIAogICAgICAgIHRocm93cyBT\nUUxFeGNlcHRpb24gewoKICAgICAgICBFbnRpdHlNYW5hZ2VyIGVtOwogICAg\nICAgIAogICAgICAgIC8vIDEuIGdldCB0aGUgb3Bsb2NrIHZhbHVlIGZvciB0\naGUgaW5zdGFuY2UgYWZ0ZXIgY29tbWl0IGFuZAogICAgICAgIC8vIGdldCBh\nIHJlYWQgbG9jayB0byBlbnN1cmUgdGhhdCB3ZSBjaGVjayBmb3IgdGhlIG9w\ndGltaXN0aWMKICAgICAgICAvLyBsb2NrIGNvbHVtbiBhdCB0eCBjb21taXQu\nCiAgICAgICAgZW0gPSBlbWYuY3JlYXRlRW50aXR5TWFuYWdlcigpOwogICAg\nICAgIGVtLmdldFRyYW5zYWN0aW9uKCkuYmVnaW4oKTsKICAgICAgICBPcHRp\nbWlzdGljTG9ja0luc3RhbmNlIG9saSA9IGVtLmZpbmQoT3B0aW1pc3RpY0xv\nY2tJbnN0YW5jZS5jbGFzcywgcGspOwogICAgICAgIE9iamVjdCBvaWQgPSBK\nUEFGYWNhZGVIZWxwZXIudG9PcGVuSlBBT2JqZWN0SWQoCiAgICAgICAgICAg\nIEpQQUZhY2FkZUhlbHBlci5nZXRNZXRhRGF0YShvbGkpLAogICAgICAgICAg\nICBPcGVuSlBBUGVyc2lzdGVuY2UuY2FzdChlbSkuZ2V0T2JqZWN0SWQob2xp\nKSk7CiAgICAgICAgaW50IGZpcnN0T3BMb2NrVmFsdWUgPSBvbGkuZ2V0T3BM\nb2NrKCk7CiAgICAgICAgZW0ubG9jayhvbGksIExvY2tNb2RlVHlwZS5SRUFE\nKTsKCiAgICAgICAgLy8gMi4gbWFrZSBhIGNoYW5nZSB0byB0aGUgaW5zdGFu\nY2UncyBvcHRpbWlzdGljIGxvY2sgY29sdW1uCiAgICAgICAgLy8gdmlhIGRp\ncmVjdCBTUUwgaW4gYSBzZXBhcmF0ZSB0cmFuc2FjdGlvbgogICAgICAgIGlu\ndCBzZWNvbmRPcExvY2tWYWx1ZSA9IGZpcnN0T3BMb2NrVmFsdWUgKyAxOwoK\nICAgICAgICBPcGVuSlBBRW50aXR5TWFuYWdlckZhY3RvcnlTUEkgZW1mID0g\nKE9wZW5KUEFFbnRpdHlNYW5hZ2VyRmFjdG9yeVNQSSkKICAgICAgICAgICAg\nT3BlbkpQQVBlcnNpc3RlbmNlLmNhc3QoZW0pLmdldEVudGl0eU1hbmFnZXJG\nYWN0b3J5KCk7CiAgICAgICAgRGF0YVNvdXJjZSBkcyA9IChEYXRhU291cmNl\nKSBlbWYuZ2V0Q29uZmlndXJhdGlvbigpCiAgICAgICAgICAgIC5nZXRDb25u\nZWN0aW9uRmFjdG9yeSgpOwogICAgICAgIENvbm5lY3Rpb24gYyA9IGRzLmdl\ndENvbm5lY3Rpb24oKTsKICAgICAgICBjLnNldEF1dG9Db21taXQoZmFsc2Up\nOwogICAgICAgIFByZXBhcmVkU3RhdGVtZW50IHBzID0gYy5wcmVwYXJlU3Rh\ndGVtZW50KAogICAgICAgICAgICAiVVBEQVRFIE9QVElNSVNUSUNfTE9DS19J\nTlNUQU5DRSBTRVQgT1BMT0NLID0gPyBXSEVSRSBQSyA9ID8iKTsKICAgICAg\nICBwcy5zZXRJbnQoMSwgc2Vjb25kT3BMb2NrVmFsdWUpOwogICAgICAgIHBz\nLnNldEludCgyLCBwayk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKDEsIHBzLmV4\nZWN1dGVVcGRhdGUoKSk7CiAgICAgICAgYy5jb21taXQoKTsKICAgICAgICAK\nICAgICAgICAvLyAzLiBjb21taXQgdGhlIHRyYW5zYWN0aW9uLCBjYXRjaGlu\nZyB0aGUgZXhwZWN0ZWQgb3Bsb2NrCiAgICAgICAgLy8gZXhjZXB0aW9uCiAg\nICAgICAgdHJ5IHsKICAgICAgICAgICAgZW0uZ2V0VHJhbnNhY3Rpb24oKS5j\nb21taXQoKTsKICAgICAgICAgICAgZmFpbCgidHggc2hvdWxkIGhhdmUgZmFp\nbGVkIGR1ZSB0byBvdXQtb2YtYmFuZCBvcGxvY2sgY2hhbmdlIik7CiAgICAg\nICAgfSBjYXRjaCAoUm9sbGJhY2tFeGNlcHRpb24gcmUpIHsKICAgICAgICAg\nICAgLy8gZXhwZWN0ZWQKICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAg\nICBpZiAoZW0uZ2V0VHJhbnNhY3Rpb24oKS5pc0FjdGl2ZSgpKQogICAgICAg\nICAgICAgICAgZW0uZ2V0VHJhbnNhY3Rpb24oKS5yb2xsYmFjaygpOwogICAg\nICAgIH0KCiAgICAgICAgLy8gNC4gY2hlY2sgdGhhdCB0aGUgY29ycmVzcG9u\nZGluZyByZW1vdGUgY29tbWl0IGV2ZW50IHdhcyBmaXJlZAogICAgICAgIGFz\nc2VydEVxdWFscygxLCByZW1vdGVDb21taXRFdmVudFN0YWxlQ291bnQpOwog\nICAgICAgIGFzc2VydEVxdWFscyhvaWQsIHN0YWxlT2lkKTsKCiAgICAgICAg\nLy8gNS4gb2J0YWluIHRoZSBvYmplY3QgaW4gYSBuZXcgcGVyc2lzdGVuY2Ug\nY29udGV4dCBhbmQKICAgICAgICAvLyBhc3NlcnQgdGhhdCB0aGUgb3Bsb2Nr\nIGNvbHVtbiBpcyBzZXQgdG8gdGhlIG9uZSB0aGF0CiAgICAgICAgLy8gaGFw\ncGVuZWQgaW4gdGhlIG91dC1vZi1iYW5kIHRyYW5zYWN0aW9uCiAgICAgICAg\nZW0uY2xvc2UoKTsKICAgICAgICBlbSA9IHRoaXMuZW1mLmNyZWF0ZUVudGl0\neU1hbmFnZXIoKTsKICAgICAgICBvbGkgPSBlbS5maW5kKE9wdGltaXN0aWNM\nb2NrSW5zdGFuY2UuY2xhc3MsIHBrKTsKCiAgICAgICAgLy8gSWYgdGhpcyBm\nYWlscywgdGhlbiB0aGUgZGF0YSBjYWNoZSBoYXMgdGhlIHdyb25nIHZhbHVl\nLgogICAgICAgIC8vIFRoaXMgaXMgd2hhdCB0aGlzIHRlc3QgY2FzZSBpcyBk\nZXNpZ25lZCB0byBleGVyY2lzZS4KICAgICAgICBhc3NlcnRFcXVhbHMoImRh\ndGEgY2FjaGUgaXMgbm90IGJlaW5nIGNsZWFyZWQgd2hlbiBvcGxvY2sgIgog\nICAgICAgICAgICArICJ2aW9sYXRpb25zIG9jY3VyIiwgc2Vjb25kT3BMb2Nr\nVmFsdWUsIG9saS5nZXRPcExvY2soKSk7CgogICAgICAgIC8vIDYuIGdldCBh\nIHJlYWQgbG9jayBvbiB0aGUgaW5zdGFuY2UgYW5kIGNvbW1pdCB0aGUgdHg7\nIHRoaXMKICAgICAgICAvLyB0aW1lIGl0IHNob3VsZCBnbyB0aHJvdWdoCiAg\nICAgICAgZW0uZ2V0VHJhbnNhY3Rpb24oKS5iZWdpbigpOwogICAgICAgIGVt\nLmxvY2sob2xpLCBMb2NrTW9kZVR5cGUuUkVBRCk7CiAgICAgICAgdHJ5IHsK\nICAgICAgICAgICAgZW0uZ2V0VHJhbnNhY3Rpb24oKS5jb21taXQoKTsKICAg\nICAgICB9IGNhdGNoIChSb2xsYmFja0V4Y2VwdGlvbiBlKSB7CiAgICAgICAg\nICAgIHRocm93IGU7CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAg\naWYgKGVtLmdldFRyYW5zYWN0aW9uKCkuaXNBY3RpdmUoKSkKICAgICAgICAg\nICAgICAgIGVtLmdldFRyYW5zYWN0aW9uKCkucm9sbGJhY2soKTsKICAgICAg\nICB9CiAgICAgICAgZW0uY2xvc2UoKTsKICAgIH0KICAgIAogICAgcHVibGlj\nIHZvaWQgdGVzdEV4cGVjdGVkT3B0aW1pc3RpY0xvY2tFeGNlcHRpb24oKSB7\nCiAgICAgICAgRW50aXR5TWFuYWdlciBlbTsKICAgICAgICAKICAgICAgICAv\nLyAxLiBzdGFydCBhIG5ldyB0eAogICAgICAgIGVtID0gZW1mLmNyZWF0ZUVu\ndGl0eU1hbmFnZXIoKTsKICAgICAgICBlbS5nZXRUcmFuc2FjdGlvbigpLmJl\nZ2luKCk7CiAgICAgICAgZW0ubG9jayhlbS5maW5kKE9wdGltaXN0aWNMb2Nr\nSW5zdGFuY2UuY2xhc3MsIHBrKSwgTG9ja01vZGVUeXBlLlJFQUQpOwogICAg\nICAgIAogICAgICAgIC8vIDIuIHN0YXJ0IGFub3RoZXIgdHgsIGFuZCBjYXVz\nZSBhIHZlcnNpb24gaW5jcmVtZW50CiAgICAgICAgRW50aXR5TWFuYWdlciBl\nbTIgPSBlbWYuY3JlYXRlRW50aXR5TWFuYWdlcigpOwogICAgICAgIGVtMi5n\nZXRUcmFuc2FjdGlvbigpLmJlZ2luKCk7CiAgICAgICAgZW0yLmxvY2soZW0y\nLmZpbmQoT3B0aW1pc3RpY0xvY2tJbnN0YW5jZS5jbGFzcywgcGspLCAKICAg\nICAgICAgICAgTG9ja01vZGVUeXBlLldSSVRFKTsKICAgICAgICBlbTIuZ2V0\nVHJhbnNhY3Rpb24oKS5jb21taXQoKTsKICAgICAgICBlbTIuY2xvc2UoKTsK\nICAgICAgICAKICAgICAgICAvLyAzLiB0cnkgdG8gY29tbWl0LiB0aGlzIHNo\nb3VsZCBmYWlsLCBhcyB0aGlzIGlzIGEgcmVndWxhciBvcHRpbWlzdGljCiAg\nICAgICAgLy8gbG9jayBmYWlsdXJlIHNpdHVhdGlvbi4KICAgICAgICB0cnkg\newogICAgICAgICAgICBlbS5nZXRUcmFuc2FjdGlvbigpLmNvbW1pdCgpOwog\nICAgICAgICAgICBmYWlsKCJ3cml0ZSBsb2NrIGluIGVtMiBzaG91bGQgdHJp\nZ2dlciBhbiBvcHRpbWlzdGljIGxvY2sgZmFpbHVyZSIpOwogICAgICAgIH0g\nY2F0Y2ggKFJvbGxiYWNrRXhjZXB0aW9uIHBlKSB7CiAgICAgICAgICAgIC8v\nIGV4cGVjdGVkCiAgICAgICAgfQogICAgICAgIGVtLmNsb3NlKCk7CiAgICB9\nCn0K\n","encoding":"base64"}

