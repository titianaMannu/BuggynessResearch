{"sha":"98729c1d3903f49ae4e348777d8c85aee667ea6a","node_id":"MDQ6QmxvYjIwNjM2NDo5ODcyOWMxZDM5MDNmNDlhZTRlMzQ4Nzc3ZDhjODVhZWU2NjdlYTZh","size":13125,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/98729c1d3903f49ae4e348777d8c85aee667ea6a","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuZGF0YWNh\nY2hlOwoKaW1wb3J0IGphdmEudXRpbC5Db2xsZWN0aW9uOwppbXBvcnQgamF2\nYS51dGlsLkhhc2hNYXA7CmltcG9ydCBqYXZhLnV0aWwuSXRlcmF0b3I7Cmlt\ncG9ydCBqYXZhLnV0aWwuTWFwOwoKCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEucGVyc2lzdGVuY2UuZGF0YWNhY2hlLmNvbW1vbi5hcHBzLlJ1bnRpbWVU\nZXN0MTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5k\nYXRhY2FjaGUuY29tbW9uLmFwcHMuUnVudGltZVRlc3QyOwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNlLmNvbW1vbi51dGlscy5BYnN0\ncmFjdFRlc3RDYXNlOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmRhdGFj\nYWNoZS5EYXRhQ2FjaGU7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuZXZl\nbnQuVENQUmVtb3RlQ29tbWl0UHJvdmlkZXI7CmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEubGliLmNvbmYuQ29uZmlndXJhdGlvbnM7CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuT3BlbkpQQUVudGl0eU1hbmFn\nZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuT3Bl\nbkpQQUVudGl0eU1hbmFnZXJGYWN0b3J5OwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLnBlcnNpc3RlbmNlLk9wZW5KUEFFbnRpdHlNYW5hZ2VyRmFjdG9y\neVNQSTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLklkOwoKcHVi\nbGljIGNsYXNzIFRlc3REaXN0cmlidXRlZEtvZG9EYXRhQ2FjaGUgZXh0ZW5k\ncyBBYnN0cmFjdFRlc3RDYXNlIHsKCiAgICAvLyBXZSB3YW50IG1vcmUgdGhh\nbiAxIGluc3RhbmNlIG9mIGVhY2ggdHlwZSBvZiBjbGFzcy4KICAgIHByaXZh\ndGUgc3RhdGljIGZpbmFsIGludCBOVU1fT0JKRUNUUyA9IDQ7CgogICAgcHJp\ndmF0ZSBPYmplY3RbXSBfcnVudGltZTFzT2lkczsKCiAgICBwcml2YXRlIE9i\namVjdFtdIF9ydW50aW1lMnNPaWRzOwoKICAgIHByaXZhdGUgT2JqZWN0IHNw\nZWNfb2lkOwoKICAgIHB1YmxpYyBUZXN0RGlzdHJpYnV0ZWRLb2RvRGF0YUNh\nY2hlKFN0cmluZyB0ZXN0KSB7CiAgICAgICAgc3VwZXIodGVzdCwgImRhdGFj\nYWNoZWNhY3R1c2FwcCIpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldFVw\nKCkgewogICAgICAgIGRlbGV0ZUFsbChSdW50aW1lVGVzdDEuY2xhc3MpOwog\nICAgICAgIGRlbGV0ZUFsbChSdW50aW1lVGVzdDIuY2xhc3MpOwogICAgfQoK\nICAgIHByaXZhdGUgaW50ZXJmYWNlIENoYW5nZU9wZXJhdGlvbiB7CgogICAg\nICAgIHB1YmxpYyBTdHJpbmcgZ2V0TmFtZSgpOwoKICAgICAgICBwdWJsaWMg\ndm9pZCBvcGVyYXRpb24oT3BlbkpQQUVudGl0eU1hbmFnZXJGYWN0b3J5IGtw\nbWYsCiAgICAgICAgICAgIGJvb2xlYW4gYXNMYXJnZSk7CiAgICB9CgogICAg\ncHJpdmF0ZSBjbGFzcyBwZXJmb3JtQXNNb2RpZnkgaW1wbGVtZW50cyBDaGFu\nZ2VPcGVyYXRpb24gewoKICAgICAgICBwdWJsaWMgU3RyaW5nIGdldE5hbWUo\nKSB7CiAgICAgICAgICAgIHJldHVybiAiTW9kaWZ5IFNwZWNpYWxSdW50aW1l\nVGVzdDEiOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIHZvaWQgb3BlcmF0\naW9uKE9wZW5KUEFFbnRpdHlNYW5hZ2VyRmFjdG9yeSBrcG1mLAogICAgICAg\nICAgICBib29sZWFuIGFzTGFyZ2UpIHsKICAgICAgICAgICAgT3BlbkpQQUVu\ndGl0eU1hbmFnZXIgcG07CiAgICAgICAgICAgIHBtID0gKE9wZW5KUEFFbnRp\ndHlNYW5hZ2VyKSBrcG1mLmNyZWF0ZUVudGl0eU1hbmFnZXIoKTsKICAgICAg\nICAgICAgaWYgKGFzTGFyZ2UpCiAgICAgICAgICAgICAgICAvL3BtLnNldExh\ncmdlVHJhbnNhY3Rpb24odHJ1ZSk7CiAgICAgICAgICAgICAgICBwbS5zZXRU\ncmFja0NoYW5nZXNCeVR5cGUodHJ1ZSk7CiAgICAgICAgICAgIHN0YXJ0VHgo\ncG0pOwogICAgICAgICAgICBSdW50aW1lVGVzdDEgc3BlY2lhbCA9IHBtLmZp\nbmQoUnVudGltZVRlc3QxLmNsYXNzLCBzcGVjX29pZCk7CiAgICAgICAgICAg\nIGFzc2VydE5vdE51bGwoc3BlY2lhbCk7CiAgICAgICAgICAgIHNwZWNpYWwu\nc2V0U3RyaW5nRmllbGQoIlNwZWljYWxSdW50aW1lVGVzdDFfTU9ESUZJRUQi\nKTsKCiAgICAgICAgICAgIGVuZFR4KHBtKTsKICAgICAgICAgICAgZW5kRW0o\ncG0pOwogICAgICAgIH0KICAgIH0KCiAgICBwcml2YXRlIGNsYXNzIHBlcmZv\ncm1Bc0RlbGV0ZSBpbXBsZW1lbnRzIENoYW5nZU9wZXJhdGlvbiB7CgogICAg\nICAgIHB1YmxpYyBTdHJpbmcgZ2V0TmFtZSgpIHsKICAgICAgICAgICAgcmV0\ndXJuICJEZWxldGUgU3BlY2lhbFJ1bnRpbWVUZXN0MSI7CiAgICAgICAgfQoK\nICAgICAgICBwdWJsaWMgdm9pZCBvcGVyYXRpb24oT3BlbkpQQUVudGl0eU1h\nbmFnZXJGYWN0b3J5IGtwbWYsCiAgICAgICAgICAgIGJvb2xlYW4gYXNMYXJn\nZSkgewogICAgICAgICAgICBPcGVuSlBBRW50aXR5TWFuYWdlciBwbTsKICAg\nICAgICAgICAgcG0gPSAoT3BlbkpQQUVudGl0eU1hbmFnZXIpIGtwbWYuY3Jl\nYXRlRW50aXR5TWFuYWdlcigpOwogICAgICAgICAgICBpZiAoYXNMYXJnZSkK\nICAgICAgICAgICAgICAgIC8vcG0uc2V0TGFyZ2VUcmFuc2FjdGlvbih0cnVl\nKTsKICAgICAgICAgICAgICAgIHBtLnNldFRyYWNrQ2hhbmdlc0J5VHlwZSh0\ncnVlKTsKICAgICAgICAgICAgc3RhcnRUeChwbSk7CiAgICAgICAgICAgIFJ1\nbnRpbWVUZXN0MSBzcGVjaWFsT2JqID0gcG0uZmluZChSdW50aW1lVGVzdDEu\nY2xhc3MsIHNwZWNfb2lkKTsKICAgICAgICAgICAgYXNzZXJ0Tm90TnVsbChz\ncGVjaWFsT2JqKTsKCiAgICAgICAgICAgIHBtLnJlbW92ZShzcGVjaWFsT2Jq\nKTsKCiAgICAgICAgICAgIGVuZFR4KHBtKTsKICAgICAgICAgICAgZW5kRW0o\ncG0pOwogICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMgdm9pZCB0ZXN0Tm9y\nbWFsVHJhbnNBbmREYXRhQ2FjaGVEZWxldGUoKSB7CiAgICAgICAgY29yZVRl\nc3RUcmFuc0FuZENoYW5nZShuZXcgcGVyZm9ybUFzRGVsZXRlKCksIGZhbHNl\nLCB0cnVlKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCB0ZXN0Tm9ybWFsVHJh\nbnNBbmREYXRhQ2FjaGVNb2RpZnkoKSB7CiAgICAgICAgY29yZVRlc3RUcmFu\nc0FuZENoYW5nZShuZXcgcGVyZm9ybUFzTW9kaWZ5KCksIGZhbHNlLCBmYWxz\nZSk7CiAgICB9CgogICAgcHVibGljIHZvaWQgdGVzdExhcmdlVHJhbnNBbmRE\nYXRhQ2FjaGVEZWxldGUoKSB7CiAgICAgICAgY29yZVRlc3RUcmFuc0FuZENo\nYW5nZShuZXcgcGVyZm9ybUFzRGVsZXRlKCksIHRydWUsIHRydWUpOwogICAg\nfQoKICAgIHB1YmxpYyB2b2lkIHRlc3RMYXJnZVRyYW5zQW5kRGF0YUNhY2hl\nTW9kaWZ5KCkgewogICAgICAgIGNvcmVUZXN0VHJhbnNBbmRDaGFuZ2UobmV3\nIHBlcmZvcm1Bc01vZGlmeSgpLCB0cnVlLCBmYWxzZSk7CiAgICB9CgogICAg\ncHVibGljIHZvaWQgY29yZVRlc3RUcmFuc0FuZENoYW5nZShDaGFuZ2VPcGVy\nYXRpb24gY2hhbmdlT3BlcmF0aW9uLAogICAgICAgIGJvb2xlYW4gYXNMYXJn\nZVRyYW5zYWN0aW9uLCBib29sZWFuIGlzRGVsZXRlKSB7CiAgICAgICAgLy8g\nQ3JlYXRlIHR3byBwbWZzIGluIGEgY2x1c3RlciB0aGF0IGFyZSB1c2luZyBS\nQ1BUQ1AuCiAgICAgICAgT3BlbkpQQUVudGl0eU1hbmFnZXJGYWN0b3J5IHBt\nZlNlbmRlciA9IGNyZWF0ZURpc3RpbmN0RmFjdG9yeSgKICAgICAgICAgICAg\nVENQUmVtb3RlQ29tbWl0UHJvdmlkZXIuY2xhc3MsCiAgICAgICAgICAgICJQ\nb3J0PTU2MzYsIEFkZHJlc3Nlcz0xMjcuMC4wLjE6NjYzNiIpOwogICAgICAg\nIE9wZW5KUEFFbnRpdHlNYW5hZ2VyRmFjdG9yeSBwbWZSZWNlaXZlciA9IGNy\nZWF0ZURpc3RpbmN0RmFjdG9yeSgKICAgICAgICAgICAgVENQUmVtb3RlQ29t\nbWl0UHJvdmlkZXIuY2xhc3MsCiAgICAgICAgICAgICJQb3J0PTY2MzYsIEFk\nZHJlc3Nlcz0xMjcuMC4wLjE6NTYzNiIpOwogICAgICAgIC8vIEdldCB0aGUg\nZGF0YWNhY2hlcyBmcm9tIGVhY2ggcG1mCiAgICAgICAgRGF0YUNhY2hlIGRj\nU2VuZGVyID0KICAgICAgICAgICAgKChPcGVuSlBBRW50aXR5TWFuYWdlckZh\nY3RvcnlTUEkpIHBtZlNlbmRlcikuZ2V0Q29uZmlndXJhdGlvbigpCiAgICAg\nICAgICAgICAgICAuZ2V0RGF0YUNhY2hlTWFuYWdlckluc3RhbmNlKCkuZ2V0\nU3lzdGVtRGF0YUNhY2hlKCk7CiAgICAgICAgRGF0YUNhY2hlIGRjUmVjZWl2\nZXIgPQogICAgICAgICAgICAoKE9wZW5KUEFFbnRpdHlNYW5hZ2VyRmFjdG9y\neVNQSSkgcG1mUmVjZWl2ZXIpLmdldENvbmZpZ3VyYXRpb24oKQogICAgICAg\nICAgICAgICAgLmdldERhdGFDYWNoZU1hbmFnZXJJbnN0YW5jZSgpLmdldFN5\nc3RlbURhdGFDYWNoZSgpOwoKICAgICAgICBkZWxldGVBbGwoUnVudGltZVRl\nc3QxLmNsYXNzKTsKICAgICAgICBkZWxldGVBbGwoUnVudGltZVRlc3QyLmNs\nYXNzKTsKCiAgICAgICAgX3J1bnRpbWUxc09pZHMgPSBudWxsOwogICAgICAg\nIF9ydW50aW1lMnNPaWRzID0gbnVsbDsKCiAgICAgICAgU3RyaW5nIHRyYW5z\nVHlwZSA9ICJub3JtYWwiOwogICAgICAgIFN0cmluZyByY3BUeXBlID0gIk9J\nRHMiOwogICAgICAgIGlmIChhc0xhcmdlVHJhbnNhY3Rpb24pIHsKICAgICAg\nICAgICAgdHJhbnNUeXBlID0gImxhcmdlIjsKICAgICAgICAgICAgcmNwVHlw\nZSA9ICJjbGFzc2VzIjsKICAgICAgICB9CiAgICAgICAgU3lzdGVtLm91dC5w\ncmludGxuKCItLS0tLS0tLS0tLS0tLS0tLS0tIik7CiAgICAgICAgU3lzdGVt\nLm91dAogICAgICAgICAgICAucHJpbnRsbigKICAgICAgICAgICAgICAgICIy\nIFBNRnMgY3JlYXRlZCwgYWN0aW5nIGFzIGEgY2x1c3RlciB1c2luZyBwb3J0\ncyA1NjM2IGFuZCA2NjM2Iik7CiAgICAgICAgU3lzdGVtLm91dC5wcmludGxu\nKCJUZXN0aW5nIHNjZW5hcmlvOiIpOwogICAgICAgIFN5c3RlbS5vdXQKICAg\nICAgICAgICAgLnByaW50bG4oIiAgMSBTZWVkIGRhdGFzdG9yZSB3aXRoIGlu\nc3RhbmNlcyBvZiBSdW50aW1lVGVzdDEgQU5EICIKICAgICAgICAgICAgICAg\nICsgIlJ1bnRpbWVUZXN0MiBvYmpzLlxuIgogICAgICAgICAgICAgICAgKyAi\nICAyIHBtZjIgZmlsbHMgaXRzIGNhY2hlIHdpdGggYm90aCBzZXRzIG9mIG9i\nanMuXG4iCiAgICAgICAgICAgICAgICArICIgIDMgcG1mMSBkb2VzIGEgIgog\nICAgICAgICAgICAgICAgKyB0cmFuc1R5cGUKICAgICAgICAgICAgICAgICsg\nIiB0eCB0aGF0IGludm9rZXMgYW4gb3BlcmF0aW9uIG9mICIKICAgICAgICAg\nICAgICAgICsgY2hhbmdlT3BlcmF0aW9uLmdldE5hbWUoKQogICAgICAgICAg\nICAgICAgKyAiIHRvIGFmZmVjdCBhIHNpbmdsZSBSdW50aW1lMSBcbiIKICAg\nICAgICAgICAgICAgICsgIiAgICBhc3NlcnQgdGhhdCBib3RoIHBtZjEgYW5k\nIHBtZjIncyBkYXRhIGNhY2hlcyBkcm9wcGVkIGFsbCIKICAgICAgICAgICAg\nICAgICsgIlJ1bnRpbWUxcyIpOwogICAgICAgIFN5c3RlbS5vdXQucHJpbnRs\nbigiUmVtb3RlIGNvbW1pdCBldmVudCBpcyB0cmFuc21pdGluZyAiICsgcmNw\nVHlwZSk7CgogICAgICAgIC8vIENyZWF0ZSBydW50aW1lczFzIGFuZCAycy4K\nICAgICAgICAvLyBOb3JhbWwgdHJhbnNhY3Rpb24KICAgICAgICBPcGVuSlBB\nRW50aXR5TWFuYWdlciBwbVNlbmRlciA9IChPcGVuSlBBRW50aXR5TWFuYWdl\ncikgcG1mU2VuZGVyCiAgICAgICAgICAgIC5jcmVhdGVFbnRpdHlNYW5hZ2Vy\nKCk7CiAgICAgICAgc2VlZERhdGFTdG9yZShwbVNlbmRlciwgTlVNX09CSkVD\nVFMpOwogICAgICAgIGVuZEVtKHBtU2VuZGVyKTsKCiAgICAgICAgLy8gd2Fp\ndCBhIGJpdCBzbyB0aGV5IGdldCBzdG9yZWQKICAgICAgICBwYXVzZSgxKTsK\nCiAgICAgICAgT3BlbkpQQUVudGl0eU1hbmFnZXIgcG0yOwogICAgICAgIHBt\nMiA9IChPcGVuSlBBRW50aXR5TWFuYWdlcikgcG1mUmVjZWl2ZXIuY3JlYXRl\nRW50aXR5TWFuYWdlcigpOwogICAgICAgIHBlcmZvcm1Mb2FkQWxsKHBtMik7\nCiAgICAgICAgZW5kRW0ocG0yKTsKCiAgICAgICAgcG1TZW5kZXIgPSAoT3Bl\nbkpQQUVudGl0eU1hbmFnZXIpIHBtZlNlbmRlci5jcmVhdGVFbnRpdHlNYW5h\nZ2VyKCk7CiAgICAgICAgcGVyZm9ybUxvYWRBbGwocG1TZW5kZXIpOwogICAg\nICAgIGVuZEVtKHBtU2VuZGVyKTsKCiAgICAgICAgLy8gYXNzZXJ0IHRoYXQg\ncG1mMidzIGRhdGEgY2FjaGUgbm93IGhhcyBhbGwgdGhlIFJ1bnRpbWUxIGFu\nZCAycy4KICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IF9ydW50aW1lMXNP\naWRzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGFzc2VydFRydWUoZGNS\nZWNlaXZlci5jb250YWlucygKICAgICAgICAgICAgICAgIElkLm5ld0luc3Rh\nbmNlKFJ1bnRpbWVUZXN0MS5jbGFzcywgX3J1bnRpbWUxc09pZHNbaV0pKSk7\nCiAgICAgICAgfQogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgX3J1bnRp\nbWUyc09pZHMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgYXNzZXJ0VHJ1\nZShkY1JlY2VpdmVyLmNvbnRhaW5zKAogICAgICAgICAgICAgICAgSWQubmV3\nSW5zdGFuY2UoUnVudGltZVRlc3QyLmNsYXNzLCBfcnVudGltZTJzT2lkc1tp\nXSkpKTsKICAgICAgICB9CgogICAgICAgIC8vIE1vZGlmeSBvciBkZWxldGUg\nZXhhY3RseSAxIFJ1bnRpbWVUZXN0MSBvYmplY3QgZHVyaW5nIGEKICAgICAg\nICAvLyBsYXJnZVRyYW5zYWN0aW9uCiAgICAgICAgY2hhbmdlT3BlcmF0aW9u\nLm9wZXJhdGlvbihwbWZTZW5kZXIsIGFzTGFyZ2VUcmFuc2FjdGlvbik7Cgog\nICAgICAgIC8vIGFzc2VydCB0aGF0IHBtZjEncyBkYXRhIGNhY2hlIG5vdyBv\nbmx5IGhhcyBSdW50aW1lMiBvYmplY3RzCiAgICAgICAgaWYgKGFzTGFyZ2VU\ncmFuc2FjdGlvbikgewogICAgICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8\nIF9ydW50aW1lMXNPaWRzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAg\nICBhc3NlcnRGYWxzZShkY1NlbmRlci5jb250YWlucygKICAgICAgICAgICAg\nICAgICAgICBJZC5uZXdJbnN0YW5jZShSdW50aW1lVGVzdDEuY2xhc3MsIF9y\ndW50aW1lMXNPaWRzW2ldKSkpOwogICAgICAgICAgICB9CiAgICAgICAgfSBl\nbHNlIHsKICAgICAgICAgICAgLy8gTm9ybWFsIHRyYW5zYWN0aW9uCiAgICAg\nICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgX3J1bnRpbWUxc09pZHMubGVu\nZ3RoOyBpKyspIHsKICAgICAgICAgICAgICAgIGlmIChpc0RlbGV0ZSAmJiBp\nID09IDApIHsKICAgICAgICAgICAgICAgICAgICBhc3NlcnRGYWxzZShkY1Nl\nbmRlci5jb250YWlucygKICAgICAgICAgICAgICAgICAgICAgICAgSWQubmV3\nSW5zdGFuY2UoUnVudGltZVRlc3QxLmNsYXNzLCBfcnVudGltZTFzT2lkc1tp\nXSkpKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAg\nICAgICAgLy8gbW9kaWZpZWQgdGhlIGZpcnN0IGVsZW1udCwgd2hpY2gganVz\ndCB1cGRhdGVkIGl0LgogICAgICAgICAgICAgICAgICAgIC8vIChmb3IgS29k\nbydzIGRhdGEgY2FjaGUpLgogICAgICAgICAgICAgICAgICAgIGFzc2VydFRy\ndWUoZGNTZW5kZXIuY29udGFpbnMoCiAgICAgICAgICAgICAgICAgICAgICAg\nIElkLm5ld0luc3RhbmNlKFJ1bnRpbWVUZXN0MS5jbGFzcywgX3J1bnRpbWUx\nc09pZHNbaV0pKSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0K\nICAgICAgICB9CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBfcnVudGlt\nZTJzT2lkcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBhc3NlcnRUcnVl\nKGRjU2VuZGVyLmNvbnRhaW5zKAogICAgICAgICAgICAgICAgSWQubmV3SW5z\ndGFuY2UoUnVudGltZVRlc3QyLmNsYXNzLCBfcnVudGltZTJzT2lkc1tpXSkp\nKTsKICAgICAgICB9CiAgICAgICAgLy8gd2FpdCBhIHRpbnkgYml0IHNvIHRo\nZSByY2UgcHJvcGFnYXRlcwogICAgICAgIHBhdXNlKDIpOwogICAgICAgIC8v\nIGFzc2VydCB0aGUgcG1mMidzIGRhdGEgY2FjaGUgYWxzbyBub3cgb25seSBo\nYXMgUnVudGltZTIgb2JqZWN0cwogICAgICAgIGlmIChhc0xhcmdlVHJhbnNh\nY3Rpb24pIHsKICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBfcnVu\ndGltZTFzT2lkcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgYXNz\nZXJ0RmFsc2UoZGNSZWNlaXZlci5jb250YWlucyhJZC5uZXdJbnN0YW5jZSgK\nICAgICAgICAgICAgICAgICAgICBSdW50aW1lVGVzdDEuY2xhc3MsIF9ydW50\naW1lMXNPaWRzW2ldKSkpOyAvL2ZhaWxpbmcgaGVyZQogICAgICAgICAgICB9\nCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7\nIGkgPCBfcnVudGltZTFzT2lkcy5sZW5ndGg7IGkrKykgewogICAgICAgICAg\nICAgICAgaWYgKGkgPT0gMCkgewogICAgICAgICAgICAgICAgICAgIGFzc2Vy\ndEZhbHNlKGRjUmVjZWl2ZXIuY29udGFpbnMoSWQubmV3SW5zdGFuY2UoCiAg\nICAgICAgICAgICAgICAgICAgICAgIFJ1bnRpbWVUZXN0MS5jbGFzcywKICAg\nICAgICAgICAgICAgICAgICAgICAgX3J1bnRpbWUxc09pZHNbaV0pKSk7ICAv\nL2ZhaWxpbmcgaGVyZQogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAg\nICAgICAgICAgICAgICBhc3NlcnRUcnVlKGRjUmVjZWl2ZXIuY29udGFpbnMo\nCiAgICAgICAgICAgICAgICAgICAgICAgIElkLm5ld0luc3RhbmNlKFJ1bnRp\nbWVUZXN0MS5jbGFzcywgX3J1bnRpbWUxc09pZHNbaV0pKSk7CiAgICAgICAg\nICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgZm9y\nIChpbnQgaSA9IDA7IGkgPCBfcnVudGltZTJzT2lkcy5sZW5ndGg7IGkrKykg\newogICAgICAgICAgICBhc3NlcnRUcnVlKGRjUmVjZWl2ZXIuY29udGFpbnMo\nCiAgICAgICAgICAgICAgICBJZC5uZXdJbnN0YW5jZShSdW50aW1lVGVzdDIu\nY2xhc3MsIF9ydW50aW1lMnNPaWRzW2ldKSkpOwogICAgICAgIH0KCiAgICAg\nICAgLy8gc2h1dGRvd24KICAgICAgICBwbWZTZW5kZXIuY2xvc2UoKTsKICAg\nICAgICBwbWZSZWNlaXZlci5jbG9zZSgpOwogICAgfQoKICAgIHByb3RlY3Rl\nZCB2b2lkIHBlcmZvcm1Mb2FkQWxsKE9wZW5KUEFFbnRpdHlNYW5hZ2VyIHBt\nKQogICAgLy8gbG9hZCBpbiAoYW5kIHRodXMgY2FjaGUpIGFsbCB0aGUgMXMg\nYW5kIDJzCiAgICB7CiAgICAgICAgc3RhcnRUeChwbSk7CiAgICAgICAgUnVu\ndGltZVRlc3QxIHRlbXAxOwogICAgICAgIENvbGxlY3Rpb24gcnVudGltZTFz\nID0gKENvbGxlY3Rpb24pIHBtCiAgICAgICAgICAgIC5jcmVhdGVRdWVyeSgi\nU0VMRUNUIGEgRlJPTSBSdW50aW1lVGVzdDEgYSIpLmdldFJlc3VsdExpc3Qo\nKTsKCiAgICAgICAgZm9yIChJdGVyYXRvciBpdHIgPSBydW50aW1lMXMuaXRl\ncmF0b3IoKTsgaXRyLmhhc05leHQoKTspCiAgICAgICAgICAgIHRlbXAxID0g\nKFJ1bnRpbWVUZXN0MSkgaXRyLm5leHQoKTsKICAgICAgICBSdW50aW1lVGVz\ndDIgdGVtcDI7CiAgICAgICAgQ29sbGVjdGlvbiBydW50aW1lMnMgPSAoQ29s\nbGVjdGlvbikgcG0KICAgICAgICAgICAgLmNyZWF0ZVF1ZXJ5KCJTRUxFQ1Qg\nYSBGUk9NIFJ1bnRpbWVUZXN0MiBhIikuZ2V0UmVzdWx0TGlzdCgpOwoKICAg\nICAgICBmb3IgKEl0ZXJhdG9yIGl0ciA9IHJ1bnRpbWUycy5pdGVyYXRvcigp\nOyBpdHIuaGFzTmV4dCgpOykKICAgICAgICAgICAgdGVtcDIgPSAoUnVudGlt\nZVRlc3QyKSBpdHIubmV4dCgpOwogICAgICAgIGVuZFR4KHBtKTsKICAgIH0K\nCiAgICBwcm90ZWN0ZWQgdm9pZCBzZWVkRGF0YVN0b3JlKE9wZW5KUEFFbnRp\ndHlNYW5hZ2VyIHBtLCBpbnQgbnVtT2JqZWN0cykgewogICAgICAgIHN0YXJ0\nVHgocG0pOwogICAgICAgIC8vIGNyZWF0ZSBvYmplY3RzCiAgICAgICAgUnVu\ndGltZVRlc3QxW10gcGVyc2lzdGFibGVzID0gbmV3IFJ1bnRpbWVUZXN0MVtu\ndW1PYmplY3RzXTsKICAgICAgICBfcnVudGltZTFzT2lkcyA9IG5ldyBPYmpl\nY3RbbnVtT2JqZWN0c107CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBw\nZXJzaXN0YWJsZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgcGVyc2lz\ndGFibGVzW2ldID0gbmV3IFJ1bnRpbWVUZXN0MSgiZm9vICMiICsgaSwgaSk7\nCiAgICAgICAgICAgIHBtLnBlcnNpc3QocGVyc2lzdGFibGVzW2ldKTsKICAg\nICAgICAgICAgX3J1bnRpbWUxc09pZHNbaV0gPSBwbS5nZXRPYmplY3RJZChw\nZXJzaXN0YWJsZXNbaV0pOwogICAgICAgICAgICBpZiAoaSA9PSAwKSB7CiAg\nICAgICAgICAgICAgICBwZXJzaXN0YWJsZXNbaV0uc2V0U3RyaW5nRmllbGQo\nIlNwZWNpYWxSdW50aW1lVGVzdDEiKTsKICAgICAgICAgICAgICAgIHNwZWNf\nb2lkID0gcG0uZ2V0T2JqZWN0SWQocGVyc2lzdGFibGVzW2ldKTsKICAgICAg\nICAgICAgfQogICAgICAgIH0KICAgICAgICBSdW50aW1lVGVzdDJbXSBwZXJz\naXN0YWJsZXMyID0gbmV3IFJ1bnRpbWVUZXN0MltudW1PYmplY3RzXTsKICAg\nICAgICBfcnVudGltZTJzT2lkcyA9IG5ldyBPYmplY3RbbnVtT2JqZWN0c107\nCiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBwZXJzaXN0YWJsZXMyLmxl\nbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIHBlcnNpc3RhYmxlczJbaV0gPSBu\nZXcgUnVudGltZVRlc3QyKCJiYXIgIyIgKyBpLCBpKTsKICAgICAgICAgICAg\ncG0ucGVyc2lzdChwZXJzaXN0YWJsZXMyW2ldKTsKICAgICAgICAgICAgX3J1\nbnRpbWUyc09pZHNbaV0gPSBwbS5nZXRPYmplY3RJZChwZXJzaXN0YWJsZXMy\nW2ldKTsKICAgICAgICB9CiAgICAgICAgZW5kVHgocG0pOwogICAgfQoKICAg\nIHN0YXRpYyBpbnQgX2ZldGNoR3JvdXBTZXJpYWwgPSAwOwoKICAgIHByb3Rl\nY3RlZCBPcGVuSlBBRW50aXR5TWFuYWdlckZhY3RvcnkgY3JlYXRlRGlzdGlu\nY3RGYWN0b3J5KAogICAgICAgIENsYXNzIHByb3ZpZGVyQ2xhc3MsIFN0cmlu\nZyBjbGFzc1Byb3BzMSkgewogICAgICAgIE1hcCBwcm9wc01hcDsKCiAgICAg\nICAgaWYgKHByb3ZpZGVyQ2xhc3MgIT0gbnVsbCkgewogICAgICAgICAgICAv\nLyBUaGlzIHRlc3QgaXMgZm9yIHRoZSBjb21iaW5hdGlvbiBvZiBSQ1AsIGxh\ncmdlVHJhbnMsCiAgICAgICAgICAgIC8vIGFuZCBLb2RvJ3MgYnVpbHRpbiBE\nYXRhQ2FjaGUuCiAgICAgICAgICAgIC8vIHVzZSB0aGlzIHByb3BlcnR5IHRv\nIGRpZmZlcmVudGlhdGUgdGhlIGZhY3RvcnkKCiAgICAgICAgICAgIHByb3Bz\nTWFwID0gbmV3IEhhc2hNYXAoKTsKICAgICAgICAgICAgcHJvcHNNYXAucHV0\nKCJvcGVuanBhLkRhdGFDYWNoZSIsICJscnUiKTsKICAgICAgICAgICAgcHJv\ncHNNYXAucHV0KCJvcGVuanBhLlJlbW90ZUNvbW1pdFByb3ZpZGVyIiwgQ29u\nZmlndXJhdGlvbnMuZ2V0UGx1Z2luKAogICAgICAgICAgICAgICAgcHJvdmlk\nZXJDbGFzcy5nZXROYW1lKCksIGNsYXNzUHJvcHMxKSk7CiAgICAgICAgICAg\nIHByb3BzTWFwLnB1dCgib3BlbmpwYS5GZXRjaEdyb3VwcyIsICJkaWZmZXJl\nbnRpYXRpbmdGZXRjaEdyb3VwIgogICAgICAgICAgICAgICAgKyBfZmV0Y2hH\ncm91cFNlcmlhbCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgLy8g\nTm8gUkNQCiAgICAgICAgICAgIHByb3BzTWFwID0gbmV3IEhhc2hNYXAoKTsK\nICAgICAgICAgICAgcHJvcHNNYXAucHV0KCJvcGVuanBhLlJlbW90ZUNvbW1p\ndFByb3ZpZGVyIiwgInNqdm0iKTsKICAgICAgICAgICAgcHJvcHNNYXAucHV0\nKCJvcGVuanBhLkZldGNoR3JvdXBzIiwgImRpZmZlcmVudGlhdGluZ0ZldGNo\nR3JvdXAiCiAgICAgICAgICAgICAgICArIF9mZXRjaEdyb3VwU2VyaWFsKTsK\nICAgICAgICB9CiAgICAgICAgX2ZldGNoR3JvdXBTZXJpYWwgKz0gMTsKCiAg\nICAgICAgcmV0dXJuIChPcGVuSlBBRW50aXR5TWFuYWdlckZhY3RvcnkpIGdl\ndEVtZihwcm9wc01hcCk7CiAgICB9CgogICAgcHJpdmF0ZSB2b2lkIHBhdXNl\nKGRvdWJsZSBzZWNvbmRzKSB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAg\nVGhyZWFkLmN1cnJlbnRUaHJlYWQoKS55aWVsZCgpOwogICAgICAgICAgICBU\naHJlYWQuY3VycmVudFRocmVhZCgpLnNsZWVwKChpbnQpIHNlY29uZHMgKiAx\nMDAwKTsKICAgICAgICB9CiAgICAgICAgY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7\nCiAgICAgICAgfQogICAgfQp9CgovKgogcmVtb3ZlIGFsbCBSdW50ZWltMSwg\nYW5kIDIKIGNyZWF0ZSBhIGZldyAxIGFuZCAycwogZ2V0IHRoZW0gaW50byB0\naGUgY2FjaGUsIGFzc2VydAogbGFyZ2UgdHJhbnNhY3Rpb24sIGFuZCBtb2Rp\nZnkgYSBydW50aW1lMiwgYXNzZXJ0IGNhY2hlIG9ubHkgaGFzIHJ1bnRpbWUx\ncwoKCiByZW1vdmUgYWxsIFJ1bnRlaW0xLCBhbmQgMgogY3JlYXRlIGEgZmV3\nIDEgYW5kIDJzCiBnZXQgdGhlbSBpbnRvIHRoZSBjYWNoZSwgYXNzZXJ0CiBs\nYXJnZSB0cmFuc2FjdGlvbiwgZGVsZXRlIGEgcnVudGltZTIsIGFzc2VydCBj\nYWNoZSBvbmx5IGhhcyBydW50ZWltZTFzCiAqLwoK\n","encoding":"base64"}

