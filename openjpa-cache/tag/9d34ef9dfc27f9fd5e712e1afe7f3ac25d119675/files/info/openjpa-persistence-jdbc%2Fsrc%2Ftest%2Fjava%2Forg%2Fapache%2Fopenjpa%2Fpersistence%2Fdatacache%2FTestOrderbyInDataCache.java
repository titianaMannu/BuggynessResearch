{"sha":"967c95b882d7744b172ad4a362a8796cff51df68","node_id":"MDQ6QmxvYjIwNjM2NDo5NjdjOTViODgyZDc3NDRiMTcyYWQ0YTM2MmE4Nzk2Y2ZmNTFkZjY4","size":4395,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/967c95b882d7744b172ad4a362a8796cff51df68","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNr\nYWdlIG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5kYXRhY2FjaGU7\nCgppbXBvcnQgamF2YXgucGVyc2lzdGVuY2UuRW50aXR5TWFuYWdlcjsKCmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UudGVzdC5TaW5n\nbGVFTUZUZXN0Q2FzZTsKCi8qKgogKiBEZWZpbmVkIG9yZGVyaW5nIGlzIG9u\nbHkgYXBwbGllZCB3aGVuIHRoZSBjb2xsZWN0aW9uIGlzIGxvYWRlZCBmcm9t\nIHRoZSBkYXRhc3RvcmUuCiAqIEl0IGlzIG5vdCBtYWludGFpbmVkIGJ5IE9w\nZW5qcGEgYXMgeW91IG1vZGlmeSB0aGUgY29sbGVjdGlvbiBpbiBtZW1vcnku\nIAogKiBPcGVuanBhIGludmFsaWQgZGF0YSBjYWNoZSBpbiBjYXNlIHRoZSBw\nZXJzaXN0ZW5jZSBvcGVyYXRpb24gbWF5IHJlc3VsdCBjYWNoZSBpbiB3cm9u\nZyBvcmRlci4KICogVGhpcyB0ZXN0IHN1aXRlIHRlc3RzIHZhcmlvdXMgY2Fz\nZXMgZm9yIHRoZSBhYm92ZSBwcm9ibGVtLgogKi8KcHVibGljIGNsYXNzIFRl\nc3RPcmRlcmJ5SW5EYXRhQ2FjaGUgZXh0ZW5kcyBTaW5nbGVFTUZUZXN0Q2Fz\nZSB7Cglwcml2YXRlIGxvbmcgcGlkOwogICAgcHVibGljIHZvaWQgc2V0VXAo\nKSB7CiAgICAgICAgc2V0VXAoIm9wZW5qcGEuRGF0YUNhY2hlIiwgInRydWUi\nLCAKICAgICAgICAgICAgIm9wZW5qcGEuUmVtb3RlQ29tbWl0UHJvdmlkZXIi\nLCAic2p2bSIsIAogICAgICAgICAgICBPcmRlcmVkT25lTWFueVBhcmVudC5j\nbGFzcywKICAgICAgICAgICAgT3JkZXJlZE9uZU1hbnlDaGlsZC5jbGFzcywg\nQ0xFQVJfVEFCTEVTKTsKCiAgICAgICAgRW50aXR5TWFuYWdlciBlbSA9IGVt\nZi5jcmVhdGVFbnRpdHlNYW5hZ2VyKCk7CiAgICAgICAgZW0uZ2V0VHJhbnNh\nY3Rpb24oKS5iZWdpbigpOwogICAgICAgIE9yZGVyZWRPbmVNYW55UGFyZW50\nIHBydCA9IG5ldyBPcmRlcmVkT25lTWFueVBhcmVudCgpOwogICAgICAgIHBy\ndC5zZXROYW1lKCJNYXJpYSIpOwogICAgICAgIGVtLnBlcnNpc3QocHJ0KTsK\nICAgICAgICAvL2luc2VydCBjaGlsZCBpbiByZXZlcnNlIG9yZGVyCiAgICAg\nICAgZm9yIChpbnQgaSA9IDQ7IGkgPiAxOyBpLS0pIHsKICAgICAgICAJT3Jk\nZXJlZE9uZU1hbnlDaGlsZCBjaGlsZCA9IG5ldyBPcmRlcmVkT25lTWFueUNo\naWxkKCk7CiAgICAgICAgICAgIGNoaWxkLnNldElkKGkpOwogICAgICAgICAg\nICBjaGlsZC5zZXROYW1lKCJjaGlsZCIgKyBpKTsKICAgICAgICAgICAgY2hp\nbGQuc2V0UGFyZW50KHBydCk7CiAgICAgICAgICAgIHBydC5nZXRDaGlsZHJl\nbigpLmFkZChjaGlsZCk7CiAgICAgICAgICAgIGVtLnBlcnNpc3QoY2hpbGQp\nOwogICAgICAgIH0gICAgICAgIAogICAgICAgIGVtLmdldFRyYW5zYWN0aW9u\nKCkuY29tbWl0KCk7CiAgICAgICAgcGlkID0gcHJ0LmdldElkKCk7CiAgICAg\nICAgZW0uY2xvc2UoKTsKICAgIH0KCiAgICAvKioKICAgICAqIFRlc3QgaWYg\nY2hpbGQgbGlzdCBpcyBpbiBvcmRlciBhZnRlciBuZXcgY2hpbGQgbGlzdCBp\ncyBhZGRlZCBpbiBzZXR1cCgpLgogICAgICoKICAgICAqLwogICAgcHVibGlj\nIHZvaWQgdGVzdEdldENoaWxkTGlzdCgpewogICAgCUVudGl0eU1hbmFnZXIg\nZW0gPSBlbWYuY3JlYXRlRW50aXR5TWFuYWdlcigpOwogICAgCU9yZGVyZWRP\nbmVNYW55UGFyZW50IHBydCA9IGVtLmZpbmQoT3JkZXJlZE9uZU1hbnlQYXJl\nbnQuY2xhc3MsIHBpZCk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKDMsIHBydC5n\nZXRDaGlsZHJlbigpLnNpemUoKSk7CiAgICAgICAgLy90aGUgb3JkZXIgc2hv\ndWxkIGJlICJjaGlsZDIiLCAiY2hpbGQzIiwgImNoaWxkNCIKICAgICAgICBm\nb3IgKGludCBpID0gMTsgaSA8IDQ7IGkrKykgewogICAgICAgICAgICBhc3Nl\ncnRFcXVhbHMoImNoaWxkIiArIChpICsgMSksIHBydC5nZXRDaGlsZHJlbigp\nLgogICAgICAgICAgICAgICAgZ2V0KGktMSkuZ2V0TmFtZSgpKTsKICAgICAg\nICB9ICAgCiAgICAgICAgZW0uY2xvc2UoKTsKICAgIH0KICAgIAogICAgcHVi\nbGljIHZvaWQgdGVzdEluc2VydENoaWxkKCkgewogICAgICAgIEVudGl0eU1h\nbmFnZXIgZW0gPSBlbWYuY3JlYXRlRW50aXR5TWFuYWdlcigpOwogICAgICAg\nIGVtLmdldFRyYW5zYWN0aW9uKCkuYmVnaW4oKTsKICAgICAgICBPcmRlcmVk\nT25lTWFueVBhcmVudCBwcnQgPSBlbS5maW5kKE9yZGVyZWRPbmVNYW55UGFy\nZW50LmNsYXNzLCBwaWQpOwogICAgICAgIE9yZGVyZWRPbmVNYW55Q2hpbGQg\nY2hpbGQgPSBuZXcgT3JkZXJlZE9uZU1hbnlDaGlsZCgpOwogICAgICAgIGNo\naWxkLnNldElkKDEpOwogICAgICAgIGNoaWxkLnNldE5hbWUoImNoaWxkMSIp\nOwogICAgICAgIGNoaWxkLnNldFBhcmVudChwcnQpOwogICAgICAgIHBydC5n\nZXRDaGlsZHJlbigpLmFkZChjaGlsZCk7CiAgICAgICAgZW0ucGVyc2lzdChj\naGlsZCk7CiAgICAgICAgZW0uZ2V0VHJhbnNhY3Rpb24oKS5jb21taXQoKTsK\nICAgICAgICBlbS5jbG9zZSgpOwogICAgICAgIAogICAgICAgIC8vb2J0YWlu\nIG9iamVjdCBpbiBuZXcgcGVyc2lzdGVuY2UgY29udGV4dAogICAgICAgIGVt\nID0gZW1mLmNyZWF0ZUVudGl0eU1hbmFnZXIoKTsKICAgICAgICBwcnQgPSBl\nbS5maW5kKE9yZGVyZWRPbmVNYW55UGFyZW50LmNsYXNzLCBwaWQpOwogICAg\nICAgIGFzc2VydEVxdWFscyg0LCBwcnQuZ2V0Q2hpbGRyZW4oKS5zaXplKCkp\nOwogICAgICAgIC8vdGhlIG9yZGVyIHNob3VsZCBiZSAiY2hpbGQxIiwgImNo\naWxkMiIsICJjaGlsZDMiLCAiY2hpbGQ0IgogICAgICAgIGZvciAoaW50IGkg\nPSAxOyBpIDwgNTsgaSsrKSB7CiAgICAgICAgICAgIGFzc2VydEVxdWFscygi\nY2hpbGQiICsgaSwgcHJ0LmdldENoaWxkcmVuKCkuCiAgICAgICAgICAgICAg\nICBnZXQoaS0xKS5nZXROYW1lKCkpOwogICAgICAgIH0gICAgICAgICAgCiAg\nICAgICAgZW0uY2xvc2UoKTsKICAgIH0KICAgIAogICAgcHVibGljIHZvaWQg\ndGVzdFVwZGF0ZUNoaWxkTmFtZSgpIHsKICAgICAgICBFbnRpdHlNYW5hZ2Vy\nIGVtID0gZW1mLmNyZWF0ZUVudGl0eU1hbmFnZXIoKTsKICAgICAgICBlbS5n\nZXRUcmFuc2FjdGlvbigpLmJlZ2luKCk7CiAgICAgICAgT3JkZXJlZE9uZU1h\nbnlDaGlsZCBjaGlsZCA9IGVtLmZpbmQoT3JkZXJlZE9uZU1hbnlDaGlsZC5j\nbGFzcywgNCk7CiAgICAgICAgY2hpbGQuc2V0TmFtZSgiY2hpbGQxIik7CiAg\nICAgICAgZW0ucGVyc2lzdChjaGlsZCk7CiAgICAgICAgZW0uZ2V0VHJhbnNh\nY3Rpb24oKS5jb21taXQoKTsKICAgICAgICBPcmRlcmVkT25lTWFueVBhcmVu\ndCBwcnQgPSBlbS5maW5kKE9yZGVyZWRPbmVNYW55UGFyZW50LmNsYXNzLCBw\naWQpOwogICAgICAgIGFzc2VydEVxdWFscygzLCBwcnQuZ2V0Q2hpbGRyZW4o\nKS5zaXplKCkpOwogICAgICAgIC8vdGhlIG9yZGVyIHNob3VsZCBiZSAiY2hp\nbGQxIiwgImNoaWxkMiIsICJjaGlsZDMiCiAgICAgICAgZm9yIChpbnQgaSA9\nIDE7IGkgPCA0OyBpKyspIHsKICAgICAgICAgICAgYXNzZXJ0RXF1YWxzKCJj\naGlsZCIgKyBpLCBwcnQuZ2V0Q2hpbGRyZW4oKS4KICAgICAgICAgICAgICAg\nIGdldChpLTEpLmdldE5hbWUoKSk7CiAgICAgICAgfSAgICAgICAgICAKICAg\nICAgICBlbS5jbG9zZSgpOyAgICAJCiAgICB9Cn0K\n","encoding":"base64"}

