{"sha":"d45a0fa0f1570f3f28ddd324cef2a4e68464b39f","node_id":"MDQ6QmxvYjIwNjM2NDpkNDVhMGZhMGYxNTcwZjNmMjhkZGQzMjRjZWYyYTRlNjg0NjRiMzlm","size":18992,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/d45a0fa0f1570f3f28ddd324cef2a4e68464b39f","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuZW5oYW5j\nZTsKCmltcG9ydCBqYXZhLmxhbmcucmVmbGVjdC5NZXRob2Q7CmltcG9ydCBq\nYXZhLnV0aWwuSGFzaE1hcDsKaW1wb3J0IGphdmEudXRpbC5MaXN0OwppbXBv\ncnQgamF2YS51dGlsLk1hcDsKaW1wb3J0IGphdmF4LnBlcnNpc3RlbmNlLkVu\ndGl0eU1hbmFnZXI7CmltcG9ydCBqYXZheC5wZXJzaXN0ZW5jZS5FbnRpdHlN\nYW5hZ2VyRmFjdG9yeTsKCgppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnBl\ncnNpc3RlbmNlLmVuaGFuY2UuY29tbW9uLmFwcHMuQmFja2luZ0ZpZWxkTmFt\nZU1pc21hdGNoSW5zdGFuY2U7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\ncGVyc2lzdGVuY2UuZW5oYW5jZS5jb21tb24uYXBwcy5CYXNlRW50aXR5Owpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNlLmVuaGFuY2Uu\nY29tbW9uLmFwcHMuQmFzaWNTdWJjbGFzc0luc3RhbmNlOwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNlLmVuaGFuY2UuY29tbW9uLmFw\ncHMuRGVyaXZlZEVudGl0eTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5w\nZXJzaXN0ZW5jZS5lbmhhbmNlLmNvbW1vbi5hcHBzLkVudGl0eTE7CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuZW5oYW5jZS5jb21t\nb24uYXBwcy5NYW5hZ2VkSW52ZXJzZVRlc3RJbnN0YW5jZTsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5lbmhhbmNlLmNvbW1vbi5h\ncHBzLk1hbmFnZWRJbnZlcnNlVGVzdEluc3RhbmNlMjsKaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5lbmhhbmNlLmNvbW1vbi5hcHBz\nLlN1YmNsYXNzVGVzdEluc3RhbmNlOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLnBlcnNpc3RlbmNlLmNvbW1vbi51dGlscy5BYnN0cmFjdFRlc3RDYXNl\nOwppbXBvcnQganVuaXQuZnJhbWV3b3JrLkFzc2VydGlvbkZhaWxlZEVycm9y\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5Ccm9rZXI7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLk9wZW5KUEFTdGF0ZU1h\nbmFnZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YS5DbGFzc01l\ndGFEYXRhOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuRmllbGRN\nZXRhRGF0YTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5j\nZS5KUEFGYWNhZGVIZWxwZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\ncGVyc2lzdGVuY2UuT3BlbkpQQUVudGl0eU1hbmFnZXI7CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuT3BlbkpQQVF1ZXJ5OwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuRXhjZXB0aW9uSW5mbzsKaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLkltcGxIZWxwZXI7CgpwdWJs\naWMgY2xhc3MgVGVzdFN1YmNsYXNzZWRCZWhhdmlvciBleHRlbmRzIEFic3Ry\nYWN0VGVzdENhc2UgewoKICAgIHB1YmxpYyBUZXN0U3ViY2xhc3NlZEJlaGF2\naW9yKFN0cmluZyBuYW1lKSB7CiAgICAgICAgc3VwZXIobmFtZSwgImVuaGFu\nY2VjYWN0dXNhcHAiKTsKICAgIH0KCgogICAgcHVibGljIHZvaWQgc2V0VXAo\nKSB7CiAgICAgICAgZGVsZXRlQWxsKEJhc2ljU3ViY2xhc3NJbnN0YW5jZS5j\nbGFzcyk7CiAgICAgICAgZGVsZXRlQWxsKEJhY2tpbmdGaWVsZE5hbWVNaXNt\nYXRjaEluc3RhbmNlLmNsYXNzKTsKICAgICAgICBkZWxldGVBbGwoQmFzZUVu\ndGl0eS5jbGFzcyk7CiAgICAgICAgZGVsZXRlQWxsKE1hbmFnZWRJbnZlcnNl\nVGVzdEluc3RhbmNlLmNsYXNzKTsKICAgICAgICBkZWxldGVBbGwoTWFuYWdl\nZEludmVyc2VUZXN0SW5zdGFuY2UyLmNsYXNzKTsKICAgIH0KCiAgICBwdWJs\naWMgdm9pZCB0ZXN0SW5oZXJpdGFuY2UoKSB7CiAgICAgICAgT3BlbkpQQUVu\ndGl0eU1hbmFnZXIgcG0gPQogICAgICAgICAgICAoT3BlbkpQQUVudGl0eU1h\nbmFnZXIpIGN1cnJlbnRFbnRpdHlNYW5hZ2VyKCk7CiAgICAgICAgRGVyaXZl\nZEVudGl0eSBkZSA9IChEZXJpdmVkRW50aXR5KSBuZXdJbnN0YW5jZShwbSwg\nRGVyaXZlZEVudGl0eS5jbGFzcyk7CiAgICAgICAgQmFzaWNTdWJjbGFzc0lu\nc3RhbmNlIGJhc2ljID0gKEJhc2ljU3ViY2xhc3NJbnN0YW5jZSkgbmV3SW5z\ndGFuY2UocG0sCiAgICAgICAgICAgIEJhc2ljU3ViY2xhc3NJbnN0YW5jZS5j\nbGFzcyk7CiAgICAgICAgYmFzaWMuc2V0U3RyaW5nRmllbGQoImJhc2ljIG9u\nZS10by1vbmUiKTsKICAgICAgICBkZS5zZXRPbmVUb09uZShiYXNpYyk7CiAg\nICAgICAgT2JqZWN0IG9pZCA9IHBlcnNpc3RlbmNlT3BlcmF0aW9ucyhwbSwg\nZGUsIGZhbHNlKTsKCiAgICAgICAgLy8gIyMjIyMgbmVlZCBhIHRlc3QgY2Fz\nZSBmb3IgSkRPSGVscGVyLmNyZWF0ZUVudGl0eU1hbmFnZXIoKSBmb3IKICAg\nICAgICAvLyBzdWJjbGFzcwogICAgICAgIENsYXNzTWV0YURhdGEgbWV0YSA9\nIEpQQUZhY2FkZUhlbHBlci5nZXRNZXRhRGF0YShwbSwgZGUuZ2V0Q2xhc3Mo\nKSk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKEJhc2VFbnRpdHkuY2xhc3MsIG1l\ndGEuZ2V0UENTdXBlcmNsYXNzKCkpOwoKICAgICAgICBwbSA9IChPcGVuSlBB\nRW50aXR5TWFuYWdlcikgY3VycmVudEVudGl0eU1hbmFnZXIoKTsKCiAgICAg\nICAgT2JqZWN0IG8gPSBwbS5maW5kKERlcml2ZWRFbnRpdHkuY2xhc3MsIG9p\nZCk7CiAgICAgICAgYXNzZXJ0VHJ1ZShvIGluc3RhbmNlb2YgRGVyaXZlZEVu\ndGl0eSk7CiAgICAgICAgZGUgPSAoRGVyaXZlZEVudGl0eSkgbzsKICAgICAg\nICBCcm9rZXIgYiA9IEpQQUZhY2FkZUhlbHBlci50b0Jyb2tlcihwbSk7CiAg\nICAgICAgT3BlbkpQQVN0YXRlTWFuYWdlciBzbSA9IGIuZ2V0U3RhdGVNYW5h\nZ2VyKGRlKTsKICAgICAgICAvLyB3ZSB1c2UgZ2V0TG9hZGVkKCkgaGVyZSBi\nZWNhdXNlIGlzTG9hZGVkKCkgYWx3YXlzIHJldHVybnMgdHJ1ZS4KICAgICAg\nICBhc3NlcnRGYWxzZShzbS5nZXRMb2FkZWQoKS5nZXQoCiAgICAgICAgICAg\nIHNtLmdldE1ldGFEYXRhKCkuZ2V0RmllbGQoIm9uZVRvT25lIikuZ2V0SW5k\nZXgoKSkpOwogICAgICAgIGFzc2VydEVxdWFscygiYmFzaWMgb25lLXRvLW9u\nZSIsIGRlLmdldE9uZVRvT25lKCkuZ2V0U3RyaW5nRmllbGQoKSk7CiAgICAg\nICAgYXNzZXJ0VHJ1ZShzbS5nZXRMb2FkZWQoKS5nZXQoc20uZ2V0TWV0YURh\ndGEoKQogICAgICAgICAgICAuZ2V0RmllbGQoIm9uZVRvT25lIikuZ2V0SW5k\nZXgoKSkpOwoKICAgICAgICBzdGFydFR4KHBtKTsKICAgICAgICBwbS5yZW1v\ndmUoZGUpOwogICAgICAgIGVuZFR4KHBtKTsKICAgICAgICBlbmRFbShwbSk7\nCiAgICB9CgogICAgcHVibGljIHZvaWQgdGVzdEJhc2ljU3ViY2xhc3NQZXJz\naXN0ZW5jZU9wZXJhdGlvbnMoKQogICAgICAgIHRocm93cyBDbGFzc05vdEZv\ndW5kRXhjZXB0aW9uIHsKICAgICAgICBPcGVuSlBBRW50aXR5TWFuYWdlciBw\nbSA9CiAgICAgICAgICAgIChPcGVuSlBBRW50aXR5TWFuYWdlcikgY3VycmVu\ndEVudGl0eU1hbmFnZXIoKTsKICAgICAgICBCYXNpY1N1YmNsYXNzSW5zdGFu\nY2UgbyA9IChCYXNpY1N1YmNsYXNzSW5zdGFuY2UpIG5ld0luc3RhbmNlKHBt\nLAogICAgICAgICAgICBCYXNpY1N1YmNsYXNzSW5zdGFuY2UuY2xhc3MpOwog\nICAgICAgIHBlcnNpc3RlbmNlT3BlcmF0aW9ucyhwbSwgbywgdHJ1ZSk7CiAg\nICB9CgogICAgcHVibGljIHZvaWQgdGVzdEJhY2tpbmdGaWVsZE5hbWVNaXNt\nYXRjaCgpIHsKICAgICAgICBPcGVuSlBBRW50aXR5TWFuYWdlciBwbSA9CiAg\nICAgICAgICAgIChPcGVuSlBBRW50aXR5TWFuYWdlcikgY3VycmVudEVudGl0\neU1hbmFnZXIoKTsKICAgICAgICBCYWNraW5nRmllbGROYW1lTWlzbWF0Y2hJ\nbnN0YW5jZSBvID0gKEJhY2tpbmdGaWVsZE5hbWVNaXNtYXRjaEluc3RhbmNl\nKQogICAgICAgICAgICBuZXdJbnN0YW5jZShwbSwgQmFja2luZ0ZpZWxkTmFt\nZU1pc21hdGNoSW5zdGFuY2UuY2xhc3MpOwogICAgICAgIHBlcnNpc3RlbmNl\nT3BlcmF0aW9ucyhwbSwgbywgdHJ1ZSk7CiAgICB9CgogICAgcHJpdmF0ZSBP\nYmplY3QgbmV3SW5zdGFuY2UoT3BlbkpQQUVudGl0eU1hbmFnZXIgcG0sIENs\nYXNzIGNscykgewogICAgICAgIHJldHVybiBwbS5jcmVhdGVJbnN0YW5jZShj\nbHMpOwogICAgfQoKICAgIHByaXZhdGUgT2JqZWN0IGNyZWF0ZUluc3RhbmNl\nKEVudGl0eU1hbmFnZXIgZW0sIENsYXNzIGNscykgewogICAgICAgIHJldHVy\nbiAoKE9wZW5KUEFFbnRpdHlNYW5hZ2VyKSBlbSkuY3JlYXRlSW5zdGFuY2Uo\nY2xzKTsKICAgIH0KCiAgICBwcml2YXRlIE9iamVjdCBwZXJzaXN0ZW5jZU9w\nZXJhdGlvbnMoT3BlbkpQQUVudGl0eU1hbmFnZXIgcG0sCiAgICAgICAgU3Vi\nY2xhc3NUZXN0SW5zdGFuY2UgbywgYm9vbGVhbiBkZWxldGUpIHsKICAgICAg\nICBzdGFydFR4KHBtKTsKICAgICAgICBwbS5wZXJzaXN0KG8pOwogICAgICAg\nIG8uc2V0U3RyaW5nRmllbGQoIm5ldyBwZXJzaXN0ZW50IGluc3RhbmNlIik7\nCiAgICAgICAgZW5kVHgocG0pOwogICAgICAgIE9iamVjdCBvaWQgPSBwbS5n\nZXRPYmplY3RJZChvKTsKICAgICAgICBlbmRFbShwbSk7CgogICAgICAgIHBt\nID0gKE9wZW5KUEFFbnRpdHlNYW5hZ2VyKSBjdXJyZW50RW50aXR5TWFuYWdl\ncigpOwogICAgICAgIG8gPSAoU3ViY2xhc3NUZXN0SW5zdGFuY2UpIHBtLmZp\nbmQoU3ViY2xhc3NUZXN0SW5zdGFuY2UuY2xhc3MsIG9pZCk7CgogICAgICAg\nIGFzc2VydEVxdWFscygibmV3IHBlcnNpc3RlbnQgaW5zdGFuY2UiLCBvLmdl\ndFN0cmluZ0ZpZWxkKCkpOwogICAgICAgIHN0YXJ0VHgocG0pOwogICAgICAg\nIG8uc2V0U3RyaW5nRmllbGQoIm1vZGlmaWVkIHBlcnNpc3RlbnQgaW5zdGFu\nY2UiKTsKICAgICAgICBlbmRUeChwbSk7CiAgICAgICAgZW5kRW0ocG0pOwoK\nICAgICAgICBpZiAoZGVsZXRlKSB7CiAgICAgICAgICAgIHBtID0gKE9wZW5K\nUEFFbnRpdHlNYW5hZ2VyKSBjdXJyZW50RW50aXR5TWFuYWdlcigpOwogICAg\nICAgICAgICBvID0gKFN1YmNsYXNzVGVzdEluc3RhbmNlKSBwbS5maW5kKFN1\nYmNsYXNzVGVzdEluc3RhbmNlLmNsYXNzLCBvaWQpOwogICAgICAgICAgICBh\nc3NlcnRFcXVhbHMoIm1vZGlmaWVkIHBlcnNpc3RlbnQgaW5zdGFuY2UiLCBv\nLmdldFN0cmluZ0ZpZWxkKCkpOwogICAgICAgICAgICBzdGFydFR4KHBtKTsK\nICAgICAgICAgICAgcG0ucmVtb3ZlKG8pOwogICAgICAgICAgICBlbmRUeChw\nbSk7CiAgICAgICAgICAgIGVuZEVtKHBtKTsKICAgICAgICAgICAgcmV0dXJu\nIG51bGw7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmV0dXJuIG9p\nZDsKICAgICAgICB9CiAgICB9CgogICAgcHVibGljIHZvaWQgdGVzdFBvbHlt\nb3JwaGljUXVlcmllcygpIHsKICAgICAgICBkZWxldGVBbGwoQmFzZUVudGl0\neS5jbGFzcyk7CiAgICAgICAgZGVsZXRlQWxsKEJhc2ljU3ViY2xhc3NJbnN0\nYW5jZS5jbGFzcyk7CgogICAgICAgIE9wZW5KUEFFbnRpdHlNYW5hZ2VyIHBt\nID0KICAgICAgICAgICAgKE9wZW5KUEFFbnRpdHlNYW5hZ2VyKSBjdXJyZW50\nRW50aXR5TWFuYWdlcigpOwogICAgICAgIHN0YXJ0VHgocG0pOwoKICAgICAg\nICBCYXNlRW50aXR5IGJlID0gKEJhc2VFbnRpdHkpIG5ld0luc3RhbmNlKHBt\nLCBCYXNlRW50aXR5LmNsYXNzKTsKICAgICAgICBiZS5zZXRTaG9ydEZpZWxk\nKChzaG9ydCkgMCk7CiAgICAgICAgcG0ucGVyc2lzdChiZSk7CgogICAgICAg\nIGJlID0gKEJhc2VFbnRpdHkpIG5ld0luc3RhbmNlKHBtLCBCYXNlRW50aXR5\nLmNsYXNzKTsKICAgICAgICBiZS5zZXRTaG9ydEZpZWxkKChzaG9ydCkgMSk7\nCiAgICAgICAgcG0ucGVyc2lzdChiZSk7CgogICAgICAgIERlcml2ZWRFbnRp\ndHkgZGUgPSAoRGVyaXZlZEVudGl0eSkgbmV3SW5zdGFuY2UocG0sIERlcml2\nZWRFbnRpdHkuY2xhc3MpOwogICAgICAgIGRlLnNldFNob3J0RmllbGQoKHNo\nb3J0KSAyKTsKICAgICAgICBkZS5zZXRPbmVUb09uZSgoQmFzaWNTdWJjbGFz\nc0luc3RhbmNlKSBuZXdJbnN0YW5jZShwbSwKICAgICAgICAgICAgQmFzaWNT\ndWJjbGFzc0luc3RhbmNlLmNsYXNzKSk7CiAgICAgICAgcG0ucGVyc2lzdChk\nZSk7CgogICAgICAgIGRlID0gKERlcml2ZWRFbnRpdHkpIG5ld0luc3RhbmNl\nKHBtLCBEZXJpdmVkRW50aXR5LmNsYXNzKTsKICAgICAgICBkZS5zZXRTaG9y\ndEZpZWxkKChzaG9ydCkgMyk7CiAgICAgICAgZGUuc2V0T25lVG9PbmUoKEJh\nc2ljU3ViY2xhc3NJbnN0YW5jZSkgbmV3SW5zdGFuY2UocG0sCiAgICAgICAg\nICAgIEJhc2ljU3ViY2xhc3NJbnN0YW5jZS5jbGFzcykpOwogICAgICAgIHBt\nLnBlcnNpc3QoZGUpOwoKICAgICAgICBlbmRUeChwbSk7CiAgICAgICAgZW5k\nRW0ocG0pOwoKICAgICAgICBwbSA9IChPcGVuSlBBRW50aXR5TWFuYWdlcikg\nY3VycmVudEVudGl0eU1hbmFnZXIoKTsKICAgICAgICBPcGVuSlBBUXVlcnkg\ncSA9CiAgICAgICAgICAgIHBtLmNyZWF0ZVF1ZXJ5KCJTRUxFQ1QgYSBGUk9N\nIEJhc2VFbnRpdHkgYSAiCiAgICAgICAgICAgICAgICArICJPUkRFUiBCWSBh\nLnNob3J0RmllbGQgQVNDIik7CiAgICAgICAgTGlzdCBsID0gKExpc3QpIHEu\nZ2V0UmVzdWx0TGlzdCgpOwogICAgICAgIGFzc2VydEVxdWFscyg0LCBsLnNp\nemUoKSk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKDAsICgoQmFzZUVudGl0eSkg\nbC5nZXQoMCkpLmdldFNob3J0RmllbGQoKSk7CiAgICAgICAgYXNzZXJ0RXF1\nYWxzKDEsICgoQmFzZUVudGl0eSkgbC5nZXQoMSkpLmdldFNob3J0RmllbGQo\nKSk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKDIsICgoQmFzZUVudGl0eSkgbC5n\nZXQoMikpLmdldFNob3J0RmllbGQoKSk7CiAgICAgICAgYXNzZXJ0RXF1YWxz\nKDMsICgoQmFzZUVudGl0eSkgbC5nZXQoMykpLmdldFNob3J0RmllbGQoKSk7\nCiAgICAgICAgYXNzZXJ0VHJ1ZShsLmdldCgyKSBpbnN0YW5jZW9mIERlcml2\nZWRFbnRpdHkpOwogICAgICAgIGFzc2VydFRydWUobC5nZXQoMykgaW5zdGFu\nY2VvZiBEZXJpdmVkRW50aXR5KTsKICAgICAgICBlbmRFbShwbSk7CiAgICB9\nCgogICAgcHVibGljIHZvaWQgdGVzdEVuaGFuY2VkQ2xhc3NDaGFuZ2VzT3V0\nc2lkZVR4V2l0aG91dE5UVygpIHsKICAgICAgICBPcGVuSlBBRW50aXR5TWFu\nYWdlciBwbSA9CiAgICAgICAgICAgIChPcGVuSlBBRW50aXR5TWFuYWdlcikg\nY3VycmVudEVudGl0eU1hbmFnZXIoKTsKICAgICAgICBzdGFydFR4KHBtKTsK\nICAgICAgICBkZWxldGVBbGwoRW50aXR5MS5jbGFzcyk7CiAgICAgICAgZW5k\nVHgocG0pOwogICAgICAgIEVudGl0eTEgbyA9IG5ldyBFbnRpdHkxKDgsICJw\nayA4IiwgNCk7CiAgICAgICAgc3RhcnRUeChwbSk7CiAgICAgICAgcG0ucGVy\nc2lzdChvKTsKICAgICAgICBlbmRUeChwbSk7CiAgICAgICAgT2JqZWN0IG9p\nZCA9IHBtLmdldE9iamVjdElkKG8pOwogICAgICAgIGVuZEVtKHBtKTsKCiAg\nICAgICAgcG0gPSAoT3BlbkpQQUVudGl0eU1hbmFnZXIpIGN1cnJlbnRFbnRp\ndHlNYW5hZ2VyKCk7CiAgICAgICAgbyA9IChFbnRpdHkxKSBwbS5maW5kKEVu\ndGl0eTEuY2xhc3MsIG9pZCk7CgogICAgICAgIHRyeSB7CiAgICAgICAgICAg\nIG8uc2V0U3RyaW5nRmllbGQoImhlbGxvIik7CiAgICAgICAgICAgIGZhaWwo\nIm5vbi10cmFuc2FjdGlvbmFsIHdyaXRlIHNob3VsZCBub3QgYmUgYWxsb3dl\nZCIpOwogICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAg\nICAgIC8vIGV4cGVjdGVkCiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAg\nICAgZW5kRW0ocG0pOwogICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMgdm9p\nZCB0ZXN0U3ViY2xhc3NDaGFuZ2VzT3V0c2lkZVR4V2l0aG91dE5UVygpIHsK\nICAgICAgICBPcGVuSlBBRW50aXR5TWFuYWdlciBwbSA9CiAgICAgICAgICAg\nIChPcGVuSlBBRW50aXR5TWFuYWdlcikgY3VycmVudEVudGl0eU1hbmFnZXIo\nKTsKICAgICAgICBCYXNpY1N1YmNsYXNzSW5zdGFuY2UgYmFzaWMgPSAoQmFz\naWNTdWJjbGFzc0luc3RhbmNlKSBuZXdJbnN0YW5jZShwbSwKICAgICAgICAg\nICAgQmFzaWNTdWJjbGFzc0luc3RhbmNlLmNsYXNzKTsKICAgICAgICBiYXNp\nYy5zZXRTdHJpbmdGaWVsZCgiZm9vIik7CiAgICAgICAgc3RhcnRUeChwbSk7\nCiAgICAgICAgcG0ucGVyc2lzdChiYXNpYyk7CiAgICAgICAgZW5kVHgocG0p\nOwogICAgICAgIE9iamVjdCBvaWQgPSBwbS5nZXRPYmplY3RJZChiYXNpYyk7\nCiAgICAgICAgZW5kRW0ocG0pOwoKICAgICAgICBwbSA9IChPcGVuSlBBRW50\naXR5TWFuYWdlcikgY3VycmVudEVudGl0eU1hbmFnZXIoKTsKICAgICAgICBi\nYXNpYyA9CiAgICAgICAgICAgIChCYXNpY1N1YmNsYXNzSW5zdGFuY2UpIHBt\nLmZpbmQoQmFzaWNTdWJjbGFzc0luc3RhbmNlLmNsYXNzLCBvaWQpOwoKICAg\nICAgICB0cnkgewogICAgICAgICAgICBiYXNpYy5zZXRTdHJpbmdGaWVsZCgi\naGVsbG8iKTsKICAgICAgICAgICAgZmFpbCgibm9uLXRyYW5zYWN0aW9uYWwg\nd3JpdGUgc2hvdWxkIG5vdCBiZSBhbGxvd2VkIik7CiAgICAgICAgfSBjYXRj\naCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgLy8gZXhwZWN0ZWQKICAg\nICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICBlbmRFbShwbSk7CiAgICAg\nICAgfQogICAgfQoKICAgIHB1YmxpYyB2b2lkIHRlc3RCYXNpY1BNVXNlcygp\nIHsKICAgICAgICAvLyByZXRhaW4gc28gd2UgZG9uJ3QgcmVsb2FkIGluIHRo\nZSByZWFkcyBhZnRlciB0aGUgdHggY29tbWl0CiAgICAgICAgT3BlbkpQQUVu\ndGl0eU1hbmFnZXIgcG0gPQogICAgICAgICAgICAoT3BlbkpQQUVudGl0eU1h\nbmFnZXIpIGN1cnJlbnRFbnRpdHlNYW5hZ2VyKCk7CiAgICAgICAgQnJva2Vy\nIGJyb2tlciA9IEpQQUZhY2FkZUhlbHBlci50b0Jyb2tlcihwbSk7CiAgICAg\nICAgc3RhcnRUeChwbSk7CgogICAgICAgIC8vIHJlZ2lzdGVyIGEgbmV3IGlu\nc3RhbmNlIHdpdGggdGhlIFBNCiAgICAgICAgQmFzaWNTdWJjbGFzc0luc3Rh\nbmNlIGJhc2ljID0gKEJhc2ljU3ViY2xhc3NJbnN0YW5jZSkgbmV3SW5zdGFu\nY2UKICAgICAgICAgICAgKHBtLCBCYXNpY1N1YmNsYXNzSW5zdGFuY2UuY2xh\nc3MpOwogICAgICAgIGFzc2VydFRydWUoSW1wbEhlbHBlci5pc01hbmFnZWFi\nbGUoYmFzaWMpKTsKICAgICAgICBiYXNpYy5zZXRTdHJpbmdGaWVsZCgiZm9v\nIik7CiAgICAgICAgcG0ucGVyc2lzdChiYXNpYyk7CiAgICAgICAgYXNzZXJ0\nVHJ1ZShicm9rZXIuaXNOZXcoYmFzaWMpKTsKICAgICAgICBhc3NlcnRUcnVl\nKGJyb2tlci5pc1BlcnNpc3RlbnQoYmFzaWMpKTsKCiAgICAgICAgLy8gY29t\nbWl0LiB0aGlzIHNob3VsZCBjYXVzZSB0aGUgZGF0YSB0byBiZSB3cml0dGVu\nLgogICAgICAgIC8vICMjIyBzaG91bGQgY2hlY2sgU1FMIGNvdW50CiAgICAg\nICAgZW5kVHgocG0pOwoKICAgICAgICBhc3NlcnRGYWxzZShicm9rZXIuaXNO\nZXcoYmFzaWMpKTsKCiAgICAgICAgT3BlbkpQQVN0YXRlTWFuYWdlciBzbSA9\nIGJyb2tlci5nZXRTdGF0ZU1hbmFnZXIoYmFzaWMpOwogICAgICAgIGFzc2Vy\ndE5vdE51bGwoc20pOwogICAgICAgIGFzc2VydEVxdWFscyhzbS5nZXRNYW5h\nZ2VkSW5zdGFuY2UoKSwgYmFzaWMpOwoKICAgICAgICBGaWVsZE1ldGFEYXRh\nIGZtZCA9IHNtLmdldE1ldGFEYXRhKCkuZ2V0RmllbGQoInN0cmluZ0ZpZWxk\nIik7CiAgICAgICAgYXNzZXJ0RXF1YWxzKCJmb28iLCBzbS5mZXRjaChmbWQu\nZ2V0SW5kZXgoKSkpOwogICAgICAgIGFzc2VydFRydWUoc20uZ2V0TG9hZGVk\nKCkuZ2V0KGZtZC5nZXRJbmRleCgpKSk7CgogICAgICAgIHBtLmV2aWN0KGJh\nc2ljKTsKICAgICAgICBhc3NlcnRGYWxzZShzbS5nZXRMb2FkZWQoKS5nZXQo\nZm1kLmdldEluZGV4KCkpKTsKICAgICAgICAvLyBsYXp5IGxvYWRpbmcKICAg\nICAgICBhc3NlcnROb3ROdWxsKGJhc2ljLmdldFN0cmluZ0ZpZWxkKCkpOwog\nICAgICAgIGFzc2VydEVxdWFscygiZm9vIiwgc20uZmV0Y2goZm1kLmdldElu\nZGV4KCkpKTsKICAgICAgICBhc3NlcnRFcXVhbHMoImZvbyIsIGJhc2ljLmdl\ndFN0cmluZ0ZpZWxkKCkpOwogICAgICAgIGFzc2VydFRydWUoc20uZ2V0TG9h\nZGVkKCkuZ2V0KGZtZC5nZXRJbmRleCgpKSk7CgogICAgICAgIHN0YXJ0VHgo\ncG0pOwogICAgICAgIGJhc2ljLnNldFN0cmluZ0ZpZWxkKCJiYXIiKTsKICAg\nICAgICBhc3NlcnRUcnVlKGJyb2tlci5pc0RpcnR5KGJhc2ljKSk7CiAgICAg\nICAgZW5kVHgocG0pOwogICAgICAgIE9iamVjdCBvaWQgPSBicm9rZXIuZ2V0\nT2JqZWN0SWQoYmFzaWMpOwogICAgICAgIGFzc2VydE5vdE51bGwob2lkKTsK\nICAgICAgICBlbmRFbShwbSk7CgogICAgICAgIHBtID0gKE9wZW5KUEFFbnRp\ndHlNYW5hZ2VyKSBjdXJyZW50RW50aXR5TWFuYWdlcigpOwogICAgICAgIGJh\nc2ljID0KICAgICAgICAgICAgKEJhc2ljU3ViY2xhc3NJbnN0YW5jZSkgcG0u\nZmluZChCYXNpY1N1YmNsYXNzSW5zdGFuY2UuY2xhc3MsIG9pZCk7CiAgICAg\nICAgYXNzZXJ0RXF1YWxzKCJiYXIiLCBiYXNpYy5nZXRTdHJpbmdGaWVsZCgp\nKTsKCiAgICAgICAgc3RhcnRUeChwbSk7CiAgICAgICAgcG0ucmVtb3ZlKGJh\nc2ljKTsKICAgICAgICBhc3NlcnRUcnVlKEpQQUZhY2FkZUhlbHBlci50b0Jy\nb2tlcihwbSkuaXNEZWxldGVkKGJhc2ljKSk7CiAgICAgICAgZW5kVHgocG0p\nOwogICAgICAgIGVuZEVtKHBtKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCB0\nZXN0R2V0T2JqZWN0SWQoKSB7CiAgICAgICAgT3BlbkpQQUVudGl0eU1hbmFn\nZXIgcG0gPQogICAgICAgICAgICAoT3BlbkpQQUVudGl0eU1hbmFnZXIpIGN1\ncnJlbnRFbnRpdHlNYW5hZ2VyKCk7CiAgICAgICAgQmFzaWNTdWJjbGFzc0lu\nc3RhbmNlIGJhc2ljID0gbmV3IEJhc2ljU3ViY2xhc3NJbnN0YW5jZSgpOwog\nICAgICAgIGJhc2ljLnNldFN0cmluZ0ZpZWxkKCJmb28iKTsKICAgICAgICBz\ndGFydFR4KHBtKTsKICAgICAgICBwbS5wZXJzaXN0KGJhc2ljKTsKICAgICAg\nICBlbmRUeChwbSk7CiAgICAgICAgT2JqZWN0IG9pZCA9IG51bGw7CiAgICAg\nICAgdHJ5IHsKICAgICAgICAgICAgYXNzZXJ0Tm90TnVsbChvaWQgPSBwbS5n\nZXRPYmplY3RJZChiYXNpYykpOwogICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlv\nbiBlKSB7CiAgICAgICAgICAgIGZhaWwoIm9iamVjdCBpZCBsb29rdXAgZmFp\nbGVkOiAiICsgZS5nZXRNZXNzYWdlKCkpOwogICAgICAgIH0KCiAgICAgICAg\nc3RhcnRUeChwbSk7CiAgICAgICAgcG0ucmVtb3ZlKGJhc2ljKTsKICAgICAg\nICAvLyBiZWZvcmUgY29tbWl0dGluZywgaWQgc2hvdWxkIGV4aXN0IHN0aWxs\nCiAgICAgICAgYXNzZXJ0Tm90TnVsbChwbS5nZXRPYmplY3RJZChiYXNpYykp\nOwoKICAgICAgICBlbmRUeChwbSk7CiAgICAgICAgYXNzZXJ0TnVsbChwbS5n\nZXRPYmplY3RJZChiYXNpYykpOwogICAgICAgIGVuZEVtKHBtKTsKCiAgICAg\nICAgLy8gbG9va2luZyB1cCB0aGUgaW5zdGFuY2UgYnkgaWQgaW4gYSBuZXcg\nUE0gc2hvdWxkIGZhaWwuCiAgICAgICAgcG0gPSAoT3BlbkpQQUVudGl0eU1h\nbmFnZXIpIGN1cnJlbnRFbnRpdHlNYW5hZ2VyKCk7CiAgICAgICAgdHJ5IHsK\nICAgICAgICAgICAgcG0uZmluZChCYXNpY1N1YmNsYXNzSW5zdGFuY2UuY2xh\nc3MsIG9pZCk7CiAgICAgICAgICAgIGZhaWwoImluc3RhbmNlIHNob3VsZCBo\nYXZlIGJlZW4gZGVsZXRlZCEiKTsKICAgICAgICB9IGNhdGNoIChFeGNlcHRp\nb24gZSkgewogICAgICAgICAgICAvLyBleHBlY3RlZAogICAgICAgIH0KICAg\nICAgICBlbmRFbShwbSk7CiAgICB9CgogICAgcHVibGljIHZvaWQgdGVzdENo\nYW5nZXNPdXRzaWRlVHhXaXRoTlRXKCkgewogICAgICAgIE9wZW5KUEFFbnRp\ndHlNYW5hZ2VyIHBtID0KICAgICAgICAgICAgKE9wZW5KUEFFbnRpdHlNYW5h\nZ2VyKSBjdXJyZW50RW50aXR5TWFuYWdlcigpOwogICAgICAgIEJhc2ljU3Vi\nY2xhc3NJbnN0YW5jZSBiYXNpYyA9IG5ldyBCYXNpY1N1YmNsYXNzSW5zdGFu\nY2UoKTsKICAgICAgICBiYXNpYy5zZXRTdHJpbmdGaWVsZCgiZm9vIik7CiAg\nICAgICAgc3RhcnRUeChwbSk7CiAgICAgICAgcG0ucGVyc2lzdChiYXNpYyk7\nCiAgICAgICAgZW5kVHgocG0pOwogICAgICAgIE9iamVjdCBvaWQgPSBwbS5n\nZXRPYmplY3RJZChiYXNpYyk7CiAgICAgICAgZW5kRW0ocG0pOwoKICAgICAg\nICBwbSA9IGdldE5UV1BNKCk7CiAgICAgICAgYmFzaWMgPQogICAgICAgICAg\nICAoQmFzaWNTdWJjbGFzc0luc3RhbmNlKSBwbS5maW5kKEJhc2ljU3ViY2xh\nc3NJbnN0YW5jZS5jbGFzcywgb2lkKTsKICAgICAgICBiYXNpYy5zZXRTdHJp\nbmdGaWVsZCgiaGVsbG8iKTsKICAgICAgICBzdGFydFR4KHBtKTsKICAgICAg\nICBlbmRUeChwbSk7CiAgICAgICAgZW5kRW0ocG0pOwoKICAgICAgICBwbSA9\nIChPcGVuSlBBRW50aXR5TWFuYWdlcikgY3VycmVudEVudGl0eU1hbmFnZXIo\nKTsKICAgICAgICBiYXNpYyA9CiAgICAgICAgICAgIChCYXNpY1N1YmNsYXNz\nSW5zdGFuY2UpIHBtLmZpbmQoQmFzaWNTdWJjbGFzc0luc3RhbmNlLmNsYXNz\nLCBvaWQpOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIGFzc2VydEVxdWFs\ncygiaGVsbG8iLCBiYXNpYy5nZXRTdHJpbmdGaWVsZCgpKTsKICAgICAgICB9\nIGNhdGNoIChBc3NlcnRpb25GYWlsZWRFcnJvciBhZmUpIHsKICAgICAgICAg\nICAgYnVnKDEyMDUsIGFmZSwgIkpETyAyLXN0eWxlIE5UVyBub3Qgc3VwcG9y\ndGVkLiIpOwogICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMgdm9pZCB0ZXN0\nQ2hhbmdlc091dHNpZGVUeFdpdGhvdXROVFcoKSB7CiAgICAgICAgT3BlbkpQ\nQUVudGl0eU1hbmFnZXIgcG0gPQogICAgICAgICAgICAoT3BlbkpQQUVudGl0\neU1hbmFnZXIpIGN1cnJlbnRFbnRpdHlNYW5hZ2VyKCk7CiAgICAgICAgQmFz\naWNTdWJjbGFzc0luc3RhbmNlIGJhc2ljID0gbmV3IEJhc2ljU3ViY2xhc3NJ\nbnN0YW5jZSgpOwogICAgICAgIGJhc2ljLnNldFN0cmluZ0ZpZWxkKCJmb28i\nKTsKICAgICAgICBzdGFydFR4KHBtKTsKICAgICAgICBwbS5wZXJzaXN0KGJh\nc2ljKTsKICAgICAgICBlbmRUeChwbSk7CgogICAgICAgIHRyeSB7CiAgICAg\nICAgICAgIGJhc2ljLnNldFN0cmluZ0ZpZWxkKCJoZWxsbyIpOwogICAgICAg\nICAgICBmYWlsKCJzaG91bGQgbm90IGJlIGFibGUgdG8gd3JpdGUgb3V0c2lk\nZSB0eCB3aXRob3V0IE5UVyIpOwogICAgICAgIH0gY2F0Y2ggKFJ1bnRpbWVF\neGNlcHRpb24gcmUpIHsKICAgICAgICAgICAgLy8gZXhwZWN0ZWQgY2FzZQog\nICAgICAgICAgICBPYmplY3QgZmFpbGVkID0gKChFeGNlcHRpb25JbmZvKSBy\nZSkuZ2V0RmFpbGVkT2JqZWN0KCk7CiAgICAgICAgICAgIGFzc2VydE5vdE51\nbGwoZmFpbGVkKTsKICAgICAgICAgICAgYXNzZXJ0U2FtZShiYXNpYywgZmFp\nbGVkKTsKICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICBlbmRFbShw\nbSk7CiAgICAgICAgfQogICAgfQoKICAgIHByaXZhdGUgT3BlbkpQQUVudGl0\neU1hbmFnZXIgZ2V0TlRXUE0oKSB7CiAgICAgICAgRW50aXR5TWFuYWdlckZh\nY3RvcnkgcG1mID0gZ2V0RW1mKCk7CiAgICAgICAgT3BlbkpQQUVudGl0eU1h\nbmFnZXIgZW0gPQogICAgICAgICAgICAoT3BlbkpQQUVudGl0eU1hbmFnZXIp\nIHBtZi5jcmVhdGVFbnRpdHlNYW5hZ2VyKCk7CiAgICAgICAgZW0uc2V0Tm9u\ndHJhbnNhY3Rpb25hbFdyaXRlKHRydWUpOwogICAgICAgIHJldHVybiBlbTsK\nICAgIH0KCiAgICAvKgogICAgIHB1YmxpYyB2b2lkIHRlc3RDYWxsYmFja3Mg\nKCkKICAgICB7CiAgICAgICAgIGZhaWwgKCIjIyMjIyB1bmltcGxlbWVudGVk\nIHRlc3QiKTsKICAgICB9CgoKICAgICBwdWJsaWMgdm9pZCB0ZXN0VHJhbnNh\nY3Rpb25MaXN0ZW5lcnMgKCkKICAgICB7CiAgICAgICAgIGZhaWwgKCIjIyMj\nIyIpOwogICAgIH0KCgogICAgIHB1YmxpYyB2b2lkIHRlc3RSZW1vdGVDb21t\naXRMaXN0ZW5lcnMgKCkKICAgICB7CiAgICAgICAgIGZhaWwgKCIjIyMjIyIp\nOwogICAgIH0KCgogICAgIHB1YmxpYyB2b2lkIHRlc3RDYWNoaW5nICgpCiAg\nICAgewogICAgICAgICBmYWlsICgiIyMjIyMiKTsKICAgICB9CgoKICAgICBw\ndWJsaWMgdm9pZCB0ZXN0UmVtb3RlICgpCiAgICAgewogICAgICAgICBmYWls\nICgiIyMjIyMiKTsKICAgICB9CiAgICAgKi8KCiAgICBwdWJsaWMgdm9pZCB0\nZXN0VmVyc2lvbkluY3JlbWVudEFuZElkRmllbGQoKSB7CiAgICAgICAgLy8g\nbWFrZSBzdXJlIHRoYXQgdmVyc2lvbiBpbmNyZW1lbnRzIGhhcHBlbiBjb3Jy\nZWN0bHksIGFuZCBhcmUKICAgICAgICAvLyB2aXNpYmxlIGluIHRoZSB1c2Vy\nLXZpc2libGUgaW5zdGFuY2UuCiAgICAgICAgT3BlbkpQQUVudGl0eU1hbmFn\nZXIgcG0gPQogICAgICAgICAgICAoT3BlbkpQQUVudGl0eU1hbmFnZXIpIGN1\ncnJlbnRFbnRpdHlNYW5hZ2VyKCk7CiAgICAgICAgQmFzaWNTdWJjbGFzc0lu\nc3RhbmNlIGJhc2ljID0gbmV3IEJhc2ljU3ViY2xhc3NJbnN0YW5jZSgpOwog\nICAgICAgIGJhc2ljLnNldFN0cmluZ0ZpZWxkKCJmb28iKTsKICAgICAgICBz\ndGFydFR4KHBtKTsKICAgICAgICBwbS5wZXJzaXN0KGJhc2ljKTsKICAgICAg\nICBlbmRUeChwbSk7CgogICAgICAgIGFzc2VydEVxdWFscygxLCBiYXNpYy5n\nZXRWZXJzaW9uKCkpOwogICAgICAgIGxvbmcgaWQgPSBiYXNpYy5nZXRJZCgp\nOwogICAgICAgIGFzc2VydE5vdEVxdWFscygwLCBpZCk7CgogICAgICAgIHN0\nYXJ0VHgocG0pOwogICAgICAgIGJhc2ljLnNldFN0cmluZ0ZpZWxkKCJiYXIi\nKTsKICAgICAgICBlbmRUeChwbSk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKDIs\nIGJhc2ljLmdldFZlcnNpb24oKSk7CiAgICAgICAgZW5kRW0ocG0pOwogICAg\nfQoKICAgIC8qCiAgICAgcHVibGljIHZvaWQgdGVzdEF1dG9Bc3NpZ25lZEZp\nZWxkcyAoKQogICAgIHsKICAgICAgICAgLy8gbWFrZSBzdXJlIHRoYXQgYXV0\nby1hc3NpZ25lZCBmaWVsZCB2YWx1ZXMgZ2V0IGludG8gdGhlIHVzZXItdmlz\naWJsZQogICAgICAgICAvLyBpbnN0YW5jZS4KICAgICAgICAgZmFpbCAoIiMj\nIyMjIik7CiAgICAgfQogICAgICovCgogICAgcHVibGljIHZvaWQgdGVzdEpQ\nQUJhc2ljcygpIHsKICAgICAgICBFbnRpdHlNYW5hZ2VyIGVtID0gY3VycmVu\ndEVudGl0eU1hbmFnZXIoKTsKICAgICAgICBCYXNpY1N1YmNsYXNzSW5zdGFu\nY2UgYmFzaWMgPSAoQmFzaWNTdWJjbGFzc0luc3RhbmNlKSBjcmVhdGVJbnN0\nYW5jZSgKICAgICAgICAgICAgZW0sIEJhc2ljU3ViY2xhc3NJbnN0YW5jZS5j\nbGFzcyk7CiAgICAgICAgYmFzaWMuc2V0U3RyaW5nRmllbGQoImhlbGxvIik7\nCiAgICAgICAgc3RhcnRUeChlbSk7CiAgICAgICAgZW0ucGVyc2lzdChiYXNp\nYyk7CiAgICAgICAgZW5kVHgoZW0pOwogICAgICAgIGVuZEVtKGVtKTsKICAg\nIH0KCiAgICAvKgogICAgIHB1YmxpYyB2b2lkIHRlc3REZXRhY2htZW50QW5k\nQXR0YWNoZW1udCAoKQogICAgIHsKICAgICAgICAgZmFpbCAoIiMjIyMjIik7\nCiAgICAgfQoKCiAgICAgcHVibGljIHZvaWQgdGVzdEVtYmVkZGVkTm9uRW5o\nYW5jZWQgKCkKICAgICB7CiAgICAgICAgIGZhaWwgKCIjIyMjIyIpOwogICAg\nIH0KCgogICAgIHB1YmxpYyB2b2lkIHRlc3RUcmFuc2FjdGlvbmFsTm9uRW5o\nYW5jZWQgKCkKICAgICB7CiAgICAgICAgIGZhaWwgKCIjIyMjIyIpOwogICAg\nIH0KCgogICAgIHB1YmxpYyB2b2lkIHRlc3RCdWxrVHJhbnNhY3Rpb25hbE5v\nbkVuaGFuY2VkICgpCiAgICAgewogICAgICAgICBmYWlsICgiIyMjIyMiKTsK\nICAgICB9CiAgICAgKi8KCiAgICBwdWJsaWMgdm9pZCB0ZXN0U2luZ2xlVmFs\ndWVkSW52ZXJzZU1hbmFnZW1lbnQoKSB7CiAgICAgICAgTWFwIG1hcCA9IG5l\ndyBIYXNoTWFwKCk7CiAgICAgICAgbWFwLnB1dCgib3BlbmpwYS5JbnZlcnNl\nTWFuYWdlciIsICJ0cnVlIik7CiAgICAgICAgT3BlbkpQQUVudGl0eU1hbmFn\nZXIgcG0gPSAoT3BlbkpQQUVudGl0eU1hbmFnZXIpCiAgICAgICAgICAgIGdl\ndEVtZihtYXApLmNyZWF0ZUVudGl0eU1hbmFnZXIoKTsKICAgICAgICBNYW5h\nZ2VkSW52ZXJzZVRlc3RJbnN0YW5jZSBtYW5hZ2VkID0gKE1hbmFnZWRJbnZl\ncnNlVGVzdEluc3RhbmNlKQogICAgICAgICAgICBuZXdJbnN0YW5jZShwbSwg\nTWFuYWdlZEludmVyc2VUZXN0SW5zdGFuY2UuY2xhc3MpOwogICAgICAgIE1h\nbmFnZWRJbnZlcnNlVGVzdEluc3RhbmNlMiBtYW5hZ2VkMiA9IChNYW5hZ2Vk\nSW52ZXJzZVRlc3RJbnN0YW5jZTIpCiAgICAgICAgICAgIG5ld0luc3RhbmNl\nKHBtLCBNYW5hZ2VkSW52ZXJzZVRlc3RJbnN0YW5jZTIuY2xhc3MpOwogICAg\nICAgIG1hbmFnZWQuc2V0U3RyaW5nRmllbGQoIm1hbmFnZWQiKTsKICAgICAg\nICBtYW5hZ2VkMi5zZXRTdHJpbmdGaWVsZCgibWFuYWdlZDIiKTsKICAgICAg\nICBtYW5hZ2VkLnNldE1hbmFnZWQyKG1hbmFnZWQyKTsKCiAgICAgICAgc3Rh\ncnRUeChwbSk7CiAgICAgICAgcG0ucGVyc2lzdChtYW5hZ2VkKTsKICAgICAg\nICBlbmRUeChwbSk7CgogICAgICAgIGFzc2VydFNhbWUobWFuYWdlZCwgbWFu\nYWdlZDIuZ2V0TWFuYWdlZCgpKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCB0\nZXN0QmFja2luZ0ZpZWxkQ29uZmlndXJhdGlvbldpdGhUd29GYWN0b3JpZXMo\nKSB7CiAgICAgICAgT3BlbkpQQUVudGl0eU1hbmFnZXIgcG0gPQogICAgICAg\nICAgICAoT3BlbkpQQUVudGl0eU1hbmFnZXIpIGN1cnJlbnRFbnRpdHlNYW5h\nZ2VyKCk7CiAgICAgICAgLy8gdGhpcyBjYXVzZXMgRGVyaXZlZEVudGl0eS5j\nbGFzcyB0byBnZXQgbG9hZGVkIGludG8gUENSZWdpc3RyeQogICAgICAgIG5l\nd0luc3RhbmNlKHBtLCBEZXJpdmVkRW50aXR5LmNsYXNzKTsKICAgICAgICBN\nYXAgbWFwID0gbmV3IEhhc2hNYXAoKTsKICAgICAgICBtYXAucHV0KCJvcGVu\nanBhLkxvZyIsICJEaWFnbm9zdGljQ29udGV4dD1zdWJjbGFzcy10d28tZmFj\ndG9yaWVzLXRlc3QiKTsKICAgICAgICBwbSA9IChPcGVuSlBBRW50aXR5TWFu\nYWdlcikgZ2V0RW1mKG1hcCkuY3JlYXRlRW50aXR5TWFuYWdlcigpOwogICAg\nICAgIG5ld0luc3RhbmNlKHBtLCBEZXJpdmVkRW50aXR5LmNsYXNzKTsKCiAg\nICAgICAgLy8gdGhpcyBzZWNvbmQgbmV3LWluc3RhbmNlIGNyZWF0aW9uIHdp\nbGwgcmVzdWx0IGluIHRoZSBtZXRhZGF0YQogICAgICAgIC8vIGRlZmF1bHRz\nIGJlaW5nIGxvYWRlZCBmcm9tIHRoZSBQQ1JlZ2lzdHJ5IGluc3RlYWQgb2Yg\ndmlhIHJlZmxlY3Rpb24uCiAgICAgICAgLy8gTWFrZSBzdXJlIHRoYXQgdGhp\nbmdzIHN0aWxsIHdvcmsgYXMgZXhwZWN0ZWQgZnJvbSB0aGUKICAgICAgICAv\nLyByZWdpc3RyeS1wYXJzaW5nIGNvZGUuCiAgICAgICAgQ2xhc3NNZXRhRGF0\nYSBtZXRhID0gZ2V0Q29uZmlndXJhdGlvbigpCiAgICAgICAgICAgIC5nZXRN\nZXRhRGF0YVJlcG9zaXRvcnlJbnN0YW5jZSgpLgogICAgICAgICAgICBnZXRN\nZXRhRGF0YShEZXJpdmVkRW50aXR5LmNsYXNzLCBudWxsLCBmYWxzZSk7CiAg\nICAgICAgYXNzZXJ0VHJ1ZSgibWV0YSdzIGFjY2VzcyBzaG91bGQgYmUgQUND\nRVNTX1BST1BFUlRZIiwKICAgICAgICAgICAgbWV0YS5nZXRBY2Nlc3NUeXBl\nKCkgPT0gQ2xhc3NNZXRhRGF0YS5BQ0NFU1NfUFJPUEVSVFkpOwogICAgICAg\nIEZpZWxkTWV0YURhdGFbXSBmbWRzID0gbWV0YS5nZXRGaWVsZHMoKTsKICAg\nICAgICBmb3IgKGludCBpID0gMDsgaSA8IGZtZHMubGVuZ3RoOyBpKyspIHsK\nICAgICAgICAgICAgYXNzZXJ0RXF1YWxzKE1ldGhvZC5jbGFzcywgZm1kc1tp\nXS5nZXRCYWNraW5nTWVtYmVyKCkuZ2V0Q2xhc3MoKSk7CgogICAgICAgICAg\nICAvLyBtYWtlIHN1cmUgdGhhdCB0aGUgZmllbGRzIGFyZSBkZWZpbmVkIGlu\nIHRoZSByaWdodCBwYXJ0IG9mIHRoZQogICAgICAgICAgICAvLyBoaWVyYXJj\naHkKICAgICAgICAgICAgaWYgKGZtZHNbaV0uZ2V0TmFtZSgpLmVxdWFscygi\naW50RmllbGQiKSB8fAogICAgICAgICAgICAgICAgZm1kc1tpXS5nZXROYW1l\nKCkuZXF1YWxzKCJvbmVUb09uZSIpKSB7CiAgICAgICAgICAgICAgICBhc3Nl\ncnRFcXVhbHMoRGVyaXZlZEVudGl0eS5jbGFzcywKICAgICAgICAgICAgICAg\nICAgICBmbWRzW2ldLmdldERlZmluaW5nTWV0YURhdGEoKS5nZXREZXNjcmli\nZWRUeXBlKCkpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAg\nICAgYXNzZXJ0RXF1YWxzKEJhc2VFbnRpdHkuY2xhc3MsCiAgICAgICAgICAg\nICAgICAgICAgZm1kc1tpXS5nZXREZWZpbmluZ01ldGFEYXRhKCkuZ2V0RGVz\nY3JpYmVkVHlwZSgpKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0K\nfQo=\n","encoding":"base64"}

