{"sha":"a84491ee7412f9f910ff4c973915548b628d2dae","node_id":"MDQ6QmxvYjIwNjM2NDphODQ0OTFlZTc0MTJmOWY5MTBmZjRjOTczOTE1NTQ4YjYyOGQyZGFl","size":4626,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/a84491ee7412f9f910ff4c973915548b628d2dae","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuZXZlbnQ7\nCgppbXBvcnQgamF2YS51dGlsLkhhc2hNYXA7CmltcG9ydCBqYXZhLnV0aWwu\nTWFwOwoKCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2Uu\nZXZlbnQuY29tbW9uLmFwcHMuUnVudGltZVRlc3QxOwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNlLmNvbW1vbi51dGlscy5BYnN0cmFj\ndFRlc3RDYXNlOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNpc3Rl\nbmNlLmNvbW1vbi51dGlscy5CdWZmZXJlZExvZ0ZhY3Rvcnk7CgppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLmV2ZW50Lk9ycGhhbmVkS2V5QWN0aW9uOwpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNlLkVudGl0eU5v\ndEZvdW5kRXhjZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnBl\ncnNpc3RlbmNlLk9wZW5KUEFFbnRpdHlNYW5hZ2VyOwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNlLk9wZW5KUEFFbnRpdHlNYW5hZ2Vy\nRmFjdG9yeTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5j\nZS5PcGVuSlBBRW50aXR5TWFuYWdlclNQSTsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS51dGlsLk9wZW5KUEFFeGNlcHRpb247CgovKioKICogPHA+VGVz\ndCB0aGUge0BsaW5rIE9ycGhhbmVkS2V5QWN0aW9ufSBwbHVnaW4uPC9wPgog\nKgogKiBAYXV0aG9yIEFiZSBXaGl0ZQogKi8KcHVibGljIGNsYXNzIFRlc3RP\ncnBoYW5lZEtleUFjdGlvbgogICAgZXh0ZW5kcyBBYnN0cmFjdFRlc3RDYXNl\nIHsKCiAgICBwcml2YXRlIE9iamVjdCBfb2lkID0gbnVsbDsKCiAgICBwdWJs\naWMgVGVzdE9ycGhhbmVkS2V5QWN0aW9uKFN0cmluZyBzKSB7CiAgICAgICAg\nc3VwZXIocywgImV2ZW50Y2FjdHVzYXBwIik7CiAgICB9CgogICAgcHVibGlj\nIHZvaWQgc2V0VXAoKSB7CiAgICAgICAgZGVsZXRlQWxsKFJ1bnRpbWVUZXN0\nMS5jbGFzcyk7CgogICAgICAgIFJ1bnRpbWVUZXN0MSBwYyA9IG5ldyBSdW50\naW1lVGVzdDEoKTsKICAgICAgICBwYy5zZXRJbnRGaWVsZCgxKTsKICAgICAg\nICBSdW50aW1lVGVzdDEgcGMyID0gbmV3IFJ1bnRpbWVUZXN0MSgpOwogICAg\nICAgIHBjMi5zZXRJbnRGaWVsZCgyKTsKICAgICAgICBwYy5zZXRTZWxmT25l\nT25lKHBjMik7CgogICAgICAgIE9wZW5KUEFFbnRpdHlNYW5hZ2VyIHBtID0K\nICAgICAgICAgICAgKE9wZW5KUEFFbnRpdHlNYW5hZ2VyKSBjdXJyZW50RW50\naXR5TWFuYWdlcigpOwogICAgICAgIHN0YXJ0VHgocG0pOwogICAgICAgIHBt\nLnBlcnNpc3QocGMpOwogICAgICAgIGVuZFR4KHBtKTsKICAgICAgICBfb2lk\nID0gcG0uZ2V0T2JqZWN0SWQocGMpOwoKICAgICAgICBzdGFydFR4KHBtKTsK\nICAgICAgICBwbS5yZW1vdmUocGMyKTsKICAgICAgICBlbmRUeChwbSk7CiAg\nICAgICAgZW5kRW0ocG0pOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHRlc3RM\nb2coKSB7CiAgICAgICAgTWFwIG1hcCA9IGdldE9ycGhhbmVkS2V5Q29uZmln\ndXJhdGlvbigibG9nKExldmVsPUZBVEFMKSIpOwoKICAgICAgICBPcGVuSlBB\nRW50aXR5TWFuYWdlckZhY3RvcnkgcG1mID0gZ2V0RW1mKG1hcCk7CiAgICAg\nICAgT3BlbkpQQUVudGl0eU1hbmFnZXIgcG0gPSBwbWYuY3JlYXRlRW50aXR5\nTWFuYWdlcigpOwoKICAgICAgICBCdWZmZXJlZExvZ0ZhY3RvcnkgbG9nRmFj\ndG9yeSA9IChCdWZmZXJlZExvZ0ZhY3RvcnkpCiAgICAgICAgICAgICgoT3Bl\nbkpQQUVudGl0eU1hbmFnZXJTUEkpIHBtKS5nZXRDb25maWd1cmF0aW9uKCku\nZ2V0TG9nRmFjdG9yeSgpOwogICAgICAgIGxvZ0ZhY3RvcnkuY2xlYXIoKTsK\nCiAgICAgICAgUnVudGltZVRlc3QxIHBjID0gKFJ1bnRpbWVUZXN0MSkgcG0u\nZmluZChSdW50aW1lVGVzdDEuY2xhc3MsIF9vaWQpOwogICAgICAgIGxvZ0Zh\nY3RvcnkuYXNzZXJ0Tm9Mb2dNZXNzYWdlKCIqb3JwaGFuKiIpOwogICAgICAg\nIGFzc2VydE51bGwocGMuZ2V0U2VsZk9uZU9uZSgpKTsKICAgICAgICBsb2dG\nYWN0b3J5LmFzc2VydExvZ01lc3NhZ2UoIipvcnBoYW4qIik7CiAgICAgICAg\nZW5kRW0ocG0pOwogICAgICAgIHBtZi5jbG9zZSgpOwogICAgfQoKICAgIHB1\nYmxpYyB2b2lkIHRlc3RFeGNlcHRpb24oKSB7CiAgICAgICAgTWFwIG1hcCA9\nIGdldE9ycGhhbmVkS2V5Q29uZmlndXJhdGlvbigiZXhjZXB0aW9uIik7CiAg\nICAgICAgT3BlbkpQQUVudGl0eU1hbmFnZXJGYWN0b3J5IHBtZiA9IGdldEVt\nZihtYXApOwoKICAgICAgICBPcGVuSlBBRW50aXR5TWFuYWdlciBwbSA9IHBt\nZi5jcmVhdGVFbnRpdHlNYW5hZ2VyKCk7CgogICAgICAgIEJ1ZmZlcmVkTG9n\nRmFjdG9yeSBsb2dGYWN0b3J5ID0gKEJ1ZmZlcmVkTG9nRmFjdG9yeSkKICAg\nICAgICAgICAgKChPcGVuSlBBRW50aXR5TWFuYWdlclNQSSkgcG0pLmdldENv\nbmZpZ3VyYXRpb24oKS5nZXRMb2dGYWN0b3J5KCk7CiAgICAgICAgbG9nRmFj\ndG9yeS5jbGVhcigpOwoKICAgICAgICBSdW50aW1lVGVzdDEgcGMgPSAoUnVu\ndGltZVRlc3QxKSBwbS5maW5kKFJ1bnRpbWVUZXN0MS5jbGFzcywgX29pZCk7\nCiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgcGMuZ2V0U2VsZk9uZU9uZSgp\nOwogICAgICAgICAgICBmYWlsKCJEaWQgbm90IHRocm93IGV4cGVjdGVkIGV4\nY2VwdGlvbiBmb3Igb3JwaGFuZWQga2V5LiIpOwogICAgICAgIH0gY2F0Y2gg\nKEVudGl0eU5vdEZvdW5kRXhjZXB0aW9uIG9uZmUpIHsKICAgICAgICAgICAg\nbG9nRmFjdG9yeS5hc3NlcnROb0xvZ01lc3NhZ2UoIipvcnBoYW4qIik7CiAg\nICAgICAgfSBjYXRjaCAoT3BlbkpQQUV4Y2VwdGlvbiBrZSkgewogICAgICAg\nICAgICBidWcoMTEzOCwga2UsICJXcm9uZyBleGNlcHRpb24gdHlwZS4iKTsK\nICAgICAgICB9CiAgICAgICAgZW5kRW0ocG0pOwogICAgICAgIHBtZi5jbG9z\nZSgpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHRlc3ROb25lKCkgewogICAg\nICAgIE1hcCBtYXAgPSBnZXRPcnBoYW5lZEtleUNvbmZpZ3VyYXRpb24oIm5v\nbmUiKTsKICAgICAgICBPcGVuSlBBRW50aXR5TWFuYWdlckZhY3RvcnkgcG1m\nID0gZ2V0RW1mKG1hcCk7CiAgICAgICAgT3BlbkpQQUVudGl0eU1hbmFnZXIg\ncG0gPSBwbWYuY3JlYXRlRW50aXR5TWFuYWdlcigpOwoKICAgICAgICBCdWZm\nZXJlZExvZ0ZhY3RvcnkgbG9nRmFjdG9yeSA9IChCdWZmZXJlZExvZ0ZhY3Rv\ncnkpCiAgICAgICAgICAgICgoT3BlbkpQQUVudGl0eU1hbmFnZXJTUEkpIHBt\nKS5nZXRDb25maWd1cmF0aW9uKCkuZ2V0TG9nRmFjdG9yeSgpOwogICAgICAg\nIGxvZ0ZhY3RvcnkuY2xlYXIoKTsKCiAgICAgICAgUnVudGltZVRlc3QxIHBj\nID0gKFJ1bnRpbWVUZXN0MSkgcG0uZmluZChSdW50aW1lVGVzdDEuY2xhc3Ms\nIF9vaWQpOwogICAgICAgIGFzc2VydE51bGwocGMuZ2V0U2VsZk9uZU9uZSgp\nKTsKICAgICAgICBsb2dGYWN0b3J5LmFzc2VydE5vTG9nTWVzc2FnZSgiKm9y\ncGhhbioiKTsKICAgICAgICBlbmRFbShwbSk7CiAgICAgICAgcG1mLmNsb3Nl\nKCk7CiAgICB9CgogICAgTWFwIGdldE9ycGhhbmVkS2V5Q29uZmlndXJhdGlv\nbihTdHJpbmcgb3JwaGFuS2V5QWN0aW9uKSB7CiAgICAgICAgTWFwIG1hcCA9\nIG5ldyBIYXNoTWFwKCk7CiAgICAgICAgbWFwLnB1dCgib3BlbmpwYS5Mb2ci\nLCBCdWZmZXJlZExvZ0ZhY3RvcnkuY2xhc3MuZ2V0TmFtZSgpKTsKICAgICAg\nICBpZiAob3JwaGFuS2V5QWN0aW9uICE9IG51bGwpCiAgICAgICAgICAgIG1h\ncC5wdXQoIm9wZW5qcGEuT3JwaGFuZWRLZXlBY3Rpb24iLCBvcnBoYW5LZXlB\nY3Rpb24pOwogICAgICAgIHJldHVybiBtYXA7CiAgICB9Cn0K\n","encoding":"base64"}

