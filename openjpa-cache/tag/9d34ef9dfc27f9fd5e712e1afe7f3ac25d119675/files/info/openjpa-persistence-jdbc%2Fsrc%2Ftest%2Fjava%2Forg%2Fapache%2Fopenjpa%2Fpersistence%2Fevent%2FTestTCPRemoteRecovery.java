{"sha":"947623d1bb0d3a2b5eda34a534c6c191607e9ad0","node_id":"MDQ6QmxvYjIwNjM2NDo5NDc2MjNkMWJiMGQzYTJiNWVkYTM0YTUzNGM2YzE5MTYwN2U5YWQw","size":12493,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/947623d1bb0d3a2b5eda34a534c6c191607e9ad0","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuZXZlbnQ7\nCgppbXBvcnQgamF2YS51dGlsLkNvbGxlY3Rpb247CmltcG9ydCBqYXZhLnV0\naWwuSGFzaE1hcDsKaW1wb3J0IGphdmEudXRpbC5NYXA7CmltcG9ydCBqYXZh\neC5wZXJzaXN0ZW5jZS5FbnRpdHlNYW5hZ2VyOwoKCmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuZXZlbnQuY29tbW9uLmFwcHMuRHVy\nYXRpb247CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2Uu\nZXZlbnQuY29tbW9uLmFwcHMuUnVudGltZVRlc3QxOwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNlLmNvbW1vbi51dGlscy5BYnN0cmFj\ndFRlc3RDYXNlOwoKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5ldmVudC5S\nZW1vdGVDb21taXRFdmVudDsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5l\ndmVudC5SZW1vdGVDb21taXRMaXN0ZW5lcjsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS5ldmVudC5UQ1BSZW1vdGVDb21taXRQcm92aWRlcjsKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5saWIuY29uZi5Db25maWd1cmF0aW9uczsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5PcGVuSlBB\nRW50aXR5TWFuYWdlckZhY3Rvcnk7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEucGVyc2lzdGVuY2UuT3BlbkpQQUVudGl0eU1hbmFnZXJGYWN0b3J5U1BJ\nOwoKcHVibGljIGNsYXNzIFRlc3RUQ1BSZW1vdGVSZWNvdmVyeQogICAgZXh0\nZW5kcyBBYnN0cmFjdFRlc3RDYXNlIHsKCiAgICBwdWJsaWMgVGVzdFRDUFJl\nbW90ZVJlY292ZXJ5KFN0cmluZyBzKSB7CiAgICAgICAgc3VwZXIocywgImV2\nZW50Y2FjdHVzYXBwIik7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0VXAo\nKSB7CiAgICAgICAgZGVsZXRlQWxsKFJ1bnRpbWVUZXN0MS5jbGFzcyk7CiAg\nICB9CgogICAgcHVibGljIHZvaWQgdGVhckRvd25UZXN0Q2xhc3MoKQogICAg\nICAgIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIC8vc3VwZXIudGVhckRv\nd25UZXN0Q2xhc3MoKTsKICAgIH0KCiAgICBwcml2YXRlIHN0YXRpYyBmaW5h\nbCBpbnQgTlVNX09CSkVDVFMgPSAxOwoKICAgIHByaXZhdGUgdm9pZCBwYXVz\nZShkb3VibGUgc2Vjb25kcykgewogICAgICAgIHRyeSB7CiAgICAgICAgICAg\nIFRocmVhZC5jdXJyZW50VGhyZWFkKCkueWllbGQoKTsKICAgICAgICAgICAg\nVGhyZWFkLmN1cnJlbnRUaHJlYWQoKS5zbGVlcCgoaW50KSBzZWNvbmRzICog\nMTAwMCk7CiAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAgICAg\nICB9CiAgICB9CgogICAgcHVibGljIHZvaWQgdGVzdFJlY2VpdmVyUmVjb3Zl\ncnMoKSB7CiAgICAgICAgLy8gQ3JlYXRlIHR3byBwbWZzIGluIGEgY2x1c3Rl\nciB0aGF0IGFyZSB1c2luZyBSQ1BUQ1AuCiAgICAgICAgT3BlbkpQQUVudGl0\neU1hbmFnZXJGYWN0b3J5IHBtZlNlbmRlciA9IGNyZWF0ZURpc3RpbmN0RmFj\ndG9yeSgKICAgICAgICAgICAgVENQUmVtb3RlQ29tbWl0UHJvdmlkZXIuY2xh\nc3MsCiAgICAgICAgICAgICJQb3J0PTU2MzYsIEFkZHJlc3Nlcz0xMjcuMC4w\nLjE6NTYzNjsxMjcuMC4wLjE6NjYzNiIpOwogICAgICAgIE9wZW5KUEFFbnRp\ndHlNYW5hZ2VyRmFjdG9yeSBwbWZSZWNlaXZlciA9IGNyZWF0ZURpc3RpbmN0\nRmFjdG9yeSgKICAgICAgICAgICAgVENQUmVtb3RlQ29tbWl0UHJvdmlkZXIu\nY2xhc3MsCiAgICAgICAgICAgICJQb3J0PTY2MzYsIEFkZHJlc3Nlcz0xMjcu\nMC4wLjE6NjYzNjsxMjcuMC4wLjE6NTYzNiIpOwoKICAgICAgICAvLyBSZWdp\nc3RlciBhIFJDRUxpc3RlbmVyIHdpdGggdGhlIFJDRU0uIE91ciBSQ0VMaXN0\nZW5lciB3aWxsCiAgICAgICAgLy8gcmVjb3JkIHRoZSB0b3RhbCBudW1iZXIg\nb2YgYSxkLCBhbmQgdSByZWNldmllZCBmcm9tIGVhY2gKICAgICAgICAvLyBS\nQ0UgYXMgdGhlIHNlbmRpbmcgUE0gcGVyZm9ybXMgY29tbWl0cy4KICAgICAg\nICBSZW1vdGVDb21taXRMaXN0ZW5lclRlc3RJbXBsIGxpc3RlbmVyQXRSZWNl\naXZlcgogICAgICAgICAgICA9IG5ldyBSZW1vdGVDb21taXRMaXN0ZW5lclRl\nc3RJbXBsKCk7CiAgICAgICAgKChPcGVuSlBBRW50aXR5TWFuYWdlckZhY3Rv\ncnlTUEkpIHBtZlJlY2VpdmVyKS5nZXRDb25maWd1cmF0aW9uKCkKICAgICAg\nICAgICAgLmdldFJlbW90ZUNvbW1pdEV2ZW50TWFuYWdlcigpLgogICAgICAg\nICAgICBhZGRMaXN0ZW5lcihsaXN0ZW5lckF0UmVjZWl2ZXIpOwoKICAgICAg\nICBFbnRpdHlNYW5hZ2VyIHBtU2VuZGVyID0gcG1mU2VuZGVyLmNyZWF0ZUVu\ndGl0eU1hbmFnZXIoKTsKCiAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKCIt\nLS0tLS0tLS0tLS0tLS0tLS0tIik7CiAgICAgICAgU3lzdGVtLm91dC5wcmlu\ndGxuKCIyIFBNRnMgY3JlYXRlZCwgYWN0aW5nIGFzIGEgY2x1c3RlciB1c2lu\nZyBwb3J0cyAiICsKICAgICAgICAgICAgIjU2MzYgYW5kIDY2MzYiKTsKICAg\nICAgICBTeXN0ZW0ub3V0LnByaW50bG4oIlRlc3Rpbmcgc2NlbmFyaW8gd2hl\ncmUgcmVjZWl2ZXIgaXMgZmFpbGVkLCB0aGVuICIgKwogICAgICAgICAgICAi\ncmVjb3ZlcmVkICIpOwogICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbigiYWZ0\nZXIgdHdvIHRpbWVvdXRzIGFsbCB0aGUgd2hpbGUgd2l0aCB0aGUgIiArCiAg\nICAgICAgICAgICJzZW5kaW5nIHBtIGNvbnRpbnVpbmciKTsKICAgICAgICBT\neXN0ZW0ub3V0LnByaW50bG4oInRvIHNlbmQuIik7CgogICAgICAgIC8vIFBl\ncmZvcm0gYSBzZXQgb2YgdHJhbnNhY3Rpb25zLiBFdmVudHMgd2lsbCBiZSBj\nb21tdW5pY2F0ZWQKICAgICAgICBwZXJmb3JtQWRkc01vZGlmaWVzRGVsZXRl\ncyhwbVNlbmRlciwgTlVNX09CSkVDVFMpOwoKICAgICAgICAvLyBXYWl0IGZv\nciBhIGJpdCBzbyB0aGUgcmVjZWl2ZXIgY2FuIGdldCB0aGUgZXZlbnQuCiAg\nICAgICAgcGF1c2UoMSk7CiAgICAgICAgLy8gTm93IEZhaWwgdGhlIHJlY2Vp\ndmVyIGluIHRoZSBjbHVzdGVyCiAgICAgICAgU3lzdGVtLm91dC5wcmludGxu\nKCJBYm91dCB0byBjbG9zZSB0aGUgcmVjZWl2aW5nIHBtZi4iKTsKICAgICAg\nICBwbWZSZWNlaXZlci5jbG9zZSgpOwogICAgICAgIC8vIFdhaXQgZm9yIGEg\nYml0IGxvbmdlciBzbyB0aGUgbGlzdGVuZXIncyB0aHJlYWRzIGFsbAogICAg\nICAgIC8vIGdldCBjbG9zZWQgb3V0LgogICAgICAgIHBhdXNlKDEpOwogICAg\nICAgIGFzc2VydEVxdWFscygxLCBsaXN0ZW5lckF0UmVjZWl2ZXIudG90YWxB\nZGRlZENsYXNzZXMpOwogICAgICAgIGFzc2VydEVxdWFscyhOVU1fT0JKRUNU\nUywgbGlzdGVuZXJBdFJlY2VpdmVyLnRvdGFsRGVsZXRlZCk7CiAgICAgICAg\nYXNzZXJ0RXF1YWxzKE5VTV9PQkpFQ1RTLCBsaXN0ZW5lckF0UmVjZWl2ZXIu\ndG90YWxVcGRhdGVkKTsKCiAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKCJZ\nb3Ugc2hvdWxkIG5vdyBzZWUgMSBXQVJOIHRyaWdnZXJlZCBhcyB0aGUgIiAr\nCiAgICAgICAgICAgICJzZW5kZXItcG1mIHRyaWVzIHRvIHNlbmQuIik7CiAg\nICAgICAgLy8gUGVyZm9ybSBzZWNvbmQgc2V0IG9mIHRyYW5zYWN0aW9ucy4g\nVGhpcyB3aWxsIHRyaWdnZXIgYSBzaW5nbGUKICAgICAgICAvLyBsb2cgV0FS\nTiBhcyB0aGUgcG1mIHdvbid0IGJlIGFibGUgdG8gY29tbXVuY2lhdGUgZXZl\nbnRzIHRvIHRoZQogICAgICAgIC8vIHNlY29uZCBtZW1iZXIgb2YgdGhlIGNs\ndXN0ZXIuCiAgICAgICAgcGVyZm9ybUFkZHNNb2RpZmllc0RlbGV0ZXMocG1T\nZW5kZXIsIE5VTV9PQkpFQ1RTKTsKCiAgICAgICAgLy8gV2FpdCBmb3IgYSBy\nZWNvdmVyeXRpbWUsIHRyeSB0cmFuc2FjdGlvbnMgYWdhaW4sIHRoaXMgd2ls\nbAogICAgICAgIC8vIHRyaWdnZXIgYW4gSU5GTwogICAgICAgIHBhdXNlKDE1\nLjEpOwogICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbigiV2FpdGVkIGZvciBh\nIHdoaWxlLiBTaG91bGQgc2VlIDEgSU5GTyBmb3IgbmV4dCAiICsKICAgICAg\nICAgICAgInRyYW5zYWN0aW9uLiIpOwoKICAgICAgICAvLyBUaGlzIHdpbGwg\ndHJpZ2dlciBhIHNpbmdsZSBsb2cgSU5GTwogICAgICAgIHBlcmZvcm1BZGRz\nTW9kaWZpZXNEZWxldGVzKHBtU2VuZGVyLCBOVU1fT0JKRUNUUyk7CiAgICAg\nICAgLy8gVGhpcyBkZWxheSBzaG91bGQgZW5zdXJlIHRoaXMgc2Vjb25kIHNl\nbnQgb2YKICAgICAgICAvLyB0cmFuc21pc3Npb25zIGlzIGRyb3BwZWQgYXMg\nZXhwZWN0ZWQuIElmIHdlCiAgICAgICAgLy8gZG9uJ3QgcGF1c2UsIHRoZSBu\nZXcgcG1mIGNhbiBiZSBjcmVhdGVkLCB0aGVuIHRoZQogICAgICAgIC8vIGV2\nZW50cyB3aWxsIGJlIHNlbnQgYnkgdGhlIHdvcmtlciB0aHJlYWRzLCBhbmQK\nICAgICAgICAvLyB0aGUgbmV3IHBtZiB3aWxsIHJlY2VpdmUgdGhpcyBtZXNz\nYWdlcyAod2hpY2gKICAgICAgICAvLyBhcmUgc3VwcG9zZWQgdG8gYmUgZHJv\ncHBlZCkKICAgICAgICBwYXVzZSgxLjEpOwoKICAgICAgICAvLyAtLS0tLQog\nICAgICAgIC8vIE5vdyByZWNvdmVyeSB0aGUgUmVjZWl2ZXIgYW5kIHRlc3Qg\ndGhhdCBtZXNzYWdlcwogICAgICAgIC8vIHJlc3VtZSBiZWluZyBkZWxpdmVy\nZWQuCiAgICAgICAgLy8gLS0tLS0KCiAgICAgICAgU3lzdGVtLm91dC5wcmlu\ndGxuKCJSZWNvdmVyaW5nIHJlY2VpdmVyIHBtZi4iKTsKICAgICAgICAvLyBS\nZWNyZWF0ZSB0aGUgbGlzdGVuZXIgcG1mIG9mIHRoZSBjbHVzdGVyLgogICAg\nICAgIHBtZlJlY2VpdmVyID0gY3JlYXRlRGlzdGluY3RGYWN0b3J5KAogICAg\nICAgICAgICBUQ1BSZW1vdGVDb21taXRQcm92aWRlci5jbGFzcywKICAgICAg\nICAgICAgIlBvcnQ9NjYzNiwgQWRkcmVzc2VzPTEyNy4wLjAuMTo2NjM2OzEy\nNy4wLjAuMTo1NjM2Iik7CiAgICAgICAgcGF1c2UoMS4wKTsKICAgICAgICAv\nLyByZVJlZ2lzdGVyIHRoZSBzYW1lIGxpc3RlbmVyCiAgICAgICAgKChPcGVu\nSlBBRW50aXR5TWFuYWdlckZhY3RvcnlTUEkpIHBtZlJlY2VpdmVyKS5nZXRD\nb25maWd1cmF0aW9uKCkKICAgICAgICAgICAgLmdldFJlbW90ZUNvbW1pdEV2\nZW50TWFuYWdlcigpLgogICAgICAgICAgICBhZGRMaXN0ZW5lcihsaXN0ZW5l\nckF0UmVjZWl2ZXIpOwogICAgICAgIGFzc2VydEVxdWFscygxLCBsaXN0ZW5l\nckF0UmVjZWl2ZXIudG90YWxBZGRlZENsYXNzZXMpOwogICAgICAgIGFzc2Vy\ndEVxdWFscyhOVU1fT0JKRUNUUywgbGlzdGVuZXJBdFJlY2VpdmVyLnRvdGFs\nRGVsZXRlZCk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKE5VTV9PQkpFQ1RTLCBs\naXN0ZW5lckF0UmVjZWl2ZXIudG90YWxVcGRhdGVkKTsKCiAgICAgICAgU3lz\ndGVtLm91dC5wcmludGxuKCJOb3cgd2FpdGluZyBhIHJlY292ZXJ5dGltZSBz\nbyB0aGF0IHRoZSBzZW5kZXIiKTsKICAgICAgICBTeXN0ZW0ub3V0LnByaW50\nbG4oIndpbGwgcmVzdW1lIHRyeWluZyB0byBjb25uZWN0IHRvIHRoZSByZWNl\naXZlci4iKTsKICAgICAgICBwYXVzZSgxNS4xKTsKCiAgICAgICAgLy8gVGhl\nc2UgZXZlbnRzIHNob3VsZCBnZXQgY29tbXVuaWNhdGVkLgogICAgICAgIHBl\ncmZvcm1BZGRzTW9kaWZpZXNEZWxldGVzKHBtU2VuZGVyLCBOVU1fT0JKRUNU\nUyk7CgogICAgICAgIC8vIFdhaXQgZm9yIGEgbGFzdCBsaXR0bGUgYml0IHNv\nIHRoZSBsaXN0ZW5lciB0aHJlYWQgaW4KICAgICAgICAvLyB0aGUgcmVjZWl2\nZXIgUE1GIGNhbiBnZXQgYWxsIG1lc3NhZ2VzLgogICAgICAgIHBhdXNlKDEu\nMCk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKDIsIGxpc3RlbmVyQXRSZWNlaXZl\nci50b3RhbEFkZGVkQ2xhc3Nlcyk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKDIg\nKiBOVU1fT0JKRUNUUywgbGlzdGVuZXJBdFJlY2VpdmVyLnRvdGFsRGVsZXRl\nZCk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKDIgKiBOVU1fT0JKRUNUUywgbGlz\ndGVuZXJBdFJlY2VpdmVyLnRvdGFsVXBkYXRlZCk7CgogICAgICAgIC8vIHNo\ndXRkb3duCiAgICAgICAgcG1TZW5kZXIuY2xvc2UoKTsKICAgICAgICBwbWZT\nZW5kZXIuY2xvc2UoKTsKICAgICAgICBwbWZSZWNlaXZlci5jbG9zZSgpOwog\nICAgfQoKICAgIHB1YmxpYyB2b2lkIHRlc3RTZW5kZXJSZWNvdmVycygpIHsK\nICAgICAgICAvLyBDcmVhdGUgdHdvIHBtZnMgaW4gYSBjbHVzdGVyIHRoYXQg\nYXJlIHVzaW5nIFJDUFRDUC4KICAgICAgICBPcGVuSlBBRW50aXR5TWFuYWdl\nckZhY3RvcnkgcG1mU2VuZGVyID0gY3JlYXRlRGlzdGluY3RGYWN0b3J5KAog\nICAgICAgICAgICBUQ1BSZW1vdGVDb21taXRQcm92aWRlci5jbGFzcywKICAg\nICAgICAgICAgIlBvcnQ9NTYzNywgQWRkcmVzc2VzPTEyNy4wLjAuMTo1NjM3\nOzEyNy4wLjAuMTo2NjM3Iik7CiAgICAgICAgT3BlbkpQQUVudGl0eU1hbmFn\nZXJGYWN0b3J5IHBtZlJlY2VpdmVyID0gY3JlYXRlRGlzdGluY3RGYWN0b3J5\nKAogICAgICAgICAgICBUQ1BSZW1vdGVDb21taXRQcm92aWRlci5jbGFzcywK\nICAgICAgICAgICAgIlBvcnQ9NjYzNywgQWRkcmVzc2VzPTEyNy4wLjAuMTo2\nNjM3OzEyNy4wLjAuMTo1NjM3Iik7CgogICAgICAgIFJlbW90ZUNvbW1pdExp\nc3RlbmVyVGVzdEltcGwgbGlzdGVuZXJBdFJlY2VpdmVyCiAgICAgICAgICAg\nID0gbmV3IFJlbW90ZUNvbW1pdExpc3RlbmVyVGVzdEltcGwoKTsKICAgICAg\nICAoKE9wZW5KUEFFbnRpdHlNYW5hZ2VyRmFjdG9yeVNQSSkgcG1mUmVjZWl2\nZXIpLmdldENvbmZpZ3VyYXRpb24oKQogICAgICAgICAgICAuZ2V0UmVtb3Rl\nQ29tbWl0RXZlbnRNYW5hZ2VyKCkuCiAgICAgICAgICAgIGFkZExpc3RlbmVy\nKGxpc3RlbmVyQXRSZWNlaXZlcik7CgogICAgICAgIEVudGl0eU1hbmFnZXIg\ncG1TZW5kZXIgPSBwbWZTZW5kZXIuY3JlYXRlRW50aXR5TWFuYWdlcigpOwoK\nICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oIi0tLS0tLS0tLS0tLS0tLS0t\nLS0iKTsKICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oIjIgUE1GcyBjcmVh\ndGVkLCBhY3RpbmcgYXMgYSBjbHVzdGVyIHVzaW5nIHBvcnRzICIgKwogICAg\nICAgICAgICAiNTYzNyBhbmQgNjYzNyIpOwogICAgICAgIFN5c3RlbS5vdXQu\ncHJpbnRsbigiVGVzdGluZyBzY2VuYXJpbyB3aGVyZSBzZW5kZXIgZmFpbHMg\nYW5kIHRoZW4gIiArCiAgICAgICAgICAgICJsYXRlciByZWNvdmVycy4iKTsK\nICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oIkFsbCB0aGUgd2hpbGUgdGhl\nIHJlY2VpdmluZyBwbSBzdGF5cyB1cCBhbmQgIiArCiAgICAgICAgICAgICJz\naG91bGQgcmVjZWl2ZSIpOwogICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbigi\nRXZlbnRzIChib3RoIGJlZm9yZSBhbmQgYWZ0ZXIgdGhlIHNlbmRlcidzICIg\nKwogICAgICAgICAgICAiZmFpbHVyZSkuIik7CgogICAgICAgIC8vIFBlcmZv\ncm0gYSBzZXQgb2YgdHJhbnNhY3Rpb25zLiBFdmVudHMgaW4gdGhlIGNsdXN0\nZXIgd2lsbCBiZQogICAgICAgIC8vIGNvbW11bmljYXRlZAogICAgICAgIHBl\ncmZvcm1BZGRzTW9kaWZpZXNEZWxldGVzKHBtU2VuZGVyLCBOVU1fT0JKRUNU\nUyk7CgogICAgICAgIC8vIFdhaXQgZm9yIGEgYml0IHNvIHRoZSBzb2NrZXRz\nIGluIG91ciBzZW5kZXIgUE1GIGNhbiBmdWxseSB0cmFuc21pdAogICAgICAg\nIC8vIHRoZWlyIEV2ZW50IG1lc3NhZ2VzIHRvIHRoZSByZWNlaXZlciBQTUYu\nCiAgICAgICAgcGF1c2UoMi4xKTsKICAgICAgICAvLyBGYWlsIHRoZSBTZW5k\nZXIgaW4gb3VyIGNsdXN0ZXIKICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4o\nIlNlbmRlciBwbWYgY2xvc2VkLiIpOwogICAgICAgIHBtU2VuZGVyLmNsb3Nl\nKCk7CiAgICAgICAgcG1mU2VuZGVyLmNsb3NlKCk7CgogICAgICAgIC8vIFdh\naXQgZm9yIGEgd2hpbGUsIHRyeSBhZ2FpbiwgdGhpcyB3aWxsIGxldCBjbG9z\nZSBleGNlcHRpb24gcHJvcGFnYXRlCiAgICAgICAgcGF1c2UoNC4xKTsKICAg\nICAgICBTeXN0ZW0ub3V0LnByaW50bG4oIldhaXRlZCBmb3IgYSB3aGlsZS4i\nKTsKICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oIlJlY292ZXJpbmcgdGhl\nIHNlbmRlciBwbWYuIik7CgogICAgICAgIHBtZlNlbmRlciA9IGNyZWF0ZURp\nc3RpbmN0RmFjdG9yeSgKICAgICAgICAgICAgVENQUmVtb3RlQ29tbWl0UHJv\ndmlkZXIuY2xhc3MsCiAgICAgICAgICAgICJQb3J0PTU2MzcsIEFkZHJlc3Nl\ncz0xMjcuMC4wLjE6NTYzNzsxMjcuMC4wLjE6NjYzNyIpOwogICAgICAgIHBt\nU2VuZGVyID0gcG1mU2VuZGVyLmNyZWF0ZUVudGl0eU1hbmFnZXIoKTsKICAg\nICAgICAvLyBQZXJmb3JtIGEgc2Vjb25kIHNldCBvZiB0cmFuc2FjdGlvbnMu\nIEV2ZW50cyBpbiB0aGUgY2x1c3RlciB3aWxsIGJlCiAgICAgICAgLy8gY29t\nbXVuaWNhdGVkCiAgICAgICAgcGVyZm9ybUFkZHNNb2RpZmllc0RlbGV0ZXMo\ncG1TZW5kZXIsIE5VTV9PQkpFQ1RTKTsKCiAgICAgICAgLy8gV2FpdCBmb3Ig\nYSBiaXQgc28gdGhlIGxpc3RlbmVyIHRocmVhZCBpbiB0aGUgcmVjZWl2ZXIg\nUE1GIGNhbiBnZXQgYWxsCiAgICAgICAgLy8gbWVzc2FnZXMuCiAgICAgICAg\ncGF1c2UoNC4xKTsKICAgICAgICBhc3NlcnRFcXVhbHMoMiwgbGlzdGVuZXJB\ndFJlY2VpdmVyLnRvdGFsQWRkZWRDbGFzc2VzKTsKICAgICAgICBhc3NlcnRF\ncXVhbHMoMiAqIE5VTV9PQkpFQ1RTLCBsaXN0ZW5lckF0UmVjZWl2ZXIudG90\nYWxEZWxldGVkKTsKICAgICAgICBhc3NlcnRFcXVhbHMoMiAqIE5VTV9PQkpF\nQ1RTLCBsaXN0ZW5lckF0UmVjZWl2ZXIudG90YWxVcGRhdGVkKTsKCiAgICAg\nICAgLy8gc2h1dGRvd24KICAgICAgICBwbVNlbmRlci5jbG9zZSgpOwogICAg\nICAgIHBtZlNlbmRlci5jbG9zZSgpOwogICAgICAgIHBtZlJlY2VpdmVyLmNs\nb3NlKCk7CiAgICB9CgogICAgcHJvdGVjdGVkIGRvdWJsZSBwZXJmb3JtQWRk\nc01vZGlmaWVzRGVsZXRlcyhFbnRpdHlNYW5hZ2VyIHBtLAogICAgICAgIGlu\ndCBudW1PYmplY3RzKSB7CiAgICAgICAgLy8gUGVyZm9ybSBhIHNlcmllcyBv\nZiB0cmFuc2FjdGlvbnMgdGhhdCB3aWxsIHRyaWdnZXIgYWRkcywKICAgICAg\nICAvLyBkZWxldGVzLCBhbmQgdWRwYXRlcwogICAgICAgIER1cmF0aW9uIHRp\nbWVUb0FNRCA9IG5ldyBEdXJhdGlvbigKICAgICAgICAgICAgIkFkZHMsIHJl\nbW92ZXMsIGFuZCBkbGV0ZXMgZm9yICIgKyBudW1PYmplY3RzICsgIiBvYmpl\nY3RzLiIpOwogICAgICAgIHRpbWVUb0FNRC5zdGFydCgpOwoKICAgICAgICAv\nLyBjcmVhdGUgb2JqZWN0cwogICAgICAgIFJ1bnRpbWVUZXN0MVtdIHBlcnNp\nc3RhYmxlcyA9IG5ldyBSdW50aW1lVGVzdDFbbnVtT2JqZWN0c107CiAgICAg\nICAgZm9yIChpbnQgaSA9IDA7IGkgPCBwZXJzaXN0YWJsZXMubGVuZ3RoOyBp\nKyspIHsKICAgICAgICAgICAgcGVyc2lzdGFibGVzW2ldID0gbmV3IFJ1bnRp\nbWVUZXN0MSgiZm9vICMiICsgaSwgaSk7CiAgICAgICAgfQoKICAgICAgICAv\nLyBhZGQgdGhlbQogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgcGVyc2lz\ndGFibGVzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIHN0YXJ0VHgocG0p\nOwogICAgICAgICAgICBwbS5wZXJzaXN0KHBlcnNpc3RhYmxlc1tpXSk7CiAg\nICAgICAgICAgIGVuZFR4KHBtKTsKICAgICAgICB9CgogICAgICAgIC8vIG1v\nZGlmeSB0aGVtCiAgICAgICAgc3RhcnRUeChwbSk7CiAgICAgICAgZm9yIChp\nbnQgaSA9IDA7IGkgPCBwZXJzaXN0YWJsZXMubGVuZ3RoOyBpKyspIHsKICAg\nICAgICAgICAgcGVyc2lzdGFibGVzW2ldLnNldFN0cmluZ0ZpZWxkKCJiYXp6\nZWQiICsgaSk7CiAgICAgICAgfQogICAgICAgIGVuZFR4KHBtKTsKCiAgICAg\nICAgLy8gZGVsZXRlIHRoZW0KICAgICAgICBzdGFydFR4KHBtKTsKICAgICAg\nICBmb3IgKGludCBpID0gMDsgaSA8IHBlcnNpc3RhYmxlcy5sZW5ndGg7IGkr\nKykgewogICAgICAgICAgICBwbS5yZW1vdmUocGVyc2lzdGFibGVzW2ldKTsK\nICAgICAgICB9CiAgICAgICAgZW5kVHgocG0pOwoKICAgICAgICB0aW1lVG9B\nTUQuc3RvcCgpOwogICAgICAgIHJldHVybiB0aW1lVG9BTUQuZ2V0RHVyYXRp\nb25Bc1NlY29uZHMoKTsKICAgIH0KCiAgICBzdGF0aWMgaW50IF9mZXRjaEdy\nb3VwU2VyaWFsID0gMDsKCiAgICBwcm90ZWN0ZWQgT3BlbkpQQUVudGl0eU1h\nbmFnZXJGYWN0b3J5IGNyZWF0ZURpc3RpbmN0RmFjdG9yeSgKICAgICAgICBD\nbGFzcyBwcm92aWRlckNsYXNzLCBTdHJpbmcgY2xhc3NQcm9wczEpIHsKICAg\nICAgICBNYXAgcHJvcHNNYXA7CgogICAgICAgIGlmIChwcm92aWRlckNsYXNz\nICE9IG51bGwpIHsKCiAgICAgICAgICAgIHByb3BzTWFwID0gbmV3IEhhc2hN\nYXAoKTsKICAgICAgICAgICAgcHJvcHNNYXAucHV0KCJvcGVuanBhLlJlbW90\nZUNvbW1pdFByb3ZpZGVyIiwgQ29uZmlndXJhdGlvbnMuCiAgICAgICAgICAg\nICAgICBnZXRQbHVnaW4ocHJvdmlkZXJDbGFzcy5nZXROYW1lKCksIGNsYXNz\nUHJvcHMxKSk7CiAgICAgICAgICAgIHByb3BzTWFwLnB1dCgib3BlbmpwYS5G\nZXRjaEdyb3VwcyIsICJkaWZmZXJlbnRpYXRpbmdGZXRjaEdyb3VwIiArCiAg\nICAgICAgICAgICAgICBfZmV0Y2hHcm91cFNlcmlhbCk7CiAgICAgICAgfSBl\nbHNlIHsKICAgICAgICAgICAgLy8gTm8gUkNQCiAgICAgICAgICAgIHByb3Bz\nTWFwID0gbmV3IEhhc2hNYXAoKTsKICAgICAgICAgICAgcHJvcHNNYXAucHV0\nKCJvcGVuanBhLlJlbW90ZUNvbW1pdFByb3ZpZGVyIiwgInNqdm0iKTsKICAg\nICAgICAgICAgcHJvcHNNYXAucHV0KCJvcGVuanBhLkZldGNoR3JvdXBzIiwg\nImRpZmZlcmVudGlhdGluZ0ZldGNoR3JvdXAiICsKICAgICAgICAgICAgICAg\nIF9mZXRjaEdyb3VwU2VyaWFsKTsKICAgICAgICB9CiAgICAgICAgX2ZldGNo\nR3JvdXBTZXJpYWwgKz0gMTsKCiAgICAgICAgcmV0dXJuIGdldEVtZihwcm9w\nc01hcCk7CiAgICB9CgogICAgcHJvdGVjdGVkIHN0YXRpYyBjbGFzcyBSZW1v\ndGVDb21taXRMaXN0ZW5lclRlc3RJbXBsCiAgICAgICAgaW1wbGVtZW50cyBS\nZW1vdGVDb21taXRMaXN0ZW5lciB7CgogICAgICAgIENvbGxlY3Rpb24gdXBk\nYXRlZDsKICAgICAgICBDb2xsZWN0aW9uIGRlbGV0ZWQ7CiAgICAgICAgaW50\nIHRvdGFsQWRkZWRDbGFzc2VzOwogICAgICAgIGludCB0b3RhbFVwZGF0ZWQ7\nCiAgICAgICAgaW50IHRvdGFsRGVsZXRlZDsKCiAgICAgICAgcHVibGljIHN5\nbmNocm9uaXplZCB2b2lkIGFmdGVyQ29tbWl0KFJlbW90ZUNvbW1pdEV2ZW50\nIGV2ZW50KSB7CiAgICAgICAgICAgIHRoaXMudXBkYXRlZCA9IGV2ZW50Lmdl\ndFVwZGF0ZWRPYmplY3RJZHMoKTsKICAgICAgICAgICAgdGhpcy5kZWxldGVk\nID0gZXZlbnQuZ2V0RGVsZXRlZE9iamVjdElkcygpOwoKICAgICAgICAgICAg\ndG90YWxBZGRlZENsYXNzZXMgKz0gZXZlbnQuZ2V0UGVyc2lzdGVkVHlwZU5h\nbWVzKCkuc2l6ZSgpOwogICAgICAgICAgICB0b3RhbFVwZGF0ZWQgKz0gdXBk\nYXRlZC5zaXplKCk7CiAgICAgICAgICAgIHRvdGFsRGVsZXRlZCArPSBkZWxl\ndGVkLnNpemUoKTsKICAgICAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKCJB\nZnRlcmNvbW1pdCAiICsgdGhpcyk7CiAgICAgICAgfQoKICAgICAgICBwdWJs\naWMgdm9pZCBjbG9zZSgpIHsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBT\ndHJpbmcgdG9TdHJpbmcoKSB7CiAgICAgICAgICAgIFN0cmluZyByZXR1cm5T\ndHJpbmcgPSAiQWRkZWQgY2xzc2VzICIgKyB0b3RhbEFkZGVkQ2xhc3NlcyAr\nCiAgICAgICAgICAgICAgICAiIERlbHMgIiArIHRvdGFsRGVsZXRlZCArICIg\nVXBzICIgKyB0b3RhbFVwZGF0ZWQ7CiAgICAgICAgICAgIHJldHVybiByZXR1\ncm5TdHJpbmc7CiAgICAgICAgfQogICAgfQp9Cg==\n","encoding":"base64"}

