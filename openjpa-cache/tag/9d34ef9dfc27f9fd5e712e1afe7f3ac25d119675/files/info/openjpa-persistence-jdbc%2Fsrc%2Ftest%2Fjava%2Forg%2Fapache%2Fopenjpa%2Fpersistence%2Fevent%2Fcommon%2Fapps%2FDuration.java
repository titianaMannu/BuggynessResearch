{"sha":"e7777bbe756f1e6fd6d0aa3baedf7cf5eeae5a38","node_id":"MDQ6QmxvYjIwNjM2NDplNzc3N2JiZTc1NmYxZTZmZDZkMGFhM2JhZWRmN2NmNWVlYWU1YTM4","size":4818,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/e7777bbe756f1e6fd6d0aa3baedf7cf5eeae5a38","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuZXZlbnQu\nY29tbW9uLmFwcHM7CgppbXBvcnQgamF2YXgucGVyc2lzdGVuY2UuRW50aXR5\nOwoKQEVudGl0eQoKLyoKCiAgICBNaWxsaXNlY29uZCAob25seSkgYWNjdXJh\nY3kgdGltZXIuCgogICAgSmF2YSAxLjQgc3VwcG9zZWRseSBoYXMgc3VuLm1p\nc2MuUGVyZi4KCiAgICBKYXZhIDEuNSBoYXMgU3lzdGVtLm5hbm9UaW1lIChK\nU1IgMTY2KQoKKi8KCnB1YmxpYyBjbGFzcyBEdXJhdGlvbgoKICAgIGltcGxl\nbWVudHMgQ2xvbmVhYmxlIHsKCiAgICBwcml2YXRlIFN0cmluZyBfbmFtZTsK\nCiAgICBwcml2YXRlIGJvb2xlYW4gX3N0YXJ0ZWQ7CgogICAgcHJpdmF0ZSBi\nb29sZWFuIF9ydW5uaW5nOwoKICAgIHByaXZhdGUgbG9uZyBfc3RhcnRUaW1l\nOyAgICAgICAgLy8gbWlsbGlzCgogICAgcHJpdmF0ZSBsb25nIF9zdG9wVGlt\nZTsgICAgICAgIC8vIG1pbGxpcwoKICAgIC8vIE5ZSSBjbG9jayB0aW1lIG9m\nIGRheSBhdCBzdGFydAoKICAgIHB1YmxpYyBEdXJhdGlvbihTdHJpbmcgbmFt\nZSkgewoKICAgICAgICBfbmFtZSA9IG5hbWU7CgogICAgICAgIF9zdGFydGVk\nID0gZmFsc2U7CgogICAgICAgIF9ydW5uaW5nID0gZmFsc2U7CiAgICB9Cgog\nICAgcHVibGljIFN0cmluZyBnZXROYW1lKCkgewoKICAgICAgICByZXR1cm4g\nX25hbWU7CiAgICB9CgogICAgcHVibGljIHN5bmNocm9uaXplZCB2b2lkIHN0\nYXJ0KCkgewoKICAgICAgICBpZiAoX3N0YXJ0ZWQpIHsKCiAgICAgICAgICAg\nIHRocm93IG5ldyBSdW50aW1lRXhjZXB0aW9uKCJEdXJhdGlvbiB3YXMgYWxy\nZWFkeSBzdGFydGVkLiIpOwogICAgICAgIH0KCiAgICAgICAgX3N0YXJ0VGlt\nZSA9IFN5c3RlbS5jdXJyZW50VGltZU1pbGxpcygpOwoKICAgICAgICBfc3Rh\ncnRlZCA9IHRydWU7CgogICAgICAgIF9ydW5uaW5nID0gdHJ1ZTsKICAgIH0K\nCiAgICBwdWJsaWMgc3luY2hyb25pemVkIHZvaWQgc3RvcCgpIHsKCiAgICAg\nICAgaWYgKCFfc3RhcnRlZCkgewoKICAgICAgICAgICAgdGhyb3cgbmV3IFJ1\nbnRpbWVFeGNlcHRpb24oIkR1cmF0aW9uIHdhcyBuZXZlciBzdGFydGVkLiIp\nOwogICAgICAgIH0KCiAgICAgICAgaWYgKCFfcnVubmluZykgewoKICAgICAg\nICAgICAgdGhyb3cgbmV3IFJ1bnRpbWVFeGNlcHRpb24oIkR1cmF0aW9uIHdh\ncyBhbHJlYWR5IHN0b3BwZWQuIik7CiAgICAgICAgfQoKICAgICAgICBfc3Rv\ncFRpbWUgPSBTeXN0ZW0uY3VycmVudFRpbWVNaWxsaXMoKTsKCiAgICAgICAg\nX3J1bm5pbmcgPSBmYWxzZTsKICAgIH0KCiAgICBwcm90ZWN0ZWQgT2JqZWN0\nIGNsb25lKCkKCiAgICAgICAgdGhyb3dzIENsb25lTm90U3VwcG9ydGVkRXhj\nZXB0aW9uIHsKCiAgICAgICAgcmV0dXJuIHN1cGVyLmNsb25lKCk7CiAgICB9\nCgogICAgLyoKCiAgICAgICAgUmV0dXJucyBhIG5ldyBEdXJhdGlvbiBvYmpl\nY3QgZnJvbSBhIGN1cnJlbnRseSBydW5uaW5nIHRpbWVyCgogICAgICAgIGFz\nIGEgc25hcHNob3Qgb2YgdGhpcyBvYmplY3QuCgogICAgICAgIFRoZSByZXR1\ncm5lZCB0aW1lciBpcyBzdG9wcGVkLCB3aGlsZSB0aGlzIG9iamVjdCBjb250\naW51ZSBvbi4KCiAgICAqLwoKICAgIHB1YmxpYyBzeW5jaHJvbml6ZWQgRHVy\nYXRpb24gZ2V0Q3VycmVudER1cmF0aW9uKCkgewoKICAgICAgICBpZiAoIV9z\ndGFydGVkKSB7CgogICAgICAgICAgICB0aHJvdyBuZXcgUnVudGltZUV4Y2Vw\ndGlvbigiRHVyYXRpb24gd2FzIG5ldmVyIHN0YXJ0ZWQuIik7CiAgICAgICAg\nfQoKICAgICAgICBpZiAoIV9ydW5uaW5nKSB7CgogICAgICAgICAgICB0aHJv\ndyBuZXcgUnVudGltZUV4Y2VwdGlvbigiRHVyYXRpb24gaXMgbm90IHJ1bm5p\nbmcuIik7CiAgICAgICAgfQoKICAgICAgICBsb25nIG5vdyA9IFN5c3RlbS5j\ndXJyZW50VGltZU1pbGxpcygpOwoKICAgICAgICBEdXJhdGlvbiBjdXJyZW50\nRHVyYXRpb247CgogICAgICAgIHRyeSB7CgogICAgICAgICAgICBjdXJyZW50\nRHVyYXRpb24gPSAoRHVyYXRpb24pIHRoaXMuY2xvbmUoKTsKICAgICAgICB9\nIGNhdGNoIChFeGNlcHRpb24gZSkgewoKICAgICAgICAgICAgY3VycmVudER1\ncmF0aW9uID0gbmV3IER1cmF0aW9uKCIiKTsKICAgICAgICB9CgogICAgICAg\nIGN1cnJlbnREdXJhdGlvbi5fc3RvcFRpbWUgPSBub3c7CgogICAgICAgIGN1\ncnJlbnREdXJhdGlvbi5fcnVubmluZyA9IGZhbHNlOwoKICAgICAgICByZXR1\ncm4gY3VycmVudER1cmF0aW9uOwogICAgfQoKICAgIC8qIE9idGFpbiB0aGUg\nZHVyYXRpb24gdGhhdCB0aGlzIHRpbWVyIGhhcyBydW4gKGluIHNlY29uZHMp\nCSovCgogICAgcHVibGljIHN5bmNocm9uaXplZCBkb3VibGUgZ2V0RHVyYXRp\nb25Bc1NlY29uZHMoKSB7CgogICAgICAgIGlmICghX3N0YXJ0ZWQpIHsKCiAg\nICAgICAgICAgIHRocm93IG5ldyBSdW50aW1lRXhjZXB0aW9uKCJEdXJhdGlv\nbiB3YXMgbmV2ZXIgc3RhcnRlZC4iKTsKICAgICAgICB9CgogICAgICAgIGlm\nIChfcnVubmluZykgewoKICAgICAgICAgICAgLy8gc25hcHNob3QKCiAgICAg\nICAgICAgIER1cmF0aW9uIHNuYXBzaG90ID0gZ2V0Q3VycmVudER1cmF0aW9u\nKCk7CgogICAgICAgICAgICByZXR1cm4gKDEwMDAuMCAqIChzbmFwc2hvdC5f\nc3RvcFRpbWUgLSBzbmFwc2hvdC5fc3RhcnRUaW1lKSk7CiAgICAgICAgfQoK\nICAgICAgICAvLyBSZXR1cm4gYSBkb3VibGUgdmFsdWUuIFNvbWVkYXkgdGhp\ncyBjbGFzcyBtYXkgbWFrZSB1c2Ugb2YKCiAgICAgICAgLy8gaGlnaGVyIHBy\nZWNpc2lvbiB0aW1pbmcgc2VydmljZXMgKGUuZy4gamF2YSAxLjUpCgogICAg\nICAgIHJldHVybiAoKF9zdG9wVGltZSAtIF9zdGFydFRpbWUpIC8gKGRvdWJs\nZSkgMTAwMC4wKTsKICAgIH0KCiAgICBwdWJsaWMgc3luY2hyb25pemVkIGJv\nb2xlYW4gaXNSdW5uaW5nKCkgewoKICAgICAgICByZXR1cm4gX3J1bm5pbmc7\nCiAgICB9CgogICAgcHVibGljIHN5bmNocm9uaXplZCBib29sZWFuIHdhc1N0\nYXJ0ZWQoKSB7CgogICAgICAgIHJldHVybiBfc3RhcnRlZDsKICAgIH0KCiAg\nICBwdWJsaWMgU3RyaW5nIHRvU3RyaW5nKCkgewoKICAgICAgICBkb3VibGUg\ndGltZSA9IDAuMDsKCiAgICAgICAgU3RyaW5nQnVmZmVyIGJ1ZiA9IG5ldyBT\ndHJpbmdCdWZmZXIoMjU2KTsKCiAgICAgICAgaWYgKHdhc1N0YXJ0ZWQoKSkg\newoKICAgICAgICAgICAgaWYgKGlzUnVubmluZygpKSB7CgogICAgICAgICAg\nICAgICAgRHVyYXRpb24gc25hcHNob3QgPSBnZXRDdXJyZW50RHVyYXRpb24o\nKTsKCiAgICAgICAgICAgICAgICB0aW1lID0gc25hcHNob3QuZ2V0RHVyYXRp\nb25Bc1NlY29uZHMoKTsKICAgICAgICAgICAgfSBlbHNlIHsKCiAgICAgICAg\nICAgICAgICB0aW1lID0gZ2V0RHVyYXRpb25Bc1NlY29uZHMoKTsKICAgICAg\nICAgICAgfQoKICAgICAgICAgICAgYnVmLmFwcGVuZCgiRHVyYXRpb24gZm9y\nICciICsgX25hbWUgKyAiJyBpcyAiICsgdGltZSArICIgKHMpLiIpOwogICAg\nICAgIH0gZWxzZSB7CgogICAgICAgICAgICBidWYuYXBwZW5kKCJEdXJhdGlv\nbiBmb3IgJyIgKyBfbmFtZSArCgogICAgICAgICAgICAgICAgIicgaGFzIG5v\ndCB5ZXQgYmVlbiBzdGFydGVkLiIpOwogICAgICAgIH0KCiAgICAgICAgcmV0\ndXJuIGJ1Zi50b1N0cmluZygpOwogICAgfQoKLyogRXhhbXBsZSB1c2FnZToK\nCiAgICAgICBwdWJsaWMgc3RhdGljIHZvaWQgbWFpbiAoU3RyaW5nW10gYXJn\ncykKCiAgICAgICAgdGhyb3dzIEV4Y2VwdGlvbgoKICAgIHsKCiAgICAgICAg\nRHVyYXRpb24gdGVzdCA9IG5ldyBEdXJhdGlvbiAoImhlbGxvLCBjb3VudCB0\nbyAxIG1pbGxpb24iKTsKCiAgICAgICAgU3lzdGVtLm91dC5wcmludGxuICh0\nZXN0KTsKCiAgICAgICAgdGVzdC5zdGFydCAoKTsKCiAgICAgICAgZm9yIChp\nbnQgaSA9IDA7IGkgPCAxMDAwMDAwMDAwOyBpKyspCgogICAgICAgICAgICB7\nCgogICAgICAgICAgICB9CgogICAgICAgIHRlc3Quc3RvcCAoKTsKCiAgICAg\nICAgU3lzdGVtLm91dC5wcmludGxuICh0ZXN0KTsKCiAgICB9CgogICAgKi8K\nfQoK\n","encoding":"base64"}

