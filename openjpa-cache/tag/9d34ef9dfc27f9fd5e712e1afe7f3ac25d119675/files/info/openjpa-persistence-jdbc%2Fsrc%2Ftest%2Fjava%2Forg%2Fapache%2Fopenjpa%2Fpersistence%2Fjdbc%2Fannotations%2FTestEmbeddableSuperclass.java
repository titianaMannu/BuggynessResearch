{"sha":"3c3176754de11056c4fcdc7bb43403d2a677e8fb","node_id":"MDQ6QmxvYjIwNjM2NDozYzMxNzY3NTRkZTExMDU2YzRmY2RjN2JiNDM0MDNkMmE2NzdlOGZi","size":5634,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/3c3176754de11056c4fcdc7bb43403d2a677e8fb","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpwYWNr\nYWdlIG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5qZGJjLmFubm90\nYXRpb25zOwoKaW1wb3J0IGphdmEuc3FsLlR5cGVzOwoKaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS5qZGJjLmNvbmYuSkRCQ0NvbmZpZ3VyYXRpb247Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhLkNsYXNzTWFwcGlu\nZzsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLm1ldGEuRmllbGRN\nYXBwaW5nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0YS5z\ndHJhdHMuQ2xvYlZhbHVlSGFuZGxlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5qZGJjLm1ldGEuc3RyYXRzLkZ1bGxDbGFzc1N0cmF0ZWd5OwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0YS5zdHJhdHMuTWF4RW1i\nZWRkZWRDbG9iRmllbGRTdHJhdGVneTsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5qZGJjLm1ldGEuc3RyYXRzLk5vbmVDbGFzc1N0cmF0ZWd5OwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0YS5zdHJhdHMuUmVsYXRp\nb25GaWVsZFN0cmF0ZWd5OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpk\nYmMubWV0YS5zdHJhdHMuU3RyaW5nRmllbGRTdHJhdGVneTsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNxbC5EQkRpY3Rpb25hcnk7CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YS5WYWx1ZVN0cmF0ZWdpZXM7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuT3BlbkpQQUVu\ndGl0eU1hbmFnZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lz\ndGVuY2UudGVzdC5TaW5nbGVFTUZUZXN0Q2FzZTsKCi8qKgogKiA8cD5UZXN0\nIGVtYmVkZGFibGUgc3VwZXJjbGFzc2VzLjwvcD4KICoKICogQGF1dGhvciBB\nYmUgV2hpdGUKICovCnB1YmxpYyBjbGFzcyBUZXN0RW1iZWRkYWJsZVN1cGVy\nY2xhc3MKICAgIGV4dGVuZHMgU2luZ2xlRU1GVGVzdENhc2UgewoKICAgIHB1\nYmxpYyB2b2lkIHNldFVwKCkgewogICAgICAgIHNldFVwKEVtYmVkZGFibGVT\ndXBlci5jbGFzcywgRW1iZWRkYWJsZVN1cGVyU3ViLmNsYXNzLCBDTEVBUl9U\nQUJMRVMpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHRlc3RTdXBlcmNsYXNz\nRW1iZWRkZWRPbmx5KCkgewogICAgICAgIENsYXNzTWFwcGluZyBjbHMgPSAo\nKEpEQkNDb25maWd1cmF0aW9uKSBlbWYuZ2V0Q29uZmlndXJhdGlvbigpKS4K\nICAgICAgICAgICAgZ2V0TWFwcGluZ1JlcG9zaXRvcnlJbnN0YW5jZSgpLmdl\ndE1hcHBpbmcoRW1iZWRkYWJsZVN1cGVyLmNsYXNzLCAKICAgICAgICAgICAg\nbnVsbCwgdHJ1ZSk7CiAgICAgICAgYXNzZXJ0VHJ1ZShjbHMuaXNFbWJlZGRl\nZE9ubHkoKSk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKE5vbmVDbGFzc1N0cmF0\nZWd5LmdldEluc3RhbmNlKCksIGNscy5nZXRTdHJhdGVneSgpKTsKICAgIH0K\nCiAgICBwdWJsaWMgdm9pZCB0ZXN0U3ViY2xhc3NNYXBwaW5nRGVmYXVsdHNB\nbmRPdmVycmlkZXMoKSB7CiAgICAgICAgSkRCQ0NvbmZpZ3VyYXRpb24gY29u\nZiA9IChKREJDQ29uZmlndXJhdGlvbikgZW1mLmdldENvbmZpZ3VyYXRpb24o\nKTsKICAgICAgICBDbGFzc01hcHBpbmcgY2xzID0gY29uZi5nZXRNYXBwaW5n\nUmVwb3NpdG9yeUluc3RhbmNlKCkuCiAgICAgICAgICAgIGdldE1hcHBpbmco\nRW1iZWRkYWJsZVN1cGVyU3ViLmNsYXNzLCBudWxsLCB0cnVlKTsKICAgICAg\nICBhc3NlcnRUcnVlKCFjbHMuaXNFbWJlZGRlZE9ubHkoKSk7CiAgICAgICAg\nYXNzZXJ0VHJ1ZShjbHMuZ2V0U3RyYXRlZ3koKSBpbnN0YW5jZW9mIEZ1bGxD\nbGFzc1N0cmF0ZWd5KTsKICAgICAgICBhc3NlcnRFcXVhbHMoQ2xhc3NNYXBw\naW5nLklEX0FQUExJQ0FUSU9OLCBjbHMuZ2V0SWRlbnRpdHlUeXBlKCkpOwog\nICAgICAgIGFzc2VydFRydWUoY2xzLmlzT3BlbkpQQUlkZW50aXR5KCkpOwoK\nICAgICAgICBGaWVsZE1hcHBpbmcgZm0gPSBjbHMuZ2V0RmllbGRNYXBwaW5n\nKCJwayIpOwogICAgICAgIGFzc2VydFRydWUoZm0uaXNQcmltYXJ5S2V5KCkp\nOwogICAgICAgIGFzc2VydEVxdWFscyhWYWx1ZVN0cmF0ZWdpZXMuU0VRVUVO\nQ0UsIGZtLmdldFZhbHVlU3RyYXRlZ3koKSk7CiAgICAgICAgYXNzZXJ0RXF1\nYWxzKCJJRCIsIGZtLmdldENvbHVtbnMoKVswXS5nZXROYW1lKCkpOwoKICAg\nICAgICBhc3NlcnROdWxsKGNscy5nZXRGaWVsZCgidHJhbnMiKSk7CgogICAg\nICAgIGZtID0gY2xzLmdldEZpZWxkTWFwcGluZygiY2xvYiIpOwogICAgICAg\nIGFzc2VydEVxdWFscygiQ0MiLCBmbS5nZXRDb2x1bW5zKClbMF0uZ2V0TmFt\nZSgpKTsKICAgICAgICBEQkRpY3Rpb25hcnkgZGljdCA9IGNvbmYuZ2V0REJE\naWN0aW9uYXJ5SW5zdGFuY2UoKTsKICAgICAgICBpZiAoZGljdC5nZXRQcmVm\nZXJyZWRUeXBlKFR5cGVzLkNMT0IpID09IFR5cGVzLkNMT0IpIHsKICAgICAg\nICAgICAgaWYgKGRpY3QubWF4RW1iZWRkZWRDbG9iU2l6ZSA+IDApCiAgICAg\nICAgICAgICAgICBhc3NlcnRUcnVlKGZtLmdldFN0cmF0ZWd5KCkgaW5zdGFu\nY2VvZgogICAgICAgICAgICAgICAgICAgIE1heEVtYmVkZGVkQ2xvYkZpZWxk\nU3RyYXRlZ3kpOwogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICBh\nc3NlcnRUcnVlKGZtLmdldEhhbmRsZXIoKSBpbnN0YW5jZW9mIENsb2JWYWx1\nZUhhbmRsZXIpOwogICAgICAgIH0gZWxzZQogICAgICAgICAgICBhc3NlcnRU\ncnVlKGZtLmdldFN0cmF0ZWd5KCkgaW5zdGFuY2VvZiBTdHJpbmdGaWVsZFN0\ncmF0ZWd5KTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCB0ZXN0U3ViY2xhc3NE\naXNjcmltaW5hdG9yTWFwcGluZygpIHsKICAgICAgICBKREJDQ29uZmlndXJh\ndGlvbiBjb25mID0gKEpEQkNDb25maWd1cmF0aW9uKSBlbWYuZ2V0Q29uZmln\ndXJhdGlvbigpOwogICAgICAgIENsYXNzTWFwcGluZyBjbHMgPSBjb25mLmdl\ndE1hcHBpbmdSZXBvc2l0b3J5SW5zdGFuY2UoKS4KICAgICAgICAgICAgZ2V0\nTWFwcGluZyhFbWJlZGRhYmxlU3VwZXJTdWIuY2xhc3MsIG51bGwsIHRydWUp\nOwogICAgICAgIGFzc2VydEVxdWFscygiRElTQyIsIGNscy5nZXREaXNjcmlt\naW5hdG9yKCkuZ2V0Q29sdW1ucygpWzBdLgogICAgICAgICAgICBnZXROYW1l\nKCkpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHRlc3RWZXJzaW9uT3ZlcnJp\nZGVNYXBwaW5nKCkgewogICAgICAgIEpEQkNDb25maWd1cmF0aW9uIGNvbmYg\nPSAoSkRCQ0NvbmZpZ3VyYXRpb24pIGVtZi5nZXRDb25maWd1cmF0aW9uKCk7\nCiAgICAgICAgQ2xhc3NNYXBwaW5nIGNscyA9IGNvbmYuZ2V0TWFwcGluZ1Jl\ncG9zaXRvcnlJbnN0YW5jZSgpLgogICAgICAgICAgICBnZXRNYXBwaW5nKEVt\nYmVkZGFibGVTdXBlclN1Yi5jbGFzcywgbnVsbCwgdHJ1ZSk7CiAgICAgICAg\nYXNzZXJ0RXF1YWxzKCJWRVJTVkFMIiwgY2xzLmdldFZlcnNpb24oKS5nZXRD\nb2x1bW5zKClbMF0uZ2V0TmFtZSgpKTsKICAgIH0KCiAgICBwdWJsaWMgdm9p\nZCB0ZXN0UmVsYXRpb25NYXBwaW5ncygpIHsKICAgICAgICBKREJDQ29uZmln\ndXJhdGlvbiBjb25mID0gKEpEQkNDb25maWd1cmF0aW9uKSBlbWYuZ2V0Q29u\nZmlndXJhdGlvbigpOwogICAgICAgIENsYXNzTWFwcGluZyBjbHMgPSBjb25m\nLmdldE1hcHBpbmdSZXBvc2l0b3J5SW5zdGFuY2UoKS4KICAgICAgICAgICAg\nZ2V0TWFwcGluZyhFbWJlZGRhYmxlU3VwZXJTdWIuY2xhc3MsIG51bGwsIHRy\ndWUpOwogICAgICAgIEZpZWxkTWFwcGluZyBmbSA9IGNscy5nZXRGaWVsZE1h\ncHBpbmcoInN1YiIpOwogICAgICAgIGFzc2VydFRydWUoZm0uZ2V0U3RyYXRl\nZ3koKSBpbnN0YW5jZW9mIFJlbGF0aW9uRmllbGRTdHJhdGVneSk7CgogICAg\nICAgIGZtID0gY2xzLmdldEZpZWxkTWFwcGluZygic3VwIik7CiAgICAgICAg\nYXNzZXJ0VHJ1ZShmbS5nZXRTdHJhdGVneSgpIGluc3RhbmNlb2YgUmVsYXRp\nb25GaWVsZFN0cmF0ZWd5KTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCB0ZXN0\nUGVyc2lzdEFuZEZpbmQoKSB7CiAgICAgICAgRW1iZWRkYWJsZVN1cGVyU3Vi\nIHBhcmVudCA9IG5ldyBFbWJlZGRhYmxlU3VwZXJTdWIoKTsKICAgICAgICBw\nYXJlbnQuc2V0Q2xvYigicGFyZW50Iik7CiAgICAgICAgRW1iZWRkYWJsZVN1\ncGVyU3ViIHN1YiA9IG5ldyBFbWJlZGRhYmxlU3VwZXJTdWIoKTsKICAgICAg\nICBzdWIuc2V0Q2xvYigic3ViIik7CiAgICAgICAgRW1iZWRkYWJsZVN1cGVy\nU3ViIHN1cCA9IG5ldyBFbWJlZGRhYmxlU3VwZXJTdWIoKTsKICAgICAgICBz\ndXAuc2V0Q2xvYigic3VwIik7CiAgICAgICAgcGFyZW50LnNldFN1YihzdWIp\nOwogICAgICAgIHBhcmVudC5zZXRTdXAoc3VwKTsKCiAgICAgICAgT3BlbkpQ\nQUVudGl0eU1hbmFnZXIgZW0gPSBlbWYuY3JlYXRlRW50aXR5TWFuYWdlcigp\nOwogICAgICAgIGVtLmdldFRyYW5zYWN0aW9uKCkuYmVnaW4oKTsKICAgICAg\nICBlbS5wZXJzaXN0QWxsKHBhcmVudCwgc3ViLCBzdXApOwogICAgICAgIGVt\nLmdldFRyYW5zYWN0aW9uKCkuY29tbWl0KCk7CiAgICAgICAgbG9uZyBwayA9\nIHBhcmVudC5nZXRQSygpOwogICAgICAgIGVtLmNsb3NlKCk7CgogICAgICAg\nIGVtID0gZW1mLmNyZWF0ZUVudGl0eU1hbmFnZXIoKTsKICAgICAgICBwYXJl\nbnQgPSBlbS5maW5kKEVtYmVkZGFibGVTdXBlclN1Yi5jbGFzcywgcGspOwog\nICAgICAgIGFzc2VydEVxdWFscygicGFyZW50IiwgcGFyZW50LmdldENsb2Io\nKSk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKCJzdWIiLCBwYXJlbnQuZ2V0U3Vi\nKCkuZ2V0Q2xvYigpKTsKICAgICAgICBhc3NlcnRFcXVhbHMoInN1cCIsIHBh\ncmVudC5nZXRTdXAoKS5nZXRDbG9iKCkpOwogICAgICAgIGVtLmNsb3NlKCk7\nCiAgICB9Cn0K\n","encoding":"base64"}

