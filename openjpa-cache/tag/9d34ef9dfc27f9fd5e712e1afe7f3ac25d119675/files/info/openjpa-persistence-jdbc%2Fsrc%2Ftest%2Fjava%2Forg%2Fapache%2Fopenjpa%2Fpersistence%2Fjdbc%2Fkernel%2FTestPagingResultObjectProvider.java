{"sha":"5a6ddfd0b147f38e91a3b5f246cbc13c69e059b0","node_id":"MDQ6QmxvYjIwNjM2NDo1YTZkZGZkMGIxNDdmMzhlOTFhM2I1ZjI0NmNiYzEzYzY5ZTA1OWIw","size":22689,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/5a6ddfd0b147f38e91a3b5f246cbc13c69e059b0","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuamRiYy5r\nZXJuZWw7CgppbXBvcnQgamF2YS51dGlsLio7CmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEuamRiYy5jb25mLio7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEuamRiYy5tZXRhLio7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRi\nYy5zcWwuKjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5j\nZS5qZGJjLmNvbW1vbi5hcHBzLio7CgoKaW1wb3J0IGphdmEubGFuZy5hbm5v\ndGF0aW9uLkFubm90YXRpb247CmltcG9ydCBqdW5pdC5mcmFtZXdvcmsuKjsK\naW1wb3J0IGphdmF4LnBlcnNpc3RlbmNlLkVudGl0eU1hbmFnZXI7CmltcG9y\ndCBqYXZheC5wZXJzaXN0ZW5jZS5FbnRpdHlNYW5hZ2VyRmFjdG9yeTsKaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLmNvbmYuSkRCQ0NvbmZpZ3Vy\nYXRpb247CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2Uu\nT3BlbkpQQUVudGl0eU1hbmFnZXJGYWN0b3J5OwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLnBlcnNpc3RlbmNlLk9wZW5KUEFFbnRpdHlNYW5hZ2VyRmFj\ndG9yeVNQSTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5j\nZS5PcGVuSlBBRW50aXR5TWFuYWdlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5wZXJzaXN0ZW5jZS5PcGVuSlBBUGVyc2lzdGVuY2U7CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuT3BlbkpQQVF1ZXJ5Owov\nL2ltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLkV4dGVudDsKaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5FeHRlbnQ7Cgov\nKioKICogPHA+VGVzdCBsYXJnZSByZXN1bHQsIHRvLW1hbnkgZWFnZXIgcGFn\naW5nLjwvcD4KICoKICovCnB1YmxpYyBjbGFzcyBUZXN0UGFnaW5nUmVzdWx0\nT2JqZWN0UHJvdmlkZXIKICAgIGV4dGVuZHMgVGVzdFNRTExpc3RlbmVyVGVz\ndENhc2UgewoKCXByaXZhdGUgT3BlbkpQQUVudGl0eU1hbmFnZXJGYWN0b3J5\nIGVtZjsKCglwdWJsaWMgVGVzdFBhZ2luZ1Jlc3VsdE9iamVjdFByb3ZpZGVy\nKFN0cmluZyBuYW1lKQoJewoJCXN1cGVyKG5hbWUpOwoJfQoKICAgIHB1Ymxp\nYyB2b2lkIHNldFVwKCkgdGhyb3dzIEV4Y2VwdGlvbnsKCQlzdXBlci5zZXRV\ncCgpOwoJCWVtZiA9IGdldEVtZihnZXRQcm9wcygpKTsKICAgIAlFbnRpdHlN\nYW5hZ2VyIGVtID1jdXJyZW50RW50aXR5TWFuYWdlcigpOwogICAgfQoKCgog\nICAgcHVibGljIGJvb2xlYW4gc2tpcFRlc3QoKSB7CiAgICAgICAgSkRCQ0Nv\nbmZpZ3VyYXRpb24gY29uZiA9IChKREJDQ29uZmlndXJhdGlvbikgKChPcGVu\nSlBBRW50aXR5TWFuYWdlckZhY3RvcnlTUEkpIE9wZW5KUEFQZXJzaXN0ZW5j\nZS5jYXN0KGVtZikpLmdldENvbmZpZ3VyYXRpb24oKTsKICAgICAgICBEQkRp\nY3Rpb25hcnkgZGljdCA9IGNvbmYuZ2V0REJEaWN0aW9uYXJ5SW5zdGFuY2Uo\nKTsKICAgICAgICBpZiAoZGljdC5qb2luU3ludGF4ID09IEpvaW4uU1lOVEFY\nX1RSQURJVElPTkFMKQogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKCiAgICAg\nICAgLy8gc2tpcCB0ZXN0IGNhc2UgdGhhdCByZXF1aXJlcyBzdWJzZWxlY3Qg\nZm9yIERCcyB0aGF0IGRvbid0IHN1cHBvcnQgaXQKICAgICAgICBpZiAoInRl\nc3RQYWdpbmdSYW5nZVF1ZXJ5Ii5lcXVhbHMoZ2V0TmFtZSgpKQogICAgICAg\nICAgICB8fCAidGVzdE5vblBhZ2luZ1JhbmdlUXVlcnkiLmVxdWFscyhnZXRO\nYW1lKCkpKSB7CiAgICAgICAgICAgIGlmICghY29uZi5nZXREQkRpY3Rpb25h\ncnlJbnN0YW5jZSgpLnN1cHBvcnRzU3Vic2VsZWN0KQogICAgICAgICAgICAg\nICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gZmFs\nc2U7CiAgICB9CgoKICAgIHB1YmxpYyB2b2lkIHRlc3ROb25QYWdpbmdFeHRl\nbnQoKSB7CiAgICAgICAgaW5pdGlhbGl6ZVBhZ2luZ1BDcygpOwoKICAgICAg\nICBFbnRpdHlNYW5hZ2VyIGVtPSBjdXJyZW50RW50aXR5TWFuYWdlcigpOwog\nICAgICAgIC8vRW50aXR5TWFuYWdlciBlbSA9Y3VycmVudEVudGl0eU1hbmFn\nZXIoKTsKICAgICAgICBPcGVuSlBBRW50aXR5TWFuYWdlciBrZW0gPSBPcGVu\nSlBBUGVyc2lzdGVuY2UuY2FzdCAoZW0pOwogICAgICAgIEV4dGVudCBleHRl\nbnQgPSBrZW0uY3JlYXRlRXh0ZW50KFBhZ2luZ1BDLmNsYXNzLCB0cnVlKTsK\nCiAgICAgICAgZXh0ZW50LmdldEZldGNoUGxhbigpLnNldEZldGNoQmF0Y2hT\naXplKDApOwogICAgICAgIGV4dGVudC5nZXRGZXRjaFBsYW4oKS5hZGRGZXRj\naEdyb3VwKCJyZWwiKTsKCiAgICAgICAgLy8gaWYgd2Ugb25seSBhY2Nlc3Mg\ndGhlIHJlbCBmaWVsZCwgd2Ugc2hvdWxkIG9ubHkgaGF2ZSB1c2VkIDEgc2Vs\nZWN0CiAgICAgICAgTGlzdCBsaXN0ID0gZXh0ZW50Lmxpc3QoKTsKICAgICAg\nICBhc3NlcnRFcXVhbHMoNCwgbGlzdC5zaXplKCkpOwogICAgICAgIGFzc2Vy\ndFJlbChsaXN0LCA0KTsKICAgICAgICBhc3NlcnRFcXVhbHMoc3FsLnRvU3Ry\naW5nKCksIDEsIHNxbC5zaXplKCkpOwogICAgICAgIHNxbC5jbGVhcigpOwoK\nICAgICAgICAvLyBub3cgYWNjZXNzaW5nIHRoZSByZWxzIGNvbGxlY3Rpb24g\nc2hvdWxkIGFkZCBzZWxlY3RzCiAgICAgICAgYXNzZXJ0UmVscyhsaXN0LCA0\nKTsKICAgICAgICBhc3NlcnRFcXVhbHMoc3FsLnRvU3RyaW5nKCksIDQsIHNx\nbC5zaXplKCkpOwogICAgICAgIHNxbC5jbGVhcigpOwoKICAgICAgICBlbS5j\nbG9zZSgpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHRlc3ROb25QYWdpbmdR\ndWVyeSgpCiAgICAgICAgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgaW5p\ndGlhbGl6ZVBhZ2luZ1BDcygpOwoKICAgICAgICBFbnRpdHlNYW5hZ2VyIGVt\nID1jdXJyZW50RW50aXR5TWFuYWdlcigpOwogICAgICAgIE9wZW5KUEFFbnRp\ndHlNYW5hZ2VyIGtlbSA9IE9wZW5KUEFQZXJzaXN0ZW5jZS5jYXN0KGVtKTsK\nCgkJU3RyaW5nIHRoZVF1ZXJ5PSJzZWxlY3QgYSBGUk9NICIrUGFnaW5nUEMu\nY2xhc3MuZ2V0U2ltcGxlTmFtZSgpKyIgYSB3aGVyZSBhLmludEZpZWxkID49\nIDAiOwoKICAgICAgICAvL09wZW5KUEFRdWVyeSBxID0ga2VtLmNyZWF0ZVF1\nZXJ5KFBhZ2luZ1BDLmNsYXNzLmdldFNpbXBsZU5hbWUoKSwgImludEZpZWxk\nID49IDAiKTsKICAgICAgICBPcGVuSlBBUXVlcnkgcSA9IGtlbS5jcmVhdGVR\ndWVyeSh0aGVRdWVyeSk7CgogICAgICAgIHEuZ2V0RmV0Y2hQbGFuKCkuc2V0\nRmV0Y2hCYXRjaFNpemUoMCk7CiAgICAgICAgcS5nZXRGZXRjaFBsYW4oKS5h\nZGRGZXRjaEdyb3VwcygicmVsIik7CgogICAgICAgIC8vIGlmIHdlIG9ubHkg\nYWNjZXNzIHRoZSByZWwgZmllbGQsIHdlIHNob3VsZCBvbmx5IGhhdmUgdXNl\nZCB0d28KICAgICAgICAvLyBzZWxlY3RzOiBvbmUgZm9yIHRoZSBxdWVyeSBh\nbmQgb25lIGZvciB0aGUgc2l6ZQogICAgICAgIExpc3QgbGlzdCA9IChMaXN0\nKSBxLmdldFJlc3VsdExpc3QoKTsKICAgICAgICBhc3NlcnRFcXVhbHMoNCwg\nbGlzdC5zaXplKCkpOwogICAgICAgIGFzc2VydFJlbChsaXN0LCA0KTsKICAg\nICAgICBhc3NlcnRFcXVhbHMoc3FsLnRvU3RyaW5nKCksIDIsIHNxbC5zaXpl\nKCkpOwogICAgICAgIGFzc2VydFRydWUoKFN0cmluZykgc3FsLmdldCgwKSwK\nICAgICAgICAgICAgbWF0Y2hlcygiID49ICIsIChTdHJpbmcpIHNxbC5nZXQo\nMCkpKTsKICAgICAgICBhc3NlcnRUcnVlKChTdHJpbmcpIHNxbC5nZXQoMSks\nCiAgICAgICAgICAgIG1hdGNoZXMoIiBDT1VOVCIsIChTdHJpbmcpIHNxbC5n\nZXQoMSkpKTsKICAgICAgICBzcWwuY2xlYXIoKTsKCiAgICAgICAgLy8gbm93\nIGFjY2Vzc2luZyB0aGUgcmVscyBjb2xsZWN0aW9uIHNob3VsZCBhZGQgc2Vs\nZWN0cwogICAgICAgIGFzc2VydFJlbHMobGlzdCwgNCk7CiAgICAgICAgYXNz\nZXJ0RXF1YWxzKHNxbC50b1N0cmluZygpLCA0LCBzcWwuc2l6ZSgpKTsKICAg\nICAgICBzcWwuY2xlYXIoKTsKCiAgICAgICAgZW0uY2xvc2UoKTsKICAgIH0K\nCiAgICAvKioKICAgICAqIENoZWNrIHRoYXQgdGhlIHJlbCBmaWVsZCB3YXMg\ncmV0cmlldmVkIGNvcnJlY3RseS4KICAgICAqLwogICBwcml2YXRlIHZvaWQg\nYXNzZXJ0UmVsKExpc3QgcGNzLCBpbnQgc2l6ZSkgewogICAgICAgIFBhZ2lu\nZ1BDIHBjOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgc2l6ZTsgaSsr\nKSB7CiAgICAgICAgICAgIHBjID0gKFBhZ2luZ1BDKSBwY3MuZ2V0KGkpOwog\nICAgICAgICAgICBhc3NlcnROb3ROdWxsKHBjLmdldFJlbCgpKTsKICAgICAg\nICAgICAgYXNzZXJ0RXF1YWxzKHBjLmdldEludEZpZWxkKCkgKyAxLCBwYy5n\nZXRSZWwoKS5nZXRJbnRGaWVsZCgpKTsKICAgICAgICB9CiAgICAgICAgdHJ5\nIHsKICAgICAgICAgICAgcGNzLmdldChzaXplICsgMSk7CiAgICAgICAgICAg\nIGZhaWwoIlJldHJpZXZlZCBwYXN0IGVuZCBvZiBsaXN0Iik7CiAgICAgICAg\nfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICB9CiAgICB9CgogICAg\nLyoqCiAgICAgKiBDaGVjayB0aGF0IHRoZSByZWxzIGZpZWxkIHdhcyByZXRy\naWV2ZWQgY29ycmVjdGx5LgogICAgICovCiAgICBwcml2YXRlIHZvaWQgYXNz\nZXJ0UmVscyhMaXN0IHBjcywgaW50IHNpemUpIHsKICAgICAgICBQYWdpbmdQ\nQyBwYzsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IHNpemU7IGkrKykg\newogICAgICAgICAgICBwYyA9IChQYWdpbmdQQykgcGNzLmdldChpKTsKICAg\nICAgICAgICAgYXNzZXJ0RXF1YWxzKDIsIHBjLmdldFJlbHMoKS5zaXplKCkp\nOwogICAgICAgICAgICBhc3NlcnRFcXVhbHMocGMuZ2V0SW50RmllbGQoKSAr\nIDEsICgoUGFnaW5nSGVscGVyUEMpCiAgICAgICAgICAgICAgICBwYy5nZXRS\nZWxzKCkuZ2V0KDApKS5nZXRJbnRGaWVsZCgpKTsKICAgICAgICAgICAgYXNz\nZXJ0RXF1YWxzKHBjLmdldEludEZpZWxkKCkgKyAyLCAoKFBhZ2luZ0hlbHBl\nclBDKQogICAgICAgICAgICAgICAgcGMuZ2V0UmVscygpLmdldCgxKSkuZ2V0\nSW50RmllbGQoKSk7CiAgICAgICAgfQogICAgICAgIHRyeSB7CiAgICAgICAg\nICAgIHBjcy5nZXQoc2l6ZSArIDEpOwogICAgICAgICAgICBmYWlsKCJSZXRy\naWV2ZWQgcGFzdCBlbmQgb2YgbGlzdCIpOwogICAgICAgIH0gY2F0Y2ggKEV4\nY2VwdGlvbiBlKSB7CiAgICAgICAgfQogICAgfQoKICAgIHB1YmxpYyB2b2lk\nIHRlc3RQYWdpbmdFeHRlbnQoKQogICAgICAgIHRocm93cyBFeGNlcHRpb24g\newogICAgICAgIGluaXRpYWxpemVQYWdpbmdQQ3MoKTsKCiAgICAgICAgRW50\naXR5TWFuYWdlciBlbSA9Y3VycmVudEVudGl0eU1hbmFnZXIoKTsKICAgICAg\nICBPcGVuSlBBRW50aXR5TWFuYWdlciBrZW0gPSBPcGVuSlBBUGVyc2lzdGVu\nY2UuY2FzdCAoZW0pOwogICAgICAgIEV4dGVudCBleHRlbnQgPSBrZW0uY3Jl\nYXRlRXh0ZW50KFBhZ2luZ1BDLmNsYXNzLCB0cnVlKTsKICAgICAgICBleHRl\nbnQuZ2V0RmV0Y2hQbGFuKCkuc2V0RmV0Y2hCYXRjaFNpemUoMCk7CiAgICAg\nICAgZXh0ZW50LmdldEZldGNoUGxhbigpLmFkZEZldGNoR3JvdXAoInJlbCIp\nOwogICAgICAgIGV4dGVudC5nZXRGZXRjaFBsYW4oKS5hZGRGZXRjaEdyb3Vw\nKCJyZWxzIik7CgoKICAgICAgICAvLyB3ZSBzaG91bGQgZ2V0IHR3byBzZWxl\nY3RzOiB0aGUgaW5pdGlhbCBzZWxlY3QgYW5kIHRoZSBJTiBlYWdlciBzdG1u\ndAogICAgICAgIExpc3QgbGlzdCA9IGV4dGVudC5saXN0KCk7CiAgICAgICAg\nYXNzZXJ0RXF1YWxzKDQsIGxpc3Quc2l6ZSgpKTsKICAgICAgICBhc3NlcnRS\nZWwobGlzdCwgNCk7CiAgICAgICAgYXNzZXJ0UmVscyhsaXN0LCA0KTsKICAg\nICAgICBhc3NlcnRFcXVhbHMoc3FsLnRvU3RyaW5nKCksIDIsIHNxbC5zaXpl\nKCkpOwogICAgICAgIGFzc2VydFRydWUoKFN0cmluZykgc3FsLmdldCgxKSwK\nICAgICAgICAgICAgbWF0Y2hlcygiIElOICIsIChTdHJpbmcpIHNxbC5nZXQo\nMSkpKTsKICAgICAgICBzcWwuY2xlYXIoKTsKCiAgICAgICAgZW0uY2xvc2Uo\nKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCB0ZXN0UGFnaW5nUXVlcnkoKQog\nICAgICAgIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIGluaXRpYWxpemVQ\nYWdpbmdQQ3MoKTsKCgogICAgICAgIEVudGl0eU1hbmFnZXIgZW0gPWN1cnJl\nbnRFbnRpdHlNYW5hZ2VyKCk7CiAgICAgICAgT3BlbkpQQUVudGl0eU1hbmFn\nZXIga2VtID0gT3BlbkpQQVBlcnNpc3RlbmNlLmNhc3QgKGVtKTsKCgkJU3Ry\naW5nIHRoZVF1ZXJ5PSJzZWxlY3QgYSBGUk9NICIrUGFnaW5nUEMuY2xhc3Mu\nZ2V0U2ltcGxlTmFtZSgpKyIgYSB3aGVyZSBhLmludEZpZWxkID49IDAiOwog\nICAgICAgIE9wZW5KUEFRdWVyeSBxID0ga2VtLmNyZWF0ZVF1ZXJ5KHRoZVF1\nZXJ5KTsKICAgICAgICBxLmdldEZldGNoUGxhbigpLnNldEZldGNoQmF0Y2hT\naXplKDApOwogICAgICAgIHEuZ2V0RmV0Y2hQbGFuKCkuYWRkRmV0Y2hHcm91\ncHMoInJlbCIpOwogICAgICAgIHEuZ2V0RmV0Y2hQbGFuKCkuYWRkRmV0Y2hH\ncm91cHMoInJlbHMiKTsKCgogICAgICAgIC8vIHdlIHNob3VsZCBnZXQgdGhy\nZWUgc2VsZWN0czogdGhlIGluaXRpYWwgc2VsZWN0LCB0aGUgQ09VTlQgZm9y\nIHRoZQogICAgICAgIC8vIHNpemUsIGFuZCB0aGUgSU4gZWFnZXIgc3RtbnQK\nICAgICAgICBMaXN0IGxpc3QgPSAoTGlzdCkgcS5nZXRSZXN1bHRMaXN0KCk7\nCiAgICAgICAgYXNzZXJ0RXF1YWxzKDQsIGxpc3Quc2l6ZSgpKTsKICAgICAg\nICBhc3NlcnRSZWwobGlzdCwgNCk7CiAgICAgICAgYXNzZXJ0UmVscyhsaXN0\nLCA0KTsKICAgICAgICBhc3NlcnRFcXVhbHMoc3FsLnRvU3RyaW5nKCksIDMs\nIHNxbC5zaXplKCkpOwogICAgICAgIGFzc2VydFRydWUoKFN0cmluZykgc3Fs\nLmdldCgwKSwKICAgICAgICAgICAgbWF0Y2hlcygiID49ICIsIChTdHJpbmcp\nIHNxbC5nZXQoMCkpKTsKICAgICAgICBhc3NlcnRUcnVlKChTdHJpbmcpIHNx\nbC5nZXQoMSksCiAgICAgICAgICAgIG1hdGNoZXMoIiBDT1VOVCIsIChTdHJp\nbmcpIHNxbC5nZXQoMSkpKTsKICAgICAgICBhc3NlcnRUcnVlKChTdHJpbmcp\nIHNxbC5nZXQoMiksCiAgICAgICAgICAgIG1hdGNoZXMoIiBJTiAiLCAoU3Ry\naW5nKSBzcWwuZ2V0KDIpKSk7CiAgICAgICAgYXNzZXJ0RmFsc2UoKFN0cmlu\nZykgc3FsLmdldCgyKSwKICAgICAgICAgICAgbWF0Y2hlcygiID49ICIsIChT\ndHJpbmcpIHNxbC5nZXQoMikpKTsKICAgICAgICBzcWwuY2xlYXIoKTsKCiAg\nICAgICAgLy8gaWYgd2UgZXhlY3V0ZSBhbmQgdHJhdmVyc2UgYSByZXN1bHQg\nYmVmb3JlIGdldHRpbmcgdGhlIHNpemUsIHdlCiAgICAgICAgLy8gc2hvdWxk\nIG9ubHkgZ2V0IDIgc2VsZWN0cywgc2luY2UgdGhlIGNhY2hpbmcgb2YgdGhl\nIHBhZ2Ugc2hvdWxkCiAgICAgICAgLy8gcmVhY2ggdGhlIGVuZCBvZiB0aGUg\nbGlzdCBhbmQgdGhlcmVmb3JlIGtub3cgdGhlIHRvdGFsIHNpemUKICAgICAg\nICBsaXN0ID0gKExpc3QpIHEuZ2V0UmVzdWx0TGlzdCgpOwogICAgICAgIGxp\nc3QuZ2V0KDApOwogICAgICAgIGFzc2VydEVxdWFscyg0LCBsaXN0LnNpemUo\nKSk7CiAgICAgICAgYXNzZXJ0UmVsKGxpc3QsIDQpOwogICAgICAgIGFzc2Vy\ndFJlbHMobGlzdCwgNCk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKHNxbC50b1N0\ncmluZygpLCAyLCBzcWwuc2l6ZSgpKTsKICAgICAgICBhc3NlcnRUcnVlKChT\ndHJpbmcpIHNxbC5nZXQoMSksCiAgICAgICAgICAgIG1hdGNoZXMoIiBJTiAi\nLCAoU3RyaW5nKSBzcWwuZ2V0KDEpKSk7CiAgICAgICAgc3FsLmNsZWFyKCk7\nCgogICAgICAgIGVtLmNsb3NlKCk7CiAgICB9CgogICAgcHVibGljIHZvaWQg\ndGVzdFBhZ2luZ0FwcElkRXh0ZW50KCkKICAgICAgICB0aHJvd3MgRXhjZXB0\naW9uIHsKICAgICAgICBpbml0aWFsaXplUGFnaW5nQXBwSWRQQ3MoKTsKCiAg\nICAgICAgRW50aXR5TWFuYWdlciBlbSA9Y3VycmVudEVudGl0eU1hbmFnZXIo\nKTsKICAgICAgICBPcGVuSlBBRW50aXR5TWFuYWdlciBrZW0gPSBPcGVuSlBB\nUGVyc2lzdGVuY2UuY2FzdCAoZW0pOwogICAgICAgIEV4dGVudCBleHRlbnQg\nPSBrZW0uY3JlYXRlRXh0ZW50KFBhZ2luZ0FwcElkUEMuY2xhc3MsIHRydWUp\nOwoKICAgICAgICBleHRlbnQuZ2V0RmV0Y2hQbGFuKCkuc2V0RmV0Y2hCYXRj\naFNpemUoMCk7CiAgICAgICAgZXh0ZW50LmdldEZldGNoUGxhbigpLmFkZEZl\ndGNoR3JvdXAoInJlbCIpOwogICAgICAgIGV4dGVudC5nZXRGZXRjaFBsYW4o\nKS5hZGRGZXRjaEdyb3VwKCJyZWxzIik7CgogICAgICAgIC8vIHdlIHNob3Vs\nZCBnZXQgdHdvIHNlbGVjdHM6IHRoZSBpbml0aWFsIHNlbGVjdCBhbmQgdGhl\nIElOIGVhZ2VyIHN0bW50CiAgICAgICAgTGlzdCBsaXN0ID0gZXh0ZW50Lmxp\nc3QoKTsKICAgICAgICBhc3NlcnRFcXVhbHMoNCwgbGlzdC5zaXplKCkpOwog\nICAgICAgIGFzc2VydEFwcElkUmVsKGxpc3QsIDQpOwogICAgICAgIGFzc2Vy\ndEFwcElkUmVscyhsaXN0LCA0KTsKICAgICAgICBhc3NlcnRFcXVhbHMoc3Fs\nLnRvU3RyaW5nKCksIDIsIHNxbC5zaXplKCkpOwogICAgICAgIGFzc2VydFRy\ndWUoKFN0cmluZykgc3FsLmdldCgxKSwKICAgICAgICAgICAgbWF0Y2hlcygi\nIE9SICIsIChTdHJpbmcpIHNxbC5nZXQoMSkpKTsKICAgICAgICBzcWwuY2xl\nYXIoKTsKCiAgICAgICAgZW0uY2xvc2UoKTsKICAgIH0KCiAgICBwdWJsaWMg\ndm9pZCB0ZXN0UGFnaW5nQXBwSWRRdWVyeSgpCiAgICAgICAgdGhyb3dzIEV4\nY2VwdGlvbiB7CiAgICAgICAgaW5pdGlhbGl6ZVBhZ2luZ0FwcElkUENzKCk7\nCgogICAgICAgIEVudGl0eU1hbmFnZXIgZW0gPWN1cnJlbnRFbnRpdHlNYW5h\nZ2VyKCk7CiAgICAgICAgT3BlbkpQQUVudGl0eU1hbmFnZXIga2VtID0gT3Bl\nbkpQQVBlcnNpc3RlbmNlLmNhc3QoZW0pOwoKCQlTdHJpbmcgdGhlUXVlcnk9\nInNlbGVjdCBhIEZST00gIitQYWdpbmdBcHBJZFBDLmNsYXNzLmdldFNpbXBs\nZU5hbWUoKSsiIGEgd2hlcmUgYS5pbnRGaWVsZCA+PSAwIjsKICAgICAgICBP\ncGVuSlBBUXVlcnkgcSA9IGtlbS5jcmVhdGVRdWVyeSh0aGVRdWVyeSk7CgoK\nICAgICAgICBxLmdldEZldGNoUGxhbigpLnNldEZldGNoQmF0Y2hTaXplKDAp\nOwogICAgICAgIHEuZ2V0RmV0Y2hQbGFuKCkuYWRkRmV0Y2hHcm91cHMoInJl\nbCIpOwogICAgICAgIHEuZ2V0RmV0Y2hQbGFuKCkuYWRkRmV0Y2hHcm91cHMo\nInJlbHMiKTsKCiAgICAgICAgLy8gd2Ugc2hvdWxkIGdldCB0aHJlZSBzZWxl\nY3RzOiB0aGUgaW5pdGlhbCBzZWxlY3QsIHRoZSBDT1VOVCBmb3IgdGhlCiAg\nICAgICAgLy8gc2l6ZSwgYW5kIHRoZSBPUiBlYWdlciBzdG1udAogICAgICAg\nIExpc3QgbGlzdCA9IChMaXN0KSBxLmdldFJlc3VsdExpc3QoKTsKICAgICAg\nICBhc3NlcnRFcXVhbHMoNCwgbGlzdC5zaXplKCkpOwogICAgICAgIGFzc2Vy\ndEFwcElkUmVsKGxpc3QsIDQpOwogICAgICAgIGFzc2VydEFwcElkUmVscyhs\naXN0LCA0KTsKICAgICAgICBhc3NlcnRFcXVhbHMoc3FsLnRvU3RyaW5nKCks\nIDMsIHNxbC5zaXplKCkpOwogICAgICAgIGFzc2VydFRydWUoKFN0cmluZykg\nc3FsLmdldCgwKSwKICAgICAgICAgICAgbWF0Y2hlcygiID49ICIsIChTdHJp\nbmcpIHNxbC5nZXQoMCkpKTsKICAgICAgICBhc3NlcnRUcnVlKChTdHJpbmcp\nIHNxbC5nZXQoMSksCiAgICAgICAgICAgIG1hdGNoZXMoIiBDT1VOVCIsIChT\ndHJpbmcpIHNxbC5nZXQoMSkpKTsKICAgICAgICBhc3NlcnRUcnVlKChTdHJp\nbmcpIHNxbC5nZXQoMiksCiAgICAgICAgICAgIG1hdGNoZXMoIiBPUiAiLCAo\nU3RyaW5nKSBzcWwuZ2V0KDIpKSk7CiAgICAgICAgYXNzZXJ0RmFsc2UoKFN0\ncmluZykgc3FsLmdldCgyKSwKICAgICAgICAgICAgbWF0Y2hlcygiID49ICIs\nIChTdHJpbmcpIHNxbC5nZXQoMikpKTsKICAgICAgICBzcWwuY2xlYXIoKTsK\nCiAgICAgICAgZW0uY2xvc2UoKTsKICAgIH0KCiAgICAvKioKICAgICAqIENo\nZWNrIHRoYXQgdGhlIHJlbCBmaWVsZCB3YXMgcmV0cmlldmVkIGNvcnJlY3Rs\neS4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIGFzc2VydEFwcElkUmVsKExp\nc3QgcGNzLCBpbnQgc2l6ZSkgewogICAgICAgIFBhZ2luZ0FwcElkUEMgcGM7\nCiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBzaXplOyBpKyspIHsKICAg\nICAgICAgICAgcGMgPSAoUGFnaW5nQXBwSWRQQykgcGNzLmdldChpKTsKICAg\nICAgICAgICAgYXNzZXJ0Tm90TnVsbChwYy5nZXRSZWwoKSk7CiAgICAgICAg\nICAgIGFzc2VydEVxdWFscyhwYy5nZXRJbnRGaWVsZCgpICsgMSwgcGMuZ2V0\nUmVsKCkuZ2V0SW50RmllbGQoKSk7CiAgICAgICAgfQogICAgICAgIHRyeSB7\nCiAgICAgICAgICAgIHBjcy5nZXQoc2l6ZSArIDEpOwogICAgICAgICAgICBm\nYWlsKCJSZXRyaWV2ZWQgcGFzdCBlbmQgb2YgbGlzdCIpOwogICAgICAgIH0g\nY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgfQogICAgfQoKICAgIC8q\nKgogICAgICogQ2hlY2sgdGhhdCB0aGUgcmVscyBmaWVsZCB3YXMgcmV0cmll\ndmVkIGNvcnJlY3RseS4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIGFzc2Vy\ndEFwcElkUmVscyhMaXN0IHBjcywgaW50IHNpemUpIHsKICAgICAgICBQYWdp\nbmdBcHBJZFBDIHBjOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgc2l6\nZTsgaSsrKSB7CiAgICAgICAgICAgIHBjID0gKFBhZ2luZ0FwcElkUEMpIHBj\ncy5nZXQoaSk7CiAgICAgICAgICAgIGFzc2VydEVxdWFscygyLCBwYy5nZXRS\nZWxzKCkuc2l6ZSgpKTsKICAgICAgICAgICAgYXNzZXJ0RXF1YWxzKHBjLmdl\ndEludEZpZWxkKCkgKyAxLCAoKFBhZ2luZ0hlbHBlclBDKQogICAgICAgICAg\nICAgICAgcGMuZ2V0UmVscygpLmdldCgwKSkuZ2V0SW50RmllbGQoKSk7CiAg\nICAgICAgICAgIGFzc2VydEVxdWFscyhwYy5nZXRJbnRGaWVsZCgpICsgMiwg\nKChQYWdpbmdIZWxwZXJQQykKICAgICAgICAgICAgICAgIHBjLmdldFJlbHMo\nKS5nZXQoMSkpLmdldEludEZpZWxkKCkpOwogICAgICAgIH0KICAgICAgICB0\ncnkgewogICAgICAgICAgICBwY3MuZ2V0KHNpemUgKyAxKTsKICAgICAgICAg\nICAgZmFpbCgiUmV0cmlldmVkIHBhc3QgZW5kIG9mIGxpc3QiKTsKICAgICAg\nICB9IGNhdGNoIChFeGNlcHRpb24gZSkgewogICAgICAgIH0KICAgIH0KCiAg\nICBwdWJsaWMgdm9pZCB0ZXN0TXVsdGlQYWdlRXh0ZW50KCkKICAgICAgICB0\naHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBpbml0aWFsaXplUGFnaW5nUENz\nKCk7CgogICAgICAgIEVudGl0eU1hbmFnZXIgZW0gPWN1cnJlbnRFbnRpdHlN\nYW5hZ2VyKCk7CiAgICAgICAgT3BlbkpQQUVudGl0eU1hbmFnZXIga2VtID0g\nT3BlbkpQQVBlcnNpc3RlbmNlLmNhc3QoZW0pOwogICAgICAgIEV4dGVudCBl\neHRlbnQgPSBrZW0uY3JlYXRlRXh0ZW50KFBhZ2luZ1BDLmNsYXNzLCB0cnVl\nKTsKCiAgICAgICAgZXh0ZW50LmdldEZldGNoUGxhbigpLnNldEZldGNoQmF0\nY2hTaXplKDIpOyAgICAvLyAyIHBhZ2VzIG9mIDIKICAgICAgICBleHRlbnQu\nZ2V0RmV0Y2hQbGFuKCkuYWRkRmV0Y2hHcm91cCgicmVsIik7CiAgICAgICAg\nZXh0ZW50LmdldEZldGNoUGxhbigpLmFkZEZldGNoR3JvdXAoInJlbHMiKTsK\nCiAgICAgICAgLy8gd2Ugc2hvdWxkIGdldCB0d28gc2VsZWN0czogdGhlIGlu\naXRpYWwgc2VsZWN0IGFuZCB0aGUgSU4gZWFnZXIgc3RtbnQKICAgICAgICBM\naXN0IGxpc3QgPSBleHRlbnQubGlzdCgpOwogICAgICAgIGFzc2VydEVxdWFs\ncyhsaXN0LnRvU3RyaW5nKCksIDQsIGxpc3Quc2l6ZSgpKTsKICAgICAgICBh\nc3NlcnRSZWwobGlzdCwgNCk7CiAgICAgICAgYXNzZXJ0UmVscyhsaXN0LCA0\nKTsKICAgICAgICBhc3NlcnRFcXVhbHMoc3FsLnRvU3RyaW5nKCksIDMsIHNx\nbC5zaXplKCkpOwogICAgICAgIGFzc2VydFRydWUoKFN0cmluZykgc3FsLmdl\ndCgxKSwKICAgICAgICAgICAgbWF0Y2hlcygiIElOICIsIChTdHJpbmcpIHNx\nbC5nZXQoMSkpKTsKICAgICAgICBhc3NlcnRUcnVlKChTdHJpbmcpIHNxbC5n\nZXQoMiksCiAgICAgICAgICAgIG1hdGNoZXMoIiBJTiAiLCAoU3RyaW5nKSBz\ncWwuZ2V0KDIpKSk7CiAgICAgICAgc3FsLmNsZWFyKCk7CgogICAgICAgIGVt\nLmNsb3NlKCk7CiAgICB9CgogICAgcHVibGljIHZvaWQgdGVzdE11bHRpUGFn\nZVF1ZXJ5KCkKICAgICAgICB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBp\nbml0aWFsaXplUGFnaW5nUENzKCk7CgogICAgICAgIEVudGl0eU1hbmFnZXIg\nZW0gPWN1cnJlbnRFbnRpdHlNYW5hZ2VyKCk7CiAgICAgICAgT3BlbkpQQUVu\ndGl0eU1hbmFnZXIga2VtID0gT3BlbkpQQVBlcnNpc3RlbmNlLmNhc3QoZW0p\nOwoKCQlTdHJpbmcgdGhlUXVlcnk9InNlbGVjdCBhIEZST00gIitQYWdpbmdQ\nQy5jbGFzcy5nZXRTaW1wbGVOYW1lKCkrIiBhIHdoZXJlIGEuaW50RmllbGQg\nPj0gMCI7CiAgICAgICAgT3BlbkpQQVF1ZXJ5IHEgPSBrZW0uY3JlYXRlUXVl\ncnkodGhlUXVlcnkpOwoKCgkJLy9GSVhNRSBqdGhvbWFzIGNvbW1lbnRpbmcg\ndGlsbCB3ZSBmaW5kIGhvdyBvcmRlcmluZyBjYW4gYmUgZG9uZQogICAgICAg\nIC8vcS5zZXRPcmRlcmluZygiaW50RmllbGQgYXNjZW5kaW5nIik7CiAgICAg\nICAgcS5nZXRGZXRjaFBsYW4oKS5zZXRGZXRjaEJhdGNoU2l6ZSgyKTsgICAg\nLy8gMiBwYWdlcyBvZiAyCiAgICAgICAgcS5nZXRGZXRjaFBsYW4oKS5hZGRG\nZXRjaEdyb3VwKCJyZWwiKTsKICAgICAgICBxLmdldEZldGNoUGxhbigpLmFk\nZEZldGNoR3JvdXAoInJlbHMiKTsKCiAgICAgICAgLy8gd2Ugc2hvdWxkIGdl\ndCBmb3VyIHNlbGVjdHM6IHRoZSBpbml0aWFsIHNlbGVjdCwgdGhlIGNvdW50\nLCBhbmQgdGhlCiAgICAgICAgLy8gdHdvIElOIGVhZ2VyIHN0bW50cwogICAg\nICAgIExpc3QgbGlzdCA9IChMaXN0KSBxLmdldFJlc3VsdExpc3QoKTsKICAg\nICAgICBhc3NlcnRFcXVhbHMobGlzdC50b1N0cmluZygpLCA0LCBsaXN0LnNp\nemUoKSk7CiAgICAgICAgLy8gc28gd2UgZG9uJ3QgaGF2ZSB0byByZS1leGVj\ndXRlIHRvIG1vdmUgYmFjayB0byBiZWdpbm5pbmcKICAgICAgICBsaXN0ID0g\nbmV3IEFycmF5TGlzdChsaXN0KTsKICAgICAgICBhc3NlcnRSZWwobGlzdCwg\nNCk7CiAgICAgICAgYXNzZXJ0UmVscyhsaXN0LCA0KTsKCiAgICAgICAgYXNz\nZXJ0RXF1YWxzKHNxbC50b1N0cmluZygpLCA0LCBzcWwuc2l6ZSgpKTsKICAg\nICAgICBhc3NlcnRUcnVlKChTdHJpbmcpIHNxbC5nZXQoMSksCiAgICAgICAg\nICAgIG1hdGNoZXMoIiBDT1VOVCIsIChTdHJpbmcpIHNxbC5nZXQoMSkpKTsK\nICAgICAgICBhc3NlcnRUcnVlKChTdHJpbmcpIHNxbC5nZXQoMiksCiAgICAg\nICAgICAgIG1hdGNoZXMoIiBJTiAiLCAoU3RyaW5nKSBzcWwuZ2V0KDIpKSk7\nCiAgICAgICAgYXNzZXJ0VHJ1ZSgoU3RyaW5nKSBzcWwuZ2V0KDMpLAogICAg\nICAgICAgICBtYXRjaGVzKCIgSU4gIiwgKFN0cmluZykgc3FsLmdldCgzKSkp\nOwogICAgICAgIHNxbC5jbGVhcigpOwoKICAgICAgICAvLyBpZiB3ZSBhY2Nl\nc3MgYSByZXN1bHQgb2JqZWN0IG9uIHRoZSBzZWNvbmQgcGFnZSwgd2Ugc2hv\ndWxkIGdldCBvbmx5CiAgICAgICAgLy8gdGhyZWUgc2VsZWN0czogdGhlIGlu\naXRpYWwgc2VsZWN0LCB0aGUgY291bnQsIGFuZCB0aGUgSU4gZWFnZXIgc3Rt\nbnQKICAgICAgICAvLyBmb3IgcGFnZSAyCiAgICAgICAgbGlzdCA9IChMaXN0\nKSBxLmdldFJlc3VsdExpc3QoKTsKICAgICAgICBhc3NlcnRFcXVhbHMobGlz\ndC50b1N0cmluZygpLCA0LCBsaXN0LnNpemUoKSk7CiAgICAgICAgUGFnaW5n\nUEMgcGMgPSAoUGFnaW5nUEMpIGxpc3QuZ2V0KDIpOwogICAgICAgIGFzc2Vy\ndEVxdWFscygyLCBwYy5nZXRJbnRGaWVsZCgpKTsKICAgICAgICBhc3NlcnRF\ncXVhbHMoc3FsLnRvU3RyaW5nKCksIDMsIHNxbC5zaXplKCkpOwogICAgICAg\nIGFzc2VydFRydWUoKFN0cmluZykgc3FsLmdldCgyKSwKICAgICAgICAgICAg\nbWF0Y2hlcygiIElOIiwgKFN0cmluZykgc3FsLmdldCgyKSkpOwoKICAgICAg\nICBhc3NlcnRSZWwobGlzdCwgNCk7CiAgICAgICAgYXNzZXJ0UmVscyhsaXN0\nLCA0KTsKICAgICAgICBzcWwuY2xlYXIoKTsKCiAgICAgICAgZW0uY2xvc2Uo\nKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCB0ZXN0TGFzdFBhZ2VRdWVyeSgp\nCiAgICAgICAgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgaW5pdGlhbGl6\nZVBhZ2luZ1BDcygpOwoKICAgICAgICBFbnRpdHlNYW5hZ2VyIGVtID1jdXJy\nZW50RW50aXR5TWFuYWdlcigpOwogICAgICAgIE9wZW5KUEFFbnRpdHlNYW5h\nZ2VyIGtlbSA9IE9wZW5KUEFQZXJzaXN0ZW5jZS5jYXN0KGVtKTsKCgkJU3Ry\naW5nIHRoZVF1ZXJ5PSJzZWxlY3QgYSBGUk9NICIrUGFnaW5nUEMuY2xhc3Mu\nZ2V0U2ltcGxlTmFtZSgpKyIgYSB3aGVyZSBhLmludEZpZWxkID49IDAiOwog\nICAgICAgIE9wZW5KUEFRdWVyeSBxID0ga2VtLmNyZWF0ZVF1ZXJ5KHRoZVF1\nZXJ5KTsKCgogICAgICAgIC8vRklYTUUganRob21hcyBjb21tZW50aW5nIHRp\nbGwgd2UgZmluZCBob3cgb3JkZXJpbmcgY2FuIGJlIGRvbmUKICAgICAgICAv\nL3Euc2V0T3JkZXJpbmcoImludEZpZWxkIGFzY2VuZGluZyIpOwogICAgICAg\nIHEuZ2V0RmV0Y2hQbGFuKCkuc2V0RmV0Y2hCYXRjaFNpemUoMyk7ICAgIC8v\nIDEgb24gcGFnZSAyCiAgICAgICAgcS5nZXRGZXRjaFBsYW4oKS5hZGRGZXRj\naEdyb3VwcygicmVsIik7CiAgICAgICAgcS5nZXRGZXRjaFBsYW4oKS5hZGRG\nZXRjaEdyb3VwcygicmVscyIpOwoKICAgICAgICAvLyBpZiB3ZSBhY2Nlc3Mg\nYSByZXN1bHQgb2JqZWN0IG9uIHRoZSBzZWNvbmQgcGFnZSwgd2Ugc2hvdWxk\nIGdldCBvbmx5CiAgICAgICAgLy8gdHdvIHNlbGVjdHM6IHRoZSBpbml0aWFs\nIHNlbGVjdCBhbmQgdGhlIGVhZ2VyIHN0bW50IGZvciBwYWdlCiAgICAgICAg\nTGlzdCBsaXN0ID0gKExpc3QpIHEuZ2V0UmVzdWx0TGlzdCgpOwogICAgICAg\nIFBhZ2luZ1BDIHBjID0gKFBhZ2luZ1BDKSBsaXN0LmdldCgzKTsKICAgICAg\nICBhc3NlcnRFcXVhbHMoMywgcGMuZ2V0SW50RmllbGQoKSk7CiAgICAgICAg\nYXNzZXJ0RXF1YWxzKGxpc3QudG9TdHJpbmcoKSwgNCwgbGlzdC5zaXplKCkp\nOwogICAgICAgIGFzc2VydEVxdWFscyhzcWwudG9TdHJpbmcoKSwgMiwgc3Fs\nLnNpemUoKSk7CiAgICAgICAgLy8gZm9yIHNpbmdsZSByZXN1bHQsIHNob3Vs\nZCB1c2Ugc3RhbmRhcmQgc2VsZWN0LCBub3QgSU4KICAgICAgICBhc3NlcnRG\nYWxzZSgoU3RyaW5nKSBzcWwuZ2V0KDEpLAogICAgICAgICAgICBtYXRjaGVz\nKCIgSU4gIiwgKFN0cmluZykgc3FsLmdldCgxKSkpOwogICAgICAgIHNxbC5j\nbGVhcigpOwoKICAgICAgICBlbS5jbG9zZSgpOwogICAgfQoKICAgIHB1Ymxp\nYyB2b2lkIHRlc3RTaW5nbGVSZXN1bHRQYWdlKCkKICAgICAgICB0aHJvd3Mg\nRXhjZXB0aW9uIHsKICAgICAgICBpbml0aWFsaXplUGFnaW5nUENzKCk7CgoJ\nICAgIEVudGl0eU1hbmFnZXIgZW0gPWN1cnJlbnRFbnRpdHlNYW5hZ2VyKCk7\nCiAgICAgICAgT3BlbkpQQUVudGl0eU1hbmFnZXIga2VtID0gT3BlbkpQQVBl\ncnNpc3RlbmNlLmNhc3QgKGVtKTsKICAgICAgICBFeHRlbnQgZXh0ZW50ID0g\na2VtLmNyZWF0ZUV4dGVudChQYWdpbmdQQy5jbGFzcywgdHJ1ZSk7CiAgICAg\nICAgZXh0ZW50LmdldEZldGNoUGxhbigpLnNldEZldGNoQmF0Y2hTaXplKDMp\nOyAgICAvLyAxIG9uIHBhZ2UgMgogICAgICAgIGV4dGVudC5nZXRGZXRjaFBs\nYW4oKS5hZGRGZXRjaEdyb3VwKCJyZWwiKTsKICAgICAgICBleHRlbnQuZ2V0\nRmV0Y2hQbGFuKCkuYWRkRmV0Y2hHcm91cCgicmVscyIpOwoKICAgICAgICAv\nLyB3ZSBzaG91bGQgZ2V0IHR3byBzZWxlY3RzOiB0aGUgaW5pdGlhbCBzZWxl\nY3QgYW5kIHRoZSBJTiBlYWdlciBzdG1udAogICAgICAgIExpc3QgbGlzdCA9\nIGV4dGVudC5saXN0KCk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKGxpc3QudG9T\ndHJpbmcoKSwgNCwgbGlzdC5zaXplKCkpOwogICAgICAgIGFzc2VydFJlbChs\naXN0LCA0KTsKICAgICAgICBhc3NlcnRSZWxzKGxpc3QsIDQpOwogICAgICAg\nIGFzc2VydEVxdWFscyhzcWwudG9TdHJpbmcoKSwgMywgc3FsLnNpemUoKSk7\nCiAgICAgICAgYXNzZXJ0VHJ1ZSgoU3RyaW5nKSBzcWwuZ2V0KDEpLAogICAg\nICAgICAgICBtYXRjaGVzKCIgSU4gIiwgKFN0cmluZykgc3FsLmdldCgxKSkp\nOwogICAgICAgIGFzc2VydEZhbHNlKChTdHJpbmcpIHNxbC5nZXQoMiksCiAg\nICAgICAgICAgIG1hdGNoZXMoIiBJTiAiLCAoU3RyaW5nKSBzcWwuZ2V0KDIp\nKSk7CiAgICAgICAgc3FsLmNsZWFyKCk7CgogICAgICAgIGVtLmNsb3NlKCk7\nCiAgICB9CgogIC8qICBwdWJsaWMgdm9pZCB0ZXN0Tm9uUGFnaW5nUmFuZ2VR\ndWVyeSgpCiAgICAgICAgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgaW5p\ndGlhbGl6ZVBhZ2luZ1BDcygpOwoKICAgICAgICBFbnRpdHlNYW5hZ2VyIGVt\nID1jdXJyZW50RW50aXR5TWFuYWdlcigpOwogICAgICAgIFF1ZXJ5IHEgPSBl\nbS5uZXdRdWVyeShQYWdpbmdQQy5jbGFzcywgImludEZpZWxkID49IDAiKTsK\nCiAgICAgICAgLy9GSVhNRSBqdGhvbWFzIGNvbW1lbnRpbmcgdGlsbCB3ZSBm\naW5kIGhvdyBvcmRlcmluZyBjYW4gYmUgZG9uZQogICAgICAgIC8vcS5zZXRP\ncmRlcmluZygiaW50RmllbGQgYXNjZW5kaW5nIik7CiAgICAgICAgcS5zZXRS\nYW5nZSgxLCAzKTsKICAgICAgICBxLmdldEZldGNoUGxhbigpLnNldEZldGNo\nU2l6ZSgwKTsKICAgICAgICBxLmdldEZldGNoUGxhbigpLmFkZEdyb3VwKCJy\nZWwiKTsKCiAgICAgICAgLy8gaWYgd2Ugb25seSBhY2Nlc3MgdGhlIHJlbCBm\naWVsZCwgd2Ugc2hvdWxkIG9ubHkgaGF2ZSB1c2VkIG9uZQogICAgICAgIC8v\nIHNlbGVjdDsgdGhlcmUgd29uJ3QgYmUgYSBzaXplIHNlbGVjdCBzaW5jZSB0\naGUgcmFuZ2Ugd2lsbCBiZQogICAgICAgIC8vIGdyZWVkaWx5IGNvbnN1bWVk\nIGFzIGl0J3Mgc28gc21hbGwKICAgICAgICBMaXN0IGxpc3QgPSAoTGlzdCkg\ncS5leGVjdXRlKCk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKDIsIGxpc3Quc2l6\nZSgpKTsKICAgICAgICBhc3NlcnRSZWwobGlzdCwgMik7CiAgICAgICAgYXNz\nZXJ0RXF1YWxzKHNxbC50b1N0cmluZygpLCAxLCBzcWwuc2l6ZSgpKTsKICAg\nICAgICBhc3NlcnRUcnVlKChTdHJpbmcpIHNxbC5nZXQoMCksCiAgICAgICAg\nICAgIG1hdGNoZXMoIiA+PSAiLCAoU3RyaW5nKSBzcWwuZ2V0KDApKSk7CiAg\nICAgICAgc3FsLmNsZWFyKCk7CgogICAgICAgIC8vIG5vdyBhY2Nlc3Npbmcg\ndGhlIHJlbHMgY29sbGVjdGlvbiBzaG91bGQgYWRkIHNlbGVjdHMKICAgICAg\nICBhc3NlcnRSZWxzKGxpc3QsIDIpOwogICAgICAgIGFzc2VydEVxdWFscyhz\ncWwudG9TdHJpbmcoKSwgMiwgc3FsLnNpemUoKSk7CiAgICAgICAgc3FsLmNs\nZWFyKCk7CgogICAgICAgIC8vIG5vdyBleGVjdXRlIHdpdGggYSBiaWcgcmFu\nZ2UgYW5kIHNtYWxsIGZldGNoIHNpemUgYW5kIGJpZ2dlciByYW5nZQogICAg\nICAgIC8vIGFuZCB0aGlzIHRpbWUgd2Ugc2hvdWxkIGdldCBhIHNlbGVjdCBm\nb3IgdGhlIHNpemUgdG9vCiAgICAgICAgcS5nZXRGZXRjaFBsYW4oKS5zZXRG\nZXRjaFNpemUoMik7CiAgICAgICAgcS5zZXRSYW5nZSgxLCA0KTsKICAgICAg\nICBsaXN0ID0gKExpc3QpIHEuZXhlY3V0ZSgpOwogICAgICAgIGFzc2VydEVx\ndWFscygzLCBsaXN0LnNpemUoKSk7CiAgICAgICAgLy8gc28gd2UgZG9uJ3Qg\naGF2ZSB0byByZS1leGVjdXRlIHRvIG1vdmUgYmFjayB0byBiZWdpbm5pbmcK\nICAgICAgICBsaXN0ID0gbmV3IEFycmF5TGlzdChsaXN0KTsKICAgICAgICBh\nc3NlcnRSZWwobGlzdCwgMyk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKHNxbC50\nb1N0cmluZygpLCAyLCBzcWwuc2l6ZSgpKTsKICAgICAgICBhc3NlcnRUcnVl\nKChTdHJpbmcpIHNxbC5nZXQoMCksCiAgICAgICAgICAgIG1hdGNoZXMoIiA+\nPSAiLCAoU3RyaW5nKSBzcWwuZ2V0KDApKSk7CiAgICAgICAgYXNzZXJ0VHJ1\nZSgoU3RyaW5nKSBzcWwuZ2V0KDEpLAogICAgICAgICAgICBtYXRjaGVzKCIg\nQ09VTlQiLCAoU3RyaW5nKSBzcWwuZ2V0KDEpKSk7CiAgICAgICAgc3FsLmNs\nZWFyKCk7CgogICAgICAgIGVtLmNsb3NlKCk7CiAgICB9Ci8qCiAgICBwdWJs\naWMgdm9pZCB0ZXN0UGFnaW5nUmFuZ2VRdWVyeSgpCiAgICAgICAgdGhyb3dz\nIEV4Y2VwdGlvbiB7CiAgICAgICAgaW5pdGlhbGl6ZVBhZ2luZ1BDcygpOwoK\nICAgICAgICBFbnRpdHlNYW5hZ2VyIGVtID1jdXJyZW50RW50aXR5TWFuYWdl\ncigpOwogICAgICAgIFF1ZXJ5IHEgPSBlbS5uZXdRdWVyeShQYWdpbmdQQy5j\nbGFzcywgImludEZpZWxkID49IDAiKTsKCiAgICAgICAgLy9GSVhNRSBqdGhv\nbWFzIGNvbW1lbnRpbmcgdGlsbCB3ZSBmaW5kIGhvdyBvcmRlcmluZyBjYW4g\nYmUgZG9uZQogICAgICAgIC8vcS5zZXRPcmRlcmluZygiaW50RmllbGQgYXNj\nZW5kaW5nIik7CiAgICAgICAgcS5zZXRSYW5nZSgxLCAzKTsKICAgICAgICBx\nLmdldEZldGNoUGxhbigpLnNldEZldGNoU2l6ZSgwKTsKICAgICAgICBxLmdl\ndEZldGNoUGxhbigpLmFkZEdyb3VwKCJyZWwiKTsKICAgICAgICBxLmdldEZl\ndGNoUGxhbigpLmFkZEdyb3VwKCJyZWxzIik7CgogICAgICAgIC8vIGV4cGVj\ndCB0d28gc2VsZWN0czogdGhlIHByaW1hcnkgc2VsZWN0IGFuZCB0aGUgSU4g\nc2VsZWN0OyBubyBzaXplCiAgICAgICAgLy8gc2VsZWN0IGV4cGVjdGVkIGJl\nY2F1c2UgdGhlIHJhbmdlIHdpbGwgYmUgY29uc3VtZWQgZ3JlZWRpbHkgc2lu\nY2UKICAgICAgICAvLyBpdCdzIHNvIHNtYWxsCiAgICAgICAgTGlzdCBsaXN0\nID0gKExpc3QpIHEuZXhlY3V0ZSgpOwogICAgICAgIGFzc2VydEVxdWFscygy\nLCBsaXN0LnNpemUoKSk7CiAgICAgICAgYXNzZXJ0UmVsKGxpc3QsIDIpOwog\nICAgICAgIGFzc2VydFJlbHMobGlzdCwgMik7CiAgICAgICAgYXNzZXJ0RXF1\nYWxzKHNxbC50b1N0cmluZygpLCAyLCBzcWwuc2l6ZSgpKTsKICAgICAgICBh\nc3NlcnRUcnVlKChTdHJpbmcpIHNxbC5nZXQoMCksCiAgICAgICAgICAgIG1h\ndGNoZXMoIiA+PSAiLCAoU3RyaW5nKSBzcWwuZ2V0KDApKSk7CiAgICAgICAg\nYXNzZXJ0VHJ1ZShzcWwgKyAiIiwKICAgICAgICAgICAgbWF0Y2hlcygiIElO\nICIsIChTdHJpbmcpIHNxbC5nZXQoMSkpKTsKICAgICAgICBzcWwuY2xlYXIo\nKTsKCiAgICAgICAgLy8gbm93IGV4ZWN1dGUgd2l0aCBhIGJpZyByYW5nZSBh\nbmQgc21hbGwgZmV0Y2ggc2l6ZSBhbmQgYmlnZ2VyIHJhbmdlCiAgICAgICAg\nLy8gYW5kIHRoaXMgdGltZSB3ZSBzaG91bGQgZ2V0IGEgc2VsZWN0IGZvciB0\naGUgc2l6ZSB0b28KICAgICAgICBxLmdldEZldGNoUGxhbigpLnNldEZldGNo\nU2l6ZSgyKTsKICAgICAgICBxLnNldFJhbmdlKDEsIDQpOwogICAgICAgIGxp\nc3QgPSAoTGlzdCkgcS5leGVjdXRlKCk7CiAgICAgICAgYXNzZXJ0RXF1YWxz\nKDMsIGxpc3Quc2l6ZSgpKTsKICAgICAgICAvLyBzbyB3ZSBkb24ndCBoYXZl\nIHRvIHJlLWV4ZWN1dGUgdG8gbW92ZSBiYWNrIHRvIGJlZ2lubmluZwogICAg\nICAgIGxpc3QgPSBuZXcgQXJyYXlMaXN0KGxpc3QpOwogICAgICAgIGFzc2Vy\ndFJlbChsaXN0LCAzKTsKICAgICAgICBhc3NlcnRSZWxzKGxpc3QsIDMpOwog\nICAgICAgIGFzc2VydEVxdWFscyhzcWwudG9TdHJpbmcoKSwgNCwgc3FsLnNp\nemUoKSk7CiAgICAgICAgYXNzZXJ0VHJ1ZSgoU3RyaW5nKSBzcWwuZ2V0KDAp\nLAogICAgICAgICAgICBtYXRjaGVzKCIgPj0gIiwgKFN0cmluZykgc3FsLmdl\ndCgwKSkpOwogICAgICAgIGFzc2VydFRydWUoKFN0cmluZykgc3FsLmdldCgx\nKSwKICAgICAgICAgICAgbWF0Y2hlcygiIENPVU5UIiwgKFN0cmluZykgc3Fs\nLmdldCgxKSkpOwogICAgICAgIGFzc2VydFRydWUoKFN0cmluZykgc3FsLmdl\ndCgyKSwKICAgICAgICAgICAgbWF0Y2hlcygiIElOICIsIChTdHJpbmcpIHNx\nbC5nZXQoMikpKTsKICAgICAgICBhc3NlcnRGYWxzZSgoU3RyaW5nKSBzcWwu\nZ2V0KDMpLAogICAgICAgICAgICBtYXRjaGVzKCIgSU4gIiwgKFN0cmluZykg\nc3FsLmdldCgzKSkpOwogICAgICAgIHNxbC5jbGVhcigpOwoKICAgICAgICBl\nbS5jbG9zZSgpOwogICAgfQoqLwogICAgcHJpdmF0ZSB2b2lkIGluaXRpYWxp\nemVQYWdpbmdQQ3MoKSB7CiAgICAgICAgRW50aXR5TWFuYWdlciBlbSA9Y3Vy\ncmVudEVudGl0eU1hbmFnZXIoKTsKICAgICAgICBzdGFydFR4KGVtKTsKCiAg\nICAgICBkZWxldGVBbGwoUGFnaW5nUEMuY2xhc3MsZW0pOwogICAgICAgZGVs\nZXRlQWxsKFBhZ2luZ0hlbHBlclBDLmNsYXNzLGVtKTsKCiAgICAgICAgZW5k\nVHgoZW0pOwoKICAgICAgICBzdGFydFR4KGVtKTsKICAgICAgICBQYWdpbmdQ\nQyBwYzsKICAgICAgICBQYWdpbmdIZWxwZXJQQyByZWw7CiAgICAgICAgZm9y\nIChpbnQgaSA9IDA7IGkgPCA0OyBpKyspIHsKICAgICAgICAgICAgcGMgPSBu\nZXcgUGFnaW5nUEMoKTsKICAgICAgICAgICAgcGMuc2V0SW50RmllbGQoaSk7\nCiAgICAgICAgICAgIHJlbCA9IG5ldyBQYWdpbmdIZWxwZXJQQygpOwogICAg\nICAgICAgICByZWwuc2V0SW50RmllbGQoaSArIDEpOwogICAgICAgICAgICBw\nYy5zZXRSZWwocmVsKTsKICAgICAgICAgICAgcGMuZ2V0UmVscygpLmFkZChy\nZWwpOwogICAgICAgICAgICByZWwgPSBuZXcgUGFnaW5nSGVscGVyUEMoKTsK\nICAgICAgICAgICAgcmVsLnNldEludEZpZWxkKGkgKyAyKTsKICAgICAgICAg\nICAgcGMuZ2V0UmVscygpLmFkZChyZWwpOwogICAgICAgICAgICBlbS5wZXJz\naXN0KHBjKTsKICAgICAgICB9CgogICAgICAgIGVuZFR4KGVtKTsKICAgICAg\nICBlbS5jbG9zZSgpOwogICAgICAgIHNxbC5jbGVhcigpOwogICAgfQoKICAg\nIHByaXZhdGUgdm9pZCBpbml0aWFsaXplUGFnaW5nQXBwSWRQQ3MoKSB7CiAg\nICAgICAgRW50aXR5TWFuYWdlciBlbSA9Y3VycmVudEVudGl0eU1hbmFnZXIo\nKTsKICAgICAgICBzdGFydFR4KGVtKTsKICAgICAgIGRlbGV0ZUFsbChQYWdp\nbmdBcHBJZFBDLmNsYXNzLGVtKTsKICAgICAgIGRlbGV0ZUFsbChQYWdpbmdI\nZWxwZXJQQy5jbGFzcyxlbSk7CiAgICAgICAgc3RhcnRUeChlbSk7CgogICAg\nICAgIHN0YXJ0VHgoZW0pOwogICAgICAgIFBhZ2luZ0FwcElkUEMgcGM7CiAg\nICAgICAgUGFnaW5nSGVscGVyUEMgcmVsOwogICAgICAgIGZvciAoaW50IGkg\nPSAwOyBpIDwgNDsgaSsrKSB7CiAgICAgICAgICAgIHBjID0gbmV3IFBhZ2lu\nZ0FwcElkUEMoKTsKICAgICAgICAgICAgcGMuc2V0SW50RmllbGQoaSk7CiAg\nICAgICAgICAgIHBjLnNldExvbmdGaWVsZChpICsgMTAwKTsKICAgICAgICAg\nICAgcmVsID0gbmV3IFBhZ2luZ0hlbHBlclBDKCk7CiAgICAgICAgICAgIHJl\nbC5zZXRJbnRGaWVsZChpICsgMSk7CiAgICAgICAgICAgIHBjLnNldFJlbChy\nZWwpOwogICAgICAgICAgICBwYy5nZXRSZWxzKCkuYWRkKHJlbCk7CiAgICAg\nICAgICAgIHJlbCA9IG5ldyBQYWdpbmdIZWxwZXJQQygpOwogICAgICAgICAg\nICByZWwuc2V0SW50RmllbGQoaSArIDIpOwogICAgICAgICAgICBwYy5nZXRS\nZWxzKCkuYWRkKHJlbCk7CiAgICAgICAgICAgIGVtLnBlcnNpc3QocGMpOwog\nICAgICAgIH0KCiAgICAgICAgZW5kVHgoZW0pOwogICAgIAllbS5jbG9zZSgp\nOwogICAgICAgIHNxbC5jbGVhciAoKTsKCX0KCglwcml2YXRlIE1hcCBnZXRQ\ncm9wcygpIHsKCQlNYXAgcHJvcHM9bmV3IEhhc2hNYXAoKTsKCQlwcm9wcy5w\ndXQoIm9wZW5qcGEuRGF0YUNhY2hlIiwgInRydWUiKTsKCQlwcm9wcy5wdXQo\nIm9wZW5qcGEuUmVtb3RlQ29tbWl0UHJvdmlkZXIiLCAic2p2bSIpOwoJCXBy\nb3BzLnB1dCgib3BlbmpwYS5GbHVzaEJlZm9yZVF1ZXJpZXMiLCAidHJ1ZSIp\nOwoJCXByb3BzLnB1dCgiamF2YXguamRvLm9wdGlvbi5JZ25vcmVDYWNoZSIs\nICJmYWxzZSIpOwoJCS8vcHJvcHNNYXAucHV0KCJvcGVuanBhLkJyb2tlcklt\ncGwiLCAia29kby5kYXRhY2FjaGUuQ2FjaGVUZXN0QnJva2VyIik7Ly9DYWNo\nZVRlc3RCcm9rZXIuY2xhc3MuZ2V0TmFtZSAoKSk7CgkJcmV0dXJuIHByb3Bz\nOwoJfQoKCn0K\n","encoding":"base64"}

