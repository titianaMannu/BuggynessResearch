{"sha":"432b80ffe45e98dc5b8d91a2caa91e9cdbd9d796","node_id":"MDQ6QmxvYjIwNjM2NDo0MzJiODBmZmU0NWU5OGRjNWI4ZDkxYTJjYWE5MWU5Y2RiZDlkNzk2","size":4862,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/432b80ffe45e98dc5b8d91a2caa91e9cdbd9d796","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuamRiYy5r\nZXJuZWw7CgppbXBvcnQgamF2YS51dGlsLio7CgoKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5rZXJuZWwuKjsKCgoKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5saWIuamRiYy4qOwoKLyoqCiAqIFRlc3QgY2FzZSB0aGF0IHByb3Zp\nZGVzIGFjY2VzcyB0byBhbGwgdGhlIFNRTCB0aGF0IGlzIGV4ZWN1dGVkLgog\nKgogKi8KcHVibGljIGFic3RyYWN0IGNsYXNzIFRlc3RTUUxMaXN0ZW5lclRl\nc3RDYXNlCiAgICBleHRlbmRzIEJhc2VKREJDVGVzdCB7CgogICAgcHJvdGVj\ndGVkIHN0YXRpYyBmaW5hbCBDb2xsZWN0aW9uIGJyb2tlcnMgPSBuZXcgSGFz\naFNldCgpOwogICAgcHVibGljIHN0YXRpYyBMaXN0IHNxbCA9IG5ldyBBcnJh\neUxpc3QoKTsKCiAgICBwdWJsaWMgVGVzdFNRTExpc3RlbmVyVGVzdENhc2Uo\nKSB7CiAgICB9CgogICAgcHVibGljIFRlc3RTUUxMaXN0ZW5lclRlc3RDYXNl\nKFN0cmluZyBuYW1lKSB7CiAgICAgICAgc3VwZXIobmFtZSk7CiAgICB9Cgog\nICAgcHVibGljIHZvaWQgc2V0VXAoKQogICAgICAgIHRocm93cyBFeGNlcHRp\nb24gewogICAgICAgIHN1cGVyLnNldFVwKCk7CiAgICAgICAgc2V0VXBUZXN0\nQ2FzZSgpOwogICAgICAgIHNxbC5jbGVhcigpOwogICAgfQoKICAgIC8qKgog\nICAgICogT3ZlcnJpZGUgZm9yIHNldFVwKCkgYmVoYXZpb3IuCiAgICAgKi8K\nICAgIHB1YmxpYyB2b2lkIHNldFVwVGVzdENhc2UoKSB7CiAgICB9CgogICAg\ncHVibGljIGZpbmFsIHZvaWQgdGVhckRvd24oKQogICAgICAgIHRocm93cyBF\neGNlcHRpb24gewogICAgICAgIHN1cGVyLnRlYXJEb3duKCk7CiAgICAgICAg\ndGVhckRvd25UZXN0Q2FzZSgpOwogICAgICAgIHNxbC5jbGVhcigpOwogICAg\nfQoKICAgIC8qKgogICAgICogT3ZlcnJpZGUgZm9yIHRlYXJEb3duKCkgYmVo\nYXZpb3IuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHRlYXJEb3duVGVzdENh\nc2UoKSB7CiAgICB9CgogICAgLyoqCiAgICAgKiBDb25maXJtIHRoYXQgdGhl\nIHNwZWNpZmllZCBTUUwgaGFzIGJlZW4gZXhlY3V0ZWQuCiAgICAgKgogICAg\nICogQHBhcmFtIHNxbEV4cCB0aGUgU1FMIGV4cHJlc3Npb24uIEUuZy4sICJT\nRUxFQ1QgRk9PIC4qIgogICAgICovCiAgICBwdWJsaWMgdm9pZCBhc3NlcnRT\nUUwoU3RyaW5nIHNxbEV4cCkKICAgICAgICB0aHJvd3MgRXhjZXB0aW9uIHsK\nICAgICAgICBmb3IgKEl0ZXJhdG9yIGkgPSBzcWwuaXRlcmF0b3IoKTsgaS5o\nYXNOZXh0KCk7KSB7CiAgICAgICAgICAgIFN0cmluZyBzdGF0ZW1lbnQgPSAo\nU3RyaW5nKSBpLm5leHQoKTsKICAgICAgICAgICAgaWYgKG1hdGNoZXMoc3Fs\nRXhwLCBzdGF0ZW1lbnQpKQogICAgICAgICAgICAgICAgcmV0dXJuOwogICAg\nICAgIH0KCiAgICAgICAgZmFpbCgiRXhwZWN0ZWQgcmVndWxhciBleHByZXNz\naW9uIDwiICsgc3FsRXhwICsgIj4gdG8gaGF2ZSIKICAgICAgICAgICAgKyAi\nIGV4aXN0ZWQgaW4gU1FMIHN0YXRlbWVudHM6ICIgKyBzcWwpOwogICAgfQoK\nICAgIC8qKgogICAgICogQ29uZmlybSB0aGF0IHRoZSBzcGVjaWZpZWQgU1FM\nIGhhcyBub3QgYmVlbiBleGVjdXRlZC4KICAgICAqCiAgICAgKiBAcGFyYW0g\nc3FsRXhwIHRoZSBTUUwgZXhwcmVzc2lvbi4gRS5nLiwgIlNFTEVDVCBCQURD\nT0xVTU4gLioiCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIGFzc2VydE5vdFNR\nTChTdHJpbmcgc3FsRXhwKQogICAgICAgIHRocm93cyBFeGNlcHRpb24gewog\nICAgICAgIGJvb2xlYW4gZmFpbGVkID0gZmFsc2U7CgogICAgICAgIGZvciAo\nSXRlcmF0b3IgaSA9IHNxbC5pdGVyYXRvcigpOyBpLmhhc05leHQoKTspIHsK\nICAgICAgICAgICAgU3RyaW5nIHN0YXRlbWVudCA9IChTdHJpbmcpIGkubmV4\ndCgpOwogICAgICAgICAgICBpZiAobWF0Y2hlcyhzcWxFeHAsIHN0YXRlbWVu\ndCkpCiAgICAgICAgICAgICAgICBmYWlsZWQgPSB0cnVlOwogICAgICAgIH0K\nCiAgICAgICAgaWYgKGZhaWxlZCkKICAgICAgICAgICAgZmFpbCgiUmVndWxh\nciBleHByZXNzaW9uIDwiICsgc3FsRXhwICsgIj4iCiAgICAgICAgICAgICAg\nICArICIgc2hvdWxkIG5vdCBoYXZlIGJlZW4gZXhlY3V0ZWQgaW4gU1FMIHN0\nYXRlbWVudHM6ICIgKyBzcWwpOwogICAgfQovKgoKICAgIHB1YmxpYyBLb2Rv\nUGVyc2lzdGVuY2VNYW5hZ2VyIGdldFBNKCkgewogICAgICAgIEtvZG9QZXJz\naXN0ZW5jZU1hbmFnZXIgcG0gPSAoS29kb1BlcnNpc3RlbmNlTWFuYWdlcikg\nZ2V0UE1GYWN0b3J5KCkuCiAgICAgICAgICAgIGdldFBlcnNpc3RlbmNlTWFu\nYWdlcigpOwogICAgICAgIGJyb2tlcnMuYWRkKEtvZG9KRE9IZWxwZXIudG9C\ncm9rZXIocG0pKTsKICAgICAgICByZXR1cm4gcG07CiAgICB9CgogICAgcHVi\nbGljIEtvZG9QZXJzaXN0ZW5jZU1hbmFnZXJGYWN0b3J5IGdldFBNRmFjdG9y\neSgpIHsKICAgICAgICByZXR1cm4gZ2V0UE1GYWN0b3J5KG51bGwpOwogICAg\nfQogICAgcHVibGljIEJyb2tlckZhY3RvcnkgZ2V0QnJva2VyRmFjdG9yeShT\ndHJpbmdbXSBwcm9wcykgewogICAgICAgIFN0cmluZ1tdIGJ1aWx0aW4gPSBu\nZXcgU3RyaW5nW117CiAgICAgICAgICAgICJvcGVuanBhLmpkYmMuSkRCQ0xp\nc3RlbmVycyIsIExpc3RlbmVyLmNsYXNzLmdldE5hbWUoKQogICAgICAgIH07\nCgogICAgICAgIGlmIChwcm9wcyA9PSBudWxsKQogICAgICAgICAgICBwcm9w\ncyA9IGJ1aWx0aW47CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIFN0cmlu\nZ1tdIHRtcCA9IG5ldyBTdHJpbmdbcHJvcHMubGVuZ3RoICsgYnVpbHRpbi5s\nZW5ndGhdOwogICAgICAgICAgICBTeXN0ZW0uYXJyYXljb3B5KHByb3BzLCAw\nLCB0bXAsIDAsIHByb3BzLmxlbmd0aCk7CiAgICAgICAgICAgIFN5c3RlbS5h\ncnJheWNvcHkoYnVpbHRpbiwgMCwgdG1wLCBwcm9wcy5sZW5ndGgsIGJ1aWx0\naW4ubGVuZ3RoKTsKICAgICAgICAgICAgcHJvcHMgPSB0bXA7CiAgICAgICAg\nfQoKICAgICAgICByZXR1cm4gc3VwZXIuZ2V0QnJva2VyRmFjdG9yeShwcm9w\ncyk7CiAgICB9CiAgICBwdWJsaWMgS29kb1BlcnNpc3RlbmNlTWFuYWdlckZh\nY3RvcnkgZ2V0UE1GYWN0b3J5KFN0cmluZ1tdIHByb3BzKSB7CiAgICAgICAg\nU3RyaW5nW10gYnVpbHRpbiA9IG5ldyBTdHJpbmdbXXsKICAgICAgICAgICAg\nIm9wZW5qcGEuamRiYy5KREJDTGlzdGVuZXJzIiwgTGlzdGVuZXIuY2xhc3Mu\nZ2V0TmFtZSgpCiAgICAgICAgfTsKCiAgICAgICAgaWYgKHByb3BzID09IG51\nbGwpCiAgICAgICAgICAgIHByb3BzID0gYnVpbHRpbjsKICAgICAgICBlbHNl\nIHsKICAgICAgICAgICAgU3RyaW5nW10gdG1wID0gbmV3IFN0cmluZ1twcm9w\ncy5sZW5ndGggKyBidWlsdGluLmxlbmd0aF07CiAgICAgICAgICAgIFN5c3Rl\nbS5hcnJheWNvcHkocHJvcHMsIDAsIHRtcCwgMCwgcHJvcHMubGVuZ3RoKTsK\nICAgICAgICAgICAgU3lzdGVtLmFycmF5Y29weShidWlsdGluLCAwLCB0bXAs\nIHByb3BzLmxlbmd0aCwgYnVpbHRpbi5sZW5ndGgpOwogICAgICAgICAgICBw\ncm9wcyA9IHRtcDsKICAgICAgICB9CgogICAgICAgIHJldHVybiBzdXBlci5n\nZXRQTUZhY3RvcnkocHJvcHMpOwogICAgfQoKICAgIHB1YmxpYyBCcm9rZXIg\nZ2V0QnJva2VyKCkgewogICAgICAgIEJyb2tlciBicm9rZXIgPSBnZXRCcm9r\nZXJGYWN0b3J5KCkubmV3QnJva2VyKCk7CiAgICAgICAgYnJva2Vycy5hZGQo\nYnJva2VyKTsKICAgICAgICByZXR1cm4gYnJva2VyOwogICAgfQoKICAgIHB1\nYmxpYyBCcm9rZXJGYWN0b3J5IGdldEJyb2tlckZhY3RvcnkoKSB7CiAgICAg\nICAgcmV0dXJuIGdldEJyb2tlckZhY3RvcnkobnVsbCk7CiAgICB9CgoqLwoK\nCgogICAgcHVibGljIHN0YXRpYyBjbGFzcyBMaXN0ZW5lcgogICAgICAgIGV4\ndGVuZHMgQWJzdHJhY3RKREJDTGlzdGVuZXIgewoKICAgICAgICBwdWJsaWMg\ndm9pZCBiZWZvcmVFeGVjdXRlU3RhdGVtZW50KEpEQkNFdmVudCBldmVudCkg\newogICAgICAgICAgICBpZiAoZXZlbnQuZ2V0U1FMKCkgIT0gbnVsbCkKICAg\nICAgICAgICAgICAgIHNxbC5hZGQoZXZlbnQuZ2V0U1FMKCkpOwoJCX0KCX0K\nfQo=\n","encoding":"base64"}

