{"sha":"c22d1f9b09298c46301bd4e35d267fe0da02c598","node_id":"MDQ6QmxvYjIwNjM2NDpjMjJkMWY5YjA5Mjk4YzQ2MzAxYmQ0ZTM1ZDI2N2ZlMGRhMDJjNTk4","size":7238,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/c22d1f9b09298c46301bd4e35d267fe0da02c598","content":"LyoKICogVGVzdFN1YmNsYXNzSm9pbkdldE9iamVjdEJ5SWQuamF2YQogKgog\nKiBDcmVhdGVkIG9uIE9jdG9iZXIgNSwgMjAwNiwgMzo1NSBQTQogKgogKiBU\nbyBjaGFuZ2UgdGhpcyB0ZW1wbGF0ZSwgY2hvb3NlIFRvb2xzIHwgVGVtcGxh\ndGUgTWFuYWdlcgogKiBhbmQgb3BlbiB0aGUgdGVtcGxhdGUgaW4gdGhlIGVk\naXRvci4KICovCgovKgogKiBMaWNlbnNlZCB0byB0aGUgQXBhY2hlIFNvZnR3\nYXJlIEZvdW5kYXRpb24gKEFTRikgdW5kZXIgb25lCiAqIG9yIG1vcmUgY29u\ndHJpYnV0b3IgbGljZW5zZSBhZ3JlZW1lbnRzLiAgU2VlIHRoZSBOT1RJQ0Ug\nZmlsZQogKiBkaXN0cmlidXRlZCB3aXRoIHRoaXMgd29yayBmb3IgYWRkaXRp\nb25hbCBpbmZvcm1hdGlvbgogKiByZWdhcmRpbmcgY29weXJpZ2h0IG93bmVy\nc2hpcC4gIFRoZSBBU0YgbGljZW5zZXMgdGhpcyBmaWxlCiAqIHRvIHlvdSB1\nbmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUKICog\nIkxpY2Vuc2UiKTsgeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQg\naW4gY29tcGxpYW5jZQogKiB3aXRoIHRoZSBMaWNlbnNlLiAgWW91IG1heSBv\nYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CiAqCiAqIGh0dHA6Ly93\nd3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxl\nc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGlu\nIHdyaXRpbmcsCiAqIHNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBM\naWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuCiAqICJBUyBJUyIgQkFTSVMs\nIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWQogKiBL\nSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBMaWNl\nbnNlIGZvciB0aGUKICogc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBl\ncm1pc3Npb25zIGFuZCBsaW1pdGF0aW9ucwogKiB1bmRlciB0aGUgTGljZW5z\nZS4gICAgCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0\nZW5jZS5qZGJjLm1ldGEudmVydGljYWw7CgppbXBvcnQgamF2YS51dGlsLio7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5jb25mLkpEQkNDb25m\naWd1cmF0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc3Fs\nLkpvaW47CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5JZDsKCmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuamRiYy5jb21t\nb24uYXBwcy4qOwoKCmltcG9ydCBqYXZhLmxhbmcuYW5ub3RhdGlvbi5Bbm5v\ndGF0aW9uOwppbXBvcnQganVuaXQuZnJhbWV3b3JrLio7CmltcG9ydCBqYXZh\neC5wZXJzaXN0ZW5jZS5FbnRpdHlNYW5hZ2VyOwppbXBvcnQgamF2YXgucGVy\nc2lzdGVuY2UuRW50aXR5TWFuYWdlckZhY3Rvcnk7CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuT3BlbkpQQUVudGl0eU1hbmFnZXJG\nYWN0b3J5OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNl\nLk9wZW5KUEFFbnRpdHlNYW5hZ2VyOwoKCnB1YmxpYyBjbGFzcyBUZXN0U3Vi\nY2xhc3NKb2luR2V0T2JqZWN0QnlJZAogICAgICAgIGV4dGVuZHMgb3JnLmFw\nYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNlLmpkYmMua2VybmVsLlRlc3RTUUxM\naXN0ZW5lclRlc3RDYXNlewogICAgCgogICAgcHJpdmF0ZSBTdHJpbmcgX291\ndGVyID0gIk9VVEVSIjsKICAgIAogICAgLyoqIENyZWF0ZXMgYSBuZXcgaW5z\ndGFuY2Ugb2YgVGVzdFN1YmNsYXNzSm9pbkdldE9iamVjdEJ5SWQgKi8KICAg\nIHB1YmxpYyBUZXN0U3ViY2xhc3NKb2luR2V0T2JqZWN0QnlJZChTdHJpbmcg\nbmFtZSkgCiAgICB7CiAgICAJc3VwZXIobmFtZSk7CiAgICB9CiAgICAKICAg\nIAogICAgcHVibGljIGJvb2xlYW4gc2tpcFRlc3QoKSB7CiAgICAgICAgLy9G\nSVhNRQogICAgICAgIC8qCiAgICAgICAgcmV0dXJuIHN1cGVyLnNraXBUZXN0\nKCkKICAgICAgICAgICAgfHwgKChKREJDQ29uZmlndXJhdGlvbikgZ2V0Q29u\nZmlndXJhdGlvbigpKS4KICAgICAgICAgICAgZ2V0REJEaWN0aW9uYXJ5SW5z\ndGFuY2UoKS5qb2luU3ludGF4ID09IEpvaW4uU1lOVEFYX1RSQURJVElPTkFM\nOwogICAgICAgICAqLwogICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KICAg\nIAogICAgcHVibGljIHZvaWQgc2V0VXBUZXN0Q2FzZSgpIHsKICAgICAgICAv\nLyBtYWtlIHN1cmUgYWxsIGNsYXNzZXMgYXJlIHJlZ2lzdGVyZWQKICAgICAg\nICBDbGFzc1tdIHJlZyA9IG5ldyBDbGFzc1tdewogICAgICAgICAgICBCYXNl\nLmNsYXNzLCBCYXNlU3ViMS5jbGFzcywgQmFzZVN1YjIuY2xhc3MsCiAgICAg\nICAgICAgIEJhc2VTdWIxU3ViMS5jbGFzcywgQmFzZVN1YjFTdWIyLmNsYXNz\nLAogICAgICAgIH07CiAgICAgICAgCiAgICAgICAgaWYgKCgoSkRCQ0NvbmZp\nZ3VyYXRpb24pIGdldENvbmZpZ3VyYXRpb24oKSkuZ2V0REJEaWN0aW9uYXJ5\nSW5zdGFuY2UoKS4KICAgICAgICAgICAgICAgIGpvaW5TeW50YXggPT0gSm9p\nbi5TWU5UQVhfREFUQUJBU0UpCiAgICAgICAgICAgIF9vdXRlciA9ICIoKyki\nOwogICAgICAgIAogICAgICAgZGVsZXRlQWxsKEJhc2UuY2xhc3MpOwogICAg\nfQogICAgCiAgICBwdWJsaWMgdm9pZCB0ZXN0QmFzZSgpCiAgICB0aHJvd3Mg\nRXhjZXB0aW9uIHsKICAgICAgICBCYXNlIHBjID0gbmV3IEJhc2UoKTsKICAg\nICAgICBwYy5zZXRCYXNlRmllbGQoMSk7CiAgICAgICAgT2JqZWN0IG9pZCA9\nIHBlcnNpc3QocGMpOwogICAgICAgIHNxbC5jbGVhcigpOwogICAgICAgIAog\nICAgICAgIE9wZW5KUEFFbnRpdHlNYW5hZ2VyIHBtID0oT3BlbkpQQUVudGl0\neU1hbmFnZXIpY3VycmVudEVudGl0eU1hbmFnZXIoKTsKICAgICAgICAKICAg\nICAgICBwYyA9IChCYXNlKSBwbS5nZXRPYmplY3RJZChvaWQpOwogICAgICAg\nIGFzc2VydEVxdWFscygxLCBwYy5nZXRCYXNlRmllbGQoKSk7CiAgICAgICAg\nYXNzZXJ0RXF1YWxzKEJhc2UuY2xhc3MsIHBjLmdldENsYXNzKCkpOwogICAg\nICAgIHBtLmNsb3NlKCk7CiAgICAgICAgCiAgICAgICAgYXNzZXJ0RXF1YWxz\nKDEsIHNxbC5zaXplKCkpOwogICAgICAgIGFzc2VydE5vdFNRTChfb3V0ZXIp\nOwogICAgICAgIHNxbC5jbGVhcigpOwogICAgICAgIAogICAgICAgIC8vIHNo\nb3VsZCBvdXRlciBqb2luIHdpdGggbm9uLWV4YWN0IG9pZAogICAgICAgIG9p\nZCA9IG5ldyBJZChCYXNlLmNsYXNzLCAoKElkKSBvaWQpLmdldElkKCkpOwog\nICAgICAgIHBtID0gKE9wZW5KUEFFbnRpdHlNYW5hZ2VyKWN1cnJlbnRFbnRp\ndHlNYW5hZ2VyKCk7CiAgICAgICAgcGMgPSAoQmFzZSkgcG0uZ2V0T2JqZWN0\nSWQob2lkKTsKICAgICAgICBhc3NlcnRFcXVhbHMoMSwgcGMuZ2V0QmFzZUZp\nZWxkKCkpOwogICAgICAgIGFzc2VydEVxdWFscyhCYXNlLmNsYXNzLCBwYy5n\nZXRDbGFzcygpKTsKICAgICAgICBwbS5jbG9zZSgpOwogICAgICAgIAogICAg\nICAgIGFzc2VydEVxdWFscygxLCBzcWwuc2l6ZSgpKTsKICAgICAgICBhc3Nl\ncnRTUUwoX291dGVyKTsKICAgIH0KICAgIAogICAgcHVibGljIHZvaWQgdGVz\ndEJhZElkKCkKICAgIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIEJhc2Ug\ncGMgPSBuZXcgQmFzZSgpOwogICAgICAgIHBjLnNldEJhc2VGaWVsZCgxKTsK\nICAgICAgICBPYmplY3Qgb2lkID0gcGVyc2lzdChwYyk7CiAgICAgICAgc3Fs\nLmNsZWFyKCk7CiAgICAgICAgCiAgICAgICAgSWQgaWQgPSBuZXcgSWQoQmFz\nZS5jbGFzcywgLTEpOwogICAgICAgIE9wZW5KUEFFbnRpdHlNYW5hZ2VyIHBt\nID0oT3BlbkpQQUVudGl0eU1hbmFnZXIpY3VycmVudEVudGl0eU1hbmFnZXIo\nKTsKICAgICAgICB0cnkgewogICAgICAgICAgICBwbS5nZXRPYmplY3RJZChp\nZCk7CiAgICAgICAgICAgIGZhaWwoIk5vIGV4Y2VwdGlvbiBvbiBiYWQgaWQu\nIik7CiAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGpvbmZlKSB7CiAgICAg\nICAgfQogICAgICAgIHBtLmNsb3NlKCk7CiAgICB9CiAgICAKICAgIHB1Ymxp\nYyB2b2lkIHRlc3RMZWFmKCkKICAgIHRocm93cyBFeGNlcHRpb24gewogICAg\nICAgIEJhc2VTdWIxU3ViMiBwYyA9IG5ldyBCYXNlU3ViMVN1YjIoKTsKICAg\nICAgICBwYy5zZXRCYXNlRmllbGQoNCk7CiAgICAgICAgcGMuc2V0QmFzZVN1\nYjFGaWVsZCg1KTsKICAgICAgICBwYy5zZXRCYXNlU3ViMVN1YjJGaWVsZCg2\nKTsKICAgICAgICBPYmplY3Qgb2lkID0gcGVyc2lzdChwYyk7CiAgICAgICAg\nc3FsLmNsZWFyKCk7CiAgICAgICAgCiAgICAgICAgT3BlbkpQQUVudGl0eU1h\nbmFnZXIgcG0gPShPcGVuSlBBRW50aXR5TWFuYWdlciljdXJyZW50RW50aXR5\nTWFuYWdlcigpOwogICAgICAgIHBjID0gKEJhc2VTdWIxU3ViMikgcG0uZ2V0\nT2JqZWN0SWQob2lkKTsKICAgICAgICBhc3NlcnRFcXVhbHMoNCwgcGMuZ2V0\nQmFzZUZpZWxkKCkpOwogICAgICAgIGFzc2VydEVxdWFscyg1LCBwYy5nZXRC\nYXNlU3ViMUZpZWxkKCkpOwogICAgICAgIGFzc2VydEVxdWFscyg2LCBwYy5n\nZXRCYXNlU3ViMVN1YjJGaWVsZCgpKTsKICAgICAgICBwbS5jbG9zZSgpOwog\nICAgICAgIAogICAgICAgIGFzc2VydEVxdWFscygxLCBzcWwuc2l6ZSgpKTsK\nICAgICAgICBhc3NlcnROb3RTUUwoX291dGVyKTsKICAgICAgICBzcWwuY2xl\nYXIoKTsKICAgICAgICAKICAgICAgICAvLyBzaG91bGQgb3V0ZXIgam9pbiB3\naXRoIGluZXhhY3Qgb2lkCiAgICAgICAgb2lkID0gbmV3IElkKEJhc2UuY2xh\nc3MsICgoSWQpIG9pZCkuZ2V0SWQoKSk7CiAgICAgICAgcG0gPSAoT3BlbkpQ\nQUVudGl0eU1hbmFnZXIpY3VycmVudEVudGl0eU1hbmFnZXIoKTsKICAgICAg\nICBwYyA9IChCYXNlU3ViMVN1YjIpIHBtLmdldE9iamVjdElkKG9pZCk7CiAg\nICAgICAgYXNzZXJ0RXF1YWxzKDQsIHBjLmdldEJhc2VGaWVsZCgpKTsKICAg\nICAgICBhc3NlcnRFcXVhbHMoNSwgcGMuZ2V0QmFzZVN1YjFGaWVsZCgpKTsK\nICAgICAgICBhc3NlcnRFcXVhbHMoNiwgcGMuZ2V0QmFzZVN1YjFTdWIyRmll\nbGQoKSk7CiAgICAgICAgcG0uY2xvc2UoKTsKICAgICAgICAKICAgICAgICBh\nc3NlcnRFcXVhbHMoMSwgc3FsLnNpemUoKSk7CiAgICAgICAgYXNzZXJ0U1FM\nKF9vdXRlcik7CiAgICB9CiAgICAKICAgIHB1YmxpYyB2b2lkIHRlc3RMZWFm\nMigpCiAgICB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBCYXNlU3ViMiBw\nYyA9IG5ldyBCYXNlU3ViMigpOwogICAgICAgIHBjLnNldEJhc2VGaWVsZCgz\nKTsKICAgICAgICBwYy5zZXRCYXNlU3ViMkZpZWxkKDQpOwogICAgICAgIE9i\namVjdCBvaWQgPSBwZXJzaXN0KHBjKTsKICAgICAgICBzcWwuY2xlYXIoKTsK\nICAgICAgICAKICAgICAgICBPcGVuSlBBRW50aXR5TWFuYWdlciBwbSA9KE9w\nZW5KUEFFbnRpdHlNYW5hZ2VyKWN1cnJlbnRFbnRpdHlNYW5hZ2VyKCk7CiAg\nICAgICAgcGMgPSAoQmFzZVN1YjIpIHBtLmdldE9iamVjdElkKG9pZCk7CiAg\nICAgICAgYXNzZXJ0RXF1YWxzKDMsIHBjLmdldEJhc2VGaWVsZCgpKTsKICAg\nICAgICBhc3NlcnRFcXVhbHMoNCwgcGMuZ2V0QmFzZVN1YjJGaWVsZCgpKTsK\nICAgICAgICBhc3NlcnRFcXVhbHMoQmFzZVN1YjIuY2xhc3MsIHBjLmdldENs\nYXNzKCkpOwogICAgICAgIHBtLmNsb3NlKCk7CiAgICAgICAgCiAgICAgICAg\nYXNzZXJ0RXF1YWxzKDEsIHNxbC5zaXplKCkpOwogICAgICAgIGFzc2VydE5v\ndFNRTChfb3V0ZXIpOwogICAgICAgIHNxbC5jbGVhcigpOwogICAgICAgIAog\nICAgICAgIC8vIHNob3VsZCBvdXRlciBqb2luIHdpdGggaW5leGFjdCBvaWQK\nICAgICAgICBvaWQgPSBuZXcgSWQoQmFzZS5jbGFzcywgKChJZCkgb2lkKS5n\nZXRJZCgpKTsKICAgICAgICBwbSA9IChPcGVuSlBBRW50aXR5TWFuYWdlcilj\ndXJyZW50RW50aXR5TWFuYWdlcigpOwogICAgICAgIHBjID0gKEJhc2VTdWIy\nKSBwbS5nZXRPYmplY3RJZChvaWQpOwogICAgICAgIGFzc2VydEVxdWFscygz\nLCBwYy5nZXRCYXNlRmllbGQoKSk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKDQs\nIHBjLmdldEJhc2VTdWIyRmllbGQoKSk7CiAgICAgICAgYXNzZXJ0RXF1YWxz\nKEJhc2VTdWIyLmNsYXNzLCBwYy5nZXRDbGFzcygpKTsKICAgICAgICBwbS5j\nbG9zZSgpOwogICAgICAgIAogICAgICAgIGFzc2VydEVxdWFscygxLCBzcWwu\nc2l6ZSgpKTsKICAgICAgICBhc3NlcnRTUUwoX291dGVyKTsKICAgIH0KICAg\nIAogICAgcHVibGljIHZvaWQgdGVzdE1pZCgpCiAgICB0aHJvd3MgRXhjZXB0\naW9uIHsKICAgICAgICBCYXNlU3ViMSBwYyA9IG5ldyBCYXNlU3ViMSgpOwog\nICAgICAgIHBjLnNldEJhc2VGaWVsZCgyKTsKICAgICAgICBwYy5zZXRCYXNl\nU3ViMUZpZWxkKDMpOwogICAgICAgIE9iamVjdCBvaWQgPSBwZXJzaXN0KHBj\nKTsKICAgICAgICBzcWwuY2xlYXIoKTsKICAgICAgICAKICAgICAgICBPcGVu\nSlBBRW50aXR5TWFuYWdlciBwbSA9KE9wZW5KUEFFbnRpdHlNYW5hZ2VyKWN1\ncnJlbnRFbnRpdHlNYW5hZ2VyKCk7CiAgICAgICAgcGMgPSAoQmFzZVN1YjEp\nIHBtLmdldE9iamVjdElkKG9pZCk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKDIs\nIHBjLmdldEJhc2VGaWVsZCgpKTsKICAgICAgICBhc3NlcnRFcXVhbHMoMywg\ncGMuZ2V0QmFzZVN1YjFGaWVsZCgpKTsKICAgICAgICBhc3NlcnRFcXVhbHMo\nQmFzZVN1YjEuY2xhc3MsIHBjLmdldENsYXNzKCkpOwogICAgICAgIHBtLmNs\nb3NlKCk7CiAgICAgICAgCiAgICAgICAgYXNzZXJ0RXF1YWxzKDEsIHNxbC5z\naXplKCkpOwogICAgICAgIGFzc2VydE5vdFNRTChfb3V0ZXIpOwogICAgICAg\nIHNxbC5jbGVhcigpOwogICAgICAgIAogICAgICAgIC8vIHNob3VsZCBvdXRl\nciBqb2luIHdpdGggaW5leGFjdCBvaWQKICAgICAgICBvaWQgPSBuZXcgSWQo\nQmFzZS5jbGFzcywgKChJZCkgb2lkKS5nZXRJZCgpKTsKICAgICAgICBwbSA9\nIChPcGVuSlBBRW50aXR5TWFuYWdlciljdXJyZW50RW50aXR5TWFuYWdlcigp\nOwogICAgICAgIHBjID0gKEJhc2VTdWIxKSBwbS5nZXRPYmplY3RJZChvaWQp\nOwogICAgICAgIGFzc2VydEVxdWFscygyLCBwYy5nZXRCYXNlRmllbGQoKSk7\nCiAgICAgICAgYXNzZXJ0RXF1YWxzKDMsIHBjLmdldEJhc2VTdWIxRmllbGQo\nKSk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKEJhc2VTdWIxLmNsYXNzLCBwYy5n\nZXRDbGFzcygpKTsKICAgICAgICBwbS5jbG9zZSgpOwogICAgICAgIAogICAg\nICAgIGFzc2VydEVxdWFscygxLCBzcWwuc2l6ZSgpKTsKICAgICAgICBhc3Nl\ncnRTUUwoX291dGVyKTsKICAgIH0KICAgIAogICAgCiAgICAKfQo=\n","encoding":"base64"}

