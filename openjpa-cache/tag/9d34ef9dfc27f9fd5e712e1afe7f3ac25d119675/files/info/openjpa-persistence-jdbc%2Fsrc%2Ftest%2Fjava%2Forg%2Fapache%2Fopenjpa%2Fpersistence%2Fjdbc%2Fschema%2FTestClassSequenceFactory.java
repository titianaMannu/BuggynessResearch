{"sha":"38ab5a8324b551946b5e85af7eb7a9b0e682dbe3","node_id":"MDQ6QmxvYjIwNjM2NDozOGFiNWE4MzI0YjU1MTk0NmI1ZTg1YWY3ZWI3YTliMGU2ODJkYmUz","size":6557,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/38ab5a8324b551946b5e85af7eb7a9b0e682dbe3","content":"LyoKICogVGVzdENsYXNzU2VxdWVuY2VGYWN0b3J5LmphdmEKICoKICogQ3Jl\nYXRlZCBvbiBPY3RvYmVyIDYsIDIwMDYsIDEyOjIxIFBNCiAqCiAqIFRvIGNo\nYW5nZSB0aGlzIHRlbXBsYXRlLCBjaG9vc2UgVG9vbHMgfCBUZW1wbGF0ZSBN\nYW5hZ2VyCiAqIGFuZCBvcGVuIHRoZSB0ZW1wbGF0ZSBpbiB0aGUgZWRpdG9y\nLgogKi8KCi8qCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUg\nRm91bmRhdGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmli\ndXRvciBsaWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxl\nCiAqIGRpc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFs\nIGluZm9ybWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlw\nLiAgVGhlIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVy\nIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGlj\nZW5zZSIpOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBj\nb21wbGlhbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFp\nbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogaHR0cDovL3d3dy5h\ncGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyBy\nZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3Jp\ndGluZywKICogc29mdHdhcmUgZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vu\nc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4KICogIkFTIElTIiBCQVNJUywgV0lU\nSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZCiAqIEtJTkQs\nIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuICBTZWUgdGhlIExpY2Vuc2Ug\nZm9yIHRoZQogKiBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlz\nc2lvbnMgYW5kIGxpbWl0YXRpb25zCiAqIHVuZGVyIHRoZSBMaWNlbnNlLiAg\nICAKICovCnBhY2thZ2Ugb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNl\nLmpkYmMuc2NoZW1hOwoKaW1wb3J0IGphdmEuc3FsLkNvbm5lY3Rpb247Cmlt\ncG9ydCBqYXZhLnNxbC5TUUxFeGNlcHRpb247CmltcG9ydCBqYXZhLnNxbC5T\ndGF0ZW1lbnQ7CmltcG9ydCBqYXZhLnV0aWwuKjsKaW1wb3J0IGphdmF4LnNx\nbC5EYXRhU291cmNlOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMu\nY29uZi5KREJDQ29uZmlndXJhdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5qZGJjLmNvbmYuSkRCQ0NvbmZpZ3VyYXRpb25JbXBsOwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMua2VybmVsLkNsYXNzVGFibGVKREJD\nU2VxOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0YS5DbGFz\nc01hcHBpbmc7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLkJy\nb2tlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuU2VxOwpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi5jb25mLkNvbmZpZ3VyYXRp\nb25Qcm92aWRlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIuY29u\nZi5Db25maWd1cmF0aW9uczsKCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\ncGVyc2lzdGVuY2UuamRiYy5jb21tb24uYXBwcy4qOwoKCmltcG9ydCBqYXZh\nLmxhbmcuYW5ub3RhdGlvbi5Bbm5vdGF0aW9uOwppbXBvcnQganVuaXQuZnJh\nbWV3b3JrLio7CmltcG9ydCBqYXZheC5wZXJzaXN0ZW5jZS5FbnRpdHlNYW5h\nZ2VyOwppbXBvcnQgamF2YXgucGVyc2lzdGVuY2UuRW50aXR5TWFuYWdlckZh\nY3Rvcnk7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2Uu\nT3BlbkpQQUVudGl0eU1hbmFnZXJGYWN0b3J5OwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLnBlcnNpc3RlbmNlLk9wZW5KUEFFbnRpdHlNYW5hZ2VyOwpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNlLmpkYmMua2Vy\nbmVsLkJhc2VKREJDVGVzdDsKCgpwdWJsaWMgY2xhc3MgVGVzdENsYXNzU2Vx\ndWVuY2VGYWN0b3J5IGV4dGVuZHMgQmFzZUpEQkNUZXN0ewogICAgCgogICAg\ncHJpdmF0ZSBzdGF0aWMgTWFwIF9zeXNwcm9wcyA9IG5ldyBIYXNoTWFwKCk7\nCiAgICAKICAgIEJyb2tlciBfYnJva2VyOwogICAgCiAgICAvKiogQ3JlYXRl\ncyBhIG5ldyBpbnN0YW5jZSBvZiBUZXN0Q2xhc3NTZXF1ZW5jZUZhY3Rvcnkg\nKi8KICAgIHB1YmxpYyBUZXN0Q2xhc3NTZXF1ZW5jZUZhY3RvcnkoKSB7CiAg\nICB9CiAgICBwdWJsaWMgVGVzdENsYXNzU2VxdWVuY2VGYWN0b3J5KFN0cmlu\nZyB0ZXN0KSB7CiAgICAgICAgc3VwZXIodGVzdCk7CiAgICB9CiAgICAKICAg\nIHB1YmxpYyB2b2lkIHNldFVwKCkKICAgIHRocm93cyBFeGNlcHRpb24gewog\nICAgICAgIEpEQkNDb25maWd1cmF0aW9uIGNvbmYgPSBuZXcgSkRCQ0NvbmZp\nZ3VyYXRpb25JbXBsKCk7CiAgICAgICAgY29uZi5mcm9tUHJvcGVydGllcyhn\nZXRQcm9wZXJ0aWVzKCkpOwogICAgICAgIGlmICghYWRqdXN0Q29uZmlndXJh\ndGlvbihjb25mKSkKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIAogICAg\nICAgIFN0cmluZyBkcml2ZXIgPSBjb25mLmdldENvbm5lY3Rpb25Ecml2ZXJO\nYW1lKCkudG9Mb3dlckNhc2UoKTsKICAgICAgICBTdHJpbmcgW10gc3FsID0g\nbnVsbDsKICAgICAgICAKICAgICAgICBpZiAoZHJpdmVyLmluZGV4T2YoIm9y\nYWNsZSIpID49IDApIHsKICAgICAgICAgICAgc3FsID0gbmV3IFN0cmluZyBb\nXXsKICAgICAgICAgICAgICAgICJjcmVhdGUgc2VxdWVuY2Ugc2VxYV9zZXEi\nLAogICAgICAgICAgICAgICAgImNyZWF0ZSBzZXF1ZW5jZSBzZXFiX3NlcSIK\nICAgICAgICAgICAgfTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgaWYg\nKHNxbCA9PSBudWxsKQogICAgICAgICAgICByZXR1cm47CiAgICAgICAgCiAg\nICAgICAgRGF0YVNvdXJjZSBkcyA9IGNvbmYuZ2V0RGF0YVNvdXJjZTIobnVs\nbCk7CiAgICAgICAgQ29ubmVjdGlvbiBjID0gZHMuZ2V0Q29ubmVjdGlvbigp\nOwogICAgICAgIFN0YXRlbWVudCBzID0gbnVsbDsKICAgICAgICB0cnkgewog\nICAgICAgICAgICBzID0gYy5jcmVhdGVTdGF0ZW1lbnQoKTsKICAgICAgICAg\nICAgZm9yIChpbnQgaSA9IDA7IGkgPCBzcWwubGVuZ3RoOyBpKyspIHsKICAg\nICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgcy5leGVj\ndXRlKHNxbFtpXSk7CiAgICAgICAgICAgICAgICB9IGNhdGNoIChTUUxFeGNl\ncHRpb24gc3FlKSB7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0K\nICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICBpZiAocyAhPSBudWxs\nKQogICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICBz\nLmNsb3NlKCk7CiAgICAgICAgICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24g\nZSkgewogICAgICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICAKICAg\nICAgICBfYnJva2VyID0gZ2V0QnJva2VyRmFjdG9yeSgpLm5ld0Jyb2tlcigp\nOwogICAgfQogICAgCiAgICAvKioKICAgICAqIFRlc3RzIHRoYXQgYWxsIHNl\ncXVlbmNlIG51bWJlcnMgYXJlIHVuaXF1ZSBhbmQgaW4gb3JkZXIuCiAgICAg\nKi8KICAgIHB1YmxpYyB2b2lkIHRlc3RTZXF1ZW5jZSgpCiAgICB0aHJvd3Mg\nRXhjZXB0aW9uIHsKICAgICAgICBTZXQgc2V0ID0gbmV3IEhhc2hTZXQoKTsK\nICAgICAgICAKICAgICAgICBKREJDQ29uZmlndXJhdGlvbiBjb25mID0gbmV3\nIEpEQkNDb25maWd1cmF0aW9uSW1wbCgpOwogICAgICAgIGNvbmYuZnJvbVBy\nb3BlcnRpZXMoZ2V0UHJvcGVydGllcygpKTsKICAgICAgICBpZiAoIWFkanVz\ndENvbmZpZ3VyYXRpb24oY29uZikpCiAgICAgICAgICAgIHJldHVybjsKICAg\nICAgICBUaHJlYWQgdDEgPSBuZXcgVXBkYXRlVGhyZWFkKHNldCwgY29uZik7\nCiAgICAgICAgVGhyZWFkIHQyID0gbmV3IFVwZGF0ZVRocmVhZChzZXQsIGNv\nbmYpOwogICAgICAgIAogICAgICAgIHQxLnN0YXJ0KCk7CiAgICAgICAgdDIu\nc3RhcnQoKTsKICAgICAgICB0MS5qb2luKCk7CiAgICAgICAgdDIuam9pbigp\nOwogICAgICAgIAogICAgICAgIGFzc2VydEVxdWFscygxMDIsIHNldC5zaXpl\nKCkpOwogICAgfQogICAgCiAgICBwdWJsaWMgdm9pZCB0ZXN0RXh0ZW5zaW9u\ncygpCiAgICB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBKREJDQ29uZmln\ndXJhdGlvbiBjb25mID0gbmV3IEpEQkNDb25maWd1cmF0aW9uSW1wbCgpOwog\nICAgICAgIGNvbmYuZnJvbVByb3BlcnRpZXMoZ2V0UHJvcGVydGllcygpKTsK\nICAgICAgICBpZiAoIWFkanVzdENvbmZpZ3VyYXRpb24oY29uZikpCiAgICAg\nICAgICAgIHJldHVybjsKICAgICAgICAKICAgICAgICBDbGFzc01hcHBpbmcg\nYU1hcHBpbmcgPSBjb25mLmdldE1hcHBpbmdSZXBvc2l0b3J5SW5zdGFuY2Uo\nKS4KICAgICAgICAgICAgICAgIGdldE1hcHBpbmcoU2VxQS5jbGFzcywgbnVs\nbCwgdHJ1ZSk7CiAgICAgICAgQ2xhc3NNYXBwaW5nIGJNYXBwaW5nID0gY29u\nZi5nZXRNYXBwaW5nUmVwb3NpdG9yeUluc3RhbmNlKCkuCiAgICAgICAgICAg\nICAgICBnZXRNYXBwaW5nKFNlcUIuY2xhc3MsIG51bGwsIHRydWUpOwogICAg\nICAgIENsYXNzTWFwcGluZyBjTWFwcGluZyA9IGNvbmYuZ2V0TWFwcGluZ1Jl\ncG9zaXRvcnlJbnN0YW5jZSgpLgogICAgICAgICAgICAgICAgZ2V0TWFwcGlu\nZyhTZXFDLmNsYXNzLCBudWxsLCB0cnVlKTsKICAgICAgICBEYXRhU291cmNl\nIGRzID0gY29uZi5nZXREYXRhU291cmNlMihudWxsKTsKICAgICAgICAKICAg\nICAgICAvLyBob2xkIGEgYW5kIGMgYW5kIHN0YXJ0IGIKICAgICAgICAKICAg\nICAgICBTZXEgc2VxID0gY29uZi5nZXRTZXF1ZW5jZUluc3RhbmNlKCk7CiAg\nICAgICAgbG9uZyBhaWQgPSAoKExvbmcpIHNlcS5uZXh0KF9icm9rZXIsIGFN\nYXBwaW5nKSkubG9uZ1ZhbHVlKCk7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7\nIGkgPCA1OyBpKyspCiAgICAgICAgICAgIHNlcS5uZXh0KF9icm9rZXIsIGJN\nYXBwaW5nKTsKICAgICAgICAKICAgICAgICBhc3NlcnRFcXVhbHMobmV3IExv\nbmcoYWlkICsgMSksIHNlcS5uZXh0KF9icm9rZXIsIGFNYXBwaW5nKSk7CiAg\nICAgICAgYXNzZXJ0RXF1YWxzKG5ldyBMb25nKGFpZCArIDIpLCBzZXEubmV4\ndChfYnJva2VyLCBjTWFwcGluZykpOwogICAgfQogICAgCiAgICAvKioKICAg\nICAqIFBhc3MgaW4gYSBtdXRhYmxlIGNvbmZpZ3VyYXRpb24KICAgICAqIDxw\nLz4KICAgICAqIHJldHVybiB0cnVlIGlmIHVzZWFibGUuCiAgICAgKi8KICAg\nIHByaXZhdGUgYm9vbGVhbiBhZGp1c3RDb25maWd1cmF0aW9uKEpEQkNDb25m\naWd1cmF0aW9uIGNvbmYpIHsKICAgICAgICBTdHJpbmcgZHJpdmVyID0gY29u\nZi5nZXRDb25uZWN0aW9uRHJpdmVyTmFtZSgpOwogICAgICAgIGlmIChkcml2\nZXIgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAg\nIGRyaXZlciA9IGRyaXZlci50b0xvd2VyQ2FzZSgpOwogICAgICAgIGlmIChk\ncml2ZXIuaW5kZXhPZigib3JhY2xlIikgPj0gMCkgewogICAgICAgICAgICBj\nb25mLnNldFNlcXVlbmNlKENsYXNzVGFibGVKREJDU2VxLmNsYXNzLmdldE5h\nbWUoKSk7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KICAg\nICAgICAKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgICAKICAgIHB1\nYmxpYyBzdGF0aWMgdm9pZCBtYWluKFN0cmluZ1tdIGFyZ3MpIHsKLy8gICAg\nICAgIG1haW4oKTsKICAgIH0KICAgIAogICAgCiAgICBwcml2YXRlIGNsYXNz\nIFVwZGF0ZVRocmVhZAogICAgICAgICAgICBleHRlbmRzIFRocmVhZCB7CiAg\nICAgICAgCiAgICAgICAgcHJpdmF0ZSBKREJDQ29uZmlndXJhdGlvbiBfY29u\nZjsKICAgICAgICBwcml2YXRlIFNldCBfc2V0ID0gbnVsbDsKICAgICAgICAK\nICAgICAgICBwdWJsaWMgVXBkYXRlVGhyZWFkKFNldCBzZXQsIEpEQkNDb25m\naWd1cmF0aW9uIGNvbmYpIHsKICAgICAgICAgICAgX3NldCA9IHNldDsKICAg\nICAgICAgICAgX2NvbmYgPSBjb25mOwogICAgICAgIH0KICAgICAgICAKICAg\nICAgICBwdWJsaWMgdm9pZCBydW4oKSB7CiAgICAgICAgICAgIERhdGFTb3Vy\nY2UgZHMgPSBfY29uZi5nZXREYXRhU291cmNlMihudWxsKTsKICAgICAgICAg\nICAgdHJ5IHsKICAgICAgICAgICAgICAgIFNlcSBzZXEgPSBfY29uZi5nZXRT\nZXF1ZW5jZUluc3RhbmNlKCk7CiAgICAgICAgICAgICAgICBDbGFzc01hcHBp\nbmcgbWFwcGluZyA9IF9jb25mLmdldE1hcHBpbmdSZXBvc2l0b3J5SW5zdGFu\nY2UoKS4KICAgICAgICAgICAgICAgICAgICAgICAgZ2V0TWFwcGluZyhTZXFB\nLmNsYXNzLCBudWxsLCB0cnVlKTsKICAgICAgICAgICAgICAgIGZvciAoaW50\nIGkgPSAwOyBpIDwgNTE7IGkrKykKICAgICAgICAgICAgICAgICAgICBfc2V0\nLmFkZChzZXEubmV4dChfYnJva2VyLCBtYXBwaW5nKSk7CiAgICAgICAgICAg\nIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgICAgICB0aHJv\ndyBuZXcgUnVudGltZUV4Y2VwdGlvbihlLmdldE1lc3NhZ2UoKSk7CiAgICAg\nICAgICAgIH0KICAgICAgICB9CiAgICB9CiAgICAKfQo=\n","encoding":"base64"}

