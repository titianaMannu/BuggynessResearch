{"sha":"8d6383d0f5e00125997a316bfb8c72bbaba08aac","node_id":"MDQ6QmxvYjIwNjM2NDo4ZDYzODNkMGY1ZTAwMTI1OTk3YTMxNmJmYjhjNzJiYmFiYTA4YWFj","size":15627,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/8d6383d0f5e00125997a316bfb8c72bbaba08aac","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2Uua2VybmVs\nOwoKaW1wb3J0IGphdmEubGFuZy5yZWZsZWN0LkFycmF5OwppbXBvcnQgamF2\nYS50ZXh0LkNvbGxhdG9yOwppbXBvcnQgamF2YS51dGlsLkFycmF5czsKaW1w\nb3J0IGphdmEudXRpbC5Db21wYXJhdG9yOwppbXBvcnQgamF2YS51dGlsLkRh\ndGU7CgoKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5r\nZXJuZWwuY29tbW9uLmFwcHMuQXJyYXlzVGVzdDsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5jb21tb24udXRpbHMuQWJzdHJhY3RU\nZXN0Q2FzZTsKaW1wb3J0IGp1bml0LmZyYW1ld29yay5Bc3NlcnRpb25GYWls\nZWRFcnJvcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5j\nZS5PcGVuSlBBRW50aXR5TWFuYWdlcjsKCi8qKgogKiBUZXN0IHZhcnlpbmcg\na2luZHMgb2YgYXJyYXkgdmFsdWVzLgogKgogKiBAYXV0aG9yIE1hcmMgUHJ1\nZCdob21tZWF1eAogKiBAYXV0aG9yIEFiZSBXaGl0ZQogKi8KcHVibGljIGNs\nYXNzIFRlc3RBcnJheVZhbHVlczIgZXh0ZW5kcyBCYXNlS2VybmVsVGVzdCB7\nCgogICAgcHJpdmF0ZSBzdGF0aWMgZG91YmxlIERPVUJMRV9QUkVDSVNJT04g\nPSAwLjAxRDsKICAgIHB1YmxpYyBzdGF0aWMgZmxvYXQgRkxPQVRfUFJFQ0lT\nSU9OID0gMC4wMUY7CgogICAgcHVibGljIHZvaWQgdGVzdFN0cmluZ0FycmF5\nKCkKICAgICAgICB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBpbnQgbWF4\nID0gKChpbnQpIChNYXRoLnJhbmRvbSgpICogMjApKSArIDU7CiAgICAgICAg\nU3RyaW5nW10gYXJyYXkgPSBuZXcgU3RyaW5nW21heF07CiAgICAgICAgZm9y\nIChpbnQgaSA9IDA7IGkgPCBtYXg7IGkrKykKICAgICAgICAgICAgYXJyYXlb\naV0gPSByYW5kb21TdHJpbmcoKTsKICAgICAgICBzYXZlQXJyYXkoYXJyYXks\nIGZhbHNlLCBmYWxzZSk7CiAgICB9CgogICAgcHVibGljIHZvaWQgdGVzdExv\nbmdBcnJheSgpCiAgICAgICAgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAg\naW50IG1heCA9ICgoaW50KSAoTWF0aC5yYW5kb20oKSAqIDIwKSkgKyA1Owog\nICAgICAgIExvbmdbXSBhcnJheSA9IG5ldyBMb25nW21heF07CiAgICAgICAg\nZm9yIChpbnQgaSA9IDA7IGkgPCBtYXg7IGkrKykKICAgICAgICAgICAgYXJy\nYXlbaV0gPSByYW5kb21Mb25nKCk7CiAgICAgICAgdHJ5IHsKICAgICAgICAg\nICAgc2F2ZUFycmF5KGFycmF5LCBmYWxzZSwgZmFsc2UpOwogICAgICAgIH0g\nY2F0Y2ggKEFzc2VydGlvbkZhaWxlZEVycm9yIGFmZSkgewogICAgICAgIH0K\nICAgIH0KCiAgICBwdWJsaWMgdm9pZCB0ZXN0TG9uZ1ByaW1pdGl2ZUFycmF5\nKCkKICAgICAgICB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBpbnQgbWF4\nID0gKChpbnQpIChNYXRoLnJhbmRvbSgpICogMjApKSArIDU7CiAgICAgICAg\nbG9uZ1tdIGFycmF5ID0gbmV3IGxvbmdbbWF4XTsKICAgICAgICBmb3IgKGlu\ndCBpID0gMDsgaSA8IG1heDsgaSsrKQogICAgICAgICAgICBhcnJheVtpXSA9\nIHJhbmRvbUxvbmcoKS5sb25nVmFsdWUoKTsKICAgICAgICB0cnkgewogICAg\nICAgICAgICBzYXZlQXJyYXkoYXJyYXksIHRydWUsIGZhbHNlKTsKICAgICAg\nICB9IGNhdGNoIChBc3NlcnRpb25GYWlsZWRFcnJvciBhZmUpIHsKICAgICAg\nICB9CiAgICB9CgogICAgcHVibGljIHZvaWQgdGVzdFNob3J0QXJyYXkoKQog\nICAgICAgIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIGludCBtYXggPSAo\nKGludCkgKE1hdGgucmFuZG9tKCkgKiAyMCkpICsgNTsKICAgICAgICBTaG9y\ndFtdIGFycmF5ID0gbmV3IFNob3J0W21heF07CiAgICAgICAgZm9yIChpbnQg\naSA9IDA7IGkgPCBtYXg7IGkrKykKICAgICAgICAgICAgYXJyYXlbaV0gPSBy\nYW5kb21TaG9ydCgpOwogICAgICAgIHNhdmVBcnJheShhcnJheSwgZmFsc2Us\nIGZhbHNlKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCB0ZXN0U2hvcnRQcmlt\naXRpdmVBcnJheSgpCiAgICAgICAgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAg\nICAgaW50IG1heCA9ICgoaW50KSAoTWF0aC5yYW5kb20oKSAqIDIwKSkgKyA1\nOwogICAgICAgIHNob3J0W10gYXJyYXkgPSBuZXcgc2hvcnRbbWF4XTsKICAg\nICAgICBmb3IgKGludCBpID0gMDsgaSA8IG1heDsgaSsrKQogICAgICAgICAg\nICBhcnJheVtpXSA9IHJhbmRvbVNob3J0KCkuc2hvcnRWYWx1ZSgpOwogICAg\nICAgIHNhdmVBcnJheShhcnJheSwgdHJ1ZSwgZmFsc2UpOwogICAgfQoKICAg\nIHB1YmxpYyB2b2lkIHRlc3RJbnRBcnJheSgpCiAgICAgICAgdGhyb3dzIEV4\nY2VwdGlvbiB7CiAgICAgICAgaW50IG1heCA9ICgoaW50KSAoTWF0aC5yYW5k\nb20oKSAqIDIwKSkgKyA1OwogICAgICAgIEludGVnZXJbXSBhcnJheSA9IG5l\ndyBJbnRlZ2VyW21heF07CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBt\nYXg7IGkrKykKICAgICAgICAgICAgYXJyYXlbaV0gPSByYW5kb21JbnQoKTsK\nICAgICAgICBzYXZlQXJyYXkoYXJyYXksIGZhbHNlLCBmYWxzZSk7CiAgICB9\nCgogICAgcHVibGljIHZvaWQgdGVzdEludFByaW1pdGl2ZUFycmF5KCkKICAg\nICAgICB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBpbnQgbWF4ID0gKChp\nbnQpIChNYXRoLnJhbmRvbSgpICogMjApKSArIDU7CiAgICAgICAgaW50W10g\nYXJyYXkgPSBuZXcgaW50W21heF07CiAgICAgICAgZm9yIChpbnQgaSA9IDA7\nIGkgPCBtYXg7IGkrKykKICAgICAgICAgICAgYXJyYXlbaV0gPSByYW5kb21J\nbnQoKS5pbnRWYWx1ZSgpOwogICAgICAgIHNhdmVBcnJheShhcnJheSwgdHJ1\nZSwgZmFsc2UpOwogICAgfQovLyBGaXhNZTogQm90aCB0ZXN0cyBoYW5ncyBv\nbiBNeXNxbAogICAgLypwdWJsaWMgdm9pZCB0ZXN0Qnl0ZUFycmF5KCkKICAg\nICAgICB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBpbnQgbWF4ID0gKChp\nbnQpIChNYXRoLnJhbmRvbSgpICogMjApKSArIDU7CiAgICAgICAgQnl0ZVtd\nIGFycmF5ID0gbmV3IEJ5dGVbbWF4XTsKICAgICAgICBmb3IgKGludCBpID0g\nMDsgaSA8IG1heDsgaSsrKQogICAgICAgICAgICBhcnJheVtpXSA9IHJhbmRv\nbUJ5dGUoKTsKICAgICAgICBzYXZlQXJyYXkoYXJyYXksIGZhbHNlLCBmYWxz\nZSk7CiAgICB9CgogICAgcHVibGljIHZvaWQgdGVzdEJ5dGVQcmltaXRpdmVB\ncnJheSgpCiAgICAgICAgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgaW50\nIG1heCA9ICgoaW50KSAoTWF0aC5yYW5kb20oKSAqIDIwKSkgKyA1OwogICAg\nICAgIGJ5dGVbXSBhcnJheSA9IG5ldyBieXRlW21heF07CiAgICAgICAgZm9y\nIChpbnQgaSA9IDA7IGkgPCBtYXg7IGkrKykKICAgICAgICAgICAgYXJyYXlb\naV0gPSByYW5kb21CeXRlKCkuYnl0ZVZhbHVlKCk7CiAgICAgICAgc2F2ZUFy\ncmF5KGFycmF5LCB0cnVlLCBmYWxzZSk7CiAgICB9Ki8KCiAgICBwdWJsaWMg\ndm9pZCB0ZXN0Qm9vbGVhbkFycmF5KCkKICAgICAgICB0aHJvd3MgRXhjZXB0\naW9uIHsKICAgICAgICBpbnQgbWF4ID0gKChpbnQpIChNYXRoLnJhbmRvbSgp\nICogMjApKSArIDU7CiAgICAgICAgQm9vbGVhbltdIGFycmF5ID0gbmV3IEJv\nb2xlYW5bbWF4XTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IG1heDsg\naSsrKQogICAgICAgICAgICBhcnJheVtpXSA9IHJhbmRvbUJvb2xlYW4oKTsK\nICAgICAgICBzYXZlQXJyYXkoYXJyYXksIGZhbHNlLCBmYWxzZSk7CiAgICB9\nCgogICAgcHVibGljIHZvaWQgdGVzdENoYXJhY3RlckFycmF5KCkKICAgICAg\nICB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBpbnQgbWF4ID0gKChpbnQp\nIChNYXRoLnJhbmRvbSgpICogMjApKSArIDU7CiAgICAgICAgQ2hhcmFjdGVy\nW10gYXJyYXkgPSBuZXcgQ2hhcmFjdGVyW21heF07CiAgICAgICAgYXJyYXlb\nMF0gPSBuZXcgQ2hhcmFjdGVyKChjaGFyKSAxKTsKICAgICAgICBmb3IgKGlu\ndCBpID0gMTsgaSA8IG1heDsgaSsrKQogICAgICAgICAgICBhcnJheVtpXSA9\nIHJhbmRvbUNoYXIoKTsKICAgICAgICBzYXZlQXJyYXkoYXJyYXksIGZhbHNl\nLCBmYWxzZSk7CiAgICB9CgogICAgcHVibGljIHZvaWQgdGVzdENoYXJhY3Rl\nclByaW1pdGl2ZUFycmF5KCkKICAgICAgICB0aHJvd3MgRXhjZXB0aW9uIHsK\nICAgICAgICBpbnQgbWF4ID0gKChpbnQpIChNYXRoLnJhbmRvbSgpICogMjAp\nKSArIDU7CiAgICAgICAgY2hhcltdIGFycmF5ID0gbmV3IGNoYXJbbWF4XTsK\nICAgICAgICBhcnJheVswXSA9IDE7CiAgICAgICAgZm9yIChpbnQgaSA9IDE7\nIGkgPCBtYXg7IGkrKykKICAgICAgICAgICAgYXJyYXlbaV0gPSByYW5kb21D\naGFyKCkuY2hhclZhbHVlKCk7CiAgICAgICAgc2F2ZUFycmF5KGFycmF5LCB0\ncnVlLCBmYWxzZSk7CiAgICB9CgogICAgcHVibGljIHZvaWQgdGVzdENoYXJh\nY3RlclByaW1pdGl2ZUNsb2JBcnJheSgpCiAgICAgICAgdGhyb3dzIEV4Y2Vw\ndGlvbiB7CiAgICAgICAgaW50IG1heCA9ICgoaW50KSAoTWF0aC5yYW5kb20o\nKSAqIDIwKSkgKyA1OwogICAgICAgIGNoYXJbXSBhcnJheSA9IG5ldyBjaGFy\nW21heF07CiAgICAgICAgYXJyYXlbMF0gPSAxOwogICAgICAgIGZvciAoaW50\nIGkgPSAxOyBpIDwgbWF4OyBpKyspCiAgICAgICAgICAgIGFycmF5W2ldID0g\ncmFuZG9tQ2hhcigpLmNoYXJWYWx1ZSgpOwogICAgICAgIHNhdmVBcnJheShh\ncnJheSwgdHJ1ZSwgdHJ1ZSk7CiAgICB9CgogICAgcHVibGljIHZvaWQgdGVz\ndEJvb2xlYW5QcmltaXRpdmVBcnJheSgpCiAgICAgICAgdGhyb3dzIEV4Y2Vw\ndGlvbiB7CiAgICAgICAgaW50IG1heCA9ICgoaW50KSAoTWF0aC5yYW5kb20o\nKSAqIDIwKSkgKyA1OwogICAgICAgIGJvb2xlYW5bXSBhcnJheSA9IG5ldyBi\nb29sZWFuW21heF07CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBtYXg7\nIGkrKykKICAgICAgICAgICAgYXJyYXlbaV0gPSByYW5kb21Cb29sZWFuKCku\nYm9vbGVhblZhbHVlKCk7CiAgICAgICAgc2F2ZUFycmF5KGFycmF5LCB0cnVl\nLCBmYWxzZSk7CiAgICB9CgogICAgcHVibGljIHZvaWQgdGVzdEZsb2F0QXJy\nYXkoKQogICAgICAgIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIGludCBt\nYXggPSAoKGludCkgKE1hdGgucmFuZG9tKCkgKiAyMCkpICsgNTsKICAgICAg\nICBGbG9hdFtdIGFycmF5ID0gbmV3IEZsb2F0W21heF07CiAgICAgICAgZm9y\nIChpbnQgaSA9IDA7IGkgPCBtYXg7IGkrKykKICAgICAgICAgICAgYXJyYXlb\naV0gPSByYW5kb21GbG9hdCgpOwogICAgICAgIHNhdmVBcnJheShhcnJheSwg\nZmFsc2UsIGZhbHNlKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCB0ZXN0Rmxv\nYXRQcmltaXRpdmVBcnJheSgpCiAgICAgICAgdGhyb3dzIEV4Y2VwdGlvbiB7\nCiAgICAgICAgaW50IG1heCA9ICgoaW50KSAoTWF0aC5yYW5kb20oKSAqIDIw\nKSkgKyA1OwogICAgICAgIGZsb2F0W10gYXJyYXkgPSBuZXcgZmxvYXRbbWF4\nXTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IG1heDsgaSsrKQogICAg\nICAgICAgICBhcnJheVtpXSA9IHJhbmRvbUZsb2F0KCkuZmxvYXRWYWx1ZSgp\nOwogICAgICAgIHNhdmVBcnJheShhcnJheSwgdHJ1ZSwgZmFsc2UpOwogICAg\nfQoKICAgIHB1YmxpYyB2b2lkIHRlc3REb3VibGVBcnJheSgpCiAgICAgICAg\ndGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgaW50IG1heCA9ICgoaW50KSAo\nTWF0aC5yYW5kb20oKSAqIDIwKSkgKyA1OwogICAgICAgIERvdWJsZVtdIGFy\ncmF5ID0gbmV3IERvdWJsZVttYXhdOwogICAgICAgIGZvciAoaW50IGkgPSAw\nOyBpIDwgbWF4OyBpKyspCiAgICAgICAgICAgIGFycmF5W2ldID0gcmFuZG9t\nRG91YmxlKCk7CiAgICAgICAgc2F2ZUFycmF5KGFycmF5LCBmYWxzZSwgZmFs\nc2UpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHRlc3REb3VibGVQcmltaXRp\ndmVBcnJheSgpCiAgICAgICAgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAg\naW50IG1heCA9ICgoaW50KSAoTWF0aC5yYW5kb20oKSAqIDIwKSkgKyA1Owog\nICAgICAgIGRvdWJsZVtdIGFycmF5ID0gbmV3IGRvdWJsZVttYXhdOwogICAg\nICAgIGZvciAoaW50IGkgPSAwOyBpIDwgbWF4OyBpKyspCiAgICAgICAgICAg\nIGFycmF5W2ldID0gcmFuZG9tRG91YmxlKCkuZG91YmxlVmFsdWUoKTsKICAg\nICAgICBzYXZlQXJyYXkoYXJyYXksIHRydWUsIGZhbHNlKTsKICAgIH0KCiAg\nICBwdWJsaWMgdm9pZCB0ZXN0RGF0ZUFycmF5KCkKICAgICAgICB0aHJvd3Mg\nRXhjZXB0aW9uIHsKICAgICAgICBpbnQgbWF4ID0gKChpbnQpIChNYXRoLnJh\nbmRvbSgpICogMjApKSArIDU7CiAgICAgICAgRGF0ZVtdIGFycmF5ID0gbmV3\nIERhdGVbbWF4XTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IG1heDsg\naSsrKQogICAgICAgICAgICBhcnJheVtpXSA9IHJhbmRvbURhdGUoKTsKICAg\nICAgICBzYXZlQXJyYXkoYXJyYXksIGZhbHNlLCBmYWxzZSk7CiAgICB9Cgog\nICAgLypGaXggTWUgYW9rZWtlIC0gVGFrZXMgYSBsb3Qgb2YgdGltZSB0byBy\ndW4gKi8KLy8gICAgcHVibGljIHZvaWQgdGVzdEZpcnN0Q2xhc3NPYmplY3RB\ncnJheSgpdGhyb3dzIEV4Y2VwdGlvbiAKLy8gICAgewovLyAgICAgICAgaW50\nIG1heCA9ICgoaW50KSAoTWF0aC5yYW5kb20oKSAqIDIwKSkgKyA1OwovLyAg\nICAgICAgQXJyYXlzVGVzdFtdIGFycmF5ID0gbmV3IEFycmF5c1Rlc3RbbWF4\nXTsKLy8gICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgbWF4OyBpKyspCi8v\nICAgICAgICAgICAgYXJyYXlbaV0gPSBuZXcgQXJyYXlzVGVzdCgpOwovLyAg\nICAgICAgc2F2ZUFycmF5KGFycmF5LCBmYWxzZSwgZmFsc2UpOwovLyAgICB9\nCgogICAgcHJpdmF0ZSB2b2lkIHNhdmVBcnJheShPYmplY3QgYXJyYXksIGJv\nb2xlYW4gcHJpbWl0aXZlLCBib29sZWFuIGxvYikKICAgICAgICB0aHJvd3Mg\nRXhjZXB0aW9uIHsKICAgICAgICB0cnkgewogICAgICAgICAgICBzYXZlQXJy\nYXlJbnRlcm5hbChhcnJheSwgcHJpbWl0aXZlLCBsb2IpOwogICAgICAgIH0g\nY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgIHRocm93IGU7CiAg\nICAgICAgfSBjYXRjaCAoRXJyb3IgZXJyb3IpIHsKICAgICAgICAgICAgdGhy\nb3cgZXJyb3I7CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgLy8K\nICAgICAgICB9CiAgICB9CgogICAgcHJpdmF0ZSB2b2lkIHNhdmVBcnJheUlu\ndGVybmFsKE9iamVjdCB2YWxzLCBib29sZWFuIHByaW1pdGl2ZSwgYm9vbGVh\nbiBsb2IpCiAgICAgICAgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgT2Jq\nZWN0W10gYXJyYXk7CiAgICAgICAgaWYgKHByaW1pdGl2ZSkKICAgICAgICAg\nICAgYXJyYXkgPSBjb252ZXJ0UHJpbWl0aXZlQXJyYXkodmFscyk7CiAgICAg\nICAgZWxzZQogICAgICAgICAgICBhcnJheSA9IChPYmplY3RbXSkgdmFsczsK\nICAgICAgICBBcnJheXMuc29ydChhcnJheSwgbmV3IFRlc3RBcnJheVNvcnRl\ncigpKTsKCiAgICAgICAgT3BlbkpQQUVudGl0eU1hbmFnZXIgcG0gPQogICAg\nICAgICAgICAoT3BlbkpQQUVudGl0eU1hbmFnZXIpIGN1cnJlbnRFbnRpdHlN\nYW5hZ2VyKCk7CiAgICAgICAgc3RhcnRUeChwbSk7CgogICAgICAgIEFycmF5\nc1Rlc3QgdGVzdCA9IG5ldyBBcnJheXNUZXN0KCk7CiAgICAgICAgcG0ucGVy\nc2lzdCh0ZXN0KTsKICAgICAgICBpbnQgdGVzdElEID0gdGVzdC5nZXRJZCgp\nOwoKICAgICAgICBzZXRHZXRUZXN0QXJyYXkodGVzdCwgdmFscywgcHJpbWl0\naXZlLCBsb2IsIHRydWUpOwogICAgICAgIGVuZFR4KHBtKTsKCiAgICAgICAg\ncG0gPSAoT3BlbkpQQUVudGl0eU1hbmFnZXIpIGN1cnJlbnRFbnRpdHlNYW5h\nZ2VyKCk7CiAgICAgICAgc3RhcnRUeChwbSk7CiAgICAgICAgQXJyYXlzVGVz\ndCByZXRyaWV2ZWRPYmplY3QgPSBwbS5maW5kKEFycmF5c1Rlc3QuY2xhc3Ms\nIHRlc3RJRCk7CgogICAgICAgIE9iamVjdCByZXRyaWV2ZWRWYWxzID0gc2V0\nR2V0VGVzdEFycmF5KHJldHJpZXZlZE9iamVjdCwgdmFscywKICAgICAgICAg\nICAgcHJpbWl0aXZlLCBsb2IsIGZhbHNlKTsKICAgICAgICBPYmplY3RbXSBy\nZXRyaWV2ZWRBcnJheTsKICAgICAgICBpZiAocHJpbWl0aXZlKQogICAgICAg\nICAgICByZXRyaWV2ZWRBcnJheSA9IGNvbnZlcnRQcmltaXRpdmVBcnJheShy\nZXRyaWV2ZWRWYWxzKTsKICAgICAgICBlbHNlCiAgICAgICAgICAgIHJldHJp\nZXZlZEFycmF5ID0gKE9iamVjdFtdKSByZXRyaWV2ZWRWYWxzOwoKICAgICAg\nICBhc3NlcnROb3ROdWxsKHJldHJpZXZlZEFycmF5KTsKICAgICAgICBhc3Nl\ncnRUcnVlKGFycmF5Lmxlbmd0aCAhPSAwKTsKICAgICAgICBhc3NlcnRFcXVh\nbHMoYXJyYXkubGVuZ3RoLCByZXRyaWV2ZWRBcnJheS5sZW5ndGgpOwogICAg\nICAgIGFzc2VydE5vdE51bGwoYXJyYXlbMF0pOwogICAgICAgIGFzc2VydE5v\ndE51bGwocmV0cmlldmVkQXJyYXlbMF0pOwoKICAgICAgICAvLyBtYWtlIHN1\ncmUgdGhlIGNsYXNzZXMgb2YgdGhlIGtleXMgYXJlIHRoZSBzYW1lLgogICAg\nICAgIGFzc2VydEVxdWFscyhhcnJheVswXS5nZXRDbGFzcygpLCByZXRyaWV2\nZWRBcnJheVswXS5nZXRDbGFzcygpKTsKICAgICAgICBBcnJheXMuc29ydChy\nZXRyaWV2ZWRBcnJheSwgbmV3IFRlc3RBcnJheVNvcnRlcigpKTsKICAgICAg\nICBmb3IgKGludCBpID0gMDsgaSA8IGFycmF5Lmxlbmd0aDsgaSsrKQogICAg\nICAgICAgICBhc3NlcnRDbGFzc0FuZFZhbHVlRXF1YWxzKGFycmF5W2ldLCBy\nZXRyaWV2ZWRBcnJheVtpXSk7CgogICAgICAgIHBtLnJlbW92ZShyZXRyaWV2\nZWRPYmplY3QpOwogICAgICAgIGVuZFR4KHBtKTsKICAgIH0KCiAgICBwcml2\nYXRlIE9iamVjdFtdIGNvbnZlcnRQcmltaXRpdmVBcnJheShPYmplY3QgYXJy\nYXkpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIGludCBsZW5ndGggPSBB\ncnJheS5nZXRMZW5ndGgoYXJyYXkpOwogICAgICAgIENsYXNzIHR5cGUgPSBB\ncnJheS5nZXQoYXJyYXksIDApLmdldENsYXNzKCk7CgogICAgICAgIE9iamVj\ndFtdIGNvcHkgPSAoT2JqZWN0W10pIEFycmF5Lm5ld0luc3RhbmNlKHR5cGUs\nIGxlbmd0aCk7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBsZW5ndGg7\nIGkrKykKICAgICAgICAgICAgY29weVtpXSA9IEFycmF5LmdldChhcnJheSwg\naSk7CgogICAgICAgIHJldHVybiBjb3B5OwogICAgfQoKICAgIHByaXZhdGUg\ndm9pZCBhc3NlcnRDbGFzc0FuZFZhbHVlRXF1YWxzKE9iamVjdCBvMSwgT2Jq\nZWN0IG8yKSB7CiAgICAgICAgYXNzZXJ0VHJ1ZSgiRmlyc3Qgb2JqZWN0IHdh\ncyBudWxsIiwgbzEgIT0gbnVsbCk7CiAgICAgICAgYXNzZXJ0VHJ1ZSgiU2Vj\nb25kIG9iamVjdCB3YXMgbnVsbCIsIG8yICE9IG51bGwpOwoKICAgICAgICBh\nc3NlcnRUcnVlKCJUeXBlcyBkaWQgbm90IG1hdGNoIChjbGFzczE9IgogICAg\nICAgICAgICArIG8xLmdldENsYXNzKCkuZ2V0TmFtZSgpICsgIiwgY2xhc3My\nPSIKICAgICAgICAgICAgKyBvMi5nZXRDbGFzcygpLmdldE5hbWUoKSArICIp\nIiwKICAgICAgICAgICAgbzEuZ2V0Q2xhc3MoKS5pc0Fzc2lnbmFibGVGcm9t\nKG8yLmdldENsYXNzKCkpKTsKCiAgICAgICAgLy8gZmxvYXRzIGFuZCBkb3Vi\nbGVzIGFyZSBhIGxpdHRsZSBzcGVjaWFsOiB3ZSBvbmx5CiAgICAgICAgLy8g\nY29tcGFyZSB0aGVtIHRvIGEgY2VydGFpbiBwcmVjaXNpb24sIGFmdGVyIHdo\naWNoCiAgICAgICAgLy8gd2UgZ2l2ZSB1cC4KICAgICAgICBpZiAobzEgaW5z\ndGFuY2VvZiBEb3VibGUpCiAgICAgICAgICAgIGFzc2VydEVxdWFscygoKERv\ndWJsZSkgbzEpLmRvdWJsZVZhbHVlKCksCiAgICAgICAgICAgICAgICAoKERv\ndWJsZSkgbzIpLmRvdWJsZVZhbHVlKCksCiAgICAgICAgICAgICAgICBET1VC\nTEVfUFJFQ0lTSU9OKTsKICAgICAgICBlbHNlIGlmIChvMSBpbnN0YW5jZW9m\nIEZsb2F0KQogICAgICAgICAgICBhc3NlcnRFcXVhbHMoKChGbG9hdCkgbzEp\nLmZsb2F0VmFsdWUoKSwKICAgICAgICAgICAgICAgICgoRmxvYXQpIG8yKS5m\nbG9hdFZhbHVlKCksCiAgICAgICAgICAgICAgICBGTE9BVF9QUkVDSVNJT04p\nOwogICAgICAgIGVsc2UKICAgICAgICAgICAgYXNzZXJ0RXF1YWxzKCJPYmpl\nY3QgZGlkIG5vdCBtYXRjaCAoY2xhc3MxPSIKICAgICAgICAgICAgICAgICsg\nbzEuZ2V0Q2xhc3MoKS5nZXROYW1lKCkgKyAiLCBjbGFzczI9IgogICAgICAg\nICAgICAgICAgKyBvMi5nZXRDbGFzcygpLmdldE5hbWUoKSArICIpIiwKICAg\nICAgICAgICAgICAgIG8xLCBvMik7CiAgICB9CgogICAgLyoqCiAgICAgKiBH\nZW5lcmljIHNldHRlci9nZXR0ZXIgZm9yIHNldHRpbmcgdGhlIGFycmF5Lgog\nICAgICovCiAgICBwcml2YXRlIE9iamVjdCBzZXRHZXRUZXN0QXJyYXkoQXJy\nYXlzVGVzdCB0ZXN0LCBPYmplY3QgYXJyYXksCiAgICAgICAgYm9vbGVhbiBw\ncmltaXRpdmUsIGJvb2xlYW4gbG9iLCBib29sZWFuIGRvU2V0KQogICAgICAg\nIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIGlmIChhcnJheSA9PSBudWxs\nKQogICAgICAgICAgICByZXR1cm4gbnVsbDsKCiAgICAgICAgT2JqZWN0IGZp\ncnN0ID0gQXJyYXkuZ2V0KGFycmF5LCAwKTsKICAgICAgICBpZiAoZmlyc3Qg\naW5zdGFuY2VvZiBEYXRlKSB7CiAgICAgICAgICAgIGlmIChkb1NldCkKICAg\nICAgICAgICAgICAgIHRlc3Quc2V0RGF0ZSgoRGF0ZVtdKSBhcnJheSk7CiAg\nICAgICAgICAgIHJldHVybiB0ZXN0LmdldERhdGUoKTsKICAgICAgICB9IGVs\nc2UgaWYgKGZpcnN0IGluc3RhbmNlb2YgU3RyaW5nKSB7CiAgICAgICAgICAg\nIGlmIChkb1NldCkKICAgICAgICAgICAgICAgIHRlc3Quc2V0U3RyaW5nKChT\ndHJpbmdbXSkgYXJyYXkpOwogICAgICAgICAgICByZXR1cm4gdGVzdC5nZXRT\ndHJpbmcoKTsKICAgICAgICB9IGVsc2UgaWYgKGZpcnN0IGluc3RhbmNlb2Yg\nQ2hhcmFjdGVyKSB7CiAgICAgICAgICAgIGlmIChkb1NldCAmJiAhcHJpbWl0\naXZlKQogICAgICAgICAgICAgICAgdGVzdC5zZXRDaGFyYWN0ZXIoKENoYXJh\nY3RlcltdKSBhcnJheSk7CiAgICAgICAgICAgIGVsc2UgaWYgKGRvU2V0ICYm\nICFsb2IpCiAgICAgICAgICAgICAgICB0ZXN0LnNldENoYXJhY3RlclAoKGNo\nYXJbXSkgYXJyYXkpOwogICAgICAgICAgICBlbHNlIGlmIChkb1NldCkKICAg\nICAgICAgICAgICAgIHRlc3Quc2V0Q2hhcmFjdGVyUENsb2IoKGNoYXJbXSkg\nYXJyYXkpOwogICAgICAgICAgICBlbHNlIGlmICghcHJpbWl0aXZlKQogICAg\nICAgICAgICAgICAgcmV0dXJuIHRlc3QuZ2V0Q2hhcmFjdGVyKCk7CiAgICAg\nICAgICAgIGVsc2UgaWYgKCFsb2IpCiAgICAgICAgICAgICAgICByZXR1cm4g\ndGVzdC5nZXRDaGFyYWN0ZXJQKCk7CiAgICAgICAgICAgIGVsc2UKICAgICAg\nICAgICAgICAgIHJldHVybiB0ZXN0LmdldENoYXJhY3RlclBDbG9iKCk7CiAg\nICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgIH0gZWxzZSBpZiAoZmly\nc3QgaW5zdGFuY2VvZiBEb3VibGUpIHsKICAgICAgICAgICAgaWYgKGRvU2V0\nICYmICFwcmltaXRpdmUpCiAgICAgICAgICAgICAgICB0ZXN0LnNldERvdWJs\nZSgoRG91YmxlW10pIGFycmF5KTsKICAgICAgICAgICAgZWxzZSBpZiAoZG9T\nZXQpCiAgICAgICAgICAgICAgICB0ZXN0LnNldERvdWJsZVAoKGRvdWJsZVtd\nKSBhcnJheSk7CiAgICAgICAgICAgIGVsc2UgaWYgKCFwcmltaXRpdmUpCiAg\nICAgICAgICAgICAgICByZXR1cm4gdGVzdC5nZXREb3VibGUoKTsKICAgICAg\nICAgICAgZWxzZQogICAgICAgICAgICAgICAgcmV0dXJuIHRlc3QuZ2V0RG91\nYmxlUCgpOwogICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICB9IGVs\nc2UgaWYgKGZpcnN0IGluc3RhbmNlb2YgQnl0ZSkgewogICAgICAgICAgICBp\nZiAoZG9TZXQgJiYgIXByaW1pdGl2ZSkKICAgICAgICAgICAgICAgIHRlc3Qu\nc2V0Qnl0ZSgoQnl0ZVtdKSBhcnJheSk7CiAgICAgICAgICAgIGVsc2UgaWYg\nKGRvU2V0KQogICAgICAgICAgICAgICAgdGVzdC5zZXRCeXRlUCgoYnl0ZVtd\nKSBhcnJheSk7CiAgICAgICAgICAgIGVsc2UgaWYgKCFwcmltaXRpdmUpCiAg\nICAgICAgICAgICAgICByZXR1cm4gdGVzdC5nZXRCeXRlKCk7CiAgICAgICAg\nICAgIGVsc2UKICAgICAgICAgICAgICAgIHJldHVybiB0ZXN0LmdldEJ5dGVQ\nKCk7CiAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgIH0gZWxzZSBp\nZiAoZmlyc3QgaW5zdGFuY2VvZiBGbG9hdCkgewogICAgICAgICAgICBpZiAo\nZG9TZXQgJiYgIXByaW1pdGl2ZSkKICAgICAgICAgICAgICAgIHRlc3Quc2V0\nRmxvYXQoKEZsb2F0W10pIGFycmF5KTsKICAgICAgICAgICAgZWxzZSBpZiAo\nZG9TZXQpCiAgICAgICAgICAgICAgICB0ZXN0LnNldEZsb2F0UCgoZmxvYXRb\nXSkgYXJyYXkpOwogICAgICAgICAgICBlbHNlIGlmICghcHJpbWl0aXZlKQog\nICAgICAgICAgICAgICAgcmV0dXJuIHRlc3QuZ2V0RmxvYXQoKTsKICAgICAg\nICAgICAgZWxzZQogICAgICAgICAgICAgICAgcmV0dXJuIHRlc3QuZ2V0Rmxv\nYXRQKCk7CiAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgIH0gZWxz\nZSBpZiAoZmlyc3QgaW5zdGFuY2VvZiBMb25nKSB7CiAgICAgICAgICAgIGlm\nIChkb1NldCAmJiAhcHJpbWl0aXZlKQogICAgICAgICAgICAgICAgdGVzdC5z\nZXRMb25nKChMb25nW10pIGFycmF5KTsKICAgICAgICAgICAgZWxzZSBpZiAo\nZG9TZXQpCiAgICAgICAgICAgICAgICB0ZXN0LnNldExvbmdQKChsb25nW10p\nIGFycmF5KTsKICAgICAgICAgICAgZWxzZSBpZiAoIXByaW1pdGl2ZSkKICAg\nICAgICAgICAgICAgIHJldHVybiB0ZXN0LmdldExvbmcoKTsKICAgICAgICAg\nICAgZWxzZQogICAgICAgICAgICAgICAgcmV0dXJuIHRlc3QuZ2V0TG9uZ1Ao\nKTsKICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgfSBlbHNlIGlm\nIChmaXJzdCBpbnN0YW5jZW9mIEludGVnZXIpIHsKICAgICAgICAgICAgaWYg\nKGRvU2V0ICYmICFwcmltaXRpdmUpCiAgICAgICAgICAgICAgICB0ZXN0LnNl\ndEludCgoSW50ZWdlcltdKSBhcnJheSk7CiAgICAgICAgICAgIGVsc2UgaWYg\nKGRvU2V0KQogICAgICAgICAgICAgICAgdGVzdC5zZXRJbnRQKChpbnRbXSkg\nYXJyYXkpOwogICAgICAgICAgICBlbHNlIGlmICghcHJpbWl0aXZlKQogICAg\nICAgICAgICAgICAgcmV0dXJuIHRlc3QuZ2V0SW50KCk7CiAgICAgICAgICAg\nIGVsc2UKICAgICAgICAgICAgICAgIHJldHVybiB0ZXN0LmdldEludFAoKTsK\nICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgfSBlbHNlIGlmIChm\naXJzdCBpbnN0YW5jZW9mIFNob3J0KSB7CiAgICAgICAgICAgIGlmIChkb1Nl\ndCAmJiAhcHJpbWl0aXZlKQogICAgICAgICAgICAgICAgdGVzdC5zZXRTaG9y\ndCgoU2hvcnRbXSkgYXJyYXkpOwogICAgICAgICAgICBlbHNlIGlmIChkb1Nl\ndCkKICAgICAgICAgICAgICAgIHRlc3Quc2V0U2hvcnRQKChzaG9ydFtdKSBh\ncnJheSk7CiAgICAgICAgICAgIGVsc2UgaWYgKCFwcmltaXRpdmUpCiAgICAg\nICAgICAgICAgICByZXR1cm4gdGVzdC5nZXRTaG9ydCgpOwogICAgICAgICAg\nICBlbHNlCiAgICAgICAgICAgICAgICByZXR1cm4gdGVzdC5nZXRTaG9ydFAo\nKTsKICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgfSBlbHNlIGlm\nIChmaXJzdCBpbnN0YW5jZW9mIEJvb2xlYW4pIHsKICAgICAgICAgICAgaWYg\nKGRvU2V0ICYmICFwcmltaXRpdmUpCiAgICAgICAgICAgICAgICB0ZXN0LnNl\ndEJvb2xlYW4oKEJvb2xlYW5bXSkgYXJyYXkpOwogICAgICAgICAgICBlbHNl\nIGlmIChkb1NldCkKICAgICAgICAgICAgICAgIHRlc3Quc2V0Qm9vbGVhblAo\nKGJvb2xlYW5bXSkgYXJyYXkpOwogICAgICAgICAgICBlbHNlIGlmICghcHJp\nbWl0aXZlKQogICAgICAgICAgICAgICAgcmV0dXJuIHRlc3QuZ2V0Qm9vbGVh\nbigpOwogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICByZXR1cm4g\ndGVzdC5nZXRCb29sZWFuUCgpOwogICAgICAgICAgICByZXR1cm4gbnVsbDsK\nICAgICAgICB9IGVsc2UgaWYgKGZpcnN0IGluc3RhbmNlb2YgQXJyYXlzVGVz\ndCkgewogICAgICAgICAgICBpZiAoZG9TZXQpCiAgICAgICAgICAgICAgICB0\nZXN0LnNldEFycmF5c1Rlc3QoKEFycmF5c1Rlc3RbXSkgYXJyYXkpOwogICAg\nICAgICAgICByZXR1cm4gdGVzdC5nZXRBcnJheXNUZXN0KCk7CiAgICAgICAg\nfQoKICAgICAgICBmYWlsKCJVbmtub3duIGFycmF5IHR5cGUiKTsKICAgICAg\nICByZXR1cm4gbnVsbDsKICAgIH0KCiAgICBwcml2YXRlIHN0YXRpYyBjbGFz\ncyBUZXN0QXJyYXlTb3J0ZXIKICAgICAgICBpbXBsZW1lbnRzIENvbXBhcmF0\nb3IgewoKICAgICAgICBwcml2YXRlIENvbGxhdG9yIGNvbGxhdG9yID0gQ29s\nbGF0b3IuZ2V0SW5zdGFuY2UoKTsKCiAgICAgICAgcHVibGljIGludCBjb21w\nYXJlKE9iamVjdCBvMSwgT2JqZWN0IG8yKSB7CiAgICAgICAgICAgIGlmIChv\nMS5lcXVhbHMobzIpKQogICAgICAgICAgICAgICAgcmV0dXJuIDA7CgogICAg\nICAgICAgICBpZiAobzEgaW5zdGFuY2VvZiBOdW1iZXIpIHsKICAgICAgICAg\nICAgICAgIHJldHVybiAoKE51bWJlcikgbzEpLmRvdWJsZVZhbHVlKCkgPgog\nICAgICAgICAgICAgICAgICAgICgoTnVtYmVyKSBvMikuZG91YmxlVmFsdWUo\nKSA/IDEgOiAtMTsKICAgICAgICAgICAgfSBlbHNlIGlmIChvMSBpbnN0YW5j\nZW9mIERhdGUpIHsKICAgICAgICAgICAgICAgIHJldHVybiAoKERhdGUpIG8x\nKS5iZWZvcmUoKERhdGUpIG8yKSA/IDEgOiAtMTsKICAgICAgICAgICAgfSBl\nbHNlIGlmIChvMSBpbnN0YW5jZW9mIEFycmF5c1Rlc3QpIHsKICAgICAgICAg\nICAgICAgIHJldHVybiAoKEFycmF5c1Rlc3QpIG8xKS5jb21wYXJlVG8obzIp\nOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiBjb2xsYXRvci5j\nb21wYXJlKG8xLnRvU3RyaW5nKCksIG8yLnRvU3RyaW5nKCkpOwogICAgICAg\nIH0KICAgIH0KfQoK\n","encoding":"base64"}

