{"sha":"47206acf5c8e00ab17306746fd352917672a61cb","node_id":"MDQ6QmxvYjIwNjM2NDo0NzIwNmFjZjVjOGUwMGFiMTczMDY3NDZmZDM1MjkxNzY3MmE2MWNi","size":11205,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/47206acf5c8e00ab17306746fd352917672a61cb","content":"LyoKICogVGVzdENoZWNrQ29uc2lzdGVuY3kuamF2YQogKgogKiBDcmVhdGVk\nIG9uIE9jdG9iZXIgOSwgMjAwNiwgNjoyMyBQTQogKgogKiBUbyBjaGFuZ2Ug\ndGhpcyB0ZW1wbGF0ZSwgY2hvb3NlIFRvb2xzIHwgVGVtcGxhdGUgTWFuYWdl\ncgogKiBhbmQgb3BlbiB0aGUgdGVtcGxhdGUgaW4gdGhlIGVkaXRvci4KICov\nCgovKgogKiBMaWNlbnNlZCB0byB0aGUgQXBhY2hlIFNvZnR3YXJlIEZvdW5k\nYXRpb24gKEFTRikgdW5kZXIgb25lCiAqIG9yIG1vcmUgY29udHJpYnV0b3Ig\nbGljZW5zZSBhZ3JlZW1lbnRzLiAgU2VlIHRoZSBOT1RJQ0UgZmlsZQogKiBk\naXN0cmlidXRlZCB3aXRoIHRoaXMgd29yayBmb3IgYWRkaXRpb25hbCBpbmZv\ncm1hdGlvbgogKiByZWdhcmRpbmcgY29weXJpZ2h0IG93bmVyc2hpcC4gIFRo\nZSBBU0YgbGljZW5zZXMgdGhpcyBmaWxlCiAqIHRvIHlvdSB1bmRlciB0aGUg\nQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUKICogIkxpY2Vuc2Ui\nKTsgeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxp\nYW5jZQogKiB3aXRoIHRoZSBMaWNlbnNlLiAgWW91IG1heSBvYnRhaW4gYSBj\nb3B5IG9mIHRoZSBMaWNlbnNlIGF0CiAqCiAqIGh0dHA6Ly93d3cuYXBhY2hl\nLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVxdWly\nZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcs\nCiAqIHNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlz\nIGRpc3RyaWJ1dGVkIG9uIGFuCiAqICJBUyBJUyIgQkFTSVMsIFdJVEhPVVQg\nV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWQogKiBLSU5ELCBlaXRo\nZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBMaWNlbnNlIGZvciB0\naGUKICogc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25z\nIGFuZCBsaW1pdGF0aW9ucwogKiB1bmRlciB0aGUgTGljZW5zZS4gICAgCiAq\nLwpwYWNrYWdlIG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5rZXJu\nZWw7CgoKCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2Uu\na2VybmVsLmNvbW1vbi5hcHBzLlJ1bnRpbWVUZXN0MTsKCmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuSlBBRmFjYWRlSGVscGVyOwpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNlLk9wZW5KUEFF\nbnRpdHlNYW5hZ2VyOwoKcHVibGljIGNsYXNzIFRlc3RDaGVja0NvbnNpc3Rl\nbmN5IGV4dGVuZHMgQmFzZUtlcm5lbFRlc3QgewoKICAgIHByaXZhdGUgT2Jq\nZWN0IF9vaWQgPSBudWxsOwoKICAgIC8qKgogICAgICogQ3JlYXRlcyBhIG5l\ndyBpbnN0YW5jZSBvZiBUZXN0Q2hlY2tDb25zaXN0ZW5jeQogICAgICovCiAg\nICBwdWJsaWMgVGVzdENoZWNrQ29uc2lzdGVuY3koU3RyaW5nIG5hbWUpIHsK\nICAgICAgICBzdXBlcihuYW1lKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBz\nZXRVcCgpIHsKICAgICAgICBkZWxldGVBbGwoUnVudGltZVRlc3QxLmNsYXNz\nKTsKCiAgICAgICAgUnVudGltZVRlc3QxIHBjID0gbmV3IFJ1bnRpbWVUZXN0\nMSgpOwogICAgICAgIHBjLnNldEludEZpZWxkKDEpOwogICAgICAgIHBjLnNl\ndEludEZpZWxkMSgxKTsKICAgICAgICBfb2lkID0gcGVyc2lzdChwYyk7CiAg\nICB9CgogICAgcHVibGljIHZvaWQgdGVzdENvbnNpc3RlbnREYXRhc3RvcmVU\ncmFuc2FjdGlvbigpIHsKCiAgICAgICAgT3BlbkpQQUVudGl0eU1hbmFnZXIg\ncG0gPSBnZXRQTSgpOwogICAgICAgIHBtLnNldE9wdGltaXN0aWMoZmFsc2Up\nOwogICAgICAgIHBtLnZhbGlkYXRlQ2hhbmdlcygpOyAgICAgICAgLy8gbm8t\nb3Agb3V0c2lkZSB0cmFucwogICAgICAgIHN0YXJ0VHgocG0pOwoKICAgICAg\nICBSdW50aW1lVGVzdDEgcGMgPSAoUnVudGltZVRlc3QxKSBwbS5maW5kKFJ1\nbnRpbWVUZXN0MS5jbGFzcywgX29pZCk7CiAgICAgICAgcGMuc2V0SW50Rmll\nbGQxKDEwMCk7CgogICAgICAgIFJ1bnRpbWVUZXN0MSBucGMgPSBuZXcgUnVu\ndGltZVRlc3QxKCk7CiAgICAgICAgbnBjLnNldEludEZpZWxkKDIpOwogICAg\nICAgIG5wYy5zZXRJbnRGaWVsZDEoMik7CiAgICAgICAgcG0ucGVyc2lzdChu\ncGMpOwogICAgICAgIHBtLnZhbGlkYXRlQ2hhbmdlcygpOwoKICAgICAgICBh\nc3NlcnRFcXVhbHMoMTAwLCBwYy5nZXRJbnRGaWVsZDEoKSk7CiAgICAgICAg\nYXNzZXJ0VHJ1ZShwbS5pc1BlcnNpc3RlbnQobnBjKSk7CgogICAgICAgIHBj\nLnNldEludEZpZWxkMSgyMDApOwogICAgICAgIG5wYy5zZXRJbnRGaWVsZDEo\nMzAwKTsKICAgICAgICBlbmRUeChwbSk7CgogICAgICAgIGFzc2VydEVxdWFs\ncygyMDAsIHBjLmdldEludEZpZWxkMSgpKTsKICAgICAgICBhc3NlcnRUcnVl\nKHBtLmlzUGVyc2lzdGVudChucGMpKTsKICAgICAgICBhc3NlcnRFcXVhbHMo\nMzAwLCBucGMuZ2V0SW50RmllbGQxKCkpOwogICAgICAgIGVuZEVtKHBtKTsK\nICAgIH0KCiAgICBwdWJsaWMgdm9pZCB0ZXN0Q29uc2lzdGVudERhdGFzdG9y\nZVRyYW5zYWN0aW9uV2l0aFJvbGxiYWNrKCkgewogICAgICAgIE9wZW5KUEFF\nbnRpdHlNYW5hZ2VyIHBtID0gZ2V0UE0oKTsKICAgICAgICBwbS5zZXRPcHRp\nbWlzdGljKGZhbHNlKTsKICAgICAgICBwbS52YWxpZGF0ZUNoYW5nZXMoKTsg\nICAgICAgIC8vIG5vLW9wIG91dHNpZGUgdHJhbnMKICAgICAgICBzdGFydFR4\nKHBtKTsKCiAgICAgICAgUnVudGltZVRlc3QxIHBjID0gKFJ1bnRpbWVUZXN0\nMSkgcG0uZmluZChSdW50aW1lVGVzdDEuY2xhc3MsIF9vaWQpOwogICAgICAg\nIHBjLnNldEludEZpZWxkMSgxMDApOwoKICAgICAgICBSdW50aW1lVGVzdDEg\nbnBjID0gbmV3IFJ1bnRpbWVUZXN0MSgpOwogICAgICAgIHBtLnBlcnNpc3Qo\nbnBjKTsKICAgICAgICBPYmplY3Qgbm9pZCA9IHBtLmdldE9iamVjdElkKG5w\nYyk7CgogICAgICAgIHBtLnZhbGlkYXRlQ2hhbmdlcygpOwogICAgICAgIGFz\nc2VydEVxdWFscygxMDAsIHBjLmdldEludEZpZWxkMSgpKTsKICAgICAgICBh\nc3NlcnRUcnVlKHBtLmlzUGVyc2lzdGVudChucGMpKTsKCiAgICAgICAgcGMu\nc2V0SW50RmllbGQxKDIwMCk7CiAgICAgICAgbnBjLnNldEludEZpZWxkMSgz\nMDApOwogICAgICAgIHJvbGxiYWNrVHgocG0pOwoKICAgICAgICBhc3NlcnRF\ncXVhbHMoMSwgcGMuZ2V0SW50RmllbGQxKCkpOwogICAgICAgIGFzc2VydEZh\nbHNlKHBtLmlzUGVyc2lzdGVudChucGMpKTsKICAgICAgICBhc3NlcnRFcXVh\nbHMoMCwgbnBjLmdldEludEZpZWxkMSgpKTsKICAgICAgICBlbmRFbShwbSk7\nCgogICAgICAgIHBtID0gZ2V0UE0oKTsKICAgICAgICB0cnkgewogICAgICAg\nICAgICBSdW50aW1lVGVzdDEgdGVtcCA9CiAgICAgICAgICAgICAgICAoUnVu\ndGltZVRlc3QxKSBwbS5maW5kKFJ1bnRpbWVUZXN0MS5jbGFzcywgbm9pZCk7\nCiAgICAgICAgICAgIGZhaWwoIk9iamVjdCBzaG91bGQgbm90IGV4aXN0LiIg\nKyB0ZW1wLmdldEludEZpZWxkKCkgKyAiOjoiICsKICAgICAgICAgICAgICAg\nIHRlbXAuZ2V0SW50RmllbGQxKCkpOwogICAgICAgIH0gY2F0Y2ggKEV4Y2Vw\ndGlvbiBqb25mZSkgewogICAgICAgIH0KICAgICAgICBlbmRFbShwbSk7CiAg\nICB9CgogICAgLy9GSVhNRSBqdGhvbWFzCi8qICAgIAogICAgcHVibGljIHZv\naWQgdGVzdEluY29uc2lzdGVudERhdGFzdG9yZVRyYW5zYWN0aW9uKCkgewog\nICAgICAgIE9wZW5KUEFFbnRpdHlNYW5hZ2VyIHBtID0gZ2V0UE0oKTsKICAg\nICAgICBGZXRjaFBsYW4gZmV0Y2ggPSAoRmV0Y2hQbGFuKSBwbS5nZXRGZXRj\naFBsYW4oKTsKICAgICAgICBwbS5zZXRPcHRpbWlzdGljKGZhbHNlKTsKICAg\nICAgICBwbS5zZXRSZXRhaW5TdGF0ZShmYWxzZSk7CiAgICAgICAgcG0udmFs\naWRhdGVDaGFuZ2VzKCk7ICAgICAgICAvLyBuby1vcCBvdXRzaWRlIHRyYW5z\nCiAgICAgICAgcG0uYmVnaW4oKTsKICAqLwogICAgLy9GSVhNRSBqdGhvbWFz\nCiAgICAvKgogICBmZXRjaC5zZXRSZWFkTG9ja0xldmVsKHBtLkxPQ0tfTk9O\nRSk7CiAgIGZldGNoLnNldFdyaXRlTG9ja0xldmVsKHBtLkxPQ0tfTk9ORSk7\nCiAgICAqLwogICAgLyoKUnVudGltZVRlc3QxIHBjID0gKFJ1bnRpbWVUZXN0\nMSkgcG0uZmluZChSdW50aW1lVGVzdDEuY2xhc3MsX29pZCk7CnBjLnNldElu\ndEZpZWxkKDEwMCk7CgpPcGVuSlBBRW50aXR5TWFuYWdlciBwbTIgPSBnZXRQ\nTSgpOwpwbTIuYmVnaW4oKTsKUnVudGltZVRlc3QxIGNvcHkgPSAoUnVudGlt\nZVRlc3QxKSBwbTIuZmluZChSdW50aW1lVGVzdDEuY2xhc3MsX29pZCk7CmNv\ncHkuc2V0SW50RmllbGQoLTEpOwpwbTIuY29tbWl0KCk7CnBtMi5jbG9zZSgp\nOwoKUnVudGltZVRlc3QxIG5wYyA9IG5ldyBSdW50aW1lVGVzdDEoKTsKcG0u\ncGVyc2lzdChucGMpOwoKdHJ5IHsKICAgcG0udmFsaWRhdGVDaGFuZ2VzKCk7\nCiAgIGZhaWwoIkRpZG4ndCBmaW5kIGluY29uc2lzdGVuY3kuIik7Cn0gY2F0\nY2ggKEV4Y2VwdGlvbiBqb3ZlKSB7CiAgIC8vRklYTUUKICAgLyoKICAgVGhy\nb3dhYmxlW10gdCA9IGpvdmUuZ2V0TmVzdGVkRXhjZXB0aW9ucygpOwogICBh\nc3NlcnRFcXVhbHMoMSwgdC5sZW5ndGgpOwogICBhc3NlcnRFcXVhbHMocGMs\nICgoKEpET0V4Y2VwdGlvbikgdFswXSkuZ2V0RmFpbGVkT2JqZWN0KCkpKTsK\nICAgICovCi8vICAgICAgICB9CgogICAgLyogICAgICAgIGFzc2VydFRydWUo\ncG0uZ2V0Um9sbGJhY2tPbmx5KCkpOwogICAgICAgICAgIHBtLnJvbGxiYWNr\nKCk7CgogICAgICAgICAgIGFzc2VydEVxdWFscygtMSwgcGMuZ2V0SW50Rmll\nbGQoKSk7CiAgICAgICAgICAgYXNzZXJ0RmFsc2UocG0uaXNQZXJzaXN0ZW50\nKG5wYykpOwogICAgICAgICAgIGVuZEVtKHBtLCgpKTsKICAgICAgIH0KICAg\nICovCiAgICBwdWJsaWMgdm9pZCB0ZXN0Q29uc2lzdGVudE9wdGltaXN0aWNU\ncmFuc2FjdGlvbigpIHsKICAgICAgICBPcGVuSlBBRW50aXR5TWFuYWdlciBw\nbSA9IGdldFBNKCk7CiAgICAgICAgcG0uc2V0T3B0aW1pc3RpYyh0cnVlKTsK\nICAgICAgICBwbS52YWxpZGF0ZUNoYW5nZXMoKTsgICAgICAgIC8vIG5vLW9w\nIG91dHNpZGUgdHJhbnMKICAgICAgICBzdGFydFR4KHBtKTsKICAgICAgICBi\nb29sZWFuIGhhc0Nvbm4gPSBoYXNDb25uZWN0aW9uKHBtKTsKCiAgICAgICAg\nUnVudGltZVRlc3QxIHBjID0gKFJ1bnRpbWVUZXN0MSkgcG0uZmluZChSdW50\naW1lVGVzdDEuY2xhc3MsIF9vaWQpOwogICAgICAgIHBjLnNldEludEZpZWxk\nMSgxMDApOwoKICAgICAgICBSdW50aW1lVGVzdDEgbnBjID0gbmV3IFJ1bnRp\nbWVUZXN0MSgpOwogICAgICAgIG5wYy5zZXRJbnRGaWVsZCgyKTsKICAgICAg\nICBucGMuc2V0SW50RmllbGQxKDIpOwogICAgICAgIHBtLnBlcnNpc3QobnBj\nKTsKCiAgICAgICAgcG0udmFsaWRhdGVDaGFuZ2VzKCk7CiAgICAgICAgaWYg\nKCFoYXNDb25uKQogICAgICAgICAgICBhc3NlcnRGYWxzZShoYXNDb25uZWN0\naW9uKHBtKSk7CgogICAgICAgIGFzc2VydEVxdWFscygxMDAsIHBjLmdldElu\ndEZpZWxkMSgpKTsKICAgICAgICBhc3NlcnRUcnVlKHBtLmlzUGVyc2lzdGVu\ndChucGMpKTsKCiAgICAgICAgcGMuc2V0SW50RmllbGQxKDIwMCk7CiAgICAg\nICAgbnBjLnNldEludEZpZWxkMSgzMDApOwogICAgICAgIGVuZFR4KHBtKTsK\nCiAgICAgICAgYXNzZXJ0RXF1YWxzKDIwMCwgcGMuZ2V0SW50RmllbGQxKCkp\nOwogICAgICAgIGFzc2VydFRydWUocG0uaXNQZXJzaXN0ZW50KG5wYykpOwog\nICAgICAgIGFzc2VydEVxdWFscygzMDAsIG5wYy5nZXRJbnRGaWVsZDEoKSk7\nCiAgICAgICAgZW5kRW0ocG0pOwogICAgfQoKICAgIHByaXZhdGUgYm9vbGVh\nbiBoYXNDb25uZWN0aW9uKE9wZW5KUEFFbnRpdHlNYW5hZ2VyIHBtKSB7CiAg\nICAgICAgcmV0dXJuIEpQQUZhY2FkZUhlbHBlci50b0Jyb2tlcihwbSkuaGFz\nQ29ubmVjdGlvbigpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHRlc3RDb25z\naXN0ZW50T3B0aW1pc3RpY1RyYW5zYWN0aW9uV2l0aFJvbGxiYWNrKCkgewog\nICAgICAgIE9wZW5KUEFFbnRpdHlNYW5hZ2VyIHBtID0gZ2V0UE0oKTsKICAg\nICAgICBwbS5zZXRPcHRpbWlzdGljKHRydWUpOwogICAgICAgIHBtLnZhbGlk\nYXRlQ2hhbmdlcygpOyAgICAgICAgLy8gbm8tb3Agb3V0c2lkZSB0cmFucwog\nICAgICAgIHN0YXJ0VHgocG0pOwogICAgICAgIGJvb2xlYW4gaGFzQ29ubiA9\nIGhhc0Nvbm5lY3Rpb24ocG0pOwoKICAgICAgICBSdW50aW1lVGVzdDEgcGMg\nPSAoUnVudGltZVRlc3QxKSBwbS5maW5kKFJ1bnRpbWVUZXN0MS5jbGFzcywg\nX29pZCk7CiAgICAgICAgcGMuc2V0SW50RmllbGQxKDEwMCk7CgogICAgICAg\nIFJ1bnRpbWVUZXN0MSBucGMgPSBuZXcgUnVudGltZVRlc3QxKCk7CiAgICAg\nICAgcG0ucGVyc2lzdChucGMpOwogICAgICAgIE9iamVjdCBub2lkID0gcG0u\nZ2V0T2JqZWN0SWQobnBjKTsKCiAgICAgICAgcG0udmFsaWRhdGVDaGFuZ2Vz\nKCk7CiAgICAgICAgaWYgKCFoYXNDb25uKQogICAgICAgICAgICBhc3NlcnRG\nYWxzZShoYXNDb25uZWN0aW9uKHBtKSk7CgogICAgICAgIGFzc2VydEVxdWFs\ncygxMDAsIHBjLmdldEludEZpZWxkMSgpKTsKICAgICAgICBhc3NlcnRUcnVl\nKHBtLmlzUGVyc2lzdGVudChucGMpKTsKCiAgICAgICAgcGMuc2V0SW50Rmll\nbGQxKDIwMCk7CiAgICAgICAgbnBjLnNldEludEZpZWxkMSgzMDApOwogICAg\nICAgIHJvbGxiYWNrVHgocG0pOwoKICAgICAgICBhc3NlcnRFcXVhbHMoMSwg\ncGMuZ2V0SW50RmllbGQxKCkpOwogICAgICAgIGFzc2VydEZhbHNlKHBtLmlz\nUGVyc2lzdGVudChucGMpKTsKICAgICAgICBhc3NlcnRFcXVhbHMoMCwgbnBj\nLmdldEludEZpZWxkMSgpKTsKICAgICAgICBlbmRFbShwbSk7CgogICAgICAg\nIHBtID0gZ2V0UE0oKTsKICAgICAgICB0cnkgewogICAgICAgICAgICBSdW50\naW1lVGVzdDEgdGVtcCA9CiAgICAgICAgICAgICAgICAoUnVudGltZVRlc3Qx\nKSBwbS5maW5kKFJ1bnRpbWVUZXN0MS5jbGFzcywgbm9pZCk7CgogICAgICAg\nICAgICBmYWlsKCJPYmplY3Qgc2hvdWxkIG5vdCBleGlzdC4iICsgdGVtcC5n\nZXRJbnRGaWVsZCgpICsgIjo6IiArCiAgICAgICAgICAgICAgICB0ZW1wLmdl\ndEludEZpZWxkMSgpKTsKICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gam9u\nZmUpIHsKICAgICAgICB9CiAgICB9Ci8vRklYTUUgCiAgICAvKgpwdWJsaWMg\ndm9pZCB0ZXN0SW5jb25zaXN0ZW50T3B0aW1pc3RpY1RyYW5zYWN0aW9uV2l0\naG91dFJlZnJlc2goKSB7Ck9wZW5KUEFFbnRpdHlNYW5hZ2VyIHBtID0gZ2V0\nUE0oKTsKcG0uc2V0UmV0YWluU3RhdGUoZmFsc2UpOwpwbS5zZXRPcHRpbWlz\ndGljKHRydWUpOwpwbS52YWxpZGF0ZUNoYW5nZXMoKTsgICAgICAgIC8vIG5v\nLW9wIG91dHNpZGUgdHJhbnMKcG0uYmVnaW4oKTsKClJ1bnRpbWVUZXN0MSBw\nYyA9IChSdW50aW1lVGVzdDEpIHBtLmZpbmQoUnVudGltZVRlc3QxLmNsYXNz\nLF9vaWQpOwpwYy5zZXRJbnRGaWVsZCgxMDApOwoKT3BlbkpQQUVudGl0eU1h\nbmFnZXIgcG0yID0gZ2V0UE0oKTsKcG0yLmJlZ2luKCk7ClJ1bnRpbWVUZXN0\nMSBjb3B5ID0gKFJ1bnRpbWVUZXN0MSkgcG0yLmZpbmQoUnVudGltZVRlc3Qx\nLmNsYXNzLF9vaWQpOwpjb3B5LnNldEludEZpZWxkKC0xKTsKcG0yLmNvbW1p\ndCgpOwpwbTIuY2xvc2UoKTsKClJ1bnRpbWVUZXN0MSBucGMgPSBuZXcgUnVu\ndGltZVRlc3QxKCk7CnBtLnBlcnNpc3QobnBjKTsKT2JqZWN0IG5vaWQgPSBw\nbS5nZXRPYmplY3RJZChucGMpOwoKdHJ5IHsKICAgcG0udmFsaWRhdGVDaGFu\nZ2VzKCk7CiAgIGZhaWwoIkRpZG4ndCBmaW5kIGluY29uc2lzdGVuY3kuIik7\nCn0gY2F0Y2ggKEV4Y2VwdGlvbiBqb3ZlKSB7CiAgIC8vRklYTUUganRob21h\ncwogICAvKgogICBUaHJvd2FibGVbXSB0ID0gam92ZS5nZXROZXN0ZWRFeGNl\ncHRpb25zKCk7CiAgIGFzc2VydEVxdWFscygxLCB0Lmxlbmd0aCk7CiAgIGFz\nc2VydEVxdWFscyhwYywgKCgoSkRPRXhjZXB0aW9uKSB0WzBdKS5nZXRGYWls\nZWRPYmplY3QoKSkpOwogICAgKi8KICAgIC8vICAgICB9Ci8qICAgICBhc3Nl\ncnRGYWxzZShwbS5nZXRSb2xsYmFja09ubHkoKSk7CiAgICAgICAgCiAgICAg\nICAgdHJ5IHsKICAgICAgICAgICAgcG0uY29tbWl0KCk7CiAgICAgICAgICAg\nIGZhaWwoIkNvbW1pdHRlZCBpbmNvbnNpc3RlbnQgdHJhbnNhY3Rpb24uIik7\nCiAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGplKSB7CiAgICAgICAgfQog\nICAgICAgIAogICAgICAgIGFzc2VydEVxdWFscygtMSwgcGMuZ2V0SW50Rmll\nbGQoKSk7CiAgICAgICAgYXNzZXJ0RmFsc2UocG0uaXNQZXJzaXN0ZW50KG5w\nYykpOwogICAgICAgIGVuZEVtKHBtLCgpKTsKICAgICAgICAKICAgICAgICBw\nbSA9IGdldFBNKCk7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgcG0uZmlu\nZChSdW50aW1lVGVzdDEuY2xhc3Msbm9pZCk7CiAgICAgICAgICAgIGZhaWwo\nIk9iamVjdCBzaG91bGQgbm90IGV4aXN0LiIpOwogICAgICAgIH0gY2F0Y2gg\nKEV4Y2VwdGlvbiBqb25mZSkgewogICAgICAgIH0KICAgICAgICBlbmRFbShw\nbSwoKSk7CiAgICB9CiAqLwoKLy9GSVhNRSAKLyogICAgCiAgICBwdWJsaWMg\ndm9pZCB0ZXN0SW5jb25zaXN0ZW50T3B0aW1pc3RpY1RyYW5zYWN0aW9uV2l0\naFJlZnJlc2goKSB7CiAgICAgICAgT3BlbkpQQUVudGl0eU1hbmFnZXIgcG0g\nPSBnZXRQTSgpOwogICAgICAgIHBtLnNldE9wdGltaXN0aWModHJ1ZSk7CiAg\nICAgICAgcG0udmFsaWRhdGVDaGFuZ2VzKCk7ICAgICAgICAvLyBuby1vcCBv\ndXRzaWRlIHRyYW5zCiAgICAgICAgcG0uYmVnaW4oKTsKICAgICAgICAKICAg\nICAgICBSdW50aW1lVGVzdDEgcGMgPSBwbS5maW5kKFJ1bnRpbWVUZXN0MS5j\nbGFzcyxfb2lkKTsKICAgICAgICBwYy5zZXRJbnRGaWVsZCgxMDApOwogICAg\nICAgIAogICAgICAgIE9wZW5KUEFFbnRpdHlNYW5hZ2VyIHBtMiA9IGdldFBN\nKCk7CiAgICAgICAgcG0yLmJlZ2luKCk7CiAgICAgICAgUnVudGltZVRlc3Qx\nIGNvcHkgPSBwbTIuZmluZChSdW50aW1lVGVzdDEuY2xhc3MsX29pZCk7CiAg\nICAgICAgY29weS5zZXRJbnRGaWVsZCgtMSk7CiAgICAgICAgcG0yLmNvbW1p\ndCgpOwogICAgICAgIHBtMi5jbG9zZSgpOwogICAgICAgIAogICAgICAgIFJ1\nbnRpbWVUZXN0MSBucGMgPSBuZXcgUnVudGltZVRlc3QxKCk7CiAgICAgICAg\ncG0ucGVyc2lzdChucGMpOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIHBt\nLnZhbGlkYXRlQ2hhbmdlcygpOwogICAgICAgICAgICBmYWlsKCJEaWRuJ3Qg\nZmluZCBpbmNvbnNpc3RlbmN5LiIpOwogICAgICAgIH0gY2F0Y2ggKEV4Y2Vw\ndGlvbiBqb3ZlKSB7CiAgICAgICAgICAgIC8vRklYTUUganRob21hcwogICAg\nICAgICAgICAvKgogICAgICAgICAgICBUaHJvd2FibGVbXSB0ID0gam92ZS5n\nZXROZXN0ZWRFeGNlcHRpb25zKCk7CiAgICAgICAgICAgIGFzc2VydEVxdWFs\ncygxLCB0Lmxlbmd0aCk7CiAgICAgICAgICAgIGFzc2VydEVxdWFscyhwYywg\nKCgoSkRPRXhjZXB0aW9uKSB0WzBdKS5nZXRGYWlsZWRPYmplY3QoKSkpOwog\nICAgICAgICAgICAgKi8KICAgIC8vICAgICAgfQogICAgLyogICAgICAgYXNz\nZXJ0RmFsc2UocG0uZ2V0Um9sbGJhY2tPbmx5KCkpOwogICAgICAgICBwbS5y\nZWZyZXNoKHBjKTsKCiAgICAgICAgIGFzc2VydEVxdWFscygtMSwgcGMuZ2V0\nSW50RmllbGQoKSk7CiAgICAgICAgIGFzc2VydFRydWUocG0uaXNQZXJzaXN0\nZW50KG5wYykpOwoKICAgICAgICAgcGMuc2V0SW50RmllbGQoMjAwKTsKICAg\nICAgICAgbnBjLnNldEludEZpZWxkKDMwMCk7CiAgICAgICAgIHBtLmNvbW1p\ndCgpOwoKICAgICAgICAgYXNzZXJ0RXF1YWxzKDIwMCwgcGMuZ2V0SW50Rmll\nbGQoKSk7CiAgICAgICAgIGFzc2VydFRydWUocG0uaXNQZXJzaXN0ZW50KG5w\nYykpOwogICAgICAgICBhc3NlcnRFcXVhbHMoMzAwLCBucGMuZ2V0SW50Rmll\nbGQoKSk7CiAgICAgICAgIGVuZEVtKHBtLCgpKTsKICAgICB9CiAgICAqLwoK\nLy9GSVhNRSAKCi8qICAgIApwdWJsaWMgdm9pZCB0ZXN0SW5jb25zaXN0ZW50\nT3B0aW1pc3RpY1RyYW5zYWN0aW9uV2l0aFJvbGxiYWNrKCkgewpPcGVuSlBB\nRW50aXR5TWFuYWdlciBwbSA9IGdldFBNKCk7CnBtLnNldFJldGFpblN0YXRl\nKGZhbHNlKTsKcG0uc2V0T3B0aW1pc3RpYyh0cnVlKTsKcG0udmFsaWRhdGVD\naGFuZ2VzKCk7ICAgICAgICAvLyBuby1vcCBvdXRzaWRlIHRyYW5zCnBtLmJl\nZ2luKCk7CgpSdW50aW1lVGVzdDEgcGMgPSAoUnVudGltZVRlc3QxKSBwbS5m\naW5kKFJ1bnRpbWVUZXN0MS5jbGFzcyxfb2lkKTsKcGMuc2V0SW50RmllbGQo\nMTAwKTsKCk9wZW5KUEFFbnRpdHlNYW5hZ2VyIHBtMiA9IGdldFBNKCk7CnBt\nMi5iZWdpbigpOwpSdW50aW1lVGVzdDEgY29weSA9IChSdW50aW1lVGVzdDEp\nIHBtMi5maW5kKFJ1bnRpbWVUZXN0MS5jbGFzcyxfb2lkKTsKY29weS5zZXRJ\nbnRGaWVsZCgtMSk7CnBtMi5jb21taXQoKTsKcG0yLmNsb3NlKCk7CgpSdW50\naW1lVGVzdDEgbnBjID0gbmV3IFJ1bnRpbWVUZXN0MSgpOwpwbS5wZXJzaXN0\nKG5wYyk7Ck9iamVjdCBub2lkID0gcG0uZ2V0T2JqZWN0SWQobnBjKTsKCnRy\neSB7CnBtLnZhbGlkYXRlQ2hhbmdlcygpOwpmYWlsKCJEaWRuJ3QgZmluZCBp\nbmNvbnNpc3RlbmN5LiIpOwp9IGNhdGNoIChFeGNlcHRpb24gam92ZSkgewov\nL0ZJWE1FIGp0aG9tYXMKLyoKVGhyb3dhYmxlW10gdCA9IGpvdmUuZ2V0TmVz\ndGVkRXhjZXB0aW9ucygpOwphc3NlcnRFcXVhbHMoMSwgdC5sZW5ndGgpOwph\nc3NlcnRFcXVhbHMocGMsICgoKEpET0V4Y2VwdGlvbikgdFswXSkuZ2V0RmFp\nbGVkT2JqZWN0KCkpKTsKKi8KICAgIC8vICAgICAgfQogICAgLyogICAgICAg\nYXNzZXJ0RmFsc2UocG0uZ2V0Um9sbGJhY2tPbmx5KCkpOwogICAgICAgICAg\ncG0ucm9sbGJhY2soKTsKCiAgICAgICAgICBhc3NlcnRFcXVhbHMoLTEsIHBj\nLmdldEludEZpZWxkKCkpOwogICAgICAgICAgYXNzZXJ0RmFsc2UocG0uaXNQ\nZXJzaXN0ZW50KG5wYykpOwogICAgICAgICAgZW5kRW0ocG0sKCkpOwoKICAg\nICAgICAgIHBtID0gZ2V0UE0oKTsKICAgICAgICAgIHRyeSB7CiAgICAgICAg\nICAgICAgcG0uZmluZChSdW50aW1lVGVzdDEuY2xhc3MsX29pZCk7CiAgICAg\nICAgICAgICAgZmFpbCgiT2JqZWN0IHNob3VsZCBub3QgZXhpc3QuIik7CiAg\nICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gam9uZmUpIHsKICAgICAgICAg\nIH0KICAgICAgICAgIGVuZEVtKHBtLCgpKTsKICAgICAgfQoKICAgICovCn0K\n","encoding":"base64"}

