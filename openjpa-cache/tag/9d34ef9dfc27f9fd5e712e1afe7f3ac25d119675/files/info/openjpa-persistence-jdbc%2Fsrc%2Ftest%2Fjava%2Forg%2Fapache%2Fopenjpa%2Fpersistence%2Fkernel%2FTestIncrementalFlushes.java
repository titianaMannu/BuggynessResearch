{"sha":"84816f3555a250b6a986a4e11bd90fa79059dbfa","node_id":"MDQ6QmxvYjIwNjM2NDo4NDgxNmYzNTU1YTI1MGI2YTk4NmE0ZTExYmQ5MGZhNzkwNTlkYmZh","size":14060,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/84816f3555a250b6a986a4e11bd90fa79059dbfa","content":"LyoKICogVGVzdEluY3JlbWVudGFsRmx1c2hlcy5qYXZhCiAqCiAqIENyZWF0\nZWQgb24gT2N0b2JlciAxMiwgMjAwNiwgMTE6MjQgQU0KICoKICogVG8gY2hh\nbmdlIHRoaXMgdGVtcGxhdGUsIGNob29zZSBUb29scyB8IFRlbXBsYXRlIE1h\nbmFnZXIKICogYW5kIG9wZW4gdGhlIHRlbXBsYXRlIGluIHRoZSBlZGl0b3Iu\nCiAqLwovKgogKiBMaWNlbnNlZCB0byB0aGUgQXBhY2hlIFNvZnR3YXJlIEZv\ndW5kYXRpb24gKEFTRikgdW5kZXIgb25lCiAqIG9yIG1vcmUgY29udHJpYnV0\nb3IgbGljZW5zZSBhZ3JlZW1lbnRzLiAgU2VlIHRoZSBOT1RJQ0UgZmlsZQog\nKiBkaXN0cmlidXRlZCB3aXRoIHRoaXMgd29yayBmb3IgYWRkaXRpb25hbCBp\nbmZvcm1hdGlvbgogKiByZWdhcmRpbmcgY29weXJpZ2h0IG93bmVyc2hpcC4g\nIFRoZSBBU0YgbGljZW5zZXMgdGhpcyBmaWxlCiAqIHRvIHlvdSB1bmRlciB0\naGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUKICogIkxpY2Vu\nc2UiKTsgeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29t\ncGxpYW5jZQogKiB3aXRoIHRoZSBMaWNlbnNlLiAgWW91IG1heSBvYnRhaW4g\nYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CiAqCiAqIGh0dHA6Ly93d3cuYXBh\nY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAogKgogKiBVbmxlc3MgcmVx\ndWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRp\nbmcsCiAqIHNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNl\nIGlzIGRpc3RyaWJ1dGVkIG9uIGFuCiAqICJBUyBJUyIgQkFTSVMsIFdJVEhP\nVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWQogKiBLSU5ELCBl\naXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBMaWNlbnNlIGZv\nciB0aGUKICogc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Np\nb25zIGFuZCBsaW1pdGF0aW9ucwogKiB1bmRlciB0aGUgTGljZW5zZS4gICAg\nCiAqLwpwYWNrYWdlIG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5r\nZXJuZWw7CgoKCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVu\nY2Uua2VybmVsLmNvbW1vbi5hcHBzLk1vZEluc3RhbmNlQ2FsbGJhY2tUZXN0\nczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5rZXJu\nZWwuY29tbW9uLmFwcHMuTW9kUnVudGltZVRlc3QxOwoKaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS5ldmVudC5BYnN0cmFjdFRyYW5zYWN0aW9uTGlzdGVu\nZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuZXZlbnQuVHJhbnNhY3Rp\nb25FdmVudDsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuUENT\ndGF0ZTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5P\ncGVuSlBBRW50aXR5TWFuYWdlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3Blbmpw\nYS5wZXJzaXN0ZW5jZS5PcGVuSlBBRW50aXR5TWFuYWdlclNQSTsKCnB1Ymxp\nYyBjbGFzcyBUZXN0SW5jcmVtZW50YWxGbHVzaGVzIGV4dGVuZHMgQmFzZUtl\ncm5lbFRlc3QgewoKICAgIHB1YmxpYyBUZXN0SW5jcmVtZW50YWxGbHVzaGVz\nKFN0cmluZyBzdHIpIHsKICAgICAgICBzdXBlcihzdHIpOwogICAgfQoKICAg\nIC8qKgogICAgICogQ3JlYXRlcyBhIG5ldyBpbnN0YW5jZSBvZiBUZXN0SW5j\ncmVtZW50YWxGbHVzaGVzCiAgICAgKi8KICAgIHB1YmxpYyBUZXN0SW5jcmVt\nZW50YWxGbHVzaGVzKCkgewogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldFVw\nKCkgewogICAgICAgIGRlbGV0ZUFsbChNb2RSdW50aW1lVGVzdDEuY2xhc3Mp\nOwovLyAgICAgICAgZGVsZXRlQWxsKE1vZEluc3RhbmNlQ2FsbGJhY2tUZXN0\ncy5jbGFzcyk7CiAgICB9CgogICAgcHVibGljIHZvaWQgdGVzdEJhc2ljSmRv\nUHJlU3RvcmUoKSB7CiAgICAgICAgT3BlbkpQQUVudGl0eU1hbmFnZXIgcG0g\nPSBnZXRQTSh0cnVlLCBmYWxzZSk7CiAgICAgICAgc3RhcnRUeChwbSk7CiAg\nICAgICAgTW9kSW5zdGFuY2VDYWxsYmFja1Rlc3RzIGEgPSBuZXcgTW9kSW5z\ndGFuY2VDYWxsYmFja1Rlc3RzKCJmb28iLCAxMCk7CiAgICAgICAgcG0ucGVy\nc2lzdChhKTsKICAgICAgICBwbS5mbHVzaCgpOwogICAgICAgIGFzc2VydFRy\ndWUoYS5wcmVTdG9yZUNhbGxlZCk7CiAgICAgICAgZW5kVHgocG0pOwogICAg\nfQoKICAgIHB1YmxpYyB2b2lkIHRlc3ROb0ZsdXNoKCkgewogICAgICAgIE9w\nZW5KUEFFbnRpdHlNYW5hZ2VyIHBtID0gZ2V0UE0odHJ1ZSwgZmFsc2UpOwog\nICAgICAgIHN0YXJ0VHgocG0pOwogICAgICAgIE1vZEluc3RhbmNlQ2FsbGJh\nY2tUZXN0cyBhID0gbmV3IE1vZEluc3RhbmNlQ2FsbGJhY2tUZXN0cygiZm9v\nIiwgMTApOwogICAgICAgIHBtLnBlcnNpc3QoYSk7CiAgICAgICAgZW5kVHgo\ncG0pOwogICAgICAgIGFzc2VydFRydWUoYS5wcmVTdG9yZUNhbGxlZCk7CiAg\nICB9CgogICAgcHVibGljIHZvaWQgdGVzdEZsdXNoTm9DaGFuZ2UoKSB7CiAg\nICAgICAgT3BlbkpQQUVudGl0eU1hbmFnZXIgcG0gPSBnZXRQTSh0cnVlLCBm\nYWxzZSk7CiAgICAgICAgc3RhcnRUeChwbSk7CiAgICAgICAgTW9kSW5zdGFu\nY2VDYWxsYmFja1Rlc3RzIGEgPSBuZXcgTW9kSW5zdGFuY2VDYWxsYmFja1Rl\nc3RzKCJmb28iLCAxMCk7CiAgICAgICAgcG0ucGVyc2lzdChhKTsKICAgICAg\nICBwbS5mbHVzaCgpOwogICAgICAgIGVuZFR4KHBtKTsKICAgICAgICBhc3Nl\ncnRUcnVlKGEucHJlU3RvcmVDYWxsZWQpOwogICAgICAgIGFzc2VydEVxdWFs\ncygxMCwgYS5nZXRJbnRGaWVsZCgpKTsKICAgIH0KCiAgICAvKioKICAgICAq\nIEhlbHBlciBtZXRob2QgZm9yIHNvbWUgY29tbW9uIHRlc3QgY2FzZXMuIFNl\nZSB1dGlsaXphdGlvbnMgb2YKICAgICAqIHRoaXMgYmVsb3cuCiAgICAgKi8K\nICAgIHByaXZhdGUgdm9pZCBiYXNpY0hlbHBlcihib29sZWFuIHVwZGF0ZSwg\nYm9vbGVhbiBtdWx0aSwgYm9vbGVhbiBkZmcsCiAgICAgICAgYm9vbGVhbiBu\nb25ERkcpIHsKICAgICAgICBPcGVuSlBBRW50aXR5TWFuYWdlciBwbSA9IGdl\ndFBNKHRydWUsIGZhbHNlKTsKICAgICAgICBzdGFydFR4KHBtKTsKCiAgICAg\nICAgTW9kSW5zdGFuY2VDYWxsYmFja1Rlc3RzIGEgPSBuZXcgTW9kSW5zdGFu\nY2VDYWxsYmFja1Rlc3RzKCJmb28iLCAxMCk7CiAgICAgICAgcG0ucGVyc2lz\ndChhKTsKICAgICAgICBpZiAodXBkYXRlKSB7CiAgICAgICAgICAgIGVuZFR4\nKHBtKTsKICAgICAgICAgICAgT2JqZWN0IG9pZCA9IHBtLmdldE9iamVjdElk\nKGEpOwogICAgICAgICAgICBlbmRFbShwbSk7CiAgICAgICAgICAgIHBtID0g\nZ2V0UE0odHJ1ZSwgZmFsc2UpOwogICAgICAgICAgICBzdGFydFR4KHBtKTsK\nICAgICAgICAgICAgYSA9IChNb2RJbnN0YW5jZUNhbGxiYWNrVGVzdHMpIHBt\nCiAgICAgICAgICAgICAgICAuZmluZChNb2RJbnN0YW5jZUNhbGxiYWNrVGVz\ndHMuY2xhc3MsIG9pZCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAg\ncG0uZmx1c2goKTsKICAgICAgICB9CgogICAgICAgIGlmIChkZmcpCiAgICAg\nICAgICAgIGEuc2V0SW50RmllbGQoMTEpOwogICAgICAgIGlmIChub25ERkcp\nCiAgICAgICAgICAgIGEuc2V0Tm9uREZHRmllbGQoMTEpOwoKICAgICAgICBp\nZiAobXVsdGkpIHsKICAgICAgICAgICAgcG0uZmx1c2goKTsKCiAgICAgICAg\nICAgIGlmIChkZmcpCiAgICAgICAgICAgICAgICBhLnNldEludEZpZWxkKDEy\nKTsKICAgICAgICAgICAgaWYgKG5vbkRGRykKICAgICAgICAgICAgICAgIGEu\nc2V0Tm9uREZHRmllbGQoMTIpOwogICAgICAgIH0KCiAgICAgICAgZW5kVHgo\ncG0pOwoKICAgICAgICAvLyBpZiBubyBjaGFuZ2VzIHdlcmUgbWFkZSBhbmQg\nd2UncmUgaW4gdXBkYXRlIG1vZGUsIHRoZW4gdGhpcwogICAgICAgIC8vIG9i\namVjdCB3b24ndCBoYXZlIGhhZCBqZG9QcmVTdG9yZSgpIGNhbGxlZC4KLy8g\nICAgICAgIGlmICghKHVwZGF0ZSAmJiAoIWRmZyAmJiAhbm9uREZHKSkpCi8v\nICAgICAgICAgICAgYXNzZXJ0VHJ1ZSgiYS5wcmVzdG9yZUNhbGxlZCBpcyBm\nYWxzZSIsIGEucHJlU3RvcmVDYWxsZWQpOwoKICAgICAgICBpZiAobXVsdGkp\nIHsKICAgICAgICAgICAgaWYgKGRmZykKICAgICAgICAgICAgICAgIGFzc2Vy\ndEVxdWFscygiYS5nZXRJbnRGaWVsZCBpcyBub3QgMTIiLCAxMiwgYS5nZXRJ\nbnRGaWVsZCgpKTsKICAgICAgICAgICAgaWYgKG5vbkRGRykKICAgICAgICAg\nICAgICAgIGFzc2VydEVxdWFscygiYS5nZXROb25ERkdGaWVsZCBpcyBub3Qg\nMTIiLCAxMiwKICAgICAgICAgICAgICAgICAgICBhLmdldE5vbkRGR0ZpZWxk\nKCkpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGlmIChkZmcpCiAg\nICAgICAgICAgICAgICBhc3NlcnRFcXVhbHMoImEuZ2V0SW50RmllbGQgaXMg\nbm90IDEyIiwgMTEsIGEuZ2V0SW50RmllbGQoKSk7CiAgICAgICAgICAgIGlm\nIChub25ERkcpCiAgICAgICAgICAgICAgICBhc3NlcnRFcXVhbHMoImEuZ2V0\nTm9uREZHRmllbGQgaXMgbm90IDEyIiwgMTEsCiAgICAgICAgICAgICAgICAg\nICAgYS5nZXROb25ERkdGaWVsZCgpKTsKICAgICAgICB9CiAgICB9CgogICAg\ncHVibGljIHZvaWQgdGVzdEZsdXNoU3RvcmVQcmltYXJ5REZHQ2hhbmdlKCkg\newogICAgICAgIGJhc2ljSGVscGVyKGZhbHNlLCBmYWxzZSwgdHJ1ZSwgZmFs\nc2UpOwogICAgICAgIGJhc2ljSGVscGVyKGZhbHNlLCB0cnVlLCB0cnVlLCBm\nYWxzZSk7CiAgICAgICAgYmFzaWNIZWxwZXIodHJ1ZSwgZmFsc2UsIHRydWUs\nIGZhbHNlKTsKICAgICAgICBiYXNpY0hlbHBlcih0cnVlLCB0cnVlLCB0cnVl\nLCBmYWxzZSk7CiAgICB9CgogICAgcHVibGljIHZvaWQgdGVzdEZsdXNoU3Rv\ncmVQcmltYXJ5Tm9uREZHQ2hhbmdlKCkgewogICAgICAgIGJhc2ljSGVscGVy\nKGZhbHNlLCBmYWxzZSwgZmFsc2UsIHRydWUpOwogICAgICAgIGJhc2ljSGVs\ncGVyKGZhbHNlLCB0cnVlLCBmYWxzZSwgdHJ1ZSk7CiAgICAgICAgYmFzaWNI\nZWxwZXIodHJ1ZSwgZmFsc2UsIGZhbHNlLCB0cnVlKTsKICAgICAgICBiYXNp\nY0hlbHBlcih0cnVlLCB0cnVlLCBmYWxzZSwgdHJ1ZSk7CiAgICB9CgogICAg\ncHVibGljIHZvaWQgdGVzdEZsdXNoU3RvcmVQcmltYXJ5Tm9uREZHQW5kREZH\nQ2hhbmdlKCkgewogICAgICAgIGJhc2ljSGVscGVyKGZhbHNlLCBmYWxzZSwg\ndHJ1ZSwgdHJ1ZSk7CiAgICAgICAgYmFzaWNIZWxwZXIoZmFsc2UsIHRydWUs\nIHRydWUsIHRydWUpOwogICAgICAgIGJhc2ljSGVscGVyKHRydWUsIGZhbHNl\nLCB0cnVlLCB0cnVlKTsKICAgICAgICBiYXNpY0hlbHBlcih0cnVlLCB0cnVl\nLCB0cnVlLCB0cnVlKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCB0ZXN0Rmx1\nc2hTdG9yZVByaW1hcnlOb0NoYW5nZXMoKSB7CiAgICAgICAgYmFzaWNIZWxw\nZXIoZmFsc2UsIGZhbHNlLCBmYWxzZSwgZmFsc2UpOwogICAgICAgIGJhc2lj\nSGVscGVyKGZhbHNlLCB0cnVlLCBmYWxzZSwgZmFsc2UpOwogICAgICAgIGJh\nc2ljSGVscGVyKHRydWUsIGZhbHNlLCBmYWxzZSwgZmFsc2UpOwogICAgICAg\nIGJhc2ljSGVscGVyKHRydWUsIHRydWUsIGZhbHNlLCBmYWxzZSk7CiAgICB9\nCgogICAgcHVibGljIHZvaWQgdGVzdEpkb1ByZVN0b3JlV2l0aE1vZGlmaWNh\ndGlvbkJlZm9yZUZsdXNoKCkgewogICAgICAgIHRqcHN3bUhlbHBlcih0cnVl\nKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCB0ZXN0SmRvUHJlU3RvcmVXaXRo\nTW9kaWZpY2F0aW9uQWZ0ZXJGbHVzaCgpIHsKICAgICAgICB0anBzd21IZWxw\nZXIoZmFsc2UpOwogICAgfQoKICAgIHByaXZhdGUgdm9pZCB0anBzd21IZWxw\nZXIoYm9vbGVhbiBiZWZvcmUpIHsKICAgICAgICAvLyBzZXQgcmV0YWludmFs\ndWVzIHRvIGZhbHNlIHNvIHRoYXQgd2UgY2FuIGVuc3VyZSB0aGF0IHRoZQog\nICAgICAgIC8vIGRhdGEgaW4gdGhlIGRhdGFiYXNlIGlzIGNvcnJlY3QsIGFu\nZCB0aGF0IHdlJ3JlIG5vdCBqdXN0CiAgICAgICAgLy8gdGVzdGluZyB0aGF0\nIHRoZSBKVk0gZGF0YSBpcyBjb3JyZWN0LgogICAgICAgIE9wZW5KUEFFbnRp\ndHlNYW5hZ2VyIHBtID0gZ2V0UE0odHJ1ZSwgZmFsc2UpOwogICAgICAgIHN0\nYXJ0VHgocG0pOwogICAgICAgIE1vZEluc3RhbmNlQ2FsbGJhY2tUZXN0cyBh\nID0gbmV3IE1vZEluc3RhbmNlQ2FsbGJhY2tUZXN0cygiZm9vIiwgMTApOwog\nICAgICAgIHBtLnBlcnNpc3QoYSk7CgogICAgICAgIC8vIGJ5IHNldHRpbmcg\ndGhlIG5hbWUgdG8gJ2JhcicsIHRoZSBqZG9QcmVTdG9yZSgpIGludm9jYXRp\nb24KICAgICAgICAvLyB3aWxsIHNldCB0aGUgcGFyZW50IHRvIGEgbmV3IG9i\namVjdC4gVGhpcyBlbnN1cmVzIHRoYXQgbmV3CiAgICAgICAgLy8gb2JqZWN0\ncyBjcmVhdGVkIGluIGpkb1ByZVN0b3JlKCkgbWFrZSB0aGVpciB3YXkgaW50\nbyB0aGUgREIKICAgICAgICAvLyBkdXJpbmcgY29tbWl0LgogICAgICAgIGlm\nIChiZWZvcmUpIHsKICAgICAgICAgICAgYS5zZXRTdHJpbmdGaWVsZCgiYmFy\nIik7CiAgICAgICAgICAgIHBtLmZsdXNoKCk7CiAgICAgICAgfSBlbHNlIHsK\nICAgICAgICAgICAgcG0uZmx1c2goKTsKICAgICAgICAgICAgYS5zZXRTdHJp\nbmdGaWVsZCgiYmFyIik7CiAgICAgICAgfQogICAgICAgIGVuZFR4KHBtKTsK\nICAgICAgICBhc3NlcnRUcnVlKCJhLnByZVN0b3JlQ2FsbGVkIGlzIGZhbHNl\nIiwgYS5wcmVTdG9yZUNhbGxlZCk7CiAgICAgICAgYXNzZXJ0Tm90TnVsbCgi\nYS5nZXRPbmVPbmUgaXMgbnVsbCIsIGEuZ2V0T25lT25lKCkpOwogICAgICAg\nIGFzc2VydFRydWUoImdldE9uZU9uZSgpLmdldHN0cm5nZmxkLmVxdWFscyhq\nZG9QcmVzdG9yZSkgaXMgZmFsc2UiLAogICAgICAgICAgICBhLmdldE9uZU9u\nZSgpLmdldFN0cmluZ0ZpZWxkKCkuZXF1YWxzKCJqZG9QcmVTdG9yZSIpKTsK\nICAgIH0KCiAgICBwdWJsaWMgdm9pZCB0ZXN0T25lVG9PbmVCZWZvcmUoKSB7\nCiAgICAgICAgdG90b0hlbHBlcih0cnVlLCB0cnVlLCBmYWxzZSk7CiAgICAg\nICAgdG90b0hlbHBlcih0cnVlLCBmYWxzZSwgZmFsc2UpOwogICAgICAgIHRv\ndG9IZWxwZXIodHJ1ZSwgdHJ1ZSwgdHJ1ZSk7CiAgICAgICAgdG90b0hlbHBl\ncih0cnVlLCBmYWxzZSwgdHJ1ZSk7CiAgICB9CgogICAgcHVibGljIHZvaWQg\ndGVzdE9uZVRvT25lQWZ0ZXIoKSB7CiAgICAgICAgdG90b0hlbHBlcihmYWxz\nZSwgdHJ1ZSwgZmFsc2UpOwogICAgICAgIHRvdG9IZWxwZXIoZmFsc2UsIGZh\nbHNlLCBmYWxzZSk7CiAgICAgICAgdG90b0hlbHBlcihmYWxzZSwgdHJ1ZSwg\ndHJ1ZSk7CiAgICAgICAgdG90b0hlbHBlcihmYWxzZSwgZmFsc2UsIHRydWUp\nOwogICAgfQoKICAgIHByaXZhdGUgdm9pZCB0b3RvSGVscGVyKGJvb2xlYW4g\nYmVmb3JlLCBib29sZWFuIHBlcnNpc3QsCiAgICAgICAgYm9vbGVhbiBtdWx0\naSkgewogICAgICAgIC8vIHNldCByZXRhaW52YWx1ZXMgdG8gZmFsc2Ugc28g\ndGhhdCB3ZSBjYW4gZW5zdXJlIHRoYXQgdGhlCiAgICAgICAgLy8gZGF0YSBp\nbiB0aGUgZGF0YWJhc2UgaXMgY29ycmVjdCwgYW5kIHRoYXQgd2UncmUgbm90\nIGp1c3QKICAgICAgICAvLyB0ZXN0aW5nIHRoYXQgdGhlIEpWTSBkYXRhIGlz\nIGNvcnJlY3QuCiAgICAgICAgT3BlbkpQQUVudGl0eU1hbmFnZXIgcG0gPSBn\nZXRQTSh0cnVlLCBmYWxzZSk7CiAgICAgICAgc3RhcnRUeChwbSk7CiAgICAg\nICAgTW9kSW5zdGFuY2VDYWxsYmFja1Rlc3RzIGEgPSBuZXcgTW9kSW5zdGFu\nY2VDYWxsYmFja1Rlc3RzKCJmb28iLCAxMCk7CiAgICAgICAgcG0ucGVyc2lz\ndChhKTsKCiAgICAgICAgTW9kUnVudGltZVRlc3QxIHBhcmVudCA9IG5ldyBN\nb2RSdW50aW1lVGVzdDEoImJheiIsIDExKTsKICAgICAgICBpZiAoIWJlZm9y\nZSkKICAgICAgICAgICAgcG0uZmx1c2goKTsKCiAgICAgICAgaWYgKHBlcnNp\nc3QpCiAgICAgICAgICAgIHBtLnBlcnNpc3QocGFyZW50KTsKCiAgICAgICAg\nYS5zZXRPbmVPbmUocGFyZW50KTsKCiAgICAgICAgaWYgKGJlZm9yZSkKICAg\nICAgICAgICAgcG0uZmx1c2goKTsKCiAgICAgICAgTW9kUnVudGltZVRlc3Qx\nIG9sZFBhcmVudCA9IG51bGw7CiAgICAgICAgaWYgKG11bHRpKSB7CiAgICAg\nICAgICAgIG9sZFBhcmVudCA9IHBhcmVudDsKICAgICAgICAgICAgcGFyZW50\nID0gbmV3IE1vZFJ1bnRpbWVUZXN0MSgibmV3UGFyZW50IiwgMTIpOwoKICAg\nICAgICAgICAgaWYgKCFiZWZvcmUpCiAgICAgICAgICAgICAgICBwbS5mbHVz\naCgpOwoKICAgICAgICAgICAgaWYgKHBlcnNpc3QpCiAgICAgICAgICAgICAg\nICBwbS5wZXJzaXN0KHBhcmVudCk7CgogICAgICAgICAgICBhLnNldE9uZU9u\nZShwYXJlbnQpOwoKICAgICAgICAgICAgaWYgKGJlZm9yZSkKICAgICAgICAg\nICAgICAgIHBtLmZsdXNoKCk7CiAgICAgICAgfQoKICAgICAgICBlbmRUeChw\nbSk7CiAgICAgICAgYXNzZXJ0VHJ1ZSgiYS5wcmVTdG9yZUNhbGxlZCBpcyBm\nYWxzZSIsIGEucHJlU3RvcmVDYWxsZWQpOwogICAgICAgIGFzc2VydE5vdE51\nbGwoImEuZ2V0T25lT25lIGlzIG51bGwiLCBhLmdldE9uZU9uZSgpKTsKICAg\nICAgICBpZiAoIW11bHRpKQogICAgICAgICAgICBhc3NlcnRUcnVlKCJhLmdl\ndE9uZU9uZSgpLmdldFN0cmluZ0ZpZWxkKCkuZXF1YWxzKGJheikgaXMgZmFs\nc2UiLAogICAgICAgICAgICAgICAgYS5nZXRPbmVPbmUoKS5nZXRTdHJpbmdG\naWVsZCgpLmVxdWFscygiYmF6IikpOwogICAgICAgIGVsc2UgewogICAgICAg\nICAgICBhc3NlcnRUcnVlKAogICAgICAgICAgICAgICAgImEuZ2V0T25lT25l\nKCkuZ2V0U3RyaW5nRmllbGQoKS5lcXVhbHMobmV3UGFyZW50KSBpcyBmYWxz\nZSIsCiAgICAgICAgICAgICAgICBhLmdldE9uZU9uZSgpLmdldFN0cmluZ0Zp\nZWxkKCkuZXF1YWxzKCJuZXdQYXJlbnQiKSk7CgogICAgICAgICAgICAvLyBp\nZiBtdWx0aSwgdGhlbiB3ZSByZWFsbHkgc2hvdWxkIGRlbGV0ZSB0aGUgYmF6\nCiAgICAgICAgICAgIC8vIHBhcmVudC4gVGhpcyBpc24ndCBoYXBwZW5pbmcg\ncmlnaHQgbm93LgogICAgICAgICAgICAvLyAjIyMgc2hvdWxkIGJlIGEgYnVn\nCiAgICAgICAgICAgIC8vYXNzZXJ0VHJ1ZSAoSkRPSGVscGVyLmlzRGVsZXRl\nZCAob2xkUGFyZW50KSk7CiAgICAgICAgfQogICAgfQoKICAgIHByaXZhdGUg\ndm9pZCBhc3NlcnRTdGF0ZShPYmplY3QgbywgUENTdGF0ZSBzdGF0ZSwgT3Bl\nbkpQQUVudGl0eU1hbmFnZXIgcG0pIHsKICAgICAgICBhc3NlcnRFcXVhbHMo\nc3RhdGUsIGdldFN0YXRlTWFuYWdlcihvLCBwbSkuZ2V0UENTdGF0ZSgpKTsK\nICAgIH0KCiAgICBwcml2YXRlIHZvaWQgY29tbWl0QW5kVGVzdERlbGV0ZShP\ncGVuSlBBRW50aXR5TWFuYWdlciBwbSwgT2JqZWN0IG8pIHsKICAgICAgICBP\nYmplY3Qgb2lkID0gcG0uZ2V0T2JqZWN0SWQobyk7CiAgICAgICAgZW5kVHgo\ncG0pOwoKICAgICAgICBwbSA9IGdldFBNKCk7CiAgICAgICAgdHJ5IHsKICAg\nICAgICAgICAgcG0uZmluZChPYmplY3QuY2xhc3MsIG9pZCk7CiAgICAgICAg\nICAgIGZhaWwoInNob3VsZCBub3QgYmUgYWJsZSB0byBsb2FkIGRlbGV0ZWQg\nb2JqZWN0Iik7CiAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAg\nICAgICAgICAgLy8gZXhwZWN0ZWQgY2FzZQogICAgICAgIH0KICAgIH0KCiAg\nICBwdWJsaWMgdm9pZCB0ZXN0RGVsZXRlTmV3KCkgewogICAgICAgIE9wZW5K\nUEFFbnRpdHlNYW5hZ2VyIHBtID0gZ2V0UE0odHJ1ZSwgZmFsc2UpOwogICAg\nICAgIHN0YXJ0VHgocG0pOwogICAgICAgIE1vZFJ1bnRpbWVUZXN0MSBhID0g\nbmV3IE1vZFJ1bnRpbWVUZXN0MSgiZm9vIiwgMTApOwogICAgICAgIHBtLnBl\ncnNpc3QoYSk7CiAgICAgICAgcG0ucmVtb3ZlKGEpOwogICAgICAgIGFzc2Vy\ndFN0YXRlKGEsIFBDU3RhdGUuUE5FV0RFTEVURUQsIHBtKTsKICAgIH0KCiAg\nICBwdWJsaWMgdm9pZCB0ZXN0T3B0aW1pc3RpY0xvY2tHaXZlc0NvcnJlY3RF\ncnJvcigpIHsKICAgICAgICBPcGVuSlBBRW50aXR5TWFuYWdlciBwbTEgPSBn\nZXRQTSh0cnVlLCBmYWxzZSk7CiAgICAgICAgT3BlbkpQQUVudGl0eU1hbmFn\nZXIgcG0yID0gZ2V0UE0odHJ1ZSwgZmFsc2UpOwoKICAgICAgICBNb2RSdW50\naW1lVGVzdDEgYTEgPSBuZXcgTW9kUnVudGltZVRlc3QxKCJmb28iLCAxMCk7\nCiAgICAgICAgc3RhcnRUeChwbTEpOwogICAgICAgIHBtMS5wZXJzaXN0KGEx\nKTsKICAgICAgICBlbmRUeChwbTEpOwoKICAgICAgICBNb2RSdW50aW1lVGVz\ndDEgYTIgPSAoTW9kUnVudGltZVRlc3QxKQogICAgICAgICAgICBwbTIuZmlu\nZChNb2RSdW50aW1lVGVzdDEuY2xhc3MsIHBtMi5nZXRPYmplY3RJZChhMSkp\nOwogICAgICAgIHN0YXJ0VHgocG0yKTsKICAgICAgICBhMi5zZXRTdHJpbmdG\naWVsZCgiZm9vYmFyIik7CiAgICAgICAgZW5kVHgocG0yKTsKCiAgICAgICAg\nc3RhcnRUeChwbTEpOwogICAgICAgIGExLnNldFN0cmluZ0ZpZWxkKCJmb29i\nYXJiYXoiKTsKICAgICAgICB0cnkgewogICAgICAgICAgICBlbmRUeChwbTEp\nOwogICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBvbGUpIHsKICAgICAgICAg\nICAgLy8gZXhwZWN0ZWQgY2FzZQogICAgICAgIH0gZmluYWxseSB7CiAgICAg\nICAgICAgIHJvbGxiYWNrVHgocG0xKTsKCiAgICAgICAgICAgIHBtMS5jbG9z\nZSgpOwogICAgICAgICAgICBwbTIuY2xvc2UoKTsKICAgICAgICB9CiAgICB9\nCgogICAgLyoqCiAgICAgKiBWZXJpZnkgdGhhdCBmbHVzaGVzIHRvIHRoZSBk\nYXRhc3RvcmUgYXJlIGlzb2xhdGVkIGZyb20gb3RoZXIKICAgICAqIFBlcnNp\nc3RlbmNlTWFuYWdlcnMuIFRoaXMgaXMgbW9zdGx5IGEgdGVzdCBvZiB0aGUg\ndW5kZXJseWluZwogICAgICogZGF0YXN0b3JlJ3MgdHJhbnNhY3Rpb25hbCBp\nc29sYXRpb24gY2FwYWJpbGl0aWVzLgogICAgICogPHAvPgogICAgICogRGlz\nYWJsZWQ6IHRoaXMgaGFuZ3Mgb24gU3liYXNlLgogICAgICovCiAgICBwdWJs\naWMgdm9pZCBYWFh0ZXN0Rmx1c2hlc0FyZUlzb2xhdGVkKCkgewogICAgICAg\nIGZpbmFsIFN0cmluZyBuYW1lID0gInRlc3RGbHVzaGVzQXJlSXNvbGF0ZWQi\nOwoKICAgICAgICBkZWxldGVBbGwoTW9kUnVudGltZVRlc3QxLmNsYXNzKTsK\nCiAgICAgICAgT3BlbkpQQUVudGl0eU1hbmFnZXIgZmx1c2hQTSA9IGdldFBN\nKHRydWUsIGZhbHNlKTsKICAgICAgICBzdGFydFR4KGZsdXNoUE0pOwoKICAg\nICAgICBPcGVuSlBBRW50aXR5TWFuYWdlciByZWFkUE0gPSBnZXRQTSh0cnVl\nLCBmYWxzZSk7CiAgICAgICAgc3RhcnRUeChyZWFkUE0pOwoKICAgICAgICBh\nc3NlcnRTaXplKDAsIGZsdXNoUE0uY3JlYXRlTmF0aXZlUXVlcnkoInN0cmlu\nZ0ZpZWxkID09ICciICsgbmFtZSArICInIiwKICAgICAgICAgICAgTW9kUnVu\ndGltZVRlc3QxLmNsYXNzKSk7CiAgICAgICAgYXNzZXJ0U2l6ZSgwLCByZWFk\nUE0uY3JlYXRlTmF0aXZlUXVlcnkoInN0cmluZ0ZpZWxkID09ICciICsgbmFt\nZSArICInIiwKICAgICAgICAgICAgTW9kUnVudGltZVRlc3QxLmNsYXNzKSk7\nCgogICAgICAgIE1vZFJ1bnRpbWVUZXN0MSBhID0gbmV3IE1vZFJ1bnRpbWVU\nZXN0MShuYW1lLCByYW5kb21JbnQoKS5pbnRWYWx1ZSgpKTsKCiAgICAgICAg\nZmx1c2hQTS5wZXJzaXN0KGEpOwoKICAgICAgICBhc3NlcnRTaXplKDAsIHJl\nYWRQTS5jcmVhdGVOYXRpdmVRdWVyeSgibmFtZSA9PSAnIiArIG5hbWUgKyAi\nJyIsCiAgICAgICAgICAgIE1vZFJ1bnRpbWVUZXN0MS5jbGFzcykpOwoKICAg\nICAgICBmbHVzaFBNLmZsdXNoKCk7CgogICAgICAgIC8vIG1ha2Ugc3VyZSB0\naGUgb3RoZXIgcG0gZG9lc24ndCBzZWUgdGhlIGZsdXNoZWQgb2JqZWN0CiAg\nICAgICAgYXNzZXJ0U2l6ZSgwLCByZWFkUE0uY3JlYXRlTmF0aXZlUXVlcnko\nIm5hbWUgPT0gJyIgKyBuYW1lICsgIiciLAogICAgICAgICAgICBNb2RSdW50\naW1lVGVzdDEuY2xhc3MpKTsKCiAgICAgICAgZmx1c2hQTS5yZW1vdmUoYSk7\nCgogICAgICAgIGFzc2VydFNpemUoMCwgZmx1c2hQTS5jcmVhdGVOYXRpdmVR\ndWVyeSgibmFtZSA9PSAnIiArIG5hbWUgKyAiJyIsCiAgICAgICAgICAgIE1v\nZFJ1bnRpbWVUZXN0MS5jbGFzcykpOwogICAgICAgIGFzc2VydFNpemUoMCwg\ncmVhZFBNLmNyZWF0ZU5hdGl2ZVF1ZXJ5KCJuYW1lID09ICciICsgbmFtZSAr\nICInIiwKICAgICAgICAgICAgTW9kUnVudGltZVRlc3QxLmNsYXNzKSk7Cgog\nICAgICAgIGVuZFR4KGZsdXNoUE0pOwogICAgICAgIGVuZEVtKGZsdXNoUE0p\nOwoKICAgICAgICBlbmRUeChyZWFkUE0pOwogICAgICAgIGVuZEVtKHJlYWRQ\nTSk7CiAgICB9CgogICAgcHVibGljIHZvaWQgdGVzdEVtcHR5Rmx1c2goKSB7\nCiAgICAgICAgT3BlbkpQQUVudGl0eU1hbmFnZXIgcG0gPSBnZXRQTSgpOwog\nICAgICAgIFRMaXN0ZW5lciBsaXN0ZW5lciA9IG5ldyBUTGlzdGVuZXIoKTsK\nICAgICAgICAoKE9wZW5KUEFFbnRpdHlNYW5hZ2VyU1BJKSBwbSkuYWRkVHJh\nbnNhY3Rpb25MaXN0ZW5lcihsaXN0ZW5lcik7CiAgICAgICAgc3RhcnRUeChw\nbSk7CiAgICAgICAgTW9kUnVudGltZVRlc3QxIHBjID0gbmV3IE1vZFJ1bnRp\nbWVUZXN0MSgpOwogICAgICAgIHBtLnBlcnNpc3QocGMpOwogICAgICAgIHBt\nLmZsdXNoKCk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKDEsIGxpc3RlbmVyLmZs\ndXNoZXMpOwogICAgICAgIGFzc2VydEVxdWFscygwLCBsaXN0ZW5lci5jb21t\naXRzKTsKCiAgICAgICAgcG0uZmx1c2goKTsKICAgICAgICBhc3NlcnRFcXVh\nbHMoMSwgbGlzdGVuZXIuZmx1c2hlcyk7CiAgICAgICAgYXNzZXJ0RXF1YWxz\nKDAsIGxpc3RlbmVyLmNvbW1pdHMpOwoKICAgICAgICBwYy5zZXRJbnRGaWVs\nZCgzKTsKICAgICAgICBwbS5mbHVzaCgpOwogICAgICAgIGFzc2VydEVxdWFs\ncygyLCBsaXN0ZW5lci5mbHVzaGVzKTsKICAgICAgICBhc3NlcnRFcXVhbHMo\nMCwgbGlzdGVuZXIuY29tbWl0cyk7CgogICAgICAgIGVuZFR4KHBtKTsKICAg\nICAgICBhc3NlcnRFcXVhbHMoMiwgbGlzdGVuZXIuZmx1c2hlcyk7CiAgICAg\nICAgYXNzZXJ0RXF1YWxzKDEsIGxpc3RlbmVyLmNvbW1pdHMpOwoKICAgICAg\nICBlbmRFbShwbSk7CiAgICB9CgogICAgcHVibGljIHZvaWQgdGVzdEVtcHR5\nUm9sbGJhY2soKSB7CiAgICAgICAgT3BlbkpQQUVudGl0eU1hbmFnZXIgcG0g\nPSBnZXRQTSgpOwogICAgICAgIFRMaXN0ZW5lciBsaXN0ZW5lciA9IG5ldyBU\nTGlzdGVuZXIoKTsKICAgICAgICAoKE9wZW5KUEFFbnRpdHlNYW5hZ2VyU1BJ\nKSBwbSkuYWRkVHJhbnNhY3Rpb25MaXN0ZW5lcihsaXN0ZW5lcik7CiAgICAg\nICAgc3RhcnRUeChwbSk7CiAgICAgICAgcG0uZmx1c2goKTsKICAgICAgICBy\nb2xsYmFja1R4KHBtKTsKICAgICAgICBhc3NlcnRFcXVhbHMoMCwgbGlzdGVu\nZXIuZmx1c2hlcyk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKDAsIGxpc3RlbmVy\nLmNvbW1pdHMpOwogICAgICAgIGVuZEVtKHBtKTsKICAgIH0KCiAgICBwdWJs\naWMgdm9pZCB0ZXN0RW1wdHlDb21taXQoKSB7CiAgICAgICAgT3BlbkpQQUVu\ndGl0eU1hbmFnZXIgcG0gPSBnZXRQTSgpOwogICAgICAgIFRMaXN0ZW5lciBs\naXN0ZW5lciA9IG5ldyBUTGlzdGVuZXIoKTsKICAgICAgICAoKE9wZW5KUEFF\nbnRpdHlNYW5hZ2VyU1BJKSBwbSkuYWRkVHJhbnNhY3Rpb25MaXN0ZW5lcihs\naXN0ZW5lcik7CiAgICAgICAgc3RhcnRUeChwbSk7CiAgICAgICAgZW5kVHgo\ncG0pOwogICAgICAgIGFzc2VydEVxdWFscygwLCBsaXN0ZW5lci5mbHVzaGVz\nKTsKICAgICAgICBhc3NlcnRFcXVhbHMoMSwgbGlzdGVuZXIuY29tbWl0cyk7\nCiAgICAgICAgZW5kRW0ocG0pOwogICAgfQoKICAgIHByaXZhdGUgc3RhdGlj\nIGNsYXNzIFRMaXN0ZW5lcgogICAgICAgIGV4dGVuZHMgQWJzdHJhY3RUcmFu\nc2FjdGlvbkxpc3RlbmVyIHsKCiAgICAgICAgcHVibGljIGludCBmbHVzaGVz\nID0gMDsKICAgICAgICBwdWJsaWMgaW50IGNvbW1pdHMgPSAwOwoKICAgICAg\nICBwcm90ZWN0ZWQgdm9pZCBldmVudE9jY3VycmVkKFRyYW5zYWN0aW9uRXZl\nbnQgZXZlbnQpIHsKICAgICAgICAgICAgaWYgKGV2ZW50LmdldFR5cGUoKSA9\nPSBldmVudC5CRUZPUkVfRkxVU0gpCiAgICAgICAgICAgICAgICBmbHVzaGVz\nKys7CiAgICAgICAgICAgIGVsc2UgaWYgKGV2ZW50LmdldFR5cGUoKSA9PSBl\ndmVudC5CRUZPUkVfQ09NTUlUKQogICAgICAgICAgICAgICAgY29tbWl0cysr\nOwogICAgICAgIH0KICAgIH0KfQo=\n","encoding":"base64"}

