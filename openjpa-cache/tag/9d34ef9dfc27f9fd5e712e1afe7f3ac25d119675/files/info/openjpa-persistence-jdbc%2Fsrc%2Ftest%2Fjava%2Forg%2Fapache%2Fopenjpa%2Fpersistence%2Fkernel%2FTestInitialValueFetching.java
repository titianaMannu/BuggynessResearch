{"sha":"86a31b229dc874ef5ad9cb8192646e0b7227b1d0","node_id":"MDQ6QmxvYjIwNjM2NDo4NmEzMWIyMjlkYzg3NGVmNWFkOWNiODE5MjY0NmUwYjcyMjdiMWQw","size":6514,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/86a31b229dc874ef5ad9cb8192646e0b7227b1d0","content":"LyoKICogVGVzdEluaXRpYWxWYWx1ZUZldGNoaW5nLmphdmEKICoKICogQ3Jl\nYXRlZCBvbiBPY3RvYmVyIDEyLCAyMDA2LCAxMTo1OCBBTQogKgogKiBUbyBj\naGFuZ2UgdGhpcyB0ZW1wbGF0ZSwgY2hvb3NlIFRvb2xzIHwgVGVtcGxhdGUg\nTWFuYWdlcgogKiBhbmQgb3BlbiB0aGUgdGVtcGxhdGUgaW4gdGhlIGVkaXRv\nci4KICovCi8qCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUg\nRm91bmRhdGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmli\ndXRvciBsaWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxl\nCiAqIGRpc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFs\nIGluZm9ybWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlw\nLiAgVGhlIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVy\nIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGlj\nZW5zZSIpOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBj\nb21wbGlhbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFp\nbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogaHR0cDovL3d3dy5h\ncGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyBy\nZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3Jp\ndGluZywKICogc29mdHdhcmUgZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vu\nc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4KICogIkFTIElTIiBCQVNJUywgV0lU\nSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZCiAqIEtJTkQs\nIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuICBTZWUgdGhlIExpY2Vuc2Ug\nZm9yIHRoZQogKiBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlz\nc2lvbnMgYW5kIGxpbWl0YXRpb25zCiAqIHVuZGVyIHRoZSBMaWNlbnNlLiAg\nICAKICovCnBhY2thZ2Ugb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNl\nLmtlcm5lbDsKCmltcG9ydCBqYXZhLnV0aWwuRGF0ZTsKaW1wb3J0IGphdmEu\ndXRpbC5IYXNoTWFwOwppbXBvcnQgamF2YS51dGlsLkxpc3Q7CmltcG9ydCBq\nYXZhLnV0aWwuTWFwOwoKCgppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnBl\ncnNpc3RlbmNlLmtlcm5lbC5jb21tb24uYXBwcy5SdW50aW1lVGVzdDE7Cgpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5PcGVuSlBBU3RhdGVN\nYW5hZ2VyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuRmllbGRN\nZXRhRGF0YTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5j\nZS5PcGVuSlBBRW50aXR5TWFuYWdlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5wZXJzaXN0ZW5jZS5PcGVuSlBBRW50aXR5TWFuYWdlckZhY3Rvcnk7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuT3BlbkpQ\nQVF1ZXJ5OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNl\nLlJlc3RvcmVTdGF0ZVR5cGU7CgpwdWJsaWMgY2xhc3MgVGVzdEluaXRpYWxW\nYWx1ZUZldGNoaW5nIGV4dGVuZHMgQmFzZUtlcm5lbFRlc3QgewoKICAgIC8q\nKgogICAgICogQ3JlYXRlcyBhIG5ldyBpbnN0YW5jZSBvZiBUZXN0SW5pdGlh\nbFZhbHVlRmV0Y2hpbmcKICAgICAqLwogICAgcHVibGljIFRlc3RJbml0aWFs\nVmFsdWVGZXRjaGluZyhTdHJpbmcgbmFtZSkgewogICAgICAgIHN1cGVyKG5h\nbWUpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldFVwKCkgewogICAgICAg\nIGRlbGV0ZUFsbChSdW50aW1lVGVzdDEuY2xhc3MpOwogICAgICAgIE9wZW5K\nUEFFbnRpdHlNYW5hZ2VyIHBtID0gZ2V0UE0oKTsKICAgICAgICBzdGFydFR4\nKHBtKTsKICAgICAgICBSdW50aW1lVGVzdDEgcnQxID0gbmV3IFJ1bnRpbWVU\nZXN0MSgiVGVzdEluaXRpYWxWYWx1ZUZldGNoaW5nIiwgMTApOwogICAgICAg\nIHBtLnBlcnNpc3QocnQxKTsKCiAgICAgICAgcnQxLnNldERhdGVGaWVsZChu\nZXcgRGF0ZSgpKTsKICAgICAgICBlbmRUeChwbSk7CiAgICAgICAgZW5kRW0o\ncG0pOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHRlc3RJbml0aWFsVmFsdWVT\ndHJpbmcoKSB7CiAgICAgICAgT3BlbkpQQUVudGl0eU1hbmFnZXIgcG0gPSBn\nZXRQTSgpOwogICAgICAgIHN0YXJ0VHgocG0pOwogICAgICAgIFJ1bnRpbWVU\nZXN0MSBydDEgPSBnZXRPYmplY3QocG0pOwogICAgICAgIE9wZW5KUEFTdGF0\nZU1hbmFnZXIgc20gPSBnZXRTdGF0ZU1hbmFnZXIocnQxLCBwbSk7CiAgICAg\nICAgRmllbGRNZXRhRGF0YSBmbWQgPSBzbS5nZXRNZXRhRGF0YSgpLmdldEZp\nZWxkKCJzdHJpbmdGaWVsZCIpOwogICAgICAgIGFzc2VydEVxdWFscygiVGVz\ndEluaXRpYWxWYWx1ZUZldGNoaW5nIiwKICAgICAgICAgICAgc20uZmV0Y2hJ\nbml0aWFsRmllbGQoZm1kLmdldEluZGV4KCkpKTsKICAgICAgICBydDEuc2V0\nU3RyaW5nRmllbGQoIlRlc3RJbml0aWFsVmFsdWVGZXRjaGluZy0yIik7CiAg\nICAgICAgYXNzZXJ0RXF1YWxzKCJUZXN0SW5pdGlhbFZhbHVlRmV0Y2hpbmci\nLAogICAgICAgICAgICBzbS5mZXRjaEluaXRpYWxGaWVsZChmbWQuZ2V0SW5k\nZXgoKSkpOwogICAgICAgIGVuZFR4KHBtKTsKICAgICAgICBhc3NlcnRFcXVh\nbHMoIlRlc3RJbml0aWFsVmFsdWVGZXRjaGluZy0yIiwKICAgICAgICAgICAg\nc20uZmV0Y2hJbml0aWFsRmllbGQoZm1kLmdldEluZGV4KCkpKTsKICAgICAg\nICBlbmRFbShwbSk7CiAgICB9CgogICAgcHVibGljIHZvaWQgdGVzdEluaXRp\nYWxWYWx1ZUludCgpIHsKICAgICAgICBPcGVuSlBBRW50aXR5TWFuYWdlciBw\nbSA9IGdldFBNKCk7CiAgICAgICAgc3RhcnRUeChwbSk7CiAgICAgICAgUnVu\ndGltZVRlc3QxIHJ0MSA9IGdldE9iamVjdChwbSk7CiAgICAgICAgT3BlbkpQ\nQVN0YXRlTWFuYWdlciBzbSA9IGdldFN0YXRlTWFuYWdlcihydDEsIHBtKTsK\nICAgICAgICBGaWVsZE1ldGFEYXRhIGZtZCA9IHNtLmdldE1ldGFEYXRhKCku\nZ2V0RmllbGQoImludEZpZWxkMSIpOwogICAgICAgIGFzc2VydEVxdWFscygx\nMCwKICAgICAgICAgICAgKChJbnRlZ2VyKSBzbS5mZXRjaEluaXRpYWxGaWVs\nZChmbWQuZ2V0SW5kZXgoKSkpLmludFZhbHVlKCkpOwogICAgICAgIHJ0MS5z\nZXRJbnRGaWVsZDEoMTEpOwogICAgICAgIGFzc2VydEVxdWFscygxMCwKICAg\nICAgICAgICAgKChJbnRlZ2VyKSBzbS5mZXRjaEluaXRpYWxGaWVsZChmbWQu\nZ2V0SW5kZXgoKSkpLmludFZhbHVlKCkpOwogICAgICAgIGVuZFR4KHBtKTsK\nICAgICAgICBhc3NlcnRFcXVhbHMoMTEsCiAgICAgICAgICAgICgoSW50ZWdl\ncikgc20uZmV0Y2hJbml0aWFsRmllbGQoZm1kLmdldEluZGV4KCkpKS5pbnRW\nYWx1ZSgpKTsKICAgICAgICBlbmRFbShwbSk7CiAgICB9CgogICAgcHVibGlj\nIHZvaWQgdGVzdEluaXRpYWxWYWx1ZU11dGFibGVWYWx1ZUZhaWx1cmVzKCkg\newogICAgICAgIE1hcCBwcm9wcyA9IG5ldyBIYXNoTWFwKCk7CiAgICAgICAg\ncHJvcHMucHV0KCJvcGVuanBhLlJlc3RvcmVNdXRhYmxlVmFsdWVzIiwgImZh\nbHNlIik7CiAgICAgICAgT3BlbkpQQUVudGl0eU1hbmFnZXJGYWN0b3J5IHBt\nZiA9IChPcGVuSlBBRW50aXR5TWFuYWdlckZhY3RvcnkpCiAgICAgICAgICAg\nIGdldEVtZihwcm9wcyk7CgogICAgICAgIE9wZW5KUEFFbnRpdHlNYW5hZ2Vy\nIHBtID0gKE9wZW5KUEFFbnRpdHlNYW5hZ2VyKQogICAgICAgICAgICBwbWYu\nY3JlYXRlRW50aXR5TWFuYWdlcigpOwogICAgICAgIFJ1bnRpbWVUZXN0MSBy\ndDEgPSBnZXRPYmplY3QocG0pOwoKICAgICAgICBEYXRlIGQgPSBydDEuZ2V0\nRGF0ZUZpZWxkKCk7CiAgICAgICAgT3BlbkpQQVN0YXRlTWFuYWdlciBzbSA9\nIGdldFN0YXRlTWFuYWdlcihydDEsIHBtKTsKICAgICAgICBGaWVsZE1ldGFE\nYXRhIGZtZCA9IHNtLmdldE1ldGFEYXRhKCkuZ2V0RmllbGQoImRhdGVGaWVs\nZCIpOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIHNtLmZldGNoSW5pdGlh\nbEZpZWxkKGZtZC5nZXRJbmRleCgpKTsKICAgICAgICAgICAgZmFpbCgic2hv\ndWxkIGdldCBhbiBleGNlcHRpb24gaWYgUmVzdG9yZU11dGFibGVWYWx1ZXMg\naXMgZmFsc2UiKTsKICAgICAgICB9IGNhdGNoIChvcmcuYXBhY2hlLm9wZW5q\ncGEudXRpbC5Vc2VyRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgLy8gZXhw\nZWN0ZWQKICAgICAgICB9CiAgICAgICAgZW5kRW0ocG0pOwogICAgICAgIHBt\nZi5jbG9zZSgpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHRlc3RJbml0aWFs\nVmFsdWVEYXRlKCkgewogICAgICAgIE1hcCBwcm9wcyA9IG5ldyBIYXNoTWFw\nKCk7CiAgICAgICAgcHJvcHMucHV0KCJvcGVuanBhLlJlc3RvcmVTdGF0ZSIs\nICJhbGwiKTsKICAgICAgICBPcGVuSlBBRW50aXR5TWFuYWdlckZhY3Rvcnkg\ncG1mID0gKE9wZW5KUEFFbnRpdHlNYW5hZ2VyRmFjdG9yeSkKICAgICAgICAg\nICAgZ2V0RW1mKHByb3BzKTsKICAgICAgICBPcGVuSlBBRW50aXR5TWFuYWdl\nciBwbSA9IChPcGVuSlBBRW50aXR5TWFuYWdlcikKICAgICAgICAgICAgcG1m\nLmNyZWF0ZUVudGl0eU1hbmFnZXIoKTsKICAgICAgICBzdGFydFR4KHBtKTsK\nICAgICAgICBSdW50aW1lVGVzdDEgcnQxID0gZ2V0T2JqZWN0KHBtKTsKCiAg\nICAgICAgRGF0ZSBkID0gcnQxLmdldERhdGVGaWVsZCgpOwoKICAgICAgICBP\ncGVuSlBBU3RhdGVNYW5hZ2VyIHNtID0gZ2V0U3RhdGVNYW5hZ2VyKHJ0MSwg\ncG0pOwogICAgICAgIEZpZWxkTWV0YURhdGEgZm1kID0gc20uZ2V0TWV0YURh\ndGEoKS5nZXRGaWVsZCgiZGF0ZUZpZWxkIik7CiAgICAgICAgYXNzZXJ0RXF1\nYWxzKGQsIHNtLmZldGNoSW5pdGlhbEZpZWxkKGZtZC5nZXRJbmRleCgpKSk7\nCgogICAgICAgIC8vID09IHNob3VsZCBwYXNzIGhlcmUgc2luY2Ugd2UgaGF2\nZW4ndCBtYWRlIGFueSBtb2RpZmljYXRpb25zLgogICAgICAgIGFzc2VydFRy\ndWUoIm11dGFibGUgb2JqZWN0IGZhaWxzID09IHRlc3Q7IHNob3VsZCBub3Qi\nLAogICAgICAgICAgICBkID09IHNtLmZldGNoSW5pdGlhbEZpZWxkKGZtZC5n\nZXRJbmRleCgpKSk7CgogICAgICAgIERhdGUgZDIgPSBuZXcgRGF0ZSgpOwog\nICAgICAgIHJ0MS5zZXREYXRlRmllbGQoZDIpOwogICAgICAgIGFzc2VydEVx\ndWFscyhkLCBzbS5mZXRjaEluaXRpYWxGaWVsZChmbWQuZ2V0SW5kZXgoKSkp\nOwogICAgICAgIGVuZFR4KHBtKTsKICAgICAgICBhc3NlcnRFcXVhbHMoZDIs\nIHNtLmZldGNoSW5pdGlhbEZpZWxkKGZtZC5nZXRJbmRleCgpKSk7CiAgICAg\nICAgYXNzZXJ0VHJ1ZSgibXV0YWJsZSBvYmplY3QgcGFzc2VzID09IHRlc3Q7\nIHNob3VsZCBub3QiLAogICAgICAgICAgICBkMiAhPSBzbS5mZXRjaEluaXRp\nYWxGaWVsZChmbWQuZ2V0SW5kZXgoKSkpOwogICAgICAgIGVuZEVtKHBtKTsK\nICAgIH0KCiAgICBwdWJsaWMgdm9pZCB0ZXN0SW5pdGlhbFZhbHVlRXhjZXB0\naW9ucygpIHsKICAgICAgICBPcGVuSlBBRW50aXR5TWFuYWdlciBwbSA9IGdl\ndFBNKCk7CiAgICAgICAgcG0uc2V0UmVzdG9yZVN0YXRlKFJlc3RvcmVTdGF0\nZVR5cGUuTk9ORSk7CiAgICAgICAgc3RhcnRUeChwbSk7CiAgICAgICAgUnVu\ndGltZVRlc3QxIHJ0MSA9IGdldE9iamVjdChwbSk7CiAgICAgICAgT3BlbkpQ\nQVN0YXRlTWFuYWdlciBzbSA9IGdldFN0YXRlTWFuYWdlcihydDEsIHBtKTsK\nICAgICAgICBGaWVsZE1ldGFEYXRhIGZtZCA9IHNtLmdldE1ldGFEYXRhKCku\nZ2V0RmllbGQoInN0cmluZ0ZpZWxkIik7CiAgICAgICAgdHJ5IHsKICAgICAg\nICAgICAgc20uZmV0Y2hJbml0aWFsRmllbGQoZm1kLmdldEluZGV4KCkpOwog\nICAgICAgICAgICBmYWlsKCJleGNlcHRpb24gc2hvdWxkIGJlIHRocm93biBi\neSBLb2RvU00uZmV0Y2hJbml0aWFsRmllbGQiKTsKICAgICAgICB9IGNhdGNo\nIChvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5Vc2VyRXhjZXB0aW9uIGUpIHsK\nICAgICAgICAgICAgLy8gZXhwZWN0ZWQgY2FzZQogICAgICAgIH0KICAgICAg\nICBlbmRUeChwbSk7CiAgICAgICAgZW5kRW0ocG0pOwogICAgfQoKICAgIHBy\naXZhdGUgUnVudGltZVRlc3QxIGdldE9iamVjdChPcGVuSlBBRW50aXR5TWFu\nYWdlciBwbSkgewovLyAgICAgICAgcmV0dXJuIChSdW50aW1lVGVzdDEpICgo\nQ29sbGVjdGlvbikgCi8vICAgICAgICAJCXBtLmNyZWF0ZU5hdGl2ZVF1ZXJ5\nKCAic3RyaW5nRmllbGQgPT0gXCJUZXN0SW5pdGlhbFZhbHVlRmV0Y2hpbmdc\nIiIsUnVudGltZVRlc3QxLmNsYXNzKQovLyAgICAgICAgLmdldFJlc3VsdExp\nc3QoKSkuaXRlcmF0b3IoKS5uZXh0KCk7CgogICAgICAgIE9wZW5KUEFRdWVy\neSBxID0gcG0uY3JlYXRlUXVlcnkoCiAgICAgICAgICAgICJTRUxFQ1QgbyBG\nUk9NIFJ1bnRpbWVUZXN0MSBvIFdIRVJFIG8uc3RyaW5nRmllbGQgPSBcJ1Rl\nc3RJbml0aWFsVmFsdWVGZXRjaGluZ1wnIik7CiAgICAgICAgTGlzdCBsID0g\ncS5nZXRSZXN1bHRMaXN0KCk7CgogICAgICAgIHJldHVybiAoUnVudGltZVRl\nc3QxKSBsLml0ZXJhdG9yKCkubmV4dCgpOwogICAgfQp9Cg==\n","encoding":"base64"}

