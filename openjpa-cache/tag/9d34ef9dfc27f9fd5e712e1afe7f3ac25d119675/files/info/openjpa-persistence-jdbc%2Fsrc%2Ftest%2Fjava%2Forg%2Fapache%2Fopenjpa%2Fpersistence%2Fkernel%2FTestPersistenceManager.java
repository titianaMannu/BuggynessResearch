{"sha":"0dde414c9219454cf52756db24cc705364d851c2","node_id":"MDQ6QmxvYjIwNjM2NDowZGRlNDE0YzkyMTk0NTRjZjUyNzU2ZGIyNGNjNzA1MzY0ZDg1MWMy","size":14309,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/0dde414c9219454cf52756db24cc705364d851c2","content":"LyoKICogVGVzdE9wZW5KUEFFbnRpdHlNYW5hZ2VyLmphdmEKICoKICogQ3Jl\nYXRlZCBvbiBPY3RvYmVyIDEyLCAyMDA2LCA0OjQwIFBNCiAqCiAqIFRvIGNo\nYW5nZSB0aGlzIHRlbXBsYXRlLCBjaG9vc2UgVG9vbHMgfCBUZW1wbGF0ZSBN\nYW5hZ2VyCiAqIGFuZCBvcGVuIHRoZSB0ZW1wbGF0ZSBpbiB0aGUgZWRpdG9y\nLgogKi8KLyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBG\nb3VuZGF0aW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1\ndG9yIGxpY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUK\nICogZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwg\naW5mb3JtYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAu\nICBUaGUgQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIg\ndGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNl\nbnNlIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNv\nbXBsaWFuY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWlu\nIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFw\nYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJl\ncXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0\naW5nLAogKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5z\nZSBpcyBkaXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRI\nT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwg\nZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBm\nb3IgdGhlCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNz\naW9ucyBhbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAg\nIAogKi8KcGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2Uu\na2VybmVsOwoKaW1wb3J0IGphdmEuaW8uQnl0ZUFycmF5SW5wdXRTdHJlYW07\nCmltcG9ydCBqYXZhLmlvLkJ5dGVBcnJheU91dHB1dFN0cmVhbTsKaW1wb3J0\nIGphdmEuaW8uT2JqZWN0SW5wdXRTdHJlYW07CmltcG9ydCBqYXZhLmlvLk9i\namVjdE91dHB1dFN0cmVhbTsKaW1wb3J0IGphdmEudXRpbC5BcnJheUxpc3Q7\nCmltcG9ydCBqYXZhLnV0aWwuQ29sbGVjdGlvbjsKaW1wb3J0IGphdmEudXRp\nbC5JdGVyYXRvcjsKaW1wb3J0IGphdmEudXRpbC5MaXN0OwppbXBvcnQgamF2\nYXgucGVyc2lzdGVuY2UuRW50aXR5TWFuYWdlckZhY3Rvcnk7CmltcG9ydCBq\nYXZheC5wZXJzaXN0ZW5jZS5FbnRpdHlOb3RGb3VuZEV4Y2VwdGlvbjsKCgoK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5rZXJuZWwu\nY29tbW9uLmFwcHMuUnVudGltZVRlc3QxOwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLnBlcnNpc3RlbmNlLmtlcm5lbC5jb21tb24uYXBwcy5SdW50aW1l\nVGVzdDI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2Uu\na2VybmVsLmNvbW1vbi5hcHBzLlJ1bnRpbWVUZXN0NDsKaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS5rZXJuZWwuQnJva2VyRmFjdG9yeTsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuRGVsZWdhdGluZ0Jyb2tlckZhY3Rv\ncnk7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLlBDU3RhdGU7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuRXh0ZW50\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNlLkpQQUZh\nY2FkZUhlbHBlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0\nZW5jZS5PcGVuSlBBRW50aXR5TWFuYWdlcjsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS5wZXJzaXN0ZW5jZS5PcGVuSlBBRW50aXR5TWFuYWdlckZhY3Rv\ncnk7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5JZDsKCnB1Ymxp\nYyBjbGFzcyBUZXN0UGVyc2lzdGVuY2VNYW5hZ2VyIGV4dGVuZHMgQmFzZUtl\ncm5lbFRlc3QgewoKICAgIHByaXZhdGUgaW50IF9pZCA9IDA7CiAgICBwcml2\nYXRlIGludCBfaWQyID0gMDsKCiAgICBwdWJsaWMgVGVzdFBlcnNpc3RlbmNl\nTWFuYWdlcihTdHJpbmcgbmFtZSkgewogICAgICAgIHN1cGVyKG5hbWUpOwog\nICAgfQoKICAgIC8qKgogICAgICogQ3JlYXRlcyBhIG5ldyBpbnN0YW5jZSBv\nZiBUZXN0T3BlbkpQQUVudGl0eU1hbmFnZXIKICAgICAqLwogICAgcHVibGlj\nIFRlc3RQZXJzaXN0ZW5jZU1hbmFnZXIoKSB7CiAgICB9CgogICAgcHVibGlj\nIHZvaWQgc2V0VXAoKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBkZWxl\ndGVBbGwoUnVudGltZVRlc3QxLmNsYXNzKTsKICAgICAgICBkZWxldGVBbGwo\nUnVudGltZVRlc3QyLmNsYXNzKTsKCiAgICAgICAgT3BlbkpQQUVudGl0eU1h\nbmFnZXIgcG0gPSBnZXRQTSgpOwogICAgICAgIHN0YXJ0VHgocG0pOwoKICAg\nICAgICBSdW50aW1lVGVzdDEgYSA9IG5ldyBSdW50aW1lVGVzdDEoIlNUUklO\nRyIsIDEwKTsKICAgICAgICBSdW50aW1lVGVzdDIgYiA9IG5ldyBSdW50aW1l\nVGVzdDIoIlNUUklORzIiLCAxMSk7CiAgICAgICAgcG0ucGVyc2lzdChhKTsK\nICAgICAgICBwbS5wZXJzaXN0KGIpOwogICAgICAgIF9pZCA9IGEuZ2V0SW50\nRmllbGQoKTsKICAgICAgICBfaWQyID0gYi5nZXRJbnRGaWVsZCgpOwoKICAg\nICAgICBlbmRUeChwbSk7CiAgICAgICAgZW5kRW0ocG0pOwogICAgfQoKICAg\nIC8qKgogICAgICogTm8tb3AgdGVzdCB0aGF0IGNhbiBiZSBydW4gaW4gbmFt\nZSB0byBzZWUgaWYgdGhlIHNldHVwIGlzIHdvcmtpbmcKICAgICAqIHByb3Bl\ncmx5LgogICAgICovCiAgICBwdWJsaWMgdm9pZCB0ZXN0U2V0dXAoKSB7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBUZXN0cyB0aGF0IHRoZSBQTSB0aHJvd3Mg\nRXhjZXB0aW9ucyBvbiB1c2FnZSBhdHRlbXB0cyBhZnRlciBpdCBoYXMgYmVl\nbgogICAgICogY2xvc2VkLgogICAgICovCiAgICBwdWJsaWMgdm9pZCB0ZXN0\nQ2xvc2VkKCkgewogICAgICAgIE9wZW5KUEFFbnRpdHlNYW5hZ2VyIHBtID0g\nZ2V0UE0oKTsKICAgICAgICBlbmRFbShwbSk7CgogICAgICAgIHRyeSB7CiAg\nICAgICAgICAgIC8vIHRoaXMgaXMgdGhlIG9ubHkgbWV0aG9kIHRoYXQgc2hv\ndWxkIHN1Y2NlZWQKICAgICAgICAgICAgcG0uaXNPcGVuKCk7CiAgICAgICAg\nfSBjYXRjaCAoUnVudGltZUV4Y2VwdGlvbiByZSkgewogICAgICAgICAgICBm\nYWlsKCJpc0Nsb3NlZCIpOwogICAgICAgIH0KICAgICAgICB0cnkgewogICAg\nICAgICAgICBwbS5maW5kKFJ1bnRpbWVUZXN0MS5jbGFzcywgX2lkKTsKICAg\nICAgICAgICAgZmFpbCgiZmluZCIpOwogICAgICAgIH0gY2F0Y2ggKFJ1bnRp\nbWVFeGNlcHRpb24gcmUpIHsKICAgICAgICB9CiAgICAgICAgdHJ5IHsKICAg\nICAgICAgICAgcG0ucGVyc2lzdChuZXcgUnVudGltZVRlc3QxKDIwKSk7CiAg\nICAgICAgICAgIGZhaWwoInNldFVzZXJPYmplY3QiKTsKICAgICAgICB9IGNh\ndGNoIChSdW50aW1lRXhjZXB0aW9uIHJlKSB7CiAgICAgICAgfQogICAgICAg\nIHRyeSB7CiAgICAgICAgICAgIHBtLnNldE5vbnRyYW5zYWN0aW9uYWxSZWFk\nKHRydWUpOwogICAgICAgICAgICBmYWlsKCJzZXROb250cmFuc2FjdGlvbmFs\nUmVhZCIpOwogICAgICAgIH0gY2F0Y2ggKFJ1bnRpbWVFeGNlcHRpb24gcmUp\nIHsKICAgICAgICB9CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgLy8gdGhp\ncyBtZXRob2Qgc2hvdWxkIGZhaWwKICAgICAgICAgICAgZW5kRW0ocG0pOwog\nICAgICAgICAgICBidWcoNjUsIG51bGwsICJtdWx0aXBsZSBjbG9zZSBzaG91\nbGQgbm90IGJlIGFsbG93ZWQiKTsKICAgICAgICAgICAgZmFpbCgibXVsdGlw\nbGUgY2xvc2Ugc2hvdWxkIG5vdCBiZSBhbGxvd2VkIik7CiAgICAgICAgfSBj\nYXRjaCAoRXhjZXB0aW9uIGpkb2UpIHsKICAgICAgICAgICAgLy8gZ29vZDog\nd2Ugc2hvdWxkIGdldCBhbiBleGNlcHRpb24KICAgICAgICB9CiAgICB9Cgog\nICAgcHVibGljIHZvaWQgdGVzdE11bHRpcGxlQ2xvc2VUaHJlYWRlZCgpCiAg\nICAgICAgdGhyb3dzIFRocm93YWJsZSB7CiAgICAgICAgZmluYWwgT3BlbkpQ\nQUVudGl0eU1hbmFnZXIgcG0gPSBnZXRQTSgpOwogICAgICAgIGZpbmFsIExp\nc3QgcmVzdWx0ID0gbmV3IEFycmF5TGlzdCgpOwogICAgICAgIHN0YXJ0VHgo\ncG0pOwoKICAgICAgICBlbmRFbShwbSk7CgogICAgICAgIG5ldyBUaHJlYWQo\nKSB7CiAgICAgICAgICAgIHB1YmxpYyB2b2lkIHJ1bigpIHsKICAgICAgICAg\nICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgZW5kRW0ocG0pOwog\nICAgICAgICAgICAgICAgICAgIHJlc3VsdC5hZGQobmV3IEludGVnZXIoMCkp\nOwogICAgICAgICAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGpkb2UpIHsK\nICAgICAgICAgICAgICAgICAgICByZXN1bHQuYWRkKGpkb2UpOwogICAgICAg\nICAgICAgICAgfSBjYXRjaCAoVGhyb3dhYmxlIHQpIHsKICAgICAgICAgICAg\nICAgICAgICByZXN1bHQuYWRkKHQpOwogICAgICAgICAgICAgICAgfQogICAg\nICAgICAgICB9CiAgICAgICAgfS5zdGFydCgpOwoKICAgICAgICB3aGlsZSAo\ncmVzdWx0LnNpemUoKSA9PSAwKQogICAgICAgICAgICBUaHJlYWQuY3VycmVu\ndFRocmVhZCgpLnlpZWxkKCk7IC8vIHdhaXQgZm9yIHJlc3VsdHMKICAgICAg\nICBPYmplY3QgcmV0ID0gcmVzdWx0LmdldCgwKTsKCiAgICAgICAgaWYgKHJl\ndCBpbnN0YW5jZW9mIEV4Y2VwdGlvbikKICAgICAgICAgICAgcmV0dXJuOyAv\nLyBnb29kCgogICAgICAgIGlmIChyZXQgaW5zdGFuY2VvZiBUaHJvd2FibGUp\nCiAgICAgICAgICAgIHRocm93IChUaHJvd2FibGUpIHJldDsKCiAgICAgICAg\nYnVnKDY1LCBudWxsLAogICAgICAgICAgICAibXVsdGlwbGUgY2xvc2UgaW4g\nZGlmZmVyZW50IHRocmVhZHMgc2hvdWxkIG5vdCBiZSBhbGxvd2VkIik7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBUaGlzIG1ldGhvZCB0cmllcyB0byBwZXJm\nb3JtIG9wZXJhdGlvbnMgdGhhdCBzaG91bGQgbGVhZCB0bwogICAgICogaWxs\nZWdhbCBzdGF0ZXMsIHN1Y2ggYXMgcGVyc2lzdGluZyBpbnN0YW5jZXMgb3V0\nc2lkZSBvZiB0cmFuc2FjdGlvbnMsCiAgICAgKiBldGMuCiAgICAgKi8KICAg\nIHB1YmxpYyB2b2lkIHRlc3RJbGxlZ2FsU3RhdGUoKSB7CiAgICAgICAgT3Bl\nbkpQQUVudGl0eU1hbmFnZXIgcG0gPSBnZXRQTSgpOwoKICAgICAgICBSdW50\naW1lVGVzdDEgYSA9IG5ldyBSdW50aW1lVGVzdDEoImZvbyIsIDE0KTsKICAg\nICAgICBSdW50aW1lVGVzdDEgYTIgPSAoUnVudGltZVRlc3QxKSBwbS5maW5k\nKFJ1bnRpbWVUZXN0MS5jbGFzcywgX2lkKTsKCiAgICAgICAgdHJ5IHsKICAg\nICAgICAgICAgcG0ucGVyc2lzdChhKTsKICAgICAgICAgICAgZmFpbCgicGVy\nc2lzdCIpOwogICAgICAgIH0KICAgICAgICBjYXRjaCAoRXhjZXB0aW9uIGlz\nZSkgewogICAgICAgIH0KICAgICAgICB0cnkgewogICAgICAgICAgICBwbS5p\nc1RyYW5zYWN0aW9uYWwoYTIpOwogICAgICAgICAgICBmYWlsKCJtYWtlVHJh\nbnNhY3Rpb25hbCIpOwogICAgICAgIH0KICAgICAgICBjYXRjaCAoRXhjZXB0\naW9uIGlzZSkgewogICAgICAgIH0KICAgICAgICB0cnkgewogICAgICAgICAg\nICBwbS5yZW1vdmUoYTIpOwogICAgICAgICAgICBmYWlsKCJkZWxldGVQZXJz\naXN0ZW50Iik7CiAgICAgICAgfQogICAgICAgIGNhdGNoIChFeGNlcHRpb24g\naXNlKSB7CiAgICAgICAgfQoKICAgICAgICBlbmRFbShwbSk7CiAgICB9Cgog\nICAgcHVibGljIHZvaWQgdGVzdE9wZW5KUEFFbnRpdHlNYW5hZ2VyRmFjdG9y\neVNlcmlhbGl6YWJsZSgpCiAgICAgICAgdGhyb3dzIEV4Y2VwdGlvbiB7CiAg\nICAgICAgT3BlbkpQQUVudGl0eU1hbmFnZXJGYWN0b3J5IHBtZiA9CiAgICAg\nICAgICAgIChPcGVuSlBBRW50aXR5TWFuYWdlckZhY3RvcnkpIGdldEVtZigp\nOwogICAgICAgIGFzc2VydE5vdE51bGwoIk9wZW5KUEFFbnRpdHlNYW5hZ2Vy\nRmFjdG9yeSBpcyBudWxsLiIsIHBtZik7CgogICAgICAgIEJ5dGVBcnJheU91\ndHB1dFN0cmVhbSBiYW9zID0gbmV3IEJ5dGVBcnJheU91dHB1dFN0cmVhbSgp\nOwogICAgICAgIE9iamVjdE91dHB1dFN0cmVhbSBvb3MgPSBuZXcgT2JqZWN0\nT3V0cHV0U3RyZWFtKGJhb3MpOwogICAgICAgIG9vcy53cml0ZU9iamVjdChw\nbWYpOwoKICAgICAgICBPcGVuSlBBRW50aXR5TWFuYWdlckZhY3RvcnkgcG1m\nMiA9IChPcGVuSlBBRW50aXR5TWFuYWdlckZhY3RvcnkpCiAgICAgICAgICAg\nIG5ldyBPYmplY3RJbnB1dFN0cmVhbSgKICAgICAgICAgICAgICAgIG5ldyBC\neXRlQXJyYXlJbnB1dFN0cmVhbShiYW9zLnRvQnl0ZUFycmF5KCkpKS5yZWFk\nT2JqZWN0KCk7CiAgICAgICAgYXNzZXJ0Tm90TnVsbCgiRGVzZXJpYWxpemVk\nIE9wZW5KUEFFbnRpdHlNYW5hZ2VyRmFjdG9yeSBpcyBudWxsLiIsCiAgICAg\nICAgICAgIHBtZjIpOwoKICAgICAgICBPcGVuSlBBRW50aXR5TWFuYWdlciBw\nbSA9IHBtZjIuY3JlYXRlRW50aXR5TWFuYWdlcigpOwogICAgICAgIHN0YXJ0\nVHgocG0pOwogICAgICAgIC8vIGdvIHRocm91Z2ggc29tZSBvYmplY3RzIHRv\nIG1ha2Ugc3VyZSBvdXIgUE0gaXMgT0sKICAgICAgICBmb3IgKEl0ZXJhdG9y\nIGkgPSBwbS5jcmVhdGVFeHRlbnQoUnVudGltZVRlc3QxLmNsYXNzLCB0cnVl\nKS5pdGVyYXRvcigpOwogICAgICAgICAgICBpLmhhc05leHQoKTsgaS5uZXh0\nKCkpCiAgICAgICAgICAgIDsKICAgICAgICBlbmRUeChwbSk7CiAgICAgICAg\nZW5kRW0ocG0pOwogICAgfQoKICAgIHByaXZhdGUgc3RhdGljIEJyb2tlckZh\nY3RvcnkgdG9Ccm9rZXJGYWN0b3J5KEVudGl0eU1hbmFnZXJGYWN0b3J5IGVt\nZikgewogICAgICAgIEJyb2tlckZhY3RvcnkgYmYgPSBKUEFGYWNhZGVIZWxw\nZXIudG9Ccm9rZXJGYWN0b3J5KGVtZik7CiAgICAgICAgaWYgKGJmIGluc3Rh\nbmNlb2YgRGVsZWdhdGluZ0Jyb2tlckZhY3RvcnkpCiAgICAgICAgICAgIGJm\nID0gKChEZWxlZ2F0aW5nQnJva2VyRmFjdG9yeSkgYmYpLmdldElubmVybW9z\ndERlbGVnYXRlKCk7CiAgICAgICAgcmV0dXJuIGJmOwogICAgfQoKICAgIC8q\nKgogICAgICogVGVzdCB0aGF0IGEgZ2V0T2JqZWN0QnlJZCgpIHJldHVybnMg\ndGhlIGNvcnJlY3QgaW5zdGFuY2UuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lk\nIHRlc3RHZXRPYmplY3RCeUlkKCkgewogICAgICAgIC8vIHRlc3Qgd2l0aCB2\nYWxpZCBpZAogICAgICAgIE9wZW5KUEFFbnRpdHlNYW5hZ2VyIHBtID0gZ2V0\nUE0oKTsKICAgICAgICBSdW50aW1lVGVzdDEgYiA9IChSdW50aW1lVGVzdDEp\nIHBtLmZpbmQoUnVudGltZVRlc3QxLmNsYXNzLCBfaWQpOwogICAgICAgIGFz\nc2VydEVxdWFscygiU1RSSU5HIiwgYi5nZXRTdHJpbmdGaWVsZCgpKTsKCiAg\nICAgICAgLy8gaW52YWxpZCB3aXRoIHBvc3NpYmxlIHN1YmNsYXNzZXMgc2hv\ndWxkIHRocm93IGltbWVkaWF0ZSBleGNlcHRpb24KICAgICAgICBPYmplY3Qg\naW52YWxpZElkID0gbmV3IElkKFJ1bnRpbWVUZXN0MS5jbGFzcywgLTFMKTsK\nICAgICAgICB0cnkgewogICAgICAgICAgICBwbS5maW5kKFJ1bnRpbWVUZXN0\nMS5jbGFzcywgaW52YWxpZElkKTsKICAgICAgICAgICAgZmFpbCgiSW52YWxp\nZCBPYmplY3QiKTsKICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkgewog\nICAgICAgIH0KCiAgICAgICAgLy8gaW52YWxpZCB3aXRob3V0IHN1YmNsYXNz\nZXMgYW5kIHdpdGhvdXQgdmFsaWRhdGluZyBzaG91bGQgcmV0dXJuCiAgICAg\nICAgLy8gaG9sbG93CiAgICAgICAgaW52YWxpZElkID0gbmV3IElkKFJ1bnRp\nbWVUZXN0NC5jbGFzcywgLTFMKTsKICAgICAgICB0cnkgewogICAgICAgICAg\nICBSdW50aW1lVGVzdDQgYSA9IChSdW50aW1lVGVzdDQpIHBtLmdldFJlZmVy\nZW5jZShSdW50aW1lVGVzdDQuY2xhc3MsCiAgICAgICAgICAgICAgICBpbnZh\nbGlkSWQpOwogICAgICAgICAgICBhc3NlcnROb3ROdWxsKCJpbnZhbGlkIHdp\ndGhvdXQgc3ViY2xhc3NlcyBhbmQgd2l0aG91dCB2YWxpZGF0aW5nICIKICAg\nICAgICAgICAgICAgICsgInNob3VsZCByZXR1cm4gaG9sbG93IG9yIHRocm93\nIGV4Y2VwdGlvbiIsIGEpOwogICAgICAgICAgICBhLmdldE5hbWUoKTsKICAg\nICAgICAgICAgZmFpbCgiQWxsb3dlZCBhY2Nlc3Mgb2YgaW52YWxpZCBob2xs\nb3cgaW5zdGFuY2UuIik7CiAgICAgICAgfQogICAgICAgIGNhdGNoIChFbnRp\ndHlOb3RGb3VuZEV4Y2VwdGlvbiBlbmZlKSB7CiAgICAgICAgICAgIC8vIGV4\ncGVjdGVkCiAgICAgICAgfQoKICAgICAgICBpbnZhbGlkSWQgPSBuZXcgSWQo\nUnVudGltZVRlc3Q0LmNsYXNzLCAtM0wpOwogICAgICAgIGFzc2VydE51bGwo\ncG0uZmluZChSdW50aW1lVGVzdDQuY2xhc3MsIGludmFsaWRJZCkpOwoKICAg\nICAgICBlbmRFbShwbSk7CiAgICB9CgogICAgcHVibGljIHZvaWQgdGVzdEdl\ndE9iamVjdHNCeUlkKCkgewogICAgICAgIE9wZW5KUEFFbnRpdHlNYW5hZ2Vy\nIHBtID0gZ2V0UE0oKTsKICAgICAgICBBcnJheUxpc3QgaWRsaXN0ID0gbmV3\nIEFycmF5TGlzdCgpOwogICAgICAgIGlkbGlzdC5hZGQoX2lkKTsKICAgICAg\nICBpZGxpc3QuYWRkKF9pZDIpOwogICAgICAgIENvbGxlY3Rpb24gcGNzID0g\ncG0uZmluZEFsbChSdW50aW1lVGVzdDEuY2xhc3MsIGlkbGlzdCk7CiAgICAg\nICAgYXNzZXJ0RXF1YWxzKDIsIHBjcy5zaXplKCkpOwogICAgICAgIEl0ZXJh\ndG9yIGl0ZXIgPSBwY3MuaXRlcmF0b3IoKTsKICAgICAgICBhc3NlcnRFcXVh\nbHMoIlNUUklORyIsICgoUnVudGltZVRlc3QxKSBpdGVyLm5leHQoKSkuZ2V0\nU3RyaW5nRmllbGQoKSk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKCJTVFJJTkcy\nIiwgKChSdW50aW1lVGVzdDIpIGl0ZXIubmV4dCgpKS5nZXRTdHJpbmdGaWVs\nZCgpKTsKICAgICAgICBlbmRFbShwbSk7CgogICAgICAgIHBtID0gZ2V0UE0o\nKTsKICAgICAgICBpZGxpc3QgPSBuZXcgQXJyYXlMaXN0KCk7CiAgICAgICAg\naWRsaXN0LmFkZChfaWQpOwogICAgICAgIGlkbGlzdC5hZGQoX2lkKTsKICAg\nICAgICBwY3MgPSBwbS5maW5kQWxsKFJ1bnRpbWVUZXN0MS5jbGFzcywgaWRs\naXN0KTsKICAgICAgICBpdGVyID0gcGNzLml0ZXJhdG9yKCk7CiAgICAgICAg\nYXNzZXJ0RXF1YWxzKDIsIHBjcy5zaXplKCkpOwogICAgICAgIGFzc2VydEVx\ndWFscygiU1RSSU5HIiwgKChSdW50aW1lVGVzdDEpIGl0ZXIubmV4dCgpKS5n\nZXRTdHJpbmdGaWVsZCgpKTsKICAgICAgICBpdGVyID0gcGNzLml0ZXJhdG9y\nKCk7CiAgICAgICAgYXNzZXJ0VHJ1ZShpdGVyLm5leHQoKSA9PSBpdGVyLm5l\neHQoKSk7CiAgICAgICAgZW5kRW0ocG0pOwoKICAgICAgICAvLyBpbnZhbGlk\nIGlkIGNhdXNlcyBleGNlcHRpb24KICAgICAgICBPYmplY3QgaW52YWxpZElk\nID0gbmV3IElkKFJ1bnRpbWVUZXN0NC5jbGFzcywgLTFMKTsKICAgICAgICBw\nbSA9IGdldFBNKCk7CiAgICAgICAgaWRsaXN0ID0gbmV3IEFycmF5TGlzdCgp\nOwogICAgICAgIGlkbGlzdC5hZGQoX2lkKTsKICAgICAgICBpZGxpc3QuYWRk\nKGludmFsaWRJZCk7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgcGNzID0g\nKEFycmF5TGlzdCkgcG0uZmluZEFsbChSdW50aW1lVGVzdDEuY2xhc3MsIGlk\nbGlzdCk7CiAgICAgICAgICAgIGl0ZXIgPSBwY3MuaXRlcmF0b3IoKTsKICAg\nICAgICAgICAgYXNzZXJ0RXF1YWxzKDIsIHBjcy5zaXplKCkpOwogICAgICAg\nICAgICBhc3NlcnRFcXVhbHMoIlNUUklORyIsCiAgICAgICAgICAgICAgICAo\nKFJ1bnRpbWVUZXN0MSkgaXRlci5uZXh0KCkpLmdldFN0cmluZ0ZpZWxkKCkp\nOwogICAgICAgICAgICBhc3NlcnROb3ROdWxsKGl0ZXIubmV4dCgpKTsKICAg\nICAgICAgICAgZmFpbCgiaW52YWxpZCBpZCBkaWRudCBjYXVzZSBleGNlcHRp\nb24iKTsKICAgICAgICB9CiAgICAgICAgY2F0Y2ggKEV4Y2VwdGlvbiBvbmZl\nKSB7CiAgICAgICAgICAgIC8vZXhwZWN0ZWQgZXhjZXB0aW9uLiBpbnZhbGlk\nIGlkIGNhdXNlcyBleGNlcHRpb24KICAgICAgICB9CgogICAgICAgIHRyeSB7\nCiAgICAgICAgICAgICgoUnVudGltZVRlc3Q0KSBpdGVyLm5leHQoKSkuZ2V0\nTmFtZSgpOwogICAgICAgICAgICBmYWlsKCJBY2Nlc3NlZCBpbnZhbGlkIG9i\namVjdC4iKTsKICAgICAgICB9CiAgICAgICAgY2F0Y2ggKEV4Y2VwdGlvbiBv\nbmZlKSB7CiAgICAgICAgICAgIGJ1ZygxMTM4LCBvbmZlLCAiV3JvbmcgZXhj\nZXB0aW9uIHR5cGUiKTsKICAgICAgICB9CgogICAgICAgIHBtID0gZ2V0UE0o\nKTsKICAgICAgICB0cnkgewogICAgICAgICAgICBwbS5maW5kQWxsKFJ1bnRp\nbWVUZXN0MS5jbGFzcywgaWRsaXN0KTsKICAgICAgICAgICAgZmFpbCgiRm91\nbmQgaW52YWxpZCBvYmplY3QuIik7CiAgICAgICAgfSBjYXRjaCAoRXhjZXB0\naW9uIGUpIHsKICAgICAgICB9CiAgICAgICAgZW5kRW0ocG0pOwogICAgfQoK\nICAgIHB1YmxpYyB2b2lkIHRlc3RFdmljdEFsbCgpIHsKICAgICAgICBPcGVu\nSlBBRW50aXR5TWFuYWdlciBwbSA9IGdldFBNKCk7CgogICAgICAgIExpc3Qg\nbCA9ICgoRXh0ZW50KSBwbS5jcmVhdGVFeHRlbnQoUnVudGltZVRlc3QxLmNs\nYXNzLCB0cnVlKSkubGlzdCgpOwogICAgICAgIHBtLnJldHJpZXZlQWxsKGwp\nOwogICAgICAgIGZvciAoSXRlcmF0b3IgaXRlciA9IGwuaXRlcmF0b3IoKTsg\naXRlci5oYXNOZXh0KCk7KSB7CiAgICAgICAgICAgIFBDU3RhdGUgcyA9IGdl\ndFN0YXRlTWFuYWdlcihpdGVyLm5leHQoKSwgcG0pLmdldFBDU3RhdGUoKTsK\nICAgICAgICAgICAgYXNzZXJ0RXF1YWxzKFBDU3RhdGUuUE5PTlRSQU5TLCBz\nKTsKICAgICAgICB9CiAgICAgICAgcG0uZXZpY3RBbGwoKTsKICAgICAgICBm\nb3IgKEl0ZXJhdG9yIGl0ZXIgPSBsLml0ZXJhdG9yKCk7IGl0ZXIuaGFzTmV4\ndCgpOykgewogICAgICAgICAgICBQQ1N0YXRlIHMgPSBnZXRTdGF0ZU1hbmFn\nZXIoaXRlci5uZXh0KCksIHBtKS5nZXRQQ1N0YXRlKCk7CiAgICAgICAgICAg\nIGFzc2VydEVxdWFscyhQQ1N0YXRlLkhPTExPVywgcyk7CiAgICAgICAgfQog\nICAgfQoKICAgIHB1YmxpYyB2b2lkIHRlc3RFdmljdEFsbENvbGxlY3Rpb24o\nKSB7CiAgICAgICAgT3BlbkpQQUVudGl0eU1hbmFnZXIgcG0gPSBnZXRQTSgp\nOwoKICAgICAgICBMaXN0IGwgPSAoKEV4dGVudCkgcG0uY3JlYXRlRXh0ZW50\nKFJ1bnRpbWVUZXN0MS5jbGFzcywgdHJ1ZSkpLmxpc3QoKTsKICAgICAgICBw\nbS5yZXRyaWV2ZUFsbChsKTsKICAgICAgICBmb3IgKEl0ZXJhdG9yIGl0ZXIg\nPSBsLml0ZXJhdG9yKCk7IGl0ZXIuaGFzTmV4dCgpOykgewogICAgICAgICAg\nICBQQ1N0YXRlIHMgPSBnZXRTdGF0ZU1hbmFnZXIoaXRlci5uZXh0KCksIHBt\nKS5nZXRQQ1N0YXRlKCk7CiAgICAgICAgICAgIGFzc2VydEVxdWFscyhQQ1N0\nYXRlLlBOT05UUkFOUywgcyk7CiAgICAgICAgfQogICAgICAgIHBtLmV2aWN0\nQWxsKGwpOwogICAgICAgIGZvciAoSXRlcmF0b3IgaXRlciA9IGwuaXRlcmF0\nb3IoKTsgaXRlci5oYXNOZXh0KCk7KSB7CiAgICAgICAgICAgIFBDU3RhdGUg\ncyA9IGdldFN0YXRlTWFuYWdlcihpdGVyLm5leHQoKSwgcG0pLmdldFBDU3Rh\ndGUoKTsKICAgICAgICAgICAgYXNzZXJ0RXF1YWxzKFBDU3RhdGUuSE9MTE9X\nLCBzKTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGljIHZvaWQgdGVzdEV2\naWN0QWxsQ2xhc3MoKSB7CiAgICAgICAgT3BlbkpQQUVudGl0eU1hbmFnZXIg\ncG0gPSBnZXRQTSgpOwoKICAgICAgICBMaXN0IGwgPSAoKEV4dGVudCkgcG0u\nY3JlYXRlRXh0ZW50KFJ1bnRpbWVUZXN0MS5jbGFzcywgdHJ1ZSkpLmxpc3Qo\nKTsKICAgICAgICBwbS5yZXRyaWV2ZUFsbChsKTsKICAgICAgICBmb3IgKEl0\nZXJhdG9yIGl0ZXIgPSBsLml0ZXJhdG9yKCk7IGl0ZXIuaGFzTmV4dCgpOykg\newogICAgICAgICAgICBQQ1N0YXRlIHMgPSBnZXRTdGF0ZU1hbmFnZXIoaXRl\nci5uZXh0KCksIHBtKS5nZXRQQ1N0YXRlKCk7CiAgICAgICAgICAgIGFzc2Vy\ndEVxdWFscyhQQ1N0YXRlLlBOT05UUkFOUywgcyk7CiAgICAgICAgfQogICAg\nICAgIHBtLmV2aWN0QWxsKFJ1bnRpbWVUZXN0MS5jbGFzcyk7CiAgICAgICAg\nZm9yIChJdGVyYXRvciBpdGVyID0gbC5pdGVyYXRvcigpOyBpdGVyLmhhc05l\neHQoKTspIHsKICAgICAgICAgICAgUENTdGF0ZSBzID0gZ2V0U3RhdGVNYW5h\nZ2VyKGl0ZXIubmV4dCgpLCBwbSkuZ2V0UENTdGF0ZSgpOwogICAgICAgICAg\nICBhc3NlcnRFcXVhbHMoUENTdGF0ZS5IT0xMT1csIHMpOwogICAgICAgIH0K\nICAgIH0KCiAgICBwdWJsaWMgdm9pZCB0ZXN0RXZpY3RBbGxDbGFzc0ZhaWx1\ncmUoKSB7CiAgICAgICAgT3BlbkpQQUVudGl0eU1hbmFnZXIgcG0gPSBnZXRQ\nTSgpOwoKICAgICAgICBMaXN0IGwgPSAoKEV4dGVudCkgcG0uY3JlYXRlRXh0\nZW50KFJ1bnRpbWVUZXN0MS5jbGFzcywgdHJ1ZSkpLmxpc3QoKTsKICAgICAg\nICBwbS5yZXRyaWV2ZUFsbChsKTsKICAgICAgICBmb3IgKEl0ZXJhdG9yIGl0\nZXIgPSBsLml0ZXJhdG9yKCk7IGl0ZXIuaGFzTmV4dCgpOykgewogICAgICAg\nICAgICBQQ1N0YXRlIHMgPSBnZXRTdGF0ZU1hbmFnZXIoaXRlci5uZXh0KCks\nIHBtKS5nZXRQQ1N0YXRlKCk7CiAgICAgICAgICAgIGFzc2VydEVxdWFscyhQ\nQ1N0YXRlLlBOT05UUkFOUywgcyk7CiAgICAgICAgfQogICAgICAgIHBtLmV2\naWN0QWxsKFJ1bnRpbWVUZXN0Mi5jbGFzcyk7CiAgICAgICAgYm9vbGVhbiBm\nb3VuZFBOT05UUkFOUyA9IGZhbHNlOwogICAgICAgIGZvciAoSXRlcmF0b3Ig\naXRlciA9IGwuaXRlcmF0b3IoKTsgaXRlci5oYXNOZXh0KCk7KSB7CiAgICAg\nICAgICAgIFBDU3RhdGUgcyA9IGdldFN0YXRlTWFuYWdlcihpdGVyLm5leHQo\nKSwgcG0pLmdldFBDU3RhdGUoKTsKICAgICAgICAgICAgaWYgKHMgPT0gUENT\ndGF0ZS5QTk9OVFJBTlMpIHsKICAgICAgICAgICAgICAgIGZvdW5kUE5PTlRS\nQU5TID0gdHJ1ZTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAg\nICB9CiAgICAgICAgfQogICAgICAgIGFzc2VydFRydWUoInNob3VsZCBoYXZl\nIGZvdW5kIHNvbWUgUnVudGltZVRlc3QxcyB0aGF0IHdlcmUgbm90ICIKICAg\nICAgICAgICAgKyAiZXZpY3RlZCIsIGZvdW5kUE5PTlRSQU5TKTsKICAgIH0K\nCiAgICBwdWJsaWMgdm9pZCB0ZXN0RXZpY3RBbGxFeHRlbnQoKSB7CiAgICAg\nICAgT3BlbkpQQUVudGl0eU1hbmFnZXIgcG0gPSBnZXRQTSgpOwoKICAgICAg\nICBMaXN0IGwgPSAoKEV4dGVudCkgcG0uY3JlYXRlRXh0ZW50KFJ1bnRpbWVU\nZXN0MS5jbGFzcywgdHJ1ZSkpLmxpc3QoKTsKICAgICAgICBwbS5yZXRyaWV2\nZUFsbChsKTsKICAgICAgICBmb3IgKEl0ZXJhdG9yIGl0ZXIgPSBsLml0ZXJh\ndG9yKCk7IGl0ZXIuaGFzTmV4dCgpOykgewogICAgICAgICAgICBQQ1N0YXRl\nIHMgPSBnZXRTdGF0ZU1hbmFnZXIoaXRlci5uZXh0KCksIHBtKS5nZXRQQ1N0\nYXRlKCk7CiAgICAgICAgICAgIGFzc2VydEVxdWFscyhQQ1N0YXRlLlBOT05U\nUkFOUywgcyk7CiAgICAgICAgfQogICAgICAgIHBtLmV2aWN0QWxsKHBtLmNy\nZWF0ZUV4dGVudChSdW50aW1lVGVzdDEuY2xhc3MsIHRydWUpKTsKICAgICAg\nICBmb3IgKEl0ZXJhdG9yIGl0ZXIgPSBsLml0ZXJhdG9yKCk7IGl0ZXIuaGFz\nTmV4dCgpOykgewogICAgICAgICAgICBQQ1N0YXRlIHMgPSBnZXRTdGF0ZU1h\nbmFnZXIoaXRlci5uZXh0KCksIHBtKS5nZXRQQ1N0YXRlKCk7CiAgICAgICAg\nICAgIGFzc2VydEVxdWFscyhQQ1N0YXRlLkhPTExPVywgcyk7CiAgICAgICAg\nfQoKICAgICAgICBwbS5yZXRyaWV2ZUFsbChsKTsKICAgICAgICBmb3IgKEl0\nZXJhdG9yIGl0ZXIgPSBsLml0ZXJhdG9yKCk7IGl0ZXIuaGFzTmV4dCgpOykg\newogICAgICAgICAgICBQQ1N0YXRlIHMgPSBnZXRTdGF0ZU1hbmFnZXIoaXRl\nci5uZXh0KCksIHBtKS5nZXRQQ1N0YXRlKCk7CiAgICAgICAgICAgIGFzc2Vy\ndEVxdWFscyhQQ1N0YXRlLlBOT05UUkFOUywgcyk7CiAgICAgICAgfQogICAg\nICAgIHBtLmV2aWN0QWxsKHBtLmNyZWF0ZUV4dGVudChSdW50aW1lVGVzdDEu\nY2xhc3MsIGZhbHNlKSk7CiAgICAgICAgZm9yIChJdGVyYXRvciBpdGVyID0g\nbC5pdGVyYXRvcigpOyBpdGVyLmhhc05leHQoKTspIHsKICAgICAgICAgICAg\nT2JqZWN0IG8gPSBpdGVyLm5leHQoKTsKICAgICAgICAgICAgaWYgKG8uZ2V0\nQ2xhc3MoKSA9PSBSdW50aW1lVGVzdDEuY2xhc3MpIHsKICAgICAgICAgICAg\nICAgIFBDU3RhdGUgcyA9IGdldFN0YXRlTWFuYWdlcihvLCBwbSkuZ2V0UENT\ndGF0ZSgpOwogICAgICAgICAgICAgICAgYXNzZXJ0RXF1YWxzKFBDU3RhdGUu\nSE9MTE9XLCBzKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KfQo=\n","encoding":"base64"}

