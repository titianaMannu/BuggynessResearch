{"sha":"c2148309ba7118d43a6f2bf0c1bc0d27836d1bad","node_id":"MDQ6QmxvYjIwNjM2NDpjMjE0ODMwOWJhNzExOGQ0M2E2ZjJiZjBjMWJjMGQyNzgzNmQxYmFk","size":11499,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/c2148309ba7118d43a6f2bf0c1bc0d27836d1bad","content":"LyoKICogVGVzdFBlcnNpc3RlbnRNYXBzLmphdmEKICoKICogQ3JlYXRlZCBv\nbiBPY3RvYmVyIDEzLCAyMDA2LCAxOjU0IFBNCiAqCiAqIFRvIGNoYW5nZSB0\naGlzIHRlbXBsYXRlLCBjaG9vc2UgVG9vbHMgfCBUZW1wbGF0ZSBNYW5hZ2Vy\nCiAqIGFuZCBvcGVuIHRoZSB0ZW1wbGF0ZSBpbiB0aGUgZWRpdG9yLgogKi8K\nCi8qCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUKICogb3IgbW9yZSBjb250cmlidXRvciBs\naWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlCiAqIGRp\nc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9y\nbWF0aW9uCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhl\nIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUKICogdG8geW91IHVuZGVyIHRoZSBB\ncGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZQogKiAiTGljZW5zZSIp\nOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlh\nbmNlCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNv\ncHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogaHR0cDovL3d3dy5hcGFjaGUu\nb3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJl\nZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywK\nICogc29mdHdhcmUgZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMg\nZGlzdHJpYnV0ZWQgb24gYW4KICogIkFTIElTIiBCQVNJUywgV0lUSE9VVCBX\nQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZCiAqIEtJTkQsIGVpdGhl\nciBleHByZXNzIG9yIGltcGxpZWQuICBTZWUgdGhlIExpY2Vuc2UgZm9yIHRo\nZQogKiBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMg\nYW5kIGxpbWl0YXRpb25zCiAqIHVuZGVyIHRoZSBMaWNlbnNlLiAgICAKICov\nCnBhY2thZ2Ugb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNlLmtlcm5l\nbDsKCmltcG9ydCBqYXZhLnV0aWwuQXJyYXlMaXN0OwppbXBvcnQgamF2YS51\ndGlsLkFycmF5czsKaW1wb3J0IGphdmEudXRpbC5Db2xsZWN0aW9uOwppbXBv\ncnQgamF2YS51dGlsLkhhc2hNYXA7CmltcG9ydCBqYXZhLnV0aWwuSXRlcmF0\nb3I7CmltcG9ydCBqYXZhLnV0aWwuTGlzdDsKaW1wb3J0IGphdmEudXRpbC5N\nYXA7CgoKCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2Uu\na2VybmVsLmNvbW1vbi5hcHBzLk1hcEVsZW1lbnRQQzsKaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5rZXJuZWwuY29tbW9uLmFwcHMu\nTWFwRWxlbWVudFBDQ2hpbGQ7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\ncGVyc2lzdGVuY2Uua2VybmVsLmNvbW1vbi5hcHBzLlBlcnNpc3RlbnRNYXBI\nb2xkZXI7CgppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNl\nLkV4dGVudDsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5j\nZS5PcGVuSlBBRW50aXR5TWFuYWdlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5wZXJzaXN0ZW5jZS5PcGVuSlBBUXVlcnk7CgpwdWJsaWMgY2xhc3Mg\nVGVzdFBlcnNpc3RlbnRNYXBzIGV4dGVuZHMgQmFzZUtlcm5lbFRlc3QgewoK\nICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIFN0cmluZyBKRE9RTCA9ICJqYXZh\neC5qZG8ucXVlcnkuSkRPUUwiOwoKICAgIC8qKgogICAgICogQ3JlYXRlcyBh\nIG5ldyBpbnN0YW5jZSBvZiBUZXN0UGVyc2lzdGVudE1hcHMKICAgICAqLwog\nICAgcHVibGljIFRlc3RQZXJzaXN0ZW50TWFwcygpIHsKICAgIH0KCiAgICBw\ndWJsaWMgVGVzdFBlcnNpc3RlbnRNYXBzKFN0cmluZyBuYW1lKSB7CiAgICAg\nICAgc3VwZXIobmFtZSk7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0VXAo\nKSB7CiAgICAgICAgZGVsZXRlQWxsKFBlcnNpc3RlbnRNYXBIb2xkZXIuY2xh\nc3MpOwogICAgICAgIE9wZW5KUEFFbnRpdHlNYW5hZ2VyIHBtID0gZ2V0UE0o\nKTsKICAgICAgICBzdGFydFR4KHBtKTsKCiAgICAgICAgcG0ucGVyc2lzdChu\nZXcgUGVyc2lzdGVudE1hcEhvbGRlcigpKTsKCiAgICAgICAgZW5kVHgocG0p\nOwogICAgICAgIGVuZEVtKHBtKTsKICAgIH0KCiAgICBwcml2YXRlIFBlcnNp\nc3RlbnRNYXBIb2xkZXIgZ2V0SG9sZGVyKE9wZW5KUEFFbnRpdHlNYW5hZ2Vy\nIHBtKSB7CiAgICAgICAgRXh0ZW50IGUgPSBwbS5jcmVhdGVFeHRlbnQoUGVy\nc2lzdGVudE1hcEhvbGRlci5jbGFzcywgdHJ1ZSk7CiAgICAgICAgYXNzZXJ0\nU2l6ZSgxLCAoKENvbGxlY3Rpb24pIGUubGlzdCgpKSk7CiAgICAgICAgcmV0\ndXJuIChQZXJzaXN0ZW50TWFwSG9sZGVyKSBlLml0ZXJhdG9yKCkubmV4dCgp\nOwogICAgfQoKICAgIHByaXZhdGUgT2JqZWN0IGtleUluc3RhbmNlKENsYXNz\nIHR5cGUpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIGlmICh0eXBlLmdl\ndE5hbWUoKS5lcXVhbHMoU3RyaW5nLmNsYXNzLmdldE5hbWUoKSkpCiAgICAg\nICAgICAgIHJldHVybiByYW5kb21TdHJpbmcoKTsKICAgICAgICBlbHNlCiAg\nICAgICAgICAgIHJldHVybiB0eXBlLm5ld0luc3RhbmNlKCk7CiAgICB9Cgog\nICAgcHJpdmF0ZSB2b2lkIHRlc3RNYXAoaW50IG51bSwgU3RyaW5nIG5hbWUs\nIENsYXNzIGtleUNsYXNzLCBDbGFzcyB2YWx1ZUNsYXNzKQogICAgICAgIHRo\ncm93cyBFeGNlcHRpb24gewogICAgICAgIE9wZW5KUEFFbnRpdHlNYW5hZ2Vy\nIHNyY3BtID0gZ2V0UE0odHJ1ZSwgdHJ1ZSk7CiAgICAgICAgc3RhcnRUeChz\ncmNwbSk7CgogICAgICAgIFBlcnNpc3RlbnRNYXBIb2xkZXIgaG9sZGVyID0g\nZ2V0SG9sZGVyKHNyY3BtKTsKICAgICAgICBNYXAgbWFwID0gaG9sZGVyLmdl\ndE5hbWVkTWFwKG5hbWUpOwogICAgICAgIE1hcCBpbnRlcm5hbE1hcCA9IG5l\ndyBIYXNoTWFwKCk7CgogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgbnVt\nOyBpKyspIHsKICAgICAgICAgICAgT2JqZWN0IGtleSA9IGtleUluc3RhbmNl\nKGtleUNsYXNzKTsKICAgICAgICAgICAgT2JqZWN0IHZhbHVlID0ga2V5SW5z\ndGFuY2UodmFsdWVDbGFzcyk7CiAgICAgICAgICAgIG1hcC5wdXQoa2V5LCB2\nYWx1ZSk7CiAgICAgICAgICAgIGludGVybmFsTWFwLnB1dChrZXksIHZhbHVl\nKTsKCiAgICAgICAgICAgIGFzc2VydEVxdWFscyhtYXAuZ2V0KGtleSksIGlu\ndGVybmFsTWFwLmdldChrZXkpKTsKICAgICAgICB9CiAgICAgICAgZW5kVHgo\nc3JjcG0pOwoKICAgICAgICBPcGVuSlBBRW50aXR5TWFuYWdlciBwbSA9IGdl\ndFBNKCk7CiAgICAgICAgc3RhcnRUeChwbSk7Ci8vICAgICAgICBob2xkZXIg\nPSBnZXRIb2xkZXIocG0pOwogICAgICAgIG1hcCA9IGhvbGRlci5nZXROYW1l\nZE1hcChuYW1lKTsKICAgICAgICBmb3IgKEl0ZXJhdG9yIGkgPSBpbnRlcm5h\nbE1hcC5rZXlTZXQoKS5pdGVyYXRvcigpOyBpLmhhc05leHQoKTspIHsKICAg\nICAgICAgICAgT2JqZWN0IGsgPSBpLm5leHQoKTsKICAgICAgICAgICAgYXNz\nZXJ0RXF1YWxzKG1hcC5nZXQoayksIGludGVybmFsTWFwLmdldChrKSk7CiAg\nICAgICAgfQogICAgICAgIGVuZFR4KHBtKTsKICAgICAgICBlbmRFbShwbSk7\nCgogICAgICAgIFN0cmluZyBzZWxlY3RXaGVyZSA9CiAgICAgICAgICAgICJz\nZWxlY3QgZnJvbSAiICsgUGVyc2lzdGVudE1hcEhvbGRlci5jbGFzcy5nZXRO\nYW1lKCkgKyAiIHdoZXJlICI7CgogICAgICAgIHBtID0gZ2V0UE0oKTsKICAg\nICAgICBzdGFydFR4KHBtKTsKICAgICAgICBmb3IgKEl0ZXJhdG9yIGkgPSBp\nbnRlcm5hbE1hcC5rZXlTZXQoKS5pdGVyYXRvcigpOyBpLmhhc05leHQoKTsp\nIHsKCiAgICAgICAgICAgIE9iamVjdCBwYXJhbSA9IGkubmV4dCgpOwogICAg\nICAgICAgICBpZiAocG0uaXNQZXJzaXN0ZW50KHBhcmFtKSkKICAgICAgICAg\nICAgICAgIHBhcmFtID0gcG0uZmluZChwYXJhbS5nZXRDbGFzcygpLCBwbS5n\nZXRPYmplY3RJZChwYXJhbSkpOwoKICAgICAgICAgICAgT2JqZWN0IHZhbCA9\nIGludGVybmFsTWFwLmdldChwYXJhbSk7CiAgICAgICAgICAgIGlmIChwbS5p\nc1BlcnNpc3RlbnQodmFsKSkKICAgICAgICAgICAgICAgIHZhbCA9IHBtLmZp\nbmQodmFsLmdldENsYXNzKCksIHBtLmdldE9iamVjdElkKHZhbCkpOwoKICAg\nICAgICAgICAgT3BlbkpQQVF1ZXJ5IHE7CgogICAgICAgICAgICBxID0gcG0u\nY3JlYXRlUXVlcnkoSkRPUUwsCiAgICAgICAgICAgICAgICBzZWxlY3RXaGVy\nZSArIG5hbWUgKyAiLmNvbnRhaW5zS2V5KDpwYXJhbSkiKTsKICAgICAgICAg\nICAgcS5zZXRQYXJhbWV0ZXIoInBhcmFtIiwgcGFyYW0pOwogICAgICAgICAg\nICBhc3NlcnRTaXplKDEsIHEuZ2V0UmVzdWx0TGlzdCgpKTsKCiAgICAgICAg\nICAgIHEgPSBwbS5jcmVhdGVRdWVyeShKRE9RTCwKICAgICAgICAgICAgICAg\nIHNlbGVjdFdoZXJlICsgbmFtZSArICIuY29udGFpbnNWYWx1ZSg6dmFsdWUp\nIik7CiAgICAgICAgICAgIHEuc2V0UGFyYW1ldGVyKCJ2YWx1ZSIsIHZhbCk7\nCiAgICAgICAgICAgIGFzc2VydFNpemUoMSwgcS5nZXRSZXN1bHRMaXN0KCkp\nOwoKICAgICAgICAgICAgcSA9IHBtLmNyZWF0ZVF1ZXJ5KEpET1FMLCBzZWxl\nY3RXaGVyZSArIG5hbWUgKyAiLmNvbnRhaW5zVmFsdWUoIiArCiAgICAgICAg\nICAgICAgICBuYW1lICsgIi5nZXQoOnBhcmFtKSkiKTsKICAgICAgICAgICAg\ncS5zZXRQYXJhbWV0ZXIoInBhcmFtIiwgcGFyYW0pOwogICAgICAgICAgICBh\nc3NlcnRTaXplKDEsIHEuZ2V0UmVzdWx0TGlzdCgpKTsKCiAgICAgICAgICAg\nIHEgPSBwbS5jcmVhdGVRdWVyeShKRE9RTCwKICAgICAgICAgICAgICAgIHNl\nbGVjdFdoZXJlICsgbmFtZSArICIuZ2V0KDpwYXJhbSkgIT0gbnVsbCIpOwog\nICAgICAgICAgICBxLnNldFBhcmFtZXRlcigicGFyYW0iLCBwYXJhbSk7CiAg\nICAgICAgICAgIGFzc2VydFNpemUoMSwgcS5nZXRSZXN1bHRMaXN0KCkpOwoK\nICAgICAgICAgICAgcSA9IHBtLmNyZWF0ZVF1ZXJ5KEpET1FMLAogICAgICAg\nICAgICAgICAgc2VsZWN0V2hlcmUgKyBuYW1lICsgIi5nZXQoOnBhcmFtKSA9\nPSA6dmFsdWUiKTsKICAgICAgICAgICAgcS5zZXRQYXJhbWV0ZXIoInBhcmFt\nIiwgcGFyYW0pOwogICAgICAgICAgICBxLnNldFBhcmFtZXRlcigidmFsdWUi\nLCB2YWwpOwogICAgICAgICAgICBhc3NlcnRTaXplKDEsIHEuZ2V0UmVzdWx0\nTGlzdCgpKTsKCiAgICAgICAgICAgIHEgPSBwbS5jcmVhdGVRdWVyeShKRE9R\nTCwKICAgICAgICAgICAgICAgIHNlbGVjdFdoZXJlICsgbmFtZSArICIuZ2V0\nKDpwYXJhbSkgIT0gOnZhbHVlIik7CiAgICAgICAgICAgIHEuc2V0UGFyYW1l\ndGVyKCJwYXJhbSIsIHBhcmFtKTsKICAgICAgICAgICAgcS5zZXRQYXJhbWV0\nZXIoInZhbHVlIiwgdmFsKTsKICAgICAgICAgICAgYXNzZXJ0U2l6ZSgwLCBx\nLmdldFJlc3VsdExpc3QoKSk7CiAgICAgICAgfQogICAgICAgIGVuZFR4KHBt\nKTsKICAgICAgICBlbmRFbShwbSk7CgogICAgICAgIHBtID0gZ2V0UE0oKTsK\nICAgICAgICBzdGFydFR4KHBtKTsKICAgICAgICBmb3IgKEl0ZXJhdG9yIGkg\nPSBpbnRlcm5hbE1hcC5rZXlTZXQoKS5pdGVyYXRvcigpOyBpLmhhc05leHQo\nKTspIHsKICAgICAgICAgICAgT2JqZWN0IHBhcmFtID0gaS5uZXh0KCk7CiAg\nICAgICAgICAgIGlmIChwbS5pc1BlcnNpc3RlbnQocGFyYW0pKQogICAgICAg\nICAgICAgICAgcGFyYW0gPSBwbS5maW5kKHBhcmFtLmdldENsYXNzKCksIHBt\nLmdldE9iamVjdElkKHBhcmFtKSk7CgogICAgICAgICAgICBMaXN0IGdldFF1\nZXJpZXMgPSBuZXcgQXJyYXlMaXN0KEFycmF5cy5hc0xpc3QobmV3IFN0cmlu\nZ1tdewogICAgICAgICAgICAgICAgc2VsZWN0V2hlcmUgKyBuYW1lICsgIi5n\nZXQoOnBhcmFtKSAhPSBudWxsIiwKICAgICAgICAgICAgICAgIHNlbGVjdFdo\nZXJlICsgbmFtZSArICIuZ2V0KDpwYXJhbSkgPT0gIiArIG5hbWUgKyAiLmdl\ndCg6cGFyYW0pIiwKICAgICAgICAgICAgICAgIHNlbGVjdFdoZXJlICsgIiEo\nIiArIG5hbWUgKyAiLmdldCg6cGFyYW0pID09IG51bGwpIiwKICAgICAgICAg\nICAgICAgIHNlbGVjdFdoZXJlICsgIiEoIiArIG5hbWUgKyAiLmdldCg6cGFy\nYW0pICE9ICIgKyBuYW1lICsKICAgICAgICAgICAgICAgICAgICAiLmdldCg6\ncGFyYW0pKSIsCiAgICAgICAgICAgIH0pKTsKCiAgICAgICAgICAgIGZvciAo\nSXRlcmF0b3IgcWkgPSBnZXRRdWVyaWVzLml0ZXJhdG9yKCk7IHFpLmhhc05l\neHQoKTspIHsKICAgICAgICAgICAgICAgIFN0cmluZyBxdWVyeSA9IChTdHJp\nbmcpIHFpLm5leHQoKTsKICAgICAgICAgICAgICAgIGlmICh2YWx1ZUNsYXNz\nID09IFN0cmluZy5jbGFzcykKICAgICAgICAgICAgICAgICAgICBxdWVyeSAr\nPSAiIG9yZGVyIGJ5ICIgKyBuYW1lICsgIi5nZXQoOnBhcmFtKSBkZXNjIjsK\nICAgICAgICAgICAgICAgIE9wZW5KUEFRdWVyeSBxID0gcG0uY3JlYXRlUXVl\ncnkoSkRPUUwsIHF1ZXJ5KTsKICAgICAgICAgICAgICAgIHEuc2V0UGFyYW1l\ndGVyKCJwYXJhbSIsIHBhcmFtKTsKICAgICAgICAgICAgICAgIGFzc2VydFNp\nemUoMSwgcS5nZXRSZXN1bHRMaXN0KCkpOwogICAgICAgICAgICB9CiAgICAg\nICAgfQogICAgICAgIGVuZFR4KHBtKTsKICAgICAgICBlbmRFbShwbSk7Cgog\nICAgICAgIGVuZEVtKHNyY3BtKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCB0\nZXN0UENLZXlTdHJpbmdWYWx1ZSgpCiAgICAgICAgdGhyb3dzIEV4Y2VwdGlv\nbiB7CiAgICAgICAgdGVzdE1hcCg1LCAidGVzdFBDS2V5U3RyaW5nVmFsdWUi\nLAogICAgICAgICAgICBNYXBFbGVtZW50UEMuY2xhc3MsIFN0cmluZy5jbGFz\ncyk7CiAgICB9CgogICAgcHVibGljIHZvaWQgdGVzdFN0cmluZ0tleVBDVmFs\ndWUoKQogICAgICAgIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIHRlc3RN\nYXAoNiwgInRlc3RTdHJpbmdLZXlQQ1ZhbHVlIiwKICAgICAgICAgICAgU3Ry\naW5nLmNsYXNzLCBNYXBFbGVtZW50UEMuY2xhc3MpOwogICAgfQoKICAgIHB1\nYmxpYyB2b2lkIHRlc3RQQ0tleVBDVmFsdWUoKQogICAgICAgIHRocm93cyBF\neGNlcHRpb24gewogICAgICAgIHRlc3RNYXAoNywgInRlc3RQQ0tleVBDVmFs\ndWUiLAogICAgICAgICAgICBNYXBFbGVtZW50UEMuY2xhc3MsIE1hcEVsZW1l\nbnRQQy5jbGFzcyk7CiAgICB9CgogICAgcHVibGljIHZvaWQgdGVzdFBDU3Vi\nS2V5U3RyaW5nVmFsdWUoKQogICAgICAgIHRocm93cyBFeGNlcHRpb24gewog\nICAgICAgIHRlc3RNYXAoOCwgInRlc3RQQ1N1YktleVN0cmluZ1ZhbHVlIiwK\nICAgICAgICAgICAgTWFwRWxlbWVudFBDQ2hpbGQuY2xhc3MsIFN0cmluZy5j\nbGFzcyk7CiAgICB9CgogICAgcHVibGljIHZvaWQgdGVzdFN0cmluZ0tleVBD\nU3ViVmFsdWUoKQogICAgICAgIHRocm93cyBFeGNlcHRpb24gewogICAgICAg\nIHRlc3RNYXAoOSwgInRlc3RTdHJpbmdLZXlQQ1N1YlZhbHVlIiwKICAgICAg\nICAgICAgU3RyaW5nLmNsYXNzLCBNYXBFbGVtZW50UENDaGlsZC5jbGFzcyk7\nCiAgICB9CgogICAgcHVibGljIHZvaWQgdGVzdFBDU3ViS2V5UENWYWx1ZSgp\nCiAgICAgICAgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgdGVzdE1hcCgx\nMCwgInRlc3RQQ1N1YktleVBDVmFsdWUiLAogICAgICAgICAgICBNYXBFbGVt\nZW50UENDaGlsZC5jbGFzcywgTWFwRWxlbWVudFBDLmNsYXNzKTsKICAgIH0K\nCiAgICBwdWJsaWMgdm9pZCB0ZXN0UENTdWJLZXlQQ1N1YlZhbHVlKCkKICAg\nICAgICB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICB0ZXN0TWFwKDExLCAi\ndGVzdFBDU3ViS2V5UENTdWJWYWx1ZSIsCiAgICAgICAgICAgIE1hcEVsZW1l\nbnRQQ0NoaWxkLmNsYXNzLCBNYXBFbGVtZW50UENDaGlsZC5jbGFzcyk7CiAg\nICB9CgogICAgcHVibGljIHZvaWQgdGVzdFBDS2V5UENTdWJWYWx1ZSgpCiAg\nICAgICAgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgdGVzdE1hcCgxMiwg\nInRlc3RQQ0tleVBDU3ViVmFsdWUiLAogICAgICAgICAgICBNYXBFbGVtZW50\nUEMuY2xhc3MsIE1hcEVsZW1lbnRQQ0NoaWxkLmNsYXNzKTsKICAgIH0KCiAg\nICBwdWJsaWMgdm9pZCB0ZXN0UENJbnRmS2V5U3RyaW5nVmFsdWUoKQogICAg\nICAgIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIHRlc3RNYXAoMTMsICJ0\nZXN0UENJbnRmS2V5U3RyaW5nVmFsdWUiLAogICAgICAgICAgICBNYXBFbGVt\nZW50UEMuY2xhc3MsIFN0cmluZy5jbGFzcyk7CiAgICB9CgogICAgcHVibGlj\nIHZvaWQgdGVzdFN0cmluZ0tleVBDSW50ZlZhbHVlKCkKICAgICAgICB0aHJv\nd3MgRXhjZXB0aW9uIHsKICAgICAgICB0ZXN0TWFwKDE0LCAidGVzdFN0cmlu\nZ0tleVBDSW50ZlZhbHVlIiwKICAgICAgICAgICAgU3RyaW5nLmNsYXNzLCBN\nYXBFbGVtZW50UEMuY2xhc3MpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHRl\nc3RQQ0ludGZLZXlQQ1ZhbHVlKCkKICAgICAgICB0aHJvd3MgRXhjZXB0aW9u\nIHsKICAgICAgICB0ZXN0TWFwKDE1LCAidGVzdFBDSW50ZktleVBDVmFsdWUi\nLAogICAgICAgICAgICBNYXBFbGVtZW50UEMuY2xhc3MsIE1hcEVsZW1lbnRQ\nQy5jbGFzcyk7CiAgICB9CgogICAgLyoqCiAgICAgKiBUZXN0IHF1ZXJ5aW5n\nIG1hcHMgd2hlbiB0aGVyZSBhcmUgbXVsdGlwbGUgaG9sZGVyIGluc3RhbmNl\ncyB0aGF0CiAgICAgKiBoYXZlIG1hcHMgd2l0aCB0aGUgc2FtZSBrZXkuCiAg\nICAgKi8KICAgIHB1YmxpYyB2b2lkIHRlc3RRdWVyeU11bHRpcGxlTWFwcygp\nIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIGRlbGV0ZUFsbChQZXJzaXN0\nZW50TWFwSG9sZGVyLmNsYXNzKTsKCiAgICAgICAgU3RyaW5nIG1hcE5hbWUg\nPSAidGVzdFN0cmluZ0tleVBDVmFsdWUiOwoKICAgICAgICBTdHJpbmdbXSBt\nYXBOYW1lcyA9IG5ldyBTdHJpbmdbXXsKICAgICAgICAgICAgInRlc3RQQ0tl\neVN0cmluZ1ZhbHVlIiwKICAgICAgICAgICAgLy8gInRlc3RTdHJpbmdLZXlQ\nQ1ZhbHVlIiwKICAgICAgICAgICAgInRlc3RQQ0tleVBDVmFsdWUiLAogICAg\nICAgICAgICAidGVzdFBDU3ViS2V5U3RyaW5nVmFsdWUiLAogICAgICAgICAg\nICAidGVzdFN0cmluZ0tleVBDU3ViVmFsdWUiLAogICAgICAgICAgICAidGVz\ndFBDU3ViS2V5UENWYWx1ZSIsCiAgICAgICAgICAgICJ0ZXN0UENTdWJLZXlQ\nQ1N1YlZhbHVlIiwKICAgICAgICAgICAgInRlc3RQQ0tleVBDU3ViVmFsdWUi\nLAogICAgICAgICAgICAidGVzdFBDSW50ZktleVN0cmluZ1ZhbHVlIiwKICAg\nICAgICAgICAgInRlc3RTdHJpbmdLZXlQQ0ludGZWYWx1ZSIsCiAgICAgICAg\nICAgICJ0ZXN0UENJbnRmS2V5UENWYWx1ZSIsCiAgICAgICAgfTsKCiAgICAg\nICAgT3BlbkpQQUVudGl0eU1hbmFnZXIgcG07CgogICAgICAgIHBtID0gZ2V0\nUE0oKTsKICAgICAgICBzdGFydFR4KHBtKTsKCiAgICAgICAgTWFwRWxlbWVu\ndFBDIHBjID0gbmV3IE1hcEVsZW1lbnRQQygpOwogICAgICAgIHBjLnNldEVs\nZW1lbnREYXRhKCJmb28iKTsKCiAgICAgICAgaW50IG1heCA9IDU7CgogICAg\nICAgIGZvciAoaW50IGkgPSAwOyBpIDwgbWF4OyBpKyspIHsKICAgICAgICAg\nICAgUGVyc2lzdGVudE1hcEhvbGRlciBob2xkZXIgPSBuZXcgUGVyc2lzdGVu\ndE1hcEhvbGRlcigpOwogICAgICAgICAgICBmb3IgKGludCBqID0gMDsgaiA8\nIGk7IGorKykgewogICAgICAgICAgICAgICAgaG9sZGVyLmdldE5hbWVkTWFw\nKG1hcE5hbWUpLnB1dCgia2V5IiArIGosIHBjKTsKICAgICAgICAgICAgfQog\nICAgICAgICAgICBwbS5wZXJzaXN0KGhvbGRlcik7CiAgICAgICAgfQoKICAg\nICAgICBlbmRUeChwbSk7CiAgICAgICAgZW5kRW0ocG0pOwoKICAgICAgICBw\nbSA9IGdldFBNKCk7CiAgICAgICAgcGMgPSAoTWFwRWxlbWVudFBDKSBwbS5m\naW5kKE1hcEVsZW1lbnRQQy5jbGFzcywgcG0uZ2V0T2JqZWN0SWQocGMpKTsK\nICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IG1heDsgaSsrKSB7CiAgICAg\nICAgICAgIE9wZW5KUEFRdWVyeSBxOwoKICAgICAgICAgICAgU3RyaW5nIGtl\neSA9ICJrZXkiICsgaTsKICAgICAgICAgICAgU3RyaW5nIHNlbGVjdFdoZXJl\nID0gInNlbGVjdCBmcm9tICIgKwogICAgICAgICAgICAgICAgUGVyc2lzdGVu\ndE1hcEhvbGRlci5jbGFzcy5nZXROYW1lKCkgKyAiIHdoZXJlICI7CiAgICAg\nICAgICAgIHEgPSBwbS5jcmVhdGVRdWVyeShKRE9RTCwKICAgICAgICAgICAg\nICAgIHNlbGVjdFdoZXJlICsgbWFwTmFtZSArICIuY29udGFpbnNLZXkoOmtl\neSkiKTsKICAgICAgICAgICAgcS5zZXRQYXJhbWV0ZXIoImtleSIsIGtleSk7\nCiAgICAgICAgICAgIGFzc2VydFNpemUobWF4IC0gaSAtIDEsIHEuZ2V0UmVz\ndWx0TGlzdCgpKTsKCiAgICAgICAgICAgIHEgPSBwbS5jcmVhdGVRdWVyeShK\nRE9RTCwKICAgICAgICAgICAgICAgIHNlbGVjdFdoZXJlICsgbWFwTmFtZSAr\nICIuZ2V0KDprZXkpID09IDp2YWwiKTsKICAgICAgICAgICAgcS5zZXRQYXJh\nbWV0ZXIoImtleSIsIGtleSk7CiAgICAgICAgICAgIHEuc2V0UGFyYW1ldGVy\nKCJ2YWwiLCBwYyk7CiAgICAgICAgICAgIGFzc2VydFNpemUobWF4IC0gaSAt\nIDEsIHEuZ2V0UmVzdWx0TGlzdCgpKTsKCiAgICAgICAgICAgIHEgPSBwbS5j\ncmVhdGVRdWVyeShKRE9RTCwKICAgICAgICAgICAgICAgIHNlbGVjdFdoZXJl\nICsgInRlc3RQQ0tleVN0cmluZ1ZhbHVlLmlzRW1wdHkoKSAmJiAiCiAgICAg\nICAgICAgICAgICAgICAgKyBtYXBOYW1lICsgIi5nZXQoOmtleSkgPT0gOnZh\nbCIpOwogICAgICAgICAgICBxLnNldFBhcmFtZXRlcigia2V5Iiwga2V5KTsK\nICAgICAgICAgICAgcS5zZXRQYXJhbWV0ZXIoInZhbCIsIHBjKTsKICAgICAg\nICAgICAgYXNzZXJ0U2l6ZShtYXggLSBpIC0gMSwgcS5nZXRSZXN1bHRMaXN0\nKCkpOwoKICAgICAgICAgICAgLy8gbm93IHRyeSB0byBleGVjdXRlIHF1ZXJp\nZXMgYWdhaW5zdCBtdWx0aXBsZSBvdGhlcgogICAgICAgICAgICAvLyBtYXAg\naW5zdGFuY2VzLCBzbyB3ZSBjYW4gbWFrZSBzdXJlIHRoZSBqb2lucyBhcmUg\ncm9idXN0CiAgICAgICAgICAgIGZvciAoaW50IGogPSAwOyBqIDwgbWFwTmFt\nZXMubGVuZ3RoOyBqKyspIHsKICAgICAgICAgICAgICAgIFN0cmluZ0J1ZmZl\nciBxdWVyeSA9IG5ldyBTdHJpbmdCdWZmZXIoc2VsZWN0V2hlcmUpOwoKICAg\nICAgICAgICAgICAgIGZvciAoaW50IGsgPSAwOyBrIDwgajsgaysrKSB7CiAg\nICAgICAgICAgICAgICAgICAgcXVlcnkuYXBwZW5kKG1hcE5hbWVzW2tdICsg\nIi5pc0VtcHR5KCkgJiYgIik7CiAgICAgICAgICAgICAgICB9CgogICAgICAg\nICAgICAgICAgcSA9IHBtLmNyZWF0ZVF1ZXJ5KEpET1FMLAogICAgICAgICAg\nICAgICAgICAgIHF1ZXJ5ICsgbWFwTmFtZSArICIuZ2V0KDprZXkpID09IDp2\nYWwiKTsKICAgICAgICAgICAgICAgIHEuc2V0UGFyYW1ldGVyKCJrZXkiLCBr\nZXkpOwogICAgICAgICAgICAgICAgcS5zZXRQYXJhbWV0ZXIoInZhbCIsIHBj\nKTsKICAgICAgICAgICAgICAgIGFzc2VydFNpemUobWF4IC0gaSAtIDEsIHEu\nZ2V0UmVzdWx0TGlzdCgpKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAg\nICAgICBlbmRFbShwbSk7CiAgICB9Cn0K\n","encoding":"base64"}

