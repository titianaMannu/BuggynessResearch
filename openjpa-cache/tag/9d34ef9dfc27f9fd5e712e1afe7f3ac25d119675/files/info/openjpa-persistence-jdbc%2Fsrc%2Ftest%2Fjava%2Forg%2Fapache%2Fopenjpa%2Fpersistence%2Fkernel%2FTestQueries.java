{"sha":"1aa5be740078705c29b3cf3c4e8a5cbd33b8552c","node_id":"MDQ6QmxvYjIwNjM2NDoxYWE1YmU3NDAwNzg3MDVjMjliM2NmM2M0ZThhNWNiZDMzYjg1NTJj","size":7553,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/1aa5be740078705c29b3cf3c4e8a5cbd33b8552c","content":"LyoKICogVGVzdFF1ZXJpZXMuamF2YQogKgogKiBDcmVhdGVkIG9uIE9jdG9i\nZXIgMTMsIDIwMDYsIDQ6MjcgUE0KICoKICogVG8gY2hhbmdlIHRoaXMgdGVt\ncGxhdGUsIGNob29zZSBUb29scyB8IFRlbXBsYXRlIE1hbmFnZXIKICogYW5k\nIG9wZW4gdGhlIHRlbXBsYXRlIGluIHRoZSBlZGl0b3IuCiAqLwoKLyoKICog\nTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0aW9uIChB\nU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxpY2Vuc2Ug\nYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlzdHJpYnV0\nZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3JtYXRpb24K\nICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUgQVNGIGxp\nY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFwYWNoZSBM\naWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7IHlvdSBt\nYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2UKICog\nd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0\naGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGlj\nZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFw\ncGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAogKiBzb2Z0\nd2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmli\ndXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdBUlJBTlRJ\nRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVyIGV4cHJl\nc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlCiAqIHNw\nZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQgbGlt\naXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8KcGFja2Fn\nZSBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2Uua2VybmVsOwoKaW1w\nb3J0IGphdmEudXRpbC5Db2xsZWN0aW9uOwppbXBvcnQgamF2YS51dGlsLkl0\nZXJhdG9yOwoKCgppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNpc3Rl\nbmNlLmtlcm5lbC5jb21tb24uYXBwcy5SdW50aW1lVGVzdDE7CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2Uua2VybmVsLmNvbW1vbi5h\ncHBzLlJ1bnRpbWVUZXN0MjsKCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\ncGVyc2lzdGVuY2UuRXh0ZW50OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLnBlcnNpc3RlbmNlLk9wZW5KUEFFbnRpdHlNYW5hZ2VyOwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNlLk9wZW5KUEFRdWVyeTsKCnB1\nYmxpYyBjbGFzcyBUZXN0UXVlcmllcyBleHRlbmRzIEJhc2VLZXJuZWxUZXN0\nIHsKCiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBpbnQgQ0hJTERfQ09VTlQg\nPSAzOwogICAgcHJpdmF0ZSBpbnQgaWQgPSAxMDAwMDsKCiAgICBwdWJsaWMg\nVGVzdFF1ZXJpZXMoU3RyaW5nIG5hbWUpIHsKICAgICAgICBzdXBlcihuYW1l\nKTsKICAgIH0KCiAgICBwdWJsaWMgVGVzdFF1ZXJpZXMoKSB7CiAgICB9Cgog\nICAgcHVibGljIHZvaWQgc2V0VXAoKQogICAgICAgIHRocm93cyBFeGNlcHRp\nb24gewogICAgICAgIHN1cGVyLnNldFVwKCk7CiAgICAgICAgZGVsZXRlQWxs\nKFJ1bnRpbWVUZXN0MS5jbGFzcyk7CiAgICB9CgogICAgcHVibGljIHZvaWQg\ndGVzdFNpbXBsZVF1ZXJ5KCkgewogICAgICAgIE9wZW5KUEFFbnRpdHlNYW5h\nZ2VyIHBtID0gZ2V0UE0oKTsKCiAgICAgICAgcGVyc2lzdChuZXdSdW50aW1l\nVGVzdDEoIlNpbXBsZVF1ZXJ5QSIsIDUwKSwgcG0pOwogICAgICAgIHBlcnNp\nc3QobmV3UnVudGltZVRlc3QyKCJTaW1wbGVRdWVyeUIiLCA1MCksIHBtKTsK\nCiAgICAgICAgQ29sbGVjdGlvbiByZXN1bHRzID0gcnVuUXVlcnkoUnVudGlt\nZVRlc3QxLmNsYXNzLCBmYWxzZSwKICAgICAgICAgICAgInN0cmluZ0ZpZWxk\nID0gXCdTaW1wbGVRdWVyeUFcJyIsIHBtKTsKICAgICAgICBhc3NlcnRFcXVh\nbHMoMSwgcmVzdWx0cy5zaXplKCkpOwoKICAgICAgICByZXN1bHRzID0gcnVu\nUXVlcnkoUnVudGltZVRlc3QxLmNsYXNzLCB0cnVlLCAiaW50RmllbGQxID0g\nNTAiLCBwbSk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKDIsIHJlc3VsdHMuc2l6\nZSgpKTsKCiAgICAgICAgcmVzdWx0cyA9IHJ1blF1ZXJ5KFJ1bnRpbWVUZXN0\nMi5jbGFzcywgdHJ1ZSwgImludEZpZWxkMSA9IDUwIiwgcG0pOwogICAgICAg\nIGFzc2VydEVxdWFscygxLCByZXN1bHRzLnNpemUoKSk7CgogICAgICAgIHJl\nc3VsdHMgPSBydW5RdWVyeShSdW50aW1lVGVzdDIuY2xhc3MsIGZhbHNlLCAi\naW50RmllbGQxID0gNTAiLCBwbSk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKDEs\nIHJlc3VsdHMuc2l6ZSgpKTsKCiAgICAgICAgZW5kRW0ocG0pOwogICAgfQoK\nICAgIHB1YmxpYyB2b2lkIHRlc3RBbmRRdWVyeSgpIHsKICAgICAgICBTdHJp\nbmcgcXVlcnkgPSAiaW50RmllbGQxID4gMTAgQU5EIG8uaW50RmllbGQxIDwg\nNTAiOwoKICAgICAgICBmb3IgKGludCBjdXJyZW50Q291bnQgPSAxOyBjdXJy\nZW50Q291bnQgPCAxNTsgY3VycmVudENvdW50KyspIHsKICAgICAgICAgICAg\nT3BlbkpQQUVudGl0eU1hbmFnZXIgcG0gPSBnZXRQTSgpOwoKICAgICAgICAg\nICAgLy8gbWFrZSBzdXJlIHRoYXQgbm9uZSBleGlzdAogICAgICAgICAgICBk\nZWxldGVCeVF1ZXJ5KFJ1bnRpbWVUZXN0MS5jbGFzcywgZmFsc2UsIHF1ZXJ5\nLCBwbSk7CgogICAgICAgICAgICBzdGFydFR4KHBtKTsKICAgICAgICAgICAg\nZm9yIChpbnQgaSA9IDE7IGkgPD0gY3VycmVudENvdW50OyBpKyspCiAgICAg\nICAgICAgICAgICBwbS5wZXJzaXN0KG5ld1J1bnRpbWVUZXN0MSgiQW5kUXVl\ncnlUZXN0IiwgMzAgKyBpKSk7CiAgICAgICAgICAgIGVuZFR4KHBtKTsKCiAg\nICAgICAgICAgIC8vIHZlcmlmeSB0aGF0IHRoZSBxdWVyeSB3b3Jrcy4KICAg\nICAgICAgICAgQ29sbGVjdGlvbiByZXN1bHRzID0gcnVuUXVlcnkoUnVudGlt\nZVRlc3QxLmNsYXNzLCBmYWxzZSwKICAgICAgICAgICAgICAgIHF1ZXJ5LCBw\nbSk7CiAgICAgICAgICAgIGFzc2VydEVxdWFscyhjdXJyZW50Q291bnQsIHJl\nc3VsdHMuc2l6ZSgpKTsKICAgICAgICAgICAgZW5kRW0ocG0pOwogICAgICAg\nIH0KICAgIH0KCiAgICBwdWJsaWMgdm9pZCB0ZXN0UmVsYXRpb25RdWVyeSgp\nIHsKICAgICAgICByZWxhdGlvblF1ZXJ5KDEwLCAiSk9FIiwgMjApOwogICAg\nICAgIHJlbGF0aW9uUXVlcnkoOTksICJCT0IiLCAyKTsKICAgICAgICByZWxh\ndGlvblF1ZXJ5KDMsICJNQVJUSEEiLCAxKTsKICAgICAgICByZWxhdGlvblF1\nZXJ5KDUsICJicmVuZGEiLCA0Myk7CiAgICAgICAgcmVsYXRpb25RdWVyeSg0\nMywgIlNhckEiLCA1NSk7CiAgICB9CgogICAgcHVibGljIHZvaWQgcmVsYXRp\nb25RdWVyeShpbnQgaW50RmllbGQsIFN0cmluZyBzdHJpbmdGaWVsZCwgaW50\nIGNvdW50KSB7CiAgICAgICAgT3BlbkpQQUVudGl0eU1hbmFnZXIgcG0gPSBn\nZXRQTSgpOwoKICAgICAgICBTdHJpbmcgcXVlcnkgPSAic2VsZk9uZU9uZS5p\nbnRGaWVsZDEgPSAiICsgaW50RmllbGQKICAgICAgICAgICAgKyAiIEFORCBv\nLnNlbGZPbmVPbmUuc3RyaW5nRmllbGQgPSAnIiArIHN0cmluZ0ZpZWxkICsg\nIiciOwogICAgICAgIGRlbGV0ZUJ5UXVlcnkoUnVudGltZVRlc3QxLmNsYXNz\nLCB0cnVlLCBxdWVyeSwgcG0pOwoKICAgICAgICAvLyB3ZSBnbyB1cCB0aGUg\ndG8gbWF4IGNvdW50LCBhZGRpbmcgdG8gdGhlIHBlb3BsZSwgYW5kIHZhbGlk\nYXRlCiAgICAgICAgLy8gd2l0aCBhIHF1ZXJ5IGVhY2ggdGltZS4KICAgICAg\nICBmb3IgKGludCBjdXJyZW50Y291bnQgPSAwOyBjdXJyZW50Y291bnQgPD0g\nY291bnQ7IGN1cnJlbnRjb3VudCsrKSB7CiAgICAgICAgICAgIGlmIChjdXJy\nZW50Y291bnQgIT0gMCkKICAgICAgICAgICAgICAgIHBlcnNpc3QobmV3UnVu\ndGltZVRlc3QyKHN0cmluZ0ZpZWxkLCBpbnRGaWVsZCksIHBtKTsKCiAgICAg\nICAgICAgIENvbGxlY3Rpb24gcmVzdWx0cyA9IHJ1blF1ZXJ5KFJ1bnRpbWVU\nZXN0MS5jbGFzcywgdHJ1ZSwgcXVlcnksIHBtKTsKICAgICAgICAgICAgYXNz\nZXJ0RXF1YWxzKCJxdWVyeSAoIiArIHF1ZXJ5ICsgIikgZmFpbGVkIHRvIHlp\nZWxkICIKICAgICAgICAgICAgICAgICsgY3VycmVudGNvdW50ICsgIiBpbnN0\nYW5jZXMiLAogICAgICAgICAgICAgICAgY3VycmVudGNvdW50ICogQ0hJTERf\nQ09VTlQsIHJlc3VsdHMuc2l6ZSgpKTsKICAgICAgICB9CgogICAgICAgIGVu\nZEVtKHBtKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCB0ZXN0UXVlcnlFeGVj\ndXRlVGhyb3dzRXhjZXB0aW9uV2hlbk5vTlRSKCkgewogICAgICAgIE9wZW5K\nUEFFbnRpdHlNYW5hZ2VyIHBtID0gZ2V0UE0oKTsKICAgICAgICBzdGFydFR4\nKHBtKTsKICAgICAgICBwbS5wZXJzaXN0KG5ld1J1bnRpbWVUZXN0MSgiUXVl\ncnkiLCAxMCkpOwogICAgICAgIGVuZFR4KHBtKTsKCiAgICAgICAgcG0uc2V0\nTm9udHJhbnNhY3Rpb25hbFJlYWQoZmFsc2UpOwovLyAgICAgICAgT3BlbkpQ\nQVF1ZXJ5IHEgPSBwbS5jcmVhdGVOYXRpdmVRdWVyeSgiIixSdW50aW1lVGVz\ndDEuY2xhc3MpOwogICAgICAgIE9wZW5KUEFRdWVyeSBxID0gcG0uY3JlYXRl\nUXVlcnkoIlNFTEVDVCBvIEZST00gUnVudGltZVRlc3QxIG8iKTsKICAgICAg\nICB0cnkgewogICAgICAgICAgICBDb2xsZWN0aW9uIGMgPSAoQ29sbGVjdGlv\nbikgcS5nZXRSZXN1bHRMaXN0KCk7CiAgICAgICAgICAgIGZhaWwoIlF1ZXJ5\nLmV4ZWN1dGUoKSBzaG91bGQgaGF2ZSB0aHJvd24gYSBKRE9FeGNlcHRpb24g\nd2hlbiAiCiAgICAgICAgICAgICAgICArICJQTSBpcyBvdXRzaWRlIGEgVHJh\nbnNhY3Rpb24gYW5kIE5UUj09ZmFsc2UiKTsKICAgICAgICB9IGNhdGNoIChF\neGNlcHRpb24gamRvZSkgewogICAgICAgICAgICAvLyBnb29kCiAgICAgICAg\nICAgIHN0YXJ0VHgocG0pOwogICAgICAgICAgICBxLmdldFJlc3VsdExpc3Qo\nKTsKICAgICAgICAgICAgcm9sbGJhY2tUeChwbSk7CiAgICAgICAgfQogICAg\nfQoKICAgIC8qKgogICAgICogRGVsZXRlIHRoZSByZXN1bHRzIG9mIGEgcXVl\ncnksIHNvIHdlIGNhbiByZWluc2VydCBhbmQgdGVzdC4KICAgICAqLwogICAg\ncHJpdmF0ZSB2b2lkIGRlbGV0ZUJ5UXVlcnkoQ2xhc3MgdHlwZSwgYm9vbGVh\nbiBzdWJzLCBTdHJpbmcgZmlsdGVyLAogICAgICAgIE9wZW5KUEFFbnRpdHlN\nYW5hZ2VyIHBtKSB7CiAgICAgICAgc3RhcnRUeChwbSk7CiAgICAgICAgRXh0\nZW50IGV4dGVudCA9IHBtLmNyZWF0ZUV4dGVudCh0eXBlLCBzdWJzKTsKICAg\nICAgICAvL0ZJWE1FIGp0aG9tYXMKLy8gICAgICAgIE9wZW5KUEFRdWVyeSBx\ndWVyeSA9IHBtLm5ld1F1ZXJ5KGV4dGVudCwgZmlsdGVyKTsKLy8gICAgICAg\nIENvbGxlY3Rpb24gaXRlbXMgPSAoQ29sbGVjdGlvbikgcXVlcnkuZXhlY3V0\nZSgpOwogICAgICAgIFN0cmluZyBjc3RybmcgPSB0eXBlLmdldFNpbXBsZU5h\nbWUoKTsKCiAgICAgICAgT3BlbkpQQVF1ZXJ5IHF1ZXJ5ID0KICAgICAgICAg\nICAgcG0uY3JlYXRlUXVlcnkoIlNFTEVDVCBvIEZST00gIiArIGNzdHJuZyAr\nICIgbyBXSEVSRSBvLiIgKyBmaWx0ZXIpOwogICAgICAgIHF1ZXJ5LnNldFN1\nYmNsYXNzZXMoc3Vicyk7CiAgICAgICAgQ29sbGVjdGlvbiBpdGVtcyA9IChD\nb2xsZWN0aW9uKSBxdWVyeS5nZXRSZXN1bHRMaXN0KCk7CiAgICAgICAgZm9y\nIChJdGVyYXRvciBpID0gaXRlbXMuaXRlcmF0b3IoKTsgaS5oYXNOZXh0KCk7\nKQogICAgICAgICAgICBwbS5yZW1vdmUoaS5uZXh0KCkpOwoKICAgICAgICAv\nL0ZJWE1FIGp0aG9tYXMKICAgICAgICAvL3F1ZXJ5ID0gcG0ubmV3UXVlcnko\nZXh0ZW50LCBmaWx0ZXIpOwoKICAgICAgICBxdWVyeSA9CiAgICAgICAgICAg\nIHBtLmNyZWF0ZVF1ZXJ5KCJTRUxFQ1QgbyBGUk9NICIgKyBjc3RybmcgKyAi\nIG8gV0hFUkUgby4iICsgZmlsdGVyKTsKICAgICAgICBxdWVyeS5zZXRTdWJj\nbGFzc2VzKHN1YnMpOwogICAgICAgIGl0ZW1zID0gcXVlcnkuZ2V0UmVzdWx0\nTGlzdCgpOwogICAgICAgIGVuZFR4KHBtKTsKICAgICAgICBhc3NlcnRFcXVh\nbHMoImFmdGVyIGRlbGV0aW5nIGZyb20gcXVlcnkgKCIgKyBxdWVyeQogICAg\nICAgICAgICArICIpLCB0aGVyZSBzaG91bGQgaGF2ZSBiZWVuIHplcm8gaXRl\nbXMiLAogICAgICAgICAgICAwLCBpdGVtcy5zaXplKCkpOwogICAgfQoKICAg\nIHByaXZhdGUgQ29sbGVjdGlvbiBydW5RdWVyeShDbGFzcyB0eXBlLCBib29s\nZWFuIHN1YnMsIFN0cmluZyBmaWx0ZXIsCiAgICAgICAgT3BlbkpQQUVudGl0\neU1hbmFnZXIgcG0pIHsKICAgICAgICBFeHRlbnQgZXh0ZW50ID0gcG0uY3Jl\nYXRlRXh0ZW50KHR5cGUsIHN1YnMpOwogICAgICAgIC8vRklYTUUganRob21h\ncwogICAgICAgIC8vUXVlcnkgcXVlcnkgPSBwbS5uZXdRdWVyeShleHRlbnQs\nIGZpbHRlcik7CiAgICAgICAgU3RyaW5nIGNzdHJuZyA9IHR5cGUuZ2V0TmFt\nZSgpOwogICAgICAgIE9wZW5KUEFRdWVyeSBxdWVyeSA9CiAgICAgICAgICAg\nIHBtLmNyZWF0ZVF1ZXJ5KCJTRUxFQ1QgbyBGUk9NICIgKyBjc3RybmcgKyAi\nIG8gV0hFUkUgby4iICsgZmlsdGVyKTsKICAgICAgICBxdWVyeS5zZXRTdWJj\nbGFzc2VzKHN1YnMpOwogICAgICAgIENvbGxlY3Rpb24gcmVzdWx0cyA9IChD\nb2xsZWN0aW9uKSBxdWVyeS5nZXRSZXN1bHRMaXN0KCk7CiAgICAgICAgcmV0\ndXJuIHJlc3VsdHM7CiAgICB9CgogICAgcHJpdmF0ZSB2b2lkIHBlcnNpc3Qo\nUnVudGltZVRlc3QxIHBhcmVudCwgT3BlbkpQQUVudGl0eU1hbmFnZXIgcG0p\nIHsKICAgICAgICBSdW50aW1lVGVzdDEgY2hpbGQ7CiAgICAgICAgZm9yIChp\nbnQgaSA9IDA7IGkgPCBDSElMRF9DT1VOVDsgaSsrKSB7CiAgICAgICAgICAg\nIGNoaWxkID0gbmV3UnVudGltZVRlc3QxKCJDSElMRCIgKyBpLCBpICogMTAp\nOwogICAgICAgICAgICBjaGlsZC5zZXRTZWxmT25lT25lKHBhcmVudCk7CiAg\nICAgICAgICAgIHBhcmVudC5nZXRTZWxmT25lTWFueSgpLmFkZChjaGlsZCk7\nCiAgICAgICAgfQoKICAgICAgICBzdGFydFR4KHBtKTsKICAgICAgICBwbS5w\nZXJzaXN0KHBhcmVudCk7CiAgICAgICAgZW5kVHgocG0pOwogICAgfQoKICAg\nIHByaXZhdGUgUnVudGltZVRlc3QxIG5ld1J1bnRpbWVUZXN0MShTdHJpbmcg\nc3RyaW5nRmllbGQsIGludCBpbnRGaWVsZCkgewogICAgICAgIFJ1bnRpbWVU\nZXN0MSBwYyA9IG5ldyBSdW50aW1lVGVzdDEoc3RyaW5nRmllbGQsIGludEZp\nZWxkKTsKICAgICAgICBwYy5zZXRJbnRGaWVsZChpZCsrKTsKICAgICAgICBy\nZXR1cm4gcGM7CiAgICB9CgogICAgcHJpdmF0ZSBSdW50aW1lVGVzdDIgbmV3\nUnVudGltZVRlc3QyKFN0cmluZyBzdHJpbmdGaWVsZCwgaW50IGludEZpZWxk\nKSB7CiAgICAgICAgUnVudGltZVRlc3QyIHBjID0gbmV3IFJ1bnRpbWVUZXN0\nMihzdHJpbmdGaWVsZCwgaW50RmllbGQpOwogICAgICAgIHBjLnNldEludEZp\nZWxkKGlkKyspOwogICAgICAgIHJldHVybiBwYzsKICAgIH0KfQo=\n","encoding":"base64"}

