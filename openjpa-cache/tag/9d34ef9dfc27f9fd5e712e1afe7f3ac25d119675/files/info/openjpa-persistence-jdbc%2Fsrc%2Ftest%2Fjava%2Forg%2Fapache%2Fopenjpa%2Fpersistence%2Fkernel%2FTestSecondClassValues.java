{"sha":"425e9cf0e5391542f646f0595a5698c451dab7b8","node_id":"MDQ6QmxvYjIwNjM2NDo0MjVlOWNmMGU1MzkxNTQyZjY0NmYwNTk1YTU2OThjNDUxZGFiN2I4","size":25974,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/425e9cf0e5391542f646f0595a5698c451dab7b8","content":"LyoKICogVGVzdFNlY29uZENsYXNzVmFsdWVzLmphdmEKICoKICogQ3JlYXRl\nZCBvbiBPY3RvYmVyIDEzLCAyMDA2LCA1OjI5IFBNCiAqCiAqIFRvIGNoYW5n\nZSB0aGlzIHRlbXBsYXRlLCBjaG9vc2UgVG9vbHMgfCBUZW1wbGF0ZSBNYW5h\nZ2VyCiAqIGFuZCBvcGVuIHRoZSB0ZW1wbGF0ZSBpbiB0aGUgZWRpdG9yLgog\nKi8KLyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3Vu\nZGF0aW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9y\nIGxpY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICog\nZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5m\nb3JtYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBU\naGUgQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhl\nIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNl\nIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBs\naWFuY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEg\nY29weSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNo\nZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVp\ncmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5n\nLAogKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBp\ncyBkaXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VU\nIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0\naGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3Ig\ndGhlCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9u\ncyBhbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAog\nKi8KcGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2Uua2Vy\nbmVsOwoKaW1wb3J0IGphdmEubWF0aC5CaWdEZWNpbWFsOwppbXBvcnQgamF2\nYS5tYXRoLkJpZ0ludGVnZXI7CmltcG9ydCBqYXZhLnRleHQuQ29sbGF0b3I7\nCmltcG9ydCBqYXZhLnV0aWwuQXJyYXlMaXN0OwppbXBvcnQgamF2YS51dGls\nLkNvbGxlY3Rpb247CmltcG9ydCBqYXZhLnV0aWwuQ29sbGVjdGlvbnM7Cmlt\ncG9ydCBqYXZhLnV0aWwuQ29tcGFyYXRvcjsKaW1wb3J0IGphdmEudXRpbC5E\nYXRlOwppbXBvcnQgamF2YS51dGlsLkhhc2hNYXA7CmltcG9ydCBqYXZhLnV0\naWwuSXRlcmF0b3I7CmltcG9ydCBqYXZhLnV0aWwuTGlua2VkTGlzdDsKaW1w\nb3J0IGphdmEudXRpbC5MaXN0OwppbXBvcnQgamF2YS51dGlsLk1hcDsKCgoK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5rZXJuZWwu\nY29tbW9uLmFwcHMuU0NPVGVzdDsKaW1wb3J0IG9yZy5hcGFjaGUub3Blbmpw\nYS5wZXJzaXN0ZW5jZS5jb21tb24udXRpbHMuQWJzdHJhY3RUZXN0Q2FzZTsK\naW1wb3J0IGp1bml0LmZyYW1ld29yay5Bc3NlcnRpb25GYWlsZWRFcnJvcjsK\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuT3BlbkpQ\nQUVudGl0eU1hbmFnZXI7CgpwdWJsaWMgY2xhc3MgVGVzdFNlY29uZENsYXNz\nVmFsdWVzIGV4dGVuZHMgQmFzZUtlcm5lbFRlc3QgewoKICAgIHB1YmxpYyBz\ndGF0aWMgZG91YmxlIERPVUJMRV9QUkVDSVNJT04gPSAwLjAwMDFEOwogICAg\ncHVibGljIHN0YXRpYyBmbG9hdCBGTE9BVF9QUkVDSVNJT04gPSAwLjAwMDFG\nOwogICAgLy8gbXBydWRob206IHVzZSBvcHRpbWlzdGljIHNvIHdlIGRvbid0\nIGhhbmcgb24gc29tZSBkYXRhYmFzZXMKICAgIHByaXZhdGUgT3BlbkpQQUVu\ndGl0eU1hbmFnZXIgcG07CgogICAgcHJpdmF0ZSBTdHJpbmcgbmV3bGluZSA9\nIFN5c3RlbS5nZXRQcm9wZXJ0eSgibGluZS5zZXBhcmF0b3IiKTsKCiAgICAv\nKioKICAgICAqIENyZWF0ZXMgYSBuZXcgaW5zdGFuY2Ugb2YgVGVzdFNlY29u\nZENsYXNzVmFsdWVzCiAgICAgKi8KICAgIHB1YmxpYyBUZXN0U2Vjb25kQ2xh\nc3NWYWx1ZXMoKSB7CiAgICB9CgogICAgcHVibGljIFRlc3RTZWNvbmRDbGFz\nc1ZhbHVlcyhTdHJpbmcgbmFtZSkgewogICAgICAgIHN1cGVyKG5hbWUpOwog\nICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldFVwKCkgewogICAgICAgIHBtID0g\nZ2V0UE0odHJ1ZSwgZmFsc2UpOwogICAgfQoKICAgIHByaXZhdGUgaW50IHJu\nZCgpIHsKICAgICAgICByZXR1cm4gKChpbnQpIChNYXRoLnJhbmRvbSgpICog\nMjApKSArIDU7CiAgICB9CgogICAgcHVibGljIHZvaWQgdGVzdE1hcERlbGV0\naW9uKCkgewogICAgICAgIE9wZW5KUEFFbnRpdHlNYW5hZ2VyIHBtOwogICAg\nICAgIHBtID0gZ2V0UE0oKTsKICAgICAgICBzdGFydFR4KHBtKTsKICAgICAg\nICBTQ09UZXN0IHRlc3QgPSBuZXcgU0NPVGVzdCgpOwogICAgICAgIHBtLnBl\ncnNpc3QodGVzdCk7CiAgICAgICAgTWFwIG1hcCA9IG5ldyBIYXNoTWFwKCk7\nCiAgICAgICAgbWFwLnB1dCgiZm9vIiwgbmV3IEludGVnZXIoMSkpOwogICAg\nICAgIG1hcC5wdXQoImJhciIsIG5ldyBJbnRlZ2VyKDIpKTsKICAgICAgICBm\nb3IgKGludCBpID0gMDsgaSA8IDEwOyBpKyspCiAgICAgICAgICAgIG1hcC5w\ndXQoImJheiMiICsgaSwgbmV3IEludGVnZXIoaSkpOwoKICAgICAgICB0ZXN0\nLnNldFN0ckludE1hcChtYXApOwogICAgICAgIE9iamVjdCBpZCA9IHBtLmdl\ndE9iamVjdElkKHRlc3QpOwogICAgICAgIGVuZFR4KHBtKTsKCiAgICAgICAg\nc3RhcnRUeChwbSk7CiAgICAgICAgdGVzdCA9IChTQ09UZXN0KSBwbS5maW5k\nKFNDT1Rlc3QuY2xhc3MsIGlkKTsKICAgICAgICBhc3NlcnROb3ROdWxsKHRl\nc3QpOwogICAgICAgIG1hcCA9IHRlc3QuZ2V0U3RySW50TWFwKCk7CiAgICAg\nICAgYXNzZXJ0RXF1YWxzKDEyLCBtYXAuc2l6ZSgpKTsKICAgICAgICBhc3Nl\ncnRFcXVhbHMobmV3IEludGVnZXIoMSksIG1hcC5nZXQoImZvbyIpKTsKICAg\nICAgICBhc3NlcnRFcXVhbHMobmV3IEludGVnZXIoMiksIG1hcC5nZXQoImJh\nciIpKTsKICAgICAgICBtYXAucmVtb3ZlKCJiYXIiKTsKICAgICAgICBlbmRU\neChwbSk7CgogICAgICAgIHN0YXJ0VHgocG0pOwogICAgICAgIHRlc3QgPSAo\nU0NPVGVzdCkgcG0uZmluZChTQ09UZXN0LmNsYXNzLCBpZCk7CiAgICAgICAg\nYXNzZXJ0Tm90TnVsbCh0ZXN0KTsKICAgICAgICBtYXAgPSB0ZXN0LmdldFN0\nckludE1hcCgpOwogICAgICAgIGFzc2VydEVxdWFscygxMSwgbWFwLnNpemUo\nKSk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKG5ldyBJbnRlZ2VyKDEpLCBtYXAu\nZ2V0KCJmb28iKSk7CiAgICAgICAgYXNzZXJ0VHJ1ZShtYXAuZ2V0KCJiYXIi\nKSA9PSBudWxsKTsKCiAgICAgICAgbWFwLmNsZWFyKCk7CgogICAgICAgIGVu\nZFR4KHBtKTsKCiAgICAgICAgc3RhcnRUeChwbSk7CiAgICAgICAgdGVzdCA9\nIChTQ09UZXN0KSBwbS5maW5kKFNDT1Rlc3QuY2xhc3MsIGlkKTsKICAgICAg\nICBhc3NlcnROb3ROdWxsKHRlc3QpOwogICAgICAgIG1hcCA9IHRlc3QuZ2V0\nU3RySW50TWFwKCk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKDAsIG1hcC5zaXpl\nKCkpOwogICAgICAgIGVuZFR4KHBtKTsKICAgIH0KCiAgICBwdWJsaWMgdm9p\nZCB0ZXN0U3RyaW5nQ29sbGVjdGlvbigpCiAgICAgICAgdGhyb3dzIEV4Y2Vw\ndGlvbiB7CiAgICAgICAgQXJyYXlMaXN0IGxpc3QgPSBuZXcgQXJyYXlMaXN0\nKCk7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBybmQoKTsgaSsrKQog\nICAgICAgICAgICBsaXN0LmFkZChyYW5kb21TdHJpbmcoKSk7CgogICAgICAg\nIHNhdmVTZWNvbmRDbGFzc0NvbGxlY3Rpb24obGlzdCk7CiAgICB9CgogICAg\ncHVibGljIHZvaWQgdGVzdExvbmdDb2xsZWN0aW9uKCkKICAgICAgICB0aHJv\nd3MgRXhjZXB0aW9uIHsKICAgICAgICBBcnJheUxpc3QgbGlzdCA9IG5ldyBB\ncnJheUxpc3QoKTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IHJuZCgp\nOyBpKyspCiAgICAgICAgICAgIGxpc3QuYWRkKHJhbmRvbUxvbmcoKSk7CiAg\nICAgICAgdHJ5IHsKICAgICAgICAgICAgc2F2ZVNlY29uZENsYXNzQ29sbGVj\ndGlvbihsaXN0KTsKICAgICAgICB9IGNhdGNoIChBc3NlcnRpb25GYWlsZWRF\ncnJvciBhZmUpIHsKICAgICAgICAgICAgYnVnKEFic3RyYWN0VGVzdENhc2Uu\nUGxhdGZvcm0uRU1QUkVTUywgODg5LCBhZmUsCiAgICAgICAgICAgICAgICAi\nRW1wcmVzcyBjYW5ub3Qgc3RvcmUgbGFyZ2UgbG9uZyB2YWx1ZXMiKTsKICAg\nICAgICB9CiAgICB9CgogICAgcHVibGljIHZvaWQgdGVzdFNob3J0Q29sbGVj\ndGlvbigpCiAgICAgICAgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgQXJy\nYXlMaXN0IGxpc3QgPSBuZXcgQXJyYXlMaXN0KCk7CiAgICAgICAgZm9yIChp\nbnQgaSA9IDA7IGkgPCBybmQoKTsgaSsrKQogICAgICAgICAgICBsaXN0LmFk\nZChyYW5kb21TaG9ydCgpKTsKICAgICAgICBzYXZlU2Vjb25kQ2xhc3NDb2xs\nZWN0aW9uKGxpc3QpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHRlc3RCaWdJ\nbnRlZ2VyQ29sbGVjdGlvbigpCiAgICAgICAgdGhyb3dzIEV4Y2VwdGlvbiB7\nCiAgICAgICAgQXJyYXlMaXN0IGxpc3QgPSBuZXcgQXJyYXlMaXN0KCk7CiAg\nICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBybmQoKTsgaSsrKQogICAgICAg\nICAgICBsaXN0LmFkZChyYW5kb21CaWdJbnRlZ2VyKCkpOwogICAgICAgIHNh\ndmVTZWNvbmRDbGFzc0NvbGxlY3Rpb24obGlzdCk7CiAgICB9CgogICAgcHVi\nbGljIHZvaWQgdGVzdEJpZ0RlY2ltYWxDb2xsZWN0aW9uKCkKICAgICAgICB0\naHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICB0cnkgewogICAgICAgICAgICBB\ncnJheUxpc3QgbGlzdCA9IG5ldyBBcnJheUxpc3QoKTsKICAgICAgICAgICAg\nZm9yIChpbnQgaSA9IDA7IGkgPCBybmQoKTsgaSsrKQogICAgICAgICAgICAg\nICAgbGlzdC5hZGQocmFuZG9tQmlnRGVjaW1hbCgpKTsKICAgICAgICAgICAg\nc2F2ZVNlY29uZENsYXNzQ29sbGVjdGlvbihsaXN0KTsKICAgICAgICB9IGNh\ndGNoIChBc3NlcnRpb25GYWlsZWRFcnJvciBlKSB7CiAgICAgICAgICAgIGJ1\nZygzLCBlLCAiUHJlY2lzaW9uIGxvc3MgZm9yIEJpZ0RlY2ltYWxzIik7CiAg\nICAgICAgfQogICAgfQoKICAgIHB1YmxpYyB2b2lkIHRlc3RJbnRlZ2VyQ29s\nbGVjdGlvbigpCiAgICAgICAgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAg\nQXJyYXlMaXN0IGxpc3QgPSBuZXcgQXJyYXlMaXN0KCk7CiAgICAgICAgZm9y\nIChpbnQgaSA9IDA7IGkgPCBybmQoKTsgaSsrKQogICAgICAgICAgICBsaXN0\nLmFkZChyYW5kb21JbnQoKSk7CiAgICAgICAgc2F2ZVNlY29uZENsYXNzQ29s\nbGVjdGlvbihsaXN0KTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCB0ZXN0Qnl0\nZUNvbGxlY3Rpb24oKQogICAgICAgIHRocm93cyBFeGNlcHRpb24gewogICAg\nICAgIEFycmF5TGlzdCBsaXN0ID0gbmV3IEFycmF5TGlzdCgpOwogICAgICAg\nIGZvciAoaW50IGkgPSAwOyBpIDwgcm5kKCk7IGkrKykKICAgICAgICAgICAg\nbGlzdC5hZGQocmFuZG9tQnl0ZSgpKTsKICAgICAgICBzYXZlU2Vjb25kQ2xh\nc3NDb2xsZWN0aW9uKGxpc3QpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHRl\nc3RCb29sZWFuQ29sbGVjdGlvbigpCiAgICAgICAgdGhyb3dzIEV4Y2VwdGlv\nbiB7CiAgICAgICAgQXJyYXlMaXN0IGxpc3QgPSBuZXcgQXJyYXlMaXN0KCk7\nCiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBybmQoKTsgaSsrKQogICAg\nICAgICAgICBsaXN0LmFkZChyYW5kb21Cb29sZWFuKCkpOwogICAgICAgIHNh\ndmVTZWNvbmRDbGFzc0NvbGxlY3Rpb24obGlzdCwgdHJ1ZSk7CiAgICB9Cgog\nICAgcHVibGljIHZvaWQgdGVzdEZsb2F0Q29sbGVjdGlvbigpCiAgICAgICAg\ndGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAg\nQXJyYXlMaXN0IGxpc3QgPSBuZXcgQXJyYXlMaXN0KCk7CiAgICAgICAgICAg\nIGZvciAoaW50IGkgPSAwOyBpIDwgcm5kKCk7IGkrKykKICAgICAgICAgICAg\nICAgIGxpc3QuYWRkKHJhbmRvbUZsb2F0KCkpOwogICAgICAgICAgICBzYXZl\nU2Vjb25kQ2xhc3NDb2xsZWN0aW9uKGxpc3QpOwogICAgICAgIH0gY2F0Y2gg\nKEFzc2VydGlvbkZhaWxlZEVycm9yIGFmZSkgewogICAgICAgICAgICBidWco\nMywgYWZlLCAiTG9zcyBvZiBCaWdEZWNpbWFsIHByZWNpc2lvbiIpOwogICAg\nICAgIH0KICAgIH0KCiAgICBwdWJsaWMgdm9pZCB0ZXN0RG91YmxlQ29sbGVj\ndGlvbigpCiAgICAgICAgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgdHJ5\nIHsKICAgICAgICAgICAgQXJyYXlMaXN0IGxpc3QgPSBuZXcgQXJyYXlMaXN0\nKCk7CiAgICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgcm5kKCk7IGkr\nKykKICAgICAgICAgICAgICAgIGxpc3QuYWRkKHJhbmRvbURvdWJsZSgpKTsK\nICAgICAgICAgICAgc2F2ZVNlY29uZENsYXNzQ29sbGVjdGlvbihsaXN0KTsK\nICAgICAgICB9IGNhdGNoIChBc3NlcnRpb25GYWlsZWRFcnJvciBhZmUpIHsK\nICAgICAgICAgICAgYnVnKDMsIGFmZSwgIkxvc3Mgb2YgQmlnRGVjaW1hbCBw\ncmVjaXNpb24iKTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGljIHZvaWQg\ndGVzdERhdGVDb2xsZWN0aW9uKCkKICAgICAgICB0aHJvd3MgRXhjZXB0aW9u\nIHsKICAgICAgICBBcnJheUxpc3QgbGlzdCA9IG5ldyBBcnJheUxpc3QoKTsK\nICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IHJuZCgpOyBpKyspCiAgICAg\nICAgICAgIGxpc3QuYWRkKHJhbmRvbURhdGUoKSk7CgogICAgICAgIGxpc3Qu\nYWRkKG5ldyBEYXRlKDQ3MjI0NjgwMDAwMEwpKTsKCiAgICAgICAgc2F2ZVNl\nY29uZENsYXNzQ29sbGVjdGlvbihsaXN0KTsKICAgIH0KCiAgICBwdWJsaWMg\ndm9pZCB0ZXN0QmlnRGVjaW1hbEJpZ0ludGVnZXJNYXAoKQogICAgICAgIHRo\ncm93cyBFeGNlcHRpb24gewogICAgICAgIHRyeSB7CiAgICAgICAgICAgIEhh\nc2hNYXAgbWFwID0gbmV3IEhhc2hNYXAoKTsKICAgICAgICAgICAgZm9yIChp\nbnQgaSA9IDA7IGkgPCBybmQoKTsgaSsrKQogICAgICAgICAgICAgICAgbWFw\nLnB1dChyYW5kb21CaWdEZWNpbWFsKCksIHJhbmRvbUJpZ0ludGVnZXIoKSk7\nCiAgICAgICAgICAgIHNhdmVTZWNvbmRDbGFzc01hcChtYXApOwogICAgICAg\nIH0gY2F0Y2ggKEFzc2VydGlvbkZhaWxlZEVycm9yIGUpIHsKICAgICAgICAg\nICAgYnVnKDMsIGUsICJQcmVjaXNpb24gbG9zcyBmb3IgQmlnRGVjaW1hbHMi\nKTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGljIHZvaWQgdGVzdFN0cklu\ndE1hcCgpCiAgICAgICAgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgSGFz\naE1hcCBtYXAgPSBuZXcgSGFzaE1hcCgpOwogICAgICAgIGZvciAoaW50IGkg\nPSAwOyBpIDwgcm5kKCk7IGkrKykKICAgICAgICAgICAgbWFwLnB1dChyYW5k\nb21TdHJpbmcoKSwgcmFuZG9tSW50KCkpOwogICAgICAgIHNhdmVTZWNvbmRD\nbGFzc01hcChtYXApOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHRlc3RJbnRM\nb25nTWFwKCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgSGFzaE1hcCBt\nYXAgPSBuZXcgSGFzaE1hcCgpOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBp\nIDwgcm5kKCk7IGkrKykKICAgICAgICAgICAgbWFwLnB1dChyYW5kb21JbnQo\nKSwgcmFuZG9tTG9uZygpKTsKICAgICAgICB0cnkgewogICAgICAgICAgICBz\nYXZlU2Vjb25kQ2xhc3NNYXAobWFwKTsKICAgICAgICB9CiAgICAgICAgY2F0\nY2ggKEFzc2VydGlvbkZhaWxlZEVycm9yIGFmZSkgewogICAgICAgICAgICBi\ndWcoQWJzdHJhY3RUZXN0Q2FzZS5QbGF0Zm9ybS5FTVBSRVNTLCA4ODksIGFm\nZSwKICAgICAgICAgICAgICAgICJFbXByZXNzIGNhbm5vdCBzdG9yZSBsYXJn\nZSBsb25nIHZhbHVlcyIpOwogICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMg\ndm9pZCB0ZXN0RmxvYXRCeXRlTWFwKCkKICAgICAgICB0aHJvd3MgRXhjZXB0\naW9uIHsKICAgICAgICB0cnkgewogICAgICAgICAgICBIYXNoTWFwIG1hcCA9\nIG5ldyBIYXNoTWFwKCk7CiAgICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBp\nIDwgcm5kKCk7IGkrKykKICAgICAgICAgICAgICAgIG1hcC5wdXQocmFuZG9t\nRmxvYXQoKSwgcmFuZG9tQnl0ZSgpKTsKICAgICAgICAgICAgc2F2ZVNlY29u\nZENsYXNzTWFwKG1hcCk7CiAgICAgICAgfSBjYXRjaCAoQXNzZXJ0aW9uRmFp\nbGVkRXJyb3IgYWZlKSB7CiAgICAgICAgICAgIGJ1ZygzLCBhZmUsICJMb3Nz\nIG9mIEJpZ0RlY2ltYWwgcHJlY2lzaW9uIik7CiAgICAgICAgfQogICAgfQoK\nICAgIHB1YmxpYyB2b2lkIHRlc3RCeXRlRG91YmxlTWFwKCkKICAgICAgICB0\naHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICB0cnkgewogICAgICAgICAgICBI\nYXNoTWFwIG1hcCA9IG5ldyBIYXNoTWFwKCk7CiAgICAgICAgICAgIGZvciAo\naW50IGkgPSAwOyBpIDwgcm5kKCk7IGkrKykKICAgICAgICAgICAgICAgIG1h\ncC5wdXQocmFuZG9tQnl0ZSgpLCByYW5kb21Eb3VibGUoKSk7CiAgICAgICAg\nICAgIHNhdmVTZWNvbmRDbGFzc01hcChtYXApOwogICAgICAgIH0gY2F0Y2gg\nKEFzc2VydGlvbkZhaWxlZEVycm9yIGFmZSkgewogICAgICAgICAgICBidWco\nMywgYWZlLCAiTG9zcyBvZiBCaWdEZWNpbWFsIHByZWNpc2lvbiIpOwogICAg\nICAgIH0KICAgIH0KCiAgICBwdWJsaWMgdm9pZCB0ZXN0RG91YmxlQ2hhck1h\ncCgpCiAgICAgICAgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgdHJ5IHsK\nICAgICAgICAgICAgSGFzaE1hcCBtYXAgPSBuZXcgSGFzaE1hcCgpOwogICAg\nICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IHJuZCgpOyBpKyspCiAgICAg\nICAgICAgICAgICBtYXAucHV0KHJhbmRvbURvdWJsZSgpLCByYW5kb21DaGFy\nKCkpOwogICAgICAgICAgICBzYXZlU2Vjb25kQ2xhc3NNYXAobWFwKTsKICAg\nICAgICB9IGNhdGNoIChBc3NlcnRpb25GYWlsZWRFcnJvciBhZmUpIHsKICAg\nICAgICAgICAgYnVnKDMsIGFmZSwgIkxvc3Mgb2YgQmlnRGVjaW1hbCBwcmVj\naXNpb24iKTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGljIHZvaWQgdGVz\ndENoYXJCb29sZWFuTWFwKCkKICAgICAgICB0aHJvd3MgRXhjZXB0aW9uIHsK\nICAgICAgICBIYXNoTWFwIG1hcCA9IG5ldyBIYXNoTWFwKCk7CiAgICAgICAg\nZm9yIChpbnQgaSA9IDA7IGkgPCBybmQoKTsgaSsrKQogICAgICAgICAgICBt\nYXAucHV0KHJhbmRvbUNoYXIoKSwgcmFuZG9tQm9vbGVhbigpKTsKICAgICAg\nICBzYXZlU2Vjb25kQ2xhc3NNYXAobWFwKTsKICAgIH0KCiAgICBwdWJsaWMg\ndm9pZCB0ZXN0RGF0ZVN0ck1hcCgpIHRocm93cyBFeGNlcHRpb24gewogICAg\nICAgIEhhc2hNYXAgbWFwID0gbmV3IEhhc2hNYXAoKTsKICAgICAgICBmb3Ig\nKGludCBpID0gMDsgaSA8IHJuZCgpOyBpKyspCiAgICAgICAgICAgIG1hcC5w\ndXQocmFuZG9tRGF0ZSgpLCByYW5kb21TdHJpbmcoKSk7CgogICAgICAgIG1h\ncC5wdXQobmV3IERhdGUoNDcyMjQ2ODAwMDAwTCksCiAgICAgICAgICAgICJQ\nb3N0Z3JlU1FMIGFpbid0IGdvbm5hIGxpa2UgdGhpcyBkYXRlIik7CiAgICAg\nICAgYXNzZXJ0Tm90TnVsbCgibWFwIGlzIG51bGwgdGVzdERhdGVTdHJNYXAi\nLCBtYXApOwogICAgICAgIHNhdmVTZWNvbmRDbGFzc01hcChtYXApOwogICAg\nfQoKICAgIHByaXZhdGUgdm9pZCBzYXZlU2Vjb25kQ2xhc3NNYXAoSGFzaE1h\ncCBtYXApCiAgICAgICAgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgdHJ5\nIHsKICAgICAgICAgICAgc2F2ZVNlY29uZENsYXNzTWFwSW50ZXJuYWwobWFw\nKTsKICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICBjb21taXQoKTsK\nICAgICAgICB9CiAgICB9CgogICAgcHJpdmF0ZSB2b2lkIGNvbW1pdCgpIHsK\nICAgICAgICB0cnkgewogICAgICAgICAgICBhc3NlcnROb3ROdWxsKHBtKTsK\nCi8vICAJCUVudGl0eVRyYW5zYWN0aW9uIHRyYW5zID0gcG0uZ2V0VHJhbnNh\nY3Rpb24oKTsKLy8gIAkJaWYgKHRyYW5zICE9IG51bGwgJiYgdHJhbnMuaXNB\nY3RpdmUoKSkgewovLyAgCQl0cmFucy5jb21taXQoKTsKICAgICAgICAgICAg\nZW5kVHgocG0pOwogICAgICAgIH0KICAgICAgICBjYXRjaCAoRXhjZXB0aW9u\nIGUpIHsKICAgICAgICAgICAgZS5wcmludFN0YWNrVHJhY2UoKTsKICAgICAg\nICB9CiAgICB9CgogICAgcHJpdmF0ZSB2b2lkIGJlZ2luKCkgewogICAgICAg\nIGNvbW1pdCgpOyAvLyBtYWtlIHN1cmUgd2UgYXJlIGNsZWFuCgogICAgICAg\nIC8vIGdldCBhIGZyZXNoIFBNCiAgICAgICAgcG0gPSBnZXRQTSh0cnVlLCBm\nYWxzZSk7CiAgICAgICAgc3RhcnRUeChwbSk7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBTYXZlIHRoZSBzcGVjaWZpZWQgbWFwIGFzIGEgc2Vjb25kLWNsYXNz\nIG9iamVjdCBhbmQgdmFsaWRhdGUKICAgICAqIGl0cyBjb250ZW50cyBieSBy\nZWFkaW5nIGJhY2sgaW4gdGhlIG9iamVjdCBhbmQgY29tcGFyaW5nCiAgICAg\nKiBhbGwgdGhlIHZhbHVlcyB0byB0aGUgb3JpZ2luYWwuIEZ1cnRoZXJtb3Jl\nLCB0aGlzIG1ldGhvZAogICAgICogZGVsZXRlcyBlYWNoIGVsZW1lbnQgb2Yg\nYm90aCBtYXBzIGluIHR1cm4gYW5kIHJlLXZhbGlkYXRlcwogICAgICogZWFj\naCB0aW1lIHRvIG1ha2Ugc3VyZSB1cGRhdGluZyBvZiB0aGUgbWFwIGlzIHdv\ncmtpbmcgY29ycmVjdGx5LgogICAgICovCiAgICBwcml2YXRlIHZvaWQgc2F2\nZVNlY29uZENsYXNzTWFwSW50ZXJuYWwoSGFzaE1hcCBtYXApIHRocm93cyBF\neGNlcHRpb24gewogICAgICAgIGJlZ2luKCk7CiAgICAgICAgU0NPVGVzdCB0\nZXN0ID0gbmV3IFNDT1Rlc3QoKTsKICAgICAgICBwbS5wZXJzaXN0KHRlc3Qp\nOwogICAgICAgIGludCB0ZXN0SUQgPSB0ZXN0LmdldElkKCk7CiAgICAgICAg\nYXNzZXJ0Tm90TnVsbCgiUGFzc2VkIE1hcCBpcyBudWxsIiwgbWFwKTsKICAg\nICAgICBNYXAgc21hcCA9IHNldEdldE1hcCh0ZXN0LCBtYXAsIHRydWUpOwog\nICAgICAgIGFzc2VydE5vdE51bGwoIk1hcCBpcyBudWxsIGluIHNldEdldE1h\ncCIsIHNtYXApOwogICAgICAgIGNvbW1pdCgpOwoKICAgICAgICBmb3IgKEl0\nZXJhdG9yIG1hcEtleSA9ICgoSGFzaE1hcCkgbWFwLmNsb25lKCkpLmtleVNl\ndCgpLml0ZXJhdG9yKCk7CiAgICAgICAgICAgIG1hcEtleS5oYXNOZXh0KCk7\nKSB7CiAgICAgICAgICAgIE9iamVjdCBrZXlUb0RlbGV0ZSA9IG1hcEtleS5u\nZXh0KCk7CgogICAgICAgICAgICBiZWdpbigpOwogICAgICAgICAgICBTQ09U\nZXN0IHJldHJpZXZlZE9iamVjdCA9CiAgICAgICAgICAgICAgICAoU0NPVGVz\ndCkgcG0uZmluZChTQ09UZXN0LmNsYXNzLCB0ZXN0SUQpOwoKICAgICAgICAg\nICAgYXNzZXJ0Tm90TnVsbCgKICAgICAgICAgICAgICAgICJyZXRyaWV2ZWRP\nYmplY3QgT2JqIGlzIG51bGwgLSBzYXZlU2Vjb25kQ2xhc3NNYXBJbnRlcm5h\nbCIsCiAgICAgICAgICAgICAgICByZXRyaWV2ZWRPYmplY3QpOwoKICAgICAg\nICAgICAgTWFwIHJldHJpZXZlZE1hcCA9IHNldEdldE1hcChyZXRyaWV2ZWRP\nYmplY3QsIG1hcCwgZmFsc2UpOwoKICAgICAgICAgICAgYXNzZXJ0Tm90TnVs\nbCgKICAgICAgICAgICAgICAgICJyZXRyaWV2ZWRNYXAgT2JqIGlzIG51bGwg\nLSBzYXZlU2Vjb25kQ2xhc3NNYXBJbnRlcm5hbCIsCiAgICAgICAgICAgICAg\nICByZXRyaWV2ZWRNYXApOwoKICAgICAgICAgICAgYXNzZXJ0VHJ1ZShtYXAu\nc2l6ZSgpICE9IDApOwogICAgICAgICAgICBhc3NlcnRFcXVhbHMobWFwLnNp\nemUoKSwgcmV0cmlldmVkTWFwLnNpemUoKSk7CgogICAgICAgICAgICBhc3Nl\ncnRUcnVlKCJJbmNvbXBhdGlibGUgdHlwZXMiLCBtYXAua2V5U2V0KCkuaXRl\ncmF0b3IoKS5uZXh0KCkuCiAgICAgICAgICAgICAgICBnZXRDbGFzcygpLmlz\nQXNzaWduYWJsZUZyb20ocmV0cmlldmVkTWFwLmtleVNldCgpLgogICAgICAg\nICAgICAgICAgaXRlcmF0b3IoKS5uZXh0KCkuZ2V0Q2xhc3MoKSkpOwoKICAg\nICAgICAgICAgLy8gY2hlY2sgdG8gbWFrZSBzdXJlIGFsbCB0aGUga2V5cyBt\nYXRjaCB1cCB0byB0aGUgYXBwcm9wcmlhdGUKICAgICAgICAgICAgLy8gdmFs\ndWVzLgogICAgICAgICAgICBmb3IgKEl0ZXJhdG9yIGkgPSBtYXAua2V5U2V0\nKCkuaXRlcmF0b3IoKTsgaS5oYXNOZXh0KCk7KSB7CiAgICAgICAgICAgICAg\nICBPYmplY3Qga2V5ID0gaS5uZXh0KCk7CiAgICAgICAgICAgICAgICBhc3Nl\ncnRUcnVlKGtleSAhPSBudWxsKTsKICAgICAgICAgICAgICAgIGFzc2VydFRy\ndWUobWFwLmdldChrZXkpICE9IG51bGwpOwogICAgICAgICAgICAgICAgaWYg\nKGtleS5nZXRDbGFzcygpID09IERhdGUuY2xhc3MKICAgICAgICAgICAgICAg\nICAgICAmJiByZXRyaWV2ZWRNYXAuZ2V0KGtleSkgPT0gbnVsbCkgewogICAg\nICAgICAgICAgICAgICAgIGdldExvZygpLnRyYWNlKCJUaW1lOiAiCiAgICAg\nICAgICAgICAgICAgICAgICAgICsgKCgoRGF0ZSkga2V5KS5nZXRUaW1lKCkp\nKTsKICAgICAgICAgICAgICAgICAgICBnZXRMb2coKS50cmFjZSgiTGlzdDog\nIgogICAgICAgICAgICAgICAgICAgICAgICArIGR1bXBEYXRlcyhyZXRyaWV2\nZWRNYXAua2V5U2V0KCkpKTsKCiAgICAgICAgICAgICAgICAgICAgLyoKICAg\nICAgICAgICAgICAgICAgICAgICAgYnVnICg2LCAiRGF0ZXMgbG9zZSBwcmVj\naXNpb24gaW4gc29tZSBkYXRhIHN0b3JlcyAiCiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICArICIoIiArICgoKERhdGUpa2V5KS5nZXRUaW1lICgpKSAr\nICIsIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgKyAiWyIgKyBkdW1w\nRGF0ZXMgKHJldHJpZXZlZE1hcC5rZXlTZXQgKCkpICsgIl0pIik7CiAgICAg\nICAgICAgICAgICAgICAgKi8KICAgICAgICAgICAgICAgIH0KICAgICAgICAg\nICAgICAgIGlmICgoa2V5LmdldENsYXNzKCkgPT0gRG91YmxlLmNsYXNzIHx8\nCiAgICAgICAgICAgICAgICAgICAga2V5LmdldENsYXNzKCkgPT0gRmxvYXQu\nY2xhc3MgfHwKICAgICAgICAgICAgICAgICAgICBrZXkuZ2V0Q2xhc3MoKSA9\nPSBCaWdEZWNpbWFsLmNsYXNzKQogICAgICAgICAgICAgICAgICAgICYmIHJl\ndHJpZXZlZE1hcC5nZXQoa2V5KSA9PSBudWxsKSB7CiAgICAgICAgICAgICAg\nICAgICAgLyoKICAgICAgICAgICAgICAgICAgICAgICAgIGJ1ZyAoMywgIkRv\ndWJsZXMgYW5kIEZsb2F0cyAiCiAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgKyAiIGxvc2UgcHJlY2lzaW9uIGluIHNvbWUgZGF0YSBzdG9yZXMiKTsK\nICAgICAgICAgICAgICAgICAgICAgKi8KICAgICAgICAgICAgICAgIH0KCiAg\nICAgICAgICAgICAgICBhc3NlcnRUcnVlKCJUaGUgb3JpZ2luYWwgbWFwIGNv\nbnRhaW5lZCB0aGUgb2JqZWN0IChjbGFzcz0iCiAgICAgICAgICAgICAgICAg\nICAgKyBrZXkuZ2V0Q2xhc3MoKS5nZXROYW1lKCkgKyAiLCB2YWx1ZT0iCiAg\nICAgICAgICAgICAgICAgICAgKyBrZXkudG9TdHJpbmcoKSArICIpLCBidXQg\ndGhhdCBvYmplY3Qgd2FzIG51bGwgIgogICAgICAgICAgICAgICAgICAgICsg\nImluIHRoZSBtYXAgdGhhdCB3YXMgcmV0cmlldmVkICIKICAgICAgICAgICAg\nICAgICAgICArIGR1bXAocmV0cmlldmVkTWFwLmtleVNldCgpKSArICIuIiwK\nICAgICAgICAgICAgICAgICAgICByZXRyaWV2ZWRNYXAuZ2V0KGtleSkgIT0g\nbnVsbCk7CiAgICAgICAgICAgICAgICBhc3NlcnRDbGFzc0FuZFZhbHVlRXF1\nYWxzKAogICAgICAgICAgICAgICAgICAgIG1hcC5nZXQoa2V5KSwgcmV0cmll\ndmVkTWFwLmdldChrZXkpKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAg\nLy8gbm93IGRlbGV0ZSB0aGUgZmlyc3Qga2V5IGluIGJvdGggbWFwcywgYW5k\nIG1ha2Ugc3VyZQogICAgICAgICAgICAvLyB0aGlua3MgYXJlIHN0aWxsIE9L\nLgogICAgICAgICAgICBtYXAucmVtb3ZlKGtleVRvRGVsZXRlKTsKICAgICAg\nICAgICAgcmV0cmlldmVkTWFwLnJlbW92ZShrZXlUb0RlbGV0ZSk7CiAgICAg\nICAgfQogICAgfQoKICAgIHByaXZhdGUgdm9pZCBzYXZlU2Vjb25kQ2xhc3ND\nb2xsZWN0aW9uKEFycmF5TGlzdCBjb2xsZWN0aW9uKQogICAgICAgIHRocm93\ncyBFeGNlcHRpb24gewogICAgICAgIHNhdmVTZWNvbmRDbGFzc0NvbGxlY3Rp\nb24oY29sbGVjdGlvbiwgZmFsc2UpOwogICAgfQoKICAgIHByaXZhdGUgdm9p\nZCBzYXZlU2Vjb25kQ2xhc3NDb2xsZWN0aW9uKEFycmF5TGlzdCBjb2xsZWN0\naW9uLAogICAgICAgIGJvb2xlYW4gdXNlQ3VzdG9tQ29sbGF0b3IpCiAgICAg\nICAgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgdHJ5IHsKICAgICAgICAg\nICAgc2F2ZVNlY29uZENsYXNzQ29sbGVjdGlvbkludGVybmFsKGNvbGxlY3Rp\nb24sIHVzZUN1c3RvbUNvbGxhdG9yKTsKICAgICAgICB9IGZpbmFsbHkgewog\nICAgICAgICAgICBjb21taXQoKTsKICAgICAgICB9CiAgICB9CgogICAgcHJp\ndmF0ZSB2b2lkIHNhdmVTZWNvbmRDbGFzc0NvbGxlY3Rpb25JbnRlcm5hbChB\ncnJheUxpc3QgY29sbGVjdGlvbiwKICAgICAgICBib29sZWFuIHVzZUN1c3Rv\nbUNvbGxhdG9yKQogICAgICAgIHRocm93cyBFeGNlcHRpb24gewogICAgICAg\nIE9iamVjdCBlbGVtZW50VG9EZWxldGUgPSBudWxsOwoKICAgICAgICBpZiAo\ndXNlQ3VzdG9tQ29sbGF0b3IpCiAgICAgICAgICAgIENvbGxlY3Rpb25zLnNv\ncnQoY29sbGVjdGlvbiwKICAgICAgICAgICAgICAgIG5ldyBDb2xsZWN0aW9u\nU29ydGVyKCkpOwogICAgICAgIGVsc2UKICAgICAgICAgICAgQ29sbGVjdGlv\nbnMuc29ydChjb2xsZWN0aW9uKTsKCiAgICAgICAgT3BlbkpQQUVudGl0eU1h\nbmFnZXIgcG0xID0gZ2V0UE0oKTsKICAgICAgICBzdGFydFR4KHBtMSk7Cgog\nICAgICAgIFNDT1Rlc3QgdGVzdCA9IG5ldyBTQ09UZXN0KCk7CiAgICAgICAg\ncG0xLnBlcnNpc3QodGVzdCk7CiAgICAgICAgaW50IHRlc3RJRCA9IHRlc3Qu\nZ2V0SWQoKTsKCiAgICAgICAgQ29sbGVjdGlvbiBzdG9yZWRDb2xsZWN0aW9u\nID0gc2V0R2V0Q29sbGVjdGlvbih0ZXN0LAogICAgICAgICAgICAoQ29sbGVj\ndGlvbikgKChBcnJheUxpc3QpIGNvbGxlY3Rpb24pLmNsb25lKCksIHRydWUp\nOwoKICAgICAgICBhc3NlcnROb3ROdWxsKCJyZXRyaWV2ZWQgc3RvcmVkQ29s\nbGVjdGlvbiBpcyBudWxsIiwgc3RvcmVkQ29sbGVjdGlvbik7CgogICAgICAg\nIC8vIG1ha2Ugc3VyZSB0aGUgcHJlLWNvbW1pdCBjb2xsZWN0aW9ucyBhcmUg\naWRlbnRpY2FsIQogICAgICAgIGFzc2VydEVxdWFscygiUHJlLWNvbW1pdCBj\nb2xsZWN0aW9ucyB3ZXJlIG5vdCBlcXVhbDogIiArIG5ld2xpbmUKICAgICAg\nICAgICAgKyBkdW1wKGNvbGxlY3Rpb24pICsgbmV3bGluZSArICIhPSIgKyBu\nZXdsaW5lCiAgICAgICAgICAgICsgZHVtcChzdG9yZWRDb2xsZWN0aW9uKSwK\nICAgICAgICAgICAgY29sbGVjdGlvbi5zaXplKCksIHN0b3JlZENvbGxlY3Rp\nb24uc2l6ZSgpKTsKCiAgICAgICAgZW5kVHgocG0xKTsKCiAgICAgICAgaW50\nIGRlbGV0aW9uSW5kZXggPSAwOwoKICAgICAgICBPcGVuSlBBRW50aXR5TWFu\nYWdlciBwbTIgPSBnZXRQTSgpOwoKICAgICAgICB3aGlsZSAoY29sbGVjdGlv\nbi5zaXplKCkgPiAwKSB7CiAgICAgICAgICAgIGRlbGV0aW9uSW5kZXgrKzsK\nCiAgICAgICAgICAgIHN0YXJ0VHgocG0yKTsKICAgICAgICAgICAgU0NPVGVz\ndCByZXRyaWV2ZWRPYmplY3QgPQogICAgICAgICAgICAgICAgKFNDT1Rlc3Qp\nIHBtMi5maW5kKFNDT1Rlc3QuY2xhc3MsIHRlc3RJRCk7CgogICAgICAgICAg\nICBhc3NlcnROb3ROdWxsKAogICAgICAgICAgICAgICAgInJldHJpZXZlZCBv\nYmogaXMgbnVsbCBzYXZlU2Vjb25kQ2xhc3NDb2xsZWN0aW9uSW50ZXJuYWwi\nLAogICAgICAgICAgICAgICAgcmV0cmlldmVkT2JqZWN0KTsKCiAgICAgICAg\nICAgIENvbGxlY3Rpb24gaWRlbnRpdHlDb2xsZWN0aW9uID0gbmV3IExpbmtl\nZExpc3QoY29sbGVjdGlvbik7CiAgICAgICAgICAgIGFzc2VydE5vdE51bGwo\nCiAgICAgICAgICAgICAgICAiaWRlbnRpdHlDb2xsZWN0aW9uIGlzIG51bGwg\nc2F2ZVNlY29uZENsYXNzQ29sbGVjdGlvbkludGVybmFsIiwKICAgICAgICAg\nICAgICAgIGlkZW50aXR5Q29sbGVjdGlvbik7CiAgICAgICAgICAgIENvbGxl\nY3Rpb24gcmV0cmlldmVkQ29sbGVjdGlvbiA9IHNldEdldENvbGxlY3Rpb24o\nCiAgICAgICAgICAgICAgICByZXRyaWV2ZWRPYmplY3QsIGlkZW50aXR5Q29s\nbGVjdGlvbiwgZmFsc2UpOwoKICAgICAgICAgICAgYXNzZXJ0Tm90TnVsbCgK\nICAgICAgICAgICAgICAgICJyZXRyaWV2ZWRDb2xsZWN0aW9uIGlzIG51bGwg\nc2F2ZVNlY29uZENsYXNzQ29sbGVjdGlvbkludGVybmFsIiwKICAgICAgICAg\nICAgICAgIHJldHJpZXZlZENvbGxlY3Rpb24pOwoKICAgICAgICAgICAgdmFs\naWRhdGVDb2xsZWN0aW9uKHJldHJpZXZlZENvbGxlY3Rpb24pOwoKICAgICAg\nICAgICAgYXNzZXJ0Tm90TnVsbChyZXRyaWV2ZWRDb2xsZWN0aW9uKTsKICAg\nICAgICAgICAgYXNzZXJ0VHJ1ZShjb2xsZWN0aW9uLnNpemUoKSAhPSAwKTsK\nCiAgICAgICAgICAgIGFzc2VydEVxdWFscygiUmV0cmVpdmVkIGNvbGxlY3Rp\nb24gZG9lcyBub3QgbWF0Y2ggb3JpZ2luYWwgIgogICAgICAgICAgICAgICAg\nKyAiYWZ0ZXIgdGhlICIgKyBkZWxldGlvbkluZGV4ICsgInRoIGRlbGV0aW9u\nICgiCiAgICAgICAgICAgICAgICArIGVsZW1lbnRUb0RlbGV0ZSArICIpOiAi\nCiAgICAgICAgICAgICAgICArIG5ld2xpbmUKICAgICAgICAgICAgICAgICsg\nZHVtcChjb2xsZWN0aW9uKSArIG5ld2xpbmUgKyAiIT0iICsgbmV3bGluZQog\nICAgICAgICAgICAgICAgKyBkdW1wKHJldHJpZXZlZENvbGxlY3Rpb24pICsg\nbmV3bGluZSwKICAgICAgICAgICAgICAgIGNvbGxlY3Rpb24uc2l6ZSgpLCBy\nZXRyaWV2ZWRDb2xsZWN0aW9uLnNpemUoKSk7CgogICAgICAgICAgICAvKgog\nICAgICAgICAgICB0cnkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAg\nYXNzZXJ0RXF1YWxzIChjb2xsZWN0aW9uLnNpemUgcmV0cmlldmVkQ29sbGVj\ndGlvbi5zaXplICgpKTsKICAgICAgICAgICAgfSBjYXRjaCAoQXNzZXJ0aW9u\nRmFpbGVkRXJyb3IgYWZlKSB7CiAgICAgICAgICAgICAgICBidWcgKEFic3Ry\nYWN0VGVzdENhc2UuUGxhdGZvcm0uU1FMU0VSVkVSLCAyLCBhZmUsICJTZWNv\nbmQtY2xhc3MgY29sbGVjdGlvbnMiCiAgICAgICAgICAgICAgICAgICAgKyAi\nIGFyZSBub3QgYmVpbmcgcmV0cmlldmVkIGNvcnJlY3RseSIpOwogICAgICAg\nICAgICB9CiAgICAgICAgICAgICovCgogICAgICAgICAgICAvLyBtYWtlIHN1\ncmUgdGhlIGNsYXNzZXMgb2YgdGhlIGtleXMgYXJlIHRoZSBzYW1lLgogICAg\nICAgICAgICBJdGVyYXRvciBjaSA9IGNvbGxlY3Rpb24uaXRlcmF0b3IoKTsK\nICAgICAgICAgICAgT2JqZWN0IGNvID0gY29sbGVjdGlvbi5pdGVyYXRvcigp\nLm5leHQoKTsKCiAgICAgICAgICAgIEl0ZXJhdG9yIHJjaSA9IHJldHJpZXZl\nZENvbGxlY3Rpb24uaXRlcmF0b3IoKTsKICAgICAgICAgICAgT2JqZWN0IHJj\nbyA9IHJldHJpZXZlZENvbGxlY3Rpb24uaXRlcmF0b3IoKS5uZXh0KCk7Cgog\nICAgICAgICAgICBhc3NlcnROb3ROdWxsKGNvKTsKICAgICAgICAgICAgYXNz\nZXJ0Tm90TnVsbChyY28pOwogICAgICAgICAgICBhc3NlcnRFcXVhbHMoY28u\nZ2V0Q2xhc3MoKSwgcmNvLmdldENsYXNzKCkpOwoKICAgICAgICAgICAgTGlz\ndCBzb3J0ZWRSZXRyZWl2ZWRDb2xsZWN0aW9uID0KICAgICAgICAgICAgICAg\nIG5ldyBBcnJheUxpc3QocmV0cmlldmVkQ29sbGVjdGlvbik7CgogICAgICAg\nICAgICBpZiAodXNlQ3VzdG9tQ29sbGF0b3IpCiAgICAgICAgICAgICAgICBD\nb2xsZWN0aW9ucy5zb3J0KHNvcnRlZFJldHJlaXZlZENvbGxlY3Rpb24sCiAg\nICAgICAgICAgICAgICAgICAgbmV3IENvbGxlY3Rpb25Tb3J0ZXIoKSk7CiAg\nICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIENvbGxlY3Rpb25zLnNv\ncnQoc29ydGVkUmV0cmVpdmVkQ29sbGVjdGlvbik7CgogICAgICAgICAgICAv\nLyBtYWtlIHN1cmUgdGhlIGNvbGxlY3Rpb24gaXMgT0sKICAgICAgICAgICAg\nZm9yIChJdGVyYXRvciBpID0gY29sbGVjdGlvbi5pdGVyYXRvcigpLAogICAg\nICAgICAgICAgICAgaiA9IHNvcnRlZFJldHJlaXZlZENvbGxlY3Rpb24uaXRl\ncmF0b3IoKTsKICAgICAgICAgICAgICAgIGkuaGFzTmV4dCgpICYmIGouaGFz\nTmV4dCgpOykgewogICAgICAgICAgICAgICAgYXNzZXJ0Q2xhc3NBbmRWYWx1\nZUVxdWFscyhpLm5leHQoKSwgai5uZXh0KCkpOwogICAgICAgICAgICB9Cgog\nICAgICAgICAgICBlbGVtZW50VG9EZWxldGUgPSBjb2xsZWN0aW9uLml0ZXJh\ndG9yKCkubmV4dCgpOwogICAgICAgICAgICBpZiAoIShjb2xsZWN0aW9uLnJl\nbW92ZShlbGVtZW50VG9EZWxldGUpKSkKICAgICAgICAgICAgICAgIGZhaWwo\nIkNvdWxkIG5vdCBkZWxldGUgZWxlbWVudCAiCiAgICAgICAgICAgICAgICAg\nICAgKyAiKDwiICsgZWxlbWVudFRvRGVsZXRlLmdldENsYXNzKCkuZ2V0TmFt\nZSgpICsgIj4iCiAgICAgICAgICAgICAgICAgICAgKyBlbGVtZW50VG9EZWxl\ndGUgKyAiKSAiCiAgICAgICAgICAgICAgICAgICAgKyAiZnJvbSAiICsgZHVt\ncChjb2xsZWN0aW9uKSk7CgogICAgICAgICAgICBpZiAoIShyZXRyaWV2ZWRD\nb2xsZWN0aW9uLnJlbW92ZShlbGVtZW50VG9EZWxldGUpKSkKICAgICAgICAg\nICAgICAgIGZhaWwoIkNvdWxkIG5vdCBkZWxldGUgZWxlbWVudCAoIiArIGVs\nZW1lbnRUb0RlbGV0ZSArICIpICIKICAgICAgICAgICAgICAgICAgICArICJm\ncm9tICIgKyBkdW1wKHJldHJpZXZlZENvbGxlY3Rpb24pKTsKCiAgICAgICAg\nICAgIGVuZFR4KHBtMik7CiAgICAgICAgfQogICAgfQoKICAgIHByaXZhdGUg\ndm9pZCBhc3NlcnRDbGFzc0FuZFZhbHVlRXF1YWxzKE9iamVjdCBvMSwgT2Jq\nZWN0IG8yKSB7CiAgICAgICAgYXNzZXJ0VHJ1ZSgiRmlyc3Qgb2JqZWN0IHdh\ncyBudWxsIiwgbzEgIT0gbnVsbCk7CiAgICAgICAgYXNzZXJ0VHJ1ZSgiU2Vj\nb25kIG9iamVjdCB3YXMgbnVsbCIsIG8yICE9IG51bGwpOwoKICAgICAgICBh\nc3NlcnRUcnVlKCJUeXBlcyBkaWQgbm90IG1hdGNoIChjbGFzczE9IgogICAg\nICAgICAgICArIG8xLmdldENsYXNzKCkuZ2V0TmFtZSgpICsgIiwgY2xhc3My\nPSIKICAgICAgICAgICAgKyBvMi5nZXRDbGFzcygpLmdldE5hbWUoKSArICIp\nIiwKICAgICAgICAgICAgbzEuZ2V0Q2xhc3MoKS5pc0Fzc2lnbmFibGVGcm9t\nKG8yLmdldENsYXNzKCkpKTsKCiAgICAgICAgLy8gZmxvYXRzIGFuZCBkb3Vi\nbGVzIGFyZSBhIGxpdHRsZSBzcGVjaWFsOiB3ZSBvbmx5CiAgICAgICAgLy8g\nY29tcGFyZSB0aGVtIHRvIGEgY2VydGFpbiBwcmVjaXNpb24sIGFmdGVyIHdo\naWNoCiAgICAgICAgLy8gd2UgZ2l2ZSB1cC4KICAgICAgICAvKgogICAgICAg\nICAgaWYgKG8xIGluc3RhbmNlb2YgRG91YmxlKQogICAgICAgICAgICAgIGFz\nc2VydEVxdWFscyAoKChEb3VibGUpbzEpLmRvdWJsZVZhbHVlICgpLAogICAg\nICAgICAgICAgICAgICAoKERvdWJsZSlvMikuZG91YmxlVmFsdWUgKCksCiAg\nICAgICAgICAgICAgICAgIERPVUJMRV9QUkVDSVNJT04pOwogICAgICAgICAg\nZWxzZSBpZiAobzEgaW5zdGFuY2VvZiBGbG9hdCkKICAgICAgICAgICAgICBh\nc3NlcnRFcXVhbHMgKCgoRmxvYXQpbzEpLmZsb2F0VmFsdWUgKCksCiAgICAg\nICAgICAgICAgICAgICgoRmxvYXQpbzIpLmZsb2F0VmFsdWUgKCksCiAgICAg\nICAgICAgICAgICAgIEZMT0FUX1BSRUNJU0lPTik7CiAgICAgICAgICBlbHNl\nIGlmIChvMSBpbnN0YW5jZW9mIEJpZ0RlY2ltYWwpCiAgICAgICAgICAgICAg\nLy8gQmlnRGVjaW1hbCBlcXVhbGlzdCBpcyBhIGxpdHRsZSBzcGVjaWFsOiBz\nZWUKICAgICAgICAgICAgICAvLyBKRE9SdW50aW1lVGVzdENhc2UuYXNzZXJ0\nRXF1YWxzKEJpZ0RlY2ltYWwsQmlnRGVjaW1hbCkKICAgICAgICAgICAgICBh\nc3NlcnRFcXVhbHMgKCJCaWdEZWNpbWFsIGRpZCBub3QgbWF0Y2giLAogICAg\nICAgICAgICAgICAgICAoQmlnRGVjaW1hbClvMSwgKEJpZ0RlY2ltYWwpbzIp\nOwogICAgICAgICAgZWxzZQogICAgICAgICAqLwogICAgICAgIGFzc2VydEVx\ndWFscygiT2JqZWN0IGRpZCBub3QgbWF0Y2ggKGNsYXNzMT0iCiAgICAgICAg\nICAgICsgbzEuZ2V0Q2xhc3MoKS5nZXROYW1lKCkgKyAiLCBjbGFzczI9Igog\nICAgICAgICAgICArIG8yLmdldENsYXNzKCkuZ2V0TmFtZSgpICsgIikiLAog\nICAgICAgICAgICBvMSwgbzIpOwogICAgfQoKICAgIHByaXZhdGUgU3RyaW5n\nIGR1bXAoQ29sbGVjdGlvbiBjb2xsKSB7CiAgICAgICAgTGlzdCBsaXN0ID0g\nbmV3IExpbmtlZExpc3QoY29sbCk7CiAgICAgICAgdHJ5IHsKICAgICAgICAg\nICAgQ29sbGVjdGlvbnMuc29ydChsaXN0KTsKICAgICAgICB9IGNhdGNoIChS\ndW50aW1lRXhjZXB0aW9uIGUpIHsKCiAgICAgICAgfQoKICAgICAgICBTdHJp\nbmdCdWZmZXIgYnVmID0gbmV3IFN0cmluZ0J1ZmZlcigpLmFwcGVuZCgiWyIp\nCiAgICAgICAgICAgIC5hcHBlbmQoIihzaXplPSIpLmFwcGVuZChsaXN0LnNp\nemUoKSkuYXBwZW5kKCIpIik7CgogICAgICAgIEl0ZXJhdG9yIGl0ID0gbGlz\ndC5pdGVyYXRvcigpOwogICAgICAgIGlmIChpdC5oYXNOZXh0KCkpCiAgICAg\nICAgICAgIGJ1Zi5hcHBlbmQoIjxjbGFzcz0iICsgaXQubmV4dCgpLmdldENs\nYXNzKCkuZ2V0TmFtZSgpICsgIj4iKTsKCiAgICAgICAgZm9yIChJdGVyYXRv\nciBpID0gbGlzdC5pdGVyYXRvcigpOyBpLmhhc05leHQoKTspCiAgICAgICAg\nICAgIGJ1Zi5hcHBlbmQoaS5uZXh0KCkpLmFwcGVuZChpLmhhc05leHQoKSA/\nICIsIiA6ICIiKTsKCiAgICAgICAgcmV0dXJuIGJ1Zi5hcHBlbmQoIl0iKS50\nb1N0cmluZygpOwogICAgfQoKICAgIHByaXZhdGUgU3RyaW5nIGR1bXBEYXRl\ncyhDb2xsZWN0aW9uIGNvbGwpIHsKICAgICAgICBTdHJpbmdCdWZmZXIgYnVm\nID0gbmV3IFN0cmluZ0J1ZmZlcigpOwogICAgICAgIGZvciAoSXRlcmF0b3Ig\naSA9IGNvbGwuaXRlcmF0b3IoKTsgaS5oYXNOZXh0KCk7KQogICAgICAgICAg\nICBidWYuYXBwZW5kKCgoRGF0ZSkgaS5uZXh0KCkpLmdldFRpbWUoKSkuYXBw\nZW5kKAogICAgICAgICAgICAgICAgaS5oYXNOZXh0KCkgPyAiLCIgOiAiIik7\nCgogICAgICAgIHJldHVybiBidWYudG9TdHJpbmcoKTsKICAgIH0KCiAgICAv\nKioKICAgICAqIEdlbmVyaWMgc2V0dGVyL2dldHRlciBmb3Igc2V0dGluZyB0\naGUgbWFwcyBwdXJwb3Nlcy4KICAgICAqLwogICAgcHJpdmF0ZSBNYXAgc2V0\nR2V0TWFwKFNDT1Rlc3QgdGVzdCwgSGFzaE1hcCBtYXAsIGJvb2xlYW4gZG9T\nZXQpIHsKICAgICAgICBpZiAobWFwID09IG51bGwpCiAgICAgICAgICAgIHJl\ndHVybiBudWxsOwoKICAgICAgICBPYmplY3Qga2V5ID0gbWFwLmtleVNldCgp\nLml0ZXJhdG9yKCkubmV4dCgpOwogICAgICAgIE9iamVjdCB2YWwgPSBtYXAu\nZ2V0KGtleSk7CgogICAgICAgIGlmIChrZXkgaW5zdGFuY2VvZiBEYXRlICYm\nIHZhbCBpbnN0YW5jZW9mIFN0cmluZykgewogICAgICAgICAgICBpZiAoZG9T\nZXQpCiAgICAgICAgICAgICAgICB0ZXN0LnNldERhdGVTdHJNYXAobWFwKTsK\nICAgICAgICAgICAgcmV0dXJuIHRlc3QuZ2V0RGF0ZVN0ck1hcCgpOwogICAg\nICAgIH0gZWxzZSBpZiAoa2V5IGluc3RhbmNlb2YgQ2hhcmFjdGVyICYmIHZh\nbCBpbnN0YW5jZW9mIEJvb2xlYW4pIHsKICAgICAgICAgICAgaWYgKGRvU2V0\nKQogICAgICAgICAgICAgICAgdGVzdC5zZXRDaGFyQm9vbGVhbk1hcChtYXAp\nOwogICAgICAgICAgICByZXR1cm4gdGVzdC5nZXRDaGFyQm9vbGVhbk1hcCgp\nOwogICAgICAgIH0gZWxzZSBpZiAoa2V5IGluc3RhbmNlb2YgRG91YmxlICYm\nIHZhbCBpbnN0YW5jZW9mIENoYXJhY3RlcikgewogICAgICAgICAgICBpZiAo\nZG9TZXQpCiAgICAgICAgICAgICAgICB0ZXN0LnNldERvdWJsZUNoYXJNYXAo\nbWFwKTsKICAgICAgICAgICAgcmV0dXJuIHRlc3QuZ2V0RG91YmxlQ2hhck1h\ncCgpOwogICAgICAgIH0gZWxzZSBpZiAoa2V5IGluc3RhbmNlb2YgQnl0ZSAm\nJiB2YWwgaW5zdGFuY2VvZiBEb3VibGUpIHsKICAgICAgICAgICAgaWYgKGRv\nU2V0KQogICAgICAgICAgICAgICAgdGVzdC5zZXRCeXRlRG91YmxlTWFwKG1h\ncCk7CiAgICAgICAgICAgIHJldHVybiB0ZXN0LmdldEJ5dGVEb3VibGVNYXAo\nKTsKICAgICAgICB9IGVsc2UgaWYgKGtleSBpbnN0YW5jZW9mIEZsb2F0ICYm\nIHZhbCBpbnN0YW5jZW9mIEJ5dGUpIHsKICAgICAgICAgICAgaWYgKGRvU2V0\nKQogICAgICAgICAgICAgICAgdGVzdC5zZXRGbG9hdEJ5dGVNYXAobWFwKTsK\nICAgICAgICAgICAgcmV0dXJuIHRlc3QuZ2V0RmxvYXRCeXRlTWFwKCk7CiAg\nICAgICAgfSBlbHNlIGlmIChrZXkgaW5zdGFuY2VvZiBMb25nICYmIHZhbCBp\nbnN0YW5jZW9mIEZsb2F0KSB7CiAgICAgICAgICAgIGlmIChkb1NldCkKICAg\nICAgICAgICAgICAgIHRlc3Quc2V0TG9uZ0Zsb2F0TWFwKG1hcCk7CiAgICAg\nICAgICAgIHJldHVybiB0ZXN0LmdldExvbmdGbG9hdE1hcCgpOwogICAgICAg\nIH0gZWxzZSBpZiAoa2V5IGluc3RhbmNlb2YgSW50ZWdlciAmJiB2YWwgaW5z\ndGFuY2VvZiBMb25nKSB7CiAgICAgICAgICAgIGlmIChkb1NldCkKICAgICAg\nICAgICAgICAgIHRlc3Quc2V0SW50TG9uZ01hcChtYXApOwogICAgICAgICAg\nICByZXR1cm4gdGVzdC5nZXRJbnRMb25nTWFwKCk7CiAgICAgICAgfSBlbHNl\nIGlmIChrZXkgaW5zdGFuY2VvZiBTdHJpbmcgJiYgdmFsIGluc3RhbmNlb2Yg\nSW50ZWdlcikgewogICAgICAgICAgICBpZiAoZG9TZXQpCiAgICAgICAgICAg\nICAgICB0ZXN0LnNldFN0ckludE1hcChtYXApOwogICAgICAgICAgICByZXR1\ncm4gdGVzdC5nZXRTdHJJbnRNYXAoKTsKICAgICAgICB9IGVsc2UgaWYgKGtl\neSBpbnN0YW5jZW9mIEJpZ0RlY2ltYWwgJiYgdmFsIGluc3RhbmNlb2YgQmln\nSW50ZWdlcikgewogICAgICAgICAgICBpZiAoZG9TZXQpCiAgICAgICAgICAg\nICAgICB0ZXN0LnNldEJpZ0RlY2ltYWxCaWdJbnRlZ2VyTWFwKG1hcCk7CiAg\nICAgICAgICAgIHJldHVybiB0ZXN0LmdldEJpZ0RlY2ltYWxCaWdJbnRlZ2Vy\nTWFwKCk7CiAgICAgICAgfQoKICAgICAgICBmYWlsKCJVbmtub3duIG1hcCB0\neXBlIik7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBHZW5lcmljIHNldHRlci9nZXR0ZXIgZm9yIHNldHRpbmcgdGhlIGNv\nbGxlY3Rpb25zIHB1cnBvc2VzLgogICAgICovCiAgICBwcml2YXRlIENvbGxl\nY3Rpb24gc2V0R2V0Q29sbGVjdGlvbihTQ09UZXN0IHRlc3QsCiAgICAgICAg\nQ29sbGVjdGlvbiBjb2xsZWN0aW9uLCBib29sZWFuIGRvU2V0KSB7CiAgICAg\nICAgaWYgKGNvbGxlY3Rpb24gPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJu\nIG51bGw7CgogICAgICAgIE9iamVjdCBmaXJzdCA9IGNvbGxlY3Rpb24uaXRl\ncmF0b3IoKS5uZXh0KCk7CgogICAgICAgIGlmIChmaXJzdCBpbnN0YW5jZW9m\nIEJpZ0ludGVnZXIpIHsKICAgICAgICAgICAgaWYgKGRvU2V0KQogICAgICAg\nICAgICAgICAgdGVzdC5zZXRDQmlnSW50ZWdlcihjb2xsZWN0aW9uKTsKICAg\nICAgICAgICAgcmV0dXJuIHRlc3QuZ2V0Q0JpZ0ludGVnZXIoKTsKICAgICAg\nICB9IGVsc2UgaWYgKGZpcnN0IGluc3RhbmNlb2YgQmlnRGVjaW1hbCkgewog\nICAgICAgICAgICBpZiAoZG9TZXQpCiAgICAgICAgICAgICAgICB0ZXN0LnNl\ndENCaWdEZWNpbWFsKGNvbGxlY3Rpb24pOwogICAgICAgICAgICByZXR1cm4g\ndGVzdC5nZXRDQmlnRGVjaW1hbCgpOwogICAgICAgIH0gZWxzZSBpZiAoZmly\nc3QgaW5zdGFuY2VvZiBEYXRlKSB7CiAgICAgICAgICAgIGlmIChkb1NldCkK\nICAgICAgICAgICAgICAgIHRlc3Quc2V0Q0RhdGUoY29sbGVjdGlvbik7CiAg\nICAgICAgICAgIHJldHVybiB0ZXN0LmdldENEYXRlKCk7CiAgICAgICAgfSBl\nbHNlIGlmIChmaXJzdCBpbnN0YW5jZW9mIENoYXJhY3RlcikgewogICAgICAg\nICAgICBpZiAoZG9TZXQpCiAgICAgICAgICAgICAgICB0ZXN0LnNldENDaGFy\nYWN0ZXIoY29sbGVjdGlvbik7CiAgICAgICAgICAgIHJldHVybiB0ZXN0Lmdl\ndENDaGFyYWN0ZXIoKTsKICAgICAgICB9IGVsc2UgaWYgKGZpcnN0IGluc3Rh\nbmNlb2YgRG91YmxlKSB7CiAgICAgICAgICAgIGlmIChkb1NldCkKICAgICAg\nICAgICAgICAgIHRlc3Quc2V0Q0RvdWJsZShjb2xsZWN0aW9uKTsKICAgICAg\nICAgICAgcmV0dXJuIHRlc3QuZ2V0Q0RvdWJsZSgpOwogICAgICAgIH0gZWxz\nZSBpZiAoZmlyc3QgaW5zdGFuY2VvZiBCeXRlKSB7CiAgICAgICAgICAgIGlm\nIChkb1NldCkKICAgICAgICAgICAgICAgIHRlc3Quc2V0Q0J5dGUoY29sbGVj\ndGlvbik7CiAgICAgICAgICAgIHJldHVybiB0ZXN0LmdldENCeXRlKCk7CiAg\nICAgICAgfSBlbHNlIGlmIChmaXJzdCBpbnN0YW5jZW9mIEZsb2F0KSB7CiAg\nICAgICAgICAgIGlmIChkb1NldCkKICAgICAgICAgICAgICAgIHRlc3Quc2V0\nQ0Zsb2F0KGNvbGxlY3Rpb24pOwogICAgICAgICAgICByZXR1cm4gdGVzdC5n\nZXRDRmxvYXQoKTsKICAgICAgICB9IGVsc2UgaWYgKGZpcnN0IGluc3RhbmNl\nb2YgTG9uZykgewogICAgICAgICAgICBpZiAoZG9TZXQpCiAgICAgICAgICAg\nICAgICB0ZXN0LnNldENMb25nKGNvbGxlY3Rpb24pOwogICAgICAgICAgICBy\nZXR1cm4gdGVzdC5nZXRDTG9uZygpOwogICAgICAgIH0gZWxzZSBpZiAoZmly\nc3QgaW5zdGFuY2VvZiBJbnRlZ2VyKSB7CiAgICAgICAgICAgIGlmIChkb1Nl\ndCkKICAgICAgICAgICAgICAgIHRlc3Quc2V0Q0ludGVnZXIoY29sbGVjdGlv\nbik7CiAgICAgICAgICAgIHJldHVybiB0ZXN0LmdldENJbnRlZ2VyKCk7CiAg\nICAgICAgfSBlbHNlIGlmIChmaXJzdCBpbnN0YW5jZW9mIFN0cmluZykgewog\nICAgICAgICAgICBpZiAoZG9TZXQpCiAgICAgICAgICAgICAgICB0ZXN0LnNl\ndENTdHJpbmcoY29sbGVjdGlvbik7CiAgICAgICAgICAgIHJldHVybiB0ZXN0\nLmdldENTdHJpbmcoKTsKICAgICAgICB9IGVsc2UgaWYgKGZpcnN0IGluc3Rh\nbmNlb2YgU2hvcnQpIHsKICAgICAgICAgICAgaWYgKGRvU2V0KQogICAgICAg\nICAgICAgICAgdGVzdC5zZXRDU2hvcnQoY29sbGVjdGlvbik7CiAgICAgICAg\nICAgIHJldHVybiB0ZXN0LmdldENTaG9ydCgpOwogICAgICAgIH0gZWxzZSBp\nZiAoZmlyc3QgaW5zdGFuY2VvZiBCb29sZWFuKSB7CiAgICAgICAgICAgIGlm\nIChkb1NldCkKICAgICAgICAgICAgICAgIHRlc3Quc2V0Q0Jvb2xlYW4oY29s\nbGVjdGlvbik7CiAgICAgICAgICAgIHJldHVybiB0ZXN0LmdldENCb29sZWFu\nKCk7CiAgICAgICAgfQoKICAgICAgICBmYWlsKCJVbmtub3duIGNvbGxlY3Rp\nb24gdHlwZSIpOwogICAgICAgIHJldHVybiBudWxsOwogICAgfQoKICAgIC8q\nKgogICAgICogQSBzaW1wbGUgc29ydGVyIHRoYXQgc2hvdWxkIGFsd2F5cyBy\nZXR1cm4gdGhlIHNhbWUgc29ydCBvcmRlci4KICAgICAqIFRoZSBvbmx5IHJl\nYXNvbiB3ZSBuZWVkIHRpIHVzZSB0aGlzLCBpbnN0ZWFkIG9mIHJlbHlpbmcg\nb24gdGhlCiAgICAgKiBuYXR1cmFsIG9yZGVyIGluIENvbGxlY3Rpb25zLnNv\ncnQgaXMgdGhhdCB0aGVyZSBzZWVtcyB0byBiZQogICAgICogYSBidWcgc29t\nZXdoZXJlIHRoYXQgcHJldmVudHMgc29ydGluZyBvbiBjb2xsZWN0aW9ucyBv\nZiBCb29sZWFuCiAgICAgKiBvYmplY3RzLgogICAgICovCiAgICBwdWJsaWMg\nc3RhdGljIGNsYXNzIENvbGxlY3Rpb25Tb3J0ZXIKICAgICAgICBpbXBsZW1l\nbnRzIENvbXBhcmF0b3IgewoKICAgICAgICBwcml2YXRlIENvbGxhdG9yIGNv\nbGxhdG9yID0gQ29sbGF0b3IuZ2V0SW5zdGFuY2UoKTsKCiAgICAgICAgcHVi\nbGljIENvbGxlY3Rpb25Tb3J0ZXIoKSB7CgogICAgICAgIH0KCiAgICAgICAg\ncHVibGljIGludCBjb21wYXJlKE9iamVjdCBvMSwgT2JqZWN0IG8yKSB7CiAg\nICAgICAgICAgIGlmIChvMSAhPSBudWxsICYmICEobzEgaW5zdGFuY2VvZiBC\nb29sZWFuKSkKICAgICAgICAgICAgICAgIHJldHVybiBjb2xsYXRvci5jb21w\nYXJlKG8xLCBvMik7CgogICAgICAgICAgICByZXR1cm4gY29sbGF0b3IuY29t\ncGFyZShvMS50b1N0cmluZygpLCBvMi50b1N0cmluZygpKTsKICAgICAgICB9\nCiAgICB9Cn0K\n","encoding":"base64"}

