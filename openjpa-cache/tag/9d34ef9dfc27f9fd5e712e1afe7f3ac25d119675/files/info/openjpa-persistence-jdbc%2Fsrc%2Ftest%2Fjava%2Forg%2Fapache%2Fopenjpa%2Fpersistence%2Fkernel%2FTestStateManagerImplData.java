{"sha":"68cc3650803047d81893407759ceff27fddadc3c","node_id":"MDQ6QmxvYjIwNjM2NDo2OGNjMzY1MDgwMzA0N2Q4MTg5MzQwNzc1OWNlZmYyN2ZkZGFkYzNj","size":6281,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/68cc3650803047d81893407759ceff27fddadc3c","content":"LyoKICogVGVzdFN0YXRlTWFuYWdlckltcGxEYXRhLmphdmEKICoKICogQ3Jl\nYXRlZCBvbiBPY3RvYmVyIDEzLCAyMDA2LCA1OjQwIFBNCiAqCiAqIFRvIGNo\nYW5nZSB0aGlzIHRlbXBsYXRlLCBjaG9vc2UgVG9vbHMgfCBUZW1wbGF0ZSBN\nYW5hZ2VyCiAqIGFuZCBvcGVuIHRoZSB0ZW1wbGF0ZSBpbiB0aGUgZWRpdG9y\nLgogKi8KLyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBG\nb3VuZGF0aW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1\ndG9yIGxpY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUK\nICogZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwg\naW5mb3JtYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAu\nICBUaGUgQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIg\ndGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNl\nbnNlIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNv\nbXBsaWFuY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWlu\nIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFw\nYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJl\ncXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0\naW5nLAogKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5z\nZSBpcyBkaXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRI\nT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwg\nZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBm\nb3IgdGhlCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNz\naW9ucyBhbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAg\nIAogKi8KcGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2Uu\na2VybmVsOwoKCgppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNpc3Rl\nbmNlLmtlcm5lbC5jb21tb24uYXBwcy5Nb2RSdW50aW1lVGVzdDE7CgppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5PcGVuSlBBU3RhdGVNYW5h\nZ2VyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuQ2xhc3NNZXRh\nRGF0YTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5P\ncGVuSlBBRW50aXR5TWFuYWdlcjsKCnB1YmxpYyBjbGFzcyBUZXN0U3RhdGVN\nYW5hZ2VySW1wbERhdGEgZXh0ZW5kcyBCYXNlS2VybmVsVGVzdCB7CgogICAg\nQ2xhc3NNZXRhRGF0YSBfbWV0YTsKCiAgICBCb29sZWFuIF9mMTsKCiAgICBC\nb29sZWFuIF9mMzsKCiAgICAvKioKICAgICAqIENyZWF0ZXMgYSBuZXcgaW5z\ndGFuY2Ugb2YgVGVzdFN0YXRlTWFuYWdlckltcGxEYXRhCiAgICAgKi8KICAg\nIHB1YmxpYyBUZXN0U3RhdGVNYW5hZ2VySW1wbERhdGEoKSB7CiAgICB9Cgog\nICAgcHVibGljIFRlc3RTdGF0ZU1hbmFnZXJJbXBsRGF0YShTdHJpbmcgdGVz\ndCkgewogICAgICAgIHN1cGVyKHRlc3QpOwogICAgfQoKICAgIHB1YmxpYyB2\nb2lkIHNldFVwTWV0YURhdGEoQ2xhc3NNZXRhRGF0YSBtZXRhKSB7CiAgICAg\nICAgX21ldGEgPSBtZXRhOwogICAgICAgIF9mMSA9IF9tZXRhLmdldEZpZWxk\nKDEpLnVzZXNJbXBsRGF0YSgpOwogICAgICAgIF9mMyA9IF9tZXRhLmdldEZp\nZWxkKDMpLnVzZXNJbXBsRGF0YSgpOwogICAgICAgIF9tZXRhLmdldEZpZWxk\nKDEpLnNldFVzZXNJbXBsRGF0YShCb29sZWFuLlRSVUUpOwogICAgICAgIF9t\nZXRhLmdldEZpZWxkKDMpLnNldFVzZXNJbXBsRGF0YShudWxsKTsKICAgIH0K\nCiAgICBwdWJsaWMgdm9pZCB0ZWFyRG93bk1ldGFEYXRhKCkgewogICAgICAg\nIF9tZXRhLmdldEZpZWxkKDEpLnNldFVzZXNJbXBsRGF0YShfZjEpOwogICAg\nICAgIF9tZXRhLmdldEZpZWxkKDMpLnNldFVzZXNJbXBsRGF0YShfZjMpOwog\nICAgfQoKICAgIHB1YmxpYyB2b2lkIHRlc3RJbXBsRGF0YSgpIHsKICAgICAg\nICBNb2RSdW50aW1lVGVzdDEgcGMgPSBuZXcgTW9kUnVudGltZVRlc3QxKCk7\nCgogICAgICAgIE9wZW5KUEFFbnRpdHlNYW5hZ2VyIHBtID0gZ2V0UE0oZmFs\nc2UsIGZhbHNlKTsKICAgICAgICBzdGFydFR4KHBtKTsKICAgICAgICBwbS5w\nZXJzaXN0KHBjKTsKICAgICAgICBPcGVuSlBBU3RhdGVNYW5hZ2VyIHNtID0g\nZ2V0U3RhdGVNYW5hZ2VyKHBjLCBwbSk7CiAgICAgICAgc2V0VXBNZXRhRGF0\nYShzbS5nZXRNZXRhRGF0YSgpKTsKICAgICAgICB0cnkgewogICAgICAgICAg\nICAvLyB0ZXN0IGluc3RhbmNlIGxldmVsCiAgICAgICAgICAgIE9iamVjdCBp\nbnN0ID0gbmV3IE9iamVjdCgpOwogICAgICAgICAgICBhc3NlcnROdWxsKHNt\nLmdldEltcGxEYXRhKCkpOwogICAgICAgICAgICBhc3NlcnROdWxsKHNtLnNl\ndEltcGxEYXRhKGluc3QsIHRydWUpKTsKICAgICAgICAgICAgYXNzZXJ0RXF1\nYWxzKGluc3QsIHNtLmdldEltcGxEYXRhKCkpOwogICAgICAgICAgICBhc3Nl\ncnRUcnVlKHNtLmlzSW1wbERhdGFDYWNoZWFibGUoKSk7CiAgICAgICAgICAg\nIGFzc2VydEVxdWFscyhpbnN0LCBzbS5zZXRJbXBsRGF0YShudWxsLCBmYWxz\nZSkpOwogICAgICAgICAgICBhc3NlcnROdWxsKHNtLmdldEltcGxEYXRhKCkp\nOwogICAgICAgICAgICBhc3NlcnRGYWxzZShzbS5pc0ltcGxEYXRhQ2FjaGVh\nYmxlKCkpOwogICAgICAgICAgICBzbS5zZXRJbXBsRGF0YShpbnN0LCBmYWxz\nZSk7CiAgICAgICAgICAgIGFzc2VydEZhbHNlKHNtLmlzSW1wbERhdGFDYWNo\nZWFibGUoKSk7CgogICAgICAgICAgICAvLyB0ZXN0IGZpZWxkIGxldmVsCiAg\nICAgICAgICAgIE9iamVjdCBmMSA9IG5ldyBPYmplY3QoKTsKICAgICAgICAg\nICAgT2JqZWN0IGYzID0gbmV3IE9iamVjdCgpOwoKICAgICAgICAgICAgYXNz\nZXJ0TnVsbChzbS5nZXRJbXBsRGF0YSgxKSk7CiAgICAgICAgICAgIGFzc2Vy\ndEZhbHNlKHNtLmlzSW1wbERhdGFDYWNoZWFibGUoMSkpOwogICAgICAgICAg\nICBhc3NlcnROdWxsKHNtLnNldEltcGxEYXRhKDEsIGYxKSk7CiAgICAgICAg\nICAgIGFzc2VydEVxdWFscyhmMSwgc20uZ2V0SW1wbERhdGEoMSkpOwogICAg\nICAgICAgICBhc3NlcnRUcnVlKCFzbS5pc0ltcGxEYXRhQ2FjaGVhYmxlKDEp\nKTsKICAgICAgICAgICAgYXNzZXJ0RXF1YWxzKGYxLCBzbS5zZXRJbXBsRGF0\nYSgxLCBudWxsKSk7CiAgICAgICAgICAgIGFzc2VydE51bGwoc20uZ2V0SW1w\nbERhdGEoMSkpOwogICAgICAgICAgICBhc3NlcnRGYWxzZShzbS5pc0ltcGxE\nYXRhQ2FjaGVhYmxlKDEpKTsKICAgICAgICAgICAgc20uc2V0SW1wbERhdGEo\nMSwgZjEpOwoKICAgICAgICAgICAgYXNzZXJ0TnVsbChzbS5zZXRJbXBsRGF0\nYSgzLCBmMykpOwogICAgICAgICAgICBhc3NlcnRFcXVhbHMoZjMsIHNtLmdl\ndEltcGxEYXRhKDMpKTsKICAgICAgICAgICAgYXNzZXJ0VHJ1ZShzbS5pc0lt\ncGxEYXRhQ2FjaGVhYmxlKDMpKTsKICAgICAgICAgICAgYXNzZXJ0RXF1YWxz\nKGYxLCBzbS5nZXRJbXBsRGF0YSgxKSk7CgogICAgICAgICAgICAvLyB0aGlz\nIHNob3VsZCBjbGVhciBmaWVsZCBkYXRhCiAgICAgICAgICAgIGVuZFR4KHBt\nKTsKCiAgICAgICAgICAgIGFzc2VydEVxdWFscyhpbnN0LCBzbS5nZXRJbXBs\nRGF0YSgpKTsKICAgICAgICAgICAgYXNzZXJ0TnVsbChzbS5nZXRJbXBsRGF0\nYSgxKSk7CiAgICAgICAgICAgIGFzc2VydE51bGwoc20uZ2V0SW1wbERhdGEo\nMykpOwoKICAgICAgICAgICAgZW5kRW0ocG0pOwogICAgICAgIH0gZmluYWxs\neSB7CiAgICAgICAgICAgIHRlYXJEb3duTWV0YURhdGEoKTsKICAgICAgICB9\nCiAgICB9CgogICAgcHVibGljIHZvaWQgdGVzdE5vdENsZWFyZWRJZlJldGFp\nblZhbHVlcygpIHsKICAgICAgICBkZWxldGVBbGwoTW9kUnVudGltZVRlc3Qx\nLmNsYXNzKTsKICAgICAgICBub3RDbGVhcmVkSWZSZXRhaW5WYWx1ZXNUZXN0\nKHRydWUpOwogICAgICAgIG5vdENsZWFyZWRJZlJldGFpblZhbHVlc1Rlc3Qo\nZmFsc2UpOwogICAgfQoKICAgIHByaXZhdGUgdm9pZCBub3RDbGVhcmVkSWZS\nZXRhaW5WYWx1ZXNUZXN0KGJvb2xlYW4gb3B0aW1pc3RpYykgewogICAgICAg\nIE1vZFJ1bnRpbWVUZXN0MSBwYyA9IG5ldyBNb2RSdW50aW1lVGVzdDEoInBj\nIiwgMSk7CiAgICAgICAgaW50IGtleSA9IDE7CiAgICAgICAgT2JqZWN0IHZh\nbHVlID0gbmV3IE9iamVjdCgpOwoKICAgICAgICAvLyBtYWtlIGluc3RhbmNl\nIHBlcnNpc3RlbnQKICAgICAgICBPcGVuSlBBRW50aXR5TWFuYWdlciBwbSA9\nIGdldFBNKG9wdGltaXN0aWMsIHRydWUpOwogICAgICAgIHN0YXJ0VHgocG0p\nOwogICAgICAgIHBtLnBlcnNpc3QocGMpOwogICAgICAgIE9iamVjdCBvaWQg\nPSBwbS5nZXRPYmplY3RJZChwYyk7CgogICAgICAgIE9wZW5KUEFTdGF0ZU1h\nbmFnZXIgc20gPSBnZXRTdGF0ZU1hbmFnZXIocGMsIHBtKTsKICAgICAgICBh\nc3NlcnROb3ROdWxsKHNtKTsKICAgICAgICBzZXRVcE1ldGFEYXRhKHNtLmdl\ndE1ldGFEYXRhKCkpOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIC8vIHNl\ndCBpbXBsIGRhdGEKICAgICAgICAgICAgc20uc2V0SW1wbERhdGEoa2V5LCB2\nYWx1ZSk7CiAgICAgICAgICAgIGFzc2VydEVxdWFscyh2YWx1ZSwgc20uZ2V0\nSW1wbERhdGEoa2V5KSk7CiAgICAgICAgICAgIGVuZFR4KHBtKTsKCiAgICAg\nICAgICAgIC8vIHRlc3QgaW4gbm9udHJhbnNhY3Rpb25hbCBzZXR0aW5nCiAg\nICAgICAgICAgIGFzc2VydEVxdWFscyh2YWx1ZSwgc20uZ2V0SW1wbERhdGEo\na2V5KSk7CgogICAgICAgICAgICAvLyB0ZXN0IGluIG5leHQgdHJhbnNhY3Rp\nb24KICAgICAgICAgICAgc3RhcnRUeChwbSk7CiAgICAgICAgICAgIHBjID0g\nKE1vZFJ1bnRpbWVUZXN0MSkgcG0uZmluZChNb2RSdW50aW1lVGVzdDEuY2xh\nc3MsIG9pZCk7CiAgICAgICAgICAgIHNtID0gZ2V0U3RhdGVNYW5hZ2VyKHBj\nLCBwbSk7CiAgICAgICAgICAgIGFzc2VydE5vdE51bGwoc20pOwogICAgICAg\nICAgICBpZiAocG0uZ2V0T3B0aW1pc3RpYygpKQogICAgICAgICAgICAgICAg\nYXNzZXJ0RXF1YWxzKHZhbHVlLCBzbS5nZXRJbXBsRGF0YShrZXkpKTsKICAg\nICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgYXNzZXJ0TnVsbChzbS5n\nZXRJbXBsRGF0YShrZXkpKTsKICAgICAgICAgICAgZW5kVHgocG0pOwogICAg\nICAgICAgICBlbmRFbShwbSk7CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAg\nICAgICAgdGVhckRvd25NZXRhRGF0YSgpOwogICAgICAgIH0KCiAgICAgICAg\nLy8gdGVzdCBpbiBhbm90aGVyIHBtIGZvciBnb29kIG1lYXN1cmUKICAgICAg\nICBwbSA9IGdldFBNKG9wdGltaXN0aWMsIHRydWUpOwogICAgICAgIHBjID0g\nKE1vZFJ1bnRpbWVUZXN0MSkgcG0uZmluZChNb2RSdW50aW1lVGVzdDEuY2xh\nc3MsIG9pZCk7CiAgICAgICAgc20gPSBnZXRTdGF0ZU1hbmFnZXIocGMsIHBt\nKTsKICAgICAgICBhc3NlcnROb3ROdWxsKHNtKTsKICAgICAgICBzZXRVcE1l\ndGFEYXRhKHNtLmdldE1ldGFEYXRhKCkpOwogICAgICAgIHRyeSB7CiAgICAg\nICAgICAgIHNtLnNldEltcGxEYXRhKGtleSwgdmFsdWUpOwogICAgICAgICAg\nICBhc3NlcnRFcXVhbHModmFsdWUsIHNtLmdldEltcGxEYXRhKGtleSkpOwoK\nICAgICAgICAgICAgLy8gdGVzdCBpbiB0cmFuc2FjdGlvbjsgcmUtbG9va3Vw\nIHBjIHRvIGJlIHN1cmUgaXQgZW50ZXJzIHRoZSB0cmFucwogICAgICAgICAg\nICBzdGFydFR4KHBtKTsKICAgICAgICAgICAgcGMgPSAoTW9kUnVudGltZVRl\nc3QxKSBwbS5maW5kKE1vZFJ1bnRpbWVUZXN0MS5jbGFzcywgb2lkKTsKICAg\nICAgICAgICAgaWYgKHBtLmdldE9wdGltaXN0aWMoKSkKICAgICAgICAgICAg\nICAgIGFzc2VydEVxdWFscyh2YWx1ZSwgc20uZ2V0SW1wbERhdGEoa2V5KSk7\nCiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgYXNzZXJ0TnVs\nbChzbS5nZXRJbXBsRGF0YShrZXkpKTsKICAgICAgICAgICAgICAgIHNtLnNl\ndEltcGxEYXRhKGtleSwgdmFsdWUpOwogICAgICAgICAgICB9CiAgICAgICAg\nICAgIGVuZFR4KHBtKTsKCiAgICAgICAgICAgIC8vIHRlc3Qgb3V0c2lkZSBv\nZiB0cmFuc2FjdGlvbgogICAgICAgICAgICBhc3NlcnRFcXVhbHModmFsdWUs\nIHNtLmdldEltcGxEYXRhKGtleSkpOwogICAgICAgICAgICBlbmRFbShwbSk7\nCiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgdGVhckRvd25NZXRh\nRGF0YSgpOwogICAgICAgIH0KICAgIH0KfQo=\n","encoding":"base64"}

