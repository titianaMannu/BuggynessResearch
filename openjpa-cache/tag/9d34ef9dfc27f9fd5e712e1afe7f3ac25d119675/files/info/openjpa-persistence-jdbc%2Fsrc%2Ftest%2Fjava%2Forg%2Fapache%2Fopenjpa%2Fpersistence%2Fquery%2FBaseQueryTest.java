{"sha":"e4fc151d753dcf1e3dca8d24684790cd03e2f845","node_id":"MDQ6QmxvYjIwNjM2NDplNGZjMTUxZDc1M2RjZjFlM2RjYThkMjQ2ODQ3OTBjZDAzZTJmODQ1","size":4980,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/e4fc151d753dcf1e3dca8d24684790cd03e2f845","content":"LyoKICogQmFzZUtlcm5lbFRlc3QuamF2YQogKgogKiBDcmVhdGVkIG9uIE9j\ndG9iZXIgOSwgMjAwNiwgMTI6NTYgUE0KICoKICogVG8gY2hhbmdlIHRoaXMg\ndGVtcGxhdGUsIGNob29zZSBUb29scyB8IFRlbXBsYXRlIE1hbmFnZXIKICog\nYW5kIG9wZW4gdGhlIHRlbXBsYXRlIGluIHRoZSBlZGl0b3IuCiAqLwoKLyoK\nICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0aW9u\nIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxpY2Vu\nc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlzdHJp\nYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3JtYXRp\nb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUgQVNG\nIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFwYWNo\nZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7IHlv\ndSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2UK\nICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29weSBv\nZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5vcmcv\nbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVkIGJ5\nIGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAogKiBz\nb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0\ncmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdBUlJB\nTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVyIGV4\ncHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlCiAq\nIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQg\nbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8KcGFj\na2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UucXVlcnk7Cgpp\nbXBvcnQgamF2YS51dGlsLkhhc2hNYXA7CmltcG9ydCBqYXZhLnV0aWwuTGlz\ndDsKaW1wb3J0IGphdmEudXRpbC5NYXA7CmltcG9ydCBqYXZhLnV0aWwuUHJv\ncGVydGllczsKaW1wb3J0IGphdmF4LnBlcnNpc3RlbmNlLkVudGl0eU1hbmFn\nZXI7CgoKCgppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5Ccm9r\nZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLk9wZW5KUEFT\ndGF0ZU1hbmFnZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVs\nLmpwcWwuSlBRTFBhcnNlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5s\naWIuY29uZi5Db25maWd1cmF0aW9uUHJvdmlkZXI7CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEubGliLmNvbmYuQ29uZmlndXJhdGlvbnM7CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuSlBBRmFjYWRlSGVscGVy\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNlLk9wZW5K\nUEFFbnRpdHlNYW5hZ2VyOwoKcHVibGljIGFic3RyYWN0IGNsYXNzIEJhc2VR\ndWVyeVRlc3QgZXh0ZW5kcyBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVu\nY2UuY29tbW9uLnV0aWxzLkFic3RyYWN0VGVzdENhc2UgewoKICAgIHByaXZh\ndGUgc3RhdGljIE1hcCBfc3lzcHJvcHMgPSBuZXcgSGFzaE1hcCgpOwoKICAg\nIC8qKgogICAgICogQ3JlYXRlcyBhIG5ldyBpbnN0YW5jZSBvZiBCYXNlUXVl\ncnlUZXN0CiAgICAgKi8KICAgIHB1YmxpYyBCYXNlUXVlcnlUZXN0KFN0cmlu\nZyBuYW1lKSB7CiAgICAgICAgc3VwZXIobmFtZSwgInF1ZXJ5Y2FjdHVzYXBw\nIik7CiAgICB9CgogICAgcHJvdGVjdGVkIE9wZW5KUEFFbnRpdHlNYW5hZ2Vy\nIGdldEVNKCkgewogICAgICAgIHJldHVybiAoT3BlbkpQQUVudGl0eU1hbmFn\nZXIpIGN1cnJlbnRFbnRpdHlNYW5hZ2VyKCk7CiAgICB9CgogICAgcHJvdGVj\ndGVkIE9wZW5KUEFFbnRpdHlNYW5hZ2VyIGdldEVNKGJvb2xlYW4gb3B0aW1p\nc3RpYywKICAgICAgICBib29sZWFuIHJldGFpblZhbHVlcykgewogICAgICAg\nIE9wZW5KUEFFbnRpdHlNYW5hZ2VyIGVtID0KICAgICAgICAgICAgKE9wZW5K\nUEFFbnRpdHlNYW5hZ2VyKSBjdXJyZW50RW50aXR5TWFuYWdlcigpOwogICAg\nICAgIGVtLnNldE5vbnRyYW5zYWN0aW9uYWxSZWFkKHRydWUpOwogICAgICAg\nIGVtLnNldFJldGFpblN0YXRlKHJldGFpblZhbHVlcyk7CiAgICAgICAgZW0u\nc2V0T3B0aW1pc3RpYyhvcHRpbWlzdGljKTsKICAgICAgICByZXR1cm4gZW07\nCiAgICB9CgogICAgLyoqCiAgICAgKiBEZWxldGUgYWxsIGluc3RhbmNlcyBv\nZiB0aGUgZ2l2ZW4gY2xhc3MuCiAgICAgKi8KICAgIHByb3RlY3RlZCBpbnQg\nZGVsZXRlQWxsKEJyb2tlciBicm9rZXIsIENsYXNzIGNsYXp6LAogICAgICAg\nIGJvb2xlYW4gc3ViY2xhc3NlcykgewogICAgICAgIGZpbmFsIGJvb2xlYW4g\ndXNlRGVsZXRlQnlRdWVyeSA9IGZhbHNlOwoKICAgICAgICBpZiAodXNlRGVs\nZXRlQnlRdWVyeSkgewogICAgICAgICAgICBvcmcuYXBhY2hlLm9wZW5qcGEu\na2VybmVsLlF1ZXJ5IHF1ZXJ5ID0gYnJva2VyLm5ld1F1ZXJ5KAogICAgICAg\nICAgICAgICAgSlBRTFBhcnNlci5MQU5HX0pQUUwsIGNsYXp6LCAiIik7CiAg\nICAgICAgICAgIHF1ZXJ5LnNldENhbmRpZGF0ZVR5cGUoY2xhenosIHN1YmNs\nYXNzZXMpOwogICAgICAgICAgICByZXR1cm4gKGludCkgcXVlcnkuZGVsZXRl\nQWxsKCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgb3JnLmFwYWNo\nZS5vcGVuanBhLmtlcm5lbC5FeHRlbnQgZXh0ZW50ID0KICAgICAgICAgICAg\nICAgIGJyb2tlci5uZXdFeHRlbnQoY2xhenosIHN1YmNsYXNzZXMpOwogICAg\nICAgICAgICBMaXN0IGxpc3QgPSBleHRlbnQubGlzdCgpOwogICAgICAgICAg\nICBpbnQgc2l6ZSA9IGxpc3Quc2l6ZSgpOwogICAgICAgICAgICBicm9rZXIu\nZGVsZXRlQWxsKGxpc3QsIG51bGwpOwogICAgICAgICAgICByZXR1cm4gc2l6\nZTsKICAgICAgICB9CiAgICB9CgogICAgcHJvdGVjdGVkIE9iamVjdCBwZXJz\naXN0KE9iamVjdCBvYikgewogICAgICAgIEJyb2tlciBicm9rZXIgPSBnZXRC\ncm9rZXJGYWN0b3J5KCkubmV3QnJva2VyKCk7CiAgICAgICAgYnJva2VyLmJl\nZ2luKCk7CiAgICAgICAgYnJva2VyLnBlcnNpc3Qob2IsIG51bGwpOwogICAg\nICAgIE9iamVjdCBpZCA9IGJyb2tlci5nZXRPYmplY3RJZChvYik7CiAgICAg\nICAgYnJva2VyLmNvbW1pdCgpOwogICAgICAgIGJyb2tlci5jbG9zZSgpOwog\nICAgICAgIHJldHVybiBpZDsKICAgIH0KCiAgICBwcm90ZWN0ZWQgUHJvcGVy\ndGllcyBnZXRQcm9wZXJ0aWVzKCkgewogICAgICAgIHJldHVybiBnZXRQcm9w\nZXJ0aWVzKG51bGwpOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRo\nZSBydW50aW1lIHByb3BlcnRpZXMsIG9wdGlvbmFsbHkgb3ZlcnJpZGluZyBv\nciBzZXR0aW5nCiAgICAgKiBzb21lIHZpYSB0aGUgZ2l2ZW4gYXJyYXksIHdo\naWNoIHNob3VsZCBiZSBpbiB0aGUgZm9ybQogICAgICogeyBrZXksIHZhbCwg\na2V5LCB2YWwsIC4uLiB9LgogICAgICovCiAgICBwcm90ZWN0ZWQgc3luY2hy\nb25pemVkIFByb3BlcnRpZXMgZ2V0UHJvcGVydGllcyhTdHJpbmdbXSBwcm9w\ncykgewogICAgICAgIFByb3BlcnRpZXMgcCA9IG5ldyBQcm9wZXJ0aWVzKFN5\nc3RlbS5nZXRQcm9wZXJ0aWVzKCkpOwogICAgICAgIFN0cmluZyBzdHIgPSBw\nLmdldFByb3BlcnR5KCJvcGVuanBhLnByb3BlcnRpZXMiLCAia29kby5wcm9w\nZXJ0aWVzIik7CiAgICAgICAgaWYgKHN0ciAhPSBudWxsICYmIHN0ci5sZW5n\ndGgoKSA+IDApIHsKICAgICAgICAgICAgLy8gY2FjaGUgc3lzdGVtIHByb3Bl\ncnRpZXMgdG8gcmVkdWNlIGxvYWQgb24gZmlsZSBzeXN0ZW0KICAgICAgICAg\nICAgUHJvcGVydGllcyBsb2FkZWQgPSAoUHJvcGVydGllcykgX3N5c3Byb3Bz\nLmdldChzdHIpOwogICAgICAgICAgICBpZiAobG9hZGVkID09IG51bGwpIHsK\nICAgICAgICAgICAgICAgIGxvYWRlZCA9IG5ldyBQcm9wZXJ0aWVzKCk7CiAg\nICAgICAgICAgICAgICBDb25maWd1cmF0aW9uUHJvdmlkZXIgY3AgPQogICAg\nICAgICAgICAgICAgICAgIChDb25maWd1cmF0aW9uUHJvdmlkZXIpIENvbmZp\nZ3VyYXRpb25zCiAgICAgICAgICAgICAgICAgICAgICAgIC5nZXRQcm9wZXJ0\neShzdHIsIG51bGwpOwogICAgICAgICAgICAgICAgaWYgKGNwICE9IG51bGwp\nCiAgICAgICAgICAgICAgICAgICAgbG9hZGVkLnB1dEFsbChjcC5nZXRQcm9w\nZXJ0aWVzKCkpOwogICAgICAgICAgICAgICAgX3N5c3Byb3BzLnB1dChzdHIs\nIGxvYWRlZCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcC5wdXRBbGwo\nbG9hZGVkKTsKICAgICAgICB9CgogICAgICAgIGZvciAoaW50IGkgPSAwOyBw\ncm9wcyAhPSBudWxsICYmIGkgPCBwcm9wcy5sZW5ndGg7IGkgKz0gMikgewog\nICAgICAgICAgICBpZiAocHJvcHNbaSArIDFdICE9IG51bGwpIHsKICAgICAg\nICAgICAgICAgIC8vIHJlbW92ZSBhbnkgZHVwbGljYXRlIGtvZG8vb3Blbmpw\nYSBwcm9wZXJ0eSBzbyB3ZSBkb24ndCBjbGFzaAogICAgICAgICAgICAgICAg\naWYgKHByb3BzW2ldLnN0YXJ0c1dpdGgoIm9wZW5qcGEuIikpCiAgICAgICAg\nICAgICAgICAgICAgcC5yZW1vdmUoIm9wZW5qcGEuIiArIHByb3BzW2ldLnN1\nYnN0cmluZyg1KSk7CiAgICAgICAgICAgICAgICBlbHNlIGlmIChwcm9wc1tp\nXS5zdGFydHNXaXRoKCJvcGVuanBhLiIpKQogICAgICAgICAgICAgICAgICAg\nIHAucmVtb3ZlKCJvcGVuanBhLiIgKyBwcm9wc1tpXS5zdWJzdHJpbmcoOCkp\nOwoKICAgICAgICAgICAgICAgIHAuc2V0UHJvcGVydHkocHJvcHNbaV0sIHBy\nb3BzW2kgKyAxXSk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAg\nICAgICBwLnJlbW92ZShwcm9wc1tpXSk7CiAgICAgICAgICAgIH0KICAgICAg\nICB9CiAgICAgICAgcmV0dXJuIHA7CiAgICB9Cn0K\n","encoding":"base64"}

