{"sha":"f99066761ba240356f995df8af297978d095d784","node_id":"MDQ6QmxvYjIwNjM2NDpmOTkwNjY3NjFiYTI0MDM1NmY5OTVkZjhhZjI5Nzk3OGQwOTVkNzg0","size":20852,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/f99066761ba240356f995df8af297978d095d784","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UucXVlcnk7\nCgppbXBvcnQgamF2YS51dGlsLkNvbGxlY3Rpb247CmltcG9ydCBqYXZhLnV0\naWwuSXRlcmF0b3I7CmltcG9ydCBqYXZhLnV0aWwuTGlzdDsKCgppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNlLnF1ZXJ5LmNvbW1vbi5h\ncHBzLlJ1bnRpbWVUZXN0MTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5w\nZXJzaXN0ZW5jZS5xdWVyeS5jb21tb24uYXBwcy5SdW50aW1lVGVzdDI7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UucXVlcnkuY29t\nbW9uLmFwcHMuUnVudGltZVRlc3QzOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLnBlcnNpc3RlbmNlLkV4dGVudDsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5wZXJzaXN0ZW5jZS5PcGVuSlBBRW50aXR5TWFuYWdlcjsKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5PcGVuSlBBUXVlcnk7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuamRiYy5G\nZXRjaE1vZGU7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVu\nY2UuamRiYy5KREJDRmV0Y2hQbGFuOwoKLyoqCiAqIFRlc3QgdGhhdCBSZXN1\nbHRMaXN0IG9iamVjdHMgYmVoYXZlciBjb3JyZWN0bHkuCiAqCiAqIEBhdXRo\nb3IgTWFyYyBQcnVkJ2hvbW1lYXV4CiAqLwpwdWJsaWMgY2xhc3MgVGVzdFF1\nZXJ5UmVzdWx0cyBleHRlbmRzIEJhc2VRdWVyeVRlc3QgewoKICAgIHB1Ymxp\nYyBUZXN0UXVlcnlSZXN1bHRzKFN0cmluZyB0ZXN0KSB7CiAgICAgICAgc3Vw\nZXIodGVzdCk7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0VXAoKSB7CiAg\nICAgICAgZGVsZXRlQWxsKFJ1bnRpbWVUZXN0MS5jbGFzcyk7CgogICAgICAg\nIE9wZW5KUEFFbnRpdHlNYW5hZ2VyIGVtID0KICAgICAgICAgICAgKE9wZW5K\nUEFFbnRpdHlNYW5hZ2VyKSBjdXJyZW50RW50aXR5TWFuYWdlcigpOwogICAg\nICAgIHN0YXJ0VHgoZW0pOwogICAgICAgIGVtLnBlcnNpc3QobmV3IFJ1bnRp\nbWVUZXN0MSgiVGVzdFF1ZXJ5UmVzdWx0czEiLCAxMCkpOwogICAgICAgIGVt\nLnBlcnNpc3QobmV3IFJ1bnRpbWVUZXN0MSgiVGVzdFF1ZXJ5UmVzdWx0czMi\nLCAxMCkpOwogICAgICAgIGVtLnBlcnNpc3QobmV3IFJ1bnRpbWVUZXN0MSgi\nVGVzdFF1ZXJ5UmVzdWx0czUiLCAxMCkpOwogICAgICAgIGVtLnBlcnNpc3Qo\nbmV3IFJ1bnRpbWVUZXN0MygiVGVzdFF1ZXJ5UmVzdWx0czIiLCAxMCkpOwog\nICAgICAgIGVtLnBlcnNpc3QobmV3IFJ1bnRpbWVUZXN0MygiVGVzdFF1ZXJ5\nUmVzdWx0czQiLCAxMCkpOwogICAgICAgIGVtLnBlcnNpc3QobmV3IFJ1bnRp\nbWVUZXN0MygiVGVzdFF1ZXJ5UmVzdWx0czYiLCAxMCkpOwogICAgICAgIGVu\nZFR4KGVtKTsKICAgICAgICBlbmRFbShlbSk7CiAgICB9CgogICAgcHVibGlj\nIHZvaWQgdGVzdFF1ZXJ5SXRlcmF0b3JzUmV0dXJuRmFsc2VGb3JDbG9zZWRR\ndWVyeSgpIHsKICAgICAgICBPcGVuSlBBRW50aXR5TWFuYWdlciBlbSA9CiAg\nICAgICAgICAgIChPcGVuSlBBRW50aXR5TWFuYWdlcikgY3VycmVudEVudGl0\neU1hbmFnZXIoKTsKICAgICAgICBzdGFydFR4KGVtKTsKCiAgICAgICAgT3Bl\nbkpQQVF1ZXJ5IHEgPSBlbS5jcmVhdGVRdWVyeSgiU0VMRUNUIG8gRlJPTSBS\ndW50aW1lVGVzdDEgbyIpOwogICAgICAgIExpc3QgYyA9IHEuZ2V0UmVzdWx0\nTGlzdCgpOwogICAgICAgIEl0ZXJhdG9yIGkgPSBjLml0ZXJhdG9yKCk7CiAg\nICAgICAgaWYgKCEoaS5oYXNOZXh0KCkpKQogICAgICAgICAgICBmYWlsKCJJ\ndGVyYXRvciBzaG91bGQgaGF2ZSBoYWQgbmV4dCgpIik7CiAgICAgICAgcS5j\nbG9zZUFsbCgpOwogICAgICAgIGVuZFR4KGVtKTsKICAgICAgICBlbmRFbShl\nbSk7CgogICAgICAgIGlmIChpLmhhc05leHQoKSkKICAgICAgICAgICAgZmFp\nbCgiSXRlcmF0b3Igb2J0YWluZWQgZnJvbSBRdWVyeSBzaG91bGQgcmV0dXJu\nIGZhbHNlICIKICAgICAgICAgICAgICAgICsgImZvciBoYXNOZXh0KCkgYWZ0\nZXIgUXVlcnkgaGFzIGJlZW4gY2xvc2VkIik7CiAgICB9CgogICAgcHVibGlj\nIHZvaWQgdGVzdFF1ZXJ5SXRlcmF0b3JzVGhyb3dFeGNlcHRpb25Gb3JDbG9z\nZWRRdWVyeSgpIHsKICAgICAgICBPcGVuSlBBRW50aXR5TWFuYWdlciBlbSA9\nCiAgICAgICAgICAgIChPcGVuSlBBRW50aXR5TWFuYWdlcikgY3VycmVudEVu\ndGl0eU1hbmFnZXIoKTsKICAgICAgICBzdGFydFR4KGVtKTsKCiAgICAgICAg\nT3BlbkpQQVF1ZXJ5IHEgPSBlbS5jcmVhdGVRdWVyeSgiU0VMRUNUIG8gRlJP\nTSBSdW50aW1lVGVzdDEgbyIpOwogICAgICAgIExpc3QgYyA9IHEuZ2V0UmVz\ndWx0TGlzdCgpOwogICAgICAgIEl0ZXJhdG9yIGkgPSBjLml0ZXJhdG9yKCk7\nCiAgICAgICAgaWYgKCEoaS5oYXNOZXh0KCkpKQogICAgICAgICAgICBmYWls\nKCJJdGVyYXRvciBzaG91bGQgaGF2ZSBoYWQgbmV4dCgpIik7CiAgICAgICAg\ncS5jbG9zZUFsbCgpOwogICAgICAgIGVuZFR4KGVtKTsKICAgICAgICBlbmRF\nbShlbSk7CgogICAgICAgIHRyeSB7CiAgICAgICAgICAgIGkubmV4dCgpOwog\nICAgICAgICAgICBmYWlsKCJJdGVyYXRvci5uZXh0KCkgc2hvdWxkIGhhdmUg\ndGhyb3duIEV4Y2VwdGlvbiAiCiAgICAgICAgICAgICAgICArICJhZnRlciBx\ndWVyeS5jbG9zZUFsbCgpIHdhcyBjYWxsZWQiKTsKICAgICAgICB9CiAgICAg\nICAgY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgIC8vCiAgICAg\nICAgfQogICAgfQoKICAgIHB1YmxpYyB2b2lkIHRlc3RMYXp5UXVlcnlJdGVy\nYXRvcnNSZXR1cm5GYWxzZUZvckNsb3NlZGVtKCkgewogICAgICAgIE9wZW5K\nUEFFbnRpdHlNYW5hZ2VyIGVtID0KICAgICAgICAgICAgKE9wZW5KUEFFbnRp\ndHlNYW5hZ2VyKSBjdXJyZW50RW50aXR5TWFuYWdlcigpOwogICAgICAgIHN0\nYXJ0VHgoZW0pOwoKICAgICAgICBTdHJpbmcgcXVlcnkgPSAiU0VMRUNUIG8g\nRlJPTSBSdW50aW1lVGVzdDEgbyI7CiAgICAgICAgT3BlbkpQQVF1ZXJ5IHEg\nPSBlbS5jcmVhdGVRdWVyeShxdWVyeSk7CiAgICAgICAgcS5nZXRGZXRjaFBs\nYW4oKS5zZXRGZXRjaEJhdGNoU2l6ZSg1KTsKICAgICAgICBMaXN0IGMgPSBx\nLmdldFJlc3VsdExpc3QoKTsKCiAgICAgICAgSXRlcmF0b3IgaSA9IGMuaXRl\ncmF0b3IoKTsKICAgICAgICBpZiAoIShpLmhhc05leHQoKSkpCiAgICAgICAg\nICAgIGZhaWwoIkl0ZXJhdG9yIHNob3VsZCBoYXZlIGhhZCBuZXh0KCkiKTsK\nICAgICAgICBlbmRUeChlbSk7CiAgICAgICAgZW5kRW0oZW0pOwoKICAgICAg\nICBpZiAoaS5oYXNOZXh0KCkpCiAgICAgICAgICAgIGZhaWwoIkxhenkgcmVz\ndWx0IGl0ZXJhdG9yIG9idGFpbmVkIGZyb20gUXVlcnkgc2hvdWxkIHJldHVy\nbiAiCiAgICAgICAgICAgICAgICArICJmYWxzZSBmb3IgaGFzTmV4dCgpIGFm\ndGVyIGVtIGhhcyBiZWVuIGNsb3NlZCIpOwogICAgfQoKICAgIHB1YmxpYyB2\nb2lkIHRlc3RFYWdlclF1ZXJ5SXRlcmF0b3JzV29ya0ZvckNsb3NlZGVtKCkg\newogICAgICAgIE9wZW5KUEFFbnRpdHlNYW5hZ2VyIGVtID0KICAgICAgICAg\nICAgKE9wZW5KUEFFbnRpdHlNYW5hZ2VyKSBjdXJyZW50RW50aXR5TWFuYWdl\ncigpOwogICAgICAgIHN0YXJ0VHgoZW0pOwoKICAgICAgICBTdHJpbmcgcXVl\ncnkgPSAiU0VMRUNUIG8gRlJPTSBSdW50aW1lVGVzdDEgbyI7CiAgICAgICAg\nT3BlbkpQQVF1ZXJ5IHEgPSBlbS5jcmVhdGVRdWVyeShxdWVyeSk7CiAgICAg\nICAgcS5nZXRGZXRjaFBsYW4oKS5zZXRGZXRjaEJhdGNoU2l6ZSgtMSk7Cgog\nICAgICAgIExpc3QgYyA9IHEuZ2V0UmVzdWx0TGlzdCgpOwoKICAgICAgICBJ\ndGVyYXRvciBpID0gYy5pdGVyYXRvcigpOwogICAgICAgIGlmICghKGkuaGFz\nTmV4dCgpKSkKICAgICAgICAgICAgZmFpbCgiSXRlcmF0b3Igc2hvdWxkIGhh\ndmUgaGFkIG5leHQoKSIpOwogICAgICAgIGVuZFR4KGVtKTsKICAgICAgICBl\nbmRFbShlbSk7CgogICAgICAgIGlmICghaS5oYXNOZXh0KCkpCiAgICAgICAg\nICAgIGZhaWwoIkVhZ2VyIHJlc3VsdCBpdGVyYXRvciBvYnRhaW5lZCBmcm9t\nIFF1ZXJ5IHNob3VsZCByZXR1cm4gIgogICAgICAgICAgICAgICAgKyAidHJ1\nZSBmb3IgaGFzTmV4dCgpIGFmdGVyIGVtIGhhcyBiZWVuIGNsb3NlZCIpOwog\nICAgfQoKICAgIHB1YmxpYyB2b2lkIHRlc3RRdWVyeVJlc3VsdElzTGlzdCgp\nIHsKICAgICAgICBPcGVuSlBBRW50aXR5TWFuYWdlciBlbSA9CiAgICAgICAg\nICAgIChPcGVuSlBBRW50aXR5TWFuYWdlcikgY3VycmVudEVudGl0eU1hbmFn\nZXIoKTsKICAgICAgICBzdGFydFR4KGVtKTsKCiAgICAgICAgU3RyaW5nIHF1\nZXJ5ID0gIlNFTEVDVCBvIEZST00gUnVudGltZVRlc3QxIG8iOwoKICAgICAg\nICBDb2xsZWN0aW9uIGMgPSAoQ29sbGVjdGlvbikgZW0uY3JlYXRlUXVlcnko\ncXVlcnkpLmdldFJlc3VsdExpc3QoKTsKICAgICAgICBpZiAoIShjIGluc3Rh\nbmNlb2YgTGlzdCkpCiAgICAgICAgICAgIGZhaWwoIkNvbGxlY3Rpb24gKCIg\nKyBjLmdldENsYXNzKCkgKyAiKSBzaG91bGQgaGF2ZSAiCiAgICAgICAgICAg\nICAgICArICJiZWVuIGEgTGlzdCBpbnN0YW5jZSIpOwoKICAgICAgICBlbmRU\neChlbSk7CiAgICAgICAgZW5kRW0oZW0pOwogICAgfQoKICAgIHB1YmxpYyB2\nb2lkIHRlc3RRdWVyeVJlc3VsdFNpemVJc0NvcnJlY3QoKSB7CiAgICAgICAg\nT3BlbkpQQUVudGl0eU1hbmFnZXIgZW0gPQogICAgICAgICAgICAoT3BlbkpQ\nQUVudGl0eU1hbmFnZXIpIGN1cnJlbnRFbnRpdHlNYW5hZ2VyKCk7CiAgICAg\nICAgc3RhcnRUeChlbSk7CgogICAgICAgIGVtLnBlcnNpc3QobmV3IFJ1bnRp\nbWVUZXN0MigiVGVzdFF1ZXJ5UmVzdWx0czEiLCAxMCkpOwogICAgICAgIGVu\nZFR4KGVtKTsKICAgICAgICBlbmRFbShlbSk7CgogICAgICAgIGVtID0gKE9w\nZW5KUEFFbnRpdHlNYW5hZ2VyKSBjdXJyZW50RW50aXR5TWFuYWdlcigpOwog\nICAgICAgIHN0YXJ0VHgoZW0pOwoKICAgICAgICBTdHJpbmcgcXVlcnkgPQog\nICAgICAgICAgICAiU0VMRUNUIHIgRlJPTSBSdW50aW1lVGVzdDIgciBXSEVS\nRSByLnN0cmluZ0ZpZWxkID0gXCdUZXN0UXVlcnlSZXN1bHRzMVwnIjsKICAg\nICAgICBMaXN0IGMgPSBlbS5jcmVhdGVRdWVyeShxdWVyeSkuZ2V0UmVzdWx0\nTGlzdCgpOwoKICAgICAgICBhc3NlcnRFcXVhbHMoMSwgYy5zaXplKCkpOwog\nICAgICAgIGVuZFR4KGVtKTsKICAgICAgICBlbmRFbShlbSk7CiAgICB9Cgog\nICAgcHVibGljIHZvaWQgdGVzdEV4dGVudEl0ZXJhdG9yc1JldHVybkZhbHNl\nRm9yQ2xvc2VkRXh0ZW50KCkgewogICAgICAgIE9wZW5KUEFFbnRpdHlNYW5h\nZ2VyIGVtID0KICAgICAgICAgICAgKE9wZW5KUEFFbnRpdHlNYW5hZ2VyKSBj\ndXJyZW50RW50aXR5TWFuYWdlcigpOwogICAgICAgIHN0YXJ0VHgoZW0pOwog\nICAgICAgIEV4dGVudCBleHRlbnQgPSBlbS5jcmVhdGVFeHRlbnQoUnVudGlt\nZVRlc3QxLmNsYXNzLCB0cnVlKTsKCiAgICAgICAgSXRlcmF0b3IgaSA9IGV4\ndGVudC5pdGVyYXRvcigpOwogICAgICAgIGlmICghKGkuaGFzTmV4dCgpKSkK\nICAgICAgICAgICAgZmFpbCgiSXRlcmF0b3Igc2hvdWxkIGhhdmUgaGFkIG5l\neHQoKSIpOwogICAgICAgIGV4dGVudC5jbG9zZUFsbCgpOwoKICAgICAgICBp\nZiAoaS5oYXNOZXh0KCkpCiAgICAgICAgICAgIGZhaWwoIkl0ZXJhdG9yIG9i\ndGFpbmVkIGZyb20gRXh0ZW50IHNob3VsZCByZXR1cm4gZmFsc2UgIgogICAg\nICAgICAgICAgICAgKyAiZm9yIGhhc05leHQoKSBhZnRlciBFeHRlbnQgaGFz\nIGJlZW4gY2xvc2VkIik7CgogICAgICAgIGVuZFR4KGVtKTsKICAgICAgICBl\nbmRFbShlbSk7CiAgICB9CgogICAgcHVibGljIHZvaWQgdGVzdEV4dGVudEl0\nZXJhdG9yc1Rocm93RXhjZXB0aW9uRm9yQ2xvc2VkRXh0ZW50KCkgewogICAg\nICAgIE9wZW5KUEFFbnRpdHlNYW5hZ2VyIGVtID0KICAgICAgICAgICAgKE9w\nZW5KUEFFbnRpdHlNYW5hZ2VyKSBjdXJyZW50RW50aXR5TWFuYWdlcigpOwog\nICAgICAgIHN0YXJ0VHgoZW0pOwoKICAgICAgICBFeHRlbnQgZXh0ZW50ID0g\nZW0uY3JlYXRlRXh0ZW50KFJ1bnRpbWVUZXN0MS5jbGFzcywgdHJ1ZSk7Cgog\nICAgICAgIEl0ZXJhdG9yIGkgPSBleHRlbnQuaXRlcmF0b3IoKTsKICAgICAg\nICBpZiAoIShpLmhhc05leHQoKSkpCiAgICAgICAgICAgIGZhaWwoIkl0ZXJh\ndG9yIHNob3VsZCBoYXZlIGhhZCBuZXh0KCkiKTsKICAgICAgICBleHRlbnQu\nY2xvc2VBbGwoKTsKCiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgaS5uZXh0\nKCk7CiAgICAgICAgICAgIGZhaWwoIkl0ZXJhdG9yLm5leHQoKSBzaG91bGQg\naGF2ZSB0aHJvd24gRXhjZXB0aW9uICIKICAgICAgICAgICAgICAgICsgImFm\ndGVyIEV4dGVudC5jbG9zZUFsbCgpIHdhcyBjYWxsZWQiKTsKICAgICAgICB9\nIGNhdGNoIChFeGNlcHRpb24gZSkgewogICAgICAgICAgICAvLyB0aGlzIGlz\nIGEgKmdvb2QqIHRoaW5nLgogICAgICAgIH0KCiAgICAgICAgZW5kVHgoZW0p\nOwogICAgICAgIGVuZEVtKGVtKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCB0\nZXN0RXh0ZW50SXRlcmF0b3JzUmV0dXJuRmFsc2VGb3JDbG9zZWRlbSgpIHsK\nICAgICAgICBPcGVuSlBBRW50aXR5TWFuYWdlciBlbSA9CiAgICAgICAgICAg\nIChPcGVuSlBBRW50aXR5TWFuYWdlcikgY3VycmVudEVudGl0eU1hbmFnZXIo\nKTsKICAgICAgICBzdGFydFR4KGVtKTsKCiAgICAgICAgRXh0ZW50IGV4dGVu\ndCA9IGVtLmNyZWF0ZUV4dGVudChSdW50aW1lVGVzdDEuY2xhc3MsIHRydWUp\nOwogICAgICAgIEl0ZXJhdG9yIGkgPSBleHRlbnQuaXRlcmF0b3IoKTsKICAg\nICAgICBpZiAoIShpLmhhc05leHQoKSkpCiAgICAgICAgICAgIGZhaWwoIkl0\nZXJhdG9yIHNob3VsZCBoYXZlIGhhZCBuZXh0KCkiKTsKICAgICAgICBlbmRU\neChlbSk7CiAgICAgICAgZW5kRW0oZW0pOwoKICAgICAgICBpZiAoaS5oYXNO\nZXh0KCkpCiAgICAgICAgICAgIGZhaWwoIkl0ZXJhdG9yIG9idGFpbmVkIGZy\nb20gRXh0ZW50IHNob3VsZCByZXR1cm4gZmFsc2UgIgogICAgICAgICAgICAg\nICAgKyAiZm9yIGhhc05leHQoKSBhZnRlciBlbSBoYXMgYmVlbiBjbG9zZWQi\nKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCB0ZXN0VW5pcXVlUmV0dXJuc1Np\nbmdsZVJlc3VsdCgpIHsKICAgICAgICBPcGVuSlBBRW50aXR5TWFuYWdlciBl\nbSA9CiAgICAgICAgICAgIChPcGVuSlBBRW50aXR5TWFuYWdlcikgY3VycmVu\ndEVudGl0eU1hbmFnZXIoKTsKICAgICAgICBzdGFydFR4KGVtKTsKCiAgICAg\nICAgU3RyaW5nIHF1ZXJ5ID0KICAgICAgICAgICAgIlNFTEVDVCBESVNUSU5D\nVCByIEZST00gUnVudGltZVRlc3QxIHIgV0hFUkUgci5zdHJpbmdGaWVsZCA9\nIFwnVGVzdFF1ZXJ5UmVzdWx0czFcJyI7CiAgICAgICAgT2JqZWN0IG9iaiA9\nIGVtLmNyZWF0ZVF1ZXJ5KHF1ZXJ5KS5nZXRTaW5nbGVSZXN1bHQoKTsKCiAg\nICAgICAgYXNzZXJ0VHJ1ZShvYmogaW5zdGFuY2VvZiBSdW50aW1lVGVzdDEp\nOwoKICAgICAgICBxdWVyeSA9CiAgICAgICAgICAgICJTRUxFQ1QgRElTVElO\nQ1QgciBGUk9NIFJ1bnRpbWVUZXN0MSByIFdIRVJFIHIuc3RyaW5nRmllbGQg\nPSBcJ3h4eHhcJyI7CiAgICAgICAgT3BlbkpQQVF1ZXJ5IHEgPSBlbS5jcmVh\ndGVRdWVyeShxdWVyeSk7CiAgICAgICAgTGlzdCBsID0gcS5nZXRSZXN1bHRM\naXN0KCk7CiAgICAgICAgYXNzZXJ0Tm90TnVsbCgKICAgICAgICAgICAgImV4\ncGVjdGluZyBsIHRvIGJlIG51bGwgc2luY2UgdGhlcmUgaXMgbm8gUnVudGlt\nZVRlc3QxIGluc3RhbmNlIHdpdGggc3RyaW5nZmllbGQ9eHh4eCIsCiAgICAg\nICAgICAgIGwpOwoKICAgICAgICBxLmNsb3NlQWxsKCk7CiAgICAgICAgZW5k\nVHgoZW0pOwogICAgICAgIGVuZEVtKGVtKTsKICAgIH0KCiAgICBwdWJsaWMg\ndm9pZCB0ZXN0VW5pcXVlVGhyb3dzRXhjZXB0aW9uSWZNdWx0aXBsZVJlc3Vs\ndHMoKSB7CiAgICAgICAgT3BlbkpQQUVudGl0eU1hbmFnZXIgZW0gPQogICAg\nICAgICAgICAoT3BlbkpQQUVudGl0eU1hbmFnZXIpIGN1cnJlbnRFbnRpdHlN\nYW5hZ2VyKCk7CiAgICAgICAgc3RhcnRUeChlbSk7CiAgICAgICAgU3RyaW5n\nIHF1ZXJ5ID0gIlNFTEVDVCBESVNUSU5DVCByIEZST00gUnVudGltZVRlc3Qx\nIHIiOwogICAgICAgIE9wZW5KUEFRdWVyeSBxID0gZW0uY3JlYXRlUXVlcnko\ncXVlcnkpOwoKICAgICAgICB0cnkgewogICAgICAgICAgICBPYmplY3QgbCA9\nIHEuZ2V0U2luZ2xlUmVzdWx0KCk7CiAgICAgICAgICAgIGZhaWwoIlVuaXF1\nZSBxdWVyeSBtYXRjaGVkIG11bHRpcGxlIHJlc3VsdHMuIik7CiAgICAgICAg\nfQogICAgICAgIGNhdGNoIChFeGNlcHRpb24ganVlKSB7CiAgICAgICAgfQog\nICAgICAgIHEuY2xvc2VBbGwoKTsKICAgICAgICBlbmRUeChlbSk7CiAgICAg\nICAgZW5kRW0oZW0pOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHRlc3RJbXBv\nc3NpYmxlUmFuZ2VSZXR1cm5zRW1wdHlMaXN0KCkgewogICAgICAgIE9wZW5K\nUEFFbnRpdHlNYW5hZ2VyIGVtID0KICAgICAgICAgICAgKE9wZW5KUEFFbnRp\ndHlNYW5hZ2VyKSBjdXJyZW50RW50aXR5TWFuYWdlcigpOwogICAgICAgIHN0\nYXJ0VHgoZW0pOwogICAgICAgIFN0cmluZyBxdWVyeSA9ICJTRUxFQ1QgciBG\nUk9NIFJ1bnRpbWVUZXN0MSByIjsKICAgICAgICBPcGVuSlBBUXVlcnkgcSA9\nIGVtLmNyZWF0ZVF1ZXJ5KHF1ZXJ5KTsKICAgICAgICBxLnNldEZpcnN0UmVz\ndWx0KDIpOwogICAgICAgIHEuc2V0TWF4UmVzdWx0cygwKTsKCiAgICAgICAg\nTGlzdCByZXN1bHRzID0gcS5nZXRSZXN1bHRMaXN0KCk7CgogICAgICAgIGFz\nc2VydEVxdWFscygwLCByZXN1bHRzLnNpemUoKSk7CiAgICAgICAgYXNzZXJ0\nRmFsc2UocmVzdWx0cy5pdGVyYXRvcigpLmhhc05leHQoKSk7CiAgICAgICAg\ncS5jbG9zZUFsbCgpOwogICAgICAgIGVuZFR4KGVtKTsKICAgICAgICBlbmRF\nbShlbSk7CiAgICB9CgogICAgcHVibGljIHZvaWQgdGVzdEltcG9zc2libGVV\nbmlxdWVSYW5nZVJldHVybnNOdWxsKCkgewogICAgICAgIE9wZW5KUEFFbnRp\ndHlNYW5hZ2VyIGVtID0KICAgICAgICAgICAgKE9wZW5KUEFFbnRpdHlNYW5h\nZ2VyKSBjdXJyZW50RW50aXR5TWFuYWdlcigpOwogICAgICAgIHN0YXJ0VHgo\nZW0pOwoKICAgICAgICBPcGVuSlBBUXVlcnkgcSA9IGVtLmNyZWF0ZVF1ZXJ5\nKAogICAgICAgICAgICAiU0VMRUNUIERJU1RJTkNUIHIgRlJPTSBSdW50aW1l\nVGVzdDEgciBXSEVSRSByLnN0cmluZ0ZpZWxkID0gXCdUZXN0UXVlcnlSZXN1\nbHRzMVwnIik7CiAgICAgICAgcS5zZXRGaXJzdFJlc3VsdCgyKTsKICAgICAg\nICBxLnNldE1heFJlc3VsdHMoMCk7CiAgICAgICAgYXNzZXJ0VHJ1ZSgKICAg\nICAgICAgICAgInJlc3VsdGxpc3QgaXMgbm90IG51bGwgaXRzIHNpemUgaXM6\nICIgKyBxLmdldFJlc3VsdExpc3QoKS5zaXplKCksCiAgICAgICAgICAgIHEu\nZ2V0UmVzdWx0TGlzdCgpLmlzRW1wdHkoKSk7CiAgICAgICAgcS5jbG9zZUFs\nbCgpOwogICAgICAgIGVuZFR4KGVtKTsKICAgICAgICBlbmRFbShlbSk7CiAg\nICB9CgogICAgcHVibGljIHZvaWQgdGVzdFNpbmdsZVJlc3VsdFVuaXF1ZVJh\nbmdlKCkgewogICAgICAgIE9wZW5KUEFFbnRpdHlNYW5hZ2VyIGVtID0KICAg\nICAgICAgICAgKE9wZW5KUEFFbnRpdHlNYW5hZ2VyKSBjdXJyZW50RW50aXR5\nTWFuYWdlcigpOwogICAgICAgIHN0YXJ0VHgoZW0pOwoKICAgICAgICBPcGVu\nSlBBUXVlcnkgcSA9IGVtLmNyZWF0ZVF1ZXJ5KAogICAgICAgICAgICAiU0VM\nRUNUIERJU1RJTkNUIHIgRlJPTSBSdW50aW1lVGVzdDEgciBXSEVSRSByLnN0\ncmluZ0ZpZWxkID0gXCdUZXN0UXVlcnlSZXN1bHRzMVwnIik7CiAgICAgICAg\ncS5zZXRGaXJzdFJlc3VsdCgxKTsKICAgICAgICBxLnNldE1heFJlc3VsdHMo\nMTAwMDAwMCk7CgogICAgICAgIGFzc2VydFRydWUoInJlc3VsdGxpc3QgaXMg\nbm90IGVtcHR5IiwgKHEuZ2V0UmVzdWx0TGlzdCgpKS5pc0VtcHR5KCkpOwog\nICAgICAgIHEuY2xvc2VBbGwoKTsKICAgICAgICBlbmRUeChlbSk7CiAgICAg\nICAgZW5kRW0oZW0pOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHRlc3RNdWx0\naVJlc3VsdFVuaXF1ZVJhbmdlKCkgewogICAgICAgIE9wZW5KUEFFbnRpdHlN\nYW5hZ2VyIGVtID0KICAgICAgICAgICAgKE9wZW5KUEFFbnRpdHlNYW5hZ2Vy\nKSBjdXJyZW50RW50aXR5TWFuYWdlcigpOwogICAgICAgIHN0YXJ0VHgoZW0p\nOwoKICAgICAgICBPcGVuSlBBUXVlcnkgcSA9IGVtLmNyZWF0ZVF1ZXJ5KAog\nICAgICAgICAgICAiU0VMRUNUIERJU1RJTkNUIHIgRlJPTSBSdW50aW1lVGVz\ndDEgciBPUkRFUiBCWSByLnN0cmluZ0ZpZWxkIEFTQyIpOwogICAgICAgIHEu\nc2V0Rmlyc3RSZXN1bHQoMSk7CiAgICAgICAgcS5zZXRNYXhSZXN1bHRzKDIp\nOwoKICAgICAgICBhc3NlcnRFcXVhbHMoIlRlc3RRdWVyeVJlc3VsdHMyIiwK\nICAgICAgICAgICAgKChSdW50aW1lVGVzdDEpIHEuZ2V0UmVzdWx0TGlzdCgp\nLmdldCgwKSkuZ2V0U3RyaW5nRmllbGQoKSk7CiAgICAgICAgcS5jbG9zZUFs\nbCgpOwogICAgICAgIGVuZFR4KGVtKTsKICAgICAgICBlbmRFbShlbSk7CiAg\nICB9CgogICAgLyogVGhpcyB0ZXN0IGlzIGJlaW5nIGNvbW1lbnRlZCBiZWNh\ndXNlIGl0IHdhcyBzdXBwb3NlZCB0byBiZSBhIGNvbnZlcnRlZCB0ZXN0IGNv\nbXBsZW1lbnRpbmcgdGhlIG9yaWdpbmFsIEpETyB0ZXN0CiAgICAgICogd2hp\nY2ggdXNlcyB0aGUgc2V0VW5pcXVlKCkgbWV0aG9kIGF2YWlsYWJsZSBpbiBK\nRE8gUXVlcnkuIE9wZW5KUEFRdWVyeSBkb2VzIG5vdCBoYXZlIHN1Y2ggYSBt\nZXRob2QgYW5kIGhlbmNlIHRoaXMgdGVzdAogICAgICAqIGRvZXMgbm90IG1h\na2Ugc2Vuc2UuCiAgICAgIHB1YmxpYyB2b2lkIHRlc3RVbmlxdWVUaHJvd3NF\neGNlcHRpb25JZk5vblVuaXF1ZVJhbmdlKCkKICAgICB7CiAgICAgICAgIE9w\nZW5KUEFFbnRpdHlNYW5hZ2VyIGVtID0gKE9wZW5KUEFFbnRpdHlNYW5hZ2Vy\nKSBjdXJyZW50RW50aXR5TWFuYWdlcigpOwogICAgICAgICBzdGFydFR4KGVt\nKTsKCiAgICAgICAgIE9wZW5KUEFRdWVyeSBxID0gZW0uY3JlYXRlUXVlcnko\nIlNFTEVDVCBESVNUSU5DVCByIEZST00gUnVudGltZVRlc3QxIHIgT1JERVIg\nQlkgci5zdHJpbmdGaWVsZCBBU0MiKTsKICAgICAgICAgcS5zZXRGaXJzdFJl\nc3VsdCgxKTsKICAgICAgICAgcS5zZXRNYXhSZXN1bHRzKDMpOwoKICAgICAg\nICAgdHJ5CiAgICAgICAgIHsKICAgICAgICAgICAgIHEuZ2V0UmVzdWx0TGlz\ndCgpOwogICAgICAgICAgICAgZmFpbCgiVW5pcXVlIGFsbG93ZWQgbm9uLXVu\naXF1ZSByYW5nZS4iKTsKICAgICAgICAgfQogICAgICAgICBjYXRjaCAoRXhj\nZXB0aW9uIGp1ZSkKICAgICAgICAgewogICAgICAgICB9CiAgICAgICAgIHEu\nY2xvc2VBbGwoKTsKICAgICAgICAgZW5kVHgoZW0pOwogICAgICAgICBlbmRF\nbShlbSk7CiAgICAgfQogICAgICovCiAgICBwdWJsaWMgdm9pZCB0ZXN0RnVs\nbFJhbmdlKCkgewogICAgICAgIHRyeSB7CiAgICAgICAgICAgIE9wZW5KUEFF\nbnRpdHlNYW5hZ2VyIGVtID0KICAgICAgICAgICAgICAgIChPcGVuSlBBRW50\naXR5TWFuYWdlcikgY3VycmVudEVudGl0eU1hbmFnZXIoKTsKICAgICAgICAg\nICAgc3RhcnRUeChlbSk7CgogICAgICAgICAgICBPcGVuSlBBUXVlcnkgcSA9\nIGVtLmNyZWF0ZVF1ZXJ5KAogICAgICAgICAgICAgICAgIlNFTEVDVCByIEZS\nT00gUnVudGltZVRlc3QxIE9SREVSIEJZIHIuc3RyaW5nRmllbGQgQVNDIik7\nCiAgICAgICAgICAgIHEuc2V0U3ViY2xhc3NlcyhmYWxzZSk7CiAgICAgICAg\nICAgIHEuc2V0Rmlyc3RSZXN1bHQoMCk7CiAgICAgICAgICAgIExvbmcgbCA9\nIG5ldyBMb25nKExvbmcuTUFYX1ZBTFVFKTsKICAgICAgICAgICAgcS5zZXRN\nYXhSZXN1bHRzKGwuaW50VmFsdWUoKSk7CgogICAgICAgICAgICBMaXN0IHJl\ncyA9IChMaXN0KSBxLmdldFJlc3VsdExpc3QoKTsKICAgICAgICAgICAgYXNz\nZXJ0RXF1YWxzKDMsIHJlcy5zaXplKCkpOwogICAgICAgICAgICBmb3IgKGlu\ndCBpID0gMDsgaSA8IHJlcy5zaXplKCk7IGkrKykKICAgICAgICAgICAgICAg\nIGFzc2VydEVxdWFscygiVGVzdFF1ZXJ5UmVzdWx0cyIgKyAoaSAqIDIgKyAx\nKSwKICAgICAgICAgICAgICAgICAgICAoKFJ1bnRpbWVUZXN0MSkgcmVzLmdl\ndChpKSkuZ2V0U3RyaW5nRmllbGQoKSk7CiAgICAgICAgICAgIHEuY2xvc2VB\nbGwoKTsKICAgICAgICAgICAgZW5kVHgoZW0pOwogICAgICAgICAgICBlbmRF\nbShlbSk7CiAgICAgICAgfQogICAgICAgIGNhdGNoIChFeGNlcHRpb24gdW9l\nKSB7CiAgICAgICAgICAgIC8vRklYTUU6QUZBTSAtLSBGaWd1cmUgb3V0IEpQ\nQSBFcXVpdmFsZW5jZSBvZiBjcmVhdGVFeHRlbnQoY2xhc3MsIGZhbHNlKSBp\nZSBob3cgdG8gcmVzdHJpY3QgdGhlIHF1ZXJ5IHJlc3VsdCB0byB0aGUgYmFz\nZSBlbnRpdHkgYW5kCiAgICAgICAgICAgIC8vbm90IHRoZSBzdWJjbGFzc2Vz\nCiAgICAgICAgfQogICAgfQoKICAgIHB1YmxpYyB2b2lkIHRlc3RGdWxsUmFu\nZ2VTdWJzKCkgewogICAgICAgIHRyeSB7CiAgICAgICAgICAgIE9wZW5KUEFF\nbnRpdHlNYW5hZ2VyIGVtID0KICAgICAgICAgICAgICAgIChPcGVuSlBBRW50\naXR5TWFuYWdlcikgY3VycmVudEVudGl0eU1hbmFnZXIoKTsKICAgICAgICAg\nICAgc3RhcnRUeChlbSk7CgogICAgICAgICAgICBPcGVuSlBBUXVlcnkgcSA9\nIGVtLmNyZWF0ZVF1ZXJ5KAogICAgICAgICAgICAgICAgIlNFTEVDVCByIEZS\nT00gUnVudGltZVRlc3QxIE9SREVSIEJZIHIuc3RyaW5nRmllbGQgQVNDIik7\nCiAgICAgICAgICAgIHEuc2V0Rmlyc3RSZXN1bHQoMCk7CiAgICAgICAgICAg\nIExvbmcgbCA9IG5ldyBMb25nKExvbmcuTUFYX1ZBTFVFKTsKICAgICAgICAg\nICAgcS5zZXRNYXhSZXN1bHRzKGwuaW50VmFsdWUoKSk7CgogICAgICAgICAg\nICBMaXN0IHJlcyA9IChMaXN0KSBxLmdldFJlc3VsdExpc3QoKTsKICAgICAg\nICAgICAgYXNzZXJ0RXF1YWxzKDYsIHJlcy5zaXplKCkpOwogICAgICAgICAg\nICBmb3IgKGludCBpID0gMDsgaSA8IHJlcy5zaXplKCk7IGkrKykKICAgICAg\nICAgICAgICAgIGFzc2VydEVxdWFscygiVGVzdFF1ZXJ5UmVzdWx0cyIgKyAo\naSArIDEpLAogICAgICAgICAgICAgICAgICAgICgoUnVudGltZVRlc3QxKSBy\nZXMuZ2V0KGkpKS5nZXRTdHJpbmdGaWVsZCgpKTsKICAgICAgICAgICAgcS5j\nbG9zZUFsbCgpOwogICAgICAgICAgICBlbmRUeChlbSk7CiAgICAgICAgICAg\nIGVuZEVtKGVtKTsKICAgICAgICB9CiAgICAgICAgY2F0Y2ggKEV4Y2VwdGlv\nbiB1b2UpIHsKICAgICAgICB9CiAgICB9CgogICAgcHVibGljIHZvaWQgdGVz\ndEJlZ2luUmFuZ2UoKSB7CiAgICAgICAgT3BlbkpQQUVudGl0eU1hbmFnZXIg\nZW0gPQogICAgICAgICAgICAoT3BlbkpQQUVudGl0eU1hbmFnZXIpIGN1cnJl\nbnRFbnRpdHlNYW5hZ2VyKCk7CiAgICAgICAgc3RhcnRUeChlbSk7CgogICAg\nICAgIE9wZW5KUEFRdWVyeSBxID0gZW0uY3JlYXRlUXVlcnkoCiAgICAgICAg\nICAgICJTRUxFQ1QgciBGUk9NIFJ1bnRpbWVUZXN0MSByIE9SREVSIEJZIHIu\nc3RyaW5nRmllbGQgQVNDIik7CiAgICAgICAgcS5zZXRTdWJjbGFzc2VzKGZh\nbHNlKTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IDQ7IGkrKykgewog\nICAgICAgICAgICBxLnNldEZpcnN0UmVzdWx0KGkpOwogICAgICAgICAgICBx\nLnNldE1heFJlc3VsdHMoMTAwMDAwKTsKCiAgICAgICAgICAgIExpc3QgcmVz\nID0gKExpc3QpIHEuZ2V0UmVzdWx0TGlzdCgpOwogICAgICAgICAgICBhc3Nl\ncnRFcXVhbHMoInRoZXkgYXJlIG5vdCBlcXVhbCIsIDMgLSBpLCByZXMuc2l6\nZSgpKTsKICAgICAgICAgICAgaW50IGlkeCA9IDA7CgogICAgICAgICAgICAv\nLyB0cnkgYm90aCByYW5kb20gYWNlc3MgYW5kIGl0ZXJhdGlvbgogICAgICAg\nICAgICBmb3IgKGludCBqID0gMDsgaiA8IHJlcy5zaXplKCk7IGorKykKICAg\nICAgICAgICAgICAgIGFzc2VydEVxdWFscygiVGVzdFF1ZXJ5UmVzdWx0cyIg\nKyAoaiAqIDIgKyAxICsgaSAqIDIpLAogICAgICAgICAgICAgICAgICAgICgo\nKFJ1bnRpbWVUZXN0MSkgcmVzLmdldChqKSkuZ2V0U3RyaW5nRmllbGQoKSkp\nOwogICAgICAgICAgICBmb3IgKEl0ZXJhdG9yIGl0ciA9IHJlcy5pdGVyYXRv\ncigpOyBpdHIuaGFzTmV4dCgpOyBpZHgrKykKICAgICAgICAgICAgICAgIGFz\nc2VydEVxdWFscygiVGVzdFF1ZXJ5UmVzdWx0cyIgKyAoaWR4ICogMiArIDEg\nKyBpICogMiksCiAgICAgICAgICAgICAgICAgICAgKChSdW50aW1lVGVzdDEp\nIGl0ci5uZXh0KCkpLmdldFN0cmluZ0ZpZWxkKCkpOwogICAgICAgIH0KICAg\nICAgICBxLmNsb3NlQWxsKCk7CiAgICAgICAgZW5kVHgoZW0pOwogICAgICAg\nIGVuZEVtKGVtKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCB0ZXN0QmVnaW5S\nYW5nZVN1YnMoKSB7CiAgICAgICAgT3BlbkpQQUVudGl0eU1hbmFnZXIgZW0g\nPQogICAgICAgICAgICAoT3BlbkpQQUVudGl0eU1hbmFnZXIpIGN1cnJlbnRF\nbnRpdHlNYW5hZ2VyKCk7CiAgICAgICAgc3RhcnRUeChlbSk7CgogICAgICAg\nIE9wZW5KUEFRdWVyeSBxID0gZW0uY3JlYXRlUXVlcnkoCiAgICAgICAgICAg\nICJTRUxFQ1QgciBGUk9NIFJ1bnRpbWVUZXN0MSByIE9SREVSIEJZIHIuc3Ry\naW5nRmllbGQgQVNDIik7CgogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwg\nNzsgaSsrKSB7CiAgICAgICAgICAgIHEuc2V0Rmlyc3RSZXN1bHQoaSk7CiAg\nICAgICAgICAgIExvbmcgbCA9IG5ldyBMb25nKExvbmcuTUFYX1ZBTFVFKTsK\nICAgICAgICAgICAgcS5zZXRNYXhSZXN1bHRzKDEwMDAwMCk7CgogICAgICAg\nICAgICBMaXN0IHJlcyA9IChMaXN0KSBxLmdldFJlc3VsdExpc3QoKTsKICAg\nICAgICAgICAgYXNzZXJ0RXF1YWxzKDYgLSBpLCByZXMuc2l6ZSgpKTsKICAg\nICAgICAgICAgaW50IGlkeCA9IDA7CgogICAgICAgICAgICAvLyB0cnkgYm90\naCByYW5kb20gYWNlc3MgYW5kIGl0ZXJhdGlvbgogICAgICAgICAgICBmb3Ig\nKGludCBqID0gMDsgaiA8IHJlcy5zaXplKCk7IGorKykKICAgICAgICAgICAg\nICAgIGFzc2VydEVxdWFscygiVGVzdFF1ZXJ5UmVzdWx0cyIgKyAoaiArIDEg\nKyBpKSwKICAgICAgICAgICAgICAgICAgICAoKFJ1bnRpbWVUZXN0MSkgcmVz\nLmdldChqKSkuZ2V0U3RyaW5nRmllbGQoKSk7CiAgICAgICAgICAgIGZvciAo\nSXRlcmF0b3IgaXRyID0gcmVzLml0ZXJhdG9yKCk7IGl0ci5oYXNOZXh0KCk7\nIGlkeCsrKQogICAgICAgICAgICAgICAgYXNzZXJ0RXF1YWxzKCJUZXN0UXVl\ncnlSZXN1bHRzIiArIChpZHggKyAxICsgaSksCiAgICAgICAgICAgICAgICAg\nICAgKChSdW50aW1lVGVzdDEpIGl0ci5uZXh0KCkpLmdldFN0cmluZ0ZpZWxk\nKCkpOwogICAgICAgIH0KICAgICAgICBxLmNsb3NlQWxsKCk7CiAgICAgICAg\nZW5kVHgoZW0pOwogICAgICAgIGVuZEVtKGVtKTsKICAgIH0KCiAgICBwdWJs\naWMgdm9pZCB0ZXN0RW5kUmFuZ2UoKSB7CiAgICAgICAgT3BlbkpQQUVudGl0\neU1hbmFnZXIgZW0gPQogICAgICAgICAgICAoT3BlbkpQQUVudGl0eU1hbmFn\nZXIpIGN1cnJlbnRFbnRpdHlNYW5hZ2VyKCk7CiAgICAgICAgc3RhcnRUeChl\nbSk7CgogICAgICAgIE9wZW5KUEFRdWVyeSBxID0gZW0uY3JlYXRlUXVlcnko\nCiAgICAgICAgICAgICJTRUxFQ1QgciBGUk9NIFJ1bnRpbWVUZXN0MSByIE9S\nREVSIEJZIHIuc3RyaW5nRmllbGQgQVNDIik7CiAgICAgICAgcS5zZXRTdWJj\nbGFzc2VzKGZhbHNlKTsKCiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCA0\nOyBpKyspIHsKICAgICAgICAgICAgcS5zZXRGaXJzdFJlc3VsdCgwKTsKICAg\nICAgICAgICAgcS5zZXRNYXhSZXN1bHRzKGkpOwoKICAgICAgICAgICAgTGlz\ndCByZXMgPSAoTGlzdCkgcS5nZXRSZXN1bHRMaXN0KCk7CiAgICAgICAgICAg\nIGFzc2VydEVxdWFscyhpLCByZXMuc2l6ZSgpKTsKICAgICAgICAgICAgaW50\nIGlkeCA9IDA7CgogICAgICAgICAgICAvLyB0cnkgYm90aCByYW5kb20gYWNl\nc3MgYW5kIGl0ZXJhdGlvbgogICAgICAgICAgICBmb3IgKGludCBqID0gMDsg\naiA8IHJlcy5zaXplKCk7IGorKykKICAgICAgICAgICAgICAgIGFzc2VydEVx\ndWFscygiVGVzdFF1ZXJ5UmVzdWx0cyIgKyAoaiAqIDIgKyAxKSwKICAgICAg\nICAgICAgICAgICAgICAoKFJ1bnRpbWVUZXN0MSkgcmVzLmdldChqKSkuZ2V0\nU3RyaW5nRmllbGQoKSk7CiAgICAgICAgICAgIGZvciAoSXRlcmF0b3IgaXRy\nID0gcmVzLml0ZXJhdG9yKCk7IGl0ci5oYXNOZXh0KCk7IGlkeCsrKQogICAg\nICAgICAgICAgICAgYXNzZXJ0RXF1YWxzKCJUZXN0UXVlcnlSZXN1bHRzIiAr\nIChpZHggKiAyICsgMSksCiAgICAgICAgICAgICAgICAgICAgKChSdW50aW1l\nVGVzdDEpIGl0ci5uZXh0KCkpLmdldFN0cmluZ0ZpZWxkKCkpOwogICAgICAg\nIH0KICAgICAgICBxLmNsb3NlQWxsKCk7CiAgICAgICAgZW5kVHgoZW0pOwog\nICAgICAgIGVuZEVtKGVtKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCB0ZXN0\nRW5kUmFuZ2VTdWJzKCkgewogICAgICAgIE9wZW5KUEFFbnRpdHlNYW5hZ2Vy\nIGVtID0KICAgICAgICAgICAgKE9wZW5KUEFFbnRpdHlNYW5hZ2VyKSBjdXJy\nZW50RW50aXR5TWFuYWdlcigpOwogICAgICAgIHN0YXJ0VHgoZW0pOwoKICAg\nICAgICBPcGVuSlBBUXVlcnkgcSA9IGVtLmNyZWF0ZVF1ZXJ5KAogICAgICAg\nICAgICAiU0VMRUNUIHIgRlJPTSBSdW50aW1lVGVzdDEgciBPUkRFUiBCWSBy\nLnN0cmluZ0ZpZWxkIEFTQyIpOwoKICAgICAgICBmb3IgKGludCBpID0gMDsg\naSA8IDc7IGkrKykgewogICAgICAgICAgICBxLnNldEZpcnN0UmVzdWx0KDAp\nOwogICAgICAgICAgICBxLnNldE1heFJlc3VsdHMoaSk7CiAgICAgICAgICAg\nIExpc3QgcmVzID0gKExpc3QpIHEuZ2V0UmVzdWx0TGlzdCgpOwogICAgICAg\nICAgICBhc3NlcnRFcXVhbHMoaSwgcmVzLnNpemUoKSk7CiAgICAgICAgICAg\nIGludCBpZHggPSAwOwoKICAgICAgICAgICAgLy8gdHJ5IGJvdGggcmFuZG9t\nIGFjZXNzIGFuZCBpdGVyYXRpb24KICAgICAgICAgICAgZm9yIChpbnQgaiA9\nIDA7IGogPCByZXMuc2l6ZSgpOyBqKyspCiAgICAgICAgICAgICAgICBhc3Nl\ncnRFcXVhbHMoIlRlc3RRdWVyeVJlc3VsdHMiICsgKGogKyAxKSwKICAgICAg\nICAgICAgICAgICAgICAoKFJ1bnRpbWVUZXN0MSkgcmVzLmdldChqKSkuZ2V0\nU3RyaW5nRmllbGQoKSk7CiAgICAgICAgICAgIGZvciAoSXRlcmF0b3IgaXRy\nID0gcmVzLml0ZXJhdG9yKCk7IGl0ci5oYXNOZXh0KCk7IGlkeCsrKQogICAg\nICAgICAgICAgICAgYXNzZXJ0RXF1YWxzKCJUZXN0UXVlcnlSZXN1bHRzIiAr\nIChpZHggKyAxKSwKICAgICAgICAgICAgICAgICAgICAoKFJ1bnRpbWVUZXN0\nMSkgaXRyLm5leHQoKSkuZ2V0U3RyaW5nRmllbGQoKSk7CiAgICAgICAgfQog\nICAgICAgIHEuY2xvc2VBbGwoKTsKICAgICAgICBlbmRUeChlbSk7CiAgICAg\nICAgZW5kRW0oZW0pOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHRlc3RNaWRS\nYW5nZSgpIHsKICAgICAgICBPcGVuSlBBRW50aXR5TWFuYWdlciBlbSA9CiAg\nICAgICAgICAgIChPcGVuSlBBRW50aXR5TWFuYWdlcikgY3VycmVudEVudGl0\neU1hbmFnZXIoKTsKICAgICAgICBzdGFydFR4KGVtKTsKCiAgICAgICAgT3Bl\nbkpQQVF1ZXJ5IHEgPSBlbS5jcmVhdGVRdWVyeSgKICAgICAgICAgICAgIlNF\nTEVDVCByIEZST00gUnVudGltZVRlc3QxIHIgT1JERVIgQlkgci5zdHJpbmdG\naWVsZCBBU0MiKTsKICAgICAgICBxLnNldFN1YmNsYXNzZXMoZmFsc2UpOwoK\nICAgICAgICBxLnNldEZpcnN0UmVzdWx0KDEpOwogICAgICAgIHEuc2V0TWF4\nUmVzdWx0cygzKTsKICAgICAgICBMaXN0IHJlcyA9IChMaXN0KSBxLmdldFJl\nc3VsdExpc3QoKTsKICAgICAgICBhc3NlcnRFcXVhbHMoMiwgcmVzLnNpemUo\nKSk7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCByZXMuc2l6ZSgpOyBp\nKyspCiAgICAgICAgICAgIGFzc2VydEVxdWFscygiVGVzdFF1ZXJ5UmVzdWx0\ncyIgKyAoaSAqIDIgKyAxICsgMiksCiAgICAgICAgICAgICAgICAoKFJ1bnRp\nbWVUZXN0MSkgcmVzLmdldChpKSkuZ2V0U3RyaW5nRmllbGQoKSk7CiAgICAg\nICAgaW50IGlkeCA9IDA7CiAgICAgICAgZm9yIChJdGVyYXRvciBpdHIgPSBy\nZXMuaXRlcmF0b3IoKTsgaXRyLmhhc05leHQoKTsgaWR4KyspCiAgICAgICAg\nICAgIGFzc2VydEVxdWFscygiVGVzdFF1ZXJ5UmVzdWx0cyIgKyAoaWR4ICog\nMiArIDEgKyAyKSwKICAgICAgICAgICAgICAgICgoUnVudGltZVRlc3QxKSBp\ndHIubmV4dCgpKS5nZXRTdHJpbmdGaWVsZCgpKTsKICAgICAgICBxLmNsb3Nl\nQWxsKCk7CiAgICAgICAgZW5kVHgoZW0pOwogICAgICAgIGVuZEVtKGVtKTsK\nICAgIH0KCiAgICBwdWJsaWMgdm9pZCB0ZXN0TWlkUmFuZ2VTdWJzKCkgewog\nICAgICAgIE9wZW5KUEFFbnRpdHlNYW5hZ2VyIGVtID0KICAgICAgICAgICAg\nKE9wZW5KUEFFbnRpdHlNYW5hZ2VyKSBjdXJyZW50RW50aXR5TWFuYWdlcigp\nOwogICAgICAgIHN0YXJ0VHgoZW0pOwoKICAgICAgICBPcGVuSlBBUXVlcnkg\ncSA9IGVtLmNyZWF0ZVF1ZXJ5KAogICAgICAgICAgICAiU0VMRUNUIHIgRlJP\nTSBSdW50aW1lVGVzdDEgciBPUkRFUiBCWSByLnN0cmluZ0ZpZWxkIEFTQyIp\nOwogICAgICAgIHEuc2V0Rmlyc3RSZXN1bHQoMSk7CiAgICAgICAgcS5zZXRN\nYXhSZXN1bHRzKDMpOwoKICAgICAgICBMaXN0IHJlcyA9IChMaXN0KSBxLmdl\ndFJlc3VsdExpc3QoKTsKICAgICAgICBhc3NlcnRFcXVhbHMoMywgcmVzLnNp\nemUoKSk7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCByZXMuc2l6ZSgp\nOyBpKyspCiAgICAgICAgICAgIGFzc2VydEVxdWFscygiVGVzdFF1ZXJ5UmVz\ndWx0cyIgKyAoaSArIDEgKyAxKSwKICAgICAgICAgICAgICAgICgoUnVudGlt\nZVRlc3QxKSByZXMuZ2V0KGkpKS5nZXRTdHJpbmdGaWVsZCgpKTsKICAgICAg\nICBpbnQgaWR4ID0gMDsKICAgICAgICBmb3IgKEl0ZXJhdG9yIGl0ciA9IHJl\ncy5pdGVyYXRvcigpOyBpdHIuaGFzTmV4dCgpOyBpZHgrKykKICAgICAgICAg\nICAgYXNzZXJ0RXF1YWxzKCJUZXN0UXVlcnlSZXN1bHRzIiArIChpZHggKyAx\nICsgMSksCiAgICAgICAgICAgICAgICAoKFJ1bnRpbWVUZXN0MSkgaXRyLm5l\neHQoKSkuZ2V0U3RyaW5nRmllbGQoKSk7CiAgICAgICAgcS5jbG9zZUFsbCgp\nOwogICAgICAgIGVuZFR4KGVtKTsKICAgICAgICBlbmRFbShlbSk7CiAgICB9\nCgogICAgcHVibGljIHZvaWQgdGVzdFBlc3NpbWlzdGljT3JkZXJlZFJhbmdl\nKCkgewogICAgICAgIC8vIHRlc3QgdG8gbWFrZSBzdXJlIHdoYXRldmVyIG1h\nY2hpbmF0aW9ucyB3ZSBkbyB0byBnZXQgYSByYW5nZSBkb2Vzbid0CiAgICAg\nICAgLy8gaW50ZXJmZXJlIHdpdGggRk9SIFVQREFURQogICAgICAgIE9wZW5K\nUEFFbnRpdHlNYW5hZ2VyIGVtID0KICAgICAgICAgICAgKE9wZW5KUEFFbnRp\ndHlNYW5hZ2VyKSBjdXJyZW50RW50aXR5TWFuYWdlcigpOwogICAgICAgIHN0\nYXJ0VHgoZW0pOwoKICAgICAgICBPcGVuSlBBUXVlcnkgcSA9IGVtLmNyZWF0\nZVF1ZXJ5KAogICAgICAgICAgICAiU0VMRUNUIHIgRlJPTSBSdW50aW1lVGVz\ndDEgciBPUkRFUiBCWSByLnN0cmluZ0ZpZWxkIEFTQyIpOwogICAgICAgIHEu\nc2V0U3ViY2xhc3NlcyhmYWxzZSk7CiAgICAgICAgcS5zZXRGaXJzdFJlc3Vs\ndCgwKTsKICAgICAgICBxLnNldE1heFJlc3VsdHMoMik7CgogICAgICAgICgo\nSkRCQ0ZldGNoUGxhbikgcS5nZXRGZXRjaFBsYW4oKSkuc2V0RWFnZXJGZXRj\naE1vZGUoRmV0Y2hNb2RlLk5PTkUpOwoKICAgICAgICBMaXN0IHJlcyA9IChM\naXN0KSBxLmdldFJlc3VsdExpc3QoKTsKICAgICAgICBhc3NlcnRFcXVhbHMo\nMiwgcmVzLnNpemUoKSk7CiAgICAgICAgYXNzZXJ0RXF1YWxzKCJUZXN0UXVl\ncnlSZXN1bHRzMSIsCiAgICAgICAgICAgICgoUnVudGltZVRlc3QxKSByZXMu\nZ2V0KDApKS5nZXRTdHJpbmdGaWVsZCgpKTsKICAgICAgICBhc3NlcnRFcXVh\nbHMoIlRlc3RRdWVyeVJlc3VsdHMzIiwKICAgICAgICAgICAgKChSdW50aW1l\nVGVzdDEpIHJlcy5nZXQoMSkpLmdldFN0cmluZ0ZpZWxkKCkpOwogICAgICAg\nIHEuY2xvc2VBbGwoKTsKICAgICAgICBlbmRUeChlbSk7CiAgICAgICAgZW5k\nRW0oZW0pOwogICAgfQp9Cgo=\n","encoding":"base64"}

