{"sha":"9ad06a15d2535d81bdad7eae8ac4033b4239b795","node_id":"MDQ6QmxvYjIwNjM2NDo5YWQwNmExNWQyNTM1ZDgxYmRhZDdlYWU4YWM0MDMzYjQyMzliNzk1","size":17389,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/9ad06a15d2535d81bdad7eae8ac4033b4239b795","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuc2xpY2UuamRiYzsKCmltcG9y\ndCBqYXZhLnNxbC5Db25uZWN0aW9uOwppbXBvcnQgamF2YS5zcWwuU1FMRXhj\nZXB0aW9uOwppbXBvcnQgamF2YS51dGlsLkFycmF5TGlzdDsKaW1wb3J0IGph\ndmEudXRpbC5Db2xsZWN0aW9uczsKaW1wb3J0IGphdmEudXRpbC5MaXN0Owpp\nbXBvcnQgamF2YS51dGlsLk1hcDsKaW1wb3J0IGphdmEudXRpbC5Qcm9wZXJ0\naWVzOwppbXBvcnQgamF2YS51dGlsLmNvbmN1cnJlbnQuRXhlY3V0b3JTZXJ2\naWNlOwoKaW1wb3J0IGphdmF4LnNxbC5EYXRhU291cmNlOwppbXBvcnQgamF2\nYXguc3FsLlhBRGF0YVNvdXJjZTsKCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEuY29uZi5PcGVuSlBBQ29uZmlndXJhdGlvbjsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5qZGJjLmNvbmYuSkRCQ0NvbmZpZ3VyYXRpb247CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5jb25mLkpEQkNDb25maWd1cmF0\naW9uSW1wbDsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNjaGVt\nYS5EYXRhU291cmNlRmFjdG9yeTsKaW1wb3J0IG9yZy5hcGFjaGUub3Blbmpw\nYS5saWIuY29uZi5Cb29sZWFuVmFsdWU7CmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEubGliLmNvbmYuQ29uZmlndXJhdGlvblByb3ZpZGVyOwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLmxpYi5jb25mLlBsdWdpblZhbHVlOwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi5jb25mLlN0cmluZ0xpc3RWYWx1\nZTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIuY29uZi5TdHJpbmdW\nYWx1ZTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIuamRiYy5EZWNv\ncmF0aW5nRGF0YVNvdXJjZTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5s\naWIuamRiYy5EZWxlZ2F0aW5nRGF0YVNvdXJjZTsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5saWIubG9nLkxvZzsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5saWIubG9nLkxvZ0ZhY3Rvcnk7CmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEubGliLmxvZy5Mb2dGYWN0b3J5SW1wbDsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5saWIudXRpbC5Mb2NhbGl6ZXI7CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEuc2xpY2UuRGlzdHJpYnV0ZWRCcm9rZXJJbXBsOwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLnNsaWNlLkRpc3RyaWJ1dGlvblBvbGlj\neTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5zbGljZS5FeGVjdXRvclNl\ncnZpY2VWYWx1ZTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5zbGljZS5Q\ncm9kdWN0RGVyaXZhdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5z\nbGljZS5TbGljZTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLlVz\nZXJFeGNlcHRpb247CgovKioKICogSW1wbGVtZW50cyBhIGRpc3RyaWJ1dGVk\nIGNvbmZpZ3VyYXRpb24gb2YgSkRCQ1N0b3JlTWFuYWdlcnMuCiAqIFRoZSBv\ncmlnaW5hbCBjb25maWd1cmF0aW9uIHByb3BlcnRpZXMgYXJlIGFuYWx5emVk\nIHRvIGNyZWF0ZSBhIHNldCBvZgogKiBTbGljZSBzcGVjaWZpYyBwcm9wZXJ0\naWVzIHdpdGggZGVmYXVsdGluZyBydWxlcy4gCiAqIAogKiBAYXV0aG9yIFBp\nbmFraSBQb2RkYXIKICogCiAqLwpwdWJsaWMgY2xhc3MgRGlzdHJpYnV0ZWRK\nREJDQ29uZmlndXJhdGlvbkltcGwgZXh0ZW5kcyBKREJDQ29uZmlndXJhdGlv\nbkltcGwKICAgICAgICBpbXBsZW1lbnRzIERpc3RyaWJ1dGVkSkRCQ0NvbmZp\nZ3VyYXRpb24gewoKICAgIHByaXZhdGUgZmluYWwgTGlzdDxTbGljZT4gX3Ns\naWNlcyA9IG5ldyBBcnJheUxpc3Q8U2xpY2U+KCk7CiAgICBwcml2YXRlIExp\nc3Q8U3RyaW5nPiBfYWN0aXZlU2xpY2VOYW1lcyA9IG5ldyBBcnJheUxpc3Q8\nU3RyaW5nPigpOwogICAgcHJpdmF0ZSBTbGljZSBfbWFzdGVyOwogICAgCiAg\nICBwcml2YXRlIERlY29yYXRpbmdEYXRhU291cmNlIHZpcnR1YWxEYXRhU291\ncmNlOwogICAgCiAgICBwcm90ZWN0ZWQgQm9vbGVhblZhbHVlIGxlbmllbnRQ\nbHVnaW47CiAgICBwcm90ZWN0ZWQgU3RyaW5nVmFsdWUgbWFzdGVyUGx1Z2lu\nOwogICAgcHJvdGVjdGVkIFN0cmluZ0xpc3RWYWx1ZSBuYW1lc1BsdWdpbjsK\nICAgIHByb3RlY3RlZCBFeGVjdXRvclNlcnZpY2VWYWx1ZSBleGVjdXRvclNl\ncnZpY2VQbHVnaW47CiAgICBwcm90ZWN0ZWQgUGx1Z2luVmFsdWUgZGlzdHJp\nYnV0aW9uUG9saWN5UGx1Z2luOwoKICAgIHB1YmxpYyBzdGF0aWMgZmluYWwg\nU3RyaW5nIERPVCA9ICIuIjsKICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgU3Ry\naW5nIFJFR0VYX0RPVCA9ICJcXC4iOwogICAgcHVibGljIHN0YXRpYyBmaW5h\nbCBTdHJpbmcgUFJFRklYX1NMSUNFID0gUHJvZHVjdERlcml2YXRpb24uUFJF\nRklYX1NMSUNFICsgRE9UOwogICAgcHVibGljIHN0YXRpYyBmaW5hbCBTdHJp\nbmcgUFJFRklYX09QRU5KUEEgPSAib3BlbmpwYS4iOwogICAgcHJpdmF0ZSBz\ndGF0aWMgTG9jYWxpemVyIF9sb2MgPQogICAgICAgICAgICBMb2NhbGl6ZXIu\nZm9yUGFja2FnZShEaXN0cmlidXRlZEpEQkNDb25maWd1cmF0aW9uSW1wbC5j\nbGFzcyk7CgogICAgLyoqCiAgICAgKiBDb25maWd1cmUgaXRzZWxmIGFzIHdl\nbGwgYXMgdW5kZXJseWluZyBzbGljZXMuCiAgICAgKiAKICAgICAqLwogICAg\ncHVibGljIERpc3RyaWJ1dGVkSkRCQ0NvbmZpZ3VyYXRpb25JbXBsKENvbmZp\nZ3VyYXRpb25Qcm92aWRlciBjcCkgewogICAgICAgIHN1cGVyKHRydWUsIGZh\nbHNlKTsKICAgICAgICBNYXAgcCA9IGNwLmdldFByb3BlcnRpZXMoKTsKICAg\nICAgICBTdHJpbmcgcFVuaXQgPSBnZXRQZXJzaXN0ZW5jZVVuaXROYW1lKHAp\nOwogICAgICAgIHNldERpYWdub3N0aWNDb250ZXh0KHBVbml0KTsKICAgICAg\nICAKICAgICAgICBicm9rZXJQbHVnaW4uc2V0U3RyaW5nKERpc3RyaWJ1dGVk\nQnJva2VySW1wbC5jbGFzcy5nZXROYW1lKCkpOwogICAgICAgIAogICAgICAg\nIGRpc3RyaWJ1dGlvblBvbGljeVBsdWdpbiA9IGFkZFBsdWdpbigiRGlzdHJp\nYnV0aW9uUG9saWN5IiwgdHJ1ZSk7CiAgICAgICAgZGlzdHJpYnV0aW9uUG9s\naWN5UGx1Z2luLnNldER5bmFtaWModHJ1ZSk7CiAgICAgICAgCiAgICAgICAg\nbGVuaWVudFBsdWdpbiA9IGFkZEJvb2xlYW4oIkxlbmllbnQiKTsKICAgICAg\nICAKICAgICAgICBtYXN0ZXJQbHVnaW4gPSBhZGRTdHJpbmcoIk1hc3RlciIp\nOwogICAgICAgIAogICAgICAgIG5hbWVzUGx1Z2luID0gYWRkU3RyaW5nTGlz\ndCgiTmFtZXMiKTsKICAgICAgICAKICAgICAgICBleGVjdXRvclNlcnZpY2VQ\nbHVnaW4gPSBuZXcgRXhlY3V0b3JTZXJ2aWNlVmFsdWUoKTsKICAgICAgICBh\nZGRWYWx1ZShleGVjdXRvclNlcnZpY2VQbHVnaW4pOwogICAgICAgIAogICAg\nICAgIHNldFNsaWNlcyhwKTsKICAgIH0KICAgIAogICAgcHJpdmF0ZSBTdHJp\nbmcgZ2V0UGVyc2lzdGVuY2VVbml0TmFtZShNYXAgcCkgewogICAgICAgIE9i\namVjdCB1bml0ID0gcC5nZXQoUFJFRklYX09QRU5KUEEraWQuZ2V0UHJvcGVy\ndHkoKSk7CiAgICAgICAgcmV0dXJuICh1bml0ID09IG51bGwpID8gIj8iIDog\ndW5pdC50b1N0cmluZygpOwogICAgfQogICAgCiAgICBwcml2YXRlIHZvaWQg\nc2V0RGlhZ25vc3RpY0NvbnRleHQoU3RyaW5nIHVuaXQpIHsKICAgICAgICBM\nb2dGYWN0b3J5IGxvZ0ZhY3RvcnkgPSBnZXRMb2dGYWN0b3J5KCk7CiAgICAg\nICAgaWYgKGxvZ0ZhY3RvcnkgaW5zdGFuY2VvZiBMb2dGYWN0b3J5SW1wbCkg\newogICAgICAgICAgICAoKExvZ0ZhY3RvcnlJbXBsKWxvZ0ZhY3RvcnkpLnNl\ndERpYWdub3N0aWNDb250ZXh0KHVuaXQpOwogICAgICAgIH0KICAgIH0KCiAg\nICAvKioKICAgICAqIEdldHMgdGhlIG5hbWUgb2YgdGhlIGFjdGl2ZSBzbGlj\nZXMuCiAgICAgKi8KICAgIHB1YmxpYyBMaXN0PFN0cmluZz4gZ2V0QWN0aXZl\nU2xpY2VOYW1lcygpIHsKICAgICAgICBpZiAoX2FjdGl2ZVNsaWNlTmFtZXMu\naXNFbXB0eSgpKSB7CiAgICAgICAgICAgIGZvciAoU2xpY2Ugc2xpY2U6X3Ns\naWNlcykKICAgICAgICAgICAgICAgIGlmIChzbGljZS5pc0FjdGl2ZSgpKQog\nICAgICAgICAgICAgICAgICAgIF9hY3RpdmVTbGljZU5hbWVzLmFkZChzbGlj\nZS5nZXROYW1lKCkpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gX2FjdGl2\nZVNsaWNlTmFtZXM7CiAgICB9CiAgICAKICAgIC8qKgogICAgICogR2V0cyB0\naGUgbmFtZSBvZiB0aGUgYXZhaWxhYmxlIHNsaWNlcy4KICAgICAqLwogICAg\ncHVibGljIExpc3Q8U3RyaW5nPiBnZXRBdmFpbGFibGVTbGljZU5hbWVzKCkg\newogICAgICAgIExpc3Q8U3RyaW5nPiByZXN1bHQgPSBuZXcgQXJyYXlMaXN0\nPFN0cmluZz4oKTsKICAgICAgICBmb3IgKFNsaWNlIHNsaWNlOl9zbGljZXMp\nCiAgICAgICAgICAgIHJlc3VsdC5hZGQoc2xpY2UuZ2V0TmFtZSgpKTsKICAg\nICAgICByZXR1cm4gcmVzdWx0OwogICAgfQogICAgCiAgICAvKioKICAgICAq\nIEdldHMgdGhlIHNsaWNlcyBvZiBnaXZlbiBzdGF0dXMuIE51bGwgcmV0dXJu\ncyBhbGwgaXJyZXNwZWN0aXZlIG9mIHN0YXR1cy4KICAgICAqLwogICAgcHVi\nbGljIExpc3Q8U2xpY2U+IGdldFNsaWNlcyhTbGljZS5TdGF0dXMuLi5zdGF0\ndXNlcykgewogICAgICAgIGlmIChzdGF0dXNlcyA9PSBudWxsKQogICAgICAg\nICAgICByZXR1cm4gQ29sbGVjdGlvbnMudW5tb2RpZmlhYmxlTGlzdChfc2xp\nY2VzKTsKICAgICAgICBMaXN0PFNsaWNlPiByZXN1bHQgPSBuZXcgQXJyYXlM\naXN0PFNsaWNlPigpOwogICAgICAgIGZvciAoU2xpY2Ugc2xpY2U6X3NsaWNl\ncykgewogICAgICAgICAgICBmb3IgKFNsaWNlLlN0YXR1cyBzdGF0dXM6c3Rh\ndHVzZXMpCiAgICAgICAgICAgICAgICBpZiAoc2xpY2UuZ2V0U3RhdHVzKCku\nZXF1YWxzKHN0YXR1cykpCiAgICAgICAgICAgICAgICAgICAgcmVzdWx0LmFk\nZChzbGljZSk7CiAgICAgICAgfQogICAgICAgIHJldHVybiByZXN1bHQ7CiAg\nICB9CiAgICAKICAgIC8qKgogICAgICogR2V0cyB0aGUgbWFzdGVyIHNsaWNl\nLiAKICAgICAqLwogICAgcHVibGljIFNsaWNlIGdldE1hc3RlcigpIHsKICAg\nICAgICByZXR1cm4gX21hc3RlcjsKICAgIH0KCiAgICAvKioKICAgICAqIEdl\ndCB0aGUgY29uZmlndXJhdGlvbiBmb3IgZ2l2ZW4gc2xpY2UuCiAgICAgKi8K\nICAgIHB1YmxpYyBTbGljZSBnZXRTbGljZShTdHJpbmcgbmFtZSkgewogICAg\nICAgIGZvciAoU2xpY2Ugc2xpY2U6X3NsaWNlcykKICAgICAgICAgICAgaWYg\nKHNsaWNlLmdldE5hbWUoKS5lcXVhbHMobmFtZSkpCiAgICAgICAgICAgICAg\nICByZXR1cm4gc2xpY2U7CiAgICAgICAgdGhyb3cgbmV3IFVzZXJFeGNlcHRp\nb24oX2xvYy5nZXQoInNsaWNlLW5vdC1mb3VuZCIsIG5hbWUsCiAgICAgICAg\nICAgICAgICAgICAgZ2V0QWN0aXZlU2xpY2VOYW1lcygpKSk7CiAgICB9Cgog\nICAgcHVibGljIERpc3RyaWJ1dGlvblBvbGljeSBnZXREaXN0cmlidXRpb25Q\nb2xpY3lJbnN0YW5jZSgpIHsKICAgICAgICBpZiAoZGlzdHJpYnV0aW9uUG9s\naWN5UGx1Z2luLmdldCgpID09IG51bGwpIHsKICAgICAgICAgICAgZGlzdHJp\nYnV0aW9uUG9saWN5UGx1Z2luLmluc3RhbnRpYXRlKERpc3RyaWJ1dGlvblBv\nbGljeS5jbGFzcywKICAgICAgICAgICAgICAgICAgICB0aGlzLCB0cnVlKTsK\nICAgICAgICB9CiAgICAgICAgcmV0dXJuIChEaXN0cmlidXRpb25Qb2xpY3kp\nIGRpc3RyaWJ1dGlvblBvbGljeVBsdWdpbi5nZXQoKTsKICAgIH0KCiAgICBw\ndWJsaWMgdm9pZCBzZXREaXN0cmlidXRpb25Qb2xpY3lJbnN0YW5jZShTdHJp\nbmcgdmFsKSB7CiAgICAgICAgZGlzdHJpYnV0aW9uUG9saWN5UGx1Z2luLnNl\ndCh2YWwpOwogICAgfQoKICAgIHB1YmxpYyBPYmplY3QgZ2V0Q29ubmVjdGlv\nbkZhY3RvcnkoKSB7CiAgICAgICAgaWYgKHZpcnR1YWxEYXRhU291cmNlID09\nIG51bGwpIHsKICAgICAgICAgICAgRGlzdHJpYnV0ZWREYXRhU291cmNlIGRz\nID0gY3JlYXRlRGlzdHJpYnV0ZWREYXRhU3RvcmUoKTsKICAgICAgICAgICAg\ndmlydHVhbERhdGFTb3VyY2UgPQogICAgICAgICAgICAgICAgICAgIERhdGFT\nb3VyY2VGYWN0b3J5Lmluc3RhbGxEQkRpY3Rpb25hcnkoCiAgICAgICAgICAg\nICAgICAgICAgICAgICAgICBnZXREQkRpY3Rpb25hcnlJbnN0YW5jZSgpLCBk\ncywgdGhpcywgZmFsc2UpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gdmly\ndHVhbERhdGFTb3VyY2U7CiAgICB9CgogICAgLyoqCiAgICAgKiBDcmVhdGUg\nYSB2aXJ0dWFsIERpc3RyaWJ1dGVkRGF0YVNvdXJjZSBhcyBhIGNvbXBvc2l0\nZSBvZiBpbmRpdmlkdWFsCiAgICAgKiBzbGljZXMgYXMgcGVyIGNvbmZpZ3Vy\nYXRpb24sIG9wdGlvbmFsbHkgaWdub3Jpbmcgc2xpY2VzIHRoYXQgY2FuIG5v\ndCBiZQogICAgICogY29ubmVjdGVkLgogICAgICovCiAgICBwcml2YXRlIERp\nc3RyaWJ1dGVkRGF0YVNvdXJjZSBjcmVhdGVEaXN0cmlidXRlZERhdGFTdG9y\nZSgpIHsKICAgICAgICBMaXN0PERhdGFTb3VyY2U+IGRhdGFTb3VyY2VzID0g\nbmV3IEFycmF5TGlzdDxEYXRhU291cmNlPigpOwogICAgICAgIGJvb2xlYW4g\naXNMZW5pZW50ID0gbGVuaWVudFBsdWdpbi5nZXQoKTsKICAgICAgICBib29s\nZWFuIGlzWEEgPSB0cnVlOwogICAgICAgIGZvciAoU2xpY2Ugc2xpY2UgOiBf\nc2xpY2VzKSB7CiAgICAgICAgICAgIEpEQkNDb25maWd1cmF0aW9uIGNvbmYg\nPSAoSkRCQ0NvbmZpZ3VyYXRpb24pc2xpY2UuZ2V0Q29uZmlndXJhdGlvbigp\nOwogICAgICAgICAgICBMb2cgbG9nID0gY29uZi5nZXRDb25maWd1cmF0aW9u\nTG9nKCk7CiAgICAgICAgICAgIFN0cmluZyB1cmwgPSBnZXRDb25uZWN0aW9u\nSW5mbyhjb25mKTsKICAgICAgICAgICAgaWYgKGxvZy5pc0luZm9FbmFibGVk\nKCkpCiAgICAgICAgICAgICAgICBsb2cuaW5mbyhfbG9jLmdldCgic2xpY2Ut\nY29ubmVjdCIsIHNsaWNlLCB1cmwpKTsKICAgICAgICAgICAgdHJ5IHsKICAg\nICAgICAgICAgICAgIERhdGFTb3VyY2UgZHMgPSBEYXRhU291cmNlRmFjdG9y\neS5uZXdEYXRhU291cmNlKGNvbmYsIGZhbHNlKTsKICAgICAgICAgICAgICAg\nIERlY29yYXRpbmdEYXRhU291cmNlIGRkcyA9IG5ldyBEZWNvcmF0aW5nRGF0\nYVNvdXJjZShkcyk7CiAgICAgICAgICAgICAgICBkcyA9IERhdGFTb3VyY2VG\nYWN0b3J5Lmluc3RhbGxEQkRpY3Rpb25hcnkoCiAgICAgICAgICAgICAgICAg\nICAgICAgIGNvbmYuZ2V0REJEaWN0aW9uYXJ5SW5zdGFuY2UoKSwgZGRzLCBj\nb25mLCBmYWxzZSk7CiAgICAgICAgICAgICAgICBpZiAodmVyaWZ5RGF0YVNv\ndXJjZShzbGljZSwgZHMpKSB7CiAgICAgICAgICAgICAgICAgICAgZGF0YVNv\ndXJjZXMuYWRkKGRzKTsKICAgICAgICAgICAgICAgICAgICBpc1hBICY9IGlz\nWEFDb21wbGlhbnQoZHMpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAg\nICB9IGNhdGNoIChUaHJvd2FibGUgZXgpIHsKICAgICAgICAgICAgICAgIGhh\nbmRsZUJhZENvbm5lY3Rpb24oaXNMZW5pZW50LCBzbGljZSwgZXgpOwogICAg\nICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGlmIChkYXRhU291cmNlcy5p\nc0VtcHR5KCkpCiAgICAgICAgICAgIHRocm93IG5ldyBVc2VyRXhjZXB0aW9u\nKF9sb2MuZ2V0KCJuby1zbGljZSIpKTsKICAgICAgICBEaXN0cmlidXRlZERh\ndGFTb3VyY2UgcmVzdWx0ID0gbmV3IERpc3RyaWJ1dGVkRGF0YVNvdXJjZShk\nYXRhU291cmNlcyk7CiAgICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0KCiAg\nICBTdHJpbmcgZ2V0Q29ubmVjdGlvbkluZm8oT3BlbkpQQUNvbmZpZ3VyYXRp\nb24gY29uZikgewogICAgICAgIFN0cmluZyByZXN1bHQgPSBjb25mLmdldENv\nbm5lY3Rpb25VUkwoKTsKICAgICAgICBpZiAocmVzdWx0ID09IG51bGwpIHsK\nICAgICAgICAgICAgcmVzdWx0ID0gY29uZi5nZXRDb25uZWN0aW9uRHJpdmVy\nTmFtZSgpOwogICAgICAgICAgICBTdHJpbmcgcHJvcHMgPSBjb25mLmdldENv\nbm5lY3Rpb25Qcm9wZXJ0aWVzKCk7CiAgICAgICAgICAgIGlmIChwcm9wcyAh\nPSBudWxsKQogICAgICAgICAgICAgICAgcmVzdWx0ICs9ICIoIiArIHByb3Bz\nICsgIikiOwogICAgICAgIH0KICAgICAgICByZXR1cm4gcmVzdWx0OwogICAg\nfQoKICAgIGJvb2xlYW4gaXNYQUNvbXBsaWFudChEYXRhU291cmNlIGRzKSB7\nCiAgICAgICAgaWYgKGRzIGluc3RhbmNlb2YgRGVsZWdhdGluZ0RhdGFTb3Vy\nY2UpCiAgICAgICAgICAgIHJldHVybiAoKERlbGVnYXRpbmdEYXRhU291cmNl\nKSBkcykuZ2V0SW5uZXJtb3N0RGVsZWdhdGUoKSAKICAgICAgICAgICAgICAg\naW5zdGFuY2VvZiBYQURhdGFTb3VyY2U7CiAgICAgICAgcmV0dXJuIGRzIGlu\nc3RhbmNlb2YgWEFEYXRhU291cmNlOwogICAgfQoKICAgIC8qKgogICAgICog\nVmVyaWZ5IHRoYXQgYSBjb25uZWN0aW9uIGNhbiBiZSBlc3RhYmxpc2hlZCB0\nbyB0aGUgZ2l2ZW4gc2xpY2UuIElmCiAgICAgKiBjb25uZWN0aW9uIGNhbiBu\nb3QgYmUgZXN0YWJsaXNoZWQgdGhlbiBzbGljZSBpcyBzZXQgdG8gSU5BQ1RJ\nVkUgc3RhdGUuCiAgICAgKi8KICAgIHByaXZhdGUgYm9vbGVhbiB2ZXJpZnlE\nYXRhU291cmNlKFNsaWNlIHNsaWNlLCBEYXRhU291cmNlIGRzKSB7CiAgICAg\nICAgQ29ubmVjdGlvbiBjb24gPSBudWxsOwogICAgICAgIHRyeSB7CiAgICAg\nICAgICAgIGNvbiA9IGRzLmdldENvbm5lY3Rpb24oKTsKICAgICAgICAgICAg\nc2xpY2Uuc2V0U3RhdHVzKFNsaWNlLlN0YXR1cy5BQ1RJVkUpOwogICAgICAg\nICAgICBpZiAoY29uID09IG51bGwpIHsKICAgICAgICAgICAgICAgIHNsaWNl\nLnNldFN0YXR1cyhTbGljZS5TdGF0dXMuSU5BQ1RJVkUpOwogICAgICAgICAg\nICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICB9CiAgICAgICAgICAg\nIHJldHVybiB0cnVlOwogICAgICAgIH0gY2F0Y2ggKFNRTEV4Y2VwdGlvbiBl\neCkgewogICAgICAgICAgICBzbGljZS5zZXRTdGF0dXMoU2xpY2UuU3RhdHVz\nLklOQUNUSVZFKTsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAg\nIH0gZmluYWxseSB7CiAgICAgICAgICAgIGlmIChjb24gIT0gbnVsbCkKICAg\nICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgY29uLmNs\nb3NlKCk7CiAgICAgICAgICAgICAgICB9IGNhdGNoIChTUUxFeGNlcHRpb24g\nZXgpIHsKICAgICAgICAgICAgICAgICAgICAvLyBpZ25vcmUKICAgICAgICAg\nICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBFaXRo\nZXIgdGhyb3cgYSB1c2VyIGV4Y2VwdGlvbiBvciBhZGQgdGhlIGNvbmZpZ3Vy\nYXRpb24gdG8gdGhlIGdpdmVuIGxpc3QsCiAgICAgKiBiYXNlZCBvbiA8Y29k\nZT5pc0xlbmllbnQ8L2NvZGU+LgogICAgICovCiAgICBwcml2YXRlIHZvaWQg\naGFuZGxlQmFkQ29ubmVjdGlvbihib29sZWFuIGlzTGVuaWVudCwgU2xpY2Ug\nc2xpY2UsCiAgICAgICAgICAgIFRocm93YWJsZSBleCkgewogICAgICAgIE9w\nZW5KUEFDb25maWd1cmF0aW9uIGNvbmYgPSBzbGljZS5nZXRDb25maWd1cmF0\naW9uKCk7CiAgICAgICAgU3RyaW5nIHVybCA9IGNvbmYuZ2V0Q29ubmVjdGlv\nblVSTCgpOwogICAgICAgIExvZyBsb2cgPSBnZXRMb2coTE9HX1JVTlRJTUUp\nOwogICAgICAgIGlmIChpc0xlbmllbnQpIHsKICAgICAgICAgICAgaWYgKGV4\nICE9IG51bGwpIHsKICAgICAgICAgICAgICAgIGxvZy53YXJuKF9sb2MuZ2V0\nKCJzbGljZS1jb25uZWN0LWtub3duLXdhcm4iLCBzbGljZSwgdXJsLCBleAog\nICAgICAgICAgICAgICAgICAgICAgICAuZ2V0Q2F1c2UoKSkpOwogICAgICAg\nICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgbG9nLndhcm4oX2xvYy5n\nZXQoInNsaWNlLWNvbm5lY3Qtd2FybiIsIHNsaWNlLCB1cmwpKTsKICAgICAg\nICAgICAgfQogICAgICAgIH0gZWxzZSBpZiAoZXggIT0gbnVsbCkgewogICAg\nICAgICAgICB0aHJvdyBuZXcgVXNlckV4Y2VwdGlvbihfbG9jLmdldCgic2xp\nY2UtY29ubmVjdC1rbm93bi1lcnJvciIsCiAgICAgICAgICAgICAgICAgICAg\nc2xpY2UsIHVybCwgZXgpLCBleC5nZXRDYXVzZSgpKTsKICAgICAgICB9IGVs\nc2UgewogICAgICAgICAgICB0aHJvdyBuZXcgVXNlckV4Y2VwdGlvbihfbG9j\nLmdldCgic2xpY2UtY29ubmVjdC1lcnJvciIsIHNsaWNlLCB1cmwpKTsKICAg\nICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBDcmVhdGUgaW5kaXZpZHVh\nbCBzbGljZXMgd2l0aCBjb25maWd1cmF0aW9ucyBmcm9tIHRoZSBnaXZlbiBw\ncm9wZXJ0aWVzLgogICAgICovCiAgICB2b2lkIHNldFNsaWNlcyhNYXAgb3Jp\nZ2luYWwpIHsKICAgICAgICBMaXN0PFN0cmluZz4gc2xpY2VOYW1lcyA9IGZp\nbmRTbGljZXMob3JpZ2luYWwpOwogICAgICAgIExvZyBsb2cgPSBnZXRDb25m\naWd1cmF0aW9uTG9nKCk7CiAgICAgICAgaWYgKHNsaWNlTmFtZXMuaXNFbXB0\neSgpKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBVc2VyRXhjZXB0aW9uKF9s\nb2MuZ2V0KCJzbGljZS1ub25lLWNvbmZpZ3VyZWQiKSk7CiAgICAgICAgfSAK\nICAgICAgICBTdHJpbmcgdW5pdCA9IGdldFBlcnNpc3RlbmNlVW5pdE5hbWUo\nb3JpZ2luYWwpOwogICAgICAgIGZvciAoU3RyaW5nIGtleSA6IHNsaWNlTmFt\nZXMpIHsKICAgICAgICAgICAgSkRCQ0NvbmZpZ3VyYXRpb24gY2hpbGQgPSBu\nZXcgSkRCQ0NvbmZpZ3VyYXRpb25JbXBsKCk7CiAgICAgICAgICAgIGNoaWxk\nLmZyb21Qcm9wZXJ0aWVzKGNyZWF0ZVNsaWNlUHJvcGVydGllcyhvcmlnaW5h\nbCwga2V5KSk7CiAgICAgICAgICAgIGNoaWxkLnNldElkKHVuaXQrRE9UK2tl\neSk7CiAgICAgICAgICAgIFNsaWNlIHNsaWNlID0gbmV3IFNsaWNlKGtleSwg\nY2hpbGQpOwogICAgICAgICAgICBfc2xpY2VzLmFkZChzbGljZSk7CiAgICAg\nICAgICAgIGlmIChsb2cuaXNUcmFjZUVuYWJsZWQoKSkKICAgICAgICAgICAg\nICAgIGxvZy50cmFjZShfbG9jLmdldCgic2xpY2UtY29uZmlndXJhdGlvbiIs\nIGtleSwgY2hpbGQKICAgICAgICAgICAgICAgICAgICAgICAgLnRvUHJvcGVy\ndGllcyhmYWxzZSkpKTsKICAgICAgICB9CiAgICAgICAgc2V0TWFzdGVyKG9y\naWdpbmFsKTsKICAgIH0KCiAgICAvKioKICAgICAqIEZpbmRzIHRoZSBzbGlj\nZXMuIElmIDxjb2RlPm9wZW5qcGEuc2xpY2UuTmFtZXM8L2NvZGU+IHByb3Bl\ncnR5IGlzIAogICAgICogc3BlY2lmaWVkIHRoZW4gdGhlIHNsaWNlcyBhcmUg\nb3JkZXJlZCBpbiB0aGUgd2F5IHRoZXkgYXJlIGxpc3RlZC4gCiAgICAgKiBP\ndGhlcndpc2Ugc2NhbnMgYWxsIGF2YWlsYWJsZSBzbGljZXMgYnkgbG9va2lu\nZyBmb3IgcHJvcGVydHkgb2YgdGhlIGZvcm0KICAgICAqIDxjb2RlPm9wZW5q\ncGEuc2xpY2UuWFlaLmFiYzwvY29kZT4gd2hlcmUgPGNvZGU+WFlaPC9jb2Rl\nPiBpcyB0aGUgc2xpY2UKICAgICAqIGlkZW50aWZpZXIgYW5kIDxjb2RlPmFi\nYzwvY29kZT4gaXMgYW55IG9wZW5qcGEgcHJvcGVydHkgbmFtZS4gVGhlIHNs\naWNlcwogICAgICogYXJlIHRoZW4gb3JkZXJlZCBhbHBoYWJldGljYWxseSBi\neSB0aGVpciBpZGVudGlmaWVyLgogICAgICovCiAgICBwcml2YXRlIExpc3Q8\nU3RyaW5nPiBmaW5kU2xpY2VzKE1hcCBwKSB7CiAgICAgICAgTGlzdDxTdHJp\nbmc+IHNsaWNlTmFtZXMgPSBuZXcgQXJyYXlMaXN0PFN0cmluZz4oKTsKICAg\nICAgICAKICAgICAgICBMb2cgbG9nID0gZ2V0Q29uZmlndXJhdGlvbkxvZygp\nOwogICAgICAgIFN0cmluZyBrZXkgPSBQUkVGSVhfU0xJQ0UgKyBuYW1lc1Bs\ndWdpbi5nZXRQcm9wZXJ0eSgpOwogICAgICAgIGJvb2xlYW4gZXhwbGljaXQg\nPSBwLmNvbnRhaW5zS2V5KGtleSk7CiAgICAgICAgaWYgKGV4cGxpY2l0KSB7\nCiAgICAgICAgICAgIFN0cmluZ1tdIHZhbHVlcyA9IHAuZ2V0KGtleSkudG9T\ndHJpbmcoKS5zcGxpdCgiXFwsIik7CiAgICAgICAgICAgIGZvciAoU3RyaW5n\nIG5hbWU6dmFsdWVzKQogICAgICAgICAgICAgICAgaWYgKCFzbGljZU5hbWVz\nLmNvbnRhaW5zKG5hbWUudHJpbSgpKSkKICAgICAgICAgICAgICAgICAgICBz\nbGljZU5hbWVzLmFkZChuYW1lLnRyaW0oKSk7CiAgICAgICAgfSBlbHNlIHsK\nICAgICAgICAgICAgaWYgKGxvZy5pc1dhcm5FbmFibGVkKCkpCiAgICAgICAg\nICAgICAgICBsb2cud2FybihfbG9jLmdldCgibm8tc2xpY2UtbmFtZXMiLCBr\nZXkpKTsKICAgICAgICAgICAgc2xpY2VOYW1lcyA9IHNjYW5Gb3JTbGljZU5h\nbWVzKHApOwogICAgICAgICAgICBDb2xsZWN0aW9ucy5zb3J0KHNsaWNlTmFt\nZXMpOwogICAgICAgIH0KICAgICAgICBpZiAobG9nLmlzSW5mb0VuYWJsZWQo\nKSkgewogICAgICAgICAgICBsb2cuaW5mbyhfbG9jLmdldCgic2xpY2UtYXZh\naWxhYmxlIiwgc2xpY2VOYW1lcykpOwogICAgICAgIH0KICAgICAgICByZXR1\ncm4gc2xpY2VOYW1lczsKICAgIH0KICAgIAogICAgLyoqCiAgICAgKiBTY2Fu\nIHRoZSBnaXZlbiBtYXAgZm9yIHNsaWNlLXNwZWNpZmljIHByb3BlcnR5IG9m\nIHRoZSBmb3JtIAogICAgICogPGNvZGU+b3BlbmpwYS5zbGljZS5YWVouYWJj\nPC9jb2RlPiAod2hpbGUgaWdub3JpbmcgCiAgICAgKiA8Y29kZT5vcGVuanBh\nLnNsaWNlLlhZWjwvY29kZT4gYXMgdGhleSByZWZlciB0byBzbGljZS13aWRl\nIHByb3BlcnR5KQogICAgICogdG8gZGV0ZXJtaW5lIHRoZSBuYW1lcyBvZiBh\nbGwgYXZhaWxhYmxlIHNsaWNlcy4KICAgICAqLwogICAgcHJpdmF0ZSBMaXN0\nPFN0cmluZz4gc2NhbkZvclNsaWNlTmFtZXMoTWFwIHApIHsKICAgICAgICBM\naXN0PFN0cmluZz4gc2xpY2VOYW1lcyA9IG5ldyBBcnJheUxpc3Q8U3RyaW5n\nPigpOwogICAgICAgIGZvciAoT2JqZWN0IG8gOiBwLmtleVNldCgpKSB7CiAg\nICAgICAgICAgIFN0cmluZyBrZXkgPSBvLnRvU3RyaW5nKCk7CiAgICAgICAg\nICAgIGlmIChrZXkuc3RhcnRzV2l0aChQUkVGSVhfU0xJQ0UpICYmIGdldFBh\ncnRDb3VudChrZXkpID4gMykgewogICAgICAgICAgICAgICAgU3RyaW5nIHNs\naWNlTmFtZSA9CiAgICAgICAgICAgICAgICAgICAgY2hvcFRhaWwoY2hvcEhl\nYWQoby50b1N0cmluZygpLCBQUkVGSVhfU0xJQ0UpLCBET1QpOwogICAgICAg\nICAgICAgICAgaWYgKCFzbGljZU5hbWVzLmNvbnRhaW5zKHNsaWNlTmFtZSkp\nCiAgICAgICAgICAgICAgICAgICAgc2xpY2VOYW1lcy5hZGQoc2xpY2VOYW1l\nKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4gc2xp\nY2VOYW1lczsKICAgIH0KCiAgICBwcml2YXRlIHN0YXRpYyBpbnQgZ2V0UGFy\ndENvdW50KFN0cmluZyBzKSB7CiAgICAgICAgcmV0dXJuIChzID09IG51bGwp\nID8gMCA6IHMuc3BsaXQoUkVHRVhfRE9UKS5sZW5ndGg7CiAgICB9CiAgICAK\nICAgIHByaXZhdGUgc3RhdGljIFN0cmluZyBjaG9wSGVhZChTdHJpbmcgcywg\nU3RyaW5nIGhlYWQpIHsKICAgICAgICBpZiAocy5zdGFydHNXaXRoKGhlYWQp\nKQogICAgICAgICAgICByZXR1cm4gcy5zdWJzdHJpbmcoaGVhZC5sZW5ndGgo\nKSk7CiAgICAgICAgcmV0dXJuIHM7CiAgICB9CgogICAgcHJpdmF0ZSBzdGF0\naWMgU3RyaW5nIGNob3BUYWlsKFN0cmluZyBzLCBTdHJpbmcgdGFpbCkgewog\nICAgICAgIGludCBpID0gcy5sYXN0SW5kZXhPZih0YWlsKTsKICAgICAgICBp\nZiAoaSA9PSAtMSkKICAgICAgICAgICAgcmV0dXJuIHM7CiAgICAgICAgcmV0\ndXJuIHMuc3Vic3RyaW5nKDAsIGkpOwogICAgfQoKICAgIC8qKgogICAgICog\nQ3JlYXRlcyBnaXZlbiA8Y29kZT5zbGljZTwvY29kZT4gc3BlY2lmaWMgY29u\nZmlndXJhdGlvbiBwcm9wZXJ0aWVzIGZyb20KICAgICAqIGdpdmVuIDxjb2Rl\nPm9yaWdpbmFsPC9jb2RlPiBrZXktdmFsdWUgbWFwLiBUaGUgcnVsZXMgYXJl\nCiAgICAgKiA8TEk+IGlmIGtleSBiZWdpbnMgd2l0aCA8Y29kZT4ic2xpY2Uu\nWFhYLiI8L2NvZGU+IHdoZXJlCiAgICAgKiA8Y29kZT5YWFg8L2NvZGU+IGlz\nIHRoZSBnaXZlbiBzbGljZSBuYW1lLCB0aGVuIHJlcGxhY2UKICAgICAqIDxj\nb2RlPiJzbGljZS5YWFguPC9jb2RlPiB3aXRoIDxjb2RlPm9wZW5qcGEuPC9j\nb2RlPi4KICAgICAqIDxMST5pZiBrZXkgYmVnaW5zIHdpdGggPGNvZGU+InNs\naWNlLiI8L2NvZGU+IGJ1dCBub3Qgd2l0aAogICAgICogPGNvZGU+InNsaWNl\nLlhYWC4iPC9jb2RlPiwgdGhlIGlnbm9yZSBpLmUuIGFueSBwcm9wZXJ0eSBv\nZiBvdGhlcgogICAgICogc2xpY2VzIG9yIGdsb2JhbCBzbGljZSBwcm9wZXJ0\neSBlLmcuCiAgICAgKiA8Y29kZT5zbGljZS5EaXN0cmlidXRpb25Qb2xpY3k8\nL2NvZGU+CiAgICAgKiA8Y29kZT5pZiBrZXkgc3RhcnRzIHdpdGggPGNvZGU+\nIm9wZW5qcGEuIjwvY29kZT4gYW5kIGEgY29ycmVzcG9uZGluZwogICAgICog\nPGNvZGU+InNsaWNlLlhYWC4iPC9jb2RlPiBwcm9wZXJ0eSBkb2VzIG5vdCBl\neGlzdCwgdGhlbiB1c2UgdGhpcyBhcwogICAgICogZGVmYXVsdCBwcm9wZXJ0\neQogICAgICogPGNvZGU+cHJvcGVydHkgd2l0aCBhbnkgb3RoZXIgcHJlZml4\nIGlzIHNpbXBseSBjb3BpZWQKICAgICAqCiAgICAgKi8KICAgIE1hcCBjcmVh\ndGVTbGljZVByb3BlcnRpZXMoTWFwIG9yaWdpbmFsLCBTdHJpbmcgc2xpY2Up\nIHsKICAgICAgICBNYXAgcmVzdWx0ID0gbmV3IFByb3BlcnRpZXMoKTsKICAg\nICAgICBTdHJpbmcgcHJlZml4ID0gUFJFRklYX1NMSUNFICsgc2xpY2UgKyBE\nT1Q7CiAgICAgICAgZm9yIChPYmplY3QgbyA6IG9yaWdpbmFsLmtleVNldCgp\nKSB7CiAgICAgICAgICAgIFN0cmluZyBrZXkgPSBvLnRvU3RyaW5nKCk7CiAg\nICAgICAgICAgIGlmIChrZXkuc3RhcnRzV2l0aChwcmVmaXgpKSB7CiAgICAg\nICAgICAgICAgICBTdHJpbmcgbmV3S2V5ID0gUFJFRklYX09QRU5KUEEgKyBr\nZXkuc3Vic3RyaW5nKHByZWZpeC5sZW5ndGgoKSk7CiAgICAgICAgICAgICAg\nICByZXN1bHQucHV0KG5ld0tleSwgb3JpZ2luYWwuZ2V0KG8pKTsKICAgICAg\nICAgICAgfSBlbHNlIGlmIChrZXkuc3RhcnRzV2l0aChQUkVGSVhfU0xJQ0Up\nKSB7CiAgICAgICAgICAgICAgICAvLyBpZ25vcmUga2V5cyB0aGF0IGFyZSBp\nbiAnc2xpY2UuJyBuYW1lc3BhY2UgYnV0IG5vdCB0aGlzIHNsaWNlCiAgICAg\nICAgICAgIH0gZWxzZSBpZiAoa2V5LnN0YXJ0c1dpdGgoUFJFRklYX09QRU5K\nUEEpKSB7CiAgICAgICAgICAgICAgICBTdHJpbmcgbmV3S2V5ID0gcHJlZml4\nICsga2V5LnN1YnN0cmluZyhQUkVGSVhfT1BFTkpQQS5sZW5ndGgoKSk7CiAg\nICAgICAgICAgICAgICBpZiAoIW9yaWdpbmFsLmNvbnRhaW5zS2V5KG5ld0tl\neSkpCiAgICAgICAgICAgICAgICAgICAgcmVzdWx0LnB1dChrZXksIG9yaWdp\nbmFsLmdldChvKSk7CiAgICAgICAgICAgIH0gZWxzZSB7IC8vIGtleXMgdGhh\ndCBhcmUgbmVpdGhlciAib3BlbmpwYSIgbm9yICJzbGljZSIgbmFtZXNwYWNl\nCiAgICAgICAgICAgICAgICByZXN1bHQucHV0KGtleSwgb3JpZ2luYWwuZ2V0\nKG8pKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4g\ncmVzdWx0OwogICAgfQoKICAgIC8qKgogICAgICogRGV0ZXJtaW5lIHRoZSBt\nYXN0ZXIgc2xpY2UuCiAgICAgKi8KICAgIHByaXZhdGUgdm9pZCBzZXRNYXN0\nZXIoTWFwIG9yaWdpbmFsKSB7CiAgICAgICAgU3RyaW5nIGtleSA9IFBSRUZJ\nWF9TTElDRSArIG1hc3RlclBsdWdpbi5nZXRQcm9wZXJ0eSgpOwogICAgICAg\nIE9iamVjdCBtYXN0ZXJTbGljZSA9IG9yaWdpbmFsLmdldChrZXkpOwogICAg\nICAgIExvZyBsb2cgPSBnZXRDb25maWd1cmF0aW9uTG9nKCk7CiAgICAgICAg\nTGlzdDxTbGljZT4gYWN0aXZlU2xpY2VzID0gZ2V0U2xpY2VzKG51bGwpOwog\nICAgICAgIGlmIChtYXN0ZXJTbGljZSA9PSBudWxsKSB7CiAgICAgICAgICAg\nIF9tYXN0ZXIgPSBhY3RpdmVTbGljZXMuZ2V0KDApOwogICAgICAgICAgICBp\nZiAobG9nLmlzV2FybkVuYWJsZWQoKSkKICAgICAgICAgICAgICAgIGxvZy53\nYXJuKF9sb2MuZ2V0KCJuby1tYXN0ZXItc2xpY2UiLCBrZXksIF9tYXN0ZXIp\nKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICBmb3Ig\nKFNsaWNlIHNsaWNlOmFjdGl2ZVNsaWNlcykKICAgICAgICAgICAgaWYgKHNs\naWNlLmdldE5hbWUoKS5lcXVhbHMobWFzdGVyU2xpY2UpKQogICAgICAgICAg\nICAgICAgX21hc3RlciA9IHNsaWNlOwogICAgICAgIGlmIChfbWFzdGVyID09\nIG51bGwpIHsKICAgICAgICAgICAgX21hc3RlciA9IGFjdGl2ZVNsaWNlcy5n\nZXQoMCk7CiAgICAgICAgfQogICAgfQogICAgCiAgICBwdWJsaWMgU3RyaW5n\nIGdldEV4ZWN1dG9yU2VydmljZSgpIHsKICAgICAgICByZXR1cm4gZXhlY3V0\nb3JTZXJ2aWNlUGx1Z2luLmdldFN0cmluZygpOwogICAgfQoKICAgIHB1Ymxp\nYyB2b2lkIHNldEV4ZWN1dG9yU2VydmljZShFeGVjdXRvclNlcnZpY2UgdHhu\nTWFuYWdlcikgewogICAgICAgIGV4ZWN1dG9yU2VydmljZVBsdWdpbi5zZXQo\ndHhuTWFuYWdlcik7CiAgICB9CgogICAgcHVibGljIEV4ZWN1dG9yU2Vydmlj\nZSBnZXRFeGVjdXRvclNlcnZpY2VJbnN0YW5jZSgpIHsKICAgICAgICBpZiAo\nZXhlY3V0b3JTZXJ2aWNlUGx1Z2luLmdldCgpID09IG51bGwpIHsKICAgICAg\nICAgICAgZXhlY3V0b3JTZXJ2aWNlUGx1Z2luLmluc3RhbnRpYXRlKEV4ZWN1\ndG9yU2VydmljZS5jbGFzcywgdGhpcyk7CiAgICAgICAgfQogICAgICAgIHJl\ndHVybiAoRXhlY3V0b3JTZXJ2aWNlKSBleGVjdXRvclNlcnZpY2VQbHVnaW4u\nZ2V0KCk7CiAgICB9ICAgIAp9Cg==\n","encoding":"base64"}

