{"sha":"681470949f119bf59357c8a12290553f6a536f21","node_id":"MDQ6QmxvYjIwNjM2NDo2ODE0NzA5NDlmMTE5YmY1OTM1N2M4YTEyMjkwNTUzZjZhNTM2ZjIx","size":5256,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/681470949f119bf59357c8a12290553f6a536f21","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuc2xpY2UuamRiYzsKCmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLlN0b3JlUXVlcnk7CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLmV4cHMuUXVlcnlFeHByZXNz\naW9uczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuZXhwcy5W\nYWx1ZTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIucm9wLlJlc3Vs\ndE9iamVjdFByb3ZpZGVyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxp\nYi51dGlsLkxvY2FsaXplcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51\ndGlsLkludGVybmFsRXhjZXB0aW9uOwoKLyoqCiAqIEFnZ3JlZ2F0ZXMgaW5k\naXZpZHVhbCBzaW5nbGUgcXVlcnkgcmVzdWx0cyBmcm9tIGRpZmZlcmVudCBk\nYXRhYmFzZXMuCiAqIAogKiBAYXV0aG9yIFBpbmFraSBQb2RkYXIgCiAqCiAq\nLwpwdWJsaWMgY2xhc3MgVW5pcXVlUmVzdWx0T2JqZWN0UHJvdmlkZXIgaW1w\nbGVtZW50cyBSZXN1bHRPYmplY3RQcm92aWRlciB7CiAgICBwcml2YXRlIGZp\nbmFsIFJlc3VsdE9iamVjdFByb3ZpZGVyW10gX3JvcHM7CiAgICBwcml2YXRl\nIGZpbmFsIFN0b3JlUXVlcnkgX3F1ZXJ5OwogICAgcHJpdmF0ZSBmaW5hbCBR\ndWVyeUV4cHJlc3Npb25zW10gX2V4cHM7CiAgICBwcml2YXRlIE9iamVjdCBf\nc2luZ2xlOwogICAgcHJpdmF0ZSBib29sZWFuIF9vcGVuZWQ7CiAgICAKICAg\nIHByaXZhdGUgc3RhdGljIGZpbmFsIFN0cmluZyBDT1VOVCA9ICJDb3VudCI7\nCiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBTdHJpbmcgTUFYICAgPSAiTWF4\nIjsKICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIFN0cmluZyBNSU4gICA9ICJN\naW4iOwogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgU3RyaW5nIFNVTSAgID0g\nIlN1bSI7CiAgICAKICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIExvY2FsaXpl\nciBfbG9jID0KICAgICAgICBMb2NhbGl6ZXIuZm9yUGFja2FnZShVbmlxdWVS\nZXN1bHRPYmplY3RQcm92aWRlci5jbGFzcyk7CiAgICAKICAgIHB1YmxpYyBV\nbmlxdWVSZXN1bHRPYmplY3RQcm92aWRlcihSZXN1bHRPYmplY3RQcm92aWRl\ncltdIHJvcHMsIAogICAgICAgICAgICBTdG9yZVF1ZXJ5IHEsIFF1ZXJ5RXhw\ncmVzc2lvbnNbXSBleHBzKSB7CiAgICAgICAgX3JvcHMgPSByb3BzOwogICAg\nICAgIF9xdWVyeSA9IHE7CiAgICAgICAgX2V4cHMgPSBleHBzOwogICAgfQog\nICAgCiAgICBwdWJsaWMgYm9vbGVhbiBhYnNvbHV0ZShpbnQgcG9zKSB0aHJv\nd3MgRXhjZXB0aW9uIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICB9Cgog\nICAgcHVibGljIHZvaWQgY2xvc2UoKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAg\nICAgICBfb3BlbmVkID0gZmFsc2U7CiAgICAgICAgZm9yIChSZXN1bHRPYmpl\nY3RQcm92aWRlciByb3A6X3JvcHMpCiAgICAgICAgICAgIHJvcC5jbG9zZSgp\nOwogICAgfQoKICAgIHB1YmxpYyBPYmplY3QgZ2V0UmVzdWx0T2JqZWN0KCkg\ndGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgaWYgKCFfb3BlbmVkKQogICAg\nICAgICAgICB0aHJvdyBuZXcgSW50ZXJuYWxFeGNlcHRpb24oX2xvYy5nZXQo\nIm5vdC1vcGVuIikpOwogICAgICAgIHJldHVybiBfc2luZ2xlOwogICAgfQoK\nICAgIHB1YmxpYyB2b2lkIGhhbmRsZUNoZWNrZWRFeGNlcHRpb24oRXhjZXB0\naW9uIGUpIHsKICAgICAgICBfcm9wc1swXS5oYW5kbGVDaGVja2VkRXhjZXB0\naW9uKGUpOwogICAgfQoKICAgIHB1YmxpYyBib29sZWFuIG5leHQoKSB0aHJv\nd3MgRXhjZXB0aW9uIHsKICAgICAgICBpZiAoIV9vcGVuZWQpIHsKICAgICAg\nICAgICAgb3BlbigpOwogICAgICAgIH0KICAgICAgICAgICAgCiAgICAgICAg\naWYgKF9zaW5nbGUgIT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIGZhbHNl\nOwogICAgICAgIAogICAgICAgIFZhbHVlW10gdmFsdWVzID0gX2V4cHNbMF0u\ncHJvamVjdGlvbnM7CiAgICAgICAgT2JqZWN0W10gc2luZ2xlID0gbmV3IE9i\namVjdFt2YWx1ZXMubGVuZ3RoXTsgCiAgICAgICAgZm9yIChpbnQgaT0wOyBp\nPHZhbHVlcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBWYWx1ZSB2ID0g\ndmFsdWVzW2ldOwogICAgICAgICAgICBib29sZWFuIGlzQWdncmVnYXRlID0g\ndi5pc0FnZ3JlZ2F0ZSgpOwogICAgICAgICAgICBTdHJpbmcgb3AgPSB2Lmdl\ndENsYXNzKCkuZ2V0U2ltcGxlTmFtZSgpOwogICAgICAgICAgICBmb3IgKFJl\nc3VsdE9iamVjdFByb3ZpZGVyIHJvcDpfcm9wcykgewogICAgICAgICAgICAg\nICAgcm9wLm5leHQoKTsKICAgICAgICAgICAgICAgIE9iamVjdFtdIHJvdyA9\nIChPYmplY3RbXSkgcm9wLmdldFJlc3VsdE9iamVjdCgpOwogICAgICAgICAg\nICAgICAgaWYgKGlzQWdncmVnYXRlKSB7CiAgICAgICAgICAgICAgICAgICAg\naWYgKENPVU5ULmVxdWFscyhvcCkpIHsKICAgICAgICAgICAgICAgICAgICAg\nICAgc2luZ2xlW2ldID0gY291bnQoc2luZ2xlW2ldLCByb3dbaV0pOwogICAg\nICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoTUFYLmVxdWFscyhvcCkpIHsK\nICAgICAgICAgICAgICAgICAgICAgICAgc2luZ2xlW2ldID0gbWF4KHNpbmds\nZVtpXSwgcm93W2ldKTsKICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYg\nKE1JTi5lcXVhbHMob3ApKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHNp\nbmdsZVtpXSA9IG1pbihzaW5nbGVbaV0sIHJvd1tpXSk7CiAgICAgICAgICAg\nICAgICAgICAgfSBlbHNlIGlmIChTVU0uZXF1YWxzKG9wKSkgewogICAgICAg\nICAgICAgICAgICAgICAgICBzaW5nbGVbaV0gPSBzdW0oc2luZ2xlW2ldLCBy\nb3dbaV0pOwogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAg\nICAgICAgICAgICAgICAgIHRocm93IG5ldyBVbnN1cHBvcnRlZE9wZXJhdGlv\nbkV4Y2VwdGlvbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgKF9sb2Mu\nZ2V0KCJhZ2dyZWdhdGUtdW5zdXBwb3J0ZWQiLCBvcCkudG9TdHJpbmcoKSk7\nCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSBlbHNl\nIHsKICAgICAgICAgICAgICAgICAgICBzaW5nbGVbaV0gPSByb3dbaV07CiAg\nICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAg\nICAgX3NpbmdsZSA9IHNpbmdsZTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAg\nIH0KICAgIAogICAgT2JqZWN0IGNvdW50KE9iamVjdCBjdXJyZW50LCBPYmpl\nY3Qgb3RoZXIpIHsKICAgICAgICBpZiAoY3VycmVudCA9PSBudWxsKQogICAg\nICAgICAgICByZXR1cm4gb3RoZXI7CiAgICAgICAgcmV0dXJuICgoTnVtYmVy\nKWN1cnJlbnQpLmxvbmdWYWx1ZSgpICsgKChOdW1iZXIpb3RoZXIpLmxvbmdW\nYWx1ZSgpOwogICAgfQogICAgCiAgICBPYmplY3QgbWF4KE9iamVjdCBjdXJy\nZW50LCBPYmplY3Qgb3RoZXIpIHsKICAgICAgICBpZiAoY3VycmVudCA9PSBu\ndWxsKQogICAgICAgICAgICByZXR1cm4gb3RoZXI7CiAgICAgICAgCiAgICAg\nICAgcmV0dXJuIE1hdGgubWF4KCgoTnVtYmVyKWN1cnJlbnQpLmRvdWJsZVZh\nbHVlKCksIAogICAgICAgICAgICAgICAgKChOdW1iZXIpb3RoZXIpLmRvdWJs\nZVZhbHVlKCkpOwogICAgfQogICAgCiAgICBPYmplY3QgbWluKE9iamVjdCBj\ndXJyZW50LCBPYmplY3Qgb3RoZXIpIHsKICAgICAgICBpZiAoY3VycmVudCA9\nPSBudWxsKQogICAgICAgICAgICByZXR1cm4gb3RoZXI7CiAgICAgICAgcmV0\ndXJuIE1hdGgubWluKCgoTnVtYmVyKWN1cnJlbnQpLmRvdWJsZVZhbHVlKCks\nIAogICAgICAgICAgICAgICAgKChOdW1iZXIpb3RoZXIpLmRvdWJsZVZhbHVl\nKCkpOwogICAgfQogICAgCiAgICBPYmplY3Qgc3VtKE9iamVjdCBjdXJyZW50\nLCBPYmplY3Qgb3RoZXIpIHsKICAgICAgICBpZiAoY3VycmVudCA9PSBudWxs\nKQogICAgICAgICAgICByZXR1cm4gb3RoZXI7CiAgICAgICAgcmV0dXJuICgo\nKE51bWJlciljdXJyZW50KS5kb3VibGVWYWx1ZSgpICsKICAgICAgICAgICAg\nICAgICgoTnVtYmVyKW90aGVyKS5kb3VibGVWYWx1ZSgpKTsKICAgIH0KCgoK\nICAgIHB1YmxpYyB2b2lkIG9wZW4oKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAg\nICAgICBmb3IgKFJlc3VsdE9iamVjdFByb3ZpZGVyIHJvcDpfcm9wcykKICAg\nICAgICAgICAgcm9wLm9wZW4oKTsKICAgICAgICBfb3BlbmVkID0gdHJ1ZTsK\nICAgIH0KCiAgICBwdWJsaWMgdm9pZCByZXNldCgpIHRocm93cyBFeGNlcHRp\nb24gewogICAgICAgIF9zaW5nbGUgPSBudWxsOwogICAgICAgIGZvciAoUmVz\ndWx0T2JqZWN0UHJvdmlkZXIgcm9wIDogX3JvcHMpIHsKICAgICAgICAgICAg\ncm9wLnJlc2V0KCk7CiAgICAgICAgfQogICAgfQoKICAgIHB1YmxpYyBpbnQg\nc2l6ZSgpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIHJldHVybiAxOwog\nICAgfQoKICAgIHB1YmxpYyBib29sZWFuIHN1cHBvcnRzUmFuZG9tQWNjZXNz\nKCkgewogICAgICAgICByZXR1cm4gZmFsc2U7CiAgICB9Cn0K\n","encoding":"base64"}

