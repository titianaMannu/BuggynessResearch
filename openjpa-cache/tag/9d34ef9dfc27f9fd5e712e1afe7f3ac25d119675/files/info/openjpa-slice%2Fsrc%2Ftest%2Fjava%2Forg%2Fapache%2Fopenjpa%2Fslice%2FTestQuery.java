{"sha":"7b7c6bf78b691009ac5d88efc949152cd926203c","node_id":"MDQ6QmxvYjIwNjM2NDo3YjdjNmJmNzhiNjkxMDA5YWM1ZDg4ZWZjOTQ5MTUyY2Q5MjYyMDNj","size":4865,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/7b7c6bf78b691009ac5d88efc949152cd926203c","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuc2xpY2U7CgppbXBvcnQgamF2\nYS51dGlsLkFycmF5TGlzdDsKaW1wb3J0IGphdmEudXRpbC5MaXN0OwoKaW1w\nb3J0IGphdmF4LnBlcnNpc3RlbmNlLkVudGl0eU1hbmFnZXI7CmltcG9ydCBq\nYXZheC5wZXJzaXN0ZW5jZS5RdWVyeTsKCi8qKgogKiBUZXN0cyBxdWVyeSBv\ncmRlcmluZy4KICogCiAqIEBhdXRob3IgUGluYWtpIFBvZGRhciAKICoKICov\nCnB1YmxpYyBjbGFzcyBUZXN0UXVlcnkgZXh0ZW5kcyBTbGljZVRlc3RDYXNl\nIHsKICAgIHByaXZhdGUgaW50IFBPQkpFQ1RfQ09VTlQgPSAyNTsKICAgIHBy\naXZhdGUgaW50IFZBTFVFX01JTiA9IDEwMDsKICAgIHByaXZhdGUgaW50IFZB\nTFVFX01BWCA9IFZBTFVFX01JTiArIFBPQkpFQ1RfQ09VTlQgLSAxOwogICAg\nCiAgICBwcm90ZWN0ZWQgU3RyaW5nIGdldFBlcnNpc3RlbmNlVW5pdE5hbWUo\nKSB7CiAgICAgICAgcmV0dXJuICJvcmRlcmluZyI7CiAgICB9CgogICAgcHVi\nbGljIHZvaWQgc2V0VXAoKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBz\ndXBlci5zZXRVcChQT2JqZWN0LmNsYXNzLCBQZXJzb24uY2xhc3MsIEFkZHJl\nc3MuY2xhc3MsIENMRUFSX1RBQkxFUyk7CiAgICAgICAgaW50IGNvdW50ID0g\nY291bnQoUE9iamVjdC5jbGFzcyk7CiAgICAgICAgaWYgKGNvdW50ID09IDAp\nIHsKICAgICAgICAgICAgY3JlYXRlKFBPQkpFQ1RfQ09VTlQpOwogICAgICAg\nIH0KICAgIH0KICAgIAogICAgdm9pZCBjcmVhdGUoaW50IE4pIHsKICAgICAg\nICBFbnRpdHlNYW5hZ2VyIGVtID0gZW1mLmNyZWF0ZUVudGl0eU1hbmFnZXIo\nKTsKICAgICAgICBlbS5nZXRUcmFuc2FjdGlvbigpLmJlZ2luKCk7CiAgICAg\nICAgZm9yIChpbnQgaT0wO2k8UE9CSkVDVF9DT1VOVDtpKyspIHsKICAgICAg\nICAgICAgUE9iamVjdCBwYyA9IG5ldyBQT2JqZWN0KCk7CiAgICAgICAgICAg\nIHBjLnNldFZhbHVlKFZBTFVFX01JTiArIGkpOwogICAgICAgICAgICBlbS5w\nZXJzaXN0KHBjKTsKICAgICAgICAgICAgU3RyaW5nIHNsaWNlID0gU2xpY2VQ\nZXJzaXN0ZW5jZS5nZXRTbGljZShwYyk7CiAgICAgICAgICAgIFN0cmluZyBl\neHBlY3RlZCA9IChwYy5nZXRWYWx1ZSgpJTIgPT0gMCkgPyAiRXZlbiIgOiAi\nT2RkIjsKICAgICAgICAgICAgYXNzZXJ0RXF1YWxzKGV4cGVjdGVkLCBzbGlj\nZSk7CiAgICAgICAgfQogICAgICAgIGVtLmdldFRyYW5zYWN0aW9uKCkuY29t\nbWl0KCk7CiAgICB9CiAgICAKICAgIHB1YmxpYyB2b2lkIHRlc3RRdWVyeVJl\nc3VsdElzT3JkZXJlZEFjcm9zc1NsaWNlKCkgewogICAgICAgIEVudGl0eU1h\nbmFnZXIgZW0gPSBlbWYuY3JlYXRlRW50aXR5TWFuYWdlcigpOwogICAgICAg\nIGVtLmdldFRyYW5zYWN0aW9uKCkuYmVnaW4oKTsKICAgICAgICBRdWVyeSBx\ndWVyeSA9IGVtLmNyZWF0ZVF1ZXJ5KCJTRUxFQ1QgcC52YWx1ZSxwIEZST00g\nUE9iamVjdCBwIE9SREVSIEJZIHAudmFsdWUgQVNDIik7CiAgICAgICAgTGlz\ndCByZXN1bHQgPSBxdWVyeS5nZXRSZXN1bHRMaXN0KCk7CiAgICAgICAgSW50\nZWdlciBvbGQgPSBJbnRlZ2VyLk1JTl9WQUxVRTsKICAgICAgICBmb3IgKE9i\namVjdCByb3cgOiByZXN1bHQpIHsKICAgICAgICAgICAgT2JqZWN0W10gbGlu\nZSA9IChPYmplY3RbXSlyb3c7CiAgICAgICAgICAgIGludCB2YWx1ZSA9ICgo\nSW50ZWdlcilsaW5lWzBdKS5pbnRWYWx1ZSgpOwogICAgICAgICAgICBQT2Jq\nZWN0IHBjID0gKFBPYmplY3QpbGluZVsxXTsKICAgICAgICAgICAgYXNzZXJ0\nVHJ1ZSh2YWx1ZSA+PSBvbGQpOwogICAgICAgICAgICBvbGQgPSB2YWx1ZTsK\nICAgICAgICAgICAgYXNzZXJ0RXF1YWxzKHZhbHVlLCBwYy5nZXRWYWx1ZSgp\nKTsKICAgICAgICB9CiAgICAgICAgZW0uZ2V0VHJhbnNhY3Rpb24oKS5yb2xs\nYmFjaygpOwogICAgfQogICAgCiAgICBwdWJsaWMgdm9pZCB0ZXN0QWdncmVn\nYXRlUXVlcnkoKSB7CiAgICAgICAgRW50aXR5TWFuYWdlciBlbSA9IGVtZi5j\ncmVhdGVFbnRpdHlNYW5hZ2VyKCk7CiAgICAgICAgZW0uZ2V0VHJhbnNhY3Rp\nb24oKS5iZWdpbigpOwogICAgICAgIE9iamVjdCBjb3VudCA9IGVtLmNyZWF0\nZVF1ZXJ5KCJTRUxFQ1QgQ09VTlQocCkgRlJPTSBQT2JqZWN0IHAiKS5nZXRT\naW5nbGVSZXN1bHQoKTsKICAgICAgICBPYmplY3QgbWF4ICAgPSBlbS5jcmVh\ndGVRdWVyeSgiU0VMRUNUIE1BWChwLnZhbHVlKSBGUk9NIFBPYmplY3QgcCIp\nLmdldFNpbmdsZVJlc3VsdCgpOwogICAgICAgIE9iamVjdCBtaW4gICA9IGVt\nLmNyZWF0ZVF1ZXJ5KCJTRUxFQ1QgTUlOKHAudmFsdWUpIEZST00gUE9iamVj\ndCBwIikuZ2V0U2luZ2xlUmVzdWx0KCk7CiAgICAgICAgT2JqZWN0IHN1bSAg\nID0gZW0uY3JlYXRlUXVlcnkoIlNFTEVDVCBTVU0ocC52YWx1ZSkgRlJPTSBQ\nT2JqZWN0IHAiKS5nZXRTaW5nbGVSZXN1bHQoKTsKICAgICAgICBlbS5nZXRU\ncmFuc2FjdGlvbigpLnJvbGxiYWNrKCk7CiAgICAgICAgCiAgICAgICAgYXNz\nZXJ0RXF1YWxzKFBPQkpFQ1RfQ09VTlQsICgoTnVtYmVyKWNvdW50KS5pbnRW\nYWx1ZSgpKTsKICAgICAgICBhc3NlcnRFcXVhbHMoVkFMVUVfTUFYLCAoKE51\nbWJlciltYXgpLmludFZhbHVlKCkpOwogICAgICAgIGFzc2VydEVxdWFscyhW\nQUxVRV9NSU4sICgoTnVtYmVyKW1pbikuaW50VmFsdWUoKSk7CiAgICAgICAg\nYXNzZXJ0RXF1YWxzKChWQUxVRV9NSU4rVkFMVUVfTUFYKSpQT0JKRUNUX0NP\nVU5ULCAyKigoTnVtYmVyKXN1bSkuaW50VmFsdWUoKSk7CiAgICB9CiAgICAK\nICAgIHB1YmxpYyB2b2lkIHRlc3RTZXRNYXhSZXN1bHQoKSB7CiAgICAgICAg\nRW50aXR5TWFuYWdlciBlbSA9IGVtZi5jcmVhdGVFbnRpdHlNYW5hZ2VyKCk7\nCiAgICAgICAgaW50IGxpbWl0ID0gMzsKICAgICAgICBlbS5nZXRUcmFuc2Fj\ndGlvbigpLmJlZ2luKCk7CiAgICAgICAgTGlzdCByZXN1bHQgPSBlbS5jcmVh\ndGVRdWVyeSgiU0VMRUNUIHAudmFsdWUscCBGUk9NIFBPYmplY3QgcCBPUkRF\nUiBCWSBwLnZhbHVlIEFTQyIpCiAgICAgICAgICAgIC5zZXRNYXhSZXN1bHRz\nKGxpbWl0KS5nZXRSZXN1bHRMaXN0KCk7CiAgICAgICAgaW50IGkgPSAwOwog\nICAgICAgIGZvciAoT2JqZWN0IHJvdyA6IHJlc3VsdCkgewogICAgICAgICAg\nICBPYmplY3RbXSBsaW5lID0gKE9iamVjdFtdKXJvdzsKICAgICAgICAgICAg\naW50IHZhbHVlID0gKChJbnRlZ2VyKWxpbmVbMF0pLmludFZhbHVlKCk7CiAg\nICAgICAgICAgIFBPYmplY3QgcGMgPSAoUE9iamVjdClsaW5lWzFdOwogICAg\nICAgICAgICBTeXN0ZW0uZXJyLnByaW50bG4oKytpICsgIi4iICsgU2xpY2VQ\nZXJzaXN0ZW5jZS5nZXRTbGljZShwYykgKyAiOiIgCiAgICAgICAgICAgICAg\nICAgICAgKyBwYy5nZXRJZCgpICsgIiwiICsgcGMuZ2V0VmFsdWUoKSk7CiAg\nICAgICAgfQogICAgICAgIGFzc2VydEVxdWFscyhsaW1pdCwgcmVzdWx0LnNp\nemUoKSk7CiAgICAgICAgZW0uZ2V0VHJhbnNhY3Rpb24oKS5yb2xsYmFjaygp\nOwogICAgfQogICAgCiAgICBwdWJsaWMgdm9pZCB0ZXN0SGludCgpIHsKICAg\nICAgICBMaXN0PFN0cmluZz4gdGFyZ2V0cyA9IG5ldyBBcnJheUxpc3Q8U3Ry\naW5nPigpOwogICAgICAgIHRhcmdldHMuYWRkKCJFdmVuIik7CiAgICAgICAg\nRW50aXR5TWFuYWdlciBlbSA9IGVtZi5jcmVhdGVFbnRpdHlNYW5hZ2VyKCk7\nCiAgICAgICAgZW0uZ2V0VHJhbnNhY3Rpb24oKS5iZWdpbigpOwogICAgICAg\nIFF1ZXJ5IHF1ZXJ5ID0gZW0uY3JlYXRlUXVlcnkoIlNFTEVDVCBwIEZST00g\nUE9iamVjdCBwIik7CiAgICAgICAgcXVlcnkuc2V0SGludChQcm9kdWN0RGVy\naXZhdGlvbi5ISU5UX1RBUkdFVCwgIkV2ZW4iKTsKICAgICAgICBMaXN0IHJl\nc3VsdCA9IHF1ZXJ5LmdldFJlc3VsdExpc3QoKTsKICAgICAgICBmb3IgKE9i\namVjdCBwYyA6IHJlc3VsdCkgewogICAgICAgICAgICBTdHJpbmcgc2xpY2Ug\nPSBTbGljZVBlcnNpc3RlbmNlLmdldFNsaWNlKHBjKTsKICAgICAgICAgICAg\nYXNzZXJ0VHJ1ZSh0YXJnZXRzLmNvbnRhaW5zKHNsaWNlKSk7CiAgICAgICAg\nfQogICAgICAgIGVtLmdldFRyYW5zYWN0aW9uKCkucm9sbGJhY2soKTsKICAg\nIH0KfQo=\n","encoding":"base64"}

