{"sha":"81b2cb2e5494b63a1c51c33cc4b084ad4fba4052","node_id":"MDQ6QmxvYjIwNjM2NDo4MWIyY2IyZTU0OTRiNjNhMWM1MWMzM2NjNGIwODRhZDRmYmE0MDUy","size":14897,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/81b2cb2e5494b63a1c51c33cc4b084ad4fba4052","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5rZXJuZWw7CgppbXBv\ncnQgamF2YS5pby5JT0V4Y2VwdGlvbjsKaW1wb3J0IGphdmEuaW8uU3RyZWFt\nVG9rZW5pemVyOwppbXBvcnQgamF2YS5pby5TdHJpbmdSZWFkZXI7CmltcG9y\ndCBqYXZhLnNxbC5Db25uZWN0aW9uOwppbXBvcnQgamF2YS5zcWwuUHJlcGFy\nZWRTdGF0ZW1lbnQ7CmltcG9ydCBqYXZhLnNxbC5SZXN1bHRTZXQ7CmltcG9y\ndCBqYXZhLnNxbC5TUUxFeGNlcHRpb247CmltcG9ydCBqYXZhLnV0aWwuQXJy\nYXlMaXN0OwppbXBvcnQgamF2YS51dGlsLkFycmF5czsKaW1wb3J0IGphdmEu\ndXRpbC5Db2xsZWN0aW9uczsKaW1wb3J0IGphdmEudXRpbC5JdGVyYXRvcjsK\naW1wb3J0IGphdmEudXRpbC5MaXN0OwoKaW1wb3J0IG9yZy5hcGFjaGUuY29t\nbW9ucy5sYW5nLlN0cmluZ1V0aWxzOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLmpkYmMubWV0YS5DbGFzc01hcHBpbmc7CmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEuamRiYy5tZXRhLk1hcHBpbmdSZXBvc2l0b3J5OwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0YS5RdWVyeVJlc3VsdE1hcHBp\nbmc7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zcWwuREJEaWN0\naW9uYXJ5OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc3FsLlJl\nc3VsdFNldFJlc3VsdDsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJj\nLnNxbC5TUUxCdWZmZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRi\nYy5zcWwuU1FMRXhjZXB0aW9uczsKaW1wb3J0IG9yZy5hcGFjaGUub3Blbmpw\nYS5rZXJuZWwuQWJzdHJhY3RTdG9yZVF1ZXJ5OwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLmtlcm5lbC5RdWVyeUNvbnRleHQ7CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEua2VybmVsLlN0b3JlUXVlcnk7CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEubGliLnJvcC5SYW5nZVJlc3VsdE9iamVjdFByb3ZpZGVy\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi5yb3AuUmVzdWx0T2Jq\nZWN0UHJvdmlkZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0\naWwuTG9jYWxpemVyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEu\nQ2xhc3NNZXRhRGF0YTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGls\nLlVzZXJFeGNlcHRpb247CmltcG9ydCBzZXJwLnV0aWwuTnVtYmVyczsKCi8q\nKgogKiBBIFNRTCBxdWVyeS4KICoKICogQGF1dGhvciBBYmUgV2hpdGUKICog\nQG5vamF2YWRvYwogKi8KcHVibGljIGNsYXNzIFNRTFN0b3JlUXVlcnkKICAg\nIGV4dGVuZHMgQWJzdHJhY3RTdG9yZVF1ZXJ5IHsKCiAgICBwcml2YXRlIHN0\nYXRpYyBmaW5hbCBMb2NhbGl6ZXIgX2xvYyA9IExvY2FsaXplci5mb3JQYWNr\nYWdlCiAgICAgICAgKFNRTFN0b3JlUXVlcnkuY2xhc3MpOwoKICAgIHByaXZh\ndGUgdHJhbnNpZW50IGZpbmFsIEpEQkNTdG9yZSBfc3RvcmU7CgogICAgLyoq\nCiAgICAgKiBDb25zdHJ1Y3QgYSBxdWVyeSBtYW5hZ2VkIGJ5IHRoZSBnaXZl\nbiBjb250ZXh0LgogICAgICovCiAgICBwdWJsaWMgU1FMU3RvcmVRdWVyeShK\nREJDU3RvcmUgc3RvcmUpIHsKICAgICAgICBfc3RvcmUgPSBzdG9yZTsKICAg\nIH0KCiAgICBwdWJsaWMgSkRCQ1N0b3JlIGdldFN0b3JlKCkgewogICAgICAg\nIHJldHVybiBfc3RvcmU7CiAgICB9CgogICAgLyoqCiAgICAgKiBVdGlsaXR5\nIG1ldGhvZCB0byBzdWJzdGl0dXRlICc/bnVtJyBmb3IgcGFyYW1ldGVycyBp\nbiB0aGUgZ2l2ZW4gU1FMCiAgICAgKiBzdGF0ZW1lbnQsIGFuZCByZS1vcmRl\nciB0aGUgPGNvZGU+cGFyYW1zPC9jb2RlPiBhcnJheSB0byBtYXRjaAogICAg\nICogdGhlIG9yZGVyIG9mIHRoZSBzcGVjaWZpZWQgcGFyYW1ldGVycy4KICAg\nICAqLwogICAgcHJpdmF0ZSBzdGF0aWMgU3RyaW5nIHN1YnN0aXR1dGVQYXJh\nbXMoU3RyaW5nIHNxbCwgTGlzdCBwYXJhbXMpCiAgICAgICAgdGhyb3dzIElP\nRXhjZXB0aW9uIHsKICAgICAgICAvLyBpZiB0aGVyZSdzIG5vICI/MSIgcG9z\naXRpb25hbCBwYXJhbWV0ZXIsIHRoZW4gd2UgZG9uJ3QgbmVlZCB0bwogICAg\nICAgIC8vIHBlcmZvcm0gdGhlIHBhcnNpbmcgcHJvY2VzcwogICAgICAgIGlm\nIChzcWwuaW5kZXhPZigiPzEiKSA9PSAtMSkKICAgICAgICAgICAgcmV0dXJu\nIHNxbDsKCiAgICAgICAgTGlzdCBwYXJhbU9yZGVyID0gbmV3IEFycmF5TGlz\ndCgpOwogICAgICAgIFN0cmVhbVRva2VuaXplciB0b2sgPSBuZXcgU3RyZWFt\nVG9rZW5pemVyKG5ldyBTdHJpbmdSZWFkZXIoc3FsKSk7CiAgICAgICAgdG9r\nLnJlc2V0U3ludGF4KCk7CiAgICAgICAgdG9rLnF1b3RlQ2hhcignXCcnKTsK\nICAgICAgICB0b2sud29yZENoYXJzKCcwJywgJzknKTsKICAgICAgICB0b2su\nd29yZENoYXJzKCc/JywgJz8nKTsKCiAgICAgICAgU3RyaW5nQnVmZmVyIGJ1\nZiA9IG5ldyBTdHJpbmdCdWZmZXIoc3FsLmxlbmd0aCgpKTsKICAgICAgICBm\nb3IgKGludCB0dHlwZTsgKHR0eXBlID0gdG9rLm5leHRUb2tlbigpKSAhPSBT\ndHJlYW1Ub2tlbml6ZXIuVFRfRU9GOykgewogICAgICAgICAgICBzd2l0Y2gg\nKHR0eXBlKSB7CiAgICAgICAgICAgICAgICBjYXNlIFN0cmVhbVRva2VuaXpl\nci5UVF9XT1JEOgogICAgICAgICAgICAgICAgICAgIC8vIGEgdG9rZW4gaXMg\nYSBwb3NpdGlvbmFsIHBhcmFtZXRlciBpZiBpdCBzdGFydHMgd2l0aAogICAg\nICAgICAgICAgICAgICAgIC8vIGEgIj8iIGFuZCB0aGUgcmVzdCBvZiB0aGUg\ndG9rZW4gYXJlIGFsbCBudW1iZXJzCiAgICAgICAgICAgICAgICAgICAgaWYg\nKHRvay5zdmFsLnN0YXJ0c1dpdGgoIj8iKSAmJiB0b2suc3ZhbC5sZW5ndGgo\nKSA+IDEgJiYKICAgICAgICAgICAgICAgICAgICAgICAgdG9rLnN2YWwuc3Vi\nc3RyaW5nKDEpLmluZGV4T2YoIj8iKSA9PSAtMSkgewogICAgICAgICAgICAg\nICAgICAgICAgICBidWYuYXBwZW5kKCI/Iik7CiAgICAgICAgICAgICAgICAg\nICAgICAgIHBhcmFtT3JkZXIuYWRkKEludGVnZXIudmFsdWVPZih0b2suc3Zh\nbC5zdWJzdHJpbmcoMSkpKTsKICAgICAgICAgICAgICAgICAgICB9IGVsc2UK\nICAgICAgICAgICAgICAgICAgICAgICAgYnVmLmFwcGVuZCh0b2suc3ZhbCk7\nCiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBj\nYXNlJ1wnJzoKICAgICAgICAgICAgICAgICAgICBidWYuYXBwZW5kKCdcJycp\nOwogICAgICAgICAgICAgICAgICAgIGlmICh0b2suc3ZhbCAhPSBudWxsKSB7\nCiAgICAgICAgICAgICAgICAgICAgICAgIGJ1Zi5hcHBlbmQodG9rLnN2YWwp\nOwogICAgICAgICAgICAgICAgICAgICAgICBidWYuYXBwZW5kKCdcJycpOwog\nICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBicmVh\nazsKICAgICAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgICAg\nICAgYnVmLmFwcGVuZCgoY2hhcikgdHR5cGUpOwogICAgICAgICAgICB9CiAg\nICAgICAgfQoKICAgICAgICAvLyBub3cgZ28gdGhyb3VnaCB0aGUgcGFyYW1P\ncmRlciBsaXN0IGFuZCByZS1vcmRlciB0aGUgcGFyYW1zIGFycmF5CiAgICAg\nICAgTGlzdCB0cmFuc2xhdGVkID0gbmV3IEFycmF5TGlzdCgpOwogICAgICAg\nIGZvciAoSXRlcmF0b3IgaSA9IHBhcmFtT3JkZXIuaXRlcmF0b3IoKTsgaS5o\nYXNOZXh0KCk7KSB7CiAgICAgICAgICAgIGludCBpbmRleCA9ICgoTnVtYmVy\nKSBpLm5leHQoKSkuaW50VmFsdWUoKSAtIDE7CiAgICAgICAgICAgIGlmIChp\nbmRleCA+PSBwYXJhbXMuc2l6ZSgpKQogICAgICAgICAgICAgICAgdGhyb3cg\nbmV3IFVzZXJFeGNlcHRpb24oX2xvYy5nZXQoInNxbHF1ZXJ5LW1pc3Npbmct\ncGFyYW1zIiwKICAgICAgICAgICAgICAgICAgICBzcWwsIFN0cmluZy52YWx1\nZU9mKGluZGV4KSwgcGFyYW1zKSk7CiAgICAgICAgICAgIHRyYW5zbGF0ZWQu\nYWRkKHBhcmFtcy5nZXQoaW5kZXgpKTsKICAgICAgICB9CgogICAgICAgIC8v\nIHRyYW5zZmVyIHRoZSB0cmFuc2xhdGVkIGxpc3QgaW50byB0aGUgb3JpZ2lu\nYWwgcGFyYW1zIGxpc3QKICAgICAgICBwYXJhbXMuY2xlYXIoKTsKICAgICAg\nICBwYXJhbXMuYWRkQWxsKHRyYW5zbGF0ZWQpOwogICAgICAgIHJldHVybiBi\ndWYudG9TdHJpbmcoKTsKICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBzdXBw\nb3J0c1BhcmFtZXRlckRlY2xhcmF0aW9ucygpIHsKICAgICAgICByZXR1cm4g\nZmFsc2U7CiAgICB9CgogICAgcHVibGljIGJvb2xlYW4gc3VwcG9ydHNEYXRh\nU3RvcmVFeGVjdXRpb24oKSB7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9\nCgogICAgcHVibGljIEV4ZWN1dG9yIG5ld0RhdGFTdG9yZUV4ZWN1dG9yKENs\nYXNzTWV0YURhdGEgbWV0YSwKICAgICAgICBib29sZWFuIHN1YmNsYXNzZXMp\nIHsKICAgICAgICByZXR1cm4gbmV3IFNRTEV4ZWN1dG9yKHRoaXMsIG1ldGEp\nOwogICAgfQoKICAgIHB1YmxpYyBib29sZWFuIHJlcXVpcmVzQ2FuZGlkYXRl\nVHlwZSgpIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgcHVi\nbGljIGJvb2xlYW4gcmVxdWlyZXNQYXJhbWV0ZXJEZWNsYXJhdGlvbnMoKSB7\nCiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIC8qKgogICAgICog\nRXhlY3V0ZXMgdGhlIGZpbHRlciBhcyBhIFNRTCBxdWVyeS4KICAgICAqLwog\nICAgcHJvdGVjdGVkIHN0YXRpYyBjbGFzcyBTUUxFeGVjdXRvcgogICAgICAg\nIGV4dGVuZHMgQWJzdHJhY3RFeGVjdXRvciB7CgogICAgICAgIHByaXZhdGUg\nZmluYWwgQ2xhc3NNZXRhRGF0YSBfbWV0YTsKICAgICAgICBwcml2YXRlIGZp\nbmFsIGJvb2xlYW4gX3NlbGVjdDsKICAgICAgICBwcml2YXRlIGZpbmFsIGJv\nb2xlYW4gX2NhbGw7ICAgLy8gbmF0aXZlIGNhbGwgc3RvcmVkIHByb2NlZHVy\nZQogICAgICAgIHByaXZhdGUgZmluYWwgUXVlcnlSZXN1bHRNYXBwaW5nIF9y\nZXN1bHRNYXBwaW5nOwoKICAgICAgICBwdWJsaWMgU1FMRXhlY3V0b3IoU1FM\nU3RvcmVRdWVyeSBxLCBDbGFzc01ldGFEYXRhIGNhbmRpZGF0ZSkgewogICAg\nICAgICAgICBRdWVyeUNvbnRleHQgY3R4ID0gcS5nZXRDb250ZXh0KCk7CiAg\nICAgICAgICAgIFN0cmluZyByZXN1bHRNYXBwaW5nID0gY3R4LmdldFJlc3Vs\ndE1hcHBpbmdOYW1lKCk7CiAgICAgICAgICAgIGlmIChyZXN1bHRNYXBwaW5n\nID09IG51bGwpCiAgICAgICAgICAgICAgICBfcmVzdWx0TWFwcGluZyA9IG51\nbGw7CiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgQ2xhc3NM\nb2FkZXIgZW52TG9hZGVyID0gY3R4LmdldFN0b3JlQ29udGV4dCgpLmdldENs\nYXNzTG9hZGVyKCk7CiAgICAgICAgICAgICAgICBNYXBwaW5nUmVwb3NpdG9y\neSByZXBvcyA9IHEuZ2V0U3RvcmUoKS5nZXRDb25maWd1cmF0aW9uKCkuCiAg\nICAgICAgICAgICAgICAgICAgZ2V0TWFwcGluZ1JlcG9zaXRvcnlJbnN0YW5j\nZSgpOwogICAgICAgICAgICAgICAgX3Jlc3VsdE1hcHBpbmcgPSByZXBvcy5n\nZXRRdWVyeVJlc3VsdE1hcHBpbmcKICAgICAgICAgICAgICAgICAgICAoY3R4\nLmdldFJlc3VsdE1hcHBpbmdTY29wZSgpLCByZXN1bHRNYXBwaW5nLCBlbnZM\nb2FkZXIsCiAgICAgICAgICAgICAgICAgICAgICAgIHRydWUpOwogICAgICAg\nICAgICB9CiAgICAgICAgICAgIF9tZXRhID0gY2FuZGlkYXRlOwoKICAgICAg\nICAgICAgU3RyaW5nIHNxbCA9IFN0cmluZ1V0aWxzLnRyaW1Ub051bGwoY3R4\nLmdldFF1ZXJ5U3RyaW5nKCkpOwogICAgICAgICAgICBpZiAoc3FsID09IG51\nbGwpCiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgVXNlckV4Y2VwdGlvbihf\nbG9jLmdldCgibm8tc3FsIikpOwogICAgICAgICAgICBfc2VsZWN0ID0gcS5n\nZXRTdG9yZSgpLmdldERCRGljdGlvbmFyeSgpLmlzU2VsZWN0KHNxbCk7CiAg\nICAgICAgICAgIF9jYWxsID0gc3FsLmxlbmd0aCgpID4gNAogICAgICAgICAg\nICAgICAgJiYgc3FsLnN1YnN0cmluZygwLCA0KS5lcXVhbHNJZ25vcmVDYXNl\nKCJjYWxsIik7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgaW50IGdldE9w\nZXJhdGlvbihTdG9yZVF1ZXJ5IHEpIHsKICAgICAgICAgICByZXR1cm4gX3Nl\nbGVjdCA/IE9QX1NFTEVDVCA6IAogICAgICAgICAgICAgICAgKHEuZ2V0Q29u\ndGV4dCgpLmdldENhbmRpZGF0ZVR5cGUoKSAhPSBudWxsCiAgICAgICAgICAg\nICAgICAgICAgICAgIHx8IHEuZ2V0Q29udGV4dCgpLmdldFJlc3VsdFR5cGUo\nKSAhPSBudWxsCiAgICAgICAgICAgICAgICAgICAgICAgIHx8IHEuZ2V0Q29u\ndGV4dCgpLmdldFJlc3VsdE1hcHBpbmdOYW1lKCkgIT0gbnVsbCAKICAgICAg\nICAgICAgICAgICAgICAgICAgfHwgcS5nZXRDb250ZXh0KCkuZ2V0UmVzdWx0\nTWFwcGluZ1Njb3BlKCkgIT0gbnVsbCkKICAgICAgICAgICAgICAgICAgICAg\nICAgPyBPUF9TRUxFQ1QgOiBPUF9VUERBVEU7CiAgICAgICAgfQoKICAgICAg\nICBwdWJsaWMgTnVtYmVyIGV4ZWN1dGVVcGRhdGUoU3RvcmVRdWVyeSBxLCBP\nYmplY3RbXSBwYXJhbXMpIHsKICAgICAgICAgICAgSkRCQ1N0b3JlIHN0b3Jl\nID0gKChTUUxTdG9yZVF1ZXJ5KSBxKS5nZXRTdG9yZSgpOwogICAgICAgICAg\nICBEQkRpY3Rpb25hcnkgZGljdCA9IHN0b3JlLmdldERCRGljdGlvbmFyeSgp\nOwogICAgICAgICAgICBTdHJpbmcgc3FsID0gcS5nZXRDb250ZXh0KCkuZ2V0\nUXVlcnlTdHJpbmcoKTsKCiAgICAgICAgICAgIExpc3QgcGFyYW1MaXN0Owog\nICAgICAgICAgICBpZiAocGFyYW1zLmxlbmd0aCA+IDApIHsKICAgICAgICAg\nICAgICAgIHBhcmFtTGlzdCA9IG5ldyBBcnJheUxpc3QoQXJyYXlzLmFzTGlz\ndChwYXJhbXMpKTsKICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAg\nICAgICAgICAgc3FsID0gc3Vic3RpdHV0ZVBhcmFtcyhzcWwsIHBhcmFtTGlz\ndCk7CiAgICAgICAgICAgICAgICB9IGNhdGNoIChJT0V4Y2VwdGlvbiBpb2Up\nIHsKICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgVXNlckV4Y2VwdGlv\nbihpb2UpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGVsc2UK\nICAgICAgICAgICAgICAgIHBhcmFtTGlzdCA9IENvbGxlY3Rpb25zLkVNUFRZ\nX0xJU1Q7CgogICAgICAgICAgICBTUUxCdWZmZXIgYnVmID0gbmV3IFNRTEJ1\nZmZlcihkaWN0KS5hcHBlbmQoc3FsKTsKICAgICAgICAgICAgCiAgICAgICAg\nICAgIC8vIHdlIG5lZWQgdG8gbWFrZSBzdXJlIHdlIGhhdmUgYW4gYWN0aXZl\nIHN0b3JlIGNvbm5lY3Rpb24KICAgICAgICAgICAgc3RvcmUuZ2V0Q29udGV4\ndCgpLmJlZ2luU3RvcmUoKTsKICAgICAgICAgICAgQ29ubmVjdGlvbiBjb25u\nID0gc3RvcmUuZ2V0Q29ubmVjdGlvbigpOwogICAgICAgICAgICBKREJDRmV0\nY2hDb25maWd1cmF0aW9uIGZldGNoID0gKEpEQkNGZXRjaENvbmZpZ3VyYXRp\nb24pCiAgICAgICAgICAgICAgICBxLmdldENvbnRleHQoKS5nZXRGZXRjaENv\nbmZpZ3VyYXRpb24oKTsKCiAgICAgICAgICAgIFByZXBhcmVkU3RhdGVtZW50\nIHN0bW50ID0gbnVsbDsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAg\nICAgIHN0bW50ID0gcHJlcGFyZUNhbGwoY29ubiwgYnVmKTsKCiAgICAgICAg\nICAgICAgICBidWYuc2V0UGFyYW1ldGVycyhwYXJhbUxpc3QpOwogICAgICAg\nICAgICAgICAgaWYgKHN0bW50ICE9IG51bGwpCiAgICAgICAgICAgICAgICAg\nICAgYnVmLnNldFBhcmFtZXRlcnMoc3RtbnQpOwoKICAgICAgICAgICAgICAg\nIGludCBjb3VudCA9IGV4ZWN1dGVVcGRhdGUoc3RvcmUsIGNvbm4sIHN0bW50\nLCBidWYpOyAgCiAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICByZXR1\ncm4gTnVtYmVycy52YWx1ZU9mKGNvdW50KTsKICAgICAgICAgICAgfSBjYXRj\naCAoU1FMRXhjZXB0aW9uIHNlKSB7CiAgICAgICAgICAgICAgICB0aHJvdyBT\nUUxFeGNlcHRpb25zLmdldFN0b3JlKHNlLCBkaWN0KTsKICAgICAgICAgICAg\nfSBmaW5hbGx5IHsKICAgICAgICAgICAgICAgIGlmIChzdG1udCAhPSBudWxs\nKSB7CiAgICAgICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAg\nICAgICAgICAgc3RtbnQuY2xvc2UoKTsKICAgICAgICAgICAgICAgICAgICB9\nIGNhdGNoIChTUUxFeGNlcHRpb24gc2UpIHsKICAgICAgICAgICAgICAgICAg\nICAgICAgLy8gc2FmZSB0byBpZ25vcmUKICAgICAgICAgICAgICAgICAgICB9\nIGZpbmFsbHkgewogICAgICAgICAgICAgICAgICAgICAgICBzdG1udCA9IG51\nbGw7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQog\nICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICBjb25u\nLmNsb3NlKCk7CiAgICAgICAgICAgICAgICB9IGNhdGNoIChTUUxFeGNlcHRp\nb24gc2UpIHsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAg\nICAgIH0KCiAgICAgICAgcHVibGljIFJlc3VsdE9iamVjdFByb3ZpZGVyIGV4\nZWN1dGVRdWVyeShTdG9yZVF1ZXJ5IHEsCiAgICAgICAgICAgIE9iamVjdFtd\nIHBhcmFtcywgUmFuZ2UgcmFuZ2UpIHsKICAgICAgICAgICAgSkRCQ1N0b3Jl\nIHN0b3JlID0gKChTUUxTdG9yZVF1ZXJ5KSBxKS5nZXRTdG9yZSgpOwogICAg\nICAgICAgICBEQkRpY3Rpb25hcnkgZGljdCA9IHN0b3JlLmdldERCRGljdGlv\nbmFyeSgpOwogICAgICAgICAgICBTdHJpbmcgc3FsID0gcS5nZXRDb250ZXh0\nKCkuZ2V0UXVlcnlTdHJpbmcoKTsKCiAgICAgICAgICAgIExpc3QgcGFyYW1M\naXN0OwogICAgICAgICAgICBpZiAocGFyYW1zLmxlbmd0aCA+IDApIHsKICAg\nICAgICAgICAgICAgIHBhcmFtTGlzdCA9IG5ldyBBcnJheUxpc3QoQXJyYXlz\nLmFzTGlzdChwYXJhbXMpKTsKICAgICAgICAgICAgICAgIHRyeSB7CiAgICAg\nICAgICAgICAgICAgICAgc3FsID0gc3Vic3RpdHV0ZVBhcmFtcyhzcWwsIHBh\ncmFtTGlzdCk7CiAgICAgICAgICAgICAgICB9IGNhdGNoIChJT0V4Y2VwdGlv\nbiBpb2UpIHsKICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgVXNlckV4\nY2VwdGlvbihpb2UpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9\nIGVsc2UKICAgICAgICAgICAgICAgIHBhcmFtTGlzdCA9IENvbGxlY3Rpb25z\nLkVNUFRZX0xJU1Q7CgogICAgICAgICAgICBTUUxCdWZmZXIgYnVmID0gbmV3\nIFNRTEJ1ZmZlcihkaWN0KS5hcHBlbmQoc3FsKTsKICAgICAgICAgICAgQ29u\nbmVjdGlvbiBjb25uID0gc3RvcmUuZ2V0Q29ubmVjdGlvbigpOwogICAgICAg\nICAgICBKREJDRmV0Y2hDb25maWd1cmF0aW9uIGZldGNoID0gKEpEQkNGZXRj\naENvbmZpZ3VyYXRpb24pCiAgICAgICAgICAgICAgICBxLmdldENvbnRleHQo\nKS5nZXRGZXRjaENvbmZpZ3VyYXRpb24oKTsKCiAgICAgICAgICAgIFJlc3Vs\ndE9iamVjdFByb3ZpZGVyIHJvcDsKICAgICAgICAgICAgUHJlcGFyZWRTdGF0\nZW1lbnQgc3RtbnQgPSBudWxsOwogICAgICAgICAgICB0cnkgewogICAgICAg\nICAgICAgICAgLy8gdXNlIHRoZSByaWdodCBtZXRob2QgZGVwZW5kaW5nIG9u\nIHNlbCB2cy4gcHJvYywgbHJzIHNldHRpbmcKICAgICAgICAgICAgICAgIGlm\nIChfc2VsZWN0ICYmICFyYW5nZS5scnMpCiAgICAgICAgICAgICAgICAgICAg\nc3RtbnQgPSBwcmVwYXJlU3RhdGVtZW50KGNvbm4sIGJ1Zik7CiAgICAgICAg\nICAgICAgICBlbHNlIGlmIChfc2VsZWN0KQogICAgICAgICAgICAgICAgICAg\nIHN0bW50ID0gcHJlcGFyZVN0YXRlbWVudChjb25uLCBidWYsIGZldGNoLCAt\nMSwgLTEpOwogICAgICAgICAgICAgICAgZWxzZSBpZiAoIXJhbmdlLmxycykK\nICAgICAgICAgICAgICAgICAgICBzdG1udCA9IHByZXBhcmVDYWxsKGNvbm4s\nIGJ1Zik7CiAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAg\nICAgc3RtbnQgPSBwcmVwYXJlQ2FsbChjb25uLCBidWYsIGZldGNoLCAtMSwg\nLTEpOwoKICAgICAgICAgICAgICAgIGludCBpbmRleCA9IDA7CiAgICAgICAg\nICAgICAgICBmb3IgKEl0ZXJhdG9yIGkgPSBwYXJhbUxpc3QuaXRlcmF0b3Io\nKTsgaS5oYXNOZXh0KCkgJiYgCiAgICAgICAgICAgICAgICAgICAgc3RtbnQg\nIT0gbnVsbDspCiAgICAgICAgICAgICAgICAgICAgZGljdC5zZXRVbmtub3du\nKHN0bW50LCArK2luZGV4LCBpLm5leHQoKSwgbnVsbCk7CgogICAgICAgICAg\nICAgICAgUmVzdWx0U2V0IHJzID0gZXhlY3V0ZVF1ZXJ5KHN0b3JlLCBjb25u\nLCBzdG1udCwgYnVmLCBwYXJhbUxpc3QpOwogICAgICAgICAgICAgICAgUmVz\ndWx0U2V0UmVzdWx0IHJlcyA9IHN0bW50ICE9IG51bGwgPyAKICAgICAgICAg\nICAgICAgICAgICBuZXcgUmVzdWx0U2V0UmVzdWx0KGNvbm4sIHN0bW50LCBy\ncywgc3RvcmUpIDoKICAgICAgICAgICAgICAgICAgICBuZXcgUmVzdWx0U2V0\nUmVzdWx0KGNvbm4sIHJzLCBkaWN0KTsKICAgICAgICAgICAgICAgIGlmIChf\ncmVzdWx0TWFwcGluZyAhPSBudWxsKQogICAgICAgICAgICAgICAgICAgIHJv\ncCA9IG5ldyBNYXBwZWRRdWVyeVJlc3VsdE9iamVjdFByb3ZpZGVyKF9yZXN1\nbHRNYXBwaW5nLAogICAgICAgICAgICAgICAgICAgICAgICBzdG9yZSwgZmV0\nY2gsIHJlcyk7CiAgICAgICAgICAgICAgICBlbHNlIGlmIChxLmdldENvbnRl\neHQoKS5nZXRDYW5kaWRhdGVUeXBlKCkgIT0gbnVsbCkKICAgICAgICAgICAg\nICAgICAgICByb3AgPSBuZXcgR2VuZXJpY1Jlc3VsdE9iamVjdFByb3ZpZGVy\nKChDbGFzc01hcHBpbmcpIF9tZXRhLAogICAgICAgICAgICAgICAgICAgICAg\nICBzdG9yZSwgZmV0Y2gsIHJlcyk7CiAgICAgICAgICAgICAgICBlbHNlCiAg\nICAgICAgICAgICAgICAgICAgcm9wID0gbmV3IFNRTFByb2plY3Rpb25SZXN1\nbHRPYmplY3RQcm92aWRlcihzdG9yZSwgZmV0Y2gsCiAgICAgICAgICAgICAg\nICAgICAgICAgIHJlcywgcS5nZXRDb250ZXh0KCkuZ2V0UmVzdWx0VHlwZSgp\nKTsKICAgICAgICAgICAgfSBjYXRjaCAoU1FMRXhjZXB0aW9uIHNlKSB7CiAg\nICAgICAgICAgICAgICBpZiAoc3RtbnQgIT0gbnVsbCkKICAgICAgICAgICAg\nICAgICAgICB0cnkgeyBzdG1udC5jbG9zZSgpOyB9IGNhdGNoIChTUUxFeGNl\ncHRpb24gc2UyKSB7fQogICAgICAgICAgICAgICAgdHJ5IHsgY29ubi5jbG9z\nZSgpOyB9IGNhdGNoIChTUUxFeGNlcHRpb24gc2UyKSB7fQogICAgICAgICAg\nICAgICAgdGhyb3cgU1FMRXhjZXB0aW9ucy5nZXRTdG9yZShzZSwgZGljdCk7\nCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmIChyYW5nZS5zdGFydCAh\nPSAwIHx8IHJhbmdlLmVuZCAhPSBMb25nLk1BWF9WQUxVRSkKICAgICAgICAg\nICAgICAgIHJvcCA9IG5ldyBSYW5nZVJlc3VsdE9iamVjdFByb3ZpZGVyKHJv\ncCwgcmFuZ2Uuc3RhcnQscmFuZ2UuZW5kKTsKICAgICAgICAgICAgcmV0dXJu\nIHJvcDsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBTdHJpbmdbXSBnZXRE\nYXRhU3RvcmVBY3Rpb25zKFN0b3JlUXVlcnkgcSwgT2JqZWN0W10gcGFyYW1z\nLAogICAgICAgICAgICBSYW5nZSByYW5nZSkgewogICAgICAgICAgICByZXR1\ncm4gbmV3IFN0cmluZ1tdeyBxLmdldENvbnRleHQoKS5nZXRRdWVyeVN0cmlu\nZygpIH07CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgYm9vbGVhbiBpc1Bh\nY2tpbmcoU3RvcmVRdWVyeSBxKSB7CiAgICAgICAgICAgIHJldHVybiBxLmdl\ndENvbnRleHQoKS5nZXRDYW5kaWRhdGVUeXBlKCkgPT0gbnVsbDsKICAgICAg\nICB9CiAgICAgICAgCiAgICAgICAgLyoqCiAgICAgICAgICogVGhpcyBtZXRo\nb2QgaXMgdG8gcHJvdmlkZSBvdmVycmlkZSBmb3Igbm9uLUpEQkMgb3IgSkRC\nQy1saWtlIAogICAgICAgICAqIGltcGxlbWVudGF0aW9uIG9mIHByZXBhcmlu\nZyBjYWxsIHN0YXRlbWVudC4KICAgICAgICAgKi8KICAgICAgICBwcm90ZWN0\nZWQgUHJlcGFyZWRTdGF0ZW1lbnQgcHJlcGFyZUNhbGwoQ29ubmVjdGlvbiBj\nb25uLCBTUUxCdWZmZXIgYnVmKQogICAgICAgICAgICB0aHJvd3MgU1FMRXhj\nZXB0aW9uIHsKICAgICAgICAgICAgcmV0dXJuIGJ1Zi5wcmVwYXJlQ2FsbChj\nb25uKTsgICAgICAgICAgICAKICAgICAgICB9CiAgICAgICAgCiAgICAgICAg\nLyoqCiAgICAgICAgICogVGhpcyBtZXRob2QgaXMgdG8gcHJvdmlkZSBvdmVy\ncmlkZSBmb3Igbm9uLUpEQkMgb3IgSkRCQy1saWtlIAogICAgICAgICAqIGlt\ncGxlbWVudGF0aW9uIG9mIGV4ZWN1dGluZyB1cGRhdGUuCiAgICAgICAgICov\nCiAgICAgICAgcHJvdGVjdGVkIGludCBleGVjdXRlVXBkYXRlKEpEQkNTdG9y\nZSBzdG9yZSwgQ29ubmVjdGlvbiBjb25uLCAKICAgICAgICAgICAgUHJlcGFy\nZWRTdGF0ZW1lbnQgc3RtbnQsIFNRTEJ1ZmZlciBidWYpIAogICAgICAgICAg\nICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAgICAgaW50IGNvdW50\nID0gMDsKICAgICAgICAgICAgaWYgKF9jYWxsICYmIHN0bW50LmV4ZWN1dGUo\nKSA9PSBmYWxzZSkgewogICAgICAgICAgICAgICAgY291bnQgPSBzdG1udC5n\nZXRVcGRhdGVDb3VudCgpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVs\nc2UgewogICAgICAgICAgICAgICAgLy8gbmF0aXZlIGluc2VydCwgdXBkYXRl\nLCBkZWxldGUKICAgICAgICAgICAgICAgIGNvdW50ID0gc3RtbnQuZXhlY3V0\nZVVwZGF0ZSgpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiBj\nb3VudDsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgLyoqCiAgICAgICAg\nICogVGhpcyBtZXRob2QgaXMgdG8gcHJvdmlkZSBvdmVycmlkZSBmb3Igbm9u\nLUpEQkMgb3IgSkRCQy1saWtlIAogICAgICAgICAqIGltcGxlbWVudGF0aW9u\nIG9mIHByZXBhcmluZyBjYWxsIHN0YXRlbWVudC4KICAgICAgICAgKi8KICAg\nICAgICBwcm90ZWN0ZWQgUHJlcGFyZWRTdGF0ZW1lbnQgcHJlcGFyZUNhbGwo\nQ29ubmVjdGlvbiBjb25uLCBTUUxCdWZmZXIgYnVmLAogICAgICAgICAgICBK\nREJDRmV0Y2hDb25maWd1cmF0aW9uIGZldGNoLCBpbnQgcnNUeXBlLCBpbnQg\ncnNDb25jdXIpCiAgICAgICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewog\nICAgICAgICAgICByZXR1cm4gYnVmLnByZXBhcmVDYWxsKGNvbm4sIGZldGNo\nLCByc1R5cGUsIHJzQ29uY3VyKTsgIAogICAgICAgIH0KCiAgICAgICAgLyoq\nCiAgICAgICAgICogVGhpcyBtZXRob2QgaXMgdG8gcHJvdmlkZSBvdmVycmlk\nZSBmb3Igbm9uLUpEQkMgb3IgSkRCQy1saWtlIAogICAgICAgICAqIGltcGxl\nbWVudGF0aW9uIG9mIHByZXBhcmluZyBzdGF0ZW1lbnQuCiAgICAgICAgICov\nCiAgICAgICAgcHJvdGVjdGVkIFByZXBhcmVkU3RhdGVtZW50IHByZXBhcmVT\ndGF0ZW1lbnQoQ29ubmVjdGlvbiBjb25uLCAKICAgICAgICAgICAgU1FMQnVm\nZmVyIGJ1ZikgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgICAgIHJl\ndHVybiBidWYucHJlcGFyZVN0YXRlbWVudChjb25uKTsKICAgICAgICB9CiAg\nICAgICAgCiAgICAgICAgLyoqCiAgICAgICAgICogVGhpcyBtZXRob2QgaXMg\ndG8gcHJvdmlkZSBvdmVycmlkZSBmb3Igbm9uLUpEQkMgb3IgSkRCQy1saWtl\nIAogICAgICAgICAqIGltcGxlbWVudGF0aW9uIG9mIHByZXBhcmluZyBzdGF0\nZW1lbnQuCiAgICAgICAgICovCiAgICAgICAgcHJvdGVjdGVkIFByZXBhcmVk\nU3RhdGVtZW50IHByZXBhcmVTdGF0ZW1lbnQoQ29ubmVjdGlvbiBjb25uLCAK\nICAgICAgICAgICAgU1FMQnVmZmVyIGJ1ZiwgSkRCQ0ZldGNoQ29uZmlndXJh\ndGlvbiBmZXRjaCwgaW50IHJzVHlwZSwKICAgICAgICAgICAgaW50IHJzQ29u\nY3VyKSB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAgICAgcmV0dXJu\nIGJ1Zi5wcmVwYXJlU3RhdGVtZW50KGNvbm4sIGZldGNoLCByc1R5cGUsIHJz\nQ29uY3VyKTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgLyoqCiAgICAg\nICAgICogVGhpcyBtZXRob2QgaXMgdG8gcHJvdmlkZSBvdmVycmlkZSBmb3Ig\nbm9uLUpEQkMgb3IgSkRCQy1saWtlIAogICAgICAgICAqIGltcGxlbWVudGF0\naW9uIG9mIGV4ZWN1dGluZyBxdWVyeS4KICAgICAgICAgKi8KICAgICAgICBw\ncm90ZWN0ZWQgUmVzdWx0U2V0IGV4ZWN1dGVRdWVyeShKREJDU3RvcmUgc3Rv\ncmUsIENvbm5lY3Rpb24gY29ubiwKICAgICAgICAgICAgUHJlcGFyZWRTdGF0\nZW1lbnQgc3RtbnQsIFNRTEJ1ZmZlciBidWYsIExpc3QgcGFyYW1MaXN0KQog\nICAgICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAgICAg\ncmV0dXJuIHN0bW50LmV4ZWN1dGVRdWVyeSgpOwogICAgICAgIH0KICAgIH0K\nfQo=\n","encoding":"base64"}

