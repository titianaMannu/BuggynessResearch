{"sha":"af84c4f096bcabef73e18ca091ef8452fac19a70","node_id":"MDQ6QmxvYjIwNjM2NDphZjg0YzRmMDk2YmNhYmVmNzNlMThjYTA5MWVmODQ1MmZhYzE5YTcw","size":25974,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/af84c4f096bcabef73e18ca091ef8452fac19a70","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5rZXJuZWw7CgppbXBv\ncnQgamF2YS5pby5TZXJpYWxpemFibGU7CmltcG9ydCBqYXZhLnNxbC5Db25u\nZWN0aW9uOwppbXBvcnQgamF2YS5zcWwuUHJlcGFyZWRTdGF0ZW1lbnQ7Cmlt\ncG9ydCBqYXZhLnNxbC5SZXN1bHRTZXQ7CmltcG9ydCBqYXZhLnNxbC5TUUxF\neGNlcHRpb247CmltcG9ydCBqYXZhLnNxbC5UeXBlczsKaW1wb3J0IGphdmEu\ndXRpbC5IYXNoTWFwOwoKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJj\nLmNvbmYuSkRCQ0NvbmZpZ3VyYXRpb247CmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEuamRiYy5jb25mLkpEQkNDb25maWd1cmF0aW9uSW1wbDsKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLm1ldGEuQ2xhc3NNYXBwaW5nOwpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1hLkNvbHVtbjsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNjaGVtYS5QcmltYXJ5\nS2V5OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1hLlNj\naGVtYTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNjaGVtYS5T\nY2hlbWFHcm91cDsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNj\naGVtYS5TY2hlbWFUb29sOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpk\nYmMuc2NoZW1hLlNjaGVtYXM7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\namRiYy5zY2hlbWEuVGFibGU7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\namRiYy5zcWwuREJEaWN0aW9uYXJ5OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLmpkYmMuc3FsLlJvd0ltcGw7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEuamRiYy5zcWwuU1FMQnVmZmVyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLmpkYmMuc3FsLlNRTEV4Y2VwdGlvbnM7CmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEubGliLmNvbmYuQ29uZmlndXJhYmxlOwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLmxpYi5jb25mLkNvbmZpZ3VyYXRpb247CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEubGliLmNvbmYuQ29uZmlndXJhdGlvbnM7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLmxvZy5Mb2c7CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuTG9jYWxpemVyOwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51dGlsLk9wdGlvbnM7CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEubWV0YS5KYXZhVHlwZXM7CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEudXRpbC5JbnZhbGlkU3RhdGVFeGNlcHRpb247Cmlt\ncG9ydCBzZXJwLnV0aWwuTnVtYmVyczsKaW1wb3J0IHNlcnAudXRpbC5TdHJp\nbmdzOwoKLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v\nLy8vLy8vLy8vLy8vLy8vLy8vLy8vCi8vIE5PVEU6IERvIG5vdCBjaGFuZ2Ug\ncHJvcGVydHkgbmFtZXM7IHNlZSBTZXF1ZW5jZU1ldGFEYXRhCi8vIGFuZCBT\nZXF1ZW5jZU1hcHBpbmcgZm9yIHN0YW5kYXJkIHByb3BlcnR5IG5hbWVzLgov\nLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v\nLy8vLy8vLy8vLy8vLy8KCi8qKgogKiB7QGxpbmsgSkRCQ1NlcX0gaW1wbGVt\nZW50YXRpb24gdGhhdCB1c2VzIGEgZGF0YWJhc2UgdGFibGUKICogZm9yIHNl\ncXVlbmNlIG51bWJlciBnZW5lcmF0aW9uLiBUaGlzIGJhc2UgaW1wbGVtZW50\nYXRpb24gdXNlcyBhIHNpbmdsZQogKiByb3cgZm9yIGEgZ2xvYmFsIHNlcXVl\nbmNlIG51bWJlci4KICoKICogQGF1dGhvciBBYmUgV2hpdGUKICovCnB1Ymxp\nYyBjbGFzcyBUYWJsZUpEQkNTZXEKICAgIGV4dGVuZHMgQWJzdHJhY3RKREJD\nU2VxCiAgICBpbXBsZW1lbnRzIENvbmZpZ3VyYWJsZSB7CgogICAgcHVibGlj\nIHN0YXRpYyBmaW5hbCBTdHJpbmcgQUNUSU9OX0RST1AgPSAiZHJvcCI7CiAg\nICBwdWJsaWMgc3RhdGljIGZpbmFsIFN0cmluZyBBQ1RJT05fQUREID0gImFk\nZCI7CiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIFN0cmluZyBBQ1RJT05fR0VU\nID0gImdldCI7CiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIFN0cmluZyBBQ1RJ\nT05fU0VUID0gInNldCI7CgogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgTG9j\nYWxpemVyIF9sb2MgPSBMb2NhbGl6ZXIuZm9yUGFja2FnZQogICAgICAgIChU\nYWJsZUpEQkNTZXEuY2xhc3MpOwoKICAgIHByaXZhdGUgdHJhbnNpZW50IEpE\nQkNDb25maWd1cmF0aW9uIF9jb25mID0gbnVsbDsKICAgIHByaXZhdGUgdHJh\nbnNpZW50IExvZyBfbG9nID0gbnVsbDsKICAgIHByaXZhdGUgaW50IF9hbGxv\nYyA9IDUwOwogICAgcHJpdmF0ZSBpbnQgX2ludFZhbHVlID0gMTsKICAgIHBy\naXZhdGUgZmluYWwgSGFzaE1hcCBfc3RhdCA9IG5ldyBIYXNoTWFwKCk7Cgog\nICAgcHJpdmF0ZSBTdHJpbmcgX3RhYmxlID0gIk9QRU5KUEFfU0VRVUVOQ0Vf\nVEFCTEUiOwogICAgcHJpdmF0ZSBTdHJpbmcgX3NlcUNvbHVtbk5hbWUgPSAi\nU0VRVUVOQ0VfVkFMVUUiOwogICAgcHJpdmF0ZSBTdHJpbmcgX3BrQ29sdW1u\nTmFtZSA9ICJJRCI7CgogICAgcHJpdmF0ZSBDb2x1bW4gX3NlcUNvbHVtbiA9\nIG51bGw7CiAgICBwcml2YXRlIENvbHVtbiBfcGtDb2x1bW4gPSBudWxsOwog\nICAgcHJpdmF0ZSBpbnQgX3NjaGVtYXNJZHggPSAwOyAgICAKCiAgICAvKioK\nICAgICAqIFRoZSBzZXF1ZW5jZSB0YWJsZSBuYW1lLiBEZWZhdWx0cyB0byA8\nY29kZT5PUEVOSlBBX1NFUVVFTkNFX1RBQkxFPC9jb2RlPi4KICAgICAqIEJ5\nIGRlZmF1bHQsIHRoZSB0YWJsZSB3aWxsIGJlIHBsYWNlZCBpbiB0aGUgZmly\nc3Qgc2NoZW1hIGxpc3RlZCBpbiB5b3VyCiAgICAgKiA8Y29kZT5vcGVuanBh\nLmpkYmMuU2NoZW1hczwvY29kZT4gcHJvcGVydHksIG9yIGluIHRoZSBkZWZh\ndWx0IHNjaGVtYSBpZgogICAgICogdGhlIHByb3BlcnR5IGlzIG5vdCBnaXZl\nbi4gSWYgeW91IHNwZWNpZnkgYSB0YWJsZSBuYW1lIGluIHRoZSBmb3JtCiAg\nICAgKiA8Y29kZT4mbHQ7c2NoZW1hJmd0Oy4mbHQ7dGFibGUmZ3Q7PC9jb2Rl\nPiwgdGhlbiB0aGUgZ2l2ZW4gc2NoZW1hCiAgICAgKiB3aWxsIGJlIHVzZWQu\nCiAgICAgKi8KICAgIHB1YmxpYyBTdHJpbmcgZ2V0VGFibGUoKSB7CiAgICAg\nICAgcmV0dXJuIF90YWJsZTsKICAgIH0KCiAgICAvKioKICAgICAqIFRoZSBz\nZXF1ZW5jZSB0YWJsZSBuYW1lLiBEZWZhdWx0cyB0byA8Y29kZT5PUEVOSlBB\nX1NFUVVFTkNFX1RBQkxFPC9jb2RlPi4KICAgICAqIEJ5IGRlZmF1bHQsIHRo\nZSB0YWJsZSB3aWxsIGJlIHBsYWNlZCBpbiB0aGUgZmlyc3Qgc2NoZW1hIGxp\nc3RlZCBpbiB5b3VyCiAgICAgKiA8Y29kZT5vcGVuanBhLmpkYmMuU2NoZW1h\nczwvY29kZT4gcHJvcGVydHksIG9yIGluIHRoZSBkZWZhdWx0IHNjaGVtYSBp\nZgogICAgICogdGhlIHByb3BlcnR5IGlzIG5vdCBnaXZlbi4gSWYgeW91IHNw\nZWNpZnkgYSB0YWJsZSBuYW1lIGluIHRoZSBmb3JtCiAgICAgKiA8Y29kZT4m\nbHQ7c2NoZW1hJmd0Oy4mbHQ7dGFibGUmZ3Q7PC9jb2RlPiwgdGhlbiB0aGUg\nZ2l2ZW4gc2NoZW1hCiAgICAgKiB3aWxsIGJlIHVzZWQuCiAgICAgKi8KICAg\nIHB1YmxpYyB2b2lkIHNldFRhYmxlKFN0cmluZyBuYW1lKSB7CiAgICAgICAg\nX3RhYmxlID0gbmFtZTsKICAgIH0KCiAgICAvKioKICAgICAqIEBkZXByZWNh\ndGVkIFVzZSB7QGxpbmsgI3NldFRhYmxlfS4gUmV0YWluZWQgZm9yCiAgICAg\nKiBiYWNrd2FyZHMtY29tcGF0aWJpbGl0eQl3aXRoIGF1dG8tY29uZmlndXJh\ndGlvbi4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0VGFibGVOYW1lKFN0\ncmluZyBuYW1lKSB7CiAgICAgICAgc2V0VGFibGUobmFtZSk7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBUaGUgbmFtZSBvZiB0aGUgY29sdW1uIHRoYXQgaG9s\nZHMgdGhlIHNlcXVlbmNlIHZhbHVlLiBEZWZhdWx0cwogICAgICogdG8gPGNv\nZGU+U0VRVUVOQ0VfVkFMVUU8L2NvZGU+LgogICAgICovCiAgICBwdWJsaWMg\nU3RyaW5nIGdldFNlcXVlbmNlQ29sdW1uKCkgewogICAgICAgIHJldHVybiBf\nc2VxQ29sdW1uTmFtZTsKICAgIH0KCiAgICAvKioKICAgICAqIFRoZSBuYW1l\nIG9mIHRoZSBjb2x1bW4gdGhhdCBob2xkcyB0aGUgc2VxdWVuY2UgdmFsdWUu\nIERlZmF1bHRzCiAgICAgKiB0byA8Y29kZT5TRVFVRU5DRV9WQUxVRTwvY29k\nZT4uCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldFNlcXVlbmNlQ29sdW1u\nKFN0cmluZyBzZXF1ZW5jZUNvbHVtbikgewogICAgICAgIF9zZXFDb2x1bW5O\nYW1lID0gc2VxdWVuY2VDb2x1bW47CiAgICB9CgogICAgLyoqCiAgICAgKiBU\naGUgbmFtZSBvZiB0aGUgdGFibGUncyBwcmltYXJ5IGtleSBjb2x1bW4uIERl\nZmF1bHRzIHRvCiAgICAgKiA8Y29kZT5JRDwvY29kZT4uCiAgICAgKi8KICAg\nIHB1YmxpYyBTdHJpbmcgZ2V0UHJpbWFyeUtleUNvbHVtbigpIHsKICAgICAg\nICByZXR1cm4gX3BrQ29sdW1uTmFtZTsKICAgIH0KCiAgICAvKioKICAgICAq\nIFRoZSBuYW1lIG9mIHRoZSB0YWJsZSdzIHByaW1hcnkga2V5IGNvbHVtbi4g\nRGVmYXVsdHMgdG8KICAgICAqIDxjb2RlPklEPC9jb2RlPi4KICAgICAqLwog\nICAgcHVibGljIHZvaWQgc2V0UHJpbWFyeUtleUNvbHVtbihTdHJpbmcgcHJp\nbWFyeUtleUNvbHVtbikgewogICAgICAgIF9wa0NvbHVtbk5hbWUgPSBwcmlt\nYXJ5S2V5Q29sdW1uOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRo\nZSBudW1iZXIgb2Ygc2VxdWVuY2VzIHRvIGFsbG9jYXRlIGZvciBlYWNoIHVw\nZGF0ZSBvZiB0aGUKICAgICAqIHNlcXVlbmNlIHRhYmxlLiBTZXF1ZW5jZSBu\ndW1iZXJzIHdpbGwgYmUgZ3JhYmJlZCBpbiBibG9ja3Mgb2YgdGhpcwogICAg\nICogdmFsdWUgdG8gcmVkdWNlIHRoZSBudW1iZXIgb2YgdHJhbnNhY3Rpb25z\nIHRoYXQgbXVzdCBiZSBwZXJmb3JtZWQgb24KICAgICAqIHRoZSBzZXF1ZW5j\nZSB0YWJsZS4KICAgICAqLwogICAgcHVibGljIGludCBnZXRBbGxvY2F0ZSgp\nIHsKICAgICAgICByZXR1cm4gX2FsbG9jOwogICAgfQoKICAgIC8qKgogICAg\nICogUmV0dXJuIHRoZSBudW1iZXIgb2Ygc2VxdWVuY2VzIHRvIGFsbG9jYXRl\nIGZvciBlYWNoIHVwZGF0ZSBvZiB0aGUKICAgICAqIHNlcXVlbmNlIHRhYmxl\nLiBTZXF1ZW5jZSBudW1iZXJzIHdpbGwgYmUgZ3JhYmJlZCBpbiBibG9ja3Mg\nb2YgdGhpcwogICAgICogdmFsdWUgdG8gcmVkdWNlIHRoZSBudW1iZXIgb2Yg\ndHJhbnNhY3Rpb25zIHRoYXQgbXVzdCBiZSBwZXJmb3JtZWQgb24KICAgICAq\nIHRoZSBzZXF1ZW5jZSB0YWJsZS4KICAgICAqLwogICAgcHVibGljIHZvaWQg\nc2V0QWxsb2NhdGUoaW50IGFsbG9jKSB7CiAgICAgICAgX2FsbG9jID0gYWxs\nb2M7CiAgICB9CiAgICAKICAgIC8qKgogICAgICogUmV0dXJuIHRoZSBudW1i\nZXIgYXMgdGhlIGluaXRpYWwgbnVtYmVyIGZvciB0aGUgCiAgICAgKiBHZW5l\ncmF0ZWRWYWx1ZS5UQUJMRSBzdHJhdGVneSB0byBzdGFydCB3aXRoLiAKICAg\nICAqIEByZXR1cm4gYW4gaW5pdGlhbCBudW1iZXIKICAgICAqLwogICAgcHVi\nbGljIGludCBnZXRJbml0aWFsVmFsdWUoKSB7ICAgICAgICAKICAgICAgICBy\nZXR1cm4gX2ludFZhbHVlOwogICAgfQoKICAgIC8qKgogICAgICogU2V0IHRo\nZSBpbml0aWFsIG51bWJlciBpbiB0aGUgdGFibGUgZm9yIHRoZSBHZW5lcmF0\nZWRWYWx1ZS5UQUJMRQogICAgICogc3RyYXRlZ3kgdG8gdXNlIGFzIGluaXRp\nYWwgbnVtYmVyLiAKICAgICAqIEBwYXJhbSBpbnRWYWx1ZS4gVGhlIGluaXRp\nYWwgbnVtYmVyCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldEluaXRpYWxW\nYWx1ZShpbnQgaW50VmFsdWUpIHsKICAgICAgICBfaW50VmFsdWUgPSBpbnRW\nYWx1ZTsKICAgIH0KCiAgICAvKioKICAgICAqIEBkZXByZWNhdGVkIFVzZSB7\nQGxpbmsgI3NldEFsbG9jYXRlfS4gUmV0YWluZWQgZm9yIGJhY2t3YXJkcwog\nICAgICogY29tcGF0aWJpbGl0eSBvZiBhdXRvLWNvbmZpZ3VyYXRpb24uCiAg\nICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldEluY3JlbWVudChpbnQgaW5jKSB7\nCiAgICAgICAgc2V0QWxsb2NhdGUoaW5jKTsKICAgIH0KCiAgICBwdWJsaWMg\nSkRCQ0NvbmZpZ3VyYXRpb24gZ2V0Q29uZmlndXJhdGlvbigpIHsKICAgICAg\nICByZXR1cm4gX2NvbmY7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0Q29u\nZmlndXJhdGlvbihDb25maWd1cmF0aW9uIGNvbmYpIHsKICAgICAgICBfY29u\nZiA9IChKREJDQ29uZmlndXJhdGlvbikgY29uZjsKICAgICAgICBfbG9nID0g\nX2NvbmYuZ2V0TG9nKEpEQkNDb25maWd1cmF0aW9uLkxPR19SVU5USU1FKTsK\nICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzdGFydENvbmZpZ3VyYXRpb24oKSB7\nCiAgICB9CgogICAgcHVibGljIHZvaWQgZW5kQ29uZmlndXJhdGlvbigpIHsK\nICAgICAgICBidWlsZFRhYmxlKCk7CiAgICB9CiAgICAKCiAgICBwdWJsaWMg\ndm9pZCBhZGRTY2hlbWEoQ2xhc3NNYXBwaW5nIG1hcHBpbmcsIFNjaGVtYUdy\nb3VwIGdyb3VwKSB7CiAgICAgICAgLy8gU2luY2UgdGhlIHRhYmxlIGlzIGNy\nZWF0ZWQgYnkgb3BlbmpwYSBpbnRlcm5hbGx5CiAgICAgICAgLy8gd2UgY2Fu\nIGNyZWF0ZSB0aGUgdGFibGUgZm9yIGVhY2ggc2NoZW1hIHdpdGhpbiB0aGUg\nUFUKICAgICAgICAvLyBpbiBoZXJlLgogICAgICAgIAogICAgICAgIFNjaGVt\nYVtdIHNjaGVtYXMgPSBncm91cC5nZXRTY2hlbWFzKCk7CiAgICAgICAgZm9y\nIChpbnQgaSA9IDA7IGkgPCBzY2hlbWFzLmxlbmd0aDsgaSsrKSB7CiAgICAg\nICAgICAgIFN0cmluZyBzY2hlbWFOYW1lID0gU3RyaW5ncy5nZXRQYWNrYWdl\nTmFtZShfdGFibGUpOwogICAgICAgICAgICBpZiAoc2NoZW1hTmFtZS5sZW5n\ndGgoKSA9PSAwKQogICAgICAgICAgICAgICAgc2NoZW1hTmFtZSA9IFNjaGVt\nYXMuZ2V0TmV3VGFibGVTY2hlbWEoX2NvbmYpOwogICAgICAgICAgICBpZiAo\nc2NoZW1hTmFtZSA9PSBudWxsKQogICAgICAgICAgICAgICAgc2NoZW1hTmFt\nZSA9IHNjaGVtYXNbaV0uZ2V0TmFtZSgpOwoKICAgICAgICAgICAgLy8gY3Jl\nYXRlIHRhYmxlIGluIHRoaXMgZ3JvdXAKICAgICAgICAgICAgU2NoZW1hIHNj\naGVtYSA9IGdyb3VwLmdldFNjaGVtYShzY2hlbWFOYW1lKTsKICAgICAgICAg\nICAgaWYgKHNjaGVtYSA9PSBudWxsKQogICAgICAgICAgICAgICAgc2NoZW1h\nID0gZ3JvdXAuYWRkU2NoZW1hKHNjaGVtYU5hbWUpOwogICAgICAgICAgICAK\nICAgICAgICAgICAgc2NoZW1hLmltcG9ydFRhYmxlKF9wa0NvbHVtbi5nZXRU\nYWJsZSgpKTsKICAgICAgICAgICAgLy8gd2UgbmVlZCB0byByZXNldCB0aGUg\ndGFibGUgbmFtZSBpbiB0aGUgY29sdW1uIHdpdGggdGhlCiAgICAgICAgICAg\nIC8vIGZ1bGx5IHF1YWxpZmllZCBuYW1lIGZvciBtYXRjaGluZyB0aGUgdGFi\nbGUgbmFtZSBmcm9tIHRoZQogICAgICAgICAgICAvLyBDb2x1bW4uCiAgICAg\nICAgICAgIF9wa0NvbHVtbi5yZXNldFRhYmxlTmFtZShzY2hlbWFOYW1lICsg\nIi4iCiAgICAgICAgICAgICAgICAgICAgKyBfcGtDb2x1bW4uZ2V0VGFibGVO\nYW1lKCkpOwogICAgICAgICAgICAvLyBzb21lIGRhdGFiYXNlcyByZXF1aXJl\nIHRvIGNyZWF0ZSBhbiBpbmRleCBmb3IgdGhlIHNlcXVlbmNlIHRhYmxlCiAg\nICAgICAgICAgIF9jb25mLmdldERCRGljdGlvbmFyeUluc3RhbmNlKCkuY3Jl\nYXRlSW5kZXhJZk5lY2Vzc2FyeShzY2hlbWEsCiAgICAgICAgICAgICAgICAg\nICAgX3RhYmxlLCBfcGtDb2x1bW4pOwogICAgICAgICAKICAgICAgICB9CiAg\nICB9CgogICAgcHJvdGVjdGVkIE9iamVjdCBuZXh0SW50ZXJuYWwoSkRCQ1N0\nb3JlIHN0b3JlLCBDbGFzc01hcHBpbmcgbWFwcGluZykKICAgICAgICB0aHJv\nd3MgRXhjZXB0aW9uIHsKICAgICAgICAvLyBpZiBuZWVkZWQsIGdyYWIgdGhl\nIG5leHQgaGFuZGZ1bCBvZiBpZHMKICAgICAgICBTdGF0dXMgc3RhdCA9IGdl\ndFN0YXR1cyhtYXBwaW5nKTsKICAgICAgICBpZiAoc3RhdCA9PSBudWxsKQog\nICAgICAgICAgICB0aHJvdyBuZXcgSW52YWxpZFN0YXRlRXhjZXB0aW9uKF9s\nb2MuZ2V0KCJiYWQtc2VxLXR5cGUiLAogICAgICAgICAgICAgICAgZ2V0Q2xh\nc3MoKSwgbWFwcGluZykpOwoKICAgICAgICB3aGlsZSAodHJ1ZSkgewogICAg\nICAgICAgICBzeW5jaHJvbml6ZWQgKHN0YXQpIHsKICAgICAgICAgICAgICAg\nIC8vIG1ha2Ugc3VyZSBzZXEgaXMgYXQgbGVhc3QgMSwgc2luY2UgYXV0b2Fz\nc2lnbmVkIGlkcyBvZiAwIGNhbgogICAgICAgICAgICAgICAgLy8gY29uZmxp\nY3Qgd2l0aCB1bmluaXRpYWxpemVkIHZhbHVlcwogICAgICAgICAgICAgICAg\nc3RhdC5zZXEgPSBNYXRoLm1heChzdGF0LnNlcSwgMSk7CiAgICAgICAgICAg\nICAgICBpZiAoc3RhdC5zZXEgPCBzdGF0Lm1heCkKICAgICAgICAgICAgICAg\nICAgICByZXR1cm4gTnVtYmVycy52YWx1ZU9mKHN0YXQuc2VxKyspOwogICAg\nICAgICAgICB9CiAgICAgICAgICAgIGFsbG9jYXRlU2VxdWVuY2Uoc3RvcmUs\nIG1hcHBpbmcsIHN0YXQsIF9hbGxvYywgdHJ1ZSk7CiAgICAgICAgfQogICAg\nfQoKICAgIHByb3RlY3RlZCBPYmplY3QgY3VycmVudEludGVybmFsKEpEQkNT\ndG9yZSBzdG9yZSwgQ2xhc3NNYXBwaW5nIG1hcHBpbmcpCiAgICAgICAgdGhy\nb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgaWYgKGN1cnJlbnQgPT0gbnVsbCkg\newogICAgICAgICAgICBDb25uZWN0aW9uIGNvbm4gPSBnZXRDb25uZWN0aW9u\nKHN0b3JlKTsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIGxv\nbmcgY3VyID0gZ2V0U2VxdWVuY2UobWFwcGluZywgY29ubik7CiAgICAgICAg\nICAgICAgICBpZiAoY3VyICE9IC0xKQogICAgICAgICAgICAgICAgICAgIGN1\ncnJlbnQgPSBOdW1iZXJzLnZhbHVlT2YoY3VyKTsKICAgICAgICAgICAgfSBm\naW5hbGx5IHsKICAgICAgICAgICAgICAgIGNsb3NlQ29ubmVjdGlvbihjb25u\nKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4gc3Vw\nZXIuY3VycmVudEludGVybmFsKHN0b3JlLCBtYXBwaW5nKTsKICAgIH0KCiAg\nICBwcm90ZWN0ZWQgdm9pZCBhbGxvY2F0ZUludGVybmFsKGludCBjb3VudCwg\nSkRCQ1N0b3JlIHN0b3JlLAogICAgICAgIENsYXNzTWFwcGluZyBtYXBwaW5n\nKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIFN0YXR1\ncyBzdGF0ID0gZ2V0U3RhdHVzKG1hcHBpbmcpOwogICAgICAgIGlmIChzdGF0\nID09IG51bGwpCiAgICAgICAgICAgIHJldHVybjsKCiAgICAgICAgd2hpbGUg\nKHRydWUpIHsKICAgICAgICAgICAgaW50IGF2YWlsYWJsZTsKICAgICAgICAg\nICAgc3luY2hyb25pemVkIChzdGF0KSB7CiAgICAgICAgICAgICAgICBhdmFp\nbGFibGUgPSAoaW50KSAoc3RhdC5tYXggLSBzdGF0LnNlcSk7CiAgICAgICAg\nICAgICAgICBpZiAoYXZhaWxhYmxlID49IGNvdW50KQogICAgICAgICAgICAg\nICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAgICAgICBhbGxv\nY2F0ZVNlcXVlbmNlKHN0b3JlLCBtYXBwaW5nLCBzdGF0LCBjb3VudCAtIGF2\nYWlsYWJsZSwgZmFsc2UpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAg\nICAqIFJldHVybiB0aGUgYXBwcm9wcmlhdGUgc3RhdHVzIG9iamVjdCBmb3Ig\ndGhlIGdpdmVuIGNsYXNzLCBvciBudWxsCiAgICAgKiBpZiBjYW5ub3QgaGFu\nZGxlIHRoZSBnaXZlbiBjbGFzcy4gVGhlIG1hcHBpbmcgbWF5IGJlIG51bGwu\nCiAgICAgKi8KICAgIHByb3RlY3RlZCBTdGF0dXMgZ2V0U3RhdHVzKENsYXNz\nTWFwcGluZyBtYXBwaW5nKSB7ICAKICAgICAgICBTdGF0dXMgc3RhdHVzID0g\nKFN0YXR1cylfc3RhdC5nZXQobWFwcGluZyk7ICAgICAgICAKICAgICAgICBp\nZiAoc3RhdHVzID09IG51bGwpeyAKICAgICAgICAgICAgc3RhdHVzID0gbmV3\nIFN0YXR1cygpOwogICAgICAgICAgICBfc3RhdC5wdXQobWFwcGluZywgc3Rh\ndHVzKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHN0YXR1czsKICAgICAg\nICAgICAgCiAgICB9CgogICAgLyoqCiAgICAgKiBBZGQgdGhlIHByaW1hcnkg\na2V5IGNvbHVtbiB0byB0aGUgZ2l2ZW4gdGFibGUgYW5kIHJldHVybiBpdC4K\nICAgICAqLwogICAgcHJvdGVjdGVkIENvbHVtbiBhZGRQcmltYXJ5S2V5Q29s\ndW1uKFRhYmxlIHRhYmxlKSB7CiAgICAgICAgREJEaWN0aW9uYXJ5IGRpY3Qg\nPSBfY29uZi5nZXREQkRpY3Rpb25hcnlJbnN0YW5jZSgpOwogICAgICAgIENv\nbHVtbiBwa0NvbHVtbiA9IHRhYmxlLmFkZENvbHVtbihkaWN0LmdldFZhbGlk\nQ29sdW1uTmFtZQogICAgICAgICAgICAoZ2V0UHJpbWFyeUtleUNvbHVtbigp\nLCB0YWJsZSkpOwogICAgICAgIHBrQ29sdW1uLnNldFR5cGUoZGljdC5nZXRQ\ncmVmZXJyZWRUeXBlKFR5cGVzLlRJTllJTlQpKTsKICAgICAgICBwa0NvbHVt\nbi5zZXRKYXZhVHlwZShKYXZhVHlwZXMuSU5UKTsKICAgICAgICByZXR1cm4g\ncGtDb2x1bW47CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIHBy\naW1hcnkga2V5IHZhbHVlIGZvciB0aGUgZ2l2ZW4gY2xhc3MuCiAgICAgKi8K\nICAgIHByb3RlY3RlZCBPYmplY3QgZ2V0UHJpbWFyeUtleShDbGFzc01hcHBp\nbmcgbWFwcGluZykgewogICAgICAgIHJldHVybiBOdW1iZXJzLnZhbHVlT2Yo\nMCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBDcmVhdGVzIHRoZSBvYmplY3Qt\nbGV2ZWwgcmVwcmVzZW50YXRpb24gb2YgdGhlIHNlcXVlbmNlIHRhYmxlLgog\nICAgICovCiAgICBwcml2YXRlIHZvaWQgYnVpbGRUYWJsZSgpIHsKICAgICAg\nICBTdHJpbmcgdGFibGVOYW1lID0gU3RyaW5ncy5nZXRDbGFzc05hbWUoX3Rh\nYmxlKTsKICAgICAgICBTdHJpbmcgc2NoZW1hTmFtZSA9IFN0cmluZ3MuZ2V0\nUGFja2FnZU5hbWUoX3RhYmxlKTsKICAgICAgICBpZiAoc2NoZW1hTmFtZS5s\nZW5ndGgoKSA9PSAwKQogICAgICAgICAgICBzY2hlbWFOYW1lID0gU2NoZW1h\ncy5nZXROZXdUYWJsZVNjaGVtYShfY29uZik7CgogICAgICAgIFNjaGVtYUdy\nb3VwIGdyb3VwID0gbmV3IFNjaGVtYUdyb3VwKCk7CiAgICAgICAgU2NoZW1h\nIHNjaGVtYSA9IGdyb3VwLmFkZFNjaGVtYShzY2hlbWFOYW1lKTsKCiAgICAg\nICAgVGFibGUgdGFibGUgPSBzY2hlbWEuYWRkVGFibGUodGFibGVOYW1lKTsK\nICAgICAgICBfcGtDb2x1bW4gPSBhZGRQcmltYXJ5S2V5Q29sdW1uKHRhYmxl\nKTsKICAgICAgICBQcmltYXJ5S2V5IHBrID0gdGFibGUuYWRkUHJpbWFyeUtl\neSgpOwogICAgICAgIHBrLmFkZENvbHVtbihfcGtDb2x1bW4pOwoKICAgICAg\nICBEQkRpY3Rpb25hcnkgZGljdCA9IF9jb25mLmdldERCRGljdGlvbmFyeUlu\nc3RhbmNlKCk7CiAgICAgICAgX3NlcUNvbHVtbiA9IHRhYmxlLmFkZENvbHVt\nbihkaWN0LmdldFZhbGlkQ29sdW1uTmFtZQogICAgICAgICAgICAoX3NlcUNv\nbHVtbk5hbWUsIHRhYmxlKSk7CiAgICAgICAgX3NlcUNvbHVtbi5zZXRUeXBl\nKGRpY3QuZ2V0UHJlZmVycmVkVHlwZShUeXBlcy5CSUdJTlQpKTsKICAgICAg\nICBfc2VxQ29sdW1uLnNldEphdmFUeXBlKEphdmFUeXBlcy5MT05HKTsKICAg\nIH0KCiAgICAvKioKICAgICAqIFVwZGF0ZXMgdGhlIG1heCBhdmFpbGFibGUg\nc2VxdWVuY2UgdmFsdWUuCiAgICAgKi8KICAgIHByaXZhdGUgdm9pZCBhbGxv\nY2F0ZVNlcXVlbmNlKEpEQkNTdG9yZSBzdG9yZSwgQ2xhc3NNYXBwaW5nIG1h\ncHBpbmcsCiAgICAgICAgU3RhdHVzIHN0YXQsIGludCBhbGxvYywgYm9vbGVh\nbiB1cGRhdGVTdGF0U2VxKSAKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9u\nIHsKICAgICAgICBDb25uZWN0aW9uIGNvbm4gPSBnZXRDb25uZWN0aW9uKHN0\nb3JlKTsKICAgICAgICB0cnkgeyAKICAgICAgICAgICAgaWYgKHNldFNlcXVl\nbmNlKG1hcHBpbmcsIHN0YXQsIGFsbG9jLCB1cGRhdGVTdGF0U2VxLCBjb25u\nKSkKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9IGNhdGNoIChT\nUUxFeGNlcHRpb24gc2UpIHsKICAgICAgICAgICAgdGhyb3cgU1FMRXhjZXB0\naW9ucy5nZXRTdG9yZShfbG9jLmdldCgiYmFkLXNlcS11cCIsIF90YWJsZSks\nCiAgICAgICAgICAgICAgICBzZSwgX2NvbmYuZ2V0REJEaWN0aW9uYXJ5SW5z\ndGFuY2UoKSk7CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgY2xv\nc2VDb25uZWN0aW9uKGNvbm4pOwogICAgICAgIH0KICAgICAgICAKICAgICAg\nICB0cnkgewogICAgICAgICAgICAvLyBwb3NzaWJsZSB0aGF0IHdlIG1pZ2h0\nIGdldCBlcnJvcnMgd2hlbiBpbnNlcnRpbmcgaWYKICAgICAgICAgICAgLy8g\nYW5vdGhlciB0aHJlYWQvcHJvY2VzcyBpcyBpbnNlcnRpbmcgc2FtZSBwayBh\ndCBzYW1lIHRpbWUKICAgICAgICAgICAgU1FMRXhjZXB0aW9uIGVyciA9IG51\nbGw7IAogICAgICAgICAgICAvLyAjIyMgd2h5IGRvZXMgdGhpcyBub3QgY2Fs\nbCBnZXRDb25uZWN0aW9uKCkgLyBjbG9zZUNvbm5lY3Rpb24oKT8KICAgICAg\nICAgICAgY29ubiA9IF9jb25mLmdldERhdGFTb3VyY2UyKHN0b3JlLmdldENv\nbnRleHQoKSkuZ2V0Q29ubmVjdGlvbigpOwogICAgICAgICAgICB0cnkgewog\nICAgICAgICAgICAgICAgaW5zZXJ0U2VxdWVuY2UobWFwcGluZywgY29ubik7\nCiAgICAgICAgICAgIH0gY2F0Y2ggKFNRTEV4Y2VwdGlvbiBzZSkgewogICAg\nICAgICAgICAgICAgZXJyID0gc2U7CiAgICAgICAgICAgIH0gZmluYWxseSB7\nCiAgICAgICAgICAgICAgICB0cnkgeyBjb25uLmNsb3NlKCk7IH0gY2F0Y2gg\nKFNRTEV4Y2VwdGlvbiBzZSkge30KICAgICAgICAgICAgfQoKICAgICAgICAg\nICAgLy8gbm93IHdlIHNob3VsZCBiZSBhYmxlIHRvIHVwZGF0ZS4uLgogICAg\nICAgICAgICBjb25uID0gZ2V0Q29ubmVjdGlvbihzdG9yZSk7CiAgICAgICAg\nICAgIHRyeSB7CiAgICAgICAgICAgICAgICBpZiAoIXNldFNlcXVlbmNlKG1h\ncHBpbmcsIHN0YXQsIGFsbG9jLCB1cGRhdGVTdGF0U2VxLCBjb25uKSkKICAg\nICAgICAgICAgICAgICAgICB0aHJvdyAoZXJyICE9IG51bGwpID8gZXJyIDog\nbmV3IFNRTEV4Y2VwdGlvbihfbG9jLmdldAogICAgICAgICAgICAgICAgICAg\nICAgICAoIm5vLXNlcS1yb3ciLCBtYXBwaW5nLCBfdGFibGUpLmdldE1lc3Nh\nZ2UoKSk7CiAgICAgICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgICAg\nICBjbG9zZUNvbm5lY3Rpb24oY29ubik7CiAgICAgICAgICAgIH0KICAgICAg\nICB9IGNhdGNoIChTUUxFeGNlcHRpb24gc2UyKSB7CiAgICAgICAgICAgIHRo\ncm93IFNRTEV4Y2VwdGlvbnMuZ2V0U3RvcmUoX2xvYy5nZXQoImJhZC1zZXEt\ndXAiLCBfdGFibGUpLAogICAgICAgICAgICAgICAgc2UyLCBfY29uZi5nZXRE\nQkRpY3Rpb25hcnlJbnN0YW5jZSgpKTsKICAgICAgICB9IAogICAgfQoKICAg\nIC8qKgogICAgICogSW5zZXJ0cyB0aGUgaW5pdGlhbCBzZXF1ZW5jZSBpbmZv\ncm1hdGlvbiBpbnRvIHRoZSBkYXRhYmFzZSwgaWYgYW55LgogICAgICovCiAg\nICBwcml2YXRlIHZvaWQgaW5zZXJ0U2VxdWVuY2UoQ2xhc3NNYXBwaW5nIG1h\ncHBpbmcsIENvbm5lY3Rpb24gY29ubikKICAgICAgICB0aHJvd3MgU1FMRXhj\nZXB0aW9uIHsKICAgICAgICBpZiAoX2xvZy5pc1RyYWNlRW5hYmxlZCgpKQog\nICAgICAgICAgICBfbG9nLnRyYWNlKF9sb2MuZ2V0KCJpbnNlcnQtc2VxIikp\nOwoKICAgICAgICBPYmplY3QgcGsgPSBnZXRQcmltYXJ5S2V5KG1hcHBpbmcp\nOwogICAgICAgIGlmIChwayA9PSBudWxsKQogICAgICAgICAgICB0aHJvdyBu\nZXcgSW52YWxpZFN0YXRlRXhjZXB0aW9uKF9sb2MuZ2V0KCJiYWQtc2VxLXR5\ncGUiLAogICAgICAgICAgICAgICAgZ2V0Q2xhc3MoKSwgbWFwcGluZykpOwoK\nICAgICAgICBEQkRpY3Rpb25hcnkgZGljdCA9IF9jb25mLmdldERCRGljdGlv\nbmFyeUluc3RhbmNlKCk7CiAgICAgICAgU3RyaW5nIHRhYmxlTmFtZSA9IHJl\nc29sdmVUYWJsZU5hbWUobWFwcGluZywgX3BrQ29sdW1uLmdldFRhYmxlKCkp\nOwogICAgICAgIFNRTEJ1ZmZlciBpbnNlcnQgPSBuZXcgU1FMQnVmZmVyKGRp\nY3QpLmFwcGVuZCgiSU5TRVJUIElOVE8gIikuCiAgICAgICAgICAgIGFwcGVu\nZCh0YWJsZU5hbWUpLmFwcGVuZCgiICgiKS4KICAgICAgICAgICAgYXBwZW5k\nKF9wa0NvbHVtbikuYXBwZW5kKCIsICIpLmFwcGVuZChfc2VxQ29sdW1uKS4K\nICAgICAgICAgICAgYXBwZW5kKCIpIFZBTFVFUyAoIikuCiAgICAgICAgICAg\nIGFwcGVuZFZhbHVlKHBrLCBfcGtDb2x1bW4pLmFwcGVuZCgiLCAiKS4KICAg\nICAgICAgICAgYXBwZW5kVmFsdWUoX2ludFZhbHVlLCBfc2VxQ29sdW1uKS5h\ncHBlbmQoIikiKTsKICAgICAgICAKICAgICAgICBib29sZWFuIHdhc0F1dG8g\nPSBjb25uLmdldEF1dG9Db21taXQoKTsKICAgICAgICBpZiAoIXdhc0F1dG8g\nJiYgIXN1c3BlbmRJbkpUQSgpKQogICAgICAgICAgICBjb25uLnNldEF1dG9D\nb21taXQodHJ1ZSk7CgogICAgICAgIFByZXBhcmVkU3RhdGVtZW50IHN0bW50\nID0gbnVsbDsKICAgICAgICB0cnkgewogICAgICAgICAgICBzdG1udCA9IHBy\nZXBhcmVTdGF0ZW1lbnQoY29ubiwgaW5zZXJ0KTsKICAgICAgICAgICAgZXhl\nY3V0ZVVwZGF0ZShfY29uZiwgY29ubiwgc3RtbnQsIGluc2VydCwgUm93SW1w\nbC5BQ1RJT05fSU5TRVJUKTsKICAgICAgICB9IGZpbmFsbHkgewogICAgICAg\nICAgICBpZiAoc3RtbnQgIT0gbnVsbCkKICAgICAgICAgICAgICAgIHRyeSB7\nIHN0bW50LmNsb3NlKCk7IH0gY2F0Y2ggKFNRTEV4Y2VwdGlvbiBzZSkge30K\nICAgICAgICAgICAgaWYgKCF3YXNBdXRvICYmICFzdXNwZW5kSW5KVEEoKSkK\nICAgICAgICAgICAgICAgIGNvbm4uc2V0QXV0b0NvbW1pdChmYWxzZSk7CiAg\nICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRoZSBjdXJy\nZW50IHNlcXVlbmNlIHZhbHVlLCBvciAtMSBpZiB1bmF0dGFpbmFibGUuCiAg\nICAgKi8KICAgIHByb3RlY3RlZCBsb25nIGdldFNlcXVlbmNlKENsYXNzTWFw\ncGluZyBtYXBwaW5nLCBDb25uZWN0aW9uIGNvbm4pCiAgICAgICAgdGhyb3dz\nIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgaWYgKF9sb2cuaXNUcmFjZUVuYWJs\nZWQoKSkKICAgICAgICAgICAgX2xvZy50cmFjZShfbG9jLmdldCgiZ2V0LXNl\ncSIpKTsKCiAgICAgICAgT2JqZWN0IHBrID0gZ2V0UHJpbWFyeUtleShtYXBw\naW5nKTsKICAgICAgICBpZiAocGsgPT0gbnVsbCkKICAgICAgICAgICAgcmV0\ndXJuIC0xOwoKICAgICAgICBEQkRpY3Rpb25hcnkgZGljdCA9IF9jb25mLmdl\ndERCRGljdGlvbmFyeUluc3RhbmNlKCk7CiAgICAgICAgU1FMQnVmZmVyIHNl\nbCA9IG5ldyBTUUxCdWZmZXIoZGljdCkuYXBwZW5kKF9zZXFDb2x1bW4pOwog\nICAgICAgIFNRTEJ1ZmZlciB3aGVyZSA9IG5ldyBTUUxCdWZmZXIoZGljdCku\nYXBwZW5kKF9wa0NvbHVtbikuYXBwZW5kKCIgPSAiKS4KICAgICAgICAgICAg\nYXBwZW5kVmFsdWUocGssIF9wa0NvbHVtbik7CiAgICAgICAgU3RyaW5nIHRh\nYmxlTmFtZSA9IHJlc29sdmVUYWJsZU5hbWUobWFwcGluZywgX3NlcUNvbHVt\nbi5nZXRUYWJsZSgpKTsKICAgICAgICBTUUxCdWZmZXIgdGFibGVzID0gbmV3\nIFNRTEJ1ZmZlcihkaWN0KS5hcHBlbmQodGFibGVOYW1lKTsKCiAgICAgICAg\nU1FMQnVmZmVyIHNlbGVjdCA9IGRpY3QudG9TZWxlY3Qoc2VsLCBudWxsLCB0\nYWJsZXMsIHdoZXJlLCBudWxsLCBudWxsLAogICAgICAgICAgICAgICAgbnVs\nbCwgZmFsc2UsIGRpY3Quc3VwcG9ydHNTZWxlY3RGb3JVcGRhdGUsIDAsIExv\nbmcuTUFYX1ZBTFVFLAogICAgICAgICAgICAgICAgZmFsc2UsIHRydWUpOwoK\nICAgICAgICBQcmVwYXJlZFN0YXRlbWVudCBzdG1udCA9IHByZXBhcmVTdGF0\nZW1lbnQoY29ubiwgc2VsZWN0KTsKICAgICAgICBSZXN1bHRTZXQgcnMgPSBu\ndWxsOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIHJzID0gZXhlY3V0ZVF1\nZXJ5KF9jb25mLCBjb25uLCBzdG1udCwgc2VsZWN0KTsKICAgICAgICAgICAg\ncmV0dXJuIGdldFNlcXVlbmNlKHJzLCBkaWN0KTsKICAgICAgICB9IGZpbmFs\nbHkgewogICAgICAgICAgICBpZiAocnMgIT0gbnVsbCkKICAgICAgICAgICAg\nICAgIHRyeSB7IHJzLmNsb3NlKCk7IH0gY2F0Y2ggKFNRTEV4Y2VwdGlvbiBz\nZSkge30KICAgICAgICAgICAgaWYgKHN0bW50ICE9IG51bGwpICAgIAogICAg\nICAgICAgICAgICAgdHJ5IHsgc3RtbnQuY2xvc2UoKTsgfSBjYXRjaCAoU1FM\nRXhjZXB0aW9uIHNlKSB7fQogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAg\nICAqIEdyYWJzIHRoZSBuZXh0IGhhbmRmdWwgb2Ygc2VxdWVuY2UgbnVtYmVy\ncy4KICAgICAqCiAgICAgKiBAcmV0dXJuIHRydWUgaWYgdGhlIHNlcXVlbmNl\nIHdhcyB1cGRhdGVkLCBmYWxzZSBpZiBubyBzZXF1ZW5jZQogICAgICogcm93\nIGV4aXN0ZWQgZm9yIHRoaXMgbWFwcGluZwogICAgICovCiAgICBwcm90ZWN0\nZWQgYm9vbGVhbiBzZXRTZXF1ZW5jZShDbGFzc01hcHBpbmcgbWFwcGluZywg\nU3RhdHVzIHN0YXQsIGludCBpbmMsCiAgICAgICAgYm9vbGVhbiB1cGRhdGVT\ndGF0U2VxLCBDb25uZWN0aW9uIGNvbm4pCiAgICAgICAgdGhyb3dzIFNRTEV4\nY2VwdGlvbiB7CiAgICAgICAgaWYgKF9sb2cuaXNUcmFjZUVuYWJsZWQoKSkK\nICAgICAgICAgICAgX2xvZy50cmFjZShfbG9jLmdldCgidXBkYXRlLXNlcSIp\nKTsKCiAgICAgICAgT2JqZWN0IHBrID0gZ2V0UHJpbWFyeUtleShtYXBwaW5n\nKTsKICAgICAgICBpZiAocGsgPT0gbnVsbCkKICAgICAgICAgICAgdGhyb3cg\nbmV3IEludmFsaWRTdGF0ZUV4Y2VwdGlvbihfbG9jLmdldCgiYmFkLXNlcS10\neXBlIiwKICAgICAgICAgICAgICAgIGdldENsYXNzKCksIG1hcHBpbmcpKTsK\nCiAgICAgICAgREJEaWN0aW9uYXJ5IGRpY3QgPSBfY29uZi5nZXREQkRpY3Rp\nb25hcnlJbnN0YW5jZSgpOyAgICAgICAgCiAgICAgICAgU1FMQnVmZmVyIHdo\nZXJlID0gbmV3IFNRTEJ1ZmZlcihkaWN0KS5hcHBlbmQoX3BrQ29sdW1uKS5h\ncHBlbmQoIiA9ICIpLgogICAgICAgICAgICBhcHBlbmRWYWx1ZShwaywgX3Br\nQ29sdW1uKTsKCiAgICAgICAgLy8gbG9vcCB1bnRpbCB3ZSBoYXZlIGEgc3Vj\nY2Vzc2Z1bCBhdG9taWMgc2VsZWN0L3VwZGF0ZSBzZXF1ZW5jZQogICAgICAg\nIGxvbmcgY3VyID0gMDsKICAgICAgICBQcmVwYXJlZFN0YXRlbWVudCBzdG1u\ndDsKICAgICAgICBSZXN1bHRTZXQgcnM7CiAgICAgICAgU1FMQnVmZmVyIHVw\nZDsKICAgICAgICBmb3IgKGludCB1cGRhdGVzID0gMDsgdXBkYXRlcyA9PSAw\nOykgewogICAgICAgICAgICBzdG1udCA9IG51bGw7CiAgICAgICAgICAgIHJz\nID0gbnVsbDsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIGN1\nciA9IGdldFNlcXVlbmNlKG1hcHBpbmcsIGNvbm4pOwogICAgICAgICAgICAg\nICAgaWYgKGN1ciA9PSAtMSkKICAgICAgICAgICAgICAgICAgICByZXR1cm4g\nZmFsc2U7CgogICAgICAgICAgICAgICAgLy8gdXBkYXRlIHRoZSB2YWx1ZQog\nICAgICAgICAgICAgICAgdXBkID0gbmV3IFNRTEJ1ZmZlcihkaWN0KTsKICAg\nICAgICAgICAgICAgIFN0cmluZyB0YWJsZU5hbWUgPSByZXNvbHZlVGFibGVO\nYW1lKG1hcHBpbmcsIF9zZXFDb2x1bW4uZ2V0VGFibGUoKSk7CiAgICAgICAg\nICAgICAgICB1cGQuYXBwZW5kKCJVUERBVEUgIikuYXBwZW5kKHRhYmxlTmFt\nZSkuCiAgICAgICAgICAgICAgICAgICAgYXBwZW5kKCIgU0VUICIpLmFwcGVu\nZChfc2VxQ29sdW1uKS5hcHBlbmQoIiA9ICIpLgogICAgICAgICAgICAgICAg\nICAgIGFwcGVuZFZhbHVlKE51bWJlcnMudmFsdWVPZihjdXIgKyBpbmMpLCBf\nc2VxQ29sdW1uKS4KICAgICAgICAgICAgICAgICAgICBhcHBlbmQoIiBXSEVS\nRSAiKS5hcHBlbmQod2hlcmUpLmFwcGVuZCgiIEFORCAiKS4KICAgICAgICAg\nICAgICAgICAgICBhcHBlbmQoX3NlcUNvbHVtbikuYXBwZW5kKCIgPSAiKS4K\nICAgICAgICAgICAgICAgICAgICBhcHBlbmRWYWx1ZShOdW1iZXJzLnZhbHVl\nT2YoY3VyKSwgX3NlcUNvbHVtbik7CgogICAgICAgICAgICAgICAgc3RtbnQg\nPSBwcmVwYXJlU3RhdGVtZW50KGNvbm4sIHVwZCk7CiAgICAgICAgICAgICAg\nICB1cGRhdGVzID0gZXhlY3V0ZVVwZGF0ZShfY29uZiwgY29ubiwgc3RtbnQs\nIHVwZCwgUm93SW1wbC5BQ1RJT05fVVBEQVRFKTsKICAgICAgICAgICAgfSBm\naW5hbGx5IHsKICAgICAgICAgICAgICAgIGlmIChycyAhPSBudWxsKSAKICAg\nICAgICAgICAgICAgICAgICB0cnkgeyBycy5jbG9zZSgpOyB9IGNhdGNoIChT\nUUxFeGNlcHRpb24gc2UpIHt9CiAgICAgICAgICAgICAgICBpZiAoc3RtbnQg\nIT0gbnVsbCkKICAgICAgICAgICAgICAgICAgICB0cnkgeyBzdG1udC5jbG9z\nZSgpOyB9IGNhdGNoIChTUUxFeGNlcHRpb24gc2UpIHt9CiAgICAgICAgICAg\nIH0KICAgICAgICB9CgogICAgICAgIC8vIHNldHVwIG5ldyBzZXF1ZW5jZSBy\nYW5nZSAgICAgICAgCiAgICAgICAgc3luY2hyb25pemVkIChzdGF0KSB7CiAg\nICAgICAgICAgIGlmICh1cGRhdGVTdGF0U2VxICYmIHN0YXQuc2VxIDwgY3Vy\nKQogICAgICAgICAgICAgICAgc3RhdC5zZXEgPSBjdXI7CiAgICAgICAgICAg\nIGlmIChzdGF0Lm1heCA8IGN1ciArIGluYykKICAgICAgICAgICAgICAgIHN0\nYXQubWF4ID0gY3VyICsgaW5jOwogICAgICAgIH0KICAgICAgICByZXR1cm4g\ndHJ1ZTsKICAgIH0KICAgIC8qKgogICAgICogUmVzb2x2ZSBhIGZ1bGx5IHF1\nYWxpZmllZCB0YWJsZSBuYW1lCiAgICAgKiAKICAgICAqIEBwYXJhbSBjbGFz\ncwogICAgICogICAgICAgICAgICBtYXBwaW5nIHRvIGdldCB0aGUgc2NoZW1h\nIG5hbWUKICAgICAqLwogICAgcHVibGljIFN0cmluZyByZXNvbHZlVGFibGVO\nYW1lKENsYXNzTWFwcGluZyBtYXBwaW5nLCBUYWJsZSB0YWJsZSkgewogICAg\nICAgIFN0cmluZyBzTmFtZSA9IG1hcHBpbmcuZ2V0VGFibGUoKS5nZXRTY2hl\nbWFOYW1lKCk7CiAgICAgICAgU3RyaW5nIHRhYmxlTmFtZTsKICAgICAgICBp\nZiAoc05hbWUgPT0gbnVsbCkKICAgICAgICAgICAgdGFibGVOYW1lID0gdGFi\nbGUuZ2V0RnVsbE5hbWUoKTsKICAgICAgICBlbHNlCiAgICAgICAgICAgIHRh\nYmxlTmFtZSA9IHNOYW1lICsgIi4iICsgdGFibGUuZ2V0TmFtZSgpOwogICAg\nICAgIHJldHVybiB0YWJsZU5hbWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBD\ncmVhdGVzIHRoZSBzZXF1ZW5jZSB0YWJsZSBpbiB0aGUgREIuCiAgICAgKi8K\nICAgIHB1YmxpYyB2b2lkIHJlZnJlc2hUYWJsZSgpCiAgICAgICAgdGhyb3dz\nIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgaWYgKF9sb2cuaXNJbmZvRW5hYmxl\nZCgpKQogICAgICAgICAgICBfbG9nLmluZm8oX2xvYy5nZXQoIm1ha2Utc2Vx\nLXRhYmxlIikpOwoKICAgICAgICAvLyBjcmVhdGUgdGhlIHRhYmxlCiAgICAg\nICAgU2NoZW1hVG9vbCB0b29sID0gbmV3IFNjaGVtYVRvb2woX2NvbmYpOwog\nICAgICAgIHRvb2wuc2V0SWdub3JlRXJyb3JzKHRydWUpOwogICAgICAgIHRv\nb2wuY3JlYXRlVGFibGUoX3BrQ29sdW1uLmdldFRhYmxlKCkpOwogICAgfQoK\nICAgIC8qKgogICAgICogRHJvcHMgdGhlIHNlcXVlbmNlIHRhYmxlIGluIHRo\nZSBEQi4KICAgICAqLwogICAgcHVibGljIHZvaWQgZHJvcFRhYmxlKCkKICAg\nICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBpZiAoX2xvZy5p\nc0luZm9FbmFibGVkKCkpCiAgICAgICAgICAgIF9sb2cuaW5mbyhfbG9jLmdl\ndCgiZHJvcC1zZXEtdGFibGUiKSk7CgogICAgICAgIC8vIGRyb3AgdGhlIHRh\nYmxlCiAgICAgICAgU2NoZW1hVG9vbCB0b29sID0gbmV3IFNjaGVtYVRvb2wo\nX2NvbmYpOwogICAgICAgIHRvb2wuc2V0SWdub3JlRXJyb3JzKHRydWUpOwog\nICAgICAgIHRvb2wuZHJvcFRhYmxlKF9wa0NvbHVtbi5nZXRUYWJsZSgpKTsK\nICAgIH0KCiAgICAvLy8vLy8vLy8KICAgIC8vIE1haW4KICAgIC8vLy8vLy8v\nLwoKICAgIC8qKgogICAgICogVXNhZ2U6IGphdmEgb3JnLmFwYWNoZS5vcGVu\nanBhLmpkYmMuc2NoZW1hLlRhYmxlSkRCQ1NlcXVlbmNlIFtvcHRpb25dKgog\nICAgICogLWFjdGlvbi8tYSAmbHQ7YWRkIHwgZHJvcCB8IGdldCB8IHNldCZn\ndDsgW3ZhbHVlXQogICAgICogIFdoZXJlIHRoZSBmb2xsb3dpbmcgb3B0aW9u\ncyBhcmUgcmVjb2duaXplZC4KICAgICAqIDx1bD4KICAgICAqIDxsaT48aT4t\ncHJvcGVydGllcy8tcCAmbHQ7cHJvcGVydGllcyBmaWxlIG9yIHJlc291cmNl\nJmd0OzwvaT46IFRoZQogICAgICogcGF0aCBvciByZXNvdXJjZSBuYW1lIG9m\nIGEgT3BlbkpQQSBwcm9wZXJ0aWVzIGZpbGUgY29udGFpbmluZwogICAgICog\naW5mb3JtYXRpb24gc3VjaCBhcyB0aGUgbGljZW5zZSBrZXkJYW5kIGNvbm5l\nY3Rpb24gZGF0YSBhcwogICAgICogb3V0bGluZWQgaW4ge0BsaW5rIEpEQkND\nb25maWd1cmF0aW9ufS4gT3B0aW9uYWwuPC9saT4KICAgICAqIDxsaT48aT4t\nJmx0O3Byb3BlcnR5IG5hbWUmZ3Q7ICZsdDtwcm9wZXJ0eSB2YWx1ZSZndDs8\nL2k+OiBBbGwgYmVhbgogICAgICogcHJvcGVydGllcyBvZiB0aGUgT3BlbkpQ\nQSB7QGxpbmsgSkRCQ0NvbmZpZ3VyYXRpb259IGNhbiBiZSBzZXQgYnkKICAg\nICAqIHVzaW5nIHRoZWlyCW5hbWVzIGFuZCBzdXBwbHlpbmcgYSB2YWx1ZS4g\nRm9yIGV4YW1wbGU6CiAgICAgKiA8Y29kZT4tbGljZW5zZUtleSBhZHNsZmph\nODNyM2xrYWRmPC9jb2RlPjwvbGk+CiAgICAgKiA8L3VsPgogICAgICogIFRo\nZSB2YXJpb3VzIGFjdGlvbnMgYXJlIGFzIGZvbGxvd3MuCiAgICAgKiA8dWw+\nCiAgICAgKiA8bGk+PGk+YWRkPC9pPjogQ3JlYXRlIHRoZSBzZXF1ZW5jZSB0\nYWJsZS48L2xpPgogICAgICogPGxpPjxpPmRyb3A8L2k+OiBEcm9wIHRoZSBz\nZXF1ZW5jZSB0YWJsZS48L2xpPgogICAgICogPGxpPjxpPmdldDwvaT46IFBy\naW50IHRoZSBjdXJyZW50IHNlcXVlbmNlIHZhbHVlLjwvbGk+CiAgICAgKiA8\nbGk+PGk+c2V0PC9pPjogU2V0IHRoZSBzZXF1ZW5jZSB2YWx1ZS48L2xpPgog\nICAgICogPC91bD4KICAgICAqLwogICAgcHVibGljIHN0YXRpYyB2b2lkIG1h\naW4oU3RyaW5nW10gYXJncykKICAgICAgICB0aHJvd3MgRXhjZXB0aW9uIHsK\nICAgICAgICBPcHRpb25zIG9wdHMgPSBuZXcgT3B0aW9ucygpOwogICAgICAg\nIGZpbmFsIFN0cmluZ1tdIGFyZ3VtZW50cyA9IG9wdHMuc2V0RnJvbUNtZExp\nbmUoYXJncyk7CiAgICAgICAgYm9vbGVhbiByZXQgPSBDb25maWd1cmF0aW9u\ncy5ydW5BZ2FpbnN0QWxsQW5jaG9ycyhvcHRzLAogICAgICAgICAgICBuZXcg\nQ29uZmlndXJhdGlvbnMuUnVubmFibGUoKSB7CiAgICAgICAgICAgIHB1Ymxp\nYyBib29sZWFuIHJ1bihPcHRpb25zIG9wdHMpIHRocm93cyBFeGNlcHRpb24g\newogICAgICAgICAgICAgICAgSkRCQ0NvbmZpZ3VyYXRpb24gY29uZiA9IG5l\ndyBKREJDQ29uZmlndXJhdGlvbkltcGwoKTsKICAgICAgICAgICAgICAgIHRy\neSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFRhYmxlSkRCQ1NlcS5y\ndW4oY29uZiwgYXJndW1lbnRzLCBvcHRzKTsKICAgICAgICAgICAgICAgIH0g\nZmluYWxseSB7CiAgICAgICAgICAgICAgICAgICAgY29uZi5jbG9zZSgpOwog\nICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfSk7CiAg\nICAgICAgaWYgKCFyZXQpCiAgICAgICAgICAgIFN5c3RlbS5vdXQucHJpbnRs\nbihfbG9jLmdldCgic2VxLXVzYWdlIikpOwogICAgfQoKICAgIC8qKgogICAg\nICogUnVuIHRoZSB0b29sLiBSZXR1cm5zIGZhbHNlIGlmIGludmFsaWQgb3B0\naW9ucyB3ZXJlIGdpdmVuLgogICAgICovCiAgICBwdWJsaWMgc3RhdGljIGJv\nb2xlYW4gcnVuKEpEQkNDb25maWd1cmF0aW9uIGNvbmYsIFN0cmluZ1tdIGFy\nZ3MsCiAgICAgICAgT3B0aW9ucyBvcHRzKQogICAgICAgIHRocm93cyBFeGNl\ncHRpb24gewogICAgICAgIFN0cmluZyBhY3Rpb24gPSBvcHRzLnJlbW92ZVBy\nb3BlcnR5KCJhY3Rpb24iLCAiYSIsIG51bGwpOwogICAgICAgIENvbmZpZ3Vy\nYXRpb25zLnBvcHVsYXRlQ29uZmlndXJhdGlvbihjb25mLCBvcHRzKTsKICAg\nICAgICByZXR1cm4gcnVuKGNvbmYsIGFyZ3MsIGFjdGlvbik7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBSdW4gdGhlIHRvb2wuIFJldHVybiBmYWxzZSBpZiBh\nbiBpbnZhbGlkIG9wdGlvbiB3YXMgZ2l2ZW4uCiAgICAgKi8KICAgIHB1Ymxp\nYyBzdGF0aWMgYm9vbGVhbiBydW4oSkRCQ0NvbmZpZ3VyYXRpb24gY29uZiwg\nU3RyaW5nW10gYXJncywKICAgICAgICBTdHJpbmcgYWN0aW9uKQogICAgICAg\nIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIGlmIChhcmdzLmxlbmd0aCA+\nIDEgfHwgKGFyZ3MubGVuZ3RoICE9IDAKICAgICAgICAgICAgJiYgIUFDVElP\nTl9TRVQuZXF1YWxzKGFjdGlvbikpKQogICAgICAgICAgICByZXR1cm4gZmFs\nc2U7CgogICAgICAgIFRhYmxlSkRCQ1NlcSBzZXEgPSBuZXcgVGFibGVKREJD\nU2VxKCk7CiAgICAgICAgU3RyaW5nIHByb3BzID0gQ29uZmlndXJhdGlvbnMu\nZ2V0UHJvcGVydGllcyhjb25mLmdldFNlcXVlbmNlKCkpOwogICAgICAgIENv\nbmZpZ3VyYXRpb25zLmNvbmZpZ3VyZUluc3RhbmNlKHNlcSwgY29uZiwgcHJv\ncHMpOwoKICAgICAgICBpZiAoQUNUSU9OX0RST1AuZXF1YWxzKGFjdGlvbikp\nCiAgICAgICAgICAgIHNlcS5kcm9wVGFibGUoKTsKICAgICAgICBlbHNlIGlm\nIChBQ1RJT05fQURELmVxdWFscyhhY3Rpb24pKQogICAgICAgICAgICBzZXEu\ncmVmcmVzaFRhYmxlKCk7CiAgICAgICAgZWxzZSBpZiAoQUNUSU9OX0dFVC5l\ncXVhbHMoYWN0aW9uKSB8fCBBQ1RJT05fU0VULmVxdWFscyhhY3Rpb24pKSB7\nCiAgICAgICAgICAgIENvbm5lY3Rpb24gY29ubiA9IGNvbmYuZ2V0RGF0YVNv\ndXJjZTIobnVsbCkuZ2V0Q29ubmVjdGlvbigpOwogICAgICAgICAgICB0cnkg\newogICAgICAgICAgICAgICAgbG9uZyBjdXIgPSBzZXEuZ2V0U2VxdWVuY2Uo\nbnVsbCwgY29ubik7CiAgICAgICAgICAgICAgICBpZiAoQUNUSU9OX0dFVC5l\ncXVhbHMoYWN0aW9uKSkKICAgICAgICAgICAgICAgICAgICBTeXN0ZW0ub3V0\nLnByaW50bG4oY3VyKTsKICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAg\nICAgICAgICAgICAgIGxvbmcgc2V0OwogICAgICAgICAgICAgICAgICAgIGlm\nIChhcmdzLmxlbmd0aCA+IDApCiAgICAgICAgICAgICAgICAgICAgICAgIHNl\ndCA9IExvbmcucGFyc2VMb25nKGFyZ3NbMF0pOwogICAgICAgICAgICAgICAg\nICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICAgICAgc2V0ID0gY3VyICsg\nc2VxLmdldEFsbG9jYXRlKCk7CiAgICAgICAgICAgICAgICAgICAgaWYgKHNl\ndCA8IGN1cikKICAgICAgICAgICAgICAgICAgICAgICAgc2V0ID0gY3VyOwog\nICAgICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAg\nICAgICBTdGF0dXMgc3RhdCA9IHNlcS5nZXRTdGF0dXMobnVsbCk7CiAgICAg\nICAgICAgICAgICAgICAgICAgIHNlcS5zZXRTZXF1ZW5jZShudWxsLCBzdGF0\nLCAoaW50KSAoc2V0IC0gY3VyKSwgdHJ1ZSwKICAgICAgICAgICAgICAgICAg\nICAgICAgICAgIGNvbm4pOwogICAgICAgICAgICAgICAgICAgICAgICBzZXQg\nPSBzdGF0LnNlcTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAg\nICAgICAgICAgU3lzdGVtLmVyci5wcmludGxuKHNldCk7CiAgICAgICAgICAg\nICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2F0Y2ggKE51bWJl\nckZvcm1hdEV4Y2VwdGlvbiBuZmUpIHsKICAgICAgICAgICAgICAgIHJldHVy\nbiBmYWxzZTsKICAgICAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAg\nICAgIHRyeSB7IGNvbm4uY2xvc2UoKTsgfSBjYXRjaCAoU1FMRXhjZXB0aW9u\nIHNlKSB7fQogICAgICAgICAgICB9CiAgICAgICAgfSBlbHNlCiAgICAgICAg\nICAgIHJldHVybiBmYWxzZTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0K\nCiAgICAvKioKICAgICAqIEhlbHBlciBzdHJ1Y3QgdG8gaG9sZCBzdGF0dXMg\naW5mb3JtYXRpb24uCiAgICAgKi8KICAgIHByb3RlY3RlZCBzdGF0aWMgY2xh\nc3MgU3RhdHVzCiAgICAgICAgaW1wbGVtZW50cyBTZXJpYWxpemFibGUgewoK\nICAgICAgICBwdWJsaWMgbG9uZyBzZXEgPSAxTDsKICAgICAgICBwdWJsaWMg\nbG9uZyBtYXggPSAwTDsKICAgIH0KCiAgICAvKioKICAgICAqIFRoaXMgbWV0\naG9kIGlzIHRvIHByb3ZpZGUgb3ZlcnJpZGUgZm9yIG5vbi1KREJDIG9yIEpE\nQkMtbGlrZSAKICAgICAqIGltcGxlbWVudGF0aW9uIG9mIHByZXBhcmluZyBz\ndGF0ZW1lbnQuCiAgICAgKi8KICAgIHByb3RlY3RlZCBQcmVwYXJlZFN0YXRl\nbWVudCBwcmVwYXJlU3RhdGVtZW50KENvbm5lY3Rpb24gY29ubiwgU1FMQnVm\nZmVyIGJ1ZikKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAg\nICByZXR1cm4gYnVmLnByZXBhcmVTdGF0ZW1lbnQoY29ubik7CiAgICB9CiAg\nICAKICAgIC8qKgogICAgICogVGhpcyBtZXRob2QgaXMgdG8gcHJvdmlkZSBv\ndmVycmlkZSBmb3Igbm9uLUpEQkMgb3IgSkRCQy1saWtlIAogICAgICogaW1w\nbGVtZW50YXRpb24gb2YgZXhlY3V0aW5nIHVwZGF0ZS4KICAgICAqLwogICAg\ncHJvdGVjdGVkIGludCBleGVjdXRlVXBkYXRlKEpEQkNDb25maWd1cmF0aW9u\nIGNvbmYsIENvbm5lY3Rpb24gY29ubiwgIAogICAgICAgIFByZXBhcmVkU3Rh\ndGVtZW50IHN0bW50LCBTUUxCdWZmZXIgYnVmLCBpbnQgb3Bjb2RlKSB0aHJv\nd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICByZXR1cm4gc3RtbnQuZXhlY3V0\nZVVwZGF0ZSgpOwogICAgfQogICAgCiAgICAvKioKICAgICAqIFRoaXMgbWV0\naG9kIGlzIHRvIHByb3ZpZGUgb3ZlcnJpZGUgZm9yIG5vbi1KREJDIG9yIEpE\nQkMtbGlrZSAKICAgICAqIGltcGxlbWVudGF0aW9uIG9mIGV4ZWN1dGluZyBx\ndWVyeS4KICAgICAqLwogICAgcHJvdGVjdGVkIFJlc3VsdFNldCBleGVjdXRl\nUXVlcnkoSkRCQ0NvbmZpZ3VyYXRpb24gY29uZiwgQ29ubmVjdGlvbiBjb25u\nLAogICAgICAgIFByZXBhcmVkU3RhdGVtZW50IHN0bW50LCBTUUxCdWZmZXIg\nYnVmKSB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICByZXR1cm4gc3Rt\nbnQuZXhlY3V0ZVF1ZXJ5KCk7CiAgICB9CiAgICAKICAgIC8qKgogICAgICog\nVGhpcyBtZXRob2QgaXMgdG8gcHJvdmlkZSBvdmVycmlkZSBmb3Igbm9uLUpE\nQkMgb3IgSkRCQy1saWtlIAogICAgICogaW1wbGVtZW50YXRpb24gb2YgZ2V0\ndGluZyBzZXF1ZW5jZSBmcm9tIHRoZSByZXN1bHQgc2V0LgogICAgICovCiAg\nICBwcm90ZWN0ZWQgbG9uZyBnZXRTZXF1ZW5jZShSZXN1bHRTZXQgcnMsIERC\nRGljdGlvbmFyeSBkaWN0KSB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAg\nICBpZiAocnMgPT0gbnVsbCB8fCAhcnMubmV4dCgpKQogICAgICAgICAgICBy\nZXR1cm4gLTE7CiAgICAgICAgcmV0dXJuIGRpY3QuZ2V0TG9uZyhycywgMSk7\nCiAgICB9Cn0K\n","encoding":"base64"}

