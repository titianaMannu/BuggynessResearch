{"sha":"0099b13154e71efcd193c62d564745a304838874","node_id":"MDQ6QmxvYjIwNjM2NDowMDk5YjEzMTU0ZTcxZWZjZDE5M2M2MmQ1NjQ3NDVhMzA0ODM4ODc0","size":13999,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/0099b13154e71efcd193c62d564745a304838874","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhOwoKaW1wb3J0\nIGphdmEuaW8uRmlsZTsKaW1wb3J0IGphdmEudXRpbC5Db2xsZWN0aW9uczsK\naW1wb3J0IGphdmEudXRpbC5IYXNoTWFwOwppbXBvcnQgamF2YS51dGlsLkl0\nZXJhdG9yOwppbXBvcnQgamF2YS51dGlsLkxpc3Q7CmltcG9ydCBqYXZhLnV0\naWwuTWFwOwppbXBvcnQgamF2YS51dGlsLkNvbGxlY3Rpb247CmltcG9ydCBq\nYXZhLnV0aWwuQXJyYXlMaXN0OwoKaW1wb3J0IG9yZy5hcGFjaGUuY29tbW9u\ncy5sYW5nLlN0cmluZ1V0aWxzOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLmpkYmMubWV0YS5zdHJhdHMuRnVsbENsYXNzU3RyYXRlZ3k7CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hlbWEuQ29sdW1uOwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1hLkZvcmVpZ25LZXk7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hlbWEuU2NoZW1hOwpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1hLlNjaGVtYUdy\nb3VwOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1hLlRh\nYmxlOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1hLlVu\naXF1ZTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIubWV0YS5Tb3Vy\nY2VUcmFja2VyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51dGls\nLkxvY2FsaXplcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIueG1s\nLkNvbW1lbnRhYmxlOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwu\nVXNlckV4Y2VwdGlvbjsKCi8qKgogKiBJbmZvcm1hdGlvbiBhYm91dCB0aGUg\nbWFwcGluZyBmcm9tIGEgY2xhc3MgdG8gdGhlIHNjaGVtYSwgaW4gcmF3IGZv\ncm0uCiAqIFRoZSBjb2x1bW5zIGFuZCB0YWJsZXMgdXNlZCBpbiBtYXBwaW5n\nIGluZm8gd2lsbCBub3QgYmUgcGFydCBvZiB0aGUKICoge0BsaW5rIFNjaGVt\nYUdyb3VwfSB1c2VkIGF0IHJ1bnRpbWUuIFJhdGhlciwgdGhleSB3aWxsIGJl\nIHN0cnVjdHMKICogd2l0aCB0aGUgcmVsZXZhbnQgcGllY2VzIG9mIGluZm9y\nbWF0aW9uIGZpbGxlZCBpbi4KICoKICogQGF1dGhvciBBYmUgV2hpdGUKICov\nCnB1YmxpYyBjbGFzcyBDbGFzc01hcHBpbmdJbmZvCiAgICBleHRlbmRzIE1h\ncHBpbmdJbmZvCiAgICBpbXBsZW1lbnRzIFNvdXJjZVRyYWNrZXIsIENvbW1l\nbnRhYmxlIHsKCiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBMb2NhbGl6ZXIg\nX2xvYyA9IExvY2FsaXplci5mb3JQYWNrYWdlCiAgICAgICAgKENsYXNzTWFw\ncGluZ0luZm8uY2xhc3MpOwoKICAgIHByaXZhdGUgU3RyaW5nIF9jbGFzc05h\nbWUgPSBPYmplY3QuY2xhc3MuZ2V0TmFtZSgpOwogICAgcHJpdmF0ZSBTdHJp\nbmcgX3RhYmxlTmFtZSA9IG51bGw7CiAgICBwcml2YXRlIFN0cmluZyBfc2No\nZW1hTmFtZSA9IG51bGw7CiAgICBwcml2YXRlIGJvb2xlYW4gX2pvaW5lZCA9\nIGZhbHNlOwogICAgcHJpdmF0ZSBNYXAgX3NlY29uZHMgPSBudWxsOwogICAg\ncHJpdmF0ZSBTdHJpbmcgX3N1YlN0cmF0ID0gbnVsbDsKICAgIHByaXZhdGUg\nRmlsZSBfZmlsZSA9IG51bGw7CiAgICBwcml2YXRlIGludCBfc3JjVHlwZSA9\nIFNSQ19PVEhFUjsKICAgIHByaXZhdGUgU3RyaW5nW10gX2NvbW1lbnRzID0g\nbnVsbDsKICAgIHByaXZhdGUgQ29sbGVjdGlvbiBfdW5pcXVlcyA9IG51bGw7\nLy9VbmlxdWUKCiAgICAvKioKICAgICAqIFRoZSBkZXNjcmliZWQgY2xhc3Mg\nbmFtZS4KICAgICAqLwogICAgcHVibGljIFN0cmluZyBnZXRDbGFzc05hbWUo\nKSB7CiAgICAgICAgcmV0dXJuIF9jbGFzc05hbWU7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBUaGUgZGVzY3JpYmVkIGNsYXNzIG5hbWUuCiAgICAgKi8KICAg\nIHB1YmxpYyB2b2lkIHNldENsYXNzTmFtZShTdHJpbmcgbmFtZSkgewogICAg\nICAgIF9jbGFzc05hbWUgPSBuYW1lOwogICAgfQoKICAgIC8qKgogICAgICog\nVGhlIGRlZmF1bHQgc3RyYXRlZ3kgZm9yIHN1YmNsYXNzZXMgaW4gdGhpcyBo\naWVyYXJjaHkuCiAgICAgKi8KICAgIHB1YmxpYyBTdHJpbmcgZ2V0SGllcmFy\nY2h5U3RyYXRlZ3koKSB7CiAgICAgICAgcmV0dXJuIF9zdWJTdHJhdDsKICAg\nIH0KCiAgICAvKioKICAgICAqIFRoZSBkZWZhdWx0IHN0cmF0ZWd5IGZvciBz\ndWJjbGFzc2VzIGluIHRoaXMgaGllcmFyY2h5LgogICAgICovCiAgICBwdWJs\naWMgdm9pZCBzZXRIaWVyYXJjaHlTdHJhdGVneShTdHJpbmcgc3RyYXRlZ3kp\nIHsKICAgICAgICBfc3ViU3RyYXQgPSBzdHJhdGVneTsKICAgIH0KCiAgICAv\nKioKICAgICAqIFRoZSBnaXZlbiB0YWJsZSBuYW1lLgogICAgICovCiAgICBw\ndWJsaWMgU3RyaW5nIGdldFRhYmxlTmFtZSgpIHsKICAgICAgICByZXR1cm4g\nX3RhYmxlTmFtZTsKICAgIH0KCiAgICAvKioKICAgICAqIFRoZSBnaXZlbiB0\nYWJsZSBuYW1lLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRUYWJsZU5h\nbWUoU3RyaW5nIHRhYmxlKSB7CiAgICAgICAgX3RhYmxlTmFtZSA9IHRhYmxl\nOwogICAgfQoKICAgIC8qKgogICAgICogVGhlIGRlZmF1bHQgc2NoZW1hIG5h\nbWUgZm9yIHVucXVhbGlmaWVkIHRhYmxlcy4KICAgICAqLwogICAgcHVibGlj\nIFN0cmluZyBnZXRTY2hlbWFOYW1lKCkgewogICAgICAgIHJldHVybiBfc2No\nZW1hTmFtZTsKICAgIH0KCiAgICAvKioKICAgICAqIFRoZSBkZWZhdWx0IHNj\naGVtYSBuYW1lIGZvciB1bnF1YWxpZmllZCB0YWJsZXMuCiAgICAgKi8KICAg\nIHB1YmxpYyB2b2lkIHNldFNjaGVtYU5hbWUoU3RyaW5nIHNjaGVtYSkgewog\nICAgICAgIF9zY2hlbWFOYW1lID0gc2NoZW1hOwogICAgfQoKICAgIC8qKgog\nICAgICogV2hldGhlciB0aGVyZSBpcyBhIGpvaW4gdG8gdGhlIHN1cGVyY2xh\nc3MgdGFibGUuCiAgICAgKi8KICAgIHB1YmxpYyBib29sZWFuIGlzSm9pbmVk\nU3ViY2xhc3MoKSB7CiAgICAgICAgcmV0dXJuIF9qb2luZWQ7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBXaGV0aGVyIHRoZXJlIGlzIGEgam9pbiB0byB0aGUg\nc3VwZXJjbGFzcyB0YWJsZS4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0\nSm9pbmVkU3ViY2xhc3MoYm9vbGVhbiBqb2luZWQpIHsKICAgICAgICBfam9p\nbmVkID0gam9pbmVkOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRo\nZSBjbGFzcy1sZXZlbCBqb2luZWQgdGFibGVzLgogICAgICovCiAgICBwdWJs\naWMgU3RyaW5nW10gZ2V0U2Vjb25kYXJ5VGFibGVOYW1lcygpIHsKICAgICAg\nICBpZiAoX3NlY29uZHMgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIG5l\ndyBTdHJpbmdbMF07CiAgICAgICAgcmV0dXJuIChTdHJpbmdbXSkgX3NlY29u\nZHMua2V5U2V0KCkudG9BcnJheShuZXcgU3RyaW5nW117IH0pOwogICAgfQoK\nICAgIC8qKgogICAgICogV2UgYWxsb3cgZmllbGRzIHRvIHJlZmVyZW5jZSBj\nbGFzcy1sZXZlbCBqb2lucyB1c2luZyBqdXN0IHRoZSB0YWJsZQogICAgICog\nbmFtZSwgd2hlcmVhcyB0aGUgY2xhc3Mgam9pbiBtaWdodCBoYXZlIHNjaGVt\nYSwgZXRjIGluZm9ybWF0aW9uLgogICAgICogVGhpcyBtZXRob2QgcmV0dXJu\ncyB0aGUgbmFtZSBvZiB0aGUgZ2l2ZW4gdGFibGUgYXMgbGlzdGVkIGluIGEK\nICAgICAqIGNsYXNzLWxldmVsIGpvaW4sIG9yIHRoZSBnaXZlbiBuYW1lIGlm\nIG5vIGpvaW4gZXhpc3RzLgogICAgICovCiAgICBwdWJsaWMgU3RyaW5nIGdl\ndFNlY29uZGFyeVRhYmxlTmFtZShTdHJpbmcgdGFibGVOYW1lKSB7CiAgICAg\nICAgLy8gaWYgbm8gc2Vjb25kYXJ5IHRhYmxlIGpvaW5zLCBiYWQgdGFibGUg\nbmFtZSwgZXhhY3QgbWF0Y2gsCiAgICAgICAgLy8gb3IgYW4gYWxyZWFkeS1x\ndWFsaWZpZWQgdGFibGUgbmFtZSwgbm90aGluZyB0byBkbwogICAgICAgIGlm\nIChfc2Vjb25kcyA9PSBudWxsIHx8IHRhYmxlTmFtZSA9PSBudWxsCiAgICAg\nICAgICAgIHx8IF9zZWNvbmRzLmNvbnRhaW5zS2V5KHRhYmxlTmFtZSkKICAg\nICAgICAgICAgfHwgdGFibGVOYW1lLmluZGV4T2YoJy4nKSAhPSAtMSkKICAg\nICAgICAgICAgcmV0dXJuIHRhYmxlTmFtZTsKCiAgICAgICAgLy8gZGVjaWRl\nIHdoaWNoIGNsYXNzLWxldmVsIGpvaW4gdGFibGUgaXMgYmVzdCBtYXRjaAog\nICAgICAgIFN0cmluZyBiZXN0ID0gdGFibGVOYW1lOwogICAgICAgIGludCBw\ndHMgPSAwOwogICAgICAgIFN0cmluZyBmdWxsSm9pbjsKICAgICAgICBTdHJp\nbmcgam9pbjsKICAgICAgICBpbnQgaWR4OwogICAgICAgIGZvciAoSXRlcmF0\nb3IgaXRyID0gX3NlY29uZHMua2V5U2V0KCkuaXRlcmF0b3IoKTsgaXRyLmhh\nc05leHQoKTspIHsKICAgICAgICAgICAgLy8gYXdhcmQgYSBjYXNlbGVzcyBt\nYXRjaCB3aXRob3V0IHNjaGVtYSAyIHBvaW50cwogICAgICAgICAgICBmdWxs\nSm9pbiA9IChTdHJpbmcpIGl0ci5uZXh0KCk7CiAgICAgICAgICAgIGlkeCA9\nIGZ1bGxKb2luLmxhc3RJbmRleE9mKCcuJyk7CiAgICAgICAgICAgIGlmIChp\nZHggPT0gLTEgJiYgcHRzIDwgMiAmJiBmdWxsSm9pbi5lcXVhbHNJZ25vcmVD\nYXNlKHRhYmxlTmFtZSkpIHsKICAgICAgICAgICAgICAgIGJlc3QgPSBmdWxs\nSm9pbjsKICAgICAgICAgICAgICAgIHB0cyA9IDI7CiAgICAgICAgICAgIH0g\nZWxzZSBpZiAoaWR4ID09IC0xKQogICAgICAgICAgICAgICAgY29udGludWU7\nCgogICAgICAgICAgICAvLyBpbW1lZGlhdGVseSByZXR1cm4gYW4gZXhhY3Qg\nbWF0Y2ggd2l0aCBzY2hlbWEKICAgICAgICAgICAgam9pbiA9IGZ1bGxKb2lu\nLnN1YnN0cmluZyhpZHggKyAxKTsKICAgICAgICAgICAgaWYgKGpvaW4uZXF1\nYWxzKHRhYmxlTmFtZSkpCiAgICAgICAgICAgICAgICByZXR1cm4gZnVsbEpv\naW47CgogICAgICAgICAgICAvLyBjYXNlbGVzcyBtYXRjaCB3aXRoIHNjaGVt\nYSB3b3J0aCAxIHBvaW50CiAgICAgICAgICAgIGlmIChwdHMgPCAxICYmIGpv\naW4uZXF1YWxzSWdub3JlQ2FzZSh0YWJsZU5hbWUpKSB7CiAgICAgICAgICAg\nICAgICBiZXN0ID0gZnVsbEpvaW47CiAgICAgICAgICAgICAgICBwdHMgPSAx\nOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiBiZXN0\nOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIGFueSBjb2x1bW5zIGRl\nZmluZWQgZm9yIHRoZSBnaXZlbiBjbGFzcyBsZXZlbCBqb2luLCBvciBlbXB0\neQogICAgICogbGlzdCBpZiBub25lLgogICAgICovCiAgICBwdWJsaWMgTGlz\ndCBnZXRTZWNvbmRhcnlUYWJsZUpvaW5Db2x1bW5zKFN0cmluZyB0YWJsZU5h\nbWUpIHsKICAgICAgICBpZiAoX3NlY29uZHMgPT0gbnVsbCB8fCB0YWJsZU5h\nbWUgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIENvbGxlY3Rpb25zLkVN\nUFRZX0xJU1Q7CgogICAgICAgIC8vIGdldCB0aGUgY29sdW1ucyBmb3IgdGhl\nIGpvaW4gd2l0aCB0aGUgYmVzdCBtYXRjaCBmb3IgdGFibGUgbmFtZQogICAg\nICAgIExpc3QgY29scyA9IChMaXN0KSBfc2Vjb25kcy5nZXQoZ2V0U2Vjb25k\nYXJ5VGFibGVOYW1lKHRhYmxlTmFtZSkpOwogICAgICAgIGlmIChjb2xzID09\nIG51bGwpIHsKICAgICAgICAgICAgLy8gcG9zc2libGUgdGhhdCBnaXZlbiB0\nYWJsZSBoYXMgZXh0cmEgaW5mbyB0aGUgam9pbiB0YWJsZQogICAgICAgICAg\nICAvLyBkb2Vzbid0IGhhdmU7IHN0cmlwIGl0CiAgICAgICAgICAgIGludCBp\nZHggPSB0YWJsZU5hbWUubGFzdEluZGV4T2YoJy4nKTsKICAgICAgICAgICAg\naWYgKGlkeCAhPSAtMSkgewogICAgICAgICAgICAgICAgdGFibGVOYW1lID0g\ndGFibGVOYW1lLnN1YnN0cmluZyhpZHggKyAxKTsKICAgICAgICAgICAgICAg\nIGNvbHMgPSAoTGlzdCkgX3NlY29uZHMuZ2V0KGdldFNlY29uZGFyeVRhYmxl\nTmFtZSh0YWJsZU5hbWUpKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAg\nICAgICByZXR1cm4gKGNvbHMgPT0gbnVsbCkgPyBDb2xsZWN0aW9ucy5FTVBU\nWV9MSVNUIDogY29sczsKICAgIH0KCiAgICAvKioKICAgICAqIERlY2xhcmUg\ndGhlIGdpdmVuIGNsYXNzLWxldmVsIGpvaW4uCiAgICAgKi8KICAgIHB1Ymxp\nYyB2b2lkIHNldFNlY29uZGFyeVRhYmxlSm9pbkNvbHVtbnMoU3RyaW5nIHRh\nYmxlTmFtZSwgTGlzdCBjb2xzKSB7CiAgICAgICAgaWYgKGNvbHMgPT0gbnVs\nbCkKICAgICAgICAgICAgY29scyA9IENvbGxlY3Rpb25zLkVNUFRZX0xJU1Q7\nCiAgICAgICAgaWYgKF9zZWNvbmRzID09IG51bGwpCiAgICAgICAgICAgIF9z\nZWNvbmRzID0gbmV3IEhhc2hNYXAoKTsKICAgICAgICBfc2Vjb25kcy5wdXQo\ndGFibGVOYW1lLCBjb2xzKTsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVy\nbiB0aGUgdGFibGUgZm9yIHRoZSBnaXZlbiBjbGFzcy4KICAgICAqLwogICAg\ncHVibGljIFRhYmxlIGdldFRhYmxlKGZpbmFsIENsYXNzTWFwcGluZyBjbHMs\nIGJvb2xlYW4gYWRhcHQpIHsKICAgICAgICBUYWJsZSB0ID0gY3JlYXRlVGFi\nbGUoY2xzLCBuZXcgVGFibGVEZWZhdWx0cygpIHsKICAgICAgICAgICAgcHVi\nbGljIFN0cmluZyBnZXQoU2NoZW1hIHNjaGVtYSkgewogICAgICAgICAgICAg\nICAgLy8gZGVsYXkgdGhpcyBzbyB0aGF0IHdlIGRvbid0IGRvIHNjaGVtYSBy\nZWZsZWN0aW9uIGZvciB1bmlxdWUKICAgICAgICAgICAgICAgIC8vIHRhYmxl\nIG5hbWUgdW5sZXNzIG5lY2Vzc2FyeQogICAgICAgICAgICAgICAgcmV0dXJu\nIGNscy5nZXRNYXBwaW5nUmVwb3NpdG9yeSgpLmdldE1hcHBpbmdEZWZhdWx0\ncygpLgogICAgICAgICAgICAgICAgICAgIGdldFRhYmxlTmFtZShjbHMsIHNj\naGVtYSk7CiAgICAgICAgICAgIH0KICAgICAgICB9LCBfc2NoZW1hTmFtZSwg\nX3RhYmxlTmFtZSwgYWRhcHQpOwogICAgICAgIHQuc2V0Q29tbWVudChjbHMu\nZ2V0VHlwZUFsaWFzKCkgPT0gbnVsbAogICAgICAgICAgICA/IGNscy5nZXRE\nZXNjcmliZWRUeXBlKCkuZ2V0TmFtZSgpCiAgICAgICAgICAgIDogY2xzLmdl\ndFR5cGVBbGlhcygpKTsKICAgICAgICByZXR1cm4gdDsKICAgIH0KCiAgICAv\nKioKICAgICAqIFJldHVybiB0aGUgZGF0YXN0b3JlIGlkZW50aXR5IGNvbHVt\nbnMgZm9yIHRoZSBnaXZlbiBjbGFzcywgYmFzZWQgb24gdGhlCiAgICAgKiBn\naXZlbiB0ZW1wbGF0ZXMuCiAgICAgKi8KICAgIHB1YmxpYyBDb2x1bW5bXSBn\nZXREYXRhU3RvcmVJZENvbHVtbnMoQ2xhc3NNYXBwaW5nIGNscywgQ29sdW1u\nW10gdG1wbGF0ZXMsCiAgICAgICAgVGFibGUgdGFibGUsIGJvb2xlYW4gYWRh\ncHQpIHsKICAgICAgICBjbHMuZ2V0TWFwcGluZ1JlcG9zaXRvcnkoKS5nZXRN\nYXBwaW5nRGVmYXVsdHMoKS4KICAgICAgICAgICAgcG9wdWxhdGVEYXRhU3Rv\ncmVJZENvbHVtbnMoY2xzLCB0YWJsZSwgdG1wbGF0ZXMpOwogICAgICAgIHJl\ndHVybiBjcmVhdGVDb2x1bW5zKGNscywgImRhdGFzdG9yZWlkIiwgdG1wbGF0\nZXMsIHRhYmxlLCBhZGFwdCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1\ncm4gdGhlIGpvaW4gZnJvbSB0aGlzIGNsYXNzIHRvIGl0cyBzdXBlcmNsYXNz\nLiBUaGUgdGFibGUgZm9yCiAgICAgKiB0aGlzIGNsYXNzIG11c3QgYmUgc2V0\nLgogICAgICovCiAgICBwdWJsaWMgRm9yZWlnbktleSBnZXRTdXBlcmNsYXNz\nSm9pbihmaW5hbCBDbGFzc01hcHBpbmcgY2xzLCBUYWJsZSB0YWJsZSwKICAg\nICAgICBib29sZWFuIGFkYXB0KSB7CiAgICAgICAgQ2xhc3NNYXBwaW5nIHN1\ncCA9IGNscy5nZXRKb2luYWJsZVBDU3VwZXJjbGFzc01hcHBpbmcoKTsKICAg\nICAgICBpZiAoc3VwID09IG51bGwpCiAgICAgICAgICAgIHJldHVybiBudWxs\nOwoKICAgICAgICBGb3JlaWduS2V5RGVmYXVsdHMgZGVmID0gbmV3IEZvcmVp\nZ25LZXlEZWZhdWx0cygpIHsKICAgICAgICAgICAgcHVibGljIEZvcmVpZ25L\nZXkgZ2V0KFRhYmxlIGxvY2FsLCBUYWJsZSBmb3JlaWduLCBib29sZWFuIGlu\ndmVyc2UpIHsKICAgICAgICAgICAgICAgIHJldHVybiBjbHMuZ2V0TWFwcGlu\nZ1JlcG9zaXRvcnkoKS5nZXRNYXBwaW5nRGVmYXVsdHMoKS4KICAgICAgICAg\nICAgICAgICAgICBnZXRKb2luRm9yZWlnbktleShjbHMsIGxvY2FsLCBmb3Jl\naWduKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHVibGljIHZvaWQg\ncG9wdWxhdGUoVGFibGUgbG9jYWwsIFRhYmxlIGZvcmVpZ24sIENvbHVtbiBj\nb2wsCiAgICAgICAgICAgICAgICBPYmplY3QgdGFyZ2V0LCBib29sZWFuIGlu\ndmVyc2UsIGludCBwb3MsIGludCBjb2xzKSB7CiAgICAgICAgICAgICAgICBj\nbHMuZ2V0TWFwcGluZ1JlcG9zaXRvcnkoKS5nZXRNYXBwaW5nRGVmYXVsdHMo\nKS4KICAgICAgICAgICAgICAgICAgICBwb3B1bGF0ZUpvaW5Db2x1bW4oY2xz\nLCBsb2NhbCwgZm9yZWlnbiwgY29sLCB0YXJnZXQsCiAgICAgICAgICAgICAg\nICAgICAgICAgIHBvcywgY29scyk7CiAgICAgICAgICAgIH0KICAgICAgICB9\nOwogICAgICAgIHJldHVybiBjcmVhdGVGb3JlaWduS2V5KGNscywgInN1cGVy\nY2xhc3MiLCBnZXRDb2x1bW5zKCksIGRlZiwgdGFibGUsCiAgICAgICAgICAg\nIGNscywgc3VwLCBmYWxzZSwgYWRhcHQpOwogICAgfQoKICAgIC8qKgogICAg\nICogU3luY2hyb25pemUgaW50ZXJuYWwgaW5mb3JtYXRpb24gd2l0aCB0aGUg\nbWFwcGluZyBkYXRhIGZvciB0aGUgZ2l2ZW4KICAgICAqIGNsYXNzLgogICAg\nICovCiAgICBwdWJsaWMgdm9pZCBzeW5jV2l0aChDbGFzc01hcHBpbmcgY2xz\nKSB7CiAgICAgICAgY2xlYXIoZmFsc2UpOwoKICAgICAgICBDbGFzc01hcHBp\nbmcgc3VwID0gY2xzLmdldE1hcHBlZFBDU3VwZXJjbGFzc01hcHBpbmcoKTsK\nICAgICAgICBpZiAoY2xzLmdldFRhYmxlKCkgIT0gbnVsbCAmJiAoc3VwID09\nIG51bGwKICAgICAgICAgICAgfHwgc3VwLmdldFRhYmxlKCkgIT0gY2xzLmdl\ndFRhYmxlKCkpKQogICAgICAgICAgICBfdGFibGVOYW1lID0gY2xzLmdldE1h\ncHBpbmdSZXBvc2l0b3J5KCkuZ2V0REJEaWN0aW9uYXJ5KCkuCiAgICAgICAg\nICAgICAgICBnZXRGdWxsTmFtZShjbHMuZ2V0VGFibGUoKSwgdHJ1ZSk7Cgog\nICAgICAgIC8vIHNldCBpbyBiZWZvcmUgc3luY2luZyBjb2xzCiAgICAgICAg\nc2V0Q29sdW1uSU8oY2xzLmdldENvbHVtbklPKCkpOwogICAgICAgIGlmIChj\nbHMuZ2V0Sm9pbkZvcmVpZ25LZXkoKSAhPSBudWxsICYmIHN1cCAhPSBudWxs\nCiAgICAgICAgICAgICYmIHN1cC5nZXRUYWJsZSgpICE9IG51bGwpCiAgICAg\nICAgICAgIHN5bmNGb3JlaWduS2V5KGNscywgY2xzLmdldEpvaW5Gb3JlaWdu\nS2V5KCksIGNscy5nZXRUYWJsZSgpLAogICAgICAgICAgICAgICAgc3VwLmdl\ndFRhYmxlKCkpOwogICAgICAgIGVsc2UgaWYgKGNscy5nZXRJZGVudGl0eVR5\ncGUoKSA9PSBDbGFzc01hcHBpbmcuSURfREFUQVNUT1JFKQogICAgICAgICAg\nICBzeW5jQ29sdW1ucyhjbHMsIGNscy5nZXRQcmltYXJ5S2V5Q29sdW1ucygp\nLCBmYWxzZSk7CgogICAgICAgIC8vIHJlY29yZCBpbmhlcml0YW5jZSBzdHJh\ndGVneSBpZiBjbGFzcyBkb2VzIG5vdCB1c2UgZGVmYXVsdCBzdHJhdGVneQog\nICAgICAgIC8vIGZvciBiYXNlIGNsYXNzZXMsIGFuZCBmb3IgYWxsIHN1YmNs\nYXNzZXMgc28gd2UgY2FuIGJlIHN1cmUgc3Vic2VxdWVudAogICAgICAgIC8v\nIG1hcHBpbmcgcnVucyBkb24ndCB0aGluayBzdWJjbGFzcyBpcyB1bm1hcHBl\nZAogICAgICAgIFN0cmluZyBzdHJhdCA9IChjbHMuZ2V0U3RyYXRlZ3koKSA9\nPSBudWxsKSA/IG51bGwKICAgICAgICAgICAgOiBjbHMuZ2V0U3RyYXRlZ3ko\nKS5nZXRBbGlhcygpOwogICAgICAgIGlmIChzdHJhdCAhPSBudWxsICYmIChj\nbHMuZ2V0UENTdXBlcmNsYXNzKCkgIT0gbnVsbAogICAgICAgICAgICB8fCAh\nRnVsbENsYXNzU3RyYXRlZ3kuQUxJQVMuZXF1YWxzKHN0cmF0KSkpCiAgICAg\nICAgICAgIHNldFN0cmF0ZWd5KHN0cmF0KTsgICAgICAgIAogICAgfQoKICAg\nIHB1YmxpYyBib29sZWFuIGhhc1NjaGVtYUNvbXBvbmVudHMoKSB7CiAgICAg\nICAgcmV0dXJuIHN1cGVyLmhhc1NjaGVtYUNvbXBvbmVudHMoKSB8fCBfdGFi\nbGVOYW1lICE9IG51bGw7CiAgICB9CgogICAgcHJvdGVjdGVkIHZvaWQgY2xl\nYXIoYm9vbGVhbiBjYW5GbGFncykgewogICAgICAgIHN1cGVyLmNsZWFyKGNh\nbkZsYWdzKTsKICAgICAgICBfdGFibGVOYW1lID0gbnVsbDsKICAgIH0KCiAg\nICBwdWJsaWMgdm9pZCBjb3B5KE1hcHBpbmdJbmZvIGluZm8pIHsKICAgICAg\nICBzdXBlci5jb3B5KGluZm8pOwogICAgICAgIGlmICghKGluZm8gaW5zdGFu\nY2VvZiBDbGFzc01hcHBpbmdJbmZvKSkKICAgICAgICAgICAgcmV0dXJuOwoK\nICAgICAgICBDbGFzc01hcHBpbmdJbmZvIGNpbmZvID0gKENsYXNzTWFwcGlu\nZ0luZm8pIGluZm87CiAgICAgICAgaWYgKF90YWJsZU5hbWUgPT0gbnVsbCkK\nICAgICAgICAgICAgX3RhYmxlTmFtZSA9IGNpbmZvLmdldFRhYmxlTmFtZSgp\nOwogICAgICAgIGlmIChfc3ViU3RyYXQgPT0gbnVsbCkKICAgICAgICAgICAg\nX3N1YlN0cmF0ID0gY2luZm8uZ2V0SGllcmFyY2h5U3RyYXRlZ3koKTsKICAg\nICAgICBpZiAoY2luZm8uX3NlY29uZHMgIT0gbnVsbCkgewogICAgICAgICAg\nICBpZiAoX3NlY29uZHMgPT0gbnVsbCkKICAgICAgICAgICAgICAgIF9zZWNv\nbmRzID0gbmV3IEhhc2hNYXAoKTsKICAgICAgICAgICAgT2JqZWN0IGtleTsK\nICAgICAgICAgICAgZm9yIChJdGVyYXRvciBpdHIgPSBjaW5mby5fc2Vjb25k\ncy5rZXlTZXQoKS5pdGVyYXRvcigpOwogICAgICAgICAgICAgICAgaXRyLmhh\nc05leHQoKTspIHsKICAgICAgICAgICAgICAgIGtleSA9IGl0ci5uZXh0KCk7\nCiAgICAgICAgICAgICAgICBpZiAoIV9zZWNvbmRzLmNvbnRhaW5zS2V5KGtl\neSkpCiAgICAgICAgICAgICAgICAgICAgX3NlY29uZHMucHV0KGtleSwgY2lu\nZm8uX3NlY29uZHMuZ2V0KGtleSkpOwogICAgICAgICAgICB9CiAgICAgICAg\nfQogICAgICAgIGlmIChjaW5mby5fdW5pcXVlcyAhPSBudWxsKSAKICAgICAg\nICAgICBfdW5pcXVlcyA9IG5ldyBBcnJheUxpc3QoY2luZm8uX3VuaXF1ZXMp\nOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIGFkZFVuaXF1ZShVbmlxdWUgdW5p\ncXVlKSB7CiAgICAgICAgaWYgKHVuaXF1ZSA9PSBudWxsKQogICAgICAgICAg\nICByZXR1cm47CiAgICAgICAgaWYgKF91bmlxdWVzID09IG51bGwpCiAgICAg\nICAgICAgIF91bmlxdWVzID0gbmV3IEFycmF5TGlzdCgpOwogICAgICAgIF91\nbmlxdWVzLmFkZCh1bmlxdWUpOwogICAgfQogICAgCiAgICBwdWJsaWMgVW5p\ncXVlW10gZ2V0VW5pcXVlcygpIHsKICAgICAgICByZXR1cm4gKF91bmlxdWVz\nID09IG51bGwpID8gbmV3IFVuaXF1ZVswXSA6CiAgICAgICAgICAgIChVbmlx\ndWVbXSlfdW5pcXVlcy50b0FycmF5KG5ldyBVbmlxdWVbX3VuaXF1ZXMuc2l6\nZSgpXSk7CiAgICB9CiAgICAKICAgIHB1YmxpYyBVbmlxdWVbXSBnZXRVbmlx\ndWVzKENsYXNzTWFwcGluZyBjbSwgYm9vbGVhbiBhZGFwdCkgewogICAgICAg\nIGlmIChfdW5pcXVlcyA9PSBudWxsIHx8IF91bmlxdWVzLmlzRW1wdHkoKSkK\nICAgICAgICAgICAgcmV0dXJuIG5ldyBVbmlxdWVbMF07CiAgICAgICAgCiAg\nICAgICAgSXRlcmF0b3IgdW5pcXVlQ29uc3RyYWludHMgPSBfdW5pcXVlcy5p\ndGVyYXRvcigpOwogICAgICAgIFRhYmxlIHRhYmxlID0gY20uZ2V0VGFibGUo\nKTsKICAgICAgICBDb2xsZWN0aW9uIHJlc3VsdCA9IG5ldyBBcnJheUxpc3Qo\nKTsKICAgICAgICB3aGlsZSAodW5pcXVlQ29uc3RyYWludHMuaGFzTmV4dCgp\nKSB7CiAgICAgICAgICAgIFVuaXF1ZSB0ZW1wbGF0ZSA9IChVbmlxdWUpIHVu\naXF1ZUNvbnN0cmFpbnRzLm5leHQoKTsKICAgICAgICAgICAgQ29sdW1uW10g\ndGVtcGxhdGVDb2x1bW5zID0gdGVtcGxhdGUuZ2V0Q29sdW1ucygpOwogICAg\nICAgICAgICBDb2x1bW5bXSB1bmlxdWVDb2x1bW5zID0gbmV3IENvbHVtblt0\nZW1wbGF0ZUNvbHVtbnMubGVuZ3RoXTsKICAgICAgICAgICAgYm9vbGVhbiBt\naXNzaW5nQ29sdW1uID0gdHJ1ZTsKICAgICAgICAgICAgZm9yIChpbnQgaT0w\nOyBpPHVuaXF1ZUNvbHVtbnMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAg\nICAgIFN0cmluZyBjb2x1bW5OYW1lID0gdGVtcGxhdGVDb2x1bW5zW2ldLmdl\ndE5hbWUoKTsKICAgICAgICAgICAgICAgIENvbHVtbiB1bmlxdWVDb2x1bW4g\nPSB0YWJsZS5nZXRDb2x1bW4oY29sdW1uTmFtZSk7CiAgICAgICAgICAgICAg\nICBtaXNzaW5nQ29sdW1uID0gKHVuaXF1ZUNvbHVtbiA9PSBudWxsKTsKICAg\nICAgICAgICAgICAgIGlmIChtaXNzaW5nQ29sdW1uKSB7CiAgICAgICAgICAg\nICAgICAgICAgdGhyb3cgbmV3IFVzZXJFeGNlcHRpb24oX2xvYy5nZXQoIm1p\nc3NpbmctdW5pcXVlLWNvbHVtbiIsIAogICAgICAgICAgICAgICAgICAgICAg\nICBjbSwgdGFibGUsIGNvbHVtbk5hbWUpKTsKICAgICAgICAgICAgICAgIH0K\nICAgICAgICAgICAgICAgIHVuaXF1ZUNvbHVtbnNbaV0gPSB1bmlxdWVDb2x1\nbW47CiAgICAgICAgICAgIH0KICAgICAgICAgICAgVW5pcXVlIHVuaXF1ZSA9\nIHN1cGVyLmNyZWF0ZVVuaXF1ZShjbSwgInVuaXF1ZSIsIHRlbXBsYXRlLCAK\nICAgICAgICAgICAgICAgIHVuaXF1ZUNvbHVtbnMsIGFkYXB0KTsKICAgICAg\nICAgICAgaWYgKHVuaXF1ZSAhPSBudWxsKQogICAgICAgICAgICAgICAgcmVz\ndWx0LmFkZCh1bmlxdWUpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gKFVu\naXF1ZVtdKSByZXN1bHQudG9BcnJheShuZXcgVW5pcXVlW3Jlc3VsdC5zaXpl\nKCldKTsKICAgIH0gICAKICAgIAogICAgcHVibGljIEZpbGUgZ2V0U291cmNl\nRmlsZSgpIHsKICAgICAgICByZXR1cm4gX2ZpbGU7CiAgICB9CgogICAgcHVi\nbGljIE9iamVjdCBnZXRTb3VyY2VTY29wZSgpIHsKICAgICAgICByZXR1cm4g\nbnVsbDsKICAgIH0KCiAgICBwdWJsaWMgaW50IGdldFNvdXJjZVR5cGUoKSB7\nCiAgICAgICAgcmV0dXJuIF9zcmNUeXBlOwogICAgfQoKICAgIHB1YmxpYyB2\nb2lkIHNldFNvdXJjZShGaWxlIGZpbGUsIGludCBzcmNUeXBlKSB7CiAgICAg\nICAgX2ZpbGUgPSBmaWxlOwogICAgICAgIF9zcmNUeXBlID0gc3JjVHlwZTsK\nICAgIH0KCiAgICBwdWJsaWMgU3RyaW5nIGdldFJlc291cmNlTmFtZSgpIHsK\nICAgICAgICByZXR1cm4gX2NsYXNzTmFtZTsKICAgIH0KCiAgICBwdWJsaWMg\nU3RyaW5nW10gZ2V0Q29tbWVudHMoKSB7CiAgICAgICAgcmV0dXJuIChfY29t\nbWVudHMgPT0gbnVsbCkgPyBFTVBUWV9DT01NRU5UUyA6IF9jb21tZW50czsK\nICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRDb21tZW50cyhTdHJpbmdbXSBj\nb21tZW50cykgewogICAgICAgIF9jb21tZW50cyA9IGNvbW1lbnRzOwogICAg\nfQp9Cg==\n","encoding":"base64"}

