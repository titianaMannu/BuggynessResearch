{"sha":"b11991f3692abb14cf3f2283fd6eb3db5b9b382d","node_id":"MDQ6QmxvYjIwNjM2NDpiMTE5OTFmMzY5MmFiYjE0Y2YzZjIyODNmZDZlYjNkYjViOWIzODJk","size":49154,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/b11991f3692abb14cf3f2283fd6eb3db5b9b382d","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhOwoKaW1wb3J0\nIGphdmEubGFuZy5yZWZsZWN0Lk1vZGlmaWVyOwppbXBvcnQgamF2YS5zZWN1\ncml0eS5BY2Nlc3NDb250cm9sbGVyOwppbXBvcnQgamF2YS5zZWN1cml0eS5Q\ncml2aWxlZ2VkQWN0aW9uRXhjZXB0aW9uOwppbXBvcnQgamF2YS5zcWwuVHlw\nZXM7CmltcG9ydCBqYXZhLnV0aWwuQ29sbGVjdGlvbjsKaW1wb3J0IGphdmEu\ndXRpbC5IYXNoTWFwOwppbXBvcnQgamF2YS51dGlsLkxpc3Q7CmltcG9ydCBq\nYXZhLnV0aWwuTWFwOwoKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJj\nLmNvbmYuSkRCQ0NvbmZpZ3VyYXRpb247CmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEuamRiYy5tZXRhLnN0cmF0cy5CbG9iVmFsdWVIYW5kbGVyOwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0YS5zdHJhdHMuQnl0ZUFy\ncmF5VmFsdWVIYW5kbGVyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpk\nYmMubWV0YS5zdHJhdHMuQ2hhckFycmF5U3RyZWFtVmFsdWVIYW5kbGVyOwpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0YS5zdHJhdHMuQ2hh\nckFycmF5VmFsdWVIYW5kbGVyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLmpkYmMubWV0YS5zdHJhdHMuQ2xhc3NOYW1lRGlzY3JpbWluYXRvclN0cmF0\nZWd5OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0YS5zdHJh\ndHMuQ2xvYlZhbHVlSGFuZGxlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3Blbmpw\nYS5qZGJjLm1ldGEuc3RyYXRzLkVsZW1lbnRFbWJlZFZhbHVlSGFuZGxlcjsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLm1ldGEuc3RyYXRzLkVt\nYmVkRmllbGRTdHJhdGVneTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5q\nZGJjLm1ldGEuc3RyYXRzLkVtYmVkZGVkQ2xhc3NTdHJhdGVneTsKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLm1ldGEuc3RyYXRzLkZsYXRDbGFz\nc1N0cmF0ZWd5OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0\nYS5zdHJhdHMuRnVsbENsYXNzU3RyYXRlZ3k7CmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEuamRiYy5tZXRhLnN0cmF0cy5IYW5kbGVyQ29sbGVjdGlvblRh\nYmxlRmllbGRTdHJhdGVneTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5q\nZGJjLm1ldGEuc3RyYXRzLkhhbmRsZXJGaWVsZFN0cmF0ZWd5OwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0YS5zdHJhdHMuSGFuZGxlckhh\nbmRsZXJNYXBUYWJsZUZpZWxkU3RyYXRlZ3k7CmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEuamRiYy5tZXRhLnN0cmF0cy5IYW5kbGVyUmVsYXRpb25NYXBU\nYWJsZUZpZWxkU3RyYXRlZ3k7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\namRiYy5tZXRhLnN0cmF0cy5JbW11dGFibGVWYWx1ZUhhbmRsZXI7CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhLnN0cmF0cy5Mb2JGaWVs\nZFN0cmF0ZWd5OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0\nYS5zdHJhdHMuTWF4RW1iZWRkZWRCbG9iRmllbGRTdHJhdGVneTsKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLm1ldGEuc3RyYXRzLk1heEVtYmVk\nZGVkQnl0ZUFycmF5RmllbGRTdHJhdGVneTsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS5qZGJjLm1ldGEuc3RyYXRzLk1heEVtYmVkZGVkQ2hhckFycmF5\nRmllbGRTdHJhdGVneTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJj\nLm1ldGEuc3RyYXRzLk1heEVtYmVkZGVkQ2xvYkZpZWxkU3RyYXRlZ3k7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhLnN0cmF0cy5OYW5v\nUHJlY2lzaW9uVGltZXN0YW1wVmVyc2lvblN0cmF0ZWd5OwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0YS5zdHJhdHMuTm9uZUNsYXNzU3Ry\nYXRlZ3k7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhLnN0\ncmF0cy5Ob25lRGlzY3JpbWluYXRvclN0cmF0ZWd5OwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLmpkYmMubWV0YS5zdHJhdHMuTm9uZUZpZWxkU3RyYXRl\nZ3k7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhLnN0cmF0\ncy5Ob25lVmVyc2lvblN0cmF0ZWd5OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLmpkYmMubWV0YS5zdHJhdHMuTnVtYmVyVmVyc2lvblN0cmF0ZWd5Owpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0YS5zdHJhdHMuT2Jq\nZWN0SWRDbGFzc1N0cmF0ZWd5OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLmpkYmMubWV0YS5zdHJhdHMuT2JqZWN0SWRWYWx1ZUhhbmRsZXI7CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhLnN0cmF0cy5QcmltaXRp\ndmVGaWVsZFN0cmF0ZWd5OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpk\nYmMubWV0YS5zdHJhdHMuUmVsYXRpb25Db2xsZWN0aW9uSW52ZXJzZUtleUZp\nZWxkU3RyYXRlZ3k7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5t\nZXRhLnN0cmF0cy5SZWxhdGlvbkNvbGxlY3Rpb25UYWJsZUZpZWxkU3RyYXRl\nZ3k7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhLnN0cmF0\ncy5SZWxhdGlvbkZpZWxkU3RyYXRlZ3k7CmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEuamRiYy5tZXRhLnN0cmF0cy5SZWxhdGlvbkhhbmRsZXJNYXBUYWJs\nZUZpZWxkU3RyYXRlZ3k7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRi\nYy5tZXRhLnN0cmF0cy5SZWxhdGlvbk1hcEludmVyc2VLZXlGaWVsZFN0cmF0\nZWd5OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0YS5zdHJh\ndHMuUmVsYXRpb25NYXBUYWJsZUZpZWxkU3RyYXRlZ3k7CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhLnN0cmF0cy5SZWxhdGlvblJlbGF0\naW9uTWFwVGFibGVGaWVsZFN0cmF0ZWd5OwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLmpkYmMubWV0YS5zdHJhdHMuU3RhdGVDb21wYXJpc29uVmVyc2lv\nblN0cmF0ZWd5OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0\nYS5zdHJhdHMuU3RyaW5nRmllbGRTdHJhdGVneTsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5qZGJjLm1ldGEuc3RyYXRzLlN1YmNsYXNzSm9pbkRpc2Ny\naW1pbmF0b3JTdHJhdGVneTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5q\nZGJjLm1ldGEuc3RyYXRzLlN1cGVyY2xhc3NEaXNjcmltaW5hdG9yU3RyYXRl\nZ3k7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhLnN0cmF0\ncy5TdXBlcmNsYXNzVmVyc2lvblN0cmF0ZWd5OwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLmpkYmMubWV0YS5zdHJhdHMuVGltZXN0YW1wVmVyc2lvblN0\ncmF0ZWd5OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0YS5z\ndHJhdHMuVW50eXBlZFBDVmFsdWVIYW5kbGVyOwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLmpkYmMubWV0YS5zdHJhdHMuVmFsdWVNYXBEaXNjcmltaW5h\ndG9yU3RyYXRlZ3k7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5t\nZXRhLnN0cmF0cy5WZXJ0aWNhbENsYXNzU3RyYXRlZ3k7CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hlbWEuQ29sdW1uOwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1hLlNjaGVtYUdyb3VwOwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc3FsLkRCRGljdGlvbmFyeTsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNxbC5Kb2luU3ludGF4\nZXM7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLmNvbmYuQ29uZmln\ndXJhYmxlOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi5jb25mLkNv\nbmZpZ3VyYXRpb25zOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51\ndGlsLkoyRG9Qcml2SGVscGVyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLmxpYi51dGlsLkphdmFWZXJzaW9uczsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5saWIudXRpbC5Mb2NhbGl6ZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEubWV0YS5DbGFzc01ldGFEYXRhOwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLm1ldGEuRmllbGRNZXRhRGF0YTsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS5tZXRhLkphdmFUeXBlczsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5tZXRhLk1ldGFEYXRhUmVwb3NpdG9yeTsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5tZXRhLk9yZGVyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLm1ldGEuU2VxdWVuY2VNZXRhRGF0YTsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS5tZXRhLlZhbHVlTWV0YURhdGE7CmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEudXRpbC5NZXRhRGF0YUV4Y2VwdGlvbjsKCi8qKgogKiBSZXBv\nc2l0b3J5IG9mIG9iamVjdC9yZWxhdGlvbmFsIG1hcHBpbmcgaW5mb3JtYXRp\nb24uCiAqCiAqIEBhdXRob3IgQWJlIFdoaXRlCiAqLwpwdWJsaWMgY2xhc3Mg\nTWFwcGluZ1JlcG9zaXRvcnkKICAgIGV4dGVuZHMgTWV0YURhdGFSZXBvc2l0\nb3J5IHsKCiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBMb2NhbGl6ZXIgX2xv\nYyA9IExvY2FsaXplci5mb3JQYWNrYWdlCiAgICAgICAgKE1hcHBpbmdSZXBv\nc2l0b3J5LmNsYXNzKTsKCiAgICBwcml2YXRlIHRyYW5zaWVudCBEQkRpY3Rp\nb25hcnkgX2RpY3QgPSBudWxsOwogICAgcHJpdmF0ZSB0cmFuc2llbnQgTWFw\ncGluZ0RlZmF1bHRzIF9kZWZhdWx0cyA9IG51bGw7CiAgICAKICAgIHByaXZh\ndGUgTWFwIF9yZXN1bHRzID0gbmV3IEhhc2hNYXAoKTsgLy8gb2JqZWN0LT5x\ndWVyeXJlc3VsdG1hcHBpbmcKICAgIHByaXZhdGUgU2NoZW1hR3JvdXAgX3Nj\naGVtYSA9IG51bGw7CiAgICBwcml2YXRlIFN0cmF0ZWd5SW5zdGFsbGVyIF9p\nbnN0YWxsZXIgPSBudWxsOwoKICAgIC8qKgogICAgICogRGVmYXVsdCBjb25z\ndHJ1Y3Rvci4gIENvbmZpZ3VyZSB2aWEgCiAgICAgKiB7QGxpbmsgb3JnLmFw\nYWNoZS5vcGVuanBhLmxpYi5jb25mLkNvbmZpZ3VyYWJsZX0uCiAgICAgKi8K\nICAgIHB1YmxpYyBNYXBwaW5nUmVwb3NpdG9yeSgpIHsKICAgICAgICBzZXRW\nYWxpZGF0ZShWQUxJREFURV9NQVBQSU5HLCB0cnVlKTsKICAgIH0KCiAgICAv\nKioKICAgICAqIENvbnZlbmllbnQgYWNjZXNzIHRvIGRpY3Rpb25hcnkgZm9y\nIG1hcHBpbmdzLgogICAgICovCiAgICBwdWJsaWMgREJEaWN0aW9uYXJ5IGdl\ndERCRGljdGlvbmFyeSgpIHsKICAgICAgICByZXR1cm4gX2RpY3Q7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBNYXBwaW5nIGRlZmF1bHRzLgogICAgICovCiAg\nICBwdWJsaWMgTWFwcGluZ0RlZmF1bHRzIGdldE1hcHBpbmdEZWZhdWx0cygp\nIHsKICAgICAgICByZXR1cm4gX2RlZmF1bHRzOwogICAgfQoKICAgIC8qKgog\nICAgICogTWFwcGluZyBkZWZhdWx0LgogICAgICovCiAgICBwdWJsaWMgdm9p\nZCBzZXRNYXBwaW5nRGVmYXVsdHMoTWFwcGluZ0RlZmF1bHRzIGRlZmF1bHRz\nKSB7CiAgICAgICAgX2RlZmF1bHRzID0gZGVmYXVsdHM7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBSZXByZXNlbnRhdGlvbiBvZiB0aGUgZGF0YWJhc2Ugc2No\nZW1hLgogICAgICovCiAgICBwdWJsaWMgc3luY2hyb25pemVkIFNjaGVtYUdy\nb3VwIGdldFNjaGVtYUdyb3VwKCkgewogICAgICAgIGlmIChfc2NoZW1hID09\nIG51bGwpCiAgICAgICAgICAgIF9zY2hlbWEgPSAoKEpEQkNDb25maWd1cmF0\naW9uKSBnZXRDb25maWd1cmF0aW9uKCkpLgogICAgICAgICAgICAgICAgZ2V0\nU2NoZW1hRmFjdG9yeUluc3RhbmNlKCkucmVhZFNjaGVtYSgpOwogICAgICAg\nIHJldHVybiBfc2NoZW1hOwogICAgfQoKICAgIC8qKgogICAgICogUmVwcmVz\nZW50YXRpb24gb2YgdGhlIGRhdGFiYXNlIHNjaGVtYS4KICAgICAqLwogICAg\ncHVibGljIHN5bmNocm9uaXplZCB2b2lkIHNldFNjaGVtYUdyb3VwKFNjaGVt\nYUdyb3VwIHNjaGVtYSkgewogICAgICAgIF9zY2hlbWEgPSBzY2hlbWE7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBJbnN0YWxscyBtYXBwaW5nIHN0cmF0ZWdp\nZXMgb24gY29tcG9uZW50cy4KICAgICAqLwogICAgcHVibGljIHN5bmNocm9u\naXplZCBTdHJhdGVneUluc3RhbGxlciBnZXRTdHJhdGVneUluc3RhbGxlcigp\nIHsKICAgICAgICBpZiAoX2luc3RhbGxlciA9PSBudWxsKQogICAgICAgICAg\nICBfaW5zdGFsbGVyID0gbmV3IFJ1bnRpbWVTdHJhdGVneUluc3RhbGxlcih0\naGlzKTsKICAgICAgICByZXR1cm4gX2luc3RhbGxlcjsKICAgIH0KCiAgICAv\nKioKICAgICAqIEluc3RhbGxzIG1hcHBpbmcgc3RyYXRlZ2llcyBvbiBjb21w\nb25lbnRzLgogICAgICovCiAgICBwdWJsaWMgc3luY2hyb25pemVkIHZvaWQg\nc2V0U3RyYXRlZ3lJbnN0YWxsZXIoU3RyYXRlZ3lJbnN0YWxsZXIgaW5zdGFs\nbGVyKSB7CiAgICAgICAgX2luc3RhbGxlciA9IGluc3RhbGxlcjsKICAgIH0K\nCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgcXVlcnkgcmVzdWx0IG1hcHBp\nbmcgZm9yIHRoZSBnaXZlbiBuYW1lLgogICAgICovCiAgICBwdWJsaWMgc3lu\nY2hyb25pemVkIFF1ZXJ5UmVzdWx0TWFwcGluZyBnZXRRdWVyeVJlc3VsdE1h\ncHBpbmcoQ2xhc3MgY2xzLAogICAgICAgIFN0cmluZyBuYW1lLCBDbGFzc0xv\nYWRlciBlbnZMb2FkZXIsIGJvb2xlYW4gbXVzdEV4aXN0KSB7CiAgICAgICAg\nUXVlcnlSZXN1bHRNYXBwaW5nIHJlcyA9IGdldFF1ZXJ5UmVzdWx0TWFwcGlu\nZ0ludGVybmFsKGNscywgbmFtZSwKICAgICAgICAgICAgZW52TG9hZGVyKTsK\nICAgICAgICBpZiAocmVzID09IG51bGwgJiYgbXVzdEV4aXN0KQogICAgICAg\nICAgICB0aHJvdyBuZXcgTWV0YURhdGFFeGNlcHRpb24oX2xvYy5nZXQoIm5v\nLXF1ZXJ5LXJlcyIsIGNscywgbmFtZSkpOwogICAgICAgIHJldHVybiByZXM7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm5lZCB0aGUgcXVlcnkgcmVz\ndWx0IG1hcHBpbmcgd2l0aCB0aGUgZ2l2ZW4gbmFtZS4KICAgICAqLwogICAg\ncHJpdmF0ZSBRdWVyeVJlc3VsdE1hcHBpbmcgZ2V0UXVlcnlSZXN1bHRNYXBw\naW5nSW50ZXJuYWwoQ2xhc3MgY2xzLAogICAgICAgIFN0cmluZyBuYW1lLCBD\nbGFzc0xvYWRlciBlbnZMb2FkZXIpIHsKICAgICAgICBpZiAobmFtZSA9PSBu\ndWxsKQogICAgICAgICAgICByZXR1cm4gbnVsbDsKCiAgICAgICAgLy8gY2hl\nY2sgY2FjaGUKICAgICAgICBPYmplY3Qga2V5ID0gZ2V0UXVlcnlSZXN1bHRL\nZXkoY2xzLCBuYW1lKTsKICAgICAgICBRdWVyeVJlc3VsdE1hcHBpbmcgcmVz\nID0gKFF1ZXJ5UmVzdWx0TWFwcGluZykgX3Jlc3VsdHMuZ2V0KGtleSk7CiAg\nICAgICAgaWYgKHJlcyAhPSBudWxsKQogICAgICAgICAgICByZXR1cm4gcmVz\nOwoKICAgICAgICAvLyBnZXQgbWV0YWRhdGEgZm9yIGNsYXNzLCB3aGljaCB3\naWxsIGZpbmQgcmVzdWx0cyBpbiBtZXRhZGF0YSBmaWxlCiAgICAgICAgaWYg\nKGNscyAhPSBudWxsICYmIGdldE1ldGFEYXRhKGNscywgZW52TG9hZGVyLCBm\nYWxzZSkgIT0gbnVsbCkgewogICAgICAgICAgICByZXMgPSAoUXVlcnlSZXN1\nbHRNYXBwaW5nKSBfcmVzdWx0cy5nZXQoa2V5KTsKICAgICAgICAgICAgaWYg\nKHJlcyAhPSBudWxsKQogICAgICAgICAgICAgICAgcmV0dXJuIHJlczsKICAg\nICAgICB9CiAgICAgICAgaWYgKChnZXRTb3VyY2VNb2RlKCkgJiBNT0RFX1FV\nRVJZKSA9PSAwKQogICAgICAgICAgICByZXR1cm4gbnVsbDsKCiAgICAgICAg\naWYgKGNscyA9PSBudWxsKQogICAgICAgICAgICBjbHMgPSBnZXRNZXRhRGF0\nYUZhY3RvcnkoKQogICAgICAgICAgICAgICAgICAgIC5nZXRSZXN1bHRTZXRN\nYXBwaW5nU2NvcGUobmFtZSwgZW52TG9hZGVyKTsKICAgICAgICAvLyBub3Qg\naW4gY2FjaGU7IGxvYWQKICAgICAgICBnZXRNZXRhRGF0YUZhY3RvcnkoKS5s\nb2FkKGNscywgTU9ERV9NRVRBIHwgTU9ERV9NQVBQSU5HLCBlbnZMb2FkZXIp\nOwogICAgICAgIHJldHVybiAoUXVlcnlSZXN1bHRNYXBwaW5nKSBfcmVzdWx0\ncy5nZXQoa2V5KTsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiBhbGwg\nY2FjaGVkIHF1ZXJ5IHJlc3VsdCBtYXBwaW5ncy4KICAgICAqLwogICAgcHVi\nbGljIHN5bmNocm9uaXplZCBRdWVyeVJlc3VsdE1hcHBpbmdbXSBnZXRRdWVy\neVJlc3VsdE1hcHBpbmdzKCkgewogICAgICAgIENvbGxlY3Rpb24gdmFsdWVz\nID0gX3Jlc3VsdHMudmFsdWVzKCk7CiAgICAgICAgcmV0dXJuIChRdWVyeVJl\nc3VsdE1hcHBpbmdbXSkgdmFsdWVzLnRvQXJyYXkKICAgICAgICAgICAgKG5l\ndyBRdWVyeVJlc3VsdE1hcHBpbmdbdmFsdWVzLnNpemUoKV0pOwogICAgfQoK\nICAgIC8qKgogICAgICogUmV0dXJuIHRoZSBjYWNoZWQgcXVlcnkgcmVzdWx0\nIG1hcHBpbmcgd2l0aCB0aGUgZ2l2ZW4gbmFtZSwgb3IgbnVsbCBpZgogICAg\nICogbm9uZS4KICAgICAqLwogICAgcHVibGljIHN5bmNocm9uaXplZCBRdWVy\neVJlc3VsdE1hcHBpbmcgZ2V0Q2FjaGVkUXVlcnlSZXN1bHRNYXBwaW5nCiAg\nICAgICAgKENsYXNzIGNscywgU3RyaW5nIG5hbWUpIHsKICAgICAgICByZXR1\ncm4gKFF1ZXJ5UmVzdWx0TWFwcGluZykgX3Jlc3VsdHMuZ2V0KGdldFF1ZXJ5\nUmVzdWx0S2V5KGNscywgbmFtZSkpOwogICAgfQoKICAgIC8qKgogICAgICog\nQWRkIGEgcXVlcnkgcmVzdWx0IG1hcHBpbmcuCiAgICAgKi8KICAgIHB1Ymxp\nYyBzeW5jaHJvbml6ZWQgUXVlcnlSZXN1bHRNYXBwaW5nIGFkZFF1ZXJ5UmVz\ndWx0TWFwcGluZyhDbGFzcyBjbHMsCiAgICAgICAgU3RyaW5nIG5hbWUpIHsK\nICAgICAgICBRdWVyeVJlc3VsdE1hcHBpbmcgcmVzID0gbmV3IFF1ZXJ5UmVz\ndWx0TWFwcGluZyhuYW1lLCB0aGlzKTsKICAgICAgICByZXMuc2V0RGVmaW5p\nbmdUeXBlKGNscyk7CiAgICAgICAgX3Jlc3VsdHMucHV0KGdldFF1ZXJ5UmVz\ndWx0S2V5KHJlcyksIHJlcyk7CiAgICAgICAgcmV0dXJuIHJlczsKICAgIH0K\nCiAgICAvKioKICAgICAqIFJlbW92ZSBhIHF1ZXJ5IHJlc3VsdCBtYXBwaW5n\nLgogICAgICovCiAgICBwdWJsaWMgc3luY2hyb25pemVkIGJvb2xlYW4gcmVt\nb3ZlUXVlcnlSZXN1bHRNYXBwaW5nCiAgICAgICAgKFF1ZXJ5UmVzdWx0TWFw\ncGluZyByZXMpIHsKICAgICAgICByZXR1cm4gX3Jlc3VsdHMucmVtb3ZlKGdl\ndFF1ZXJ5UmVzdWx0S2V5KHJlcykpICE9IG51bGw7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBSZW1vdmUgYSBxdWVyeSByZXN1bHQgbWFwcGluZy4KICAgICAq\nLwogICAgcHVibGljIHN5bmNocm9uaXplZCBib29sZWFuIHJlbW92ZVF1ZXJ5\nUmVzdWx0TWFwcGluZyhDbGFzcyBjbHMsCiAgICAgICAgU3RyaW5nIG5hbWUp\nIHsKICAgICAgICBpZiAobmFtZSA9PSBudWxsKQogICAgICAgICAgICByZXR1\ncm4gZmFsc2U7CiAgICAgICAgcmV0dXJuIF9yZXN1bHRzLnJlbW92ZShnZXRR\ndWVyeVJlc3VsdEtleShjbHMsIG5hbWUpKSAhPSBudWxsOwogICAgfQoKICAg\nIC8qKgogICAgICogUmV0dXJuIGEgdW5pcXVlIGtleSBmb3IgdGhlIGdpdmVu\nIG1hcHBpbmcuCiAgICAgKi8KICAgIHByaXZhdGUgc3RhdGljIE9iamVjdCBn\nZXRRdWVyeVJlc3VsdEtleShRdWVyeVJlc3VsdE1hcHBpbmcgcmVzKSB7CiAg\nICAgICAgaWYgKHJlcyA9PSBudWxsKQogICAgICAgICAgICByZXR1cm4gbnVs\nbDsKICAgICAgICByZXR1cm4gZ2V0UXVlcnlSZXN1bHRLZXkocmVzLmdldERl\nZmluaW5nVHlwZSgpLCByZXMuZ2V0TmFtZSgpKTsKICAgIH0KCiAgICAvKioK\nICAgICAqIFJldHVybiBhIHVuaXF1ZSBrZXkgZm9yIHRoZSBnaXZlbiBjbGFz\ncyAvIG5hbWUuIFRoZSBjbGFzcyBhcmd1bWVudAogICAgICogY2FuIGJlIG51\nbGwuCiAgICAgKi8KICAgIHByaXZhdGUgc3RhdGljIE9iamVjdCBnZXRRdWVy\neVJlc3VsdEtleShDbGFzcyBjbHMsIFN0cmluZyBuYW1lKSB7CiAgICAgICAg\ncmV0dXJuIGdldFF1ZXJ5S2V5KGNscywgbmFtZSk7CiAgICB9CgogICAgcHVi\nbGljIENsYXNzTWFwcGluZyBnZXRNYXBwaW5nKENsYXNzIGNscywgQ2xhc3NM\nb2FkZXIgZW52TG9hZGVyLAogICAgICAgIGJvb2xlYW4gbXVzdEV4aXN0KSB7\nCiAgICAgICAgcmV0dXJuIChDbGFzc01hcHBpbmcpIHN1cGVyLmdldE1ldGFE\nYXRhKGNscywgZW52TG9hZGVyLCBtdXN0RXhpc3QpOwogICAgfQoKICAgIHB1\nYmxpYyBDbGFzc01hcHBpbmdbXSBnZXRNYXBwaW5ncygpIHsKICAgICAgICBy\nZXR1cm4gKENsYXNzTWFwcGluZ1tdKSBzdXBlci5nZXRNZXRhRGF0YXMoKTsK\nICAgIH0KCiAgICBwdWJsaWMgQ2xhc3NNYXBwaW5nIGdldE1hcHBpbmcoT2Jq\nZWN0IG9pZCwgQ2xhc3NMb2FkZXIgZW52TG9hZGVyLAogICAgICAgIGJvb2xl\nYW4gbXVzdEV4aXN0KSB7CiAgICAgICAgcmV0dXJuIChDbGFzc01hcHBpbmcp\nIHN1cGVyLmdldE1ldGFEYXRhKG9pZCwgZW52TG9hZGVyLCBtdXN0RXhpc3Qp\nOwogICAgfQoKICAgIHB1YmxpYyBDbGFzc01hcHBpbmdbXSBnZXRJbXBsZW1l\nbnRvck1hcHBpbmdzKENsYXNzIGNscywKICAgICAgICBDbGFzc0xvYWRlciBl\nbnZMb2FkZXIsIGJvb2xlYW4gbXVzdEV4aXN0KSB7CiAgICAgICAgcmV0dXJu\nIChDbGFzc01hcHBpbmdbXSkgc3VwZXIuZ2V0SW1wbGVtZW50b3JNZXRhRGF0\nYXMoY2xzLCBlbnZMb2FkZXIsCiAgICAgICAgICAgIG11c3RFeGlzdCk7CiAg\nICB9CgogICAgcHVibGljIHN5bmNocm9uaXplZCB2b2lkIGNsZWFyKCkgewog\nICAgICAgIHN1cGVyLmNsZWFyKCk7CiAgICAgICAgX3NjaGVtYSA9IG51bGw7\nCiAgICAgICAgX3Jlc3VsdHMuY2xlYXIoKTsKICAgIH0KCiAgICBwcm90ZWN0\nZWQgdm9pZCBwcmVwYXJlTWFwcGluZyhDbGFzc01ldGFEYXRhIG1ldGEpIHsK\nICAgICAgICAvLyBtYWtlIHN1cmUgc3VwZXJjbGFzcyByZXNvbHZlZCBmaXJz\ndDsgcmVzb2x2aW5nIHN1cGVyY2xhc3MgbWF5IGhhdmUKICAgICAgICAvLyBy\nZXNvbHZlZCB0aGlzIG1hcHBpbmcKICAgICAgICBDbGFzc01hcHBpbmcgbWFw\ncGluZyA9IChDbGFzc01hcHBpbmcpIG1ldGE7CiAgICAgICAgQ2xhc3NNYXBw\naW5nIHN1cCA9IG1hcHBpbmcuZ2V0UENTdXBlcmNsYXNzTWFwcGluZygpOwog\nICAgICAgIGlmIChzdXAgIT0gbnVsbCAmJiAobWFwcGluZy5nZXRSZXNvbHZl\nKCkgJiBNT0RFX01BUFBJTkcpICE9IDApCiAgICAgICAgICAgIHJldHVybjsK\nCiAgICAgICAgLy8gZGVmaW5lIHN1cGVyY2xhc3MgZmllbGRzIGFmdGVyIG1h\ncHBpbmcgY2xhc3MsIHNvIHdlIGNhbiB0ZWxsIHdoZXRoZXIKICAgICAgICAv\nLyB0aGUgY2xhc3MgaXMgbWFwcGVkIGFuZCBuZWVkcyB0byByZWRlZmluZSBh\nYnN0cmFjdCBzdXBlcmNsYXNzIGZpZWxkcwogICAgICAgIGdldFN0cmF0ZWd5\nSW5zdGFsbGVyKCkuaW5zdGFsbFN0cmF0ZWd5KG1hcHBpbmcpOwogICAgICAg\nIG1hcHBpbmcuZGVmaW5lU3VwZXJjbGFzc0ZpZWxkcyhtYXBwaW5nLmdldEpv\naW5hYmxlUENTdXBlcmNsYXNzTWFwcGluZygpCiAgICAgICAgICAgID09IG51\nbGwpOwoKICAgICAgICAvLyByZXNvbHZlIGV2ZXJ5dGhpbmcgdGhhdCBkb2Vz\nbid0IGludm9sdmUgcmVsYXRpb25zIHRvIGFsbG93IHJlbGF0aW9uCiAgICAg\nICAgLy8gbWFwcGluZ3MgdG8gdXNlIHRoZSBvdGhlcnMgYXMgam9pbmFibGVz\nCiAgICAgICAgbWFwcGluZy5yZXNvbHZlTm9uUmVsYXRpb25NYXBwaW5ncygp\nOwogICAgfQoKICAgIHByb3RlY3RlZCBDbGFzc01ldGFEYXRhIG5ld0NsYXNz\nTWV0YURhdGEoQ2xhc3MgdHlwZSkgewogICAgICAgIHJldHVybiBuZXcgQ2xh\nc3NNYXBwaW5nKHR5cGUsIHRoaXMpOwogICAgfQoKICAgIHByb3RlY3RlZCBD\nbGFzc01ldGFEYXRhW10gbmV3Q2xhc3NNZXRhRGF0YUFycmF5KGludCBsZW5n\ndGgpIHsKICAgICAgICByZXR1cm4gbmV3IENsYXNzTWFwcGluZ1tsZW5ndGhd\nOwogICAgfQoKICAgIHByb3RlY3RlZCBGaWVsZE1ldGFEYXRhIG5ld0ZpZWxk\nTWV0YURhdGEoU3RyaW5nIG5hbWUsIENsYXNzIHR5cGUsCiAgICAgICAgQ2xh\nc3NNZXRhRGF0YSBvd25lcikgewogICAgICAgIHJldHVybiBuZXcgRmllbGRN\nYXBwaW5nKG5hbWUsIHR5cGUsIChDbGFzc01hcHBpbmcpIG93bmVyKTsKICAg\nIH0KCiAgICBwcm90ZWN0ZWQgRmllbGRNZXRhRGF0YVtdIG5ld0ZpZWxkTWV0\nYURhdGFBcnJheShpbnQgbGVuZ3RoKSB7CiAgICAgICAgcmV0dXJuIG5ldyBG\naWVsZE1hcHBpbmdbbGVuZ3RoXTsKICAgIH0KCiAgICBwcm90ZWN0ZWQgQ2xh\nc3NNZXRhRGF0YSBuZXdFbWJlZGRlZENsYXNzTWV0YURhdGEoVmFsdWVNZXRh\nRGF0YSBvd25lcikgewogICAgICAgIHJldHVybiBuZXcgQ2xhc3NNYXBwaW5n\nKG93bmVyKTsKICAgIH0KCiAgICBwcm90ZWN0ZWQgVmFsdWVNZXRhRGF0YSBu\nZXdWYWx1ZU1ldGFEYXRhKEZpZWxkTWV0YURhdGEgb3duZXIpIHsKICAgICAg\nICByZXR1cm4gbmV3IFZhbHVlTWFwcGluZ0ltcGwoKEZpZWxkTWFwcGluZykg\nb3duZXIpOwogICAgfQoKICAgIHByb3RlY3RlZCBTZXF1ZW5jZU1ldGFEYXRh\nIG5ld1NlcXVlbmNlTWV0YURhdGEoU3RyaW5nIG5hbWUpIHsKICAgICAgICBy\nZXR1cm4gbmV3IFNlcXVlbmNlTWFwcGluZyhuYW1lLCB0aGlzKTsKICAgIH0K\nCiAgICBwcm90ZWN0ZWQgT3JkZXIgbmV3VmFsdWVPcmRlcihGaWVsZE1ldGFE\nYXRhIG93bmVyLCBib29sZWFuIGFzYykgewogICAgICAgIHJldHVybiBuZXcg\nSkRCQ1ZhbHVlT3JkZXIoKEZpZWxkTWFwcGluZykgb3duZXIsIGFzYyk7CiAg\nICB9CgogICAgcHJvdGVjdGVkIE9yZGVyIG5ld1JlbGF0ZWRGaWVsZE9yZGVy\nKEZpZWxkTWV0YURhdGEgb3duZXIsCiAgICAgICAgRmllbGRNZXRhRGF0YSBy\nZWwsIGJvb2xlYW4gYXNjKSB7CiAgICAgICAgcmV0dXJuIG5ldyBKREJDUmVs\nYXRlZEZpZWxkT3JkZXIoKEZpZWxkTWFwcGluZykgb3duZXIsCiAgICAgICAg\nICAgIChGaWVsZE1hcHBpbmcpIHJlbCwgYXNjKTsKICAgIH0KCiAgICBwcm90\nZWN0ZWQgT3JkZXJbXSBuZXdPcmRlckFycmF5KGludCBzaXplKSB7CiAgICAg\nICAgcmV0dXJuIG5ldyBKREJDT3JkZXJbc2l6ZV07CiAgICB9CgogICAgLyoq\nCiAgICAgKiBDcmVhdGUgdmVyc2lvbiBtZXRhZGF0YSBmb3IgdGhlIGdpdmVu\nIGNsYXNzLgogICAgICovCiAgICBwcm90ZWN0ZWQgVmVyc2lvbiBuZXdWZXJz\naW9uKENsYXNzTWFwcGluZyBjbHMpIHsKICAgICAgICByZXR1cm4gbmV3IFZl\ncnNpb24oY2xzKTsKICAgIH0KCiAgICAvKioKICAgICAqIENyZWF0ZSBkaXNj\ncmltaW5hdG9yIG1ldGFkYXRhIGZvciB0aGUgZ2l2ZW4gY2xhc3MuCiAgICAg\nKi8KICAgIHByb3RlY3RlZCBEaXNjcmltaW5hdG9yIG5ld0Rpc2NyaW1pbmF0\nb3IoQ2xhc3NNYXBwaW5nIGNscykgewogICAgICAgIHJldHVybiBuZXcgRGlz\nY3JpbWluYXRvcihjbHMpOwogICAgfQoKICAgIC8qKgogICAgICogQ3JlYXRl\nIHJhdyBtYXBwaW5nIGluZm8gZm9yIHRoZSBnaXZlbiBpbnN0YW5jZS4KICAg\nICAqLwogICAgcHJvdGVjdGVkIENsYXNzTWFwcGluZ0luZm8gbmV3TWFwcGlu\nZ0luZm8oQ2xhc3NNYXBwaW5nIGNscykgewogICAgICAgIENsYXNzTWFwcGlu\nZ0luZm8gaW5mbyA9IG5ldyBDbGFzc01hcHBpbmdJbmZvKCk7CiAgICAgICAg\naW5mby5zZXRDbGFzc05hbWUoY2xzLmdldERlc2NyaWJlZFR5cGUoKS5nZXRO\nYW1lKCkpOwogICAgICAgIHJldHVybiBpbmZvOwogICAgfQoKICAgIC8qKgog\nICAgICogQ3JlYXRlIHJhdyBtYXBwaW5nIGluZm8gZm9yIHRoZSBnaXZlbiBp\nbnN0YW5jZS4KICAgICAqLwogICAgcHJvdGVjdGVkIEZpZWxkTWFwcGluZ0lu\nZm8gbmV3TWFwcGluZ0luZm8oRmllbGRNYXBwaW5nIGZtKSB7CiAgICAgICAg\ncmV0dXJuIG5ldyBGaWVsZE1hcHBpbmdJbmZvKCk7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBDcmVhdGUgcmF3IG1hcHBpbmcgaW5mbyBmb3IgdGhlIGdpdmVu\nIGluc3RhbmNlLgogICAgICovCiAgICBwcm90ZWN0ZWQgVmFsdWVNYXBwaW5n\nSW5mbyBuZXdNYXBwaW5nSW5mbyhWYWx1ZU1hcHBpbmcgdm0pIHsKICAgICAg\nICByZXR1cm4gbmV3IFZhbHVlTWFwcGluZ0luZm8oKTsKICAgIH0KCiAgICAv\nKioKICAgICAqIENyZWF0ZSByYXcgbWFwcGluZyBpbmZvIGZvciB0aGUgZ2l2\nZW4gaW5zdGFuY2UuCiAgICAgKi8KICAgIHByb3RlY3RlZCBWZXJzaW9uTWFw\ncGluZ0luZm8gbmV3TWFwcGluZ0luZm8oVmVyc2lvbiB2ZXJzaW9uKSB7CiAg\nICAgICAgcmV0dXJuIG5ldyBWZXJzaW9uTWFwcGluZ0luZm8oKTsKICAgIH0K\nCiAgICAvKioKICAgICAqIENyZWF0ZSByYXcgbWFwcGluZyBpbmZvIGZvciB0\naGUgZ2l2ZW4gaW5zdGFuY2UuCiAgICAgKi8KICAgIHByb3RlY3RlZCBEaXNj\ncmltaW5hdG9yTWFwcGluZ0luZm8gbmV3TWFwcGluZ0luZm8oRGlzY3JpbWlu\nYXRvciBkaXNjKSB7CiAgICAgICAgcmV0dXJuIG5ldyBEaXNjcmltaW5hdG9y\nTWFwcGluZ0luZm8oKTsKICAgIH0KCiAgICAvKioKICAgICAqIEluc3RhbnRp\nYXRlIHRoZSBnaXZlbiBjbGFzcycgbmFtZWQgc3RyYXRlZ3ksIG9yIHJldHVy\nbiBudWxsIGlmIG5vCiAgICAgKiBuYW1lZCBzdHJhdGVneS4KICAgICAqLwog\nICAgcHJvdGVjdGVkIENsYXNzU3RyYXRlZ3kgbmFtZWRTdHJhdGVneShDbGFz\nc01hcHBpbmcgY2xzKSB7CiAgICAgICAgU3RyaW5nIG5hbWUgPSBjbHMuZ2V0\nTWFwcGluZ0luZm8oKS5nZXRTdHJhdGVneSgpOwogICAgICAgIHJldHVybiBp\nbnN0YW50aWF0ZUNsYXNzU3RyYXRlZ3kobmFtZSwgY2xzKTsKICAgIH0KCiAg\nICAvKioKICAgICAqIFJldHVybiB0aGUgc3RyYXRlZ3kgZm9yIHRoZSBnaXZl\nbiBuYW1lLgogICAgICovCiAgICBwcm90ZWN0ZWQgQ2xhc3NTdHJhdGVneSBp\nbnN0YW50aWF0ZUNsYXNzU3RyYXRlZ3koU3RyaW5nIG5hbWUsCiAgICAgICAg\nQ2xhc3NNYXBwaW5nIGNscykgewogICAgICAgIGlmIChuYW1lID09IG51bGwp\nCiAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgIGlmIChOb25lQ2xh\nc3NTdHJhdGVneS5BTElBUy5lcXVhbHMobmFtZSkpCiAgICAgICAgICAgIHJl\ndHVybiBOb25lQ2xhc3NTdHJhdGVneS5nZXRJbnN0YW5jZSgpOwoKICAgICAg\nICBTdHJpbmcgcHJvcHMgPSBDb25maWd1cmF0aW9ucy5nZXRQcm9wZXJ0aWVz\nKG5hbWUpOwogICAgICAgIG5hbWUgPSBDb25maWd1cmF0aW9ucy5nZXRDbGFz\nc05hbWUobmFtZSk7CiAgICAgICAgQ2xhc3Mgc3RyYXQgPSBudWxsOwoKICAg\nICAgICAvLyBiYXNlIGFuZCB2ZXJ0aWNhbCBzdHJhdGVnaWVzIHVzZSBzYW1l\nIGFsaWFzOyBkaWZmZXJlbnRpYXRlIG9uIGpvaW4KICAgICAgICBpZiAoRnVs\nbENsYXNzU3RyYXRlZ3kuQUxJQVMuZXF1YWxzKG5hbWUpKQogICAgICAgICAg\nICBzdHJhdCA9IEZ1bGxDbGFzc1N0cmF0ZWd5LmNsYXNzOwogICAgICAgIGVs\nc2UgaWYgKEZsYXRDbGFzc1N0cmF0ZWd5LkFMSUFTLmVxdWFscyhuYW1lKSkK\nICAgICAgICAgICAgc3RyYXQgPSBGbGF0Q2xhc3NTdHJhdGVneS5jbGFzczsK\nICAgICAgICBlbHNlIGlmIChWZXJ0aWNhbENsYXNzU3RyYXRlZ3kuQUxJQVMu\nZXF1YWxzKG5hbWUpKQogICAgICAgICAgICBzdHJhdCA9IFZlcnRpY2FsQ2xh\nc3NTdHJhdGVneS5jbGFzczsKICAgICAgICB0cnkgewogICAgICAgICAgICBp\nZiAoc3RyYXQgPT0gbnVsbCkKICAgICAgICAgICAgICAgIHN0cmF0ID0gSmF2\nYVR5cGVzLmNsYXNzRm9yTmFtZShuYW1lLCBjbHMsCiAgICAgICAgICAgICAg\nICAgICAgKENsYXNzTG9hZGVyKSBBY2Nlc3NDb250cm9sbGVyLmRvUHJpdmls\nZWdlZCgKICAgICAgICAgICAgICAgICAgICAgICAgSjJEb1ByaXZIZWxwZXIu\nZ2V0Q2xhc3NMb2FkZXJBY3Rpb24oCiAgICAgICAgICAgICAgICAgICAgICAg\nICAgICBDbGFzc1N0cmF0ZWd5LmNsYXNzKSkpOwogICAgICAgICAgICBDbGFz\nc1N0cmF0ZWd5IHN0cmF0ZWd5ID0gCiAgICAgICAgICAgICAgICAoQ2xhc3NT\ndHJhdGVneSkgQWNjZXNzQ29udHJvbGxlci5kb1ByaXZpbGVnZWQoCiAgICAg\nICAgICAgICAgICAgICAgSjJEb1ByaXZIZWxwZXIubmV3SW5zdGFuY2VBY3Rp\nb24oc3RyYXQpKTsKICAgICAgICAgICAgQ29uZmlndXJhdGlvbnMuY29uZmln\ndXJlSW5zdGFuY2Uoc3RyYXRlZ3ksIGdldENvbmZpZ3VyYXRpb24oKSwKICAg\nICAgICAgICAgICAgIHByb3BzKTsKICAgICAgICAgICAgcmV0dXJuIHN0cmF0\nZWd5OwogICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAg\nICAgIGlmIChlIGluc3RhbmNlb2YgUHJpdmlsZWdlZEFjdGlvbkV4Y2VwdGlv\nbikKICAgICAgICAgICAgICAgIGUgPSAoKFByaXZpbGVnZWRBY3Rpb25FeGNl\ncHRpb24pIGUpLmdldEV4Y2VwdGlvbigpOwogICAgICAgICAgICB0aHJvdyBu\nZXcgTWV0YURhdGFFeGNlcHRpb24oX2xvYy5nZXQoImJhZC1jbHMtc3RyYXRl\nZ3kiLAogICAgICAgICAgICAgICAgY2xzLCBuYW1lKSwgZSk7CiAgICAgICAg\nfQogICAgfQoKICAgIC8qKgogICAgICogSW5zdGFudGlhdGUgdGhlIGdpdmVu\nIGZpZWxkJ3MgbmFtZWQgc3RyYXRlZ3ksIG9yIHJldHVybiBudWxsIGlmIG5v\nCiAgICAgKiBuYW1lZCBzdHJhdGVneS4KICAgICAqLwogICAgcHJvdGVjdGVk\nIEZpZWxkU3RyYXRlZ3kgbmFtZWRTdHJhdGVneShGaWVsZE1hcHBpbmcgZmll\nbGQsCiAgICAgICAgYm9vbGVhbiBpbnN0YWxsSGFuZGxlcnMpIHsKICAgICAg\nICBTdHJpbmcgbmFtZSA9IGZpZWxkLmdldE1hcHBpbmdJbmZvKCkuZ2V0U3Ry\nYXRlZ3koKTsKICAgICAgICBpZiAobmFtZSA9PSBudWxsKQogICAgICAgICAg\nICByZXR1cm4gbnVsbDsKCiAgICAgICAgaWYgKE5vbmVGaWVsZFN0cmF0ZWd5\nLkFMSUFTLmVxdWFscyhuYW1lKSkKICAgICAgICAgICAgcmV0dXJuIE5vbmVG\naWVsZFN0cmF0ZWd5LmdldEluc3RhbmNlKCk7CgogICAgICAgIFN0cmluZyBw\ncm9wcyA9IENvbmZpZ3VyYXRpb25zLmdldFByb3BlcnRpZXMobmFtZSk7CiAg\nICAgICAgbmFtZSA9IENvbmZpZ3VyYXRpb25zLmdldENsYXNzTmFtZShuYW1l\nKTsKICAgICAgICB0cnkgewogICAgICAgICAgICBDbGFzcyBjID0gSmF2YVR5\ncGVzLmNsYXNzRm9yTmFtZShuYW1lLCBmaWVsZCwKICAgICAgICAgICAgICAg\nIChDbGFzc0xvYWRlcikgQWNjZXNzQ29udHJvbGxlci5kb1ByaXZpbGVnZWQo\nCiAgICAgICAgICAgICAgICAgICAgSjJEb1ByaXZIZWxwZXIuZ2V0Q2xhc3NM\nb2FkZXJBY3Rpb24oRmllbGRTdHJhdGVneS5jbGFzcykpKTsKICAgICAgICAg\nICAgaWYgKEZpZWxkU3RyYXRlZ3kuY2xhc3MuaXNBc3NpZ25hYmxlRnJvbShj\nKSkgewogICAgICAgICAgICAgICAgRmllbGRTdHJhdGVneSBzdHJhdCA9IChG\naWVsZFN0cmF0ZWd5KQogICAgICAgICAgICAgICAgICAgIEFjY2Vzc0NvbnRy\nb2xsZXIuZG9Qcml2aWxlZ2VkKAogICAgICAgICAgICAgICAgICAgICAgICBK\nMkRvUHJpdkhlbHBlci5uZXdJbnN0YW5jZUFjdGlvbihjKSk7CiAgICAgICAg\nICAgICAgICBDb25maWd1cmF0aW9ucy5jb25maWd1cmVJbnN0YW5jZShzdHJh\ndCwgZ2V0Q29uZmlndXJhdGlvbigpLAogICAgICAgICAgICAgICAgICAgIHBy\nb3BzKTsKICAgICAgICAgICAgICAgIHJldHVybiBzdHJhdDsKICAgICAgICAg\nICAgfQoKICAgICAgICAgICAgLy8gbXVzdCBiZSBuYW1lZCBoYW5kbGVyCiAg\nICAgICAgICAgIGlmIChpbnN0YWxsSGFuZGxlcnMpIHsKICAgICAgICAgICAg\nICAgIFZhbHVlSGFuZGxlciB2aCA9IChWYWx1ZUhhbmRsZXIpIEFjY2Vzc0Nv\nbnRyb2xsZXIuZG9Qcml2aWxlZ2VkKAogICAgICAgICAgICAgICAgICAgIEoy\nRG9Qcml2SGVscGVyLm5ld0luc3RhbmNlQWN0aW9uKGMpKTsKICAgICAgICAg\nICAgICAgIENvbmZpZ3VyYXRpb25zLmNvbmZpZ3VyZUluc3RhbmNlKHZoLCBn\nZXRDb25maWd1cmF0aW9uKCksCiAgICAgICAgICAgICAgICAgICAgcHJvcHMp\nOwogICAgICAgICAgICAgICAgZmllbGQuc2V0SGFuZGxlcih2aCk7CiAgICAg\nICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIG5ldyBIYW5kbGVyRmllbGRT\ndHJhdGVneSgpOwogICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAg\nICAgICAgICAgIGlmIChlIGluc3RhbmNlb2YgUHJpdmlsZWdlZEFjdGlvbkV4\nY2VwdGlvbikKICAgICAgICAgICAgICAgIGUgPSAoKFByaXZpbGVnZWRBY3Rp\nb25FeGNlcHRpb24pIGUpLmdldEV4Y2VwdGlvbigpOwogICAgICAgICAgICB0\naHJvdyBuZXcgTWV0YURhdGFFeGNlcHRpb24oX2xvYy5nZXQoImJhZC1maWVs\nZC1zdHJhdGVneSIsCiAgICAgICAgICAgICAgICBmaWVsZCwgbmFtZSksIGUp\nOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIEluc3RhbnRpYXRl\nIHRoZSBnaXZlbiBkaXNjcmltaW5hdG9yJ3MgbmFtZWQgc3RyYXRlZ3ksIG9y\nIHJldHVybiBudWxsCiAgICAgKiBpZiBubyBuYW1lZCBzdHJhdGVneS4KICAg\nICAqLwogICAgcHJvdGVjdGVkIERpc2NyaW1pbmF0b3JTdHJhdGVneSBuYW1l\nZFN0cmF0ZWd5KERpc2NyaW1pbmF0b3IgZGlzY3JpbSkgewogICAgICAgIFN0\ncmluZyBuYW1lID0gZGlzY3JpbS5nZXRNYXBwaW5nSW5mbygpLmdldFN0cmF0\nZWd5KCk7CiAgICAgICAgaWYgKG5hbWUgPT0gbnVsbCkKICAgICAgICAgICAg\ncmV0dXJuIG51bGw7CgogICAgICAgIC8vIGlmIHRoZXJlIGlzIGEgbmFtZWQg\nc3RyYXRlZ3kgcHJlc2VudCwgZGlzY2FyZCBpdCBpZiBpdCBtYXRjaGVzCiAg\nICAgICAgLy8gdGhlIGJhc2Ugc3RyYXRlZ3ksIHNvIHRoYXQgd2Ugd29uJ3Qg\nY3JlYXRlIGFuIGluZGVwZW5kZW50IGluc3RhbmNlCiAgICAgICAgQ2xhc3NN\nYXBwaW5nIGNscyA9IGRpc2NyaW0uZ2V0Q2xhc3NNYXBwaW5nKCk7CiAgICAg\nICAgd2hpbGUgKGNscy5nZXRKb2luYWJsZVBDU3VwZXJjbGFzc01hcHBpbmco\nKSAhPSBudWxsKQogICAgICAgICAgICBjbHMgPSBjbHMuZ2V0Sm9pbmFibGVQ\nQ1N1cGVyY2xhc3NNYXBwaW5nKCk7CiAgICAgICAgRGlzY3JpbWluYXRvciBi\nYXNlID0gY2xzLmdldERpc2NyaW1pbmF0b3IoKTsKICAgICAgICBpZiAoYmFz\nZSAhPSBkaXNjcmltICYmIGJhc2UuZ2V0U3RyYXRlZ3koKSAhPSBudWxsCiAg\nICAgICAgICAgICYmIG5hbWUuZXF1YWxzKGJhc2UuZ2V0U3RyYXRlZ3koKS5n\nZXRBbGlhcygpKSkKICAgICAgICAgICAgcmV0dXJuIG51bGw7CgogICAgICAg\nIHJldHVybiBpbnN0YW50aWF0ZURpc2NyaW1pbmF0b3JTdHJhdGVneShuYW1l\nLCBkaXNjcmltKTsKICAgIH0KCiAgICAvKioKICAgICAqIEluc3RhbnRpYXRl\nIHRoZSBnaXZlbiBkaXNjcmltaW5hdG9yIHN0cmF0ZWd5LgogICAgICovCiAg\nICBwcm90ZWN0ZWQgRGlzY3JpbWluYXRvclN0cmF0ZWd5IGluc3RhbnRpYXRl\nRGlzY3JpbWluYXRvclN0cmF0ZWd5CiAgICAgICAgKFN0cmluZyBuYW1lLCBE\naXNjcmltaW5hdG9yIGRpc2NyaW0pIHsKICAgICAgICBpZiAoTm9uZURpc2Ny\naW1pbmF0b3JTdHJhdGVneS5BTElBUy5lcXVhbHMobmFtZSkpCiAgICAgICAg\nICAgIHJldHVybiBOb25lRGlzY3JpbWluYXRvclN0cmF0ZWd5LmdldEluc3Rh\nbmNlKCk7CgogICAgICAgIFN0cmluZyBwcm9wcyA9IENvbmZpZ3VyYXRpb25z\nLmdldFByb3BlcnRpZXMobmFtZSk7CiAgICAgICAgbmFtZSA9IENvbmZpZ3Vy\nYXRpb25zLmdldENsYXNzTmFtZShuYW1lKTsKICAgICAgICBDbGFzcyBzdHJh\ndCA9IG51bGw7CgogICAgICAgIGlmIChDbGFzc05hbWVEaXNjcmltaW5hdG9y\nU3RyYXRlZ3kuQUxJQVMuZXF1YWxzKG5hbWUpKQogICAgICAgICAgICBzdHJh\ndCA9IENsYXNzTmFtZURpc2NyaW1pbmF0b3JTdHJhdGVneS5jbGFzczsKICAg\nICAgICBlbHNlIGlmIChWYWx1ZU1hcERpc2NyaW1pbmF0b3JTdHJhdGVneS5B\nTElBUy5lcXVhbHMobmFtZSkpCiAgICAgICAgICAgIHN0cmF0ID0gVmFsdWVN\nYXBEaXNjcmltaW5hdG9yU3RyYXRlZ3kuY2xhc3M7CiAgICAgICAgZWxzZSBp\nZiAoU3ViY2xhc3NKb2luRGlzY3JpbWluYXRvclN0cmF0ZWd5LkFMSUFTLmVx\ndWFscyhuYW1lKSkKICAgICAgICAgICAgc3RyYXQgPSBTdWJjbGFzc0pvaW5E\naXNjcmltaW5hdG9yU3RyYXRlZ3kuY2xhc3M7CgogICAgICAgIHRyeSB7CiAg\nICAgICAgICAgIGlmIChzdHJhdCA9PSBudWxsKQogICAgICAgICAgICAgICAg\nc3RyYXQgPSBKYXZhVHlwZXMuY2xhc3NGb3JOYW1lKG5hbWUsCiAgICAgICAg\nICAgICAgICAgICAgZGlzY3JpbS5nZXRDbGFzc01hcHBpbmcoKSwKICAgICAg\nICAgICAgICAgICAgICAoQ2xhc3NMb2FkZXIpIEFjY2Vzc0NvbnRyb2xsZXIu\nZG9Qcml2aWxlZ2VkKAogICAgICAgICAgICAgICAgICAgICAgICBKMkRvUHJp\ndkhlbHBlci5nZXRDbGFzc0xvYWRlckFjdGlvbigKICAgICAgICAgICAgICAg\nICAgICAgICAgICAgIERpc2NyaW1pbmF0b3JTdHJhdGVneS5jbGFzcykpKTsK\nICAgICAgICAgICAgRGlzY3JpbWluYXRvclN0cmF0ZWd5IHN0cmF0ZWd5ID0g\nKERpc2NyaW1pbmF0b3JTdHJhdGVneSkKICAgICAgICAgICAgICAgIEFjY2Vz\nc0NvbnRyb2xsZXIuZG9Qcml2aWxlZ2VkKAogICAgICAgICAgICAgICAgICAg\nIEoyRG9Qcml2SGVscGVyLm5ld0luc3RhbmNlQWN0aW9uKHN0cmF0KSk7CiAg\nICAgICAgICAgIENvbmZpZ3VyYXRpb25zLmNvbmZpZ3VyZUluc3RhbmNlKHN0\ncmF0ZWd5LCBnZXRDb25maWd1cmF0aW9uKCksCiAgICAgICAgICAgICAgICBw\ncm9wcyk7CiAgICAgICAgICAgIHJldHVybiBzdHJhdGVneTsKICAgICAgICB9\nIGNhdGNoIChFeGNlcHRpb24gZSkgewogICAgICAgICAgICBpZiAoZSBpbnN0\nYW5jZW9mIFByaXZpbGVnZWRBY3Rpb25FeGNlcHRpb24pCiAgICAgICAgICAg\nICAgICBlID0gKChQcml2aWxlZ2VkQWN0aW9uRXhjZXB0aW9uKSBlKS5nZXRF\neGNlcHRpb24oKTsKICAgICAgICAgICAgdGhyb3cgbmV3IE1ldGFEYXRhRXhj\nZXB0aW9uKF9sb2MuZ2V0KCJiYWQtZGlzY3JpbS1zdHJhdGVneSIsCiAgICAg\nICAgICAgICAgICBkaXNjcmltLmdldENsYXNzTWFwcGluZygpLCBuYW1lKSwg\nZSk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogSW5zdGFudGlh\ndGUgdGhlIGdpdmVuIHZlcnNpb24ncyBuYW1lZCBzdHJhdGVneSwgb3IgcmV0\ndXJuIG51bGwKICAgICAqIGlmIG5vIG5hbWVkIHN0cmF0ZWd5LgogICAgICov\nCiAgICBwcm90ZWN0ZWQgVmVyc2lvblN0cmF0ZWd5IG5hbWVkU3RyYXRlZ3ko\nVmVyc2lvbiB2ZXJzaW9uKSB7CiAgICAgICAgU3RyaW5nIG5hbWUgPSB2ZXJz\naW9uLmdldE1hcHBpbmdJbmZvKCkuZ2V0U3RyYXRlZ3koKTsKICAgICAgICBp\nZiAobmFtZSA9PSBudWxsKQogICAgICAgICAgICByZXR1cm4gbnVsbDsKCiAg\nICAgICAgLy8gaWYgdGhlcmUgaXMgYSBuYW1lZCBzdHJhdGVneSBwcmVzZW50\nLCBkaXNjYXJkIGl0IGlmIGl0IG1hdGNoZXMKICAgICAgICAvLyB0aGUgYmFz\nZSBzdHJhdGVneSwgc28gdGhhdCB3ZSB3b24ndCBjcmVhdGUgYW4gaW5kZXBl\nbmRlbnQgaW5zdGFuY2UKICAgICAgICBDbGFzc01hcHBpbmcgY2xzID0gdmVy\nc2lvbi5nZXRDbGFzc01hcHBpbmcoKTsKICAgICAgICB3aGlsZSAoY2xzLmdl\ndEpvaW5hYmxlUENTdXBlcmNsYXNzTWFwcGluZygpICE9IG51bGwpCiAgICAg\nICAgICAgIGNscyA9IGNscy5nZXRKb2luYWJsZVBDU3VwZXJjbGFzc01hcHBp\nbmcoKTsKICAgICAgICBWZXJzaW9uIGJhc2UgPSBjbHMuZ2V0VmVyc2lvbigp\nOwogICAgICAgIGlmIChiYXNlICE9IHZlcnNpb24gJiYgYmFzZS5nZXRTdHJh\ndGVneSgpICE9IG51bGwKICAgICAgICAgICAgJiYgbmFtZS5lcXVhbHMoYmFz\nZS5nZXRTdHJhdGVneSgpLmdldEFsaWFzKCkpKQogICAgICAgICAgICByZXR1\ncm4gbnVsbDsKCiAgICAgICAgcmV0dXJuIGluc3RhbnRpYXRlVmVyc2lvblN0\ncmF0ZWd5KG5hbWUsIHZlcnNpb24pOwogICAgfQoKICAgIC8qKgogICAgICog\nSW5zdGFudGlhdGUgdGhlIGdpdmVuIHZlcnNpb24gc3RyYXRlZ3kuCiAgICAg\nKi8KICAgIHByb3RlY3RlZCBWZXJzaW9uU3RyYXRlZ3kgaW5zdGFudGlhdGVW\nZXJzaW9uU3RyYXRlZ3koU3RyaW5nIG5hbWUsCiAgICAgICAgVmVyc2lvbiB2\nZXJzaW9uKSB7CiAgICAgICAgaWYgKE5vbmVWZXJzaW9uU3RyYXRlZ3kuQUxJ\nQVMuZXF1YWxzKG5hbWUpKQogICAgICAgICAgICByZXR1cm4gTm9uZVZlcnNp\nb25TdHJhdGVneS5nZXRJbnN0YW5jZSgpOwoKICAgICAgICBTdHJpbmcgcHJv\ncHMgPSBDb25maWd1cmF0aW9ucy5nZXRQcm9wZXJ0aWVzKG5hbWUpOwogICAg\nICAgIG5hbWUgPSBDb25maWd1cmF0aW9ucy5nZXRDbGFzc05hbWUobmFtZSk7\nCiAgICAgICAgQ2xhc3Mgc3RyYXQgPSBudWxsOwoKICAgICAgICBpZiAoTnVt\nYmVyVmVyc2lvblN0cmF0ZWd5LkFMSUFTLmVxdWFscyhuYW1lKSkKICAgICAg\nICAgICAgc3RyYXQgPSBOdW1iZXJWZXJzaW9uU3RyYXRlZ3kuY2xhc3M7CiAg\nICAgICAgZWxzZSBpZiAoVGltZXN0YW1wVmVyc2lvblN0cmF0ZWd5LkFMSUFT\nLmVxdWFscyhuYW1lKSkKICAgICAgICAgICAgc3RyYXQgPSBUaW1lc3RhbXBW\nZXJzaW9uU3RyYXRlZ3kuY2xhc3M7CiAgICAgICAgZWxzZSBpZiAoTmFub1By\nZWNpc2lvblRpbWVzdGFtcFZlcnNpb25TdHJhdGVneS5BTElBUy5lcXVhbHMo\nbmFtZSkpCiAgICAgICAgICAgIHN0cmF0ID0gTmFub1ByZWNpc2lvblRpbWVz\ndGFtcFZlcnNpb25TdHJhdGVneS5jbGFzczsKICAgICAgICBlbHNlIGlmIChT\ndGF0ZUNvbXBhcmlzb25WZXJzaW9uU3RyYXRlZ3kuQUxJQVMuZXF1YWxzKG5h\nbWUpKQogICAgICAgICAgICBzdHJhdCA9IFN0YXRlQ29tcGFyaXNvblZlcnNp\nb25TdHJhdGVneS5jbGFzczsKCiAgICAgICAgdHJ5IHsKICAgICAgICAgICAg\naWYgKHN0cmF0ID09IG51bGwpCiAgICAgICAgICAgICAgICBzdHJhdCA9IEph\ndmFUeXBlcy5jbGFzc0Zvck5hbWUobmFtZSwKICAgICAgICAgICAgICAgICAg\nICB2ZXJzaW9uLmdldENsYXNzTWFwcGluZygpLAogICAgICAgICAgICAgICAg\nICAgIChDbGFzc0xvYWRlcikgQWNjZXNzQ29udHJvbGxlci5kb1ByaXZpbGVn\nZWQoCiAgICAgICAgICAgICAgICAgICAgICAgIEoyRG9Qcml2SGVscGVyLmdl\ndENsYXNzTG9hZGVyQWN0aW9uKAogICAgICAgICAgICAgICAgICAgICAgICAg\nICAgVmVyc2lvblN0cmF0ZWd5LmNsYXNzKSkpOwogICAgICAgIH0gY2F0Y2gg\nKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBNZXRhRGF0\nYUV4Y2VwdGlvbihfbG9jLmdldCgiYmFkLXZlcnNpb24tc3RyYXRlZ3kiLAog\nICAgICAgICAgICAgICAgdmVyc2lvbi5nZXRDbGFzc01hcHBpbmcoKSwgbmFt\nZSksIGUpOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIGluc3RhbnRpYXRl\nVmVyc2lvblN0cmF0ZWd5KHN0cmF0LCB2ZXJzaW9uLCBwcm9wcyk7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBJbnN0YW50aWF0ZSB0aGUgZ2l2ZW4gdmVyc2lv\nbiBzdHJhdGVneS4KICAgICAqLwogICAgcHJvdGVjdGVkIFZlcnNpb25TdHJh\ndGVneSBpbnN0YW50aWF0ZVZlcnNpb25TdHJhdGVneShDbGFzcyBzdHJhdCwK\nICAgICAgICBWZXJzaW9uIHZlcnNpb24sIFN0cmluZyBwcm9wcykgewogICAg\nICAgIHRyeSB7CiAgICAgICAgICAgIFZlcnNpb25TdHJhdGVneSBzdHJhdGVn\neSA9IChWZXJzaW9uU3RyYXRlZ3kpCiAgICAgICAgICAgICAgICBBY2Nlc3ND\nb250cm9sbGVyLmRvUHJpdmlsZWdlZCgKICAgICAgICAgICAgICAgICAgICBK\nMkRvUHJpdkhlbHBlci5uZXdJbnN0YW5jZUFjdGlvbihzdHJhdCkpOwogICAg\nICAgICAgICBDb25maWd1cmF0aW9ucy5jb25maWd1cmVJbnN0YW5jZShzdHJh\ndGVneSwgZ2V0Q29uZmlndXJhdGlvbigpLAogICAgICAgICAgICAgICAgcHJv\ncHMpOwogICAgICAgICAgICByZXR1cm4gc3RyYXRlZ3k7CiAgICAgICAgfSBj\nYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgaWYgKGUgaW5zdGFu\nY2VvZiBQcml2aWxlZ2VkQWN0aW9uRXhjZXB0aW9uKQogICAgICAgICAgICAg\nICAgZSA9ICgoUHJpdmlsZWdlZEFjdGlvbkV4Y2VwdGlvbikgZSkuZ2V0RXhj\nZXB0aW9uKCk7CiAgICAgICAgICAgIHRocm93IG5ldyBNZXRhRGF0YUV4Y2Vw\ndGlvbihfbG9jLmdldCgiYmFkLXZlcnNpb24tc3RyYXRlZ3kiLAogICAgICAg\nICAgICAgICAgdmVyc2lvbi5nZXRDbGFzc01hcHBpbmcoKSwgc3RyYXQgKyAi\nIiksIGUpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIERldGVy\nbWluZSB0aGUgZGVmYXVsdCBzdHJhdGVneSB0byB1c2UgZm9yIHRoZSBnaXZl\nbiBjbGFzcy4gRG9lcwogICAgICogbm90IHRha2UgaW50byBhY2NvdW50IHRo\nZSBjdXJyZW50IHN0cmF0ZWd5LCBpZiBhbnkuCiAgICAgKi8KICAgIHByb3Rl\nY3RlZCBDbGFzc1N0cmF0ZWd5IGRlZmF1bHRTdHJhdGVneShDbGFzc01hcHBp\nbmcgY2xzKSB7CiAgICAgICAgcmV0dXJuIGRlZmF1bHRTdHJhdGVneShjbHMs\nIGdldFN0cmF0ZWd5SW5zdGFsbGVyKCkuaXNBZGFwdGluZygpKTsKICAgIH0K\nCiAgICAvKioKICAgICAqIERldGVybWluZSB0aGUgZGVmYXVsdCBzdHJhdGVn\neSB0byB1c2UgZm9yIHRoZSBnaXZlbiBjbGFzcy4gRG9lcwogICAgICogbm90\nIHRha2UgaW50byBhY2NvdW50IHRoZSBjdXJyZW50IHN0cmF0ZWd5LCBpZiBh\nbnkuCiAgICAgKi8KICAgIHByb3RlY3RlZCBDbGFzc1N0cmF0ZWd5IGRlZmF1\nbHRTdHJhdGVneShDbGFzc01hcHBpbmcgY2xzLAogICAgICAgIGJvb2xlYW4g\nYWRhcHRpbmcpIHsKICAgICAgICBWYWx1ZU1hcHBpbmcgZW1iZWQgPSBjbHMu\nZ2V0RW1iZWRkaW5nTWFwcGluZygpOwogICAgICAgIGlmIChlbWJlZCAhPSBu\ndWxsKSB7CiAgICAgICAgICAgIC8vIHN1cGVyY2xhc3Mgb2YgZW1iZWRkZWQg\nY2xhc3MgaXNuJ3QgbWFwcGVkCiAgICAgICAgICAgIGlmIChlbWJlZC5nZXRU\neXBlKCkgIT0gY2xzLmdldERlc2NyaWJlZFR5cGUoKQogICAgICAgICAgICAg\nICAgfHwgZW1iZWQuZ2V0RmllbGRNYXBwaW5nKCkuZ2V0U3RyYXRlZ3koKQog\nICAgICAgICAgICAgICAgPT0gTm9uZUZpZWxkU3RyYXRlZ3kuZ2V0SW5zdGFu\nY2UoKSkKICAgICAgICAgICAgICAgIHJldHVybiBOb25lQ2xhc3NTdHJhdGVn\neS5nZXRJbnN0YW5jZSgpOwogICAgICAgICAgICBpZiAoZW1iZWQuZ2V0VHlw\nZUNvZGUoKSA9PSBKYXZhVHlwZXMuT0lEKQogICAgICAgICAgICAgICAgcmV0\ndXJuIG5ldyBPYmplY3RJZENsYXNzU3RyYXRlZ3koKTsKICAgICAgICAgICAg\ncmV0dXJuIG5ldyBFbWJlZGRlZENsYXNzU3RyYXRlZ3koKTsKICAgICAgICB9\nCiAgICAgICAgaWYgKGNscy5pc0VtYmVkZGVkT25seSgpKQogICAgICAgICAg\nICByZXR1cm4gTm9uZUNsYXNzU3RyYXRlZ3kuZ2V0SW5zdGFuY2UoKTsKCiAg\nICAgICAgT2JqZWN0IHN0cmF0ID0gX2RlZmF1bHRzLmdldFN0cmF0ZWd5KGNs\ncywgYWRhcHRpbmcpOwogICAgICAgIGlmIChzdHJhdCBpbnN0YW5jZW9mIFN0\ncmluZykKICAgICAgICAgICAgcmV0dXJuIGluc3RhbnRpYXRlQ2xhc3NTdHJh\ndGVneSgoU3RyaW5nKSBzdHJhdCwgY2xzKTsKICAgICAgICBpZiAoc3RyYXQg\nIT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIChDbGFzc1N0cmF0ZWd5KSBz\ndHJhdDsKICAgICAgICAKICAgICAgICAvLyBzZWUgaWYgdGhlcmUgaXMgYSBk\nZWNsYXJlZCBoaWVyYXJjaHkgc3RyYXRlZ3kKICAgICAgICBDbGFzc1N0cmF0\nZWd5IGhzdHJhdCA9IG51bGw7CiAgICAgICAgZm9yIChDbGFzc01hcHBpbmcg\nYmFzZSA9IGNsczsgYmFzZSAhPSBudWxsICYmIGhzdHJhdCA9PSBudWxsOykg\newogICAgICAgICAgICBoc3RyYXQgPSBpbnN0YW50aWF0ZUNsYXNzU3RyYXRl\nZ3koYmFzZS5nZXRNYXBwaW5nSW5mbygpLgogICAgICAgICAgICAgICAgZ2V0\nSGllcmFyY2h5U3RyYXRlZ3koKSwgY2xzKTsKICAgICAgICAgICAgYmFzZSA9\nIGJhc2UuZ2V0TWFwcGVkUENTdXBlcmNsYXNzTWFwcGluZygpOwogICAgICAg\nIH0KCiAgICAgICAgLy8gdGhlIGZ1bGwgc3RyYXRlZ3kgYXMgYXBwbGllZCB0\nbyBhIGhpZXJhcmNoeSBpcyBhCiAgICAgICAgLy8gdGFibGUtcGVyLWNvbmNy\nZXRlLWNsYXNzIHN0cmF0ZWd5LCBzbyBkb24ndCBtYXAgYWJzdHJhY3QgdHlw\nZXMKICAgICAgICBpZiAoaHN0cmF0IGluc3RhbmNlb2YgRnVsbENsYXNzU3Ry\nYXRlZ3kKICAgICAgICAgICAgJiYgIWNscy5pc01hbmFnZWRJbnRlcmZhY2Uo\nKQogICAgICAgICAgICAmJiBNb2RpZmllci5pc0Fic3RyYWN0KGNscy5nZXRE\nZXNjcmliZWRUeXBlKCkuZ2V0TW9kaWZpZXJzKCkpKQogICAgICAgICAgICBy\nZXR1cm4gTm9uZUNsYXNzU3RyYXRlZ3kuZ2V0SW5zdGFuY2UoKTsKICAgICAg\nICAKICAgICAgICBDbGFzc01hcHBpbmcgc3VwID0gY2xzLmdldE1hcHBlZFBD\nU3VwZXJjbGFzc01hcHBpbmcoKTsKICAgICAgICBpZiAoc3VwID09IG51bGwp\nCiAgICAgICAgICAgIHJldHVybiBuZXcgRnVsbENsYXNzU3RyYXRlZ3koKTsK\nICAgICAgICBpZiAoaHN0cmF0ICE9IG51bGwpCiAgICAgICAgICAgIHJldHVy\nbiBoc3RyYXQ7CiAgICAgICAgcmV0dXJuIG5ldyBGbGF0Q2xhc3NTdHJhdGVn\neSgpOwogICAgfQoKICAgIC8qKgogICAgICogRGV0ZXJtaW5lIHRoZSBkZWZh\ndWx0IHN0cmF0ZWd5IHRvIHVzZSBmb3IgdGhlIGdpdmVuIGZpZWxkLiBEb2Vz\nCiAgICAgKiBub3QgdGFrZSBpbnRvIGFjY291bnQgdGhlIG5hbWVkIG9yIGN1\ncnJlbnQgc3RyYXRlZ3ksIGlmIGFueS4gSWYgYQogICAgICogbm9uLW51bGwg\nc3RyYXRlZ3kgaXMgcmV0dXJuZWQsIHRoaXMgbWV0aG9kIG1heSBhcyBhIHNp\nZGUgZWZmZWN0IGluc3RhbGwKICAgICAqIHZhbHVlIGhhbmRsZXJzIG9uIHRo\nZSBmaWVsZCdzIHZhbHVlIG1hcHBpbmdzLgogICAgICovCiAgICBwcm90ZWN0\nZWQgRmllbGRTdHJhdGVneSBkZWZhdWx0U3RyYXRlZ3koRmllbGRNYXBwaW5n\nIGZpZWxkLAogICAgICAgIGJvb2xlYW4gaW5zdGFsbEhhbmRsZXJzKSB7CiAg\nICAgICAgcmV0dXJuIGRlZmF1bHRTdHJhdGVneShmaWVsZCwgaW5zdGFsbEhh\nbmRsZXJzLAogICAgICAgICAgICBnZXRTdHJhdGVneUluc3RhbGxlcigpLmlz\nQWRhcHRpbmcoKSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBEZXRlcm1pbmUg\ndGhlIGRlZmF1bHQgc3RyYXRlZ3kgdG8gdXNlIGZvciB0aGUgZ2l2ZW4gZmll\nbGQuIERvZXMKICAgICAqIG5vdCB0YWtlIGludG8gYWNjb3VudCB0aGUgbmFt\nZWQgb3IgY3VycmVudCBzdHJhdGVneSwgaWYgYW55LiBJZiBhCiAgICAgKiBu\nb24tbnVsbCBzdHJhdGVneSBpcyByZXR1cm5lZCwgdGhpcyBtZXRob2QgbWF5\nIGFzIGEgc2lkZSBlZmZlY3QgaW5zdGFsbAogICAgICogdmFsdWUgaGFuZGxl\ncnMgb24gdGhlIGZpZWxkJ3MgdmFsdWUgbWFwcGluZ3MuCiAgICAgKi8KICAg\nIHByb3RlY3RlZCBGaWVsZFN0cmF0ZWd5IGRlZmF1bHRTdHJhdGVneShGaWVs\nZE1hcHBpbmcgZmllbGQsCiAgICAgICAgYm9vbGVhbiBpbnN0YWxsSGFuZGxl\ncnMsIGJvb2xlYW4gYWRhcHRpbmcpIHsKICAgICAgICAvLyBub3QgcGVyc2lz\ndGVudD8KICAgICAgICBpZiAoZmllbGQuZ2V0TWFuYWdlbWVudCgpICE9IGZp\nZWxkLk1BTkFHRV9QRVJTSVNURU5UCiAgICAgICAgICAgIHx8IGZpZWxkLmlz\nVmVyc2lvbigpKQogICAgICAgICAgICByZXR1cm4gTm9uZUZpZWxkU3RyYXRl\nZ3kuZ2V0SW5zdGFuY2UoKTsKICAgICAgICBpZiAoZmllbGQuZ2V0RGVmaW5p\nbmdNYXBwaW5nKCkuZ2V0U3RyYXRlZ3koKSA9PQogICAgICAgICAgICBOb25l\nQ2xhc3NTdHJhdGVneS5nZXRJbnN0YW5jZSgpKQogICAgICAgICAgICByZXR1\ncm4gTm9uZUZpZWxkU3RyYXRlZ3kuZ2V0SW5zdGFuY2UoKTsKCiAgICAgICAg\nLy8gY2hlY2sgZm9yIG5hbWVkIGhhbmRsZXIgZmlyc3QKICAgICAgICBWYWx1\nZUhhbmRsZXIgaGFuZGxlciA9IG5hbWVkSGFuZGxlcihmaWVsZCk7CiAgICAg\nICAgaWYgKGhhbmRsZXIgIT0gbnVsbCkgewogICAgICAgICAgICBpZiAoaW5z\ndGFsbEhhbmRsZXJzKQogICAgICAgICAgICAgICAgZmllbGQuc2V0SGFuZGxl\ncihoYW5kbGVyKTsKICAgICAgICAgICAgcmV0dXJuIG5ldyBIYW5kbGVyRmll\nbGRTdHJhdGVneSgpOwogICAgICAgIH0KCiAgICAgICAgaWYgKGZpZWxkLmlz\nU2VyaWFsaXplZCgpKSB7CiAgICAgICAgICAgIGlmIChfZGljdC5tYXhFbWJl\nZGRlZEJsb2JTaXplICE9IC0xKQogICAgICAgICAgICAgICAgcmV0dXJuIG5l\ndyBNYXhFbWJlZGRlZEJsb2JGaWVsZFN0cmF0ZWd5KCk7CiAgICAgICAgfSBl\nbHNlIHsKICAgICAgICAgICAgLy8gY2hlY2sgZm9yIG1hcHBlZCBzdHJhdGVn\neQogICAgICAgICAgICBPYmplY3Qgc3RyYXQgPSBtYXBwZWRTdHJhdGVneShm\naWVsZCwgZmllbGQuZ2V0VHlwZSgpLCBhZGFwdGluZyk7CiAgICAgICAgICAg\nIGlmIChzdHJhdCBpbnN0YW5jZW9mIEZpZWxkU3RyYXRlZ3kpCiAgICAgICAg\nICAgICAgICByZXR1cm4gKEZpZWxkU3RyYXRlZ3kpIHN0cmF0OwogICAgICAg\nICAgICBpZiAoc3RyYXQgIT0gbnVsbCkgewogICAgICAgICAgICAgICAgaWYg\nKGluc3RhbGxIYW5kbGVycykKICAgICAgICAgICAgICAgICAgICBmaWVsZC5z\nZXRIYW5kbGVyKChWYWx1ZUhhbmRsZXIpIHN0cmF0KTsKICAgICAgICAgICAg\nICAgIHJldHVybiBuZXcgSGFuZGxlckZpZWxkU3RyYXRlZ3koKTsKICAgICAg\nICAgICAgfQogICAgICAgIH0KCiAgICAgICAgLy8gY2hlY2sgZm9yIGtub3du\nIGZpZWxkIHN0cmF0ZWdpZXMKICAgICAgICBpZiAoIWZpZWxkLmlzU2VyaWFs\naXplZCgpICYmIChmaWVsZC5nZXRUeXBlKCkgPT0gYnl0ZVtdLmNsYXNzCiAg\nICAgICAgICAgIHx8IGZpZWxkLmdldFR5cGUoKSA9PSBCeXRlW10uY2xhc3Mp\nKSB7CiAgICAgICAgICAgIGlmIChfZGljdC5tYXhFbWJlZGRlZEJsb2JTaXpl\nICE9IC0xKQogICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBNYXhFbWJlZGRl\nZEJ5dGVBcnJheUZpZWxkU3RyYXRlZ3koKTsKICAgICAgICB9IGVsc2UgaWYg\nKCFmaWVsZC5pc1NlcmlhbGl6ZWQoKQogICAgICAgICAgICAmJiAoZmllbGQu\nZ2V0VHlwZSgpID09IGNoYXJbXS5jbGFzcwogICAgICAgICAgICB8fCBmaWVs\nZC5nZXRUeXBlKCkgPT0gQ2hhcmFjdGVyW10uY2xhc3MpKSB7CiAgICAgICAg\nICAgIGlmIChfZGljdC5tYXhFbWJlZGRlZENsb2JTaXplICE9IC0xICYmIGlz\nQ2xvYihmaWVsZCwgZmFsc2UpKQogICAgICAgICAgICAgICAgcmV0dXJuIG5l\ndyBNYXhFbWJlZGRlZENoYXJBcnJheUZpZWxkU3RyYXRlZ3koKTsKICAgICAg\nICB9IGVsc2UgaWYgKCFmaWVsZC5pc1NlcmlhbGl6ZWQoKSkgewogICAgICAg\nICAgICBGaWVsZFN0cmF0ZWd5IHN0cmF0ID0gZGVmYXVsdFR5cGVTdHJhdGVn\neShmaWVsZCwgaW5zdGFsbEhhbmRsZXJzLAogICAgICAgICAgICAgICAgYWRh\ncHRpbmcpOwogICAgICAgICAgICBpZiAoc3RyYXQgIT0gbnVsbCkKICAgICAg\nICAgICAgICAgIHJldHVybiBzdHJhdDsKICAgICAgICB9CgogICAgICAgIC8v\nIGNoZWNrIGZvciBkZWZhdWx0IGhhbmRsZXIKICAgICAgICBoYW5kbGVyID0g\nZGVmYXVsdEhhbmRsZXIoZmllbGQsIGFkYXB0aW5nKTsKICAgICAgICBpZiAo\naGFuZGxlciAhPSBudWxsKSB7CiAgICAgICAgICAgIGlmIChpbnN0YWxsSGFu\nZGxlcnMpCiAgICAgICAgICAgICAgICBmaWVsZC5zZXRIYW5kbGVyKGhhbmRs\nZXIpOwogICAgICAgICAgICByZXR1cm4gbmV3IEhhbmRsZXJGaWVsZFN0cmF0\nZWd5KCk7CiAgICAgICAgfQoKICAgICAgICAvLyBkZWZhdWx0IHRvIGJsb2IK\nICAgICAgICBpZiAoaW5zdGFsbEhhbmRsZXJzKSB7CiAgICAgICAgICAgIGlm\nIChnZXRMb2coKS5pc1dhcm5FbmFibGVkKCkpCiAgICAgICAgICAgICAgICBn\nZXRMb2coKS53YXJuKF9sb2MuZ2V0KCJuby1maWVsZC1zdHJhdGVneSIsIGZp\nZWxkKSk7CiAgICAgICAgICAgIGZpZWxkLnNldFNlcmlhbGl6ZWQodHJ1ZSk7\nCiAgICAgICAgfQogICAgICAgIGlmIChfZGljdC5tYXhFbWJlZGRlZEJsb2JT\naXplID09IC0xKSB7CiAgICAgICAgICAgIGlmIChpbnN0YWxsSGFuZGxlcnMp\nCiAgICAgICAgICAgICAgICBmaWVsZC5zZXRIYW5kbGVyKEJsb2JWYWx1ZUhh\nbmRsZXIuZ2V0SW5zdGFuY2UoKSk7CiAgICAgICAgICAgIHJldHVybiBuZXcg\nSGFuZGxlckZpZWxkU3RyYXRlZ3koKTsKICAgICAgICB9CiAgICAgICAgcmV0\ndXJuIG5ldyBNYXhFbWJlZGRlZEJsb2JGaWVsZFN0cmF0ZWd5KCk7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIGJ1aWx0LWluIHN0cmF0ZWd5\nIGZvciB0aGUgZmllbGQncyB0eXBlLCBvciBudWxsIGlmIG5vbmUuCiAgICAg\nKi8KICAgIHByb3RlY3RlZCBGaWVsZFN0cmF0ZWd5IGRlZmF1bHRUeXBlU3Ry\nYXRlZ3koRmllbGRNYXBwaW5nIGZpZWxkLAogICAgICAgIGJvb2xlYW4gaW5z\ndGFsbEhhbmRsZXJzLCBib29sZWFuIGFkYXB0aW5nKSB7CiAgICAgICAgc3dp\ndGNoIChmaWVsZC5nZXRUeXBlQ29kZSgpKSB7CiAgICAgICAgICAgIGNhc2Ug\nSmF2YVR5cGVzLkJPT0xFQU46CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVz\nLkJZVEU6CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLkNIQVI6CiAgICAg\nICAgICAgIGNhc2UgSmF2YVR5cGVzLkRPVUJMRToKICAgICAgICAgICAgY2Fz\nZSBKYXZhVHlwZXMuRkxPQVQ6CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVz\nLklOVDoKICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuTE9ORzoKICAgICAg\nICAgICAgY2FzZSBKYXZhVHlwZXMuU0hPUlQ6CiAgICAgICAgICAgICAgICBy\nZXR1cm4gbmV3IFByaW1pdGl2ZUZpZWxkU3RyYXRlZ3koKTsKICAgICAgICAg\nICAgY2FzZSBKYXZhVHlwZXMuU1RSSU5HOgogICAgICAgICAgICAgICAgaWYg\nKCFpc0Nsb2IoZmllbGQsIGZhbHNlKSkKICAgICAgICAgICAgICAgICAgICBy\nZXR1cm4gbmV3IFN0cmluZ0ZpZWxkU3RyYXRlZ3koKTsKICAgICAgICAgICAg\nICAgIGlmIChfZGljdC5tYXhFbWJlZGRlZENsb2JTaXplICE9IC0xKQogICAg\nICAgICAgICAgICAgICAgIHJldHVybiBuZXcgTWF4RW1iZWRkZWRDbG9iRmll\nbGRTdHJhdGVneSgpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAg\nICAgIGNhc2UgSmF2YVR5cGVzLlBDOgogICAgICAgICAgICAgICAgaWYgKGZp\nZWxkLmlzRW1iZWRkZWRQQygpKQogICAgICAgICAgICAgICAgICAgIHJldHVy\nbiBuZXcgRW1iZWRGaWVsZFN0cmF0ZWd5KCk7CiAgICAgICAgICAgICAgICBp\nZiAoZmllbGQuZ2V0VHlwZU1hcHBpbmcoKS5pc01hcHBlZCgpCiAgICAgICAg\nICAgICAgICAgICAgfHwgIXVzZVVudHlwZWRQQ0hhbmRsZXIoZmllbGQpKQog\nICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgUmVsYXRpb25GaWVsZFN0\ncmF0ZWd5KCk7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAg\nY2FzZSBKYXZhVHlwZXMuQVJSQVk6CiAgICAgICAgICAgIGNhc2UgSmF2YVR5\ncGVzLkNPTExFQ1RJT046CiAgICAgICAgICAgICAgICBWYWx1ZU1hcHBpbmcg\nZWxlbSA9IGZpZWxkLmdldEVsZW1lbnRNYXBwaW5nKCk7CiAgICAgICAgICAg\nICAgICBWYWx1ZUhhbmRsZXIgZWhhbmRsZXIgPSBuYW1lZEhhbmRsZXIoZWxl\nbSk7CiAgICAgICAgICAgICAgICBpZiAoZWhhbmRsZXIgPT0gbnVsbCkKICAg\nICAgICAgICAgICAgICAgICBlaGFuZGxlciA9IGRlZmF1bHRIYW5kbGVyKGVs\nZW0pOwogICAgICAgICAgICAgICAgaWYgKGVoYW5kbGVyICE9IG51bGwpCiAg\nICAgICAgICAgICAgICAgICAgcmV0dXJuIGhhbmRsZXJDb2xsZWN0aW9uU3Ry\nYXRlZ3koZmllbGQsIGVoYW5kbGVyLCAKICAgICAgICAgICAgICAgICAgICAg\nICAgaW5zdGFsbEhhbmRsZXJzKTsKICAgICAgICAgICAgICAgIGlmIChlbGVt\nLmdldFR5cGVDb2RlKCkgPT0gSmF2YVR5cGVzLlBDCiAgICAgICAgICAgICAg\nICAgICAgJiYgIWVsZW0uaXNTZXJpYWxpemVkKCkgJiYgIWVsZW0uaXNFbWJl\nZGRlZFBDKCkpIHsKICAgICAgICAgICAgICAgICAgICBpZiAodXNlSW52ZXJz\nZUtleU1hcHBpbmcoZmllbGQpKQogICAgICAgICAgICAgICAgICAgICAgICBy\nZXR1cm4gbmV3IFJlbGF0aW9uQ29sbGVjdGlvbkludmVyc2VLZXlGaWVsZFN0\ncmF0ZWd5KCk7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBSZWxh\ndGlvbkNvbGxlY3Rpb25UYWJsZUZpZWxkU3RyYXRlZ3koKTsKICAgICAgICAg\nICAgICAgIH0KICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBj\nYXNlIEphdmFUeXBlcy5NQVA6CiAgICAgICAgICAgICAgICBWYWx1ZU1hcHBp\nbmcga2V5ID0gZmllbGQuZ2V0S2V5TWFwcGluZygpOwogICAgICAgICAgICAg\nICAgVmFsdWVIYW5kbGVyIGtoYW5kbGVyID0gbmFtZWRIYW5kbGVyKGtleSk7\nCiAgICAgICAgICAgICAgICBpZiAoa2hhbmRsZXIgPT0gbnVsbCkKICAgICAg\nICAgICAgICAgICAgICBraGFuZGxlciA9IGRlZmF1bHRIYW5kbGVyKGtleSk7\nCiAgICAgICAgICAgICAgICBWYWx1ZU1hcHBpbmcgdmFsID0gZmllbGQuZ2V0\nRWxlbWVudE1hcHBpbmcoKTsKICAgICAgICAgICAgICAgIFZhbHVlSGFuZGxl\nciB2aGFuZGxlciA9IG5hbWVkSGFuZGxlcih2YWwpOwogICAgICAgICAgICAg\nICAgaWYgKHZoYW5kbGVyID09IG51bGwpCiAgICAgICAgICAgICAgICAgICAg\ndmhhbmRsZXIgPSBkZWZhdWx0SGFuZGxlcih2YWwpOwogICAgICAgICAgICAg\nICAgYm9vbGVhbiBrcmVsID0ga2hhbmRsZXIgPT0gbnVsbCAKICAgICAgICAg\nICAgICAgICAgICAmJiBrZXkuZ2V0VHlwZUNvZGUoKSA9PSBKYXZhVHlwZXMu\nUEMKICAgICAgICAgICAgICAgICAgICAmJiAha2V5LmlzU2VyaWFsaXplZCgp\nICYmICFrZXkuaXNFbWJlZGRlZFBDKCk7CiAgICAgICAgICAgICAgICBib29s\nZWFuIHZyZWwgPSB2aGFuZGxlciA9PSBudWxsIAogICAgICAgICAgICAgICAg\nICAgICYmIHZhbC5nZXRUeXBlQ29kZSgpID09IEphdmFUeXBlcy5QQwogICAg\nICAgICAgICAgICAgICAgICYmICF2YWwuaXNTZXJpYWxpemVkKCkgJiYgIXZh\nbC5pc0VtYmVkZGVkUEMoKTsKICAgICAgICAgICAgICAgIGlmICgha3JlbCAm\nJiB2cmVsICYmIGtleS5nZXRWYWx1ZU1hcHBlZEJ5KCkgIT0gbnVsbCkgewog\nICAgICAgICAgICAgICAgICAgIGlmICh1c2VJbnZlcnNlS2V5TWFwcGluZyhm\naWVsZCkpCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgUmVs\nYXRpb25NYXBJbnZlcnNlS2V5RmllbGRTdHJhdGVneSgpOwogICAgICAgICAg\nICAgICAgICAgIHJldHVybiBuZXcgUmVsYXRpb25NYXBUYWJsZUZpZWxkU3Ry\nYXRlZ3koKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlm\nICgha3JlbCAmJiBraGFuZGxlciA9PSBudWxsKQogICAgICAgICAgICAgICAg\nICAgIGJyZWFrOwogICAgICAgICAgICAgICAgaWYgKCF2cmVsICYmIHZoYW5k\nbGVyID09IG51bGwpCiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAg\nICAgICAgICAgICByZXR1cm4gaGFuZGxlck1hcFN0cmF0ZWd5KGZpZWxkLCBr\naGFuZGxlciwgdmhhbmRsZXIsIGtyZWwsCiAgICAgICAgICAgICAgICAgICAg\ndnJlbCwgaW5zdGFsbEhhbmRsZXJzKTsKICAgICAgICAgICAgY2FzZSBKYXZh\nVHlwZXMuSU5QVVRfU1RSRUFNOgogICAgICAgICAgICBjYXNlIEphdmFUeXBl\ncy5JTlBVVF9SRUFERVI6CiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IExv\nYkZpZWxkU3RyYXRlZ3koKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIG51\nbGw7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIGNvbGxlY3Rp\nb24gc3RyYXRlZ3kgZm9yIHRoZSBnaXZlbiBlbGVtZW50IGhhbmRsZXIsIG9y\nIG51bGwKICAgICAqIGlmIG5vbmUuCiAgICAgKi8KICAgIHByb3RlY3RlZCBG\naWVsZFN0cmF0ZWd5IGhhbmRsZXJDb2xsZWN0aW9uU3RyYXRlZ3koRmllbGRN\nYXBwaW5nIGZpZWxkLCAKICAgICAgICBWYWx1ZUhhbmRsZXIgZWhhbmRsZXIs\nIGJvb2xlYW4gaW5zdGFsbEhhbmRsZXJzKSB7CiAgICAgICAgaWYgKGdldENv\nbmZpZ3VyYXRpb24oKS5nZXRDb21wYXRpYmlsaXR5SW5zdGFuY2UoKQogICAg\nICAgICAgICAuZ2V0U3RvcmVNYXBDb2xsZWN0aW9uSW5FbnRpdHlBc0Jsb2Io\nKSkKICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgaWYgKGluc3Rh\nbGxIYW5kbGVycykKICAgICAgICAgICAgZmllbGQuZ2V0RWxlbWVudE1hcHBp\nbmcoKS5zZXRIYW5kbGVyKGVoYW5kbGVyKTsKICAgICAgICByZXR1cm4gbmV3\nIEhhbmRsZXJDb2xsZWN0aW9uVGFibGVGaWVsZFN0cmF0ZWd5KCk7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIG1hcCBzdHJhdGVneSBmb3Ig\ndGhlIGdpdmVuIGtleSBhbmQgdmFsdWUgaGFuZGxlcnMgLyByZWxhdGlvbnMs\nCiAgICAgKiBvciBudWxsIGlmIG5vbmUuCiAgICAgKi8KICAgIHByb3RlY3Rl\nZCBGaWVsZFN0cmF0ZWd5IGhhbmRsZXJNYXBTdHJhdGVneShGaWVsZE1hcHBp\nbmcgZmllbGQsIAogICAgICAgIFZhbHVlSGFuZGxlciBraGFuZGxlciwgVmFs\ndWVIYW5kbGVyIHZoYW5kbGVyLCBib29sZWFuIGtyZWwsIAogICAgICAgIGJv\nb2xlYW4gdnJlbCwgIGJvb2xlYW4gaW5zdGFsbEhhbmRsZXJzKSB7CiAgICAg\nICAgaWYgKGdldENvbmZpZ3VyYXRpb24oKS5nZXRDb21wYXRpYmlsaXR5SW5z\ndGFuY2UoKQogICAgICAgICAgICAuZ2V0U3RvcmVNYXBDb2xsZWN0aW9uSW5F\nbnRpdHlBc0Jsb2IoKSkKICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAg\nICAgaWYgKGluc3RhbGxIYW5kbGVycykgewogICAgICAgICAgICBmaWVsZC5n\nZXRLZXlNYXBwaW5nKCkuc2V0SGFuZGxlcihraGFuZGxlcik7CiAgICAgICAg\nICAgIGZpZWxkLmdldEVsZW1lbnRNYXBwaW5nKCkuc2V0SGFuZGxlcih2aGFu\nZGxlcik7CiAgICAgICAgfQogICAgICAgIGlmICgha3JlbCAmJiAhdnJlbCkK\nICAgICAgICAgICAgcmV0dXJuIG5ldyBIYW5kbGVySGFuZGxlck1hcFRhYmxl\nRmllbGRTdHJhdGVneSgpOwogICAgICAgIGlmICgha3JlbCAmJiB2cmVsKQog\nICAgICAgICAgICByZXR1cm4gbmV3IEhhbmRsZXJSZWxhdGlvbk1hcFRhYmxl\nRmllbGRTdHJhdGVneSgpOwogICAgICAgIGlmIChrcmVsICYmICF2cmVsKQog\nICAgICAgICAgICByZXR1cm4gbmV3IFJlbGF0aW9uSGFuZGxlck1hcFRhYmxl\nRmllbGRTdHJhdGVneSgpOwogICAgICAgIHJldHVybiBuZXcgUmVsYXRpb25S\nZWxhdGlvbk1hcFRhYmxlRmllbGRTdHJhdGVneSgpOwogICAgfQoKICAgIC8q\nKgogICAgICogVXNlIGhpbnRzIGluIG1hcHBpbmcgZGF0YSB0byBmaWd1cmUg\nb3V0IHdoZXRoZXIgdGhlIGdpdmVuIHJlbGF0aW9uCiAgICAgKiBmaWVsZCBz\naG91bGQgdXNlIGFuIGludmVyc2UgZm9yZWlnbiBrZXkgb3IgYW4gYXNzb2Np\nYXRpb24gdGFibGUgbWFwcGluZy4KICAgICAqLwogICAgcHJpdmF0ZSBib29s\nZWFuIHVzZUludmVyc2VLZXlNYXBwaW5nKEZpZWxkTWFwcGluZyBmaWVsZCkg\newogICAgICAgIEZpZWxkTWFwcGluZyBtYXBwZWQgPSBmaWVsZC5nZXRNYXBw\nZWRCeU1hcHBpbmcoKTsKICAgICAgICBpZiAobWFwcGVkICE9IG51bGwpIHsK\nICAgICAgICAgICAgaWYgKG1hcHBlZC5nZXRUeXBlQ29kZSgpID09IEphdmFU\neXBlcy5QQykKICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAg\nICAgICBpZiAobWFwcGVkLmdldEVsZW1lbnQoKS5nZXRUeXBlQ29kZSgpID09\nIEphdmFUeXBlcy5QQykKICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsK\nICAgICAgICAgICAgdGhyb3cgbmV3IE1ldGFEYXRhRXhjZXB0aW9uKF9sb2Mu\nZ2V0KCJiYWQtbWFwcGVkLWJ5IiwgZmllbGQsCiAgICAgICAgICAgICAgICBt\nYXBwZWQpKTsKICAgICAgICB9CgogICAgICAgIC8vIHdpdGhvdXQgYSBtYXBw\nZWQtYnksIHdlIGhhdmUgdG8gbG9vayBmb3IgY2x1ZXMgYXMgdG8gdGhlIG1h\ncHBpbmcuCiAgICAgICAgLy8gd2UgYXNzdW1lIHRoYXQgYW55dGhpbmcgd2l0\naCBlbGVtZW50IGZvcmVpZ24ga2V5IGNvbHVtbnMgYnV0IG5vIGpvaW4KICAg\nICAgICAvLyBjb2x1bW5zIG9yIHRhYmxlIHVzZXMgYW4gaW52ZXJzZSBmb3Jl\naWduIGtleSwgYW5kIGFueXRoaW5nIGVsc2UgdXNlcwogICAgICAgIC8vIGFu\nIGFzc29jaWF0aW9uIHRhYmxlCiAgICAgICAgRmllbGRNYXBwaW5nSW5mbyBp\nbmZvID0gZmllbGQuZ2V0TWFwcGluZ0luZm8oKTsKICAgICAgICBWYWx1ZU1h\ncHBpbmcgZWxlbSA9IGZpZWxkLmdldEVsZW1lbnRNYXBwaW5nKCk7CiAgICAg\nICAgcmV0dXJuIGluZm8uZ2V0VGFibGVOYW1lKCkgPT0gbnVsbCAmJiBpbmZv\nLmdldENvbHVtbnMoKS5pc0VtcHR5KCkKICAgICAgICAgICAgJiYgIWVsZW0u\nZ2V0VmFsdWVJbmZvKCkuZ2V0Q29sdW1ucygpLmlzRW1wdHkoKTsKICAgIH0K\nCiAgICAvKioKICAgICAqIENoZWNrIHRoZSBnaXZlbiB2YWx1ZSBhZ2FpbnN0\nIG1hcHBlZCBzdHJhdGVnaWVzLgogICAgICovCiAgICBwcml2YXRlIE9iamVj\ndCBtYXBwZWRTdHJhdGVneShWYWx1ZU1hcHBpbmcgdmFsLCBDbGFzcyB0eXBl\nLAogICAgICAgIGJvb2xlYW4gYWRhcHRpbmcpIHsKICAgICAgICBpZiAodHlw\nZSA9PSBudWxsIHx8IHR5cGUgPT0gT2JqZWN0LmNsYXNzKQogICAgICAgICAg\nICByZXR1cm4gbnVsbDsKCiAgICAgICAgT2JqZWN0IHN0cmF0ID0gX2RlZmF1\nbHRzLmdldFN0cmF0ZWd5KHZhbCwgdHlwZSwgYWRhcHRpbmcpOwoKICAgICAg\nICAvLyByZWN1cnNlIG9uIHN1cGVyY2xhc3Mgc28gdGhhdCwgZm9yIGV4YW1w\nbGUsIGEgcmVnaXN0ZXJlZCBoYW5kbGVyCiAgICAgICAgLy8gZm9yIGphdmEu\nbGFuZy5FbnVtIHdpbGwgd29yayBvbiBhbGwgZW51bXMKICAgICAgICBpZiAo\nc3RyYXQgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIG1hcHBlZFN0cmF0\nZWd5KHZhbCwgdHlwZS5nZXRTdXBlcmNsYXNzKCksIGFkYXB0aW5nKTsKICAg\nICAgICBpZiAoIShzdHJhdCBpbnN0YW5jZW9mIFN0cmluZykpCiAgICAgICAg\nICAgIHJldHVybiBzdHJhdDsKCiAgICAgICAgU3RyaW5nIG5hbWUgPSAoU3Ry\naW5nKSBzdHJhdDsKICAgICAgICBpZiAoTm9uZUZpZWxkU3RyYXRlZ3kuQUxJ\nQVMuZXF1YWxzKG5hbWUpKQogICAgICAgICAgICByZXR1cm4gTm9uZUZpZWxk\nU3RyYXRlZ3kuZ2V0SW5zdGFuY2UoKTsKCiAgICAgICAgU3RyaW5nIHByb3Bz\nID0gQ29uZmlndXJhdGlvbnMuZ2V0UHJvcGVydGllcyhuYW1lKTsKICAgICAg\nICBuYW1lID0gQ29uZmlndXJhdGlvbnMuZ2V0Q2xhc3NOYW1lKG5hbWUpOwog\nICAgICAgIHRyeSB7CiAgICAgICAgICAgIENsYXNzIGMgPSBKYXZhVHlwZXMu\nY2xhc3NGb3JOYW1lKG5hbWUsIHZhbCwKICAgICAgICAgICAgICAgIChDbGFz\nc0xvYWRlcikgQWNjZXNzQ29udHJvbGxlci5kb1ByaXZpbGVnZWQoCiAgICAg\nICAgICAgICAgICAgICAgSjJEb1ByaXZIZWxwZXIuZ2V0Q2xhc3NMb2FkZXJB\nY3Rpb24oRmllbGRTdHJhdGVneS5jbGFzcykpKTsKICAgICAgICAgICAgT2Jq\nZWN0IG8gPSBBY2Nlc3NDb250cm9sbGVyLmRvUHJpdmlsZWdlZCgKICAgICAg\nICAgICAgICAgIEoyRG9Qcml2SGVscGVyLm5ld0luc3RhbmNlQWN0aW9uKGMp\nKTsKICAgICAgICAgICAgQ29uZmlndXJhdGlvbnMuY29uZmlndXJlSW5zdGFu\nY2UobywgZ2V0Q29uZmlndXJhdGlvbigpLCBwcm9wcyk7CiAgICAgICAgICAg\nIHJldHVybiBvOwogICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAg\nICAgICAgICAgIGlmIChlIGluc3RhbmNlb2YgUHJpdmlsZWdlZEFjdGlvbkV4\nY2VwdGlvbikKICAgICAgICAgICAgICAgIGUgPSAoKFByaXZpbGVnZWRBY3Rp\nb25FeGNlcHRpb24pIGUpLmdldEV4Y2VwdGlvbigpOwogICAgICAgICAgICB0\naHJvdyBuZXcgTWV0YURhdGFFeGNlcHRpb24oX2xvYy5nZXQoImJhZC1tYXBw\nZWQtc3RyYXRlZ3kiLAogICAgICAgICAgICAgICAgdmFsLCBuYW1lKSwgZSk7\nCiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogSW5zdGFudGlhdGUg\ndGhlIGdpdmVuIHZhbHVlJ3MgbmFtZWQgaGFuZGxlciwgb3IgcmV0dXJuIG51\nbGwgaWYgbm8KICAgICAqIG5hbWVkIGhhbmRsZXIuCiAgICAgKi8KICAgIHBy\nb3RlY3RlZCBWYWx1ZUhhbmRsZXIgbmFtZWRIYW5kbGVyKFZhbHVlTWFwcGlu\nZyB2YWwpIHsKICAgICAgICBTdHJpbmcgbmFtZSA9IHZhbC5nZXRWYWx1ZUlu\nZm8oKS5nZXRTdHJhdGVneSgpOwogICAgICAgIGlmIChuYW1lID09IG51bGwp\nCiAgICAgICAgICAgIHJldHVybiBudWxsOwoKICAgICAgICBTdHJpbmcgcHJv\ncHMgPSBDb25maWd1cmF0aW9ucy5nZXRQcm9wZXJ0aWVzKG5hbWUpOwogICAg\nICAgIG5hbWUgPSBDb25maWd1cmF0aW9ucy5nZXRDbGFzc05hbWUobmFtZSk7\nCiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgQ2xhc3MgYyA9IEphdmFUeXBl\ncy5jbGFzc0Zvck5hbWUobmFtZSwgdmFsLAogICAgICAgICAgICAgICAgKENs\nYXNzTG9hZGVyKSBBY2Nlc3NDb250cm9sbGVyLmRvUHJpdmlsZWdlZCgKICAg\nICAgICAgICAgICAgICAgICBKMkRvUHJpdkhlbHBlci5nZXRDbGFzc0xvYWRl\nckFjdGlvbihWYWx1ZUhhbmRsZXIuY2xhc3MpKSk7CiAgICAgICAgICAgIGlm\nIChWYWx1ZUhhbmRsZXIuY2xhc3MuaXNBc3NpZ25hYmxlRnJvbShjKSkgewog\nICAgICAgICAgICAgICAgVmFsdWVIYW5kbGVyIHZoID0gKFZhbHVlSGFuZGxl\ncikgQWNjZXNzQ29udHJvbGxlci5kb1ByaXZpbGVnZWQoCiAgICAgICAgICAg\nICAgICAgICAgSjJEb1ByaXZIZWxwZXIubmV3SW5zdGFuY2VBY3Rpb24oYykp\nOwogICAgICAgICAgICAgICAgQ29uZmlndXJhdGlvbnMuY29uZmlndXJlSW5z\ndGFuY2UodmgsIGdldENvbmZpZ3VyYXRpb24oKSwKICAgICAgICAgICAgICAg\nICAgICBwcm9wcyk7CiAgICAgICAgICAgICAgICByZXR1cm4gdmg7CiAgICAg\nICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIG51bGw7IC8vIG5hbWVkIGZp\nZWxkIHN0cmF0ZWd5CiAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsK\nICAgICAgICAgICAgaWYgKGUgaW5zdGFuY2VvZiBQcml2aWxlZ2VkQWN0aW9u\nRXhjZXB0aW9uKQogICAgICAgICAgICAgICAgZSA9ICgoUHJpdmlsZWdlZEFj\ndGlvbkV4Y2VwdGlvbikgZSkuZ2V0RXhjZXB0aW9uKCk7CiAgICAgICAgICAg\nIHRocm93IG5ldyBNZXRhRGF0YUV4Y2VwdGlvbihfbG9jLmdldCgiYmFkLXZh\nbHVlLWhhbmRsZXIiLAogICAgICAgICAgICAgICAgdmFsLCBuYW1lKSwgZSk7\nCiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogRGV0ZXJtaW5lIHRo\nZSBkZWZhdWx0IGhhbmRsZXIgdG8gdXNlIGZvciB0aGUgZ2l2ZW4gdmFsdWUu\nIERvZXMKICAgICAqIG5vdCB0YWtlIGludG8gYWNjb3VudCB0aGUgbmFtZWQg\naGFuZGxlciwgaWYgYW55LgogICAgICovCiAgICBwcm90ZWN0ZWQgVmFsdWVI\nYW5kbGVyIGRlZmF1bHRIYW5kbGVyKFZhbHVlTWFwcGluZyB2YWwpIHsKICAg\nICAgICByZXR1cm4gZGVmYXVsdEhhbmRsZXIodmFsLCBnZXRTdHJhdGVneUlu\nc3RhbGxlcigpLmlzQWRhcHRpbmcoKSk7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBEZXRlcm1pbmUgdGhlIGRlZmF1bHQgaGFuZGxlciB0byB1c2UgZm9yIHRo\nZSBnaXZlbiB2YWx1ZS4gRG9lcwogICAgICogbm90IHRha2UgaW50byBhY2Nv\ndW50IHRoZSBuYW1lZCBoYW5kbGVyLCBpZiBhbnkuCiAgICAgKi8KICAgIHBy\nb3RlY3RlZCBWYWx1ZUhhbmRsZXIgZGVmYXVsdEhhbmRsZXIoVmFsdWVNYXBw\naW5nIHZhbCwgYm9vbGVhbiBhZGFwdGluZykgewogICAgICAgIGlmICh2YWwu\naXNTZXJpYWxpemVkKCkpIHsKICAgICAgICAgICAgaWYgKF9kaWN0Lm1heEVt\nYmVkZGVkQmxvYlNpemUgIT0gLTEpCiAgICAgICAgICAgICAgICB3YXJuTWF4\nRW1iZWRkZWQodmFsLCBfZGljdC5tYXhFbWJlZGRlZEJsb2JTaXplKTsKICAg\nICAgICAgICAgcmV0dXJuIEJsb2JWYWx1ZUhhbmRsZXIuZ2V0SW5zdGFuY2Uo\nKTsKICAgICAgICB9CgogICAgICAgIE9iamVjdCBoYW5kbGVyID0gbWFwcGVk\nU3RyYXRlZ3kodmFsLCB2YWwuZ2V0VHlwZSgpLCBhZGFwdGluZyk7CiAgICAg\nICAgaWYgKGhhbmRsZXIgaW5zdGFuY2VvZiBWYWx1ZUhhbmRsZXIpCiAgICAg\nICAgICAgIHJldHVybiAoVmFsdWVIYW5kbGVyKSBoYW5kbGVyOwoKICAgICAg\nICBpZiAodmFsLmdldFR5cGUoKSA9PSBieXRlW10uY2xhc3MgCiAgICAgICAg\nICAgIHx8IHZhbC5nZXRUeXBlKCkgPT0gQnl0ZVtdLmNsYXNzKSB7CiAgICAg\nICAgICAgIGlmIChfZGljdC5tYXhFbWJlZGRlZEJsb2JTaXplICE9IC0xKQog\nICAgICAgICAgICAgICAgd2Fybk1heEVtYmVkZGVkKHZhbCwgX2RpY3QubWF4\nRW1iZWRkZWRCbG9iU2l6ZSk7CiAgICAgICAgICAgIHJldHVybiBCeXRlQXJy\nYXlWYWx1ZUhhbmRsZXIuZ2V0SW5zdGFuY2UoKTsKICAgICAgICB9CiAgICAg\nICAgaWYgKHZhbC5nZXRUeXBlKCkgPT0gY2hhcltdLmNsYXNzCiAgICAgICAg\nICAgIHx8IHZhbC5nZXRUeXBlKCkgPT0gQ2hhcmFjdGVyW10uY2xhc3MpIHsK\nICAgICAgICAgICAgaWYgKGlzQ2xvYih2YWwsIHRydWUpKQogICAgICAgICAg\nICAgICAgcmV0dXJuIENoYXJBcnJheVN0cmVhbVZhbHVlSGFuZGxlci5nZXRJ\nbnN0YW5jZSgpOwogICAgICAgICAgICByZXR1cm4gQ2hhckFycmF5VmFsdWVI\nYW5kbGVyLmdldEluc3RhbmNlKCk7CiAgICAgICAgfQoKICAgICAgICBzd2l0\nY2ggKHZhbC5nZXRUeXBlQ29kZSgpKSB7CiAgICAgICAgICAgIGNhc2UgSmF2\nYVR5cGVzLkJPT0xFQU46CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLkJZ\nVEU6CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLkNIQVI6CiAgICAgICAg\nICAgIGNhc2UgSmF2YVR5cGVzLkRPVUJMRToKICAgICAgICAgICAgY2FzZSBK\nYXZhVHlwZXMuRkxPQVQ6CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLklO\nVDoKICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuTE9ORzoKICAgICAgICAg\nICAgY2FzZSBKYXZhVHlwZXMuU0hPUlQ6CiAgICAgICAgICAgIGNhc2UgSmF2\nYVR5cGVzLkJPT0xFQU5fT0JKOgogICAgICAgICAgICBjYXNlIEphdmFUeXBl\ncy5CWVRFX09CSjoKICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuQ0hBUl9P\nQko6CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLkRPVUJMRV9PQko6CiAg\nICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLkZMT0FUX09CSjoKICAgICAgICAg\nICAgY2FzZSBKYXZhVHlwZXMuSU5UX09CSjoKICAgICAgICAgICAgY2FzZSBK\nYXZhVHlwZXMuTE9OR19PQko6CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVz\nLlNIT1JUX09CSjoKICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuQklHSU5U\nRUdFUjoKICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuQklHREVDSU1BTDoK\nICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuTlVNQkVSOgogICAgICAgICAg\nICBjYXNlIEphdmFUeXBlcy5EQVRFOgogICAgICAgICAgICBjYXNlIEphdmFU\neXBlcy5DQUxFTkRBUjoKICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuTE9D\nQUxFOgogICAgICAgICAgICAgICAgcmV0dXJuIEltbXV0YWJsZVZhbHVlSGFu\nZGxlci5nZXRJbnN0YW5jZSgpOwogICAgICAgICAgICBjYXNlIEphdmFUeXBl\ncy5TVFJJTkc6CiAgICAgICAgICAgICAgICBpZiAoaXNDbG9iKHZhbCwgdHJ1\nZSkpCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIENsb2JWYWx1ZUhhbmRs\nZXIuZ2V0SW5zdGFuY2UoKTsKICAgICAgICAgICAgICAgIHJldHVybiBJbW11\ndGFibGVWYWx1ZUhhbmRsZXIuZ2V0SW5zdGFuY2UoKTsKICAgICAgICAgICAg\nY2FzZSBKYXZhVHlwZXMuUEM6CiAgICAgICAgICAgICAgICBpZiAoIXZhbC5n\nZXRUeXBlTWFwcGluZygpLmlzTWFwcGVkKCkKICAgICAgICAgICAgICAgICAg\nICAmJiB1c2VVbnR5cGVkUENIYW5kbGVyKHZhbCkpIAogICAgICAgICAgICAg\nICAgICAgIHJldHVybiBVbnR5cGVkUENWYWx1ZUhhbmRsZXIuZ2V0SW5zdGFu\nY2UoKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNl\nIEphdmFUeXBlcy5QQ19VTlRZUEVEOgogICAgICAgICAgICAgICAgcmV0dXJu\nIFVudHlwZWRQQ1ZhbHVlSGFuZGxlci5nZXRJbnN0YW5jZSgpOwogICAgICAg\nICAgICBjYXNlIEphdmFUeXBlcy5PSUQ6CiAgICAgICAgICAgICAgICByZXR1\ncm4gbmV3IE9iamVjdElkVmFsdWVIYW5kbGVyKCk7CiAgICAgICAgfQogICAg\nICAgIGlmICghZ2V0Q29uZmlndXJhdGlvbigpLmdldENvbXBhdGliaWxpdHlJ\nbnN0YW5jZSgpCiAgICAgICAgICAgIC5nZXRTdG9yZU1hcENvbGxlY3Rpb25J\nbkVudGl0eUFzQmxvYigpCiAgICAgICAgICAgICYmIHZhbC5pc0VtYmVkZGVk\nUEMoKSkKICAgICAgICAgICAgcmV0dXJuIG5ldyBFbGVtZW50RW1iZWRWYWx1\nZUhhbmRsZXIoKTsKICAgICAgICByZXR1cm4gbnVsbDsKICAgIH0KCiAgICAv\nKioKICAgICAqIFJldHVybiB0cnVlIGlmIHdlIHNob3VsZCB1c2UgdGhlIGdl\nbmVyaWMgdW50eXBlZCBQQyBoYW5kbGVyIGZvciB0aGUKICAgICAqIGdpdmVu\nIHVubWFwcGVkIHJlbGF0aW9uLgogICAgICovCiAgICBwcml2YXRlIGJvb2xl\nYW4gdXNlVW50eXBlZFBDSGFuZGxlcihWYWx1ZU1hcHBpbmcgdmFsKSB7CiAg\nICAgICAgQ2xhc3NNYXBwaW5nIHJlbCA9IHZhbC5nZXRUeXBlTWFwcGluZygp\nOwogICAgICAgIHJldHVybiByZWwuZ2V0SWRlbnRpdHlUeXBlKCkgPT0gQ2xh\nc3NNYXBwaW5nLklEX1VOS05PV04KICAgICAgICAgICAgfHwgKHJlbC5nZXRJ\nZGVudGl0eVR5cGUoKSA9PSBDbGFzc01hcHBpbmcuSURfQVBQTElDQVRJT04K\nICAgICAgICAgICAgJiYgKHJlbC5nZXRQcmltYXJ5S2V5RmllbGRzKCkubGVu\nZ3RoID09IDAKICAgICAgICAgICAgfHwgKCFyZWwuaXNPcGVuSlBBSWRlbnRp\ndHkoKSAmJiBNb2RpZmllci5pc0Fic3RyYWN0CiAgICAgICAgICAgIChyZWwu\nZ2V0T2JqZWN0SWRUeXBlKCkuZ2V0TW9kaWZpZXJzKCkpKSkpOwogICAgfQoK\nICAgIC8qKgogICAgICogQ2hlY2tzIGZvciBoaW50cyBhcyB0byB3aGV0aGVy\nIHRoZSBnaXZlbiBjb2x1bW4gaXMgYSBDTE9CLgogICAgICovCiAgICBwcml2\nYXRlIGJvb2xlYW4gaXNDbG9iKFZhbHVlTWFwcGluZyB2YWwsIGJvb2xlYW4g\nd2FybikgewogICAgICAgIExpc3QgY29scyA9IHZhbC5nZXRWYWx1ZUluZm8o\nKS5nZXRDb2x1bW5zKCk7CiAgICAgICAgaWYgKGNvbHMuc2l6ZSgpICE9IDEp\nCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCiAgICAgICAgQ29sdW1uIGNv\nbCA9IChDb2x1bW4pIGNvbHMuZ2V0KDApOwogICAgICAgIGlmIChjb2wuZ2V0\nU2l6ZSgpICE9IC0xICYmIGNvbC5nZXRUeXBlKCkgIT0gVHlwZXMuQ0xPQikK\nICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoKICAgICAgICBpZiAoX2RpY3Qu\nZ2V0UHJlZmVycmVkVHlwZShUeXBlcy5DTE9CKSAhPSBUeXBlcy5DTE9CKQog\nICAgICAgICAgICByZXR1cm4gZmFsc2U7CgogICAgICAgIGlmICh3YXJuICYm\nIF9kaWN0Lm1heEVtYmVkZGVkQ2xvYlNpemUgIT0gLTEpCiAgICAgICAgICAg\nIHdhcm5NYXhFbWJlZGRlZCh2YWwsIF9kaWN0Lm1heEVtYmVkZGVkQ2xvYlNp\nemUpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qKgogICAg\nICogV2FybiB0aGF0IHRoZSBnaXZlbiB2YWx1ZSBpcyBiZWluZyBtYXBwZWQg\ndG8gYSBoYW5kbGVyIHRoYXQgd2lsbCBub3QKICAgICAqIGJlIGFibGUgdG8g\nc3RvcmUgbGFyZ2UgbG9icy4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIHdh\ncm5NYXhFbWJlZGRlZChWYWx1ZU1hcHBpbmcgdmFsLCBpbnQgc2l6ZSkgewog\nICAgICAgIGlmIChnZXRMb2coKS5pc1dhcm5FbmFibGVkKCkpCiAgICAgICAg\nICAgIGdldExvZygpLndhcm4oX2xvYy5nZXQoIm1heC1lbWJlZC1sb2IiLCB2\nYWwsCiAgICAgICAgICAgICAgICBTdHJpbmcudmFsdWVPZihzaXplKSkpOwog\nICAgfQoKICAgIC8qKgogICAgICogRGV0ZXJtaW5lIHRoZSBkZWZhdWx0IHN0\ncmF0ZWd5IHRvIHVzZSBmb3IgdGhlIGdpdmVuIGRpc2NyaW1pbmF0b3IuCiAg\nICAgKiBEb2VzIG5vdCB0YWtlIGludG8gYWNjb3VudCB0aGUgY3VycmVudCBz\ndHJhdGVneSwgaWYgYW55LgogICAgICovCiAgICBwcm90ZWN0ZWQgRGlzY3Jp\nbWluYXRvclN0cmF0ZWd5IGRlZmF1bHRTdHJhdGVneShEaXNjcmltaW5hdG9y\nIGRpc2NyaW0pIHsKICAgICAgICByZXR1cm4gZGVmYXVsdFN0cmF0ZWd5KGRp\nc2NyaW0sIGdldFN0cmF0ZWd5SW5zdGFsbGVyKCkuaXNBZGFwdGluZygpKTsK\nICAgIH0KCiAgICAvKioKICAgICAqIERldGVybWluZSB0aGUgZGVmYXVsdCBz\ndHJhdGVneSB0byB1c2UgZm9yIHRoZSBnaXZlbiBkaXNjcmltaW5hdG9yLgog\nICAgICogRG9lcyBub3QgdGFrZSBpbnRvIGFjY291bnQgdGhlIGN1cnJlbnQg\nc3RyYXRlZ3ksIGlmIGFueS4KICAgICAqLwogICAgcHJvdGVjdGVkIERpc2Ny\naW1pbmF0b3JTdHJhdGVneSBkZWZhdWx0U3RyYXRlZ3koRGlzY3JpbWluYXRv\nciBkaXNjcmltLAogICAgICAgIGJvb2xlYW4gYWRhcHRpbmcpIHsKICAgICAg\nICBDbGFzc01hcHBpbmcgY2xzID0gZGlzY3JpbS5nZXRDbGFzc01hcHBpbmco\nKTsKICAgICAgICBpZiAoY2xzLmdldEVtYmVkZGluZ01ldGFEYXRhKCkgIT0g\nbnVsbCkKICAgICAgICAgICAgcmV0dXJuIE5vbmVEaXNjcmltaW5hdG9yU3Ry\nYXRlZ3kuZ2V0SW5zdGFuY2UoKTsKICAgICAgICBpZiAoY2xzLmdldEpvaW5h\nYmxlUENTdXBlcmNsYXNzTWFwcGluZygpID09IG51bGwKICAgICAgICAgICAg\nJiYgKGNscy5nZXRTdHJhdGVneSgpID09IE5vbmVDbGFzc1N0cmF0ZWd5Lmdl\ndEluc3RhbmNlKCkKICAgICAgICAgICAgfHwgTW9kaWZpZXIuaXNGaW5hbChk\naXNjcmltLmdldENsYXNzTWFwcGluZygpLmdldERlc2NyaWJlZFR5cGUoKS4K\nICAgICAgICAgICAgZ2V0TW9kaWZpZXJzKCkpKSkKICAgICAgICAgICAgcmV0\ndXJuIE5vbmVEaXNjcmltaW5hdG9yU3RyYXRlZ3kuZ2V0SW5zdGFuY2UoKTsK\nCiAgICAgICAgT2JqZWN0IHN0cmF0ID0gX2RlZmF1bHRzLmdldFN0cmF0ZWd5\nKGRpc2NyaW0sIGFkYXB0aW5nKTsKICAgICAgICBpZiAoc3RyYXQgaW5zdGFu\nY2VvZiBTdHJpbmcpCiAgICAgICAgICAgIHJldHVybiBpbnN0YW50aWF0ZURp\nc2NyaW1pbmF0b3JTdHJhdGVneSgoU3RyaW5nKSBzdHJhdCwgZGlzY3JpbSk7\nCiAgICAgICAgaWYgKHN0cmF0ICE9IG51bGwpCiAgICAgICAgICAgIHJldHVy\nbiAoRGlzY3JpbWluYXRvclN0cmF0ZWd5KSBzdHJhdDsKCiAgICAgICAgaWYg\nKGNscy5nZXRKb2luYWJsZVBDU3VwZXJjbGFzc01hcHBpbmcoKSAhPSBudWxs\nKQogICAgICAgICAgICByZXR1cm4gbmV3IFN1cGVyY2xhc3NEaXNjcmltaW5h\ndG9yU3RyYXRlZ3koKTsKICAgICAgICBpZiAoZGlzY3JpbS5nZXRNYXBwaW5n\nSW5mbygpLmdldFZhbHVlKCkgIT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJu\nIG5ldyBWYWx1ZU1hcERpc2NyaW1pbmF0b3JTdHJhdGVneSgpOwogICAgICAg\nIGlmIChjbHMuZ2V0TWFwcGVkUENTdXBlcmNsYXNzTWFwcGluZygpICE9IG51\nbGwpCiAgICAgICAgICAgIHJldHVybiBOb25lRGlzY3JpbWluYXRvclN0cmF0\nZWd5LmdldEluc3RhbmNlKCk7CiAgICAgICAgaWYgKGFkYXB0aW5nIHx8IF9k\nZWZhdWx0cy5kZWZhdWx0TWlzc2luZ0luZm8oKSkKICAgICAgICAgICAgcmV0\ndXJuIG5ldyBDbGFzc05hbWVEaXNjcmltaW5hdG9yU3RyYXRlZ3koKTsKICAg\nICAgICBEQkRpY3Rpb25hcnkgZGljdCA9ICgoSkRCQ0NvbmZpZ3VyYXRpb24p\nIGdldENvbmZpZ3VyYXRpb24oKSkuCiAgICAgICAgICAgIGdldERCRGljdGlv\nbmFyeUluc3RhbmNlKCk7CiAgICAgICAgaWYgKGRpY3Quam9pblN5bnRheCA9\nPSBKb2luU3ludGF4ZXMuU1lOVEFYX1RSQURJVElPTkFMKQogICAgICAgICAg\nICByZXR1cm4gTm9uZURpc2NyaW1pbmF0b3JTdHJhdGVneS5nZXRJbnN0YW5j\nZSgpOwogICAgICAgIHJldHVybiBuZXcgU3ViY2xhc3NKb2luRGlzY3JpbWlu\nYXRvclN0cmF0ZWd5KCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBEZXRlcm1p\nbmUgdGhlIGRlZmF1bHQgc3RyYXRlZ3kgdG8gdXNlIGZvciB0aGUgZ2l2ZW4g\ndmVyc2lvbi4KICAgICAqIERvZXMgbm90IHRha2UgaW50byBhY2NvdW50IHRo\nZSBjdXJyZW50IHN0cmF0ZWd5LCBpZiBhbnkuCiAgICAgKi8KICAgIHByb3Rl\nY3RlZCBWZXJzaW9uU3RyYXRlZ3kgZGVmYXVsdFN0cmF0ZWd5KFZlcnNpb24g\ndmVyc2lvbikgewogICAgICAgIHJldHVybiBkZWZhdWx0U3RyYXRlZ3kodmVy\nc2lvbiwgZ2V0U3RyYXRlZ3lJbnN0YWxsZXIoKS5pc0FkYXB0aW5nKCkpOwog\nICAgfQoKICAgIC8qKgogICAgICogRGV0ZXJtaW5lIHRoZSBkZWZhdWx0IHN0\ncmF0ZWd5IHRvIHVzZSBmb3IgdGhlIGdpdmVuIHZlcnNpb24uCiAgICAgKiBE\nb2VzIG5vdCB0YWtlIGludG8gYWNjb3VudCB0aGUgY3VycmVudCBzdHJhdGVn\neSwgaWYgYW55LgogICAgICovCiAgICBwcm90ZWN0ZWQgVmVyc2lvblN0cmF0\nZWd5IGRlZmF1bHRTdHJhdGVneShWZXJzaW9uIHZlcnNpb24sCiAgICAgICAg\nYm9vbGVhbiBhZGFwdGluZykgewogICAgICAgIENsYXNzTWFwcGluZyBjbHMg\nPSB2ZXJzaW9uLmdldENsYXNzTWFwcGluZygpOwogICAgICAgIGlmIChjbHMu\nZ2V0RW1iZWRkaW5nTWV0YURhdGEoKSAhPSBudWxsKQogICAgICAgICAgICBy\nZXR1cm4gTm9uZVZlcnNpb25TdHJhdGVneS5nZXRJbnN0YW5jZSgpOwogICAg\nICAgIGlmIChjbHMuZ2V0Sm9pbmFibGVQQ1N1cGVyY2xhc3NNYXBwaW5nKCkg\nPT0gbnVsbAogICAgICAgICAgICAmJiBjbHMuZ2V0U3RyYXRlZ3koKSA9PSBO\nb25lQ2xhc3NTdHJhdGVneS5nZXRJbnN0YW5jZSgpKQogICAgICAgICAgICBy\nZXR1cm4gTm9uZVZlcnNpb25TdHJhdGVneS5nZXRJbnN0YW5jZSgpOwoKICAg\nICAgICBPYmplY3Qgc3RyYXQgPSBfZGVmYXVsdHMuZ2V0U3RyYXRlZ3kodmVy\nc2lvbiwgYWRhcHRpbmcpOwogICAgICAgIGlmIChzdHJhdCBpbnN0YW5jZW9m\nIFN0cmluZykKICAgICAgICAgICAgcmV0dXJuIGluc3RhbnRpYXRlVmVyc2lv\nblN0cmF0ZWd5KChTdHJpbmcpIHN0cmF0LCB2ZXJzaW9uKTsKICAgICAgICBp\nZiAoc3RyYXQgIT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIChWZXJzaW9u\nU3RyYXRlZ3kpIHN0cmF0OwoKICAgICAgICBpZiAoY2xzLmdldEpvaW5hYmxl\nUENTdXBlcmNsYXNzTWFwcGluZygpICE9IG51bGwpCiAgICAgICAgICAgIHJl\ndHVybiBuZXcgU3VwZXJjbGFzc1ZlcnNpb25TdHJhdGVneSgpOwoKICAgICAg\nICBGaWVsZE1hcHBpbmcgdmZpZWxkID0gdmVyc2lvbi5nZXRDbGFzc01hcHBp\nbmcoKS4KICAgICAgICAgICAgZ2V0VmVyc2lvbkZpZWxkTWFwcGluZygpOwog\nICAgICAgIGlmICh2ZmllbGQgIT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJu\nIGRlZmF1bHRTdHJhdGVneSh2ZXJzaW9uLCB2ZmllbGQpOwogICAgICAgIGlm\nIChhZGFwdGluZyB8fCBfZGVmYXVsdHMuZGVmYXVsdE1pc3NpbmdJbmZvKCkp\nCiAgICAgICAgICAgIHJldHVybiBuZXcgTnVtYmVyVmVyc2lvblN0cmF0ZWd5\nKCk7CiAgICAgICAgcmV0dXJuIE5vbmVWZXJzaW9uU3RyYXRlZ3kuZ2V0SW5z\ndGFuY2UoKTsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgZGVm\nYXVsdCB2ZXJzaW9uIHN0cmF0ZWd5LCBnaXZlbiBhIHZlcnNpb24gZmllbGQu\nCiAgICAgKi8KICAgIHByb3RlY3RlZCBWZXJzaW9uU3RyYXRlZ3kgZGVmYXVs\ndFN0cmF0ZWd5KFZlcnNpb24gdmVycywKICAgICAgICBGaWVsZE1hcHBpbmcg\ndmZpZWxkKSB7CiAgICAgICAgc3dpdGNoICh2ZmllbGQuZ2V0VHlwZUNvZGUo\nKSkgewogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5EQVRFOgogICAgICAg\nICAgICBjYXNlIEphdmFUeXBlcy5DQUxFTkRBUjoKICAgICAgICAgICAgICAg\nIHJldHVybiAoSmF2YVZlcnNpb25zLlZFUlNJT04gPj0gNSkgCiAgICAgICAg\nICAgICAgICAgICAgPyBuZXcgTmFub1ByZWNpc2lvblRpbWVzdGFtcFZlcnNp\nb25TdHJhdGVneSgpCiAgICAgICAgICAgICAgICAgICAgOiBuZXcgVGltZXN0\nYW1wVmVyc2lvblN0cmF0ZWd5KCk7CiAgICAgICAgICAgIGNhc2UgSmF2YVR5\ncGVzLkJZVEU6CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLklOVDoKICAg\nICAgICAgICAgY2FzZSBKYXZhVHlwZXMuTE9ORzoKICAgICAgICAgICAgY2Fz\nZSBKYXZhVHlwZXMuU0hPUlQ6CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVz\nLkJZVEVfT0JKOgogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5JTlRfT0JK\nOgogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5MT05HX09CSjoKICAgICAg\nICAgICAgY2FzZSBKYXZhVHlwZXMuU0hPUlRfT0JKOgogICAgICAgICAgICBj\nYXNlIEphdmFUeXBlcy5OVU1CRVI6CiAgICAgICAgICAgICAgICByZXR1cm4g\nbmV3IE51bWJlclZlcnNpb25TdHJhdGVneSgpOwogICAgICAgICAgICBkZWZh\ndWx0OgogICAgICAgICAgICAgICAgcmV0dXJuIE5vbmVWZXJzaW9uU3RyYXRl\nZ3kuZ2V0SW5zdGFuY2UoKTsKICAgICAgICB9CiAgICB9CiAgICAKICAgIHB1\nYmxpYyB2b2lkIGVuZENvbmZpZ3VyYXRpb24oKQogICAgewogICAgICAgIHN1\ncGVyLmVuZENvbmZpZ3VyYXRpb24oKTsKCiAgICAgICAgSkRCQ0NvbmZpZ3Vy\nYXRpb24gY29uZiA9IChKREJDQ29uZmlndXJhdGlvbikgZ2V0Q29uZmlndXJh\ndGlvbigpOwogICAgICAgIF9kaWN0ID0gY29uZi5nZXREQkRpY3Rpb25hcnlJ\nbnN0YW5jZSgpOwogICAgICAgIGlmIChfZGVmYXVsdHMgPT0gbnVsbCkKICAg\nICAgICAgICAgX2RlZmF1bHRzID0gY29uZi5nZXRNYXBwaW5nRGVmYXVsdHNJ\nbnN0YW5jZSgpOwogICAgICAgIGlmIChfc2NoZW1hICE9IG51bGwgJiYgX3Nj\naGVtYSBpbnN0YW5jZW9mIENvbmZpZ3VyYWJsZSkgewogICAgICAgICAgICAo\nKENvbmZpZ3VyYWJsZSkgX3NjaGVtYSkuc2V0Q29uZmlndXJhdGlvbihjb25m\nKTsKICAgICAgICAgICAgKChDb25maWd1cmFibGUpIF9zY2hlbWEpLnN0YXJ0\nQ29uZmlndXJhdGlvbigpOwogICAgICAgICAgICAoKENvbmZpZ3VyYWJsZSkg\nX3NjaGVtYSkuZW5kQ29uZmlndXJhdGlvbigpOwogICAgICAgIH0gICAgICAg\nICAgICAKICAgIH0KfQo=\n","encoding":"base64"}

