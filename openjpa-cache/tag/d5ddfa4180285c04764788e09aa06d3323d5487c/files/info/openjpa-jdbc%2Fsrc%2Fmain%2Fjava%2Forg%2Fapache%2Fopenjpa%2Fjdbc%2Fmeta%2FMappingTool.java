{"sha":"d9ac176dc72903732003876e55b7b1bd33ee7cbc","node_id":"MDQ6QmxvYjIwNjM2NDpkOWFjMTc2ZGM3MjkwMzczMjAwMzg3NmU1NWI3YjFiZDMzZWU3Y2Jj","size":42791,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/d9ac176dc72903732003876e55b7b1bd33ee7cbc","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhOwoKaW1wb3J0\nIGphdmEuaW8uRmlsZTsKaW1wb3J0IGphdmEuaW8uSU9FeGNlcHRpb247Cmlt\ncG9ydCBqYXZhLmlvLlByaW50V3JpdGVyOwppbXBvcnQgamF2YS5pby5Xcml0\nZXI7CmltcG9ydCBqYXZhLnNlY3VyaXR5LkFjY2Vzc0NvbnRyb2xsZXI7Cmlt\ncG9ydCBqYXZhLnNlY3VyaXR5LlByaXZpbGVnZWRBY3Rpb25FeGNlcHRpb247\nCmltcG9ydCBqYXZhLnNxbC5TUUxFeGNlcHRpb247CmltcG9ydCBqYXZhLnV0\naWwuQXJyYXlzOwppbXBvcnQgamF2YS51dGlsLkNvbGxlY3Rpb247CmltcG9y\ndCBqYXZhLnV0aWwuSGFzaE1hcDsKaW1wb3J0IGphdmEudXRpbC5IYXNoU2V0\nOwppbXBvcnQgamF2YS51dGlsLkl0ZXJhdG9yOwppbXBvcnQgamF2YS51dGls\nLk1hcDsKaW1wb3J0IGphdmEudXRpbC5TZXQ7CgppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLmNvbmYuT3BlbkpQQUNvbmZpZ3VyYXRpb247CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEuamRiYy5jb25mLkpEQkNDb25maWd1cmF0aW9u\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuY29uZi5KREJDQ29u\nZmlndXJhdGlvbkltcGw7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRi\nYy5rZXJuZWwuSkRCQ1NlcTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5q\nZGJjLnNjaGVtYS5Db2x1bW47CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\namRiYy5zY2hlbWEuRHluYW1pY1NjaGVtYUZhY3Rvcnk7CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hlbWEuTGF6eVNjaGVtYUZhY3Rvcnk7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hlbWEuU2NoZW1h\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1hLlNjaGVt\nYUdlbmVyYXRvcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNj\naGVtYS5TY2hlbWFHcm91cDsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5q\nZGJjLnNjaGVtYS5TY2hlbWFTZXJpYWxpemVyOwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLmpkYmMuc2NoZW1hLlNjaGVtYVRvb2w7CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hlbWEuVGFibGU7CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hlbWEuWE1MU2NoZW1hU2VyaWFsaXpl\ncjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNxbC5EQkRpY3Rp\nb25hcnk7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLlNlcTsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIuY29uZi5Db25maWd1cmF0\naW9uczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIubG9nLkxvZzsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIubWV0YS5DbGFzc0FyZ1Bh\ncnNlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIudXRpbC5GaWxl\nczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIudXRpbC5KMkRvUHJp\ndkhlbHBlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIudXRpbC5M\nb2NhbGl6ZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwu\nT3B0aW9uczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIudXRpbC5T\nZXJ2aWNlczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRhLkNsYXNz\nTWV0YURhdGE7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YS5GaWVs\nZE1ldGFEYXRhOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuSmF2\nYVR5cGVzOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuTWV0YURh\ndGFGYWN0b3J5OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuTWV0\nYURhdGFNb2RlczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRhLlF1\nZXJ5TWV0YURhdGE7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YS5T\nZXF1ZW5jZU1ldGFEYXRhOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1l\ndGEuVmFsdWVTdHJhdGVnaWVzOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLnV0aWwuR2VuZXJhbEV4Y2VwdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS51dGlsLkludGVybmFsRXhjZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLnV0aWwuTWV0YURhdGFFeGNlcHRpb247CgovKioKICogVG9v\nbCBmb3IgbWFuaXB1bGF0aW5nIGNsYXNzIG1hcHBpbmdzIGFuZCBhc3NvY2lh\ndGVkIHNjaGVtYS4KICoKICogQGF1dGhvciBBYmUgV2hpdGUKICovCnB1Ymxp\nYyBjbGFzcyBNYXBwaW5nVG9vbAogICAgaW1wbGVtZW50cyBNZXRhRGF0YU1v\nZGVzIHsKCiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIFN0cmluZyBTQ0hFTUFf\nQUNUSU9OX05PTkUgPSAibm9uZSI7CgogICAgcHVibGljIHN0YXRpYyBmaW5h\nbCBTdHJpbmcgQUNUSU9OX0FERCA9ICJhZGQiOwogICAgcHVibGljIHN0YXRp\nYyBmaW5hbCBTdHJpbmcgQUNUSU9OX1JFRlJFU0ggPSAicmVmcmVzaCI7CiAg\nICBwdWJsaWMgc3RhdGljIGZpbmFsIFN0cmluZyBBQ1RJT05fQlVJTERfU0NI\nRU1BID0gImJ1aWxkU2NoZW1hIjsKICAgIHB1YmxpYyBzdGF0aWMgZmluYWwg\nU3RyaW5nIEFDVElPTl9EUk9QID0gImRyb3AiOwogICAgcHVibGljIHN0YXRp\nYyBmaW5hbCBTdHJpbmcgQUNUSU9OX1ZBTElEQVRFID0gInZhbGlkYXRlIjsK\nICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgU3RyaW5nIEFDVElPTl9FWFBPUlQg\nPSAiZXhwb3J0IjsKICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgU3RyaW5nIEFD\nVElPTl9JTVBPUlQgPSAiaW1wb3J0IjsKCiAgICBwdWJsaWMgc3RhdGljIGZp\nbmFsIFN0cmluZ1tdIEFDVElPTlMgPSBuZXcgU3RyaW5nW117CiAgICAgICAg\nQUNUSU9OX0FERCwKICAgICAgICBBQ1RJT05fUkVGUkVTSCwKICAgICAgICBB\nQ1RJT05fQlVJTERfU0NIRU1BLAogICAgICAgIEFDVElPTl9EUk9QLAogICAg\nICAgIEFDVElPTl9WQUxJREFURSwKICAgICAgICBBQ1RJT05fRVhQT1JULAog\nICAgICAgIEFDVElPTl9JTVBPUlQsCiAgICB9OwoKICAgIHByaXZhdGUgc3Rh\ndGljIGZpbmFsIExvY2FsaXplciBfbG9jID0KICAgICAgICBMb2NhbGl6ZXIu\nZm9yUGFja2FnZShNYXBwaW5nVG9vbC5jbGFzcyk7CgogICAgcHJpdmF0ZSBm\naW5hbCBKREJDQ29uZmlndXJhdGlvbiBfY29uZjsKICAgIHByaXZhdGUgZmlu\nYWwgTG9nIF9sb2c7CiAgICBwcml2YXRlIGZpbmFsIFN0cmluZyBfYWN0aW9u\nOwogICAgcHJpdmF0ZSBmaW5hbCBib29sZWFuIF9tZXRhOwogICAgcHJpdmF0\nZSBmaW5hbCBpbnQgX21vZGU7CiAgICBwcml2YXRlIGZpbmFsIERCRGljdGlv\nbmFyeSBfZGljdDsKCiAgICBwcml2YXRlIE1hcHBpbmdSZXBvc2l0b3J5IF9y\nZXBvcyA9IG51bGw7CiAgICBwcml2YXRlIFNjaGVtYUdyb3VwIF9zY2hlbWEg\nPSBudWxsOwogICAgcHJpdmF0ZSBTY2hlbWFUb29sIF9zY2hlbWFUb29sID0g\nbnVsbDsKICAgIHByaXZhdGUgU3RyaW5nIF9zY2hlbWFBY3Rpb25zID0gU2No\nZW1hVG9vbC5BQ1RJT05fQUREOwogICAgcHJpdmF0ZSBib29sZWFuIF9yZWFk\nU2NoZW1hID0gZmFsc2U7CiAgICBwcml2YXRlIGJvb2xlYW4gX3BrcyA9IGZh\nbHNlOwogICAgcHJpdmF0ZSBib29sZWFuIF9ma3MgPSBmYWxzZTsKICAgIHBy\naXZhdGUgYm9vbGVhbiBfaW5kZXhlcyA9IGZhbHNlOwogICAgcHJpdmF0ZSBi\nb29sZWFuIF9zZXFzID0gdHJ1ZTsKICAgIHByaXZhdGUgYm9vbGVhbiBfZHJv\ncFVudXNlZCA9IHRydWU7CiAgICBwcml2YXRlIGJvb2xlYW4gX2lnbm9yZUVy\ncm9ycyA9IGZhbHNlOwogICAgcHJpdmF0ZSBGaWxlIF9maWxlID0gbnVsbDsK\nICAgIHByaXZhdGUgV3JpdGVyIF9tYXBwaW5nV3JpdGVyID0gbnVsbDsKICAg\nIHByaXZhdGUgV3JpdGVyIF9zY2hlbWFXcml0ZXIgPSBudWxsOwoKICAgIC8v\nIGJ1ZmZlciBtZXRhZGF0YXMgdG8gYmUgZHJvcHBlZAogICAgcHJpdmF0ZSBT\nZXQgX2Ryb3BDbHMgPSBudWxsOwogICAgcHJpdmF0ZSBTZXQgX2Ryb3BNYXAg\nPSBudWxsOwogICAgcHJpdmF0ZSBib29sZWFuIF9mbHVzaCA9IGZhbHNlOwog\nICAgcHJpdmF0ZSBib29sZWFuIF9mbHVzaFNjaGVtYSA9IGZhbHNlOwoKICAg\nIC8qKgogICAgICogQ29uc3RydWN0b3IuIFN1cHBseSBjb25maWd1cmF0aW9u\nIGFuZCBhY3Rpb24uCiAgICAgKi8KICAgIHB1YmxpYyBNYXBwaW5nVG9vbChK\nREJDQ29uZmlndXJhdGlvbiBjb25mLCBTdHJpbmcgYWN0aW9uLCBib29sZWFu\nIG1ldGEpIHsKICAgICAgICBfY29uZiA9IGNvbmY7CiAgICAgICAgX2xvZyA9\nIGNvbmYuZ2V0TG9nKEpEQkNDb25maWd1cmF0aW9uLkxPR19NRVRBREFUQSk7\nCiAgICAgICAgX21ldGEgPSBtZXRhOwoKICAgICAgICBpZiAoYWN0aW9uID09\nIG51bGwpCiAgICAgICAgICAgIF9hY3Rpb24gPSBBQ1RJT05fUkVGUkVTSDsK\nICAgICAgICBlbHNlIGlmICghQXJyYXlzLmFzTGlzdChBQ1RJT05TKS5jb250\nYWlucyhhY3Rpb24pKQogICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFy\nZ3VtZW50RXhjZXB0aW9uKCJhY3Rpb24gPT0gIiArIGFjdGlvbik7CiAgICAg\nICAgZWxzZQogICAgICAgICAgICBfYWN0aW9uID0gYWN0aW9uOwoKICAgICAg\nICBpZiAobWV0YSAmJiBBQ1RJT05fQURELmVxdWFscyhfYWN0aW9uKSkKICAg\nICAgICAgICAgX21vZGUgPSBNT0RFX01FVEE7CiAgICAgICAgZWxzZSBpZiAo\nbWV0YSAmJiBBQ1RJT05fRFJPUC5lcXVhbHMoX2FjdGlvbikpCiAgICAgICAg\nICAgIF9tb2RlID0gTU9ERV9NRVRBIHwgTU9ERV9NQVBQSU5HIHwgTU9ERV9R\nVUVSWTsKICAgICAgICBlbHNlCiAgICAgICAgICAgIF9tb2RlID0gTU9ERV9N\nQVBQSU5HOwoKICAgICAgICBfZGljdCA9IF9jb25mLmdldERCRGljdGlvbmFy\neUluc3RhbmNlKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBUaGUgYWN0aW9u\nIHN1cHBsaWVkIG9uIGNvbnN0cnVjdGlvbi4KICAgICAqLwogICAgcHVibGlj\nIFN0cmluZyBnZXRBY3Rpb24oKSB7CiAgICAgICAgcmV0dXJuIF9hY3Rpb247\nCiAgICB9CgogICAgLyoqCiAgICAgKiBXaGV0aGVyIHRoZSBhY3Rpb24gd29y\na3Mgb24gbWV0YWRhdGEgYXMgd2VsbCBhcyBtYXBwaW5ncy4KICAgICAqLwog\nICAgcHVibGljIGJvb2xlYW4gaXNNZXRhRGF0YUFjdGlvbigpIHsKICAgICAg\nICByZXR1cm4gX21ldGE7CiAgICB9CgogICAgLyoqCiAgICAgKiBUaGUgc2No\nZW1hIG1vZGlmaWNhdGlvbiBwb2xpY3ksIG9yIDxjb2RlPm5vbmU8L2NvZGU+\nLiBTZWUgdGhlCiAgICAgKiBBQ1RJT04gY29uc3RhbnRzIGluIHtAbGluayBT\nY2hlbWFUb29sfS4gTWF5IGJlIGEgY29tbWEtc2VwYXJhdGVkCiAgICAgKiBs\naXN0IG9mIHZhbHVlcy4gRGVmYXVsdHMgdG8ge0BsaW5rIFNjaGVtYVRvb2wj\nQUNUSU9OX0FERH0uCiAgICAgKi8KICAgIHB1YmxpYyBTdHJpbmcgZ2V0U2No\nZW1hQWN0aW9uKCkgewogICAgICAgIHJldHVybiBfc2NoZW1hQWN0aW9uczsK\nICAgIH0KCiAgICAvKioKICAgICAqIFRoZSBzY2hlbWEgbW9kaWZpY2F0aW9u\nIHBvbGljeSwgb3IgPGNvZGU+bm9uZTwvY29kZT4uIFNlZSB0aGUKICAgICAq\nIEFDVElPTiBjb25zdGFudHMgaW4ge0BsaW5rIFNjaGVtYVRvb2x9LiBNYXkg\nYmUgYSBjb21tYS1zZXBhcmF0ZWQKICAgICAqIGxpc3Qgb2YgdmFsdWVzLiBE\nZWZhdWx0cyB0byB7QGxpbmsgU2NoZW1hVG9vbCNBQ1RJT05fQUREfS4KICAg\nICAqLwogICAgcHVibGljIHZvaWQgc2V0U2NoZW1hQWN0aW9uKFN0cmluZyBz\nY2hlbWFBY3Rpb24pIHsKICAgICAgICBfc2NoZW1hQWN0aW9ucyA9IHNjaGVt\nYUFjdGlvbjsKICAgIH0KCiAgICAvKioKICAgICAqIFNldCB0byB0cnVlIHRv\nIHJlYWQgdGhlIGVudGlyZSBzY2hlbWEgYmVmb3JlIG1hcHBpbmcuCiAgICAg\nKiBMZWF2aW5nIHRoaXMgb3B0aW9uIGZhbHNlIHNhdmVzIHRpbWUsIGJ1dCBp\ncyBkYW5nZXJvdXMgd2hlbiBhZGRpbmcKICAgICAqIG5ldyBtYXBwaW5ncywg\nYmVjYXVzZSB3aXRob3V0IGZ1bGwga25vd2xlZGdlIG9mIHRoZSBleGlzdGlu\nZyBzY2hlbWEgdGhlCiAgICAgKiBtYXBwaW5nIHRvb2wgbWlnaHQgY3JlYXRl\nIHRhYmxlcyBvciBpbmRleGVzIHRoYXQgY29uZmxpY3Qgd2l0aAogICAgICog\nZXhpc3RpbmcgY29tcG9uZW50cy4KICAgICAqLwogICAgcHVibGljIGJvb2xl\nYW4gZ2V0UmVhZFNjaGVtYSgpIHsKICAgICAgICByZXR1cm4gX3JlYWRTY2hl\nbWE7CiAgICB9CgogICAgLyoqCiAgICAgKiBTZXQgdG8gdHJ1ZSB0byByZWFk\nIHRoZSBlbnRpcmUgc2NoZW1hIGJlZm9yZSBtYXBwaW5nLgogICAgICogTGVh\ndmluZyB0aGlzIG9wdGlvbiBmYWxzZSBzYXZlcyB0aW1lLCBidXQgaXMgZGFu\nZ2Vyb3VzIHdoZW4gYWRkaW5nCiAgICAgKiBuZXcgbWFwcGluZ3MsIGJlY2F1\nc2Ugd2l0aG91dCBmdWxsIGtub3dsZWRnZSBvZiB0aGUgZXhpc3Rpbmcgc2No\nZW1hIHRoZQogICAgICogbWFwcGluZyB0b29sIG1pZ2h0IGNyZWF0ZSB0YWJs\nZXMgb3IgaW5kZXhlcyB0aGF0IGNvbmZsaWN0IHdpdGgKICAgICAqIGV4aXN0\naW5nIGNvbXBvbmVudHMuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldFJl\nYWRTY2hlbWEoYm9vbGVhbiByZWFkU2NoZW1hKSB7CiAgICAgICAgX3JlYWRT\nY2hlbWEgPSByZWFkU2NoZW1hOwogICAgfQoKICAgIC8qKgogICAgICogV2hl\ndGhlciB0byBtYW5pcHVsYXRlIHNlcXVlbmNlcy4gRGVmYXVsdHMgdG8gdHJ1\nZS4KICAgICAqLwogICAgcHVibGljIGJvb2xlYW4gZ2V0U2VxdWVuY2VzKCkg\newogICAgICAgIHJldHVybiBfc2VxczsKICAgIH0KCiAgICAvKioKICAgICAq\nIFdoZXRoZXIgdG8gbWFuaXB1bGF0ZSBzZXF1ZW5jZXMuIERlZmF1bHRzIHRv\nIHRydWUuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldFNlcXVlbmNlcyhi\nb29sZWFuIHNlcXMpIHsKICAgICAgICBfc2VxcyA9IHNlcXM7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBXaGV0aGVyIGluZGV4ZXMgb24gZXhpc3RpbmcgdGFi\nbGVzIHNob3VsZCBiZSBtYW5pcHVsYXRlZC4KICAgICAqIERlZmF1bHRzIHRv\nIGZhbHNlLgogICAgICovCiAgICBwdWJsaWMgYm9vbGVhbiBnZXRJbmRleGVz\nKCkgewogICAgICAgIHJldHVybiBfaW5kZXhlczsKICAgIH0KCiAgICAvKioK\nICAgICAqIFdoZXRoZXIgaW5kZXhlcyBvbiBleGlzdGluZyB0YWJsZXMgc2hv\ndWxkIGJlIG1hbmlwdWxhdGVkLgogICAgICogRGVmYXVsdHMgdG8gZmFsc2Uu\nCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldEluZGV4ZXMoYm9vbGVhbiBp\nbmRleGVzKSB7CiAgICAgICAgX2luZGV4ZXMgPSBpbmRleGVzOwogICAgfQoK\nICAgIC8qKgogICAgICogV2hldGhlciBmb3JlaWduIGtleXMgb24gZXhpc3Rp\nbmcgdGFibGVzIHNob3VsZCBiZSBtYW5pcHVsYXRlZC4KICAgICAqIERlZmF1\nbHRzIHRvIGZhbHNlLgogICAgICovCiAgICBwdWJsaWMgYm9vbGVhbiBnZXRG\nb3JlaWduS2V5cygpIHsKICAgICAgICByZXR1cm4gX2ZrczsKICAgIH0KCiAg\nICAvKioKICAgICAqIFdoZXRoZXIgZm9yZWlnbiBrZXlzIG9uIGV4aXN0aW5n\nIHRhYmxlcyBzaG91bGQgYmUgbWFuaXB1bGF0ZWQuCiAgICAgKiBEZWZhdWx0\ncyB0byBmYWxzZS4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0Rm9yZWln\nbktleXMoYm9vbGVhbiBma3MpIHsKICAgICAgICBfZmtzID0gZmtzOwogICAg\nfQoKICAgIC8qKgogICAgICogV2hldGhlciBwcmltYXJ5IGtleXMgb24gZXhp\nc3RpbmcgdGFibGVzIHNob3VsZCBiZSBtYW5pcHVsYXRlZC4KICAgICAqIERl\nZmF1bHRzIHRvIGZhbHNlLgogICAgICovCiAgICBwdWJsaWMgYm9vbGVhbiBn\nZXRQcmltYXJ5S2V5cygpIHsKICAgICAgICByZXR1cm4gX3BrczsKICAgIH0K\nCiAgICAvKioKICAgICAqIFdoZXRoZXIgcHJpbWFyeSBrZXlzIG9uIGV4aXN0\naW5nIHRhYmxlcyBzaG91bGQgYmUgbWFuaXB1bGF0ZWQuCiAgICAgKiBEZWZh\ndWx0cyB0byBmYWxzZS4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0UHJp\nbWFyeUtleXMoYm9vbGVhbiBwa3MpIHsKICAgICAgICBfcGtzID0gcGtzOwog\nICAgfQoKICAgIC8qKgogICAgICogV2hldGhlciBzY2hlbWEgY29tcG9uZW50\ncyB0aGF0IGFyZSB1bnVzZWQgYnkgYW55IG1hcHBpbmcgd2lsbCBiZQogICAg\nICogZHJvcHBlZCBmcm9tIHRoaXMgdG9vbCdzIHtAbGluayBTY2hlbWFHcm91\ncH0sIGFuZCwgZGVwZW5kaW5nIG9uCiAgICAgKiB0aGUgc2NoZW1hIGFjdGlv\nbiwgZnJvbSB0aGUgZGF0YWJhc2UuIERlZmF1bHRzIHRvIHRydWUuCiAgICAg\nKi8KICAgIHB1YmxpYyBib29sZWFuIGdldERyb3BVbnVzZWRDb21wb25lbnRz\nKCkgewogICAgICAgIHJldHVybiBfZHJvcFVudXNlZDsKICAgIH0KCiAgICAv\nKioKICAgICAqIFdoZXRoZXIgc2NoZW1hIGNvbXBvbmVudHMgdGhhdCBhcmUg\ndW51c2VkIGJ5IGFueSBtYXBwaW5nIHdpbGwgYmUKICAgICAqIGRyb3BwZWQg\nZnJvbSB0aGlzIHRvb2wncyB7QGxpbmsgU2NoZW1hR3JvdXB9LCBhbmQsIGRl\ncGVuZGluZyBvbgogICAgICogdGhlIHNjaGVtYSBhY3Rpb24sIGZyb20gdGhl\nIGRhdGFiYXNlLiBEZWZhdWx0cyB0byB0cnVlLgogICAgICovCiAgICBwdWJs\naWMgdm9pZCBzZXREcm9wVW51c2VkQ29tcG9uZW50cyhib29sZWFuIGRyb3BV\nbnVzZWQpIHsKICAgICAgICBfZHJvcFVudXNlZCA9IGRyb3BVbnVzZWQ7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBXaGV0aGVyIGFuZCBTUUwgZXJyb3JzIHNo\nb3VsZCBjYXVzZSBhIGZhaWx1cmUgb3IganVzdCBpc3N1ZSBhIHdhcm5pbmcu\nCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldElnbm9yZUVycm9ycyhib29s\nZWFuIGlnbm9yZUVycm9ycykgewogICAgICAgIF9pZ25vcmVFcnJvcnMgPSBp\nZ25vcmVFcnJvcnM7CiAgICB9CgogICAgLyoqCiAgICAgKiBXaGV0aGVyIGFu\nZCBTUUwgZXJyb3JzIHNob3VsZCBjYXVzZSBhIGZhaWx1cmUgb3IganVzdCBp\nc3N1ZSBhIHdhcm5pbmcuCiAgICAgKi8KICAgIHB1YmxpYyBib29sZWFuIGdl\ndElnbm9yZUVycm9ycygpIHsKICAgICAgICByZXR1cm4gX2lnbm9yZUVycm9y\nczsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgc2NoZW1hIHRv\nb2wgdG8gdXNlIGZvciBzY2hlbWEgbW9kaWZpY2F0aW9uLgogICAgICovCiAg\nICBwcml2YXRlIFNjaGVtYVRvb2wgbmV3U2NoZW1hVG9vbChTdHJpbmcgYWN0\naW9uKSB7CiAgICAgICAgaWYgKFNDSEVNQV9BQ1RJT05fTk9ORS5lcXVhbHMo\nYWN0aW9uKSkKICAgICAgICAgICAgYWN0aW9uID0gbnVsbDsKICAgICAgICBT\nY2hlbWFUb29sIHRvb2wgPSBuZXcgU2NoZW1hVG9vbChfY29uZiwgYWN0aW9u\nKTsKICAgICAgICB0b29sLnNldElnbm9yZUVycm9ycyhnZXRJZ25vcmVFcnJv\ncnMoKSk7CiAgICAgICAgdG9vbC5zZXRQcmltYXJ5S2V5cyhnZXRQcmltYXJ5\nS2V5cygpKTsKICAgICAgICB0b29sLnNldEZvcmVpZ25LZXlzKGdldEZvcmVp\nZ25LZXlzKCkpOwogICAgICAgIHRvb2wuc2V0SW5kZXhlcyhnZXRJbmRleGVz\nKCkpOwogICAgICAgIHRvb2wuc2V0U2VxdWVuY2VzKGdldFNlcXVlbmNlcygp\nKTsKICAgICAgICByZXR1cm4gdG9vbDsKICAgIH0KCiAgICAvKioKICAgICAq\nIFNldCB0aGUgc2NoZW1hIHRvb2wgdG8gdXNlIGZvciBzY2hlbWEgbW9kaWZp\nY2F0aW9uLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRTY2hlbWFUb29s\nKFNjaGVtYVRvb2wgdG9vbCkgewogICAgICAgIF9zY2hlbWFUb29sID0gdG9v\nbDsKICAgIH0KCiAgICAvKioKICAgICAqIFRoZSBzdHJlYW0gdG8gZXhwb3J0\nIHRoZSBwbGFubmVkIHNjaGVtYSB0byBhcyBhbiBYTUwgZG9jdW1lbnQuCiAg\nICAgKiBJZiBub24tbnVsbCwgdGhlbiB0aGUgZGF0YWJhc2Ugc2NoZW1hIHdp\nbGwgbm90IGJlIGFsdGVyZWQuCiAgICAgKi8KICAgIHB1YmxpYyBXcml0ZXIg\nZ2V0U2NoZW1hV3JpdGVyKCkgewogICAgICAgIHJldHVybiBfc2NoZW1hV3Jp\ndGVyOwogICAgfQoKICAgIC8qKgogICAgICogVGhlIHN0cmVhbSB0byBleHBv\ncnQgdGhlIHBsYW5uZWQgc2NoZW1hIHRvIGFzIGFuIFhNTCBkb2N1bWVudC4K\nICAgICAqIElmIG5vbi1udWxsLCB0aGVuIHRoZSBkYXRhYmFzZSBzY2hlbWEg\nd2lsbCBub3QgYmUgYWx0ZXJlZC4KICAgICAqLwogICAgcHVibGljIHZvaWQg\nc2V0U2NoZW1hV3JpdGVyKFdyaXRlciBzY2hlbWFXcml0ZXIpIHsKICAgICAg\nICBfc2NoZW1hV3JpdGVyID0gc2NoZW1hV3JpdGVyOwogICAgfQoKICAgIC8q\nKgogICAgICogVGhlIHN0cmVhbSB0byBleHBvcnQgdGhlIHBsYW5uZWQgbWFw\ncGluZ3MgdG8gYXMgYW4gWE1MIGRvY3VtZW50LgogICAgICogSWYgbm9uLW51\nbGwsIHRoZW4gdGhlIG1hcHBpbmcgcmVwb3NpdG9yeSB3aWxsIG5vdCBiZSBh\nbHRlcmVkLgogICAgICovCiAgICBwdWJsaWMgV3JpdGVyIGdldE1hcHBpbmdX\ncml0ZXIoKSB7CiAgICAgICAgcmV0dXJuIF9tYXBwaW5nV3JpdGVyOwogICAg\nfQoKICAgIC8qKgogICAgICogVGhlIHN0cmVhbSB0byBleHBvcnQgdGhlIHBs\nYW5uZWQgbWFwcGluZ3MgdG8gYXMgYW4gWE1MIGRvY3VtZW50LgogICAgICog\nSWYgbm9uLW51bGwsIHRoZW4gdGhlIG1hcHBpbmcgcmVwb3NpdG9yeSB3aWxs\nIG5vdCBiZSBhbHRlcmVkLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRN\nYXBwaW5nV3JpdGVyKFdyaXRlciBtYXBwaW5nV3JpdGVyKSB7CiAgICAgICAg\nX21hcHBpbmdXcml0ZXIgPSBtYXBwaW5nV3JpdGVyOwogICAgfQoKICAgIC8q\nKgogICAgICogSWYgYWRkaW5nIG1ldGFkYXRhLCB0aGUgbWV0YWRhdGEgZmls\nZSB0byBhZGQgdG8uCiAgICAgKi8KICAgIHB1YmxpYyBGaWxlIGdldE1ldGFE\nYXRhRmlsZSgpIHsKICAgICAgICByZXR1cm4gX2ZpbGU7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBJZiBhZGRpbmcgbWV0YWRhdGEsIHRoZSBtZXRhZGF0YSBm\naWxlIHRvIGFkZCB0by4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0TWV0\nYURhdGFGaWxlKEZpbGUgZmlsZSkgewogICAgICAgIF9maWxlID0gZmlsZTsK\nICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgcmVwb3NpdG9yeSB0\nbyB1c2UgdG8gYWNjZXNzIG1hcHBpbmcgaW5mb3JtYXRpb24uCiAgICAgKiBE\nZWZhdWx0cyB0byBhIG5ldyB7QGxpbmsgTWFwcGluZ1JlcG9zaXRvcnl9Lgog\nICAgICovCiAgICBwdWJsaWMgTWFwcGluZ1JlcG9zaXRvcnkgZ2V0UmVwb3Np\ndG9yeSgpIHsKICAgICAgICBpZiAoX3JlcG9zID09IG51bGwpIHsKICAgICAg\nICAgICAgX3JlcG9zID0gX2NvbmYubmV3TWFwcGluZ1JlcG9zaXRvcnlJbnN0\nYW5jZSgpOwogICAgICAgICAgICBfcmVwb3Muc2V0U2NoZW1hR3JvdXAoZ2V0\nU2NoZW1hR3JvdXAoKSk7CiAgICAgICAgICAgIF9yZXBvcy5zZXRWYWxpZGF0\nZShfcmVwb3MuVkFMSURBVEVfVU5FTkhBTkNFRCwgZmFsc2UpOwogICAgICAg\nIH0KICAgICAgICByZXR1cm4gX3JlcG9zOwogICAgfQoKICAgIC8qKgogICAg\nICogU2V0IHRoZSByZXBvc2l0b3J5IHRvIHVzZSB0byBhY2Nlc3MgbWFwcGlu\nZyBpbmZvcm1hdGlvbi4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0UmVw\nb3NpdG9yeShNYXBwaW5nUmVwb3NpdG9yeSByZXBvcykgewogICAgICAgIF9y\nZXBvcyA9IHJlcG9zOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRo\nZSBzY2hlbWEgZ3JvdXAgdG8gdXNlIGluIG1hcHBpbmcuIElmIG5vbmUgaGFz\nIGJlZW4gc2V0LCB0aGUKICAgICAqIHNjaGVtYSB3aWxsIGJlIGdlbmVyYXRl\nZCBmcm9tIHRoZSBkYXRhYmFzZS4KICAgICAqLwogICAgcHVibGljIFNjaGVt\nYUdyb3VwIGdldFNjaGVtYUdyb3VwKCkgewogICAgICAgIGlmIChfc2NoZW1h\nID09IG51bGwpIHsKICAgICAgICAgICAgaWYgKF9hY3Rpb24uaW5kZXhPZihB\nQ1RJT05fQlVJTERfU0NIRU1BKSAhPSAtMSkgewogICAgICAgICAgICAgICAg\nRHluYW1pY1NjaGVtYUZhY3RvcnkgZmFjdG9yeSA9IG5ldyBEeW5hbWljU2No\nZW1hRmFjdG9yeSgpOwogICAgICAgICAgICAgICAgZmFjdG9yeS5zZXRDb25m\naWd1cmF0aW9uKF9jb25mKTsKICAgICAgICAgICAgICAgIF9zY2hlbWEgPSBm\nYWN0b3J5OwogICAgICAgICAgICB9IGVsc2UgaWYgKF9yZWFkU2NoZW1hIAog\nICAgICAgICAgICAgICAgfHwgY29udGFpbnMoX3NjaGVtYUFjdGlvbnMsU2No\nZW1hVG9vbC5BQ1RJT05fUkVUQUlOKQogICAgICAgICAgICAgICAgfHwgY29u\ndGFpbnMoX3NjaGVtYUFjdGlvbnMsU2NoZW1hVG9vbC5BQ1RJT05fUkVGUkVT\nSCkpIHsKICAgICAgICAgICAgICAgIF9zY2hlbWEgPSAoU2NoZW1hR3JvdXAp\nIG5ld1NjaGVtYVRvb2wobnVsbCkuZ2V0REJTY2hlbWFHcm91cCgpLgogICAg\nICAgICAgICAgICAgICAgIGNsb25lKCk7CiAgICAgICAgICAgIH0gZWxzZSB7\nCiAgICAgICAgICAgICAgICAvLyB3aXRoIHRoaXMgd2UnbGwganVzdCByZWFk\nIHRhYmxlcyBhcyBkaWZmZXJlbnQgbWFwcGluZ3MKICAgICAgICAgICAgICAg\nIC8vIGxvb2sgZm9yIHRoZW0KICAgICAgICAgICAgICAgIExhenlTY2hlbWFG\nYWN0b3J5IGZhY3RvcnkgPSBuZXcgTGF6eVNjaGVtYUZhY3RvcnkoKTsKICAg\nICAgICAgICAgICAgIGZhY3Rvcnkuc2V0Q29uZmlndXJhdGlvbihfY29uZik7\nCiAgICAgICAgICAgICAgICBmYWN0b3J5LnNldFByaW1hcnlLZXlzKGdldFBy\naW1hcnlLZXlzKCkpOwogICAgICAgICAgICAgICAgZmFjdG9yeS5zZXRGb3Jl\naWduS2V5cyhnZXRGb3JlaWduS2V5cygpKTsKICAgICAgICAgICAgICAgIGZh\nY3Rvcnkuc2V0SW5kZXhlcyhnZXRJbmRleGVzKCkpOwogICAgICAgICAgICAg\nICAgX3NjaGVtYSA9IGZhY3Rvcnk7CiAgICAgICAgICAgIH0KCiAgICAgICAg\nICAgIGlmIChfc2NoZW1hLmdldFNjaGVtYXMoKS5sZW5ndGggPT0gMCkKICAg\nICAgICAgICAgICAgIF9zY2hlbWEuYWRkU2NoZW1hKCk7CiAgICAgICAgfQog\nICAgICAgIHJldHVybiBfc2NoZW1hOwogICAgfQoKICAgIC8qKgogICAgICog\nU2V0IHRoZSBzY2hlbWEgdG8gdXNlIGluIG1hcHBpbmcuCiAgICAgKi8KICAg\nIHB1YmxpYyB2b2lkIHNldFNjaGVtYUdyb3VwKFNjaGVtYUdyb3VwIHNjaGVt\nYSkgewogICAgICAgIF9zY2hlbWEgPSBzY2hlbWE7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBSZXNldCB0aGUgaW50ZXJuYWwgcmVwb3NpdG9yeS4gVGhpcyBp\ncyBjYWxsZWQgYXV0b21hdGljYWxseSBhZnRlcgogICAgICogZXZlcnkge0Bs\naW5rICNyZWNvcmR9LgogICAgICovCiAgICBwdWJsaWMgdm9pZCBjbGVhcigp\nIHsKICAgICAgICBfcmVwb3MgPSBudWxsOwogICAgICAgIF9zY2hlbWEgPSBu\ndWxsOwogICAgICAgIF9zY2hlbWFUb29sID0gbnVsbDsKICAgICAgICBfZmx1\nc2ggPSBmYWxzZTsKICAgICAgICBfZmx1c2hTY2hlbWEgPSBmYWxzZTsKICAg\nICAgICBpZiAoX2Ryb3BDbHMgIT0gbnVsbCkKICAgICAgICAgICAgX2Ryb3BD\nbHMuY2xlYXIoKTsKICAgICAgICBpZiAoX2Ryb3BNYXAgIT0gbnVsbCkKICAg\nICAgICAgICAgX2Ryb3BNYXAuY2xlYXIoKTsKICAgIH0KCiAgICAvKioKICAg\nICAqIFJlY29yZHMgdGhlIGNoYW5nZXMgdGhhdCBoYXZlIGJlZW4gbWFkZSB0\nbyBib3RoIHRoZSBtYXBwaW5ncyBhbmQgdGhlCiAgICAgKiBhc3NvY2lhdGVk\nIHNjaGVtYSwgYW5kIGNsZWFycyB0aGUgdG9vbCBmb3IgZnVydGhlciB1c2Uu\nIFRoaXMgYWxzbwogICAgICogaW52b2x2ZXMgY2xlYXJpbmcgdGhlIGludGVy\nbmFsIG1hcHBpbmcgcmVwb3NpdG9yeS4KICAgICAqLwogICAgcHVibGljIHZv\naWQgcmVjb3JkKCkgewogICAgICAgIHJlY29yZChudWxsKTsKICAgIH0KICAg\nIAogICAgcHJpdmF0ZSB2b2lkIHJlY29yZChNYXBwaW5nVG9vbC5GbGFncyBm\nbGFncykgewogICAgICAgIE1hcHBpbmdSZXBvc2l0b3J5IHJlcG9zID0gZ2V0\nUmVwb3NpdG9yeSgpOwogICAgICAgIE1ldGFEYXRhRmFjdG9yeSBpbyA9IHJl\ncG9zLmdldE1ldGFEYXRhRmFjdG9yeSgpOwogICAgICAgIENsYXNzTWFwcGlu\nZ1tdIG1hcHBpbmdzOwogICAgICAgIGlmICghQUNUSU9OX0RST1AuZXF1YWxz\nKF9hY3Rpb24pKQogICAgICAgICAgICBtYXBwaW5ncyA9IHJlcG9zLmdldE1h\ncHBpbmdzKCk7CiAgICAgICAgZWxzZSBpZiAoX2Ryb3BNYXAgIT0gbnVsbCkK\nICAgICAgICAgICAgbWFwcGluZ3MgPSAoQ2xhc3NNYXBwaW5nW10pIF9kcm9w\nTWFwLnRvQXJyYXkKICAgICAgICAgICAgICAgIChuZXcgQ2xhc3NNYXBwaW5n\nW19kcm9wTWFwLnNpemUoKV0pOwogICAgICAgIGVsc2UKICAgICAgICAgICAg\nbWFwcGluZ3MgPSBuZXcgQ2xhc3NNYXBwaW5nWzBdOwoKICAgICAgICB0cnkg\newogICAgICAgICAgICBpZiAoX2Ryb3BDbHMgIT0gbnVsbCAmJiAhX2Ryb3BD\nbHMuaXNFbXB0eSgpKSB7CiAgICAgICAgICAgICAgICBDbGFzc1tdIGNscyA9\nIChDbGFzc1tdKSBfZHJvcENscy50b0FycmF5CiAgICAgICAgICAgICAgICAg\nICAgKG5ldyBDbGFzc1tfZHJvcENscy5zaXplKCldKTsKICAgICAgICAgICAg\nICAgIGlmICghaW8uZHJvcChjbHMsIF9tb2RlLCBudWxsKSkKICAgICAgICAg\nICAgICAgICAgICBfbG9nLndhcm4oX2xvYy5nZXQoImJhZC1kcm9wIiwgX2Ry\nb3BDbHMpKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKF9mbHVz\naFNjaGVtYSkgewogICAgICAgICAgICAgICAgLy8gZHJvcCBwb3J0aW9ucyBv\nZiB0aGUga25vd24gc2NoZW1hIHRoYXQgbm8gbWFwcGluZyB1c2VzLCBhbmQK\nICAgICAgICAgICAgICAgIC8vIGFkZCBzZXF1ZW5jZXMgdXNlZCBmb3IgdmFs\ndWUgZ2VuZXJhdGlvbgogICAgICAgICAgICAgICAgaWYgKF9kcm9wVW51c2Vk\nKQogICAgICAgICAgICAgICAgICAgIGRyb3BVbnVzZWRTY2hlbWFDb21wb25l\nbnRzKG1hcHBpbmdzKTsKICAgICAgICAgICAgICAgIGFkZFNlcXVlbmNlQ29t\ncG9uZW50cyhtYXBwaW5ncyk7CgogICAgICAgICAgICAgICAgLy8gbm93IHJ1\nbiB0aGUgc2NoZW1hdG9vbCBhcyBsb25nIGFzIHdlJ3JlIGRvaW5nIHNvbWUg\nc2NoZW1hCiAgICAgICAgICAgICAgICAvLyBhY3Rpb24gYW5kIHRoZSB1c2Vy\nIGRvZXNuJ3QganVzdCB3YW50IGFuIHhtbCBvdXRwdXQKICAgICAgICAgICAg\nICAgIFN0cmluZ1tdIHNjaGVtYUFjdGlvbnMgPSBfc2NoZW1hQWN0aW9ucy5z\ncGxpdCgiLCIpOwogICAgICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkg\nPCBzY2hlbWFBY3Rpb25zLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAg\nICAgICAgaWYgKCFTQ0hFTUFfQUNUSU9OX05PTkUuZXF1YWxzKHNjaGVtYUFj\ndGlvbnNbaV0pCiAgICAgICAgICAgICAgICAgICAgICAgICYmIChfc2NoZW1h\nV3JpdGVyID09IG51bGwgfHwgKF9zY2hlbWFUb29sICE9IG51bGwKICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICYmIF9zY2hlbWFUb29sLmdldFdyaXRl\ncigpICE9IG51bGwpKSkgewogICAgICAgICAgICAgICAgICAgICAgICBTY2hl\nbWFUb29sIHRvb2wgPSBuZXdTY2hlbWFUb29sKHNjaGVtYUFjdGlvbnNbaV0p\nOwoKICAgICAgICAgICAgICAgICAgICAgICAgLy8gY29uZmlndXJlIHRoZSB0\nb29sIHdpdGggYWRkaXRpb25hbCBzZXR0aW5ncwogICAgICAgICAgICAgICAg\nICAgICAgICBpZiAoZmxhZ3MgIT0gbnVsbCkgewogICAgICAgICAgICAgICAg\nICAgICAgICAgICAgdG9vbC5zZXREcm9wVGFibGVzKGZsYWdzLmRyb3BUYWJs\nZXMpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9vbC5zZXREcm9w\nU2VxdWVuY2VzKGZsYWdzLmRyb3BTZXF1ZW5jZXMpOwogICAgICAgICAgICAg\nICAgICAgICAgICAgICAgdG9vbC5zZXRXcml0ZXIoZmxhZ3Muc3FsV3JpdGVy\nKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvb2wuc2V0T3BlbkpQ\nQVRhYmxlcyhmbGFncy5vcGVuanBhVGFibGVzKTsKICAgICAgICAgICAgICAg\nICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgdG9vbC5zZXRT\nY2hlbWFHcm91cChnZXRTY2hlbWFHcm91cCgpKTsKICAgICAgICAgICAgICAg\nICAgICAgICAgdG9vbC5ydW4oKTsKICAgICAgICAgICAgICAgICAgICAgICAg\ndG9vbC5yZWNvcmQoKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAg\nICAgICAgICB9CgogICAgICAgICAgICAgICAgLy8geG1sIG91dHB1dCBvZiBz\nY2hlbWE/CiAgICAgICAgICAgICAgICBpZiAoX3NjaGVtYVdyaXRlciAhPSBu\ndWxsKSB7CiAgICAgICAgICAgICAgICAgICAgLy8gc2VyaWFsaXplIHRoZSBw\nbGFubmVkIHNjaGVtYSB0byB0aGUgc3RyZWFtCiAgICAgICAgICAgICAgICAg\nICAgU2NoZW1hU2VyaWFsaXplciBzZXIgPSBuZXcgWE1MU2NoZW1hU2VyaWFs\naXplcihfY29uZik7CiAgICAgICAgICAgICAgICAgICAgc2VyLmFkZEFsbChn\nZXRTY2hlbWFHcm91cCgpKTsKICAgICAgICAgICAgICAgICAgICBzZXIuc2Vy\naWFsaXplKF9zY2hlbWFXcml0ZXIsIHNlci5QUkVUVFkpOwogICAgICAgICAg\nICAgICAgICAgIF9zY2hlbWFXcml0ZXIuZmx1c2goKTsKICAgICAgICAgICAg\nICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoIV9mbHVzaCkK\nICAgICAgICAgICAgICAgIHJldHVybjsKCiAgICAgICAgICAgIFF1ZXJ5TWV0\nYURhdGFbXSBxdWVyaWVzID0gcmVwb3MuZ2V0UXVlcnlNZXRhRGF0YXMoKTsK\nICAgICAgICAgICAgU2VxdWVuY2VNZXRhRGF0YVtdIHNlcXMgPSByZXBvcy5n\nZXRTZXF1ZW5jZU1ldGFEYXRhcygpOwogICAgICAgICAgICBNYXAgb3V0cHV0\nID0gbnVsbDsKCiAgICAgICAgICAgIC8vIGlmIHdlJ3JlIG91dHB1dHRpbmcg\ndG8gc3RyZWFtLCBzZXQgYWxsIG1ldGFzIHRvIHNhbWUgZmlsZSBzbwogICAg\nICAgICAgICAvLyB0aGV5IGdldCBwbGFjZWQgaW4gc2luZ2xlIHN0cmluZwog\nICAgICAgICAgICBpZiAoX21hcHBpbmdXcml0ZXIgIT0gbnVsbCkgewogICAg\nICAgICAgICAgICAgb3V0cHV0ID0gbmV3IEhhc2hNYXAoKTsKICAgICAgICAg\nICAgICAgIEZpbGUgdG1wID0gbmV3IEZpbGUoIm9wZW5qcGF0bXAiKTsKICAg\nICAgICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgbWFwcGluZ3MubGVu\nZ3RoOyBpKyspCiAgICAgICAgICAgICAgICAgICAgbWFwcGluZ3NbaV0uc2V0\nU291cmNlKHRtcCwgbWFwcGluZ3NbaV0uU1JDX09USEVSKTsKICAgICAgICAg\nICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgcXVlcmllcy5sZW5ndGg7IGkr\nKykKICAgICAgICAgICAgICAgICAgICBxdWVyaWVzW2ldLnNldFNvdXJjZSh0\nbXAsIHF1ZXJpZXNbaV0uZ2V0U291cmNlU2NvcGUoKSwKICAgICAgICAgICAg\nICAgICAgICAgICAgcXVlcmllc1tpXS5TUkNfT1RIRVIpOwogICAgICAgICAg\nICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBzZXFzLmxlbmd0aDsgaSsrKQog\nICAgICAgICAgICAgICAgICAgIHNlcXNbaV0uc2V0U291cmNlKHRtcCwgc2Vx\nc1tpXS5nZXRTb3VyY2VTY29wZSgpLAogICAgICAgICAgICAgICAgICAgICAg\nICBzZXFzW2ldLlNSQ19PVEhFUik7CiAgICAgICAgICAgIH0KCiAgICAgICAg\nICAgIC8vIHN0b3JlCiAgICAgICAgICAgIGlmICghaW8uc3RvcmUobWFwcGlu\nZ3MsIHF1ZXJpZXMsIHNlcXMsIF9tb2RlLCBvdXRwdXQpKQogICAgICAgICAg\nICAgICAgdGhyb3cgbmV3IE1ldGFEYXRhRXhjZXB0aW9uKF9sb2MuZ2V0KCJi\nYWQtc3RvcmUiKSk7CgogICAgICAgICAgICAvLyB3cml0ZSB0byBzdHJlYW0K\nICAgICAgICAgICAgaWYgKF9tYXBwaW5nV3JpdGVyICE9IG51bGwpIHsKICAg\nICAgICAgICAgICAgIFByaW50V3JpdGVyIG91dCA9IG5ldyBQcmludFdyaXRl\ncihfbWFwcGluZ1dyaXRlcik7CiAgICAgICAgICAgICAgICBmb3IgKEl0ZXJh\ndG9yIGl0ciA9IG91dHB1dC52YWx1ZXMoKS5pdGVyYXRvcigpOwogICAgICAg\nICAgICAgICAgICAgIGl0ci5oYXNOZXh0KCk7KQogICAgICAgICAgICAgICAg\nICAgIG91dC5wcmludGxuKChTdHJpbmcpIGl0ci5uZXh0KCkpOwogICAgICAg\nICAgICAgICAgb3V0LmZsdXNoKCk7CiAgICAgICAgICAgIH0KICAgICAgICB9\nCiAgICAgICAgY2F0Y2ggKFJ1bnRpbWVFeGNlcHRpb24gcmUpIHsKICAgICAg\nICAgICAgdGhyb3cgcmU7CiAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUp\nIHsKICAgICAgICAgICAgdGhyb3cgbmV3IEdlbmVyYWxFeGNlcHRpb24oZSk7\nCiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgY2xlYXIoKTsKICAg\nICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBEcm9wcyBzY2hlbWEgY29t\ncG9uZW50cyB0aGF0IGFwcGVhciB0byBiZSB1bnVzZWQgZnJvbSB0aGUgbG9j\nYWwKICAgICAqIGNvcHkgb2YgdGhlIHNjaGVtYSBncm91cC4KICAgICAqLwog\nICAgcHJpdmF0ZSB2b2lkIGRyb3BVbnVzZWRTY2hlbWFDb21wb25lbnRzKENs\nYXNzTWFwcGluZ1tdIG1hcHBpbmdzKSB7CiAgICAgICAgRmllbGRNYXBwaW5n\nW10gZmllbGRzOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgbWFwcGlu\nZ3MubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgbWFwcGluZ3NbaV0ucmVm\nU2NoZW1hQ29tcG9uZW50cygpOwogICAgICAgICAgICBtYXBwaW5nc1tpXS5n\nZXREaXNjcmltaW5hdG9yKCkucmVmU2NoZW1hQ29tcG9uZW50cygpOwogICAg\nICAgICAgICBtYXBwaW5nc1tpXS5nZXRWZXJzaW9uKCkucmVmU2NoZW1hQ29t\ncG9uZW50cygpOwogICAgICAgICAgICBmaWVsZHMgPSBtYXBwaW5nc1tpXS5n\nZXREZWZpbmVkRmllbGRNYXBwaW5ncygpOwogICAgICAgICAgICBmb3IgKGlu\ndCBqID0gMDsgaiA8IGZpZWxkcy5sZW5ndGg7IGorKykKICAgICAgICAgICAg\nICAgIGZpZWxkc1tqXS5yZWZTY2hlbWFDb21wb25lbnRzKCk7CiAgICAgICAg\nfQoKICAgICAgICAvLyBhbHNvIGFsbG93IHRoZSBkYmRpY3Rpb25hcnkgdG8g\ncmVmIGFueSBzY2hlbWEgY29tcG9uZW50cyB0aGF0CiAgICAgICAgLy8gaXQg\nYWRkcyBhcGFydCBmcm9tIG1hcHBpbmdzCiAgICAgICAgU2NoZW1hR3JvdXAg\nZ3JvdXAgPSBnZXRTY2hlbWFHcm91cCgpOwogICAgICAgIFNjaGVtYVtdIHNj\naGVtYXMgPSBncm91cC5nZXRTY2hlbWFzKCk7CiAgICAgICAgVGFibGVbXSB0\nYWJsZXM7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBzY2hlbWFzLmxl\nbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIHRhYmxlcyA9IHNjaGVtYXNbaV0u\nZ2V0VGFibGVzKCk7CiAgICAgICAgICAgIGZvciAoaW50IGogPSAwOyBqIDwg\ndGFibGVzLmxlbmd0aDsgaisrKQogICAgICAgICAgICAgICAgX2RpY3QucmVm\nU2NoZW1hQ29tcG9uZW50cyh0YWJsZXNbal0pOwogICAgICAgIH0KCiAgICAg\nICAgZ3JvdXAucmVtb3ZlVW51c2VkQ29tcG9uZW50cygpOwogICAgfQoKICAg\nIC8qKgogICAgICogQWRkIHRhYmxlcyB1c2VkIGJ5IHNlcXVlbmNlcyB0byB0\naGUgZ2l2ZW4gc2NoZW1hLgogICAgICovCiAgICBwcml2YXRlIHZvaWQgYWRk\nU2VxdWVuY2VDb21wb25lbnRzKENsYXNzTWFwcGluZ1tdIG1hcHBpbmdzKSB7\nCiAgICAgICAgU2NoZW1hR3JvdXAgZ3JvdXAgPSBnZXRTY2hlbWFHcm91cCgp\nOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgbWFwcGluZ3MubGVuZ3Ro\nOyBpKyspCiAgICAgICAgICAgIGFkZFNlcXVlbmNlQ29tcG9uZW50cyhtYXBw\naW5nc1tpXSwgZ3JvdXApOwogICAgfQoKICAgIC8qKgogICAgICogQWRkIHRh\nYmxlcyB1c2VkIGJ5IHNlcXVlbmNlcyB0byB0aGUgZ2l2ZW4gc2NoZW1hLgog\nICAgICovCiAgICBwcml2YXRlIHZvaWQgYWRkU2VxdWVuY2VDb21wb25lbnRz\nKENsYXNzTWFwcGluZyBtYXBwaW5nLAogICAgICAgIFNjaGVtYUdyb3VwIGdy\nb3VwKSB7CiAgICAgICAgU2VxdWVuY2VNZXRhRGF0YSBzbWQgPSBtYXBwaW5n\nLmdldElkZW50aXR5U2VxdWVuY2VNZXRhRGF0YSgpOwogICAgICAgIFNlcSBz\nZXEgPSBudWxsOwogICAgICAgIGlmIChzbWQgIT0gbnVsbCkKICAgICAgICAg\nICAgc2VxID0gc21kLmdldEluc3RhbmNlKG51bGwpOwogICAgICAgIGVsc2Ug\naWYgKG1hcHBpbmcuZ2V0SWRlbnRpdHlTdHJhdGVneSgpID09IFZhbHVlU3Ry\nYXRlZ2llcy5OQVRJVkUKICAgICAgICAgICAgfHwgKG1hcHBpbmcuZ2V0SWRl\nbnRpdHlTdHJhdGVneSgpID09IFZhbHVlU3RyYXRlZ2llcy5OT05FCiAgICAg\nICAgICAgICYmIG1hcHBpbmcuZ2V0SWRlbnRpdHlUeXBlKCkgPT0gQ2xhc3NN\nYXBwaW5nLklEX0RBVEFTVE9SRSkpCiAgICAgICAgICAgIHNlcSA9IF9jb25m\nLmdldFNlcXVlbmNlSW5zdGFuY2UoKTsKCiAgICAgICAgaWYgKHNlcSBpbnN0\nYW5jZW9mIEpEQkNTZXEpCiAgICAgICAgICAgICgoSkRCQ1NlcSkgc2VxKS5h\nZGRTY2hlbWEobWFwcGluZywgZ3JvdXApOwoKICAgICAgICBGaWVsZE1hcHBp\nbmdbXSBmbWRzOwogICAgICAgIGlmIChtYXBwaW5nLmdldEVtYmVkZGluZ01l\ndGFEYXRhKCkgPT0gbnVsbCkKICAgICAgICAgICAgZm1kcyA9IG1hcHBpbmcu\nZ2V0RGVmaW5lZEZpZWxkTWFwcGluZ3MoKTsKICAgICAgICBlbHNlCiAgICAg\nICAgICAgIGZtZHMgPSBtYXBwaW5nLmdldEZpZWxkTWFwcGluZ3MoKTsKICAg\nICAgICBmb3IgKGludCBpID0gMDsgaSA8IGZtZHMubGVuZ3RoOyBpKyspIHsK\nICAgICAgICAgICAgc21kID0gZm1kc1tpXS5nZXRWYWx1ZVNlcXVlbmNlTWV0\nYURhdGEoKTsKICAgICAgICAgICAgaWYgKHNtZCAhPSBudWxsKSB7CiAgICAg\nICAgICAgICAgICBzZXEgPSBzbWQuZ2V0SW5zdGFuY2UobnVsbCk7CiAgICAg\nICAgICAgICAgICBpZiAoc2VxIGluc3RhbmNlb2YgSkRCQ1NlcSkKICAgICAg\nICAgICAgICAgICAgICAoKEpEQkNTZXEpIHNlcSkuYWRkU2NoZW1hKG1hcHBp\nbmcsIGdyb3VwKTsKICAgICAgICAgICAgfSBlbHNlIGlmIChmbWRzW2ldLmdl\ndEVtYmVkZGVkTWFwcGluZygpICE9IG51bGwpCiAgICAgICAgICAgICAgICBh\nZGRTZXF1ZW5jZUNvbXBvbmVudHMoZm1kc1tpXS5nZXRFbWJlZGRlZE1hcHBp\nbmcoKSwgZ3JvdXApOwogICAgICAgIH0KICAgIH0KCiAgICAvLy8vLy8vLy8v\nLwogICAgLy8gQWN0aW9ucwogICAgLy8vLy8vLy8vLy8KCiAgICAvKioKICAg\nICAqIFJ1biB0aGUgY29uZmlndXJlZCBhY3Rpb24gb24gdGhlIGdpdmVuIGlu\nc3RhbmNlLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBydW4oQ2xhc3MgY2xz\nKSB7CiAgICAgICAgaWYgKEFDVElPTl9BREQuZXF1YWxzKF9hY3Rpb24pKSB7\nCiAgICAgICAgICAgIGlmIChfbWV0YSkKICAgICAgICAgICAgICAgIGFkZE1l\ndGEoY2xzKTsKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgYWRk\nKGNscyk7CiAgICAgICAgfSBlbHNlIGlmIChBQ1RJT05fUkVGUkVTSC5lcXVh\nbHMoX2FjdGlvbikpCiAgICAgICAgICAgIHJlZnJlc2goY2xzKTsKICAgICAg\nICBlbHNlIGlmIChBQ1RJT05fQlVJTERfU0NIRU1BLmVxdWFscyhfYWN0aW9u\nKSkKICAgICAgICAgICAgYnVpbGRTY2hlbWEoY2xzKTsKICAgICAgICBlbHNl\nIGlmIChBQ1RJT05fRFJPUC5lcXVhbHMoX2FjdGlvbikpCiAgICAgICAgICAg\nIGRyb3AoY2xzKTsKICAgICAgICBlbHNlIGlmIChBQ1RJT05fVkFMSURBVEUu\nZXF1YWxzKF9hY3Rpb24pKQogICAgICAgICAgICB2YWxpZGF0ZShjbHMpOwog\nICAgfQoKICAgIC8qKgogICAgICogQWRkIHRoZSBtYXBwaW5nIGZvciB0aGUg\nZ2l2ZW4gaW5zdGFuY2UuCiAgICAgKi8KICAgIHByaXZhdGUgdm9pZCBhZGQo\nQ2xhc3MgY2xzKSB7CiAgICAgICAgaWYgKGNscyA9PSBudWxsKQogICAgICAg\nICAgICByZXR1cm47CgogICAgICAgIE1hcHBpbmdSZXBvc2l0b3J5IHJlcG9z\nID0gZ2V0UmVwb3NpdG9yeSgpOwogICAgICAgIHJlcG9zLnNldFN0cmF0ZWd5\nSW5zdGFsbGVyKG5ldyBNYXBwaW5nU3RyYXRlZ3lJbnN0YWxsZXIocmVwb3Mp\nKTsKICAgICAgICBpZiAoZ2V0TWFwcGluZyhyZXBvcywgY2xzLCB0cnVlKSAh\nPSBudWxsKSB7CiAgICAgICAgICAgIF9mbHVzaCA9IHRydWU7CiAgICAgICAg\nICAgIF9mbHVzaFNjaGVtYSA9IHRydWU7CiAgICAgICAgfQogICAgfQoKICAg\nIC8qKgogICAgICogUmV0dXJuIHRoZSBtYXBwaW5nIGZvciB0aGUgZ2l2ZW4g\ndHlwZSwgb3IgbnVsbCBpZiB0aGUgdHlwZSBpcwogICAgICogcGVyc2lzdGVu\nY2UtYXdhcmUuCiAgICAgKi8KICAgIHByaXZhdGUgc3RhdGljIENsYXNzTWFw\ncGluZyBnZXRNYXBwaW5nKE1hcHBpbmdSZXBvc2l0b3J5IHJlcG9zLCBDbGFz\ncyBjbHMsCiAgICAgICAgYm9vbGVhbiB2YWxpZGF0ZSkgewogICAgICAgIC8v\nIHRoaXMgd2lsbCBwYXJzZSBhbGwgcG9zc2libGUgbWV0YWRhdGEgcnNyY3Mg\nbG9va2luZyBmb3IgY2xzLCBzbwogICAgICAgIC8vIHdpbGwgZGV0ZWN0IGlm\nIHAtYXdhcmUKICAgICAgICBDbGFzc01hcHBpbmcgbWFwcGluZyA9IHJlcG9z\nLmdldE1hcHBpbmcoY2xzLCBudWxsLCBmYWxzZSk7CiAgICAgICAgaWYgKG1h\ncHBpbmcgIT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIG1hcHBpbmc7CiAg\nICAgICAgaWYgKCF2YWxpZGF0ZSB8fCBjbHMuaXNJbnRlcmZhY2UoKSAKICAg\nICAgICAgICAgfHwgcmVwb3MuZ2V0UGVyc2lzdGVuY2VBd2FyZShjbHMpICE9\nIG51bGwpCiAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgIHRocm93\nIG5ldyBNZXRhRGF0YUV4Y2VwdGlvbihfbG9jLmdldCgibm8tbWV0YSIsIGNs\ncykpOwogICAgfQoKICAgIC8qKgogICAgICogQ3JlYXRlIGEgbWV0YWRhdGEg\nZm9yIHRoZSBnaXZlbiBpbnN0YW5jZS4KICAgICAqLwogICAgcHJpdmF0ZSB2\nb2lkIGFkZE1ldGEoQ2xhc3MgY2xzKSB7CiAgICAgICAgaWYgKGNscyA9PSBu\ndWxsKQogICAgICAgICAgICByZXR1cm47CgogICAgICAgIF9mbHVzaCA9IHRy\ndWU7CiAgICAgICAgTWFwcGluZ1JlcG9zaXRvcnkgcmVwb3MgPSBnZXRSZXBv\nc2l0b3J5KCk7CiAgICAgICAgcmVwb3Muc2V0UmVzb2x2ZShNT0RFX01BUFBJ\nTkcsIGZhbHNlKTsKICAgICAgICBNZXRhRGF0YUZhY3RvcnkgZmFjdG9yeSA9\nIHJlcG9zLmdldE1ldGFEYXRhRmFjdG9yeSgpOwogICAgICAgIGZhY3Rvcnku\nZ2V0RGVmYXVsdHMoKS5zZXRJZ25vcmVOb25QZXJzaXN0ZW50KGZhbHNlKTsK\nICAgICAgICBmYWN0b3J5LnNldFN0b3JlTW9kZShNZXRhRGF0YUZhY3Rvcnku\nU1RPUkVfVkVSQk9TRSk7CgogICAgICAgIENsYXNzTWV0YURhdGEgbWV0YSA9\nIHJlcG9zLmFkZE1ldGFEYXRhKGNscyk7CiAgICAgICAgRmllbGRNZXRhRGF0\nYVtdIGZtZHMgPSBtZXRhLmdldERlY2xhcmVkRmllbGRzKCk7CiAgICAgICAg\nZm9yIChpbnQgaSA9IDA7IGkgPCBmbWRzLmxlbmd0aDsgaSsrKSB7CiAgICAg\nICAgICAgIGlmIChmbWRzW2ldLmdldERlY2xhcmVkVHlwZUNvZGUoKSA9PSBK\nYXZhVHlwZXMuT0JKRUNUCiAgICAgICAgICAgICAgICAmJiBmbWRzW2ldLmdl\ndERlY2xhcmVkVHlwZSgpICE9IE9iamVjdC5jbGFzcykKICAgICAgICAgICAg\nICAgIGZtZHNbaV0uc2V0RGVjbGFyZWRUeXBlQ29kZShKYXZhVHlwZXMuUEMp\nOwogICAgICAgIH0KICAgICAgICBtZXRhLnNldFNvdXJjZShfZmlsZSwgbWV0\nYS5nZXRTb3VyY2VUeXBlKCkpOwogICAgICAgIG1ldGEuc2V0UmVzb2x2ZShN\nT0RFX01FVEEsIHRydWUpOwogICAgfQoKICAgIC8qKgogICAgICogUmVmcmVz\naCBvciBhZGQgdGhlIG1hcHBpbmcgZm9yIHRoZSBnaXZlbiBpbnN0YW5jZS4K\nICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIHJlZnJlc2goQ2xhc3MgY2xzKSB7\nCiAgICAgICAgaWYgKGNscyA9PSBudWxsKQogICAgICAgICAgICByZXR1cm47\nCgogICAgICAgIE1hcHBpbmdSZXBvc2l0b3J5IHJlcG9zID0gZ2V0UmVwb3Np\ndG9yeSgpOwogICAgICAgIHJlcG9zLnNldFN0cmF0ZWd5SW5zdGFsbGVyKG5l\ndyBSZWZyZXNoU3RyYXRlZ3lJbnN0YWxsZXIocmVwb3MpKTsKICAgICAgICBp\nZiAoZ2V0TWFwcGluZyhyZXBvcywgY2xzLCB0cnVlKSAhPSBudWxsKSB7CiAg\nICAgICAgICAgIF9mbHVzaCA9IHRydWU7CiAgICAgICAgICAgIF9mbHVzaFNj\naGVtYSA9IHRydWU7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICog\nVmFsaWRhdGUgdGhlIG1hcHBpbmdzIGZvciB0aGUgZ2l2ZW4gY2xhc3MgYW5k\nIGl0cyBmaWVsZHMuCiAgICAgKi8KICAgIHByaXZhdGUgdm9pZCB2YWxpZGF0\nZShDbGFzcyBjbHMpIHsKICAgICAgICBpZiAoY2xzID09IG51bGwpCiAgICAg\nICAgICAgIHJldHVybjsKCiAgICAgICAgTWFwcGluZ1JlcG9zaXRvcnkgcmVw\nb3MgPSBnZXRSZXBvc2l0b3J5KCk7CiAgICAgICAgcmVwb3Muc2V0U3RyYXRl\nZ3lJbnN0YWxsZXIobmV3IFJ1bnRpbWVTdHJhdGVneUluc3RhbGxlcihyZXBv\ncykpOwogICAgICAgIGlmIChnZXRNYXBwaW5nKHJlcG9zLCBjbHMsIHRydWUp\nICE9IG51bGwpCiAgICAgICAgICAgIF9mbHVzaFNjaGVtYSA9ICFjb250YWlu\ncyhfc2NoZW1hQWN0aW9ucyxTQ0hFTUFfQUNUSU9OX05PTkUpCiAgICAgICAg\nICAgICAgICAmJiAhY29udGFpbnMoX3NjaGVtYUFjdGlvbnMsU2NoZW1hVG9v\nbC5BQ1RJT05fQUREKTsKICAgIH0KCiAgICAvKioKICAgICAqIENyZWF0ZSB0\naGUgc2NoZW1hIHVzaW5nIHRoZSBtYXBwaW5nIGZvciB0aGUgZ2l2ZW4gaW5z\ndGFuY2UuCiAgICAgKi8KICAgIHByaXZhdGUgdm9pZCBidWlsZFNjaGVtYShD\nbGFzcyBjbHMpIHsKICAgICAgICBpZiAoY2xzID09IG51bGwpCiAgICAgICAg\nICAgIHJldHVybjsKCiAgICAgICAgTWFwcGluZ1JlcG9zaXRvcnkgcmVwb3Mg\nPSBnZXRSZXBvc2l0b3J5KCk7CiAgICAgICAgcmVwb3Muc2V0U3RyYXRlZ3lJ\nbnN0YWxsZXIobmV3IFJ1bnRpbWVTdHJhdGVneUluc3RhbGxlcihyZXBvcykp\nOwogICAgICAgIGlmIChnZXRNYXBwaW5nKHJlcG9zLCBjbHMsIHRydWUpID09\nIG51bGwpCiAgICAgICAgICAgIHJldHVybjsKCiAgICAgICAgLy8gc2V0IGFu\neSBsb2dpY2FsIHBrcyB0byBub24tbG9naWNhbCBzbyB0aGV5IGdldCBmbHVz\naGVkCiAgICAgICAgX2ZsdXNoU2NoZW1hID0gdHJ1ZTsKICAgICAgICBTY2hl\nbWFbXSBzY2hlbWFzID0gX3NjaGVtYS5nZXRTY2hlbWFzKCk7CiAgICAgICAg\nVGFibGVbXSB0YWJsZXM7CiAgICAgICAgQ29sdW1uW10gY29sczsKICAgICAg\nICBmb3IgKGludCBpID0gMDsgaSA8IHNjaGVtYXMubGVuZ3RoOyBpKyspIHsK\nICAgICAgICAgICAgdGFibGVzID0gc2NoZW1hc1tpXS5nZXRUYWJsZXMoKTsK\nICAgICAgICAgICAgZm9yIChpbnQgaiA9IDA7IGogPCB0YWJsZXMubGVuZ3Ro\nOyBqKyspIHsKICAgICAgICAgICAgICAgIGlmICh0YWJsZXNbal0uZ2V0UHJp\nbWFyeUtleSgpID09IG51bGwpCiAgICAgICAgICAgICAgICAgICAgY29udGlu\ndWU7CgogICAgICAgICAgICAgICAgdGFibGVzW2pdLmdldFByaW1hcnlLZXko\nKS5zZXRMb2dpY2FsKGZhbHNlKTsKICAgICAgICAgICAgICAgIGNvbHMgPSB0\nYWJsZXNbal0uZ2V0UHJpbWFyeUtleSgpLmdldENvbHVtbnMoKTsKICAgICAg\nICAgICAgICAgIGZvciAoaW50IGsgPSAwOyBrIDwgY29scy5sZW5ndGg7IGsr\nKykKICAgICAgICAgICAgICAgICAgICBjb2xzW2tdLnNldE5vdE51bGwodHJ1\nZSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgLyoqCiAg\nICAgKiBEcm9wIG1hcHBpbmcgZm9yIGdpdmVuIGNsYXNzLgogICAgICovCiAg\nICBwcml2YXRlIHZvaWQgZHJvcChDbGFzcyBjbHMpIHsKICAgICAgICBpZiAo\nY2xzID09IG51bGwpCiAgICAgICAgICAgIHJldHVybjsKCiAgICAgICAgaWYg\nKF9kcm9wQ2xzID09IG51bGwpCiAgICAgICAgICAgIF9kcm9wQ2xzID0gbmV3\nIEhhc2hTZXQoKTsKICAgICAgICBfZHJvcENscy5hZGQoY2xzKTsKICAgICAg\nICBpZiAoIWNvbnRhaW5zKF9zY2hlbWFBY3Rpb25zLFNjaGVtYVRvb2wuQUNU\nSU9OX0RST1ApKQogICAgICAgICAgICByZXR1cm47CgogICAgICAgIE1hcHBp\nbmdSZXBvc2l0b3J5IHJlcG9zID0gZ2V0UmVwb3NpdG9yeSgpOwogICAgICAg\nIHJlcG9zLnNldFN0cmF0ZWd5SW5zdGFsbGVyKG5ldyBSdW50aW1lU3RyYXRl\nZ3lJbnN0YWxsZXIocmVwb3MpKTsKICAgICAgICBDbGFzc01hcHBpbmcgbWFw\ncGluZyA9IG51bGw7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgbWFwcGlu\nZyA9IHJlcG9zLmdldE1hcHBpbmcoY2xzLCBudWxsLCBmYWxzZSk7CiAgICAg\nICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICB9CgogICAgICAg\nIGlmIChtYXBwaW5nICE9IG51bGwpIHsKICAgICAgICAgICAgX2ZsdXNoU2No\nZW1hID0gdHJ1ZTsKICAgICAgICAgICAgaWYgKF9kcm9wTWFwID09IG51bGwp\nCiAgICAgICAgICAgICAgICBfZHJvcE1hcCA9IG5ldyBIYXNoU2V0KCk7CiAg\nICAgICAgICAgIF9kcm9wTWFwLmFkZChtYXBwaW5nKTsKICAgICAgICB9IGVs\nc2UKICAgICAgICAgICAgX2xvZy53YXJuKF9sb2MuZ2V0KCJuby1kcm9wLW1l\ndGEiLCBjbHMpKTsKICAgIH0KCiAgICAvLy8vLy8vLwogICAgLy8gTWFpbgog\nICAgLy8vLy8vLy8KCiAgICAvKioKICAgICAqIFVzYWdlOiBqYXZhIG9yZy5h\ncGFjaGUub3BlbmpwYS5qZGJjLm1ldGEuTWFwcGluZ1Rvb2wgW29wdGlvbl0q\nIAogICAgICogWy1hY3Rpb24vLWEgJmx0O3JlZnJlc2ggfCBhZGQgfCBidWls\nZFNjaGVtYSB8IGRyb3AgfCB2YWxpZGF0ZSB8IGltcG9ydCAKICAgICAqIHwg\nZXhwb3J0Jmd0O10gJmx0O2NsYXNzIG5hbWUgfCAuamF2YSBmaWxlIHwgLmNs\nYXNzIGZpbGUgfCAuamRvIGZpbGUmZ3Q7KgogICAgICogV2hlcmUgdGhlIGZv\nbGxvd2luZyBvcHRpb25zIGFyZSByZWNvZ25pemVkLgogICAgICogPHVsPgog\nICAgICogPGxpPjxpPi1wcm9wZXJ0aWVzLy1wICZsdDtwcm9wZXJ0aWVzIGZp\nbGUgb3IgcmVzb3VyY2UmZ3Q7PC9pPjogVGhlCiAgICAgKiBwYXRoIG9yIHJl\nc291cmNlIG5hbWUgb2YgYSBPcGVuSlBBIHByb3BlcnRpZXMgZmlsZSBjb250\nYWluaW5nCiAgICAgKiBpbmZvcm1hdGlvbiBhcyBvdXRsaW5lZCBpbiB7QGxp\nbmsgT3BlbkpQQUNvbmZpZ3VyYXRpb259LiBPcHRpb25hbC48L2xpPgogICAg\nICogPGxpPjxpPi0mbHQ7cHJvcGVydHkgbmFtZSZndDsgJmx0O3Byb3BlcnR5\nIHZhbHVlJmd0OzwvaT46IEFsbCBiZWFuCiAgICAgKiBwcm9wZXJ0aWVzIG9m\nIHRoZSBPcGVuSlBBIHtAbGluayBKREJDQ29uZmlndXJhdGlvbn0gY2FuIGJl\nIHNldCBieQogICAgICogdXNpbmcgdGhlaXIJbmFtZXMgYW5kIHN1cHBseWlu\nZyBhIHZhbHVlLiBGb3IgZXhhbXBsZToKICAgICAqIDxjb2RlPi1saWNlbnNl\nS2V5IGFkc2xmamE4M3IzbGthZGY8L2NvZGU+PC9saT4KICAgICAqIDxsaT48\naT4tZmlsZS8tZiAmbHQ7c3Rkb3V0IHwgb3V0cHV0IGZpbGUgb3IgcmVzb3Vy\nY2UmZ3Q7PC9pPjogVXNlCiAgICAgKiB0aGlzIG9wdGlvbiB0byB3cml0ZSB0\naGUgcGxhbm5lZCBtYXBwaW5ncyB0byBhbiBYTUwgZG9jdW1lbnQgcmF0aGVy\nCiAgICAgKiB0aGFuIHN0b3JlIHRoZW0gaW4gdGhlIHJlcG9zaXRvcnkuIFRo\naXMgb3B0aW9uIGFsc28gc3BlY2lmaWVzIHRoZQogICAgICogbWV0YWRhdGEg\nZmlsZSB0byB3cml0ZSB0byBpZiB1c2luZyB0aGUgPGNvZGU+YWRkPC9jb2Rl\nPiBhY3Rpb24gd2l0aAogICAgICogdGhlIDxjb2RlPi1tZXRhIHRydWU8L2Nv\nZGU+IGZsYWcsIG9yIHRoZSBmaWxlIHRvIGR1bXAgdG8gaWYgdXNpbmcKICAg\nICAqIHRoZSA8Y29kZT5leHBvcnQ8L2NvZGU+IGFjdGlvbi48L2xpPgogICAg\nICogPGxpPjxpPi1zY2hlbWFBY3Rpb24vLXNhICZsdDtzY2hlbWEgYWN0aW9u\nIHwgbm9uZSZndDs8L2k+OiBUaGUKICAgICAqIHtAbGluayBTY2hlbWFUb29s\nfSBkZWZpbmVzIHRoZSBhY3Rpb25zIHBvc3NpYmxlLiBUaGUgYWN0aW9ucyB3\naWxsCiAgICAgKiBhcHBseSB0byBhbGwgc2NoZW1hIGNvbXBvbmVudHMgdXNl\nZCBieSB0aGUgbWFwcGluZ3MgaW52b2x2ZWQuCiAgICAgKiBVbmxlc3MgeW91\nIGFyZSBydW5uaW5nIHRoZSBtYXBwaW5nIHRvb2wgb24gYWxsIG9mIHlvdXIg\ncGVyc2lzdGVudAogICAgICogdHlwZXMgYXQgb25jZSwgYmUgY2FyZWZ1bCBy\ndW5uaW5nIHNjaGVtYSBhY3Rpb25zIHRoYXQgY2FuIGRyb3AgZGF0YS4KICAg\nICAqIEl0IGlzIHBvc3NpYmxlIHRvIGFjY2lkZW50YWxseSBkcm9wIHNjaGVt\nYSBjb21wb25lbnRzIHRoYXQgYXJlCiAgICAgKiB1c2VkIGJ5IGNsYXNzZXMg\neW91IGFyZW4ndCBjdXJyZW50bHkgcnVubmluZyB0aGUgdG9vbCBvdmVyLiBU\naGUKICAgICAqIGFjdGlvbiBkZWZhdWx0cyB0byA8Y29kZT5hZGQ8L2NvZGU+\nLjwvbGk+CiAgICAgKiA8bGk+PGk+LXNjaGVtYUZpbGUvLXNmICZsdDtzdGRv\ndXQgfCBvdXRwdXQgZmlsZSBvciByZXNvdXJjZSZndDs8L2k+OiBVc2UKICAg\nICAqIHRoaXMgb3B0aW9uIHRvIHdyaXRlIHRoZSBwbGFubmVkIHNjaGVtYSB0\nbyBhbiBYTUwgZG9jdW1lbnQgcmF0aGVyCiAgICAgKiB0aGFuIG1vZGlmeSB0\naGUgZGF0YSBzdG9yZS48L2xpPgogICAgICogPGxpPjxpPi1zcWxGaWxlLy1z\ncWwgJmx0O3N0ZG91dCB8IG91dHB1dCBmaWxlIG9yIHJlc291cmNlJmd0Ozwv\naT46IFVzZQogICAgICogdGhpcyBvcHRpb24gdG8gd3JpdGUgdGhlIHBsYW5u\nZWQgc2NoZW1hIGNoYW5nZXMgYXMgYSBTUUwKICAgICAqIHNjcmlwdCByYXRo\nZXIgdGhhbiBtb2RpZnlpbmcgdGhlIGRhdGEgc3RvcmUuPC9saT4KICAgICAq\nIDxsaT48aT4tZHJvcFRhYmxlcy8tZHQgJmx0O3RydWUvdCB8IGZhbHNlL2Ym\nZ3Q7PC9pPjogQ29ycmVzcG9uZHMgdG8gdGhlCiAgICAgKiBzYW1lLW5hbWVk\nIG9wdGlvbiBpbiB0aGUge0BsaW5rIFNjaGVtYVRvb2x9LjwvbGk+CiAgICAg\nKiA8bGk+PGk+LWRyb3BTZXF1ZW5jZXMvLWRzcSAmbHQ7dHJ1ZS90IHwgZmFs\nc2UvZiZndDs8L2k+OiBDb3JyZXNwb25kcwogICAgICogdG8gdGhlIHNhbWUt\nbmFtZWQgb3B0aW9uIGluIHRoZSB7QGxpbmsgU2NoZW1hVG9vbH0uPC9saT4K\nICAgICAqIDxsaT48aT4tb3BlbmpwYVRhYmxlcy8ta3QgJmx0O3RydWUvdCB8\nIGZhbHNlL2YmZ3Q7PC9pPjogQ29ycmVzcG9uZHMgdG8KICAgICAqIHRoZSBz\nYW1lLW5hbWVkIG9wdGlvbiBpbiB0aGUge0BsaW5rIFNjaGVtYVRvb2x9Ljwv\nbGk+CiAgICAgKiA8bGk+PGk+LWlnbm9yZUVycm9ycy8taSAmbHQ7dHJ1ZS90\nIHwgZmFsc2UvZiZndDs8L2k+OiBDb3JyZXNwb25kcyB0byB0aGUKICAgICAq\nIHNhbWUtbmFtZWQgb3B0aW9uIGluIHRoZSB7QGxpbmsgU2NoZW1hVG9vbH0u\nPC9saT4KICAgICAqIDxsaT48aT4tcmVhZFNjaGVtYS8tcnMgJmx0O3RydWUv\ndCB8IGZhbHNlL2YmZ3Q7PC9pPjogU2V0IHRoaXMgdG8gdHJ1ZQogICAgICog\ndG8gcmVhZCB0aGUgZW50aXJlIGV4aXN0aW5nIHNjaGVtYSAoZXZlbiB3aGVu\nIGZhbHNlIHRoZSBwYXJ0cyBvZgogICAgICogdGhlIHNjaGVtYSB1c2VkIGJ5\nIGNsYXNzZXMgdGhlIHRvb2wgaXMgcnVuIG9uIHdpbGwgc3RpbGwgYmUgcmVh\nZCkuCiAgICAgKiBUdXJuaW5nIG9uIHNjaGVtYSByZWFkaW5nIGNhbiBlbnN1\ncmUgdGhhdCBubyBuYW1pbmcgY29uZmxpY3RzIHdpbGwKICAgICAqIG9jY3Vy\nLCBidXQgaXQgY2FuIHRha2UgYSBsb25nIHRpbWUuPC9saT4KICAgICAqIDxs\naT48aT4tcHJpbWFyeUtleXMvLXBrICZsdDt0cnVlL3QgfCBmYWxzZS9mJmd0\nOzwvaT46IFdoZXRoZXIgcHJpbWFyeQogICAgICoga2V5cyBvbiBleGlzdGlu\nZyB0YWJsZXMgYXJlIG1hbmlwdWxhdGVkLiBEZWZhdWx0cyB0byBmYWxzZS48\nL2xpPgogICAgICogPGxpPjxpPi1mb3JlaWduS2V5cy8tZmsgJmx0O3RydWUv\ndCB8IGZhbHNlL2YmZ3Q7PC9pPjogV2hldGhlciBmb3JlaWduCiAgICAgKiBr\nZXlzIG9uIGV4aXN0aW5nIHRhYmxlcyBhcmUgbWFuaXB1bGF0ZWQuIERlZmF1\nbHRzIHRvIGZhbHNlLjwvbGk+CiAgICAgKiA8bGk+PGk+LWluZGV4ZXMvLWl4\nICZsdDt0cnVlL3QgfCBmYWxzZS9mJmd0OzwvaT46IFdoZXRoZXIgaW5kZXhl\ncyBvbgogICAgICogZXhpc3RpbmcgdGFibGVzIGFyZSBtYW5pcHVsYXRlZC4g\nRGVmYXVsdHMgdG8gZmFsc2UuPC9saT4KICAgICAqIDxsaT48aT4tc2VxdWVu\nY2VzLy1zcSAmbHQ7dHJ1ZS90IHwgZmFsc2UvZiZndDs8L2k+OiBXaGV0aGVy\nIHNlcXVlbmNlcwogICAgICogYXJlIG1hbmlwdWxhdGVkLiBEZWZhdWx0cyB0\nbyB0cnVlLjwvbGk+CiAgICAgKiA8bGk+PGk+LXNjaGVtYXMvLXMgJmx0O3Nj\naGVtYSBhbmQgdGFibGUgbmFtZXMmZ3Q7PC9pPjogQSBsaXN0IG9mIHNjaGVt\nYXMKICAgICAqIGFuZC9vciB0YWJsZXMgdG8gcmVhZC4gQ29ycmVzcG9uZHMg\ndG8gdGhlCiAgICAgKiBzYW1lLW5hbWVkIG9wdGlvbiBpbiB0aGUge0BsaW5r\nIFNjaGVtYUdlbmVyYXRvcn0uIFRoaXMgb3B0aW9uCiAgICAgKiBpcyBpZ25v\ncmVkIGlmIDxjb2RlPnJlYWRTY2hlbWE8L2NvZGU+IGlzIGZhbHNlLjwvbGk+\nCiAgICAgKiA8bGk+PGk+LW1ldGEvLW0gJmx0O3RydWUvdCB8IGZhbHNlL2Ym\nZ3Q7PC9pPjogV2hldGhlciB0aGUgZ2l2ZW4gYWN0aW9uCiAgICAgKiBhcHBs\naWVzIHRvIG1ldGFkYXRhIGFzIHdlbGwgYXMgbWFwcGluZ3MuPC9saT4KICAg\nICAqIDwvdWw+CiAgICAgKiAgVGhlIHZhcmlvdXMgYWN0aW9ucyBhcmUgYXMg\nZm9sbG93cy4KICAgICAqIDx1bD4KICAgICAqIDxsaT48aT5yZWZyZXNoPC9p\nPjogQnJpbmcgdGhlIG1hcHBpbmcgaW5mb3JtYXRpb24gdXAtdG8tZGF0ZQog\nICAgICogd2l0aCB0aGUgY2xhc3MgZGVmaW5pdGlvbnMuIE9wZW5KUEEgd2ls\nbCBhdHRlbXB0IHRvIHVzZSBhbnkgcHJvdmlkZWQKICAgICAqIG1hcHBpbmcg\naW5mb3JtYXRpb24sIGFuZCBmaWxsIGluIG1pc3NpbmcgaW5mb3JtYXRpb24u\nIElmIHRoZQogICAgICogcHJvdmlkZWQgaW5mb3JtYXRpb24gY29uZmxpY3Rz\nIHdpdGggdGhlIGNsYXNzIGRlZmluaXRpb24sIHRoZQogICAgICogY29uZmxp\nY3RpbmcgaW5mb3JtYXRpb24gd2lsbCBiZSBkaXNjYXJkZWQgYW5kIHRoZSBj\nbGFzcy9maWVsZCB3aWxsCiAgICAgKiBiZSByZS1tYXBwZWQgdG8gbmV3IGNv\nbHVtbnMvdGFibGVzLiBUaGlzIGlzIHRoZSBkZWZhdWx0IGFjdGlvbi48L2xp\nPgogICAgICogPGxpPjxpPmFkZDwvaT46IElmIHVzZWQgd2l0aCB0aGUgPGNv\nZGU+LW1ldGE8L2NvZGU+IG9wdGlvbiwgYWRkcyBuZXcKICAgICAqIGRlZmF1\nbHQgbWV0YWRhdGEgZm9yIHRoZSBnaXZlbiBjbGFzcyhlcykuIE90aGVyd2lz\nZSwgYnJpbmdzIHRoZQogICAgICogbWFwcGluZyBpbmZvcm1hdGlvbiB1cC10\nby1kYXRlIHdpdGggdGhlIGNsYXNzCiAgICAgKiBkZWZpbml0aW9ucy4gT3Bl\nbkpQQSB3aWxsIGF0dGVtcHQgdG8gdXNlIGFueSBwcm92aWRlZCBtYXBwaW5n\nCiAgICAgKiBpbmZvcm1hdGlvbiwgYW5kIGZpbGwgaW4gbWlzc2luZyBpbmZv\ncm1hdGlvbi4gT3BlbkpQQSB3aWxsIGZhaWwgaWYKICAgICAqIHRoZSBwcm92\naWRlZCBpbmZvcm1hdGlvbiBjb25mbGljdHMgd2l0aCB0aGUgY2xhc3MgZGVm\naW5pdGlvbi48L2xpPgogICAgICogPGxpPjxpPmJ1aWxkU2NoZW1hPC9pPjog\nQ3JlYXRlIHRoZSBzY2hlbWEgbWF0Y2hpbmcgdGhlIGV4aXN0aW5nCiAgICAg\nKiBtYXBwaW5ncyBmb3IgdGhlIGdpdmVuIGNsYXNzKGVzKS4gQW55IGludmFs\naWQgbWFwcGluZyBpbmZvcm1hdGlvbgogICAgICogd2lsbCBjYXVzZSBhbiBl\neGNlcHRpb24uPC9saT4KICAgICAqIDxsaT48aT5kcm9wPC9pPjogRGVsZXRl\nIG1hcHBpbmdzIGZvciB0aGUgZ2l2ZW4gY2xhc3Nlcy4gSWYgdXNlZCB3aXRo\nCiAgICAgKiB0aGUgPGNvZGU+LW1ldGE8L2NvZGU+IG9wdGlvbiwgYWxzbyBk\nZWxldGVzIG1ldGFkYXRhLjwvbGk+CiAgICAgKiA8bGk+PGk+dmFsaWRhdGU8\nL2k+OiBWYWxpZGF0ZSB0aGUgZ2l2ZW4gbWFwcGluZ3MuIFRoZSBtYXBwaW5n\nCiAgICAgKiByZXBvc2l0b3J5IGFuZCBzY2hlbWEgd2lsbCBub3QgYmUgYWZm\nZWN0ZWQuPC9saT4KICAgICAqIDxsaT48aT5pbXBvcnQ8L2k+OiBJbXBvcnQg\nbWFwcGluZ3MgZnJvbSBhbiBYTUwgZG9jdW1lbnQgYW5kIHN0b3JlCiAgICAg\nKiB0aGVtIGFzIHRoZSBjdXJyZW50IHN5c3RlbSBtYXBwaW5ncy48L2xpPgog\nICAgICogPGxpPjxpPmV4cG9ydDwvaT46IER1bXAgdGhlIGN1cnJlbnQgbWFw\ncGluZ3MgZm9yIHRoZSBnaXZlbiBjbGFzc2VzIHRvCiAgICAgKiBhbiBYTUwg\nZG9jdW1lbnQgc3BlY2lmaWVkIGJ5IHRoZSA8Y29kZT5maWxlPC9jb2RlPiBv\ncHRpb24uPC9saT4KICAgICAqIElmIHVzZWQgd2l0aCB0aGUgPGNvZGU+LW1l\ndGE8L2NvZGU+IG9wdGlvbiwgdGhlIG1ldGFkYXRhIHdpbGwgYmUKICAgICAq\nIGluY2x1ZGVkIGluIHRoZSBleHBvcnQuCiAgICAgKiA8L3VsPgogICAgICog\nIEVhY2ggY2xhc3Mgc3VwcGxpZWQgYXMgYW4gYXJndW1lbnQgbXVzdCBoYXZl\nIHZhbGlkIG1ldGFkYXRhLiBJZgogICAgICogbm8gY2xhc3MgYXJndW1lbnRz\nIGFyZSBnaXZlbiwgdGhlIHRvb2wgcnVucyBvbiBhbGwgbWV0YWRhdGEgZmls\nZXMgaW4KICAgICAqIHRoZSBDTEFTU1BBVEguCiAgICAgKiAgRXhhbXBsZXM6\nCiAgICAgKiA8dWw+CiAgICAgKiA8bGk+UmVmcmVzaCB0aGUgbWFwcGluZ3Mg\nZm9yIGdpdmVuIHBhY2thZ2UsIHdpdGhvdXQgZHJvcHBpbmcgYW55CiAgICAg\nKiBzY2hlbWEgY29tcG9uZW50czo8YnIgLz4KICAgICAqIDxjb2RlPmphdmEg\nb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0YS5NYXBwaW5nVG9vbCAKICAg\nICAqICAgICAgbXlwYWNrYWdlLmpkbzwvY29kZT48L2xpPgogICAgICogPGxp\nPlJlZnJlc2ggdGhlIG1hcHBpbmdzIGZvciBhbGwgcGVyc2lzdGVudCBjbGFz\nc2VzIGluIHRoZSBjbGFzc3BhdGgsCiAgICAgKiBkcm9wcGluZyBhbnkgdW51\nc2VkIGNvbHVtbnMgYW5kIGV2ZW4gdGFibGVzOjxiciAvPgogICAgICogPGNv\nZGU+amF2YSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhLk1hcHBpbmdU\nb29sIC1zYSByZWZyZXNoCiAgICAgKiAtZHQgdHJ1ZTwvY29kZT48L2xpPgog\nICAgICogPGxpPk1ha2Ugc3VyZSB0aGUgbWFwcGluZ3MgeW91J3ZlIGNyZWF0\nZWQgYnkgaGFuZCBtYXRjaCB0aGUgb2JqZWN0CiAgICAgKiBtb2RlbCBhbmQg\nc2NoZW1hOjxiciAvPgogICAgICogPGNvZGU+amF2YSBvcmcuYXBhY2hlLm9w\nZW5qcGEuamJkYy5tZXRhLk1hcHBpbmdUb29sCiAgICAgKiAtYSB2YWxpZGF0\nZSBQZXJzb24uamF2YTwvY29kZT48L2xpPgogICAgICogPGxpPlJlbW92ZSB0\naGUgcmVjb3JkZWQgbWFwcGluZyBmb3IgYSBnaXZlbiBjbGFzczo8YnIgLz4K\nICAgICAqIDxjb2RlPmphdmEgb3JnLmFwYWNoZS5vcGVuanBhLmpiZGMubWV0\nYS5NYXBwaW5nVG9vbAogICAgICogLWEgZHJvcCBQZXJzb24uamF2YTwvY29k\nZT48L2xpPgogICAgICogPGxpPlJlY29yZCB0aGUgY3VycmVudCBtYXBwaW5n\ncyBpbiBhbiBYTUwgZmlsZTo8YnIgLz4KICAgICAqIDxjb2RlPmphdmEgb3Jn\nLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0YS5NYXBwaW5nVG9vbAogICAgICog\nLWYgbXlwYWNrYWdlLm9ybSAtYSBleHBvcnQgbXlwYWNrYWdlLmpkbzwvY29k\nZT48L2xpPgogICAgICogPC91bD4KICAgICAqLwogICAgcHVibGljIHN0YXRp\nYyB2b2lkIG1haW4oU3RyaW5nW10gYXJndW1lbnRzKQogICAgICAgIHRocm93\ncyBJT0V4Y2VwdGlvbiwgU1FMRXhjZXB0aW9uIHsKICAgICAgICBPcHRpb25z\nIG9wdHMgPSBuZXcgT3B0aW9ucygpOwogICAgICAgIGZpbmFsIFN0cmluZ1td\nIGFyZ3MgPSBvcHRzLnNldEZyb21DbWRMaW5lKGFyZ3VtZW50cyk7CiAgICAg\nICAgYm9vbGVhbiByZXQgPSBDb25maWd1cmF0aW9ucy5ydW5BZ2FpbnN0QWxs\nQW5jaG9ycyhvcHRzLAogICAgICAgICAgICBuZXcgQ29uZmlndXJhdGlvbnMu\nUnVubmFibGUoKSB7CiAgICAgICAgICAgIHB1YmxpYyBib29sZWFuIHJ1bihP\ncHRpb25zIG9wdHMpIHRocm93cyBJT0V4Y2VwdGlvbiwgU1FMRXhjZXB0aW9u\nIHsKICAgICAgICAgICAgICAgIEpEQkNDb25maWd1cmF0aW9uIGNvbmYgPSBu\nZXcgSkRCQ0NvbmZpZ3VyYXRpb25JbXBsKCk7CiAgICAgICAgICAgICAgICB0\ncnkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBNYXBwaW5nVG9vbC5y\ndW4oY29uZiwgYXJncywgb3B0cyk7CiAgICAgICAgICAgICAgICB9IGZpbmFs\nbHkgewogICAgICAgICAgICAgICAgICAgIGNvbmYuY2xvc2UoKTsKICAgICAg\nICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0pOwogICAgICAg\nIGlmICghcmV0KQogICAgICAgICAgICBTeXN0ZW0uZXJyLnByaW50bG4oX2xv\nYy5nZXQoInRvb2wtdXNhZ2UiKSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBS\ndW4gdGhlIHRvb2wuIFJldHVybnMgZmFsc2UgaWYgaW52YWxpZCBvcHRpb25z\nIGFyZSBnaXZlbi4KICAgICAqCiAgICAgKiBAc2VlICNtYWluCiAgICAgKi8K\nICAgIHB1YmxpYyBzdGF0aWMgYm9vbGVhbiBydW4oSkRCQ0NvbmZpZ3VyYXRp\nb24gY29uZiwgU3RyaW5nW10gYXJncywKICAgICAgICBPcHRpb25zIG9wdHMp\nCiAgICAgICAgdGhyb3dzIElPRXhjZXB0aW9uLCBTUUxFeGNlcHRpb24gewog\nICAgICAgIC8vIGZsYWdzCiAgICAgICAgRmxhZ3MgZmxhZ3MgPSBuZXcgRmxh\nZ3MoKTsKICAgICAgICBmbGFncy5hY3Rpb24gPSBvcHRzLnJlbW92ZVByb3Bl\ncnR5KCJhY3Rpb24iLCAiYSIsIGZsYWdzLmFjdGlvbik7CiAgICAgICAgZmxh\nZ3Muc2NoZW1hQWN0aW9uID0gb3B0cy5yZW1vdmVQcm9wZXJ0eSgic2NoZW1h\nQWN0aW9uIiwgInNhIiwKICAgICAgICAgICAgZmxhZ3Muc2NoZW1hQWN0aW9u\nKTsKICAgICAgICBmbGFncy5kcm9wVGFibGVzID0gb3B0cy5yZW1vdmVCb29s\nZWFuUHJvcGVydHkKICAgICAgICAgICAgKCJkcm9wVGFibGVzIiwgImR0Iiwg\nZmxhZ3MuZHJvcFRhYmxlcyk7CiAgICAgICAgZmxhZ3Mub3BlbmpwYVRhYmxl\ncyA9IG9wdHMucmVtb3ZlQm9vbGVhblByb3BlcnR5CiAgICAgICAgICAgICgi\nb3BlbmpwYVRhYmxlcyIsICJvdCIsIGZsYWdzLm9wZW5qcGFUYWJsZXMpOwog\nICAgICAgIGZsYWdzLmRyb3BTZXF1ZW5jZXMgPSBvcHRzLnJlbW92ZUJvb2xl\nYW5Qcm9wZXJ0eQogICAgICAgICAgICAoImRyb3BTZXF1ZW5jZXMiLCAiZHNx\nIiwgZmxhZ3MuZHJvcFNlcXVlbmNlcyk7CiAgICAgICAgZmxhZ3MucmVhZFNj\naGVtYSA9IG9wdHMucmVtb3ZlQm9vbGVhblByb3BlcnR5CiAgICAgICAgICAg\nICgicmVhZFNjaGVtYSIsICJycyIsIGZsYWdzLnJlYWRTY2hlbWEpOwogICAg\nICAgIGZsYWdzLnByaW1hcnlLZXlzID0gb3B0cy5yZW1vdmVCb29sZWFuUHJv\ncGVydHkKICAgICAgICAgICAgKCJwcmltYXJ5S2V5cyIsICJwayIsIGZsYWdz\nLnByaW1hcnlLZXlzKTsKICAgICAgICBmbGFncy5pbmRleGVzID0gb3B0cy5y\nZW1vdmVCb29sZWFuUHJvcGVydHkoImluZGV4ZXMiLCAiaXgiLAogICAgICAg\nICAgICBmbGFncy5pbmRleGVzKTsKICAgICAgICBmbGFncy5mb3JlaWduS2V5\ncyA9IG9wdHMucmVtb3ZlQm9vbGVhblByb3BlcnR5KCJmb3JlaWduS2V5cyIs\nICJmayIsCiAgICAgICAgICAgIGZsYWdzLmZvcmVpZ25LZXlzKTsKICAgICAg\nICBmbGFncy5zZXF1ZW5jZXMgPSBvcHRzLnJlbW92ZUJvb2xlYW5Qcm9wZXJ0\neSgic2VxdWVuY2VzIiwgInNxIiwKICAgICAgICAgICAgZmxhZ3Muc2VxdWVu\nY2VzKTsKICAgICAgICBmbGFncy5pZ25vcmVFcnJvcnMgPSBvcHRzLnJlbW92\nZUJvb2xlYW5Qcm9wZXJ0eQogICAgICAgICAgICAoImlnbm9yZUVycm9ycyIs\nICJpIiwgZmxhZ3MuaWdub3JlRXJyb3JzKTsKICAgICAgICBmbGFncy5tZXRh\nID0gb3B0cy5yZW1vdmVCb29sZWFuUHJvcGVydHkoIm1ldGEiLCAibSIsIGZs\nYWdzLm1ldGEpOwogICAgICAgIFN0cmluZyBmaWxlTmFtZSA9IG9wdHMucmVt\nb3ZlUHJvcGVydHkoImZpbGUiLCAiZiIsIG51bGwpOwogICAgICAgIFN0cmlu\nZyBzY2hlbWFGaWxlTmFtZSA9IG9wdHMucmVtb3ZlUHJvcGVydHkoInNjaGVt\nYUZpbGUiLCAic2YiLCBudWxsKTsKICAgICAgICBTdHJpbmcgc3FsRmlsZU5h\nbWUgPSBvcHRzLnJlbW92ZVByb3BlcnR5KCJzcWxGaWxlIiwgInNxbCIsIG51\nbGwpOwogICAgICAgIFN0cmluZyBzY2hlbWFzID0gb3B0cy5yZW1vdmVQcm9w\nZXJ0eSgicyIpOwogICAgICAgIGlmIChzY2hlbWFzICE9IG51bGwpCiAgICAg\nICAgICAgIG9wdHMuc2V0UHJvcGVydHkoInNjaGVtYXMiLCBzY2hlbWFzKTsK\nCiAgICAgICAgQ29uZmlndXJhdGlvbnMucG9wdWxhdGVDb25maWd1cmF0aW9u\nKGNvbmYsIG9wdHMpOwogICAgICAgIENsYXNzTG9hZGVyIGxvYWRlciA9IGNv\nbmYuZ2V0Q2xhc3NSZXNvbHZlckluc3RhbmNlKCkuCiAgICAgICAgICAgIGdl\ndENsYXNzTG9hZGVyKE1hcHBpbmdUb29sLmNsYXNzLCBudWxsKTsKICAgICAg\nICBpZiAoZmxhZ3MubWV0YSAmJiBBQ1RJT05fQURELmVxdWFscyhmbGFncy5h\nY3Rpb24pKQogICAgICAgICAgICBmbGFncy5tZXRhRGF0YUZpbGUgPSBGaWxl\ncy5nZXRGaWxlKGZpbGVOYW1lLCBsb2FkZXIpOwogICAgICAgIGVsc2UKICAg\nICAgICAgICAgZmxhZ3MubWFwcGluZ1dyaXRlciA9IEZpbGVzLmdldFdyaXRl\ncihmaWxlTmFtZSwgbG9hZGVyKTsKICAgICAgICBmbGFncy5zY2hlbWFXcml0\nZXIgPSBGaWxlcy5nZXRXcml0ZXIoc2NoZW1hRmlsZU5hbWUsIGxvYWRlcik7\nCiAgICAgICAgZmxhZ3Muc3FsV3JpdGVyID0gRmlsZXMuZ2V0V3JpdGVyKHNx\nbEZpbGVOYW1lLCBsb2FkZXIpOwoKICAgICAgICByZXR1cm4gcnVuKGNvbmYs\nIGFyZ3MsIGZsYWdzLCBsb2FkZXIpOwogICAgfQoKICAgIC8qKgogICAgICog\nUnVuIHRoZSB0b29sLiBSZXR1cm4gZmFsc2UgaWYgYW4gaW52YWxpZCBvcHRp\nb24gd2FzIGdpdmVuLgogICAgICovCiAgICBwdWJsaWMgc3RhdGljIGJvb2xl\nYW4gcnVuKEpEQkNDb25maWd1cmF0aW9uIGNvbmYsIFN0cmluZ1tdIGFyZ3Ms\nCiAgICAgICAgRmxhZ3MgZmxhZ3MsIENsYXNzTG9hZGVyIGxvYWRlcikKICAg\nICAgICB0aHJvd3MgSU9FeGNlcHRpb24sIFNRTEV4Y2VwdGlvbiB7CiAgICAg\nICAgLy8gZGVmYXVsdCBhY3Rpb24gYmFzZWQgb24gd2hldGhlciB0aGUgbWFw\ncGluZyBkZWZhdWx0cyBmaWxscyBpbgogICAgICAgIC8vIG1pc3NpbmcgaW5m\nbwogICAgICAgIGlmIChmbGFncy5hY3Rpb24gPT0gbnVsbCkgewogICAgICAg\nICAgICBpZiAoY29uZi5nZXRNYXBwaW5nRGVmYXVsdHNJbnN0YW5jZSgpLmRl\nZmF1bHRNaXNzaW5nSW5mbygpKQogICAgICAgICAgICAgICAgZmxhZ3MuYWN0\naW9uID0gQUNUSU9OX0JVSUxEX1NDSEVNQTsKICAgICAgICAgICAgZWxzZQog\nICAgICAgICAgICAgICAgZmxhZ3MuYWN0aW9uID0gQUNUSU9OX1JFRlJFU0g7\nCiAgICAgICAgfQoKICAgICAgICAvLyBjb2xsZWN0IHRoZSBjbGFzc2VzIHRv\nIGFjdCBvbgogICAgICAgIExvZyBsb2cgPSBjb25mLmdldExvZyhPcGVuSlBB\nQ29uZmlndXJhdGlvbi5MT0dfVE9PTCk7CiAgICAgICAgQ29sbGVjdGlvbiBj\nbGFzc2VzID0gbnVsbDsKICAgICAgICBpZiAoYXJncy5sZW5ndGggPT0gMCkg\newogICAgICAgICAgICBpZiAoQUNUSU9OX0lNUE9SVC5lcXVhbHMoZmxhZ3Mu\nYWN0aW9uKSkKICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAg\nICAgICAgbG9nLmluZm8oX2xvYy5nZXQoInJ1bm5pbmctYWxsLWNsYXNzZXMi\nKSk7CiAgICAgICAgICAgIGNsYXNzZXMgPSBjb25mLmdldE1hcHBpbmdSZXBv\nc2l0b3J5SW5zdGFuY2UoKS4KICAgICAgICAgICAgICAgIGxvYWRQZXJzaXN0\nZW50VHlwZXModHJ1ZSwgbG9hZGVyKTsKICAgICAgICB9IGVsc2UgewogICAg\nICAgICAgICBjbGFzc2VzID0gbmV3IEhhc2hTZXQoKTsKICAgICAgICAgICAg\nQ2xhc3NBcmdQYXJzZXIgY2xhc3NQYXJzZXIgPSBjb25mLmdldE1ldGFEYXRh\nUmVwb3NpdG9yeUluc3RhbmNlKCkuCiAgICAgICAgICAgICAgICBnZXRNZXRh\nRGF0YUZhY3RvcnkoKS5uZXdDbGFzc0FyZ1BhcnNlcigpOwogICAgICAgICAg\nICBjbGFzc1BhcnNlci5zZXRDbGFzc0xvYWRlcihsb2FkZXIpOwogICAgICAg\nICAgICBDbGFzc1tdIHBhcnNlZDsKICAgICAgICAgICAgZm9yIChpbnQgaSA9\nIDA7IGFyZ3MgIT0gbnVsbCAmJiBpIDwgYXJncy5sZW5ndGg7IGkrKykgewog\nICAgICAgICAgICAgICAgcGFyc2VkID0gY2xhc3NQYXJzZXIucGFyc2VUeXBl\ncyhhcmdzW2ldKTsKICAgICAgICAgICAgICAgIGNsYXNzZXMuYWRkQWxsKEFy\ncmF5cy5hc0xpc3QocGFyc2VkKSk7CiAgICAgICAgICAgIH0KICAgICAgICB9\nCgogICAgICAgIENsYXNzW10gYWN0ID0gKENsYXNzW10pIGNsYXNzZXMudG9B\ncnJheShuZXcgQ2xhc3NbY2xhc3Nlcy5zaXplKCldKTsKICAgICAgICBpZiAo\nQUNUSU9OX0VYUE9SVC5lcXVhbHMoZmxhZ3MuYWN0aW9uKSkgewogICAgICAg\nICAgICAvLyBydW4gZXhwb3J0cyB1bnRpbCB0aGUgZmlyc3QgZXhwb3J0IHN1\nY2NlZWRzCiAgICAgICAgICAgIEltcG9ydEV4cG9ydFtdIGluc3RhbmNlcyA9\nIG5ld0ltcG9ydEV4cG9ydHMoKTsKICAgICAgICAgICAgZm9yIChpbnQgaSA9\nIDA7IGkgPCBpbnN0YW5jZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAg\nICAgIGlmIChpbnN0YW5jZXNbaV0uZXhwb3J0TWFwcGluZ3MoY29uZiwgYWN0\nLCBmbGFncy5tZXRhLCBsb2csCiAgICAgICAgICAgICAgICAgICAgZmxhZ3Mu\nbWFwcGluZ1dyaXRlcikpCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRy\ndWU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwog\nICAgICAgIH0KICAgICAgICBpZiAoQUNUSU9OX0lNUE9SVC5lcXVhbHMoZmxh\nZ3MuYWN0aW9uKSkgewogICAgICAgICAgICAvLyBydW4gZXhwb3J0cyB1bnRp\nbCB0aGUgZmlyc3QgZXhwb3J0IHN1Y2NlZWRzCiAgICAgICAgICAgIEltcG9y\ndEV4cG9ydFtdIGluc3RhbmNlcyA9IG5ld0ltcG9ydEV4cG9ydHMoKTsKICAg\nICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBpbnN0YW5jZXMubGVuZ3Ro\nOyBpKyspIHsKICAgICAgICAgICAgICAgIGlmIChpbnN0YW5jZXNbaV0uaW1w\nb3J0TWFwcGluZ3MoY29uZiwgYWN0LCBhcmdzLCBmbGFncy5tZXRhLAogICAg\nICAgICAgICAgICAgICAgIGxvZywgbG9hZGVyKSkKICAgICAgICAgICAgICAg\nICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgICBy\nZXR1cm4gZmFsc2U7CiAgICAgICAgfQoKICAgICAgICBNYXBwaW5nVG9vbCB0\nb29sOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIHRvb2wgPSBuZXcgTWFw\ncGluZ1Rvb2woY29uZiwgZmxhZ3MuYWN0aW9uLCBmbGFncy5tZXRhKTsKICAg\nICAgICB9IGNhdGNoIChJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24gaWFlKSB7\nCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CgogICAgICAg\nIC8vIHNldHVwIHRoZSB0b29sCiAgICAgICAgdG9vbC5zZXRJZ25vcmVFcnJv\ncnMoZmxhZ3MuaWdub3JlRXJyb3JzKTsKICAgICAgICB0b29sLnNldE1ldGFE\nYXRhRmlsZShmbGFncy5tZXRhRGF0YUZpbGUpOwogICAgICAgIHRvb2wuc2V0\nTWFwcGluZ1dyaXRlcihmbGFncy5tYXBwaW5nV3JpdGVyKTsKICAgICAgICB0\nb29sLnNldFNjaGVtYUFjdGlvbihmbGFncy5zY2hlbWFBY3Rpb24pOwogICAg\nICAgIHRvb2wuc2V0U2NoZW1hV3JpdGVyKGZsYWdzLnNjaGVtYVdyaXRlcik7\nCiAgICAgICAgdG9vbC5zZXRSZWFkU2NoZW1hKGZsYWdzLnJlYWRTY2hlbWEK\nICAgICAgICAgICAgJiYgIUFDVElPTl9WQUxJREFURS5lcXVhbHMoZmxhZ3Mu\nYWN0aW9uKSk7CiAgICAgICAgdG9vbC5zZXRQcmltYXJ5S2V5cyhmbGFncy5w\ncmltYXJ5S2V5cyk7CiAgICAgICAgdG9vbC5zZXRGb3JlaWduS2V5cyhmbGFn\ncy5mb3JlaWduS2V5cyk7CiAgICAgICAgdG9vbC5zZXRJbmRleGVzKGZsYWdz\nLmluZGV4ZXMpOwogICAgICAgIHRvb2wuc2V0U2VxdWVuY2VzKGZsYWdzLnNl\ncXVlbmNlcyB8fCBmbGFncy5kcm9wU2VxdWVuY2VzKTsKCiAgICAgICAgLy8g\nYW5kIHJ1biB0aGUgYWN0aW9uCiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkg\nPCBhY3QubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgbG9nLmluZm8oX2xv\nYy5nZXQoInRvb2wtcnVubmluZyIsIGFjdFtpXSwgZmxhZ3MuYWN0aW9uKSk7\nCiAgICAgICAgICAgIGlmIChpID09IDAgJiYgZmxhZ3MucmVhZFNjaGVtYSkK\nICAgICAgICAgICAgICAgIGxvZy5pbmZvKF9sb2MuZ2V0KCJ0b29sLXRpbWUi\nKSk7CiAgICAgICAgICAgIHRvb2wucnVuKGFjdFtpXSk7CiAgICAgICAgfQog\nICAgICAgIGxvZy5pbmZvKF9sb2MuZ2V0KCJ0b29sLXJlY29yZCIpKTsKICAg\nICAgICB0b29sLnJlY29yZChmbGFncyk7CiAgICAgICAgcmV0dXJuIHRydWU7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBDcmVhdGUgYW4ge0BsaW5rIEltcG9y\ndEV4cG9ydH0gaW5zdGFuY2UuCiAgICAgKi8KICAgIHByaXZhdGUgc3RhdGlj\nIEltcG9ydEV4cG9ydFtdIG5ld0ltcG9ydEV4cG9ydHMoKSB7CiAgICAgICAg\ndHJ5IHsKICAgICAgICAgICAgQ2xhc3NbXSB0eXBlcyA9IFNlcnZpY2VzLmdl\ndEltcGxlbWVudG9yQ2xhc3NlcyhJbXBvcnRFeHBvcnQuY2xhc3MpOwogICAg\nICAgICAgICBJbXBvcnRFeHBvcnRbXSBpbnN0YW5jZXMgPSBuZXcgSW1wb3J0\nRXhwb3J0W3R5cGVzLmxlbmd0aF07CiAgICAgICAgICAgIGZvciAoaW50IGkg\nPSAwOyBpIDwgdHlwZXMubGVuZ3RoOyBpKyspCiAgICAgICAgICAgICAgICBp\nbnN0YW5jZXNbaV0gPSAoSW1wb3J0RXhwb3J0KSBBY2Nlc3NDb250cm9sbGVy\nLmRvUHJpdmlsZWdlZCgKICAgICAgICAgICAgICAgICAgICBKMkRvUHJpdkhl\nbHBlci5uZXdJbnN0YW5jZUFjdGlvbih0eXBlc1tpXSkpOwogICAgICAgICAg\nICByZXR1cm4gaW5zdGFuY2VzOwogICAgICAgIH0gY2F0Y2ggKFRocm93YWJs\nZSB0KSB7CiAgICAgICAgICAgIGlmICh0IGluc3RhbmNlb2YgUHJpdmlsZWdl\nZEFjdGlvbkV4Y2VwdGlvbikKICAgICAgICAgICAgICAgIHQgPSAoKFByaXZp\nbGVnZWRBY3Rpb25FeGNlcHRpb24pIHQpLmdldEV4Y2VwdGlvbigpOwogICAg\nICAgICAgICB0aHJvdyBuZXcgSW50ZXJuYWxFeGNlcHRpb24oX2xvYy5nZXQo\nImltcG9ydGV4cG9ydC1pbnN0YW50aWF0ZSIpLHQpOwogICAgICAgIH0KICAg\nIH0KICAgIAogICAgcHJpdmF0ZSBzdGF0aWMgYm9vbGVhbiBjb250YWlucyhT\ndHJpbmcgbGlzdCwgU3RyaW5nIGtleSkgewogICAgCXJldHVybiAobGlzdCA9\nPSBudWxsKSA/IGZhbHNlIDogbGlzdC5pbmRleE9mKGtleSkgIT0gLTE7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBSdW4gZmxhZ3MuCiAgICAgKi8KICAgIHB1\nYmxpYyBzdGF0aWMgY2xhc3MgRmxhZ3MgewoKICAgICAgICBwdWJsaWMgU3Ry\naW5nIGFjdGlvbiA9IG51bGw7CiAgICAgICAgcHVibGljIGJvb2xlYW4gbWV0\nYSA9IGZhbHNlOwogICAgICAgIHB1YmxpYyBTdHJpbmcgc2NoZW1hQWN0aW9u\nID0gU2NoZW1hVG9vbC5BQ1RJT05fQUREOwogICAgICAgIHB1YmxpYyBGaWxl\nIG1ldGFEYXRhRmlsZSA9IG51bGw7CiAgICAgICAgcHVibGljIFdyaXRlciBt\nYXBwaW5nV3JpdGVyID0gbnVsbDsKICAgICAgICBwdWJsaWMgV3JpdGVyIHNj\naGVtYVdyaXRlciA9IG51bGw7CiAgICAgICAgcHVibGljIFdyaXRlciBzcWxX\ncml0ZXIgPSBudWxsOwogICAgICAgIHB1YmxpYyBib29sZWFuIGlnbm9yZUVy\ncm9ycyA9IGZhbHNlOwogICAgICAgIHB1YmxpYyBib29sZWFuIHJlYWRTY2hl\nbWEgPSBmYWxzZTsKICAgICAgICBwdWJsaWMgYm9vbGVhbiBkcm9wVGFibGVz\nID0gZmFsc2U7CiAgICAgICAgcHVibGljIGJvb2xlYW4gb3BlbmpwYVRhYmxl\ncyA9IGZhbHNlOwogICAgICAgIHB1YmxpYyBib29sZWFuIGRyb3BTZXF1ZW5j\nZXMgPSBmYWxzZTsKICAgICAgICBwdWJsaWMgYm9vbGVhbiBzZXF1ZW5jZXMg\nPSB0cnVlOwogICAgICAgIHB1YmxpYyBib29sZWFuIHByaW1hcnlLZXlzID0g\nZmFsc2U7CiAgICAgICAgcHVibGljIGJvb2xlYW4gZm9yZWlnbktleXMgPSBm\nYWxzZTsKICAgICAgICBwdWJsaWMgYm9vbGVhbiBpbmRleGVzID0gZmFsc2U7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBIZWxwZXIgdXNlZCB0byBpbXBvcnQg\nYW5kIGV4cG9ydCBtYXBwaW5nIGRhdGEuCiAgICAgKi8KICAgIHB1YmxpYyBz\ndGF0aWMgaW50ZXJmYWNlIEltcG9ydEV4cG9ydCB7CgogICAgICAgIC8qKgog\nICAgICAgICAqIEltcG9ydCBtYXBwaW5ncyBmb3IgdGhlIGdpdmVuIGNsYXNz\nZXMgYmFzZWQgb24gdGhlIGdpdmVuIGFyZ3VtZW50cy4KICAgICAgICAgKi8K\nICAgICAgICBwdWJsaWMgYm9vbGVhbiBpbXBvcnRNYXBwaW5ncyhKREJDQ29u\nZmlndXJhdGlvbiBjb25mLCBDbGFzc1tdIGFjdCwKICAgICAgICAgICAgU3Ry\naW5nW10gYXJncywgYm9vbGVhbiBtZXRhLCBMb2cgbG9nLCBDbGFzc0xvYWRl\nciBsb2FkZXIpCiAgICAgICAgICAgIHRocm93cyBJT0V4Y2VwdGlvbjsKCiAg\nICAgICAgLyoqCiAgICAgICAgICogRXhwb3J0IG1hcHBpbmdzIGZvciB0aGUg\nZ2l2ZW4gY2xhc3NlcyBiYXNlZCBvbiB0aGUgZ2l2ZW4gYXJndW1lbnRzLgog\nICAgICAgICAqLwogICAgICAgIHB1YmxpYyBib29sZWFuIGV4cG9ydE1hcHBp\nbmdzKEpEQkNDb25maWd1cmF0aW9uIGNvbmYsIENsYXNzW10gYWN0LAogICAg\nICAgICAgICBib29sZWFuIG1ldGEsIExvZyBsb2csIFdyaXRlciB3cml0ZXIp\nCiAgICAgICAgICAgIHRocm93cyBJT0V4Y2VwdGlvbjsKICAgIH0KfQo=\n","encoding":"base64"}

