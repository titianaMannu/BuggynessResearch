{"sha":"d39d24c6216f5fdc985f8f54390fb89dbcfb794e","node_id":"MDQ6QmxvYjIwNjM2NDpkMzlkMjRjNjIxNmY1ZmRjOTg1ZjhmNTQzOTBmYjg5ZGJjZmI3OTRl","size":5003,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/d39d24c6216f5fdc985f8f54390fb89dbcfb794e","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhLnN0cmF0czsK\nCmltcG9ydCBqYXZhLnNxbC5TUUxFeGNlcHRpb247CgppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLmpkYmMua2VybmVsLkpEQkNGZXRjaENvbmZpZ3VyYXRp\nb247CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5rZXJuZWwuSkRC\nQ1N0b3JlOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0YS5D\nbGFzc01hcHBpbmc7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5t\nZXRhLkNsYXNzTWFwcGluZ0luZm87CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEuamRiYy5zY2hlbWEuQ29sdW1uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLmpkYmMuc2NoZW1hLlByaW1hcnlLZXk7CmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEuamRiYy5zY2hlbWEuVGFibGU7CmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEuamRiYy5zcWwuUm93OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLmpkYmMuc3FsLlJvd01hbmFnZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEuamRiYy5zcWwuU2VsZWN0OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLmtlcm5lbC5PcGVuSlBBU3RhdGVNYW5hZ2VyOwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLmxpYi51dGlsLkxvY2FsaXplcjsKaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS5tZXRhLkphdmFUeXBlczsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5tZXRhLlZhbHVlU3RyYXRlZ2llczsKaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS51dGlsLk1ldGFEYXRhRXhjZXB0aW9uOwoKLyoqCiAq\nIE1hcHBpbmcgZm9yIHdoZW4gdGhlIGNsYXNzIG1hcHMgYWxsIGZpZWxkcyB0\nbyBpdHMgb3duIHRhYmxlLgogKgogKiBAYXV0aG9yIEFiZSBXaGl0ZQogKi8K\ncHVibGljIGNsYXNzIEZ1bGxDbGFzc1N0cmF0ZWd5CiAgICBleHRlbmRzIEFi\nc3RyYWN0Q2xhc3NTdHJhdGVneSB7CgogICAgcHVibGljIHN0YXRpYyBmaW5h\nbCBTdHJpbmcgQUxJQVMgPSAiZnVsbCI7CgogICAgcHJpdmF0ZSBzdGF0aWMg\nZmluYWwgTG9jYWxpemVyIF9sb2MgPSBMb2NhbGl6ZXIuZm9yUGFja2FnZQog\nICAgICAgIChGdWxsQ2xhc3NTdHJhdGVneS5jbGFzcyk7CgogICAgcHVibGlj\nIFN0cmluZyBnZXRBbGlhcygpIHsKICAgICAgICByZXR1cm4gQUxJQVM7CiAg\nICB9CgogICAgcHVibGljIHZvaWQgbWFwKGJvb2xlYW4gYWRhcHQpIHsKICAg\nICAgICBpZiAoY2xzLmdldEVtYmVkZGluZ01ldGFEYXRhKCkgIT0gbnVsbCkK\nICAgICAgICAgICAgdGhyb3cgbmV3IE1ldGFEYXRhRXhjZXB0aW9uKF9sb2Mu\nZ2V0KCJub3QtZnVsbCIsIGNscykpOwoKICAgICAgICBDbGFzc01hcHBpbmcg\nc3VwID0gY2xzLmdldE1hcHBlZFBDU3VwZXJjbGFzc01hcHBpbmcoKTsKICAg\nICAgICBDbGFzc01hcHBpbmdJbmZvIGluZm8gPSBjbHMuZ2V0TWFwcGluZ0lu\nZm8oKTsKICAgICAgICBpZiAoc3VwICE9IG51bGwgJiYgaW5mby5pc0pvaW5l\nZFN1YmNsYXNzKCkpCiAgICAgICAgICAgIHRocm93IG5ldyBNZXRhRGF0YUV4\nY2VwdGlvbihfbG9jLmdldCgibm90LWZ1bGwiLCBjbHMpKTsKCiAgICAgICAg\naW5mby5hc3NlcnROb0pvaW4oY2xzLCB0cnVlKTsKICAgICAgICBpbmZvLmFz\nc2VydE5vRm9yZWlnbktleShjbHMsICFhZGFwdCk7CiAgICAgICAgaW5mby5h\nc3NlcnROb0luZGV4KGNscywgZmFsc2UpOwogICAgICAgIGluZm8uYXNzZXJ0\nTm9VbmlxdWUoY2xzLCBmYWxzZSk7CgogICAgICAgIC8vIGZpbmQgY2xhc3Mg\ndGFibGUKICAgICAgICBUYWJsZSB0YWJsZSA9IGluZm8uZ2V0VGFibGUoY2xz\nLCBhZGFwdCk7CgogICAgICAgIC8vIGZpbmQgcHJpbWFyeSBrZXkgY29sdW1u\nCiAgICAgICAgQ29sdW1uW10gcGtDb2xzID0gbnVsbDsKICAgICAgICBpZiAo\nY2xzLmdldElkZW50aXR5VHlwZSgpID09IGNscy5JRF9EQVRBU1RPUkUpIHsK\nICAgICAgICAgICAgQ29sdW1uIGlkID0gbmV3IENvbHVtbigpOwogICAgICAg\nICAgICBpZC5zZXROYW1lKCJpZCIpOwogICAgICAgICAgICBpZC5zZXRKYXZh\nVHlwZShKYXZhVHlwZXMuTE9ORyk7CiAgICAgICAgICAgIGlkLnNldENvbW1l\nbnQoImRhdGFzdG9yZSBpZCIpOwogICAgICAgICAgICBpZiAoY2xzLmdldElk\nZW50aXR5U3RyYXRlZ3koKSA9PSBWYWx1ZVN0cmF0ZWdpZXMuQVVUT0FTU0lH\nTikKICAgICAgICAgICAgICAgIGlkLnNldEF1dG9Bc3NpZ25lZCh0cnVlKTsK\nICAgICAgICAgICAgaWQuc2V0Tm90TnVsbCh0cnVlKTsKICAgICAgICAgICAg\ncGtDb2xzID0gaW5mby5nZXREYXRhU3RvcmVJZENvbHVtbnMoY2xzLCBuZXcg\nQ29sdW1uW117IGlkIH0sCiAgICAgICAgICAgICAgICB0YWJsZSwgYWRhcHQp\nOwogICAgICAgICAgICBjbHMuc2V0UHJpbWFyeUtleUNvbHVtbnMocGtDb2xz\nKTsKICAgICAgICAgICAgY2xzLnNldENvbHVtbklPKGluZm8uZ2V0Q29sdW1u\nSU8oKSk7CiAgICAgICAgfQogICAgICAgIGNscy5zZXRUYWJsZSh0YWJsZSk7\nCgogICAgICAgIC8vIGFkZCBhIHByaW1hcnkga2V5IGlmIHdlIGRvbid0IGhh\ndmUgb25lIGFscmVhZHkKICAgICAgICBQcmltYXJ5S2V5IHBrID0gdGFibGUu\nZ2V0UHJpbWFyeUtleSgpOwogICAgICAgIGlmIChwayA9PSBudWxsKSB7CiAg\nICAgICAgICAgIFN0cmluZyBwa25hbWUgPSBudWxsOwogICAgICAgICAgICBp\nZiAoYWRhcHQpCiAgICAgICAgICAgICAgICBwa25hbWUgPSBjbHMuZ2V0TWFw\ncGluZ1JlcG9zaXRvcnkoKS5nZXRNYXBwaW5nRGVmYXVsdHMoKS4KICAgICAg\nICAgICAgICAgICAgICBnZXRQcmltYXJ5S2V5TmFtZShjbHMsIHRhYmxlKTsK\nICAgICAgICAgICAgcGsgPSB0YWJsZS5hZGRQcmltYXJ5S2V5KHBrbmFtZSk7\nCiAgICAgICAgICAgIHBrLnNldExvZ2ljYWwoIWFkYXB0KTsKICAgICAgICAg\nICAgaWYgKHBrQ29scyAhPSBudWxsKQogICAgICAgICAgICAgICAgcGsuc2V0\nQ29sdW1ucyhwa0NvbHMpOwogICAgICAgIH0KCiAgICAgICAgLy8gc2V0IGpv\naW5hYmxlCiAgICAgICAgaWYgKGNscy5nZXRJZGVudGl0eVR5cGUoKSA9PSBD\nbGFzc01hcHBpbmcuSURfREFUQVNUT1JFKQogICAgICAgICAgICBjbHMuc2V0\nSm9pbmFibGUoY2xzLmdldFByaW1hcnlLZXlDb2x1bW5zKClbMF0sCiAgICAg\nICAgICAgICAgICBuZXcgSWRlbnRpdHlKb2luYWJsZShjbHMpKTsKICAgIH0K\nCiAgICBwdWJsaWMgYm9vbGVhbiBzdXBwb3J0c0VhZ2VyU2VsZWN0KFNlbGVj\ndCBzZWwsIE9wZW5KUEFTdGF0ZU1hbmFnZXIgc20sCiAgICAgICAgSkRCQ1N0\nb3JlIHN0b3JlLCBDbGFzc01hcHBpbmcgYmFzZSwgSkRCQ0ZldGNoQ29uZmln\ndXJhdGlvbiBmZXRjaCkgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0K\nCiAgICBwdWJsaWMgdm9pZCBpbnNlcnQoT3BlbkpQQVN0YXRlTWFuYWdlciBz\nbSwgSkRCQ1N0b3JlIHN0b3JlLCBSb3dNYW5hZ2VyIHJtKQogICAgICAgIHRo\ncm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIFJvdyByb3cgPSBybS5nZXRS\nb3coY2xzLmdldFRhYmxlKCksIFJvdy5BQ1RJT05fSU5TRVJULCBzbSwgdHJ1\nZSk7CiAgICAgICAgaWYgKGNscy5nZXRJZGVudGl0eVR5cGUoKSA9PSBjbHMu\nSURfREFUQVNUT1JFKQogICAgICAgICAgICByb3cuc2V0UHJpbWFyeUtleShj\nbHMuZ2V0Q29sdW1uSU8oKSwgc20pOwogICAgfQoKICAgIHB1YmxpYyB2b2lk\nIHVwZGF0ZShPcGVuSlBBU3RhdGVNYW5hZ2VyIHNtLCBKREJDU3RvcmUgc3Rv\ncmUsIFJvd01hbmFnZXIgcm0pCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlv\nbiB7CiAgICAgICAgUm93IHJvdyA9IHJtLmdldFJvdyhjbHMuZ2V0VGFibGUo\nKSwgUm93LkFDVElPTl9VUERBVEUsIHNtLCBmYWxzZSk7CiAgICAgICAgaWYg\nKHJvdyAhPSBudWxsKQogICAgICAgICAgICByb3cud2hlcmVQcmltYXJ5S2V5\nKHNtKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBkZWxldGUoT3BlbkpQQVN0\nYXRlTWFuYWdlciBzbSwgSkRCQ1N0b3JlIHN0b3JlLCBSb3dNYW5hZ2VyIHJt\nKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIFJvdyBy\nb3cgPSBybS5nZXRSb3coY2xzLmdldFRhYmxlKCksIFJvdy5BQ1RJT05fREVM\nRVRFLCBzbSwgdHJ1ZSk7CiAgICAgICAgcm93LndoZXJlUHJpbWFyeUtleShz\nbSk7CiAgICB9CgogICAgcHVibGljIGJvb2xlYW4gaXNQcmltYXJ5S2V5T2Jq\nZWN0SWQoYm9vbGVhbiBoYXNBbGwpIHsKICAgICAgICByZXR1cm4gdHJ1ZTsK\nICAgIH0KfQo=\n","encoding":"base64"}

