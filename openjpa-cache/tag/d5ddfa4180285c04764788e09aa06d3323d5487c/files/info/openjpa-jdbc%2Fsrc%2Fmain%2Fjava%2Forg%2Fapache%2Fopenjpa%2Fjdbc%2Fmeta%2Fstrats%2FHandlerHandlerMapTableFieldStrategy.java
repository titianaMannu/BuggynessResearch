{"sha":"e7859a2c4dcf9600b45aebb58e0af1584b12b435","node_id":"MDQ6QmxvYjIwNjM2NDplNzg1OWEyYzRkY2Y5NjAwYjQ1YWViYjU4ZTBhZjE1ODRiMTJiNDM1","size":9207,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/e7859a2c4dcf9600b45aebb58e0af1584b12b435","content":"LyoNCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUNCiAqIG9yIG1vcmUgY29udHJpYnV0b3Ig\nbGljZW5zZSBhZ3JlZW1lbnRzLiAgU2VlIHRoZSBOT1RJQ0UgZmlsZQ0KICog\nZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5m\nb3JtYXRpb24NCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAg\nVGhlIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUNCiAqIHRvIHlvdSB1bmRlciB0\naGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUNCiAqICJMaWNl\nbnNlIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNv\nbXBsaWFuY2UNCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFp\nbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQNCiAqDQogKiBodHRwOi8vd3d3\nLmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjANCiAqDQogKiBVbmxl\nc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGlu\nIHdyaXRpbmcsDQogKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUg\nTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbg0KICogIkFTIElTIiBCQVNJ\nUywgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZDQog\nKiBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBM\naWNlbnNlIGZvciB0aGUNCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmlu\nZyBwZXJtaXNzaW9ucyBhbmQgbGltaXRhdGlvbnMNCiAqIHVuZGVyIHRoZSBM\naWNlbnNlLg0KICovDQpwYWNrYWdlIG9yZy5hcGFjaGUub3BlbmpwYS5qZGJj\nLm1ldGEuc3RyYXRzOw0KDQppbXBvcnQgamF2YS5zcWwuKjsNCmltcG9ydCBq\nYXZhLnV0aWwuKjsNCg0KaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJj\nLmtlcm5lbC4qOw0KaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLm1l\ndGEuKjsNCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hlbWEu\nKjsNCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zcWwuKjsNCmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLio7DQppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLmxpYi51dGlsLio7DQppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLnV0aWwuKjsNCg0KLyoqDQogKiBNYXBwaW5nIGZvciBhIG1h\ncCBvZiBrZXlzIGFuZCB2YWx1ZXMgYm90aCBjb250cm9sbGVkIGJ5DQogKiB7\nQGxpbmsgVmFsdWVIYW5kbGVyfXMuDQogKg0KICogQGF1dGhvciBBYmUgV2hp\ndGUNCiAqIEBzaW5jZSAwLjQuMCwgMS4xLjANCiAqLw0KcHVibGljIGNsYXNz\nIEhhbmRsZXJIYW5kbGVyTWFwVGFibGVGaWVsZFN0cmF0ZWd5DQogICAgZXh0\nZW5kcyBNYXBUYWJsZUZpZWxkU3RyYXRlZ3kgew0KDQogICAgcHJpdmF0ZSBz\ndGF0aWMgZmluYWwgTG9jYWxpemVyIF9sb2MgPSBMb2NhbGl6ZXIuZm9yUGFj\na2FnZQ0KICAgICAgICAoSGFuZGxlckhhbmRsZXJNYXBUYWJsZUZpZWxkU3Ry\nYXRlZ3kuY2xhc3MpOw0KDQogICAgcHJpdmF0ZSBDb2x1bW5bXSBfa2NvbHMg\nPSBudWxsOw0KICAgIHByaXZhdGUgQ29sdW1uSU8gX2tpbyA9IG51bGw7DQog\nICAgcHJpdmF0ZSBib29sZWFuIF9rbG9hZCA9IGZhbHNlOw0KICAgIHByaXZh\ndGUgQ29sdW1uW10gX3Zjb2xzID0gbnVsbDsNCiAgICBwcml2YXRlIENvbHVt\nbklPIF92aW8gPSBudWxsOw0KICAgIHByaXZhdGUgYm9vbGVhbiBfdmxvYWQg\nPSBmYWxzZTsNCg0KICAgIHB1YmxpYyBDb2x1bW5bXSBnZXRLZXlDb2x1bW5z\nKENsYXNzTWFwcGluZyBjbHMpIHsNCiAgICAgICAgcmV0dXJuIF9rY29sczsN\nCiAgICB9DQoNCiAgICBwdWJsaWMgQ29sdW1uW10gZ2V0VmFsdWVDb2x1bW5z\nKENsYXNzTWFwcGluZyBjbHMpIHsNCiAgICAgICAgcmV0dXJuIF92Y29sczsN\nCiAgICB9DQoNCiAgICBwdWJsaWMgdm9pZCBzZWxlY3RLZXkoU2VsZWN0IHNl\nbCwgQ2xhc3NNYXBwaW5nIGNscywgT3BlbkpQQVN0YXRlTWFuYWdlciBzbSwN\nCiAgICAgICAgSkRCQ1N0b3JlIHN0b3JlLCBKREJDRmV0Y2hDb25maWd1cmF0\naW9uIGZldGNoLCBKb2lucyBqb2lucykgew0KICAgICAgICBzZWwuc2VsZWN0\nKF9rY29scywgam9pbnMpOw0KICAgIH0NCg0KICAgIHB1YmxpYyB2b2lkIHNl\nbGVjdFZhbHVlKFNlbGVjdCBzZWwsIENsYXNzTWFwcGluZyBjbHMsDQogICAg\nICAgIE9wZW5KUEFTdGF0ZU1hbmFnZXIgc20sDQogICAgICAgIEpEQkNTdG9y\nZSBzdG9yZSwgSkRCQ0ZldGNoQ29uZmlndXJhdGlvbiBmZXRjaCwgSm9pbnMg\nam9pbnMpIHsNCiAgICAgICAgc2VsLnNlbGVjdChfdmNvbHMsIGpvaW5zKTsN\nCiAgICB9DQoNCiAgICBwdWJsaWMgUmVzdWx0W10gZ2V0UmVzdWx0cyhPcGVu\nSlBBU3RhdGVNYW5hZ2VyIHNtLCBKREJDU3RvcmUgc3RvcmUsDQogICAgICAg\nIEpEQkNGZXRjaENvbmZpZ3VyYXRpb24gZmV0Y2gsIGludCBlYWdlck1vZGUs\nIEpvaW5zW10gam9pbnMsIGJvb2xlYW4gbHJzKQ0KICAgICAgICB0aHJvd3Mg\nU1FMRXhjZXB0aW9uIHsNCiAgICAgICAgU2VsZWN0IHNlbCA9IHN0b3JlLmdl\ndFNRTEZhY3RvcnkoKS5uZXdTZWxlY3QoKTsNCiAgICAgICAgc2VsLnNldExS\nUyhscnMpOw0KICAgICAgICBzZWwuc2VsZWN0KF9rY29scyk7DQogICAgICAg\nIHNlbC5zZWxlY3QoX3Zjb2xzKTsNCiAgICAgICAgc2VsLndoZXJlRm9yZWln\nbktleShmaWVsZC5nZXRKb2luRm9yZWlnbktleSgpLCBzbS5nZXRPYmplY3RJ\nZCgpLA0KICAgICAgICAgICAgZmllbGQuZ2V0RGVmaW5pbmdNYXBwaW5nKCks\nIHN0b3JlKTsNCiAgICAgICAgUmVzdWx0IHJlcyA9IHNlbC5leGVjdXRlKHN0\nb3JlLCBmZXRjaCk7DQogICAgICAgIHJldHVybiBuZXcgUmVzdWx0W117IHJl\ncywgcmVzIH07DQogICAgfQ0KDQogICAgcHVibGljIE9iamVjdCBsb2FkS2V5\nKE9wZW5KUEFTdGF0ZU1hbmFnZXIgc20sIEpEQkNTdG9yZSBzdG9yZSwNCiAg\nICAgICAgSkRCQ0ZldGNoQ29uZmlndXJhdGlvbiBmZXRjaCwgUmVzdWx0IHJl\ncywgSm9pbnMgam9pbnMpDQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24g\new0KICAgICAgICByZXR1cm4gSGFuZGxlclN0cmF0ZWdpZXMubG9hZE9iamVj\ndChmaWVsZC5nZXRLZXlNYXBwaW5nKCksDQogICAgICAgICAgICBzbSwgc3Rv\ncmUsIGZldGNoLCByZXMsIGpvaW5zLCBfa2NvbHMsIF9rbG9hZCk7DQogICAg\nfQ0KDQogICAgcHVibGljIE9iamVjdCBsb2FkVmFsdWUoT3BlbkpQQVN0YXRl\nTWFuYWdlciBzbSwgSkRCQ1N0b3JlIHN0b3JlLA0KICAgICAgICBKREJDRmV0\nY2hDb25maWd1cmF0aW9uIGZldGNoLCBSZXN1bHQgcmVzLCBKb2lucyBqb2lu\ncykNCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7DQogICAgICAgIHJl\ndHVybiBIYW5kbGVyU3RyYXRlZ2llcy5sb2FkT2JqZWN0KGZpZWxkLmdldEVs\nZW1lbnRNYXBwaW5nKCksDQogICAgICAgICAgICBzbSwgc3RvcmUsIGZldGNo\nLCByZXMsIGpvaW5zLCBfdmNvbHMsIF92bG9hZCk7DQogICAgfQ0KDQogICAg\ncHVibGljIHZvaWQgbWFwKGJvb2xlYW4gYWRhcHQpIHsNCiAgICAgICAgc3Vw\nZXIubWFwKGFkYXB0KTsNCg0KICAgICAgICBWYWx1ZU1hcHBpbmcga2V5ID0g\nZmllbGQuZ2V0S2V5TWFwcGluZygpOw0KICAgICAgICBpZiAoa2V5LmdldEhh\nbmRsZXIoKSA9PSBudWxsKQ0KICAgICAgICAgICAgdGhyb3cgbmV3IE1ldGFE\nYXRhRXhjZXB0aW9uKF9sb2MuZ2V0KCJuby1oYW5kbGVyIiwga2V5KSk7DQog\nICAgICAgIFZhbHVlTWFwcGluZyB2YWwgPSBmaWVsZC5nZXRFbGVtZW50TWFw\ncGluZygpOw0KICAgICAgICBpZiAodmFsLmdldEhhbmRsZXIoKSA9PSBudWxs\nKQ0KICAgICAgICAgICAgdGhyb3cgbmV3IE1ldGFEYXRhRXhjZXB0aW9uKF9s\nb2MuZ2V0KCJuby1oYW5kbGVyIiwgdmFsKSk7DQogICAgICAgIGFzc2VydE5v\ndE1hcHBlZEJ5KCk7DQoNCiAgICAgICAgZmllbGQubWFwSm9pbihhZGFwdCwg\ndHJ1ZSk7DQogICAgICAgIF9raW8gPSBuZXcgQ29sdW1uSU8oKTsNCiAgICAg\nICAgREJEaWN0aW9uYXJ5IGRpY3QgPSBmaWVsZC5nZXRNYXBwaW5nUmVwb3Np\ndG9yeSgpLmdldERCRGljdGlvbmFyeSgpOw0KICAgICAgICBfa2NvbHMgPSBI\nYW5kbGVyU3RyYXRlZ2llcy5tYXAoa2V5LCANCiAgICAgICAgICAgIGRpY3Qu\nZ2V0VmFsaWRDb2x1bW5OYW1lKCJrZXkiLCBmaWVsZC5nZXRUYWJsZSgpKSwg\nX2tpbywgYWRhcHQpOw0KDQogICAgICAgIF92aW8gPSBuZXcgQ29sdW1uSU8o\nKTsNCiAgICAgICAgX3Zjb2xzID0gSGFuZGxlclN0cmF0ZWdpZXMubWFwKHZh\nbCwgInZhbHVlIiwgX3ZpbywgYWRhcHQpOw0KICAgICAgICBmaWVsZC5tYXBQ\ncmltYXJ5S2V5KGFkYXB0KTsNCiAgICB9DQoNCiAgICBwdWJsaWMgdm9pZCBp\nbml0aWFsaXplKCkgew0KICAgICAgICBfa2xvYWQgPSBmaWVsZC5nZXRLZXlN\nYXBwaW5nKCkuZ2V0SGFuZGxlcigpLg0KICAgICAgICAgICAgb2JqZWN0VmFs\ndWVSZXF1aXJlc0xvYWQoZmllbGQuZ2V0S2V5TWFwcGluZygpKTsNCiAgICAg\nICAgX3Zsb2FkID0gZmllbGQuZ2V0RWxlbWVudE1hcHBpbmcoKS5nZXRIYW5k\nbGVyKCkuDQogICAgICAgICAgICBvYmplY3RWYWx1ZVJlcXVpcmVzTG9hZChm\naWVsZC5nZXRFbGVtZW50TWFwcGluZygpKTsNCiAgICB9DQoNCiAgICBwdWJs\naWMgdm9pZCBpbnNlcnQoT3BlbkpQQVN0YXRlTWFuYWdlciBzbSwgSkRCQ1N0\nb3JlIHN0b3JlLCBSb3dNYW5hZ2VyIHJtKQ0KICAgICAgICB0aHJvd3MgU1FM\nRXhjZXB0aW9uIHsNCiAgICAgICAgaW5zZXJ0KHNtLCBzdG9yZSwgcm0sIChN\nYXApIHNtLmZldGNoT2JqZWN0KGZpZWxkLmdldEluZGV4KCkpKTsNCiAgICB9\nDQoNCiAgICBwcml2YXRlIHZvaWQgaW5zZXJ0KE9wZW5KUEFTdGF0ZU1hbmFn\nZXIgc20sIEpEQkNTdG9yZSBzdG9yZSwgUm93TWFuYWdlciBybSwNCiAgICAg\nICAgTWFwIG1hcCkNCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7DQog\nICAgICAgIGlmIChtYXAgPT0gbnVsbCB8fCBtYXAuaXNFbXB0eSgpKQ0KICAg\nICAgICAgICAgcmV0dXJuOw0KDQogICAgICAgIFJvdyByb3cgPSBybS5nZXRT\nZWNvbmRhcnlSb3coZmllbGQuZ2V0VGFibGUoKSwgUm93LkFDVElPTl9JTlNF\nUlQpOw0KICAgICAgICByb3cuc2V0Rm9yZWlnbktleShmaWVsZC5nZXRKb2lu\nRm9yZWlnbktleSgpLCBmaWVsZC5nZXRKb2luQ29sdW1uSU8oKSwNCiAgICAg\nICAgICAgIHNtKTsNCg0KICAgICAgICBWYWx1ZU1hcHBpbmcga2V5ID0gZmll\nbGQuZ2V0S2V5TWFwcGluZygpOw0KICAgICAgICBWYWx1ZU1hcHBpbmcgdmFs\nID0gZmllbGQuZ2V0RWxlbWVudE1hcHBpbmcoKTsNCiAgICAgICAgTWFwLkVu\ndHJ5IGVudHJ5Ow0KICAgICAgICBmb3IgKEl0ZXJhdG9yIGl0ciA9IG1hcC5l\nbnRyeVNldCgpLml0ZXJhdG9yKCk7IGl0ci5oYXNOZXh0KCk7KSB7DQogICAg\nICAgICAgICBlbnRyeSA9IChNYXAuRW50cnkpIGl0ci5uZXh0KCk7DQogICAg\nICAgICAgICBIYW5kbGVyU3RyYXRlZ2llcy5zZXQoa2V5LCBlbnRyeS5nZXRL\nZXkoKSwgc3RvcmUsIHJvdywgX2tjb2xzLA0KICAgICAgICAgICAgICAgIF9r\naW8sIHRydWUpOw0KICAgICAgICAgICAgSGFuZGxlclN0cmF0ZWdpZXMuc2V0\nKHZhbCwgZW50cnkuZ2V0VmFsdWUoKSwgc3RvcmUsIHJvdywgX3Zjb2xzLA0K\nICAgICAgICAgICAgICAgIF92aW8sIHRydWUpOw0KICAgICAgICAgICAgcm0u\nZmx1c2hTZWNvbmRhcnlSb3cocm93KTsNCiAgICAgICAgfQ0KICAgIH0NCg0K\nICAgIHB1YmxpYyB2b2lkIHVwZGF0ZShPcGVuSlBBU3RhdGVNYW5hZ2VyIHNt\nLCBKREJDU3RvcmUgc3RvcmUsIFJvd01hbmFnZXIgcm0pDQogICAgICAgIHRo\ncm93cyBTUUxFeGNlcHRpb24gew0KICAgICAgICBNYXAgbWFwID0gKE1hcCkg\nc20uZmV0Y2hPYmplY3QoZmllbGQuZ2V0SW5kZXgoKSk7DQogICAgICAgIENo\nYW5nZVRyYWNrZXIgY3QgPSBudWxsOw0KICAgICAgICBpZiAobWFwIGluc3Rh\nbmNlb2YgUHJveHkpIHsNCiAgICAgICAgICAgIFByb3h5IHByb3h5ID0gKFBy\nb3h5KSBtYXA7DQogICAgICAgICAgICBpZiAoUHJveGllcy5pc093bmVyKHBy\nb3h5LCBzbSwgZmllbGQuZ2V0SW5kZXgoKSkpDQogICAgICAgICAgICAgICAg\nY3QgPSBwcm94eS5nZXRDaGFuZ2VUcmFja2VyKCk7DQogICAgICAgIH0NCg0K\nICAgICAgICAvLyBpZiBubyBmaW5lLWdyYWluZWQgY2hhbmdlIHRyYWNraW5n\nIHRoZW4ganVzdCBkZWxldGUgYW5kIHJlaW5zZXJ0DQogICAgICAgIGlmIChj\ndCA9PSBudWxsIHx8ICFjdC5pc1RyYWNraW5nKCkpIHsNCiAgICAgICAgICAg\nIGRlbGV0ZShzbSwgc3RvcmUsIHJtKTsNCiAgICAgICAgICAgIGluc2VydChz\nbSwgc3RvcmUsIHJtLCBtYXApOw0KICAgICAgICAgICAgcmV0dXJuOw0KICAg\nICAgICB9DQoNCiAgICAgICAgLy8gZGVsZXRlIHRoZSByZW1vdmVzDQogICAg\nICAgIFZhbHVlTWFwcGluZyBrZXkgPSBmaWVsZC5nZXRLZXlNYXBwaW5nKCk7\nDQogICAgICAgIENvbGxlY3Rpb24gcmVtID0gY3QuZ2V0UmVtb3ZlZCgpOw0K\nICAgICAgICBpZiAoIXJlbS5pc0VtcHR5KCkpIHsNCiAgICAgICAgICAgIFJv\ndyBkZWxSb3cgPSBybS5nZXRTZWNvbmRhcnlSb3coZmllbGQuZ2V0VGFibGUo\nKSwNCiAgICAgICAgICAgICAgICBSb3cuQUNUSU9OX0RFTEVURSk7DQogICAg\nICAgICAgICBkZWxSb3cud2hlcmVGb3JlaWduS2V5KGZpZWxkLmdldEpvaW5G\nb3JlaWduS2V5KCksIHNtKTsNCiAgICAgICAgICAgIGZvciAoSXRlcmF0b3Ig\naXRyID0gcmVtLml0ZXJhdG9yKCk7IGl0ci5oYXNOZXh0KCk7KSB7DQogICAg\nICAgICAgICAgICAgSGFuZGxlclN0cmF0ZWdpZXMud2hlcmUoa2V5LCBpdHIu\nbmV4dCgpLCBzdG9yZSwgZGVsUm93LA0KICAgICAgICAgICAgICAgICAgICBf\na2NvbHMpOw0KICAgICAgICAgICAgICAgIHJtLmZsdXNoU2Vjb25kYXJ5Um93\nKGRlbFJvdyk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAg\nICAvLyBpbnNlcnQgdGhlIGFkZHMNCiAgICAgICAgVmFsdWVNYXBwaW5nIHZh\nbCA9IGZpZWxkLmdldEVsZW1lbnRNYXBwaW5nKCk7DQogICAgICAgIENvbGxl\nY3Rpb24gYWRkID0gY3QuZ2V0QWRkZWQoKTsNCiAgICAgICAgT2JqZWN0IG1r\nZXk7DQogICAgICAgIGlmICghYWRkLmlzRW1wdHkoKSkgew0KICAgICAgICAg\nICAgUm93IGFkZFJvdyA9IHJtLmdldFNlY29uZGFyeVJvdyhmaWVsZC5nZXRU\nYWJsZSgpLA0KICAgICAgICAgICAgICAgIFJvdy5BQ1RJT05fSU5TRVJUKTsN\nCiAgICAgICAgICAgIGFkZFJvdy5zZXRGb3JlaWduS2V5KGZpZWxkLmdldEpv\naW5Gb3JlaWduS2V5KCksDQogICAgICAgICAgICAgICAgZmllbGQuZ2V0Sm9p\nbkNvbHVtbklPKCksIHNtKTsNCg0KICAgICAgICAgICAgZm9yIChJdGVyYXRv\nciBpdHIgPSBhZGQuaXRlcmF0b3IoKTsgaXRyLmhhc05leHQoKTspIHsNCiAg\nICAgICAgICAgICAgICBta2V5ID0gaXRyLm5leHQoKTsNCiAgICAgICAgICAg\nICAgICBIYW5kbGVyU3RyYXRlZ2llcy5zZXQoa2V5LCBta2V5LCBzdG9yZSwg\nYWRkUm93LCBfa2NvbHMsDQogICAgICAgICAgICAgICAgICAgIF9raW8sIHRy\ndWUpOw0KICAgICAgICAgICAgICAgIEhhbmRsZXJTdHJhdGVnaWVzLnNldCh2\nYWwsIG1hcC5nZXQobWtleSksIHN0b3JlLCBhZGRSb3csDQogICAgICAgICAg\nICAgICAgICAgIF92Y29scywgX3ZpbywgdHJ1ZSk7DQogICAgICAgICAgICAg\nICAgcm0uZmx1c2hTZWNvbmRhcnlSb3coYWRkUm93KTsNCiAgICAgICAgICAg\nIH0NCiAgICAgICAgfQ0KDQogICAgICAgIC8vIHVwZGF0ZSB0aGUgY2hhbmdl\ncw0KICAgICAgICBDb2xsZWN0aW9uIGNoYW5nZSA9IGN0LmdldENoYW5nZWQo\nKTsNCiAgICAgICAgaWYgKCFjaGFuZ2UuaXNFbXB0eSgpKSB7DQogICAgICAg\nICAgICBSb3cgY2hhbmdlUm93ID0gcm0uZ2V0U2Vjb25kYXJ5Um93KGZpZWxk\nLmdldFRhYmxlKCksDQogICAgICAgICAgICAgICAgUm93LkFDVElPTl9VUERB\nVEUpOw0KICAgICAgICAgICAgY2hhbmdlUm93LndoZXJlRm9yZWlnbktleShm\naWVsZC5nZXRKb2luRm9yZWlnbktleSgpLCBzbSk7DQoNCiAgICAgICAgICAg\nIGZvciAoSXRlcmF0b3IgaXRyID0gY2hhbmdlLml0ZXJhdG9yKCk7IGl0ci5o\nYXNOZXh0KCk7KSB7DQogICAgICAgICAgICAgICAgbWtleSA9IGl0ci5uZXh0\nKCk7DQogICAgICAgICAgICAgICAgSGFuZGxlclN0cmF0ZWdpZXMud2hlcmUo\na2V5LCBta2V5LCBzdG9yZSwgY2hhbmdlUm93LCBfa2NvbHMpOw0KICAgICAg\nICAgICAgICAgIEhhbmRsZXJTdHJhdGVnaWVzLnNldCh2YWwsIG1hcC5nZXQo\nbWtleSksIHN0b3JlLCBjaGFuZ2VSb3csDQogICAgICAgICAgICAgICAgICAg\nIF92Y29scywgX3ZpbywgdHJ1ZSk7DQogICAgICAgICAgICAgICAgcm0uZmx1\nc2hTZWNvbmRhcnlSb3coY2hhbmdlUm93KTsNCiAgICAgICAgICAgIH0NCiAg\nICAgICAgfQ0KICAgIH0NCg0KICAgIHB1YmxpYyBPYmplY3QgdG9EYXRhU3Rv\ncmVWYWx1ZShPYmplY3QgdmFsLCBKREJDU3RvcmUgc3RvcmUpIHsNCiAgICAg\nICAgcmV0dXJuIEhhbmRsZXJTdHJhdGVnaWVzLnRvRGF0YVN0b3JlVmFsdWUo\nZmllbGQuZ2V0RWxlbWVudE1hcHBpbmcoKSwNCiAgICAgICAgICAgIHZhbCwg\nX3Zjb2xzLCBzdG9yZSk7DQogICAgfQ0KDQogICAgcHVibGljIE9iamVjdCB0\nb0tleURhdGFTdG9yZVZhbHVlKE9iamVjdCB2YWwsIEpEQkNTdG9yZSBzdG9y\nZSkgew0KICAgICAgICByZXR1cm4gSGFuZGxlclN0cmF0ZWdpZXMudG9EYXRh\nU3RvcmVWYWx1ZShmaWVsZC5nZXRLZXlNYXBwaW5nKCksIHZhbCwNCiAgICAg\nICAgICAgIF9rY29scywgc3RvcmUpOw0KICAgIH0NCg0KICAgIHB1YmxpYyBK\nb2lucyBqb2luUmVsYXRpb24oSm9pbnMgam9pbnMsIGJvb2xlYW4gZm9yY2VP\ndXRlciwNCiAgICAgICAgYm9vbGVhbiB0cmF2ZXJzZSkgew0KICAgICAgICBp\nZiAodHJhdmVyc2UpDQogICAgICAgICAgICBIYW5kbGVyU3RyYXRlZ2llcy5h\nc3NlcnRKb2luYWJsZShmaWVsZC5nZXRFbGVtZW50TWFwcGluZygpKTsNCiAg\nICAgICAgcmV0dXJuIGpvaW5zOw0KICAgIH0NCg0KICAgIHB1YmxpYyBKb2lu\ncyBqb2luS2V5UmVsYXRpb24oSm9pbnMgam9pbnMsIGJvb2xlYW4gZm9yY2VP\ndXRlciwNCiAgICAgICAgYm9vbGVhbiB0cmF2ZXJzZSkgew0KICAgICAgICBp\nZiAodHJhdmVyc2UpDQogICAgICAgICAgICBIYW5kbGVyU3RyYXRlZ2llcy5h\nc3NlcnRKb2luYWJsZShmaWVsZC5nZXRLZXlNYXBwaW5nKCkpOw0KICAgICAg\nICByZXR1cm4gam9pbnM7DQogICAgfQ0KfQ0K\n","encoding":"base64"}

