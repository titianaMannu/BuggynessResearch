{"sha":"a79522a7d0bfc5d0c8e339944005acfb772934cd","node_id":"MDQ6QmxvYjIwNjM2NDphNzk1MjJhN2QwYmZjNWQwYzhlMzM5OTQ0MDA1YWNmYjc3MjkzNGNk","size":20424,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/a79522a7d0bfc5d0c8e339944005acfb772934cd","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hlbWE7CgppbXBv\ncnQgamF2YS5pby5GaWxlOwppbXBvcnQgamF2YS51dGlsLkFycmF5TGlzdDsK\naW1wb3J0IGphdmEudXRpbC5Db2xsZWN0aW9uOwppbXBvcnQgamF2YS51dGls\nLkl0ZXJhdG9yOwppbXBvcnQgamF2YS51dGlsLk1hcDsKaW1wb3J0IGphdmEu\ndXRpbC5UcmVlTWFwOwppbXBvcnQgamF2YS51dGlsLkxpbmtlZEhhc2hNYXA7\nCgppbXBvcnQgb3JnLmFwYWNoZS5jb21tb25zLmxhbmcuU3RyaW5nVXRpbHM7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLm1ldGEuU291cmNlVHJh\nY2tlcjsKCi8qKgogKiBSZXByZXNlbnRzIGEgZGF0YWJhc2UgdGFibGUuCiAq\nCiAqIEBhdXRob3IgQWJlIFdoaXRlCiAqIEBhdXRob3IgU3RlcGhlbiBLaW0K\nICovCnB1YmxpYyBjbGFzcyBUYWJsZQogICAgZXh0ZW5kcyBOYW1lU2V0CiAg\nICBpbXBsZW1lbnRzIENvbXBhcmFibGUsIFNvdXJjZVRyYWNrZXIgewoKICAg\nIHByaXZhdGUgU3RyaW5nIF9uYW1lID0gbnVsbDsKICAgIHByaXZhdGUgU3Ry\naW5nIF9zY2hlbWFOYW1lID0gbnVsbDsKICAgIHByaXZhdGUgTWFwIF9jb2xN\nYXAgPSBudWxsOwogICAgcHJpdmF0ZSBNYXAgX2lkeE1hcCA9IG51bGw7CiAg\nICBwcml2YXRlIENvbGxlY3Rpb24gX2ZrTGlzdCA9IG51bGw7CiAgICBwcml2\nYXRlIENvbGxlY3Rpb24gX3VucUxpc3QgPSBudWxsOwogICAgcHJpdmF0ZSBT\nY2hlbWEgX3NjaGVtYSA9IG51bGw7CiAgICBwcml2YXRlIFByaW1hcnlLZXkg\nX3BrID0gbnVsbDsKCiAgICAvLyBrZWVwIHRyYWNrIG9mIHNvdXJjZQogICAg\ncHJpdmF0ZSBGaWxlIF9zb3VyY2UgPSBudWxsOwogICAgcHJpdmF0ZSBpbnQg\nX3NyY1R5cGUgPSBTUkNfT1RIRVI7CgogICAgLy8gY2FjaGUKICAgIHByaXZh\ndGUgU3RyaW5nIF9mdWxsTmFtZSA9IG51bGw7CiAgICBwcml2YXRlIENvbHVt\nbltdIF9jb2xzID0gbnVsbDsKICAgIHByaXZhdGUgQ29sdW1uW10gX2F1dG9B\nc3NpZ24gPSBudWxsOwogICAgcHJpdmF0ZSBDb2x1bW5bXSBfcmVscyA9IG51\nbGw7CiAgICBwcml2YXRlIEZvcmVpZ25LZXlbXSBfZmtzID0gbnVsbDsKICAg\nIHByaXZhdGUgSW5kZXhbXSBfaWR4cyA9IG51bGw7CiAgICBwcml2YXRlIFVu\naXF1ZVtdIF91bnFzID0gbnVsbDsKICAgIHByaXZhdGUgU3RyaW5nIF9jb21t\nZW50ID0gbnVsbDsKCiAgICAvKioKICAgICAqIERlZmF1bHQgY29uc3RydWN0\nb3IuCiAgICAgKi8KICAgIHB1YmxpYyBUYWJsZSgpIHsKICAgIH0KCiAgICAv\nKioKICAgICAqIENvbnN0cnVjdG9yLgogICAgICoKICAgICAqIEBwYXJhbSBu\nYW1lIHRoZSB0YWJsZSBuYW1lCiAgICAgKiBAcGFyYW0gc2NoZW1hIHRoZSB0\nYWJsZSBzY2hlbWEKICAgICAqLwogICAgcHVibGljIFRhYmxlKFN0cmluZyBu\nYW1lLCBTY2hlbWEgc2NoZW1hKSB7CiAgICAgICAgc2V0TmFtZShuYW1lKTsK\nICAgICAgICBhZGROYW1lKG5hbWUsIHRydWUpOwogICAgICAgIGlmIChzY2hl\nbWEgIT0gbnVsbCkKICAgICAgICAgICAgc2V0U2NoZW1hTmFtZShzY2hlbWEu\nZ2V0TmFtZSgpKTsKICAgICAgICBfc2NoZW1hID0gc2NoZW1hOwogICAgfQoK\nICAgIC8qKgogICAgICogQ2FsbGVkIHdoZW4gdGhlIHRhYmxlIGlzIHJlbW92\nZWQgZnJvbSBpdHMgc2NoZW1hLiBSZW1vdmVzIGFsbCB0YWJsZQogICAgICog\nbWVtYmVycywgYW5kIGludmFsaWRhdGVzIHRoZSB0YWJsZS4KICAgICAqLwog\nICAgdm9pZCByZW1vdmUoKSB7CiAgICAgICAgRm9yZWlnbktleVtdIGZrcyA9\nIGdldEZvcmVpZ25LZXlzKCk7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkg\nPCBma3MubGVuZ3RoOyBpKyspCiAgICAgICAgICAgIHJlbW92ZUZvcmVpZ25L\nZXkoZmtzW2ldKTsKICAgICAgICBJbmRleFtdIGlkeHMgPSBnZXRJbmRleGVz\nKCk7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBpZHhzLmxlbmd0aDsg\naSsrKQogICAgICAgICAgICByZW1vdmVJbmRleChpZHhzW2ldKTsKICAgICAg\nICBVbmlxdWVbXSB1bnFzID0gZ2V0VW5pcXVlcygpOwogICAgICAgIGZvciAo\naW50IGkgPSAwOyBpIDwgdW5xcy5sZW5ndGg7IGkrKykKICAgICAgICAgICAg\ncmVtb3ZlVW5pcXVlKHVucXNbaV0pOwogICAgICAgIHJlbW92ZVByaW1hcnlL\nZXkoKTsKICAgICAgICBDb2x1bW5bXSBjb2xzID0gZ2V0Q29sdW1ucygpOwog\nICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgY29scy5sZW5ndGg7IGkrKykK\nICAgICAgICAgICAgcmVtb3ZlQ29sdW1uKGNvbHNbaV0pOwogICAgICAgIF9z\nY2hlbWEgPSBudWxsOwogICAgICAgIF9zY2hlbWFOYW1lID0gbnVsbDsKICAg\nICAgICBfZnVsbE5hbWUgPSBudWxsOwogICAgfQoKICAgIC8qKgogICAgICog\nUmV0dXJuIHRoZSBzY2hlbWEgZm9yIHRoZSB0YWJsZS4KICAgICAqLwogICAg\ncHVibGljIFNjaGVtYSBnZXRTY2hlbWEoKSB7CiAgICAgICAgcmV0dXJuIF9z\nY2hlbWE7CiAgICB9CgogICAgLyoqCiAgICAgKiBUaGUgdGFibGUncyBzY2hl\nbWEgbmFtZS4KICAgICAqLwogICAgcHVibGljIFN0cmluZyBnZXRTY2hlbWFO\nYW1lKCkgewogICAgICAgIHJldHVybiBfc2NoZW1hTmFtZTsKICAgIH0KCiAg\nICAvKioKICAgICAqIFRoZSB0YWJsZSdzIHNjaGVtYSBuYW1lLiBZb3UgY2Fu\nIG9ubHkgY2FsbCB0aGlzIG1ldGhvZCBvbiB0YWJsZXMKICAgICAqIHdob3Nl\nIHNjaGVtYSBvYmplY3QgaXMgbm90IHNldC4KICAgICAqLwogICAgcHVibGlj\nIHZvaWQgc2V0U2NoZW1hTmFtZShTdHJpbmcgbmFtZSkgewogICAgICAgIGlm\nIChnZXRTY2hlbWEoKSAhPSBudWxsKQogICAgICAgICAgICB0aHJvdyBuZXcg\nSWxsZWdhbFN0YXRlRXhjZXB0aW9uKCk7CiAgICAgICAgX3NjaGVtYU5hbWUg\nPSBuYW1lOwogICAgICAgIF9mdWxsTmFtZSA9IG51bGw7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBSZXR1cm4gdGhlIG5hbWUgb2YgdGhlIHRhYmxlLgogICAg\nICovCiAgICBwdWJsaWMgU3RyaW5nIGdldE5hbWUoKSB7CiAgICAgICAgcmV0\ndXJuIF9uYW1lOwogICAgfQoKICAgIC8qKgogICAgICogU2V0IHRoZSBuYW1l\nIG9mIHRoZSB0YWJsZS4gVGhpcyBtZXRob2QgY2FuIG9ubHkgYmUgY2FsbGVk\nIG9uIHRhYmxlcwogICAgICogdGhhdCBhcmUgbm90IHBhcnQgb2YgYSBzY2hl\nbWEuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldE5hbWUoU3RyaW5nIG5h\nbWUpIHsKICAgICAgICBpZiAoZ2V0U2NoZW1hKCkgIT0gbnVsbCkKICAgICAg\nICAgICAgdGhyb3cgbmV3IElsbGVnYWxTdGF0ZUV4Y2VwdGlvbigpOwogICAg\nICAgIF9uYW1lID0gbmFtZTsKICAgICAgICBfZnVsbE5hbWUgPSBudWxsOwog\nICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRoZSB0YWJsZSBuYW1lLCBp\nbmNsdWRpbmcgc2NoZW1hLCB1c2luZyAnLicgYXMgdGhlCiAgICAgKiBjYXRh\nbG9nIHNlcGFyYXRvci4KICAgICAqLwogICAgcHVibGljIFN0cmluZyBnZXRG\ndWxsTmFtZSgpIHsKICAgICAgICBpZiAoX2Z1bGxOYW1lID09IG51bGwpIHsK\nICAgICAgICAgICAgU2NoZW1hIHNjaGVtYSA9IGdldFNjaGVtYSgpOwogICAg\nICAgICAgICBpZiAoc2NoZW1hID09IG51bGwgfHwgc2NoZW1hLmdldE5hbWUo\nKSA9PSBudWxsKQogICAgICAgICAgICAgICAgX2Z1bGxOYW1lID0gZ2V0TmFt\nZSgpOwogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICBfZnVsbE5h\nbWUgPSBzY2hlbWEuZ2V0TmFtZSgpICsgIi4iICsgZ2V0TmFtZSgpOwogICAg\nICAgIH0KICAgICAgICByZXR1cm4gX2Z1bGxOYW1lOwogICAgfQoKICAgIHB1\nYmxpYyBGaWxlIGdldFNvdXJjZUZpbGUoKSB7CiAgICAgICAgcmV0dXJuIF9z\nb3VyY2U7CiAgICB9CgogICAgcHVibGljIE9iamVjdCBnZXRTb3VyY2VTY29w\nZSgpIHsKICAgICAgICByZXR1cm4gbnVsbDsKICAgIH0KCiAgICBwdWJsaWMg\naW50IGdldFNvdXJjZVR5cGUoKSB7CiAgICAgICAgcmV0dXJuIF9zcmNUeXBl\nOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldFNvdXJjZShGaWxlIHNvdXJj\nZSwgaW50IHNyY1R5cGUpIHsKICAgICAgICBfc291cmNlID0gc291cmNlOwog\nICAgICAgIF9zcmNUeXBlID0gc3JjVHlwZTsKICAgIH0KCiAgICBwdWJsaWMg\nU3RyaW5nIGdldFJlc291cmNlTmFtZSgpIHsKICAgICAgICByZXR1cm4gZ2V0\nRnVsbE5hbWUoKTsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0aGUg\ndGFibGUncyBjb2x1bW5zLCBpbiBhbHBoYWJldGljYWwgb3JkZXIuCiAgICAg\nKi8KICAgIHB1YmxpYyBDb2x1bW5bXSBnZXRDb2x1bW5zKCkgewogICAgICAg\nIGlmIChfY29scyA9PSBudWxsKSB7CiAgICAgICAgICAgIGlmIChfY29sTWFw\nID09IG51bGwpCiAgICAgICAgICAgICAgICBfY29scyA9IFNjaGVtYXMuRU1Q\nVFlfQ09MVU1OUzsKICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAg\nICBDb2x1bW5bXSBjb2xzID0gbmV3IENvbHVtbltfY29sTWFwLnNpemUoKV07\nCiAgICAgICAgICAgICAgICBJdGVyYXRvciBpdHIgPSBfY29sTWFwLnZhbHVl\ncygpLml0ZXJhdG9yKCk7CiAgICAgICAgICAgICAgICBmb3IgKGludCBpID0g\nMDsgaXRyLmhhc05leHQoKTsgaSsrKSB7CiAgICAgICAgICAgICAgICAgICAg\nY29sc1tpXSA9IChDb2x1bW4pIGl0ci5uZXh0KCk7CiAgICAgICAgICAgICAg\nICAgICAgY29sc1tpXS5zZXRJbmRleChpKTsKICAgICAgICAgICAgICAgIH0K\nICAgICAgICAgICAgICAgIF9jb2xzID0gY29sczsKICAgICAgICAgICAgfQog\nICAgICAgIH0KICAgICAgICByZXR1cm4gX2NvbHM7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBSZXR1cm4gdGhpcyB0YWJsZSdzIGF1dG8tYXNzaWduZWQgY29s\ndW1ucy4KICAgICAqLwogICAgcHVibGljIENvbHVtbltdIGdldEF1dG9Bc3Np\nZ25lZENvbHVtbnMoKSB7CiAgICAgICAgaWYgKF9hdXRvQXNzaWduID09IG51\nbGwpIHsKICAgICAgICAgICAgaWYgKF9jb2xNYXAgPT0gbnVsbCkKICAgICAg\nICAgICAgICAgIF9hdXRvQXNzaWduID0gU2NoZW1hcy5FTVBUWV9DT0xVTU5T\nOwogICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgIENvbGxlY3Rp\nb24gYXV0b3MgPSBudWxsOwogICAgICAgICAgICAgICAgQ29sdW1uW10gY29s\ncyA9IGdldENvbHVtbnMoKTsKICAgICAgICAgICAgICAgIGZvciAoaW50IGkg\nPSAwOyBpIDwgY29scy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAg\nICAgIGlmIChjb2xzW2ldLmlzQXV0b0Fzc2lnbmVkKCkpIHsKICAgICAgICAg\nICAgICAgICAgICAgICAgaWYgKGF1dG9zID09IG51bGwpCiAgICAgICAgICAg\nICAgICAgICAgICAgICAgICBhdXRvcyA9IG5ldyBBcnJheUxpc3QoMyk7CiAg\nICAgICAgICAgICAgICAgICAgICAgIGF1dG9zLmFkZChjb2xzW2ldKTsKICAg\nICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAg\nICAgICAgICBfYXV0b0Fzc2lnbiA9IChhdXRvcyA9PSBudWxsKSA/IFNjaGVt\nYXMuRU1QVFlfQ09MVU1OUwogICAgICAgICAgICAgICAgICAgIDogKENvbHVt\nbltdKSBhdXRvcy50b0FycmF5KG5ldyBDb2x1bW5bYXV0b3Muc2l6ZSgpXSk7\nCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIF9hdXRv\nQXNzaWduOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRoaXMgdGFi\nbGUncyByZWxhdGlvbiBpZCBjb2x1bW5zLgogICAgICovCiAgICBwdWJsaWMg\nQ29sdW1uW10gZ2V0UmVsYXRpb25JZENvbHVtbnMoKSB7CiAgICAgICAgaWYg\nKF9yZWxzID09IG51bGwpIHsKICAgICAgICAgICAgaWYgKF9jb2xNYXAgPT0g\nbnVsbCkKICAgICAgICAgICAgICAgIF9yZWxzID0gU2NoZW1hcy5FTVBUWV9D\nT0xVTU5TOwogICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgIENv\nbGxlY3Rpb24gcmVscyA9IG51bGw7CiAgICAgICAgICAgICAgICBDb2x1bW5b\nXSBjb2xzID0gZ2V0Q29sdW1ucygpOwogICAgICAgICAgICAgICAgZm9yIChp\nbnQgaSA9IDA7IGkgPCBjb2xzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAg\nICAgICAgICAgaWYgKGNvbHNbaV0uaXNSZWxhdGlvbklkKCkpIHsKICAgICAg\nICAgICAgICAgICAgICAgICAgaWYgKHJlbHMgPT0gbnVsbCkKICAgICAgICAg\nICAgICAgICAgICAgICAgICAgIHJlbHMgPSBuZXcgQXJyYXlMaXN0KDMpOwog\nICAgICAgICAgICAgICAgICAgICAgICByZWxzLmFkZChjb2xzW2ldKTsKICAg\nICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAg\nICAgICAgICBfcmVscyA9IChyZWxzID09IG51bGwpID8gU2NoZW1hcy5FTVBU\nWV9DT0xVTU5TCiAgICAgICAgICAgICAgICAgICAgOiAoQ29sdW1uW10pIHJl\nbHMudG9BcnJheShuZXcgQ29sdW1uW3JlbHMuc2l6ZSgpXSk7CiAgICAgICAg\nICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIF9yZWxzOwogICAgfQoK\nICAgIC8qKgogICAgICogUmV0dXJuIHRoZSBjb2x1bW4gd2l0aCB0aGUgZ2l2\nZW4gbmFtZSwgb3IgbnVsbCBpZiBub25lLgogICAgICovCiAgICBwdWJsaWMg\nQ29sdW1uIGdldENvbHVtbihTdHJpbmcgbmFtZSkgewogICAgICAgIGlmIChu\nYW1lID09IG51bGwgfHwgX2NvbE1hcCA9PSBudWxsKQogICAgICAgICAgICBy\nZXR1cm4gbnVsbDsKICAgICAgICByZXR1cm4gKENvbHVtbikgX2NvbE1hcC5n\nZXQobmFtZS50b1VwcGVyQ2FzZSgpKTsKICAgIH0KCiAgICAvKioKICAgICAq\nIEFkZCBhIGNvbHVtbiB0byB0aGUgdGFibGUuCiAgICAgKi8KICAgIHB1Ymxp\nYyBDb2x1bW4gYWRkQ29sdW1uKFN0cmluZyBuYW1lKSB7CiAgICAgICAgYWRk\nTmFtZShuYW1lLCB0cnVlKTsKICAgICAgICBTY2hlbWEgc2NoZW1hID0gZ2V0\nU2NoZW1hKCk7CiAgICAgICAgQ29sdW1uIGNvbDsKICAgICAgICBpZiAoc2No\nZW1hICE9IG51bGwgJiYgc2NoZW1hLmdldFNjaGVtYUdyb3VwKCkgIT0gbnVs\nbCkKICAgICAgICAgICAgY29sID0gc2NoZW1hLmdldFNjaGVtYUdyb3VwKCku\nbmV3Q29sdW1uKG5hbWUsIHRoaXMpOwogICAgICAgIGVsc2UKICAgICAgICAg\nICAgY29sID0gbmV3IENvbHVtbihuYW1lLCB0aGlzKTsKICAgICAgICBpZiAo\nX2NvbE1hcCA9PSBudWxsKQogICAgICAgICAgICBfY29sTWFwID0gbmV3IExp\nbmtlZEhhc2hNYXAoKTsKICAgICAgICBfY29sTWFwLnB1dChuYW1lLnRvVXBw\nZXJDYXNlKCksIGNvbCk7CiAgICAgICAgX2NvbHMgPSBudWxsOwogICAgICAg\nIHJldHVybiBjb2w7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZW1vdmUgdGhl\nIGdpdmVuIGNvbHVtbiBmcm9tIHRoZSB0YWJsZS4KICAgICAqCiAgICAgKiBA\ncmV0dXJuIHRydWUgaWYgdGhlIGNvbHVtbiB3YXMgcmVtb3ZlZCwgZmFsc2Ug\naWYgbm90IGluIHRoZSB0YWJsZQogICAgICovCiAgICBwdWJsaWMgYm9vbGVh\nbiByZW1vdmVDb2x1bW4oQ29sdW1uIGNvbCkgewogICAgICAgIGlmIChjb2wg\nPT0gbnVsbCB8fCBfY29sTWFwID09IG51bGwpCiAgICAgICAgICAgIHJldHVy\nbiBmYWxzZTsKCiAgICAgICAgQ29sdW1uIGN1ciA9IChDb2x1bW4pIF9jb2xN\nYXAuZ2V0KGNvbC5nZXROYW1lKCkudG9VcHBlckNhc2UoKSk7CiAgICAgICAg\naWYgKCFjb2wuZXF1YWxzKGN1cikpCiAgICAgICAgICAgIHJldHVybiBmYWxz\nZTsKCiAgICAgICAgcmVtb3ZlTmFtZShjb2wuZ2V0TmFtZSgpKTsKICAgICAg\nICBfY29sTWFwLnJlbW92ZShjb2wuZ2V0TmFtZSgpLnRvVXBwZXJDYXNlKCkp\nOwogICAgICAgIF9jb2xzID0gbnVsbDsKICAgICAgICBpZiAoY29sLmlzQXV0\nb0Fzc2lnbmVkKCkpCiAgICAgICAgICAgIF9hdXRvQXNzaWduID0gbnVsbDsK\nICAgICAgICBpZiAoY29sLmlzUmVsYXRpb25JZCgpKQogICAgICAgICAgICBf\ncmVscyA9IG51bGw7CiAgICAgICAgY29sLnJlbW92ZSgpOwogICAgICAgIHJl\ndHVybiB0cnVlOwogICAgfQoKICAgIC8qKgogICAgICogSW1wb3J0IGEgY29s\ndW1uIGZyb20gYW5vdGhlciB0YWJsZS4KICAgICAqLwogICAgcHVibGljIENv\nbHVtbiBpbXBvcnRDb2x1bW4oQ29sdW1uIGNvbCkgewogICAgICAgIGlmIChj\nb2wgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIG51bGw7CgogICAgICAg\nIENvbHVtbiBjb3B5ID0gYWRkQ29sdW1uKGNvbC5nZXROYW1lKCkpOwogICAg\nICAgIGNvcHkuc2V0VHlwZShjb2wuZ2V0VHlwZSgpKTsKICAgICAgICBjb3B5\nLnNldFR5cGVOYW1lKGNvbC5nZXRUeXBlTmFtZSgpKTsKICAgICAgICBjb3B5\nLnNldEphdmFUeXBlKGNvbC5nZXRKYXZhVHlwZSgpKTsKICAgICAgICBjb3B5\nLnNldE5vdE51bGwoY29sLmlzTm90TnVsbCgpKTsKICAgICAgICBjb3B5LnNl\ndERlZmF1bHRTdHJpbmcoY29sLmdldERlZmF1bHRTdHJpbmcoKSk7CiAgICAg\nICAgY29weS5zZXRTaXplKGNvbC5nZXRTaXplKCkpOwogICAgICAgIGNvcHku\nc2V0RGVjaW1hbERpZ2l0cyhjb2wuZ2V0RGVjaW1hbERpZ2l0cygpKTsKICAg\nICAgICBjb3B5LnNldEF1dG9Bc3NpZ25lZChjb2wuaXNBdXRvQXNzaWduZWQo\nKSk7CiAgICAgICAgcmV0dXJuIGNvcHk7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBSZXR1cm4gdGhlIHByaW1hcnkga2V5IGZvciB0aGUgdGFibGUsIGlmIGFu\neS4KICAgICAqLwogICAgcHVibGljIFByaW1hcnlLZXkgZ2V0UHJpbWFyeUtl\neSgpIHsKICAgICAgICByZXR1cm4gX3BrOwogICAgfQoKICAgIC8qKgogICAg\nICogU2V0IHRoZSBwcmltYXJ5IGtleSBmb3IgdGhlIHRhYmxlLgogICAgICov\nCiAgICBwdWJsaWMgUHJpbWFyeUtleSBhZGRQcmltYXJ5S2V5KCkgewogICAg\nICAgIHJldHVybiBhZGRQcmltYXJ5S2V5KG51bGwpOwogICAgfQoKICAgIC8q\nKgogICAgICogU2V0IHRoZSBwcmltYXJ5IGtleSBmb3IgdGhlIHRhYmxlLgog\nICAgICovCiAgICBwdWJsaWMgUHJpbWFyeUtleSBhZGRQcmltYXJ5S2V5KFN0\ncmluZyBuYW1lKSB7CiAgICAgICAgU2NoZW1hIHNjaGVtYSA9IGdldFNjaGVt\nYSgpOwogICAgICAgIGlmIChzY2hlbWEgIT0gbnVsbCAmJiBzY2hlbWEuZ2V0\nU2NoZW1hR3JvdXAoKSAhPSBudWxsKSB7CiAgICAgICAgICAgIHNjaGVtYS5n\nZXRTY2hlbWFHcm91cCgpLmFkZE5hbWUobmFtZSwgZmFsc2UpOwogICAgICAg\nICAgICBfcGsgPSBzY2hlbWEuZ2V0U2NoZW1hR3JvdXAoKS5uZXdQcmltYXJ5\nS2V5KG5hbWUsIHRoaXMpOwogICAgICAgIH0gZWxzZQogICAgICAgICAgICBf\ncGsgPSBuZXcgUHJpbWFyeUtleShuYW1lLCB0aGlzKTsKICAgICAgICByZXR1\ncm4gX3BrOwogICAgfQoKICAgIC8qKgogICAgICogUmVtb3ZlIHRoZSBwcmlt\nYXJ5IGtleSBmcm9tIHRoaXMgdGFibGUuCiAgICAgKgogICAgICogQHJldHVy\nbiB0cnVlIGlmIHRoZXJlIHdhcyBhIHBrIHRvIHJlbW92ZSwgZmFsc2Ugb3Ro\nZXJ3aXNlCiAgICAgKi8KICAgIHB1YmxpYyBib29sZWFuIHJlbW92ZVByaW1h\ncnlLZXkoKSB7CiAgICAgICAgYm9vbGVhbiByZW0gPSBfcGsgIT0gbnVsbDsK\nICAgICAgICBpZiAocmVtKSB7CiAgICAgICAgICAgIFNjaGVtYSBzY2hlbWEg\nPSBnZXRTY2hlbWEoKTsKICAgICAgICAgICAgaWYgKHNjaGVtYSAhPSBudWxs\nICYmIHNjaGVtYS5nZXRTY2hlbWFHcm91cCgpICE9IG51bGwpCiAgICAgICAg\nICAgICAgICBzY2hlbWEuZ2V0U2NoZW1hR3JvdXAoKS5yZW1vdmVOYW1lKF9w\nay5nZXROYW1lKCkpOwogICAgICAgICAgICBfcGsucmVtb3ZlKCk7CiAgICAg\nICAgfQogICAgICAgIF9wayA9IG51bGw7CiAgICAgICAgcmV0dXJuIHJlbTsK\nICAgIH0KCiAgICAvKioKICAgICAqIEltcG9ydCBhIHByaW1hcnkga2V5OyBj\nb2x1bW4gbmFtZXMgbXVzdCBtYXRjaCBjb2x1bW5zIG9mIHRoaXMgdGFibGUu\nCiAgICAgKi8KICAgIHB1YmxpYyBQcmltYXJ5S2V5IGltcG9ydFByaW1hcnlL\nZXkoUHJpbWFyeUtleSBwaykgewogICAgICAgIGlmIChwayA9PSBudWxsKQog\nICAgICAgICAgICByZXR1cm4gbnVsbDsKCiAgICAgICAgUHJpbWFyeUtleSBj\nb3B5ID0gYWRkUHJpbWFyeUtleShway5nZXROYW1lKCkpOwogICAgICAgIGNv\ncHkuc2V0TG9naWNhbChway5pc0xvZ2ljYWwoKSk7CiAgICAgICAgQ29sdW1u\nW10gY29scyA9IHBrLmdldENvbHVtbnMoKTsKICAgICAgICBmb3IgKGludCBp\nID0gMDsgaSA8IGNvbHMubGVuZ3RoOyBpKyspCiAgICAgICAgICAgIGNvcHku\nYWRkQ29sdW1uKGdldENvbHVtbihjb2xzW2ldLmdldE5hbWUoKSkpOwogICAg\nICAgIHJldHVybiBjb3B5OwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJu\nIHRoZSBmb3JlaWduIGtleSB3aXRoIHRoZSBnaXZlbiBuYW1lLiBJZiBtdWx0\naXBsZSBmb3JlaWduIGtleXMKICAgICAqIGhhdmUgdGhlIG5hbWUsIHRoZSBm\naXJzdCBtYXRjaCBpcyByZXR1cm5lZC4KICAgICAqLwogICAgcHVibGljIEZv\ncmVpZ25LZXkgZ2V0Rm9yZWlnbktleShTdHJpbmcgbmFtZSkgewogICAgICAg\nIEZvcmVpZ25LZXlbXSBma3MgPSBnZXRGb3JlaWduS2V5cygpOwogICAgICAg\nIGZvciAoaW50IGkgPSAwOyBpIDwgZmtzLmxlbmd0aDsgaSsrKQogICAgICAg\nICAgICBpZiAoU3RyaW5nVXRpbHMuZXF1YWxzSWdub3JlQ2FzZShuYW1lLCBm\na3NbaV0uZ2V0TmFtZSgpKSkKICAgICAgICAgICAgICAgIHJldHVybiBma3Nb\naV07CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBSZXR1cm4gYWxsIGZvcmVpZ24ga2V5cyBmb3IgdGhlIHRhYmxlLgogICAg\nICovCiAgICBwdWJsaWMgRm9yZWlnbktleVtdIGdldEZvcmVpZ25LZXlzKCkg\newogICAgICAgIGlmIChfZmtzID09IG51bGwpIHsKICAgICAgICAgICAgaWYg\nKF9ma0xpc3QgPT0gbnVsbCkKICAgICAgICAgICAgICAgIF9ma3MgPSBTY2hl\nbWFzLkVNUFRZX0ZPUkVJR05fS0VZUzsKICAgICAgICAgICAgZWxzZSB7CiAg\nICAgICAgICAgICAgICBGb3JlaWduS2V5W10gZmtzID0gbmV3IEZvcmVpZ25L\nZXlbX2ZrTGlzdC5zaXplKCldOwogICAgICAgICAgICAgICAgSXRlcmF0b3Ig\naXRyID0gX2ZrTGlzdC5pdGVyYXRvcigpOwogICAgICAgICAgICAgICAgZm9y\nIChpbnQgaSA9IDA7IGl0ci5oYXNOZXh0KCk7IGkrKykgewogICAgICAgICAg\nICAgICAgICAgIGZrc1tpXSA9IChGb3JlaWduS2V5KSBpdHIubmV4dCgpOwog\nICAgICAgICAgICAgICAgICAgIGZrc1tpXS5zZXRJbmRleChpKTsKICAgICAg\nICAgICAgICAgIH0KICAgICAgICAgICAgICAgIF9ma3MgPSBma3M7CiAgICAg\nICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIF9ma3M7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBBZGQgYSBmb3JlaWduIGtleSB0byB0aGUgdGFi\nbGUuCiAgICAgKi8KICAgIHB1YmxpYyBGb3JlaWduS2V5IGFkZEZvcmVpZ25L\nZXkoKSB7CiAgICAgICAgcmV0dXJuIGFkZEZvcmVpZ25LZXkobnVsbCk7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBBZGQgYSBmb3JlaWduIGtleSB0byB0aGUg\ndGFibGUuIER1cGxpY2F0ZSBrZXkgbmFtZXMgYXJlIG5vdCBhbGxvd2VkLgog\nICAgICovCiAgICBwdWJsaWMgRm9yZWlnbktleSBhZGRGb3JlaWduS2V5KFN0\ncmluZyBuYW1lKSB7CiAgICAgICAgU2NoZW1hIHNjaGVtYSA9IGdldFNjaGVt\nYSgpOwogICAgICAgIEZvcmVpZ25LZXkgZms7CiAgICAgICAgaWYgKHNjaGVt\nYSAhPSBudWxsICYmIHNjaGVtYS5nZXRTY2hlbWFHcm91cCgpICE9IG51bGwp\nIHsKICAgICAgICAgICAgc2NoZW1hLmdldFNjaGVtYUdyb3VwKCkuYWRkTmFt\nZShuYW1lLCBmYWxzZSk7CiAgICAgICAgICAgIGZrID0gc2NoZW1hLmdldFNj\naGVtYUdyb3VwKCkubmV3Rm9yZWlnbktleShuYW1lLCB0aGlzKTsKICAgICAg\nICB9IGVsc2UKICAgICAgICAgICAgZmsgPSBuZXcgRm9yZWlnbktleShuYW1l\nLCB0aGlzKTsKICAgICAgICBpZiAoX2ZrTGlzdCA9PSBudWxsKQogICAgICAg\nICAgICBfZmtMaXN0ID0gbmV3IEFycmF5TGlzdCgzKTsKICAgICAgICBfZmtM\naXN0LmFkZChmayk7CiAgICAgICAgX2ZrcyA9IG51bGw7CiAgICAgICAgcmV0\ndXJuIGZrOwogICAgfQoKICAgIC8qKgogICAgICogUmVtb3ZlIHRoZSBnaXZl\nbiBmb3JlaWduIGtleSBmcm9tIHRoZSB0YWJsZS4KICAgICAqCiAgICAgKiBA\ncmV0dXJuIHRydWUgaWYgdGhlIGtleSB3YXMgcmVtb3ZlZCwgZmFsc2UgaWYg\nbm90IGluIHRoZSB0YWJsZQogICAgICovCiAgICBwdWJsaWMgYm9vbGVhbiBy\nZW1vdmVGb3JlaWduS2V5KEZvcmVpZ25LZXkgZmspIHsKICAgICAgICBpZiAo\nZmsgPT0gbnVsbCB8fCBfZmtMaXN0ID09IG51bGwpCiAgICAgICAgICAgIHJl\ndHVybiBmYWxzZTsKCiAgICAgICAgaWYgKCFfZmtMaXN0LnJlbW92ZShmaykp\nCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCiAgICAgICAgU2NoZW1hIHNj\naGVtYSA9IGdldFNjaGVtYSgpOwogICAgICAgIGlmIChzY2hlbWEgIT0gbnVs\nbCAmJiBzY2hlbWEuZ2V0U2NoZW1hR3JvdXAoKSAhPSBudWxsKQogICAgICAg\nICAgICBzY2hlbWEuZ2V0U2NoZW1hR3JvdXAoKS5yZW1vdmVOYW1lKGZrLmdl\ndE5hbWUoKSk7CiAgICAgICAgX2ZrcyA9IG51bGw7CiAgICAgICAgZmsucmVt\nb3ZlKCk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBJbXBvcnQgYSBmb3JlaWduIGtleTsgY29sdW1uIG5hbWVzIG11c3Qg\nbWF0Y2ggY29sdW1ucyBvZiB0aGlzIHRhYmxlLgogICAgICovCiAgICBwdWJs\naWMgRm9yZWlnbktleSBpbXBvcnRGb3JlaWduS2V5KEZvcmVpZ25LZXkgZmsp\nIHsKICAgICAgICBpZiAoZmsgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJu\nIG51bGw7CgogICAgICAgIEZvcmVpZ25LZXkgY29weSA9IGFkZEZvcmVpZ25L\nZXkoZmsuZ2V0TmFtZSgpKTsKICAgICAgICBjb3B5LnNldERlbGV0ZUFjdGlv\nbihmay5nZXREZWxldGVBY3Rpb24oKSk7CgogICAgICAgIFNjaGVtYSBzY2hl\nbWEgPSBnZXRTY2hlbWEoKTsKICAgICAgICBpZiAoc2NoZW1hICE9IG51bGwg\nJiYgc2NoZW1hLmdldFNjaGVtYUdyb3VwKCkgIT0gbnVsbCkgewogICAgICAg\nICAgICBDb2x1bW5bXSBwa3MgPSBmay5nZXRQcmltYXJ5S2V5Q29sdW1ucygp\nOwogICAgICAgICAgICBUYWJsZSBqb2luZWQgPSBudWxsOwogICAgICAgICAg\nICBpZiAocGtzLmxlbmd0aCA+IDApCiAgICAgICAgICAgICAgICBqb2luZWQg\nPSBzY2hlbWEuZ2V0U2NoZW1hR3JvdXAoKS5maW5kVGFibGUocGtzWzBdLmdl\ndFRhYmxlKCkpOwoKICAgICAgICAgICAgQ29sdW1uW10gY29scyA9IGZrLmdl\ndENvbHVtbnMoKTsKICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBj\nb2xzLmxlbmd0aDsgaSsrKQogICAgICAgICAgICAgICAgY29weS5qb2luKGdl\ndENvbHVtbihjb2xzW2ldLmdldE5hbWUoKSksCiAgICAgICAgICAgICAgICAg\nICAgam9pbmVkLmdldENvbHVtbihwa3NbaV0uZ2V0TmFtZSgpKSk7CgogICAg\nICAgICAgICBjb2xzID0gZmsuZ2V0Q29uc3RhbnRDb2x1bW5zKCk7CiAgICAg\nICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgY29scy5sZW5ndGg7IGkrKykK\nICAgICAgICAgICAgICAgIGNvcHkuam9pbkNvbnN0YW50KGdldENvbHVtbihj\nb2xzW2ldLmdldE5hbWUoKSksCiAgICAgICAgICAgICAgICAgICAgZmsuZ2V0\nUHJpbWFyeUtleUNvbnN0YW50KGNvbHNbaV0pKTsKCiAgICAgICAgICAgIHBr\ncyA9IGZrLmdldENvbnN0YW50UHJpbWFyeUtleUNvbHVtbnMoKTsKICAgICAg\nICAgICAgaWYgKGpvaW5lZCA9PSBudWxsICYmIHBrcy5sZW5ndGggPiAwKQog\nICAgICAgICAgICAgICAgam9pbmVkID0gc2NoZW1hLmdldFNjaGVtYUdyb3Vw\nKCkuZmluZFRhYmxlKHBrc1swXS5nZXRUYWJsZSgpKTsKICAgICAgICAgICAg\nZm9yIChpbnQgaSA9IDA7IGkgPCBwa3MubGVuZ3RoOyBpKyspCiAgICAgICAg\nICAgICAgICBjb3B5LmpvaW5Db25zdGFudChmay5nZXRDb25zdGFudChwa3Nb\naV0pLAogICAgICAgICAgICAgICAgICAgIGpvaW5lZC5nZXRDb2x1bW4ocGtz\nW2ldLmdldE5hbWUoKSkpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gY29w\neTsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgdGFibGUncyBp\nbmRleGVzLgogICAgICovCiAgICBwdWJsaWMgSW5kZXhbXSBnZXRJbmRleGVz\nKCkgewogICAgICAgIGlmIChfaWR4cyA9PSBudWxsIHx8IF9pZHhzLmxlbmd0\naCA9PSAwKQogICAgICAgICAgICBfaWR4cyA9IChfaWR4TWFwID09IG51bGwp\nID8gU2NoZW1hcy5FTVBUWV9JTkRFWEVTIDogKEluZGV4W10pCiAgICAgICAg\nICAgICAgICBfaWR4TWFwLnZhbHVlcygpLnRvQXJyYXkobmV3IEluZGV4W19p\nZHhNYXAuc2l6ZSgpXSk7CiAgICAgICAgcmV0dXJuIF9pZHhzOwogICAgfQoK\nICAgIC8qKgogICAgICogUmV0dXJuIHRoZSBpbmRleCB3aXRoIHRoZSBnaXZl\nbiBuYW1lLCBvciBudWxsIGlmIG5vbmUuCiAgICAgKi8KICAgIHB1YmxpYyBJ\nbmRleCBnZXRJbmRleChTdHJpbmcgbmFtZSkgewogICAgICAgIGlmIChuYW1l\nID09IG51bGwgfHwgX2lkeE1hcCA9PSBudWxsKQogICAgICAgICAgICByZXR1\ncm4gbnVsbDsKICAgICAgICByZXR1cm4gKEluZGV4KSBfaWR4TWFwLmdldChu\nYW1lLnRvVXBwZXJDYXNlKCkpOwogICAgfQoKICAgIC8qKgogICAgICogQWRk\nIGFuIGluZGV4IHRvIHRoZSB0YWJsZS4KICAgICAqLwogICAgcHVibGljIElu\nZGV4IGFkZEluZGV4KFN0cmluZyBuYW1lKSB7CiAgICAgICAgU2NoZW1hIHNj\naGVtYSA9IGdldFNjaGVtYSgpOwogICAgICAgIEluZGV4IGlkeDsKICAgICAg\nICBpZiAoc2NoZW1hICE9IG51bGwgJiYgc2NoZW1hLmdldFNjaGVtYUdyb3Vw\nKCkgIT0gbnVsbCkgewogICAgICAgICAgICBzY2hlbWEuZ2V0U2NoZW1hR3Jv\ndXAoKS5hZGROYW1lKG5hbWUsIHRydWUpOwogICAgICAgICAgICBpZHggPSBz\nY2hlbWEuZ2V0U2NoZW1hR3JvdXAoKS5uZXdJbmRleChuYW1lLCB0aGlzKTsK\nICAgICAgICB9IGVsc2UKICAgICAgICAgICAgaWR4ID0gbmV3IEluZGV4KG5h\nbWUsIHRoaXMpOwogICAgICAgIGlmIChfaWR4TWFwID09IG51bGwpCiAgICAg\nICAgICAgIF9pZHhNYXAgPSBuZXcgVHJlZU1hcCgpOwogICAgICAgIF9pZHhN\nYXAucHV0KG5hbWUudG9VcHBlckNhc2UoKSwgaWR4KTsKICAgICAgICBfaWR4\ncyA9IG51bGw7CiAgICAgICAgcmV0dXJuIGlkeDsKICAgIH0KCiAgICAvKioK\nICAgICAqIFJlbW92ZSB0aGUgZ2l2ZW4gaW5kZXggZnJvbSB0aGUgdGFibGUu\nCiAgICAgKgogICAgICogQHJldHVybiB0cnVlIGlmIHRoZSBpbmRleCB3YXMg\ncmVtb3ZlZCwgZmFsc2UgaWYgbm90IGluIHRoZSB0YWJsZQogICAgICovCiAg\nICBwdWJsaWMgYm9vbGVhbiByZW1vdmVJbmRleChJbmRleCBpZHgpIHsKICAg\nICAgICBpZiAoaWR4ID09IG51bGwgfHwgX2lkeE1hcCA9PSBudWxsKQogICAg\nICAgICAgICByZXR1cm4gZmFsc2U7CgogICAgICAgIEluZGV4IGN1ciA9IChJ\nbmRleCkgX2lkeE1hcC5nZXQoaWR4LmdldE5hbWUoKS50b1VwcGVyQ2FzZSgp\nKTsKICAgICAgICBpZiAoIWlkeC5lcXVhbHMoY3VyKSkKICAgICAgICAgICAg\ncmV0dXJuIGZhbHNlOwoKICAgICAgICBfaWR4TWFwLnJlbW92ZShpZHguZ2V0\nTmFtZSgpLnRvVXBwZXJDYXNlKCkpOwogICAgICAgIFNjaGVtYSBzY2hlbWEg\nPSBnZXRTY2hlbWEoKTsKICAgICAgICBpZiAoc2NoZW1hICE9IG51bGwgJiYg\nc2NoZW1hLmdldFNjaGVtYUdyb3VwKCkgIT0gbnVsbCkKICAgICAgICAgICAg\nc2NoZW1hLmdldFNjaGVtYUdyb3VwKCkucmVtb3ZlTmFtZShpZHguZ2V0TmFt\nZSgpKTsKICAgICAgICBpZHgucmVtb3ZlKCk7CiAgICAgICAgX2lkeHMgPSBu\ndWxsOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qKgogICAg\nICogSW1wb3J0IGFuIGluZGV4OyBjb2x1bW4gbmFtZXMgbXVzdCBtYXRjaCBj\nb2x1bW5zIG9mIHRoaXMgdGFibGUuCiAgICAgKi8KICAgIHB1YmxpYyBJbmRl\neCBpbXBvcnRJbmRleChJbmRleCBpZHgpIHsKICAgICAgICBpZiAoaWR4ID09\nIG51bGwpCiAgICAgICAgICAgIHJldHVybiBudWxsOwoKICAgICAgICBJbmRl\neCBjb3B5ID0gYWRkSW5kZXgoaWR4LmdldE5hbWUoKSk7CiAgICAgICAgY29w\neS5zZXRVbmlxdWUoaWR4LmlzVW5pcXVlKCkpOwoKICAgICAgICBDb2x1bW5b\nXSBjb2xzID0gaWR4LmdldENvbHVtbnMoKTsKICAgICAgICBmb3IgKGludCBp\nID0gMDsgaSA8IGNvbHMubGVuZ3RoOyBpKyspCiAgICAgICAgICAgIGNvcHku\nYWRkQ29sdW1uKGdldENvbHVtbihjb2xzW2ldLmdldE5hbWUoKSkpOwogICAg\nICAgIHJldHVybiBjb3B5OwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJu\nIHRoZSB0YWJsZSdzIHVuaXF1ZSBjb25zdHJhaW50cy4KICAgICAqLwogICAg\ncHVibGljIFVuaXF1ZVtdIGdldFVuaXF1ZXMoKSB7CiAgICAgICAgaWYgKF91\nbnFzID09IG51bGwpCiAgICAgICAgICAgIF91bnFzID0gKF91bnFMaXN0ID09\nIG51bGwpID8gU2NoZW1hcy5FTVBUWV9VTklRVUVTIDogKFVuaXF1ZVtdKQog\nICAgICAgICAgICAgICAgX3VucUxpc3QudG9BcnJheShuZXcgVW5pcXVlW191\nbnFMaXN0LnNpemUoKV0pOwogICAgICAgIHJldHVybiBfdW5xczsKICAgIH0K\nCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgdW5pcXVlIGNvbnN0cmFpbnQg\nd2l0aCB0aGUgZ2l2ZW4gbmFtZSwgb3IgbnVsbCBpZiBub25lLgogICAgICov\nCiAgICBwdWJsaWMgVW5pcXVlIGdldFVuaXF1ZShTdHJpbmcgbmFtZSkgewog\nICAgICAgIFVuaXF1ZVtdIHVucXMgPSBnZXRVbmlxdWVzKCk7CiAgICAgICAg\nZm9yIChpbnQgaSA9IDA7IGkgPCB1bnFzLmxlbmd0aDsgaSsrKQogICAgICAg\nICAgICBpZiAoU3RyaW5nVXRpbHMuZXF1YWxzSWdub3JlQ2FzZShuYW1lLCB1\nbnFzW2ldLmdldE5hbWUoKSkpCiAgICAgICAgICAgICAgICByZXR1cm4gdW5x\nc1tpXTsKICAgICAgICByZXR1cm4gbnVsbDsKICAgIH0KCiAgICAvKioKICAg\nICAqIEFkZCBhIHVuaXF1ZSBjb25zdHJhaW50IHRvIHRoZSB0YWJsZS4KICAg\nICAqLwogICAgcHVibGljIFVuaXF1ZSBhZGRVbmlxdWUoU3RyaW5nIG5hbWUp\nIHsKICAgICAgICBTY2hlbWEgc2NoZW1hID0gZ2V0U2NoZW1hKCk7CiAgICAg\nICAgVW5pcXVlIHVucTsKICAgICAgICBpZiAoc2NoZW1hICE9IG51bGwgJiYg\nc2NoZW1hLmdldFNjaGVtYUdyb3VwKCkgIT0gbnVsbCkgewogICAgICAgICAg\nICBzY2hlbWEuZ2V0U2NoZW1hR3JvdXAoKS5hZGROYW1lKG5hbWUsIGZhbHNl\nKTsKICAgICAgICAgICAgdW5xID0gc2NoZW1hLmdldFNjaGVtYUdyb3VwKCku\nbmV3VW5pcXVlKG5hbWUsIHRoaXMpOwogICAgICAgIH0gZWxzZQogICAgICAg\nICAgICB1bnEgPSBuZXcgVW5pcXVlKG5hbWUsIHRoaXMpOwogICAgICAgIGlm\nIChfdW5xTGlzdCA9PSBudWxsKQogICAgICAgICAgICBfdW5xTGlzdCA9IG5l\ndyBBcnJheUxpc3QoMyk7CiAgICAgICAgX3VucUxpc3QuYWRkKHVucSk7CiAg\nICAgICAgX3VucXMgPSBudWxsOwogICAgICAgIHJldHVybiB1bnE7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBSZW1vdmUgdGhlIGdpdmVuIHVuaXF1ZSBjb25z\ndHJhaW50IGZyb20gdGhlIHRhYmxlLgogICAgICoKICAgICAqIEByZXR1cm4g\ndHJ1ZSBpZiB0aGUgY29uc3RyYWludCB3YXMgcmVtb3ZlZCwgZmFsc2UgaWYg\nbm90IGluIHRoZSB0YWJsZQogICAgICovCiAgICBwdWJsaWMgYm9vbGVhbiBy\nZW1vdmVVbmlxdWUoVW5pcXVlIHVucSkgewogICAgICAgIGlmICh1bnEgPT0g\nbnVsbCB8fCBfdW5xTGlzdCA9PSBudWxsKQogICAgICAgICAgICByZXR1cm4g\nZmFsc2U7CgogICAgICAgIGlmICghX3VucUxpc3QucmVtb3ZlKHVucSkpCiAg\nICAgICAgICAgIHJldHVybiBmYWxzZTsKCiAgICAgICAgU2NoZW1hIHNjaGVt\nYSA9IGdldFNjaGVtYSgpOwogICAgICAgIGlmIChzY2hlbWEgIT0gbnVsbCAm\nJiBzY2hlbWEuZ2V0U2NoZW1hR3JvdXAoKSAhPSBudWxsKQogICAgICAgICAg\nICBzY2hlbWEuZ2V0U2NoZW1hR3JvdXAoKS5yZW1vdmVOYW1lKHVucS5nZXRO\nYW1lKCkpOwogICAgICAgIF91bnFzID0gbnVsbDsKICAgICAgICB1bnEucmVt\nb3ZlKCk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBJbXBvcnQgYSBjb25zdHJhaW50OyBjb2x1bW4gbmFtZXMgbXVzdCBt\nYXRjaCBjb2x1bW5zIG9mIHRoaXMgdGFibGUuCiAgICAgKi8KICAgIHB1Ymxp\nYyBVbmlxdWUgaW1wb3J0VW5pcXVlKFVuaXF1ZSB1bnEpIHsKICAgICAgICBp\nZiAodW5xID09IG51bGwpCiAgICAgICAgICAgIHJldHVybiBudWxsOwoKICAg\nICAgICBVbmlxdWUgY29weSA9IGFkZFVuaXF1ZSh1bnEuZ2V0TmFtZSgpKTsK\nICAgICAgICBjb3B5LnNldERlZmVycmVkKHVucS5pc0RlZmVycmVkKCkpOwoK\nICAgICAgICBDb2x1bW5bXSBjb2xzID0gdW5xLmdldENvbHVtbnMoKTsKICAg\nICAgICBmb3IgKGludCBpID0gMDsgaSA8IGNvbHMubGVuZ3RoOyBpKyspCiAg\nICAgICAgICAgIGNvcHkuYWRkQ29sdW1uKGdldENvbHVtbihjb2xzW2ldLmdl\ndE5hbWUoKSkpOwogICAgICAgIHJldHVybiBjb3B5OwogICAgfQoKICAgIC8q\nKgogICAgICogQ2FsbGVkIGJ5IGNvbHVtbnMgdG8gZW5zdXJlIHRoYXQgYWxs\nIGNvbHVtbnMgYXJlIHByb3Blcmx5IGluZGV4ZWQKICAgICAqIGJlZm9yZSBy\nZXR1cm5pbmcgdGhhdCBpbmZvcm1hdGlvbiB0byB0aGUgdXNlci4KICAgICAq\nLwogICAgdm9pZCBpbmRleENvbHVtbnMoKSB7CiAgICAgICAgZ2V0Q29sdW1u\ncygpOwogICAgfQoKICAgIC8qKgogICAgICogQ2FsbGVkIGJ5IGZvcmVpZ24g\na2V5cyB0byBlbnN1cmUgdGhhdCBhbGwgZmtzIGFyZSBwcm9wZXJseSBpbmRl\neGVkCiAgICAgKiBiZWZvcmUgcmV0dXJuaW5nIHRoYXQgaW5mb3JtYXRpb24g\ndG8gdGhlIHVzZXIuCiAgICAgKi8KICAgIHZvaWQgaW5kZXhGb3JlaWduS2V5\ncygpIHsKICAgICAgICBnZXRGb3JlaWduS2V5cygpOwogICAgfQoKICAgIC8q\nKgogICAgICogQ2FsbGVkIGJ5IGNvbHVtbnMgd2hlbiB0aGVpciBhdXRvIGlu\nY3JlbWVudCBzdGF0dXMgY2hhbmdlcy4KICAgICAqLwogICAgdm9pZCBjaGFu\nZ2VBdXRvQXNzaWduZWQoQ29sdW1uIGNvbCkgewogICAgICAgIF9hdXRvQXNz\naWduID0gbnVsbDsKICAgIH0KCiAgICAvKioKICAgICAqIENhbGxlZCBieSBj\nb2x1bW5zIHdoZW4gdGhlaXIgcmVsYXRpb24gaWQgc3RhdHVzIGNoYW5nZXMu\nCiAgICAgKi8KICAgIHZvaWQgY2hhbmdlUmVsYXRpb25JZChDb2x1bW4gY29s\nKSB7CiAgICAgICAgX3JlbHMgPSBudWxsOwogICAgfQoKICAgIHB1YmxpYyBp\nbnQgY29tcGFyZVRvKE9iamVjdCBvdGhlcikgewogICAgICAgIFN0cmluZyBu\nYW1lID0gZ2V0RnVsbE5hbWUoKTsKICAgICAgICBTdHJpbmcgb3RoZXJOYW1l\nID0gKChUYWJsZSkgb3RoZXIpLmdldEZ1bGxOYW1lKCk7CiAgICAgICAgaWYg\nKG5hbWUgPT0gbnVsbCAmJiBvdGhlck5hbWUgPT0gbnVsbCkKICAgICAgICAg\nICAgcmV0dXJuIDA7CiAgICAgICAgaWYgKG5hbWUgPT0gbnVsbCkKICAgICAg\nICAgICAgcmV0dXJuIDE7CiAgICAgICAgaWYgKG90aGVyTmFtZSA9PSBudWxs\nKQogICAgICAgICAgICByZXR1cm4gLTE7CiAgICAgICAgcmV0dXJuIG5hbWUu\nY29tcGFyZVRvKG90aGVyTmFtZSk7CiAgICB9CgogICAgcHVibGljIFN0cmlu\nZyB0b1N0cmluZygpIHsKICAgICAgICByZXR1cm4gZ2V0RnVsbE5hbWUoKTsK\nICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBoYXNDb21tZW50KCkgewogICAg\nICAgIHJldHVybiBfY29tbWVudCAhPSBudWxsICYmICFfY29tbWVudC5lcXVh\nbHNJZ25vcmVDYXNlKF9uYW1lKTsKICAgIH0KCiAgICBwdWJsaWMgU3RyaW5n\nIGdldENvbW1lbnQoKSB7CiAgICAgICAgcmV0dXJuIF9jb21tZW50OwogICAg\nfQoKICAgIHB1YmxpYyB2b2lkIHNldENvbW1lbnQoU3RyaW5nIGNvbW1lbnQp\nIHsKICAgICAgICBfY29tbWVudCA9IGNvbW1lbnQ7CiAgICB9Cn0K\n","encoding":"base64"}

