{"sha":"de2a6127faf3d85ed2fe7fc69fd77292bc8b3c60","node_id":"MDQ6QmxvYjIwNjM2NDpkZTJhNjEyN2ZhZjNkODVlZDJmZTdmYzY5ZmQ3NzI5MmJjOGIzYzYw","size":161816,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/de2a6127faf3d85ed2fe7fc69fd77292bc8b3c60","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zcWw7CgppbXBvcnQg\namF2YS5pby5CdWZmZXJlZFJlYWRlcjsKaW1wb3J0IGphdmEuaW8uQnl0ZUFy\ncmF5SW5wdXRTdHJlYW07CmltcG9ydCBqYXZhLmlvLkNoYXJBcnJheVJlYWRl\ncjsKaW1wb3J0IGphdmEuaW8uSU9FeGNlcHRpb247CmltcG9ydCBqYXZhLmlv\nLklucHV0U3RyZWFtOwppbXBvcnQgamF2YS5pby5JbnB1dFN0cmVhbVJlYWRl\ncjsKaW1wb3J0IGphdmEuaW8uT3V0cHV0U3RyZWFtOwppbXBvcnQgamF2YS5p\nby5SZWFkZXI7CmltcG9ydCBqYXZhLmlvLlN0cmluZ1JlYWRlcjsKaW1wb3J0\nIGphdmEuaW8uV3JpdGVyOwppbXBvcnQgamF2YS5sYW5nLnJlZmxlY3QuSW52\nb2NhdGlvblRhcmdldEV4Y2VwdGlvbjsKaW1wb3J0IGphdmEubGFuZy5yZWZs\nZWN0Lk1ldGhvZDsKaW1wb3J0IGphdmEubWF0aC5CaWdEZWNpbWFsOwppbXBv\ncnQgamF2YS5tYXRoLkJpZ0ludGVnZXI7CmltcG9ydCBqYXZhLnNxbC5BcnJh\neTsKaW1wb3J0IGphdmEuc3FsLkJsb2I7CmltcG9ydCBqYXZhLnNxbC5DbG9i\nOwppbXBvcnQgamF2YS5zcWwuQ29ubmVjdGlvbjsKaW1wb3J0IGphdmEuc3Fs\nLkRhdGFiYXNlTWV0YURhdGE7CmltcG9ydCBqYXZhLnNxbC5QcmVwYXJlZFN0\nYXRlbWVudDsKaW1wb3J0IGphdmEuc3FsLlJlZjsKaW1wb3J0IGphdmEuc3Fs\nLlJlc3VsdFNldDsKaW1wb3J0IGphdmEuc3FsLlNRTEV4Y2VwdGlvbjsKaW1w\nb3J0IGphdmEuc3FsLlNRTFdhcm5pbmc7CmltcG9ydCBqYXZhLnNxbC5TdGF0\nZW1lbnQ7CmltcG9ydCBqYXZhLnNxbC5UaW1lOwppbXBvcnQgamF2YS5zcWwu\nVGltZXN0YW1wOwppbXBvcnQgamF2YS5zcWwuVHlwZXM7CmltcG9ydCBqYXZh\nLnRleHQuTWVzc2FnZUZvcm1hdDsKaW1wb3J0IGphdmEudXRpbC5BcnJheUxp\nc3Q7CmltcG9ydCBqYXZhLnV0aWwuQXJyYXlzOwppbXBvcnQgamF2YS51dGls\nLkNhbGVuZGFyOwppbXBvcnQgamF2YS51dGlsLkNvbGxlY3Rpb247CmltcG9y\ndCBqYXZhLnV0aWwuQ29sbGVjdGlvbnM7CmltcG9ydCBqYXZhLnV0aWwuRGF0\nZTsKaW1wb3J0IGphdmEudXRpbC5IYXNoU2V0OwppbXBvcnQgamF2YS51dGls\nLkl0ZXJhdG9yOwppbXBvcnQgamF2YS51dGlsLkxpbmtlZEhhc2hTZXQ7Cmlt\ncG9ydCBqYXZhLnV0aWwuTGlzdDsKaW1wb3J0IGphdmEudXRpbC5Mb2NhbGU7\nCmltcG9ydCBqYXZhLnV0aWwuTWFwOwppbXBvcnQgamF2YS51dGlsLlNldDsK\nCmltcG9ydCBqYXZheC5zcWwuRGF0YVNvdXJjZTsKCmltcG9ydCBvcmcuYXBh\nY2hlLmNvbW1vbnMubGFuZy5TdHJpbmdVdGlsczsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5qZGJjLmNvbmYuSkRCQ0NvbmZpZ3VyYXRpb247CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5rZXJuZWwuSkRCQ0ZldGNoQ29u\nZmlndXJhdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLmtl\ncm5lbC5KREJDU3RvcmU7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRi\nYy5rZXJuZWwuZXhwcy5FeHBDb250ZXh0OwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLmpkYmMua2VybmVsLmV4cHMuRXhwU3RhdGU7CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEuamRiYy5rZXJuZWwuZXhwcy5GaWx0ZXJWYWx1ZTsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLmtlcm5lbC5leHBzLlZh\nbDsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLm1ldGEuQ2xhc3NN\nYXBwaW5nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0YS5G\naWVsZE1hcHBpbmc7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5t\nZXRhLkphdmFTUUxUeXBlczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5q\nZGJjLnNjaGVtYS5Db2x1bW47CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\namRiYy5zY2hlbWEuRGF0YVNvdXJjZUZhY3Rvcnk7CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEuamRiYy5zY2hlbWEuRm9yZWlnbktleTsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNjaGVtYS5JbmRleDsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNjaGVtYS5OYW1lU2V0OwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1hLlByaW1hcnlLZXk7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hlbWEuU2NoZW1hOwpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1hLlNjaGVtYUdy\nb3VwOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1hLlNl\ncXVlbmNlOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1h\nLlRhYmxlOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1h\nLlVuaXF1ZTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuRmls\ndGVyczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuT3BlbkpQ\nQVN0YXRlTWFuYWdlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJu\nZWwuZXhwcy5QYXRoOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi5j\nb25mLkNvbmZpZ3VyYWJsZTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5s\naWIuY29uZi5Db25maWd1cmF0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLmxpYi5qZGJjLkNvbm5lY3Rpb25EZWNvcmF0b3I7CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEubGliLmpkYmMuTG9nZ2luZ0Nvbm5lY3Rpb25EZWNv\ncmF0b3I7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLmxvZy5Mb2c7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuTG9jYWxpemVy\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51dGlsLkxvY2FsaXpl\nci5NZXNzYWdlOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuRmll\nbGRNZXRhRGF0YTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRhLkph\ndmFUeXBlczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRhLlZhbHVl\nU3RyYXRlZ2llczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLkdl\nbmVyYWxFeGNlcHRpb247CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRp\nbC5JbnRlcm5hbEV4Y2VwdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUub3Blbmpw\nYS51dGlsLkludmFsaWRTdGF0ZUV4Y2VwdGlvbjsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS51dGlsLk9wZW5KUEFFeGNlcHRpb247CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEudXRpbC5SZWZlcmVudGlhbEludGVncml0eUV4Y2Vw\ndGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLlNlcmlhbGl6\nYXRpb247CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5TdG9yZUV4\nY2VwdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLlVuc3Vw\ncG9ydGVkRXhjZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0\naWwuVXNlckV4Y2VwdGlvbjsKCmltcG9ydCBzZXJwLnV0aWwuTnVtYmVyczsK\naW1wb3J0IHNlcnAudXRpbC5TdHJpbmdzOwoKLyoqCiAqIENsYXNzIHdoaWNo\nIGFsbG93cyB0aGUgY3JlYXRpb24gb2YgU1FMIGR5bmFtaWNhbGx5LCBpbiBh\nCiAqIGRhdGFiYXNlIGFnbm9zdGljIGZhc2hpb24uIFN1YmNsYXNzIGZvciB0\naGUgbnVhbmNlcyBvZiBkaWZmZXJlbnQgZGF0YSBzdG9yZXMuCiAqLwpwdWJs\naWMgY2xhc3MgREJEaWN0aW9uYXJ5CiAgICBpbXBsZW1lbnRzIENvbmZpZ3Vy\nYWJsZSwgQ29ubmVjdGlvbkRlY29yYXRvciwgSm9pblN5bnRheGVzLAogICAg\nTG9nZ2luZ0Nvbm5lY3Rpb25EZWNvcmF0b3IuU1FMV2FybmluZ0hhbmRsZXIg\newoKICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgU3RyaW5nIFZFTkRPUl9PVEhF\nUiA9ICJvdGhlciI7CiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIFN0cmluZyBW\nRU5ET1JfREFUQURJUkVDVCA9ICJkYXRhZGlyZWN0IjsKCiAgICBwdWJsaWMg\nc3RhdGljIGZpbmFsIFN0cmluZyBTQ0hFTUFfQ0FTRV9VUFBFUiA9ICJ1cHBl\nciI7CiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIFN0cmluZyBTQ0hFTUFfQ0FT\nRV9MT1dFUiA9ICJsb3dlciI7CiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIFN0\ncmluZyBTQ0hFTUFfQ0FTRV9QUkVTRVJWRSA9ICJwcmVzZXJ2ZSI7CgogICAg\ncHVibGljIHN0YXRpYyBmaW5hbCBTdHJpbmcgQ09OU19OQU1FX0JFRk9SRSA9\nICJiZWZvcmUiOwogICAgcHVibGljIHN0YXRpYyBmaW5hbCBTdHJpbmcgQ09O\nU19OQU1FX01JRCA9ICJtaWQiOwogICAgcHVibGljIHN0YXRpYyBmaW5hbCBT\ndHJpbmcgQ09OU19OQU1FX0FGVEVSID0gImFmdGVyIjsKICAgIAogICAgcHVi\nbGljIGludCBibG9iQnVmZmVyU2l6ZSA9IDUwMDAwOwogICAgcHVibGljIGlu\ndCBjbG9iQnVmZmVyU2l6ZSA9IDUwMDAwOwoKICAgIHByb3RlY3RlZCBzdGF0\naWMgZmluYWwgaW50IFJBTkdFX1BPU1RfU0VMRUNUID0gMDsKICAgIHByb3Rl\nY3RlZCBzdGF0aWMgZmluYWwgaW50IFJBTkdFX1BSRV9ESVNUSU5DVCA9IDE7\nCiAgICBwcm90ZWN0ZWQgc3RhdGljIGZpbmFsIGludCBSQU5HRV9QT1NUX0RJ\nU1RJTkNUID0gMjsKICAgIHByb3RlY3RlZCBzdGF0aWMgZmluYWwgaW50IFJB\nTkdFX1BPU1RfTE9DSyA9IDM7CgogICAgcHJvdGVjdGVkIHN0YXRpYyBmaW5h\nbCBpbnQgTkFOTyA9IDE7CiAgICBwcm90ZWN0ZWQgc3RhdGljIGZpbmFsIGlu\ndCBNSUNSTyA9IE5BTk8gKiAxMDAwOwogICAgcHJvdGVjdGVkIHN0YXRpYyBm\naW5hbCBpbnQgTUlMTEkgPSBNSUNSTyAqIDEwMDA7CiAgICBwcm90ZWN0ZWQg\nc3RhdGljIGZpbmFsIGludCBDRU5USSA9IE1JTExJICogMTA7CiAgICBwcm90\nZWN0ZWQgc3RhdGljIGZpbmFsIGludCBERUNJID0gTUlMTEkgKiAxMDA7CiAg\nICBwcm90ZWN0ZWQgc3RhdGljIGZpbmFsIGludCBTRUMgPSBNSUxMSSAqIDEw\nMDA7CgogICAgcHJvdGVjdGVkIHN0YXRpYyBmaW5hbCBpbnQgTkFNRV9BTlkg\nPSAwOwogICAgcHJvdGVjdGVkIHN0YXRpYyBmaW5hbCBpbnQgTkFNRV9UQUJM\nRSA9IDE7CiAgICBwcm90ZWN0ZWQgc3RhdGljIGZpbmFsIGludCBOQU1FX1NF\nUVVFTkNFID0gMjsKICAgIAogICAgcHJvdGVjdGVkIHN0YXRpYyBmaW5hbCBp\nbnQgVU5MSU1JVEVEID0gLTE7CiAgICBwcm90ZWN0ZWQgc3RhdGljIGZpbmFs\nIGludCBOT19CQVRDSCA9IDA7CgogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwg\nU3RyaW5nIFpFUk9fREFURV9TVFIgPQogICAgICAgICInIiArIG5ldyBqYXZh\nLnNxbC5EYXRlKDApICsgIiciOwogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwg\nU3RyaW5nIFpFUk9fVElNRV9TVFIgPSAiJyIgKyBuZXcgVGltZSgwKSArICIn\nIjsKICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIFN0cmluZyBaRVJPX1RJTUVT\nVEFNUF9TVFIgPQogICAgICAgICInIiArIG5ldyBUaW1lc3RhbXAoMCkgKyAi\nJyI7CgogICAgcHVibGljIHN0YXRpYyBmaW5hbCBMaXN0IEVNUFRZX1NUUklO\nR19MSVNUID0gQXJyYXlzLmFzTGlzdChuZXcgU3RyaW5nW117fSk7CiAgICBw\ndWJsaWMgc3RhdGljIGZpbmFsIExpc3RbXSBTUUxfU1RBVEVfQ09ERVMgPSAK\nICAgIAl7RU1QVFlfU1RSSU5HX0xJU1QsICAgICAgICAgICAgICAgICAgICAg\nLy8gMDogRGVmYXVsdAogICAgCSBBcnJheXMuYXNMaXN0KG5ldyBTdHJpbmdb\nXXsiNDEwMDAifSksICAvLyAxOiBMT0NLCiAgICAJIEVNUFRZX1NUUklOR19M\nSVNULCAgICAgICAgICAgICAgICAgICAgIC8vIDI6IE9CSkVDVF9OT1RfRk9V\nTkQKICAgIAkgRU1QVFlfU1RSSU5HX0xJU1QsICAgICAgICAgICAgICAgICAg\nICAgLy8gMzogT1BUSU1JU1RJQwogICAgCSBBcnJheXMuYXNMaXN0KG5ldyBT\ndHJpbmdbXXsiMjMwMDAifSksICAvLyA0OiBSRUZFUkVOVElBTF9JTlRFR1JJ\nVFkKICAgIAkgRU1QVFlfU1RSSU5HX0xJU1QgICAgICAgICAgICAgICAgICAg\nICAgLy8gNTogT0JKRUNUX0VYSVNUUwogICAgCX07IAogICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICBwcml2YXRl\nIHN0YXRpYyBmaW5hbCBMb2NhbGl6ZXIgX2xvYyA9IExvY2FsaXplci5mb3JQ\nYWNrYWdlCiAgICAgICAgKERCRGljdGlvbmFyeS5jbGFzcyk7CgogICAgLy8g\nc2NoZW1hIGRhdGEKICAgIHB1YmxpYyBTdHJpbmcgcGxhdGZvcm0gPSAiR2Vu\nZXJpYyI7CiAgICBwdWJsaWMgU3RyaW5nIGRyaXZlclZlbmRvciA9IG51bGw7\nCiAgICBwdWJsaWMgU3RyaW5nIGNhdGFsb2dTZXBhcmF0b3IgPSAiLiI7CiAg\nICBwdWJsaWMgYm9vbGVhbiBjcmVhdGVQcmltYXJ5S2V5cyA9IHRydWU7CiAg\nICBwdWJsaWMgU3RyaW5nIGNvbnN0cmFpbnROYW1lTW9kZSA9IENPTlNfTkFN\nRV9CRUZPUkU7CiAgICBwdWJsaWMgaW50IG1heFRhYmxlTmFtZUxlbmd0aCA9\nIDEyODsKICAgIHB1YmxpYyBpbnQgbWF4Q29sdW1uTmFtZUxlbmd0aCA9IDEy\nODsKICAgIHB1YmxpYyBpbnQgbWF4Q29uc3RyYWludE5hbWVMZW5ndGggPSAx\nMjg7CiAgICBwdWJsaWMgaW50IG1heEluZGV4TmFtZUxlbmd0aCA9IDEyODsK\nICAgIHB1YmxpYyBpbnQgbWF4SW5kZXhlc1BlclRhYmxlID0gSW50ZWdlci5N\nQVhfVkFMVUU7CiAgICBwdWJsaWMgYm9vbGVhbiBzdXBwb3J0c0ZvcmVpZ25L\nZXlzID0gdHJ1ZTsKICAgIHB1YmxpYyBib29sZWFuIHN1cHBvcnRzVGltZXN0\nYW1wTmFub3MgPSB0cnVlOwogICAgcHVibGljIGJvb2xlYW4gc3VwcG9ydHNV\nbmlxdWVDb25zdHJhaW50cyA9IHRydWU7CiAgICBwdWJsaWMgYm9vbGVhbiBz\ndXBwb3J0c0RlZmVycmVkQ29uc3RyYWludHMgPSB0cnVlOwogICAgcHVibGlj\nIGJvb2xlYW4gc3VwcG9ydHNSZXN0cmljdERlbGV0ZUFjdGlvbiA9IHRydWU7\nCiAgICBwdWJsaWMgYm9vbGVhbiBzdXBwb3J0c0Nhc2NhZGVEZWxldGVBY3Rp\nb24gPSB0cnVlOwogICAgcHVibGljIGJvb2xlYW4gc3VwcG9ydHNOdWxsRGVs\nZXRlQWN0aW9uID0gdHJ1ZTsKICAgIHB1YmxpYyBib29sZWFuIHN1cHBvcnRz\nRGVmYXVsdERlbGV0ZUFjdGlvbiA9IHRydWU7CiAgICBwdWJsaWMgYm9vbGVh\nbiBzdXBwb3J0c1Jlc3RyaWN0VXBkYXRlQWN0aW9uID0gdHJ1ZTsKICAgIHB1\nYmxpYyBib29sZWFuIHN1cHBvcnRzQ2FzY2FkZVVwZGF0ZUFjdGlvbiA9IHRy\ndWU7CiAgICBwdWJsaWMgYm9vbGVhbiBzdXBwb3J0c051bGxVcGRhdGVBY3Rp\nb24gPSB0cnVlOwogICAgcHVibGljIGJvb2xlYW4gc3VwcG9ydHNEZWZhdWx0\nVXBkYXRlQWN0aW9uID0gdHJ1ZTsKICAgIHB1YmxpYyBib29sZWFuIHN1cHBv\ncnRzQWx0ZXJUYWJsZVdpdGhBZGRDb2x1bW4gPSB0cnVlOwogICAgcHVibGlj\nIGJvb2xlYW4gc3VwcG9ydHNBbHRlclRhYmxlV2l0aERyb3BDb2x1bW4gPSB0\ncnVlOwogICAgcHVibGljIGJvb2xlYW4gc3VwcG9ydHNDb21tZW50cyA9IGZh\nbHNlOwogICAgcHVibGljIFN0cmluZyByZXNlcnZlZFdvcmRzID0gbnVsbDsK\nICAgIHB1YmxpYyBTdHJpbmcgc3lzdGVtU2NoZW1hcyA9IG51bGw7CiAgICBw\ndWJsaWMgU3RyaW5nIHN5c3RlbVRhYmxlcyA9IG51bGw7CiAgICBwdWJsaWMg\nU3RyaW5nIHNlbGVjdFdvcmRzID0gbnVsbDsKICAgIHB1YmxpYyBTdHJpbmcg\nZml4ZWRTaXplVHlwZU5hbWVzID0gbnVsbDsKICAgIHB1YmxpYyBTdHJpbmcg\nc2NoZW1hQ2FzZSA9IFNDSEVNQV9DQVNFX1VQUEVSOwoKICAgIC8vIHNxbAog\nICAgcHVibGljIFN0cmluZyB2YWxpZGF0aW9uU1FMID0gbnVsbDsKICAgIHB1\nYmxpYyBTdHJpbmcgY2xvc2VQb29sU1FMID0gbnVsbDsKICAgIHB1YmxpYyBT\ndHJpbmcgaW5pdGlhbGl6YXRpb25TUUwgPSBudWxsOwogICAgcHVibGljIGlu\ndCBqb2luU3ludGF4ID0gU1lOVEFYX1NRTDkyOwogICAgcHVibGljIFN0cmlu\nZyBvdXRlckpvaW5DbGF1c2UgPSAiTEVGVCBPVVRFUiBKT0lOIjsKICAgIHB1\nYmxpYyBTdHJpbmcgaW5uZXJKb2luQ2xhdXNlID0gIklOTkVSIEpPSU4iOwog\nICAgcHVibGljIFN0cmluZyBjcm9zc0pvaW5DbGF1c2UgPSAiQ1JPU1MgSk9J\nTiI7CiAgICBwdWJsaWMgYm9vbGVhbiByZXF1aXJlc0NvbmRpdGlvbkZvckNy\nb3NzSm9pbiA9IGZhbHNlOwogICAgcHVibGljIFN0cmluZyBmb3JVcGRhdGVD\nbGF1c2UgPSAiRk9SIFVQREFURSI7CiAgICBwdWJsaWMgU3RyaW5nIHRhYmxl\nRm9yVXBkYXRlQ2xhdXNlID0gbnVsbDsKICAgIHB1YmxpYyBTdHJpbmcgZGlz\ndGluY3RDb3VudENvbHVtblNlcGFyYXRvciA9IG51bGw7CiAgICBwdWJsaWMg\nYm9vbGVhbiBzdXBwb3J0c1NlbGVjdEZvclVwZGF0ZSA9IHRydWU7CiAgICBw\ndWJsaWMgYm9vbGVhbiBzdXBwb3J0c0xvY2tpbmdXaXRoRGlzdGluY3RDbGF1\nc2UgPSB0cnVlOwogICAgcHVibGljIGJvb2xlYW4gc3VwcG9ydHNMb2NraW5n\nV2l0aE11bHRpcGxlVGFibGVzID0gdHJ1ZTsKICAgIHB1YmxpYyBib29sZWFu\nIHN1cHBvcnRzTG9ja2luZ1dpdGhPcmRlckNsYXVzZSA9IHRydWU7CiAgICBw\ndWJsaWMgYm9vbGVhbiBzdXBwb3J0c0xvY2tpbmdXaXRoT3V0ZXJKb2luID0g\ndHJ1ZTsKICAgIHB1YmxpYyBib29sZWFuIHN1cHBvcnRzTG9ja2luZ1dpdGhJ\nbm5lckpvaW4gPSB0cnVlOwogICAgcHVibGljIGJvb2xlYW4gc3VwcG9ydHNM\nb2NraW5nV2l0aFNlbGVjdFJhbmdlID0gdHJ1ZTsKICAgIHB1YmxpYyBib29s\nZWFuIHN1cHBvcnRzUXVlcnlUaW1lb3V0ID0gdHJ1ZTsKICAgIHB1YmxpYyBi\nb29sZWFuIHNpbXVsYXRlTG9ja2luZyA9IGZhbHNlOwogICAgcHVibGljIGJv\nb2xlYW4gc3VwcG9ydHNTdWJzZWxlY3QgPSB0cnVlOwogICAgcHVibGljIGJv\nb2xlYW4gc3VwcG9ydHNDb3JyZWxhdGVkU3Vic2VsZWN0ID0gdHJ1ZTsKICAg\nIHB1YmxpYyBib29sZWFuIHN1cHBvcnRzSGF2aW5nID0gdHJ1ZTsKICAgIHB1\nYmxpYyBib29sZWFuIHN1cHBvcnRzU2VsZWN0U3RhcnRJbmRleCA9IGZhbHNl\nOwogICAgcHVibGljIGJvb2xlYW4gc3VwcG9ydHNTZWxlY3RFbmRJbmRleCA9\nIGZhbHNlOwogICAgcHVibGljIGludCByYW5nZVBvc2l0aW9uID0gUkFOR0Vf\nUE9TVF9TRUxFQ1Q7CiAgICBwdWJsaWMgYm9vbGVhbiByZXF1aXJlc0FsaWFz\nRm9yU3Vic2VsZWN0ID0gZmFsc2U7CiAgICBwdWJsaWMgYm9vbGVhbiByZXF1\naXJlc1RhcmdldEZvckRlbGV0ZSA9IGZhbHNlOwogICAgcHVibGljIGJvb2xl\nYW4gYWxsb3dzQWxpYXNJbkJ1bGtDbGF1c2UgPSB0cnVlOwogICAgcHVibGlj\nIGJvb2xlYW4gc3VwcG9ydHNNdWx0aXBsZU5vbnRyYW5zYWN0aW9uYWxSZXN1\nbHRTZXRzID0gdHJ1ZTsKICAgIHB1YmxpYyBTdHJpbmcgc2VhcmNoU3RyaW5n\nRXNjYXBlID0gIlxcIjsKICAgIHB1YmxpYyBib29sZWFuIHJlcXVpcmVzQ2Fz\ndEZvck1hdGhGdW5jdGlvbnMgPSBmYWxzZTsKICAgIHB1YmxpYyBib29sZWFu\nIHJlcXVpcmVzQ2FzdEZvckNvbXBhcmlzb25zID0gZmFsc2U7CiAgICBwdWJs\naWMgYm9vbGVhbiBzdXBwb3J0c01vZE9wZXJhdG9yID0gZmFsc2U7CiAgICBw\ndWJsaWMgYm9vbGVhbiBzdXBwb3J0c1hNTENvbHVtbiA9IGZhbHNlOwoKICAg\nIC8vIGZ1bmN0aW9ucwogICAgcHVibGljIFN0cmluZyBjYXN0RnVuY3Rpb24g\nPSAiQ0FTVCh7MH0gQVMgezF9KSI7CiAgICBwdWJsaWMgU3RyaW5nIHRvTG93\nZXJDYXNlRnVuY3Rpb24gPSAiTE9XRVIoezB9KSI7CiAgICBwdWJsaWMgU3Ry\naW5nIHRvVXBwZXJDYXNlRnVuY3Rpb24gPSAiVVBQRVIoezB9KSI7CiAgICBw\ndWJsaWMgU3RyaW5nIHN0cmluZ0xlbmd0aEZ1bmN0aW9uID0gIkNIQVJfTEVO\nR1RIKHswfSkiOwogICAgcHVibGljIFN0cmluZyBiaXRMZW5ndGhGdW5jdGlv\nbiA9ICIoT0NURVRfTEVOR1RIKHswfSkgKiA4KSI7CiAgICBwdWJsaWMgU3Ry\naW5nIHRyaW1MZWFkaW5nRnVuY3Rpb24gPSAiVFJJTShMRUFESU5HIHsxfSBG\nUk9NIHswfSkiOwogICAgcHVibGljIFN0cmluZyB0cmltVHJhaWxpbmdGdW5j\ndGlvbiA9ICJUUklNKFRSQUlMSU5HIHsxfSBGUk9NIHswfSkiOwogICAgcHVi\nbGljIFN0cmluZyB0cmltQm90aEZ1bmN0aW9uID0gIlRSSU0oQk9USCB7MX0g\nRlJPTSB7MH0pIjsKICAgIHB1YmxpYyBTdHJpbmcgY29uY2F0ZW5hdGVGdW5j\ndGlvbiA9ICIoezB9fHx7MX0pIjsKICAgIHB1YmxpYyBTdHJpbmcgY29uY2F0\nZW5hdGVEZWxpbWl0ZXIgPSAiJ09QRU5KUEFUT0tFTiciOwogICAgcHVibGlj\nIFN0cmluZyBzdWJzdHJpbmdGdW5jdGlvbk5hbWUgPSAiU1VCU1RSSU5HIjsK\nICAgIHB1YmxpYyBTdHJpbmcgY3VycmVudERhdGVGdW5jdGlvbiA9ICJDVVJS\nRU5UX0RBVEUiOwogICAgcHVibGljIFN0cmluZyBjdXJyZW50VGltZUZ1bmN0\naW9uID0gIkNVUlJFTlRfVElNRSI7CiAgICBwdWJsaWMgU3RyaW5nIGN1cnJl\nbnRUaW1lc3RhbXBGdW5jdGlvbiA9ICJDVVJSRU5UX1RJTUVTVEFNUCI7CiAg\nICBwdWJsaWMgU3RyaW5nIGRyb3BUYWJsZVNRTCA9ICJEUk9QIFRBQkxFIHsw\nfSI7CgogICAgLy8gdHlwZXMKICAgIHB1YmxpYyBib29sZWFuIHN0b3JhZ2VM\naW1pdGF0aW9uc0ZhdGFsID0gZmFsc2U7CiAgICBwdWJsaWMgYm9vbGVhbiBz\ndG9yZUxhcmdlTnVtYmVyc0FzU3RyaW5ncyA9IGZhbHNlOwogICAgcHVibGlj\nIGJvb2xlYW4gc3RvcmVDaGFyc0FzTnVtYmVycyA9IHRydWU7CiAgICBwdWJs\naWMgYm9vbGVhbiB1c2VHZXRCeXRlc0ZvckJsb2JzID0gZmFsc2U7CiAgICBw\ndWJsaWMgYm9vbGVhbiB1c2VTZXRCeXRlc0ZvckJsb2JzID0gZmFsc2U7CiAg\nICBwdWJsaWMgYm9vbGVhbiB1c2VHZXRPYmplY3RGb3JCbG9icyA9IGZhbHNl\nOwogICAgcHVibGljIGJvb2xlYW4gdXNlR2V0U3RyaW5nRm9yQ2xvYnMgPSBm\nYWxzZTsKICAgIHB1YmxpYyBib29sZWFuIHVzZVNldFN0cmluZ0ZvckNsb2Jz\nID0gZmFsc2U7CiAgICBwdWJsaWMgaW50IG1heEVtYmVkZGVkQmxvYlNpemUg\nPSAtMTsKICAgIHB1YmxpYyBpbnQgbWF4RW1iZWRkZWRDbG9iU2l6ZSA9IC0x\nOwogICAgcHVibGljIGludCBpbkNsYXVzZUxpbWl0ID0gLTE7CiAgICBwdWJs\naWMgaW50IGRhdGVQcmVjaXNpb24gPSBNSUxMSTsKICAgIHB1YmxpYyBpbnQg\nY2hhcmFjdGVyQ29sdW1uU2l6ZSA9IDI1NTsKICAgIHB1YmxpYyBTdHJpbmcg\nYXJyYXlUeXBlTmFtZSA9ICJBUlJBWSI7CiAgICBwdWJsaWMgU3RyaW5nIGJp\nZ2ludFR5cGVOYW1lID0gIkJJR0lOVCI7CiAgICBwdWJsaWMgU3RyaW5nIGJp\nbmFyeVR5cGVOYW1lID0gIkJJTkFSWSI7CiAgICBwdWJsaWMgU3RyaW5nIGJp\ndFR5cGVOYW1lID0gIkJJVCI7CiAgICBwdWJsaWMgU3RyaW5nIGJsb2JUeXBl\nTmFtZSA9ICJCTE9CIjsKICAgIHB1YmxpYyBTdHJpbmcgYm9vbGVhblR5cGVO\nYW1lID0gIkJPT0xFQU4iOwogICAgcHVibGljIFN0cmluZyBjaGFyVHlwZU5h\nbWUgPSAiQ0hBUiI7CiAgICBwdWJsaWMgU3RyaW5nIGNsb2JUeXBlTmFtZSA9\nICJDTE9CIjsKICAgIHB1YmxpYyBTdHJpbmcgZGF0ZVR5cGVOYW1lID0gIkRB\nVEUiOwogICAgcHVibGljIFN0cmluZyBkZWNpbWFsVHlwZU5hbWUgPSAiREVD\nSU1BTCI7CiAgICBwdWJsaWMgU3RyaW5nIGRpc3RpbmN0VHlwZU5hbWUgPSAi\nRElTVElOQ1QiOwogICAgcHVibGljIFN0cmluZyBkb3VibGVUeXBlTmFtZSA9\nICJET1VCTEUiOwogICAgcHVibGljIFN0cmluZyBmbG9hdFR5cGVOYW1lID0g\nIkZMT0FUIjsKICAgIHB1YmxpYyBTdHJpbmcgaW50ZWdlclR5cGVOYW1lID0g\nIklOVEVHRVIiOwogICAgcHVibGljIFN0cmluZyBqYXZhT2JqZWN0VHlwZU5h\nbWUgPSAiSkFWQV9PQkpFQ1QiOwogICAgcHVibGljIFN0cmluZyBsb25nVmFy\nYmluYXJ5VHlwZU5hbWUgPSAiTE9OR1ZBUkJJTkFSWSI7CiAgICBwdWJsaWMg\nU3RyaW5nIGxvbmdWYXJjaGFyVHlwZU5hbWUgPSAiTE9OR1ZBUkNIQVIiOwog\nICAgcHVibGljIFN0cmluZyBudWxsVHlwZU5hbWUgPSAiTlVMTCI7CiAgICBw\ndWJsaWMgU3RyaW5nIG51bWVyaWNUeXBlTmFtZSA9ICJOVU1FUklDIjsKICAg\nIHB1YmxpYyBTdHJpbmcgb3RoZXJUeXBlTmFtZSA9ICJPVEhFUiI7CiAgICBw\ndWJsaWMgU3RyaW5nIHJlYWxUeXBlTmFtZSA9ICJSRUFMIjsKICAgIHB1Ymxp\nYyBTdHJpbmcgcmVmVHlwZU5hbWUgPSAiUkVGIjsKICAgIHB1YmxpYyBTdHJp\nbmcgc21hbGxpbnRUeXBlTmFtZSA9ICJTTUFMTElOVCI7CiAgICBwdWJsaWMg\nU3RyaW5nIHN0cnVjdFR5cGVOYW1lID0gIlNUUlVDVCI7CiAgICBwdWJsaWMg\nU3RyaW5nIHRpbWVUeXBlTmFtZSA9ICJUSU1FIjsKICAgIHB1YmxpYyBTdHJp\nbmcgdGltZXN0YW1wVHlwZU5hbWUgPSAiVElNRVNUQU1QIjsKICAgIHB1Ymxp\nYyBTdHJpbmcgdGlueWludFR5cGVOYW1lID0gIlRJTllJTlQiOwogICAgcHVi\nbGljIFN0cmluZyB2YXJiaW5hcnlUeXBlTmFtZSA9ICJWQVJCSU5BUlkiOwog\nICAgcHVibGljIFN0cmluZyB2YXJjaGFyVHlwZU5hbWUgPSAiVkFSQ0hBUiI7\nCiAgICBwdWJsaWMgU3RyaW5nIHhtbFR5cGVOYW1lID0gIlhNTCI7CiAgICBw\ndWJsaWMgU3RyaW5nIGdldFN0cmluZ1ZhbCA9ICIiOwoKICAgIC8vIHNjaGVt\nYSBtZXRhZGF0YQogICAgcHVibGljIGJvb2xlYW4gdXNlU2NoZW1hTmFtZSA9\nIHRydWU7CiAgICBwdWJsaWMgU3RyaW5nIHRhYmxlVHlwZXMgPSAiVEFCTEUi\nOwogICAgcHVibGljIGJvb2xlYW4gc3VwcG9ydHNTY2hlbWFGb3JHZXRUYWJs\nZXMgPSB0cnVlOwogICAgcHVibGljIGJvb2xlYW4gc3VwcG9ydHNTY2hlbWFG\nb3JHZXRDb2x1bW5zID0gdHJ1ZTsKICAgIHB1YmxpYyBib29sZWFuIHN1cHBv\ncnRzTnVsbFRhYmxlRm9yR2V0Q29sdW1ucyA9IHRydWU7CiAgICBwdWJsaWMg\nYm9vbGVhbiBzdXBwb3J0c051bGxUYWJsZUZvckdldFByaW1hcnlLZXlzID0g\nZmFsc2U7CiAgICBwdWJsaWMgYm9vbGVhbiBzdXBwb3J0c051bGxUYWJsZUZv\nckdldEluZGV4SW5mbyA9IGZhbHNlOwogICAgcHVibGljIGJvb2xlYW4gc3Vw\ncG9ydHNOdWxsVGFibGVGb3JHZXRJbXBvcnRlZEtleXMgPSBmYWxzZTsKICAg\nIHB1YmxpYyBib29sZWFuIHVzZUdldEJlc3RSb3dJZGVudGlmaWVyRm9yUHJp\nbWFyeUtleXMgPSBmYWxzZTsKICAgIHB1YmxpYyBib29sZWFuIHJlcXVpcmVz\nQXV0b0NvbW1pdEZvck1ldGFEYXRhID0gZmFsc2U7CgogICAgLy8gYXV0by1p\nbmNyZW1lbnQKICAgIHB1YmxpYyBpbnQgbWF4QXV0b0Fzc2lnbk5hbWVMZW5n\ndGggPSAzMTsKICAgIHB1YmxpYyBTdHJpbmcgYXV0b0Fzc2lnbkNsYXVzZSA9\nIG51bGw7CiAgICBwdWJsaWMgU3RyaW5nIGF1dG9Bc3NpZ25UeXBlTmFtZSA9\nIG51bGw7CiAgICBwdWJsaWMgYm9vbGVhbiBzdXBwb3J0c0F1dG9Bc3NpZ24g\nPSBmYWxzZTsKICAgIHB1YmxpYyBTdHJpbmcgbGFzdEdlbmVyYXRlZEtleVF1\nZXJ5ID0gbnVsbDsKICAgIHB1YmxpYyBTdHJpbmcgbmV4dFNlcXVlbmNlUXVl\ncnkgPSBudWxsOwogICAgcHVibGljIFN0cmluZyBzZXF1ZW5jZVNRTCA9IG51\nbGw7CiAgICBwdWJsaWMgU3RyaW5nIHNlcXVlbmNlU2NoZW1hU1FMID0gbnVs\nbDsKICAgIHB1YmxpYyBTdHJpbmcgc2VxdWVuY2VOYW1lU1FMID0gbnVsbDsK\nCiAgICBwcm90ZWN0ZWQgSkRCQ0NvbmZpZ3VyYXRpb24gY29uZiA9IG51bGw7\nCiAgICBwcm90ZWN0ZWQgTG9nIGxvZyA9IG51bGw7CiAgICBwcm90ZWN0ZWQg\nYm9vbGVhbiBjb25uZWN0ZWQgPSBmYWxzZTsKICAgIHByb3RlY3RlZCBmaW5h\nbCBTZXQgcmVzZXJ2ZWRXb3JkU2V0ID0gbmV3IEhhc2hTZXQoKTsKICAgIHBy\nb3RlY3RlZCBmaW5hbCBTZXQgc3lzdGVtU2NoZW1hU2V0ID0gbmV3IEhhc2hT\nZXQoKTsKICAgIHByb3RlY3RlZCBmaW5hbCBTZXQgc3lzdGVtVGFibGVTZXQg\nPSBuZXcgSGFzaFNldCgpOwogICAgcHJvdGVjdGVkIGZpbmFsIFNldCBmaXhl\nZFNpemVUeXBlTmFtZVNldCA9IG5ldyBIYXNoU2V0KCk7CiAgICBwcm90ZWN0\nZWQgZmluYWwgU2V0IHR5cGVNb2RpZmllclNldCA9IG5ldyBIYXNoU2V0KCk7\nCgogICAgLyoqCiAgICAgKiBJZiBhIG5hdGl2ZSBxdWVyeSBiZWdpbnMgd2l0\naCBhbnkgb2YgdGhlIHZhbHVlcyBmb3VuZCBoZXJlIHRoZW4gaXQgd2lsbAog\nICAgICogYmUgdHJlYXRlZCBhcyBhIHNlbGVjdCBzdGF0ZW1lbnQuICAKICAg\nICAqLwogICAgcHJvdGVjdGVkIGZpbmFsIFNldCBzZWxlY3RXb3JkU2V0ID0g\nbmV3IEhhc2hTZXQoKTsKCiAgICAvLyB3aGVuIHdlIHN0b3JlIHZhbHVlcyB0\naGF0IGxvc2UgcHJlY2lvbiwgdHJhY2sgdGhlIHR5cGVzIHNvIHRoYXQgdGhl\nCiAgICAvLyBmaXJzdCB0aW1lIGl0IGhhcHBlbnMgd2UgY2FuIHdhcm4gdGhl\nIHVzZXIKICAgIHByaXZhdGUgU2V0IF9wcmVjaXNpb25XYXJuZWRUeXBlcyA9\nIG51bGw7CgogICAgLy8gY2FjaGUgbG9iIG1ldGhvZHMKICAgIHByaXZhdGUg\nTWV0aG9kIF9zZXRCeXRlcyA9IG51bGw7CiAgICBwcml2YXRlIE1ldGhvZCBf\nc2V0U3RyaW5nID0gbnVsbDsKICAgIHByaXZhdGUgTWV0aG9kIF9zZXRDaGFy\nU3RyZWFtID0gbnVsbDsKCiAgICAvLyBiYXRjaExpbWl0IHZhbHVlOgogICAg\nLy8gLTEgPSB1bmxpbWl0ZWQKICAgIC8vIDAgID0gbm8gYmF0Y2gKICAgIC8v\nIGFueSBwb3NpdGl2ZSBudW1iZXIgPSBiYXRjaCBsaW1pdAogICAgcHVibGlj\nIGludCBiYXRjaExpbWl0ID0gTk9fQkFUQ0g7CiAgICAKICAgIHB1YmxpYyBE\nQkRpY3Rpb25hcnkoKSB7CiAgICAgICAgZml4ZWRTaXplVHlwZU5hbWVTZXQu\nYWRkQWxsKEFycmF5cy5hc0xpc3QobmV3IFN0cmluZ1tdewogICAgICAgICAg\nICAiQklHSU5UIiwgIkJJVCIsICJCTE9CIiwgIkNMT0IiLCAiREFURSIsICJE\nRUNJTUFMIiwgIkRJU1RJTkNUIiwKICAgICAgICAgICAgIkRPVUJMRSIsICJG\nTE9BVCIsICJJTlRFR0VSIiwgIkpBVkFfT0JKRUNUIiwgIk5VTEwiLCAiTlVN\nRVJJQyIsCiAgICAgICAgICAgICJPVEhFUiIsICJSRUFMIiwgIlJFRiIsICJT\nTUFMTElOVCIsICJTVFJVQ1QiLCAiVElNRSIsICJUSU1FU1RBTVAiLAogICAg\nICAgICAgICAiVElOWUlOVCIsCiAgICAgICAgfSkpOwogICAgICAgIAogICAg\nICAgIHNlbGVjdFdvcmRTZXQuYWRkKCJTRUxFQ1QiKTsKICAgIH0KCiAgICAv\nKioKICAgICAqIFRoaXMgbWV0aG9kIGlzIGNhbGxlZCB3aGVuIHRoZSBkaWN0\naW9uYXJ5IGZpcnN0IHNlZXMgYW55IGNvbm5lY3Rpb24uCiAgICAgKiBJdCBp\ncyB1c2VkIHRvIGluaXRpYWxpemUgZGljdGlvbmFyeSBtZXRhZGF0YSBpZiBu\nZWVkZWQuIElmIHlvdQogICAgICogb3ZlcnJpZGUgdGhpcyBtZXRob2QsIGJl\nIHN1cmUgdG8gY2FsbAogICAgICogPGNvZGU+c3VwZXIuY29ubmVjdGVkQ29u\nZmlndXJhdGlvbjwvY29kZT4uCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIGNv\nbm5lY3RlZENvbmZpZ3VyYXRpb24oQ29ubmVjdGlvbiBjb25uKQogICAgICAg\nIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIGlmICghY29ubmVjdGVk\nKSB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBpZiAobG9n\nLmlzVHJhY2VFbmFibGVkKCkpCiAgICAgICAgICAgICAgICAgICAgbG9nLnRy\nYWNlKERCRGljdGlvbmFyeUZhY3RvcnkudG9TdHJpbmcKICAgICAgICAgICAg\nICAgICAgICAgICAgKGNvbm4uZ2V0TWV0YURhdGEoKSkpOwogICAgICAgICAg\nICB9IGNhdGNoIChFeGNlcHRpb24gZSkgewogICAgICAgICAgICAgICAgbG9n\nLnRyYWNlKGUudG9TdHJpbmcoKSwgZSk7CiAgICAgICAgICAgIH0KICAgICAg\nICB9CiAgICAgICAgY29ubmVjdGVkID0gdHJ1ZTsKICAgIH0KCiAgICAvLy8v\nLy8vLy8vLy8vLy8vLy8vLy8vCiAgICAvLyBSZXN1bHRTZXQgd3JhcHBlcnMK\nICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KCiAgICAvKioKICAgICAqIENv\nbnZlcnQgdGhlIHNwZWNpZmllZCBjb2x1bW4gb2YgdGhlIFNRTCBSZXN1bHRT\nZXQgdG8gdGhlIHByb3BlcgogICAgICogamF2YSB0eXBlLgogICAgICovCiAg\nICBwdWJsaWMgQXJyYXkgZ2V0QXJyYXkoUmVzdWx0U2V0IHJzLCBpbnQgY29s\ndW1uKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIHJl\ndHVybiBycy5nZXRBcnJheShjb2x1bW4pOwogICAgfQoKICAgIC8qKgogICAg\nICogQ29udmVydCB0aGUgc3BlY2lmaWVkIGNvbHVtbiBvZiB0aGUgU1FMIFJl\nc3VsdFNldCB0byB0aGUgcHJvcGVyCiAgICAgKiBqYXZhIHR5cGUuCiAgICAg\nKi8KICAgIHB1YmxpYyBJbnB1dFN0cmVhbSBnZXRBc2NpaVN0cmVhbShSZXN1\nbHRTZXQgcnMsIGludCBjb2x1bW4pCiAgICAgICAgdGhyb3dzIFNRTEV4Y2Vw\ndGlvbiB7CiAgICAgICAgcmV0dXJuIHJzLmdldEFzY2lpU3RyZWFtKGNvbHVt\nbik7CiAgICB9CgogICAgLyoqCiAgICAgKiBDb252ZXJ0IHRoZSBzcGVjaWZp\nZWQgY29sdW1uIG9mIHRoZSBTUUwgUmVzdWx0U2V0IHRvIHRoZSBwcm9wZXIK\nICAgICAqIGphdmEgdHlwZS4KICAgICAqLwogICAgcHVibGljIEJpZ0RlY2lt\nYWwgZ2V0QmlnRGVjaW1hbChSZXN1bHRTZXQgcnMsIGludCBjb2x1bW4pCiAg\nICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgaWYgKHN0b3Jl\nTGFyZ2VOdW1iZXJzQXNTdHJpbmdzKSB7CiAgICAgICAgICAgIFN0cmluZyBz\ndHIgPSBnZXRTdHJpbmcocnMsIGNvbHVtbik7CiAgICAgICAgICAgIHJldHVy\nbiAoc3RyID09IG51bGwpID8gbnVsbCA6IG5ldyBCaWdEZWNpbWFsKHN0cik7\nCiAgICAgICAgfQogICAgICAgIHJldHVybiBycy5nZXRCaWdEZWNpbWFsKGNv\nbHVtbik7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm5zIHRoZSBzcGVj\naWZpZWQgY29sdW1uIHZhbHVlIGFzIGFuIHVua25vd24gbnVtZXJpYyB0eXBl\nOwogICAgICogd2UgdHJ5IGZyb20gdGhlIG1vc3QgZ2VuZXJpYyB0byB0aGUg\nbGVhc3QgZ2VuZXJpYy4KICAgICAqLwogICAgcHVibGljIE51bWJlciBnZXRO\ndW1iZXIoUmVzdWx0U2V0IHJzLCBpbnQgY29sdW1uKQogICAgICAgIHRocm93\ncyBTUUxFeGNlcHRpb24gewogICAgICAgIC8vIHRyeSBmcm9tIHRoZSBtb3N0\nIGdlbmVyaWMsIGFuZCBpZiBlcnJvcnMgb2NjdXIsIHRyeQogICAgICAgIC8v\nIGxlc3MgZ2VuZXJpYyB0eXBlczsgdGhpcyBlbmFibGVzIHVzIHRvIGhhbmRs\nZSB2YWx1ZXMKICAgICAgICAvLyBsaWtlIERvdWJsZS5OYU4gd2l0aG91dCBo\nYXZpbmcgdG8gaW50cm9zcGVjdCBvbiB0aGUKICAgICAgICAvLyBSZXN1bHRT\nZXRNZXRhRGF0YSAoYnVnICMxMDUzKS4gbm90ZSB0aGF0IHdlIGhhbmRsZQog\nICAgICAgIC8vIGdlbmVyaWMgZXhjZXB0aW9ucywgc2luY2Ugc29tZSBkcml2\nZXJzIG1heSB0aHJvdwogICAgICAgIC8vIE51bWJlckZvcm1hdEV4Y2VwdGlv\nbnMsIHdoZXJlYXMgb3RoZXJzIG1heSB0aHJvdyBTUUxFeGNlcHRpb25zCiAg\nICAgICAgdHJ5IHsKICAgICAgICAgICAgcmV0dXJuIGdldEJpZ0RlY2ltYWwo\ncnMsIGNvbHVtbik7CiAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUxKSB7\nCiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICByZXR1cm4gbmV3\nIERvdWJsZShnZXREb3VibGUocnMsIGNvbHVtbikpOwogICAgICAgICAgICB9\nIGNhdGNoIChFeGNlcHRpb24gZTIpIHsKICAgICAgICAgICAgICAgIHRyeSB7\nCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBGbG9hdChnZXRGbG9h\ndChycywgY29sdW1uKSk7CiAgICAgICAgICAgICAgICB9IGNhdGNoIChFeGNl\ncHRpb24gZTMpIHsKICAgICAgICAgICAgICAgICAgICB0cnkgewogICAgICAg\nICAgICAgICAgICAgICAgICByZXR1cm4gTnVtYmVycy52YWx1ZU9mKGdldExv\nbmcocnMsIGNvbHVtbikpOwogICAgICAgICAgICAgICAgICAgIH0gY2F0Y2gg\nKEV4Y2VwdGlvbiBlNCkgewogICAgICAgICAgICAgICAgICAgICAgICB0cnkg\newogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIE51bWJlcnMu\ndmFsdWVPZihnZXRJbnQocnMsIGNvbHVtbikpOwogICAgICAgICAgICAgICAg\nICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZTUpIHsKICAgICAgICAgICAg\nICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAg\nICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKGUxIGlu\nc3RhbmNlb2YgUnVudGltZUV4Y2VwdGlvbikKICAgICAgICAgICAgICAgIHRo\ncm93KFJ1bnRpbWVFeGNlcHRpb24pIGUxOwogICAgICAgICAgICBpZiAoZTEg\naW5zdGFuY2VvZiBTUUxFeGNlcHRpb24pCiAgICAgICAgICAgICAgICB0aHJv\ndyhTUUxFeGNlcHRpb24pIGUxOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJu\nIG51bGw7CiAgICB9CgogICAgLyoqCiAgICAgKiBDb252ZXJ0IHRoZSBzcGVj\naWZpZWQgY29sdW1uIG9mIHRoZSBTUUwgUmVzdWx0U2V0IHRvIHRoZSBwcm9w\nZXIKICAgICAqIGphdmEgdHlwZS4KICAgICAqLwogICAgcHVibGljIEJpZ0lu\ndGVnZXIgZ2V0QmlnSW50ZWdlcihSZXN1bHRTZXQgcnMsIGludCBjb2x1bW4p\nCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgaWYgKHN0\nb3JlTGFyZ2VOdW1iZXJzQXNTdHJpbmdzKSB7CiAgICAgICAgICAgIFN0cmlu\nZyBzdHIgPSBnZXRTdHJpbmcocnMsIGNvbHVtbik7CiAgICAgICAgICAgIHJl\ndHVybiAoc3RyID09IG51bGwpID8gbnVsbCA6IG5ldyBCaWdEZWNpbWFsKHN0\ncikudG9CaWdJbnRlZ2VyKCk7CiAgICAgICAgfQogICAgICAgIEJpZ0RlY2lt\nYWwgYmQgPSBnZXRCaWdEZWNpbWFsKHJzLCBjb2x1bW4pOwogICAgICAgIHJl\ndHVybiAoYmQgPT0gbnVsbCkgPyBudWxsIDogYmQudG9CaWdJbnRlZ2VyKCk7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBDb252ZXJ0IHRoZSBzcGVjaWZpZWQg\nY29sdW1uIG9mIHRoZSBTUUwgUmVzdWx0U2V0IHRvIHRoZSBwcm9wZXIKICAg\nICAqIGphdmEgdHlwZS4KICAgICAqLwogICAgcHVibGljIElucHV0U3RyZWFt\nIGdldEJpbmFyeVN0cmVhbShSZXN1bHRTZXQgcnMsIGludCBjb2x1bW4pCiAg\nICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgcmV0dXJuIHJz\nLmdldEJpbmFyeVN0cmVhbShjb2x1bW4pOwogICAgfQoKICAgIHB1YmxpYyBJ\nbnB1dFN0cmVhbSBnZXRMT0JTdHJlYW0oSkRCQ1N0b3JlIHN0b3JlLCBSZXN1\nbHRTZXQgcnMsCiAgICAgICAgaW50IGNvbHVtbikgdGhyb3dzIFNRTEV4Y2Vw\ndGlvbiB7CiAgICAgICAgcmV0dXJuIHJzLmdldEJpbmFyeVN0cmVhbShjb2x1\nbW4pOwogICAgfQogICAgCiAgICAvKioKICAgICAqIENvbnZlcnQgdGhlIHNw\nZWNpZmllZCBjb2x1bW4gb2YgdGhlIFNRTCBSZXN1bHRTZXQgdG8gdGhlIHBy\nb3BlcgogICAgICogamF2YSB0eXBlLgogICAgICovCiAgICBwdWJsaWMgQmxv\nYiBnZXRCbG9iKFJlc3VsdFNldCBycywgaW50IGNvbHVtbikKICAgICAgICB0\naHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICByZXR1cm4gcnMuZ2V0Qmxv\nYihjb2x1bW4pOwogICAgfQoKICAgIC8qKgogICAgICogQ29udmVydCB0aGUg\nc3BlY2lmaWVkIGNvbHVtbiBvZiB0aGUgU1FMIFJlc3VsdFNldCB0byB0aGUg\ncHJvcGVyCiAgICAgKiBqYXZhIHR5cGUuCiAgICAgKi8KICAgIHB1YmxpYyBP\nYmplY3QgZ2V0QmxvYk9iamVjdChSZXN1bHRTZXQgcnMsIGludCBjb2x1bW4s\nIEpEQkNTdG9yZSBzdG9yZSkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9u\nIHsKICAgICAgICBJbnB1dFN0cmVhbSBpbiA9IG51bGw7CiAgICAgICAgaWYg\nKHVzZUdldEJ5dGVzRm9yQmxvYnMgfHwgdXNlR2V0T2JqZWN0Rm9yQmxvYnMp\nIHsKICAgICAgICAgICAgYnl0ZVtdIGJ5dGVzID0gZ2V0Qnl0ZXMocnMsIGNv\nbHVtbik7CiAgICAgICAgICAgIGlmIChieXRlcyAhPSBudWxsICYmIGJ5dGVz\nLmxlbmd0aCA+IDApCiAgICAgICAgICAgICAgICBpbiA9IG5ldyBCeXRlQXJy\nYXlJbnB1dFN0cmVhbShieXRlcyk7CiAgICAgICAgfSBlbHNlIHsKICAgICAg\nICAgICAgQmxvYiBibG9iID0gZ2V0QmxvYihycywgY29sdW1uKTsKICAgICAg\nICAgICAgaWYgKGJsb2IgIT0gbnVsbCAmJiBibG9iLmxlbmd0aCgpID4gMCkK\nICAgICAgICAgICAgICAgIGluID0gYmxvYi5nZXRCaW5hcnlTdHJlYW0oKTsK\nICAgICAgICB9CiAgICAgICAgaWYgKGluID09IG51bGwpCiAgICAgICAgICAg\nIHJldHVybiBudWxsOwoKICAgICAgICB0cnkgewogICAgICAgICAgICBpZiAo\nc3RvcmUgPT0gbnVsbCkKICAgICAgICAgICAgICAgIHJldHVybiBTZXJpYWxp\nemF0aW9uLmRlc2VyaWFsaXplKGluLCBudWxsKTsKICAgICAgICAgICAgcmV0\ndXJuIFNlcmlhbGl6YXRpb24uZGVzZXJpYWxpemUoaW4sIHN0b3JlLmdldENv\nbnRleHQoKSk7CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgdHJ5\nIHsKICAgICAgICAgICAgICAgIGluLmNsb3NlKCk7CiAgICAgICAgICAgIH0g\nY2F0Y2ggKElPRXhjZXB0aW9uIGlvZSkgewogICAgICAgICAgICB9CiAgICAg\nICAgfQogICAgfQoKICAgIC8qKgogICAgICogQ29udmVydCB0aGUgc3BlY2lm\naWVkIGNvbHVtbiBvZiB0aGUgU1FMIFJlc3VsdFNldCB0byB0aGUgcHJvcGVy\nCiAgICAgKiBqYXZhIHR5cGUuCiAgICAgKi8KICAgIHB1YmxpYyBib29sZWFu\nIGdldEJvb2xlYW4oUmVzdWx0U2V0IHJzLCBpbnQgY29sdW1uKQogICAgICAg\nIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIHJldHVybiBycy5nZXRC\nb29sZWFuKGNvbHVtbik7CiAgICB9CgogICAgLyoqCiAgICAgKiBDb252ZXJ0\nIHRoZSBzcGVjaWZpZWQgY29sdW1uIG9mIHRoZSBTUUwgUmVzdWx0U2V0IHRv\nIHRoZSBwcm9wZXIKICAgICAqIGphdmEgdHlwZS4KICAgICAqLwogICAgcHVi\nbGljIGJ5dGUgZ2V0Qnl0ZShSZXN1bHRTZXQgcnMsIGludCBjb2x1bW4pCiAg\nICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgcmV0dXJuIHJz\nLmdldEJ5dGUoY29sdW1uKTsKICAgIH0KCiAgICAvKioKICAgICAqIENvbnZl\ncnQgdGhlIHNwZWNpZmllZCBjb2x1bW4gb2YgdGhlIFNRTCBSZXN1bHRTZXQg\ndG8gdGhlIHByb3BlcgogICAgICogamF2YSB0eXBlLgogICAgICovCiAgICBw\ndWJsaWMgYnl0ZVtdIGdldEJ5dGVzKFJlc3VsdFNldCBycywgaW50IGNvbHVt\nbikKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBpZiAo\ndXNlR2V0Qnl0ZXNGb3JCbG9icykKICAgICAgICAgICAgcmV0dXJuIHJzLmdl\ndEJ5dGVzKGNvbHVtbik7CiAgICAgICAgaWYgKHVzZUdldE9iamVjdEZvckJs\nb2JzKQogICAgICAgICAgICByZXR1cm4gKGJ5dGVbXSkgcnMuZ2V0T2JqZWN0\nKGNvbHVtbik7CgogICAgICAgIEJsb2IgYmxvYiA9IGdldEJsb2IocnMsIGNv\nbHVtbik7CiAgICAgICAgaWYgKGJsb2IgPT0gbnVsbCkKICAgICAgICAgICAg\ncmV0dXJuIG51bGw7CiAgICAgICAgaW50IGxlbmd0aCA9IChpbnQpIGJsb2Iu\nbGVuZ3RoKCk7CiAgICAgICAgaWYgKGxlbmd0aCA9PSAwKQogICAgICAgICAg\nICByZXR1cm4gbnVsbDsKICAgICAgICByZXR1cm4gYmxvYi5nZXRCeXRlcygx\nLCBsZW5ndGgpOwogICAgfQoKICAgIC8qKgogICAgICogQ29udmVydCB0aGUg\nc3BlY2lmaWVkIGNvbHVtbiBvZiB0aGUgU1FMIFJlc3VsdFNldCB0byB0aGUg\ncHJvcGVyCiAgICAgKiBqYXZhIHR5cGUuIENvbnZlcnRzIHRoZSBkYXRlIGZy\nb20gYSB7QGxpbmsgVGltZXN0YW1wfSBieSBkZWZhdWx0LgogICAgICovCiAg\nICBwdWJsaWMgQ2FsZW5kYXIgZ2V0Q2FsZW5kYXIoUmVzdWx0U2V0IHJzLCBp\nbnQgY29sdW1uKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAg\nICAgIERhdGUgZCA9IGdldERhdGUocnMsIGNvbHVtbik7CiAgICAgICAgaWYg\nKGQgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIG51bGw7CgogICAgICAg\nIENhbGVuZGFyIGNhbCA9IENhbGVuZGFyLmdldEluc3RhbmNlKCk7CiAgICAg\nICAgY2FsLnNldFRpbWUoZCk7CiAgICAgICAgcmV0dXJuIGNhbDsKICAgIH0K\nCiAgICAvKioKICAgICAqIENvbnZlcnQgdGhlIHNwZWNpZmllZCBjb2x1bW4g\nb2YgdGhlIFNRTCBSZXN1bHRTZXQgdG8gdGhlIHByb3BlcgogICAgICogamF2\nYSB0eXBlLgogICAgICovCiAgICBwdWJsaWMgY2hhciBnZXRDaGFyKFJlc3Vs\ndFNldCBycywgaW50IGNvbHVtbikKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0\naW9uIHsKICAgICAgICBpZiAoc3RvcmVDaGFyc0FzTnVtYmVycykKICAgICAg\nICAgICAgcmV0dXJuIChjaGFyKSBnZXRJbnQocnMsIGNvbHVtbik7CgogICAg\nICAgIFN0cmluZyBzdHIgPSBnZXRTdHJpbmcocnMsIGNvbHVtbik7CiAgICAg\nICAgcmV0dXJuIChTdHJpbmdVdGlscy5pc0VtcHR5KHN0cikpID8gMCA6IHN0\nci5jaGFyQXQoMCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBDb252ZXJ0IHRo\nZSBzcGVjaWZpZWQgY29sdW1uIG9mIHRoZSBTUUwgUmVzdWx0U2V0IHRvIHRo\nZSBwcm9wZXIKICAgICAqIGphdmEgdHlwZS4KICAgICAqLwogICAgcHVibGlj\nIFJlYWRlciBnZXRDaGFyYWN0ZXJTdHJlYW0oUmVzdWx0U2V0IHJzLCBpbnQg\nY29sdW1uKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAg\nIHJldHVybiBycy5nZXRDaGFyYWN0ZXJTdHJlYW0oY29sdW1uKTsKICAgIH0K\nCiAgICAvKioKICAgICAqIENvbnZlcnQgdGhlIHNwZWNpZmllZCBjb2x1bW4g\nb2YgdGhlIFNRTCBSZXN1bHRTZXQgdG8gdGhlIHByb3BlcgogICAgICogamF2\nYSB0eXBlLgogICAgICovCiAgICBwdWJsaWMgQ2xvYiBnZXRDbG9iKFJlc3Vs\ndFNldCBycywgaW50IGNvbHVtbikKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0\naW9uIHsKICAgICAgICByZXR1cm4gcnMuZ2V0Q2xvYihjb2x1bW4pOwogICAg\nfQoKICAgIC8qKgogICAgICogQ29udmVydCB0aGUgc3BlY2lmaWVkIGNvbHVt\nbiBvZiB0aGUgU1FMIFJlc3VsdFNldCB0byB0aGUgcHJvcGVyCiAgICAgKiBq\nYXZhIHR5cGUuCiAgICAgKi8KICAgIHB1YmxpYyBTdHJpbmcgZ2V0Q2xvYlN0\ncmluZyhSZXN1bHRTZXQgcnMsIGludCBjb2x1bW4pCiAgICAgICAgdGhyb3dz\nIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgaWYgKHVzZUdldFN0cmluZ0ZvckNs\nb2JzKQogICAgICAgICAgICByZXR1cm4gcnMuZ2V0U3RyaW5nKGNvbHVtbik7\nCgogICAgICAgIENsb2IgY2xvYiA9IGdldENsb2IocnMsIGNvbHVtbik7CiAg\nICAgICAgaWYgKGNsb2IgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIG51\nbGw7CiAgICAgICAgaWYgKGNsb2IubGVuZ3RoKCkgPT0gMCkKICAgICAgICAg\nICAgcmV0dXJuICIiOwoKICAgICAgICAvLyB1bmxpa2VseSB0aGF0IHdlJ2xs\nIGhhdmUgc3RyaW5ncyBvdmVyIEludGVnZXIuTUFYX1ZBTFVFIGNoYXJzCiAg\nICAgICAgcmV0dXJuIGNsb2IuZ2V0U3ViU3RyaW5nKDEsIChpbnQpIGNsb2Iu\nbGVuZ3RoKCkpOwogICAgfQoKICAgIC8qKgogICAgICogQ29udmVydCB0aGUg\nc3BlY2lmaWVkIGNvbHVtbiBvZiB0aGUgU1FMIFJlc3VsdFNldCB0byB0aGUg\ncHJvcGVyCiAgICAgKiBqYXZhIHR5cGUuIENvbnZlcnRzIHRoZSBkYXRlIGZy\nb20gYSB7QGxpbmsgVGltZXN0YW1wfSBieSBkZWZhdWx0LgogICAgICovCiAg\nICBwdWJsaWMgRGF0ZSBnZXREYXRlKFJlc3VsdFNldCBycywgaW50IGNvbHVt\nbikKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBUaW1l\nc3RhbXAgdHN0YW1wID0gZ2V0VGltZXN0YW1wKHJzLCBjb2x1bW4sIG51bGwp\nOwogICAgICAgIGlmICh0c3RhbXAgPT0gbnVsbCkKICAgICAgICAgICAgcmV0\ndXJuIG51bGw7CgogICAgICAgIC8vIGdldCB0aGUgZnJhY3Rpb25hbCBzZWNv\nbmRzIGNvbXBvbmVudCwgcm91bmRpbmcgYXdheSBhbnl0aGluZyBiZXlvbmQK\nICAgICAgICAvLyBtaWxsaXNlY29uZHMKICAgICAgICBpbnQgZnJhY3Rpb25h\nbCA9IChpbnQpIE1hdGgucm91bmQodHN0YW1wLmdldE5hbm9zKCkgLyAoZG91\nYmxlKSBNSUxMSSk7CgogICAgICAgIC8vIGdldCB0aGUgbWlsbGlzIGNvbXBv\nbmVudDsgc29tZSBKREJDIGRyaXZlcnMgcm91bmQgdGhpcyB0byB0aGUKICAg\nICAgICAvLyBuZWFyZXN0IHNlY29uZCwgd2hpbGUgb3RoZXJzIGRvIG5vdAog\nICAgICAgIGxvbmcgbWlsbGlzID0gKHRzdGFtcC5nZXRUaW1lKCkgLyAxMDAw\nTCkgKiAxMDAwTDsKICAgICAgICByZXR1cm4gbmV3IERhdGUobWlsbGlzICsg\nZnJhY3Rpb25hbCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBDb252ZXJ0IHRo\nZSBzcGVjaWZpZWQgY29sdW1uIG9mIHRoZSBTUUwgUmVzdWx0U2V0IHRvIHRo\nZSBwcm9wZXIKICAgICAqIGphdmEgdHlwZS4KICAgICAqLwogICAgcHVibGlj\nIGphdmEuc3FsLkRhdGUgZ2V0RGF0ZShSZXN1bHRTZXQgcnMsIGludCBjb2x1\nbW4sIENhbGVuZGFyIGNhbCkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9u\nIHsKICAgICAgICBpZiAoY2FsID09IG51bGwpCiAgICAgICAgICAgIHJldHVy\nbiBycy5nZXREYXRlKGNvbHVtbik7CiAgICAgICAgcmV0dXJuIHJzLmdldERh\ndGUoY29sdW1uLCBjYWwpOwogICAgfQoKICAgIC8qKgogICAgICogQ29udmVy\ndCB0aGUgc3BlY2lmaWVkIGNvbHVtbiBvZiB0aGUgU1FMIFJlc3VsdFNldCB0\nbyB0aGUgcHJvcGVyCiAgICAgKiBqYXZhIHR5cGUuCiAgICAgKi8KICAgIHB1\nYmxpYyBkb3VibGUgZ2V0RG91YmxlKFJlc3VsdFNldCBycywgaW50IGNvbHVt\nbikKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICByZXR1\ncm4gcnMuZ2V0RG91YmxlKGNvbHVtbik7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBDb252ZXJ0IHRoZSBzcGVjaWZpZWQgY29sdW1uIG9mIHRoZSBTUUwgUmVz\ndWx0U2V0IHRvIHRoZSBwcm9wZXIKICAgICAqIGphdmEgdHlwZS4KICAgICAq\nLwogICAgcHVibGljIGZsb2F0IGdldEZsb2F0KFJlc3VsdFNldCBycywgaW50\nIGNvbHVtbikKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAg\nICByZXR1cm4gcnMuZ2V0RmxvYXQoY29sdW1uKTsKICAgIH0KCiAgICAvKioK\nICAgICAqIENvbnZlcnQgdGhlIHNwZWNpZmllZCBjb2x1bW4gb2YgdGhlIFNR\nTCBSZXN1bHRTZXQgdG8gdGhlIHByb3BlcgogICAgICogamF2YSB0eXBlLgog\nICAgICovCiAgICBwdWJsaWMgaW50IGdldEludChSZXN1bHRTZXQgcnMsIGlu\ndCBjb2x1bW4pCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAg\nICAgcmV0dXJuIHJzLmdldEludChjb2x1bW4pOwogICAgfQoKICAgIC8qKgog\nICAgICogQ29udmVydCB0aGUgc3BlY2lmaWVkIGNvbHVtbiBvZiB0aGUgU1FM\nIFJlc3VsdFNldCB0byB0aGUgcHJvcGVyCiAgICAgKiBqYXZhIHR5cGUuCiAg\nICAgKi8KICAgIHB1YmxpYyBMb2NhbGUgZ2V0TG9jYWxlKFJlc3VsdFNldCBy\ncywgaW50IGNvbHVtbikKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsK\nICAgICAgICBTdHJpbmcgc3RyID0gZ2V0U3RyaW5nKHJzLCBjb2x1bW4pOwog\nICAgICAgIGlmIChTdHJpbmdVdGlscy5pc0VtcHR5KHN0cikpCiAgICAgICAg\nICAgIHJldHVybiBudWxsOwoKICAgICAgICBTdHJpbmdbXSBwYXJhbXMgPSBT\ndHJpbmdzLnNwbGl0KHN0ciwgIl8iLCAzKTsKICAgICAgICBpZiAocGFyYW1z\nLmxlbmd0aCA8IDMpCiAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAg\nIHJldHVybiBuZXcgTG9jYWxlKHBhcmFtc1swXSwgcGFyYW1zWzFdLCBwYXJh\nbXNbMl0pOwogICAgfQoKICAgIC8qKgogICAgICogQ29udmVydCB0aGUgc3Bl\nY2lmaWVkIGNvbHVtbiBvZiB0aGUgU1FMIFJlc3VsdFNldCB0byB0aGUgcHJv\ncGVyCiAgICAgKiBqYXZhIHR5cGUuCiAgICAgKi8KICAgIHB1YmxpYyBsb25n\nIGdldExvbmcoUmVzdWx0U2V0IHJzLCBpbnQgY29sdW1uKQogICAgICAgIHRo\ncm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIHJldHVybiBycy5nZXRMb25n\nKGNvbHVtbik7CiAgICB9CgogICAgLyoqCiAgICAgKiBDb252ZXJ0IHRoZSBz\ncGVjaWZpZWQgY29sdW1uIG9mIHRoZSBTUUwgUmVzdWx0U2V0IHRvIHRoZSBw\ncm9wZXIKICAgICAqIGphdmEgdHlwZS4KICAgICAqLwogICAgcHVibGljIE9i\namVjdCBnZXRPYmplY3QoUmVzdWx0U2V0IHJzLCBpbnQgY29sdW1uLCBNYXAg\nbWFwKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIGlm\nIChtYXAgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIHJzLmdldE9iamVj\ndChjb2x1bW4pOwogICAgICAgIHJldHVybiBycy5nZXRPYmplY3QoY29sdW1u\nLCBtYXApOwogICAgfQoKICAgIC8qKgogICAgICogQ29udmVydCB0aGUgc3Bl\nY2lmaWVkIGNvbHVtbiBvZiB0aGUgU1FMIFJlc3VsdFNldCB0byB0aGUgcHJv\ncGVyCiAgICAgKiBqYXZhIHR5cGUuCiAgICAgKi8KICAgIHB1YmxpYyBSZWYg\nZ2V0UmVmKFJlc3VsdFNldCBycywgaW50IGNvbHVtbiwgTWFwIG1hcCkKICAg\nICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICByZXR1cm4gcnMu\nZ2V0UmVmKGNvbHVtbik7CiAgICB9CgogICAgLyoqCiAgICAgKiBDb252ZXJ0\nIHRoZSBzcGVjaWZpZWQgY29sdW1uIG9mIHRoZSBTUUwgUmVzdWx0U2V0IHRv\nIHRoZSBwcm9wZXIKICAgICAqIGphdmEgdHlwZS4KICAgICAqLwogICAgcHVi\nbGljIHNob3J0IGdldFNob3J0KFJlc3VsdFNldCBycywgaW50IGNvbHVtbikK\nICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICByZXR1cm4g\ncnMuZ2V0U2hvcnQoY29sdW1uKTsKICAgIH0KCiAgICAvKioKICAgICAqIENv\nbnZlcnQgdGhlIHNwZWNpZmllZCBjb2x1bW4gb2YgdGhlIFNRTCBSZXN1bHRT\nZXQgdG8gdGhlIHByb3BlcgogICAgICogamF2YSB0eXBlLgogICAgICovCiAg\nICBwdWJsaWMgU3RyaW5nIGdldFN0cmluZyhSZXN1bHRTZXQgcnMsIGludCBj\nb2x1bW4pCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAg\ncmV0dXJuIHJzLmdldFN0cmluZyhjb2x1bW4pOwogICAgfQoKICAgIC8qKgog\nICAgICogQ29udmVydCB0aGUgc3BlY2lmaWVkIGNvbHVtbiBvZiB0aGUgU1FM\nIFJlc3VsdFNldCB0byB0aGUgcHJvcGVyCiAgICAgKiBqYXZhIHR5cGUuCiAg\nICAgKi8KICAgIHB1YmxpYyBUaW1lIGdldFRpbWUoUmVzdWx0U2V0IHJzLCBp\nbnQgY29sdW1uLCBDYWxlbmRhciBjYWwpCiAgICAgICAgdGhyb3dzIFNRTEV4\nY2VwdGlvbiB7CiAgICAgICAgaWYgKGNhbCA9PSBudWxsKQogICAgICAgICAg\nICByZXR1cm4gcnMuZ2V0VGltZShjb2x1bW4pOwogICAgICAgIHJldHVybiBy\ncy5nZXRUaW1lKGNvbHVtbiwgY2FsKTsKICAgIH0KCiAgICAvKioKICAgICAq\nIENvbnZlcnQgdGhlIHNwZWNpZmllZCBjb2x1bW4gb2YgdGhlIFNRTCBSZXN1\nbHRTZXQgdG8gdGhlIHByb3BlcgogICAgICogamF2YSB0eXBlLgogICAgICov\nCiAgICBwdWJsaWMgVGltZXN0YW1wIGdldFRpbWVzdGFtcChSZXN1bHRTZXQg\ncnMsIGludCBjb2x1bW4sIENhbGVuZGFyIGNhbCkKICAgICAgICB0aHJvd3Mg\nU1FMRXhjZXB0aW9uIHsKICAgICAgICBpZiAoY2FsID09IG51bGwpCiAgICAg\nICAgICAgIHJldHVybiBycy5nZXRUaW1lc3RhbXAoY29sdW1uKTsKICAgICAg\nICByZXR1cm4gcnMuZ2V0VGltZXN0YW1wKGNvbHVtbiwgY2FsKTsKICAgIH0K\nCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KICAgIC8vIFBy\nZXBhcmVkU3RhdGVtZW50IHdyYXBwZXJzCiAgICAvLy8vLy8vLy8vLy8vLy8v\nLy8vLy8vLy8vLy8vLy8KCiAgICAvKioKICAgICAqIFNldCB0aGUgZ2l2ZW4g\ndmFsdWUgYXMgYSBwYXJhbWV0ZXIgdG8gdGhlIHN0YXRlbWVudC4KICAgICAq\nLwogICAgcHVibGljIHZvaWQgc2V0QXJyYXkoUHJlcGFyZWRTdGF0ZW1lbnQg\nc3RtbnQsIGludCBpZHgsIEFycmF5IHZhbCwKICAgICAgICBDb2x1bW4gY29s\nKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIHN0bW50\nLnNldEFycmF5KGlkeCwgdmFsKTsKICAgIH0KCiAgICAvKioKICAgICAqIFNl\ndCB0aGUgZ2l2ZW4gdmFsdWUgYXMgYSBwYXJhbWV0ZXIgdG8gdGhlIHN0YXRl\nbWVudC4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0QXNjaWlTdHJlYW0o\nUHJlcGFyZWRTdGF0ZW1lbnQgc3RtbnQsIGludCBpZHgsCiAgICAgICAgSW5w\ndXRTdHJlYW0gdmFsLCBpbnQgbGVuZ3RoLCBDb2x1bW4gY29sKQogICAgICAg\nIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIHN0bW50LnNldEFzY2lp\nU3RyZWFtKGlkeCwgdmFsLCBsZW5ndGgpOwogICAgfQoKICAgIC8qKgogICAg\nICogU2V0IHRoZSBnaXZlbiB2YWx1ZSBhcyBhIHBhcmFtZXRlciB0byB0aGUg\nc3RhdGVtZW50LgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRCaWdEZWNp\nbWFsKFByZXBhcmVkU3RhdGVtZW50IHN0bW50LCBpbnQgaWR4LCBCaWdEZWNp\nbWFsIHZhbCwKICAgICAgICBDb2x1bW4gY29sKQogICAgICAgIHRocm93cyBT\nUUxFeGNlcHRpb24gewogICAgICAgIGlmICgoY29sICE9IG51bGwgJiYgY29s\nLmlzQ29tcGF0aWJsZShUeXBlcy5WQVJDSEFSLCBudWxsLCAwLCAwKSkKICAg\nICAgICAgICAgfHwgKGNvbCA9PSBudWxsICYmIHN0b3JlTGFyZ2VOdW1iZXJz\nQXNTdHJpbmdzKSkKICAgICAgICAgICAgc2V0U3RyaW5nKHN0bW50LCBpZHgs\nIHZhbC50b1N0cmluZygpLCBjb2wpOwogICAgICAgIGVsc2UKICAgICAgICAg\nICAgc3RtbnQuc2V0QmlnRGVjaW1hbChpZHgsIHZhbCk7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBTZXQgdGhlIGdpdmVuIHZhbHVlIGFzIGEgcGFyYW1ldGVy\nIHRvIHRoZSBzdGF0ZW1lbnQuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNl\ndEJpZ0ludGVnZXIoUHJlcGFyZWRTdGF0ZW1lbnQgc3RtbnQsIGludCBpZHgs\nIEJpZ0ludGVnZXIgdmFsLAogICAgICAgIENvbHVtbiBjb2wpCiAgICAgICAg\ndGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgaWYgKChjb2wgIT0gbnVs\nbCAmJiBjb2wuaXNDb21wYXRpYmxlKFR5cGVzLlZBUkNIQVIsIG51bGwsIDAs\nIDApKQogICAgICAgICAgICB8fCAoY29sID09IG51bGwgJiYgc3RvcmVMYXJn\nZU51bWJlcnNBc1N0cmluZ3MpKQogICAgICAgICAgICBzZXRTdHJpbmcoc3Rt\nbnQsIGlkeCwgdmFsLnRvU3RyaW5nKCksIGNvbCk7CiAgICAgICAgZWxzZQog\nICAgICAgICAgICBzZXRCaWdEZWNpbWFsKHN0bW50LCBpZHgsIG5ldyBCaWdE\nZWNpbWFsKHZhbCksIGNvbCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBTZXQg\ndGhlIGdpdmVuIHZhbHVlIGFzIGEgcGFyYW1ldGVyIHRvIHRoZSBzdGF0ZW1l\nbnQuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldEJpbmFyeVN0cmVhbShQ\ncmVwYXJlZFN0YXRlbWVudCBzdG1udCwgaW50IGlkeCwKICAgICAgICBJbnB1\ndFN0cmVhbSB2YWwsIGludCBsZW5ndGgsIENvbHVtbiBjb2wpCiAgICAgICAg\ndGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgc3RtbnQuc2V0QmluYXJ5\nU3RyZWFtKGlkeCwgdmFsLCBsZW5ndGgpOwogICAgfQoKICAgIC8qKgogICAg\nICogU2V0IHRoZSBnaXZlbiB2YWx1ZSBhcyBhIHBhcmFtZXRlciB0byB0aGUg\nc3RhdGVtZW50LgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRCbG9iKFBy\nZXBhcmVkU3RhdGVtZW50IHN0bW50LCBpbnQgaWR4LCBCbG9iIHZhbCwgQ29s\ndW1uIGNvbCkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAg\nICBzdG1udC5zZXRCbG9iKGlkeCwgdmFsKTsKICAgIH0KCiAgICAvKioKICAg\nICAqIFNldCB0aGUgZ2l2ZW4gdmFsdWUgYXMgYSBwYXJhbWV0ZXIgdG8gdGhl\nIHN0YXRlbWVudC4gVXNlcyB0aGUKICAgICAqIHtAbGluayAjc2VyaWFsaXpl\nfSBtZXRob2QgdG8gc2VyaWFsaXplIHRoZSB2YWx1ZS4KICAgICAqLwogICAg\ncHVibGljIHZvaWQgc2V0QmxvYk9iamVjdChQcmVwYXJlZFN0YXRlbWVudCBz\ndG1udCwgaW50IGlkeCwgT2JqZWN0IHZhbCwKICAgICAgICBDb2x1bW4gY29s\nLCBKREJDU3RvcmUgc3RvcmUpCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlv\nbiB7CiAgICAgICAgc2V0Qnl0ZXMoc3RtbnQsIGlkeCwgc2VyaWFsaXplKHZh\nbCwgc3RvcmUpLCBjb2wpOwogICAgfQoKICAgIC8qKgogICAgICogU2V0IHRo\nZSBnaXZlbiB2YWx1ZSBhcyBhIHBhcmFtZXRlciB0byB0aGUgc3RhdGVtZW50\nLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRCb29sZWFuKFByZXBhcmVk\nU3RhdGVtZW50IHN0bW50LCBpbnQgaWR4LCBib29sZWFuIHZhbCwKICAgICAg\nICBDb2x1bW4gY29sKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewog\nICAgICAgIHN0bW50LnNldEludChpZHgsICh2YWwpID8gMSA6IDApOwogICAg\nfQoKICAgIC8qKgogICAgICogU2V0IHRoZSBnaXZlbiB2YWx1ZSBhcyBhIHBh\ncmFtZXRlciB0byB0aGUgc3RhdGVtZW50LgogICAgICovCiAgICBwdWJsaWMg\ndm9pZCBzZXRCeXRlKFByZXBhcmVkU3RhdGVtZW50IHN0bW50LCBpbnQgaWR4\nLCBieXRlIHZhbCwgQ29sdW1uIGNvbCkKICAgICAgICB0aHJvd3MgU1FMRXhj\nZXB0aW9uIHsKICAgICAgICBzdG1udC5zZXRCeXRlKGlkeCwgdmFsKTsKICAg\nIH0KCiAgICAvKioKICAgICAqIFNldCB0aGUgZ2l2ZW4gdmFsdWUgYXMgYSBw\nYXJhbWV0ZXIgdG8gdGhlIHN0YXRlbWVudC4KICAgICAqLwogICAgcHVibGlj\nIHZvaWQgc2V0Qnl0ZXMoUHJlcGFyZWRTdGF0ZW1lbnQgc3RtbnQsIGludCBp\nZHgsIGJ5dGVbXSB2YWwsCiAgICAgICAgQ29sdW1uIGNvbCkKICAgICAgICB0\naHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBpZiAodXNlU2V0Qnl0ZXNG\nb3JCbG9icykKICAgICAgICAgICAgc3RtbnQuc2V0Qnl0ZXMoaWR4LCB2YWwp\nOwogICAgICAgIGVsc2UKICAgICAgICAgICAgc2V0QmluYXJ5U3RyZWFtKHN0\nbW50LCBpZHgsIG5ldyBCeXRlQXJyYXlJbnB1dFN0cmVhbSh2YWwpLAogICAg\nICAgICAgICAgICAgdmFsLmxlbmd0aCwgY29sKTsKICAgIH0KCiAgICAvKioK\nICAgICAqIFNldCB0aGUgZ2l2ZW4gdmFsdWUgYXMgYSBwYXJhbWV0ZXIgdG8g\ndGhlIHN0YXRlbWVudC4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0Q2hh\ncihQcmVwYXJlZFN0YXRlbWVudCBzdG1udCwgaW50IGlkeCwgY2hhciB2YWws\nIENvbHVtbiBjb2wpCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAg\nICAgICAgaWYgKChjb2wgIT0gbnVsbCAmJiBjb2wuaXNDb21wYXRpYmxlKFR5\ncGVzLklOVEVHRVIsIG51bGwsIDAsIDApKQogICAgICAgICAgICB8fCAoY29s\nID09IG51bGwgJiYgc3RvcmVDaGFyc0FzTnVtYmVycykpCiAgICAgICAgICAg\nIHNldEludChzdG1udCwgaWR4LCAoaW50KSB2YWwsIGNvbCk7CiAgICAgICAg\nZWxzZQogICAgICAgICAgICBzZXRTdHJpbmcoc3RtbnQsIGlkeCwgU3RyaW5n\nLnZhbHVlT2YodmFsKSwgY29sKTsKICAgIH0KCiAgICAvKioKICAgICAqIFNl\ndCB0aGUgZ2l2ZW4gdmFsdWUgYXMgYSBwYXJhbWV0ZXIgdG8gdGhlIHN0YXRl\nbWVudC4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0Q2hhcmFjdGVyU3Ry\nZWFtKFByZXBhcmVkU3RhdGVtZW50IHN0bW50LCBpbnQgaWR4LAogICAgICAg\nIFJlYWRlciB2YWwsIGludCBsZW5ndGgsIENvbHVtbiBjb2wpCiAgICAgICAg\ndGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgc3RtbnQuc2V0Q2hhcmFj\ndGVyU3RyZWFtKGlkeCwgdmFsLCBsZW5ndGgpOwogICAgfQoKICAgIC8qKgog\nICAgICogU2V0IHRoZSBnaXZlbiB2YWx1ZSBhcyBhIHBhcmFtZXRlciB0byB0\naGUgc3RhdGVtZW50LgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRDbG9i\nKFByZXBhcmVkU3RhdGVtZW50IHN0bW50LCBpbnQgaWR4LCBDbG9iIHZhbCwg\nQ29sdW1uIGNvbCkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAg\nICAgICBzdG1udC5zZXRDbG9iKGlkeCwgdmFsKTsKICAgIH0KCiAgICAvKioK\nICAgICAqIFNldCB0aGUgZ2l2ZW4gdmFsdWUgYXMgYSBwYXJhbWV0ZXIgdG8g\ndGhlIHN0YXRlbWVudC4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0Q2xv\nYlN0cmluZyhQcmVwYXJlZFN0YXRlbWVudCBzdG1udCwgaW50IGlkeCwgU3Ry\naW5nIHZhbCwKICAgICAgICBDb2x1bW4gY29sKQogICAgICAgIHRocm93cyBT\nUUxFeGNlcHRpb24gewogICAgICAgIGlmICh1c2VTZXRTdHJpbmdGb3JDbG9i\ncykKICAgICAgICAgICAgc3RtbnQuc2V0U3RyaW5nKGlkeCwgdmFsKTsKICAg\nICAgICBlbHNlIHsKICAgICAgICAgICAgLy8gc2V0IHJlYWRlciBmcm9tIHN0\ncmluZwogICAgICAgICAgICBTdHJpbmdSZWFkZXIgaW4gPSBuZXcgU3RyaW5n\nUmVhZGVyKHZhbCk7CiAgICAgICAgICAgIHNldENoYXJhY3RlclN0cmVhbShz\ndG1udCwgaWR4LCBpbiwgdmFsLmxlbmd0aCgpLCBjb2wpOwogICAgICAgIH0K\nICAgIH0KCiAgICAvKioKICAgICAqIFNldCB0aGUgZ2l2ZW4gdmFsdWUgYXMg\nYSBwYXJhbWV0ZXIgdG8gdGhlIHN0YXRlbWVudC4KICAgICAqLwogICAgcHVi\nbGljIHZvaWQgc2V0RGF0ZShQcmVwYXJlZFN0YXRlbWVudCBzdG1udCwgaW50\nIGlkeCwgRGF0ZSB2YWwsIENvbHVtbiBjb2wpCiAgICAgICAgdGhyb3dzIFNR\nTEV4Y2VwdGlvbiB7CiAgICAgICAgaWYgKGNvbCAhPSBudWxsICYmIGNvbC5n\nZXRUeXBlKCkgPT0gVHlwZXMuREFURSkKICAgICAgICAgICAgc2V0RGF0ZShz\ndG1udCwgaWR4LCBuZXcgamF2YS5zcWwuRGF0ZSh2YWwuZ2V0VGltZSgpKSwg\nbnVsbCwgY29sKTsKICAgICAgICBlbHNlIGlmIChjb2wgIT0gbnVsbCAmJiBj\nb2wuZ2V0VHlwZSgpID09IFR5cGVzLlRJTUUpCiAgICAgICAgICAgIHNldFRp\nbWUoc3RtbnQsIGlkeCwgbmV3IFRpbWUodmFsLmdldFRpbWUoKSksIG51bGws\nIGNvbCk7CiAgICAgICAgZWxzZSBpZiAodmFsIGluc3RhbmNlb2YgVGltZXN0\nYW1wKQogICAgICAgICAgICBzZXRUaW1lc3RhbXAoc3RtbnQsIGlkeCwoVGlt\nZXN0YW1wKSB2YWwsIG51bGwsIGNvbCk7ICAgCiAgICAgICAgZWxzZQogICAg\nICAgICAgICBzZXRUaW1lc3RhbXAoc3RtbnQsIGlkeCwgbmV3IFRpbWVzdGFt\ncCh2YWwuZ2V0VGltZSgpKSwgbnVsbCwgY29sKTsKICAgIH0KCiAgICAvKioK\nICAgICAqIFNldCB0aGUgZ2l2ZW4gdmFsdWUgYXMgYSBwYXJhbWV0ZXIgdG8g\ndGhlIHN0YXRlbWVudC4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0RGF0\nZShQcmVwYXJlZFN0YXRlbWVudCBzdG1udCwgaW50IGlkeCwgamF2YS5zcWwu\nRGF0ZSB2YWwsCiAgICAgICAgQ2FsZW5kYXIgY2FsLCBDb2x1bW4gY29sKQog\nICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIGlmIChjYWwg\nPT0gbnVsbCkKICAgICAgICAgICAgc3RtbnQuc2V0RGF0ZShpZHgsIHZhbCk7\nCiAgICAgICAgZWxzZQogICAgICAgICAgICBzdG1udC5zZXREYXRlKGlkeCwg\ndmFsLCBjYWwpOwogICAgfQoKICAgIC8qKgogICAgICogU2V0IHRoZSBnaXZl\nbiB2YWx1ZSBhcyBhIHBhcmFtZXRlciB0byB0aGUgc3RhdGVtZW50LgogICAg\nICovCiAgICBwdWJsaWMgdm9pZCBzZXRDYWxlbmRhcihQcmVwYXJlZFN0YXRl\nbWVudCBzdG1udCwgaW50IGlkeCwgQ2FsZW5kYXIgdmFsLAogICAgICAgIENv\nbHVtbiBjb2wpCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAg\nICAgLy8gYnkgZGVmYXVsdCB3ZSBtZXJlbHkgZGVsZWdhdGUgdGhlIHRoZSBE\nYXRlIHBhcmFtZXRlcgogICAgICAgIHNldERhdGUoc3RtbnQsIGlkeCwgdmFs\nLmdldFRpbWUoKSwgY29sKTsKICAgIH0KCiAgICAvKioKICAgICAqIFNldCB0\naGUgZ2l2ZW4gdmFsdWUgYXMgYSBwYXJhbWV0ZXIgdG8gdGhlIHN0YXRlbWVu\ndC4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0RG91YmxlKFByZXBhcmVk\nU3RhdGVtZW50IHN0bW50LCBpbnQgaWR4LCBkb3VibGUgdmFsLAogICAgICAg\nIENvbHVtbiBjb2wpCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAg\nICAgICAgc3RtbnQuc2V0RG91YmxlKGlkeCwgdmFsKTsKICAgIH0KCiAgICAv\nKioKICAgICAqIFNldCB0aGUgZ2l2ZW4gdmFsdWUgYXMgYSBwYXJhbWV0ZXIg\ndG8gdGhlIHN0YXRlbWVudC4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0\nRmxvYXQoUHJlcGFyZWRTdGF0ZW1lbnQgc3RtbnQsIGludCBpZHgsIGZsb2F0\nIHZhbCwKICAgICAgICBDb2x1bW4gY29sKQogICAgICAgIHRocm93cyBTUUxF\neGNlcHRpb24gewogICAgICAgIHN0bW50LnNldEZsb2F0KGlkeCwgdmFsKTsK\nICAgIH0KCiAgICAvKioKICAgICAqIFNldCB0aGUgZ2l2ZW4gdmFsdWUgYXMg\nYSBwYXJhbWV0ZXIgdG8gdGhlIHN0YXRlbWVudC4KICAgICAqLwogICAgcHVi\nbGljIHZvaWQgc2V0SW50KFByZXBhcmVkU3RhdGVtZW50IHN0bW50LCBpbnQg\naWR4LCBpbnQgdmFsLCBDb2x1bW4gY29sKQogICAgICAgIHRocm93cyBTUUxF\neGNlcHRpb24gewogICAgICAgIHN0bW50LnNldEludChpZHgsIHZhbCk7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBTZXQgdGhlIGdpdmVuIHZhbHVlIGFzIGEg\ncGFyYW1ldGVyIHRvIHRoZSBzdGF0ZW1lbnQuCiAgICAgKi8KICAgIHB1Ymxp\nYyB2b2lkIHNldExvbmcoUHJlcGFyZWRTdGF0ZW1lbnQgc3RtbnQsIGludCBp\nZHgsIGxvbmcgdmFsLCBDb2x1bW4gY29sKQogICAgICAgIHRocm93cyBTUUxF\neGNlcHRpb24gewogICAgICAgIHN0bW50LnNldExvbmcoaWR4LCB2YWwpOwog\nICAgfQoKICAgIC8qKgogICAgICogU2V0IHRoZSBnaXZlbiB2YWx1ZSBhcyBh\nIHBhcmFtZXRlciB0byB0aGUgc3RhdGVtZW50LgogICAgICovCiAgICBwdWJs\naWMgdm9pZCBzZXRMb2NhbGUoUHJlcGFyZWRTdGF0ZW1lbnQgc3RtbnQsIGlu\ndCBpZHgsIExvY2FsZSB2YWwsCiAgICAgICAgQ29sdW1uIGNvbCkKICAgICAg\nICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBzZXRTdHJpbmcoc3Rt\nbnQsIGlkeCwgdmFsLmdldExhbmd1YWdlKCkgKyAiXyIgKyB2YWwuZ2V0Q291\nbnRyeSgpCiAgICAgICAgICAgICsgIl8iICsgdmFsLmdldFZhcmlhbnQoKSwg\nY29sKTsKICAgIH0KCiAgICAvKioKICAgICAqIFNldCB0aGUgZ2l2ZW4gdmFs\ndWUgYXMgYSBwYXJhbWV0ZXJzIHRvIHRoZSBzdGF0ZW1lbnQuIFRoZSBjb2x1\nbW4KICAgICAqIHR5cGUgd2lsbCBjb21lIGZyb20ge0BsaW5rIFR5cGVzfS4K\nICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0TnVsbChQcmVwYXJlZFN0YXRl\nbWVudCBzdG1udCwgaW50IGlkeCwgaW50IGNvbFR5cGUsCiAgICAgICAgQ29s\ndW1uIGNvbCkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAg\nICBzdG1udC5zZXROdWxsKGlkeCwgY29sVHlwZSk7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBTZXQgdGhlIGdpdmVuIHZhbHVlIGFzIGEgcGFyYW1ldGVyIHRv\nIHRoZSBzdGF0ZW1lbnQuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldE51\nbWJlcihQcmVwYXJlZFN0YXRlbWVudCBzdG1udCwgaW50IGlkeCwgTnVtYmVy\nIG51bSwKICAgICAgICBDb2x1bW4gY29sKQogICAgICAgIHRocm93cyBTUUxF\neGNlcHRpb24gewogICAgICAgIC8vIGNoZWNrIGZvciBrbm93biBmbG9hdGlu\nZyBwb2ludCB0eXBlcyB0byBnaXZlIGRyaXZlciBhIGNoYW5jZSB0bwogICAg\nICAgIC8vIGhhbmRsZSBzcGVjaWFsIG51bWJlcnMgbGlrZSBOYU4gYW5kIGlu\nZmluaXR5OyBidWcgIzEwNTMKICAgICAgICBpZiAobnVtIGluc3RhbmNlb2Yg\nRG91YmxlKQogICAgICAgICAgICBzZXREb3VibGUoc3RtbnQsIGlkeCwgKChE\nb3VibGUpIG51bSkuZG91YmxlVmFsdWUoKSwgY29sKTsKICAgICAgICBlbHNl\nIGlmIChudW0gaW5zdGFuY2VvZiBGbG9hdCkKICAgICAgICAgICAgc2V0Rmxv\nYXQoc3RtbnQsIGlkeCwgKChGbG9hdCkgbnVtKS5mbG9hdFZhbHVlKCksIGNv\nbCk7CiAgICAgICAgZWxzZQogICAgICAgICAgICBzZXRCaWdEZWNpbWFsKHN0\nbW50LCBpZHgsIG5ldyBCaWdEZWNpbWFsKG51bS50b1N0cmluZygpKSwgY29s\nKTsKICAgIH0KCiAgICAvKioKICAgICAqIFNldCB0aGUgZ2l2ZW4gdmFsdWUg\nYXMgYSBwYXJhbWV0ZXJzIHRvIHRoZSBzdGF0ZW1lbnQuIFRoZSBjb2x1bW4K\nICAgICAqIHR5cGUgd2lsbCBjb21lIGZyb20ge0BsaW5rIFR5cGVzfS4KICAg\nICAqLwogICAgcHVibGljIHZvaWQgc2V0T2JqZWN0KFByZXBhcmVkU3RhdGVt\nZW50IHN0bW50LCBpbnQgaWR4LCBPYmplY3QgdmFsLAogICAgICAgIGludCBj\nb2xUeXBlLCBDb2x1bW4gY29sKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRp\nb24gewogICAgICAgIGlmIChjb2xUeXBlID09IC0xIHx8IGNvbFR5cGUgPT0g\nVHlwZXMuT1RIRVIpCiAgICAgICAgICAgIHN0bW50LnNldE9iamVjdChpZHgs\nIHZhbCk7CiAgICAgICAgZWxzZQogICAgICAgICAgICBzdG1udC5zZXRPYmpl\nY3QoaWR4LCB2YWwsIGNvbFR5cGUpOwogICAgfQoKICAgIC8qKgogICAgICog\nU2V0IHRoZSBnaXZlbiB2YWx1ZSBhcyBhIHBhcmFtZXRlciB0byB0aGUgc3Rh\ndGVtZW50LgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRSZWYoUHJlcGFy\nZWRTdGF0ZW1lbnQgc3RtbnQsIGludCBpZHgsIFJlZiB2YWwsIENvbHVtbiBj\nb2wpCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgc3Rt\nbnQuc2V0UmVmKGlkeCwgdmFsKTsKICAgIH0KCiAgICAvKioKICAgICAqIFNl\ndCB0aGUgZ2l2ZW4gdmFsdWUgYXMgYSBwYXJhbWV0ZXIgdG8gdGhlIHN0YXRl\nbWVudC4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0U2hvcnQoUHJlcGFy\nZWRTdGF0ZW1lbnQgc3RtbnQsIGludCBpZHgsIHNob3J0IHZhbCwKICAgICAg\nICBDb2x1bW4gY29sKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewog\nICAgICAgIHN0bW50LnNldFNob3J0KGlkeCwgdmFsKTsKICAgIH0KCiAgICAv\nKioKICAgICAqIFNldCB0aGUgZ2l2ZW4gdmFsdWUgYXMgYSBwYXJhbWV0ZXIg\ndG8gdGhlIHN0YXRlbWVudC4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0\nU3RyaW5nKFByZXBhcmVkU3RhdGVtZW50IHN0bW50LCBpbnQgaWR4LCBTdHJp\nbmcgdmFsLAogICAgICAgIENvbHVtbiBjb2wpCiAgICAgICAgdGhyb3dzIFNR\nTEV4Y2VwdGlvbiB7CiAgICAgICAgc3RtbnQuc2V0U3RyaW5nKGlkeCwgdmFs\nKTsKICAgIH0KCiAgICAvKioKICAgICAqIFNldCB0aGUgZ2l2ZW4gdmFsdWUg\nYXMgYSBwYXJhbWV0ZXIgdG8gdGhlIHN0YXRlbWVudC4KICAgICAqLwogICAg\ncHVibGljIHZvaWQgc2V0VGltZShQcmVwYXJlZFN0YXRlbWVudCBzdG1udCwg\naW50IGlkeCwgVGltZSB2YWwsCiAgICAgICAgQ2FsZW5kYXIgY2FsLCBDb2x1\nbW4gY29sKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAg\nIGlmIChjYWwgPT0gbnVsbCkKICAgICAgICAgICAgc3RtbnQuc2V0VGltZShp\nZHgsIHZhbCk7CiAgICAgICAgZWxzZQogICAgICAgICAgICBzdG1udC5zZXRU\naW1lKGlkeCwgdmFsLCBjYWwpOwogICAgfQoKICAgIC8qKgogICAgICogU2V0\nIHRoZSBnaXZlbiB2YWx1ZSBhcyBhIHBhcmFtZXRlciB0byB0aGUgc3RhdGVt\nZW50LgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRUaW1lc3RhbXAoUHJl\ncGFyZWRTdGF0ZW1lbnQgc3RtbnQsIGludCBpZHgsCiAgICAgICAgVGltZXN0\nYW1wIHZhbCwgQ2FsZW5kYXIgY2FsLCBDb2x1bW4gY29sKQogICAgICAgIHRo\ncm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIC8vIGVuc3VyZSB0aGF0IHdl\nIGRvIG5vdCBpbnNlcnQgZGF0ZXMgYXQgYSBncmVhdGVyIHByZWNpc2lvbiB0\naGFuCiAgICAgICAgLy8gdGhhdCBhdCB3aGljaCB0aGV5IHdpbGwgYmUgcmV0\ndXJuZWQgYnkgYSBTRUxFQ1QKICAgICAgICBpbnQgcm91bmRlZCA9IChpbnQp\nIE1hdGgucm91bmQodmFsLmdldE5hbm9zKCkgLwogICAgICAgICAgICAoZG91\nYmxlKSBkYXRlUHJlY2lzaW9uKTsKICAgICAgICBpbnQgbmFub3MgPSByb3Vu\nZGVkICogZGF0ZVByZWNpc2lvbjsKICAgICAgICBpZiAobmFub3MgPiA5OTk5\nOTk5OTkpIHsKICAgICAgICAgICAgLy8gcm9sbG92ZXIgdG8gbmV4dCBzZWNv\nbmQKICAgICAgICAgICAgdmFsLnNldFRpbWUodmFsLmdldFRpbWUoKSArIDEw\nMDApOwogICAgICAgICAgICBuYW5vcyA9IDA7CiAgICAgICAgfQoKICAgICAg\nICBpZiAoc3VwcG9ydHNUaW1lc3RhbXBOYW5vcykKICAgICAgICAgICAgdmFs\nLnNldE5hbm9zKG5hbm9zKTsKICAgICAgICBlbHNlCiAgICAgICAgICAgIHZh\nbC5zZXROYW5vcygwKTsKCiAgICAgICAgaWYgKGNhbCA9PSBudWxsKQogICAg\nICAgICAgICBzdG1udC5zZXRUaW1lc3RhbXAoaWR4LCB2YWwpOwogICAgICAg\nIGVsc2UKICAgICAgICAgICAgc3RtbnQuc2V0VGltZXN0YW1wKGlkeCwgdmFs\nLCBjYWwpOwogICAgfQoKICAgIC8qKgogICAgICogU2V0IGEgY29sdW1uIHZh\nbHVlIGludG8gYSBwcmVwYXJlZCBzdGF0ZW1lbnQuCiAgICAgKgogICAgICog\nQHBhcmFtIHN0bW50IHRoZSBwcmVwYXJlZCBzdGF0ZW1lbnQgdG8gcGFyYW1l\ndGVyaXplCiAgICAgKiBAcGFyYW0gaWR4IHRoZSBpbmRleCBvZiB0aGUgcGFy\nYW1ldGVyIGluIHRoZSBwcmVwYXJlZCBzdGF0ZW1lbnQKICAgICAqIEBwYXJh\nbSB2YWwgdGhlIHZhbHVlIG9mIHRoZSBjb2x1bW4KICAgICAqIEBwYXJhbSBj\nb2wgdGhlIGNvbHVtbiBiZWluZyBzZXQKICAgICAqIEBwYXJhbSB0eXBlIHRo\nZSBmaWVsZCBtYXBwaW5nIHR5cGUgY29kZSBmb3IgdGhlIHZhbHVlCiAgICAg\nKiBAcGFyYW0gc3RvcmUgdGhlIHN0b3JlIG1hbmFnZXIgZm9yIHRoZSBjdXJy\nZW50IGNvbnRleHQKICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0VHlwZWQo\nUHJlcGFyZWRTdGF0ZW1lbnQgc3RtbnQsIGludCBpZHgsIE9iamVjdCB2YWws\nCiAgICAgICAgQ29sdW1uIGNvbCwgaW50IHR5cGUsIEpEQkNTdG9yZSBzdG9y\nZSkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBpZiAo\ndmFsID09IG51bGwpIHsKICAgICAgICAgICAgc2V0TnVsbChzdG1udCwgaWR4\nLCAoY29sID09IG51bGwpID8gVHlwZXMuT1RIRVIgOiBjb2wuZ2V0VHlwZSgp\nLAogICAgICAgICAgICAgICAgY29sKTsKICAgICAgICAgICAgcmV0dXJuOwog\nICAgICAgIH0KCiAgICAgICAgU2l6ZWQgczsKICAgICAgICBDYWxlbmRhcmQg\nYzsKICAgICAgICBzd2l0Y2ggKHR5cGUpIHsKICAgICAgICAgICAgY2FzZSBK\nYXZhVHlwZXMuQk9PTEVBTjoKICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMu\nQk9PTEVBTl9PQko6CiAgICAgICAgICAgICAgICBzZXRCb29sZWFuKHN0bW50\nLCBpZHgsICgoQm9vbGVhbikgdmFsKS5ib29sZWFuVmFsdWUoKSwgY29sKTsK\nICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIEphdmFU\neXBlcy5CWVRFOgogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5CWVRFX09C\nSjoKICAgICAgICAgICAgICAgIHNldEJ5dGUoc3RtbnQsIGlkeCwgKChOdW1i\nZXIpIHZhbCkuYnl0ZVZhbHVlKCksIGNvbCk7CiAgICAgICAgICAgICAgICBi\ncmVhazsKICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuQ0hBUjoKICAgICAg\nICAgICAgY2FzZSBKYXZhVHlwZXMuQ0hBUl9PQko6CiAgICAgICAgICAgICAg\nICBzZXRDaGFyKHN0bW50LCBpZHgsICgoQ2hhcmFjdGVyKSB2YWwpLmNoYXJW\nYWx1ZSgpLCBjb2wpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAg\nICAgIGNhc2UgSmF2YVR5cGVzLkRPVUJMRToKICAgICAgICAgICAgY2FzZSBK\nYXZhVHlwZXMuRE9VQkxFX09CSjoKICAgICAgICAgICAgICAgIHNldERvdWJs\nZShzdG1udCwgaWR4LCAoKE51bWJlcikgdmFsKS5kb3VibGVWYWx1ZSgpLCBj\nb2wpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2Ug\nSmF2YVR5cGVzLkZMT0FUOgogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5G\nTE9BVF9PQko6CiAgICAgICAgICAgICAgICBzZXRGbG9hdChzdG1udCwgaWR4\nLCAoKE51bWJlcikgdmFsKS5mbG9hdFZhbHVlKCksIGNvbCk7CiAgICAgICAg\nICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuSU5U\nOgogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5JTlRfT0JKOgogICAgICAg\nICAgICAgICAgc2V0SW50KHN0bW50LCBpZHgsICgoTnVtYmVyKSB2YWwpLmlu\ndFZhbHVlKCksIGNvbCk7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAg\nICAgICAgY2FzZSBKYXZhVHlwZXMuTE9ORzoKICAgICAgICAgICAgY2FzZSBK\nYXZhVHlwZXMuTE9OR19PQko6CiAgICAgICAgICAgICAgICBzZXRMb25nKHN0\nbW50LCBpZHgsICgoTnVtYmVyKSB2YWwpLmxvbmdWYWx1ZSgpLCBjb2wpOwog\nICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgSmF2YVR5\ncGVzLlNIT1JUOgogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5TSE9SVF9P\nQko6CiAgICAgICAgICAgICAgICBzZXRTaG9ydChzdG1udCwgaWR4LCAoKE51\nbWJlcikgdmFsKS5zaG9ydFZhbHVlKCksIGNvbCk7CiAgICAgICAgICAgICAg\nICBicmVhazsKICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuU1RSSU5HOgog\nICAgICAgICAgICAgICAgaWYgKGNvbCAhPSBudWxsICYmIChjb2wuZ2V0VHlw\nZSgpID09IFR5cGVzLkNMT0IKICAgICAgICAgICAgICAgICAgICB8fCBjb2wu\nZ2V0VHlwZSgpID09IFR5cGVzLkxPTkdWQVJDSEFSKSkKICAgICAgICAgICAg\nICAgICAgICBzZXRDbG9iU3RyaW5nKHN0bW50LCBpZHgsIChTdHJpbmcpIHZh\nbCwgY29sKTsKICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAg\nICAgICBzZXRTdHJpbmcoc3RtbnQsIGlkeCwgKFN0cmluZykgdmFsLCBjb2wp\nOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgSmF2\nYVR5cGVzLk9CSkVDVDoKICAgICAgICAgICAgICAgIHNldEJsb2JPYmplY3Qo\nc3RtbnQsIGlkeCwgdmFsLCBjb2wsIHN0b3JlKTsKICAgICAgICAgICAgICAg\nIGJyZWFrOwogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5EQVRFOgogICAg\nICAgICAgICAgICAgc2V0RGF0ZShzdG1udCwgaWR4LCAoRGF0ZSkgdmFsLCBj\nb2wpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2Ug\nSmF2YVR5cGVzLkNBTEVOREFSOgogICAgICAgICAgICAgICAgc2V0Q2FsZW5k\nYXIoc3RtbnQsIGlkeCwgKENhbGVuZGFyKSB2YWwsIGNvbCk7CiAgICAgICAg\nICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuQklH\nREVDSU1BTDoKICAgICAgICAgICAgICAgIHNldEJpZ0RlY2ltYWwoc3RtbnQs\nIGlkeCwgKEJpZ0RlY2ltYWwpIHZhbCwgY29sKTsKICAgICAgICAgICAgICAg\nIGJyZWFrOwogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5CSUdJTlRFR0VS\nOgogICAgICAgICAgICAgICAgc2V0QmlnSW50ZWdlcihzdG1udCwgaWR4LCAo\nQmlnSW50ZWdlcikgdmFsLCBjb2wpOwogICAgICAgICAgICAgICAgYnJlYWs7\nCiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLk5VTUJFUjoKICAgICAgICAg\nICAgICAgIHNldE51bWJlcihzdG1udCwgaWR4LCAoTnVtYmVyKSB2YWwsIGNv\nbCk7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSBK\nYXZhVHlwZXMuTE9DQUxFOgogICAgICAgICAgICAgICAgc2V0TG9jYWxlKHN0\nbW50LCBpZHgsIChMb2NhbGUpIHZhbCwgY29sKTsKICAgICAgICAgICAgICAg\nIGJyZWFrOwogICAgICAgICAgICBjYXNlIEphdmFTUUxUeXBlcy5TUUxfQVJS\nQVk6CiAgICAgICAgICAgICAgICBzZXRBcnJheShzdG1udCwgaWR4LCAoQXJy\nYXkpIHZhbCwgY29sKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAg\nICAgICBjYXNlIEphdmFTUUxUeXBlcy5BU0NJSV9TVFJFQU06CiAgICAgICAg\nICAgICAgICBzID0gKFNpemVkKSB2YWw7CiAgICAgICAgICAgICAgICBzZXRB\nc2NpaVN0cmVhbShzdG1udCwgaWR4LCAoSW5wdXRTdHJlYW0pIHMudmFsdWUs\nIHMuc2l6ZSwgY29sKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAg\nICAgICBjYXNlIEphdmFTUUxUeXBlcy5CSU5BUllfU1RSRUFNOgogICAgICAg\nICAgICAgICAgcyA9IChTaXplZCkgdmFsOwogICAgICAgICAgICAgICAgc2V0\nQmluYXJ5U3RyZWFtKHN0bW50LCBpZHgsIChJbnB1dFN0cmVhbSkgcy52YWx1\nZSwgcy5zaXplLCBjb2wpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAg\nICAgICAgIGNhc2UgSmF2YVNRTFR5cGVzLkJMT0I6CiAgICAgICAgICAgICAg\nICBzZXRCbG9iKHN0bW50LCBpZHgsIChCbG9iKSB2YWwsIGNvbCk7CiAgICAg\nICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSBKYXZhU1FMVHlw\nZXMuQllURVM6CiAgICAgICAgICAgICAgICBzZXRCeXRlcyhzdG1udCwgaWR4\nLCAoYnl0ZVtdKSB2YWwsIGNvbCk7CiAgICAgICAgICAgICAgICBicmVhazsK\nICAgICAgICAgICAgY2FzZSBKYXZhU1FMVHlwZXMuQ0hBUl9TVFJFQU06CiAg\nICAgICAgICAgICAgICBzID0gKFNpemVkKSB2YWw7CiAgICAgICAgICAgICAg\nICBzZXRDaGFyYWN0ZXJTdHJlYW0oc3RtbnQsIGlkeCwgKFJlYWRlcikgcy52\nYWx1ZSwgcy5zaXplLCBjb2wpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAg\nICAgICAgICAgIGNhc2UgSmF2YVNRTFR5cGVzLkNMT0I6CiAgICAgICAgICAg\nICAgICBzZXRDbG9iKHN0bW50LCBpZHgsIChDbG9iKSB2YWwsIGNvbCk7CiAg\nICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSBKYXZhU1FM\nVHlwZXMuU1FMX0RBVEU6CiAgICAgICAgICAgICAgICBpZiAodmFsIGluc3Rh\nbmNlb2YgQ2FsZW5kYXJkKSB7CiAgICAgICAgICAgICAgICAgICAgYyA9IChD\nYWxlbmRhcmQpIHZhbDsKICAgICAgICAgICAgICAgICAgICBzZXREYXRlKHN0\nbW50LCBpZHgsIChqYXZhLnNxbC5EYXRlKSBjLnZhbHVlLCBjLmNhbGVuZGFy\nLAogICAgICAgICAgICAgICAgICAgICAgICBjb2wpOwogICAgICAgICAgICAg\nICAgfSBlbHNlCiAgICAgICAgICAgICAgICAgICAgc2V0RGF0ZShzdG1udCwg\naWR4LCAoamF2YS5zcWwuRGF0ZSkgdmFsLCBudWxsLCBjb2wpOwogICAgICAg\nICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgSmF2YVNRTFR5cGVz\nLlJFRjoKICAgICAgICAgICAgICAgIHNldFJlZihzdG1udCwgaWR4LCAoUmVm\nKSB2YWwsIGNvbCk7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAg\nICAgY2FzZSBKYXZhU1FMVHlwZXMuVElNRToKICAgICAgICAgICAgICAgIGlm\nICh2YWwgaW5zdGFuY2VvZiBDYWxlbmRhcmQpIHsKICAgICAgICAgICAgICAg\nICAgICBjID0gKENhbGVuZGFyZCkgdmFsOwogICAgICAgICAgICAgICAgICAg\nIHNldFRpbWUoc3RtbnQsIGlkeCwgKFRpbWUpIGMudmFsdWUsIGMuY2FsZW5k\nYXIsIGNvbCk7CiAgICAgICAgICAgICAgICB9IGVsc2UKICAgICAgICAgICAg\nICAgICAgICBzZXRUaW1lKHN0bW50LCBpZHgsIChUaW1lKSB2YWwsIG51bGws\nIGNvbCk7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2Fz\nZSBKYXZhU1FMVHlwZXMuVElNRVNUQU1QOgogICAgICAgICAgICAgICAgaWYg\nKHZhbCBpbnN0YW5jZW9mIENhbGVuZGFyZCkgewogICAgICAgICAgICAgICAg\nICAgIGMgPSAoQ2FsZW5kYXJkKSB2YWw7CiAgICAgICAgICAgICAgICAgICAg\nc2V0VGltZXN0YW1wKHN0bW50LCBpZHgsIChUaW1lc3RhbXApIGMudmFsdWUs\nIGMuY2FsZW5kYXIsCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbCk7CiAg\nICAgICAgICAgICAgICB9IGVsc2UKICAgICAgICAgICAgICAgICAgICBzZXRU\naW1lc3RhbXAoc3RtbnQsIGlkeCwgKFRpbWVzdGFtcCkgdmFsLCBudWxsLCBj\nb2wpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGRlZmF1\nbHQ6CiAgICAgICAgICAgICAgICBpZiAoY29sICE9IG51bGwgJiYgKGNvbC5n\nZXRUeXBlKCkgPT0gVHlwZXMuQkxPQgogICAgICAgICAgICAgICAgICAgIHx8\nIGNvbC5nZXRUeXBlKCkgPT0gVHlwZXMuVkFSQklOQVJZKSkKICAgICAgICAg\nICAgICAgICAgICBzZXRCbG9iT2JqZWN0KHN0bW50LCBpZHgsIHZhbCwgY29s\nLCBzdG9yZSk7CiAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAg\nICAgICAgc2V0T2JqZWN0KHN0bW50LCBpZHgsIHZhbCwgY29sLmdldFR5cGUo\nKSwgY29sKTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBTZXQg\nYSBjb21wbGV0ZWx5IHVua25vd24gcGFyYW1ldGVyIGludG8gYSBwcmVwYXJl\nZCBzdGF0ZW1lbnQuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldFVua25v\nd24oUHJlcGFyZWRTdGF0ZW1lbnQgc3RtbnQsIGludCBpZHgsIE9iamVjdCB2\nYWwsCiAgICAgICAgQ29sdW1uIGNvbCkKICAgICAgICB0aHJvd3MgU1FMRXhj\nZXB0aW9uIHsKICAgICAgICBTaXplZCBzaXplZCA9IG51bGw7CiAgICAgICAg\nQ2FsZW5kYXJkIGNhbGQgPSBudWxsOwogICAgICAgIGlmICh2YWwgaW5zdGFu\nY2VvZiBTaXplZCkgewogICAgICAgICAgICBzaXplZCA9IChTaXplZCkgdmFs\nOwogICAgICAgICAgICB2YWwgPSBzaXplZC52YWx1ZTsKICAgICAgICB9IGVs\nc2UgaWYgKHZhbCBpbnN0YW5jZW9mIENhbGVuZGFyZCkgewogICAgICAgICAg\nICBjYWxkID0gKENhbGVuZGFyZCkgdmFsOwogICAgICAgICAgICB2YWwgPSBj\nYWxkLnZhbHVlOwogICAgICAgIH0KCiAgICAgICAgaWYgKHZhbCA9PSBudWxs\nKQogICAgICAgICAgICBzZXROdWxsKHN0bW50LCBpZHgsIChjb2wgPT0gbnVs\nbCkgPyBUeXBlcy5PVEhFUiA6IGNvbC5nZXRUeXBlKCksCiAgICAgICAgICAg\nICAgICBjb2wpOwogICAgICAgIGVsc2UgaWYgKHZhbCBpbnN0YW5jZW9mIFN0\ncmluZykKICAgICAgICAgICAgc2V0U3RyaW5nKHN0bW50LCBpZHgsIHZhbC50\nb1N0cmluZygpLCBjb2wpOwogICAgICAgIGVsc2UgaWYgKHZhbCBpbnN0YW5j\nZW9mIEludGVnZXIpCiAgICAgICAgICAgIHNldEludChzdG1udCwgaWR4LCAo\nKEludGVnZXIpIHZhbCkuaW50VmFsdWUoKSwgY29sKTsKICAgICAgICBlbHNl\nIGlmICh2YWwgaW5zdGFuY2VvZiBCb29sZWFuKQogICAgICAgICAgICBzZXRC\nb29sZWFuKHN0bW50LCBpZHgsICgoQm9vbGVhbikgdmFsKS5ib29sZWFuVmFs\ndWUoKSwgY29sKTsKICAgICAgICBlbHNlIGlmICh2YWwgaW5zdGFuY2VvZiBM\nb25nKQogICAgICAgICAgICBzZXRMb25nKHN0bW50LCBpZHgsICgoTG9uZykg\ndmFsKS5sb25nVmFsdWUoKSwgY29sKTsKICAgICAgICBlbHNlIGlmICh2YWwg\naW5zdGFuY2VvZiBGbG9hdCkKICAgICAgICAgICAgc2V0RmxvYXQoc3RtbnQs\nIGlkeCwgKChGbG9hdCkgdmFsKS5mbG9hdFZhbHVlKCksIGNvbCk7CiAgICAg\nICAgZWxzZSBpZiAodmFsIGluc3RhbmNlb2YgRG91YmxlKQogICAgICAgICAg\nICBzZXREb3VibGUoc3RtbnQsIGlkeCwgKChEb3VibGUpIHZhbCkuZG91Ymxl\nVmFsdWUoKSwgY29sKTsKICAgICAgICBlbHNlIGlmICh2YWwgaW5zdGFuY2Vv\nZiBCeXRlKQogICAgICAgICAgICBzZXRCeXRlKHN0bW50LCBpZHgsICgoQnl0\nZSkgdmFsKS5ieXRlVmFsdWUoKSwgY29sKTsKICAgICAgICBlbHNlIGlmICh2\nYWwgaW5zdGFuY2VvZiBDaGFyYWN0ZXIpCiAgICAgICAgICAgIHNldENoYXIo\nc3RtbnQsIGlkeCwgKChDaGFyYWN0ZXIpIHZhbCkuY2hhclZhbHVlKCksIGNv\nbCk7CiAgICAgICAgZWxzZSBpZiAodmFsIGluc3RhbmNlb2YgU2hvcnQpCiAg\nICAgICAgICAgIHNldFNob3J0KHN0bW50LCBpZHgsICgoU2hvcnQpIHZhbCku\nc2hvcnRWYWx1ZSgpLCBjb2wpOwogICAgICAgIGVsc2UgaWYgKHZhbCBpbnN0\nYW5jZW9mIExvY2FsZSkKICAgICAgICAgICAgc2V0TG9jYWxlKHN0bW50LCBp\nZHgsIChMb2NhbGUpIHZhbCwgY29sKTsKICAgICAgICBlbHNlIGlmICh2YWwg\naW5zdGFuY2VvZiBCaWdEZWNpbWFsKQogICAgICAgICAgICBzZXRCaWdEZWNp\nbWFsKHN0bW50LCBpZHgsIChCaWdEZWNpbWFsKSB2YWwsIGNvbCk7CiAgICAg\nICAgZWxzZSBpZiAodmFsIGluc3RhbmNlb2YgQmlnSW50ZWdlcikKICAgICAg\nICAgICAgc2V0QmlnSW50ZWdlcihzdG1udCwgaWR4LCAoQmlnSW50ZWdlcikg\ndmFsLCBjb2wpOwogICAgICAgIGVsc2UgaWYgKHZhbCBpbnN0YW5jZW9mIEFy\ncmF5KQogICAgICAgICAgICBzZXRBcnJheShzdG1udCwgaWR4LCAoQXJyYXkp\nIHZhbCwgY29sKTsKICAgICAgICBlbHNlIGlmICh2YWwgaW5zdGFuY2VvZiBC\nbG9iKQogICAgICAgICAgICBzZXRCbG9iKHN0bW50LCBpZHgsIChCbG9iKSB2\nYWwsIGNvbCk7CiAgICAgICAgZWxzZSBpZiAodmFsIGluc3RhbmNlb2YgYnl0\nZVtdKQogICAgICAgICAgICBzZXRCeXRlcyhzdG1udCwgaWR4LCAoYnl0ZVtd\nKSB2YWwsIGNvbCk7CiAgICAgICAgZWxzZSBpZiAodmFsIGluc3RhbmNlb2Yg\nQ2xvYikKICAgICAgICAgICAgc2V0Q2xvYihzdG1udCwgaWR4LCAoQ2xvYikg\ndmFsLCBjb2wpOwogICAgICAgIGVsc2UgaWYgKHZhbCBpbnN0YW5jZW9mIFJl\nZikKICAgICAgICAgICAgc2V0UmVmKHN0bW50LCBpZHgsIChSZWYpIHZhbCwg\nY29sKTsKICAgICAgICBlbHNlIGlmICh2YWwgaW5zdGFuY2VvZiBqYXZhLnNx\nbC5EYXRlKQogICAgICAgICAgICBzZXREYXRlKHN0bW50LCBpZHgsIChqYXZh\nLnNxbC5EYXRlKSB2YWwsCiAgICAgICAgICAgICAgICAoY2FsZCA9PSBudWxs\nKSA/IG51bGwgOiBjYWxkLmNhbGVuZGFyLCBjb2wpOwogICAgICAgIGVsc2Ug\naWYgKHZhbCBpbnN0YW5jZW9mIFRpbWVzdGFtcCkKICAgICAgICAgICAgc2V0\nVGltZXN0YW1wKHN0bW50LCBpZHgsIChUaW1lc3RhbXApIHZhbCwKICAgICAg\nICAgICAgICAgIChjYWxkID09IG51bGwpID8gbnVsbCA6IGNhbGQuY2FsZW5k\nYXIsIGNvbCk7CiAgICAgICAgZWxzZSBpZiAodmFsIGluc3RhbmNlb2YgVGlt\nZSkKICAgICAgICAgICAgc2V0VGltZShzdG1udCwgaWR4LCAoVGltZSkgdmFs\nLAogICAgICAgICAgICAgICAgKGNhbGQgPT0gbnVsbCkgPyBudWxsIDogY2Fs\nZC5jYWxlbmRhciwgY29sKTsKICAgICAgICBlbHNlIGlmICh2YWwgaW5zdGFu\nY2VvZiBEYXRlKQogICAgICAgICAgICBzZXREYXRlKHN0bW50LCBpZHgsIChE\nYXRlKSB2YWwsIGNvbCk7CiAgICAgICAgZWxzZSBpZiAodmFsIGluc3RhbmNl\nb2YgQ2FsZW5kYXIpCiAgICAgICAgICAgIHNldERhdGUoc3RtbnQsIGlkeCwg\nKChDYWxlbmRhcikgdmFsKS5nZXRUaW1lKCksIGNvbCk7CiAgICAgICAgZWxz\nZSBpZiAodmFsIGluc3RhbmNlb2YgUmVhZGVyKQogICAgICAgICAgICBzZXRD\naGFyYWN0ZXJTdHJlYW0oc3RtbnQsIGlkeCwgKFJlYWRlcikgdmFsLAogICAg\nICAgICAgICAgICAgKHNpemVkID09IG51bGwpID8gMCA6IHNpemVkLnNpemUs\nIGNvbCk7CiAgICAgICAgZWxzZQogICAgICAgICAgICB0aHJvdyBuZXcgVXNl\nckV4Y2VwdGlvbihfbG9jLmdldCgiYmFkLXBhcmFtIiwgdmFsLmdldENsYXNz\nKCkpKTsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgc2VyaWFs\naXplZCBieXRlcyBmb3IgdGhlIGdpdmVuIG9iamVjdC4KICAgICAqLwogICAg\ncHVibGljIGJ5dGVbXSBzZXJpYWxpemUoT2JqZWN0IHZhbCwgSkRCQ1N0b3Jl\nIHN0b3JlKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAg\nIGlmICh2YWwgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAg\nICAgICAgaWYgKHZhbCBpbnN0YW5jZW9mIFNlcmlhbGl6ZWREYXRhKQogICAg\nICAgICAgICByZXR1cm4gKChTZXJpYWxpemVkRGF0YSkgdmFsKS5ieXRlczsK\nICAgICAgICByZXR1cm4gU2VyaWFsaXphdGlvbi5zZXJpYWxpemUodmFsLCBz\ndG9yZS5nZXRDb250ZXh0KCkpOwogICAgfQoKICAgIC8qKgogICAgICogSW52\nb2tlIHRoZSBKREsgMS40IDxjb2RlPnNldEJ5dGVzPC9jb2RlPiBtZXRob2Qg\nb24gdGhlIGdpdmVuIEJMT0Igb2JqZWN0LgogICAgICovCiAgICBwdWJsaWMg\ndm9pZCBwdXRCeXRlcyhPYmplY3QgYmxvYiwgYnl0ZVtdIGRhdGEpCiAgICAg\nICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgaWYgKF9zZXRCeXRl\ncyA9PSBudWxsKSB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAg\nICBfc2V0Qnl0ZXMgPSBibG9iLmdldENsYXNzKCkuZ2V0TWV0aG9kKCJzZXRC\neXRlcyIsCiAgICAgICAgICAgICAgICAgICAgbmV3IENsYXNzW117IGxvbmcu\nY2xhc3MsIGJ5dGVbXS5jbGFzcyB9KTsKICAgICAgICAgICAgfSBjYXRjaCAo\nRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgICAgIHRocm93IG5ldyBTdG9y\nZUV4Y2VwdGlvbihlKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAg\nICBpbnZva2VQdXRMb2JNZXRob2QoX3NldEJ5dGVzLCBibG9iLAogICAgICAg\nICAgICBuZXcgT2JqZWN0W117IE51bWJlcnMudmFsdWVPZigxTCksIGRhdGEg\nfSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBJbnZva2UgdGhlIEpESyAxLjQg\nPGNvZGU+c2V0U3RyaW5nPC9jb2RlPiBtZXRob2Qgb24gdGhlIGdpdmVuIENM\nT0IKICAgICAqIG9iamVjdC4KICAgICAqLwogICAgcHVibGljIHZvaWQgcHV0\nU3RyaW5nKE9iamVjdCBjbG9iLCBTdHJpbmcgZGF0YSkKICAgICAgICB0aHJv\nd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBpZiAoX3NldFN0cmluZyA9PSBu\ndWxsKSB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBfc2V0\nU3RyaW5nID0gY2xvYi5nZXRDbGFzcygpLmdldE1ldGhvZCgic2V0U3RyaW5n\nIiwKICAgICAgICAgICAgICAgICAgICBuZXcgQ2xhc3NbXXsgbG9uZy5jbGFz\ncywgU3RyaW5nLmNsYXNzIH0pOwogICAgICAgICAgICB9IGNhdGNoIChFeGNl\ncHRpb24gZSkgewogICAgICAgICAgICAgICAgdGhyb3cgbmV3IFN0b3JlRXhj\nZXB0aW9uKGUpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGlu\ndm9rZVB1dExvYk1ldGhvZChfc2V0U3RyaW5nLCBjbG9iLAogICAgICAgICAg\nICBuZXcgT2JqZWN0W117IE51bWJlcnMudmFsdWVPZigxTCksIGRhdGEgfSk7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBJbnZva2UgdGhlIEpESyAxLjQgPGNv\nZGU+c2V0Q2hhcmFjdGVyU3RyZWFtPC9jb2RlPiBtZXRob2Qgb24gdGhlIGdp\ndmVuCiAgICAgKiBDTE9CIG9iamVjdC4KICAgICAqLwogICAgcHVibGljIHZv\naWQgcHV0Q2hhcnMoT2JqZWN0IGNsb2IsIGNoYXJbXSBkYXRhKQogICAgICAg\nIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIGlmIChfc2V0Q2hhclN0\ncmVhbSA9PSBudWxsKSB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAg\nICAgICBfc2V0Q2hhclN0cmVhbSA9IGNsb2IuZ2V0Q2xhc3MoKS5nZXRNZXRo\nb2QKICAgICAgICAgICAgICAgICAgICAoInNldENoYXJhY3RlclN0cmVhbSIs\nIG5ldyBDbGFzc1tdeyBsb25nLmNsYXNzIH0pOwogICAgICAgICAgICB9IGNh\ndGNoIChFeGNlcHRpb24gZSkgewogICAgICAgICAgICAgICAgdGhyb3cgbmV3\nIFN0b3JlRXhjZXB0aW9uKGUpOwogICAgICAgICAgICB9CiAgICAgICAgfQoK\nICAgICAgICBXcml0ZXIgd3JpdGVyID0gKFdyaXRlcikgaW52b2tlUHV0TG9i\nTWV0aG9kKF9zZXRDaGFyU3RyZWFtLCBjbG9iLAogICAgICAgICAgICBuZXcg\nT2JqZWN0W117IE51bWJlcnMudmFsdWVPZigxTCkgfSk7CiAgICAgICAgdHJ5\nIHsKICAgICAgICAgICAgd3JpdGVyLndyaXRlKGRhdGEpOwogICAgICAgICAg\nICB3cml0ZXIuZmx1c2goKTsKICAgICAgICB9IGNhdGNoIChJT0V4Y2VwdGlv\nbiBpb2UpIHsKICAgICAgICAgICAgdGhyb3cgbmV3IFNRTEV4Y2VwdGlvbihp\nb2UudG9TdHJpbmcoKSk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAg\nICogSW52b2tlIHRoZSBnaXZlbiBMT0IgbWV0aG9kIG9uIHRoZSBnaXZlbiB0\nYXJnZXQgd2l0aCB0aGUgZ2l2ZW4gZGF0YS4KICAgICAqLwogICAgcHJpdmF0\nZSBzdGF0aWMgT2JqZWN0IGludm9rZVB1dExvYk1ldGhvZChNZXRob2QgbWV0\naG9kLCBPYmplY3QgdGFyZ2V0LAogICAgICAgIE9iamVjdFtdIGFyZ3MpCiAg\nICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgdHJ5IHsKICAg\nICAgICAgICAgcmV0dXJuIG1ldGhvZC5pbnZva2UodGFyZ2V0LCBhcmdzKTsK\nICAgICAgICB9IGNhdGNoIChJbnZvY2F0aW9uVGFyZ2V0RXhjZXB0aW9uIGl0\nZSkgewogICAgICAgICAgICBUaHJvd2FibGUgdCA9IGl0ZS5nZXRUYXJnZXRF\neGNlcHRpb24oKTsKICAgICAgICAgICAgaWYgKHQgaW5zdGFuY2VvZiBTUUxF\neGNlcHRpb24pCiAgICAgICAgICAgICAgICB0aHJvdyhTUUxFeGNlcHRpb24p\nIHQ7CiAgICAgICAgICAgIHRocm93IG5ldyBTdG9yZUV4Y2VwdGlvbih0KTsK\nICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkgewogICAgICAgICAgICB0\naHJvdyBuZXcgU3RvcmVFeGNlcHRpb24oZSk7CiAgICAgICAgfQogICAgfQoK\nICAgIC8qKgogICAgICogV2FybiB0aGF0IGEgcGFydGljdWxhciB2YWx1ZSBj\nb3VsZCBub3QgYmUgc3RvcmVkIHByZWNpc2VseS4KICAgICAqIEFmdGVyIHRo\nZSBmaXJzdCB3YXJuaW5nIGZvciBhIHBhcnRpY3VsYXIgdHlwZSwgbWVzc2Fn\nZXMKICAgICAqIHdpbGwgYmUgdHVybmVkIGludG8gdHJhY2UgbWVzc2FnZXMu\nCiAgICAgKi8KICAgIHByb3RlY3RlZCB2b2lkIHN0b3JhZ2VXYXJuaW5nKE9i\namVjdCBvcmlnLCBPYmplY3QgY29udmVydGVkKSB7CiAgICAgICAgYm9vbGVh\nbiB3YXJuOwogICAgICAgIHN5bmNocm9uaXplZCAodGhpcykgewogICAgICAg\nICAgICBpZiAoX3ByZWNpc2lvbldhcm5lZFR5cGVzID09IG51bGwpCiAgICAg\nICAgICAgICAgICBfcHJlY2lzaW9uV2FybmVkVHlwZXMgPSBuZXcgSGFzaFNl\ndCgpOwogICAgICAgICAgICB3YXJuID0gX3ByZWNpc2lvbldhcm5lZFR5cGVz\nLmFkZChvcmlnLmdldENsYXNzKCkpOwogICAgICAgIH0KCiAgICAgICAgaWYg\nKHN0b3JhZ2VMaW1pdGF0aW9uc0ZhdGFsIHx8ICh3YXJuICYmIGxvZy5pc1dh\ncm5FbmFibGVkKCkpCiAgICAgICAgICAgIHx8ICghd2FybiAmJiBsb2cuaXNU\ncmFjZUVuYWJsZWQoKSkpIHsKICAgICAgICAgICAgTWVzc2FnZSBtc2cgPSBf\nbG9jLmdldCgic3RvcmFnZS1yZXN0cmljdGlvbiIsIG5ldyBPYmplY3RbXXsK\nICAgICAgICAgICAgICAgIHBsYXRmb3JtLAogICAgICAgICAgICAgICAgb3Jp\nZywKICAgICAgICAgICAgICAgIG9yaWcuZ2V0Q2xhc3MoKS5nZXROYW1lKCks\nCiAgICAgICAgICAgICAgICBjb252ZXJ0ZWQsCiAgICAgICAgICAgIH0pOwoK\nICAgICAgICAgICAgaWYgKHN0b3JhZ2VMaW1pdGF0aW9uc0ZhdGFsKQogICAg\nICAgICAgICAgICAgdGhyb3cgbmV3IFN0b3JlRXhjZXB0aW9uKG1zZyk7Cgog\nICAgICAgICAgICBpZiAod2FybikKICAgICAgICAgICAgICAgIGxvZy53YXJu\nKG1zZyk7CiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIGxvZy50\ncmFjZShtc2cpOwogICAgICAgIH0KICAgIH0KCiAgICAvLy8vLy8vLy8KICAg\nIC8vIFR5cGVzCiAgICAvLy8vLy8vLy8KCiAgICAvKioKICAgICAqIFJldHVy\nbiB0aGUgcHJlZmVycmVkIHtAbGluayBUeXBlc30gY29uc3RhbnQgZm9yIHRo\nZSBnaXZlbgogICAgICoge0BsaW5rIEphdmFUeXBlc30gb3Ige0BsaW5rIEph\ndmFTUUxUeXBlc30gY29uc3RhbnQuCiAgICAgKi8KICAgIHB1YmxpYyBpbnQg\nZ2V0SkRCQ1R5cGUoaW50IG1ldGFUeXBlQ29kZSwgYm9vbGVhbiBsb2IpIHsK\nICAgICAgICBpZiAobG9iKSB7CiAgICAgICAgICAgIHN3aXRjaCAobWV0YVR5\ncGVDb2RlKSB7CiAgICAgICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5TVFJJ\nTkc6CiAgICAgICAgICAgICAgICBjYXNlIEphdmFTUUxUeXBlcy5BU0NJSV9T\nVFJFQU06CiAgICAgICAgICAgICAgICBjYXNlIEphdmFTUUxUeXBlcy5DSEFS\nX1NUUkVBTToKICAgICAgICAgICAgICAgICAgICByZXR1cm4gZ2V0UHJlZmVy\ncmVkVHlwZShUeXBlcy5DTE9CKTsKICAgICAgICAgICAgICAgIGRlZmF1bHQ6\nCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGdldFByZWZlcnJlZFR5cGUo\nVHlwZXMuQkxPQik7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAg\nIHN3aXRjaCAobWV0YVR5cGVDb2RlKSB7CiAgICAgICAgICAgIGNhc2UgSmF2\nYVR5cGVzLkJPT0xFQU46CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLkJP\nT0xFQU5fT0JKOgogICAgICAgICAgICAgICAgcmV0dXJuIGdldFByZWZlcnJl\nZFR5cGUoVHlwZXMuQklUKTsKICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMu\nQllURToKICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuQllURV9PQko6CiAg\nICAgICAgICAgICAgICByZXR1cm4gZ2V0UHJlZmVycmVkVHlwZShUeXBlcy5U\nSU5ZSU5UKTsKICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuQ0hBUjoKICAg\nICAgICAgICAgY2FzZSBKYXZhVHlwZXMuQ0hBUl9PQko6CiAgICAgICAgICAg\nICAgICBpZiAoc3RvcmVDaGFyc0FzTnVtYmVycykKICAgICAgICAgICAgICAg\nICAgICByZXR1cm4gZ2V0UHJlZmVycmVkVHlwZShUeXBlcy5JTlRFR0VSKTsK\nICAgICAgICAgICAgICAgIHJldHVybiBnZXRQcmVmZXJyZWRUeXBlKFR5cGVz\nLkNIQVIpOwogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5ET1VCTEU6CiAg\nICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLkRPVUJMRV9PQko6CiAgICAgICAg\nICAgICAgICByZXR1cm4gZ2V0UHJlZmVycmVkVHlwZShUeXBlcy5ET1VCTEUp\nOwogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5GTE9BVDoKICAgICAgICAg\nICAgY2FzZSBKYXZhVHlwZXMuRkxPQVRfT0JKOgogICAgICAgICAgICAgICAg\ncmV0dXJuIGdldFByZWZlcnJlZFR5cGUoVHlwZXMuUkVBTCk7CiAgICAgICAg\nICAgIGNhc2UgSmF2YVR5cGVzLklOVDoKICAgICAgICAgICAgY2FzZSBKYXZh\nVHlwZXMuSU5UX09CSjoKICAgICAgICAgICAgICAgIHJldHVybiBnZXRQcmVm\nZXJyZWRUeXBlKFR5cGVzLklOVEVHRVIpOwogICAgICAgICAgICBjYXNlIEph\ndmFUeXBlcy5MT05HOgogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5MT05H\nX09CSjoKICAgICAgICAgICAgICAgIHJldHVybiBnZXRQcmVmZXJyZWRUeXBl\nKFR5cGVzLkJJR0lOVCk7CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLlNI\nT1JUOgogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5TSE9SVF9PQko6CiAg\nICAgICAgICAgICAgICByZXR1cm4gZ2V0UHJlZmVycmVkVHlwZShUeXBlcy5T\nTUFMTElOVCk7CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLlNUUklORzoK\nICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuTE9DQUxFOgogICAgICAgICAg\nICBjYXNlIEphdmFTUUxUeXBlcy5BU0NJSV9TVFJFQU06CiAgICAgICAgICAg\nIGNhc2UgSmF2YVNRTFR5cGVzLkNIQVJfU1RSRUFNOgogICAgICAgICAgICAg\nICAgcmV0dXJuIGdldFByZWZlcnJlZFR5cGUoVHlwZXMuVkFSQ0hBUik7CiAg\nICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLkJJR0lOVEVHRVI6CiAgICAgICAg\nICAgICAgICBpZiAoc3RvcmVMYXJnZU51bWJlcnNBc1N0cmluZ3MpCiAgICAg\nICAgICAgICAgICAgICAgcmV0dXJuIGdldFByZWZlcnJlZFR5cGUoVHlwZXMu\nVkFSQ0hBUik7CiAgICAgICAgICAgICAgICByZXR1cm4gZ2V0UHJlZmVycmVk\nVHlwZShUeXBlcy5CSUdJTlQpOwogICAgICAgICAgICBjYXNlIEphdmFUeXBl\ncy5CSUdERUNJTUFMOgogICAgICAgICAgICAgICAgaWYgKHN0b3JlTGFyZ2VO\ndW1iZXJzQXNTdHJpbmdzKQogICAgICAgICAgICAgICAgICAgIHJldHVybiBn\nZXRQcmVmZXJyZWRUeXBlKFR5cGVzLlZBUkNIQVIpOwogICAgICAgICAgICAg\nICAgcmV0dXJuIGdldFByZWZlcnJlZFR5cGUoVHlwZXMuRE9VQkxFKTsKICAg\nICAgICAgICAgY2FzZSBKYXZhVHlwZXMuTlVNQkVSOgogICAgICAgICAgICAg\nICAgaWYgKHN0b3JlTGFyZ2VOdW1iZXJzQXNTdHJpbmdzKQogICAgICAgICAg\nICAgICAgICAgIHJldHVybiBnZXRQcmVmZXJyZWRUeXBlKFR5cGVzLlZBUkNI\nQVIpOwogICAgICAgICAgICAgICAgcmV0dXJuIGdldFByZWZlcnJlZFR5cGUo\nVHlwZXMuTlVNRVJJQyk7CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLkNB\nTEVOREFSOgogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5EQVRFOgogICAg\nICAgICAgICAgICAgcmV0dXJuIGdldFByZWZlcnJlZFR5cGUoVHlwZXMuVElN\nRVNUQU1QKTsKICAgICAgICAgICAgY2FzZSBKYXZhU1FMVHlwZXMuU1FMX0FS\nUkFZOgogICAgICAgICAgICAgICAgcmV0dXJuIGdldFByZWZlcnJlZFR5cGUo\nVHlwZXMuQVJSQVkpOwogICAgICAgICAgICBjYXNlIEphdmFTUUxUeXBlcy5C\nSU5BUllfU1RSRUFNOgogICAgICAgICAgICBjYXNlIEphdmFTUUxUeXBlcy5C\nTE9COgogICAgICAgICAgICBjYXNlIEphdmFTUUxUeXBlcy5CWVRFUzoKICAg\nICAgICAgICAgICAgIHJldHVybiBnZXRQcmVmZXJyZWRUeXBlKFR5cGVzLkJM\nT0IpOwogICAgICAgICAgICBjYXNlIEphdmFTUUxUeXBlcy5DTE9COgogICAg\nICAgICAgICAgICAgcmV0dXJuIGdldFByZWZlcnJlZFR5cGUoVHlwZXMuQ0xP\nQik7CiAgICAgICAgICAgIGNhc2UgSmF2YVNRTFR5cGVzLlNRTF9EQVRFOgog\nICAgICAgICAgICAgICAgcmV0dXJuIGdldFByZWZlcnJlZFR5cGUoVHlwZXMu\nREFURSk7CiAgICAgICAgICAgIGNhc2UgSmF2YVNRTFR5cGVzLlRJTUU6CiAg\nICAgICAgICAgICAgICByZXR1cm4gZ2V0UHJlZmVycmVkVHlwZShUeXBlcy5U\nSU1FKTsKICAgICAgICAgICAgY2FzZSBKYXZhU1FMVHlwZXMuVElNRVNUQU1Q\nOgogICAgICAgICAgICAgICAgcmV0dXJuIGdldFByZWZlcnJlZFR5cGUoVHlw\nZXMuVElNRVNUQU1QKTsKICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAg\nICAgICAgIHJldHVybiBnZXRQcmVmZXJyZWRUeXBlKFR5cGVzLkJMT0IpOwog\nICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgcHJl\nZmVycmVkIHtAbGluayBUeXBlc30gdHlwZSBmb3IgdGhlIGdpdmVuIG9uZS4g\nUmV0dXJucwogICAgICogdGhlIGdpdmVuIHR5cGUgYnkgZGVmYXVsdC4KICAg\nICAqLwogICAgcHVibGljIGludCBnZXRQcmVmZXJyZWRUeXBlKGludCB0eXBl\nKSB7CiAgICAgICAgcmV0dXJuIHR5cGU7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBSZXR1cm4gdGhlIHByZWZlcnJlZCBkYXRhYmFzZSB0eXBlIG5hbWUgZm9y\nIHRoZSBnaXZlbiBjb2x1bW4ncyB0eXBlCiAgICAgKiBmcm9tIHtAbGluayBU\neXBlc30uCiAgICAgKi8KICAgIHB1YmxpYyBTdHJpbmcgZ2V0VHlwZU5hbWUo\nQ29sdW1uIGNvbCkgewogICAgICAgIGlmICghU3RyaW5nVXRpbHMuaXNFbXB0\neShjb2wuZ2V0VHlwZU5hbWUoKSkpCiAgICAgICAgICAgIHJldHVybiBhcHBl\nbmRTaXplKGNvbCwgY29sLmdldFR5cGVOYW1lKCkpOwoKICAgICAgICBpZiAo\nY29sLmlzQXV0b0Fzc2lnbmVkKCkgJiYgYXV0b0Fzc2lnblR5cGVOYW1lICE9\nIG51bGwpCiAgICAgICAgICAgIHJldHVybiBhcHBlbmRTaXplKGNvbCwgYXV0\nb0Fzc2lnblR5cGVOYW1lKTsKCiAgICAgICAgcmV0dXJuIGFwcGVuZFNpemUo\nY29sLCBnZXRUeXBlTmFtZShjb2wuZ2V0VHlwZSgpKSk7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBSZXR1cm5zIHRoZSB0eXBlIG5hbWUgZm9yIHRoZSBzcGVj\naWZpYyBjb25zdGFudCBhcyBkZWZpbmVkCiAgICAgKiBieSB7QGxpbmsgamF2\nYS5zcWwuVHlwZXN9LgogICAgICoKICAgICAqIEBwYXJhbSB0eXBlIHRoZSB0\neXBlCiAgICAgKiBAcmV0dXJuIHRoZSBuYW1lIGZvciB0aGUgdHlwZQogICAg\nICovCiAgICBwdWJsaWMgU3RyaW5nIGdldFR5cGVOYW1lKGludCB0eXBlKSB7\nCiAgICAgICAgc3dpdGNoICh0eXBlKSB7CiAgICAgICAgICAgIGNhc2UgVHlw\nZXMuQVJSQVk6CiAgICAgICAgICAgICAgICByZXR1cm4gYXJyYXlUeXBlTmFt\nZTsKICAgICAgICAgICAgY2FzZSBUeXBlcy5CSUdJTlQ6CiAgICAgICAgICAg\nICAgICByZXR1cm4gYmlnaW50VHlwZU5hbWU7CiAgICAgICAgICAgIGNhc2Ug\nVHlwZXMuQklOQVJZOgogICAgICAgICAgICAgICAgcmV0dXJuIGJpbmFyeVR5\ncGVOYW1lOwogICAgICAgICAgICBjYXNlIFR5cGVzLkJJVDoKICAgICAgICAg\nICAgICAgIHJldHVybiBiaXRUeXBlTmFtZTsKICAgICAgICAgICAgY2FzZSBU\neXBlcy5CTE9COgogICAgICAgICAgICAgICAgcmV0dXJuIGJsb2JUeXBlTmFt\nZTsKICAgICAgICAgICAgY2FzZSBUeXBlcy5CT09MRUFOOgogICAgICAgICAg\nICAgICAgcmV0dXJuIGJvb2xlYW5UeXBlTmFtZTsKICAgICAgICAgICAgY2Fz\nZSBUeXBlcy5DSEFSOgogICAgICAgICAgICAgICAgcmV0dXJuIGNoYXJUeXBl\nTmFtZTsKICAgICAgICAgICAgY2FzZSBUeXBlcy5DTE9COgogICAgICAgICAg\nICAgICAgcmV0dXJuIGNsb2JUeXBlTmFtZTsKICAgICAgICAgICAgY2FzZSBU\neXBlcy5EQVRFOgogICAgICAgICAgICAgICAgcmV0dXJuIGRhdGVUeXBlTmFt\nZTsKICAgICAgICAgICAgY2FzZSBUeXBlcy5ERUNJTUFMOgogICAgICAgICAg\nICAgICAgcmV0dXJuIGRlY2ltYWxUeXBlTmFtZTsKICAgICAgICAgICAgY2Fz\nZSBUeXBlcy5ESVNUSU5DVDoKICAgICAgICAgICAgICAgIHJldHVybiBkaXN0\naW5jdFR5cGVOYW1lOwogICAgICAgICAgICBjYXNlIFR5cGVzLkRPVUJMRToK\nICAgICAgICAgICAgICAgIHJldHVybiBkb3VibGVUeXBlTmFtZTsKICAgICAg\nICAgICAgY2FzZSBUeXBlcy5GTE9BVDoKICAgICAgICAgICAgICAgIHJldHVy\nbiBmbG9hdFR5cGVOYW1lOwogICAgICAgICAgICBjYXNlIFR5cGVzLklOVEVH\nRVI6CiAgICAgICAgICAgICAgICByZXR1cm4gaW50ZWdlclR5cGVOYW1lOwog\nICAgICAgICAgICBjYXNlIFR5cGVzLkpBVkFfT0JKRUNUOgogICAgICAgICAg\nICAgICAgcmV0dXJuIGphdmFPYmplY3RUeXBlTmFtZTsKICAgICAgICAgICAg\nY2FzZSBUeXBlcy5MT05HVkFSQklOQVJZOgogICAgICAgICAgICAgICAgcmV0\ndXJuIGxvbmdWYXJiaW5hcnlUeXBlTmFtZTsKICAgICAgICAgICAgY2FzZSBU\neXBlcy5MT05HVkFSQ0hBUjoKICAgICAgICAgICAgICAgIHJldHVybiBsb25n\nVmFyY2hhclR5cGVOYW1lOwogICAgICAgICAgICBjYXNlIFR5cGVzLk5VTEw6\nCiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbFR5cGVOYW1lOwogICAgICAg\nICAgICBjYXNlIFR5cGVzLk5VTUVSSUM6CiAgICAgICAgICAgICAgICByZXR1\ncm4gbnVtZXJpY1R5cGVOYW1lOwogICAgICAgICAgICBjYXNlIFR5cGVzLk9U\nSEVSOgogICAgICAgICAgICAgICAgcmV0dXJuIG90aGVyVHlwZU5hbWU7CiAg\nICAgICAgICAgIGNhc2UgVHlwZXMuUkVBTDoKICAgICAgICAgICAgICAgIHJl\ndHVybiByZWFsVHlwZU5hbWU7CiAgICAgICAgICAgIGNhc2UgVHlwZXMuUkVG\nOgogICAgICAgICAgICAgICAgcmV0dXJuIHJlZlR5cGVOYW1lOwogICAgICAg\nICAgICBjYXNlIFR5cGVzLlNNQUxMSU5UOgogICAgICAgICAgICAgICAgcmV0\ndXJuIHNtYWxsaW50VHlwZU5hbWU7CiAgICAgICAgICAgIGNhc2UgVHlwZXMu\nU1RSVUNUOgogICAgICAgICAgICAgICAgcmV0dXJuIHN0cnVjdFR5cGVOYW1l\nOwogICAgICAgICAgICBjYXNlIFR5cGVzLlRJTUU6CiAgICAgICAgICAgICAg\nICByZXR1cm4gdGltZVR5cGVOYW1lOwogICAgICAgICAgICBjYXNlIFR5cGVz\nLlRJTUVTVEFNUDoKICAgICAgICAgICAgICAgIHJldHVybiB0aW1lc3RhbXBU\neXBlTmFtZTsKICAgICAgICAgICAgY2FzZSBUeXBlcy5USU5ZSU5UOgogICAg\nICAgICAgICAgICAgcmV0dXJuIHRpbnlpbnRUeXBlTmFtZTsKICAgICAgICAg\nICAgY2FzZSBUeXBlcy5WQVJCSU5BUlk6CiAgICAgICAgICAgICAgICByZXR1\ncm4gdmFyYmluYXJ5VHlwZU5hbWU7CiAgICAgICAgICAgIGNhc2UgVHlwZXMu\nVkFSQ0hBUjoKICAgICAgICAgICAgICAgIHJldHVybiB2YXJjaGFyVHlwZU5h\nbWU7CiAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgICByZXR1\ncm4gb3RoZXJUeXBlTmFtZTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAg\nICAgKiBIZWxwZXIgbWV0aG9kIHRvIGFkZCBzaXplIHByb3BlcnRpZXMgdG8g\ndGhlIHNwZWNpZmllZCB0eXBlLgogICAgICogSWYgcHJlc2VudCwgdGhlIHN0\ncmluZyAiezB9IiB3aWxsIGJlIHJlcGxhY2VkIHdpdGggdGhlIHNpemUgZGVm\naW5pdGlvbjsKICAgICAqIG90aGVyd2lzZSB0aGUgc2l6ZSBkZWZpbml0aW9u\nIHdpbGwgYmUgYXBwZW5kZWQgdG8gdGhlIHR5cGUgbmFtZS4KICAgICAqIElm\nIHlvdXIgZGF0YWJhc2UgaGFzIGNvbHVtbiB0eXBlcyB0aGF0IGRvbid0IGFs\nbG93IHNpemUgZGVmaW5pdGlvbnMsCiAgICAgKiBvdmVycmlkZSB0aGlzIG1l\ndGhvZCB0byByZXR1cm4gdGhlIHVuYWx0ZXJlZCB0eXBlIG5hbWUgZm9yIGNv\nbHVtbnMgb2YKICAgICAqIHRob3NlIHR5cGVzIChvciBhZGQgdGhlIHR5cGUg\nbmFtZXMgdG8gdGhlCiAgICAgKiA8Y29kZT5maXhlZFNpemVUeXBlTmFtZVNl\ndDwvY29kZT4pLgogICAgICogCiAgICAgKiA8UD5Tb21lIGRhdGFiYXNlcyBz\ndXBwb3J0ICJ0eXBlIG1vZGlmaWVycyIgZm9yIGV4YW1wbGUgdGhlIHVuc2ln\nbmVkCiAgICAgKiAibW9kaWZpZXIiIGluIE15U1FMLiBJbiB0aGVzZSBjYXNl\ncyB0aGUgc2l6ZSBzaG91bGQgZ28gYmV0d2VlbiB0aGUgdHlwZSAKICAgICAq\nIGFuZCB0aGUgIm1vZGlmaWVyIiwgaW5zdGVhZCBvZiBhZnRlciB0aGUgbW9k\naWZpZXIuIEZvciBleGFtcGxlIAogICAgICogQ1JFQVRFIHRhYmxlIEZPTyAo\nIG15aW50IElOVCAoMTApIFVOU0lHTkVEIC4gLiAuKSBpbnN0ZWFkIG9mIAog\nICAgICogQ1JFQVRFIHRhYmxlIEZPTyAoIG15aW50IElOVCBVTlNJR05FRCAo\nMTApIC4gLiAuKS4KICAgICAqIFR5cGUgbW9kaWZpZXJzIHNob3VsZCBiZSBh\nZGRlZCB0byA8Y29kZT50eXBlTW9kaWZpZXJTZXQ8L2NvZGU+IGluIAogICAg\nICogc3ViY2xhc3Nlcy4gCiAgICAgKi8KICAgIHByb3RlY3RlZCBTdHJpbmcg\nYXBwZW5kU2l6ZShDb2x1bW4gY29sLCBTdHJpbmcgdHlwZU5hbWUpIHsKICAg\nICAgICBpZiAoZml4ZWRTaXplVHlwZU5hbWVTZXQuY29udGFpbnModHlwZU5h\nbWUudG9VcHBlckNhc2UoKSkpCiAgICAgICAgICAgIHJldHVybiB0eXBlTmFt\nZTsKICAgICAgICBpZiAodHlwZU5hbWUuaW5kZXhPZignKCcpICE9IC0xKQog\nICAgICAgICAgICByZXR1cm4gdHlwZU5hbWU7CgogICAgICAgIFN0cmluZyBz\naXplID0gbnVsbDsKICAgICAgICBpZiAoY29sLmdldFNpemUoKSA+IDApIHsK\nICAgICAgICAgICAgU3RyaW5nQnVmZmVyIGJ1ZiA9IG5ldyBTdHJpbmdCdWZm\nZXIoMTApOwogICAgICAgICAgICBidWYuYXBwZW5kKCIoIikuYXBwZW5kKGNv\nbC5nZXRTaXplKCkpOwogICAgICAgICAgICBpZiAoY29sLmdldERlY2ltYWxE\naWdpdHMoKSA+IDApCiAgICAgICAgICAgICAgICBidWYuYXBwZW5kKCIsICIp\nLmFwcGVuZChjb2wuZ2V0RGVjaW1hbERpZ2l0cygpKTsKICAgICAgICAgICAg\nYnVmLmFwcGVuZCgiKSIpOwogICAgICAgICAgICBzaXplID0gYnVmLnRvU3Ry\naW5nKCk7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gaW5zZXJ0U2l6ZSh0\neXBlTmFtZSwgc2l6ZSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBIZWxwZXIg\nbWV0aG9kIHRoYXQgaW5zZXJ0cyBhIHNpemUgY2xhdXNlIGZvciBhIGdpdmVu\nIFNRTCB0eXBlLiAKICAgICAqIAogICAgICogQHNlZSBhcHBlbmRTaXplCiAg\nICAgKiAKICAgICAqIEBwYXJhbSB0eXBlTmFtZSAgVGhlIFNRTCB0eXBlIGll\nIElOVAogICAgICogQHBhcmFtIHNpemUgICAgICBUaGUgc2l6ZSBjbGF1c2Ug\naWUgKDEwKQogICAgICogQHJldHVybiAgICAgICAgICBUaGUgdHlwZU5hbWUg\nKyBzaXplIGNsYXVzZS4gVXN1YWxseSB0aGUgc2l6ZSBjbGF1c2Ugd2lsbCAK\nICAgICAqICAgICAgICAgICAgICAgICAgYmUgYXBwZW5kZWQgdG8gdHlwZU5h\nbWUuIElmIHRoZSB0eXBlTmFtZSBjb250YWlucyBhIAogICAgICogICAgICAg\nICAgICAgICAgICBtYXJrZXIgOiB7MH0gb3IgaWYgdHlwZU5hbWUgY29udGFp\nbnMgYSBtb2RpZmllciB0aGUgCiAgICAgKiAgICAgICAgICAgICAgICAgIHNp\nemUgY2xhdXNlIHdpbGwgYmUgaW5zZXJ0ZWQgYXBwcm9wcmlhdGVseS4gICAK\nICAgICAqLwogICAgcHJvdGVjdGVkIFN0cmluZyBpbnNlcnRTaXplKFN0cmlu\nZyB0eXBlTmFtZSwgU3RyaW5nIHNpemUpIHsKICAgIAlpZiAoU3RyaW5nVXRp\nbHMuaXNFbXB0eShzaXplKSkgewogICAgICAgICAgICBpbnQgaWR4ID0gdHlw\nZU5hbWUuaW5kZXhPZigiezB9Iik7CiAgICAgICAgICAgIGlmIChpZHggIT0g\nLTEpIHsKICAgICAgICAgICAgICAgIHJldHVybiB0eXBlTmFtZS5zdWJzdHJp\nbmcoMCwgaWR4KTsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4g\ndHlwZU5hbWU7CiAgICAgICAgfQogICAgCQogICAgICAgIGludCBpZHggPSB0\neXBlTmFtZS5pbmRleE9mKCJ7MH0iKTsKICAgICAgICBpZiAoaWR4ICE9IC0x\nKSB7CiAgICAgICAgICAgIC8vIHJlcGxhY2UgJ3swfScgd2l0aCBzaXplCiAg\nICAgICAgICAgIFN0cmluZyByZXQgPSB0eXBlTmFtZS5zdWJzdHJpbmcoMCwg\naWR4KTsKICAgICAgICAgICAgaWYgKHNpemUgIT0gbnVsbCkKICAgICAgICAg\nICAgICAgIHJldCA9IHJldCArIHNpemU7CiAgICAgICAgICAgIGlmICh0eXBl\nTmFtZS5sZW5ndGgoKSA+IGlkeCArIDMpCiAgICAgICAgICAgICAgICByZXQg\nPSByZXQgKyB0eXBlTmFtZS5zdWJzdHJpbmcoaWR4ICsgMyk7CiAgICAgICAg\nICAgIHJldHVybiByZXQ7CiAgICAgICAgfQogICAgICAgIGlmICghdHlwZU1v\nZGlmaWVyU2V0LmlzRW1wdHkoKSkgewogICAgICAgICAgICBTdHJpbmcgczsK\nICAgICAgICAgICAgaWR4ID0gdHlwZU5hbWUubGVuZ3RoKCk7CiAgICAgICAg\nICAgIGludCBjdXJJZHggPSAtMTsKICAgICAgICAgICAgZm9yIChJdGVyYXRv\nciBpID0gdHlwZU1vZGlmaWVyU2V0Lml0ZXJhdG9yKCk7IGkuaGFzTmV4dCgp\nOykgewogICAgICAgICAgICAgICAgcyA9IChTdHJpbmcpIGkubmV4dCgpOwog\nICAgICAgICAgICAgICAgaWYgKHR5cGVOYW1lLnRvVXBwZXJDYXNlKCkuaW5k\nZXhPZihzKSAhPSAtMSkgewogICAgICAgICAgICAgICAgICAgIGN1cklkeCA9\nIHR5cGVOYW1lLnRvVXBwZXJDYXNlKCkuaW5kZXhPZihzKTsKICAgICAgICAg\nICAgICAgICAgICBpZiAoY3VySWR4ICE9IC0xICYmIGN1cklkeCA8IGlkeCkg\newogICAgICAgICAgICAgICAgICAgICAgICBpZHggPSBjdXJJZHg7CiAgICAg\nICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAg\nICB9CiAgICAgICAgICAgIGlmKGlkeCAhPSB0eXBlTmFtZS5sZW5ndGgoKSkg\newogICAgICAgICAgICAgICAgU3RyaW5nIHJldCA9IHR5cGVOYW1lLnN1YnN0\ncmluZygwLCBpZHgpOwogICAgICAgICAgICAgICAgcmV0ID0gcmV0ICsgc2l6\nZTsKICAgICAgICAgICAgICAgIHJldCA9IHJldCArICcgJyArIHR5cGVOYW1l\nLnN1YnN0cmluZyhpZHgpOwogICAgICAgICAgICAgICAgcmV0dXJuIHJldDsK\nICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4gdHlwZU5h\nbWUgKyBzaXplOwogICAgfQoKICAgIC8vLy8vLy8vLy8vCiAgICAvLyBTZWxl\nY3RzCiAgICAvLy8vLy8vLy8vLwoKICAgIC8qKgogICAgICogU2V0IHRoZSBu\nYW1lIG9mIHRoZSBqb2luIHN5bnRheCB0byB1c2U6IHNxbDkyLCB0cmFkaXRp\nb25hbCwgZGF0YWJhc2UKICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0Sm9p\nblN5bnRheChTdHJpbmcgc3ludGF4KSB7CiAgICAgICAgaWYgKCJzcWw5MiIu\nZXF1YWxzKHN5bnRheCkpCiAgICAgICAgICAgIGpvaW5TeW50YXggPSBTWU5U\nQVhfU1FMOTI7CiAgICAgICAgZWxzZSBpZiAoInRyYWRpdGlvbmFsIi5lcXVh\nbHMoc3ludGF4KSkKICAgICAgICAgICAgam9pblN5bnRheCA9IFNZTlRBWF9U\nUkFESVRJT05BTDsKICAgICAgICBlbHNlIGlmICgiZGF0YWJhc2UiLmVxdWFs\ncyhzeW50YXgpKQogICAgICAgICAgICBqb2luU3ludGF4ID0gU1lOVEFYX0RB\nVEFCQVNFOwogICAgICAgIGVsc2UgaWYgKCFTdHJpbmdVdGlscy5pc0VtcHR5\nKHN5bnRheCkpCiAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1l\nbnRFeGNlcHRpb24oc3ludGF4KTsKICAgIH0KCiAgICAvKioKICAgICAqIFJl\ndHVybiBhIFNRTCBzdHJpbmcgdG8gYWN0IGFzIGEgcGxhY2Vob2xkZXIgZm9y\nIHRoZSBnaXZlbiBjb2x1bW4uCiAgICAgKi8KICAgIHB1YmxpYyBTdHJpbmcg\nZ2V0UGxhY2Vob2xkZXJWYWx1ZVN0cmluZyhDb2x1bW4gY29sKSB7CiAgICAg\nICAgc3dpdGNoIChjb2wuZ2V0VHlwZSgpKSB7CiAgICAgICAgICAgIGNhc2Ug\nVHlwZXMuQklHSU5UOgogICAgICAgICAgICBjYXNlIFR5cGVzLkJJVDoKICAg\nICAgICAgICAgY2FzZSBUeXBlcy5JTlRFR0VSOgogICAgICAgICAgICBjYXNl\nIFR5cGVzLk5VTUVSSUM6CiAgICAgICAgICAgIGNhc2UgVHlwZXMuU01BTExJ\nTlQ6CiAgICAgICAgICAgIGNhc2UgVHlwZXMuVElOWUlOVDoKICAgICAgICAg\nICAgICAgIHJldHVybiAiMCI7CiAgICAgICAgICAgIGNhc2UgVHlwZXMuQ0hB\nUjoKICAgICAgICAgICAgICAgIHJldHVybiAoc3RvcmVDaGFyc0FzTnVtYmVy\ncykgPyAiMCIgOiAiJyAnIjsKICAgICAgICAgICAgY2FzZSBUeXBlcy5DTE9C\nOgogICAgICAgICAgICBjYXNlIFR5cGVzLkxPTkdWQVJDSEFSOgogICAgICAg\nICAgICBjYXNlIFR5cGVzLlZBUkNIQVI6CiAgICAgICAgICAgICAgICByZXR1\ncm4gIicnIjsKICAgICAgICAgICAgY2FzZSBUeXBlcy5EQVRFOgogICAgICAg\nICAgICAgICAgcmV0dXJuIFpFUk9fREFURV9TVFI7CiAgICAgICAgICAgIGNh\nc2UgVHlwZXMuREVDSU1BTDoKICAgICAgICAgICAgY2FzZSBUeXBlcy5ET1VC\nTEU6CiAgICAgICAgICAgIGNhc2UgVHlwZXMuRkxPQVQ6CiAgICAgICAgICAg\nIGNhc2UgVHlwZXMuUkVBTDoKICAgICAgICAgICAgICAgIHJldHVybiAiMC4w\nIjsKICAgICAgICAgICAgY2FzZSBUeXBlcy5USU1FOgogICAgICAgICAgICAg\nICAgcmV0dXJuIFpFUk9fVElNRV9TVFI7CiAgICAgICAgICAgIGNhc2UgVHlw\nZXMuVElNRVNUQU1QOgogICAgICAgICAgICAgICAgcmV0dXJuIFpFUk9fVElN\nRVNUQU1QX1NUUjsKICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAg\nICAgIHJldHVybiAiTlVMTCI7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgog\nICAgICogQ3JlYXRlIGEgU0VMRUNUIENPVU5UIHN0YXRlbWVudCBpbiB0aGUg\ncHJvcGVyIGpvaW4gc3ludGF4IGZvciB0aGUKICAgICAqIGdpdmVuIGluc3Rh\nbmNlLgogICAgICovCiAgICBwdWJsaWMgU1FMQnVmZmVyIHRvU2VsZWN0Q291\nbnQoU2VsZWN0IHNlbCkgewogICAgICAgIFNRTEJ1ZmZlciBzZWxlY3RTUUwg\nPSBuZXcgU1FMQnVmZmVyKHRoaXMpOwogICAgICAgIFNRTEJ1ZmZlciBmcm9t\nOwogICAgICAgIHNlbC5hZGRKb2luQ2xhc3NDb25kaXRpb25zKCk7CiAgICAg\nICAgaWYgKHNlbC5nZXRGcm9tU2VsZWN0KCkgIT0gbnVsbCkKICAgICAgICAg\nICAgZnJvbSA9IGdldEZyb21TZWxlY3Qoc2VsLCBmYWxzZSk7CiAgICAgICAg\nZWxzZQogICAgICAgICAgICBmcm9tID0gZ2V0RnJvbShzZWwsIGZhbHNlKTsK\nICAgICAgICBTUUxCdWZmZXIgd2hlcmUgPSBnZXRXaGVyZShzZWwsIGZhbHNl\nKTsKCiAgICAgICAgLy8gaWYgbm8gZ3JvdXBpbmcgYW5kIG5vIHJhbmdlLCB3\nZSBtaWdodCBiZSBhYmxlIHRvIGdldCBieSB3aXRob3V0CiAgICAgICAgLy8g\nYSBzdWJzZWxlY3QKICAgICAgICBpZiAoc2VsLmdldEdyb3VwaW5nKCkgPT0g\nbnVsbCAmJiBzZWwuZ2V0U3RhcnRJbmRleCgpID09IDAKICAgICAgICAgICAg\nJiYgc2VsLmdldEVuZEluZGV4KCkgPT0gTG9uZy5NQVhfVkFMVUUpIHsKICAg\nICAgICAgICAgLy8gaWYgdGhlIHNlbGVjdCBoYXMgbm8gaWRlbnRpZmllciBj\nb2xzLCB1c2UgQ09VTlQoKikKICAgICAgICAgICAgTGlzdCBhbGlhc2VzID0g\nKCFzZWwuaXNEaXN0aW5jdCgpKSA/IENvbGxlY3Rpb25zLkVNUFRZX0xJU1QK\nICAgICAgICAgICAgICAgIDogc2VsLmdldElkZW50aWZpZXJBbGlhc2VzKCk7\nCiAgICAgICAgICAgIGlmIChhbGlhc2VzLmlzRW1wdHkoKSkgewogICAgICAg\nICAgICAgICAgc2VsZWN0U1FMLmFwcGVuZCgiQ09VTlQoKikiKTsKICAgICAg\nICAgICAgICAgIHJldHVybiB0b1NlbGVjdChzZWxlY3RTUUwsIG51bGwsIGZy\nb20sIHdoZXJlLCBudWxsLCBudWxsLCBudWxsLAogICAgICAgICAgICAgICAg\nICAgIGZhbHNlLCBmYWxzZSwgMCwgTG9uZy5NQVhfVkFMVUUpOwogICAgICAg\nICAgICB9CgogICAgICAgICAgICAvLyBpZiB0aGVyZSBpcyBhIHNpbmdsZSBk\naXN0aW5jdCBjb2wsIHVzZSBDT1VOVChESVNUSU5DVCBjb2wpCiAgICAgICAg\nICAgIGlmIChhbGlhc2VzLnNpemUoKSA9PSAxKSB7CiAgICAgICAgICAgICAg\nICBzZWxlY3RTUUwuYXBwZW5kKCJDT1VOVChESVNUSU5DVCAiKS4KICAgICAg\nICAgICAgICAgICAgICBhcHBlbmQoYWxpYXNlcy5nZXQoMCkudG9TdHJpbmco\nKSkuYXBwZW5kKCIpIik7CiAgICAgICAgICAgICAgICByZXR1cm4gdG9TZWxl\nY3Qoc2VsZWN0U1FMLCBudWxsLCBmcm9tLCB3aGVyZSwgbnVsbCwgbnVsbCwg\nbnVsbCwKICAgICAgICAgICAgICAgICAgICBmYWxzZSwgZmFsc2UsIDAsIExv\nbmcuTUFYX1ZBTFVFKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8g\nY2FuIHdlIGNvbWJpbmUgZGlzdGluY3QgY29scz8KICAgICAgICAgICAgaWYg\nKGRpc3RpbmN0Q291bnRDb2x1bW5TZXBhcmF0b3IgIT0gbnVsbCkgewogICAg\nICAgICAgICAgICAgc2VsZWN0U1FMLmFwcGVuZCgiQ09VTlQoRElTVElOQ1Qg\nIik7CiAgICAgICAgICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGFsaWFz\nZXMuc2l6ZSgpOyBpKyspIHsKICAgICAgICAgICAgICAgICAgICBpZiAoaSA+\nIDApIHsKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0U1FMLmFwcGVu\nZCgiICIpOwogICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3RTUUwuYXBw\nZW5kKGRpc3RpbmN0Q291bnRDb2x1bW5TZXBhcmF0b3IpOwogICAgICAgICAg\nICAgICAgICAgICAgICBzZWxlY3RTUUwuYXBwZW5kKCIgIik7CiAgICAgICAg\nICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHNlbGVjdFNRTC5h\ncHBlbmQoYWxpYXNlcy5nZXQoaSkudG9TdHJpbmcoKSk7CiAgICAgICAgICAg\nICAgICB9CiAgICAgICAgICAgICAgICBzZWxlY3RTUUwuYXBwZW5kKCIpIik7\nCiAgICAgICAgICAgICAgICByZXR1cm4gdG9TZWxlY3Qoc2VsZWN0U1FMLCBu\ndWxsLCBmcm9tLCB3aGVyZSwgbnVsbCwgbnVsbCwgbnVsbCwKICAgICAgICAg\nICAgICAgICAgICBmYWxzZSwgZmFsc2UsIDAsIExvbmcuTUFYX1ZBTFVFKTsK\nICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgLy8gc2luY2Ugd2Ug\nY2FuJ3QgY29tYmluZSBkaXN0aW5jdCBjb2xzLCB3ZSBoYXZlIHRvIHBlcmZv\ncm0gYW4gb3V0ZXIKICAgICAgICAvLyBDT1VOVCgqKSBzZWxlY3QgdXNpbmcg\ndGhlIG9yaWdpbmFsIHNlbGVjdCBhcyBhIHN1YnNlbGVjdCBpbiB0aGUKICAg\nICAgICAvLyBGUk9NIGNsYXVzZQogICAgICAgIGFzc2VydFN1cHBvcnQoc3Vw\ncG9ydHNTdWJzZWxlY3QsICJTdXBwb3J0c1N1YnNlbGVjdCIpOwoKICAgICAg\nICBTUUxCdWZmZXIgc3ViU2VsZWN0ID0gZ2V0U2VsZWN0cyhzZWwsIHRydWUs\nIGZhbHNlKTsKICAgICAgICBTUUxCdWZmZXIgc3ViRnJvbSA9IGZyb207CiAg\nICAgICAgZnJvbSA9IG5ldyBTUUxCdWZmZXIodGhpcyk7CiAgICAgICAgZnJv\nbS5hcHBlbmQoIigiKTsKICAgICAgICBmcm9tLmFwcGVuZCh0b1NlbGVjdChz\ndWJTZWxlY3QsIG51bGwsIHN1YkZyb20sIHdoZXJlLAogICAgICAgICAgICBz\nZWwuZ2V0R3JvdXBpbmcoKSwgc2VsLmdldEhhdmluZygpLCBudWxsLCBzZWwu\naXNEaXN0aW5jdCgpLAogICAgICAgICAgICBmYWxzZSwgc2VsLmdldFN0YXJ0\nSW5kZXgoKSwgc2VsLmdldEVuZEluZGV4KCksIHRydWUpKTsKICAgICAgICBm\ncm9tLmFwcGVuZCgiKSIpOwogICAgICAgIGlmIChyZXF1aXJlc0FsaWFzRm9y\nU3Vic2VsZWN0KQogICAgICAgICAgICBmcm9tLmFwcGVuZCgiICIpLmFwcGVu\nZChTZWxlY3QuRlJPTV9TRUxFQ1RfQUxJQVMpOwoKICAgICAgICBzZWxlY3RT\nUUwuYXBwZW5kKCJDT1VOVCgqKSIpOwogICAgICAgIHJldHVybiB0b1NlbGVj\ndChzZWxlY3RTUUwsIG51bGwsIGZyb20sIG51bGwsIG51bGwsIG51bGwsIG51\nbGwsCiAgICAgICAgICAgIGZhbHNlLCBmYWxzZSwgMCwgTG9uZy5NQVhfVkFM\nVUUpOwogICAgfQoKICAgIC8qKgogICAgICogQ3JlYXRlIGEgREVMRVRFIHN0\nYXRlbWVudCBmb3IgdGhlIHNwZWNpZmllZCBTZWxlY3QuIElmIHRoZQogICAg\nICogZGF0YWJhc2UgZG9lcyBub3Qgc3VwcG9ydCB0aGUgYnVsayBkZWxldGUg\nc3RhdGVtZW50IChzdWNoIGFzCiAgICAgKiBjYXNlcyB3aGVyZSBhIHN1YnNl\nbGVjdCBpcyByZXF1aXJlZCBhbmQgdGhlIGRhdGFiYXNlIGRvZXNuJ3Qgc3Vw\ncG9ydAogICAgICogc3Vic2VsZWN0cyksIHRoaXMgbWV0aG9kIHNob3VsZCBy\nZXR1cm4gbnVsbC4KICAgICAqLwogICAgcHVibGljIFNRTEJ1ZmZlciB0b0Rl\nbGV0ZShDbGFzc01hcHBpbmcgbWFwcGluZywgU2VsZWN0IHNlbCwgCiAgICAg\nICAgT2JqZWN0W10gcGFyYW1zKSB7CiAgICAgICAgcmV0dXJuIHRvQnVsa09w\nZXJhdGlvbihtYXBwaW5nLCBzZWwsIG51bGwsIHBhcmFtcywgbnVsbCk7CiAg\nICB9CgogICAgcHVibGljIFNRTEJ1ZmZlciB0b1VwZGF0ZShDbGFzc01hcHBp\nbmcgbWFwcGluZywgU2VsZWN0IHNlbCwKICAgICAgICBKREJDU3RvcmUgc3Rv\ncmUsIE9iamVjdFtdIHBhcmFtcywgTWFwIHVwZGF0ZXMpIHsKICAgICAgICBy\nZXR1cm4gdG9CdWxrT3BlcmF0aW9uKG1hcHBpbmcsIHNlbCwgc3RvcmUsIHBh\ncmFtcywgdXBkYXRlcyk7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm5z\nIHRoZSBTUUwgZm9yIGEgYnVsayBvcGVyYXRpb24sIGVpdGhlciBhIERFTEVU\nRSBvciBhbiBVUERBVEUuCiAgICAgKgogICAgICogQHBhcmFtIG1hcHBpbmcg\ndGhlIG1hcHBuZyBhZ2FpbnN0IHdoaWNoIHdlIGFyZSBvcGVyYXRpbmcKICAg\nICAqIEBwYXJhbSBzZWwgdGhlIFNlbGVjdCB0aGF0IHdpbGwgY29uc3RpdHV0\nZSB0aGUgV0hFUkUgY2xhdXNlCiAgICAgKiBAcGFyYW0gc3RvcmUgdGhlIGN1\ncnJlbnQgc3RvcmUKICAgICAqIEBwYXJhbSB1cGRhdGVQYXJhbXMgdGhlIE1h\ncCB0aGF0IGhvbGRzIHRoZSB1cGRhdGUgcGFyYW1ldGVyczsgYSBudWxsCiAg\nICAgKiB2YWx1ZSBpbmRpY2F0ZXMgdGhhdCB0aGlzIGlzIGEgZGVsZXRlIG9w\nZXJhdGlvbgogICAgICogQHJldHVybiB0aGUgU1FMQnVmZmVyIGZvciB0aGUg\ndXBkYXRlLCBvciA8ZW0+bnVsbDwvZW0+IGlmIGl0IGlzIG5vdAogICAgICog\ncG9zc2libGUgdG8gcGVyZm9ybSB0aGUgYnVsayB1cGRhdGUKICAgICAqLwog\nICAgcHJvdGVjdGVkIFNRTEJ1ZmZlciB0b0J1bGtPcGVyYXRpb24oQ2xhc3NN\nYXBwaW5nIG1hcHBpbmcsIFNlbGVjdCBzZWwsCiAgICAgICAgSkRCQ1N0b3Jl\nIHN0b3JlLCBPYmplY3RbXSBwYXJhbXMsIE1hcCB1cGRhdGVQYXJhbXMpIHsK\nICAgICAgICBTUUxCdWZmZXIgc3FsID0gbmV3IFNRTEJ1ZmZlcih0aGlzKTsK\nICAgICAgICBpZiAodXBkYXRlUGFyYW1zID09IG51bGwpIHsKICAgICAgICAg\nIGlmIChyZXF1aXJlc1RhcmdldEZvckRlbGV0ZSkgewogICAgICAgICAgICBz\ncWwuYXBwZW5kKCJERUxFVEUgIik7CiAgICAgICAgICAgIFNRTEJ1ZmZlciBk\nZWxldGVUYXJnZXRzID0gZ2V0RGVsZXRlVGFyZ2V0cyhzZWwpOwogICAgICAg\nICAgICBzcWwuYXBwZW5kKGRlbGV0ZVRhcmdldHMpOwogICAgICAgICAgICBz\ncWwuYXBwZW5kKCIgRlJPTSAiKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAg\nICAgICAgIHNxbC5hcHBlbmQoIkRFTEVURSBGUk9NICIpOwogICAgICAgICAg\nfQogICAgICAgIH0KICAgICAgICBlbHNlCiAgICAgICAgICAgIHNxbC5hcHBl\nbmQoIlVQREFURSAiKTsKICAgICAgICBzZWwuYWRkSm9pbkNsYXNzQ29uZGl0\naW9ucygpOwoKICAgICAgICAvLyBpZiB0aGVyZSBpcyBvbmx5IGEgc2luZ2xl\nIHRhYmxlIGluIHRoZSBzZWxlY3QsIHRoZW4gd2UgY2FuCiAgICAgICAgLy8g\nanVzdCBpc3N1ZSBhIHNpbmdsZSBERUxFVEUgRlJPTSBUQUJMRSBXSEVSRSA8\nY29uZGl0aW9ucz4KICAgICAgICAvLyBzdGF0ZW1lbnQ7IG90aGVyd2lzZSwg\nc2luY2UgU1FMIGRvZXNuJ3QgYWxsb3cgZGVsZXRpbmcKICAgICAgICAvLyBm\ncm9tIG9uZSBvZiBhIG11bHRpLXRhYmxlIHNlbGVjdCwgd2UgbmVlZCB0byBp\nc3N1ZSBhIHN1YnNlbGVjdAogICAgICAgIC8vIGxpa2UgREVMRVRFIEZST00g\nVEFCTEUgV0hFUkUgRVhJU1RTCiAgICAgICAgLy8gKFNFTEVDVCAxIEZST00g\nVEFCTEUgdDAgV0hFUkUgdDAuSUQgPSBUQUJMRS5JRCk7IGFsc28sIHNvbWUK\nICAgICAgICAvLyBkYXRhYmFzZXMgZG8gbm90IGFsbG93IGFsaWFzZXMgaW4g\nZGVsZXRlIHN0YXRlbWVudHMsIHdoaWNoCiAgICAgICAgLy8gYWxzbyBjYXVz\nZXMgdXMgdG8gdXNlIGEgc3Vic2VsZWN0CiAgICAgICAgaWYgKHNlbC5nZXRU\nYWJsZUFsaWFzZXMoKS5zaXplKCkgPT0gMSAmJiBzdXBwb3J0c1N1YnNlbGVj\ndAogICAgICAgICAgICAmJiBhbGxvd3NBbGlhc0luQnVsa0NsYXVzZSkgewog\nICAgICAgICAgICBTUUxCdWZmZXIgZnJvbTsKICAgICAgICAgICAgaWYgKHNl\nbC5nZXRGcm9tU2VsZWN0KCkgIT0gbnVsbCkKICAgICAgICAgICAgICAgIGZy\nb20gPSBnZXRGcm9tU2VsZWN0KHNlbCwgZmFsc2UpOwogICAgICAgICAgICBl\nbHNlCiAgICAgICAgICAgICAgICBmcm9tID0gZ2V0RnJvbShzZWwsIGZhbHNl\nKTsKCiAgICAgICAgICAgIHNxbC5hcHBlbmQoZnJvbSk7CiAgICAgICAgICAg\nIGFwcGVuZFVwZGF0ZXMoc2VsLCBzdG9yZSwgc3FsLCBwYXJhbXMsIHVwZGF0\nZVBhcmFtcywKICAgICAgICAgICAgICAgIGFsbG93c0FsaWFzSW5CdWxrQ2xh\ndXNlKTsKCiAgICAgICAgICAgIFNRTEJ1ZmZlciB3aGVyZSA9IHNlbC5nZXRX\naGVyZSgpOwogICAgICAgICAgICBpZiAod2hlcmUgIT0gbnVsbCAmJiAhd2hl\ncmUuaXNFbXB0eSgpKSB7CiAgICAgICAgICAgICAgICBzcWwuYXBwZW5kKCIg\nV0hFUkUgIik7CiAgICAgICAgICAgICAgICBzcWwuYXBwZW5kKHdoZXJlKTsK\nICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gc3FsOwogICAgICAg\nIH0KCiAgICAgICAgVGFibGUgdGFibGUgPSBtYXBwaW5nLmdldFRhYmxlKCk7\nCiAgICAgICAgU3RyaW5nIHRhYmxlTmFtZSA9IGdldEZ1bGxOYW1lKHRhYmxl\nLCBmYWxzZSk7CgogICAgICAgIC8vIG9ubHkgdXNlIGEgIHN1YnNlbGVjdCBp\nZiB0aGUgd2hlcmUgaXMgbm90IGVtcHR5OyBvdGhlcndpc2UKICAgICAgICAv\nLyBhbiB1bnF1YWxpZmllZCBkZWxldGUgb3IgdXBkYXRlIHdpbGwgd29yawog\nICAgICAgIGlmIChzZWwuZ2V0V2hlcmUoKSA9PSBudWxsIHx8IHNlbC5nZXRX\naGVyZSgpLmlzRW1wdHkoKSkgewogICAgICAgICAgICBzcWwuYXBwZW5kKHRh\nYmxlTmFtZSk7CiAgICAgICAgICAgIGFwcGVuZFVwZGF0ZXMoc2VsLCBzdG9y\nZSwgc3FsLCBwYXJhbXMsIHVwZGF0ZVBhcmFtcywgZmFsc2UpOwogICAgICAg\nICAgICByZXR1cm4gc3FsOwogICAgICAgIH0KCiAgICAgICAgLy8gd2UgbmVl\nZCB0byB1c2UgYSBzdWJzZWxlY3QgaWYgd2UgYXJlIHRvIGJ1bGsgZGVsZXRl\nIHdoZXJlCiAgICAgICAgLy8gdGhlIHNlbGVjdCBpbmNsdWRlcyBtdWx0aXBs\nZSB0YWJsZXM7IGlmIHRoZSBkYXRhYmFzZQogICAgICAgIC8vIGRvZXNuJ3Qg\nc3VwcG9ydCBpdCwgdGhlbiB3ZSBuZWVkIHRvIHNpZ2FsIHRoaXMgYnkgcmV0\ndXJuaW5nIG51bGwKICAgICAgICBpZiAoIXN1cHBvcnRzU3Vic2VsZWN0IHx8\nICFzdXBwb3J0c0NvcnJlbGF0ZWRTdWJzZWxlY3QpCiAgICAgICAgICAgIHJl\ndHVybiBudWxsOwoKICAgICAgICBDb2x1bW5bXSBwa3MgPSBtYXBwaW5nLmdl\ndFByaW1hcnlLZXlDb2x1bW5zKCk7CiAgICAgICAgc2VsLmNsZWFyU2VsZWN0\ncygpOwogICAgICAgIHNlbC5zZXREaXN0aW5jdCh0cnVlKTsKCiAgICAgICAg\nLy8gaWYgd2UgaGF2ZSBvbmx5IGEgc2luZ2xlIFBLLCB3ZSBjYW4gdXNlIGEg\nbm9uLWNvcnJlbGF0ZWQKICAgICAgICAvLyBzdWJxdWVyeSAodXNpbmcgYW4g\nSU4gc3RhdGVtZW50KSwgd2hpY2ggaXMgbXVjaCBmYXN0ZXIgdGhhbgogICAg\nICAgIC8vIGEgY29ycmVsYXRlZCBzdWJxdWVyeSAoc2luY2UgYSBjb3JyZWxh\ndGVkIHN1YnF1ZXJ5IG5lZWRzCiAgICAgICAgLy8gdG8gYmUgZXhlY3V0ZWQg\nb25jZSBmb3IgZWFjaCByb3cgaW4gdGhlIHRhYmxlKQogICAgICAgIGlmIChw\na3MubGVuZ3RoID09IDEpIHsKICAgICAgICAgICAgc2VsLnNlbGVjdChwa3Nb\nMF0pOwogICAgICAgICAgICBzcWwuYXBwZW5kKHRhYmxlTmFtZSk7CiAgICAg\nICAgICAgIGFwcGVuZFVwZGF0ZXMoc2VsLCBzdG9yZSwgc3FsLCBwYXJhbXMs\nIHVwZGF0ZVBhcmFtcywgZmFsc2UpOwogICAgICAgICAgICBzcWwuYXBwZW5k\nKCIgV0hFUkUgIikuCiAgICAgICAgICAgICAgICBhcHBlbmQocGtzWzBdKS5h\ncHBlbmQoIiBJTiAoIikuCiAgICAgICAgICAgICAgICBhcHBlbmQoc2VsLnRv\nU2VsZWN0KGZhbHNlLCBudWxsKSkuYXBwZW5kKCIpIik7CiAgICAgICAgfSBl\nbHNlIHsKICAgICAgICAgICAgc2VsLmNsZWFyU2VsZWN0cygpOwogICAgICAg\nICAgICBzZWwuc2V0RGlzdGluY3QoZmFsc2UpOwoKICAgICAgICAgICAgLy8g\nc2luY2UgdGhlIHNlbGVjdCBpcyB1c2luZyBhIGNvcnJlbGF0ZWQgc3VicXVl\ncnksIHdlCiAgICAgICAgICAgIC8vIG9ubHkgbmVlZCB0byBzZWxlY3QgYSBi\nb2d1cyB2aXJ0dWFsIGNvbHVtbgogICAgICAgICAgICBzZWwuc2VsZWN0KCIx\nIiwgbnVsbCk7CgogICAgICAgICAgICAvLyBhZGQgaW4gdGhlIGpvaW5zIHRv\nIHRoZSB0YWJsZQogICAgICAgICAgICBDb2x1bW5bXSBjb2xzID0gdGFibGUu\nZ2V0UHJpbWFyeUtleSgpLmdldENvbHVtbnMoKTsKICAgICAgICAgICAgU1FM\nQnVmZmVyIGJ1ZiA9IG5ldyBTUUxCdWZmZXIodGhpcyk7CiAgICAgICAgICAg\nIGJ1Zi5hcHBlbmQoIigiKTsKICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7\nIGkgPCBjb2xzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgICBpZiAo\naSA+IDApCiAgICAgICAgICAgICAgICAgICAgYnVmLmFwcGVuZCgiIEFORCAi\nKTsKCiAgICAgICAgICAgICAgICAvLyBhZGQgaW4gInQwLlBLID0gTVlUQUJM\nRS5QSyIKICAgICAgICAgICAgICAgIGJ1Zi5hcHBlbmQoc2VsLmdldENvbHVt\nbkFsaWFzKGNvbHNbaV0sIG51bGwpKS5hcHBlbmQoIiA9ICIpLgogICAgICAg\nICAgICAgICAgICAgIGFwcGVuZCh0YWJsZSkuYXBwZW5kKGNhdGFsb2dTZXBh\ncmF0b3IpLmFwcGVuZChjb2xzW2ldKTsKICAgICAgICAgICAgfQogICAgICAg\nICAgICBidWYuYXBwZW5kKCIpIik7CiAgICAgICAgICAgIHNlbC53aGVyZShi\ndWYsIG51bGwpOwoKICAgICAgICAgICAgc3FsLmFwcGVuZCh0YWJsZU5hbWUp\nOwogICAgICAgICAgICBhcHBlbmRVcGRhdGVzKHNlbCwgc3RvcmUsIHNxbCwg\ncGFyYW1zLCB1cGRhdGVQYXJhbXMsIGZhbHNlKTsKICAgICAgICAgICAgc3Fs\nLmFwcGVuZCgiIFdIRVJFIEVYSVNUUyAoIikuCiAgICAgICAgICAgICAgICBh\ncHBlbmQoc2VsLnRvU2VsZWN0KGZhbHNlLCBudWxsKSkuYXBwZW5kKCIpIik7\nCiAgICAgICAgfQogICAgICAgIHJldHVybiBzcWw7CiAgICB9CgogICAgcHJv\ndGVjdGVkIFNRTEJ1ZmZlciBnZXREZWxldGVUYXJnZXRzKFNlbGVjdCBzZWwp\nIHsKICAgICAgU1FMQnVmZmVyIGRlbGV0ZVRhcmdldHMgPSBuZXcgU1FMQnVm\nZmVyKHRoaXMpOwogICAgICBDb2xsZWN0aW9uIGFsaWFzZXMgPSBzZWwuZ2V0\nVGFibGVBbGlhc2VzKCk7CiAgICAgIC8vIEFzc3VtZXMgYWxpYXNlcyBhcmUg\nb2YgdGhlIGZvcm0gIlRBQkxFTkFNRSB0MCIKICAgICAgZm9yIChJdGVyYXRv\nciBpdHIgPSBhbGlhc2VzLml0ZXJhdG9yKCk7IGl0ci5oYXNOZXh0KCk7KSB7\nCiAgICAgICAgU3RyaW5nIHRhYmxlQWxpYXMgPSBpdHIubmV4dCgpLnRvU3Ry\naW5nKCk7CiAgICAgICAgaW50IHNwYWNlSW5kZXggPSB0YWJsZUFsaWFzLmlu\nZGV4T2YoJyAnKTsKICAgICAgICBpZiAoc3BhY2VJbmRleCA+IDAgJiYgc3Bh\nY2VJbmRleCA8IHRhYmxlQWxpYXMubGVuZ3RoKCkgLSAxKSB7CiAgICAgICAg\nICBpZiAoYWxsb3dzQWxpYXNJbkJ1bGtDbGF1c2UpIHsKICAgICAgICAgICAg\nZGVsZXRlVGFyZ2V0cy5hcHBlbmQodGFibGVBbGlhcy5zdWJzdHJpbmcoc3Bh\nY2VJbmRleCArIDEpKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAg\nIGRlbGV0ZVRhcmdldHMuYXBwZW5kKHRhYmxlQWxpYXMuc3Vic3RyaW5nKDAs\nIHNwYWNlSW5kZXgpKTsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2Ugewog\nICAgICAgICAgZGVsZXRlVGFyZ2V0cy5hcHBlbmQodGFibGVBbGlhcyk7CiAg\nICAgICAgfQogICAgICAgIGlmIChpdHIuaGFzTmV4dCgpKQogICAgICAgICAg\nZGVsZXRlVGFyZ2V0cy5hcHBlbmQoIiwgIik7CiAgICAgIH0gICAgICAKICAg\nICAgcmV0dXJuIGRlbGV0ZVRhcmdldHM7ICAgICAgCiAgICB9CgogICAgcHJv\ndGVjdGVkIHZvaWQgYXBwZW5kVXBkYXRlcyhTZWxlY3Qgc2VsLCBKREJDU3Rv\ncmUgc3RvcmUsIFNRTEJ1ZmZlciBzcWwsCiAgICAgICAgT2JqZWN0W10gcGFy\nYW1zLCBNYXAgdXBkYXRlUGFyYW1zLCBib29sZWFuIGFsbG93QWxpYXMpIHsK\nICAgICAgICBpZiAodXBkYXRlUGFyYW1zID09IG51bGwgfHwgdXBkYXRlUGFy\nYW1zLnNpemUoKSA9PSAwKQogICAgICAgICAgICByZXR1cm47CgogICAgICAg\nIC8vIG1hbnVhbGx5IGJ1aWxkIHVwIHRoZSBTRVQgY2xhdXNlIGZvciB0aGUg\nVVBEQVRFIHN0YXRlbWVudAogICAgICAgIHNxbC5hcHBlbmQoIiBTRVQgIik7\nCiAgICAgICAgRXhwQ29udGV4dCBjdHggPSBuZXcgRXhwQ29udGV4dChzdG9y\nZSwgcGFyYW1zLCAKICAgICAgICAgICAgc3RvcmUuZ2V0RmV0Y2hDb25maWd1\ncmF0aW9uKCkpOwoKICAgICAgICAvLyBJZiB0aGUgdXBkYXRlcyBtYXAgY29u\ndGFpbnMgYW55IHZlcnNpb24gZmllbGRzLCBhc3N1bWUgdGhhdCB0aGUKICAg\nICAgICAvLyBvcHRpbWlzdGljIGxvY2sgdmVyc2lvbiBkYXRhIGlzIGJlaW5n\nIGhhbmRsZWQgcHJvcGVybHkgYnkgdGhlCiAgICAgICAgLy8gY2FsbGVyLiBP\ndGhlcndpc2UsIGdpdmUgdGhlIHZlcnNpb24gaW5kaWNhdG9yIGFuIG9wcG9y\ndHVuaXR5IHRvCiAgICAgICAgLy8gYWRkIG1vcmUgdXBkYXRlIGNsYXVzZXMg\nYXMgbmVlZGVkLgogICAgICAgIGJvb2xlYW4gYXVnbWVudFVwZGF0ZXMgPSB0\ncnVlOwoKICAgICAgICBmb3IgKEl0ZXJhdG9yIGkgPSB1cGRhdGVQYXJhbXMu\nZW50cnlTZXQoKS5pdGVyYXRvcigpOyBpLmhhc05leHQoKTspIHsKICAgICAg\nICAgICAgTWFwLkVudHJ5IG5leHQgPSAoTWFwLkVudHJ5KSBpLm5leHQoKTsK\nICAgICAgICAgICAgUGF0aCBwYXRoID0gKFBhdGgpIG5leHQuZ2V0S2V5KCk7\nCiAgICAgICAgICAgIEZpZWxkTWFwcGluZyBmbWQgPSAoRmllbGRNYXBwaW5n\nKSBwYXRoLmxhc3QoKTsKCiAgICAgICAgICAgIGlmIChmbWQuaXNWZXJzaW9u\nKCkpCiAgICAgICAgICAgICAgICBhdWdtZW50VXBkYXRlcyA9IGZhbHNlOwoK\nICAgICAgICAgICAgVmFsIHZhbCA9IChWYWwpIG5leHQuZ2V0VmFsdWUoKTsK\nCiAgICAgICAgICAgIENvbHVtbiBjb2wgPSBmbWQuZ2V0Q29sdW1ucygpWzBd\nOwogICAgICAgICAgICBpZiAoYWxsb3dBbGlhcykgewogICAgICAgICAgICAg\nIHNxbC5hcHBlbmQoc2VsLmdldENvbHVtbkFsaWFzKGNvbCkpOwogICAgICAg\nICAgICB9IGVsc2UgewogICAgICAgICAgICAgIHNxbC5hcHBlbmQoY29sLmdl\ndE5hbWUoKSk7ICAKICAgICAgICAgICAgfSAgICAgICAgICAgIAogICAgICAg\nICAgICBzcWwuYXBwZW5kKCIgPSAiKTsKCiAgICAgICAgICAgIEV4cFN0YXRl\nIHN0YXRlID0gdmFsLmluaXRpYWxpemUoc2VsLCBjdHgsIDApOwogICAgICAg\nICAgICAvLyBKREJDIFBhdGhzIGFyZSBhbHdheXMgUENQYXRoczsgUENQYXRo\nIGltcGxlbWVudHMgVmFsCiAgICAgICAgICAgIEV4cFN0YXRlIHBhdGhTdGF0\nZSA9ICgoVmFsKSBwYXRoKS5pbml0aWFsaXplKHNlbCwgY3R4LCAwKTsKICAg\nICAgICAgICAgY2FsY3VsYXRlVmFsdWUodmFsLCBzZWwsIGN0eCwgc3RhdGUs\nIHBhdGgsIHBhdGhTdGF0ZSk7CgogICAgICAgICAgICAvLyBhcHBlbmQgdGhl\nIHZhbHVlIHdpdGggYSBudWxsIGZvciB0aGUgU2VsZWN0OyBpCiAgICAgICAg\nICAgIC8vIGluZGljYXRlcyB0aGF0IHRoZQogICAgICAgICAgICBpbnQgbGVu\nZ3RoID0gdmFsLmxlbmd0aChzZWwsIGN0eCwgc3RhdGUpOwogICAgICAgICAg\nICBmb3IgKGludCBqID0gMDsgaiA8IGxlbmd0aDsgaisrKQogICAgICAgICAg\nICAgICAgdmFsLmFwcGVuZFRvKChhbGxvd0FsaWFzKSA/IHNlbCA6IG51bGws\nIGN0eCwgc3RhdGUsIHNxbCwgaik7CgogICAgICAgICAgICBpZiAoaS5oYXNO\nZXh0KCkpCiAgICAgICAgICAgICAgICBzcWwuYXBwZW5kKCIsICIpOwogICAg\nICAgIH0KCiAgICAgICAgaWYgKGF1Z21lbnRVcGRhdGVzKSB7CiAgICAgICAg\nICAgIFBhdGggcGF0aCA9IChQYXRoKSB1cGRhdGVQYXJhbXMua2V5U2V0KCku\naXRlcmF0b3IoKS5uZXh0KCk7CiAgICAgICAgICAgIEZpZWxkTWFwcGluZyBm\nbSA9IChGaWVsZE1hcHBpbmcpIHBhdGgubGFzdCgpOwogICAgICAgICAgICBD\nbGFzc01hcHBpbmcgbWV0YSA9IGZtLmdldERlY2xhcmluZ01hcHBpbmcoKTsK\nICAgICAgICAgICAgTWFwIHVwZGF0ZXMgPSBtZXRhLmdldFZlcnNpb24oKS5n\nZXRCdWxrVXBkYXRlVmFsdWVzKCk7CiAgICAgICAgICAgIGZvciAoSXRlcmF0\nb3IgaXRlciA9IHVwZGF0ZXMuZW50cnlTZXQoKS5pdGVyYXRvcigpOwogICAg\nICAgICAgICAgICAgaXRlci5oYXNOZXh0KCk7ICkgewogICAgICAgICAgICAg\nICAgTWFwLkVudHJ5IGUgPSAoTWFwLkVudHJ5KSBpdGVyLm5leHQoKTsKICAg\nICAgICAgICAgICAgIENvbHVtbiBjb2wgPSAoQ29sdW1uKSBlLmdldEtleSgp\nOwogICAgICAgICAgICAgICAgU3RyaW5nIHZhbCA9IChTdHJpbmcpIGUuZ2V0\nVmFsdWUoKTsKICAgICAgICAgICAgICAgIHNxbC5hcHBlbmQoIiwgIikuYXBw\nZW5kKGNvbC5nZXROYW1lKCkpCiAgICAgICAgICAgICAgICAgICAgLmFwcGVu\nZCgiID0gIikuYXBwZW5kKHZhbCk7CiAgICAgICAgICAgIH0KICAgICAgICB9\nCiAgICB9CiAgICAKICAgIC8qKgogICAgICogQ3JlYXRlIFNRTCB0byBkZWxl\ndGUgdGhlIGNvbnRlbnRzIG9mIHRoZSBzcGVjaWZpZWQgdGFibGVzLiAKICAg\nICAqIFRoZSBkZWZhdWx0IGltcGxlbWVudGF0aW9uIGRyb3BzIGFsbCBub24t\nZGVmZXJyZWQgUkVTVFJJQ1QgZm9yZWlnbiBrZXkgCiAgICAgKiBjb25zdHJh\naW50cyBpbnZvbHZpbmcgdGhlIHNwZWNpZmllZCB0YWJsZXMsIGlzc3VlcyBE\nRUxFVEUgc3RhdGVtZW50cyAKICAgICAqIGFnYWluc3QgdGhlIHRhYmxlcywg\nYW5kIHRoZW4gYWRkcyB0aGUgZHJvcHBlZCBjb25zdHJhaW50cyBiYWNrIGlu\nLiAKICAgICAqIERhdGFiYXNlcyB3aXRoIG1vcmUgb3B0aW1hbCB3YXlzIG9m\nIGRlbGV0aW5nIHRoZSBjb250ZW50cyBvZiBzZXZlcmFsIAogICAgICogdGFi\nbGVzIHNob3VsZCBvdmVycmlkZSB0aGlzIG1ldGhvZC4KICAgICAqLwogICAg\ncHVibGljIFN0cmluZ1tdIGdldERlbGV0ZVRhYmxlQ29udGVudHNTUUwoVGFi\nbGVbXSB0YWJsZXMpIHsKICAgICAgICBDb2xsZWN0aW9uIHNxbCA9IG5ldyBB\ncnJheUxpc3QoKTsKICAgICAgICAKICAgICAgICAvLyBjb2xsZWN0IGFuZCBk\ncm9wIG5vbi1kZWZlcnJlZCBwaHlzaWNhbCByZXN0cmljdCBjb25zdHJhaW50\ncywgYW5kCiAgICAgICAgLy8gY29sbGVjdCB0aGUgREVMRVRFIEZST00gc3Rh\ndGVtZW50cwogICAgICAgIENvbGxlY3Rpb24gZGVsZXRlU1FMID0gbmV3IEFy\ncmF5TGlzdCh0YWJsZXMubGVuZ3RoKTsKICAgICAgICBDb2xsZWN0aW9uIHJl\nc3RyaWN0Q29uc3RyYWludHMgPSBuZXcgTGlua2VkSGFzaFNldCgpOwogICAg\nICAgIGZvciAoaW50IGkgPSAwOyBpIDwgdGFibGVzLmxlbmd0aDsgaSsrKSB7\nCiAgICAgICAgICAgIEZvcmVpZ25LZXlbXSBma3MgPSB0YWJsZXNbaV0uZ2V0\nRm9yZWlnbktleXMoKTsKICAgICAgICAgICAgZm9yIChpbnQgaiA9IDA7IGog\nPCBma3MubGVuZ3RoOyBqKyspIHsKICAgICAgICAgICAgICAgIGlmICghZmtz\nW2pdLmlzTG9naWNhbCgpICYmICFma3Nbal0uaXNEZWZlcnJlZCgpIAogICAg\nICAgICAgICAgICAgICAgICYmIGZrc1tqXS5nZXREZWxldGVBY3Rpb24oKSA9\nPSBGb3JlaWduS2V5LkFDVElPTl9SRVNUUklDVCkKICAgICAgICAgICAgICAg\nIHJlc3RyaWN0Q29uc3RyYWludHMuYWRkKGZrc1tqXSk7CiAgICAgICAgICAg\nICAgICBTdHJpbmdbXSBjb25zdHJhaW50U1FMID0gZ2V0RHJvcEZvcmVpZ25L\nZXlTUUwoZmtzW2pdKTsKICAgICAgICAgICAgICAgIHNxbC5hZGRBbGwoQXJy\nYXlzLmFzTGlzdChjb25zdHJhaW50U1FMKSk7CiAgICAgICAgICAgIH0KICAg\nICAgICAgICAgCiAgICAgICAgICAgIGRlbGV0ZVNRTC5hZGQoIkRFTEVURSBG\nUk9NICIgKyB0YWJsZXNbaV0uZ2V0RnVsbE5hbWUoKSk7CiAgICAgICAgfQog\nICAgICAgIAogICAgICAgIC8vIGFkZCB0aGUgZGVsZXRlIHN0YXRlbWVudHMg\nYWZ0ZXIgYWxsIHRoZSBjb25zdHJhaW50IG11dGF0aW9ucwogICAgICAgIHNx\nbC5hZGRBbGwoZGVsZXRlU1FMKTsKICAgICAgICAKICAgICAgICAvLyBhZGQg\ndGhlIGRlbGV0ZWQgY29uc3RyYWludHMgYmFjayB0byB0aGUgc2NoZW1hCiAg\nICAgICAgZm9yIChJdGVyYXRvciBpdGVyID0gcmVzdHJpY3RDb25zdHJhaW50\ncy5pdGVyYXRvcigpOyBpdGVyLmhhc05leHQoKTsgKSB7CiAgICAgICAgICAg\nIFN0cmluZ1tdIGNvbnN0cmFpbnRTUUwgPSAKICAgICAgICAgICAgICAgIGdl\ndEFkZEZvcmVpZ25LZXlTUUwoKEZvcmVpZ25LZXkpIGl0ZXIubmV4dCgpKTsK\nICAgICAgICAgICAgc3FsLmFkZEFsbChBcnJheXMuYXNMaXN0KGNvbnN0cmFp\nbnRTUUwpKTsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgcmV0dXJuIChT\ndHJpbmdbXSkgc3FsLnRvQXJyYXkobmV3IFN0cmluZ1tzcWwuc2l6ZSgpXSk7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBDcmVhdGUgYSBTRUxFQ1Qgc3RhdGVt\nZW50IGluIHRoZSBwcm9wZXIgam9pbiBzeW50YXggZm9yIHRoZSBnaXZlbgog\nICAgICogaW5zdGFuY2UuCiAgICAgKi8KICAgIHB1YmxpYyBTUUxCdWZmZXIg\ndG9TZWxlY3QoU2VsZWN0IHNlbCwgYm9vbGVhbiBmb3JVcGRhdGUsCiAgICAg\nICAgSkRCQ0ZldGNoQ29uZmlndXJhdGlvbiBmZXRjaCkgewogICAgICAgIHNl\nbC5hZGRKb2luQ2xhc3NDb25kaXRpb25zKCk7CiAgICAgICAgYm9vbGVhbiB1\ncGRhdGUgPSBmb3JVcGRhdGUgJiYgc2VsLmdldEZyb21TZWxlY3QoKSA9PSBu\ndWxsOwogICAgICAgIFNRTEJ1ZmZlciBzZWxlY3QgPSBnZXRTZWxlY3RzKHNl\nbCwgZmFsc2UsIHVwZGF0ZSk7CiAgICAgICAgU1FMQnVmZmVyIG9yZGVyaW5n\nID0gbnVsbDsKICAgICAgICBpZiAoIXNlbC5pc0FnZ3JlZ2F0ZSgpIHx8IHNl\nbC5nZXRHcm91cGluZygpICE9IG51bGwpCiAgICAgICAgICAgIG9yZGVyaW5n\nID0gc2VsLmdldE9yZGVyaW5nKCk7CiAgICAgICAgU1FMQnVmZmVyIGZyb207\nCiAgICAgICAgaWYgKHNlbC5nZXRGcm9tU2VsZWN0KCkgIT0gbnVsbCkKICAg\nICAgICAgICAgZnJvbSA9IGdldEZyb21TZWxlY3Qoc2VsLCBmb3JVcGRhdGUp\nOwogICAgICAgIGVsc2UKICAgICAgICAgICAgZnJvbSA9IGdldEZyb20oc2Vs\nLCB1cGRhdGUpOwogICAgICAgIFNRTEJ1ZmZlciB3aGVyZSA9IGdldFdoZXJl\nKHNlbCwgdXBkYXRlKTsKICAgICAgICByZXR1cm4gdG9TZWxlY3Qoc2VsZWN0\nLCBmZXRjaCwgZnJvbSwgd2hlcmUsIHNlbC5nZXRHcm91cGluZygpLAogICAg\nICAgICAgICBzZWwuZ2V0SGF2aW5nKCksIG9yZGVyaW5nLCBzZWwuaXNEaXN0\naW5jdCgpLCBmb3JVcGRhdGUsCiAgICAgICAgICAgIHNlbC5nZXRTdGFydElu\nZGV4KCksIHNlbC5nZXRFbmRJbmRleCgpLCBzZWwpOwogICAgfQoKICAgIC8q\nKgogICAgICogUmV0dXJuIHRoZSBwb3J0aW9uIG9mIHRoZSBzZWxlY3Qgc3Rh\ndGVtZW50IGJldHdlZW4gdGhlIEZST00ga2V5d29yZAogICAgICogYW5kIHRo\nZSBXSEVSRSBrZXl3b3JkLgogICAgICovCiAgICBwcm90ZWN0ZWQgU1FMQnVm\nZmVyIGdldEZyb20oU2VsZWN0IHNlbCwgYm9vbGVhbiBmb3JVcGRhdGUpIHsK\nICAgICAgICBTUUxCdWZmZXIgZnJvbVNRTCA9IG5ldyBTUUxCdWZmZXIodGhp\ncyk7CiAgICAgICAgQ29sbGVjdGlvbiBhbGlhc2VzID0gc2VsLmdldFRhYmxl\nQWxpYXNlcygpOwogICAgICAgIGlmIChhbGlhc2VzLnNpemUoKSA8IDIgfHwg\nc2VsLmdldEpvaW5TeW50YXgoKSAhPSBTWU5UQVhfU1FMOTIpIHsKICAgICAg\nICAgICAgZm9yIChJdGVyYXRvciBpdHIgPSBhbGlhc2VzLml0ZXJhdG9yKCk7\nIGl0ci5oYXNOZXh0KCk7KSB7CiAgICAgICAgICAgICAgICBmcm9tU1FMLmFw\ncGVuZChpdHIubmV4dCgpLnRvU3RyaW5nKCkpOwogICAgICAgICAgICAgICAg\naWYgKGZvclVwZGF0ZSAmJiB0YWJsZUZvclVwZGF0ZUNsYXVzZSAhPSBudWxs\nKQogICAgICAgICAgICAgICAgICAgIGZyb21TUUwuYXBwZW5kKCIgIikuYXBw\nZW5kKHRhYmxlRm9yVXBkYXRlQ2xhdXNlKTsKICAgICAgICAgICAgICAgIGlm\nIChpdHIuaGFzTmV4dCgpKQogICAgICAgICAgICAgICAgICAgIGZyb21TUUwu\nYXBwZW5kKCIsICIpOwogICAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsK\nICAgICAgICAgICAgSXRlcmF0b3IgaXRyID0gc2VsLmdldEpvaW5JdGVyYXRv\ncigpOwogICAgICAgICAgICBib29sZWFuIGZpcnN0ID0gdHJ1ZTsKICAgICAg\nICAgICAgd2hpbGUgKGl0ci5oYXNOZXh0KCkpIHsKICAgICAgICAgICAgICAg\nIGZyb21TUUwuYXBwZW5kKHRvU1FMOTJKb2luKChKb2luKSBpdHIubmV4dCgp\nLCBmb3JVcGRhdGUsCiAgICAgICAgICAgICAgICAgICAgZmlyc3QpKTsKICAg\nICAgICAgICAgICAgIGZpcnN0ID0gZmFsc2U7CiAgICAgICAgICAgIH0KICAg\nICAgICB9CiAgICAgICAgcmV0dXJuIGZyb21TUUw7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBSZXR1cm4gdGhlIEZST00gY2xhdXNlIGZvciBhIHNlbGVjdCB0\naGF0IHNlbGVjdHMgZnJvbSBhIHRtcCB0YWJsZQogICAgICogY3JlYXRlZCBi\neSBhbiBpbm5lciBzZWxlY3QuCiAgICAgKi8KICAgIHByb3RlY3RlZCBTUUxC\ndWZmZXIgZ2V0RnJvbVNlbGVjdChTZWxlY3Qgc2VsLCBib29sZWFuIGZvclVw\nZGF0ZSkgewogICAgICAgIFNRTEJ1ZmZlciBmcm9tU1FMID0gbmV3IFNRTEJ1\nZmZlcih0aGlzKTsKICAgICAgICBmcm9tU1FMLmFwcGVuZCgiKCIpOwogICAg\nICAgIGZyb21TUUwuYXBwZW5kKHRvU2VsZWN0KHNlbC5nZXRGcm9tU2VsZWN0\nKCksIGZvclVwZGF0ZSwgbnVsbCkpOwogICAgICAgIGZyb21TUUwuYXBwZW5k\nKCIpIik7CiAgICAgICAgaWYgKHJlcXVpcmVzQWxpYXNGb3JTdWJzZWxlY3Qp\nCiAgICAgICAgICAgIGZyb21TUUwuYXBwZW5kKCIgIikuYXBwZW5kKFNlbGVj\ndC5GUk9NX1NFTEVDVF9BTElBUyk7CiAgICAgICAgcmV0dXJuIGZyb21TUUw7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIFdIRVJFIHBvcnRp\nb24gb2YgdGhlIHNlbGVjdCBzdGF0ZW1lbnQsIG9yIG51bGwgaWYgbm8gd2hl\ncmUKICAgICAqIGNvbmRpdGlvbnMuCiAgICAgKi8KICAgIHByb3RlY3RlZCBT\nUUxCdWZmZXIgZ2V0V2hlcmUoU2VsZWN0IHNlbCwgYm9vbGVhbiBmb3JVcGRh\ndGUpIHsKICAgICAgICBKb2lucyBqb2lucyA9IHNlbC5nZXRKb2lucygpOwog\nICAgICAgIGlmIChzZWwuZ2V0Sm9pblN5bnRheCgpID09IFNZTlRBWF9TUUw5\nMgogICAgICAgICAgICB8fCBqb2lucyA9PSBudWxsIHx8IGpvaW5zLmlzRW1w\ndHkoKSkKICAgICAgICAgICAgcmV0dXJuIHNlbC5nZXRXaGVyZSgpOwoKICAg\nICAgICBTUUxCdWZmZXIgd2hlcmUgPSBuZXcgU1FMQnVmZmVyKHRoaXMpOwog\nICAgICAgIGlmIChzZWwuZ2V0V2hlcmUoKSAhPSBudWxsKQogICAgICAgICAg\nICB3aGVyZS5hcHBlbmQoc2VsLmdldFdoZXJlKCkpOwogICAgICAgIGlmIChq\nb2lucyAhPSBudWxsKQogICAgICAgICAgICBzZWwuYXBwZW5kKHdoZXJlLCBq\nb2lucyk7CiAgICAgICAgcmV0dXJuIHdoZXJlOwogICAgfQoKICAgIC8qKgog\nICAgICogVXNlIHRoZSBnaXZlbiBqb2luIGluc3RhbmNlIHRvIGNyZWF0ZSBT\nUUwgam9pbmluZyBpdHMgdGFibGVzIGluCiAgICAgKiB0aGUgdHJhZGl0aW9u\nYWwgc3R5bGUuCiAgICAgKi8KICAgIHB1YmxpYyBTUUxCdWZmZXIgdG9UcmFk\naXRpb25hbEpvaW4oSm9pbiBqb2luKSB7CiAgICAgICAgRm9yZWlnbktleSBm\nayA9IGpvaW4uZ2V0Rm9yZWlnbktleSgpOwogICAgICAgIGlmIChmayA9PSBu\ndWxsKQogICAgICAgICAgICByZXR1cm4gbnVsbDsKCiAgICAgICAgYm9vbGVh\nbiBpbnZlcnNlID0gam9pbi5pc0ZvcmVpZ25LZXlJbnZlcnNlZCgpOwogICAg\nICAgIENvbHVtbltdIGZyb20gPSAoaW52ZXJzZSkgPyBmay5nZXRQcmltYXJ5\nS2V5Q29sdW1ucygpCiAgICAgICAgICAgIDogZmsuZ2V0Q29sdW1ucygpOwog\nICAgICAgIENvbHVtbltdIHRvID0gKGludmVyc2UpID8gZmsuZ2V0Q29sdW1u\ncygpCiAgICAgICAgICAgIDogZmsuZ2V0UHJpbWFyeUtleUNvbHVtbnMoKTsK\nCiAgICAgICAgLy8gZG8gY29sdW1uIGpvaW5zCiAgICAgICAgU1FMQnVmZmVy\nIGJ1ZiA9IG5ldyBTUUxCdWZmZXIodGhpcyk7CiAgICAgICAgaW50IGNvdW50\nID0gMDsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGZyb20ubGVuZ3Ro\nOyBpKyssIGNvdW50KyspIHsKICAgICAgICAgICAgaWYgKGNvdW50ID4gMCkK\nICAgICAgICAgICAgICAgIGJ1Zi5hcHBlbmQoIiBBTkQgIik7CiAgICAgICAg\nICAgIGJ1Zi5hcHBlbmQoam9pbi5nZXRBbGlhczEoKSkuYXBwZW5kKCIuIiku\nYXBwZW5kKGZyb21baV0pOwogICAgICAgICAgICBidWYuYXBwZW5kKCIgPSAi\nKTsKICAgICAgICAgICAgYnVmLmFwcGVuZChqb2luLmdldEFsaWFzMigpKS5h\ncHBlbmQoIi4iKS5hcHBlbmQodG9baV0pOwogICAgICAgIH0KCiAgICAgICAg\nLy8gZG8gY29uc3RhbnQgam9pbnMKICAgICAgICBDb2x1bW5bXSBjb25zdENv\nbHMgPSBmay5nZXRDb25zdGFudENvbHVtbnMoKTsKICAgICAgICBmb3IgKGlu\ndCBpID0gMDsgaSA8IGNvbnN0Q29scy5sZW5ndGg7IGkrKywgY291bnQrKykg\newogICAgICAgICAgICBpZiAoY291bnQgPiAwKQogICAgICAgICAgICAgICAg\nYnVmLmFwcGVuZCgiIEFORCAiKTsKICAgICAgICAgICAgaWYgKGludmVyc2Up\nCiAgICAgICAgICAgICAgICBidWYuYXBwZW5kVmFsdWUoZmsuZ2V0Q29uc3Rh\nbnQoY29uc3RDb2xzW2ldKSwgY29uc3RDb2xzW2ldKTsKICAgICAgICAgICAg\nZWxzZQogICAgICAgICAgICAgICAgYnVmLmFwcGVuZChqb2luLmdldEFsaWFz\nMSgpKS5hcHBlbmQoIi4iKS4KICAgICAgICAgICAgICAgICAgICBhcHBlbmQo\nY29uc3RDb2xzW2ldKTsKICAgICAgICAgICAgYnVmLmFwcGVuZCgiID0gIik7\nCgogICAgICAgICAgICBpZiAoaW52ZXJzZSkKICAgICAgICAgICAgICAgIGJ1\nZi5hcHBlbmQoam9pbi5nZXRBbGlhczIoKSkuYXBwZW5kKCIuIikuCiAgICAg\nICAgICAgICAgICAgICAgYXBwZW5kKGNvbnN0Q29sc1tpXSk7CiAgICAgICAg\nICAgIGVsc2UKICAgICAgICAgICAgICAgIGJ1Zi5hcHBlbmRWYWx1ZShmay5n\nZXRDb25zdGFudChjb25zdENvbHNbaV0pLCBjb25zdENvbHNbaV0pOwogICAg\nICAgIH0KCiAgICAgICAgQ29sdW1uW10gY29uc3RDb2xzUEsgPSBmay5nZXRD\nb25zdGFudFByaW1hcnlLZXlDb2x1bW5zKCk7CiAgICAgICAgZm9yIChpbnQg\naSA9IDA7IGkgPCBjb25zdENvbHNQSy5sZW5ndGg7IGkrKywgY291bnQrKykg\newogICAgICAgICAgICBpZiAoY291bnQgPiAwKQogICAgICAgICAgICAgICAg\nYnVmLmFwcGVuZCgiIEFORCAiKTsKICAgICAgICAgICAgaWYgKGludmVyc2Up\nCiAgICAgICAgICAgICAgICBidWYuYXBwZW5kKGpvaW4uZ2V0QWxpYXMxKCkp\nLmFwcGVuZCgiLiIpLgogICAgICAgICAgICAgICAgICAgIGFwcGVuZChjb25z\ndENvbHNQS1tpXSk7CiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAg\nIGJ1Zi5hcHBlbmRWYWx1ZShmay5nZXRQcmltYXJ5S2V5Q29uc3RhbnQoY29u\nc3RDb2xzUEtbaV0pLAogICAgICAgICAgICAgICAgICAgIGNvbnN0Q29sc1BL\nW2ldKTsKICAgICAgICAgICAgYnVmLmFwcGVuZCgiID0gIik7CgogICAgICAg\nICAgICBpZiAoaW52ZXJzZSkKICAgICAgICAgICAgICAgIGJ1Zi5hcHBlbmRW\nYWx1ZShmay5nZXRQcmltYXJ5S2V5Q29uc3RhbnQoY29uc3RDb2xzUEtbaV0p\nLAogICAgICAgICAgICAgICAgICAgIGNvbnN0Q29sc1BLW2ldKTsKICAgICAg\nICAgICAgZWxzZQogICAgICAgICAgICAgICAgYnVmLmFwcGVuZChqb2luLmdl\ndEFsaWFzMigpKS5hcHBlbmQoIi4iKS4KICAgICAgICAgICAgICAgICAgICBh\ncHBlbmQoY29uc3RDb2xzUEtbaV0pOwogICAgICAgIH0KICAgICAgICByZXR1\ncm4gYnVmOwogICAgfQoKICAgIC8qKgogICAgICogVXNlIHRoZSBnaXZlbiBq\nb2luIGluc3RhbmNlIHRvIGNyZWF0ZSBTUUwgam9pbmluZyBpdHMgdGFibGVz\nIGluCiAgICAgKiB0aGUgU1FMOTIgc3R5bGUuCiAgICAgKi8KICAgIHB1Ymxp\nYyBTUUxCdWZmZXIgdG9TUUw5MkpvaW4oSm9pbiBqb2luLCBib29sZWFuIGZv\nclVwZGF0ZSwgYm9vbGVhbiBmaXJzdCkgewogICAgICAgIFNRTEJ1ZmZlciBi\ndWYgPSBuZXcgU1FMQnVmZmVyKHRoaXMpOwogICAgICAgIGlmIChmaXJzdCkg\newogICAgICAgICAgICBidWYuYXBwZW5kKGpvaW4uZ2V0VGFibGUxKCkpLmFw\ncGVuZCgiICIpLgogICAgICAgICAgICAgICAgYXBwZW5kKGpvaW4uZ2V0QWxp\nYXMxKCkpOwogICAgICAgICAgICBpZiAoZm9yVXBkYXRlICYmIHRhYmxlRm9y\nVXBkYXRlQ2xhdXNlICE9IG51bGwpCiAgICAgICAgICAgICAgICBidWYuYXBw\nZW5kKCIgIikuYXBwZW5kKHRhYmxlRm9yVXBkYXRlQ2xhdXNlKTsKICAgICAg\nICB9CgogICAgICAgIGJ1Zi5hcHBlbmQoIiAiKTsKICAgICAgICBpZiAoam9p\nbi5nZXRUeXBlKCkgPT0gSm9pbi5UWVBFX09VVEVSKQogICAgICAgICAgICBi\ndWYuYXBwZW5kKG91dGVySm9pbkNsYXVzZSk7CiAgICAgICAgZWxzZSBpZiAo\nam9pbi5nZXRUeXBlKCkgPT0gSm9pbi5UWVBFX0lOTkVSKQogICAgICAgICAg\nICBidWYuYXBwZW5kKGlubmVySm9pbkNsYXVzZSk7CiAgICAgICAgZWxzZSAv\nLyBjcm9zcwogICAgICAgICAgICBidWYuYXBwZW5kKGNyb3NzSm9pbkNsYXVz\nZSk7CiAgICAgICAgYnVmLmFwcGVuZCgiICIpOwoKICAgICAgICBidWYuYXBw\nZW5kKGpvaW4uZ2V0VGFibGUyKCkpLmFwcGVuZCgiICIpLmFwcGVuZChqb2lu\nLmdldEFsaWFzMigpKTsKICAgICAgICBpZiAoZm9yVXBkYXRlICYmIHRhYmxl\nRm9yVXBkYXRlQ2xhdXNlICE9IG51bGwpCiAgICAgICAgICAgIGJ1Zi5hcHBl\nbmQoIiAiKS5hcHBlbmQodGFibGVGb3JVcGRhdGVDbGF1c2UpOwoKICAgICAg\nICBpZiAoam9pbi5nZXRGb3JlaWduS2V5KCkgIT0gbnVsbCkKICAgICAgICAg\nICAgYnVmLmFwcGVuZCgiIE9OICIpLmFwcGVuZCh0b1RyYWRpdGlvbmFsSm9p\nbihqb2luKSk7CiAgICAgICAgZWxzZSBpZiAocmVxdWlyZXNDb25kaXRpb25G\nb3JDcm9zc0pvaW4gJiYKICAgICAgICAgICAgam9pbi5nZXRUeXBlKCkgPT0g\nSm9pbi5UWVBFX0NST1NTKQogICAgICAgICAgICBidWYuYXBwZW5kKCIgT04g\nKDEgPSAxKSIpOwoKICAgICAgICByZXR1cm4gYnVmOwogICAgfQoKICAgIC8q\nKgogICAgICogVXNlIHRoZSBnaXZlbiBqb2luIGluc3RhbmNlIHRvIGNyZWF0\nZSBTUUwgam9pbmluZyBpdHMgdGFibGVzIGluCiAgICAgKiB0aGUgZGF0YWJh\nc2UncyBuYXRpdmUgc3ludGF4LiBUaHJvd3MgYW4gZXhjZXB0aW9uIGJ5IGRl\nZmF1bHQuCiAgICAgKi8KICAgIHB1YmxpYyBTUUxCdWZmZXIgdG9OYXRpdmVK\nb2luKEpvaW4gam9pbikgewogICAgICAgIHRocm93IG5ldyBVbnN1cHBvcnRl\nZEV4Y2VwdGlvbigpOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJucyBp\nZiB0aGUgZ2l2ZW4gZm9yZWlnbiBrZXkgY2FuIGJlIGVhZ2VybHkgbG9hZGVk\nIHVzaW5nIG90aGVyIGpvaW5zLgogICAgICovCiAgICBwdWJsaWMgYm9vbGVh\nbiBjYW5PdXRlckpvaW4oaW50IHN5bnRheCwgRm9yZWlnbktleSBmaykgewog\nICAgICAgIHJldHVybiBzeW50YXggIT0gU1lOVEFYX1RSQURJVElPTkFMOwog\nICAgfQoKICAgIC8qKgogICAgICogQ29tYmluZSB0aGUgZ2l2ZW4gY29tcG9u\nZW50cyBpbnRvIGEgU0VMRUNUIHN0YXRlbWVudC4KICAgICAqLwogICAgcHVi\nbGljIFNRTEJ1ZmZlciB0b1NlbGVjdChTUUxCdWZmZXIgc2VsZWN0cywgSkRC\nQ0ZldGNoQ29uZmlndXJhdGlvbiBmZXRjaCwKICAgICAgICBTUUxCdWZmZXIg\nZnJvbSwgU1FMQnVmZmVyIHdoZXJlLCBTUUxCdWZmZXIgZ3JvdXAsCiAgICAg\nICAgU1FMQnVmZmVyIGhhdmluZywgU1FMQnVmZmVyIG9yZGVyLAogICAgICAg\nIGJvb2xlYW4gZGlzdGluY3QsIGJvb2xlYW4gZm9yVXBkYXRlLCBsb25nIHN0\nYXJ0LCBsb25nIGVuZCkgewogICAgICAgIHJldHVybiB0b09wZXJhdGlvbihn\nZXRTZWxlY3RPcGVyYXRpb24oZmV0Y2gpLCBzZWxlY3RzLCBmcm9tLCB3aGVy\nZSwKICAgICAgICAgICAgZ3JvdXAsIGhhdmluZywgb3JkZXIsIGRpc3RpbmN0\nLCBzdGFydCwgZW5kLAogICAgICAgICAgICBnZXRGb3JVcGRhdGVDbGF1c2Uo\nZmV0Y2gsIGZvclVwZGF0ZSwgbnVsbCkpOwogICAgfQoKICAgIC8qKgogICAg\nICogQ29tYmluZSB0aGUgZ2l2ZW4gY29tcG9uZW50cyBpbnRvIGEgU0VMRUNU\nIHN0YXRlbWVudC4KICAgICAqLwogICAgcHVibGljIFNRTEJ1ZmZlciB0b1Nl\nbGVjdChTUUxCdWZmZXIgc2VsZWN0cywgSkRCQ0ZldGNoQ29uZmlndXJhdGlv\nbiBmZXRjaCwKICAgICAgICBTUUxCdWZmZXIgZnJvbSwgU1FMQnVmZmVyIHdo\nZXJlLCBTUUxCdWZmZXIgZ3JvdXAsCiAgICAgICAgU1FMQnVmZmVyIGhhdmlu\nZywgU1FMQnVmZmVyIG9yZGVyLAogICAgICAgIGJvb2xlYW4gZGlzdGluY3Qs\nIGJvb2xlYW4gZm9yVXBkYXRlLCBsb25nIHN0YXJ0LCBsb25nIGVuZCwKICAg\nICAgICBib29sZWFuIHN1YnNlbGVjdCkgewogICAgICAgIHJldHVybiB0b09w\nZXJhdGlvbihnZXRTZWxlY3RPcGVyYXRpb24oZmV0Y2gpLCBzZWxlY3RzLCBm\ncm9tLCB3aGVyZSwKICAgICAgICAgICAgZ3JvdXAsIGhhdmluZywgb3JkZXIs\nIGRpc3RpbmN0LCBzdGFydCwgZW5kLAogICAgICAgICAgICBnZXRGb3JVcGRh\ndGVDbGF1c2UoZmV0Y2gsIGZvclVwZGF0ZSwgbnVsbCksIHN1YnNlbGVjdCk7\nCiAgICB9CiAgICAKICAgIHB1YmxpYyBTUUxCdWZmZXIgdG9TZWxlY3QoU1FM\nQnVmZmVyIHNlbGVjdHMsIEpEQkNGZXRjaENvbmZpZ3VyYXRpb24gZmV0Y2gs\nCiAgICAgICAgICAgIFNRTEJ1ZmZlciBmcm9tLCBTUUxCdWZmZXIgd2hlcmUs\nIFNRTEJ1ZmZlciBncm91cCwKICAgICAgICAgICAgU1FMQnVmZmVyIGhhdmlu\nZywgU1FMQnVmZmVyIG9yZGVyLAogICAgICAgICAgICBib29sZWFuIGRpc3Rp\nbmN0LCBib29sZWFuIGZvclVwZGF0ZSwgbG9uZyBzdGFydCwgbG9uZyBlbmQs\nCiAgICAgICAgICAgIGJvb2xlYW4gc3Vic2VsZWN0LCBib29sZWFuIGNoZWNr\nVGFibGVGb3JVcGRhdGUpIHsKICAgICAgICAgICAgcmV0dXJuIHRvT3BlcmF0\naW9uKGdldFNlbGVjdE9wZXJhdGlvbihmZXRjaCksIHNlbGVjdHMsIGZyb20s\nIHdoZXJlLAogICAgICAgICAgICAgICAgZ3JvdXAsIGhhdmluZywgb3JkZXIs\nIGRpc3RpbmN0LCBzdGFydCwgZW5kLAogICAgICAgICAgICAgICAgZ2V0Rm9y\nVXBkYXRlQ2xhdXNlKGZldGNoLCBmb3JVcGRhdGUsIG51bGwpLCBzdWJzZWxl\nY3QsIGNoZWNrVGFibGVGb3JVcGRhdGUpOwogICAgICAgIH0KCiAgICAvKioK\nICAgICAqIENvbWJpbmUgdGhlIGdpdmVuIGNvbXBvbmVudHMgaW50byBhIFNF\nTEVDVCBzdGF0ZW1lbnQuCiAgICAgKi8KICAgIHB1YmxpYyBTUUxCdWZmZXIg\ndG9TZWxlY3QoU1FMQnVmZmVyIHNlbGVjdHMsIEpEQkNGZXRjaENvbmZpZ3Vy\nYXRpb24gZmV0Y2gsCiAgICAgICAgU1FMQnVmZmVyIGZyb20sIFNRTEJ1ZmZl\nciB3aGVyZSwgU1FMQnVmZmVyIGdyb3VwLAogICAgICAgIFNRTEJ1ZmZlciBo\nYXZpbmcsIFNRTEJ1ZmZlciBvcmRlciwKICAgICAgICBib29sZWFuIGRpc3Rp\nbmN0LCBib29sZWFuIGZvclVwZGF0ZSwgbG9uZyBzdGFydCwgbG9uZyBlbmQs\nCiAgICAgICAgU2VsZWN0IHNlbCkgewogICAgICAgIHJldHVybiB0b09wZXJh\ndGlvbihnZXRTZWxlY3RPcGVyYXRpb24oZmV0Y2gpLCBzZWxlY3RzLCBmcm9t\nLCB3aGVyZSwKICAgICAgICAgICAgZ3JvdXAsIGhhdmluZywgb3JkZXIsIGRp\nc3RpbmN0LCBzdGFydCwgZW5kLAogICAgICAgICAgICBnZXRGb3JVcGRhdGVD\nbGF1c2UoZmV0Y2gsIGZvclVwZGF0ZSwgc2VsKSk7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBHZXQgdGhlIHVwZGF0ZSBjbGF1c2UgZm9yIHRoZSBxdWVyeSBi\nYXNlZCBvbiB0aGUKICAgICAqIHVwZGF0ZUNsYXVzZSBhbmQgaXNvbGF0aW9u\nTGV2ZWwgaGludHMKICAgICAqLwogICAgcHJvdGVjdGVkIFN0cmluZyBnZXRG\nb3JVcGRhdGVDbGF1c2UoSkRCQ0ZldGNoQ29uZmlndXJhdGlvbiBmZXRjaCwK\nICAgICAgICBib29sZWFuIGlzRm9yVXBkYXRlLCBTZWxlY3Qgc2VsKSB7CiAg\nICAgICAgaWYgKGZldGNoICE9IG51bGwgJiYgZmV0Y2guZ2V0SXNvbGF0aW9u\nKCkgIT0gLTEpIHsKICAgICAgICAgICAgdGhyb3cgbmV3IEludmFsaWRTdGF0\nZUV4Y2VwdGlvbihfbG9jLmdldCgKICAgICAgICAgICAgICAgICJpc29sYXRp\nb24tbGV2ZWwtY29uZmlnLW5vdC1zdXBwb3J0ZWQiLCBnZXRDbGFzcygpLmdl\ndE5hbWUoKSkpOwogICAgICAgIH0gZWxzZSBpZiAoaXNGb3JVcGRhdGUgJiYg\nIXNpbXVsYXRlTG9ja2luZykgewogICAgICAgICAgICBhc3NlcnRTdXBwb3J0\nKHN1cHBvcnRzU2VsZWN0Rm9yVXBkYXRlLCAiU3VwcG9ydHNTZWxlY3RGb3JV\ncGRhdGUiKTsKICAgICAgICAgICAgcmV0dXJuIGZvclVwZGF0ZUNsYXVzZTsK\nICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXR1cm4gbnVsbDsKICAg\nICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlICJTRUxF\nQ1QiIG9wZXJhdGlvbiBjbGF1c2UsIGFkZGluZyBhbnkgYXZhaWxhYmxlIGhp\nbnRzLCBldGMuCiAgICAgKi8KICAgIHB1YmxpYyBTdHJpbmcgZ2V0U2VsZWN0\nT3BlcmF0aW9uKEpEQkNGZXRjaENvbmZpZ3VyYXRpb24gZmV0Y2gpIHsKICAg\nICAgICByZXR1cm4gIlNFTEVDVCI7CiAgICB9CgogICAgLyoqCiAgICAgKiBS\nZXR1cm4gdGhlIFNRTCBmb3IgdGhlIGdpdmVuIHNlbGVjdGluZyBvcGVyYXRp\nb24uCiAgICAgKi8KICAgIHB1YmxpYyBTUUxCdWZmZXIgdG9PcGVyYXRpb24o\nU3RyaW5nIG9wLCBTUUxCdWZmZXIgc2VsZWN0cywKICAgICAgICBTUUxCdWZm\nZXIgZnJvbSwgU1FMQnVmZmVyIHdoZXJlLCBTUUxCdWZmZXIgZ3JvdXAsIFNR\nTEJ1ZmZlciBoYXZpbmcsCiAgICAgICAgU1FMQnVmZmVyIG9yZGVyLCBib29s\nZWFuIGRpc3RpbmN0LCBsb25nIHN0YXJ0LCBsb25nIGVuZCwKICAgICAgICBT\ndHJpbmcgZm9yVXBkYXRlQ2xhdXNlKSB7CiAgICAgICAgcmV0dXJuIHRvT3Bl\ncmF0aW9uKG9wLCBzZWxlY3RzLCBmcm9tLCB3aGVyZSwgZ3JvdXAsIGhhdmlu\nZywgb3JkZXIsCiAgICAgICAgICAgIGRpc3RpbmN0LCBzdGFydCwgZW5kLCBm\nb3JVcGRhdGVDbGF1c2UsIGZhbHNlKTsKICAgIH0KICAgIAogICAgLyoqCiAg\nICAgKiBSZXR1cm4gdGhlIFNRTCBmb3IgdGhlIGdpdmVuIHNlbGVjdGluZyBv\ncGVyYXRpb24uCiAgICAgKi8KICAgIHB1YmxpYyBTUUxCdWZmZXIgdG9PcGVy\nYXRpb24oU3RyaW5nIG9wLCBTUUxCdWZmZXIgc2VsZWN0cywKICAgICAgICBT\nUUxCdWZmZXIgZnJvbSwgU1FMQnVmZmVyIHdoZXJlLCBTUUxCdWZmZXIgZ3Jv\ndXAsIFNRTEJ1ZmZlciBoYXZpbmcsCiAgICAgICAgU1FMQnVmZmVyIG9yZGVy\nLCBib29sZWFuIGRpc3RpbmN0LCBsb25nIHN0YXJ0LCBsb25nIGVuZCwKICAg\nICAgICBTdHJpbmcgZm9yVXBkYXRlQ2xhdXNlLCBib29sZWFuIHN1YnNlbGVj\ndCkgewogICAgICAgIHJldHVybiB0b09wZXJhdGlvbihvcCwgc2VsZWN0cywg\nZnJvbSwgd2hlcmUsIGdyb3VwLCBoYXZpbmcsIG9yZGVyLAogICAgICAgICAg\nICAgICAgZGlzdGluY3QsIHN0YXJ0LCBlbmQsIGZvclVwZGF0ZUNsYXVzZSwg\nc3Vic2VsZWN0LCBmYWxzZSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1\ncm4gdGhlIFNRTCBmb3IgdGhlIGdpdmVuIHNlbGVjdGluZyBvcGVyYXRpb24u\nCiAgICAgKi8KICAgIHByaXZhdGUgU1FMQnVmZmVyIHRvT3BlcmF0aW9uKFN0\ncmluZyBvcCwgU1FMQnVmZmVyIHNlbGVjdHMsCiAgICAgICAgU1FMQnVmZmVy\nIGZyb20sIFNRTEJ1ZmZlciB3aGVyZSwgU1FMQnVmZmVyIGdyb3VwLCBTUUxC\ndWZmZXIgaGF2aW5nLAogICAgICAgIFNRTEJ1ZmZlciBvcmRlciwgYm9vbGVh\nbiBkaXN0aW5jdCwgbG9uZyBzdGFydCwgbG9uZyBlbmQsCiAgICAgICAgU3Ry\naW5nIGZvclVwZGF0ZUNsYXVzZSwgYm9vbGVhbiBzdWJzZWxlY3QsIGJvb2xl\nYW4gY2hlY2tUYWJsZUZvclVwZGF0ZSkgewogICAgICAgIFNRTEJ1ZmZlciBi\ndWYgPSBuZXcgU1FMQnVmZmVyKHRoaXMpOwogICAgICAgIGJ1Zi5hcHBlbmQo\nb3ApOwoKICAgICAgICBib29sZWFuIHJhbmdlID0gc3RhcnQgIT0gMCB8fCBl\nbmQgIT0gTG9uZy5NQVhfVkFMVUU7CiAgICAgICAgaWYgKHJhbmdlICYmIHJh\nbmdlUG9zaXRpb24gPT0gUkFOR0VfUFJFX0RJU1RJTkNUKQogICAgICAgICAg\nICBhcHBlbmRTZWxlY3RSYW5nZShidWYsIHN0YXJ0LCBlbmQsIHN1YnNlbGVj\ndCk7CiAgICAgICAgaWYgKGRpc3RpbmN0KQogICAgICAgICAgICBidWYuYXBw\nZW5kKCIgRElTVElOQ1QiKTsKICAgICAgICBpZiAocmFuZ2UgJiYgcmFuZ2VQ\nb3NpdGlvbiA9PSBSQU5HRV9QT1NUX0RJU1RJTkNUKQogICAgICAgICAgICBh\ncHBlbmRTZWxlY3RSYW5nZShidWYsIHN0YXJ0LCBlbmQsIHN1YnNlbGVjdCk7\nCgogICAgICAgIGJ1Zi5hcHBlbmQoIiAiKS5hcHBlbmQoc2VsZWN0cykuYXBw\nZW5kKCIgRlJPTSAiKS5hcHBlbmQoZnJvbSk7CgogICAgICAgIGlmIChjaGVj\na1RhYmxlRm9yVXBkYXRlCiAgICAgICAgICAgICAgICAmJiAoU3RyaW5nVXRp\nbHMuaXNFbXB0eShmb3JVcGRhdGVDbGF1c2UpICYmICFTdHJpbmdVdGlscwog\nICAgICAgICAgICAgICAgICAgICAgICAuaXNFbXB0eSh0YWJsZUZvclVwZGF0\nZUNsYXVzZSkpKSB7CiAgICAgICAgICAgIGJ1Zi5hcHBlbmQoIiAiKS5hcHBl\nbmQodGFibGVGb3JVcGRhdGVDbGF1c2UpOwogICAgICAgIH0KCiAgICAgICAg\naWYgKHdoZXJlICE9IG51bGwgJiYgIXdoZXJlLmlzRW1wdHkoKSkKICAgICAg\nICAgICAgYnVmLmFwcGVuZCgiIFdIRVJFICIpLmFwcGVuZCh3aGVyZSk7CiAg\nICAgICAgaWYgKGdyb3VwICE9IG51bGwgJiYgIWdyb3VwLmlzRW1wdHkoKSkK\nICAgICAgICAgICAgYnVmLmFwcGVuZCgiIEdST1VQIEJZICIpLmFwcGVuZChn\ncm91cCk7CiAgICAgICAgaWYgKGhhdmluZyAhPSBudWxsICYmICFoYXZpbmcu\naXNFbXB0eSgpKSB7CiAgICAgICAgICAgIGFzc2VydFN1cHBvcnQoc3VwcG9y\ndHNIYXZpbmcsICJTdXBwb3J0c0hhdmluZyIpOwogICAgICAgICAgICBidWYu\nYXBwZW5kKCIgSEFWSU5HICIpLmFwcGVuZChoYXZpbmcpOwogICAgICAgIH0K\nICAgICAgICBpZiAob3JkZXIgIT0gbnVsbCAmJiAhb3JkZXIuaXNFbXB0eSgp\nKQogICAgICAgICAgICBidWYuYXBwZW5kKCIgT1JERVIgQlkgIikuYXBwZW5k\nKG9yZGVyKTsKICAgICAgICBpZiAocmFuZ2UgJiYgcmFuZ2VQb3NpdGlvbiA9\nPSBSQU5HRV9QT1NUX1NFTEVDVCkKICAgICAgICAgICAgYXBwZW5kU2VsZWN0\nUmFuZ2UoYnVmLCBzdGFydCwgZW5kLCBzdWJzZWxlY3QpOwogICAgICAgIGlm\nIChmb3JVcGRhdGVDbGF1c2UgIT0gbnVsbCkKICAgICAgICAgICAgYnVmLmFw\ncGVuZCgiICIpLmFwcGVuZChmb3JVcGRhdGVDbGF1c2UpOwogICAgICAgIGlm\nIChyYW5nZSAmJiByYW5nZVBvc2l0aW9uID09IFJBTkdFX1BPU1RfTE9DSykK\nICAgICAgICAgICAgYXBwZW5kU2VsZWN0UmFuZ2UoYnVmLCBzdGFydCwgZW5k\nLCBzdWJzZWxlY3QpOwogICAgICAgIHJldHVybiBidWY7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBJZiB0aGlzIGRpY3Rpb25hcnkgY2FuIHNlbGVjdCByYW5n\nZXMsCiAgICAgKiB1c2UgdGhpcyBtZXRob2QgdG8gYXBwZW5kIHRoZSByYW5n\nZSBTUUwuCiAgICAgKi8KICAgIHByb3RlY3RlZCB2b2lkIGFwcGVuZFNlbGVj\ndFJhbmdlKFNRTEJ1ZmZlciBidWYsIGxvbmcgc3RhcnQsIGxvbmcgZW5kLAog\nICAgICAgIGJvb2xlYW4gc3Vic2VsZWN0KSB7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBSZXR1cm4gdGhlIHBvcnRpb24gb2YgdGhlIHNlbGVjdCBzdGF0ZW1l\nbnQgYmV0d2VlbiB0aGUgU0VMRUNUIGtleXdvcmQKICAgICAqIGFuZCB0aGUg\nRlJPTSBrZXl3b3JkLgogICAgICovCiAgICBwcm90ZWN0ZWQgU1FMQnVmZmVy\nIGdldFNlbGVjdHMoU2VsZWN0IHNlbCwgYm9vbGVhbiBkaXN0aW5jdElkZW50\naWZpZXJzLAogICAgICAgIGJvb2xlYW4gZm9yVXBkYXRlKSB7CiAgICAgICAg\nLy8gYXBwZW5kIHRoZSBhbGlhc2VzIGZvciBhbGwgdGhlIGNvbHVtbnMKICAg\nICAgICBTUUxCdWZmZXIgc2VsZWN0U1FMID0gbmV3IFNRTEJ1ZmZlcih0aGlz\nKTsKICAgICAgICBMaXN0IGFsaWFzZXM7CiAgICAgICAgaWYgKGRpc3RpbmN0\nSWRlbnRpZmllcnMpCiAgICAgICAgICAgIGFsaWFzZXMgPSBzZWwuZ2V0SWRl\nbnRpZmllckFsaWFzZXMoKTsKICAgICAgICBlbHNlCiAgICAgICAgICAgIGFs\naWFzZXMgPSBzZWwuZ2V0U2VsZWN0QWxpYXNlcygpOwoKICAgICAgICBPYmpl\nY3QgYWxpYXM7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBhbGlhc2Vz\nLnNpemUoKTsgaSsrKSB7CiAgICAgICAgICAgIGFsaWFzID0gYWxpYXNlcy5n\nZXQoaSk7CiAgICAgICAgICAgIGFwcGVuZFNlbGVjdChzZWxlY3RTUUwsIGFs\naWFzLCBzZWwsIGkpOwogICAgICAgICAgICBpZiAoaSA8IGFsaWFzZXMuc2l6\nZSgpIC0gMSkKICAgICAgICAgICAgICAgIHNlbGVjdFNRTC5hcHBlbmQoIiwg\nIik7CiAgICAgICAgfQogICAgICAgIHJldHVybiBzZWxlY3RTUUw7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBBcHBlbmQgPGNvZGU+ZWxlbTwvY29kZT4gdG8g\nPGNvZGU+c2VsZWN0U1FMPC9jb2RlPi4KICAgICAqIEBwYXJhbSBzZWxlY3RT\nUUwgVGhlIFNRTEJ1ZmZlciB0byBhcHBlbmQgdG8uCiAgICAgKiBAcGFyYW0g\nYWxpYXMgQSB7QGxpbmsgU1FMQnVmZmVyfSBvciBhIHtAbGluayBTdHJpbmd9\nIHRvIGFwcGVuZC4KICAgICAqCiAgICAgKiBAc2luY2UgMS4xLjAKICAgICAq\nLwogICAgcHJvdGVjdGVkIHZvaWQgYXBwZW5kU2VsZWN0KFNRTEJ1ZmZlciBz\nZWxlY3RTUUwsIE9iamVjdCBlbGVtLCBTZWxlY3Qgc2VsLAogICAgICAgIGlu\ndCBpZHgpIHsKICAgICAgICBpZiAoZWxlbSBpbnN0YW5jZW9mIFNRTEJ1ZmZl\ncikKICAgICAgICAgICAgc2VsZWN0U1FMLmFwcGVuZCgoU1FMQnVmZmVyKSBl\nbGVtKTsKICAgICAgICBlbHNlCiAgICAgICAgICAgIHNlbGVjdFNRTC5hcHBl\nbmQoZWxlbS50b1N0cmluZygpKTsKICAgIH0KCiAgICAvKioKICAgICAqIFJl\ndHVybnMgdHJ1ZSBpZiBhICJGT1IgVVBEQVRFIiBjbGF1c2UgY2FuIGJlIHVz\nZWQgZm9yIHRoZSBzcGVjaWZpZWQKICAgICAqIFNlbGVjdCBvYmplY3QuCiAg\nICAgKi8KICAgIHB1YmxpYyBib29sZWFuIHN1cHBvcnRzTG9ja2luZyhTZWxl\nY3Qgc2VsKSB7CiAgICAgICAgaWYgKHNlbC5pc0FnZ3JlZ2F0ZSgpKQogICAg\nICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgaWYgKCFzdXBwb3J0c1Nl\nbGVjdEZvclVwZGF0ZSkKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAg\nICAgIGlmICghc3VwcG9ydHNMb2NraW5nV2l0aFNlbGVjdFJhbmdlICYmIChz\nZWwuZ2V0U3RhcnRJbmRleCgpICE9IDAKICAgICAgICAgICAgfHwgc2VsLmdl\ndEVuZEluZGV4KCkgIT0gTG9uZy5NQVhfVkFMVUUpKQogICAgICAgICAgICBy\nZXR1cm4gZmFsc2U7CgogICAgICAgIC8vIG9ubHkgaW5uZXIgc2VsZWN0IGlz\nIGxvY2tlZAogICAgICAgIGlmIChzZWwuZ2V0RnJvbVNlbGVjdCgpICE9IG51\nbGwpCiAgICAgICAgICAgIHNlbCA9IHNlbC5nZXRGcm9tU2VsZWN0KCk7Cgog\nICAgICAgIGlmICghc3VwcG9ydHNMb2NraW5nV2l0aERpc3RpbmN0Q2xhdXNl\nICYmIHNlbC5pc0Rpc3RpbmN0KCkpCiAgICAgICAgICAgIHJldHVybiBmYWxz\nZTsKICAgICAgICBpZiAoIXN1cHBvcnRzTG9ja2luZ1dpdGhNdWx0aXBsZVRh\nYmxlcwogICAgICAgICAgICAmJiBzZWwuZ2V0VGFibGVBbGlhc2VzKCkuc2l6\nZSgpID4gMSkKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIGlm\nICghc3VwcG9ydHNMb2NraW5nV2l0aE9yZGVyQ2xhdXNlICYmIHNlbC5nZXRP\ncmRlcmluZygpICE9IG51bGwpCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsK\nICAgICAgICBpZiAoIXN1cHBvcnRzTG9ja2luZ1dpdGhPdXRlckpvaW4gfHwg\nIXN1cHBvcnRzTG9ja2luZ1dpdGhJbm5lckpvaW4pIHsKICAgICAgICAgICAg\nZm9yIChJdGVyYXRvciBpdHIgPSBzZWwuZ2V0Sm9pbkl0ZXJhdG9yKCk7IGl0\nci5oYXNOZXh0KCk7KSB7CiAgICAgICAgICAgICAgICBKb2luIGpvaW4gPSAo\nSm9pbikgaXRyLm5leHQoKTsKICAgICAgICAgICAgICAgIGlmICghc3VwcG9y\ndHNMb2NraW5nV2l0aE91dGVySm9pbgogICAgICAgICAgICAgICAgICAgICYm\nIGpvaW4uZ2V0VHlwZSgpID09IEpvaW4uVFlQRV9PVVRFUikKICAgICAgICAg\nICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgICAgICBpZiAo\nIXN1cHBvcnRzTG9ja2luZ1dpdGhJbm5lckpvaW4KICAgICAgICAgICAgICAg\nICAgICAmJiBqb2luLmdldFR5cGUoKSA9PSBKb2luLlRZUEVfSU5ORVIpCiAg\nICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICB9\nCiAgICAgICAgfQogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8q\nKgogICAgICogUmV0dXJuIGZhbHNlIGlmIHRoZSBnaXZlbiBzZWxlY3QgcmVx\ndWlyZXMgYSBmb3J3YXJkLW9ubHkgcmVzdWx0IHNldC4KICAgICAqLwogICAg\ncHVibGljIGJvb2xlYW4gc3VwcG9ydHNSYW5kb21BY2Nlc3NSZXN1bHRTZXQo\nU2VsZWN0IHNlbCwKICAgICAgICBib29sZWFuIGZvclVwZGF0ZSkgewogICAg\nICAgIHJldHVybiAhc2VsLmlzQWdncmVnYXRlKCk7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBBc3NlcnQgdGhhdCB0aGUgZ2l2ZW4gZGljdGlvbmFyeSBmbGFn\nIGlzIHRydWUuIElmIGl0IGlzIG5vdCB0cnVlLAogICAgICogdGhyb3cgYW4g\nZXJyb3Igc2F5aW5nIHRoYXQgdGhlIGdpdmVuIHNldHRpbmcgbmVlZHMgdG8g\ncmV0dXJuIHRydWUgZm9yCiAgICAgKiB0aGUgY3VycmVudCBvcGVyYXRpb24g\ndG8gd29yay4KICAgICAqLwogICAgcHVibGljIHZvaWQgYXNzZXJ0U3VwcG9y\ndChib29sZWFuIGZlYXR1cmUsIFN0cmluZyBwcm9wZXJ0eSkgewogICAgICAg\nIGlmICghZmVhdHVyZSkKICAgICAgICAgICAgdGhyb3cgbmV3IFVuc3VwcG9y\ndGVkRXhjZXB0aW9uKF9sb2MuZ2V0KCJmZWF0dXJlLW5vdC1zdXBwb3J0ZWQi\nLAogICAgICAgICAgICAgICAgZ2V0Q2xhc3MoKSwgcHJvcGVydHkpKTsKICAg\nIH0KCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLwogICAgLy8gUXVlcnkgZnVu\nY3Rpb25zCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLwoKICAgIC8qKgogICAg\nICogSW52b2tlIHRoaXMgZGF0YWJhc2UncyBzdWJzdHJpbmcgZnVuY3Rpb24u\nCiAgICAgKgogICAgICogQHBhcmFtIGJ1ZiB0aGUgU1FMIGJ1ZmZlciB0byB3\ncml0ZSB0aGUgc3Vic3RyaW5nIGludm9jYXRpb24gdG8KICAgICAqIEBwYXJh\nbSBzdHIgYSBxdWVyeSB2YWx1ZSByZXByZXNlbnRpbmcgdGhlIHRhcmdldCBz\ndHJpbmcKICAgICAqIEBwYXJhbSBzdGFydCBhIHF1ZXJ5IHZhbHVlIHJlcHJl\nc2VudGluZyB0aGUgc3RhcnQgaW5kZXgKICAgICAqIEBwYXJhbSBlbmQgYSBx\ndWVyeSB2YWx1ZSByZXByZXNlbnRpbmcgdGhlIGVuZCBpbmRleCwgb3IgbnVs\nbCBmb3Igbm9uZQogICAgICovCiAgICBwdWJsaWMgdm9pZCBzdWJzdHJpbmco\nU1FMQnVmZmVyIGJ1ZiwgRmlsdGVyVmFsdWUgc3RyLCBGaWx0ZXJWYWx1ZSBz\ndGFydCwKICAgICAgICBGaWx0ZXJWYWx1ZSBlbmQpIHsKICAgICAgICBidWYu\nYXBwZW5kKHN1YnN0cmluZ0Z1bmN0aW9uTmFtZSkuYXBwZW5kKCIoIik7CiAg\nICAgICAgc3RyLmFwcGVuZFRvKGJ1Zik7CiAgICAgICAgYnVmLmFwcGVuZCgi\nLCAiKTsKICAgICAgICBpZiAoc3RhcnQuZ2V0VmFsdWUoKSBpbnN0YW5jZW9m\nIE51bWJlcikgewogICAgICAgICAgICBsb25nIHN0YXJ0TG9uZyA9IHRvTG9u\nZyhzdGFydCk7CiAgICAgICAgICAgIGJ1Zi5hcHBlbmQoTG9uZy50b1N0cmlu\nZyhzdGFydExvbmcgKyAxKSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAg\nICAgYnVmLmFwcGVuZCgiKCIpOwogICAgICAgICAgICBzdGFydC5hcHBlbmRU\nbyhidWYpOwogICAgICAgICAgICBidWYuYXBwZW5kKCIgKyAxKSIpOwogICAg\nICAgIH0KICAgICAgICBpZiAoZW5kICE9IG51bGwpIHsKICAgICAgICAgICAg\nYnVmLmFwcGVuZCgiLCAiKTsKICAgICAgICAgICAgaWYgKHN0YXJ0LmdldFZh\nbHVlKCkgaW5zdGFuY2VvZiBOdW1iZXIKICAgICAgICAgICAgICAgICYmIGVu\nZC5nZXRWYWx1ZSgpIGluc3RhbmNlb2YgTnVtYmVyKSB7CiAgICAgICAgICAg\nICAgICBsb25nIHN0YXJ0TG9uZyA9IHRvTG9uZyhzdGFydCk7CiAgICAgICAg\nICAgICAgICBsb25nIGVuZExvbmcgPSB0b0xvbmcoZW5kKTsKICAgICAgICAg\nICAgICAgIGJ1Zi5hcHBlbmQoTG9uZy50b1N0cmluZyhlbmRMb25nIC0gc3Rh\ncnRMb25nKSk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAg\nICBlbmQuYXBwZW5kVG8oYnVmKTsKICAgICAgICAgICAgICAgIGJ1Zi5hcHBl\nbmQoIiAtICgiKTsKICAgICAgICAgICAgICAgIHN0YXJ0LmFwcGVuZFRvKGJ1\nZik7CiAgICAgICAgICAgICAgICBidWYuYXBwZW5kKCIpIik7CiAgICAgICAg\nICAgIH0KICAgICAgICB9CiAgICAgICAgYnVmLmFwcGVuZCgiKSIpOwogICAg\nfQoKICAgIGxvbmcgdG9Mb25nKEZpbHRlclZhbHVlIGxpdFZhbHVlKSB7CiAg\nICAgICAgcmV0dXJuICgoTnVtYmVyKSBsaXRWYWx1ZS5nZXRWYWx1ZSgpKS5s\nb25nVmFsdWUoKTsKICAgIH0KCiAgICAvKioKICAgICAqIEludm9rZSB0aGlz\nIGRhdGFiYXNlJ3MgaW5kZXhPZiBmdW5jdGlvbi4KICAgICAqCiAgICAgKiBA\ncGFyYW0gYnVmIHRoZSBTUUwgYnVmZmVyIHRvIHdyaXRlIHRoZSBpbmRleE9m\nIGludm9jYXRpb24gdG8KICAgICAqIEBwYXJhbSBzdHIgYSBxdWVyeSB2YWx1\nZSByZXByZXNlbnRpbmcgdGhlIHRhcmdldCBzdHJpbmcKICAgICAqIEBwYXJh\nbSBmaW5kIGEgcXVlcnkgdmFsdWUgcmVwcmVzZW50aW5nIHRoZSBzZWFyY2gg\nc3RyaW5nCiAgICAgKiBAcGFyYW0gc3RhcnQgYSBxdWVyeSB2YWx1ZSByZXBy\nZXNlbnRpbmcgdGhlIHN0YXJ0IGluZGV4LCBvciBudWxsCiAgICAgKiB0byBz\ndGFydCBhdCB0aGUgYmVnaW5uaW5nCiAgICAgKi8KICAgIHB1YmxpYyB2b2lk\nIGluZGV4T2YoU1FMQnVmZmVyIGJ1ZiwgRmlsdGVyVmFsdWUgc3RyLCBGaWx0\nZXJWYWx1ZSBmaW5kLAogICAgICAgIEZpbHRlclZhbHVlIHN0YXJ0KSB7CiAg\nICAgICAgYnVmLmFwcGVuZCgiKElOU1RSKCgiKTsKICAgICAgICBpZiAoc3Rh\ncnQgIT0gbnVsbCkKICAgICAgICAgICAgc3Vic3RyaW5nKGJ1Ziwgc3RyLCBz\ndGFydCwgbnVsbCk7CiAgICAgICAgZWxzZQogICAgICAgICAgICBzdHIuYXBw\nZW5kVG8oYnVmKTsKICAgICAgICBidWYuYXBwZW5kKCIpLCAoIik7CiAgICAg\nICAgZmluZC5hcHBlbmRUbyhidWYpOwogICAgICAgIGJ1Zi5hcHBlbmQoIikp\nIC0gMSIpOwogICAgICAgIGlmIChzdGFydCAhPSBudWxsKSB7CiAgICAgICAg\nICAgIGJ1Zi5hcHBlbmQoIiArICIpOwogICAgICAgICAgICBzdGFydC5hcHBl\nbmRUbyhidWYpOwogICAgICAgIH0KICAgICAgICBidWYuYXBwZW5kKCIpIik7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBBcHBlbmQgdGhlIG51bWVyaWMgcGFy\ndHMgb2YgYSBtYXRoZW1hdGljYWwgZnVuY3Rpb24uCiAgICAgKgogICAgICog\nQHBhcmFtIGJ1ZiB0aGUgU1FMIGJ1ZmZlciB0byB3cml0ZSB0aGUgbWF0aCBm\ndW5jdGlvbgogICAgICogQHBhcmFtIG9wIHRoZSBtYXRoZW1hdGljYWwgb3Bl\ncmF0aW9uIHRvIHBlcmZvcm0KICAgICAqIEBwYXJhbSBsaHMgdGhlIGxlZnQg\naGFuZCBzaWRlIG9mIHRoZSBtYXRoIGZ1bmN0aW9uCiAgICAgKiBAcGFyYW0g\ncmhzIHRoZSByaWdodCBoYW5kIHNpZGUgb2YgdGhlIG1hdGggZnVuY3Rpb24K\nICAgICAqLwogICAgcHVibGljIHZvaWQgbWF0aEZ1bmN0aW9uKFNRTEJ1ZmZl\nciBidWYsIFN0cmluZyBvcCwgRmlsdGVyVmFsdWUgbGhzLAogICAgICAgIEZp\nbHRlclZhbHVlIHJocykgewogICAgICAgIGJvb2xlYW4gY2FzdGxocyA9IGZh\nbHNlOwogICAgICAgIGJvb2xlYW4gY2FzdHJocyA9IGZhbHNlOwogICAgICAg\nIENsYXNzIGxjID0gRmlsdGVycy53cmFwKGxocy5nZXRUeXBlKCkpOwogICAg\nICAgIENsYXNzIHJjID0gRmlsdGVycy53cmFwKHJocy5nZXRUeXBlKCkpOwog\nICAgICAgIGludCB0eXBlID0gMDsKICAgICAgICBpZiAocmVxdWlyZXNDYXN0\nRm9yTWF0aEZ1bmN0aW9ucyAmJiAobGMgIT0gcmMKICAgICAgICAgICAgfHwg\nKGxocy5pc0NvbnN0YW50KCkgJiYgcmhzLmlzQ29uc3RhbnQoKSkpKSB7CiAg\nICAgICAgICAgIENsYXNzIGMgPSBGaWx0ZXJzLnByb21vdGUobGMsIHJjKTsK\nICAgICAgICAgICAgdHlwZSA9IGdldEpEQkNUeXBlKEphdmFUeXBlcy5nZXRU\neXBlQ29kZShjKSwgZmFsc2UpOwogICAgICAgICAgICBpZiAodHlwZSAhPSBU\neXBlcy5WQVJCSU5BUlkgJiYgdHlwZSAhPSBUeXBlcy5CTE9CKSB7CiAgICAg\nICAgICAgICAgICBjYXN0bGhzID0gKGxocy5pc0NvbnN0YW50KCkgJiYgcmhz\nLmlzQ29uc3RhbnQoKSkgfHwgbGMgIT0gYzsKICAgICAgICAgICAgICAgIGNh\nc3RyaHMgPSAobGhzLmlzQ29uc3RhbnQoKSAmJiByaHMuaXNDb25zdGFudCgp\nKSB8fCByYyAhPSBjOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAg\nICBib29sZWFuIG1vZCA9ICJNT0QiLmVxdWFscyhvcCk7CiAgICAgICAgaWYg\nKG1vZCkgewogICAgICAgICAgICBpZiAoc3VwcG9ydHNNb2RPcGVyYXRvcikK\nICAgICAgICAgICAgICAgIG9wID0gIiUiOwogICAgICAgICAgICBlbHNlCiAg\nICAgICAgICAgICAgICBidWYuYXBwZW5kKG9wKTsKICAgICAgICB9CiAgICAg\nICAgYnVmLmFwcGVuZCgiKCIpOwoKICAgICAgICBpZiAoY2FzdGxocykKICAg\nICAgICAgICAgYXBwZW5kQ2FzdChidWYsIGxocywgdHlwZSk7CiAgICAgICAg\nZWxzZQogICAgICAgICAgICBsaHMuYXBwZW5kVG8oYnVmKTsKCiAgICAgICAg\naWYgKG1vZCAmJiAhc3VwcG9ydHNNb2RPcGVyYXRvcikKICAgICAgICAgICAg\nYnVmLmFwcGVuZCgiLCAiKTsKICAgICAgICBlbHNlCiAgICAgICAgICAgIGJ1\nZi5hcHBlbmQoIiAiKS5hcHBlbmQob3ApLmFwcGVuZCgiICIpOwoKICAgICAg\nICBpZiAoY2FzdHJocykKICAgICAgICAgICAgYXBwZW5kQ2FzdChidWYsIHJo\ncywgdHlwZSk7CiAgICAgICAgZWxzZQogICAgICAgICAgICByaHMuYXBwZW5k\nVG8oYnVmKTsKCiAgICAgICAgYnVmLmFwcGVuZCgiKSIpOwogICAgfQoKICAg\nIC8qKgogICAgICogQXBwZW5kIGEgY29tcGFyaXNvbi4KICAgICAqCiAgICAg\nKiBAcGFyYW0gYnVmIHRoZSBTUUwgYnVmZmVyIHRvIHdyaXRlIHRoZSBjb21w\nYXJpc29uCiAgICAgKiBAcGFyYW0gb3AgdGhlIGNvbXBhcmlzb24gb3BlcmF0\naW9uIHRvIHBlcmZvcm0KICAgICAqIEBwYXJhbSBsaHMgdGhlIGxlZnQgaGFu\nZCBzaWRlIG9mIHRoZSBjb21wYXJpc29uCiAgICAgKiBAcGFyYW0gcmhzIHRo\nZSByaWdodCBoYW5kIHNpZGUgb2YgdGhlIGNvbXBhcmlzb24KICAgICAqLwog\nICAgcHVibGljIHZvaWQgY29tcGFyaXNvbihTUUxCdWZmZXIgYnVmLCBTdHJp\nbmcgb3AsIEZpbHRlclZhbHVlIGxocywKICAgICAgICBGaWx0ZXJWYWx1ZSBy\naHMpIHsKICAgICAgICBib29sZWFuIGxoc3htbCA9IGxocy5nZXRYUGF0aCgp\nICE9IG51bGw7CiAgICAgICAgYm9vbGVhbiByaHN4bWwgPSByaHMuZ2V0WFBh\ndGgoKSAhPSBudWxsOwogICAgICAgIGlmIChsaHN4bWwgfHwgcmhzeG1sKSB7\nCiAgICAgICAgICAgIGFwcGVuZFhtbENvbXBhcmlzb24oYnVmLCBvcCwgbGhz\nLCByaHMsIGxoc3htbCwgcmhzeG1sKTsKICAgICAgICAgICAgcmV0dXJuOwog\nICAgICAgIH0KICAgICAgICBib29sZWFuIGNhc3RsaHMgPSBmYWxzZTsKICAg\nICAgICBib29sZWFuIGNhc3RyaHMgPSBmYWxzZTsKICAgICAgICBDbGFzcyBs\nYyA9IEZpbHRlcnMud3JhcChsaHMuZ2V0VHlwZSgpKTsKICAgICAgICBDbGFz\ncyByYyA9IEZpbHRlcnMud3JhcChyaHMuZ2V0VHlwZSgpKTsKICAgICAgICBp\nbnQgdHlwZSA9IDA7CiAgICAgICAgaWYgKHJlcXVpcmVzQ2FzdEZvckNvbXBh\ncmlzb25zICYmIChsYyAhPSByYwogICAgICAgICAgICB8fCAobGhzLmlzQ29u\nc3RhbnQoKSAmJiByaHMuaXNDb25zdGFudCgpKSkpIHsKICAgICAgICAgICAg\nQ2xhc3MgYyA9IEZpbHRlcnMucHJvbW90ZShsYywgcmMpOwogICAgICAgICAg\nICB0eXBlID0gZ2V0SkRCQ1R5cGUoSmF2YVR5cGVzLmdldFR5cGVDb2RlKGMp\nLCBmYWxzZSk7CiAgICAgICAgICAgIGlmICh0eXBlICE9IFR5cGVzLlZBUkJJ\nTkFSWSAmJiB0eXBlICE9IFR5cGVzLkJMT0IpIHsKICAgICAgICAgICAgICAg\nIGNhc3RsaHMgPSAobGhzLmlzQ29uc3RhbnQoKSAmJiByaHMuaXNDb25zdGFu\ndCgpKSB8fCBsYyAhPSBjOwogICAgICAgICAgICAgICAgY2FzdHJocyA9IChs\naHMuaXNDb25zdGFudCgpICYmIHJocy5pc0NvbnN0YW50KCkpIHx8IHJjICE9\nIGM7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGlmIChjYXN0\nbGhzKQogICAgICAgICAgICBhcHBlbmRDYXN0KGJ1ZiwgbGhzLCB0eXBlKTsK\nICAgICAgICBlbHNlCiAgICAgICAgICAgIGxocy5hcHBlbmRUbyhidWYpOwoK\nICAgICAgICBidWYuYXBwZW5kKCIgIikuYXBwZW5kKG9wKS5hcHBlbmQoIiAi\nKTsKCiAgICAgICAgaWYgKGNhc3RyaHMpCiAgICAgICAgICAgIGFwcGVuZENh\nc3QoYnVmLCByaHMsIHR5cGUpOwogICAgICAgIGVsc2UKICAgICAgICAgICAg\ncmhzLmFwcGVuZFRvKGJ1Zik7CiAgICB9CgogICAgLyoqCiAgICAgKiBJZiB0\naGlzIGRpY3Rpb25hcnkgc3VwcG9ydHMgWE1MIHR5cGUsCiAgICAgKiB1c2Ug\ndGhpcyBtZXRob2QgdG8gYXBwZW5kIHhtbCBwcmVkaWNhdGUuCiAgICAgKi8K\nICAgIHB1YmxpYyB2b2lkIGFwcGVuZFhtbENvbXBhcmlzb24oU1FMQnVmZmVy\nIGJ1ZiwgU3RyaW5nIG9wLCBGaWx0ZXJWYWx1ZSBsaHMsCiAgICAgICAgRmls\ndGVyVmFsdWUgcmhzLCBib29sZWFuIGxoc3htbCwgYm9vbGVhbiByaHN4bWwp\nIHsKICAgICAgICBhc3NlcnRTdXBwb3J0KHN1cHBvcnRzWE1MQ29sdW1uLCAi\nU3VwcG9ydHNYTUxDb2x1bW4iKTsKICAgIH0KCiAgICAvKioKICAgICAqIEFw\ncGVuZCBTUUwgZm9yIHRoZSBnaXZlbiBudW1lcmljIHZhbHVlIHRvIHRoZSBi\ndWZmZXIsIGNhc3RpbmcgYXMgbmVlZGVkLgogICAgICovCiAgICBwcm90ZWN0\nZWQgdm9pZCBhcHBlbmROdW1lcmljQ2FzdChTUUxCdWZmZXIgYnVmLCBGaWx0\nZXJWYWx1ZSB2YWwpIHsKICAgICAgICBpZiAodmFsLmlzQ29uc3RhbnQoKSkK\nICAgICAgICAgICAgYXBwZW5kQ2FzdChidWYsIHZhbCwgVHlwZXMuTlVNRVJJ\nQyk7CiAgICAgICAgZWxzZQogICAgICAgICAgICB2YWwuYXBwZW5kVG8oYnVm\nKTsKICAgIH0KCiAgICAvKioKICAgICAqIENhc3QgdGhlIHNwZWNpZmllZCB2\nYWx1ZSB0byB0aGUgc3BlY2lmaWVkIHR5cGUuCiAgICAgKgogICAgICogQHBh\ncmFtIGJ1ZiB0aGUgYnVmZmVyIHRvIGFwcGVuZCB0aGUgY2FzdCB0bwogICAg\nICogQHBhcmFtIHZhbCB0aGUgdmFsdWUgdG8gY2FzdAogICAgICogQHBhcmFt\nIHR5cGUgdGhlIHR5cGUgb2YgdGhlIGNhc2UsIGUuZy4ge0BsaW5rIFR5cGVz\nI05VTUVSSUN9CiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIGFwcGVuZENhc3Qo\nU1FMQnVmZmVyIGJ1ZiwgT2JqZWN0IHZhbCwgaW50IHR5cGUpIHsKICAgICAg\nICAvLyBDb252ZXJ0IHRoZSBjYXN0IGZ1bmN0aW9uOiAiQ0FTVCh7MH0gQVMg\nezF9KSIKICAgICAgICBpbnQgZmlyc3RQYXJhbSA9IGNhc3RGdW5jdGlvbi5p\nbmRleE9mKCJ7MH0iKTsKICAgICAgICBTdHJpbmcgcHJlID0gY2FzdEZ1bmN0\naW9uLnN1YnN0cmluZygwLCBmaXJzdFBhcmFtKTsgLy8gIkNBU1QoIgogICAg\nICAgIFN0cmluZyBtaWQgPSBjYXN0RnVuY3Rpb24uc3Vic3RyaW5nKGZpcnN0\nUGFyYW0gKyAzKTsKICAgICAgICBpbnQgc2Vjb25kUGFyYW0gPSBtaWQuaW5k\nZXhPZigiezF9Iik7CiAgICAgICAgU3RyaW5nIHBvc3Q7CiAgICAgICAgaWYg\nKHNlY29uZFBhcmFtID4gLTEpIHsKICAgICAgICAgICAgcG9zdCA9IG1pZC5z\ndWJzdHJpbmcoc2Vjb25kUGFyYW0gKyAzKTsgLy8gIikiCiAgICAgICAgICAg\nIG1pZCA9IG1pZC5zdWJzdHJpbmcoMCwgc2Vjb25kUGFyYW0pOyAvLyAiIEFT\nICIKICAgICAgICB9IGVsc2UKICAgICAgICAgICAgcG9zdCA9ICIiOwoKICAg\nICAgICBidWYuYXBwZW5kKHByZSk7CiAgICAgICAgaWYgKHZhbCBpbnN0YW5j\nZW9mIEZpbHRlclZhbHVlKQogICAgICAgICAgICAoKEZpbHRlclZhbHVlKSB2\nYWwpLmFwcGVuZFRvKGJ1Zik7CiAgICAgICAgZWxzZSBpZiAodmFsIGluc3Rh\nbmNlb2YgU1FMQnVmZmVyKQogICAgICAgICAgICBidWYuYXBwZW5kKCgoU1FM\nQnVmZmVyKSB2YWwpKTsKICAgICAgICBlbHNlCiAgICAgICAgICAgIGJ1Zi5h\ncHBlbmQodmFsLnRvU3RyaW5nKCkpOwogICAgICAgIGJ1Zi5hcHBlbmQobWlk\nKTsKICAgICAgICBidWYuYXBwZW5kKGdldFR5cGVOYW1lKHR5cGUpKTsKICAg\nICAgICBhcHBlbmRMZW5ndGgoYnVmLCB0eXBlKTsKICAgICAgICBidWYuYXBw\nZW5kKHBvc3QpOwogICAgfQogICAgCiAgICBwcm90ZWN0ZWQgdm9pZCBhcHBl\nbmRMZW5ndGgoU1FMQnVmZmVyIGJ1ZiwgaW50IHR5cGUpIHsgICAgICAgIAog\nICAgfQoKICAgIAogICAgLyoqCiAgICAgKiBhZGQgQ0FTVCBmb3IgYSBmdW5j\ndGlvbiBvcGVyYXRvciB3aGVyZSBvcGVyYW5kIGlzIGEgcGFyYW0KICAgICAq\nIEBwYXJhbSBmdW5jICBmdW5jdGlvbiBuYW1lCiAgICAgKiBAcGFyYW0gdmFs\nIAogICAgICogQHJldHVybiB1cGRhdGVkIGZ1bmMKICAgICAqLwogICAgcHVi\nbGljIFN0cmluZyBhZGRDYXN0QXNUeXBlKFN0cmluZyBmdW5jLCBWYWwgdmFs\nKSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICB9ICAgIAoKCiAgICAvLy8v\nLy8vLy8vLwogICAgLy8gRERMIFNRTAogICAgLy8vLy8vLy8vLy8KCiAgICAv\nKioKICAgICAqIEluY3JlbWVudCB0aGUgcmVmZXJlbmNlIGNvdW50IG9mIGFu\neSB0YWJsZSBjb21wb25lbnRzIHRoYXQgdGhpcwogICAgICogZGljdGlvbmFy\neSBhZGRzIHRoYXQgYXJlIG5vdCB1c2VkIGJ5IG1hcHBpbmdzLiBEb2VzIG5v\ndGhpbmcgYnkgZGVmYXVsdC4KICAgICAqLwogICAgcHVibGljIHZvaWQgcmVm\nU2NoZW1hQ29tcG9uZW50cyhUYWJsZSB0YWJsZSkgewogICAgfQoKICAgIC8q\nKgogICAgICogUmV0dXJucyB0aGUgZnVsbCBuYW1lIG9mIHRoZSB0YWJsZSwg\naW5jbHVkaW5nIHRoZSBzY2hlbWEgKGRlbGltaXRlZAogICAgICogYnkge0Bs\naW5rICNjYXRhbG9nU2VwYXJhdG9yfSkuCiAgICAgKi8KICAgIHB1YmxpYyBT\ndHJpbmcgZ2V0RnVsbE5hbWUoVGFibGUgdGFibGUsIGJvb2xlYW4gbG9naWNh\nbCkgewogICAgICAgIGlmICghdXNlU2NoZW1hTmFtZSB8fCB0YWJsZS5nZXRT\nY2hlbWFOYW1lKCkgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIHRhYmxl\nLmdldE5hbWUoKTsKICAgICAgICBpZiAobG9naWNhbCB8fCAiLiIuZXF1YWxz\nKGNhdGFsb2dTZXBhcmF0b3IpKQogICAgICAgICAgICByZXR1cm4gdGFibGUu\nZ2V0RnVsbE5hbWUoKTsKICAgICAgICByZXR1cm4gdGFibGUuZ2V0U2NoZW1h\nTmFtZSgpICsgY2F0YWxvZ1NlcGFyYXRvciArIHRhYmxlLmdldE5hbWUoKTsK\nICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybnMgdGhlIGZ1bGwgbmFtZSBv\nZiB0aGUgaW5kZXgsIGluY2x1ZGluZyB0aGUgc2NoZW1hIChkZWxpbWl0ZWQK\nICAgICAqIGJ5IHRoZSByZXN1bHQgb2Yge0BsaW5rICNjYXRhbG9nU2VwYXJh\ndG9yfSkuCiAgICAgKi8KICAgIHB1YmxpYyBTdHJpbmcgZ2V0RnVsbE5hbWUo\nSW5kZXggaW5kZXgpIHsKICAgICAgICBpZiAoIXVzZVNjaGVtYU5hbWUgfHwg\naW5kZXguZ2V0U2NoZW1hTmFtZSgpID09IG51bGwpCiAgICAgICAgICAgIHJl\ndHVybiBpbmRleC5nZXROYW1lKCk7CiAgICAgICAgaWYgKCIuIi5lcXVhbHMo\nY2F0YWxvZ1NlcGFyYXRvcikpCiAgICAgICAgICAgIHJldHVybiBpbmRleC5n\nZXRGdWxsTmFtZSgpOwogICAgICAgIHJldHVybiBpbmRleC5nZXRTY2hlbWFO\nYW1lKCkgKyBjYXRhbG9nU2VwYXJhdG9yICsgaW5kZXguZ2V0TmFtZSgpOwog\nICAgfQoKICAgIC8qKgogICAgICogUmV0dXJucyB0aGUgZnVsbCBuYW1lIG9m\nIHRoZSBzZXF1ZW5jZSwgaW5jbHVkaW5nIHRoZSBzY2hlbWEgKGRlbGltaXRl\nZAogICAgICogYnkgdGhlIHJlc3VsdCBvZiB7QGxpbmsgI2NhdGFsb2dTZXBh\ncmF0b3J9KS4KICAgICAqLwogICAgcHVibGljIFN0cmluZyBnZXRGdWxsTmFt\nZShTZXF1ZW5jZSBzZXEpIHsKICAgICAgICBpZiAoIXVzZVNjaGVtYU5hbWUg\nfHwgc2VxLmdldFNjaGVtYU5hbWUoKSA9PSBudWxsKQogICAgICAgICAgICBy\nZXR1cm4gc2VxLmdldE5hbWUoKTsKICAgICAgICBpZiAoIi4iLmVxdWFscyhj\nYXRhbG9nU2VwYXJhdG9yKSkKICAgICAgICAgICAgcmV0dXJuIHNlcS5nZXRG\ndWxsTmFtZSgpOwogICAgICAgIHJldHVybiBzZXEuZ2V0U2NoZW1hTmFtZSgp\nICsgY2F0YWxvZ1NlcGFyYXRvciArIHNlcS5nZXROYW1lKCk7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBNYWtlIGFueSBuZWNlc3NhcnkgY2hhbmdlcyB0byB0\naGUgZ2l2ZW4gdGFibGUgbmFtZSB0byBtYWtlIGl0IHZhbGlkCiAgICAgKiBm\nb3IgdGhlIGN1cnJlbnQgREIuCiAgICAgKi8KICAgIHB1YmxpYyBTdHJpbmcg\nZ2V0VmFsaWRUYWJsZU5hbWUoU3RyaW5nIG5hbWUsIFNjaGVtYSBzY2hlbWEp\nIHsKICAgICAgICB3aGlsZSAobmFtZS5zdGFydHNXaXRoKCJfIikpCiAgICAg\nICAgICAgIG5hbWUgPSBuYW1lLnN1YnN0cmluZygxKTsKICAgICAgICByZXR1\ncm4gbWFrZU5hbWVWYWxpZChuYW1lLCBzY2hlbWEuZ2V0U2NoZW1hR3JvdXAo\nKSwKICAgICAgICAgICAgbWF4VGFibGVOYW1lTGVuZ3RoLCBOQU1FX1RBQkxF\nKTsKICAgIH0KCiAgICAvKioKICAgICAqIE1ha2UgYW55IG5lY2Vzc2FyeSBj\naGFuZ2VzIHRvIHRoZSBnaXZlbiBzZXF1ZW5jZSBuYW1lIHRvIG1ha2UgaXQg\ndmFsaWQKICAgICAqIGZvciB0aGUgY3VycmVudCBEQi4KICAgICAqLwogICAg\ncHVibGljIFN0cmluZyBnZXRWYWxpZFNlcXVlbmNlTmFtZShTdHJpbmcgbmFt\nZSwgU2NoZW1hIHNjaGVtYSkgewogICAgICAgIHdoaWxlIChuYW1lLnN0YXJ0\nc1dpdGgoIl8iKSkKICAgICAgICAgICAgbmFtZSA9IG5hbWUuc3Vic3RyaW5n\nKDEpOwogICAgICAgIHJldHVybiBtYWtlTmFtZVZhbGlkKCJTXyIgKyBuYW1l\nLCBzY2hlbWEuZ2V0U2NoZW1hR3JvdXAoKSwKICAgICAgICAgICAgbWF4VGFi\nbGVOYW1lTGVuZ3RoLCBOQU1FX1NFUVVFTkNFKTsKICAgIH0KCiAgICAvKioK\nICAgICAqIE1ha2UgYW55IG5lY2Vzc2FyeSBjaGFuZ2VzIHRvIHRoZSBnaXZl\nbiBjb2x1bW4gbmFtZSB0byBtYWtlIGl0IHZhbGlkCiAgICAgKiBmb3IgdGhl\nIGN1cnJlbnQgREIuICBUaGUgY29sdW1uIG5hbWUgd2lsbCBiZSBtYWRlIHVu\naXF1ZSBmb3IgdGhlCiAgICAgKiBzcGVjaWZpZWQgdGFibGUuCiAgICAgKi8K\nICAgIHB1YmxpYyBTdHJpbmcgZ2V0VmFsaWRDb2x1bW5OYW1lKFN0cmluZyBu\nYW1lLCBUYWJsZSB0YWJsZSkgewogICAgICAgIHJldHVybiBnZXRWYWxpZENv\nbHVtbk5hbWUobmFtZSwgdGFibGUsIHRydWUpOwogICAgfQoKICAgIC8qKgog\nICAgICogTWFrZSBhbnkgbmVjZXNzYXJ5IGNoYW5nZXMgdG8gdGhlIGdpdmVu\nIGNvbHVtbiBuYW1lIHRvIG1ha2UgaXQgdmFsaWQKICAgICAqIGZvciB0aGUg\nY3VycmVudCBEQi4gIElmIGNoZWNrRm9yVW5pcXVlbmVzcyBpcyB0cnVlLCB0\naGUgY29sdW1uIG5hbWUgd2lsbCAKICAgICAqIGJlIG1hZGUgdW5pcXVlIGZv\nciB0aGUgc3BlY2lmaWVkIHRhYmxlLgogICAgICovCiAgICBwdWJsaWMgU3Ry\naW5nIGdldFZhbGlkQ29sdW1uTmFtZShTdHJpbmcgbmFtZSwgVGFibGUgdGFi\nbGUsCiAgICAgICAgYm9vbGVhbiBjaGVja0ZvclVuaXF1ZW5lc3MpIHsKICAg\nICAgICB3aGlsZSAobmFtZS5zdGFydHNXaXRoKCJfIikpCiAgICAgICAgICAg\nIG5hbWUgPSBuYW1lLnN1YnN0cmluZygxKTsKICAgICAgICByZXR1cm4gbWFr\nZU5hbWVWYWxpZChuYW1lLCB0YWJsZSwgbWF4Q29sdW1uTmFtZUxlbmd0aCwg\nTkFNRV9BTlksCiAgICAgICAgICAgIGNoZWNrRm9yVW5pcXVlbmVzcyk7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBNYWtlIGFueSBuZWNlc3NhcnkgY2hhbmdl\ncyB0byB0aGUgZ2l2ZW4gcHJpbWFyeSBrZXkgbmFtZSB0byBtYWtlIGl0CiAg\nICAgKiB2YWxpZCBmb3IgdGhlIGN1cnJlbnQgREIuCiAgICAgKi8KICAgIHB1\nYmxpYyBTdHJpbmcgZ2V0VmFsaWRQcmltYXJ5S2V5TmFtZShTdHJpbmcgbmFt\nZSwgVGFibGUgdGFibGUpIHsKICAgICAgICB3aGlsZSAobmFtZS5zdGFydHNX\naXRoKCJfIikpCiAgICAgICAgICAgIG5hbWUgPSBuYW1lLnN1YnN0cmluZygx\nKTsKICAgICAgICByZXR1cm4gbWFrZU5hbWVWYWxpZCgiUF8iICsgbmFtZSwg\ndGFibGUuZ2V0U2NoZW1hKCkuZ2V0U2NoZW1hR3JvdXAoKSwKICAgICAgICAg\nICAgbWF4Q29uc3RyYWludE5hbWVMZW5ndGgsIE5BTUVfQU5ZKTsKICAgIH0K\nCiAgICAvKioKICAgICAqIE1ha2UgYW55IG5lY2Vzc2FyeSBjaGFuZ2VzIHRv\nIHRoZSBnaXZlbiBmb3JlaWduIGtleSBuYW1lIHRvIG1ha2UgaXQKICAgICAq\nIHZhbGlkIGZvciB0aGUgY3VycmVudCBEQi4KICAgICAqLwogICAgcHVibGlj\nIFN0cmluZyBnZXRWYWxpZEZvcmVpZ25LZXlOYW1lKFN0cmluZyBuYW1lLCBU\nYWJsZSB0YWJsZSwKICAgICAgICBUYWJsZSB0b1RhYmxlKSB7CiAgICAgICAg\nd2hpbGUgKG5hbWUuc3RhcnRzV2l0aCgiXyIpKQogICAgICAgICAgICBuYW1l\nID0gbmFtZS5zdWJzdHJpbmcoMSk7CiAgICAgICAgU3RyaW5nIHRhYmxlTmFt\nZSA9IHRhYmxlLmdldE5hbWUoKTsKICAgICAgICBpbnQgbGVuID0gTWF0aC5t\naW4odGFibGVOYW1lLmxlbmd0aCgpLCA3KTsKICAgICAgICBuYW1lID0gIkZf\nIiArIHNob3J0ZW4odGFibGVOYW1lLCBsZW4pICsgIl8iICsgbmFtZTsKICAg\nICAgICByZXR1cm4gbWFrZU5hbWVWYWxpZChuYW1lLCB0YWJsZS5nZXRTY2hl\nbWEoKS5nZXRTY2hlbWFHcm91cCgpLAogICAgICAgICAgICBtYXhDb25zdHJh\naW50TmFtZUxlbmd0aCwgTkFNRV9BTlkpOwogICAgfQoKICAgIC8qKgogICAg\nICogTWFrZSBhbnkgbmVjZXNzYXJ5IGNoYW5nZXMgdG8gdGhlIGdpdmVuIGlu\nZGV4IG5hbWUgdG8gbWFrZSBpdCB2YWxpZAogICAgICogZm9yIHRoZSBjdXJy\nZW50IERCLgogICAgICovCiAgICBwdWJsaWMgU3RyaW5nIGdldFZhbGlkSW5k\nZXhOYW1lKFN0cmluZyBuYW1lLCBUYWJsZSB0YWJsZSkgewogICAgICAgIHdo\naWxlIChuYW1lLnN0YXJ0c1dpdGgoIl8iKSkKICAgICAgICAgICAgbmFtZSA9\nIG5hbWUuc3Vic3RyaW5nKDEpOwogICAgICAgIFN0cmluZyB0YWJsZU5hbWUg\nPSB0YWJsZS5nZXROYW1lKCk7CiAgICAgICAgaW50IGxlbiA9IE1hdGgubWlu\nKHRhYmxlTmFtZS5sZW5ndGgoKSwgNyk7CiAgICAgICAgbmFtZSA9ICJJXyIg\nKyBzaG9ydGVuKHRhYmxlTmFtZSwgbGVuKSArICJfIiArIG5hbWU7CiAgICAg\nICAgcmV0dXJuIG1ha2VOYW1lVmFsaWQobmFtZSwgdGFibGUuZ2V0U2NoZW1h\nKCkuZ2V0U2NoZW1hR3JvdXAoKSwKICAgICAgICAgICAgbWF4SW5kZXhOYW1l\nTGVuZ3RoLCBOQU1FX0FOWSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBNYWtl\nIGFueSBuZWNlc3NhcnkgY2hhbmdlcyB0byB0aGUgZ2l2ZW4gdW5pcXVlIGNv\nbnN0cmFpbnQgbmFtZSB0byBtYWtlCiAgICAgKiBpdCB2YWxpZCBmb3IgdGhl\nIGN1cnJlbnQgREIuCiAgICAgKi8KICAgIHB1YmxpYyBTdHJpbmcgZ2V0VmFs\naWRVbmlxdWVOYW1lKFN0cmluZyBuYW1lLCBUYWJsZSB0YWJsZSkgewogICAg\nICAgIHdoaWxlIChuYW1lLnN0YXJ0c1dpdGgoIl8iKSkKICAgICAgICAgICAg\nbmFtZSA9IG5hbWUuc3Vic3RyaW5nKDEpOwogICAgICAgIFN0cmluZyB0YWJs\nZU5hbWUgPSB0YWJsZS5nZXROYW1lKCk7CiAgICAgICAgaW50IGxlbiA9IE1h\ndGgubWluKHRhYmxlTmFtZS5sZW5ndGgoKSwgNyk7CiAgICAgICAgbmFtZSA9\nICJVXyIgKyBzaG9ydGVuKHRhYmxlTmFtZSwgbGVuKSArICJfIiArIG5hbWU7\nCiAgICAgICAgcmV0dXJuIG1ha2VOYW1lVmFsaWQobmFtZSwgdGFibGUuZ2V0\nU2NoZW1hKCkuZ2V0U2NoZW1hR3JvdXAoKSwKICAgICAgICAgICAgbWF4Q29u\nc3RyYWludE5hbWVMZW5ndGgsIE5BTUVfQU5ZKTsKICAgIH0KCiAgICAvKioK\nICAgICAqIFNob3J0ZW4gdGhlIHNwZWNpZmllZCBuYW1lIHRvIHRoZSBzcGVj\naWZpZWQgdGFyZ2V0IG5hbWUuIFRoaXMgd2lsbAogICAgICogYmUgZG9uZSBi\neSBmaXJzdCBzdHJpcHBpbmcgb3V0IHRoZSB2b3dlbHMsIGFuZCB0aGVuIHJl\nbW92aW5nCiAgICAgKiBjaGFyYWN0ZXJzIGZyb20gdGhlIG1pZGRsZSBvZiB0\naGUgd29yZCB1bnRpbCBpdCByZWFjaGVzIHRoZSB0YXJnZXQKICAgICAqIGxl\nbmd0aC4KICAgICAqLwogICAgcHJvdGVjdGVkIHN0YXRpYyBTdHJpbmcgc2hv\ncnRlbihTdHJpbmcgbmFtZSwgaW50IHRhcmdldExlbmd0aCkgewogICAgICAg\nIGlmIChuYW1lID09IG51bGwgfHwgbmFtZS5sZW5ndGgoKSA8PSB0YXJnZXRM\nZW5ndGgpCiAgICAgICAgICAgIHJldHVybiBuYW1lOwoKICAgICAgICBTdHJp\nbmdCdWZmZXIgbm0gPSBuZXcgU3RyaW5nQnVmZmVyKG5hbWUpOwogICAgICAg\nIHdoaWxlIChubS5sZW5ndGgoKSA+IHRhcmdldExlbmd0aCkgewogICAgICAg\nICAgICBpZiAoIXN0cmlwVm93ZWwobm0pKSB7CiAgICAgICAgICAgICAgICAv\nLyBjdXQgb3V0IHRoZSBtaWRkbGUgY2hhcgogICAgICAgICAgICAgICAgbm0u\ncmVwbGFjZShubS5sZW5ndGgoKSAvIDIsIChubS5sZW5ndGgoKSAvIDIpICsg\nMSwgIiIpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVy\nbiBubS50b1N0cmluZygpOwogICAgfQoKICAgIC8qKgogICAgICogUmVtb3Zl\nIHZvd2VscyBmcm9tIHRoZSBzcGVjaWZpZWQgU3RyaW5nQnVmZmVyLgogICAg\nICoKICAgICAqIEByZXR1cm4gdHJ1ZSBpZiBhbnkgdm93ZWxzIGhhdmUgYmVl\nbiByZW1vdmVkCiAgICAgKi8KICAgIHByaXZhdGUgc3RhdGljIGJvb2xlYW4g\nc3RyaXBWb3dlbChTdHJpbmdCdWZmZXIgbmFtZSkgewogICAgICAgIGlmIChu\nYW1lID09IG51bGwgfHwgbmFtZS5sZW5ndGgoKSA9PSAwKQogICAgICAgICAg\nICByZXR1cm4gZmFsc2U7CgogICAgICAgIGNoYXJbXSB2b3dlbHMgPSB7ICdB\nJywgJ0UnLCAnSScsICdPJywgJ1UnLCB9OwogICAgICAgIGZvciAoaW50IGkg\nPSAwOyBpIDwgdm93ZWxzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGlu\ndCBpbmRleCA9IG5hbWUudG9TdHJpbmcoKS50b1VwcGVyQ2FzZSgpLmluZGV4\nT2Yodm93ZWxzW2ldKTsKICAgICAgICAgICAgaWYgKGluZGV4ICE9IC0xKSB7\nCiAgICAgICAgICAgICAgICBuYW1lLnJlcGxhY2UoaW5kZXgsIGluZGV4ICsg\nMSwgIiIpOwogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAg\nICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoK\nICAgIC8qKgogICAgICogU2hvcnRlbnMgdGhlIGdpdmVuIG5hbWUgdG8gdGhl\nIGdpdmVuIG1heGltdW0gbGVuZ3RoLCB0aGVuIGNoZWNrcyB0aGF0CiAgICAg\nKiBpdCBpcyBub3QgYSByZXNlcnZlZCB3b3JkLiBJZiBpdCBpcyByZXNlcnZl\nZCwgYXBwZW5kcyBhICIwIi4gSWYKICAgICAqIHRoZSBuYW1lIGNvbmZsaWN0\ncyB3aXRoIGFuIGV4aXN0aW5nIHNjaGVtYSBjb21wb25lbnQsIHRoZSBsYXN0\nCiAgICAgKiBjaGFyYWN0ZXIgaXMgcmVwbGFjZSB3aXRoICcwJywgdGhlbiAn\nMScsIGV0Yy4KICAgICAqIE5vdGUgdGhhdCB0aGUgZ2l2ZW4gbWF4IGxlbiBt\nYXkgYmUgMCBpZiB0aGUgZGF0YWJhc2UgbWV0YWRhdGEgaXMKICAgICAqIGlu\nY29tcGxldGUuCiAgICAgKi8KICAgIHByb3RlY3RlZCBTdHJpbmcgbWFrZU5h\nbWVWYWxpZChTdHJpbmcgbmFtZSwgTmFtZVNldCBzZXQsIGludCBtYXhMZW4s\nCiAgICAgICAgaW50IG5hbWVUeXBlKSB7CiAgICAgICAgcmV0dXJuIG1ha2VO\nYW1lVmFsaWQobmFtZSwgc2V0LCBtYXhMZW4sIG5hbWVUeXBlLCB0cnVlKTsK\nICAgIH0KCiAgICAvKioKICAgICAqIFNob3J0ZW5zIHRoZSBnaXZlbiBuYW1l\nIHRvIHRoZSBnaXZlbiBtYXhpbXVtIGxlbmd0aCwgdGhlbiBjaGVja3MgdGhh\ndAogICAgICogaXQgaXMgbm90IGEgcmVzZXJ2ZWQgd29yZC4gSWYgaXQgaXMg\ncmVzZXJ2ZWQsIGFwcGVuZHMgYSAiMCIuIElmCiAgICAgKiB0aGUgbmFtZSBj\nb25mbGljdHMgd2l0aCBhbiBleGlzdGluZyBzY2hlbWEgY29tcG9uZW50IGFu\nZCB1bmlxdWVuZXNzCiAgICAgKiBjaGVja2luZyBpcyBlbmFibGVkLCB0aGUg\nbGFzdCBjaGFyYWN0ZXIgaXMgcmVwbGFjZSB3aXRoICcwJywgdGhlbiAKICAg\nICAqICcxJywgZXRjLiAKICAgICAqIE5vdGUgdGhhdCB0aGUgZ2l2ZW4gbWF4\nIGxlbiBtYXkgYmUgMCBpZiB0aGUgZGF0YWJhc2UgbWV0YWRhdGEgaXMgCiAg\nICAgKiBpbmNvbXBsZXRlLgogICAgICovCiAgICBwcm90ZWN0ZWQgU3RyaW5n\nIG1ha2VOYW1lVmFsaWQoU3RyaW5nIG5hbWUsIE5hbWVTZXQgc2V0LCBpbnQg\nbWF4TGVuLAogICAgICAgIGludCBuYW1lVHlwZSwgYm9vbGVhbiBjaGVja0Zv\nclVuaXF1ZW5lc3MpIHsKICAgICAgICBpZiAobWF4TGVuIDwgMSkKICAgICAg\nICAgICAgbWF4TGVuID0gMjU1OwogICAgICAgIGlmIChuYW1lLmxlbmd0aCgp\nID4gbWF4TGVuKQogICAgICAgICAgICBuYW1lID0gbmFtZS5zdWJzdHJpbmco\nMCwgbWF4TGVuKTsKICAgICAgICBpZiAocmVzZXJ2ZWRXb3JkU2V0LmNvbnRh\naW5zKG5hbWUudG9VcHBlckNhc2UoKSkpIHsKICAgICAgICAgICAgaWYgKG5h\nbWUubGVuZ3RoKCkgPT0gbWF4TGVuKQogICAgICAgICAgICAgICAgbmFtZSA9\nIG5hbWUuc3Vic3RyaW5nKDAsIG5hbWUubGVuZ3RoKCkgLSAxKTsKICAgICAg\nICAgICAgbmFtZSArPSAiMCI7CiAgICAgICAgfQoKICAgICAgICAvLyBub3cg\nbWFrZSBzdXJlIHRoZSBuYW1lIGlzIHVuaXF1ZQogICAgICAgIGlmIChzZXQg\nIT0gbnVsbCAmJiBjaGVja0ZvclVuaXF1ZW5lc3MpIHsKICAgICAgICAgICAg\nb3V0ZXI6CiAgICAgICAgICAgIGZvciAoaW50IHZlcnNpb24gPSAxLCBjaGFy\ncyA9IDE7IHRydWU7IHZlcnNpb24rKykgewogICAgICAgICAgICAgICAgLy8g\nZm9yIHRhYmxlIG5hbWVzLCB3ZSBjaGVjayBmb3IgdGhlIHRhYmxlIGl0c2Vs\nZiBpbiBjYXNlIHRoZQogICAgICAgICAgICAgICAgLy8gbmFtZSBzZXQgaXMg\nbGF6eSBhYm91dCBzY2hlbWEgcmVmbGVjdGlvbgogICAgICAgICAgICAgICAg\nc3dpdGNoIChuYW1lVHlwZSkgewogICAgICAgICAgICAgICAgICAgIGNhc2Ug\nTkFNRV9UQUJMRToKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEoKFNj\naGVtYUdyb3VwKSBzZXQpLmlzS25vd25UYWJsZShuYW1lKSkKICAgICAgICAg\nICAgICAgICAgICAgICAgICAgIGJyZWFrIG91dGVyOwogICAgICAgICAgICAg\nICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICBjYXNlIE5B\nTUVfU0VRVUVOQ0U6CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKChT\nY2hlbWFHcm91cCkgc2V0KS5pc0tub3duU2VxdWVuY2UobmFtZSkpCiAgICAg\nICAgICAgICAgICAgICAgICAgICAgICBicmVhayBvdXRlcjsKICAgICAgICAg\nICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgZGVm\nYXVsdDoKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFzZXQuaXNOYW1l\nVGFrZW4obmFtZSkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVh\nayBvdXRlcjsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAv\nLyBhIHNpbmdsZSBjaGFyIGZvciB0aGUgdmVyc2lvbiBpcyBwcm9iYWJseSBl\nbm91Z2gsIGJ1dCBtaWdodAogICAgICAgICAgICAgICAgLy8gYXMgd2VsbCBi\nZSBnZW5lcmFsIGFib3V0IGl0Li4uCiAgICAgICAgICAgICAgICBpZiAodmVy\nc2lvbiA+IDEpCiAgICAgICAgICAgICAgICAgICAgbmFtZSA9IG5hbWUuc3Vi\nc3RyaW5nKDAsIG5hbWUubGVuZ3RoKCkgLSBjaGFycyk7CiAgICAgICAgICAg\nICAgICBpZiAodmVyc2lvbiA+PSBNYXRoLnBvdygxMCwgY2hhcnMpKQogICAg\nICAgICAgICAgICAgICAgIGNoYXJzKys7CiAgICAgICAgICAgICAgICBpZiAo\nbmFtZS5sZW5ndGgoKSArIGNoYXJzID4gbWF4TGVuKQogICAgICAgICAgICAg\nICAgICAgIG5hbWUgPSBuYW1lLnN1YnN0cmluZygwLCBtYXhMZW4gLSBjaGFy\ncyk7CiAgICAgICAgICAgICAgICBuYW1lID0gbmFtZSArIHZlcnNpb247CiAg\nICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIG5hbWUudG9V\ncHBlckNhc2UoKTsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiBhIHNl\ncmllcyBvZiBTUUwgc3RhdGVtZW50cyB0byBjcmVhdGUgdGhlIGdpdmVuIHRh\nYmxlLCBjb21wbGV0ZQogICAgICogd2l0aCBjb2x1bW5zLiBJbmRleGVzIGFu\nZCBjb25zdHJhaW50cyB3aWxsIGJlIGNyZWF0ZWQgc2VwYXJhdGVseS4KICAg\nICAqLwogICAgcHVibGljIFN0cmluZ1tdIGdldENyZWF0ZVRhYmxlU1FMKFRh\nYmxlIHRhYmxlKSB7CiAgICAgICAgU3RyaW5nQnVmZmVyIGJ1ZiA9IG5ldyBT\ndHJpbmdCdWZmZXIoKTsKICAgICAgICBidWYuYXBwZW5kKCJDUkVBVEUgVEFC\nTEUgIikuYXBwZW5kKGdldEZ1bGxOYW1lKHRhYmxlLCBmYWxzZSkpOwogICAg\nICAgIGlmIChzdXBwb3J0c0NvbW1lbnRzICYmIHRhYmxlLmhhc0NvbW1lbnQo\nKSkgewogICAgICAgICAgICBidWYuYXBwZW5kKCIgIik7CiAgICAgICAgICAg\nIGNvbW1lbnQoYnVmLCB0YWJsZS5nZXRDb21tZW50KCkpOwogICAgICAgICAg\nICBidWYuYXBwZW5kKCJcbiAgICAoIik7CiAgICAgICAgfSBlbHNlIHsKICAg\nICAgICAgICAgYnVmLmFwcGVuZCgiICgiKTsKICAgICAgICB9CgogICAgICAg\nIC8vIGRvIHRoaXMgYmVmb3JlIGdldHRpbmcgdGhlIGNvbHVtbnMgc28gd2Ug\na25vdyBob3cgdG8gaGFuZGxlCiAgICAgICAgLy8gdGhlIGxhc3QgY29tbWEK\nICAgICAgICBTdHJpbmdCdWZmZXIgZW5kQnVmID0gbmV3IFN0cmluZ0J1ZmZl\ncigpOwogICAgICAgIFByaW1hcnlLZXkgcGsgPSB0YWJsZS5nZXRQcmltYXJ5\nS2V5KCk7CiAgICAgICAgU3RyaW5nIHBrU3RyOwogICAgICAgIGlmIChwayAh\nPSBudWxsKSB7CiAgICAgICAgICAgIHBrU3RyID0gZ2V0UHJpbWFyeUtleUNv\nbnN0cmFpbnRTUUwocGspOwogICAgICAgICAgICBpZiAocGtTdHIgIT0gbnVs\nbCkKICAgICAgICAgICAgICAgIGVuZEJ1Zi5hcHBlbmQocGtTdHIpOwogICAg\nICAgIH0KCiAgICAgICAgVW5pcXVlW10gdW5xcyA9IHRhYmxlLmdldFVuaXF1\nZXMoKTsKICAgICAgICBTdHJpbmcgdW5xU3RyOwogICAgICAgIGZvciAoaW50\nIGkgPSAwOyBpIDwgdW5xcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICB1\nbnFTdHIgPSBnZXRVbmlxdWVDb25zdHJhaW50U1FMKHVucXNbaV0pOwogICAg\nICAgICAgICBpZiAodW5xU3RyICE9IG51bGwpIHsKICAgICAgICAgICAgICAg\nIGlmIChlbmRCdWYubGVuZ3RoKCkgPiAwKQogICAgICAgICAgICAgICAgICAg\nIGVuZEJ1Zi5hcHBlbmQoIiwgIik7CiAgICAgICAgICAgICAgICBlbmRCdWYu\nYXBwZW5kKHVucVN0cik7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAg\nICAgIENvbHVtbltdIGNvbHMgPSB0YWJsZS5nZXRDb2x1bW5zKCk7CiAgICAg\nICAgZm9yIChpbnQgaSA9IDA7IGkgPCBjb2xzLmxlbmd0aDsgaSsrKSB7CiAg\nICAgICAgICAgIGJ1Zi5hcHBlbmQoZ2V0RGVjbGFyZUNvbHVtblNRTChjb2xz\nW2ldLCBmYWxzZSkpOwogICAgICAgICAgICBpZiAoaSA8IGNvbHMubGVuZ3Ro\nIC0gMSB8fCBlbmRCdWYubGVuZ3RoKCkgPiAwKQogICAgICAgICAgICAgICAg\nYnVmLmFwcGVuZCgiLCAiKTsKICAgICAgICAgICAgaWYgKHN1cHBvcnRzQ29t\nbWVudHMgJiYgY29sc1tpXS5oYXNDb21tZW50KCkpIHsKICAgICAgICAgICAg\nICAgIGNvbW1lbnQoYnVmLCBjb2xzW2ldLmdldENvbW1lbnQoKSk7CiAgICAg\nICAgICAgICAgICBidWYuYXBwZW5kKCJcbiAgICAiKTsKICAgICAgICAgICAg\nfQogICAgICAgIH0KCiAgICAgICAgYnVmLmFwcGVuZChlbmRCdWYudG9TdHJp\nbmcoKSk7CiAgICAgICAgYnVmLmFwcGVuZCgiKSIpOwogICAgICAgIHJldHVy\nbiBuZXcgU3RyaW5nW117IGJ1Zi50b1N0cmluZygpIH07CiAgICB9CgogICAg\ncHJvdGVjdGVkIFN0cmluZ0J1ZmZlciBjb21tZW50KFN0cmluZ0J1ZmZlciBi\ndWYsIFN0cmluZyBjb21tZW50KSB7CiAgICAgICAgcmV0dXJuIGJ1Zi5hcHBl\nbmQoIi0tICIpLmFwcGVuZChjb21tZW50KTsKICAgIH0KCiAgICAvKioKICAg\nICAqIFJldHVybiBhIHNlcmllcyBvZiBTUUwgc3RhdGVtZW50cyB0byBkcm9w\nIHRoZSBnaXZlbiB0YWJsZS4gSW5kZXhlcwogICAgICogd2lsbCBiZSBkcm9w\ncGVkIHNlcGFyYXRlbHkuIFJldHVybnMKICAgICAqIDxjb2RlPkRST1AgVEFC\nTEUgJmx0O3RhYmxlIG5hbWUmZ3Q7PC9jb2RlPiBieSBkZWZhdWx0LgogICAg\nICovCiAgICBwdWJsaWMgU3RyaW5nW10gZ2V0RHJvcFRhYmxlU1FMKFRhYmxl\nIHRhYmxlKSB7CiAgICAgICAgU3RyaW5nIGRyb3AgPSBNZXNzYWdlRm9ybWF0\nLmZvcm1hdChkcm9wVGFibGVTUUwsIG5ldyBPYmplY3RbXXsKICAgICAgICAg\nICAgZ2V0RnVsbE5hbWUodGFibGUsIGZhbHNlKSB9KTsKICAgICAgICByZXR1\ncm4gbmV3IFN0cmluZ1tdeyBkcm9wIH07CiAgICB9CgogICAgLyoqCiAgICAg\nKiBSZXR1cm4gYSBzZXJpZXMgb2YgU1FMIHN0YXRlbWVudHMgdG8gY3JlYXRl\nIHRoZSBnaXZlbiBzZXF1ZW5jZS4gUmV0dXJucwogICAgICogPGNvZGU+Q1JF\nQVRFIFNFUVVFTkNFICZsdDtzZXF1ZW5jZSBuYW1lJmd0O1sgU1RBUlQgV0lU\nSCAmbHQ7c3RhcnQmZ3Q7XQogICAgICogWyBJTkNSRU1FTlQgQlkgJmx0O2lu\nY3JlbWVudCZndDtdPC9jb2RlPiBieSBkZWZhdWx0LgogICAgICovCiAgICBw\ndWJsaWMgU3RyaW5nW10gZ2V0Q3JlYXRlU2VxdWVuY2VTUUwoU2VxdWVuY2Ug\nc2VxKSB7CiAgICAgICAgaWYgKG5leHRTZXF1ZW5jZVF1ZXJ5ID09IG51bGwp\nCiAgICAgICAgICAgIHJldHVybiBudWxsOwoKICAgICAgICBTdHJpbmdCdWZm\nZXIgYnVmID0gbmV3IFN0cmluZ0J1ZmZlcigpOwogICAgICAgIGJ1Zi5hcHBl\nbmQoIkNSRUFURSBTRVFVRU5DRSAiKTsKICAgICAgICBidWYuYXBwZW5kKGdl\ndEZ1bGxOYW1lKHNlcSkpOwogICAgICAgIGlmIChzZXEuZ2V0SW5pdGlhbFZh\nbHVlKCkgIT0gMCkKICAgICAgICAgICAgYnVmLmFwcGVuZCgiIFNUQVJUIFdJ\nVEggIikuYXBwZW5kKHNlcS5nZXRJbml0aWFsVmFsdWUoKSk7CiAgICAgICAg\naWYgKHNlcS5nZXRJbmNyZW1lbnQoKSA+IDEpCiAgICAgICAgICAgIGJ1Zi5h\ncHBlbmQoIiBJTkNSRU1FTlQgQlkgIikuYXBwZW5kKHNlcS5nZXRJbmNyZW1l\nbnQoKSk7CiAgICAgICAgcmV0dXJuIG5ldyBTdHJpbmdbXXsgYnVmLnRvU3Ry\naW5nKCkgfTsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiBhIHNlcmll\ncyBvZiBTUUwgc3RhdGVtZW50cyB0byBkcm9wIHRoZSBnaXZlbiBzZXF1ZW5j\nZS4gUmV0dXJucwogICAgICogPGNvZGU+RFJPUCBTRVFVRU5DRSAmbHQ7c2Vx\ndWVuY2UgbmFtZSZndDs8L2NvZGU+IGJ5IGRlZmF1bHQuCiAgICAgKi8KICAg\nIHB1YmxpYyBTdHJpbmdbXSBnZXREcm9wU2VxdWVuY2VTUUwoU2VxdWVuY2Ug\nc2VxKSB7CiAgICAgICAgcmV0dXJuIG5ldyBTdHJpbmdbXXsgIkRST1AgU0VR\nVUVOQ0UgIiArIGdldEZ1bGxOYW1lKHNlcSkgfTsKICAgIH0KCiAgICAvKioK\nICAgICAqIFJldHVybiBhIHNlcmllcyBvZiBTUUwgc3RhdGVtZW50cyB0byBj\ncmVhdGUgdGhlIGdpdmVuIGluZGV4LiBSZXR1cm5zCiAgICAgKiA8Y29kZT5D\nUkVBVEUgW1VOSVFVRV0gSU5ERVggJmx0O2luZGV4IG5hbWUmZ3Q7IE9OICZs\ndDt0YWJsZSBuYW1lJmd0OwogICAgICogKCZsdDtjb2wgbGlzdCZndDspPC9j\nb2RlPiBieSBkZWZhdWx0LgogICAgICovCiAgICBwdWJsaWMgU3RyaW5nW10g\nZ2V0Q3JlYXRlSW5kZXhTUUwoSW5kZXggaW5kZXgpIHsKICAgICAgICBTdHJp\nbmdCdWZmZXIgYnVmID0gbmV3IFN0cmluZ0J1ZmZlcigpOwogICAgICAgIGJ1\nZi5hcHBlbmQoIkNSRUFURSAiKTsKICAgICAgICBpZiAoaW5kZXguaXNVbmlx\ndWUoKSkKICAgICAgICAgICAgYnVmLmFwcGVuZCgiVU5JUVVFICIpOwogICAg\nICAgIGJ1Zi5hcHBlbmQoIklOREVYICIpLmFwcGVuZChpbmRleC5nZXROYW1l\nKCkpOwoKICAgICAgICBidWYuYXBwZW5kKCIgT04gIikuYXBwZW5kKGdldEZ1\nbGxOYW1lKGluZGV4LmdldFRhYmxlKCksIGZhbHNlKSk7CiAgICAgICAgYnVm\nLmFwcGVuZCgiICgiKS5hcHBlbmQoU3RyaW5ncy5qb2luKGluZGV4LmdldENv\nbHVtbnMoKSwgIiwgIikpLgogICAgICAgICAgICBhcHBlbmQoIikiKTsKCiAg\nICAgICAgcmV0dXJuIG5ldyBTdHJpbmdbXXsgYnVmLnRvU3RyaW5nKCkgfTsK\nICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiBhIHNlcmllcyBvZiBTUUwg\nc3RhdGVtZW50cyB0byBkcm9wIHRoZSBnaXZlbiBpbmRleC4gUmV0dXJucwog\nICAgICogPGNvZGU+RFJPUCBJTkRFWCAmbHQ7aW5kZXggbmFtZSZndDs8L2Nv\nZGU+IGJ5IGRlZmF1bHQuCiAgICAgKi8KICAgIHB1YmxpYyBTdHJpbmdbXSBn\nZXREcm9wSW5kZXhTUUwoSW5kZXggaW5kZXgpIHsKICAgICAgICByZXR1cm4g\nbmV3IFN0cmluZ1tdeyAiRFJPUCBJTkRFWCAiICsgZ2V0RnVsbE5hbWUoaW5k\nZXgpIH07CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gYSBzZXJpZXMg\nb2YgU1FMIHN0YXRlbWVudHMgdG8gYWRkIHRoZSBnaXZlbiBjb2x1bW4gdG8K\nICAgICAqIGl0cyB0YWJsZS4gUmV0dXJuIGFuIGVtcHR5IGFycmF5IGlmIG9w\nZXJhdGlvbiBub3Qgc3VwcG9ydGVkLiBSZXR1cm5zCiAgICAgKiA8Y29kZT5B\nTFRFUiBUQUJMRSAmbHQ7dGFibGUgbmFtZSZndDsgQUREICgmbHQ7Y29sIGRl\nYyZndDspPC9jb2RlPgogICAgICogYnkgZGVmYXVsdC4KICAgICAqLwogICAg\ncHVibGljIFN0cmluZ1tdIGdldEFkZENvbHVtblNRTChDb2x1bW4gY29sdW1u\nKSB7CiAgICAgICAgaWYgKCFzdXBwb3J0c0FsdGVyVGFibGVXaXRoQWRkQ29s\ndW1uKQogICAgICAgICAgICByZXR1cm4gbmV3IFN0cmluZ1swXTsKCiAgICAg\nICAgU3RyaW5nIGRlYyA9IGdldERlY2xhcmVDb2x1bW5TUUwoY29sdW1uLCB0\ncnVlKTsKICAgICAgICBpZiAoZGVjID09IG51bGwpCiAgICAgICAgICAgIHJl\ndHVybiBuZXcgU3RyaW5nWzBdOwogICAgICAgIHJldHVybiBuZXcgU3RyaW5n\nW117ICJBTFRFUiBUQUJMRSAiCiAgICAgICAgICAgICsgZ2V0RnVsbE5hbWUo\nY29sdW1uLmdldFRhYmxlKCksIGZhbHNlKSArICIgQUREICIgKyBkZWMgfTsK\nICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiBhIHNlcmllcyBvZiBTUUwg\nc3RhdGVtZW50cyB0byBkcm9wIHRoZSBnaXZlbiBjb2x1bW4gZnJvbQogICAg\nICogaXRzIHRhYmxlLiBSZXR1cm4gYW4gZW1wdHkgYXJyYXkgaWYgb3BlcmF0\naW9uIG5vdCBzdXBwb3J0ZWQuIFJldHVybnMKICAgICAqIDxjb2RlPkFMVEVS\nIFRBQkxFICZsdDt0YWJsZSBuYW1lJmd0OyBEUk9QIENPTFVNTiAmbHQ7Y29s\nIG5hbWUmZ3Q7PC9jb2RlPgogICAgICogYnkgZGVmYXVsdC4KICAgICAqLwog\nICAgcHVibGljIFN0cmluZ1tdIGdldERyb3BDb2x1bW5TUUwoQ29sdW1uIGNv\nbHVtbikgewogICAgICAgIGlmICghc3VwcG9ydHNBbHRlclRhYmxlV2l0aERy\nb3BDb2x1bW4pCiAgICAgICAgICAgIHJldHVybiBuZXcgU3RyaW5nWzBdOwog\nICAgICAgIHJldHVybiBuZXcgU3RyaW5nW117ICJBTFRFUiBUQUJMRSAiCiAg\nICAgICAgICAgICsgZ2V0RnVsbE5hbWUoY29sdW1uLmdldFRhYmxlKCksIGZh\nbHNlKQogICAgICAgICAgICArICIgRFJPUCBDT0xVTU4gIiArIGNvbHVtbiB9\nOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIGEgc2VyaWVzIG9mIFNR\nTCBzdGF0ZW1lbnRzIHRvIGFkZCB0aGUgZ2l2ZW4gcHJpbWFyeSBrZXkgdG8K\nICAgICAqIGl0cyB0YWJsZS4gUmV0dXJuIGFuIGVtcHR5IGFycmF5IGlmIG9w\nZXJhdGlvbiBub3Qgc3VwcG9ydGVkLgogICAgICogUmV0dXJucyA8Y29kZT5B\nTFRFUiBUQUJMRSAmbHQ7dGFibGUgbmFtZSZndDsgQURECiAgICAgKiAmbHQ7\ncGsgY29ucyBzcWwgJmd0OzwvY29kZT4gYnkgZGVmYXVsdC4KICAgICAqLwog\nICAgcHVibGljIFN0cmluZ1tdIGdldEFkZFByaW1hcnlLZXlTUUwoUHJpbWFy\neUtleSBwaykgewogICAgICAgIFN0cmluZyBwa3NxbCA9IGdldFByaW1hcnlL\nZXlDb25zdHJhaW50U1FMKHBrKTsKICAgICAgICBpZiAocGtzcWwgPT0gbnVs\nbCkKICAgICAgICAgICAgcmV0dXJuIG5ldyBTdHJpbmdbMF07CiAgICAgICAg\ncmV0dXJuIG5ldyBTdHJpbmdbXXsgIkFMVEVSIFRBQkxFICIKICAgICAgICAg\nICAgKyBnZXRGdWxsTmFtZShway5nZXRUYWJsZSgpLCBmYWxzZSkgKyAiIEFE\nRCAiICsgcGtzcWwgfTsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiBh\nIHNlcmllcyBvZiBTUUwgc3RhdGVtZW50cyB0byBkcm9wIHRoZSBnaXZlbiBw\ncmltYXJ5IGtleSBmcm9tCiAgICAgKiBpdHMgdGFibGUuIFJldHVybiBhbiBl\nbXB0eSBhcnJheSBpZiBvcGVyYXRpb24gbm90IHN1cHBvcnRlZC4KICAgICAq\nIFJldHVybnMgPGNvZGU+QUxURVIgVEFCTEUgJmx0O3RhYmxlIG5hbWUmZ3Q7\nIERST1AgQ09OU1RSQUlOVAogICAgICogJmx0O3BrIG5hbWUmZ3Q7PC9jb2Rl\nPiBieSBkZWZhdWx0LgogICAgICovCiAgICBwdWJsaWMgU3RyaW5nW10gZ2V0\nRHJvcFByaW1hcnlLZXlTUUwoUHJpbWFyeUtleSBwaykgewogICAgICAgIGlm\nIChway5nZXROYW1lKCkgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIG5l\ndyBTdHJpbmdbMF07CiAgICAgICAgcmV0dXJuIG5ldyBTdHJpbmdbXXsgIkFM\nVEVSIFRBQkxFICIKICAgICAgICAgICAgKyBnZXRGdWxsTmFtZShway5nZXRU\nYWJsZSgpLCBmYWxzZSkKICAgICAgICAgICAgKyAiIERST1AgQ09OU1RSQUlO\nVCAiICsgcGsuZ2V0TmFtZSgpIH07CiAgICB9CgogICAgLyoqCiAgICAgKiBS\nZXR1cm4gYSBzZXJpZXMgb2YgU1FMIHN0YXRlbWVudHMgdG8gYWRkIHRoZSBn\naXZlbiBmb3JlaWduIGtleSB0bwogICAgICogaXRzIHRhYmxlLiBSZXR1cm4g\nYW4gZW1wdHkgYXJyYXkgaWYgb3BlcmF0aW9uIG5vdCBzdXBwb3J0ZWQuCiAg\nICAgKiBSZXR1cm5zIDxjb2RlPkFMVEVSIFRBQkxFICZsdDt0YWJsZSBuYW1l\nJmd0OyBBREQKICAgICAqICZsdDtmayBjb25zIHNxbCAmZ3Q7PC9jb2RlPiBi\neSBkZWZhdWx0LgogICAgICovCiAgICBwdWJsaWMgU3RyaW5nW10gZ2V0QWRk\nRm9yZWlnbktleVNRTChGb3JlaWduS2V5IGZrKSB7CiAgICAgICAgU3RyaW5n\nIGZrU1FMID0gZ2V0Rm9yZWlnbktleUNvbnN0cmFpbnRTUUwoZmspOwogICAg\nICAgIGlmIChma1NRTCA9PSBudWxsKQogICAgICAgICAgICByZXR1cm4gbmV3\nIFN0cmluZ1swXTsKICAgICAgICByZXR1cm4gbmV3IFN0cmluZ1tdeyAiQUxU\nRVIgVEFCTEUgIgogICAgICAgICAgICArIGdldEZ1bGxOYW1lKGZrLmdldFRh\nYmxlKCksIGZhbHNlKSArICIgQUREICIgKyBma1NRTCB9OwogICAgfQoKICAg\nIC8qKgogICAgICogUmV0dXJuIGEgc2VyaWVzIG9mIFNRTCBzdGF0ZW1lbnRz\nIHRvIGRyb3AgdGhlIGdpdmVuIGZvcmVpZ24ga2V5IGZyb20KICAgICAqIGl0\ncyB0YWJsZS4gUmV0dXJuIGFuIGVtcHR5IGFycmF5IGlmIG9wZXJhdGlvbiBu\nb3Qgc3VwcG9ydGVkLgogICAgICogUmV0dXJucyA8Y29kZT5BTFRFUiBUQUJM\nRSAmbHQ7dGFibGUgbmFtZSZndDsgRFJPUCBDT05TVFJBSU5UCiAgICAgKiAm\nbHQ7ZmsgbmFtZSZndDs8L2NvZGU+IGJ5IGRlZmF1bHQuCiAgICAgKi8KICAg\nIHB1YmxpYyBTdHJpbmdbXSBnZXREcm9wRm9yZWlnbktleVNRTChGb3JlaWdu\nS2V5IGZrKSB7CiAgICAgICAgaWYgKGZrLmdldE5hbWUoKSA9PSBudWxsKQog\nICAgICAgICAgICByZXR1cm4gbmV3IFN0cmluZ1swXTsKICAgICAgICByZXR1\ncm4gbmV3IFN0cmluZ1tdeyAiQUxURVIgVEFCTEUgIgogICAgICAgICAgICAr\nIGdldEZ1bGxOYW1lKGZrLmdldFRhYmxlKCksIGZhbHNlKQogICAgICAgICAg\nICArICIgRFJPUCBDT05TVFJBSU5UICIgKyBmay5nZXROYW1lKCkgfTsKICAg\nIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgZGVjbGFyYXRpb24gU1FM\nIGZvciB0aGUgZ2l2ZW4gY29sdW1uLiBUaGlzIG1ldGhvZCBpcyB1c2VkCiAg\nICAgKiBmb3IgZWFjaCBjb2x1bW4gZnJvbSB3aXRoaW4ge0BsaW5rICNnZXRD\ncmVhdGVUYWJsZVNRTH0gYW5kCiAgICAgKiB7QGxpbmsgI2dldEFkZENvbHVt\nblNRTH0uCiAgICAgKi8KICAgIHByb3RlY3RlZCBTdHJpbmcgZ2V0RGVjbGFy\nZUNvbHVtblNRTChDb2x1bW4gY29sLCBib29sZWFuIGFsdGVyKSB7CiAgICAg\nICAgU3RyaW5nQnVmZmVyIGJ1ZiA9IG5ldyBTdHJpbmdCdWZmZXIoKTsKICAg\nICAgICBidWYuYXBwZW5kKGNvbCkuYXBwZW5kKCIgIik7CiAgICAgICAgYnVm\nLmFwcGVuZChnZXRUeXBlTmFtZShjb2wpKTsKCiAgICAgICAgLy8gY2FuJ3Qg\nYWRkIGNvbnN0cmFpbnRzIHRvIGEgY29sdW1uIHdlJ3JlIGFkZGluZyBhZnRl\nciB0YWJsZQogICAgICAgIC8vIGNyZWF0aW9uLCBjYXVzZSBzb21lIGRhdGEg\nbWlnaHQgYWxyZWFkeSBiZSBpbnNlcnRlZAogICAgICAgIGlmICghYWx0ZXIp\nIHsKICAgICAgICAgICAgaWYgKGNvbC5nZXREZWZhdWx0U3RyaW5nKCkgIT0g\nbnVsbCAmJiAhY29sLmlzQXV0b0Fzc2lnbmVkKCkpCiAgICAgICAgICAgICAg\nICBidWYuYXBwZW5kKCIgREVGQVVMVCAiKS5hcHBlbmQoY29sLmdldERlZmF1\nbHRTdHJpbmcoKSk7CiAgICAgICAgICAgIGlmIChjb2wuaXNOb3ROdWxsKCkp\nCiAgICAgICAgICAgICAgICBidWYuYXBwZW5kKCIgTk9UIE5VTEwiKTsKICAg\nICAgICB9CiAgICAgICAgaWYgKGNvbC5pc0F1dG9Bc3NpZ25lZCgpKSB7CiAg\nICAgICAgICAgIGlmICghc3VwcG9ydHNBdXRvQXNzaWduKQogICAgICAgICAg\nICAgICAgbG9nLndhcm4oX2xvYy5nZXQoImludmFsaWQtYXV0b2Fzc2lnbiIs\nIHBsYXRmb3JtLCBjb2wpKTsKICAgICAgICAgICAgZWxzZSBpZiAoYXV0b0Fz\nc2lnbkNsYXVzZSAhPSBudWxsKQogICAgICAgICAgICAgICAgYnVmLmFwcGVu\nZCgiICIpLmFwcGVuZChhdXRvQXNzaWduQ2xhdXNlKTsKICAgICAgICB9CiAg\nICAgICAgcmV0dXJuIGJ1Zi50b1N0cmluZygpOwogICAgfQoKICAgIC8qKgog\nICAgICogUmV0dXJuIHRoZSBkZWNsYXJhdGlvbiBTUUwgZm9yIHRoZSBnaXZl\nbiBwcmltYXJ5IGtleS4gVGhpcyBtZXRob2QgaXMKICAgICAqIHVzZWQgZnJv\nbSB3aXRoaW4ge0BsaW5rICNnZXRDcmVhdGVUYWJsZVNRTH0gYW5kCiAgICAg\nKiB7QGxpbmsgI2dldEFkZFByaW1hcnlLZXlTUUx9LiBSZXR1cm5zCiAgICAg\nKiA8Y29kZT5DT05TVFJBSU5UICZsdDtwayBuYW1lJmd0OyBQUklNQVJZIEtF\nWSAoJmx0O2NvbCBsaXN0Jmd0Oyk8L2NvZGU+CiAgICAgKiBieSBkZWZhdWx0\nLgogICAgICovCiAgICBwcm90ZWN0ZWQgU3RyaW5nIGdldFByaW1hcnlLZXlD\nb25zdHJhaW50U1FMKFByaW1hcnlLZXkgcGspIHsKICAgICAgICAvLyBpZiB3\nZSBoYXZlIGRpc2FibGVkIHRoZSBjcmVhdGlvbiBvZiBwcmltYXJ5IGtleXMs\nIGFib3J0IGhlcmUKICAgICAgICBpZiAoIWNyZWF0ZVByaW1hcnlLZXlzKQog\nICAgICAgICAgICByZXR1cm4gbnVsbDsKCiAgICAgICAgU3RyaW5nIG5hbWUg\nPSBway5nZXROYW1lKCk7CiAgICAgICAgaWYgKG5hbWUgIT0gbnVsbCAmJiBy\nZXNlcnZlZFdvcmRTZXQuY29udGFpbnMobmFtZS50b1VwcGVyQ2FzZSgpKSkK\nICAgICAgICAgICAgbmFtZSA9IG51bGw7CgogICAgICAgIFN0cmluZ0J1ZmZl\nciBidWYgPSBuZXcgU3RyaW5nQnVmZmVyKCk7CiAgICAgICAgaWYgKG5hbWUg\nIT0gbnVsbCAmJiBDT05TX05BTUVfQkVGT1JFLmVxdWFscyhjb25zdHJhaW50\nTmFtZU1vZGUpKQogICAgICAgICAgICBidWYuYXBwZW5kKCJDT05TVFJBSU5U\nICIpLmFwcGVuZChuYW1lKS5hcHBlbmQoIiAiKTsKICAgICAgICBidWYuYXBw\nZW5kKCJQUklNQVJZIEtFWSAiKTsKICAgICAgICBpZiAobmFtZSAhPSBudWxs\nICYmIENPTlNfTkFNRV9NSUQuZXF1YWxzKGNvbnN0cmFpbnROYW1lTW9kZSkp\nCiAgICAgICAgICAgIGJ1Zi5hcHBlbmQobmFtZSkuYXBwZW5kKCIgIik7CiAg\nICAgICAgYnVmLmFwcGVuZCgiKCIpLmFwcGVuZChTdHJpbmdzLmpvaW4ocGsu\nZ2V0Q29sdW1ucygpLCAiLCAiKSkuCiAgICAgICAgICAgIGFwcGVuZCgiKSIp\nOwogICAgICAgIGlmIChuYW1lICE9IG51bGwgJiYgQ09OU19OQU1FX0FGVEVS\nLmVxdWFscyhjb25zdHJhaW50TmFtZU1vZGUpKQogICAgICAgICAgICBidWYu\nYXBwZW5kKCIgQ09OU1RSQUlOVCAiKS5hcHBlbmQobmFtZSk7CiAgICAgICAg\ncmV0dXJuIGJ1Zi50b1N0cmluZygpOwogICAgfQoKICAgIC8qKgogICAgICog\nUmV0dXJuIHRoZSBkZWNsYXJhdGlvbiBTUUwgZm9yIHRoZSBnaXZlbiBmb3Jl\naWduIGtleSwgb3IgbnVsbCBpZiBpdCBpcwogICAgICogbm90IHN1cHBvcnRl\nZC4gVGhpcyBtZXRob2QgaXMgdXNlZCBmcm9tIHdpdGhpbgogICAgICoge0Bs\naW5rICNnZXRDcmVhdGVUYWJsZVNRTH0gYW5kIHtAbGluayAjZ2V0QWRkRm9y\nZWlnbktleVNRTH0uIFJldHVybnMKICAgICAqIDxjb2RlPkNPTlNUUkFJTlQg\nJmx0O2NvbnMgbmFtZSZndDsgRk9SRUlHTiBLRVkgKCZsdDtjb2wgbGlzdCZn\ndDspCiAgICAgKiBSRUZFUkVOQ0VTICZsdDtmb3JlaWduIHRhYmxlJmd0OyAo\nJmx0O2NvbCBsaXN0Jmd0OykKICAgICAqIFtPTiBERUxFVEUgJmx0O2FjdGlv\nbiZndDtdIFtPTiBVUERBVEUgJmx0O2FjdGlvbiZndDtdPC9jb2RlPiBieSBk\nZWZhdWx0LgogICAgICovCiAgICBwcm90ZWN0ZWQgU3RyaW5nIGdldEZvcmVp\nZ25LZXlDb25zdHJhaW50U1FMKEZvcmVpZ25LZXkgZmspIHsKICAgICAgICBp\nZiAoIXN1cHBvcnRzRm9yZWlnbktleXMpCiAgICAgICAgICAgIHJldHVybiBu\ndWxsOwogICAgICAgIGlmIChmay5nZXREZWxldGVBY3Rpb24oKSA9PSBGb3Jl\naWduS2V5LkFDVElPTl9OT05FKQogICAgICAgICAgICByZXR1cm4gbnVsbDsK\nICAgICAgICBpZiAoZmsuaXNEZWZlcnJlZCgpICYmICFzdXBwb3J0c0RlZmVy\ncmVkRm9yZWlnbktleUNvbnN0cmFpbnRzKCkpCiAgICAgICAgICAgIHJldHVy\nbiBudWxsOwogICAgICAgIGlmICghc3VwcG9ydHNEZWxldGVBY3Rpb24oZmsu\nZ2V0RGVsZXRlQWN0aW9uKCkpCiAgICAgICAgICAgIHx8ICFzdXBwb3J0c1Vw\nZGF0ZUFjdGlvbihmay5nZXRVcGRhdGVBY3Rpb24oKSkpCiAgICAgICAgICAg\nIHJldHVybiBudWxsOwoKICAgICAgICBDb2x1bW5bXSBsb2NhbHMgPSBmay5n\nZXRDb2x1bW5zKCk7CiAgICAgICAgQ29sdW1uW10gZm9yZWlnbnMgPSBmay5n\nZXRQcmltYXJ5S2V5Q29sdW1ucygpOwoKICAgICAgICBpbnQgZGVsQWN0aW9u\nSWQgPSBmay5nZXREZWxldGVBY3Rpb24oKTsKICAgICAgICBpZiAoZGVsQWN0\naW9uSWQgPT0gRm9yZWlnbktleS5BQ1RJT05fTlVMTCkgewogICAgICAgICAg\nICBmb3IgKGludCBpID0gMDsgaSA8IGxvY2Fscy5sZW5ndGg7IGkrKykgewog\nICAgICAgICAgICAgICAgaWYgKGxvY2Fsc1tpXS5pc05vdE51bGwoKSkKICAg\nICAgICAgICAgICAgICAgICBkZWxBY3Rpb25JZCA9IEZvcmVpZ25LZXkuQUNU\nSU9OX05PTkU7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIFN0\ncmluZyBkZWxBY3Rpb24gPSBnZXRBY3Rpb25OYW1lKGRlbEFjdGlvbklkKTsK\nICAgICAgICBTdHJpbmcgdXBBY3Rpb24gPSBnZXRBY3Rpb25OYW1lKGZrLmdl\ndFVwZGF0ZUFjdGlvbigpKTsKCiAgICAgICAgU3RyaW5nQnVmZmVyIGJ1ZiA9\nIG5ldyBTdHJpbmdCdWZmZXIoKTsKICAgICAgICBpZiAoZmsuZ2V0TmFtZSgp\nICE9IG51bGwKICAgICAgICAgICAgJiYgQ09OU19OQU1FX0JFRk9SRS5lcXVh\nbHMoY29uc3RyYWludE5hbWVNb2RlKSkKICAgICAgICAgICAgYnVmLmFwcGVu\nZCgiQ09OU1RSQUlOVCAiKS5hcHBlbmQoZmsuZ2V0TmFtZSgpKS5hcHBlbmQo\nIiAiKTsKICAgICAgICBidWYuYXBwZW5kKCJGT1JFSUdOIEtFWSAiKTsKICAg\nICAgICBpZiAoZmsuZ2V0TmFtZSgpICE9IG51bGwgJiYgQ09OU19OQU1FX01J\nRC5lcXVhbHMoY29uc3RyYWludE5hbWVNb2RlKSkKICAgICAgICAgICAgYnVm\nLmFwcGVuZChmay5nZXROYW1lKCkpLmFwcGVuZCgiICIpOwogICAgICAgIGJ1\nZi5hcHBlbmQoIigiKS5hcHBlbmQoU3RyaW5ncy5qb2luKGxvY2FscywgIiwg\nIikpLmFwcGVuZCgiKSIpOwogICAgICAgIGJ1Zi5hcHBlbmQoIiBSRUZFUkVO\nQ0VTICIpOwogICAgICAgIGJ1Zi5hcHBlbmQoZ2V0RnVsbE5hbWUoZm9yZWln\nbnNbMF0uZ2V0VGFibGUoKSwgZmFsc2UpKTsKICAgICAgICBidWYuYXBwZW5k\nKCIgKCIpLmFwcGVuZChTdHJpbmdzLmpvaW4oZm9yZWlnbnMsICIsICIpKS5h\ncHBlbmQoIikiKTsKICAgICAgICBpZiAoZGVsQWN0aW9uICE9IG51bGwpCiAg\nICAgICAgICAgIGJ1Zi5hcHBlbmQoIiBPTiBERUxFVEUgIikuYXBwZW5kKGRl\nbEFjdGlvbik7CiAgICAgICAgaWYgKHVwQWN0aW9uICE9IG51bGwpCiAgICAg\nICAgICAgIGJ1Zi5hcHBlbmQoIiBPTiBVUERBVEUgIikuYXBwZW5kKHVwQWN0\naW9uKTsKICAgICAgICBpZiAoZmsuaXNEZWZlcnJlZCgpKQogICAgICAgICAg\nICBidWYuYXBwZW5kKCIgSU5JVElBTExZIERFRkVSUkVEIik7CiAgICAgICAg\naWYgKHN1cHBvcnRzRGVmZXJyZWRGb3JlaWduS2V5Q29uc3RyYWludHMoKSkK\nICAgICAgICAgICAgYnVmLmFwcGVuZCgiIERFRkVSUkFCTEUiKTsKICAgICAg\nICBpZiAoZmsuZ2V0TmFtZSgpICE9IG51bGwKICAgICAgICAgICAgJiYgQ09O\nU19OQU1FX0FGVEVSLmVxdWFscyhjb25zdHJhaW50TmFtZU1vZGUpKQogICAg\nICAgICAgICBidWYuYXBwZW5kKCIgQ09OU1RSQUlOVCAiKS5hcHBlbmQoZmsu\nZ2V0TmFtZSgpKTsKICAgICAgICByZXR1cm4gYnVmLnRvU3RyaW5nKCk7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBXaGV0aGVyIG9yIG5vdCB0aGlzIGRpY3Rp\nb25hcnkgc3VwcG9ydHMgZGVmZXJyZWQgZm9yZWlnbiBrZXkgY29uc3RyYWlu\ndHMuCiAgICAgKiBUaGlzIGltcGxlbWVudGF0aW9uIHJldHVybnMge0BsaW5r\nICNzdXBwb3J0c1VuaXF1ZUNvbnN0cmFpbnRzfS4KICAgICAqCiAgICAgKiBA\nc2luY2UgMS4xLjAKICAgICAqLwogICAgcHJvdGVjdGVkIGJvb2xlYW4gc3Vw\ncG9ydHNEZWZlcnJlZEZvcmVpZ25LZXlDb25zdHJhaW50cygpIHsKICAgICAg\nICByZXR1cm4gc3VwcG9ydHNEZWZlcnJlZENvbnN0cmFpbnRzOwogICAgfQoK\nICAgIC8qKgogICAgICogUmV0dXJuIHRoZSBuYW1lIG9mIHRoZSBnaXZlbiBm\nb3JlaWduIGtleSBhY3Rpb24uCiAgICAgKi8KICAgIHByaXZhdGUgU3RyaW5n\nIGdldEFjdGlvbk5hbWUoaW50IGFjdGlvbikgewogICAgICAgIHN3aXRjaCAo\nYWN0aW9uKSB7CiAgICAgICAgICAgIGNhc2UgRm9yZWlnbktleS5BQ1RJT05f\nQ0FTQ0FERToKICAgICAgICAgICAgICAgIHJldHVybiAiQ0FTQ0FERSI7CiAg\nICAgICAgICAgIGNhc2UgRm9yZWlnbktleS5BQ1RJT05fTlVMTDoKICAgICAg\nICAgICAgICAgIHJldHVybiAiU0VUIE5VTEwiOwogICAgICAgICAgICBjYXNl\nIEZvcmVpZ25LZXkuQUNUSU9OX0RFRkFVTFQ6CiAgICAgICAgICAgICAgICBy\nZXR1cm4gIlNFVCBERUZBVUxUIjsKICAgICAgICAgICAgZGVmYXVsdDoKICAg\nICAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgIH0KICAgIH0KCiAg\nICAvKioKICAgICAqIFdoZXRoZXIgdGhpcyBkYXRhYmFzZSBzdXBwb3J0cyB0\naGUgZ2l2ZW4gZm9yZWlnbiBrZXkgZGVsZXRlIGFjdGlvbi4KICAgICAqLwog\nICAgcHVibGljIGJvb2xlYW4gc3VwcG9ydHNEZWxldGVBY3Rpb24oaW50IGFj\ndGlvbikgewogICAgICAgIGlmIChhY3Rpb24gPT0gRm9yZWlnbktleS5BQ1RJ\nT05fTk9ORSkKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgaWYg\nKCFzdXBwb3J0c0ZvcmVpZ25LZXlzKQogICAgICAgICAgICByZXR1cm4gZmFs\nc2U7CiAgICAgICAgc3dpdGNoIChhY3Rpb24pIHsKICAgICAgICAgICAgY2Fz\nZSBGb3JlaWduS2V5LkFDVElPTl9SRVNUUklDVDoKICAgICAgICAgICAgICAg\nIHJldHVybiBzdXBwb3J0c1Jlc3RyaWN0RGVsZXRlQWN0aW9uOwogICAgICAg\nICAgICBjYXNlIEZvcmVpZ25LZXkuQUNUSU9OX0NBU0NBREU6CiAgICAgICAg\nICAgICAgICByZXR1cm4gc3VwcG9ydHNDYXNjYWRlRGVsZXRlQWN0aW9uOwog\nICAgICAgICAgICBjYXNlIEZvcmVpZ25LZXkuQUNUSU9OX05VTEw6CiAgICAg\nICAgICAgICAgICByZXR1cm4gc3VwcG9ydHNOdWxsRGVsZXRlQWN0aW9uOwog\nICAgICAgICAgICBjYXNlIEZvcmVpZ25LZXkuQUNUSU9OX0RFRkFVTFQ6CiAg\nICAgICAgICAgICAgICByZXR1cm4gc3VwcG9ydHNEZWZhdWx0RGVsZXRlQWN0\naW9uOwogICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgICAgcmV0\ndXJuIGZhbHNlOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIFdo\nZXRoZXIgdGhpcyBkYXRhYmFzZSBzdXBwb3J0cyB0aGUgZ2l2ZW4gZm9yZWln\nbiBrZXkgdXBkYXRlIGFjdGlvbi4KICAgICAqLwogICAgcHVibGljIGJvb2xl\nYW4gc3VwcG9ydHNVcGRhdGVBY3Rpb24oaW50IGFjdGlvbikgewogICAgICAg\nIGlmIChhY3Rpb24gPT0gRm9yZWlnbktleS5BQ1RJT05fTk9ORSkKICAgICAg\nICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgaWYgKCFzdXBwb3J0c0ZvcmVp\nZ25LZXlzKQogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgc3dp\ndGNoIChhY3Rpb24pIHsKICAgICAgICAgICAgY2FzZSBGb3JlaWduS2V5LkFD\nVElPTl9SRVNUUklDVDoKICAgICAgICAgICAgICAgIHJldHVybiBzdXBwb3J0\nc1Jlc3RyaWN0VXBkYXRlQWN0aW9uOwogICAgICAgICAgICBjYXNlIEZvcmVp\nZ25LZXkuQUNUSU9OX0NBU0NBREU6CiAgICAgICAgICAgICAgICByZXR1cm4g\nc3VwcG9ydHNDYXNjYWRlVXBkYXRlQWN0aW9uOwogICAgICAgICAgICBjYXNl\nIEZvcmVpZ25LZXkuQUNUSU9OX05VTEw6CiAgICAgICAgICAgICAgICByZXR1\ncm4gc3VwcG9ydHNOdWxsVXBkYXRlQWN0aW9uOwogICAgICAgICAgICBjYXNl\nIEZvcmVpZ25LZXkuQUNUSU9OX0RFRkFVTFQ6CiAgICAgICAgICAgICAgICBy\nZXR1cm4gc3VwcG9ydHNEZWZhdWx0VXBkYXRlQWN0aW9uOwogICAgICAgICAg\nICBkZWZhdWx0OgogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAg\nICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgZGVjbGFy\nYXRpb24gU1FMIGZvciB0aGUgZ2l2ZW4gdW5pcXVlIGNvbnN0cmFpbnQuIFRo\naXMKICAgICAqIG1ldGhvZCBpcyB1c2VkIGZyb20gd2l0aGluIHtAbGluayAj\nZ2V0Q3JlYXRlVGFibGVTUUx9LgogICAgICogUmV0dXJucwk8Y29kZT5DT05T\nVFJBSU5UICZsdDtuYW1lJmd0OyBVTklRVUUgKCZsdDtjb2wgbGlzdCZndDsp\nPC9jb2RlPgogICAgICogYnkgZGVmYXVsdC4KICAgICAqLwogICAgcHJvdGVj\ndGVkIFN0cmluZyBnZXRVbmlxdWVDb25zdHJhaW50U1FMKFVuaXF1ZSB1bnEp\nIHsKICAgICAgICBpZiAoIXN1cHBvcnRzVW5pcXVlQ29uc3RyYWludHMKICAg\nICAgICAgICAgfHwgKHVucS5pc0RlZmVycmVkKCkgJiYgIXN1cHBvcnRzRGVm\nZXJyZWRVbmlxdWVDb25zdHJhaW50cygpKSkKICAgICAgICAgICAgcmV0dXJu\nIG51bGw7CgogICAgICAgIFN0cmluZ0J1ZmZlciBidWYgPSBuZXcgU3RyaW5n\nQnVmZmVyKCk7CiAgICAgICAgaWYgKHVucS5nZXROYW1lKCkgIT0gbnVsbAog\nICAgICAgICAgICAmJiBDT05TX05BTUVfQkVGT1JFLmVxdWFscyhjb25zdHJh\naW50TmFtZU1vZGUpKQogICAgICAgICAgICBidWYuYXBwZW5kKCJDT05TVFJB\nSU5UICIpLmFwcGVuZCh1bnEuZ2V0TmFtZSgpKS5hcHBlbmQoIiAiKTsKICAg\nICAgICBidWYuYXBwZW5kKCJVTklRVUUgIik7CiAgICAgICAgaWYgKHVucS5n\nZXROYW1lKCkgIT0gbnVsbCAmJiBDT05TX05BTUVfTUlELmVxdWFscyhjb25z\ndHJhaW50TmFtZU1vZGUpKQogICAgICAgICAgICBidWYuYXBwZW5kKHVucS5n\nZXROYW1lKCkpLmFwcGVuZCgiICIpOwogICAgICAgIGJ1Zi5hcHBlbmQoIigi\nKS5hcHBlbmQoU3RyaW5ncy5qb2luKHVucS5nZXRDb2x1bW5zKCksICIsICIp\nKS4KICAgICAgICAgICAgYXBwZW5kKCIpIik7CiAgICAgICAgaWYgKHVucS5p\nc0RlZmVycmVkKCkpCiAgICAgICAgICAgIGJ1Zi5hcHBlbmQoIiBJTklUSUFM\nTFkgREVGRVJSRUQiKTsKICAgICAgICBpZiAoc3VwcG9ydHNEZWZlcnJlZFVu\naXF1ZUNvbnN0cmFpbnRzKCkpCiAgICAgICAgICAgIGJ1Zi5hcHBlbmQoIiBE\nRUZFUlJBQkxFIik7CiAgICAgICAgaWYgKHVucS5nZXROYW1lKCkgIT0gbnVs\nbAogICAgICAgICAgICAmJiBDT05TX05BTUVfQUZURVIuZXF1YWxzKGNvbnN0\ncmFpbnROYW1lTW9kZSkpCiAgICAgICAgICAgIGJ1Zi5hcHBlbmQoIiBDT05T\nVFJBSU5UICIpLmFwcGVuZCh1bnEuZ2V0TmFtZSgpKTsKICAgICAgICByZXR1\ncm4gYnVmLnRvU3RyaW5nKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBXaGV0\naGVyIG9yIG5vdCB0aGlzIGRpY3Rpb25hcnkgc3VwcG9ydHMgZGVmZXJyZWQg\ndW5pcXVlIGNvbnN0cmFpbnRzLgogICAgICogVGhpcyBpbXBsZW1lbnRhdGlv\nbiByZXR1cm5zIHtAbGluayAjc3VwcG9ydHNVbmlxdWVDb25zdHJhaW50c30u\nCiAgICAgKgogICAgICogQHNpbmNlIDEuMS4wCiAgICAgKi8KICAgIHByb3Rl\nY3RlZCBib29sZWFuIHN1cHBvcnRzRGVmZXJyZWRVbmlxdWVDb25zdHJhaW50\ncygpIHsKICAgICAgICByZXR1cm4gc3VwcG9ydHNEZWZlcnJlZENvbnN0cmFp\nbnRzOwogICAgfQoKICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLwogICAgLy8g\nRGF0YWJhc2UgbWV0YWRhdGEKICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLwoK\nICAgIC8qKgogICAgICogVGhpcyBtZXRob2QgaXMgdXNlZCB0byBmaWx0ZXIg\nc3lzdGVtIHRhYmxlcyBmcm9tIGRhdGFiYXNlIG1ldGFkYXRhLgogICAgICog\nUmV0dXJuIHRydWUgaWYgdGhlIGdpdmVuIHRhYmxlIG5hbWUgcmVwcmVzZW50\ncyBhIHN5c3RlbSB0YWJsZSB0aGF0CiAgICAgKiBzaG91bGQgbm90IGFwcGVh\nciBpbiB0aGUgc2NoZW1hIGRlZmluaXRpb24uIEJ5IGRlZmF1bHQsIHJldHVy\nbnMKICAgICAqIHRydWUgb25seSBpZiB0aGUgZ2l2ZW4gdGFibGUgaXMgaW4g\ndGhlIGludGVybmFsIGxpc3Qgb2Ygc3lzdGVtIHRhYmxlcywKICAgICAqIG9y\nIGlmIHRoZSBnaXZlbiBzY2hlbWEgaXMgaW4gdGhlIGxpc3Qgb2Ygc3lzdGVt\nIHNjaGVtYXMgYW5kIGlzIG5vdAogICAgICogdGhlIHRhcmdldCBzY2hlbWEu\nCiAgICAgKgogICAgICogQHBhcmFtIG5hbWUgdGhlIHRhYmxlIG5hbWUKICAg\nICAqIEBwYXJhbSBzY2hlbWEgdGhlIHRhYmxlIHNjaGVtYTsgbWF5IGJlIG51\nbGwKICAgICAqIEBwYXJhbSB0YXJnZXRTY2hlbWEgaWYgdHJ1ZSwgdGhlbiB0\naGUgZ2l2ZW4gc2NoZW1hIHdhcyBsaXN0ZWQgYnkKICAgICAqIHRoZSB1c2Vy\nIGFzIG9uZSBvZiBoaXMgc2NoZW1hcwogICAgICovCiAgICBwdWJsaWMgYm9v\nbGVhbiBpc1N5c3RlbVRhYmxlKFN0cmluZyBuYW1lLCBTdHJpbmcgc2NoZW1h\nLAogICAgICAgIGJvb2xlYW4gdGFyZ2V0U2NoZW1hKSB7CiAgICAgICAgaWYg\nKHN5c3RlbVRhYmxlU2V0LmNvbnRhaW5zKG5hbWUudG9VcHBlckNhc2UoKSkp\nCiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIHJldHVybiAhdGFy\nZ2V0U2NoZW1hICYmIHNjaGVtYSAhPSBudWxsCiAgICAgICAgICAgICYmIHN5\nc3RlbVNjaGVtYVNldC5jb250YWlucyhzY2hlbWEudG9VcHBlckNhc2UoKSk7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBUaGlzIG1ldGhvZCBpcyB1c2VkIHRv\nIGZpbHRlciBzeXN0ZW0gaW5kZXhlcyBmcm9tIGRhdGFiYXNlIG1ldGFkYXRh\nLgogICAgICogUmV0dXJuIHRydWUgaWYgdGhlIGdpdmVuIGluZGV4IG5hbWUg\ncmVwcmVzZW50cyBhIHN5c3RlbSBpbmRleCB0aGF0CiAgICAgKiBzaG91bGQg\nbm90IGFwcGVhciBpbiB0aGUgc2NoZW1hIGRlZmluaXRpb24uIFJldHVybnMg\nZmFsc2UgYnkgZGVmYXVsdC4KICAgICAqCiAgICAgKiBAcGFyYW0gbmFtZSB0\naGUgaW5kZXggbmFtZQogICAgICogQHBhcmFtIHRhYmxlIHRoZSBpbmRleCB0\nYWJsZQogICAgICovCiAgICBwdWJsaWMgYm9vbGVhbiBpc1N5c3RlbUluZGV4\nKFN0cmluZyBuYW1lLCBUYWJsZSB0YWJsZSkgewogICAgICAgIHJldHVybiBm\nYWxzZTsKICAgIH0KCiAgICAvKioKICAgICAqIFRoaXMgbWV0aG9kIGlzIHVz\nZWQgdG8gZmlsdGVyIHN5c3RlbSBzZXF1ZW5jZXMgZnJvbSBkYXRhYmFzZSBt\nZXRhZGF0YS4KICAgICAqIFJldHVybiB0cnVlIGlmIHRoZSBnaXZlbiBzZXF1\nZW5jZSByZXByZXNlbnRzIGEgc3lzdGVtIHNlcXVlbmNlIHRoYXQKICAgICAq\nIHNob3VsZCBub3QgYXBwZWFyIGluIHRoZSBzY2hlbWEgZGVmaW5pdGlvbi4g\nUmV0dXJucyB0cnVlIGlmIHN5c3RlbQogICAgICogc2NoZW1hIGJ5IGRlZmF1\nbHQuCiAgICAgKgogICAgICogQHBhcmFtIG5hbWUgdGhlIHRhYmxlIG5hbWUK\nICAgICAqIEBwYXJhbSBzY2hlbWEgdGhlIHRhYmxlIHNjaGVtYTsgbWF5IGJl\nIG51bGwKICAgICAqIEBwYXJhbSB0YXJnZXRTY2hlbWEgaWYgdHJ1ZSwgdGhl\nbiB0aGUgZ2l2ZW4gc2NoZW1hIHdhcyBsaXN0ZWQgYnkKICAgICAqIHRoZSB1\nc2VyIGFzIG9uZSBvZiBoaXMgc2NoZW1hcwogICAgICovCiAgICBwdWJsaWMg\nYm9vbGVhbiBpc1N5c3RlbVNlcXVlbmNlKFN0cmluZyBuYW1lLCBTdHJpbmcg\nc2NoZW1hLAogICAgICAgIGJvb2xlYW4gdGFyZ2V0U2NoZW1hKSB7CiAgICAg\nICAgcmV0dXJuICF0YXJnZXRTY2hlbWEgJiYgc2NoZW1hICE9IG51bGwKICAg\nICAgICAgICAgJiYgc3lzdGVtU2NoZW1hU2V0LmNvbnRhaW5zKHNjaGVtYS50\nb1VwcGVyQ2FzZSgpKTsKICAgIH0KCiAgICAvKioKICAgICAqIFJlZmxlY3Qg\nb24gdGhlIHNjaGVtYSB0byBmaW5kIHRhYmxlcyBtYXRjaGluZyB0aGUgZ2l2\nZW4gbmFtZSBwYXR0ZXJuLgogICAgICovCiAgICBwdWJsaWMgVGFibGVbXSBn\nZXRUYWJsZXMoRGF0YWJhc2VNZXRhRGF0YSBtZXRhLCBTdHJpbmcgY2F0YWxv\nZywKICAgICAgICBTdHJpbmcgc2NoZW1hTmFtZSwgU3RyaW5nIHRhYmxlTmFt\nZSwgQ29ubmVjdGlvbiBjb25uKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRp\nb24gewogICAgICAgIGlmICghc3VwcG9ydHNTY2hlbWFGb3JHZXRUYWJsZXMp\nCiAgICAgICAgICAgIHNjaGVtYU5hbWUgPSBudWxsOwogICAgICAgIGVsc2UK\nICAgICAgICAgICAgc2NoZW1hTmFtZSA9IGdldFNjaGVtYU5hbWVGb3JNZXRh\nZGF0YShzY2hlbWFOYW1lKTsKCiAgICAgICAgU3RyaW5nW10gdHlwZXMgPSBT\ndHJpbmdzLnNwbGl0KHRhYmxlVHlwZXMsICIsIiwgMCk7CiAgICAgICAgZm9y\nIChpbnQgaSA9IDA7IGkgPCB0eXBlcy5sZW5ndGg7IGkrKykKICAgICAgICAg\nICAgdHlwZXNbaV0gPSB0eXBlc1tpXS50cmltKCk7CgogICAgICAgIGJlZm9y\nZU1ldGFkYXRhT3BlcmF0aW9uKGNvbm4pOwogICAgICAgIFJlc3VsdFNldCB0\nYWJsZXMgPSBudWxsOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIHRhYmxl\ncyA9IG1ldGEuZ2V0VGFibGVzKGdldENhdGFsb2dOYW1lRm9yTWV0YWRhdGEo\nY2F0YWxvZyksCiAgICAgICAgICAgICAgICBzY2hlbWFOYW1lLCBnZXRUYWJs\nZU5hbWVGb3JNZXRhZGF0YSh0YWJsZU5hbWUpLCB0eXBlcyk7CiAgICAgICAg\nICAgIExpc3QgdGFibGVMaXN0ID0gbmV3IEFycmF5TGlzdCgpOwogICAgICAg\nICAgICB3aGlsZSAodGFibGVzICE9IG51bGwgJiYgdGFibGVzLm5leHQoKSkK\nICAgICAgICAgICAgICAgIHRhYmxlTGlzdC5hZGQobmV3VGFibGUodGFibGVz\nKSk7CiAgICAgICAgICAgIHJldHVybiAoVGFibGVbXSkgdGFibGVMaXN0LnRv\nQXJyYXkobmV3IFRhYmxlW3RhYmxlTGlzdC5zaXplKCldKTsKICAgICAgICB9\nIGZpbmFsbHkgewogICAgICAgICAgICBpZiAodGFibGVzICE9IG51bGwpCiAg\nICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgIHRhYmxl\ncy5jbG9zZSgpOwogICAgICAgICAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9u\nIGUpIHsKICAgICAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAg\nLyoqCiAgICAgKiBDcmVhdGUgYSBuZXcgdGFibGUgZnJvbSB0aGUgaW5mb3Jt\nYXRpb24gaW4gdGhlIHNjaGVtYSBtZXRhZGF0YS4KICAgICAqLwogICAgcHJv\ndGVjdGVkIFRhYmxlIG5ld1RhYmxlKFJlc3VsdFNldCB0YWJsZU1ldGEpCiAg\nICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgVGFibGUgdCA9\nIG5ldyBUYWJsZSgpOwogICAgICAgIHQuc2V0TmFtZSh0YWJsZU1ldGEuZ2V0\nU3RyaW5nKCJUQUJMRV9OQU1FIikpOwogICAgICAgIHJldHVybiB0OwogICAg\nfQoKICAgIC8qKgogICAgICogUmVmbGVjdCBvbiB0aGUgc2NoZW1hIHRvIGZp\nbmQgc2VxdWVuY2VzIG1hdGNoaW5nIHRoZSBnaXZlbiBuYW1lIHBhdHRlcm4u\nCiAgICAgKiBSZXR1cm5zIGFuIGVtcHR5IGFycmF5IGJ5IGRlZmF1bHQsIGFz\nIHRoZXJlIGlzIG5vIHN0YW5kYXJkIHdheSB0bwogICAgICogcmV0cmlldmUg\nYSBsaXN0IG9mIHNlcXVlbmNlcy4KICAgICAqLwogICAgcHVibGljIFNlcXVl\nbmNlW10gZ2V0U2VxdWVuY2VzKERhdGFiYXNlTWV0YURhdGEgbWV0YSwgU3Ry\naW5nIGNhdGFsb2csCiAgICAgICAgU3RyaW5nIHNjaGVtYU5hbWUsIFN0cmlu\nZyBzZXF1ZW5jZU5hbWUsIENvbm5lY3Rpb24gY29ubikKICAgICAgICB0aHJv\nd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBTdHJpbmcgc3RyID0gZ2V0U2Vx\ndWVuY2VzU1FMKHNjaGVtYU5hbWUsIHNlcXVlbmNlTmFtZSk7CiAgICAgICAg\naWYgKHN0ciA9PSBudWxsKQogICAgICAgICAgICByZXR1cm4gbmV3IFNlcXVl\nbmNlWzBdOwoKICAgICAgICBQcmVwYXJlZFN0YXRlbWVudCBzdG1udCA9IHBy\nZXBhcmVTdGF0ZW1lbnQoY29ubiwgc3RyKTsgICAgICAgIAogICAgICAgIFJl\nc3VsdFNldCBycyA9IG51bGw7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAg\naW50IGlkeCA9IDE7CiAgICAgICAgICAgIGlmIChzY2hlbWFOYW1lICE9IG51\nbGwpCiAgICAgICAgICAgICAgICBzdG1udC5zZXRTdHJpbmcoaWR4KyssIHNj\naGVtYU5hbWUudG9VcHBlckNhc2UoKSk7CiAgICAgICAgICAgIGlmIChzZXF1\nZW5jZU5hbWUgIT0gbnVsbCkKICAgICAgICAgICAgICAgIHN0bW50LnNldFN0\ncmluZyhpZHgrKywgc2VxdWVuY2VOYW1lKTsKCiAgICAgICAgICAgIHJzID0g\nZXhlY3V0ZVF1ZXJ5KGNvbm4sIHN0bW50LCBzdHIpOwogICAgICAgICAgICBy\nZXR1cm4gZ2V0U2VxdWVuY2UocnMpOyAgICAgICAgICAgIAogICAgICAgICB9\nIGZpbmFsbHkgewogICAgICAgICAgICBpZiAocnMgIT0gbnVsbCkKICAgICAg\nICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgcnMuY2xvc2Uo\nKTsKICAgICAgICAgICAgICAgIH0gY2F0Y2ggKFNRTEV4Y2VwdGlvbiBzZSkg\newogICAgICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoc3RtbnQgIT0g\nbnVsbCkgICAgCiAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAg\nICAgICAgIHN0bW50LmNsb3NlKCk7CiAgICAgICAgICAgICAgICB9IGNhdGNo\nIChTUUxFeGNlcHRpb24gc2UpIHsKICAgICAgICAgICAgICAgIH0KICAgICAg\nICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBDcmVhdGUgYSBuZXcgc2VxdWVu\nY2UgZnJvbSB0aGUgaW5mb3JtYXRpb24gaW4gdGhlIHNjaGVtYSBtZXRhZGF0\nYS4KICAgICAqLwogICAgcHJvdGVjdGVkIFNlcXVlbmNlIG5ld1NlcXVlbmNl\nKFJlc3VsdFNldCBzZXF1ZW5jZU1ldGEpCiAgICAgICAgdGhyb3dzIFNRTEV4\nY2VwdGlvbiB7CiAgICAgICAgU2VxdWVuY2Ugc2VxID0gbmV3IFNlcXVlbmNl\nKCk7CiAgICAgICAgc2VxLnNldFNjaGVtYU5hbWUoc2VxdWVuY2VNZXRhLmdl\ndFN0cmluZygiU0VRVUVOQ0VfU0NIRU1BIikpOwogICAgICAgIHNlcS5zZXRO\nYW1lKHNlcXVlbmNlTWV0YS5nZXRTdHJpbmcoIlNFUVVFTkNFX05BTUUiKSk7\nCiAgICAgICAgcmV0dXJuIHNlcTsKICAgIH0KCiAgICAvKioKICAgICAqIFJl\ndHVybiB0aGUgU1FMIG5lZWRlZCB0byBzZWxlY3QgdGhlIGxpc3Qgb2Ygc2Vx\ndWVuY2VzLgogICAgICovCiAgICBwcm90ZWN0ZWQgU3RyaW5nIGdldFNlcXVl\nbmNlc1NRTChTdHJpbmcgc2NoZW1hTmFtZSwgU3RyaW5nIHNlcXVlbmNlTmFt\nZSkgewogICAgICAgIHJldHVybiBudWxsOwogICAgfQoKICAgIC8qKgogICAg\nICogUmVmbGVjdCBvbiB0aGUgc2NoZW1hIHRvIGZpbmQgY29sdW1ucyBtYXRj\naGluZyB0aGUgZ2l2ZW4gdGFibGUgYW5kCiAgICAgKiBjb2x1bW4gcGF0dGVy\nbnMuCiAgICAgKi8KICAgIHB1YmxpYyBDb2x1bW5bXSBnZXRDb2x1bW5zKERh\ndGFiYXNlTWV0YURhdGEgbWV0YSwgU3RyaW5nIGNhdGFsb2csCiAgICAgICAg\nU3RyaW5nIHNjaGVtYU5hbWUsIFN0cmluZyB0YWJsZU5hbWUsIFN0cmluZyBj\nb2x1bW5OYW1lLCBDb25uZWN0aW9uIGNvbm4pCiAgICAgICAgdGhyb3dzIFNR\nTEV4Y2VwdGlvbiB7CiAgICAgICAgaWYgKHRhYmxlTmFtZSA9PSBudWxsICYm\nICFzdXBwb3J0c051bGxUYWJsZUZvckdldENvbHVtbnMpCiAgICAgICAgICAg\nIHJldHVybiBudWxsOwoKICAgICAgICBpZiAoIXN1cHBvcnRzU2NoZW1hRm9y\nR2V0Q29sdW1ucykKICAgICAgICAgICAgc2NoZW1hTmFtZSA9IG51bGw7CiAg\nICAgICAgZWxzZQogICAgICAgICAgICBzY2hlbWFOYW1lID0gZ2V0U2NoZW1h\nTmFtZUZvck1ldGFkYXRhKHNjaGVtYU5hbWUpOwoKICAgICAgICBiZWZvcmVN\nZXRhZGF0YU9wZXJhdGlvbihjb25uKTsKICAgICAgICBSZXN1bHRTZXQgY29s\ncyA9IG51bGw7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgY29scyA9IG1l\ndGEuZ2V0Q29sdW1ucyhnZXRDYXRhbG9nTmFtZUZvck1ldGFkYXRhKGNhdGFs\nb2cpLAogICAgICAgICAgICAgICAgc2NoZW1hTmFtZSwgZ2V0VGFibGVOYW1l\nRm9yTWV0YWRhdGEodGFibGVOYW1lKSwKICAgICAgICAgICAgICAgIGdldENv\nbHVtbk5hbWVGb3JNZXRhZGF0YShjb2x1bW5OYW1lKSk7CgogICAgICAgICAg\nICBMaXN0IGNvbHVtbkxpc3QgPSBuZXcgQXJyYXlMaXN0KCk7CiAgICAgICAg\nICAgIHdoaWxlIChjb2xzICE9IG51bGwgJiYgY29scy5uZXh0KCkpCiAgICAg\nICAgICAgICAgICBjb2x1bW5MaXN0LmFkZChuZXdDb2x1bW4oY29scykpOwog\nICAgICAgICAgICByZXR1cm4gKENvbHVtbltdKSBjb2x1bW5MaXN0LnRvQXJy\nYXkKICAgICAgICAgICAgICAgIChuZXcgQ29sdW1uW2NvbHVtbkxpc3Quc2l6\nZSgpXSk7CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgaWYgKGNv\nbHMgIT0gbnVsbCkKICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAg\nICAgICAgICAgY29scy5jbG9zZSgpOwogICAgICAgICAgICAgICAgfSBjYXRj\naCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgICAgIH0KICAgICAgICB9\nCiAgICB9CgogICAgLyoqCiAgICAgKiBDcmVhdGUgYSBuZXcgY29sdW1uIGZy\nb20gdGhlIGluZm9ybWF0aW9uIGluIHRoZSBzY2hlbWEgbWV0YWRhdGEuCiAg\nICAgKi8KICAgIHByb3RlY3RlZCBDb2x1bW4gbmV3Q29sdW1uKFJlc3VsdFNl\ndCBjb2xNZXRhKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAg\nICAgIENvbHVtbiBjID0gbmV3IENvbHVtbigpOwogICAgICAgIGMuc2V0U2No\nZW1hTmFtZShjb2xNZXRhLmdldFN0cmluZygiVEFCTEVfU0NIRU0iKSk7CiAg\nICAgICAgYy5zZXRUYWJsZU5hbWUoY29sTWV0YS5nZXRTdHJpbmcoIlRBQkxF\nX05BTUUiKSk7CiAgICAgICAgYy5zZXROYW1lKGNvbE1ldGEuZ2V0U3RyaW5n\nKCJDT0xVTU5fTkFNRSIpKTsKICAgICAgICBjLnNldFR5cGUoY29sTWV0YS5n\nZXRJbnQoIkRBVEFfVFlQRSIpKTsKICAgICAgICBjLnNldFR5cGVOYW1lKGNv\nbE1ldGEuZ2V0U3RyaW5nKCJUWVBFX05BTUUiKSk7CiAgICAgICAgYy5zZXRT\naXplKGNvbE1ldGEuZ2V0SW50KCJDT0xVTU5fU0laRSIpKTsKICAgICAgICBj\nLnNldERlY2ltYWxEaWdpdHMoY29sTWV0YS5nZXRJbnQoIkRFQ0lNQUxfRElH\nSVRTIikpOwogICAgICAgIGMuc2V0Tm90TnVsbChjb2xNZXRhLmdldEludCgi\nTlVMTEFCTEUiKQogICAgICAgICAgICA9PSBEYXRhYmFzZU1ldGFEYXRhLmNv\nbHVtbk5vTnVsbHMpOwoKICAgICAgICBTdHJpbmcgZGVmID0gY29sTWV0YS5n\nZXRTdHJpbmcoIkNPTFVNTl9ERUYiKTsKICAgICAgICBpZiAoIVN0cmluZ1V0\naWxzLmlzRW1wdHkoZGVmKSAmJiAhIm51bGwiLmVxdWFsc0lnbm9yZUNhc2Uo\nZGVmKSkKICAgICAgICAgICAgYy5zZXREZWZhdWx0U3RyaW5nKGRlZik7CiAg\nICAgICAgcmV0dXJuIGM7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZWZsZWN0\nIG9uIHRoZSBzY2hlbWEgdG8gZmluZCBwcmltYXJ5IGtleXMgZm9yIHRoZSBn\naXZlbiB0YWJsZSBwYXR0ZXJuLgogICAgICovCiAgICBwdWJsaWMgUHJpbWFy\neUtleVtdIGdldFByaW1hcnlLZXlzKERhdGFiYXNlTWV0YURhdGEgbWV0YSwK\nICAgICAgICBTdHJpbmcgY2F0YWxvZywgU3RyaW5nIHNjaGVtYU5hbWUsIFN0\ncmluZyB0YWJsZU5hbWUsIENvbm5lY3Rpb24gY29ubikKICAgICAgICB0aHJv\nd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBpZiAodXNlR2V0QmVzdFJvd0lk\nZW50aWZpZXJGb3JQcmltYXJ5S2V5cykKICAgICAgICAgICAgcmV0dXJuIGdl\ndFByaW1hcnlLZXlzRnJvbUJlc3RSb3dJZGVudGlmaWVyKG1ldGEsIGNhdGFs\nb2csCiAgICAgICAgICAgICAgICBzY2hlbWFOYW1lLCB0YWJsZU5hbWUsIGNv\nbm4pOwogICAgICAgIHJldHVybiBnZXRQcmltYXJ5S2V5c0Zyb21HZXRQcmlt\nYXJ5S2V5cyhtZXRhLCBjYXRhbG9nLAogICAgICAgICAgICBzY2hlbWFOYW1l\nLCB0YWJsZU5hbWUsIGNvbm4pOwogICAgfQoKICAgIC8qKgogICAgICogUmVm\nbGVjdCBvbiB0aGUgc2NoZW1hIHRvIGZpbmQgcHJpbWFyeSBrZXlzIGZvciB0\naGUgZ2l2ZW4gdGFibGUgcGF0dGVybi4KICAgICAqLwogICAgcHJvdGVjdGVk\nIFByaW1hcnlLZXlbXSBnZXRQcmltYXJ5S2V5c0Zyb21HZXRQcmltYXJ5S2V5\ncwogICAgICAgIChEYXRhYmFzZU1ldGFEYXRhIG1ldGEsIFN0cmluZyBjYXRh\nbG9nLCBTdHJpbmcgc2NoZW1hTmFtZSwKICAgICAgICAgICAgU3RyaW5nIHRh\nYmxlTmFtZSwgQ29ubmVjdGlvbiBjb25uKQogICAgICAgIHRocm93cyBTUUxF\neGNlcHRpb24gewogICAgICAgIGlmICh0YWJsZU5hbWUgPT0gbnVsbCAmJiAh\nc3VwcG9ydHNOdWxsVGFibGVGb3JHZXRQcmltYXJ5S2V5cykKICAgICAgICAg\nICAgcmV0dXJuIG51bGw7CgogICAgICAgIGJlZm9yZU1ldGFkYXRhT3BlcmF0\naW9uKGNvbm4pOwogICAgICAgIFJlc3VsdFNldCBwa3MgPSBudWxsOwogICAg\nICAgIHRyeSB7CiAgICAgICAgICAgIHBrcyA9IG1ldGEuZ2V0UHJpbWFyeUtl\neXMoZ2V0Q2F0YWxvZ05hbWVGb3JNZXRhZGF0YShjYXRhbG9nKSwKICAgICAg\nICAgICAgICAgIGdldFNjaGVtYU5hbWVGb3JNZXRhZGF0YShzY2hlbWFOYW1l\nKSwKICAgICAgICAgICAgICAgIGdldFRhYmxlTmFtZUZvck1ldGFkYXRhKHRh\nYmxlTmFtZSkpOwoKICAgICAgICAgICAgTGlzdCBwa0xpc3QgPSBuZXcgQXJy\nYXlMaXN0KCk7CiAgICAgICAgICAgIHdoaWxlIChwa3MgIT0gbnVsbCAmJiBw\na3MubmV4dCgpKQogICAgICAgICAgICAgICAgcGtMaXN0LmFkZChuZXdQcmlt\nYXJ5S2V5KHBrcykpOwogICAgICAgICAgICByZXR1cm4gKFByaW1hcnlLZXlb\nXSkgcGtMaXN0LnRvQXJyYXkKICAgICAgICAgICAgICAgIChuZXcgUHJpbWFy\neUtleVtwa0xpc3Quc2l6ZSgpXSk7CiAgICAgICAgfSBmaW5hbGx5IHsKICAg\nICAgICAgICAgaWYgKHBrcyAhPSBudWxsKQogICAgICAgICAgICAgICAgdHJ5\nIHsKICAgICAgICAgICAgICAgICAgICBwa3MuY2xvc2UoKTsKICAgICAgICAg\nICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgICAg\nICB9CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogQ3JlYXRlIGEg\nbmV3IHByaW1hcnkga2V5IGZyb20gdGhlIGluZm9ybWF0aW9uIGluIHRoZSBz\nY2hlbWEgbWV0YWRhdGEuCiAgICAgKi8KICAgIHByb3RlY3RlZCBQcmltYXJ5\nS2V5IG5ld1ByaW1hcnlLZXkoUmVzdWx0U2V0IHBrTWV0YSkKICAgICAgICB0\naHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBQcmltYXJ5S2V5IHBrID0g\nbmV3IFByaW1hcnlLZXkoKTsKICAgICAgICBway5zZXRTY2hlbWFOYW1lKHBr\nTWV0YS5nZXRTdHJpbmcoIlRBQkxFX1NDSEVNIikpOwogICAgICAgIHBrLnNl\ndFRhYmxlTmFtZShwa01ldGEuZ2V0U3RyaW5nKCJUQUJMRV9OQU1FIikpOwog\nICAgICAgIHBrLnNldENvbHVtbk5hbWUocGtNZXRhLmdldFN0cmluZygiQ09M\nVU1OX05BTUUiKSk7CiAgICAgICAgcGsuc2V0TmFtZShwa01ldGEuZ2V0U3Ry\naW5nKCJQS19OQU1FIikpOwogICAgICAgIHJldHVybiBwazsKICAgIH0KCiAg\nICAvKioKICAgICAqIFJlZmxlY3Qgb24gdGhlIHNjaGVtYSB0byBmaW5kIHBy\naW1hcnkga2V5cyBmb3IgdGhlIGdpdmVuIHRhYmxlIHBhdHRlcm4uCiAgICAg\nKi8KICAgIHByb3RlY3RlZCBQcmltYXJ5S2V5W10gZ2V0UHJpbWFyeUtleXNG\ncm9tQmVzdFJvd0lkZW50aWZpZXIKICAgICAgICAoRGF0YWJhc2VNZXRhRGF0\nYSBtZXRhLCBTdHJpbmcgY2F0YWxvZywgU3RyaW5nIHNjaGVtYU5hbWUsCiAg\nICAgICAgICAgIFN0cmluZyB0YWJsZU5hbWUsIENvbm5lY3Rpb24gY29ubikK\nICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBpZiAodGFi\nbGVOYW1lID09IG51bGwpCiAgICAgICAgICAgIHJldHVybiBudWxsOwoKICAg\nICAgICBiZWZvcmVNZXRhZGF0YU9wZXJhdGlvbihjb25uKTsKICAgICAgICBS\nZXN1bHRTZXQgcGtzID0gbnVsbDsKICAgICAgICB0cnkgewogICAgICAgICAg\nICBwa3MgPSBtZXRhLmdldEJlc3RSb3dJZGVudGlmaWVyKGNhdGFsb2csIHNj\naGVtYU5hbWUsCiAgICAgICAgICAgICAgICB0YWJsZU5hbWUsIDAsIGZhbHNl\nKTsKCiAgICAgICAgICAgIExpc3QgcGtMaXN0ID0gbmV3IEFycmF5TGlzdCgp\nOwogICAgICAgICAgICB3aGlsZSAocGtzICE9IG51bGwgJiYgcGtzLm5leHQo\nKSkgewogICAgICAgICAgICAgICAgUHJpbWFyeUtleSBwayA9IG5ldyBQcmlt\nYXJ5S2V5KCk7CiAgICAgICAgICAgICAgICBway5zZXRTY2hlbWFOYW1lKHNj\naGVtYU5hbWUpOwogICAgICAgICAgICAgICAgcGsuc2V0VGFibGVOYW1lKHRh\nYmxlTmFtZSk7CiAgICAgICAgICAgICAgICBway5zZXRDb2x1bW5OYW1lKHBr\ncy5nZXRTdHJpbmcoIkNPTFVNTl9OQU1FIikpOwogICAgICAgICAgICAgICAg\ncGtMaXN0LmFkZChwayk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0\ndXJuIChQcmltYXJ5S2V5W10pIHBrTGlzdC50b0FycmF5CiAgICAgICAgICAg\nICAgICAobmV3IFByaW1hcnlLZXlbcGtMaXN0LnNpemUoKV0pOwogICAgICAg\nIH0gZmluYWxseSB7CiAgICAgICAgICAgIGlmIChwa3MgIT0gbnVsbCkKICAg\nICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgcGtzLmNs\nb3NlKCk7CiAgICAgICAgICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkg\newogICAgICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICAvKioK\nICAgICAqIFJlZmxlY3Qgb24gdGhlIHNjaGVtYSB0byBmaW5kIGluZGV4ZXMg\nbWF0Y2hpbmcgdGhlIGdpdmVuIHRhYmxlIHBhdHRlcm4uCiAgICAgKi8KICAg\nIHB1YmxpYyBJbmRleFtdIGdldEluZGV4SW5mbyhEYXRhYmFzZU1ldGFEYXRh\nIG1ldGEsIFN0cmluZyBjYXRhbG9nLAogICAgICAgIFN0cmluZyBzY2hlbWFO\nYW1lLCBTdHJpbmcgdGFibGVOYW1lLCBib29sZWFuIHVuaXF1ZSwKICAgICAg\nICBib29sZWFuIGFwcHJveCwgQ29ubmVjdGlvbiBjb25uKQogICAgICAgIHRo\ncm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIGlmICh0YWJsZU5hbWUgPT0g\nbnVsbCAmJiAhc3VwcG9ydHNOdWxsVGFibGVGb3JHZXRJbmRleEluZm8pCiAg\nICAgICAgICAgIHJldHVybiBudWxsOwoKICAgICAgICBiZWZvcmVNZXRhZGF0\nYU9wZXJhdGlvbihjb25uKTsKICAgICAgICBSZXN1bHRTZXQgaW5kZXhlcyA9\nIG51bGw7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgaW5kZXhlcyA9IG1l\ndGEuZ2V0SW5kZXhJbmZvKGdldENhdGFsb2dOYW1lRm9yTWV0YWRhdGEoY2F0\nYWxvZyksCiAgICAgICAgICAgICAgICBnZXRTY2hlbWFOYW1lRm9yTWV0YWRh\ndGEoc2NoZW1hTmFtZSksCiAgICAgICAgICAgICAgICBnZXRUYWJsZU5hbWVG\nb3JNZXRhZGF0YSh0YWJsZU5hbWUpLCB1bmlxdWUsIGFwcHJveCk7CgogICAg\nICAgICAgICBMaXN0IGluZGV4TGlzdCA9IG5ldyBBcnJheUxpc3QoKTsKICAg\nICAgICAgICAgd2hpbGUgKGluZGV4ZXMgIT0gbnVsbCAmJiBpbmRleGVzLm5l\neHQoKSkKICAgICAgICAgICAgICAgIGluZGV4TGlzdC5hZGQobmV3SW5kZXgo\naW5kZXhlcykpOwogICAgICAgICAgICByZXR1cm4gKEluZGV4W10pIGluZGV4\nTGlzdC50b0FycmF5KG5ldyBJbmRleFtpbmRleExpc3Quc2l6ZSgpXSk7CiAg\nICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgaWYgKGluZGV4ZXMgIT0g\nbnVsbCkKICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAg\nICAgaW5kZXhlcy5jbG9zZSgpOwogICAgICAgICAgICAgICAgfSBjYXRjaCAo\nRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgICAgIH0KICAgICAgICB9CiAg\nICB9CgogICAgLyoqCiAgICAgKiBDcmVhdGUgYSBuZXcgaW5kZXggZnJvbSB0\naGUgaW5mb3JtYXRpb24gaW4gdGhlIHNjaGVtYSBtZXRhZGF0YS4KICAgICAq\nLwogICAgcHJvdGVjdGVkIEluZGV4IG5ld0luZGV4KFJlc3VsdFNldCBpZHhN\nZXRhKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIElu\nZGV4IGlkeCA9IG5ldyBJbmRleCgpOwogICAgICAgIGlkeC5zZXRTY2hlbWFO\nYW1lKGlkeE1ldGEuZ2V0U3RyaW5nKCJUQUJMRV9TQ0hFTSIpKTsKICAgICAg\nICBpZHguc2V0VGFibGVOYW1lKGlkeE1ldGEuZ2V0U3RyaW5nKCJUQUJMRV9O\nQU1FIikpOwogICAgICAgIGlkeC5zZXRDb2x1bW5OYW1lKGlkeE1ldGEuZ2V0\nU3RyaW5nKCJDT0xVTU5fTkFNRSIpKTsKICAgICAgICBpZHguc2V0TmFtZShp\nZHhNZXRhLmdldFN0cmluZygiSU5ERVhfTkFNRSIpKTsKICAgICAgICBpZHgu\nc2V0VW5pcXVlKCFpZHhNZXRhLmdldEJvb2xlYW4oIk5PTl9VTklRVUUiKSk7\nCiAgICAgICAgcmV0dXJuIGlkeDsKICAgIH0KCiAgICAvKioKICAgICAqIFJl\nZmxlY3Qgb24gdGhlIHNjaGVtYSB0byByZXR1cm4gZm9yZWlnbiBrZXlzIGlt\ncG9ydGVkIGJ5IHRoZSBnaXZlbgogICAgICogdGFibGUgcGF0dGVybi4KICAg\nICAqLwogICAgcHVibGljIEZvcmVpZ25LZXlbXSBnZXRJbXBvcnRlZEtleXMo\nRGF0YWJhc2VNZXRhRGF0YSBtZXRhLCBTdHJpbmcgY2F0YWxvZywKICAgICAg\nICBTdHJpbmcgc2NoZW1hTmFtZSwgU3RyaW5nIHRhYmxlTmFtZSwgQ29ubmVj\ndGlvbiBjb25uKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAg\nICAgIGlmICghc3VwcG9ydHNGb3JlaWduS2V5cykKICAgICAgICAgICAgcmV0\ndXJuIG51bGw7CiAgICAgICAgaWYgKHRhYmxlTmFtZSA9PSBudWxsICYmICFz\ndXBwb3J0c051bGxUYWJsZUZvckdldEltcG9ydGVkS2V5cykKICAgICAgICAg\nICAgcmV0dXJuIG51bGw7CgogICAgICAgIGJlZm9yZU1ldGFkYXRhT3BlcmF0\naW9uKGNvbm4pOwogICAgICAgIFJlc3VsdFNldCBrZXlzID0gbnVsbDsKICAg\nICAgICB0cnkgewogICAgICAgICAgICBrZXlzID0gbWV0YS5nZXRJbXBvcnRl\nZEtleXMoZ2V0Q2F0YWxvZ05hbWVGb3JNZXRhZGF0YShjYXRhbG9nKSwKICAg\nICAgICAgICAgICAgIGdldFNjaGVtYU5hbWVGb3JNZXRhZGF0YShzY2hlbWFO\nYW1lKSwKICAgICAgICAgICAgICAgIGdldFRhYmxlTmFtZUZvck1ldGFkYXRh\nKHRhYmxlTmFtZSkpOwoKICAgICAgICAgICAgTGlzdCBpbXBvcnRlZEtleUxp\nc3QgPSBuZXcgQXJyYXlMaXN0KCk7CiAgICAgICAgICAgIHdoaWxlIChrZXlz\nICE9IG51bGwgJiYga2V5cy5uZXh0KCkpCiAgICAgICAgICAgICAgICBpbXBv\ncnRlZEtleUxpc3QuYWRkKG5ld0ZvcmVpZ25LZXkoa2V5cykpOwogICAgICAg\nICAgICByZXR1cm4gKEZvcmVpZ25LZXlbXSkgaW1wb3J0ZWRLZXlMaXN0LnRv\nQXJyYXkKICAgICAgICAgICAgICAgIChuZXcgRm9yZWlnbktleVtpbXBvcnRl\nZEtleUxpc3Quc2l6ZSgpXSk7CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAg\nICAgICAgaWYgKGtleXMgIT0gbnVsbCkKICAgICAgICAgICAgICAgIHRyeSB7\nCiAgICAgICAgICAgICAgICAgICAga2V5cy5jbG9zZSgpOwogICAgICAgICAg\nICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgICAg\nIH0KICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBDcmVhdGUgYSBu\nZXcgZm9yZWlnbiBrZXkgZnJvbSB0aGUgaW5mb3JtYXRpb24gaW4gdGhlIHNj\naGVtYSBtZXRhZGF0YS4KICAgICAqLwogICAgcHJvdGVjdGVkIEZvcmVpZ25L\nZXkgbmV3Rm9yZWlnbktleShSZXN1bHRTZXQgZmtNZXRhKQogICAgICAgIHRo\ncm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIEZvcmVpZ25LZXkgZmsgPSBu\nZXcgRm9yZWlnbktleSgpOwogICAgICAgIGZrLnNldFNjaGVtYU5hbWUoZmtN\nZXRhLmdldFN0cmluZygiRktUQUJMRV9TQ0hFTSIpKTsKICAgICAgICBmay5z\nZXRUYWJsZU5hbWUoZmtNZXRhLmdldFN0cmluZygiRktUQUJMRV9OQU1FIikp\nOwogICAgICAgIGZrLnNldENvbHVtbk5hbWUoZmtNZXRhLmdldFN0cmluZygi\nRktDT0xVTU5fTkFNRSIpKTsKICAgICAgICBmay5zZXROYW1lKGZrTWV0YS5n\nZXRTdHJpbmcoIkZLX05BTUUiKSk7CiAgICAgICAgZmsuc2V0UHJpbWFyeUtl\neVNjaGVtYU5hbWUoZmtNZXRhLmdldFN0cmluZygiUEtUQUJMRV9TQ0hFTSIp\nKTsKICAgICAgICBmay5zZXRQcmltYXJ5S2V5VGFibGVOYW1lKGZrTWV0YS5n\nZXRTdHJpbmcoIlBLVEFCTEVfTkFNRSIpKTsKICAgICAgICBmay5zZXRQcmlt\nYXJ5S2V5Q29sdW1uTmFtZShma01ldGEuZ2V0U3RyaW5nKCJQS0NPTFVNTl9O\nQU1FIikpOwogICAgICAgIGZrLnNldEtleVNlcXVlbmNlKGZrTWV0YS5nZXRT\naG9ydCgiS0VZX1NFUSIpKTsKICAgICAgICBmay5zZXREZWZlcnJlZChma01l\ndGEuZ2V0U2hvcnQoIkRFRkVSUkFCSUxJVFkiKQogICAgICAgICAgICA9PSBE\nYXRhYmFzZU1ldGFEYXRhLmltcG9ydGVkS2V5SW5pdGlhbGx5RGVmZXJyZWQp\nOwoKICAgICAgICBpbnQgZGVsID0gZmtNZXRhLmdldFNob3J0KCJERUxFVEVf\nUlVMRSIpOwogICAgICAgIHN3aXRjaCAoZGVsKSB7CiAgICAgICAgICAgIGNh\nc2UgRGF0YWJhc2VNZXRhRGF0YS5pbXBvcnRlZEtleVNldE51bGw6CiAgICAg\nICAgICAgICAgICBmay5zZXREZWxldGVBY3Rpb24oRm9yZWlnbktleS5BQ1RJ\nT05fTlVMTCk7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAg\nY2FzZSBEYXRhYmFzZU1ldGFEYXRhLmltcG9ydGVkS2V5U2V0RGVmYXVsdDoK\nICAgICAgICAgICAgICAgIGZrLnNldERlbGV0ZUFjdGlvbihGb3JlaWduS2V5\nLkFDVElPTl9ERUZBVUxUKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAg\nICAgICAgICBjYXNlIERhdGFiYXNlTWV0YURhdGEuaW1wb3J0ZWRLZXlDYXNj\nYWRlOgogICAgICAgICAgICAgICAgZmsuc2V0RGVsZXRlQWN0aW9uKEZvcmVp\nZ25LZXkuQUNUSU9OX0NBU0NBREUpOwogICAgICAgICAgICAgICAgYnJlYWs7\nCiAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgICBmay5zZXRE\nZWxldGVBY3Rpb24oRm9yZWlnbktleS5BQ1RJT05fUkVTVFJJQ1QpOwogICAg\nICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICAgIHJldHVybiBm\nazsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybnMgdGhlIHRhYmxlIG5h\nbWUgdGhhdCB3aWxsIGJlIHVzZWQgZm9yIG9idGFpbmluZyBpbmZvcm1hdGlv\nbgogICAgICogZnJvbSB7QGxpbmsgRGF0YWJhc2VNZXRhRGF0YX0uCiAgICAg\nKi8KICAgIHByb3RlY3RlZCBTdHJpbmcgZ2V0VGFibGVOYW1lRm9yTWV0YWRh\ndGEoU3RyaW5nIHRhYmxlTmFtZSkgewogICAgICAgIHJldHVybiBjb252ZXJ0\nU2NoZW1hQ2FzZSh0YWJsZU5hbWUpOwogICAgfQoKICAgIC8qKgogICAgICog\nUmV0dXJucyB0aGUgc2NoZW1hIG5hbWUgdGhhdCB3aWxsIGJlIHVzZWQgZm9y\nIG9idGFpbmluZyBpbmZvcm1hdGlvbgogICAgICogZnJvbSB7QGxpbmsgRGF0\nYWJhc2VNZXRhRGF0YX0uCiAgICAgKi8KICAgIHByb3RlY3RlZCBTdHJpbmcg\nZ2V0U2NoZW1hTmFtZUZvck1ldGFkYXRhKFN0cmluZyBzY2hlbWFOYW1lKSB7\nCiAgICAgICAgaWYgKHNjaGVtYU5hbWUgPT0gbnVsbCkKICAgICAgICAgICAg\nc2NoZW1hTmFtZSA9IGNvbmYuZ2V0U2NoZW1hKCk7CiAgICAgICAgcmV0dXJu\nIGNvbnZlcnRTY2hlbWFDYXNlKHNjaGVtYU5hbWUpOwogICAgfQoKICAgIC8q\nKgogICAgICogUmV0dXJucyB0aGUgY2F0YWxvZyBuYW1lIHRoYXQgd2lsbCBi\nZSB1c2VkIGZvciBvYnRhaW5pbmcgaW5mb3JtYXRpb24KICAgICAqIGZyb20g\ne0BsaW5rIERhdGFiYXNlTWV0YURhdGF9LgogICAgICovCiAgICBwcm90ZWN0\nZWQgU3RyaW5nIGdldENhdGFsb2dOYW1lRm9yTWV0YWRhdGEoU3RyaW5nIGNh\ndGFsb2dOYW1lKSB7CiAgICAgICAgcmV0dXJuIGNvbnZlcnRTY2hlbWFDYXNl\nKGNhdGFsb2dOYW1lKTsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybnMg\ndGhlIGNvbHVtbiBuYW1lIHRoYXQgd2lsbCBiZSB1c2VkIGZvciBvYnRhaW5p\nbmcgaW5mb3JtYXRpb24KICAgICAqIGZyb20ge0BsaW5rIERhdGFiYXNlTWV0\nYURhdGF9LgogICAgICovCiAgICBwcm90ZWN0ZWQgU3RyaW5nIGdldENvbHVt\nbk5hbWVGb3JNZXRhZGF0YShTdHJpbmcgY29sdW1uTmFtZSkgewogICAgICAg\nIHJldHVybiBjb252ZXJ0U2NoZW1hQ2FzZShjb2x1bW5OYW1lKTsKICAgIH0K\nCiAgICAvKioKICAgICAqIENvbnZlcnQgdGhlIHNwZWNpZmllZCBzY2hlbWEg\nbmFtZSB0byBhIG5hbWUgdGhhdCB0aGUgZGF0YWJhc2Ugd2lsbAogICAgICog\nYmUgYWJsZSB0byB1bmRlcnN0YW5kLgogICAgICovCiAgICBwcm90ZWN0ZWQg\nU3RyaW5nIGNvbnZlcnRTY2hlbWFDYXNlKFN0cmluZyBvYmplY3ROYW1lKSB7\nCiAgICAgICAgaWYgKG9iamVjdE5hbWUgPT0gbnVsbCkKICAgICAgICAgICAg\ncmV0dXJuIG51bGw7CgogICAgICAgIFN0cmluZyBzY2FzZSA9IGdldFNjaGVt\nYUNhc2UoKTsKICAgICAgICBpZiAoU0NIRU1BX0NBU0VfTE9XRVIuZXF1YWxz\nKHNjYXNlKSkKICAgICAgICAgICAgcmV0dXJuIG9iamVjdE5hbWUudG9Mb3dl\nckNhc2UoKTsKICAgICAgICBpZiAoU0NIRU1BX0NBU0VfUFJFU0VSVkUuZXF1\nYWxzKHNjYXNlKSkKICAgICAgICAgICAgcmV0dXJuIG9iamVjdE5hbWU7CiAg\nICAgICAgcmV0dXJuIG9iamVjdE5hbWUudG9VcHBlckNhc2UoKTsKICAgIH0K\nICAgIAogICAgLyoqCiAgICAgKiBSZXR1cm4gREIgc3BlY2lmaWMgc2NoZW1h\nQ2FzZSAKICAgICAqLwogICAgcHVibGljIFN0cmluZyBnZXRTY2hlbWFDYXNl\nKCl7CiAgICAgICAgcmV0dXJuIHNjaGVtYUNhc2U7CiAgICB9CiAgICAgICAg\nCiAgICAvKioKICAgICAqIFByZXBhcmVkIHRoZSBjb25uZWN0aW9uIGZvciBt\nZXRhZGF0YSBvcGVyYXRpb25zLgogICAgICovCiAgICBwcml2YXRlIHZvaWQg\nYmVmb3JlTWV0YWRhdGFPcGVyYXRpb24oQ29ubmVjdGlvbiBjKSB7CiAgICAg\nICAgaWYgKHJlcXVpcmVzQXV0b0NvbW1pdEZvck1ldGFEYXRhKSB7CiAgICAg\nICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBjLnJvbGxiYWNrKCk7CiAg\nICAgICAgICAgIH0gY2F0Y2ggKFNRTEV4Y2VwdGlvbiBzcWxlKSB7CiAgICAg\nICAgICAgIH0KICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIGlm\nICghYy5nZXRBdXRvQ29tbWl0KCkpCiAgICAgICAgICAgICAgICAgICAgYy5z\nZXRBdXRvQ29tbWl0KHRydWUpOwogICAgICAgICAgICB9IGNhdGNoIChTUUxF\neGNlcHRpb24gc3FsZSkgewogICAgICAgICAgICB9CiAgICAgICAgfQogICAg\nfQoKICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgICAvLyBT\nZXF1ZW5jZXMgYW5kIEF1dG8tQXNzaWduCiAgICAvLy8vLy8vLy8vLy8vLy8v\nLy8vLy8vLy8vLy8vLwoKICAgIC8qKgogICAgICogUmV0dXJuIHRoZSBsYXN0\nIGdlbmVyYXRlZCB2YWx1ZSBmb3IgdGhlIGdpdmVuIGNvbHVtbi4KICAgICAq\nIFRocm93cyBhbiBleGNlcHRpb24gYnkgZGVmYXVsdCBpZiB7QGxpbmsgI2xh\nc3RHZW5lcmF0ZWRLZXlRdWVyeX0gaXMgbnVsbC4KICAgICAqLwogICAgcHVi\nbGljIE9iamVjdCBnZXRHZW5lcmF0ZWRLZXkoQ29sdW1uIGNvbCwgQ29ubmVj\ndGlvbiBjb25uKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAg\nICAgIGlmIChsYXN0R2VuZXJhdGVkS2V5UXVlcnkgPT0gbnVsbCkKICAgICAg\nICAgICAgdGhyb3cgbmV3IFN0b3JlRXhjZXB0aW9uKF9sb2MuZ2V0KCJuby1h\ndXRvLWFzc2lnbiIpKTsKCiAgICAgICAgLy8gcmVwbGFjZSB0aGluZ3MgbGlr\nZSAiU0VMRUNUIE1BWCh7MH0pIEZST00gezF9IgogICAgICAgIFN0cmluZyBx\ndWVyeSA9IGxhc3RHZW5lcmF0ZWRLZXlRdWVyeTsKICAgICAgICBpZiAocXVl\ncnkuaW5kZXhPZigneycpICE9IC0xKSAvLyBvbmx5IGlmIHRoZSB0b2tlbiBp\ncyBpbiB0aGUgc3RyaW5nCiAgICAgICAgewogICAgICAgICAgICBxdWVyeSA9\nIE1lc3NhZ2VGb3JtYXQuZm9ybWF0KHF1ZXJ5LCBuZXcgT2JqZWN0W117CiAg\nICAgICAgICAgICAgICBjb2wuZ2V0TmFtZSgpLCBnZXRGdWxsTmFtZShjb2wu\nZ2V0VGFibGUoKSwgZmFsc2UpLAogICAgICAgICAgICAgICAgZ2V0R2VuZXJh\ndGVkS2V5U2VxdWVuY2VOYW1lKGNvbCksCiAgICAgICAgICAgIH0pOwogICAg\nICAgIH0KCiAgICAgICAgUHJlcGFyZWRTdGF0ZW1lbnQgc3RtbnQgPSBwcmVw\nYXJlU3RhdGVtZW50KGNvbm4sIHF1ZXJ5KTsKICAgICAgICBSZXN1bHRTZXQg\ncnMgPSBudWxsOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIHJzID0gZXhl\nY3V0ZVF1ZXJ5KGNvbm4sIHN0bW50LCBxdWVyeSk7CiAgICAgICAgICAgIHJl\ndHVybiBnZXRLZXkocnMsIGNvbCk7CiAgICAgICAgfSBmaW5hbGx5IHsKICAg\nICAgICAgICAgaWYgKHJzICE9IG51bGwpCiAgICAgICAgICAgICAgICB0cnkg\neyBycy5jbG9zZSgpOyB9IGNhdGNoIChTUUxFeGNlcHRpb24gc2UpIHt9CiAg\nICAgICAgICAgIGlmIChzdG1udCAhPSBudWxsKSAgICAKICAgICAgICAgICAg\nICAgIHRyeSB7IHN0bW50LmNsb3NlKCk7IH0gY2F0Y2ggKFNRTEV4Y2VwdGlv\nbiBzZSkge30gCiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogUmV0\ndXJuIHRoZSBzZXF1ZW5jZSBuYW1lIHVzZWQgYnkgZGF0YWJhc2VzIGZvciB0\naGUgZ2l2ZW4gYXV0b2Fzc2lnbmVkCiAgICAgKiBjb2x1bW4uIFRoaXMgaXMg\nb25seSB1c2VkIGJ5IGRhdGFiYXNlcyB0aGF0IHJlcXVpcmUgYW4gZXhwbGlj\naXQgbmFtZQogICAgICogdG8gYmUgdXNlZCBmb3IgYXV0by1hc3NpZ24gc3Vw\ncG9ydC4KICAgICAqLwogICAgcHJvdGVjdGVkIFN0cmluZyBnZXRHZW5lcmF0\nZWRLZXlTZXF1ZW5jZU5hbWUoQ29sdW1uIGNvbCkgewogICAgICAgIFN0cmlu\nZyB0bmFtZSA9IGNvbC5nZXRUYWJsZU5hbWUoKTsKICAgICAgICBTdHJpbmcg\nY25hbWUgPSBjb2wuZ2V0TmFtZSgpOwogICAgICAgIGludCBtYXggPSBtYXhB\ndXRvQXNzaWduTmFtZUxlbmd0aDsKICAgICAgICBpbnQgZXh0cmFDaGFycyA9\nIC1tYXggKyB0bmFtZS5sZW5ndGgoKSArIDEgLy8gPHRuYW1lPiArICdfJwog\nICAgICAgICAgICArIGNuYW1lLmxlbmd0aCgpICsgNDsgLy8gPGNuYW1lPiAr\nICdfU0VRJwogICAgICAgIGlmIChleHRyYUNoYXJzID4gMCkgewogICAgICAg\nICAgICAvLyB0aGlzIGFzc3VtZXMgdGhhdCB0bmFtZSBpcyBsb25nZXIgdGhh\nbiBleHRyYUNoYXJzCiAgICAgICAgICAgIHRuYW1lID0gdG5hbWUuc3Vic3Ry\naW5nKDAsIHRuYW1lLmxlbmd0aCgpIC0gZXh0cmFDaGFycyk7CiAgICAgICAg\nfQogICAgICAgIFN0cmluZ0J1ZmZlciBidWYgPSBuZXcgU3RyaW5nQnVmZmVy\nKG1heCk7CiAgICAgICAgYnVmLmFwcGVuZCh0bmFtZSkuYXBwZW5kKCJfIiku\nYXBwZW5kKGNuYW1lKS5hcHBlbmQoIl9TRVEiKTsKICAgICAgICByZXR1cm4g\nYnVmLnRvU3RyaW5nKCk7CiAgICB9CgogICAgLy8vLy8vLy8vLy8vLy8vLy8v\nLy8vLy8vLy8vLy8vLwogICAgLy8gQ29uZmlndXJhYmxlIGltcGxlbWVudGF0\naW9uCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCgogICAg\ncHVibGljIHZvaWQgc2V0Q29uZmlndXJhdGlvbihDb25maWd1cmF0aW9uIGNv\nbmYpIHsKICAgICAgICB0aGlzLmNvbmYgPSAoSkRCQ0NvbmZpZ3VyYXRpb24p\nIGNvbmY7CiAgICAgICAgdGhpcy5sb2cgPSB0aGlzLmNvbmYuZ2V0TG9nKEpE\nQkNDb25maWd1cmF0aW9uLkxPR19KREJDKTsKCiAgICAgICAgLy8gd2FybiBh\nYm91dCB1bnN1cHBvcnRlZCBkaWN0cwogICAgICAgIGlmIChsb2cuaXNXYXJu\nRW5hYmxlZCgpICYmICFpc1N1cHBvcnRlZCgpKQogICAgICAgICAgICBsb2cu\nd2FybihfbG9jLmdldCgiZGljdC1ub3Qtc3VwcG9ydGVkIiwgZ2V0Q2xhc3Mo\nKSkpOwogICAgfQoKICAgIHByaXZhdGUgYm9vbGVhbiBpc1N1cHBvcnRlZCgp\nIHsKICAgICAgICAvLyBpZiB0aGlzIGlzIGEgY3VzdG9tIGRpY3QsIHRyYXZl\ncnNlIHRvIHdoYXRldmVyIG9wZW5qcGEgZGljdCBpdCBleHRlbmRzCiAgICAg\nICAgQ2xhc3MgYyA9IGdldENsYXNzKCk7CiAgICAgICAgd2hpbGUgKCFjLmdl\ndE5hbWUoKS5zdGFydHNXaXRoKCJvcmcuYXBhY2hlLm9wZW5qcGEuIikpCiAg\nICAgICAgICAgIGMgPSBjLmdldFN1cGVyY2xhc3MoKTsKCiAgICAgICAgLy8g\ndGhlIGdlbmVyaWMgZGJkaWN0aW9uYXJ5IGlzIG5vdCBjb25zaWRlcmVkIGEg\nc3VwcG9ydGVkIGRpY3Q7IGFsbAogICAgICAgIC8vIG90aGVyIGNvbmNyZXRl\nIGRpY3Rpb25hcmllcyBhcmUKICAgICAgICBpZiAoYyA9PSBEQkRpY3Rpb25h\ncnkuY2xhc3MpCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICBy\nZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzdGFydENvbmZp\nZ3VyYXRpb24oKSB7CiAgICB9CgogICAgcHVibGljIHZvaWQgZW5kQ29uZmln\ndXJhdGlvbigpIHsKICAgICAgICAvLyBpbml0aWFsaXplIHRoZSBzZXQgb2Yg\ncmVzZXJ2ZWQgU1FMOTIgd29yZHMgZnJvbSByZXNvdXJjZQogICAgICAgIElu\ncHV0U3RyZWFtIGluID0gREJEaWN0aW9uYXJ5LmNsYXNzLmdldFJlc291cmNl\nQXNTdHJlYW0KICAgICAgICAgICAgKCJzcWwta2V5d29yZHMucnNyYyIpOwog\nICAgICAgIHRyeSB7CiAgICAgICAgICAgIFN0cmluZyBrZXl3b3JkcyA9IG5l\ndyBCdWZmZXJlZFJlYWRlcihuZXcgSW5wdXRTdHJlYW1SZWFkZXIoaW4pKS4K\nICAgICAgICAgICAgICAgIHJlYWRMaW5lKCk7CiAgICAgICAgICAgIGluLmNs\nb3NlKCk7CiAgICAgICAgICAgIHJlc2VydmVkV29yZFNldC5hZGRBbGwoQXJy\nYXlzLmFzTGlzdChTdHJpbmdzLnNwbGl0CiAgICAgICAgICAgICAgICAoa2V5\nd29yZHMsICIsIiwgMCkpKTsKICAgICAgICB9IGNhdGNoIChJT0V4Y2VwdGlv\nbiBpb2UpIHsKICAgICAgICAgICAgdGhyb3cgbmV3IEdlbmVyYWxFeGNlcHRp\nb24oaW9lKTsKICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICB0cnkg\neyBpbi5jbG9zZSgpOyB9IGNhdGNoIChJT0V4Y2VwdGlvbiBlKSB7fQogICAg\nICAgIH0KCiAgICAgICAgLy8gYWRkIGFkZGl0aW9uYWwgcmVzZXJ2ZWQgd29y\nZHMgc2V0IGJ5IHVzZXIKICAgICAgICBpZiAocmVzZXJ2ZWRXb3JkcyAhPSBu\ndWxsKQogICAgICAgICAgICByZXNlcnZlZFdvcmRTZXQuYWRkQWxsKEFycmF5\ncy5hc0xpc3QoU3RyaW5ncy5zcGxpdAogICAgICAgICAgICAgICAgKHJlc2Vy\ndmVkV29yZHMudG9VcHBlckNhc2UoKSwgIiwiLCAwKSkpOwoKICAgICAgICAv\nLyBhZGQgc3lzdGVtIHNjaGVtYXMgc2V0IGJ5IHVzZXIKICAgICAgICBpZiAo\nc3lzdGVtU2NoZW1hcyAhPSBudWxsKQogICAgICAgICAgICBzeXN0ZW1TY2hl\nbWFTZXQuYWRkQWxsKEFycmF5cy5hc0xpc3QoU3RyaW5ncy5zcGxpdAogICAg\nICAgICAgICAgICAgKHN5c3RlbVNjaGVtYXMudG9VcHBlckNhc2UoKSwgIiwi\nLCAwKSkpOwoKICAgICAgICAvLyBhZGQgc3lzdGVtIHRhYmxlcyBzZXQgYnkg\ndXNlcgogICAgICAgIGlmIChzeXN0ZW1UYWJsZXMgIT0gbnVsbCkKICAgICAg\nICAgICAgc3lzdGVtVGFibGVTZXQuYWRkQWxsKEFycmF5cy5hc0xpc3QoU3Ry\naW5ncy5zcGxpdAogICAgICAgICAgICAgICAgKHN5c3RlbVRhYmxlcy50b1Vw\ncGVyQ2FzZSgpLCAiLCIsIDApKSk7CgogICAgICAgIC8vIGFkZCBmaXhlZCBz\naXplIHR5cGUgbmFtZXMgc2V0IGJ5IHRoZSB1c2VyCiAgICAgICAgaWYgKGZp\neGVkU2l6ZVR5cGVOYW1lcyAhPSBudWxsKQogICAgICAgICAgICBmaXhlZFNp\nemVUeXBlTmFtZVNldC5hZGRBbGwoQXJyYXlzLmFzTGlzdChTdHJpbmdzLnNw\nbGl0CiAgICAgICAgICAgICAgICAoZml4ZWRTaXplVHlwZU5hbWVzLnRvVXBw\nZXJDYXNlKCksICIsIiwgMCkpKTsKICAgICAgICAKICAgICAgICAvLyBpZiB1\nc2VyIGhhcyB1bnNldCBzZXF1ZW5jZSBzcWwsIG51bGwgaXQgb3V0IHNvIHdl\nIGtub3cgc2VxdWVuY2VzCiAgICAgICAgLy8gYXJlbid0IHN1cHBvcnRlZAog\nICAgICAgIG5leHRTZXF1ZW5jZVF1ZXJ5ID0gU3RyaW5nVXRpbHMudHJpbVRv\nTnVsbChuZXh0U2VxdWVuY2VRdWVyeSk7CiAgICAgICAgCiAgICAgICAgaWYg\nKHNlbGVjdFdvcmRzICE9IG51bGwpCiAgICAgICAgICAgIHNlbGVjdFdvcmRT\nZXQuYWRkQWxsKEFycmF5cy5hc0xpc3QoU3RyaW5ncy5zcGxpdChzZWxlY3RX\nb3JkcwogICAgICAgICAgICAgICAgICAgIC50b1VwcGVyQ2FzZSgpLCAiLCIs\nIDApKSk7CiAgICB9CgogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v\nLy8vLy8vLy8vLy8KICAgIC8vIENvbm5lY3Rpb25EZWNvcmF0b3IgaW1wbGVt\nZW50YXRpb24KICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v\nLy8vLy8vCgogICAgLyoqCiAgICAgKiBEZWNvcmF0ZSB0aGUgZ2l2ZW4gY29u\nbmVjdGlvbiBpZiBuZWVkZWQuIFNvbWUgZGF0YWJhc2VzIHJlcXVpcmUgc3Bl\nY2lhbAogICAgICogaGFuZGxpbmcgZm9yIEpEQkMgYnVncy4gVGhpcyBpbXBs\nZW1lbnRhdGlvbiBpc3N1ZXMgYW55CiAgICAgKiB7QGxpbmsgI2luaXRpYWxp\nemF0aW9uU1FMfSB0aGF0IGhhcyBiZWVuIHNldCBmb3IgdGhlIGRpY3Rpb25h\ncnkgYnV0CiAgICAgKiBkb2VzIG5vdCBkZWNvcmVhdGUgdGhlIGNvbm5lY3Rp\nb24uCiAgICAgKi8KICAgIHB1YmxpYyBDb25uZWN0aW9uIGRlY29yYXRlKENv\nbm5lY3Rpb24gY29ubikKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsK\nICAgICAgICBpZiAoIWNvbm5lY3RlZCkKICAgICAgICAgICAgY29ubmVjdGVk\nQ29uZmlndXJhdGlvbihjb25uKTsKICAgICAgICBpZiAoIVN0cmluZ1V0aWxz\nLmlzRW1wdHkoaW5pdGlhbGl6YXRpb25TUUwpKSB7CiAgICAgICAgICAgIFBy\nZXBhcmVkU3RhdGVtZW50IHN0bW50ID0gbnVsbDsKICAgICAgICAgICAgdHJ5\nIHsKICAgICAgICAgICAgICAgIHN0bW50ID0gY29ubi5wcmVwYXJlU3RhdGVt\nZW50KGluaXRpYWxpemF0aW9uU1FMKTsKICAgICAgICAgICAgICAgIHN0bW50\nLmV4ZWN1dGUoKTsKICAgICAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUp\nIHsKICAgICAgICAgICAgICAgIGlmIChsb2cuaXNUcmFjZUVuYWJsZWQoKSkK\nICAgICAgICAgICAgICAgICAgICBsb2cudHJhY2UoZS50b1N0cmluZygpLCBl\nKTsKICAgICAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgICAgIGlm\nIChzdG1udCAhPSBudWxsKQogICAgICAgICAgICAgICAgICAgIHRyeSB7CiAg\nICAgICAgICAgICAgICAgICAgICAgIHN0bW50LmNsb3NlKCk7CiAgICAgICAg\nICAgICAgICAgICAgfSBjYXRjaCAoU1FMRXhjZXB0aW9uIHNlKSB7CiAgICAg\nICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAg\nICAgIHJldHVybiBjb25uOwogICAgfQoKICAgIC8qKgogICAgICogSW1wbGVt\nZW50YXRpb24gb2YgdGhlCiAgICAgKiB7QGxpbmsgTG9nZ2luZ0Nvbm5lY3Rp\nb25EZWNvcmF0b3IuU1FMV2FybmluZ0hhbmRsZXJ9IGludGVyZmFjZQogICAg\nICogdGhhdCBhbGxvd3MgY3VzdG9taXphdGlvbiBvZiB0aGUgYWN0aW9ucyB0\nbyBwZXJmb3JtIHdoZW4gYQogICAgICoge0BsaW5rIFNRTFdhcm5pbmd9IG9j\nY3VycyBhdCBhbnkgcG9pbnQgb24gYSB7QGxpbmsgQ29ubmVjdGlvbn0sCiAg\nICAgKiB7QGxpbmsgU3RhdGVtZW50fSwgb3Ige0BsaW5rIFJlc3VsdFNldH0u\nIFRoaXMgbWV0aG9kIG1heQogICAgICogYmUgdXNlZCBkZXRlcm1pbmUgdGhv\nc2Ugd2FybmluZ3MgdGhlIGFwcGxpY2F0aW9uIHdhbnRzIHRvCiAgICAgKiBj\nb25zaWRlciBjcml0aWNhbCBmYWlsdXJlcywgYW5kIHRocm93IHRoZSB3YXJu\naW5nIGluIHRob3NlCiAgICAgKiBjYXNlcy4gQnkgZGVmYXVsdCwgdGhpcyBt\nZXRob2QgZG9lcyBub3RoaW5nLgogICAgICoKICAgICAqIEBzZWUgTG9nZ2lu\nZ0Nvbm5lY3Rpb25EZWNvcmF0b3Ijc2V0V2FybmluZ0FjdGlvbgogICAgICog\nQHNlZSBMb2dnaW5nQ29ubmVjdGlvbkRlY29yYXRvciNzZXRXYXJuaW5nSGFu\nZGxlcgogICAgICovCiAgICBwdWJsaWMgdm9pZCBoYW5kbGVXYXJuaW5nKFNR\nTFdhcm5pbmcgd2FybmluZykKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9u\nIHsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiBhIG5ldyBleGNlcHRp\nb24gdGhhdCB3cmFwcyA8Y29kZT5jYXVzZXM8L2NvZGU+LgogICAgICogSG93\nZXZlciwgdGhlIGRldGFpbHMgb2YgZXhhY3RseSB3aGF0IHR5cGUgb2YgZXhj\nZXB0aW9uIGlzIHJldHVybmVkIGNhbgogICAgICogYmUgZGV0ZXJtaW5lZCBi\neSB0aGUgaW1wbGVtZW50YXRpb24uIFRoaXMgbWF5IHRha2UgaW50byBhY2Nv\ndW50CiAgICAgKiBEQi1zcGVjaWZpYyBleGNlcHRpb24gaW5mb3JtYXRpb24g\naW4gPGNvZGU+Y2F1c2VzPC9jb2RlPi4KICAgICAqLwogICAgcHVibGljIE9w\nZW5KUEFFeGNlcHRpb24gbmV3U3RvcmVFeGNlcHRpb24oU3RyaW5nIG1zZywg\nU1FMRXhjZXB0aW9uW10gY2F1c2VzLAogICAgICAgIE9iamVjdCBmYWlsZWQp\nIHsKICAgIAlpZiAoY2F1c2VzICE9IG51bGwgJiYgY2F1c2VzLmxlbmd0aCA+\nIDApIHsKICAgIAkJT3BlbkpQQUV4Y2VwdGlvbiByZXQgPSBTUUxFeGNlcHRp\nb25zLm5hcnJvdyhtc2csIGNhdXNlc1swXSwgdGhpcyk7CiAgICAJCXJldC5z\nZXRGYWlsZWRPYmplY3QoZmFpbGVkKS5zZXROZXN0ZWRUaHJvd2FibGVzKGNh\ndXNlcyk7CiAgICAJCXJldHVybiByZXQ7CiAgICAJfQogICAgICAgIHJldHVy\nbiBuZXcgU3RvcmVFeGNlcHRpb24obXNnKS5zZXRGYWlsZWRPYmplY3QoZmFp\nbGVkKS4KICAgICAgICAgICAgc2V0TmVzdGVkVGhyb3dhYmxlcyhjYXVzZXMp\nOwogICAgfQogICAgCiAgICAvKioKICAgICAqIEdldHMgdGhlIGxpc3Qgb2Yg\nU3RyaW5nLCBlYWNoIHJlcHJlc2VudHMgYW4gZXJyb3IgdGhhdCBjYW4gaGVs\ncCAKICAgICAqIHRvIG5hcnJvdyBkb3duIGEgU1FMIGV4Y2VwdGlvbiB0byBz\ncGVjaWZpYyB0eXBlIG9mIFN0b3JlRXhjZXB0aW9uLjxicj4KICAgICAqIEZv\nciBleGFtcGxlLCBlcnJvciBjb2RlIDxjb2RlPiIyMzAwMCI8L2NvZGU+IHJl\ncHJlc2VudHMgcmVmZXJlbnRpYWwKICAgICAqIGludGVncml0eSB2aW9sYXRp\nb24gYW5kIGhlbmNlIGNhbiBiZSBuYXJyb3dlZCBkb3duIHRvIAogICAgICog\ne0BsaW5rIFJlZmVyZW50aWFsSW50ZWdyaXR5RXhjZXB0aW9ufSByYXRoZXIg\ndGhhbiBtb3JlIGdlbmVyYWwKICAgICAqIHtAbGluayBTdG9yZUV4Y2VwdGlv\nbn0uPGJyPgogICAgICogSkRCQyBEcml2ZXJzIGFyZSBub3QgdW5pZm9ybSBp\nbiByZXR1cm4gdmFsdWVzIG9mIFNRTFN0YXRlIGZvciB0aGUgc2FtZQogICAg\nICogZXJyb3IgYW5kIGhlbmNlIGVhY2ggZGF0YWJhc2Ugc3BlY2lmaWMgRGlj\ndGlvbmFyeSBjYW4gc3BlY2lhbGl6ZS48YnI+CiAgICAgKiAKICAgICAqIAog\nICAgICogQHJldHVybiBhbiA8ZW0+dW5tb2RpZmlhYmxlPC9lbT4gbGlzdCBv\nZiBTdHJpbmdzIHJlcHJlc2VudGluZyBzdXBwb3NlZGx5IAogICAgICogdW5p\nZm9ybSBTUUwgU3RhdGVzIGZvciBhIGdpdmVuIHR5cGUgb2YgU3RvcmVFeGNl\ncHRpb24uIAogICAgICogRGVmYXVsdCBiZWhhdmlvciBpcyB0byByZXR1cm4g\nYW4gZW1wdHkgbGlzdC4KICAgICAqLwogICAgcHVibGljIExpc3QvKjxTdHJp\nbmc+Ki8gZ2V0U1FMU3RhdGVzKGludCBleGNlcHRpb25UeXBlKSB7CiAgICAJ\naWYgKGV4Y2VwdGlvblR5cGU+PTAgJiYgZXhjZXB0aW9uVHlwZTxTUUxfU1RB\nVEVfQ09ERVMubGVuZ3RoKQogICAgCQlyZXR1cm4gU1FMX1NUQVRFX0NPREVT\nW2V4Y2VwdGlvblR5cGVdOwogICAgCXJldHVybiBFTVBUWV9TVFJJTkdfTElT\nVDsKICAgIH0KCiAgICAvKioKICAgICAqIENsb3NlcyB0aGUgc3BlY2lmaWVk\nIHtAbGluayBEYXRhU291cmNlfSBhbmQgcmVsZWFzZXMgYW55CiAgICAgKiBy\nZXNvdXJjZXMgYXNzb2NpYXRlZCB3aXRoIGl0LgogICAgICoKICAgICAqIEBw\nYXJhbSBkYXRhU291cmNlIHRoZSBEYXRhU291cmNlIHRvIGNsb3NlCiAgICAg\nKi8KICAgIHB1YmxpYyB2b2lkIGNsb3NlRGF0YVNvdXJjZShEYXRhU291cmNl\nIGRhdGFTb3VyY2UpIHsKICAgICAgICBEYXRhU291cmNlRmFjdG9yeS5jbG9z\nZURhdGFTb3VyY2UoZGF0YVNvdXJjZSk7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBVc2VkIGJ5IHNvbWUgbWFwcGluZ3MgdG8gcmVwcmVzZW50IGRhdGEgdGhh\ndCBoYXMgYWxyZWFkeSBiZWVuCiAgICAgKiBzZXJpYWxpemVkIHNvIHRoYXQg\nd2UgZG9uJ3QgaGF2ZSB0byBzZXJpYWxpemUgbXVsdGlwbGUgdGltZXMuCiAg\nICAgKi8KICAgIHB1YmxpYyBzdGF0aWMgY2xhc3MgU2VyaWFsaXplZERhdGEg\newoKICAgICAgICBwdWJsaWMgZmluYWwgYnl0ZVtdIGJ5dGVzOwoKICAgICAg\nICBwdWJsaWMgU2VyaWFsaXplZERhdGEoYnl0ZVtdIGJ5dGVzKSB7CiAgICAg\nICAgICAgIHRoaXMuYnl0ZXMgPSBieXRlczsKICAgICAgICB9CiAgICB9CiAg\nICAKICAgIC8qKgogICAgICogUmV0dXJuIHZlcnNpb24gY29sdW1uIG5hbWUK\nICAgICAqIEBwYXJhbSBjb2x1bW4KICAgICAqIEBwYXJhbSB0YWJsZUFsaWFz\nIDogdGhpcyBpcyBuZWVkZWQgZm9yIHBsYXRmb3JtIHNwZWNpZmljIHZlcnNp\nb24gY29sdW1uCiAgICAgKiBAcmV0dXJuCiAgICAgKi8KICAgIHB1YmxpYyBT\ndHJpbmcgZ2V0VmVyc2lvbkNvbHVtbihDb2x1bW4gY29sdW1uLCBTdHJpbmcg\ndGFibGVBbGlhcykgewogICAgICAgIHJldHVybiBjb2x1bW4udG9TdHJpbmco\nKTsKICAgIH0KICAgIAogICAgcHVibGljIHZvaWQgaW5zZXJ0QmxvYkZvclN0\ncmVhbWluZ0xvYWQoUm93IHJvdywgQ29sdW1uIGNvbCwgCiAgICAgICAgSkRC\nQ1N0b3JlIHN0b3JlLCBPYmplY3Qgb2IsIFNlbGVjdCBzZWwpIHRocm93cyBT\nUUxFeGNlcHRpb24gewogICAgICAgIGlmIChvYiAhPSBudWxsKSB7CiAgICAg\nICAgICAgIHJvdy5zZXRCaW5hcnlTdHJlYW0oY29sLCAKICAgICAgICAgICAg\nICAgIG5ldyBCeXRlQXJyYXlJbnB1dFN0cmVhbShuZXcgYnl0ZVswXSksIDAp\nOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJvdy5zZXROdWxsKGNv\nbCk7CiAgICAgICAgfQogICAgfQogICAgCiAgICBwdWJsaWMgdm9pZCBpbnNl\ncnRDbG9iRm9yU3RyZWFtaW5nTG9hZChSb3cgcm93LCBDb2x1bW4gY29sLCBP\nYmplY3Qgb2IpCiAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBp\nZiAob2IgIT0gbnVsbCkgewogICAgICAgIHJvdy5zZXRDaGFyYWN0ZXJTdHJl\nYW0oY29sLAogICAgICAgICAgICAgICAgbmV3IENoYXJBcnJheVJlYWRlcihu\nZXcgY2hhclswXSksIDApOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAg\nIHJvdy5zZXROdWxsKGNvbCk7CiAgICAgICAgfQogICAgfQogICAgCiAgICBw\ndWJsaWMgdm9pZCB1cGRhdGVCbG9iKFNlbGVjdCBzZWwsIEpEQkNTdG9yZSBz\ndG9yZSwgSW5wdXRTdHJlYW0gaXMpCiAgICAgICAgdGhyb3dzIFNRTEV4Y2Vw\ndGlvbiB7CiAgICAgICAgU1FMQnVmZmVyIHNxbCA9IHNlbC50b1NlbGVjdCh0\ncnVlLCBzdG9yZS5nZXRGZXRjaENvbmZpZ3VyYXRpb24oKSk7CiAgICAgICAg\nUmVzdWx0U2V0IHJlcyA9IG51bGw7CiAgICAgICAgQ29ubmVjdGlvbiBjb25u\nID0gc3RvcmUuZ2V0Q29ubmVjdGlvbigpOwogICAgICAgIFByZXBhcmVkU3Rh\ndGVtZW50IHN0bW50ID0gbnVsbDsKICAgICAgICB0cnkgewogICAgICAgICAg\nICBzdG1udCA9IHNxbC5wcmVwYXJlU3RhdGVtZW50KGNvbm4sIHN0b3JlLmdl\ndEZldGNoQ29uZmlndXJhdGlvbigpLAogICAgICAgICAgICAgICAgUmVzdWx0\nU2V0LlRZUEVfU0NST0xMX1NFTlNJVElWRSwKICAgICAgICAgICAgICAgIFJl\nc3VsdFNldC5DT05DVVJfVVBEQVRBQkxFKTsKICAgICAgICAgICAgcmVzID0g\nc3RtbnQuZXhlY3V0ZVF1ZXJ5KCk7CiAgICAgICAgICAgIGlmICghcmVzLm5l\neHQoKSkgewogICAgICAgICAgICAgICAgdGhyb3cgbmV3IEludGVybmFsRXhj\nZXB0aW9uKF9sb2MuZ2V0KCJzdHJlYW0tZXhjZXB0aW9uIikpOwogICAgICAg\nICAgICB9CiAgICAgICAgICAgIEJsb2IgYmxvYiA9IHJlcy5nZXRCbG9iKDEp\nOwogICAgICAgICAgICBPdXRwdXRTdHJlYW0gb3MgPSBibG9iLnNldEJpbmFy\neVN0cmVhbSgxKTsKICAgICAgICAgICAgY29weShpcywgb3MpOwogICAgICAg\nICAgICBvcy5jbG9zZSgpOwogICAgICAgICAgICByZXMudXBkYXRlQmxvYigx\nLCBibG9iKTsKICAgICAgICAgICAgcmVzLnVwZGF0ZVJvdygpOwoKICAgICAg\nICB9IGNhdGNoIChJT0V4Y2VwdGlvbiBpb2UpIHsKICAgICAgICAgICAgdGhy\nb3cgbmV3IFN0b3JlRXhjZXB0aW9uKGlvZSk7CiAgICAgICAgfSBmaW5hbGx5\nIHsKICAgICAgICAgICAgaWYgKHJlcyAhPSBudWxsKQogICAgICAgICAgICAg\nICAgdHJ5IHsgcmVzLmNsb3NlICgpOyB9IGNhdGNoIChTUUxFeGNlcHRpb24g\nZSkge30KICAgICAgICAgICAgaWYgKHN0bW50ICE9IG51bGwpCiAgICAgICAg\nICAgICAgICB0cnkgeyBzdG1udC5jbG9zZSAoKTsgfSBjYXRjaCAoU1FMRXhj\nZXB0aW9uIGUpIHt9CiAgICAgICAgICAgIGlmIChjb25uICE9IG51bGwpCiAg\nICAgICAgICAgICAgICB0cnkgeyBjb25uLmNsb3NlICgpOyB9IGNhdGNoIChT\nUUxFeGNlcHRpb24gZSkge30KICAgICAgICB9CiAgICB9CiAgICAKICAgIHB1\nYmxpYyB2b2lkIHVwZGF0ZUNsb2IoU2VsZWN0IHNlbCwgSkRCQ1N0b3JlIHN0\nb3JlLCBSZWFkZXIgcmVhZGVyKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRp\nb24gewogICAgICAgIFNRTEJ1ZmZlciBzcWwgPSBzZWwudG9TZWxlY3QodHJ1\nZSwgc3RvcmUuZ2V0RmV0Y2hDb25maWd1cmF0aW9uKCkpOwogICAgICAgIFJl\nc3VsdFNldCByZXMgPSBudWxsOwogICAgICAgIENvbm5lY3Rpb24gY29ubiA9\nIHN0b3JlLmdldENvbm5lY3Rpb24oKTsKICAgICAgICBQcmVwYXJlZFN0YXRl\nbWVudCBzdG1udCA9IG51bGw7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAg\nc3RtbnQgPSBzcWwucHJlcGFyZVN0YXRlbWVudChjb25uLCBzdG9yZS5nZXRG\nZXRjaENvbmZpZ3VyYXRpb24oKSwKICAgICAgICAgICAgICAgIFJlc3VsdFNl\ndC5UWVBFX1NDUk9MTF9TRU5TSVRJVkUsCiAgICAgICAgICAgICAgICBSZXN1\nbHRTZXQuQ09OQ1VSX1VQREFUQUJMRSk7CiAgICAgICAgICAgIHJlcyA9IHN0\nbW50LmV4ZWN1dGVRdWVyeSgpOwogICAgICAgICAgICBpZiAoIXJlcy5uZXh0\nKCkpIHsKICAgICAgICAgICAgICAgIHRocm93IG5ldyBJbnRlcm5hbEV4Y2Vw\ndGlvbihfbG9jLmdldCgic3RyZWFtLWV4Y2VwdGlvbiIpKTsKICAgICAgICAg\nICAgfQogICAgICAgICAgICBDbG9iIGNsb2IgPSByZXMuZ2V0Q2xvYigxKTsK\nICAgICAgICAgICAgV3JpdGVyIHdyaXRlciA9IGNsb2Iuc2V0Q2hhcmFjdGVy\nU3RyZWFtKDEpOwogICAgICAgICAgICBjb3B5KHJlYWRlciwgd3JpdGVyKTsK\nICAgICAgICAgICAgd3JpdGVyLmNsb3NlKCk7CiAgICAgICAgICAgIHJlcy51\ncGRhdGVDbG9iKDEsIGNsb2IpOwogICAgICAgICAgICByZXMudXBkYXRlUm93\nKCk7CgogICAgICAgIH0gY2F0Y2ggKElPRXhjZXB0aW9uIGlvZSkgewogICAg\nICAgICAgICB0aHJvdyBuZXcgU3RvcmVFeGNlcHRpb24oaW9lKTsKICAgICAg\nICB9IGZpbmFsbHkgewogICAgICAgICAgICBpZiAocmVzICE9IG51bGwpIAog\nICAgICAgICAgICAgICAgdHJ5IHsgcmVzLmNsb3NlICgpOyB9IGNhdGNoIChT\nUUxFeGNlcHRpb24gZSkge30KICAgICAgICAgICAgaWYgKHN0bW50ICE9IG51\nbGwpIAogICAgICAgICAgICAgICAgdHJ5IHsgc3RtbnQuY2xvc2UgKCk7IH0g\nY2F0Y2ggKFNRTEV4Y2VwdGlvbiBlKSB7fQogICAgICAgICAgICBpZiAoY29u\nbiAhPSBudWxsKSAKICAgICAgICAgICAgICAgIHRyeSB7IGNvbm4uY2xvc2Ug\nKCk7IH0gY2F0Y2ggKFNRTEV4Y2VwdGlvbiBlKSB7fQogICAgICAgIH0gICAg\nCiAgICB9CiAgICAKICAgIHByb3RlY3RlZCBsb25nIGNvcHkoSW5wdXRTdHJl\nYW0gaW4sIE91dHB1dFN0cmVhbSBvdXQpIHRocm93cyBJT0V4Y2VwdGlvbiB7\nCiAgICAgICAgYnl0ZVtdIGNvcHlCdWZmZXIgPSBuZXcgYnl0ZVtibG9iQnVm\nZmVyU2l6ZV07CiAgICAgICAgbG9uZyBieXRlc0NvcGllZCA9IDA7CiAgICAg\nICAgaW50IHJlYWQgPSAtMTsKCiAgICAgICAgd2hpbGUgKChyZWFkID0gaW4u\ncmVhZChjb3B5QnVmZmVyLCAwLCBjb3B5QnVmZmVyLmxlbmd0aCkpICE9IC0x\nKSB7CiAgICAgICAgICAgIG91dC53cml0ZShjb3B5QnVmZmVyLCAwLCByZWFk\nKTsKICAgICAgICAgICAgYnl0ZXNDb3BpZWQgKz0gcmVhZDsKICAgICAgICB9\nCiAgICAgICAgcmV0dXJuIGJ5dGVzQ29waWVkOwogICAgfQogICAgCiAgICBw\ncm90ZWN0ZWQgbG9uZyBjb3B5KFJlYWRlciByZWFkZXIsIFdyaXRlciB3cml0\nZXIpIHRocm93cyBJT0V4Y2VwdGlvbiB7CiAgICAgICAgY2hhcltdIGNvcHlC\ndWZmZXIgPSBuZXcgY2hhcltjbG9iQnVmZmVyU2l6ZV07CiAgICAgICAgbG9u\nZyBieXRlc0NvcGllZCA9IDA7CiAgICAgICAgaW50IHJlYWQgPSAtMTsKCiAg\nICAgICAgd2hpbGUgKChyZWFkID0gcmVhZGVyLnJlYWQoY29weUJ1ZmZlciwg\nMCwgY29weUJ1ZmZlci5sZW5ndGgpKSAhPSAtMSkgewogICAgICAgICAgICB3\ncml0ZXIud3JpdGUoY29weUJ1ZmZlciwgMCwgcmVhZCk7CiAgICAgICAgICAg\nIGJ5dGVzQ29waWVkICs9IHJlYWQ7CiAgICAgICAgfQoKICAgICAgICByZXR1\ncm4gYnl0ZXNDb3BpZWQ7CiAgICB9CiAgICAKICAgIC8qKgogICAgICogQXR0\nYWNoIENBU1QgdG8gdGhlIGN1cnJlbnQgZnVuY3Rpb24gaWYgbmVjZXNzYXJ5\nCiAgICAgKiAKICAgICAqIEBwYXJhbSB2YWwgb3BlcmFuZCB2YWx1ZQogICAg\nICogQHBhcm1hIGZ1bmMgdGhlIHNxbCBmdW5jdGlvbiBzdGF0ZW1lbnQKICAg\nICAqIEByZXR1cm4gYSBTdHJpbmcgd2l0aCB0aGUgY29ycmVjdCBDQVNUIGZ1\nbmN0aW9uIHN5bnRheAogICAgICovCiAgICBwdWJsaWMgU3RyaW5nIGdldENh\nc3RGdW5jdGlvbihWYWwgdmFsLCBTdHJpbmcgZnVuYykgewogICAgICAgIHJl\ndHVybiBmdW5jOwogICAgfQogICAgCiAgICAvKioKICAgICAqIENyZWF0ZSBh\nbiBpbmRleCBpZiBuZWNlc3NhcnkgZm9yIHNvbWUgZGF0YWJhc2UgdGFibGVz\nCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIGNyZWF0ZUluZGV4SWZOZWNlc3Nh\ncnkoU2NoZW1hIHNjaGVtYSwgU3RyaW5nIHRhYmxlLAogICAgICAgICAgICBD\nb2x1bW4gcGtDb2x1bW4pIHsKICAgIH0KICAgIAogICAgLyoqCiAgICAgKiBS\nZXR1cm4gdGhlIGJhdGNoTGltaXQKICAgICAqLwogICAgcHVibGljIGludCBn\nZXRCYXRjaExpbWl0KCl7CiAgICAgICAgcmV0dXJuIGJhdGNoTGltaXQ7CiAg\nICB9CiAgICAKICAgIC8qKgogICAgICogU2V0IHRoZSBiYXRjaExpbWl0IHZh\nbHVlCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldEJhdGNoTGltaXQoaW50\nIGxpbWl0KXsKICAgICAgICBiYXRjaExpbWl0ID0gbGltaXQ7CiAgICB9CiAg\nICAKICAgIC8qKgogICAgICogVmFsaWRhdGUgdGhlIGJhdGNoIHByb2Nlc3Mu\nIEluIHNvbWUgY2FzZXMsIHdlIGNhbid0IGJhdGNoIHRoZSBzdGF0ZW1lbnRz\nCiAgICAgKiBkdWUgdG8gc29tZSByZXN0cmljdGlvbnMuIEZvciBleGFtcGxl\nLCBpZiB0aGUgR2VuZXJhdGVkVHlwZT1JREVOVElUWSwKICAgICAqIHdlIGhh\ndmUgdG8gZGlzYWJsZSB0aGUgYmF0Y2ggcHJvY2VzcyBiZWNhdXNlIHdlIG5l\nZWQgdG8gZ2V0IHRoZSBJRCB2YWx1ZQogICAgICogcmlnaHQgYXdheSBmb3Ig\ndGhlIGluLW1lbW9yeSBlbnRpdHkgdG8gdXNlLgogICAgICovCiAgICBwdWJs\naWMgYm9vbGVhbiB2YWxpZGF0ZUJhdGNoUHJvY2VzcyhSb3dJbXBsIHJvdywg\nQ29sdW1uW10gYXV0b0Fzc2lnbiwKICAgICAgICAgICAgT3BlbkpQQVN0YXRl\nTWFuYWdlciAgc20sIENsYXNzTWFwcGluZyBjbWQgKSB7CiAgICAgICAgYm9v\nbGVhbiBkaXNhYmxlQmF0Y2ggPSBmYWxzZTsKICAgICAgICBpZiAoZ2V0QmF0\nY2hMaW1pdCgpPT0gMCkgcmV0dXJuIGZhbHNlOwogICAgICAgIGlmIChhdXRv\nQXNzaWduICE9IG51bGwgJiYgc20gIT0gbnVsbCkgewogICAgICAgICAgICBG\naWVsZE1ldGFEYXRhW10gZm1kID0gY21kLmdldFByaW1hcnlLZXlGaWVsZHMo\nKTsKICAgICAgICAgICAgaW50IGkgPSAwOwogICAgICAgICAgICB3aGlsZSAo\nIWRpc2FibGVCYXRjaCAmJiBpIDwgZm1kLmxlbmd0aCkgewogICAgICAgICAg\nICAgICAgaWYgKGZtZFtpXS5nZXRWYWx1ZVN0cmF0ZWd5KCkgPT0gVmFsdWVT\ndHJhdGVnaWVzLkFVVE9BU1NJR04pCiAgICAgICAgICAgICAgICAgICAgZGlz\nYWJsZUJhdGNoID0gdHJ1ZTsKICAgICAgICAgICAgICAgIGkrKzsKICAgICAg\nICAgICAgfQogICAgICAgIH0KICAgICAgICAvLyBnbyB0byBlYWNoIERpY3Rp\nb25hcnkgdG8gdmFsaWRhdGUgdGhlIGJhdGNoIGNhcGFiaWxpdHkKICAgICAg\nICBpZiAoIWRpc2FibGVCYXRjaCkKICAgICAgICAgICAgZGlzYWJsZUJhdGNo\nID0gdmFsaWRhdGVEQlNwZWNpZmljQmF0Y2hQcm9jZXNzKGRpc2FibGVCYXRj\naCwgcm93LCAKICAgICAgICAgICAgICAgIGF1dG9Bc3NpZ24sIHNtLCBjbWQp\nOwogICAgICAgIHJldHVybiBkaXNhYmxlQmF0Y2g7CiAgICB9CiAgICAKICAg\nIC8qKgogICAgICogQWxsb3cgZWFjaCBEaWN0aW9uYXJ5IHRvIHZhbGlkYXRl\nIGl0cyBvd24gYmF0Y2ggcHJvY2Vzcy4gCiAgICAgKi8KICAgIHB1YmxpYyBi\nb29sZWFuIHZhbGlkYXRlREJTcGVjaWZpY0JhdGNoUHJvY2VzcyAoYm9vbGVh\nbiBkaXNhYmxlQmF0Y2gsIAogICAgICAgICAgICBSb3dJbXBsIHJvdywgQ29s\ndW1uW10gYXV0b0Fzc2lnbiwgCiAgICAgICAgICAgIE9wZW5KUEFTdGF0ZU1h\nbmFnZXIgIHNtLCBDbGFzc01hcHBpbmcgY21kICkgewogICAgICAgIHJldHVy\nbiBkaXNhYmxlQmF0Y2g7CiAgICB9CiAgICAKICAgIC8qKgogICAgICogVGhp\ncyBtZXRob2QgaXMgdG8gcHJvdmlkZSBvdmVycmlkZSBmb3Igbm9uLUpEQkMg\nb3IgSkRCQy1saWtlIAogICAgICogaW1wbGVtZW50YXRpb24gb2YgZXhlY3V0\naW5nIHF1ZXJ5LgogICAgICovCiAgICBwcm90ZWN0ZWQgUmVzdWx0U2V0IGV4\nZWN1dGVRdWVyeShDb25uZWN0aW9uIGNvbm4sIFByZXBhcmVkU3RhdGVtZW50\nIHN0bW50LCBTdHJpbmcgc3FsIAogICAgICAgICkgdGhyb3dzIFNRTEV4Y2Vw\ndGlvbiB7CiAgICAgICAgcmV0dXJuIHN0bW50LmV4ZWN1dGVRdWVyeSgpOwog\nICAgfQogICAgICAgICAgICAKICAgIC8qKgogICAgICogVGhpcyBtZXRob2Qg\naXMgdG8gcHJvdmlkZSBvdmVycmlkZSBmb3Igbm9uLUpEQkMgb3IgSkRCQy1s\naWtlIAogICAgICogaW1wbGVtZW50YXRpb24gb2YgcHJlcGFyaW5nIHN0YXRl\nbWVudC4KICAgICAqLwogICAgcHJvdGVjdGVkIFByZXBhcmVkU3RhdGVtZW50\nIHByZXBhcmVTdGF0ZW1lbnQoQ29ubmVjdGlvbiBjb25uLCBTdHJpbmcgc3Fs\nKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIHJldHVy\nbiBjb25uLnByZXBhcmVTdGF0ZW1lbnQoc3FsKTsKICAgIH0gICAgCiAKICAg\nIC8qKgogICAgICogVGhpcyBtZXRob2QgaXMgdG8gcHJvdmlkZSBvdmVycmlk\nZSBmb3Igbm9uLUpEQkMgb3IgSkRCQy1saWtlIAogICAgICogaW1wbGVtZW50\nYXRpb24gb2YgZ2V0dGluZyBzZXF1ZW5jZSBmcm9tIHRoZSByZXN1bHQgc2V0\nLgogICAgICovCiAgICBwcm90ZWN0ZWQgU2VxdWVuY2VbXSBnZXRTZXF1ZW5j\nZShSZXN1bHRTZXQgcnMpIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAg\nIExpc3Qgc2VxTGlzdCA9IG5ldyBBcnJheUxpc3QoKTsKICAgICAgICB3aGls\nZSAocnMgIT0gbnVsbCAmJiBycy5uZXh0KCkpCiAgICAgICAgICAgIHNlcUxp\nc3QuYWRkKG5ld1NlcXVlbmNlKHJzKSk7CiAgICAgICAgcmV0dXJuIChTZXF1\nZW5jZVtdKSBzZXFMaXN0LnRvQXJyYXkobmV3IFNlcXVlbmNlW3NlcUxpc3Qu\nc2l6ZSgpXSk7CiAgICB9CiAgICAKICAgIC8qKgogICAgICogVGhpcyBtZXRo\nb2QgaXMgdG8gcHJvdmlkZSBvdmVycmlkZSBmb3Igbm9uLUpEQkMgb3IgSkRC\nQy1saWtlIAogICAgICogaW1wbGVtZW50YXRpb24gb2YgZ2V0dGluZyBrZXkg\nZnJvbSB0aGUgcmVzdWx0IHNldC4KICAgICAqLwogICAgcHJvdGVjdGVkIE9i\namVjdCBnZXRLZXkgKFJlc3VsdFNldCBycywgQ29sdW1uIGNvbCkgdGhyb3dz\nIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgaWYgKCFycy5uZXh0KCkpCiAgICAg\nICAgICAgIHRocm93IG5ldyBTdG9yZUV4Y2VwdGlvbihfbG9jLmdldCgibm8t\nZ2Vua2V5IikpOwogICAgICAgIE9iamVjdCBrZXkgPSBycy5nZXRPYmplY3Qo\nMSk7CiAgICAgICAgaWYgKGtleSA9PSBudWxsKQogICAgICAgICAgICBsb2cu\nd2FybihfbG9jLmdldCgiaW52YWxpZC1nZW5rZXkiLCBjb2wpKTsKICAgICAg\nICByZXR1cm4ga2V5OyAgICAgICAgCiAgICB9CiAgICAKICAgIC8qKgogICAg\nICogVGhpcyBtZXRob2QgaXMgdG8gcHJvdmlkZSBvdmVycmlkZSBmb3Igbm9u\nLUpEQkMgb3IgSkRCQy1saWtlIAogICAgICogaW1wbGVtZW50YXRpb24gb2Yg\nY2FsY3VsYXRpbmcgdmFsdWUuCiAgICAgKi8KICAgIHByb3RlY3RlZCB2b2lk\nIGNhbGN1bGF0ZVZhbHVlKFZhbCB2YWwsIFNlbGVjdCBzZWwsIEV4cENvbnRl\neHQgY3R4LCAKICAgICAgICBFeHBTdGF0ZSBzdGF0ZSwgUGF0aCBwYXRoLCBF\neHBTdGF0ZSBwYXRoU3RhdGUpIHsKICAgICAgICB2YWwuY2FsY3VsYXRlVmFs\ndWUoc2VsLCBjdHgsIHN0YXRlLCAoVmFsKSBwYXRoLCBwYXRoU3RhdGUpOwog\nICAgfQoKICAgIC8qKgogICAgICogRGV0ZXJtaW5lIHdoZXRoZXIgdGhlIHBy\nb3ZpZGVkIDxjb2RlPnNxbDwvY29kZT4gbWF5IGJlIHRyZWF0ZWQgYXMgYSAK\nICAgICAqIHNlbGVjdCBzdGF0ZW1lbnQgb24gdGhpcyBkYXRhYmFzZS4KICAg\nICAqICAKICAgICAqIEBwYXJhbSBzcWwgICBBIHNxbCBzdGF0ZW1lbnQuIAog\nICAgICogCiAgICAgKiBAcmV0dXJuIHRydWUgaWYgPGNvZGU+c3FsPC9jb2Rl\nPiByZXByZXNlbnRzIGEgc2VsZWN0IHN0YXRlbWVudC4KICAgICAqLwogICAg\ncHVibGljIGJvb2xlYW4gaXNTZWxlY3QoU3RyaW5nIHNxbCkgewogICAgICAg\nIEl0ZXJhdG9yIGkgPSBzZWxlY3RXb3JkU2V0Lml0ZXJhdG9yKCk7CiAgICAg\nICAgU3RyaW5nIGN1cjsKICAgICAgICB3aGlsZSAoaS5oYXNOZXh0KCkpIHsK\nICAgICAgICAgICAgY3VyID0gKFN0cmluZykgaS5uZXh0KCk7CiAgICAgICAg\nICAgIGlmIChzcWwubGVuZ3RoKCkgPj0gY3VyLmxlbmd0aCgpCiAgICAgICAg\nICAgICAgICAgICAgJiYgc3FsLnN1YnN0cmluZygwLCBjdXIubGVuZ3RoKCkp\nLmVxdWFsc0lnbm9yZUNhc2UoY3VyKSkgewogICAgICAgICAgICAgICAgcmV0\ndXJuIHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0\ndXJuIGZhbHNlOwogICAgfQogICAgCiAgICBwdWJsaWMgdm9pZCBkZWxldGVT\ndHJlYW0oSkRCQ1N0b3JlIHN0b3JlLCBTZWxlY3Qgc2VsKSB0aHJvd3MgU1FM\nRXhjZXB0aW9uIHsKICAgICAgICAvL0RvIG5vdGhpbmcKICAgIH0KfQo=\n","encoding":"base64"}

