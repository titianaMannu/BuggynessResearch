{"sha":"1b98475414c66fadc60fc450f81a7f45818f35f4","node_id":"MDQ6QmxvYjIwNjM2NDoxYjk4NDc1NDE0YzY2ZmFkYzYwZmM0NTBmODFhN2Y0NTgxOGYzNWY0","size":43124,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/1b98475414c66fadc60fc450f81a7f45818f35f4","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zcWw7CgppbXBvcnQg\namF2YS5sYW5nLnJlZmxlY3QuSW52b2NhdGlvblRhcmdldEV4Y2VwdGlvbjsK\naW1wb3J0IGphdmEubGFuZy5yZWZsZWN0Lk1ldGhvZDsKaW1wb3J0IGphdmEu\nc3FsLkJsb2I7CmltcG9ydCBqYXZhLnNxbC5DbG9iOwppbXBvcnQgamF2YS5z\ncWwuQ29ubmVjdGlvbjsKaW1wb3J0IGphdmEuc3FsLkRhdGFiYXNlTWV0YURh\ndGE7CmltcG9ydCBqYXZhLnNxbC5QcmVwYXJlZFN0YXRlbWVudDsKaW1wb3J0\nIGphdmEuc3FsLlJlc3VsdFNldDsKaW1wb3J0IGphdmEuc3FsLlNRTEV4Y2Vw\ndGlvbjsKaW1wb3J0IGphdmEuc3FsLlN0YXRlbWVudDsKaW1wb3J0IGphdmEu\nc3FsLlRpbWVzdGFtcDsKaW1wb3J0IGphdmEuc3FsLlR5cGVzOwppbXBvcnQg\namF2YS51dGlsLkFycmF5TGlzdDsKaW1wb3J0IGphdmEudXRpbC5BcnJheXM7\nCmltcG9ydCBqYXZhLnV0aWwuQ2FsZW5kYXI7CmltcG9ydCBqYXZhLnV0aWwu\nSXRlcmF0b3I7CmltcG9ydCBqYXZhLnV0aWwuTGlzdDsKaW1wb3J0IGphdmEu\ndXRpbC5NYXA7CgppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMua2Vy\nbmVsLkpEQkNGZXRjaENvbmZpZ3VyYXRpb247CmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEuamRiYy5rZXJuZWwuZXhwcy5GaWx0ZXJWYWx1ZTsKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNjaGVtYS5Db2x1bW47CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hlbWEuRm9yZWlnbktleTsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNjaGVtYS5JbmRleDsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNjaGVtYS5QcmltYXJ5\nS2V5OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1hLlNl\ncXVlbmNlOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1h\nLlRhYmxlOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc3FsLlNl\nbGVjdDsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIuamRiYy5EZWxl\nZ2F0aW5nRGF0YWJhc2VNZXRhRGF0YTsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5saWIuamRiYy5EZWxlZ2F0aW5nUHJlcGFyZWRTdGF0ZW1lbnQ7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuTG9jYWxpemVyOwpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuU3RvcmVFeGNlcHRpb247\nCgppbXBvcnQgc2VycC51dGlsLk51bWJlcnM7CgovKioKICogRGljdGlvbmFy\neSBmb3IgT3JhY2xlLgogKi8KcHVibGljIGNsYXNzIE9yYWNsZURpY3Rpb25h\ncnkKICAgIGV4dGVuZHMgREJEaWN0aW9uYXJ5IHsKCiAgICBwdWJsaWMgc3Rh\ndGljIGZpbmFsIFN0cmluZyBTRUxFQ1RfSElOVCA9ICJvcGVuanBhLmhpbnQu\nT3JhY2xlU2VsZWN0SGludCI7CiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIFN0\ncmluZyBWRU5ET1JfT1JBQ0xFID0gIm9yYWNsZSI7CgogICAgcHJpdmF0ZSBz\ndGF0aWMgZmluYWwgaW50IEJFSEFWRV9PVEhFUiA9IDA7CiAgICBwcml2YXRl\nIHN0YXRpYyBmaW5hbCBpbnQgQkVIQVZFX09SQUNMRSA9IDE7CiAgICBwcml2\nYXRlIHN0YXRpYyBmaW5hbCBpbnQgQkVIQVZFX0RBVEFESVJFQ1QzMSA9IDI7\nCgogICAgcHJpdmF0ZSBzdGF0aWMgQmxvYiBFTVBUWV9CTE9CID0gbnVsbDsK\nICAgIHByaXZhdGUgc3RhdGljIENsb2IgRU1QVFlfQ0xPQiA9IG51bGw7Cgog\nICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgTG9jYWxpemVyIF9sb2MgPSBMb2Nh\nbGl6ZXIuZm9yUGFja2FnZQogICAgICAgIChPcmFjbGVEaWN0aW9uYXJ5LmNs\nYXNzKTsKCiAgICAvKioKICAgICAqIElmIHRydWUsIHRoZW4gc2ltdWxhdGUg\nYXV0by1hc3NpZ25lZCB2YWx1ZXMgaW4gT3JhY2xlIGJ5CiAgICAgKiB1c2lu\nZyBhIHRyaWdnZXIgdGhhdCBpbnNlcnRzIGEgc2VxdWVuY2UgdmFsdWUgaW50\nbyB0aGUKICAgICAqIHByaW1hcnkga2V5IHZhbHVlIHdoZW4gYSByb3cgaXMg\naW5zZXJ0ZWQuCiAgICAgKi8KICAgIHB1YmxpYyBib29sZWFuIHVzZVRyaWdn\nZXJzRm9yQXV0b0Fzc2lnbiA9IGZhbHNlOwoKICAgIC8qKgogICAgICogVGhl\nIGdsb2JhbCBzZXF1ZW5jZSBuYW1lIHRvIHVzZSBmb3IgYXV0b2Fzc2lnbiBz\naW11bGF0aW9uLgogICAgICovCiAgICBwdWJsaWMgU3RyaW5nIGF1dG9Bc3Np\nZ25TZXF1ZW5jZU5hbWUgPSBudWxsOwoKICAgIC8qKgogICAgICogRmxhZyB0\nbyB1c2UgT3BlbkpQQSAwLjMgc3R5bGUgbmFtaW5nIGZvciBhdXRvIGFzc2ln\nbiBzZXF1ZW5jZSBuYW1lIGFuZAogICAgICogdHJpZ2dlciBuYW1lIGZvciBi\nYWNrd2FyZHMgY29tcGF0aWJpbGl0eS4KICAgICAqLwogICAgcHVibGljIGJv\nb2xlYW4gb3BlbmpwYTNHZW5lcmF0ZWRLZXlOYW1lcyA9IGZhbHNlOwoKICAg\nIC8qKgogICAgICogSWYgdHJ1ZSwgdGhlbiBPcGVuSlBBIHdpbGwgYXR0ZW1w\ndCB0byB1c2UgdGhlIHNwZWNpYWwKICAgICAqIE9yYWNsZVByZXBhcmVkU3Rh\ndGVtZW50LnNldEZvcm1PZlVzZSBtZXRob2QgdG8KICAgICAqIGNvbmZpZ3Vy\nZSBzdGF0ZW1lbnRzIHRoYXQgaXQgZGV0ZWN0cyBhcmUgb3BlcmF0aW5nIG9u\nIHVuaWNvZGUgZmllbGRzLgogICAgICovCiAgICBwdWJsaWMgYm9vbGVhbiB1\nc2VTZXRGb3JtT2ZVc2VGb3JVbmljb2RlID0gdHJ1ZTsKCiAgICAvLyBzb21l\nIG9yYWNsZSBkcml2ZXJzIGhhdmUgcHJvYmxlbXMgd2l0aCBzZWxlY3QgZm9y\nIHVwZGF0ZTsgd2FybiB0aGUKICAgIC8vIGZpcnN0IHRpbWUgbG9ja2luZyBp\ncyBhdHRlbXB0ZWQKICAgIHByaXZhdGUgYm9vbGVhbiBfY2hlY2tlZFVwZGF0\nZUJ1ZyA9IGZhbHNlOwogICAgcHJpdmF0ZSBib29sZWFuIF93YXJuZWRDaGFy\nQ29sdW1uID0gZmFsc2U7CiAgICBwcml2YXRlIGJvb2xlYW4gX3dhcm5lZE5j\naGFyQ29sdW1uID0gZmFsc2U7CiAgICBwcml2YXRlIGludCBfZHJpdmVyQmVo\nYXZpb3IgPSAtMTsKCiAgICAvLyBjYWNoZSBsb2IgbWV0aG9kcwogICAgcHJp\ndmF0ZSBNZXRob2QgX3B1dEJ5dGVzID0gbnVsbDsKICAgIHByaXZhdGUgTWV0\naG9kIF9wdXRTdHJpbmcgPSBudWxsOwogICAgcHJpdmF0ZSBNZXRob2QgX3B1\ndENoYXJzID0gbnVsbDsKICAgIAogICAgLy8gYmF0Y2ggbGltaXQKICAgIHBy\naXZhdGUgaW50IGRlZmF1bHRCYXRjaExpbWl0ID0gMTAwOwoKICAgIHB1Ymxp\nYyBPcmFjbGVEaWN0aW9uYXJ5KCkgewogICAgICAgIHBsYXRmb3JtID0gIk9y\nYWNsZSI7CiAgICAgICAgdmFsaWRhdGlvblNRTCA9ICJTRUxFQ1QgU1lTREFU\nRSBGUk9NIERVQUwiOwogICAgICAgIG5leHRTZXF1ZW5jZVF1ZXJ5ID0gIlNF\nTEVDVCB7MH0uTkVYVFZBTCBGUk9NIERVQUwiOwogICAgICAgIHN0cmluZ0xl\nbmd0aEZ1bmN0aW9uID0gIkxFTkdUSCh7MH0pIjsKICAgICAgICBqb2luU3lu\ndGF4ID0gU1lOVEFYX0RBVEFCQVNFOwogICAgICAgIG1heFRhYmxlTmFtZUxl\nbmd0aCA9IDMwOwogICAgICAgIG1heENvbHVtbk5hbWVMZW5ndGggPSAzMDsK\nICAgICAgICBtYXhJbmRleE5hbWVMZW5ndGggPSAzMDsKICAgICAgICBtYXhD\nb25zdHJhaW50TmFtZUxlbmd0aCA9IDMwOwogICAgICAgIG1heEVtYmVkZGVk\nQmxvYlNpemUgPSA0MDAwOwogICAgICAgIG1heEVtYmVkZGVkQ2xvYlNpemUg\nPSA0MDAwOwogICAgICAgIGluQ2xhdXNlTGltaXQgPSAxMDAwOwoKICAgICAg\nICBzdXBwb3J0c0RlZmVycmVkQ29uc3RyYWludHMgPSB0cnVlOwogICAgICAg\nIHN1cHBvcnRzTG9ja2luZ1dpdGhEaXN0aW5jdENsYXVzZSA9IGZhbHNlOwog\nICAgICAgIHN1cHBvcnRzU2VsZWN0U3RhcnRJbmRleCA9IHRydWU7CiAgICAg\nICAgc3VwcG9ydHNTZWxlY3RFbmRJbmRleCA9IHRydWU7CgogICAgICAgIHN5\nc3RlbVNjaGVtYVNldC5hZGRBbGwoQXJyYXlzLmFzTGlzdChuZXcgU3RyaW5n\nW117CiAgICAgICAgICAgICJDVFhTWVMiLCAiTURTWVMiLCAiU1lTIiwgIlNZ\nU1RFTSIsICJXS1NZUyIsICJXTVNZUyIsICJYREIiLAogICAgICAgIH0pKTsK\nCiAgICAgICAgc3VwcG9ydHNYTUxDb2x1bW4gPSB0cnVlOwogICAgICAgIHht\nbFR5cGVOYW1lID0gIlhNTFR5cGUiOwogICAgICAgIGJpZ2ludFR5cGVOYW1l\nID0gIk5VTUJFUnswfSI7CiAgICAgICAgYml0VHlwZU5hbWUgPSAiTlVNQkVS\nezB9IjsKICAgICAgICBkZWNpbWFsVHlwZU5hbWUgPSAiTlVNQkVSezB9IjsK\nICAgICAgICBkb3VibGVUeXBlTmFtZSA9ICJOVU1CRVJ7MH0iOwogICAgICAg\nIGludGVnZXJUeXBlTmFtZSA9ICJOVU1CRVJ7MH0iOwogICAgICAgIG51bWVy\naWNUeXBlTmFtZSA9ICJOVU1CRVJ7MH0iOwogICAgICAgIHNtYWxsaW50VHlw\nZU5hbWUgPSAiTlVNQkVSezB9IjsKICAgICAgICB0aW55aW50VHlwZU5hbWUg\nPSAiTlVNQkVSezB9IjsKICAgICAgICBsb25nVmFyY2hhclR5cGVOYW1lID0g\nIkxPTkciOwogICAgICAgIGJpbmFyeVR5cGVOYW1lID0gIkJMT0IiOwogICAg\nICAgIHZhcmJpbmFyeVR5cGVOYW1lID0gIkJMT0IiOwogICAgICAgIGxvbmdW\nYXJiaW5hcnlUeXBlTmFtZSA9ICJCTE9CIjsKICAgICAgICB0aW1lVHlwZU5h\nbWUgPSAiREFURSI7CiAgICAgICAgdmFyY2hhclR5cGVOYW1lID0gIlZBUkNI\nQVIyezB9IjsKICAgICAgICBmaXhlZFNpemVUeXBlTmFtZVNldC5hZGRBbGwo\nQXJyYXlzLmFzTGlzdChuZXcgU3RyaW5nW117CiAgICAgICAgICAgICJMT05H\nIFJBVyIsICJSQVciLCAiTE9ORyIsICJSRUYiLAogICAgICAgIH0pKTsKICAg\nICAgICByZXNlcnZlZFdvcmRTZXQuYWRkQWxsKEFycmF5cy5hc0xpc3QobmV3\nIFN0cmluZ1tdewogICAgICAgICAgICAiQUNDRVNTIiwgIkFVRElUIiwgIkNM\nVVNURVIiLCAiQ09NTUVOVCIsICJDT01QUkVTUyIsICJFWENMVVNJVkUiLAog\nICAgICAgICAgICAiRklMRSIsICJJREVOVElGSUVEIiwgIklOQ1JFTUVOVCIs\nICJJTkRFWCIsICJJTklUSUFMIiwgIkxPQ0siLAogICAgICAgICAgICAiTE9O\nRyIsICJNQVhFWFRFTlRTIiwgIk1JTlVTIiwgIk1PREUiLCAiTk9BVURJVCIs\nICJOT0NPTVBSRVNTIiwKICAgICAgICAgICAgIk5PV0FJVCIsICJPRkZMSU5F\nIiwgIk9OTElORSIsICJQQ1RGUkVFIiwgIlJPVyIsCiAgICAgICAgfSkpOwoK\nICAgICAgICBzdWJzdHJpbmdGdW5jdGlvbk5hbWUgPSAiU1VCU1RSIjsKICAg\nICAgICBzdXBlci5zZXRCYXRjaExpbWl0KGRlZmF1bHRCYXRjaExpbWl0KTsK\nICAgICAgICBzZWxlY3RXb3JkU2V0LmFkZCgiV0lUSCIpOwogICAgfQoKICAg\nIHB1YmxpYyB2b2lkIGVuZENvbmZpZ3VyYXRpb24oKSB7CiAgICAgICAgc3Vw\nZXIuZW5kQ29uZmlndXJhdGlvbigpOwogICAgICAgIGlmICh1c2VUcmlnZ2Vy\nc0ZvckF1dG9Bc3NpZ24pCiAgICAgICAgICAgIHN1cHBvcnRzQXV0b0Fzc2ln\nbiA9IHRydWU7CiAgICB9CgogICAgcHVibGljIHZvaWQgY29ubmVjdGVkQ29u\nZmlndXJhdGlvbihDb25uZWN0aW9uIGNvbm4pCiAgICAgICAgdGhyb3dzIFNR\nTEV4Y2VwdGlvbiB7CiAgICAgICAgc3VwZXIuY29ubmVjdGVkQ29uZmlndXJh\ndGlvbihjb25uKTsKICAgICAgICBpZiAoZHJpdmVyVmVuZG9yID09IG51bGwp\nIHsKICAgICAgICAgICAgRGF0YWJhc2VNZXRhRGF0YSBtZXRhID0gY29ubi5n\nZXRNZXRhRGF0YSgpOwogICAgICAgICAgICBTdHJpbmcgdXJsID0gKG1ldGEu\nZ2V0VVJMKCkgPT0gbnVsbCkgPyAiIiA6IG1ldGEuZ2V0VVJMKCk7CiAgICAg\nICAgICAgIFN0cmluZyBkcml2ZXJOYW1lID0gbWV0YS5nZXREcml2ZXJOYW1l\nKCk7CiAgICAgICAgICAgIFN0cmluZyBtZXRhZGF0YUNsYXNzTmFtZTsKICAg\nICAgICAgICAgaWYgKG1ldGEgaW5zdGFuY2VvZiBEZWxlZ2F0aW5nRGF0YWJh\nc2VNZXRhRGF0YSkKICAgICAgICAgICAgICAgIG1ldGFkYXRhQ2xhc3NOYW1l\nID0gKChEZWxlZ2F0aW5nRGF0YWJhc2VNZXRhRGF0YSkgbWV0YSkuCiAgICAg\nICAgICAgICAgICAgICAgZ2V0SW5uZXJtb3N0RGVsZWdhdGUoKS5nZXRDbGFz\ncygpLmdldE5hbWUoKTsKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAg\nICAgbWV0YWRhdGFDbGFzc05hbWUgPSBtZXRhLmdldENsYXNzKCkuZ2V0TmFt\nZSgpOwoKICAgICAgICAgICAgLy8gY2hlY2sgYm90aCB0aGUgZHJpdmVyIGNs\nYXNzIG5hbWUgYW5kIHRoZSBVUkwgZm9yIGtub3duIHBhdHRlcm5zCiAgICAg\nICAgICAgIGlmIChtZXRhZGF0YUNsYXNzTmFtZS5zdGFydHNXaXRoKCJvcmFj\nbGUuIikKICAgICAgICAgICAgICAgIHx8IHVybC5pbmRleE9mKCJqZGJjOm9y\nYWNsZToiKSAhPSAtMQogICAgICAgICAgICAgICAgfHwgIk9yYWNsZSBKREJD\nIGRyaXZlciIuZXF1YWxzKGRyaXZlck5hbWUpKSB7CiAgICAgICAgICAgICAg\nICBkcml2ZXJWZW5kb3IgPSBWRU5ET1JfT1JBQ0xFICsgbWV0YS5nZXREcml2\nZXJNYWpvclZlcnNpb24oKQogICAgICAgICAgICAgICAgICAgICsgbWV0YS5n\nZXREcml2ZXJNaW5vclZlcnNpb24oKTsKCiAgICAgICAgICAgICAgICBTdHJp\nbmcgcHJvZHVjdFZlcnNpb24gPSBtZXRhLmdldERhdGFiYXNlUHJvZHVjdFZl\ncnNpb24oKQogICAgICAgICAgICAgICAgICAgIC5zcGxpdCgiUmVsZWFzZSAi\nLDApWzFdLnNwbGl0KCJcXC4iLDApWzBdOwogICAgICAgICAgICAgICAgaW50\nIHJlbGVhc2UgPSBJbnRlZ2VyLnBhcnNlSW50KHByb2R1Y3RWZXJzaW9uKTsK\nICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgLy8gd2FybiBzcWw5\nMgogICAgICAgICAgICAgICAgaWYgKHJlbGVhc2UgPD0gOCkgewogICAgICAg\nICAgICAgICAgICAgIGlmIChqb2luU3ludGF4ID09IFNZTlRBWF9TUUw5MiAm\nJiBsb2cuaXNXYXJuRW5hYmxlZCgpKQogICAgICAgICAgICAgICAgICAgICAg\nICBsb2cud2FybihfbG9jLmdldCgib3JhY2xlLXN5bnRheCIpKTsKICAgICAg\nICAgICAgICAgICAgICBqb2luU3ludGF4ID0gU1lOVEFYX0RBVEFCQVNFOwog\nICAgICAgICAgICAgICAgICAgIGRhdGVUeXBlTmFtZSA9ICJEQVRFIjsgLy8g\nYWRkZWQgb3JhY2xlIDkKICAgICAgICAgICAgICAgICAgICB0aW1lc3RhbXBU\neXBlTmFtZSA9ICJEQVRFIjsgLy8gYWRkZWQgb3JhY2xlIDkKICAgICAgICAg\nICAgICAgICAgICBzdXBwb3J0c1hNTENvbHVtbiA9IGZhbHNlOwogICAgICAg\nICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIC8vIHNlbGVjdCBvZiBh\nbiB4bWwgY29sdW1uIHJlcXVpcmVzICIuZ2V0U3RyaW5nVmFsKCkiCiAgICAg\nICAgICAgICAgICAgICAgLy8gc3VmZml4LiBlZy4gdDAueG1sY29sLmdldFN0\ncmluZ1ZhbCgpCiAgICAgICAgICAgICAgICAgICAgZ2V0U3RyaW5nVmFsID0g\nIi5nZXRTdHJpbmdWYWwoKSI7CiAgICAgICAgICAgIH0gZWxzZSBpZiAobWV0\nYWRhdGFDbGFzc05hbWUuc3RhcnRzV2l0aCgiY29tLmRkdGVrLiIpCiAgICAg\nICAgICAgICAgICB8fCB1cmwuaW5kZXhPZigiamRiYzpkYXRhZGlyZWN0Om9y\nYWNsZToiKSAhPSAtMQogICAgICAgICAgICAgICAgfHwgIk9yYWNsZSIuZXF1\nYWxzKGRyaXZlck5hbWUpKSB7CiAgICAgICAgICAgICAgICBkcml2ZXJWZW5k\nb3IgPSBWRU5ET1JfREFUQURJUkVDVCArIG1ldGEuZ2V0RHJpdmVyTWFqb3JW\nZXJzaW9uKCkKICAgICAgICAgICAgICAgICAgICArIG1ldGEuZ2V0RHJpdmVy\nTWlub3JWZXJzaW9uKCk7CiAgICAgICAgICAgIH0gZWxzZQogICAgICAgICAg\nICAgICAgZHJpdmVyVmVuZG9yID0gVkVORE9SX09USEVSOwogICAgICAgIH0K\nICAgICAgICBjYWNoZURyaXZlckJlaGF2aW9yKGRyaXZlclZlbmRvcik7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBDYWNoZSBjb25zdGFudCBmb3IgZHJpdmVy\ncyB3aXRoIGJlaGF2aW9ycyB3ZSBoYXZlIHRvIGRlYWwgd2l0aC4KICAgICAq\nLwogICAgcHJpdmF0ZSB2b2lkIGNhY2hlRHJpdmVyQmVoYXZpb3IoU3RyaW5n\nIGRyaXZlclZlbmRvcikgewogICAgICAgIGlmIChfZHJpdmVyQmVoYXZpb3Ig\nIT0gLTEpCiAgICAgICAgICAgIHJldHVybjsKCiAgICAgICAgZHJpdmVyVmVu\nZG9yID0gZHJpdmVyVmVuZG9yLnRvTG93ZXJDYXNlKCk7CiAgICAgICAgaWYg\nKGRyaXZlclZlbmRvci5zdGFydHNXaXRoKFZFTkRPUl9PUkFDTEUpKQogICAg\nICAgICAgICBfZHJpdmVyQmVoYXZpb3IgPSBCRUhBVkVfT1JBQ0xFOwogICAg\nICAgIGVsc2UgaWYgKGRyaXZlclZlbmRvci5lcXVhbHMoVkVORE9SX0RBVEFE\nSVJFQ1QgKyAiMzAiKQogICAgICAgICAgICB8fCBkcml2ZXJWZW5kb3IuZXF1\nYWxzKFZFTkRPUl9EQVRBRElSRUNUICsgIjMxIikpCiAgICAgICAgICAgIF9k\ncml2ZXJCZWhhdmlvciA9IEJFSEFWRV9EQVRBRElSRUNUMzE7CiAgICAgICAg\nZWxzZQogICAgICAgICAgICBfZHJpdmVyQmVoYXZpb3IgPSBCRUhBVkVfT1RI\nRVI7CiAgICB9CgogICAgLyoqCiAgICAgKiBFbnN1cmUgdGhhdCB0aGUgZHJp\ndmVyIHZlbmRvciBoYXMgYmVlbiBzZXQsIGFuZCBpZiBub3QsIHNldCBpdCBu\nb3cuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIGVuc3VyZURyaXZlclZlbmRv\ncigpIHsKICAgICAgICBpZiAoZHJpdmVyVmVuZG9yICE9IG51bGwpIHsKICAg\nICAgICAgICAgY2FjaGVEcml2ZXJCZWhhdmlvcihkcml2ZXJWZW5kb3IpOwog\nICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBpZiAobG9n\nLmlzSW5mb0VuYWJsZWQoKSkKICAgICAgICAgICAgbG9nLmluZm8oX2xvYy5n\nZXQoIm9yYWNsZS1jb25uZWN0aW5nLWZvci1kcml2ZXIiKSk7CiAgICAgICAg\nQ29ubmVjdGlvbiBjb25uID0gbnVsbDsKICAgICAgICB0cnkgewogICAgICAg\nICAgICBjb25uID0gY29uZi5nZXREYXRhU291cmNlMihudWxsKS5nZXRDb25u\nZWN0aW9uKCk7CiAgICAgICAgICAgIGNvbm5lY3RlZENvbmZpZ3VyYXRpb24o\nY29ubik7CiAgICAgICAgfSBjYXRjaCAoU1FMRXhjZXB0aW9uIHNlKSB7CiAg\nICAgICAgICAgIHRocm93IFNRTEV4Y2VwdGlvbnMuZ2V0U3RvcmUoc2UsIHRo\naXMpOwogICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgIGlmIChjb25u\nICE9IG51bGwpCiAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAg\nICAgICAgIGNvbm4uY2xvc2UoKTsKICAgICAgICAgICAgICAgIH0gY2F0Y2gg\nKFNRTEV4Y2VwdGlvbiBzZSkgewogICAgICAgICAgICAgICAgfQogICAgICAg\nIH0KICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBzdXBwb3J0c0xvY2tpbmco\nU2VsZWN0IHNlbCkgewogICAgICAgIGlmICghc3VwZXIuc3VwcG9ydHNMb2Nr\naW5nKHNlbCkpCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICBy\nZXR1cm4gIXJlcXVpcmVzU3Vic2VsZWN0Rm9yUmFuZ2Uoc2VsLmdldFN0YXJ0\nSW5kZXgoKSwKICAgICAgICAgICAgc2VsLmdldEVuZEluZGV4KCksIHNlbC5p\nc0Rpc3RpbmN0KCksIHNlbC5nZXRPcmRlcmluZygpKTsKICAgIH0KCiAgICBw\ncm90ZWN0ZWQgU1FMQnVmZmVyIGdldFNlbGVjdHMoU2VsZWN0IHNlbCwgYm9v\nbGVhbiBkaXN0aW5jdElkZW50aWZpZXJzLAogICAgICAgIGJvb2xlYW4gZm9y\nVXBkYXRlKSB7CiAgICAgICAgLy8gaWYgcmFuZ2UgZG9lc24ndCByZXF1aXJl\nIGEgc3Vic2VsZWN0IGNhbiB1c2Ugc3VwZXIKICAgICAgICBpZiAoIXJlcXVp\ncmVzU3Vic2VsZWN0Rm9yUmFuZ2Uoc2VsLmdldFN0YXJ0SW5kZXgoKSwKICAg\nICAgICAgICAgc2VsLmdldEVuZEluZGV4KCksIHNlbC5pc0Rpc3RpbmN0KCks\nIHNlbC5nZXRPcmRlcmluZygpKSkKICAgICAgICAgICAgcmV0dXJuIHN1cGVy\nLmdldFNlbGVjdHMoc2VsLCBkaXN0aW5jdElkZW50aWZpZXJzLCBmb3JVcGRh\ndGUpOwoKICAgICAgICAvLyBpZiB0aGVyZSBhcmUgbm8gam9pbnMgaW52b2x2\nZWQgb3Igd2UncmUgdXNpbmcgYSBmcm9tIHNlbGVjdCBzbwogICAgICAgIC8v\nIHRoYXQgYWxsIGNvbHMgYWxyZWFkeSBoYXZlIHVuaXF1ZSBhbGlhc2VzLCBj\nYW4gdXNlIHN1cGVyCiAgICAgICAgaWYgKHNlbC5nZXRGcm9tU2VsZWN0KCkg\nIT0gbnVsbCB8fCBzZWwuZ2V0VGFibGVBbGlhc2VzKCkuc2l6ZSgpIDwgMikK\nICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmdldFNlbGVjdHMoc2VsLCBkaXN0\naW5jdElkZW50aWZpZXJzLCBmb3JVcGRhdGUpOwoKICAgICAgICAvLyBzaW5j\nZSBub25lIG9mIHRoZSBjb25kaXRpb25zIGFib3ZlIHdlcmUgbWV0LCB3ZSdy\nZSBkZWFsaW5nIHdpdGgKICAgICAgICAvLyBhIHNlbGVjdCB0aGF0IHVzZXMg\nam9pbnMgYW5kIHJlcXVpcmVzIHN1YnNlbGVjdHMgdG8gc2VsZWN0IHRoZQog\nICAgICAgIC8vIHByb3BlciByYW5nZTsgYWxpYXMgYWxsIGNvbHVtbiB2YWx1\nZXMgc28gdGhhdCB0aGV5IGFyZSB1bmlxdWUgd2l0aGluCiAgICAgICAgLy8g\ndGhlIHN1YnNlbGVjdAogICAgICAgIFNRTEJ1ZmZlciBzZWxlY3RTUUwgPSBu\nZXcgU1FMQnVmZmVyKHRoaXMpOwogICAgICAgIExpc3QgYWxpYXNlczsKICAg\nICAgICBpZiAoZGlzdGluY3RJZGVudGlmaWVycykKICAgICAgICAgICAgYWxp\nYXNlcyA9IHNlbC5nZXRJZGVudGlmaWVyQWxpYXNlcygpOwogICAgICAgIGVs\nc2UKICAgICAgICAgICAgYWxpYXNlcyA9IHNlbC5nZXRTZWxlY3RBbGlhc2Vz\nKCk7CgogICAgICAgIE9iamVjdCBhbGlhczsKICAgICAgICBpbnQgaSA9IDA7\nCiAgICAgICAgZm9yIChJdGVyYXRvciBpdHIgPSBhbGlhc2VzLml0ZXJhdG9y\nKCk7IGl0ci5oYXNOZXh0KCk7IGkrKykgewogICAgICAgICAgICBhbGlhcyA9\nIGl0ci5uZXh0KCk7CiAgICAgICAgICAgIGlmIChhbGlhcyBpbnN0YW5jZW9m\nIFNRTEJ1ZmZlcikKICAgICAgICAgICAgICAgIHNlbGVjdFNRTC5hcHBlbmQo\nKFNRTEJ1ZmZlcikgYWxpYXMpOwogICAgICAgICAgICBlbHNlCiAgICAgICAg\nICAgICAgICBzZWxlY3RTUUwuYXBwZW5kKGFsaWFzLnRvU3RyaW5nKCkpOwog\nICAgICAgICAgICBzZWxlY3RTUUwuYXBwZW5kKCIgQVMgYyIpLmFwcGVuZChT\ndHJpbmcudmFsdWVPZihpKSk7CiAgICAgICAgICAgIGlmIChpdHIuaGFzTmV4\ndCgpKQogICAgICAgICAgICAgICAgc2VsZWN0U1FMLmFwcGVuZCgiLCAiKTsK\nICAgICAgICB9CiAgICAgICAgcmV0dXJuIHNlbGVjdFNRTDsKICAgIH0KCiAg\nICBwdWJsaWMgYm9vbGVhbiBjYW5PdXRlckpvaW4oaW50IHN5bnRheCwgRm9y\nZWlnbktleSBmaykgewogICAgICAgIGlmICghc3VwZXIuY2FuT3V0ZXJKb2lu\nKHN5bnRheCwgZmspKQogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAg\nICAgaWYgKGZrICE9IG51bGwgJiYgc3ludGF4ID09IFNZTlRBWF9EQVRBQkFT\nRSkgewogICAgICAgICAgICBpZiAoZmsuZ2V0Q29uc3RhbnRzKCkubGVuZ3Ro\nID4gMCkKICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAg\nICAgaWYgKGZrLmdldFByaW1hcnlLZXlDb25zdGFudHMoKS5sZW5ndGggPiAw\nKQogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAg\nICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBwdWJsaWMgU1FMQnVmZmVy\nIHRvTmF0aXZlSm9pbihKb2luIGpvaW4pIHsKICAgICAgICBpZiAoam9pbi5n\nZXRUeXBlKCkgIT0gSm9pbi5UWVBFX09VVEVSKQogICAgICAgICAgICByZXR1\ncm4gdG9UcmFkaXRpb25hbEpvaW4oam9pbik7CgogICAgICAgIEZvcmVpZ25L\nZXkgZmsgPSBqb2luLmdldEZvcmVpZ25LZXkoKTsKICAgICAgICBpZiAoZmsg\nPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIG51bGw7CgogICAgICAgIGJv\nb2xlYW4gaW52ZXJzZSA9IGpvaW4uaXNGb3JlaWduS2V5SW52ZXJzZWQoKTsK\nICAgICAgICBDb2x1bW5bXSBmcm9tID0gKGludmVyc2UpID8gZmsuZ2V0UHJp\nbWFyeUtleUNvbHVtbnMoKQogICAgICAgICAgICA6IGZrLmdldENvbHVtbnMo\nKTsKICAgICAgICBDb2x1bW5bXSB0byA9IChpbnZlcnNlKSA/IGZrLmdldENv\nbHVtbnMoKQogICAgICAgICAgICA6IGZrLmdldFByaW1hcnlLZXlDb2x1bW5z\nKCk7CgogICAgICAgIC8vIGRvIGNvbHVtbiBqb2lucwogICAgICAgIFNRTEJ1\nZmZlciBidWYgPSBuZXcgU1FMQnVmZmVyKHRoaXMpOwogICAgICAgIGludCBj\nb3VudCA9IDA7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBmcm9tLmxl\nbmd0aDsgaSsrLCBjb3VudCsrKSB7CiAgICAgICAgICAgIGlmIChjb3VudCA+\nIDApCiAgICAgICAgICAgICAgICBidWYuYXBwZW5kKCIgQU5EICIpOwogICAg\nICAgICAgICBidWYuYXBwZW5kKGpvaW4uZ2V0QWxpYXMxKCkpLmFwcGVuZCgi\nLiIpLmFwcGVuZChmcm9tW2ldKTsKICAgICAgICAgICAgYnVmLmFwcGVuZCgi\nID0gIik7CiAgICAgICAgICAgIGJ1Zi5hcHBlbmQoam9pbi5nZXRBbGlhczIo\nKSkuYXBwZW5kKCIuIikuYXBwZW5kKHRvW2ldKTsKICAgICAgICAgICAgYnVm\nLmFwcGVuZCgiKCspIik7CiAgICAgICAgfQoKICAgICAgICAvLyBjaGVjayBj\nb25zdGFudCBqb2lucwogICAgICAgIGlmIChmay5nZXRDb25zdGFudENvbHVt\nbnMoKS5sZW5ndGggPiAwKQogICAgICAgICAgICB0aHJvdyBuZXcgU3RvcmVF\neGNlcHRpb24oX2xvYy5nZXQoIm9yYWNsZS1jb25zdGFudCIsCiAgICAgICAg\nICAgICAgICBqb2luLmdldFRhYmxlMSgpLCBqb2luLmdldFRhYmxlMigpKSku\nc2V0RmF0YWwodHJ1ZSk7CgogICAgICAgIGlmIChmay5nZXRDb25zdGFudFBy\naW1hcnlLZXlDb2x1bW5zKCkubGVuZ3RoID4gMCkKICAgICAgICAgICAgdGhy\nb3cgbmV3IFN0b3JlRXhjZXB0aW9uKF9sb2MuZ2V0KCJvcmFjbGUtY29uc3Rh\nbnQiLAogICAgICAgICAgICAgICAgam9pbi5nZXRUYWJsZTEoKSwgam9pbi5n\nZXRUYWJsZTIoKSkpLnNldEZhdGFsKHRydWUpOwogICAgICAgIHJldHVybiBi\ndWY7CiAgICB9CgogICAgcHVibGljIFNRTEJ1ZmZlciB0b1NlbGVjdChTUUxC\ndWZmZXIgc2VsZWN0LCBKREJDRmV0Y2hDb25maWd1cmF0aW9uIGZldGNoLAog\nICAgICAgIFNRTEJ1ZmZlciB0YWJsZXMsIFNRTEJ1ZmZlciB3aGVyZSwgU1FM\nQnVmZmVyIGdyb3VwLAogICAgICAgIFNRTEJ1ZmZlciBoYXZpbmcsIFNRTEJ1\nZmZlciBvcmRlciwKICAgICAgICBib29sZWFuIGRpc3RpbmN0LCBib29sZWFu\nIGZvclVwZGF0ZSwgbG9uZyBzdGFydCwgbG9uZyBlbmQsCiAgICAgICAgU2Vs\nZWN0IHNlbCkgewogICAgICAgIGlmICghX2NoZWNrZWRVcGRhdGVCdWcpIHsK\nICAgICAgICAgICAgZW5zdXJlRHJpdmVyVmVuZG9yKCk7CiAgICAgICAgICAg\nIGlmIChmb3JVcGRhdGUgJiYgX2RyaXZlckJlaGF2aW9yID09IEJFSEFWRV9E\nQVRBRElSRUNUMzEpCiAgICAgICAgICAgICAgICBsb2cud2FybihfbG9jLmdl\ndCgiZGQtbG9jay1idWciKSk7CiAgICAgICAgICAgIF9jaGVja2VkVXBkYXRl\nQnVnID0gdHJ1ZTsKICAgICAgICB9CgogICAgICAgIC8vIGlmIG5vIHJhbmdl\nLCB1c2Ugc3RhbmRhcmQgc2VsZWN0CiAgICAgICAgaWYgKHN0YXJ0ID09IDAg\nJiYgZW5kID09IExvbmcuTUFYX1ZBTFVFKQogICAgICAgICAgICByZXR1cm4g\nc3VwZXIudG9TZWxlY3Qoc2VsZWN0LCBmZXRjaCwgdGFibGVzLCB3aGVyZSwg\nZ3JvdXAsIGhhdmluZywKICAgICAgICAgICAgICAgIG9yZGVyLCBkaXN0aW5j\ndCwgZm9yVXBkYXRlLCAwLCBMb25nLk1BWF9WQUxVRSwgc2VsKTsKCiAgICAg\nICAgLy8gaWYgbm8gc2tpcCwgb3JkZXJpbmcsIG9yIGRpc3RpbmN0IGNhbiB1\nc2Ugcm93bnVtIGRpcmVjdGx5CiAgICAgICAgU1FMQnVmZmVyIGJ1ZiA9IG5l\ndyBTUUxCdWZmZXIodGhpcyk7CiAgICAgICAgaWYgKCFyZXF1aXJlc1N1YnNl\nbGVjdEZvclJhbmdlKHN0YXJ0LCBlbmQsIGRpc3RpbmN0LCBvcmRlcikpIHsK\nICAgICAgICAgICAgaWYgKHdoZXJlICE9IG51bGwgJiYgIXdoZXJlLmlzRW1w\ndHkoKSkKICAgICAgICAgICAgICAgIGJ1Zi5hcHBlbmQod2hlcmUpLmFwcGVu\nZCgiIEFORCAiKTsKICAgICAgICAgICAgYnVmLmFwcGVuZCgiUk9XTlVNIDw9\nICIpLmFwcGVuZFZhbHVlKGVuZCk7CiAgICAgICAgICAgIHJldHVybiBzdXBl\nci50b1NlbGVjdChzZWxlY3QsIGZldGNoLCB0YWJsZXMsIGJ1ZiwgZ3JvdXAs\nIGhhdmluZywKICAgICAgICAgICAgICAgIG9yZGVyLCBkaXN0aW5jdCwgZm9y\nVXBkYXRlLCAwLCBMb25nLk1BWF9WQUxVRSwgc2VsKTsKICAgICAgICB9Cgog\nICAgICAgIC8vIGlmIHRoZXJlIGlzIG9yZGVyaW5nLCBza2lwLCBvciBkaXN0\naW5jdCB3ZSBoYXZlIHRvIHVzZSBzdWJzZWxlY3RzCiAgICAgICAgU1FMQnVm\nZmVyIG5ld3NlbCA9IHN1cGVyLnRvU2VsZWN0KHNlbGVjdCwgZmV0Y2gsIHRh\nYmxlcywgd2hlcmUsCiAgICAgICAgICAgIGdyb3VwLCBoYXZpbmcsIG9yZGVy\nLCBkaXN0aW5jdCwgZm9yVXBkYXRlLCAwLCBMb25nLk1BWF9WQUxVRSwKICAg\nICAgICAgICAgc2VsKTsKCiAgICAgICAgLy8gaWYgbm8gc2tpcCwgY2FuIHVz\nZSBzaW5nbGUgbmVzdGVkIHN1YnNlbGVjdAogICAgICAgIGlmIChzdGFydCA9\nPSAwKSB7CiAgICAgICAgICAgIGJ1Zi5hcHBlbmQoZ2V0U2VsZWN0T3BlcmF0\naW9uKGZldGNoKSArICIgKiBGUk9NICgiKTsKICAgICAgICAgICAgYnVmLmFw\ncGVuZChuZXdzZWwpOwogICAgICAgICAgICBidWYuYXBwZW5kKCIpIFdIRVJF\nIFJPV05VTSA8PSAiKS5hcHBlbmRWYWx1ZShlbmQpOwogICAgICAgICAgICBy\nZXR1cm4gYnVmOwogICAgICAgIH0KCiAgICAgICAgLy8gd2l0aCBhIHNraXAs\nIHdlIGhhdmUgdG8gdXNlIGEgZG91YmxlLW5lc3RlZCBzdWJzZWxlY3QgdG8g\ncHV0CiAgICAgICAgLy8gd2hlcmUgY29uZGl0aW9ucyBvbiB0aGUgcm93bnVt\nCiAgICAgICAgYnVmLmFwcGVuZChnZXRTZWxlY3RPcGVyYXRpb24oZmV0Y2gp\nCiAgICAgICAgICAgICsgIiAqIEZST00gKFNFTEVDVCByLiosIFJPV05VTSBS\nTlVNIEZST00gKCIpOwogICAgICAgIGJ1Zi5hcHBlbmQobmV3c2VsKTsKICAg\nICAgICBidWYuYXBwZW5kKCIpIHIiKTsKICAgICAgICBpZiAoZW5kICE9IExv\nbmcuTUFYX1ZBTFVFKQogICAgICAgICAgICBidWYuYXBwZW5kKCIgV0hFUkUg\nUk9XTlVNIDw9ICIpLmFwcGVuZFZhbHVlKGVuZCk7CiAgICAgICAgYnVmLmFw\ncGVuZCgiKSBXSEVSRSBSTlVNID4gIikuYXBwZW5kVmFsdWUoc3RhcnQpOwog\nICAgICAgIHJldHVybiBidWY7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1\ncm4gdHJ1ZSBpZiB0aGUgc2VsZWN0IHdpdGggdGhlIGdpdmVuIHBhcmFtZXRl\ncnMgbmVlZHMgYQogICAgICogc3Vic2VsZWN0IHRvIGFwcGx5IGEgcmFuZ2Uu\nCiAgICAgKi8KICAgIHByaXZhdGUgYm9vbGVhbiByZXF1aXJlc1N1YnNlbGVj\ndEZvclJhbmdlKGxvbmcgc3RhcnQsIGxvbmcgZW5kLAogICAgICAgIGJvb2xl\nYW4gZGlzdGluY3QsIFNRTEJ1ZmZlciBvcmRlcikgewogICAgICAgIGlmIChz\ndGFydCA9PSAwICYmIGVuZCA9PSBMb25nLk1BWF9WQUxVRSkKICAgICAgICAg\nICAgcmV0dXJuIGZhbHNlOwogICAgICAgIHJldHVybiBzdGFydCAhPSAwIHx8\nIGRpc3RpbmN0IHx8IChvcmRlciAhPSBudWxsICYmICFvcmRlci5pc0VtcHR5\nKCkpOwogICAgfQoKICAgIC8qKgogICAgICogQ2hlY2sgdG8gc2VlIGlmIHdl\nIGhhdmUgc2V0IHRoZSB7QGxpbmsgI1NFTEVDVF9ISU5UfSBpbiB0aGUKICAg\nICAqIGZldGNoIGNvbmZpZ3VyYWl0b24sIGFuZCBpZiBzbywgYXBwZW5kIHRo\nZSBPcmFjaGUgaGludCBhZnRlciB0aGUKICAgICAqICJTRUxFQ1QiIHBhcnQg\nb2YgdGhlIHF1ZXJ5LgogICAgICovCiAgICBwdWJsaWMgU3RyaW5nIGdldFNl\nbGVjdE9wZXJhdGlvbihKREJDRmV0Y2hDb25maWd1cmF0aW9uIGZldGNoKSB7\nCiAgICAgICAgT2JqZWN0IGhpbnQgPSBmZXRjaCA9PSBudWxsID8gbnVsbCA6\nIGZldGNoLmdldEhpbnQoU0VMRUNUX0hJTlQpOwogICAgICAgIFN0cmluZyBz\nZWxlY3QgPSAiU0VMRUNUIjsKICAgICAgICBpZiAoaGludCAhPSBudWxsKQog\nICAgICAgICAgICBzZWxlY3QgKz0gIiAiICsgaGludDsKICAgICAgICByZXR1\ncm4gc2VsZWN0OwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldFN0cmluZyhQ\ncmVwYXJlZFN0YXRlbWVudCBzdG1udCwgaW50IGlkeCwgU3RyaW5nIHZhbCwK\nICAgICAgICBDb2x1bW4gY29sKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRp\nb24gewogICAgICAgIC8vIG9yYWNsZSBOQ0hBUi9OVkFSQ0hBUi9OQ0xPQiB1\nbmljb2RlIGNvbHVtbnMgcmVxdWlyZSBzb21lCiAgICAgICAgLy8gc3BlY2lh\nbCBoYW5kbGluZyB0byBjb25maWd1cmUgdGhlbSBjb3JyZWN0bHk7IHNlZToK\nICAgICAgICAvLyBodHRwOi8vd3d3Lm9yYWNsZS5jb20vdGVjaG5vbG9neS9z\nYW1wbGVfY29kZS90ZWNoL2phdmEvCiAgICAgICAgLy8gc3Fsal9qZGJjL2Zp\nbGVzLzlpX2pkYmMvTkNIQVJzdXBwb3J0NFVuaWNvZGVTYW1wbGUvUmVhZG1l\nLmh0bWwKICAgICAgICBTdHJpbmcgdHlwZU5hbWUgPSAoY29sID09IG51bGwp\nID8gbnVsbCA6IGNvbC5nZXRUeXBlTmFtZSgpOwogICAgICAgIGlmICh1c2VT\nZXRGb3JtT2ZVc2VGb3JVbmljb2RlICYmIHR5cGVOYW1lICE9IG51bGwgJiYK\nICAgICAgICAgICAgKHR5cGVOYW1lLnRvTG93ZXJDYXNlKCkuc3RhcnRzV2l0\naCgibnZhcmNoYXIiKSB8fAogICAgICAgICAgICAgICAgdHlwZU5hbWUudG9M\nb3dlckNhc2UoKS5zdGFydHNXaXRoKCJuY2hhciIpIHx8CiAgICAgICAgICAg\nICAgICB0eXBlTmFtZS50b0xvd2VyQ2FzZSgpLnN0YXJ0c1dpdGgoIm5jbG9i\nIikpKSB7CiAgICAgICAgICAgIFN0YXRlbWVudCBpbm5lciA9IHN0bW50Owog\nICAgICAgICAgICBpZiAoaW5uZXIgaW5zdGFuY2VvZiBEZWxlZ2F0aW5nUHJl\ncGFyZWRTdGF0ZW1lbnQpCiAgICAgICAgICAgICAgICBpbm5lciA9ICgoRGVs\nZWdhdGluZ1ByZXBhcmVkU3RhdGVtZW50KSBpbm5lcikuCiAgICAgICAgICAg\nICAgICAgICAgZ2V0SW5uZXJtb3N0RGVsZWdhdGUoKTsKICAgICAgICAgICAg\naWYgKGlzT3JhY2xlUHJlcGFyZWRTdGF0ZW1lbnQoaW5uZXIpKSB7CiAgICAg\nICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgIGlubmVyLmdl\ndENsYXNzKCkuZ2V0TWV0aG9kKCJzZXRGb3JtT2ZVc2UiLAogICAgICAgICAg\nICAgICAgICAgICAgICBuZXcgQ2xhc3NbXXsgaW50LmNsYXNzLCBzaG9ydC5j\nbGFzcyB9KS4KICAgICAgICAgICAgICAgICAgICAgICAgaW52b2tlKGlubmVy\nLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3IE9iamVjdFtdewog\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBJbnRlZ2VyKGlk\neCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQ2xhc3MuZm9y\nTmFtZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoIm9y\nYWNsZS5qZGJjLk9yYWNsZVByZXBhcmVkU3RhdGVtZW50IikuCiAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdldEZpZWxkKCJGT1JNX05D\nSEFSIikuZ2V0KG51bGwpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9\nKTsKICAgICAgICAgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAg\nICAgICAgICAgICAgICAgICAgbG9nLndhcm4oZSk7CiAgICAgICAgICAgICAg\nICB9CiAgICAgICAgICAgIH0gZWxzZSBpZiAoIV93YXJuZWROY2hhckNvbHVt\nbiAmJiBsb2cuaXNXYXJuRW5hYmxlZCgpKSB7CiAgICAgICAgICAgICAgICBf\nd2FybmVkTmNoYXJDb2x1bW4gPSB0cnVlOwogICAgICAgICAgICAgICAgbG9n\nLndhcm4oX2xvYy5nZXQoInVuY29uZmlndXJlZC1uY2hhci1jb2xzIikpOwog\nICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAvLyBjYWxsIHNldEZp\neGVkQ0hBUiBmb3IgZml4ZWQgd2lkdGggY2hhcmFjdGVyIGNvbHVtbnMgdG8g\nZ2V0IHBhZGRpbmcKICAgICAgICAvLyBzZW1hbnRpY3MKICAgICAgICBpZiAo\nY29sICE9IG51bGwgJiYgY29sLmdldFR5cGUoKSA9PSBUeXBlcy5DSEFSCiAg\nICAgICAgICAgICYmIHZhbCAhPSBudWxsICYmIHZhbC5sZW5ndGgoKSAhPSBj\nb2wuZ2V0U2l6ZSgpKSB7CiAgICAgICAgICAgIFN0YXRlbWVudCBpbm5lciA9\nIHN0bW50OwogICAgICAgICAgICBpZiAoaW5uZXIgaW5zdGFuY2VvZiBEZWxl\nZ2F0aW5nUHJlcGFyZWRTdGF0ZW1lbnQpCiAgICAgICAgICAgICAgICBpbm5l\nciA9ICgoRGVsZWdhdGluZ1ByZXBhcmVkU3RhdGVtZW50KSBpbm5lcikuCiAg\nICAgICAgICAgICAgICAgICAgZ2V0SW5uZXJtb3N0RGVsZWdhdGUoKTsKICAg\nICAgICAgICAgaWYgKGlzT3JhY2xlUHJlcGFyZWRTdGF0ZW1lbnQoaW5uZXIp\nKSB7CiAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAg\nIGlubmVyLmdldENsYXNzKCkuZ2V0TWV0aG9kKCJzZXRGaXhlZENIQVIiLAog\nICAgICAgICAgICAgICAgICAgICAgICBuZXcgQ2xhc3NbXXsgaW50LmNsYXNz\nLCBTdHJpbmcuY2xhc3MgfSkuCiAgICAgICAgICAgICAgICAgICAgICAgIGlu\ndm9rZShpbm5lciwgbmV3IE9iamVjdFtdeyBuZXcgSW50ZWdlcihpZHgpLCB2\nYWwgfSk7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAg\nICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgICAg\nICAgICBsb2cud2FybihlKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAg\nICAgfQoKICAgICAgICAgICAgaWYgKCFfd2FybmVkQ2hhckNvbHVtbiAmJiBs\nb2cuaXNXYXJuRW5hYmxlZCgpKSB7CiAgICAgICAgICAgICAgICBfd2FybmVk\nQ2hhckNvbHVtbiA9IHRydWU7CiAgICAgICAgICAgICAgICBsb2cud2Fybihf\nbG9jLmdldCgidW5wYWRkZWQtY2hhci1jb2xzIikpOwogICAgICAgICAgICB9\nCiAgICAgICAgfQogICAgICAgIHN1cGVyLnNldFN0cmluZyhzdG1udCwgaWR4\nLCB2YWwsIGNvbCk7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0TnVsbChQ\ncmVwYXJlZFN0YXRlbWVudCBzdG1udCwgaW50IGlkeCwgaW50IGNvbFR5cGUs\nCiAgICAgICAgQ29sdW1uIGNvbCkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0\naW9uIHsKICAgICAgICBpZiAoY29sVHlwZSA9PSBUeXBlcy5CTE9CICYmIF9k\ncml2ZXJCZWhhdmlvciA9PSBCRUhBVkVfT1JBQ0xFKQogICAgICAgICAgICBz\ndG1udC5zZXRCbG9iKGlkeCwgZ2V0RW1wdHlCbG9iKCkpOwogICAgICAgIGVs\nc2UgaWYgKGNvbFR5cGUgPT0gVHlwZXMuQ0xPQiAmJiBfZHJpdmVyQmVoYXZp\nb3IgPT0gQkVIQVZFX09SQUNMRQogICAgICAgICAgICAmJiAhY29sLmlzWE1M\nKCkpCiAgICAgICAgICAgIHN0bW50LnNldENsb2IoaWR4LCBnZXRFbXB0eUNs\nb2IoKSk7CiAgICAgICAgZWxzZSBpZiAoKGNvbFR5cGUgPT0gVHlwZXMuU1RS\nVUNUIHx8IGNvbFR5cGUgPT0gVHlwZXMuT1RIRVIpCiAgICAgICAgICAgICYm\nIGNvbCAhPSBudWxsICYmIGNvbC5nZXRUeXBlTmFtZSgpICE9IG51bGwpCiAg\nICAgICAgICAgIHN0bW50LnNldE51bGwoaWR4LCBUeXBlcy5TVFJVQ1QsIGNv\nbC5nZXRUeXBlTmFtZSgpKTsKICAgICAgICAgICAgLy8gc29tZSB2ZXJzaW9u\ncyBvZiB0aGUgT3JhY2xlIEpEQkMgZHJpdmVyIHdpbGwgZmFpbCBpZiBjYWxs\naW5nCiAgICAgICAgICAgIC8vIHNldE51bGwgd2l0aCBEQVRFOyBzZWUgYnVn\nICMxMTcxCiAgICAgICAgZWxzZSBpZiAoY29sVHlwZSA9PSBUeXBlcy5EQVRF\nKQogICAgICAgICAgICBzdXBlci5zZXROdWxsKHN0bW50LCBpZHgsIFR5cGVz\nLlRJTUVTVEFNUCwgY29sKTsKICAgICAgICAvLyB0aGUgT3JhY2xlIGRyaXZl\nciBkb2VzIG5vdCBzdXBwb3J0IFR5cGVzLk9USEVSIHdpdGggc2V0TnVsbAog\nICAgICAgIGVsc2UgaWYgKGNvbFR5cGUgPT0gVHlwZXMuT1RIRVIgfHwgY29s\nLmlzWE1MKCkpCiAgICAgICAgICAgIHN1cGVyLnNldE51bGwoc3RtbnQsIGlk\neCwgVHlwZXMuTlVMTCwgY29sKTsKICAgICAgICBlbHNlCiAgICAgICAgICAg\nIHN1cGVyLnNldE51bGwoc3RtbnQsIGlkeCwgY29sVHlwZSwgY29sKTsKICAg\nIH0KCiAgICBwdWJsaWMgU3RyaW5nIGdldENsb2JTdHJpbmcoUmVzdWx0U2V0\nIHJzLCBpbnQgY29sdW1uKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24g\newogICAgICAgIGlmIChfZHJpdmVyQmVoYXZpb3IgIT0gQkVIQVZFX09SQUNM\nRSkKICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmdldENsb2JTdHJpbmcocnMs\nIGNvbHVtbik7CgogICAgICAgIENsb2IgY2xvYiA9IGdldENsb2IocnMsIGNv\nbHVtbik7CiAgICAgICAgaWYgKGNsb2IgPT0gbnVsbCkKICAgICAgICAgICAg\ncmV0dXJuIG51bGw7CiAgICAgICAgaWYgKGNsb2IuZ2V0Q2xhc3MoKS5nZXRO\nYW1lKCkuZXF1YWxzKCJvcmFjbGUuc3FsLkNMT0IiKSkgewogICAgICAgICAg\nICB0cnkgewogICAgICAgICAgICAgICAgaWYgKCgoQm9vbGVhbikgQ2xhc3Mu\nZm9yTmFtZSgib3JhY2xlLnNxbC5DTE9CIikuCiAgICAgICAgICAgICAgICAg\nICAgZ2V0TWV0aG9kKCJpc0VtcHR5TG9iIiwgbmV3IENsYXNzWzBdKS4KICAg\nICAgICAgICAgICAgICAgICBpbnZva2UoY2xvYiwgbmV3IE9iamVjdFswXSkp\nLgogICAgICAgICAgICAgICAgICAgIGJvb2xlYW5WYWx1ZSgpKQogICAgICAg\nICAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgICAgICB9IGNhdGNo\nIChFeGNlcHRpb24gZSkgewogICAgICAgICAgICAgICAgLy8gcG9zc2libHkg\nZGlmZmVyZW50IHZlcnNpb24gb2YgdGhlIGRyaXZlcgogICAgICAgICAgICB9\nCiAgICAgICAgfQogICAgICAgIGlmIChjbG9iLmxlbmd0aCgpID09IDApCiAg\nICAgICAgICAgIHJldHVybiBudWxsOwoKICAgICAgICAvLyB1bmxpa2VseSB0\naGF0IHdlJ2xsIGhhdmUgc3RyaW5ncyBvdmVyIDQgYmlsbGlvbiBjaGFycwog\nICAgICAgIHJldHVybiBjbG9iLmdldFN1YlN0cmluZygxLCAoaW50KSBjbG9i\nLmxlbmd0aCgpKTsKICAgIH0KCiAgICBwdWJsaWMgVGltZXN0YW1wIGdldFRp\nbWVzdGFtcChSZXN1bHRTZXQgcnMsIGludCBjb2x1bW4sIENhbGVuZGFyIGNh\nbCkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBpZiAo\nY2FsID09IG51bGwpIHsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAg\nICAgIHJldHVybiBzdXBlci5nZXRUaW1lc3RhbXAocnMsIGNvbHVtbiwgY2Fs\nKTsKICAgICAgICAgICAgfSBjYXRjaCAoQXJyYXlJbmRleE91dE9mQm91bmRz\nRXhjZXB0aW9uIGFlKSB7CiAgICAgICAgICAgICAgICAvLyBDUjI5NTYwNDog\naXNzdWUgYSB3YXJuaW5nIHRoaXMgdGhpcyBidWcgY2FuIGJlIGdvdHRlbgog\nICAgICAgICAgICAgICAgLy8gYXJvdW5kIHdpdGggU3VwcG9ydHNUaW1lc3Rh\nbXBOYW5vcz1mYWxzZQogICAgICAgICAgICAgICAgbG9nLndhcm4oX2xvYy5n\nZXQoIm9yYWNsZS10aW1lc3RhbXAtYnVnIiksIGFlKTsKICAgICAgICAgICAg\nICAgIHRocm93IGFlOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAg\nICAvLyBoYW5kbGUgT3JhY2xlIGJ1ZyB3aGVyZSBuYW5vcyBub3QgcmV0dXJu\nZWQgZnJvbSBjYWxsIHdpdGggQ2FsZW5kYXIKICAgICAgICAvLyBwYXJhbWV0\nZXIKICAgICAgICBUaW1lc3RhbXAgdHMgPSBycy5nZXRUaW1lc3RhbXAoY29s\ndW1uLCBjYWwpOwogICAgICAgIGlmICh0cyAhPSBudWxsICYmIHRzLmdldE5h\nbm9zKCkgPT0gMCkKICAgICAgICAgICAgdHMuc2V0TmFub3MocnMuZ2V0VGlt\nZXN0YW1wKGNvbHVtbikuZ2V0TmFub3MoKSk7CiAgICAgICAgcmV0dXJuIHRz\nOwogICAgfQoKICAgIHB1YmxpYyBPYmplY3QgZ2V0T2JqZWN0KFJlc3VsdFNl\ndCBycywgaW50IGNvbHVtbiwgTWFwIG1hcCkKICAgICAgICB0aHJvd3MgU1FM\nRXhjZXB0aW9uIHsKICAgICAgICAvLyByZWNlbnQgb3JhY2xlIGRyaXZlcnMg\ncmV0dXJuIG9yYWNsZS1zcGVjaWZpYyB0eXBlcyBmb3IgdGltZXN0YW1wcwog\nICAgICAgIC8vIGFuZCBkYXRlcwogICAgICAgIE9iamVjdCBvYmogPSBzdXBl\nci5nZXRPYmplY3QocnMsIGNvbHVtbiwgbWFwKTsKICAgICAgICBpZiAob2Jq\nID09IG51bGwpCiAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgIGlm\nICgib3JhY2xlLnNxbC5EQVRFIi5lcXVhbHMob2JqLmdldENsYXNzKCkuZ2V0\nTmFtZSgpKSkKICAgICAgICAgICAgb2JqID0gY29udmVydEZyb21PcmFjbGVU\neXBlKG9iaiwgImRhdGVWYWx1ZSIpOwogICAgICAgIGVsc2UgaWYgKCJvcmFj\nbGUuc3FsLlRJTUVTVEFNUCIuZXF1YWxzKG9iai5nZXRDbGFzcygpLmdldE5h\nbWUoKSkpCiAgICAgICAgICAgIG9iaiA9IGNvbnZlcnRGcm9tT3JhY2xlVHlw\nZShvYmosICJ0aW1lc3RhbXBWYWx1ZSIpOwogICAgICAgIHJldHVybiBvYmo7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBDb252ZXJ0IGFuIG9iamVjdCBmcm9t\nIGl0cyBwcm9wcmlldGFyeSBPcmFjbGUgdHlwZSB0byB0aGUgc3RhbmRhcmQK\nICAgICAqIEphdmEgdHlwZS4KICAgICAqLwogICAgcHJpdmF0ZSBzdGF0aWMg\nT2JqZWN0IGNvbnZlcnRGcm9tT3JhY2xlVHlwZShPYmplY3Qgb2JqLAogICAg\nICAgIFN0cmluZyBjb252ZXJ0TWV0aG9kKQogICAgICAgIHRocm93cyBTUUxF\neGNlcHRpb24gewogICAgICAgIHRyeSB7CiAgICAgICAgICAgIE1ldGhvZCBt\nID0gb2JqLmdldENsYXNzKCkuZ2V0TWV0aG9kKGNvbnZlcnRNZXRob2QsIChD\nbGFzc1tdKSBudWxsKTsKICAgICAgICAgICAgcmV0dXJuIG0uaW52b2tlKG9i\naiwgKE9iamVjdFtdKSBudWxsKTsKICAgICAgICB9IGNhdGNoIChUaHJvd2Fi\nbGUgdCkgewogICAgICAgICAgICBpZiAodCBpbnN0YW5jZW9mIEludm9jYXRp\nb25UYXJnZXRFeGNlcHRpb24pCiAgICAgICAgICAgICAgICB0ID0gKChJbnZv\nY2F0aW9uVGFyZ2V0RXhjZXB0aW9uKSB0KS5nZXRUYXJnZXRFeGNlcHRpb24o\nKTsKICAgICAgICAgICAgaWYgKHQgaW5zdGFuY2VvZiBTUUxFeGNlcHRpb24p\nCiAgICAgICAgICAgICAgICB0aHJvdyhTUUxFeGNlcHRpb24pIHQ7CiAgICAg\nICAgICAgIHRocm93IG5ldyBTUUxFeGNlcHRpb24odC5nZXRNZXNzYWdlKCkp\nOwogICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMgQ29sdW1uW10gZ2V0Q29s\ndW1ucyhEYXRhYmFzZU1ldGFEYXRhIG1ldGEsIFN0cmluZyBjYXRhbG9nLAog\nICAgICAgIFN0cmluZyBzY2hlbWFOYW1lLCBTdHJpbmcgdGFibGVOYW1lLCBT\ndHJpbmcgY29sdW1uTmFtZSwgQ29ubmVjdGlvbiBjb25uKQogICAgICAgIHRo\ncm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIENvbHVtbltdIGNvbHMgPSBz\ndXBlci5nZXRDb2x1bW5zKG1ldGEsIGNhdGFsb2csIHNjaGVtYU5hbWUsIHRh\nYmxlTmFtZSwKICAgICAgICAgICAgY29sdW1uTmFtZSwgY29ubik7CgogICAg\nICAgIGZvciAoaW50IGkgPSAwOyBjb2xzICE9IG51bGwgJiYgaSA8IGNvbHMu\nbGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgaWYgKGNvbHNbaV0uZ2V0VHlw\nZU5hbWUoKSA9PSBudWxsKQogICAgICAgICAgICAgICAgY29udGludWU7CiAg\nICAgICAgICAgIGlmIChjb2xzW2ldLmdldFR5cGVOYW1lKCkudG9VcHBlckNh\nc2UoKS5zdGFydHNXaXRoKCJUSU1FU1RBTVAiKSkKICAgICAgICAgICAgICAg\nIGNvbHNbaV0uc2V0VHlwZShUeXBlcy5USU1FU1RBTVApOwogICAgICAgICAg\nICBlbHNlIGlmICgiQkxPQiIuZXF1YWxzSWdub3JlQ2FzZShjb2xzW2ldLmdl\ndFR5cGVOYW1lKCkpKQogICAgICAgICAgICAgICAgY29sc1tpXS5zZXRUeXBl\nKFR5cGVzLkJMT0IpOwogICAgICAgICAgICBlbHNlIGlmICgiQ0xPQiIuZXF1\nYWxzSWdub3JlQ2FzZShjb2xzW2ldLmdldFR5cGVOYW1lKCkpCiAgICAgICAg\nICAgICAgICB8fCAiTkNMT0IiLmVxdWFsc0lnbm9yZUNhc2UoY29sc1tpXS5n\nZXRUeXBlTmFtZSgpKSkKICAgICAgICAgICAgICAgIGNvbHNbaV0uc2V0VHlw\nZShUeXBlcy5DTE9CKTsKICAgICAgICAgICAgZWxzZSBpZiAoIkZMT0FUIi5l\ncXVhbHNJZ25vcmVDYXNlKGNvbHNbaV0uZ2V0VHlwZU5hbWUoKSkpCiAgICAg\nICAgICAgICAgICBjb2xzW2ldLnNldFR5cGUoVHlwZXMuRkxPQVQpOwogICAg\nICAgICAgICBlbHNlIGlmICgiTlZBUkNIQVIiLmVxdWFsc0lnbm9yZUNhc2Uo\nY29sc1tpXS5nZXRUeXBlTmFtZSgpKSkKICAgICAgICAgICAgICAgIGNvbHNb\naV0uc2V0VHlwZShUeXBlcy5WQVJDSEFSKTsKICAgICAgICAgICAgZWxzZSBp\nZiAoIk5DSEFSIi5lcXVhbHNJZ25vcmVDYXNlKGNvbHNbaV0uZ2V0VHlwZU5h\nbWUoKSkpCiAgICAgICAgICAgICAgICBjb2xzW2ldLnNldFR5cGUoVHlwZXMu\nQ0hBUik7CiAgICAgICAgfQogICAgICAgIHJldHVybiBjb2xzOwogICAgfQoK\nICAgIHB1YmxpYyBQcmltYXJ5S2V5W10gZ2V0UHJpbWFyeUtleXMoRGF0YWJh\nc2VNZXRhRGF0YSBtZXRhLAogICAgICAgIFN0cmluZyBjYXRhbG9nLCBTdHJp\nbmcgc2NoZW1hTmFtZSwgU3RyaW5nIHRhYmxlTmFtZSwgQ29ubmVjdGlvbiBj\nb25uKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIFN0\ncmluZ0J1ZmZlciBidWYgPSBuZXcgU3RyaW5nQnVmZmVyKCk7CiAgICAgICAg\nYnVmLmFwcGVuZCgiU0VMRUNUIHQwLk9XTkVSIEFTIFRBQkxFX1NDSEVNLCAi\nKS4KICAgICAgICAgICAgYXBwZW5kKCJ0MC5UQUJMRV9OQU1FIEFTIFRBQkxF\nX05BTUUsICIpLgogICAgICAgICAgICBhcHBlbmQoInQwLkNPTFVNTl9OQU1F\nIEFTIENPTFVNTl9OQU1FLCAiKS4KICAgICAgICAgICAgYXBwZW5kKCJ0MC5D\nT05TVFJBSU5UX05BTUUgQVMgUEtfTkFNRSAiKS4KICAgICAgICAgICAgYXBw\nZW5kKCJGUk9NIEFMTF9DT05TX0NPTFVNTlMgdDAsIEFMTF9DT05TVFJBSU5U\nUyB0MSAiKS4KICAgICAgICAgICAgYXBwZW5kKCJXSEVSRSB0MC5PV05FUiA9\nIHQxLk9XTkVSICIpLgogICAgICAgICAgICBhcHBlbmQoIkFORCB0MC5DT05T\nVFJBSU5UX05BTUUgPSB0MS5DT05TVFJBSU5UX05BTUUgIikuCiAgICAgICAg\nICAgIGFwcGVuZCgiQU5EIHQxLkNPTlNUUkFJTlRfVFlQRSA9ICdQJyIpOwog\nICAgICAgIGlmIChzY2hlbWFOYW1lICE9IG51bGwpCiAgICAgICAgICAgIGJ1\nZi5hcHBlbmQoIiBBTkQgdDAuT1dORVIgPSA/Iik7CiAgICAgICAgaWYgKHRh\nYmxlTmFtZSAhPSBudWxsKQogICAgICAgICAgICBidWYuYXBwZW5kKCIgQU5E\nIHQwLlRBQkxFX05BTUUgPSA/Iik7CgogICAgICAgIFByZXBhcmVkU3RhdGVt\nZW50IHN0bW50ID0gY29ubi5wcmVwYXJlU3RhdGVtZW50KGJ1Zi50b1N0cmlu\nZygpKTsKICAgICAgICBSZXN1bHRTZXQgcnMgPSBudWxsOwogICAgICAgIHRy\neSB7CiAgICAgICAgICAgIGludCBpZHggPSAxOwogICAgICAgICAgICBpZiAo\nc2NoZW1hTmFtZSAhPSBudWxsKQogICAgICAgICAgICAgICAgc2V0U3RyaW5n\nKHN0bW50LCBpZHgrKywgc2NoZW1hTmFtZS50b1VwcGVyQ2FzZSgpLCBudWxs\nKTsKICAgICAgICAgICAgaWYgKHRhYmxlTmFtZSAhPSBudWxsKQogICAgICAg\nICAgICAgICAgc2V0U3RyaW5nKHN0bW50LCBpZHgrKywgdGFibGVOYW1lLnRv\nVXBwZXJDYXNlKCksIG51bGwpOwoKICAgICAgICAgICAgcnMgPSBzdG1udC5l\neGVjdXRlUXVlcnkoKTsKICAgICAgICAgICAgTGlzdCBwa0xpc3QgPSBuZXcg\nQXJyYXlMaXN0KCk7CiAgICAgICAgICAgIHdoaWxlIChycyAhPSBudWxsICYm\nIHJzLm5leHQoKSkKICAgICAgICAgICAgICAgIHBrTGlzdC5hZGQobmV3UHJp\nbWFyeUtleShycykpOwogICAgICAgICAgICByZXR1cm4gKFByaW1hcnlLZXlb\nXSkgcGtMaXN0LnRvQXJyYXkKICAgICAgICAgICAgICAgIChuZXcgUHJpbWFy\neUtleVtwa0xpc3Quc2l6ZSgpXSk7CiAgICAgICAgfSBmaW5hbGx5IHsKICAg\nICAgICAgICAgaWYgKHJzICE9IG51bGwpCiAgICAgICAgICAgICAgICB0cnkg\newogICAgICAgICAgICAgICAgICAgIHJzLmNsb3NlKCk7CiAgICAgICAgICAg\nICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkgewogICAgICAgICAgICAgICAg\nfQogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgc3RtbnQuY2xv\nc2UoKTsKICAgICAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAg\nICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMgSW5kZXhb\nXSBnZXRJbmRleEluZm8oRGF0YWJhc2VNZXRhRGF0YSBtZXRhLCBTdHJpbmcg\nY2F0YWxvZywKICAgICAgICBTdHJpbmcgc2NoZW1hTmFtZSwgU3RyaW5nIHRh\nYmxlTmFtZSwgYm9vbGVhbiB1bmlxdWUsIGJvb2xlYW4gYXBwcm94LAogICAg\nICAgIENvbm5lY3Rpb24gY29ubikKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0\naW9uIHsKICAgICAgICBTdHJpbmdCdWZmZXIgYnVmID0gbmV3IFN0cmluZ0J1\nZmZlcigpOwogICAgICAgIGJ1Zi5hcHBlbmQoIlNFTEVDVCB0MC5JTkRFWF9P\nV05FUiBBUyBUQUJMRV9TQ0hFTSwgIikuCiAgICAgICAgICAgIGFwcGVuZCgi\ndDAuVEFCTEVfTkFNRSBBUyBUQUJMRV9OQU1FLCAiKS4KICAgICAgICAgICAg\nYXBwZW5kKCJERUNPREUodDEuVU5JUVVFTkVTUywgJ1VOSVFVRScsIDAsICdO\nT05VTklRVUUnLCAxKSAiKS4KICAgICAgICAgICAgYXBwZW5kKCJBUyBOT05f\nVU5JUVVFLCAiKS4KICAgICAgICAgICAgYXBwZW5kKCJ0MC5JTkRFWF9OQU1F\nIEFTIElOREVYX05BTUUsICIpLgogICAgICAgICAgICBhcHBlbmQoInQwLkNP\nTFVNTl9OQU1FIEFTIENPTFVNTl9OQU1FICIpLgogICAgICAgICAgICBhcHBl\nbmQoIkZST00gQUxMX0lORF9DT0xVTU5TIHQwLCBBTExfSU5ERVhFUyB0MSAi\nKS4KICAgICAgICAgICAgYXBwZW5kKCJXSEVSRSB0MC5JTkRFWF9PV05FUiA9\nIHQxLk9XTkVSICIpLgogICAgICAgICAgICBhcHBlbmQoIkFORCB0MC5JTkRF\nWF9OQU1FID0gdDEuSU5ERVhfTkFNRSIpOwogICAgICAgIGlmIChzY2hlbWFO\nYW1lICE9IG51bGwpCiAgICAgICAgICAgIGJ1Zi5hcHBlbmQoIiBBTkQgdDAu\nVEFCTEVfT1dORVIgPSA/Iik7CiAgICAgICAgaWYgKHRhYmxlTmFtZSAhPSBu\ndWxsKQogICAgICAgICAgICBidWYuYXBwZW5kKCIgQU5EIHQwLlRBQkxFX05B\nTUUgPSA/Iik7CgogICAgICAgIFByZXBhcmVkU3RhdGVtZW50IHN0bW50ID0g\nY29ubi5wcmVwYXJlU3RhdGVtZW50KGJ1Zi50b1N0cmluZygpKTsKICAgICAg\nICBSZXN1bHRTZXQgcnMgPSBudWxsOwogICAgICAgIHRyeSB7CiAgICAgICAg\nICAgIGludCBpZHggPSAxOwogICAgICAgICAgICBpZiAoc2NoZW1hTmFtZSAh\nPSBudWxsKQogICAgICAgICAgICAgICAgc2V0U3RyaW5nKHN0bW50LCBpZHgr\nKywgc2NoZW1hTmFtZS50b1VwcGVyQ2FzZSgpLCBudWxsKTsKICAgICAgICAg\nICAgaWYgKHRhYmxlTmFtZSAhPSBudWxsKQogICAgICAgICAgICAgICAgc2V0\nU3RyaW5nKHN0bW50LCBpZHgrKywgdGFibGVOYW1lLnRvVXBwZXJDYXNlKCks\nIG51bGwpOwoKICAgICAgICAgICAgcnMgPSBzdG1udC5leGVjdXRlUXVlcnko\nKTsKICAgICAgICAgICAgTGlzdCBpZHhMaXN0ID0gbmV3IEFycmF5TGlzdCgp\nOwogICAgICAgICAgICB3aGlsZSAocnMgIT0gbnVsbCAmJiBycy5uZXh0KCkp\nCiAgICAgICAgICAgICAgICBpZHhMaXN0LmFkZChuZXdJbmRleChycykpOwog\nICAgICAgICAgICByZXR1cm4gKEluZGV4W10pIGlkeExpc3QudG9BcnJheShu\nZXcgSW5kZXhbaWR4TGlzdC5zaXplKCldKTsKICAgICAgICB9IGZpbmFsbHkg\newogICAgICAgICAgICBpZiAocnMgIT0gbnVsbCkKICAgICAgICAgICAgICAg\nIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgcnMuY2xvc2UoKTsKICAgICAg\nICAgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAg\nICAgICB9CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBzdG1u\ndC5jbG9zZSgpOwogICAgICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkg\newogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQoKICAgIHB1YmxpYyBG\nb3JlaWduS2V5W10gZ2V0SW1wb3J0ZWRLZXlzKERhdGFiYXNlTWV0YURhdGEg\nbWV0YSwgU3RyaW5nIGNhdGFsb2csCiAgICAgICAgU3RyaW5nIHNjaGVtYU5h\nbWUsIFN0cmluZyB0YWJsZU5hbWUsIENvbm5lY3Rpb24gY29ubikKICAgICAg\nICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBTdHJpbmdCdWZmZXIg\nZGVsQWN0aW9uID0gbmV3IFN0cmluZ0J1ZmZlcigiREVDT0RFKHQxLkRFTEVU\nRV9SVUxFIikuCiAgICAgICAgICAgIGFwcGVuZCgiLCAnTk8gQUNUSU9OJywg\nIikuYXBwZW5kKG1ldGEuaW1wb3J0ZWRLZXlOb0FjdGlvbikuCiAgICAgICAg\nICAgIGFwcGVuZCgiLCAnUkVTVFJJQ1QnLCAiKS5hcHBlbmQobWV0YS5pbXBv\ncnRlZEtleVJlc3RyaWN0KS4KICAgICAgICAgICAgYXBwZW5kKCIsICdDQVND\nQURFJywgIikuYXBwZW5kKG1ldGEuaW1wb3J0ZWRLZXlDYXNjYWRlKS4KICAg\nICAgICAgICAgYXBwZW5kKCIsICdTRVQgTlVMTCcsICIpLmFwcGVuZChtZXRh\nLmltcG9ydGVkS2V5U2V0TnVsbCkuCiAgICAgICAgICAgIGFwcGVuZCgiLCAn\nU0VUIERFRkFVTFQnLCAiKS5hcHBlbmQobWV0YS5pbXBvcnRlZEtleVNldERl\nZmF1bHQpLgogICAgICAgICAgICBhcHBlbmQoIikiKTsKCiAgICAgICAgU3Ry\naW5nQnVmZmVyIGJ1ZiA9IG5ldyBTdHJpbmdCdWZmZXIoKTsKICAgICAgICBi\ndWYuYXBwZW5kKCJTRUxFQ1QgdDIuT1dORVIgQVMgUEtUQUJMRV9TQ0hFTSwg\nIikuCiAgICAgICAgICAgIGFwcGVuZCgidDIuVEFCTEVfTkFNRSBBUyBQS1RB\nQkxFX05BTUUsICIpLgogICAgICAgICAgICBhcHBlbmQoInQyLkNPTFVNTl9O\nQU1FIEFTIFBLQ09MVU1OX05BTUUsICIpLgogICAgICAgICAgICBhcHBlbmQo\nInQwLk9XTkVSIEFTIEZLVEFCTEVfU0NIRU0sICIpLgogICAgICAgICAgICBh\ncHBlbmQoInQwLlRBQkxFX05BTUUgQVMgRktUQUJMRV9OQU1FLCAiKS4KICAg\nICAgICAgICAgYXBwZW5kKCJ0MC5DT0xVTU5fTkFNRSBBUyBGS0NPTFVNTl9O\nQU1FLCAiKS4KICAgICAgICAgICAgYXBwZW5kKCJ0MC5QT1NJVElPTiBBUyBL\nRVlfU0VRLCAiKS4KICAgICAgICAgICAgYXBwZW5kKGRlbEFjdGlvbikuYXBw\nZW5kKCIgQVMgREVMRVRFX1JVTEUsICIpLgogICAgICAgICAgICBhcHBlbmQo\nInQwLkNPTlNUUkFJTlRfTkFNRSBBUyBGS19OQU1FLCAiKS4KICAgICAgICAg\nICAgYXBwZW5kKCJERUNPREUodDEuREVGRVJSRUQsICdERUZFUlJFRCcsICIp\nLgogICAgICAgICAgICBhcHBlbmQobWV0YS5pbXBvcnRlZEtleUluaXRpYWxs\neURlZmVycmVkKS4KICAgICAgICAgICAgYXBwZW5kKCIsICdJTU1FRElBVEUn\nLCAiKS4KICAgICAgICAgICAgYXBwZW5kKG1ldGEuaW1wb3J0ZWRLZXlJbml0\naWFsbHlJbW1lZGlhdGUpLgogICAgICAgICAgICBhcHBlbmQoIikgQVMgREVG\nRVJSQUJJTElUWSAiKS4KICAgICAgICAgICAgYXBwZW5kKCJGUk9NIEFMTF9D\nT05TX0NPTFVNTlMgdDAsIEFMTF9DT05TVFJBSU5UUyB0MSwgIikuCiAgICAg\nICAgICAgIGFwcGVuZCgiQUxMX0NPTlNfQ09MVU1OUyB0MiAiKS4KICAgICAg\nICAgICAgYXBwZW5kKCJXSEVSRSB0MC5PV05FUiA9IHQxLk9XTkVSICIpLgog\nICAgICAgICAgICBhcHBlbmQoIkFORCB0MC5DT05TVFJBSU5UX05BTUUgPSB0\nMS5DT05TVFJBSU5UX05BTUUgIikuCiAgICAgICAgICAgIGFwcGVuZCgiQU5E\nIHQxLkNPTlNUUkFJTlRfVFlQRSA9ICdSJyAiKS4KICAgICAgICAgICAgYXBw\nZW5kKCJBTkQgdDEuUl9PV05FUiA9IHQyLk9XTkVSICIpLgogICAgICAgICAg\nICBhcHBlbmQoIkFORCB0MS5SX0NPTlNUUkFJTlRfTkFNRSA9IHQyLkNPTlNU\nUkFJTlRfTkFNRSAiKS4KICAgICAgICAgICAgYXBwZW5kKCJBTkQgdDAuUE9T\nSVRJT04gPSB0Mi5QT1NJVElPTiIpOwogICAgICAgIGlmIChzY2hlbWFOYW1l\nICE9IG51bGwpCiAgICAgICAgICAgIGJ1Zi5hcHBlbmQoIiBBTkQgdDAuT1dO\nRVIgPSA/Iik7CiAgICAgICAgaWYgKHRhYmxlTmFtZSAhPSBudWxsKQogICAg\nICAgICAgICBidWYuYXBwZW5kKCIgQU5EIHQwLlRBQkxFX05BTUUgPSA/Iik7\nCiAgICAgICAgYnVmLmFwcGVuZCgiIE9SREVSIEJZIHQyLk9XTkVSLCB0Mi5U\nQUJMRV9OQU1FLCB0MC5QT1NJVElPTiIpOwoKICAgICAgICBQcmVwYXJlZFN0\nYXRlbWVudCBzdG1udCA9IGNvbm4ucHJlcGFyZVN0YXRlbWVudChidWYudG9T\ndHJpbmcoKSk7CiAgICAgICAgUmVzdWx0U2V0IHJzID0gbnVsbDsKICAgICAg\nICB0cnkgewogICAgICAgICAgICBpbnQgaWR4ID0gMTsKICAgICAgICAgICAg\naWYgKHNjaGVtYU5hbWUgIT0gbnVsbCkKICAgICAgICAgICAgICAgIHNldFN0\ncmluZyhzdG1udCwgaWR4KyssIHNjaGVtYU5hbWUudG9VcHBlckNhc2UoKSwg\nbnVsbCk7CiAgICAgICAgICAgIGlmICh0YWJsZU5hbWUgIT0gbnVsbCkKICAg\nICAgICAgICAgICAgIHNldFN0cmluZyhzdG1udCwgaWR4KyssIHRhYmxlTmFt\nZS50b1VwcGVyQ2FzZSgpLCBudWxsKTsKCiAgICAgICAgICAgIHJzID0gc3Rt\nbnQuZXhlY3V0ZVF1ZXJ5KCk7CiAgICAgICAgICAgIExpc3QgZmtMaXN0ID0g\nbmV3IEFycmF5TGlzdCgpOwogICAgICAgICAgICB3aGlsZSAocnMgIT0gbnVs\nbCAmJiBycy5uZXh0KCkpCiAgICAgICAgICAgICAgICBma0xpc3QuYWRkKG5l\nd0ZvcmVpZ25LZXkocnMpKTsKICAgICAgICAgICAgcmV0dXJuIChGb3JlaWdu\nS2V5W10pIGZrTGlzdC50b0FycmF5CiAgICAgICAgICAgICAgICAobmV3IEZv\ncmVpZ25LZXlbZmtMaXN0LnNpemUoKV0pOwogICAgICAgIH0gZmluYWxseSB7\nCiAgICAgICAgICAgIGlmIChycyAhPSBudWxsKQogICAgICAgICAgICAgICAg\ndHJ5IHsKICAgICAgICAgICAgICAgICAgICBycy5jbG9zZSgpOwogICAgICAg\nICAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAg\nICAgIH0KICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIHN0bW50\nLmNsb3NlKCk7CiAgICAgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7\nCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgcHVibGljIFN0\ncmluZ1tdIGdldENyZWF0ZVRhYmxlU1FMKFRhYmxlIHRhYmxlKSB7CiAgICAg\nICAgLy8gb25seSBvdmVycmlkZSBpZiB3ZSBhcmUgc2ltdWxhdGluZyBhdXRv\nLWluY3JlbWVuZXQgd2l0aCB0cmlnZ2VycwogICAgICAgIFN0cmluZ1tdIGNy\nZWF0ZSA9IHN1cGVyLmdldENyZWF0ZVRhYmxlU1FMKHRhYmxlKTsKICAgICAg\nICBpZiAoIXVzZVRyaWdnZXJzRm9yQXV0b0Fzc2lnbikKICAgICAgICAgICAg\ncmV0dXJuIGNyZWF0ZTsKCiAgICAgICAgQ29sdW1uW10gY29scyA9IHRhYmxl\nLmdldENvbHVtbnMoKTsKICAgICAgICBMaXN0IHNlcXMgPSBudWxsOwogICAg\nICAgIFN0cmluZyBzZXEsIHRyaWc7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7\nIGNvbHMgIT0gbnVsbCAmJiBpIDwgY29scy5sZW5ndGg7IGkrKykgewogICAg\nICAgICAgICBpZiAoIWNvbHNbaV0uaXNBdXRvQXNzaWduZWQoKSkKICAgICAg\nICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICBpZiAoc2VxcyA9PSBu\ndWxsKQogICAgICAgICAgICAgICAgc2VxcyA9IG5ldyBBcnJheUxpc3QoNCk7\nCgogICAgICAgICAgICBzZXEgPSBhdXRvQXNzaWduU2VxdWVuY2VOYW1lOwog\nICAgICAgICAgICBpZiAoc2VxID09IG51bGwpIHsKICAgICAgICAgICAgICAg\nIGlmIChvcGVuanBhM0dlbmVyYXRlZEtleU5hbWVzKQogICAgICAgICAgICAg\nICAgICAgIHNlcSA9IGdldE9wZW5KUEEzR2VuZXJhdGVkS2V5U2VxdWVuY2VO\nYW1lKGNvbHNbaV0pOwogICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAg\nICAgICAgICAgIHNlcSA9IGdldEdlbmVyYXRlZEtleVNlcXVlbmNlTmFtZShj\nb2xzW2ldKTsKICAgICAgICAgICAgICAgIHNlcXMuYWRkKCJDUkVBVEUgU0VR\nVUVOQ0UgIiArIHNlcSArICIgU1RBUlQgV0lUSCAxIik7CiAgICAgICAgICAg\nIH0KICAgICAgICAgICAgaWYgKG9wZW5qcGEzR2VuZXJhdGVkS2V5TmFtZXMp\nCiAgICAgICAgICAgICAgICB0cmlnID0gZ2V0T3BlbkpQQTNHZW5lcmF0ZWRL\nZXlUcmlnZ2VyTmFtZShjb2xzW2ldKTsKICAgICAgICAgICAgZWxzZQogICAg\nICAgICAgICAgICAgdHJpZyA9IGdldEdlbmVyYXRlZEtleVRyaWdnZXJOYW1l\nKGNvbHNbaV0pOwoKICAgICAgICAgICAgLy8gY3JlYXRlIHRoZSB0cmlnZ2Vy\nIHRoYXQgd2lsbCBpbnNlcnQgbmV3IHZhbHVlcyBpbnRvCiAgICAgICAgICAg\nIC8vIHRoZSB0YWJsZSB3aGVuZXZlciBhIHJvdyBpcyBjcmVhdGVkCiAgICAg\nICAgICAgIHNlcXMuYWRkKCJDUkVBVEUgT1IgUkVQTEFDRSBUUklHR0VSICIg\nKyB0cmlnCiAgICAgICAgICAgICAgICArICIgQkVGT1JFIElOU0VSVCBPTiAi\nICsgdGFibGUuZ2V0TmFtZSgpCiAgICAgICAgICAgICAgICArICIgRk9SIEVB\nQ0ggUk9XIEJFR0lOIFNFTEVDVCAiICsgc2VxICsgIi5uZXh0dmFsIElOVE8g\nIgogICAgICAgICAgICAgICAgKyAiOm5ldy4iICsgY29sc1tpXS5nZXROYW1l\nKCkgKyAiIEZST00gRFVBTDsgIgogICAgICAgICAgICAgICAgKyAiRU5EICIg\nKyB0cmlnICsgIjsiKTsKICAgICAgICB9CiAgICAgICAgaWYgKHNlcXMgPT0g\nbnVsbCkKICAgICAgICAgICAgcmV0dXJuIGNyZWF0ZTsKCiAgICAgICAgLy8g\nY29tYmluZSBjcmVhdGUgdGFibGUgc3FsIGFuZCBjcmVhdGUgc2VxZW5jZXMg\nc3FsCiAgICAgICAgU3RyaW5nW10gc3FsID0gbmV3IFN0cmluZ1tjcmVhdGUu\nbGVuZ3RoICsgc2Vxcy5zaXplKCldOwogICAgICAgIFN5c3RlbS5hcnJheWNv\ncHkoY3JlYXRlLCAwLCBzcWwsIDAsIGNyZWF0ZS5sZW5ndGgpOwogICAgICAg\nIGZvciAoaW50IGkgPSAwOyBpIDwgc2Vxcy5zaXplKCk7IGkrKykKICAgICAg\nICAgICAgc3FsW2NyZWF0ZS5sZW5ndGggKyBpXSA9IChTdHJpbmcpIHNlcXMu\nZ2V0KGkpOwogICAgICAgIHJldHVybiBzcWw7CiAgICB9CgogICAgcHVibGlj\nIFN0cmluZ1tdIGdldENyZWF0ZVNlcXVlbmNlU1FMKFNlcXVlbmNlIHNlcSkg\newogICAgICAgIFN0cmluZ1tdIHNxbCA9IHN1cGVyLmdldENyZWF0ZVNlcXVl\nbmNlU1FMKHNlcSk7CiAgICAgICAgaWYgKHNlcS5nZXRBbGxvY2F0ZSgpID4g\nMSkKICAgICAgICAgICAgc3FsWzBdICs9ICIgQ0FDSEUgIiArIHNlcS5nZXRB\nbGxvY2F0ZSgpOwogICAgICAgIHJldHVybiBzcWw7CiAgICB9CgogICAgcHJv\ndGVjdGVkIFN0cmluZyBnZXRTZXF1ZW5jZXNTUUwoU3RyaW5nIHNjaGVtYU5h\nbWUsIFN0cmluZyBzZXF1ZW5jZU5hbWUpIHsKICAgICAgICBTdHJpbmdCdWZm\nZXIgYnVmID0gbmV3IFN0cmluZ0J1ZmZlcigpOwogICAgICAgIGJ1Zi5hcHBl\nbmQoIlNFTEVDVCBTRVFVRU5DRV9PV05FUiBBUyBTRVFVRU5DRV9TQ0hFTUEs\nICIpLgogICAgICAgICAgICBhcHBlbmQoIlNFUVVFTkNFX05BTUUgRlJPTSBB\nTExfU0VRVUVOQ0VTIik7CiAgICAgICAgaWYgKHNjaGVtYU5hbWUgIT0gbnVs\nbCB8fCBzZXF1ZW5jZU5hbWUgIT0gbnVsbCkKICAgICAgICAgICAgYnVmLmFw\ncGVuZCgiIFdIRVJFICIpOwogICAgICAgIGlmIChzY2hlbWFOYW1lICE9IG51\nbGwpIHsKICAgICAgICAgICAgYnVmLmFwcGVuZCgiU0VRVUVOQ0VfT1dORVIg\nPSA/Iik7CiAgICAgICAgICAgIGlmIChzZXF1ZW5jZU5hbWUgIT0gbnVsbCkK\nICAgICAgICAgICAgICAgIGJ1Zi5hcHBlbmQoIiBBTkQgIik7CiAgICAgICAg\nfQogICAgICAgIGlmIChzZXF1ZW5jZU5hbWUgIT0gbnVsbCkKICAgICAgICAg\nICAgYnVmLmFwcGVuZCgiU0VRVUVOQ0VfTkFNRSA9ID8iKTsKICAgICAgICBy\nZXR1cm4gYnVmLnRvU3RyaW5nKCk7CiAgICB9CgogICAgcHVibGljIGJvb2xl\nYW4gaXNTeXN0ZW1TZXF1ZW5jZShTdHJpbmcgbmFtZSwgU3RyaW5nIHNjaGVt\nYSwKICAgICAgICBib29sZWFuIHRhcmdldFNjaGVtYSkgewogICAgICAgIGlm\nIChzdXBlci5pc1N5c3RlbVNlcXVlbmNlKG5hbWUsIHNjaGVtYSwgdGFyZ2V0\nU2NoZW1hKSkKICAgICAgICAgICAgcmV0dXJuIHRydWU7CgogICAgICAgIC8v\nIGZpbHRlciBvdXQgZ2VuZXJhdGVkIHNlcXVlbmNlcyB1c2VkIGZvciBhdXRv\nLWFzc2lnbgogICAgICAgIHJldHVybiAoYXV0b0Fzc2lnblNlcXVlbmNlTmFt\nZSAhPSBudWxsCiAgICAgICAgICAgICYmIG5hbWUuZXF1YWxzSWdub3JlQ2Fz\nZShhdXRvQXNzaWduU2VxdWVuY2VOYW1lKSkKICAgICAgICAgICAgfHwgKGF1\ndG9Bc3NpZ25TZXF1ZW5jZU5hbWUgPT0gbnVsbAogICAgICAgICAgICAmJiBu\nYW1lLnRvVXBwZXJDYXNlKCkuc3RhcnRzV2l0aCgiU1RfIikpOwogICAgfQoK\nICAgIHB1YmxpYyBPYmplY3QgZ2V0R2VuZXJhdGVkS2V5KENvbHVtbiBjb2ws\nIENvbm5lY3Rpb24gY29ubikKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9u\nIHsKICAgICAgICBpZiAoIXVzZVRyaWdnZXJzRm9yQXV0b0Fzc2lnbikKICAg\nICAgICAgICAgcmV0dXJuIE51bWJlcnMudmFsdWVPZigwTCk7CgogICAgICAg\nIC8vIGlmIHdlIHNpbXVsYXRlIGF1dG8tYXNzaWduZWQgY29sdW1ucyB1c2lu\nZyB0cmlnZ2VycyBhbmQKICAgICAgICAvLyBzZXF1ZW5jZXMsIHRoZW4gcmV0\ndXJuIHRoZSBjdXJyZW50IHZhbHVlIG9mIHRoZSBzZXF1ZW5jZQogICAgICAg\nIC8vIGZyb20gYXV0b0Fzc2lnblNlcXVlbmNlTmFtZQogICAgICAgIFN0cmlu\nZyBzZXEgPSBhdXRvQXNzaWduU2VxdWVuY2VOYW1lOwogICAgICAgIGlmIChz\nZXEgPT0gbnVsbCAmJiBvcGVuanBhM0dlbmVyYXRlZEtleU5hbWVzKQogICAg\nICAgICAgICBzZXEgPSBnZXRPcGVuSlBBM0dlbmVyYXRlZEtleVNlcXVlbmNl\nTmFtZShjb2wpOwogICAgICAgIGVsc2UgaWYgKHNlcSA9PSBudWxsKQogICAg\nICAgICAgICBzZXEgPSBnZXRHZW5lcmF0ZWRLZXlTZXF1ZW5jZU5hbWUoY29s\nKTsKICAgICAgICBQcmVwYXJlZFN0YXRlbWVudCBzdG1udCA9IGNvbm4ucHJl\ncGFyZVN0YXRlbWVudCgiU0VMRUNUICIgKyBzZXEKICAgICAgICAgICAgKyAi\nLmN1cnJ2YWwgRlJPTSBEVUFMIik7CiAgICAgICAgUmVzdWx0U2V0IHJzID0g\nbnVsbDsKICAgICAgICB0cnkgewogICAgICAgICAgICBycyA9IHN0bW50LmV4\nZWN1dGVRdWVyeSgpOwogICAgICAgICAgICBycy5uZXh0KCk7CiAgICAgICAg\nICAgIHJldHVybiBOdW1iZXJzLnZhbHVlT2YocnMuZ2V0TG9uZygxKSk7CiAg\nICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgaWYgKHJzICE9IG51bGwp\nCiAgICAgICAgICAgICAgICB0cnkgeyBycy5jbG9zZSgpOyB9IGNhdGNoIChT\nUUxFeGNlcHRpb24gc2UpIHt9CiAgICAgICAgICAgIHRyeSB7IHN0bW50LmNs\nb3NlKCk7IH0gY2F0Y2ggKFNRTEV4Y2VwdGlvbiBzZSkge30KICAgICAgICB9\nCiAgICB9CgogICAgLyoqCiAgICAgKiBUcmlnZ2VyIG5hbWUgZm9yIHNpbXVs\nYXRpbmcgYXV0by1hc3NpZ24gdmFsdWVzIG9uIHRoZSBnaXZlbiBjb2x1bW4u\nCiAgICAgKi8KICAgIHByb3RlY3RlZCBTdHJpbmcgZ2V0R2VuZXJhdGVkS2V5\nVHJpZ2dlck5hbWUoQ29sdW1uIGNvbCkgewogICAgICAgIC8vIHJlcGxhY2Ug\ndHJhaWxpbmcgX1NFUSB3aXRoIF9UUkcKICAgICAgICBTdHJpbmcgc2VxTmFt\nZSA9IGdldEdlbmVyYXRlZEtleVNlcXVlbmNlTmFtZShjb2wpOwogICAgICAg\nIHJldHVybiBzZXFOYW1lLnN1YnN0cmluZygwLCBzZXFOYW1lLmxlbmd0aCgp\nIC0gMykgKyAiVFJHIjsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybnMg\nYSBPcGVuSlBBIDMtY29tcGF0aWJsZSBuYW1lIGZvciBhbiBhdXRvLWFzc2ln\nbiBzZXF1ZW5jZS4KICAgICAqLwogICAgcHJvdGVjdGVkIFN0cmluZyBnZXRP\ncGVuSlBBM0dlbmVyYXRlZEtleVNlcXVlbmNlTmFtZShDb2x1bW4gY29sKSB7\nCiAgICAgICAgVGFibGUgdGFibGUgPSBjb2wuZ2V0VGFibGUoKTsKICAgICAg\nICByZXR1cm4gbWFrZU5hbWVWYWxpZCgiU0VRXyIgKyB0YWJsZS5nZXROYW1l\nKCksIHRhYmxlLmdldFNjaGVtYSgpLgogICAgICAgICAgICBnZXRTY2hlbWFH\ncm91cCgpLCBtYXhUYWJsZU5hbWVMZW5ndGgsIE5BTUVfQU5ZKTsKICAgIH0K\nCiAgICAvKioKICAgICAqIFJldHVybnMgYSBPcGVuSlBBIDMtY29tcGF0aWJs\nZSBuYW1lIGZvciBhbiBhdXRvLWFzc2lnbiB0cmlnZ2VyLgogICAgICovCiAg\nICBwcm90ZWN0ZWQgU3RyaW5nIGdldE9wZW5KUEEzR2VuZXJhdGVkS2V5VHJp\nZ2dlck5hbWUoQ29sdW1uIGNvbCkgewogICAgICAgIFRhYmxlIHRhYmxlID0g\nY29sLmdldFRhYmxlKCk7CiAgICAgICAgcmV0dXJuIG1ha2VOYW1lVmFsaWQo\nIlRSSUdfIiArIHRhYmxlLmdldE5hbWUoKSwgdGFibGUuZ2V0U2NoZW1hKCku\nCiAgICAgICAgICAgIGdldFNjaGVtYUdyb3VwKCksIG1heFRhYmxlTmFtZUxl\nbmd0aCwgTkFNRV9BTlkpOwogICAgfQoKICAgIC8qKgogICAgICogSW52b2tl\nIE9yYWNsZSdzIDxjb2RlPnB1dEJ5dGVzPC9jb2RlPiBtZXRob2Qgb24gdGhl\nIGdpdmVuIEJMT0Igb2JqZWN0LgogICAgICogVXNlcyByZWZsZWN0aW9uIGlu\nIGNhc2UgdGhlIGJsb2IgaXMgd3JhcHBlZCBpbiBhbm90aGVyCiAgICAgKiB2\nZW5kb3Itc3BlY2lmaWMgY2xhc3M7IGZvciBleGFtcGxlIFdlYmxvZ2ljIHdy\nYXBzIG9yYWNsZSB0aGluIGRyaXZlcgogICAgICogbG9icyBpbiBpdHMgb3du\nIGludGVyZmFjZXMgd2l0aCB0aGUgc2FtZSBtZXRob2RzLgogICAgICovCiAg\nICBwdWJsaWMgdm9pZCBwdXRCeXRlcyhPYmplY3QgYmxvYiwgYnl0ZVtdIGRh\ndGEpCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgaWYg\nKGJsb2IgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIGlm\nIChfcHV0Qnl0ZXMgPT0gbnVsbCkgewogICAgICAgICAgICB0cnkgewogICAg\nICAgICAgICAgICAgX3B1dEJ5dGVzID0gYmxvYi5nZXRDbGFzcygpLmdldE1l\ndGhvZCgicHV0Qnl0ZXMiLAogICAgICAgICAgICAgICAgICAgIG5ldyBDbGFz\nc1tdeyBsb25nLmNsYXNzLCBieXRlW10uY2xhc3MgfSk7CiAgICAgICAgICAg\nIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgICAgICB0aHJv\ndyBuZXcgU3RvcmVFeGNlcHRpb24oZSk7CiAgICAgICAgICAgIH0KICAgICAg\nICB9CiAgICAgICAgaW52b2tlUHV0TG9iTWV0aG9kKF9wdXRCeXRlcywgYmxv\nYiwgZGF0YSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBJbnZva2UgT3JhY2xl\nJ3MgPGNvZGU+cHV0U3RyaW5nPC9jb2RlPiBtZXRob2Qgb24gdGhlIGdpdmVu\nIENMT0Igb2JqZWN0LgogICAgICogVXNlcyByZWZsZWN0aW9uIGluIGNhc2Ug\ndGhlIGNsb2IgaXMgd3JhcHBlZCBpbiBhbm90aGVyCiAgICAgKiB2ZW5kb3It\nc3BlY2lmaWMgY2xhc3M7IGZvciBleGFtcGxlIFdlYmxvZ2ljIHdyYXBzIG9y\nYWNsZSB0aGluIGRyaXZlcgogICAgICogbG9icyBpbiBpdHMgb3duIGludGVy\nZmFjZXMgd2l0aCB0aGUgc2FtZSBtZXRob2RzLgogICAgICovCiAgICBwdWJs\naWMgdm9pZCBwdXRTdHJpbmcoT2JqZWN0IGNsb2IsIFN0cmluZyBkYXRhKQog\nICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIGlmIChfcHV0\nU3RyaW5nID09IG51bGwpIHsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAg\nICAgICAgIF9wdXRTdHJpbmcgPSBjbG9iLmdldENsYXNzKCkuZ2V0TWV0aG9k\nKCJwdXRTdHJpbmciLAogICAgICAgICAgICAgICAgICAgIG5ldyBDbGFzc1td\neyBsb25nLmNsYXNzLCBTdHJpbmcuY2xhc3MgfSk7CiAgICAgICAgICAgIH0g\nY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgICAgICB0aHJvdyBu\nZXcgU3RvcmVFeGNlcHRpb24oZSk7CiAgICAgICAgICAgIH0KICAgICAgICB9\nCiAgICAgICAgaW52b2tlUHV0TG9iTWV0aG9kKF9wdXRTdHJpbmcsIGNsb2Is\nIGRhdGEpOwogICAgfQoKICAgIC8qKgogICAgICogSW52b2tlIE9yYWNsZSdz\nIDxjb2RlPnB1dENoYXJzPC9jb2RlPiBtZXRob2Qgb24gdGhlIGdpdmVuIENM\nT0IKICAgICAqIG9iamVjdC4gVXNlcyByZWZsZWN0aW9uIGluIGNhc2UgdGhl\nIGNsb2IgaXMgd3JhcHBlZCBpbiBhbm90aGVyCiAgICAgKiB2ZW5kb3Itc3Bl\nY2lmaWMgY2xhc3M7IGZvciBleGFtcGxlIFdlYmxvZ2ljIHdyYXBzIG9yYWNs\nZSB0aGluIGRyaXZlcgogICAgICogbG9icyBpbiBpdHMgb3duIGludGVyZmFj\nZXMgd2l0aCB0aGUgc2FtZSBtZXRob2RzLgogICAgICovCiAgICBwdWJsaWMg\ndm9pZCBwdXRDaGFycyhPYmplY3QgY2xvYiwgY2hhcltdIGRhdGEpCiAgICAg\nICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgaWYgKF9wdXRDaGFy\ncyA9PSBudWxsKSB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAg\nICBfcHV0Q2hhcnMgPSBjbG9iLmdldENsYXNzKCkuZ2V0TWV0aG9kKCJwdXRD\naGFycyIsCiAgICAgICAgICAgICAgICAgICAgbmV3IENsYXNzW117IGxvbmcu\nY2xhc3MsIGNoYXJbXS5jbGFzcyB9KTsKICAgICAgICAgICAgfSBjYXRjaCAo\nRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgICAgIHRocm93IG5ldyBTdG9y\nZUV4Y2VwdGlvbihlKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAg\nICBpbnZva2VQdXRMb2JNZXRob2QoX3B1dENoYXJzLCBjbG9iLCBkYXRhKTsK\nICAgIH0KCiAgICAvKioKICAgICAqIEludm9rZSB0aGUgZ2l2ZW4gTE9CIG1l\ndGhvZCBvbiB0aGUgZ2l2ZW4gdGFyZ2V0IHdpdGggdGhlIGdpdmVuIGRhdGEu\nCiAgICAgKi8KICAgIHByaXZhdGUgc3RhdGljIHZvaWQgaW52b2tlUHV0TG9i\nTWV0aG9kKE1ldGhvZCBtZXRob2QsIE9iamVjdCB0YXJnZXQsCiAgICAgICAg\nT2JqZWN0IGRhdGEpCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAg\nICAgICAgdHJ5IHsKICAgICAgICAgICAgbWV0aG9kLmludm9rZSh0YXJnZXQs\nIG5ldyBPYmplY3RbXXsgTnVtYmVycy52YWx1ZU9mKDFMKSwgZGF0YSB9KTsK\nICAgICAgICB9IGNhdGNoIChJbnZvY2F0aW9uVGFyZ2V0RXhjZXB0aW9uIGl0\nZSkgewogICAgICAgICAgICBUaHJvd2FibGUgdCA9IGl0ZS5nZXRUYXJnZXRF\neGNlcHRpb24oKTsKICAgICAgICAgICAgaWYgKHQgaW5zdGFuY2VvZiBTUUxF\neGNlcHRpb24pCiAgICAgICAgICAgICAgICB0aHJvdyhTUUxFeGNlcHRpb24p\nIHQ7CiAgICAgICAgICAgIHRocm93IG5ldyBTdG9yZUV4Y2VwdGlvbih0KTsK\nICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkgewogICAgICAgICAgICB0\naHJvdyBuZXcgU3RvcmVFeGNlcHRpb24oZSk7CiAgICAgICAgfQogICAgfQoK\nICAgIHByaXZhdGUgQ2xvYiBnZXRFbXB0eUNsb2IoKQogICAgICAgIHRocm93\ncyBTUUxFeGNlcHRpb24gewogICAgICAgIGlmIChFTVBUWV9DTE9CICE9IG51\nbGwpCiAgICAgICAgICAgIHJldHVybiBFTVBUWV9DTE9COwogICAgICAgIHRy\neSB7CiAgICAgICAgICAgIHJldHVybiBFTVBUWV9DTE9CID0gKENsb2IpIENs\nYXNzLmZvck5hbWUoIm9yYWNsZS5zcWwuQ0xPQiIsdHJ1ZSwgCiAgICAgICAg\nICAgICAgICAgICAgVGhyZWFkLmN1cnJlbnRUaHJlYWQoKS5nZXRDb250ZXh0\nQ2xhc3NMb2FkZXIoKSkuCiAgICAgICAgICAgICAgICBnZXRNZXRob2QoImVt\ncHR5X2xvYiIsIG5ldyBDbGFzc1swXSkuCiAgICAgICAgICAgICAgICBpbnZv\na2UobnVsbCwgbmV3IE9iamVjdFswXSk7CiAgICAgICAgfSBjYXRjaCAoRXhj\nZXB0aW9uIGUpIHsKICAgICAgICAgICAgdGhyb3cgbmV3IFNRTEV4Y2VwdGlv\nbihlLmdldE1lc3NhZ2UoKSk7CiAgICAgICAgfQogICAgfQoKICAgIHByaXZh\ndGUgQmxvYiBnZXRFbXB0eUJsb2IoKQogICAgICAgIHRocm93cyBTUUxFeGNl\ncHRpb24gewogICAgICAgIGlmIChFTVBUWV9CTE9CICE9IG51bGwpCiAgICAg\nICAgICAgIHJldHVybiBFTVBUWV9CTE9COwogICAgICAgIHRyeSB7CiAgICAg\nICAgICAgIHJldHVybiBFTVBUWV9CTE9CID0gKEJsb2IpIENsYXNzLmZvck5h\nbWUoIm9yYWNsZS5zcWwuQkxPQiIsdHJ1ZSwgCiAgICAgICAgICAgICAgICAg\nICAgVGhyZWFkLmN1cnJlbnRUaHJlYWQoKS5nZXRDb250ZXh0Q2xhc3NMb2Fk\nZXIoKSkuCiAgICAgICAgICAgICAgICBnZXRNZXRob2QoImVtcHR5X2xvYiIs\nIG5ldyBDbGFzc1swXSkuCiAgICAgICAgICAgICAgICBpbnZva2UobnVsbCwg\nbmV3IE9iamVjdFswXSk7CiAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUp\nIHsKICAgICAgICAgICAgdGhyb3cgbmV3IFNRTEV4Y2VwdGlvbihlLmdldE1l\nc3NhZ2UoKSk7CiAgICAgICAgfQogICAgfQoKICAgIHByaXZhdGUgc3RhdGlj\nIGJvb2xlYW4gaXNPcmFjbGVQcmVwYXJlZFN0YXRlbWVudChTdGF0ZW1lbnQg\nc3RtbnQpIHsKICAgICAgICB0cnkgewogICAgICAgICAgICByZXR1cm4gQ2xh\nc3MuZm9yTmFtZSgib3JhY2xlLmpkYmMuT3JhY2xlUHJlcGFyZWRTdGF0ZW1l\nbnQiKS4KICAgICAgICAgICAgICAgIGlzSW5zdGFuY2Uoc3RtbnQpOwogICAg\nICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgIHJldHVy\nbiBmYWxzZTsKICAgICAgICB9CiAgICB9CiAgICAKICAgIC8qKgogICAgICog\nSWYgdGhpcyBkaWN0aW9uYXJ5IHN1cHBvcnRzIFhNTCB0eXBlLAogICAgICog\ndXNlIHRoaXMgbWV0aG9kIHRvIGFwcGVuZCB4bWwgcHJlZGljYXRlLgogICAg\nICogCiAgICAgKiBAcGFyYW0gYnVmIHRoZSBTUUwgYnVmZmVyIHRvIHdyaXRl\nIHRoZSBjb21wYXJpc29uCiAgICAgKiBAcGFyYW0gb3AgdGhlIGNvbXBhcmlz\nb24gb3BlcmF0aW9uIHRvIHBlcmZvcm0KICAgICAqIEBwYXJhbSBsaHMgdGhl\nIGxlZnQgaGFuZCBzaWRlIG9mIHRoZSBjb21wYXJpc29uCiAgICAgKiBAcGFy\nYW0gcmhzIHRoZSByaWdodCBoYW5kIHNpZGUgb2YgdGhlIGNvbXBhcmlzb24K\nICAgICAqLwogICAgcHVibGljIHZvaWQgYXBwZW5kWG1sQ29tcGFyaXNvbihT\nUUxCdWZmZXIgYnVmLCBTdHJpbmcgb3AsIEZpbHRlclZhbHVlIGxocywKICAg\nICAgICBGaWx0ZXJWYWx1ZSByaHMsIGJvb2xlYW4gbGhzeG1sLCBib29sZWFu\nIHJoc3htbCkgewogICAgICAgIHN1cGVyLmFwcGVuZFhtbENvbXBhcmlzb24o\nYnVmLCBvcCwgbGhzLCByaHMsIGxoc3htbCwgcmhzeG1sKTsKICAgICAgICBp\nZiAobGhzeG1sICYmIHJoc3htbCkKICAgICAgICAgICAgYXBwZW5kWG1sQ29t\ncGFyaXNvbjIoYnVmLCBvcCwgbGhzLCByaHMpOwogICAgICAgIGVsc2UgaWYg\nKGxoc3htbCkKICAgICAgICAgICAgYXBwZW5kWG1sQ29tcGFyaXNvbjEoYnVm\nLCBvcCwgbGhzLCByaHMpOwogICAgICAgIGVsc2UgCiAgICAgICAgICAgIGFw\ncGVuZFhtbENvbXBhcmlzb24xKGJ1Ziwgb3AsIHJocywgbGhzKTsKICAgIH0K\nICAgIAogICAgLyoqCiAgICAgKiBBcHBlbmQgYW4geG1sIGNvbXBhcmlzb24g\ncHJlZGljYXRlCiAgICAgKgogICAgICogQHBhcmFtIGJ1ZiB0aGUgU1FMIGJ1\nZmZlciB0byB3cml0ZSB0aGUgY29tcGFyaXNvbgogICAgICogQHBhcmFtIG9w\nIHRoZSBjb21wYXJpc29uIG9wZXJhdGlvbiB0byBwZXJmb3JtCiAgICAgKiBA\ncGFyYW0gbGhzIHRoZSBsZWZ0IGhhbmQgc2lkZSBvZiB0aGUgY29tcGFyaXNv\nbiAobWFwcyB0byB4bWwgY29sdW1uKQogICAgICogQHBhcmFtIHJocyB0aGUg\ncmlnaHQgaGFuZCBzaWRlIG9mIHRoZSBjb21wYXJpc29uCiAgICAgKi8KICAg\nIHByaXZhdGUgdm9pZCBhcHBlbmRYbWxDb21wYXJpc29uMShTUUxCdWZmZXIg\nYnVmLCBTdHJpbmcgb3AsCiAgICAgICAgRmlsdGVyVmFsdWUgbGhzLCBGaWx0\nZXJWYWx1ZSByaHMpIHsKICAgICAgICBhcHBlbmRYbWxFeHRyYWN0VmFsdWUo\nYnVmLCBsaHMpOwogICAgICAgIGJ1Zi5hcHBlbmQoIiAiKS5hcHBlbmQob3Ap\nLmFwcGVuZCgiICIpOwogICAgICAgIHJocy5hcHBlbmRUbyhidWYpOwogICAg\nfQogICAgCiAgICAvKioKICAgICAqIEFwcGVuZCBhbiB4bWwgY29tcGFyaXNv\nbiBwcmVkaWNhdGUgKGJvdGggb3BlcmFuZHMgbWFwIHRvIHhtbCBjb2x1bW4p\nCiAgICAgKgogICAgICogQHBhcmFtIGJ1ZiB0aGUgU1FMIGJ1ZmZlciB0byB3\ncml0ZSB0aGUgY29tcGFyaXNvbgogICAgICogQHBhcmFtIG9wIHRoZSBjb21w\nYXJpc29uIG9wZXJhdGlvbiB0byBwZXJmb3JtCiAgICAgKiBAcGFyYW0gbGhz\nIHRoZSBsZWZ0IGhhbmQgc2lkZSBvZiB0aGUgY29tcGFyaXNvbiAobWFwcyB0\nbyB4bWwgY29sdW1uKQogICAgICogQHBhcmFtIHJocyB0aGUgcmlnaHQgaGFu\nZCBzaWRlIG9mIHRoZSBjb21wYXJpc29uIChtYXBzIHRvIHhtbCBjb2x1bW4p\nCiAgICAgKi8KICAgIHByaXZhdGUgdm9pZCBhcHBlbmRYbWxDb21wYXJpc29u\nMihTUUxCdWZmZXIgYnVmLCBTdHJpbmcgb3AsIAogICAgICAgIEZpbHRlclZh\nbHVlIGxocywgRmlsdGVyVmFsdWUgcmhzKSB7CiAgICAgICAgYXBwZW5kWG1s\nRXh0cmFjdFZhbHVlKGJ1ZiwgbGhzKTsKICAgICAgICBidWYuYXBwZW5kKCIg\nIikuYXBwZW5kKG9wKS5hcHBlbmQoIiAiKTsKICAgICAgICBhcHBlbmRYbWxF\neHRyYWN0VmFsdWUoYnVmLCByaHMpOwogICAgfQogICAgCiAgICBwcml2YXRl\nIHZvaWQgYXBwZW5kWG1sRXh0cmFjdFZhbHVlKFNRTEJ1ZmZlciBidWYsIEZp\nbHRlclZhbHVlIHZhbCkgewogICAgICAgIGJ1Zi5hcHBlbmQoImV4dHJhY3RW\nYWx1ZSgiKS4KICAgICAgICAgICAgYXBwZW5kKHZhbC5nZXRDb2x1bW5BbGlh\ncygKICAgICAgICAgICAgdmFsLmdldEZpZWxkTWFwcGluZygpLmdldENvbHVt\nbnMoKVswXSkpLgogICAgICAgICAgICBhcHBlbmQoIiwnLyovIik7CiAgICAg\nICAgdmFsLmFwcGVuZFRvKGJ1Zik7CiAgICAgICAgYnVmLmFwcGVuZCgiJyki\nKTsKICAgIH0KICAgIAogICAgcHVibGljIHZvaWQgaW5zZXJ0QmxvYkZvclN0\ncmVhbWluZ0xvYWQoUm93IHJvdywgQ29sdW1uIGNvbCwgT2JqZWN0IG9iKQog\nICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIGlmIChvYiA9\nPSBudWxsKQogICAgICAgICAgICBjb2wuc2V0VHlwZShUeXBlcy5PVEhFUik7\nCiAgICAgICAgcm93LnNldE51bGwoY29sKTsKICAgIH0KICAgIAogICAgcHVi\nbGljIHZvaWQgaW5zZXJ0Q2xvYkZvclN0cmVhbWluZ0xvYWQoUm93IHJvdywg\nQ29sdW1uIGNvbCwgT2JqZWN0IG9iKQogICAgICAgIHRocm93cyBTUUxFeGNl\ncHRpb24gewogICAgICAgIGlmIChvYiA9PSBudWxsKQogICAgICAgICAgICBj\nb2wuc2V0VHlwZShUeXBlcy5PVEhFUik7CiAgICAgICAgcm93LnNldE51bGwo\nY29sKTsKICAgIH0KfQo=\n","encoding":"base64"}

