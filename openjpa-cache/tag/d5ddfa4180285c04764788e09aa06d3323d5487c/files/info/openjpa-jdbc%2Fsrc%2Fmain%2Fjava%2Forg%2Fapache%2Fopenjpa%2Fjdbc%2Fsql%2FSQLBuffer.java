{"sha":"386245bcf7df3edbe6b63c4aa0125abb22abaa5e","node_id":"MDQ6QmxvYjIwNjM2NDozODYyNDViY2Y3ZGYzZWRiZTZiNjNjNGFhMDEyNWFiYjIyYWJhYTVl","size":19012,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/386245bcf7df3edbe6b63c4aa0125abb22abaa5e","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zcWw7CgppbXBvcnQg\namF2YS5pby5TZXJpYWxpemFibGU7CmltcG9ydCBqYXZhLnNxbC5DYWxsYWJs\nZVN0YXRlbWVudDsKaW1wb3J0IGphdmEuc3FsLkNvbm5lY3Rpb247CmltcG9y\ndCBqYXZhLnNxbC5QcmVwYXJlZFN0YXRlbWVudDsKaW1wb3J0IGphdmEuc3Fs\nLlJlc3VsdFNldDsKaW1wb3J0IGphdmEuc3FsLlNRTEV4Y2VwdGlvbjsKaW1w\nb3J0IGphdmEudXRpbC5BcnJheUxpc3Q7CmltcG9ydCBqYXZhLnV0aWwuQ29s\nbGVjdGlvbnM7CmltcG9ydCBqYXZhLnV0aWwuSXRlcmF0b3I7CmltcG9ydCBq\nYXZhLnV0aWwuTGlzdDsKCmltcG9ydCBvcmcuYXBhY2hlLmNvbW1vbnMubGFu\nZy5PYmplY3RVdGlsczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJj\nLmtlcm5lbC5KREJDRmV0Y2hDb25maWd1cmF0aW9uOwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLmpkYmMua2VybmVsLmV4cHMuVmFsOwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1hLkNvbHVtbjsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNjaGVtYS5TZXF1ZW5jZTsKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNjaGVtYS5UYWJsZTsKaW1wb3J0\nIHNlcnAudXRpbC5OdW1iZXJzOwoKLyoqCiAqIEJ1ZmZlciBmb3IgU1FMIHN0\nYXRlbWVudHMgdGhhdCBjYW4gYmUgdXNlZCB0byBjcmVhdGUKICogamF2YS5z\ncWwuUHJlcGFyZWRTdGF0ZW1lbnRzLgogKgogKiBAYXV0aG9yIE1hcmMgUHJ1\nZCdob21tZWF1eAogKiBAYXV0aG9yIEFiZSBXaGl0ZQogKiBAc2luY2UgMC4y\nLjQKICovCnB1YmxpYyBmaW5hbCBjbGFzcyBTUUxCdWZmZXIKICAgIGltcGxl\nbWVudHMgU2VyaWFsaXphYmxlLCBDbG9uZWFibGUgewoKICAgIHByaXZhdGUg\nc3RhdGljIGZpbmFsIFN0cmluZyBQQVJBTUVURVJfVE9LRU4gPSAiPyI7Cgog\nICAgcHJpdmF0ZSBmaW5hbCBEQkRpY3Rpb25hcnkgX2RpY3Q7CiAgICBwcml2\nYXRlIGZpbmFsIFN0cmluZ0J1ZmZlciBfc3FsID0gbmV3IFN0cmluZ0J1ZmZl\ncigpOwogICAgcHJpdmF0ZSBMaXN0IF9zdWJzZWxzID0gbnVsbDsKICAgIHBy\naXZhdGUgTGlzdCBfcGFyYW1zID0gbnVsbDsKICAgIHByaXZhdGUgTGlzdCBf\nY29scyA9IG51bGw7CgogICAgLyoqCiAgICAgKiBEZWZhdWx0IGNvbnN0cnVj\ndG9yLgogICAgICovCiAgICBwdWJsaWMgU1FMQnVmZmVyKERCRGljdGlvbmFy\neSBkaWN0KSB7CiAgICAgICAgX2RpY3QgPSBkaWN0OwogICAgfQoKICAgIC8q\nKgogICAgICogQ29weSBjb25zdHJ1Y3Rvci4KICAgICAqLwogICAgcHVibGlj\nIFNRTEJ1ZmZlcihTUUxCdWZmZXIgYnVmKSB7CiAgICAgICAgX2RpY3QgPSBi\ndWYuX2RpY3Q7CiAgICAgICAgYXBwZW5kKGJ1Zik7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBQZXJmb3JtIGEgc2hhbGxvdyBjbG9uZSBvZiB0aGlzIFNRTCBC\ndWZmZXIuCiAgICAgKi8KICAgIHB1YmxpYyBPYmplY3QgY2xvbmUoKSB7CiAg\nICAgICAgcmV0dXJuIG5ldyBTUUxCdWZmZXIodGhpcyk7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBSZXR1cm4gdHJ1ZSBpZiB0aGUgYnVmZmVyIGlzIGVtdHB5\nLgogICAgICovCiAgICBwdWJsaWMgYm9vbGVhbiBpc0VtcHR5KCkgewogICAg\nICAgIHJldHVybiBfc3FsLmxlbmd0aCgpID09IDA7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBBcHBlbmQgYWxsIFNRTCBhbmQgcGFyYW1ldGVycyBvZiB0aGUg\nZ2l2ZW4gYnVmZmVyLgogICAgICovCiAgICBwdWJsaWMgU1FMQnVmZmVyIGFw\ncGVuZChTUUxCdWZmZXIgYnVmKSB7CiAgICAgICAgYXBwZW5kKGJ1ZiwgX3Nx\nbC5sZW5ndGgoKSwgKF9wYXJhbXMgPT0gbnVsbCkgPyAwIDogX3BhcmFtcy5z\naXplKCksCiAgICAgICAgICAgIHRydWUpOwogICAgICAgIHJldHVybiB0aGlz\nOwogICAgfQoKICAgIC8qKgogICAgICogQXBwZW5kIGFsbCBTUUwgYW5kIHBh\ncmFtZXRlcnMgb2YgdGhlIGdpdmVuIGJ1ZmZlciBhdCB0aGUgZ2l2ZW4gcG9z\naXRpb25zLgogICAgICovCiAgICBwcml2YXRlIHZvaWQgYXBwZW5kKFNRTEJ1\nZmZlciBidWYsIGludCBzcWxJbmRleCwgaW50IHBhcmFtSW5kZXgsCiAgICAg\nICAgYm9vbGVhbiBzdWJzZWxzKSB7CiAgICAgICAgaWYgKHN1YnNlbHMpIHsK\nICAgICAgICAgICAgLy8gb25seSBhbGxvdyBhcHBlbmRpbmcgb2YgYnVmZmVy\ncyB3aXRoIHN1YnNlbGVjdHMsIG5vdCBpbnNlcnRpb24KICAgICAgICAgICAg\naWYgKF9zdWJzZWxzICE9IG51bGwgJiYgIV9zdWJzZWxzLmlzRW1wdHkoKQog\nICAgICAgICAgICAgICAgJiYgc3FsSW5kZXggIT0gX3NxbC5sZW5ndGgoKSkK\nICAgICAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsU3RhdGVFeGNlcHRp\nb24oKTsKICAgICAgICAgICAgaWYgKGJ1Zi5fc3Vic2VscyAhPSBudWxsICYm\nICFidWYuX3N1YnNlbHMuaXNFbXB0eSgpKSB7CiAgICAgICAgICAgICAgICBp\nZiAoc3FsSW5kZXggIT0gX3NxbC5sZW5ndGgoKSkKICAgICAgICAgICAgICAg\nICAgICB0aHJvdyBuZXcgSWxsZWdhbFN0YXRlRXhjZXB0aW9uKCk7CiAgICAg\nICAgICAgICAgICBpZiAoX3N1YnNlbHMgPT0gbnVsbCkKICAgICAgICAgICAg\nICAgICAgICBfc3Vic2VscyA9IG5ldyBBcnJheUxpc3QoYnVmLl9zdWJzZWxz\nLnNpemUoKSk7CiAgICAgICAgICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8\nIGJ1Zi5fc3Vic2Vscy5zaXplKCk7IGkrKykKICAgICAgICAgICAgICAgICAg\nICBfc3Vic2Vscy5hZGQoKChTdWJzZWxlY3QpIGJ1Zi5fc3Vic2Vscy5nZXQo\naSkpLgogICAgICAgICAgICAgICAgICAgICAgICBjbG9uZShzcWxJbmRleCwg\ncGFyYW1JbmRleCkpOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAg\nICBpZiAoc3FsSW5kZXggPT0gX3NxbC5sZW5ndGgoKSkKICAgICAgICAgICAg\nX3NxbC5hcHBlbmQoYnVmLl9zcWwudG9TdHJpbmcoKSk7CiAgICAgICAgZWxz\nZQogICAgICAgICAgICBfc3FsLmluc2VydChzcWxJbmRleCwgYnVmLl9zcWwu\ndG9TdHJpbmcoKSk7CgogICAgICAgIGlmIChidWYuX3BhcmFtcyAhPSBudWxs\nKSB7CiAgICAgICAgICAgIGlmIChfcGFyYW1zID09IG51bGwpCiAgICAgICAg\nICAgICAgICBfcGFyYW1zID0gbmV3IEFycmF5TGlzdCgpOwogICAgICAgICAg\nICBpZiAoX2NvbHMgPT0gbnVsbCAmJiBidWYuX2NvbHMgIT0gbnVsbCkgewog\nICAgICAgICAgICAgICAgX2NvbHMgPSBuZXcgQXJyYXlMaXN0KCk7CiAgICAg\nICAgICAgICAgICB3aGlsZSAoX2NvbHMuc2l6ZSgpIDwgX3BhcmFtcy5zaXpl\nKCkpCiAgICAgICAgICAgICAgICAgICAgX2NvbHMuYWRkKG51bGwpOwogICAg\nICAgICAgICB9CgogICAgICAgICAgICBpZiAocGFyYW1JbmRleCA9PSBfcGFy\nYW1zLnNpemUoKSkgewogICAgICAgICAgICAgICAgX3BhcmFtcy5hZGRBbGwo\nYnVmLl9wYXJhbXMpOwogICAgICAgICAgICAgICAgaWYgKGJ1Zi5fY29scyAh\nPSBudWxsKQogICAgICAgICAgICAgICAgICAgIF9jb2xzLmFkZEFsbChidWYu\nX2NvbHMpOwogICAgICAgICAgICAgICAgZWxzZSBpZiAoX2NvbHMgIT0gbnVs\nbCkKICAgICAgICAgICAgICAgICAgICB3aGlsZSAoX2NvbHMuc2l6ZSgpIDwg\nX3BhcmFtcy5zaXplKCkpCiAgICAgICAgICAgICAgICAgICAgICAgIF9jb2xz\nLmFkZChudWxsKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAg\nICAgIF9wYXJhbXMuYWRkQWxsKHBhcmFtSW5kZXgsIGJ1Zi5fcGFyYW1zKTsK\nICAgICAgICAgICAgICAgIGlmIChidWYuX2NvbHMgIT0gbnVsbCkKICAgICAg\nICAgICAgICAgICAgICBfY29scy5hZGRBbGwocGFyYW1JbmRleCwgYnVmLl9j\nb2xzKTsKICAgICAgICAgICAgICAgIGVsc2UgaWYgKF9jb2xzICE9IG51bGwp\nCiAgICAgICAgICAgICAgICAgICAgd2hpbGUgKF9jb2xzLnNpemUoKSA8IF9w\nYXJhbXMuc2l6ZSgpKQogICAgICAgICAgICAgICAgICAgICAgICBfY29scy5h\nZGQocGFyYW1JbmRleCwgbnVsbCk7CiAgICAgICAgICAgIH0KICAgICAgICB9\nCiAgICB9CgogICAgcHVibGljIFNRTEJ1ZmZlciBhcHBlbmQoVGFibGUgdGFi\nbGUpIHsKICAgICAgICBfc3FsLmFwcGVuZChfZGljdC5nZXRGdWxsTmFtZSh0\nYWJsZSwgZmFsc2UpKTsKICAgICAgICByZXR1cm4gdGhpczsKICAgIH0KCiAg\nICBwdWJsaWMgU1FMQnVmZmVyIGFwcGVuZChTZXF1ZW5jZSBzZXEpIHsKICAg\nICAgICBfc3FsLmFwcGVuZChfZGljdC5nZXRGdWxsTmFtZShzZXEpKTsKICAg\nICAgICByZXR1cm4gdGhpczsKICAgIH0KCiAgICBwdWJsaWMgU1FMQnVmZmVy\nIGFwcGVuZChDb2x1bW4gY29sKSB7CiAgICAgICAgX3NxbC5hcHBlbmQoY29s\nLmdldE5hbWUoKSk7CiAgICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CgogICAg\ncHVibGljIFNRTEJ1ZmZlciBhcHBlbmQoU3RyaW5nIHMpIHsKICAgICAgICBf\nc3FsLmFwcGVuZChzKTsKICAgICAgICByZXR1cm4gdGhpczsKICAgIH0KCiAg\nICAvKioKICAgICAqIEFwcGVuZCBhIHN1YnNlbGVjdC4gVGhpcyBkZWxheXMg\ncmVzb2x1dGlvbiBvZiB0aGUgc2VsZWN0IFNRTC4KICAgICAqLwogICAgcHVi\nbGljIFNRTEJ1ZmZlciBhcHBlbmQoU2VsZWN0IHNlbCwgSkRCQ0ZldGNoQ29u\nZmlndXJhdGlvbiBmZXRjaCkgewogICAgICAgIHJldHVybiBhcHBlbmQoc2Vs\nLCBmZXRjaCwgZmFsc2UpOwogICAgfQoKICAgIC8qKgogICAgICogQXBwZW5k\nIGEgc3Vic2VsZWN0IGNvdW50LiBUaGlzIGRlbGF5cyByZXNvbHV0aW9uIG9m\nIHRoZSBzZWxlY3QgU1FMLgogICAgICovCiAgICBwdWJsaWMgU1FMQnVmZmVy\nIGFwcGVuZENvdW50KFNlbGVjdCBzZWwsIEpEQkNGZXRjaENvbmZpZ3VyYXRp\nb24gZmV0Y2gpIHsKICAgICAgICByZXR1cm4gYXBwZW5kKHNlbCwgZmV0Y2gs\nIHRydWUpOwogICAgfQoKICAgIC8qKgogICAgICogQXBwZW5kIGEgc3Vic2Vs\nZWN0LiBUaGlzIGRlbGF5cyByZXNvbHV0aW9uIG9mIHRoZSBzZWxlY3QgU1FM\nLgogICAgICovCiAgICBwcml2YXRlIFNRTEJ1ZmZlciBhcHBlbmQoU2VsZWN0\nIHNlbCwgSkRCQ0ZldGNoQ29uZmlndXJhdGlvbiBmZXRjaCwKICAgICAgICBi\nb29sZWFuIGNvdW50KSB7CiAgICAgICAgX3NxbC5hcHBlbmQoIigiKTsKICAg\nICAgICBTdWJzZWxlY3Qgc3ViID0gbmV3IFN1YnNlbGVjdCgpOwogICAgICAg\nIHN1Yi5zZWxlY3QgPSBzZWw7CiAgICAgICAgc3ViLmZldGNoID0gZmV0Y2g7\nCiAgICAgICAgc3ViLmNvdW50ID0gY291bnQ7CiAgICAgICAgc3ViLnNxbElu\nZGV4ID0gX3NxbC5sZW5ndGgoKTsKICAgICAgICBzdWIucGFyYW1JbmRleCA9\nIChfcGFyYW1zID09IG51bGwpID8gMCA6IF9wYXJhbXMuc2l6ZSgpOwogICAg\nICAgIF9zcWwuYXBwZW5kKCIpIik7CgogICAgICAgIGlmIChfc3Vic2VscyA9\nPSBudWxsKQogICAgICAgICAgICBfc3Vic2VscyA9IG5ldyBBcnJheUxpc3Qo\nMik7CiAgICAgICAgX3N1YnNlbHMuYWRkKHN1Yik7CiAgICAgICAgcmV0dXJu\nIHRoaXM7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXBsYWNlIGEgc3Vic2Vs\nZWN0LgogICAgICovCiAgICBwdWJsaWMgYm9vbGVhbiByZXBsYWNlKFNlbGVj\ndCBvbGQsIFNlbGVjdCBzZWwpIHsKICAgICAgICBpZiAoX3N1YnNlbHMgPT0g\nbnVsbCkKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIFN1YnNl\nbGVjdCBzdWI7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBfc3Vic2Vs\ncy5zaXplKCk7IGkrKykgewogICAgICAgICAgICBzdWIgPSAoU3Vic2VsZWN0\nKSBfc3Vic2Vscy5nZXQoaSk7CiAgICAgICAgICAgIGlmIChzdWIuc2VsZWN0\nID09IG9sZCkgewogICAgICAgICAgICAgICAgc3ViLnNlbGVjdCA9IHNlbDsK\nICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICB9CiAg\nICAgICAgfQogICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICAvKioK\nICAgICAqIEFwcGVuZCBhIHBhcmFtZXRlciB2YWx1ZS4KICAgICAqLwogICAg\ncHVibGljIFNRTEJ1ZmZlciBhcHBlbmRWYWx1ZShPYmplY3QgbykgewogICAg\nICAgIHJldHVybiBhcHBlbmRWYWx1ZShvLCBudWxsKTsKICAgIH0KCiAgICAv\nKioKICAgICAqIEFwcGVuZCBhIHBhcmFtZXRlciB2YWx1ZSBmb3IgYSBzcGVj\naWZpYyBjb2x1bW4uCiAgICAgKi8KICAgIHB1YmxpYyBTUUxCdWZmZXIgYXBw\nZW5kVmFsdWUoT2JqZWN0IG8sIENvbHVtbiBjb2wpIHsKICAgICAgICBpZiAo\nbyA9PSBudWxsKQogICAgICAgICAgICBfc3FsLmFwcGVuZCgiTlVMTCIpOwog\nICAgICAgIGVsc2UgaWYgKG8gaW5zdGFuY2VvZiBSYXcpCiAgICAgICAgICAg\nIF9zcWwuYXBwZW5kKG8udG9TdHJpbmcoKSk7CiAgICAgICAgZWxzZSB7CiAg\nICAgICAgICAgIF9zcWwuYXBwZW5kKFBBUkFNRVRFUl9UT0tFTik7CgogICAg\nICAgICAgICAvLyBpbml0aWFsaXplIHBhcmFtIGFuZCBjb2wgbGlzdHM7IHdl\nIGhvbGQgb2ZmIG9uIGNvbCBsaXN0IHVudGlsCiAgICAgICAgICAgIC8vIHdl\nIGdldCB0aGUgZmlyc3Qgbm9uLW51bGwgY29sCiAgICAgICAgICAgIGlmIChf\ncGFyYW1zID09IG51bGwpCiAgICAgICAgICAgICAgICBfcGFyYW1zID0gbmV3\nIEFycmF5TGlzdCgpOwogICAgICAgICAgICBpZiAoY29sICE9IG51bGwgJiYg\nX2NvbHMgPT0gbnVsbCkgewogICAgICAgICAgICAgICAgX2NvbHMgPSBuZXcg\nQXJyYXlMaXN0KCk7CiAgICAgICAgICAgICAgICB3aGlsZSAoX2NvbHMuc2l6\nZSgpIDwgX3BhcmFtcy5zaXplKCkpCiAgICAgICAgICAgICAgICAgICAgX2Nv\nbHMuYWRkKG51bGwpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBfcGFy\nYW1zLmFkZChvKTsKICAgICAgICAgICAgaWYgKF9jb2xzICE9IG51bGwpCiAg\nICAgICAgICAgICAgICBfY29scy5hZGQoY29sKTsKICAgICAgICB9CiAgICAg\nICAgcmV0dXJuIHRoaXM7CiAgICB9CgogICAgLyoqCiAgICAgKiBBcHBlbmQg\nYSBwYXJhbWV0ZXIgdmFsdWUuCiAgICAgKi8KICAgIHB1YmxpYyBTUUxCdWZm\nZXIgYXBwZW5kVmFsdWUoYm9vbGVhbiBiKSB7CiAgICAgICAgcmV0dXJuIGFw\ncGVuZFZhbHVlKGIsIG51bGwpOwogICAgfQoKICAgIC8qKgogICAgICogQXBw\nZW5kIGEgcGFyYW1ldGVyIHZhbHVlLgogICAgICovCiAgICBwdWJsaWMgU1FM\nQnVmZmVyIGFwcGVuZFZhbHVlKGJvb2xlYW4gYiwgQ29sdW1uIGNvbCkgewog\nICAgICAgIHJldHVybiBhcHBlbmRWYWx1ZSgoYikgPyBCb29sZWFuLlRSVUUg\nOiBCb29sZWFuLkZBTFNFLCBjb2wpOwogICAgfQoKICAgIC8qKgogICAgICog\nQXBwZW5kIGEgcGFyYW1ldGVyIHZhbHVlLgogICAgICovCiAgICBwdWJsaWMg\nU1FMQnVmZmVyIGFwcGVuZFZhbHVlKGJ5dGUgYikgewogICAgICAgIHJldHVy\nbiBhcHBlbmRWYWx1ZShiLCBudWxsKTsKICAgIH0KCiAgICAvKioKICAgICAq\nIEFwcGVuZCBhIHBhcmFtZXRlciB2YWx1ZS4KICAgICAqLwogICAgcHVibGlj\nIFNRTEJ1ZmZlciBhcHBlbmRWYWx1ZShieXRlIGIsIENvbHVtbiBjb2wpIHsK\nICAgICAgICByZXR1cm4gYXBwZW5kVmFsdWUobmV3IEJ5dGUoYiksIGNvbCk7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBBcHBlbmQgYSBwYXJhbWV0ZXIgdmFs\ndWUuCiAgICAgKi8KICAgIHB1YmxpYyBTUUxCdWZmZXIgYXBwZW5kVmFsdWUo\nY2hhciBjKSB7CiAgICAgICAgcmV0dXJuIGFwcGVuZFZhbHVlKGMsIG51bGwp\nOwogICAgfQoKICAgIC8qKgogICAgICogQXBwZW5kIGEgcGFyYW1ldGVyIHZh\nbHVlLgogICAgICovCiAgICBwdWJsaWMgU1FMQnVmZmVyIGFwcGVuZFZhbHVl\nKGNoYXIgYywgQ29sdW1uIGNvbCkgewogICAgICAgIHJldHVybiBhcHBlbmRW\nYWx1ZShuZXcgQ2hhcmFjdGVyKGMpLCBjb2wpOwogICAgfQoKICAgIC8qKgog\nICAgICogQXBwZW5kIGEgcGFyYW1ldGVyIHZhbHVlLgogICAgICovCiAgICBw\ndWJsaWMgU1FMQnVmZmVyIGFwcGVuZFZhbHVlKGRvdWJsZSBkKSB7CiAgICAg\nICAgcmV0dXJuIGFwcGVuZFZhbHVlKGQsIG51bGwpOwogICAgfQoKICAgIC8q\nKgogICAgICogQXBwZW5kIGEgcGFyYW1ldGVyIHZhbHVlLgogICAgICovCiAg\nICBwdWJsaWMgU1FMQnVmZmVyIGFwcGVuZFZhbHVlKGRvdWJsZSBkLCBDb2x1\nbW4gY29sKSB7CiAgICAgICAgcmV0dXJuIGFwcGVuZFZhbHVlKG5ldyBEb3Vi\nbGUoZCksIGNvbCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBBcHBlbmQgYSBw\nYXJhbWV0ZXIgdmFsdWUuCiAgICAgKi8KICAgIHB1YmxpYyBTUUxCdWZmZXIg\nYXBwZW5kVmFsdWUoZmxvYXQgZikgewogICAgICAgIHJldHVybiBhcHBlbmRW\nYWx1ZShmLCBudWxsKTsKICAgIH0KCiAgICAvKioKICAgICAqIEFwcGVuZCBh\nIHBhcmFtZXRlciB2YWx1ZS4KICAgICAqLwogICAgcHVibGljIFNRTEJ1ZmZl\nciBhcHBlbmRWYWx1ZShmbG9hdCBmLCBDb2x1bW4gY29sKSB7CiAgICAgICAg\ncmV0dXJuIGFwcGVuZFZhbHVlKG5ldyBGbG9hdChmKSwgY29sKTsKICAgIH0K\nCiAgICAvKioKICAgICAqIEFwcGVuZCBhIHBhcmFtZXRlciB2YWx1ZS4KICAg\nICAqLwogICAgcHVibGljIFNRTEJ1ZmZlciBhcHBlbmRWYWx1ZShpbnQgaSkg\newogICAgICAgIHJldHVybiBhcHBlbmRWYWx1ZShpLCBudWxsKTsKICAgIH0K\nCiAgICAvKioKICAgICAqIEFwcGVuZCBhIHBhcmFtZXRlciB2YWx1ZS4KICAg\nICAqLwogICAgcHVibGljIFNRTEJ1ZmZlciBhcHBlbmRWYWx1ZShpbnQgaSwg\nQ29sdW1uIGNvbCkgewogICAgICAgIHJldHVybiBhcHBlbmRWYWx1ZShOdW1i\nZXJzLnZhbHVlT2YoaSksIGNvbCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBB\ncHBlbmQgYSBwYXJhbWV0ZXIgdmFsdWUuCiAgICAgKi8KICAgIHB1YmxpYyBT\nUUxCdWZmZXIgYXBwZW5kVmFsdWUobG9uZyBsKSB7CiAgICAgICAgcmV0dXJu\nIGFwcGVuZFZhbHVlKGwsIG51bGwpOwogICAgfQoKICAgIC8qKgogICAgICog\nQXBwZW5kIGEgcGFyYW1ldGVyIHZhbHVlLgogICAgICovCiAgICBwdWJsaWMg\nU1FMQnVmZmVyIGFwcGVuZFZhbHVlKGxvbmcgbCwgQ29sdW1uIGNvbCkgewog\nICAgICAgIHJldHVybiBhcHBlbmRWYWx1ZShOdW1iZXJzLnZhbHVlT2YobCks\nIGNvbCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBBcHBlbmQgYSBwYXJhbWV0\nZXIgdmFsdWUuCiAgICAgKi8KICAgIHB1YmxpYyBTUUxCdWZmZXIgYXBwZW5k\nVmFsdWUoc2hvcnQgcykgewogICAgICAgIHJldHVybiBhcHBlbmRWYWx1ZShz\nLCBudWxsKTsKICAgIH0KCiAgICAvKioKICAgICAqIEFwcGVuZCBhIHBhcmFt\nZXRlciB2YWx1ZS4KICAgICAqLwogICAgcHVibGljIFNRTEJ1ZmZlciBhcHBl\nbmRWYWx1ZShzaG9ydCBzLCBDb2x1bW4gY29sKSB7CiAgICAgICAgcmV0dXJu\nIGFwcGVuZFZhbHVlKG5ldyBTaG9ydChzKSwgY29sKTsKICAgIH0KCiAgICAv\nKioKICAgICAqIFJldHVybiB0aGUgbGlzdCBvZiBwYXJhbWV0ZXIgdmFsdWVz\nLgogICAgICovCiAgICBwdWJsaWMgTGlzdCBnZXRQYXJhbWV0ZXJzKCkgewog\nICAgICAgIHJldHVybiAoX3BhcmFtcyA9PSBudWxsKSA/IENvbGxlY3Rpb25z\nLkVNUFRZX0xJU1QgOiBfcGFyYW1zOwogICAgfQoKICAgIC8qKgogICAgICog\nUmV0dXJuIHRoZSBTUUwgZm9yIHRoaXMgYnVmZmVyLgogICAgICovCiAgICBw\ndWJsaWMgU3RyaW5nIGdldFNRTCgpIHsKICAgICAgICByZXR1cm4gZ2V0U1FM\nKGZhbHNlKTsKICAgIH0KICAgIAogICAgLyoqCiAgICAgKiBSZXR1cm5zIHRo\nZSBTUUwgZm9yIHRoaXMgYnVmZmVyLgogICAgICoKICAgICAqIEBwYXJhbSBy\nZXBsYWNlUGFyYW1zIGlmIHRydWUsIHRoZW4gcmVwbGFjZSBwYXJhbWV0ZXJz\nIHdpdGggdGhlCiAgICAgKiBhY3R1YWwgcGFyYW1ldGVyIHZhbHVlcwogICAg\nICovCiAgICBwdWJsaWMgU3RyaW5nIGdldFNRTChib29sZWFuIHJlcGxhY2VQ\nYXJhbXMpIHsKICAgICAgICByZXNvbHZlU3Vic2VsZWN0cygpOwogICAgICAg\nIFN0cmluZyBzcWwgPSBfc3FsLnRvU3RyaW5nKCk7CiAgICAgICAgaWYgKCFy\nZXBsYWNlUGFyYW1zIHx8IF9wYXJhbXMgPT0gbnVsbCB8fCBfcGFyYW1zLmlz\nRW1wdHkoKSkKICAgICAgICAgICAgcmV0dXJuIHNxbDsKCiAgICAgICAgU3Ry\naW5nQnVmZmVyIGJ1ZiA9IG5ldyBTdHJpbmdCdWZmZXIoKTsKICAgICAgICBJ\ndGVyYXRvciBwaSA9IF9wYXJhbXMuaXRlcmF0b3IoKTsKICAgICAgICBmb3Ig\nKGludCBpID0gMDsgaSA8IHNxbC5sZW5ndGgoKTsgaSsrKSB7CiAgICAgICAg\nICAgIGlmIChzcWwuY2hhckF0KGkpICE9ICc/JykgewogICAgICAgICAgICAg\nICAgYnVmLmFwcGVuZChzcWwuY2hhckF0KGkpKTsKICAgICAgICAgICAgICAg\nIGNvbnRpbnVlOwogICAgICAgICAgICB9CgogICAgICAgICAgICBPYmplY3Qg\ncGFyYW0gPSBwaS5oYXNOZXh0KCkgPyBwaS5uZXh0KCkgOiBudWxsOwogICAg\nICAgICAgICBpZiAocGFyYW0gPT0gbnVsbCkKICAgICAgICAgICAgICAgIGJ1\nZi5hcHBlbmQoIk5VTEwiKTsKICAgICAgICAgICAgZWxzZSBpZiAocGFyYW0g\naW5zdGFuY2VvZiBOdW1iZXIgfHwgcGFyYW0gaW5zdGFuY2VvZiBCb29sZWFu\nKQogICAgICAgICAgICAgICAgYnVmLmFwcGVuZChwYXJhbSk7CiAgICAgICAg\nICAgIGVsc2UgaWYgKHBhcmFtIGluc3RhbmNlb2YgU3RyaW5nIHx8IHBhcmFt\nIGluc3RhbmNlb2YgQ2hhcmFjdGVyKQogICAgICAgICAgICAgICAgYnVmLmFw\ncGVuZCgiJyIpLmFwcGVuZChwYXJhbSkuYXBwZW5kKCInIik7CiAgICAgICAg\nICAgIGVsc2UKICAgICAgICAgICAgICAgIGJ1Zi5hcHBlbmQoIj8iKTsKICAg\nICAgICB9CiAgICAgICAgcmV0dXJuIGJ1Zi50b1N0cmluZygpOwogICAgfQoK\nICAgIC8qKgogICAgICogUmVzb2x2ZSBvdXIgZGVsYXllZCBzdWJzZWxlY3Rz\nLgogICAgICovCiAgICBwcml2YXRlIHZvaWQgcmVzb2x2ZVN1YnNlbGVjdHMo\nKSB7CiAgICAgICAgaWYgKF9zdWJzZWxzID09IG51bGwgfHwgX3N1YnNlbHMu\naXNFbXB0eSgpKQogICAgICAgICAgICByZXR1cm47CgogICAgICAgIC8vIGFk\nZCBzdWJzZWxzIGJhY2t3YXJkcyBzbyB0aGF0IHRoZSBzdG9yZWQgaW5zZXJ0\naW9uIHBvaW50cyBvZgogICAgICAgIC8vIGxhdGVyIHN1YnNlbHMgcmVtYWlu\nIHZhbGlkCiAgICAgICAgU3Vic2VsZWN0IHN1YjsKICAgICAgICBTUUxCdWZm\nZXIgYnVmOwogICAgICAgIGZvciAoaW50IGkgPSBfc3Vic2Vscy5zaXplKCkg\nLSAxOyBpID49IDA7IGktLSkgewogICAgICAgICAgICBzdWIgPSAoU3Vic2Vs\nZWN0KSBfc3Vic2Vscy5nZXQoaSk7CiAgICAgICAgICAgIGlmIChzdWIuY291\nbnQpCiAgICAgICAgICAgICAgICBidWYgPSBzdWIuc2VsZWN0LnRvU2VsZWN0\nQ291bnQoKTsKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgYnVm\nID0gc3ViLnNlbGVjdC50b1NlbGVjdChmYWxzZSwgc3ViLmZldGNoKTsKICAg\nICAgICAgICAgYnVmLnJlc29sdmVTdWJzZWxlY3RzKCk7CiAgICAgICAgICAg\nIGFwcGVuZChidWYsIHN1Yi5zcWxJbmRleCwgc3ViLnBhcmFtSW5kZXgsIGZh\nbHNlKTsKICAgICAgICB9CiAgICAgICAgX3N1YnNlbHMuY2xlYXIoKTsKICAg\nIH0KCiAgICAvKioKICAgICAqIENyZWF0ZSBhbmQgcG9wdWxhdGUgdGhlIHBh\ncmFtZXRlcnMgb2YgYSBwcmVwYXJlZCBzdGF0ZW1lbnQgdXNpbmcKICAgICAq\nIHRoZSBTUUwgaW4gdGhpcyBidWZmZXIuCiAgICAgKi8KICAgIHB1YmxpYyBQ\ncmVwYXJlZFN0YXRlbWVudCBwcmVwYXJlU3RhdGVtZW50KENvbm5lY3Rpb24g\nY29ubikKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBy\nZXR1cm4gcHJlcGFyZVN0YXRlbWVudChjb25uLCBSZXN1bHRTZXQuVFlQRV9G\nT1JXQVJEX09OTFksCiAgICAgICAgICAgIFJlc3VsdFNldC5DT05DVVJfUkVB\nRF9PTkxZKTsKICAgIH0KCiAgICAvKioKICAgICAqIENyZWF0ZSBhbmQgcG9w\ndWxhdGUgdGhlIHBhcmFtZXRlcnMgb2YgYSBwcmVwYXJlZCBzdGF0ZW1lbnQg\ndXNpbmcKICAgICAqIHRoZSBTUUwgaW4gdGhpcyBidWZmZXIuCiAgICAgKi8K\nICAgIHB1YmxpYyBQcmVwYXJlZFN0YXRlbWVudCBwcmVwYXJlU3RhdGVtZW50\nKENvbm5lY3Rpb24gY29ubiwgaW50IHJzVHlwZSwKICAgICAgICBpbnQgcnND\nb25jdXIpCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAg\ncmV0dXJuIHByZXBhcmVTdGF0ZW1lbnQoY29ubiwgbnVsbCwgcnNUeXBlLCBy\nc0NvbmN1cik7CiAgICB9CgogICAgLyoqCiAgICAgKiBDcmVhdGUgYW5kIHBv\ncHVsYXRlIHRoZSBwYXJhbWV0ZXJzIG9mIGEgcHJlcHJlZCBzdGF0ZW1lbnQg\ndXNpbmcgdGhlCiAgICAgKiBTUUwgaW4gdGhpcyBidWZmZXIgYW5kIHRoZSBn\naXZlbiBmZXRjaCBjb25maWd1cmF0aW9uLgogICAgICovCiAgICBwdWJsaWMg\nUHJlcGFyZWRTdGF0ZW1lbnQgcHJlcGFyZVN0YXRlbWVudChDb25uZWN0aW9u\nIGNvbm4sCiAgICAgICAgSkRCQ0ZldGNoQ29uZmlndXJhdGlvbiBmZXRjaCwg\naW50IHJzVHlwZSwgaW50IHJzQ29uY3VyKQogICAgICAgIHRocm93cyBTUUxF\neGNlcHRpb24gewogICAgICAgIGlmIChyc1R5cGUgPT0gLTEgJiYgZmV0Y2gg\nPT0gbnVsbCkKICAgICAgICAgICAgcnNUeXBlID0gUmVzdWx0U2V0LlRZUEVf\nRk9SV0FSRF9PTkxZOwogICAgICAgIGVsc2UgaWYgKHJzVHlwZSA9PSAtMSkK\nICAgICAgICAgICAgcnNUeXBlID0gZmV0Y2guZ2V0UmVzdWx0U2V0VHlwZSgp\nOwogICAgICAgIGlmIChyc0NvbmN1ciA9PSAtMSkKICAgICAgICAgICAgcnND\nb25jdXIgPSBSZXN1bHRTZXQuQ09OQ1VSX1JFQURfT05MWTsKCiAgICAgICAg\nUHJlcGFyZWRTdGF0ZW1lbnQgc3RtbnQ7CiAgICAgICAgaWYgKHJzVHlwZSA9\nPSBSZXN1bHRTZXQuVFlQRV9GT1JXQVJEX09OTFkKICAgICAgICAgICAgJiYg\ncnNDb25jdXIgPT0gUmVzdWx0U2V0LkNPTkNVUl9SRUFEX09OTFkpCiAgICAg\nICAgICAgIHN0bW50ID0gY29ubi5wcmVwYXJlU3RhdGVtZW50KGdldFNRTCgp\nKTsKICAgICAgICBlbHNlCiAgICAgICAgICAgIHN0bW50ID0gY29ubi5wcmVw\nYXJlU3RhdGVtZW50KGdldFNRTCgpLCByc1R5cGUsIHJzQ29uY3VyKTsKICAg\nICAgICB0cnkgewogICAgICAgICAgICBzZXRQYXJhbWV0ZXJzKHN0bW50KTsK\nICAgICAgICAgICAgaWYgKGZldGNoICE9IG51bGwpIHsKICAgICAgICAgICAg\nICAgIGlmIChmZXRjaC5nZXRGZXRjaEJhdGNoU2l6ZSgpID4gMCkKICAgICAg\nICAgICAgICAgICAgICBzdG1udC5zZXRGZXRjaFNpemUoZmV0Y2guZ2V0RmV0\nY2hCYXRjaFNpemUoKSk7CiAgICAgICAgICAgICAgICBpZiAocnNUeXBlICE9\nIFJlc3VsdFNldC5UWVBFX0ZPUldBUkRfT05MWQogICAgICAgICAgICAgICAg\nICAgICYmIGZldGNoLmdldEZldGNoRGlyZWN0aW9uKCkgIT0gUmVzdWx0U2V0\nLkZFVENIX0ZPUldBUkQpCiAgICAgICAgICAgICAgICAgICAgc3RtbnQuc2V0\nRmV0Y2hEaXJlY3Rpb24oZmV0Y2guZ2V0RmV0Y2hEaXJlY3Rpb24oKSk7CiAg\nICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIHN0bW50OwogICAgICAg\nIH0gY2F0Y2ggKFNRTEV4Y2VwdGlvbiBzZSkgewogICAgICAgICAgICB0cnkg\newogICAgICAgICAgICAgICAgc3RtbnQuY2xvc2UoKTsKICAgICAgICAgICAg\nfSBjYXRjaCAoU1FMRXhjZXB0aW9uIHNlMikgewogICAgICAgICAgICB9CiAg\nICAgICAgICAgIHRocm93IHNlOwogICAgICAgIH0KICAgIH0KCiAgICAvKioK\nICAgICAqIENyZWF0ZSBhbmQgcG9wdWxhdGUgdGhlIHBhcmFtZXRlcnMgb2Yg\nYSBwcmVwYXJlZCBzdGF0ZW1lbnQgdXNpbmcKICAgICAqIHRoZSBTUUwgaW4g\ndGhpcyBidWZmZXIuCiAgICAgKi8KICAgIHB1YmxpYyBDYWxsYWJsZVN0YXRl\nbWVudCBwcmVwYXJlQ2FsbChDb25uZWN0aW9uIGNvbm4pCiAgICAgICAgdGhy\nb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgcmV0dXJuIHByZXBhcmVDYWxs\nKGNvbm4sIFJlc3VsdFNldC5UWVBFX0ZPUldBUkRfT05MWSwKICAgICAgICAg\nICAgUmVzdWx0U2V0LkNPTkNVUl9SRUFEX09OTFkpOwogICAgfQoKICAgIC8q\nKgogICAgICogQ3JlYXRlIGFuZCBwb3B1bGF0ZSB0aGUgcGFyYW1ldGVycyBv\nZiBhIHByZXBhcmVkIHN0YXRlbWVudCB1c2luZwogICAgICogdGhlIFNRTCBp\nbiB0aGlzIGJ1ZmZlci4KICAgICAqLwogICAgcHVibGljIENhbGxhYmxlU3Rh\ndGVtZW50IHByZXBhcmVDYWxsKENvbm5lY3Rpb24gY29ubiwgaW50IHJzVHlw\nZSwKICAgICAgICBpbnQgcnNDb25jdXIpCiAgICAgICAgdGhyb3dzIFNRTEV4\nY2VwdGlvbiB7CiAgICAgICAgcmV0dXJuIHByZXBhcmVDYWxsKGNvbm4sIG51\nbGwsIHJzVHlwZSwgcnNDb25jdXIpOwogICAgfQoKICAgIC8qKgogICAgICog\nQ3JlYXRlIGFuZCBwb3B1bGF0ZSB0aGUgcGFyYW1ldGVycyBvZiBhIHByZXBy\nZWQgc3RhdGVtZW50IHVzaW5nIHRoZQogICAgICogU1FMIGluIHRoaXMgYnVm\nZmVyIGFuZCB0aGUgZ2l2ZW4gZmV0Y2ggY29uZmlndXJhdGlvbi4KICAgICAq\nLwogICAgcHVibGljIENhbGxhYmxlU3RhdGVtZW50IHByZXBhcmVDYWxsKENv\nbm5lY3Rpb24gY29ubiwKICAgICAgICBKREJDRmV0Y2hDb25maWd1cmF0aW9u\nIGZldGNoLCBpbnQgcnNUeXBlLCBpbnQgcnNDb25jdXIpCiAgICAgICAgdGhy\nb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgaWYgKHJzVHlwZSA9PSAtMSAm\nJiBmZXRjaCA9PSBudWxsKQogICAgICAgICAgICByc1R5cGUgPSBSZXN1bHRT\nZXQuVFlQRV9GT1JXQVJEX09OTFk7CiAgICAgICAgZWxzZSBpZiAocnNUeXBl\nID09IC0xKQogICAgICAgICAgICByc1R5cGUgPSBmZXRjaC5nZXRSZXN1bHRT\nZXRUeXBlKCk7CiAgICAgICAgaWYgKHJzQ29uY3VyID09IC0xKQogICAgICAg\nICAgICByc0NvbmN1ciA9IFJlc3VsdFNldC5DT05DVVJfUkVBRF9PTkxZOwoK\nICAgICAgICBDYWxsYWJsZVN0YXRlbWVudCBzdG1udDsKICAgICAgICBpZiAo\ncnNUeXBlID09IFJlc3VsdFNldC5UWVBFX0ZPUldBUkRfT05MWQogICAgICAg\nICAgICAmJiByc0NvbmN1ciA9PSBSZXN1bHRTZXQuQ09OQ1VSX1JFQURfT05M\nWSkKICAgICAgICAgICAgc3RtbnQgPSBjb25uLnByZXBhcmVDYWxsKGdldFNR\nTCgpKTsKICAgICAgICBlbHNlCiAgICAgICAgICAgIHN0bW50ID0gY29ubi5w\ncmVwYXJlQ2FsbChnZXRTUUwoKSwgcnNUeXBlLCByc0NvbmN1cik7CiAgICAg\nICAgdHJ5IHsKICAgICAgICAgICAgc2V0UGFyYW1ldGVycyhzdG1udCk7CiAg\nICAgICAgICAgIGlmIChmZXRjaCAhPSBudWxsKSB7CiAgICAgICAgICAgICAg\nICBpZiAoZmV0Y2guZ2V0RmV0Y2hCYXRjaFNpemUoKSA+IDApCiAgICAgICAg\nICAgICAgICAgICAgc3RtbnQuc2V0RmV0Y2hTaXplKGZldGNoLmdldEZldGNo\nQmF0Y2hTaXplKCkpOwogICAgICAgICAgICAgICAgaWYgKHJzVHlwZSAhPSBS\nZXN1bHRTZXQuVFlQRV9GT1JXQVJEX09OTFkKICAgICAgICAgICAgICAgICAg\nICAmJiBmZXRjaC5nZXRGZXRjaERpcmVjdGlvbigpICE9IFJlc3VsdFNldC5G\nRVRDSF9GT1JXQVJEKQogICAgICAgICAgICAgICAgICAgIHN0bW50LnNldEZl\ndGNoRGlyZWN0aW9uKGZldGNoLmdldEZldGNoRGlyZWN0aW9uKCkpOwogICAg\nICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiBzdG1udDsKICAgICAgICB9\nIGNhdGNoIChTUUxFeGNlcHRpb24gc2UpIHsKICAgICAgICAgICAgdHJ5IHsK\nICAgICAgICAgICAgICAgIHN0bW50LmNsb3NlKCk7CiAgICAgICAgICAgIH0g\nY2F0Y2ggKFNRTEV4Y2VwdGlvbiBzZTIpIHsKICAgICAgICAgICAgfQogICAg\nICAgICAgICB0aHJvdyBzZTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAg\nICAgKiBQb3B1bGF0ZSB0aGUgcGFyYW1ldGVycyBvZiBhbiBleGlzdGluZyBQ\ncmVwYXJlZFN0YXRlbWVudAogICAgICogd2l0aCB2YWx1ZXMgZnJvbSB0aGlz\nIGJ1ZmZlci4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0UGFyYW1ldGVy\ncyhQcmVwYXJlZFN0YXRlbWVudCBwcykKICAgICAgICB0aHJvd3MgU1FMRXhj\nZXB0aW9uIHsKICAgICAgICBpZiAoX3BhcmFtcyA9PSBudWxsKQogICAgICAg\nICAgICByZXR1cm47CgogICAgICAgIENvbHVtbiBjb2w7CiAgICAgICAgZm9y\nIChpbnQgaSA9IDA7IGkgPCBfcGFyYW1zLnNpemUoKTsgaSsrKSB7CiAgICAg\nICAgICAgIGNvbCA9IChfY29scyA9PSBudWxsKSA/IG51bGwgOiAoQ29sdW1u\nKSBfY29scy5nZXQoaSk7CiAgICAgICAgICAgIF9kaWN0LnNldFVua25vd24o\ncHMsIGkgKyAxLCBfcGFyYW1zLmdldChpKSwgY29sKTsKICAgICAgICB9CiAg\nICB9CgogICAgcHVibGljIGludCBoYXNoQ29kZSgpIHsKICAgICAgICBpbnQg\naGFzaCA9IF9zcWwuaGFzaENvZGUoKTsKICAgICAgICByZXR1cm4gKF9wYXJh\nbXMgPT0gbnVsbCkgPyBoYXNoIDogaGFzaCBeIF9wYXJhbXMuaGFzaENvZGUo\nKTsKICAgIH0KCiAgICAvKioKICAgICAqIENvbXBhcmUgaW50ZXJuYWwgU1FM\nIHdpdGhvdXQgcmVzb2x2aW5nIHN1YnNlbGVjdHMgb3Igc3RyaW5naWZ5aW5n\nCiAgICAgKiBwYXJhbWV0ZXJzLgogICAgICovCiAgICBwdWJsaWMgYm9vbGVh\nbiBzcWxFcXVhbHMoU3RyaW5nIHNxbCkgewogICAgICAgIHJldHVybiBfc3Fs\nLnRvU3RyaW5nKCkuZXF1YWxzKHNxbCk7CiAgICB9CgogICAgcHVibGljIGJv\nb2xlYW4gZXF1YWxzKE9iamVjdCBvdGhlcikgewogICAgICAgIGlmIChvdGhl\nciA9PSB0aGlzKQogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICBp\nZiAoIShvdGhlciBpbnN0YW5jZW9mIFNRTEJ1ZmZlcikpCiAgICAgICAgICAg\nIHJldHVybiBmYWxzZTsKCiAgICAgICAgU1FMQnVmZmVyIGJ1ZiA9IChTUUxC\ndWZmZXIpIG90aGVyOwogICAgICAgIHJldHVybiBfc3FsLmVxdWFscyhidWYu\nX3NxbCkKICAgICAgICAgICAgJiYgT2JqZWN0VXRpbHMuZXF1YWxzKF9wYXJh\nbXMsIGJ1Zi5fcGFyYW1zKTsKICAgIH0KCiAgICAvKioKICAgICAqIFJlcGxh\nY2UgU1FMICc/JyB3aXRoIENBU1Qgc3RyaW5nIGlmIHJlcXVpcmVkIGJ5IERC\nIHBsYXRmb3JtCiAgICAgKiBAcGFyYW0gb3BlcgogICAgICogQHBhcmFtIHZh\nbAogICAgICovCiAgICBwdWJsaWMgdm9pZCBhZGRDYXN0Rm9yUGFyYW0oU3Ry\naW5nIG9wZXIsIFZhbCB2YWwpIHsKICAgICAgICBpZiAoX3NxbC5jaGFyQXQo\nX3NxbC5sZW5ndGgoKSAtIDEpID09ICc/JykgewogICAgICAgICAgICBTdHJp\nbmcgY2FzdFN0cmluZyA9IF9kaWN0LmFkZENhc3RBc1R5cGUob3BlciwgdmFs\nKTsKICAgICAgICAgICAgaWYgKGNhc3RTdHJpbmcgIT0gbnVsbCkKICAgICAg\nICAgICAgICAgIF9zcWwucmVwbGFjZShfc3FsLmxlbmd0aCgpIC0gMSwgX3Nx\nbC5sZW5ndGgoKSwgY2FzdFN0cmluZyk7CiAgICAgICAgfQogICAgfQoKICAg\nIC8qKgogICAgICogUmVwbGFjZSBjdXJyZW50IGJ1ZmZlciBzdHJpbmcgd2l0\naCB0aGUgbmV3IHN0cmluZwogICAgICogCiAgICAgKiBAcGFyYW0gc3RhcnQg\ncmVwbGFjZSBzdGFydCBwb3NpdGlvbgogICAgICogQHBhcmFtIGVuZCByZXBs\nYWNlIGVuZCBwb3NpdGlvbgogICAgICogQHBhcmFtIG5ld1N0cmluZwogICAg\nICovCiAgICBwdWJsaWMgdm9pZCByZXBsYWNlU3FsU3RyaW5nKGludCBzdGFy\ndCwgaW50IGVuZCwgU3RyaW5nIG5ld1N0cmluZykgewogICAgICAgIF9zcWwu\ncmVwbGFjZShzdGFydCwgZW5kLCBuZXdTdHJpbmcpOwogICAgfQogICAgCiAg\nICAvKioKICAgICAqIFJlcHJlc2VudHMgYSBzdWJzZWxlY3QuCiAgICAgKi8K\nICAgIHByaXZhdGUgc3RhdGljIGNsYXNzIFN1YnNlbGVjdCB7CgogICAgICAg\nIHB1YmxpYyBTZWxlY3Qgc2VsZWN0OwogICAgICAgIHB1YmxpYyBKREJDRmV0\nY2hDb25maWd1cmF0aW9uIGZldGNoOwogICAgICAgIHB1YmxpYyBib29sZWFu\nIGNvdW50OwogICAgICAgIHB1YmxpYyBpbnQgc3FsSW5kZXg7CiAgICAgICAg\ncHVibGljIGludCBwYXJhbUluZGV4OwoKICAgICAgICBwdWJsaWMgU3Vic2Vs\nZWN0IGNsb25lKGludCBzcWxJbmRleCwgaW50IHBhcmFtSW5kZXgpIHsKICAg\nICAgICAgICAgaWYgKHNxbEluZGV4ID09IDAgJiYgcGFyYW1JbmRleCA9PSAw\nKQogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXM7CgogICAgICAgICAgICBT\ndWJzZWxlY3Qgc3ViID0gbmV3IFN1YnNlbGVjdCgpOwogICAgICAgICAgICBz\ndWIuc2VsZWN0ID0gc2VsZWN0OwogICAgICAgICAgICBzdWIuZmV0Y2ggPSBm\nZXRjaDsKICAgICAgICAgICAgc3ViLmNvdW50ID0gY291bnQ7CiAgICAgICAg\nICAgIHN1Yi5zcWxJbmRleCA9IHRoaXMuc3FsSW5kZXggKyBzcWxJbmRleDsK\nICAgICAgICAgICAgc3ViLnBhcmFtSW5kZXggPSB0aGlzLnBhcmFtSW5kZXgg\nKyBwYXJhbUluZGV4OwogICAgICAgICAgICByZXR1cm4gc3ViOwogICAgICAg\nIH0KICAgIH0KICAgIAogICAgcHVibGljIHZvaWQgc2V0UGFyYW1ldGVycyhM\naXN0IHBhcmFtcykgewogICAgICAgIF9wYXJhbXMgPSBwYXJhbXM7CiAgICB9\nCiAgICAKICAgIHB1YmxpYyBMaXN0IGdldENvbHVtbnMoKSB7CiAgICAgICAg\ncmV0dXJuIF9jb2xzOwogICAgfQp9Cg==\n","encoding":"base64"}

