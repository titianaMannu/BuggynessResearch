{"sha":"a4e968dade96b105d9b6612e6c9603f294406d63","node_id":"MDQ6QmxvYjIwNjM2NDphNGU5NjhkYWRlOTZiMTA1ZDliNjYxMmU2Yzk2MDNmMjk0NDA2ZDYz","size":57678,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/a4e968dade96b105d9b6612e6c9603f294406d63","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuZW5oYW5jZTsKCmltcG9ydCBq\nYXZhLmlvLkZpbGU7CmltcG9ydCBqYXZhLmlvLkZpbGVXcml0ZXI7CmltcG9y\ndCBqYXZhLmlvLklPRXhjZXB0aW9uOwppbXBvcnQgamF2YS5pby5QcmludFdy\naXRlcjsKaW1wb3J0IGphdmEuaW8uV3JpdGVyOwppbXBvcnQgamF2YS5sYW5n\nLnJlZmxlY3QuTW9kaWZpZXI7CmltcG9ydCBqYXZhLnNlY3VyaXR5LkFjY2Vz\nc0NvbnRyb2xsZXI7CmltcG9ydCBqYXZhLnV0aWwuQXJyYXlMaXN0OwppbXBv\ncnQgamF2YS51dGlsLkFycmF5czsKaW1wb3J0IGphdmEudXRpbC5Db2xsZWN0\naW9uOwppbXBvcnQgamF2YS51dGlsLkRhdGU7CmltcG9ydCBqYXZhLnV0aWwu\nSGFzaFNldDsKaW1wb3J0IGphdmEudXRpbC5JdGVyYXRvcjsKaW1wb3J0IGph\ndmEudXRpbC5MaXN0OwppbXBvcnQgamF2YS51dGlsLk1hcDsKaW1wb3J0IGph\ndmEudXRpbC5TZXQ7CmltcG9ydCBqYXZhLnV0aWwuVHJlZVNldDsKCmltcG9y\ndCBvcmcuYXBhY2hlLmNvbW1vbnMubGFuZy5TdHJpbmdVdGlsczsKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5jb25mLk9wZW5KUEFDb25maWd1cmF0aW9u\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmNvbmYuT3BlbkpQQUNvbmZp\nZ3VyYXRpb25JbXBsOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi5j\nb25mLkNvbmZpZ3VyYXRpb247CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\nbGliLmNvbmYuQ29uZmlndXJhdGlvbnM7CmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEubGliLmxvZy5Mb2c7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\nbGliLm1ldGEuQ2xhc3NBcmdQYXJzZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEubGliLnV0aWwuQ29kZUZvcm1hdDsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS5saWIudXRpbC5GaWxlczsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5saWIudXRpbC5KMkRvUHJpdkhlbHBlcjsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5saWIudXRpbC5KYXZhVmVyc2lvbnM7CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuTG9jYWxpemVyOwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLmxpYi51dGlsLk9wdGlvbnM7CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEubWV0YS5DbGFzc01ldGFEYXRhOwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLm1ldGEuRGVsZWdhdGluZ01ldGFEYXRhRmFjdG9y\neTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRhLkZpZWxkTWV0YURh\ndGE7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YS5KYXZhVHlwZXM7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YS5NZXRhRGF0YUZhY3Rv\ncnk7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YS5NZXRhRGF0YVJl\ncG9zaXRvcnk7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5JbnZh\nbGlkU3RhdGVFeGNlcHRpb247CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\ndXRpbC5Vc2VyRXhjZXB0aW9uOwppbXBvcnQgc2VycC5ieXRlY29kZS5CQ0Ns\nYXNzOwppbXBvcnQgc2VycC5ieXRlY29kZS5CQ0NsYXNzTG9hZGVyOwppbXBv\ncnQgc2VycC5ieXRlY29kZS5Qcm9qZWN0OwppbXBvcnQgc2VycC51dGlsLlN0\ncmluZ3M7CgovKioKICogR2VuZXJhdGVzIGEgY2xhc3MgYXBwcm9wcmlhdGUg\nZm9yIHVzZSBhcyBhbiBhcHBsaWNhdGlvbiBpZGVudGl0eSBjbGFzcy4KICoK\nICogQGF1dGhvciBQYXRyaWNrIExpbnNrZXkKICogQGF1dGhvciBBYmUgV2hp\ndGUKICovCnB1YmxpYyBjbGFzcyBBcHBsaWNhdGlvbklkVG9vbCB7CgogICAg\ncHVibGljIHN0YXRpYyBmaW5hbCBTdHJpbmcgVE9LRU5fREVGQVVMVCA9ICI6\nOiI7CgogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgU3RyaW5nIFRPS0VOSVpF\nUl9DVVNUT00gPSAiVG9rZW5pemVyIjsKICAgIHByaXZhdGUgc3RhdGljIGZp\nbmFsIFN0cmluZyBUT0tFTklaRVJfU1REID0gIlN0cmluZ1Rva2VuaXplciI7\nCgogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgTG9jYWxpemVyIF9sb2MgPSBM\nb2NhbGl6ZXIuZm9yUGFja2FnZQogICAgICAgIChBcHBsaWNhdGlvbklkVG9v\nbC5jbGFzcyk7CgogICAgcHJpdmF0ZSBmaW5hbCBMb2cgX2xvZzsKICAgIHBy\naXZhdGUgZmluYWwgQ2xhc3MgX3R5cGU7CiAgICBwcml2YXRlIGZpbmFsIENs\nYXNzTWV0YURhdGEgX21ldGE7CiAgICBwcml2YXRlIGJvb2xlYW4gX2Fic3Ry\nYWN0ID0gZmFsc2U7CiAgICBwcml2YXRlIEZpZWxkTWV0YURhdGFbXSBfZmll\nbGRzID0gbnVsbDsKICAgIHByaXZhdGUgYm9vbGVhbiBfaWdub3JlID0gdHJ1\nZTsKICAgIHByaXZhdGUgRmlsZSBfZGlyID0gbnVsbDsKICAgIHByaXZhdGUg\nV3JpdGVyIF93cml0ZXIgPSBudWxsOwogICAgcHJpdmF0ZSBTdHJpbmcgX2Nv\nZGUgPSBudWxsOwogICAgcHJpdmF0ZSBTdHJpbmcgX3Rva2VuID0gVE9LRU5f\nREVGQVVMVDsKICAgIHByaXZhdGUgQ29kZUZvcm1hdCBfZm9ybWF0ID0gbnVs\nbDsKCiAgICAvKioKICAgICAqIENvbnN0cnVjdHMgYSBuZXcgQXBwbGljYXRp\nb25JZFRvb2wgY2FwYWJsZSBvZiBnZW5lcmF0aW5nIGFuCiAgICAgKiBvYmpl\nY3QgaWQgY2xhc3MgZm9yIDxjb2RlPnR5cGU8L2NvZGU+LgogICAgICovCiAg\nICBwdWJsaWMgQXBwbGljYXRpb25JZFRvb2woT3BlbkpQQUNvbmZpZ3VyYXRp\nb24gY29uZiwgQ2xhc3MgdHlwZSkgewogICAgICAgIF9sb2cgPSBjb25mLmdl\ndExvZyhPcGVuSlBBQ29uZmlndXJhdGlvbi5MT0dfRU5IQU5DRSk7CiAgICAg\nICAgX3R5cGUgPSB0eXBlOwoKICAgICAgICBNZXRhRGF0YVJlcG9zaXRvcnkg\ncmVwb3MgPSBjb25mLm5ld01ldGFEYXRhUmVwb3NpdG9yeUluc3RhbmNlKCk7\nCiAgICAgICAgcmVwb3Muc2V0VmFsaWRhdGUocmVwb3MuVkFMSURBVEVfTk9O\nRSk7CiAgICAgICAgcmVwb3Muc2V0U291cmNlTW9kZShyZXBvcy5NT0RFX01B\nUFBJTkcsIGZhbHNlKTsKICAgICAgICBsb2FkT2JqZWN0SWRzKHJlcG9zLCB0\ncnVlKTsKICAgICAgICBfbWV0YSA9IHJlcG9zLmdldE1ldGFEYXRhKHR5cGUs\nIG51bGwsIGZhbHNlKTsKICAgICAgICBpZiAoX21ldGEgIT0gbnVsbCkgewog\nICAgICAgICAgICBfYWJzdHJhY3QgPSBNb2RpZmllci5pc0Fic3RyYWN0KF9t\nZXRhLmdldERlc2NyaWJlZFR5cGUoKS4KICAgICAgICAgICAgICAgIGdldE1v\nZGlmaWVycygpKTsKICAgICAgICAgICAgX2ZpZWxkcyA9IGdldERlY2xhcmVk\nUHJpbWFyeUtleUZpZWxkcyhfbWV0YSk7CiAgICAgICAgfQogICAgfQoKICAg\nIC8qKgogICAgICogQ29uc3RydWN0cyBhIG5ldyB0b29sIGluc3RhbmNlIGNh\ncGFibGUgb2YgZ2VuZXJhdGluZyBhbgogICAgICogb2JqZWN0IGlkIGNsYXNz\nIGZvciA8Y29kZT5tZXRhPC9jb2RlPi4KICAgICAqLwogICAgcHVibGljIEFw\ncGxpY2F0aW9uSWRUb29sKE9wZW5KUEFDb25maWd1cmF0aW9uIGNvbmYsIENs\nYXNzIHR5cGUsCiAgICAgICAgQ2xhc3NNZXRhRGF0YSBtZXRhKSB7CiAgICAg\nICAgX2xvZyA9IGNvbmYuZ2V0TG9nKE9wZW5KUEFDb25maWd1cmF0aW9uLkxP\nR19FTkhBTkNFKTsKCiAgICAgICAgX3R5cGUgPSB0eXBlOwogICAgICAgIF9t\nZXRhID0gbWV0YTsKICAgICAgICBpZiAoX21ldGEgIT0gbnVsbCkgewogICAg\nICAgICAgICBfYWJzdHJhY3QgPSBNb2RpZmllci5pc0Fic3RyYWN0KF9tZXRh\nLmdldERlc2NyaWJlZFR5cGUoKS4KICAgICAgICAgICAgICAgIGdldE1vZGlm\naWVycygpKTsKICAgICAgICAgICAgX2ZpZWxkcyA9IGdldERlY2xhcmVkUHJp\nbWFyeUtleUZpZWxkcyhfbWV0YSk7CiAgICAgICAgfQogICAgfQoKICAgIC8q\nKgogICAgICogUmV0dXJuIG1ldGFkYXRhIGZvciBwcmltYXJ5IGtleSBmaWVs\nZHMgZGVjbGFyZWQgaW4gdGhlIGdpdmVuIGNsYXNzLgogICAgICovCiAgICBw\ncml2YXRlIHN0YXRpYyBGaWVsZE1ldGFEYXRhW10gZ2V0RGVjbGFyZWRQcmlt\nYXJ5S2V5RmllbGRzCiAgICAgICAgKENsYXNzTWV0YURhdGEgbWV0YSkgewog\nICAgICAgIGlmIChtZXRhLmdldFBDU3VwZXJjbGFzcygpID09IG51bGwpCiAg\nICAgICAgICAgIHJldHVybiBtZXRhLmdldFByaW1hcnlLZXlGaWVsZHMoKTsK\nCiAgICAgICAgLy8gcmVtb3ZlIHRoZSBwcmltYXJ5IGtleSBmaWVsZHMgdGhh\ndCBhcmUgbm90IGRlY2xhcmVkCiAgICAgICAgLy8gaW4gdGhlIGN1cnJlbnQg\nY2xhc3MKICAgICAgICBGaWVsZE1ldGFEYXRhW10gZmllbGRzID0gbWV0YS5n\nZXRQcmltYXJ5S2V5RmllbGRzKCk7CiAgICAgICAgTGlzdCBkZWNzID0gbmV3\nIEFycmF5TGlzdChmaWVsZHMubGVuZ3RoKTsKICAgICAgICBmb3IgKGludCBp\nID0gMDsgaSA8IGZpZWxkcy5sZW5ndGg7IGkrKykKICAgICAgICAgICAgaWYg\nKGZpZWxkc1tpXS5nZXREZWNsYXJpbmdUeXBlKCkgPT0gbWV0YS5nZXREZXNj\ncmliZWRUeXBlKCkpCiAgICAgICAgICAgICAgICBkZWNzLmFkZChmaWVsZHNb\naV0pOwogICAgICAgIHJldHVybiAoRmllbGRNZXRhRGF0YVtdKSBkZWNzLnRv\nQXJyYXkobmV3IEZpZWxkTWV0YURhdGFbZGVjcy5zaXplKCldKTsKICAgIH0K\nCiAgICAvKioKICAgICAqIFJldHVybiBmYWxzZSBpZiB0aGlzIHRvb2wgaXMg\nY29uZmlndXJlZCB0byB0aHJvdyBhbiBleGNlcHRpb24gb24KICAgICAqIGFu\nIGF0dGVtcHQgdG8gZ2VuZXJhdGUgYW4gaWQgY2xhc3MgZm9yIGEgdHlwZSB0\naGF0IGRvZXMgbm90IHVzZQogICAgICogYXBwbGljYXRpb24gaWRlbnRpdHku\nCiAgICAgKi8KICAgIHB1YmxpYyBib29sZWFuIGdldElnbm9yZUVycm9ycygp\nIHsKICAgICAgICByZXR1cm4gX2lnbm9yZTsKICAgIH0KCiAgICAvKioKICAg\nICAqIFNldCB0byBmYWxzZSBpZiB0aGlzIHRvb2wgc2hvdWxkIHRocm93IGFu\nIGV4Y2VwdGlvbiBvbgogICAgICogYW4gYXR0ZW1wdCB0byBnZW5lcmF0ZSBh\nbiBpZCBjbGFzcyBmb3IgYSB0eXBlIHRoYXQgZG9lcyBub3QgdXNlCiAgICAg\nKiBhcHBsaWNhdGlvbiBpZGVudGl0eS4KICAgICAqLwogICAgcHVibGljIHZv\naWQgc2V0SWdub3JlRXJyb3JzKGJvb2xlYW4gaWdub3JlKSB7CiAgICAgICAg\nX2lnbm9yZSA9IGlnbm9yZTsKICAgIH0KCiAgICAvKioKICAgICAqIFRoZSBj\nb2RlIGZvcm1hdHRlciBmb3IgdGhlIGdlbmVyYXRlZCBKYXZhIGNvZGUuCiAg\nICAgKi8KICAgIHB1YmxpYyBDb2RlRm9ybWF0IGdldENvZGVGb3JtYXQoKSB7\nCiAgICAgICAgcmV0dXJuIF9mb3JtYXQ7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBTZXQgdGhlIGNvZGUgZm9ybWF0dGVyIGZvciB0aGUgZ2VuZXJhdGVkIEph\ndmEgY29kZS4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0Q29kZUZvcm1h\ndChDb2RlRm9ybWF0IGZvcm1hdCkgewogICAgICAgIF9mb3JtYXQgPSBmb3Jt\nYXQ7CiAgICB9CgogICAgLyoqCiAgICAgKiBUaGUgZGlyZWN0b3J5IHRvIHdy\naXRlIHNvdXJjZSB0by4gRGVmYXVsdHMgdG8gdGhlIGRpcmVjdG9yeQogICAg\nICogb2YgdGhlIEphdmEgZmlsZSBmb3IgdGhlIHNldCB0eXBlLiBJZiB0aGUg\nZ2l2ZW4gZGlyZWN0b3J5IGRvZXMgbm90CiAgICAgKiBtYXRjaCB0aGUgcGFj\na2FnZSBvZiB0aGUgb2JqZWN0IGlkLCB0aGUgcGFja2FnZSBzdHJ1Y3R1cmUg\nd2lsbCBiZQogICAgICogY3JlYXRlZCBiZWxvdyB0aGUgZGlyZWN0b3J5Lgog\nICAgICovCiAgICBwdWJsaWMgRmlsZSBnZXREaXJlY3RvcnkoKSB7CiAgICAg\nICAgcmV0dXJuIF9kaXI7CiAgICB9CgogICAgLyoqCiAgICAgKiBUaGUgZGly\nZWN0b3J5IHRvIHdyaXRlIHNvdXJjZSB0by4gRGVmYXVsdHMgdG8gdGhlIGRp\ncmVjdG9yeQogICAgICogb2YgdGhlIEphdmEgZmlsZSBmb3IgdGhlIHNldCB0\neXBlLiBJZiB0aGUgZ2l2ZW4gZGlyZWN0b3J5IGRvZXMgbm90CiAgICAgKiBt\nYXRjaCB0aGUgcGFja2FnZSBvZiB0aGUgb2JqZWN0IGlkLCB0aGUgcGFja2Fn\nZSBzdHJ1Y3R1cmUgd2lsbCBiZQogICAgICogY3JlYXRlZCBiZWxvdyB0aGUg\nZGlyZWN0b3J5LgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXREaXJlY3Rv\ncnkoRmlsZSBkaXIpIHsKICAgICAgICBfZGlyID0gZGlyOwogICAgfQoKICAg\nIC8qKgogICAgICogVGhlIHRva2VuIHRvIHVzZSB0byBzZXBhcmF0ZSBzdHJp\nbmdpZmllZCBwcmltYXJ5IGtleSBmaWVsZCB2YWx1ZXMuCiAgICAgKi8KICAg\nIHB1YmxpYyBTdHJpbmcgZ2V0VG9rZW4oKSB7CiAgICAgICAgcmV0dXJuIF90\nb2tlbjsKICAgIH0KCiAgICAvKioKICAgICAqIFRoZSB0b2tlbiB0byB1c2Ug\ndG8gc2VwYXJhdGUgc3RyaW5naWZpZWQgcHJpbWFyeSBrZXkgZmllbGQgdmFs\ndWVzLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRUb2tlbihTdHJpbmcg\ndG9rZW4pIHsKICAgICAgICBfdG9rZW4gPSB0b2tlbjsKICAgIH0KCiAgICAv\nKioKICAgICAqIFRoZSB3cml0ZXIgdG8gd3JpdGUgc291cmNlIHRvLCBvciBu\ndWxsIHRvIHdyaXRlIHRvIGRlZmF1bHQgZmlsZS4KICAgICAqLwogICAgcHVi\nbGljIFdyaXRlciBnZXRXcml0ZXIoKSB7CiAgICAgICAgcmV0dXJuIF93cml0\nZXI7CiAgICB9CgogICAgLyoqCiAgICAgKiBUaGUgd3JpdGVyIHRvIHdyaXRl\nIHNvdXJjZSB0bywgb3IgbnVsbCB0byB3cml0ZSB0byBkZWZhdWx0IGZpbGUu\nCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldFdyaXRlcihXcml0ZXIgd3Jp\ndGVyKSB7CiAgICAgICAgX3dyaXRlciA9IHdyaXRlcjsKICAgIH0KCiAgICAv\nKioKICAgICAqIFJldHVybiB0aGUgdHlwZSB3ZSBhcmUgZ2VuZXJhdGluZyBh\nbiBhcHBsaWNhdGlvbiBpZCBmb3IuCiAgICAgKi8KICAgIHB1YmxpYyBDbGFz\ncyBnZXRUeXBlKCkgewogICAgICAgIHJldHVybiBfdHlwZTsKICAgIH0KCiAg\nICAvKioKICAgICAqIFJldHVybiBtZXRhZGF0YSBmb3IgdGhlIHR5cGUgd2Ug\nYXJlIGdlbmVyYXRpbmcgYW4gYXBwbGljYXRpb24gaWQgZm9yLgogICAgICov\nCiAgICBwdWJsaWMgQ2xhc3NNZXRhRGF0YSBnZXRNZXRhRGF0YSgpIHsKICAg\nICAgICByZXR1cm4gX21ldGE7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1\ncm4gdGhlIGNvZGUgZ2VuZXJhdGVkIGZvciB0aGUgYXBwbGljYXRpb24gaWQs\nIG9yIG51bGwKICAgICAqIGlmIGludmFsaWQgY2xhc3Mgb3IgdGhlIHtAbGlu\nayAjcnVufSBtZXRob2QgaGFzIG5vdCBiZWVuIGNhbGxlZC4KICAgICAqLwog\nICAgcHVibGljIFN0cmluZyBnZXRDb2RlKCkgewogICAgICAgIHJldHVybiBf\nY29kZTsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybnMgdHJ1ZSBpZiB0\naGUgYXBwbGljYXRpb24gaWRlbnRpdHkgY2xhc3Mgc2hvdWxkIGJlIGFuIGlu\nbmVyIGNsYXNzLgogICAgICovCiAgICBwdWJsaWMgYm9vbGVhbiBpc0lubmVy\nQ2xhc3MoKSB7CiAgICAgICAgQ2xhc3Mgb2lkQ2xhc3MgPSBfbWV0YS5nZXRP\nYmplY3RJZFR5cGUoKTsKICAgICAgICByZXR1cm4gb2lkQ2xhc3MuZ2V0TmFt\nZSgpLmluZGV4T2YoJyQnKSAhPSAtMTsKICAgIH0KCiAgICAvKioKICAgICAq\nIFJldHVybnMgdGhlIHNob3J0IGNsYXNzIG5hbWUgZm9yIHRoZSBvYmplY3Qg\naWQgY2xhc3MuCiAgICAgKi8KICAgIHByaXZhdGUgU3RyaW5nIGdldENsYXNz\nTmFtZSgpIHsKICAgICAgICBpZiAoX21ldGEuaXNPcGVuSlBBSWRlbnRpdHko\nKSkKICAgICAgICAgICAgcmV0dXJuIG51bGw7CgogICAgICAgIC8vIGNvbnZl\ncnQgZnJvbSBTb21lQ2xhc3MkSUQgdG8gSUQKICAgICAgICBTdHJpbmcgY2xh\nc3NOYW1lID0gU3RyaW5ncy5nZXRDbGFzc05hbWUoX21ldGEuZ2V0T2JqZWN0\nSWRUeXBlKCkpOwogICAgICAgIGlmIChpc0lubmVyQ2xhc3MoKSkKICAgICAg\nICAgICAgY2xhc3NOYW1lID0gY2xhc3NOYW1lLnN1YnN0cmluZyhjbGFzc05h\nbWUubGFzdEluZGV4T2YoJyQnKSArIDEpOwogICAgICAgIHJldHVybiBjbGFz\nc05hbWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBHZW5lcmF0ZXMgdGhlIHNv\ndXJjZWNvZGUgZm9yIHRoZSBhcHBsaWNhdGlvbiBpZCBjbGFzczsgcmV0dXJu\ncwogICAgICogZmFsc2UgaWYgdGhlIGNsYXNzIGlzIGludmFsaWQuCiAgICAg\nKi8KICAgIHB1YmxpYyBib29sZWFuIHJ1bigpIHsKICAgICAgICBpZiAoX2xv\nZy5pc0luZm9FbmFibGVkKCkpCiAgICAgICAgICAgIF9sb2cuaW5mbyhfbG9j\nLmdldCgiYXBwaWQtc3RhcnQiLCBfdHlwZSkpOwoKICAgICAgICAvLyBlbnN1\ncmUgdGhhdCB0aGlzIHR5cGUgaXMgYSBjYW5kaWRhdGUgZm9yIGFwcGxpY2F0\naW9uIGlkZW50aXR5CiAgICAgICAgaWYgKF9tZXRhID09IG51bGwKICAgICAg\nICAgICAgfHwgX21ldGEuZ2V0SWRlbnRpdHlUeXBlKCkgIT0gQ2xhc3NNZXRh\nRGF0YS5JRF9BUFBMSUNBVElPTgogICAgICAgICAgICB8fCBfbWV0YS5pc09w\nZW5KUEFJZGVudGl0eSgpKSB7CiAgICAgICAgICAgIGlmICghX2lnbm9yZSkK\nICAgICAgICAgICAgICAgIHRocm93IG5ldyBVc2VyRXhjZXB0aW9uKF9sb2Mu\nZ2V0KCJhcHBpZC1pbnZhbGlkIiwgX3R5cGUpKTsKCiAgICAgICAgICAgIC8v\nIGVsc2UganVzdCB3YXJuCiAgICAgICAgICAgIGlmIChfbG9nLmlzV2FybkVu\nYWJsZWQoKSkKICAgICAgICAgICAgICAgIF9sb2cud2FybihfbG9jLmdldCgi\nYXBwaWQtd2FybiIsIF90eXBlKSk7CiAgICAgICAgICAgIHJldHVybiBmYWxz\nZTsKICAgICAgICB9CgogICAgICAgIENsYXNzIG9pZENsYXNzID0gX21ldGEu\nZ2V0T2JqZWN0SWRUeXBlKCk7CiAgICAgICAgQ2xhc3Mgc3VwZXJPaWRDbGFz\ncyA9IG51bGw7CgogICAgICAgIC8vIGFsbG93IGRpZmYgb2lkIGNsYXNzIGlu\nIHN1YmNsYXNzIChob3Jpem9udGFsKQogICAgICAgIGlmIChfbWV0YS5nZXRQ\nQ1N1cGVyY2xhc3MoKSAhPSBudWxsKSB7CiAgICAgICAgICAgIHN1cGVyT2lk\nQ2xhc3MgPSBfbWV0YS5nZXRQQ1N1cGVyY2xhc3NNZXRhRGF0YSgpLmdldE9i\namVjdElkVHlwZSgpOwogICAgICAgICAgICBpZiAob2lkQ2xhc3MgPT0gbnVs\nbCB8fCBvaWRDbGFzcy5lcXVhbHMoc3VwZXJPaWRDbGFzcykpIHsKICAgICAg\nICAgICAgICAgIC8vIGp1c3Qgd2FybgogICAgICAgICAgICAgICAgaWYgKF9s\nb2cuaXNXYXJuRW5hYmxlZCgpKQogICAgICAgICAgICAgICAgICAgIF9sb2cu\nd2FybihfbG9jLmdldCgiYXBwaWQtd2FybiIsIF90eXBlKSk7CiAgICAgICAg\nICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgIH0KICAgICAgICB9\nCgogICAgICAgIC8vIGVuc3VyZSB0aGF0IGFuIGlkIGNsYXNzIGlzIGRlY2xh\ncmVkCiAgICAgICAgaWYgKG9pZENsYXNzID09IG51bGwpCiAgICAgICAgICAg\nIHRocm93IG5ldyBVc2VyRXhjZXB0aW9uKF9sb2MuZ2V0KCJuby1pZC1jbGFz\ncyIsIF90eXBlKSkuCiAgICAgICAgICAgICAgICBzZXRGYXRhbCh0cnVlKTsK\nCiAgICAgICAgLy8gZW5zdXJlIHRoZXJlIGlzIGF0IGxlYXN0IG9uZSBwayBm\naWVsZCBpZiB3ZSBhcmUKICAgICAgICAvLyBub24tYWJzcmFjdCwgYW5kIHNl\nZSBpZiB3ZSBoYXZlIGFueSBieXRlW10KICAgICAgICBib29sZWFuIGJ5dGVz\nID0gZmFsc2U7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7ICFieXRlcyAmJiBp\nIDwgX2ZpZWxkcy5sZW5ndGg7IGkrKykKICAgICAgICAgICAgYnl0ZXMgPSBf\nZmllbGRzW2ldLmdldERlY2xhcmVkVHlwZSgpID09IGJ5dGVbXS5jbGFzczsK\nCiAgICAgICAgLy8gY29sbGVjdCBpbmZvIG9uIGlkIHR5cGUKICAgICAgICBT\ndHJpbmcgY2xhc3NOYW1lID0gZ2V0Q2xhc3NOYW1lKCk7CiAgICAgICAgU3Ry\naW5nIHBhY2thZ2VOYW1lID0gU3RyaW5ncy5nZXRQYWNrYWdlTmFtZShvaWRD\nbGFzcyk7CiAgICAgICAgU3RyaW5nIHBhY2thZ2VEZWMgPSAiIjsKICAgICAg\nICBpZiAocGFja2FnZU5hbWUubGVuZ3RoKCkgPiAwKQogICAgICAgICAgICBw\nYWNrYWdlRGVjID0gInBhY2thZ2UgIiArIHBhY2thZ2VOYW1lICsgIjsiOwoK\nICAgICAgICBTdHJpbmcgaW1wb3J0cyA9IGdldEltcG9ydHMoKTsKICAgICAg\nICBTdHJpbmcgZmllbGREZWNzID0gZ2V0RmllbGREZWNsYXJhdGlvbnMoKTsK\nICAgICAgICBTdHJpbmcgY29uc3RydWN0b3IgPSBnZXRDb25zdHJ1Y3Rvcihz\ndXBlck9pZENsYXNzICE9IG51bGwpOwogICAgICAgIFN0cmluZyBwcm9wZXJ0\naWVzID0gZ2V0UHJvcGVydGllcygpOwogICAgICAgIFN0cmluZyBmcm9tU3Ry\naW5nQ29kZSA9IGdldEZyb21TdHJpbmdDb2RlKHN1cGVyT2lkQ2xhc3MgIT0g\nbnVsbCk7CiAgICAgICAgU3RyaW5nIHRvU3RyaW5nQ29kZSA9IGdldFRvU3Ry\naW5nQ29kZShzdXBlck9pZENsYXNzICE9IG51bGwpOwogICAgICAgIFN0cmlu\nZyBlcXVhbHNDb2RlID0gZ2V0RXF1YWxzQ29kZShzdXBlck9pZENsYXNzICE9\nIG51bGwpOwogICAgICAgIFN0cmluZyBoYXNoQ29kZUNvZGUgPSBnZXRIYXNo\nQ29kZUNvZGUoc3VwZXJPaWRDbGFzcyAhPSBudWxsKTsKCiAgICAgICAgLy8g\nYnVpbGQgdGhlIGphdmEgY29kZQogICAgICAgIENvZGVGb3JtYXQgY29kZSA9\nIG5ld0NvZGVGb3JtYXQoKTsKICAgICAgICBpZiAoIWlzSW5uZXJDbGFzcygp\nICYmIHBhY2thZ2VEZWMubGVuZ3RoKCkgPiAwKQogICAgICAgICAgICBjb2Rl\nLmFwcGVuZChwYWNrYWdlRGVjKS5hZnRlclNlY3Rpb24oKTsKCiAgICAgICAg\naWYgKCFpc0lubmVyQ2xhc3MoKSAmJiBpbXBvcnRzLmxlbmd0aCgpID4gMCkK\nICAgICAgICAgICAgY29kZS5hcHBlbmQoaW1wb3J0cykuYWZ0ZXJTZWN0aW9u\nKCk7CgogICAgICAgIGNvZGUuYXBwZW5kKCIvKioiKS5lbmRsKCkuCiAgICAg\nICAgICAgIGFwcGVuZCgiICogIikuCiAgICAgICAgICAgIGFwcGVuZChfbG9j\nLmdldCgiYXBwaWQtY29tbWVudC1mb3IiLCBfdHlwZS5nZXROYW1lKCkpKS4K\nICAgICAgICAgICAgZW5kbCgpLgogICAgICAgICAgICBhcHBlbmQoIiAqIiku\nZW5kbCgpLgogICAgICAgICAgICBhcHBlbmQoIiAqICIpLmFwcGVuZChfbG9j\nLmdldCgiYXBwaWQtY29tbWVudC1nZW4iKSkuZW5kbCgpLgogICAgICAgICAg\nICBhcHBlbmQoIiAqICIpLmFwcGVuZChnZXRDbGFzcygpLmdldE5hbWUoKSku\nZW5kbCgpLgogICAgICAgICAgICBhcHBlbmQoIiAqLyIpLmVuZGwoKTsKICAg\nICAgICBjb2RlLmFwcGVuZCgicHVibGljICIpOwogICAgICAgIGlmIChpc0lu\nbmVyQ2xhc3MoKSkKICAgICAgICAgICAgY29kZS5hcHBlbmQoInN0YXRpYyAi\nKTsKICAgICAgICBjb2RlLmFwcGVuZCgiY2xhc3MgIikuYXBwZW5kKGNsYXNz\nTmFtZSk7CiAgICAgICAgaWYgKGNvZGUuZ2V0QnJhY2VPblNhbWVMaW5lKCkp\nCiAgICAgICAgICAgIGNvZGUuYXBwZW5kKCIgIik7CiAgICAgICAgZWxzZQog\nICAgICAgICAgICBjb2RlLmVuZGwoKS50YWIoKTsKCiAgICAgICAgaWYgKHN1\ncGVyT2lkQ2xhc3MgIT0gbnVsbCkgewogICAgICAgICAgICBjb2RlLmFwcGVu\nZCgiZXh0ZW5kcyAiICsgU3RyaW5ncy5nZXRDbGFzc05hbWUoc3VwZXJPaWRD\nbGFzcykpOwogICAgICAgICAgICBpZiAoY29kZS5nZXRCcmFjZU9uU2FtZUxp\nbmUoKSkKICAgICAgICAgICAgICAgIGNvZGUuYXBwZW5kKCIgIik7CiAgICAg\nICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIGNvZGUuZW5kbCgpLnRhYigp\nOwogICAgICAgIH0KICAgICAgICBjb2RlLmFwcGVuZCgiaW1wbGVtZW50cyBT\nZXJpYWxpemFibGUiKS5vcGVuQnJhY2UoMSkuZW5kbCgpOwoKICAgICAgICAv\nLyBpZiB3ZSB1c2UgYSBieXRlIGFycmF5IHdlIG5lZWQgYSBzdGF0aWMgYXJy\nYXkgZm9yIGVuY29kaW5nIHRvIHN0cmluZwogICAgICAgIGlmIChieXRlcykg\newogICAgICAgICAgICBjb2RlLnRhYigpLmFwcGVuZCgicHJpdmF0ZSBzdGF0\naWMgZmluYWwgY2hhcltdIEhFWCA9ICIpLgogICAgICAgICAgICAgICAgYXBw\nZW5kKCJuZXcgY2hhcltdIHsiKS5lbmRsKCk7CiAgICAgICAgICAgIGNvZGUu\ndGFiKDIpLmFwcGVuZCgiJzAnLCAnMScsICcyJywgJzMnLCAnNCcsICc1Jywg\nJzYnLCAnNycsIikuCiAgICAgICAgICAgICAgICBlbmRsKCk7CiAgICAgICAg\nICAgIGNvZGUudGFiKDIpLmFwcGVuZCgiJzgnLCAnOScsICdBJywgJ0InLCAn\nQycsICdEJywgJ0UnLCAnRiciKS4KICAgICAgICAgICAgICAgIGVuZGwoKTsK\nICAgICAgICAgICAgY29kZS50YWIoKS5hcHBlbmQoIn07IikuZW5kbCgyKTsK\nICAgICAgICB9CgogICAgICAgIC8vIHN0YXRpYyBibG9jayB0byByZWdpc3Rl\nciBjbGFzcwogICAgICAgIGNvZGUudGFiKCkuYXBwZW5kKCJzdGF0aWMiKS5v\ncGVuQnJhY2UoMikuZW5kbCgpOwogICAgICAgIGNvZGUudGFiKDIpLmFwcGVu\nZCgiLy8gcmVnaXN0ZXIgcGVyc2lzdGVudCBjbGFzcyBpbiBKVk0iKS5lbmRs\nKCk7CiAgICAgICAgaWYgKEphdmFWZXJzaW9ucy5WRVJTSU9OID49IDUpIHsK\nICAgICAgICAgICAgY29kZS50YWIoMikuYXBwZW5kKCJ0cnkgeyBDbGFzcy5m\nb3JOYW1lIikub3BlblBhcmVuKHRydWUpLgogICAgICAgICAgICAgICAgYXBw\nZW5kKCJcIiIpLmFwcGVuZChfdHlwZS5nZXROYW1lKCkpLmFwcGVuZCgiXCIi\nKS4KICAgICAgICAgICAgICAgIGNsb3NlUGFyZW4oKS5hcHBlbmQoIjsiKS5h\ncHBlbmQoIiB9IikuZW5kbCgpOwogICAgICAgICAgICBjb2RlLnRhYigyKS5h\ncHBlbmQoImNhdGNoIikub3BlblBhcmVuKHRydWUpLgogICAgICAgICAgICAg\nICAgYXBwZW5kKCJFeGNlcHRpb24gZSIpLmNsb3NlUGFyZW4oKS5hcHBlbmQo\nIiB7fSIpLmVuZGwoKTsKICAgICAgICB9IGVsc2UKICAgICAgICAgICAgY29k\nZS50YWIoMikuYXBwZW5kKCJDbGFzcyBjID0gIikuYXBwZW5kKF90eXBlLmdl\ndE5hbWUoKSkuCiAgICAgICAgICAgICAgICBhcHBlbmQoIi5jbGFzczsiKS5l\nbmRsKCk7CiAgICAgICAgY29kZS5jbG9zZUJyYWNlKDIpOwoKICAgICAgICAv\nLyBmaWVsZCBkZWNsYXJhdGlvbnMKICAgICAgICBpZiAoZmllbGREZWNzLmxl\nbmd0aCgpID4gMCkKICAgICAgICAgICAgY29kZS5lbmRsKDIpLmFwcGVuZChm\naWVsZERlY3MpOwoKICAgICAgICAvLyBkZWZhdWx0IGNvbnN0cnVjdG9yCiAg\nICAgICAgY29kZS5hZnRlclNlY3Rpb24oKS50YWIoKS5hcHBlbmQoInB1Ymxp\nYyAiKS5hcHBlbmQoY2xhc3NOYW1lKS4KICAgICAgICAgICAgcGFyZW5zKCku\nb3BlbkJyYWNlKDIpLmVuZGwoKTsKICAgICAgICBjb2RlLmNsb3NlQnJhY2Uo\nMik7CgogICAgICAgIC8vIHN0cmluZyBjb25zdHJ1Y3RvcgogICAgICAgIGNv\nZGUuYWZ0ZXJTZWN0aW9uKCkuYXBwZW5kKGNvbnN0cnVjdG9yKTsKCiAgICAg\nICAgLy8gcHJvcGVydGllcwogICAgICAgIGlmIChwcm9wZXJ0aWVzLmxlbmd0\naCgpID4gMCkKICAgICAgICAgICAgY29kZS5hZnRlclNlY3Rpb24oKS5hcHBl\nbmQocHJvcGVydGllcyk7CgogICAgICAgIC8vIHRvU3RyaW5nLCBlcXVhbHMs\nIGhhc2hDb2RlIG1ldGhvZHMKICAgICAgICBpZiAodG9TdHJpbmdDb2RlLmxl\nbmd0aCgpID4gMCkKICAgICAgICAgICAgY29kZS5hZnRlclNlY3Rpb24oKS5h\ncHBlbmQodG9TdHJpbmdDb2RlKTsKICAgICAgICBpZiAoaGFzaENvZGVDb2Rl\nLmxlbmd0aCgpID4gMCkKICAgICAgICAgICAgY29kZS5hZnRlclNlY3Rpb24o\nKS5hcHBlbmQoaGFzaENvZGVDb2RlKTsKICAgICAgICBpZiAoZXF1YWxzQ29k\nZS5sZW5ndGgoKSA+IDApCiAgICAgICAgICAgIGNvZGUuYWZ0ZXJTZWN0aW9u\nKCkuYXBwZW5kKGVxdWFsc0NvZGUpOwogICAgICAgIGlmIChmcm9tU3RyaW5n\nQ29kZS5sZW5ndGgoKSA+IDApCiAgICAgICAgICAgIGNvZGUuYWZ0ZXJTZWN0\naW9uKCkuYXBwZW5kKGZyb21TdHJpbmdDb2RlKTsKCiAgICAgICAgLy8gaWYg\nd2UgaGF2ZSBhbnkgYnl0ZSBhcnJheSBmaWVsZHMsIHdlIGhhdmUgdG8gYWRk\nIHRoZSBleHRyYQogICAgICAgIC8vIG1ldGhvZHMgZm9yIGhhbmRsaW5nIGJ5\ndGUgYXJyYXlzCiAgICAgICAgaWYgKGJ5dGVzKSB7CiAgICAgICAgICAgIGNv\nZGUuYWZ0ZXJTZWN0aW9uKCkuYXBwZW5kKGdldFRvQnl0ZXNCeXRlQXJyYXlD\nb2RlKCkpOwogICAgICAgICAgICBjb2RlLmFmdGVyU2VjdGlvbigpLmFwcGVu\nZChnZXRUb1N0cmluZ0J5dGVBcnJheUNvZGUoKSk7CiAgICAgICAgICAgIGNv\nZGUuYWZ0ZXJTZWN0aW9uKCkuYXBwZW5kKGdldEVxdWFsc0J5dGVBcnJheUNv\nZGUoKSk7CiAgICAgICAgICAgIGNvZGUuYWZ0ZXJTZWN0aW9uKCkuYXBwZW5k\nKGdldEhhc2hDb2RlQnl0ZUFycmF5Q29kZSgpKTsKICAgICAgICB9CgogICAg\nICAgIC8vIGJhc2UgY2xhc3NlcyBtaWdodCBuZWVkIHRvIGRlZmluZSBhIGN1\nc3RvbSB0b2tlbml6ZXIKICAgICAgICBpZiAoc3VwZXJPaWRDbGFzcyA9PSBu\ndWxsICYmIGdldFRva2VuaXplcihmYWxzZSkgPT0gVE9LRU5JWkVSX0NVU1RP\nTSkKICAgICAgICAgICAgY29kZS5hZnRlclNlY3Rpb24oKS5hcHBlbmQoZ2V0\nQ3VzdG9tVG9rZW5pemVyQ2xhc3MoKSk7CgogICAgICAgIGNvZGUuZW5kbCgp\nOwogICAgICAgIGNvZGUuY2xvc2VCcmFjZSgxKTsKCiAgICAgICAgX2NvZGUg\nPSBjb2RlLnRvU3RyaW5nKCk7CgogICAgICAgIC8vIGlmIHRoaXMgaXMgYW4g\naW5uZXIgY2xhc3MsIHRoZW4gaW5kZW50IHRoZSBlbnRpcmUKICAgICAgICAv\nLyBjb2RlIHVuaXQgb25lIHRhYiBsZXZlbAogICAgICAgIGlmIChpc0lubmVy\nQ2xhc3MoKSkgewogICAgICAgICAgICAvLyBpbmRlbnQgdGhlIGVudGlyZSBj\nb2RlIGJsb2NrIG9uZSBsZXZlbCB0byBtYWtlIGl0CiAgICAgICAgICAgIC8v\nIGEgcHJvcGVydGx5IGluZGVudGVkIGlubmRlciBjbGFzcwogICAgICAgICAg\nICBfY29kZSA9IGNvZGUuZ2V0VGFiKCkgKyBTdHJpbmdzLnJlcGxhY2UoX2Nv\nZGUsCiAgICAgICAgICAgICAgICBKMkRvUHJpdkhlbHBlci5nZXRMaW5lU2Vw\nYXJhdG9yKCksCiAgICAgICAgICAgICAgICBKMkRvUHJpdkhlbHBlci5nZXRM\naW5lU2VwYXJhdG9yKCkgKyBjb2RlLmdldFRhYigpKTsKICAgICAgICB9Cgog\nICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qKgogICAgICogV3Jp\ndGVzIHRoZSBnZW5lcmF0ZWQgY29kZSB0byB0aGUgcHJvcGVyIGZpbGUuCiAg\nICAgKi8KICAgIHB1YmxpYyB2b2lkIHJlY29yZCgpCiAgICAgICAgdGhyb3dz\nIElPRXhjZXB0aW9uIHsKICAgICAgICBpZiAoX2NvZGUgPT0gbnVsbCkKICAg\nICAgICAgICAgcmV0dXJuOwoKICAgICAgICBXcml0ZXIgd3JpdGVyID0gX3dy\naXRlcjsKICAgICAgICBpZiAod3JpdGVyID09IG51bGwpIHsKICAgICAgICAg\nICAgRmlsZSBmaWxlID0gZ2V0RmlsZSgpOwogICAgICAgICAgICBGaWxlcy5i\nYWNrdXAoZmlsZSwgZmFsc2UpOwogICAgICAgICAgICB3cml0ZXIgPSBuZXcg\nRmlsZVdyaXRlcihmaWxlKTsKICAgICAgICB9CgogICAgICAgIFByaW50V3Jp\ndGVyIHByaW50ZXIgPSBuZXcgUHJpbnRXcml0ZXIod3JpdGVyKTsKICAgICAg\nICBwcmludGVyLnByaW50KF9jb2RlKTsKICAgICAgICBwcmludGVyLmZsdXNo\nKCk7CgogICAgICAgIGlmIChfd3JpdGVyID09IG51bGwpCiAgICAgICAgICAg\nIHdyaXRlci5jbG9zZSgpOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJu\nIHRoZSBuZWNlc3NhcnkgaW1wb3J0cyBmb3IgdGhlIGNsYXNzLgogICAgICov\nCiAgICBwcml2YXRlIFN0cmluZyBnZXRJbXBvcnRzKCkgewogICAgICAgIFNl\ndCBwa2dzID0gZ2V0SW1wb3J0UGFja2FnZXMoKTsKCiAgICAgICAgQ29kZUZv\ncm1hdCBpbXBvcnRzID0gbmV3Q29kZUZvcm1hdCgpOwogICAgICAgIFN0cmlu\nZyBiYXNlID0gU3RyaW5ncy5nZXRQYWNrYWdlTmFtZShfbWV0YS5nZXRPYmpl\nY3RJZFR5cGUoKSk7CiAgICAgICAgU3RyaW5nIHBrZzsKICAgICAgICBmb3Ig\nKEl0ZXJhdG9yIGl0ciA9IHBrZ3MuaXRlcmF0b3IoKTsgaXRyLmhhc05leHQo\nKTspIHsKICAgICAgICAgICAgcGtnID0gKFN0cmluZykgaXRyLm5leHQoKTsK\nICAgICAgICAgICAgaWYgKHBrZy5sZW5ndGgoKSA+IDAgJiYgISJqYXZhLmxh\nbmciLmVxdWFscyhwa2cpCiAgICAgICAgICAgICAgICAmJiAhYmFzZS5lcXVh\nbHMocGtnKSkgewogICAgICAgICAgICAgICAgaWYgKGltcG9ydHMubGVuZ3Ro\nKCkgPiAwKQogICAgICAgICAgICAgICAgICAgIGltcG9ydHMuZW5kbCgpOwog\nICAgICAgICAgICAgICAgaW1wb3J0cy5hcHBlbmQoImltcG9ydCAiKS5hcHBl\nbmQocGtnKS5hcHBlbmQoIi4qOyIpOwogICAgICAgICAgICB9CiAgICAgICAg\nfQogICAgICAgIHJldHVybiBpbXBvcnRzLnRvU3RyaW5nKCk7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBSZXR1cm5zIHRoZSBjb2xsZWN0aW9uIG9mIHBhY2th\nZ2VzIHRoYXQgbmVlZCB0byBiZSBpbXBvcnRlZC4KICAgICAqLwogICAgcHVi\nbGljIFNldCBnZXRJbXBvcnRQYWNrYWdlcygpIHsKICAgICAgICBTZXQgcGtn\ncyA9IG5ldyBUcmVlU2V0KCk7CiAgICAgICAgcGtncy5hZGQoU3RyaW5ncy5n\nZXRQYWNrYWdlTmFtZShfdHlwZSkpOwoKICAgICAgICBDbGFzcyBzdXBlck9p\nZENsYXNzID0gbnVsbDsKICAgICAgICBpZiAoX21ldGEgIT0gbnVsbCAmJiBf\nbWV0YS5nZXRQQ1N1cGVyY2xhc3NNZXRhRGF0YSgpICE9IG51bGwpCiAgICAg\nICAgICAgIHN1cGVyT2lkQ2xhc3MgPSBfbWV0YS5nZXRQQ1N1cGVyY2xhc3NN\nZXRhRGF0YSgpLmdldE9iamVjdElkVHlwZSgpOwogICAgICAgIGlmIChzdXBl\nck9pZENsYXNzICE9IG51bGwpCiAgICAgICAgICAgIHBrZ3MuYWRkKFN0cmlu\nZ3MuZ2V0UGFja2FnZU5hbWUoc3VwZXJPaWRDbGFzcykpOwoKICAgICAgICBw\na2dzLmFkZCgiamF2YS5pbyIpOwogICAgICAgIHBrZ3MuYWRkKCJqYXZhLnV0\naWwiKTsKICAgICAgICBDbGFzcyB0eXBlOwogICAgICAgIGZvciAoaW50IGkg\nPSAwOyBpIDwgX2ZpZWxkcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICB0\neXBlID0gX2ZpZWxkc1tpXS5nZXRPYmplY3RJZEZpZWxkVHlwZSgpOwogICAg\nICAgICAgICBpZiAodHlwZSAhPSBieXRlW10uY2xhc3MgJiYgdHlwZSAhPSBj\naGFyW10uY2xhc3MKICAgICAgICAgICAgICAgICYmICF0eXBlLmdldE5hbWUo\nKS5zdGFydHNXaXRoKCJqYXZhLnNxbC4iKSkgewogICAgICAgICAgICAgICAg\ncGtncy5hZGQoU3RyaW5ncy5nZXRQYWNrYWdlTmFtZSh0eXBlKSk7CiAgICAg\nICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIHBrZ3M7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIGNvZGUgdG8gZGVjbGFyZSBh\nbGwgcHJpbWFyeSBrZXkgZmllbGRzLgogICAgICovCiAgICBwcml2YXRlIFN0\ncmluZyBnZXRGaWVsZERlY2xhcmF0aW9ucygpIHsKICAgICAgICBDb2RlRm9y\nbWF0IGNvZGUgPSBuZXdDb2RlRm9ybWF0KCk7CiAgICAgICAgZm9yIChpbnQg\naSA9IDA7IGkgPCBfZmllbGRzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAg\nIGlmIChpID4gMCkKICAgICAgICAgICAgICAgIGNvZGUuZW5kbCgpOwogICAg\nICAgICAgICBjb2RlLnRhYigpLmFwcGVuZCgicHVibGljICIpLmFwcGVuZChn\nZXRUeXBlTmFtZShfZmllbGRzW2ldKSkuCiAgICAgICAgICAgICAgICBhcHBl\nbmQoIiAiKS5hcHBlbmQoX2ZpZWxkc1tpXS5nZXROYW1lKCkpLmFwcGVuZCgi\nOyIpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gY29kZS50b1N0cmluZygp\nOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRoZSB0eXBlIG5hbWUg\ndG8gZGVjbGFyZSB0aGUgZ2l2ZW4gZmllbGQgYXMuCiAgICAgKi8KICAgIHBy\naXZhdGUgU3RyaW5nIGdldFR5cGVOYW1lKEZpZWxkTWV0YURhdGEgZm1kKSB7\nCiAgICAgICAgQ2xhc3MgdHlwZSA9IGZtZC5nZXRPYmplY3RJZEZpZWxkVHlw\nZSgpOwogICAgICAgIGlmICh0eXBlID09IGJ5dGVbXS5jbGFzcykKICAgICAg\nICAgICAgcmV0dXJuICJieXRlW10iOwogICAgICAgIGlmICh0eXBlID09IGNo\nYXJbXS5jbGFzcykKICAgICAgICAgICAgcmV0dXJuICJjaGFyW10iOwogICAg\nICAgIGlmICh0eXBlLmdldE5hbWUoKS5zdGFydHNXaXRoKCJqYXZhLnNxbC4i\nKSkKICAgICAgICAgICAgcmV0dXJuIHR5cGUuZ2V0TmFtZSgpOwogICAgICAg\nIHJldHVybiBTdHJpbmdzLmdldENsYXNzTmFtZSh0eXBlKTsKICAgIH0KCiAg\nICAvKioKICAgICAqIFJldHVybiB0aGUgZ2V0dGVycyBhbmQgc2V0dGVycyBm\nb3IgYWxsIHByaW1hcnkga2V5IGZpZWxkcy4KICAgICAqLwogICAgcHJpdmF0\nZSBTdHJpbmcgZ2V0UHJvcGVydGllcygpIHsKICAgICAgICBpZiAoX21ldGEu\nZ2V0QWNjZXNzVHlwZSgpID09IENsYXNzTWV0YURhdGEuQUNDRVNTX0ZJRUxE\nKQogICAgICAgICAgICByZXR1cm4gIiI7CgogICAgICAgIENvZGVGb3JtYXQg\nY29kZSA9IG5ld0NvZGVGb3JtYXQoKTsKICAgICAgICBTdHJpbmcgcHJvcE5h\nbWU7CiAgICAgICAgU3RyaW5nIHR5cGVOYW1lOwogICAgICAgIGZvciAoaW50\nIGkgPSAwOyBpIDwgX2ZpZWxkcy5sZW5ndGg7IGkrKykgewogICAgICAgICAg\nICBpZiAoaSA+IDApCiAgICAgICAgICAgICAgICBjb2RlLmFmdGVyU2VjdGlv\nbigpOwogICAgICAgICAgICB0eXBlTmFtZSA9IGdldFR5cGVOYW1lKF9maWVs\nZHNbaV0pOwogICAgICAgICAgICBwcm9wTmFtZSA9IFN0cmluZ1V0aWxzLmNh\ncGl0YWxpemUoX2ZpZWxkc1tpXS5nZXROYW1lKCkpOwoKICAgICAgICAgICAg\nY29kZS50YWIoKS5hcHBlbmQoInB1YmxpYyAiKS5hcHBlbmQodHlwZU5hbWUp\nLmFwcGVuZCgiICIpOwogICAgICAgICAgICBpZiAoX2ZpZWxkc1tpXS5nZXRE\nZWNsYXJlZFR5cGVDb2RlKCkgPT0gSmF2YVR5cGVzLkJPT0xFQU4KICAgICAg\nICAgICAgICAgIHx8IF9maWVsZHNbaV0uZ2V0RGVjbGFyZWRUeXBlQ29kZSgp\nID09IEphdmFUeXBlcy5CT09MRUFOX09CSikKICAgICAgICAgICAgICAgIGNv\nZGUuYXBwZW5kKCJpcyIpOwogICAgICAgICAgICBlbHNlCiAgICAgICAgICAg\nICAgICBjb2RlLmFwcGVuZCgiZ2V0Iik7CiAgICAgICAgICAgIGNvZGUuYXBw\nZW5kKHByb3BOYW1lKS5wYXJlbnMoKS5vcGVuQnJhY2UoMikuZW5kbCgpOwog\nICAgICAgICAgICBjb2RlLnRhYigyKS5hcHBlbmQoInJldHVybiAiKS5hcHBl\nbmQoX2ZpZWxkc1tpXS5nZXROYW1lKCkpLgogICAgICAgICAgICAgICAgYXBw\nZW5kKCI7IikuZW5kbCgpOwogICAgICAgICAgICBjb2RlLmNsb3NlQnJhY2Uo\nMik7CiAgICAgICAgICAgIGNvZGUuYWZ0ZXJTZWN0aW9uKCk7CgogICAgICAg\nICAgICBjb2RlLnRhYigpLmFwcGVuZCgicHVibGljIHZvaWQgc2V0IikuYXBw\nZW5kKHByb3BOYW1lKTsKICAgICAgICAgICAgY29kZS5vcGVuUGFyZW4odHJ1\nZSkuYXBwZW5kKHR5cGVOYW1lKS5hcHBlbmQoIiAiKS4KICAgICAgICAgICAg\nICAgIGFwcGVuZChfZmllbGRzW2ldLmdldE5hbWUoKSkuY2xvc2VQYXJlbigp\nOwogICAgICAgICAgICBjb2RlLm9wZW5CcmFjZSgyKS5lbmRsKCk7CiAgICAg\nICAgICAgIGNvZGUudGFiKDIpLmFwcGVuZCgidGhpcy4iKS5hcHBlbmQoX2Zp\nZWxkc1tpXS5nZXROYW1lKCkpLgogICAgICAgICAgICAgICAgYXBwZW5kKCIg\nPSAiKS5hcHBlbmQoX2ZpZWxkc1tpXS5nZXROYW1lKCkpLmFwcGVuZCgiOyIp\nLgogICAgICAgICAgICAgICAgZW5kbCgpOwogICAgICAgICAgICBjb2RlLmNs\nb3NlQnJhY2UoMik7CiAgICAgICAgfQogICAgICAgIHJldHVybiBjb2RlLnRv\nU3RyaW5nKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIHN0\ncmluZyBjb25zdHJ1Y3RvciBjb2RlLgogICAgICovCiAgICBwcml2YXRlIFN0\ncmluZyBnZXRDb25zdHJ1Y3Rvcihib29sZWFuIGhhc1N1cGVyY2xhc3MpIHsK\nICAgICAgICBDb2RlRm9ybWF0IGNvZGUgPSBuZXdDb2RlRm9ybWF0KCk7CiAg\nICAgICAgY29kZS50YWIoKS5hcHBlbmQoInB1YmxpYyAiKTsKICAgICAgICBj\nb2RlLmFwcGVuZChnZXRDbGFzc05hbWUoKSk7CiAgICAgICAgY29kZS5vcGVu\nUGFyZW4odHJ1ZSkuYXBwZW5kKCJTdHJpbmcgc3RyIikuY2xvc2VQYXJlbigp\nOwogICAgICAgIGNvZGUub3BlbkJyYWNlKDIpLmVuZGwoKTsKCiAgICAgICAg\naWYgKF9maWVsZHMubGVuZ3RoICE9IDAgfHwgKGhhc1N1cGVyY2xhc3MKICAg\nICAgICAgICAgJiYgX21ldGEuZ2V0UHJpbWFyeUtleUZpZWxkcygpLmxlbmd0\naCA+IDApKSB7CiAgICAgICAgICAgIGNvZGUudGFiKDIpLmFwcGVuZCgiZnJv\nbVN0cmluZyIpLm9wZW5QYXJlbih0cnVlKS4KICAgICAgICAgICAgICAgIGFw\ncGVuZCgic3RyIikuY2xvc2VQYXJlbigpLmFwcGVuZCgiOyIpLmVuZGwoKTsK\nICAgICAgICB9CgogICAgICAgIGNvZGUuY2xvc2VCcmFjZSgyKTsKICAgICAg\nICByZXR1cm4gY29kZS50b1N0cmluZygpOwogICAgfQoKICAgIC8qKgogICAg\nICogQ3JlYXRlIHRoZSBmcm9tU3RyaW5nIG1ldGhvZCB0aGF0IHBhcnNlcyB0\naGUgcmVzdWx0IG9mIG91ciB0b1N0cmluZwogICAgICogbWV0aG9kLiBJZiB3\nZSBoYXZlIHN1cGVyY2xhc3NlcyB3aXRoIGlkIGZpZWxkcywgdGhpcyB3aWxs\nIGNhbGwKICAgICAqIHN1cGVyLmZyb21TdHJpbmcoKSBzbyB0aGF0IHRoZSBw\nYXJlbnQgY2xhc3MgY2FuIHBhcnNlIGl0cyBvd24gZmllbGRzLgogICAgICov\nCiAgICBwcml2YXRlIFN0cmluZyBnZXRGcm9tU3RyaW5nQ29kZShib29sZWFu\nIGhhc1N1cGVyY2xhc3MpIHsKICAgICAgICAvLyBpZiB3ZSBhcmUgYmVsb3cg\nYSBjb25jcmV0ZSBjbGFzcyB0aGVuIHdlIGNhbm5vdCBkZWNsYXJlIGFueQog\nICAgICAgIC8vIG1vcmUgcHJpbWFyeSBrZXkgZmllbGRzOyB0aHVzLCBqdXN0\nIHVzZSB0aGUgcGFyZW50IGludm9jYXRpb24KICAgICAgICBpZiAoaGFzQ29u\nY3JldGVTdXBlcmNsYXNzKCkpCiAgICAgICAgICAgIHJldHVybiAiIjsKICAg\nICAgICBpZiAoX2ZpZWxkcy5sZW5ndGggPT0gMCkKICAgICAgICAgICAgcmV0\ndXJuICIiOwogICAgICAgIGhhc1N1cGVyY2xhc3MgPSBoYXNTdXBlcmNsYXNz\nICYmIGdldERlY2xhcmVkUHJpbWFyeUtleUZpZWxkcwogICAgICAgICAgICAo\nX21ldGEuZ2V0UENTdXBlcmNsYXNzTWV0YURhdGEoKSkubGVuZ3RoID4gMDsK\nCiAgICAgICAgU3RyaW5nIHRva2UgPSBnZXRUb2tlbml6ZXIoaGFzU3VwZXJj\nbGFzcyk7CiAgICAgICAgQ29kZUZvcm1hdCBjb2RlID0gbmV3Q29kZUZvcm1h\ndCgpOwogICAgICAgIGlmIChfYWJzdHJhY3QgfHwgaGFzU3VwZXJjbGFzcykK\nICAgICAgICAgICAgY29kZS50YWIoKS5hcHBlbmQoInByb3RlY3RlZCAiKS5h\ncHBlbmQodG9rZSkuCiAgICAgICAgICAgICAgICBhcHBlbmQoIiBmcm9tU3Ry\naW5nIik7CiAgICAgICAgZWxzZQogICAgICAgICAgICBjb2RlLnRhYigpLmFw\ncGVuZCgicHJpdmF0ZSB2b2lkIGZyb21TdHJpbmciKTsKICAgICAgICBjb2Rl\nLm9wZW5QYXJlbih0cnVlKS5hcHBlbmQoIlN0cmluZyBzdHIiKS5jbG9zZVBh\ncmVuKCk7CiAgICAgICAgY29kZS5vcGVuQnJhY2UoMikuZW5kbCgpOwoKICAg\nICAgICAvLyBpZiB3ZSBoYXZlIGFueSBPYmplY3QtdHlwZSBmaWVsZHMsIGRp\nZSBpbW1lZGlhdGVseSAKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IF9m\naWVsZHMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgaWYgKF9maWVsZHNb\naV0uZ2V0T2JqZWN0SWRGaWVsZFR5cGUoKSAhPSBPYmplY3QuY2xhc3MpCiAg\nICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgY29kZS50YWIo\nMikuYXBwZW5kKCJ0aHJvdyBuZXcgVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNl\ncHRpb24iKS4KICAgICAgICAgICAgICAgIHBhcmVucygpLmFwcGVuZCgiOyIp\nLmVuZGwoKTsKICAgICAgICAgICAgY29kZS5jbG9zZUJyYWNlKDIpOyAKICAg\nICAgICAgICAgcmV0dXJuIGNvZGUudG9TdHJpbmcoKTsKICAgICAgICB9IAoK\nICAgICAgICBpZiAodG9rZSAhPSBudWxsKSB7CiAgICAgICAgICAgIGNvZGUu\ndGFiKDIpLmFwcGVuZCh0b2tlKS5hcHBlbmQoIiB0b2tlID0gIik7CiAgICAg\nICAgICAgIGlmIChoYXNTdXBlcmNsYXNzKSB7CiAgICAgICAgICAgICAgICAv\nLyBjYWxsIHN1cGVyLmZyb21TdHJpbmcoc3RyKSB0byBnZXQgdGhlIHRva2Vu\naXplciB0aGF0IHdhcwogICAgICAgICAgICAgICAgLy8gdXNlZCB0byBwYXJz\nZSB0aGUgc3VwZXJjbGFzcwogICAgICAgICAgICAgICAgY29kZS5hcHBlbmQo\nInN1cGVyLmZyb21TdHJpbmciKS5vcGVuUGFyZW4odHJ1ZSkuCiAgICAgICAg\nICAgICAgICAgICAgYXBwZW5kKCJzdHIiKS5jbG9zZVBhcmVuKCk7CiAgICAg\nICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAvLyBvdGhlcndpc2Ug\nY29uc3RydWN0IGEgbmV3IHRva2VuaXplciB3aXRoIHRoZSBzdHJpbmcKICAg\nICAgICAgICAgICAgIGNvZGUuYXBwZW5kKCJuZXcgIikuYXBwZW5kKHRva2Up\nLm9wZW5QYXJlbih0cnVlKS4KICAgICAgICAgICAgICAgICAgICBhcHBlbmQo\nInN0ciIpOwogICAgICAgICAgICAgICAgaWYgKHRva2UgPT0gVE9LRU5JWkVS\nX1NURCkKICAgICAgICAgICAgICAgICAgICBjb2RlLmFwcGVuZCgiLCBcIiIp\nLmFwcGVuZChfdG9rZW4pLmFwcGVuZCgiXCIiKTsKICAgICAgICAgICAgICAg\nIGNvZGUuY2xvc2VQYXJlbigpOwogICAgICAgICAgICB9CiAgICAgICAgICAg\nIGNvZGUuYXBwZW5kKCI7IikuZW5kbCgpOwogICAgICAgIH0KCiAgICAgICAg\nZm9yIChpbnQgaSA9IDA7IGkgPCBfZmllbGRzLmxlbmd0aDsgaSsrKSB7CiAg\nICAgICAgICAgIGlmICh0b2tlICE9IG51bGwpIHsKICAgICAgICAgICAgICAg\nIGNvZGUudGFiKDIpLmFwcGVuZCgic3RyID0gdG9rZS5uZXh0VG9rZW4iKS5w\nYXJlbnMoKS4KICAgICAgICAgICAgICAgICAgICBhcHBlbmQoIjsiKS5lbmRs\nKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY29kZS50YWIoMikuYXBw\nZW5kKGdldENvbnZlcnNpb25Db2RlKF9maWVsZHNbaV0sICJzdHIiKSkuZW5k\nbCgpOwogICAgICAgIH0KICAgICAgICBpZiAoX2Fic3RyYWN0IHx8IGhhc1N1\ncGVyY2xhc3MpCiAgICAgICAgICAgIGNvZGUudGFiKDIpLmFwcGVuZCgicmV0\ndXJuIHRva2U7IikuZW5kbCgpOwogICAgICAgIGNvZGUuY2xvc2VCcmFjZSgy\nKTsKICAgICAgICByZXR1cm4gY29kZS50b1N0cmluZygpOwogICAgfQoKICAg\nIC8qKgogICAgICogUmV0dXJucyB0aGUgdHlwZSBvZiB0b2tlbml6ZXIgdG8g\ndXNlLCBvciBudWxsIGlmIG5vbmUuCiAgICAgKi8KICAgIHByaXZhdGUgU3Ry\naW5nIGdldFRva2VuaXplcihib29sZWFuIGhhc1N1cGVyY2xhc3MpIHsKICAg\nICAgICBpZiAoIV9hYnN0cmFjdCAmJiAhaGFzU3VwZXJjbGFzcyAmJiBfZmll\nbGRzLmxlbmd0aCA9PSAxKQogICAgICAgICAgICByZXR1cm4gbnVsbDsKICAg\nICAgICBpZiAoX3Rva2VuLmxlbmd0aCgpID09IDEpCiAgICAgICAgICAgIHJl\ndHVybiBUT0tFTklaRVJfU1REOwogICAgICAgIHJldHVybiBUT0tFTklaRVJf\nQ1VTVE9NOwogICAgfQoKICAgIC8qKgogICAgICogR2V0IHBhcnNpbmcgY29k\nZSBmb3IgdGhlIGdpdmVuIGZpZWxkLgogICAgICovCiAgICBwcml2YXRlIFN0\ncmluZyBnZXRDb252ZXJzaW9uQ29kZShGaWVsZE1ldGFEYXRhIGZpZWxkLCBT\ndHJpbmcgdmFyKSB7CiAgICAgICAgQ29kZUZvcm1hdCBwYXJzZSA9IG5ld0Nv\nZGVGb3JtYXQoKTsKICAgICAgICBpZiAoZmllbGQuZ2V0TmFtZSgpLmVxdWFs\ncyh2YXIpKQogICAgICAgICAgICBwYXJzZS5hcHBlbmQoInRoaXMuIik7CiAg\nICAgICAgcGFyc2UuYXBwZW5kKGZpZWxkLmdldE5hbWUoKSkuYXBwZW5kKCIg\nPSAiKTsKCiAgICAgICAgQ2xhc3MgdHlwZSA9IGZpZWxkLmdldE9iamVjdElk\nRmllbGRUeXBlKCk7CiAgICAgICAgaWYgKHR5cGUgPT0gRGF0ZS5jbGFzcykg\newogICAgICAgICAgICBwYXJzZS5hcHBlbmQoIm5ldyBEYXRlIikub3BlblBh\ncmVuKHRydWUpLgogICAgICAgICAgICAgICAgYXBwZW5kKCJMb25nLnBhcnNl\nTG9uZyIpLm9wZW5QYXJlbih0cnVlKS4KICAgICAgICAgICAgICAgIGFwcGVu\nZCh2YXIpLmNsb3NlUGFyZW4oKS5jbG9zZVBhcmVuKCk7CiAgICAgICAgfSBl\nbHNlIGlmICh0eXBlID09IGphdmEuc3FsLkRhdGUuY2xhc3MKICAgICAgICAg\nICAgfHwgdHlwZSA9PSBqYXZhLnNxbC5UaW1lc3RhbXAuY2xhc3MKICAgICAg\nICAgICAgfHwgdHlwZSA9PSBqYXZhLnNxbC5UaW1lLmNsYXNzKSB7CiAgICAg\nICAgICAgIHBhcnNlLmFwcGVuZCh0eXBlLmdldE5hbWUoKSkuYXBwZW5kKCIu\ndmFsdWVPZiIpLm9wZW5QYXJlbih0cnVlKS4KICAgICAgICAgICAgICAgIGFw\ncGVuZCh2YXIpLmNsb3NlUGFyZW4oKTsKICAgICAgICB9IGVsc2UgaWYgKHR5\ncGUgPT0gU3RyaW5nLmNsYXNzKQogICAgICAgICAgICBwYXJzZS5hcHBlbmQo\ndmFyKTsKICAgICAgICBlbHNlIGlmICh0eXBlID09IENoYXJhY3Rlci5jbGFz\ncykgewogICAgICAgICAgICBwYXJzZS5hcHBlbmQoIm5ldyBDaGFyYWN0ZXIi\nKS5vcGVuUGFyZW4odHJ1ZSkuYXBwZW5kKHZhcikuCiAgICAgICAgICAgICAg\nICBhcHBlbmQoIi5jaGFyQXQiKS5vcGVuUGFyZW4odHJ1ZSkuYXBwZW5kKDAp\nLgogICAgICAgICAgICAgICAgY2xvc2VQYXJlbigpLmNsb3NlUGFyZW4oKTsK\nICAgICAgICB9IGVsc2UgaWYgKHR5cGUgPT0gYnl0ZVtdLmNsYXNzKQogICAg\nICAgICAgICBwYXJzZS5hcHBlbmQoInRvQnl0ZXMiKS5vcGVuUGFyZW4odHJ1\nZSkuYXBwZW5kKHZhcikuY2xvc2VQYXJlbigpOwogICAgICAgIGVsc2UgaWYg\nKHR5cGUgPT0gY2hhcltdLmNsYXNzKQogICAgICAgICAgICBwYXJzZS5hcHBl\nbmQodmFyKS5hcHBlbmQoIi50b0NoYXJBcnJheSIpLnBhcmVucygpOwogICAg\nICAgIGVsc2UgaWYgKCF0eXBlLmlzUHJpbWl0aXZlKCkpIHsKICAgICAgICAg\nICAgcGFyc2UuYXBwZW5kKCJuZXcgIikuYXBwZW5kKFN0cmluZ3MuZ2V0Q2xh\nc3NOYW1lKHR5cGUpKS4KICAgICAgICAgICAgICAgIG9wZW5QYXJlbih0cnVl\nKS5hcHBlbmQodmFyKS5jbG9zZVBhcmVuKCk7CiAgICAgICAgfSBlbHNlIC8v\nIHByaW1pdGl2ZQogICAgICAgIHsKICAgICAgICAgICAgc3dpdGNoICh0eXBl\nLmdldE5hbWUoKS5jaGFyQXQoMCkpIHsKICAgICAgICAgICAgICAgIGNhc2Ug\nJ2InOgogICAgICAgICAgICAgICAgICAgIGlmICh0eXBlID09IGJvb2xlYW4u\nY2xhc3MpCiAgICAgICAgICAgICAgICAgICAgICAgIHBhcnNlLmFwcGVuZCgi\nXCJ0cnVlXCIuZXF1YWxzIikub3BlblBhcmVuKHRydWUpLgogICAgICAgICAg\nICAgICAgICAgICAgICAgICAgYXBwZW5kKHZhcikuY2xvc2VQYXJlbigpOwog\nICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICAg\nICAgcGFyc2UuYXBwZW5kKCJCeXRlLnBhcnNlQnl0ZSIpLm9wZW5QYXJlbih0\ncnVlKS4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFwcGVuZCh2YXIp\nLmNsb3NlUGFyZW4oKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAg\nICAgICAgICAgICAgIGNhc2UgJ2MnOgogICAgICAgICAgICAgICAgICAgIHBh\ncnNlLmFwcGVuZCh2YXIpLmFwcGVuZCgiLmNoYXJBdCIpLm9wZW5QYXJlbih0\ncnVlKS4KICAgICAgICAgICAgICAgICAgICAgICAgYXBwZW5kKDApLmNsb3Nl\nUGFyZW4oKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAg\nICAgICAgIGNhc2UgJ2QnOgogICAgICAgICAgICAgICAgICAgIHBhcnNlLmFw\ncGVuZCgiRG91YmxlLnBhcnNlRG91YmxlIikub3BlblBhcmVuKHRydWUpLgog\nICAgICAgICAgICAgICAgICAgICAgICBhcHBlbmQodmFyKS5jbG9zZVBhcmVu\nKCk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAg\nICBjYXNlICdmJzoKICAgICAgICAgICAgICAgICAgICBwYXJzZS5hcHBlbmQo\nIkZsb2F0LnBhcnNlRmxvYXQiKS5vcGVuUGFyZW4odHJ1ZSkuCiAgICAgICAg\nICAgICAgICAgICAgICAgIGFwcGVuZCh2YXIpLmNsb3NlUGFyZW4oKTsKICAg\nICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2Ug\nJ2knOgogICAgICAgICAgICAgICAgICAgIHBhcnNlLmFwcGVuZCgiSW50ZWdl\nci5wYXJzZUludCIpLm9wZW5QYXJlbih0cnVlKS4KICAgICAgICAgICAgICAg\nICAgICAgICAgYXBwZW5kKHZhcikuY2xvc2VQYXJlbigpOwogICAgICAgICAg\nICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSAnbCc6CiAg\nICAgICAgICAgICAgICAgICAgcGFyc2UuYXBwZW5kKCJMb25nLnBhcnNlTG9u\nZyIpLm9wZW5QYXJlbih0cnVlKS4KICAgICAgICAgICAgICAgICAgICAgICAg\nYXBwZW5kKHZhcikuY2xvc2VQYXJlbigpOwogICAgICAgICAgICAgICAgICAg\nIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSAncyc6CiAgICAgICAgICAg\nICAgICAgICAgcGFyc2UuYXBwZW5kKCJTaG9ydC5wYXJzZVNob3J0Iikub3Bl\nblBhcmVuKHRydWUpLgogICAgICAgICAgICAgICAgICAgICAgICBhcHBlbmQo\ndmFyKS5jbG9zZVBhcmVuKCk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7\nCiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGlmICghdHlwZS5p\nc1ByaW1pdGl2ZSgpICYmIHR5cGUgIT0gYnl0ZVtdLmNsYXNzKSB7CiAgICAg\nICAgICAgIENvZGVGb3JtYXQgaXNOdWxsID0gbmV3Q29kZUZvcm1hdCgpOwog\nICAgICAgICAgICBpc051bGwuYXBwZW5kKCJpZiIpLm9wZW5QYXJlbih0cnVl\nKS5hcHBlbmQoIlwibnVsbFwiLmVxdWFscyIpLgogICAgICAgICAgICAgICAg\nb3BlblBhcmVuKHRydWUpLmFwcGVuZCh2YXIpLmNsb3NlUGFyZW4oKS5jbG9z\nZVBhcmVuKCkuCiAgICAgICAgICAgICAgICBlbmRsKCkudGFiKDMpOwogICAg\nICAgICAgICBpZiAoZmllbGQuZ2V0TmFtZSgpLmVxdWFscyh2YXIpKQogICAg\nICAgICAgICAgICAgaXNOdWxsLmFwcGVuZCgidGhpcy4iKTsKICAgICAgICAg\nICAgaXNOdWxsLmFwcGVuZChmaWVsZC5nZXROYW1lKCkpLmFwcGVuZCgiID0g\nbnVsbDsiKS5lbmRsKCk7CiAgICAgICAgICAgIGlzTnVsbC50YWIoMikuYXBw\nZW5kKCJlbHNlIikuZW5kbCgpOwogICAgICAgICAgICBpc051bGwudGFiKDMp\nLmFwcGVuZChwYXJzZSk7CiAgICAgICAgICAgIHBhcnNlID0gaXNOdWxsOwog\nICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHBhcnNlLmFwcGVuZCgiOyIpLnRv\nU3RyaW5nKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gYW4gZXF1\nYWxpdHkgbWV0aG9kIHRoYXQgY29tcGFyZXMgYWxsIHBrIHZhcmlhYmxlcy4K\nICAgICAqIE11c3QgZGVhbCBjb3JyZWN0bHkgd2l0aCBib3RoIHByaW1pdGl2\nZXMgYW5kIG9iamVjdHMuCiAgICAgKi8KICAgIHByaXZhdGUgU3RyaW5nIGdl\ndEVxdWFsc0NvZGUoYm9vbGVhbiBoYXNTdXBlcmNsYXNzKSB7CiAgICAgICAg\nLy8gaWYgd2UgYXJlIGJlbG93IGEgY29uY3JldGUgY2xhc3MgdGhlbiB3ZSBj\nYW5ub3QgZGVjbGFyZSBhbnkKICAgICAgICAvLyBtb3JlIHByaW1hcnkga2V5\nIGZpZWxkczsgdGh1cywganVzdCB1c2UgdGhlIHBhcmVudCBpbnZvY2F0aW9u\nCiAgICAgICAgaWYgKGhhc0NvbmNyZXRlU3VwZXJjbGFzcygpIHx8IChoYXNT\ndXBlcmNsYXNzICYmIF9maWVsZHMubGVuZ3RoID09IDApKQogICAgICAgICAg\nICByZXR1cm4gIiI7CgogICAgICAgIENvZGVGb3JtYXQgY29kZSA9IG5ld0Nv\nZGVGb3JtYXQoKTsKICAgICAgICBjb2RlLnRhYigpLmFwcGVuZCgicHVibGlj\nIGJvb2xlYW4gZXF1YWxzIikub3BlblBhcmVuKHRydWUpLgogICAgICAgICAg\nICBhcHBlbmQoIk9iamVjdCBvYmoiKS5jbG9zZVBhcmVuKCkub3BlbkJyYWNl\nKDIpLmVuZGwoKTsKCiAgICAgICAgY29kZS50YWIoMikuYXBwZW5kKCJpZiIp\nLm9wZW5QYXJlbih0cnVlKS4KICAgICAgICAgICAgYXBwZW5kKCJ0aGlzID09\nIG9iaiIpLmNsb3NlUGFyZW4oKS5lbmRsKCk7CiAgICAgICAgY29kZS50YWIo\nMykuYXBwZW5kKCJyZXR1cm4gdHJ1ZTsiKS5lbmRsKCk7CgogICAgICAgIC8v\nIGNhbGwgc3VwZXIuZXF1YWxzKCkgaWYgd2UgaGF2ZSBhIHN1cGVyY2xhc3MK\nICAgICAgICBTdHJpbmcgY2xhc3NOYW1lID0gZ2V0Q2xhc3NOYW1lKCk7CiAg\nICAgICAgaWYgKGhhc1N1cGVyY2xhc3MpIHsKICAgICAgICAgICAgY29kZS50\nYWIoMikuYXBwZW5kKCJpZiIpLm9wZW5QYXJlbih0cnVlKS4KICAgICAgICAg\nICAgICAgIGFwcGVuZCgiIXN1cGVyLmVxdWFscyIpLm9wZW5QYXJlbih0cnVl\nKS4KICAgICAgICAgICAgICAgIGFwcGVuZCgib2JqIikuY2xvc2VQYXJlbigp\nLmNsb3NlUGFyZW4oKS5lbmRsKCk7CiAgICAgICAgICAgIGNvZGUudGFiKDMp\nLmFwcGVuZCgicmV0dXJuIGZhbHNlOyIpLmVuZGwoKTsKICAgICAgICB9IGVs\nc2UgewogICAgICAgICAgICBjb2RlLnRhYigyKS5hcHBlbmQoImlmIikub3Bl\nblBhcmVuKHRydWUpLgogICAgICAgICAgICAgICAgYXBwZW5kKCJvYmogPT0g\nbnVsbCB8fCBvYmouZ2V0Q2xhc3MiKS5wYXJlbnMoKS4KICAgICAgICAgICAg\nICAgIGFwcGVuZCgiICE9ICIpLmFwcGVuZCgiZ2V0Q2xhc3MiKS5wYXJlbnMo\nKS4KICAgICAgICAgICAgICAgIGNsb3NlUGFyZW4oKS5lbmRsKCk7CiAgICAg\nICAgICAgIGNvZGUudGFiKDMpLmFwcGVuZCgicmV0dXJuIGZhbHNlOyIpLmVu\nZGwoKTsKICAgICAgICB9CgogICAgICAgIFN0cmluZyBuYW1lOwogICAgICAg\nIENsYXNzIHR5cGU7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBfZmll\nbGRzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGlmIChpID09IDApIHsK\nICAgICAgICAgICAgICAgIGNvZGUuZW5kbCgpLnRhYigyKS5hcHBlbmQoY2xh\nc3NOYW1lKS5hcHBlbmQoIiBvdGhlciA9ICIpLgogICAgICAgICAgICAgICAg\nICAgIG9wZW5QYXJlbihmYWxzZSkuYXBwZW5kKGNsYXNzTmFtZSkuY2xvc2VQ\nYXJlbigpLgogICAgICAgICAgICAgICAgICAgIGFwcGVuZCgiIG9iajsiKS5l\nbmRsKCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIGlmIHRoaXMg\naXMgbm90IHRoZSBmaXJzdCBmaWVsZCwgYWRkIGFuICYmCiAgICAgICAgICAg\nIGlmIChpID09IDApCiAgICAgICAgICAgICAgICBjb2RlLnRhYigyKS5hcHBl\nbmQoInJldHVybiAiKTsKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAg\nICAgY29kZS5lbmRsKCkudGFiKDMpLmFwcGVuZCgiJiYgIik7CgogICAgICAg\nICAgICBuYW1lID0gX2ZpZWxkc1tpXS5nZXROYW1lKCk7CiAgICAgICAgICAg\nIHR5cGUgPSBfZmllbGRzW2ldLmdldE9iamVjdElkRmllbGRUeXBlKCk7CiAg\nICAgICAgICAgIGlmICh0eXBlLmlzUHJpbWl0aXZlKCkpIHsKICAgICAgICAg\nICAgICAgIGNvZGUub3BlblBhcmVuKGZhbHNlKS5hcHBlbmQobmFtZSkuYXBw\nZW5kKCIgPT0gIikuCiAgICAgICAgICAgICAgICAgICAgYXBwZW5kKCJvdGhl\nci4iKS5hcHBlbmQobmFtZSkuY2xvc2VQYXJlbigpOwogICAgICAgICAgICB9\nIGVsc2UgaWYgKHR5cGUgPT0gYnl0ZVtdLmNsYXNzKSB7CiAgICAgICAgICAg\nICAgICBjb2RlLm9wZW5QYXJlbihmYWxzZSkuYXBwZW5kKCJlcXVhbHMiKS5v\ncGVuUGFyZW4odHJ1ZSkuCiAgICAgICAgICAgICAgICAgICAgYXBwZW5kKG5h\nbWUpLmFwcGVuZCgiLCAiKS5hcHBlbmQoIm90aGVyLiIpLgogICAgICAgICAg\nICAgICAgICAgIGFwcGVuZChuYW1lKS5jbG9zZVBhcmVuKCkuY2xvc2VQYXJl\nbigpOwogICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGUgPT0gY2hhcltdLmNs\nYXNzKSB7CiAgICAgICAgICAgICAgICAvLyAoKG5hbWUgPT0gbnVsbCAmJiBv\ndGhlci5uYW1lID09IG51bGwpCiAgICAgICAgICAgICAgICAvLwl8fCAobmFt\nZSAhPSBudWxsICYmIFN0cmluZy52YWx1ZU9mIChuYW1lKS4KICAgICAgICAg\nICAgICAgIC8vCWVxdWFscyAoU3RyaW5nLnZhbHVlT2YgKG90aGVyLm5hbWUp\nKSkpCiAgICAgICAgICAgICAgICBjb2RlLmFwcGVuZCgiKCIpLm9wZW5QYXJl\nbihmYWxzZSkuYXBwZW5kKG5hbWUpLgogICAgICAgICAgICAgICAgICAgIGFw\ncGVuZCgiID09IG51bGwgJiYgb3RoZXIuIikuYXBwZW5kKG5hbWUpLgogICAg\nICAgICAgICAgICAgICAgIGFwcGVuZCgiID09IG51bGwiKS5jbG9zZVBhcmVu\nKCkuZW5kbCgpOwogICAgICAgICAgICAgICAgY29kZS50YWIoMykuYXBwZW5k\nKCJ8fCAiKTsKICAgICAgICAgICAgICAgIGNvZGUub3BlblBhcmVuKGZhbHNl\nKS5hcHBlbmQobmFtZSkuYXBwZW5kKCIgIT0gbnVsbCAiKS4KICAgICAgICAg\nICAgICAgICAgICBhcHBlbmQoIiYmIFN0cmluZy52YWx1ZU9mIikub3BlblBh\ncmVuKHRydWUpLmFwcGVuZChuYW1lKS4KICAgICAgICAgICAgICAgICAgICBj\nbG9zZVBhcmVuKCkuYXBwZW5kKCIuIikuZW5kbCgpOwogICAgICAgICAgICAg\nICAgY29kZS50YWIoMykuYXBwZW5kKCJlcXVhbHMiKS5vcGVuUGFyZW4odHJ1\nZSkuCiAgICAgICAgICAgICAgICAgICAgYXBwZW5kKCJTdHJpbmcudmFsdWVP\nZiIpLm9wZW5QYXJlbih0cnVlKS4KICAgICAgICAgICAgICAgICAgICBhcHBl\nbmQoIm90aGVyLiIpLmFwcGVuZChuYW1lKS5jbG9zZVBhcmVuKCkuY2xvc2VQ\nYXJlbigpLgogICAgICAgICAgICAgICAgICAgIGNsb3NlUGFyZW4oKS5hcHBl\nbmQoIikiKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAg\nIC8vICgobmFtZSA9PSBudWxsICYmIG90aGVyLm5hbWUgPT0gbnVsbCkKICAg\nICAgICAgICAgICAgIC8vCXx8IChuYW1lICE9IG51bGwgJiYgbmFtZS5lcXVh\nbHMgKG90aGVyLm5hbWUpKSkKICAgICAgICAgICAgICAgIGNvZGUuYXBwZW5k\nKCIoIikub3BlblBhcmVuKGZhbHNlKS5hcHBlbmQobmFtZSkuCiAgICAgICAg\nICAgICAgICAgICAgYXBwZW5kKCIgPT0gbnVsbCAmJiBvdGhlci4iKS5hcHBl\nbmQobmFtZSkuCiAgICAgICAgICAgICAgICAgICAgYXBwZW5kKCIgPT0gbnVs\nbCIpLmNsb3NlUGFyZW4oKS5lbmRsKCk7CiAgICAgICAgICAgICAgICBjb2Rl\nLnRhYigzKS5hcHBlbmQoInx8ICIpOwogICAgICAgICAgICAgICAgY29kZS5v\ncGVuUGFyZW4oZmFsc2UpLmFwcGVuZChuYW1lKS5hcHBlbmQoIiAhPSBudWxs\nICIpLgogICAgICAgICAgICAgICAgICAgIGFwcGVuZCgiJiYgIikuYXBwZW5k\nKG5hbWUpLmFwcGVuZCgiLmVxdWFscyIpLgogICAgICAgICAgICAgICAgICAg\nIG9wZW5QYXJlbih0cnVlKS5hcHBlbmQoIm90aGVyLiIpLmFwcGVuZChuYW1l\nKS4KICAgICAgICAgICAgICAgICAgICBjbG9zZVBhcmVuKCkuY2xvc2VQYXJl\nbigpLmFwcGVuZCgiKSIpOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAg\nICAgICAvLyBubyBfZmllbGRzOiBqdXN0IHJldHVybiB0cnVlIGFmdGVyIGNo\nZWNraW5nIGluc3RhbmNlb2YKICAgICAgICBpZiAoX2ZpZWxkcy5sZW5ndGgg\nPT0gMCkKICAgICAgICAgICAgY29kZS50YWIoMikuYXBwZW5kKCJyZXR1cm4g\ndHJ1ZTsiKS5lbmRsKCk7CiAgICAgICAgZWxzZQogICAgICAgICAgICBjb2Rl\nLmFwcGVuZCgiOyIpLmVuZGwoKTsKCiAgICAgICAgY29kZS5jbG9zZUJyYWNl\nKDIpOwogICAgICAgIHJldHVybiBjb2RlLnRvU3RyaW5nKCk7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBSZXR1cm4gYSBoYXNoQ29kZSBtZXRob2QgdGhhdCB0\nYWtlcyBpbnRvIGFjY291bnQgYWxsCiAgICAgKiBwcmltYXJ5IGtleSB2YWx1\nZXMuIE11c3QgZGVhbCBjb3JyZWN0bHkgd2l0aCBib3RoIHByaW1pdGl2ZXMg\nYW5kIG9iamVjdHMuCiAgICAgKi8KICAgIHByaXZhdGUgU3RyaW5nIGdldEhh\nc2hDb2RlQ29kZShib29sZWFuIGhhc1N1cGVyY2xhc3MpIHsKICAgICAgICAv\nLyBpZiB3ZSBhcmUgYmVsb3cgYSBjb25jcmV0ZSBjbGFzcyB0aGVuIHdlIGNh\nbm5vdCBkZWNsYXJlIGFueQogICAgICAgIC8vIG1vcmUgcHJpbWFyeSBrZXkg\nZmllbGRzOyB0aHVzLCBqdXN0IHVzZSB0aGUgcGFyZW50IGludm9jYXRpb24K\nICAgICAgICBpZiAoaGFzQ29uY3JldGVTdXBlcmNsYXNzKCkgfHwgKGhhc1N1\ncGVyY2xhc3MgJiYgX2ZpZWxkcy5sZW5ndGggPT0gMCkpCiAgICAgICAgICAg\nIHJldHVybiAiIjsKCiAgICAgICAgQ29kZUZvcm1hdCBjb2RlID0gbmV3Q29k\nZUZvcm1hdCgpOwogICAgICAgIGNvZGUudGFiKCkuYXBwZW5kKCJwdWJsaWMg\naW50IGhhc2hDb2RlIikucGFyZW5zKCkuCiAgICAgICAgICAgIG9wZW5CcmFj\nZSgyKS5lbmRsKCk7CgogICAgICAgIGlmIChfZmllbGRzLmxlbmd0aCA9PSAw\nKQogICAgICAgICAgICBjb2RlLnRhYigyKS5hcHBlbmQoInJldHVybiAxNzsi\nKS5lbmRsKCk7CiAgICAgICAgZWxzZSBpZiAoX2ZpZWxkcy5sZW5ndGggPT0g\nMSAmJiAhaGFzU3VwZXJjbGFzcykgewogICAgICAgICAgICBjb2RlLnRhYigy\nKS5hcHBlbmQoInJldHVybiAiKTsKICAgICAgICAgICAgYXBwZW5kSGFzaENv\nZGVDb2RlKF9maWVsZHNbMF0sIGNvZGUpOwogICAgICAgICAgICBjb2RlLmFw\ncGVuZCgiOyIpLmVuZGwoKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAg\nICBjb2RlLnRhYigyKS5hcHBlbmQoImludCBycyA9ICIpOwogICAgICAgICAg\nICBpZiAoaGFzU3VwZXJjbGFzcykgewogICAgICAgICAgICAgICAgLy8gY2Fs\nbCBzdXBlci5oYXNoQ29kZSgpIGlmIHdlIGhhdmUgYSBzdXBlcmNsYXNzCiAg\nICAgICAgICAgICAgICBjb2RlLmFwcGVuZCgic3VwZXIuaGFzaENvZGUiKS5v\ncGVuUGFyZW4odHJ1ZSkuCiAgICAgICAgICAgICAgICAgICAgY2xvc2VQYXJl\nbigpLmFwcGVuZCgiOyIpOwogICAgICAgICAgICB9IGVsc2UKICAgICAgICAg\nICAgICAgIGNvZGUuYXBwZW5kKCIxNzsiKTsKICAgICAgICAgICAgY29kZS5l\nbmRsKCk7CgogICAgICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IF9maWVs\nZHMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICAgIGNvZGUudGFiKDIp\nLmFwcGVuZCgicnMgPSBycyAqIDM3ICsgIik7CiAgICAgICAgICAgICAgICBh\ncHBlbmRIYXNoQ29kZUNvZGUoX2ZpZWxkc1tpXSwgY29kZSk7CiAgICAgICAg\nICAgICAgICBjb2RlLmFwcGVuZCgiOyIpLmVuZGwoKTsKICAgICAgICAgICAg\nfQogICAgICAgICAgICBjb2RlLnRhYigyKS5hcHBlbmQoInJldHVybiByczsi\nKS5lbmRsKCk7CiAgICAgICAgfQogICAgICAgIGNvZGUuY2xvc2VCcmFjZSgy\nKTsKICAgICAgICByZXR1cm4gY29kZS50b1N0cmluZygpOwogICAgfQoKICAg\nIC8qKgogICAgICogUmV0dXJuIHRydWUgaWYgdGhpcyBjbGFzcyBoYXMgYSBj\nb25jcmV0ZSBzdXBlcmNsYXNzLgogICAgICovCiAgICBwcml2YXRlIGJvb2xl\nYW4gaGFzQ29uY3JldGVTdXBlcmNsYXNzKCkgewogICAgICAgIGZvciAoQ2xh\nc3NNZXRhRGF0YSBzdXAgPSBfbWV0YS5nZXRQQ1N1cGVyY2xhc3NNZXRhRGF0\nYSgpOwogICAgICAgICAgICBzdXAgIT0gbnVsbDsgc3VwID0gc3VwLmdldFBD\nU3VwZXJjbGFzc01ldGFEYXRhKCkpIHsKICAgICAgICAgICAgaWYgKCFNb2Rp\nZmllci5pc0Fic3RyYWN0KHN1cC5nZXREZXNjcmliZWRUeXBlKCkuZ2V0TW9k\naWZpZXJzKCkpKQogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAg\nICAgfQogICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICAvKioKICAg\nICAqIEFwcGVuZCBjb2RlIGNhbGN1bGF0aW5nIHRoZSBoYXNoY29kZSBmb3Ig\ndGhlIGdpdmVuIGZpZWxkLgogICAgICovCiAgICBwcml2YXRlIHZvaWQgYXBw\nZW5kSGFzaENvZGVDb2RlKEZpZWxkTWV0YURhdGEgZmllbGQsIENvZGVGb3Jt\nYXQgY29kZSkgewogICAgICAgIFN0cmluZyBuYW1lID0gZmllbGQuZ2V0TmFt\nZSgpOwogICAgICAgIGlmICgicnMiLmVxdWFscyhuYW1lKSkKICAgICAgICAg\nICAgbmFtZSA9ICJ0aGlzLiIgKyBuYW1lOwogICAgICAgIENsYXNzIHR5cGUg\nPSBmaWVsZC5nZXRPYmplY3RJZEZpZWxkVHlwZSgpOwogICAgICAgIGlmICh0\neXBlLmlzUHJpbWl0aXZlKCkpIHsKICAgICAgICAgICAgaWYgKHR5cGUgPT0g\nYm9vbGVhbi5jbGFzcykgewogICAgICAgICAgICAgICAgLy8gKChuYW1lKSA/\nIDEgOiAwKQogICAgICAgICAgICAgICAgY29kZS5hcHBlbmQoIigiKS5vcGVu\nUGFyZW4oZmFsc2UpLmFwcGVuZChuYW1lKS5jbG9zZVBhcmVuKCkuCiAgICAg\nICAgICAgICAgICAgICAgYXBwZW5kKCIgPyAxIDogMCIpLmFwcGVuZCgiKSIp\nOwogICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGUgPT0gbG9uZy5jbGFzcykg\newogICAgICAgICAgICAgICAgLy8gKGludCkgKG5hbWUgXiAobmFtZSA+Pj4g\nMzIpKQogICAgICAgICAgICAgICAgY29kZS5vcGVuUGFyZW4oZmFsc2UpLmFw\ncGVuZCgiaW50IikuY2xvc2VQYXJlbigpLgogICAgICAgICAgICAgICAgICAg\nIGFwcGVuZCgiICIpLm9wZW5QYXJlbihmYWxzZSkuYXBwZW5kKG5hbWUpLgog\nICAgICAgICAgICAgICAgICAgIGFwcGVuZCgiIF4gIikub3BlblBhcmVuKGZh\nbHNlKS5hcHBlbmQobmFtZSkuCiAgICAgICAgICAgICAgICAgICAgYXBwZW5k\nKCIgPj4+IDMyIikuY2xvc2VQYXJlbigpLmNsb3NlUGFyZW4oKTsKICAgICAg\nICAgICAgfSBlbHNlIGlmICh0eXBlID09IGRvdWJsZS5jbGFzcykgewogICAg\nICAgICAgICAgICAgLy8gKGludCkgKERvdWJsZS5kb3VibGVUb0xvbmdCaXRz\nIChuYW1lKQogICAgICAgICAgICAgICAgLy8gICAgIF4gKERvdWJsZS5kb3Vi\nbGVUb0xvbmdCaXRzIChuYW1lKSA+Pj4gMzIpKQogICAgICAgICAgICAgICAg\nY29kZS5vcGVuUGFyZW4oZmFsc2UpLmFwcGVuZCgiaW50IikuY2xvc2VQYXJl\nbigpLgogICAgICAgICAgICAgICAgICAgIGFwcGVuZCgiICIpLm9wZW5QYXJl\nbihmYWxzZSkuCiAgICAgICAgICAgICAgICAgICAgYXBwZW5kKCJEb3VibGUu\nZG91YmxlVG9Mb25nQml0cyIpLm9wZW5QYXJlbih0cnVlKS4KICAgICAgICAg\nICAgICAgICAgICBhcHBlbmQobmFtZSkuY2xvc2VQYXJlbigpLmVuZGwoKTsK\nICAgICAgICAgICAgICAgIGNvZGUudGFiKDMpLmFwcGVuZCgiXiAiKS5vcGVu\nUGFyZW4oZmFsc2UpLgogICAgICAgICAgICAgICAgICAgIGFwcGVuZCgiRG91\nYmxlLmRvdWJsZVRvTG9uZ0JpdHMiKS5vcGVuUGFyZW4odHJ1ZSkuCiAgICAg\nICAgICAgICAgICAgICAgYXBwZW5kKG5hbWUpLmNsb3NlUGFyZW4oKS5hcHBl\nbmQoIiA+Pj4gMzIiKS4KICAgICAgICAgICAgICAgICAgICBjbG9zZVBhcmVu\nKCkuY2xvc2VQYXJlbigpOwogICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGUg\nPT0gZmxvYXQuY2xhc3MpIHsKICAgICAgICAgICAgICAgIC8vIEZsb2F0LmZs\nb2F0VG9JbnRCaXRzIChuYW1lKQogICAgICAgICAgICAgICAgY29kZS5hcHBl\nbmQoIkZsb2F0LmZsb2F0VG9JbnRCaXRzIikub3BlblBhcmVuKHRydWUpLgog\nICAgICAgICAgICAgICAgICAgIGFwcGVuZChuYW1lKS5jbG9zZVBhcmVuKCk7\nCiAgICAgICAgICAgIH0gZWxzZSBpZiAodHlwZSA9PSBpbnQuY2xhc3MpCiAg\nICAgICAgICAgICAgICBjb2RlLmFwcGVuZChuYW1lKTsKICAgICAgICAgICAg\nZWxzZSB7CiAgICAgICAgICAgICAgICAvLyAoaW50KSBuYW1lCiAgICAgICAg\nICAgICAgICBjb2RlLm9wZW5QYXJlbihmYWxzZSkuYXBwZW5kKCJpbnQiKS5j\nbG9zZVBhcmVuKCkuCiAgICAgICAgICAgICAgICAgICAgYXBwZW5kKCIgIiku\nYXBwZW5kKG5hbWUpOwogICAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIGlm\nICh0eXBlID09IGJ5dGVbXS5jbGFzcykgewogICAgICAgICAgICAvLyBoYXNo\nQ29kZSAobmFtZSk7CiAgICAgICAgICAgIGNvZGUuYXBwZW5kKCJoYXNoQ29k\nZSIpLm9wZW5QYXJlbih0cnVlKS5hcHBlbmQobmFtZSkuCiAgICAgICAgICAg\nICAgICBjbG9zZVBhcmVuKCk7CiAgICAgICAgfSBlbHNlIGlmICh0eXBlID09\nIGNoYXJbXS5jbGFzcykgewogICAgICAgICAgICAvLyAoKG5hbWUgPT0gbnVs\nbCkgPyAwIDogU3RyaW5nLnZhbHVlT2YgKG5hbWUpLmhhc2hDb2RlICgpKQog\nICAgICAgICAgICBjb2RlLmFwcGVuZCgiKCIpLm9wZW5QYXJlbihmYWxzZSku\nYXBwZW5kKG5hbWUpLgogICAgICAgICAgICAgICAgYXBwZW5kKCIgPT0gbnVs\nbCIpLmNsb3NlUGFyZW4oKS5hcHBlbmQoIiA/IDAgOiAiKS4KICAgICAgICAg\nICAgICAgIGFwcGVuZCgiU3RyaW5nLnZhbHVlT2YiKS5vcGVuUGFyZW4odHJ1\nZSkuYXBwZW5kKG5hbWUpLgogICAgICAgICAgICAgICAgY2xvc2VQYXJlbigp\nLmFwcGVuZCgiLmhhc2hDb2RlIikucGFyZW5zKCkuYXBwZW5kKCIpIik7CiAg\nICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgLy8gKChuYW1lID09IG51bGwp\nID8gMCA6IG5hbWUuaGFzaENvZGUgKCkpCiAgICAgICAgICAgIGNvZGUuYXBw\nZW5kKCIoIikub3BlblBhcmVuKGZhbHNlKS5hcHBlbmQobmFtZSkuCiAgICAg\nICAgICAgICAgICBhcHBlbmQoIiA9PSBudWxsIikuY2xvc2VQYXJlbigpLmFw\ncGVuZCgiID8gMCA6ICIpLgogICAgICAgICAgICAgICAgYXBwZW5kKG5hbWUp\nLmFwcGVuZCgiLmhhc2hDb2RlIikucGFyZW5zKCkuYXBwZW5kKCIpIik7CiAg\nICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIGEgbWV0aG9k\nIHRvIGNyZWF0ZSBhIHN0cmluZyBjb250YWluaW5nIHRoZSBwcmltYXJ5IGtl\neQogICAgICogdmFsdWVzIHRoYXQgZGVmaW5lIHRoZSBhcHBsaWNhdGlvbiBp\nZCBvYmplY3QuCiAgICAgKi8KICAgIHByaXZhdGUgU3RyaW5nIGdldFRvU3Ry\naW5nQ29kZShib29sZWFuIGhhc1N1cGVyY2xhc3MpIHsKICAgICAgICAvLyBp\nZiB3ZSBhcmUgYmVsb3cgYSBjb25jcmV0ZSBjbGFzcyB0aGVuIHdlIGNhbm5v\ndCBkZWNsYXJlIGFueQogICAgICAgIC8vIG1vcmUgcHJpbWFyeSBrZXkgZmll\nbGRzOyB0aHVzLCBqdXN0IHVzZSB0aGUgcGFyZW50IGludm9jYXRpb24KICAg\nICAgICBpZiAoaGFzQ29uY3JldGVTdXBlcmNsYXNzKCkgfHwgKGhhc1N1cGVy\nY2xhc3MgJiYgX2ZpZWxkcy5sZW5ndGggPT0gMCkpCiAgICAgICAgICAgIHJl\ndHVybiAiIjsKCiAgICAgICAgQ29kZUZvcm1hdCBjb2RlID0gbmV3Q29kZUZv\ncm1hdCgpOwogICAgICAgIGNvZGUudGFiKCkuYXBwZW5kKCJwdWJsaWMgU3Ry\naW5nIHRvU3RyaW5nIikucGFyZW5zKCkuCiAgICAgICAgICAgIG9wZW5CcmFj\nZSgyKS5lbmRsKCk7CgogICAgICAgIFN0cmluZyBuYW1lOwogICAgICAgIENs\nYXNzIHR5cGU7CiAgICAgICAgU3RyaW5nIGFwcGVuZERlbGltaXRlciA9ICIr\nIFwiIiArIF90b2tlbiArICJcIiArICI7CiAgICAgICAgZm9yIChpbnQgaSA9\nIDA7IGkgPCBfZmllbGRzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIC8v\nIGlmIHRoaXMgaXMgbm90IHRoZSBmaXJzdCBmaWVsZCwgYWRkIGEgKwogICAg\nICAgICAgICBpZiAoaSA9PSAwKSB7CiAgICAgICAgICAgICAgICBjb2RlLnRh\nYigyKS5hcHBlbmQoInJldHVybiAiKTsKCiAgICAgICAgICAgICAgICAvLyBh\nZGQgaW4gdGhlIHN1cGVyLnRvU3RyaW5nKCkgaWYgd2UgaGF2ZSBhIHBhcmVu\ndAogICAgICAgICAgICAgICAgaWYgKGhhc1N1cGVyY2xhc3MgJiYgZ2V0RGVj\nbGFyZWRQcmltYXJ5S2V5RmllbGRzCiAgICAgICAgICAgICAgICAgICAgKF9t\nZXRhLmdldFBDU3VwZXJjbGFzc01ldGFEYXRhKCkpLmxlbmd0aCA+IDApIHsK\nICAgICAgICAgICAgICAgICAgICBjb2RlLmFwcGVuZCgic3VwZXIudG9TdHJp\nbmciKS5wYXJlbnMoKTsKICAgICAgICAgICAgICAgICAgICBjb2RlLmVuZGwo\nKS50YWIoMykuYXBwZW5kKGFwcGVuZERlbGltaXRlcik7CiAgICAgICAgICAg\nICAgICB9CiAgICAgICAgICAgIH0gZWxzZQogICAgICAgICAgICAgICAgY29k\nZS5lbmRsKCkudGFiKDMpLmFwcGVuZChhcHBlbmREZWxpbWl0ZXIpOwoKICAg\nICAgICAgICAgbmFtZSA9IF9maWVsZHNbaV0uZ2V0TmFtZSgpOwogICAgICAg\nICAgICB0eXBlID0gX2ZpZWxkc1tpXS5nZXRPYmplY3RJZEZpZWxkVHlwZSgp\nOwogICAgICAgICAgICBpZiAodHlwZSA9PSBTdHJpbmcuY2xhc3MpCiAgICAg\nICAgICAgICAgICBjb2RlLmFwcGVuZChuYW1lKTsKICAgICAgICAgICAgZWxz\nZSBpZiAodHlwZSA9PSBieXRlW10uY2xhc3MpCiAgICAgICAgICAgICAgICBj\nb2RlLmFwcGVuZCgidG9TdHJpbmciKS5vcGVuUGFyZW4odHJ1ZSkuCiAgICAg\nICAgICAgICAgICAgICAgYXBwZW5kKG5hbWUpLmNsb3NlUGFyZW4oKTsKICAg\nICAgICAgICAgZWxzZSBpZiAodHlwZSA9PSBjaGFyW10uY2xhc3MpCiAgICAg\nICAgICAgICAgICBjb2RlLm9wZW5QYXJlbih0cnVlKS5vcGVuUGFyZW4odHJ1\nZSkuYXBwZW5kKG5hbWUpLgogICAgICAgICAgICAgICAgICAgIGFwcGVuZCgi\nID09IG51bGwiKS5jbG9zZVBhcmVuKCkuYXBwZW5kKCIgPyBcIm51bGxcIiIp\nLgogICAgICAgICAgICAgICAgICAgIGFwcGVuZCgiOiBTdHJpbmcudmFsdWVP\nZiIpLm9wZW5QYXJlbih0cnVlKS4KICAgICAgICAgICAgICAgICAgICBhcHBl\nbmQobmFtZSkuY2xvc2VQYXJlbigpLmNsb3NlUGFyZW4oKTsKICAgICAgICAg\nICAgZWxzZSBpZiAodHlwZSA9PSBEYXRlLmNsYXNzKQogICAgICAgICAgICAg\nICAgY29kZS5vcGVuUGFyZW4odHJ1ZSkub3BlblBhcmVuKHRydWUpLmFwcGVu\nZChuYW1lKS4KICAgICAgICAgICAgICAgICAgICBhcHBlbmQoIiA9PSBudWxs\nIikuY2xvc2VQYXJlbigpLmFwcGVuZCgiID8gXCJudWxsXCIiKS4KICAgICAg\nICAgICAgICAgICAgICBlbmRsKCkudGFiKDQpLmFwcGVuZCgiOiBTdHJpbmcu\ndmFsdWVPZiIpLgogICAgICAgICAgICAgICAgICAgIG9wZW5QYXJlbih0cnVl\nKS5hcHBlbmQobmFtZSkuYXBwZW5kKCIuZ2V0VGltZSIpLgogICAgICAgICAg\nICAgICAgICAgIHBhcmVucygpLmNsb3NlUGFyZW4oKS5jbG9zZVBhcmVuKCk7\nCiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIGNvZGUuYXBwZW5k\nKCJTdHJpbmcudmFsdWVPZiIpLm9wZW5QYXJlbih0cnVlKS4KICAgICAgICAg\nICAgICAgICAgICBhcHBlbmQobmFtZSkuY2xvc2VQYXJlbigpOwogICAgICAg\nIH0KCiAgICAgICAgLy8gbm8gZmllbGRzOyBqdXN0IHVzZSAiIgogICAgICAg\nIGlmIChfZmllbGRzLmxlbmd0aCA9PSAwKQogICAgICAgICAgICBjb2RlLnRh\nYigyKS5hcHBlbmQoInJldHVybiBcIlwiIik7CiAgICAgICAgY29kZS5hcHBl\nbmQoIjsiKS5lbmRsKCk7CiAgICAgICAgY29kZS5jbG9zZUJyYWNlKDIpOwog\nICAgICAgIHJldHVybiBjb2RlLnRvU3RyaW5nKCk7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBDb2RlIHRvIGNvbnZlcnQgYSBzdHJpbmcgdG8gYSBieXRlIGFy\ncmF5LgogICAgICoKICAgICAqIEBzZWUgb3JnLmFwYWNoZS5vcGVuanBhLmxp\nYi51dGlsLkJhc2UxNkVuY29kZXIjZGVjb2RlCiAgICAgKi8KICAgIHByaXZh\ndGUgU3RyaW5nIGdldFRvQnl0ZXNCeXRlQXJyYXlDb2RlKCkgewogICAgICAg\nIENvZGVGb3JtYXQgY29kZSA9IG5ld0NvZGVGb3JtYXQoKTsKICAgICAgICBj\nb2RlLnRhYigpLmFwcGVuZCgicHJpdmF0ZSBzdGF0aWMgYnl0ZVtdIHRvQnl0\nZXMiKS5vcGVuUGFyZW4odHJ1ZSkuCiAgICAgICAgICAgIGFwcGVuZCgiU3Ry\naW5nIHMiKS5jbG9zZVBhcmVuKCkub3BlbkJyYWNlKDIpLmVuZGwoKTsKCiAg\nICAgICAgY29kZS50YWIoMikuYXBwZW5kKCJpZiIpLm9wZW5QYXJlbih0cnVl\nKS5hcHBlbmQoIlwibnVsbFwiLmVxdWFscyIpLgogICAgICAgICAgICBvcGVu\nUGFyZW4odHJ1ZSkuYXBwZW5kKCJzIikuY2xvc2VQYXJlbigpLmNsb3NlUGFy\nZW4oKS5lbmRsKCk7CiAgICAgICAgY29kZS50YWIoMykuYXBwZW5kKCJyZXR1\ncm4gbnVsbDsiKS5lbmRsKDIpOwoKICAgICAgICBjb2RlLnRhYigyKS5hcHBl\nbmQoImludCBsZW4gPSBzLmxlbmd0aCIpLnBhcmVucygpLgogICAgICAgICAg\nICBhcHBlbmQoIjsiKS5lbmRsKCk7CiAgICAgICAgY29kZS50YWIoMikuYXBw\nZW5kKCJieXRlW10gciA9IG5ldyBieXRlW2xlbiAvIDJdOyIpLmVuZGwoKTsK\nICAgICAgICBjb2RlLnRhYigyKS5hcHBlbmQoImZvciIpLm9wZW5QYXJlbih0\ncnVlKS4KICAgICAgICAgICAgYXBwZW5kKCJpbnQgaSA9IDA7IGkgPCByLmxl\nbmd0aDsgaSsrIikuY2xvc2VQYXJlbigpLgogICAgICAgICAgICBvcGVuQnJh\nY2UoMykuZW5kbCgpOwogICAgICAgIGNvZGUudGFiKDMpLmFwcGVuZCgiaW50\nIGRpZ2l0MSA9IHMuY2hhckF0Iikub3BlblBhcmVuKHRydWUpLgogICAgICAg\nICAgICBhcHBlbmQoImkgKiAyIikuY2xvc2VQYXJlbigpLmFwcGVuZCgiLCAi\nKS4KICAgICAgICAgICAgYXBwZW5kKCJkaWdpdDIgPSBzLmNoYXJBdCIpLm9w\nZW5QYXJlbih0cnVlKS4KICAgICAgICAgICAgYXBwZW5kKCJpICogMiArIDEi\nKS5jbG9zZVBhcmVuKCkuYXBwZW5kKCI7IikuZW5kbCgpOwogICAgICAgIGNv\nZGUudGFiKDMpLmFwcGVuZCgiaWYiKS5vcGVuUGFyZW4odHJ1ZSkuCiAgICAg\nICAgICAgIGFwcGVuZCgiZGlnaXQxID49ICcwJyAmJiBkaWdpdDEgPD0gJzkn\nIikuY2xvc2VQYXJlbigpLmVuZGwoKTsKICAgICAgICBjb2RlLnRhYig0KS5h\ncHBlbmQoImRpZ2l0MSAtPSAnMCc7IikuZW5kbCgpOwogICAgICAgIGNvZGUu\ndGFiKDMpLmFwcGVuZCgiZWxzZSBpZiIpLm9wZW5QYXJlbih0cnVlKS4KICAg\nICAgICAgICAgYXBwZW5kKCJkaWdpdDEgPj0gJ0EnICYmIGRpZ2l0MSA8PSAn\nRiciKS5jbG9zZVBhcmVuKCkuZW5kbCgpOwogICAgICAgIGNvZGUudGFiKDQp\nLmFwcGVuZCgiZGlnaXQxIC09ICdBJyAtIDEwOyIpLmVuZGwoKTsKICAgICAg\nICBjb2RlLnRhYigzKS5hcHBlbmQoImlmIikub3BlblBhcmVuKHRydWUpLgog\nICAgICAgICAgICBhcHBlbmQoImRpZ2l0MiA+PSAnMCcgJiYgZGlnaXQyIDw9\nICc5JyIpLmNsb3NlUGFyZW4oKS5lbmRsKCk7CiAgICAgICAgY29kZS50YWIo\nNCkuYXBwZW5kKCJkaWdpdDIgLT0gJzAnOyIpLmVuZGwoKTsKICAgICAgICBj\nb2RlLnRhYigzKS5hcHBlbmQoImVsc2UgaWYiKS5vcGVuUGFyZW4odHJ1ZSku\nCiAgICAgICAgICAgIGFwcGVuZCgiZGlnaXQyID49ICdBJyAmJiBkaWdpdDIg\nPD0gJ0YnIikuY2xvc2VQYXJlbigpLmVuZGwoKTsKICAgICAgICBjb2RlLnRh\nYig0KS5hcHBlbmQoImRpZ2l0MiAtPSAnQScgLSAxMDsiKS5lbmRsKDIpOwog\nICAgICAgIGNvZGUudGFiKDMpLmFwcGVuZCgicltpXSA9IChieXRlKSAiKS5v\ncGVuUGFyZW4oZmFsc2UpLgogICAgICAgICAgICBvcGVuUGFyZW4oZmFsc2Up\nLmFwcGVuZCgiZGlnaXQxIDw8IDQiKS5jbG9zZVBhcmVuKCkuCiAgICAgICAg\nICAgIGFwcGVuZCgiICsgZGlnaXQyIikuY2xvc2VQYXJlbigpLmFwcGVuZCgi\nOyIpLmVuZGwoKTsKICAgICAgICBjb2RlLmNsb3NlQnJhY2UoMykuZW5kbCgp\nOwogICAgICAgIGNvZGUudGFiKDIpLmFwcGVuZCgicmV0dXJuIHI7IikuZW5k\nbCgpOwoKICAgICAgICBjb2RlLmNsb3NlQnJhY2UoMik7CiAgICAgICAgcmV0\ndXJuIGNvZGUudG9TdHJpbmcoKTsKICAgIH0KCiAgICAvKioKICAgICAqIENv\nZGUgdG8gY29udmVydCBhIGJ5dGUgYXJyYXkgdG8gYSBzdHJpbmcuCiAgICAg\nKgogICAgICogQHNlZSBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuQmFz\nZTE2RW5jb2RlciNlbmNvZGUKICAgICAqLwogICAgcHJpdmF0ZSBTdHJpbmcg\nZ2V0VG9TdHJpbmdCeXRlQXJyYXlDb2RlKCkgewogICAgICAgIENvZGVGb3Jt\nYXQgY29kZSA9IG5ld0NvZGVGb3JtYXQoKTsKICAgICAgICBjb2RlLnRhYigp\nLmFwcGVuZCgicHJpdmF0ZSBzdGF0aWMgU3RyaW5nIHRvU3RyaW5nIikub3Bl\nblBhcmVuKHRydWUpLgogICAgICAgICAgICBhcHBlbmQoImJ5dGVbXSBiIiku\nY2xvc2VQYXJlbigpLm9wZW5CcmFjZSgyKS5lbmRsKCk7CgogICAgICAgIGNv\nZGUudGFiKDIpLmFwcGVuZCgiaWYiKS5vcGVuUGFyZW4odHJ1ZSkuCiAgICAg\nICAgICAgIGFwcGVuZCgiYiA9PSBudWxsIikuY2xvc2VQYXJlbigpLmVuZGwo\nKTsKICAgICAgICBjb2RlLnRhYigzKS5hcHBlbmQoInJldHVybiBcIm51bGxc\nIjsiKS5lbmRsKDIpOwoKICAgICAgICBjb2RlLnRhYigyKS5hcHBlbmQoIlN0\ncmluZ0J1ZmZlciByID0gbmV3IFN0cmluZ0J1ZmZlciIpLgogICAgICAgICAg\nICBvcGVuUGFyZW4odHJ1ZSkuYXBwZW5kKCJiLmxlbmd0aCAqIDIiKS5jbG9z\nZVBhcmVuKCkuCiAgICAgICAgICAgIGFwcGVuZCgiOyIpLmVuZGwoKTsKICAg\nICAgICBjb2RlLnRhYigyKS5hcHBlbmQoImZvciIpLm9wZW5QYXJlbih0cnVl\nKS4KICAgICAgICAgICAgYXBwZW5kKCJpbnQgaSA9IDA7IGkgPCBiLmxlbmd0\naDsgaSsrIikuY2xvc2VQYXJlbigpLmVuZGwoKTsKICAgICAgICBjb2RlLnRh\nYigzKS5hcHBlbmQoImZvciIpLm9wZW5QYXJlbih0cnVlKS4KICAgICAgICAg\nICAgYXBwZW5kKCJpbnQgaiA9IDE7IGogPj0gMDsgai0tIikuY2xvc2VQYXJl\nbigpLmVuZGwoKTsKICAgICAgICBjb2RlLnRhYig0KS5hcHBlbmQoInIuYXBw\nZW5kIikub3BlblBhcmVuKHRydWUpLgogICAgICAgICAgICBhcHBlbmQoIkhF\nWFsiKS5vcGVuUGFyZW4oZmFsc2UpLmFwcGVuZCgiYltpXSA+PiAiKS4KICAg\nICAgICAgICAgb3BlblBhcmVuKGZhbHNlKS5hcHBlbmQoImogKiA0IikuY2xv\nc2VQYXJlbigpLmNsb3NlUGFyZW4oKS4KICAgICAgICAgICAgYXBwZW5kKCIg\nJiAweEZdIikuY2xvc2VQYXJlbigpLmFwcGVuZCgiOyIpLmVuZGwoKTsKICAg\nICAgICBjb2RlLnRhYigyKS5hcHBlbmQoInJldHVybiByLnRvU3RyaW5nIiku\ncGFyZW5zKCkuCiAgICAgICAgICAgIGFwcGVuZCgiOyIpLmVuZGwoKTsKCiAg\nICAgICAgY29kZS5jbG9zZUJyYWNlKDIpOwogICAgICAgIHJldHVybiBjb2Rl\nLnRvU3RyaW5nKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBDb2RlIHRvIHRl\nc3QgaWYgdHdvIGJ5dGUgYXJyYXlzIGFyZSBlcXVhbC4KICAgICAqLwogICAg\ncHJpdmF0ZSBTdHJpbmcgZ2V0RXF1YWxzQnl0ZUFycmF5Q29kZSgpIHsKICAg\nICAgICBDb2RlRm9ybWF0IGNvZGUgPSBuZXdDb2RlRm9ybWF0KCk7CiAgICAg\nICAgY29kZS50YWIoKS5hcHBlbmQoInByaXZhdGUgc3RhdGljIGJvb2xlYW4g\nZXF1YWxzIikub3BlblBhcmVuKHRydWUpLgogICAgICAgICAgICBhcHBlbmQo\nImJ5dGVbXSBiMSwgYnl0ZVtdIGIyIikuY2xvc2VQYXJlbigpLm9wZW5CcmFj\nZSgyKS5lbmRsKCk7CgogICAgICAgIGNvZGUudGFiKDIpLmFwcGVuZCgiaWYi\nKS5vcGVuUGFyZW4odHJ1ZSkuCiAgICAgICAgICAgIGFwcGVuZCgiYjEgPT0g\nbnVsbCAmJiBiMiA9PSBudWxsIikuY2xvc2VQYXJlbigpLmVuZGwoKTsKICAg\nICAgICBjb2RlLnRhYigzKS5hcHBlbmQoInJldHVybiB0cnVlOyIpLmVuZGwo\nKTsKICAgICAgICBjb2RlLnRhYigyKS5hcHBlbmQoImlmIikub3BlblBhcmVu\nKHRydWUpLgogICAgICAgICAgICBhcHBlbmQoImIxID09IG51bGwgfHwgYjIg\nPT0gbnVsbCIpLmNsb3NlUGFyZW4oKS5lbmRsKCk7CiAgICAgICAgY29kZS50\nYWIoMykuYXBwZW5kKCJyZXR1cm4gZmFsc2U7IikuZW5kbCgpOwogICAgICAg\nIGNvZGUudGFiKDIpLmFwcGVuZCgiaWYiKS5vcGVuUGFyZW4odHJ1ZSkuCiAg\nICAgICAgICAgIGFwcGVuZCgiYjEubGVuZ3RoICE9IGIyLmxlbmd0aCIpLmNs\nb3NlUGFyZW4oKS5lbmRsKCk7CiAgICAgICAgY29kZS50YWIoMykuYXBwZW5k\nKCJyZXR1cm4gZmFsc2U7IikuZW5kbCgpOwogICAgICAgIGNvZGUudGFiKDIp\nLmFwcGVuZCgiZm9yIikub3BlblBhcmVuKHRydWUpLgogICAgICAgICAgICBh\ncHBlbmQoImludCBpID0gMDsgaSA8IGIxLmxlbmd0aDsgaSsrIikuY2xvc2VQ\nYXJlbigpLmVuZGwoKTsKICAgICAgICBjb2RlLnRhYigzKS5hcHBlbmQoImlm\nIikub3BlblBhcmVuKHRydWUpLgogICAgICAgICAgICBhcHBlbmQoImIxW2ld\nICE9IGIyW2ldIikuY2xvc2VQYXJlbigpLmVuZGwoKTsKICAgICAgICBjb2Rl\nLnRhYig0KS5hcHBlbmQoInJldHVybiBmYWxzZTsiKS5lbmRsKCk7CiAgICAg\nICAgY29kZS50YWIoMikuYXBwZW5kKCJyZXR1cm4gdHJ1ZTsiKS5lbmRsKCk7\nCgogICAgICAgIGNvZGUuY2xvc2VCcmFjZSgyKTsKICAgICAgICByZXR1cm4g\nY29kZS50b1N0cmluZygpOwogICAgfQoKICAgIHByaXZhdGUgU3RyaW5nIGdl\ndEhhc2hDb2RlQnl0ZUFycmF5Q29kZSgpIHsKICAgICAgICBDb2RlRm9ybWF0\nIGNvZGUgPSBuZXdDb2RlRm9ybWF0KCk7CiAgICAgICAgY29kZS50YWIoKS5h\ncHBlbmQoInByaXZhdGUgc3RhdGljIGludCBoYXNoQ29kZSIpLm9wZW5QYXJl\nbih0cnVlKS4KICAgICAgICAgICAgYXBwZW5kKCJieXRlW10gYiIpLmNsb3Nl\nUGFyZW4oKS5vcGVuQnJhY2UoMikuZW5kbCgpOwoKICAgICAgICBjb2RlLnRh\nYigyKS5hcHBlbmQoImlmIikub3BlblBhcmVuKHRydWUpLmFwcGVuZCgiYiA9\nPSBudWxsIikuCiAgICAgICAgICAgIGNsb3NlUGFyZW4oKS5lbmRsKCk7CiAg\nICAgICAgY29kZS50YWIoMykuYXBwZW5kKCJyZXR1cm4gMDsiKS5lbmRsKCk7\nCiAgICAgICAgY29kZS50YWIoMikuYXBwZW5kKCJpbnQgc3VtID0gMDsiKS5l\nbmRsKCk7CiAgICAgICAgY29kZS50YWIoMikuYXBwZW5kKCJmb3IiKS5vcGVu\nUGFyZW4odHJ1ZSkuCiAgICAgICAgICAgIGFwcGVuZCgiaW50IGkgPSAwOyBp\nIDwgYi5sZW5ndGg7IGkrKyIpLmNsb3NlUGFyZW4oKS5lbmRsKCk7CiAgICAg\nICAgY29kZS50YWIoMykuYXBwZW5kKCJzdW0gKz0gYltpXTsiKS5lbmRsKCk7\nCiAgICAgICAgY29kZS50YWIoMikuYXBwZW5kKCJyZXR1cm4gc3VtOyIpLmVu\nZGwoKTsKCiAgICAgICAgY29kZS5jbG9zZUJyYWNlKDIpOwogICAgICAgIHJl\ndHVybiBjb2RlLnRvU3RyaW5nKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBD\nb2RlIGRlZmluaW5nIGEgdG9rZW5pemVyIGNsYXNzLgogICAgICovCiAgICBw\ncml2YXRlIFN0cmluZyBnZXRDdXN0b21Ub2tlbml6ZXJDbGFzcygpIHsKICAg\nICAgICBDb2RlRm9ybWF0IGNvZGUgPSBuZXdDb2RlRm9ybWF0KCk7CiAgICAg\nICAgY29kZS50YWIoKS5hcHBlbmQoInByb3RlY3RlZCBzdGF0aWMgY2xhc3Mg\nIikuCiAgICAgICAgICAgIGFwcGVuZChUT0tFTklaRVJfQ1VTVE9NKS5vcGVu\nQnJhY2UoMikuZW5kbCgpOwoKICAgICAgICBjb2RlLnRhYigyKS5hcHBlbmQo\nInByaXZhdGUgZmluYWwgU3RyaW5nIHN0cjsiKS5lbmRsKCk7CiAgICAgICAg\nY29kZS50YWIoMikuYXBwZW5kKCJwcml2YXRlIGludCBsYXN0OyIpLmFmdGVy\nU2VjdGlvbigpOwoKICAgICAgICBjb2RlLnRhYigyKS5hcHBlbmQoInB1Ymxp\nYyBUb2tlbml6ZXIgKFN0cmluZyBzdHIpIikuCiAgICAgICAgICAgIG9wZW5C\ncmFjZSgzKS5lbmRsKCk7CiAgICAgICAgY29kZS50YWIoMykuYXBwZW5kKCJ0\naGlzLnN0ciA9IHN0cjsiKS5lbmRsKCk7CiAgICAgICAgY29kZS5jbG9zZUJy\nYWNlKDMpLmFmdGVyU2VjdGlvbigpOwoKICAgICAgICBjb2RlLnRhYigyKS5h\ncHBlbmQoInB1YmxpYyBTdHJpbmcgbmV4dFRva2VuICgpIikuCiAgICAgICAg\nICAgIG9wZW5CcmFjZSgzKS5lbmRsKCk7CiAgICAgICAgY29kZS50YWIoMyku\nYXBwZW5kKCJpbnQgbmV4dCA9IHN0ci5pbmRleE9mIikub3BlblBhcmVuKHRy\ndWUpLgogICAgICAgICAgICBhcHBlbmQoIlwiIikuYXBwZW5kKF90b2tlbiku\nYXBwZW5kKCJcIiwgbGFzdCIpLmNsb3NlUGFyZW4oKS4KICAgICAgICAgICAg\nYXBwZW5kKCI7IikuZW5kbCgpOwogICAgICAgIGNvZGUudGFiKDMpLmFwcGVu\nZCgiU3RyaW5nIHBhcnQ7IikuZW5kbCgpOwogICAgICAgIGNvZGUudGFiKDMp\nLmFwcGVuZCgiaWYiKS5vcGVuUGFyZW4odHJ1ZSkuYXBwZW5kKCJuZXh0ID09\nIC0xIikuCiAgICAgICAgICAgIGNsb3NlUGFyZW4oKS5vcGVuQnJhY2UoNCku\nZW5kbCgpOwogICAgICAgIGNvZGUudGFiKDQpLmFwcGVuZCgicGFydCA9IHN0\nci5zdWJzdHJpbmciKS5vcGVuUGFyZW4odHJ1ZSkuCiAgICAgICAgICAgIGFw\ncGVuZCgibGFzdCIpLmNsb3NlUGFyZW4oKS5hcHBlbmQoIjsiKS5lbmRsKCk7\nCiAgICAgICAgY29kZS50YWIoNCkuYXBwZW5kKCJsYXN0ID0gc3RyLmxlbmd0\naCIpLnBhcmVucygpLmFwcGVuZCgiOyIpLgogICAgICAgICAgICBlbmRsKCku\nY2xvc2VCcmFjZSg0KTsKICAgICAgICBpZiAoIWNvZGUuZ2V0QnJhY2VPblNh\nbWVMaW5lKCkpCiAgICAgICAgICAgIGNvZGUuZW5kbCgpLnRhYigzKTsKICAg\nICAgICBlbHNlCiAgICAgICAgICAgIGNvZGUuYXBwZW5kKCIgIik7CiAgICAg\nICAgY29kZS5hcHBlbmQoImVsc2UiKS5vcGVuQnJhY2UoNCkuZW5kbCgpOwog\nICAgICAgIGNvZGUudGFiKDQpLmFwcGVuZCgicGFydCA9IHN0ci5zdWJzdHJp\nbmciKS5vcGVuUGFyZW4odHJ1ZSkuCiAgICAgICAgICAgIGFwcGVuZCgibGFz\ndCwgbmV4dCIpLmNsb3NlUGFyZW4oKS5hcHBlbmQoIjsiKS5lbmRsKCk7CiAg\nICAgICAgY29kZS50YWIoNCkuYXBwZW5kKCJsYXN0ID0gbmV4dCArICIpLmFw\ncGVuZChfdG9rZW4ubGVuZ3RoKCkpLgogICAgICAgICAgICBhcHBlbmQoIjsi\nKS5lbmRsKCkuY2xvc2VCcmFjZSg0KS5lbmRsKCk7CgogICAgICAgIGNvZGUu\ndGFiKDMpLmFwcGVuZCgicmV0dXJuIHBhcnQ7IikuZW5kbCgpOwogICAgICAg\nIGNvZGUuY2xvc2VCcmFjZSgzKTsKICAgICAgICBjb2RlLmVuZGwoKS5jbG9z\nZUJyYWNlKDIpOwogICAgICAgIHJldHVybiBjb2RlLnRvU3RyaW5nKCk7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIGZpbGUgdGhhdCB0aGlz\nIHRvb2wgc2hvdWxkIG91dHB1dCB0by4KICAgICAqLwogICAgcHJpdmF0ZSBG\naWxlIGdldEZpbGUoKSB7CiAgICAgICAgaWYgKF9tZXRhID09IG51bGwpCiAg\nICAgICAgICAgIHJldHVybiBudWxsOwoKICAgICAgICBTdHJpbmcgcGFja2Fn\nZU5hbWUgPSBTdHJpbmdzLmdldFBhY2thZ2VOYW1lKF9tZXRhLmdldE9iamVj\ndElkVHlwZSgpKTsKICAgICAgICBTdHJpbmcgZmlsZU5hbWUgPSBTdHJpbmdz\nLmdldENsYXNzTmFtZShfbWV0YS5nZXRPYmplY3RJZFR5cGUoKSkKICAgICAg\nICAgICAgKyAiLmphdmEiOwoKICAgICAgICAvLyBpZiBwYyBjbGFzcyBpbiBz\nYW1lIHBhY2thZ2UgYXMgb2lkIGNsYXNzLCB0cnkgdG8gZmluZCBwYyAuamF2\nYSBmaWxlCiAgICAgICAgRmlsZSBkaXIgPSBudWxsOwogICAgICAgIGlmIChf\nZGlyID09IG51bGwgJiYgU3RyaW5ncy5nZXRQYWNrYWdlTmFtZShfdHlwZSku\nZXF1YWxzKHBhY2thZ2VOYW1lKSkgewogICAgICAgICAgICBkaXIgPSBGaWxl\ncy5nZXRTb3VyY2VGaWxlKF90eXBlKTsKICAgICAgICAgICAgaWYgKGRpciAh\nPSBudWxsKQogICAgICAgICAgICAgICAgZGlyID0gZGlyLmdldFBhcmVudEZp\nbGUoKTsKICAgICAgICB9CiAgICAgICAgaWYgKGRpciA9PSBudWxsKQogICAg\nICAgICAgICBkaXIgPSBGaWxlcy5nZXRQYWNrYWdlRmlsZShfZGlyLCBwYWNr\nYWdlTmFtZSwgdHJ1ZSk7CiAgICAgICAgcmV0dXJuIG5ldyBGaWxlKGRpciwg\nZmlsZU5hbWUpOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIGEgY29w\neSBvZiB0aGUgY29ycmVjdCBjb2RlIGZvcm1hdC4KICAgICAqLwogICAgcHJp\ndmF0ZSBDb2RlRm9ybWF0IG5ld0NvZGVGb3JtYXQoKSB7CiAgICAgICAgcmV0\ndXJuIChfZm9ybWF0ID09IG51bGwpID8gbmV3IENvZGVGb3JtYXQoKQogICAg\nICAgICAgICA6IChDb2RlRm9ybWF0KSBfZm9ybWF0LmNsb25lKCk7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBVc2FnZTogamF2YSBvcmcuYXBhY2hlLm9wZW5q\ncGEuZW5oYW5jZS5BcHBsaWNhdGlvbklkVG9vbCBbb3B0aW9uXSoKICAgICAq\nICZsdDtjbGFzcyBuYW1lIHwgLmphdmEgZmlsZSB8IC5jbGFzcyBmaWxlIHwg\nLmpkbyBmaWxlJmd0OysKICAgICAqICBXaGVyZSB0aGUgZm9sbG93aW5nIG9w\ndGlvbnMgYXJlIHJlY29nbml6ZWQuCiAgICAgKiA8dWw+CiAgICAgKiA8bGk+\nPGk+LXByb3BlcnRpZXMvLXAgJmx0O3Byb3BlcnRpZXMgZmlsZSZndDs8L2k+\nOiBUaGUgcGF0aCB0byBhIE9wZW5KUEEKICAgICAqIHByb3BlcnRpZXMgZmls\nZSBjb250YWluaW5nIGluZm9ybWF0aW9uIGFzIG91dGxpbmVkIGluCiAgICAg\nKiB7QGxpbmsgQ29uZmlndXJhdGlvbn07IG9wdGlvbmFsLjwvbGk+CiAgICAg\nKiA8bGk+PGk+LSZsdDtwcm9wZXJ0eSBuYW1lJmd0OyAmbHQ7cHJvcGVydHkg\ndmFsdWUmZ3Q7PC9pPjogQWxsIGJlYW4KICAgICAqIHByb3BlcnRpZXMgb2Yg\ndGhlIHN0YW5kYXJkIE9wZW5KUEEge0BsaW5rIE9wZW5KUEFDb25maWd1cmF0\naW9ufSBjYW4gYmUKICAgICAqIHNldCBieSB1c2luZyB0aGVpciBuYW1lcyBh\nbmQgc3VwcGx5aW5nIGEgdmFsdWUuPC9saT4KICAgICAqIDxsaT48aT4tZGly\nZWN0b3J5Ly1kICZsdDtvdXRwdXQgZGlyZWN0b3J5Jmd0OzwvaT46IFBhdGgg\ndG8gdGhlIGJhc2UKICAgICAqIHNvdXJjZSBkaXJlY3RvcnkuIFRoZSBwYWNr\nYWdlIHN0cnVjdHVyZSB3aWxsIGJlIGNyZWF0ZWQgYmVuZWF0aAogICAgICog\ndGhpcyBkaXJlY3RvcnkgaWYgbmVjZXNzYXJ5LiBJZiBub3Qgc3BlY2lmaWVk\nLCB0aGUgdG9vbCB3aWxsIHRyeQogICAgICogdG8gbG9jYXRlIHRoZSAuamF2\nYSBmaWxlIGluIHRoZSBDTEFTU1BBVEggYW5kIG91dHB1dCB0byB0aGUgc2Ft\nZQogICAgICogZGlyZWN0b3J5OyBmYWlsaW5nIHRoYXQsIGl0IHdpbGwgdXNl\nIHRoZSBjdXJyZW50IGRpcmVjdG9yeSBhcwogICAgICogdGhlIGJhc2UgZGly\nZWN0b3J5LgogICAgICogPGxpPjxpPi1pZ25vcmVFcnJvcnMvLWkgJmx0O3Ry\ndWUvdCB8IGZhbHNlL2YmZ3Q7PC9pPjogSWYgZmFsc2UsIGFuCiAgICAgKiBl\neGNlcHRpb24gd2lsbCBiZSB0aHJvd24gaWYgdGhlIHRvb2wgZW5jb3VudGVy\ncyBhbnkgY2xhc3MgdGhhdAogICAgICogZG9lcyBub3QgdXNlIGFwcGxpY2F0\naW9uIGlkZW50aXR5IG9yIHVzZXMgdGhlIGlkZW50aXR5IGNsYXNzIG9mCiAg\nICAgKiBpdHMgc3VwZXJjbGFzczsgZGVmYXVsdHMgdG8gdHJ1ZS48L2xpPgog\nICAgICogPGxpPjxpPi10b2tlbi8tdCAmbHQ7dG9rZW4mZ3Q7PC9pPjogVGhl\nIHRva2VuIHRvIHVzZSB0byBzZXBhcmF0ZQogICAgICogc3RpbmdpZmllZCBw\ncmltYXJ5IGtleSBmaWVsZCB2YWx1ZXMgaW4gdGhlIHN0cmluZ2lmaWVkIG9p\nZC48L2xpPgogICAgICogPGxpPjxpPi1uYW1lLy1uICZsdDtpZCBjbGFzcyBu\nYW1lJmd0OzwvaT46IFRoZSBuYW1lIG9mIHRoZSBpZGVudGl0eQogICAgICog\nY2xhc3MgdG8gZ2VuZXJhdGUuIElmIHRoaXMgb3B0aW9uIGlzIHNwZWNpZmll\nZCwgeW91IG11c3Qgb25seQogICAgICogZ2l2ZSBhIHNpbmdsZSBjbGFzcyBh\ncmd1bWVudC4gSWYgdGhlIGNsYXNzIG1ldGFkYXRhIG5hbWVzIGFuIG9iamVj\ndAogICAgICogaWQgY2xhc3MsIHRoaXMgYXJndW1lbnQgaXMgaWdub3JlZC48\nL2xpPgogICAgICogPGxpPjxpPi1zdWZmaXgvLXMgJmx0O2lkIGNsYXNzIHN1\nZmZpeCZndDs8L2k+OiBBIHN0cmluZyB0byBzdWZmaXggZWFjaAogICAgICog\ncGVyc2lzdGVudCBjbGFzcyB3aXRoIHRvIGNyZWF0ZSB0aGUgaWRlbnRpdHkg\nY2xhc3MgbmFtZS4gVGhpcyBpcwogICAgICogb3ZlcnJpZGRlbiBieSA8Y29k\nZT4tbmFtZTwvY29kZT4gb3IgYnkgYW55IGlkZW50aXR5IGNsYXNzIG5hbWUK\nICAgICAqIHNwZWNpZmllZCBpbiBtZXRhZGF0YS48L2xpPgogICAgICogPGxp\nPjxpPi1jb2RlRm9ybWF0Ly1jZi4mbHQ7cHJvcGVydHkgbmFtZSZndDsgJmx0\nOyBwcm9wZXJ0eSB2YWx1ZSZndDs8L2k+CiAgICAgKiA6IEFyZ3VtZW50cyBs\naWtlIHRoaXMgd2lsbCBiZSB1c2VkIHRvIGNvbmZpZ3VyZSB0aGUgYmVhbgog\nICAgICogcHJvcGVydGllcyBvZiB0aGUgaW50ZXJuYWwge0BsaW5rIENvZGVG\nb3JtYXR9LjwvbGk+CiAgICAgKiA8L3VsPgogICAgICogIEVhY2ggYWRkaXRp\nb25hbCBhcmd1bWVudCBjYW4gYmUgZWl0aGVyIHRoZSBmdWxsIGNsYXNzIG5h\nbWUgb2YgdGhlCiAgICAgKiB0eXBlIHRvIGNyZWF0ZSBhbiBpZCBjbGFzcyBm\nb3IsIHRoZSBwYXRoIHRvIHRoZSAuamF2YSBmaWxlIGZvciB0aGUgdHlwZSwK\nICAgICAqIHRoZSBwYXRoIHRvIHRoZSAuY2xhc3MgZmlsZSBmb3IgdGhlIHR5\ncGUsIG9yIHRoZSBwYXRoIHRvIGEgLmpkbyBmaWxlCiAgICAgKiBsaXN0aW5n\nIG9uZSBvciBtb3JlIHR5cGVzLiBJZiBhIC5qYXZhIGZpbGUgYWxyZWFkeSBl\neGlzdHMgZm9yIGFuCiAgICAgKiBhcHBsaWNhdGlvbiBpZCwgaXQgd2lsbCBi\nZSBiYWNrZWQgdXAgdG8gYSBmaWxlIG5hbWVkCiAgICAgKiAmbHQ7b3JpZyBm\naWxlIG5hbWUmZ3Q7fi4KICAgICAqLwogICAgcHVibGljIHN0YXRpYyB2b2lk\nIG1haW4oU3RyaW5nW10gYXJncykKICAgICAgICB0aHJvd3MgSU9FeGNlcHRp\nb24sIENsYXNzTm90Rm91bmRFeGNlcHRpb24gewogICAgICAgIE9wdGlvbnMg\nb3B0cyA9IG5ldyBPcHRpb25zKCk7CiAgICAgICAgZmluYWwgU3RyaW5nW10g\nYXJndW1lbnRzID0gb3B0cy5zZXRGcm9tQ21kTGluZShhcmdzKTsKICAgICAg\nICBib29sZWFuIHJldCA9IENvbmZpZ3VyYXRpb25zLnJ1bkFnYWluc3RBbGxB\nbmNob3JzKG9wdHMsCiAgICAgICAgICAgIG5ldyBDb25maWd1cmF0aW9ucy5S\ndW5uYWJsZSgpIHsKICAgICAgICAgICAgcHVibGljIGJvb2xlYW4gcnVuKE9w\ndGlvbnMgb3B0cykKICAgICAgICAgICAgICAgIHRocm93cyBDbGFzc05vdEZv\ndW5kRXhjZXB0aW9uLCBJT0V4Y2VwdGlvbiB7CiAgICAgICAgICAgICAgICBP\ncGVuSlBBQ29uZmlndXJhdGlvbiBjb25mID0gbmV3IE9wZW5KUEFDb25maWd1\ncmF0aW9uSW1wbCgpOwogICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAg\nICAgICAgICAgICByZXR1cm4gQXBwbGljYXRpb25JZFRvb2wucnVuKGNvbmYs\nIGFyZ3VtZW50cywgb3B0cyk7CiAgICAgICAgICAgICAgICB9IGZpbmFsbHkg\newogICAgICAgICAgICAgICAgICAgIGNvbmYuY2xvc2UoKTsKICAgICAgICAg\nICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0pOwogICAgICAgIGlm\nICghcmV0KQogICAgICAgICAgICBTeXN0ZW0uZXJyLnByaW50bG4oX2xvYy5n\nZXQoImFwcGlkLXVzYWdlIikpOwogICAgfQoKICAgIC8qKgogICAgICogUnVu\nIHRoZSBhcHBsaWNhdGlvbiBpZCB0b29sIHdpdGggdGhlIGdpdmVuIGNvbW1h\nbmQtbGluZSBhbmQKICAgICAqIGdpdmVuIGNvbmZpZ3VyYXRpb24uIFJldHVy\nbnMgZmFsc2UgaWYgaW52YWxpZCBvcHRpb25zIHdlcmUgZ2l2ZW4uCiAgICAg\nKi8KICAgIHB1YmxpYyBzdGF0aWMgYm9vbGVhbiBydW4oT3BlbkpQQUNvbmZp\nZ3VyYXRpb24gY29uZiwgU3RyaW5nW10gYXJncywKICAgICAgICBPcHRpb25z\nIG9wdHMpCiAgICAgICAgdGhyb3dzIElPRXhjZXB0aW9uLCBDbGFzc05vdEZv\ndW5kRXhjZXB0aW9uIHsKICAgICAgICBGbGFncyBmbGFncyA9IG5ldyBGbGFn\ncygpOwogICAgICAgIGZsYWdzLmlnbm9yZUVycm9ycyA9IG9wdHMucmVtb3Zl\nQm9vbGVhblByb3BlcnR5CiAgICAgICAgICAgICgiaWdub3JlRXJyb3JzIiwg\nImkiLCBmbGFncy5pZ25vcmVFcnJvcnMpOwogICAgICAgIGZsYWdzLmRpcmVj\ndG9yeSA9IEZpbGVzLmdldEZpbGUob3B0cy5yZW1vdmVQcm9wZXJ0eSgiZGly\nZWN0b3J5IiwgImQiLAogICAgICAgICAgICBudWxsKSwgbnVsbCk7CiAgICAg\nICAgZmxhZ3MudG9rZW4gPSBvcHRzLnJlbW92ZVByb3BlcnR5KCJ0b2tlbiIs\nICJ0IiwgZmxhZ3MudG9rZW4pOwogICAgICAgIGZsYWdzLm5hbWUgPSBvcHRz\nLnJlbW92ZVByb3BlcnR5KCJuYW1lIiwgIm4iLCBmbGFncy5uYW1lKTsKICAg\nICAgICBmbGFncy5zdWZmaXggPSBvcHRzLnJlbW92ZVByb3BlcnR5KCJzdWZm\naXgiLCAicyIsIGZsYWdzLnN1ZmZpeCk7CgogICAgICAgIC8vIHNlcGFyYXRl\nIHRoZSBwcm9wZXJ0aWVzIGZvciB0aGUgY3VzdG9taXplciBhbmQgY29kZSBm\nb3JtYXQKICAgICAgICBPcHRpb25zIGZvcm1hdE9wdHMgPSBuZXcgT3B0aW9u\ncygpOwogICAgICAgIE1hcC5FbnRyeSBlbnRyeTsKICAgICAgICBTdHJpbmcg\na2V5OwogICAgICAgIGZvciAoSXRlcmF0b3IgaXRyID0gb3B0cy5lbnRyeVNl\ndCgpLml0ZXJhdG9yKCk7IGl0ci5oYXNOZXh0KCk7KSB7CiAgICAgICAgICAg\nIGVudHJ5ID0gKE1hcC5FbnRyeSkgaXRyLm5leHQoKTsKICAgICAgICAgICAg\na2V5ID0gKFN0cmluZykgZW50cnkuZ2V0S2V5KCk7CiAgICAgICAgICAgIGlm\nIChrZXkuc3RhcnRzV2l0aCgiY29kZUZvcm1hdC4iKSkgewogICAgICAgICAg\nICAgICAgZm9ybWF0T3B0cy5wdXQoa2V5LnN1YnN0cmluZygxMSksIGVudHJ5\nLmdldFZhbHVlKCkpOwogICAgICAgICAgICAgICAgaXRyLnJlbW92ZSgpOwog\nICAgICAgICAgICB9IGVsc2UgaWYgKGtleS5zdGFydHNXaXRoKCJjZi4iKSkg\newogICAgICAgICAgICAgICAgZm9ybWF0T3B0cy5wdXQoa2V5LnN1YnN0cmlu\nZygzKSwgZW50cnkuZ2V0VmFsdWUoKSk7CiAgICAgICAgICAgICAgICBpdHIu\ncmVtb3ZlKCk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgaWYg\nKCFmb3JtYXRPcHRzLmlzRW1wdHkoKSkgewogICAgICAgICAgICBmbGFncy5m\nb3JtYXQgPSBuZXcgQ29kZUZvcm1hdCgpOwogICAgICAgICAgICBmb3JtYXRP\ncHRzLnNldEludG8oZmxhZ3MuZm9ybWF0KTsKICAgICAgICB9CgogICAgICAg\nIENvbmZpZ3VyYXRpb25zLnBvcHVsYXRlQ29uZmlndXJhdGlvbihjb25mLCBv\ncHRzKTsKICAgICAgICBDbGFzc0xvYWRlciBsb2FkZXIgPSBjb25mLmdldENs\nYXNzUmVzb2x2ZXJJbnN0YW5jZSgpLgogICAgICAgICAgICBnZXRDbGFzc0xv\nYWRlcihBcHBsaWNhdGlvbklkVG9vbC5jbGFzcywgbnVsbCk7CiAgICAgICAg\ncmV0dXJuIHJ1bihjb25mLCBhcmdzLCBmbGFncywgbG9hZGVyKTsKICAgIH0K\nCiAgICAvKioKICAgICAqIFJ1biB0aGUgdG9vbC4gUmV0dXJucyBmYWxzZSBp\nZiBpbnZhbGlkIG9wdGlvbnMgd2VyZSBnaXZlbi4KICAgICAqLwogICAgcHVi\nbGljIHN0YXRpYyBib29sZWFuIHJ1bihPcGVuSlBBQ29uZmlndXJhdGlvbiBj\nb25mLCBTdHJpbmdbXSBhcmdzLAogICAgICAgIEZsYWdzIGZsYWdzLCBDbGFz\nc0xvYWRlciBsb2FkZXIpCiAgICAgICAgdGhyb3dzIElPRXhjZXB0aW9uLCBD\nbGFzc05vdEZvdW5kRXhjZXB0aW9uIHsKICAgICAgICBNZXRhRGF0YVJlcG9z\naXRvcnkgcmVwb3MgPSBjb25mLm5ld01ldGFEYXRhUmVwb3NpdG9yeUluc3Rh\nbmNlKCk7CiAgICAgICAgcmVwb3Muc2V0VmFsaWRhdGUocmVwb3MuVkFMSURB\nVEVfTk9ORSwgdHJ1ZSk7CiAgICAgICAgbG9hZE9iamVjdElkcyhyZXBvcywg\nZmxhZ3MubmFtZSA9PSBudWxsICYmIGZsYWdzLnN1ZmZpeCA9PSBudWxsKTsK\nCiAgICAgICAgTG9nIGxvZyA9IGNvbmYuZ2V0TG9nKE9wZW5KUEFDb25maWd1\ncmF0aW9uLkxPR19UT09MKTsKICAgICAgICBDb2xsZWN0aW9uIGNsYXNzZXM7\nCiAgICAgICAgaWYgKGFyZ3MubGVuZ3RoID09IDApIHsKICAgICAgICAgICAg\nbG9nLmluZm8oX2xvYy5nZXQoInJ1bm5pbmctYWxsLWNsYXNzZXMiKSk7CiAg\nICAgICAgICAgIGNsYXNzZXMgPSByZXBvcy5sb2FkUGVyc2lzdGVudFR5cGVz\nKHRydWUsIGxvYWRlcik7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAg\nQ2xhc3NBcmdQYXJzZXIgY2FwID0gY29uZi5nZXRNZXRhRGF0YVJlcG9zaXRv\ncnlJbnN0YW5jZSgpLgogICAgICAgICAgICAgICAgZ2V0TWV0YURhdGFGYWN0\nb3J5KCkubmV3Q2xhc3NBcmdQYXJzZXIoKTsKICAgICAgICAgICAgY2FwLnNl\ndENsYXNzTG9hZGVyKGxvYWRlcik7CiAgICAgICAgICAgIGNsYXNzZXMgPSBu\nZXcgSGFzaFNldCgpOwogICAgICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8\nIGFyZ3MubGVuZ3RoOyBpKyspCiAgICAgICAgICAgICAgICBjbGFzc2VzLmFk\nZEFsbChBcnJheXMuYXNMaXN0KGNhcC5wYXJzZVR5cGVzKGFyZ3NbaV0pKSk7\nCiAgICAgICAgfQogICAgICAgIGlmIChmbGFncy5uYW1lICE9IG51bGwgJiYg\nY2xhc3Nlcy5zaXplKCkgPiAxKQogICAgICAgICAgICB0aHJvdyBuZXcgVXNl\nckV4Y2VwdGlvbihfbG9jLmdldCgibmFtZS1tdWx0LWFyZ3MiLCBjbGFzc2Vz\nKSk7CgogICAgICAgIEFwcGxpY2F0aW9uSWRUb29sIHRvb2w7CiAgICAgICAg\nQ2xhc3MgY2xzOwogICAgICAgIENsYXNzTWV0YURhdGEgbWV0YTsKICAgICAg\nICBCQ0NsYXNzTG9hZGVyIGJjID0gKEJDQ2xhc3NMb2FkZXIpIEFjY2Vzc0Nv\nbnRyb2xsZXIKICAgICAgICAgICAgLmRvUHJpdmlsZWdlZChKMkRvUHJpdkhl\nbHBlci5uZXdCQ0NsYXNzTG9hZGVyQWN0aW9uKG5ldyBQcm9qZWN0KCkpKTsK\nICAgICAgICBmb3IgKEl0ZXJhdG9yIGl0ciA9IGNsYXNzZXMuaXRlcmF0b3Io\nKTsgaXRyLmhhc05leHQoKTspIHsKICAgICAgICAgICAgY2xzID0gKENsYXNz\nKSBpdHIubmV4dCgpOwogICAgICAgICAgICBsb2cuaW5mbyhfbG9jLmdldCgi\nYXBwaWQtcnVubmluZyIsIGNscykpOwoKICAgICAgICAgICAgbWV0YSA9IHJl\ncG9zLmdldE1ldGFEYXRhKGNscywgbnVsbCwgZmFsc2UpOwogICAgICAgICAg\nICBzZXRPYmplY3RJZFR5cGUobWV0YSwgZmxhZ3MsIGJjKTsKCiAgICAgICAg\nICAgIHRvb2wgPSBuZXcgQXBwbGljYXRpb25JZFRvb2woY29uZiwgY2xzLCBt\nZXRhKTsKICAgICAgICAgICAgdG9vbC5zZXREaXJlY3RvcnkoZmxhZ3MuZGly\nZWN0b3J5KTsKICAgICAgICAgICAgdG9vbC5zZXRJZ25vcmVFcnJvcnMoZmxh\nZ3MuaWdub3JlRXJyb3JzKTsKICAgICAgICAgICAgdG9vbC5zZXRUb2tlbihm\nbGFncy50b2tlbik7CiAgICAgICAgICAgIHRvb2wuc2V0Q29kZUZvcm1hdChm\nbGFncy5mb3JtYXQpOwogICAgICAgICAgICBpZiAodG9vbC5ydW4oKSkgewog\nICAgICAgICAgICAgICAgbG9nLmluZm8oX2xvYy5nZXQoImFwcGlkLW91dHB1\ndCIsIHRvb2wuZ2V0RmlsZSgpKSk7CiAgICAgICAgICAgICAgICB0b29sLnJl\nY29yZCgpOwogICAgICAgICAgICB9IGVsc2UKICAgICAgICAgICAgICAgIGxv\nZy5pbmZvKF9sb2MuZ2V0KCJhcHBpZC1ub3J1biIpKTsKICAgICAgICB9CiAg\nICAgICAgYmMuZ2V0UHJvamVjdCgpLmNsZWFyKCk7CiAgICAgICAgcmV0dXJu\nIHRydWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBTZXQgdGhlIG9iamVjdCBp\nZCB0eXBlIG9mIHRoZSBnaXZlbiBtZXRhZGF0YS4KICAgICAqLwogICAgcHJp\ndmF0ZSBzdGF0aWMgdm9pZCBzZXRPYmplY3RJZFR5cGUoQ2xhc3NNZXRhRGF0\nYSBtZXRhLCBGbGFncyBmbGFncywKICAgICAgICBCQ0NsYXNzTG9hZGVyIGJj\nKQogICAgICAgIHRocm93cyBDbGFzc05vdEZvdW5kRXhjZXB0aW9uIHsKICAg\nICAgICBpZiAobWV0YSA9PSBudWxsIHx8IChtZXRhLmdldE9iamVjdElkVHlw\nZSgpICE9IG51bGwKICAgICAgICAgICAgJiYgKCFtZXRhLmlzT3BlbkpQQUlk\nZW50aXR5KCkgfHwgZmxhZ3MubmFtZSA9PSBudWxsKSkKICAgICAgICAgICAg\nfHwgZ2V0RGVjbGFyZWRQcmltYXJ5S2V5RmllbGRzKG1ldGEpLmxlbmd0aCA9\nPSAwKQogICAgICAgICAgICByZXR1cm47CgogICAgICAgIENsYXNzIGRlc2Mg\nPSBtZXRhLmdldERlc2NyaWJlZFR5cGUoKTsKICAgICAgICBDbGFzcyBjbHMg\nPSBudWxsOwogICAgICAgIGlmIChmbGFncy5uYW1lICE9IG51bGwpCiAgICAg\nICAgICAgIGNscyA9IGxvYWRDbGFzcyhkZXNjLCBmbGFncy5uYW1lLCBiYyk7\nCiAgICAgICAgZWxzZSBpZiAoZmxhZ3Muc3VmZml4ICE9IG51bGwpCiAgICAg\nICAgICAgIGNscyA9IGxvYWRDbGFzcyhkZXNjLCBkZXNjLmdldE5hbWUoKSAr\nIGZsYWdzLnN1ZmZpeCwgYmMpOwogICAgICAgIG1ldGEuc2V0T2JqZWN0SWRU\neXBlKGNscywgZmFsc2UpOwogICAgfQoKICAgIC8qKgogICAgICogTG9hZCB0\naGUgZ2l2ZW4gY2xhc3MgbmFtZSBldmVuIGlmIGl0IGRvZXMgbm90IGV4aXN0\nLgogICAgICovCiAgICBwcml2YXRlIHN0YXRpYyBDbGFzcyBsb2FkQ2xhc3Mo\nQ2xhc3MgY29udGV4dCwgU3RyaW5nIG5hbWUsCiAgICAgICAgQkNDbGFzc0xv\nYWRlciBiYykKICAgICAgICB0aHJvd3MgQ2xhc3NOb3RGb3VuZEV4Y2VwdGlv\nbiB7CiAgICAgICAgaWYgKG5hbWUuaW5kZXhPZignLicpID09IC0xICYmIGNv\nbnRleHQuZ2V0TmFtZSgpLmluZGV4T2YoJy4nKSAhPSAtMSkKICAgICAgICAg\nICAgbmFtZSA9IFN0cmluZ3MuZ2V0UGFja2FnZU5hbWUoY29udGV4dCkgKyAi\nLiIgKyBuYW1lOwoKICAgICAgICAvLyBmaXJzdCB0cnkgd2l0aCByZWd1bGFy\nIGNsYXNzIGxvYWRlcgogICAgICAgIENsYXNzTG9hZGVyIGxvYWRlciA9IChD\nbGFzc0xvYWRlcikgQWNjZXNzQ29udHJvbGxlci5kb1ByaXZpbGVnZWQoCiAg\nICAgICAgICAgIEoyRG9Qcml2SGVscGVyLmdldENsYXNzTG9hZGVyQWN0aW9u\nKGNvbnRleHQpKTsgCiAgICAgICAgaWYgKGxvYWRlciA9PSBudWxsKQogICAg\nICAgICAgICBsb2FkZXIgPSAoQ2xhc3NMb2FkZXIpIEFjY2Vzc0NvbnRyb2xs\nZXIuZG9Qcml2aWxlZ2VkKAogICAgICAgICAgICAgICAgSjJEb1ByaXZIZWxw\nZXIuZ2V0Q29udGV4dENsYXNzTG9hZGVyQWN0aW9uKCkpOyAKICAgICAgICB0\ncnkgewogICAgICAgICAgICByZXR1cm4gQ2xhc3MuZm9yTmFtZShuYW1lLCBm\nYWxzZSwgbG9hZGVyKTsKICAgICAgICB9IGNhdGNoIChUaHJvd2FibGUgdCkg\newogICAgICAgIH0KCiAgICAgICAgLy8gY3JlYXRlIGNsYXNzCiAgICAgICAg\nQkNDbGFzcyBvaWQgPSBiYy5nZXRQcm9qZWN0KCkubG9hZENsYXNzKG5hbWUs\nIG51bGwpOwogICAgICAgIG9pZC5hZGREZWZhdWx0Q29uc3RydWN0b3IoKTsK\nICAgICAgICByZXR1cm4gQ2xhc3MuZm9yTmFtZShuYW1lLCBmYWxzZSwgYmMp\nOwogICAgfQoKICAgIC8qKgogICAgICogVGVsbCB0aGUgbWV0YWRhdGEgZmFj\ndG9yeSB0byBsb2FkIG9iamVjdCBpZCBjbGFzc2VzIGV2ZW4gaWYgdGhleSBk\nb24ndAogICAgICogZXhpc3QuCiAgICAgKi8KICAgIHByaXZhdGUgc3RhdGlj\nIHZvaWQgbG9hZE9iamVjdElkcyhNZXRhRGF0YVJlcG9zaXRvcnkgcmVwb3Ms\nIGJvb2xlYW4gZmF0YWwpIHsKICAgICAgICBNZXRhRGF0YUZhY3RvcnkgbWRm\nID0gcmVwb3MuZ2V0TWV0YURhdGFGYWN0b3J5KCk7CiAgICAgICAgaWYgKG1k\nZiBpbnN0YW5jZW9mIERlbGVnYXRpbmdNZXRhRGF0YUZhY3RvcnkpCiAgICAg\nICAgICAgIG1kZiA9ICgoRGVsZWdhdGluZ01ldGFEYXRhRmFjdG9yeSkgbWRm\nKS5nZXRJbm5lcm1vc3REZWxlZ2F0ZSgpOwogICAgICAgIGlmIChtZGYgaW5z\ndGFuY2VvZiBPYmplY3RJZExvYWRlcikKICAgICAgICAgICAgKChPYmplY3RJ\nZExvYWRlcikgbWRmKS5zZXRMb2FkT2JqZWN0SWRzKCk7CiAgICAgICAgZWxz\nZSBpZiAoZmF0YWwpCiAgICAgICAgICAgIHRocm93IG5ldyBJbnZhbGlkU3Rh\ndGVFeGNlcHRpb24oX2xvYy5nZXQoImZhY3Rvcnktbm90LW9pZGxvYWRlciIp\nKS4KICAgICAgICAgICAgICAgIHNldEZhdGFsKHRydWUpOwogICAgfQoKICAg\nIC8qKgogICAgICogUnVuIGZsYWdzLgogICAgICovCiAgICBwdWJsaWMgc3Rh\ndGljIGNsYXNzIEZsYWdzIHsKCiAgICAgICAgcHVibGljIEZpbGUgZGlyZWN0\nb3J5ID0gbnVsbDsKICAgICAgICBwdWJsaWMgYm9vbGVhbiBpZ25vcmVFcnJv\ncnMgPSB0cnVlOwogICAgICAgIHB1YmxpYyBTdHJpbmcgdG9rZW4gPSBUT0tF\nTl9ERUZBVUxUOwogICAgICAgIHB1YmxpYyBDb2RlRm9ybWF0IGZvcm1hdCA9\nIG51bGw7CiAgICAgICAgcHVibGljIFN0cmluZyBuYW1lID0gbnVsbDsKICAg\nICAgICBwdWJsaWMgU3RyaW5nIHN1ZmZpeCA9IG51bGw7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBJbnRlcmZhY2UgaW1wbGVtZW50ZWQgYnkgbWV0YWRhdGEg\nZmFjdG9yaWVzIHRoYXQgY2FuIGxvYWQgbm9uLWV4aXN0YW50CiAgICAgKiBv\nYmplY3QgaWQgY2xhc3Nlcy4KICAgICAqLwogICAgcHVibGljIHN0YXRpYyBp\nbnRlcmZhY2UgT2JqZWN0SWRMb2FkZXIKCXsKCQkvKioKCQkgKiBUdXJuIG9u\nIHRoZSBsb2FkaW5nIG9mIGFsbCBpZGVudGl0eSBjbGFzc2VzLCBldmVuIGlm\nIHRoZXkgZG9uJ3QgCiAgICAgICAgICogZXhpc3QuCgkgCSAqLwoJCXB1Ymxp\nYyB2b2lkIHNldExvYWRPYmplY3RJZHMgKCk7Cgl9Cn0K\n","encoding":"base64"}

