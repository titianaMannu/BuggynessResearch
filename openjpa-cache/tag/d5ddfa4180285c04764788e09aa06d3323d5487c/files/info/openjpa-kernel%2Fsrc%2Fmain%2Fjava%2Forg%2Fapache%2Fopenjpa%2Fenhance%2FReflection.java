{"sha":"bd8996873458f0bd3db944aa85be774b224ab229","node_id":"MDQ6QmxvYjIwNjM2NDpiZDg5OTY4NzM0NThmMGJkM2RiOTQ0YWE4NWJlNzc0YjIyNGFiMjI5","size":23687,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/bd8996873458f0bd3db944aa85be774b224ab229","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuZW5oYW5jZTsKCmltcG9ydCBq\nYXZhLmxhbmcucmVmbGVjdC5BY2Nlc3NpYmxlT2JqZWN0OwppbXBvcnQgamF2\nYS5sYW5nLnJlZmxlY3QuRmllbGQ7CmltcG9ydCBqYXZhLmxhbmcucmVmbGVj\ndC5JbnZvY2F0aW9uVGFyZ2V0RXhjZXB0aW9uOwppbXBvcnQgamF2YS5sYW5n\nLnJlZmxlY3QuTWV0aG9kOwppbXBvcnQgamF2YS5sYW5nLnJlZmxlY3QuTW9k\naWZpZXI7CmltcG9ydCBqYXZhLnNlY3VyaXR5LkFjY2Vzc0NvbnRyb2xsZXI7\nCgppbXBvcnQgb3JnLmFwYWNoZS5jb21tb25zLmxhbmcuU3RyaW5nVXRpbHM7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuSjJEb1ByaXZI\nZWxwZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuTG9j\nYWxpemVyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuR2VuZXJh\nbEV4Y2VwdGlvbjsgCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5V\nc2VyRXhjZXB0aW9uOyAKCi8qKgogKiBSZWZsZWN0aW9uIHV0aWxpdGllcyB1\nc2VkIHRvIHN1cHBvcnQgYW5kIGF1Z21lbnQgZW5oYW5jZW1lbnQuICBVc2Vk\nIGJvdGgKICogYXQgZW5oYW5jZW1lbnQgdGltZSBhbmQgYXQgcnVudGltZS4K\nICoKICogQGF1dGhvciBBYmUgV2hpdGUKICovCnB1YmxpYyBjbGFzcyBSZWZs\nZWN0aW9uIHsKCiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBMb2NhbGl6ZXIg\nX2xvYyA9IExvY2FsaXplci5mb3JQYWNrYWdlCiAgICAgICAgKFJlZmxlY3Rp\nb24uY2xhc3MpOwoKICAgIC8qKgogICAgICogUmV0dXJuIHRoZSBnZXR0ZXIg\nbWV0aG9kIG1hdGNoaW5nIHRoZSBnaXZlbiBwcm9wZXJ0eSBuYW1lLCBvcHRp\nb25hbGx5CiAgICAgKiB0aHJvd2luZyBhbiBleGNlcHRpb24gaWYgbm9uZS4K\nICAgICAqLwogICAgcHVibGljIHN0YXRpYyBNZXRob2QgZmluZEdldHRlcihD\nbGFzcyBjbHMsIFN0cmluZyBwcm9wLCBib29sZWFuIG11c3RFeGlzdCkgewog\nICAgICAgIHByb3AgPSBTdHJpbmdVdGlscy5jYXBpdGFsaXplKHByb3ApOwog\nICAgICAgIFN0cmluZyBuYW1lID0gImdldCIgKyBwcm9wOwogICAgICAgIE1l\ndGhvZCBtOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIC8vIHRoaXMgYWxn\nb3JpdGhtIHNlYXJjaGVzIGZvciBhIGdldDxwcm9wPiBvciBpczxwcm9wPiBt\nZXRob2QgaW4KICAgICAgICAgICAgLy8gYSBicmVhZHRoLWZpcnN0IG1hbm5l\nci4KICAgICAgICAgICAgZm9yIChDbGFzcyBjID0gY2xzOyBjICE9IG51bGwg\nJiYgYyAhPSBPYmplY3QuY2xhc3M7CiAgICAgICAgICAgICAgICBjID0gYy5n\nZXRTdXBlcmNsYXNzKCkpIHsKICAgICAgICAgICAgICAgIG0gPSBnZXREZWNs\nYXJlZE1ldGhvZChjLCBuYW1lLCBudWxsKTsKICAgICAgICAgICAgICAgIGlm\nIChtICE9IG51bGwpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gbTsK\nICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAg\nbSA9IGdldERlY2xhcmVkTWV0aG9kKGMsICJpcyIgKyBwcm9wLCBudWxsKTsK\nICAgICAgICAgICAgICAgICAgICBpZiAobSAhPSBudWxsICYmIChtLmdldFJl\ndHVyblR5cGUoKSA9PSBib29sZWFuLmNsYXNzCiAgICAgICAgICAgICAgICAg\nICAgICAgIHx8IG0uZ2V0UmV0dXJuVHlwZSgpID09IEJvb2xlYW4uY2xhc3Mp\nKQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbTsKICAgICAgICAg\nICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0gY2F0Y2ggKEV4Y2Vw\ndGlvbiBlKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBHZW5lcmFsRXhjZXB0\naW9uKGUpOwogICAgICAgIH0KCiAgICAgICAgaWYgKG11c3RFeGlzdCkKICAg\nICAgICAgICAgdGhyb3cgbmV3IFVzZXJFeGNlcHRpb24oX2xvYy5nZXQoImJh\nZC1nZXR0ZXIiLCBjbHMsIHByb3ApKTsKICAgICAgICByZXR1cm4gbnVsbDsK\nICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgc2V0dGVyIG1ldGhv\nZCBtYXRjaGluZyB0aGUgZ2l2ZW4gcHJvcGVydHkgbmFtZSwgb3B0aW9uYWxs\neQogICAgICogdGhyb3dpbmcgYW4gZXhjZXB0aW9uIGlmIG5vbmUuICBUaGUg\ncHJvcGVydHkgbXVzdCBhbHNvIGhhdmUgYSBnZXR0ZXIuCiAgICAgKi8KICAg\nIHB1YmxpYyBzdGF0aWMgTWV0aG9kIGZpbmRTZXR0ZXIoQ2xhc3MgY2xzLCBT\ndHJpbmcgcHJvcCwgYm9vbGVhbiBtdXN0RXhpc3QpIHsKICAgICAgICBNZXRo\nb2QgZ2V0dGVyID0gZmluZEdldHRlcihjbHMsIHByb3AsIG11c3RFeGlzdCk7\nCiAgICAgICAgcmV0dXJuIChnZXR0ZXIgPT0gbnVsbCkgPyBudWxsIAogICAg\nICAgICAgICA6IGZpbmRTZXR0ZXIoY2xzLCBwcm9wLCBnZXR0ZXIuZ2V0UmV0\ndXJuVHlwZSgpLCBtdXN0RXhpc3QpOwogICAgfQoKICAgIC8qKgogICAgICog\nUmV0dXJuIHRoZSBzZXR0ZXIgbWV0aG9kIG1hdGNoaW5nIHRoZSBnaXZlbiBw\ncm9wZXJ0eSBuYW1lLCBvcHRpb25hbGx5CiAgICAgKiB0aHJvd2luZyBhbiBl\neGNlcHRpb24gaWYgbm9uZS4KICAgICAqLwogICAgcHVibGljIHN0YXRpYyBN\nZXRob2QgZmluZFNldHRlcihDbGFzcyBjbHMsIFN0cmluZyBwcm9wLCBDbGFz\ncyBwYXJhbSwKICAgICAgICBib29sZWFuIG11c3RFeGlzdCkgewogICAgICAg\nIFN0cmluZyBuYW1lID0gInNldCIgKyBTdHJpbmdVdGlscy5jYXBpdGFsaXpl\nKHByb3ApOwogICAgICAgIE1ldGhvZCBtOwogICAgICAgIHRyeSB7CiAgICAg\nICAgICAgIGZvciAoQ2xhc3MgYyA9IGNsczsgYyAhPSBudWxsICYmIGMgIT0g\nT2JqZWN0LmNsYXNzOwogICAgICAgICAgICAgICAgYyA9IGMuZ2V0U3VwZXJj\nbGFzcygpKSB7CiAgICAgICAgICAgICAgICBtID0gZ2V0RGVjbGFyZWRNZXRo\nb2QoYywgbmFtZSwgcGFyYW0pOwogICAgICAgICAgICAgICAgaWYgKG0gIT0g\nbnVsbCkKICAgICAgICAgICAgICAgICAgICByZXR1cm4gbTsKICAgICAgICAg\nICAgfQogICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAg\nICAgIHRocm93IG5ldyBHZW5lcmFsRXhjZXB0aW9uKGUpOwogICAgICAgIH0K\nCiAgICAgICAgaWYgKG11c3RFeGlzdCkKICAgICAgICAgICAgdGhyb3cgbmV3\nIFVzZXJFeGNlcHRpb24oX2xvYy5nZXQoImJhZC1zZXR0ZXIiLCBjbHMsIHBy\nb3ApKTsKICAgICAgICByZXR1cm4gbnVsbDsKICAgIH0KCiAgICAvKioKICAg\nICAqIEludm9rZXMgPGNvZGU+Y2xzLmdldERlY2xhcmVkTWV0aG9kcygpPC9j\nb2RlPiwgYW5kIHJldHVybnMgdGhlIG1ldGhvZAogICAgICogdGhhdCBtYXRj\naGVzIHRoZSA8Y29kZT5uYW1lPC9jb2RlPiBhbmQgPGNvZGU+cGFyYW08L2Nv\nZGU+IGFyZ3VtZW50cy4KICAgICAqIEF2b2lkcyB0aGUgZXhjZXB0aW9uIHRo\ncm93biBieSA8Y29kZT5DbGFzcy5nZXREZWNsYXJlZE1ldGhvZCgpPC9jb2Rl\nPgogICAgICogZm9yIHBlcmZvcm1hbmNlIHJlYXNvbnMuIDxjb2RlPnBhcmFt\nPC9jb2RlPiBtYXkgYmUgbnVsbC4gQWRkaXRpb25hbGx5LAogICAgICogaWYg\ndGhlcmUgYXJlIG11bHRpcGxlIG1ldGhvZHMgd2l0aCBkaWZmZXJlbnQgcmV0\ndXJuIHR5cGVzLCB0aGlzIHdpbGwKICAgICAqIHJldHVybiB0aGUgbWV0aG9k\nIGRlZmluZWQgaW4gdGhlIGxlYXN0LWRlcml2ZWQgY2xhc3MuCiAgICAgKgog\nICAgICogQHNpbmNlIDAuOS44CiAgICAgKi8KICAgIHN0YXRpYyBNZXRob2Qg\nZ2V0RGVjbGFyZWRNZXRob2QoQ2xhc3MgY2xzLCBTdHJpbmcgbmFtZSwKICAg\nICAgICBDbGFzcyBwYXJhbSkgewogICAgICAgIE1ldGhvZFtdIG1ldGhvZHMg\nPSAoTWV0aG9kW10pIEFjY2Vzc0NvbnRyb2xsZXIuZG9Qcml2aWxlZ2VkKAog\nICAgICAgICAgICBKMkRvUHJpdkhlbHBlci5nZXREZWNsYXJlZE1ldGhvZHNB\nY3Rpb24oY2xzKSk7CiAgICAgICAgTWV0aG9kIGNhbmRpZGF0ZSA9IG51bGw7\nCiAgICAgICAgZm9yIChpbnQgaSA9IDAgOyBpIDwgbWV0aG9kcy5sZW5ndGg7\nIGkrKykgewogICAgCSAgICBpZiAobmFtZS5lcXVhbHMobWV0aG9kc1tpXS5n\nZXROYW1lKCkpKSB7CiAgICAgICAgICAgICAgICBDbGFzc1tdIG1ldGhvZFBh\ncmFtcyA9IG1ldGhvZHNbaV0uZ2V0UGFyYW1ldGVyVHlwZXMoKTsKICAgICAg\nICAgICAgICAgIGlmIChwYXJhbSA9PSBudWxsICYmIG1ldGhvZFBhcmFtcy5s\nZW5ndGggPT0gMCkKICAgICAgICAgICAgICAgICAgICBjYW5kaWRhdGUgPSBt\nb3N0RGVyaXZlZChtZXRob2RzW2ldLCBjYW5kaWRhdGUpOwogICAgICAgICAg\nICAgICAgZWxzZSBpZiAocGFyYW0gIT0gbnVsbCAmJiBtZXRob2RQYXJhbXMu\nbGVuZ3RoID09IDEKICAgICAgICAgICAgICAgICAgICAmJiBwYXJhbS5lcXVh\nbHMobWV0aG9kUGFyYW1zWzBdKSkKICAgICAgICAgICAgICAgICAgICBjYW5k\naWRhdGUgPSBtb3N0RGVyaXZlZChtZXRob2RzW2ldLCBjYW5kaWRhdGUpOwog\nICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiBjYW5kaWRh\ndGU7CiAgICB9CgogICAgc3RhdGljIE1ldGhvZCBtb3N0RGVyaXZlZChNZXRo\nb2QgbWV0aDEsIE1ldGhvZCBtZXRoMikgewogICAgICAgIGlmIChtZXRoMSA9\nPSBudWxsKQogICAgICAgICAgICByZXR1cm4gbWV0aDI7CiAgICAgICAgaWYg\nKG1ldGgyID09IG51bGwpCiAgICAgICAgICAgIHJldHVybiBtZXRoMTsKICAg\nICAgICAKICAgICAgICBDbGFzcyBjbHMyID0gbWV0aDIuZ2V0RGVjbGFyaW5n\nQ2xhc3MoKTsKICAgICAgICBDbGFzcyBjbHMxID0gbWV0aDEuZ2V0RGVjbGFy\naW5nQ2xhc3MoKTsKCiAgICAgICAgaWYgKGNsczEuZXF1YWxzKGNsczIpKSB7\nCiAgICAgICAgICAgIENsYXNzIHJldDEgPSBtZXRoMS5nZXRSZXR1cm5UeXBl\nKCk7CiAgICAgICAgICAgIENsYXNzIHJldDIgPSBtZXRoMi5nZXRSZXR1cm5U\neXBlKCk7CiAgICAgICAgICAgIGlmIChyZXQxLmlzQXNzaWduYWJsZUZyb20o\ncmV0MikpCiAgICAgICAgICAgICAgICByZXR1cm4gbWV0aDI7CiAgICAgICAg\nICAgIGVsc2UgaWYgKHJldDIuaXNBc3NpZ25hYmxlRnJvbShyZXQxKSkKICAg\nICAgICAgICAgICAgIHJldHVybiBtZXRoMTsKICAgICAgICAgICAgZWxzZQog\nICAgICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2Vw\ndGlvbigKICAgICAgICAgICAgICAgICAgICBfbG9jLmdldCgibW9zdC1kZXJp\ndmVkLXVucmVsYXRlZC1zYW1lLXR5cGUiLCBtZXRoMSwgbWV0aDIpCiAgICAg\nICAgICAgICAgICAgICAgICAgIC5nZXRNZXNzYWdlKCkpOwogICAgICAgIH0g\nZWxzZSB7CiAgICAgICAgICAgIGlmIChjbHMxLmlzQXNzaWduYWJsZUZyb20o\nY2xzMikpCiAgICAgICAgICAgICAgICByZXR1cm4gbWV0aDI7CiAgICAgICAg\nICAgIGVsc2UgaWYgKGNsczIuaXNBc3NpZ25hYmxlRnJvbShjbHMxKSkKICAg\nICAgICAgICAgICAgIHJldHVybiBtZXRoMTsKICAgICAgICAgICAgZWxzZQog\nICAgICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2Vw\ndGlvbigKICAgICAgICAgICAgICAgICAgICBfbG9jLmdldCgibW9zdC1kZXJp\ndmVkLXVucmVsYXRlZCIsIG1ldGgxLCBtZXRoMikKICAgICAgICAgICAgICAg\nICAgICAgICAgLmdldE1lc3NhZ2UoKSk7CiAgICAgICAgfQogICAgfQoKICAg\nIC8qKgogICAgICogUmV0dXJuIHRoZSBmaWVsZCB3aXRoIHRoZSBnaXZlbiBu\nYW1lLCBvcHRpb25hbGx5IHRocm93aW5nIGFuIGV4Y2VwdGlvbgogICAgICog\naWYgbm9uZS4KICAgICAqLwogICAgcHVibGljIHN0YXRpYyBGaWVsZCBmaW5k\nRmllbGQoQ2xhc3MgY2xzLCBTdHJpbmcgbmFtZSwgYm9vbGVhbiBtdXN0RXhp\nc3QpIHsKICAgICAgICB0cnkgewogICAgICAgICAgICBGaWVsZCBmOwogICAg\nICAgICAgICBmb3IgKENsYXNzIGMgPSBjbHM7IGMgIT0gbnVsbCAmJiBjICE9\nIE9iamVjdC5jbGFzczsKICAgICAgICAgICAgICAgIGMgPSBjLmdldFN1cGVy\nY2xhc3MoKSkgewogICAgICAgICAgICAgICAgZiA9IGdldERlY2xhcmVkRmll\nbGQoYywgbmFtZSk7CiAgICAgICAgICAgICAgICBpZiAoZiAhPSBudWxsKQog\nICAgICAgICAgICAgICAgICAgIHJldHVybiBmOwogICAgICAgICAgICB9CiAg\nICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgdGhy\nb3cgbmV3IEdlbmVyYWxFeGNlcHRpb24oZSk7CiAgICAgICAgfQoKICAgICAg\nICBpZiAobXVzdEV4aXN0KQogICAgICAgICAgICB0aHJvdyBuZXcgVXNlckV4\nY2VwdGlvbihfbG9jLmdldCgiYmFkLWZpZWxkIiwgY2xzLCBuYW1lKSk7CiAg\nICAgICAgcmV0dXJuIG51bGw7CiAgICB9CgogICAgLyoqCiAgICAgKiBJbnZv\na2VzIDxjb2RlPmNscy5nZXREZWNsYXJlZEZpZWxkcygpPC9jb2RlPiwgYW5k\nIHJldHVybnMgdGhlIGZpZWxkCiAgICAgKiB0aGF0IG1hdGNoZXMgdGhlIDxj\nb2RlPm5hbWU8L2NvZGU+IGFyZ3VtZW50LiAgQXZvaWRzIHRoZSBleGNlcHRp\nb24KICAgICAqIHRocm93biBieSA8Y29kZT5DbGFzcy5nZXREZWNsYXJlZEZp\nZWxkKCk8L2NvZGU+IGZvciBwZXJmb3JtYW5jZSByZWFzb25zLgogICAgICoK\nICAgICAqIEBzaW5jZSAwLjkuOAogICAgICovCiAgICBwcml2YXRlIHN0YXRp\nYyBGaWVsZCBnZXREZWNsYXJlZEZpZWxkKENsYXNzIGNscywgU3RyaW5nIG5h\nbWUpIHsKICAgICAgICBGaWVsZFtdIGZpZWxkcyA9IChGaWVsZFtdKSBBY2Nl\nc3NDb250cm9sbGVyLmRvUHJpdmlsZWdlZCgKICAgICAgICAgICAgSjJEb1By\naXZIZWxwZXIuZ2V0RGVjbGFyZWRGaWVsZHNBY3Rpb24oY2xzKSk7CiAgICAg\nICAgZm9yIChpbnQgaSA9IDAgOyBpIDwgZmllbGRzLmxlbmd0aDsgaSsrKSB7\nCiAgICAJICAgIGlmIChuYW1lLmVxdWFscyhmaWVsZHNbaV0uZ2V0TmFtZSgp\nKSkKCQkgICAgICAgIHJldHVybiBmaWVsZHNbaV07CiAgICAgICAgfQogICAg\nICAgIHJldHVybiBudWxsOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJu\nIHRoZSB2YWx1ZSBvZiB0aGUgZ2l2ZW4gZmllbGQgaW4gdGhlIGdpdmVuIG9i\namVjdC4KICAgICAqLwogICAgcHVibGljIHN0YXRpYyBPYmplY3QgZ2V0KE9i\namVjdCB0YXJnZXQsIEZpZWxkIGZpZWxkKSB7CiAgICAgICAgaWYgKHRhcmdl\ndCA9PSBudWxsIHx8IGZpZWxkID09IG51bGwpCiAgICAgICAgICAgIHJldHVy\nbiBudWxsOwogICAgICAgIG1ha2VBY2Nlc3NpYmxlKGZpZWxkLCBmaWVsZC5n\nZXRNb2RpZmllcnMoKSk7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgcmV0\ndXJuIGZpZWxkLmdldCh0YXJnZXQpOwogICAgICAgIH0gY2F0Y2ggKFRocm93\nYWJsZSB0KSB7CiAgICAgICAgICAgIHRocm93IHdyYXBSZWZsZWN0aW9uRXhj\nZXB0aW9uKHQpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIE1h\na2UgdGhlIGdpdmVuIG1lbWJlciBhY2Nlc3NpYmxlIGlmIGl0IGlzbid0IGFs\ncmVhZHkuCiAgICAgKi8KICAgIHByaXZhdGUgc3RhdGljIHZvaWQgbWFrZUFj\nY2Vzc2libGUoQWNjZXNzaWJsZU9iamVjdCBhbywgaW50IG1vZHMpIHsKICAg\nICAgICB0cnkgewogICAgICAgICAgICBpZiAoIU1vZGlmaWVyLmlzUHVibGlj\nKG1vZHMpICYmICFhby5pc0FjY2Vzc2libGUoKSkKICAgICAgICAgICAgICAg\nIEFjY2Vzc0NvbnRyb2xsZXIuZG9Qcml2aWxlZ2VkKEoyRG9Qcml2SGVscGVy\nCiAgICAgICAgICAgICAgICAgICAgLnNldEFjY2Vzc2libGVBY3Rpb24oYW8s\nIHRydWUpKTsKICAgICAgICB9IGNhdGNoIChTZWN1cml0eUV4Y2VwdGlvbiBz\nZSkgewogICAgICAgICAgICB0aHJvdyBuZXcgVXNlckV4Y2VwdGlvbihfbG9j\nLmdldCgicmVmbGVjdC1zZWN1cml0eSIsIGFvKSkuCiAgICAgICAgICAgICAg\nICBzZXRGYXRhbCh0cnVlKTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAg\nICAgKiBXcmFwIHRoZSBnaXZlbiByZWZsZWN0aW9uIGV4Y2VwdGlvbiBhcyBh\nIHJ1bnRpbWUgZXhjZXB0aW9uLgogICAgICovCiAgICBwcml2YXRlIHN0YXRp\nYyBSdW50aW1lRXhjZXB0aW9uIHdyYXBSZWZsZWN0aW9uRXhjZXB0aW9uKFRo\ncm93YWJsZSB0KSB7CiAgICAgICAgaWYgKHQgaW5zdGFuY2VvZiBJbnZvY2F0\naW9uVGFyZ2V0RXhjZXB0aW9uKQogICAgICAgICAgICB0ID0gKChJbnZvY2F0\naW9uVGFyZ2V0RXhjZXB0aW9uKSB0KS5nZXRUYXJnZXRFeGNlcHRpb24oKTsg\nICAgCiAgICAgICAgaWYgKHQgaW5zdGFuY2VvZiBSdW50aW1lRXhjZXB0aW9u\nKQogICAgICAgICAgICByZXR1cm4gKFJ1bnRpbWVFeGNlcHRpb24pIHQ7CiAg\nICAgICAgcmV0dXJuIG5ldyBHZW5lcmFsRXhjZXB0aW9uKHQpOwogICAgfQoK\nICAgIC8qKgogICAgICogUmV0dXJuIHRoZSB2YWx1ZSBvZiB0aGUgZ2l2ZW4g\nZmllbGQgaW4gdGhlIGdpdmVuIG9iamVjdC4KICAgICAqLwogICAgcHVibGlj\nIHN0YXRpYyBib29sZWFuIGdldEJvb2xlYW4oT2JqZWN0IHRhcmdldCwgRmll\nbGQgZmllbGQpIHsKICAgICAgICBpZiAodGFyZ2V0ID09IG51bGwgfHwgZmll\nbGQgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAg\nIG1ha2VBY2Nlc3NpYmxlKGZpZWxkLCBmaWVsZC5nZXRNb2RpZmllcnMoKSk7\nCiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgcmV0dXJuIGZpZWxkLmdldEJv\nb2xlYW4odGFyZ2V0KTsKICAgICAgICB9IGNhdGNoIChUaHJvd2FibGUgdCkg\newogICAgICAgICAgICB0aHJvdyB3cmFwUmVmbGVjdGlvbkV4Y2VwdGlvbih0\nKTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhl\nIHZhbHVlIG9mIHRoZSBnaXZlbiBmaWVsZCBpbiB0aGUgZ2l2ZW4gb2JqZWN0\nLgogICAgICovCiAgICBwdWJsaWMgc3RhdGljIGJ5dGUgZ2V0Qnl0ZShPYmpl\nY3QgdGFyZ2V0LCBGaWVsZCBmaWVsZCkgewogICAgICAgIGlmICh0YXJnZXQg\nPT0gbnVsbCB8fCBmaWVsZCA9PSBudWxsKQogICAgICAgICAgICByZXR1cm4g\nKGJ5dGUpIDA7CiAgICAgICAgbWFrZUFjY2Vzc2libGUoZmllbGQsIGZpZWxk\nLmdldE1vZGlmaWVycygpKTsKICAgICAgICB0cnkgewogICAgICAgICAgICBy\nZXR1cm4gZmllbGQuZ2V0Qnl0ZSh0YXJnZXQpOwogICAgICAgIH0gY2F0Y2gg\nKFRocm93YWJsZSB0KSB7CiAgICAgICAgICAgIHRocm93IHdyYXBSZWZsZWN0\naW9uRXhjZXB0aW9uKHQpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAg\nICAqIFJldHVybiB0aGUgdmFsdWUgb2YgdGhlIGdpdmVuIGZpZWxkIGluIHRo\nZSBnaXZlbiBvYmplY3QuCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0aWMgY2hh\nciBnZXRDaGFyKE9iamVjdCB0YXJnZXQsIEZpZWxkIGZpZWxkKSB7CiAgICAg\nICAgaWYgKHRhcmdldCA9PSBudWxsIHx8IGZpZWxkID09IG51bGwpCiAgICAg\nICAgICAgIHJldHVybiAoY2hhcikgMDsKICAgICAgICBtYWtlQWNjZXNzaWJs\nZShmaWVsZCwgZmllbGQuZ2V0TW9kaWZpZXJzKCkpOwogICAgICAgIHRyeSB7\nCiAgICAgICAgICAgIHJldHVybiBmaWVsZC5nZXRDaGFyKHRhcmdldCk7CiAg\nICAgICAgfSBjYXRjaCAoVGhyb3dhYmxlIHQpIHsKICAgICAgICAgICAgdGhy\nb3cgd3JhcFJlZmxlY3Rpb25FeGNlcHRpb24odCk7CiAgICAgICAgfQogICAg\nfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRoZSB2YWx1ZSBvZiB0aGUgZ2l2\nZW4gZmllbGQgaW4gdGhlIGdpdmVuIG9iamVjdC4KICAgICAqLwogICAgcHVi\nbGljIHN0YXRpYyBkb3VibGUgZ2V0RG91YmxlKE9iamVjdCB0YXJnZXQsIEZp\nZWxkIGZpZWxkKSB7CiAgICAgICAgaWYgKHRhcmdldCA9PSBudWxsIHx8IGZp\nZWxkID09IG51bGwpCiAgICAgICAgICAgIHJldHVybiAwRDsKICAgICAgICBt\nYWtlQWNjZXNzaWJsZShmaWVsZCwgZmllbGQuZ2V0TW9kaWZpZXJzKCkpOwog\nICAgICAgIHRyeSB7CiAgICAgICAgICAgIHJldHVybiBmaWVsZC5nZXREb3Vi\nbGUodGFyZ2V0KTsKICAgICAgICB9IGNhdGNoIChUaHJvd2FibGUgdCkgewog\nICAgICAgICAgICB0aHJvdyB3cmFwUmVmbGVjdGlvbkV4Y2VwdGlvbih0KTsK\nICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIHZh\nbHVlIG9mIHRoZSBnaXZlbiBmaWVsZCBpbiB0aGUgZ2l2ZW4gb2JqZWN0Lgog\nICAgICovCiAgICBwdWJsaWMgc3RhdGljIGZsb2F0IGdldEZsb2F0KE9iamVj\ndCB0YXJnZXQsIEZpZWxkIGZpZWxkKSB7CiAgICAgICAgaWYgKHRhcmdldCA9\nPSBudWxsIHx8IGZpZWxkID09IG51bGwpCiAgICAgICAgICAgIHJldHVybiAw\nRjsKICAgICAgICBtYWtlQWNjZXNzaWJsZShmaWVsZCwgZmllbGQuZ2V0TW9k\naWZpZXJzKCkpOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIHJldHVybiBm\naWVsZC5nZXRGbG9hdCh0YXJnZXQpOwogICAgICAgIH0gY2F0Y2ggKFRocm93\nYWJsZSB0KSB7CiAgICAgICAgICAgIHRocm93IHdyYXBSZWZsZWN0aW9uRXhj\nZXB0aW9uKHQpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIFJl\ndHVybiB0aGUgdmFsdWUgb2YgdGhlIGdpdmVuIGZpZWxkIGluIHRoZSBnaXZl\nbiBvYmplY3QuCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0aWMgaW50IGdldElu\ndChPYmplY3QgdGFyZ2V0LCBGaWVsZCBmaWVsZCkgewogICAgICAgIGlmICh0\nYXJnZXQgPT0gbnVsbCB8fCBmaWVsZCA9PSBudWxsKQogICAgICAgICAgICBy\nZXR1cm4gMDsKICAgICAgICBtYWtlQWNjZXNzaWJsZShmaWVsZCwgZmllbGQu\nZ2V0TW9kaWZpZXJzKCkpOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIHJl\ndHVybiBmaWVsZC5nZXRJbnQodGFyZ2V0KTsKICAgICAgICB9IGNhdGNoIChU\naHJvd2FibGUgdCkgewogICAgICAgICAgICB0aHJvdyB3cmFwUmVmbGVjdGlv\nbkV4Y2VwdGlvbih0KTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAg\nKiBSZXR1cm4gdGhlIHZhbHVlIG9mIHRoZSBnaXZlbiBmaWVsZCBpbiB0aGUg\nZ2l2ZW4gb2JqZWN0LgogICAgICovCiAgICBwdWJsaWMgc3RhdGljIGxvbmcg\nZ2V0TG9uZyhPYmplY3QgdGFyZ2V0LCBGaWVsZCBmaWVsZCkgewogICAgICAg\nIGlmICh0YXJnZXQgPT0gbnVsbCB8fCBmaWVsZCA9PSBudWxsKQogICAgICAg\nICAgICByZXR1cm4gMEw7CiAgICAgICAgbWFrZUFjY2Vzc2libGUoZmllbGQs\nIGZpZWxkLmdldE1vZGlmaWVycygpKTsKICAgICAgICB0cnkgewogICAgICAg\nICAgICByZXR1cm4gZmllbGQuZ2V0TG9uZyh0YXJnZXQpOwogICAgICAgIH0g\nY2F0Y2ggKFRocm93YWJsZSB0KSB7CiAgICAgICAgICAgIHRocm93IHdyYXBS\nZWZsZWN0aW9uRXhjZXB0aW9uKHQpOwogICAgICAgIH0KICAgIH0KCiAgICAv\nKioKICAgICAqIFJldHVybiB0aGUgdmFsdWUgb2YgdGhlIGdpdmVuIGZpZWxk\nIGluIHRoZSBnaXZlbiBvYmplY3QuCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0\naWMgc2hvcnQgZ2V0U2hvcnQoT2JqZWN0IHRhcmdldCwgRmllbGQgZmllbGQp\nIHsKICAgICAgICBpZiAodGFyZ2V0ID09IG51bGwgfHwgZmllbGQgPT0gbnVs\nbCkKICAgICAgICAgICAgcmV0dXJuIChzaG9ydCkgMDsKICAgICAgICBtYWtl\nQWNjZXNzaWJsZShmaWVsZCwgZmllbGQuZ2V0TW9kaWZpZXJzKCkpOwogICAg\nICAgIHRyeSB7CiAgICAgICAgICAgIHJldHVybiBmaWVsZC5nZXRTaG9ydCh0\nYXJnZXQpOwogICAgICAgIH0gY2F0Y2ggKFRocm93YWJsZSB0KSB7CiAgICAg\nICAgICAgIHRocm93IHdyYXBSZWZsZWN0aW9uRXhjZXB0aW9uKHQpOwogICAg\nICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgcmV0dXJu\nIHZhbHVlIG9mIHRoZSBnaXZlbiBnZXR0ZXIgaW4gdGhlIGdpdmVuIG9iamVj\ndC4KICAgICAqLwogICAgcHVibGljIHN0YXRpYyBPYmplY3QgZ2V0KE9iamVj\ndCB0YXJnZXQsIE1ldGhvZCBnZXR0ZXIpIHsKICAgICAgICBpZiAodGFyZ2V0\nID09IG51bGwgfHwgZ2V0dGVyID09IG51bGwpCiAgICAgICAgICAgIHJldHVy\nbiBudWxsOwogICAgICAgIG1ha2VBY2Nlc3NpYmxlKGdldHRlciwgZ2V0dGVy\nLmdldE1vZGlmaWVycygpKTsKICAgICAgICB0cnkgewogICAgICAgICAgICBy\nZXR1cm4gZ2V0dGVyLmludm9rZSh0YXJnZXQsIChPYmplY3RbXSkgbnVsbCk7\nCiAgICAgICAgfSBjYXRjaCAoVGhyb3dhYmxlIHQpIHsKICAgICAgICAgICAg\ndGhyb3cgd3JhcFJlZmxlY3Rpb25FeGNlcHRpb24odCk7CiAgICAgICAgfQog\nICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRoZSByZXR1cm4gdmFsdWUg\nb2YgdGhlIGdpdmVuIGdldHRlciBpbiB0aGUgZ2l2ZW4gb2JqZWN0LgogICAg\nICovCiAgICBwdWJsaWMgc3RhdGljIGJvb2xlYW4gZ2V0Qm9vbGVhbihPYmpl\nY3QgdGFyZ2V0LCBNZXRob2QgZ2V0dGVyKSB7CiAgICAgICAgT2JqZWN0IG8g\nPSBnZXQodGFyZ2V0LCBnZXR0ZXIpOwogICAgICAgIHJldHVybiAobyA9PSBu\ndWxsKSA/IGZhbHNlIDogKChCb29sZWFuKSBvKS5ib29sZWFuVmFsdWUoKTsK\nICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgcmV0dXJuIHZhbHVl\nIG9mIHRoZSBnaXZlbiBnZXR0ZXIgaW4gdGhlIGdpdmVuIG9iamVjdC4KICAg\nICAqLwogICAgcHVibGljIHN0YXRpYyBieXRlIGdldEJ5dGUoT2JqZWN0IHRh\ncmdldCwgTWV0aG9kIGdldHRlcikgewogICAgICAgIE9iamVjdCBvID0gZ2V0\nKHRhcmdldCwgZ2V0dGVyKTsKICAgICAgICByZXR1cm4gKG8gPT0gbnVsbCkg\nPyAoYnl0ZSkgMCA6ICgoTnVtYmVyKSBvKS5ieXRlVmFsdWUoKTsKICAgIH0K\nCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgcmV0dXJuIHZhbHVlIG9mIHRo\nZSBnaXZlbiBnZXR0ZXIgaW4gdGhlIGdpdmVuIG9iamVjdC4KICAgICAqLwog\nICAgcHVibGljIHN0YXRpYyBjaGFyIGdldENoYXIoT2JqZWN0IHRhcmdldCwg\nTWV0aG9kIGdldHRlcikgewogICAgICAgIE9iamVjdCBvID0gZ2V0KHRhcmdl\ndCwgZ2V0dGVyKTsKICAgICAgICByZXR1cm4gKG8gPT0gbnVsbCkgPyAoY2hh\ncikgMCA6ICgoQ2hhcmFjdGVyKSBvKS5jaGFyVmFsdWUoKTsKICAgIH0KCiAg\nICAvKioKICAgICAqIFJldHVybiB0aGUgcmV0dXJuIHZhbHVlIG9mIHRoZSBn\naXZlbiBnZXR0ZXIgaW4gdGhlIGdpdmVuIG9iamVjdC4KICAgICAqLwogICAg\ncHVibGljIHN0YXRpYyBkb3VibGUgZ2V0RG91YmxlKE9iamVjdCB0YXJnZXQs\nIE1ldGhvZCBnZXR0ZXIpIHsKICAgICAgICBPYmplY3QgbyA9IGdldCh0YXJn\nZXQsIGdldHRlcik7CiAgICAgICAgcmV0dXJuIChvID09IG51bGwpID8gMEQg\nOiAoKE51bWJlcikgbykuZG91YmxlVmFsdWUoKTsKICAgIH0KCiAgICAvKioK\nICAgICAqIFJldHVybiB0aGUgcmV0dXJuIHZhbHVlIG9mIHRoZSBnaXZlbiBn\nZXR0ZXIgaW4gdGhlIGdpdmVuIG9iamVjdC4KICAgICAqLwogICAgcHVibGlj\nIHN0YXRpYyBmbG9hdCBnZXRGbG9hdChPYmplY3QgdGFyZ2V0LCBNZXRob2Qg\nZ2V0dGVyKSB7CiAgICAgICAgT2JqZWN0IG8gPSBnZXQodGFyZ2V0LCBnZXR0\nZXIpOwogICAgICAgIHJldHVybiAobyA9PSBudWxsKSA/IDBGIDogKChOdW1i\nZXIpIG8pLmZsb2F0VmFsdWUoKTsKICAgIH0KCiAgICAvKioKICAgICAqIFJl\ndHVybiB0aGUgcmV0dXJuIHZhbHVlIG9mIHRoZSBnaXZlbiBnZXR0ZXIgaW4g\ndGhlIGdpdmVuIG9iamVjdC4KICAgICAqLwogICAgcHVibGljIHN0YXRpYyBp\nbnQgZ2V0SW50KE9iamVjdCB0YXJnZXQsIE1ldGhvZCBnZXR0ZXIpIHsKICAg\nICAgICBPYmplY3QgbyA9IGdldCh0YXJnZXQsIGdldHRlcik7CiAgICAgICAg\ncmV0dXJuIChvID09IG51bGwpID8gMCA6ICgoTnVtYmVyKSBvKS5pbnRWYWx1\nZSgpOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRoZSByZXR1cm4g\ndmFsdWUgb2YgdGhlIGdpdmVuIGdldHRlciBpbiB0aGUgZ2l2ZW4gb2JqZWN0\nLgogICAgICovCiAgICBwdWJsaWMgc3RhdGljIGxvbmcgZ2V0TG9uZyhPYmpl\nY3QgdGFyZ2V0LCBNZXRob2QgZ2V0dGVyKSB7CiAgICAgICAgT2JqZWN0IG8g\nPSBnZXQodGFyZ2V0LCBnZXR0ZXIpOwogICAgICAgIHJldHVybiAobyA9PSBu\ndWxsKSA/IDBMIDogKChOdW1iZXIpIG8pLmxvbmdWYWx1ZSgpOwogICAgfQoK\nICAgIC8qKgogICAgICogUmV0dXJuIHRoZSByZXR1cm4gdmFsdWUgb2YgdGhl\nIGdpdmVuIGdldHRlciBpbiB0aGUgZ2l2ZW4gb2JqZWN0LgogICAgICovCiAg\nICBwdWJsaWMgc3RhdGljIHNob3J0IGdldFNob3J0KE9iamVjdCB0YXJnZXQs\nIE1ldGhvZCBnZXR0ZXIpIHsKICAgICAgICBPYmplY3QgbyA9IGdldCh0YXJn\nZXQsIGdldHRlcik7CiAgICAgICAgcmV0dXJuIChvID09IG51bGwpID8gKHNo\nb3J0KSAwIDogKChOdW1iZXIpIG8pLnNob3J0VmFsdWUoKTsKICAgIH0KCiAg\nICAvKioKICAgICAqIFNldCB0aGUgdmFsdWUgb2YgdGhlIGdpdmVuIGZpZWxk\nIGluIHRoZSBnaXZlbiBvYmplY3QuCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0\naWMgdm9pZCBzZXQoT2JqZWN0IHRhcmdldCwgRmllbGQgZmllbGQsIE9iamVj\ndCB2YWx1ZSkgewogICAgICAgIGlmICh0YXJnZXQgPT0gbnVsbCB8fCBmaWVs\nZCA9PSBudWxsKQogICAgICAgICAgICByZXR1cm47CiAgICAgICAgbWFrZUFj\nY2Vzc2libGUoZmllbGQsIGZpZWxkLmdldE1vZGlmaWVycygpKTsKICAgICAg\nICB0cnkgewogICAgICAgICAgICBmaWVsZC5zZXQodGFyZ2V0LCB2YWx1ZSk7\nCiAgICAgICAgfSBjYXRjaCAoVGhyb3dhYmxlIHQpIHsKICAgICAgICAgICAg\ndGhyb3cgd3JhcFJlZmxlY3Rpb25FeGNlcHRpb24odCk7CiAgICAgICAgfQog\nICAgfQoKICAgIC8qKgogICAgICogU2V0IHRoZSB2YWx1ZSBvZiB0aGUgZ2l2\nZW4gZmllbGQgaW4gdGhlIGdpdmVuIG9iamVjdC4KICAgICAqLwogICAgcHVi\nbGljIHN0YXRpYyB2b2lkIHNldChPYmplY3QgdGFyZ2V0LCBGaWVsZCBmaWVs\nZCwgYm9vbGVhbiB2YWx1ZSkgewogICAgICAgIGlmICh0YXJnZXQgPT0gbnVs\nbCB8fCBmaWVsZCA9PSBudWxsKQogICAgICAgICAgICByZXR1cm47CiAgICAg\nICAgbWFrZUFjY2Vzc2libGUoZmllbGQsIGZpZWxkLmdldE1vZGlmaWVycygp\nKTsKICAgICAgICB0cnkgewogICAgICAgICAgICBmaWVsZC5zZXRCb29sZWFu\nKHRhcmdldCwgdmFsdWUpOwogICAgICAgIH0gY2F0Y2ggKFRocm93YWJsZSB0\nKSB7CiAgICAgICAgICAgIHRocm93IHdyYXBSZWZsZWN0aW9uRXhjZXB0aW9u\nKHQpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIFNldCB0aGUg\ndmFsdWUgb2YgdGhlIGdpdmVuIGZpZWxkIGluIHRoZSBnaXZlbiBvYmplY3Qu\nCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0aWMgdm9pZCBzZXQoT2JqZWN0IHRh\ncmdldCwgRmllbGQgZmllbGQsIGJ5dGUgdmFsdWUpIHsKICAgICAgICBpZiAo\ndGFyZ2V0ID09IG51bGwgfHwgZmllbGQgPT0gbnVsbCkKICAgICAgICAgICAg\ncmV0dXJuOwogICAgICAgIG1ha2VBY2Nlc3NpYmxlKGZpZWxkLCBmaWVsZC5n\nZXRNb2RpZmllcnMoKSk7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgZmll\nbGQuc2V0Qnl0ZSh0YXJnZXQsIHZhbHVlKTsKICAgICAgICB9IGNhdGNoIChU\naHJvd2FibGUgdCkgewogICAgICAgICAgICB0aHJvdyB3cmFwUmVmbGVjdGlv\nbkV4Y2VwdGlvbih0KTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAg\nKiBTZXQgdGhlIHZhbHVlIG9mIHRoZSBnaXZlbiBmaWVsZCBpbiB0aGUgZ2l2\nZW4gb2JqZWN0LgogICAgICovCiAgICBwdWJsaWMgc3RhdGljIHZvaWQgc2V0\nKE9iamVjdCB0YXJnZXQsIEZpZWxkIGZpZWxkLCBjaGFyIHZhbHVlKSB7CiAg\nICAgICAgaWYgKHRhcmdldCA9PSBudWxsIHx8IGZpZWxkID09IG51bGwpCiAg\nICAgICAgICAgIHJldHVybjsKICAgICAgICBtYWtlQWNjZXNzaWJsZShmaWVs\nZCwgZmllbGQuZ2V0TW9kaWZpZXJzKCkpOwogICAgICAgIHRyeSB7CiAgICAg\nICAgICAgIGZpZWxkLnNldENoYXIodGFyZ2V0LCB2YWx1ZSk7CiAgICAgICAg\nfSBjYXRjaCAoVGhyb3dhYmxlIHQpIHsKICAgICAgICAgICAgdGhyb3cgd3Jh\ncFJlZmxlY3Rpb25FeGNlcHRpb24odCk7CiAgICAgICAgfQogICAgfQoKICAg\nIC8qKgogICAgICogU2V0IHRoZSB2YWx1ZSBvZiB0aGUgZ2l2ZW4gZmllbGQg\naW4gdGhlIGdpdmVuIG9iamVjdC4KICAgICAqLwogICAgcHVibGljIHN0YXRp\nYyB2b2lkIHNldChPYmplY3QgdGFyZ2V0LCBGaWVsZCBmaWVsZCwgZG91Ymxl\nIHZhbHVlKSB7CiAgICAgICAgaWYgKHRhcmdldCA9PSBudWxsIHx8IGZpZWxk\nID09IG51bGwpCiAgICAgICAgICAgIHJldHVybjsKICAgICAgICBtYWtlQWNj\nZXNzaWJsZShmaWVsZCwgZmllbGQuZ2V0TW9kaWZpZXJzKCkpOwogICAgICAg\nIHRyeSB7CiAgICAgICAgICAgIGZpZWxkLnNldERvdWJsZSh0YXJnZXQsIHZh\nbHVlKTsKICAgICAgICB9IGNhdGNoIChUaHJvd2FibGUgdCkgewogICAgICAg\nICAgICB0aHJvdyB3cmFwUmVmbGVjdGlvbkV4Y2VwdGlvbih0KTsKICAgICAg\nICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBTZXQgdGhlIHZhbHVlIG9mIHRo\nZSBnaXZlbiBmaWVsZCBpbiB0aGUgZ2l2ZW4gb2JqZWN0LgogICAgICovCiAg\nICBwdWJsaWMgc3RhdGljIHZvaWQgc2V0KE9iamVjdCB0YXJnZXQsIEZpZWxk\nIGZpZWxkLCBmbG9hdCB2YWx1ZSkgewogICAgICAgIGlmICh0YXJnZXQgPT0g\nbnVsbCB8fCBmaWVsZCA9PSBudWxsKQogICAgICAgICAgICByZXR1cm47CiAg\nICAgICAgbWFrZUFjY2Vzc2libGUoZmllbGQsIGZpZWxkLmdldE1vZGlmaWVy\ncygpKTsKICAgICAgICB0cnkgewogICAgICAgICAgICBmaWVsZC5zZXRGbG9h\ndCh0YXJnZXQsIHZhbHVlKTsKICAgICAgICB9IGNhdGNoIChUaHJvd2FibGUg\ndCkgewogICAgICAgICAgICB0aHJvdyB3cmFwUmVmbGVjdGlvbkV4Y2VwdGlv\nbih0KTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBTZXQgdGhl\nIHZhbHVlIG9mIHRoZSBnaXZlbiBmaWVsZCBpbiB0aGUgZ2l2ZW4gb2JqZWN0\nLgogICAgICovCiAgICBwdWJsaWMgc3RhdGljIHZvaWQgc2V0KE9iamVjdCB0\nYXJnZXQsIEZpZWxkIGZpZWxkLCBpbnQgdmFsdWUpIHsKICAgICAgICBpZiAo\ndGFyZ2V0ID09IG51bGwgfHwgZmllbGQgPT0gbnVsbCkKICAgICAgICAgICAg\ncmV0dXJuOwogICAgICAgIG1ha2VBY2Nlc3NpYmxlKGZpZWxkLCBmaWVsZC5n\nZXRNb2RpZmllcnMoKSk7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgZmll\nbGQuc2V0SW50KHRhcmdldCwgdmFsdWUpOwogICAgICAgIH0gY2F0Y2ggKFRo\ncm93YWJsZSB0KSB7CiAgICAgICAgICAgIHRocm93IHdyYXBSZWZsZWN0aW9u\nRXhjZXB0aW9uKHQpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAq\nIFNldCB0aGUgdmFsdWUgb2YgdGhlIGdpdmVuIGZpZWxkIGluIHRoZSBnaXZl\nbiBvYmplY3QuCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0aWMgdm9pZCBzZXQo\nT2JqZWN0IHRhcmdldCwgRmllbGQgZmllbGQsIGxvbmcgdmFsdWUpIHsKICAg\nICAgICBpZiAodGFyZ2V0ID09IG51bGwgfHwgZmllbGQgPT0gbnVsbCkKICAg\nICAgICAgICAgcmV0dXJuOwogICAgICAgIG1ha2VBY2Nlc3NpYmxlKGZpZWxk\nLCBmaWVsZC5nZXRNb2RpZmllcnMoKSk7CiAgICAgICAgdHJ5IHsKICAgICAg\nICAgICAgZmllbGQuc2V0TG9uZyh0YXJnZXQsIHZhbHVlKTsKICAgICAgICB9\nIGNhdGNoIChUaHJvd2FibGUgdCkgewogICAgICAgICAgICB0aHJvdyB3cmFw\nUmVmbGVjdGlvbkV4Y2VwdGlvbih0KTsKICAgICAgICB9CiAgICB9CgogICAg\nLyoqCiAgICAgKiBTZXQgdGhlIHZhbHVlIG9mIHRoZSBnaXZlbiBmaWVsZCBp\nbiB0aGUgZ2l2ZW4gb2JqZWN0LgogICAgICovCiAgICBwdWJsaWMgc3RhdGlj\nIHZvaWQgc2V0KE9iamVjdCB0YXJnZXQsIEZpZWxkIGZpZWxkLCBzaG9ydCB2\nYWx1ZSkgewogICAgICAgIGlmICh0YXJnZXQgPT0gbnVsbCB8fCBmaWVsZCA9\nPSBudWxsKQogICAgICAgICAgICByZXR1cm47CiAgICAgICAgbWFrZUFjY2Vz\nc2libGUoZmllbGQsIGZpZWxkLmdldE1vZGlmaWVycygpKTsKICAgICAgICB0\ncnkgewogICAgICAgICAgICBmaWVsZC5zZXRTaG9ydCh0YXJnZXQsIHZhbHVl\nKTsKICAgICAgICB9IGNhdGNoIChUaHJvd2FibGUgdCkgewogICAgICAgICAg\nICB0aHJvdyB3cmFwUmVmbGVjdGlvbkV4Y2VwdGlvbih0KTsKICAgICAgICB9\nCiAgICB9CgogICAgLyoqCiAgICAgKiBTZXQgdGhlIHZhbHVlIG9mIHRoZSBn\naXZlbiBmaWVsZCBpbiB0aGUgZ2l2ZW4gb2JqZWN0LgogICAgICogU2FtZSBi\nZWhhdmlvciBhcyBhYm92ZSBtZXRob2RzLCBidXQgcGFyYW1ldGVyIG9yZGVy\naW5nIGlzIHJlYXJyYW5nZWQKICAgICAqIHRvIHNpbXBsaWZ5IHVzYWdlIGZy\nb20gZ2VuZXJhdGVkIGJ5dGVjb2Rlcy4KICAgICAqCiAgICAgKiBAc2luY2Ug\nMS4wLjAKICAgICAqLwogICAgcHVibGljIHN0YXRpYyB2b2lkIHNldChPYmpl\nY3QgdGFyZ2V0LCBPYmplY3QgdmFsdWUsIEZpZWxkIGZpZWxkKSB7CiAgICAg\nICAgc2V0KHRhcmdldCwgZmllbGQsIHZhbHVlKTsKICAgIH0KCiAgICAvKioK\nICAgICAqIFNldCB0aGUgdmFsdWUgb2YgdGhlIGdpdmVuIGZpZWxkIGluIHRo\nZSBnaXZlbiBvYmplY3QuCiAgICAgKiBTYW1lIGJlaGF2aW9yIGFzIGFib3Zl\nIG1ldGhvZHMsIGJ1dCBwYXJhbWV0ZXIgb3JkZXJpbmcgaXMgcmVhcnJhbmdl\nZAogICAgICogdG8gc2ltcGxpZnkgdXNhZ2UgZnJvbSBnZW5lcmF0ZWQgYnl0\nZWNvZGVzLgogICAgICoKICAgICAqIEBzaW5jZSAxLjAuMAogICAgICovCiAg\nICBwdWJsaWMgc3RhdGljIHZvaWQgc2V0KE9iamVjdCB0YXJnZXQsIGJvb2xl\nYW4gdmFsdWUsIEZpZWxkIGZpZWxkKSB7CiAgICAgICAgc2V0KHRhcmdldCwg\nZmllbGQsIHZhbHVlKTsKICAgIH0KCiAgICAvKioKICAgICAqIFNldCB0aGUg\ndmFsdWUgb2YgdGhlIGdpdmVuIGZpZWxkIGluIHRoZSBnaXZlbiBvYmplY3Qu\nCiAgICAgKiBTYW1lIGJlaGF2aW9yIGFzIGFib3ZlIG1ldGhvZHMsIGJ1dCBw\nYXJhbWV0ZXIgb3JkZXJpbmcgaXMgcmVhcnJhbmdlZAogICAgICogdG8gc2lt\ncGxpZnkgdXNhZ2UgZnJvbSBnZW5lcmF0ZWQgYnl0ZWNvZGVzLgogICAgICoK\nICAgICAqIEBzaW5jZSAxLjAuMAogICAgICovCiAgICBwdWJsaWMgc3RhdGlj\nIHZvaWQgc2V0KE9iamVjdCB0YXJnZXQsIGJ5dGUgdmFsdWUsIEZpZWxkIGZp\nZWxkKSB7CiAgICAgICAgc2V0KHRhcmdldCwgZmllbGQsIHZhbHVlKTsKICAg\nIH0KCiAgICAvKioKICAgICAqIFNldCB0aGUgdmFsdWUgb2YgdGhlIGdpdmVu\nIGZpZWxkIGluIHRoZSBnaXZlbiBvYmplY3QuCiAgICAgKiBTYW1lIGJlaGF2\naW9yIGFzIGFib3ZlIG1ldGhvZHMsIGJ1dCBwYXJhbWV0ZXIgb3JkZXJpbmcg\naXMgcmVhcnJhbmdlZAogICAgICogdG8gc2ltcGxpZnkgdXNhZ2UgZnJvbSBn\nZW5lcmF0ZWQgYnl0ZWNvZGVzLgogICAgICoKICAgICAqIEBzaW5jZSAxLjAu\nMAogICAgICovCiAgICBwdWJsaWMgc3RhdGljIHZvaWQgc2V0KE9iamVjdCB0\nYXJnZXQsIGNoYXIgdmFsdWUsIEZpZWxkIGZpZWxkKSB7CiAgICAgICAgc2V0\nKHRhcmdldCwgZmllbGQsIHZhbHVlKTsKICAgIH0KCiAgICAvKioKICAgICAq\nIFNldCB0aGUgdmFsdWUgb2YgdGhlIGdpdmVuIGZpZWxkIGluIHRoZSBnaXZl\nbiBvYmplY3QuCiAgICAgKiBTYW1lIGJlaGF2aW9yIGFzIGFib3ZlIG1ldGhv\nZHMsIGJ1dCBwYXJhbWV0ZXIgb3JkZXJpbmcgaXMgcmVhcnJhbmdlZAogICAg\nICogdG8gc2ltcGxpZnkgdXNhZ2UgZnJvbSBnZW5lcmF0ZWQgYnl0ZWNvZGVz\nLgogICAgICoKICAgICAqIEBzaW5jZSAxLjAuMAogICAgICovCiAgICBwdWJs\naWMgc3RhdGljIHZvaWQgc2V0KE9iamVjdCB0YXJnZXQsIGRvdWJsZSB2YWx1\nZSwgRmllbGQgZmllbGQpIHsKICAgICAgICBzZXQodGFyZ2V0LCBmaWVsZCwg\ndmFsdWUpOwogICAgfQoKICAgIC8qKgogICAgICogU2V0IHRoZSB2YWx1ZSBv\nZiB0aGUgZ2l2ZW4gZmllbGQgaW4gdGhlIGdpdmVuIG9iamVjdC4KICAgICAq\nIFNhbWUgYmVoYXZpb3IgYXMgYWJvdmUgbWV0aG9kcywgYnV0IHBhcmFtZXRl\nciBvcmRlcmluZyBpcyByZWFycmFuZ2VkCiAgICAgKiB0byBzaW1wbGlmeSB1\nc2FnZSBmcm9tIGdlbmVyYXRlZCBieXRlY29kZXMuCiAgICAgKgogICAgICog\nQHNpbmNlIDEuMC4wCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0aWMgdm9pZCBz\nZXQoT2JqZWN0IHRhcmdldCwgZmxvYXQgdmFsdWUsIEZpZWxkIGZpZWxkKSB7\nCiAgICAgICAgc2V0KHRhcmdldCwgZmllbGQsIHZhbHVlKTsKICAgIH0KCiAg\nICAvKioKICAgICAqIFNldCB0aGUgdmFsdWUgb2YgdGhlIGdpdmVuIGZpZWxk\nIGluIHRoZSBnaXZlbiBvYmplY3QuCiAgICAgKiBTYW1lIGJlaGF2aW9yIGFz\nIGFib3ZlIG1ldGhvZHMsIGJ1dCBwYXJhbWV0ZXIgb3JkZXJpbmcgaXMgcmVh\ncnJhbmdlZAogICAgICogdG8gc2ltcGxpZnkgdXNhZ2UgZnJvbSBnZW5lcmF0\nZWQgYnl0ZWNvZGVzLgogICAgICoKICAgICAqIEBzaW5jZSAxLjAuMAogICAg\nICovCiAgICBwdWJsaWMgc3RhdGljIHZvaWQgc2V0KE9iamVjdCB0YXJnZXQs\nIGludCB2YWx1ZSwgRmllbGQgZmllbGQpIHsKICAgICAgICBzZXQodGFyZ2V0\nLCBmaWVsZCwgdmFsdWUpOwogICAgfQoKICAgIC8qKgogICAgICogU2V0IHRo\nZSB2YWx1ZSBvZiB0aGUgZ2l2ZW4gZmllbGQgaW4gdGhlIGdpdmVuIG9iamVj\ndC4KICAgICAqIFNhbWUgYmVoYXZpb3IgYXMgYWJvdmUgbWV0aG9kcywgYnV0\nIHBhcmFtZXRlciBvcmRlcmluZyBpcyByZWFycmFuZ2VkCiAgICAgKiB0byBz\naW1wbGlmeSB1c2FnZSBmcm9tIGdlbmVyYXRlZCBieXRlY29kZXMuCiAgICAg\nKgogICAgICogQHNpbmNlIDEuMC4wCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0\naWMgdm9pZCBzZXQoT2JqZWN0IHRhcmdldCwgbG9uZyB2YWx1ZSwgRmllbGQg\nZmllbGQpIHsKICAgICAgICBzZXQodGFyZ2V0LCBmaWVsZCwgdmFsdWUpOwog\nICAgfQoKICAgIC8qKgogICAgICogU2V0IHRoZSB2YWx1ZSBvZiB0aGUgZ2l2\nZW4gZmllbGQgaW4gdGhlIGdpdmVuIG9iamVjdC4KICAgICAqIFNhbWUgYmVo\nYXZpb3IgYXMgYWJvdmUgbWV0aG9kcywgYnV0IHBhcmFtZXRlciBvcmRlcmlu\nZyBpcyByZWFycmFuZ2VkCiAgICAgKiB0byBzaW1wbGlmeSB1c2FnZSBmcm9t\nIGdlbmVyYXRlZCBieXRlY29kZXMuCiAgICAgKgogICAgICogQHNpbmNlIDEu\nMC4wCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0aWMgdm9pZCBzZXQoT2JqZWN0\nIHRhcmdldCwgc2hvcnQgdmFsdWUsIEZpZWxkIGZpZWxkKSB7CiAgICAgICAg\nc2V0KHRhcmdldCwgZmllbGQsIHZhbHVlKTsKICAgIH0KCiAgICAvKioKICAg\nICAqIEludm9rZSB0aGUgZ2l2ZW4gc2V0dGVyIG9uIHRoZSBnaXZlbiBvYmpl\nY3QuCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0aWMgdm9pZCBzZXQoT2JqZWN0\nIHRhcmdldCwgTWV0aG9kIHNldHRlciwgT2JqZWN0IHZhbHVlKSB7CiAgICAg\nICAgaWYgKHRhcmdldCA9PSBudWxsIHx8IHNldHRlciA9PSBudWxsKQogICAg\nICAgICAgICByZXR1cm47CiAgICAgICAgbWFrZUFjY2Vzc2libGUoc2V0dGVy\nLCBzZXR0ZXIuZ2V0TW9kaWZpZXJzKCkpOwogICAgICAgIHRyeSB7CiAgICAg\nICAgICAgIHNldHRlci5pbnZva2UodGFyZ2V0LCBuZXcgT2JqZWN0W10geyB2\nYWx1ZSB9KTsKICAgICAgICB9IGNhdGNoIChUaHJvd2FibGUgdCkgewogICAg\nICAgICAgICB0aHJvdyB3cmFwUmVmbGVjdGlvbkV4Y2VwdGlvbih0KTsKICAg\nICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBJbnZva2UgdGhlIGdpdmVu\nIHNldHRlciBvbiB0aGUgZ2l2ZW4gb2JqZWN0LgogICAgICovCiAgICBwdWJs\naWMgc3RhdGljIHZvaWQgc2V0KE9iamVjdCB0YXJnZXQsIE1ldGhvZCBzZXR0\nZXIsIGJvb2xlYW4gdmFsdWUpIHsKICAgICAgICBzZXQodGFyZ2V0LCBzZXR0\nZXIsICh2YWx1ZSkgPyBCb29sZWFuLlRSVUUgOiBCb29sZWFuLkZBTFNFKTsK\nICAgIH0KCiAgICAvKioKICAgICAqIEludm9rZSB0aGUgZ2l2ZW4gc2V0dGVy\nIG9uIHRoZSBnaXZlbiBvYmplY3QuCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0\naWMgdm9pZCBzZXQoT2JqZWN0IHRhcmdldCwgTWV0aG9kIHNldHRlciwgYnl0\nZSB2YWx1ZSkgewogICAgICAgIHNldCh0YXJnZXQsIHNldHRlciwgbmV3IEJ5\ndGUodmFsdWUpKTsKICAgIH0KCiAgICAvKioKICAgICAqIEludm9rZSB0aGUg\nZ2l2ZW4gc2V0dGVyIG9uIHRoZSBnaXZlbiBvYmplY3QuCiAgICAgKi8KICAg\nIHB1YmxpYyBzdGF0aWMgdm9pZCBzZXQoT2JqZWN0IHRhcmdldCwgTWV0aG9k\nIHNldHRlciwgY2hhciB2YWx1ZSkgewogICAgICAgIHNldCh0YXJnZXQsIHNl\ndHRlciwgbmV3IENoYXJhY3Rlcih2YWx1ZSkpOwogICAgfQoKICAgIC8qKgog\nICAgICogSW52b2tlIHRoZSBnaXZlbiBzZXR0ZXIgb24gdGhlIGdpdmVuIG9i\namVjdC4KICAgICAqLwogICAgcHVibGljIHN0YXRpYyB2b2lkIHNldChPYmpl\nY3QgdGFyZ2V0LCBNZXRob2Qgc2V0dGVyLCBkb3VibGUgdmFsdWUpIHsKICAg\nICAgICBzZXQodGFyZ2V0LCBzZXR0ZXIsIG5ldyBEb3VibGUodmFsdWUpKTsK\nICAgIH0KCiAgICAvKioKICAgICAqIEludm9rZSB0aGUgZ2l2ZW4gc2V0dGVy\nIG9uIHRoZSBnaXZlbiBvYmplY3QuCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0\naWMgdm9pZCBzZXQoT2JqZWN0IHRhcmdldCwgTWV0aG9kIHNldHRlciwgZmxv\nYXQgdmFsdWUpIHsKICAgICAgICBzZXQodGFyZ2V0LCBzZXR0ZXIsIG5ldyBG\nbG9hdCh2YWx1ZSkpOwogICAgfQoKICAgIC8qKgogICAgICogSW52b2tlIHRo\nZSBnaXZlbiBzZXR0ZXIgb24gdGhlIGdpdmVuIG9iamVjdC4KICAgICAqLwog\nICAgcHVibGljIHN0YXRpYyB2b2lkIHNldChPYmplY3QgdGFyZ2V0LCBNZXRo\nb2Qgc2V0dGVyLCBpbnQgdmFsdWUpIHsKICAgICAgICBzZXQodGFyZ2V0LCBz\nZXR0ZXIsIG5ldyBJbnRlZ2VyKHZhbHVlKSk7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBJbnZva2UgdGhlIGdpdmVuIHNldHRlciBvbiB0aGUgZ2l2ZW4gb2Jq\nZWN0LgogICAgICovCiAgICBwdWJsaWMgc3RhdGljIHZvaWQgc2V0KE9iamVj\ndCB0YXJnZXQsIE1ldGhvZCBzZXR0ZXIsIGxvbmcgdmFsdWUpIHsKICAgICAg\nICBzZXQodGFyZ2V0LCBzZXR0ZXIsIG5ldyBMb25nKHZhbHVlKSk7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBJbnZva2UgdGhlIGdpdmVuIHNldHRlciBvbiB0\naGUgZ2l2ZW4gb2JqZWN0LgogICAgICovCiAgICBwdWJsaWMgc3RhdGljIHZv\naWQgc2V0KE9iamVjdCB0YXJnZXQsIE1ldGhvZCBzZXR0ZXIsIHNob3J0IHZh\nbHVlKSB7CiAgICAgICAgc2V0KHRhcmdldCwgc2V0dGVyLCBuZXcgU2hvcnQo\ndmFsdWUpKTsKICAgIH0KfQo=\n","encoding":"base64"}

