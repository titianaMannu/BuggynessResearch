{"sha":"39ada6c18bcae64908600bd1d911d3c3a924378e","node_id":"MDQ6QmxvYjIwNjM2NDozOWFkYTZjMThiY2FlNjQ5MDg2MDBiZDFkOTExZDNjM2E5MjQzNzhl","size":9994,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/39ada6c18bcae64908600bd1d911d3c3a924378e","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuZXZlbnQ7CgppbXBvcnQgamF2\nYS51dGlsLlByb3BlcnRpZXM7CmltcG9ydCBqYXZheC5qbXMuRXhjZXB0aW9u\nTGlzdGVuZXI7CmltcG9ydCBqYXZheC5qbXMuSk1TRXhjZXB0aW9uOwppbXBv\ncnQgamF2YXguam1zLk1lc3NhZ2U7CmltcG9ydCBqYXZheC5qbXMuTWVzc2Fn\nZUxpc3RlbmVyOwppbXBvcnQgamF2YXguam1zLk9iamVjdE1lc3NhZ2U7Cmlt\ncG9ydCBqYXZheC5qbXMuU2Vzc2lvbjsKaW1wb3J0IGphdmF4Lmptcy5Ub3Bp\nYzsKaW1wb3J0IGphdmF4Lmptcy5Ub3BpY0Nvbm5lY3Rpb247CmltcG9ydCBq\nYXZheC5qbXMuVG9waWNDb25uZWN0aW9uRmFjdG9yeTsKaW1wb3J0IGphdmF4\nLmptcy5Ub3BpY1B1Ymxpc2hlcjsKaW1wb3J0IGphdmF4Lmptcy5Ub3BpY1Nl\nc3Npb247CmltcG9ydCBqYXZheC5qbXMuVG9waWNTdWJzY3JpYmVyOwppbXBv\ncnQgamF2YXgubmFtaW5nLkNvbnRleHQ7CmltcG9ydCBqYXZheC5uYW1pbmcu\nSW5pdGlhbENvbnRleHQ7CmltcG9ydCBqYXZheC5uYW1pbmcuTmFtaW5nRXhj\nZXB0aW9uOwoKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIuY29uZi5D\nb25maWd1cmFibGU7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLmNv\nbmYuR2VuZXJpY0NvbmZpZ3VyYWJsZTsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5saWIudXRpbC5Mb2NhbGl6ZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEubGliLnV0aWwuT3B0aW9uczsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS51dGlsLk9wZW5KUEFFeGNlcHRpb247CmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEudXRpbC5Vc2VyRXhjZXB0aW9uOwoKLyoqCiAqIEpNUy1iYXNl\nZCBpbXBsZW1lbnRhdGlvbiBvZiB7QGxpbmsgUmVtb3RlQ29tbWl0UHJvdmlk\nZXJ9IHRoYXQKICogbGlzdGVucyBmb3Igb2JqZWN0IG1vZGlmaWNhdGlvbnMg\nYW5kIHByb3BhZ2F0ZXMgdGhvc2UgY2hhbmdlcyB0bwogKiBvdGhlciBSZW1v\ndGVDb21taXRQcm92aWRlcnMgb3ZlciBhIEpNUyB0b3BpYy4KICoKICogQGF1\ndGhvciBQYXRyaWNrIExpbnNrZXkKICogQHNpbmNlIDAuMi41LjAKICovCnB1\nYmxpYyBjbGFzcyBKTVNSZW1vdGVDb21taXRQcm92aWRlcgogICAgZXh0ZW5k\ncyBBYnN0cmFjdFJlbW90ZUNvbW1pdFByb3ZpZGVyCiAgICBpbXBsZW1lbnRz\nIENvbmZpZ3VyYWJsZSwgR2VuZXJpY0NvbmZpZ3VyYWJsZSwgRXhjZXB0aW9u\nTGlzdGVuZXIgewoKICAgIHByaXZhdGUgc3RhdGljIExvY2FsaXplciBzX2xv\nYyA9IExvY2FsaXplci5mb3JQYWNrYWdlCiAgICAgICAgKEpNU1JlbW90ZUNv\nbW1pdFByb3ZpZGVyLmNsYXNzKTsKCiAgICBwcml2YXRlIFN0cmluZyBfdG9w\naWNOYW1lID0gInRvcGljL09wZW5KUEFDb21taXRQcm92aWRlclRvcGljIjsK\nICAgIHByaXZhdGUgU3RyaW5nIF90Y2ZOYW1lID0gImphdmE6L0Nvbm5lY3Rp\nb25GYWN0b3J5IjsKICAgIHByaXZhdGUgUHJvcGVydGllcyBfY3R4UHJvcHMg\nPSBudWxsOwogICAgcHJpdmF0ZSBpbnQgX3JlY29ubmVjdEF0dGVtcHRzID0g\nMDsKICAgIHByaXZhdGUgVG9waWNDb25uZWN0aW9uIF9jb25uZWN0aW9uOwog\nICAgcHJpdmF0ZSBUb3BpY1Nlc3Npb24gX3Nlc3Npb247CiAgICBwcml2YXRl\nIFRvcGljUHVibGlzaGVyIF9wdWJsaXNoZXI7CiAgICBwcml2YXRlIENsYXNz\nTG9hZGVyIF9hcHBDbGFzc0xvYWRlcjsKICAgIAogICAgLyoqCiAgICAgKiBT\nZXRzIHRoZSBKTVMgVG9waWMgbmFtZS4gRGVmYXVsdHMgdG8KICAgICAqIDxj\nb2RlPnRvcGljL09wZW5KUEFDb21taXRQcm92aWRlclRvcGljPC9jb2RlPi4K\nICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0VG9waWMoU3RyaW5nIG5hbWUp\nIHsKICAgICAgICBfdG9waWNOYW1lID0gbmFtZTsKICAgIH0KCiAgICAvKioK\nICAgICAqIFNldHMgdGhlIEpNUyBUb3BpY0Nvbm5lY3Rpb25GYWN0b3J5IG5h\nbWUuIERlZmF1bHRzIHRvCiAgICAgKiA8Y29kZT5qYXZhOi9Db25uZWN0aW9u\nRmFjdG9yeTwvY29kZT4uCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldFRv\ncGljQ29ubmVjdGlvbkZhY3RvcnkoU3RyaW5nIG5hbWUpIHsKICAgICAgICBf\ndGNmTmFtZSA9IG5hbWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBUaGUgbnVt\nYmVyIG9mIHRpbWVzIHRvIGF0dGVtcHQgdG8gcmVjb25uZWN0IGFmdGVyIGEg\nSk1TIHNlbmQgZXhjZXB0aW9uCiAgICAgKiBpcyBkZXRlY3RlZC4gRGVmYXVs\ndHMgdG8gMCwgbWVhbmluZyBubyBhdHRlbXB0IHRvIHJlY29ubmVjdCBpcyBt\nYWRlOwogICAgICogdGhlIGV4Y2VwdGlvbiBpcyBsb2dnZWQgYW5kIGlnbm9y\nZWQuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldEV4Y2VwdGlvblJlY29u\nbmVjdEF0dGVtcHRzKGludCBhdHRlbXB0cykgewogICAgICAgIF9yZWNvbm5l\nY3RBdHRlbXB0cyA9IGF0dGVtcHRzOwogICAgfQoKICAgIC8qKgogICAgICog\nU2V0IGEgbWFwIG9mIHByb3BlcnRpZXMgdG8gcGFzcyB0byB0aGUge0BsaW5r\nIEluaXRpYWxDb250ZXh0fQogICAgICogY29uc3RydWN0b3IgZm9yIEpOREkg\nbG9va3Vwcy4gSW1wbGVtZW50YXRpb24gb2YKICAgICAqIHtAbGluayBHZW5l\ncmljQ29uZmlndXJhYmxlfS4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0\nSW50byhPcHRpb25zIG9wdHMpIHsKICAgICAgICBpZiAob3B0cyAhPSBudWxs\nICYmICFvcHRzLmlzRW1wdHkoKSkgewogICAgICAgICAgICBfY3R4UHJvcHMg\nPSBuZXcgUHJvcGVydGllcygpOwogICAgICAgICAgICBfY3R4UHJvcHMucHV0\nQWxsKG9wdHMpOwogICAgICAgICAgICBvcHRzLmNsZWFyKCk7CiAgICAgICAg\nfSBlbHNlCiAgICAgICAgICAgIF9jdHhQcm9wcyA9IG51bGw7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBSZXR1cm5zIGEgbmV3IHtAbGluayBDb250ZXh0fSBv\nYmplY3QgZm9yIHVzZSBieSB0aGlzIHByb3ZpZGVyLgogICAgICovCiAgICBw\ncm90ZWN0ZWQgQ29udGV4dCBuZXdDb250ZXh0KCkKICAgICAgICB0aHJvd3Mg\nTmFtaW5nRXhjZXB0aW9uIHsKICAgICAgICBpZiAoX2N0eFByb3BzID09IG51\nbGwpCiAgICAgICAgICAgIHJldHVybiBuZXcgSW5pdGlhbENvbnRleHQoKTsK\nICAgICAgICByZXR1cm4gbmV3IEluaXRpYWxDb250ZXh0KF9jdHhQcm9wcyk7\nCiAgICB9CgogICAgLy8gLS0tLS0tLS0tLSBSZW1vdGVDb21taXRQcm92aWRl\nciBpbXBsZW1lbnRhdGlvbiAtLS0tLS0tLS0tCgogICAgcHVibGljIHZvaWQg\nYnJvYWRjYXN0KFJlbW90ZUNvbW1pdEV2ZW50IGV2ZW50KSB7CiAgICAgICAg\ndHJ5IHsKICAgICAgICAgICAgX3B1Ymxpc2hlci5wdWJsaXNoKGNyZWF0ZU1l\nc3NhZ2UoZXZlbnQpKTsKICAgICAgICAgICAgaWYgKGxvZy5pc1RyYWNlRW5h\nYmxlZCgpKQogICAgICAgICAgICAgICAgbG9nLnRyYWNlKHNfbG9jLmdldCgi\nam1zLXNlbnQtdXBkYXRlIiwgX3RvcGljTmFtZSkpOwogICAgICAgIH0gY2F0\nY2ggKEpNU0V4Y2VwdGlvbiBqbXNlKSB7CiAgICAgICAgICAgIGlmIChsb2cu\naXNXYXJuRW5hYmxlZCgpKQogICAgICAgICAgICAgICAgbG9nLndhcm4oc19s\nb2MuZ2V0KCJqbXMtc2VuZC1lcnJvciIsIF90b3BpY05hbWUpLCBqbXNlKTsK\nICAgICAgICB9CiAgICB9CgogICAgcHVibGljIHZvaWQgY2xvc2UoKSB7CiAg\nICAgICAgdHJ5IHsKICAgICAgICAgICAgaWYgKF9jb25uZWN0aW9uICE9IG51\nbGwpIHsKICAgICAgICAgICAgICAgIF9jb25uZWN0aW9uLmNsb3NlKCk7CiAg\nICAgICAgICAgICAgICBpZiAobG9nLmlzSW5mb0VuYWJsZWQoKSkKICAgICAg\nICAgICAgICAgICAgICBsb2cuaW5mbyhzX2xvYy5nZXQoImptcy1jbG9zZS1s\naXN0ZW5lciIsIF90b3BpY05hbWUpKTsKICAgICAgICAgICAgfQogICAgICAg\nIH0KICAgICAgICBjYXRjaCAoSk1TRXhjZXB0aW9uIGptc2UpIHsKICAgICAg\nICAgICAgaWYgKGxvZy5pc1dhcm5FbmFibGVkKCkpCiAgICAgICAgICAgICAg\nICBsb2cud2FybihzX2xvYy5nZXQoImptcy1jbG9zZS1lcnJvciIsIF90b3Bp\nY05hbWUpLCBqbXNlKTsKICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAg\nICBfY29ubmVjdGlvbiA9IG51bGw7CiAgICAgICAgfQogICAgfQoKICAgIC8v\nIC0tLS0tLS0tLS0gQ29uZmlndXJhYmxlIGltcGxlbWVudGF0aW9uIC0tLS0t\nLS0tLS0KCiAgICAvKioKICAgICAqIFN1YmNsYXNzZXMgdGhhdCBuZWVkIHRv\nIHBlcmZvcm0gYWN0aW9ucyBpbgogICAgICoge0BsaW5rIENvbmZpZ3VyYWJs\nZSNlbmRDb25maWd1cmF0aW9ufSBtdXN0IGludm9rZSB0aGlzIG1ldGhvZC4K\nICAgICAqLwogICAgcHVibGljIHZvaWQgZW5kQ29uZmlndXJhdGlvbigpIHsK\nICAgICAgICBzdXBlci5lbmRDb25maWd1cmF0aW9uKCk7CiAgICAgICAgX2Fw\ncENsYXNzTG9hZGVyID0gVGhyZWFkLmN1cnJlbnRUaHJlYWQoKS5nZXRDb250\nZXh0Q2xhc3NMb2FkZXIoKTsKICAgICAgICBjb25uZWN0KCk7CiAgICB9Cgog\nICAgcHJvdGVjdGVkIHZvaWQgY29ubmVjdCgpIHsKICAgICAgICB0cnkgewog\nICAgICAgICAgICBDb250ZXh0IGN0eCA9IG5ld0NvbnRleHQoKTsKICAgICAg\nICAgICAgVG9waWNDb25uZWN0aW9uRmFjdG9yeSB0Y2YgPQogICAgICAgICAg\nICAgICAgKFRvcGljQ29ubmVjdGlvbkZhY3RvcnkpIGN0eC5sb29rdXAoX3Rj\nZk5hbWUpOwogICAgICAgICAgICBUb3BpYyB0b3BpYyA9IChUb3BpYykgY3R4\nLmxvb2t1cChfdG9waWNOYW1lKTsKICAgICAgICAgICAgY3R4LmNsb3NlKCk7\nCgogICAgICAgICAgICBfY29ubmVjdGlvbiA9IHRjZi5jcmVhdGVUb3BpY0Nv\nbm5lY3Rpb24oKTsKCiAgICAgICAgICAgIC8vIGZhbHNlID09IG5vdCB0cmFu\nc2FjdGVkLgogICAgICAgICAgICBfc2Vzc2lvbiA9IF9jb25uZWN0aW9uLmNy\nZWF0ZVRvcGljU2Vzc2lvbgogICAgICAgICAgICAgICAgKGZhbHNlLCBTZXNz\naW9uLkFVVE9fQUNLTk9XTEVER0UpOwoKICAgICAgICAgICAgLy8gY3JlYXRl\nIGEgcHVibGlzaGVyCiAgICAgICAgICAgIF9wdWJsaXNoZXIgPSBfc2Vzc2lv\nbi5jcmVhdGVQdWJsaXNoZXIodG9waWMpOwoKICAgICAgICAgICAgLy8gY3Jl\nYXRlIGEgc3Vic2NyaWJlci4KICAgICAgICAgICAgVG9waWNTdWJzY3JpYmVy\nIHMgPSBfc2Vzc2lvbi5jcmVhdGVTdWJzY3JpYmVyKHRvcGljLCBudWxsLAog\nICAgICAgICAgICAgICAgLyogbm9Mb2NhbDogKi8gdHJ1ZSk7CiAgICAgICAg\nICAgIAogICAgICAgICAgICBNZXNzYWdlTGlzdGVuZXIgbCA9IGdldE1lc3Nh\nZ2VMaXN0ZW5lcigpOwogICAgICAgICAgICBzLnNldE1lc3NhZ2VMaXN0ZW5l\ncihsKTsKICAgICAgICAgICAgX2Nvbm5lY3Rpb24uc3RhcnQoKTsKICAgICAg\nICAgICAgX2Nvbm5lY3Rpb24uc2V0RXhjZXB0aW9uTGlzdGVuZXIodGhpcyk7\nCiAgICAgICAgICAgIGlmIChsb2cuaXNJbmZvRW5hYmxlZCgpKQogICAgICAg\nICAgICAgICAgbG9nLmluZm8oc19sb2MuZ2V0KCJqbXMtc3RhcnQtbGlzdGVu\nZXIiLCBfdG9waWNOYW1lKSk7CiAgICAgICAgfSBjYXRjaCAoT3BlbkpQQUV4\nY2VwdGlvbiBrZSkgewogICAgICAgICAgICB0aHJvdyBrZTsKICAgICAgICB9\nIGNhdGNoIChFeGNlcHRpb24gZSkgewogICAgICAgICAgICB0aHJvdyBuZXcg\nVXNlckV4Y2VwdGlvbihzX2xvYy5nZXQoImptcy1wcm92aWRlci1jb25maWci\nLAogICAgICAgICAgICAgICAgX3RvcGljTmFtZSwgX3RjZk5hbWUpLCBlKS5z\nZXRGYXRhbCh0cnVlKTsKICAgICAgICB9CiAgICB9CgogICAgLyogKgogICAg\nICogUmV0dXJucyBhIHtAbGluayBqYXZheC5qbXMuTWVzc2FnZUxpc3RlbmVy\nfSBjYXBhYmxlIG9mCiAgICAgKiB1bmRlcnN0YW5kaW5nIGFuZCBwcm9jZXNz\naW5nIG1lc3NhZ2VzIGNyZWF0ZWQgYnkge0BsaW5rICNjcmVhdGVNZXNzYWdl\nfS4KICAgICAqICBUaGUgbGlzdGVuZXIgcmV0dXJuZWQgYnkgdGhpcyBtZXRo\nb2QgaXMgcmVzcG9uc2libGUgZm9yCiAgICAgKiBub3RpZnlpbmcgdGhlIHBy\nb3ZpZGVyIHRoYXQgYSByZW1vdGUgZXZlbnQgaGFzIGJlZW4gcmVjZWl2ZWQu\nCiAgICAgKi8KICAgIHByb3RlY3RlZCBNZXNzYWdlTGlzdGVuZXIgZ2V0TWVz\nc2FnZUxpc3RlbmVyKCkgewogICAgICAgIHJldHVybiBuZXcgTWVzc2FnZUxp\nc3RlbmVyKCkgewogICAgICAgICAgICBwdWJsaWMgdm9pZCBvbk1lc3NhZ2Uo\nTWVzc2FnZSBtKSB7CiAgICAgICAgICAgICAgICBpZiAoIShtIGluc3RhbmNl\nb2YgT2JqZWN0TWVzc2FnZSkpIHsKICAgICAgICAgICAgICAgICAgICBpZiAo\nbG9nLmlzV2FybkVuYWJsZWQoKSkKICAgICAgICAgICAgICAgICAgICAgICAg\nbG9nLndhcm4oc19sb2MuZ2V0KCJqbXMtcmVjZWl2ZS1lcnJvci0zIiwKICAg\nICAgICAgICAgICAgICAgICAgICAgICAgIF90b3BpY05hbWUsIG0uZ2V0Q2xh\nc3MoKS5nZXROYW1lKCkpKTsKICAgICAgICAgICAgICAgICAgICByZXR1cm47\nCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAKICAgICAgICAg\nICAgICAgIENsYXNzTG9hZGVyIHNhdmVDbHMgPSBUaHJlYWQuY3VycmVudFRo\ncmVhZCgpCiAgICAgICAgICAgICAgICAgICAgLmdldENvbnRleHRDbGFzc0xv\nYWRlcigpOwogICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAg\nICAgICBpZiAoc2F2ZUNscyAhPSBfYXBwQ2xhc3NMb2FkZXIpCiAgICAgICAg\nICAgICAgICAgICAgICAgIFRocmVhZC5jdXJyZW50VGhyZWFkKCkuc2V0Q29u\ndGV4dENsYXNzTG9hZGVyKAogICAgICAgICAgICAgICAgICAgICAgICAgICAg\nX2FwcENsYXNzTG9hZGVyKTsKICAgICAgICAgICAgICAgICAgICBPYmplY3RN\nZXNzYWdlIG9tID0gKE9iamVjdE1lc3NhZ2UpIG07CiAgICAgICAgICAgICAg\nICAgICAgT2JqZWN0IG8gPSBvbS5nZXRPYmplY3QoKTsKCiAgICAgICAgICAg\nICAgICAgICAgaWYgKG8gaW5zdGFuY2VvZiBSZW1vdGVDb21taXRFdmVudCkg\newogICAgICAgICAgICAgICAgICAgIAlpZiAobG9nLmlzVHJhY2VFbmFibGVk\nKCkpCiAgICAgICAgICAgICAgICAgICAgCQlsb2cudHJhY2Uoc19sb2MuZ2V0\nKCJqbXMtcmVjZWl2ZWQtdXBkYXRlIiwKICAgICAgICAgICAgICAgICAgICAJ\nCQkJX3RvcGljTmFtZSkpOwoKICAgICAgICAgICAgICAgICAgICAJUmVtb3Rl\nQ29tbWl0RXZlbnQgcmNlID0gKFJlbW90ZUNvbW1pdEV2ZW50KSBvOwogICAg\nICAgICAgICAgICAgICAgIAlmaXJlRXZlbnQocmNlKTsKICAgICAgICAgICAg\nICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIAlpZiAobG9n\nLmlzV2FybkVuYWJsZWQoKSkKICAgICAgICAgICAgICAgICAgICAJCWxvZy53\nYXJuKHNfbG9jLmdldCgiam1zLXJlY2VpdmUtZXJyb3ItMiIsCiAgICAgICAg\nICAgICAgICAgICAgCQkJCW8uZ2V0Q2xhc3MoKS5nZXROYW1lKCksIF90b3Bp\nY05hbWUpKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAg\nICB9IGNhdGNoIChKTVNFeGNlcHRpb24gam1zZSkgewogICAgICAgICAgICAg\nICAgICAgIGlmIChsb2cuaXNXYXJuRW5hYmxlZCgpKQogICAgICAgICAgICAg\nICAgICAgICAgICBsb2cud2FybihzX2xvYy5nZXQoImptcy1yZWNlaXZlLWVy\ncm9yLTEiKSwgam1zZSk7CiAgICAgICAgICAgICAgICB9IGZpbmFsbHkgewog\nICAgICAgICAgICAgICAgICAgIGlmIChzYXZlQ2xzICE9IF9hcHBDbGFzc0xv\nYWRlcikKICAgICAgICAgICAgICAgICAgICAgICAgVGhyZWFkLmN1cnJlbnRU\naHJlYWQoKS5zZXRDb250ZXh0Q2xhc3NMb2FkZXIoc2F2ZUNscyk7CiAgICAg\nICAgICAgICAgICB9CgogICAgICAgICAgICB9CiAgICAgICAgfTsKICAgIH0K\nCiAgICAvKioKICAgICAqIFJldHVybnMgYSBuZXcge0BsaW5rIE1lc3NhZ2V9\nIHRvIHNlbmQgdG8gdGhlIHRvcGljLiBUaGlzCiAgICAgKiBpbXBsZW1lbnRh\ndGlvbiBjcmVhdGVzIGFuIHtAbGluayBPYmplY3RNZXNzYWdlfS4KICAgICAq\nLwogICAgcHJvdGVjdGVkIE1lc3NhZ2UgY3JlYXRlTWVzc2FnZShSZW1vdGVD\nb21taXRFdmVudCBldmVudCkKICAgICAgICB0aHJvd3MgSk1TRXhjZXB0aW9u\nIHsKICAgICAgICByZXR1cm4gX3Nlc3Npb24uY3JlYXRlT2JqZWN0TWVzc2Fn\nZShldmVudCk7CiAgICB9CgogICAgcHVibGljIHZvaWQgb25FeGNlcHRpb24o\nSk1TRXhjZXB0aW9uIGV4KSB7CiAgICAgICAgaWYgKGxvZy5pc1dhcm5FbmFi\nbGVkKCkpCiAgICAgICAgICAgIGxvZy53YXJuKHNfbG9jLmdldCgiam1zLWxp\nc3RlbmVyLWVycm9yIiwgX3RvcGljTmFtZSksIGV4KTsKICAgICAgICBpZiAo\nX3JlY29ubmVjdEF0dGVtcHRzIDw9IDApCiAgICAgICAgICAgIHJldHVybjsK\nCiAgICAgICAgY2xvc2UoKTsKICAgICAgICBib29sZWFuIGNvbm5lY3RlZCA9\nIGZhbHNlOwogICAgICAgIGZvciAoaW50IGkgPSAwOyAhY29ubmVjdGVkICYm\nIGkgPCBfcmVjb25uZWN0QXR0ZW1wdHM7IGkrKykgewogICAgICAgICAgICB0\ncnkgewogICAgICAgICAgICAgICAgaWYgKGxvZy5pc0luZm9FbmFibGVkKCkp\nCiAgICAgICAgICAgICAgICAgICAgbG9nLmluZm8oc19sb2MuZ2V0KCJqbXMt\ncmVjb25uZWN0LWF0dGVtcHQiLCBfdG9waWNOYW1lLAogICAgICAgICAgICAg\nICAgICAgICAgICBTdHJpbmcudmFsdWVPZihpICsgMSkpKTsKICAgICAgICAg\nICAgICAgIGNvbm5lY3QoKTsKICAgICAgICAgICAgICAgIGNvbm5lY3RlZCA9\nIHRydWU7CiAgICAgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAg\nICAgICAgICAgICAgICBpZiAobG9nLmlzSW5mb0VuYWJsZWQoKSkKICAgICAg\nICAgICAgICAgICAgICBsb2cuaW5mbyhzX2xvYy5nZXQoImptcy1yZWNvbm5l\nY3QtZmFpbCIsIF90b3BpY05hbWUpLCBlKTsKICAgICAgICAgICAgICAgIHRy\neSB7CiAgICAgICAgICAgICAgICAgICAgVGhyZWFkLnNsZWVwKDEwMDApOwog\nICAgICAgICAgICAgICAgfSBjYXRjaCAoSW50ZXJydXB0ZWRFeGNlcHRpb24g\naWUpIHsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAg\nICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgKCFj\nb25uZWN0ZWQgJiYgbG9nLmlzRXJyb3JFbmFibGVkKCkpCiAgICAgICAgICAg\nIGxvZy5lcnJvcihzX2xvYy5nZXQoImptcy1jYW50LXJlY29ubmVjdCIsIF90\nb3BpY05hbWUsCiAgICAgICAgICAgICAgICBTdHJpbmcudmFsdWVPZihfcmVj\nb25uZWN0QXR0ZW1wdHMpKSk7CiAgICAgICAgZWxzZSBpZiAoY29ubmVjdGVk\nICYmIGxvZy5pc0luZm9FbmFibGVkKCkpCiAgICAgICAgICAgIGxvZy5pbmZv\nKHNfbG9jLmdldCgiam1zLXJlY29ubmVjdGVkIiwgX3RvcGljTmFtZSkpOwoJ\nfQp9Cg==\n","encoding":"base64"}

