{"sha":"987cafaf0196195fa3805f52f169caac6ea61258","node_id":"MDQ6QmxvYjIwNjM2NDo5ODdjYWZhZjAxOTYxOTVmYTM4MDVmNTJmMTY5Y2FhYzZlYTYxMjU4","size":35523,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/987cafaf0196195fa3805f52f169caac6ea61258","content":"LyoNCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUNCiAqIG9yIG1vcmUgY29udHJpYnV0b3Ig\nbGljZW5zZSBhZ3JlZW1lbnRzLiAgU2VlIHRoZSBOT1RJQ0UgZmlsZQ0KICog\nZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5m\nb3JtYXRpb24NCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAg\nVGhlIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUNCiAqIHRvIHlvdSB1bmRlciB0\naGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUNCiAqICJMaWNl\nbnNlIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNv\nbXBsaWFuY2UNCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFp\nbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQNCiAqDQogKiBodHRwOi8vd3d3\nLmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjANCiAqDQogKiBVbmxl\nc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGlu\nIHdyaXRpbmcsDQogKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUg\nTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbg0KICogIkFTIElTIiBCQVNJ\nUywgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZDQog\nKiBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBM\naWNlbnNlIGZvciB0aGUNCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmlu\nZyBwZXJtaXNzaW9ucyBhbmQgbGltaXRhdGlvbnMNCiAqIHVuZGVyIHRoZSBM\naWNlbnNlLiAgICANCiAqLw0KcGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEu\nZXZlbnQ7DQoNCmltcG9ydCBqYXZhLmlvLkJ1ZmZlcmVkSW5wdXRTdHJlYW07\nDQppbXBvcnQgamF2YS5pby5CeXRlQXJyYXlPdXRwdXRTdHJlYW07DQppbXBv\ncnQgamF2YS5pby5FT0ZFeGNlcHRpb247DQppbXBvcnQgamF2YS5pby5JT0V4\nY2VwdGlvbjsNCmltcG9ydCBqYXZhLmlvLklucHV0U3RyZWFtOw0KaW1wb3J0\nIGphdmEuaW8uT2JqZWN0SW5wdXRTdHJlYW07DQppbXBvcnQgamF2YS5pby5P\nYmplY3RPdXRwdXRTdHJlYW07DQppbXBvcnQgamF2YS5pby5PdXRwdXRTdHJl\nYW07DQppbXBvcnQgamF2YS5uZXQuSW5ldEFkZHJlc3M7DQppbXBvcnQgamF2\nYS5uZXQuU2VydmVyU29ja2V0Ow0KaW1wb3J0IGphdmEubmV0LlNvY2tldDsN\nCmltcG9ydCBqYXZhLm5ldC5Tb2NrZXRFeGNlcHRpb247DQppbXBvcnQgamF2\nYS5uZXQuVW5rbm93bkhvc3RFeGNlcHRpb247DQppbXBvcnQgamF2YS5zZWN1\ncml0eS5BY2Nlc3NDb250cm9sbGVyOw0KaW1wb3J0IGphdmEuc2VjdXJpdHku\nUHJpdmlsZWdlZEFjdGlvbkV4Y2VwdGlvbjsNCmltcG9ydCBqYXZhLnV0aWwu\nQXJyYXlMaXN0Ow0KaW1wb3J0IGphdmEudXRpbC5BcnJheXM7DQppbXBvcnQg\namF2YS51dGlsLkhhc2hNYXA7DQppbXBvcnQgamF2YS51dGlsLkhhc2hTZXQ7\nDQppbXBvcnQgamF2YS51dGlsLkl0ZXJhdG9yOw0KaW1wb3J0IGphdmEudXRp\nbC5MaW5rZWRMaXN0Ow0KaW1wb3J0IGphdmEudXRpbC5NYXA7DQppbXBvcnQg\namF2YS51dGlsLlNldDsNCmltcG9ydCBqYXZhLnV0aWwuTGlzdDsNCmltcG9y\ndCBqYXZhLnV0aWwuQ29sbGVjdGlvbnM7DQoNCmltcG9ydCBvcmcuYXBhY2hl\nLmNvbW1vbnMucG9vbC5Qb29sYWJsZU9iamVjdEZhY3Rvcnk7DQppbXBvcnQg\nb3JnLmFwYWNoZS5jb21tb25zLnBvb2wuaW1wbC5HZW5lcmljT2JqZWN0UG9v\nbDsNCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLmNvbmYuQ29uZmln\ndXJhYmxlOw0KaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIubG9nLkxv\nZzsNCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuSjJEb1By\naXZIZWxwZXI7DQppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51dGls\nLkxvY2FsaXplcjsNCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5H\nZW5lcmFsRXhjZXB0aW9uOw0KaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51\ndGlsLkludGVybmFsRXhjZXB0aW9uOw0KaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS51dGlsLlNlcmlhbGl6YXRpb247DQppbXBvcnQgamF2YS51dGlsLmNv\nbmN1cnJlbnQubG9ja3MuUmVlbnRyYW50TG9jazsNCg0KaW1wb3J0IHNlcnAu\ndXRpbC5TdHJpbmdzOw0KDQovKioNCiAqIFRDUC1iYXNlZCBpbXBsZW1lbnRh\ndGlvbiBvZiB7QGxpbmsgUmVtb3RlQ29tbWl0UHJvdmlkZXJ9IHRoYXQNCiAq\nIGxpc3RlbnMgZm9yIG9iamVjdCBtb2RpZmljYXRpb25zIGFuZCBwcm9wYWdh\ndGVzIHRob3NlIGNoYW5nZXMgdG8NCiAqIG90aGVyIFJlbW90ZUNvbW1pdFBy\nb3ZpZGVycyBvdmVyIFRDUCBzb2NrZXRzLg0KICoNCiAqIEBhdXRob3IgQnJp\nYW4gTGVhaXINCiAqIEBhdXRob3IgUGF0cmljayBMaW5za2V5DQogKiBAc2lu\nY2UgMC4yLjUuMA0KICovDQpwdWJsaWMgY2xhc3MgVENQUmVtb3RlQ29tbWl0\nUHJvdmlkZXINCiAgICBleHRlbmRzIEFic3RyYWN0UmVtb3RlQ29tbWl0UHJv\ndmlkZXINCiAgICBpbXBsZW1lbnRzIENvbmZpZ3VyYWJsZSB7DQoNCiAgICBw\ncml2YXRlIHN0YXRpYyBmaW5hbCBpbnQgREVGQVVMVF9QT1JUID0gNTYzNjsN\nCg0KICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIExvY2FsaXplciBzX2xvYyA9\nIExvY2FsaXplci5mb3JQYWNrYWdlDQogICAgICAgIChUQ1BSZW1vdGVDb21t\naXRQcm92aWRlci5jbGFzcyk7DQogICAgcHJpdmF0ZSBzdGF0aWMgbG9uZyBz\nX2lkU2VxdWVuY2UgPSBTeXN0ZW0uY3VycmVudFRpbWVNaWxsaXMoKTsNCg0K\nICAgIC8vCUEgbWFwIG9mIGxpc3RlbiBwb3J0cyB0byBsaXN0ZW5lcnMgaW4g\ndGhpcyBKVk0uIFdlIG1pZ2h0DQogICAgLy8Jd2FudCB0byBsb29rIGludG8g\nYWxsb3dpbmcgc2FtZSBwb3J0LCBkaWZmZXJlbnQgaW50ZXJmYWNlIC0tDQog\nICAgLy8JdGhhdCBpcyBub3QgY3VycmVudGx5IHBvc3NpYmxlIGluIGEgc2lu\nZ2xlIEpWTS4NCiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBNYXAgc19wb3J0\nTGlzdGVuZXJNYXAgPSBuZXcgSGFzaE1hcCgpOw0KDQogICAgcHJpdmF0ZSBs\nb25nIF9pZDsNCiAgICBwcml2YXRlIGJ5dGVbXSBfbG9jYWxob3N0Ow0KICAg\nIHByaXZhdGUgaW50IF9wb3J0ID0gREVGQVVMVF9QT1JUOw0KICAgIHByaXZh\ndGUgaW50IF9tYXhBY3RpdmUgPSAyOw0KICAgIHByaXZhdGUgaW50IF9tYXhJ\nZGxlID0gMjsNCiAgICBwcml2YXRlIGludCBfcmVjb3ZlcnlUaW1lTWlsbGlz\nID0gMTUwMDA7DQogICAgcHJpdmF0ZSBUQ1BQb3J0TGlzdGVuZXIgX2xpc3Rl\nbmVyOw0KICAgIHByaXZhdGUgQnJvYWRjYXN0UXVldWUgX2Jyb2FkY2FzdFF1\nZXVlID0gbmV3IEJyb2FkY2FzdFF1ZXVlKCk7DQogICAgcHJpdmF0ZSBmaW5h\nbCBMaXN0IF9icm9hZGNhc3RUaHJlYWRzID0gQ29sbGVjdGlvbnMuc3luY2hy\nb25pemVkTGlzdCgNCiAgICAgICAgbmV3IExpbmtlZExpc3QoKSk7DQoNCiAg\nICBwcml2YXRlIEFycmF5TGlzdCBfYWRkcmVzc2VzID0gbmV3IEFycmF5TGlz\ndCgpOw0KICAgIHByaXZhdGUgUmVlbnRyYW50TG9jayBfYWRkcmVzc2VzTG9j\nazsNCg0KICAgIHB1YmxpYyBUQ1BSZW1vdGVDb21taXRQcm92aWRlcigpDQog\nICAgICAgIHRocm93cyBVbmtub3duSG9zdEV4Y2VwdGlvbiB7DQogICAgICAg\nIC8vIG9idGFpbiBhIHVuaXF1ZSBJRC4NCiAgICAgICAgc3luY2hyb25pemVk\nIChUQ1BSZW1vdGVDb21taXRQcm92aWRlci5jbGFzcykgew0KICAgICAgICAg\nICAgX2lkID0gc19pZFNlcXVlbmNlKys7DQogICAgICAgIH0NCg0KICAgICAg\nICAvLyBjYWNoZSB0aGUgbG9jYWwgSVAgYWRkcmVzcy4NCiAgICAgICAgX2xv\nY2FsaG9zdCA9IEluZXRBZGRyZXNzLmdldExvY2FsSG9zdCgpLmdldEFkZHJl\nc3MoKTsNCiAgICAgICAgX2FkZHJlc3Nlc0xvY2sgPSBuZXcgUmVlbnRyYW50\nTG9jaygpOw0KICAgICAgICBzZXROdW1Ccm9hZGNhc3RUaHJlYWRzKDIpOw0K\nICAgIH0NCg0KICAgIC8qKg0KICAgICAqIFRoZSBwb3J0IHRoYXQgdGhpcyBw\ncm92aWRlciBzaG91bGQgbGlzdGVuIG9uLg0KICAgICAqLw0KICAgIHB1Ymxp\nYyBpbnQgZ2V0UG9ydCgpIHsNCiAgICAgICAgcmV0dXJuIF9wb3J0Ow0KICAg\nIH0NCg0KICAgIC8qKg0KICAgICAqIFRoZSBwb3J0IHRoYXQgdGhpcyBwcm92\naWRlciBzaG91bGQgbGlzdGVuIG9uLiBTZXQgb25jZSBvbmx5Lg0KICAgICAq\nLw0KICAgIHB1YmxpYyB2b2lkIHNldFBvcnQoaW50IHBvcnQpIHsNCiAgICAg\nICAgX3BvcnQgPSBwb3J0Ow0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIFRo\nZSBudW1iZXIgb2YgbWlsbGlzZWNvbmRzIHRvIHdhaXQgYmVmb3JlIHJldHJ5\naW5nDQogICAgICogdG8gcmVjb25uZWN0IHRvIGEgcGVlciBhZnRlciBpdCBi\nZWNvbWVzIHVucmVhY2hhYmxlLg0KICAgICAqLw0KICAgIHB1YmxpYyB2b2lk\nIHNldFJlY292ZXJ5VGltZU1pbGxpcyhpbnQgcmVjb3Zlcnl0aW1lKSB7DQog\nICAgICAgIF9yZWNvdmVyeVRpbWVNaWxsaXMgPSByZWNvdmVyeXRpbWU7DQog\nICAgfQ0KDQogICAgLyoqDQogICAgICogVGhlIG51bWJlciBvZiBtaWxsaXNl\nY29uZHMgdG8gd2FpdCBiZWZvcmUgcmV0cnlpbmcNCiAgICAgKiB0byByZWNv\nbm5lY3QgdG8gYSBwZWVyIGFmdGVyIGl0IGJlY29tZXMgdW5yZWFjaGFibGUu\nDQogICAgICovDQogICAgcHVibGljIGludCBnZXRSZWNvdmVyeVRpbWVNaWxs\naXMoKSB7DQogICAgICAgIHJldHVybiBfcmVjb3ZlcnlUaW1lTWlsbGlzOw0K\nICAgIH0NCg0KICAgIC8qKg0KICAgICAqIFRoZSBtYXhpbXVtIG51bWJlciBv\nZiBzb2NrZXRzIHRoYXQgdGhpcyBwcm92aWRlciBjYW4NCiAgICAgKiBzaW1l\ndGFuZW91c2x5IG9wZW4gdG8gZWFjaCBwZWVyIGluIHRoZSBjbHVzdGVyLg0K\nICAgICAqLw0KICAgIHB1YmxpYyB2b2lkIHNldE1heEFjdGl2ZShpbnQgbWF4\nQWN0aXZlKSB7DQogICAgICAgIF9tYXhBY3RpdmUgPSBtYXhBY3RpdmU7DQog\nICAgfQ0KDQogICAgLyoqDQogICAgICogVGhlIG1heGltdW0gbnVtYmVyIG9m\nIHNvY2tldHMgdGhhdCB0aGlzIHByb3ZpZGVyIGNhbg0KICAgICAqIHNpbWV0\nYW5lb3VzbHkgb3BlbiB0byBlYWNoIHBlZXIgaW4gdGhlIGNsdXN0ZXIuDQog\nICAgICovDQogICAgcHVibGljIGludCBnZXRNYXhBY3RpdmUoKSB7DQogICAg\nICAgIHJldHVybiBfbWF4QWN0aXZlOw0KICAgIH0NCg0KICAgIC8qKg0KICAg\nICAqIFRoZSBudW1iZXIgb2YgaWRsZSBzb2NrZXRzIHRoYXQgdGhpcyBwcm92\naWRlciBjYW4ga2VlcCBvcGVuDQogICAgICogdG8gZWFjaCBwZWVyIGluIHRo\nZSBjbHVzdGVyLg0KICAgICAqLw0KICAgIHB1YmxpYyB2b2lkIHNldE1heElk\nbGUoaW50IG1heElkbGUpIHsNCiAgICAgICAgX21heElkbGUgPSBtYXhJZGxl\nOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIFRoZSBudW1iZXIgb2YgaWRs\nZSBzb2NrZXRzIHRoYXQgdGhpcyBwcm92aWRlciBjYW4ga2VlcCBvcGVuDQog\nICAgICogdG8gZWFjaCBwZWVyIGluIHRoZSBjbHVzdGVyLg0KICAgICAqLw0K\nICAgIHB1YmxpYyBpbnQgZ2V0TWF4SWRsZSgpIHsNCiAgICAgICAgcmV0dXJu\nIF9tYXhJZGxlOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIFRoZSBudW1i\nZXIgb2Ygd29ya2VyIHRocmVhZHMgdGhhdCBhcmUgdXNlZCBmb3INCiAgICAg\nKiB0cmFuc21pdHRpbmcgcGFja2V0cyB0byBwZWVycyBpbiB0aGUgY2x1c3Rl\nci4NCiAgICAgKi8NCiAgICBwdWJsaWMgdm9pZCBzZXROdW1Ccm9hZGNhc3RU\naHJlYWRzKGludCBudW1Ccm9hZGNhc3RUaHJlYWRzKSB7DQogICAgICAgIHN5\nbmNocm9uaXplZCAoX2Jyb2FkY2FzdFRocmVhZHMpIHsNCiAgICAgICAgICAg\nIGludCBjdXIgPSBfYnJvYWRjYXN0VGhyZWFkcy5zaXplKCk7DQogICAgICAg\nICAgICBpZiAoY3VyID4gbnVtQnJvYWRjYXN0VGhyZWFkcykgew0KICAgICAg\nICAgICAgICAgIC8vIE5vdGlmeSB0aGUgZXh0cmEgd29ya2VyIHRocmVhZHMg\nc28gdGhleSBzdG9wIHRoZW1zZWx2ZXMNCiAgICAgICAgICAgICAgICAvLyBU\naHJlYWRzIHdpbGwgbm90IGVuZCB1bnRpbCB0aGV5IHNlbmQgYW5vdGhlciBw\nay4NCiAgICAgICAgICAgICAgICBmb3IgKGludCBpID0gbnVtQnJvYWRjYXN0\nVGhyZWFkczsgaSA8IGN1cjsgaSsrKSB7DQogICAgICAgICAgICAgICAgICAg\nIEJyb2FkY2FzdFdvcmtlclRocmVhZCB3b3JrZXIgPSAoQnJvYWRjYXN0V29y\na2VyVGhyZWFkKQ0KICAgICAgICAgICAgICAgICAgICAgICAgX2Jyb2FkY2Fz\ndFRocmVhZHMucmVtb3ZlKDApOw0KICAgICAgICAgICAgICAgICAgICB3b3Jr\nZXIuc2V0UnVubmluZyhmYWxzZSk7DQogICAgICAgICAgICAgICAgfQ0KICAg\nICAgICAgICAgfSBlbHNlIGlmIChjdXIgPCBudW1Ccm9hZGNhc3RUaHJlYWRz\nKSB7DQogICAgICAgICAgICAgICAgLy8gQ3JlYXRlIGFkZGl0aW9uYWwgd29y\na2VyIHRocmVhZHMNCiAgICAgICAgICAgICAgICBmb3IgKGludCBpID0gY3Vy\nOyBpIDwgbnVtQnJvYWRjYXN0VGhyZWFkczsgaSsrKSB7DQogICAgICAgICAg\nICAgICAgICAgIEJyb2FkY2FzdFdvcmtlclRocmVhZCB3dCA9IG5ldyBCcm9h\nZGNhc3RXb3JrZXJUaHJlYWQoKTsNCiAgICAgICAgICAgICAgICAgICAgd3Qu\nc2V0RGFlbW9uKHRydWUpOw0KICAgICAgICAgICAgICAgICAgICB3dC5zdGFy\ndCgpOw0KICAgICAgICAgICAgICAgICAgICBfYnJvYWRjYXN0VGhyZWFkcy5h\nZGQod3QpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAg\nICAgICAgfQ0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIFRoZSBudW1iZXIg\nb2Ygd29ya2VyIHRocmVhZHMgdGhhdCBhcmUgdXNlZCBmb3INCiAgICAgKiB0\ncmFuc21pdHRpbmcgcGFja2V0cyB0byBwZWVycyBpbiB0aGUgY2x1c3Rlci4N\nCiAgICAgKi8NCiAgICBwdWJsaWMgaW50IGdldE51bUJyb2FkY2FzdFRocmVh\nZHMoKSB7DQogICAgICAgIHJldHVybiBfYnJvYWRjYXN0VGhyZWFkcy5zaXpl\nKCk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICogU2V0cyB0aGUgbGlzdCBv\nZiBhZGRyZXNzZXMgb2YgcGVlcnMgdG8gd2hpY2ggdGhpcyBwcm92aWRlciB3\naWxsDQogICAgICogc2VuZCBldmVudHMgdG8uIFRoZSBwZWVycyBhcmUgc2Vt\naWNvbG9uLXNlcGFyYXRlZCA8Y29kZT5uYW1lczwvY29kZT4NCiAgICAgKiBs\naXN0IGluIHRoZSBmb3JtIG9mICJteWhvc3QxOnBvcnRBO215aG9zdDI6cG9y\ndEIiLg0KICAgICAqLw0KICAgIHB1YmxpYyB2b2lkIHNldEFkZHJlc3NlcyhT\ndHJpbmcgbmFtZXMpDQogICAgICAgIHRocm93cyBVbmtub3duSG9zdEV4Y2Vw\ndGlvbiB7DQogICAgICAgIC8vIE5ZSS4gQ291bGQgbG9vayBmb3IgZXF1aXZh\nbGVuY2Ugb2YgYWRkcmVzc2VzIGFuZCBhdm9pZA0KICAgICAgICAvLyBjaGFu\nZ2luZyB0aG9zZSB0aGF0IGRpZG4ndCBjaGFuZ2UuDQoNCiAgICAgICAgX2Fk\nZHJlc3Nlc0xvY2subG9jaygpOw0KICAgICAgICB0cnkgew0KICAgICAgICAg\nICAgZm9yIChJdGVyYXRvciBpdGVyID0gX2FkZHJlc3Nlcy5pdGVyYXRvcigp\nOyBpdGVyLmhhc05leHQoKTspIHsNCiAgICAgICAgICAgICAgICAoKEhvc3RB\nZGRyZXNzKSBpdGVyLm5leHQoKSkuY2xvc2UoKTsNCiAgICAgICAgICAgIH0N\nCiAgICAgICAgICAgIFN0cmluZ1tdIHRva3MgPSBTdHJpbmdzLnNwbGl0KG5h\nbWVzLCAiOyIsIDApOw0KICAgICAgICAgICAgX2FkZHJlc3NlcyA9IG5ldyBB\ncnJheUxpc3QodG9rcy5sZW5ndGgpOw0KDQogICAgICAgICAgICBJbmV0QWRk\ncmVzcyBsb2NhbGhvc3QgPSBJbmV0QWRkcmVzcy5nZXRMb2NhbEhvc3QoKTsN\nCiAgICAgICAgICAgIFN0cmluZyBsb2NhbGhvc3ROYW1lID0gbG9jYWxob3N0\nLmdldEhvc3ROYW1lKCk7DQoNCiAgICAgICAgICAgIGZvciAoaW50IGkgPSAw\nOyBpIDwgdG9rcy5sZW5ndGg7IGkrKykgew0KICAgICAgICAgICAgICAgIFN0\ncmluZyBob3N0ID0gdG9rc1tpXTsNCiAgICAgICAgICAgICAgICBTdHJpbmcg\naG9zdG5hbWU7DQogICAgICAgICAgICAgICAgaW50IHRtcFBvcnQ7DQogICAg\nICAgICAgICAgICAgaW50IGNvbG9uID0gaG9zdC5pbmRleE9mKCc6Jyk7DQog\nICAgICAgICAgICAgICAgaWYgKGNvbG9uICE9IC0xKSB7DQogICAgICAgICAg\nICAgICAgICAgIGhvc3RuYW1lID0gaG9zdC5zdWJzdHJpbmcoMCwgY29sb24p\nOw0KICAgICAgICAgICAgICAgICAgICB0bXBQb3J0ID0gSW50ZWdlci5wYXJz\nZUludChob3N0LnN1YnN0cmluZyhjb2xvbiArIDEpKTsNCiAgICAgICAgICAg\nICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICBob3N0bmFtZSA9\nIGhvc3Q7DQogICAgICAgICAgICAgICAgICAgIHRtcFBvcnQgPSBERUZBVUxU\nX1BPUlQ7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIElu\nZXRBZGRyZXNzIHRtcEFkZHJlc3MgPSAoSW5ldEFkZHJlc3MpIEFjY2Vzc0Nv\nbnRyb2xsZXINCiAgICAgICAgICAgICAgICAgICAgLmRvUHJpdmlsZWdlZChK\nMkRvUHJpdkhlbHBlci5nZXRCeU5hbWVBY3Rpb24oaG9zdG5hbWUpKTsgDQoN\nCiAgICAgICAgICAgICAgICAvLyBibGVhaXI6IEZvciBlYWNoIGFkZHJlc3Mg\nd2Ugd291bGQgcmF0aGVyIG1ha2UgdXNlIG9mDQogICAgICAgICAgICAgICAg\nLy8gdGhlIGpkazEuNCBpc0xpbmtMb2NhbEFkZHJlc3MgKCkgfHwgaXNMb29w\nYmFja0FkZHJlc3MgKCkuDQogICAgICAgICAgICAgICAgLy8gKFRob3VnaCBp\nbiBwcmFjdGljZSBvbiB3aW4zMiB0aGV5IGRvbid0IHdvcmsgYW55d2F5cyEp\nDQogICAgICAgICAgICAgICAgLy8gSW5zdGVhZCB3ZSB3aWxsIGNoZWNrIGhv\nc3RuYW1lLiBOb3QgcGVyZmVjdCwgYnV0DQogICAgICAgICAgICAgICAgLy8g\naXQgd2lsbCBtYXRjaCBvZnRlbiBlbm91Z2ggKHBlb3BsZSB3aWxsIHR5cGlj\nYWxseQ0KICAgICAgICAgICAgICAgIC8vIHVzZSB0aGUgRE5TIG1hY2hpbmUg\nbmFtZXMgYW5kIGJlIGN1dHRpbmcvcGFzdGluZy4pDQogICAgICAgICAgICAg\nICAgaWYgKGxvY2FsaG9zdE5hbWUuZXF1YWxzKGhvc3RuYW1lKSkgew0KICAg\nICAgICAgICAgICAgICAgICAvLyBUaGlzIHN0cmluZyBtYXRjaGVzIHRoZSBo\nb3N0bmFtZSBmb3IgZm9yIG91cnNlbHZlcywgd2UNCiAgICAgICAgICAgICAg\nICAgICAgLy8gZG9uJ3QgYWN0dWFsbHkgbmVlZCB0byBzZW5kIG91cnNlbHZl\ncyBtZXNzYWdlcy4NCiAgICAgICAgICAgICAgICAgICAgaWYgKGxvZy5pc1Ry\nYWNlRW5hYmxlZCgpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBsb2cu\ndHJhY2Uoc19sb2MuZ2V0KCJ0Y3AtYWRkcmVzcy1hc3NlbGYiLA0KICAgICAg\nICAgICAgICAgICAgICAgICAgICAgIHRtcEFkZHJlc3MuZ2V0SG9zdE5hbWUo\nKSArICI6IiArIHRtcFBvcnQpKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0K\nICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAg\nIEhvc3RBZGRyZXNzIG5ld0FkZHJlc3MgPSBuZXcgSG9zdEFkZHJlc3MoaG9z\ndCk7DQogICAgICAgICAgICAgICAgICAgIF9hZGRyZXNzZXMuYWRkKG5ld0Fk\nZHJlc3MpOw0KICAgICAgICAgICAgICAgICAgICBpZiAobG9nLmlzVHJhY2VF\nbmFibGVkKCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGxvZy50cmFj\nZShzX2xvYy5nZXQoInRjcC1hZGRyZXNzLXNldCIsDQogICAgICAgICAgICAg\nICAgICAgICAgICAgICAgbmV3QWRkcmVzcy5fYWRkcmVzcy5nZXRIb3N0TmFt\nZSgpICsgIjoiDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICsg\nbmV3QWRkcmVzcy5fcG9ydCkpOw0KICAgICAgICAgICAgICAgICAgICB9DQog\nICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9IGNh\ndGNoIChQcml2aWxlZ2VkQWN0aW9uRXhjZXB0aW9uIHBhZSkgew0KICAgICAg\nICAgICAgdGhyb3cgKFVua25vd25Ib3N0RXhjZXB0aW9uKSBwYWUuZ2V0RXhj\nZXB0aW9uKCk7DQogICAgICAgIH0gZmluYWxseSB7DQogICAgICAgICAgICBf\nYWRkcmVzc2VzTG9jay51bmxvY2soKTsNCiAgICAgICAgfQ0KICAgIH0NCg0K\nICAgIC8vIC0tLS0tLS0tLS0gQ29uZmlndXJhYmxlIGltcGxlbWVudGF0aW9u\nIC0tLS0tLS0tLS0NCg0KICAgIC8qKg0KICAgICAqIFN1YmNsYXNzZXMgdGhh\ndCBuZWVkIHRvIHBlcmZvcm0gYWN0aW9ucyBpbg0KICAgICAqIHtAbGluayBD\nb25maWd1cmFibGUjZW5kQ29uZmlndXJhdGlvbn0gbXVzdCBpbnZva2UgdGhp\ncyBtZXRob2QuDQogICAgICovDQogICAgcHVibGljIHZvaWQgZW5kQ29uZmln\ndXJhdGlvbigpIHsNCiAgICAgICAgc3VwZXIuZW5kQ29uZmlndXJhdGlvbigp\nOw0KICAgICAgICBzeW5jaHJvbml6ZWQgKHNfcG9ydExpc3RlbmVyTWFwKSB7\nDQogICAgICAgICAgICAvLyBzZWUgaWYgYSBsaXN0ZW5lciBleGlzdHMgZm9y\nIHRoaXMgcG9ydC4NCiAgICAgICAgICAgIF9saXN0ZW5lciA9IChUQ1BQb3J0\nTGlzdGVuZXIpIHNfcG9ydExpc3RlbmVyTWFwLmdldA0KICAgICAgICAgICAg\nICAgIChTdHJpbmcudmFsdWVPZihfcG9ydCkpOw0KDQogICAgICAgICAgICBp\nZiAoX2xpc3RlbmVyID09IG51bGwgfHwNCiAgICAgICAgICAgICAgICAoIV9s\naXN0ZW5lci5pc1J1bm5pbmcoKSAmJiBfbGlzdGVuZXIuX3BvcnQgPT0gX3Bv\ncnQpKSB7DQogICAgICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAg\nICAgICAgX2xpc3RlbmVyID0gbmV3IFRDUFBvcnRMaXN0ZW5lcihfcG9ydCwg\nbG9nKTsNCiAgICAgICAgICAgICAgICAgICAgX2xpc3RlbmVyLmxpc3Rlbigp\nOw0KICAgICAgICAgICAgICAgICAgICBzX3BvcnRMaXN0ZW5lck1hcC5wdXQo\nU3RyaW5nLnZhbHVlT2YoX3BvcnQpLCBfbGlzdGVuZXIpOw0KICAgICAgICAg\nICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7DQogICAgICAgICAgICAg\nICAgICAgIHRocm93IG5ldyBHZW5lcmFsRXhjZXB0aW9uKHNfbG9jLmdldCgi\ndGNwLWluaXQtZXhjZXB0aW9uIiwNCiAgICAgICAgICAgICAgICAgICAgICAg\nIFN0cmluZy52YWx1ZU9mKF9wb3J0KSksIGUpLnNldEZhdGFsKHRydWUpOw0K\nICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0gZWxzZSBpZiAoX2xp\nc3RlbmVyLmlzUnVubmluZygpKSB7DQogICAgICAgICAgICAgICAgaWYgKF9s\naXN0ZW5lci5fcG9ydCAhPSBfcG9ydCkgew0KICAgICAgICAgICAgICAgICAg\nICAvLyB0aGlzIHJlYWxseSBzaG91bGRuJ3QgYmUgYWJsZSB0byBoYXBwZW4u\nDQogICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBHZW5lcmFsRXhjZXB0\naW9uKHNfbG9jLmdldA0KICAgICAgICAgICAgICAgICAgICAgICAgKCJ0Y3At\nbm90LWVxdWFsIiwgU3RyaW5nLnZhbHVlT2YoX3BvcnQpKSkuDQogICAgICAg\nICAgICAgICAgICAgICAgICBzZXRGYXRhbCh0cnVlKTsNCiAgICAgICAgICAg\nICAgICB9DQogICAgICAgICAgICB9IGVsc2UNCiAgICAgICAgICAgICAgICB0\naHJvdyBuZXcgSW50ZXJuYWxFeGNlcHRpb24oc19sb2MuZ2V0KCJ0Y3AtbGlz\ndGVuZXItYnJva2VuIikpOw0KICAgICAgICAgICAgX2xpc3RlbmVyLmFkZFBy\nb3ZpZGVyKHRoaXMpOw0KICAgICAgICB9DQoNCiAgICAgICAgX2FkZHJlc3Nl\nc0xvY2subG9jaygpOw0KICAgICAgICB0cnkgew0KICAgICAgICAgICAgSG9z\ndEFkZHJlc3MgY3VyQWRkcmVzczsNCiAgICAgICAgICAgIGZvciAoSXRlcmF0\nb3IgaXRlciA9IF9hZGRyZXNzZXMuaXRlcmF0b3IoKTsNCiAgICAgICAgICAg\nICAgICBpdGVyLmhhc05leHQoKTspIHsNCiAgICAgICAgICAgICAgICBjdXJB\nZGRyZXNzID0gKEhvc3RBZGRyZXNzKSBpdGVyLm5leHQoKTsNCiAgICAgICAg\nICAgICAgICBjdXJBZGRyZXNzLnNldE1heEFjdGl2ZShfbWF4QWN0aXZlKTsN\nCiAgICAgICAgICAgICAgICBjdXJBZGRyZXNzLnNldE1heElkbGUoX21heElk\nbGUpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIGZpbmFs\nbHkgew0KICAgICAgICAgICAgX2FkZHJlc3Nlc0xvY2sudW5sb2NrKCk7DQog\nICAgICAgIH0NCiAgICB9DQoNCiAgICAvLyAtLS0tLS0tLS0tIFJlbW90ZUNv\nbW1pdFByb3ZpZGVyIGltcGxlbWVudGF0aW9uIC0tLS0tLS0tLS0NCg0KICAg\nIC8vIHByZSAzLjMuNAk9IDxubyB2ZXJzaW9uIG51bWJlciB0cmFuc21pdHRl\nZD4NCiAgICAvLyAzLjMgUHJldmlldyAJPSAweDE0MjhhY2ZkOw0KICAgIC8v\nIDMuNCAJCQk9IDB4MTQyOGFjZmY7DQogICAgcHJpdmF0ZSBzdGF0aWMgZmlu\nYWwgbG9uZyBQUk9UT0NPTF9WRVJTSU9OID0gMHgxNDI4YWNmZjsNCg0KICAg\nIHB1YmxpYyB2b2lkIGJyb2FkY2FzdChSZW1vdGVDb21taXRFdmVudCBldmVu\ndCkgew0KICAgICAgICB0cnkgew0KICAgICAgICAgICAgLy8gYnVpbGQgYSBw\nYWNrZXQgbm90aWZ5aW5nIG90aGVyIEpWTXMgb2Ygb2JqZWN0IGNoYW5nZXMu\nDQogICAgICAgICAgICBCeXRlQXJyYXlPdXRwdXRTdHJlYW0gYmFvcyA9IG5l\ndyBCeXRlQXJyYXlPdXRwdXRTdHJlYW0oKTsNCiAgICAgICAgICAgIE9iamVj\ndE91dHB1dFN0cmVhbSBvb3MgPSBuZXcgT2JqZWN0T3V0cHV0U3RyZWFtKGJh\nb3MpOw0KDQogICAgICAgICAgICBvb3Mud3JpdGVMb25nKFBST1RPQ09MX1ZF\nUlNJT04pOw0KICAgICAgICAgICAgb29zLndyaXRlTG9uZyhfaWQpOw0KICAg\nICAgICAgICAgb29zLndyaXRlSW50KF9wb3J0KTsNCiAgICAgICAgICAgIG9v\ncy53cml0ZU9iamVjdChfbG9jYWxob3N0KTsNCiAgICAgICAgICAgIG9vcy53\ncml0ZU9iamVjdChldmVudCk7DQogICAgICAgICAgICBvb3MuZmx1c2goKTsN\nCg0KICAgICAgICAgICAgYnl0ZVtdIGJ5dGVzID0gYmFvcy50b0J5dGVBcnJh\neSgpOw0KICAgICAgICAgICAgYmFvcy5jbG9zZSgpOw0KICAgICAgICAgICAg\naWYgKF9icm9hZGNhc3RUaHJlYWRzLmlzRW1wdHkoKSkNCiAgICAgICAgICAg\nICAgICBzZW5kVXBkYXRlUGFja2V0KGJ5dGVzKTsNCiAgICAgICAgICAgIGVs\nc2UNCiAgICAgICAgICAgICAgICBfYnJvYWRjYXN0UXVldWUuYWRkUGFja2V0\nKGJ5dGVzKTsNCiAgICAgICAgfSBjYXRjaCAoSU9FeGNlcHRpb24gaW9lKSB7\nDQogICAgICAgICAgICBpZiAobG9nLmlzV2FybkVuYWJsZWQoKSkNCiAgICAg\nICAgICAgICAgICBsb2cud2FybihzX2xvYy5nZXQoInRjcC1wYXlsb2FkLWNy\nZWF0ZS1lcnJvciIpLCBpb2UpOw0KICAgICAgICB9DQogICAgfQ0KDQogICAg\nLyoqDQogICAgICogU2VuZHMgYSBjaGFuZ2Ugbm90aWZpY2F0aW9uIHBhY2tl\ndCB0byBvdGhlciBtYWNoaW5lcyBpbiB0aGlzDQogICAgICogcHJvdmlkZXIg\nY2x1c3Rlci4NCiAgICAgKi8NCiAgICBwcml2YXRlIHZvaWQgc2VuZFVwZGF0\nZVBhY2tldChieXRlW10gYnl0ZXMpIHsNCiAgICAgICAgX2FkZHJlc3Nlc0xv\nY2subG9jaygpOw0KICAgICAgICB0cnkgew0KICAgICAgICAgICAgZm9yIChJ\ndGVyYXRvciBpdGVyID0gX2FkZHJlc3Nlcy5pdGVyYXRvcigpOyBpdGVyLmhh\nc05leHQoKTspDQogICAgICAgICAgICAgICAgKChIb3N0QWRkcmVzcykgaXRl\nci5uZXh0KCkpLnNlbmRVcGRhdGVQYWNrZXQoYnl0ZXMpOw0KICAgICAgICB9\nIGZpbmFsbHkgew0KICAgICAgICAgICAgX2FkZHJlc3Nlc0xvY2sudW5sb2Nr\nKCk7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICBwdWJsaWMgdm9pZCBjbG9z\nZSgpIHsNCiAgICAgICAgaWYgKF9saXN0ZW5lciAhPSBudWxsKQ0KICAgICAg\nICAgICAgX2xpc3RlbmVyLnJlbW92ZVByb3ZpZGVyKHRoaXMpOw0KDQogICAg\nICAgIC8vIFJlbW92ZSBCcm9hZGNhc3QgVGhyZWFkcyB0aGVuIGNsb3NlIHNv\nY2tldHMuDQogICAgICAgIF9icm9hZGNhc3RRdWV1ZS5jbG9zZSgpOw0KDQog\nICAgICAgIC8vIFdhaXQgZm9yIF9icm9hZGNhc3RUaHJlYWRzIHRvIGdldCBj\nbGVhbmVkIHVwLg0KICAgICAgICB3aGlsZSghX2Jyb2FkY2FzdFRocmVhZHMu\naXNFbXB0eSgpKSB7DQogICAgICAgICAgICB0cnkgew0KICAgICAgICAgICAg\nICAgIFRocmVhZC5zbGVlcCg1MDApOw0KICAgICAgICAgICAgfSBjYXRjaCAo\nSW50ZXJydXB0ZWRFeGNlcHRpb24gaWUpIHsNCiAgICAgICAgICAgICAgICAv\nLyBJZ25vcmUuDQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAg\nDQogICAgICAgIF9hZGRyZXNzZXNMb2NrLmxvY2soKTsNCiAgICAgICAgdHJ5\nIHsNCiAgICAgICAgICAgIGZvciAoSXRlcmF0b3IgaXRlciA9IF9hZGRyZXNz\nZXMuaXRlcmF0b3IoKTsgaXRlci5oYXNOZXh0KCk7KQ0KICAgICAgICAgICAg\nICAgICgoSG9zdEFkZHJlc3MpIGl0ZXIubmV4dCgpKS5jbG9zZSgpOw0KICAg\nICAgICB9IGZpbmFsbHkgew0KICAgICAgICAgICAgX2FkZHJlc3Nlc0xvY2su\ndW5sb2NrKCk7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICAvKioNCiAgICAg\nKiBVdGlsaXR5IGNsYXNzIHRvIGhvbGQgbWVzc2FnZXMgdG8gYmUgc2VudC4g\nVGhpcw0KICAgICAqIGFsbG93cyBjYWxscyB0byBicm9hZGNhc3QgKCkgdG8g\ncmV0dXJuIHdpdGhvdXQNCiAgICAgKiB3YWl0aW5nIGZvciB0aGUgc2VuZCB0\nbyBjb21wbGV0ZS4NCiAgICAgKi8NCiAgICBwcml2YXRlIHN0YXRpYyBjbGFz\ncyBCcm9hZGNhc3RRdWV1ZSB7DQoNCiAgICAgICAgcHJpdmF0ZSBMaW5rZWRM\naXN0IF9wYWNrZXRRdWV1ZSA9IG5ldyBMaW5rZWRMaXN0KCk7DQogICAgICAg\nIHByaXZhdGUgYm9vbGVhbiBfY2xvc2VkID0gZmFsc2U7DQoNCiAgICAgICAg\ncHVibGljIHN5bmNocm9uaXplZCB2b2lkIGNsb3NlKCkgew0KICAgICAgICAg\nICAgX2Nsb3NlZCA9IHRydWU7DQogICAgICAgICAgICBub3RpZnlBbGwoKTsN\nCiAgICAgICAgfQ0KDQogICAgICAgIHB1YmxpYyBzeW5jaHJvbml6ZWQgYm9v\nbGVhbiBpc0Nsb3NlZCgpIHsNCiAgICAgICAgICAgIHJldHVybiBfY2xvc2Vk\nOw0KICAgICAgICB9DQoNCiAgICAgICAgcHVibGljIHN5bmNocm9uaXplZCB2\nb2lkIGFkZFBhY2tldChieXRlW10gYnl0ZXMpIHsNCiAgICAgICAgICAgIF9w\nYWNrZXRRdWV1ZS5hZGRMYXN0KGJ5dGVzKTsNCiAgICAgICAgICAgIG5vdGlm\neSgpOw0KICAgICAgICB9DQoNCiAgICAgICAgLyoqDQogICAgICAgICAqIEBy\nZXR1cm4gdGhlIGJ5dGVzIGRlZmluaW5nIHRoZSBwYWNrZXQgdG8gcHJvY2Vz\ncywgb3INCiAgICAgICAgICogPGNvZGU+bnVsbDwvY29kZT4gaWYgdGhlIHF1\nZXVlIGlzIGVtcHR5Lg0KICAgICAgICAgKi8NCiAgICAgICAgcHVibGljIHN5\nbmNocm9uaXplZCBieXRlW10gcmVtb3ZlUGFja2V0KCkNCiAgICAgICAgICAg\nIHRocm93cyBJbnRlcnJ1cHRlZEV4Y2VwdGlvbiB7DQogICAgICAgICAgICAv\nLyBvbmx5IHdhaXQgaWYgdGhlIHF1ZXVlIGlzIHN0aWxsIG9wZW4uIFRoaXMg\nYWxsb3dzIHByb2Nlc3NpbmcNCiAgICAgICAgICAgIC8vIG9mIGV2ZW50cyBp\nbiB0aGUgcXVldWUgdG8gY29udGludWUsIHdoaWxlIGF2b2lkaW5nIHNsZWVw\naW5nDQogICAgICAgICAgICAvLyBkdXJpbmcgc2h1dGRvd24uDQogICAgICAg\nICAgICB3aGlsZSAoIV9jbG9zZWQgJiYgX3BhY2tldFF1ZXVlLmlzRW1wdHko\nKSkNCiAgICAgICAgICAgICAgICB3YWl0KCk7DQogICAgICAgICAgICBpZiAo\nX3BhY2tldFF1ZXVlLmlzRW1wdHkoKSkNCiAgICAgICAgICAgICAgICByZXR1\ncm4gbnVsbDsNCiAgICAgICAgICAgIGVsc2UNCiAgICAgICAgICAgICAgICBy\nZXR1cm4gKGJ5dGVbXSkgX3BhY2tldFF1ZXVlLnJlbW92ZUZpcnN0KCk7DQog\nICAgICAgIH0NCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiBUaHJlYWRzIHRv\nIGJyb2FkY2FzdCBwYWNrZXRzIHBsYWNlZCBpbiB0aGUge0BsaW5rIEJyb2Fk\nY2FzdFF1ZXVlfS4NCiAgICAgKi8NCiAgICBwcml2YXRlIGNsYXNzIEJyb2Fk\nY2FzdFdvcmtlclRocmVhZA0KICAgICAgICBleHRlbmRzIFRocmVhZCB7DQoN\nCiAgICAgICAgcHJpdmF0ZSBib29sZWFuIF9rZWVwUnVubmluZyA9IHRydWU7\nDQoNCiAgICAgICAgcHVibGljIHZvaWQgcnVuKCkgew0KICAgICAgICAgICAg\nd2hpbGUgKF9rZWVwUnVubmluZykgew0KICAgICAgICAgICAgICAgIHRyeSB7\nDQogICAgICAgICAgICAgICAgICAgIC8vIFRoaXMgd2lsbCBibG9jayB1bnRp\nbCB0aGVyZSBpcyBhIHBhY2tldCB0byBzZW5kLCBvcg0KICAgICAgICAgICAg\nICAgICAgICAvLyB1bnRpbCB0aGUgcXVldWUgaXMgY2xvc2VkLg0KICAgICAg\nICAgICAgICAgICAgICBieXRlW10gYnl0ZXMgPSBfYnJvYWRjYXN0UXVldWUu\ncmVtb3ZlUGFja2V0KCk7DQogICAgICAgICAgICAgICAgICAgIGlmIChieXRl\ncyAhPSBudWxsKQ0KICAgICAgICAgICAgICAgICAgICAgICAgc2VuZFVwZGF0\nZVBhY2tldChieXRlcyk7DQogICAgICAgICAgICAgICAgICAgIGVsc2UgaWYg\nKF9icm9hZGNhc3RRdWV1ZS5pc0Nsb3NlZCgpKQ0KICAgICAgICAgICAgICAg\nICAgICAgICAgX2tlZXBSdW5uaW5nID0gZmFsc2U7DQogICAgICAgICAgICAg\nICAgfSBjYXRjaCAoSW50ZXJydXB0ZWRFeGNlcHRpb24gZSkgew0KICAgICAg\nICAgICAgICAgICAgICAvLyBFbmQgdGhlIHRocmVhZC4NCiAgICAgICAgICAg\nICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAg\nICAgfQ0KICAgICAgICAgICAgcmVtb3ZlKCk7DQogICAgICAgIH0NCg0KICAg\nICAgICBwdWJsaWMgdm9pZCBzZXRSdW5uaW5nKGJvb2xlYW4ga2VlcFJ1bm5p\nbmcpIHsNCiAgICAgICAgICAgIF9rZWVwUnVubmluZyA9IGtlZXBSdW5uaW5n\nOw0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICBwcml2YXRlIHZvaWQg\ncmVtb3ZlKCkgew0KICAgICAgICAgICAgX2Jyb2FkY2FzdFRocmVhZHMucmVt\nb3ZlKHRoaXMpOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgLyoqDQogICAg\nICogUmVzcG9uc2libGUgZm9yIGxpc3RlbmluZyBmb3IgaW5jb21pbmcgcGFj\na2V0cyBhbmQgcHJvY2Vzc2luZyB0aGVtLg0KICAgICAqLw0KICAgIHByaXZh\ndGUgc3RhdGljIGNsYXNzIFRDUFBvcnRMaXN0ZW5lcg0KICAgICAgICBpbXBs\nZW1lbnRzIFJ1bm5hYmxlIHsNCg0KICAgICAgICBwcml2YXRlIGZpbmFsIExv\nZyBfbG9nOw0KICAgICAgICBwcml2YXRlIFNlcnZlclNvY2tldCBfcmVjZWl2\nZVNvY2tldDsNCiAgICAgICAgcHJpdmF0ZSBUaHJlYWQgX2FjY2VwdFRocmVh\nZDsNCiAgICAgICAgcHJpdmF0ZSBTZXQgX3JlY2VpdmVyVGhyZWFkcyA9IG5l\ndyBIYXNoU2V0KCk7DQogICAgICAgIHByaXZhdGUgZmluYWwgU2V0IF9wcm92\naWRlcnMgPSBuZXcgSGFzaFNldCgpOw0KDQogICAgICAgIC8qKg0KICAgICAg\nICAgKiBDYWNoZSB0aGUgbG9jYWwgSVAgYWRkcmVzcw0KICAgICAgICAgKi8N\nCiAgICAgICAgcHJpdmF0ZSBieXRlW10gX2xvY2FsaG9zdDsNCg0KICAgICAg\nICAvKioNCiAgICAgICAgICogVGhlIHBvcnQgdGhhdCB0aGlzIGxpc3RlbmVy\nIHNob3VsZCBsaXN0ZW4gb24uIENvbmZpZ3VyZWQNCiAgICAgICAgICogYnkg\nVENQUmVtb3RlQ29tbWl0UHJvdmlkZXIuDQogICAgICAgICAqLw0KICAgICAg\nICBwcml2YXRlIGludCBfcG9ydDsNCg0KICAgICAgICAvKioNCiAgICAgICAg\nICogU2hvdWxkIGJlIHNldCB0byA8Y29kZT50cnVlPC9jb2RlPiBvbmNlIHRo\nZSBsaXN0ZW5lciBpcyBsaXN0ZW5pbmcuDQogICAgICAgICAqLw0KICAgICAg\nICBwcml2YXRlIGJvb2xlYW4gX2lzUnVubmluZyA9IGZhbHNlOw0KDQogICAg\nICAgIC8qKg0KICAgICAgICAgKiBDb25zdHJ1Y3QgYSBuZXcgVENQUG9ydExp\nc3RlbmVyIGNvbmZpZ3VyZWQgdG8gdXNlIHRoZSBzcGVjaWZpZWQgcG9ydC4N\nCiAgICAgICAgICovDQogICAgICAgIHByaXZhdGUgVENQUG9ydExpc3RlbmVy\nKGludCBwb3J0LCBMb2cgbG9nKQ0KICAgICAgICAgICAgdGhyb3dzIElPRXhj\nZXB0aW9uIHsNCiAgICAgICAgICAgIF9wb3J0ID0gcG9ydDsNCiAgICAgICAg\nICAgIF9sb2cgPSBsb2c7DQogICAgICAgICAgICB0cnkgew0KICAgICAgICAg\nICAgICAgIF9yZWNlaXZlU29ja2V0ID0gKFNlcnZlclNvY2tldCkgQWNjZXNz\nQ29udHJvbGxlcg0KICAgICAgICAgICAgICAgICAgICAuZG9Qcml2aWxlZ2Vk\nKEoyRG9Qcml2SGVscGVyLm5ld1NlcnZlclNvY2tldEFjdGlvbihfcG9ydCkp\nOw0KICAgICAgICAgICAgfSBjYXRjaCAoUHJpdmlsZWdlZEFjdGlvbkV4Y2Vw\ndGlvbiBwYWUpIHsNCiAgICAgICAgICAgICAgICB0aHJvdyAoSU9FeGNlcHRp\nb24pIHBhZS5nZXRFeGNlcHRpb24oKTsNCiAgICAgICAgICAgIH0NCiAgICAg\nICAgICAgIF9sb2NhbGhvc3QgPSBJbmV0QWRkcmVzcy5nZXRMb2NhbEhvc3Qo\nKS5nZXRBZGRyZXNzKCk7DQoNCiAgICAgICAgICAgIGlmIChfbG9nLmlzVHJh\nY2VFbmFibGVkKCkpDQogICAgICAgICAgICAgICAgX2xvZy5pbmZvKHNfbG9j\nLmdldCgidGNwLXN0YXJ0LWxpc3RlbmVyIiwNCiAgICAgICAgICAgICAgICAg\nICAgU3RyaW5nLnZhbHVlT2YoX3BvcnQpKSk7DQogICAgICAgIH0NCg0KICAg\nICAgICBwcml2YXRlIHZvaWQgbGlzdGVuKCkgew0KICAgICAgICAgICAgX2Fj\nY2VwdFRocmVhZCA9IG5ldyBUaHJlYWQodGhpcyk7DQogICAgICAgICAgICBf\nYWNjZXB0VGhyZWFkLnNldERhZW1vbih0cnVlKTsNCiAgICAgICAgICAgIF9h\nY2NlcHRUaHJlYWQuc3RhcnQoKTsNCiAgICAgICAgfQ0KDQogICAgICAgIC8q\nKg0KICAgICAgICAgKiBBbGwgcHJvdmlkZXJzIGFkZGVkIGhlcmUgd2lsbCBi\nZSBub3RpZmllZCBvZiBhbnkgaW5jb21pbmcNCiAgICAgICAgICogcHJvdmlk\nZXIgbWVzc2FnZXMuIFRoZXJlIHdpbGwgYmUgb25lIG9mIHRoZXNlIHBlcg0K\nICAgICAgICAgKiBCcm9rZXJGYWN0b3J5IGluIGEgZ2l2ZW4gSlZNLg0KICAg\nICAgICAgKiB7QGxpbmsgVENQUmVtb3RlQ29tbWl0UHJvdmlkZXIjZW5kQ29u\nZmlndXJhdGlvbn0gaW52b2tlcw0KICAgICAgICAgKiA8Y29kZT5hZGRQcm92\naWRlcjwvY29kZT4gd2l0aCA8Y29kZT50aGlzPC9jb2RlPiB1cG9uDQogICAg\nICAgICAqIGNvbXBsZXRpb24gb2YgY29uZmlndXJhdGlvbi4NCiAgICAgICAg\nICovDQogICAgICAgIHByaXZhdGUgdm9pZCBhZGRQcm92aWRlcihUQ1BSZW1v\ndGVDb21taXRQcm92aWRlciBwcm92aWRlcikgew0KICAgICAgICAgICAgc3lu\nY2hyb25pemVkIChfcHJvdmlkZXJzKSB7DQogICAgICAgICAgICAgICAgX3By\nb3ZpZGVycy5hZGQocHJvdmlkZXIpOw0KICAgICAgICAgICAgfQ0KICAgICAg\nICB9DQoNCiAgICAgICAgLyoqDQogICAgICAgICAqIFJlbW92ZSBhIHByb3Zp\nZGVyIGZyb20gdGhlIGxpc3Qgb2YgcHJvdmlkZXJzIHRvIG5vdGlmeSBvZg0K\nICAgICAgICAgKiBjb21taXQgZXZlbnRzLg0KICAgICAgICAgKi8NCiAgICAg\nICAgcHJpdmF0ZSBzeW5jaHJvbml6ZWQgdm9pZCByZW1vdmVQcm92aWRlcg0K\nICAgICAgICAgICAgKFRDUFJlbW90ZUNvbW1pdFByb3ZpZGVyIHByb3ZpZGVy\nKSB7DQogICAgICAgICAgICBzeW5jaHJvbml6ZWQgKF9wcm92aWRlcnMpIHsN\nCiAgICAgICAgICAgICAgICBfcHJvdmlkZXJzLnJlbW92ZShwcm92aWRlcik7\nDQoNCiAgICAgICAgICAgICAgICAvLyBpZiB0aGUgcHJvdmlkZXIgbGlzdCBp\ncyBlbXB0eSwgc2h1dCBkb3duIHRoZSB0aHJlYWQuDQogICAgICAgICAgICAg\nICAgaWYgKF9wcm92aWRlcnMuc2l6ZSgpID09IDApIHsNCiAgICAgICAgICAg\nICAgICAgICAgX2lzUnVubmluZyA9IGZhbHNlOw0KICAgICAgICAgICAgICAg\nICAgICB0cnkgew0KICAgICAgICAgICAgICAgICAgICAgICAgX3JlY2VpdmVT\nb2NrZXQuY2xvc2UoKTsNCiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAo\nSU9FeGNlcHRpb24gaW9lKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBp\nZiAoX2xvZy5pc1dhcm5FbmFibGVkKCkpDQogICAgICAgICAgICAgICAgICAg\nICAgICAgICAgX2xvZy53YXJuKHNfbG9jLmdldCgidGNwLWNsb3NlLWVycm9y\nIiksIGlvZSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAg\nICAgICAgICAgX2FjY2VwdFRocmVhZC5pbnRlcnJ1cHQoKTsNCiAgICAgICAg\nICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAg\nICBwcml2YXRlIGJvb2xlYW4gaXNSdW5uaW5nKCkgew0KICAgICAgICAgICAg\nc3luY2hyb25pemVkIChfcHJvdmlkZXJzKSB7DQogICAgICAgICAgICAgICAg\ncmV0dXJuIF9pc1J1bm5pbmc7DQogICAgICAgICAgICB9DQogICAgICAgIH0N\nCg0KICAgICAgICBwdWJsaWMgdm9pZCBydW4oKSB7DQogICAgICAgICAgICBz\neW5jaHJvbml6ZWQgKF9wcm92aWRlcnMpIHsNCiAgICAgICAgICAgICAgICBf\naXNSdW5uaW5nID0gdHJ1ZTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAg\nICAgU29ja2V0IHMgPSBudWxsOw0KICAgICAgICAgICAgd2hpbGUgKF9pc1J1\nbm5pbmcpIHsNCiAgICAgICAgICAgICAgICB0cnkgew0KICAgICAgICAgICAg\nICAgICAgICBzID0gbnVsbDsNCiAgICAgICAgICAgICAgICAgICAgLy8gQmxv\nY2ssIHdhaXRpbmcgdG8gYWNjZXB0IG5ldyBjb25uZWN0aW9uIGZyb20gYSBw\nZWVyDQogICAgICAgICAgICAgICAgICAgIHMgPSAoU29ja2V0KSBBY2Nlc3ND\nb250cm9sbGVyLmRvUHJpdmlsZWdlZChKMkRvUHJpdkhlbHBlcg0KICAgICAg\nICAgICAgICAgICAgICAgICAgLmFjY2VwdEFjdGlvbihfcmVjZWl2ZVNvY2tl\ndCkpOw0KICAgICAgICAgICAgICAgICAgICBpZiAoX2xvZy5pc1RyYWNlRW5h\nYmxlZCgpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBfbG9nLnRyYWNl\nKHNfbG9jLmdldCgidGNwLXJlY2VpdmVkLWNvbm5lY3Rpb24iLA0KICAgICAg\nICAgICAgICAgICAgICAgICAgICAgIHMuZ2V0SW5ldEFkZHJlc3MoKS5nZXRI\nb3N0QWRkcmVzcygpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICsgIjoiICsgcy5nZXRQb3J0KCkpKTsNCiAgICAgICAgICAgICAgICAgICAg\nfQ0KICAgICAgICAgICAgICAgICAgICBSZWNlaXZlU29ja2V0SGFuZGxlciBz\naCA9IG5ldyBSZWNlaXZlU29ja2V0SGFuZGxlcihzKTsNCiAgICAgICAgICAg\nICAgICAgICAgVGhyZWFkIHJlY2VpdmVyVGhyZWFkID0gbmV3IFRocmVhZChz\naCk7DQogICAgICAgICAgICAgICAgICAgIHJlY2VpdmVyVGhyZWFkLnNldERh\nZW1vbih0cnVlKTsNCiAgICAgICAgICAgICAgICAgICAgcmVjZWl2ZXJUaHJl\nYWQuc3RhcnQoKTsNCiAgICAgICAgICAgICAgICAgICAgX3JlY2VpdmVyVGhy\nZWFkcy5hZGQocmVjZWl2ZXJUaHJlYWQpOw0KICAgICAgICAgICAgICAgIH0g\nY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7DQogICAgICAgICAgICAgICAgICAgIGlm\nIChlIGluc3RhbmNlb2YgUHJpdmlsZWdlZEFjdGlvbkV4Y2VwdGlvbikNCiAg\nICAgICAgICAgICAgICAgICAgICAgIGUgPSAoKFByaXZpbGVnZWRBY3Rpb25F\neGNlcHRpb24pIGUpLmdldEV4Y2VwdGlvbigpOw0KICAgICAgICAgICAgICAg\nICAgICBpZiAoIShlIGluc3RhbmNlb2YgU29ja2V0RXhjZXB0aW9uKSB8fCBf\naXNSdW5uaW5nKQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKF9sb2cu\naXNXYXJuRW5hYmxlZCgpKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAg\nIF9sb2cud2FybihzX2xvYy5nZXQoInRjcC1hY2NlcHQtZXJyb3IiKSwgZSk7\nDQoNCiAgICAgICAgICAgICAgICAgICAgLy8gTm9taW5hbCBjYXNlIChJbnRl\ncnJ1cHRlZEV4Y2VwdGlvbikgYmVjYXVzZSBjbG9zZSAoKQ0KICAgICAgICAg\nICAgICAgICAgICAvLyBjYWxscyBfYWNjZXB0VGhyZWFkLmludGVycnVwdCAo\nKTsNCiAgICAgICAgICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAg\nICAgICAgICAgIGlmIChzICE9IG51bGwpDQogICAgICAgICAgICAgICAgICAg\nICAgICAgICAgcy5jbG9zZSgpOw0KICAgICAgICAgICAgICAgICAgICB9IGNh\ndGNoIChFeGNlcHRpb24gZWUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAg\nIGlmIChfbG9nLmlzV2FybkVuYWJsZWQoKSkNCiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICBfbG9nLndhcm4oc19sb2MuZ2V0KCJ0Y3AtY2xvc2UtZXJy\nb3IiKSwgZSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAg\nICAgICB9DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIC8vIFdlIGFy\nZSBkb25lIGxpc3RlbmluZy4gSW50ZXJydXB0IGFueSB3b3JrZXIgdGhyZWFk\ncy4NCiAgICAgICAgICAgIFRocmVhZCB3b3JrZXI7DQogICAgICAgICAgICBm\nb3IgKEl0ZXJhdG9yIGl0ZXIgPSBfcmVjZWl2ZXJUaHJlYWRzLml0ZXJhdG9y\nKCk7DQogICAgICAgICAgICAgICAgaXRlci5oYXNOZXh0KCk7KSB7DQogICAg\nICAgICAgICAgICAgd29ya2VyID0gKFRocmVhZCkgaXRlci5uZXh0KCk7DQog\nICAgICAgICAgICAgICAgLy8gRllJLCB0aGUgd29ya2VyIHRocmVhZHMgYXJl\nIGJsb2NrZWQNCiAgICAgICAgICAgICAgICAvLyByZWFkaW5nIGZyb20gdGhl\nIHNvY2tldCdzIElucHV0U3RyZWFtLiBJbnB1dFN0cmVhbXMNCiAgICAgICAg\nICAgICAgICAvLyBhcmVuJ3QgaW50ZXJydXB0YWJsZSwgc28gdGhpcyBpbnRl\ncnJ1cHQgaXNuJ3QNCiAgICAgICAgICAgICAgICAvLyByZWFsbHkgZ29pbmcg\ndG8gYmUgZGVsaXZlcmVkIHVudGlsIHNvbWV0aGluZyBicmVha3MNCiAgICAg\nICAgICAgICAgICAvLyB0aGUgSW5wdXRTdHJlYW0uDQogICAgICAgICAgICAg\nICAgd29ya2VyLmludGVycnVwdCgpOw0KICAgICAgICAgICAgfQ0KICAgICAg\nICAgICAgc3luY2hyb25pemVkIChfcHJvdmlkZXJzKSB7DQogICAgICAgICAg\nICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgICAgICAgaWYgKF9pc1J1bm5p\nbmcpDQogICAgICAgICAgICAgICAgICAgICAgICBfcmVjZWl2ZVNvY2tldC5j\nbG9zZSgpOw0KICAgICAgICAgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBl\nKSB7DQogICAgICAgICAgICAgICAgICAgIGlmIChfbG9nLmlzV2FybkVuYWJs\nZWQoKSkNCiAgICAgICAgICAgICAgICAgICAgICAgIF9sb2cud2FybihzX2xv\nYy5nZXQoInRjcC1jbG9zZS1lcnJvciIpLCBlKTsNCiAgICAgICAgICAgICAg\nICB9DQogICAgICAgICAgICAgICAgX2lzUnVubmluZyA9IGZhbHNlOw0KICAg\nICAgICAgICAgICAgIGlmIChfbG9nLmlzVHJhY2VFbmFibGVkKCkpDQogICAg\nICAgICAgICAgICAgICAgIF9sb2cudHJhY2Uoc19sb2MuZ2V0KCJ0Y3AtY2xv\nc2UtbGlzdGVuZXIiLA0KICAgICAgICAgICAgICAgICAgICAgICAgX3BvcnQg\nKyAiIikpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAg\nLyoqDQogICAgICAgICAqIFV0aWxpdHkgY2xhc3MgdGhhdCBhY3RzIGFzIGEg\nd29ya2VyIHRocmVhZCB0byByZWNlaXZlIEV2ZW50cw0KICAgICAgICAgKiBm\ncm9tIGJyb2FkY2FzdGVycy4NCiAgICAgICAgICovDQogICAgICAgIHByaXZh\ndGUgY2xhc3MgUmVjZWl2ZVNvY2tldEhhbmRsZXINCiAgICAgICAgICAgIGlt\ncGxlbWVudHMgUnVubmFibGUgew0KDQogICAgICAgICAgICBwcml2YXRlIElu\ncHV0U3RyZWFtIF9pbjsNCiAgICAgICAgICAgIHByaXZhdGUgU29ja2V0IF9z\nOw0KDQogICAgICAgICAgICBwcml2YXRlIFJlY2VpdmVTb2NrZXRIYW5kbGVy\nKFNvY2tldCBzKSB7DQogICAgICAgICAgICAgICAgLy8gV2UgYXJlIHRoZSBy\nZWNlaXZpbmcgZW5kIGFuZCB3ZSBkb24ndCBzZW5kIGFueSBtZXNzYWdlcw0K\nICAgICAgICAgICAgICAgIC8vIGJhY2sgdG8gdGhlIGJyb2FkY2FzdGVyLiBU\ndXJuIG9mZiBOYWdsZSdzIHNvIHRoYXQNCiAgICAgICAgICAgICAgICAvLyB3\nZSB3aWxsIHNlbmQgYWNrIHBhY2tldHMgd2l0aG91dCB3YWl0aW5nLg0KICAg\nICAgICAgICAgICAgIF9zID0gczsNCiAgICAgICAgICAgICAgICB0cnkgew0K\nICAgICAgICAgICAgICAgICAgICBfcy5zZXRUY3BOb0RlbGF5KHRydWUpOw0K\nICAgICAgICAgICAgICAgICAgICBfaW4gPSBuZXcgQnVmZmVyZWRJbnB1dFN0\ncmVhbShzLmdldElucHV0U3RyZWFtKCkpOw0KICAgICAgICAgICAgICAgIH0g\nY2F0Y2ggKElPRXhjZXB0aW9uIGlvZSkgew0KICAgICAgICAgICAgICAgICAg\nICBpZiAoX2xvZy5pc0luZm9FbmFibGVkKCkpDQogICAgICAgICAgICAgICAg\nICAgICAgICBfbG9nLmluZm8oc19sb2MuZ2V0KCJ0Y3Atc29ja2V0LW9wdGlv\nbi1lcnJvciIpLCBpb2UpOw0KICAgICAgICAgICAgICAgICAgICBfcyA9IG51\nbGw7DQogICAgICAgICAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsN\nCiAgICAgICAgICAgICAgICAgICAgaWYgKF9sb2cuaXNXYXJuRW5hYmxlZCgp\nKQ0KICAgICAgICAgICAgICAgICAgICAgICAgX2xvZy53YXJuKHNfbG9jLmdl\ndCgidGNwLXJlY2VpdmUtZXJyb3IiKSwgZSk7DQogICAgICAgICAgICAgICAg\nICAgIF9zID0gbnVsbDsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAg\nICB9DQoNCiAgICAgICAgICAgIHB1YmxpYyB2b2lkIHJ1bigpIHsNCiAgICAg\nICAgICAgICAgICBpZiAoX3MgPT0gbnVsbCkNCiAgICAgICAgICAgICAgICAg\nICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgIHdoaWxlIChfaXNSdW5uaW5n\nICYmIF9zICE9IG51bGwpIHsNCiAgICAgICAgICAgICAgICAgICAgdHJ5IHsN\nCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRoaXMgd2lsbCBibG9jayBv\ndXIgdGhyZWFkLCB3YWl0aW5nIHRvIHJlYWQNCiAgICAgICAgICAgICAgICAg\nICAgICAgIC8vIHRoZSBuZXh0IEV2ZW50LW9iamVjdC1tZXNzYWdlLg0KICAg\nICAgICAgICAgICAgICAgICAgICAgaGFuZGxlKF9pbik7DQogICAgICAgICAg\nICAgICAgICAgIH0gY2F0Y2ggKEVPRkV4Y2VwdGlvbiBlb2YpIHsNCiAgICAg\nICAgICAgICAgICAgICAgICAgIC8vIEVPRkV4Y2VwdGlvbiByYWlzZWQgd2hl\nbiBwZWVyIGlzIHByb3Blcmx5DQogICAgICAgICAgICAgICAgICAgICAgICAv\nLyBjbG9zaW5nIGl0cyBlbmQuDQogICAgICAgICAgICAgICAgICAgICAgICBp\nZiAoX2xvZy5pc1RyYWNlRW5hYmxlZCgpKSB7DQogICAgICAgICAgICAgICAg\nICAgICAgICAgICAgX2xvZy50cmFjZShzX2xvYy5nZXQoInRjcC1jbG9zZS1z\nb2NrZXQiLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfcy5n\nZXRJbmV0QWRkcmVzcygpLmdldEhvc3RBZGRyZXNzKCkNCiAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICsgIjoiICsgX3MuZ2V0UG9ydCgp\nKSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAg\nICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICAgICAgfSBjYXRj\naCAoVGhyb3dhYmxlIGUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlm\nIChfbG9nLmlzV2FybkVuYWJsZWQoKSkNCiAgICAgICAgICAgICAgICAgICAg\nICAgICAgICBfbG9nLndhcm4oc19sb2MuZ2V0KCJ0Y3AtcmVjZWl2ZS1lcnJv\nciIpLCBlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAg\nICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAg\nICAgICAgICAgIC8vIFdlIGFyZSBkb25lIHJlY2VpdmluZyBvbiB0aGlzIHNv\nY2tldCBhbmQgdGhpcyB3b3JrZXINCiAgICAgICAgICAgICAgICAvLyB0aHJl\nYWQgaXMgdGVybWluYXRpbmcuDQogICAgICAgICAgICAgICAgdHJ5IHsNCiAg\nICAgICAgICAgICAgICAgICAgX2luLmNsb3NlKCk7DQogICAgICAgICAgICAg\nICAgICAgIGlmIChfcyAhPSBudWxsKQ0KICAgICAgICAgICAgICAgICAgICAg\nICAgX3MuY2xvc2UoKTsNCiAgICAgICAgICAgICAgICB9IGNhdGNoIChJT0V4\nY2VwdGlvbiBlKSB7DQogICAgICAgICAgICAgICAgICAgIF9sb2cud2Fybihz\nX2xvYy5nZXQoInRjcC1jbG9zZS1zb2NrZXQtZXJyb3IiLA0KICAgICAgICAg\nICAgICAgICAgICAgICAgX3MuZ2V0SW5ldEFkZHJlc3MoKS5nZXRIb3N0QWRk\ncmVzcygpICsgIjoiDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgKyBf\ncy5nZXRQb3J0KCkpLCBlKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAg\nICAgICB9DQoNCiAgICAgICAgICAgIC8qKg0KICAgICAgICAgICAgICogUHJv\nY2VzcyBhbiB7QGxpbmsgSW5wdXRTdHJlYW19IGNvbnRhaW5pbmcgb2JqZWN0\ncyB3cml0dGVuDQogICAgICAgICAgICAgKiBieSB7QGxpbmsgVENQUmVtb3Rl\nQ29tbWl0UHJvdmlkZXIjYnJvYWRjYXN0KFJlbW90ZUNvbW1pdEV2ZW50KX0u\nDQogICAgICAgICAgICAgKi8NCiAgICAgICAgICAgIHByaXZhdGUgdm9pZCBo\nYW5kbGUoSW5wdXRTdHJlYW0gaW4pDQogICAgICAgICAgICAgICAgdGhyb3dz\nIElPRXhjZXB0aW9uLCBDbGFzc05vdEZvdW5kRXhjZXB0aW9uIHsNCiAgICAg\nICAgICAgICAgICAvLyBUaGlzIHdpbGwgYmxvY2sgd2FpdGluZyBmb3IgdGhl\nIG5leHQNCiAgICAgICAgICAgICAgICBPYmplY3RJbnB1dFN0cmVhbSBvaXMg\nPSANCiAgICAgICAgICAgICAgICAgICAgbmV3IFNlcmlhbGl6YXRpb24uQ2xh\nc3NSZXNvbHZpbmdPYmplY3RJbnB1dFN0cmVhbShpbik7DQoNCiAgICAgICAg\nICAgICAgICBsb25nIHByb3RvY29sVmVyc2lvbiA9IG9pcy5yZWFkTG9uZygp\nOw0KICAgICAgICAgICAgICAgIGlmIChwcm90b2NvbFZlcnNpb24gIT0gUFJP\nVE9DT0xfVkVSU0lPTikgew0KICAgICAgICAgICAgICAgICAgICBpZiAoX2xv\nZy5pc1dhcm5FbmFibGVkKCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAg\nIF9sb2cud2FybihzX2xvYy5nZXQoInRjcC13cm9uZy12ZXJzaW9uLWVycm9y\nIiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfcy5nZXRJbmV0QWRk\ncmVzcygpLmdldEhvc3RBZGRyZXNzKCkgKyAiOiINCiAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgKyBfcy5nZXRQb3J0KCkpKTsNCiAgICAgICAg\nICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAg\nfQ0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIGxvbmcg\nc2VuZGVySWQgPSBvaXMucmVhZExvbmcoKTsNCiAgICAgICAgICAgICAgICBp\nbnQgc2VuZGVyUG9ydCA9IG9pcy5yZWFkSW50KCk7DQogICAgICAgICAgICAg\nICAgYnl0ZVtdIHNlbmRlckFkZHJlc3MgPSAoYnl0ZVtdKSBvaXMucmVhZE9i\namVjdCgpOw0KICAgICAgICAgICAgICAgIFJlbW90ZUNvbW1pdEV2ZW50IHJj\nZSA9IChSZW1vdGVDb21taXRFdmVudCkgb2lzLnJlYWRPYmplY3QoKTsNCiAg\nICAgICAgICAgICAgICBpZiAoX2xvZy5pc1RyYWNlRW5hYmxlZCgpKSB7DQog\nICAgICAgICAgICAgICAgICAgIF9sb2cudHJhY2Uoc19sb2MuZ2V0KCJ0Y3At\ncmVjZWl2ZWQtZXZlbnQiLA0KICAgICAgICAgICAgICAgICAgICAgICAgX3Mu\nZ2V0SW5ldEFkZHJlc3MoKS5nZXRIb3N0QWRkcmVzcygpICsgIjoiDQogICAg\nICAgICAgICAgICAgICAgICAgICAgICAgKyBfcy5nZXRQb3J0KCkpKTsNCiAg\nICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICBib29sZWFuIGZy\nb21TZWxmID0gc2VuZGVyUG9ydCA9PSBfcG9ydCAmJg0KICAgICAgICAgICAg\nICAgICAgICBBcnJheXMuZXF1YWxzKHNlbmRlckFkZHJlc3MsIF9sb2NhbGhv\nc3QpOw0KICAgICAgICAgICAgICAgIFRDUFJlbW90ZUNvbW1pdFByb3ZpZGVy\nIHByb3ZpZGVyOw0KICAgICAgICAgICAgICAgIHN5bmNocm9uaXplZCAoX3By\nb3ZpZGVycykgew0KICAgICAgICAgICAgICAgICAgICAvLyBibGVhaXI6IFdl\nJ3JlIGl0ZXJhdGluZywgYnV0IGN1cnJlbmx0eSB0aGVyZSBjYW4gcmVhbGx5\nDQogICAgICAgICAgICAgICAgICAgIC8vIG9ubHkgYmUgYSBzaW5nbGUgcHJv\ndmlkZXIuDQogICAgICAgICAgICAgICAgICAgIGZvciAoSXRlcmF0b3IgaXRl\nciA9IF9wcm92aWRlcnMuaXRlcmF0b3IoKTsNCiAgICAgICAgICAgICAgICAg\nICAgICAgIGl0ZXIuaGFzTmV4dCgpOykgew0KICAgICAgICAgICAgICAgICAg\nICAgICAgcHJvdmlkZXIgPSAoVENQUmVtb3RlQ29tbWl0UHJvdmlkZXIpIGl0\nZXIubmV4dCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNlbmRl\ncklkICE9IHByb3ZpZGVyLl9pZCB8fCAhZnJvbVNlbGYpDQogICAgICAgICAg\nICAgICAgICAgICAgICAgICAgcHJvdmlkZXIuZXZlbnRNYW5hZ2VyLmZpcmVF\ndmVudChyY2UpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAg\nICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfQ0KDQog\nICAgLyoqDQogICAgICogVXRpbGl0eSBjbGFzcyB0byBzdG9yZSBhbiBJbmV0\nQWRkcmVzcyBhbmQgYW4gaW50LiBOb3QgdXNpbmcNCiAgICAgKiBJbmV0U29j\na2V0QWRkcmVzcyBiZWNhdXNlIGl0J3MgYSBKREsxLjQgQVBJLiBUaGlzIGFs\nc28NCiAgICAgKiBwcm92aWRlcyBhIHdyYXBwZXIgYXJvdW5kIHRoZSBzb2Nr\nZXQocykgYXNzb2NpYXRlZCB3aXRoIHRoaXMgYWRkcmVzcy4NCiAgICAgKi8N\nCiAgICBwcml2YXRlIGNsYXNzIEhvc3RBZGRyZXNzIHsNCg0KICAgICAgICBw\ncml2YXRlIEluZXRBZGRyZXNzIF9hZGRyZXNzOw0KICAgICAgICBwcml2YXRl\nIGludCBfcG9ydDsNCiAgICAgICAgcHJpdmF0ZSBsb25nIF90aW1lTGFzdEVy\ncm9yOyAvLyBtaWxsaXMNCiAgICAgICAgcHJpdmF0ZSBib29sZWFuIF9pc0F2\nYWlsYWJsZTsgLy8gaXMgcGVlciB0aG91Z2h0IHRvIGJlIHVwDQogICAgICAg\nIHByaXZhdGUgaW50IF9pbmZvc0lzc3VlZCA9IDA7IC8vIGxpbWl0IGxvZyBl\nbnRyaWVzDQoNCiAgICAgICAgcHJpdmF0ZSBHZW5lcmljT2JqZWN0UG9vbCBf\nc29ja2V0UG9vbDsgLy8gcmV1c2FibGUgb3BlbiBzb2NrZXRzDQoNCiAgICAg\nICAgLyoqDQogICAgICAgICAqIENvbnN0cnVjdCBhIG5ldyBob3N0IGFkZHJl\nc3MgZnJvbSBhIHN0cmluZyBvZiB0aGUgZm9ybQ0KICAgICAgICAgKiAiaG9z\ndDpwb3J0IiBvciBvZiB0aGUgZm9ybSAiaG9zdCIuDQogICAgICAgICAqLw0K\nICAgICAgICBwcml2YXRlIEhvc3RBZGRyZXNzKFN0cmluZyBob3N0KQ0KICAg\nICAgICAgICAgdGhyb3dzIFVua25vd25Ib3N0RXhjZXB0aW9uIHsNCiAgICAg\nICAgICAgIGludCBjb2xvbiA9IGhvc3QuaW5kZXhPZignOicpOw0KICAgICAg\nICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgICBpZiAoY29sb24gIT0gLTEp\nIHsNCiAgICAgICAgICAgICAgICAgICAgX2FkZHJlc3MgPSAoSW5ldEFkZHJl\nc3MpIEFjY2Vzc0NvbnRyb2xsZXINCiAgICAgICAgICAgICAgICAgICAgICAg\nIC5kb1ByaXZpbGVnZWQoSjJEb1ByaXZIZWxwZXIuZ2V0QnlOYW1lQWN0aW9u\nKGhvc3QNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuc3Vic3RyaW5n\nKDAsIGNvbG9uKSkpOw0KICAgICAgICAgICAgICAgICAgICBfcG9ydCA9IElu\ndGVnZXIucGFyc2VJbnQoaG9zdC5zdWJzdHJpbmcoY29sb24gKyAxKSk7DQog\nICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAg\nX2FkZHJlc3MgPSAoSW5ldEFkZHJlc3MpIEFjY2Vzc0NvbnRyb2xsZXINCiAg\nICAgICAgICAgICAgICAgICAgICAgIC5kb1ByaXZpbGVnZWQoSjJEb1ByaXZI\nZWxwZXIuZ2V0QnlOYW1lQWN0aW9uKGhvc3QpKTsNCiAgICAgICAgICAgICAg\nICAgICAgX3BvcnQgPSBERUZBVUxUX1BPUlQ7DQogICAgICAgICAgICAgICAg\nfQ0KICAgICAgICAgICAgfSBjYXRjaCAoUHJpdmlsZWdlZEFjdGlvbkV4Y2Vw\ndGlvbiBwYWUpIHsNCiAgICAgICAgICAgICAgICB0aHJvdyAoVW5rbm93bkhv\nc3RFeGNlcHRpb24pIHBhZS5nZXRFeGNlcHRpb24oKTsNCiAgICAgICAgICAg\nIH0NCiAgICAgICAgICAgIC8vIC0xIG1heCB3YWl0ID09IGFzIGxvbmcgYXMg\naXQgdGFrZXMNCiAgICAgICAgICAgIF9zb2NrZXRQb29sID0gbmV3IEdlbmVy\naWNPYmplY3RQb29sDQogICAgICAgICAgICAgICAgKG5ldyBTb2NrZXRQb29s\nYWJsZU9iamVjdEZhY3RvcnkoKSwgX21heEFjdGl2ZSwNCiAgICAgICAgICAg\nICAgICAgICAgR2VuZXJpY09iamVjdFBvb2wuV0hFTl9FWEhBVVNURURfQkxP\nQ0ssIC0xKTsNCiAgICAgICAgICAgIF9pc0F2YWlsYWJsZSA9IHRydWU7DQog\nICAgICAgIH0NCg0KICAgICAgICBwcml2YXRlIHZvaWQgc2V0TWF4QWN0aXZl\nKGludCBtYXhBY3RpdmUpIHsNCiAgICAgICAgICAgIF9zb2NrZXRQb29sLnNl\ndE1heEFjdGl2ZShtYXhBY3RpdmUpOw0KICAgICAgICB9DQoNCiAgICAgICAg\ncHJpdmF0ZSB2b2lkIHNldE1heElkbGUoaW50IG1heElkbGUpIHsNCiAgICAg\nICAgICAgIF9zb2NrZXRQb29sLnNldE1heElkbGUobWF4SWRsZSk7DQogICAg\nICAgIH0NCg0KICAgICAgICBwdWJsaWMgdm9pZCBjbG9zZSgpIHsNCiAgICAg\nICAgICAgIC8vIENsb3NlIHRoZSBwb29sIG9mIHNvY2tldHMgdG8gdGhpcyBw\nZWVyLiBUaGlzDQogICAgICAgICAgICAvLyB3aWxsIGNsb3NlIGFsbCBzb2Nr\nZXRzIGluIHRoZSBwb29sLg0KICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAg\nICAgICAgICBfc29ja2V0UG9vbC5jbG9zZSgpOw0KICAgICAgICAgICAgfSBj\nYXRjaCAoRXhjZXB0aW9uIGUpIHsNCiAgICAgICAgICAgICAgICBpZiAobG9n\nLmlzV2FybkVuYWJsZWQoKSkgew0KICAgICAgICAgICAgICAgICAgICBsb2cu\nd2FybihzX2xvYy5nZXQoInRjcC1jbG9zZS1wb29sLWVycm9yIiksIGUpOw0K\nICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0K\nDQogICAgICAgIHByaXZhdGUgdm9pZCBzZW5kVXBkYXRlUGFja2V0KGJ5dGVb\nXSBieXRlcykgew0KICAgICAgICAgICAgaWYgKCFfaXNBdmFpbGFibGUpIHsN\nCiAgICAgICAgICAgICAgICBsb25nIG5vdyA9IFN5c3RlbS5jdXJyZW50VGlt\nZU1pbGxpcygpOw0KICAgICAgICAgICAgICAgIGlmIChub3cgLSBfdGltZUxh\nc3RFcnJvciA8IF9yZWNvdmVyeVRpbWVNaWxsaXMpDQogICAgICAgICAgICAg\nICAgICAgIC8vIE5vdCBlbm91Z2ggdGltZSBoYXMgcGFzc2VkIHNpbmNlIHRo\nZSBsYXN0IGVycm9yDQogICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAg\nICAgICAgICAgIH0NCiAgICAgICAgICAgIFNvY2tldCBzID0gbnVsbDsNCiAg\nICAgICAgICAgIHRyeSB7DQogICAgICAgICAgICAgICAgcyA9IGdldFNvY2tl\ndCgpOw0KICAgICAgICAgICAgICAgIE91dHB1dFN0cmVhbSBvcyA9IHMuZ2V0\nT3V0cHV0U3RyZWFtKCk7DQogICAgICAgICAgICAgICAgb3Mud3JpdGUoYnl0\nZXMpOw0KICAgICAgICAgICAgICAgIG9zLmZsdXNoKCk7DQoNCiAgICAgICAg\nICAgICAgICBpZiAobG9nLmlzVHJhY2VFbmFibGVkKCkpIHsNCiAgICAgICAg\nICAgICAgICAgICAgbG9nLnRyYWNlKHNfbG9jLmdldCgidGNwLXNlbnQtdXBk\nYXRlIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIF9hZGRyZXNzLmdldEhv\nc3RBZGRyZXNzKCkgKyAiOiIgKyBfcG9ydCwNCiAgICAgICAgICAgICAgICAg\nICAgICAgIFN0cmluZy52YWx1ZU9mKHMuZ2V0TG9jYWxQb3J0KCkpKSk7DQog\nICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIF9pc0F2YWlsYWJs\nZSA9IHRydWU7DQogICAgICAgICAgICAgICAgX2luZm9zSXNzdWVkID0gMDsN\nCiAgICAgICAgICAgICAgICAvLyBSZXR1cm4gdGhlIHNvY2tldCB0byB0aGUg\ncG9vbDsgdGhlIHNvY2tldCBpcw0KICAgICAgICAgICAgICAgIC8vIHN0aWxs\nIGdvb2QuDQogICAgICAgICAgICAgICAgcmV0dXJuU29ja2V0KHMpOw0KICAg\nICAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsNCiAgICAgICAgICAg\nICAgICAvLyBUaGVyZSBoYXMgYmVlbiBhIHByb2JsZW0gc2VuZGluZyB0byB0\naGUgcGVlci4NCiAgICAgICAgICAgICAgICAvLyBUaGUgT1Mgc29ja2V0IHRo\nYXQgd2FzIGJlaW5nIHVzZWQgaXMgY2FuIG5vIGxvbmdlcg0KICAgICAgICAg\nICAgICAgIC8vIGJlIHVzZWQuDQogICAgICAgICAgICAgICAgaWYgKHMgIT0g\nbnVsbCkNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5jbG9zZVNvY2tldChz\nKTsNCiAgICAgICAgICAgICAgICB0aGlzLmNsZWFyQWxsU29ja2V0cygpOw0K\nDQogICAgICAgICAgICAgICAgaWYgKF9pc0F2YWlsYWJsZSkgew0KICAgICAg\nICAgICAgICAgICAgICAvLyBMb2cgYSB3YXJuaW5nLCB0aGUgcGVlciB3YXMg\ndXAgYW5kIGhhcyBub3cgZ29uZSBkb3duDQogICAgICAgICAgICAgICAgICAg\nIGlmIChsb2cuaXNXYXJuRW5hYmxlZCgpKSB7DQogICAgICAgICAgICAgICAg\nICAgICAgICBsb2cud2FybihzX2xvYy5nZXQoInRjcC1zZW5kLWVycm9yIiwN\nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfYWRkcmVzcy5nZXRIb3N0\nQWRkcmVzcygpICsgIjoiICsgX3BvcnQpLCBlKTsNCiAgICAgICAgICAgICAg\nICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBfaXNBdmFpbGFibGUgPSBm\nYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgLy8gT25jZSBlbm91Z2ggdGlt\nZSBoYXMgcGFzc2VkIHdlIHdpbGwgbG9nIGFub3RoZXIgd2FybmluZw0KICAg\nICAgICAgICAgICAgICAgICBfdGltZUxhc3RFcnJvciA9IFN5c3RlbS5jdXJy\nZW50VGltZU1pbGxpcygpOw0KICAgICAgICAgICAgICAgIH0gZWxzZSB7DQog\nICAgICAgICAgICAgICAgICAgIGxvbmcgbm93ID0gU3lzdGVtLmN1cnJlbnRU\naW1lTWlsbGlzKCk7DQogICAgICAgICAgICAgICAgICAgIGlmIChub3cgLSBf\ndGltZUxhc3RFcnJvciA+IF9yZWNvdmVyeVRpbWVNaWxsaXMpIHsNCiAgICAg\nICAgICAgICAgICAgICAgICAgIGlmIChfaW5mb3NJc3N1ZWQgPCA1KSB7DQog\nICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gRW5vdWdoIHRpbWUgaGFz\nIHBhc3NlZCwgYW5kIHBlZXIgaXMgc3RpbGwgZG93bg0KICAgICAgICAgICAg\nICAgICAgICAgICAgICAgIF90aW1lTGFzdEVycm9yID0gU3lzdGVtLmN1cnJl\nbnRUaW1lTWlsbGlzKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAg\nLy8gV2Ugd2VyZSB0cnlpbmcgdG8gcmVlc3RhYmxpc2ggdGhlIGNvbm5lY3Rp\nb24sDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gYnV0IHdlIGZh\naWxlZCBhZ2Fpbi4gTG9nIGEgbWVzc2FnZSwgYnV0DQogICAgICAgICAgICAg\nICAgICAgICAgICAgICAgLy8gbG93ZXIgc2V2ZXJpdHkuIFRoaXMgbG9nIHdp\nbGwgb2NjdXIgcGVyaW9kaWNhbGx5DQogICAgICAgICAgICAgICAgICAgICAg\nICAgICAgLy8gZm9yIDUgdGltZXMgdW50aWwgdGhlIHBlZXIgY29tZXMgYmFj\nay4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobG9nLmlzSW5m\nb0VuYWJsZWQoKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICBsb2cuaW5mbyhzX2xvYy5nZXQoInRjcC1zZW5kLXN0aWxsLWVycm9yIiwN\nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9hZGRyZXNz\nLmdldEhvc3RBZGRyZXNzKCkgKyAiOiINCiAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICArIF9wb3J0KSwgZSk7DQogICAgICAgICAg\nICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAg\nICAgIF9pbmZvc0lzc3VlZCsrOw0KICAgICAgICAgICAgICAgICAgICAgICAg\nfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0K\nICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgcHJpdmF0ZSBT\nb2NrZXQgZ2V0U29ja2V0KCkNCiAgICAgICAgICAgIHRocm93cyBFeGNlcHRp\nb24gew0KICAgICAgICAgICAgcmV0dXJuIChTb2NrZXQpIF9zb2NrZXRQb29s\nLmJvcnJvd09iamVjdCgpOw0KICAgICAgICB9DQoNCiAgICAgICAgcHJpdmF0\nZSB2b2lkIHJldHVyblNvY2tldChTb2NrZXQgcykNCiAgICAgICAgICAgIHRo\ncm93cyBFeGNlcHRpb24gew0KICAgICAgICAgICAgX3NvY2tldFBvb2wucmV0\ndXJuT2JqZWN0KHMpOw0KICAgICAgICB9DQoNCiAgICAgICAgcHJpdmF0ZSB2\nb2lkIGNsZWFyQWxsU29ja2V0cygpIHsNCiAgICAgICAgICAgIF9zb2NrZXRQ\nb29sLmNsZWFyKCk7DQogICAgICAgIH0NCg0KICAgICAgICBwcml2YXRlIHZv\naWQgY2xvc2VTb2NrZXQoU29ja2V0IHMpIHsNCiAgICAgICAgICAgIC8vIEFs\nbCBzb2NrZXRzIGNvbWUgZnJvbSB0aGUgcG9vbC4NCiAgICAgICAgICAgIC8v\nIFRoaXMgc29ja2V0IGlzIG5vIGxvbmdlciB1c2FibGUsIHNvIGRlbGV0ZSBp\ndCBmcm9tIHRoZQ0KICAgICAgICAgICAgLy8gcG9vbC4NCiAgICAgICAgICAg\nIHRyeSB7DQogICAgICAgICAgICAgICAgX3NvY2tldFBvb2wuaW52YWxpZGF0\nZU9iamVjdChzKTsNCiAgICAgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBl\nKSB7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICAvKioN\nCiAgICAgICAgICogRmFjdG9yeSBmb3IgcG9vbGVkIHNvY2tldHMuDQogICAg\nICAgICAqLw0KICAgICAgICBwcml2YXRlIGNsYXNzIFNvY2tldFBvb2xhYmxl\nT2JqZWN0RmFjdG9yeQ0KICAgICAgICAgICAgaW1wbGVtZW50cyBQb29sYWJs\nZU9iamVjdEZhY3Rvcnkgew0KDQogICAgICAgICAgICBwdWJsaWMgT2JqZWN0\nIG1ha2VPYmplY3QoKQ0KICAgICAgICAgICAgICAgIHRocm93cyBJT0V4Y2Vw\ndGlvbiB7DQogICAgICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAg\nICAgICAgU29ja2V0IHMgPSAoU29ja2V0KSBBY2Nlc3NDb250cm9sbGVyDQog\nICAgICAgICAgICAgICAgICAgICAgICAuZG9Qcml2aWxlZ2VkKEoyRG9Qcml2\nSGVscGVyLm5ld1NvY2tldEFjdGlvbihfYWRkcmVzcywNCiAgICAgICAgICAg\nICAgICAgICAgICAgICAgICBfcG9ydCkpOw0KICAgICAgICAgICAgICAgICAg\nICBpZiAobG9nLmlzVHJhY2VFbmFibGVkKCkpIHsNCiAgICAgICAgICAgICAg\nICAgICAgICAgIGxvZy50cmFjZShzX2xvYy5nZXQoInRjcC1vcGVuLWNvbm5l\nY3Rpb24iLCBfYWRkcmVzcw0KICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICsgIjoiICsgX3BvcnQsICIiICsgcy5nZXRMb2NhbFBvcnQoKSkpOw0KICAg\nICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHJldHVy\nbiBzOw0KICAgICAgICAgICAgICAgIH0gY2F0Y2ggKFByaXZpbGVnZWRBY3Rp\nb25FeGNlcHRpb24gcGFlKSB7DQogICAgICAgICAgICAgICAgICAgIHRocm93\nIChJT0V4Y2VwdGlvbikgcGFlLmdldEV4Y2VwdGlvbigpOw0KICAgICAgICAg\nICAgICAgIH0NCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgcHVibGlj\nIHZvaWQgZGVzdHJveU9iamVjdChPYmplY3Qgb2JqKSB7DQogICAgICAgICAg\nICAgICAgLy8gc2lsZW50Q2xvc2UgKCkuDQogICAgICAgICAgICAgICAgdHJ5\nIHsNCiAgICAgICAgICAgICAgICAgICAgU29ja2V0IHMgPSAoU29ja2V0KSBv\nYmo7DQogICAgICAgICAgICAgICAgICAgIGlmIChsb2cuaXNUcmFjZUVuYWJs\nZWQoKSkNCiAgICAgICAgICAgICAgICAgICAgICAgIGxvZy50cmFjZShzX2xv\nYy5nZXQoInRjcC1jbG9zZS1zZW5kaW5nLXNvY2tldCIsDQogICAgICAgICAg\nICAgICAgICAgICAgICAgICAgX2FkZHJlc3MgKyAiOiIgKyBfcG9ydCwgIiIg\nKyBzLmdldExvY2FsUG9ydCgpKSk7DQogICAgICAgICAgICAgICAgICAgIHMu\nY2xvc2UoKTsNCiAgICAgICAgICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24g\nZSkgew0KICAgICAgICAgICAgICAgICAgICBsb2cud2FybihzX2xvYy5nZXQo\nInRjcC1jbG9zZS1zb2NrZXQtZXJyb3IiLA0KICAgICAgICAgICAgICAgICAg\nICAgICAgX2FkZHJlc3MuZ2V0SG9zdEFkZHJlc3MoKSArICI6IiArIF9wb3J0\nKSwgZSk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KDQog\nICAgICAgICAgICBwdWJsaWMgYm9vbGVhbiB2YWxpZGF0ZU9iamVjdChPYmpl\nY3Qgb2JqKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAg\nICAgICAgICB9DQoNCiAgICAgICAgICAgIHB1YmxpYyB2b2lkIGFjdGl2YXRl\nT2JqZWN0IChPYmplY3QgdmFsdWUpDQoJCQl7DQoJCQl9DQoNCgkJCXB1Ymxp\nYyB2b2lkIHBhc3NpdmF0ZU9iamVjdCAoT2JqZWN0IHZhbHVlKQ0KCQkJew0K\nCQkJfQ0KCQl9DQoJfQ0KfQ0K\n","encoding":"base64"}

