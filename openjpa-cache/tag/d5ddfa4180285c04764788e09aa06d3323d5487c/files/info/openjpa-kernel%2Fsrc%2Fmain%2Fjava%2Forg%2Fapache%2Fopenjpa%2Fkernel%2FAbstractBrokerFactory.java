{"sha":"7659a9bc5208740017a2e674b9fa5fcb6fcbcb26","node_id":"MDQ6QmxvYjIwNjM2NDo3NjU5YTliYzUyMDg3NDAwMTdhMmU2NzRiOWZhNWZjYjZmY2JjYjI2","size":29499,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/7659a9bc5208740017a2e674b9fa5fcb6fcbcb26","content":"LyoNCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUNCiAqIG9yIG1vcmUgY29udHJpYnV0b3Ig\nbGljZW5zZSBhZ3JlZW1lbnRzLiAgU2VlIHRoZSBOT1RJQ0UgZmlsZQ0KICog\nZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5m\nb3JtYXRpb24NCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAg\nVGhlIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUNCiAqIHRvIHlvdSB1bmRlciB0\naGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUNCiAqICJMaWNl\nbnNlIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNv\nbXBsaWFuY2UNCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFp\nbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQNCiAqDQogKiBodHRwOi8vd3d3\nLmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjANCiAqDQogKiBVbmxl\nc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGlu\nIHdyaXRpbmcsDQogKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUg\nTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbg0KICogIkFTIElTIiBCQVNJ\nUywgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZDQog\nKiBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBM\naWNlbnNlIGZvciB0aGUNCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmlu\nZyBwZXJtaXNzaW9ucyBhbmQgbGltaXRhdGlvbnMNCiAqIHVuZGVyIHRoZSBM\naWNlbnNlLiAgICANCiAqLw0KcGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEu\na2VybmVsOw0KDQppbXBvcnQgamF2YS5pby5PYmplY3RTdHJlYW1FeGNlcHRp\nb247DQppbXBvcnQgamF2YS51dGlsLkFycmF5TGlzdDsNCmltcG9ydCBqYXZh\nLnV0aWwuQ29sbGVjdGlvbjsNCmltcG9ydCBqYXZhLnV0aWwuQ29sbGVjdGlv\nbnM7DQppbXBvcnQgamF2YS51dGlsLkhhc2hNYXA7DQppbXBvcnQgamF2YS51\ndGlsLkl0ZXJhdG9yOw0KaW1wb3J0IGphdmEudXRpbC5MaW5rZWRMaXN0Ow0K\naW1wb3J0IGphdmEudXRpbC5MaXN0Ow0KaW1wb3J0IGphdmEudXRpbC5NYXA7\nDQppbXBvcnQgamF2YS51dGlsLlByb3BlcnRpZXM7DQppbXBvcnQgamF2YS51\ndGlsLlNldDsNCmltcG9ydCBqYXZheC50cmFuc2FjdGlvbi5TdGF0dXM7DQpp\nbXBvcnQgamF2YXgudHJhbnNhY3Rpb24uU3luY2hyb25pemF0aW9uOw0KaW1w\nb3J0IGphdmF4LnRyYW5zYWN0aW9uLlRyYW5zYWN0aW9uOw0KaW1wb3J0IGph\ndmF4LnRyYW5zYWN0aW9uLlRyYW5zYWN0aW9uTWFuYWdlcjsNCg0KaW1wb3J0\nIG9yZy5hcGFjaGUuY29tbW9ucy5sYW5nLlN0cmluZ1V0aWxzOw0KaW1wb3J0\nIG9yZy5hcGFjaGUuY29tbW9ucy5jb2xsZWN0aW9ucy5zZXQuTWFwQmFja2Vk\nU2V0Ow0KaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5jb25mLk9wZW5KUEFD\nb25maWd1cmF0aW9uOw0KaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5jb25m\nLk9wZW5KUEFWZXJzaW9uOw0KaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5j\nb25mLkJyb2tlclZhbHVlOw0KaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5j\nb25mLk9wZW5KUEFDb25maWd1cmF0aW9uSW1wbDsNCmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEuZGF0YWNhY2hlLkRhdGFDYWNoZVN0b3JlTWFuYWdlcjsN\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuZWUuTWFuYWdlZFJ1bnRpbWU7\nDQppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmVuaGFuY2UuUENSZWdpc3Ry\neTsNCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuZW5oYW5jZS5QZXJzaXN0\nZW5jZUNhcGFibGU7DQppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmVuaGFu\nY2UuTWFuYWdlZENsYXNzU3ViY2xhc3NlcjsNCmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEuZXZlbnQuQnJva2VyRmFjdG9yeUV2ZW50Ow0KaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5ldmVudC5SZW1vdGVDb21taXRFdmVudE1hbmFn\nZXI7DQppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi5jb25mLkNvbmZp\nZ3VyYXRpb247DQppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi5jb25m\nLkNvbmZpZ3VyYXRpb25zOw0KaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5s\naWIubG9nLkxvZzsNCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0\naWwuSjJEb1ByaXZIZWxwZXI7DQppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLmxpYi51dGlsLkxvY2FsaXplcjsNCmltcG9ydCBqYXZhLnV0aWwuY29uY3Vy\ncmVudC5Db25jdXJyZW50SGFzaE1hcDsNCmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEubGliLnV0aWwuY29uY3VycmVudC5Db25jdXJyZW50UmVmZXJlbmNl\nSGFzaFNldDsNCmltcG9ydCBqYXZhLnV0aWwuY29uY3VycmVudC5sb2Nrcy5S\nZWVudHJhbnRMb2NrOw0KaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRh\nLk1ldGFEYXRhUmVwb3NpdG9yeTsNCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEudXRpbC5HZW5lcmFsRXhjZXB0aW9uOw0KaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS51dGlsLkludmFsaWRTdGF0ZUV4Y2VwdGlvbjsNCmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEudXRpbC5PcGVuSlBBRXhjZXB0aW9uOw0KaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLlVzZXJFeGNlcHRpb247DQoN\nCi8qKg0KICogQWJzdHJhY3QgaW1wbGVtZW50YXRpb24gb2YgdGhlIHtAbGlu\nayBCcm9rZXJGYWN0b3J5fQ0KICogdGhhdCBtdXN0IGJlIHN1YmNsYXNzZWQg\nZm9yIGEgc3BlY2lmaWMgcnVudGltZS4NCiAqDQogKiBAYXV0aG9yIEFiZSBX\naGl0ZQ0KICovDQpwdWJsaWMgYWJzdHJhY3QgY2xhc3MgQWJzdHJhY3RCcm9r\nZXJGYWN0b3J5DQogICAgaW1wbGVtZW50cyBCcm9rZXJGYWN0b3J5IHsNCg0K\nICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIExvY2FsaXplciBfbG9jID0gTG9j\nYWxpemVyLmZvclBhY2thZ2UNCiAgICAgICAgKEFic3RyYWN0QnJva2VyRmFj\ndG9yeS5jbGFzcyk7DQoNCiAgICAvLyBzdGF0aWMgbWFwcGluZyBvZiBjb25m\naWd1cmF0aW9ucyB0byBwb29sZWQgYnJva2VyIGZhY3Rvcmllcw0KICAgIHBy\naXZhdGUgc3RhdGljIGZpbmFsIE1hcCBfcG9vbCA9IENvbGxlY3Rpb25zLnN5\nbmNocm9uaXplZE1hcChuZXcgSGFzaE1hcCgpKTsNCg0KICAgIC8vIGNvbmZp\nZ3VyYXRpb24NCiAgICBwcml2YXRlIGZpbmFsIE9wZW5KUEFDb25maWd1cmF0\naW9uIF9jb25mOw0KICAgIHByaXZhdGUgdHJhbnNpZW50IGJvb2xlYW4gX3Jl\nYWRPbmx5ID0gZmFsc2U7DQogICAgcHJpdmF0ZSB0cmFuc2llbnQgYm9vbGVh\nbiBfY2xvc2VkID0gZmFsc2U7DQogICAgcHJpdmF0ZSB0cmFuc2llbnQgUnVu\ndGltZUV4Y2VwdGlvbiBfY2xvc2VkRXhjZXB0aW9uID0gbnVsbDsNCiAgICBw\ncml2YXRlIE1hcCBfdXNlck9iamVjdHMgPSBudWxsOw0KDQogICAgLy8gaW50\nZXJuYWwgbG9jazogc3BlYyBmb3JiaWRzIHN5bmNocm9uaXphdGlvbiBvbiB0\naGlzIG9iamVjdA0KICAgIHByaXZhdGUgZmluYWwgUmVlbnRyYW50TG9jayBf\nbG9jayA9IG5ldyBSZWVudHJhbnRMb2NrKCk7DQoNCiAgICAvLyBtYXBzIGds\nb2JhbCB0cmFuc2FjdGlvbnMgdG8gYXNzb2NpYXRlZCBicm9rZXJzDQogICAg\ncHJpdmF0ZSB0cmFuc2llbnQgQ29uY3VycmVudEhhc2hNYXAgX3RyYW5zYWN0\naW9uYWwNCiAgICAgICAgPSBuZXcgQ29uY3VycmVudEhhc2hNYXAoKTsNCg0K\nICAgIC8vIHdlYWstcmVmIHRyYWNraW5nIG9mIG9wZW4gYnJva2Vycw0KICAg\nIHByaXZhdGUgdHJhbnNpZW50IFNldCBfYnJva2VyczsNCg0KICAgIC8vIGNh\nY2hlIHRoZSBjbGFzcyBuYW1lcyBsb2FkZWQgZnJvbSB0aGUgcGVyc2lzdGVu\ndCBjbGFzc2VzIHByb3BlcnR5IHNvDQogICAgLy8gdGhhdCB3ZSBjYW4gcmUt\nbG9hZCB0aGVtIGZvciBlYWNoIG5ldyBicm9rZXINCiAgICBwcml2YXRlIHRy\nYW5zaWVudCBDb2xsZWN0aW9uIF9wY0NsYXNzTmFtZXMgPSBudWxsOw0KICAg\nIHByaXZhdGUgdHJhbnNpZW50IENvbGxlY3Rpb24gX3BjQ2xhc3NMb2FkZXJz\nID0gbnVsbDsNCiAgICBwcml2YXRlIHRyYW5zaWVudCBib29sZWFuIF9wZXJz\naXN0ZW50VHlwZXNMb2FkZWQgPSBmYWxzZTsNCg0KICAgIC8vIGxpZmVjeWNs\nZSBsaXN0ZW5lcnMgdG8gcGFzcyB0byBlYWNoIGJyb2tlcg0KICAgIHByaXZh\ndGUgdHJhbnNpZW50IE1hcCBfbGlmZWN5Y2xlTGlzdGVuZXJzID0gbnVsbDsN\nCg0KICAgIC8vIHRyYW5zYWN0aW9uIGxpc3RlbmVycyB0byBwYXNzIHRvIGVh\nY2ggYnJva2VyDQogICAgcHJpdmF0ZSB0cmFuc2llbnQgTGlzdCBfdHJhbnNh\nY3Rpb25MaXN0ZW5lcnMgPSBudWxsOw0KDQogICAgLy8ga2V5IHVuZGVyIHdo\naWNoIHRoaXMgaW5zdGFuY2UgY2FuIGJlIHN0b3JlZCBpbiB0aGUgYnJva2Vy\nIHBvb2wNCiAgICAvLyBhbmQgbGF0ZXIgaWRlbnRpZmllZA0KICAgIHByaXZh\ndGUgT2JqZWN0IF9wb29sS2V5Ow0KDQogICAgLyoqDQogICAgICogUmV0dXJu\nIGFuIGludGVybmFsIGZhY3RvcnkgcG9vbCBrZXkgZm9yIHRoZSBnaXZlbiBj\nb25maWd1cmF0aW9uLg0KICAgICAqDQogICAgICogQHNpbmNlIDEuMS4wDQog\nICAgICovDQogICAgcHJvdGVjdGVkIHN0YXRpYyBPYmplY3QgdG9Qb29sS2V5\nKE1hcCBtYXApIHsNCiAgICAgICAgT2JqZWN0IGtleSA9IENvbmZpZ3VyYXRp\nb25zLmdldFByb3BlcnR5KCJJZCIsIG1hcCk7DQogICAgICAgIHJldHVybiAo\nIGtleSAhPSBudWxsKSA/IGtleSA6IG1hcDsNCiAgICB9DQoNCiAgICAvKioN\nCiAgICAgKiBSZWdpc3RlciA8Y29kZT5mYWN0b3J5PC9jb2RlPiBpbiB0aGUg\ncG9vbCB1bmRlciA8Y29kZT5rZXk8L2NvZGU+Lg0KICAgICAqDQogICAgICog\nQHNpbmNlIDEuMS4wDQogICAgICovDQogICAgcHJvdGVjdGVkIHN0YXRpYyB2\nb2lkIHBvb2woT2JqZWN0IGtleSwgQWJzdHJhY3RCcm9rZXJGYWN0b3J5IGZh\nY3RvcnkpIHsNCiAgICAgICAgc3luY2hyb25pemVkKF9wb29sKSB7DQogICAg\nICAgICAgICBfcG9vbC5wdXQoa2V5LCBmYWN0b3J5KTsNCiAgICAgICAgICAg\nIGZhY3Rvcnkuc2V0UG9vbEtleShrZXkpOw0KICAgICAgICAgICAgZmFjdG9y\neS5tYWtlUmVhZE9ubHkoKTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIC8q\nKg0KICAgICAqIFJldHVybiB0aGUgcG9vbGVkIGZhY3RvcnkgbWF0Y2hpbmcg\ndGhlIGdpdmVuIGtleSwgb3IgbnVsbA0KICAgICAqIGlmIG5vbmUuIFRoZSBr\nZXkgbXVzdCBiZSBvZiB0aGUgZm9ybSBjcmVhdGVkIGJ5IHtAbGluayAjZ2V0\nUG9vbEtleX0uDQogICAgICovDQogICAgcHVibGljIHN0YXRpYyBBYnN0cmFj\ndEJyb2tlckZhY3RvcnkgZ2V0UG9vbGVkRmFjdG9yeUZvcktleShPYmplY3Qg\na2V5KSB7DQogICAgICAgIHJldHVybiAoQWJzdHJhY3RCcm9rZXJGYWN0b3J5\nKSBfcG9vbC5nZXQoa2V5KTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiBD\nb25zdHJ1Y3Rvci4gQ29uZmlndXJhdGlvbiBtdXN0IGJlIHByb3ZpZGVkIG9u\nIGNvbnN0cnVjdGlvbi4NCiAgICAgKi8NCiAgICBwcm90ZWN0ZWQgQWJzdHJh\nY3RCcm9rZXJGYWN0b3J5KE9wZW5KUEFDb25maWd1cmF0aW9uIGNvbmZpZykg\new0KICAgICAgICBfY29uZiA9IGNvbmZpZzsNCiAgICAgICAgX2Jyb2tlcnMg\nPSBuZXdCcm9rZXJTZXQoKTsNCiAgICAgICAgZ2V0UGNDbGFzc0xvYWRlcnMo\nKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiBSZXR1cm4gdGhlIGNvbmZp\nZ3VyYXRpb24gZm9yIHRoaXMgZmFjdG9yeS4NCiAgICAgKi8NCiAgICBwdWJs\naWMgT3BlbkpQQUNvbmZpZ3VyYXRpb24gZ2V0Q29uZmlndXJhdGlvbigpIHsN\nCiAgICAgICAgcmV0dXJuIF9jb25mOw0KICAgIH0NCg0KICAgIHB1YmxpYyBC\ncm9rZXIgbmV3QnJva2VyKCkgew0KICAgICAgICByZXR1cm4gbmV3QnJva2Vy\nKF9jb25mLmdldENvbm5lY3Rpb25Vc2VyTmFtZSgpLA0KICAgICAgICAgICAg\nX2NvbmYuZ2V0Q29ubmVjdGlvblBhc3N3b3JkKCkpOw0KICAgIH0NCg0KICAg\nIHB1YmxpYyBCcm9rZXIgbmV3QnJva2VyKFN0cmluZyB1c2VyLCBTdHJpbmcg\ncGFzcykgew0KICAgICAgICByZXR1cm4gbmV3QnJva2VyKHVzZXIsIHBhc3Ms\nIF9jb25mLmlzVHJhbnNhY3Rpb25Nb2RlTWFuYWdlZCgpLA0KICAgICAgICAg\nICAgX2NvbmYuZ2V0Q29ubmVjdGlvblJldGFpbk1vZGVDb25zdGFudCgpKTsN\nCiAgICB9DQoNCiAgICBwdWJsaWMgQnJva2VyIG5ld0Jyb2tlcihib29sZWFu\nIG1hbmFnZWQsIGludCBjb25uUmV0YWluTW9kZSkgew0KICAgICAgICByZXR1\ncm4gbmV3QnJva2VyKF9jb25mLmdldENvbm5lY3Rpb25Vc2VyTmFtZSgpLA0K\nICAgICAgICAgICAgX2NvbmYuZ2V0Q29ubmVjdGlvblBhc3N3b3JkKCksIG1h\nbmFnZWQsIGNvbm5SZXRhaW5Nb2RlKTsNCiAgICB9DQoNCiAgICBwdWJsaWMg\nQnJva2VyIG5ld0Jyb2tlcihTdHJpbmcgdXNlciwgU3RyaW5nIHBhc3MsIGJv\nb2xlYW4gbWFuYWdlZCwNCiAgICAgICAgaW50IGNvbm5SZXRhaW5Nb2RlKSB7\nDQogICAgICAgIHJldHVybiBuZXdCcm9rZXIodXNlciwgcGFzcywgbWFuYWdl\nZCwgY29ublJldGFpbk1vZGUsIHRydWUpOw0KICAgIH0NCg0KICAgIHB1Ymxp\nYyBCcm9rZXIgbmV3QnJva2VyKFN0cmluZyB1c2VyLCBTdHJpbmcgcGFzcywg\nYm9vbGVhbiBtYW5hZ2VkLA0KICAgICAgICBpbnQgY29ublJldGFpbk1vZGUs\nIGJvb2xlYW4gZmluZEV4aXN0aW5nKSB7DQogICAgICAgIHRyeSB7DQogICAg\nICAgICAgICBhc3NlcnRPcGVuKCk7DQogICAgICAgICAgICBtYWtlUmVhZE9u\nbHkoKTsNCg0KICAgICAgICAgICAgQnJva2VySW1wbCBicm9rZXIgPSBudWxs\nOw0KICAgICAgICAgICAgaWYgKGZpbmRFeGlzdGluZykNCiAgICAgICAgICAg\nICAgICBicm9rZXIgPSBmaW5kQnJva2VyKHVzZXIsIHBhc3MsIG1hbmFnZWQp\nOw0KICAgICAgICAgICAgaWYgKGJyb2tlciA9PSBudWxsKSB7DQogICAgICAg\nICAgICAgICAgYnJva2VyID0gbmV3QnJva2VySW1wbCh1c2VyLCBwYXNzKTsN\nCiAgICAgICAgICAgICAgICBpbml0aWFsaXplQnJva2VyKG1hbmFnZWQsIGNv\nbm5SZXRhaW5Nb2RlLCBicm9rZXIsIGZhbHNlKTsNCiAgICAgICAgICAgIH0N\nCiAgICAgICAgICAgIHJldHVybiBicm9rZXI7DQogICAgICAgIH0gY2F0Y2gg\nKE9wZW5KUEFFeGNlcHRpb24ga2UpIHsNCiAgICAgICAgICAgIHRocm93IGtl\nOw0KICAgICAgICB9IGNhdGNoIChSdW50aW1lRXhjZXB0aW9uIHJlKSB7DQog\nICAgICAgICAgICB0aHJvdyBuZXcgR2VuZXJhbEV4Y2VwdGlvbihyZSk7DQog\nICAgICAgIH0NCiAgICB9DQoNCiAgICB2b2lkIGluaXRpYWxpemVCcm9rZXIo\nYm9vbGVhbiBtYW5hZ2VkLCBpbnQgY29ublJldGFpbk1vZGUsDQogICAgICAg\nIEJyb2tlckltcGwgYnJva2VyLCBib29sZWFuIGZyb21EZXNlcmlhbGl6YXRp\nb24pIHsNCiAgICAgICAgYXNzZXJ0T3BlbigpOw0KICAgICAgICBtYWtlUmVh\nZE9ubHkoKTsNCg0KICAgICAgICAvLyBkZWNvcmF0ZSB0aGUgc3RvcmUgbWFu\nYWdlciBmb3IgZGF0YSBjYWNoaW5nIGFuZCBjdXN0b20NCiAgICAgICAgLy8g\ncmVzdWx0IG9iamVjdCBwcm92aWRlcnM7IGFsd2F5cyBtYWtlIHN1cmUgaXQn\ncyBhIGRlbGVnYXRpbmcNCiAgICAgICAgLy8gc3RvcmUgbWFuYWdlciwgYmVj\nYXVzZSBpdCdzIGVhc2llciBmb3IgdXNlcnMgdG8gZGVhbCB3aXRoDQogICAg\nICAgIC8vIHRoYXQgd2F5DQogICAgICAgIFN0b3JlTWFuYWdlciBzbSA9IG5l\nd1N0b3JlTWFuYWdlcigpOw0KICAgICAgICBEZWxlZ2F0aW5nU3RvcmVNYW5h\nZ2VyIGRzbSA9IG51bGw7DQogICAgICAgIGlmIChfY29uZi5nZXREYXRhQ2Fj\naGVNYW5hZ2VySW5zdGFuY2UoKS5nZXRTeXN0ZW1EYXRhQ2FjaGUoKQ0KICAg\nICAgICAgICAgIT0gbnVsbCkNCiAgICAgICAgICAgIGRzbSA9IG5ldyBEYXRh\nQ2FjaGVTdG9yZU1hbmFnZXIoc20pOw0KICAgICAgICBkc20gPSBuZXcgUk9Q\nU3RvcmVNYW5hZ2VyKChkc20gPT0gbnVsbCkgPyBzbSA6IGRzbSk7DQoNCiAg\nICAgICAgYnJva2VyLmluaXRpYWxpemUodGhpcywgZHNtLCBtYW5hZ2VkLCBj\nb25uUmV0YWluTW9kZSwNCiAgICAgICAgICAgIGZyb21EZXNlcmlhbGl6YXRp\nb24pOw0KICAgICAgICBpZiAoIWZyb21EZXNlcmlhbGl6YXRpb24pDQogICAg\nICAgICAgICBhZGRMaXN0ZW5lcnMoYnJva2VyKTsNCg0KICAgICAgICAvLyBp\nZiB3ZSdyZSB1c2luZyByZW1vdGUgZXZlbnRzLCByZWdpc3RlciB0aGUgZXZl\nbnQgbWFuYWdlciBzbw0KICAgICAgICAvLyB0aGF0IGl0IGNhbiBicm9hZGNh\nc3QgY29tbWl0IG5vdGlmaWNhdGlvbnMgZnJvbSB0aGUgYnJva2VyDQogICAg\nICAgIFJlbW90ZUNvbW1pdEV2ZW50TWFuYWdlciByZW1vdGUgPSBfY29uZi4N\nCiAgICAgICAgICAgIGdldFJlbW90ZUNvbW1pdEV2ZW50TWFuYWdlcigpOw0K\nICAgICAgICBpZiAocmVtb3RlLmFyZVJlbW90ZUV2ZW50c0VuYWJsZWQoKSkN\nCiAgICAgICAgICAgIGJyb2tlci5hZGRUcmFuc2FjdGlvbkxpc3RlbmVyKHJl\nbW90ZSk7DQoNCiAgICAgICAgbG9hZFBlcnNpc3RlbnRUeXBlcyhicm9rZXIu\nZ2V0Q2xhc3NMb2FkZXIoKSk7DQogICAgICAgIF9icm9rZXJzLmFkZChicm9r\nZXIpOw0KICAgICAgICBfY29uZi5zZXRSZWFkT25seShDb25maWd1cmF0aW9u\nLklOSVRfU1RBVEVfRlJPWkVOKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAg\nKiBBZGQgZmFjdG9yeS1yZWdpc3RlcmVkIGxpZmVjeWNsZSBsaXN0ZW5lcnMg\ndG8gdGhlIGJyb2tlci4NCiAgICAgKi8NCiAgICBwcm90ZWN0ZWQgdm9pZCBh\nZGRMaXN0ZW5lcnMoQnJva2VySW1wbCBicm9rZXIpIHsNCiAgICAgICAgaWYg\nKF9saWZlY3ljbGVMaXN0ZW5lcnMgIT0gbnVsbCAmJiAhX2xpZmVjeWNsZUxp\nc3RlbmVycy5pc0VtcHR5KCkpIHsNCiAgICAgICAgICAgIE1hcC5FbnRyeSBl\nbnRyeTsNCiAgICAgICAgICAgIGZvciAoSXRlcmF0b3IgaXRyID0gX2xpZmVj\neWNsZUxpc3RlbmVycy5lbnRyeVNldCgpLml0ZXJhdG9yKCk7DQogICAgICAg\nICAgICAgICAgaXRyLmhhc05leHQoKTspIHsNCiAgICAgICAgICAgICAgICBl\nbnRyeSA9IChNYXAuRW50cnkpIGl0ci5uZXh0KCk7DQogICAgICAgICAgICAg\nICAgYnJva2VyLmFkZExpZmVjeWNsZUxpc3RlbmVyKGVudHJ5LmdldEtleSgp\nLCAoQ2xhc3NbXSkNCiAgICAgICAgICAgICAgICAgICAgZW50cnkuZ2V0VmFs\ndWUoKSk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICBp\nZiAoX3RyYW5zYWN0aW9uTGlzdGVuZXJzICE9IG51bGwgJiYgIV90cmFuc2Fj\ndGlvbkxpc3RlbmVycy5pc0VtcHR5KCkpIHsNCiAgICAgICAgICAgIGZvciAo\nSXRlcmF0b3IgaXRyID0gX3RyYW5zYWN0aW9uTGlzdGVuZXJzLml0ZXJhdG9y\nKCk7DQogICAgICAgICAgICAgICAgaXRyLmhhc05leHQoKTsgKSB7DQogICAg\nICAgICAgICAgICAgYnJva2VyLmFkZFRyYW5zYWN0aW9uTGlzdGVuZXIoaXRy\nLm5leHQoKSk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9DQoN\nCiAgICAvKioNCiAgICAgKiBMb2FkIHRoZSBjb25maWd1cmVkIHBlcnNpc3Rl\nbnQgY2xhc3NlcyBsaXN0LiBQZXJmb3JtZWQgYXV0b21hdGljYWxseQ0KICAg\nICAqIHdoZW5ldmVyIGEgYnJva2VyIGlzIGNyZWF0ZWQuDQogICAgICovDQog\nICAgcHJpdmF0ZSB2b2lkIGxvYWRQZXJzaXN0ZW50VHlwZXMoQ2xhc3NMb2Fk\nZXIgZW52TG9hZGVyKSB7DQogICAgICAgIC8vIGlmIHdlJ3ZlIGxvYWRlZCB0\naGUgcGVyc2lzdGVudCB0eXBlcyBhbmQgdGhlIGNsYXNzIG5hbWUgbGlzdA0K\nICAgICAgICAvLyBpcyBlbXB0eSwgdGhlbiB3ZSBjYW4gc2ltcGx5IHJldHVy\nbi4gTm90ZSB0aGF0IHRoZXJlIGlzIGENCiAgICAgICAgLy8gcG90ZW50aWFs\nIHRocmVhZGluZyBzY2VuYXJpbyBpbiB3aGljaCBfcGVyc2lzdGVudFR5cGVz\nTG9hZGVkIGlzDQogICAgICAgIC8vIGZhbHNlIHdoZW4gcmVhZCwgYnV0IHRo\nZSB3b3JrIHRvIHBvcHVsYXRlIF9wY0NsYXNzTmFtZXMgaGFzDQogICAgICAg\nIC8vIGFscmVhZHkgYmVlbiBkb25lLiBUaGlzIGlzIG9rOyBfcGNDbGFzc05h\nbWVzIGNhbiB0b2xlcmF0ZQ0KICAgICAgICAvLyBjb25jdXJyZW50IGFjY2Vz\ncywgc28gdGhlIHdvcnN0IGNhc2UgaXMgdGhhdCB0aGUgbGlzdCBpcw0KICAg\nICAgICAvLyBwZXJzaXN0ZW50IHR5cGUgZGF0YSBpcyBwcm9jZXNzZWQgbXVs\ndGlwbGUgdGltZXMsIHdoaWNoIHRoaXMNCiAgICAgICAgLy8gYWxnb3JpdGht\nIHRha2VzIGludG8gYWNjb3VudC4NCiAgICAgICAgaWYgKF9wZXJzaXN0ZW50\nVHlwZXNMb2FkZWQgJiYgX3BjQ2xhc3NOYW1lcy5pc0VtcHR5KCkpDQogICAg\nICAgICAgICByZXR1cm47DQoNCiAgICAgICAgLy8gY2FjaGUgcGVyc2lzdGVu\ndCB0eXBlIG5hbWVzIGlmIG5vdCBhbHJlYWR5DQogICAgICAgIENsYXNzTG9h\nZGVyIGxvYWRlciA9IF9jb25mLmdldENsYXNzUmVzb2x2ZXJJbnN0YW5jZSgp\nLg0KICAgICAgICAgICAgZ2V0Q2xhc3NMb2FkZXIoZ2V0Q2xhc3MoKSwgZW52\nTG9hZGVyKTsNCiAgICAgICAgQ29sbGVjdGlvbiB0b1JlZGVmaW5lID0gbmV3\nIEFycmF5TGlzdCgpOw0KICAgICAgICBpZiAoIV9wZXJzaXN0ZW50VHlwZXNM\nb2FkZWQpIHsNCiAgICAgICAgICAgIENvbGxlY3Rpb24gY2xzcyA9IF9jb25m\nLmdldE1ldGFEYXRhUmVwb3NpdG9yeUluc3RhbmNlKCkuDQogICAgICAgICAg\nICAgICAgbG9hZFBlcnNpc3RlbnRUeXBlcyhmYWxzZSwgbG9hZGVyKTsNCiAg\nICAgICAgICAgIGlmIChjbHNzLmlzRW1wdHkoKSkNCiAgICAgICAgICAgICAg\nICBfcGNDbGFzc05hbWVzID0gQ29sbGVjdGlvbnMuRU1QVFlfU0VUOw0KICAg\nICAgICAgICAgZWxzZSB7DQogICAgICAgICAgICAgICAgQ29sbGVjdGlvbiBj\nID0gbmV3IEFycmF5TGlzdChjbHNzLnNpemUoKSk7DQogICAgICAgICAgICAg\nICAgZm9yIChJdGVyYXRvciBpdHIgPSBjbHNzLml0ZXJhdG9yKCk7IGl0ci5o\nYXNOZXh0KCk7KSB7DQogICAgICAgICAgICAgICAgICAgIENsYXNzIGNscyA9\nIChDbGFzcykgaXRyLm5leHQoKTsNCiAgICAgICAgICAgICAgICAgICAgYy5h\nZGQoY2xzLmdldE5hbWUoKSk7DQogICAgICAgICAgICAgICAgICAgIGlmIChu\nZWVkc1N1YihjbHMpKQ0KICAgICAgICAgICAgICAgICAgICAgICAgdG9SZWRl\nZmluZS5hZGQoY2xzKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAg\nICAgICAgZ2V0UGNDbGFzc0xvYWRlcnMoKS5hZGQobG9hZGVyKTsNCiAgICAg\nICAgICAgICAgICBfcGNDbGFzc05hbWVzID0gYzsNCiAgICAgICAgICAgIH0N\nCiAgICAgICAgICAgIF9wZXJzaXN0ZW50VHlwZXNMb2FkZWQgPSB0cnVlOw0K\nICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgLy8gcmVsb2FkIHdpdGgg\ndGhpcyBsb2FkZXINCiAgICAgICAgICAgIGlmIChnZXRQY0NsYXNzTG9hZGVy\ncygpLmFkZChsb2FkZXIpKSB7DQogICAgICAgICAgICAgICAgZm9yIChJdGVy\nYXRvciBpdHIgPSBfcGNDbGFzc05hbWVzLml0ZXJhdG9yKCk7IGl0ci5oYXNO\nZXh0KCk7KSB7DQogICAgICAgICAgICAgICAgICAgIHRyeSB7DQogICAgICAg\nICAgICAgICAgICAgICAgICBDbGFzcyBjbHMgPQ0KICAgICAgICAgICAgICAg\nICAgICAgICAgICAgIENsYXNzLmZvck5hbWUoKFN0cmluZykgaXRyLm5leHQo\nKSwgdHJ1ZSwgbG9hZGVyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlm\nIChuZWVkc1N1YihjbHMpKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAg\nIHRvUmVkZWZpbmUuYWRkKGNscyk7DQogICAgICAgICAgICAgICAgICAgIH0g\nY2F0Y2ggKFRocm93YWJsZSB0KSB7DQogICAgICAgICAgICAgICAgICAgICAg\nICBfY29uZi5nZXRMb2coT3BlbkpQQUNvbmZpZ3VyYXRpb24uTE9HX1JVTlRJ\nTUUpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLndhcm4obnVsbCwg\ndCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9\nDQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICAvLyBnZXQg\ndGhlIE1hbmFnZWRDbGFzc1N1YmNsYXNzZXIgaW50byB0aGUgbG9vcA0KICAg\nICAgICBNYW5hZ2VkQ2xhc3NTdWJjbGFzc2VyLnByZXBhcmVVbmVuaGFuY2Vk\nQ2xhc3NlcygNCiAgICAgICAgICAgIF9jb25mLCB0b1JlZGVmaW5lLCBlbnZM\nb2FkZXIpOw0KICAgIH0NCg0KICAgIHByaXZhdGUgYm9vbGVhbiBuZWVkc1N1\nYihDbGFzcyBjbHMpIHsNCiAgICAgICAgcmV0dXJuICFjbHMuaXNJbnRlcmZh\nY2UoKQ0KICAgICAgICAgICAgJiYgIVBlcnNpc3RlbmNlQ2FwYWJsZS5jbGFz\ncy5pc0Fzc2lnbmFibGVGcm9tKGNscyk7DQogICAgfQ0KDQogICAgcHVibGlj\nIHZvaWQgYWRkTGlmZWN5Y2xlTGlzdGVuZXIoT2JqZWN0IGxpc3RlbmVyLCBD\nbGFzc1tdIGNsYXNzZXMpIHsNCiAgICAgICAgbG9jaygpOw0KICAgICAgICB0\ncnkgew0KICAgICAgICAgICAgYXNzZXJ0T3BlbigpOw0KICAgICAgICAgICAg\naWYgKF9saWZlY3ljbGVMaXN0ZW5lcnMgPT0gbnVsbCkNCiAgICAgICAgICAg\nICAgICBfbGlmZWN5Y2xlTGlzdGVuZXJzID0gbmV3IEhhc2hNYXAoNyk7DQog\nICAgICAgICAgICBfbGlmZWN5Y2xlTGlzdGVuZXJzLnB1dChsaXN0ZW5lciwg\nY2xhc3Nlcyk7DQogICAgICAgIH0gZmluYWxseSB7DQogICAgICAgICAgICB1\nbmxvY2soKTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIHB1YmxpYyB2b2lk\nIHJlbW92ZUxpZmVjeWNsZUxpc3RlbmVyKE9iamVjdCBsaXN0ZW5lcikgew0K\nICAgICAgICBsb2NrKCk7DQogICAgICAgIHRyeSB7DQogICAgICAgICAgICBh\nc3NlcnRPcGVuKCk7DQogICAgICAgICAgICBpZiAoX2xpZmVjeWNsZUxpc3Rl\nbmVycyAhPSBudWxsKQ0KICAgICAgICAgICAgICAgIF9saWZlY3ljbGVMaXN0\nZW5lcnMucmVtb3ZlKGxpc3RlbmVyKTsNCiAgICAgICAgfSBmaW5hbGx5IHsN\nCiAgICAgICAgICAgIHVubG9jaygpOw0KICAgICAgICB9DQogICAgfQ0KDQog\nICAgcHVibGljIHZvaWQgYWRkVHJhbnNhY3Rpb25MaXN0ZW5lcihPYmplY3Qg\nbGlzdGVuZXIpIHsNCiAgICAgICAgbG9jaygpOw0KICAgICAgICB0cnkgew0K\nICAgICAgICAgICAgYXNzZXJ0T3BlbigpOw0KICAgICAgICAgICAgaWYgKF90\ncmFuc2FjdGlvbkxpc3RlbmVycyA9PSBudWxsKQ0KICAgICAgICAgICAgICAg\nIF90cmFuc2FjdGlvbkxpc3RlbmVycyA9IG5ldyBMaW5rZWRMaXN0KCk7DQog\nICAgICAgICAgICBfdHJhbnNhY3Rpb25MaXN0ZW5lcnMuYWRkKGxpc3RlbmVy\nKTsNCiAgICAgICAgfSBmaW5hbGx5IHsNCiAgICAgICAgICAgIHVubG9jaygp\nOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgcHVibGljIHZvaWQgcmVtb3Zl\nVHJhbnNhY3Rpb25MaXN0ZW5lcihPYmplY3QgbGlzdGVuZXIpIHsNCiAgICAg\nICAgbG9jaygpOw0KICAgICAgICB0cnkgew0KICAgICAgICAgICAgYXNzZXJ0\nT3BlbigpOw0KICAgICAgICAgICAgaWYgKF90cmFuc2FjdGlvbkxpc3RlbmVy\ncyAhPSBudWxsKQ0KICAgICAgICAgICAgICAgIF90cmFuc2FjdGlvbkxpc3Rl\nbmVycy5yZW1vdmUobGlzdGVuZXIpOw0KICAgICAgICB9IGZpbmFsbHkgew0K\nICAgICAgICAgICAgdW5sb2NrKCk7DQogICAgICAgIH0NCiAgICB9DQoNCiAg\nICAvKioNCiAgICAgKiBSZXR1cm5zIHRydWUgaWYgdGhpcyBicm9rZXIgZmFj\ndG9yeSBpcyBjbG9zZWQuDQogICAgICovDQogICAgcHVibGljIGJvb2xlYW4g\naXNDbG9zZWQoKSB7DQogICAgICAgIHJldHVybiBfY2xvc2VkOw0KICAgIH0N\nCg0KICAgIHB1YmxpYyB2b2lkIGNsb3NlKCkgew0KICAgICAgICBsb2NrKCk7\nDQogICAgICAgIHRyeSB7DQogICAgICAgICAgICBhc3NlcnRPcGVuKCk7DQog\nICAgICAgICAgICBhc3NlcnROb0FjdGl2ZVRyYW5zYWN0aW9uKCk7DQoNCiAg\nICAgICAgICAgIC8vIHJlbW92ZSBmcm9tIGZhY3RvcnkgcG9vbA0KICAgICAg\nICAgICAgc3luY2hyb25pemVkIChfcG9vbCkgew0KICAgICAgICAgICAgICAg\nIGlmIChfcG9vbC5nZXQoX3Bvb2xLZXkpID09IHRoaXMpDQogICAgICAgICAg\nICAgICAgICAgIF9wb29sLnJlbW92ZShfcG9vbEtleSk7DQogICAgICAgICAg\nICB9DQoNCiAgICAgICAgICAgIC8vIGNsb3NlIGFsbCBicm9rZXJzDQogICAg\nICAgICAgICBCcm9rZXIgYnJva2VyOw0KICAgICAgICAgICAgZm9yIChJdGVy\nYXRvciBpdHIgPSBfYnJva2Vycy5pdGVyYXRvcigpOyBpdHIuaGFzTmV4dCgp\nOykgew0KICAgICAgICAgICAgICAgIGJyb2tlciA9IChCcm9rZXIpIGl0ci5u\nZXh0KCk7DQogICAgICAgICAgICAgICAgLy8gQ2hlY2sgZm9yIG51bGwgYmVj\nYXVzZSBfYnJva2VycyBtYXkgY29udGFpbiB3ZWFrIHJlZmVyZW5jZXMNCiAg\nICAgICAgICAgICAgICBpZiAoKGJyb2tlciAhPSBudWxsKSAmJiAoIWJyb2tl\nci5pc0Nsb3NlZCgpKSkNCiAgICAgICAgICAgICAgICAgICAgYnJva2VyLmNs\nb3NlKCk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGlmKF9jb25m\nLm1ldGFEYXRhUmVwb3NpdG9yeUF2YWlsYWJsZSgpKSB7DQogICAgICAgICAg\nICAgICAgLy8gcmVtb3ZlIG1ldGFkYXRhIHJlcG9zaXRvcnkgZnJvbSBsaXN0\nZW5lciBsaXN0DQogICAgICAgICAgICAgICAgUENSZWdpc3RyeS5yZW1vdmVS\nZWdpc3RlckNsYXNzTGlzdGVuZXINCiAgICAgICAgICAgICAgICAgICAgKF9j\nb25mLmdldE1ldGFEYXRhUmVwb3NpdG9yeUluc3RhbmNlKCkpOw0KICAgICAg\nICAgICAgfQ0KDQogICAgICAgICAgICBfY29uZi5jbG9zZSgpOw0KICAgICAg\nICAgICAgX2Nsb3NlZCA9IHRydWU7DQogICAgICAgICAgICBMb2cgbG9nID0g\nX2NvbmYuZ2V0TG9nKE9wZW5KUEFDb25maWd1cmF0aW9uLkxPR19SVU5USU1F\nKTsNCiAgICAgICAgICAgIGlmIChsb2cuaXNUcmFjZUVuYWJsZWQoKSkNCiAg\nICAgICAgICAgICAgICBfY2xvc2VkRXhjZXB0aW9uID0gbmV3IElsbGVnYWxT\ndGF0ZUV4Y2VwdGlvbigpOw0KICAgICAgICB9IGZpbmFsbHkgew0KICAgICAg\nICAgICAgdW5sb2NrKCk7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICAvKioN\nCiAgICAgKiBTdWJjbGFzc2VzIHNob3VsZCBvdmVycmlkZSB0aGlzIG1ldGhv\nZCB0byBhZGQgYSA8Y29kZT5QbGF0Zm9ybTwvY29kZT4NCiAgICAgKiBwcm9w\nZXJ0eSBsaXN0aW5nIHRoZSBydW50aW1lIHBsYXRmb3JtLCBzdWNoIGFzOg0K\nICAgICAqIDxjb2RlPk9wZW5KUEEgSkRCQyBFZGl0aW9uOiBPcmFjbGUgRGF0\nYWJhc2U8L2NvZGU+DQogICAgICovDQogICAgcHVibGljIFByb3BlcnRpZXMg\nZ2V0UHJvcGVydGllcygpIHsNCiAgICAgICAgLy8gcmVxdWlyZWQgcHJvcHMg\nYXJlIFZlbmRvck5hbWUgYW5kIFZlcnNpb25OdW1iZXINCiAgICAgICAgUHJv\ncGVydGllcyBwcm9wcyA9IG5ldyBQcm9wZXJ0aWVzKCk7DQogICAgICAgIHBy\nb3BzLnNldFByb3BlcnR5KCJWZW5kb3JOYW1lIiwgT3BlbkpQQVZlcnNpb24u\nVkVORE9SX05BTUUpOw0KICAgICAgICBwcm9wcy5zZXRQcm9wZXJ0eSgiVmVy\nc2lvbk51bWJlciIsIE9wZW5KUEFWZXJzaW9uLlZFUlNJT05fTlVNQkVSKTsN\nCiAgICAgICAgcHJvcHMuc2V0UHJvcGVydHkoIlZlcnNpb25JZCIsIE9wZW5K\nUEFWZXJzaW9uLlZFUlNJT05fSUQpOw0KICAgICAgICByZXR1cm4gcHJvcHM7\nDQogICAgfQ0KDQogICAgcHVibGljIE9iamVjdCBnZXRVc2VyT2JqZWN0KE9i\namVjdCBrZXkpIHsNCiAgICAgICAgbG9jaygpOw0KICAgICAgICB0cnkgew0K\nICAgICAgICAgICAgYXNzZXJ0T3BlbigpOw0KICAgICAgICAgICAgcmV0dXJu\nIChfdXNlck9iamVjdHMgPT0gbnVsbCkgPyBudWxsIDogX3VzZXJPYmplY3Rz\nLmdldChrZXkpOw0KICAgICAgICB9IGZpbmFsbHkgew0KICAgICAgICAgICAg\ndW5sb2NrKCk7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICBwdWJsaWMgT2Jq\nZWN0IHB1dFVzZXJPYmplY3QoT2JqZWN0IGtleSwgT2JqZWN0IHZhbCkgew0K\nICAgICAgICBsb2NrKCk7DQogICAgICAgIHRyeSB7DQogICAgICAgICAgICBh\nc3NlcnRPcGVuKCk7DQogICAgICAgICAgICBpZiAodmFsID09IG51bGwpDQog\nICAgICAgICAgICAgICAgcmV0dXJuIChfdXNlck9iamVjdHMgPT0gbnVsbCkg\nPyBudWxsIDogX3VzZXJPYmplY3RzLnJlbW92ZShrZXkpOw0KDQogICAgICAg\nICAgICBpZiAoX3VzZXJPYmplY3RzID09IG51bGwpDQogICAgICAgICAgICAg\nICAgX3VzZXJPYmplY3RzID0gbmV3IEhhc2hNYXAoKTsNCiAgICAgICAgICAg\nIHJldHVybiBfdXNlck9iamVjdHMucHV0KGtleSwgdmFsKTsNCiAgICAgICAg\nfSBmaW5hbGx5IHsNCiAgICAgICAgICAgIHVubG9jaygpOw0KICAgICAgICB9\nDQogICAgfQ0KDQogICAgcHVibGljIHZvaWQgbG9jaygpIHsNCiAgICAgICAg\nX2xvY2subG9jaygpOw0KICAgIH0NCg0KICAgIHB1YmxpYyB2b2lkIHVubG9j\naygpIHsNCiAgICAgICAgX2xvY2sudW5sb2NrKCk7DQogICAgfQ0KDQogICAg\nLyoqDQogICAgICogUmVwbGFjZXMgdGhlIGZhY3Rvcnkgd2l0aCB0aGlzIEpW\nTXMgcG9vbGVkIHZlcnNpb24gaWYgaXQgZXhpc3RzLiBBbHNvDQogICAgICog\nZnJlZXplcyB0aGUgZmFjdG9yeS4NCiAgICAgKi8NCiAgICBwcm90ZWN0ZWQg\nT2JqZWN0IHJlYWRSZXNvbHZlKCkNCiAgICAgICAgdGhyb3dzIE9iamVjdFN0\ncmVhbUV4Y2VwdGlvbiB7DQogICAgICAgIEFic3RyYWN0QnJva2VyRmFjdG9y\neSBmYWN0b3J5ID0gZ2V0UG9vbGVkRmFjdG9yeUZvcktleShfcG9vbEtleSk7\nDQogICAgICAgIGlmIChmYWN0b3J5ICE9IG51bGwpDQogICAgICAgICAgICBy\nZXR1cm4gZmFjdG9yeTsNCg0KICAgICAgICAvLyByZXNldCB0aGVzZSB0cmFu\nc2llbnQgZmllbGRzIHRvIGVtcHR5IHZhbHVlcw0KICAgICAgICBfdHJhbnNh\nY3Rpb25hbCA9IG5ldyBDb25jdXJyZW50SGFzaE1hcCgpOw0KICAgICAgICBf\nYnJva2VycyA9IG5ld0Jyb2tlclNldCgpOw0KDQogICAgICAgIG1ha2VSZWFk\nT25seSgpOw0KICAgICAgICByZXR1cm4gdGhpczsNCiAgICB9DQoNCiAgICBw\ncml2YXRlIFNldCBuZXdCcm9rZXJTZXQoKSB7DQogICAgICAgIEJyb2tlclZh\nbHVlIGJ2Ow0KICAgICAgICBpZiAoX2NvbmYgaW5zdGFuY2VvZiBPcGVuSlBB\nQ29uZmlndXJhdGlvbkltcGwpDQogICAgICAgICAgICBidiA9ICgoT3BlbkpQ\nQUNvbmZpZ3VyYXRpb25JbXBsKSBfY29uZikuYnJva2VyUGx1Z2luOw0KICAg\nICAgICBlbHNlDQogICAgICAgICAgICBidiA9IChCcm9rZXJWYWx1ZSkgX2Nv\nbmYuZ2V0VmFsdWUoQnJva2VyVmFsdWUuS0VZKTsNCg0KICAgICAgICBpZiAo\nRmluYWxpemluZ0Jyb2tlckltcGwuY2xhc3MuaXNBc3NpZ25hYmxlRnJvbSgN\nCiAgICAgICAgICAgIGJ2LmdldFRlbXBsYXRlQnJva2VyVHlwZShfY29uZikp\nKSB7DQogICAgICAgICAgICByZXR1cm4gTWFwQmFja2VkU2V0LmRlY29yYXRl\nKG5ldyBDb25jdXJyZW50SGFzaE1hcCgpLA0KICAgICAgICAgICAgICAgIG5l\ndyBPYmplY3QoKSB7IH0pOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAg\nICAgcmV0dXJuIG5ldyBDb25jdXJyZW50UmVmZXJlbmNlSGFzaFNldCgNCiAg\nICAgICAgICAgICAgICBDb25jdXJyZW50UmVmZXJlbmNlSGFzaFNldC5XRUFL\nKTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIC8vLy8vLy8vLy8vLy8vLy8v\nLy8vLy8vLw0KICAgIC8vIE1ldGhvZHMgZm9yIE92ZXJyaWRlDQogICAgLy8v\nLy8vLy8vLy8vLy8vLy8vLy8vLy8vDQoNCiAgICAvKioNCiAgICAgKiBSZXR1\ncm4gYSBuZXcgU3RvcmVNYW5hZ2VyIGZvciB0aGlzIHJ1bnRpbWUuIE5vdGUg\ndGhhdCB0aGUgaW5zdGFuY2UNCiAgICAgKiByZXR1cm5lZCBoZXJlIG1heSBi\nZSB3cmFwcGVkIGJlZm9yZSBiZWluZyBwYXNzZWQgdG8gdGhlDQogICAgICog\ne0BsaW5rICNuZXdCcm9rZXJ9IG1ldGhvZC4NCiAgICAgKi8NCiAgICBwcm90\nZWN0ZWQgYWJzdHJhY3QgU3RvcmVNYW5hZ2VyIG5ld1N0b3JlTWFuYWdlcigp\nOw0KDQogICAgLyoqDQogICAgICogRmluZCBhIHBvb2xlZCBicm9rZXIsIG9y\nIHJldHVybiBudWxsIGlmIG5vbmUuIElmIHVzaW5nDQogICAgICogbWFuYWdl\nZCB0cmFuc2FjdGlvbnMsIGxvb2tzIGZvciBhIHRyYW5zYWN0aW9uYWwgYnJv\na2VyOw0KICAgICAqIG90aGVyd2lzZSByZXR1cm5zIG51bGwgYnkgZGVmYXVs\ndC4gVGhpcyBtZXRob2Qgd2lsbCBiZSBjYWxsZWQgYmVmb3JlDQogICAgICog\ne0BsaW5rICNuZXdTdG9yZU1hbmFnZXJ9IHNvIHRoYXQgZmFjdG9yeSBzdWJj\nbGFzc2VzIGltcGxlbWVudGluZw0KICAgICAqIHBvb2xpbmcgY2FuIHJldHVy\nbiBhIG1hdGNoaW5nIG1hbmFnZXIgYmVmb3JlIGEgbmV3IHtAbGluayBTdG9y\nZU1hbmFnZXJ9DQogICAgICogaXMgY3JlYXRlZC4NCiAgICAgKi8NCiAgICBw\ncm90ZWN0ZWQgQnJva2VySW1wbCBmaW5kQnJva2VyKFN0cmluZyB1c2VyLCBT\ndHJpbmcgcGFzcywgYm9vbGVhbiBtYW5hZ2VkKSB7DQogICAgICAgIGlmICht\nYW5hZ2VkKQ0KICAgICAgICAgICAgcmV0dXJuIGZpbmRUcmFuc2FjdGlvbmFs\nQnJva2VyKHVzZXIsIHBhc3MpOw0KICAgICAgICByZXR1cm4gbnVsbDsNCiAg\nICB9DQoNCiAgICAvKioNCiAgICAgKiBSZXR1cm4gYSBicm9rZXIgY29uZmln\ndXJlZCB3aXRoIHRoZSBwcm9wZXIgc2V0dGluZ3MuDQogICAgICogQnkgZGVm\nYXVsdCwgdGhpcyBtZXRob2QgY29uc3RydWN0cyBhIG5ldw0KICAgICAqIEJy\nb2tlckltcGwgb2YgdGhlIGNsYXNzIHNldCBmb3IgdGhpcyBmYWN0b3J5Lg0K\nICAgICAqLw0KICAgIHByb3RlY3RlZCBCcm9rZXJJbXBsIG5ld0Jyb2tlcklt\ncGwoU3RyaW5nIHVzZXIsIFN0cmluZyBwYXNzKSB7DQogICAgICAgIEJyb2tl\nckltcGwgYnJva2VyID0gX2NvbmYubmV3QnJva2VySW5zdGFuY2UodXNlciwg\ncGFzcyk7DQogICAgICAgIGlmIChicm9rZXIgPT0gbnVsbCkNCiAgICAgICAg\nICAgIHRocm93IG5ldyBVc2VyRXhjZXB0aW9uKF9sb2MuZ2V0KCJuby1icm9r\nZXItY2xhc3MiLA0KICAgICAgICAgICAgICAgIF9jb25mLmdldEJyb2tlcklt\ncGwoKSkpOw0KDQogICAgICAgIHJldHVybiBicm9rZXI7DQogICAgfQ0KDQog\nICAgLyoqDQogICAgICogU2V0dXAgdHJhbnNpZW50IHN0YXRlIHVzZWQgYnkg\ndGhpcyBmYWN0b3J5IGJhc2VkIG9uIHRoZQ0KICAgICAqIGN1cnJlbnQgY29u\nZmlndXJhdGlvbiwgd2hpY2ggd2lsbCBzdWJzZXF1ZW50bHkgYmUgbG9ja2Vk\nIGRvd24uIFRoaXMNCiAgICAgKiBtZXRob2Qgd2lsbCBiZSBjYWxsZWQgYmVm\nb3JlIHRoZSBmaXJzdCBicm9rZXIgaXMgcmVxdWVzdGVkLA0KICAgICAqIGFu\nZCB3aWxsIGJlIHJlLWNhbGxlZCBlYWNoIHRpbWUgdGhlIGZhY3RvcnkgaXMg\nZGVzZXJpYWxpemVkIGludG8gYSBKVk0NCiAgICAgKiB0aGF0IGhhcyBubyBj\nb25maWd1cmF0aW9uIGZvciB0aGlzIGRhdGEgc3RvcmUuDQogICAgICovDQog\nICAgcHJvdGVjdGVkIHZvaWQgc2V0dXAoKSB7DQogICAgfQ0KDQogICAgLy8v\nLy8vLy8vLy8vLw0KICAgIC8vIFV0aWxpdGllcw0KICAgIC8vLy8vLy8vLy8v\nLy8NCg0KICAgIC8qKg0KICAgICAqIEZpbmQgYSBtYW5hZ2VkIHJ1bnRpbWUg\nYnJva2VyIGFzc29jaWF0ZWQgd2l0aCB0aGUNCiAgICAgKiBjdXJyZW50IHRy\nYW5zYWN0aW9uLCBvciByZXR1cm5zIG51bGwgaWYgbm9uZS4NCiAgICAgKi8N\nCiAgICBwcm90ZWN0ZWQgQnJva2VySW1wbCBmaW5kVHJhbnNhY3Rpb25hbEJy\nb2tlcihTdHJpbmcgdXNlciwgU3RyaW5nIHBhc3MpIHsNCiAgICAgICAgVHJh\nbnNhY3Rpb24gdHJhbnM7DQogICAgICAgIE1hbmFnZWRSdW50aW1lIG1yID0g\nX2NvbmYuZ2V0TWFuYWdlZFJ1bnRpbWVJbnN0YW5jZSgpOw0KICAgICAgICBP\nYmplY3QgdHhLZXk7DQogICAgICAgIHRyeSB7DQogICAgICAgICAgICB0cmFu\ncyA9IG1yLmdldFRyYW5zYWN0aW9uTWFuYWdlcigpLg0KICAgICAgICAgICAg\nICAgIGdldFRyYW5zYWN0aW9uKCk7DQogICAgICAgICAgICB0eEtleSA9IG1y\nLmdldFRyYW5zYWN0aW9uS2V5KCk7DQoNCiAgICAgICAgICAgIGlmICh0cmFu\ncyA9PSBudWxsDQogICAgICAgICAgICAgICAgfHwgdHJhbnMuZ2V0U3RhdHVz\nKCkgPT0gU3RhdHVzLlNUQVRVU19OT19UUkFOU0FDVElPTg0KICAgICAgICAg\nICAgICAgIHx8IHRyYW5zLmdldFN0YXR1cygpID09IFN0YXR1cy5TVEFUVVNf\nVU5LTk9XTikNCiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDsNCiAgICAg\nICAgfSBjYXRjaCAoT3BlbkpQQUV4Y2VwdGlvbiBrZSkgew0KICAgICAgICAg\nICAgdGhyb3cga2U7DQogICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7\nDQogICAgICAgICAgICB0aHJvdyBuZXcgR2VuZXJhbEV4Y2VwdGlvbihlKTsN\nCiAgICAgICAgfQ0KDQogICAgICAgIENvbGxlY3Rpb24gYnJva2VycyA9IChD\nb2xsZWN0aW9uKSBfdHJhbnNhY3Rpb25hbC5nZXQodHhLZXkpOw0KICAgICAg\nICBpZiAoYnJva2VycyAhPSBudWxsKSB7DQogICAgICAgICAgICAvLyB3ZSBk\nb24ndCBuZWVkIHRvIHN5bmNocm9uaXplIG9uIGJyb2tlcnMgc2luY2Ugb25l\nIEpUQSB0cmFuc2FjdGlvbg0KICAgICAgICAgICAgLy8gY2FuIG5ldmVyIGJl\nIGFjdGl2ZSBvbiBtdWx0aXBsZSBjb25jdXJyZW50IHRocmVhZHMuDQogICAg\nICAgICAgICBCcm9rZXJJbXBsIGJyb2tlcjsNCiAgICAgICAgICAgIGZvciAo\nSXRlcmF0b3IgaXRyID0gYnJva2Vycy5pdGVyYXRvcigpOyBpdHIuaGFzTmV4\ndCgpOykgew0KICAgICAgICAgICAgICAgIGJyb2tlciA9IChCcm9rZXJJbXBs\nKSBpdHIubmV4dCgpOw0KICAgICAgICAgICAgICAgIGlmIChTdHJpbmdVdGls\ncy5lcXVhbHMoYnJva2VyLmdldENvbm5lY3Rpb25Vc2VyTmFtZSgpLA0KICAg\nICAgICAgICAgICAgICAgICB1c2VyKSAmJiBTdHJpbmdVdGlscy5lcXVhbHMN\nCiAgICAgICAgICAgICAgICAgICAgKGJyb2tlci5nZXRDb25uZWN0aW9uUGFz\nc3dvcmQoKSwgcGFzcykpDQogICAgICAgICAgICAgICAgICAgIHJldHVybiBi\ncm9rZXI7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgcmV0\ndXJuIG51bGw7DQogICAgfQ0KDQogICAgLyoqDQogICAgICogQ29uZmlndXJl\ncyB0aGUgZ2l2ZW4gYnJva2VyIHdpdGggdGhlIGN1cnJlbnQgZmFjdG9yeSBv\ncHRpb24gc2V0dGluZ3MuDQogICAgICovDQogICAgcHJvdGVjdGVkIHZvaWQg\nY29uZmlndXJlQnJva2VyKEJyb2tlckltcGwgYnJva2VyKSB7DQogICAgICAg\nIGJyb2tlci5zZXRPcHRpbWlzdGljKF9jb25mLmdldE9wdGltaXN0aWMoKSk7\nDQogICAgICAgIGJyb2tlci5zZXROb250cmFuc2FjdGlvbmFsUmVhZChfY29u\nZi5nZXROb250cmFuc2FjdGlvbmFsUmVhZCgpKTsNCiAgICAgICAgYnJva2Vy\nLnNldE5vbnRyYW5zYWN0aW9uYWxXcml0ZShfY29uZi5nZXROb250cmFuc2Fj\ndGlvbmFsV3JpdGUoKSk7DQogICAgICAgIGJyb2tlci5zZXRSZXRhaW5TdGF0\nZShfY29uZi5nZXRSZXRhaW5TdGF0ZSgpKTsNCiAgICAgICAgYnJva2VyLnNl\ndFJlc3RvcmVTdGF0ZShfY29uZi5nZXRSZXN0b3JlU3RhdGVDb25zdGFudCgp\nKTsNCiAgICAgICAgYnJva2VyLnNldEF1dG9DbGVhcihfY29uZi5nZXRBdXRv\nQ2xlYXJDb25zdGFudCgpKTsNCiAgICAgICAgYnJva2VyLnNldElnbm9yZUNo\nYW5nZXMoX2NvbmYuZ2V0SWdub3JlQ2hhbmdlcygpKTsNCiAgICAgICAgYnJv\na2VyLnNldE11bHRpdGhyZWFkZWQoX2NvbmYuZ2V0TXVsdGl0aHJlYWRlZCgp\nKTsNCiAgICAgICAgYnJva2VyLnNldEF1dG9EZXRhY2goX2NvbmYuZ2V0QXV0\nb0RldGFjaENvbnN0YW50KCkpOw0KICAgICAgICBicm9rZXIuc2V0RGV0YWNo\nU3RhdGUoX2NvbmYuZ2V0RGV0YWNoU3RhdGVJbnN0YW5jZSgpLg0KICAgICAg\nICAgICAgZ2V0RGV0YWNoU3RhdGUoKSk7DQogICAgfQ0KDQogICAgLyoqDQog\nICAgICogRnJlZXplcyB0aGUgY29uZmlndXJhdGlvbiBvZiB0aGlzIGZhY3Rv\ncnkuDQogICAgICovDQogICAgcHVibGljIHZvaWQgbWFrZVJlYWRPbmx5KCkg\new0KICAgICAgICBpZiAoX3JlYWRPbmx5KQ0KICAgICAgICAgICAgcmV0dXJu\nOw0KDQogICAgICAgIGxvY2soKTsNCiAgICAgICAgdHJ5IHsNCiAgICAgICAg\nICAgIC8vIGNoZWNrIGFnYWluDQogICAgICAgICAgICBpZiAoX3JlYWRPbmx5\nKQ0KICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgIF9yZWFk\nT25seSA9IHRydWU7DQoNCiAgICAgICAgICAgIExvZyBsb2cgPSBfY29uZi5n\nZXRMb2coT3BlbkpQQUNvbmZpZ3VyYXRpb24uTE9HX1JVTlRJTUUpOw0KICAg\nICAgICAgICAgaWYgKGxvZy5pc0luZm9FbmFibGVkKCkpDQogICAgICAgICAg\nICAgICAgbG9nLmluZm8oZ2V0RmFjdG9yeUluaXRpYWxpemF0aW9uQmFubmVy\nKCkpOw0KICAgICAgICAgICAgaWYgKGxvZy5pc1RyYWNlRW5hYmxlZCgpKSB7\nDQogICAgICAgICAgICAgICAgTWFwIHByb3BzID0gX2NvbmYudG9Qcm9wZXJ0\naWVzKHRydWUpOw0KICAgICAgICAgICAgICAgIFN0cmluZyBsaW5lU2VwID0g\nSjJEb1ByaXZIZWxwZXIuZ2V0TGluZVNlcGFyYXRvcigpOw0KICAgICAgICAg\nICAgICAgIFN0cmluZ0J1ZmZlciBidWYgPSBuZXcgU3RyaW5nQnVmZmVyKCk7\nDQogICAgICAgICAgICAgICAgTWFwLkVudHJ5IGVudHJ5Ow0KICAgICAgICAg\nICAgICAgIGZvciAoSXRlcmF0b3IgaXRyID0gcHJvcHMuZW50cnlTZXQoKS5p\ndGVyYXRvcigpOw0KICAgICAgICAgICAgICAgICAgICBpdHIuaGFzTmV4dCgp\nOykgew0KICAgICAgICAgICAgICAgICAgICBlbnRyeSA9IChNYXAuRW50cnkp\nIGl0ci5uZXh0KCk7DQogICAgICAgICAgICAgICAgICAgIGJ1Zi5hcHBlbmQo\nZW50cnkuZ2V0S2V5KCkpLmFwcGVuZCgiOiAiKS4NCiAgICAgICAgICAgICAg\nICAgICAgICAgIGFwcGVuZChlbnRyeS5nZXRWYWx1ZSgpKTsNCiAgICAgICAg\nICAgICAgICAgICAgaWYgKGl0ci5oYXNOZXh0KCkpDQogICAgICAgICAgICAg\nICAgICAgICAgICBidWYuYXBwZW5kKGxpbmVTZXApOw0KICAgICAgICAgICAg\nICAgIH0NCiAgICAgICAgICAgICAgICBsb2cudHJhY2UoX2xvYy5nZXQoImZh\nY3RvcnktcHJvcGVydGllcyIsIGJ1Zi50b1N0cmluZygpKSk7DQogICAgICAg\nICAgICB9DQoNCiAgICAgICAgICAgIC8vIHNldHVwIHRyYW5zaWVudCBzdGF0\nZQ0KICAgICAgICAgICAgc2V0dXAoKTsNCg0KICAgICAgICAgICAgLy8gcmVn\naXN0ZXIgdGhlIG1ldGRhdGEgcmVwb3NpdG9yeSB0byBhdXRvLWxvYWQgcGVy\nc2lzdGVudCB0eXBlcw0KICAgICAgICAgICAgLy8gYW5kIG1ha2Ugc3VyZSB0\neXBlcyBhcmUgZW5oYW5jZWQNCiAgICAgICAgICAgIE1ldGFEYXRhUmVwb3Np\ndG9yeSByZXBvcyA9IF9jb25mLmdldE1ldGFEYXRhUmVwb3NpdG9yeUluc3Rh\nbmNlKCk7DQogICAgICAgICAgICByZXBvcy5zZXRWYWxpZGF0ZShyZXBvcy5W\nQUxJREFURV9SVU5USU1FLCB0cnVlKTsNCiAgICAgICAgICAgIHJlcG9zLnNl\ndFJlc29sdmUocmVwb3MuTU9ERV9NQVBQSU5HX0lOSVQsIHRydWUpOw0KICAg\nICAgICAgICAgUENSZWdpc3RyeS5hZGRSZWdpc3RlckNsYXNzTGlzdGVuZXIo\ncmVwb3MpOw0KDQogICAgICAgICAgICAvLyBmcmVlemUgdW5kZXJseWluZyBj\nb25maWd1cmF0aW9uIGFuZCBlYWdlcmx5IGluaXRpYWxpemUgdG8NCiAgICAg\nICAgICAgIC8vIGF2b2lkIHN5bmNocm9uaXphdGlvbg0KICAgICAgICAgICAg\nX2NvbmYuc2V0UmVhZE9ubHkoQ29uZmlndXJhdGlvbi5JTklUX1NUQVRFX0ZS\nRUVaSU5HKTsNCiAgICAgICAgICAgIF9jb25mLmluc3RhbnRpYXRlQWxsKCk7\nDQoNCiAgICAgICAgICAgIC8vIGZpcmUgYW4gZXZlbnQgZm9yIGFsbCB0aGUg\nYnJva2VyIGZhY3RvcnkgbGlzdGVuZXJzDQogICAgICAgICAgICAvLyByZWdp\nc3RlcmVkIG9uIHRoZSBjb25maWd1cmF0aW9uLg0KICAgICAgICAgICAgX2Nv\nbmYuZ2V0QnJva2VyRmFjdG9yeUV2ZW50TWFuYWdlcigpLmZpcmVFdmVudCgN\nCiAgICAgICAgICAgICAgICBuZXcgQnJva2VyRmFjdG9yeUV2ZW50KHRoaXMs\nDQogICAgICAgICAgICAgICAgICAgIEJyb2tlckZhY3RvcnlFdmVudC5CUk9L\nRVJfRkFDVE9SWV9DUkVBVEVEKSk7DQogICAgICAgIH0gZmluYWxseSB7DQog\nICAgICAgICAgICB1bmxvY2soKTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAg\nIC8qKg0KICAgICAqIFJldHVybiBhbiBvYmplY3QgdG8gYmUgd3JpdHRlbiB0\nbyB0aGUgbG9nIHdoZW4gdGhpcyBicm9rZXIgZmFjdG9yeQ0KICAgICAqIGlu\naXRpYWxpemVzLiBUaGlzIGhhcHBlbnMgYWZ0ZXIgdGhlIGNvbmZpZ3VyYXRp\nb24gaXMgZnVsbHkgbG9hZGVkLg0KICAgICAqLw0KICAgIHByb3RlY3RlZCBP\nYmplY3QgZ2V0RmFjdG9yeUluaXRpYWxpemF0aW9uQmFubmVyKCkgew0KICAg\nICAgICByZXR1cm4gX2xvYy5nZXQoImZhY3RvcnktaW5pdCIsIE9wZW5KUEFW\nZXJzaW9uLlZFUlNJT05fTlVNQkVSKTsNCiAgICB9DQoNCiAgICAvKioNCiAg\nICAgKiBUaHJvdyBhbiBleGNlcHRpb24gaWYgdGhlIGZhY3RvcnkgaXMgY2xv\nc2VkLiAgVGhlIGV4YWN0IG1lc3NhZ2UgYW5kDQogICAgICogY29udGVudCBv\nZiB0aGUgZXhjZXB0aW9uIHZhcmllcyB3aGV0aGVyIFRSQUNFIGlzIGVuYWJs\nZWQgb3Igbm90Lg0KICAgICAqLw0KICAgIHByaXZhdGUgdm9pZCBhc3NlcnRP\ncGVuKCkgew0KICAgICAgICBpZiAoX2Nsb3NlZCkgew0KICAgICAgICAgICAg\naWYgKF9jbG9zZWRFeGNlcHRpb24gPT0gbnVsbCkgIC8vIFRSQUNFIG5vdCBl\nbmFibGVkDQogICAgICAgICAgICAgICAgdGhyb3cgbmV3IEludmFsaWRTdGF0\nZUV4Y2VwdGlvbihfbG9jDQogICAgICAgICAgICAgICAgICAgICAgICAuZ2V0\nKCJjbG9zZWQtZmFjdG9yeS1ub3RyYWNlIikpOw0KICAgICAgICAgICAgZWxz\nZQ0KICAgICAgICAgICAgICAgIHRocm93IG5ldyBJbnZhbGlkU3RhdGVFeGNl\ncHRpb24oX2xvYy5nZXQoImNsb3NlZC1mYWN0b3J5IikpDQogICAgICAgICAg\nICAgICAgICAgICAgICAuc2V0Q2F1c2UoX2Nsb3NlZEV4Y2VwdGlvbik7DQog\nICAgICAgIH0NCiAgICB9DQoNCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLw0K\nICAgIC8vIEJyb2tlciB1dGlsaXRpZXMNCiAgICAvLy8vLy8vLy8vLy8vLy8v\nLy8vLw0KDQogICAgLyoqDQogICAgICogVGhyb3dzIGEge0BsaW5rIFVzZXJF\neGNlcHRpb259IGlmIGEgdHJhbnNhY3Rpb24gaXMgYWN0aXZlLiBUaGUgdGhy\nb3duDQogICAgICogZXhjZXB0aW9uIHdpbGwgY29udGFpbiBhbGwgdGhlIEJy\nb2tlcnMgd2l0aCBhY3RpdmUgdHJhbnNhY3Rpb25zIGFzDQogICAgICogZmFp\nbGVkIG9iamVjdHMgaW4gdGhlIG5lc3RlZCBleGNlcHRpb25zLg0KICAgICAq\nLw0KICAgIHByaXZhdGUgdm9pZCBhc3NlcnROb0FjdGl2ZVRyYW5zYWN0aW9u\nKCkgew0KICAgICAgICBDb2xsZWN0aW9uIGV4Y3M7DQogICAgICAgIGlmIChf\ndHJhbnNhY3Rpb25hbC5pc0VtcHR5KCkpDQogICAgICAgICAgICByZXR1cm47\nDQoNCiAgICAgICAgZXhjcyA9IG5ldyBBcnJheUxpc3QoX3RyYW5zYWN0aW9u\nYWwuc2l6ZSgpKTsNCiAgICAgICAgZm9yIChJdGVyYXRvciB0cmFucyA9IF90\ncmFuc2FjdGlvbmFsLnZhbHVlcygpLml0ZXJhdG9yKCk7DQogICAgICAgICAg\nICB0cmFucy5oYXNOZXh0KCk7KSB7DQogICAgICAgICAgICBDb2xsZWN0aW9u\nIGJyb2tlcnMgPSAoQ29sbGVjdGlvbikgdHJhbnMubmV4dCgpOw0KICAgICAg\nICAgICAgZm9yIChJdGVyYXRvciBpdHIgPSBicm9rZXJzLml0ZXJhdG9yKCk7\nIGl0ci5oYXNOZXh0KCk7KSB7DQogICAgICAgICAgICAgICAgZXhjcy5hZGQo\nbmV3IEludmFsaWRTdGF0ZUV4Y2VwdGlvbihfbG9jLmdldCgiYWN0aXZlIikp\nLg0KICAgICAgICAgICAgICAgICAgICBzZXRGYWlsZWRPYmplY3QoaXRyLm5l\neHQoKSkpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAg\naWYgKCFleGNzLmlzRW1wdHkoKSkNCiAgICAgICAgICAgIHRocm93IG5ldyBJ\nbnZhbGlkU3RhdGVFeGNlcHRpb24oX2xvYy5nZXQoIm5lc3RlZC1leGNlcHMi\nKSkuDQogICAgICAgICAgICAgICAgc2V0TmVzdGVkVGhyb3dhYmxlcygoVGhy\nb3dhYmxlW10pIGV4Y3MudG9BcnJheQ0KICAgICAgICAgICAgICAgICAgICAo\nbmV3IFRocm93YWJsZVtleGNzLnNpemUoKV0pKTsNCiAgICB9DQoNCiAgICAv\nKioNCiAgICAgKiBTeW5jaHJvbml6ZSB0aGUgZ2l2ZW4gYnJva2VyIHdpdGgg\nYSBtYW5hZ2VkIHRyYW5zYWN0aW9uLA0KICAgICAqIG9wdGlvbmFsbHkgc3Rh\ncnRpbmcgb25lIGlmIG5vbmUgaXMgaW4gcHJvZ3Jlc3MuDQogICAgICoNCiAg\nICAgKiBAcmV0dXJuIHRydWUgaWYgc3luY2hlZCB3aXRoIHRyYW5zYWN0aW9u\nLCBmYWxzZSBvdGhlcndpc2UNCiAgICAgKi8NCiAgICBib29sZWFuIHN5bmNX\naXRoTWFuYWdlZFRyYW5zYWN0aW9uKEJyb2tlckltcGwgYnJva2VyLCBib29s\nZWFuIGJlZ2luKSB7DQogICAgICAgIFRyYW5zYWN0aW9uIHRyYW5zOw0KICAg\nICAgICB0cnkgew0KICAgICAgICAgICAgTWFuYWdlZFJ1bnRpbWUgbXIgPSBi\ncm9rZXIuZ2V0TWFuYWdlZFJ1bnRpbWUoKTsNCiAgICAgICAgICAgIFRyYW5z\nYWN0aW9uTWFuYWdlciB0bSA9IG1yLmdldFRyYW5zYWN0aW9uTWFuYWdlcigp\nOw0KICAgICAgICAgICAgdHJhbnMgPSB0bS5nZXRUcmFuc2FjdGlvbigpOw0K\nICAgICAgICAgICAgaWYgKHRyYW5zICE9IG51bGwNCiAgICAgICAgICAgICAg\nICAmJiAodHJhbnMuZ2V0U3RhdHVzKCkgPT0gU3RhdHVzLlNUQVRVU19OT19U\nUkFOU0FDVElPTg0KICAgICAgICAgICAgICAgIHx8IHRyYW5zLmdldFN0YXR1\ncygpID09IFN0YXR1cy5TVEFUVVNfVU5LTk9XTikpDQogICAgICAgICAgICAg\nICAgdHJhbnMgPSBudWxsOw0KDQogICAgICAgICAgICBpZiAodHJhbnMgPT0g\nbnVsbCAmJiBiZWdpbikgew0KICAgICAgICAgICAgICAgIHRtLmJlZ2luKCk7\nDQogICAgICAgICAgICAgICAgdHJhbnMgPSB0bS5nZXRUcmFuc2FjdGlvbigp\nOw0KICAgICAgICAgICAgfSBlbHNlIGlmICh0cmFucyA9PSBudWxsKQ0KICAg\nICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCg0KICAgICAgICAgICAgLy8g\nc3luY2ggYnJva2VyIGFuZCB0cmFucw0KICAgICAgICAgICAgdHJhbnMucmVn\naXN0ZXJTeW5jaHJvbml6YXRpb24oYnJva2VyKTsNCg0KICAgICAgICAgICAg\nLy8gd2UgZG9uJ3QgbmVlZCB0byBzeW5jaHJvbml6ZSBvbiBicm9rZXJzIG9y\nIGd1YXJkIGFnYWluc3QgbXVsdGlwbGUNCiAgICAgICAgICAgIC8vIHRocmVh\nZHMgdXNpbmcgdGhlIHNhbWUgdHJhbnMgc2luY2Ugb25lIEpUQSB0cmFuc2Fj\ndGlvbiBjYW4gbmV2ZXINCiAgICAgICAgICAgIC8vIGJlIGFjdGl2ZSBvbiBt\ndWx0aXBsZSBjb25jdXJyZW50IHRocmVhZHMuDQogICAgICAgICAgICBPYmpl\nY3QgdHhLZXkgPSBtci5nZXRUcmFuc2FjdGlvbktleSgpOw0KICAgICAgICAg\nICAgQ29sbGVjdGlvbiBicm9rZXJzID0gKENvbGxlY3Rpb24pIF90cmFuc2Fj\ndGlvbmFsLmdldCh0eEtleSk7DQogICAgICAgICAgICANCiAgICAgICAgICAg\nIGlmIChicm9rZXJzID09IG51bGwpIHsNCiAgICAgICAgICAgICAgICBicm9r\nZXJzID0gbmV3IEFycmF5TGlzdCgyKTsNCiAgICAgICAgICAgICAgICBfdHJh\nbnNhY3Rpb25hbC5wdXQodHhLZXksIGJyb2tlcnMpOw0KICAgICAgICAgICAg\nICAgIHRyYW5zLnJlZ2lzdGVyU3luY2hyb25pemF0aW9uKG5ldyBSZW1vdmVU\ncmFuc2FjdGlvblN5bmModHhLZXkpKTsNCiAgICAgICAgICAgIH0NCiAgICAg\nICAgICAgIGJyb2tlcnMuYWRkKGJyb2tlcik7DQogICAgICAgICAgICANCiAg\nICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICB9IGNhdGNoIChPcGVu\nSlBBRXhjZXB0aW9uIGtlKSB7DQogICAgICAgICAgICB0aHJvdyBrZTsNCiAg\nICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsNCiAgICAgICAgICAgIHRo\ncm93IG5ldyBHZW5lcmFsRXhjZXB0aW9uKGUpOw0KICAgICAgICB9DQogICAg\nfQ0KDQogICAgLyoqDQogICAgICogUmV0dXJucyBhIHNldCBvZiBhbGwgdGhl\nIG9wZW4gYnJva2VycyBhc3NvY2lhdGVkIHdpdGggdGhpcyBmYWN0b3J5LiBU\naGUNCiAgICAgKiByZXR1cm5lZCBzZXQgaXMgdW5tb2RpZmlhYmxlLCBhbmQg\nbWF5IGNvbnRhaW4gbnVsbCByZWZlcmVuY2VzLg0KICAgICAqLw0KICAgIHB1\nYmxpYyBDb2xsZWN0aW9uIGdldE9wZW5Ccm9rZXJzKCkgew0KICAgICAgICBy\nZXR1cm4gQ29sbGVjdGlvbnMudW5tb2RpZmlhYmxlQ29sbGVjdGlvbihfYnJv\na2Vycyk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICogUmVsZWFzZSA8Y29k\nZT5icm9rZXI8L2NvZGU+IGZyb20gYW55IGludGVybmFsIGRhdGEgc3RydWN0\ndXJlcy4gVGhpcw0KICAgICAqIGlzIGludm9rZWQgYnkgPGNvZGU+YnJva2Vy\nPC9jb2RlPiBhZnRlciB0aGUgYnJva2VyIGlzIGZ1bGx5IGNsb3NlZC4NCiAg\nICAgKg0KICAgICAqIEBzaW5jZSAxLjEuMA0KICAgICAqLw0KICAgIHByb3Rl\nY3RlZCB2b2lkIHJlbGVhc2VCcm9rZXIoQnJva2VySW1wbCBicm9rZXIpIHsN\nCiAgICAgICAgX2Jyb2tlcnMucmVtb3ZlKGJyb2tlcik7DQogICAgfQ0KDQog\nICAgLyoqDQogICAgICogQHJldHVybiBhIGtleSB0aGF0IGNhbiBiZSB1c2Vk\nIHRvIG9idGFpbiB0aGlzIGJyb2tlciBmYWN0b3J5IGZyb20gdGhlDQogICAg\nICogcG9vbCBhdCBhIGxhdGVyIHRpbWUuDQogICAgICoNCiAgICAgKiBAc2lu\nY2UgMS4xLjANCiAgICAgKi8NCiAgICBwdWJsaWMgT2JqZWN0IGdldFBvb2xL\nZXkoKSB7DQogICAgICAgIHJldHVybiBfcG9vbEtleTsNCiAgICB9DQoNCiAg\nICAvKioNCiAgICAgKiBTZXQgYSBrZXkgdGhhdCBjYW4gYmUgdXNlZCB0byBv\nYnRhaW4gdGhpcyBicm9rZXIgZmFjdG9yeSBmcm9tIHRoZQ0KICAgICAqIHBv\nb2wgYXQgYSBsYXRlciB0aW1lLg0KICAgICAqDQogICAgICogQHNpbmNlIDEu\nMS4wDQogICAgICovDQogICAgdm9pZCBzZXRQb29sS2V5KE9iamVjdCBrZXkp\nIHsNCiAgICAgICAgX3Bvb2xLZXkgPSBrZXk7DQogICAgfQ0KDQogICAgLyoq\nDQogICAgICogU2ltcGxlIHN5bmNocm9uaXphdGlvbiBsaXN0ZW5lciB0byBy\nZW1vdmUgY29tcGxldGVkIHRyYW5zYWN0aW9ucw0KICAgICAqIGZyb20gb3Vy\nIGNhY2hlLg0KICAgICAqLw0KICAgIHByaXZhdGUgY2xhc3MgUmVtb3ZlVHJh\nbnNhY3Rpb25TeW5jDQogICAgICAgIGltcGxlbWVudHMgU3luY2hyb25pemF0\naW9uIHsNCg0KICAgICAgICBwcml2YXRlIGZpbmFsIE9iamVjdCBfdHJhbnM7\nDQoNCiAgICAgICAgcHVibGljIFJlbW92ZVRyYW5zYWN0aW9uU3luYyhPYmpl\nY3QgdHJhbnMpIHsNCiAgICAgICAgICAgIF90cmFucyA9IHRyYW5zOw0KICAg\nICAgICB9DQoNCiAgICAgICAgcHVibGljIHZvaWQgYmVmb3JlQ29tcGxldGlv\nbigpIHsNCiAgICAgICAgfQ0KDQogICAgICAgIHB1YmxpYyB2b2lkIGFmdGVy\nQ29tcGxldGlvbihpbnQgc3RhdHVzKSB7DQogICAgICAgICAgICBfdHJhbnNh\nY3Rpb25hbC5yZW1vdmUgKF90cmFucyk7DQoJCX0NCgl9DQogICAgDQogICAg\nLyoqDQogICAgICogTWV0aG9kIGluc3VyZXMgdGhhdCBkZXNlcmlhbGl6ZWQg\nRU1GIGhhcyB0aGlzIHJlZmVyZW5jZSByZS1pbnN0YW50aWF0ZWQNCiAgICAg\nKi8NCiAgICBwcml2YXRlIENvbGxlY3Rpb24gZ2V0UGNDbGFzc0xvYWRlcnMo\nKSB7DQogICAgICAgaWYgKF9wY0NsYXNzTG9hZGVycyA9PSBudWxsKQ0KICAg\nICAgICAgX3BjQ2xhc3NMb2FkZXJzID0gbmV3IENvbmN1cnJlbnRSZWZlcmVu\nY2VIYXNoU2V0KA0KICAgICAgICAgICAgIENvbmN1cnJlbnRSZWZlcmVuY2VI\nYXNoU2V0LldFQUspOw0KICAgICAgICAgIA0KICAgICAgIHJldHVybiBfcGND\nbGFzc0xvYWRlcnM7DQogICAgfQ0KfQ0K\n","encoding":"base64"}

