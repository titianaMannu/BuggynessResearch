{"sha":"a1e7b873c17cedb6d1352fc219e4ee43f9f81cbd","node_id":"MDQ6QmxvYjIwNjM2NDphMWU3Yjg3M2MxN2NlZGI2ZDEzNTJmYzIxOWU0ZWU0M2Y5ZjgxY2Jk","size":11082,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/a1e7b873c17cedb6d1352fc219e4ee43f9f81cbd","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsOwoKaW1wb3J0IGph\ndmEudXRpbC5Db2xsZWN0aW9uOwppbXBvcnQgamF2YS51dGlsLkNvbGxlY3Rp\nb25zOwppbXBvcnQgamF2YS51dGlsLkl0ZXJhdG9yOwppbXBvcnQgamF2YS51\ndGlsLkxpbmtlZExpc3Q7CmltcG9ydCBqYXZhLnV0aWwuTGlzdDsKaW1wb3J0\nIGphdmEudXRpbC5NYXA7CmltcG9ydCBqYXZhLnV0aWwuU2V0OwoKaW1wb3J0\nIG9yZy5hcGFjaGUuY29tbW9ucy5jb2xsZWN0aW9ucy5tYXAuSWRlbnRpdHlN\nYXA7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuZW5oYW5jZS5QZXJzaXN0\nZW5jZUNhcGFibGU7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuZXZlbnQu\nQ2FsbGJhY2tNb2RlczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5ldmVu\ndC5MaWZlY3ljbGVFdmVudDsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5s\naWIudXRpbC5Mb2NhbGl6ZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\nbWV0YS5DbGFzc01ldGFEYXRhOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLm1ldGEuVmFsdWVNZXRhRGF0YTsKaW1wb3J0IG9yZy5hcGFjaGUub3Blbmpw\nYS51dGlsLkNhbGxiYWNrRXhjZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLnV0aWwuRXhjZXB0aW9uczsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS51dGlsLk9wZW5KUEFFeGNlcHRpb247CmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEudXRpbC5PcHRpbWlzdGljRXhjZXB0aW9uOwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLnV0aWwuUHJveHlNYW5hZ2VyOwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLnV0aWwuVXNlckV4Y2VwdGlvbjsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS51dGlsLkltcGxIZWxwZXI7CgovKioKICogSGFu\nZGxlcyBhdHRhY2hpbmcgaW5zdGFuY2VzLgogKgogKiBAYXV0aG9yIE1hcmMg\nUHJ1ZCdob21tZWF1eAogKi8KY2xhc3MgQXR0YWNoTWFuYWdlciB7CgogICAg\ncHJpdmF0ZSBzdGF0aWMgZmluYWwgTG9jYWxpemVyIF9sb2MgPSBMb2NhbGl6\nZXIuZm9yUGFja2FnZQogICAgICAgIChBdHRhY2hNYW5hZ2VyLmNsYXNzKTsK\nCiAgICBwcml2YXRlIGZpbmFsIEJyb2tlckltcGwgX2Jyb2tlcjsKICAgIHBy\naXZhdGUgZmluYWwgUHJveHlNYW5hZ2VyIF9wcm94eTsKICAgIHByaXZhdGUg\nZmluYWwgT3BDYWxsYmFja3MgX2NhbGw7CiAgICBwcml2YXRlIGZpbmFsIGJv\nb2xlYW4gX2NvcHlOZXc7CiAgICBwcml2YXRlIGZpbmFsIGJvb2xlYW4gX2Zh\naWxGYXN0OwogICAgcHJpdmF0ZSBmaW5hbCBJZGVudGl0eU1hcCBfYXR0YWNo\nZWQgPSBuZXcgSWRlbnRpdHlNYXAoKTsKCiAgICAvLyByZXVzYWJsZSBzdHJh\ndGVnaWVzCiAgICBwcml2YXRlIEF0dGFjaFN0cmF0ZWd5IF92ZXJzaW9uID0g\nbnVsbDsKICAgIHByaXZhdGUgQXR0YWNoU3RyYXRlZ3kgX2RldGFjaCA9IG51\nbGw7CgogICAgLyoqCiAgICAgKiBDb25zdHJ1Y3Rvci4gU3VwcGx5IGJyb2tl\nciBhdHRhY2hpbmcgdG8uCiAgICAgKi8KICAgIHB1YmxpYyBBdHRhY2hNYW5h\nZ2VyKEJyb2tlckltcGwgYnJva2VyLCBib29sZWFuIGNvcHlOZXcsIE9wQ2Fs\nbGJhY2tzIGNhbGwpIHsKICAgICAgICBfYnJva2VyID0gYnJva2VyOwogICAg\nICAgIF9wcm94eSA9IGJyb2tlci5nZXRDb25maWd1cmF0aW9uKCkuZ2V0UHJv\neHlNYW5hZ2VySW5zdGFuY2UoKTsKICAgICAgICBfY2FsbCA9IGNhbGw7CiAg\nICAgICAgX2NvcHlOZXcgPSBjb3B5TmV3OwogICAgICAgIF9mYWlsRmFzdCA9\nIChicm9rZXIuZ2V0Q29uZmlndXJhdGlvbigpLmdldE1ldGFEYXRhUmVwb3Np\ndG9yeUluc3RhbmNlKCkuCiAgICAgICAgICAgIGdldE1ldGFEYXRhRmFjdG9y\neSgpLmdldERlZmF1bHRzKCkuZ2V0Q2FsbGJhY2tNb2RlKCkKICAgICAgICAg\nICAgJiBDYWxsYmFja01vZGVzLkNBTExCQUNLX0ZBSUxfRkFTVCkgIT0gMDsK\nICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgYmVoYXZpb3Igc3Vw\ncGxpZWQgb24gY29uc3RydWN0aW9uLgogICAgICovCiAgICBwdWJsaWMgT3BD\nYWxsYmFja3MgZ2V0QmVoYXZpb3IoKSB7CiAgICAgICAgcmV0dXJuIF9jYWxs\nOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHdoZXRoZXIgdG8gY29w\neSBuZXcgaW5zdGFuY2VzIGJlaW5nIHBlcnNpc3RlZC4KICAgICAqLwogICAg\ncHVibGljIGJvb2xlYW4gZ2V0Q29weU5ldygpIHsKICAgICAgICByZXR1cm4g\nX2NvcHlOZXc7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gYW4gYXR0\nYWNoZWQgdmVyc2lvbiBvZiB0aGUgZ2l2ZW4gaW5zdGFuY2UuCiAgICAgKi8K\nICAgIHB1YmxpYyBPYmplY3QgYXR0YWNoKE9iamVjdCBwYykgewogICAgICAg\nIGlmIChwYyA9PSBudWxsKQogICAgICAgICAgICByZXR1cm4gbnVsbDsKCiAg\nICAgICAgQ2FsbGJhY2tFeGNlcHRpb24gZXhjZXAgPSBudWxsOwogICAgICAg\nIHRyeSB7CiAgICAgICAgICAgIHJldHVybiBhdHRhY2gocGMsIG51bGwsIG51\nbGwsIG51bGwsIHRydWUpOwogICAgICAgIH0gY2F0Y2ggKENhbGxiYWNrRXhj\nZXB0aW9uIGNlKSB7CiAgICAgICAgICAgIGV4Y2VwID0gY2U7CiAgICAgICAg\nICAgIHJldHVybiBudWxsOyAvLyB3b24ndCBiZSByZWFjaGVkIGFzIHRoZSBl\neGNlcHMgd2lsbCBiZSByZXRocm93bgogICAgICAgIH0gZmluYWxseSB7CiAg\nICAgICAgICAgIExpc3QgZXhjZXBzID0gbnVsbDsKICAgICAgICAgICAgaWYg\nKGV4Y2VwID09IG51bGwgfHwgIV9mYWlsRmFzdCkKICAgICAgICAgICAgICAg\nIGV4Y2VwcyA9IGludm9rZUFmdGVyQXR0YWNoKG51bGwpOwogICAgICAgICAg\nICBlbHNlCiAgICAgICAgICAgICAgICBleGNlcHMgPSBDb2xsZWN0aW9ucy5z\naW5nbGV0b25MaXN0KGV4Y2VwKTsKICAgICAgICAgICAgX2F0dGFjaGVkLmNs\nZWFyKCk7CiAgICAgICAgICAgIHRocm93RXhjZXB0aW9ucyhleGNlcHMsIG51\nbGwsIGZhbHNlKTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBS\nZXR1cm4gYXR0YWNoZWQgdmVyc2lvbnMgb2YgdGhlIGdpdmVuIGluc3RhbmNl\ncy4KICAgICAqLwogICAgcHVibGljIE9iamVjdFtdIGF0dGFjaEFsbChDb2xs\nZWN0aW9uIGluc3RhbmNlcykgewogICAgICAgIE9iamVjdFtdIGF0dGFjaGVk\nID0gbmV3IE9iamVjdFtpbnN0YW5jZXMuc2l6ZSgpXTsKICAgICAgICBMaXN0\nIGV4Y2VwcyA9IG51bGw7CiAgICAgICAgTGlzdCBmYWlsZWQgPSBudWxsOwog\nICAgICAgIGJvb2xlYW4gb3B0ID0gdHJ1ZTsKICAgICAgICBib29sZWFuIGZh\naWxGYXN0ID0gZmFsc2U7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgaW50\nIGkgPSAwOwogICAgICAgICAgICBmb3IgKEl0ZXJhdG9yIGl0ciA9IGluc3Rh\nbmNlcy5pdGVyYXRvcigpOyBpdHIuaGFzTmV4dCgpOyBpKyspIHsKICAgICAg\nICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgYXR0YWNoZWRb\naV0gPSBhdHRhY2goaXRyLm5leHQoKSwgbnVsbCwgbnVsbCwgbnVsbCwgdHJ1\nZSk7CiAgICAgICAgICAgICAgICB9IGNhdGNoIChPcGVuSlBBRXhjZXB0aW9u\nIGtlKSB7CiAgICAgICAgICAgICAgICAgICAgLy8gdHJhY2sgZXhjZXB0aW9u\ncyBhbmQgb3B0aW1pc3RpYyBmYWlsZWQgb2JqZWN0cwogICAgICAgICAgICAg\nICAgICAgIGlmIChvcHQgJiYgIShrZSBpbnN0YW5jZW9mIE9wdGltaXN0aWNF\neGNlcHRpb24pKQogICAgICAgICAgICAgICAgICAgICAgICBvcHQgPSBmYWxz\nZTsKICAgICAgICAgICAgICAgICAgICBpZiAob3B0ICYmIGtlLmdldEZhaWxl\nZE9iamVjdCgpICE9IG51bGwpCiAgICAgICAgICAgICAgICAgICAgICAgIGZh\naWxlZCA9IGFkZChmYWlsZWQsIGtlLmdldEZhaWxlZE9iamVjdCgpKTsKICAg\nICAgICAgICAgICAgICAgICBleGNlcHMgPSBhZGQoZXhjZXBzLCBrZSk7Cgog\nICAgICAgICAgICAgICAgICAgIGlmIChrZSBpbnN0YW5jZW9mIENhbGxiYWNr\nRXhjZXB0aW9uICYmIF9mYWlsRmFzdCkgewogICAgICAgICAgICAgICAgICAg\nICAgICBmYWlsRmFzdCA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgICAg\nIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAg\nIH0KICAgICAgICAgICAgICAgIGNhdGNoIChSdW50aW1lRXhjZXB0aW9uIHJl\nKSB7CiAgICAgICAgICAgICAgICAgICAgZXhjZXBzID0gYWRkKGV4Y2Vwcywg\ncmUpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAg\nfSBmaW5hbGx5IHsKICAgICAgICAgICAgLy8gaW52b2tlIHBvc3QgY2FsbGJh\nY2tzIHVubGVzcyBhbGwgZmFpbGVkCiAgICAgICAgICAgIGlmICghZmFpbEZh\nc3QgJiYgKGV4Y2VwcyA9PSBudWxsCiAgICAgICAgICAgICAgICB8fCBleGNl\ncHMuc2l6ZSgpIDwgaW5zdGFuY2VzLnNpemUoKSkpCiAgICAgICAgICAgICAg\nICBleGNlcHMgPSBpbnZva2VBZnRlckF0dGFjaChleGNlcHMpOwogICAgICAg\nICAgICBfYXR0YWNoZWQuY2xlYXIoKTsKICAgICAgICB9CiAgICAgICAgdGhy\nb3dFeGNlcHRpb25zKGV4Y2VwcywgZmFpbGVkLCBvcHQpOwogICAgICAgIHJl\ndHVybiBhdHRhY2hlZDsKICAgIH0KCiAgICAvKioKICAgICAqIEludm9rZSBw\nb3N0QXR0YWNoKCkgb24gYW55IGF0dGFjaGVkIGluc3RhbmNlcyB0aGF0IGlt\ncGxlbWVudAogICAgICogUG9zdEF0dGFjaENhbGxiYWNrLiBUaGlzIHdpbGwg\nYmUgZG9uZSBhZnRlciB0aGUgZW50aXJlIGdyYXBoIGhhcwogICAgICogYmVl\nbiBhdHRhY2hlZC4KICAgICAqLwogICAgcHJpdmF0ZSBMaXN0IGludm9rZUFm\ndGVyQXR0YWNoKExpc3QgZXhjZXBzKSB7CiAgICAgICAgU2V0IGVudHJpZXMg\nPSBfYXR0YWNoZWQuZW50cnlTZXQoKTsKICAgICAgICBmb3IgKEl0ZXJhdG9y\nIGkgPSBlbnRyaWVzLml0ZXJhdG9yKCk7IGkuaGFzTmV4dCgpOykgewogICAg\nICAgICAgICBNYXAuRW50cnkgZW50cnkgPSAoTWFwLkVudHJ5KSBpLm5leHQo\nKTsKICAgICAgICAgICAgT2JqZWN0IGF0dGFjaGVkID0gZW50cnkuZ2V0VmFs\ndWUoKTsKICAgICAgICAgICAgU3RhdGVNYW5hZ2VySW1wbCBzbSA9IF9icm9r\nZXIuZ2V0U3RhdGVNYW5hZ2VySW1wbChhdHRhY2hlZCwgdHJ1ZSk7CiAgICAg\nICAgICAgIGlmIChzbS5pc05ldygpKQogICAgICAgICAgICAgICAgY29udGlu\ndWU7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBfYnJva2Vy\nLmZpcmVMaWZlY3ljbGVFdmVudChhdHRhY2hlZCwgZW50cnkuZ2V0S2V5KCks\nCiAgICAgICAgICAgICAgICAgICAgc20uZ2V0TWV0YURhdGEoKSwgTGlmZWN5\nY2xlRXZlbnQuQUZURVJfQVRUQUNIKTsKICAgICAgICAgICAgfSBjYXRjaCAo\nUnVudGltZUV4Y2VwdGlvbiByZSkgewogICAgICAgICAgICAgICAgZXhjZXBz\nID0gYWRkKGV4Y2VwcywgcmUpOwogICAgICAgICAgICAgICAgaWYgKF9mYWls\nRmFzdCAmJiByZSBpbnN0YW5jZW9mIENhbGxiYWNrRXhjZXB0aW9uKQogICAg\nICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAg\nfQogICAgICAgIHJldHVybiBleGNlcHM7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBBZGQgYW4gb2JqZWN0IHRvIHRoZSBsaXN0LgogICAgICovCiAgICBwcml2\nYXRlIExpc3QgYWRkKExpc3QgbGlzdCwgT2JqZWN0IG9iaikgewogICAgICAg\nIGlmIChsaXN0ID09IG51bGwpCiAgICAgICAgICAgIGxpc3QgPSBuZXcgTGlu\na2VkTGlzdCgpOwogICAgICAgIGxpc3QuYWRkKG9iaik7CiAgICAgICAgcmV0\ndXJuIGxpc3Q7CiAgICB9CgogICAgLyoqCiAgICAgKiBUaHJvdyBleGNlcHRp\nb24gZm9yIGZhaWx1cmVzLgogICAgICovCiAgICBwcml2YXRlIHZvaWQgdGhy\nb3dFeGNlcHRpb25zKExpc3QgZXhjZXBzLCBMaXN0IGZhaWxlZCwgYm9vbGVh\nbiBvcHQpIHsKICAgICAgICBpZiAoZXhjZXBzID09IG51bGwpCiAgICAgICAg\nICAgIHJldHVybjsKICAgICAgICBpZiAoZXhjZXBzLnNpemUoKSA9PSAxKQog\nICAgICAgICAgICB0aHJvdyAoUnVudGltZUV4Y2VwdGlvbikgZXhjZXBzLmdl\ndCgwKTsKCiAgICAgICAgVGhyb3dhYmxlW10gdCA9IChUaHJvd2FibGVbXSkg\nZXhjZXBzLnRvQXJyYXkKICAgICAgICAgICAgKG5ldyBUaHJvd2FibGVbZXhj\nZXBzLnNpemUoKV0pOwogICAgICAgIGlmIChvcHQgJiYgZmFpbGVkICE9IG51\nbGwpCiAgICAgICAgICAgIHRocm93IG5ldyBPcHRpbWlzdGljRXhjZXB0aW9u\nKGZhaWxlZCwgdCk7CiAgICAgICAgaWYgKG9wdCkKICAgICAgICAgICAgdGhy\nb3cgbmV3IE9wdGltaXN0aWNFeGNlcHRpb24odCk7CiAgICAgICAgdGhyb3cg\nbmV3IFVzZXJFeGNlcHRpb24oX2xvYy5nZXQoIm5lc3RlZC1leGNlcHMiKSku\nCiAgICAgICAgICAgIHNldE5lc3RlZFRocm93YWJsZXModCk7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBBdHRhY2guCiAgICAgKgogICAgICogQHBhcmFtIHRv\nQXR0YWNoIHRoZSBkZXRhY2hlZCBvYmplY3QKICAgICAqIEBwYXJhbSBpbnRv\nIHRoZSBpbnN0YW5jZSB3ZSdyZSBhdHRhY2hpbmcgaW50bwogICAgICogQHBh\ncmFtIG93bmVyIHN0YXRlIG1hbmFnZXIgZm9yIDxjb2RlPmludG88L2NvZGU+\nCiAgICAgKiBAcGFyYW0gb3duZXJNZXRhIHRoZSBmaWVsZCB3ZSB0cmF2ZXJz\nZWQgdG8gZmluZCA8Y29kZT50b0F0dGFjaDwvY29kZT4KICAgICAqIEBwYXJh\nbSBleHBsaWNpdCB3aGV0aGVyIHRvIG1ha2UgbmV3IGluc3RhbmNlcyBleHBs\naWNpdGx5IHBlcnNpc3RlbnQKICAgICAqLwogICAgT2JqZWN0IGF0dGFjaChP\nYmplY3QgdG9BdHRhY2gsIFBlcnNpc3RlbmNlQ2FwYWJsZSBpbnRvLAogICAg\nICAgIE9wZW5KUEFTdGF0ZU1hbmFnZXIgb3duZXIsIFZhbHVlTWV0YURhdGEg\nb3duZXJNZXRhLCBib29sZWFuIGV4cGxpY2l0KSB7CiAgICAgICAgaWYgKHRv\nQXR0YWNoID09IG51bGwpCiAgICAgICAgICAgIHJldHVybiBudWxsOwoKICAg\nICAgICAvLyBjaGVjayBpZiBhbHJlYWR5IGF0dGFjaGVkCiAgICAgICAgT2Jq\nZWN0IGF0dGFjaGVkID0gX2F0dGFjaGVkLmdldCh0b0F0dGFjaCk7CiAgICAg\nICAgaWYgKGF0dGFjaGVkICE9IG51bGwpCiAgICAgICAgICAgIHJldHVybiBh\ndHRhY2hlZDsKCiAgICAgICAgLy8jIyMgbmVlZCB0byBoYW5kbGUgQUNUX0NB\nU0NBREUKICAgICAgICBpbnQgYWN0aW9uID0gcHJvY2Vzc0FyZ3VtZW50KHRv\nQXR0YWNoKTsKICAgICAgICBpZiAoKGFjdGlvbiAmIE9wQ2FsbGJhY2tzLkFD\nVF9SVU4pID09IDApCiAgICAgICAgICAgIHJldHVybiB0b0F0dGFjaDsKCiAg\nICAgICAgLy8jIyMgbmVlZCB0byBoYW5kbGUgQUNUX1JVTiB3aXRob3V0IGFs\nc28gQUNUX0NBU0NBREUKICAgICAgICBDbGFzc01ldGFEYXRhIG1ldGEgPSBf\nYnJva2VyLmdldENvbmZpZ3VyYXRpb24oKS4KICAgICAgICAgICAgZ2V0TWV0\nYURhdGFSZXBvc2l0b3J5SW5zdGFuY2UoKS5nZXRNZXRhRGF0YSgKICAgICAg\nICAgICAgICAgIEltcGxIZWxwZXIuZ2V0TWFuYWdlZEluc3RhbmNlKHRvQXR0\nYWNoKS5nZXRDbGFzcygpLAogICAgICAgICAgICAgICAgX2Jyb2tlci5nZXRD\nbGFzc0xvYWRlcigpLCB0cnVlKTsKICAgICAgICByZXR1cm4gZ2V0U3RyYXRl\nZ3kodG9BdHRhY2gpLmF0dGFjaCh0aGlzLCB0b0F0dGFjaCwgbWV0YSwgaW50\nbywKICAgICAgICAgICAgb3duZXIsIG93bmVyTWV0YSwgZXhwbGljaXQpOwog\nICAgfQoKICAgIC8qKgogICAgICogRGV0ZXJtaW5lIHRoZSBhY3Rpb24gdG8g\ndGFrZSBvbiB0aGUgZ2l2ZW4gYXJndW1lbnQuCiAgICAgKi8KICAgIHByaXZh\ndGUgaW50IHByb2Nlc3NBcmd1bWVudChPYmplY3Qgb2JqKSB7CiAgICAgICAg\naWYgKF9jYWxsID09IG51bGwpCiAgICAgICAgICAgIHJldHVybiBPcENhbGxi\nYWNrcy5BQ1RfUlVOOwogICAgICAgIHJldHVybiBfY2FsbC5wcm9jZXNzQXJn\ndW1lbnQoT3BDYWxsYmFja3MuT1BfQVRUQUNILCBvYmosCiAgICAgICAgICAg\nIF9icm9rZXIuZ2V0U3RhdGVNYW5hZ2VyKG9iaikpOwogICAgfQoKICAgIC8q\nKgogICAgICogQ2FsY3VsYXRlIHByb3BlciBhdHRhY2ggc3RyYXRlZ3kgZm9y\nIGluc3RhbmNlLgogICAgICovCiAgICBwcml2YXRlIEF0dGFjaFN0cmF0ZWd5\nIGdldFN0cmF0ZWd5KE9iamVjdCB0b0F0dGFjaCkgewogICAgICAgIFBlcnNp\nc3RlbmNlQ2FwYWJsZSBwYyA9IEltcGxIZWxwZXIudG9QZXJzaXN0ZW5jZUNh\ncGFibGUodG9BdHRhY2gsCiAgICAgICAgICAgIGdldEJyb2tlcigpLmdldENv\nbmZpZ3VyYXRpb24oKSk7CiAgICAgICAgaWYgKHBjLnBjR2V0U3RhdGVNYW5h\nZ2VyKCkgaW5zdGFuY2VvZiBBdHRhY2hTdHJhdGVneSkKICAgICAgICAgICAg\ncmV0dXJuIChBdHRhY2hTdHJhdGVneSkgcGMucGNHZXRTdGF0ZU1hbmFnZXIo\nKTsKCiAgICAgICAgT2JqZWN0IG9iaiA9IHBjLnBjR2V0RGV0YWNoZWRTdGF0\nZSgpOwogICAgICAgIGlmIChvYmogaW5zdGFuY2VvZiBBdHRhY2hTdHJhdGVn\neSkKICAgICAgICAgICAgcmV0dXJuIChBdHRhY2hTdHJhdGVneSkgb2JqOwog\nICAgICAgIGlmIChvYmogPT0gbnVsbCB8fCBvYmogPT0gUGVyc2lzdGVuY2VD\nYXBhYmxlLkRFU0VSSUFMSVpFRCkgewogICAgICAgICAgICAvLyBuZXcgb3Ig\nZGV0YWNoZWQgd2l0aG91dCBzdGF0ZQogICAgICAgICAgICBpZiAoX3ZlcnNp\nb24gPT0gbnVsbCkKICAgICAgICAgICAgICAgIF92ZXJzaW9uID0gbmV3IFZl\ncnNpb25BdHRhY2hTdHJhdGVneSgpOwogICAgICAgICAgICByZXR1cm4gX3Zl\ncnNpb247CiAgICAgICAgfQoKICAgICAgICAvLyBkZXRhY2hlZCBzdGF0ZQog\nICAgICAgIGlmIChfZGV0YWNoID09IG51bGwpCiAgICAgICAgICAgIF9kZXRh\nY2ggPSBuZXcgRGV0YWNoZWRTdGF0ZUF0dGFjaFN0cmF0ZWd5KCk7CiAgICAg\nICAgcmV0dXJuIF9kZXRhY2g7CiAgICB9CgogICAgLyoqCiAgICAgKiBPd25p\nbmcgYnJva2VyLgogICAgICovCiAgICBCcm9rZXJJbXBsIGdldEJyb2tlcigp\nIHsKICAgICAgICByZXR1cm4gX2Jyb2tlcjsKICAgIH0KCiAgICAvKioKICAg\nICAqIFN5c3RlbSBwcm94eSBtYW5hZ2VyLgogICAgICovCiAgICBQcm94eU1h\nbmFnZXIgZ2V0UHJveHlNYW5hZ2VyKCkgewogICAgICAgIHJldHVybiBfcHJv\neHk7CiAgICB9CgogICAgLyoqCiAgICAgKiBJZiB0aGUgcGFzc2VkIGluIGFy\nZ3VtZW50IGhhcyBhbHJlYWR5IGJlZW4gYXR0YWNoZWQsIHJldHVybgogICAg\nICogdGhlIChjYWNoZWQpIGF0dGFjaGVkIGNvcHkuCiAgICAgKi8KICAgIFBl\ncnNpc3RlbmNlQ2FwYWJsZSBnZXRBdHRhY2hlZENvcHkoT2JqZWN0IHBjKSB7\nCiAgICAgICAgcmV0dXJuIEltcGxIZWxwZXIudG9QZXJzaXN0ZW5jZUNhcGFi\nbGUoX2F0dGFjaGVkLmdldChwYyksCiAgICAgICAgICAgIGdldEJyb2tlcigp\nLmdldENvbmZpZ3VyYXRpb24oKSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBS\nZWNvcmQgdGhlIGF0dGFjaGVkIGNvcHkgaW4gdGhlIGNhY2hlLgogICAgICov\nCiAgICB2b2lkIHNldEF0dGFjaGVkQ29weShPYmplY3QgZnJvbSwgUGVyc2lz\ndGVuY2VDYXBhYmxlIGludG8pIHsKICAgICAgICBfYXR0YWNoZWQucHV0KGZy\nb20sIGludG8pOwogICAgfQoKICAgIC8qKgogICAgICogRmlyZSBiZWZvcmUt\nYXR0YWNoIGV2ZW50LgogICAgICovCiAgICB2b2lkIGZpcmVCZWZvcmVBdHRh\nY2goT2JqZWN0IHBjLCBDbGFzc01ldGFEYXRhIG1ldGEpIHsKICAgICAgICBf\nYnJva2VyLmZpcmVMaWZlY3ljbGVFdmVudChwYywgbnVsbCwgbWV0YSwKICAg\nICAgICAgICAgTGlmZWN5Y2xlRXZlbnQuQkVGT1JFX0FUVEFDSCk7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIGRldGFjaGVkIG9pZCBvZiB0\naGUgZ2l2ZW4gaW5zdGFuY2UuCiAgICAgKi8KICAgIE9iamVjdCBnZXREZXRh\nY2hlZE9iamVjdElkKE9iamVjdCBwYykgewogICAgICAgIGlmIChwYyA9PSBu\ndWxsKQogICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICByZXR1cm4g\nZ2V0U3RyYXRlZ3kocGMpLmdldERldGFjaGVkT2JqZWN0SWQodGhpcywgcGMp\nOwogICAgfQoKICAgIC8qKgogICAgICogVGhyb3cgYW4gZXhjZXB0aW9uIGlm\nIHRoZSBnaXZlbiBvYmplY3QgaXMgbm90IG1hbmFnZWQ7IG90aGVyd2lzZQog\nICAgICogcmV0dXJuIGl0cyBzdGF0ZSBtYW5hZ2VyLgogICAgICovCiAgICBT\ndGF0ZU1hbmFnZXJJbXBsIGFzc2VydE1hbmFnZWQoT2JqZWN0IG9iaikgewog\nICAgICAgIFN0YXRlTWFuYWdlckltcGwgc20gPSBfYnJva2VyLmdldFN0YXRl\nTWFuYWdlckltcGwob2JqLCB0cnVlKTsKICAgICAgICBpZiAoc20gPT0gbnVs\nbCkKICAgICAgICAgICAgdGhyb3cgbmV3IFVzZXJFeGNlcHRpb24oX2xvYy5n\nZXQoIm5vdC1tYW5hZ2VkIiwKICAgICAgICAgICAgICAgIEV4Y2VwdGlvbnMu\ndG9TdHJpbmcob2JqKSkpLnNldEZhaWxlZE9iamVjdCAob2JqKTsKCQlyZXR1\ncm4gc207Cgl9Cn0K\n","encoding":"base64"}

