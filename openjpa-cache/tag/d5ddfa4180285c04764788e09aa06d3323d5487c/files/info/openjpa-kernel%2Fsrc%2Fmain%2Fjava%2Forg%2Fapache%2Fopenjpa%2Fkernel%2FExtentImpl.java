{"sha":"dd7a8a759847ad0cc42c218b96d791ef01cfcd3f","node_id":"MDQ6QmxvYjIwNjM2NDpkZDdhOGE3NTk4NDdhZDBjYzQyYzIxOGI5NmQ3OTFlZjAxY2ZjZDNm","size":10682,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/dd7a8a759847ad0cc42c218b96d791ef01cfcd3f","content":"LyoNCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUNCiAqIG9yIG1vcmUgY29udHJpYnV0b3Ig\nbGljZW5zZSBhZ3JlZW1lbnRzLiAgU2VlIHRoZSBOT1RJQ0UgZmlsZQ0KICog\nZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5m\nb3JtYXRpb24NCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAg\nVGhlIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUNCiAqIHRvIHlvdSB1bmRlciB0\naGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUNCiAqICJMaWNl\nbnNlIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNv\nbXBsaWFuY2UNCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFp\nbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQNCiAqDQogKiBodHRwOi8vd3d3\nLmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjANCiAqDQogKiBVbmxl\nc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGlu\nIHdyaXRpbmcsDQogKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUg\nTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbg0KICogIkFTIElTIiBCQVNJ\nUywgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZDQog\nKiBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBM\naWNlbnNlIGZvciB0aGUNCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmlu\nZyBwZXJtaXNzaW9ucyBhbmQgbGltaXRhdGlvbnMNCiAqIHVuZGVyIHRoZSBM\naWNlbnNlLiAgICANCiAqLw0KcGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEu\na2VybmVsOw0KDQppbXBvcnQgamF2YS51dGlsLkFycmF5TGlzdDsNCmltcG9y\ndCBqYXZhLnV0aWwuSXRlcmF0b3I7DQppbXBvcnQgamF2YS51dGlsLkxpc3Q7\nDQppbXBvcnQgamF2YS51dGlsLk5vU3VjaEVsZW1lbnRFeGNlcHRpb247DQoN\nCmltcG9ydCBvcmcuYXBhY2hlLmNvbW1vbnMuY29sbGVjdGlvbnMuUHJlZGlj\nYXRlOw0KaW1wb3J0IG9yZy5hcGFjaGUuY29tbW9ucy5jb2xsZWN0aW9ucy5p\ndGVyYXRvcnMuRmlsdGVySXRlcmF0b3I7DQppbXBvcnQgb3JnLmFwYWNoZS5j\nb21tb25zLmNvbGxlY3Rpb25zLml0ZXJhdG9ycy5JdGVyYXRvckNoYWluOw0K\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIucm9wLlJlc3VsdE9iamVj\ndFByb3ZpZGVyOw0KaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIucm9w\nLlJlc3VsdE9iamVjdFByb3ZpZGVySXRlcmF0b3I7DQppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLmxpYi51dGlsLkNsb3NlYWJsZTsNCmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuUmVmZXJlbmNlSGFzaFNldDsNCmlt\ncG9ydCBqYXZhLnV0aWwuY29uY3VycmVudC5sb2Nrcy5SZWVudHJhbnRMb2Nr\nOw0KaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRhLkNsYXNzTWV0YURh\ndGE7DQppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuTWV0YURhdGFS\nZXBvc2l0b3J5Ow0KaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLkdl\nbmVyYWxFeGNlcHRpb247DQppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0\naWwuSW1wbEhlbHBlcjsNCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRp\nbC5PcGVuSlBBRXhjZXB0aW9uOw0KDQovKioNCiAqIFJlcHJlc2VudGF0aW9u\nIG9mIGFsbCBtZW1iZXJzIG9mIGEgcGVyc2lzdGVudCBjbGFzcy4NCiAqDQog\nKiBAYXV0aG9yIEFiZSBXaGl0ZQ0KICogQGF1dGhvciBQYXRyaWNrIExpbnNr\nZXkNCiAqIEBub2phdmFkb2MNCiAqLw0KcHVibGljIGNsYXNzIEV4dGVudElt\ncGwNCiAgICBpbXBsZW1lbnRzIEV4dGVudCB7DQoNCiAgICBwcml2YXRlIHN0\nYXRpYyBmaW5hbCBDbGFzc01ldGFEYXRhW10gRU1QVFlfTUVUQVMgPSBuZXcg\nQ2xhc3NNZXRhRGF0YVswXTsNCg0KICAgIHByaXZhdGUgZmluYWwgQnJva2Vy\nIF9icm9rZXI7DQogICAgcHJpdmF0ZSBmaW5hbCBDbGFzcyBfdHlwZTsNCiAg\nICBwcml2YXRlIGZpbmFsIGJvb2xlYW4gX3N1YnM7DQogICAgcHJpdmF0ZSBm\naW5hbCBGZXRjaENvbmZpZ3VyYXRpb24gX2ZjOw0KICAgIHByaXZhdGUgZmlu\nYWwgUmVlbnRyYW50TG9jayBfbG9jazsNCiAgICBwcml2YXRlIGJvb2xlYW4g\nX2lnbm9yZSA9IGZhbHNlOw0KDQogICAgLy8gc2V0IG9mIG9wZW4gaXRlcmF0\nb3JzDQogICAgcHJpdmF0ZSBSZWZlcmVuY2VIYXNoU2V0IF9vcGVuSXRycyA9\nIG51bGw7DQoNCiAgICAvKioNCiAgICAgKiBDb25zdHJ1Y3Rvci4NCiAgICAg\nKg0KICAgICAqIEBwYXJhbSBicm9rZXIgdGhlIG93bmluZyBicm9rZXINCiAg\nICAgKiBAcGFyYW0gdHlwZSB0aGUgY2FuZGlkYXRlIGNsYXNzDQogICAgICog\nQHBhcmFtIHN1YnMgd2hldGhlciBzdWJjbGFzc2VzIGFyZSBpbmNsdWRlZCBp\nbiB0aGUgZXh0ZW50DQogICAgICovDQogICAgRXh0ZW50SW1wbChCcm9rZXIg\nYnJva2VyLCBDbGFzcyB0eXBlLCBib29sZWFuIHN1YnMsDQogICAgICAgIEZl\ndGNoQ29uZmlndXJhdGlvbiBmZXRjaCkgew0KICAgICAgICBfYnJva2VyID0g\nYnJva2VyOw0KICAgICAgICBfdHlwZSA9IHR5cGU7DQogICAgICAgIF9zdWJz\nID0gc3ViczsNCiAgICAgICAgaWYgKGZldGNoICE9IG51bGwpDQogICAgICAg\nICAgICBfZmMgPSBmZXRjaDsNCiAgICAgICAgZWxzZQ0KICAgICAgICAgICAg\nX2ZjID0gKEZldGNoQ29uZmlndXJhdGlvbikgYnJva2VyLmdldEZldGNoQ29u\nZmlndXJhdGlvbigpLmNsb25lKCk7DQogICAgICAgIF9pZ25vcmUgPSBicm9r\nZXIuZ2V0SWdub3JlQ2hhbmdlcygpOw0KICAgICAgICBpZiAoYnJva2VyLmdl\ndE11bHRpdGhyZWFkZWQoKSkNCiAgICAgICAgICAgIF9sb2NrID0gbmV3IFJl\nZW50cmFudExvY2soKTsNCiAgICAgICAgZWxzZQ0KICAgICAgICAgICAgX2xv\nY2sgPSBudWxsOw0KICAgIH0NCg0KICAgIHB1YmxpYyBGZXRjaENvbmZpZ3Vy\nYXRpb24gZ2V0RmV0Y2hDb25maWd1cmF0aW9uKCkgew0KICAgICAgICByZXR1\ncm4gX2ZjOw0KICAgIH0NCg0KICAgIHB1YmxpYyBib29sZWFuIGdldElnbm9y\nZUNoYW5nZXMoKSB7DQogICAgICAgIHJldHVybiBfaWdub3JlOw0KICAgIH0N\nCg0KICAgIHB1YmxpYyB2b2lkIHNldElnbm9yZUNoYW5nZXMoYm9vbGVhbiBp\nZ25vcmVDaGFuZ2VzKSB7DQogICAgICAgIF9icm9rZXIuYXNzZXJ0T3Blbigp\nOw0KICAgICAgICBfaWdub3JlID0gaWdub3JlQ2hhbmdlczsNCiAgICB9DQoN\nCiAgICBwdWJsaWMgTGlzdCBsaXN0KCkgew0KICAgICAgICBMaXN0IGxpc3Qg\nPSBuZXcgQXJyYXlMaXN0KCk7DQogICAgICAgIEl0ZXJhdG9yIGl0ciA9IGl0\nZXJhdG9yKCk7DQogICAgICAgIHRyeSB7DQogICAgICAgICAgICB3aGlsZSAo\naXRyLmhhc05leHQoKSkNCiAgICAgICAgICAgICAgICBsaXN0LmFkZChpdHIu\nbmV4dCgpKTsNCiAgICAgICAgICAgIHJldHVybiBsaXN0Ow0KICAgICAgICB9\nIGZpbmFsbHkgew0KICAgICAgICAgICAgSW1wbEhlbHBlci5jbG9zZShpdHIp\nOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgcHVibGljIEl0ZXJhdG9yIGl0\nZXJhdG9yKCkgew0KICAgICAgICBfYnJva2VyLmFzc2VydE5vbnRyYW5zYWN0\naW9uYWxSZWFkKCk7DQogICAgICAgIENsb3NlYWJsZUl0ZXJhdG9yIGNpdHIg\nPSBudWxsOw0KICAgICAgICB0cnkgew0KICAgICAgICAgICAgLy8gY3JlYXRl\nIGFuIGl0ZXJhdG9yIGNoYWluOyBhZGQgcG5ldyBvYmplY3RzIGlmIHRyYW5z\nYWN0aW9uYWwNCiAgICAgICAgICAgIENsb3NlYWJsZUl0ZXJhdG9yQ2hhaW4g\nY2hhaW4gPSBuZXcgQ2xvc2VhYmxlSXRlcmF0b3JDaGFpbigpOw0KICAgICAg\nICAgICAgYm9vbGVhbiB0cmFucyA9ICFfaWdub3JlICYmIF9icm9rZXIuaXNB\nY3RpdmUoKTsNCiAgICAgICAgICAgIGlmICh0cmFucykNCiAgICAgICAgICAg\nICAgICBjaGFpbi5hZGRJdGVyYXRvcihuZXcgRmlsdGVyTmV3SXRlcmF0b3Io\nKSk7DQoNCiAgICAgICAgICAgIC8vIGFkZCBkYXRhYmFzZSBpdGVyYXRvcnMg\nZm9yIGVhY2ggaW1wbGVtZW50aW5nIGNsYXNzDQogICAgICAgICAgICBNZXRh\nRGF0YVJlcG9zaXRvcnkgcmVwb3MgPSBfYnJva2VyLmdldENvbmZpZ3VyYXRp\nb24oKS4NCiAgICAgICAgICAgICAgICBnZXRNZXRhRGF0YVJlcG9zaXRvcnlJ\nbnN0YW5jZSgpOw0KICAgICAgICAgICAgQ2xhc3NNZXRhRGF0YSBtZXRhID0g\ncmVwb3MuZ2V0TWV0YURhdGEoX3R5cGUsDQogICAgICAgICAgICAgICAgX2Jy\nb2tlci5nZXRDbGFzc0xvYWRlcigpLCBmYWxzZSk7DQoNCiAgICAgICAgICAg\nIENsYXNzTWV0YURhdGFbXSBtZXRhczsNCiAgICAgICAgICAgIGlmIChtZXRh\nICE9IG51bGwgJiYgKCFfc3VicyB8fCAhbWV0YS5pc01hbmFnZWRJbnRlcmZh\nY2UoKSkNCiAgICAgICAgICAgICAgICAmJiAobWV0YS5pc01hcHBlZCgpIHx8\nIChfc3Vicw0KICAgICAgICAgICAgICAgICYmIG1ldGEuZ2V0TWFwcGVkUENT\ndWJjbGFzc01ldGFEYXRhcygpLmxlbmd0aCA+IDApKSkNCiAgICAgICAgICAg\nICAgICBtZXRhcyA9IG5ldyBDbGFzc01ldGFEYXRhW117IG1ldGEgfTsNCiAg\nICAgICAgICAgIGVsc2UgaWYgKF9zdWJzICYmIChtZXRhID09IG51bGwgfHwg\nbWV0YS5pc01hbmFnZWRJbnRlcmZhY2UoKSkpDQogICAgICAgICAgICAgICAg\nbWV0YXMgPSByZXBvcy5nZXRJbXBsZW1lbnRvck1ldGFEYXRhcyhfdHlwZSwN\nCiAgICAgICAgICAgICAgICAgICAgX2Jyb2tlci5nZXRDbGFzc0xvYWRlcigp\nLCBmYWxzZSk7DQogICAgICAgICAgICBlbHNlDQogICAgICAgICAgICAgICAg\nbWV0YXMgPSBFTVBUWV9NRVRBUzsNCg0KICAgICAgICAgICAgUmVzdWx0T2Jq\nZWN0UHJvdmlkZXIgcm9wOw0KICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7\nIGkgPCBtZXRhcy5sZW5ndGg7IGkrKykgew0KICAgICAgICAgICAgICAgIHJv\ncCA9IF9icm9rZXIuZ2V0U3RvcmVNYW5hZ2VyKCkuZXhlY3V0ZUV4dGVudCht\nZXRhc1tpXSwNCiAgICAgICAgICAgICAgICAgICAgX3N1YnMsIF9mYyk7DQog\nICAgICAgICAgICAgICAgaWYgKHJvcCAhPSBudWxsKQ0KICAgICAgICAgICAg\nICAgICAgICBjaGFpbi5hZGRJdGVyYXRvcihuZXcgUmVzdWx0T2JqZWN0UHJv\ndmlkZXJJdGVyYXRvcihyb3ApKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAg\nICAgICAgLy8gZmlsdGVyIGRlbGV0ZWQgb2JqZWN0cyBpZiB0cmFuc2FjdGlv\nbmFsDQogICAgICAgICAgICBpZiAodHJhbnMpDQogICAgICAgICAgICAgICAg\nY2l0ciA9IG5ldyBGaWx0ZXJEZWxldGVkSXRlcmF0b3IoY2hhaW4pOw0KICAg\nICAgICAgICAgZWxzZQ0KICAgICAgICAgICAgICAgIGNpdHIgPSBjaGFpbjsN\nCiAgICAgICAgICAgIGNpdHIuc2V0UmVtb3ZlT25DbG9zZSh0aGlzKTsNCiAg\nICAgICAgfSBjYXRjaCAoT3BlbkpQQUV4Y2VwdGlvbiBrZSkgew0KICAgICAg\nICAgICAgdGhyb3cga2U7DQogICAgICAgIH0gY2F0Y2ggKFJ1bnRpbWVFeGNl\ncHRpb24gcmUpIHsNCiAgICAgICAgICAgIHRocm93IG5ldyBHZW5lcmFsRXhj\nZXB0aW9uKHJlKTsNCiAgICAgICAgfQ0KDQogICAgICAgIGxvY2soKTsNCiAg\nICAgICAgdHJ5IHsNCiAgICAgICAgICAgIGlmIChfb3Blbkl0cnMgPT0gbnVs\nbCkNCiAgICAgICAgICAgICAgICBfb3Blbkl0cnMgPSBuZXcgUmVmZXJlbmNl\nSGFzaFNldChSZWZlcmVuY2VIYXNoU2V0LldFQUspOw0KICAgICAgICAgICAg\nX29wZW5JdHJzLmFkZChjaXRyKTsNCiAgICAgICAgfSBmaW5hbGx5IHsNCiAg\nICAgICAgICAgIHVubG9jaygpOw0KICAgICAgICB9DQogICAgICAgIHJldHVy\nbiBjaXRyOw0KICAgIH0NCg0KICAgIHB1YmxpYyBCcm9rZXIgZ2V0QnJva2Vy\nKCkgew0KICAgICAgICByZXR1cm4gX2Jyb2tlcjsNCiAgICB9DQoNCiAgICBw\ndWJsaWMgQ2xhc3MgZ2V0RWxlbWVudFR5cGUoKSB7DQogICAgICAgIHJldHVy\nbiBfdHlwZTsNCiAgICB9DQoNCiAgICBwdWJsaWMgYm9vbGVhbiBoYXNTdWJj\nbGFzc2VzKCkgew0KICAgICAgICByZXR1cm4gX3N1YnM7DQogICAgfQ0KDQog\nICAgcHVibGljIHZvaWQgY2xvc2VBbGwoKSB7DQogICAgICAgIGlmIChfb3Bl\nbkl0cnMgPT0gbnVsbCkNCiAgICAgICAgICAgIHJldHVybjsNCg0KICAgICAg\nICBsb2NrKCk7DQogICAgICAgIHRyeSB7DQogICAgICAgICAgICBDbG9zZWFi\nbGVJdGVyYXRvciBjaXRyOw0KICAgICAgICAgICAgZm9yIChJdGVyYXRvciBp\ndHIgPSBfb3Blbkl0cnMuaXRlcmF0b3IoKTsgaXRyLmhhc05leHQoKTspIHsN\nCiAgICAgICAgICAgICAgICBjaXRyID0gKENsb3NlYWJsZUl0ZXJhdG9yKSBp\ndHIubmV4dCgpOw0KICAgICAgICAgICAgICAgIGNpdHIuc2V0UmVtb3ZlT25D\nbG9zZShudWxsKTsNCiAgICAgICAgICAgICAgICB0cnkgew0KICAgICAgICAg\nICAgICAgICAgICBjaXRyLmNsb3NlKCk7DQogICAgICAgICAgICAgICAgfSBj\nYXRjaCAoRXhjZXB0aW9uIGUpIHsNCiAgICAgICAgICAgICAgICB9DQogICAg\nICAgICAgICB9DQogICAgICAgICAgICBfb3Blbkl0cnMuY2xlYXIoKTsNCiAg\nICAgICAgfSBjYXRjaCAoT3BlbkpQQUV4Y2VwdGlvbiBrZSkgew0KICAgICAg\nICAgICAgdGhyb3cga2U7DQogICAgICAgIH0gY2F0Y2ggKFJ1bnRpbWVFeGNl\ncHRpb24gcmUpIHsNCiAgICAgICAgICAgIHRocm93IG5ldyBHZW5lcmFsRXhj\nZXB0aW9uKHJlKTsNCiAgICAgICAgfSBmaW5hbGx5IHsNCiAgICAgICAgICAg\nIHVubG9jaygpOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgcHVibGljIHZv\naWQgbG9jaygpIHsNCiAgICAgICAgaWYgKF9sb2NrICE9IG51bGwpDQogICAg\nICAgICAgICBfbG9jay5sb2NrKCk7DQogICAgfQ0KDQogICAgcHVibGljIHZv\naWQgdW5sb2NrKCkgew0KICAgICAgICBpZiAoX2xvY2sgIT0gbnVsbCkNCiAg\nICAgICAgICAgIF9sb2NrLnVubG9jaygpOw0KICAgIH0NCg0KICAgIC8qKg0K\nICAgICAqIENsb3NlYWJsZSBpdGVyYXRvci4NCiAgICAgKi8NCiAgICBwcml2\nYXRlIHN0YXRpYyBpbnRlcmZhY2UgQ2xvc2VhYmxlSXRlcmF0b3INCiAgICAg\nICAgZXh0ZW5kcyBDbG9zZWFibGUsIEl0ZXJhdG9yIHsNCg0KICAgICAgICAv\nKioNCiAgICAgICAgICogU2V0IHRoZSBleHRlbnQgdG8gcmVtb3ZlIHNlbGYg\nZnJvbSBvbiBjbG9zZS4NCiAgICAgICAgICovDQogICAgICAgIHB1YmxpYyB2\nb2lkIHNldFJlbW92ZU9uQ2xvc2UoRXh0ZW50SW1wbCBleHRlbnQpOw0KICAg\nIH0NCg0KICAgIC8qKg0KICAgICAqIENsb3NlYWJsZSB7QGxpbmsgSXRlcmF0\nb3JDaGFpbn0uDQogICAgICovDQogICAgcHJpdmF0ZSBzdGF0aWMgY2xhc3Mg\nQ2xvc2VhYmxlSXRlcmF0b3JDaGFpbg0KICAgICAgICBleHRlbmRzIEl0ZXJh\ndG9yQ2hhaW4NCiAgICAgICAgaW1wbGVtZW50cyBDbG9zZWFibGVJdGVyYXRv\nciB7DQoNCiAgICAgICAgcHJpdmF0ZSBFeHRlbnRJbXBsIF9leHRlbnQgPSBu\ndWxsOw0KICAgICAgICBwcml2YXRlIGJvb2xlYW4gX2Nsb3NlZCA9IGZhbHNl\nOw0KDQogICAgICAgIHB1YmxpYyBib29sZWFuIGhhc05leHQoKSB7DQogICAg\nICAgICAgICByZXR1cm4gKF9jbG9zZWQpID8gZmFsc2UgOiBzdXBlci5oYXNO\nZXh0KCk7DQogICAgICAgIH0NCg0KICAgICAgICBwdWJsaWMgT2JqZWN0IG5l\neHQoKSB7DQogICAgICAgICAgICBpZiAoX2Nsb3NlZCkNCiAgICAgICAgICAg\nICAgICB0aHJvdyBuZXcgTm9TdWNoRWxlbWVudEV4Y2VwdGlvbigpOw0KICAg\nICAgICAgICAgcmV0dXJuIHN1cGVyLm5leHQoKTsNCiAgICAgICAgfQ0KDQog\nICAgICAgIHB1YmxpYyB2b2lkIHJlbW92ZSgpIHsNCiAgICAgICAgICAgIHRo\ncm93IG5ldyBVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbigpOw0KICAg\nICAgICB9DQoNCiAgICAgICAgcHVibGljIHZvaWQgc2V0UmVtb3ZlT25DbG9z\nZShFeHRlbnRJbXBsIGV4dGVudCkgew0KICAgICAgICAgICAgX2V4dGVudCA9\nIGV4dGVudDsNCiAgICAgICAgfQ0KDQogICAgICAgIHB1YmxpYyB2b2lkIGNs\nb3NlKCkNCiAgICAgICAgICAgIHRocm93cyBFeGNlcHRpb24gew0KICAgICAg\nICAgICAgaWYgKF9leHRlbnQgIT0gbnVsbCAmJiBfZXh0ZW50Ll9vcGVuSXRy\ncyAhPSBudWxsKSB7DQogICAgICAgICAgICAgICAgX2V4dGVudC5sb2NrKCk7\nDQogICAgICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgICAgICAg\nX2V4dGVudC5fb3Blbkl0cnMucmVtb3ZlKHRoaXMpOw0KICAgICAgICAgICAg\nICAgIH0gZmluYWxseSB7DQogICAgICAgICAgICAgICAgICAgIF9leHRlbnQu\ndW5sb2NrKCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0K\nDQogICAgICAgICAgICBfY2xvc2VkID0gdHJ1ZTsNCiAgICAgICAgICAgIGZv\nciAoSXRlcmF0b3IgaXRyID0gZ2V0SXRlcmF0b3JzKCkuaXRlcmF0b3IoKTsg\naXRyLmhhc05leHQoKTspDQogICAgICAgICAgICAgICAgKChDbG9zZWFibGUp\nIGl0ci5uZXh0KCkpLmNsb3NlKCk7DQogICAgICAgIH0NCiAgICB9DQoNCiAg\nICAvKioNCiAgICAgKiB7QGxpbmsgRmlsdGVySXRlcmF0b3J9IHRoYXQgc2tp\ncHMgZGVsZXRlZCBvYmplY3RzLg0KICAgICAqLw0KICAgIHByaXZhdGUgc3Rh\ndGljIGNsYXNzIEZpbHRlckRlbGV0ZWRJdGVyYXRvcg0KICAgICAgICBleHRl\nbmRzIEZpbHRlckl0ZXJhdG9yDQogICAgICAgIGltcGxlbWVudHMgQ2xvc2Vh\nYmxlSXRlcmF0b3IsIFByZWRpY2F0ZSB7DQoNCiAgICAgICAgcHJpdmF0ZSBF\neHRlbnRJbXBsIF9leHRlbnQgPSBudWxsOw0KICAgICAgICBwcml2YXRlIGJv\nb2xlYW4gX2Nsb3NlZCA9IGZhbHNlOw0KDQogICAgICAgIHB1YmxpYyBGaWx0\nZXJEZWxldGVkSXRlcmF0b3IoSXRlcmF0b3IgaXRyKSB7DQogICAgICAgICAg\nICBzdXBlcihpdHIpOw0KICAgICAgICAgICAgc2V0UHJlZGljYXRlKHRoaXMp\nOw0KICAgICAgICB9DQoNCiAgICAgICAgcHVibGljIGJvb2xlYW4gaGFzTmV4\ndCgpIHsNCiAgICAgICAgICAgIHJldHVybiAoX2Nsb3NlZCkgPyBmYWxzZSA6\nIHN1cGVyLmhhc05leHQoKTsNCiAgICAgICAgfQ0KDQogICAgICAgIHB1Ymxp\nYyBPYmplY3QgbmV4dCgpIHsNCiAgICAgICAgICAgIGlmIChfY2xvc2VkKQ0K\nICAgICAgICAgICAgICAgIHRocm93IG5ldyBOb1N1Y2hFbGVtZW50RXhjZXB0\naW9uKCk7DQogICAgICAgICAgICByZXR1cm4gc3VwZXIubmV4dCgpOw0KICAg\nICAgICB9DQoNCiAgICAgICAgcHVibGljIHZvaWQgcmVtb3ZlKCkgew0KICAg\nICAgICAgICAgdGhyb3cgbmV3IFVuc3VwcG9ydGVkT3BlcmF0aW9uRXhjZXB0\naW9uKCk7DQogICAgICAgIH0NCg0KICAgICAgICBwdWJsaWMgdm9pZCBzZXRS\nZW1vdmVPbkNsb3NlKEV4dGVudEltcGwgZXh0ZW50KSB7DQogICAgICAgICAg\nICBfZXh0ZW50ID0gZXh0ZW50Ow0KICAgICAgICB9DQoNCiAgICAgICAgcHVi\nbGljIHZvaWQgY2xvc2UoKQ0KICAgICAgICAgICAgdGhyb3dzIEV4Y2VwdGlv\nbiB7DQogICAgICAgICAgICBpZiAoX2V4dGVudCAhPSBudWxsICYmIF9leHRl\nbnQuX29wZW5JdHJzICE9IG51bGwpIHsNCiAgICAgICAgICAgICAgICBfZXh0\nZW50LmxvY2soKTsNCiAgICAgICAgICAgICAgICB0cnkgew0KICAgICAgICAg\nICAgICAgICAgICBfZXh0ZW50Ll9vcGVuSXRycy5yZW1vdmUodGhpcyk7DQog\nICAgICAgICAgICAgICAgfSBmaW5hbGx5IHsNCiAgICAgICAgICAgICAgICAg\nICAgX2V4dGVudC51bmxvY2soKTsNCiAgICAgICAgICAgICAgICB9DQogICAg\nICAgICAgICB9DQoNCiAgICAgICAgICAgIF9jbG9zZWQgPSB0cnVlOw0KICAg\nICAgICAgICAgKChDbG9zZWFibGUpIGdldEl0ZXJhdG9yKCkpLmNsb3NlKCk7\nDQogICAgICAgIH0NCg0KICAgICAgICBwdWJsaWMgYm9vbGVhbiBldmFsdWF0\nZShPYmplY3Qgbykgew0KICAgICAgICAgICAgcmV0dXJuICFfZXh0ZW50Ll9i\ncm9rZXIuaXNEZWxldGVkKG8pOw0KICAgICAgICB9DQogICAgfQ0KDQogICAg\nLyoqDQogICAgICogSXRlcmF0b3Igb3ZlciBhbGwgbmV3IG9iamVjdHMgaW4g\ndGhpcyBleHRlbnQuIFRoaXMgaXRlcmF0b3IgaXMgYWx3YXlzDQogICAgICog\nd3JhcHBlZCwgc28gaXQgZG9lc24ndCBuZWVkIHRvIGtlZXAgdHJhY2sgb2Yg\nd2hldGhlciBpdCdzIGNsb3NlZC4NCiAgICAgKi8NCiAgICBwcml2YXRlIGNs\nYXNzIEZpbHRlck5ld0l0ZXJhdG9yDQogICAgICAgIGV4dGVuZHMgRmlsdGVy\nSXRlcmF0b3INCiAgICAgICAgaW1wbGVtZW50cyBDbG9zZWFibGUsIFByZWRp\nY2F0ZSB7DQoNCiAgICAgICAgcHVibGljIEZpbHRlck5ld0l0ZXJhdG9yKCkg\new0KICAgICAgICAgICAgc3VwZXIoX2Jyb2tlci5nZXRUcmFuc2FjdGlvbmFs\nT2JqZWN0cygpLml0ZXJhdG9yKCkpOw0KICAgICAgICAgICAgc2V0UHJlZGlj\nYXRlKHRoaXMpOw0KICAgICAgICB9DQoNCiAgICAgICAgcHVibGljIHZvaWQg\nY2xvc2UoKSB7DQogICAgICAgIH0NCg0KICAgICAgICBwdWJsaWMgYm9vbGVh\nbiBldmFsdWF0ZShPYmplY3Qgbykgew0KICAgICAgICAgICAgaWYgKCFfYnJv\na2VyLmlzTmV3KG8pKQ0KICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsN\nCg0KICAgICAgICAgICAgQ2xhc3MgdHlwZSA9IG8uZ2V0Q2xhc3MoKTsNCiAg\nICAgICAgICAgIGlmICghX3N1YnMgJiYgdHlwZSAhPSBfdHlwZSkNCiAgICAg\nICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICBpZiAoX3N1\nYnMgJiYgIV90eXBlLmlzQXNzaWduYWJsZUZyb20odHlwZSkpDQogICAgICAg\nICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgcmV0dXJuIHRy\ndWU7DQoJCX0NCgl9DQp9DQo=\n","encoding":"base64"}

