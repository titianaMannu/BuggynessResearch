{"sha":"b68890f6b4c2d5fe6509c4fa4625a5efc8042a88","node_id":"MDQ6QmxvYjIwNjM2NDpiNjg4OTBmNmI0YzJkNWZlNjUwOWM0ZmE0NjI1YTVlZmM4MDQyYTg4","size":7787,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/b68890f6b4c2d5fe6509c4fa4625a5efc8042a88","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsOwoKaW1wb3J0IGph\ndmEuaW8uU2VyaWFsaXphYmxlOwppbXBvcnQgamF2YS5pby5PYmplY3RPdXRw\ndXRTdHJlYW07CmltcG9ydCBqYXZhLmlvLklPRXhjZXB0aW9uOwppbXBvcnQg\namF2YS5pby5PYmplY3RJbnB1dFN0cmVhbTsKaW1wb3J0IGphdmEudXRpbC5C\naXRTZXQ7CmltcG9ydCBqYXZhLnV0aWwuQ29sbGVjdGlvbjsKaW1wb3J0IGph\ndmEudXRpbC5EYXRlOwppbXBvcnQgamF2YS51dGlsLk1hcDsKCmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEuZW5oYW5jZS5QZXJzaXN0ZW5jZUNhcGFibGU7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuTG9jYWxpemVy\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuRmllbGRNZXRhRGF0\nYTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRhLkphdmFUeXBlczsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLkludGVybmFsRXhjZXB0\naW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuUHJveHlNYW5h\nZ2VyOwoKLyoqCiAqIEZpZWxkTWFuYWdlciB0eXBlIHVzZWQgdG8gc3RvcmUg\naW5mb3JtYXRpb24gZm9yIHNhdmVwb2ludCByb2xsYmFjay4KICoKICogQGF1\ndGhvciBTdGV2ZSBLaW0KICogQHNpbmNlIDAuMy40CiAqLwpjbGFzcyBTYXZl\ncG9pbnRGaWVsZE1hbmFnZXIKICAgIGV4dGVuZHMgQ2xlYXJGaWVsZE1hbmFn\nZXIKICAgIGltcGxlbWVudHMgU2VyaWFsaXphYmxlIHsKCiAgICBwcml2YXRl\nIHN0YXRpYyBmaW5hbCBMb2NhbGl6ZXIgX2xvYyA9IExvY2FsaXplci5mb3JQ\nYWNrYWdlCiAgICAgICAgKFNhdmVwb2ludEZpZWxkTWFuYWdlci5jbGFzcyk7\nCgogICAgcHJpdmF0ZSBmaW5hbCBTdGF0ZU1hbmFnZXJJbXBsIF9zbTsKICAg\nIHByaXZhdGUgZmluYWwgQml0U2V0IF9sb2FkZWQ7CiAgICBwcml2YXRlIGZp\nbmFsIEJpdFNldCBfZGlydHk7CiAgICBwcml2YXRlIGZpbmFsIEJpdFNldCBf\nZmx1c2g7CiAgICBwcml2YXRlIGZpbmFsIFBDU3RhdGUgX3N0YXRlOwogICAg\ncHJpdmF0ZSB0cmFuc2llbnQgUGVyc2lzdGVuY2VDYXBhYmxlIF9jb3B5OwoK\nICAgIHByaXZhdGUgZmluYWwgT2JqZWN0IF92ZXJzaW9uOwogICAgcHJpdmF0\nZSBmaW5hbCBPYmplY3QgX2xvYWRWZXJzaW9uOwoKICAgIC8vIHVzZWQgdG8g\ndHJhY2sgZmllbGQgdmFsdWUgZHVyaW5nIHN0b3JlL2ZldGNoIGN5Y2xlCiAg\nICBwcml2YXRlIE9iamVjdCBfZmllbGQgPSBudWxsOwogICAgcHJpdmF0ZSBp\nbnRbXSBfY29weUZpZWxkID0gbnVsbDsKICAgIHByaXZhdGUgQml0U2V0IF9t\ndXRhYmxlOwoKICAgIC8qKgogICAgICogQ29uc3RydWN0b3IuIFByb3ZpZGUg\naW5zdGFuY2UgdG8gc2F2ZSBhbmQgaW5kaWNhdGUgd2hldGhlcgogICAgICog\ndG8gY29weSBwZXJzaXN0ZW50IGZpZWxkcy4gVHJhbnNhY3Rpb25hbCBmaWVs\nZHMgd2lsbCBiZQogICAgICogY29waWVkIHJlZ2FyZGxlc3Mgb2YgY29weSBz\nZXR0aW5nLgogICAgICovCiAgICBwdWJsaWMgU2F2ZXBvaW50RmllbGRNYW5h\nZ2VyKFN0YXRlTWFuYWdlckltcGwgc20sIGJvb2xlYW4gY29weSkgewogICAg\nICAgIF9zbSA9IHNtOwogICAgICAgIF9zdGF0ZSA9IF9zbS5nZXRQQ1N0YXRl\nKCk7CgogICAgICAgIF9kaXJ0eSA9IChCaXRTZXQpIF9zbS5nZXREaXJ0eSgp\nLmNsb25lKCk7CiAgICAgICAgX2ZsdXNoID0gKEJpdFNldCkgX3NtLmdldEZs\ndXNoZWQoKS5jbG9uZSgpOwogICAgICAgIF9sb2FkZWQgPSAoQml0U2V0KSBf\nc20uZ2V0TG9hZGVkKCkuY2xvbmUoKTsKCiAgICAgICAgRmllbGRNZXRhRGF0\nYVtdIGZpZWxkcyA9IF9zbS5nZXRNZXRhRGF0YSgpLmdldEZpZWxkcygpOwog\nICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgX2xvYWRlZC5sZW5ndGgoKTsg\naSsrKSB7CiAgICAgICAgICAgIGlmICghX2xvYWRlZC5nZXQoaSkpCiAgICAg\nICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgaWYgKGNvcHkgfHwg\nZmllbGRzW2ldLmdldE1hbmFnZW1lbnQoKSA9PQogICAgICAgICAgICAgICAg\nRmllbGRNZXRhRGF0YS5NQU5BR0VfVFJBTlNBQ1RJT05BTCkgewogICAgICAg\nICAgICAgICAgaWYgKF9jb3B5ID09IG51bGwpCiAgICAgICAgICAgICAgICAg\nICAgX2NvcHkgPSBfc20uZ2V0UGVyc2lzdGVuY2VDYXBhYmxlKCkucGNOZXdJ\nbnN0YW5jZQogICAgICAgICAgICAgICAgICAgICAgICAoX3NtLCB0cnVlKTsK\nICAgICAgICAgICAgICAgIHN0b3JlRmllbGQoZmllbGRzW2ldKTsKICAgICAg\nICAgICAgfSBlbHNlCiAgICAgICAgICAgICAgICBfbG9hZGVkLmNsZWFyKGkp\nOwogICAgICAgIH0KCiAgICAgICAgLy8gd2UgbmVlZCB0byBwcm94eSB0aGUg\nZmllbGRzIHNvIHRoYXQgd2UgY2FuIHRyYWNrIGZ1dHVyZSBjaGFuZ2VzCiAg\nICAgICAgLy8gZnJvbSB0aGlzIHNhdmVwb2ludCBmb3J3YXJkIGZvciBQTmV3\nIGluc3RhbmNlcycgbXV0YWJsZSBmaWVsZHMKICAgICAgICBfc20ucHJveHlG\naWVsZHMoZmFsc2UsIGZhbHNlKTsKCiAgICAgICAgX3ZlcnNpb24gPSBfc20u\nZ2V0VmVyc2lvbiAoKTsKICAgICAgICBfbG9hZFZlcnNpb24gPSBfc20uZ2V0\nTG9hZFZlcnNpb24gKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4g\ndGhlIHN0YXRlIG1hbmFnZXIgdGhhdCB0aGlzIG1hbmFnZXIgaXMgYXNzb2Np\nYXRlZCB3aXRoLgogICAgICovCiAgICBwdWJsaWMgU3RhdGVNYW5hZ2VySW1w\nbCBnZXRTdGF0ZU1hbmFnZXIoKSB7CiAgICAgICAgcmV0dXJuIF9zbTsKICAg\nIH0KCiAgICBwdWJsaWMgT2JqZWN0IGdldFZlcnNpb24oKSB7CiAgICAgICAg\ncmV0dXJuIF92ZXJzaW9uOwogICAgfQoKICAgIHB1YmxpYyBPYmplY3QgZ2V0\nTG9hZFZlcnNpb24oKSB7CiAgICAgICAgcmV0dXJuIF9sb2FkVmVyc2lvbjsK\nICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgcGVyc2lzdGVuY2Ug\nY2FwYWJsZSBjb3B5IGhvbGRpbmcgdGhlIHNhdmVwb2ludCBmaWVsZCB2YWx1\nZXMuCiAgICAgKi8KICAgIHB1YmxpYyBQZXJzaXN0ZW5jZUNhcGFibGUgZ2V0\nQ29weSgpIHsKICAgICAgICByZXR1cm4gX2NvcHk7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBSZXR1cm4gdGhlIHNhdmVkIHtAbGluayBQQ1N0YXRlfQogICAg\nICovCiAgICBwdWJsaWMgUENTdGF0ZSBnZXRQQ1N0YXRlKCkgewogICAgICAg\nIHJldHVybiBfc3RhdGU7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4g\ndGhlIGZpZWxkcyBzdG9yZWQgaW4gdGhpcyBtYW5hZ2VyLgogICAgICovCiAg\nICBwdWJsaWMgQml0U2V0IGdldExvYWRlZCgpIHsKICAgICAgICByZXR1cm4g\nX2xvYWRlZDsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgZGly\ndHkgZmllbGRzIGR1cmluZyB0aGUgc2F2ZWQgc3RhdGUuCiAgICAgKi8KICAg\nIHB1YmxpYyBCaXRTZXQgZ2V0RGlydHkoKSB7CiAgICAgICAgcmV0dXJuIF9k\naXJ0eTsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgZmx1c2hl\nZCBmaWVsZHMgZHVyaW5nIHRoZSBzYXZlZCBzdGF0ZS4KICAgICAqLwogICAg\ncHVibGljIEJpdFNldCBnZXRGbHVzaGVkKCkgewogICAgICAgIHJldHVybiBf\nZmx1c2g7CiAgICB9CgogICAgLyoqCiAgICAgKiBTdG9yZSB0aGUgZGF0YSBm\nb3IgdGhlIGdpdmVuIGZpZWxkLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBz\ndG9yZUZpZWxkKEZpZWxkTWV0YURhdGEgZmllbGQpIHsKICAgICAgICBzd2l0\nY2ggKGZpZWxkLmdldERlY2xhcmVkVHlwZUNvZGUoKSkgewogICAgICAgICAg\nICBjYXNlIEphdmFUeXBlcy5EQVRFOgogICAgICAgICAgICBjYXNlIEphdmFU\neXBlcy5BUlJBWToKICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuQ09MTEVD\nVElPTjoKICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuTUFQOgogICAgICAg\nICAgICBjYXNlIEphdmFUeXBlcy5PQkpFQ1Q6CiAgICAgICAgICAgICAgICBp\nZiAoX211dGFibGUgPT0gbnVsbCkKICAgICAgICAgICAgICAgICAgICBfbXV0\nYWJsZSA9IG5ldyBCaXRTZXQoX3NtLmdldE1ldGFEYXRhKCkuZ2V0RmllbGRz\nKCkubGVuZ3RoKTsKICAgICAgICAgICAgICAgIF9tdXRhYmxlLnNldChmaWVs\nZC5nZXRJbmRleCgpKTsKICAgICAgICB9CiAgICAgICAgaWYgKF9tdXRhYmxl\nID09IG51bGwgfHwgIV9tdXRhYmxlLmdldChmaWVsZC5nZXRJbmRleCgpKSkg\newogICAgICAgICAgICAvLyBpbW11dGFibGUgZmllbGRzIGNhbiBqdXN0IGJl\nIGNvcGllZCBvdmVyCiAgICAgICAgICAgIGlmIChfY29weUZpZWxkID09IG51\nbGwpCiAgICAgICAgICAgICAgICBfY29weUZpZWxkID0gbmV3IGludFsxXTsK\nICAgICAgICAgICAgX2NvcHlGaWVsZFswXSA9IGZpZWxkLmdldEluZGV4KCk7\nCiAgICAgICAgICAgIF9jb3B5LnBjQ29weUZpZWxkcyhfc20uZ2V0UGVyc2lz\ndGVuY2VDYXBhYmxlKCksIF9jb3B5RmllbGQpOwogICAgICAgIH0gZWxzZSB7\nCiAgICAgICAgICAgIF9zbS5wcm92aWRlRmllbGQoX3NtLmdldFBlcnNpc3Rl\nbmNlQ2FwYWJsZSgpLCB0aGlzLAogICAgICAgICAgICAgICAgZmllbGQuZ2V0\nSW5kZXgoKSk7CiAgICAgICAgICAgIF9zbS5yZXBsYWNlRmllbGQoX2NvcHks\nIHRoaXMsIGZpZWxkLmdldEluZGV4KCkpOwogICAgICAgIH0KICAgIH0KCiAg\nICAvKioKICAgICAqIFJlc3RvcmUgdGhlIGdpdmVuIGZpZWxkLiBJZiB0aGlz\nIG1ldGhvZCByZXR1cm5zIHRydWUsIHRoZW4geW91IG5lZWQKICAgICAqIHRv\nIHVzZSB0aGlzIGZpZWxkIG1hbmFnZXIgdG8gcmVwbGFjZSB0aGUgZ2l2ZW4g\nZmllbGQgaW4gdGhlIHN0YXRlCiAgICAgKiBtYW5hZ2VyJ3MgaW5zdGFuY2Uu\nCiAgICAgKi8KICAgIHB1YmxpYyBib29sZWFuIHJlc3RvcmVGaWVsZChpbnQg\nZmllbGQpIHsKICAgICAgICBpZiAoIV9sb2FkZWQuZ2V0KGZpZWxkKSkKICAg\nICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIGlmIChfbXV0YWJsZSAh\nPSBudWxsICYmIF9tdXRhYmxlLmdldChmaWVsZCkpCiAgICAgICAgICAgIHJl\ndHVybiB0cnVlOwoKICAgICAgICAvLyBjb3B5IHRoZSBzYXZlZCBmaWVsZCBv\ndmVyCiAgICAgICAgaWYgKF9jb3B5RmllbGQgPT0gbnVsbCkKICAgICAgICAg\nICAgX2NvcHlGaWVsZCA9IG5ldyBpbnRbMV07CiAgICAgICAgX2NvcHlGaWVs\nZFswXSA9IGZpZWxkOwogICAgICAgIF9zbS5nZXRQZXJzaXN0ZW5jZUNhcGFi\nbGUoKS5wY0NvcHlGaWVsZHMoX2NvcHksIF9jb3B5RmllbGQpOwogICAgICAg\nIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICBwdWJsaWMgT2JqZWN0IGZldGNo\nT2JqZWN0RmllbGQoaW50IGZpZWxkKSB7CiAgICAgICAgLy8gcmV0dXJuIHRo\nZSBjb3BpZWQgZmllbGQgZHVyaW5nIHNhdmUsIG9yIGEgbnVsbCB2YWx1ZSBk\ndXJpbmcgcmVzdG9yZQogICAgICAgIE9iamVjdCB2YWwgPSBfZmllbGQ7CiAg\nICAgICAgX2ZpZWxkID0gbnVsbDsKICAgICAgICByZXR1cm4gdmFsOwogICAg\nfQoKICAgIHB1YmxpYyB2b2lkIHN0b3JlT2JqZWN0RmllbGQoaW50IGZpZWxk\nLCBPYmplY3QgY3VyVmFsKSB7CiAgICAgICAgLy8gY29weSBtdXRhYmxlIGZp\nZWxkcwogICAgICAgIFByb3h5TWFuYWdlciBwcm94eSA9IF9zbS5nZXRDb250\nZXh0KCkuZ2V0Q29uZmlndXJhdGlvbigpLgogICAgICAgICAgICBnZXRQcm94\neU1hbmFnZXJJbnN0YW5jZSgpOwogICAgICAgIEZpZWxkTWV0YURhdGEgZm1k\nID0gX3NtLmdldE1ldGFEYXRhKCkuZ2V0RmllbGQoZmllbGQpOwogICAgICAg\nIHN3aXRjaCAoZm1kLmdldERlY2xhcmVkVHlwZUNvZGUoKSkgewogICAgICAg\nICAgICBjYXNlIEphdmFUeXBlcy5BUlJBWToKICAgICAgICAgICAgICAgIF9m\naWVsZCA9IHByb3h5LmNvcHlBcnJheShjdXJWYWwpOwogICAgICAgICAgICAg\nICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLkNPTExFQ1RJ\nT046CiAgICAgICAgICAgICAgICBfZmllbGQgPSBwcm94eS5jb3B5Q29sbGVj\ndGlvbigoQ29sbGVjdGlvbikgY3VyVmFsKTsKICAgICAgICAgICAgICAgIGJy\nZWFrOwogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5NQVA6CiAgICAgICAg\nICAgICAgICBfZmllbGQgPSBwcm94eS5jb3B5TWFwKChNYXApIGN1clZhbCk7\nCiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSBKYXZh\nVHlwZXMuREFURToKICAgICAgICAgICAgICAgIF9maWVsZCA9IHByb3h5LmNv\ncHlEYXRlKChEYXRlKSBjdXJWYWwpOwogICAgICAgICAgICAgICAgYnJlYWs7\nCiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLk9CSkVDVDoKICAgICAgICAg\nICAgICAgIF9maWVsZCA9IHByb3h5LmNvcHlDdXN0b20oY3VyVmFsKTsKICAg\nICAgICAgICAgICAgIGlmIChfZmllbGQgPT0gbnVsbCkKICAgICAgICAgICAg\nICAgICAgICBfZmllbGQgPSBjdXJWYWw7CiAgICAgICAgICAgICAgICBicmVh\nazsKICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAgIF9maWVs\nZCA9IGN1clZhbDsKICAgICAgICB9CgogICAgICAgIC8vIGlmIHdlIGNvdWxk\nbid0IGdldCBhIGNvcHkgb2YgdGhlIHNjbywgYWN0IGxpa2UgaXQgd2Fzbid0\nIHNhdmVkCiAgICAgICAgLy8gc2hvdWxkIHRocm93IGFuIGV4Y2VwdGlvbgog\nICAgICAgIGlmIChjdXJWYWwgIT0gbnVsbCAmJiBfZmllbGQgPT0gbnVsbCkK\nICAgICAgICAgICAgdGhyb3cgbmV3IEludGVybmFsRXhjZXB0aW9uKF9sb2Mu\nZ2V0KCJuby1zYXZlcG9pbnQtY29weSIsIGZtZCkpOwoJfQoKICAgIHByaXZh\ndGUgdm9pZCB3cml0ZU9iamVjdChPYmplY3RPdXRwdXRTdHJlYW0gb29zKSB0\naHJvd3MgSU9FeGNlcHRpb24gewogICAgICAgIG9vcy5kZWZhdWx0V3JpdGVP\nYmplY3QoKTsKICAgICAgICBfc20ud3JpdGVQQyhvb3MsIF9jb3B5KTsKICAg\nIH0KCiAgICBwcml2YXRlIHZvaWQgcmVhZE9iamVjdChPYmplY3RJbnB1dFN0\ncmVhbSBvaXMpCiAgICAgICAgdGhyb3dzIElPRXhjZXB0aW9uLCBDbGFzc05v\ndEZvdW5kRXhjZXB0aW9uIHsKICAgICAgICBvaXMuZGVmYXVsdFJlYWRPYmpl\nY3QoKTsKICAgICAgICBfY29weSA9IF9zbS5yZWFkUEMob2lzKTsKICAgIH0K\nfQo=\n","encoding":"base64"}

