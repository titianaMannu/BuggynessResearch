{"sha":"669af3cf0d78317aebd482cd5a4ed0f89bf013b2","node_id":"MDQ6QmxvYjIwNjM2NDo2NjlhZjNjZjBkNzgzMTdhZWJkNDgyY2Q1YTRlZDBmODliZjAxM2Iy","size":13646,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/669af3cf0d78317aebd482cd5a4ed0f89bf013b2","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YTsKCmltcG9ydCBqYXZh\nLmxhbmcucmVmbGVjdC5GaWVsZDsKaW1wb3J0IGphdmEubGFuZy5yZWZsZWN0\nLk1lbWJlcjsKaW1wb3J0IGphdmEubGFuZy5yZWZsZWN0Lk1ldGhvZDsKaW1w\nb3J0IGphdmEubGFuZy5yZWZsZWN0Lk1vZGlmaWVyOwppbXBvcnQgamF2YS5z\nZWN1cml0eS5BY2Nlc3NDb250cm9sbGVyOwppbXBvcnQgamF2YS5zZWN1cml0\neS5Qcml2aWxlZ2VkQWN0aW9uRXhjZXB0aW9uOwppbXBvcnQgamF2YS51dGls\nLkxpc3Q7CgppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmVuaGFuY2UuUENS\nZWdpc3RyeTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5lbmhhbmNlLlJl\nZmxlY3Rpb247CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLmxvZy5M\nb2c7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuSjJEb1By\naXZIZWxwZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwu\nTG9jYWxpemVyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuSW50\nZXJuYWxFeGNlcHRpb247CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRp\nbC5PcGVuSlBBRXhjZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLnV0aWwuVXNlckV4Y2VwdGlvbjsKCi8qKgogKiBBYnN0cmFjdCBtZXRhZGF0\nYSBkZWZhdWx0cy4KICoKICogQGF1dGhvciBBYmUgV2hpdGUKICovCnB1Ymxp\nYyBhYnN0cmFjdCBjbGFzcyBBYnN0cmFjdE1ldGFEYXRhRGVmYXVsdHMKICAg\nIGltcGxlbWVudHMgTWV0YURhdGFEZWZhdWx0cyB7CgogICAgcHJpdmF0ZSBz\ndGF0aWMgZmluYWwgTG9jYWxpemVyIF9sb2MgPSBMb2NhbGl6ZXIuZm9yUGFj\na2FnZQogICAgICAgIChBYnN0cmFjdE1ldGFEYXRhRGVmYXVsdHMuY2xhc3Mp\nOwoKICAgIHByaXZhdGUgaW50IF9hY2Nlc3MgPSBDbGFzc01ldGFEYXRhLkFD\nQ0VTU19GSUVMRDsKICAgIHByaXZhdGUgaW50IF9pZGVudGl0eSA9IENsYXNz\nTWV0YURhdGEuSURfVU5LTk9XTjsKICAgIHByaXZhdGUgYm9vbGVhbiBfaWdu\nb3JlID0gdHJ1ZTsKICAgIHByaXZhdGUgYm9vbGVhbiBfaW50ZXJmYWNlID0g\ndHJ1ZTsKICAgIHByaXZhdGUgYm9vbGVhbiBfcGNSZWdpc3RyeSA9IHRydWU7\nCiAgICBwcml2YXRlIGludCBfY2FsbGJhY2sgPSBDQUxMQkFDS19SRVRIUk9X\nOwogICAgcHJpdmF0ZSBib29sZWFuIF91bndyYXBwZWQgPSBmYWxzZTsKCiAg\nICAvKioKICAgICAqIFdoZXRoZXIgdG8gYXR0ZW1wdCB0byB1c2UgdGhlIGlu\nZm9ybWF0aW9uIGZyb20gcmVnaXN0ZXJlZCBjbGFzc2VzCiAgICAgKiB0byBw\nb3B1bGF0ZSBtZXRhZGF0YSBkZWZhdWx0cy4gRGVmYXVsdHMgdG8gdHJ1ZS4K\nICAgICAqLwogICAgcHVibGljIGJvb2xlYW4gZ2V0VXNlUENSZWdpc3RyeSgp\nIHsKICAgICAgICByZXR1cm4gX3BjUmVnaXN0cnk7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBXaGV0aGVyIHRvIGF0dGVtcHQgdG8gdXNlIHRoZSBpbmZvcm1h\ndGlvbiBmcm9tIHJlZ2lzdGVyZWQgY2xhc3NlcwogICAgICogdG8gcG9wdWxh\ndGUgbWV0YWRhdGEgZGVmYXVsdHMuIERlZmF1bHRzIHRvIHRydWUuCiAgICAg\nKi8KICAgIHB1YmxpYyB2b2lkIHNldFVzZVBDUmVnaXN0cnkoYm9vbGVhbiBw\nY1JlZ2lzdHJ5KSB7CiAgICAgICAgX3BjUmVnaXN0cnkgPSBwY1JlZ2lzdHJ5\nOwogICAgfQoKICAgIC8qKgogICAgICogVGhlIGRlZmF1bHQgYWNjZXNzIHR5\ncGUgZm9yIGJhc2UgY2xhc3NlcyB3aXRoIEFDQ0VTU19VTktOT1dOLgogICAg\nICogQUNDRVNTX0ZJRUxEIGJ5IGRlZmF1bHQuCiAgICAgKi8KICAgIHB1Ymxp\nYyBpbnQgZ2V0RGVmYXVsdEFjY2Vzc1R5cGUoKSB7CiAgICAgICAgcmV0dXJu\nIF9hY2Nlc3M7CiAgICB9CgogICAgLyoqCiAgICAgKiBUaGUgZGVmYXVsdCBh\nY2Nlc3MgdHlwZSBmb3IgYmFzZSBjbGFzc2VzIHdpdGggQUNDRVNTX1VOS05P\nV04uCiAgICAgKiBBQ0NFU1NfRklFTEQgYnkgZGVmYXVsdC4KICAgICAqLwog\nICAgcHVibGljIHZvaWQgc2V0RGVmYXVsdEFjY2Vzc1R5cGUoaW50IGFjY2Vz\ncykgewogICAgICAgIF9hY2Nlc3MgPSBhY2Nlc3M7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBUaGUgZGVmYXVsdCBpZGVudGl0eSB0eXBlIGZvciB1bm1hcHBl\nZCBjbGFzc2VzIHdpdGhvdXQgcHJpbWFyeSAKICAgICAqIGtleSBmaWVsZHMu\nIElEX1VOS05PV04gYnkgZGVmYXVsdC4KICAgICAqLwogICAgcHVibGljIGlu\ndCBnZXREZWZhdWx0SWRlbnRpdHlUeXBlKCkgewogICAgICAgIHJldHVybiBf\naWRlbnRpdHk7CiAgICB9CgogICAgLyoqCiAgICAgKiBUaGUgZGVmYXVsdCBp\nZGVudGl0eSB0eXBlIGZvciB1bm1hcHBlZCBjbGFzc2VzIHdpdGhvdXQgcHJp\nbWFyeSAKICAgICAqIGtleSBmaWVsZHMuIElEX1VOS05PV04gYnkgZGVmYXVs\ndC4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0RGVmYXVsdElkZW50aXR5\nVHlwZShpbnQgaWRlbnRpdHkpIHsKICAgICAgICBfaWRlbnRpdHkgPSBpZGVu\ndGl0eTsKICAgIH0KCiAgICBwdWJsaWMgaW50IGdldENhbGxiYWNrTW9kZSgp\nIHsKICAgICAgICByZXR1cm4gX2NhbGxiYWNrOwogICAgfQoKICAgIHB1Ymxp\nYyB2b2lkIHNldENhbGxiYWNrTW9kZShpbnQgbW9kZSkgewogICAgICAgIF9j\nYWxsYmFjayA9IG1vZGU7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0Q2Fs\nbGJhY2tNb2RlKGludCBtb2RlLCBib29sZWFuIG9uKSB7CiAgICAgICAgaWYg\nKG9uKQogICAgICAgICAgICBfY2FsbGJhY2sgfD0gbW9kZTsKICAgICAgICBl\nbHNlCiAgICAgICAgICAgIF9jYWxsYmFjayAmPSB+bW9kZTsKICAgIH0KCiAg\nICBwdWJsaWMgYm9vbGVhbiBnZXRDYWxsYmFja3NCZWZvcmVMaXN0ZW5lcnMo\naW50IHR5cGUpIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAg\ncHVibGljIGJvb2xlYW4gaXNEZWNsYXJlZEludGVyZmFjZVBlcnNpc3RlbnQo\nKSB7CiAgICAgICAgcmV0dXJuIF9pbnRlcmZhY2U7CiAgICB9CgogICAgcHVi\nbGljIHZvaWQgc2V0RGVjbGFyZWRJbnRlcmZhY2VQZXJzaXN0ZW50KGJvb2xl\nYW4gcGVycykgewogICAgICAgIF9pbnRlcmZhY2UgPSBwZXJzOwogICAgfQoK\nICAgIHB1YmxpYyBib29sZWFuIGlzRGF0YVN0b3JlT2JqZWN0SWRGaWVsZFVu\nd3JhcHBlZCgpIHsKICAgICAgICByZXR1cm4gX3Vud3JhcHBlZDsKICAgIH0K\nCiAgICBwdWJsaWMgdm9pZCBzZXREYXRhU3RvcmVPYmplY3RJZEZpZWxkVW53\ncmFwcGVkKGJvb2xlYW4gdW53cmFwcGVkKSB7CiAgICAgICAgX3Vud3JhcHBl\nZCA9IHVud3JhcHBlZDsKICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBnZXRJ\nZ25vcmVOb25QZXJzaXN0ZW50KCkgewogICAgICAgIHJldHVybiBfaWdub3Jl\nOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldElnbm9yZU5vblBlcnNpc3Rl\nbnQoYm9vbGVhbiBpZ25vcmUpIHsKICAgICAgICBfaWdub3JlID0gaWdub3Jl\nOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHBvcHVsYXRlKENsYXNzTWV0YURh\ndGEgbWV0YSwgaW50IGFjY2VzcykgewogICAgICAgIGlmIChtZXRhLmdldERl\nc2NyaWJlZFR5cGUoKSA9PSBPYmplY3QuY2xhc3MpCiAgICAgICAgICAgIHJl\ndHVybjsKCiAgICAgICAgaWYgKGFjY2VzcyA9PSBDbGFzc01ldGFEYXRhLkFD\nQ0VTU19VTktOT1dOKSB7CiAgICAgICAgICAgIC8vIHdlIGRvIG5vdCBhbGxv\ndyB1c2luZyBib3RoIGZpZWxkIGFuZCBtZXRob2QgYWNjZXNzIGF0CiAgICAg\nICAgICAgIC8vIHRoZSBzYW1lIHRpbWUKICAgICAgICAgICAgYWNjZXNzID0g\nZ2V0QWNjZXNzVHlwZShtZXRhKTsKICAgICAgICAgICAgaWYgKChhY2Nlc3Mg\nJiBDbGFzc01ldGFEYXRhLkFDQ0VTU19GSUVMRCkgIT0gMAogICAgICAgICAg\nICAgICAgJiYgKGFjY2VzcyAmIENsYXNzTWV0YURhdGEuQUNDRVNTX1BST1BF\nUlRZKSAhPSAwKSB7CiAgICAgICAgICAgICAgICBMaXN0IGZpZWxkcyA9IGdl\ndEZpZWxkQWNjZXNzTmFtZXMobWV0YSk7CiAgICAgICAgICAgICAgICBMaXN0\nIHByb3BzID0gZ2V0UHJvcGVydHlBY2Nlc3NOYW1lcyhtZXRhKTsKICAgICAg\nICAgICAgICAgIGlmIChmaWVsZHMgIT0gbnVsbCB8fCBwcm9wcyAhPSBudWxs\nKQogICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBVc2VyRXhjZXB0aW9u\nKF9sb2MuZ2V0KAogICAgICAgICAgICAgICAgICAgICAgICAiYWNjZXNzLWZp\nZWxkLWFuZC1wcm9wLWhpbnRzIiwKICAgICAgICAgICAgICAgICAgICAgICAg\nbWV0YS5nZXREZXNjcmliZWRUeXBlKCkuZ2V0TmFtZSgpLCBmaWVsZHMsIHBy\nb3BzKSk7CiAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAg\nICAgdGhyb3cgbmV3IFVzZXJFeGNlcHRpb24oX2xvYy5nZXQoImFjY2Vzcy1m\naWVsZC1hbmQtcHJvcCIsCiAgICAgICAgICAgICAgICAgICAgICAgIG1ldGEu\nZ2V0RGVzY3JpYmVkVHlwZSgpLmdldE5hbWUoKSkpOwogICAgICAgICAgICB9\nCiAgICAgICAgfQogICAgICAgIG1ldGEuc2V0QWNjZXNzVHlwZShhY2Nlc3Mp\nOwoKICAgICAgICBMb2cgbG9nID0gbWV0YS5nZXRSZXBvc2l0b3J5KCkuZ2V0\nTG9nKCk7CiAgICAgICAgaWYgKGxvZy5pc1RyYWNlRW5hYmxlZCgpKQogICAg\nICAgICAgICBsb2cudHJhY2UoX2xvYy5nZXQoImdlbi1tZXRhIiwgbWV0YSkp\nOwogICAgICAgIGlmICghX3BjUmVnaXN0cnkgfHwgIXBvcHVsYXRlRnJvbVBD\nUmVnaXN0cnkobWV0YSkpIHsKICAgICAgICAgICAgaWYgKGxvZy5pc1RyYWNl\nRW5hYmxlZCgpKQogICAgICAgICAgICAgICAgbG9nLnRyYWNlKF9sb2MuZ2V0\nKCJtZXRhLXJlZmxlY3QiKSk7CiAgICAgICAgICAgIHBvcHVsYXRlRnJvbVJl\nZmxlY3Rpb24obWV0YSk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAg\nICogUG9wdWxhdGUgaW5pdGlhbCBmaWVsZCBkYXRhLiBEb2VzIG5vdGhpbmcg\nYnkgZGVmYXVsdC4KICAgICAqLwogICAgcHJvdGVjdGVkIHZvaWQgcG9wdWxh\ndGUoRmllbGRNZXRhRGF0YSBmbWQpIHsKICAgIH0KCiAgICAvKioKICAgICAq\nIFBvcHVsYXRlIHRoZSBnaXZlbiBtZXRhZGF0YSB1c2luZyB0aGUge0BsaW5r\nIFBDUmVnaXN0cnl9LgogICAgICovCiAgICBwcml2YXRlIGJvb2xlYW4gcG9w\ndWxhdGVGcm9tUENSZWdpc3RyeShDbGFzc01ldGFEYXRhIG1ldGEpIHsKICAg\nICAgICBDbGFzcyBjbHMgPSBtZXRhLmdldERlc2NyaWJlZFR5cGUoKTsKICAg\nICAgICBpZiAoIVBDUmVnaXN0cnkuaXNSZWdpc3RlcmVkKGNscykpCiAgICAg\nICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB0cnkgewogICAgICAgICAg\nICBTdHJpbmdbXSBmaWVsZE5hbWVzID0gUENSZWdpc3RyeS5nZXRGaWVsZE5h\nbWVzKGNscyk7CiAgICAgICAgICAgIENsYXNzW10gZmllbGRUeXBlcyA9IFBD\nUmVnaXN0cnkuZ2V0RmllbGRUeXBlcyhjbHMpOwogICAgICAgICAgICBNZW1i\nZXIgbWVtYmVyOwogICAgICAgICAgICBGaWVsZE1ldGFEYXRhIGZtZDsKICAg\nICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBmaWVsZE5hbWVzLmxlbmd0\naDsgaSArKykgewogICAgICAgICAgICAgICAgaWYgKG1ldGEuZ2V0QWNjZXNz\nVHlwZSgpID09IENsYXNzTWV0YURhdGEuQUNDRVNTX0ZJRUxEKQogICAgICAg\nICAgICAgICAgICAgIG1lbWJlciA9IChGaWVsZCkgQWNjZXNzQ29udHJvbGxl\nci5kb1ByaXZpbGVnZWQoCiAgICAgICAgICAgICAgICAgICAgICAgIEoyRG9Q\ncml2SGVscGVyLmdldERlY2xhcmVkRmllbGRBY3Rpb24oCiAgICAgICAgICAg\nICAgICAgICAgICAgICAgICBjbHMsZmllbGROYW1lc1tpXSkpOyAKICAgICAg\nICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICBtZW1iZXIgPSBS\nZWZsZWN0aW9uLmZpbmRHZXR0ZXIobWV0YS5nZXREZXNjcmliZWRUeXBlKCks\nCiAgICAgICAgICAgICAgICAgICAgICAgIGZpZWxkTmFtZXNbaV0sIHRydWUp\nOwogICAgICAgICAgICAgICAgZm1kID0gbWV0YS5hZGREZWNsYXJlZEZpZWxk\nKGZpZWxkTmFtZXNbaV0sIGZpZWxkVHlwZXNbaV0pOwogICAgICAgICAgICAg\nICAgZm1kLmJhY2tpbmdNZW1iZXIobWVtYmVyKTsKICAgICAgICAgICAgICAg\nIHBvcHVsYXRlKGZtZCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0\ndXJuIHRydWU7CiAgICAgICAgfSBjYXRjaCAoT3BlbkpQQUV4Y2VwdGlvbiBr\nZSkgewogICAgICAgICAgICB0aHJvdyBrZTsKICAgICAgICB9IGNhdGNoIChF\neGNlcHRpb24gZSkgewogICAgICAgICAgICBpZiAoZSBpbnN0YW5jZW9mIFBy\naXZpbGVnZWRBY3Rpb25FeGNlcHRpb24pCiAgICAgICAgICAgICAgICBlID0g\nKChQcml2aWxlZ2VkQWN0aW9uRXhjZXB0aW9uKSBlKS5nZXRFeGNlcHRpb24o\nKTsKICAgICAgICAgICAgdGhyb3cgbmV3IFVzZXJFeGNlcHRpb24oZSk7CiAg\nICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogR2VuZXJhdGUgdGhlIGdp\ndmVuIG1ldGFkYXRhIHVzaW5nIHJlZmxlY3Rpb24uCiAgICAgKi8KICAgIHBy\naXZhdGUgdm9pZCBwb3B1bGF0ZUZyb21SZWZsZWN0aW9uKENsYXNzTWV0YURh\ndGEgbWV0YSkgewogICAgICAgIE1lbWJlcltdIG1lbWJlcnM7CiAgICAgICAg\nYm9vbGVhbiBpZmFjZSA9IG1ldGEuZ2V0RGVzY3JpYmVkVHlwZSgpLmlzSW50\nZXJmYWNlKCk7CiAgICAgICAgaWYgKG1ldGEuZ2V0QWNjZXNzVHlwZSgpID09\nIENsYXNzTWV0YURhdGEuQUNDRVNTX0ZJRUxEICYmICFpZmFjZSkKICAgICAg\nICAgICAgbWVtYmVycyA9IChGaWVsZFtdKSBBY2Nlc3NDb250cm9sbGVyLmRv\nUHJpdmlsZWdlZCgKICAgICAgICAgICAgICAgIEoyRG9Qcml2SGVscGVyLmdl\ndERlY2xhcmVkRmllbGRzQWN0aW9uKAogICAgICAgICAgICAgICAgICAgIG1l\ndGEuZ2V0RGVzY3JpYmVkVHlwZSgpKSk7IAogICAgICAgIGVsc2UKICAgICAg\nICAgICAgbWVtYmVycyA9IChNZXRob2RbXSkgQWNjZXNzQ29udHJvbGxlci5k\nb1ByaXZpbGVnZWQoCiAgICAgICAgICAgICAgICBKMkRvUHJpdkhlbHBlci5n\nZXREZWNsYXJlZE1ldGhvZHNBY3Rpb24oCiAgICAgICAgICAgICAgICAgICAg\nbWV0YS5nZXREZXNjcmliZWRUeXBlKCkpKTsgCgogICAgICAgIGludCBtb2Rz\nOwogICAgICAgIFN0cmluZyBuYW1lOwogICAgICAgIGJvb2xlYW4gZGVmOwog\nICAgICAgIEZpZWxkTWV0YURhdGEgZm1kOwogICAgICAgIGZvciAoaW50IGkg\nPSAwOyBpIDwgbWVtYmVycy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBt\nb2RzID0gbWVtYmVyc1tpXS5nZXRNb2RpZmllcnMoKTsKICAgICAgICAgICAg\naWYgKE1vZGlmaWVyLmlzU3RhdGljKG1vZHMpIHx8IE1vZGlmaWVyLmlzRmlu\nYWwobW9kcykpCiAgICAgICAgICAgICAgICBjb250aW51ZTsKCiAgICAgICAg\nICAgIG5hbWUgPSBnZXRGaWVsZE5hbWUobWVtYmVyc1tpXSk7CiAgICAgICAg\nICAgIGlmIChuYW1lID09IG51bGwgfHwgaXNSZXNlcnZlZEZpZWxkTmFtZShu\nYW1lKSkKICAgICAgICAgICAgICAgIGNvbnRpbnVlOwoKICAgICAgICAgICAg\nZGVmID0gaXNEZWZhdWx0UGVyc2lzdGVudChtZXRhLCBtZW1iZXJzW2ldLCBu\nYW1lKTsKICAgICAgICAgICAgaWYgKCFkZWYgJiYgX2lnbm9yZSkKICAgICAg\nICAgICAgICAgIGNvbnRpbnVlOwoKICAgICAgICAgICAgLy8gcGFzc2VkIHRo\nZSB0ZXN0czsgcGVyc2lzdGVudCB0eXBlIC0tIHdlIGNvbnN0cnVjdCB3aXRo\nCiAgICAgICAgICAgIC8vIE9iamVjdC5jbGFzcyBiZWNhdXNlIHNldHRpbmcg\nYmFja2luZyBtZW1iZXIgd2lsbCBzZXQgcHJvcGVyCiAgICAgICAgICAgIC8v\nIHR5cGUgYW55d2F5CiAgICAgICAgICAgIGZtZCA9IG1ldGEuYWRkRGVjbGFy\nZWRGaWVsZChuYW1lLCBPYmplY3QuY2xhc3MpOwogICAgICAgICAgICBmbWQu\nYmFja2luZ01lbWJlcihtZW1iZXJzW2ldKTsKICAgICAgICAgICAgaWYgKCFk\nZWYpIHsKICAgICAgICAgICAgICAgIGZtZC5zZXRFeHBsaWNpdCh0cnVlKTsK\nICAgICAgICAgICAgICAgIGZtZC5zZXRNYW5hZ2VtZW50KEZpZWxkTWV0YURh\ndGEuTUFOQUdFX05PTkUpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHBv\ncHVsYXRlKGZtZCk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICog\nUmV0dXJuIHRoZSBhY2Nlc3MgdHlwZSBvZiB0aGUgZ2l2ZW4gbWV0YWRhdGEu\nIE1heSBiZSBhIGJpdHdpc2UKICAgICAqIGNvbWJpbmF0aW9uIG9mIGZpZWxk\nIGFuZCBwcm9wZXJ0eSBhY2Nlc3MgY29uc3RhbnRzLCBvciBBQ0NFU1NfVU5L\nTk9XTi4KICAgICAqIFJldHVybnMgQUNDRVNTX0ZJRUxEIGJ5IGRlZmF1bHQu\nCiAgICAgKi8KICAgIHByb3RlY3RlZCBpbnQgZ2V0QWNjZXNzVHlwZShDbGFz\nc01ldGFEYXRhIG1ldGEpIHsKICAgICAgICBpZiAobWV0YS5nZXREZXNjcmli\nZWRUeXBlKCkuaXNJbnRlcmZhY2UoKSkKICAgICAgICAgICAgcmV0dXJuIENs\nYXNzTWV0YURhdGEuQUNDRVNTX1BST1BFUlRZOwogICAgICAgIGVsc2UKICAg\nICAgICAgICAgcmV0dXJuIENsYXNzTWV0YURhdGEuQUNDRVNTX0ZJRUxEOwog\nICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRoZSBsaXN0IG9mIGZpZWxk\ncyBpbiA8Y29kZT5tZXRhPC9jb2RlPiB0aGF0IHVzZSBmaWVsZCBhY2Nlc3Ms\nCiAgICAgKiBvciA8Y29kZT5udWxsPC9jb2RlPiBpZiBhIGxpc3Qgb2YgZmll\nbGRzIGlzIHVub2J0YWluYWJsZS4gQW4gZW1wdHkgbGlzdAogICAgICogc2hv\ndWxkIGJlIHJldHVybmVkIGlmIHRoZSBsaXN0IG9mIGZpZWxkcyBpcyBvYnRh\naW5hYmxlLCBidXQgdGhlcmUKICAgICAqIGhhcHBlbnMgdG8gYmUgbm8gZmll\nbGQgYWNjZXNzIGluIDxjb2RlPm1ldGE8L2NvZGU+LgogICAgICoKICAgICAq\nIFRoaXMgaXMgdXNlZCBmb3IgZXJyb3IgcmVwb3J0aW5nIHB1cnBvc2VzIG9u\nbHksIHNvIG5lZWQgbm90IGJlIGVmZmljaWVudC4KICAgICAqCiAgICAgKiBU\naGlzIGltcGxlbWVudGF0aW9uIHJldHVybnMgPGNvZGU+bnVsbDwvY29kZT4u\nCiAgICAgKi8KICAgIHByb3RlY3RlZCBMaXN0IGdldEZpZWxkQWNjZXNzTmFt\nZXMoQ2xhc3NNZXRhRGF0YSBtZXRhKSB7CiAgICAgICAgcmV0dXJuIG51bGw7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIGxpc3Qgb2YgbWV0\naG9kcyBpbiA8Y29kZT5tZXRhPC9jb2RlPiB0aGF0IHVzZSBwcm9wZXJ0eSBh\nY2Nlc3MsCiAgICAgKiBvciA8Y29kZT5udWxsPC9jb2RlPiBpZiBhIGxpc3Qg\nb2YgbWV0aG9kcyBpcyB1bm9idGFpbmFibGUuIEFuIGVtcHR5IGxpc3QKICAg\nICAqIHNob3VsZCBiZSByZXR1cm5lZCBpZiB0aGUgbGlzdCBvZiBtZXRob2Rz\nIGlzIG9idGFpbmFibGUsIGJ1dCB0aGVyZQogICAgICogaGFwcGVucyB0byBi\nZSBubyBwcm9wZXJ0eSBhY2Nlc3MgaW4gPGNvZGU+bWV0YTwvY29kZT4uCiAg\nICAgKgogICAgICogVGhpcyBpcyB1c2VkIGZvciBlcnJvciByZXBvcnRpbmcg\ncHVycG9zZXMgb25seSwgc28gbmVlZCBub3QgYmUgZWZmaWNpZW50LgogICAg\nICoKICAgICAqIFRoaXMgaW1wbGVtZW50YXRpb24gcmV0dXJucyA8Y29kZT5u\ndWxsPC9jb2RlPi4KICAgICAqLwogICAgcHJvdGVjdGVkIExpc3QgZ2V0UHJv\ncGVydHlBY2Nlc3NOYW1lcyhDbGFzc01ldGFEYXRhIG1ldGEpIHsKICAgICAg\nICByZXR1cm4gbnVsbDsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0\naGUgZmllbGQgbmFtZSBmb3IgdGhlIGdpdmVuIG1lbWJlci4gVGhpcyB3aWxs\nIG9ubHkgYmUgaW52b2tlZAogICAgICogb24gbWVtYmVycyBvZiB0aGUgcmln\naHQgdHlwZSAoZmllbGQgdnMuIG1ldGhvZCkuIFJldHVybiBudWxsIGlmIHRo\nZQogICAgICogbWVtYmVyIGNhbm5vdCBiZSBtYW5hZ2VkLiBEZWZhdWx0IGJl\naGF2aW9yOiBGb3IgZmllbGRzLCByZXR1cm5zIHRoZQogICAgICogZmllbGQg\nbmFtZS4gRm9yIGdldHRlciBtZXRob2RzLCByZXR1cm5zIHRoZSBtaW51cyAi\nZ2V0IiBvciAiaXMiIHdpdGgKICAgICAqIHRoZSBuZXh0IGxldHRlciBsb3dl\nci1jYXNlZC4gRm9yIG90aGVyIG1ldGhvZHMsIHJldHVybnMgbnVsbC4KICAg\nICAqLwogICAgcHJvdGVjdGVkIFN0cmluZyBnZXRGaWVsZE5hbWUoTWVtYmVy\nIG1lbWJlcikgewogICAgICAgIGlmIChtZW1iZXIgaW5zdGFuY2VvZiBGaWVs\nZCkKICAgICAgICAgICAgcmV0dXJuIG1lbWJlci5nZXROYW1lKCk7CgogICAg\nICAgIE1ldGhvZCBtZXRoID0gKE1ldGhvZCkgbWVtYmVyOwogICAgICAgIGlm\nIChtZXRoLmdldFJldHVyblR5cGUoKSA9PSB2b2lkLmNsYXNzCiAgICAgICAg\nICAgIHx8IG1ldGguZ2V0UGFyYW1ldGVyVHlwZXMoKS5sZW5ndGggIT0gMCkK\nICAgICAgICAgICAgcmV0dXJuIG51bGw7CgogICAgICAgIFN0cmluZyBuYW1l\nID0gbWV0aC5nZXROYW1lKCk7CiAgICAgICAgaWYgKG5hbWUuc3RhcnRzV2l0\naCgiZ2V0IikgJiYgbmFtZS5sZW5ndGgoKSA+IDMpCiAgICAgICAgICAgIG5h\nbWUgPSBuYW1lLnN1YnN0cmluZygzKTsKICAgICAgICBlbHNlIGlmICgobWV0\naC5nZXRSZXR1cm5UeXBlKCkgPT0gYm9vbGVhbi5jbGFzcwogICAgICAgICAg\nICB8fCBtZXRoLmdldFJldHVyblR5cGUoKSA9PSBCb29sZWFuLmNsYXNzKQog\nICAgICAgICAgICAmJiBuYW1lLnN0YXJ0c1dpdGgoImlzIikgJiYgbmFtZS5s\nZW5ndGgoKSA+IDIpCiAgICAgICAgICAgIG5hbWUgPSBuYW1lLnN1YnN0cmlu\nZygyKTsKICAgICAgICBlbHNlCiAgICAgICAgICAgIHJldHVybiBudWxsOwoK\nICAgICAgICBpZiAobmFtZS5sZW5ndGgoKSA9PSAxKQogICAgICAgICAgICBy\nZXR1cm4gbmFtZS50b0xvd2VyQ2FzZSgpOwogICAgICAgIHJldHVybiBDaGFy\nYWN0ZXIudG9Mb3dlckNhc2UobmFtZS5jaGFyQXQoMCkpICsgbmFtZS5zdWJz\ndHJpbmcoMSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm5zIHRydWUg\naWYgdGhlIGdpdmVuIGZpZWxkIG5hbWUgaXMgcmVzZXJ2ZWQgZm9yIHVubWFu\nYWdlZCBmaWVsZHMuCiAgICAgKi8KICAgIHByb3RlY3RlZCBib29sZWFuIGlz\nUmVzZXJ2ZWRGaWVsZE5hbWUoU3RyaW5nIG5hbWUpIHsKICAgICAgICAvLyBu\nYW1lcyB1c2VkIGJ5IGVuaGFuY2VycwogICAgICAgIHJldHVybiBuYW1lLnN0\nYXJ0c1dpdGgoIm9wZW5qcGEiKSB8fCBuYW1lLnN0YXJ0c1dpdGgoImpkbyIp\nOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRydWUgaWYgdGhlIGdp\ndmVuIG1lbWJlciBpcyBwZXJzaXN0ZW50IGJ5IGRlZmF1bHQuIFRoaXMgd2ls\nbAogICAgICogb25seSBiZSBpbnZva2VkIG9uIG1lbWJlcnMgb2YgdGhlIHJp\nZ2h0IHR5cGUgKGZpZWxkIHZzLiBtZXRob2QpLgogICAgICogUmV0dXJucyBm\nYWxzZSBpZiBtZW1iZXIgaXMgc3RhdGljIG9yIGZpbmFsIGJ5IGRlZmF1bHQu\nCiAgICAgKgogICAgICogQHBhcmFtIG5hbWUgdGhlIGZpZWxkIG5hbWUgZnJv\nbSB7QGxpbmsgI2dldEZpZWxkTmFtZX0KICAgICAqLwogICAgcHJvdGVjdGVk\nIGFic3RyYWN0IGJvb2xlYW4gaXNEZWZhdWx0UGVyc2lzdGVudChDbGFzc01l\ndGFEYXRhIG1ldGEsCiAgICAgICAgTWVtYmVyIG1lbWJlciwgU3RyaW5nIG5h\nbWUpOwoKICAgIHB1YmxpYyBNZW1iZXIgZ2V0QmFja2luZ01lbWJlcihGaWVs\nZE1ldGFEYXRhIGZtZCkgewogICAgICAgIGlmIChmbWQgPT0gbnVsbCkKICAg\nICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgdHJ5IHsKICAgICAgICAg\nICAgLy8jIyMgbm90ZSB0aGF0IHdlIG1pZ2h0IG5vdCBoYXZlIGFjY2VzcyB0\nbyBkZWNsYXJpbmcgbWV0YWRhdGEgeWV0CiAgICAgICAgICAgIC8vIyMjICh0\naGlzIGNvdWxkIGJlIHVzZWQgZHVyaW5nIHBhcnNlKSwgc28gd2UgaGF2ZSB0\nbyBzZXR0bGUgZm9yCiAgICAgICAgICAgIC8vIyMjIGRlZmluaW5nLiAgY291\nbGQgY2F1c2UgcHJvYmxlbXMgaWYgbWFwcyBhIHN1cGVyY2xhc3MgZmllbGQK\nICAgICAgICAgICAgLy8jIyMgd2hlcmUgdGhlIHN1cGVyY2xhc3MgdXNlcyBh\nIGRpZmZlcmVudCBhY2Nlc3MgdHlwZQogICAgICAgICAgICBpZiAoZm1kLmdl\ndERlZmluaW5nTWV0YURhdGEoKS5nZXRBY2Nlc3NUeXBlKCkgPT0KICAgICAg\nICAgICAgICAgIENsYXNzTWV0YURhdGEuQUNDRVNTX0ZJRUxEKQogICAgICAg\nICAgICAgICAgcmV0dXJuIChGaWVsZCkgQWNjZXNzQ29udHJvbGxlci5kb1By\naXZpbGVnZWQoCiAgICAgICAgICAgICAgICAgICAgSjJEb1ByaXZIZWxwZXIu\nZ2V0RGVjbGFyZWRGaWVsZEFjdGlvbigKICAgICAgICAgICAgICAgICAgICAg\nICAgZm1kLmdldERlY2xhcmluZ1R5cGUoKSwgZm1kLmdldE5hbWUoKSkpOyAK\nICAgICAgICAgICAgcmV0dXJuIFJlZmxlY3Rpb24uZmluZEdldHRlcihmbWQu\nZ2V0RGVjbGFyaW5nVHlwZSgpLCBmbWQuZ2V0TmFtZSgpLAogICAgICAgICAg\nICAgICAgdHJ1ZSk7CiAgICAgICAgfSBjYXRjaCAoT3BlbkpQQUV4Y2VwdGlv\nbiBrZSkgewogICAgICAgICAgICB0aHJvdyBrZTsKICAgICAgICB9IGNhdGNo\nIChFeGNlcHRpb24gZSkgewogICAgICAgICAgICBpZiAoZSBpbnN0YW5jZW9m\nIFByaXZpbGVnZWRBY3Rpb25FeGNlcHRpb24pCiAgICAgICAgICAgICAgICBl\nID0gKChQcml2aWxlZ2VkQWN0aW9uRXhjZXB0aW9uKSBlKS5nZXRFeGNlcHRp\nb24oKTsKICAgICAgICAgICAgdGhyb3cgbmV3IEludGVybmFsRXhjZXB0aW9u\nKGUpOwogICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMgQ2xhc3MgZ2V0VW5p\nbXBsZW1lbnRlZEV4Y2VwdGlvblR5cGUoKSB7CiAgICAgICAgcmV0dXJuIFVu\nc3VwcG9ydGVkT3BlcmF0aW9uRXhjZXB0aW9uLmNsYXNzOwogICAgfQoKICAg\nIC8qKgogICAgICogSGVscGVyIG1ldGhvZDsgcmV0dXJucyB0cnVlIGlmIHRo\nZSBnaXZlbiBjbGFzcyBhcHBlYXJzIHRvIGJlCiAgICAgKiB1c2VyLWRlZmlu\nZWQuCiAgICAgKi8KICAgIHByb3RlY3RlZCBzdGF0aWMgYm9vbGVhbiBpc1Vz\nZXJEZWZpbmVkKENsYXNzIGNscykgewogICAgICAgIHJldHVybiBjbHMgIT0g\nbnVsbCAmJiAhY2xzLmdldE5hbWUoKS5zdGFydHNXaXRoKCJqYXZhLiIpCiAg\nICAgICAgICAgICYmICFjbHMuZ2V0TmFtZSgpLnN0YXJ0c1dpdGggKCJqYXZh\neC4iKTsKCX0KfQo=\n","encoding":"base64"}

