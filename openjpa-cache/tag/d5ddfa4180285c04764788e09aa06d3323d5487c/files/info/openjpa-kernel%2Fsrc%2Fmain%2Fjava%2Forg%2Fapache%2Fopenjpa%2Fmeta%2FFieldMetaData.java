{"sha":"467efdbfd952e18aa6e886f69f0ac7adb4814546","node_id":"MDQ6QmxvYjIwNjM2NDo0NjdlZmRiZmQ5NTJlMThhYTZlODg2ZjY5ZjBhYzdhZGI0ODE0NTQ2","size":68236,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/467efdbfd952e18aa6e886f69f0ac7adb4814546","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YTsKCmltcG9ydCBqYXZh\nLmlvLkV4dGVybmFsaXphYmxlOwppbXBvcnQgamF2YS5pby5JT0V4Y2VwdGlv\nbjsKaW1wb3J0IGphdmEuaW8uT2JqZWN0SW5wdXQ7CmltcG9ydCBqYXZhLmlv\nLk9iamVjdE91dHB1dDsKaW1wb3J0IGphdmEuaW8uU2VyaWFsaXphYmxlOwpp\nbXBvcnQgamF2YS5sYW5nLnJlZmxlY3QuQ29uc3RydWN0b3I7CmltcG9ydCBq\nYXZhLmxhbmcucmVmbGVjdC5GaWVsZDsKaW1wb3J0IGphdmEubGFuZy5yZWZs\nZWN0Lkludm9jYXRpb25UYXJnZXRFeGNlcHRpb247CmltcG9ydCBqYXZhLmxh\nbmcucmVmbGVjdC5NZW1iZXI7CmltcG9ydCBqYXZhLmxhbmcucmVmbGVjdC5N\nZXRob2Q7CmltcG9ydCBqYXZhLmxhbmcucmVmbGVjdC5Nb2RpZmllcjsKaW1w\nb3J0IGphdmEuc2VjdXJpdHkuQWNjZXNzQ29udHJvbGxlcjsKaW1wb3J0IGph\ndmEuc2VjdXJpdHkuUHJpdmlsZWdlZEFjdGlvbkV4Y2VwdGlvbjsKaW1wb3J0\nIGphdmEudXRpbC5BcnJheUxpc3Q7CmltcG9ydCBqYXZhLnV0aWwuQ2FsZW5k\nYXI7CmltcG9ydCBqYXZhLnV0aWwuQ29sbGVjdGlvbjsKaW1wb3J0IGphdmEu\ndXRpbC5Db2xsZWN0aW9uczsKaW1wb3J0IGphdmEudXRpbC5Db21wYXJhdG9y\nOwppbXBvcnQgamF2YS51dGlsLkhhc2hNYXA7CmltcG9ydCBqYXZhLnV0aWwu\nSGFzaFNldDsKaW1wb3J0IGphdmEudXRpbC5JdGVyYXRvcjsKaW1wb3J0IGph\ndmEudXRpbC5MaXN0OwppbXBvcnQgamF2YS51dGlsLk1hcDsKaW1wb3J0IGph\ndmEudXRpbC5Qcm9wZXJ0aWVzOwppbXBvcnQgamF2YS51dGlsLlNldDsKaW1w\nb3J0IGphdmEudXRpbC5UaW1lWm9uZTsKCmltcG9ydCBvcmcuYXBhY2hlLmNv\nbW1vbnMuY29sbGVjdGlvbnMuY29tcGFyYXRvcnMuQ29tcGFyYXRvckNoYWlu\nOwppbXBvcnQgb3JnLmFwYWNoZS5jb21tb25zLmxhbmcuU3RyaW5nVXRpbHM7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuY29uZi5PcGVuSlBBQ29uZmln\ndXJhdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuT3Bl\nbkpQQVN0YXRlTWFuYWdlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5r\nZXJuZWwuU3RvcmVDb250ZXh0OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLmxpYi5jb25mLkNvbmZpZ3VyYXRpb25zOwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLmxpYi5sb2cuTG9nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLmxpYi51dGlsLkoyRG9Qcml2SGVscGVyOwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLmxpYi51dGlsLkphdmFWZXJzaW9uczsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5saWIudXRpbC5Mb2NhbGl6ZXI7CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEubGliLnV0aWwuT3B0aW9uczsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5saWIueG1sLkNvbW1lbnRhYmxlOwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLnV0aWwuRXhjZXB0aW9uczsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS51dGlsLkludGVybmFsRXhjZXB0aW9uOwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLnV0aWwuTWV0YURhdGFFeGNlcHRpb247CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5PcGVuSlBBRXhjZXB0aW9uOwpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuVW5zdXBwb3J0ZWRFeGNl\ncHRpb247CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5JbXBsSGVs\ncGVyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuVXNlckV4Y2Vw\ndGlvbjsKCmltcG9ydCBzZXJwLnV0aWwuU3RyaW5nczsKCi8qKgogKiBNZXRh\nZGF0YSBmb3IgYSBtYW5hZ2VkIGNsYXNzIGZpZWxkLgogKgogKiBAYXV0aG9y\nIEFiZSBXaGl0ZQogKi8KcHVibGljIGNsYXNzIEZpZWxkTWV0YURhdGEKICAg\nIGV4dGVuZHMgRXh0ZW5zaW9ucwogICAgaW1wbGVtZW50cyBWYWx1ZU1ldGFE\nYXRhLCBNZXRhRGF0YUNvbnRleHQsIE1ldGFEYXRhTW9kZXMsIENvbW1lbnRh\nYmxlIHsKICAgIAogICAgLyoqCiAgICAgKiBDb25zdGFudCBzcGVjaWZ5aW5n\nIHRoYXQgbm8gbnVsbC12YWx1ZSB3YXMgZ2l2ZW4uCiAgICAgKi8KICAgIHB1\nYmxpYyBzdGF0aWMgZmluYWwgaW50IE5VTExfVU5TRVQgPSAtMTsKCiAgICAv\nKioKICAgICAqIENvbnN0YW50IHNwZWNpZnlpbmcgdG8gdXNlIGEgZGF0YXN0\nb3JlIG51bGwgdG8gcGVyc2lzdCBudWxsIHZhbHVlcwogICAgICogaW4gb2Jq\nZWN0IGZpZWxkcy4KICAgICAqLwogICAgcHVibGljIHN0YXRpYyBmaW5hbCBp\nbnQgTlVMTF9OT05FID0gMDsKCiAgICAvKioKICAgICAqIENvbnN0YW50IHNw\nZWNpZnlpbmcgdG8gdXNlIGEgZGF0YXN0b3JlIGRlZmF1bHQgdmFsdWUgdG8g\ncGVyc2lzdCBudWxsCiAgICAgKiB2YWx1ZXMgaW4gb2JqZWN0IGZpZWxkcy4K\nICAgICAqLwogICAgcHVibGljIHN0YXRpYyBmaW5hbCBpbnQgTlVMTF9ERUZB\nVUxUID0gMTsKCiAgICAvKioKICAgICAqIENvbnN0YW50IHNwZWNpZnlpbmcg\ndG8gdGhyb3cgYW4gZXhjZXB0aW9uIHdoZW4gYXR0ZW1wdGluZyB0byBwZXJz\naXN0CiAgICAgKiBudWxsIHZhbHVlcyBpbiBvYmplY3QgZmllbGRzLgogICAg\nICovCiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIGludCBOVUxMX0VYQ0VQVElP\nTiA9IDI7CgogICAgLyoqCiAgICAgKiBDb25zdGFudCBzcGVjaWZ5aW5nIHRo\nZSBtYW5hZ2VtZW50IGxldmVsIG9mIGEgZmllbGQuCiAgICAgKi8KICAgIHB1\nYmxpYyBzdGF0aWMgZmluYWwgaW50IE1BTkFHRV9QRVJTSVNURU5UID0gMzsK\nCiAgICAvKioKICAgICAqIENvbnN0YW50IHNwZWNpZnlpbmcgdGhlIG1hbmFn\nZW1lbnQgbGV2ZWwgb2YgYSBmaWVsZC4KICAgICAqLwogICAgcHVibGljIHN0\nYXRpYyBmaW5hbCBpbnQgTUFOQUdFX1RSQU5TQUNUSU9OQUwgPSAxOwoKICAg\nIC8qKgogICAgICogQ29uc3RhbnQgc3BlY2lmeWluZyB0aGUgbWFuYWdlbWVu\ndCBsZXZlbCBvZiBhIGZpZWxkLgogICAgICovCiAgICBwdWJsaWMgc3RhdGlj\nIGZpbmFsIGludCBNQU5BR0VfTk9ORSA9IDA7CgogICAgcHJpdmF0ZSBzdGF0\naWMgZmluYWwgTG9jYWxpemVyIF9sb2MgPSBMb2NhbGl6ZXIuZm9yUGFja2Fn\nZQogICAgICAgIChGaWVsZE1ldGFEYXRhLmNsYXNzKTsKCiAgICBwcml2YXRl\nIHN0YXRpYyBmaW5hbCBpbnQgREZHX0ZBTFNFID0gMTsKICAgIHByaXZhdGUg\nc3RhdGljIGZpbmFsIGludCBERkdfVFJVRSA9IDI7CiAgICBwcml2YXRlIHN0\nYXRpYyBmaW5hbCBpbnQgREZHX0VYUExJQ0lUID0gNDsKCiAgICBwcml2YXRl\nIHN0YXRpYyBmaW5hbCBNZXRob2QgREVGQVVMVF9NRVRIT0Q7CiAgICBzdGF0\naWMgewogICAgICAgIHRyeSB7CiAgICAgICAgICAgIERFRkFVTFRfTUVUSE9E\nID0gT2JqZWN0LmNsYXNzLmdldE1ldGhvZCgid2FpdCIsIChDbGFzc1tdKSBu\ndWxsKTsKICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkgewogICAgICAg\nICAgICAvLyBzaG91bGRuJ3QgZXZlciBoYXBwZW4KICAgICAgICAgICAgdGhy\nb3cgbmV3IEludGVybmFsRXhjZXB0aW9uKGUpOwogICAgICAgIH0KICAgIH0K\nCiAgICAvLyBuYW1lIGFuZCB0eXBlCiAgICBwcml2YXRlIGZpbmFsIFZhbHVl\nTWV0YURhdGEgX3ZhbDsKICAgIHByaXZhdGUgZmluYWwgVmFsdWVNZXRhRGF0\nYSBfa2V5OwogICAgcHJpdmF0ZSBmaW5hbCBWYWx1ZU1ldGFEYXRhIF9lbGVt\nOwogICAgcHJpdmF0ZSBmaW5hbCBDbGFzc01ldGFEYXRhIF9vd25lcjsKICAg\nIHByaXZhdGUgZmluYWwgU3RyaW5nIF9uYW1lOwogICAgcHJpdmF0ZSBDbGFz\ncyBfZGVjID0gbnVsbDsKICAgIHByaXZhdGUgQ2xhc3NNZXRhRGF0YSBfZGVj\nTWV0YSA9IG51bGw7CiAgICBwcml2YXRlIFN0cmluZyBfZnVsbE5hbWUgPSBu\ndWxsOwogICAgcHJpdmF0ZSBTdHJpbmcgX2VtYmVkRnVsbE5hbWUgPSBudWxs\nOwogICAgcHJpdmF0ZSBpbnQgX3Jlc01vZGUgPSBNT0RFX05PTkU7CgogICAg\nLy8gbG9hZC9zdG9yZSBpbmZvCiAgICBwcml2YXRlIFN0cmluZ1tdIF9jb21t\nZW50cyA9IG51bGw7CiAgICBwcml2YXRlIGludCBfbGlzdEluZGV4ID0gLTE7\nCgogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v\nLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KICAgIC8vIE5vdGU6IGlm\nIHlvdSBhZGQgYWRkaXRpb25hbCBzdGF0ZSwgbWFrZSBzdXJlIHRvIGFkZCBp\ndCB0byBjb3B5KCkKICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v\nLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCgogICAg\nLy8gbWlzYyBpbmZvCiAgICBwcml2YXRlIENsYXNzIF9wcm94eUNsYXNzID0g\nbnVsbDsKICAgIHByaXZhdGUgT2JqZWN0IF9pbml0aWFsaXplciA9IG51bGw7\nCiAgICBwcml2YXRlIGJvb2xlYW4gX3RyYW5zaWVudCA9IGZhbHNlOwogICAg\ncHJpdmF0ZSBib29sZWFuIF9wcmltS2V5ID0gZmFsc2U7CiAgICBwcml2YXRl\nIEJvb2xlYW4gX3ZlcnNpb24gPSBudWxsOwogICAgcHJpdmF0ZSBpbnQgX251\nbGxWYWx1ZSA9IE5VTExfVU5TRVQ7CiAgICBwcml2YXRlIGludCBfbWFuYWdl\nID0gTUFOQUdFX1BFUlNJU1RFTlQ7CiAgICBwcml2YXRlIGludCBfaW5kZXgg\nPSAtMTsKICAgIHByaXZhdGUgaW50IF9kZWNJbmRleCA9IC0xOwogICAgcHJp\ndmF0ZSBpbnQgX3BrSW5kZXggPSAtMTsKICAgIHByaXZhdGUgYm9vbGVhbiBf\nZXhwbGljaXQgPSBmYWxzZTsKICAgIHByaXZhdGUgaW50IF9kZmcgPSAwOwog\nICAgcHJpdmF0ZSBTZXQgX2ZnU2V0ID0gbnVsbDsKICAgIHByaXZhdGUgU3Ry\naW5nW10gX2ZncyA9IG51bGw7CiAgICBwcml2YXRlIFN0cmluZyAgIF9sZmcg\nPSBudWxsOwogICAgcHJpdmF0ZSBCb29sZWFuIF9scnMgPSBudWxsOwogICAg\ncHJpdmF0ZSBCb29sZWFuIF9zdHJlYW0gPSBudWxsOwogICAgcHJpdmF0ZSBT\ndHJpbmcgX2V4dE5hbWUgPSBudWxsOwogICAgcHJpdmF0ZSBTdHJpbmcgX2Zh\nY3ROYW1lID0gbnVsbDsKICAgIHByaXZhdGUgU3RyaW5nIF9leHRTdHJpbmcg\nPSBudWxsOwogICAgcHJpdmF0ZSBNYXAgX2V4dFZhbHVlcyA9IENvbGxlY3Rp\nb25zLkVNUFRZX01BUDsKICAgIHByaXZhdGUgTWFwIF9maWVsZFZhbHVlcyA9\nIENvbGxlY3Rpb25zLkVNUFRZX01BUDsKICAgIHByaXZhdGUgQm9vbGVhbiBf\nZW51bUZpZWxkID0gbnVsbDsKICAgIHByaXZhdGUgQm9vbGVhbiBfbG9iRmll\nbGQgPSBudWxsOwogICAgcHJpdmF0ZSBCb29sZWFuIF9zZXJpYWxpemFibGVG\naWVsZCA9IG51bGw7CiAgICBwcml2YXRlIGJvb2xlYW4gX2dlbmVyYXRlZCA9\nIGZhbHNlOwoKICAgIC8vIE1lbWJlcnMgYXJlbid0IHNlcmlhbGl6YWJsZS4g\nVXNlIGEgcHJveHkgdGhhdCBjYW4gcHJvdmlkZSBhIE1lbWJlcgogICAgLy8g\ndG8gYXZvaWQgd3JpdGluZyB0aGUgZnVsbCBFeHRlcm5hbGl6YWJsZSBpbXBs\nZW1lbnRhdGlvbi4KICAgIHByaXZhdGUgTWVtYmVyUHJvdmlkZXIgX2JhY2tp\nbmdNZW1iZXIgPSBudWxsOwoKICAgIC8vIE1lbWJlcnMgYXJlbid0IHNlcmlh\nbGl6YWJsZS4gSW5pdGlhbGl6aW5nIF9leHRNZXRob2QgYW5kIF9mYWN0TWV0\naG9kIHRvCiAgICAvLyBERUZBVUxUX01FVEhPRCBpcyBzdWZmaWNpZW50IHRv\nIHRyaWdnZXIgbGF6eSBwb3B1bGF0aW9uIG9mIHRoZXNlIGZpZWxkcy4KICAg\nIHByaXZhdGUgdHJhbnNpZW50IE1ldGhvZCBfZXh0TWV0aG9kID0gREVGQVVM\nVF9NRVRIT0Q7CiAgICBwcml2YXRlIHRyYW5zaWVudCBNZW1iZXIgX2ZhY3RN\nZXRob2QgPSBERUZBVUxUX01FVEhPRDsKCiAgICAvLyBpbnRlcm1lZGlhdGUg\nYW5kIGltcGwgZGF0YQogICAgcHJpdmF0ZSBib29sZWFuIF9pbnRlcm1lZGlh\ndGUgPSB0cnVlOwogICAgcHJpdmF0ZSBCb29sZWFuIF9pbXBsRGF0YSA9IEJv\nb2xlYW4uVFJVRTsKCiAgICAvLyB2YWx1ZSBnZW5lcmF0aW9uCiAgICBwcml2\nYXRlIGludCBfdmFsU3RyYXRlZ3kgPSAtMTsKICAgIHByaXZhdGUgaW50IF91\ncFN0cmF0ZWd5ID0gLTE7CiAgICBwcml2YXRlIFN0cmluZyBfc2VxTmFtZSA9\nIENsYXNzTWV0YURhdGEuREVGQVVMVF9TVFJJTkc7CiAgICBwcml2YXRlIFNl\ncXVlbmNlTWV0YURhdGEgX3NlcU1ldGEgPSBudWxsOwoKICAgIC8vIGludmVy\nc2VzCiAgICBwcml2YXRlIFN0cmluZyBfbWFwcGVkQnkgPSBudWxsOwogICAg\ncHJpdmF0ZSBGaWVsZE1ldGFEYXRhIF9tYXBwZWRCeU1ldGEgPSBudWxsOwog\nICAgcHJpdmF0ZSBGaWVsZE1ldGFEYXRhW10gX2ludmVyc2VzID0gbnVsbDsK\nICAgIHByaXZhdGUgU3RyaW5nIF9pbnZlcnNlID0gQ2xhc3NNZXRhRGF0YS5E\nRUZBVUxUX1NUUklORzsKCiAgICAvLyBvcmRlcmluZyBvbiBsb2FkCiAgICBw\ncml2YXRlIE9yZGVyW10gX29yZGVycyA9IG51bGw7CiAgICBwcml2YXRlIFN0\ncmluZyBfb3JkZXJEZWMgPSBudWxsOwogICAgLy8gaW5kaWNhdGUgaWYgdGhp\ncyBmaWVsZCBpcyB1c2VkIGJ5IG90aGVyIGZpZWxkIGFzICJvcmRlciBieSIg\ndmFsdWUgCiAgICBwcml2YXRlIGJvb2xlYW4gX3VzZWRJbk9yZGVyQnkgPSBm\nYWxzZTsKCiAgICAvKioKICAgICAqIENvbnN0cnVjdG9yLgogICAgICoKICAg\nICAqIEBwYXJhbSBuYW1lIHRoZSBmaWVsZCBuYW1lCiAgICAgKiBAcGFyYW0g\ndHlwZSB0aGUgZmllbGQgdHlwZQogICAgICogQHBhcmFtIG93bmVyIHRoZSBv\nd25pbmcgY2xhc3MgbWV0YWRhdGEKICAgICAqLwogICAgcHJvdGVjdGVkIEZp\nZWxkTWV0YURhdGEoU3RyaW5nIG5hbWUsIENsYXNzIHR5cGUsIENsYXNzTWV0\nYURhdGEgb3duZXIpIHsKICAgICAgICBfbmFtZSA9IG5hbWU7CiAgICAgICAg\nX293bmVyID0gb3duZXI7CiAgICAgICAgX2RlYyA9IG51bGw7CiAgICAgICAg\nX2RlY01ldGEgPSBudWxsOwogICAgICAgIF92YWwgPSBvd25lci5nZXRSZXBv\nc2l0b3J5KCkubmV3VmFsdWVNZXRhRGF0YSh0aGlzKTsKICAgICAgICBfa2V5\nID0gb3duZXIuZ2V0UmVwb3NpdG9yeSgpLm5ld1ZhbHVlTWV0YURhdGEodGhp\ncyk7CiAgICAgICAgX2VsZW0gPSBvd25lci5nZXRSZXBvc2l0b3J5KCkubmV3\nVmFsdWVNZXRhRGF0YSh0aGlzKTsKCiAgICAgICAgc2V0RGVjbGFyZWRUeXBl\nKHR5cGUpOwogICAgfQoKICAgIC8qKgogICAgICogU3VwcGx5IHRoZSBiYWNr\naW5nIG1lbWJlciBvYmplY3Q7IHRoaXMgYWxsb3dzIHVzIHRvIHV0aWxpemUK\nICAgICAqIHBhcmFtZXRlcml6ZWQgdHlwZSBpbmZvcm1hdGlvbiBpZiBhdmFp\nbGFibGUuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIGJhY2tpbmdNZW1iZXIo\nTWVtYmVyIG1lbWJlcikgewogICAgICAgIGlmIChtZW1iZXIgPT0gbnVsbCkK\nICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIGlmIChNb2RpZmllci5pc1Ry\nYW5zaWVudChtZW1iZXIuZ2V0TW9kaWZpZXJzKCkpKQogICAgICAgICAgICBf\ndHJhbnNpZW50ID0gdHJ1ZTsKCiAgICAgICAgX2JhY2tpbmdNZW1iZXIgPSBu\nZXcgTWVtYmVyUHJvdmlkZXIobWVtYmVyKTsKCiAgICAgICAgQ2xhc3MgdHlw\nZTsKICAgICAgICBDbGFzc1tdIHR5cGVzOwogICAgICAgIGlmIChtZW1iZXIg\naW5zdGFuY2VvZiBGaWVsZCkgewogICAgICAgICAgICBGaWVsZCBmID0gKEZp\nZWxkKSBtZW1iZXI7CiAgICAgICAgICAgIHR5cGUgPSBmLmdldFR5cGUoKTsK\nICAgICAgICAgICAgdHlwZXMgPSBKYXZhVmVyc2lvbnMuZ2V0UGFyYW1ldGVy\naXplZFR5cGVzKGYpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIE1l\ndGhvZCBtZXRoID0gKE1ldGhvZCkgbWVtYmVyOwogICAgICAgICAgICB0eXBl\nID0gbWV0aC5nZXRSZXR1cm5UeXBlKCk7CiAgICAgICAgICAgIHR5cGVzID0g\nSmF2YVZlcnNpb25zLmdldFBhcmFtZXRlcml6ZWRUeXBlcyhtZXRoKTsKICAg\nICAgICB9CgogICAgICAgIHNldERlY2xhcmVkVHlwZSh0eXBlKTsKICAgICAg\nICBpZiAoQ29sbGVjdGlvbi5jbGFzcy5pc0Fzc2lnbmFibGVGcm9tKHR5cGUp\nCiAgICAgICAgICAgICYmIF9lbGVtLmdldERlY2xhcmVkVHlwZSgpID09IE9i\namVjdC5jbGFzcwogICAgICAgICAgICAmJiB0eXBlcy5sZW5ndGggPT0gMSkg\newogICAgICAgICAgICBfZWxlbS5zZXREZWNsYXJlZFR5cGUodHlwZXNbMF0p\nOwogICAgICAgIH0gZWxzZSBpZiAoTWFwLmNsYXNzLmlzQXNzaWduYWJsZUZy\nb20odHlwZSkKICAgICAgICAgICAgJiYgdHlwZXMubGVuZ3RoID09IDIpIHsK\nICAgICAgICAgICAgaWYgKF9rZXkuZ2V0RGVjbGFyZWRUeXBlKCkgPT0gT2Jq\nZWN0LmNsYXNzKQogICAgICAgICAgICAgICAgX2tleS5zZXREZWNsYXJlZFR5\ncGUodHlwZXNbMF0pOwogICAgICAgICAgICBpZiAoX2VsZW0uZ2V0RGVjbGFy\nZWRUeXBlKCkgPT0gT2JqZWN0LmNsYXNzKQogICAgICAgICAgICAgICAgX2Vs\nZW0uc2V0RGVjbGFyZWRUeXBlKHR5cGVzWzFdKTsKICAgICAgICB9CiAgICB9\nCgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIGJhY2tpbmcgbWVtYmVyIHN1\ncHBsaWVkIGluIHtAbGluayAjYmFja2luZ01lbWJlcn0uCiAgICAgKi8KICAg\nIHB1YmxpYyBNZW1iZXIgZ2V0QmFja2luZ01lbWJlcigpIHsKICAgICAgICBy\nZXR1cm4gKF9iYWNraW5nTWVtYmVyID09IG51bGwpID8gbnVsbCA6IF9iYWNr\naW5nTWVtYmVyLmdldE1lbWJlcigpOwogICAgfQoKICAgIC8qKgogICAgICog\nVGhlIG1ldGFkYXRhIHJlcG9zaXRvcnkuCiAgICAgKi8KICAgIHB1YmxpYyBN\nZXRhRGF0YVJlcG9zaXRvcnkgZ2V0UmVwb3NpdG9yeSgpIHsKICAgICAgICBy\nZXR1cm4gX293bmVyLmdldFJlcG9zaXRvcnkoKTsKICAgIH0KCiAgICAvKioK\nICAgICAqIFRoZSBjbGFzcyB0aGF0IGRlZmluZXMgdGhlIG1ldGFkYXRhIGZv\nciB0aGlzIGZpZWxkLgogICAgICovCiAgICBwdWJsaWMgQ2xhc3NNZXRhRGF0\nYSBnZXREZWZpbmluZ01ldGFEYXRhKCkgewogICAgICAgIHJldHVybiBfb3du\nZXI7CiAgICB9CgogICAgLyoqCiAgICAgKiBUaGUgZGVjbGFyaW5nIGNsYXNz\nLgogICAgICovCiAgICBwdWJsaWMgQ2xhc3MgZ2V0RGVjbGFyaW5nVHlwZSgp\nIHsKICAgICAgICByZXR1cm4gKF9kZWMgPT0gbnVsbCkgPyBfb3duZXIuZ2V0\nRGVzY3JpYmVkVHlwZSgpIDogX2RlYzsKICAgIH0KCiAgICAvKioKICAgICAq\nIFRoZSBkZWNsYXJpbmcgY2xhc3MuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lk\nIHNldERlY2xhcmluZ1R5cGUoQ2xhc3MgY2xzKSB7CiAgICAgICAgX2RlYyA9\nIGNsczsKICAgICAgICBfZGVjTWV0YSA9IG51bGw7CiAgICAgICAgX2Z1bGxO\nYW1lID0gbnVsbDsKICAgICAgICBfZW1iZWRGdWxsTmFtZSA9IG51bGw7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBUaGUgZGVjbGFyaW5nIGNsYXNzLgogICAg\nICovCiAgICBwdWJsaWMgQ2xhc3NNZXRhRGF0YSBnZXREZWNsYXJpbmdNZXRh\nRGF0YSgpIHsKICAgICAgICBpZiAoX2RlYyA9PSBudWxsKQogICAgICAgICAg\nICByZXR1cm4gX293bmVyOwogICAgICAgIGlmIChfZGVjTWV0YSA9PSBudWxs\nKQogICAgICAgICAgICBfZGVjTWV0YSA9IGdldFJlcG9zaXRvcnkoKS5nZXRN\nZXRhRGF0YShfZGVjLAogICAgICAgICAgICAgICAgX293bmVyLmdldEVudkNs\nYXNzTG9hZGVyKCksIHRydWUpOwogICAgICAgIHJldHVybiBfZGVjTWV0YTsK\nICAgIH0KCiAgICAvKioKICAgICAqIFRoZSBmaWVsZCBuYW1lLgogICAgICov\nCiAgICBwdWJsaWMgU3RyaW5nIGdldE5hbWUoKSB7CiAgICAgICAgcmV0dXJu\nIF9uYW1lOwogICAgfQoKICAgIC8qKgogICAgICogVGhlIGZpZWxkIG5hbWUs\nIHF1YWxpZmllZCBieSB0aGUgb3duaW5nIGNsYXNzLgogICAgICogQGRlcHJl\nY2F0ZWQgVXNlIGdldEZ1bGxOYW1lKGJvb2xlYW4pIGluc3RlYWQuCiAgICAg\nKi8KICAgIHB1YmxpYyBTdHJpbmcgZ2V0RnVsbE5hbWUoKSB7CiAgICAgICAg\ncmV0dXJuIGdldEZ1bGxOYW1lKGZhbHNlKTsKICAgIH0KCiAgICAvKioKICAg\nICAqIFRoZSBmaWVsZCBuYW1lLCBxdWFsaWZpZWQgYnkgdGhlIG93bmluZyBj\nbGFzcyBhbmQgb3B0aW9uYWxseSB0aGUKICAgICAqIGVtYmVkZGluZyBvd25l\ncidzIG5hbWUgKGlmIGFueSkuCiAgICAgKi8KICAgIHB1YmxpYyBTdHJpbmcg\nZ2V0RnVsbE5hbWUoYm9vbGVhbiBlbWJlZE93bmVyKSB7CiAgICAgICAgaWYg\nKF9mdWxsTmFtZSA9PSBudWxsKQogICAgICAgICAgICBfZnVsbE5hbWUgPSBn\nZXREZWNsYXJpbmdUeXBlKCkuZ2V0TmFtZSgpICsgIi4iICsgX25hbWU7CiAg\nICAgICAgaWYgKGVtYmVkT3duZXIgJiYgX2VtYmVkRnVsbE5hbWUgPT0gbnVs\nbCkgewogICAgICAgICAgICBpZiAoX293bmVyLmdldEVtYmVkZGluZ01ldGFE\nYXRhKCkgPT0gbnVsbCkKICAgICAgICAgICAgICAgIF9lbWJlZEZ1bGxOYW1l\nID0gX2Z1bGxOYW1lOwogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAg\nICBfZW1iZWRGdWxsTmFtZSA9IF9vd25lci5nZXRFbWJlZGRpbmdNZXRhRGF0\nYSgpLgogICAgICAgICAgICAgICAgICAgIGdldEZpZWxkTWV0YURhdGEoKS5n\nZXRGdWxsTmFtZSh0cnVlKSArICIuIiArIF9mdWxsTmFtZTsKICAgICAgICB9\nCiAgICAgICAgcmV0dXJuIChlbWJlZE93bmVyKSA/IF9lbWJlZEZ1bGxOYW1l\nIDogX2Z1bGxOYW1lOwogICAgfQoKICAgIC8qKgogICAgICogTWV0YURhdGEg\nYWJvdXQgdGhlIGZpZWxkIHZhbHVlLgogICAgICovCiAgICBwdWJsaWMgVmFs\ndWVNZXRhRGF0YSBnZXRWYWx1ZSgpIHsKICAgICAgICByZXR1cm4gX3ZhbDsK\nICAgIH0KCiAgICAvKioKICAgICAqIE1ldGFkYXRhIGFib3V0IHRoZSBrZXkg\ndmFsdWUuCiAgICAgKi8KICAgIHB1YmxpYyBWYWx1ZU1ldGFEYXRhIGdldEtl\neSgpIHsKICAgICAgICByZXR1cm4gX2tleTsKICAgIH0KCiAgICAvKioKICAg\nICAqIE1ldGFkYXRhIGFib3V0IHRoZSBlbGVtZW50IHZhbHVlLgogICAgICov\nCiAgICBwdWJsaWMgVmFsdWVNZXRhRGF0YSBnZXRFbGVtZW50KCkgewogICAg\nICAgIHJldHVybiBfZWxlbTsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVy\nbiB3aGV0aGVyIHRoaXMgZmllbGQgaXMgbWFwcGVkIHRvIHRoZSBkYXRhc3Rv\ncmUuIEJ5IGRlZmF1bHQsCiAgICAgKiByZXR1cm5zIHRydWUgZm9yIGFsbCBw\nZXJzaXN0ZW50IGZpZWxkcyB3aG9zZSBkZWZpbmluZyBjbGFzcyBpcyBtYXBw\nZWQuCiAgICAgKi8KICAgIHB1YmxpYyBib29sZWFuIGlzTWFwcGVkKCkgewog\nICAgICAgIHJldHVybiBfbWFuYWdlID09IE1BTkFHRV9QRVJTSVNURU5UICYm\nIF9vd25lci5pc01hcHBlZCgpOwogICAgfQoKICAgIC8qKgogICAgICogVGhl\nIHR5cGUgdGhpcyBmaWVsZCB3YXMgaW5pdGlhbGl6ZWQgd2l0aCwgYW5kIHRo\nZXJlZm9yZSB0aGUKICAgICAqIHR5cGUgdG8gdXNlIGZvciBwcm94aWVzIHdo\nZW4gbG9hZGluZyBkYXRhIGludG8gdGhpcyBmaWVsZC4KICAgICAqLwogICAg\ncHVibGljIENsYXNzIGdldFByb3h5VHlwZSgpIHsKICAgICAgICByZXR1cm4g\nKF9wcm94eUNsYXNzID09IG51bGwpID8gZ2V0RGVjbGFyZWRUeXBlKCkgOiBf\ncHJveHlDbGFzczsKICAgIH0KCiAgICAvKioKICAgICAqIFRoZSB0eXBlIHRo\naXMgZmllbGQgd2FzIGluaXRpYWxpemVkIHdpdGgsIGFuZCB0aGVyZWZvcmUg\ndGhlCiAgICAgKiB0eXBlIHRvIHVzZSBmb3IgcHJveGllcyB3aGVuIGxvYWRp\nbmcgZGF0YSBpbnRvIHRoaXMgZmllbGQuCiAgICAgKi8KICAgIHB1YmxpYyB2\nb2lkIHNldFByb3h5VHlwZShDbGFzcyB0eXBlKSB7CiAgICAgICAgX3Byb3h5\nQ2xhc3MgPSB0eXBlOwogICAgfQoKICAgIC8qKgogICAgICogVGhlIGluaXRp\nYWxpemVyIHVzZWQgYnkgdGhlIGZpZWxkLCBvciBudWxsIGlmIG5vbmUuIFRo\naXMKICAgICAqIGlzIGFkZGl0aW9uYWwgaW5mb3JtYXRpb24gZm9yIGluaXRp\nYWxpemluZyB0aGUgZmllbGQsIHN1Y2ggYXMKICAgICAqIGEgY3VzdG9tIHtA\nbGluayBDb21wYXJhdG9yfSB1c2VkIGJ5IGEge0BsaW5rIFNldH0gb3IKICAg\nICAqIGEge0BsaW5rIFRpbWVab25lfSB1c2VkIGJ5IGEge0BsaW5rIENhbGVu\nZGFyfS4KICAgICAqLwogICAgcHVibGljIE9iamVjdCBnZXRJbml0aWFsaXpl\ncigpIHsKICAgICAgICByZXR1cm4gX2luaXRpYWxpemVyOwogICAgfQoKICAg\nIC8qKgogICAgICogVGhlIGluaXRpYWxpemVyIHVzZWQgYnkgdGhlIGZpZWxk\nLCBvciBudWxsIGlmIG5vbmUuIFRoaXMKICAgICAqIGlzIGFkZGl0aW9uYWwg\naW5mb3JtYXRpb24gZm9yIGluaXRpYWxpemluZyB0aGUgZmllbGQsIHN1Y2gg\nYXMKICAgICAqIGEgY3VzdG9tIHtAbGluayBDb21wYXJhdG9yfSB1c2VkIGJ5\nIGEge0BsaW5rIFNldH0gb3IKICAgICAqIGEge0BsaW5rIFRpbWVab25lfSB1\nc2VkIGJ5IGEge0BsaW5rIENhbGVuZGFyfS4KICAgICAqLwogICAgcHVibGlj\nIHZvaWQgc2V0SW5pdGlhbGl6ZXIoT2JqZWN0IGluaXRpYWxpemVyKSB7CiAg\nICAgICAgX2luaXRpYWxpemVyID0gaW5pdGlhbGl6ZXI7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBSZXR1cm4gd2hldGhlciB0aGlzIGlzIGEgdHJhbnNpZW50\nIGZpZWxkLgogICAgICovCiAgICBwdWJsaWMgYm9vbGVhbiBpc1RyYW5zaWVu\ndCgpIHsKICAgICAgICByZXR1cm4gX3RyYW5zaWVudDsKICAgIH0KCiAgICAv\nKioKICAgICAqIFJldHVybiB3aGV0aGVyIHRoaXMgaXMgYSB0cmFuc2llbnQg\nZmllbGQuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldFRyYW5zaWVudChi\nb29sZWFuIHRyYW5zKSB7CiAgICAgICAgX3RyYW5zaWVudCA9IHRyYW5zOwog\nICAgfQoKICAgIC8qKgogICAgICogVGhlIGFic29sdXRlIGluZGV4IG9mIHRo\naXMgcGVyc2lzdGVudC90cmFuc2FjdGlvbmFsIGZpZWxkLgogICAgICovCiAg\nICBwdWJsaWMgaW50IGdldEluZGV4KCkgewogICAgICAgIHJldHVybiBfaW5k\nZXg7CiAgICB9CgogICAgLyoqCiAgICAgKiBUaGUgYWJzb2x1dGUgaW5kZXgg\nb2YgdGhpcyBwZXJzaXN0ZW50L3RyYW5zYWN0aW9uYWwgZmllbGQuCiAgICAg\nKi8KICAgIHB1YmxpYyB2b2lkIHNldEluZGV4KGludCBpbmRleCkgewogICAg\nICAgIF9pbmRleCA9IGluZGV4OwogICAgfQoKICAgIC8qKgogICAgICogVGhl\nIHJlbGF0aXZlIGluZGV4IG9mIHRoaXMgcGVyc2lzdGVudC90cmFuc2FjdGlv\nbmFsIGZpZWxkLgogICAgICovCiAgICBwdWJsaWMgaW50IGdldERlY2xhcmVk\nSW5kZXgoKSB7CiAgICAgICAgcmV0dXJuIF9kZWNJbmRleDsKICAgIH0KCiAg\nICAvKioKICAgICAqIFRoZSByZWxhdGl2ZSBpbmRleCBvZiB0aGlzIHBlcnNp\nc3RlbnQvdHJhbnNhY3Rpb25hbCBmaWVsZC4KICAgICAqLwogICAgcHVibGlj\nIHZvaWQgc2V0RGVjbGFyZWRJbmRleChpbnQgaW5kZXgpIHsKICAgICAgICBf\nZGVjSW5kZXggPSBpbmRleDsKICAgIH0KCiAgICAvKioKICAgICAqIFRoZSBp\nbmRleCBpbiB3aGljaCB0aGlzIGZpZWxkIHdhcyBsaXN0ZWQgaW4gdGhlIG1l\ndGFkYXRhLiBEZWZhdWx0cyB0bwogICAgICogPGNvZGU+LTE8L2NvZGU+IGlm\nIHRoaXMgZmllbGQgd2FzIG5vdCBsaXN0ZWQgaW4gdGhlIG1ldGFkYXRhLgog\nICAgICovCiAgICBwdWJsaWMgaW50IGdldExpc3RpbmdJbmRleCgpIHsKICAg\nICAgICByZXR1cm4gX2xpc3RJbmRleDsKICAgIH0KCiAgICAvKioKICAgICAq\nIFRoZSBpbmRleCBpbiB3aGljaCB0aGlzIGZpZWxkIHdhcyBsaXN0ZWQgaW4g\ndGhlIG1ldGFkYXRhLiBEZWZhdWx0cyB0bwogICAgICogPGNvZGU+LTE8L2Nv\nZGU+IGlmIHRoaXMgZmllbGQgd2FzIG5vdCBsaXN0ZWQgaW4gdGhlIG1ldGFk\nYXRhLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRMaXN0aW5nSW5kZXgo\naW50IGluZGV4KSB7CiAgICAgICAgX2xpc3RJbmRleCA9IGluZGV4OwogICAg\nfQoKICAgIC8qKgogICAgICogVGhlIGFic29sdXRlIHByaW1hcnkga2V5IGlu\nZGV4IGZvciB0aGlzIGZpZWxkLCBvciAtMSBpZiBub3QgYSBwcmltYXJ5CiAg\nICAgKiBrZXkuIFRoZSBmaXJzdCBwcmltYXJ5IGtleSBmaWVsZCBoYXMgaW5k\nZXggMCwgdGhlIHNlY29uZCBpbmRleCAxLCBldGMuCiAgICAgKi8KICAgIHB1\nYmxpYyBpbnQgZ2V0UHJpbWFyeUtleUluZGV4KCkgewogICAgICAgIHJldHVy\nbiBfcGtJbmRleDsKICAgIH0KCiAgICAvKioKICAgICAqIFRoZSBhYnNvbHV0\nZSBwcmltYXJ5IGtleSBpbmRleCBmb3IgdGhpcyBmaWVsZCwgb3IgLTEgaWYg\nbm90IGEgcHJpbWFyeQogICAgICoga2V5LiBUaGUgZmlyc3QgcHJpbWFyeSBr\nZXkgZmllbGQgaGFzIGluZGV4IDAsIHRoZSBzZWNvbmQgaW5kZXggMSwgZXRj\nLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRQcmltYXJ5S2V5SW5kZXgo\naW50IGluZGV4KSB7CiAgICAgICAgX3BrSW5kZXggPSBpbmRleDsKICAgIH0K\nCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgbWFuYWdlbWVudCBsZXZlbCBm\nb3IgdGhlIGZpZWxkLiBXaWxsIGJlIG9uZSBvZjoKICAgICAqIDx1bD4KICAg\nICAqIDxsaT57QGxpbmsgI01BTkFHRV9QRVJTSVNURU5UfTogdGhlIGZpZWxk\nIGlzIHBlcnNpc3RlbnQ8L2xpPgogICAgICogPGxpPntAbGluayAjTUFOQUdF\nX1RSQU5TQUNUSU9OQUx9OiB0aGUgZmllbGQgaXMgdHJhbnNhY3Rpb25hbCBi\ndXQgbm90CiAgICAgKiBwZXJzaXN0ZW50PC9saT4KICAgICAqIDxsaT57QGxp\nbmsgI01BTkFHRV9OT05FfTogdGhlIGZpZWxkIGlzIG5vdCBtYW5hZ2VkPC9s\naT4KICAgICAqIDwvdWw+IERlZmF1bHRzIHRvIHtAbGluayAjTUFOQUdFX1BF\nUlNJU1RFTlR9LgogICAgICovCiAgICBwdWJsaWMgaW50IGdldE1hbmFnZW1l\nbnQoKSB7CiAgICAgICAgcmV0dXJuIF9tYW5hZ2U7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBSZXR1cm4gdGhlIG1hbmFnZW1lbnQgbGV2ZWwgZm9yIHRoZSBm\naWVsZC4gV2lsbCBiZSBvbmUgb2Y6CiAgICAgKiA8dWw+CiAgICAgKiA8bGk+\ne0BsaW5rICNNQU5BR0VfUEVSU0lTVEVOVH06IHRoZSBmaWVsZCBpcyBwZXJz\naXN0ZW50PC9saT4KICAgICAqIDxsaT57QGxpbmsgI01BTkFHRV9UUkFOU0FD\nVElPTkFMfTogdGhlIGZpZWxkIGlzIHRyYW5zYWN0aW9uYWwgYnV0IG5vdAog\nICAgICogcGVyc2lzdGVudDwvbGk+CiAgICAgKiA8bGk+e0BsaW5rICNNQU5B\nR0VfTk9ORX06IHRoZSBmaWVsZCBpcyBub3QgbWFuYWdlZDwvbGk+CiAgICAg\nKiA8L3VsPiAKICAgICAqIERlZmF1bHRzIHRvIHtAbGluayAjTUFOQUdFX1BF\nUlNJU1RFTlR9LgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRNYW5hZ2Vt\nZW50KGludCBtYW5hZ2UpIHsKICAgICAgICBpZiAoKF9tYW5hZ2UgPT0gTUFO\nQUdFX05PTkUpICE9IChtYW5hZ2UgPT0gTUFOQUdFX05PTkUpKQogICAgICAg\nICAgICBfb3duZXIuY2xlYXJGaWVsZENhY2hlKCk7CiAgICAgICAgX21hbmFn\nZSA9IG1hbmFnZTsKICAgIH0KCiAgICAvKioKICAgICAqIFdoZXRoZXIgdGhp\ncyBpcyBhIHByaW1hcnkga2V5IGZpZWxkLgogICAgICovCiAgICBwdWJsaWMg\nYm9vbGVhbiBpc1ByaW1hcnlLZXkoKSB7CiAgICAgICAgcmV0dXJuIF9wcmlt\nS2V5OwogICAgfQoKICAgIC8qKgogICAgICogV2hldGhlciB0aGlzIGlzIGEg\ncHJpbWFyeSBrZXkgZmllbGQuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNl\ndFByaW1hcnlLZXkoYm9vbGVhbiBwcmltS2V5KSB7CiAgICAgICAgX3ByaW1L\nZXkgPSBwcmltS2V5OwogICAgfQoKICAgIC8qKgogICAgICogRm9yIGEgcHJp\nbWFyeSBrZXkgZmllbGQsIHJldHVybiB0aGUgdHlwZSBvZiB0aGUgY29ycmVz\ncG9uZGluZyBvYmplY3QgaWQgCiAgICAgKiBjbGFzcyBmaWVsZC4KICAgICAq\nLwogICAgcHVibGljIGludCBnZXRPYmplY3RJZEZpZWxkVHlwZUNvZGUoKSB7\nCiAgICAgICAgQ2xhc3NNZXRhRGF0YSByZWxtZXRhID0gZ2V0RGVjbGFyZWRU\neXBlTWV0YURhdGEoKTsKICAgICAgICBpZiAocmVsbWV0YSA9PSBudWxsKQog\nICAgICAgICAgICByZXR1cm4gZ2V0RGVjbGFyZWRUeXBlQ29kZSgpOwogICAg\nICAgIGlmIChyZWxtZXRhLmdldElkZW50aXR5VHlwZSgpID09IENsYXNzTWV0\nYURhdGEuSURfREFUQVNUT1JFKSB7CiAgICAgICAgICAgIGJvb2xlYW4gdW53\ncmFwID0gZ2V0UmVwb3NpdG9yeSgpLmdldE1ldGFEYXRhRmFjdG9yeSgpLmdl\ndERlZmF1bHRzKCkuCiAgICAgICAgICAgICAgICBpc0RhdGFTdG9yZU9iamVj\ndElkRmllbGRVbndyYXBwZWQoKTsKICAgICAgICAgICAgcmV0dXJuICh1bndy\nYXApID8gSmF2YVR5cGVzLkxPTkcgOiBKYXZhVHlwZXMuT0JKRUNUOwogICAg\nICAgIH0KICAgICAgICBpZiAocmVsbWV0YS5pc09wZW5KUEFJZGVudGl0eSgp\nKQogICAgICAgICAgICByZXR1cm4gcmVsbWV0YS5nZXRQcmltYXJ5S2V5Rmll\nbGRzKClbMF0uZ2V0T2JqZWN0SWRGaWVsZFR5cGVDb2RlKCk7CiAgICAgICAg\ncmV0dXJuIEphdmFUeXBlcy5PQkpFQ1Q7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBGb3IgYSBwcmltYXJ5IGtleSBmaWVsZCwgcmV0dXJuIHRoZSB0eXBlIG9m\nIHRoZSBjb3JyZXNwb25kaW5nIG9iamVjdCBpZCAKICAgICAqIGNsYXNzIGZp\nZWxkLgogICAgICovCiAgICBwdWJsaWMgQ2xhc3MgZ2V0T2JqZWN0SWRGaWVs\nZFR5cGUoKSB7CiAgICAgICAgQ2xhc3NNZXRhRGF0YSByZWxtZXRhID0gZ2V0\nRGVjbGFyZWRUeXBlTWV0YURhdGEoKTsKICAgICAgICBpZiAocmVsbWV0YSA9\nPSBudWxsKQogICAgICAgICAgICByZXR1cm4gZ2V0RGVjbGFyZWRUeXBlKCk7\nCiAgICAgICAgc3dpdGNoIChyZWxtZXRhLmdldElkZW50aXR5VHlwZSgpKSB7\nCiAgICAgICAgICAgIGNhc2UgQ2xhc3NNZXRhRGF0YS5JRF9EQVRBU1RPUkU6\nCiAgICAgICAgICAgICAgICBib29sZWFuIHVud3JhcCA9IGdldFJlcG9zaXRv\ncnkoKS5nZXRNZXRhRGF0YUZhY3RvcnkoKS4KICAgICAgICAgICAgICAgICAg\nICBnZXREZWZhdWx0cygpLmlzRGF0YVN0b3JlT2JqZWN0SWRGaWVsZFVud3Jh\ncHBlZCgpOwogICAgICAgICAgICAgICAgcmV0dXJuICh1bndyYXApID8gbG9u\nZy5jbGFzcyA6IE9iamVjdC5jbGFzczsKICAgICAgICAgICAgY2FzZSBDbGFz\nc01ldGFEYXRhLklEX0FQUExJQ0FUSU9OOgogICAgICAgICAgICAgICAgaWYg\nKHJlbG1ldGEuaXNPcGVuSlBBSWRlbnRpdHkoKSkKICAgICAgICAgICAgICAg\nICAgICByZXR1cm4gcmVsbWV0YS5nZXRQcmltYXJ5S2V5RmllbGRzKClbMF0u\nCiAgICAgICAgICAgICAgICAgICAgICAgIGdldE9iamVjdElkRmllbGRUeXBl\nKCk7CiAgICAgICAgICAgICAgICByZXR1cm4gKHJlbG1ldGEuZ2V0T2JqZWN0\nSWRUeXBlKCkgPT0gbnVsbCkgPyBPYmplY3QuY2xhc3MKICAgICAgICAgICAg\nICAgICAgICA6IHJlbG1ldGEuZ2V0T2JqZWN0SWRUeXBlKCk7CiAgICAgICAg\nICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgICByZXR1cm4gT2JqZWN0LmNs\nYXNzOwogICAgICAgIH0gCiAgICB9CgogICAgLyoqCiAgICAgKiBXaGV0aGVy\nIHRoaXMgZmllbGQgaG9sZHMgb3B0aW1pc3RpYyB2ZXJzaW9uIGluZm9ybWF0\naW9uLgogICAgICovCiAgICBwdWJsaWMgYm9vbGVhbiBpc1ZlcnNpb24oKSB7\nCiAgICAgICAgcmV0dXJuIF92ZXJzaW9uID09IEJvb2xlYW4uVFJVRTsKICAg\nIH0KCiAgICAvKioKICAgICAqIFdoZXRoZXIgdGhpcyBmaWVsZCBob2xkcyBv\ncHRpbWlzdGljIHZlcnNpb24gaW5mb3JtYXRpb24uCiAgICAgKi8KICAgIHB1\nYmxpYyB2b2lkIHNldFZlcnNpb24oYm9vbGVhbiB2ZXJzaW9uKSB7CiAgICAg\nICAgX3ZlcnNpb24gPSAodmVyc2lvbikgPyBCb29sZWFuLlRSVUUgOiBCb29s\nZWFuLkZBTFNFOwogICAgfQoKICAgIC8qKgogICAgICogV2hldGhlciB0aGlz\nIGZpZWxkIGlzIGluIHRoZSBkZWZhdWx0IGZldGNoIGdyb3VwLgogICAgICov\nCiAgICBwdWJsaWMgYm9vbGVhbiBpc0luRGVmYXVsdEZldGNoR3JvdXAoKSB7\nCiAgICAgICAgaWYgKF9kZmcgPT0gMCkgewogICAgICAgICAgICBpZiAoX21h\nbmFnZSAhPSBNQU5BR0VfUEVSU0lTVEVOVCB8fCBpc1ByaW1hcnlLZXkoKSB8\nfCBpc1ZlcnNpb24oKSkKICAgICAgICAgICAgICAgIF9kZmcgPSBERkdfRkFM\nU0U7CiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgLy8gZmll\nbGQgbGVmdCBhcyBkZWZhdWx0OyBkZmcgc2V0dGluZyBkZXBlbmRzIG9uIHR5\ncGUKICAgICAgICAgICAgICAgIHN3aXRjaCAoZ2V0VHlwZUNvZGUoKSkgewog\nICAgICAgICAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLk9CSkVDVDoKICAg\nICAgICAgICAgICAgICAgICAgICAgaWYgKGlzU2VyaWFsaXphYmxlKCkgfHwg\naXNFbnVtKCkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfZGZnID0g\nREZHX1RSVUU7CiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAg\nICAgICAgICAgICAgICAgICAgICAgIF9kZmcgPSBERkdfRkFMU0U7CiAgICAg\nICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAg\nIGNhc2UgSmF2YVR5cGVzLkFSUkFZOgogICAgICAgICAgICAgICAgICAgICAg\nICBpZiAoaXNMb2JBcnJheSgpKQogICAgICAgICAgICAgICAgICAgICAgICAg\nICAgX2RmZyA9IERGR19UUlVFOwogICAgICAgICAgICAgICAgICAgICAgICBl\nbHNlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfZGZnID0gREZHX0ZB\nTFNFOwogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAg\nICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5DT0xMRUNUSU9OOgogICAgICAg\nICAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLk1BUDoKICAgICAgICAgICAg\nICAgICAgICBjYXNlIEphdmFUeXBlcy5QQzoKICAgICAgICAgICAgICAgICAg\nICBjYXNlIEphdmFUeXBlcy5QQ19VTlRZUEVEOgogICAgICAgICAgICAgICAg\nICAgICAgICBfZGZnID0gREZHX0ZBTFNFOwogICAgICAgICAgICAgICAgICAg\nICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OgogICAg\nICAgICAgICAgICAgICAgICAgICBfZGZnID0gREZHX1RSVUU7CiAgICAgICAg\nICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0\ndXJuIChfZGZnICYgREZHX1RSVUUpID4gMDsKICAgIH0KCiAgICBwcml2YXRl\nIGJvb2xlYW4gaXNFbnVtKCkgewogICAgICAgIGlmIChfZW51bUZpZWxkID09\nIG51bGwpIHsKICAgICAgICAgICAgQ2xhc3MgZHQgPSBnZXREZWNsYXJlZFR5\ncGUoKTsKICAgICAgICAgICAgX2VudW1GaWVsZCA9IEphdmFWZXJzaW9ucy5p\nc0VudW1lcmF0aW9uKGR0KQogICAgICAgICAgICAgICAgPyBCb29sZWFuLlRS\nVUUgOiBCb29sZWFuLkZBTFNFOwogICAgICAgIH0KICAgICAgICByZXR1cm4g\nX2VudW1GaWVsZC5ib29sZWFuVmFsdWUoKTsKICAgIH0KCiAgICBwcml2YXRl\nIGJvb2xlYW4gaXNTZXJpYWxpemFibGUoKSB7CiAgICAgICAgaWYgKF9zZXJp\nYWxpemFibGVGaWVsZCA9PSBudWxsKSB7CiAgICAgICAgICAgIENsYXNzIGR0\nID0gZ2V0RGVjbGFyZWRUeXBlKCk7CiAgICAgICAgICAgIGlmIChTZXJpYWxp\nemFibGUuY2xhc3MuaXNBc3NpZ25hYmxlRnJvbShkdCkpCiAgICAgICAgICAg\nICAgICBfc2VyaWFsaXphYmxlRmllbGQgPSBCb29sZWFuLlRSVUU7CiAgICAg\nICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIF9zZXJpYWxpemFibGVGaWVs\nZCA9IEJvb2xlYW4uRkFMU0U7CiAgICAgICAgfQogICAgICAgIHJldHVybiBf\nc2VyaWFsaXphYmxlRmllbGQuYm9vbGVhblZhbHVlKCk7CiAgICB9CgogICAg\ncHJpdmF0ZSBib29sZWFuIGlzTG9iQXJyYXkoKSB7CiAgICAgICAgLy8gY2hl\nY2sgZm9yIGJ5dGVbXSwgQnl0ZVtdLCBjaGFyW10sIENoYXJhY3RlcltdCiAg\nICAgICAgaWYgKF9sb2JGaWVsZCA9PSBudWxsKSB7CiAgICAgICAgICAgIENs\nYXNzIGR0ID0gZ2V0RGVjbGFyZWRUeXBlKCk7CiAgICAgICAgICAgIGlmIChk\ndCA9PSBieXRlW10uY2xhc3MgfHwgZHQgPT0gQnl0ZVtdLmNsYXNzIHx8CiAg\nICAgICAgICAgICAgICBkdCA9PSBjaGFyW10uY2xhc3MgfHwgZHQgPT0gQ2hh\ncmFjdGVyW10uY2xhc3MpCiAgICAgICAgICAgICAgICBfbG9iRmllbGQgPSBC\nb29sZWFuLlRSVUU7CiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAg\nIF9sb2JGaWVsZCA9IEJvb2xlYW4uRkFMU0U7CiAgICAgICAgfQogICAgICAg\nIHJldHVybiBfbG9iRmllbGQuYm9vbGVhblZhbHVlKCk7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBXaGV0aGVyIHRoaXMgZmllbGQgaXMgaW4gdGhlIGRlZmF1\nbHQgZmV0Y2ggZ3JvdXAuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldElu\nRGVmYXVsdEZldGNoR3JvdXAoYm9vbGVhbiBkZmcpIHsKICAgICAgICBpZiAo\nZGZnKQogICAgICAgICAgICBfZGZnID0gREZHX1RSVUU7CiAgICAgICAgZWxz\nZQogICAgICAgICAgICBfZGZnID0gREZHX0ZBTFNFOwogICAgICAgIF9kZmcg\nfD0gREZHX0VYUExJQ0lUOwogICAgfQoKICAgIC8qKgogICAgICogV2hldGhl\nciB0aGUgZGVmYXVsdCBmZXRjaCBncm91cCBzZXR0aW5nIGlzIGV4cGxpY2l0\nLgogICAgICovCiAgICBwdWJsaWMgYm9vbGVhbiBpc0RlZmF1bHRGZXRjaEdy\nb3VwRXhwbGljaXQoKSB7CiAgICAgICAgcmV0dXJuIChfZGZnICYgREZHX0VY\nUExJQ0lUKSA+IDA7CiAgICB9CgogICAgLyoqCiAgICAgKiBXaGV0aGVyIHRo\nZSBkZWZhdWx0IGZldGNoIGdyb3VwIHNldHRpbmcgaXMgZXhwbGljaXQuIEFs\nbG93IHNldHRpbmcKICAgICAqIGZvciB0ZXN0aW5nLgogICAgICovCiAgICBw\ndWJsaWMgdm9pZCBzZXREZWZhdWx0RmV0Y2hHcm91cEV4cGxpY2l0KGJvb2xl\nYW4gZXhwbGljaXQpIHsKICAgICAgICBpZiAoZXhwbGljaXQpCiAgICAgICAg\nICAgIF9kZmcgfD0gREZHX0VYUExJQ0lUOwogICAgICAgIGVsc2UKICAgICAg\nICAgICAgX2RmZyAmPSB+REZHX0VYUExJQ0lUOwogICAgfQoKICAgIC8qKgog\nICAgICogR2V0cyB0aGUgbmFtZSBvZiB0aGUgY3VzdG9tIGZldGNoIGdyb3Vw\ncyB0aG9zZSBhcmUgYXNzb2NpYXRlZCB0byB0aGlzIAogICAgICogcmVjZWl2\nZXIuICBUaGlzIGRvZXMgbm90IGluY2x1ZGUgdGhlICJkZWZhdWx0IiBhbmQg\nImFsbCIgZmV0Y2ggZ3JvdXBzLgogICAgICoKICAgICAqIEByZXR1cm4gdGhl\nIHNldCBvZiBmZXRjaCBncm91cCBuYW1lcywgbm90IGluY2x1ZGluZyB0aGUg\nZGVmYXVsdCBhbmQKICAgICAqIGFsbCBmZXRjaCBncm91cHMuCiAgICAgKi8K\nICAgIHB1YmxpYyBTdHJpbmdbXSBnZXRDdXN0b21GZXRjaEdyb3VwcygpIHsK\nICAgICAgICBpZiAoX2ZncyA9PSBudWxsKSB7CiAgICAgICAgICAgIGlmIChf\nZmdTZXQgPT0gbnVsbCB8fCBfbWFuYWdlICE9IE1BTkFHRV9QRVJTSVNURU5U\nIAogICAgICAgICAgICAgICAgfHwgaXNQcmltYXJ5S2V5KCkgfHwgaXNWZXJz\naW9uKCkpCiAgICAgICAgICAgICAgICBfZmdzID0gbmV3IFN0cmluZ1swXTsK\nICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgX2ZncyA9IChTdHJp\nbmdbXSkgX2ZnU2V0LnRvQXJyYXkobmV3IFN0cmluZ1tfZmdTZXQuc2l6ZSgp\nXSk7CiAgICAgICAgfQogICAgICAgIHJldHVybiBfZmdzOwogICAgfQoKICAg\nIC8qKgogICAgICogVGhlIGZldGNoIGdyb3VwIHRoYXQgaXMgdG8gYmUgbG9h\nZGVkIHdoZW4gdGhpcyByZWNlaXZlciBpcyBsb2FkZWQsIG9yCiAgICAgKiBu\ndWxsIGlmIG5vbmUgc2V0LgogICAgICovCiAgICBwdWJsaWMgU3RyaW5nIGdl\ndExvYWRGZXRjaEdyb3VwICgpIHsKICAgIAlyZXR1cm4gX2xmZzsKICAgIH0K\nICAgIAogICAgLyoqCiAgICAgKiBUaGUgZmV0Y2ggZ3JvdXAgdGhhdCBpcyB0\nbyBiZSBsb2FkZWQgd2hlbiB0aGlzIHJlY2VpdmVyIGlzIGxvYWRlZCwgb3IK\nICAgICAqIG51bGwgaWYgbm9uZSBzZXQuCiAgICAgKi8KICAgIHB1YmxpYyB2\nb2lkIHNldExvYWRGZXRjaEdyb3VwIChTdHJpbmcgbGZnKSB7CiAgICAgICAg\naWYgKCIiLmVxdWFscyhsZmcpKQogICAgICAgICAgICBsZmcgPSBudWxsOwog\nICAgCV9sZmcgPSBsZmc7CiAgICB9CgogICAgLyoqCiAgICAgKiBXaGV0aGVy\nIHRoaXMgZmllbGQgaXMgaW4gdGhlIGdpdmVuIGZldGNoIGdyb3VwLgogICAg\nICovCiAgICBwdWJsaWMgYm9vbGVhbiBpc0luRmV0Y2hHcm91cChTdHJpbmcg\nZmcpIHsKICAgICAgICBpZiAoX21hbmFnZSAhPSBNQU5BR0VfUEVSU0lTVEVO\nVCB8fCBpc1ByaW1hcnlLZXkoKSB8fCBpc1ZlcnNpb24oKSkKICAgICAgICAg\nICAgcmV0dXJuIGZhbHNlOwogICAgICAgIGlmIChGZXRjaEdyb3VwLk5BTUVf\nQUxMLmVxdWFscyhmZykpCiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAg\nICAgIGlmIChGZXRjaEdyb3VwLk5BTUVfREVGQVVMVC5lcXVhbHMoZmcpKQog\nICAgICAgICAgICByZXR1cm4gaXNJbkRlZmF1bHRGZXRjaEdyb3VwKCk7CiAg\nICAgICAgcmV0dXJuIF9mZ1NldCAhPSBudWxsICYmIF9mZ1NldC5jb250YWlu\ncyhmZyk7CiAgICB9CgogICAgLyoqCiAgICAgKiBTZXQgd2hldGhlciB0aGlz\nIGZpZWxkIGlzIGluIHRoZSBnaXZlbiBmZXRjaCBncm91cC4KICAgICAqCiAg\nICAgKiBAcGFyYW0gZmcgaXMgdGhlIG5hbWUgb2YgYSBmZXRjaCBncm91cCB0\naGF0IG11c3QgYmUgcHJlc2VudCBpbiB0aGUKICAgICAqIGNsYXNzIHRoYXQg\nZGVjbGFyZWQgdGhpcyBmaWVsZCBvciBhbnkgb2YgaXRzIHBlcnNpc3RlbnQg\nc3VwZXJjbGFzc2VzLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRJbkZl\ndGNoR3JvdXAoU3RyaW5nIGZnLCBib29sZWFuIGluKSB7CiAgICAgICAgaWYg\nKFN0cmluZ1V0aWxzLmlzRW1wdHkoZmcpKQogICAgICAgICAgICB0aHJvdyBu\nZXcgTWV0YURhdGFFeGNlcHRpb24oX2xvYy5nZXQoImVtcHR5LWZnLW5hbWUi\nLCB0aGlzKSk7CiAgICAgICAgaWYgKGZnLmVxdWFscyhGZXRjaEdyb3VwLk5B\nTUVfQUxMKSkKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIGlmIChmZy5l\ncXVhbHMoRmV0Y2hHcm91cC5OQU1FX0RFRkFVTFQpKSB7CiAgICAgICAgICAg\nIHNldEluRGVmYXVsdEZldGNoR3JvdXAoaW4pOwogICAgICAgICAgICByZXR1\ncm47CiAgICAgICAgfQogICAgICAgIGlmIChfb3duZXIuZ2V0RmV0Y2hHcm91\ncChmZykgPT0gbnVsbCkKICAgICAgICAgICAgdGhyb3cgbmV3IE1ldGFEYXRh\nRXhjZXB0aW9uKF9sb2MuZ2V0KCJ1bmtub3duLWZnIiwgZmcsIHRoaXMpKTsK\nICAgICAgICBpZiAoaW4gJiYgX2ZnU2V0ID09IG51bGwpCiAgICAgICAgICAg\nIF9mZ1NldCA9IG5ldyBIYXNoU2V0KCk7CiAgICAgICAgaWYgKChpbiAmJiBf\nZmdTZXQuYWRkKGZnKSkKICAgICAgICAgICAgfHwgKCFpbiAmJiBfZmdTZXQg\nIT0gbnVsbCAmJiBfZmdTZXQucmVtb3ZlKGZnKSkpCiAgICAgICAgICAgIF9m\nZ3MgPSBudWxsOwogICAgfQogICAgCiAgICAvKioKICAgICAqIEhvdyB0aGUg\nZGF0YSBzdG9yZSBzaG91bGQgdHJlYXQgbnVsbCB2YWx1ZXMgZm9yIHRoaXMg\nZmllbGQ6CiAgICAgKiA8dWw+CiAgICAgKiA8bGk+e0BsaW5rICNOVUxMX1VO\nU0VUfTogbm8gdmFsdWUgc3VwcGxpZWQ8L2xpPgogICAgICogPGxpPntAbGlu\nayAjTlVMTF9OT05FfTogbGVhdmUgbnVsbCB2YWx1ZXMgYXMgbnVsbCBpbiB0\naGUgZGF0YSBzdG9yZTwvbGk+CiAgICAgKiA8bGk+e0BsaW5rICNOVUxMX0VY\nQ0VQVElPTn06IHRocm93IGFuIGV4Y2VwdGlvbiBpZiB0aGlzIGZpZWxkIGlz\nIG51bGwKICAgICAqIGF0IGNvbW1pdDwvbGk+CiAgICAgKiA8bGk+e0BsaW5r\nICNOVUxMX0RFRkFVTFR9OiB1c2UgdGhlIGRhdGFiYXNlIGRlZmF1bHQgaWYg\ndGhpcyBmaWVsZCBpcwogICAgICogbnVsbCBhdCBjb21taXQ8L2xpPgogICAg\nICogPC91bD4gRGVmYXVsdHMgdG8ge0BsaW5rICNOVUxMX1VOU0VUfS4KICAg\nICAqLwogICAgcHVibGljIGludCBnZXROdWxsVmFsdWUoKSB7CiAgICAgICAg\ncmV0dXJuIF9udWxsVmFsdWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBIb3cg\ndGhlIGRhdGEgc3RvcmUgc2hvdWxkIHRyZWF0IG51bGwgdmFsdWVzIGZvciB0\naGlzIGZpZWxkOgogICAgICogPHVsPgogICAgICogPGxpPntAbGluayAjTlVM\nTF9VTlNFVH06IG5vIHZhbHVlIHN1cHBsaWVkPC9saT4KICAgICAqIDxsaT57\nQGxpbmsgI05VTExfTk9ORX06IGxlYXZlIG51bGwgdmFsdWVzIGFzIG51bGwg\naW4gdGhlIGRhdGEgc3RvcmU8L2xpPgogICAgICogPGxpPntAbGluayAjTlVM\nTF9FWENFUFRJT059OiB0aHJvdyBhbiBleGNlcHRpb24gaWYgdGhpcyBmaWVs\nZCBpcyBudWxsCiAgICAgKiBhdCBjb21taXQ8L2xpPgogICAgICogPGxpPntA\nbGluayAjTlVMTF9ERUZBVUxUfTogdXNlIHRoZSBkYXRhYmFzZSBkZWZhdWx0\nIGlmIHRoaXMgZmllbGQgaXMKICAgICAqIG51bGwgYXQgY29tbWl0PC9saT4K\nICAgICAqIDwvdWw+IERlZmF1bHRzIHRvIHtAbGluayAjTlVMTF9VTlNFVH0u\nCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldE51bGxWYWx1ZShpbnQgbnVs\nbFZhbHVlKSB7CiAgICAgICAgX251bGxWYWx1ZSA9IG51bGxWYWx1ZTsKICAg\nIH0KCiAgICAvKioKICAgICAqIFdoZXRoZXIgdGhpcyBmaWVsZCBpcyBleHBs\naWNpdGx5IGRlY2xhcmVkIGluIHRoZSBtZXRhZGF0YS4KICAgICAqLwogICAg\ncHVibGljIGJvb2xlYW4gaXNFeHBsaWNpdCgpIHsKICAgICAgICByZXR1cm4g\nX2V4cGxpY2l0OwogICAgfQoKICAgIC8qKgogICAgICogV2hldGhlciB0aGlz\nIGZpZWxkIGlzIGV4cGxpY2l0bHkgZGVjbGFyZWQgaW4gdGhlIG1ldGFkYXRh\nLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRFeHBsaWNpdChib29sZWFu\nIGV4cGxpY2l0KSB7CiAgICAgICAgX2V4cGxpY2l0ID0gZXhwbGljaXQ7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBUaGUgZmllbGQgdGhhdCB0aGlzIGZpZWxk\nIHNoYXJlcyBhIG1hcHBpbmcgd2l0aC4KICAgICAqLwogICAgcHVibGljIFN0\ncmluZyBnZXRNYXBwZWRCeSgpIHsKICAgICAgICByZXR1cm4gX21hcHBlZEJ5\nOwogICAgfQoKICAgIC8qKgogICAgICogVGhlIGZpZWxkIHRoYXQgdGhpcyBm\naWVsZCBzaGFyZXMgYSBtYXBwaW5nIHdpdGguCiAgICAgKi8KICAgIHB1Ymxp\nYyB2b2lkIHNldE1hcHBlZEJ5KFN0cmluZyBtYXBwZWQpIHsKICAgICAgICBf\nbWFwcGVkQnkgPSBtYXBwZWQ7CiAgICAgICAgX21hcHBlZEJ5TWV0YSA9IG51\nbGw7CiAgICB9CgogICAgLyoqCiAgICAgKiBUaGUgZmllbGQgdGhhdCB0aGlz\nIGZpZWxkIHNoYXJlcyBhIG1hcHBpbmcgd2l0aC4KICAgICAqLwogICAgcHVi\nbGljIEZpZWxkTWV0YURhdGEgZ2V0TWFwcGVkQnlNZXRhRGF0YSgpIHsKICAg\nICAgICBpZiAoX21hcHBlZEJ5ICE9IG51bGwgJiYgX21hcHBlZEJ5TWV0YSA9\nPSBudWxsKSB7CiAgICAgICAgICAgIENsYXNzTWV0YURhdGEgbWV0YSA9IG51\nbGw7CiAgICAgICAgICAgIHN3aXRjaCAoZ2V0VHlwZUNvZGUoKSkgewogICAg\nICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuUEM6CiAgICAgICAgICAgICAg\nICAgICAgbWV0YSA9IGdldFR5cGVNZXRhRGF0YSgpOwogICAgICAgICAgICAg\nICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMu\nQVJSQVk6CiAgICAgICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5DT0xMRUNU\nSU9OOgogICAgICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuTUFQOgogICAg\nICAgICAgICAgICAgICAgIG1ldGEgPSBfZWxlbS5nZXRUeXBlTWV0YURhdGEo\nKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQoK\nICAgICAgICAgICAgRmllbGRNZXRhRGF0YSBmaWVsZCA9IChtZXRhID09IG51\nbGwpID8gbnVsbAogICAgICAgICAgICAgICAgOiBtZXRhLmdldEZpZWxkKF9t\nYXBwZWRCeSk7CiAgICAgICAgICAgIGlmIChmaWVsZCA9PSBudWxsKQogICAg\nICAgICAgICAgICAgdGhyb3cgbmV3IE1ldGFEYXRhRXhjZXB0aW9uKF9sb2Mu\nZ2V0KCJuby1tYXBwZWQtYnkiLCB0aGlzLAogICAgICAgICAgICAgICAgICAg\nIF9tYXBwZWRCeSkpOwogICAgICAgICAgICBpZiAoZmllbGQuZ2V0TWFwcGVk\nQnkoKSAhPSBudWxsKQogICAgICAgICAgICAgICAgdGhyb3cgbmV3IE1ldGFE\nYXRhRXhjZXB0aW9uKF9sb2MuZ2V0KCJjaXJjLW1hcHBlZC1ieSIsIHRoaXMs\nCiAgICAgICAgICAgICAgICAgICAgX21hcHBlZEJ5KSk7CiAgICAgICAgICAg\nIF9tYXBwZWRCeU1ldGEgPSBmaWVsZDsKICAgICAgICB9CiAgICAgICAgcmV0\ndXJuIF9tYXBwZWRCeU1ldGE7CiAgICB9CgogICAgLyoqCiAgICAgKiBMb2dp\nY2FsIGludmVyc2UgZmllbGQuCiAgICAgKi8KICAgIHB1YmxpYyBTdHJpbmcg\nZ2V0SW52ZXJzZSgpIHsKICAgICAgICBpZiAoQ2xhc3NNZXRhRGF0YS5ERUZB\nVUxUX1NUUklORy5lcXVhbHMoX2ludmVyc2UpKQogICAgICAgICAgICBfaW52\nZXJzZSA9IG51bGw7CiAgICAgICAgcmV0dXJuIF9pbnZlcnNlOwogICAgfQoK\nICAgIC8qKgogICAgICogTG9naWNhbCBpbnZlcnNlIGZpZWxkLgogICAgICov\nCiAgICBwdWJsaWMgdm9pZCBzZXRJbnZlcnNlKFN0cmluZyBpbnZlcnNlKSB7\nCiAgICAgICAgX2ludmVyc2VzID0gbnVsbDsKICAgICAgICBfaW52ZXJzZSA9\nIGludmVyc2U7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gYWxsIGlu\ndmVyc2VzIG9mIHRoaXMgZmllbGQuCiAgICAgKi8KICAgIHB1YmxpYyBGaWVs\nZE1ldGFEYXRhW10gZ2V0SW52ZXJzZU1ldGFEYXRhcygpIHsKICAgICAgICBp\nZiAoX2ludmVyc2VzID09IG51bGwpIHsKICAgICAgICAgICAgLy8gY2FuJ3Qg\nZGVjbGFyZSBib3RoIGFuIGludmVyc2Ugb3duZXIgYW5kIGEgbG9naWNhbCBp\nbnZlcnNlCiAgICAgICAgICAgIFN0cmluZyBpbnYgPSBnZXRJbnZlcnNlKCk7\nCiAgICAgICAgICAgIGlmIChfbWFwcGVkQnkgIT0gbnVsbCAmJiBpbnYgIT0g\nbnVsbCAmJiAhX21hcHBlZEJ5LmVxdWFscyhpbnYpKQogICAgICAgICAgICAg\nICAgdGhyb3cgbmV3IE1ldGFEYXRhRXhjZXB0aW9uKF9sb2MuZ2V0KCJtYXBw\nZWQtbm90LWludmVyc2UiLAogICAgICAgICAgICAgICAgICAgIHRoaXMpKTsK\nCiAgICAgICAgICAgIC8vIGdldCB0aGUgbWV0YWRhdGEgZm9yIHRoZSB0eXBl\nIG9uIHRoZSBvdGhlciBzaWRlIG9mIHRoaXMgcmVsYXRpb24KICAgICAgICAg\nICAgQ2xhc3NNZXRhRGF0YSBtZXRhID0gbnVsbDsKICAgICAgICAgICAgc3dp\ndGNoIChnZXRUeXBlQ29kZSgpKSB7CiAgICAgICAgICAgICAgICBjYXNlIEph\ndmFUeXBlcy5QQzoKICAgICAgICAgICAgICAgICAgICBtZXRhID0gZ2V0VHlw\nZU1ldGFEYXRhKCk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAg\nICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5BUlJBWToKICAgICAgICAgICAg\nICAgIGNhc2UgSmF2YVR5cGVzLkNPTExFQ1RJT046CiAgICAgICAgICAgICAg\nICAgICAgbWV0YSA9IF9lbGVtLmdldFR5cGVNZXRhRGF0YSgpOwogICAgICAg\nICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CgogICAgICAgICAg\nICBDb2xsZWN0aW9uIGludmVyc2VzID0gbnVsbDsKICAgICAgICAgICAgaWYg\nKG1ldGEgIT0gbnVsbCkgewogICAgICAgICAgICAgICAgLy8gYWRkIG1hcHBl\nZCBieSBhbmQgbmFtZWQgaW52ZXJzZSwgaWYgYW55CiAgICAgICAgICAgICAg\nICBGaWVsZE1ldGFEYXRhIGZpZWxkID0gZ2V0TWFwcGVkQnlNZXRhRGF0YSgp\nOwogICAgICAgICAgICAgICAgaWYgKGZpZWxkICE9IG51bGwpIHsKICAgICAg\nICAgICAgICAgICAgICAvLyBtYXBwZWQgYnkgZmllbGQgaXNuJ3QgbmVjZXNz\nYXJpbHkgYSBwYyB0eXBlLCBidXQgYWxsCiAgICAgICAgICAgICAgICAgICAg\nLy8gaW52ZXJzZXMgbXVzdCBiZQogICAgICAgICAgICAgICAgICAgIGlmIChm\naWVsZC5nZXRUeXBlQ29kZSgpID09IEphdmFUeXBlcy5QQwogICAgICAgICAg\nICAgICAgICAgICAgICB8fCBmaWVsZC5nZXRFbGVtZW50KCkuZ2V0VHlwZUNv\nZGUoKSA9PSBKYXZhVHlwZXMuUEMpIHsKICAgICAgICAgICAgICAgICAgICAg\nICAgaW52ZXJzZXMgPSBuZXcgQXJyYXlMaXN0KDMpOwogICAgICAgICAgICAg\nICAgICAgICAgICBpbnZlcnNlcy5hZGQoZmllbGQpOwogICAgICAgICAgICAg\nICAgICAgIH0KICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaW52ICE9IG51\nbGwpIHsKICAgICAgICAgICAgICAgICAgICBmaWVsZCA9IG1ldGEuZ2V0Rmll\nbGQoaW52KTsKICAgICAgICAgICAgICAgICAgICBpZiAoZmllbGQgPT0gbnVs\nbCkKICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IE1ldGFEYXRh\nRXhjZXB0aW9uKF9sb2MuZ2V0KCJuby1pbnZlcnNlIiwKICAgICAgICAgICAg\nICAgICAgICAgICAgICAgIHRoaXMsIGludikpOwogICAgICAgICAgICAgICAg\nICAgIGludmVyc2VzID0gbmV3IEFycmF5TGlzdCgzKTsKICAgICAgICAgICAg\nICAgICAgICBpbnZlcnNlcy5hZGQoZmllbGQpOwogICAgICAgICAgICAgICAg\nfQoKICAgICAgICAgICAgICAgIC8vIHNjYW4gcmVsIHR5cGUgZm9yIGZpZWxk\ncyB0aGF0IG5hbWUgdGhpcyBmaWVsZCBhcyBhbiBpbnZlcnNlCiAgICAgICAg\nICAgICAgICBGaWVsZE1ldGFEYXRhW10gZmllbGRzID0gbWV0YS5nZXRGaWVs\nZHMoKTsKICAgICAgICAgICAgICAgIENsYXNzIHR5cGUgPSBnZXREZWNsYXJp\nbmdNZXRhRGF0YSgpLmdldERlc2NyaWJlZFR5cGUoKTsKICAgICAgICAgICAg\nICAgIGZvciAoaW50IGkgPSAwOyBpIDwgZmllbGRzLmxlbmd0aDsgaSsrKSB7\nCiAgICAgICAgICAgICAgICAgICAgLy8gc2tpcCBmaWVsZHMgdGhhdCBhcmVu\nJ3QgY29tcGF0aWJsZSB3aXRoIG91ciBvd25pbmcgY2xhc3MKICAgICAgICAg\nICAgICAgICAgICBzd2l0Y2ggKGZpZWxkc1tpXS5nZXRUeXBlQ29kZSgpKSB7\nCiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLlBDOgog\nICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF0eXBlLmlzQXNzaWdu\nYWJsZUZyb20oZmllbGRzW2ldLmdldFR5cGUoKSkpCiAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgY2Fz\nZSBKYXZhVHlwZXMuQ09MTEVDVElPTjoKICAgICAgICAgICAgICAgICAgICAg\nICAgY2FzZSBKYXZhVHlwZXMuQVJSQVk6CiAgICAgICAgICAgICAgICAgICAg\nICAgICAgICBpZiAoIXR5cGUuaXNBc3NpZ25hYmxlRnJvbShmaWVsZHNbaV0u\nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2V0RWxlbWVudCgp\nLmdldFR5cGUoKSkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nY29udGludWU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsK\nICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAg\nICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICAgICAgICAg\nIH0KCiAgICAgICAgICAgICAgICAgICAgLy8gaWYgdGhlIGZpZWxkIGRlY2xh\ncmVzIHVzIGFzIGl0cyBpbnZlcnNlIGFuZCB3ZSBoYXZlbid0CiAgICAgICAg\nICAgICAgICAgICAgLy8gYWxyZWFkeSBhZGRlZCBpdCAod2UgbWlnaHQgaGF2\nZSBpZiB3ZSBhbHNvIGRlY2xhcmVkIGl0CiAgICAgICAgICAgICAgICAgICAg\nLy8gYXMgb3VyIGludmVyc2UpLCBhZGQgaXQgbm93CiAgICAgICAgICAgICAg\nICAgICAgaWYgKF9uYW1lLmVxdWFscyhmaWVsZHNbaV0uZ2V0TWFwcGVkQnko\nKSkKICAgICAgICAgICAgICAgICAgICAgICAgfHwgX25hbWUuZXF1YWxzKGZp\nZWxkc1tpXS5nZXRJbnZlcnNlKCkpKSB7CiAgICAgICAgICAgICAgICAgICAg\nICAgIGlmIChpbnZlcnNlcyA9PSBudWxsKQogICAgICAgICAgICAgICAgICAg\nICAgICAgICAgaW52ZXJzZXMgPSBuZXcgQXJyYXlMaXN0KDMpOwogICAgICAg\nICAgICAgICAgICAgICAgICBpZiAoIWludmVyc2VzLmNvbnRhaW5zKGZpZWxk\nc1tpXSkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnZlcnNlcy5h\nZGQoZmllbGRzW2ldKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAg\nICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIE1ldGFEYXRh\nUmVwb3NpdG9yeSByZXBvcyA9IGdldFJlcG9zaXRvcnkoKTsKICAgICAgICAg\nICAgaWYgKGludmVyc2VzID09IG51bGwpCiAgICAgICAgICAgICAgICBfaW52\nZXJzZXMgPSByZXBvcy5FTVBUWV9GSUVMRFM7CiAgICAgICAgICAgIGVsc2UK\nICAgICAgICAgICAgICAgIF9pbnZlcnNlcyA9IChGaWVsZE1ldGFEYXRhW10p\nIGludmVyc2VzLnRvQXJyYXkKICAgICAgICAgICAgICAgICAgICAocmVwb3Mu\nbmV3RmllbGRNZXRhRGF0YUFycmF5KGludmVyc2VzLnNpemUoKSkpOwogICAg\nICAgIH0KICAgICAgICByZXR1cm4gX2ludmVyc2VzOwogICAgfQoKICAgIC8q\nKgogICAgICogVGhlIHN0cmF0ZWd5IHRvIHVzZSBmb3IgaW5zZXJ0IHZhbHVl\nIGdlbmVyYXRpb24uCiAgICAgKiBPbmUgb2YgdGhlIGNvbnN0YW50cyBmcm9t\nIHtAbGluayBWYWx1ZVN0cmF0ZWdpZXN9LgogICAgICovCiAgICBwdWJsaWMg\naW50IGdldFZhbHVlU3RyYXRlZ3koKSB7CiAgICAgICAgaWYgKF92YWxTdHJh\ndGVneSA9PSAtMSkKICAgICAgICAgICAgX3ZhbFN0cmF0ZWd5ID0gVmFsdWVT\ndHJhdGVnaWVzLk5PTkU7CiAgICAgICAgcmV0dXJuIF92YWxTdHJhdGVneTsK\nICAgIH0KCiAgICAvKioKICAgICAqIFRoZSBzdHJhdGVneSB0byB1c2UgZm9y\nIGluc2VydCB2YWx1ZSBnZW5lcmF0aW9uLgogICAgICogT25lIG9mIHRoZSBj\nb25zdGFudHMgZnJvbSB7QGxpbmsgVmFsdWVTdHJhdGVnaWVzfS4KICAgICAq\nLwogICAgcHVibGljIHZvaWQgc2V0VmFsdWVTdHJhdGVneShpbnQgc3RyYXRl\nZ3kpIHsKICAgICAgICBfdmFsU3RyYXRlZ3kgPSBzdHJhdGVneTsKICAgICAg\nICBpZiAoc3RyYXRlZ3kgIT0gVmFsdWVTdHJhdGVnaWVzLlNFUVVFTkNFKQog\nICAgICAgICAgICBzZXRWYWx1ZVNlcXVlbmNlTmFtZShudWxsKTsKICAgIH0K\nCiAgICAvKioKICAgICAqIFRoZSB2YWx1ZSBzZXF1ZW5jZSBuYW1lLCBvciBu\ndWxsIGZvciBub25lLgogICAgICovCiAgICBwdWJsaWMgU3RyaW5nIGdldFZh\nbHVlU2VxdWVuY2VOYW1lKCkgewogICAgICAgIGlmIChDbGFzc01ldGFEYXRh\nLkRFRkFVTFRfU1RSSU5HLmVxdWFscyhfc2VxTmFtZSkpCiAgICAgICAgICAg\nIF9zZXFOYW1lID0gbnVsbDsKICAgICAgICByZXR1cm4gX3NlcU5hbWU7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBUaGUgdmFsdWUgc2VxdWVuY2UgbmFtZSwg\nb3IgbnVsbCBmb3Igbm9uZS4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0\nVmFsdWVTZXF1ZW5jZU5hbWUoU3RyaW5nIHNlcU5hbWUpIHsKICAgICAgICBf\nc2VxTmFtZSA9IHNlcU5hbWU7CiAgICAgICAgX3NlcU1ldGEgPSBudWxsOwog\nICAgICAgIGlmIChzZXFOYW1lICE9IG51bGwpCiAgICAgICAgICAgIHNldFZh\nbHVlU3RyYXRlZ3koVmFsdWVTdHJhdGVnaWVzLlNFUVVFTkNFKTsKICAgIH0K\nCiAgICAvKioKICAgICAqIE1ldGFkYXRhIGZvciB0aGUgdmFsdWUgc2VxdWVu\nY2UuCiAgICAgKi8KICAgIHB1YmxpYyBTZXF1ZW5jZU1ldGFEYXRhIGdldFZh\nbHVlU2VxdWVuY2VNZXRhRGF0YSgpIHsKICAgICAgICBpZiAoX3NlcU1ldGEg\nPT0gbnVsbCAmJiBnZXRWYWx1ZVNlcXVlbmNlTmFtZSgpICE9IG51bGwpCiAg\nICAgICAgICAgIF9zZXFNZXRhID0gZ2V0UmVwb3NpdG9yeSgpLmdldFNlcXVl\nbmNlTWV0YURhdGEoX293bmVyLAogICAgICAgICAgICAgICAgZ2V0VmFsdWVT\nZXF1ZW5jZU5hbWUoKSwgdHJ1ZSk7CiAgICAgICAgcmV0dXJuIF9zZXFNZXRh\nOwogICAgfQoKICAgIC8qKgogICAgICogVGhlIHN0cmF0ZWd5IHRvIHVzZSB3\naGVuIHVwZGF0aW5nIHRoZSBmaWVsZC4KICAgICAqLwogICAgcHVibGljIGlu\ndCBnZXRVcGRhdGVTdHJhdGVneSgpIHsKICAgICAgICBpZiAoaXNWZXJzaW9u\nKCkpCiAgICAgICAgICAgIHJldHVybiBVcGRhdGVTdHJhdGVnaWVzLlJFU1RS\nSUNUOwogICAgICAgIGlmIChfdXBTdHJhdGVneSA9PSAtMSkKICAgICAgICAg\nICAgX3VwU3RyYXRlZ3kgPSBVcGRhdGVTdHJhdGVnaWVzLk5PTkU7CiAgICAg\nICAgcmV0dXJuIF91cFN0cmF0ZWd5OwogICAgfQoKICAgIC8qKgogICAgICog\nU2V0IHRoZSB1cGRhdGUgc3RyYXRlZ3kuCiAgICAgKi8KICAgIHB1YmxpYyB2\nb2lkIHNldFVwZGF0ZVN0cmF0ZWd5KGludCBzdHJhdGVneSkgewogICAgICAg\nIF91cFN0cmF0ZWd5ID0gc3RyYXRlZ3k7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBXaGV0aGVyIHRoaXMgZmllbGQgaXMgYmFja2VkIGJ5IGEgbGFyZ2UgcmVz\ndWx0IHNldC4KICAgICAqLwogICAgcHVibGljIGJvb2xlYW4gaXNMUlMoKSB7\nCiAgICAgICAgcmV0dXJuIF9scnMgPT0gQm9vbGVhbi5UUlVFICYmIF9tYW5h\nZ2UgPT0gTUFOQUdFX1BFUlNJU1RFTlQ7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBXaGV0aGVyIHRoaXMgZmllbGQgaXMgYmFja2VkIGJ5IGEgbGFyZ2UgcmVz\ndWx0IHNldC4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0TFJTKGJvb2xl\nYW4gbHJzKSB7CiAgICAgICAgX2xycyA9IChscnMpID8gQm9vbGVhbi5UUlVF\nIDogQm9vbGVhbi5GQUxTRTsKICAgIH0KCiAgICAvKioKICAgICAqIFdoZXRo\nZXIgdGhpcyBmaWVsZCBpcyBiYWNrZWQgYnkgYSBzdHJlYW0uCiAgICAgKgog\nICAgICogQHNpbmNlIDEuMS4wCiAgICAgKi8KICAgIHB1YmxpYyBib29sZWFu\nIGlzU3RyZWFtKCkgewogICAgICAgIHJldHVybiBfc3RyZWFtID09IEJvb2xl\nYW4uVFJVRSAmJiBfbWFuYWdlID09IE1BTkFHRV9QRVJTSVNURU5UOwogICAg\nfQogICAgCiAgICAvKioKICAgICAqIFdoZXRoZXIgdGhpcyBmaWVsZCBpcyBi\nYWNrZWQgYnkgYSBzdHJlYW0uCiAgICAgKgogICAgICogQHNpbmNlIDEuMS4w\nCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldFN0cmVhbShib29sZWFuIHN0\ncmVhbSkgewogICAgICAgIF9zdHJlYW0gPSAoc3RyZWFtKSA/IEJvb2xlYW4u\nVFJVRSA6IEJvb2xlYW4uRkFMU0U7CiAgICB9CiAgICAKICAgIC8qKgogICAg\nICogV2hldGhlciB0aGlzIGZpZWxkIHVzZXMgaW50ZXJtZWRpYXRlIGRhdGEg\nd2hlbiBsb2FkaW5nL3N0b3JpbmcKICAgICAqIGluZm9ybWF0aW9uIHRocm91\nZ2ggYSB7QGxpbmsgT3BlbkpQQVN0YXRlTWFuYWdlcn0uIERlZmF1bHRzIHRv\nIHRydWUuCiAgICAgKgogICAgICogQHNlZSBPcGVuSlBBU3RhdGVNYW5hZ2Vy\nI3NldEludGVybWVkaWF0ZShpbnQsT2JqZWN0KQogICAgICovCiAgICBwdWJs\naWMgYm9vbGVhbiB1c2VzSW50ZXJtZWRpYXRlKCkgewogICAgICAgIHJldHVy\nbiBfaW50ZXJtZWRpYXRlOwogICAgfQoKICAgIC8qKgogICAgICogV2hldGhl\nciB0aGlzIGZpZWxkIHVzZXMgaW50ZXJtZWRpYXRlIGRhdGEgd2hlbiBsb2Fk\naW5nL3N0b3JpbmcKICAgICAqIGluZm9ybWF0aW9uIHRocm91Z2ggYSB7QGxp\nbmsgT3BlbkpQQVN0YXRlTWFuYWdlcn0uIERlZmF1bHRzIHRvIHRydWUuCiAg\nICAgKgogICAgICogQHNlZSBPcGVuSlBBU3RhdGVNYW5hZ2VyI3NldEludGVy\nbWVkaWF0ZShpbnQsT2JqZWN0KQogICAgICovCiAgICBwdWJsaWMgdm9pZCBz\nZXRVc2VzSW50ZXJtZWRpYXRlKGJvb2xlYW4gaW50ZXJtZWRpYXRlKSB7CiAg\nICAgICAgX2ludGVybWVkaWF0ZSA9IGludGVybWVkaWF0ZTsKICAgICAgICBf\nb3duZXIuY2xlYXJFeHRyYUZpZWxkRGF0YVRhYmxlKCk7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBXaGV0aGVyIHRoaXMgZmllbGQgdXNlcyBpbXBsIGRhdGEg\naW4gY29uanVuY3Rpb24gd2l0aCBzdGFuZGFyZAogICAgICogZmllbGQgZGF0\nYSB3aGVuIGFjdGluZyBvbiBhIHtAbGluayBPcGVuSlBBU3RhdGVNYW5hZ2Vy\nfS4KICAgICAqIERlZmF1bHRzIHRvIHtAbGluayBCb29sZWFuI1RSVUV9IChu\nb24tY2FjaGFibGUgaW1wbCBkYXRhKS4KICAgICAqCiAgICAgKiBAcmV0dXJu\nIHtAbGluayBCb29sZWFuI0ZBTFNFfSBpZiB0aGlzIGZpZWxkIGRvZXMgbm90\nIHVzZSBpbXBsIGRhdGEsCiAgICAgKiB7QGxpbmsgQm9vbGVhbiNUUlVFfSBp\nZiB0aGlzIGZpZWxkIHVzZXMgbm9uLWNhY2hhYmxlIGltcGwKICAgICAqIGRh\ndGEsIG9yIDxjb2RlPm51bGw8L2NvZGU+IGlmIHRoaXMgZmllbGQgdXNlcyBp\nbXBsIGRhdGEgdGhhdAogICAgICogc2hvdWxkIGJlIGNhY2hlZCBhY3Jvc3Mg\naW5zdGFuY2VzCiAgICAgKiBAc2VlIE9wZW5KUEFTdGF0ZU1hbmFnZXIjc2V0\nSW1wbERhdGEoaW50LE9iamVjdCkKICAgICAqLwogICAgcHVibGljIEJvb2xl\nYW4gdXNlc0ltcGxEYXRhKCkgewogICAgICAgIHJldHVybiBfaW1wbERhdGE7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBXaGV0aGVyIHRoaXMgZmllbGQgdXNl\ncyBpbXBsIGRhdGEgaW4gY29uanVuY3Rpb24gd2l0aCBzdGFuZGFyZAogICAg\nICogZmllbGQgZGF0YSB3aGVuIGFjdGluZyBvbiBhIHtAbGluayBPcGVuSlBB\nU3RhdGVNYW5hZ2VyfS4KICAgICAqCiAgICAgKiBAc2VlIE9wZW5KUEFTdGF0\nZU1hbmFnZXIjc2V0SW1wbERhdGEoaW50LE9iamVjdCkKICAgICAqIEBzZWUg\nI3VzZXNJbXBsRGF0YQogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRVc2Vz\nSW1wbERhdGEoQm9vbGVhbiBpbXBsRGF0YSkgewogICAgICAgIF9pbXBsRGF0\nYSA9IGltcGxEYXRhOwogICAgICAgIF9vd25lci5jbGVhckV4dHJhRmllbGRE\nYXRhVGFibGUoKTsKICAgIH0KCiAgICAvKioKICAgICAqIFRoZSBvcmRlcmlu\nZ3MgZm9yIHRoaXMgZmllbGQgdG8gYmUgYXBwbGllZCBvbiBsb2FkLCBvciBl\nbXB0eSBhcnJheS4KICAgICAqLwogICAgcHVibGljIE9yZGVyW10gZ2V0T3Jk\nZXJzKCkgewogICAgICAgIGlmIChfb3JkZXJzID09IG51bGwpIHsKICAgICAg\nICAgICAgaWYgKF9vcmRlckRlYyA9PSBudWxsKQogICAgICAgICAgICAgICAg\nX29yZGVycyA9IGdldFJlcG9zaXRvcnkoKS5FTVBUWV9PUkRFUlM7CiAgICAg\nICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgU3RyaW5nW10gZGVjcyA9\nIFN0cmluZ3Muc3BsaXQoX29yZGVyRGVjLCAiLCIsIDApOwogICAgICAgICAg\nICAgICAgT3JkZXJbXSBvcmRlcnMgPSBnZXRSZXBvc2l0b3J5KCkubmV3T3Jk\nZXJBcnJheShkZWNzLmxlbmd0aCk7CiAgICAgICAgICAgICAgICBpbnQgc3Bj\nOwogICAgICAgICAgICAgICAgYm9vbGVhbiBhc2M7CiAgICAgICAgICAgICAg\nICBmb3IgKGludCBpID0gMDsgaSA8IGRlY3MubGVuZ3RoOyBpKyspIHsKICAg\nICAgICAgICAgICAgICAgICBkZWNzW2ldID0gZGVjc1tpXS50cmltKCk7CiAg\nICAgICAgICAgICAgICAgICAgc3BjID0gZGVjc1tpXS5pbmRleE9mKCcgJyk7\nCiAgICAgICAgICAgICAgICAgICAgaWYgKHNwYyA9PSAtMSkKICAgICAgICAg\nICAgICAgICAgICAgICAgYXNjID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAg\nICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgYXNjID0gZGVjc1tp\nXS5zdWJzdHJpbmcoc3BjICsgMSkudHJpbSgpLgogICAgICAgICAgICAgICAg\nICAgICAgICAgICAgdG9Mb3dlckNhc2UoKS5zdGFydHNXaXRoKCJhc2MiKTsK\nICAgICAgICAgICAgICAgICAgICAgICAgZGVjc1tpXSA9IGRlY3NbaV0uc3Vi\nc3RyaW5nKDAsIHNwYyk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAg\nICAgICAgICAgICAgIG9yZGVyc1tpXSA9IGdldFJlcG9zaXRvcnkoKS5uZXdP\ncmRlcih0aGlzLCBkZWNzW2ldLCBhc2MpOwogICAgICAgICAgICAgICAgICAg\nIC8vc2V0ICJpc1VzZWRJbk9yZGVyQnkiIHRvIHRoZSBmaWVsZAogICAgICAg\nICAgICAgICAgICAgIENsYXNzTWV0YURhdGEgZWxlbUNscyA9IGdldEVsZW1l\nbnQoKQogICAgICAgICAgICAgICAgICAgICAgICAuZ2V0RGVjbGFyZWRUeXBl\nTWV0YURhdGEoKTsKICAgICAgICAgICAgICAgICAgICBpZiAoZWxlbUNscyAh\nPSBudWxsKSB7CiAgICAgICAgICAgICAgICAgICAgICBGaWVsZE1ldGFEYXRh\nIGZtZCA9IGVsZW1DbHMuZ2V0RGVjbGFyZWRGaWVsZChkZWNzW2ldKTsKICAg\nICAgICAgICAgICAgICAgICAgIGlmIChmbWQgIT0gbnVsbCkKICAgICAgICAg\nICAgICAgICAgICAgICAgZm1kLnNldFVzZWRJbk9yZGVyQnkodHJ1ZSk7ICAg\nICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIH0KICAg\nICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIF9vcmRlcnMgPSBvcmRl\ncnM7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIF9v\ncmRlcnM7CiAgICB9CgogICAgLyoqCiAgICAgKiBUaGUgb3JkZXJpbmdzIGZv\nciB0aGlzIGZpZWxkIHRvIGJlIGFwcGxpZWQgb24gbG9hZC4KICAgICAqLwog\nICAgcHVibGljIHZvaWQgc2V0T3JkZXJzKE9yZGVyW10gb3JkZXJzKSB7CiAg\nICAgICAgX29yZGVyRGVjID0gbnVsbDsKICAgICAgICBfb3JkZXJzID0gb3Jk\nZXJzOwogICAgfQoKICAgIC8qKgogICAgICogU3RyaW5nIGRlY2xhcmluZyB0\naGUgb3JkZXJpbmdzIGZvciB0aGlzIGZpZWxkIHRvIGJlIGFwcGxpZWQgb24g\nbG9hZCwKICAgICAqIG9yIG51bGwuIFRoZSBzdHJpbmcgaXMgb2YgdGhlIGZv\ncm06PGJyIC8+CiAgICAgKiA8Y29kZT5vcmRlcmFibGVbIGFzY3xkZXNjXVss\nIC4uLl08L2NvZGU+PGJyIC8+CiAgICAgKiBUaGUgb3JkZXJhYmxlIDxjb2Rl\nPiNlbGVtZW50PC9jb2RlPiBpcyB1c2VkIHRvIGRlbm90ZSB0aGUgdmFsdWUg\nb2YKICAgICAqIHRoZSBmaWVsZCdzIGVsZW1lbnRzLgogICAgICovCiAgICBw\ndWJsaWMgU3RyaW5nIGdldE9yZGVyRGVjbGFyYXRpb24oKSB7CiAgICAgICAg\naWYgKF9vcmRlckRlYyA9PSBudWxsICYmIF9vcmRlcnMgIT0gbnVsbCkgewog\nICAgICAgICAgICBTdHJpbmdCdWZmZXIgYnVmID0gbmV3IFN0cmluZ0J1ZmZl\ncigpOwogICAgICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IF9vcmRlcnMu\nbGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICAgIGlmIChpID4gMCkKICAg\nICAgICAgICAgICAgICAgICBidWYuYXBwZW5kKCIsICIpOwogICAgICAgICAg\nICAgICAgYnVmLmFwcGVuZChfb3JkZXJzW2ldLmdldE5hbWUoKSkuYXBwZW5k\nKCIgIik7CiAgICAgICAgICAgICAgICBidWYuYXBwZW5kKChfb3JkZXJzW2ld\nLmlzQXNjZW5kaW5nKCkpID8gImFzYyIgOiAiZGVzYyIpOwogICAgICAgICAg\nICB9CiAgICAgICAgICAgIF9vcmRlckRlYyA9IGJ1Zi50b1N0cmluZygpOwog\nICAgICAgIH0KICAgICAgICByZXR1cm4gX29yZGVyRGVjOwogICAgfQoKICAg\nIC8qKgogICAgICogU3RyaW5nIGRlY2xhcmluZyB0aGUgb3JkZXJpbmdzIGZv\nciB0aGlzIGZpZWxkIHRvIGJlIGFwcGxpZWQgb24gbG9hZCwKICAgICAqIG9y\nIG51bGwuIFRoZSBzdHJpbmcgaXMgb2YgdGhlIGZvcm06PGJyIC8+CiAgICAg\nKiA8Y29kZT5vcmRlcmFibGVbIGFzY3xkZXNjXVssIC4uLl08L2NvZGU+PGJy\nIC8+CiAgICAgKiBUaGUgb3JkZXJhYmxlIDxjb2RlPiNlbGVtZW50PC9jb2Rl\nPiBpcyB1c2VkIHRvIGRlbm90ZSB0aGUgdmFsdWUgb2YKICAgICAqIHRoZSBm\naWVsZCdzIGVsZW1lbnRzLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRP\ncmRlckRlY2xhcmF0aW9uKFN0cmluZyBkZWMpIHsKICAgICAgICBfb3JkZXJE\nZWMgPSBTdHJpbmdVdGlscy50cmltVG9OdWxsKGRlYyk7CiAgICAgICAgX29y\nZGVycyA9IG51bGw7CiAgICB9CgogICAgLyoqCiAgICAgKiBPcmRlciB0aGlz\nIGZpZWxkIHZhbHVlIHdoZW4gaXQgaXMgbG9hZGVkLgogICAgICovCiAgICBw\ndWJsaWMgT2JqZWN0IG9yZGVyKE9iamVjdCB2YWwpIHsKICAgICAgICBpZiAo\ndmFsID09IG51bGwpCiAgICAgICAgICAgIHJldHVybiBudWxsOwoKICAgICAg\nICBPcmRlcltdIG9yZGVycyA9IGdldE9yZGVycygpOwogICAgICAgIGlmIChv\ncmRlcnMubGVuZ3RoID09IDApCiAgICAgICAgICAgIHJldHVybiB2YWw7Cgog\nICAgICAgIC8vIGNyZWF0ZSBhIGNvbXBhcmF0b3IgZm9yIHRoZSBlbGVtZW50\ncyBvZiB0aGUgdmFsdWUKICAgICAgICBDb21wYXJhdG9yIGNvbXA7CiAgICAg\nICAgaWYgKG9yZGVycy5sZW5ndGggPT0gMSkKICAgICAgICAgICAgY29tcCA9\nIG9yZGVyc1swXS5nZXRDb21wYXJhdG9yKCk7CiAgICAgICAgZWxzZSB7CiAg\nICAgICAgICAgIExpc3QgY29tcHMgPSBudWxsOwogICAgICAgICAgICBDb21w\nYXJhdG9yIGN1ckNvbXA7CiAgICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBp\nIDwgb3JkZXJzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgICBjdXJD\nb21wID0gb3JkZXJzW2ldLmdldENvbXBhcmF0b3IoKTsKICAgICAgICAgICAg\nICAgIGlmIChjdXJDb21wICE9IG51bGwpIHsKICAgICAgICAgICAgICAgICAg\nICBpZiAoY29tcHMgPT0gbnVsbCkKICAgICAgICAgICAgICAgICAgICAgICAg\nY29tcHMgPSBuZXcgQXJyYXlMaXN0KG9yZGVycy5sZW5ndGgpOwogICAgICAg\nICAgICAgICAgICAgIGlmIChpICE9IGNvbXBzLnNpemUoKSkKICAgICAgICAg\nICAgICAgICAgICAgICAgdGhyb3cgbmV3IE1ldGFEYXRhRXhjZXB0aW9uKF9s\nb2MuZ2V0CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAoIm1peGVkLWlu\nbWVtLW9yZGVyaW5nIiwgdGhpcykpOwogICAgICAgICAgICAgICAgICAgIGNv\nbXBzLmFkZChjdXJDb21wKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAg\nICAgfQogICAgICAgICAgICBpZiAoY29tcHMgPT0gbnVsbCkKICAgICAgICAg\nICAgICAgIGNvbXAgPSBudWxsOwogICAgICAgICAgICBlbHNlCiAgICAgICAg\nICAgICAgICBjb21wID0gbmV3IENvbXBhcmF0b3JDaGFpbihjb21wcyk7CiAg\nICAgICAgfQoKICAgICAgICBpZiAoY29tcCA9PSBudWxsKQogICAgICAgICAg\nICByZXR1cm4gdmFsOwoKICAgICAgICAvLyBzb3J0CiAgICAgICAgc3dpdGNo\nIChnZXRUeXBlQ29kZSgpKSB7CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVz\nLkFSUkFZOgogICAgICAgICAgICAgICAgTGlzdCBsID0gSmF2YVR5cGVzLnRv\nTGlzdCh2YWwsIF9lbGVtLmdldFR5cGUoKSwgdHJ1ZSk7CiAgICAgICAgICAg\nICAgICBDb2xsZWN0aW9ucy5zb3J0KGwsIGNvbXApOwogICAgICAgICAgICAg\nICAgcmV0dXJuIEphdmFUeXBlcy50b0FycmF5KGwsIF9lbGVtLmdldFR5cGUo\nKSk7CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLkNPTExFQ1RJT046CiAg\nICAgICAgICAgICAgICBpZiAodmFsIGluc3RhbmNlb2YgTGlzdCkKICAgICAg\nICAgICAgICAgICAgICBDb2xsZWN0aW9ucy5zb3J0KChMaXN0KSB2YWwsIGNv\nbXApOwogICAgICAgICAgICAgICAgcmV0dXJuIHZhbDsKICAgICAgICAgICAg\nZGVmYXVsdDoKICAgICAgICAgICAgICAgIHRocm93IG5ldyBNZXRhRGF0YUV4\nY2VwdGlvbihfbG9jLmdldCgiY2FudC1vcmRlciIsIHRoaXMpKTsKICAgICAg\nICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBXaGV0aGVyIHRoZSBmaWVsZCBp\ncyBleHRlcm5hbGl6ZWQuCiAgICAgKi8KICAgIHB1YmxpYyBib29sZWFuIGlz\nRXh0ZXJuYWxpemVkKCkgewogICAgICAgIHJldHVybiBnZXRFeHRlcm5hbGl6\nZXJNZXRob2QoKSAhPSBudWxsCiAgICAgICAgICAgIHx8IGdldEV4dGVybmFs\nVmFsdWVNYXAoKSAhPSBudWxsOwogICAgfQoKICAgIC8qKgogICAgICogQ29u\ndmVydCB0aGUgZ2l2ZW4gZmllbGQgdmFsdWUgdG8gaXRzIGV4dGVybmFsIHZh\nbHVlIHRocm91Z2ggdGhlCiAgICAgKiBwcm92aWRlZCBleHRlcm5hbGl6ZXIs\nIG9yIHJldHVybiB0aGUgdmFsdWUgYXMtaXMgaWYgbm8gZXh0ZXJuYWxpemVy\nLgogICAgICovCiAgICBwdWJsaWMgT2JqZWN0IGdldEV4dGVybmFsVmFsdWUo\nT2JqZWN0IHZhbCwgU3RvcmVDb250ZXh0IGN0eCkgewogICAgICAgIE1hcCBl\neHRWYWx1ZXMgPSBnZXRFeHRlcm5hbFZhbHVlTWFwKCk7CiAgICAgICAgaWYg\nKGV4dFZhbHVlcyAhPSBudWxsKSB7CiAgICAgICAgICAgIE9iamVjdCBmb3Vu\nZFZhbCA9IGV4dFZhbHVlcy5nZXQodmFsKTsKICAgICAgICAgICAgaWYgKGZv\ndW5kVmFsID09IG51bGwpIHsKICAgICAgICAgICAgICAgIHRocm93IG5ldyBV\nc2VyRXhjZXB0aW9uKF9sb2MuZ2V0KCJiYWQtZXh0ZXJuYWxpemVkLXZhbHVl\nIiwKICAgICAgICAgICAgICAgICAgICAgICAgbmV3IE9iamVjdFtdIHsgdmFs\nLCBleHRWYWx1ZXMua2V5U2V0KCksIHRoaXMgfSkpCiAgICAgICAgICAgICAg\nICAgICAgICAgIC5zZXRGYXRhbCh0cnVlKS5zZXRGYWlsZWRPYmplY3QodmFs\nKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHJldHVy\nbiBmb3VuZFZhbDsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAg\nTWV0aG9kIGV4dGVybmFsaXplciA9IGdldEV4dGVybmFsaXplck1ldGhvZCgp\nOwogICAgICAgIGlmIChleHRlcm5hbGl6ZXIgPT0gbnVsbCkKICAgICAgICAg\nICAgcmV0dXJuIHZhbDsKCiAgICAgICAgLy8gc3BlY2lhbCBjYXNlIGZvciBx\ndWVyaWVzOiBhbGxvdyB0aGUgZ2l2ZW4gdmFsdWUgdG8gcGFzcyB0aHJvdWdo\nCiAgICAgICAgLy8gYXMtaXMgaWYgaXQgaXMgYWxyZWFkeSBpbiBleHRlcm5h\nbGl6ZWQgZm9ybQogICAgICAgIGlmICh2YWwgIT0gbnVsbCAmJiBnZXRUeXBl\nKCkuaXNJbnN0YW5jZSh2YWwpCiAgICAgICAgICAgICYmICghZ2V0RGVjbGFy\nZWRUeXBlKCkuaXNJbnN0YW5jZSh2YWwpCiAgICAgICAgICAgIHx8IGdldERl\nY2xhcmVkVHlwZSgpID09IE9iamVjdC5jbGFzcykpCiAgICAgICAgICAgIHJl\ndHVybiB2YWw7CgogICAgICAgIHRyeSB7CiAgICAgICAgICAgIC8vIGVpdGhl\nciBpbnZva2UgdGhlIHN0YXRpYyB0b0V4dGVybmFsKHZhbFssIGN0eF0pIG1l\ndGhvZCwgb3IgdGhlCiAgICAgICAgICAgIC8vIG5vbi1zdGF0aWMgdmFsLnRv\nRXh0ZXJuYWwoW2N0eF0pIG1ldGhvZAogICAgICAgICAgICBpZiAoTW9kaWZp\nZXIuaXNTdGF0aWMoZXh0ZXJuYWxpemVyLmdldE1vZGlmaWVycygpKSkgewog\nICAgICAgICAgICAgICAgaWYgKGV4dGVybmFsaXplci5nZXRQYXJhbWV0ZXJU\neXBlcygpLmxlbmd0aCA9PSAxKQogICAgICAgICAgICAgICAgICAgIHJldHVy\nbiBleHRlcm5hbGl6ZXIuaW52b2tlKG51bGwsIG5ldyBPYmplY3RbXXsgdmFs\nIH0pOwogICAgICAgICAgICAgICAgcmV0dXJuIGV4dGVybmFsaXplci5pbnZv\na2UobnVsbCwgbmV3IE9iamVjdFtdeyB2YWwsIGN0eCB9KTsKICAgICAgICAg\nICAgfQogICAgICAgICAgICBpZiAodmFsID09IG51bGwpCiAgICAgICAgICAg\nICAgICByZXR1cm4gbnVsbDsKICAgICAgICAgICAgaWYgKGV4dGVybmFsaXpl\nci5nZXRQYXJhbWV0ZXJUeXBlcygpLmxlbmd0aCA9PSAwKQogICAgICAgICAg\nICAgICAgcmV0dXJuIGV4dGVybmFsaXplci5pbnZva2UodmFsLCAoT2JqZWN0\nW10pIG51bGwpOwogICAgICAgICAgICByZXR1cm4gZXh0ZXJuYWxpemVyLmlu\ndm9rZSh2YWwsIG5ldyBPYmplY3RbXXsgY3R4IH0pOwogICAgICAgIH0gY2F0\nY2ggKE9wZW5KUEFFeGNlcHRpb24ga2UpIHsKICAgICAgICAgICAgdGhyb3cg\na2U7CiAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICAg\nICAgdGhyb3cgbmV3IE1ldGFEYXRhRXhjZXB0aW9uKF9sb2MuZ2V0KCJleHRl\ncm5hbGl6ZXItZXJyIiwgdGhpcywKICAgICAgICAgICAgICAgIEV4Y2VwdGlv\nbnMudG9TdHJpbmcodmFsKSwgZS50b1N0cmluZygpKSkuc2V0Q2F1c2UoZSk7\nCiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRoZSBy\nZXN1bHQgb2YgcGFzc2luZyB0aGUgZ2l2ZW4gZXh0ZXJuYWwgdmFsdWUgdGhy\nb3VnaCB0aGUKICAgICAqIGZhY3RvcnkgdG8gZ2V0IHRoZSBmaWVsZCB2YWx1\nZS4gSWYgbm8gZmFjdG9yeSBpcyBwcmVzZW50LAogICAgICogdGhlIGdpdmVu\nIHZhbHVlIGlzIHJldHVybmVkIGFzLWlzLgogICAgICovCiAgICBwdWJsaWMg\nT2JqZWN0IGdldEZpZWxkVmFsdWUoT2JqZWN0IHZhbCwgU3RvcmVDb250ZXh0\nIGN0eCkgewogICAgICAgIE1hcCBmaWVsZFZhbHVlcyA9IGdldEZpZWxkVmFs\ndWVNYXAoKTsKICAgICAgICBpZiAoZmllbGRWYWx1ZXMgIT0gbnVsbCkKICAg\nICAgICAgICAgcmV0dXJuIGZpZWxkVmFsdWVzLmdldCh2YWwpOwoKICAgICAg\nICBNZW1iZXIgZmFjdG9yeSA9IGdldEZhY3RvcnlNZXRob2QoKTsKICAgICAg\nICBpZiAoZmFjdG9yeSA9PSBudWxsKQogICAgICAgICAgICByZXR1cm4gdmFs\nOwoKICAgICAgICB0cnkgewogICAgICAgICAgICBpZiAodmFsID09IG51bGwg\nJiYgZ2V0TnVsbFZhbHVlKCkgPT0gTlVMTF9ERUZBVUxUKQogICAgICAgICAg\nICAgICAgcmV0dXJuIEFjY2Vzc0NvbnRyb2xsZXIuZG9Qcml2aWxlZ2VkKAog\nICAgICAgICAgICAgICAgICAgIEoyRG9Qcml2SGVscGVyLm5ld0luc3RhbmNl\nQWN0aW9uKGdldERlY2xhcmVkVHlwZSgpKSk7IAoKICAgICAgICAgICAgLy8g\naW52b2tlIGVpdGhlciB0aGUgY29uc3RydWN0b3IgZm9yIHRoZSBmaWVsZCB0\neXBlLAogICAgICAgICAgICAvLyBvciB0aGUgc3RhdGljIHR5cGUudG9GaWVs\nZCh2YWxbLCBjdHhdKSBtZXRob2QKICAgICAgICAgICAgaWYgKGZhY3Rvcnkg\naW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikgewogICAgICAgICAgICAgICAgaWYg\nKHZhbCA9PSBudWxsKQogICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxs\nOwogICAgICAgICAgICAgICAgcmV0dXJuICgoQ29uc3RydWN0b3IpIGZhY3Rv\ncnkpLm5ld0luc3RhbmNlCiAgICAgICAgICAgICAgICAgICAgKG5ldyBPYmpl\nY3RbXXsgdmFsIH0pOwogICAgICAgICAgICB9CgogICAgICAgICAgICBNZXRo\nb2QgbWV0aCA9IChNZXRob2QpIGZhY3Rvcnk7CiAgICAgICAgICAgIGlmICht\nZXRoLmdldFBhcmFtZXRlclR5cGVzKCkubGVuZ3RoID09IDEpCiAgICAgICAg\nICAgICAgICByZXR1cm4gbWV0aC5pbnZva2UobnVsbCwgbmV3IE9iamVjdFtd\neyB2YWwgfSk7CiAgICAgICAgICAgIHJldHVybiBtZXRoLmludm9rZShudWxs\nLCBuZXcgT2JqZWN0W117IHZhbCwgY3R4IH0pOwogICAgICAgIH0gY2F0Y2gg\nKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgIC8vIHVud3JhcCBjYXVzZQog\nICAgICAgICAgICBpZiAoZSBpbnN0YW5jZW9mIEludm9jYXRpb25UYXJnZXRF\neGNlcHRpb24pIHsKICAgICAgICAgICAgICAgIFRocm93YWJsZSB0ID0gKChJ\nbnZvY2F0aW9uVGFyZ2V0RXhjZXB0aW9uKSBlKS4KICAgICAgICAgICAgICAg\nICAgICBnZXRUYXJnZXRFeGNlcHRpb24oKTsKICAgICAgICAgICAgICAgIGlm\nICh0IGluc3RhbmNlb2YgRXJyb3IpCiAgICAgICAgICAgICAgICAgICAgdGhy\nb3cgKEVycm9yKSB0OwogICAgICAgICAgICAgICAgZSA9IChFeGNlcHRpb24p\nIHQ7CgogICAgICAgICAgICAgICAgLy8gYWxsb3cgbnVsbCB2YWx1ZXMgdG8g\nY2F1c2UgTlBFcyBhbmQgaWxsZWdhbCBhcmcgZXhjZXB0aW9ucwogICAgICAg\nICAgICAgICAgLy8gd2l0aG91dCBlcnJvcgogICAgICAgICAgICAgICAgaWYg\nKHZhbCA9PSBudWxsICYmIChlIGluc3RhbmNlb2YgTnVsbFBvaW50ZXJFeGNl\ncHRpb24KICAgICAgICAgICAgICAgICAgICB8fCBlIGluc3RhbmNlb2YgSWxs\nZWdhbEFyZ3VtZW50RXhjZXB0aW9uKSkKICAgICAgICAgICAgICAgICAgICBy\nZXR1cm4gbnVsbDsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKGUg\naW5zdGFuY2VvZiBPcGVuSlBBRXhjZXB0aW9uKQogICAgICAgICAgICAgICAg\ndGhyb3cgKE9wZW5KUEFFeGNlcHRpb24pIGU7CiAgICAgICAgICAgIGlmIChl\nIGluc3RhbmNlb2YgUHJpdmlsZWdlZEFjdGlvbkV4Y2VwdGlvbikKICAgICAg\nICAgICAgICAgIGUgPSAoKFByaXZpbGVnZWRBY3Rpb25FeGNlcHRpb24pIGUp\nLmdldEV4Y2VwdGlvbigpOwogICAgICAgICAgICB0aHJvdyBuZXcgTWV0YURh\ndGFFeGNlcHRpb24oX2xvYy5nZXQoImZhY3RvcnktZXJyIiwgdGhpcywKICAg\nICAgICAgICAgICAgIEV4Y2VwdGlvbnMudG9TdHJpbmcodmFsKSwgZS50b1N0\ncmluZygpKSkuc2V0Q2F1c2UoZSk7CiAgICAgICAgfQogICAgfQoKICAgIC8q\nKgogICAgICogVGhlIG5hbWUgb2YgdGhpcyBmaWVsZCdzIGV4dGVybmFsaXpl\nciwgb3IgbnVsbCBpZiBub25lLgogICAgICovCiAgICBwdWJsaWMgU3RyaW5n\nIGdldEV4dGVybmFsaXplcigpIHsKICAgICAgICByZXR1cm4gX2V4dE5hbWU7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBUaGUgbmFtZSBvZiB0aGlzIGZpZWxk\nJ3MgZXh0ZXJuYWxpemVyLCBvciBudWxsIGlmIG5vbmUuCiAgICAgKi8KICAg\nIHB1YmxpYyB2b2lkIHNldEV4dGVybmFsaXplcihTdHJpbmcgZXh0ZXJuYWxp\nemVyKSB7CiAgICAgICAgX2V4dE5hbWUgPSBleHRlcm5hbGl6ZXI7CiAgICAg\nICAgX2V4dE1ldGhvZCA9IERFRkFVTFRfTUVUSE9EOwogICAgfQoKICAgIC8q\nKgogICAgICogVGhlIG5hbWUgb2YgdGhpcyBmaWVsZCdzIGZhY3RvcnksIG9y\nIG51bGwgaWYgbm9uZS4KICAgICAqLwogICAgcHVibGljIFN0cmluZyBnZXRG\nYWN0b3J5KCkgewogICAgICAgIHJldHVybiBfZmFjdE5hbWU7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBUaGUgbmFtZSBvZiB0aGlzIGZpZWxkJ3MgZmFjdG9y\neSwgb3IgbnVsbCBpZiBub25lLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBz\nZXRGYWN0b3J5KFN0cmluZyBmYWN0b3J5KSB7CiAgICAgICAgX2ZhY3ROYW1l\nID0gZmFjdG9yeTsKICAgICAgICBfZmFjdE1ldGhvZCA9IERFRkFVTFRfTUVU\nSE9EOwogICAgfQoKICAgIC8qKgogICAgICogUHJvcGVydGllcyBzdHJpbmcg\nbWFwcGluZyBmaWVsZCB2YWx1ZXMgdG8gZXh0ZXJuYWwgdmFsdWVzLgogICAg\nICovCiAgICBwdWJsaWMgU3RyaW5nIGdldEV4dGVybmFsVmFsdWVzKCkgewog\nICAgICAgIHJldHVybiBfZXh0U3RyaW5nOwogICAgfQoKICAgIC8qKgogICAg\nICogUHJvcGVydGllcyBzdHJpbmcgbWFwcGluZyBmaWVsZCB2YWx1ZXMgdG8g\nZXh0ZXJuYWwgdmFsdWVzLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRF\neHRlcm5hbFZhbHVlcyhTdHJpbmcgdmFsdWVzKSB7CiAgICAgICAgX2V4dFN0\ncmluZyA9IHZhbHVlczsKICAgICAgICBfZXh0VmFsdWVzID0gbnVsbDsKICAg\nIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgbWFwcGluZyBvZiBmaWVs\nZCB2YWx1ZXMgdG8gZXh0ZXJuYWwgdmFsdWVzLgogICAgICovCiAgICBwdWJs\naWMgTWFwIGdldEV4dGVybmFsVmFsdWVNYXAoKSB7CiAgICAgICAgcGFyc2VF\neHRlcm5hbFZhbHVlcygpOwogICAgICAgIHJldHVybiBfZXh0VmFsdWVzOwog\nICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRoZSBtYXBwaW5nIG9mIGV4\ndGVybmFsIHZhbHVlcyB0byBmaWVsZCB2YWx1ZXMuCiAgICAgKi8KICAgIHB1\nYmxpYyBNYXAgZ2V0RmllbGRWYWx1ZU1hcCgpIHsKICAgICAgICBwYXJzZUV4\ndGVybmFsVmFsdWVzKCk7CiAgICAgICAgcmV0dXJuIF9maWVsZFZhbHVlczsK\nICAgIH0KCiAgICAvKioKICAgICAqIFBhcnNlIGV4dGVybmFsIHZhbHVlcyBp\nbnRvIG1hcHMuCiAgICAgKi8KICAgIHByaXZhdGUgdm9pZCBwYXJzZUV4dGVy\nbmFsVmFsdWVzKCkgewogICAgICAgIGlmIChfZXh0VmFsdWVzICE9IENvbGxl\nY3Rpb25zLkVNUFRZX01BUAogICAgICAgICAgICAmJiBfZmllbGRWYWx1ZXMg\nIT0gQ29sbGVjdGlvbnMuRU1QVFlfTUFQKQogICAgICAgICAgICByZXR1cm47\nCgogICAgICAgIGlmIChfZXh0U3RyaW5nID09IG51bGwpIHsKICAgICAgICAg\nICAgX2V4dFZhbHVlcyA9IG51bGw7CiAgICAgICAgICAgIF9maWVsZFZhbHVl\ncyA9IG51bGw7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAg\nICAgIC8vIHBhcnNlIHN0cmluZyBpbnRvIG9wdGlvbnM7IHRoaXMgdGFrZXMg\nY2FyZSBvZiBwcm9wZXIgdHJpbW1pbmcgZXRjCiAgICAgICAgT3B0aW9ucyB2\nYWx1ZXMgPSBDb25maWd1cmF0aW9ucy5wYXJzZVByb3BlcnRpZXMoX2V4dFN0\ncmluZyk7CiAgICAgICAgaWYgKHZhbHVlcy5pc0VtcHR5KCkpCiAgICAgICAg\nICAgIHRocm93IG5ldyBNZXRhRGF0YUV4Y2VwdGlvbihfbG9jLmdldCgibm8t\nZXh0ZXJuYWwtdmFsdWVzIiwgdGhpcywKICAgICAgICAgICAgICAgIF9leHRT\ndHJpbmcpKTsKCiAgICAgICAgTWFwIGV4dFZhbHVlcyA9IG5ldyBIYXNoTWFw\nKChpbnQpICh2YWx1ZXMuc2l6ZSgpICogMS4zMyArIDEpKTsKICAgICAgICBN\nYXAgZmllbGRWYWx1ZXMgPSBuZXcgSGFzaE1hcCgoaW50KSAodmFsdWVzLnNp\nemUoKSAqIDEuMzMgKyAxKSk7CiAgICAgICAgTWFwLkVudHJ5IGVudHJ5Owog\nICAgICAgIE9iamVjdCBleHRWYWx1ZSwgZmllbGRWYWx1ZTsKICAgICAgICBm\nb3IgKEl0ZXJhdG9yIGl0ciA9IHZhbHVlcy5lbnRyeVNldCgpLml0ZXJhdG9y\nKCk7IGl0ci5oYXNOZXh0KCk7KSB7CiAgICAgICAgICAgIGVudHJ5ID0gKE1h\ncC5FbnRyeSkgaXRyLm5leHQoKTsKICAgICAgICAgICAgZmllbGRWYWx1ZSA9\nIHRyYW5zZm9ybSgoU3RyaW5nKSBlbnRyeS5nZXRLZXkoKSwKICAgICAgICAg\nICAgICAgIGdldERlY2xhcmVkVHlwZUNvZGUoKSk7CiAgICAgICAgICAgIGV4\ndFZhbHVlID0gdHJhbnNmb3JtKChTdHJpbmcpIGVudHJ5LmdldFZhbHVlKCks\nIGdldFR5cGVDb2RlKCkpOwoKICAgICAgICAgICAgZXh0VmFsdWVzLnB1dChm\naWVsZFZhbHVlLCBleHRWYWx1ZSk7CiAgICAgICAgICAgIGZpZWxkVmFsdWVz\nLnB1dChleHRWYWx1ZSwgZmllbGRWYWx1ZSk7CiAgICAgICAgfQoKICAgICAg\nICBfZXh0VmFsdWVzID0gZXh0VmFsdWVzOwogICAgICAgIF9maWVsZFZhbHVl\ncyA9IGZpZWxkVmFsdWVzOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJu\nIHRoZSBzdHJpbmcgdmFsdWUgY29udmVydGVkIHRvIHRoZSBnaXZlbiB0eXBl\nIGNvZGUuIFRoZSBzdHJpbmcKICAgICAqIG11c3QgYmUgbm9uLW51bGwgYW5k\nIHRyaW1tZWQuCiAgICAgKi8KICAgIHByaXZhdGUgT2JqZWN0IHRyYW5zZm9y\nbShTdHJpbmcgdmFsLCBpbnQgdHlwZUNvZGUpIHsKICAgICAgICBpZiAoIm51\nbGwiLmVxdWFscyh2YWwpKQogICAgICAgICAgICByZXR1cm4gbnVsbDsKCiAg\nICAgICAgc3dpdGNoICh0eXBlQ29kZSkgewogICAgICAgICAgICBjYXNlIEph\ndmFUeXBlcy5CT09MRUFOOgogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5C\nT09MRUFOX09CSjoKICAgICAgICAgICAgICAgIHJldHVybiBCb29sZWFuLnZh\nbHVlT2YodmFsKTsKICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuQllURToK\nICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuQllURV9PQko6CiAgICAgICAg\nICAgICAgICByZXR1cm4gQnl0ZS52YWx1ZU9mKHZhbCk7CiAgICAgICAgICAg\nIGNhc2UgSmF2YVR5cGVzLklOVDoKICAgICAgICAgICAgY2FzZSBKYXZhVHlw\nZXMuSU5UX09CSjoKICAgICAgICAgICAgICAgIHJldHVybiBJbnRlZ2VyLnZh\nbHVlT2YodmFsKTsKICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuTE9ORzoK\nICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuTE9OR19PQko6CiAgICAgICAg\nICAgICAgICByZXR1cm4gTG9uZy52YWx1ZU9mKHZhbCk7CiAgICAgICAgICAg\nIGNhc2UgSmF2YVR5cGVzLlNIT1JUOgogICAgICAgICAgICBjYXNlIEphdmFU\neXBlcy5TSE9SVF9PQko6CiAgICAgICAgICAgICAgICByZXR1cm4gU2hvcnQu\ndmFsdWVPZih2YWwpOwogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5ET1VC\nTEU6CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLkRPVUJMRV9PQko6CiAg\nICAgICAgICAgICAgICByZXR1cm4gRG91YmxlLnZhbHVlT2YodmFsKTsKICAg\nICAgICAgICAgY2FzZSBKYXZhVHlwZXMuRkxPQVQ6CiAgICAgICAgICAgIGNh\nc2UgSmF2YVR5cGVzLkZMT0FUX09CSjoKICAgICAgICAgICAgICAgIHJldHVy\nbiBGbG9hdC52YWx1ZU9mKHZhbCk7CiAgICAgICAgICAgIGNhc2UgSmF2YVR5\ncGVzLkNIQVI6CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLkNIQVJfT0JK\nOgogICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBDaGFyYWN0ZXIodmFsLmNo\nYXJBdCgwKSk7CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLlNUUklORzoK\nICAgICAgICAgICAgICAgIHJldHVybiB2YWw7CiAgICAgICAgfQogICAgICAg\nIHRocm93IG5ldyBNZXRhRGF0YUV4Y2VwdGlvbihfbG9jLmdldCgiYmFkLWV4\ndGVybmFsLXR5cGUiLCB0aGlzKSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBU\naGUgZXh0ZXJuYWxpemVyIG1ldGhvZC4KICAgICAqLwogICAgcHVibGljIE1l\ndGhvZCBnZXRFeHRlcm5hbGl6ZXJNZXRob2QoKSB7CiAgICAgICAgaWYgKF9t\nYW5hZ2UgIT0gTUFOQUdFX1BFUlNJU1RFTlQpCiAgICAgICAgICAgIHJldHVy\nbiBudWxsOwogICAgICAgIGlmIChfZXh0TWV0aG9kID09IERFRkFVTFRfTUVU\nSE9EKSB7CiAgICAgICAgICAgIGlmIChfZXh0TmFtZSAhPSBudWxsKSB7CiAg\nICAgICAgICAgICAgICBfZXh0TWV0aG9kID0gZmluZE1ldGhvZChfZXh0TmFt\nZSk7CiAgICAgICAgICAgICAgICBpZiAoX2V4dE1ldGhvZCA9PSBudWxsKQog\nICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBNZXRhRGF0YUV4Y2VwdGlv\nbihfbG9jLmdldCgiYmFkLWV4dGVybmFsaXplciIsCiAgICAgICAgICAgICAg\nICAgICAgICAgIHRoaXMsIF9leHROYW1lKSk7CiAgICAgICAgICAgIH0gZWxz\nZQogICAgICAgICAgICAgICAgX2V4dE1ldGhvZCA9IG51bGw7CiAgICAgICAg\nfQogICAgICAgIHJldHVybiBfZXh0TWV0aG9kOwogICAgfQoKICAgIC8qKgog\nICAgICogVGhlIGZhY3RvcnkgbWV0aG9kIG9yIGNvbnN0cnVjdG9yLgogICAg\nICovCiAgICBwdWJsaWMgTWVtYmVyIGdldEZhY3RvcnlNZXRob2QoKSB7CiAg\nICAgICAgaWYgKF9tYW5hZ2UgIT0gTUFOQUdFX1BFUlNJU1RFTlQpCiAgICAg\nICAgICAgIHJldHVybiBudWxsOwogICAgICAgIGlmIChfZmFjdE1ldGhvZCA9\nPSBERUZBVUxUX01FVEhPRCkgewogICAgICAgICAgICBpZiAoZ2V0RXh0ZXJu\nYWxpemVyTWV0aG9kKCkgPT0gbnVsbCkKICAgICAgICAgICAgICAgIF9mYWN0\nTWV0aG9kID0gbnVsbDsKICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAg\nICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgIGlmIChfZmFjdE5hbWUg\nPT0gbnVsbCkKICAgICAgICAgICAgICAgICAgICAgICAgX2ZhY3RNZXRob2Qg\nPSBnZXREZWNsYXJlZFR5cGUoKS5nZXRDb25zdHJ1Y3RvcgogICAgICAgICAg\nICAgICAgICAgICAgICAgICAgKG5ldyBDbGFzc1tdeyBnZXRUeXBlKCkgfSk7\nCiAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAg\nICAgICBfZmFjdE1ldGhvZCA9IGZpbmRNZXRob2QoX2ZhY3ROYW1lKTsKICAg\nICAgICAgICAgICAgIH0gY2F0Y2ggKE9wZW5KUEFFeGNlcHRpb24ga2UpIHsK\nICAgICAgICAgICAgICAgICAgICB0aHJvdyBrZTsKICAgICAgICAgICAgICAg\nIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgICAgICB9Cgog\nICAgICAgICAgICAgICAgaWYgKCEoX2ZhY3RNZXRob2QgaW5zdGFuY2VvZiBD\nb25zdHJ1Y3RvcikKICAgICAgICAgICAgICAgICAgICAmJiAhKF9mYWN0TWV0\naG9kIGluc3RhbmNlb2YgTWV0aG9kKSkKICAgICAgICAgICAgICAgICAgICB0\naHJvdyBuZXcgTWV0YURhdGFFeGNlcHRpb24oX2xvYy5nZXQoImJhZC1mYWN0\nb3J5IiwgdGhpcykpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAg\nIHJldHVybiBfZmFjdE1ldGhvZDsKICAgIH0KCiAgICAvKioKICAgICAqIEZp\nbmQgdGhlIG1ldGhvZCBmb3IgdGhlIHNwZWNpZmllZCBuYW1lLiBQb3NzaWJs\nZSBmb3JtcyBhcmU6CiAgICAgKiA8dWw+CiAgICAgKiA8bGk+dG9FeHRlcm5h\nbFN0cmluZzwvbGk+CiAgICAgKiA8bGk+TXlGYWN0b3J5Q2xhc3MudG9FeHRl\ncm5hbFN0cmluZzwvbGk+CiAgICAgKiA8bGk+Y29tLmNvbXBhbnkuTXlGYWN0\nb3J5Q2xhc3MudG9FeHRlcm5hbFN0cmluZzwvbGk+CiAgICAgKiA8L3VsPgog\nICAgICoKICAgICAqIEBwYXJhbSBtZXRob2QgdGhlIG5hbWUgb2YgdGhlIG1l\ndGhvZCB0byBsb2NhdGUKICAgICAqIEByZXR1cm4gdGhlIG1ldGhvZCBmb3Ig\naW52b2NhdGlvbgogICAgICovCiAgICBwcml2YXRlIE1ldGhvZCBmaW5kTWV0\naG9kKFN0cmluZyBtZXRob2QpIHsKICAgICAgICBpZiAoU3RyaW5nVXRpbHMu\naXNFbXB0eShtZXRob2QpKQogICAgICAgICAgICByZXR1cm4gbnVsbDsKCiAg\nICAgICAgLy8gZ2V0IGNsYXNzIG5hbWUgYW5kIGdldCBwYWNrYWdlIG5hbWUg\nZGl2aWRlIG9uIHRoZSBsYXN0ICcuJywgc28gdGhlCiAgICAgICAgLy8gbmFt\nZXMgZG9uJ3QgYXBwbHkgaW4gdGhpcyBjYXNlLCBidXQgdGhlIG1ldGhvZHMg\nZG8gd2hhdCB3ZSB3YW50CiAgICAgICAgU3RyaW5nIG1ldGhvZE5hbWUgPSBT\ndHJpbmdzLmdldENsYXNzTmFtZShtZXRob2QpOwogICAgICAgIFN0cmluZyBj\nbHNOYW1lID0gU3RyaW5ncy5nZXRQYWNrYWdlTmFtZShtZXRob2QpOwoKICAg\nICAgICBDbGFzcyBjbHMgPSBudWxsOwogICAgICAgIENsYXNzIG93bmVyID0g\nX293bmVyLmdldERlc2NyaWJlZFR5cGUoKTsKCiAgICAgICAgaWYgKGNsc05h\nbWUubGVuZ3RoKCkgPT0gMCkKICAgICAgICAgICAgY2xzID0gZ2V0RGVjbGFy\nZWRUeXBlKCk7CiAgICAgICAgZWxzZSBpZiAoY2xzTmFtZS5lcXVhbHMob3du\nZXIuZ2V0TmFtZSgpKQogICAgICAgICAgICB8fCBjbHNOYW1lLmVxdWFscyhT\ndHJpbmdzLmdldENsYXNzTmFtZShvd25lcikpKQogICAgICAgICAgICBjbHMg\nPSBvd25lcjsKICAgICAgICBlbHNlCiAgICAgICAgICAgIGNscyA9IEphdmFU\neXBlcy5jbGFzc0Zvck5hbWUoY2xzTmFtZSwgdGhpcyk7CgogICAgICAgIC8v\nIGZpbmQgdGhlIG5hbWVkIG1ldGhvZAogICAgICAgIE1ldGhvZFtdIG1ldGhv\nZHMgPSBjbHMuZ2V0TWV0aG9kcygpOwogICAgICAgIENsYXNzW10gcGFyYW1z\nOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgbWV0aG9kcy5sZW5ndGg7\nIGkrKykgewogICAgICAgICAgICBpZiAobWV0aG9kc1tpXS5nZXROYW1lKCku\nZXF1YWxzKG1ldGhvZE5hbWUpKSB7CiAgICAgICAgICAgICAgICBwYXJhbXMg\nPSBtZXRob2RzW2ldLmdldFBhcmFtZXRlclR5cGVzKCk7CgogICAgICAgICAg\nICAgICAgLy8gc3RhdGljIGZhY3RvcnkgbWV0aG9kcyByZXF1aXJlIG9uZSBh\ncmd1bWVudCBvciBvbmUgYXJndW1lbnQKICAgICAgICAgICAgICAgIC8vIHBs\ndXMgYSBjdHg7IG5vbi1zdGF0aWMgbWV0aG9kcyByZXF1aXJlIHplcm8gYXJn\ndW1lbnRzIG9yCiAgICAgICAgICAgICAgICAvLyBqdXN0IGEgY3R4CiAgICAg\nICAgICAgICAgICBpZiAoTW9kaWZpZXIuaXNTdGF0aWMobWV0aG9kc1tpXS5n\nZXRNb2RpZmllcnMoKSkKICAgICAgICAgICAgICAgICAgICAmJiAocGFyYW1z\nLmxlbmd0aCA9PSAxIHx8IChwYXJhbXMubGVuZ3RoID09IDIKICAgICAgICAg\nICAgICAgICAgICAmJiBpc1N0b3JlQ29udGV4dFBhcmFtZXRlcihwYXJhbXNb\nMV0pKSkpCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG1ldGhvZHNbaV07\nCiAgICAgICAgICAgICAgICBpZiAoIU1vZGlmaWVyLmlzU3RhdGljKG1ldGhv\nZHNbaV0uZ2V0TW9kaWZpZXJzKCkpCiAgICAgICAgICAgICAgICAgICAgJiYg\nKHBhcmFtcy5sZW5ndGggPT0gMCB8fCAocGFyYW1zLmxlbmd0aCA9PSAxCiAg\nICAgICAgICAgICAgICAgICAgJiYgaXNTdG9yZUNvbnRleHRQYXJhbWV0ZXIo\ncGFyYW1zWzBdKSkpKQogICAgICAgICAgICAgICAgICAgIHJldHVybiBtZXRo\nb2RzW2ldOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICByZXR1\ncm4gbnVsbDsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0cnVlIGlm\nIHRoZSBnaXZlbiB0eXBlIGlzIGEgc3RvcmUgY29udGV4dCB0eXBlOyB3ZSBj\nYW4ndAogICAgICogdXNlIHRoZSBzdGFuZGFyZCA8Y29kZT5pc0Fzc2lnbmFi\nbGVGcm9tPC9jb2RlPiBiZWNhdXNlIG9mIGNsYXNzbG9hZGVyCiAgICAgKiBv\nZGRuZXNzLgogICAgICovCiAgICBwcml2YXRlIHN0YXRpYyBib29sZWFuIGlz\nU3RvcmVDb250ZXh0UGFyYW1ldGVyKENsYXNzIHR5cGUpIHsKICAgICAgICBy\nZXR1cm4gU3RvcmVDb250ZXh0LmNsYXNzLmdldE5hbWUoKS5lcXVhbHModHlw\nZS5nZXROYW1lKCkpOwogICAgfQoKICAgIHB1YmxpYyBib29sZWFuIGVxdWFs\ncyhPYmplY3Qgb3RoZXIpIHsKICAgICAgICBpZiAob3RoZXIgPT0gdGhpcykK\nICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgaWYgKCEob3RoZXIg\naW5zdGFuY2VvZiBGaWVsZE1ldGFEYXRhKSkKICAgICAgICAgICAgcmV0dXJu\nIGZhbHNlOwogICAgICAgIHJldHVybiBnZXRGdWxsTmFtZSh0cnVlKS5lcXVh\nbHMoKChGaWVsZE1ldGFEYXRhKSBvdGhlcikuCiAgICAgICAgICAgIGdldEZ1\nbGxOYW1lKHRydWUpKTsKICAgIH0KCiAgICBwdWJsaWMgaW50IGhhc2hDb2Rl\nKCkgewogICAgICAgIHJldHVybiBnZXRGdWxsTmFtZSh0cnVlKS5oYXNoQ29k\nZSgpOwogICAgfQoKICAgIHB1YmxpYyBpbnQgY29tcGFyZVRvKE9iamVjdCBv\ndGhlcikgewogICAgICAgIGlmIChvdGhlciA9PSBudWxsKQogICAgICAgICAg\nICByZXR1cm4gMTsKICAgICAgICByZXR1cm4gZ2V0RnVsbE5hbWUodHJ1ZSku\nY29tcGFyZVRvKCgoRmllbGRNZXRhRGF0YSkgb3RoZXIpLgogICAgICAgICAg\nICBnZXRGdWxsTmFtZSh0cnVlKSk7CiAgICB9CgogICAgcHVibGljIFN0cmlu\nZyB0b1N0cmluZygpIHsKICAgICAgICByZXR1cm4gZ2V0RnVsbE5hbWUodHJ1\nZSk7CiAgICB9CgogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgICAv\nLyBSZXNvbHZlIGFuZCB2YWxpZGF0ZQogICAgLy8vLy8vLy8vLy8vLy8vLy8v\nLy8vLy8vCgogICAgLyoqCiAgICAgKiBSZXNvbHZlIG1vZGUgZm9yIHRoaXMg\nZmllbGQuCiAgICAgKi8KICAgIHB1YmxpYyBpbnQgZ2V0UmVzb2x2ZSgpIHsK\nICAgICAgICByZXR1cm4gX3Jlc01vZGU7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBSZXNvbHZlIG1vZGUgZm9yIHRoaXMgZmllbGQuCiAgICAgKi8KICAgIHB1\nYmxpYyB2b2lkIHNldFJlc29sdmUoaW50IG1vZGUpIHsKICAgICAgICBfcmVz\nTW9kZSA9IG1vZGU7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXNvbHZlIG1v\nZGUgZm9yIHRoaXMgZmllbGQuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNl\ndFJlc29sdmUoaW50IG1vZGUsIGJvb2xlYW4gb24pIHsKICAgICAgICBpZiAo\nbW9kZSA9PSBNT0RFX05PTkUpCiAgICAgICAgICAgIF9yZXNNb2RlID0gbW9k\nZTsKICAgICAgICBlbHNlIGlmIChvbikKICAgICAgICAgICAgX3Jlc01vZGUg\nfD0gbW9kZTsKICAgICAgICBlbHNlCiAgICAgICAgICAgIF9yZXNNb2RlICY9\nIH5tb2RlOwogICAgfQoKICAgIC8qKgogICAgICogUmVzb2x2ZSBhbmQgdmFs\naWRhdGUgbWV0YWRhdGEuIFJldHVybiB0cnVlIGlmIGFscmVhZHkgcmVzb2x2\nZWQuCiAgICAgKi8KICAgIHB1YmxpYyBib29sZWFuIHJlc29sdmUoaW50IG1v\nZGUpIHsKICAgICAgICBpZiAoKF9yZXNNb2RlICYgbW9kZSkgPT0gbW9kZSkK\nICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgaW50IGN1ciA9IF9y\nZXNNb2RlOwogICAgICAgIF9yZXNNb2RlIHw9IG1vZGU7CgogICAgICAgIExv\nZyBsb2cgPSBnZXRSZXBvc2l0b3J5KCkuZ2V0TG9nKCk7CiAgICAgICAgaWYg\nKGxvZy5pc1RyYWNlRW5hYmxlZCgpKQogICAgICAgICAgICBsb2cudHJhY2Uo\nX2xvYy5nZXQoInJlc29sdmUtZmllbGQiLCBfb3duZXIgKyAiQCIKICAgICAg\nICAgICAgICAgICsgU3lzdGVtLmlkZW50aXR5SGFzaENvZGUoX293bmVyKSAr\nICIuIiArIF9uYW1lKSk7CgogICAgICAgIC8vIHdlIG9ubHkgcGVyZm9ybSBh\nY3Rpb25zIGZvciBtZXRhZGF0YSBtb2RlCiAgICAgICAgaWYgKChtb2RlICYg\nTU9ERV9NRVRBKSA9PSAwIHx8IChjdXIgJiBNT0RFX01FVEEpICE9IDApCiAg\nICAgICAgICAgIHJldHVybiBmYWxzZTsKCiAgICAgICAgTWV0aG9kIGV4dGVy\nbmFsaXplciA9IGdldEV4dGVybmFsaXplck1ldGhvZCgpOwogICAgICAgIGlm\nIChleHRlcm5hbGl6ZXIgIT0gbnVsbCkKICAgICAgICAgICAgc2V0VHlwZShl\neHRlcm5hbGl6ZXIuZ2V0UmV0dXJuVHlwZSgpKTsKCiAgICAgICAgLy8gb25s\neSBwYXNzIG9uIG1ldGFkYXRhIHJlc29sdmUgbW9kZSBzbyB0aGF0IG1ldGFk\nYXRhIGlzIGFsd2F5cwogICAgICAgIC8vIHJlc29sdmVkIGJlZm9yZSBhbnkg\nb3RoZXIgcmVzb2x2ZSBtb2RlcyBvdXIgc3ViY2xhc3NlcyBwYXNzIGFsb25n\nCiAgICAgICAgX3ZhbC5yZXNvbHZlKE1PREVfTUVUQSk7CiAgICAgICAgX2tl\neS5yZXNvbHZlKE1PREVfTUVUQSk7CiAgICAgICAgX2VsZW0ucmVzb2x2ZShN\nT0RFX01FVEEpOwoKICAgICAgICBNZXRhRGF0YVJlcG9zaXRvcnkgcmVwb3Mg\nPSBnZXRSZXBvc2l0b3J5KCk7CiAgICAgICAgaW50IHZhbGlkYXRlID0gcmVw\nb3MuZ2V0VmFsaWRhdGUoKTsKICAgICAgICBpZiAoKHZhbGlkYXRlICYgTWV0\nYURhdGFSZXBvc2l0b3J5LlZBTElEQVRFX01FVEEpICE9IDAKICAgICAgICAg\nICAgJiYgKCFJbXBsSGVscGVyLmlzTWFuYWdlZFR5cGUocmVwb3MuZ2V0Q29u\nZmlndXJhdGlvbigpLAogICAgICAgICAgICAgICAgX293bmVyLmdldERlc2Ny\naWJlZFR5cGUoKSkKICAgICAgICAgICAgfHwgKHZhbGlkYXRlICYgTWV0YURh\ndGFSZXBvc2l0b3J5LlZBTElEQVRFX1VORU5IQU5DRUQpID09IDApKSB7CiAg\nICAgICAgICAgIHZhbGlkYXRlTFJTKCk7CiAgICAgICAgICAgIGlmICgodmFs\naWRhdGUgJiByZXBvcy5WQUxJREFURV9SVU5USU1FKSA9PSAwKQogICAgICAg\nICAgICAgICAgdmFsaWRhdGVTdXBwb3J0ZWRUeXBlKCk7CiAgICAgICAgICAg\nIHZhbGlkYXRlVmFsdWUoKTsKICAgICAgICAgICAgdmFsaWRhdGVFeHRlbnNp\nb25LZXlzKCk7CiAgICAgICAgfQogICAgICAgIHJldHVybiBmYWxzZTsKICAg\nIH0KCiAgICAvKioKICAgICAqIFZhbGlkYXRlIHRoYXQgdGhpcyBmaWVsZCBj\nYW4gYmUgdXNlZCBmb3IgTFJTLgogICAgICovCiAgICBwcml2YXRlIHZvaWQg\ndmFsaWRhdGVMUlMoKSB7CiAgICAgICAgaWYgKCFpc0xSUygpKQogICAgICAg\nICAgICByZXR1cm47CgogICAgICAgIC8vIGNhbid0IHVzZSBscnMgZm9yIGFy\ncmF5cwogICAgICAgIGlmIChnZXRUeXBlQ29kZSgpID09IEphdmFUeXBlcy5B\nUlJBWSkKICAgICAgICAgICAgdGhyb3cgbmV3IE1ldGFEYXRhRXhjZXB0aW9u\nKF9sb2MuZ2V0KCJiYWQtbHJzLWFycmF5IiwgdGhpcykpOwoKICAgICAgICAv\nLyBjYW4ndCB1c2UgbHJzIGZvciBleHRyYW5hbGl6ZWQgdmFscwogICAgICAg\nIGlmIChnZXRFeHRlcm5hbGl6ZXJNZXRob2QoKSAhPSBudWxsKQogICAgICAg\nICAgICB0aHJvdyBuZXcgTWV0YURhdGFFeGNlcHRpb24oX2xvYy5nZXQoImJh\nZC1scnMtZXh0ZXJuIiwgdGhpcykpOwoKICAgICAgICAvLyBjYW4ndCB1c2Ug\nbHJzIGZvciBjb25jcmV0ZSB0eXBlcwogICAgICAgIGlmIChnZXRUeXBlKCkg\nIT0gQ29sbGVjdGlvbi5jbGFzcyAmJiBnZXRUeXBlKCkgIT0gTWFwLmNsYXNz\nCiAgICAgICAgICAgICYmIGdldFR5cGUoKSAhPSBTZXQuY2xhc3MpCiAgICAg\nICAgICAgIHRocm93IG5ldyBNZXRhRGF0YUV4Y2VwdGlvbihfbG9jLmdldCgi\nYmFkLWxycy1jb25jcmV0ZSIsIHRoaXMpKTsKICAgIH0KCiAgICAvKioKICAg\nICAqIFZhbGlkYXRlIHRoYXQgdGhpcyBmaWVsZCBpcyBzdXBwb3J0ZWQgYnkg\ndGhlIHJ1bnRpbWUuCiAgICAgKi8KICAgIHByaXZhdGUgdm9pZCB2YWxpZGF0\nZVN1cHBvcnRlZFR5cGUoKSB7CiAgICAgICAgLy8gbG9nIHdhcm5pbmdzIGFi\nb3V0IHRoaW5ncyB3ZSBkb24ndCBoYW5kbGUKICAgICAgICBPcGVuSlBBQ29u\nZmlndXJhdGlvbiBjb25mID0gZ2V0UmVwb3NpdG9yeSgpLmdldENvbmZpZ3Vy\nYXRpb24oKTsKICAgICAgICBDb2xsZWN0aW9uIG9wdHMgPSBjb25mLnN1cHBv\ncnRlZE9wdGlvbnMoKTsKICAgICAgICBMb2cgbG9nID0gY29uZi5nZXRMb2co\nY29uZi5MT0dfTUVUQURBVEEpOwogICAgICAgIHN3aXRjaCAoZ2V0VHlwZUNv\nZGUoKSkgewogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5QQzoKICAgICAg\nICAgICAgICAgIGlmIChpc0VtYmVkZGVkKCkgJiYKICAgICAgICAgICAgICAg\nICAgICAhb3B0cy5jb250YWlucyhjb25mLk9QVElPTl9FTUJFRERFRF9SRUxB\nVElPTikpIHsKICAgICAgICAgICAgICAgICAgICBzZXRFbWJlZGRlZChmYWxz\nZSk7CiAgICAgICAgICAgICAgICAgICAgaWYgKGxvZy5pc1dhcm5FbmFibGVk\nKCkpCiAgICAgICAgICAgICAgICAgICAgICAgIGxvZy53YXJuKF9sb2MuZ2V0\nKCJjYW50LWVtYmVkIiwgdGhpcykpOwogICAgICAgICAgICAgICAgfSBlbHNl\nCiAgICAgICAgICAgICAgICBpZiAoaXNFbWJlZGRlZCgpICYmIGdldERlY2xh\ncmVkVHlwZUNvZGUoKSAhPSBKYXZhVHlwZXMuUEMpIHsKICAgICAgICAgICAg\nICAgICAgICBzZXRFbWJlZGRlZChmYWxzZSk7CiAgICAgICAgICAgICAgICAg\nICAgaWYgKGxvZy5pc1dhcm5FbmFibGVkKCkpCiAgICAgICAgICAgICAgICAg\nICAgICAgIGxvZy53YXJuKF9sb2MuZ2V0KCJjYW50LWVtYmVkLWV4dGVybiIs\nIHRoaXMpKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGJy\nZWFrOwogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5DT0xMRUNUSU9OOgog\nICAgICAgICAgICAgICAgaWYgKCFvcHRzLmNvbnRhaW5zKGNvbmYuT1BUSU9O\nX1RZUEVfQ09MTEVDVElPTikpCiAgICAgICAgICAgICAgICAgICAgdGhyb3cg\nbmV3IFVuc3VwcG9ydGVkRXhjZXB0aW9uKAogICAgICAgICAgICAgICAgICAg\nICAgICBfbG9jLmdldCgidHlwZS1ub3Qtc3VwcG9ydGVkIiwKICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICJDb2xsZWN0aW9uIiwgdGhpcykpOwogICAg\nICAgICAgICAgICAgaWYgKF9lbGVtLmlzRW1iZWRkZWRQQygpCiAgICAgICAg\nICAgICAgICAgICAgJiYgIW9wdHMuY29udGFpbnMoY29uZi5PUFRJT05fRU1C\nRURERURfQ09MTEVDVElPTl9SRUxBVElPTikpCiAgICAgICAgICAgICAgICB7\nCiAgICAgICAgICAgICAgICAgICAgX2VsZW0uc2V0RW1iZWRkZWQoZmFsc2Up\nOwogICAgICAgICAgICAgICAgICAgIGlmIChsb2cuaXNXYXJuRW5hYmxlZCgp\nKQogICAgICAgICAgICAgICAgICAgICAgICBsb2cud2FybihfbG9jLmdldCgi\nY2FudC1lbWJlZC1lbGVtZW50IiwgdGhpcykpOwogICAgICAgICAgICAgICAg\nfQogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgSmF2\nYVR5cGVzLkFSUkFZOgogICAgICAgICAgICAgICAgaWYgKCFvcHRzLmNvbnRh\naW5zKGNvbmYuT1BUSU9OX1RZUEVfQVJSQVkpKQogICAgICAgICAgICAgICAg\nICAgIHRocm93IG5ldyBVbnN1cHBvcnRlZEV4Y2VwdGlvbigKICAgICAgICAg\nICAgICAgICAgICAgICAgX2xvYy5nZXQoInR5cGUtbm90LXN1cHBvcnRlZCIs\nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiQXJyYXkiLCB0aGlzKSk7\nCiAgICAgICAgICAgICAgICBpZiAoX2VsZW0uaXNFbWJlZGRlZFBDKCkKICAg\nICAgICAgICAgICAgICAgICAmJiAhb3B0cy5jb250YWlucyhjb25mLk9QVElP\nTl9FTUJFRERFRF9DT0xMRUNUSU9OX1JFTEFUSU9OKSkKICAgICAgICAgICAg\nICAgIHsKICAgICAgICAgICAgICAgICAgICBfZWxlbS5zZXRFbWJlZGRlZChm\nYWxzZSk7CiAgICAgICAgICAgICAgICAgICAgaWYgKGxvZy5pc1dhcm5FbmFi\nbGVkKCkpCiAgICAgICAgICAgICAgICAgICAgICAgIGxvZy53YXJuKF9sb2Mu\nZ2V0KCJjYW50LWVtYmVkLWVsZW1lbnQiLCB0aGlzKSk7CiAgICAgICAgICAg\nICAgICB9CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2Fz\nZSBKYXZhVHlwZXMuTUFQOgogICAgICAgICAgICAgICAgaWYgKCFvcHRzLmNv\nbnRhaW5zKGNvbmYuT1BUSU9OX1RZUEVfTUFQKSkKICAgICAgICAgICAgICAg\nICAgICB0aHJvdyBuZXcgVW5zdXBwb3J0ZWRFeGNlcHRpb24oCiAgICAgICAg\nICAgICAgICAgICAgICAgIF9sb2MuZ2V0KCJ0eXBlLW5vdC1zdXBwb3J0ZWQi\nLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIk1hcCIsIHRoaXMpKTsK\nICAgICAgICAgICAgICAgIGlmIChfZWxlbS5pc0VtYmVkZGVkUEMoKQogICAg\nICAgICAgICAgICAgICAgICYmICFvcHRzLmNvbnRhaW5zKGNvbmYuT1BUSU9O\nX0VNQkVEREVEX01BUF9SRUxBVElPTikpIHsKICAgICAgICAgICAgICAgICAg\nICBfZWxlbS5zZXRFbWJlZGRlZChmYWxzZSk7CiAgICAgICAgICAgICAgICAg\nICAgaWYgKGxvZy5pc1dhcm5FbmFibGVkKCkpCiAgICAgICAgICAgICAgICAg\nICAgICAgIGxvZy53YXJuKF9sb2MuZ2V0KCJjYW50LWVtYmVkLWVsZW1lbnQi\nLCB0aGlzKSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBp\nZiAoX2tleS5pc0VtYmVkZGVkUEMoKQogICAgICAgICAgICAgICAgICAgICYm\nICFvcHRzLmNvbnRhaW5zKGNvbmYuT1BUSU9OX0VNQkVEREVEX01BUF9SRUxB\nVElPTikpIHsKICAgICAgICAgICAgICAgICAgICBfa2V5LnNldEVtYmVkZGVk\nKGZhbHNlKTsKICAgICAgICAgICAgICAgICAgICBpZiAobG9nLmlzV2FybkVu\nYWJsZWQoKSkKICAgICAgICAgICAgICAgICAgICAgICAgbG9nLndhcm4oX2xv\nYy5nZXQoImNhbnQtZW1iZWQta2V5IiwgdGhpcykpOwogICAgICAgICAgICAg\nICAgfQogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgfQoK\nICAgIC8qKgogICAgICogVmFsaWRhdGUgb3VyIHZhbHVlIHN0cmF0ZWd5Lgog\nICAgICovCiAgICBwcml2YXRlIHZvaWQgdmFsaWRhdGVWYWx1ZSgpIHsKICAg\nICAgICBpZiAoZ2V0RXh0ZXJuYWxpemVyTWV0aG9kKCkgIT0gbnVsbCAmJiBn\nZXRFeHRlcm5hbFZhbHVlTWFwKCkgIT0gbnVsbCkKICAgICAgICAgICAgdGhy\nb3cgbmV3IE1ldGFEYXRhRXhjZXB0aW9uKF9sb2MuZ2V0KCJleHRlcm4tZXh0\nZXJudmFsdWVzIiwgdGhpcykpOwogICAgICAgIGlmIChnZXRWYWx1ZVN0cmF0\nZWd5KCkgPT0gVmFsdWVTdHJhdGVnaWVzLlNFUVVFTkNFCiAgICAgICAgICAg\nICYmIGdldFZhbHVlU2VxdWVuY2VOYW1lKCkgPT0gbnVsbCkKICAgICAgICAg\nICAgdGhyb3cgbmV3IE1ldGFEYXRhRXhjZXB0aW9uKF9sb2MuZ2V0KCJuby1z\nZXEtbmFtZSIsIHRoaXMpKTsKICAgICAgICBWYWx1ZVN0cmF0ZWdpZXMuYXNz\nZXJ0U3VwcG9ydGVkKGdldFZhbHVlU3RyYXRlZ3koKSwgdGhpcywKICAgICAg\nICAgICAgInZhbHVlIHN0cmF0ZWd5Iik7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBDb3B5IHN0YXRlIGZyb20gdGhlIGdpdmVuIGZpZWxkIHRvIHRoaXMgb25l\nLiBEbyBub3QgY29weSBtYXBwaW5nCiAgICAgKiBpbmZvcm1hdGlvbi4KICAg\nICAqLwogICAgcHVibGljIHZvaWQgY29weShGaWVsZE1ldGFEYXRhIGZpZWxk\nKSB7CiAgICAgICAgc3VwZXIuY29weShmaWVsZCk7CgogICAgICAgIF9pbnRl\ncm1lZGlhdGUgPSBmaWVsZC51c2VzSW50ZXJtZWRpYXRlKCk7CiAgICAgICAg\nX2ltcGxEYXRhID0gZmllbGQudXNlc0ltcGxEYXRhKCk7CgogICAgICAgIC8v\nIGNvcHkgZmllbGQtbGV2ZWwgaW5mbzsgdXNlIGdldCBtZXRob2RzIHRvIGZv\ncmNlIHJlc29sdXRpb24gb2YKICAgICAgICAvLyBsYXp5IGRhdGEKICAgICAg\nICBfcHJveHlDbGFzcyA9IGZpZWxkLmdldFByb3h5VHlwZSgpOwogICAgICAg\nIF9pbml0aWFsaXplciA9IGZpZWxkLmdldEluaXRpYWxpemVyKCk7CiAgICAg\nICAgX3RyYW5zaWVudCA9IGZpZWxkLmlzVHJhbnNpZW50KCk7CiAgICAgICAg\nX251bGxWYWx1ZSA9IGZpZWxkLmdldE51bGxWYWx1ZSgpOwogICAgICAgIF9t\nYW5hZ2UgPSBmaWVsZC5nZXRNYW5hZ2VtZW50KCk7CiAgICAgICAgX2V4cGxp\nY2l0ID0gZmllbGQuaXNFeHBsaWNpdCgpOwogICAgICAgIF9leHROYW1lID0g\nZmllbGQuZ2V0RXh0ZXJuYWxpemVyKCk7CiAgICAgICAgX2V4dE1ldGhvZCA9\nIERFRkFVTFRfTUVUSE9EOwogICAgICAgIF9mYWN0TmFtZSA9IGZpZWxkLmdl\ndEZhY3RvcnkoKTsKICAgICAgICBfZmFjdE1ldGhvZCA9IERFRkFVTFRfTUVU\nSE9EOwogICAgICAgIF9leHRTdHJpbmcgPSBmaWVsZC5nZXRFeHRlcm5hbFZh\nbHVlcygpOwogICAgICAgIF9leHRWYWx1ZXMgPSBDb2xsZWN0aW9ucy5FTVBU\nWV9NQVA7CiAgICAgICAgX2ZpZWxkVmFsdWVzID0gQ29sbGVjdGlvbnMuRU1Q\nVFlfTUFQOwogICAgICAgIF9wcmltS2V5ID0gZmllbGQuaXNQcmltYXJ5S2V5\nKCk7CiAgICAgICAgX2JhY2tpbmdNZW1iZXIgPSBmaWVsZC5fYmFja2luZ01l\nbWJlcjsKICAgICAgICBfZW51bUZpZWxkID0gZmllbGQuX2VudW1GaWVsZDsK\nICAgICAgICBfbG9iRmllbGQgPSBmaWVsZC5fbG9iRmllbGQ7CiAgICAgICAg\nX3NlcmlhbGl6YWJsZUZpZWxkID0gZmllbGQuX3NlcmlhbGl6YWJsZUZpZWxk\nOwogICAgICAgIF9nZW5lcmF0ZWQgPSBmaWVsZC5fZ2VuZXJhdGVkOwoKICAg\nICAgICAvLyBlbWJlZGRlZCBmaWVsZHMgY2FuJ3QgYmUgdmVyc2lvbnMKICAg\nICAgICBpZiAoX293bmVyLmdldEVtYmVkZGluZ01ldGFEYXRhKCkgPT0gbnVs\nbCAmJiBfdmVyc2lvbiA9PSBudWxsKQogICAgICAgICAgICBfdmVyc2lvbiA9\nIChmaWVsZC5pc1ZlcnNpb24oKSkgPyBCb29sZWFuLlRSVUUgOiBCb29sZWFu\nLkZBTFNFOwoKICAgICAgICAvLyBvbmx5IGNvcHkgdGhpcyBkYXRhIGlmIG5v\ndCBhbHJlYWR5IHNldCBleHBsaWNpdGx5IGluIHRoaXMgaW5zdGFuY2UKICAg\nICAgICBpZiAoX2RmZyA9PSAwKSB7CiAgICAgICAgICAgIF9kZmcgPSAoZmll\nbGQuaXNJbkRlZmF1bHRGZXRjaEdyb3VwKCkpID8gREZHX1RSVUUgOiBERkdf\nRkFMU0U7CiAgICAgICAgICAgIGlmIChmaWVsZC5pc0RlZmF1bHRGZXRjaEdy\nb3VwRXhwbGljaXQoKSkKICAgICAgICAgICAgICAgIF9kZmcgfD0gREZHX0VY\nUExJQ0lUOwogICAgICAgIH0KICAgICAgICBpZiAoX2ZnU2V0ID09IG51bGwg\nJiYgZmllbGQuX2ZnU2V0ICE9IG51bGwpCiAgICAgICAgICAgIF9mZ1NldCA9\nIG5ldyBIYXNoU2V0KGZpZWxkLl9mZ1NldCk7CiAgICAgICAgaWYgKF9sZmcg\nPT0gbnVsbCkKICAgICAgICAgICAgX2xmZyA9IGZpZWxkLmdldExvYWRGZXRj\naEdyb3VwKCk7CiAgICAgICAgaWYgKF9scnMgPT0gbnVsbCkKICAgICAgICAg\nICAgX2xycyA9IChmaWVsZC5pc0xSUygpKSA/IEJvb2xlYW4uVFJVRSA6IEJv\nb2xlYW4uRkFMU0U7CiAgICAgICAgaWYgKF92YWxTdHJhdGVneSA9PSAtMSkK\nICAgICAgICAgICAgX3ZhbFN0cmF0ZWd5ID0gZmllbGQuZ2V0VmFsdWVTdHJh\ndGVneSgpOwogICAgICAgIGlmIChfdXBTdHJhdGVneSA9PSAtMSkKICAgICAg\nICAgICAgX3VwU3RyYXRlZ3kgPSBmaWVsZC5nZXRVcGRhdGVTdHJhdGVneSgp\nOwogICAgICAgIGlmIChDbGFzc01ldGFEYXRhLkRFRkFVTFRfU1RSSU5HLmVx\ndWFscyhfc2VxTmFtZSkpIHsKICAgICAgICAgICAgX3NlcU5hbWUgPSBmaWVs\nZC5nZXRWYWx1ZVNlcXVlbmNlTmFtZSgpOwogICAgICAgICAgICBfc2VxTWV0\nYSA9IG51bGw7CiAgICAgICAgfQogICAgICAgIGlmIChDbGFzc01ldGFEYXRh\nLkRFRkFVTFRfU1RSSU5HLmVxdWFscyhfaW52ZXJzZSkpCiAgICAgICAgICAg\nIF9pbnZlcnNlID0gZmllbGQuZ2V0SW52ZXJzZSgpOwoKICAgICAgICAvLyBj\nb3B5IHZhbHVlIG1ldGFkYXRhCiAgICAgICAgX3ZhbC5jb3B5KGZpZWxkKTsK\nICAgICAgICBfa2V5LmNvcHkoZmllbGQuZ2V0S2V5KCkpOwogICAgICAgIF9l\nbGVtLmNvcHkoZmllbGQuZ2V0RWxlbWVudCgpKTsKICAgIH0KCiAgICBwcm90\nZWN0ZWQgdm9pZCBhZGRFeHRlbnNpb25LZXlzKENvbGxlY3Rpb24gZXh0cykg\newogICAgICAgIGdldFJlcG9zaXRvcnkoKS5nZXRNZXRhRGF0YUZhY3Rvcnko\nKS5hZGRGaWVsZEV4dGVuc2lvbktleXMoZXh0cyk7CiAgICB9CgogICAgLy8v\nLy8vLy8vLy8vLy8vCiAgICAvLyBDb21tZW50YWJsZQogICAgLy8vLy8vLy8v\nLy8vLy8vCgogICAgcHVibGljIFN0cmluZ1tdIGdldENvbW1lbnRzKCkgewog\nICAgICAgIHJldHVybiAoX2NvbW1lbnRzID09IG51bGwpID8gRU1QVFlfQ09N\nTUVOVFMgOiBfY29tbWVudHM7CiAgICB9CgogICAgcHVibGljIHZvaWQgc2V0\nQ29tbWVudHMoU3RyaW5nW10gY29tbWVudHMpIHsKICAgICAgICBfY29tbWVu\ndHMgPSBjb21tZW50czsKICAgIH0KCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8v\nLy8vLy8vLy8vLy8vLwogICAgLy8gVmFsdWVNZXRhRGF0YSBpbXBsZW1lbnRh\ndGlvbgogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KCiAg\nICBwdWJsaWMgRmllbGRNZXRhRGF0YSBnZXRGaWVsZE1ldGFEYXRhKCkgewog\nICAgICAgIHJldHVybiB0aGlzOwogICAgfQoKICAgIHB1YmxpYyBDbGFzcyBn\nZXRUeXBlKCkgewogICAgICAgIHJldHVybiBfdmFsLmdldFR5cGUoKTsKICAg\nIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRUeXBlKENsYXNzIHR5cGUpIHsKICAg\nICAgICBfdmFsLnNldFR5cGUodHlwZSk7CiAgICAgICAgaWYgKHR5cGUuaXNB\ncnJheSgpKQogICAgICAgICAgICBfZWxlbS5zZXRUeXBlKHR5cGUuZ2V0Q29t\ncG9uZW50VHlwZSgpKTsKICAgICAgICBlbHNlIGlmICh0eXBlID09IFByb3Bl\ncnRpZXMuY2xhc3MpIHsKICAgICAgICAgICAgX2tleS5zZXRUeXBlKFN0cmlu\nZy5jbGFzcyk7CiAgICAgICAgICAgIF9lbGVtLnNldFR5cGUoU3RyaW5nLmNs\nYXNzKTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGljIGludCBnZXRUeXBl\nQ29kZSgpIHsKICAgICAgICByZXR1cm4gX3ZhbC5nZXRUeXBlQ29kZSgpOwog\nICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldFR5cGVDb2RlKGludCBjb2RlKSB7\nCiAgICAgICAgX3ZhbC5zZXRUeXBlQ29kZShjb2RlKTsKICAgIH0KCiAgICBw\ndWJsaWMgYm9vbGVhbiBpc1R5cGVQQygpIHsKICAgICAgICByZXR1cm4gX3Zh\nbC5pc1R5cGVQQygpOwogICAgfQoKICAgIHB1YmxpYyBDbGFzc01ldGFEYXRh\nIGdldFR5cGVNZXRhRGF0YSgpIHsKICAgICAgICByZXR1cm4gX3ZhbC5nZXRU\neXBlTWV0YURhdGEoKTsKICAgIH0KCiAgICBwdWJsaWMgQ2xhc3MgZ2V0RGVj\nbGFyZWRUeXBlKCkgewogICAgICAgIHJldHVybiBfdmFsLmdldERlY2xhcmVk\nVHlwZSgpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldERlY2xhcmVkVHlw\nZShDbGFzcyB0eXBlKSB7CiAgICAgICAgX3ZhbC5zZXREZWNsYXJlZFR5cGUo\ndHlwZSk7CiAgICAgICAgaWYgKHR5cGUuaXNBcnJheSgpKQogICAgICAgICAg\nICBfZWxlbS5zZXREZWNsYXJlZFR5cGUodHlwZS5nZXRDb21wb25lbnRUeXBl\nKCkpOwogICAgICAgIGVsc2UgaWYgKHR5cGUgPT0gUHJvcGVydGllcy5jbGFz\ncykgewogICAgICAgICAgICBfa2V5LnNldERlY2xhcmVkVHlwZShTdHJpbmcu\nY2xhc3MpOwogICAgICAgICAgICBfZWxlbS5zZXREZWNsYXJlZFR5cGUoU3Ry\naW5nLmNsYXNzKTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGljIGludCBn\nZXREZWNsYXJlZFR5cGVDb2RlKCkgewogICAgICAgIHJldHVybiBfdmFsLmdl\ndERlY2xhcmVkVHlwZUNvZGUoKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBz\nZXREZWNsYXJlZFR5cGVDb2RlKGludCB0eXBlKSB7CiAgICAgICAgX3ZhbC5z\nZXREZWNsYXJlZFR5cGVDb2RlKHR5cGUpOwogICAgfQoKICAgIHB1YmxpYyBi\nb29sZWFuIGlzRGVjbGFyZWRUeXBlUEMoKSB7CiAgICAgICAgcmV0dXJuIF92\nYWwuaXNEZWNsYXJlZFR5cGVQQygpOwogICAgfQoKICAgIHB1YmxpYyBDbGFz\nc01ldGFEYXRhIGdldERlY2xhcmVkVHlwZU1ldGFEYXRhKCkgewogICAgICAg\nIHJldHVybiBfdmFsLmdldERlY2xhcmVkVHlwZU1ldGFEYXRhKCk7CiAgICB9\nCgogICAgcHVibGljIGJvb2xlYW4gaXNFbWJlZGRlZCgpIHsKICAgICAgICBy\nZXR1cm4gX3ZhbC5pc0VtYmVkZGVkKCk7CiAgICB9CgogICAgcHVibGljIHZv\naWQgc2V0RW1iZWRkZWQoYm9vbGVhbiBlbWJlZGRlZCkgewogICAgICAgIF92\nYWwuc2V0RW1iZWRkZWQoZW1iZWRkZWQpOwogICAgfQoKICAgIHB1YmxpYyBi\nb29sZWFuIGlzRW1iZWRkZWRQQygpIHsKICAgICAgICByZXR1cm4gX3ZhbC5p\nc0VtYmVkZGVkUEMoKTsKICAgIH0KCiAgICBwdWJsaWMgQ2xhc3NNZXRhRGF0\nYSBnZXRFbWJlZGRlZE1ldGFEYXRhKCkgewogICAgICAgIHJldHVybiBfdmFs\nLmdldEVtYmVkZGVkTWV0YURhdGEoKTsKICAgIH0KCiAgICBwdWJsaWMgQ2xh\nc3NNZXRhRGF0YSBhZGRFbWJlZGRlZE1ldGFEYXRhKCkgewogICAgICAgIHJl\ndHVybiBfdmFsLmFkZEVtYmVkZGVkTWV0YURhdGEoKTsKICAgIH0KCiAgICBw\ndWJsaWMgaW50IGdldENhc2NhZGVEZWxldGUoKSB7CiAgICAgICAgcmV0dXJu\nIF92YWwuZ2V0Q2FzY2FkZURlbGV0ZSgpOwogICAgfQoKICAgIHB1YmxpYyB2\nb2lkIHNldENhc2NhZGVEZWxldGUoaW50IGRlbGV0ZSkgewogICAgICAgIF92\nYWwuc2V0Q2FzY2FkZURlbGV0ZShkZWxldGUpOwogICAgfQoKICAgIHB1Ymxp\nYyBpbnQgZ2V0Q2FzY2FkZVBlcnNpc3QoKSB7CiAgICAgICAgcmV0dXJuIF92\nYWwuZ2V0Q2FzY2FkZVBlcnNpc3QoKTsKICAgIH0KCiAgICBwdWJsaWMgdm9p\nZCBzZXRDYXNjYWRlUGVyc2lzdChpbnQgcGVyc2lzdCkgewogICAgICAgIF92\nYWwuc2V0Q2FzY2FkZVBlcnNpc3QocGVyc2lzdCk7CiAgICB9CgogICAgcHVi\nbGljIGludCBnZXRDYXNjYWRlQXR0YWNoKCkgewogICAgICAgIHJldHVybiBf\ndmFsLmdldENhc2NhZGVBdHRhY2goKTsKICAgIH0KCiAgICBwdWJsaWMgdm9p\nZCBzZXRDYXNjYWRlQXR0YWNoKGludCBhdHRhY2gpIHsKICAgICAgICBfdmFs\nLnNldENhc2NhZGVBdHRhY2goYXR0YWNoKTsKICAgIH0KCiAgICBwdWJsaWMg\naW50IGdldENhc2NhZGVSZWZyZXNoKCkgewogICAgICAgIHJldHVybiBfdmFs\nLmdldENhc2NhZGVSZWZyZXNoKCk7CiAgICB9CgogICAgcHVibGljIHZvaWQg\nc2V0Q2FzY2FkZVJlZnJlc2goaW50IHJlZnJlc2gpIHsKICAgICAgICBfdmFs\nLnNldENhc2NhZGVSZWZyZXNoKHJlZnJlc2gpOwogICAgfQoKICAgIHB1Ymxp\nYyBib29sZWFuIGlzU2VyaWFsaXplZCgpIHsKICAgICAgICByZXR1cm4gX3Zh\nbC5pc1NlcmlhbGl6ZWQoKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRT\nZXJpYWxpemVkKGJvb2xlYW4gc2VyaWFsaXplZCkgewogICAgICAgIF92YWwu\nc2V0U2VyaWFsaXplZChzZXJpYWxpemVkKTsKICAgIH0KCiAgICBwdWJsaWMg\nU3RyaW5nIGdldFZhbHVlTWFwcGVkQnkoKSB7CiAgICAgICAgcmV0dXJuIF92\nYWwuZ2V0VmFsdWVNYXBwZWRCeSgpOwogICAgfQoKICAgIHB1YmxpYyB2b2lk\nIHNldFZhbHVlTWFwcGVkQnkoU3RyaW5nIG1hcHBlZCkgewogICAgICAgIF92\nYWwuc2V0VmFsdWVNYXBwZWRCeShtYXBwZWQpOwogICAgfQoKICAgIHB1Ymxp\nYyBGaWVsZE1ldGFEYXRhIGdldFZhbHVlTWFwcGVkQnlNZXRhRGF0YSAoKQoJ\newoJCXJldHVybiBfdmFsLmdldFZhbHVlTWFwcGVkQnlNZXRhRGF0YSAoKTsK\nCX0KCglwdWJsaWMgQ2xhc3MgZ2V0VHlwZU92ZXJyaWRlICgpCgl7CgkJcmV0\ndXJuIF92YWwuZ2V0VHlwZU92ZXJyaWRlICgpOwoJfQoKCXB1YmxpYyB2b2lk\nIHNldFR5cGVPdmVycmlkZSAoQ2xhc3MgdHlwZSkKCXsKCQlfdmFsLnNldFR5\ncGVPdmVycmlkZSAodHlwZSk7Cgl9CgoJcHVibGljIHZvaWQgY29weSAoVmFs\ndWVNZXRhRGF0YSB2bWQpCgl7CgkJX3ZhbC5jb3B5ICh2bWQpOwoJfQoKICAg\nIC8qKgogICAgICogQ2hlY2sgaWYgdGhpcyBmaWVsZCBpcyB1c2VkIGJ5IG90\naGVyIGZpZWxkIGFzICJvcmRlciBieSIgdmFsdWUuCiAgICAgKgogICAgICog\nQHNpbmNlIDEuMS4wCiAgICAgKi8KICAgIHB1YmxpYyBib29sZWFuIGlzVXNl\nZEluT3JkZXJCeSgpIHsKICAgIAlyZXR1cm4gX3VzZWRJbk9yZGVyQnk7CiAg\nICB9CiAgICAKICAgIC8qKgogICAgICogV2hldGhlciB0aGlzIGZpZWxkIGlz\nIHVzZWQgYnkgb3RoZXIgZmllbGQgYXMgIm9yZGVyIGJ5IiB2YWx1ZSAuCiAg\nICAgKgogICAgICogQHNpbmNlIDEuMS4wCiAgICAgKi8KICAgIHB1YmxpYyB2\nb2lkIHNldFVzZWRJbk9yZGVyQnkoYm9vbGVhbiBpc1VzZWQpIHsKICAgIAlf\ndXNlZEluT3JkZXJCeSA9IGlzVXNlZDsKICAgIH0KICAgIAogICAgLyoqCiAg\nICAgKiBTZXJpYWxpemFibGUgd3JhcHBlciBhcm91bmQgYSB7QGxpbmsgTWV0\naG9kfSBvciB7QGxpbmsgRmllbGR9LiBGb3IgCiAgICAgKiBzcGFjZSBjb25z\naWRlcmF0aW9ucywgdGhpcyBkb2VzIG5vdCBzdXBwb3J0IHtAbGluayBDb25z\ndHJ1Y3Rvcn1zLgogICAgICovCglwdWJsaWMgc3RhdGljIGNsYXNzIE1lbWJl\nclByb3ZpZGVyCiAgICAgICAgaW1wbGVtZW50cyBFeHRlcm5hbGl6YWJsZSB7\nCgogICAgICAgIHByaXZhdGUgdHJhbnNpZW50IE1lbWJlciBfbWVtYmVyOwoK\nICAgICAgICBwdWJsaWMgTWVtYmVyUHJvdmlkZXIoKSB7CiAgICAgICAgICAg\nIC8vIGZvciBleHRlcm5hbGl6YXRpb24KICAgICAgICB9CgogICAgICAgIE1l\nbWJlclByb3ZpZGVyKE1lbWJlciBtZW1iZXIpIHsKICAgICAgICAgICAgaWYg\nKG1lbWJlciBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKQogICAgICAgICAgICAg\nICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbigpOwoKICAg\nICAgICAgICAgX21lbWJlciA9IG1lbWJlcjsKICAgICAgICB9CgogICAgICAg\nIHB1YmxpYyBNZW1iZXIgZ2V0TWVtYmVyKCkgewogICAgICAgICAgICByZXR1\ncm4gX21lbWJlcjsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyB2b2lkIHJl\nYWRFeHRlcm5hbChPYmplY3RJbnB1dCBpbikKICAgICAgICAgICAgdGhyb3dz\nIElPRXhjZXB0aW9uLCBDbGFzc05vdEZvdW5kRXhjZXB0aW9uIHsKICAgICAg\nICAgICAgYm9vbGVhbiBpc0ZpZWxkID0gaW4ucmVhZEJvb2xlYW4oKTsKICAg\nICAgICAgICAgQ2xhc3MgY2xzID0gKENsYXNzKSBpbi5yZWFkT2JqZWN0KCk7\nCiAgICAgICAgICAgIFN0cmluZyBtZW1iZXJOYW1lID0gKFN0cmluZykgaW4u\ncmVhZE9iamVjdCgpOwogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAg\nICAgaWYgKGlzRmllbGQpCiAgICAgICAgICAgICAgICAgICAgX21lbWJlciA9\nIChGaWVsZCkgQWNjZXNzQ29udHJvbGxlci5kb1ByaXZpbGVnZWQoCiAgICAg\nICAgICAgICAgICAgICAgICAgIEoyRG9Qcml2SGVscGVyLmdldERlY2xhcmVk\nRmllbGRBY3Rpb24oCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbHMs\nIG1lbWJlck5hbWUpKTsgCiAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAg\nICAgICAgICAgICAgICBDbGFzc1tdIHBhcmFtZXRlclR5cGVzID0gKENsYXNz\nW10pIGluLnJlYWRPYmplY3QoKTsKICAgICAgICAgICAgICAgICAgICBfbWVt\nYmVyID0gKE1ldGhvZCkgQWNjZXNzQ29udHJvbGxlci5kb1ByaXZpbGVnZWQo\nCiAgICAgICAgICAgICAgICAgICAgICAgIEoyRG9Qcml2SGVscGVyLmdldERl\nY2xhcmVkTWV0aG9kQWN0aW9uKAogICAgICAgICAgICAgICAgICAgICAgICAg\nICAgY2xzLCBtZW1iZXJOYW1lLCBwYXJhbWV0ZXJUeXBlcykpOwogICAgICAg\nICAgICAgICAgfQogICAgICAgICAgICB9IGNhdGNoIChTZWN1cml0eUV4Y2Vw\ndGlvbiBlKSB7CiAgICAgICAgICAgICAgICBJT0V4Y2VwdGlvbiBpb2UgPSBu\nZXcgSU9FeGNlcHRpb24oZS5nZXRNZXNzYWdlKCkpOwogICAgICAgICAgICAg\nICAgaW9lLmluaXRDYXVzZShlKTsKICAgICAgICAgICAgICAgIHRocm93IGlv\nZTsKICAgICAgICAgICAgfSBjYXRjaCAoUHJpdmlsZWdlZEFjdGlvbkV4Y2Vw\ndGlvbiBwYWUpIHsKICAgICAgICAgICAgICAgIElPRXhjZXB0aW9uIGlvZSA9\nIG5ldyBJT0V4Y2VwdGlvbigKICAgICAgICAgICAgICAgICAgICBwYWUuZ2V0\nRXhjZXB0aW9uKCkuZ2V0TWVzc2FnZSgpKTsKICAgICAgICAgICAgICAgIGlv\nZS5pbml0Q2F1c2UocGFlKTsKICAgICAgICAgICAgICAgIHRocm93IGlvZTsK\nICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgcHVibGljIHZvaWQg\nd3JpdGVFeHRlcm5hbChPYmplY3RPdXRwdXQgb3V0KQogICAgICAgICAgICB0\naHJvd3MgSU9FeGNlcHRpb24gewogICAgICAgICAgICBib29sZWFuIGlzRmll\nbGQgPSBfbWVtYmVyIGluc3RhbmNlb2YgRmllbGQ7CiAgICAgICAgICAgIG91\ndC53cml0ZUJvb2xlYW4oaXNGaWVsZCk7CiAgICAgICAgICAgIG91dC53cml0\nZU9iamVjdChfbWVtYmVyLmdldERlY2xhcmluZ0NsYXNzKCkpOwogICAgICAg\nICAgICBvdXQud3JpdGVPYmplY3QoX21lbWJlci5nZXROYW1lKCkpOwogICAg\nICAgICAgICBpZiAoIWlzRmllbGQpCiAgICAgICAgICAgICAgICBvdXQud3Jp\ndGVPYmplY3QoKChNZXRob2QpIF9tZW1iZXIpLmdldFBhcmFtZXRlclR5cGVz\nKCkpOwogICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBpc1Zh\nbHVlR2VuZXJhdGVkKCkgewogICAgICAgIHJldHVybiBfZ2VuZXJhdGVkOwog\nICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldFZhbHVlR2VuZXJhdGVkKGJvb2xl\nYW4gZ2VuZXJhdGVkKSB7CiAgICAgICAgdGhpcy5fZ2VuZXJhdGVkID0gZ2Vu\nZXJhdGVkOwogICAgfQp9Cg==\n","encoding":"base64"}

