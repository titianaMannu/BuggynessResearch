{"sha":"9b2b9bc02217b173c0e6a4b7f18a46a018f813ee","node_id":"MDQ6QmxvYjIwNjM2NDo5YjJiOWJjMDIyMTdiMTczYzBlNmE0YjdmMThhNDZhMDE4ZjgxM2Vl","size":11490,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/9b2b9bc02217b173c0e6a4b7f18a46a018f813ee","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YTsKCmltcG9ydCBqYXZh\nLmlvLkZpbGU7CmltcG9ydCBqYXZhLmlvLklPRXhjZXB0aW9uOwppbXBvcnQg\namF2YS5pby5QcmludFdyaXRlcjsKaW1wb3J0IGphdmEuaW8uV3JpdGVyOwpp\nbXBvcnQgamF2YS51dGlsLkhhc2hNYXA7CmltcG9ydCBqYXZhLnV0aWwuSGFz\naFNldDsKaW1wb3J0IGphdmEudXRpbC5JdGVyYXRvcjsKaW1wb3J0IGphdmEu\ndXRpbC5NYXA7CmltcG9ydCBqYXZhLnV0aWwuU2V0OwoKaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS5jb25mLk9wZW5KUEFDb25maWd1cmF0aW9uOwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLmNvbmYuT3BlbkpQQUNvbmZpZ3VyYXRp\nb25JbXBsOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi5jb25mLkNv\nbmZpZ3VyYXRpb25zOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi5s\nb2cuTG9nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi5tZXRhLkNs\nYXNzQXJnUGFyc2VyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51\ndGlsLkZpbGVzOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51dGls\nLkxvY2FsaXplcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIudXRp\nbC5PcHRpb25zOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuTWV0\nYURhdGFFeGNlcHRpb247CgovKioKICogVG9vbCBmb3IgZ2VuZXJhdGluZyBk\nZWZhdWx0IG1ldGFkYXRhLgogKgogKiBAc2luY2UgMC4zLjAKICogQGF1dGhv\nciBBYmUgV2hpdGUKICovCnB1YmxpYyBjbGFzcyBNZXRhRGF0YVRvb2wKICAg\nIGltcGxlbWVudHMgTWV0YURhdGFNb2RlcyB7CgogICAgcHVibGljIHN0YXRp\nYyBmaW5hbCBTdHJpbmcgQUNUSU9OX0FERCA9ICJhZGQiOwogICAgcHVibGlj\nIHN0YXRpYyBmaW5hbCBTdHJpbmcgQUNUSU9OX0RST1AgPSAiZHJvcCI7Cgog\nICAgcHVibGljIHN0YXRpYyBmaW5hbCBTdHJpbmdbXSBBQ1RJT05TID0gbmV3\nIFN0cmluZ1tdewogICAgICAgIEFDVElPTl9BREQsCiAgICAgICAgQUNUSU9O\nX0RST1AsCiAgICB9OwoKICAgIHByaXZhdGUgc3RhdGljIExvY2FsaXplciBf\nbG9jID0gTG9jYWxpemVyLmZvclBhY2thZ2UoTWV0YURhdGFUb29sLmNsYXNz\nKTsKCiAgICBwcml2YXRlIGZpbmFsIE9wZW5KUEFDb25maWd1cmF0aW9uIF9j\nb25mOwogICAgcHJpdmF0ZSBmaW5hbCBTdHJpbmcgX2FjdGlvbjsKCiAgICBw\ncml2YXRlIGZpbmFsIFNldCBfZHJvcDsKICAgIHByaXZhdGUgTWV0YURhdGFS\nZXBvc2l0b3J5IF9yZXBvcyA9IG51bGw7CiAgICBwcml2YXRlIEZpbGUgX2Zp\nbGUgPSBudWxsOwogICAgcHJpdmF0ZSBXcml0ZXIgX3dyaXRlciA9IG51bGw7\nCiAgICBwcml2YXRlIGJvb2xlYW4gX2ZsdXNoID0gZmFsc2U7CgogICAgLyoq\nCiAgICAgKiBDb25zdHJ1Y3Rvci4gU3VwcGx5IGNvbmZpZ3VyYXRpb24gYW5k\nIGFjdGlvbi4KICAgICAqLwogICAgcHVibGljIE1ldGFEYXRhVG9vbChPcGVu\nSlBBQ29uZmlndXJhdGlvbiBjb25mLCBTdHJpbmcgYWN0aW9uKSB7CiAgICAg\nICAgX2NvbmYgPSBjb25mOwogICAgICAgIF9hY3Rpb24gPSAoYWN0aW9uID09\nIG51bGwpID8gQUNUSU9OX0FERCA6IGFjdGlvbjsKCiAgICAgICAgaWYgKEFD\nVElPTl9EUk9QLmVxdWFscyhfYWN0aW9uKSkKICAgICAgICAgICAgX2Ryb3Ag\nPSBuZXcgSGFzaFNldCgpOwogICAgICAgIGVsc2UKICAgICAgICAgICAgX2Ry\nb3AgPSBudWxsOwogICAgfQoKICAgIC8qKgogICAgICogVGhlIGFjdGlvbiBz\ndXBwbGllZCBvbiBjb25zdHJ1Y3Rpb24uCiAgICAgKi8KICAgIHB1YmxpYyBT\ndHJpbmcgZ2V0QWN0aW9uKCkgewogICAgICAgIHJldHVybiBfYWN0aW9uOwog\nICAgfQoKICAgIC8qKgogICAgICogVGhlIGZpbGUgdG8gZ2VuZXJhdGUgbWV0\nYWRhdGEgdG8uCiAgICAgKi8KICAgIHB1YmxpYyBGaWxlIGdldEZpbGUoKSB7\nCiAgICAgICAgcmV0dXJuIF9maWxlOwogICAgfQoKICAgIC8qKgogICAgICog\nVGhlIGZpbGUgdG8gZ2VuZXJhdGUgbWV0YWRhdGEgdG8uCiAgICAgKi8KICAg\nIHB1YmxpYyB2b2lkIHNldEZpbGUoRmlsZSBmaWxlKSB7CiAgICAgICAgX2Zp\nbGUgPSBmaWxlOwogICAgfQoKICAgIC8qKgogICAgICogVGhlIHdyaXRlciB0\nbyBnZW5lcmF0ZSBtZXRhZGF0YSB0by4KICAgICAqLwogICAgcHVibGljIFdy\naXRlciBnZXRXcml0ZXIoKSB7CiAgICAgICAgcmV0dXJuIF93cml0ZXI7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBUaGUgd3JpdGVyIHRvIGdlbmVyYXRlIG1l\ndGFkYXRhIHRvLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRXcml0ZXIo\nV3JpdGVyIHdyaXRlcikgewogICAgICAgIF93cml0ZXIgPSB3cml0ZXI7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBUaGUgcmVwb3NpdG9yeSB0byB1c2UgdG8g\naG9sZCBtZXRhZGF0YS4KICAgICAqLwogICAgcHVibGljIE1ldGFEYXRhUmVw\nb3NpdG9yeSBnZXRSZXBvc2l0b3J5KCkgewogICAgICAgIGlmIChfcmVwb3Mg\nPT0gbnVsbCkgewogICAgICAgICAgICBfcmVwb3MgPSBuZXdSZXBvc2l0b3J5\nKCk7CiAgICAgICAgICAgIF9yZXBvcy5zZXRSZXNvbHZlKE1PREVfTUFQUElO\nRywgZmFsc2UpOwogICAgICAgICAgICBNZXRhRGF0YUZhY3RvcnkgZmFjdG9y\neSA9IF9yZXBvcy5nZXRNZXRhRGF0YUZhY3RvcnkoKTsKICAgICAgICAgICAg\nZmFjdG9yeS5nZXREZWZhdWx0cygpLnNldElnbm9yZU5vblBlcnNpc3RlbnQo\nZmFsc2UpOwogICAgICAgICAgICBmYWN0b3J5LnNldFN0b3JlTW9kZShNZXRh\nRGF0YUZhY3RvcnkuU1RPUkVfVkVSQk9TRSk7CiAgICAgICAgfQogICAgICAg\nIHJldHVybiBfcmVwb3M7CiAgICB9CgogICAgLyoqCiAgICAgKiBDcmVhdGUg\nYSBuZXcgbWV0YWRhdGEgcmVwb3NpdG9yeS4KICAgICAqLwogICAgcHJvdGVj\ndGVkIE1ldGFEYXRhUmVwb3NpdG9yeSBuZXdSZXBvc2l0b3J5KCkgewogICAg\nICAgIHJldHVybiBfY29uZi5uZXdNZXRhRGF0YVJlcG9zaXRvcnlJbnN0YW5j\nZSgpOwogICAgfQoKICAgIC8qKgogICAgICogVGhlIHJlcG9zaXRvcnkgdG8g\ndXNlIHRvIGhvbGQgbWV0YWRhdGEuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lk\nIHNldFJlcG9zaXRvcnkoTWV0YURhdGFSZXBvc2l0b3J5IHJlcG9zKSB7CiAg\nICAgICAgX3JlcG9zID0gcmVwb3M7CiAgICB9CgogICAgLyoqCiAgICAgKiBS\nZXNldCBzdGF0ZS4gVGhpcyBpcyBjYWxsZWQgYXV0b21hdGljYWxseSBhZnRl\nciBldmVyeSB7QGxpbmsgI3JlY29yZH0uCiAgICAgKi8KICAgIHB1YmxpYyB2\nb2lkIGNsZWFyKCkgewogICAgICAgIF9yZXBvcyA9IG51bGw7CiAgICAgICAg\naWYgKF9kcm9wICE9IG51bGwpCiAgICAgICAgICAgIF9kcm9wLmNsZWFyKCk7\nCiAgICAgICAgX2ZsdXNoID0gZmFsc2U7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBHZW5lcmF0ZSBuZXcgbWV0YWRhdGEgZm9yIHRoZSBnaXZlbiBjbGFzcy4K\nICAgICAqLwogICAgcHVibGljIHZvaWQgcnVuKENsYXNzIGNscykgewogICAg\nICAgIGlmIChjbHMgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuOwogICAg\nICAgIGlmIChBQ1RJT05fRFJPUC5lcXVhbHMoX2FjdGlvbikpCiAgICAgICAg\nICAgIF9kcm9wLmFkZChjbHMpOwogICAgICAgIGVsc2UgaWYgKEFDVElPTl9B\nREQuZXF1YWxzKF9hY3Rpb24pKQogICAgICAgICAgICBhZGQoY2xzKTsKICAg\nICAgICBlbHNlCiAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1l\nbnRFeGNlcHRpb24oImFjdGlvbiA9PSAiICsgX2FjdGlvbik7CiAgICB9Cgog\nICAgcHJpdmF0ZSB2b2lkIGFkZChDbGFzcyBjbHMpIHsKICAgICAgICAvLyBh\nc3N1bWUgYWxsIHVzZXItZGVmaW5lZCB0eXBlcyBhcmUgUENzCiAgICAgICAg\nQ2xhc3NNZXRhRGF0YSBtZXRhID0gZ2V0UmVwb3NpdG9yeSgpLmFkZE1ldGFE\nYXRhKGNscyk7CiAgICAgICAgRmllbGRNZXRhRGF0YVtdIGZtZHMgPSBtZXRh\nLmdldERlY2xhcmVkRmllbGRzKCk7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7\nIGkgPCBmbWRzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGlmIChmbWRz\nW2ldLmdldERlY2xhcmVkVHlwZUNvZGUoKSA9PSBKYXZhVHlwZXMuT0JKRUNU\nCiAgICAgICAgICAgICAgICAmJiBmbWRzW2ldLmdldERlY2xhcmVkVHlwZSgp\nICE9IE9iamVjdC5jbGFzcykKICAgICAgICAgICAgICAgIGZtZHNbaV0uc2V0\nRGVjbGFyZWRUeXBlQ29kZShKYXZhVHlwZXMuUEMpOwogICAgICAgIH0KICAg\nICAgICBtZXRhLnNldFNvdXJjZShfZmlsZSwgbWV0YS5nZXRTb3VyY2VUeXBl\nKCkpOwogICAgICAgIF9mbHVzaCA9IHRydWU7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBSZWNvcmQgbWV0YWRhdGEgY2hhbmdlcy4KICAgICAqLwogICAgcHVi\nbGljIHZvaWQgcmVjb3JkKCkgewogICAgICAgIE1ldGFEYXRhUmVwb3NpdG9y\neSByZXBvcyA9IGdldFJlcG9zaXRvcnkoKTsKICAgICAgICBNZXRhRGF0YUZh\nY3RvcnkgbWRmID0gcmVwb3MuZ2V0TWV0YURhdGFGYWN0b3J5KCk7CiAgICAg\nICAgdHJ5IHsKICAgICAgICAgICAgaWYgKF9kcm9wICE9IG51bGwgJiYgIV9k\ncm9wLmlzRW1wdHkoKQogICAgICAgICAgICAgICAgJiYgIW1kZi5kcm9wKChD\nbGFzc1tdKSBfZHJvcC50b0FycmF5KG5ldyBDbGFzc1tfZHJvcC5zaXplKCld\nKSwKICAgICAgICAgICAgICAgIE1PREVfTUVUQSB8IE1PREVfTUFQUElORyB8\nIE1PREVfUVVFUlksIG51bGwpKSB7CiAgICAgICAgICAgICAgICBMb2cgbG9n\nID0gX2NvbmYuZ2V0TG9nKE9wZW5KUEFDb25maWd1cmF0aW9uLkxPR19NRVRB\nREFUQSk7CiAgICAgICAgICAgICAgICBpZiAobG9nLmlzV2FybkVuYWJsZWQo\nKSkKICAgICAgICAgICAgICAgICAgICBsb2cud2FybihfbG9jLmdldCgiYmFk\nLWRyb3AiLCBfZHJvcCkpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlm\nICghX2ZsdXNoKQogICAgICAgICAgICAgICAgcmV0dXJuOwoKICAgICAgICAg\nICAgQ2xhc3NNZXRhRGF0YVtdIG1ldGFzID0gcmVwb3MuZ2V0TWV0YURhdGFz\nKCk7CiAgICAgICAgICAgIE1hcCBvdXRwdXQgPSBudWxsOwoKICAgICAgICAg\nICAgLy8gaWYgd2UncmUgb3V0cHV0dGluZyB0byBzdHJlYW0sIHNldCBhbGwg\nbWV0YXMgdG8gc2FtZSBmaWxlIHNvCiAgICAgICAgICAgIC8vIHRoZXkgZ2V0\nIHBsYWNlZCBpbiBzaW5nbGUgc3RyaW5nCiAgICAgICAgICAgIGlmIChfd3Jp\ndGVyICE9IG51bGwpIHsKICAgICAgICAgICAgICAgIG91dHB1dCA9IG5ldyBI\nYXNoTWFwKCk7CiAgICAgICAgICAgICAgICBGaWxlIHRtcCA9IG5ldyBGaWxl\nKCJvcGVuanBhdG1wIik7CiAgICAgICAgICAgICAgICBmb3IgKGludCBpID0g\nMDsgaSA8IG1ldGFzLmxlbmd0aDsgaSsrKQogICAgICAgICAgICAgICAgICAg\nIG1ldGFzW2ldLnNldFNvdXJjZSh0bXAsIG1ldGFzW2ldLmdldFNvdXJjZVR5\ncGUoKSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKCFtZGYuc3Rv\ncmUobWV0YXMsIG5ldyBRdWVyeU1ldGFEYXRhWzBdLAogICAgICAgICAgICAg\nICAgbmV3IFNlcXVlbmNlTWV0YURhdGFbMF0sIE1PREVfTUVUQSwgb3V0cHV0\nKSkKICAgICAgICAgICAgICAgIHRocm93IG5ldyBNZXRhRGF0YUV4Y2VwdGlv\nbihfbG9jLmdldCgiYmFkLXN0b3JlIikpOwogICAgICAgICAgICBpZiAoX3dy\naXRlciAhPSBudWxsKSB7CiAgICAgICAgICAgICAgICBQcmludFdyaXRlciBv\ndXQgPSBuZXcgUHJpbnRXcml0ZXIoX3dyaXRlcik7CiAgICAgICAgICAgICAg\nICBmb3IgKEl0ZXJhdG9yIGl0ciA9IG91dHB1dC52YWx1ZXMoKS5pdGVyYXRv\ncigpOwogICAgICAgICAgICAgICAgICAgIGl0ci5oYXNOZXh0KCk7KQogICAg\nICAgICAgICAgICAgICAgIG91dC5wcmludGxuKChTdHJpbmcpIGl0ci5uZXh0\nKCkpOwogICAgICAgICAgICAgICAgb3V0LmZsdXNoKCk7CiAgICAgICAgICAg\nIH0KICAgICAgICB9CiAgICAgICAgZmluYWxseSB7CiAgICAgICAgICAgIGNs\nZWFyKCk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogVXNhZ2U6\nIGphdmEgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuTWV0YURhdGFUb29sIFtv\ncHRpb25dKgogICAgICogWy1hY3Rpb24vLWEgJmx0O2FkZCB8IGRyb3AmZ3Q7\nXQogICAgICogJmx0O2NsYXNzIG5hbWUgfCAuamF2YSBmaWxlIHwgLmNsYXNz\nIGZpbGUmZ3Q7KwogICAgICogIFdoZXJlIHRoZSBmb2xsb3dpbmcgb3B0aW9u\ncyBhcmUgcmVjb2duaXplZC4KICAgICAqIDx1bD4KICAgICAqIDxsaT48aT4t\ncHJvcGVydGllcy8tcCAmbHQ7cHJvcGVydGllcyBmaWxlIG9yIHJlc291cmNl\nJmd0OzwvaT46IFRoZSBwYXRoCiAgICAgKiBvciByZXNvdXJjZSBuYW1lIG9m\nIGEgT3BlbkpQQSBwcm9wZXJ0aWVzIGZpbGUgY29udGFpbmluZyBpbmZvcm1h\ndGlvbgogICAgICogYXMgb3V0bGluZWQgaW4ge0BsaW5rIE9wZW5KUEFDb25m\naWd1cmF0aW9ufS4gT3B0aW9uYWwuPC9saT4KICAgICAqIDxsaT48aT4tJmx0\nO3Byb3BlcnR5IG5hbWUmZ3Q7ICZsdDtwcm9wZXJ0eSB2YWx1ZSZndDs8L2k+\nOiBBbGwgYmVhbgogICAgICogcHJvcGVydGllcyBvZiB0aGUgT3BlbkpQQSB7\nQGxpbmsgT3BlbkpQQUNvbmZpZ3VyYXRpb259IGNhbiBiZSBzZXQgYnkKICAg\nICAqIHVzaW5nIHRoZWlyIG5hbWVzIGFuZCBzdXBwbHlpbmcgYSB2YWx1ZS48\nL2xpPgogICAgICogPGxpPjxpPi1maWxlLy1mICZsdDtzdGRvdXQgfCBvdXRw\ndXQgZmlsZSBvciByZXNvdXJjZSZndDs8L2k+OiBUaGUgcGF0aAogICAgICog\nb3IgcmVzb3VyY2UgbmFtZSBvZiBhIGZpbGUgdGhlIG1ldGFkYXRhIHNob3Vs\nZCBiZSBnZW5lcmF0ZWQgdG8uCiAgICAgKiBJZiB0aGUgZ2l2ZW4gZmlsZSBh\nbHJlYWR5IGNvbnRhaW5zIG1ldGFkYXRhLCB0aGUgZ2VuZXJhdGVkCiAgICAg\nKiBtZXRhZGF0YSB3aWxsIGJlIG1lcmdlZCBpbnRvIHRoZSBleGlzdGluZyBk\nb2N1bWVudC48L2xpPgogICAgICogPC91bD4KICAgICAqICBUaGUgYXZhaWxh\nYmxlIGFjdGlvbnMgYXJlOgogICAgICogPHVsPgogICAgICogPGxpPjxpPmFk\nZDwvaT46IEdlbmVyYXRlIGRlZmF1bHQgbWV0YWRhdGEgZm9yIHRoZSBnaXZl\nbiBjbGFzc2VzLiBUaGlzCiAgICAgKiBpcyB0aGUgZGVmYXVsdCBhY3Rpb24u\nPC9saT4KICAgICAqIDxsaT48aT5kcm9wPC9pPjogUmVtb3ZlIGV4aXN0aW5n\nIG1ldGFkYXRhIGZvciB0aGUgZ2l2ZW4gY2xhc3Nlcy48L2xpPgogICAgICog\nPC91bD4KICAgICAqLwogICAgcHVibGljIHN0YXRpYyB2b2lkIG1haW4oU3Ry\naW5nW10gYXJncykKICAgICAgICB0aHJvd3MgSU9FeGNlcHRpb24gewogICAg\nICAgIE9wdGlvbnMgb3B0cyA9IG5ldyBPcHRpb25zKCk7CiAgICAgICAgZmlu\nYWwgU3RyaW5nW10gYXJndW1lbnRzID0gb3B0cy5zZXRGcm9tQ21kTGluZShh\ncmdzKTsKICAgICAgICBib29sZWFuIHJldCA9IChhcmdzLmxlbmd0aCA+IDAp\nICYmCiAgICAgICAgICAgIENvbmZpZ3VyYXRpb25zLnJ1bkFnYWluc3RBbGxB\nbmNob3JzKG9wdHMsCiAgICAgICAgICAgIG5ldyBDb25maWd1cmF0aW9ucy5S\ndW5uYWJsZSgpIHsKICAgICAgICAgICAgcHVibGljIGJvb2xlYW4gcnVuKE9w\ndGlvbnMgb3B0cykgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgICAgICAg\nICBPcGVuSlBBQ29uZmlndXJhdGlvbiBjb25mID0gbmV3IE9wZW5KUEFDb25m\naWd1cmF0aW9uSW1wbCgpOwogICAgICAgICAgICAgICAgdHJ5IHsKICAgICAg\nICAgICAgICAgICAgICByZXR1cm4gTWV0YURhdGFUb29sLnJ1bihjb25mLCBh\ncmd1bWVudHMsIG9wdHMpOwogICAgICAgICAgICAgICAgfSBmaW5hbGx5IHsK\nICAgICAgICAgICAgICAgICAgICBjb25mLmNsb3NlKCk7CiAgICAgICAgICAg\nICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgICBpZiAo\nIXJldCkKICAgICAgICAgICAgU3lzdGVtLmVyci5wcmludGxuKF9sb2MuZ2V0\nKCJ0b29sLXVzYWdlIikpOwogICAgfQoKICAgIC8qKgogICAgICogUnVuIHRo\nZSB0b29sLiBSZXR1cm5zIGZhbHNlIGlmIGFueSBpbnZhbGlkIG9wdGlvbnMg\nd2VyZSBnaXZlbi4KICAgICAqLwogICAgcHVibGljIHN0YXRpYyBib29sZWFu\nIHJ1bihPcGVuSlBBQ29uZmlndXJhdGlvbiBjb25mLCBTdHJpbmdbXSBhcmdz\nLAogICAgICAgIE9wdGlvbnMgb3B0cykKICAgICAgICB0aHJvd3MgSU9FeGNl\ncHRpb24gewogICAgICAgIEZsYWdzIGZsYWdzID0gbmV3IEZsYWdzKCk7CiAg\nICAgICAgZmxhZ3MuYWN0aW9uID0gb3B0cy5yZW1vdmVQcm9wZXJ0eSgiYWN0\naW9uIiwgImEiLCBmbGFncy5hY3Rpb24pOwogICAgICAgIFN0cmluZyBmaWxl\nTmFtZSA9IG9wdHMucmVtb3ZlUHJvcGVydHkoImZpbGUiLCAiZiIsIG51bGwp\nOwogICAgICAgIGlmICgic3Rkb3V0Ii5lcXVhbHMoZmlsZU5hbWUpKSB7CiAg\nICAgICAgICAgIGZsYWdzLndyaXRlciA9IG5ldyBQcmludFdyaXRlcihTeXN0\nZW0ub3V0KTsKICAgICAgICAgICAgZmlsZU5hbWUgPSBudWxsOwogICAgICAg\nIH0gZWxzZSBpZiAoInN0ZGVyciIuZXF1YWxzKGZpbGVOYW1lKSkgewogICAg\nICAgICAgICBmbGFncy53cml0ZXIgPSBuZXcgUHJpbnRXcml0ZXIoU3lzdGVt\nLmVycik7CiAgICAgICAgICAgIGZpbGVOYW1lID0gbnVsbDsKICAgICAgICB9\nCgogICAgICAgIENvbmZpZ3VyYXRpb25zLnBvcHVsYXRlQ29uZmlndXJhdGlv\nbihjb25mLCBvcHRzKTsKICAgICAgICBDbGFzc0xvYWRlciBsb2FkZXIgPSBj\nb25mLmdldENsYXNzUmVzb2x2ZXJJbnN0YW5jZSgpLgogICAgICAgICAgICBn\nZXRDbGFzc0xvYWRlcihNZXRhRGF0YVRvb2wuY2xhc3MsIG51bGwpOwoKICAg\nICAgICBpZiAoZmlsZU5hbWUgIT0gbnVsbCkKICAgICAgICAgICAgZmxhZ3Mu\nZmlsZSA9IEZpbGVzLmdldEZpbGUoZmlsZU5hbWUsIGxvYWRlcik7CiAgICAg\nICAgcmV0dXJuIHJ1bihjb25mLCBhcmdzLCBmbGFncywgbnVsbCwgbG9hZGVy\nKTsKICAgIH0KCiAgICAvKioKICAgICAqIFJ1biB0aGUgdG9vbC4gUmV0dXJu\nIGZhbHNlIGlmIGludmFsaWQgb3B0aW9ucyB3ZXJlIGdpdmVuLiBUaGUgZ2l2\nZW4KICAgICAqIHJlcG9zaXRvcnkgbWF5IGJlIG51bGwuCiAgICAgKi8KICAg\nIHB1YmxpYyBzdGF0aWMgYm9vbGVhbiBydW4oT3BlbkpQQUNvbmZpZ3VyYXRp\nb24gY29uZiwgU3RyaW5nW10gYXJncywKICAgICAgICBGbGFncyBmbGFncywg\nTWV0YURhdGFSZXBvc2l0b3J5IHJlcG9zLCBDbGFzc0xvYWRlciBsb2FkZXIp\nCiAgICAgICAgdGhyb3dzIElPRXhjZXB0aW9uIHsKICAgICAgICBpZiAoYXJn\ncy5sZW5ndGggPT0gMCkKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAg\nICAgIGlmIChmbGFncy5hY3Rpb24gPT0gbnVsbCkKICAgICAgICAgICAgZmxh\nZ3MuYWN0aW9uID0gQUNUSU9OX0FERDsKCiAgICAgICAgTWV0YURhdGFUb29s\nIHRvb2wgPSBuZXcgTWV0YURhdGFUb29sKGNvbmYsIGZsYWdzLmFjdGlvbik7\nCiAgICAgICAgaWYgKHJlcG9zICE9IG51bGwpIHsKICAgICAgICAgICAgTWV0\nYURhdGFGYWN0b3J5IGZhY3RvcnkgPSByZXBvcy5nZXRNZXRhRGF0YUZhY3Rv\ncnkoKTsKICAgICAgICAgICAgZmFjdG9yeS5nZXREZWZhdWx0cygpLnNldEln\nbm9yZU5vblBlcnNpc3RlbnQoZmFsc2UpOwogICAgICAgICAgICBmYWN0b3J5\nLnNldFN0b3JlTW9kZShNZXRhRGF0YUZhY3RvcnkuU1RPUkVfVkVSQk9TRSk7\nCiAgICAgICAgICAgIHRvb2wuc2V0UmVwb3NpdG9yeShyZXBvcyk7CiAgICAg\nICAgfQogICAgICAgIGlmIChmbGFncy5maWxlICE9IG51bGwpCiAgICAgICAg\nICAgIHRvb2wuc2V0RmlsZShmbGFncy5maWxlKTsKICAgICAgICBpZiAoZmxh\nZ3Mud3JpdGVyICE9IG51bGwpCiAgICAgICAgICAgIHRvb2wuc2V0V3JpdGVy\nKGZsYWdzLndyaXRlcik7CgogICAgICAgIExvZyBsb2cgPSBjb25mLmdldExv\nZyhPcGVuSlBBQ29uZmlndXJhdGlvbi5MT0dfVE9PTCk7CiAgICAgICAgQ2xh\nc3NBcmdQYXJzZXIgY2FwID0gY29uZi5nZXRNZXRhRGF0YVJlcG9zaXRvcnlJ\nbnN0YW5jZSgpLgogICAgICAgICAgICBnZXRNZXRhRGF0YUZhY3RvcnkoKS5u\nZXdDbGFzc0FyZ1BhcnNlcigpOwogICAgICAgIGNhcC5zZXRDbGFzc0xvYWRl\ncihsb2FkZXIpOwogICAgICAgIENsYXNzW10gY2xhc3NlczsKICAgICAgICBm\nb3IgKGludCBpID0gMDsgaSA8IGFyZ3MubGVuZ3RoOyBpKyspIHsKICAgICAg\nICAgICAgY2xhc3NlcyA9IGNhcC5wYXJzZVR5cGVzKGFyZ3NbaV0pOwogICAg\nICAgICAgICBmb3IgKGludCBqID0gMDsgaiA8IGNsYXNzZXMubGVuZ3RoOyBq\nKyspIHsKICAgICAgICAgICAgICAgIGxvZy5pbmZvKF9sb2MuZ2V0KCJ0b29s\nLXJ1bm5pbmciLCBjbGFzc2VzW2pdLCBmbGFncy5hY3Rpb24pKTsKICAgICAg\nICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgdG9vbC5ydW4o\nY2xhc3Nlc1tqXSk7CiAgICAgICAgICAgICAgICB9IGNhdGNoIChJbGxlZ2Fs\nQXJndW1lbnRFeGNlcHRpb24gaWFlKSB7CiAgICAgICAgICAgICAgICAgICAg\ncmV0dXJuIGZhbHNlOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9\nCiAgICAgICAgfQoKICAgICAgICBsb2cuaW5mbyhfbG9jLmdldCgidG9vbC1y\nZWNvcmQiKSk7CiAgICAgICAgdG9vbC5yZWNvcmQoKTsKICAgICAgICByZXR1\ncm4gdHJ1ZTsKICAgIH0KCiAgICAvKioKICAgICAqIFJ1biBmbGFncy4KICAg\nICAqLwogICAgcHVibGljIHN0YXRpYyBjbGFzcyBGbGFncyB7CgogICAgICAg\nIHB1YmxpYyBTdHJpbmcgYWN0aW9uID0gQUNUSU9OX0FERDsKICAgICAgICBw\ndWJsaWMgRmlsZSBmaWxlID0gbnVsbDsKCQlwdWJsaWMgV3JpdGVyIHdyaXRl\nciA9IG51bGw7Cgl9Cn0K\n","encoding":"base64"}

