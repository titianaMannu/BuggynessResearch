{"sha":"2d6bfe5dcc6c48e857870ba27f56e65182bc0a70","node_id":"MDQ6QmxvYjIwNjM2NDoyZDZiZmU1ZGNjNmM0OGU4NTc4NzBiYTI3ZjU2ZTY1MTgyYmMwYTcw","size":9648,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/2d6bfe5dcc6c48e857870ba27f56e65182bc0a70","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbDsKCmltcG9ydCBqYXZh\nLmlvLk9iamVjdE91dHB1dFN0cmVhbTsKaW1wb3J0IGphdmEuaW8uT3V0cHV0\nU3RyZWFtOwppbXBvcnQgamF2YS5pby5QcmludFN0cmVhbTsKaW1wb3J0IGph\ndmEuaW8uUHJpbnRXcml0ZXI7CmltcG9ydCBqYXZhLmlvLlNlcmlhbGl6YWJs\nZTsKaW1wb3J0IGphdmEudXRpbC5Db2xsZWN0aW9uOwppbXBvcnQgamF2YS51\ndGlsLkl0ZXJhdG9yOwoKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5jb25m\nLk9wZW5KUEFWZXJzaW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmVu\naGFuY2UuUGVyc2lzdGVuY2VDYXBhYmxlOwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLmxpYi51dGlsLkoyRG9Qcml2SGVscGVyOwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLmxpYi51dGlsLkphdmFWZXJzaW9uczsKCi8qKgogKiBV\ndGlsaXR5IG1ldGhvZHMgZm9yIGV4dGVybmFsaXppbmcgYW5kIGhhbmRsaW5n\nIGV4Y2VwdGlvbnMuCiAqCiAqIEBhdXRob3IgTWFyYyBQcnVkJ2hvbW1lYXV4\nCiAqIEBzaW5jZSAwLjIuNQogKiBAbm9qYXZhZG9jCiAqLwpwdWJsaWMgY2xh\nc3MgRXhjZXB0aW9ucyB7CgogICAgcHVibGljIHN0YXRpYyBmaW5hbCBUaHJv\nd2FibGVbXSBFTVBUWV9USFJPV0FCTEVTID0gbmV3IFRocm93YWJsZVswXTsK\nCiAgICBzdGF0aWMgZmluYWwgU3RyaW5nIFNFUCA9IEoyRG9Qcml2SGVscGVy\nLmdldExpbmVTZXBhcmF0b3IoKTsKCiAgICBwcml2YXRlIHN0YXRpYyBmaW5h\nbCBPdXRwdXRTdHJlYW0gREVWX05VTEwgPSBuZXcgT3V0cHV0U3RyZWFtKCkg\newogICAgICAgIHB1YmxpYyB2b2lkIHdyaXRlKGludCBiKSB7CiAgICAgICAg\nfQogICAgfTsKCiAgICAvKioKICAgICAqIFRlc3QgdG8gc2VlIGlmIHRoZSBz\ncGVjaWZpZWQgb2JqZWN0IHdpbGwgYmUgYWJsZSB0byBiZSBzZXJpYWxpemVk\nLiBUaGlzCiAgICAgKiB3aWxsIGNoZWNrIGlmIHRoZSBvYmplY3QgaW1wbGVt\nZW50cyB7QGxpbmsgU2VyaWFsaXphYmxlfSwgYW5kIGlmIHNvLAogICAgICog\nd2lsbCB0cnkgdG8gcGVyZm9ybSBhbiBhY3R1YWwgc2VyaWFsaXphdGlvbi4g\nVGhpcyBpcyBpbiBjYXNlIHRoZSBvYmplY3QKICAgICAqIGhhcyBmaWVsZHMg\nd2hpY2gsIGluIHR1cm4sIGFyZSBub3Qgc2VyaWFsaXphYmxlLgogICAgICoK\nICAgICAqIEBwYXJhbSBvYiB0aGUgb2JqZWN0IHRvIHRlc3QKICAgICAqIEBy\nZXR1cm4gdHJ1ZSBpZiB0aGUgb2JqZWN0IHdpbGwgYmUgYWJsZSB0byBiZSBz\nZXJpYWxpemVkCiAgICAgKi8KICAgIHByaXZhdGUgc3RhdGljIGJvb2xlYW4g\naXNTZXJpYWxpemFibGUoT2JqZWN0IG9iKSB7CiAgICAgICAgaWYgKCEob2Ig\naW5zdGFuY2VvZiBTZXJpYWxpemFibGUpKQogICAgICAgICAgICByZXR1cm4g\nZmFsc2U7CgogICAgICAgIC8vIGRvbid0IHNlcmlhbGl6ZSBwZXJzaXN0ZW50\nIG9iamVjdHMgZXhjZXB0aW9ucyB0byBwcmV2ZW50CiAgICAgICAgLy8gcmVh\nZGluZyBpbiBhbGwgdGhlIHN0YXRlCiAgICAgICAgaWYgKCFJbXBsSGVscGVy\nLmlzTWFuYWdlZFR5cGUobnVsbCwgb2IuZ2V0Q2xhc3MoKSkpCiAgICAgICAg\nICAgIHJldHVybiBmYWxzZTsKCiAgICAgICAgLy8gbm93IGRvIGFuIGFjdHVh\nbCB0ZXN0IHRvIHNlZSBpZiB3ZSB3aWxsIGJlCiAgICAgICAgLy8gYWJsZSB0\nbyBwZXJmb3JtIHRoZSBzZXJpYWxpemF0aW9uCiAgICAgICAgdHJ5IHsKICAg\nICAgICAgICAgbmV3IE9iamVjdE91dHB1dFN0cmVhbShERVZfTlVMTCkud3Jp\ndGVPYmplY3Qob2IpOwogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAg\nICB9IGNhdGNoIChUaHJvd2FibGUgdCkgewogICAgICAgICAgICByZXR1cm4g\nZmFsc2U7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogU2FmZWx5\nIHN0cmluZ2lmeSB0aGUgZ2l2ZW4gb2JqZWN0LgogICAgICovCiAgICBwdWJs\naWMgc3RhdGljIFN0cmluZyB0b1N0cmluZyhPYmplY3Qgb2IpIHsKICAgICAg\nICBpZiAob2IgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuICJudWxsIjsK\nCiAgICAgICAgLy8gZG9uJ3QgdGFrZSBvaWQgb2YgbmV3IG9iamVjdHMgc2lu\nY2UgaXQgY2FuIGNhdXNlIGEgZmx1c2ggaWYgYXV0by1pbmMKICAgICAgICAv\nLyBhbmQgdGhlIGlkIGlzIG1lYW5pbmdsZXNzIGFueXdheQogICAgICAgIE9i\namVjdCBvaWQgPSBnZXRPYmplY3RJZChvYik7CgogICAgICAgIGlmIChvaWQg\nIT0gbnVsbCkgewogICAgICAgICAgICBpZiAob2lkIGluc3RhbmNlb2YgSWQp\nCiAgICAgICAgICAgICAgICByZXR1cm4gb2lkLnRvU3RyaW5nKCk7CiAgICAg\nICAgICAgIHJldHVybiBvYi5nZXRDbGFzcygpLmdldE5hbWUoKSArICItIiAr\nIG9pZC50b1N0cmluZygpOwogICAgICAgIH0KCiAgICAgICAgaWYgKEltcGxI\nZWxwZXIuaXNNYW5hZ2VkVHlwZShudWxsLCBvYi5nZXRDbGFzcygpKSkgewog\nICAgICAgICAgICAvLyBuZXZlciBjYWxsIHRvU3RyaW5nKCkgb24gYSBQZXJz\naXN0ZW5jZUNhcGFibGUsIHNpbmNlCiAgICAgICAgICAgIC8vIGl0IG1heSBh\nY2Nlc3MgcGVyc2lzdGVudCBmaWVsZHM7IGZhbGwtYmFjayB0byB1c2luZwog\nICAgICAgICAgICAvLyB0aGUgc3RhbmRhcmQgb2JqZWN0IHN0cmluZ2lmaWNh\ndGlvbiBtZWNoYW5pc20uIE5ldwogICAgICAgICAgICAvLyBpbnN0YW5jZXMg\ndGhhdCB1c2UgcHJveHlpbmcgKHByb3BlcnR5LWFjY2VzcyBpbnN0YW5jZXMs\nCiAgICAgICAgICAgIC8vIGZvciBleGFtcGxlKSB0aGF0IHdlcmUgY3JlYXRl\nZCB3aXRoIHRoZSAnbmV3JyBrZXl3b3JkCiAgICAgICAgICAgIC8vIHdpbGwg\nbm90IGVuZCB1cCBpbiB0aGlzIGNvZGUsIHdoaWNoIGlzIG9rIHNpbmNlIHRo\nZXkKICAgICAgICAgICAgLy8gZG9uJ3QgZG8gbGF6eSBsb2FkaW5nIGFueXdh\neXMsIHNvIHRoZXkgd2lsbCBzdHJpbmdpZnkKICAgICAgICAgICAgLy8gc2Fm\nZWx5LgogICAgICAgICAgICByZXR1cm4gb2IuZ2V0Q2xhc3MoKS5nZXROYW1l\nKCkgKyAiQCIKICAgICAgICAgICAgICAgICsgSW50ZWdlci50b0hleFN0cmlu\nZyhTeXN0ZW0uaWRlbnRpdHlIYXNoQ29kZShvYikpOwogICAgICAgIH0KCiAg\nICAgICAgdHJ5IHsKICAgICAgICAgICAgU3RyaW5nIHMgPSBvYi50b1N0cmlu\nZygpOwogICAgICAgICAgICBpZiAocy5pbmRleE9mKG9iLmdldENsYXNzKCku\nZ2V0TmFtZSgpKSA9PSAtMSkKICAgICAgICAgICAgICAgIHMgKz0gIiBbIiAr\nIG9iLmdldENsYXNzKCkuZ2V0TmFtZSgpICsgIl0iOwogICAgICAgICAgICBy\nZXR1cm4gczsKICAgICAgICB9IGNhdGNoIChUaHJvd2FibGUgdCkgewogICAg\nICAgICAgICByZXR1cm4gb2IuZ2V0Q2xhc3MoKS5nZXROYW1lKCk7CiAgICAg\nICAgfQogICAgfQoKICAgIC8qKgogICAgICogU2FmZWx5IHN0cmluZ2lmeSB0\naGUgZ2l2ZW4gb2JqZWN0cy4KICAgICAqLwogICAgcHVibGljIHN0YXRpYyBT\ndHJpbmcgdG9TdHJpbmcoQ29sbGVjdGlvbiBmYWlsZWQpIHsKICAgICAgICBT\ndHJpbmdCdWZmZXIgYnVmID0gbmV3IFN0cmluZ0J1ZmZlcigpOwogICAgICAg\nIGJ1Zi5hcHBlbmQoIlsiKTsKICAgICAgICBmb3IgKEl0ZXJhdG9yIGl0ciA9\nIGZhaWxlZC5pdGVyYXRvcigpOyBpdHIuaGFzTmV4dCgpOykgewogICAgICAg\nICAgICBidWYuYXBwZW5kKEV4Y2VwdGlvbnMudG9TdHJpbmcoaXRyLm5leHQo\nKSkpOwogICAgICAgICAgICBpZiAoaXRyLmhhc05leHQoKSkKICAgICAgICAg\nICAgICAgIGJ1Zi5hcHBlbmQoIiwgIik7CiAgICAgICAgfQogICAgICAgIGJ1\nZi5hcHBlbmQoIl0iKTsKICAgICAgICByZXR1cm4gYnVmLnRvU3RyaW5nKCk7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBTdHJpbmdpZnkgdGhlIGdpdmVuIGV4\nY2VwdGlvbi4KICAgICAqLwogICAgcHVibGljIHN0YXRpYyBTdHJpbmcgdG9T\ndHJpbmcoRXhjZXB0aW9uSW5mbyBlKSB7CiAgICAgICAgaW50IHR5cGUgPSBl\nLmdldFR5cGUoKTsKICAgICAgICBTdHJpbmdCdWZmZXIgYnVmID0gbmV3IFN0\ncmluZ0J1ZmZlcigpOwogICAgICAgIGJ1Zi5hcHBlbmQoIjwiKS4KICAgICAg\nICAgICAgYXBwZW5kKE9wZW5KUEFWZXJzaW9uLlZFUlNJT05fSUQpLgogICAg\nICAgICAgICBhcHBlbmQoJyAnKS4KICAgICAgICAgICAgYXBwZW5kKGUuaXNG\nYXRhbCgpID8gImZhdGFsICIgOiAibm9uZmF0YWwgIikuCiAgICAgICAgICAg\nIGFwcGVuZCAodHlwZSA9PSBFeGNlcHRpb25JbmZvLkdFTkVSQUwgPyAiZ2Vu\nZXJhbCBlcnJvciIgOgogICAgICAgICAgICAgICAgdHlwZSA9PSBFeGNlcHRp\nb25JbmZvLklOVEVSTkFMID8gImludGVybmFsIGVycm9yIiA6CiAgICAgICAg\nICAgICAgICB0eXBlID09IEV4Y2VwdGlvbkluZm8uU1RPUkUgPyAic3RvcmUg\nZXJyb3IiIDoKICAgICAgICAgICAgICAgIHR5cGUgPT0gRXhjZXB0aW9uSW5m\nby5VTlNVUFBPUlRFRCA/ICJ1bnN1cHBvcnRlZCBlcnJvciIgOgogICAgICAg\nICAgICAgICAgdHlwZSA9PSBFeGNlcHRpb25JbmZvLlVTRVIgPyAidXNlciBl\ncnJvciIgOgogICAgICAgICAgICAgICAgKHR5cGUgKyAiIGVycm9yIikpLgog\nICAgICAgICAgICBhcHBlbmQoIj4gIik7CiAgICAgICAgYnVmLmFwcGVuZChl\nLmdldENsYXNzKCkuZ2V0TmFtZSgpKS5hcHBlbmQoIjogIikuCiAgICAgICAg\nICAgIGFwcGVuZChlLmdldE1lc3NhZ2UoKSk7CiAgICAgICAgT2JqZWN0IGZh\naWxlZCA9IGUuZ2V0RmFpbGVkT2JqZWN0KCk7CiAgICAgICAgaWYgKGZhaWxl\nZCAhPSBudWxsKQogICAgICAgICAgICBidWYuYXBwZW5kKFNFUCkuYXBwZW5k\nKCJGYWlsZWRPYmplY3Q6ICIpLgogICAgICAgICAgICAgICAgYXBwZW5kKHRv\nU3RyaW5nKGZhaWxlZCkpOwogICAgICAgIHJldHVybiBidWYudG9TdHJpbmco\nKTsKICAgIH0KCiAgICAvKioKICAgICAqIFByaW50IHRoZSBzdGFjayB0cmFj\nZSBvZiB0aGUgZXhjZXB0aW9uJ3MgbmVzdGVkIHRocm93YWJsZXMuCiAgICAg\nKi8KICAgIHB1YmxpYyBzdGF0aWMgdm9pZCBwcmludE5lc3RlZFRocm93YWJs\nZXMoRXhjZXB0aW9uSW5mbyBlLCBQcmludFN0cmVhbSBvdXQpIHsKICAgICAg\nICAvLyBpZiB0aGlzIGlzIEphdmEgMS40IGFuZCB0aGVyZSBpcyBleGFjdGx5\nIGEgc2luZ2xlCiAgICAgICAgLy8gZXhjZXB0aW9uLCB0aGVuIGRlZmVyIHRv\nIDEuNCdzIGJlaGF2aW9yIG9mIHByaW50aW5nCiAgICAgICAgLy8gb3V0IHRo\nZSByZXN1bHQgb2YgZ2V0Q2F1c2UoKS4gVGhpcyBkZWZlcnJhbCBoYXBwZW5z\nIGluCiAgICAgICAgLy8gdGhlIGNhbGxpbmcgY29kZS4KICAgICAgICBUaHJv\nd2FibGVbXSBuZXN0ZWQgPSBlLmdldE5lc3RlZFRocm93YWJsZXMoKTsKICAg\nICAgICBpbnQgaSA9IChKYXZhVmVyc2lvbnMuVkVSU0lPTiA+PSA0KSA/IDEg\nOiAwOwogICAgICAgIGlmIChpIDwgbmVzdGVkLmxlbmd0aCkgewogICAgICAg\nICAgICBvdXQucHJpbnRsbigiTmVzdGVkVGhyb3dhYmxlczoiKTsKICAgICAg\nICAgICAgZm9yICg7IGkgPCBuZXN0ZWQubGVuZ3RoOyBpKyspCiAgICAgICAg\nICAgICAgICAvLyBndWFyZCBhZ2FpbnN0IGEgbmFzdHkgbnVsbCBpbiB0aGUg\nYXJyYXkKICAgICAgICAgICAgICAgIGlmIChuZXN0ZWRbaV0gIT0gbnVsbCkK\nICAgICAgICAgICAgICAgICAgICBuZXN0ZWRbaV0ucHJpbnRTdGFja1RyYWNl\nKG91dCk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogUHJpbnQg\ndGhlIHN0YWNrIHRyYWNlIG9mIHRoZSBleGNlcHRpb24ncyBuZXN0ZWQgdGhy\nb3dhYmxlcy4KICAgICAqLwogICAgcHVibGljIHN0YXRpYyB2b2lkIHByaW50\nTmVzdGVkVGhyb3dhYmxlcyhFeGNlcHRpb25JbmZvIGUsIFByaW50V3JpdGVy\nIG91dCkgewogICAgICAgIC8vIGlmIHRoaXMgaXMgSmF2YSAxLjQgYW5kIHRo\nZXJlIGlzIGV4YWN0bHkgYSBzaW5nbGUKICAgICAgICAvLyBleGNlcHRpb24s\nIHRoZW4gZGVmZXIgdG8gMS40J3MgYmVoYXZpb3Igb2YgcHJpbnRpbmcKICAg\nICAgICAvLyBvdXQgdGhlIHJlc3VsdCBvZiBnZXRDYXVzZSgpLiBUaGlzIGRl\nZmVycmFsIGhhcHBlbnMgaW4KICAgICAgICAvLyB0aGUgY2FsbGluZyBjb2Rl\nLgogICAgICAgIFRocm93YWJsZVtdIG5lc3RlZCA9IGUuZ2V0TmVzdGVkVGhy\nb3dhYmxlcygpOwogICAgICAgIGludCBpID0gKEphdmFWZXJzaW9ucy5WRVJT\nSU9OID49IDQpID8gMSA6IDA7CiAgICAgICAgaWYgKGkgPCBuZXN0ZWQubGVu\nZ3RoKSB7CiAgICAgICAgICAgIG91dC5wcmludGxuKCJOZXN0ZWRUaHJvd2Fi\nbGVzOiIpOwogICAgICAgICAgICBmb3IgKDsgaSA8IG5lc3RlZC5sZW5ndGg7\nIGkrKykKICAgICAgICAgICAgICAgIC8vIGd1YXJkIGFnYWluc3QgYSBuYXN0\neSBudWxsIGluIHRoZSBhcnJheQogICAgICAgICAgICAgICAgaWYgKG5lc3Rl\nZFtpXSAhPSBudWxsKQogICAgICAgICAgICAgICAgICAgIG5lc3RlZFtpXS5w\ncmludFN0YWNrVHJhY2Uob3V0KTsKICAgICAgICB9CiAgICB9CgogICAgLyoq\nCiAgICAgKiBDb252ZXJ0IHRoZSBzcGVjaWZpZWQgZmFpbGVkIG9iamVjdCBp\nbnRvIGEgc2VyaWFsaXphYmxlCiAgICAgKiBvYmplY3QgZm9yIHdoZW4gd2Ug\nYXJlIHNlcmlhbGl6aW5nIGFuIEV4Y2VwdGlvbi4gSXQgd2lsbAogICAgICog\ndHJ5IHRoZSBmb2xsb3dpbmc6CiAgICAgKiA8dWw+CiAgICAgKiA8bGk+aWYg\ndGhlIG9iamVjdCBjYW4gYmUgc2VyaWFsaXplZCwgcmV0dXJuIHRoZSBvYmpl\nY3QgaXRzZWxmPC9saT4KICAgICAqIDxsaT5pZiB0aGUgb2JqZWN0IGhhcyBh\nIHNlcmlhbGl6YWJsZSBvaWQsIHJldHVybiB0aGUgb2lkPC9saT4KICAgICAq\nIDxsaT5pZiB0aGUgb2JqZWN0IGhhcyBhIG5vbi1zZXJpYWxpemFibGUgb2lk\nLCByZXR1cm4gdGhlIG9pZCdzCiAgICAgKiB0b1N0cmluZyBhbmQgdGhlIG9i\namVjdCBjbGFzczwvbGk+CiAgICAgKiA8bGk+cmV0dXJuIHRoZSBvYmplY3Qn\ncyB0b1N0cmluZzwvbGk+CiAgICAgKiA8L3VsPgogICAgICoKICAgICAqIEBw\nYXJhbSBvYiB0aGUgb2JqZWN0IHRvIGNvbnZlcnQKICAgICAqIEByZXR1cm4g\nc29tZSBzZXJpYWxpemVkIHJlcHJlc2VudGF0aW9uIG9mIHRoZSBvYmplY3QK\nICAgICAqLwogICAgcHVibGljIHN0YXRpYyBPYmplY3QgcmVwbGFjZUZhaWxl\nZE9iamVjdChPYmplY3Qgb2IpIHsKICAgICAgICBpZiAob2IgPT0gbnVsbCkK\nICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgaWYgKGlzU2VyaWFs\naXphYmxlKG9iKSkKICAgICAgICAgICAgcmV0dXJuIG9iOwoKICAgICAgICAv\nLyBkb24ndCB0YWtlIG9pZCBvZiBuZXcgb2JqZWN0cyBzaW5jZSBpdCBjYW4g\nY2F1c2UgYSBmbHVzaCBpZiBhdXRvLWluYwogICAgICAgIC8vIGFuZCB0aGUg\naWQgaXMgbWVhbmluZ2xlc3MgYW55d2F5CiAgICAgICAgT2JqZWN0IG9pZCA9\nIGdldE9iamVjdElkKG9iKTsKICAgICAgICBpZiAob2lkICE9IG51bGwgJiYg\naXNTZXJpYWxpemFibGUob2lkKSkKICAgICAgICAgICAgcmV0dXJuIG9pZDsK\nCiAgICAgICAgLy8gbGFzdCBkaXRjaDogc3RyaW5naWZ5IHRoZSBvYmplY3QK\nICAgICAgICByZXR1cm4gdG9TdHJpbmcob2IpOwogICAgfQoKICAgIC8qKgog\nICAgICogQ29udmVydCB0aGUgc3BlY2lmaWVkIHRocm93YWJsZXMgaW50byBh\nIHNlcmlhbHphYmxlIGFycmF5LiBJZgogICAgICogYW55IG9mIHRoZSBuZXN0\nZWQgdGhyb3dhYmxlcyBjYW5ub3QgYmUgc2VyaWFsaXplZCwgdGhleSB3aWxs\nCiAgICAgKiBiZSBjb252ZXJ0ZWQgaW50byBhIEV4Y2VwdGlvbiB3aXRoIHRo\nZSBvcmlnaW5hbCBtZXNzYWdlLgogICAgICovCiAgICBwdWJsaWMgc3RhdGlj\nIFRocm93YWJsZVtdIHJlcGxhY2VOZXN0ZWRUaHJvd2FibGVzKFRocm93YWJs\nZVtdIG5lc3RlZCkgewogICAgICAgIGlmIChuZXN0ZWQgPT0gbnVsbCB8fCBu\nZXN0ZWQubGVuZ3RoID09IDApCiAgICAgICAgICAgIHJldHVybiBuZXN0ZWQ7\nCiAgICAgICAgaWYgKGlzU2VyaWFsaXphYmxlKG5lc3RlZCkpCiAgICAgICAg\nICAgIHJldHVybiBuZXN0ZWQ7CgogICAgICAgIFRocm93YWJsZVtdIG5ld05l\nc3RlZCA9IG5ldyBUaHJvd2FibGVbbmVzdGVkLmxlbmd0aF07CiAgICAgICAg\nZm9yIChpbnQgaSA9IDA7IGkgPCBuZXN0ZWQubGVuZ3RoOyBpKyspIHsKICAg\nICAgICAgICAgaWYgKGlzU2VyaWFsaXphYmxlKG5lc3RlZFtpXSkpCiAgICAg\nICAgICAgICAgICBuZXdOZXN0ZWRbaV0gPSBuZXN0ZWRbaV07CiAgICAgICAg\nICAgIGVsc2UKICAgICAgICAgICAgICAgIC8vIGd1YXJkIGFnYWluc3QgYSBu\nYXN0eSBudWxsIGluIHRoZSBhcnJheSBieSB1c2luZyB2YWx1ZU9mCiAgICAg\nICAgICAgICAgICAvLyBpbnN0ZWFkIG9mIHRvU3RyaW5nIHRvIHByZXZlbnQg\ndGhyb3dpbmcgeWV0IGFub3RoZXIgCiAgICAgICAgICAgICAgICAvLyBleGNl\ncHRpb24KICAgICAgICAgICAgICAgIG5ld05lc3RlZFtpXSA9IG5ldyBFeGNl\ncHRpb24oU3RyaW5nLnZhbHVlT2YobmVzdGVkW2ldKSk7CiAgICAgICAgfQog\nICAgICAgIHJldHVybiBuZXdOZXN0ZWQ7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBSZXR1cm4gdGhlIG9iamVjdCBpZCBmb3IgPGNvZGU+b2I8L2NvZGU+IGlm\nIGl0IGhhcyBvbmUsIG9yCiAgICAgKiA8Y29kZT5udWxsPC9jb2RlPiBvdGhl\ncndpc2UuCiAgICAgKi8KICAgIHByaXZhdGUgc3RhdGljIE9iamVjdCBnZXRP\nYmplY3RJZChPYmplY3Qgb2IpIHsKICAgICAgICBpZiAoIUltcGxIZWxwZXIu\naXNNYW5hZ2VhYmxlKG9iKSkKICAgICAgICAgICAgcmV0dXJuIG51bGw7Cgog\nICAgICAgIFBlcnNpc3RlbmNlQ2FwYWJsZSBwYyA9IEltcGxIZWxwZXIudG9Q\nZXJzaXN0ZW5jZUNhcGFibGUob2IsIG51bGwpOwogICAgICAgIGlmIChwYyA9\nPSBudWxsIHx8IHBjLnBjSXNOZXcoKSkKICAgICAgICAgICAgcmV0dXJuIG51\nbGw7CiAgICAgICAgZWxzZQogICAgICAgICAgICByZXR1cm4gcGMucGNGZXRj\naE9iamVjdElkKCk7Cgl9Cn0K\n","encoding":"base64"}

