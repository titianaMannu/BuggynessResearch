{"sha":"08c6c3cc7cb13f1a220be2176cc25026a2debef9","node_id":"MDQ6QmxvYjIwNjM2NDowOGM2YzNjYzdjYjEzZjFhMjIwYmUyMTc2Y2MyNTAyNmEyZGViZWY5","size":13261,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/08c6c3cc7cb13f1a220be2176cc25026a2debef9","content":"LyoNCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUNCiAqIG9yIG1vcmUgY29udHJpYnV0b3Ig\nbGljZW5zZSBhZ3JlZW1lbnRzLiAgU2VlIHRoZSBOT1RJQ0UgZmlsZQ0KICog\nZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5m\nb3JtYXRpb24NCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAg\nVGhlIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUNCiAqIHRvIHlvdSB1bmRlciB0\naGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUNCiAqICJMaWNl\nbnNlIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNv\nbXBsaWFuY2UNCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFp\nbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQNCiAqDQogKiBodHRwOi8vd3d3\nLmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjANCiAqDQogKiBVbmxl\nc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGlu\nIHdyaXRpbmcsDQogKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUg\nTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbg0KICogIkFTIElTIiBCQVNJ\nUywgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZDQog\nKiBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBM\naWNlbnNlIGZvciB0aGUNCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmlu\nZyBwZXJtaXNzaW9ucyBhbmQgbGltaXRhdGlvbnMNCiAqIHVuZGVyIHRoZSBM\naWNlbnNlLg0KICovDQpwYWNrYWdlIG9yZy5hcGFjaGUub3BlbmpwYS5saWIu\ndXRpbC5jb25jdXJyZW50Ow0KDQppbXBvcnQgamF2YS51dGlsLmNvbmN1cnJl\nbnQuQ29uY3VycmVudEhhc2hNYXA7DQppbXBvcnQgamF2YS51dGlsLkVudW1l\ncmF0aW9uOw0KaW1wb3J0IGphdmEudXRpbC5TZXQ7DQppbXBvcnQgamF2YS51\ndGlsLkNvbGxlY3Rpb247DQppbXBvcnQgamF2YS51dGlsLkFic3RyYWN0U2V0\nOw0KaW1wb3J0IGphdmEudXRpbC5JdGVyYXRvcjsNCmltcG9ydCBqYXZhLnV0\naWwuQWJzdHJhY3RDb2xsZWN0aW9uOw0KaW1wb3J0IGphdmEudXRpbC5SYW5k\nb207DQppbXBvcnQgamF2YS51dGlsLkhhc2hTZXQ7DQppbXBvcnQgamF2YS51\ndGlsLlRyZWVTZXQ7DQoNCmltcG9ydCBvcmcuYXBhY2hlLmNvbW1vbnMuY29s\nbGVjdGlvbnMuc2V0Lk1hcEJhY2tlZFNldDsNCg0KLyoqDQogKiBBIHN1YmNs\nYXNzIG9mIHtAbGluayBDb25jdXJyZW50SGFzaE1hcH0gdGhhdCBhbGxvd3Mg\nbnVsbCBrZXlzIGFuZCB2YWx1ZXMuDQogKiBJbiBleGNoYW5nZSwgaXQgd2Vh\na2VucyB0aGUgY29udHJhY3Qgb2Yge0BsaW5rICNwdXRJZkFic2VudH0gYW5k\nIHRoZSBvdGhlcg0KICogY29uY3VycmVudCBtZXRob2RzIGFkZGVkIGluIHtA\nbGluayAjQ29uY3VycmVudEhhc2hNYXB9Lg0KICoNCiAqIEBzaW5jZSAxLjEu\nMA0KICovDQpwdWJsaWMgY2xhc3MgTnVsbFNhZmVDb25jdXJyZW50SGFzaE1h\ncCBleHRlbmRzIENvbmN1cnJlbnRIYXNoTWFwIHsNCg0KICAgIHByaXZhdGUg\nZW51bSBNYXJrZXJzIHsNCiAgICAgICAgTlVMTCwNCiAgICAgICAgTUFQX0JB\nQ0tFRF9TRVRfRFVNTVlfVkFMDQogICAgfQ0KDQogICAgLy8gVGhlIHNlY29u\nZCBhcmd1bWVudCBpcyB1c2VkIHdpdGhpbiBNYXBCYWNrZWRTZXQgYXMgdGhl\nIHZhbHVlIGZvcg0KICAgIC8vIGFsbCB0aGUga2V5LXZhbCBwYWlycyB0aGF0\nIGFyZSBwdXQgaW50byB0aGUgdW5kZXJseWluZyBNYXAuIFRoaXMNCiAgICAv\nLyBpcyByZXF1aXJlZCBmb3Igb3VyIHVzYWdlIHNpbmNlIENvbmN1cnJlbnRI\nYXNoTWFwIGRvZXMgbm90IGFsbG93DQogICAgLy8gbnVsbCB2YWx1ZXMuDQog\nICAgcHJpdmF0ZSBTZXQgcmFuZG9tS2V5cyA9IE1hcEJhY2tlZFNldC5kZWNv\ncmF0ZSgNCiAgICAgICAgbmV3IENvbmN1cnJlbnRIYXNoTWFwKCksIE1hcmtl\ncnMuTUFQX0JBQ0tFRF9TRVRfRFVNTVlfVkFMKTsNCg0KICAgIHByaXZhdGUg\nUmFuZG9tIHJhbmRvbSA9IG5ldyBSYW5kb20oKTsNCg0KICAgIHB1YmxpYyBO\ndWxsU2FmZUNvbmN1cnJlbnRIYXNoTWFwKGludCBzaXplLCBmbG9hdCBsb2Fk\nLA0KICAgICAgICBpbnQgY29uY3VycmVuY3lMZXZlbCkgew0KICAgICAgICBz\ndXBlcihzaXplLCBsb2FkLCBjb25jdXJyZW5jeUxldmVsKTsNCiAgICB9DQoN\nCiAgICBwdWJsaWMgTnVsbFNhZmVDb25jdXJyZW50SGFzaE1hcCgpIHsNCiAg\nICB9DQoNCiAgICAvKioNCiAgICAgKiBSZXR1cm5zIGludGVybmFsIHJlcHJl\nc2VudGF0aW9uIGZvciBvYmplY3QuDQogICAgICovDQogICAgcHJpdmF0ZSBz\ndGF0aWMgT2JqZWN0IG1hc2tOdWxsKE9iamVjdCBvKSB7DQogICAgICAgIHJl\ndHVybiAobyA9PSBudWxsID8gTWFya2Vycy5OVUxMIDogbyk7DQogICAgfQ0K\nDQogICAgLyoqDQogICAgICogUmV0dXJucyBvYmplY3QgcmVwcmVzZW50ZWQg\nYnkgc3BlY2lmaWVkIGludGVybmFsIHJlcHJlc2VudGF0aW9uLg0KICAgICAq\nLw0KICAgIHByaXZhdGUgc3RhdGljIE9iamVjdCB1bm1hc2tOdWxsKE9iamVj\ndCBvKSB7DQogICAgICAgIHJldHVybiAobyA9PSBNYXJrZXJzLk5VTEwgPyBu\ndWxsIDogbyk7DQogICAgfQ0KDQogICAgcHVibGljIEVudHJ5IHJlbW92ZVJh\nbmRvbSgpIHsNCiAgICAgICAgLy8gdGhpcyBkb2Vzbid0IGp1c3QgdXNlIHJh\nbmRvbUVudHJ5SXRlcmF0b3IoKSBiZWNhdXNlIHRoYXQgaXRlcmF0b3INCiAg\nICAgICAgLy8gaGFzIHdlYWtlciBjb25jdXJyZW5jeSBndWFyYW50ZWVzIHRo\nYW4gdGhpcyBtZXRob2QuIEluIHBhcnRpY3VsYXIsDQogICAgICAgIC8vIHRo\naXMgbWV0aG9kIHdpbGwgY29udGludWUgdG8gYXR0ZW1wdCB0byByZW1vdmUg\ncmFuZG9tIGVudHJpZXMgZXZlbg0KICAgICAgICAvLyBhcyBvdGhlciB0aHJl\nYWRzIHJlbW92ZSB0aGUgc2FtZSBlbnRyaWVzLCB3aGVyZWFzIHRoZSByYW5k\nb20NCiAgICAgICAgLy8gaXRlcmF0b3IgbWF5IHJldHVybiB2YWx1ZXMgdGhh\ndCBoYXZlIGJlZW4gcmVtb3ZlZC4NCg0KICAgICAgICBmb3IgKEl0ZXJhdG9y\nIGl0ZXIgPSByYW5kb21LZXlzLml0ZXJhdG9yKCk7IGl0ZXIuaGFzTmV4dCgp\nOyApIHsNCiAgICAgICAgICAgIC8vIHJhbmRvbUtleXMgY29udGFpbnMgbnVs\nbC1tYXNrZWQgZGF0YQ0KICAgICAgICAgICAgT2JqZWN0IGtleSA9IGl0ZXIu\nbmV4dCgpOw0KICAgICAgICAgICAgaWYgKGtleSAhPSBudWxsICYmIHJhbmRv\nbUtleXMucmVtb3ZlKGtleSkpIHsNCiAgICAgICAgICAgICAgICBPYmplY3Qg\ndmFsID0gc3VwZXIucmVtb3ZlKGtleSk7DQogICAgICAgICAgICAgICAgaWYg\nKHZhbCAhPSBudWxsKQ0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3\nIEVudHJ5SW1wbCh1bm1hc2tOdWxsKGtleSksIHVubWFza051bGwodmFsKSk7\nDQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICAvLyBpZiBy\nYW5kb21LZXlzIGlzIGVtcHR5LCBmYWxsIGJhY2sgdG8gbm9uLXJhbmRvbSBi\nZWhhdmlvci4NCiAgICAgICAgZm9yIChJdGVyYXRvciBpdGVyID0gc3VwZXIu\na2V5U2V0KCkuaXRlcmF0b3IoKTsgaXRlci5oYXNOZXh0KCk7ICkgew0KICAg\nICAgICAgICAgT2JqZWN0IGtleSA9IGl0ZXIubmV4dCgpOw0KICAgICAgICAg\nICAgaWYgKGtleSA9PSBudWxsKQ0KICAgICAgICAgICAgICAgIGNvbnRpbnVl\nOw0KICAgICAgICAgICAgT2JqZWN0IHZhbCA9IHN1cGVyLnJlbW92ZShrZXkp\nOw0KICAgICAgICAgICAgaWYgKHZhbCAhPSBudWxsKQ0KICAgICAgICAgICAg\nICAgIHJldHVybiBuZXcgRW50cnlJbXBsKHVubWFza051bGwoa2V5KSwgdW5t\nYXNrTnVsbCh2YWwpKTsNCiAgICAgICAgfQ0KICAgICAgICByZXR1cm4gbnVs\nbDsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiBUaGUgcmV0dXJuZWQgZGF0\nYSBzdHJ1Y3R1cmUgc2hvdWxkIG5vdCBiZSBzaGFyZWQgYW1vbmcgbXVsdGlw\nbGUNCiAgICAgKiB0aHJlYWRzLg0KICAgICAqLw0KICAgIHB1YmxpYyBJdGVy\nYXRvcjxFbnRyeT4gcmFuZG9tRW50cnlJdGVyYXRvcigpIHsNCiAgICAgICAg\ncmV0dXJuIG5ldyBJdGVyYXRvcjxFbnRyeT4oKSB7DQoNCiAgICAgICAgICAg\nIEl0ZXJhdG9yIHJhbmRvbUl0ZXIgPSByYW5kb21LZXlzLml0ZXJhdG9yKCk7\nDQogICAgICAgICAgICBJdGVyYXRvciBub25SYW5kb21JdGVyID0gTnVsbFNh\nZmVDb25jdXJyZW50SGFzaE1hcC5zdXBlci5rZXlTZXQoKQ0KICAgICAgICAg\nICAgICAgIC5pdGVyYXRvcigpOw0KDQogICAgICAgICAgICBTZXQgcmV0dXJu\nZWQgPSBuZXcgSGFzaFNldCgpOw0KICAgICAgICAgICAgRW50cnkgbmV4dDsN\nCiAgICAgICAgICAgIGJvb2xlYW4gbmV4dFNldCA9IGZhbHNlOw0KDQogICAg\nICAgICAgICBwdWJsaWMgYm9vbGVhbiBoYXNOZXh0KCkgew0KICAgICAgICAg\nICAgICAgIC8vIHdlJ3ZlIHNldCB0aGUgbmV4dCB2YWx1ZSBhbmQgd2UgaGF2\nZW4ndCByZXR1cm5lZCBpdCB5ZXQNCiAgICAgICAgICAgICAgICBpZiAobmV4\ndFNldCkNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQoNCiAg\nICAgICAgICAgICAgICAvLyBjb21wdXRlIHRoZSBuZXh0IHZhbHVlLiBJZiB0\naGUgY29tcHV0YXRpb24gcmV0dXJucyBudWxsLA0KICAgICAgICAgICAgICAg\nIC8vIHJldHVybiBmYWxzZS4gRWxzZSwgc3RvcmUgdGhlIG5leHQgdmFsdWUg\nYW5kIHJldHVybiB0cnVlLg0KICAgICAgICAgICAgICAgIE9iamVjdCBuZXh0\nS2V5Ow0KICAgICAgICAgICAgICAgIE9iamVjdCBuZXh0VmFsdWU7DQogICAg\nICAgICAgICAgICAgaWYgKHJhbmRvbUl0ZXIuaGFzTmV4dCgpKSB7DQogICAg\nICAgICAgICAgICAgICAgIG5leHRLZXkgPSByYW5kb21JdGVyLm5leHQoKTsN\nCiAgICAgICAgICAgICAgICAgICAgbmV4dFZhbHVlID0gTnVsbFNhZmVDb25j\ndXJyZW50SGFzaE1hcC5zdXBlci5nZXQobmV4dEtleSk7DQogICAgICAgICAg\nICAgICAgICAgIGlmIChuZXh0VmFsdWUgIT0gbnVsbCkgew0KICAgICAgICAg\nICAgICAgICAgICAgICAgcmV0dXJuZWQuYWRkKG5leHRLZXkpOw0KICAgICAg\nICAgICAgICAgICAgICAgICAgbmV4dCA9IG5ldyBFbnRyeUltcGwodW5tYXNr\nTnVsbChuZXh0S2V5KSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1\nbm1hc2tOdWxsKG5leHRWYWx1ZSkpOw0KICAgICAgICAgICAgICAgICAgICAg\nICAgbmV4dFNldCA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICBy\nZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAg\nICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIHdoaWxlIChub25SYW5kb21J\ndGVyLmhhc05leHQoKSkgew0KICAgICAgICAgICAgICAgICAgICBuZXh0S2V5\nID0gbm9uUmFuZG9tSXRlci5uZXh0KCk7DQoNCiAgICAgICAgICAgICAgICAg\nICAgaWYgKHJldHVybmVkLmNvbnRhaW5zKG5leHRLZXkpKQ0KICAgICAgICAg\nICAgICAgICAgICAgICAgY29udGludWU7DQoNCiAgICAgICAgICAgICAgICAg\nICAgbmV4dFZhbHVlID0gTnVsbFNhZmVDb25jdXJyZW50SGFzaE1hcC5zdXBl\nci5nZXQobmV4dEtleSk7DQogICAgICAgICAgICAgICAgICAgIGlmIChuZXh0\nVmFsdWUgIT0gbnVsbCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0\ndXJuZWQuYWRkKG5leHRLZXkpOw0KICAgICAgICAgICAgICAgICAgICAgICAg\nbmV4dCA9IG5ldyBFbnRyeUltcGwodW5tYXNrTnVsbChuZXh0S2V5KSwNCiAg\nICAgICAgICAgICAgICAgICAgICAgICAgICB1bm1hc2tOdWxsKG5leHRWYWx1\nZSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgbmV4dFNldCA9IHRydWU7\nDQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAg\nICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAg\nICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICB9DQoNCiAgICAg\nICAgICAgIHB1YmxpYyBFbnRyeSBuZXh0KCkgew0KICAgICAgICAgICAgICAg\nIC8vIGhhc05leHQoKSB3aWxsIGluaXRpYWxpemUgdGhpcy5uZXh0DQogICAg\nICAgICAgICAgICAgaWYgKCFuZXh0U2V0ICYmICFoYXNOZXh0KCkpDQogICAg\nICAgICAgICAgICAgICAgIHJldHVybiBudWxsOw0KDQogICAgICAgICAgICAg\nICAgLy8gaWYgd2UgZ2V0IGhlcmUsIHRoZW4gd2UncmUgYWJvdXQgdG8gcmV0\ndXJuIGEgbmV4dCB2YWx1ZQ0KICAgICAgICAgICAgICAgIG5leHRTZXQgPSBm\nYWxzZTsNCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICBpZiAo\nY29udGFpbnNLZXkobmV4dC5nZXRLZXkoKSkpDQogICAgICAgICAgICAgICAg\nICAgIHJldHVybiBuZXh0Ow0KDQogICAgICAgICAgICAgICAgLy8gc29tZXRo\naW5nIGhhcyBjaGFuZ2VkIHNpbmNlIHRoZSBsYXN0IGl0ZXJhdGlvbiAocHJl\nc3VtYWJseQ0KICAgICAgICAgICAgICAgIC8vIGR1ZSB0byBtdWx0aS10aHJl\nYWRlZCBhY2Nlc3MgdG8gdGhlIHVuZGVybHlpbmcgZGF0YQ0KICAgICAgICAg\nICAgICAgIC8vIHN0cnVjdHVyZSk7IHJlY3Vyc2UNCiAgICAgICAgICAgICAg\nICByZXR1cm4gbmV4dCgpOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAg\nICBwdWJsaWMgdm9pZCByZW1vdmUoKSB7DQogICAgICAgICAgICAgICAgdGhy\nb3cgbmV3IFVuc3VwcG9ydGVkT3BlcmF0aW9uRXhjZXB0aW9uKCk7DQogICAg\nICAgICAgICB9DQogICAgICAgIH07DQogICAgfQ0KDQogICAgQE92ZXJyaWRl\nDQogICAgcHVibGljIE9iamVjdCByZW1vdmUoT2JqZWN0IGtleSkgew0KICAg\nICAgICBPYmplY3QgbWFza2VkS2V5ID0gbWFza051bGwoa2V5KTsNCiAgICAg\nICAgT2JqZWN0IHZhbCA9IHVubWFza051bGwoc3VwZXIucmVtb3ZlKG1hc2tl\nZEtleSkpOw0KICAgICAgICByYW5kb21LZXlzLnJlbW92ZShtYXNrZWRLZXkp\nOw0KICAgICAgICByZXR1cm4gdmFsOw0KICAgIH0NCg0KICAgIEBPdmVycmlk\nZQ0KICAgIHB1YmxpYyBib29sZWFuIHJlbW92ZShPYmplY3Qga2V5LCBPYmpl\nY3QgdmFsdWUpIHsNCiAgICAgICAgT2JqZWN0IG1hc2tlZEtleSA9IG1hc2tO\ndWxsKGtleSk7DQogICAgICAgIGJvb2xlYW4gdmFsID0gc3VwZXIucmVtb3Zl\nKG1hc2tlZEtleSwgbWFza051bGwodmFsdWUpKTsNCiAgICAgICAgcmFuZG9t\nS2V5cy5yZW1vdmUobWFza2VkS2V5KTsNCiAgICAgICAgcmV0dXJuIHZhbDsN\nCiAgICB9DQoNCiAgICBAT3ZlcnJpZGUNCiAgICBwdWJsaWMgYm9vbGVhbiBy\nZXBsYWNlKE9iamVjdCBrZXksIE9iamVjdCBvbGRWYWx1ZSwgT2JqZWN0IG5l\nd1ZhbHVlKSB7DQogICAgICAgIHJldHVybiBzdXBlci5yZXBsYWNlKG1hc2tO\ndWxsKGtleSksIG1hc2tOdWxsKG9sZFZhbHVlKSwNCiAgICAgICAgICAgIG1h\nc2tOdWxsKG5ld1ZhbHVlKSk7DQogICAgfQ0KDQogICAgQE92ZXJyaWRlDQog\nICAgcHVibGljIE9iamVjdCByZXBsYWNlKE9iamVjdCBrZXksIE9iamVjdCB2\nYWx1ZSkgew0KICAgICAgICByZXR1cm4gdW5tYXNrTnVsbChzdXBlci5yZXBs\nYWNlKG1hc2tOdWxsKGtleSksIG1hc2tOdWxsKHZhbHVlKSkpOw0KICAgIH0N\nCg0KICAgIEBPdmVycmlkZQ0KICAgIHB1YmxpYyBPYmplY3QgcHV0SWZBYnNl\nbnQoT2JqZWN0IGtleSwgT2JqZWN0IHZhbHVlKSB7DQogICAgICAgIE9iamVj\ndCBtYXNrZWRLZXkgPSBtYXNrTnVsbChrZXkpOw0KICAgICAgICBPYmplY3Qg\nc3VwZXJWYWwgPSBzdXBlci5wdXRJZkFic2VudChtYXNrZWRLZXksIG1hc2tO\ndWxsKHZhbHVlKSk7DQogICAgICAgIGFkZFJhbmRvbUtleShtYXNrZWRLZXkp\nOw0KICAgICAgICByZXR1cm4gdW5tYXNrTnVsbChzdXBlclZhbCk7DQogICAg\nfQ0KDQogICAgQE92ZXJyaWRlDQogICAgcHVibGljIE9iamVjdCBwdXQoT2Jq\nZWN0IGtleSwgT2JqZWN0IHZhbHVlKSB7DQogICAgICAgIE9iamVjdCBtYXNr\nZWRLZXkgPSBtYXNrTnVsbChrZXkpOw0KICAgICAgICBPYmplY3Qgc3VwZXJW\nYWwgPSBzdXBlci5wdXQobWFza2VkS2V5LCBtYXNrTnVsbCh2YWx1ZSkpOw0K\nICAgICAgICBhZGRSYW5kb21LZXkobWFza2VkS2V5KTsNCiAgICAgICAgcmV0\ndXJuIHVubWFza051bGwoc3VwZXJWYWwpOw0KICAgIH0NCg0KICAgIC8qKg0K\nICAgICAqIFBvdGVudGlhbGx5IGFkZHMgPGNvZGU+bWFza2VkS2V5PC9jY29k\nZT4gdG8gdGhlIHNldCBvZiByYW5kb20ga2V5cw0KICAgICAqIHRvIGJlIHJl\nbW92ZWQgYnkge0BsaW5rICNyZW1vdmVSYW5kb20oKX0uDQogICAgICoNCiAg\nICAgKiBAc2luY2UgMS4xLjANCiAgICAgKi8NCiAgICBwcml2YXRlIHZvaWQg\nYWRkUmFuZG9tS2V5KE9iamVjdCBtYXNrZWRLZXkpIHsNCiAgICAgICAgLy8g\nQWRkIG9uZSBpbiBldmVyeSB0aHJlZSBrZXlzIHRvIHRoZSBzZXQuIE9ubHkg\nZG8gdGhpcyB3aGVuDQogICAgICAgIC8vIHRoZXJlIGFyZSBsZXNzIHRoYW4g\nMTYgZWxlbWVudHMgaW4gdGhlIHJhbmRvbSBrZXkgc2V0OyB0aGlzDQogICAg\nICAgIC8vIG1lYW5zIHRoYXQgdGhlIGFsZ29yaXRobSB3aWxsIGJlIHBzZXVk\nby1yYW5kb20gZm9yIHVwIHRvDQogICAgICAgIC8vIDE2IHJlbW92ZXMgKGVp\ndGhlciB2aWEgcmVtb3ZlUmFuZG9tKCkgb3Igbm9ybWFsIHJlbW92ZSgpDQog\nICAgICAgIC8vIGNhbGxzKSB0aGF0IGhhdmUgbm8gaW50ZXJ2ZW5pbmcgcHV0\nKCkgY2FsbHMuDQogICAgICAgIGlmIChyYW5kb20gIT0gbnVsbCAmJiByYW5k\nb21LZXlzLnNpemUoKSA8IDE2ICYmIHJhbmRvbS5uZXh0SW50KDEwKSA8IDMp\nDQogICAgICAgICAgICByYW5kb21LZXlzLmFkZChtYXNrZWRLZXkpOw0KICAg\nIH0NCg0KICAgIEBPdmVycmlkZQ0KICAgIHB1YmxpYyBPYmplY3QgZ2V0KE9i\namVjdCBrZXkpIHsNCiAgICAgICAgcmV0dXJuIHVubWFza051bGwoc3VwZXIu\nZ2V0KG1hc2tOdWxsKGtleSkpKTsNCiAgICB9DQoNCiAgICBAT3ZlcnJpZGUN\nCiAgICBwdWJsaWMgYm9vbGVhbiBjb250YWluc0tleShPYmplY3Qga2V5KSB7\nDQogICAgICAgIHJldHVybiBzdXBlci5jb250YWluc0tleShtYXNrTnVsbChr\nZXkpKTsNCiAgICB9DQoNCiAgICBAT3ZlcnJpZGUNCiAgICBwdWJsaWMgYm9v\nbGVhbiBjb250YWluc1ZhbHVlKE9iamVjdCB2YWx1ZSkgew0KICAgICAgICBy\nZXR1cm4gc3VwZXIuY29udGFpbnNWYWx1ZShtYXNrTnVsbCh2YWx1ZSkpOw0K\nICAgIH0NCg0KICAgIEBPdmVycmlkZQ0KICAgIHB1YmxpYyBib29sZWFuIGNv\nbnRhaW5zKE9iamVjdCB2YWx1ZSkgew0KICAgICAgICB0aHJvdyBuZXcgVW5z\ndXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb24oKTsNCiAgICB9DQoNCiAgICBA\nT3ZlcnJpZGUNCiAgICBwdWJsaWMgRW51bWVyYXRpb24gZWxlbWVudHMoKSB7\nDQogICAgICAgIHRocm93IG5ldyBVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2Vw\ndGlvbigpOw0KICAgIH0NCg0KICAgIEBPdmVycmlkZQ0KICAgIHB1YmxpYyBT\nZXQgZW50cnlTZXQoKSB7DQogICAgICAgIHJldHVybiBuZXcgVHJhbnNsYXRp\nbmdTZXQoc3VwZXIuZW50cnlTZXQoKSkgew0KICAgICAgICAgICAgcHJvdGVj\ndGVkIE9iamVjdCB1bm1hc2soT2JqZWN0IGludGVybmFsKSB7DQogICAgICAg\nICAgICAgICAgZmluYWwgRW50cnkgZSA9IChFbnRyeSkgaW50ZXJuYWw7DQog\nICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBFbnRyeSgpIHsNCg0KICAgICAg\nICAgICAgICAgICAgICBwdWJsaWMgT2JqZWN0IGdldEtleSgpIHsNCiAgICAg\nICAgICAgICAgICAgICAgICAgIHJldHVybiB1bm1hc2tOdWxsKGUuZ2V0S2V5\nKCkpOw0KICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAg\nICAgICAgcHVibGljIE9iamVjdCBnZXRWYWx1ZSgpIHsNCiAgICAgICAgICAg\nICAgICAgICAgICAgIHJldHVybiB1bm1hc2tOdWxsKGUuZ2V0VmFsdWUoKSk7\nDQogICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAg\nICBwdWJsaWMgT2JqZWN0IHNldFZhbHVlKE9iamVjdCB2YWx1ZSkgew0KICAg\nICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHVubWFza051bGwoZS5zZXRW\nYWx1ZShtYXNrTnVsbCh2YWx1ZSkpKTsNCiAgICAgICAgICAgICAgICAgICAg\nfQ0KDQogICAgICAgICAgICAgICAgICAgIEBPdmVycmlkZQ0KICAgICAgICAg\nICAgICAgICAgICBwdWJsaWMgaW50IGhhc2hDb2RlKCkgew0KICAgICAgICAg\nICAgICAgICAgICAgICAgcmV0dXJuIGUuaGFzaENvZGUoKTsNCiAgICAgICAg\nICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH07DQogICAgICAgICAg\nICB9DQogICAgICAgIH07DQogICAgfQ0KDQogICAgQE92ZXJyaWRlDQogICAg\ncHVibGljIEVudW1lcmF0aW9uIGtleXMoKSB7DQogICAgICAgIHRocm93IG5l\ndyBVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbigpOw0KICAgIH0NCg0K\nICAgIEBPdmVycmlkZQ0KICAgIHB1YmxpYyBTZXQga2V5U2V0KCkgew0KICAg\nICAgICByZXR1cm4gbmV3IFRyYW5zbGF0aW5nU2V0KHN1cGVyLmtleVNldCgp\nKSB7DQogICAgICAgICAgICBwcm90ZWN0ZWQgT2JqZWN0IHVubWFzayhPYmpl\nY3QgaW50ZXJuYWwpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gdW5tYXNr\nTnVsbChpbnRlcm5hbCk7DQogICAgICAgICAgICB9DQogICAgICAgIH07DQog\nICAgfQ0KDQogICAgQE92ZXJyaWRlDQogICAgcHVibGljIENvbGxlY3Rpb24g\ndmFsdWVzKCkgew0KICAgICAgICByZXR1cm4gbmV3IFRyYW5zbGF0aW5nQ29s\nbGVjdGlvbihzdXBlci52YWx1ZXMoKSkgew0KDQogICAgICAgICAgICBwcm90\nZWN0ZWQgT2JqZWN0IHVubWFzayhPYmplY3QgaW50ZXJuYWwpIHsNCiAgICAg\nICAgICAgICAgICByZXR1cm4gdW5tYXNrTnVsbChpbnRlcm5hbCk7DQogICAg\nICAgICAgICB9DQogICAgICAgIH07DQogICAgfQ0KDQogICAgcHJpdmF0ZSBh\nYnN0cmFjdCBjbGFzcyBUcmFuc2xhdGluZ1NldCBleHRlbmRzIEFic3RyYWN0\nU2V0IHsNCg0KICAgICAgICBwcml2YXRlIFNldCBiYWNraW5nU2V0Ow0KDQog\nICAgICAgIHByaXZhdGUgVHJhbnNsYXRpbmdTZXQoU2V0IGJhY2tpbmcpIHsN\nCiAgICAgICAgICAgIHRoaXMuYmFja2luZ1NldCA9IGJhY2tpbmc7DQogICAg\nICAgIH0NCg0KICAgICAgICBwcm90ZWN0ZWQgYWJzdHJhY3QgT2JqZWN0IHVu\nbWFzayhPYmplY3QgaW50ZXJuYWwpOw0KDQogICAgICAgIHB1YmxpYyBJdGVy\nYXRvciBpdGVyYXRvcigpIHsNCiAgICAgICAgICAgIGZpbmFsIEl0ZXJhdG9y\nIGl0ZXJhdG9yID0gYmFja2luZ1NldC5pdGVyYXRvcigpOw0KICAgICAgICAg\nICAgcmV0dXJuIG5ldyBJdGVyYXRvcigpIHsNCiAgICAgICAgICAgICAgICBw\ndWJsaWMgYm9vbGVhbiBoYXNOZXh0KCkgew0KICAgICAgICAgICAgICAgICAg\nICByZXR1cm4gaXRlcmF0b3IuaGFzTmV4dCgpOw0KICAgICAgICAgICAgICAg\nIH0NCg0KICAgICAgICAgICAgICAgIHB1YmxpYyBPYmplY3QgbmV4dCgpIHsN\nCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHVubWFzayhpdGVyYXRvci5u\nZXh0KCkpOw0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAg\nIHB1YmxpYyB2b2lkIHJlbW92ZSgpIHsNCiAgICAgICAgICAgICAgICAgICAg\naXRlcmF0b3IucmVtb3ZlKCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAg\nICAgICAgfTsNCiAgICAgICAgfQ0KDQogICAgICAgIHB1YmxpYyBpbnQgc2l6\nZSgpIHsNCiAgICAgICAgICAgIHJldHVybiBiYWNraW5nU2V0LnNpemUoKTsN\nCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIHByaXZhdGUgYWJzdHJhY3QgY2xh\nc3MgVHJhbnNsYXRpbmdDb2xsZWN0aW9uIGV4dGVuZHMgQWJzdHJhY3RDb2xs\nZWN0aW9uIHsNCg0KICAgICAgICBwcml2YXRlIENvbGxlY3Rpb24gYmFja2lu\nZ0NvbGxlY3Rpb247DQoNCiAgICAgICAgcHJpdmF0ZSBUcmFuc2xhdGluZ0Nv\nbGxlY3Rpb24oQ29sbGVjdGlvbiBiYWNraW5nKSB7DQogICAgICAgICAgICB0\naGlzLmJhY2tpbmdDb2xsZWN0aW9uID0gYmFja2luZzsNCiAgICAgICAgfQ0K\nDQogICAgICAgIHByb3RlY3RlZCBhYnN0cmFjdCBPYmplY3QgdW5tYXNrKE9i\namVjdCBpbnRlcm5hbCk7DQoNCiAgICAgICAgcHVibGljIEl0ZXJhdG9yIGl0\nZXJhdG9yKCkgew0KICAgICAgICAgICAgZmluYWwgSXRlcmF0b3IgaXRlcmF0\nb3IgPSBiYWNraW5nQ29sbGVjdGlvbi5pdGVyYXRvcigpOw0KICAgICAgICAg\nICAgcmV0dXJuIG5ldyBJdGVyYXRvcigpIHsNCiAgICAgICAgICAgICAgICBw\ndWJsaWMgYm9vbGVhbiBoYXNOZXh0KCkgew0KICAgICAgICAgICAgICAgICAg\nICByZXR1cm4gaXRlcmF0b3IuaGFzTmV4dCgpOw0KICAgICAgICAgICAgICAg\nIH0NCg0KICAgICAgICAgICAgICAgIHB1YmxpYyBPYmplY3QgbmV4dCgpIHsN\nCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHVubWFzayhpdGVyYXRvci5u\nZXh0KCkpOw0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAg\nIHB1YmxpYyB2b2lkIHJlbW92ZSgpIHsNCiAgICAgICAgICAgICAgICAgICAg\naXRlcmF0b3IucmVtb3ZlKCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAg\nICAgICAgfTsNCiAgICAgICAgfQ0KDQogICAgICAgIHB1YmxpYyBpbnQgc2l6\nZSgpIHsNCiAgICAgICAgICAgIHJldHVybiBiYWNraW5nQ29sbGVjdGlvbi5z\naXplKCk7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICBwcml2YXRlIGNsYXNz\nIEVudHJ5SW1wbCBpbXBsZW1lbnRzIEVudHJ5IHsNCg0KICAgICAgICBmaW5h\nbCBPYmplY3Qga2V5Ow0KICAgICAgICBmaW5hbCBPYmplY3QgdmFsOw0KDQog\nICAgICAgIHByaXZhdGUgRW50cnlJbXBsKE9iamVjdCBrZXksIE9iamVjdCB2\nYWwpIHsNCiAgICAgICAgICAgIHRoaXMua2V5ID0ga2V5Ow0KICAgICAgICAg\nICAgdGhpcy52YWwgPSB2YWw7DQogICAgICAgIH0NCg0KICAgICAgICBwdWJs\naWMgT2JqZWN0IGdldEtleSgpIHsNCiAgICAgICAgICAgIHJldHVybiBrZXk7\nDQogICAgICAgIH0NCg0KICAgICAgICBwdWJsaWMgT2JqZWN0IGdldFZhbHVl\nKCkgew0KICAgICAgICAgICAgcmV0dXJuIHZhbDsNCiAgICAgICAgfQ0KDQog\nICAgICAgIHB1YmxpYyBPYmplY3Qgc2V0VmFsdWUoT2JqZWN0IHZhbHVlKSB7\nDQogICAgICAgICAgICB0aHJvdyBuZXcgVW5zdXBwb3J0ZWRPcGVyYXRpb25F\neGNlcHRpb24oKTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIHB1YmxpYyBp\nbnRlcmZhY2UgS2V5RmlsdGVyIHsNCg0KICAgICAgICAvKioNCiAgICAgICAg\nICogQHBhcmFtIGtleSBtYXkgYmUgbnVsbA0KICAgICAgICAgKiBAcmV0dXJu\nIHdoZXRoZXIgb3Igbm90IDxjb2RlPmtleTwvY29kZT4gc2h1b2xkIGJlIGV4\nY2x1ZGVkDQogICAgICAgICAqLw0KICAgICAgICBwdWJsaWMgYm9vbGVhbiBl\neGNsdWRlKE9iamVjdCBrZXkpOw0KICAgIH0NCn0NCg==\n","encoding":"base64"}

