{"sha":"f182e714e9b2d7a986248fd3c262dfe53eb8f040","node_id":"MDQ6QmxvYjIwNjM2NDpmMTgyZTcxNGU5YjJkN2E5ODYyNDhmZDNjMjYyZGZlNTNlYjhmMDQw","size":5263,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/f182e714e9b2d7a986248fd3c262dfe53eb8f040","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuY29uY3VycmVu\ndDsKCmltcG9ydCBqYXZhLnV0aWwuQXJyYXlMaXN0OwppbXBvcnQgamF2YS51\ndGlsLkNvbGxlY3Rpb25zOwppbXBvcnQgamF2YS51dGlsLkl0ZXJhdG9yOwpp\nbXBvcnQgamF2YS51dGlsLkxpc3Q7CmltcG9ydCBqYXZhLnV0aWwuTWFwOwpp\nbXBvcnQgamF2YS51dGlsLlNldDsKaW1wb3J0IGphdmEudXRpbC5UcmVlU2V0\nOwppbXBvcnQgamF2YS5pby5JT0V4Y2VwdGlvbjsKCmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEubGliLnV0aWwuUmVmZXJlbmNlTWFwOwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLmxpYi50ZXN0LkFic3RyYWN0VGVzdENhc2U7Cgov\nKioKICogVGVzdHMgdGhlIG1ldGhvZHMgb2Yge0BsaW5rIENvbmN1cnJlbnRN\nYXB9LgogKgogKiBAYXV0aG9yIEFiZSBXaGl0ZQogKi8KcHVibGljIGNsYXNz\nIFRlc3RDb25jdXJyZW50TWFwIGV4dGVuZHMgQWJzdHJhY3RUZXN0Q2FzZSB7\nCgogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgaW50IEVOVFJJRVMgPSAzMzM7\nCiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBpbnQgU0xFRVAgPSAzOwoKICAg\nIHByaXZhdGUgQ29uY3VycmVudE1hcFtdIF9tYXBzID0gbmV3IENvbmN1cnJl\nbnRNYXBbXXsKICAgICAgICBuZXcgU2l6ZWRDb25jdXJyZW50SGFzaE1hcChF\nTlRSSUVTLCAuNzVmLCAxNiksIAogICAgICAgIG5ldyBDb25jdXJyZW50UmVm\nZXJlbmNlSGFzaE1hcChSZWZlcmVuY2VNYXAuSEFSRCwgUmVmZXJlbmNlTWFw\nLkhBUkQpLCB9OwoKICAgIHB1YmxpYyB2b2lkIHNldFVwKCkgdGhyb3dzIEV4\nY2VwdGlvbiB7CiAgICAgICAgc3VwZXIuc2V0VXAoKTsKICAgICAgICBmb3Ig\nKGludCBpID0gMDsgaSA8IEVOVFJJRVM7IGkrKykgewogICAgICAgICAgICBm\nb3IgKGludCBqID0gMDsgaiA8IF9tYXBzLmxlbmd0aDsgaisrKSB7CiAgICAg\nICAgICAgICAgICBpbnQga2V5ID0gaiAqIEVOVFJJRVMgKyBpOwogICAgICAg\nICAgICAgICAgX21hcHNbal0ucHV0KG5ldyBJbnRlZ2VyKGtleSksICJ2IiAr\nIGtleSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgZm9yIChp\nbnQgaSA9IDA7IGkgPCBfbWFwcy5sZW5ndGg7IGkrKykKICAgICAgICAgICAg\nYXNzZXJ0RXF1YWxzKEVOVFJJRVMsIF9tYXBzW2ldLnNpemUoKSk7CiAgICB9\nCgogICAgcHVibGljIHZvaWQgdGVzdFJlbW92ZVJhbmRvbSgpIHsKICAgICAg\nICBTZXQga2V5cyA9IG5ldyBUcmVlU2V0KCk7CiAgICAgICAgZm9yIChpbnQg\naSA9IDA7IGkgPCBFTlRSSUVTOyBpKyspCiAgICAgICAgICAgIGZvciAoaW50\nIGogPSAwOyBqIDwgX21hcHMubGVuZ3RoOyBqKyspCiAgICAgICAgICAgICAg\nICBhc3NlcnRUcnVlKHJlbW92ZVJhbmRvbShfbWFwc1tqXSwga2V5cykpOwog\nICAgICAgIHBvc3RSZW1vdmVUZXN0KGtleXMpOwogICAgfQoKICAgIHByaXZh\ndGUgc3RhdGljIGJvb2xlYW4gcmVtb3ZlUmFuZG9tKENvbmN1cnJlbnRNYXAg\nbWFwLCBTZXQga2V5cykgewogICAgICAgIE1hcC5FbnRyeSByZW0gPSBtYXAu\ncmVtb3ZlUmFuZG9tKCk7CiAgICAgICAgcmV0dXJuIHJlbSAhPSBudWxsICYm\nIHJlbS5nZXRWYWx1ZSgpLmVxdWFscygidiIgKyByZW0uZ2V0S2V5KCkpCiAg\nICAgICAgICAgICYmIGtleXMuYWRkKHJlbS5nZXRLZXkoKSk7CiAgICB9Cgog\nICAgcHJpdmF0ZSB2b2lkIHBvc3RSZW1vdmVUZXN0KFNldCBrZXlzKSB7CiAg\nICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBfbWFwcy5sZW5ndGg7IGkrKykg\newogICAgICAgICAgICBhc3NlcnRUcnVlKF9tYXBzW2ldLmlzRW1wdHkoKSk7\nCiAgICAgICAgICAgIGFzc2VydFRydWUoIV9tYXBzW2ldLmNvbnRhaW5zS2V5\nKG5ldyBJbnRlZ2VyKEVOVFJJRVMgKiBpICsgaSkpKTsKICAgICAgICB9CiAg\nICAgICAgYXNzZXJ0RXF1YWxzKGtleXMudG9TdHJpbmcoKSwgRU5UUklFUyAq\nIF9tYXBzLmxlbmd0aCwga2V5cy5zaXplKCkpOwogICAgfQoKICAgIHB1Ymxp\nYyBzeW5jaHJvbml6ZWQgdm9pZCB0ZXN0UmVtb3ZlUmFuZG9tVGhyZWFkZWQo\nKQogICAgICAgIHRocm93cyBJbnRlcnJ1cHRlZEV4Y2VwdGlvbiB7CiAgICAg\nICAgU2V0IGtleXMgPSBDb2xsZWN0aW9ucy5zeW5jaHJvbml6ZWRTZXQobmV3\nIFRyZWVTZXQoKSk7CiAgICAgICAgUmVtb3ZlUmFuZG9tUnVubmFibGVbXSBy\ndW5zID0KICAgICAgICAgICAgbmV3IFJlbW92ZVJhbmRvbVJ1bm5hYmxlW0VO\nVFJJRVMgKiBfbWFwcy5sZW5ndGhdOwogICAgICAgIGZvciAoaW50IGkgPSAw\nOyBpIDwgRU5UUklFUzsgaSsrKQogICAgICAgICAgICBmb3IgKGludCBqID0g\nMDsgaiA8IF9tYXBzLmxlbmd0aDsgaisrKQogICAgICAgICAgICAgICAgcnVu\nc1tqICogRU5UUklFUyArIGldID0gbmV3IFJlbW92ZVJhbmRvbVJ1bm5hYmxl\nCiAgICAgICAgICAgICAgICAgICAgKF9tYXBzW2pdLCBrZXlzKTsKICAgICAg\nICBmb3IgKGludCBpID0gMDsgaSA8IHJ1bnMubGVuZ3RoOyBpKyspCiAgICAg\nICAgICAgIG5ldyBUaHJlYWQocnVuc1tpXSkuc3RhcnQoKTsKICAgICAgICBU\naHJlYWQuY3VycmVudFRocmVhZCgpLnNsZWVwKFNMRUVQICogRU5UUklFUyAq\nIF9tYXBzLmxlbmd0aCk7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBy\ndW5zLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGFzc2VydFRydWUoU3Ry\naW5nLnZhbHVlT2YoaSksICFydW5zW2ldLmVycm9yKTsKICAgICAgICAgICAg\naWYgKHJ1bnNbaV0uaW50ZXJydXB0ZWQpCiAgICAgICAgICAgICAgICB0aHJv\ndyBuZXcgSW50ZXJydXB0ZWRFeGNlcHRpb24oU3RyaW5nLnZhbHVlT2YoaSkp\nOwogICAgICAgIH0KICAgICAgICBwb3N0UmVtb3ZlVGVzdChrZXlzKTsKICAg\nIH0KCiAgICBwdWJsaWMgdm9pZCB0ZXN0SXRlcmF0ZSgpIHsKICAgICAgICBp\ndGVyYXRpb25UZXN0KGZhbHNlKTsKICAgIH0KCiAgICBwcml2YXRlIExpc3Qg\naXRlcmF0aW9uVGVzdChib29sZWFuIHJhbmRvbSkgewogICAgICAgIFNldCBr\nZXlzID0gbmV3IFRyZWVTZXQoKTsKICAgICAgICBMaXN0IG9yZGVyZWQgPSBu\nZXcgQXJyYXlMaXN0KDIwMCk7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkg\nPCBfbWFwcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBJdGVyYXRvciBp\ndHIgPSAocmFuZG9tKSA/IF9tYXBzW2ldLnJhbmRvbUVudHJ5SXRlcmF0b3Io\nKQogICAgICAgICAgICAgICAgOiBfbWFwc1tpXS5lbnRyeVNldCgpLml0ZXJh\ndG9yKCk7CiAgICAgICAgICAgIHdoaWxlIChpdHIuaGFzTmV4dCgpKSB7CiAg\nICAgICAgICAgICAgICBNYXAuRW50cnkgZW50cnkgPSAoTWFwLkVudHJ5KSBp\ndHIubmV4dCgpOwogICAgICAgICAgICAgICAgYXNzZXJ0RXF1YWxzKCJ2IiAr\nIGVudHJ5LmdldEtleSgpLCBlbnRyeS5nZXRWYWx1ZSgpKTsKICAgICAgICAg\nICAgICAgIGFzc2VydFRydWUoa2V5cyArICI6OiAiICsgX21hcHNbaV0uZ2V0\nQ2xhc3MoKSArICI6OiIKICAgICAgICAgICAgICAgICAgICArIGVudHJ5Lmdl\ndEtleSgpICsgIjo6IiArIGVudHJ5LmdldFZhbHVlKCksCiAgICAgICAgICAg\nICAgICAgICAga2V5cy5hZGQoZW50cnkuZ2V0S2V5KCkpKTsKICAgICAgICAg\nICAgICAgIG9yZGVyZWQuYWRkKGVudHJ5LmdldEtleSgpKTsKICAgICAgICAg\nICAgfQogICAgICAgIH0KICAgICAgICBhc3NlcnRFcXVhbHMoa2V5cy50b1N0\ncmluZygpLCBFTlRSSUVTICogX21hcHMubGVuZ3RoLCBrZXlzLnNpemUoKSk7\nCiAgICAgICAgcmV0dXJuIG9yZGVyZWQ7CiAgICB9CgogICAgcHVibGljIHZv\naWQgdGVzdFJhbmRvbUl0ZXJhdGUoKSB7CiAgICAgICAgaXRlcmF0aW9uVGVz\ndCh0cnVlKTsKICAgIH0KCiAgICBwcml2YXRlIHN0YXRpYyBjbGFzcyBSZW1v\ndmVSYW5kb21SdW5uYWJsZSBpbXBsZW1lbnRzIFJ1bm5hYmxlIHsKCiAgICAg\nICAgcHVibGljIGJvb2xlYW4gZXJyb3IgPSBmYWxzZTsKICAgICAgICBwdWJs\naWMgYm9vbGVhbiBpbnRlcnJ1cHRlZCA9IGZhbHNlOwoKICAgICAgICBwcml2\nYXRlIGZpbmFsIENvbmN1cnJlbnRNYXAgX21hcDsKICAgICAgICBwcml2YXRl\nIGZpbmFsIFNldCBfa2V5czsKCiAgICAgICAgcHVibGljIFJlbW92ZVJhbmRv\nbVJ1bm5hYmxlKENvbmN1cnJlbnRNYXAgbWFwLCBTZXQga2V5cykgewogICAg\nICAgICAgICBfbWFwID0gbWFwOwogICAgICAgICAgICBfa2V5cyA9IGtleXM7\nCiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgc3luY2hyb25pemVkIHZvaWQg\ncnVuKCkgewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgVGhy\nZWFkLmN1cnJlbnRUaHJlYWQoKS5zbGVlcCgobG9uZykgKE1hdGgucmFuZG9t\nKCkgKiBTTEVFUCkpOwogICAgICAgICAgICB9IGNhdGNoIChJbnRlcnJ1cHRl\nZEV4Y2VwdGlvbiBpZSkgewogICAgICAgICAgICAgICAgaW50ZXJydXB0ZWQg\nPSB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVycm9yID0gIXJl\nbW92ZVJhbmRvbShfbWFwLCBfa2V5cyk7CiAgICAgICAgfQogICAgfQp9Cg==\n","encoding":"base64"}

