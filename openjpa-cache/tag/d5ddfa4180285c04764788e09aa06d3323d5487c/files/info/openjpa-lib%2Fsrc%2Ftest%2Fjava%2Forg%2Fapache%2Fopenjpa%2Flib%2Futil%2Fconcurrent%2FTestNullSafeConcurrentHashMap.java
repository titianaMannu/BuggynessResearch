{"sha":"74857be9be44fe56e21f4cf559e8858646f7aa40","node_id":"MDQ6QmxvYjIwNjM2NDo3NDg1N2JlOWJlNDRmZTU2ZTIxZjRjZjU1OWU4ODU4NjQ2ZjdhYTQw","size":6178,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/74857be9be44fe56e21f4cf559e8858646f7aa40","content":"LyoNCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUNCiAqIG9yIG1vcmUgY29udHJpYnV0b3Ig\nbGljZW5zZSBhZ3JlZW1lbnRzLiAgU2VlIHRoZSBOT1RJQ0UgZmlsZQ0KICog\nZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5m\nb3JtYXRpb24NCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAg\nVGhlIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUNCiAqIHRvIHlvdSB1bmRlciB0\naGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUNCiAqICJMaWNl\nbnNlIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNv\nbXBsaWFuY2UNCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFp\nbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQNCiAqDQogKiBodHRwOi8vd3d3\nLmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjANCiAqDQogKiBVbmxl\nc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGlu\nIHdyaXRpbmcsDQogKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUg\nTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbg0KICogIkFTIElTIiBCQVNJ\nUywgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZDQog\nKiBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBM\naWNlbnNlIGZvciB0aGUNCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmlu\nZyBwZXJtaXNzaW9ucyBhbmQgbGltaXRhdGlvbnMNCiAqIHVuZGVyIHRoZSBM\naWNlbnNlLg0KICovDQpwYWNrYWdlIG9yZy5hcGFjaGUub3BlbmpwYS5saWIu\ndXRpbC5jb25jdXJyZW50Ow0KDQppbXBvcnQgamF2YS5pby5JT0V4Y2VwdGlv\nbjsNCmltcG9ydCBqYXZhLnV0aWwuU2V0Ow0KaW1wb3J0IGphdmEudXRpbC5D\nb2xsZWN0aW9uOw0KaW1wb3J0IGphdmEudXRpbC5NYXA7DQppbXBvcnQgamF2\nYS51dGlsLkhhc2hNYXA7DQppbXBvcnQgamF2YS51dGlsLk1hcC5FbnRyeTsN\nCg0KaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIudGVzdC5BYnN0cmFj\ndFRlc3RDYXNlOw0KDQpwdWJsaWMgY2xhc3MgVGVzdE51bGxTYWZlQ29uY3Vy\ncmVudEhhc2hNYXAgZXh0ZW5kcyBBYnN0cmFjdFRlc3RDYXNlIHsNCg0KICAg\nIHByaXZhdGUgTnVsbFNhZmVDb25jdXJyZW50SGFzaE1hcCBuZXdNYXAoKSB7\nDQogICAgICAgIHJldHVybiBuZXcgTnVsbFNhZmVDb25jdXJyZW50SGFzaE1h\ncCgpOw0KICAgIH0NCg0KICAgIHB1YmxpYyB2b2lkIHRlc3RSZW1vdmVSYW5k\nb21Jc05vdFRvdGFsbHlEZXRlcm1pbmlzdGljKCkgew0KICAgICAgICByZW1v\ndmVIZWxwZXIoZmFsc2UpOw0KICAgIH0NCg0KICAgIHB1YmxpYyB2b2lkIHRl\nc3RSYW5kb21JdGVyYXRvcklzTm90VG90YWxseURldGVybWluaXN0aWMoKSB7\nDQogICAgICAgIHJlbW92ZUhlbHBlcih0cnVlKTsNCiAgICB9DQoNCiAgICBw\ncml2YXRlIHZvaWQgcmVtb3ZlSGVscGVyKGJvb2xlYW4gaXRlcikgew0KICAg\nICAgICBNYXA8U3RyaW5nLEludGVnZXI+IHJlbW92ZWRDb3VudHMgPSBuZXcg\nSGFzaE1hcCgpOw0KICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IDEwMDA7\nIGkrKykgew0KICAgICAgICAgICAgTnVsbFNhZmVDb25jdXJyZW50SGFzaE1h\ncCBtID0gbmV3IE51bGxTYWZlQ29uY3VycmVudEhhc2hNYXAoKTsNCiAgICAg\nICAgICAgIG0ucHV0KCJhIiwgIkEiKTsNCiAgICAgICAgICAgIG0ucHV0KCJi\nIiwgIkIiKTsNCiAgICAgICAgICAgIG0ucHV0KCJjIiwgIkMiKTsNCiAgICAg\nICAgICAgIG0ucHV0KCJkIiwgIkQiKTsNCiAgICAgICAgICAgIG0ucHV0KCJl\nIiwgIkUiKTsNCiAgICAgICAgICAgIG0ucHV0KCJmIiwgIkYiKTsNCiAgICAg\nICAgICAgIG0ucHV0KCJnIiwgIkciKTsNCg0KICAgICAgICAgICAgU3RyaW5n\nIHJlbW92ZWQ7DQogICAgICAgICAgICBpZiAoaXRlcikgew0KICAgICAgICAg\nICAgICAgIHJlbW92ZWQgPSAoU3RyaW5nKSBtLnJlbW92ZVJhbmRvbSgpLmdl\ndEtleSgpOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAg\nICByZW1vdmVkID0gKFN0cmluZykgKChFbnRyeSkgbS5yYW5kb21FbnRyeUl0\nZXJhdG9yKCkubmV4dCgpKQ0KICAgICAgICAgICAgICAgICAgICAuZ2V0S2V5\nKCk7DQogICAgICAgICAgICAgICAgbS5yZW1vdmUocmVtb3ZlZCk7DQogICAg\nICAgICAgICB9DQoNCiAgICAgICAgICAgIEludGVnZXIgY291bnQgPSByZW1v\ndmVkQ291bnRzLmdldChyZW1vdmVkKTsNCiAgICAgICAgICAgIGlmIChjb3Vu\ndCA9PSBudWxsKQ0KICAgICAgICAgICAgICAgIHJlbW92ZWRDb3VudHMucHV0\nKHJlbW92ZWQsIDEpOw0KICAgICAgICAgICAgZWxzZQ0KICAgICAgICAgICAg\nICAgIHJlbW92ZWRDb3VudHMucHV0KHJlbW92ZWQsIGNvdW50LmludFZhbHVl\nKCkgKyAxKTsNCiAgICAgICAgfQ0KDQogICAgICAgIC8vIGFzc3VtZSB0aGF0\nIG92ZXIgMTAwMCBydW5zLCBldmVyeSBlbGVtZW50IHNob3VsZCBiZSByZW1v\ndmVkIGF0DQogICAgICAgIC8vIGxlYXN0IG9uY2UsIGFuZCBubyBlbGVtZW50\nIHNob3VsZCBiZSByZW1vdmVkIG1vcmUgdGhhbiAzMCUgb2YNCiAgICAgICAg\nLy8gdGhlIHRpbWUNCiAgICAgICAgYXNzZXJ0RXF1YWxzKDcsIHJlbW92ZWRD\nb3VudHMuc2l6ZSgpKTsNCiAgICAgICAgZm9yIChFbnRyeTxTdHJpbmcsSW50\nZWdlcj4gZW50cnkgOiByZW1vdmVkQ291bnRzLmVudHJ5U2V0KCkpIHsNCiAg\nICAgICAgICAgIGlmIChlbnRyeS5nZXRWYWx1ZSgpID09IDApDQogICAgICAg\nICAgICAgICAgZmFpbCgiZWxlbWVudCAiICsgZW50cnkuZ2V0S2V5KCkgKyAi\nIHdhcyBuZXZlciByZW1vdmVkIik7DQogICAgICAgICAgICBpZiAoZW50cnku\nZ2V0VmFsdWUoKSA+IDUwMCkNCiAgICAgICAgICAgICAgICBmYWlsKCJlbGVt\nZW50ICIgKyBlbnRyeS5nZXRLZXkoKSArICIgd2FzIHJlbW92ZWQgIg0KICAg\nICAgICAgICAgICAgICAgICArIGVudHJ5LmdldFZhbHVlKCkgKyAiIHRpbWVz\nOyB0aGlzIGlzIGdyZWF0ZXIgdGhhbiB0aGUgIg0KICAgICAgICAgICAgICAg\nICAgICArICJ0aHJlc2hvbGQgb2YgNTAwLiIpOw0KICAgICAgICB9DQogICAg\nfQ0KDQogICAgcHVibGljIHZvaWQgdGVzdE51bGxLZXlzKCkgdGhyb3dzIENs\nYXNzTm90Rm91bmRFeGNlcHRpb24sIElPRXhjZXB0aW9uIHsNCiAgICAgICAg\naGVscGVyKG51bGwsICJ2YWx1ZSAwIiwgInZhbHVlIDEiLCAidmFsdWUgMiIp\nOw0KICAgIH0NCg0KICAgIHByaXZhdGUgdm9pZCBoZWxwZXIoT2JqZWN0IGtl\neSwgT2JqZWN0IHZhbHVlMCwNCiAgICAgICAgT2JqZWN0IHZhbHVlMSwgT2Jq\nZWN0IHZhbHVlMikNCiAgICAgICAgdGhyb3dzIElPRXhjZXB0aW9uLCBDbGFz\nc05vdEZvdW5kRXhjZXB0aW9uIHsNCg0KICAgICAgICBOdWxsU2FmZUNvbmN1\ncnJlbnRIYXNoTWFwIG0gPSBuZXdNYXAoKTsNCg0KICAgICAgICAvLyBpbml0\naWFsIHB1dA0KICAgICAgICBtLnB1dChrZXksIHZhbHVlMCk7DQoNCiAgICAg\nICAgLy8gZ2V0IGV0Yy4NCiAgICAgICAgYXNzZXJ0RXF1YWxzKHZhbHVlMCwg\nbS5nZXQoa2V5KSk7DQogICAgICAgIGFzc2VydFRydWUobS5jb250YWluc0tl\neShrZXkpKTsNCiAgICAgICAgYXNzZXJ0VHJ1ZShtLmNvbnRhaW5zVmFsdWUo\ndmFsdWUwKSk7DQoNCiAgICAgICAgLy8ga2V5U2V0DQogICAgICAgIFNldCBr\nZXlzID0gbS5rZXlTZXQoKTsNCiAgICAgICAgYXNzZXJ0VHJ1ZShrZXlzLmNv\nbnRhaW5zKGtleSkpOw0KICAgICAgICBhc3NlcnRFcXVhbHMoMSwga2V5cy5z\naXplKCkpOw0KICAgICAgICBhc3NlcnRFcXVhbHMoa2V5LCBrZXlzLml0ZXJh\ndG9yKCkubmV4dCgpKTsNCg0KICAgICAgICAvLyBlbnRyeVNldA0KICAgICAg\nICBTZXQgZW50cmllcyA9IG0uZW50cnlTZXQoKTsNCiAgICAgICAgRW50cnkg\nZSA9IChFbnRyeSkgZW50cmllcy5pdGVyYXRvcigpLm5leHQoKTsNCiAgICAg\nICAgYXNzZXJ0RXF1YWxzKGtleSwgZS5nZXRLZXkoKSk7DQogICAgICAgIGFz\nc2VydEVxdWFscyh2YWx1ZTAsIGUuZ2V0VmFsdWUoKSk7DQoNCiAgICAgICAg\nLy8gdmFsdWVzDQogICAgICAgIENvbGxlY3Rpb24gdmFsdWVzID0gbS52YWx1\nZXMoKTsNCiAgICAgICAgYXNzZXJ0RXF1YWxzKDEsIHZhbHVlcy5zaXplKCkp\nOw0KICAgICAgICBhc3NlcnRFcXVhbHModmFsdWUwLCB2YWx1ZXMuaXRlcmF0\nb3IoKS5uZXh0KCkpOw0KDQogICAgICAgIC8vIHNlcmlhbGl6YWJpbGl0eQ0K\nICAgICAgICBhc3NlcnRFcXVhbHMobSwgcm91bmR0cmlwKG0sIHRydWUpKTsN\nCg0KICAgICAgICAvLyBwdXQNCiAgICAgICAgYXNzZXJ0RXF1YWxzKHZhbHVl\nMCwgbS5wdXQoa2V5LCB2YWx1ZTEpKTsNCg0KICAgICAgICAvLyByZW1vdmUN\nCiAgICAgICAgYXNzZXJ0RXF1YWxzKHZhbHVlMSwgbS5wdXQoa2V5LCB2YWx1\nZTEpKTsNCiAgICAgICAgYXNzZXJ0RXF1YWxzKHZhbHVlMSwgbS5yZW1vdmUo\na2V5KSk7DQogICAgICAgIG0ucHV0KGtleSwgdmFsdWUxKTsNCg0KICAgICAg\nICAvLyBDb25jdXJyZW50TWFwIHN0dWZmDQogICAgICAgIGFzc2VydEZhbHNl\nKG0ucmVtb3ZlKCJpbnZhbGlkIGtleSIsIHZhbHVlMCkpOw0KICAgICAgICBh\nc3NlcnRUcnVlKG0ucmVtb3ZlKGtleSwgdmFsdWUxKSk7DQogICAgICAgIGFz\nc2VydE51bGwobS5wdXRJZkFic2VudChrZXksIHZhbHVlMCkpOyAvLyBudWxs\nID09IHByZXYgdW5zZXQNCg0KICAgICAgICAvLyB2YWx1ZTAgbWlnaHQgYmUg\nbnVsbDsgY2FuJ3QgZGlzYW1iaWd1YXRlIGZyb20gYWJvdmUgaW4gT3BlbkpQ\nQQ0KICAgICAgICAvLyBpbnRlcnByZXRhdGlvbg0KICAgICAgICBhc3NlcnRF\ncXVhbHModmFsdWUwLCBtLnB1dElmQWJzZW50KGtleSwgImludmFsaWQgdmFs\ndWUiKSk7DQoNCiAgICAgICAgLy8gcmVwbGFjZQ0KICAgICAgICBhc3NlcnRF\ncXVhbHModmFsdWUwLCBtLnJlcGxhY2Uoa2V5LCB2YWx1ZTEpKTsNCiAgICAg\nICAgYXNzZXJ0VHJ1ZShtLnJlcGxhY2Uoa2V5LCB2YWx1ZTEsIHZhbHVlMikp\nOw0KDQogICAgICAgIC8vIHB1dEFsbC4gTm90ZSB0aGF0IENvbmN1cnJlbnRI\nYXNoTWFwIGhhcHBlbnMgdG8gZGVsZWdhdGUgdG8gcHV0KCkNCiAgICAgICAg\nLy8gZnJvbSB3aXRoaW4gcHV0QWxsKCkgY2FsbHMuIFRoaXMgdGVzdCBzaG91\nbGQgaGVscCBlbnN1cmUgdGhhdCB3ZQ0KICAgICAgICAvLyBmaW5kIG91dCBp\nZiB0aGF0IGNoYW5nZXMuDQogICAgICAgIG0gPSBuZXdNYXAoKTsNCiAgICAg\nICAgTWFwIHB1dEFsbEFyZyA9IG5ldyBIYXNoTWFwKCk7DQogICAgICAgIHB1\ndEFsbEFyZy5wdXQoa2V5LCB2YWx1ZTApOw0KICAgICAgICBwdXRBbGxBcmcu\ncHV0KCJhbm90aGVyIGtleSIsIHZhbHVlMSk7DQogICAgICAgIG0ucHV0QWxs\nKHB1dEFsbEFyZyk7DQogICAgICAgIGFzc2VydEVxdWFscyh2YWx1ZTAsIG0u\nZ2V0KGtleSkpOw0KICAgICAgICBhc3NlcnRFcXVhbHModmFsdWUxLCBtLmdl\ndCgiYW5vdGhlciBrZXkiKSk7DQogICAgfQ0KDQogICAgcHVibGljIHZvaWQg\ndGVzdE51bGxWYWx1ZXMoKSB0aHJvd3MgQ2xhc3NOb3RGb3VuZEV4Y2VwdGlv\nbiwgSU9FeGNlcHRpb24gew0KICAgICAgICBudWxsVmFsc0hlbHBlcigiZm9v\nIik7DQogICAgfQ0KDQogICAgcHJpdmF0ZSB2b2lkIG51bGxWYWxzSGVscGVy\nKE9iamVjdCBrZXkpDQogICAgICAgIHRocm93cyBJT0V4Y2VwdGlvbiwgQ2xh\nc3NOb3RGb3VuZEV4Y2VwdGlvbiB7DQogICAgICAgIGhlbHBlcihrZXksIG51\nbGwsIG51bGwsIG51bGwpOw0KICAgICAgICBoZWxwZXIoa2V5LCAiYmFyIiwg\nImJheiIsICJxdXV4Iik7DQoNCiAgICAgICAgaGVscGVyKGtleSwgImJhciIs\nICJiYXoiLCBudWxsKTsNCiAgICAgICAgaGVscGVyKGtleSwgbnVsbCwgImJh\neiIsICJxdXV4Iik7DQogICAgICAgIGhlbHBlcihrZXksICJiYXIiLCBudWxs\nLCAicXV1eCIpOw0KDQogICAgICAgIGhlbHBlcihrZXksICJiYXIiLCBudWxs\nLCBudWxsKTsNCiAgICAgICAgaGVscGVyKGtleSwgbnVsbCwgImJheiIsIG51\nbGwpOw0KICAgICAgICBoZWxwZXIoa2V5LCBudWxsLCBudWxsLCAicXV1eCIp\nOw0KICAgIH0NCg0KICAgIHB1YmxpYyB2b2lkIHRlc3ROdWxsS2V5c0FuZFZh\nbHVlcygpDQogICAgICAgIHRocm93cyBDbGFzc05vdEZvdW5kRXhjZXB0aW9u\nLCBJT0V4Y2VwdGlvbiB7DQogICAgICAgIG51bGxWYWxzSGVscGVyKG51bGwp\nOw0KICAgIH0NCn0NCg==\n","encoding":"base64"}

