{"sha":"b29248cd2e85c3ce1f2524a1b8685e0d547e9e3f","node_id":"MDQ6QmxvYjIwNjM2NDpiMjkyNDhjZDJlODVjM2NlMWYyNTI0YTFiODY4NWUwZDU0N2U5ZTNm","size":44414,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/b29248cd2e85c3ce1f2524a1b8685e0d547e9e3f","content":"LyoNCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUNCiAqIG9yIG1vcmUgY29udHJpYnV0b3Ig\nbGljZW5zZSBhZ3JlZW1lbnRzLiAgU2VlIHRoZSBOT1RJQ0UgZmlsZQ0KICog\nZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5m\nb3JtYXRpb24NCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAg\nVGhlIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUNCiAqIHRvIHlvdSB1bmRlciB0\naGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUNCiAqICJMaWNl\nbnNlIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNv\nbXBsaWFuY2UNCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFp\nbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQNCiAqDQogKiBodHRwOi8vd3d3\nLmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjANCiAqDQogKiBVbmxl\nc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGlu\nIHdyaXRpbmcsDQogKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUg\nTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbg0KICogIkFTIElTIiBCQVNJ\nUywgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZDQog\nKiBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBM\naWNlbnNlIGZvciB0aGUNCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmlu\nZyBwZXJtaXNzaW9ucyBhbmQgbGltaXRhdGlvbnMNCiAqIHVuZGVyIHRoZSBM\naWNlbnNlLiAgICANCiAqLw0KcGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEu\ncGVyc2lzdGVuY2U7DQoNCmltcG9ydCBqYXZhLmlvLkJ5dGVBcnJheUlucHV0\nU3RyZWFtOw0KaW1wb3J0IGphdmEuaW8uQnl0ZUFycmF5T3V0cHV0U3RyZWFt\nOw0KaW1wb3J0IGphdmEuaW8uRXh0ZXJuYWxpemFibGU7DQppbXBvcnQgamF2\nYS5pby5JT0V4Y2VwdGlvbjsNCmltcG9ydCBqYXZhLmlvLk9iamVjdElucHV0\nOw0KaW1wb3J0IGphdmEuaW8uT2JqZWN0SW5wdXRTdHJlYW07DQppbXBvcnQg\namF2YS5pby5PYmplY3RPdXRwdXQ7DQppbXBvcnQgamF2YS5pby5PYmplY3RP\ndXRwdXRTdHJlYW07DQppbXBvcnQgamF2YS5pby5PYmplY3RTdHJlYW1DbGFz\nczsNCmltcG9ydCBqYXZhLmxhbmcucmVmbGVjdC5BcnJheTsNCmltcG9ydCBq\nYXZhLnV0aWwuQXJyYXlzOw0KaW1wb3J0IGphdmEudXRpbC5Db2xsZWN0aW9u\nOw0KaW1wb3J0IGphdmEudXRpbC5FbnVtU2V0Ow0KaW1wb3J0IGphdmEudXRp\nbC5NYXA7DQppbXBvcnQgamF2YS51dGlsLkhhc2hNYXA7DQppbXBvcnQgamF2\nYS51dGlsLklkZW50aXR5SGFzaE1hcDsNCmltcG9ydCBqYXZheC5wZXJzaXN0\nZW5jZS5FbnRpdHlNYW5hZ2VyOw0KaW1wb3J0IGphdmF4LnBlcnNpc3RlbmNl\nLkZsdXNoTW9kZVR5cGU7DQppbXBvcnQgamF2YXgucGVyc2lzdGVuY2UuTG9j\na01vZGVUeXBlOw0KaW1wb3J0IGphdmF4LnBlcnNpc3RlbmNlLlF1ZXJ5Ow0K\nDQppbXBvcnQgb3JnLmFwYWNoZS5jb21tb25zLmxhbmcuU3RyaW5nVXRpbHM7\nDQppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmNvbmYuT3BlbkpQQUNvbmZp\nZ3VyYXRpb247DQppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmVlLk1hbmFn\nZWRSdW50aW1lOw0KaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5lbmhhbmNl\nLlBDRW5oYW5jZXI7DQppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmVuaGFu\nY2UuUENSZWdpc3RyeTsNCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEua2Vy\nbmVsLkFic3RyYWN0QnJva2VyRmFjdG9yeTsNCmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEua2VybmVsLkJyb2tlcjsNCmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEua2VybmVsLkRlbGVnYXRpbmdCcm9rZXI7DQppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLmtlcm5lbC5GaW5kQ2FsbGJhY2tzOw0KaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuTG9ja0xldmVsczsNCmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLk9wQ2FsbGJhY2tzOw0KaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuT3BlbkpQQVN0YXRlTWFuYWdl\ncjsNCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLlF1ZXJ5Rmx1\nc2hNb2RlczsNCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLlF1\nZXJ5TGFuZ3VhZ2VzOw0KaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJu\nZWwuU2VxOw0KaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuRmV0\nY2hDb25maWd1cmF0aW9uOw0KaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5r\nZXJuZWwuanBxbC5KUFFMUGFyc2VyOw0KaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5saWIudXRpbC5DbG9zZWFibGU7DQppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLmxpYi51dGlsLkxvY2FsaXplcjsNCmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEubWV0YS5DbGFzc01ldGFEYXRhOw0KaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5tZXRhLkZpZWxkTWV0YURhdGE7DQppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLm1ldGEuUXVlcnlNZXRhRGF0YTsNCmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEubWV0YS5TZXF1ZW5jZU1ldGFEYXRhOw0KaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLkV4Y2VwdGlvbnM7DQppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuSW1wbEhlbHBlcjsNCmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEudXRpbC5SdW50aW1lRXhjZXB0aW9uVHJhbnNs\nYXRvcjsNCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5Vc2VyRXhj\nZXB0aW9uOw0KDQovKioNCiAqIEltcGxlbWVudGF0aW9uIG9mIHtAbGluayBF\nbnRpdHlNYW5hZ2VyfSBpbnRlcmZhY2UuDQogKg0KICogQGF1dGhvciBQYXRy\naWNrIExpbnNrZXkNCiAqIEBhdXRob3IgQWJlIFdoaXRlDQogKiBAbm9qYXZh\nZG9jDQogKi8NCnB1YmxpYyBjbGFzcyBFbnRpdHlNYW5hZ2VySW1wbA0KICAg\nIGltcGxlbWVudHMgT3BlbkpQQUVudGl0eU1hbmFnZXJTUEksIEV4dGVybmFs\naXphYmxlLA0KICAgIEZpbmRDYWxsYmFja3MsIE9wQ2FsbGJhY2tzLCBDbG9z\nZWFibGUsIE9wZW5KUEFFbnRpdHlUcmFuc2FjdGlvbiB7DQoNCiAgICBwcml2\nYXRlIHN0YXRpYyBmaW5hbCBMb2NhbGl6ZXIgX2xvYyA9IExvY2FsaXplci5m\nb3JQYWNrYWdlDQogICAgICAgIChFbnRpdHlNYW5hZ2VySW1wbC5jbGFzcyk7\nDQogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgT2JqZWN0W10gRU1QVFlfT0JK\nRUNUUyA9IG5ldyBPYmplY3RbMF07DQoNCiAgICBwcml2YXRlIERlbGVnYXRp\nbmdCcm9rZXIgX2Jyb2tlcjsNCiAgICBwcml2YXRlIEVudGl0eU1hbmFnZXJG\nYWN0b3J5SW1wbCBfZW1mOw0KICAgIHByaXZhdGUgTWFwPEZldGNoQ29uZmln\ndXJhdGlvbixGZXRjaFBsYW4+IF9wbGFucyA9DQogICAgICAgIG5ldyBJZGVu\ndGl0eUhhc2hNYXA8RmV0Y2hDb25maWd1cmF0aW9uLEZldGNoUGxhbj4oMSk7\nDQoNCiAgICBwcml2YXRlIFJ1bnRpbWVFeGNlcHRpb25UcmFuc2xhdG9yIHJl\ndCA9DQogICAgICAgIFBlcnNpc3RlbmNlRXhjZXB0aW9ucy5nZXRSb2xsYmFj\na1RyYW5zbGF0b3IodGhpcyk7DQoNCiAgICBwdWJsaWMgRW50aXR5TWFuYWdl\nckltcGwoKSB7DQogICAgICAgIC8vIGZvciBFeHRlcm5hbGl6YWJsZQ0KICAg\nIH0NCg0KICAgIC8qKg0KICAgICAqIENvbnN0cnVjdG9yOyBzdXBwbHkgZmFj\ndG9yeSBhbmQgZGVsZWdhdGUuDQogICAgICovDQogICAgcHVibGljIEVudGl0\neU1hbmFnZXJJbXBsKEVudGl0eU1hbmFnZXJGYWN0b3J5SW1wbCBmYWN0b3J5\nLA0KICAgICAgICBCcm9rZXIgYnJva2VyKSB7DQogICAgICAgIGluaXRpYWxp\nemUoZmFjdG9yeSwgYnJva2VyKTsNCiAgICB9DQoNCiAgICBwcml2YXRlIHZv\naWQgaW5pdGlhbGl6ZShFbnRpdHlNYW5hZ2VyRmFjdG9yeUltcGwgZmFjdG9y\neSwgQnJva2VyIGJyb2tlcikgew0KICAgICAgICBfZW1mID0gZmFjdG9yeTsN\nCiAgICAgICAgX2Jyb2tlciA9IG5ldyBEZWxlZ2F0aW5nQnJva2VyKGJyb2tl\nciwgcmV0KTsNCiAgICAgICAgX2Jyb2tlci5zZXRJbXBsaWNpdEJlaGF2aW9y\nKHRoaXMsIHJldCk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICogQnJva2Vy\nIGRlbGVnYXRlLg0KICAgICAqLw0KICAgIHB1YmxpYyBCcm9rZXIgZ2V0QnJv\na2VyKCkgew0KICAgICAgICByZXR1cm4gX2Jyb2tlci5nZXREZWxlZ2F0ZSgp\nOw0KICAgIH0NCg0KICAgIHB1YmxpYyBPcGVuSlBBRW50aXR5TWFuYWdlckZh\nY3RvcnkgZ2V0RW50aXR5TWFuYWdlckZhY3RvcnkoKSB7DQogICAgICAgIHJl\ndHVybiBfZW1mOw0KICAgIH0NCg0KICAgIHB1YmxpYyBPcGVuSlBBQ29uZmln\ndXJhdGlvbiBnZXRDb25maWd1cmF0aW9uKCkgew0KICAgICAgICByZXR1cm4g\nX2Jyb2tlci5nZXRDb25maWd1cmF0aW9uKCk7DQogICAgfQ0KDQogICAgcHVi\nbGljIEZldGNoUGxhbiBnZXRGZXRjaFBsYW4oKSB7DQogICAgICAgIGFzc2Vy\ndE5vdENsb3NlSW52b2tlZCgpOw0KICAgICAgICBfYnJva2VyLmxvY2soKTsN\nCiAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgIEZldGNoQ29uZmlndXJhdGlv\nbiBmYyA9IF9icm9rZXIuZ2V0RmV0Y2hDb25maWd1cmF0aW9uKCk7DQogICAg\nICAgICAgICBGZXRjaFBsYW4gZnAgPSBfcGxhbnMuZ2V0KGZjKTsNCiAgICAg\nICAgICAgIGlmIChmcCA9PSBudWxsKSB7DQogICAgICAgICAgICAgICAgZnAg\nPSBfZW1mLnRvRmV0Y2hQbGFuKF9icm9rZXIsIGZjKTsNCiAgICAgICAgICAg\nICAgICBfcGxhbnMucHV0KGZjLCBmcCk7DQogICAgICAgICAgICB9DQogICAg\nICAgICAgICByZXR1cm4gZnA7DQogICAgICAgIH0gZmluYWxseSB7DQogICAg\nICAgICAgICBfYnJva2VyLnVubG9jaygpOw0KICAgICAgICB9DQogICAgfQ0K\nDQogICAgcHVibGljIEZldGNoUGxhbiBwdXNoRmV0Y2hQbGFuKCkgew0KICAg\nICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsNCiAgICAgICAgX2Jyb2tl\nci5sb2NrKCk7DQogICAgICAgIHRyeSB7DQogICAgICAgICAgICBfYnJva2Vy\nLnB1c2hGZXRjaENvbmZpZ3VyYXRpb24oKTsNCiAgICAgICAgICAgIHJldHVy\nbiBnZXRGZXRjaFBsYW4oKTsNCiAgICAgICAgfSBmaW5hbGx5IHsNCiAgICAg\nICAgICAgIF9icm9rZXIudW5sb2NrKCk7DQogICAgICAgIH0NCiAgICB9DQoN\nCiAgICBwdWJsaWMgdm9pZCBwb3BGZXRjaFBsYW4oKSB7DQogICAgICAgIGFz\nc2VydE5vdENsb3NlSW52b2tlZCgpOw0KICAgICAgICBfYnJva2VyLmxvY2so\nKTsNCiAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgIF9icm9rZXIucG9wRmV0\nY2hDb25maWd1cmF0aW9uKCk7DQogICAgICAgIH0gZmluYWxseSB7DQogICAg\nICAgICAgICBfYnJva2VyLnVubG9jaygpOw0KICAgICAgICB9DQogICAgfQ0K\nDQogICAgcHVibGljIENvbm5lY3Rpb25SZXRhaW5Nb2RlIGdldENvbm5lY3Rp\nb25SZXRhaW5Nb2RlKCkgew0KICAgICAgICByZXR1cm4gQ29ubmVjdGlvblJl\ndGFpbk1vZGUuZnJvbUtlcm5lbENvbnN0YW50KA0KICAgICAgICAgICAgX2Jy\nb2tlci5nZXRDb25uZWN0aW9uUmV0YWluTW9kZSgpKTsNCiAgICB9DQoNCiAg\nICBwdWJsaWMgYm9vbGVhbiBpc1RyYW5zYWN0aW9uTWFuYWdlZCgpIHsNCiAg\nICAgICAgcmV0dXJuIF9icm9rZXIuaXNNYW5hZ2VkKCk7DQogICAgfQ0KDQog\nICAgcHVibGljIGJvb2xlYW4gaXNNYW5hZ2VkKCkgew0KICAgICAgICByZXR1\ncm4gX2Jyb2tlci5pc01hbmFnZWQoKTsNCiAgICB9DQoNCiAgICBwdWJsaWMg\nTWFuYWdlZFJ1bnRpbWUgZ2V0TWFuYWdlZFJ1bnRpbWUoKSB7DQogICAgICAg\nIHJldHVybiBfYnJva2VyLmdldE1hbmFnZWRSdW50aW1lKCk7DQogICAgfQ0K\nDQogICAgcHVibGljIGJvb2xlYW4gZ2V0U3luY1dpdGhNYW5hZ2VkVHJhbnNh\nY3Rpb25zKCkgew0KICAgICAgICByZXR1cm4gX2Jyb2tlci5nZXRTeW5jV2l0\naE1hbmFnZWRUcmFuc2FjdGlvbnMoKTsNCiAgICB9DQoNCiAgICBwdWJsaWMg\ndm9pZCBzZXRTeW5jV2l0aE1hbmFnZWRUcmFuc2FjdGlvbnMoYm9vbGVhbiBz\neW5jKSB7DQogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOw0KICAg\nICAgICBfYnJva2VyLnNldFN5bmNXaXRoTWFuYWdlZFRyYW5zYWN0aW9ucyhz\neW5jKTsNCiAgICB9DQoNCiAgICBwdWJsaWMgQ2xhc3NMb2FkZXIgZ2V0Q2xh\nc3NMb2FkZXIoKSB7DQogICAgICAgIHJldHVybiBfYnJva2VyLmdldENsYXNz\nTG9hZGVyKCk7DQogICAgfQ0KDQogICAgcHVibGljIFN0cmluZyBnZXRDb25u\nZWN0aW9uVXNlck5hbWUoKSB7DQogICAgICAgIHJldHVybiBfYnJva2VyLmdl\ndENvbm5lY3Rpb25Vc2VyTmFtZSgpOw0KICAgIH0NCg0KICAgIHB1YmxpYyBT\ndHJpbmcgZ2V0Q29ubmVjdGlvblBhc3N3b3JkKCkgew0KICAgICAgICByZXR1\ncm4gX2Jyb2tlci5nZXRDb25uZWN0aW9uUGFzc3dvcmQoKTsNCiAgICB9DQoN\nCiAgICBwdWJsaWMgYm9vbGVhbiBnZXRNdWx0aXRocmVhZGVkKCkgew0KICAg\nICAgICByZXR1cm4gX2Jyb2tlci5nZXRNdWx0aXRocmVhZGVkKCk7DQogICAg\nfQ0KDQogICAgcHVibGljIHZvaWQgc2V0TXVsdGl0aHJlYWRlZChib29sZWFu\nIG11bHRpdGhyZWFkZWQpIHsNCiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZv\na2VkKCk7DQogICAgICAgIF9icm9rZXIuc2V0TXVsdGl0aHJlYWRlZChtdWx0\naXRocmVhZGVkKTsNCiAgICB9DQoNCiAgICBwdWJsaWMgYm9vbGVhbiBnZXRJ\nZ25vcmVDaGFuZ2VzKCkgew0KICAgICAgICByZXR1cm4gX2Jyb2tlci5nZXRJ\nZ25vcmVDaGFuZ2VzKCk7DQogICAgfQ0KDQogICAgcHVibGljIHZvaWQgc2V0\nSWdub3JlQ2hhbmdlcyhib29sZWFuIHZhbCkgew0KICAgICAgICBhc3NlcnRO\nb3RDbG9zZUludm9rZWQoKTsNCiAgICAgICAgX2Jyb2tlci5zZXRJZ25vcmVD\naGFuZ2VzKHZhbCk7DQogICAgfQ0KDQogICAgcHVibGljIGJvb2xlYW4gZ2V0\nTm9udHJhbnNhY3Rpb25hbFJlYWQoKSB7DQogICAgICAgIHJldHVybiBfYnJv\na2VyLmdldE5vbnRyYW5zYWN0aW9uYWxSZWFkKCk7DQogICAgfQ0KDQogICAg\ncHVibGljIHZvaWQgc2V0Tm9udHJhbnNhY3Rpb25hbFJlYWQoYm9vbGVhbiB2\nYWwpIHsNCiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7DQogICAg\nICAgIF9icm9rZXIuc2V0Tm9udHJhbnNhY3Rpb25hbFJlYWQodmFsKTsNCiAg\nICB9DQoNCiAgICBwdWJsaWMgYm9vbGVhbiBnZXROb250cmFuc2FjdGlvbmFs\nV3JpdGUoKSB7DQogICAgICAgIHJldHVybiBfYnJva2VyLmdldE5vbnRyYW5z\nYWN0aW9uYWxXcml0ZSgpOw0KICAgIH0NCg0KICAgIHB1YmxpYyB2b2lkIHNl\ndE5vbnRyYW5zYWN0aW9uYWxXcml0ZShib29sZWFuIHZhbCkgew0KICAgICAg\nICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsNCiAgICAgICAgX2Jyb2tlci5z\nZXROb250cmFuc2FjdGlvbmFsV3JpdGUodmFsKTsNCiAgICB9DQoNCiAgICBw\ndWJsaWMgYm9vbGVhbiBnZXRPcHRpbWlzdGljKCkgew0KICAgICAgICByZXR1\ncm4gX2Jyb2tlci5nZXRPcHRpbWlzdGljKCk7DQogICAgfQ0KDQogICAgcHVi\nbGljIHZvaWQgc2V0T3B0aW1pc3RpYyhib29sZWFuIHZhbCkgew0KICAgICAg\nICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsNCiAgICAgICAgX2Jyb2tlci5z\nZXRPcHRpbWlzdGljKHZhbCk7DQogICAgfQ0KDQogICAgcHVibGljIFJlc3Rv\ncmVTdGF0ZVR5cGUgZ2V0UmVzdG9yZVN0YXRlKCkgew0KICAgICAgICByZXR1\ncm4gUmVzdG9yZVN0YXRlVHlwZS5mcm9tS2VybmVsQ29uc3RhbnQoX2Jyb2tl\nci5nZXRSZXN0b3JlU3RhdGUoKSk7DQogICAgfQ0KDQogICAgcHVibGljIHZv\naWQgc2V0UmVzdG9yZVN0YXRlKFJlc3RvcmVTdGF0ZVR5cGUgdmFsKSB7DQog\nICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOw0KICAgICAgICBfYnJv\na2VyLnNldFJlc3RvcmVTdGF0ZSh2YWwudG9LZXJuZWxDb25zdGFudCgpKTsN\nCiAgICB9DQoNCiAgICBwdWJsaWMgdm9pZCBzZXRSZXN0b3JlU3RhdGUoaW50\nIHJlc3RvcmUpIHsNCiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7\nDQogICAgICAgIF9icm9rZXIuc2V0UmVzdG9yZVN0YXRlKHJlc3RvcmUpOw0K\nICAgIH0NCg0KICAgIHB1YmxpYyBib29sZWFuIGdldFJldGFpblN0YXRlKCkg\new0KICAgICAgICByZXR1cm4gX2Jyb2tlci5nZXRSZXRhaW5TdGF0ZSgpOw0K\nICAgIH0NCg0KICAgIHB1YmxpYyB2b2lkIHNldFJldGFpblN0YXRlKGJvb2xl\nYW4gdmFsKSB7DQogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOw0K\nICAgICAgICBfYnJva2VyLnNldFJldGFpblN0YXRlKHZhbCk7DQogICAgfQ0K\nDQogICAgcHVibGljIEF1dG9DbGVhclR5cGUgZ2V0QXV0b0NsZWFyKCkgew0K\nICAgICAgICByZXR1cm4gQXV0b0NsZWFyVHlwZS5mcm9tS2VybmVsQ29uc3Rh\nbnQoX2Jyb2tlci5nZXRBdXRvQ2xlYXIoKSk7DQogICAgfQ0KDQogICAgcHVi\nbGljIHZvaWQgc2V0QXV0b0NsZWFyKEF1dG9DbGVhclR5cGUgdmFsKSB7DQog\nICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOw0KICAgICAgICBfYnJv\na2VyLnNldEF1dG9DbGVhcih2YWwudG9LZXJuZWxDb25zdGFudCgpKTsNCiAg\nICB9DQoNCiAgICBwdWJsaWMgdm9pZCBzZXRBdXRvQ2xlYXIoaW50IGF1dG9D\nbGVhcikgew0KICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsNCiAg\nICAgICAgX2Jyb2tlci5zZXRBdXRvQ2xlYXIoYXV0b0NsZWFyKTsNCiAgICB9\nDQoNCiAgICBwdWJsaWMgRGV0YWNoU3RhdGVUeXBlIGdldERldGFjaFN0YXRl\nKCkgew0KICAgICAgICByZXR1cm4gRGV0YWNoU3RhdGVUeXBlLmZyb21LZXJu\nZWxDb25zdGFudChfYnJva2VyLmdldERldGFjaFN0YXRlKCkpOw0KICAgIH0N\nCg0KICAgIHB1YmxpYyB2b2lkIHNldERldGFjaFN0YXRlKERldGFjaFN0YXRl\nVHlwZSB0eXBlKSB7DQogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgp\nOw0KICAgICAgICBfYnJva2VyLnNldERldGFjaFN0YXRlKHR5cGUudG9LZXJu\nZWxDb25zdGFudCgpKTsNCiAgICB9DQoNCiAgICBwdWJsaWMgdm9pZCBzZXRE\nZXRhY2hTdGF0ZShpbnQgZGV0YWNoKSB7DQogICAgICAgIGFzc2VydE5vdENs\nb3NlSW52b2tlZCgpOw0KICAgICAgICBfYnJva2VyLnNldERldGFjaFN0YXRl\nKGRldGFjaCk7DQogICAgfQ0KDQogICAgcHVibGljIEVudW1TZXQ8QXV0b0Rl\ndGFjaFR5cGU+IGdldEF1dG9EZXRhY2goKSB7DQogICAgICAgIHJldHVybiBB\ndXRvRGV0YWNoVHlwZS50b0VudW1TZXQoX2Jyb2tlci5nZXRBdXRvRGV0YWNo\nKCkpOw0KICAgIH0NCg0KICAgIHB1YmxpYyB2b2lkIHNldEF1dG9EZXRhY2go\nQXV0b0RldGFjaFR5cGUgZmxhZykgew0KICAgICAgICBhc3NlcnROb3RDbG9z\nZUludm9rZWQoKTsNCiAgICAgICAgX2Jyb2tlci5zZXRBdXRvRGV0YWNoKEF1\ndG9EZXRhY2hUeXBlLmZyb21FbnVtU2V0KEVudW1TZXQub2YoZmxhZykpKTsN\nCiAgICB9DQoNCiAgICBwdWJsaWMgdm9pZCBzZXRBdXRvRGV0YWNoKEVudW1T\nZXQ8QXV0b0RldGFjaFR5cGU+IGZsYWdzKSB7DQogICAgICAgIGFzc2VydE5v\ndENsb3NlSW52b2tlZCgpOw0KICAgICAgICBfYnJva2VyLnNldEF1dG9EZXRh\nY2goQXV0b0RldGFjaFR5cGUuZnJvbUVudW1TZXQoZmxhZ3MpKTsNCiAgICB9\nDQoNCiAgICBwdWJsaWMgdm9pZCBzZXRBdXRvRGV0YWNoKGludCBhdXRvRGV0\nYWNoRmxhZ3MpIHsNCiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7\nDQogICAgICAgIF9icm9rZXIuc2V0QXV0b0RldGFjaChhdXRvRGV0YWNoRmxh\nZ3MpOw0KICAgIH0NCg0KICAgIHB1YmxpYyB2b2lkIHNldEF1dG9EZXRhY2go\nQXV0b0RldGFjaFR5cGUgdmFsdWUsIGJvb2xlYW4gb24pIHsNCiAgICAgICAg\nYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7DQogICAgICAgIF9icm9rZXIuc2V0\nQXV0b0RldGFjaChBdXRvRGV0YWNoVHlwZS5mcm9tRW51bVNldChFbnVtU2V0\nLm9mKHZhbHVlKSksb24pOw0KICAgIH0NCg0KICAgIHB1YmxpYyB2b2lkIHNl\ndEF1dG9EZXRhY2goaW50IGZsYWcsIGJvb2xlYW4gb24pIHsNCiAgICAgICAg\nYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7DQogICAgICAgIF9icm9rZXIuc2V0\nQXV0b0RldGFjaChmbGFnLCBvbik7DQogICAgfQ0KDQogICAgcHVibGljIGJv\nb2xlYW4gZ2V0RXZpY3RGcm9tU3RvcmVDYWNoZSgpIHsNCiAgICAgICAgcmV0\ndXJuIF9icm9rZXIuZ2V0RXZpY3RGcm9tRGF0YUNhY2hlKCk7DQogICAgfQ0K\nDQogICAgcHVibGljIHZvaWQgc2V0RXZpY3RGcm9tU3RvcmVDYWNoZShib29s\nZWFuIGV2aWN0KSB7DQogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgp\nOw0KICAgICAgICBfYnJva2VyLnNldEV2aWN0RnJvbURhdGFDYWNoZShldmlj\ndCk7DQogICAgfQ0KDQogICAgcHVibGljIGJvb2xlYW4gZ2V0UG9wdWxhdGVT\ndG9yZUNhY2hlKCkgew0KICAgICAgICByZXR1cm4gX2Jyb2tlci5nZXRQb3B1\nbGF0ZURhdGFDYWNoZSgpOw0KICAgIH0NCg0KICAgIHB1YmxpYyB2b2lkIHNl\ndFBvcHVsYXRlU3RvcmVDYWNoZShib29sZWFuIGNhY2hlKSB7DQogICAgICAg\nIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOw0KICAgICAgICBfYnJva2VyLnNl\ndFBvcHVsYXRlRGF0YUNhY2hlKGNhY2hlKTsNCiAgICB9DQoNCiAgICBwdWJs\naWMgYm9vbGVhbiBpc1RyYWNrQ2hhbmdlc0J5VHlwZSgpIHsNCiAgICAgICAg\ncmV0dXJuIF9icm9rZXIuaXNUcmFja0NoYW5nZXNCeVR5cGUoKTsNCiAgICB9\nDQoNCiAgICBwdWJsaWMgdm9pZCBzZXRUcmFja0NoYW5nZXNCeVR5cGUoYm9v\nbGVhbiB0cmFja0J5VHlwZSkgew0KICAgICAgICBhc3NlcnROb3RDbG9zZUlu\ndm9rZWQoKTsNCiAgICAgICAgX2Jyb2tlci5zZXRUcmFja0NoYW5nZXNCeVR5\ncGUodHJhY2tCeVR5cGUpOw0KICAgIH0NCg0KICAgIHB1YmxpYyBib29sZWFu\nIGlzTGFyZ2VUcmFuc2FjdGlvbigpIHsNCiAgICAgICAgcmV0dXJuIGlzVHJh\nY2tDaGFuZ2VzQnlUeXBlKCk7DQogICAgfQ0KDQogICAgcHVibGljIHZvaWQg\nc2V0TGFyZ2VUcmFuc2FjdGlvbihib29sZWFuIHZhbHVlKSB7DQogICAgICAg\nIHNldFRyYWNrQ2hhbmdlc0J5VHlwZSh2YWx1ZSk7DQogICAgfQ0KDQogICAg\ncHVibGljIE9iamVjdCBnZXRVc2VyT2JqZWN0KE9iamVjdCBrZXkpIHsNCiAg\nICAgICAgcmV0dXJuIF9icm9rZXIuZ2V0VXNlck9iamVjdChrZXkpOw0KICAg\nIH0NCg0KICAgIHB1YmxpYyBPYmplY3QgcHV0VXNlck9iamVjdChPYmplY3Qg\na2V5LCBPYmplY3QgdmFsKSB7DQogICAgICAgIGFzc2VydE5vdENsb3NlSW52\nb2tlZCgpOw0KICAgICAgICByZXR1cm4gX2Jyb2tlci5wdXRVc2VyT2JqZWN0\nKGtleSwgdmFsKTsNCiAgICB9DQoNCiAgICBwdWJsaWMgdm9pZCBhZGRUcmFu\nc2FjdGlvbkxpc3RlbmVyKE9iamVjdCBsaXN0ZW5lcikgew0KICAgICAgICBh\nc3NlcnROb3RDbG9zZUludm9rZWQoKTsNCiAgICAgICAgX2Jyb2tlci5hZGRU\ncmFuc2FjdGlvbkxpc3RlbmVyKGxpc3RlbmVyKTsNCiAgICB9DQoNCiAgICBw\ndWJsaWMgdm9pZCByZW1vdmVUcmFuc2FjdGlvbkxpc3RlbmVyKE9iamVjdCBs\naXN0ZW5lcikgew0KICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsN\nCiAgICAgICAgX2Jyb2tlci5yZW1vdmVUcmFuc2FjdGlvbkxpc3RlbmVyKGxp\nc3RlbmVyKTsNCiAgICB9DQoNCiAgICBwdWJsaWMgRW51bVNldDxDYWxsYmFj\na01vZGU+IGdldFRyYW5zYWN0aW9uTGlzdGVuZXJDYWxsYmFja01vZGVzKCkg\new0KICAgICAgICByZXR1cm4gQ2FsbGJhY2tNb2RlLnRvRW51bVNldCgNCiAg\nICAgICAgICAgIF9icm9rZXIuZ2V0VHJhbnNhY3Rpb25MaXN0ZW5lckNhbGxi\nYWNrTW9kZSgpKTsNCiAgICB9DQoNCiAgICBwdWJsaWMgdm9pZCBzZXRUcmFu\nc2FjdGlvbkxpc3RlbmVyQ2FsbGJhY2tNb2RlKENhbGxiYWNrTW9kZSBtb2Rl\nKSB7DQogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOw0KICAgICAg\nICBfYnJva2VyLnNldFRyYW5zYWN0aW9uTGlzdGVuZXJDYWxsYmFja01vZGUo\nDQogICAgICAgICAgICBDYWxsYmFja01vZGUuZnJvbUVudW1TZXQoRW51bVNl\ndC5vZihtb2RlKSkpOw0KICAgIH0NCg0KICAgIHB1YmxpYyB2b2lkIHNldFRy\nYW5zYWN0aW9uTGlzdGVuZXJDYWxsYmFja01vZGUoRW51bVNldDxDYWxsYmFj\na01vZGU+IG1vZGVzKXsNCiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2Vk\nKCk7DQogICAgICAgIF9icm9rZXIuc2V0VHJhbnNhY3Rpb25MaXN0ZW5lckNh\nbGxiYWNrTW9kZSgNCiAgICAgICAgICAgIENhbGxiYWNrTW9kZS5mcm9tRW51\nbVNldChtb2RlcykpOw0KICAgIH0NCg0KICAgIHB1YmxpYyBpbnQgZ2V0VHJh\nbnNhY3Rpb25MaXN0ZW5lckNhbGxiYWNrTW9kZSgpIHsNCiAgICAgICAgcmV0\ndXJuIF9icm9rZXIuZ2V0VHJhbnNhY3Rpb25MaXN0ZW5lckNhbGxiYWNrTW9k\nZSgpOw0KICAgIH0NCg0KICAgIHB1YmxpYyB2b2lkIHNldFRyYW5zYWN0aW9u\nTGlzdGVuZXJDYWxsYmFja01vZGUoaW50IGNhbGxiYWNrTW9kZSkgew0KICAg\nICAgICB0aHJvdyBuZXcgVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb24o\nKTsNCiAgICB9DQoNCiAgICBwdWJsaWMgdm9pZCBhZGRMaWZlY3ljbGVMaXN0\nZW5lcihPYmplY3QgbGlzdGVuZXIsIENsYXNzLi4uIGNsYXNzZXMpIHsNCiAg\nICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7DQogICAgICAgIF9icm9r\nZXIuYWRkTGlmZWN5Y2xlTGlzdGVuZXIobGlzdGVuZXIsIGNsYXNzZXMpOw0K\nICAgIH0NCg0KICAgIHB1YmxpYyB2b2lkIHJlbW92ZUxpZmVjeWNsZUxpc3Rl\nbmVyKE9iamVjdCBsaXN0ZW5lcikgew0KICAgICAgICBhc3NlcnROb3RDbG9z\nZUludm9rZWQoKTsNCiAgICAgICAgX2Jyb2tlci5yZW1vdmVMaWZlY3ljbGVM\naXN0ZW5lcihsaXN0ZW5lcik7DQogICAgfQ0KDQogICAgcHVibGljIEVudW1T\nZXQ8Q2FsbGJhY2tNb2RlPiBnZXRMaWZlY3ljbGVMaXN0ZW5lckNhbGxiYWNr\nTW9kZXMoKSB7DQogICAgICAgIHJldHVybiBDYWxsYmFja01vZGUudG9FbnVt\nU2V0KA0KICAgICAgICAgICAgX2Jyb2tlci5nZXRMaWZlY3ljbGVMaXN0ZW5l\nckNhbGxiYWNrTW9kZSgpKTsNCiAgICB9DQoNCiAgICBwdWJsaWMgdm9pZCBz\nZXRMaWZlY3ljbGVMaXN0ZW5lckNhbGxiYWNrTW9kZShDYWxsYmFja01vZGUg\nbW9kZSkgew0KICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsNCiAg\nICAgICAgX2Jyb2tlci5zZXRMaWZlY3ljbGVMaXN0ZW5lckNhbGxiYWNrTW9k\nZSgNCiAgICAgICAgICAgIENhbGxiYWNrTW9kZS5mcm9tRW51bVNldChFbnVt\nU2V0Lm9mKG1vZGUpKSk7DQogICAgfQ0KDQogICAgcHVibGljIHZvaWQgc2V0\nTGlmZWN5Y2xlTGlzdGVuZXJDYWxsYmFja01vZGUoRW51bVNldDxDYWxsYmFj\na01vZGU+IG1vZGVzKSB7DQogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tl\nZCgpOw0KICAgICAgICBfYnJva2VyLnNldExpZmVjeWNsZUxpc3RlbmVyQ2Fs\nbGJhY2tNb2RlKA0KICAgICAgICAgICAgQ2FsbGJhY2tNb2RlLmZyb21FbnVt\nU2V0KG1vZGVzKSk7DQogICAgfQ0KDQogICAgcHVibGljIGludCBnZXRMaWZl\nY3ljbGVMaXN0ZW5lckNhbGxiYWNrTW9kZSgpIHsNCiAgICAgICAgcmV0dXJu\nIF9icm9rZXIuZ2V0TGlmZWN5Y2xlTGlzdGVuZXJDYWxsYmFja01vZGUoKTsN\nCiAgICB9DQoNCiAgICBwdWJsaWMgdm9pZCBzZXRMaWZlY3ljbGVMaXN0ZW5l\nckNhbGxiYWNrTW9kZShpbnQgY2FsbGJhY2tNb2RlKSB7DQogICAgICAgIGFz\nc2VydE5vdENsb3NlSW52b2tlZCgpOw0KICAgICAgICBfYnJva2VyLnNldExp\nZmVjeWNsZUxpc3RlbmVyQ2FsbGJhY2tNb2RlKGNhbGxiYWNrTW9kZSk7DQog\nICAgfQ0KDQogICAgQFN1cHByZXNzV2FybmluZ3MoInVuY2hlY2tlZCIpDQog\nICAgcHVibGljIDxUPiBUIGdldFJlZmVyZW5jZShDbGFzczxUPiBjbHMsIE9i\namVjdCBvaWQpIHsNCiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7\nDQogICAgICAgIG9pZCA9IF9icm9rZXIubmV3T2JqZWN0SWQoY2xzLCBvaWQp\nOw0KICAgICAgICByZXR1cm4gKFQpIF9icm9rZXIuZmluZChvaWQsIGZhbHNl\nLCB0aGlzKTsNCiAgICB9DQoNCiAgICBAU3VwcHJlc3NXYXJuaW5ncygidW5j\naGVja2VkIikNCiAgICBwdWJsaWMgPFQ+IFQgZmluZChDbGFzczxUPiBjbHMs\nIE9iamVjdCBvaWQpIHsNCiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2Vk\nKCk7DQogICAgICAgIG9pZCA9IF9icm9rZXIubmV3T2JqZWN0SWQoY2xzLCBv\naWQpOw0KICAgICAgICByZXR1cm4gKFQpIF9icm9rZXIuZmluZChvaWQsIHRy\ndWUsIHRoaXMpOw0KICAgIH0NCg0KICAgIEBTdXBwcmVzc1dhcm5pbmdzKCJ1\nbmNoZWNrZWQiKQ0KICAgIHB1YmxpYyA8VD4gVFtdIGZpbmRBbGwoQ2xhc3M8\nVD4gY2xzLCBPYmplY3QuLi4gb2lkcykgew0KICAgICAgICBpZiAob2lkcy5s\nZW5ndGggPT0gMCkNCiAgICAgICAgICAgIHJldHVybiAoVFtdKSBBcnJheS5u\nZXdJbnN0YW5jZShjbHMsIDApOw0KICAgICAgICBDb2xsZWN0aW9uPFQ+IHJl\ndCA9IGZpbmRBbGwoY2xzLCBBcnJheXMuYXNMaXN0KG9pZHMpKTsNCiAgICAg\nICAgcmV0dXJuIHJldC50b0FycmF5KChUW10pIEFycmF5Lm5ld0luc3RhbmNl\nKGNscywgcmV0LnNpemUoKSkpOw0KICAgIH0NCg0KICAgIEBTdXBwcmVzc1dh\ncm5pbmdzKCJ1bmNoZWNrZWQiKQ0KICAgIHB1YmxpYyA8VD4gQ29sbGVjdGlv\nbjxUPiBmaW5kQWxsKGZpbmFsIENsYXNzPFQ+IGNscywgQ29sbGVjdGlvbiBv\naWRzKSB7DQogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOw0KICAg\nICAgICBPYmplY3RbXSBvYmpzID0gX2Jyb2tlci5maW5kQWxsKG9pZHMsIHRy\ndWUsIG5ldyBGaW5kQ2FsbGJhY2tzKCkgew0KICAgICAgICAgICAgcHVibGlj\nIE9iamVjdCBwcm9jZXNzQXJndW1lbnQoT2JqZWN0IG9pZCkgew0KICAgICAg\nICAgICAgICAgIHJldHVybiBfYnJva2VyLm5ld09iamVjdElkKGNscywgb2lk\nKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgcHVibGljIE9iamVj\ndCBwcm9jZXNzUmV0dXJuKE9iamVjdCBvaWQsIE9wZW5KUEFTdGF0ZU1hbmFn\nZXIgc20pIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gRW50aXR5TWFuYWdl\nckltcGwudGhpcy5wcm9jZXNzUmV0dXJuKG9pZCwgc20pOw0KICAgICAgICAg\nICAgfQ0KICAgICAgICB9KTsNCiAgICAgICAgcmV0dXJuIChDb2xsZWN0aW9u\nPFQ+KSBBcnJheXMuYXNMaXN0KG9ianMpOw0KICAgIH0NCg0KICAgIEBTdXBw\ncmVzc1dhcm5pbmdzKCJ1bmNoZWNrZWQiKQ0KICAgIHB1YmxpYyA8VD4gVCBm\naW5kQ2FjaGVkKENsYXNzPFQ+IGNscywgT2JqZWN0IG9pZCkgew0KICAgICAg\nICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsNCiAgICAgICAgcmV0dXJuIChU\nKSBfYnJva2VyLmZpbmRDYWNoZWQoX2Jyb2tlci5uZXdPYmplY3RJZChjbHMs\nIG9pZCksIHRoaXMpOw0KICAgIH0NCg0KICAgIHB1YmxpYyBDbGFzcyBnZXRP\nYmplY3RJZENsYXNzKENsYXNzIGNscykgew0KICAgICAgICBhc3NlcnROb3RD\nbG9zZUludm9rZWQoKTsNCiAgICAgICAgaWYgKGNscyA9PSBudWxsKQ0KICAg\nICAgICAgICAgcmV0dXJuIG51bGw7DQogICAgICAgIHJldHVybiBKUEFGYWNh\nZGVIZWxwZXIuZnJvbU9wZW5KUEFPYmplY3RJZENsYXNzDQogICAgICAgICAg\nICAgICAgKF9icm9rZXIuZ2V0T2JqZWN0SWRUeXBlKGNscykpOw0KICAgIH0N\nCg0KICAgIHB1YmxpYyBPcGVuSlBBRW50aXR5VHJhbnNhY3Rpb24gZ2V0VHJh\nbnNhY3Rpb24oKSB7DQogICAgICAgIGlmIChfYnJva2VyLmlzTWFuYWdlZCgp\nKQ0KICAgICAgICAgICAgdGhyb3cgbmV3IEludmFsaWRTdGF0ZUV4Y2VwdGlv\nbihfbG9jLmdldCgiZ2V0LW1hbmFnZWQtdHJhbnMiKSwNCiAgICAgICAgICAg\nICAgICBudWxsLCBudWxsLCBmYWxzZSk7DQogICAgICAgIHJldHVybiB0aGlz\nOw0KICAgIH0NCg0KICAgIHB1YmxpYyB2b2lkIGpvaW5UcmFuc2FjdGlvbigp\nIHsNCiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7DQogICAgICAg\nIGlmICghX2Jyb2tlci5zeW5jV2l0aE1hbmFnZWRUcmFuc2FjdGlvbigpKQ0K\nICAgICAgICAgICAgdGhyb3cgbmV3IFRyYW5zYWN0aW9uUmVxdWlyZWRFeGNl\ncHRpb24oX2xvYy5nZXQNCiAgICAgICAgICAgICAgICAoIm5vLW1hbmFnZWQt\ndHJhbnMiKSwgbnVsbCwgbnVsbCwgZmFsc2UpOw0KICAgIH0NCg0KICAgIHB1\nYmxpYyB2b2lkIGJlZ2luKCkgew0KICAgICAgICBfYnJva2VyLmJlZ2luKCk7\nDQogICAgfQ0KDQogICAgcHVibGljIHZvaWQgY29tbWl0KCkgew0KICAgICAg\nICB0cnkgew0KICAgICAgICAgICAgX2Jyb2tlci5jb21taXQoKTsNCiAgICAg\nICAgfSBjYXRjaCAoUm9sbGJhY2tFeGNlcHRpb24gZSkgew0KICAgICAgICAg\nICAgdGhyb3cgZTsNCiAgICAgICAgfSBjYXRjaCAoSWxsZWdhbFN0YXRlRXhj\nZXB0aW9uIGUpIHsNCiAgICAgICAgICAgIHRocm93IGU7DQogICAgICAgIH0g\nY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7DQogICAgICAgICAgICAvLyBSb2xsYmFj\na0V4Y2VwdGlvbnMgYXJlIHNwZWNpYWwgYW5kIGFyZW4ndCBoYW5kbGVkIGJ5\nIHRoZQ0KICAgICAgICAgICAgLy8gbm9ybWFsIGV4Y2VwdGlvbiB0cmFuc2xh\ndG9yLCBzaW5jZSB0aGUgc3BlYyBzYXlzIHRoZXkNCiAgICAgICAgICAgIC8v\nIHNob3VsZCBiZSB0aHJvd24gd2hlbmV2ZXIgdGhlIGNvbW1pdCBmYWlscyBm\nb3IgYW55IHJlYXNvbiBhdA0KICAgICAgICAgICAgLy8gYWxsLCB3aGVyYXMg\ndGhlIGV4Y2VwdGlvbiB0cmFuc2xhdG9yIGhhbmRsZXMgZXhjZXB0aW9ucyB0\naGF0DQogICAgICAgICAgICAvLyBhcmUgY2F1c2VkIGZvciBzcGVjaWZpYyBy\nZWFzb25zDQogICAgICAgICAgICB0aHJvdyBuZXcgUm9sbGJhY2tFeGNlcHRp\nb24oZSk7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICBwdWJsaWMgdm9pZCBy\nb2xsYmFjaygpIHsNCiAgICAgICAgX2Jyb2tlci5yb2xsYmFjaygpOw0KICAg\nIH0NCg0KICAgIHB1YmxpYyB2b2lkIGNvbW1pdEFuZFJlc3VtZSgpIHsNCiAg\nICAgICAgX2Jyb2tlci5jb21taXRBbmRSZXN1bWUoKTsNCiAgICB9DQoNCiAg\nICBwdWJsaWMgdm9pZCByb2xsYmFja0FuZFJlc3VtZSgpIHsNCiAgICAgICAg\nX2Jyb2tlci5yb2xsYmFja0FuZFJlc3VtZSgpOw0KICAgIH0NCg0KICAgIHB1\nYmxpYyBUaHJvd2FibGUgZ2V0Um9sbGJhY2tDYXVzZSgpIHsNCiAgICAgICAg\naWYgKCFpc0FjdGl2ZSgpKQ0KICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVn\nYWxTdGF0ZUV4Y2VwdGlvbihfbG9jLmdldCgibm8tdHJhbnNhY3Rpb24iKQ0K\nICAgICAgICAgICAgICAgIC5nZXRNZXNzYWdlKCkpOw0KDQogICAgICAgIHJl\ndHVybiBfYnJva2VyLmdldFJvbGxiYWNrQ2F1c2UoKTsNCiAgICB9DQoNCiAg\nICBwdWJsaWMgYm9vbGVhbiBnZXRSb2xsYmFja09ubHkoKSB7DQogICAgICAg\nIGlmICghaXNBY3RpdmUoKSkNCiAgICAgICAgICAgIHRocm93IG5ldyBJbGxl\nZ2FsU3RhdGVFeGNlcHRpb24oX2xvYy5nZXQoIm5vLXRyYW5zYWN0aW9uIikN\nCiAgICAgICAgICAgICAgICAuZ2V0TWVzc2FnZSgpKTsNCg0KICAgICAgICBy\nZXR1cm4gX2Jyb2tlci5nZXRSb2xsYmFja09ubHkoKTsNCiAgICB9DQoNCiAg\nICBwdWJsaWMgdm9pZCBzZXRSb2xsYmFja09ubHkoKSB7DQogICAgICAgIF9i\ncm9rZXIuc2V0Um9sbGJhY2tPbmx5KCk7DQogICAgfQ0KDQogICAgcHVibGlj\nIHZvaWQgc2V0Um9sbGJhY2tPbmx5KFRocm93YWJsZSBjYXVzZSkgew0KICAg\nICAgICBfYnJva2VyLnNldFJvbGxiYWNrT25seShjYXVzZSk7DQogICAgfQ0K\nDQogICAgcHVibGljIHZvaWQgc2V0U2F2ZXBvaW50KFN0cmluZyBuYW1lKSB7\nDQogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOw0KICAgICAgICBf\nYnJva2VyLnNldFNhdmVwb2ludChuYW1lKTsNCiAgICB9DQoNCiAgICBwdWJs\naWMgdm9pZCByb2xsYmFja1RvU2F2ZXBvaW50KCkgew0KICAgICAgICBhc3Nl\ncnROb3RDbG9zZUludm9rZWQoKTsNCiAgICAgICAgX2Jyb2tlci5yb2xsYmFj\na1RvU2F2ZXBvaW50KCk7DQogICAgfQ0KDQogICAgcHVibGljIHZvaWQgcm9s\nbGJhY2tUb1NhdmVwb2ludChTdHJpbmcgbmFtZSkgew0KICAgICAgICBhc3Nl\ncnROb3RDbG9zZUludm9rZWQoKTsNCiAgICAgICAgX2Jyb2tlci5yb2xsYmFj\na1RvU2F2ZXBvaW50KG5hbWUpOw0KICAgIH0NCg0KICAgIHB1YmxpYyB2b2lk\nIHJlbGVhc2VTYXZlcG9pbnQoKSB7DQogICAgICAgIGFzc2VydE5vdENsb3Nl\nSW52b2tlZCgpOw0KICAgICAgICBfYnJva2VyLnJlbGVhc2VTYXZlcG9pbnQo\nKTsNCiAgICB9DQoNCiAgICBwdWJsaWMgdm9pZCByZWxlYXNlU2F2ZXBvaW50\nKFN0cmluZyBuYW1lKSB7DQogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tl\nZCgpOw0KICAgICAgICBfYnJva2VyLnJlbGVhc2VTYXZlcG9pbnQobmFtZSk7\nDQogICAgfQ0KDQogICAgcHVibGljIHZvaWQgZmx1c2goKSB7DQogICAgICAg\nIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOw0KICAgICAgICBfYnJva2VyLmFz\nc2VydE9wZW4oKTsNCiAgICAgICAgX2Jyb2tlci5hc3NlcnRBY3RpdmVUcmFu\nc2FjdGlvbigpOw0KICAgICAgICBfYnJva2VyLmZsdXNoKCk7DQogICAgfQ0K\nDQogICAgcHVibGljIHZvaWQgcHJlRmx1c2goKSB7DQogICAgICAgIGFzc2Vy\ndE5vdENsb3NlSW52b2tlZCgpOw0KICAgICAgICBfYnJva2VyLnByZUZsdXNo\nKCk7DQogICAgfQ0KDQogICAgcHVibGljIHZvaWQgdmFsaWRhdGVDaGFuZ2Vz\nKCkgew0KICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsNCiAgICAg\nICAgX2Jyb2tlci52YWxpZGF0ZUNoYW5nZXMoKTsNCiAgICB9DQoNCiAgICBw\ndWJsaWMgYm9vbGVhbiBpc0FjdGl2ZSgpIHsNCiAgICAgICAgcmV0dXJuIGlz\nT3BlbigpICYmIF9icm9rZXIuaXNBY3RpdmUoKTsNCiAgICB9DQoNCiAgICBw\ndWJsaWMgYm9vbGVhbiBpc1N0b3JlQWN0aXZlKCkgew0KICAgICAgICByZXR1\ncm4gX2Jyb2tlci5pc1N0b3JlQWN0aXZlKCk7DQogICAgfQ0KDQogICAgcHVi\nbGljIHZvaWQgYmVnaW5TdG9yZSgpIHsNCiAgICAgICAgX2Jyb2tlci5iZWdp\nblN0b3JlKCk7DQogICAgfQ0KDQogICAgcHVibGljIGJvb2xlYW4gY29udGFp\nbnMoT2JqZWN0IGVudGl0eSkgew0KICAgICAgICBhc3NlcnROb3RDbG9zZUlu\ndm9rZWQoKTsNCiAgICAgICAgaWYgKGVudGl0eSA9PSBudWxsKQ0KICAgICAg\nICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICBPcGVuSlBBU3RhdGVNYW5h\nZ2VyIHNtID0gX2Jyb2tlci5nZXRTdGF0ZU1hbmFnZXIoZW50aXR5KTsNCiAg\nICAgICAgaWYgKHNtID09IG51bGwNCiAgICAgICAgICAgICYmICFJbXBsSGVs\ncGVyLmlzTWFuYWdlZFR5cGUoZ2V0Q29uZmlndXJhdGlvbigpLCBlbnRpdHku\nZ2V0Q2xhc3MoKSkpDQogICAgICAgICAgICB0aHJvdyBuZXcgQXJndW1lbnRF\neGNlcHRpb24oX2xvYy5nZXQoIm5vdC1lbnRpdHkiLA0KICAgICAgICAgICAg\nICAgIGVudGl0eS5nZXRDbGFzcygpKSwgbnVsbCwgbnVsbCwgdHJ1ZSk7DQog\nICAgICAgIHJldHVybiBzbSAhPSBudWxsICYmICFzbS5pc0RlbGV0ZWQoKTsN\nCiAgICB9DQoNCiAgICBwdWJsaWMgYm9vbGVhbiBjb250YWluc0FsbChPYmpl\nY3QuLi4gZW50aXRpZXMpIHsNCiAgICAgICAgZm9yIChPYmplY3QgZW50aXR5\nIDogZW50aXRpZXMpDQogICAgICAgICAgICBpZiAoIWNvbnRhaW5zKGVudGl0\neSkpDQogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICBy\nZXR1cm4gdHJ1ZTsNCiAgICB9DQoNCiAgICBwdWJsaWMgYm9vbGVhbiBjb250\nYWluc0FsbChDb2xsZWN0aW9uIGVudGl0aWVzKSB7DQogICAgICAgIGZvciAo\nT2JqZWN0IGVudGl0eSA6IGVudGl0aWVzKQ0KICAgICAgICAgICAgaWYgKCFj\nb250YWlucyhlbnRpdHkpKQ0KICAgICAgICAgICAgICAgIHJldHVybiBmYWxz\nZTsNCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgfQ0KDQogICAgcHVibGlj\nIHZvaWQgcGVyc2lzdChPYmplY3QgZW50aXR5KSB7DQogICAgICAgIGFzc2Vy\ndE5vdENsb3NlSW52b2tlZCgpOw0KICAgICAgICBfYnJva2VyLnBlcnNpc3Qo\nZW50aXR5LCB0aGlzKTsNCiAgICB9DQoNCiAgICBwdWJsaWMgdm9pZCBwZXJz\naXN0QWxsKE9iamVjdC4uLiBlbnRpdGllcykgew0KICAgICAgICBwZXJzaXN0\nQWxsKEFycmF5cy5hc0xpc3QoZW50aXRpZXMpKTsNCiAgICB9DQoNCiAgICBw\ndWJsaWMgdm9pZCBwZXJzaXN0QWxsKENvbGxlY3Rpb24gZW50aXRpZXMpIHsN\nCiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7DQogICAgICAgIF9i\ncm9rZXIucGVyc2lzdEFsbChlbnRpdGllcywgdGhpcyk7DQogICAgfQ0KDQog\nICAgcHVibGljIHZvaWQgcmVtb3ZlKE9iamVjdCBlbnRpdHkpIHsNCiAgICAg\nICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7DQogICAgICAgIF9icm9rZXIu\nZGVsZXRlKGVudGl0eSwgdGhpcyk7DQogICAgfQ0KDQogICAgcHVibGljIHZv\naWQgcmVtb3ZlQWxsKE9iamVjdC4uLiBlbnRpdGllcykgew0KICAgICAgICBy\nZW1vdmVBbGwoQXJyYXlzLmFzTGlzdChlbnRpdGllcykpOw0KICAgIH0NCg0K\nICAgIHB1YmxpYyB2b2lkIHJlbW92ZUFsbChDb2xsZWN0aW9uIGVudGl0aWVz\nKSB7DQogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOw0KICAgICAg\nICBfYnJva2VyLmRlbGV0ZUFsbChlbnRpdGllcywgdGhpcyk7DQogICAgfQ0K\nDQogICAgcHVibGljIHZvaWQgcmVsZWFzZShPYmplY3QgZW50aXR5KSB7DQog\nICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOw0KICAgICAgICBfYnJv\na2VyLnJlbGVhc2UoZW50aXR5LCB0aGlzKTsNCiAgICB9DQoNCiAgICBwdWJs\naWMgdm9pZCByZWxlYXNlQWxsKENvbGxlY3Rpb24gZW50aXRpZXMpIHsNCiAg\nICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7DQogICAgICAgIF9icm9r\nZXIucmVsZWFzZUFsbChlbnRpdGllcywgdGhpcyk7DQogICAgfQ0KDQogICAg\ncHVibGljIHZvaWQgcmVsZWFzZUFsbChPYmplY3QuLi4gZW50aXRpZXMpIHsN\nCiAgICAgICAgcmVsZWFzZUFsbChBcnJheXMuYXNMaXN0KGVudGl0aWVzKSk7\nDQogICAgfQ0KDQogICAgcHVibGljIHZvaWQgcmVmcmVzaChPYmplY3QgZW50\naXR5KSB7DQogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOw0KICAg\nICAgICBfYnJva2VyLmFzc2VydFdyaXRlT3BlcmF0aW9uKCk7DQogICAgICAg\nIF9icm9rZXIucmVmcmVzaChlbnRpdHksIHRoaXMpOw0KICAgIH0NCg0KICAg\nIHB1YmxpYyB2b2lkIHJlZnJlc2hBbGwoKSB7DQogICAgICAgIGFzc2VydE5v\ndENsb3NlSW52b2tlZCgpOw0KICAgICAgICBfYnJva2VyLmFzc2VydFdyaXRl\nT3BlcmF0aW9uKCk7DQogICAgICAgIF9icm9rZXIucmVmcmVzaEFsbChfYnJv\na2VyLmdldFRyYW5zYWN0aW9uYWxPYmplY3RzKCksIHRoaXMpOw0KICAgIH0N\nCg0KICAgIHB1YmxpYyB2b2lkIHJlZnJlc2hBbGwoQ29sbGVjdGlvbiBlbnRp\ndGllcykgew0KICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsNCiAg\nICAgICAgX2Jyb2tlci5hc3NlcnRXcml0ZU9wZXJhdGlvbigpOw0KICAgICAg\nICBfYnJva2VyLnJlZnJlc2hBbGwoZW50aXRpZXMsIHRoaXMpOw0KICAgIH0N\nCg0KICAgIHB1YmxpYyB2b2lkIHJlZnJlc2hBbGwoT2JqZWN0Li4uIGVudGl0\naWVzKSB7DQogICAgICAgIHJlZnJlc2hBbGwoQXJyYXlzLmFzTGlzdChlbnRp\ndGllcykpOw0KICAgIH0NCg0KICAgIHB1YmxpYyB2b2lkIHJldHJpZXZlKE9i\namVjdCBlbnRpdHkpIHsNCiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2Vk\nKCk7DQogICAgICAgIF9icm9rZXIucmV0cmlldmUoZW50aXR5LCB0cnVlLCB0\naGlzKTsNCiAgICB9DQoNCiAgICBwdWJsaWMgdm9pZCByZXRyaWV2ZUFsbChD\nb2xsZWN0aW9uIGVudGl0aWVzKSB7DQogICAgICAgIGFzc2VydE5vdENsb3Nl\nSW52b2tlZCgpOw0KICAgICAgICBfYnJva2VyLnJldHJpZXZlQWxsKGVudGl0\naWVzLCB0cnVlLCB0aGlzKTsNCiAgICB9DQoNCiAgICBwdWJsaWMgdm9pZCBy\nZXRyaWV2ZUFsbChPYmplY3QuLi4gZW50aXRpZXMpIHsNCiAgICAgICAgcmV0\ncmlldmVBbGwoQXJyYXlzLmFzTGlzdChlbnRpdGllcykpOw0KICAgIH0NCg0K\nICAgIHB1YmxpYyB2b2lkIGV2aWN0KE9iamVjdCBlbnRpdHkpIHsNCiAgICAg\nICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7DQogICAgICAgIF9icm9rZXIu\nZXZpY3QoZW50aXR5LCB0aGlzKTsNCiAgICB9DQoNCiAgICBwdWJsaWMgdm9p\nZCBldmljdEFsbChDb2xsZWN0aW9uIGVudGl0aWVzKSB7DQogICAgICAgIGFz\nc2VydE5vdENsb3NlSW52b2tlZCgpOw0KICAgICAgICBfYnJva2VyLmV2aWN0\nQWxsKGVudGl0aWVzLCB0aGlzKTsNCiAgICB9DQoNCiAgICBwdWJsaWMgdm9p\nZCBldmljdEFsbChPYmplY3QuLi4gZW50aXRpZXMpIHsNCiAgICAgICAgZXZp\nY3RBbGwoQXJyYXlzLmFzTGlzdChlbnRpdGllcykpOw0KICAgIH0NCg0KICAg\nIHB1YmxpYyB2b2lkIGV2aWN0QWxsKCkgew0KICAgICAgICBhc3NlcnROb3RD\nbG9zZUludm9rZWQoKTsNCiAgICAgICAgX2Jyb2tlci5ldmljdEFsbCh0aGlz\nKTsNCiAgICB9DQoNCiAgICBwdWJsaWMgdm9pZCBldmljdEFsbChDbGFzcyBj\nbHMpIHsNCiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7DQogICAg\nICAgIF9icm9rZXIuZXZpY3RBbGwoX2Jyb2tlci5uZXdFeHRlbnQoY2xzLCB0\ncnVlKSwgdGhpcyk7DQogICAgfQ0KDQogICAgcHVibGljIHZvaWQgZXZpY3RB\nbGwoRXh0ZW50IGV4dGVudCkgew0KICAgICAgICBhc3NlcnROb3RDbG9zZUlu\ndm9rZWQoKTsNCiAgICAgICAgX2Jyb2tlci5ldmljdEFsbCgoKEV4dGVudElt\ncGwpIGV4dGVudCkuZ2V0RGVsZWdhdGUoKSwgdGhpcyk7DQogICAgfQ0KDQog\nICAgQFN1cHByZXNzV2FybmluZ3MoInVuY2hlY2tlZCIpDQogICAgcHVibGlj\nIDxUPiBUIGRldGFjaChUIGVudGl0eSkgew0KICAgICAgICBhc3NlcnROb3RD\nbG9zZUludm9rZWQoKTsNCiAgICAgICAgcmV0dXJuIChUKSBfYnJva2VyLmRl\ndGFjaChlbnRpdHksIHRoaXMpOw0KICAgIH0NCg0KICAgIHB1YmxpYyBPYmpl\nY3RbXSBkZXRhY2hBbGwoT2JqZWN0Li4uIGVudGl0aWVzKSB7DQogICAgICAg\nIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOw0KICAgICAgICByZXR1cm4gX2Jy\nb2tlci5kZXRhY2hBbGwoQXJyYXlzLmFzTGlzdChlbnRpdGllcyksIHRoaXMp\nOw0KICAgIH0NCg0KICAgIHB1YmxpYyBDb2xsZWN0aW9uIGRldGFjaEFsbChD\nb2xsZWN0aW9uIGVudGl0aWVzKSB7DQogICAgICAgIGFzc2VydE5vdENsb3Nl\nSW52b2tlZCgpOw0KICAgICAgICByZXR1cm4gQXJyYXlzLmFzTGlzdChfYnJv\na2VyLmRldGFjaEFsbChlbnRpdGllcywgdGhpcykpOw0KICAgIH0NCg0KICAg\nIEBTdXBwcmVzc1dhcm5pbmdzKCJ1bmNoZWNrZWQiKQ0KICAgIHB1YmxpYyA8\nVD4gVCBtZXJnZShUIGVudGl0eSkgew0KICAgICAgICBhc3NlcnROb3RDbG9z\nZUludm9rZWQoKTsNCiAgICAgICAgcmV0dXJuIChUKSBfYnJva2VyLmF0dGFj\naChlbnRpdHksIHRydWUsIHRoaXMpOw0KICAgIH0NCg0KICAgIHB1YmxpYyBP\nYmplY3RbXSBtZXJnZUFsbChPYmplY3QuLi4gZW50aXRpZXMpIHsNCiAgICAg\nICAgaWYgKGVudGl0aWVzLmxlbmd0aCA9PSAwKQ0KICAgICAgICAgICAgcmV0\ndXJuIEVNUFRZX09CSkVDVFM7DQogICAgICAgIHJldHVybiBtZXJnZUFsbChB\ncnJheXMuYXNMaXN0KGVudGl0aWVzKSkudG9BcnJheSgpOw0KICAgIH0NCg0K\nICAgIHB1YmxpYyBDb2xsZWN0aW9uIG1lcmdlQWxsKENvbGxlY3Rpb24gZW50\naXRpZXMpIHsNCiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7DQog\nICAgICAgIHJldHVybiBBcnJheXMuYXNMaXN0KF9icm9rZXIuYXR0YWNoQWxs\nKGVudGl0aWVzLCB0cnVlLCB0aGlzKSk7DQogICAgfQ0KDQogICAgcHVibGlj\nIHZvaWQgdHJhbnNhY3Rpb25hbChPYmplY3QgZW50aXR5LCBib29sZWFuIHVw\nZGF0ZVZlcnNpb24pIHsNCiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2Vk\nKCk7DQogICAgICAgIF9icm9rZXIudHJhbnNhY3Rpb25hbChlbnRpdHksIHVw\nZGF0ZVZlcnNpb24sIHRoaXMpOw0KICAgIH0NCg0KICAgIHB1YmxpYyB2b2lk\nIHRyYW5zYWN0aW9uYWxBbGwoQ29sbGVjdGlvbiBvYmpzLCBib29sZWFuIHVw\nZGF0ZVZlcnNpb24pIHsNCiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2Vk\nKCk7DQogICAgICAgIF9icm9rZXIudHJhbnNhY3Rpb25hbEFsbChvYmpzLCB1\ncGRhdGVWZXJzaW9uLCB0aGlzKTsNCiAgICB9DQoNCiAgICBwdWJsaWMgdm9p\nZCB0cmFuc2FjdGlvbmFsQWxsKE9iamVjdFtdIG9ianMsIGJvb2xlYW4gdXBk\nYXRlVmVyc2lvbikgew0KICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQo\nKTsNCiAgICAgICAgX2Jyb2tlci50cmFuc2FjdGlvbmFsQWxsKEFycmF5cy5h\nc0xpc3Qob2JqcyksIHVwZGF0ZVZlcnNpb24sIHRoaXMpOw0KICAgIH0NCg0K\nICAgIHB1YmxpYyB2b2lkIG5vbnRyYW5zYWN0aW9uYWwoT2JqZWN0IGVudGl0\neSkgew0KICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsNCiAgICAg\nICAgX2Jyb2tlci5ub250cmFuc2FjdGlvbmFsKGVudGl0eSwgdGhpcyk7DQog\nICAgfQ0KDQogICAgcHVibGljIHZvaWQgbm9udHJhbnNhY3Rpb25hbEFsbChD\nb2xsZWN0aW9uIG9ianMpIHsNCiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZv\na2VkKCk7DQogICAgICAgIF9icm9rZXIubm9udHJhbnNhY3Rpb25hbEFsbChv\nYmpzLCB0aGlzKTsNCiAgICB9DQoNCiAgICBwdWJsaWMgdm9pZCBub250cmFu\nc2FjdGlvbmFsQWxsKE9iamVjdFtdIG9ianMpIHsNCiAgICAgICAgYXNzZXJ0\nTm90Q2xvc2VJbnZva2VkKCk7DQogICAgICAgIF9icm9rZXIubm9udHJhbnNh\nY3Rpb25hbEFsbChBcnJheXMuYXNMaXN0KG9ianMpLCB0aGlzKTsNCiAgICB9\nDQoNCiAgICBwdWJsaWMgR2VuZXJhdG9yIGdldE5hbWVkR2VuZXJhdG9yKFN0\ncmluZyBuYW1lKSB7DQogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgp\nOw0KICAgICAgICB0cnkgew0KICAgICAgICAgICAgU2VxdWVuY2VNZXRhRGF0\nYSBtZXRhID0gX2Jyb2tlci5nZXRDb25maWd1cmF0aW9uKCkuDQogICAgICAg\nICAgICAgICAgZ2V0TWV0YURhdGFSZXBvc2l0b3J5SW5zdGFuY2UoKS5nZXRT\nZXF1ZW5jZU1ldGFEYXRhKG5hbWUsDQogICAgICAgICAgICAgICAgX2Jyb2tl\nci5nZXRDbGFzc0xvYWRlcigpLCB0cnVlKTsNCiAgICAgICAgICAgIFNlcSBz\nZXEgPSBtZXRhLmdldEluc3RhbmNlKF9icm9rZXIuZ2V0Q2xhc3NMb2FkZXIo\nKSk7DQogICAgICAgICAgICByZXR1cm4gbmV3IEdlbmVyYXRvckltcGwoc2Vx\nLCBuYW1lLCBfYnJva2VyLCBudWxsKTsNCiAgICAgICAgfSBjYXRjaCAoUnVu\ndGltZUV4Y2VwdGlvbiByZSkgew0KICAgICAgICAgICAgdGhyb3cgUGVyc2lz\ndGVuY2VFeGNlcHRpb25zLnRvUGVyc2lzdGVuY2VFeGNlcHRpb24ocmUpOw0K\nICAgICAgICB9DQogICAgfQ0KDQogICAgcHVibGljIEdlbmVyYXRvciBnZXRJ\nZEdlbmVyYXRvcihDbGFzcyBmb3JDbGFzcykgew0KICAgICAgICBhc3NlcnRO\nb3RDbG9zZUludm9rZWQoKTsNCiAgICAgICAgdHJ5IHsNCiAgICAgICAgICAg\nIENsYXNzTWV0YURhdGEgbWV0YSA9IF9icm9rZXIuZ2V0Q29uZmlndXJhdGlv\nbigpLg0KICAgICAgICAgICAgICAgIGdldE1ldGFEYXRhUmVwb3NpdG9yeUlu\nc3RhbmNlKCkuZ2V0TWV0YURhdGEoZm9yQ2xhc3MsDQogICAgICAgICAgICAg\nICAgX2Jyb2tlci5nZXRDbGFzc0xvYWRlcigpLCB0cnVlKTsNCiAgICAgICAg\nICAgIFNlcSBzZXEgPSBfYnJva2VyLmdldElkZW50aXR5U2VxdWVuY2UobWV0\nYSk7DQogICAgICAgICAgICByZXR1cm4gKHNlcSA9PSBudWxsKSA/IG51bGwg\nOiBuZXcgR2VuZXJhdG9ySW1wbChzZXEsIG51bGwsIF9icm9rZXIsDQogICAg\nICAgICAgICAgICAgbWV0YSk7DQogICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlv\nbiBlKSB7DQogICAgICAgICAgICB0aHJvdyBQZXJzaXN0ZW5jZUV4Y2VwdGlv\nbnMudG9QZXJzaXN0ZW5jZUV4Y2VwdGlvbihlKTsNCiAgICAgICAgfQ0KICAg\nIH0NCg0KICAgIHB1YmxpYyBHZW5lcmF0b3IgZ2V0RmllbGRHZW5lcmF0b3Io\nQ2xhc3MgZm9yQ2xhc3MsIFN0cmluZyBmaWVsZE5hbWUpIHsNCiAgICAgICAg\nYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7DQogICAgICAgIHRyeSB7DQogICAg\nICAgICAgICBDbGFzc01ldGFEYXRhIG1ldGEgPSBfYnJva2VyLmdldENvbmZp\nZ3VyYXRpb24oKS4NCiAgICAgICAgICAgICAgICBnZXRNZXRhRGF0YVJlcG9z\naXRvcnlJbnN0YW5jZSgpLmdldE1ldGFEYXRhKGZvckNsYXNzLA0KICAgICAg\nICAgICAgICAgIF9icm9rZXIuZ2V0Q2xhc3NMb2FkZXIoKSwgdHJ1ZSk7DQog\nICAgICAgICAgICBGaWVsZE1ldGFEYXRhIGZtZCA9IG1ldGEuZ2V0RmllbGQo\nZmllbGROYW1lKTsNCiAgICAgICAgICAgIGlmIChmbWQgPT0gbnVsbCkNCiAg\nICAgICAgICAgICAgICB0aHJvdyBuZXcgQXJndW1lbnRFeGNlcHRpb24oX2xv\nYy5nZXQoIm5vLW5hbWVkLWZpZWxkIiwNCiAgICAgICAgICAgICAgICAgICAg\nZm9yQ2xhc3MsIGZpZWxkTmFtZSksIG51bGwsIG51bGwsIGZhbHNlKTsNCg0K\nICAgICAgICAgICAgU2VxIHNlcSA9IF9icm9rZXIuZ2V0VmFsdWVTZXF1ZW5j\nZShmbWQpOw0KICAgICAgICAgICAgcmV0dXJuIChzZXEgPT0gbnVsbCkgPyBu\ndWxsIDogbmV3IEdlbmVyYXRvckltcGwoc2VxLCBudWxsLCBfYnJva2VyLA0K\nICAgICAgICAgICAgICAgIG1ldGEpOw0KICAgICAgICB9IGNhdGNoIChFeGNl\ncHRpb24gZSkgew0KICAgICAgICAgICAgdGhyb3cgUGVyc2lzdGVuY2VFeGNl\ncHRpb25zLnRvUGVyc2lzdGVuY2VFeGNlcHRpb24oZSk7DQogICAgICAgIH0N\nCiAgICB9DQoNCiAgICBwdWJsaWMgPFQ+IEV4dGVudDxUPiBjcmVhdGVFeHRl\nbnQoQ2xhc3M8VD4gY2xzLCBib29sZWFuIHN1YmNsYXNzZXMpIHsNCiAgICAg\nICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7DQogICAgICAgIHJldHVybiBu\nZXcgRXh0ZW50SW1wbDxUPih0aGlzLCBfYnJva2VyLm5ld0V4dGVudChjbHMs\nIHN1YmNsYXNzZXMpKTsNCiAgICB9DQoNCiAgICBwdWJsaWMgT3BlbkpQQVF1\nZXJ5IGNyZWF0ZVF1ZXJ5KFN0cmluZyBxdWVyeSkgew0KICAgICAgICByZXR1\ncm4gY3JlYXRlUXVlcnkoSlBRTFBhcnNlci5MQU5HX0pQUUwsIHF1ZXJ5KTsN\nCiAgICB9DQoNCiAgICBwdWJsaWMgT3BlbkpQQVF1ZXJ5IGNyZWF0ZVF1ZXJ5\nKFN0cmluZyBsYW5ndWFnZSwgU3RyaW5nIHF1ZXJ5KSB7DQogICAgICAgIGFz\nc2VydE5vdENsb3NlSW52b2tlZCgpOw0KICAgICAgICByZXR1cm4gbmV3IFF1\nZXJ5SW1wbCh0aGlzLCByZXQsIF9icm9rZXIubmV3UXVlcnkobGFuZ3VhZ2Us\nIHF1ZXJ5KSk7DQogICAgfQ0KDQogICAgcHVibGljIE9wZW5KUEFRdWVyeSBj\ncmVhdGVRdWVyeShRdWVyeSBxdWVyeSkgew0KICAgICAgICBpZiAocXVlcnkg\nPT0gbnVsbCkNCiAgICAgICAgICAgIHJldHVybiBjcmVhdGVRdWVyeSgoU3Ry\naW5nKSBudWxsKTsNCiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7\nDQogICAgICAgIG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuUXVlcnkgcSA9\nICgoUXVlcnlJbXBsKSBxdWVyeSkuZ2V0RGVsZWdhdGUoKTsNCiAgICAgICAg\ncmV0dXJuIG5ldyBRdWVyeUltcGwodGhpcywgcmV0LCBfYnJva2VyLm5ld1F1\nZXJ5KHEuZ2V0TGFuZ3VhZ2UoKSwNCiAgICAgICAgICAgIHEpKTsNCiAgICB9\nDQoNCiAgICBwdWJsaWMgT3BlbkpQQVF1ZXJ5IGNyZWF0ZU5hbWVkUXVlcnko\nU3RyaW5nIG5hbWUpIHsNCiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2Vk\nKCk7DQogICAgICAgIF9icm9rZXIuYXNzZXJ0T3BlbigpOw0KICAgICAgICB0\ncnkgew0KICAgICAgICAgICAgUXVlcnlNZXRhRGF0YSBtZXRhID0gX2Jyb2tl\nci5nZXRDb25maWd1cmF0aW9uKCkuDQogICAgICAgICAgICAgICAgZ2V0TWV0\nYURhdGFSZXBvc2l0b3J5SW5zdGFuY2UoKS5nZXRRdWVyeU1ldGFEYXRhKG51\nbGwsIG5hbWUsDQogICAgICAgICAgICAgICAgX2Jyb2tlci5nZXRDbGFzc0xv\nYWRlcigpLCB0cnVlKTsNCiAgICAgICAgICAgIG9yZy5hcGFjaGUub3Blbmpw\nYS5rZXJuZWwuUXVlcnkgZGVsID0NCiAgICAgICAgICAgICAgICBfYnJva2Vy\nLm5ld1F1ZXJ5KG1ldGEuZ2V0TGFuZ3VhZ2UoKSwgbnVsbCk7DQogICAgICAg\nICAgICBtZXRhLnNldEludG8oZGVsKTsNCiAgICAgICAgICAgIGRlbC5jb21w\naWxlKCk7DQoNCiAgICAgICAgICAgIE9wZW5KUEFRdWVyeSBxID0gbmV3IFF1\nZXJ5SW1wbCh0aGlzLCByZXQsIGRlbCk7DQogICAgICAgICAgICBTdHJpbmdb\nXSBoaW50cyA9IG1ldGEuZ2V0SGludEtleXMoKTsNCiAgICAgICAgICAgIE9i\namVjdFtdIHZhbHVlcyA9IG1ldGEuZ2V0SGludFZhbHVlcygpOw0KICAgICAg\nICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBoaW50cy5sZW5ndGg7IGkrKykN\nCiAgICAgICAgICAgICAgICBxLnNldEhpbnQoaGludHNbaV0sIHZhbHVlc1tp\nXSk7DQogICAgICAgICAgICByZXR1cm4gcTsNCiAgICAgICAgfSBjYXRjaCAo\nUnVudGltZUV4Y2VwdGlvbiByZSkgew0KICAgICAgICAgICAgdGhyb3cgUGVy\nc2lzdGVuY2VFeGNlcHRpb25zLnRvUGVyc2lzdGVuY2VFeGNlcHRpb24ocmUp\nOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgcHVibGljIE9wZW5KUEFRdWVy\neSBjcmVhdGVOYXRpdmVRdWVyeShTdHJpbmcgcXVlcnkpIHsNCiAgICAgICAg\ndmFsaWRhdGVTUUwocXVlcnkpOw0KICAgICAgICByZXR1cm4gY3JlYXRlUXVl\ncnkoUXVlcnlMYW5ndWFnZXMuTEFOR19TUUwsIHF1ZXJ5KTsNCiAgICB9DQoN\nCiAgICBwdWJsaWMgT3BlbkpQQVF1ZXJ5IGNyZWF0ZU5hdGl2ZVF1ZXJ5KFN0\ncmluZyBxdWVyeSwgQ2xhc3MgY2xzKSB7DQogICAgICAgIHJldHVybiBjcmVh\ndGVOYXRpdmVRdWVyeShxdWVyeSkuc2V0UmVzdWx0Q2xhc3MoY2xzKTsNCiAg\nICB9DQoNCiAgICBwdWJsaWMgT3BlbkpQQVF1ZXJ5IGNyZWF0ZU5hdGl2ZVF1\nZXJ5KFN0cmluZyBxdWVyeSwgU3RyaW5nIG1hcHBpbmdOYW1lKSB7DQogICAg\nICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOw0KICAgICAgICB2YWxpZGF0\nZVNRTChxdWVyeSk7DQogICAgICAgIG9yZy5hcGFjaGUub3BlbmpwYS5rZXJu\nZWwuUXVlcnkga2VybmVsUXVlcnkgPSBfYnJva2VyLm5ld1F1ZXJ5KA0KICAg\nICAgICAgICAgUXVlcnlMYW5ndWFnZXMuTEFOR19TUUwsIHF1ZXJ5KTsNCiAg\nICAgICAga2VybmVsUXVlcnkuc2V0UmVzdWx0TWFwcGluZyhudWxsLCBtYXBw\naW5nTmFtZSk7DQogICAgICAgIHJldHVybiBuZXcgUXVlcnlJbXBsKHRoaXMs\nIHJldCwga2VybmVsUXVlcnkpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAq\nIFZhbGlkYXRlIHRoYXQgdGhlIHVzZXIgcHJvdmlkZWQgU1FMLg0KICAgICAq\nLw0KICAgIHByaXZhdGUgc3RhdGljIHZvaWQgdmFsaWRhdGVTUUwoU3RyaW5n\nIHF1ZXJ5KSB7DQogICAgICAgIGlmIChTdHJpbmdVdGlscy50cmltVG9OdWxs\nKHF1ZXJ5KSA9PSBudWxsKQ0KICAgICAgICAgICAgdGhyb3cgbmV3IEFyZ3Vt\nZW50RXhjZXB0aW9uKF9sb2MuZ2V0KCJuby1zcWwiKSwgbnVsbCwgbnVsbCwg\nZmFsc2UpOw0KICAgIH0NCg0KICAgIHB1YmxpYyB2b2lkIHNldEZsdXNoTW9k\nZShGbHVzaE1vZGVUeXBlIGZsdXNoTW9kZSkgew0KICAgICAgICBhc3NlcnRO\nb3RDbG9zZUludm9rZWQoKTsNCiAgICAgICAgX2Jyb2tlci5hc3NlcnRPcGVu\nKCk7DQogICAgICAgIF9icm9rZXIuZ2V0RmV0Y2hDb25maWd1cmF0aW9uKCku\nc2V0Rmx1c2hCZWZvcmVRdWVyaWVzDQogICAgICAgICAgICAodG9GbHVzaEJl\nZm9yZVF1ZXJpZXMoZmx1c2hNb2RlKSk7DQogICAgfQ0KDQogICAgcHVibGlj\nIEZsdXNoTW9kZVR5cGUgZ2V0Rmx1c2hNb2RlKCkgew0KICAgICAgICBhc3Nl\ncnROb3RDbG9zZUludm9rZWQoKTsNCiAgICAgICAgX2Jyb2tlci5hc3NlcnRP\ncGVuKCk7DQogICAgICAgIHJldHVybiBmcm9tRmx1c2hCZWZvcmVRdWVyaWVz\nKF9icm9rZXIuZ2V0RmV0Y2hDb25maWd1cmF0aW9uKCkuDQogICAgICAgICAg\nICBnZXRGbHVzaEJlZm9yZVF1ZXJpZXMoKSk7DQogICAgfQ0KDQogICAgLyoq\nDQogICAgICogVHJhbnNsYXRlIG91ciBpbnRlcm5hbCBmbHVzaCBjb25zdGFu\ndCB0byBhIGZsdXNoIG1vZGUgZW51bSB2YWx1ZS4NCiAgICAgKi8NCiAgICBz\ndGF0aWMgRmx1c2hNb2RlVHlwZSBmcm9tRmx1c2hCZWZvcmVRdWVyaWVzKGlu\ndCBmbHVzaCkgew0KICAgICAgICBzd2l0Y2ggKGZsdXNoKSB7DQogICAgICAg\nICAgICBjYXNlIFF1ZXJ5Rmx1c2hNb2Rlcy5GTFVTSF9UUlVFOg0KICAgICAg\nICAgICAgICAgIHJldHVybiBGbHVzaE1vZGVUeXBlLkFVVE87DQogICAgICAg\nICAgICBjYXNlIFF1ZXJ5Rmx1c2hNb2Rlcy5GTFVTSF9GQUxTRToNCiAgICAg\nICAgICAgICAgICByZXR1cm4gRmx1c2hNb2RlVHlwZS5DT01NSVQ7DQogICAg\nICAgICAgICBkZWZhdWx0Og0KICAgICAgICAgICAgICAgIHJldHVybiBudWxs\nOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgLyoqDQogICAgICogVHJhbnNs\nYXRlIGEgZmx1c2ggbW9kZSBlbnVtIHZhbHVlIHRvIG91ciBpbnRlcm5hbCBm\nbHVzaCBjb25zdGFudC4NCiAgICAgKi8NCiAgICBzdGF0aWMgaW50IHRvRmx1\nc2hCZWZvcmVRdWVyaWVzKEZsdXNoTW9kZVR5cGUgZmx1c2hNb2RlKSB7DQog\nICAgICAgIC8vIGNob29zZSBkZWZhdWx0IGZvciBudWxsDQogICAgICAgIGlm\nIChmbHVzaE1vZGUgPT0gbnVsbCkNCiAgICAgICAgICAgIHJldHVybiBRdWVy\neUZsdXNoTW9kZXMuRkxVU0hfV0lUSF9DT05ORUNUSU9OOw0KICAgICAgICBp\nZiAoZmx1c2hNb2RlID09IEZsdXNoTW9kZVR5cGUuQVVUTykNCiAgICAgICAg\nICAgIHJldHVybiBRdWVyeUZsdXNoTW9kZXMuRkxVU0hfVFJVRTsNCiAgICAg\nICAgaWYgKGZsdXNoTW9kZSA9PSBGbHVzaE1vZGVUeXBlLkNPTU1JVCkNCiAg\nICAgICAgICAgIHJldHVybiBRdWVyeUZsdXNoTW9kZXMuRkxVU0hfRkFMU0U7\nDQogICAgICAgIHRocm93IG5ldyBBcmd1bWVudEV4Y2VwdGlvbihmbHVzaE1v\nZGUudG9TdHJpbmcoKSwgbnVsbCwgbnVsbCwgZmFsc2UpOw0KICAgIH0NCg0K\nICAgIHB1YmxpYyB2b2lkIGNsZWFyKCkgew0KICAgICAgICBhc3NlcnROb3RD\nbG9zZUludm9rZWQoKTsNCiAgICAgICAgX2Jyb2tlci5kZXRhY2hBbGwodGhp\ncywgZmFsc2UpOw0KICAgIH0NCg0KICAgIHB1YmxpYyBPYmplY3QgZ2V0RGVs\nZWdhdGUoKSB7DQogICAgICAgIF9icm9rZXIuYXNzZXJ0T3BlbigpOw0KICAg\nICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsNCiAgICAgICAgcmV0dXJu\nIHRoaXM7DQogICAgfQ0KDQogICAgcHVibGljIExvY2tNb2RlVHlwZSBnZXRM\nb2NrTW9kZShPYmplY3QgZW50aXR5KSB7DQogICAgICAgIGFzc2VydE5vdENs\nb3NlSW52b2tlZCgpOw0KICAgICAgICByZXR1cm4gZnJvbUxvY2tMZXZlbChf\nYnJva2VyLmdldExvY2tMZXZlbChlbnRpdHkpKTsNCiAgICB9DQoNCiAgICBw\ndWJsaWMgdm9pZCBsb2NrKE9iamVjdCBlbnRpdHksIExvY2tNb2RlVHlwZSBt\nb2RlKSB7DQogICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOw0KICAg\nICAgICBfYnJva2VyLmxvY2soZW50aXR5LCB0b0xvY2tMZXZlbChtb2RlKSwg\nLTEsIHRoaXMpOw0KICAgIH0NCg0KICAgIHB1YmxpYyB2b2lkIGxvY2soT2Jq\nZWN0IGVudGl0eSkgew0KICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQo\nKTsNCiAgICAgICAgX2Jyb2tlci5sb2NrKGVudGl0eSwgdGhpcyk7DQogICAg\nfQ0KDQogICAgcHVibGljIHZvaWQgbG9jayhPYmplY3QgZW50aXR5LCBMb2Nr\nTW9kZVR5cGUgbW9kZSwgaW50IHRpbWVvdXQpIHsNCiAgICAgICAgYXNzZXJ0\nTm90Q2xvc2VJbnZva2VkKCk7DQogICAgICAgIF9icm9rZXIubG9jayhlbnRp\ndHksIHRvTG9ja0xldmVsKG1vZGUpLCB0aW1lb3V0LCB0aGlzKTsNCiAgICB9\nDQoNCiAgICBwdWJsaWMgdm9pZCBsb2NrQWxsKENvbGxlY3Rpb24gZW50aXRp\nZXMpIHsNCiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7DQogICAg\nICAgIF9icm9rZXIubG9ja0FsbChlbnRpdGllcywgdGhpcyk7DQogICAgfQ0K\nDQogICAgcHVibGljIHZvaWQgbG9ja0FsbChDb2xsZWN0aW9uIGVudGl0aWVz\nLCBMb2NrTW9kZVR5cGUgbW9kZSwgaW50IHRpbWVvdXQpIHsNCiAgICAgICAg\nYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7DQogICAgICAgIF9icm9rZXIubG9j\na0FsbChlbnRpdGllcywgdG9Mb2NrTGV2ZWwobW9kZSksIHRpbWVvdXQsIHRo\naXMpOw0KICAgIH0NCg0KICAgIHB1YmxpYyB2b2lkIGxvY2tBbGwoT2JqZWN0\nLi4uIGVudGl0aWVzKSB7DQogICAgICAgIGxvY2tBbGwoQXJyYXlzLmFzTGlz\ndChlbnRpdGllcykpOw0KICAgIH0NCg0KICAgIHB1YmxpYyB2b2lkIGxvY2tB\nbGwoT2JqZWN0W10gZW50aXRpZXMsIExvY2tNb2RlVHlwZSBtb2RlLCBpbnQg\ndGltZW91dCkgew0KICAgICAgICBsb2NrQWxsKEFycmF5cy5hc0xpc3QoZW50\naXRpZXMpLCBtb2RlLCB0aW1lb3V0KTsNCiAgICB9DQoNCiAgICAvKioNCiAg\nICAgKiBUcmFuc2xhdGUgb3VyIGludGVybmFsIGxvY2sgbGV2ZWwgdG8gYSBq\nYXZheC5wZXJzaXN0ZW5jZSBlbnVtIHZhbHVlLg0KICAgICAqLw0KICAgIHN0\nYXRpYyBMb2NrTW9kZVR5cGUgZnJvbUxvY2tMZXZlbChpbnQgbGV2ZWwpIHsN\nCiAgICAgICAgaWYgKGxldmVsIDwgTG9ja0xldmVscy5MT0NLX1JFQUQpDQog\nICAgICAgICAgICByZXR1cm4gbnVsbDsNCiAgICAgICAgaWYgKGxldmVsIDwg\nTG9ja0xldmVscy5MT0NLX1dSSVRFKQ0KICAgICAgICAgICAgcmV0dXJuIExv\nY2tNb2RlVHlwZS5SRUFEOw0KICAgICAgICByZXR1cm4gTG9ja01vZGVUeXBl\nLldSSVRFOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIFRyYW5zbGF0ZSB0\naGUgamF2YXgucGVyc2lzdGVuY2UgZW51bSB2YWx1ZSB0byBvdXIgaW50ZXJu\nYWwgbG9jayBsZXZlbC4NCiAgICAgKi8NCiAgICBzdGF0aWMgaW50IHRvTG9j\na0xldmVsKExvY2tNb2RlVHlwZSBtb2RlKSB7DQogICAgICAgIGlmIChtb2Rl\nID09IG51bGwpDQogICAgICAgICAgICByZXR1cm4gTG9ja0xldmVscy5MT0NL\nX05PTkU7DQogICAgICAgIGlmIChtb2RlID09IExvY2tNb2RlVHlwZS5SRUFE\nKQ0KICAgICAgICAgICAgcmV0dXJuIExvY2tMZXZlbHMuTE9DS19SRUFEOw0K\nICAgICAgICBpZiAobW9kZSA9PSBMb2NrTW9kZVR5cGUuV1JJVEUpDQogICAg\nICAgICAgICByZXR1cm4gTG9ja0xldmVscy5MT0NLX1dSSVRFOw0KICAgICAg\nICB0aHJvdyBuZXcgQXJndW1lbnRFeGNlcHRpb24obW9kZS50b1N0cmluZygp\nLCBudWxsLCBudWxsLCB0cnVlKTsNCiAgICB9DQoNCiAgICBwdWJsaWMgYm9v\nbGVhbiBjYW5jZWxBbGwoKSB7DQogICAgICAgIHJldHVybiBfYnJva2VyLmNh\nbmNlbEFsbCgpOw0KICAgIH0NCg0KICAgIHB1YmxpYyBPYmplY3QgZ2V0Q29u\nbmVjdGlvbigpIHsNCiAgICAgICAgcmV0dXJuIF9icm9rZXIuZ2V0Q29ubmVj\ndGlvbigpOw0KICAgIH0NCg0KICAgIHB1YmxpYyBDb2xsZWN0aW9uIGdldE1h\nbmFnZWRPYmplY3RzKCkgew0KICAgICAgICByZXR1cm4gX2Jyb2tlci5nZXRN\nYW5hZ2VkT2JqZWN0cygpOw0KICAgIH0NCg0KICAgIHB1YmxpYyBDb2xsZWN0\naW9uIGdldFRyYW5zYWN0aW9uYWxPYmplY3RzKCkgew0KICAgICAgICByZXR1\ncm4gX2Jyb2tlci5nZXRUcmFuc2FjdGlvbmFsT2JqZWN0cygpOw0KICAgIH0N\nCg0KICAgIHB1YmxpYyBDb2xsZWN0aW9uIGdldFBlbmRpbmdUcmFuc2FjdGlv\nbmFsT2JqZWN0cygpIHsNCiAgICAgICAgcmV0dXJuIF9icm9rZXIuZ2V0UGVu\nZGluZ1RyYW5zYWN0aW9uYWxPYmplY3RzKCk7DQogICAgfQ0KDQogICAgcHVi\nbGljIENvbGxlY3Rpb24gZ2V0RGlydHlPYmplY3RzKCkgew0KICAgICAgICBy\nZXR1cm4gX2Jyb2tlci5nZXREaXJ0eU9iamVjdHMoKTsNCiAgICB9DQoNCiAg\nICBwdWJsaWMgYm9vbGVhbiBnZXRPcmRlckRpcnR5T2JqZWN0cygpIHsNCiAg\nICAgICAgcmV0dXJuIF9icm9rZXIuZ2V0T3JkZXJEaXJ0eU9iamVjdHMoKTsN\nCiAgICB9DQoNCiAgICBwdWJsaWMgdm9pZCBzZXRPcmRlckRpcnR5T2JqZWN0\ncyhib29sZWFuIG9yZGVyKSB7DQogICAgICAgIGFzc2VydE5vdENsb3NlSW52\nb2tlZCgpOw0KICAgICAgICBfYnJva2VyLnNldE9yZGVyRGlydHlPYmplY3Rz\nKG9yZGVyKTsNCiAgICB9DQoNCiAgICBwdWJsaWMgdm9pZCBkaXJ0eUNsYXNz\nKENsYXNzIGNscykgew0KICAgICAgICBhc3NlcnROb3RDbG9zZUludm9rZWQo\nKTsNCiAgICAgICAgX2Jyb2tlci5kaXJ0eVR5cGUoY2xzKTsNCiAgICB9DQoN\nCiAgICBAU3VwcHJlc3NXYXJuaW5ncygidW5jaGVja2VkIikNCiAgICBwdWJs\naWMgQ29sbGVjdGlvbjxDbGFzcz4gZ2V0UGVyc2lzdGVkQ2xhc3NlcygpIHsN\nCiAgICAgICAgcmV0dXJuIChDb2xsZWN0aW9uPENsYXNzPikgX2Jyb2tlci5n\nZXRQZXJzaXN0ZWRUeXBlcygpOw0KICAgIH0NCg0KICAgIEBTdXBwcmVzc1dh\ncm5pbmdzKCJ1bmNoZWNrZWQiKQ0KICAgIHB1YmxpYyBDb2xsZWN0aW9uPENs\nYXNzPiBnZXRVcGRhdGVkQ2xhc3NlcygpIHsNCiAgICAgICAgcmV0dXJuIChD\nb2xsZWN0aW9uPENsYXNzPikgX2Jyb2tlci5nZXRVcGRhdGVkVHlwZXMoKTsN\nCiAgICB9DQoNCiAgICBAU3VwcHJlc3NXYXJuaW5ncygidW5jaGVja2VkIikN\nCiAgICBwdWJsaWMgQ29sbGVjdGlvbjxDbGFzcz4gZ2V0UmVtb3ZlZENsYXNz\nZXMoKSB7DQogICAgICAgIHJldHVybiAoQ29sbGVjdGlvbjxDbGFzcz4pIF9i\ncm9rZXIuZ2V0RGVsZXRlZFR5cGVzKCk7DQogICAgfQ0KDQogICAgcHVibGlj\nIDxUPiBUIGNyZWF0ZUluc3RhbmNlKENsYXNzPFQ+IGNscykgew0KICAgICAg\nICBhc3NlcnROb3RDbG9zZUludm9rZWQoKTsNCiAgICAgICAgcmV0dXJuIChU\nKSBfYnJva2VyLm5ld0luc3RhbmNlKGNscyk7DQogICAgfQ0KDQogICAgcHVi\nbGljIHZvaWQgY2xvc2UoKSB7DQogICAgICAgIGFzc2VydE5vdENsb3NlSW52\nb2tlZCgpOw0KICAgICAgICBfYnJva2VyLmNsb3NlKCk7DQogICAgfQ0KDQog\nICAgcHVibGljIGJvb2xlYW4gaXNPcGVuKCkgew0KICAgICAgICByZXR1cm4g\nIV9icm9rZXIuaXNDbG9zZUludm9rZWQoKTsNCiAgICB9DQoNCiAgICBwdWJs\naWMgdm9pZCBkaXJ0eShPYmplY3QgbywgU3RyaW5nIGZpZWxkKSB7DQogICAg\nICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOw0KICAgICAgICBPcGVuSlBB\nU3RhdGVNYW5hZ2VyIHNtID0gX2Jyb2tlci5nZXRTdGF0ZU1hbmFnZXIobyk7\nDQogICAgICAgIHRyeSB7DQogICAgICAgICAgICBpZiAoc20gIT0gbnVsbCkN\nCiAgICAgICAgICAgICAgICBzbS5kaXJ0eShmaWVsZCk7DQogICAgICAgIH0g\nY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7DQogICAgICAgICAgICB0aHJvdyBQZXJz\naXN0ZW5jZUV4Y2VwdGlvbnMudG9QZXJzaXN0ZW5jZUV4Y2VwdGlvbihlKTsN\nCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIHB1YmxpYyBPYmplY3QgZ2V0T2Jq\nZWN0SWQoT2JqZWN0IG8pIHsNCiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZv\na2VkKCk7DQogICAgICAgIHJldHVybiBKUEFGYWNhZGVIZWxwZXIuZnJvbU9w\nZW5KUEFPYmplY3RJZChfYnJva2VyLmdldE9iamVjdElkKG8pKTsNCiAgICB9\nDQoNCiAgICBwdWJsaWMgYm9vbGVhbiBpc0RpcnR5KE9iamVjdCBvKSB7DQog\nICAgICAgIGFzc2VydE5vdENsb3NlSW52b2tlZCgpOw0KICAgICAgICByZXR1\ncm4gX2Jyb2tlci5pc0RpcnR5KG8pOw0KICAgIH0NCg0KICAgIHB1YmxpYyBi\nb29sZWFuIGlzVHJhbnNhY3Rpb25hbChPYmplY3Qgbykgew0KICAgICAgICBh\nc3NlcnROb3RDbG9zZUludm9rZWQoKTsNCiAgICAgICAgcmV0dXJuIF9icm9r\nZXIuaXNUcmFuc2FjdGlvbmFsKG8pOw0KICAgIH0NCg0KICAgIHB1YmxpYyBi\nb29sZWFuIGlzUGVyc2lzdGVudChPYmplY3Qgbykgew0KICAgICAgICBhc3Nl\ncnROb3RDbG9zZUludm9rZWQoKTsNCiAgICAgICAgcmV0dXJuIF9icm9rZXIu\naXNQZXJzaXN0ZW50KG8pOw0KICAgIH0NCg0KICAgIHB1YmxpYyBib29sZWFu\nIGlzTmV3bHlQZXJzaXN0ZW50KE9iamVjdCBvKSB7DQogICAgICAgIGFzc2Vy\ndE5vdENsb3NlSW52b2tlZCgpOw0KICAgICAgICByZXR1cm4gX2Jyb2tlci5p\nc05ldyhvKTsNCiAgICB9DQoNCiAgICBwdWJsaWMgYm9vbGVhbiBpc1JlbW92\nZWQoT2JqZWN0IG8pIHsNCiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2Vk\nKCk7DQogICAgICAgIHJldHVybiBfYnJva2VyLmlzRGVsZXRlZChvKTsNCiAg\nICB9DQoNCiAgICBwdWJsaWMgYm9vbGVhbiBpc0RldGFjaGVkKE9iamVjdCBl\nbnRpdHkpIHsNCiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7DQog\nICAgICAgIHJldHVybiBfYnJva2VyLmlzRGV0YWNoZWQoZW50aXR5KTsNCiAg\nICB9DQoNCiAgICBwdWJsaWMgT2JqZWN0IGdldFZlcnNpb24oT2JqZWN0IG8p\nIHsNCiAgICAgICAgYXNzZXJ0Tm90Q2xvc2VJbnZva2VkKCk7DQogICAgICAg\nIHJldHVybiBfYnJva2VyLmdldFZlcnNpb24obyk7DQogICAgfQ0KDQogICAg\nLyoqDQogICAgICogVGhyb3cgYXBwcm9wcmlhdGUgZXhjZXB0aW9uIGlmIGNs\nb3NlIGhhcyBiZWVuIGludm9rZWQgYnV0IHRoZSBicm9rZXINCiAgICAgKiBp\ncyBzdGlsbCBvcGVuLiAgV2UgdGVzdCBvbmx5IGZvciB0aGlzIGJlY2F1c2Ug\naWYgdGhlIGJyb2tlciBpcyBhbHJlYWR5DQogICAgICogY2xvc2VkLCBpdCB3\naWxsIHRocm93IGl0cyBvd24gbW9yZSBpbmZvcm1hdGl2ZSBleGNlcHRpb24g\nd2hlbiB3ZSANCiAgICAgKiBkZWxlZ2F0ZSB0aGUgcGVuZGluZyBvcGVyYXRp\nb24gdG8gaXQuDQogICAgICovDQogICAgdm9pZCBhc3NlcnROb3RDbG9zZUlu\ndm9rZWQoKSB7DQogICAgICAgIGlmICghX2Jyb2tlci5pc0Nsb3NlZCgpICYm\nIF9icm9rZXIuaXNDbG9zZUludm9rZWQoKSkNCiAgICAgICAgICAgIHRocm93\nIG5ldyBJbnZhbGlkU3RhdGVFeGNlcHRpb24oX2xvYy5nZXQoImNsb3NlLWlu\ndm9rZWQiKSwgbnVsbCwNCiAgICAgICAgICAgICAgICBudWxsLCB0cnVlKTsN\nCiAgICB9DQoNCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v\nLw0KICAgIC8vIEZpbmRDYWxsYmFja3MgaW1wbGVtZW50YXRpb24NCiAgICAv\nLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLw0KDQogICAgcHVibGlj\nIE9iamVjdCBwcm9jZXNzQXJndW1lbnQoT2JqZWN0IGFyZykgew0KICAgICAg\nICByZXR1cm4gYXJnOw0KICAgIH0NCg0KICAgIHB1YmxpYyBPYmplY3QgcHJv\nY2Vzc1JldHVybihPYmplY3Qgb2lkLCBPcGVuSlBBU3RhdGVNYW5hZ2VyIHNt\nKSB7DQogICAgICAgIHJldHVybiAoc20gPT0gbnVsbCB8fCBzbS5pc0RlbGV0\nZWQoKSkgPyBudWxsIDogc20uZ2V0TWFuYWdlZEluc3RhbmNlKCk7DQogICAg\nfQ0KDQogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vDQogICAg\nLy8gT3BDYWxsYmFja3MgaW1wbGVtZW50YXRpb24NCiAgICAvLy8vLy8vLy8v\nLy8vLy8vLy8vLy8vLy8vLy8vLy8NCg0KICAgIHB1YmxpYyBpbnQgcHJvY2Vz\nc0FyZ3VtZW50KGludCBvcCwgT2JqZWN0IG9iaiwgT3BlbkpQQVN0YXRlTWFu\nYWdlciBzbSkgew0KICAgICAgICBzd2l0Y2ggKG9wKSB7DQogICAgICAgICAg\nICBjYXNlIE9QX0RFTEVURToNCiAgICAgICAgICAgICAgICAvLyBjYXNjYWRl\nIHRocm91Z2ggbm9uLXBlcnNpc3RlbnQgbm9uLWRldGFjaGVkIGluc3RhbmNl\ncw0KICAgICAgICAgICAgICAgIGlmIChzbSA9PSBudWxsICYmICFfYnJva2Vy\nLmlzRGV0YWNoZWQob2JqKSkNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJu\nIEFDVF9DQVNDQURFOw0KICAgICAgICAgICAgICAgIGlmIChzbSAhPSBudWxs\nICYmICFzbS5pc0RldGFjaGVkKCkgJiYgIXNtLmlzUGVyc2lzdGVudCgpKQ0K\nICAgICAgICAgICAgICAgICAgICByZXR1cm4gQUNUX0NBU0NBREU7DQogICAg\nICAgICAgICAgICAgLy8gaWdub3JlIGRlbGV0ZWQgaW5zdGFuY2VzDQogICAg\nICAgICAgICAgICAgaWYgKHNtICE9IG51bGwgJiYgc20uaXNEZWxldGVkKCkp\nDQogICAgICAgICAgICAgICAgICAgIHJldHVybiBBQ1RfTk9ORTsNCiAgICAg\nICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGNhc2UgT1BfQVRUQUNI\nOg0KICAgICAgICAgICAgICAgIC8vIGRpZSBvbiByZW1vdmVkDQogICAgICAg\nICAgICAgICAgaWYgKHNtICE9IG51bGwgJiYgc20uaXNEZWxldGVkKCkpDQog\nICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBVc2VyRXhjZXB0aW9uKF9s\nb2MuZ2V0KCJyZW1vdmVkIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIEV4\nY2VwdGlvbnMudG9TdHJpbmcob2JqKSkpLnNldEZhaWxlZE9iamVjdChvYmop\nOw0KICAgICAgICAgICAgICAgIC8vIGNhc2NhZGUgdGhyb3VnaCBtYW5hZ2Vk\nIGluc3RhbmNlcw0KICAgICAgICAgICAgICAgIGlmIChzbSAhPSBudWxsICYm\nICFzbS5pc0RldGFjaGVkKCkpDQogICAgICAgICAgICAgICAgICAgIHJldHVy\nbiBBQ1RfQ0FTQ0FERTsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAg\nICAgICAgIGNhc2UgT1BfUkVGUkVTSDoNCiAgICAgICAgICAgICAgICAvLyBk\naWUgb24gdW5tYW5hZ2VkIGluc3RhbmNlcw0KICAgICAgICAgICAgICAgIGlm\nIChzbSA9PSBudWxsKQ0KICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcg\nVXNlckV4Y2VwdGlvbihfbG9jLmdldCgibm90LW1hbmFnZWQiLA0KICAgICAg\nICAgICAgICAgICAgICAgICAgRXhjZXB0aW9ucy50b1N0cmluZyhvYmopKSku\nc2V0RmFpbGVkT2JqZWN0KG9iaik7DQogICAgICAgICAgICAgICAgYnJlYWs7\nDQogICAgICAgIH0NCiAgICAgICAgcmV0dXJuIEFDVF9SVU4gfCBBQ1RfQ0FT\nQ0FERTsNCiAgICB9DQoNCiAgICBwdWJsaWMgaW50IGhhc2hDb2RlKCkgew0K\nICAgICAgICByZXR1cm4gX2Jyb2tlci5oYXNoQ29kZSgpOw0KICAgIH0NCg0K\nICAgIHB1YmxpYyBib29sZWFuIGVxdWFscyhPYmplY3Qgb3RoZXIpIHsNCiAg\nICAgICAgaWYgKG90aGVyID09IHRoaXMpDQogICAgICAgICAgICByZXR1cm4g\ndHJ1ZTsNCiAgICAgICAgaWYgKCEob3RoZXIgaW5zdGFuY2VvZiBFbnRpdHlN\nYW5hZ2VySW1wbCkpDQogICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAg\nICAgIHJldHVybiBfYnJva2VyLmVxdWFscygoKEVudGl0eU1hbmFnZXJJbXBs\nKSBvdGhlcikuX2Jyb2tlcik7DQogICAgfQ0KDQogICAgcHVibGljIHZvaWQg\ncmVhZEV4dGVybmFsKE9iamVjdElucHV0IGluKQ0KICAgICAgICB0aHJvd3Mg\nSU9FeGNlcHRpb24sIENsYXNzTm90Rm91bmRFeGNlcHRpb24gew0KICAgICAg\nICB0cnkgew0KICAgICAgICAgICAgcmV0ID0gUGVyc2lzdGVuY2VFeGNlcHRp\nb25zLmdldFJvbGxiYWNrVHJhbnNsYXRvcih0aGlzKTsNCg0KICAgICAgICAg\nICAgLy8gdGhpcyBhc3N1bWVzIHRoYXQgc2VyaWFsaXplZCBCcm9rZXJzIGFy\nZSBmcm9tIHNvbWV0aGluZw0KICAgICAgICAgICAgLy8gdGhhdCBleHRlbmRz\nIEFic3RyYWN0QnJva2VyRmFjdG9yeS4NCiAgICAgICAgICAgIE9iamVjdCBm\nYWN0b3J5S2V5ID0gaW4ucmVhZE9iamVjdCgpOw0KICAgICAgICAgICAgQWJz\ndHJhY3RCcm9rZXJGYWN0b3J5IGZhY3RvcnkgPQ0KICAgICAgICAgICAgICAg\nIEFic3RyYWN0QnJva2VyRmFjdG9yeS5nZXRQb29sZWRGYWN0b3J5Rm9yS2V5\nKGZhY3RvcnlLZXkpOw0KICAgICAgICAgICAgYnl0ZVtdIGJyb2tlckJ5dGVz\nID0gKGJ5dGVbXSkgaW4ucmVhZE9iamVjdCgpOw0KICAgICAgICAgICAgT2Jq\nZWN0SW5wdXRTdHJlYW0gaW5uZXJJbiA9IG5ldyBCcm9rZXJCeXRlc0lucHV0\nU3RyZWFtKGJyb2tlckJ5dGVzLA0KICAgICAgICAgICAgICAgIGZhY3Rvcnku\nZ2V0Q29uZmlndXJhdGlvbigpKTsNCg0KICAgICAgICAgICAgQnJva2VyIGJy\nb2tlciA9IChCcm9rZXIpIGlubmVySW4ucmVhZE9iamVjdCgpOw0KICAgICAg\nICAgICAgRW50aXR5TWFuYWdlckZhY3RvcnlJbXBsIGVtZiA9IChFbnRpdHlN\nYW5hZ2VyRmFjdG9yeUltcGwpDQogICAgICAgICAgICAgICAgSlBBRmFjYWRl\nSGVscGVyLnRvRW50aXR5TWFuYWdlckZhY3RvcnkoDQogICAgICAgICAgICAg\nICAgICAgIGJyb2tlci5nZXRCcm9rZXJGYWN0b3J5KCkpOw0KICAgICAgICAg\nICAgYnJva2VyLnB1dFVzZXJPYmplY3QoSlBBRmFjYWRlSGVscGVyLkVNX0tF\nWSwgdGhpcyk7DQogICAgICAgICAgICBpbml0aWFsaXplKGVtZiwgYnJva2Vy\nKTsNCiAgICAgICAgfSBjYXRjaCAoUnVudGltZUV4Y2VwdGlvbiByZSkgew0K\nICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgICByZSA9IHJldC50\ncmFuc2xhdGUocmUpOw0KICAgICAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9u\nIGUpIHsNCiAgICAgICAgICAgICAgICAvLyBpZ25vcmUNCiAgICAgICAgICAg\nIH0NCiAgICAgICAgICAgIHRocm93IHJlOw0KICAgICAgICB9DQogICAgfQ0K\nDQogICAgcHVibGljIHZvaWQgd3JpdGVFeHRlcm5hbChPYmplY3RPdXRwdXQg\nb3V0KSB0aHJvd3MgSU9FeGNlcHRpb24gew0KICAgICAgICB0cnkgew0KICAg\nICAgICAgICAgLy8gdGhpcyByZXF1aXJlcyB0aGF0IG9ubHkgQWJzdHJhY3RC\ncm9rZXJGYWN0b3J5LXNvdXJjZWQNCiAgICAgICAgICAgIC8vIGJyb2tlcnMg\nY2FuIGJlIHNlcmlhbGl6ZWQNCiAgICAgICAgICAgIE9iamVjdCBmYWN0b3J5\nS2V5ID0gKChBYnN0cmFjdEJyb2tlckZhY3RvcnkpIF9icm9rZXINCiAgICAg\nICAgICAgICAgICAuZ2V0QnJva2VyRmFjdG9yeSgpKS5nZXRQb29sS2V5KCk7\nDQogICAgICAgICAgICBvdXQud3JpdGVPYmplY3QoZmFjdG9yeUtleSk7DQog\nICAgICAgICAgICBCeXRlQXJyYXlPdXRwdXRTdHJlYW0gYmFvcyA9IG5ldyBC\neXRlQXJyYXlPdXRwdXRTdHJlYW0oKTsNCiAgICAgICAgICAgIE9iamVjdE91\ndHB1dFN0cmVhbSBpbm5lck91dCA9IG5ldyBPYmplY3RPdXRwdXRTdHJlYW0o\nYmFvcyk7DQogICAgICAgICAgICBpbm5lck91dC53cml0ZU9iamVjdChfYnJv\na2VyLmdldERlbGVnYXRlKCkpOw0KICAgICAgICAgICAgaW5uZXJPdXQuZmx1\nc2goKTsNCiAgICAgICAgICAgIG91dC53cml0ZU9iamVjdChiYW9zLnRvQnl0\nZUFycmF5KCkpOw0KICAgICAgICB9IGNhdGNoIChSdW50aW1lRXhjZXB0aW9u\nIHJlKSB7DQogICAgICAgICAgICB0cnkgew0KICAgICAgICAgICAgICAgIHJl\nID0gcmV0LnRyYW5zbGF0ZShyZSk7DQogICAgICAgICAgICB9IGNhdGNoIChF\neGNlcHRpb24gZSkgew0KICAgICAgICAgICAgICAgIC8vIGlnbm9yZQ0KICAg\nICAgICAgICAgfQ0KICAgICAgICAgICAgdGhyb3cgcmU7DQogICAgICAgIH0N\nCiAgICB9DQoNCiAgICBwcml2YXRlIHN0YXRpYyBjbGFzcyBCcm9rZXJCeXRl\nc0lucHV0U3RyZWFtIGV4dGVuZHMgT2JqZWN0SW5wdXRTdHJlYW0gew0KDQog\nICAgICAgIHByaXZhdGUgT3BlbkpQQUNvbmZpZ3VyYXRpb24gY29uZjsNCg0K\nICAgICAgICBCcm9rZXJCeXRlc0lucHV0U3RyZWFtKGJ5dGVbXSBieXRlcywg\nT3BlbkpQQUNvbmZpZ3VyYXRpb24gY29uZikNCiAgICAgICAgICAgIHRocm93\ncyBJT0V4Y2VwdGlvbiB7DQogICAgICAgICAgICBzdXBlcihuZXcgQnl0ZUFy\ncmF5SW5wdXRTdHJlYW0oYnl0ZXMpKTsNCiAgICAgICAgICAgIGlmIChjb25m\nID09IG51bGwpDQogICAgICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxB\ncmd1bWVudEV4Y2VwdGlvbigNCiAgICAgICAgICAgICAgICAgICAgIklsbGVn\nYWwgbnVsbCBhcmd1bWVudCB0byBPYmplY3RJbnB1dFN0cmVhbVdpdGhMb2Fk\nZXIiKTsNCiAgICAgICAgICAgIHRoaXMuY29uZiA9IGNvbmY7DQogICAgICAg\nIH0NCg0KICAgICAgICAvKioNCiAgICAgICAgICogTWFrZSBhIHByaW1pdGl2\nZSBhcnJheSBjbGFzcw0KICAgICAgICAgKi8NCiAgICAgICAgcHJpdmF0ZSBD\nbGFzcyBwcmltaXRpdmVUeXBlKGNoYXIgdHlwZSkgew0KICAgICAgICAgICAg\nc3dpdGNoICh0eXBlKSB7DQogICAgICAgICAgICAgICAgY2FzZSAnQic6IHJl\ndHVybiBieXRlLmNsYXNzOw0KICAgICAgICAgICAgICAgIGNhc2UgJ0MnOiBy\nZXR1cm4gY2hhci5jbGFzczsNCiAgICAgICAgICAgICAgICBjYXNlICdEJzog\ncmV0dXJuIGRvdWJsZS5jbGFzczsNCiAgICAgICAgICAgICAgICBjYXNlICdG\nJzogcmV0dXJuIGZsb2F0LmNsYXNzOw0KICAgICAgICAgICAgICAgIGNhc2Ug\nJ0knOiByZXR1cm4gaW50LmNsYXNzOw0KICAgICAgICAgICAgICAgIGNhc2Ug\nJ0onOiByZXR1cm4gbG9uZy5jbGFzczsNCiAgICAgICAgICAgICAgICBjYXNl\nICdTJzogcmV0dXJuIHNob3J0LmNsYXNzOw0KICAgICAgICAgICAgICAgIGNh\nc2UgJ1onOiByZXR1cm4gYm9vbGVhbi5jbGFzczsNCiAgICAgICAgICAgICAg\nICBkZWZhdWx0OiByZXR1cm4gbnVsbDsNCiAgICAgICAgICAgIH0NCiAgICAg\nICAgfQ0KDQogICAgICAgIHByb3RlY3RlZCBDbGFzcyByZXNvbHZlQ2xhc3Mo\nT2JqZWN0U3RyZWFtQ2xhc3MgY2xhc3NEZXNjKQ0KICAgICAgICAgICAgdGhy\nb3dzIElPRXhjZXB0aW9uLCBDbGFzc05vdEZvdW5kRXhjZXB0aW9uIHsNCg0K\nICAgICAgICAgICAgU3RyaW5nIGNuYW1lID0gY2xhc3NEZXNjLmdldE5hbWUo\nKTsNCiAgICAgICAgICAgIGlmIChjbmFtZS5zdGFydHNXaXRoKCJbIikpIHsN\nCiAgICAgICAgICAgICAgICAvLyBBbiBhcnJheQ0KICAgICAgICAgICAgICAg\nIENsYXNzIGNvbXBvbmVudDsJCS8vIGNvbXBvbmVudCBjbGFzcw0KICAgICAg\nICAgICAgICAgIGludCBkY291bnQ7CQkJICAgIC8vIGRpbWVuc2lvbg0KICAg\nICAgICAgICAgICAgIGZvciAoZGNvdW50PTE7IGNuYW1lLmNoYXJBdChkY291\nbnQpPT0nWyc7IGRjb3VudCsrKSA7DQogICAgICAgICAgICAgICAgaWYgKGNu\nYW1lLmNoYXJBdChkY291bnQpID09ICdMJykgew0KICAgICAgICAgICAgICAg\nICAgICBjb21wb25lbnQgPSBsb29rdXBDbGFzcyhjbmFtZS5zdWJzdHJpbmco\nZGNvdW50KzEsDQogICAgICAgICAgICAgICAgICAgICAgICBjbmFtZS5sZW5n\ndGgoKS0xKSk7DQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAg\nICAgICAgICAgICAgaWYgKGNuYW1lLmxlbmd0aCgpICE9IGRjb3VudCsxKSB7\nDQogICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgQ2xhc3NOb3RG\nb3VuZEV4Y2VwdGlvbihjbmFtZSk7Ly8gbWFsZm9ybWVkDQogICAgICAgICAg\nICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgY29tcG9uZW50ID0g\ncHJpbWl0aXZlVHlwZShjbmFtZS5jaGFyQXQoZGNvdW50KSk7DQogICAgICAg\nICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGludCBkaW1bXSA9IG5ldyBp\nbnRbZGNvdW50XTsNCiAgICAgICAgICAgICAgICBmb3IgKGludCBpPTA7IGk8\nZGNvdW50OyBpKyspIHsNCiAgICAgICAgICAgICAgICAgICAgZGltW2ldPTA7\nDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIHJldHVybiBB\ncnJheS5uZXdJbnN0YW5jZShjb21wb25lbnQsIGRpbSkuZ2V0Q2xhc3MoKTsN\nCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgcmV0dXJu\nIGxvb2t1cENsYXNzKGNuYW1lKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAg\nfQ0KDQogICAgICAgIC8qKg0KICAgICAgICAgKiBJZiB0aGlzIGlzIGEgZ2Vu\nZXJhdGVkIHN1YmNsYXNzLCBsb29rIHVwIHRoZSBjb3JyZXNwb25kaW5nIENs\nYXNzDQogICAgICAgICAqIG9iamVjdCB2aWEgbWV0YWRhdGEuDQogICAgICAg\nICAqLw0KICAgICAgICBwcml2YXRlIENsYXNzIGxvb2t1cENsYXNzKFN0cmlu\nZyBjbGFzc05hbWUpDQogICAgICAgICAgICB0aHJvd3MgQ2xhc3NOb3RGb3Vu\nZEV4Y2VwdGlvbiB7DQogICAgICAgICAgICB0cnkgew0KICAgICAgICAgICAg\nICAgIHJldHVybiBDbGFzcy5mb3JOYW1lKGNsYXNzTmFtZSk7DQogICAgICAg\nICAgICB9IGNhdGNoIChDbGFzc05vdEZvdW5kRXhjZXB0aW9uIGUpIHsNCiAg\nICAgICAgICAgICAgICBpZiAoUENFbmhhbmNlci5pc1BDU3ViY2xhc3NOYW1l\nKGNsYXNzTmFtZSkpIHsNCiAgICAgICAgICAgICAgICAgICAgU3RyaW5nIHN1\ncGVyTmFtZSA9IFBDRW5oYW5jZXIudG9NYW5hZ2VkVHlwZU5hbWUoY2xhc3NO\nYW1lKTsNCiAgICAgICAgICAgICAgICAgICAgQ2xhc3NNZXRhRGF0YVtdIG1l\ndGFzID0gY29uZi5nZXRNZXRhRGF0YVJlcG9zaXRvcnlJbnN0YW5jZSgpDQog\nICAgICAgICAgICAgICAgICAgICAgICAuZ2V0TWV0YURhdGFzKCk7DQogICAg\nICAgICAgICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgbWV0YXMubGVu\nZ3RoOyBpKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdXBl\nck5hbWUuZXF1YWxzKA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1l\ndGFzW2ldLmdldERlc2NyaWJlZFR5cGUoKS5nZXROYW1lKCkpKSB7DQogICAg\nICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFBDUmVnaXN0cnkuZ2V0\nUENUeXBlKA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXRh\nc1tpXS5nZXREZXNjcmliZWRUeXBlKCkpOw0KICAgICAgICAgICAgICAgICAg\nICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAg\nICAgICAgICAgLy8gaWYgaXQncyBub3QgZm91bmQsIHRyeSB0byBsb29rIGZv\nciBpdCBhbnl3YXlzDQogICAgICAgICAgICAgICAgICAgIHJldHVybiBDbGFz\ncy5mb3JOYW1lKGNsYXNzTmFtZSk7DQogICAgICAgICAgICAgICAgfSBlbHNl\nIHsNCiAgICAgICAgICAgICAgICAgICAgdGhyb3cgZTsNCiAgICAgICAgICAg\nICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9DQp9DQo=\n","encoding":"base64"}

