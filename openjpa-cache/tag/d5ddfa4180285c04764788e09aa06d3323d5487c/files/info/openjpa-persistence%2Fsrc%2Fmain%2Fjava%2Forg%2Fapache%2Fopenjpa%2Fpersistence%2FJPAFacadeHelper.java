{"sha":"7f12f0caf31c91dbd3d88e0918d8ffc2aca70e80","node_id":"MDQ6QmxvYjIwNjM2NDo3ZjEyZjBjYWYzMWM5MWRiZDNkODhlMDkxOGQ4ZmZjMmFjYTcwZTgw","size":11640,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/7f12f0caf31c91dbd3d88e0918d8ffc2aca70e80","content":"LyoNCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUNCiAqIG9yIG1vcmUgY29udHJpYnV0b3Ig\nbGljZW5zZSBhZ3JlZW1lbnRzLiAgU2VlIHRoZSBOT1RJQ0UgZmlsZQ0KICog\nZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5m\nb3JtYXRpb24NCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAg\nVGhlIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUNCiAqIHRvIHlvdSB1bmRlciB0\naGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUNCiAqICJMaWNl\nbnNlIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNv\nbXBsaWFuY2UNCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFp\nbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQNCiAqDQogKiBodHRwOi8vd3d3\nLmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjANCiAqDQogKiBVbmxl\nc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGlu\nIHdyaXRpbmcsDQogKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUg\nTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbg0KICogIkFTIElTIiBCQVNJ\nUywgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZDQog\nKiBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBM\naWNlbnNlIGZvciB0aGUNCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmlu\nZyBwZXJtaXNzaW9ucyBhbmQgbGltaXRhdGlvbnMNCiAqIHVuZGVyIHRoZSBM\naWNlbnNlLg0KICovDQpwYWNrYWdlIG9yZy5hcGFjaGUub3BlbmpwYS5wZXJz\naXN0ZW5jZTsNCg0KaW1wb3J0IGphdmEubWF0aC5CaWdEZWNpbWFsOw0KaW1w\nb3J0IGphdmEubWF0aC5CaWdJbnRlZ2VyOw0KaW1wb3J0IGphdmEudXRpbC5B\ncnJheUxpc3Q7DQppbXBvcnQgamF2YS51dGlsLkNvbGxlY3Rpb247DQppbXBv\ncnQgamF2YS51dGlsLkl0ZXJhdG9yOw0KaW1wb3J0IGphdmF4LnBlcnNpc3Rl\nbmNlLkVudGl0eU1hbmFnZXI7DQppbXBvcnQgamF2YXgucGVyc2lzdGVuY2Uu\nRW50aXR5TWFuYWdlckZhY3Rvcnk7DQoNCmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEua2VybmVsLkJyb2tlcjsNCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEua2VybmVsLkJyb2tlckZhY3Rvcnk7DQppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLm1ldGEuQ2xhc3NNZXRhRGF0YTsNCmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEudXRpbC5CaWdEZWNpbWFsSWQ7DQppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLnV0aWwuQmlnSW50ZWdlcklkOw0KaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS51dGlsLkJ5dGVJZDsNCmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEudXRpbC5DaGFySWQ7DQppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLnV0aWwuRG91YmxlSWQ7DQppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0\naWwuRmxvYXRJZDsNCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5J\nZDsNCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5JbXBsSGVscGVy\nOw0KaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLkludElkOw0KaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLkxvbmdJZDsNCmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEudXRpbC5PYmplY3RJZDsNCmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEudXRpbC5PcGVuSlBBSWQ7DQppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLnV0aWwuU2hvcnRJZDsNCmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEudXRpbC5TdHJpbmdJZDsNCmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEubGliLnV0aWwuTG9jYWxpemVyOw0KDQovKioNCiAqIEhlbHBlciBj\nbGFzcyBmb3Igc3dpdGNoaW5nIGJldHdlZW4gT3BlbkpQQSdzIEpQQSBmYWNh\nZGUgYW5kIHRoZSB1bmRlcmx5aW5nDQogKiBCcm9rZXIga2VybmVsLg0KICoN\nCiAqIEBzaW5jZSAxLjAuMA0KICogQG5vamF2YWRvYw0KICovDQpwdWJsaWMg\nY2xhc3MgSlBBRmFjYWRlSGVscGVyIHsNCg0KICAgIHB1YmxpYyBzdGF0aWMg\nZmluYWwgU3RyaW5nIEVNX0tFWSA9DQogICAgICAgICJvcmcuYXBhY2hlLm9w\nZW5qcGEucGVyc2lzdGVuY2UuRW50aXR5TWFuYWdlciI7DQogICAgcHVibGlj\nIHN0YXRpYyBmaW5hbCBTdHJpbmcgRU1GX0tFWSA9DQogICAgICAgICJvcmcu\nYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuRW50aXR5TWFuYWdlckZhY3Rv\ncnkiOw0KDQogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgTG9jYWxpemVyIF9s\nb2MgPQ0KICAgICAgICBMb2NhbGl6ZXIuZm9yUGFja2FnZShKUEFGYWNhZGVI\nZWxwZXIuY2xhc3MpOw0KDQogICAgcHVibGljIHN0YXRpYyBPcGVuSlBBRW50\naXR5TWFuYWdlckZhY3RvcnkgdG9FbnRpdHlNYW5hZ2VyRmFjdG9yeSgNCiAg\nICAgICAgQnJva2VyRmFjdG9yeSBmYWN0b3J5KSB7DQogICAgICAgIGlmIChm\nYWN0b3J5ID09IG51bGwpDQogICAgICAgICAgICByZXR1cm4gbnVsbDsNCg0K\nICAgICAgICBmYWN0b3J5LmxvY2soKTsNCiAgICAgICAgdHJ5IHsNCiAgICAg\nICAgICAgIE9wZW5KUEFFbnRpdHlNYW5hZ2VyRmFjdG9yeSBlbWYgPSAoT3Bl\nbkpQQUVudGl0eU1hbmFnZXJGYWN0b3J5KQ0KICAgICAgICAgICAgICAgIGZh\nY3RvcnkuZ2V0VXNlck9iamVjdChFTUZfS0VZKTsNCiAgICAgICAgICAgIGlm\nIChlbWYgPT0gbnVsbCkgew0KICAgICAgICAgICAgICAgIGVtZiA9IEVudGl0\neU1hbmFnZXJGYWN0b3J5VmFsdWUubmV3RmFjdG9yeShmYWN0b3J5KTsNCiAg\nICAgICAgICAgICAgICBmYWN0b3J5LnB1dFVzZXJPYmplY3QoRU1GX0tFWSwg\nZW1mKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHJldHVybiBlbWY7\nDQogICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7DQogICAgICAgICAg\nICB0aHJvdyBQZXJzaXN0ZW5jZUV4Y2VwdGlvbnMudG9QZXJzaXN0ZW5jZUV4\nY2VwdGlvbihlKTsNCiAgICAgICAgfSBmaW5hbGx5IHsNCiAgICAgICAgICAg\nIGZhY3RvcnkudW5sb2NrKCk7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICAv\nKioNCiAgICAgKiBSZXR1cm4gdGhlIHVuZGVybHlpbmcgYnJva2VyIGZhY3Rv\ncnkgZm9yIHRoZSBnaXZlbiBwZXJzaXN0ZW5jZSBtYW5hZ2VyDQogICAgICog\nZmFjdG9yeSBmYWNhZGUuDQogICAgICovDQogICAgcHVibGljIHN0YXRpYyBC\ncm9rZXJGYWN0b3J5IHRvQnJva2VyRmFjdG9yeShFbnRpdHlNYW5hZ2VyRmFj\ndG9yeSBlbWYpIHsNCiAgICAgICAgaWYgKGVtZiA9PSBudWxsKQ0KICAgICAg\nICAgICAgcmV0dXJuIG51bGw7DQogICAgICAgIGlmICghKGVtZiBpbnN0YW5j\nZW9mIEVudGl0eU1hbmFnZXJGYWN0b3J5SW1wbCkpIHsNCiAgICAgICAgICAg\nIENsYXNzIGMgPSBlbWYuZ2V0Q2xhc3MoKTsNCiAgICAgICAgICAgIHRyeSB7\nDQogICAgICAgICAgICAgICAgLy8gZWl0aGVyIGNhc3QgaGVyZSBtYXkgZmFp\nbA0KICAgICAgICAgICAgICAgIGVtZiA9IChFbnRpdHlNYW5hZ2VyRmFjdG9y\neUltcGwpICgoT3BlbkpQQUVudGl0eU1hbmFnZXJGYWN0b3J5KQ0KICAgICAg\nICAgICAgICAgICAgICBlbWYpLmdldFVzZXJPYmplY3QoRU1GX0tFWSk7DQog\nICAgICAgICAgICB9IGNhdGNoIChDbGFzc0Nhc3RFeGNlcHRpb24gY2NlKSB7\nDQogICAgICAgICAgICAgICAgdGhyb3cgbmV3IEFyZ3VtZW50RXhjZXB0aW9u\nKF9sb2MuZ2V0KA0KICAgICAgICAgICAgICAgICAgICAiY2FudC1jb252ZXJ0\nLWJyb2tlcmZhY3RvcnkiLCBjKSwgbnVsbCwgbnVsbCwgZmFsc2UpOw0KICAg\nICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIHJldHVybiAoKEVudGl0\neU1hbmFnZXJGYWN0b3J5SW1wbCkgZW1mKS5nZXRCcm9rZXJGYWN0b3J5KCk7\nDQogICAgfQ0KDQogICAgLyoqDQogICAgICogUmV0dXJuIGEgcGVyc2lzdGVu\nY2UgbWFuYWdlciBmYWNhZGUgdG8gdGhlIGdpdmVuIGJyb2tlciByZXRhaW5p\nbmcNCiAgICAgKiBwcmV2aW91c2x5IGFzc29jaWF0ZWQgcGVyc2lzdGVuY2Ug\nY29udGV4dCB0eXBlLg0KICAgICAqLw0KICAgIHB1YmxpYyBzdGF0aWMgT3Bl\nbkpQQUVudGl0eU1hbmFnZXIgdG9FbnRpdHlNYW5hZ2VyKEJyb2tlciBicm9r\nZXIpIHsNCiAgICAgICAgaWYgKGJyb2tlciA9PSBudWxsKQ0KICAgICAgICAg\nICAgcmV0dXJuIG51bGw7DQoNCiAgICAgICAgYnJva2VyLmxvY2soKTsNCiAg\nICAgICAgdHJ5IHsNCiAgICAgICAgICAgIE9wZW5KUEFFbnRpdHlNYW5hZ2Vy\nIGVtID0gKE9wZW5KUEFFbnRpdHlNYW5hZ2VyKQ0KICAgICAgICAgICAgICAg\nIGJyb2tlci5nZXRVc2VyT2JqZWN0KEVNX0tFWSk7DQogICAgICAgICAgICBp\nZiAoZW0gPT0gbnVsbCkgew0KICAgICAgICAgICAgICAgIEVudGl0eU1hbmFn\nZXJGYWN0b3J5SW1wbCBlbWYgPSAoRW50aXR5TWFuYWdlckZhY3RvcnlJbXBs\nKQ0KICAgICAgICAgICAgICAgICAgICB0b0VudGl0eU1hbmFnZXJGYWN0b3J5\nKGJyb2tlci5nZXRCcm9rZXJGYWN0b3J5KCkpOw0KICAgICAgICAgICAgICAg\nIGVtID0gZW1mLm5ld0VudGl0eU1hbmFnZXJJbXBsKGJyb2tlcik7DQogICAg\nICAgICAgICAgICAgYnJva2VyLnB1dFVzZXJPYmplY3QoRU1fS0VZLCBlbSk7\nDQogICAgICAgICAgICB9DQogICAgICAgICAgICByZXR1cm4gZW07DQogICAg\nICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7DQogICAgICAgICAgICB0aHJv\ndyBQZXJzaXN0ZW5jZUV4Y2VwdGlvbnMudG9QZXJzaXN0ZW5jZUV4Y2VwdGlv\nbihlKTsNCiAgICAgICAgfSBmaW5hbGx5IHsNCiAgICAgICAgICAgIGJyb2tl\nci51bmxvY2soKTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIC8qKg0KICAg\nICAqIFJldHVybiB0aGUgdW5kZXJseWluZyBicm9rZXIgZm9yIHRoZSBnaXZl\nbiBlbnRpdHkgbWFuYWdlciBmYWNhZGUuDQogICAgICovDQogICAgcHVibGlj\nIHN0YXRpYyBCcm9rZXIgdG9Ccm9rZXIoRW50aXR5TWFuYWdlciBlbSkgew0K\nICAgICAgICBpZiAoZW0gPT0gbnVsbCkNCiAgICAgICAgICAgIHJldHVybiBu\ndWxsOw0KICAgICAgICBpZiAoIShlbSBpbnN0YW5jZW9mIEVudGl0eU1hbmFn\nZXJJbXBsKSkgew0KICAgICAgICAgICAgQ2xhc3MgYyA9IGVtLmdldENsYXNz\nKCk7DQogICAgICAgICAgICB0cnkgew0KICAgICAgICAgICAgICAgIC8vIGVp\ndGhlciBjYXN0IGhlcmUgbWF5IGZhaWwNCiAgICAgICAgICAgICAgICBlbSA9\nIChFbnRpdHlNYW5hZ2VySW1wbCkgKChPcGVuSlBBRW50aXR5TWFuYWdlcikg\nZW0pLg0KICAgICAgICAgICAgICAgICAgICBnZXRVc2VyT2JqZWN0KEVNX0tF\nWSk7DQogICAgICAgICAgICB9IGNhdGNoIChDbGFzc0Nhc3RFeGNlcHRpb24g\nY2NlKSB7DQogICAgICAgICAgICAgICAgdGhyb3cgbmV3IEFyZ3VtZW50RXhj\nZXB0aW9uKF9sb2MuZ2V0KCJjYW50LWNvbnZlcnQtYnJva2VyIiwgYyksDQog\nICAgICAgICAgICAgICAgICAgIG5ldyBUaHJvd2FibGVbXSB7IGNjZSB9LCBu\ndWxsLCBmYWxzZSk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAg\nICAgcmV0dXJuICgoRW50aXR5TWFuYWdlckltcGwpIGVtKS5nZXRCcm9rZXIo\nKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiBSZXR1cm5zIHRoZSB7QGxp\nbmsgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuQ2xhc3NNZXRhRGF0YX0gYXNz\nb2NpYXRlZCB3aXRoIHRoZQ0KICAgICAqIHBlcnNpc3RlbnQgb2JqZWN0IDxj\nb2RlPm88L2NvZGU+Lg0KICAgICAqLw0KICAgIHB1YmxpYyBzdGF0aWMgQ2xh\nc3NNZXRhRGF0YSBnZXRNZXRhRGF0YShPYmplY3Qgbykgew0KICAgICAgICBp\nZiAobyA9PSBudWxsKQ0KICAgICAgICAgICAgcmV0dXJuIG51bGw7DQogICAg\nICAgIEVudGl0eU1hbmFnZXIgZW0gPSBPcGVuSlBBUGVyc2lzdGVuY2UuZ2V0\nRW50aXR5TWFuYWdlcihvKTsNCiAgICAgICAgcmV0dXJuIChlbSA9PSBudWxs\nKSA/IG51bGwgOiBnZXRNZXRhRGF0YShlbSwNCiAgICAgICAgICAgIEltcGxI\nZWxwZXIuZ2V0TWFuYWdlZEluc3RhbmNlKG8pLmdldENsYXNzKCkpOw0KICAg\nIH0NCg0KICAgIC8qKg0KICAgICAqIFJldHVybnMgdGhlIHtAbGluayBvcmcu\nYXBhY2hlLm9wZW5qcGEubWV0YS5DbGFzc01ldGFEYXRhfSBhc3NvY2lhdGVk\nDQogICAgICogd2l0aCB0aGUgcGVyc2lzdGVudCB0eXBlIDxjb2RlPmNsczwv\nY29kZT4uDQogICAgICovDQogICAgcHVibGljIHN0YXRpYyBDbGFzc01ldGFE\nYXRhIGdldE1ldGFEYXRhKEVudGl0eU1hbmFnZXIgZW0sIENsYXNzIGNscykg\new0KICAgICAgICBpZiAoZW0gPT0gbnVsbCkNCiAgICAgICAgICAgIHRocm93\nIG5ldyBOdWxsUG9pbnRlckV4Y2VwdGlvbigiZW0gPT0gbnVsbCIpOw0KDQog\nICAgICAgIE9wZW5KUEFFbnRpdHlNYW5hZ2VyU1BJIGtlbSA9IChPcGVuSlBB\nRW50aXR5TWFuYWdlclNQSSkNCiAgICAgICAgICAgIE9wZW5KUEFQZXJzaXN0\nZW5jZS5jYXN0KGVtKTsNCiAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgIHJl\ndHVybiBrZW0uZ2V0Q29uZmlndXJhdGlvbigpLmdldE1ldGFEYXRhUmVwb3Np\ndG9yeUluc3RhbmNlKCkuDQogICAgICAgICAgICAgICAgZ2V0TWV0YURhdGEo\nY2xzLCBrZW0uZ2V0Q2xhc3NMb2FkZXIoKSwgZmFsc2UpOw0KICAgICAgICB9\nIGNhdGNoIChFeGNlcHRpb24gZSkgew0KICAgICAgICAgICAgdGhyb3cgUGVy\nc2lzdGVuY2VFeGNlcHRpb25zLnRvUGVyc2lzdGVuY2VFeGNlcHRpb24oZSk7\nDQogICAgICAgIH0NCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiBSZXR1cm5z\nIHRoZSB7QGxpbmsgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuQ2xhc3NNZXRh\nRGF0YX0gYXNzb2NpYXRlZA0KICAgICAqIHdpdGggdGhlIHBlcnNpc3RlbnQg\ndHlwZSA8Y29kZT5jbHM8L2NvZGU+Lg0KICAgICAqLw0KICAgIHB1YmxpYyBz\ndGF0aWMgQ2xhc3NNZXRhRGF0YSBnZXRNZXRhRGF0YShFbnRpdHlNYW5hZ2Vy\nRmFjdG9yeSBlbWYsDQogICAgICAgIENsYXNzIGNscykgew0KICAgICAgICBp\nZiAoZW1mID09IG51bGwpDQogICAgICAgICAgICB0aHJvdyBuZXcgTnVsbFBv\naW50ZXJFeGNlcHRpb24oImVtZiA9PSBudWxsIik7DQoNCiAgICAgICAgT3Bl\nbkpQQUVudGl0eU1hbmFnZXJGYWN0b3J5U1BJIGVtZlNQSSA9DQogICAgICAg\nICAgICAoT3BlbkpQQUVudGl0eU1hbmFnZXJGYWN0b3J5U1BJKSBPcGVuSlBB\nUGVyc2lzdGVuY2UuY2FzdChlbWYpOw0KICAgICAgICB0cnkgew0KICAgICAg\nICAgICAgcmV0dXJuIGVtZlNQSS5nZXRDb25maWd1cmF0aW9uKCkuZ2V0TWV0\nYURhdGFSZXBvc2l0b3J5SW5zdGFuY2UoKS4NCiAgICAgICAgICAgICAgICBn\nZXRNZXRhRGF0YShjbHMsIG51bGwsIGZhbHNlKTsNCiAgICAgICAgfSBjYXRj\naCAoRXhjZXB0aW9uIGUpIHsNCiAgICAgICAgICAgIHRocm93IFBlcnNpc3Rl\nbmNlRXhjZXB0aW9ucy50b1BlcnNpc3RlbmNlRXhjZXB0aW9uKGUpOw0KICAg\nICAgICB9DQogICAgfQ0KDQogICAgLyoqDQogICAgICogVHJhbnNsYXRlIGZy\nb20gYSBPcGVuSlBBIGlkZW50aXR5IG9iamVjdCB0byBhIFBlcnNpc3RlbmNl\nIG9uZS4NCiAgICAgKi8NCiAgICBwdWJsaWMgc3RhdGljIE9iamVjdCBmcm9t\nT3BlbkpQQU9iamVjdElkKE9iamVjdCBvaWQpIHsNCiAgICAgICAgaWYgKG9p\nZCBpbnN0YW5jZW9mIE9wZW5KUEFJZCkNCiAgICAgICAgICAgIHJldHVybiAo\nKE9wZW5KUEFJZCkgb2lkKS5nZXRJZE9iamVjdCgpOw0KICAgICAgICByZXR1\ncm4gb2lkOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIFRyYW5zbGF0ZSBm\ncm9tIGEgUGVyc2lzdGVuY2UgaWRlbnRpdHkgb2JqZWN0IHRvIGEgT3BlbkpQ\nQSBvbmUuDQogICAgICovDQogICAgcHVibGljIHN0YXRpYyBPYmplY3QgdG9P\ncGVuSlBBT2JqZWN0SWQoQ2xhc3NNZXRhRGF0YSBtZXRhLCBPYmplY3Qgb2lk\nKSB7DQogICAgICAgIGlmIChvaWQgPT0gbnVsbCB8fCBtZXRhID09IG51bGwp\nDQogICAgICAgICAgICByZXR1cm4gbnVsbDsNCg0KICAgICAgICBDbGFzcyBj\nbHMgPSBtZXRhLmdldERlc2NyaWJlZFR5cGUoKTsNCiAgICAgICAgaWYgKG1l\ndGEuZ2V0SWRlbnRpdHlUeXBlKCkgPT0gQ2xhc3NNZXRhRGF0YS5JRF9EQVRB\nU1RPUkUpDQogICAgICAgICAgICByZXR1cm4gbmV3IElkKGNscywgKChOdW1i\nZXIpIG9pZCkubG9uZ1ZhbHVlKCkpOw0KDQogICAgICAgIGlmIChvaWQgaW5z\ndGFuY2VvZiBCeXRlKQ0KICAgICAgICAgICAgcmV0dXJuIG5ldyBCeXRlSWQo\nY2xzLCAoQnl0ZSkgb2lkKTsNCiAgICAgICAgaWYgKG9pZCBpbnN0YW5jZW9m\nIENoYXJhY3RlcikNCiAgICAgICAgICAgIHJldHVybiBuZXcgQ2hhcklkKGNs\ncywgKENoYXJhY3Rlcikgb2lkKTsNCiAgICAgICAgaWYgKG9pZCBpbnN0YW5j\nZW9mIERvdWJsZSkNCiAgICAgICAgICAgIHJldHVybiBuZXcgRG91YmxlSWQo\nY2xzLCAoRG91YmxlKSBvaWQpOw0KICAgICAgICBpZiAob2lkIGluc3RhbmNl\nb2YgRmxvYXQpDQogICAgICAgICAgICByZXR1cm4gbmV3IEZsb2F0SWQoY2xz\nLCAoRmxvYXQpIG9pZCk7DQogICAgICAgIGlmIChvaWQgaW5zdGFuY2VvZiBJ\nbnRlZ2VyKQ0KICAgICAgICAgICAgcmV0dXJuIG5ldyBJbnRJZChjbHMsIChJ\nbnRlZ2VyKSBvaWQpOw0KICAgICAgICBpZiAob2lkIGluc3RhbmNlb2YgTG9u\nZykNCiAgICAgICAgICAgIHJldHVybiBuZXcgTG9uZ0lkKGNscywgKExvbmcp\nIG9pZCk7DQogICAgICAgIGlmIChvaWQgaW5zdGFuY2VvZiBTaG9ydCkNCiAg\nICAgICAgICAgIHJldHVybiBuZXcgU2hvcnRJZChjbHMsIChTaG9ydCkgb2lk\nKTsNCiAgICAgICAgaWYgKG9pZCBpbnN0YW5jZW9mIFN0cmluZykNCiAgICAg\nICAgICAgIHJldHVybiBuZXcgU3RyaW5nSWQoY2xzLCAoU3RyaW5nKSBvaWQp\nOw0KICAgICAgICBpZiAob2lkIGluc3RhbmNlb2YgQmlnRGVjaW1hbCkNCiAg\nICAgICAgICAgIHJldHVybiBuZXcgQmlnRGVjaW1hbElkKGNscywgKEJpZ0Rl\nY2ltYWwpIG9pZCk7DQogICAgICAgIGlmIChvaWQgaW5zdGFuY2VvZiBCaWdJ\nbnRlZ2VyKQ0KICAgICAgICAgICAgcmV0dXJuIG5ldyBCaWdJbnRlZ2VySWQo\nY2xzLCAoQmlnSW50ZWdlcikgb2lkKTsNCiAgICAgICAgcmV0dXJuIG5ldyBP\nYmplY3RJZChjbHMsIG9pZCk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog\nUmV0dXJuIGFuIGFycmF5IG9mIE9wZW5KUEEgb2lkcyBmb3IgdGhlIGdpdmVu\nIG5hdGl2ZSBvaWQgYXJyYXkuDQogICAgICovDQogICAgcHVibGljIHN0YXRp\nYyBPYmplY3RbXSB0b09wZW5KUEFPYmplY3RJZHMoQ2xhc3NNZXRhRGF0YSBt\nZXRhLA0KICAgICAgICBPYmplY3QuLi4gb2lkcykgew0KICAgICAgICBpZiAo\nb2lkcyA9PSBudWxsIHx8IG9pZHMubGVuZ3RoID09IDApDQogICAgICAgICAg\nICByZXR1cm4gb2lkczsNCg0KICAgICAgICAvLyBzaW5jZSB0aGUgY2xhc3Mg\naWYgZml4ZWQgZm9yIGFsbCBvaWRzLCB3ZSBjYW4gdGVsbCBpZiB3ZSBoYXZl\nIHRvDQogICAgICAgIC8vIHRyYW5zbGF0ZSB0aGUgYXJyYXkgYmFzZWQgb24g\nd2hldGhlciB0aGUgZmlyc3Qgb2lkIG5lZWRzIHRyYW5zbGF0aW5nDQogICAg\nICAgIE9iamVjdCBvaWQgPSB0b09wZW5KUEFPYmplY3RJZChtZXRhLCBvaWRz\nWzBdKTsNCiAgICAgICAgaWYgKG9pZCA9PSBvaWRzWzBdKQ0KICAgICAgICAg\nICAgcmV0dXJuIG9pZHM7DQoNCiAgICAgICAgT2JqZWN0W10gY29weSA9IG5l\ndyBPYmplY3Rbb2lkcy5sZW5ndGhdOw0KICAgICAgICBjb3B5WzBdID0gb2lk\nOw0KICAgICAgICBmb3IgKGludCBpID0gMTsgaSA8IG9pZHMubGVuZ3RoOyBp\nKyspDQogICAgICAgICAgICBjb3B5W2ldID0gdG9PcGVuSlBBT2JqZWN0SWQo\nbWV0YSwgb2lkc1tpXSk7DQogICAgICAgIHJldHVybiBjb3B5Ow0KICAgIH0N\nCg0KICAgIC8qKg0KICAgICAqIFJldHVybiBhIGNvbGxlY3Rpb24gb2YgT3Bl\nbkpQQSBvaWRzIGZvciB0aGUgZ2l2ZW4gbmF0aXZlIG9pZCBjb2xsZWN0aW9u\nLg0KICAgICAqLw0KICAgIHB1YmxpYyBzdGF0aWMgQ29sbGVjdGlvbiB0b09w\nZW5KUEFPYmplY3RJZHMoQ2xhc3NNZXRhRGF0YSBtZXRhLA0KICAgICAgICBD\nb2xsZWN0aW9uIG9pZHMpIHsNCiAgICAgICAgaWYgKG9pZHMgPT0gbnVsbCB8\nfCBvaWRzLmlzRW1wdHkoKSkNCiAgICAgICAgICAgIHJldHVybiBvaWRzOw0K\nDQogICAgICAgIC8vIHNpbmNlIHRoZSBjbGFzcyBpZiBmaXhlZCBmb3IgYWxs\nIG9pZHMsIHdlIGNhbiB0ZWxsIGlmIHdlIGhhdmUgdG8NCiAgICAgICAgLy8g\ndHJhbnNsYXRlIHRoZSBhcnJheSBiYXNlZCBvbiB3aGV0aGVyIHRoZSBmaXJz\ndCBvaWQgbmVlZHMgdHJhbnNsYXRpbmcNCiAgICAgICAgSXRlcmF0b3IgaXRy\nID0gb2lkcy5pdGVyYXRvcigpOw0KICAgICAgICBPYmplY3Qgb3JpZyA9IGl0\nci5uZXh0KCk7DQogICAgICAgIE9iamVjdCBvaWQgPSB0b09wZW5KUEFPYmpl\nY3RJZChtZXRhLCBvcmlnKTsNCiAgICAgICAgaWYgKG9pZCA9PSBvcmlnKQ0K\nICAgICAgICAgICAgcmV0dXJuIG9pZHM7DQoNCiAgICAgICAgQ29sbGVjdGlv\nbiBjb3B5ID0gbmV3IEFycmF5TGlzdChvaWRzLnNpemUoKSk7DQogICAgICAg\nIGNvcHkuYWRkKG9pZCk7DQogICAgICAgIHdoaWxlIChpdHIuaGFzTmV4dCgp\nKQ0KICAgICAgICAgICAgY29weS5hZGQodG9PcGVuSlBBT2JqZWN0SWQobWV0\nYSwgaXRyLm5leHQoKSkpOw0KICAgICAgICByZXR1cm4gY29weTsNCiAgICB9\nDQoNCiAgICAvKioNCiAgICAgKiBUcmFuc2xhdGUgZnJvbSBhIE9wZW5KUEEg\naWRlbnRpdHkgY2xhc3MgdG8gYSBuYXRpdmUgb25lLg0KICAgICAqLw0KICAg\nIHB1YmxpYyBzdGF0aWMgQ2xhc3MgZnJvbU9wZW5KUEFPYmplY3RJZENsYXNz\nKENsYXNzIG9pZENsYXNzKSB7DQogICAgICAgIGlmIChvaWRDbGFzcyA9PSBu\ndWxsKQ0KICAgICAgICAgICAgcmV0dXJuIG51bGw7DQogICAgICAgIGlmIChv\naWRDbGFzcyA9PSBJZC5jbGFzcykNCiAgICAgICAgICAgIHJldHVybiBMb25n\nLmNsYXNzOw0KICAgICAgICBpZiAob2lkQ2xhc3MgPT0gQnl0ZUlkLmNsYXNz\nKQ0KICAgICAgICAgICAgcmV0dXJuIEJ5dGUuY2xhc3M7DQogICAgICAgIGlm\nIChvaWRDbGFzcyA9PSBDaGFySWQuY2xhc3MpDQogICAgICAgICAgICByZXR1\ncm4gQ2hhcmFjdGVyLmNsYXNzOw0KICAgICAgICBpZiAob2lkQ2xhc3MgPT0g\nRG91YmxlSWQuY2xhc3MpDQogICAgICAgICAgICByZXR1cm4gRG91YmxlLmNs\nYXNzOw0KICAgICAgICBpZiAob2lkQ2xhc3MgPT0gRmxvYXRJZC5jbGFzcykN\nCiAgICAgICAgICAgIHJldHVybiBGbG9hdC5jbGFzczsNCiAgICAgICAgaWYg\nKG9pZENsYXNzID09IEludElkLmNsYXNzKQ0KICAgICAgICAgICAgcmV0dXJu\nIEludGVnZXIuY2xhc3M7DQogICAgICAgIGlmIChvaWRDbGFzcyA9PSBMb25n\nSWQuY2xhc3MpDQogICAgICAgICAgICByZXR1cm4gTG9uZy5jbGFzczsNCiAg\nICAgICAgaWYgKG9pZENsYXNzID09IFNob3J0SWQuY2xhc3MpDQogICAgICAg\nICAgICByZXR1cm4gU2hvcnQuY2xhc3M7DQogICAgICAgIGlmIChvaWRDbGFz\ncyA9PSBTdHJpbmdJZC5jbGFzcykNCiAgICAgICAgICAgIHJldHVybiBTdHJp\nbmcuY2xhc3M7DQogICAgICAgIGlmIChvaWRDbGFzcyA9PSBCaWdEZWNpbWFs\nSWQuY2xhc3MpDQogICAgICAgICAgICByZXR1cm4gQmlnRGVjaW1hbC5jbGFz\nczsNCiAgICAgICAgaWYgKG9pZENsYXNzID09IEJpZ0ludGVnZXJJZC5jbGFz\ncykNCiAgICAgICAgICAgIHJldHVybiBCaWdJbnRlZ2VyLmNsYXNzOw0KICAg\nICAgICByZXR1cm4gb2lkQ2xhc3M7DQoJfQ0KfQ0K\n","encoding":"base64"}

