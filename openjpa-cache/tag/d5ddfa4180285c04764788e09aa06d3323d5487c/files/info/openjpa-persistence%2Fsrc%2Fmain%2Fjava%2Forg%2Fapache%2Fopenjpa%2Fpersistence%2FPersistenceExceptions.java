{"sha":"78f3d54fd43f8764ad28bff1714d29fa93ef983f","node_id":"MDQ6QmxvYjIwNjM2NDo3OGYzZDU0ZmQ0M2Y4NzY0YWQyOGJmZjE3MTRkMjlmYTkzZWY5ODNm","size":9753,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/78f3d54fd43f8764ad28bff1714d29fa93ef983f","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2U7CgppbXBv\ncnQgamF2YS5sYW5nLnJlZmxlY3QuSW52b2NhdGlvblRhcmdldEV4Y2VwdGlv\nbjsKCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLkJyb2tlcjsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLkV4Y2VwdGlvbnM7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5PcGVuSlBBRXhjZXB0aW9u\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuUnVudGltZUV4Y2Vw\ndGlvblRyYW5zbGF0b3I7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRp\nbC5TdG9yZUV4Y2VwdGlvbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51\ndGlsLlVzZXJFeGNlcHRpb247CgovKioKICogQ29udmVydHMgZnJvbSBPcGVu\nSlBBIHRvIHBlcnNpc3RlbmNlIGV4Y2VwdGlvbiB0eXBlcy4KICoKICogQGF1\ndGhvciBBYmUgV2hpdGUKICogQGF1dGhvciBNYXJjIFBydWQnaG9tbWVhdXgK\nICogQG5vamF2YWRvYwogKi8KcHVibGljIGNsYXNzIFBlcnNpc3RlbmNlRXhj\nZXB0aW9ucwogICAgZXh0ZW5kcyBFeGNlcHRpb25zIHsKCiAgICBwdWJsaWMg\nc3RhdGljIGZpbmFsIFJ1bnRpbWVFeGNlcHRpb25UcmFuc2xhdG9yIFRSQU5T\nTEFUT1IgPQogICAgICAgIG5ldyBSdW50aW1lRXhjZXB0aW9uVHJhbnNsYXRv\ncigpIHsKICAgICAgICAgICAgcHVibGljIFJ1bnRpbWVFeGNlcHRpb24gdHJh\nbnNsYXRlKFJ1bnRpbWVFeGNlcHRpb24gcmUpIHsKICAgICAgICAgICAgICAg\nIHJldHVybiBQZXJzaXN0ZW5jZUV4Y2VwdGlvbnMudG9QZXJzaXN0ZW5jZUV4\nY2VwdGlvbihyZSk7CiAgICAgICAgICAgIH0KICAgICAgICB9OwoKICAgIC8q\nKgogICAgICogUmV0dXJucyBhIHtAbGluayBSdW50aW1lRXhjZXB0aW9uVHJh\nbnNsYXRvcn0gdGhhdCB3aWxsIHBlcmZvcm0KICAgICAqIHRoZSBjb3JyZWN0\nIGV4Y2VwdGlvbiB0cmFuc2xhdGlvbiBhcyB3ZWxsIGFzIHJvbGwgYmFjayB0\naGUKICAgICAqIGN1cnJlbnQgdHJhbnNhY3Rpb24gd2hlbiBmb3IgYWxsIGJ1\ndCB7QGxpbmsgTm9SZXN1bHRFeGNlcHRpb259CiAgICAgKiBhbmQge0BsaW5r\nIE5vblVuaXF1ZVJlc3VsdEV4Y2VwdGlvbn0gaW4gYWNjb3JkYW5jZSB3aXRo\nCiAgICAgKiBzZWN0aW9uIDMuNyBvZiB0aGUgRUpCIDMuMCBzcGVjaWZpY2F0\naW9uLgogICAgICovCiAgICBwdWJsaWMgc3RhdGljIFJ1bnRpbWVFeGNlcHRp\nb25UcmFuc2xhdG9yIGdldFJvbGxiYWNrVHJhbnNsYXRvcigKICAgICAgICBm\naW5hbCBPcGVuSlBBRW50aXR5TWFuYWdlciBlbSkgewogICAgICAgIHJldHVy\nbiBuZXcgUnVudGltZUV4Y2VwdGlvblRyYW5zbGF0b3IoKSB7CiAgICAgICAg\nICAgIHByaXZhdGUgYm9vbGVhbiB0aHJvd2luZyA9IGZhbHNlOwoKICAgICAg\nICAgICAgcHVibGljIFJ1bnRpbWVFeGNlcHRpb24gdHJhbnNsYXRlKFJ1bnRp\nbWVFeGNlcHRpb24gcmUpIHsKICAgICAgICAgICAgICAgIFJ1bnRpbWVFeGNl\ncHRpb24gZXggPSB0b1BlcnNpc3RlbmNlRXhjZXB0aW9uKHJlKTsKICAgICAg\nICAgICAgICAgIGlmICghKGV4IGluc3RhbmNlb2YgTm9uVW5pcXVlUmVzdWx0\nRXhjZXB0aW9uKQogICAgICAgICAgICAgICAgICAgICYmICEoZXggaW5zdGFu\nY2VvZiBOb1Jlc3VsdEV4Y2VwdGlvbikKICAgICAgICAgICAgICAgICAgICAm\nJiAhdGhyb3dpbmcpIHsKICAgICAgICAgICAgICAgICAgICB0cnkgewogICAg\nICAgICAgICAgICAgICAgICAgICB0aHJvd2luZyA9IHRydWU7CiAgICAgICAg\nICAgICAgICAgICAgICAgIGlmIChlbS5pc09wZW4oKSAmJiAoKEVudGl0eU1h\nbmFnZXJJbXBsKSBlbSkuaXNBY3RpdmUoKSkKICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICgoRW50aXR5TWFuYWdlckltcGwpIGVtKS5zZXRSb2xsYmFj\na09ubHkocmUpOwogICAgICAgICAgICAgICAgICAgIH0gZmluYWxseSB7CiAg\nICAgICAgICAgICAgICAgICAgICAgIC8vIGhhbmRsZSByZS1lbnRyYW5jeQog\nICAgICAgICAgICAgICAgICAgICAgICB0aHJvd2luZyA9IGZhbHNlOwogICAg\nICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KCiAgICAgICAg\nICAgICAgICByZXR1cm4gZXg7CiAgICAgICAgICAgIH0KICAgICAgICB9Owog\nICAgfQoKICAgIC8qKgogICAgICogQ29udmVydCB0aGUgZ2l2ZW4gdGhyb3dh\nYmxlIHRvIHRoZSBwcm9wZXIgcGVyc2lzdGVuY2UgZXhjZXB0aW9uLgogICAg\nICovCiAgICBwdWJsaWMgc3RhdGljIFJ1bnRpbWVFeGNlcHRpb24gdG9QZXJz\naXN0ZW5jZUV4Y2VwdGlvbihUaHJvd2FibGUgdCkgewogICAgICAgIHJldHVy\nbiAoUnVudGltZUV4Y2VwdGlvbikgdHJhbnNsYXRlRXhjZXB0aW9uKHQsIHRy\ndWUpOwogICAgfQoKICAgIC8qKgogICAgICogVHJhbnNsYXRlIHRoZSBnaXZl\nbiBleGNlcHRpb24uCiAgICAgKgogICAgICogQHBhcmFtIGNoZWNrZWQgd2hl\ndGhlciB0byB0cmFuc2xhdGUgY2hlY2tlZCBleGNlcHRpb25zCiAgICAgKi8K\nICAgIHByaXZhdGUgc3RhdGljIFRocm93YWJsZSB0cmFuc2xhdGVFeGNlcHRp\nb24oVGhyb3dhYmxlIHQsIGJvb2xlYW4gY2hlY2tlZCkgewogICAgICAgIGlm\nIChpc1BlcnNpc3RlbmNlRXhjZXB0aW9uKHQpKQogICAgICAgICAgICByZXR1\ncm4gdDsKCiAgICAgICAgLy8gaW1tZWRpYXRlbHkgdGhyb3cgZXJyb3JzCiAg\nICAgICAgaWYgKHQgaW5zdGFuY2VvZiBFcnJvcikKICAgICAgICAgICAgdGhy\nb3cgKEVycm9yKSB0OwoKICAgICAgICBPcGVuSlBBRXhjZXB0aW9uIGtlOwog\nICAgICAgIGlmICghKHQgaW5zdGFuY2VvZiBPcGVuSlBBRXhjZXB0aW9uKSkg\newogICAgICAgICAgICBpZiAoIWNoZWNrZWQgfHwgdCBpbnN0YW5jZW9mIFJ1\nbnRpbWVFeGNlcHRpb24pCiAgICAgICAgICAgICAgICByZXR1cm4gdDsKICAg\nICAgICAgICAga2UgPSBuZXcgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuR2Vu\nZXJhbEV4Y2VwdGlvbih0LmdldE1lc3NhZ2UoKSk7CiAgICAgICAgICAgIGtl\nLnNldFN0YWNrVHJhY2UodC5nZXRTdGFja1RyYWNlKCkpOwogICAgICAgICAg\nICByZXR1cm4ga2U7CiAgICAgICAgfQoKICAgICAgICAvLyBpZiBvbmx5IG5l\nc3RlZCBleGNlcHRpb24gaXMgYSBwZXJzaXN0ZW5jZSBvbmUsIHJldHVybiBp\ndCBkaXJlY3RseQogICAgICAgIGtlID0gKE9wZW5KUEFFeGNlcHRpb24pIHQ7\nCiAgICAgICAgaWYgKGtlLmdldE5lc3RlZFRocm93YWJsZXMoKS5sZW5ndGgg\nPT0gMQogICAgICAgICAgICAmJiBpc1BlcnNpc3RlbmNlRXhjZXB0aW9uKGtl\nLmdldENhdXNlKCkpKQogICAgICAgICAgICByZXR1cm4ga2UuZ2V0Q2F1c2Uo\nKTsKCiAgICAgICAgLy8gUnVudGltZUV4Y2VwdGlvbnMgdGhyb3duIGZyb20g\nY2FsbGJhY2tzIHNob3VsZCBiZSB0aHJvd24gZGlyZWN0bHkKICAgICAgICBp\nZiAoa2UuZ2V0VHlwZSgpID09IE9wZW5KUEFFeGNlcHRpb24uVVNFUgogICAg\nICAgICAgICAmJiBrZS5nZXRTdWJ0eXBlKCkgPT0gVXNlckV4Y2VwdGlvbi5D\nQUxMQkFDSwogICAgICAgICAgICAmJiBrZS5nZXROZXN0ZWRUaHJvd2FibGVz\nKCkubGVuZ3RoID09IDEpIHsKICAgICAgICAgICAgVGhyb3dhYmxlIGUgPSBr\nZS5nZXRDYXVzZSgpOwogICAgICAgICAgICBpZiAoZSBpbnN0YW5jZW9mIElu\ndm9jYXRpb25UYXJnZXRFeGNlcHRpb24pCiAgICAgICAgICAgICAgICBlID0g\nZS5nZXRDYXVzZSgpOwoKICAgICAgICAgICAgaWYgKGUgaW5zdGFuY2VvZiBS\ndW50aW1lRXhjZXB0aW9uKQogICAgICAgICAgICAgICAgcmV0dXJuIGU7CiAg\nICAgICAgfQoKICAgICAgICAvLyBwZXJmb3JtIGludGVsbGlnZW50IHRyYW5z\nbGF0aW9uIG9mIG9wZW5qcGEgZXhjZXB0aW9ucwogICAgICAgIHN3aXRjaCAo\na2UuZ2V0VHlwZSgpKSB7CiAgICAgICAgICAgIGNhc2UgT3BlbkpQQUV4Y2Vw\ndGlvbi5TVE9SRToKICAgICAgICAgICAgICAgIHJldHVybiB0cmFuc2xhdGVT\ndG9yZUV4Y2VwdGlvbihrZSk7CiAgICAgICAgICAgIGNhc2UgT3BlbkpQQUV4\nY2VwdGlvbi5VU0VSOgogICAgICAgICAgICAgICAgcmV0dXJuIHRyYW5zbGF0\nZVVzZXJFeGNlcHRpb24oa2UpOwogICAgICAgICAgICBkZWZhdWx0OgogICAg\nICAgICAgICAgICAgcmV0dXJuIHRyYW5zbGF0ZUdlbmVyYWxFeGNlcHRpb24o\na2UpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIFRyYW5zbGF0\nZSB0aGUgZ2l2ZW4gc3RvcmUgZXhjZXB0aW9uLgogICAgICovCiAgICBwcml2\nYXRlIHN0YXRpYyBUaHJvd2FibGUgdHJhbnNsYXRlU3RvcmVFeGNlcHRpb24o\nT3BlbkpQQUV4Y2VwdGlvbiBrZSkgewogICAgICAgIEV4Y2VwdGlvbiBlOwog\nICAgICAgIHN3aXRjaCAoa2UuZ2V0U3VidHlwZSgpKSB7CiAgICAgICAgICAg\nIGNhc2UgU3RvcmVFeGNlcHRpb24uT0JKRUNUX05PVF9GT1VORDoKICAgICAg\nICAgICAgICAgIGUgPSBuZXcgb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNpc3Rl\nbmNlLkVudGl0eU5vdEZvdW5kRXhjZXB0aW9uCiAgICAgICAgICAgICAgICAg\nICAgKGtlLmdldE1lc3NhZ2UoKSwgZ2V0TmVzdGVkVGhyb3dhYmxlcyhrZSks\nCiAgICAgICAgICAgICAgICAgICAgICAgIGdldEZhaWxlZE9iamVjdChrZSks\nIGtlLmlzRmF0YWwoKSk7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAg\nICAgICAgY2FzZSBTdG9yZUV4Y2VwdGlvbi5PUFRJTUlTVElDOgogICAgICAg\nICAgICBjYXNlIFN0b3JlRXhjZXB0aW9uLkxPQ0s6CiAgICAgICAgICAgICAg\nICBlID0gbmV3IG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5PcHRp\nbWlzdGljTG9ja0V4Y2VwdGlvbgogICAgICAgICAgICAgICAgICAgIChrZS5n\nZXRNZXNzYWdlKCksIGdldE5lc3RlZFRocm93YWJsZXMoa2UpLAogICAgICAg\nICAgICAgICAgICAgICAgICBnZXRGYWlsZWRPYmplY3Qoa2UpLCBrZS5pc0Zh\ndGFsKCkpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNh\nc2UgU3RvcmVFeGNlcHRpb24uT0JKRUNUX0VYSVNUUzoKICAgICAgICAgICAg\nICAgIGUgPSBuZXcgb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNlLkVu\ndGl0eUV4aXN0c0V4Y2VwdGlvbgogICAgICAgICAgICAgICAgICAgIChrZS5n\nZXRNZXNzYWdlKCksIGdldE5lc3RlZFRocm93YWJsZXMoa2UpLAogICAgICAg\nICAgICAgICAgICAgICAgICBnZXRGYWlsZWRPYmplY3Qoa2UpLCBrZS5pc0Zh\ndGFsKCkpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGRl\nZmF1bHQ6CiAgICAgICAgICAgICAgICBlID0gbmV3IG9yZy5hcGFjaGUub3Bl\nbmpwYS5wZXJzaXN0ZW5jZS5QZXJzaXN0ZW5jZUV4Y2VwdGlvbgogICAgICAg\nICAgICAgICAgICAgIChrZS5nZXRNZXNzYWdlKCksIGdldE5lc3RlZFRocm93\nYWJsZXMoa2UpLAogICAgICAgICAgICAgICAgICAgICAgICBnZXRGYWlsZWRP\nYmplY3Qoa2UpLCBrZS5pc0ZhdGFsKCkpOwogICAgICAgIH0KICAgICAgICBl\nLnNldFN0YWNrVHJhY2Uoa2UuZ2V0U3RhY2tUcmFjZSgpKTsKICAgICAgICBy\nZXR1cm4gZTsKICAgIH0KCiAgICAvKioKICAgICAqIFRyYW5zbGF0ZSB0aGUg\nZ2l2ZW4gdXNlciBleGNlcHRpb24uCiAgICAgKi8KICAgIHByaXZhdGUgc3Rh\ndGljIEV4Y2VwdGlvbiB0cmFuc2xhdGVVc2VyRXhjZXB0aW9uKE9wZW5KUEFF\neGNlcHRpb24ga2UpIHsKICAgICAgICBFeGNlcHRpb24gZTsKICAgICAgICBz\nd2l0Y2ggKGtlLmdldFN1YnR5cGUoKSkgewogICAgICAgICAgICBjYXNlIFVz\nZXJFeGNlcHRpb24uTk9fVFJBTlNBQ1RJT046CiAgICAgICAgICAgICAgICBl\nID0gbmV3IAogICAgICAgICAgICAgICAgICAgIG9yZy5hcGFjaGUub3Blbmpw\nYS5wZXJzaXN0ZW5jZS5UcmFuc2FjdGlvblJlcXVpcmVkRXhjZXB0aW9uCiAg\nICAgICAgICAgICAgICAgICAgICAgIChrZS5nZXRNZXNzYWdlKCksIGdldE5l\nc3RlZFRocm93YWJsZXMoa2UpLAogICAgICAgICAgICAgICAgICAgICAgICAg\nICAgZ2V0RmFpbGVkT2JqZWN0KGtlKSwga2UuaXNGYXRhbCgpKTsKICAgICAg\nICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIFVzZXJFeGNlcHRp\nb24uTk9fUkVTVUxUOgogICAgICAgICAgICAgICAgZSA9IG5ldyBvcmcuYXBh\nY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuTm9SZXN1bHRFeGNlcHRpb24KICAg\nICAgICAgICAgICAgICAgICAoa2UuZ2V0TWVzc2FnZSgpLCBnZXROZXN0ZWRU\naHJvd2FibGVzKGtlKSwKICAgICAgICAgICAgICAgICAgICAgICAgZ2V0RmFp\nbGVkT2JqZWN0KGtlKSwga2UuaXNGYXRhbCgpKTsKICAgICAgICAgICAgICAg\nIGJyZWFrOwogICAgICAgICAgICBjYXNlIFVzZXJFeGNlcHRpb24uTk9OX1VO\nSVFVRV9SRVNVTFQ6CiAgICAgICAgICAgICAgICBlID0gbmV3IG9yZy5hcGFj\naGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5Ob25VbmlxdWVSZXN1bHRFeGNlcHRp\nb24KICAgICAgICAgICAgICAgICAgICAoa2UuZ2V0TWVzc2FnZSgpLCBnZXRO\nZXN0ZWRUaHJvd2FibGVzKGtlKSwKICAgICAgICAgICAgICAgICAgICAgICAg\nZ2V0RmFpbGVkT2JqZWN0KGtlKSwga2UuaXNGYXRhbCgpKTsKICAgICAgICAg\nICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIFVzZXJFeGNlcHRpb24u\nSU5WQUxJRF9TVEFURToKICAgICAgICAgICAgICAgIGUgPSBuZXcgb3JnLmFw\nYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNlLkludmFsaWRTdGF0ZUV4Y2VwdGlv\nbgogICAgICAgICAgICAgICAgICAgIChrZS5nZXRNZXNzYWdlKCksIGdldE5l\nc3RlZFRocm93YWJsZXMoa2UpLAogICAgICAgICAgICAgICAgICAgICAgICBn\nZXRGYWlsZWRPYmplY3Qoa2UpLCBrZS5pc0ZhdGFsKCkpOwogICAgICAgICAg\nICAgICAgYnJlYWs7CiAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAg\nICAgICBlID0gbmV3IG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5B\ncmd1bWVudEV4Y2VwdGlvbgogICAgICAgICAgICAgICAgICAgIChrZS5nZXRN\nZXNzYWdlKCksIGdldE5lc3RlZFRocm93YWJsZXMoa2UpLAogICAgICAgICAg\nICAgICAgICAgICAgICBnZXRGYWlsZWRPYmplY3Qoa2UpLCBrZS5pc0ZhdGFs\nKCkpOwogICAgICAgIH0KICAgICAgICBlLnNldFN0YWNrVHJhY2Uoa2UuZ2V0\nU3RhY2tUcmFjZSgpKTsKICAgICAgICByZXR1cm4gZTsKICAgIH0KCiAgICAv\nKioKICAgICAqIFRyYW5zbGF0ZSB0aGUgZ2l2ZW4gZ2VuZXJhbCBleGNlcHRp\nb24uCiAgICAgKi8KICAgIHByaXZhdGUgc3RhdGljIFRocm93YWJsZSB0cmFu\nc2xhdGVHZW5lcmFsRXhjZXB0aW9uKE9wZW5KUEFFeGNlcHRpb24ga2UpIHsK\nICAgICAgICBFeGNlcHRpb24gZSA9IG5ldyBvcmcuYXBhY2hlLm9wZW5qcGEu\ncGVyc2lzdGVuY2UuUGVyc2lzdGVuY2VFeGNlcHRpb24KICAgICAgICAgICAg\nKGtlLmdldE1lc3NhZ2UoKSwgZ2V0TmVzdGVkVGhyb3dhYmxlcyhrZSksCiAg\nICAgICAgICAgICAgICBnZXRGYWlsZWRPYmplY3Qoa2UpLCBrZS5pc0ZhdGFs\nKCkpOwogICAgICAgIGUuc2V0U3RhY2tUcmFjZShrZS5nZXRTdGFja1RyYWNl\nKCkpOwogICAgICAgIHJldHVybiBlOwogICAgfQoKICAgIC8qKgogICAgICog\nUmV0dXJuIHRydWUgaWYgdGhlIGdpdmVuIGV4Y2VwdGlvbiBpcyBhIHBlcnNp\nc3RlbmNlIGV4Y2VwdGlvbi4KICAgICAqLwogICAgcHJpdmF0ZSBzdGF0aWMg\nYm9vbGVhbiBpc1BlcnNpc3RlbmNlRXhjZXB0aW9uKFRocm93YWJsZSB0KSB7\nCiAgICAgICAgcmV0dXJuIHQuZ2V0Q2xhc3MoKS5nZXROYW1lKCkKICAgICAg\nICAgICAgLnN0YXJ0c1dpdGgoIm9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0\nZW5jZS4iKTsKICAgIH0KCiAgICAvKioKICAgICAqIFRyYW5zbGF0ZSB0aGUg\nbmVzdGVkIHRocm93YWJsZXMgb2YgdGhlIGdpdmVuIG9wZW5qcGEgZXhjZXB0\naW9uIGludG8KICAgICAqIG5lc3RlZCB0aHJvd2FibGVzIGZvciBhIHBlcnNp\nc3RlbmNlIGV4Y2VwdGlvbi4KICAgICAqLwogICAgcHJpdmF0ZSBzdGF0aWMg\nVGhyb3dhYmxlW10gZ2V0TmVzdGVkVGhyb3dhYmxlcyhPcGVuSlBBRXhjZXB0\naW9uIGtlKSB7CiAgICAgICAgVGhyb3dhYmxlW10gbmVzdGVkID0ga2UuZ2V0\nTmVzdGVkVGhyb3dhYmxlcygpOwogICAgICAgIGlmIChuZXN0ZWQubGVuZ3Ro\nID09IDApCiAgICAgICAgICAgIHJldHVybiBuZXN0ZWQ7CgogICAgICAgIFRo\ncm93YWJsZVtdIHRyYW5zID0gbmV3IFRocm93YWJsZVtuZXN0ZWQubGVuZ3Ro\nXTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IG5lc3RlZC5sZW5ndGg7\nIGkrKykKICAgICAgICAgICAgdHJhbnNbaV0gPSB0cmFuc2xhdGVFeGNlcHRp\nb24obmVzdGVkW2ldLCBmYWxzZSk7CiAgICAgICAgcmV0dXJuIHRyYW5zOwog\nICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRoZSBmYWlsZWQgb2JqZWN0\nIGZvciB0aGUgZ2l2ZW4gZXhjZXB0aW9uLCBwZXJmb3JtaW5nIGFueQogICAg\nICogbmVjZXNzYXJ5IGNvbnZlcnNpb25zLgogICAgICovCiAgICBwcml2YXRl\nIHN0YXRpYyBPYmplY3QgZ2V0RmFpbGVkT2JqZWN0KE9wZW5KUEFFeGNlcHRp\nb24ga2UpIHsKICAgICAgICBPYmplY3QgbyA9IGtlLmdldEZhaWxlZE9iamVj\ndCgpOwogICAgICAgIGlmIChvID09IG51bGwpCiAgICAgICAgICAgIHJldHVy\nbiBudWxsOwogICAgICAgIGlmIChvIGluc3RhbmNlb2YgQnJva2VyKQogICAg\nICAgICAgICByZXR1cm4gSlBBRmFjYWRlSGVscGVyLnRvRW50aXR5TWFuYWdl\ncigoQnJva2VyKSBvKTsKICAgICAgICByZXR1cm4gSlBBRmFjYWRlSGVscGVy\nLmZyb21PcGVuSlBBT2JqZWN0SWQobyk7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBIZWxwZXIgbWV0aG9kIHRvIGV4dHJhY3QgYSBuZXN0ZWQgZXhjZXB0aW9u\nIGZyb20gYW4gaW50ZXJuYWwgbmVzdGVkCiAgICAgKiBhcnJheSBpbiBhIHNh\nZmUgd2F5LgogICAgICovCiAgICBzdGF0aWMgVGhyb3dhYmxlIGdldENhdXNl\nKFRocm93YWJsZVtdIG5lc3RlZCkgewogICAgICAgIGlmIChuZXN0ZWQgPT0g\nbnVsbCB8fCBuZXN0ZWQubGVuZ3RoID09IDApCiAgICAgICAgICAgIHJldHVy\nbiBudWxsOwoJCXJldHVybiBuZXN0ZWRbMF07Cgl9Cn0K\n","encoding":"base64"}

