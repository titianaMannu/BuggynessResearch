{"sha":"dbbc4bb7fa6355e9bff9c6b698238335bafdc831","node_id":"MDQ6QmxvYjIwNjM2NDpkYmJjNGJiN2ZhNjM1NWU5YmZmOWM2YjY5ODIzODMzNWJhZmRjODMx","size":13256,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/dbbc4bb7fa6355e9bff9c6b698238335bafdc831","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2U7CgppbXBv\ncnQgamF2YS5pby5TZXJpYWxpemFibGU7CmltcG9ydCBqYXZhLmxhbmcuYW5u\nb3RhdGlvbi5Bbm5vdGF0aW9uOwppbXBvcnQgamF2YS5sYW5nLnJlZmxlY3Qu\nQW5ub3RhdGVkRWxlbWVudDsKaW1wb3J0IGphdmEubGFuZy5yZWZsZWN0LkZp\nZWxkOwppbXBvcnQgamF2YS5sYW5nLnJlZmxlY3QuTWVtYmVyOwppbXBvcnQg\namF2YS5sYW5nLnJlZmxlY3QuTWV0aG9kOwppbXBvcnQgamF2YS5sYW5nLnJl\nZmxlY3QuTW9kaWZpZXI7CmltcG9ydCBqYXZhLnNlY3VyaXR5LkFjY2Vzc0Nv\nbnRyb2xsZXI7CmltcG9ydCBqYXZhLnV0aWwuSGFzaE1hcDsKaW1wb3J0IGph\ndmEudXRpbC5IYXNoU2V0OwppbXBvcnQgamF2YS51dGlsLk1hcDsKaW1wb3J0\nIGphdmEudXRpbC5TZXQ7CmltcG9ydCBqYXZhLnV0aWwuTGlzdDsKaW1wb3J0\nIGphdmEudXRpbC5BcnJheUxpc3Q7CmltcG9ydCBqYXZheC5wZXJzaXN0ZW5j\nZS5CYXNpYzsKaW1wb3J0IGphdmF4LnBlcnNpc3RlbmNlLkVtYmVkZGFibGU7\nCmltcG9ydCBqYXZheC5wZXJzaXN0ZW5jZS5FbWJlZGRlZDsKaW1wb3J0IGph\ndmF4LnBlcnNpc3RlbmNlLkVtYmVkZGVkSWQ7CmltcG9ydCBqYXZheC5wZXJz\naXN0ZW5jZS5NYW55VG9NYW55OwppbXBvcnQgamF2YXgucGVyc2lzdGVuY2Uu\nTWFueVRvT25lOwppbXBvcnQgamF2YXgucGVyc2lzdGVuY2UuT25lVG9NYW55\nOwppbXBvcnQgamF2YXgucGVyc2lzdGVuY2UuT25lVG9PbmU7CmltcG9ydCBq\nYXZheC5wZXJzaXN0ZW5jZS5Qb3N0TG9hZDsKaW1wb3J0IGphdmF4LnBlcnNp\nc3RlbmNlLlBvc3RQZXJzaXN0OwppbXBvcnQgamF2YXgucGVyc2lzdGVuY2Uu\nUG9zdFJlbW92ZTsKaW1wb3J0IGphdmF4LnBlcnNpc3RlbmNlLlBvc3RVcGRh\ndGU7CmltcG9ydCBqYXZheC5wZXJzaXN0ZW5jZS5QcmVQZXJzaXN0OwppbXBv\ncnQgamF2YXgucGVyc2lzdGVuY2UuUHJlUmVtb3ZlOwppbXBvcnQgamF2YXgu\ncGVyc2lzdGVuY2UuUHJlVXBkYXRlOwppbXBvcnQgamF2YXgucGVyc2lzdGVu\nY2UuVHJhbnNpZW50OwoKaW1wb3J0IG9yZy5hcGFjaGUuY29tbW9ucy5sYW5n\nLlN0cmluZ1V0aWxzOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51\ndGlsLkoyRG9Qcml2NUhlbHBlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3Blbmpw\nYS5saWIudXRpbC5Mb2NhbGl6ZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEubGliLmxvZy5Mb2c7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0\nYS5BYnN0cmFjdE1ldGFEYXRhRGVmYXVsdHM7CmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEubWV0YS5DbGFzc01ldGFEYXRhOwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLm1ldGEuRmllbGRNZXRhRGF0YTsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5tZXRhLkphdmFUeXBlczsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS5tZXRhLlZhbHVlTWV0YURhdGE7CmltcG9ydCBzdGF0aWMgb3Jn\nLmFwYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNlLlBlcnNpc3RlbmNlU3RyYXRl\nZ3kuKjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLk1ldGFEYXRh\nRXhjZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmNvbmYuT3Bl\nbkpQQUNvbmZpZ3VyYXRpb247CgovKioKICogSlBBLWJhc2VkIG1ldGFkYXRh\nIGRlZmF1bHRzLgogKgogKiBAYXV0aG9yIFBhdHJpY2sgTGluc2tleQogKiBA\nYXV0aG9yIEFiZSBXaGl0ZQogKiBAbm9qYXZhZG9jCiAqLwpwdWJsaWMgY2xh\nc3MgUGVyc2lzdGVuY2VNZXRhRGF0YURlZmF1bHRzCiAgICBleHRlbmRzIEFi\nc3RyYWN0TWV0YURhdGFEZWZhdWx0cyB7CgogICAgcHJpdmF0ZSBib29sZWFu\nIF9hbGxvd3NNdWx0aXBsZU1ldGhvZHNGb3JTYW1lQ2FsbGJhY2sgPSBmYWxz\nZTsKCiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBMb2NhbGl6ZXIgX2xvYyA9\nIExvY2FsaXplci5mb3JQYWNrYWdlCiAgICAgICAgKFBlcnNpc3RlbmNlTWV0\nYURhdGFEZWZhdWx0cy5jbGFzcyk7CgogICAgcHJpdmF0ZSBzdGF0aWMgZmlu\nYWwgTWFwPENsYXNzLCBQZXJzaXN0ZW5jZVN0cmF0ZWd5PiBfc3RyYXRzID0K\nICAgICAgICBuZXcgSGFzaE1hcDxDbGFzcywgUGVyc2lzdGVuY2VTdHJhdGVn\neT4oKTsKICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIFNldDxTdHJpbmc+IF9p\nZ25vcmVkQW5ub3MgPSBuZXcgSGFzaFNldDxTdHJpbmc+KCk7CgogICAgc3Rh\ndGljIHsKICAgICAgICBfc3RyYXRzLnB1dChCYXNpYy5jbGFzcywgQkFTSUMp\nOwogICAgICAgIF9zdHJhdHMucHV0KE1hbnlUb09uZS5jbGFzcywgTUFOWV9P\nTkUpOwogICAgICAgIF9zdHJhdHMucHV0KE9uZVRvT25lLmNsYXNzLCBPTkVf\nT05FKTsKICAgICAgICBfc3RyYXRzLnB1dChFbWJlZGRlZC5jbGFzcywgRU1C\nRURERUQpOwogICAgICAgIF9zdHJhdHMucHV0KEVtYmVkZGVkSWQuY2xhc3Ms\nIEVNQkVEREVEKTsKICAgICAgICBfc3RyYXRzLnB1dChPbmVUb01hbnkuY2xh\nc3MsIE9ORV9NQU5ZKTsKICAgICAgICBfc3RyYXRzLnB1dChNYW55VG9NYW55\nLmNsYXNzLCBNQU5ZX01BTlkpOwogICAgICAgIF9zdHJhdHMucHV0KFBlcnNp\nc3RlbnQuY2xhc3MsIFBFUlMpOwogICAgICAgIF9zdHJhdHMucHV0KFBlcnNp\nc3RlbnRDb2xsZWN0aW9uLmNsYXNzLCBQRVJTX0NPTEwpOwogICAgICAgIF9z\ndHJhdHMucHV0KFBlcnNpc3RlbnRNYXAuY2xhc3MsIFBFUlNfTUFQKTsKCiAg\nICAgICAgX2lnbm9yZWRBbm5vcy5hZGQoRGV0YWNoZWRTdGF0ZS5jbGFzcy5n\nZXROYW1lKCkpOwogICAgICAgIF9pZ25vcmVkQW5ub3MuYWRkKFBvc3RMb2Fk\nLmNsYXNzLmdldE5hbWUoKSk7CiAgICAgICAgX2lnbm9yZWRBbm5vcy5hZGQo\nUG9zdFBlcnNpc3QuY2xhc3MuZ2V0TmFtZSgpKTsKICAgICAgICBfaWdub3Jl\nZEFubm9zLmFkZChQb3N0UmVtb3ZlLmNsYXNzLmdldE5hbWUoKSk7CiAgICAg\nICAgX2lnbm9yZWRBbm5vcy5hZGQoUG9zdFVwZGF0ZS5jbGFzcy5nZXROYW1l\nKCkpOwogICAgICAgIF9pZ25vcmVkQW5ub3MuYWRkKFByZVBlcnNpc3QuY2xh\nc3MuZ2V0TmFtZSgpKTsKICAgICAgICBfaWdub3JlZEFubm9zLmFkZChQcmVS\nZW1vdmUuY2xhc3MuZ2V0TmFtZSgpKTsKICAgICAgICBfaWdub3JlZEFubm9z\nLmFkZChQcmVVcGRhdGUuY2xhc3MuZ2V0TmFtZSgpKTsKICAgIH0KCiAgICBw\ndWJsaWMgUGVyc2lzdGVuY2VNZXRhRGF0YURlZmF1bHRzKCkgewogICAgICAg\nIHNldENhbGxiYWNrTW9kZShDQUxMQkFDS19SRVRIUk9XIHwgQ0FMTEJBQ0tf\nUk9MTEJBQ0sgfAogICAgICAgICAgICBDQUxMQkFDS19GQUlMX0ZBU1QpOwog\nICAgICAgIHNldERhdGFTdG9yZU9iamVjdElkRmllbGRVbndyYXBwZWQodHJ1\nZSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIGNvZGUgZm9y\nIHRoZSBzdHJhdGVneSBvZiB0aGUgZ2l2ZW4gbWVtYmVyLiBSZXR1cm4gbnVs\nbCBpZgogICAgICogbm8gc3RyYXRlZ3kuCiAgICAgKi8KICAgIHB1YmxpYyBz\ndGF0aWMgUGVyc2lzdGVuY2VTdHJhdGVneSBnZXRQZXJzaXN0ZW5jZVN0cmF0\nZWd5CiAgICAgICAgKEZpZWxkTWV0YURhdGEgZm1kLCBNZW1iZXIgbWVtYmVy\nKSB7CiAgICAgICAgaWYgKG1lbWJlciA9PSBudWxsKQogICAgICAgICAgICBy\nZXR1cm4gbnVsbDsKICAgICAgICBBbm5vdGF0ZWRFbGVtZW50IGVsID0gKEFu\nbm90YXRlZEVsZW1lbnQpIG1lbWJlcjsKICAgICAgICBpZiAoKChCb29sZWFu\nKSBBY2Nlc3NDb250cm9sbGVyLmRvUHJpdmlsZWdlZChKMkRvUHJpdjVIZWxw\nZXIKICAgICAgICAgICAgLmlzQW5ub3RhdGlvblByZXNlbnRBY3Rpb24oZWws\nIFRyYW5zaWVudC5jbGFzcykpKS5ib29sZWFuVmFsdWUoKSkKICAgICAgICAg\nICAgcmV0dXJuIFRSQU5TSUVOVDsKICAgICAgICBpZiAoZm1kICE9IG51bGwK\nICAgICAgICAgICAgJiYgZm1kLmdldE1hbmFnZW1lbnQoKSAhPSBGaWVsZE1l\ndGFEYXRhLk1BTkFHRV9QRVJTSVNURU5UKQogICAgICAgICAgICByZXR1cm4g\nbnVsbDsKCiAgICAgICAgLy8gbG9vayBmb3IgcGVyc2lzdGVuY2Ugc3RyYXRl\nZ3kgaW4gYW5ub3RhdGlvbiB0YWJsZQogICAgICAgIFBlcnNpc3RlbmNlU3Ry\nYXRlZ3kgcHN0cmF0ID0gbnVsbDsKICAgICAgICBmb3IgKEFubm90YXRpb24g\nYW5ubyA6IGVsLmdldERlY2xhcmVkQW5ub3RhdGlvbnMoKSkgewogICAgICAg\nICAgICBpZiAocHN0cmF0ICE9IG51bGwgJiYgX3N0cmF0cy5jb250YWluc0tl\neShhbm5vLmFubm90YXRpb25UeXBlKCkpKQogICAgICAgICAgICAgICAgdGhy\nb3cgbmV3IE1ldGFEYXRhRXhjZXB0aW9uKF9sb2MuZ2V0KCJhbHJlYWR5LXBl\ncnMiLCBtZW1iZXIpKTsKICAgICAgICAgICAgaWYgKHBzdHJhdCA9PSBudWxs\nKQogICAgICAgICAgICAgICAgcHN0cmF0ID0gX3N0cmF0cy5nZXQoYW5uby5h\nbm5vdGF0aW9uVHlwZSgpKTsKICAgICAgICB9CiAgICAgICAgaWYgKHBzdHJh\ndCAhPSBudWxsKQogICAgICAgICAgICByZXR1cm4gcHN0cmF0OwoKICAgICAg\nICBDbGFzcyB0eXBlOwogICAgICAgIGludCBjb2RlOwogICAgICAgIGlmIChm\nbWQgIT0gbnVsbCkgewogICAgICAgICAgICB0eXBlID0gZm1kLmdldFR5cGUo\nKTsKICAgICAgICAgICAgY29kZSA9IGZtZC5nZXRUeXBlQ29kZSgpOwogICAg\nICAgIH0gZWxzZSBpZiAobWVtYmVyIGluc3RhbmNlb2YgRmllbGQpIHsKICAg\nICAgICAgICAgdHlwZSA9ICgoRmllbGQpIG1lbWJlcikuZ2V0VHlwZSgpOwog\nICAgICAgICAgICBjb2RlID0gSmF2YVR5cGVzLmdldFR5cGVDb2RlKHR5cGUp\nOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHR5cGUgPSAoKE1ldGhv\nZCkgbWVtYmVyKS5nZXRSZXR1cm5UeXBlKCk7CiAgICAgICAgICAgIGNvZGUg\nPSBKYXZhVHlwZXMuZ2V0VHlwZUNvZGUodHlwZSk7CiAgICAgICAgfQoKICAg\nICAgICBzd2l0Y2ggKGNvZGUpIHsKICAgICAgICAgICAgY2FzZSBKYXZhVHlw\nZXMuQVJSQVk6CiAgICAgICAgICAgICAgICBpZiAodHlwZSA9PSBieXRlW10u\nY2xhc3MKICAgICAgICAgICAgICAgICAgICB8fCB0eXBlID09IGNoYXJbXS5j\nbGFzcwogICAgICAgICAgICAgICAgICAgIHx8IHR5cGUgPT0gQnl0ZVtdLmNs\nYXNzCiAgICAgICAgICAgICAgICAgICAgfHwgdHlwZSA9PSBDaGFyYWN0ZXJb\nXS5jbGFzcykKICAgICAgICAgICAgICAgICAgICByZXR1cm4gQkFTSUM7CiAg\nICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSBKYXZhVHlw\nZXMuQk9PTEVBTjoKICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuQk9PTEVB\nTl9PQko6CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLkJZVEU6CiAgICAg\nICAgICAgIGNhc2UgSmF2YVR5cGVzLkJZVEVfT0JKOgogICAgICAgICAgICBj\nYXNlIEphdmFUeXBlcy5DSEFSOgogICAgICAgICAgICBjYXNlIEphdmFUeXBl\ncy5DSEFSX09CSjoKICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuRE9VQkxF\nOgogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5ET1VCTEVfT0JKOgogICAg\nICAgICAgICBjYXNlIEphdmFUeXBlcy5GTE9BVDoKICAgICAgICAgICAgY2Fz\nZSBKYXZhVHlwZXMuRkxPQVRfT0JKOgogICAgICAgICAgICBjYXNlIEphdmFU\neXBlcy5JTlQ6CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLklOVF9PQko6\nCiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLkxPTkc6CiAgICAgICAgICAg\nIGNhc2UgSmF2YVR5cGVzLkxPTkdfT0JKOgogICAgICAgICAgICBjYXNlIEph\ndmFUeXBlcy5TSE9SVDoKICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuU0hP\nUlRfT0JKOgogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5TVFJJTkc6CiAg\nICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLkJJR0RFQ0lNQUw6CiAgICAgICAg\nICAgIGNhc2UgSmF2YVR5cGVzLkJJR0lOVEVHRVI6CiAgICAgICAgICAgIGNh\nc2UgSmF2YVR5cGVzLkRBVEU6CiAgICAgICAgICAgICAgICByZXR1cm4gQkFT\nSUM7CiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLk9CSkVDVDoKICAgICAg\nICAgICAgICAgIGlmIChFbnVtLmNsYXNzLmlzQXNzaWduYWJsZUZyb20odHlw\nZSkpCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIEJBU0lDOwogICAgICAg\nICAgICAgICAgYnJlYWs7CiAgICAgICAgfQoKICAgICAgICAvLyMjIyBFSkIz\nOiB3aGF0IGlmIGRlZmluZWQgaW4gWE1MPwogICAgICAgIGlmICgoKEJvb2xl\nYW4pIEFjY2Vzc0NvbnRyb2xsZXIuZG9Qcml2aWxlZ2VkKEoyRG9Qcml2NUhl\nbHBlcgogICAgICAgICAgICAuaXNBbm5vdGF0aW9uUHJlc2VudEFjdGlvbih0\neXBlLCBFbWJlZGRhYmxlLmNsYXNzKSkpLmJvb2xlYW5WYWx1ZSgpKQogICAg\nICAgICAgICByZXR1cm4gRU1CRURERUQ7CiAgICAgICAgaWYgKFNlcmlhbGl6\nYWJsZS5jbGFzcy5pc0Fzc2lnbmFibGVGcm9tKHR5cGUpKQogICAgICAgICAg\nICByZXR1cm4gQkFTSUM7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICB9CiAg\nICAKICAgIC8qKiAKICAgICAqIEZsYWdzIGlmIG11bHRpcGxlIG1ldGhvZHMg\nb2YgdGhlIHNhbWUgY2xhc3MgY2FuIGhhbmRsZSB0aGUgc2FtZSAKICAgICAq\nIGNhbGxiYWNrIGV2ZW50LgogICAgICovCiAgICBwdWJsaWMgYm9vbGVhbiBn\nZXRBbGxvd3NNdWx0aXBsZU1ldGhvZHNGb3JTYW1lQ2FsbGJhY2soKSB7CiAg\nICAgICAgcmV0dXJuIF9hbGxvd3NNdWx0aXBsZU1ldGhvZHNGb3JTYW1lQ2Fs\nbGJhY2s7CiAgICB9CiAgICAKICAgIC8qKiAKICAgICAqIEZsYWdzIGlmIG11\nbHRpcGxlIG1ldGhvZHMgb2YgdGhlIHNhbWUgY2xhc3MgY2FuIGhhbmRsZSB0\naGUgc2FtZSAKICAgICAqIGNhbGxiYWNrIGV2ZW50LgogICAgICovCiAgICBw\ndWJsaWMgdm9pZCBzZXRBbGxvd3NNdWx0aXBsZU1ldGhvZHNGb3JTYW1lQ2Fs\nbGJhY2soYm9vbGVhbiBmbGFnKSB7CiAgICAgICAgX2FsbG93c011bHRpcGxl\nTWV0aG9kc0ZvclNhbWVDYWxsYmFjayA9IGZsYWc7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBBdXRvLWNvbmZpZ3VyYXRpb24gbWV0aG9kIGZvciB0aGUgZGVm\nYXVsdCBhY2Nlc3MgdHlwZSBvZiBiYXNlIGNsYXNzZXMgCiAgICAgKiB3aXRo\nIEFDQ0VTU19VTktOT1dOCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldERl\nZmF1bHRBY2Nlc3NUeXBlKFN0cmluZyB0eXBlKSB7CiAgICAgICAgaWYgKHR5\ncGUgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIGlmICgi\nUFJPUEVSVFkiLmVxdWFscyh0eXBlLnRvVXBwZXJDYXNlKCkpKQogICAgICAg\nICAgICBzZXREZWZhdWx0QWNjZXNzVHlwZShDbGFzc01ldGFEYXRhLkFDQ0VT\nU19QUk9QRVJUWSk7CiAgICAgICAgZWxzZQogICAgICAgICAgICBzZXREZWZh\ndWx0QWNjZXNzVHlwZShDbGFzc01ldGFEYXRhLkFDQ0VTU19GSUVMRCk7CiAg\nICB9CgogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgdm9pZCBwb3B1bGF0ZShD\nbGFzc01ldGFEYXRhIG1ldGEsIGludCBhY2Nlc3MpIHsKICAgICAgICBzdXBl\nci5wb3B1bGF0ZShtZXRhLCBhY2Nlc3MpOwogICAgICAgIG1ldGEuc2V0RGV0\nYWNoYWJsZSh0cnVlKTsKICAgICAgICAvLyBkbyBub3QgY2FsbCBnZXQqRmll\nbGRzIGFzIGl0IHdpbGwgbG9jayBkb3duIHRoZSBmaWVsZHMuCiAgICB9Cgog\nICAgQE92ZXJyaWRlCiAgICBwcm90ZWN0ZWQgdm9pZCBwb3B1bGF0ZShGaWVs\nZE1ldGFEYXRhIGZtZCkgewogICAgICAgIHNldENhc2NhZGVOb25lKGZtZCk7\nCiAgICAgICAgc2V0Q2FzY2FkZU5vbmUoZm1kLmdldEtleSgpKTsKICAgICAg\nICBzZXRDYXNjYWRlTm9uZShmbWQuZ2V0RWxlbWVudCgpKTsKICAgIH0KCiAg\nICAvKioKICAgICAqIFR1cm5zIG9mZiBhdXRvIGNhc2NhZGluZyBvZiBwZXJz\naXN0LCByZWZyZXNoLCBhdHRhY2guCiAgICAgKi8KICAgIHN0YXRpYyB2b2lk\nIHNldENhc2NhZGVOb25lKFZhbHVlTWV0YURhdGEgdm1kKSB7CiAgICAgICAg\ndm1kLnNldENhc2NhZGVQZXJzaXN0KFZhbHVlTWV0YURhdGEuQ0FTQ0FERV9O\nT05FKTsKICAgICAgICB2bWQuc2V0Q2FzY2FkZVJlZnJlc2goVmFsdWVNZXRh\nRGF0YS5DQVNDQURFX05PTkUpOwogICAgICAgIHZtZC5zZXRDYXNjYWRlQXR0\nYWNoKFZhbHVlTWV0YURhdGEuQ0FTQ0FERV9OT05FKTsKICAgIH0KCiAgICBA\nT3ZlcnJpZGUKICAgIHByb3RlY3RlZCBpbnQgZ2V0QWNjZXNzVHlwZShDbGFz\nc01ldGFEYXRhIG1ldGEpIHsKICAgICAgICByZXR1cm4gZ2V0QWNjZXNzVHlw\nZShtZXRhLmdldERlc2NyaWJlZFR5cGUoKSk7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBSZWN1cnNpdmUgaGVscGVyIHRvIGRldGVybWluZSBhY2Nlc3MgdHlw\nZSBiYXNlZCBvbiBhbm5vdGF0aW9uIHBsYWNlbWVudC4KICAgICAqLwogICAg\ncHJpdmF0ZSBpbnQgZ2V0QWNjZXNzVHlwZShDbGFzcyBjbHMpIHsKICAgICAg\nICAvLyB0cmF2ZXJzZWQgZW50aXJlIGhpZXJhcmNoeSB3aXRob3V0IGZpbmRp\nbmcgYW5ub3RhdGlvbnMKICAgICAgICBpZiAoY2xzID09IG51bGwgfHwgY2xz\nID09IE9iamVjdC5jbGFzcykKICAgICAgICAgICAgcmV0dXJuIENsYXNzTWV0\nYURhdGEuQUNDRVNTX1VOS05PV047CgogICAgICAgIGludCBhY2Nlc3MgPSAw\nOwogICAgICAgIGlmIChhbm5vdGF0ZWQoKEZpZWxkW10pIEFjY2Vzc0NvbnRy\nb2xsZXIuZG9Qcml2aWxlZ2VkKAogICAgICAgICAgICBKMkRvUHJpdjVIZWxw\nZXIuZ2V0RGVjbGFyZWRGaWVsZHNBY3Rpb24oY2xzKSkpLnNpemUoKSA+IDAp\nCiAgICAgICAgICAgIGFjY2VzcyB8PSBDbGFzc01ldGFEYXRhLkFDQ0VTU19G\nSUVMRDsKICAgICAgICBpZiAoYW5ub3RhdGVkKChNZXRob2RbXSkgQWNjZXNz\nQ29udHJvbGxlci5kb1ByaXZpbGVnZWQoCiAgICAgICAgICAgIEoyRG9Qcml2\nNUhlbHBlci5nZXREZWNsYXJlZE1ldGhvZHNBY3Rpb24oY2xzKSkpLnNpemUo\nKSA+IDAKICAgICAgICAgICAgfHwgY2xzLmlzSW50ZXJmYWNlKCkpIC8vIE9w\nZW5KUEEgbWFuYWdlZCBpZmFjZXMgbXVzdCB1c2UgcHJvcCBhY2Nlc3MKICAg\nICAgICAgICAgYWNjZXNzIHw9IENsYXNzTWV0YURhdGEuQUNDRVNTX1BST1BF\nUlRZOwogICAgICAgIHJldHVybiBnZXRBY2Nlc3NUeXBlKGNscy5nZXRTdXBl\ncmNsYXNzKCkpIHwgYWNjZXNzOwogICAgfQoKICAgIEBPdmVycmlkZQogICAg\ncHJvdGVjdGVkIExpc3QgZ2V0RmllbGRBY2Nlc3NOYW1lcyhDbGFzc01ldGFE\nYXRhIG1ldGEpIHsKICAgICAgICByZXR1cm4gYW5ub3RhdGVkKChGaWVsZFtd\nKSBBY2Nlc3NDb250cm9sbGVyLmRvUHJpdmlsZWdlZCgKICAgICAgICAgICAg\nSjJEb1ByaXY1SGVscGVyLmdldERlY2xhcmVkRmllbGRzQWN0aW9uKG1ldGEu\nZ2V0RGVzY3JpYmVkVHlwZSgpKSkpOwogICAgfQoKICAgIEBPdmVycmlkZQog\nICAgcHJvdGVjdGVkIExpc3QgZ2V0UHJvcGVydHlBY2Nlc3NOYW1lcyhDbGFz\nc01ldGFEYXRhIG1ldGEpIHsKICAgICAgICByZXR1cm4gYW5ub3RhdGVkKChN\nZXRob2RbXSkgQWNjZXNzQ29udHJvbGxlci5kb1ByaXZpbGVnZWQoCiAgICAg\nICAgICAgIEoyRG9Qcml2NUhlbHBlci5nZXREZWNsYXJlZE1ldGhvZHNBY3Rp\nb24obWV0YS5nZXREZXNjcmliZWRUeXBlKCkpKSk7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBSZXR1cm4gdGhlIG1lbWJlcnMgb2YgPGNvZGU+bWVtYmVyczwv\nY29kZT4gdGhhdCBoYXZlIHBlcnNpc3RlbmNlCiAgICAgKiBhbm5vdGF0aW9u\ncy4KICAgICAqLwogICAgcHJpdmF0ZSBzdGF0aWMgTGlzdCBhbm5vdGF0ZWQo\nQW5ub3RhdGVkRWxlbWVudFtdIG1lbWJlcnMpIHsKICAgICAgICBBbm5vdGF0\naW9uW10gYW5ub3M7CiAgICAgICAgU3RyaW5nIG5hbWU7CiAgICAgICAgTGlz\ndCBhbm5vdGF0ZWQgPSBuZXcgQXJyYXlMaXN0KG1lbWJlcnMubGVuZ3RoKTsK\nICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IG1lbWJlcnMubGVuZ3RoOyBp\nKyspIHsKICAgICAgICAgICAgYW5ub3MgPSAoQW5ub3RhdGlvbltdKSBBY2Nl\nc3NDb250cm9sbGVyLmRvUHJpdmlsZWdlZChKMkRvUHJpdjVIZWxwZXIKICAg\nICAgICAgICAgICAgIC5nZXRBbm5vdGF0aW9uc0FjdGlvbihtZW1iZXJzW2ld\nKSk7CiAgICAgICAgICAgIGZvciAoaW50IGogPSAwOyBqIDwgYW5ub3MubGVu\nZ3RoOyBqKyspIHsKICAgICAgICAgICAgICAgIG5hbWUgPSBhbm5vc1tqXS5h\nbm5vdGF0aW9uVHlwZSgpLmdldE5hbWUoKTsKICAgICAgICAgICAgICAgIGlm\nICgobmFtZS5zdGFydHNXaXRoKCJqYXZheC5wZXJzaXN0ZW5jZS4iKQogICAg\nICAgICAgICAgICAgICAgIHx8IG5hbWUuc3RhcnRzV2l0aCgib3JnLmFwYWNo\nZS5vcGVuanBhLnBlcnNpc3RlbmNlLiIpKQogICAgICAgICAgICAgICAgICAg\nICYmICFfaWdub3JlZEFubm9zLmNvbnRhaW5zKG5hbWUpKQogICAgICAgICAg\nICAgICAgICAgIGFubm90YXRlZC5hZGQobWVtYmVyc1tpXSk7CiAgICAgICAg\nICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIGFubm90YXRlZDsKICAg\nIH0KCiAgICBwcm90ZWN0ZWQgYm9vbGVhbiBpc0RlZmF1bHRQZXJzaXN0ZW50\nKENsYXNzTWV0YURhdGEgbWV0YSwgTWVtYmVyIG1lbWJlciwKICAgICAgICBT\ndHJpbmcgbmFtZSkgewogICAgICAgIGludCBtb2RzID0gbWVtYmVyLmdldE1v\nZGlmaWVycygpOwogICAgICAgIGlmIChNb2RpZmllci5pc1RyYW5zaWVudCht\nb2RzKSkKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoKICAgICAgICBpZiAo\nbWVtYmVyIGluc3RhbmNlb2YgTWV0aG9kKSB7CiAgICAgICAgICAgIHRyeSB7\nCiAgICAgICAgICAgICAgICAvLyBjaGVjayBmb3Igc2V0dGVycyBmb3IgbWV0\naG9kcwogICAgICAgICAgICAgICAgTWV0aG9kIHNldHRlciA9IChNZXRob2Qp\nIEFjY2Vzc0NvbnRyb2xsZXIuZG9Qcml2aWxlZ2VkKAogICAgICAgICAgICAg\nICAgICAgIEoyRG9Qcml2NUhlbHBlci5nZXREZWNsYXJlZE1ldGhvZEFjdGlv\nbigKICAgICAgICAgICAgICAgICAgICAgICAgbWV0YS5nZXREZXNjcmliZWRU\neXBlKCksICJzZXQiICsKICAgICAgICAgICAgICAgICAgICAgICAgU3RyaW5n\nVXRpbHMuY2FwaXRhbGl6ZShuYW1lKSwgbmV3IENsYXNzW10geyAKICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICgoTWV0aG9kKSBtZW1iZXIpLmdldFJl\ndHVyblR5cGUoKSB9KSk7CiAgICAgICAgICAgICAgICBpZiAoc2V0dGVyID09\nIG51bGwgJiYgIWlzQW5ub3RhdGVkVHJhbnNpZW50KG1lbWJlcikpIHsKICAg\nICAgICAgICAgICAgICAgICBsb2dOb1NldHRlcihtZXRhLCBuYW1lLCBudWxs\nKTsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAg\nICAgICAgICB9CiAgICAgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7\nCiAgICAgICAgICAgICAgICAvLyBlLmcuLCBOb1N1Y2hNZXRob2RFeGNlcHRp\nb24KICAgICAgICAgICAgICAgIGlmICghaXNBbm5vdGF0ZWRUcmFuc2llbnQo\nbWVtYmVyKSkKICAgICAgICAgICAgICAgICAgICBsb2dOb1NldHRlcihtZXRh\nLCBuYW1lLCBlKTsKICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAg\nICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgUGVyc2lzdGVuY2VTdHJh\ndGVneSBzdHJhdCA9IGdldFBlcnNpc3RlbmNlU3RyYXRlZ3kobnVsbCwgbWVt\nYmVyKTsKICAgICAgICBpZiAoc3RyYXQgPT0gbnVsbCB8fCBzdHJhdCA9PSBQ\nZXJzaXN0ZW5jZVN0cmF0ZWd5LlRSQU5TSUVOVCkKICAgICAgICAgICAgcmV0\ndXJuIGZhbHNlOwogICAgICAgIHJldHVybiB0cnVlOwoJfQoKICAgIHByaXZh\ndGUgYm9vbGVhbiBpc0Fubm90YXRlZFRyYW5zaWVudChNZW1iZXIgbWVtYmVy\nKSB7CiAgICAgICAgcmV0dXJuIG1lbWJlciBpbnN0YW5jZW9mIEFubm90YXRl\nZEVsZW1lbnQKICAgICAgICAgICAgJiYgKChCb29sZWFuKSBBY2Nlc3NDb250\ncm9sbGVyLmRvUHJpdmlsZWdlZChKMkRvUHJpdjVIZWxwZXIKICAgICAgICAg\nICAgICAgIC5pc0Fubm90YXRpb25QcmVzZW50QWN0aW9uKCgoQW5ub3RhdGVk\nRWxlbWVudCkgbWVtYmVyKSwKICAgICAgICAgICAgICAgICAgICBUcmFuc2ll\nbnQuY2xhc3MpKSkuYm9vbGVhblZhbHVlKCk7CiAgICB9CgogICAgcHJpdmF0\nZSB2b2lkIGxvZ05vU2V0dGVyKENsYXNzTWV0YURhdGEgbWV0YSwgU3RyaW5n\nIG5hbWUsIEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgTG9nIGxvZyA9IG1ldGEu\nZ2V0UmVwb3NpdG9yeSgpLmdldENvbmZpZ3VyYXRpb24oKQogICAgICAgICAg\nICAuZ2V0TG9nKE9wZW5KUEFDb25maWd1cmF0aW9uLkxPR19NRVRBREFUQSk7\nCiAgICAgICAgaWYgKGxvZy5pc1dhcm5FbmFibGVkKCkpCiAgICAgICAgICAg\nIGxvZy53YXJuKF9sb2MuZ2V0KCJuby1zZXR0ZXItZm9yLWdldHRlciIsIG5h\nbWUsCiAgICAgICAgICAgICAgICBtZXRhLmdldERlc2NyaWJlZFR5cGUoKS5n\nZXROYW1lKCkpKTsKICAgICAgICBlbHNlIGlmIChsb2cuaXNUcmFjZUVuYWJs\nZWQoKSkKICAgICAgICAgICAgLy8gbG9nIHRoZSBleGNlcHRpb24sIGlmIGFu\neSwgaWYgd2UncmUgaW4gdHJhY2UtbGV2ZWwgZGVidWdnaW5nCiAgICAgICAg\nICAgIGxvZy53YXJuKF9sb2MuZ2V0KCJuby1zZXR0ZXItZm9yLWdldHRlciIs\nIG5hbWUsCiAgICAgICAgICAgICAgICBtZXRhLmdldERlc2NyaWJlZFR5cGUo\nKS5nZXROYW1lKCkpLCBlKTsKICAgIH0KfQo=\n","encoding":"base64"}

