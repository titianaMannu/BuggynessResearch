{"sha":"c3a535c45a3328e32982b79d8d09fad55efe1e10","node_id":"MDQ6QmxvYjIwNjM2NDpjM2E1MzVjNDVhMzMyOGUzMjk4MmI3OWQ4ZDA5ZmFkNTVlZmUxZTEw","size":22410,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/c3a535c45a3328e32982b79d8d09fad55efe1e10","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2U7CgppbXBv\ncnQgamF2YS5pby5GaWxlOwppbXBvcnQgamF2YS5pby5JT0V4Y2VwdGlvbjsK\naW1wb3J0IGphdmEubmV0Lk1hbGZvcm1lZFVSTEV4Y2VwdGlvbjsKaW1wb3J0\nIGphdmEubmV0LlVSTDsKaW1wb3J0IGphdmEuc2VjdXJpdHkuQWNjZXNzQ29u\ndHJvbGxlcjsKaW1wb3J0IGphdmEuc2VjdXJpdHkuUHJpdmlsZWdlZEFjdGlv\nbkV4Y2VwdGlvbjsKaW1wb3J0IGphdmEudXRpbC5BcnJheUxpc3Q7CmltcG9y\ndCBqYXZhLnV0aWwuQ29sbGVjdGlvbnM7CmltcG9ydCBqYXZhLnV0aWwuRW51\nbWVyYXRpb247CmltcG9ydCBqYXZhLnV0aWwuTGlzdDsKaW1wb3J0IGphdmEu\ndXRpbC5NYXA7CmltcG9ydCBqYXZhLnV0aWwuTWlzc2luZ1Jlc291cmNlRXhj\nZXB0aW9uOwppbXBvcnQgamF2YXgucGVyc2lzdGVuY2Uuc3BpLlBlcnNpc3Rl\nbmNlVW5pdEluZm87CmltcG9ydCBqYXZheC5wZXJzaXN0ZW5jZS5zcGkuUGVy\nc2lzdGVuY2VVbml0VHJhbnNhY3Rpb25UeXBlOwoKaW1wb3J0IG9yZy5hcGFj\naGUuY29tbW9ucy5sYW5nLlN0cmluZ1V0aWxzOwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLmNvbmYuT3BlbkpQQUNvbmZpZ3VyYXRpb247CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEuY29uZi5PcGVuSlBBQ29uZmlndXJhdGlvbklt\ncGw7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuY29uZi5PcGVuSlBBUHJv\nZHVjdERlcml2YXRpb247CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGli\nLmNvbmYuQWJzdHJhY3RQcm9kdWN0RGVyaXZhdGlvbjsKaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS5saWIuY29uZi5Db25maWd1cmF0aW9uOwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLmxpYi5jb25mLkNvbmZpZ3VyYXRpb25Qcm92\naWRlcjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIuY29uZi5Db25m\naWd1cmF0aW9uczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIuY29u\nZi5NYXBDb25maWd1cmF0aW9uUHJvdmlkZXI7CmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEubGliLmNvbmYuUHJvZHVjdERlcml2YXRpb25zOwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLmxpYi5sb2cuTG9nOwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLmxpYi5tZXRhLlhNTE1ldGFEYXRhUGFyc2VyOwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51dGlsLkoyRG9Qcml2SGVscGVy\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51dGlsLkxvY2FsaXpl\ncjsKaW1wb3J0IG9yZy54bWwuc2F4LkF0dHJpYnV0ZXM7CmltcG9ydCBvcmcu\neG1sLnNheC5TQVhFeGNlcHRpb247CgovKioKICogU2V0cyBKUEEgc3BlY2lm\naWNhdGlvbiBkZWZhdWx0cyBhbmQgcGFyc2VzIEpQQSBzcGVjaWZpY2F0aW9u\nIFhNTCBmaWxlcy4KICogCiAqIEZvciBnbG9iYWxzLCBsb29rcyBpbiA8Y29k\nZT5vcGVuanBhLnByb3BlcnRpZXM8L2NvZGU+IHN5c3RlbSBwcm9wZXJ0eSBm\nb3IKICogdGhlIGxvY2F0aW9uIG9mIGEgZmlsZSB0byBwYXJzZS4gSWYgbm8g\nc3lzdGVtIHByb3BlcnR5IGlzIGRlZmluZWQsIHRoZQogKiBkZWZhdWx0IHJl\nc291cmNlIGxvY2F0aW9uIG9mIDxjb2RlPk1FVEEtSU5GL29wZW5qcGEueG1s\nPC9jb2RlPiBpcyB1c2VkLgogKgogKiBGb3IgZGVmYXVsdHMsIGxvb2tzIGZv\nciA8Y29kZT5NRVRBLUlORi9wZXJzaXN0ZW5jZS54bWw8L2NvZGU+LgogKiBX\naXRoaW4gPGNvZGU+cGVyc2lzdGVuY2UueG1sPC9jb2RlPiwgbG9vayBmb3Ig\ndGhlIG5hbWVkIHBlcnNpc3RlbmNlIHVuaXQsIG9yCiAqIGlmIG5vIG5hbWUg\nZ2l2ZW4sIGFuIE9wZW5KUEEgdW5pdCAocHJlZmVycmluZyBhbiB1bm5hbWVk\nIE9wZW5KUEEgdW5pdCB0byAKICogYSBuYW1lZCBvbmUpLgogKgogKiBAYXV0\naG9yIEFiZSBXaGl0ZQogKiBAbm9qYXZhZG9jCiAqLwpwdWJsaWMgY2xhc3Mg\nUGVyc2lzdGVuY2VQcm9kdWN0RGVyaXZhdGlvbiAKICAgIGV4dGVuZHMgQWJz\ndHJhY3RQcm9kdWN0RGVyaXZhdGlvbgogICAgaW1wbGVtZW50cyBPcGVuSlBB\nUHJvZHVjdERlcml2YXRpb24gewoKICAgIHB1YmxpYyBzdGF0aWMgZmluYWwg\nU3RyaW5nIFNQRUNfSlBBID0gImpwYSI7CiAgICBwdWJsaWMgc3RhdGljIGZp\nbmFsIFN0cmluZyBBTElBU19FSkIgPSAiZWpiIjsKICAgIHB1YmxpYyBzdGF0\naWMgZmluYWwgU3RyaW5nIFJTUkNfR0xPQkFMID0gIk1FVEEtSU5GL29wZW5q\ncGEueG1sIjsKICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgU3RyaW5nIFJTUkNf\nREVGQVVMVCA9ICJNRVRBLUlORi9wZXJzaXN0ZW5jZS54bWwiOwoKICAgIHBy\naXZhdGUgc3RhdGljIGZpbmFsIExvY2FsaXplciBfbG9jID0gTG9jYWxpemVy\nLmZvclBhY2thZ2UKICAgICAgICAoUGVyc2lzdGVuY2VQcm9kdWN0RGVyaXZh\ndGlvbi5jbGFzcyk7CgogICAgcHVibGljIHZvaWQgcHV0QnJva2VyRmFjdG9y\neUFsaWFzZXMoTWFwIG0pIHsKICAgIH0KCiAgICBwdWJsaWMgaW50IGdldFR5\ncGUoKSB7CiAgICAgICAgcmV0dXJuIFRZUEVfU1BFQzsKICAgIH0KCiAgICBA\nT3ZlcnJpZGUKICAgIHB1YmxpYyB2b2lkIHZhbGlkYXRlKCkKICAgICAgICB0\naHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICAvLyBtYWtlIHN1cmUgSlBBIGlz\nIGF2YWlsYWJsZQogICAgICAgIEFjY2Vzc0NvbnRyb2xsZXIuZG9Qcml2aWxl\nZ2VkKEoyRG9Qcml2SGVscGVyLmdldENsYXNzTG9hZGVyQWN0aW9uKAogICAg\nICAgICAgICBqYXZheC5wZXJzaXN0ZW5jZS5FbnRpdHlNYW5hZ2VyRmFjdG9y\neS5jbGFzcykpOwogICAgfQogICAgCiAgICBAT3ZlcnJpZGUKICAgIHB1Ymxp\nYyBib29sZWFuIGJlZm9yZUNvbmZpZ3VyYXRpb25Mb2FkKENvbmZpZ3VyYXRp\nb24gYykgewogICAgICAgIGlmICghKGMgaW5zdGFuY2VvZiBPcGVuSlBBQ29u\nZmlndXJhdGlvbkltcGwpKQogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAg\nICAgICAgCiAgICAgICAgT3BlbkpQQUNvbmZpZ3VyYXRpb25JbXBsIGNvbmYg\nPSAoT3BlbkpQQUNvbmZpZ3VyYXRpb25JbXBsKSBjOwogICAgICAgIGNvbmYu\nbWV0YUZhY3RvcnlQbHVnaW4uc2V0QWxpYXMoQUxJQVNfRUpCLAogICAgICAg\nICAgICBQZXJzaXN0ZW5jZU1ldGFEYXRhRmFjdG9yeS5jbGFzcy5nZXROYW1l\nKCkpOwogICAgICAgIGNvbmYubWV0YUZhY3RvcnlQbHVnaW4uc2V0QWxpYXMo\nU1BFQ19KUEEsCiAgICAgICAgICAgIFBlcnNpc3RlbmNlTWV0YURhdGFGYWN0\nb3J5LmNsYXNzLmdldE5hbWUoKSk7CiAgICAgICAgCiAgICAgICAgY29uZi5h\nZGRWYWx1ZShuZXcgRW50aXR5TWFuYWdlckZhY3RvcnlWYWx1ZSgpKTsKICAg\nICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHB1\nYmxpYyBib29sZWFuIGFmdGVyU3BlY2lmaWNhdGlvblNldChDb25maWd1cmF0\naW9uIGMpIHsKICAgICAgaWYgKCEoYyBpbnN0YW5jZW9mIE9wZW5KUEFDb25m\naWd1cmF0aW9uSW1wbCkKICAgICAgICAgfHwgIVNQRUNfSlBBLmVxdWFscygo\nKE9wZW5KUEFDb25maWd1cmF0aW9uKSBjKS5nZXRTcGVjaWZpY2F0aW9uKCkp\nKQogICAgICAgICAgcmV0dXJuIGZhbHNlOwogCiAgICAgICAgT3BlbkpQQUNv\nbmZpZ3VyYXRpb25JbXBsIGNvbmYgPSAoT3BlbkpQQUNvbmZpZ3VyYXRpb25J\nbXBsKSBjOwogICAgICAgIGNvbmYubWV0YUZhY3RvcnlQbHVnaW4uc2V0RGVm\nYXVsdChTUEVDX0pQQSk7CiAgICAgICAgY29uZi5tZXRhRmFjdG9yeVBsdWdp\nbi5zZXRTdHJpbmcoU1BFQ19KUEEpOwogICAgICAgIGNvbmYubG9ja01hbmFn\nZXJQbHVnaW4uc2V0RGVmYXVsdCgidmVyc2lvbiIpOwogICAgICAgIGNvbmYu\nbG9ja01hbmFnZXJQbHVnaW4uc2V0U3RyaW5nKCJ2ZXJzaW9uIik7CiAgICAg\nICAgY29uZi5ub250cmFuc2FjdGlvbmFsV3JpdGUuc2V0RGVmYXVsdCgidHJ1\nZSIpOwogICAgICAgIGNvbmYubm9udHJhbnNhY3Rpb25hbFdyaXRlLnNldCh0\ncnVlKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvKioKICAg\nICAqIExvYWQgY29uZmlndXJhdGlvbiBmcm9tIHRoZSBnaXZlbiBwZXJzaXN0\nZW5jZSB1bml0IHdpdGggdGhlIHNwZWNpZmllZAogICAgICogdXNlciBwcm9w\nZXJ0aWVzLgogICAgICovCiAgICBwdWJsaWMgQ29uZmlndXJhdGlvblByb3Zp\nZGVyIGxvYWQoUGVyc2lzdGVuY2VVbml0SW5mbyBwaW5mbywgTWFwIG0pCiAg\nICAgICAgdGhyb3dzIElPRXhjZXB0aW9uIHsKICAgICAgICBpZiAocGluZm8g\nPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgaWYg\nKCFpc09wZW5KUEFQZXJzaXN0ZW5jZVByb3ZpZGVyKHBpbmZvLCBudWxsKSkg\newogICAgICAgICAgICB3YXJuVW5rbm93blByb3ZpZGVyKHBpbmZvKTsKICAg\nICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgfQoKICAgICAgICBDb25m\naWd1cmF0aW9uUHJvdmlkZXJJbXBsIGNwID0gbmV3IENvbmZpZ3VyYXRpb25Q\ncm92aWRlckltcGwoKTsKICAgICAgICBjcC5hZGRQcm9wZXJ0aWVzKFBlcnNp\nc3RlbmNlVW5pdEluZm9JbXBsLnRvT3BlbkpQQVByb3BlcnRpZXMocGluZm8p\nKTsKICAgICAgICBjcC5hZGRQcm9wZXJ0aWVzKG0pOwogICAgICAgIGlmIChw\naW5mbyBpbnN0YW5jZW9mIFBlcnNpc3RlbmNlVW5pdEluZm9JbXBsKSB7CiAg\nICAgICAgICAgIFBlcnNpc3RlbmNlVW5pdEluZm9JbXBsIGltcGwgPSAoUGVy\nc2lzdGVuY2VVbml0SW5mb0ltcGwpIHBpbmZvOwogICAgICAgICAgICBpZiAo\naW1wbC5nZXRQZXJzaXN0ZW5jZVhtbEZpbGVVcmwoKSAhPSBudWxsKQogICAg\nICAgICAgICAgICAgY3Auc2V0U291cmNlKGltcGwuZ2V0UGVyc2lzdGVuY2VY\nbWxGaWxlVXJsKCkudG9TdHJpbmcoKSk7CiAgICAgICAgfQogICAgICAgIHJl\ndHVybiBjcDsKICAgIH0KCiAgICAvKioKICAgICAqIExvYWQgY29uZmlndXJh\ndGlvbiBmcm9tIHRoZSBnaXZlbiByZXNvdXJjZSBhbmQgdW5pdCBuYW1lcywg\nd2hpY2ggbWF5CiAgICAgKiBiZSBudWxsLgogICAgICovCiAgICBwdWJsaWMg\nQ29uZmlndXJhdGlvblByb3ZpZGVyIGxvYWQoU3RyaW5nIHJzcmMsIFN0cmlu\nZyBuYW1lLCBNYXAgbSkKICAgICAgICB0aHJvd3MgSU9FeGNlcHRpb24gewog\nICAgICAgIGJvb2xlYW4gZXhwbGljaXQgPSAhU3RyaW5nVXRpbHMuaXNFbXB0\neShyc3JjKTsKICAgICAgICBpZiAoIWV4cGxpY2l0KQogICAgICAgICAgICBy\nc3JjID0gUlNSQ19ERUZBVUxUOwogICAgICAgIAogICAgICAgIENvbmZpZ3Vy\nYXRpb25Qcm92aWRlckltcGwgY3AgPSBuZXcgQ29uZmlndXJhdGlvblByb3Zp\nZGVySW1wbCgpOwogICAgICAgIEJvb2xlYW4gcmV0ID0gbG9hZChjcCwgcnNy\nYywgbmFtZSwgbSwgbnVsbCwgZXhwbGljaXQpOwogICAgICAgIGlmIChyZXQg\nIT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIChyZXQuYm9vbGVhblZhbHVl\nKCkpID8gY3AgOiBudWxsOwogICAgICAgIGlmIChleHBsaWNpdCkKICAgICAg\nICAgICAgcmV0dXJuIG51bGw7CgogICAgICAgIC8vIHBlcnNpc3RlbmNlLnht\nbCBkb2VzIG5vdCBleGlzdDsganVzdCBsb2FkIG1hcAogICAgICAgIFBlcnNp\nc3RlbmNlVW5pdEluZm9JbXBsIHBpbmZvID0gbmV3IFBlcnNpc3RlbmNlVW5p\ndEluZm9JbXBsKCk7CiAgICAgICAgcGluZm8uZnJvbVVzZXJQcm9wZXJ0aWVz\nKG0pOwogICAgICAgIGlmICghaXNPcGVuSlBBUGVyc2lzdGVuY2VQcm92aWRl\ncihwaW5mbywgbnVsbCkpIHsKICAgICAgICAgICAgd2FyblVua25vd25Qcm92\naWRlcihwaW5mbyk7CiAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAg\nIH0KICAgICAgICBjcC5hZGRQcm9wZXJ0aWVzKHBpbmZvLnRvT3BlbkpQQVBy\nb3BlcnRpZXMoKSk7CiAgICAgICAgcmV0dXJuIGNwOwogICAgfQoKICAgIEBP\ndmVycmlkZQogICAgcHVibGljIENvbmZpZ3VyYXRpb25Qcm92aWRlciBsb2Fk\nKFN0cmluZyByc3JjLCBTdHJpbmcgYW5jaG9yLCAKICAgICAgICBDbGFzc0xv\nYWRlciBsb2FkZXIpCiAgICAgICAgdGhyb3dzIElPRXhjZXB0aW9uIHsKICAg\nICAgICBpZiAocnNyYyAhPSBudWxsICYmICFyc3JjLmVuZHNXaXRoKCIueG1s\nIikpCiAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgIENvbmZpZ3Vy\nYXRpb25Qcm92aWRlckltcGwgY3AgPSBuZXcgQ29uZmlndXJhdGlvblByb3Zp\nZGVySW1wbCgpOwogICAgICAgIGlmIChsb2FkKGNwLCByc3JjLCBhbmNob3Is\nIG51bGwsIGxvYWRlciwgdHJ1ZSkgPT0gQm9vbGVhbi5UUlVFKQogICAgICAg\nICAgICByZXR1cm4gY3A7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICB9Cgog\nICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgQ29uZmlndXJhdGlvblByb3ZpZGVy\nIGxvYWQoRmlsZSBmaWxlLCBTdHJpbmcgYW5jaG9yKSAKICAgICAgICB0aHJv\nd3MgSU9FeGNlcHRpb24gewogICAgICAgIGlmICghZmlsZS5nZXROYW1lKCku\nZW5kc1dpdGgoIi54bWwiKSkKICAgICAgICAgICAgcmV0dXJuIG51bGw7Cgog\nICAgICAgIENvbmZpZ3VyYXRpb25QYXJzZXIgcGFyc2VyID0gbmV3IENvbmZp\nZ3VyYXRpb25QYXJzZXIobnVsbCk7CiAgICAgICAgcGFyc2VyLnBhcnNlKGZp\nbGUpOwogICAgICAgIHJldHVybiBsb2FkKGZpbmRVbml0KChMaXN0PFBlcnNp\nc3RlbmNlVW5pdEluZm9JbXBsPikgCiAgICAgICAgICAgIHBhcnNlci5nZXRS\nZXN1bHRzKCksIGFuY2hvciwgbnVsbCksIG51bGwpOwogICAgfQoKICAgIEBP\ndmVycmlkZQogICAgcHVibGljIFN0cmluZyBnZXREZWZhdWx0UmVzb3VyY2VM\nb2NhdGlvbigpIHsKICAgICAgICByZXR1cm4gUlNSQ19ERUZBVUxUOwogICAg\nfQoKICAgIEBPdmVycmlkZQogICAgcHVibGljIExpc3QgZ2V0QW5jaG9yc0lu\nRmlsZShGaWxlIGZpbGUpIHRocm93cyBJT0V4Y2VwdGlvbiB7CiAgICAgICAg\nQ29uZmlndXJhdGlvblBhcnNlciBwYXJzZXIgPSBuZXcgQ29uZmlndXJhdGlv\nblBhcnNlcihudWxsKTsKICAgICAgICB0cnkgewogICAgICAgICAgICBwYXJz\nZXIucGFyc2UoZmlsZSk7CiAgICAgICAgICAgIHJldHVybiBnZXRVbml0TmFt\nZXMocGFyc2VyKTsKICAgICAgICB9IGNhdGNoIChJT0V4Y2VwdGlvbiBlKSB7\nCiAgICAgICAgICAgIC8vIG5vdCBhbGwgY29uZmlndXJhdGlvbiBmaWxlcyBh\ncmUgWE1MOyByZXR1cm4gbnVsbCBpZiB1bnBhcnNhYmxlCiAgICAgICAgICAg\nIHJldHVybiBudWxsOwogICAgICAgIH0KICAgIH0KCiAgICBwcml2YXRlIExp\nc3Q8U3RyaW5nPiBnZXRVbml0TmFtZXMoQ29uZmlndXJhdGlvblBhcnNlciBw\nYXJzZXIpIHsKICAgICAgICBMaXN0PFBlcnNpc3RlbmNlVW5pdEluZm9JbXBs\nPiB1bml0cyA9IHBhcnNlci5nZXRSZXN1bHRzKCk7CiAgICAgICAgTGlzdDxT\ndHJpbmc+IG5hbWVzID0gbmV3IEFycmF5TGlzdDxTdHJpbmc+KCk7CiAgICAg\nICAgZm9yIChQZXJzaXN0ZW5jZVVuaXRJbmZvSW1wbCB1bml0IDogdW5pdHMp\nCiAgICAgICAgICAgIG5hbWVzLmFkZCh1bml0LmdldFBlcnNpc3RlbmNlVW5p\ndE5hbWUoKSk7CiAgICAgICAgcmV0dXJuIG5hbWVzOwogICAgfQoKICAgIEBP\ndmVycmlkZQogICAgcHVibGljIExpc3QgZ2V0QW5jaG9yc0luUmVzb3VyY2Uo\nU3RyaW5nIHJlc291cmNlKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBD\nb25maWd1cmF0aW9uUGFyc2VyIHBhcnNlciA9IG5ldyBDb25maWd1cmF0aW9u\nUGFyc2VyKG51bGwpOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIENsYXNz\nTG9hZGVyIGxvYWRlciA9IChDbGFzc0xvYWRlcikgQWNjZXNzQ29udHJvbGxl\nci5kb1ByaXZpbGVnZWQoCiAgICAgICAgICAgICAgICBKMkRvUHJpdkhlbHBl\nci5nZXRDb250ZXh0Q2xhc3NMb2FkZXJBY3Rpb24oKSk7CiAgICAgICAgICAg\nIExpc3Q8VVJMPiB1cmxzID0gZ2V0UmVzb3VyY2VVUkxzKHJlc291cmNlLCBs\nb2FkZXIpOwogICAgICAgICAgICBpZiAodXJscyAhPSBudWxsKSB7CiAgICAg\nICAgICAgICAgICBmb3IgKFVSTCB1cmwgOiB1cmxzKSB7CiAgICAgICAgICAg\nICAgICAgICAgcGFyc2VyLnBhcnNlKHVybCk7CiAgICAgICAgICAgICAgICB9\nCiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIGdldFVuaXROYW1l\ncyhwYXJzZXIpOwogICAgICAgIH0gY2F0Y2ggKElPRXhjZXB0aW9uIGUpIHsK\nICAgICAgICAgICAgLy8gbm90IGFsbCBjb25maWd1cmF0aW9uIGZpbGVzIGFy\nZSBYTUw7IHJldHVybiBudWxsIGlmIHVucGFyc2FibGUKICAgICAgICAgICAg\ncmV0dXJuIG51bGw7CiAgICAgICAgfQogICAgfQoKICAgIEBPdmVycmlkZQog\nICAgcHVibGljIENvbmZpZ3VyYXRpb25Qcm92aWRlciBsb2FkR2xvYmFscyhD\nbGFzc0xvYWRlciBsb2FkZXIpCiAgICAgICAgdGhyb3dzIElPRXhjZXB0aW9u\nIHsKICAgICAgICBTdHJpbmdbXSBwcmVmaXhlcyA9IFByb2R1Y3REZXJpdmF0\naW9ucy5nZXRDb25maWd1cmF0aW9uUHJlZml4ZXMoKTsKICAgICAgICBTdHJp\nbmcgcnNyYyA9IG51bGw7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBw\ncmVmaXhlcy5sZW5ndGggJiYgU3RyaW5nVXRpbHMuaXNFbXB0eShyc3JjKTsg\naSsrKQogICAgICAgICAgIHJzcmMgPSAoU3RyaW5nKSBBY2Nlc3NDb250cm9s\nbGVyLmRvUHJpdmlsZWdlZChKMkRvUHJpdkhlbHBlcgogICAgICAgICAgICAg\nICAgLmdldFByb3BlcnR5QWN0aW9uKHByZWZpeGVzW2ldICsgIi5wcm9wZXJ0\naWVzIikpOyAKICAgICAgICBib29sZWFuIGV4cGxpY2l0ID0gIVN0cmluZ1V0\naWxzLmlzRW1wdHkocnNyYyk7CiAgICAgICAgU3RyaW5nIGFuY2hvciA9IG51\nbGw7CiAgICAgICAgaW50IGlkeCA9ICghZXhwbGljaXQpID8gLTEgOiByc3Jj\nLmxhc3RJbmRleE9mKCcjJyk7CiAgICAgICAgaWYgKGlkeCAhPSAtMSkgewog\nICAgICAgICAgICAvLyBzZXBhcmF0ZSBuYW1lIGZyb20gPHJlc3JvdWNlPiM8\nbmFtZT4gc3RyaW5nCiAgICAgICAgICAgIGlmIChpZHggPCByc3JjLmxlbmd0\naCgpIC0gMSkKICAgICAgICAgICAgICAgIGFuY2hvciA9IHJzcmMuc3Vic3Ry\naW5nKGlkeCArIDEpOwogICAgICAgICAgICByc3JjID0gcnNyYy5zdWJzdHJp\nbmcoMCwgaWR4KTsKICAgICAgICB9CiAgICAgICAgaWYgKFN0cmluZ1V0aWxz\nLmlzRW1wdHkocnNyYykpCiAgICAgICAgICAgIHJzcmMgPSBSU1JDX0dMT0JB\nTDsKICAgICAgICBlbHNlIGlmICghcnNyYy5lbmRzV2l0aCgiLnhtbCIpKQog\nICAgICAgICAgICByZXR1cm4gbnVsbDsKCiAgICAgICAgQ29uZmlndXJhdGlv\nblByb3ZpZGVySW1wbCBjcCA9IG5ldyBDb25maWd1cmF0aW9uUHJvdmlkZXJJ\nbXBsKCk7CiAgICAgICAgaWYgKGxvYWQoY3AsIHJzcmMsIGFuY2hvciwgbnVs\nbCwgbG9hZGVyLCBleHBsaWNpdCkgPT0gQm9vbGVhbi5UUlVFKQogICAgICAg\nICAgICByZXR1cm4gY3A7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICB9Cgog\nICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgQ29uZmlndXJhdGlvblByb3ZpZGVy\nIGxvYWREZWZhdWx0cyhDbGFzc0xvYWRlciBsb2FkZXIpCiAgICAgICAgdGhy\nb3dzIElPRXhjZXB0aW9uIHsKICAgICAgICBDb25maWd1cmF0aW9uUHJvdmlk\nZXJJbXBsIGNwID0gbmV3IENvbmZpZ3VyYXRpb25Qcm92aWRlckltcGwoKTsK\nICAgICAgICBpZiAobG9hZChjcCwgUlNSQ19ERUZBVUxULCBudWxsLCBudWxs\nLCBsb2FkZXIsIGZhbHNlKSA9PSBCb29sZWFuLlRSVUUpCiAgICAgICAgICAg\nIHJldHVybiBjcDsKICAgICAgICByZXR1cm4gbnVsbDsKICAgIH0KCiAgICBw\ncml2YXRlIHN0YXRpYyBMaXN0PFVSTD4gZ2V0UmVzb3VyY2VVUkxzKFN0cmlu\nZyByc3JjLCBDbGFzc0xvYWRlciBsb2FkZXIpCiAgICAgICAgdGhyb3dzIElP\nRXhjZXB0aW9uIHsKICAgICAgICBFbnVtZXJhdGlvbjxVUkw+IHVybHMgPSBu\ndWxsOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIHVybHMgPSAoRW51bWVy\nYXRpb24pIEFjY2Vzc0NvbnRyb2xsZXIuZG9Qcml2aWxlZ2VkKAogICAgICAg\nICAgICAgICAgSjJEb1ByaXZIZWxwZXIuZ2V0UmVzb3VyY2VzQWN0aW9uKGxv\nYWRlciwgcnNyYykpOyAKICAgICAgICAgICAgaWYgKCF1cmxzLmhhc01vcmVF\nbGVtZW50cygpKSB7CiAgICAgICAgICAgICAgICBpZiAoIXJzcmMuc3RhcnRz\nV2l0aCgiTUVUQS1JTkYiKSkKICAgICAgICAgICAgICAgICAgICB1cmxzID0g\nKEVudW1lcmF0aW9uKSBBY2Nlc3NDb250cm9sbGVyLmRvUHJpdmlsZWdlZCgK\nICAgICAgICAgICAgICAgICAgICAgICAgSjJEb1ByaXZIZWxwZXIuZ2V0UmVz\nb3VyY2VzQWN0aW9uKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9h\nZGVyLCAiTUVUQS1JTkYvIiArIHJzcmMpKTsgCiAgICAgICAgICAgICAgICBp\nZiAoIXVybHMuaGFzTW9yZUVsZW1lbnRzKCkpCiAgICAgICAgICAgICAgICAg\nICAgcmV0dXJuIG51bGw7CiAgICAgICAgICAgIH0KICAgICAgICB9IGNhdGNo\nIChQcml2aWxlZ2VkQWN0aW9uRXhjZXB0aW9uIHBhZSkgewogICAgICAgICAg\nICB0aHJvdyAoSU9FeGNlcHRpb24pIHBhZS5nZXRFeGNlcHRpb24oKTsKICAg\nICAgICB9CgogICAgICAgIHJldHVybiBDb2xsZWN0aW9ucy5saXN0KHVybHMp\nOwogICAgfQoKICAgIC8qKgogICAgICogTG9va3MgdGhyb3VnaCB0aGUgcmVz\nb3VyY2VzIGF0IDxjb2RlPnJzcmM8L2NvZGU+IGZvciBhIGNvbmZpZ3VyYXRp\nb24KICAgICAqIGZpbGUgdGhhdCBtYXRjaGVzIDxjb2RlPm5hbWU8L2NvZGU+\nIChvciBhbiB1bm5hbWVkIG9uZSBpZgogICAgICogPGNvZGU+bmFtZTwvY29k\nZT4gaXMgPGNvZGU+bnVsbDwvY29kZT4pLCBhbmQgbG9hZHMgdGhlIFhNTCBp\nbiB0aGUKICAgICAqIHJlc291cmNlIGludG8gYSBuZXcge0BsaW5rIFBlcnNp\nc3RlbmNlVW5pdEluZm99LiBUaGVuLCBhcHBsaWVzIHRoZQogICAgICogb3Zl\ncnJpZGVzIGluIDxjb2RlPm08L2NvZGU+LgogICAgICoKICAgICAqIEByZXR1\ncm4ge0BsaW5rIEJvb2xlYW4jVFJVRX0gaWYgdGhlIHJlc291cmNlIHdhcyBs\nb2FkZWQsIG51bGwgaWYgaXQKICAgICAqIGRvZXMgbm90IGV4aXN0LCBvciB7\nQGxpbmsgQm9vbGVhbiNGQUxTRX0gaWYgaXQgaXMgbm90IGZvciBPcGVuSlBB\nCiAgICAgKi8KICAgIHByaXZhdGUgQm9vbGVhbiBsb2FkKENvbmZpZ3VyYXRp\nb25Qcm92aWRlckltcGwgY3AsIFN0cmluZyByc3JjLCAKICAgICAgICBTdHJp\nbmcgbmFtZSwgTWFwIG0sIENsYXNzTG9hZGVyIGxvYWRlciwgYm9vbGVhbiBl\neHBsaWNpdCkKICAgICAgICB0aHJvd3MgSU9FeGNlcHRpb24gewogICAgICAg\nIGlmIChsb2FkZXIgPT0gbnVsbCkKICAgICAgICAgICAgbG9hZGVyID0gKENs\nYXNzTG9hZGVyKSBBY2Nlc3NDb250cm9sbGVyLmRvUHJpdmlsZWdlZCgKICAg\nICAgICAgICAgICAgIEoyRG9Qcml2SGVscGVyLmdldENvbnRleHRDbGFzc0xv\nYWRlckFjdGlvbigpKTsKCiAgICAgICAgTGlzdDxVUkw+IHVybHMgPSBnZXRS\nZXNvdXJjZVVSTHMocnNyYywgbG9hZGVyKTsKICAgICAgICBpZiAodXJscyA9\nPSBudWxsIHx8IHVybHMuc2l6ZSgpID09IDApCiAgICAgICAgICAgIHJldHVy\nbiBudWxsOwoKICAgICAgICBDb25maWd1cmF0aW9uUGFyc2VyIHBhcnNlciA9\nIG5ldyBDb25maWd1cmF0aW9uUGFyc2VyKG0pOwogICAgICAgIFBlcnNpc3Rl\nbmNlVW5pdEluZm9JbXBsIHBpbmZvID0gcGFyc2VSZXNvdXJjZXMocGFyc2Vy\nLCB1cmxzLCBuYW1lLCAKICAgICAgICAgICAgbG9hZGVyKTsKICAgICAgICBp\nZiAocGluZm8gPT0gbnVsbCkgewogICAgICAgICAgICBpZiAoIWV4cGxpY2l0\nKQogICAgICAgICAgICAgICAgcmV0dXJuIEJvb2xlYW4uRkFMU0U7CiAgICAg\nICAgICAgIHRocm93IG5ldyBNaXNzaW5nUmVzb3VyY2VFeGNlcHRpb24oX2xv\nYy5nZXQoIm1pc3NpbmcteG1sLWNvbmZpZyIsIAogICAgICAgICAgICAgICAg\ncnNyYywgU3RyaW5nLnZhbHVlT2YobmFtZSkpLmdldE1lc3NhZ2UoKSwgZ2V0\nQ2xhc3MoKS5nZXROYW1lKCksIAogICAgICAgICAgICAgICAgcnNyYyk7CiAg\nICAgICAgfSBlbHNlIGlmICghaXNPcGVuSlBBUGVyc2lzdGVuY2VQcm92aWRl\ncihwaW5mbywgbG9hZGVyKSkgewogICAgICAgICAgICBpZiAoIWV4cGxpY2l0\nKSB7CiAgICAgICAgICAgICAgICB3YXJuVW5rbm93blByb3ZpZGVyKHBpbmZv\nKTsKICAgICAgICAgICAgICAgIHJldHVybiBCb29sZWFuLkZBTFNFOwogICAg\nICAgICAgICB9CiAgICAgICAgICAgIHRocm93IG5ldyBNaXNzaW5nUmVzb3Vy\nY2VFeGNlcHRpb24oX2xvYy5nZXQoInVua25vd24tcHJvdmlkZXIiLCAKICAg\nICAgICAgICAgICAgIHJzcmMsIG5hbWUsIHBpbmZvLmdldFBlcnNpc3RlbmNl\nUHJvdmlkZXJDbGFzc05hbWUoKSkuCiAgICAgICAgICAgICAgICBnZXRNZXNz\nYWdlKCksIGdldENsYXNzKCkuZ2V0TmFtZSgpLCByc3JjKTsKICAgICAgICB9\nCiAgICAgICAgY3AuYWRkUHJvcGVydGllcyhwaW5mby50b09wZW5KUEFQcm9w\nZXJ0aWVzKCkpOwogICAgICAgIGNwLnNldFNvdXJjZShwaW5mby5nZXRQZXJz\naXN0ZW5jZVhtbEZpbGVVcmwoKS50b1N0cmluZygpKTsKICAgICAgICByZXR1\ncm4gQm9vbGVhbi5UUlVFOwogICAgfQoKICAgIC8qKgogICAgICogUGFyc2Ug\ncmVzb3VyY2VzIGF0IHRoZSBnaXZlbiBsb2NhdGlvbi4gU2VhcmNoZXMgZm9y\nIGEKICAgICAqIFBlcnNpc3RlbmNlVW5pdEluZm8gd2l0aCB0aGUgcmVxdWVz\ndGVkIG5hbWUsIG9yIGFuIE9wZW5KUEEgdW5pdCBpZgogICAgICogbm8gbmFt\nZSBnaXZlbiAocHJlZmVycmluZyBhbiB1bm5hbWVkIE9wZW5KUEEgdW5pdCB0\nbyBhIG5hbWVkIG9uZSkuCiAgICAgKi8KICAgIHByaXZhdGUgUGVyc2lzdGVu\nY2VVbml0SW5mb0ltcGwgcGFyc2VSZXNvdXJjZXMoQ29uZmlndXJhdGlvblBh\ncnNlciBwYXJzZXIsCiAgICAgICAgTGlzdDxVUkw+IHVybHMsIFN0cmluZyBu\nYW1lLCBDbGFzc0xvYWRlciBsb2FkZXIpCiAgICAgICAgdGhyb3dzIElPRXhj\nZXB0aW9uIHsKICAgICAgICBMaXN0PFBlcnNpc3RlbmNlVW5pdEluZm9JbXBs\nPiBwaW5mb3MgPSAKICAgICAgICAgICAgbmV3IEFycmF5TGlzdDxQZXJzaXN0\nZW5jZVVuaXRJbmZvSW1wbD4oKTsKICAgICAgICBmb3IgKFVSTCB1cmwgOiB1\ncmxzKSB7CiAgICAgICAgICAgIHBhcnNlci5wYXJzZSh1cmwpOwogICAgICAg\nICAgICBwaW5mb3MuYWRkQWxsKChMaXN0PFBlcnNpc3RlbmNlVW5pdEluZm9J\nbXBsPikgcGFyc2VyLmdldFJlc3VsdHMoKSk7CiAgICAgICAgfQogICAgICAg\nIHJldHVybiBmaW5kVW5pdChwaW5mb3MsIG5hbWUsIGxvYWRlcik7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBGaW5kIHRoZSB1bml0IHdpdGggdGhlIGdpdmVu\nIG5hbWUsIG9yIGFuIE9wZW5KUEEgdW5pdCBpZiBubyBuYW1lIGlzCiAgICAg\nKiBnaXZlbiAocHJlZmVycmluZyBhbiB1bm5hbWVkIE9wZW5KUEEgdW5pdCB0\nbyBhIG5hbWVkIG9uZSkuCiAgICAgKi8KICAgIHByaXZhdGUgUGVyc2lzdGVu\nY2VVbml0SW5mb0ltcGwgZmluZFVuaXQoTGlzdDxQZXJzaXN0ZW5jZVVuaXRJ\nbmZvSW1wbD4gCiAgICAgICAgcGluZm9zLCBTdHJpbmcgbmFtZSwgQ2xhc3NM\nb2FkZXIgbG9hZGVyKSB7CiAgICAgICAgUGVyc2lzdGVuY2VVbml0SW5mb0lt\ncGwgb2pwYSA9IG51bGw7CiAgICAgICAgZm9yIChQZXJzaXN0ZW5jZVVuaXRJ\nbmZvSW1wbCBwaW5mbyA6IHBpbmZvcykgewogICAgICAgICAgICAvLyBmb3Vu\nZCBuYW1lZCB1bml0PwogICAgICAgICAgICBpZiAobmFtZSAhPSBudWxsKSB7\nCiAgICAgICAgICAgICAgICBpZiAobmFtZS5lcXVhbHMocGluZm8uZ2V0UGVy\nc2lzdGVuY2VVbml0TmFtZSgpKSkKICAgICAgICAgICAgICAgICAgICByZXR1\ncm4gcGluZm87CiAgICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAg\nICAgfQoKICAgICAgICAgICAgaWYgKGlzT3BlbkpQQVBlcnNpc3RlbmNlUHJv\ndmlkZXIocGluZm8sIGxvYWRlcikpIHsKICAgICAgICAgICAgICAgIC8vIGlm\nIG5vIG5hbWUgZ2l2ZW4gYW5kIGZvdW5kIHVubmFtZWQgdW5pdCwgcmV0dXJu\nIGl0LiAgCiAgICAgICAgICAgICAgICAvLyBvdGhlcndpc2UgcmVjb3JkIGFz\nIGRlZmF1bHQgdW5pdCB1bmxlc3Mgd2UgZmluZCBhIAogICAgICAgICAgICAg\nICAgLy8gYmV0dGVyIG1hdGNoIGxhdGVyCiAgICAgICAgICAgICAgICBpZiAo\nU3RyaW5nVXRpbHMuaXNFbXB0eShwaW5mby5nZXRQZXJzaXN0ZW5jZVVuaXRO\nYW1lKCkpKQogICAgICAgICAgICAgICAgICAgIHJldHVybiBwaW5mbzsKICAg\nICAgICAgICAgICAgIGlmIChvanBhID09IG51bGwpCiAgICAgICAgICAgICAg\nICAgICAgb2pwYSA9IHBpbmZvOwogICAgICAgICAgICB9CiAgICAgICAgfQog\nICAgICAgIHJldHVybiBvanBhOwogICAgfQoKICAgIC8qKgogICAgICogUmV0\ndXJuIHdoZXRoZXIgdGhlIGdpdmVuIHBlcnNpc3RlbmNlIHVuaXQgdXNlcyBh\nbiBPcGVuSlBBIHByb3ZpZGVyLgogICAgICovCiAgICBwcml2YXRlIHN0YXRp\nYyBib29sZWFuIGlzT3BlbkpQQVBlcnNpc3RlbmNlUHJvdmlkZXIKICAgICAg\nICAoUGVyc2lzdGVuY2VVbml0SW5mbyBwaW5mbywgQ2xhc3NMb2FkZXIgbG9h\nZGVyKSB7CiAgICAgICAgU3RyaW5nIHByb3ZpZGVyID0gcGluZm8uZ2V0UGVy\nc2lzdGVuY2VQcm92aWRlckNsYXNzTmFtZSgpOwogICAgICAgIGlmIChTdHJp\nbmdVdGlscy5pc0VtcHR5KHByb3ZpZGVyKSAKICAgICAgICAgICAgfHwgUGVy\nc2lzdGVuY2VQcm92aWRlckltcGwuY2xhc3MuZ2V0TmFtZSgpLmVxdWFscyhw\ncm92aWRlcikpCiAgICAgICAgICAgIHJldHVybiB0cnVlOwoKICAgICAgICBp\nZiAobG9hZGVyID09IG51bGwpCiAgICAgICAgICAgIGxvYWRlciA9IChDbGFz\nc0xvYWRlcikgQWNjZXNzQ29udHJvbGxlci5kb1ByaXZpbGVnZWQoCiAgICAg\nICAgICAgICAgICBKMkRvUHJpdkhlbHBlci5nZXRDb250ZXh0Q2xhc3NMb2Fk\nZXJBY3Rpb24oKSk7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgaWYgKFBl\ncnNpc3RlbmNlUHJvdmlkZXJJbXBsLmNsYXNzLmlzQXNzaWduYWJsZUZyb20K\nICAgICAgICAgICAgICAgIChDbGFzcy5mb3JOYW1lKHByb3ZpZGVyLCBmYWxz\nZSwgbG9hZGVyKSkpCiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAg\nICAgICB9IGNhdGNoIChUaHJvd2FibGUgdCkgewogICAgICAgICAgICBsb2co\nX2xvYy5nZXQoInVubG9hZGFibGUtcHJvdmlkZXIiLCBwcm92aWRlciwgdCku\nZ2V0TWVzc2FnZSgpKTsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAg\nICAgIH0KICAgICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBXYXJuIHRoZSB1c2VyIHRoYXQgd2UgY291bGQgb25seSBmaW5kIGFu\nIHVucmVjb2duaXplZCBwZXJzaXN0ZW5jZSAKICAgICAqIHByb3ZpZGVyLgog\nICAgICovCiAgICBwcml2YXRlIHN0YXRpYyB2b2lkIHdhcm5Vbmtub3duUHJv\ndmlkZXIoUGVyc2lzdGVuY2VVbml0SW5mbyBwaW5mbykgewogICAgICAgIGxv\nZyhfbG9jLmdldCgidW5yZWNvZ25pemVkLXByb3ZpZGVyIiwgCiAgICAgICAg\nICAgIHBpbmZvLmdldFBlcnNpc3RlbmNlUHJvdmlkZXJDbGFzc05hbWUoKSku\nZ2V0TWVzc2FnZSgpKTsKICAgIH0KICAgIAogICAgLyoqCiAgICAgKiBMb2cg\nYSBtZXNzYWdlLiAgIAogICAgICovCiAgICBwcml2YXRlIHN0YXRpYyB2b2lk\nIGxvZyhTdHJpbmcgbXNnKSB7CiAgICAgICAgLy8gYXQgdGhpcyBwb2ludCBs\nb2dnaW5nIGlzbid0IGNvbmZpZ3VyZWQgeWV0CiAgICAgICAgU3lzdGVtLmVy\nci5wcmludGxuKG1zZyk7CiAgICB9CgogICAgLyoqCiAgICAgKiBDdXN0b20g\nY29uZmlndXJhdGlvbiBwcm92aWRlci4gICAKICAgICAqLwogICAgcHVibGlj\nIHN0YXRpYyBjbGFzcyBDb25maWd1cmF0aW9uUHJvdmlkZXJJbXBsCiAgICAg\nICAgZXh0ZW5kcyBNYXBDb25maWd1cmF0aW9uUHJvdmlkZXIgewoKICAgICAg\nICBwcml2YXRlIFN0cmluZyBfc291cmNlOwoKICAgICAgICBwdWJsaWMgQ29u\nZmlndXJhdGlvblByb3ZpZGVySW1wbCgpIHsKICAgICAgICB9CgogICAgICAg\nIHB1YmxpYyBDb25maWd1cmF0aW9uUHJvdmlkZXJJbXBsKE1hcCBwcm9wcykg\newogICAgICAgICAgICBzdXBlcihwcm9wcyk7CiAgICAgICAgfQoKICAgICAg\nICAvKioKICAgICAgICAgKiBTZXQgdGhlIHNvdXJjZSBvZiBpbmZvcm1hdGlv\nbiBpbiB0aGlzIHByb3ZpZGVyLgogICAgICAgICAqLwogICAgICAgIHB1Ymxp\nYyB2b2lkIHNldFNvdXJjZShTdHJpbmcgc291cmNlKSB7CiAgICAgICAgICAg\nIF9zb3VyY2UgPSBzb3VyY2U7CiAgICAgICAgfQoKICAgICAgICBAT3ZlcnJp\nZGUKICAgICAgICBwdWJsaWMgdm9pZCBzZXRJbnRvKENvbmZpZ3VyYXRpb24g\nY29uZikgewogICAgICAgICAgICBpZiAoY29uZiBpbnN0YW5jZW9mIE9wZW5K\nUEFDb25maWd1cmF0aW9uKSB7CiAgICAgICAgICAgICAgICBPcGVuSlBBQ29u\nZmlndXJhdGlvbiBvY29uZiA9IChPcGVuSlBBQ29uZmlndXJhdGlvbikgY29u\nZjsKICAgICAgICAgICAgICAgIG9jb25mLnNldFNwZWNpZmljYXRpb24oU1BF\nQ19KUEEpOwoKICAgICAgICAgICAgICAgIC8vIHdlIG1lcmdlIHNldmVyYWwg\ncGVyc2lzdGVuY2UueG1sIGVsZW1lbnRzIGludG8gdGhlIAogICAgICAgICAg\nICAgICAgLy8gTWV0YURhdGFGYWN0b3J5IHByb3BlcnR5IGltcGxpY2l0bHku\nICBpZiB0aGUgdXNlciBoYXMgYQogICAgICAgICAgICAgICAgLy8gZ2xvYmFs\nIG9wZW5qcGEueG1sIHdpdGggdGhpcyBwcm9wZXJ0eSBzZXQsIGl0cyB2YWx1\nZSB3aWxsCiAgICAgICAgICAgICAgICAvLyBnZXQgb3ZlcndyaXR0ZW4gYnkg\nb3VyIGltcGxpY2l0IHNldHRpbmcuICBzbyBpbnN0ZWFkLCBjb21iaW5lCiAg\nICAgICAgICAgICAgICAvLyB0aGUgZ2xvYmFsIHZhbHVlIHdpdGggb3VyIHNl\ndHRpbmdzCiAgICAgICAgICAgICAgICBTdHJpbmcgb3JpZyA9IG9jb25mLmdl\ndE1ldGFEYXRhRmFjdG9yeSgpOwogICAgICAgICAgICAgICAgaWYgKCFTdHJp\nbmdVdGlscy5pc0VtcHR5KG9yaWcpKSB7CiAgICAgICAgICAgICAgICAgICAg\nU3RyaW5nIGtleSA9IFByb2R1Y3REZXJpdmF0aW9ucy5nZXRDb25maWd1cmF0\naW9uS2V5CiAgICAgICAgICAgICAgICAgICAgICAgICgiTWV0YURhdGFGYWN0\nb3J5IiwgZ2V0UHJvcGVydGllcygpKTsKICAgICAgICAgICAgICAgICAgICBP\nYmplY3Qgb3ZlcnJpZGUgPSBnZXRQcm9wZXJ0aWVzKCkuZ2V0KGtleSk7CiAg\nICAgICAgICAgICAgICAgICAgaWYgKG92ZXJyaWRlIGluc3RhbmNlb2YgU3Ry\naW5nKQogICAgICAgICAgICAgICAgICAgICAgICBhZGRQcm9wZXJ0eShrZXks\nIENvbmZpZ3VyYXRpb25zLmNvbWJpbmVQbHVnaW5zKG9yaWcsIAogICAgICAg\nICAgICAgICAgICAgICAgICAgICAgKFN0cmluZykgb3ZlcnJpZGUpKTsKICAg\nICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgc3Vw\nZXIuc2V0SW50byhjb25mLCBudWxsKTsKICAgICAgICAgICAgTG9nIGxvZyA9\nIGNvbmYuZ2V0Q29uZmlndXJhdGlvbkxvZygpOwogICAgICAgICAgICBpZiAo\nbG9nLmlzVHJhY2VFbmFibGVkKCkpIHsKICAgICAgICAgICAgICAgIFN0cmlu\nZyBzcmMgPSAoX3NvdXJjZSA9PSBudWxsKSA/ICI/IiA6IF9zb3VyY2U7CiAg\nICAgICAgICAgICAgICBsb2cudHJhY2UoX2xvYy5nZXQoImNvbmYtbG9hZCIs\nIHNyYywgZ2V0UHJvcGVydGllcygpKSk7CiAgICAgICAgICAgIH0KICAgICAg\nICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBTQVggaGFuZGxlciBjYXBhYmxl\nIG9mIHBhcnNpbmcgYW4gSlBBIHBlcnNpc3RlbmNlLnhtbCBmaWxlLgogICAg\nICogUGFja2FnZS1wcm90ZWN0ZWQgZm9yIHRlc3RpbmcuCiAgICAgKi8KICAg\nIHB1YmxpYyBzdGF0aWMgY2xhc3MgQ29uZmlndXJhdGlvblBhcnNlcgogICAg\nICAgIGV4dGVuZHMgWE1MTWV0YURhdGFQYXJzZXIgewoKICAgICAgICBwcml2\nYXRlIGZpbmFsIE1hcCBfbWFwOwogICAgICAgIHByaXZhdGUgUGVyc2lzdGVu\nY2VVbml0SW5mb0ltcGwgX2luZm8gPSBudWxsOwogICAgICAgIHByaXZhdGUg\nVVJMIF9zb3VyY2UgPSBudWxsOwoKICAgICAgICBwdWJsaWMgQ29uZmlndXJh\ndGlvblBhcnNlcihNYXAgbWFwKSB7CiAgICAgICAgICAgIF9tYXAgPSBtYXA7\nCiAgICAgICAgICAgIHNldENhY2hpbmcoZmFsc2UpOwogICAgICAgICAgICBz\nZXRWYWxpZGF0aW5nKHRydWUpOwogICAgICAgICAgICBzZXRQYXJzZVRleHQo\ndHJ1ZSk7CiAgICAgICAgfQoKICAgICAgICBAT3ZlcnJpZGUKICAgICAgICBw\ndWJsaWMgdm9pZCBwYXJzZShVUkwgdXJsKQogICAgICAgICAgICB0aHJvd3Mg\nSU9FeGNlcHRpb24gewogICAgICAgICAgICBfc291cmNlID0gdXJsOwogICAg\nICAgICAgICBzdXBlci5wYXJzZSh1cmwpOwogICAgICAgIH0KCiAgICAgICAg\nQE92ZXJyaWRlCiAgICAgICAgcHVibGljIHZvaWQgcGFyc2UoRmlsZSBmaWxl\nKQogICAgICAgICAgICB0aHJvd3MgSU9FeGNlcHRpb24gewogICAgICAgICAg\nICB0cnkgewogICAgICAgICAgICAgICAgX3NvdXJjZSA9IChVUkwpIEFjY2Vz\nc0NvbnRyb2xsZXIuZG9Qcml2aWxlZ2VkKEoyRG9Qcml2SGVscGVyCiAgICAg\nICAgICAgICAgICAgICAgLnRvVVJMQWN0aW9uKGZpbGUpKTsKICAgICAgICAg\nICAgfSBjYXRjaCAoUHJpdmlsZWdlZEFjdGlvbkV4Y2VwdGlvbiBwYWUpIHsK\nICAgICAgICAgICAgICAgIHRocm93IChNYWxmb3JtZWRVUkxFeGNlcHRpb24p\nIHBhZS5nZXRFeGNlcHRpb24oKTsKICAgICAgICAgICAgfQogICAgICAgICAg\nICBzdXBlci5wYXJzZShmaWxlKTsKICAgICAgICB9CgogICAgICAgIEBPdmVy\ncmlkZQogICAgICAgIHByb3RlY3RlZCBPYmplY3QgZ2V0U2NoZW1hU291cmNl\nKCkgewogICAgICAgICAgICByZXR1cm4gZ2V0Q2xhc3MoKS5nZXRSZXNvdXJj\nZUFzU3RyZWFtKCJwZXJzaXN0ZW5jZS14c2QucnNyYyIpOwogICAgICAgIH0K\nCiAgICAgICAgQE92ZXJyaWRlCiAgICAgICAgcHJvdGVjdGVkIHZvaWQgcmVz\nZXQoKSB7CiAgICAgICAgICAgIHN1cGVyLnJlc2V0KCk7CiAgICAgICAgICAg\nIF9pbmZvID0gbnVsbDsKICAgICAgICAgICAgX3NvdXJjZSA9IG51bGw7CiAg\nICAgICAgfQoKICAgICAgICBwcm90ZWN0ZWQgYm9vbGVhbiBzdGFydEVsZW1l\nbnQoU3RyaW5nIG5hbWUsIEF0dHJpYnV0ZXMgYXR0cnMpCiAgICAgICAgICAg\nIHRocm93cyBTQVhFeGNlcHRpb24gewogICAgICAgICAgICBpZiAoY3VycmVu\ndERlcHRoKCkgPT0gMSkKICAgICAgICAgICAgICAgIHN0YXJ0UGVyc2lzdGVu\nY2VVbml0KGF0dHJzKTsKICAgICAgICAgICAgZWxzZSBpZiAoY3VycmVudERl\ncHRoKCkgPT0gMyAmJiAicHJvcGVydHkiLmVxdWFscyhuYW1lKSkKICAgICAg\nICAgICAgICAgIF9pbmZvLnNldFByb3BlcnR5KGF0dHJzLmdldFZhbHVlKCJu\nYW1lIiksCiAgICAgICAgICAgICAgICAgICAgYXR0cnMuZ2V0VmFsdWUoInZh\nbHVlIikpOwogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9Cgog\nICAgICAgIHByb3RlY3RlZCB2b2lkIGVuZEVsZW1lbnQoU3RyaW5nIG5hbWUp\nCiAgICAgICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24gewogICAgICAgICAg\nICBpZiAoY3VycmVudERlcHRoKCkgPT0gMSkgewogICAgICAgICAgICAgICAg\nX2luZm8uZnJvbVVzZXJQcm9wZXJ0aWVzKF9tYXApOwogICAgICAgICAgICAg\nICAgYWRkUmVzdWx0KF9pbmZvKTsKICAgICAgICAgICAgfQogICAgICAgICAg\nICBpZiAoY3VycmVudERlcHRoKCkgIT0gMikKICAgICAgICAgICAgICAgIHJl\ndHVybjsKCiAgICAgICAgICAgIHN3aXRjaCAobmFtZS5jaGFyQXQoMCkpIHsK\nICAgICAgICAgICAgICAgIGNhc2UgJ2MnOiAvLyBjbGFzcwogICAgICAgICAg\nICAgICAgICAgIF9pbmZvLmFkZE1hbmFnZWRDbGFzc05hbWUoY3VycmVudFRl\neHQoKSk7CiAgICAgICAgICAgICAgICBjYXNlICdlJzogLy8gZXhjbHVkZS11\nbmxpc3RlZC1jbGFzc2VzCiAgICAgICAgICAgICAgICAgICAgX2luZm8uc2V0\nRXhjbHVkZVVubGlzdGVkQ2xhc3NlcygidHJ1ZSIuZXF1YWxzSWdub3JlQ2Fz\nZQogICAgICAgICAgICAgICAgICAgICAgICAoY3VycmVudFRleHQoKSkpOwog\nICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2Fz\nZSAnaic6CiAgICAgICAgICAgICAgICAgICAgaWYgKCJqdGEtZGF0YS1zb3Vy\nY2UiLmVxdWFscyhuYW1lKSkKICAgICAgICAgICAgICAgICAgICAgICAgX2lu\nZm8uc2V0SnRhRGF0YVNvdXJjZU5hbWUoY3VycmVudFRleHQoKSk7CiAgICAg\nICAgICAgICAgICAgICAgZWxzZSAvLyBqYXItZmlsZQogICAgICAgICAgICAg\nICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHsKICAgICAg\nICAgICAgICAgICAgICAgICAgICAgIF9pbmZvLmFkZEphckZpbGVOYW1lKGN1\ncnJlbnRUZXh0KCkpOwogICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNo\nIChJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24gaWFlKSB7CiAgICAgICAgICAg\nICAgICAgICAgICAgICAgICB0aHJvdyBnZXRFeGNlcHRpb24oaWFlLmdldE1l\nc3NhZ2UoKSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAg\nICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAg\nICAgICAgICAgICBjYXNlICdtJzogLy8gbWFwcGluZy1maWxlCiAgICAgICAg\nICAgICAgICAgICAgX2luZm8uYWRkTWFwcGluZ0ZpbGVOYW1lKGN1cnJlbnRU\nZXh0KCkpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAg\nICAgICAgY2FzZSAnbic6IC8vIG5vbi1qdGEtZGF0YS1zb3VyY2UKICAgICAg\nICAgICAgICAgICAgICBfaW5mby5zZXROb25KdGFEYXRhU291cmNlTmFtZShj\ndXJyZW50VGV4dCgpKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAg\nICAgICAgICAgICAgIGNhc2UgJ3AnOgogICAgICAgICAgICAgICAgICAgIGlm\nICgicHJvdmlkZXIiLmVxdWFscyhuYW1lKSkKICAgICAgICAgICAgICAgICAg\nICAgICAgX2luZm8uc2V0UGVyc2lzdGVuY2VQcm92aWRlckNsYXNzTmFtZShj\ndXJyZW50VGV4dCgpKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAg\nICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgLyoqCiAgICAgICAgICog\nUGFyc2UgcGVyc2lzdGVuY2UtdW5pdCBlbGVtZW50LgogICAgICAgICAqLwog\nICAgICAgIHByaXZhdGUgdm9pZCBzdGFydFBlcnNpc3RlbmNlVW5pdChBdHRy\naWJ1dGVzIGF0dHJzKQogICAgICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9u\nIHsKICAgICAgICAgICAgX2luZm8gPSBuZXcgUGVyc2lzdGVuY2VVbml0SW5m\nb0ltcGwoKTsKICAgICAgICAgICAgX2luZm8uc2V0UGVyc2lzdGVuY2VVbml0\nTmFtZShhdHRycy5nZXRWYWx1ZSgibmFtZSIpKTsKCiAgICAgICAgICAgIC8v\nIHdlIG9ubHkgcGFyc2UgdGhpcyBvdXJzZWx2ZXMgb3V0c2lkZSBhIGNvbnRh\naW5lciwgc28gZGVmYXVsdAogICAgICAgICAgICAvLyB0cmFuc2FjdGlvbiB0\neXBlIHRvIGxvY2FsCiAgICAgICAgICAgIFN0cmluZyB2YWwgPSBhdHRycy5n\nZXRWYWx1ZSgidHJhbnNhY3Rpb24tdHlwZSIpOwogICAgICAgICAgICBpZiAo\ndmFsID09IG51bGwpCiAgICAgICAgICAgICAgICBfaW5mby5zZXRUcmFuc2Fj\ndGlvblR5cGUKICAgICAgICAgICAgICAgICAgICAoUGVyc2lzdGVuY2VVbml0\nVHJhbnNhY3Rpb25UeXBlLlJFU09VUkNFX0xPQ0FMKTsKICAgICAgICAgICAg\nZWxzZQogICAgICAgICAgICAgICAgX2luZm8uc2V0VHJhbnNhY3Rpb25UeXBl\nKEVudW0udmFsdWVPZgogICAgICAgICAgICAgICAgICAgIChQZXJzaXN0ZW5j\nZVVuaXRUcmFuc2FjdGlvblR5cGUuY2xhc3MsIHZhbCkpOwoKICAgICAgICAg\nICAgaWYgKF9zb3VyY2UgIT0gbnVsbCkKICAgICAgICAgICAgICAgIF9pbmZv\nLnNldFBlcnNpc3RlbmNlWG1sRmlsZVVybChfc291cmNlKTsKCQl9Cgl9Cn0K\n","encoding":"base64"}

