{"sha":"028f34ffdbea93b567c501bb7e62c622f6639359","node_id":"MDQ6QmxvYjIwNjM2NDowMjhmMzRmZmRiZWE5M2I1NjdjNTAxYmI3ZTYyYzYyMmY2NjM5MzU5","size":22839,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/028f34ffdbea93b567c501bb7e62c622f6639359","content":"LyoNCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUNCiAqIG9yIG1vcmUgY29udHJpYnV0b3Ig\nbGljZW5zZSBhZ3JlZW1lbnRzLiAgU2VlIHRoZSBOT1RJQ0UgZmlsZQ0KICog\nZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5m\nb3JtYXRpb24NCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAg\nVGhlIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUNCiAqIHRvIHlvdSB1bmRlciB0\naGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUNCiAqICJMaWNl\nbnNlIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNv\nbXBsaWFuY2UNCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFp\nbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQNCiAqDQogKiBodHRwOi8vd3d3\nLmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjANCiAqDQogKiBVbmxl\nc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGlu\nIHdyaXRpbmcsDQogKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUg\nTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbg0KICogIkFTIElTIiBCQVNJ\nUywgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZDQog\nKiBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBM\naWNlbnNlIGZvciB0aGUNCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmlu\nZyBwZXJtaXNzaW9ucyBhbmQgbGltaXRhdGlvbnMNCiAqIHVuZGVyIHRoZSBM\naWNlbnNlLg0KICovDQpwYWNrYWdlIG9yZy5hcGFjaGUub3BlbmpwYS5lbmhh\nbmNlOw0KDQppbXBvcnQgamF2YS5pby5JT0V4Y2VwdGlvbjsNCmltcG9ydCBq\nYXZhLmlvLkJ5dGVBcnJheU91dHB1dFN0cmVhbTsNCmltcG9ydCBqYXZhLmlv\nLk9iamVjdE91dHB1dFN0cmVhbTsNCmltcG9ydCBqYXZhLmlvLk9iamVjdElu\ncHV0U3RyZWFtOw0KaW1wb3J0IGphdmEuaW8uQnl0ZUFycmF5SW5wdXRTdHJl\nYW07DQppbXBvcnQgamF2YS51dGlsLkxpc3Q7DQppbXBvcnQgamF2YS51dGls\nLkNvbGxlY3Rpb25zOw0KaW1wb3J0IGphdmEubGFuZy5yZWZsZWN0LkZpZWxk\nOw0KDQppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNlLnRl\nc3QuU2luZ2xlRU1GVGVzdENhc2U7DQppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLnBlcnNpc3RlbmNlLk9wZW5KUEFFbnRpdHlNYW5hZ2VyOw0KaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5KUEFGYWNhZGVIZWxw\nZXI7DQppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5PcGVuSlBB\nU3RhdGVNYW5hZ2VyOw0KaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRh\nLkNsYXNzTWV0YURhdGE7DQppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0\naWwuSW1wbEhlbHBlcjsNCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuZXZl\nbnQuQWJzdHJhY3RMaWZlY3ljbGVMaXN0ZW5lcjsNCmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEuZXZlbnQuTGlmZWN5Y2xlRXZlbnQ7DQoNCnB1YmxpYyBh\nYnN0cmFjdCBjbGFzcyBBYnN0cmFjdFVuZW5oYW5jZWRDbGFzc1Rlc3QNCiAg\nICBleHRlbmRzIFNpbmdsZUVNRlRlc3RDYXNlIHsNCg0KICAgIC8vICMjIyMj\nIFRvIGRvOg0KICAgIC8vIC0gY2xlYXJpbmcgaW4gcG5ldyBwcm9wZXJ0eS1h\nY2Nlc3Mgd2l0aG91dCByZWRlZmluaXRpb24NCiAgICAvLyAtIGZpZ3VyZSBv\ndXQgaG93IHRvIGF1dG8tdGVzdCB0aGUgcmVkZWZpbml0aW9uIGNvZGUsIGVp\ndGhlciBpbiBKYXZhIDUNCiAgICAvLyAgIG9yIGluIEphdmEgNg0KICAgIC8v\nIC0gcnVuIENUUyBpbiB0aGUgZm9sbG93aW5nIGNvbWJpbmF0aW9uczoNCiAg\nICAvLyAgICogSmF2YSA2DQogICAgLy8gICAqIEphdmEgNSB3aXRoIGphdmFh\nZ2VudA0KICAgIC8vICAgKiBKYXZhIDUgd2l0aG91dCBqYXZhYWdlbnQNCg0K\nICAgIHB1YmxpYyB2b2lkIHNldFVwKCkgew0KICAgICAgICBzZXRVcChnZXRV\nbmVuaGFuY2VkQ2xhc3MoKSwgZ2V0VW5lbmhhbmNlZFN1YmNsYXNzKCksIENM\nRUFSX1RBQkxFUyk7DQogICAgICAgIC8vIHRyaWdnZXIgY2xhc3MgcmVkZWZp\nbml0aW9uDQogICAgICAgIGVtZi5jcmVhdGVFbnRpdHlNYW5hZ2VyKCkuY2xv\nc2UoKTsNCiAgICB9DQoNCiAgICBwcm90ZWN0ZWQgYWJzdHJhY3QgQ2xhc3M8\nPyBleHRlbmRzIFVuZW5oYW5jZWRUeXBlPiBnZXRVbmVuaGFuY2VkQ2xhc3Mo\nKTsNCg0KICAgIHByb3RlY3RlZCBhYnN0cmFjdCBVbmVuaGFuY2VkVHlwZSBu\nZXdVbmVuaGFuY2VkSW5zdGFuY2UoKTsNCg0KICAgIHByb3RlY3RlZCBhYnN0\ncmFjdCBDbGFzczw/IGV4dGVuZHMgVW5lbmhhbmNlZFN1YnR5cGU+IGdldFVu\nZW5oYW5jZWRTdWJjbGFzcygpOw0KDQogICAgcHJvdGVjdGVkIGFic3RyYWN0\nIFVuZW5oYW5jZWRTdWJ0eXBlIG5ld1VuZW5oYW5jZWRTdWJjbGFzc0luc3Rh\nbmNlKCk7DQoNCiAgICBwcml2YXRlIFVuZW5oYW5jZWRUeXBlIG5ld0luc3Rh\nbmNlKGJvb2xlYW4gc3ViKSB7DQogICAgICAgIHJldHVybiBzdWIgPyBuZXdV\nbmVuaGFuY2VkU3ViY2xhc3NJbnN0YW5jZSgpDQogICAgICAgICAgICA6IG5l\nd1VuZW5oYW5jZWRJbnN0YW5jZSgpOw0KICAgIH0NCg0KICAgIHB1YmxpYyB2\nb2lkIHRlc3RNZXRhRGF0YSgpIHsNCiAgICAgICAgQ2xhc3NNZXRhRGF0YSBt\nZXRhID0gSlBBRmFjYWRlSGVscGVyLmdldE1ldGFEYXRhKGVtZiwNCiAgICAg\nICAgICAgIGdldFVuZW5oYW5jZWRDbGFzcygpKTsNCiAgICAgICAgYXNzZXJ0\nRXF1YWxzKENsYXNzUmVkZWZpbmVyLmNhblJlZGVmaW5lQ2xhc3NlcygpLA0K\nICAgICAgICAgICAgbWV0YS5pc0ludGVyY2VwdGluZygpKTsNCiAgICB9DQoN\nCiAgICBwdWJsaWMgdm9pZCB0ZXN0SW1wbEhlbHBlckNhbGxzKCkgew0KICAg\nICAgICBhc3NlcnRUcnVlKEltcGxIZWxwZXIuaXNNYW5hZ2VkVHlwZShudWxs\nLCBnZXRVbmVuaGFuY2VkQ2xhc3MoKSkpOw0KDQogICAgICAgIFVuZW5oYW5j\nZWRUeXBlIHVuID0gbmV3VW5lbmhhbmNlZEluc3RhbmNlKCk7DQogICAgICAg\nIGFzc2VydEZhbHNlKHVuIGluc3RhbmNlb2YgUGVyc2lzdGVuY2VDYXBhYmxl\nKTsNCiAgICAgICAgUGVyc2lzdGVuY2VDYXBhYmxlIHBjID0gSW1wbEhlbHBl\nci50b1BlcnNpc3RlbmNlQ2FwYWJsZSh1biwNCiAgICAgICAgICAgIGVtZi5n\nZXRDb25maWd1cmF0aW9uKCkpOw0KICAgICAgICBhc3NlcnROb3ROdWxsKHBj\nKTsNCiAgICAgICAgYXNzZXJ0VHJ1ZShJbXBsSGVscGVyLmlzTWFuYWdlYWJs\nZSh1bikpOw0KICAgIH0NCg0KICAgIHB1YmxpYyB2b2lkIHRlc3RCYXNpY1Bl\ncnNpc3RlbmNlQ2FwYWJsZUJlaGF2aW9yKCkgew0KICAgICAgICBVbmVuaGFu\nY2VkVHlwZSB1biA9IG5ld1VuZW5oYW5jZWRJbnN0YW5jZSgpOw0KICAgICAg\nICB1bi5zZXRTdHJpbmdGaWVsZCgiYmFyIik7DQogICAgICAgIFBlcnNpc3Rl\nbmNlQ2FwYWJsZSBwYyA9IEltcGxIZWxwZXIudG9QZXJzaXN0ZW5jZUNhcGFi\nbGUodW4sDQogICAgICAgICAgICBlbWYuZ2V0Q29uZmlndXJhdGlvbigpKTsN\nCiAgICAgICAgYXNzZXJ0RmFsc2UocGMucGNJc0RlbGV0ZWQoKSk7DQogICAg\nICAgIGFzc2VydEZhbHNlKHBjLnBjSXNEaXJ0eSgpKTsNCiAgICAgICAgYXNz\nZXJ0RmFsc2UocGMucGNJc05ldygpKTsNCiAgICAgICAgYXNzZXJ0RmFsc2Uo\ncGMucGNJc1BlcnNpc3RlbnQoKSk7DQogICAgICAgIGFzc2VydEZhbHNlKHBj\nLnBjSXNUcmFuc2FjdGlvbmFsKCkpOw0KICAgIH0NCg0KICAgIHB1YmxpYyB2\nb2lkIHRlc3RQQ1JlZ2lzdHJ5KCkgew0KICAgICAgICBhc3NlcnRUcnVlKFBD\nUmVnaXN0cnkuaXNSZWdpc3RlcmVkKGdldFVuZW5oYW5jZWRDbGFzcygpKSk7\nDQogICAgICAgIFBlcnNpc3RlbmNlQ2FwYWJsZSBwYyA9IFBDUmVnaXN0cnku\nbmV3SW5zdGFuY2UoDQogICAgICAgICAgICBnZXRVbmVuaGFuY2VkQ2xhc3Mo\nKSwgbnVsbCwgZmFsc2UpOw0KICAgICAgICBhc3NlcnROb3ROdWxsKHBjKTsN\nCiAgICAgICAgYXNzZXJ0RXF1YWxzKHBjLmdldENsYXNzKCksIFBDUmVnaXN0\ncnkuZ2V0UENUeXBlKGdldFVuZW5oYW5jZWRDbGFzcygpKSk7DQogICAgfQ0K\nDQogICAgcHVibGljIHZvaWQgdGVzdENsZWFyaW5nT25TdWJ0eXBlSW5zdGFu\nY2UoKSB7DQogICAgICAgIC8vIHRoZSBib29sZWFuIGF0IHRoZSBlbmQgb2Yg\nbmV3SW5zdGFuY2Ugd2lsbCBjYXVzZSBjbGVhciB0byBiZSBpbnZva2VkDQog\nICAgICAgIFVuZW5oYW5jZWRUeXBlIHVuID0gKFVuZW5oYW5jZWRUeXBlKQ0K\nICAgICAgICAgICAgUENSZWdpc3RyeS5uZXdJbnN0YW5jZShnZXRVbmVuaGFu\nY2VkQ2xhc3MoKSwgbnVsbCwgdHJ1ZSk7DQogICAgICAgIGFzc2VydEVxdWFs\ncyhudWxsLCB1bi5nZXRTdHJpbmdGaWVsZCgpKTsNCiAgICB9DQoNCiAgICBw\ndWJsaWMgdm9pZCB0ZXN0R2V0T2JqZWN0SWRPbk9wZW5KUEFUeXBlKCkgew0K\nICAgICAgICBnZXRPYmplY3RJZEhlbHBlcih0cnVlLCBmYWxzZSk7DQogICAg\nfQ0KDQogICAgcHVibGljIHZvaWQgdGVzdEdldE9iamVjdElkT25PcGVuSlBB\nVHlwZVN1YmNsYXNzKCkgew0KICAgICAgICBnZXRPYmplY3RJZEhlbHBlcihm\nYWxzZSwgZmFsc2UpOw0KICAgIH0NCg0KICAgIHB1YmxpYyB2b2lkIHRlc3RH\nZXRPYmplY3RJZE9uVXNlckRlZmluZWQoKSB7DQogICAgICAgIGdldE9iamVj\ndElkSGVscGVyKHRydWUsIHRydWUpOw0KICAgIH0NCg0KICAgIHB1YmxpYyB2\nb2lkIHRlc3RHZXRPYmplY3RJZE9uVXNlckRlZmluZWRTdWJjbGFzcygpIHsN\nCiAgICAgICAgZ2V0T2JqZWN0SWRIZWxwZXIoZmFsc2UsIHRydWUpOw0KICAg\nIH0NCg0KICAgIHByaXZhdGUgdm9pZCBnZXRPYmplY3RJZEhlbHBlcihib29s\nZWFuIHN1YiwgYm9vbGVhbiB1c2VyRGVmaW5lZCkgew0KICAgICAgICBPcGVu\nSlBBRW50aXR5TWFuYWdlciBlbSA9IGVtZi5jcmVhdGVFbnRpdHlNYW5hZ2Vy\nKCk7DQogICAgICAgIGVtLmdldFRyYW5zYWN0aW9uKCkuYmVnaW4oKTsNCiAg\nICAgICAgVW5lbmhhbmNlZFR5cGUgdW4gPSBuZXdJbnN0YW5jZShzdWIpOw0K\nICAgICAgICBlbS5wZXJzaXN0KHVuKTsNCiAgICAgICAgZW0uZ2V0VHJhbnNh\nY3Rpb24oKS5jb21taXQoKTsNCg0KICAgICAgICBpZiAoIXVzZXJEZWZpbmVk\nKSB7DQogICAgICAgICAgICBlbS5jbG9zZSgpOw0KICAgICAgICAgICAgZW0g\nPSBlbWYuY3JlYXRlRW50aXR5TWFuYWdlcigpOw0KICAgICAgICAgICAgdW4g\nPSBlbS5maW5kKGdldFVuZW5oYW5jZWRDbGFzcygpLCB1bi5nZXRJZCgpKTsN\nCiAgICAgICAgfQ0KDQogICAgICAgIGFzc2VydE5vdE51bGwoZW0uZ2V0T2Jq\nZWN0SWQodW4pKTsNCiAgICB9DQoNCiAgICBwdWJsaWMgdm9pZCB0ZXN0T3Bl\ncmF0aW9uc09uVXNlckRlZmluZWQoKSB7DQogICAgICAgIG9wc0hlbHBlcihm\nYWxzZSwgdHJ1ZSk7DQogICAgfQ0KDQogICAgcHVibGljIHZvaWQgdGVzdFN1\nYmNsYXNzT3BlcmF0aW9uc09uVXNlckRlZmluZWQoKSB7DQogICAgICAgIG9w\nc0hlbHBlcih0cnVlLCB0cnVlKTsNCiAgICB9DQoNCiAgICBwdWJsaWMgdm9p\nZCB0ZXN0T3BlcmF0aW9uc09uT3BlbkpQQURlZmluZWQoKSB7DQogICAgICAg\nIG9wc0hlbHBlcihmYWxzZSwgZmFsc2UpOw0KICAgIH0NCg0KICAgIHB1Ymxp\nYyB2b2lkIHRlc3RTdWJjbGFzc09wZXJhdGlvbnNPbk9wZW5KUEFEZWZpbmVk\nKCkgew0KICAgICAgICBvcHNIZWxwZXIodHJ1ZSwgZmFsc2UpOw0KICAgIH0N\nCg0KICAgIHByaXZhdGUgdm9pZCBvcHNIZWxwZXIoYm9vbGVhbiBzdWIsIGJv\nb2xlYW4gdXNlckRlZmluZWQpIHsNCiAgICAgICAgT3BlbkpQQUVudGl0eU1h\nbmFnZXIgZW0gPSBudWxsOw0KICAgICAgICB0cnkgew0KICAgICAgICAgICAg\nVW5lbmhhbmNlZFR5cGUgdW4gPSBuZXdJbnN0YW5jZShzdWIpOw0KICAgICAg\nICAgICAgZW0gPSBlbWYuY3JlYXRlRW50aXR5TWFuYWdlcigpOw0KDQogICAg\nICAgICAgICBlbS5nZXRUcmFuc2FjdGlvbigpLmJlZ2luKCk7DQogICAgICAg\nICAgICBlbS5wZXJzaXN0KHVuKTsNCiAgICAgICAgICAgIHVuLnNldFN0cmlu\nZ0ZpZWxkKCJiYXIiKTsNCiAgICAgICAgICAgIGFzc2VydEVxdWFscygiYmFy\nIiwgdW4uZ2V0U3RyaW5nRmllbGQoKSk7DQogICAgICAgICAgICBhc3NlcnRQ\nZXJzaXN0ZW5jZUNvbnRleHQoZW0sIHVuLCB0cnVlLCB0cnVlLCBzdWIpOw0K\nICAgICAgICAgICAgZW0uZmx1c2goKTsNCiAgICAgICAgICAgIGFzc2VydFBl\ncnNpc3RlbmNlQ29udGV4dChlbSwgdW4sIHRydWUsIHRydWUsIHN1Yik7DQog\nICAgICAgICAgICBhc3NlcnRUcnVlKHVuLmdldElkKCkgIT0gMCk7DQogICAg\nICAgICAgICBVbmVuaGFuY2VkVHlwZSB1bjIgPSBlbS5maW5kKGdldFVuZW5o\nYW5jZWRDbGFzcygpLCB1bi5nZXRJZCgpKTsNCiAgICAgICAgICAgIGFzc2Vy\ndFNhbWUodW4sIHVuMik7DQogICAgICAgICAgICBlbS5nZXRUcmFuc2FjdGlv\nbigpLmNvbW1pdCgpOw0KICAgICAgICAgICAgYXNzZXJ0UGVyc2lzdGVuY2VD\nb250ZXh0KGVtLCB1biwgZmFsc2UsIGZhbHNlLCBzdWIpOw0KICAgICAgICAg\nICAgdW4yID0gZW0uZmluZChnZXRVbmVuaGFuY2VkQ2xhc3MoKSwgdW4uZ2V0\nSWQoKSk7DQogICAgICAgICAgICBhc3NlcnRTYW1lKHVuLCB1bjIpOw0KDQog\nICAgICAgICAgICBpZiAoIXVzZXJEZWZpbmVkKSB7DQogICAgICAgICAgICAg\nICAgZW0uY2xvc2UoKTsNCiAgICAgICAgICAgICAgICBlbSA9IGVtZi5jcmVh\ndGVFbnRpdHlNYW5hZ2VyKCk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAg\nICAgIHVuID0gZW0uZmluZChnZXRVbmVuaGFuY2VkQ2xhc3MoKSwgdW4uZ2V0\nSWQoKSk7DQogICAgICAgICAgICBhc3NlcnROb3ROdWxsKHVuKTsNCiAgICAg\nICAgICAgIGlmICghdXNlckRlZmluZWQpDQogICAgICAgICAgICAgICAgYXNz\nZXJ0VHJ1ZSh1biBpbnN0YW5jZW9mIFBlcnNpc3RlbmNlQ2FwYWJsZSk7DQog\nICAgICAgICAgICBhc3NlcnRFcXVhbHMoImJhciIsIHVuLmdldFN0cmluZ0Zp\nZWxkKCkpOw0KICAgICAgICAgICAgZW0uZ2V0VHJhbnNhY3Rpb24oKS5iZWdp\nbigpOw0KICAgICAgICAgICAgdW4uc2V0U3RyaW5nRmllbGQoImJheiIpOw0K\nICAgICAgICAgICAgYXNzZXJ0UGVyc2lzdGVuY2VDb250ZXh0KGVtLCB1biwg\ndHJ1ZSwgdHJ1ZSwgc3ViKTsNCiAgICAgICAgICAgIGFzc2VydEVxdWFscygi\nYmF6IiwgdW4uZ2V0U3RyaW5nRmllbGQoKSk7DQoNCiAgICAgICAgICAgIGlm\nIChzdWIpDQogICAgICAgICAgICAgICAgKChVbmVuaGFuY2VkU3VidHlwZSkg\ndW4pLnNldEludEZpZWxkKDE3KTsNCg0KICAgICAgICAgICAgYXNzZXJ0VHJ1\nZShlbS5pc0RpcnR5KHVuKSk7DQogICAgICAgICAgICANCiAgICAgICAgICAg\nIGVtLmdldFRyYW5zYWN0aW9uKCkuY29tbWl0KCk7DQoNCiAgICAgICAgICAg\nIC8vIG1ha2Ugc3VyZSB0aGF0IHRoZSB2YWx1ZXMgYXJlIHN0aWxsIHVwLXRv\nLWRhdGUgYWZ0ZXINCiAgICAgICAgICAgIC8vIHRoZSBjb21taXQgaGFwcGVu\ncw0KICAgICAgICAgICAgYXNzZXJ0RXF1YWxzKCJiYXoiLCB1bi5nZXRTdHJp\nbmdGaWVsZCgpKTsNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgZW0uY2xv\nc2UoKTsNCg0KICAgICAgICAgICAgZW0gPSBlbWYuY3JlYXRlRW50aXR5TWFu\nYWdlcigpOw0KICAgICAgICAgICAgdW4gPSBlbS5maW5kKGdldFVuZW5oYW5j\nZWRDbGFzcygpLCB1bi5nZXRJZCgpKTsNCiAgICAgICAgICAgIGFzc2VydE5v\ndE51bGwodW4pOw0KICAgICAgICAgICAgYXNzZXJ0VHJ1ZSh1biBpbnN0YW5j\nZW9mIFBlcnNpc3RlbmNlQ2FwYWJsZSk7DQogICAgICAgICAgICBhc3NlcnRF\ncXVhbHMoImJheiIsIHVuLmdldFN0cmluZ0ZpZWxkKCkpOw0KICAgICAgICAg\nICAgaWYgKHN1YikNCiAgICAgICAgICAgICAgICBhc3NlcnRFcXVhbHMoMTcs\nICgoVW5lbmhhbmNlZFN1YnR5cGUpIHVuKS5nZXRJbnRGaWVsZCgpKTsNCiAg\nICAgICAgICAgIGVtLmNsb3NlKCk7DQogICAgICAgIH0gZmluYWxseSB7DQog\nICAgICAgICAgICBpZiAoZW0gIT0gbnVsbCAmJiBlbS5nZXRUcmFuc2FjdGlv\nbigpLmlzQWN0aXZlKCkpDQogICAgICAgICAgICAgICAgZW0uZ2V0VHJhbnNh\nY3Rpb24oKS5yb2xsYmFjaygpOw0KICAgICAgICAgICAgaWYgKGVtICE9IG51\nbGwgJiYgZW0uaXNPcGVuKCkpDQogICAgICAgICAgICAgICAgZW0uY2xvc2Uo\nKTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIHByaXZhdGUgdm9pZCBhc3Nl\ncnRQZXJzaXN0ZW5jZUNvbnRleHQoT3BlbkpQQUVudGl0eU1hbmFnZXIgZW0s\nDQogICAgICAgIFVuZW5oYW5jZWRUeXBlIHVuLCBib29sZWFuIHRyYW5zYWN0\naW9uYWwsIGJvb2xlYW4gZGlydHksIGJvb2xlYW4gc3ViKSB7DQogICAgICAg\nIGFzc2VydEVxdWFscyh0cmFuc2FjdGlvbmFsLCBlbS5nZXRUcmFuc2FjdGlv\nbmFsT2JqZWN0cygpLmNvbnRhaW5zKHVuKSk7DQogICAgICAgIGFzc2VydEVx\ndWFscyhkaXJ0eSwgZW0uZ2V0RGlydHlPYmplY3RzKCkuY29udGFpbnModW4p\nKTsNCiAgICAgICAgaWYgKGRpcnR5KSB7DQogICAgICAgICAgICBDbGFzcyBj\nbHMgPSBzdWIgPyBnZXRVbmVuaGFuY2VkU3ViY2xhc3MoKSA6IGdldFVuZW5o\nYW5jZWRDbGFzcygpOw0KICAgICAgICAgICAgYXNzZXJ0VHJ1ZShlbS5nZXRV\ncGRhdGVkQ2xhc3NlcygpLmNvbnRhaW5zKGNscykNCiAgICAgICAgICAgICAg\nICB8fCBlbS5nZXRQZXJzaXN0ZWRDbGFzc2VzKCkuY29udGFpbnMoY2xzKSk7\nDQogICAgICAgIH0NCiAgICB9DQoNCiAgICBwdWJsaWMgdm9pZCB0ZXN0UmVs\nYXRpb25zKCkgew0KICAgICAgICBPcGVuSlBBRW50aXR5TWFuYWdlciBlbSA9\nIGVtZi5jcmVhdGVFbnRpdHlNYW5hZ2VyKCk7DQogICAgICAgIGVtLmdldFRy\nYW5zYWN0aW9uKCkuYmVnaW4oKTsNCiAgICAgICAgVW5lbmhhbmNlZFN1YnR5\ncGUgdW4gPSBuZXdVbmVuaGFuY2VkU3ViY2xhc3NJbnN0YW5jZSgpOw0KICAg\nICAgICBlbS5wZXJzaXN0KHVuKTsNCiAgICAgICAgdW4uc2V0U3RyaW5nRmll\nbGQoImFvZXUiKTsNCiAgICAgICAgVW5lbmhhbmNlZFN1YnR5cGUgcmVsYXRl\nZCA9IG5ld1VuZW5oYW5jZWRTdWJjbGFzc0luc3RhbmNlKCk7DQogICAgICAg\nIHVuLnNldFJlbGF0ZWQocmVsYXRlZCk7DQogICAgICAgIHJlbGF0ZWQuc2V0\nU3RyaW5nRmllbGQoInNudGgiKTsNCiAgICAgICAgZW0uZ2V0VHJhbnNhY3Rp\nb24oKS5jb21taXQoKTsNCiAgICAgICAgZW0uY2xvc2UoKTsNCg0KICAgICAg\nICBlbSA9IGVtZi5jcmVhdGVFbnRpdHlNYW5hZ2VyKCk7DQogICAgICAgIHVu\nID0gKFVuZW5oYW5jZWRTdWJ0eXBlKSBlbS5maW5kKGdldFVuZW5oYW5jZWRD\nbGFzcygpLCB1bi5nZXRJZCgpKTsNCiAgICAgICAgYXNzZXJ0RXF1YWxzKCJh\nb2V1IiwgdW4uZ2V0U3RyaW5nRmllbGQoKSk7DQogICAgICAgIGFzc2VydE5v\ndE51bGwodW4uZ2V0UmVsYXRlZCgpKTsNCiAgICAgICAgYXNzZXJ0RXF1YWxz\nKCJzbnRoIiwgdW4uZ2V0UmVsYXRlZCgpLmdldFN0cmluZ0ZpZWxkKCkpOw0K\nICAgICAgICBlbS5jbG9zZSgpOw0KICAgIH0NCg0KICAgIHB1YmxpYyB2b2lk\nIHRlc3RFbmhhbmNlcigpIHRocm93cyBJT0V4Y2VwdGlvbiB7DQogICAgICAg\nIExpc3Q8Q2xhc3M+IHN1YnMgPSAgTWFuYWdlZENsYXNzU3ViY2xhc3Nlci5w\ncmVwYXJlVW5lbmhhbmNlZENsYXNzZXMoDQogICAgICAgICAgICBlbWYuZ2V0\nQ29uZmlndXJhdGlvbigpLA0KICAgICAgICAgICAgQ29sbGVjdGlvbnMuc2lu\nZ2xldG9uKGdldFVuZW5oYW5jZWRDbGFzcygpKSwgbnVsbCk7DQogICAgICAg\nIENsYXNzIHN1YiA9IHN1YnMuZ2V0KDApOw0KICAgICAgICBhc3NlcnROb3RO\ndWxsKHN1Yik7DQogICAgICAgIGFzc2VydEVxdWFscygib3JnLmFwYWNoZS5v\ncGVuanBhLmVuaGFuY2UuIg0KICAgICAgICAgICAgKyBnZXRVbmVuaGFuY2Vk\nQ2xhc3MoKS5nZXROYW1lKCkucmVwbGFjZSgnLicsICckJykgKyAiJHBjc3Vi\nY2xhc3MiLA0KICAgICAgICAgICAgc3ViLmdldE5hbWUoKSk7DQogICAgICAg\nIGFzc2VydFRydWUoUGVyc2lzdGVuY2VDYXBhYmxlLmNsYXNzLmlzQXNzaWdu\nYWJsZUZyb20oc3ViKSk7DQogICAgICAgIGFzc2VydFRydWUoZ2V0VW5lbmhh\nbmNlZENsYXNzKCkuaXNBc3NpZ25hYmxlRnJvbShzdWIpKTsNCiAgICB9DQoN\nCiAgICBwdWJsaWMgdm9pZCB0ZXN0UENTdWJjbGFzc05hbWUoKSB7DQogICAg\nICAgIGFzc2VydEVxdWFscygib3JnLmFwYWNoZS5vcGVuanBhLmVuaGFuY2Uu\nIg0KICAgICAgICAgICAgKyBnZXRVbmVuaGFuY2VkQ2xhc3MoKS5nZXROYW1l\nKCkucmVwbGFjZSgnLicsICckJykgKyAiJHBjc3ViY2xhc3MiLA0KICAgICAg\nICAgICAgUENFbmhhbmNlci50b1BDU3ViY2xhc3NOYW1lKGdldFVuZW5oYW5j\nZWRDbGFzcygpKSk7DQogICAgfQ0KDQogICAgcHVibGljIHZvaWQgdGVzdEV2\naWN0aW9uSW5Vc2VyQ3JlYXRlZEluc3RhbmNlKCkNCiAgICAgICAgdGhyb3dz\nIE5vU3VjaEZpZWxkRXhjZXB0aW9uLCBJbGxlZ2FsQWNjZXNzRXhjZXB0aW9u\nIHsNCiAgICAgICAgZXZpY3Rpb25IZWxwZXIodHJ1ZSk7DQogICAgfQ0KDQog\nICAgcHVibGljIHZvaWQgdGVzdEV2aWN0aW9uSW5PcGVuSlBBQ3JlYXRlZElu\nc3RhbmNlKCkNCiAgICAgICAgdGhyb3dzIE5vU3VjaEZpZWxkRXhjZXB0aW9u\nLCBJbGxlZ2FsQWNjZXNzRXhjZXB0aW9uIHsNCiAgICAgICAgZXZpY3Rpb25I\nZWxwZXIoZmFsc2UpOw0KICAgIH0NCg0KICAgIHByaXZhdGUgdm9pZCBldmlj\ndGlvbkhlbHBlcihib29sZWFuIHVzZXJEZWZpbmVkKQ0KICAgICAgICB0aHJv\nd3MgTm9TdWNoRmllbGRFeGNlcHRpb24sIElsbGVnYWxBY2Nlc3NFeGNlcHRp\nb24gew0KICAgICAgICBPcGVuSlBBRW50aXR5TWFuYWdlciBlbSA9IGVtZi5j\ncmVhdGVFbnRpdHlNYW5hZ2VyKCk7DQogICAgICAgIFVuZW5oYW5jZWRUeXBl\nIHVuID0gbmV3VW5lbmhhbmNlZEluc3RhbmNlKCk7DQogICAgICAgIGVtLmdl\ndFRyYW5zYWN0aW9uKCkuYmVnaW4oKTsNCiAgICAgICAgZW0ucGVyc2lzdCh1\nbik7DQogICAgICAgIGVtLmdldFRyYW5zYWN0aW9uKCkuY29tbWl0KCk7DQoN\nCiAgICAgICAgaWYgKCF1c2VyRGVmaW5lZCkgew0KICAgICAgICAgICAgZW0u\nY2xvc2UoKTsNCiAgICAgICAgICAgIGVtID0gZW1mLmNyZWF0ZUVudGl0eU1h\nbmFnZXIoKTsNCiAgICAgICAgICAgIHVuID0gZW0uZmluZChnZXRVbmVuaGFu\nY2VkQ2xhc3MoKSwgdW4uZ2V0SWQoKSk7DQogICAgICAgICAgICBhc3NlcnRU\ncnVlKGdldFVuZW5oYW5jZWRDbGFzcygpICE9IHVuLmdldENsYXNzKCkpOw0K\nICAgICAgICB9DQoNCiAgICAgICAgZW0uZXZpY3QodW4pOw0KICAgICAgICBP\ncGVuSlBBU3RhdGVNYW5hZ2VyIHNtID0gKE9wZW5KUEFTdGF0ZU1hbmFnZXIp\nDQogICAgICAgICAgICBJbXBsSGVscGVyLnRvUGVyc2lzdGVuY2VDYXBhYmxl\nKHVuLCBudWxsKS5wY0dldFN0YXRlTWFuYWdlcigpOw0KDQogICAgICAgIC8v\nIHdlIG9ubHkgZXhwZWN0IGxhenkgbG9hZGluZyB0byB3b3JrIHdoZW4gd2Ug\nY2FuIHJlZGVmaW5lIGNsYXNzZXMNCiAgICAgICAgLy8gb3Igd2hlbiBhY2Nl\nc3NpbmcgYSBwcm9wZXJ0eS1hY2Nlc3MgcmVjb3JkIHRoYXQgT3BlbkpQQSBj\ncmVhdGVkLg0KICAgICAgICBpZiAoQ2xhc3NSZWRlZmluZXIuY2FuUmVkZWZp\nbmVDbGFzc2VzKCkNCiAgICAgICAgICAgIHx8ICghdXNlckRlZmluZWQgJiYg\nc20uZ2V0TWV0YURhdGEoKS5nZXRBY2Nlc3NUeXBlKCkNCiAgICAgICAgICAg\nICAgICAhPSBDbGFzc01ldGFEYXRhLkFDQ0VTU19GSUVMRCkpIHsNCg0KICAg\nICAgICAgICAgYXNzZXJ0RmFsc2Uoc20uZ2V0TG9hZGVkKCkNCiAgICAgICAg\nICAgICAgICAuZ2V0KHNtLmdldE1ldGFEYXRhKCkuZ2V0RmllbGQoInN0cmlu\nZ0ZpZWxkIikuZ2V0SW5kZXgoKSkpOw0KDQogICAgICAgICAgICAvLyBtYWtl\nIHN1cmUgdGhhdCB0aGUgdmFsdWUgd2FzIGNsZWFyZWQuLi4NCiAgICAgICAg\nICAgIEZpZWxkIGZpZWxkID0gZ2V0VW5lbmhhbmNlZENsYXNzKCkuZ2V0RGVj\nbGFyZWRGaWVsZCgNCiAgICAgICAgICAgICAgICBpc0ZpZWxkQWNjZXNzVGVz\ndCgpID8gInN0cmluZ0ZpZWxkIiA6ICJzZiIpOw0KICAgICAgICAgICAgZmll\nbGQuc2V0QWNjZXNzaWJsZSh0cnVlKTsNCiAgICAgICAgICAgIGFzc2VydEVx\ndWFscyhudWxsLCBmaWVsZC5nZXQodW4pKTsNCg0KICAgICAgICAgICAgLy8g\nLi4uIGFuZCB0aGF0IGl0IGdldHMgcmVsb2FkZWQgcHJvcGVybHkNCiAgICAg\nICAgICAgIGFzc2VydEVxdWFscygiZm9vIiwgdW4uZ2V0U3RyaW5nRmllbGQo\nKSk7DQogICAgICAgICAgICBhc3NlcnRUcnVlKHNtLmdldExvYWRlZCgpDQog\nICAgICAgICAgICAgICAgLmdldChzbS5nZXRNZXRhRGF0YSgpLmdldEZpZWxk\nKCJzdHJpbmdGaWVsZCIpLmdldEluZGV4KCkpKTsNCiAgICAgICAgfSBlbHNl\nIHsNCiAgICAgICAgICAgIC8vIHVucmVkZWZpbmVkIHByb3BlcnRpZXMgd2l0\naCB1c2VyLWRlZmluZWQgaW5zdGFuY2UsIG9yIGFueQ0KICAgICAgICAgICAg\nLy8gdW5yZWRlZmluZWQgZmllbGQgYWNjZXNzDQogICAgICAgICAgICBhc3Nl\ncnRUcnVlKHNtLmdldExvYWRlZCgpDQogICAgICAgICAgICAgICAgLmdldChz\nbS5nZXRNZXRhRGF0YSgpLmdldEZpZWxkKCJzdHJpbmdGaWVsZCIpLmdldElu\nZGV4KCkpKTsNCg0KICAgICAgICAgICAgLy8gbWFrZSBzdXJlIHRoYXQgdGhl\nIHZhbHVlIHdhcyBub3QgY2xlYXJlZA0KICAgICAgICAgICAgRmllbGQgZmll\nbGQgPSBnZXRVbmVuaGFuY2VkQ2xhc3MoKS5nZXREZWNsYXJlZEZpZWxkKA0K\nICAgICAgICAgICAgICAgIGlzRmllbGRBY2Nlc3NUZXN0KCkgPyAic3RyaW5n\nRmllbGQiIDogInNmIik7DQogICAgICAgICAgICBmaWVsZC5zZXRBY2Nlc3Np\nYmxlKHRydWUpOw0KICAgICAgICAgICAgYXNzZXJ0RXF1YWxzKCJmb28iLCBm\naWVsZC5nZXQodW4pKTsNCiAgICAgICAgfQ0KDQogICAgICAgIGVtLmNsb3Nl\nKCk7DQogICAgfQ0KDQogICAgcHJvdGVjdGVkIGFic3RyYWN0IGJvb2xlYW4g\naXNGaWVsZEFjY2Vzc1Rlc3QoKTsNCg0KICAgIHB1YmxpYyB2b2lkIHRlc3RM\nYXp5TG9hZGluZygpDQogICAgICAgIHRocm93cyBOb1N1Y2hGaWVsZEV4Y2Vw\ndGlvbiwgSWxsZWdhbEFjY2Vzc0V4Y2VwdGlvbiB7DQogICAgICAgIE9wZW5K\nUEFFbnRpdHlNYW5hZ2VyIGVtID0gZW1mLmNyZWF0ZUVudGl0eU1hbmFnZXIo\nKTsNCiAgICAgICAgVW5lbmhhbmNlZFR5cGUgdW4gPSBuZXdVbmVuaGFuY2Vk\nSW5zdGFuY2UoKTsNCiAgICAgICAgZW0uZ2V0VHJhbnNhY3Rpb24oKS5iZWdp\nbigpOw0KICAgICAgICBlbS5wZXJzaXN0KHVuKTsNCiAgICAgICAgZW0uZ2V0\nVHJhbnNhY3Rpb24oKS5jb21taXQoKTsNCiAgICAgICAgZW0uY2xvc2UoKTsN\nCg0KICAgICAgICBlbSA9IGVtZi5jcmVhdGVFbnRpdHlNYW5hZ2VyKCk7DQog\nICAgICAgIHVuID0gZW0uZmluZChnZXRVbmVuaGFuY2VkQ2xhc3MoKSwgdW4u\nZ2V0SWQoKSk7DQogICAgICAgIGFzc2VydFRydWUoZ2V0VW5lbmhhbmNlZENs\nYXNzKCkgIT0gdW4uZ2V0Q2xhc3MoKSk7DQogICAgICAgIE9wZW5KUEFTdGF0\nZU1hbmFnZXIgc20gPSAoT3BlbkpQQVN0YXRlTWFuYWdlcikNCiAgICAgICAg\nICAgIEltcGxIZWxwZXIudG9QZXJzaXN0ZW5jZUNhcGFibGUodW4sIG51bGwp\nLnBjR2V0U3RhdGVNYW5hZ2VyKCk7DQoNCiAgICAgICAgLy8gd2Ugb25seSBl\neHBlY3QgbGF6eSBsb2FkaW5nIHRvIHdvcmsgd2hlbiB3ZSBjYW4gcmVkZWZp\nbmUgY2xhc3Nlcw0KICAgICAgICAvLyBvciB3aGVuIGFjY2Vzc2luZyBhIHBy\nb3BlcnR5LWFjY2VzcyByZWNvcmQgdGhhdCBPcGVuSlBBIGNyZWF0ZWQuDQog\nICAgICAgIGlmIChDbGFzc1JlZGVmaW5lci5jYW5SZWRlZmluZUNsYXNzZXMo\nKQ0KICAgICAgICAgICAgfHwgKHNtLmdldE1ldGFEYXRhKCkuZ2V0QWNjZXNz\nVHlwZSgpICE9IENsYXNzTWV0YURhdGEuQUNDRVNTX0ZJRUxEKSkNCiAgICAg\nICAgew0KICAgICAgICAgICAgYXNzZXJ0RmFsc2Uoc20uZ2V0TG9hZGVkKCkN\nCiAgICAgICAgICAgICAgICAuZ2V0KHNtLmdldE1ldGFEYXRhKCkuZ2V0Rmll\nbGQoImxhenlGaWVsZCIpLmdldEluZGV4KCkpKTsNCg0KICAgICAgICAgICAg\nLy8gbWFrZSBzdXJlIHRoYXQgdGhlIHZhbHVlIHdhcyBjbGVhcmVkDQogICAg\nICAgICAgICBGaWVsZCBmaWVsZCA9IGdldFVuZW5oYW5jZWRDbGFzcygpLmdl\ndERlY2xhcmVkRmllbGQoImxhenlGaWVsZCIpOw0KICAgICAgICAgICAgZmll\nbGQuc2V0QWNjZXNzaWJsZSh0cnVlKTsNCiAgICAgICAgICAgIGFzc2VydEVx\ndWFscyhudWxsLCBmaWVsZC5nZXQodW4pKTsNCiAgICAgICAgfSBlbHNlIHsN\nCiAgICAgICAgICAgIC8vIHVucmVkZWZpbmVkIGZpZWxkIGFjY2Vzcw0KICAg\nICAgICAgICAgYXNzZXJ0VHJ1ZShzbS5nZXRMb2FkZWQoKQ0KICAgICAgICAg\nICAgICAgIC5nZXQoc20uZ2V0TWV0YURhdGEoKS5nZXRGaWVsZCgibGF6eUZp\nZWxkIikuZ2V0SW5kZXgoKSkpOw0KDQogICAgICAgICAgICAvLyBtYWtlIHN1\ncmUgdGhhdCB0aGUgdmFsdWUgd2FzIGxvYWRlZCBhbHJlYWR5DQogICAgICAg\nICAgICBGaWVsZCBmaWVsZCA9IGdldFVuZW5oYW5jZWRDbGFzcygpLmdldERl\nY2xhcmVkRmllbGQoImxhenlGaWVsZCIpOw0KICAgICAgICAgICAgZmllbGQu\nc2V0QWNjZXNzaWJsZSh0cnVlKTsNCiAgICAgICAgICAgIGFzc2VydEVxdWFs\ncygibGF6eSIsIGZpZWxkLmdldCh1bikpOw0KICAgICAgICB9DQoNCiAgICAg\nICAgLy8gbWFrZSBzdXJlIHRoYXQgdGhlIHZhbHVlIGlzIGF2YWlsYWJsZSwg\nb25lIHdheSBvciBhbm90aGVyDQogICAgICAgIGFzc2VydEVxdWFscygibGF6\neSIsIHVuLmdldExhenlGaWVsZCgpKTsNCiAgICAgICAgYXNzZXJ0VHJ1ZShz\nbS5nZXRMb2FkZWQoKQ0KICAgICAgICAgICAgLmdldChzbS5nZXRNZXRhRGF0\nYSgpLmdldEZpZWxkKCJsYXp5RmllbGQiKS5nZXRJbmRleCgpKSk7DQoNCiAg\nICAgICAgZW0uY2xvc2UoKTsNCiAgICB9DQoNCiAgICBwdWJsaWMgdm9pZCB0\nZXN0U2VyaWFsaXphdGlvbk9mVXNlckRlZmluZWRJbnN0YW5jZSgpDQogICAg\nICAgIHRocm93cyBJT0V4Y2VwdGlvbiwgQ2xhc3NOb3RGb3VuZEV4Y2VwdGlv\nbiB7DQogICAgICAgIHNlcmlhbGl6YXRpb25IZWxwZXIodHJ1ZSwgZmFsc2Up\nOw0KICAgIH0NCg0KICAgIHB1YmxpYyB2b2lkIHRlc3RTZXJpYWxpemF0aW9u\nT2ZVc2VyRGVmaW5lZFN1YmNsYXNzSW5zdGFuY2UoKQ0KICAgICAgICB0aHJv\nd3MgSU9FeGNlcHRpb24sIENsYXNzTm90Rm91bmRFeGNlcHRpb24gew0KICAg\nICAgICBzZXJpYWxpemF0aW9uSGVscGVyKHRydWUsIHRydWUpOw0KICAgIH0N\nCg0KICAgIHB1YmxpYyB2b2lkIHRlc3RTZXJpYWxpemF0aW9uT2ZPcGVuSlBB\nRGVmaW5lZEluc3RhbmNlKCkNCiAgICAgICAgdGhyb3dzIElPRXhjZXB0aW9u\nLCBDbGFzc05vdEZvdW5kRXhjZXB0aW9uIHsNCiAgICAgICAgc2VyaWFsaXph\ndGlvbkhlbHBlcihmYWxzZSwgZmFsc2UpOw0KICAgIH0NCg0KICAgIHB1Ymxp\nYyB2b2lkIHRlc3RTZXJpYWxpemF0aW9uT2ZPcGVuSlBBRGVmaW5lZFN1YmNs\nYXNzSW5zdGFuY2UoKQ0KICAgICAgICB0aHJvd3MgSU9FeGNlcHRpb24sIENs\nYXNzTm90Rm91bmRFeGNlcHRpb24gew0KICAgICAgICBzZXJpYWxpemF0aW9u\nSGVscGVyKGZhbHNlLCB0cnVlKTsNCiAgICB9DQoNCiAgICBwcml2YXRlIHZv\naWQgc2VyaWFsaXphdGlvbkhlbHBlcihib29sZWFuIHVzZXJEZWZpbmVkLCBi\nb29sZWFuIHN1YikNCiAgICAgICAgdGhyb3dzIElPRXhjZXB0aW9uLCBDbGFz\nc05vdEZvdW5kRXhjZXB0aW9uIHsNCiAgICAgICAgT3BlbkpQQUVudGl0eU1h\nbmFnZXIgZW0gPSBlbWYuY3JlYXRlRW50aXR5TWFuYWdlcigpOw0KICAgICAg\nICBVbmVuaGFuY2VkVHlwZSB1biA9IG5ld0luc3RhbmNlKHN1Yik7DQogICAg\nICAgIGVtLmdldFRyYW5zYWN0aW9uKCkuYmVnaW4oKTsNCiAgICAgICAgZW0u\ncGVyc2lzdCh1bik7DQoNCiAgICAgICAgaWYgKHN1Yikgew0KICAgICAgICAg\nICAgVW5lbmhhbmNlZFR5cGUgcmVsYXRlZCA9IG5ld0luc3RhbmNlKGZhbHNl\nKTsNCiAgICAgICAgICAgIHJlbGF0ZWQuc2V0U3RyaW5nRmllbGQoInJlbGF0\nZWQiKTsNCiAgICAgICAgICAgICgoVW5lbmhhbmNlZFN1YnR5cGUpIHVuKS5z\nZXRSZWxhdGVkKHJlbGF0ZWQpOw0KICAgICAgICB9DQoNCiAgICAgICAgZW0u\nZ2V0VHJhbnNhY3Rpb24oKS5jb21taXQoKTsNCg0KICAgICAgICBpZiAoIXVz\nZXJEZWZpbmVkKSB7DQogICAgICAgICAgICBlbS5jbG9zZSgpOw0KICAgICAg\nICAgICAgZW0gPSBlbWYuY3JlYXRlRW50aXR5TWFuYWdlcigpOw0KICAgICAg\nICB9DQoNCiAgICAgICAgdW4gPSBlbS5maW5kKGdldFVuZW5oYW5jZWRDbGFz\ncygpLCB1bi5nZXRJZCgpKTsNCiAgICAgICAgQnl0ZUFycmF5T3V0cHV0U3Ry\nZWFtIG91dCA9IG5ldyBCeXRlQXJyYXlPdXRwdXRTdHJlYW0oKTsNCiAgICAg\nICAgT2JqZWN0T3V0cHV0U3RyZWFtIG9vdXQgPSBuZXcgT2JqZWN0T3V0cHV0\nU3RyZWFtKG91dCk7DQogICAgICAgIG9vdXQud3JpdGVPYmplY3QodW4pOw0K\nICAgICAgICBvb3V0LmZsdXNoKCk7DQogICAgICAgIGJ5dGVbXSBieXRlcyA9\nIG91dC50b0J5dGVBcnJheSgpOw0KDQogICAgICAgIE9iamVjdElucHV0U3Ry\nZWFtIG9pbiA9IG5ldyBPYmplY3RJbnB1dFN0cmVhbSgNCiAgICAgICAgICAg\nIG5ldyBCeXRlQXJyYXlJbnB1dFN0cmVhbShieXRlcykpOw0KICAgICAgICBV\nbmVuaGFuY2VkVHlwZSBkZXNlcmlhbGl6ZWQgPSAoVW5lbmhhbmNlZFR5cGUp\nIG9pbi5yZWFkT2JqZWN0KCk7DQoNCiAgICAgICAgY29waWVkSW5zdGFuY2VI\nZWxwZXIoc3ViLCBlbSwgdW4sIGRlc2VyaWFsaXplZCwgZmFsc2UpOw0KICAg\nICAgICBlbS5jbG9zZSgpOw0KICAgIH0NCg0KICAgIHB1YmxpYyB2b2lkIHRl\nc3RDbG9uaW5nT2ZVc2VyRGVmaW5lZEluc3RhbmNlKCkNCiAgICAgICAgdGhy\nb3dzIElPRXhjZXB0aW9uLCBDbGFzc05vdEZvdW5kRXhjZXB0aW9uLCBDbG9u\nZU5vdFN1cHBvcnRlZEV4Y2VwdGlvbiB7DQogICAgICAgIGNsb25lSGVscGVy\nKHRydWUsIGZhbHNlKTsNCiAgICB9DQoNCiAgICBwdWJsaWMgdm9pZCB0ZXN0\nQ2xvbmluZ09mVXNlckRlZmluZWRTdWJjbGFzc0luc3RhbmNlKCkNCiAgICAg\nICAgdGhyb3dzIElPRXhjZXB0aW9uLCBDbGFzc05vdEZvdW5kRXhjZXB0aW9u\nLCBDbG9uZU5vdFN1cHBvcnRlZEV4Y2VwdGlvbiB7DQogICAgICAgIGNsb25l\nSGVscGVyKHRydWUsIHRydWUpOw0KICAgIH0NCg0KICAgIHB1YmxpYyB2b2lk\nIHRlc3RDbG9uaW5nT2ZPcGVuSlBBRGVmaW5lZEluc3RhbmNlKCkNCiAgICAg\nICAgdGhyb3dzIElPRXhjZXB0aW9uLCBDbGFzc05vdEZvdW5kRXhjZXB0aW9u\nLCBDbG9uZU5vdFN1cHBvcnRlZEV4Y2VwdGlvbiB7DQogICAgICAgIGNsb25l\nSGVscGVyKGZhbHNlLCBmYWxzZSk7DQogICAgfQ0KDQogICAgcHVibGljIHZv\naWQgdGVzdENsb25pbmdPZk9wZW5KUEFEZWZpbmVkU3ViY2xhc3NJbnN0YW5j\nZSgpDQogICAgICAgIHRocm93cyBJT0V4Y2VwdGlvbiwgQ2xhc3NOb3RGb3Vu\nZEV4Y2VwdGlvbiwgQ2xvbmVOb3RTdXBwb3J0ZWRFeGNlcHRpb24gew0KICAg\nICAgICBjbG9uZUhlbHBlcihmYWxzZSwgdHJ1ZSk7DQogICAgfQ0KDQogICAg\ncHJpdmF0ZSB2b2lkIGNsb25lSGVscGVyKGJvb2xlYW4gdXNlckRlZmluZWQs\nIGJvb2xlYW4gc3ViKQ0KICAgICAgICB0aHJvd3MgSU9FeGNlcHRpb24sIENs\nYXNzTm90Rm91bmRFeGNlcHRpb24sIENsb25lTm90U3VwcG9ydGVkRXhjZXB0\naW9uIHsNCiAgICAgICAgT3BlbkpQQUVudGl0eU1hbmFnZXIgZW0gPSBlbWYu\nY3JlYXRlRW50aXR5TWFuYWdlcigpOw0KICAgICAgICBVbmVuaGFuY2VkVHlw\nZSB1biA9IG5ld0luc3RhbmNlKHN1Yik7DQogICAgICAgIGVtLmdldFRyYW5z\nYWN0aW9uKCkuYmVnaW4oKTsNCiAgICAgICAgZW0ucGVyc2lzdCh1bik7DQoN\nCiAgICAgICAgaWYgKHN1Yikgew0KICAgICAgICAgICAgVW5lbmhhbmNlZFR5\ncGUgcmVsYXRlZCA9IG5ld0luc3RhbmNlKGZhbHNlKTsNCiAgICAgICAgICAg\nIHJlbGF0ZWQuc2V0U3RyaW5nRmllbGQoInJlbGF0ZWQiKTsNCiAgICAgICAg\nICAgICgoVW5lbmhhbmNlZFN1YnR5cGUpIHVuKS5zZXRSZWxhdGVkKHJlbGF0\nZWQpOw0KICAgICAgICB9DQoNCiAgICAgICAgZW0uZ2V0VHJhbnNhY3Rpb24o\nKS5jb21taXQoKTsNCg0KICAgICAgICBpZiAoIXVzZXJEZWZpbmVkKSB7DQog\nICAgICAgICAgICBlbS5jbG9zZSgpOw0KICAgICAgICAgICAgZW0gPSBlbWYu\nY3JlYXRlRW50aXR5TWFuYWdlcigpOw0KICAgICAgICB9DQoNCiAgICAgICAg\ndW4gPSBlbS5maW5kKGdldFVuZW5oYW5jZWRDbGFzcygpLCB1bi5nZXRJZCgp\nKTsNCiAgICAgICAgVW5lbmhhbmNlZFR5cGUgY2xvbmVkID0gKFVuZW5oYW5j\nZWRUeXBlKSB1bi5jbG9uZSgpOw0KDQogICAgICAgIGNvcGllZEluc3RhbmNl\nSGVscGVyKHN1YiwgZW0sIHVuLCBjbG9uZWQsIHRydWUpOw0KICAgICAgICBl\nbS5jbG9zZSgpOw0KICAgIH0NCg0KICAgIHByaXZhdGUgdm9pZCBjb3BpZWRJ\nbnN0YW5jZUhlbHBlcihib29sZWFuIHN1YiwgT3BlbkpQQUVudGl0eU1hbmFn\nZXIgZW0sDQogICAgICAgIFVuZW5oYW5jZWRUeXBlIHVuLCBVbmVuaGFuY2Vk\nVHlwZSBjb3B5LCBib29sZWFuIHZpYUNsb25lKSB7DQogICAgICAgIGFzc2Vy\ndE5vdFNhbWUodW4sIGNvcHkpOw0KICAgICAgICBpZiAoIXZpYUNsb25lKQ0K\nICAgICAgICAgICAgYXNzZXJ0RXF1YWxzKHN1YiA/IGdldFVuZW5oYW5jZWRT\ndWJjbGFzcygpIDogZ2V0VW5lbmhhbmNlZENsYXNzKCksDQogICAgICAgICAg\nICAgICAgY29weS5nZXRDbGFzcygpKTsNCiAgICAgICAgYXNzZXJ0RXF1YWxz\nKHVuLmdldElkKCksIGNvcHkuZ2V0SWQoKSk7DQogICAgICAgIGFzc2VydEVx\ndWFscyh1bi5nZXRTdHJpbmdGaWVsZCgpLCBjb3B5LmdldFN0cmluZ0ZpZWxk\nKCkpOw0KICAgICAgICBpZiAoc3ViKSB7DQogICAgICAgICAgICBhc3NlcnRF\ncXVhbHMoDQogICAgICAgICAgICAgICAgKChVbmVuaGFuY2VkU3VidHlwZSkg\ndW4pLmdldEludEZpZWxkKCksDQogICAgICAgICAgICAgICAgKChVbmVuaGFu\nY2VkU3VidHlwZSkgY29weSkuZ2V0SW50RmllbGQoKSk7DQogICAgICAgICAg\nICBhc3NlcnROb3RTYW1lKA0KICAgICAgICAgICAgICAgICgoVW5lbmhhbmNl\nZFN1YnR5cGUpIHVuKS5nZXRSZWxhdGVkKCksDQogICAgICAgICAgICAgICAg\nKChVbmVuaGFuY2VkU3VidHlwZSkgY29weSkuZ2V0UmVsYXRlZCgpKTsNCiAg\nICAgICAgICAgIGFzc2VydEVxdWFscygNCiAgICAgICAgICAgICAgICAoKFVu\nZW5oYW5jZWRTdWJ0eXBlKSB1bikuZ2V0UmVsYXRlZCgpLmdldElkKCksDQog\nICAgICAgICAgICAgICAgKChVbmVuaGFuY2VkU3VidHlwZSkgY29weSkuZ2V0\nUmVsYXRlZCgpLmdldElkKCkpOw0KICAgICAgICB9DQoNCiAgICAgICAgYXNz\nZXJ0RmFsc2UoZW0uaXNEZXRhY2hlZCh1bikpOw0KICAgICAgICBhc3NlcnRU\ncnVlKGVtLmlzRGV0YWNoZWQoY29weSkpOw0KDQogICAgICAgIC8qDQogICAg\nICAgICMjIyMjIG5lZWQgdG8gbWFrZSBkZXRhY2htZW50IGFsZ29yaXRobSBp\nbiBSZWZsZWN0aW5nUEMgc21hcnRlcg0KICAgICAgICAvLyBlbnN1cmUgdGhh\ndCByZW1vdmUoKSBjYW5ub3QgYmUgaW52b2tlZCBvbiBhIGRldGFjaGVkIGlu\nc3RhbmNlDQogICAgICAgIHRyeSB7DQogICAgICAgICAgICBlbS5nZXRUcmFu\nc2FjdGlvbigpLmJlZ2luKCk7DQogICAgICAgICAgICBlbS5yZW1vdmUoY29w\neSk7DQogICAgICAgICAgICBmYWlsKCJyZW1vdmUoKSBjYW5ub3QgYmUgaW52\nb2tlZCBvbiBkZXRhY2hlZCBpbnN0YW5jZSIpOw0KICAgICAgICB9IGNhdGNo\nIChJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24gZSkgew0KICAgICAgICAgICAg\nZW0uZ2V0VHJhbnNhY3Rpb24oKS5yb2xsYmFjaygpOw0KICAgICAgICB9DQog\nICAgICAgICovDQoNCiAgICAgICAgY29weS5zZXRTdHJpbmdGaWVsZCgib2Zm\nbGluZSB1cGRhdGUiKTsNCg0KICAgICAgICBlbS5nZXRUcmFuc2FjdGlvbigp\nLmJlZ2luKCk7DQogICAgICAgIGFzc2VydFNhbWUodW4sIGVtLm1lcmdlKGNv\ncHkpKTsNCiAgICAgICAgYXNzZXJ0VHJ1ZShlbS5pc0RpcnR5KHVuKSk7DQog\nICAgICAgIGFzc2VydEVxdWFscygib2ZmbGluZSB1cGRhdGUiLCB1bi5nZXRT\ndHJpbmdGaWVsZCgpKTsNCiAgICAgICAgZW0uZ2V0VHJhbnNhY3Rpb24oKS5j\nb21taXQoKTsNCiAgICB9DQoNCiAgICBwdWJsaWMgdm9pZCB0ZXN0TGlzdGVu\nZXJzT25Vc2VyRGVmaW5lZEluc3RhbmNlKCkNCiAgICAgICAgdGhyb3dzIElP\nRXhjZXB0aW9uLCBDbGFzc05vdEZvdW5kRXhjZXB0aW9uLCBDbG9uZU5vdFN1\ncHBvcnRlZEV4Y2VwdGlvbiB7DQogICAgICAgIGxpc3RlbmVySGVscGVyKHRy\ndWUsIGZhbHNlKTsNCiAgICB9DQoNCiAgICBwdWJsaWMgdm9pZCB0ZXN0TGlz\ndGVuZXJzT25Vc2VyRGVmaW5lZFN1YmNsYXNzSW5zdGFuY2UoKQ0KICAgICAg\nICB0aHJvd3MgSU9FeGNlcHRpb24sIENsYXNzTm90Rm91bmRFeGNlcHRpb24s\nIENsb25lTm90U3VwcG9ydGVkRXhjZXB0aW9uIHsNCiAgICAgICAgbGlzdGVu\nZXJIZWxwZXIodHJ1ZSwgdHJ1ZSk7DQogICAgfQ0KDQogICAgcHVibGljIHZv\naWQgdGVzdExpc3RlbmVyc09uT3BlbkpQQURlZmluZWRJbnN0YW5jZSgpDQog\nICAgICAgIHRocm93cyBJT0V4Y2VwdGlvbiwgQ2xhc3NOb3RGb3VuZEV4Y2Vw\ndGlvbiwgQ2xvbmVOb3RTdXBwb3J0ZWRFeGNlcHRpb24gew0KICAgICAgICBs\naXN0ZW5lckhlbHBlcihmYWxzZSwgZmFsc2UpOw0KICAgIH0NCg0KICAgIHB1\nYmxpYyB2b2lkIHRlc3RMaXN0ZW5lcnNPbk9wZW5KUEFEZWZpbmVkU3ViY2xh\nc3NJbnN0YW5jZSgpDQogICAgICAgIHRocm93cyBJT0V4Y2VwdGlvbiwgQ2xh\nc3NOb3RGb3VuZEV4Y2VwdGlvbiwgQ2xvbmVOb3RTdXBwb3J0ZWRFeGNlcHRp\nb24gew0KICAgICAgICBsaXN0ZW5lckhlbHBlcihmYWxzZSwgdHJ1ZSk7DQog\nICAgfQ0KDQogICAgcHJpdmF0ZSB2b2lkIGxpc3RlbmVySGVscGVyKGJvb2xl\nYW4gdXNlckRlZmluZWQsIGJvb2xlYW4gc3ViKQ0KICAgICAgICB0aHJvd3Mg\nSU9FeGNlcHRpb24sIENsYXNzTm90Rm91bmRFeGNlcHRpb24sIENsb25lTm90\nU3VwcG9ydGVkRXhjZXB0aW9uIHsNCiAgICAgICAgTGlzdGVuZXJJbXBsIGxp\nc3RlbmVyID0gbmV3IExpc3RlbmVySW1wbCgpOw0KICAgICAgICBlbWYuYWRk\nTGlmZWN5Y2xlTGlzdGVuZXIobGlzdGVuZXIsIChDbGFzc1tdKSBudWxsKTsN\nCiAgICAgICAgT3BlbkpQQUVudGl0eU1hbmFnZXIgZW0gPSBlbWYuY3JlYXRl\nRW50aXR5TWFuYWdlcigpOw0KICAgICAgICBVbmVuaGFuY2VkVHlwZSB1biA9\nIG5ld0luc3RhbmNlKHN1Yik7DQogICAgICAgIGVtLmdldFRyYW5zYWN0aW9u\nKCkuYmVnaW4oKTsNCiAgICAgICAgZW0ucGVyc2lzdCh1bik7DQogICAgICAg\nIGVtLmdldFRyYW5zYWN0aW9uKCkuY29tbWl0KCk7DQoNCiAgICAgICAgaWYg\nKCF1c2VyRGVmaW5lZCkgew0KICAgICAgICAgICAgZW0uY2xvc2UoKTsNCiAg\nICAgICAgICAgIGVtID0gZW1mLmNyZWF0ZUVudGl0eU1hbmFnZXIoKTsNCiAg\nICAgICAgfQ0KDQogICAgICAgIGxpc3RlbmVyLmludm9rZWQgPSBmYWxzZTsN\nCg0KICAgICAgICB1biA9IGVtLmZpbmQoZ2V0VW5lbmhhbmNlZENsYXNzKCks\nIHVuLmdldElkKCkpOw0KICAgICAgICBlbS5nZXRUcmFuc2FjdGlvbigpLmJl\nZ2luKCk7DQogICAgICAgIHVuLnNldFN0cmluZ0ZpZWxkKCJ1cGRhdGVkIik7\nDQogICAgICAgIGVtLmdldFRyYW5zYWN0aW9uKCkuY29tbWl0KCk7DQogICAg\nICAgIGFzc2VydFRydWUobGlzdGVuZXIuaW52b2tlZCk7DQogICAgICAgIGVt\nLmNsb3NlKCk7DQoNCiAgICAgICAgYXNzZXJ0RXF1YWxzKCJ1cGRhdGVkIiwg\nbGlzdGVuZXIuc3RyaW5nRmllbGQpOw0KICAgIH0NCg0KICAgIHB1YmxpYyB2\nb2lkIHRlc3RHZXRNZXRhRGF0YU9mU3VidHlwZSgpIHsNCiAgICAgICAgQ2xh\nc3NNZXRhRGF0YSBtZXRhID0gSlBBRmFjYWRlSGVscGVyLmdldE1ldGFEYXRh\nKGVtZiwNCiAgICAgICAgICAgIGdldFVuZW5oYW5jZWRDbGFzcygpKTsNCiAg\nICAgICAgTGlzdDxDbGFzcz4gc3VicyA9ICBNYW5hZ2VkQ2xhc3NTdWJjbGFz\nc2VyLnByZXBhcmVVbmVuaGFuY2VkQ2xhc3NlcygNCiAgICAgICAgICAgIGVt\nZi5nZXRDb25maWd1cmF0aW9uKCksDQogICAgICAgICAgICBDb2xsZWN0aW9u\ncy5zaW5nbGV0b24oZ2V0VW5lbmhhbmNlZENsYXNzKCkpLCBudWxsKTsNCiAg\nICAgICAgYXNzZXJ0U2FtZShtZXRhLCBKUEFGYWNhZGVIZWxwZXIuZ2V0TWV0\nYURhdGEoZW1mLCBzdWJzLmdldCgwKSkpOw0KDQogICAgICAgIG1ldGEgPSBK\nUEFGYWNhZGVIZWxwZXIuZ2V0TWV0YURhdGEoZW1mLCBnZXRVbmVuaGFuY2Vk\nU3ViY2xhc3MoKSk7DQogICAgICAgIHN1YnMgPSAgTWFuYWdlZENsYXNzU3Vi\nY2xhc3Nlci5wcmVwYXJlVW5lbmhhbmNlZENsYXNzZXMoDQogICAgICAgICAg\nICBlbWYuZ2V0Q29uZmlndXJhdGlvbigpLA0KICAgICAgICAgICAgQ29sbGVj\ndGlvbnMuc2luZ2xldG9uKGdldFVuZW5oYW5jZWRTdWJjbGFzcygpKSwgbnVs\nbCk7DQogICAgICAgIGFzc2VydFNhbWUobWV0YSwgSlBBRmFjYWRlSGVscGVy\nLmdldE1ldGFEYXRhKGVtZiwgc3Vicy5nZXQoMCkpKTsNCiAgICB9DQoNCiAg\nICBwcml2YXRlIGNsYXNzIExpc3RlbmVySW1wbA0KICAgICAgICBleHRlbmRz\nIEFic3RyYWN0TGlmZWN5Y2xlTGlzdGVuZXIgew0KDQogICAgICAgIFN0cmlu\nZyBzdHJpbmdGaWVsZDsNCiAgICAgICAgYm9vbGVhbiBpbnZva2VkOw0KDQog\nICAgICAgIEBPdmVycmlkZQ0KICAgICAgICBwdWJsaWMgdm9pZCBhZnRlclN0\nb3JlKExpZmVjeWNsZUV2ZW50IGV2ZW50KSB7DQogICAgICAgICAgICBpbnZv\na2VkID0gdHJ1ZTsNCiAgICAgICAgICAgIHN0cmluZ0ZpZWxkID0gKChVbmVu\naGFuY2VkVHlwZSkgZXZlbnQuZ2V0U291cmNlKCkpLmdldFN0cmluZ0ZpZWxk\nKCk7DQogICAgICAgIH0NCiAgICB9DQp9\n","encoding":"base64"}

