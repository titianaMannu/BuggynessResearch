{"sha":"7d8d44b02ae7ac654b5ab2ec197c5f3d6489d793","node_id":"MDQ6QmxvYjIwNjM2NDo3ZDhkNDRiMDJhZTdhYzY1NGI1YWIyZWMxOTdjNWYzZDY0ODlkNzkz","size":15569,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/7d8d44b02ae7ac654b5ab2ec197c5f3d6489d793","content":"LyoNCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUNCiAqIG9yIG1vcmUgY29udHJpYnV0b3Ig\nbGljZW5zZSBhZ3JlZW1lbnRzLiAgU2VlIHRoZSBOT1RJQ0UgZmlsZQ0KICog\nZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5m\nb3JtYXRpb24NCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAg\nVGhlIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUNCiAqIHRvIHlvdSB1bmRlciB0\naGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUNCiAqICJMaWNl\nbnNlIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNv\nbXBsaWFuY2UNCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFp\nbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQNCiAqDQogKiBodHRwOi8vd3d3\nLmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjANCiAqDQogKiBVbmxl\nc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGlu\nIHdyaXRpbmcsDQogKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUg\nTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbg0KICogIkFTIElTIiBCQVNJ\nUywgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZDQog\nKiBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBM\naWNlbnNlIGZvciB0aGUNCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmlu\nZyBwZXJtaXNzaW9ucyBhbmQgbGltaXRhdGlvbnMNCiAqIHVuZGVyIHRoZSBM\naWNlbnNlLg0KICovDQpwYWNrYWdlIG9yZy5hcGFjaGUub3BlbmpwYS5rZXJu\nZWw7DQoNCmltcG9ydCBqYXZhLmlvLkJ5dGVBcnJheUlucHV0U3RyZWFtOw0K\naW1wb3J0IGphdmEuaW8uQnl0ZUFycmF5T3V0cHV0U3RyZWFtOw0KaW1wb3J0\nIGphdmEuaW8uSU9FeGNlcHRpb247DQppbXBvcnQgamF2YS5pby5PYmplY3RJ\nbnB1dFN0cmVhbTsNCmltcG9ydCBqYXZhLmlvLk9iamVjdE91dHB1dFN0cmVh\nbTsNCmltcG9ydCBqYXZhLmlvLlNlcmlhbGl6YWJsZTsNCmltcG9ydCBqYXZh\nLnV0aWwuSGFzaE1hcDsNCmltcG9ydCBqYXZhLnV0aWwuTWFwOw0KaW1wb3J0\nIGphdmF4LnBlcnNpc3RlbmNlLkVudGl0eU1hbmFnZXI7DQoNCmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEuZXZlbnQuQWJzdHJhY3RMaWZlY3ljbGVMaXN0\nZW5lcjsNCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuZXZlbnQuQWJzdHJh\nY3RUcmFuc2FjdGlvbkxpc3RlbmVyOw0KaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5ldmVudC5MaWZlY3ljbGVFdmVudDsNCmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEuZXZlbnQuVHJhbnNhY3Rpb25FdmVudDsNCmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuSW52YWxpZFN0YXRlRXhjZXB0\naW9uOw0KaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5K\nUEFGYWNhZGVIZWxwZXI7DQppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnBl\ncnNpc3RlbmNlLk9wZW5KUEFFbnRpdHlNYW5hZ2VyOw0KaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5PcGVuSlBBRW50aXR5TWFuYWdl\nckZhY3Rvcnk7DQppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNpc3Rl\nbmNlLmpkYmMuSkRCQ0ZldGNoUGxhbjsNCmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEucGVyc2lzdGVuY2UuamRiYy5Kb2luU3ludGF4Ow0KaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS50ZXN0LlNpbmdsZUVNRlRl\nc3RDYXNlOw0KDQovKg0KICogVG8gdGVzdDoNCiAqICAtIG1hbmFnZWQgdHJh\nbnNhY3Rpb25zDQogKiAgLSBjb252ZXJ0aW5nIG5vbi1lbmhhbmNlZCBjbGFz\nc2VzIHRvIGVuaGFuY2VkIHN1YmNsYXNzZXMNCiAqICAgIChtYXliZSBhbiB1\nZ2x5IFRocmVhZExvY2FsLCBtYXliZSB0aHJvdWdoIFBDRGF0YT8pDQogKi8N\nCnB1YmxpYyBhYnN0cmFjdCBjbGFzcyBBYnN0cmFjdEJyb2tlclNlcmlhbGl6\nYXRpb25UZXN0PFQ+DQogICAgZXh0ZW5kcyBTaW5nbGVFTUZUZXN0Q2FzZSB7\nDQoNCiAgICBwcml2YXRlIHN0YXRpYyBMaWZlTGlzdGVuZXIgZGVzZXJpYWxp\nemVkTGlmZUxpc3RlbmVyOw0KICAgIHByaXZhdGUgc3RhdGljIGludCB0ZXN0\nR2xvYmFsUmVmcmVzaENvdW50ID0gMDsNCg0KICAgIHByaXZhdGUgc3RhdGlj\nIFR4TGlzdGVuZXIgZGVzZXJpYWxpemVkVHhMaXN0ZW5lcjsNCiAgICBwcml2\nYXRlIHN0YXRpYyBpbnQgdGVzdEdsb2JhbEJlZ2luQ291bnQgPSAwOw0KDQoN\nCiAgICBwcml2YXRlIE9iamVjdCBpZDsNCg0KICAgIHB1YmxpYyB2b2lkIHNl\ndFVwKCkgew0KICAgICAgICB0ZXN0R2xvYmFsUmVmcmVzaENvdW50ID0gMDsN\nCiAgICAgICAgZGVzZXJpYWxpemVkTGlmZUxpc3RlbmVyID0gbnVsbDsNCiAg\nICAgICAgdGVzdEdsb2JhbEJlZ2luQ291bnQgPSAwOw0KICAgICAgICBkZXNl\ncmlhbGl6ZWRUeExpc3RlbmVyID0gbnVsbDsNCg0KICAgICAgICBzZXRVcChn\nZXRNYW5hZ2VkVHlwZSgpLCBnZXRTZWNvbmRhcnlUeXBlKCksIENMRUFSX1RB\nQkxFUywNCiAgICAgICAgICAgICJvcGVuanBhLkVudGl0eU1hbmFnZXJGYWN0\nb3J5UG9vbCIsICJ0cnVlIik7DQogICAgICAgIA0KICAgICAgICBUIGUgPSBu\nZXdNYW5hZ2VkSW5zdGFuY2UoKTsNCiAgICAgICAgT3BlbkpQQUVudGl0eU1h\nbmFnZXIgZW0gPSBlbWYuY3JlYXRlRW50aXR5TWFuYWdlcigpOw0KICAgICAg\nICBlbS5nZXRUcmFuc2FjdGlvbigpLmJlZ2luKCk7DQogICAgICAgIGVtLnBl\ncnNpc3QoZSk7DQogICAgICAgIGVtLmdldFRyYW5zYWN0aW9uKCkuY29tbWl0\nKCk7DQogICAgICAgIGlkID0gZW0uZ2V0T2JqZWN0SWQoZSk7DQogICAgICAg\nIGVtLmNsb3NlKCk7DQogICAgfQ0KDQogICAgQE92ZXJyaWRlDQogICAgcHVi\nbGljIHZvaWQgdGVhckRvd24oKSB0aHJvd3MgRXhjZXB0aW9uIHsNCiAgICAg\nICAgc3VwZXIudGVhckRvd24oKTsNCiAgICAgICAgdGVzdEdsb2JhbFJlZnJl\nc2hDb3VudCA9IDA7DQogICAgICAgIGRlc2VyaWFsaXplZExpZmVMaXN0ZW5l\nciA9IG51bGw7DQogICAgICAgIHRlc3RHbG9iYWxCZWdpbkNvdW50ID0gMDsN\nCiAgICAgICAgZGVzZXJpYWxpemVkVHhMaXN0ZW5lciA9IG51bGw7DQogICAg\nfQ0KDQogICAgcHVibGljIHZvaWQgdGVzdEVtcHR5QnJva2VyU2VyaWFsaXph\ndGlvbigpIHsNCiAgICAgICAgT3BlbkpQQUVudGl0eU1hbmFnZXIgZW0gPSBl\nbWYuY3JlYXRlRW50aXR5TWFuYWdlcigpOw0KICAgICAgICBPcGVuSlBBRW50\naXR5TWFuYWdlciBlbTIgPSBkZXNlcmlhbGl6ZUVNKHNlcmlhbGl6ZShlbSkp\nOw0KDQogICAgICAgIGFzc2VydFRydWUoZW0gIT0gZW0yKTsNCiAgICAgICAg\nYXNzZXJ0VHJ1ZSgNCiAgICAgICAgICAgIEpQQUZhY2FkZUhlbHBlci50b0Jy\nb2tlcihlbSkgIT0gSlBBRmFjYWRlSGVscGVyLnRvQnJva2VyKGVtMikpOw0K\nICAgICAgICBhc3NlcnRTYW1lKGVtLmdldEVudGl0eU1hbmFnZXJGYWN0b3J5\nKCksIGVtMi5nZXRFbnRpdHlNYW5hZ2VyRmFjdG9yeSgpKTsNCg0KICAgICAg\nICBhc3NlcnRTYW1lKGVtMiwgSlBBRmFjYWRlSGVscGVyLnRvQnJva2VyKGVt\nMikNCiAgICAgICAgICAgIC5nZXRVc2VyT2JqZWN0KEpQQUZhY2FkZUhlbHBl\nci5FTV9LRVkpKTsNCg0KICAgICAgICBlbS5jbG9zZSgpOw0KICAgICAgICBh\nc3NlcnRUcnVlKGVtMi5pc09wZW4oKSk7DQogICAgICAgIGVtMi5jbG9zZSgp\nOw0KICAgIH0NCg0KICAgIHB1YmxpYyB2b2lkIHRlc3ROb250cmFuc2FjdGlv\nbmFsQnJva2VyU2VyaWFsaXphdGlvbigpIHsNCiAgICAgICAgT3BlbkpQQUVu\ndGl0eU1hbmFnZXIgZW0gPSBlbWYuY3JlYXRlRW50aXR5TWFuYWdlcigpOw0K\nICAgICAgICBUIGUgPSBlbS5maW5kKGdldE1hbmFnZWRUeXBlKCksIGlkKTsN\nCiAgICAgICAgT3BlbkpQQUVudGl0eU1hbmFnZXIgZW0yID0gZGVzZXJpYWxp\nemVFTShzZXJpYWxpemUoZW0pKTsNCg0KICAgICAgICBhc3NlcnRGYWxzZShl\nbTIuZ2V0VHJhbnNhY3Rpb24oKS5pc0FjdGl2ZSgpKTsNCg0KICAgICAgICBh\nc3NlcnRGYWxzZShlbTIuY29udGFpbnMoZSkpOw0KICAgICAgICBhc3NlcnRF\ncXVhbHMoMSpncmFwaFNpemUoKSwgZW0yLmdldE1hbmFnZWRPYmplY3RzKCku\nc2l6ZSgpKTsNCiAgICAgICAgVCBlMiA9IGVtMi5maW5kKGdldE1hbmFnZWRU\neXBlKCksIGlkKTsNCiAgICAgICAgYXNzZXJ0RXF1YWxzKGVtLmdldE9iamVj\ndElkKGUpLCBlbTIuZ2V0T2JqZWN0SWQoZTIpKTsNCg0KICAgICAgICBlbS5j\nbG9zZSgpOw0KICAgICAgICBlbTIuY2xvc2UoKTsNCiAgICB9DQoNCiAgICBw\ndWJsaWMgdm9pZCB0ZXN0VW5mbHVzaGVkT3B0aW1pc3RpY1R4QnJva2VyU2Vy\naWFsaXphdGlvbigpIHsNCiAgICAgICAgT3BlbkpQQUVudGl0eU1hbmFnZXIg\nZW0gPSBlbWYuY3JlYXRlRW50aXR5TWFuYWdlcigpOw0KICAgICAgICBUIGUg\nPSBlbS5maW5kKGdldE1hbmFnZWRUeXBlKCksIGlkKTsNCiAgICAgICAgT3Bl\nbkpQQUVudGl0eU1hbmFnZXIgZW0yID0gbnVsbDsNCiAgICAgICAgT3BlbkpQ\nQUVudGl0eU1hbmFnZXIgZW0zID0gbnVsbDsNCiAgICAgICAgdHJ5IHsNCiAg\nICAgICAgICAgIGVtLmdldFRyYW5zYWN0aW9uKCkuYmVnaW4oKTsNCiAgICAg\nICAgICAgIG1vZGlmeUluc3RhbmNlKGUpOw0KICAgICAgICAgICAgVCBuZXdl\nID0gbmV3TWFuYWdlZEluc3RhbmNlKCk7DQogICAgICAgICAgICBlbS5wZXJz\naXN0KG5ld2UpOw0KICAgICAgICAgICAgZW0yID0gZGVzZXJpYWxpemVFTShz\nZXJpYWxpemUoZW0pKTsNCg0KICAgICAgICAgICAgYXNzZXJ0VHJ1ZShlbTIu\nZ2V0VHJhbnNhY3Rpb24oKS5pc0FjdGl2ZSgpKTsNCg0KICAgICAgICAgICAg\nYXNzZXJ0RmFsc2UoZW0yLmNvbnRhaW5zKGUpKTsNCiAgICAgICAgICAgIFQg\nZTIgPSBlbTIuZmluZChnZXRNYW5hZ2VkVHlwZSgpLCBpZCk7DQogICAgICAg\nICAgICBhc3NlcnRFcXVhbHMoZW0uZ2V0T2JqZWN0SWQoZSksIGVtMi5nZXRP\nYmplY3RJZChlMikpOw0KDQogICAgICAgICAgICBhc3NlcnRFcXVhbHMoIm1v\nZGlmaWVkIiwgZ2V0TW9kaWZpZWRWYWx1ZShlMikpOw0KDQogICAgICAgICAg\nICBlbS5nZXRUcmFuc2FjdGlvbigpLnJvbGxiYWNrKCk7DQogICAgICAgICAg\nICBhc3NlcnRUcnVlKGVtMi5nZXRUcmFuc2FjdGlvbigpLmlzQWN0aXZlKCkp\nOw0KICAgICAgICAgICAgZW0yLmdldFRyYW5zYWN0aW9uKCkuY29tbWl0KCk7\nDQoNCiAgICAgICAgICAgIGVtMyA9IGVtZi5jcmVhdGVFbnRpdHlNYW5hZ2Vy\nKCk7DQogICAgICAgICAgICBUIGUzID0gZW0zLmZpbmQoZ2V0TWFuYWdlZFR5\ncGUoKSwgaWQpOw0KICAgICAgICAgICAgYXNzZXJ0RXF1YWxzKGdldE1vZGlm\naWVkVmFsdWUoZTIpLCBnZXRNb2RpZmllZFZhbHVlKGUzKSk7DQogICAgICAg\nICAgICBhc3NlcnRUcnVlKDEgPCAoKE51bWJlcikgZW0zLmNyZWF0ZVF1ZXJ5\nKCJzZWxlY3QgY291bnQobykgZnJvbSAiDQogICAgICAgICAgICAgICAgKyBn\nZXRNYW5hZ2VkVHlwZSgpLmdldE5hbWUoKSArICIgbyIpLmdldFNpbmdsZVJl\nc3VsdCgpKQ0KICAgICAgICAgICAgICAgIC5pbnRWYWx1ZSgpKTsNCiAgICAg\nICAgfSBmaW5hbGx5IHsNCiAgICAgICAgICAgIGNsb3NlKGVtKTsNCiAgICAg\nICAgICAgIGNsb3NlKGVtMik7DQogICAgICAgICAgICBjbG9zZShlbTMpOw0K\nICAgICAgICB9DQogICAgfQ0KDQogICAgcHVibGljIHZvaWQgdGVzdEZsdXNo\nZWRPcHRpbWlzdGljVHhCcm9rZXJTZXJpYWxpemF0aW9uKCkgew0KICAgICAg\nICBPcGVuSlBBRW50aXR5TWFuYWdlciBlbSA9IGVtZi5jcmVhdGVFbnRpdHlN\nYW5hZ2VyKCk7DQogICAgICAgIFQgZSA9IGVtLmZpbmQoZ2V0TWFuYWdlZFR5\ncGUoKSwgaWQpOw0KICAgICAgICBlbS5nZXRUcmFuc2FjdGlvbigpLmJlZ2lu\nKCk7DQogICAgICAgIG1vZGlmeUluc3RhbmNlKGUpOw0KICAgICAgICBlbS5m\nbHVzaCgpOw0KICAgICAgICB0cnkgew0KICAgICAgICAgICAgc2VyaWFsaXpl\nKGVtKTsNCiAgICAgICAgfSBjYXRjaCAoSW52YWxpZFN0YXRlRXhjZXB0aW9u\nIGlzZSkgew0KICAgICAgICAgICAgLy8gZXhwZWN0ZWQNCiAgICAgICAgICAg\nIGFzc2VydFRydWUoaXNlLmdldE1lc3NhZ2UoKS5jb250YWlucygiZmx1c2hl\nZCIpKTsNCiAgICAgICAgfSBmaW5hbGx5IHsNCiAgICAgICAgICAgIGVtLmdl\ndFRyYW5zYWN0aW9uKCkucm9sbGJhY2soKTsNCiAgICAgICAgICAgIGVtLmNs\nb3NlKCk7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICBwdWJsaWMgdm9pZCB0\nZXN0Q29ubmVjdGVkT3B0aW1pc3RpY1R4QnJva2VyU2VyaWFsaXphdGlvbigp\nIHsNCiAgICAgICAgTWFwIG0gPSBuZXcgSGFzaE1hcCgpOw0KICAgICAgICBt\nLnB1dCgib3BlbmpwYS5Db25uZWN0aW9uUmV0YWluTW9kZSIsICJhbHdheXMi\nKTsNCiAgICAgICAgT3BlbkpQQUVudGl0eU1hbmFnZXIgZW0gPSBlbWYuY3Jl\nYXRlRW50aXR5TWFuYWdlcihtKTsNCiAgICAgICAgdHJ5IHsNCiAgICAgICAg\nICAgIHNlcmlhbGl6ZShlbSk7DQogICAgICAgIH0gY2F0Y2ggKEludmFsaWRT\ndGF0ZUV4Y2VwdGlvbiBpc2UpIHsNCiAgICAgICAgICAgIC8vIGV4cGVjdGVk\nDQogICAgICAgICAgICBhc3NlcnRUcnVlKGlzZS5nZXRNZXNzYWdlKCkuY29u\ndGFpbnMoImNvbm5lY3RlZCIpKTsNCiAgICAgICAgfSBmaW5hbGx5IHsNCiAg\nICAgICAgICAgIGVtLmNsb3NlKCk7DQogICAgICAgIH0NCiAgICB9DQoNCiAg\nICBwdWJsaWMgdm9pZCB0ZXN0RW1wdHlQZXNzaW1pc3RpY1R4QnJva2VyU2Vy\naWFsaXphdGlvbigpIHsNCiAgICAgICAgTWFwIG0gPSBuZXcgSGFzaE1hcCgp\nOw0KICAgICAgICBtLnB1dCgib3BlbmpwYS5PcHRpbWlzdGljIiwgImZhbHNl\nIik7DQogICAgICAgIE9wZW5KUEFFbnRpdHlNYW5hZ2VyIGVtID0gZW1mLmNy\nZWF0ZUVudGl0eU1hbmFnZXIobSk7DQogICAgICAgIGVtLmdldFRyYW5zYWN0\naW9uKCkuYmVnaW4oKTsNCiAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgIHNl\ncmlhbGl6ZShlbSk7DQogICAgICAgICAgICBmYWlsKCJzaG91bGQgbm90IGJl\nIGFibGUgdG8gc2VyaWFsaXplIik7DQogICAgICAgIH0gY2F0Y2ggKEludmFs\naWRTdGF0ZUV4Y2VwdGlvbiBpc2UpIHsNCiAgICAgICAgICAgIC8vIGV4cGVj\ndGVkDQogICAgICAgICAgICBhc3NlcnRUcnVlKGlzZS5nZXRNZXNzYWdlKCku\nY29udGFpbnMoImRhdGFzdG9yZSAocGVzc2ltaXN0aWMpIikpOw0KICAgICAg\nICB9IGZpbmFsbHkgew0KICAgICAgICAgICAgZW0uZ2V0VHJhbnNhY3Rpb24o\nKS5yb2xsYmFjaygpOw0KICAgICAgICAgICAgZW0uY2xvc2UoKTsNCiAgICAg\nICAgfQ0KICAgIH0NCg0KICAgIHB1YmxpYyB2b2lkIHRlc3ROb25FbXB0eVBl\nc3NpbWlzdGljVHhCcm9rZXJTZXJpYWxpemF0aW9uKCkgew0KICAgICAgICBN\nYXAgbSA9IG5ldyBIYXNoTWFwKCk7DQogICAgICAgIG0ucHV0KCJvcGVuanBh\nLk9wdGltaXN0aWMiLCAiZmFsc2UiKTsNCiAgICAgICAgT3BlbkpQQUVudGl0\neU1hbmFnZXIgZW0gPSBlbWYuY3JlYXRlRW50aXR5TWFuYWdlcihtKTsNCiAg\nICAgICAgVCBlID0gZW0uZmluZChnZXRNYW5hZ2VkVHlwZSgpLCBpZCk7DQog\nICAgICAgIGVtLmdldFRyYW5zYWN0aW9uKCkuYmVnaW4oKTsNCiAgICAgICAg\ndHJ5IHsNCiAgICAgICAgICAgIHNlcmlhbGl6ZShlbSk7DQogICAgICAgICAg\nICBmYWlsKCJzaG91bGQgbm90IGJlIGFibGUgdG8gc2VyaWFsaXplIik7DQog\nICAgICAgIH0gY2F0Y2ggKEludmFsaWRTdGF0ZUV4Y2VwdGlvbiBpc2UpIHsN\nCiAgICAgICAgICAgIC8vIGV4cGVjdGVkDQogICAgICAgICAgICBhc3NlcnRU\ncnVlKGlzZS5nZXRNZXNzYWdlKCkuY29udGFpbnMoImRhdGFzdG9yZSAocGVz\nc2ltaXN0aWMpIikpOw0KICAgICAgICB9IGZpbmFsbHkgew0KICAgICAgICAg\nICAgZW0uZ2V0VHJhbnNhY3Rpb24oKS5yb2xsYmFjaygpOw0KICAgICAgICAg\nICAgZW0uY2xvc2UoKTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIHB1Ymxp\nYyB2b2lkIHRlc3RGZXRjaENvbmZpZ3VyYXRpb25NdXRhdGlvbnMoKSB7DQog\nICAgICAgIE9wZW5KUEFFbnRpdHlNYW5hZ2VyIGVtID0gZW1mLmNyZWF0ZUVu\ndGl0eU1hbmFnZXIoKTsNCiAgICAgICAgSkRCQ0ZldGNoUGxhbiBwbGFuID0g\nKEpEQkNGZXRjaFBsYW4pIGVtLmdldEZldGNoUGxhbigpOw0KDQogICAgICAg\nIGFzc2VydE5vdEVxdWFscygxNywgcGxhbi5nZXRMb2NrVGltZW91dCgpKTsN\nCiAgICAgICAgYXNzZXJ0Tm90RXF1YWxzKEpvaW5TeW50YXguVFJBRElUSU9O\nQUwsIHBsYW4uZ2V0Sm9pblN5bnRheCgpKTsNCg0KICAgICAgICBwbGFuLnNl\ndExvY2tUaW1lb3V0KDE3KTsNCiAgICAgICAgcGxhbi5zZXRKb2luU3ludGF4\nKEpvaW5TeW50YXguVFJBRElUSU9OQUwpOw0KDQogICAgICAgIE9wZW5KUEFF\nbnRpdHlNYW5hZ2VyIGVtMiA9IGRlc2VyaWFsaXplRU0oc2VyaWFsaXplKGVt\nKSk7DQogICAgICAgIEpEQkNGZXRjaFBsYW4gcGxhbjIgPSAoSkRCQ0ZldGNo\nUGxhbikgZW0yLmdldEZldGNoUGxhbigpOw0KICAgICAgICBhc3NlcnRFcXVh\nbHMoMTcsIHBsYW4yLmdldExvY2tUaW1lb3V0KCkpOw0KICAgICAgICBhc3Nl\ncnRFcXVhbHMoSm9pblN5bnRheC5UUkFESVRJT05BTCwgcGxhbjIuZ2V0Sm9p\nblN5bnRheCgpKTsNCiAgICB9DQoNCiAgICBwdWJsaWMgdm9pZCB0ZXN0SW5N\nZW1vcnlTYXZlcG9pbnRzV2l0aE5ld0luc3RhbmNlcygpIHsNCiAgICAgICAg\nZW1mLmNsb3NlKCk7DQogICAgICAgIE9wZW5KUEFFbnRpdHlNYW5hZ2VyRmFj\ndG9yeSBlbWYgPSBjcmVhdGVFTUYoDQogICAgICAgICAgICBnZXRNYW5hZ2Vk\nVHlwZSgpLCBnZXRTZWNvbmRhcnlUeXBlKCksDQogICAgICAgICAgICAib3Bl\nbmpwYS5FbnRpdHlNYW5hZ2VyRmFjdG9yeVBvb2wiLCAidHJ1ZSIsDQogICAg\nICAgICAgICAib3BlbmpwYS5TYXZlcG9pbnRNYW5hZ2VyIiwgImluLW1lbSIp\nOw0KICAgICAgICBPcGVuSlBBRW50aXR5TWFuYWdlciBlbSA9IGVtZi5jcmVh\ndGVFbnRpdHlNYW5hZ2VyKCk7DQogICAgICAgIE9wZW5KUEFFbnRpdHlNYW5h\nZ2VyIGVtMiA9IG51bGw7DQogICAgICAgIHRyeSB7DQogICAgICAgICAgICBl\nbS5nZXRUcmFuc2FjdGlvbigpLmJlZ2luKCk7DQogICAgICAgICAgICBUIHQg\nPSBuZXdNYW5hZ2VkSW5zdGFuY2UoKTsNCiAgICAgICAgICAgIE9iamVjdCBv\ncmlnID0gZ2V0TW9kaWZpZWRWYWx1ZSh0KTsNCiAgICAgICAgICAgIGVtLnBl\ncnNpc3QodCk7DQogICAgICAgICAgICBPYmplY3QgaWQgPSBlbS5nZXRPYmpl\nY3RJZCh0KTsNCiAgICAgICAgICAgIGVtLnNldFNhdmVwb2ludCgiZm9vIik7\nDQogICAgICAgICAgICBtb2RpZnlJbnN0YW5jZSh0KTsNCiAgICAgICAgICAg\nIGFzc2VydE5vdEVxdWFscyhvcmlnLCBnZXRNb2RpZmllZFZhbHVlKHQpKTsN\nCg0KICAgICAgICAgICAgZW0yID0gZGVzZXJpYWxpemVFTShzZXJpYWxpemUo\nZW0pKTsNCiAgICAgICAgICAgIFQgdDIgPSBlbTIuZmluZChnZXRNYW5hZ2Vk\nVHlwZSgpLCBpZCk7DQogICAgICAgICAgICBhc3NlcnROb3RFcXVhbHMob3Jp\nZywgZ2V0TW9kaWZpZWRWYWx1ZSh0MikpOw0KDQogICAgICAgICAgICBlbS5y\nb2xsYmFja1RvU2F2ZXBvaW50KCJmb28iKTsNCiAgICAgICAgICAgIGFzc2Vy\ndEVxdWFscyhvcmlnLCBnZXRNb2RpZmllZFZhbHVlKHQpKTsNCg0KICAgICAg\nICAgICAgZW0yLnJvbGxiYWNrVG9TYXZlcG9pbnQoImZvbyIpOw0KICAgICAg\nICAgICAgYXNzZXJ0RXF1YWxzKG9yaWcsIGdldE1vZGlmaWVkVmFsdWUodDIp\nKTsNCiAgICAgICAgfSBmaW5hbGx5IHsNCiAgICAgICAgICAgIGNsb3NlKGVt\nKTsNCiAgICAgICAgICAgIGNsb3NlKGVtMik7DQogICAgICAgIH0NCiAgICB9\nDQoNCiAgICBwdWJsaWMgdm9pZCB0ZXN0SW5NZW1vcnlTYXZlcG9pbnRzV2l0\naE1vZGlmaWVkSW5zdGFuY2VzKCkgew0KICAgICAgICBlbWYuY2xvc2UoKTsN\nCiAgICAgICAgT3BlbkpQQUVudGl0eU1hbmFnZXJGYWN0b3J5IGVtZiA9IGNy\nZWF0ZUVNRigNCiAgICAgICAgICAgIGdldE1hbmFnZWRUeXBlKCksIGdldFNl\nY29uZGFyeVR5cGUoKSwNCiAgICAgICAgICAgICJvcGVuanBhLkVudGl0eU1h\nbmFnZXJGYWN0b3J5UG9vbCIsICJ0cnVlIiwNCiAgICAgICAgICAgICJvcGVu\nanBhLlNhdmVwb2ludE1hbmFnZXIiLCAiaW4tbWVtIik7DQogICAgICAgIE9w\nZW5KUEFFbnRpdHlNYW5hZ2VyIGVtID0gZW1mLmNyZWF0ZUVudGl0eU1hbmFn\nZXIoKTsNCiAgICAgICAgT3BlbkpQQUVudGl0eU1hbmFnZXIgZW0yID0gbnVs\nbDsNCiAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgIGVtLmdldFRyYW5zYWN0\naW9uKCkuYmVnaW4oKTsNCiAgICAgICAgICAgIFQgdCA9IGVtLmZpbmQoZ2V0\nTWFuYWdlZFR5cGUoKSwgaWQpOw0KICAgICAgICAgICAgT2JqZWN0IG9yaWcg\nPSBnZXRNb2RpZmllZFZhbHVlKHQpOw0KICAgICAgICAgICAgZW0uc2V0U2F2\nZXBvaW50KCJmb28iKTsNCiAgICAgICAgICAgIG1vZGlmeUluc3RhbmNlKHQp\nOw0KICAgICAgICAgICAgYXNzZXJ0Tm90RXF1YWxzKG9yaWcsIGdldE1vZGlm\naWVkVmFsdWUodCkpOw0KDQogICAgICAgICAgICBlbTIgPSBkZXNlcmlhbGl6\nZUVNKHNlcmlhbGl6ZShlbSkpOw0KICAgICAgICAgICAgVCB0MiA9IGVtMi5m\naW5kKGdldE1hbmFnZWRUeXBlKCksIGlkKTsNCiAgICAgICAgICAgIGFzc2Vy\ndE5vdEVxdWFscyhvcmlnLCBnZXRNb2RpZmllZFZhbHVlKHQyKSk7DQoNCiAg\nICAgICAgICAgIGVtLnJvbGxiYWNrVG9TYXZlcG9pbnQoImZvbyIpOw0KICAg\nICAgICAgICAgYXNzZXJ0RXF1YWxzKG9yaWcsIGdldE1vZGlmaWVkVmFsdWUo\ndCkpOw0KDQogICAgICAgICAgICBlbTIucm9sbGJhY2tUb1NhdmVwb2ludCgi\nZm9vIik7DQogICAgICAgICAgICBhc3NlcnRFcXVhbHMob3JpZywgZ2V0TW9k\naWZpZWRWYWx1ZSh0MikpOw0KICAgICAgICB9IGZpbmFsbHkgew0KICAgICAg\nICAgICAgY2xvc2UoZW0pOw0KICAgICAgICAgICAgY2xvc2UoZW0yKTsNCiAg\nICAgICAgfQ0KICAgIH0NCg0KICAgIHB1YmxpYyB2b2lkIHRlc3RFdmVudE1h\nbmFnZXJzKCkgew0KICAgICAgICBUeExpc3RlbmVyIHR4TGlzdGVuZXIgPSBu\nZXcgVHhMaXN0ZW5lcigpOw0KICAgICAgICBlbWYuYWRkVHJhbnNhY3Rpb25M\naXN0ZW5lcih0eExpc3RlbmVyKTsNCiAgICAgICAgTGlmZUxpc3RlbmVyIGxp\nZmVMaXN0ZW5lciA9IG5ldyBMaWZlTGlzdGVuZXIoKTsNCiAgICAgICAgZW1m\nLmFkZExpZmVjeWNsZUxpc3RlbmVyKGxpZmVMaXN0ZW5lciwgbnVsbCk7DQoN\nCiAgICAgICAgT3BlbkpQQUVudGl0eU1hbmFnZXIgZW0gPSBlbWYuY3JlYXRl\nRW50aXR5TWFuYWdlcigpOw0KICAgICAgICBUIHQgPSBlbS5maW5kKGdldE1h\nbmFnZWRUeXBlKCksIGlkKTsNCiAgICAgICAgYXNzZXJ0RXF1YWxzKDAsIGxp\nZmVMaXN0ZW5lci5yZWZyZXNoQ291bnQpOw0KICAgICAgICBlbS5yZWZyZXNo\nKHQpOw0KICAgICAgICBhc3NlcnRFcXVhbHMoMSpncmFwaFNpemUoKSwgbGlm\nZUxpc3RlbmVyLnJlZnJlc2hDb3VudCk7DQogICAgICAgIGVtLmdldFRyYW5z\nYWN0aW9uKCkuYmVnaW4oKTsNCiAgICAgICAgZW0uZ2V0VHJhbnNhY3Rpb24o\nKS5jb21taXQoKTsNCiAgICAgICAgZW0uZ2V0VHJhbnNhY3Rpb24oKS5iZWdp\nbigpOw0KICAgICAgICBlbS5nZXRUcmFuc2FjdGlvbigpLmNvbW1pdCgpOw0K\nICAgICAgICBhc3NlcnRFcXVhbHMoMiwgdHhMaXN0ZW5lci5iZWdpbkNvdW50\nKTsNCg0KICAgICAgICBPcGVuSlBBRW50aXR5TWFuYWdlciBlbTIgPSBkZXNl\ncmlhbGl6ZUVNKHNlcmlhbGl6ZShlbSkpOw0KICAgICAgICBhc3NlcnROb3RO\ndWxsKGRlc2VyaWFsaXplZExpZmVMaXN0ZW5lcik7DQogICAgICAgIGFzc2Vy\ndEVxdWFscygxKiBncmFwaFNpemUoKSwNCiAgICAgICAgICAgIGRlc2VyaWFs\naXplZExpZmVMaXN0ZW5lci5yZWZyZXNoQ291bnQpOw0KICAgICAgICBhc3Nl\ncnROb3RTYW1lKGxpZmVMaXN0ZW5lciwgZGVzZXJpYWxpemVkTGlmZUxpc3Rl\nbmVyKTsNCiAgICAgICAgVCB0MiA9IGVtMi5maW5kKGdldE1hbmFnZWRUeXBl\nKCksIGlkKTsNCiAgICAgICAgZW0yLnJlZnJlc2godDIpOw0KICAgICAgICBh\nc3NlcnRFcXVhbHMoMiogZ3JhcGhTaXplKCksDQogICAgICAgICAgICBkZXNl\ncmlhbGl6ZWRMaWZlTGlzdGVuZXIucmVmcmVzaENvdW50KTsNCg0KICAgICAg\nICAvLyBpZiB0aGlzIGlzIDMqcmVmcmVzaE11bHRpcGxpZXIoKSwgdGhhdCBt\nZWFucyB0aGF0IHRoZXJlIGFyZQ0KICAgICAgICAvLyBleHRyYSByZWdpc3Rl\ncmVkIGxpc3RlbmVycw0KICAgICAgICBhc3NlcnRFcXVhbHMoMiogZ3JhcGhT\naXplKCksIHRlc3RHbG9iYWxSZWZyZXNoQ291bnQpOw0KDQoNCiAgICAgICAg\nYXNzZXJ0Tm90TnVsbChkZXNlcmlhbGl6ZWRUeExpc3RlbmVyKTsNCiAgICAg\nICAgYXNzZXJ0RXF1YWxzKDIsIGRlc2VyaWFsaXplZFR4TGlzdGVuZXIuYmVn\naW5Db3VudCk7DQogICAgICAgIGFzc2VydE5vdFNhbWUodHhMaXN0ZW5lciwg\nZGVzZXJpYWxpemVkVHhMaXN0ZW5lcik7DQogICAgICAgIGVtMi5nZXRUcmFu\nc2FjdGlvbigpLmJlZ2luKCk7DQogICAgICAgIGVtMi5nZXRUcmFuc2FjdGlv\nbigpLnJvbGxiYWNrKCk7DQogICAgICAgIGFzc2VydEVxdWFscygzLCBkZXNl\ncmlhbGl6ZWRUeExpc3RlbmVyLmJlZ2luQ291bnQpOw0KDQogICAgICAgIC8v\nIGlmIHRoaXMgaXMgNCwgdGhhdCBtZWFucyB0aGF0IHRoZXJlIGFyZSBleHRy\nYSByZWdpc3RlcmVkIGxpc3RlbmVycw0KICAgICAgICBhc3NlcnRFcXVhbHMo\nMywgdGVzdEdsb2JhbEJlZ2luQ291bnQpOw0KICAgIH0NCg0KICAgIGJ5dGVb\nXSBzZXJpYWxpemUoT2JqZWN0IG8pIHsNCiAgICAgICAgdHJ5IHsNCiAgICAg\nICAgICAgIEJ5dGVBcnJheU91dHB1dFN0cmVhbSBiYW9zID0gbmV3IEJ5dGVB\ncnJheU91dHB1dFN0cmVhbSgpOw0KICAgICAgICAgICAgT2JqZWN0T3V0cHV0\nU3RyZWFtIG9vcyA9IG5ldyBPYmplY3RPdXRwdXRTdHJlYW0oYmFvcyk7DQog\nICAgICAgICAgICBvb3Mud3JpdGVPYmplY3Qobyk7DQogICAgICAgICAgICBv\nb3MuZmx1c2goKTsNCiAgICAgICAgICAgIHJldHVybiBiYW9zLnRvQnl0ZUFy\ncmF5KCk7DQogICAgICAgIH0gY2F0Y2ggKElPRXhjZXB0aW9uIGlvZSkgew0K\nICAgICAgICAgICAgdGhyb3cgbmV3IFJ1bnRpbWVFeGNlcHRpb24oaW9lKTsN\nCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIE9wZW5KUEFFbnRpdHlNYW5hZ2Vy\nIGRlc2VyaWFsaXplRU0oYnl0ZVtdIGJ5dGVzKSB7DQogICAgICAgIHJldHVy\nbiAoT3BlbkpQQUVudGl0eU1hbmFnZXIpIGRlc2VyaWFsaXplKGJ5dGVzKTsN\nCiAgICB9DQoNCiAgICBwcml2YXRlIE9iamVjdCBkZXNlcmlhbGl6ZShieXRl\nW10gYnl0ZXMpIHsNCiAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgIEJ5dGVB\ncnJheUlucHV0U3RyZWFtIGJhaXMgPSBuZXcgQnl0ZUFycmF5SW5wdXRTdHJl\nYW0oYnl0ZXMpOw0KICAgICAgICAgICAgT2JqZWN0SW5wdXRTdHJlYW0gb2lz\nID0gbmV3IE9iamVjdElucHV0U3RyZWFtKGJhaXMpOw0KICAgICAgICAgICAg\ncmV0dXJuIG9pcy5yZWFkT2JqZWN0KCk7DQogICAgICAgIH0gY2F0Y2ggKElP\nRXhjZXB0aW9uIGlvZSkgew0KICAgICAgICAgICAgdGhyb3cgbmV3IFJ1bnRp\nbWVFeGNlcHRpb24oaW9lKTsNCiAgICAgICAgfSBjYXRjaCAoQ2xhc3NOb3RG\nb3VuZEV4Y2VwdGlvbiBlKSB7DQogICAgICAgICAgICB0aHJvdyBuZXcgUnVu\ndGltZUV4Y2VwdGlvbihlKTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIHZv\naWQgY2xvc2UoRW50aXR5TWFuYWdlciBlbSkgew0KICAgICAgICBpZiAoZW0g\nIT0gbnVsbCAmJiBlbS5pc09wZW4oKSAmJiBlbS5nZXRUcmFuc2FjdGlvbigp\nLmlzQWN0aXZlKCkpDQogICAgICAgICAgICBlbS5nZXRUcmFuc2FjdGlvbigp\nLnJvbGxiYWNrKCk7DQogICAgICAgIGlmIChlbSAhPSBudWxsICYmIGVtLmlz\nT3BlbigpKQ0KICAgICAgICAgICAgZW0uY2xvc2UoKTsNCiAgICB9DQoNCiAg\nICBwcm90ZWN0ZWQgYWJzdHJhY3QgQ2xhc3M8VD4gZ2V0TWFuYWdlZFR5cGUo\nKTsNCg0KICAgIHByb3RlY3RlZCBhYnN0cmFjdCBUIG5ld01hbmFnZWRJbnN0\nYW5jZSgpOw0KDQogICAgcHJvdGVjdGVkIGFic3RyYWN0IHZvaWQgbW9kaWZ5\nSW5zdGFuY2UoVCB0KTsNCg0KICAgIHByb3RlY3RlZCBhYnN0cmFjdCBPYmpl\nY3QgZ2V0TW9kaWZpZWRWYWx1ZShUIHQpOw0KDQogICAgLyoqDQogICAgICog\nVGhlIG51bWJlciBvZiBpbnN0YW5jZXMgaW4gdGhlIGdyYXBoIGNyZWF0ZWQN\nCiAgICAgKiBieSB7QGxpbmsgI25ld01hbmFnZWRJbnN0YW5jZSgpfSBvZiB0\neXBlIFQuDQogICAgICovDQogICAgcHJvdGVjdGVkIGludCBncmFwaFNpemUo\nKSB7DQogICAgICAgIHJldHVybiAxOw0KICAgIH0NCg0KICAgIC8qKg0KICAg\nICAqIEFuIGFkZGl0aW9uYWwgdHlwZSB0aGF0IG11c3QgYmUgYXZhaWxhYmxl\nIGluIHRoaXMgUEMuIE1heSBiZSBudWxsLg0KICAgICAqLw0KICAgIHByb3Rl\nY3RlZCBDbGFzcyBnZXRTZWNvbmRhcnlUeXBlKCkgew0KICAgICAgICByZXR1\ncm4gbnVsbDsNCiAgICB9DQoNCiAgICBwcml2YXRlIHN0YXRpYyBjbGFzcyBU\neExpc3RlbmVyDQogICAgICAgIGV4dGVuZHMgQWJzdHJhY3RUcmFuc2FjdGlv\nbkxpc3RlbmVyDQogICAgICAgIGltcGxlbWVudHMgU2VyaWFsaXphYmxlIHsN\nCg0KICAgICAgICBwcml2YXRlIGludCBiZWdpbkNvdW50ID0gMDsNCg0KICAg\nICAgICBwdWJsaWMgVHhMaXN0ZW5lcigpIHsNCg0KICAgICAgICB9DQoNCiAg\nICAgICAgQE92ZXJyaWRlDQogICAgICAgIHB1YmxpYyB2b2lkIGFmdGVyQmVn\naW4oVHJhbnNhY3Rpb25FdmVudCBldmVudCkgew0KICAgICAgICAgICAgYmVn\naW5Db3VudCsrOw0KICAgICAgICAgICAgdGVzdEdsb2JhbEJlZ2luQ291bnQr\nKzsNCiAgICAgICAgfQ0KDQogICAgICAgIHByaXZhdGUgdm9pZCByZWFkT2Jq\nZWN0KE9iamVjdElucHV0U3RyZWFtIGluKQ0KICAgICAgICAgICAgdGhyb3dz\nIENsYXNzTm90Rm91bmRFeGNlcHRpb24sIElPRXhjZXB0aW9uIHsNCiAgICAg\nICAgICAgIGluLmRlZmF1bHRSZWFkT2JqZWN0KCk7DQogICAgICAgICAgICBk\nZXNlcmlhbGl6ZWRUeExpc3RlbmVyID0gdGhpczsNCiAgICAgICAgfQ0KICAg\nIH0NCg0KICAgIHByaXZhdGUgc3RhdGljIGNsYXNzIExpZmVMaXN0ZW5lcg0K\nICAgICAgICBleHRlbmRzIEFic3RyYWN0TGlmZWN5Y2xlTGlzdGVuZXINCiAg\nICAgICAgaW1wbGVtZW50cyBTZXJpYWxpemFibGUgew0KDQogICAgICAgIHBy\naXZhdGUgaW50IHJlZnJlc2hDb3VudCA9IDA7DQoNCiAgICAgICAgQE92ZXJy\naWRlDQogICAgICAgIHB1YmxpYyB2b2lkIGFmdGVyUmVmcmVzaChMaWZlY3lj\nbGVFdmVudCBldmVudCkgew0KICAgICAgICAgICAgcmVmcmVzaENvdW50Kys7\nDQogICAgICAgICAgICB0ZXN0R2xvYmFsUmVmcmVzaENvdW50Kys7DQogICAg\nICAgIH0NCg0KICAgICAgICBwcml2YXRlIHZvaWQgcmVhZE9iamVjdChPYmpl\nY3RJbnB1dFN0cmVhbSBpbikNCiAgICAgICAgICAgIHRocm93cyBDbGFzc05v\ndEZvdW5kRXhjZXB0aW9uLCBJT0V4Y2VwdGlvbiB7DQogICAgICAgICAgICBp\nbi5kZWZhdWx0UmVhZE9iamVjdCgpOw0KICAgICAgICAgICAgZGVzZXJpYWxp\nemVkTGlmZUxpc3RlbmVyID0gdGhpczsNCiAgICAgICAgfQ0KICAgIH0NCn0=\n","encoding":"base64"}

