{"sha":"dfbf272a6cf5c342fd9a785787da79c0b7980503","node_id":"MDQ6QmxvYjIwNjM2NDpkZmJmMjcyYTZjZjVjMzQyZmQ5YTc4NTc4N2RhNzljMGI3OTgwNTAz","size":42534,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/dfbf272a6cf5c342fd9a785787da79c0b7980503","content":"LyoNCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUNCiAqIG9yIG1vcmUgY29udHJpYnV0b3Ig\nbGljZW5zZSBhZ3JlZW1lbnRzLiAgU2VlIHRoZSBOT1RJQ0UgZmlsZQ0KICog\nZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5m\nb3JtYXRpb24NCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAg\nVGhlIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUNCiAqIHRvIHlvdSB1bmRlciB0\naGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUNCiAqICJMaWNl\nbnNlIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNv\nbXBsaWFuY2UNCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFp\nbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQNCiAqDQogKiBodHRwOi8vd3d3\nLmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjANCiAqDQogKiBVbmxl\nc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGlu\nIHdyaXRpbmcsDQogKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUg\nTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbg0KICogIkFTIElTIiBCQVNJ\nUywgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZDQog\nKiBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBM\naWNlbnNlIGZvciB0aGUNCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmlu\nZyBwZXJtaXNzaW9ucyBhbmQgbGltaXRhdGlvbnMNCiAqIHVuZGVyIHRoZSBM\naWNlbnNlLg0KICovDQovKg0KICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBT\nb2Z0d2FyZSBGb3VuZGF0aW9uIChBU0YpIHVuZGVyIG9uZQ0KICogb3IgbW9y\nZSBjb250cmlidXRvciBsaWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5P\nVElDRSBmaWxlDQogKiBkaXN0cmlidXRlZCB3aXRoIHRoaXMgd29yayBmb3Ig\nYWRkaXRpb25hbCBpbmZvcm1hdGlvbg0KICogcmVnYXJkaW5nIGNvcHlyaWdo\ndCBvd25lcnNoaXAuICBUaGUgQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQ0KICog\ndG8geW91IHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAg\nKHRoZQ0KICogIkxpY2Vuc2UiKTsgeW91IG1heSBub3QgdXNlIHRoaXMgZmls\nZSBleGNlcHQgaW4gY29tcGxpYW5jZQ0KICogd2l0aCB0aGUgTGljZW5zZS4g\nIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdA0KICoN\nCiAqIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIu\nMA0KICoNCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBv\nciBhZ3JlZWQgdG8gaW4gd3JpdGluZywNCiAqIHNvZnR3YXJlIGRpc3RyaWJ1\ndGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuDQog\nKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElU\nSU9OUyBPRiBBTlkNCiAqIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxp\nZWQuICBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZQ0KICogc3BlY2lmaWMgbGFu\nZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZCBsaW1pdGF0aW9ucw0K\nICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIA0KICovDQpwYWNrYWdlIG9yZy5h\ncGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5jb21tb24udXRpbHM7DQoNCmlt\ncG9ydCBqYXZhLnV0aWwuTWFwOw0KaW1wb3J0IGphdmEudXRpbC5EYXRlOw0K\naW1wb3J0IGphdmEudXRpbC5Db2xsZWN0aW9uOw0KaW1wb3J0IGphdmEudXRp\nbC5FbnVtU2V0Ow0KaW1wb3J0IGphdmEudXRpbC5BcnJheUxpc3Q7DQppbXBv\ncnQgamF2YS51dGlsLkhhc2hNYXA7DQppbXBvcnQgamF2YS51dGlsLkxpc3Q7\nDQppbXBvcnQgamF2YS51dGlsLkl0ZXJhdG9yOw0KaW1wb3J0IGphdmEudXRp\nbC5Db2xsZWN0aW9uczsNCmltcG9ydCBqYXZhLnV0aWwuTGlua2VkTGlzdDsN\nCmltcG9ydCBqYXZhLnV0aWwuU3RyaW5nVG9rZW5pemVyOw0KaW1wb3J0IGph\ndmEudXRpbC5MaXN0SXRlcmF0b3I7DQppbXBvcnQgamF2YS51dGlsLk5vU3Vj\naEVsZW1lbnRFeGNlcHRpb247DQppbXBvcnQgamF2YS51dGlsLkFycmF5czsN\nCmltcG9ydCBqYXZhLnV0aWwuQ29tcGFyYXRvcjsNCmltcG9ydCBqYXZhLm1h\ndGguQmlnSW50ZWdlcjsNCmltcG9ydCBqYXZhLm1hdGguQmlnRGVjaW1hbDsN\nCmltcG9ydCBqYXZhLmxhbmcucmVmbGVjdC5JbnZvY2F0aW9uVGFyZ2V0RXhj\nZXB0aW9uOw0KaW1wb3J0IGphdmEubGFuZy5yZWZsZWN0Lk1ldGhvZDsNCmlt\ncG9ydCBqYXZhLmJlYW5zLkJlYW5JbmZvOw0KaW1wb3J0IGphdmEuYmVhbnMu\nSW50cm9zcGVjdG9yOw0KaW1wb3J0IGphdmEuYmVhbnMuUHJvcGVydHlEZXNj\ncmlwdG9yOw0KaW1wb3J0IGphdmEuaW8uSU9FeGNlcHRpb247DQppbXBvcnQg\namF2YS5pby5CeXRlQXJyYXlPdXRwdXRTdHJlYW07DQppbXBvcnQgamF2YS5p\nby5PYmplY3RPdXRwdXRTdHJlYW07DQppbXBvcnQgamF2YS5pby5CeXRlQXJy\nYXlJbnB1dFN0cmVhbTsNCmltcG9ydCBqYXZhLmlvLk9iamVjdElucHV0U3Ry\nZWFtOw0KaW1wb3J0IGphdmEuaW8uU3RyaW5nV3JpdGVyOw0KaW1wb3J0IGph\ndmEuaW8uUHJpbnRXcml0ZXI7DQppbXBvcnQgamF2YS5pby5QcmludFN0cmVh\nbTsNCmltcG9ydCBqYXZhLm5ldC5VUkw7DQppbXBvcnQgamF2YXgucGVyc2lz\ndGVuY2UuRW50aXR5TWFuYWdlcjsNCmltcG9ydCBqYXZheC5wZXJzaXN0ZW5j\nZS5RdWVyeTsNCmltcG9ydCBqYXZheC5wZXJzaXN0ZW5jZS5FbnRpdHlNYW5h\nZ2VyRmFjdG9yeTsNCmltcG9ydCBqYXZheC5tYW5hZ2VtZW50LkludHJvc3Bl\nY3Rpb25FeGNlcHRpb247DQoNCmltcG9ydCBvcmcuYXBhY2hlLnJlZ2V4cC5S\nRVN5bnRheEV4Y2VwdGlvbjsNCmltcG9ydCBvcmcuYXBhY2hlLnJlZ2V4cC5S\nRTsNCmltcG9ydCBvcmcuYXBhY2hlLnJlZ2V4cC5SRVV0aWw7DQppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNlLnRlc3QuUGVyc2lzdGVu\nY2VUZXN0Q2FzZTsNCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lz\ndGVuY2UuT3BlbkpQQUVudGl0eU1hbmFnZXJGYWN0b3J5Ow0KaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5PcGVuSlBBRW50aXR5TWFu\nYWdlcjsNCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2Uu\nSlBBRmFjYWRlSGVscGVyOw0KaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5w\nZXJzaXN0ZW5jZS5PcGVuSlBBUGVyc2lzdGVuY2U7DQppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLmNvbmYuT3BlbkpQQUNvbmZpZ3VyYXRpb247DQppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5PcGVuSlBBU3RhdGVNYW5h\nZ2VyOw0KaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuQnJva2Vy\nRmFjdG9yeTsNCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLmxvZy5M\nb2c7DQppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuQ2xhc3NNZXRh\nRGF0YTsNCg0KcHVibGljIGFic3RyYWN0IGNsYXNzIEFic3RyYWN0VGVzdENh\nc2UgZXh0ZW5kcyBQZXJzaXN0ZW5jZVRlc3RDYXNlIHsNCg0KICAgIHByaXZh\ndGUgU3RyaW5nIHBlcnNpc3RlbmNlWG1sUmVzb3VyY2U7DQogICAgcHJpdmF0\nZSBNYXA8TWFwLE9wZW5KUEFFbnRpdHlNYW5hZ2VyRmFjdG9yeT4gZW1mcyA9\nDQogICAgICAgIG5ldyBIYXNoTWFwPE1hcCxPcGVuSlBBRW50aXR5TWFuYWdl\nckZhY3Rvcnk+KCk7DQogICAgcHJpdmF0ZSBPcGVuSlBBRW50aXR5TWFuYWdl\nciBjdXJyZW50RW50aXR5TWFuYWdlcjsNCg0KICAgIHByb3RlY3RlZCBlbnVt\nIFBsYXRmb3JtIHsNCiAgICAgICAgRU1QUkVTUywNCiAgICAgICAgSFlQRVJT\nT05JQywNCiAgICAgICAgUE9TVEdSRVNRTCwNCiAgICAgICAgTVlTUUwsDQog\nICAgICAgIFNRTFNFUlZFUiwNCiAgICAgICAgREIyLA0KICAgICAgICBPUkFD\nTEUsDQogICAgICAgIERFUkJZLA0KICAgICAgICBJTkZPUk1JWCwNCiAgICAg\nICAgUE9JTlRCQVNFLA0KICAgICAgICBTWUJBU0UsDQogICAgfQ0KDQogICAg\ncHJvdGVjdGVkIFN0cmluZyBtdWx0aVRocmVhZEV4ZWN1dGluZyA9IG51bGw7\nDQogICAgcHJvdGVjdGVkIGJvb2xlYW4gaW5UaW1lb3V0VGhyZWFkID0gZmFs\nc2U7DQoNCg0KICAgIHB1YmxpYyBBYnN0cmFjdFRlc3RDYXNlKFN0cmluZyBu\nYW1lLCBTdHJpbmcgcykgew0KICAgICAgICBzZXROYW1lKG5hbWUpOw0KICAg\nICAgICBwZXJzaXN0ZW5jZVhtbFJlc291cmNlID0gY29tcHV0ZVBlcnNpc3Rl\nbmNlWG1sUmVzb3VyY2Uocyk7DQogICAgfQ0KDQogICAgcHVibGljIHZvaWQg\ndGVhckRvd24oKSB0aHJvd3MgRXhjZXB0aW9uIHsNCiAgICAgICAgdHJ5IHsN\nCiAgICAgICAgICAgIHN1cGVyLnRlYXJEb3duKCk7DQogICAgICAgIH0gZmlu\nYWxseSB7DQogICAgICAgICAgICBmb3IgKEVudGl0eU1hbmFnZXJGYWN0b3J5\nIGVtZiA6IGVtZnMudmFsdWVzKCkpIHsNCiAgICAgICAgICAgICAgICB0cnkg\new0KICAgICAgICAgICAgICAgICAgICBjbG9zZUVNRihlbWYpOw0KICAgICAg\nICAgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7DQogICAgICAgICAg\nICAgICAgICAgIGUucHJpbnRTdGFja1RyYWNlKCk7DQogICAgICAgICAgICAg\nICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfQ0KDQogICAg\ncHVibGljIEFic3RyYWN0VGVzdENhc2UoKSB7DQogICAgfQ0KDQogICAgcHVi\nbGljIEFic3RyYWN0VGVzdENhc2UoU3RyaW5nIG5hbWUpIHsNCiAgICAgICAg\nc2V0TmFtZShuYW1lKTsNCiAgICB9DQoNCiAgICBwcm90ZWN0ZWQgU3RyaW5n\nIGNvbXB1dGVQZXJzaXN0ZW5jZVhtbFJlc291cmNlKFN0cmluZyBzKSB7DQog\nICAgICAgIFN0cmluZyByZXNvdXJjZU5hbWUgPSBnZXRDbGFzcygpLmdldFBh\nY2thZ2UoKS5nZXROYW1lKCkNCiAgICAgICAgICAgIC5yZXBsYWNlQWxsKCJc\nXC4iLCAiLyIpOw0KICAgICAgICByZXNvdXJjZU5hbWUgKz0gIi9jb21tb24v\nYXBwcy9NRVRBLUlORi9wZXJzaXN0ZW5jZS54bWwiOw0KICAgICAgICBVUkwg\ncmVzb3VyY2UgPSBnZXRDbGFzcygpLmdldENsYXNzTG9hZGVyKCkuZ2V0UmVz\nb3VyY2UocmVzb3VyY2VOYW1lKTsNCiAgICAgICAgaWYgKHJlc291cmNlICE9\nIG51bGwpDQogICAgICAgICAgICByZXR1cm4gcmVzb3VyY2VOYW1lOw0KICAg\nICAgICByZXR1cm4gZGVmYXVsdFBlcnNpc3RlbmNlWG1sUmVzb3VyY2UoKTsN\nCiAgICB9DQoNCiAgICBwcm90ZWN0ZWQgU3RyaW5nIGRlZmF1bHRQZXJzaXN0\nZW5jZVhtbFJlc291cmNlKCkgew0KICAgICAgICByZXR1cm4gIm9yZy9hcGFj\naGUvb3BlbmpwYS9wZXJzaXN0ZW5jZS8iICsNCiAgICAgICAgICAgICJjb21t\nb24vYXBwcy9NRVRBLUlORi9wZXJzaXN0ZW5jZS54bWwiOw0KICAgIH0NCg0K\nICAgIHByb3RlY3RlZCBPcGVuSlBBU3RhdGVNYW5hZ2VyIGdldFN0YXRlTWFu\nYWdlcihPYmplY3Qgb2JqLA0KICAgICAgICBFbnRpdHlNYW5hZ2VyIGVtKSB7\nDQogICAgICAgIHJldHVybiBKUEFGYWNhZGVIZWxwZXIudG9Ccm9rZXIoZW0p\nLmdldFN0YXRlTWFuYWdlcihvYmopOw0KICAgIH0NCg0KICAgIHByb3RlY3Rl\nZCBpbnQgZGVsZXRlQWxsKENsYXNzIHR5cGUsIEVudGl0eU1hbmFnZXIgZW0p\nIHsNCiAgICAgICAgQ2xhc3NNZXRhRGF0YSBtZXRhID0gSlBBRmFjYWRlSGVs\ncGVyLmdldE1ldGFEYXRhKGVtLCB0eXBlKTsNCiAgICAgICAgaWYgKG1ldGEg\nIT0gbnVsbCkNCiAgICAgICAgICAgIHJldHVybiBlbS5jcmVhdGVRdWVyeSgi\nZGVsZXRlIGZyb20gIiArIG1ldGEuZ2V0VHlwZUFsaWFzKCkpDQogICAgICAg\nICAgICAgICAgLmV4ZWN1dGVVcGRhdGUoKTsNCiAgICAgICAgZWxzZQ0KICAg\nICAgICAgICAgcmV0dXJuIC0xOw0KICAgIH0NCg0KICAgIHByb3RlY3RlZCBp\nbnQgZGVsZXRlQWxsKENsYXNzLi4uIHR5cGVzKSB7DQogICAgICAgIEVudGl0\neU1hbmFnZXIgZW0gPSBnZXRFbWYoKS5jcmVhdGVFbnRpdHlNYW5hZ2VyKCk7\nDQogICAgICAgIGVtLmdldFRyYW5zYWN0aW9uKCkuYmVnaW4oKTsNCiAgICAg\nICAgaW50IHJldCA9IDA7DQogICAgICAgIGZvciAoQ2xhc3MgdHlwZSA6IHR5\ncGVzKQ0KICAgICAgICAgICAgcmV0ICs9IGRlbGV0ZUFsbCh0eXBlLCBlbSk7\nDQogICAgICAgIGVtLmdldFRyYW5zYWN0aW9uKCkuY29tbWl0KCk7DQogICAg\nICAgIGVtLmNsb3NlKCk7DQogICAgICAgIHJldHVybiByZXQ7DQogICAgfQ0K\nDQogICAgcHJvdGVjdGVkIE9wZW5KUEFFbnRpdHlNYW5hZ2VyRmFjdG9yeSBn\nZXRFbWYoTWFwIG1hcCkgew0KICAgICAgICBpZiAobWFwID09IG51bGwpDQog\nICAgICAgICAgICBtYXAgPSBuZXcgSGFzaE1hcCgpOw0KICAgICAgICBDb2xs\nZWN0aW9uIGtleXMgPSBuZXcgQXJyYXlMaXN0KCk7DQogICAgICAgIGZvciAo\nT2JqZWN0IGtleSA6IG1hcC5rZXlTZXQoKSkNCiAgICAgICAgICAgIGlmIChr\nZXkudG9TdHJpbmcoKS5zdGFydHNXaXRoKCJrb2RvIikpDQogICAgICAgICAg\nICAgICAga2V5cy5hZGQoa2V5KTsNCiAgICAgICAgaWYgKGtleXMuc2l6ZSgp\nID4gMCkNCiAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRF\neGNlcHRpb24oDQogICAgICAgICAgICAgICAgImtvZG8tcHJlZml4ZWQgcHJv\ncGVydGllcyBtdXN0IGJlIGNvbnZlcnRlZCB0byBvcGVuanBhLiAiICsNCiAg\nICAgICAgICAgICAgICAgICAgIlByb3BlcnRpZXM6ICIgKyBrZXlzKTsNCg0K\nICAgICAgICBhZGRQcm9wZXJ0aWVzKG1hcCk7DQoNCiAgICAgICAgT3BlbkpQ\nQUVudGl0eU1hbmFnZXJGYWN0b3J5IGVtZiA9IGVtZnMuZ2V0KG1hcCk7DQog\nICAgICAgIGlmIChlbWYgPT0gbnVsbCkgew0KICAgICAgICAgICAgZW1mID0g\nT3BlbkpQQVBlcnNpc3RlbmNlLmNyZWF0ZUVudGl0eU1hbmFnZXJGYWN0b3J5\nKA0KICAgICAgICAgICAgICAgICJUZXN0Q29udiIsIHBlcnNpc3RlbmNlWG1s\nUmVzb3VyY2UsIG1hcCk7DQogICAgICAgICAgICBlbWZzLnB1dChtYXAsIGVt\nZik7DQogICAgICAgIH0NCiAgICAgICAgcmV0dXJuIGVtZjsNCiAgICB9DQoN\nCiAgICBwcm90ZWN0ZWQgdm9pZCBhZGRQcm9wZXJ0aWVzKE1hcCBtYXApIHsN\nCiAgICAgICAgaWYgKCFtYXAuY29udGFpbnNLZXkoIm9wZW5qcGEuamRiYy5T\neW5jaHJvbml6ZU1hcHBpbmdzIikpDQogICAgICAgICAgICBtYXAucHV0KCJv\ncGVuanBhLmpkYmMuU3luY2hyb25pemVNYXBwaW5ncyIsDQogICAgICAgICAg\nICAgICAgImJ1aWxkU2NoZW1hKEZvcmVpZ25LZXlzPXRydWUsIiArDQogICAg\nICAgICAgICAgICAgICAgICJTY2hlbWFBY3Rpb249J2FkZCxkZWxldGVUYWJs\nZUNvbnRlbnRzJykiKTsNCiAgICB9DQoNCiAgICBwcm90ZWN0ZWQgT3BlbkpQ\nQUVudGl0eU1hbmFnZXJGYWN0b3J5IGdldEVtZigpIHsNCiAgICAgICAgTWFw\nIG0gPSBuZXcgSGFzaE1hcCgpOw0KICAgICAgICByZXR1cm4gZ2V0RW1mKG0p\nOw0KICAgIH0NCg0KICAgIHByb3RlY3RlZCBCcm9rZXJGYWN0b3J5IGdldEJy\nb2tlckZhY3RvcnkoKSB7DQogICAgICAgIHJldHVybiBKUEFGYWNhZGVIZWxw\nZXIudG9Ccm9rZXJGYWN0b3J5KGdldEVtZigpKTsNCiAgICB9DQoNCiAgICBw\ncm90ZWN0ZWQgQnJva2VyRmFjdG9yeSBnZXRCcm9rZXJGYWN0b3J5KFN0cmlu\nZ1tdIGFyZ3MpIHsNCiAgICAgICAgaWYgKGFyZ3MubGVuZ3RoICUgMiAhPSAw\nKQ0KICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2Vw\ndGlvbigNCiAgICAgICAgICAgICAgICAib2RkIG51bWJlciBvZiBlbGVtZW50\ncyBpbiBhcmcgYXJyYXkiKTsNCiAgICAgICAgTWFwIG1hcCA9IG5ldyBIYXNo\nTWFwKCk7DQogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgYXJncy5sZW5n\ndGg7IGkgPSBpICsgMikNCiAgICAgICAgICAgIG1hcC5wdXQoYXJnc1tpXSwg\nYXJnc1tpKzFdKTsNCiAgICAgICAgcmV0dXJuIEpQQUZhY2FkZUhlbHBlci50\nb0Jyb2tlckZhY3RvcnkoZ2V0RW1mKG1hcCkpOw0KICAgIH0NCg0KICAgIHBy\nb3RlY3RlZCBPcGVuSlBBRW50aXR5TWFuYWdlciBjdXJyZW50RW50aXR5TWFu\nYWdlcigpIHsNCiAgICAgICAgaWYgKGN1cnJlbnRFbnRpdHlNYW5hZ2VyID09\nIG51bGwgfHwgIWN1cnJlbnRFbnRpdHlNYW5hZ2VyLmlzT3BlbigpKQ0KICAg\nICAgICAgICAgY3VycmVudEVudGl0eU1hbmFnZXIgPSBnZXRFbWYoKS5jcmVh\ndGVFbnRpdHlNYW5hZ2VyKCk7DQogICAgICAgIHJldHVybiBjdXJyZW50RW50\naXR5TWFuYWdlcjsNCiAgICB9DQoNCiAgICBwcm90ZWN0ZWQgdm9pZCBzdGFy\ndFR4KEVudGl0eU1hbmFnZXIgZW0pIHsNCiAgICAgICAgZW0uZ2V0VHJhbnNh\nY3Rpb24oKS5iZWdpbigpOw0KICAgIH0NCg0KICAgIHByb3RlY3RlZCBib29s\nZWFuIGlzQWN0aXZlVHgoRW50aXR5TWFuYWdlciBlbSkgew0KICAgICAgICBy\nZXR1cm4gZW0uZ2V0VHJhbnNhY3Rpb24oKS5pc0FjdGl2ZSgpOw0KICAgIH0N\nCg0KICAgIHByb3RlY3RlZCB2b2lkIGVuZFR4KEVudGl0eU1hbmFnZXIgZW0p\nIHsNCiAgICAgICAgaWYgKGVtLmdldFRyYW5zYWN0aW9uKCkuaXNBY3RpdmUo\nKSkgew0KICAgICAgICAgICAgaWYgKGVtLmdldFRyYW5zYWN0aW9uKCkuZ2V0\nUm9sbGJhY2tPbmx5KCkpDQogICAgICAgICAgICAgICAgZW0uZ2V0VHJhbnNh\nY3Rpb24oKS5yb2xsYmFjaygpOw0KICAgICAgICAgICAgZWxzZQ0KICAgICAg\nICAgICAgICAgIGVtLmdldFRyYW5zYWN0aW9uKCkuY29tbWl0KCk7DQogICAg\nICAgIH0NCiAgICB9DQoNCiAgICBwcm90ZWN0ZWQgdm9pZCByb2xsYmFja1R4\nKEVudGl0eU1hbmFnZXIgZW0pIHsNCiAgICAgICAgZW0uZ2V0VHJhbnNhY3Rp\nb24oKS5yb2xsYmFjaygpOw0KICAgIH0NCg0KICAgIHByb3RlY3RlZCB2b2lk\nIGVuZEVtKEVudGl0eU1hbmFnZXIgZW0pIHsNCiAgICAgICAgaWYgKGVtLmlz\nT3BlbigpKQ0KICAgICAgICAgICAgZW0uY2xvc2UoKTsNCiAgICAgICAgaWYg\nKGVtID09IGN1cnJlbnRFbnRpdHlNYW5hZ2VyKQ0KICAgICAgICBjdXJyZW50\nRW50aXR5TWFuYWdlciA9IG51bGw7DQogICAgfQ0KDQogICAgcHJvdGVjdGVk\nIE9iamVjdCBnZXRTdGFja1RyYWNlKFRocm93YWJsZSB0KSB7DQogICAgICAg\nIHRocm93IG5ldyBVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbigpOw0K\nICAgIH0NCg0KICAgIHByb3RlY3RlZCBPcGVuSlBBQ29uZmlndXJhdGlvbiBn\nZXRDb25maWd1cmF0aW9uKCkgew0KICAgICAgICByZXR1cm4gZ2V0RW1mKCku\nZ2V0Q29uZmlndXJhdGlvbigpOw0KICAgIH0NCg0KICAgIHByb3RlY3RlZCBQ\nbGF0Zm9ybSBnZXRDdXJyZW50UGxhdGZvcm0oKSB7DQogICAgICAgIHRocm93\nIG5ldyBVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbigpOw0KICAgIH0N\nCg0KICAgIHByb3RlY3RlZCB2b2lkIGJ1ZyhpbnQgaWQsIFN0cmluZyBzKSB7\nDQogICAgICAgIGJ1ZyhpZCwgbnVsbCwgcyk7DQogICAgfQ0KICAgIA0KICAg\nIHByb3RlY3RlZCB2b2lkIGJ1ZyhQbGF0Zm9ybSBwbGF0Zm9ybSwgaW50IGlk\nLCBUaHJvd2FibGUgdCwgU3RyaW5nIHMpIHsNCiAgICAgICAgYnVnKEVudW1T\nZXQub2YocGxhdGZvcm0pLCBpZCwgdCwgcyk7DQogICAgfQ0KDQogICAgcHJv\ndGVjdGVkIHZvaWQgYnVnKEVudW1TZXQ8UGxhdGZvcm0+IHBsYXRmb3Jtcywg\naW50IGlkLCBUaHJvd2FibGUgdCwgU3RyaW5nIHMpIHsNCiAgICAgICAgaWYg\nKHBsYXRmb3Jtcy5jb250YWlucyhnZXRDdXJyZW50UGxhdGZvcm0oKSkpDQog\nICAgICAgICAgICBidWcoaWQsIHQsIHMpOw0KICAgICAgICBlbHNlDQogICAg\nICAgICAgICBmYWlsKFN0cmluZy5mb3JtYXQoDQogICAgICAgICAgICAgICAg\nImJ1ZyAlcyBpcyB1bmV4cGVjdGVkbHkgb2NjdXJyaW5nIG9uIHBsYXRmb3Jt\nICVzIiwNCiAgICAgICAgICAgICAgICBpZCwgZ2V0Q3VycmVudFBsYXRmb3Jt\nKCkpKTsNCiAgICB9DQoNCiAgICBwcm90ZWN0ZWQgdm9pZCBidWcoaW50IGlk\nLCBUaHJvd2FibGUgdCwgU3RyaW5nIHMpIHsNCiAgICAgICAgaWYgKHQgIT0g\nbnVsbCkgew0KICAgICAgICAgICAgaWYgKHQgaW5zdGFuY2VvZiBSdW50aW1l\nRXhjZXB0aW9uKQ0KICAgICAgICAgICAgICAgIHRocm93IChSdW50aW1lRXhj\nZXB0aW9uKSB0Ow0KICAgICAgICAgICAgZWxzZQ0KICAgICAgICAgICAgICAg\nIHRocm93IG5ldyBSdW50aW1lRXhjZXB0aW9uKHQpOw0KICAgICAgICB9IGVs\nc2Ugew0KICAgICAgICAgICAgZmFpbChzKTsNCiAgICAgICAgfQ0KICAgIH0N\nCg0KICAgIC8qKg0KICAgICAqIFN1cHBvcnQgbWV0aG9kIHRvIGdldCBhIHJh\nbmRvbSBJbnRlZ2VyIGZvciB0ZXN0aW5nLg0KICAgICAqLw0KICAgIHB1Ymxp\nYyBzdGF0aWMgSW50ZWdlciByYW5kb21JbnQoKSB7DQogICAgICAgIHJldHVy\nbiBuZXcgSW50ZWdlcigoaW50KSAoTWF0aC5yYW5kb20oKSAqIEludGVnZXIu\nTUFYX1ZBTFVFKSk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICogU3VwcG9y\ndCBtZXRob2QgdG8gZ2V0IGEgcmFuZG9tIENoYXJhY3RlciBmb3IgdGVzdGlu\nZy4NCiAgICAgKi8NCiAgICBwdWJsaWMgc3RhdGljIENoYXJhY3RlciByYW5k\nb21DaGFyKCkgew0KICAgICAgICBjaGFyIFtdIFRFU1RfQ0hBUl9BUlJBWSA9\nIG5ldyBjaGFyIFtdew0KICAgICAgICAgICAgJ2EnLCAnYicsICdjJywgJ2Qn\nLCAnZScsICdmJywgJ2cnLCAnaCcsICdpJywNCiAgICAgICAgICAgICdqJywg\nJ2snLCAnbCcsICdtJywgJ24nLCAnbycsICdwJywgJ3EnLCAncicsDQogICAg\nICAgICAgICAncycsICd0JywgJ3UnLCAndicsICd3JywgJ3gnLCAneScsICd6\nJywgJzEnLA0KICAgICAgICAgICAgJzInLCAnMycsICc0JywgJzUnLCAnNics\nICc3JywgJzgnLCAnOScgfTsNCg0KICAgICAgICByZXR1cm4gbmV3IENoYXJh\nY3RlcihURVNUX0NIQVJfQVJSQVlbDQogICAgICAgICAgICAgICAgKGludCkg\nKE1hdGgucmFuZG9tKCkgKiBURVNUX0NIQVJfQVJSQVkubGVuZ3RoKV0pOw0K\nICAgIH0NCg0KICAgIC8qKg0KICAgICAqIFN1cHBvcnQgbWV0aG9kIHRvIGdl\ndCBhIHJhbmRvbSBMb25nIGZvciB0ZXN0aW5nLg0KICAgICAqLw0KICAgIHB1\nYmxpYyBzdGF0aWMgTG9uZyByYW5kb21Mb25nKCkgew0KICAgICAgICByZXR1\ncm4gbmV3IExvbmcoKGxvbmcpIChNYXRoLnJhbmRvbSgpICogTG9uZy5NQVhf\nVkFMVUUpKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiBTdXBwb3J0IG1l\ndGhvZCB0byBnZXQgYSByYW5kb20gU2hvcnQgZm9yIHRlc3RpbmcuDQogICAg\nICovDQogICAgcHVibGljIHN0YXRpYyBTaG9ydCByYW5kb21TaG9ydCgpIHsN\nCiAgICAgICAgcmV0dXJuIG5ldyBTaG9ydCgoc2hvcnQpIChNYXRoLnJhbmRv\nbSgpICogU2hvcnQuTUFYX1ZBTFVFKSk7DQogICAgfQ0KDQogICAgLyoqDQog\nICAgICogU3VwcG9ydCBtZXRob2QgdG8gZ2V0IGEgcmFuZG9tIERvdWJsZSBm\nb3IgdGVzdGluZy4NCiAgICAgKi8NCiAgICBwdWJsaWMgc3RhdGljIERvdWJs\nZSByYW5kb21Eb3VibGUoKSB7DQogICAgICAgIHJldHVybiBuZXcgRG91Ymxl\nKChkb3VibGUpIChNYXRoLnJvdW5kKE1hdGgucmFuZG9tKCkgKiA1MDAwZCkp\nIC8gMTAwMGQpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIFN1cHBvcnQg\nbWV0aG9kIHRvIGdldCBhIHJhbmRvbSBGbG9hdCBmb3IgdGVzdGluZy4NCiAg\nICAgKi8NCiAgICBwdWJsaWMgc3RhdGljIEZsb2F0IHJhbmRvbUZsb2F0KCkg\new0KICAgICAgICByZXR1cm4gbmV3IEZsb2F0KChmbG9hdCkgKE1hdGgucm91\nbmQoTWF0aC5yYW5kb20oKSAqIDUwMDBmKSkgLyAxMDAwZik7DQogICAgfQ0K\nDQogICAgLyoqDQogICAgICogU3VwcG9ydCBtZXRob2QgdG8gZ2V0IGEgcmFu\nZG9tIEJ5dGUgZm9yIHRlc3RpbmcuDQogICAgICovDQogICAgcHVibGljIHN0\nYXRpYyBCeXRlIHJhbmRvbUJ5dGUoKSB7DQogICAgICAgIHJldHVybiBuZXcg\nQnl0ZSgoYnl0ZSkgKE1hdGgucmFuZG9tKCkgKiBCeXRlLk1BWF9WQUxVRSkp\nOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIFN1cHBvcnQgbWV0aG9kIHRv\nIGdldCBhIHJhbmRvbSBCb29sZWFuIGZvciB0ZXN0aW5nLg0KICAgICAqLw0K\nICAgIHB1YmxpYyBzdGF0aWMgQm9vbGVhbiByYW5kb21Cb29sZWFuKCkgew0K\nICAgICAgICByZXR1cm4gbmV3IEJvb2xlYW4oTWF0aC5yYW5kb20oKSA+IDAu\nNSA/IHRydWUgOiBmYWxzZSk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog\nU3VwcG9ydCBtZXRob2QgdG8gZ2V0IGEgcmFuZG9tIERhdGUgZm9yIHRlc3Rp\nbmcuDQogICAgICovDQogICAgcHVibGljIHN0YXRpYyBEYXRlIHJhbmRvbURh\ndGUoKSB7DQogICAgICAgIGxvbmcgbWlsbGlzID0gKGxvbmcpIChNYXRoLnJh\nbmRvbSgpICogU3lzdGVtLmN1cnJlbnRUaW1lTWlsbGlzKCkpOw0KDQogICAg\nICAgIC8vIHJvdW5kIG1pbGxpcyB0byB0aGUgbmVhcmVzdCAxMDAwOiB0aGlz\nIGlzIGJlY2F1c2Ugc29tZQ0KICAgICAgICAvLyBkYXRhYmFzZXMgZG8gbm90\nIHN0b3JlIHRoZSBtaWxsaXNlY29uZHMgY29ycmVjdGx5IChlLmcuLCBNeVNR\nTCkuDQogICAgICAgIC8vIFRoaXMgaXMgYSByZWFsbHkgYSBidWcgd2Ugc2hv\ndWxkIGZpeC4gRkMgIzI3Lg0KICAgICAgICBtaWxsaXMgLT0gKG1pbGxpcyAl\nIDEwMDApOw0KDQogICAgICAgIHJldHVybiBuZXcgRGF0ZShtaWxsaXMpOw0K\nICAgIH0NCg0KICAgIC8qKg0KICAgICAqIFN1cHBvcnQgbWV0aG9kIHRvIGdl\ndCBhIHJhbmRvbSBTdHJpbmcgZm9yIHRlc3RpbmcuDQogICAgICovDQogICAg\ncHVibGljIHN0YXRpYyBTdHJpbmcgcmFuZG9tU3RyaW5nKCkgew0KICAgICAg\nICAvLyBkZWZhdWx0IHRvIGEgc21hbGwgc3RyaW5nLCBpbiBjYXNlIGNvbHVt\nbiBzaXplcyBhcmUNCiAgICAgICAgLy8gbGltaXRlZCAoc3VjaCBhcyB3aXRo\nIGEgc3RyaW5nIHByaW1hcnkga2V5KQ0KICAgICAgICByZXR1cm4gcmFuZG9t\nU3RyaW5nKDUwKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiBTdXBwb3J0\nIG1ldGhvZCB0byBnZXQgYSByYW5kb20gU3RyaW5nIGZvciB0ZXN0aW5nLg0K\nICAgICAqLw0KICAgIHB1YmxpYyBzdGF0aWMgU3RyaW5nIHJhbmRvbVN0cmlu\nZyhpbnQgbGVuKSB7DQogICAgICAgIFN0cmluZ0J1ZmZlciBidWYgPSBuZXcg\nU3RyaW5nQnVmZmVyKCk7DQogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwg\nKGludCkgKE1hdGgucmFuZG9tKCkgKiBsZW4pICsgMTsgaSsrKQ0KICAgICAg\nICAgICAgYnVmLmFwcGVuZChyYW5kb21DaGFyKCkpOw0KICAgICAgICByZXR1\ncm4gYnVmLnRvU3RyaW5nKCk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog\nU3VwcG9ydCBtZXRob2QgdG8gZ2V0IGEgcmFuZG9tIGNsb2IgZm9yIHRlc3Rp\nbmcuDQogICAgICovDQogICAgcHVibGljIHN0YXRpYyBTdHJpbmcgcmFuZG9t\nQ2xvYigpIHsNCiAgICAgICAgU3RyaW5nQnVmZmVyIHNidWYgPSBuZXcgU3Ry\naW5nQnVmZmVyKCk7DQogICAgICAgIHdoaWxlIChzYnVmLmxlbmd0aCgpIDwg\nKDUgKiAxMDI0KSkgLy8gYXQgbGVhc3QgNUsNCiAgICAgICAgew0KICAgICAg\nICAgICAgc2J1Zi5hcHBlbmQocmFuZG9tU3RyaW5nKDEwMjQpKTsNCiAgICAg\nICAgfQ0KDQogICAgICAgIHJldHVybiBzYnVmLnRvU3RyaW5nKCk7DQogICAg\nfQ0KDQogICAgLyoqDQogICAgICogU3VwcG9ydCBtZXRob2QgdG8gZ2V0IGEg\ncmFuZG9tIEJpZ0ludGVnZXIgZm9yIHRlc3RpbmcuDQogICAgICovDQogICAg\ncHVibGljIHN0YXRpYyBCaWdJbnRlZ2VyIHJhbmRvbUJpZ0ludGVnZXIoKSB7\nDQogICAgICAgIC8vIHRvbyBtYW55IG9mIG91ciB0ZXN0IGRhdGFiYXNlcyBk\nb24ndCBzdXBwb3J0IGJpZ2ludHMgPiBNQVhfTE9ORzoNCiAgICAgICAgLy8g\nSSBkb24ndCBsaWtlIGl0LCBidXQgZm9yIG5vdywgbGV0J3Mgb25seSB0ZXN0\nIGJlbG93IE1BWF9MT05HDQogICAgICAgIEJpZ0ludGVnZXIgbG5nID0gbmV3\nIEJpZ0ludGVnZXIoDQogICAgICAgICAgICAgICAgKChsb25nKSAoTWF0aC5y\nYW5kb20oKSAqIExvbmcuTUFYX1ZBTFVFKSkgKyAiIik7DQoNCiAgICAgICAg\nQmlnSW50ZWdlciBtdWx0aXBsaWVyID0gbmV3IEJpZ0ludGVnZXIoIjEiKTsN\nCiAgICAgICAgLy8gKDEgKyAoaW50KShNYXRoLnJhbmRvbSAoKSAqIDEwMDAw\nKSkgKyAiIik7DQogICAgICAgIGlmIChNYXRoLnJhbmRvbSgpIDwgMC41KQ0K\nICAgICAgICAgICAgbXVsdGlwbGllciA9IG11bHRpcGxpZXIubXVsdGlwbHko\nbmV3IEJpZ0ludGVnZXIoIi0xIikpOw0KDQogICAgICAgIHJldHVybiBsbmcu\nbXVsdGlwbHkobXVsdGlwbGllcik7DQogICAgfQ0KDQogICAgLyoqDQogICAg\nICogU3VwcG9ydCBtZXRob2QgdG8gZ2V0IGEgcmFuZG9tIEJpZ0RlY2ltYWwg\nZm9yIHRlc3RpbmcuDQogICAgICovDQogICAgcHVibGljIHN0YXRpYyBCaWdE\nZWNpbWFsIHJhbmRvbUJpZ0RlY2ltYWwoKSB7DQogICAgICAgIEJpZ0ludGVn\nZXIgc3RhcnQgPSByYW5kb21CaWdJbnRlZ2VyKCk7DQogICAgICAgIFN0cmlu\nZyBzdHIgPSBzdGFydC50b1N0cmluZygpOw0KICAgICAgICAvLyB0cnVuY2F0\nZSBvZmYgdGhlIGxhc3QgOCBkaWdpdHM6IHdlIHN0aWxsIGdldCBzb21lDQog\nICAgICAgIC8vIG92ZXJmbG93cyB3aXRoIGxhbWUgZGF0YWJhc2VzLg0KICAg\nICAgICBmb3IgKGludCBpID0gMDsgaSA8IDg7IGkrKykNCiAgICAgICAgICAg\nIGlmIChzdHIubGVuZ3RoKCkgPiAyKQ0KICAgICAgICAgICAgICAgIHN0ciA9\nIHN0ci5zdWJzdHJpbmcoMCwgc3RyLmxlbmd0aCgpIC0gMSk7DQogICAgICAg\nIHN0YXJ0ID0gbmV3IEJpZ0ludGVnZXIoc3RyKTsNCg0KICAgICAgICBTdHJp\nbmcgdmFsID0gc3RhcnQgKyAiLiINCiAgICAgICAgICAgICAgICArICgoaW50\nKSAoTWF0aC5yYW5kb20oKSAqIDEwKSkNCiAgICAgICAgICAgICAgICArICgo\naW50KSAoTWF0aC5yYW5kb20oKSAqIDEwKSkNCiAgICAgICAgICAgICAgICAr\nICgoaW50KSAoTWF0aC5yYW5kb20oKSAqIDEwKSkNCiAgICAgICAgICAgICAg\nICArICgoaW50KSAoTWF0aC5yYW5kb20oKSAqIDEwKSkNCiAgICAgICAgICAg\nICAgICArICgoaW50KSAoTWF0aC5yYW5kb20oKSAqIDEwKSkNCiAgICAgICAg\nICAgICAgICArICgoaW50KSAoTWF0aC5yYW5kb20oKSAqIDEwKSkNCiAgICAg\nICAgICAgICAgICArICgoaW50KSAoTWF0aC5yYW5kb20oKSAqIDEwKSkNCiAg\nICAgICAgICAgICAgICArICgoaW50KSAoTWF0aC5yYW5kb20oKSAqIDEwKSkN\nCiAgICAgICAgICAgICAgICArICgoaW50KSAoTWF0aC5yYW5kb20oKSAqIDEw\nKSkNCiAgICAgICAgICAgICAgICArICgoaW50KSAoTWF0aC5yYW5kb20oKSAq\nIDEwKSk7DQoNCiAgICAgICAgcmV0dXJuIG5ldyBCaWdEZWNpbWFsKHZhbCk7\nDQogICAgfQ0KDQogICAgLyoqDQogICAgICogU3VwcG9ydCBtZXRob2QgdG8g\nZ2V0IGEgcmFuZG9tIGJsb2IgZm9yIHRlc3RpbmcuDQogICAgICovDQogICAg\ncHVibGljIHN0YXRpYyBieXRlW10gcmFuZG9tQmxvYigpIHsNCiAgICAgICAg\nLy8gdXAgdG8gMTAwSyBibG9iDQogICAgICAgIGJ5dGUgW10gYmxvYiA9IG5l\ndyBieXRlIFsoaW50KSAoTWF0aC5yYW5kb20oKSAqIDEwMjQgKiAxMDApXTsN\nCiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBibG9iLmxlbmd0aDsgaSsr\nKQ0KICAgICAgICAgICAgYmxvYltpXSA9IHJhbmRvbUJ5dGUoKS5ieXRlVmFs\ndWUoKTsNCg0KICAgICAgICByZXR1cm4gYmxvYjsNCiAgICB9DQoNCiAgICAv\nKioNCiAgICAgKiBJbnZva2Ugc2V0dGVycyBmb3IgcGltaXRpdmVzIGFuZCBw\ncmltaXRpdmUgd3JhcHBlcnMgb24gdGhlDQogICAgICogc3BlY2lmaWVkIG9i\namVjdC4NCiAgICAgKi8NCiAgICBwdWJsaWMgc3RhdGljIE9iamVjdCByYW5k\nb21pemVCZWFuKE9iamVjdCBiZWFuKQ0KICAgIHRocm93cyBJbnRyb3NwZWN0\naW9uRXhjZXB0aW9uLCBJbGxlZ2FsQWNjZXNzRXhjZXB0aW9uLA0KICAgICAg\nICBJbnZvY2F0aW9uVGFyZ2V0RXhjZXB0aW9uLCBqYXZhLmJlYW5zLkludHJv\nc3BlY3Rpb25FeGNlcHRpb24gew0KICAgICAgICBCZWFuSW5mbyBpbmZvID0g\nSW50cm9zcGVjdG9yLmdldEJlYW5JbmZvKGJlYW4uZ2V0Q2xhc3MoKSk7DQog\nICAgICAgIFByb3BlcnR5RGVzY3JpcHRvcltdIHByb3BzID0gaW5mby5nZXRQ\ncm9wZXJ0eURlc2NyaXB0b3JzKCk7DQogICAgICAgIGZvciAoaW50IGkgPSAw\nOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsNCiAgICAgICAgICAgIE1ldGhv\nZCB3cml0ZSA9IHByb3BzW2ldLmdldFdyaXRlTWV0aG9kKCk7DQogICAgICAg\nICAgICBpZiAod3JpdGUgPT0gbnVsbCkNCiAgICAgICAgICAgICAgICBjb250\naW51ZTsNCg0KICAgICAgICAgICAgQ2xhc3MgW10gcGFyYW1zID0gd3JpdGUu\nZ2V0UGFyYW1ldGVyVHlwZXMoKTsNCiAgICAgICAgICAgIGlmIChwYXJhbXMg\nPT0gbnVsbCB8fCBwYXJhbXMubGVuZ3RoICE9IDEpDQogICAgICAgICAgICAg\nICAgY29udGludWU7DQoNCiAgICAgICAgICAgIENsYXNzIHBhcmFtVHlwZSA9\nIHBhcmFtc1swXTsNCiAgICAgICAgICAgIE9iamVjdCBhcmcgPSBudWxsOw0K\nDQogICAgICAgICAgICBpZiAocGFyYW1UeXBlID09IGJvb2xlYW4uY2xhc3Mg\nfHwgcGFyYW1UeXBlID09IEJvb2xlYW4uY2xhc3MpDQogICAgICAgICAgICAg\nICAgYXJnID0gcmFuZG9tQm9vbGVhbigpOw0KICAgICAgICAgICAgZWxzZSBp\nZiAocGFyYW1UeXBlID09IGJ5dGUuY2xhc3MgfHwgcGFyYW1UeXBlID09IEJ5\ndGUuY2xhc3MpDQogICAgICAgICAgICAgICAgYXJnID0gcmFuZG9tQnl0ZSgp\nOw0KICAgICAgICAgICAgZWxzZSBpZiAocGFyYW1UeXBlID09IGNoYXIuY2xh\nc3MgfHwgcGFyYW1UeXBlID09IENoYXJhY3Rlci5jbGFzcykNCiAgICAgICAg\nICAgICAgICBhcmcgPSByYW5kb21DaGFyKCk7DQogICAgICAgICAgICBlbHNl\nIGlmIChwYXJhbVR5cGUgPT0gc2hvcnQuY2xhc3MgfHwgcGFyYW1UeXBlID09\nIFNob3J0LmNsYXNzKQ0KICAgICAgICAgICAgICAgIGFyZyA9IHJhbmRvbVNo\nb3J0KCk7DQogICAgICAgICAgICBlbHNlIGlmIChwYXJhbVR5cGUgPT0gaW50\nLmNsYXNzIHx8IHBhcmFtVHlwZSA9PSBJbnRlZ2VyLmNsYXNzKQ0KICAgICAg\nICAgICAgICAgIGFyZyA9IHJhbmRvbUludCgpOw0KICAgICAgICAgICAgZWxz\nZSBpZiAocGFyYW1UeXBlID09IGxvbmcuY2xhc3MgfHwgcGFyYW1UeXBlID09\nIExvbmcuY2xhc3MpDQogICAgICAgICAgICAgICAgYXJnID0gcmFuZG9tTG9u\nZygpOw0KICAgICAgICAgICAgZWxzZSBpZiAocGFyYW1UeXBlID09IGRvdWJs\nZS5jbGFzcyB8fCBwYXJhbVR5cGUgPT0gRG91YmxlLmNsYXNzKQ0KICAgICAg\nICAgICAgICAgIGFyZyA9IHJhbmRvbURvdWJsZSgpOw0KICAgICAgICAgICAg\nZWxzZSBpZiAocGFyYW1UeXBlID09IGZsb2F0LmNsYXNzIHx8IHBhcmFtVHlw\nZSA9PSBGbG9hdC5jbGFzcykNCiAgICAgICAgICAgICAgICBhcmcgPSByYW5k\nb21GbG9hdCgpOw0KICAgICAgICAgICAgZWxzZSBpZiAocGFyYW1UeXBlID09\nIFN0cmluZy5jbGFzcykNCiAgICAgICAgICAgICAgICBhcmcgPSByYW5kb21T\ndHJpbmcoKTsNCiAgICAgICAgICAgIGVsc2UgaWYgKHBhcmFtVHlwZSA9PSBC\naWdJbnRlZ2VyLmNsYXNzKQ0KICAgICAgICAgICAgICAgIGFyZyA9IHJhbmRv\nbUJpZ0ludGVnZXIoKTsNCiAgICAgICAgICAgIGVsc2UgaWYgKHBhcmFtVHlw\nZSA9PSBCaWdEZWNpbWFsLmNsYXNzKQ0KICAgICAgICAgICAgICAgIGFyZyA9\nIHJhbmRvbUJpZ0RlY2ltYWwoKTsNCiAgICAgICAgICAgIGVsc2UgaWYgKHBh\ncmFtVHlwZSA9PSBEYXRlLmNsYXNzKQ0KICAgICAgICAgICAgICAgIGFyZyA9\nIHJhbmRvbURhdGUoKTsNCg0KICAgICAgICAgICAgaWYgKGFyZyAhPSBudWxs\nKQ0KICAgICAgICAgICAgICAgIHdyaXRlLmludm9rZShiZWFuLCBuZXcgT2Jq\nZWN0IFtdeyBhcmcgfSk7DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4g\nYmVhbjsNCiAgICB9DQoNCiAgICBwcm90ZWN0ZWQgdm9pZCBhc3NlcnRTaXpl\nKGludCBzaXplLCBDb2xsZWN0aW9uIGMpIHsNCiAgICAgICAgYXNzZXJ0RXF1\nYWxzKHNpemUsIGMuc2l6ZSgpKTsNCiAgICB9DQoNCiAgICBwcm90ZWN0ZWQg\ndm9pZCBhc3NlcnRTaXplKGludCBzaXplLCBRdWVyeSBxKSB7DQogICAgICAg\nIGFzc2VydEVxdWFscyhzaXplLCBxLmdldFJlc3VsdExpc3QoKS5zaXplKCkp\nOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIFNlcmlhbGl6ZSBhbmQgZGVz\nZXJpYWxpemUgdGhlIG9iamVjdC4NCiAgICAgKg0KICAgICAqIEBwYXJhbSB2\nYWxpZGF0ZUVxdWFsaXR5IG1ha2Ugc3VyZSB0aGUgaGFzaENvZGUgYW5kIGVx\ndWFscw0KICAgICAqIG1ldGhvZHMgaG9sZCB0cnVlDQogICAgICovDQogICAg\ncHVibGljIHN0YXRpYyBPYmplY3Qgcm91bmR0cmlwKE9iamVjdCBvcmlnLCBi\nb29sZWFuIHZhbGlkYXRlRXF1YWxpdHkpDQogICAgICAgIHRocm93cyBJT0V4\nY2VwdGlvbiwgQ2xhc3NOb3RGb3VuZEV4Y2VwdGlvbiB7DQogICAgICAgIGFz\nc2VydE5vdE51bGwob3JpZyk7DQoNCiAgICAgICAgQnl0ZUFycmF5T3V0cHV0\nU3RyZWFtIGJvdXQgPSBuZXcgQnl0ZUFycmF5T3V0cHV0U3RyZWFtKCk7DQog\nICAgICAgIE9iamVjdE91dHB1dFN0cmVhbSBvdXQgPSBuZXcgT2JqZWN0T3V0\ncHV0U3RyZWFtKGJvdXQpOw0KICAgICAgICBvdXQud3JpdGVPYmplY3Qob3Jp\nZyk7DQogICAgICAgIEJ5dGVBcnJheUlucHV0U3RyZWFtIGJpbiA9IG5ldyBC\neXRlQXJyYXlJbnB1dFN0cmVhbSgNCiAgICAgICAgICAgIGJvdXQudG9CeXRl\nQXJyYXkoKSk7DQogICAgICAgIE9iamVjdElucHV0U3RyZWFtIGluID0gbmV3\nIE9iamVjdElucHV0U3RyZWFtKGJpbik7DQogICAgICAgIE9iamVjdCByZXN1\nbHQgPSBpbi5yZWFkT2JqZWN0KCk7DQoNCiAgICAgICAgaWYgKHZhbGlkYXRl\nRXF1YWxpdHkpIHsNCiAgICAgICAgICAgIGFzc2VydEVxdWFscyhvcmlnLmhh\nc2hDb2RlKCksIHJlc3VsdC5oYXNoQ29kZSgpKTsNCiAgICAgICAgICAgIGFz\nc2VydEVxdWFscyhvcmlnLCByZXN1bHQpOw0KICAgICAgICB9DQoNCiAgICAg\nICAgcmV0dXJuIHJlc3VsdDsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiBA\ncmV0dXJuIHRydWUgaWYgdGhlIHNwZWNpZmllZCBpbnB1dCBtYXRjaGVzIHRo\nZSByZWd1bGFyIGV4cHJlc3Npb24gcmVnZXguDQogICAgICovDQogICAgcHVi\nbGljIHN0YXRpYyBib29sZWFuIG1hdGNoZXMoU3RyaW5nIHJlZ2V4LCBTdHJp\nbmcgaW5wdXQpDQogICAgICAgIHRocm93cyBSRVN5bnRheEV4Y2VwdGlvbiB7\nDQogICAgICAgIFJFIHJlID0gUkVVdGlsLmNyZWF0ZVJFKHJlZ2V4KTsNCiAg\nICAgICAgcmV0dXJuIHJlLm1hdGNoKGlucHV0KTsNCiAgICB9DQoNCiAgICBw\ndWJsaWMgc3RhdGljIHZvaWQgYXNzZXJ0TWF0Y2hlcyhTdHJpbmcgcmVnZXgs\nIFN0cmluZyBpbnB1dCkgew0KICAgICAgICB0cnkgew0KICAgICAgICAgICAg\naWYgKCEobWF0Y2hlcyhyZWdleCwgaW5wdXQpKSkNCiAgICAgICAgICAgICAg\nICBmYWlsKCJFeHBlY3RlZCByZWd1bGFyIGV4cHJlc3Npb246IDwiICsgcmVn\nZXggKyAiPiINCiAgICAgICAgICAgICAgICAgICAgKyAiIGRpZCBub3QgbWF0\nY2g6IDwiICsgaW5wdXQgKyAiPiIpOw0KICAgICAgICB9IGNhdGNoIChSRVN5\nbnRheEV4Y2VwdGlvbiBlKSB7DQogICAgICAgICAgICB0aHJvdyBuZXcgSWxs\nZWdhbEFyZ3VtZW50RXhjZXB0aW9uKGUudG9TdHJpbmcoKSk7DQogICAgICAg\nIH0NCiAgICB9DQoNCiAgICBwdWJsaWMgc3RhdGljIHZvaWQgYXNzZXJ0Tm90\nTWF0Y2hlcyhTdHJpbmcgcmVnZXgsIFN0cmluZyBpbnB1dCkgew0KICAgICAg\nICB0cnkgew0KICAgICAgICAgICAgaWYgKG1hdGNoZXMocmVnZXgsIGlucHV0\nKSkNCiAgICAgICAgICAgICAgICBmYWlsKCJSZWd1bGFyIGV4cHJlc3Npb246\nIDwiICsgcmVnZXggKyAiPiINCiAgICAgICAgICAgICAgICAgICAgKyAiIHNo\nb3VsZCBub3QgbWF0Y2g6IDwiICsgaW5wdXQgKyAiPiIpOw0KICAgICAgICB9\nIGNhdGNoIChSRVN5bnRheEV4Y2VwdGlvbiBlKSB7DQogICAgICAgICAgICB0\naHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uKGUudG9TdHJpbmco\nKSk7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiBDaGVj\nayB0aGUgbGlzdCBpZiBzdHJpbmdzIGFuZCByZXR1cm4gdGhlIG9uZXMgdGhh\ndCBtYXRjaA0KICAgICAqIHRoZSBzcGVjaWZpZWQgbWF0Y2guDQogICAgICov\nDQogICAgcHVibGljIHN0YXRpYyBMaXN0IG1hdGNoZXMoU3RyaW5nIHJlZ2V4\nLCBDb2xsZWN0aW9uIGlucHV0KQ0KICAgICAgICB0aHJvd3MgUkVTeW50YXhF\neGNlcHRpb24gew0KICAgICAgICBMaXN0IG1hdGNoZXMgPSBuZXcgQXJyYXlM\naXN0KCk7DQogICAgICAgIGZvciAoSXRlcmF0b3IgaSA9IGlucHV0Lml0ZXJh\ndG9yKCk7IGkuaGFzTmV4dCgpOykgew0KICAgICAgICAgICAgU3RyaW5nIGNo\nZWNrID0gKFN0cmluZykgaS5uZXh0KCk7DQogICAgICAgICAgICBpZiAobWF0\nY2hlcyhyZWdleCwgY2hlY2spKQ0KICAgICAgICAgICAgICAgIG1hdGNoZXMu\nYWRkKGNoZWNrKTsNCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiBtYXRj\naGVzOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIEFzc2VydCB0aGF0IHRo\nZSBzcGVjaWZpZWQgY29sbGVjdGlvbiBvZiBTdHJpbmdzIGNvbnRhaW5zIGF0\nIGxlYXN0DQogICAgICogb25lIHN0cmluZyB0aGF0IG1hdGNoZXMgdGhlIHNw\nZWNpZmllZCByZWd1bGFyIGV4cHJlc3Npb24uDQogICAgICovDQogICAgcHVi\nbGljIHN0YXRpYyB2b2lkIGFzc2VydE1hdGNoZXMoU3RyaW5nIHJlZ2V4LCBD\nb2xsZWN0aW9uIGlucHV0KSB7DQogICAgICAgIHRyeSB7DQogICAgICAgICAg\nICBpZiAobWF0Y2hlcyhyZWdleCwgaW5wdXQpLnNpemUoKSA9PSAwKQ0KICAg\nICAgICAgICAgICAgIGZhaWwoIlRoZSBzcGVjaWZpZWQgbGlzdCBvZiBzaXpl\nICIgKyBpbnB1dC5zaXplKCkNCiAgICAgICAgICAgICAgICAgICAgKyAiIGRp\nZCBub3QgY29udGFpbiBhbnkgc3RyaW5ncyB0aGF0IG1hdGNoIHRoZSINCiAg\nICAgICAgICAgICAgICAgICAgKyAiIHNwZWNpZmllZCByZWd1bGFyIGV4cHJl\nc3Npb24oXCIiICsgcmVnZXggKyAiXCIpIik7DQogICAgICAgIH0gY2F0Y2gg\nKFJFU3ludGF4RXhjZXB0aW9uIGUpIHsNCiAgICAgICAgICAgIHRocm93IG5l\ndyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24oZS50b1N0cmluZygpKTsNCiAg\nICAgICAgfQ0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIEFzc2VydCB0aGF0\nIHRoZSBzcGVjaWZpZWQgY29sbGVjdGlvbiBvZiBTdHJpbmdzIGRvZXMgbm90\nIG1hdGNoDQogICAgICogdGhlIHNwZWNpZmllZCByZWd1bGFyIGV4cHJlc3Np\nb24uDQogICAgICovDQogICAgcHVibGljIHN0YXRpYyB2b2lkIGFzc2VydE5v\ndE1hdGNoZXMoU3RyaW5nIHJlZ2V4LCBDb2xsZWN0aW9uIGlucHV0KSB7DQog\nICAgICAgIHRyeSB7DQogICAgICAgICAgICBMaXN0IG1hdGNoZXM7DQoNCiAg\nICAgICAgICAgIGlmICgoKG1hdGNoZXMgPSBtYXRjaGVzKHJlZ2V4LCBpbnB1\ndCkpKS5zaXplKCkgPiAwKQ0KICAgICAgICAgICAgICAgIGZhaWwoIlRoZSBz\ncGVjaWZpZWQgbGlzdCBvZiBzaXplICIgKyBpbnB1dC5zaXplKCkNCiAgICAg\nICAgICAgICAgICAgICAgKyAiIGRpZCBjb250YWluIG9uZSBvciBtb3JlIHN0\ncmluZ3MgdGhhdCBtYXRjaHMgdGhlIg0KICAgICAgICAgICAgICAgICAgICAr\nICIgc3BlY2lmaWVkIGlsbGVnYWwgcmVndWxhciBleHByZXNzaW9uIg0KICAg\nICAgICAgICAgICAgICAgICArICIgKFwiIiArIHJlZ2V4ICsgIlwiKS4iDQog\nICAgICAgICAgICAgICAgICAgICsgIiBGaXJzdCBleGFtcGxlIG9mIGEgbWF0\nY2hpbmcgbWVzc2FnZSBpczogIg0KICAgICAgICAgICAgICAgICAgICArIG1h\ndGNoZXMuaXRlcmF0b3IoKS5uZXh0KCkpOw0KICAgICAgICB9IGNhdGNoIChS\nRVN5bnRheEV4Y2VwdGlvbiBlKSB7DQogICAgICAgICAgICB0aHJvdyBuZXcg\nSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uKGUudG9TdHJpbmcoKSk7DQogICAg\nICAgIH0NCiAgICB9DQoNCiAgICBwcm90ZWN0ZWQgTG9nIGdldExvZygpIHsN\nCiAgICAgICAgcmV0dXJuIGdldENvbmZpZ3VyYXRpb24oKS5nZXRMb2coIlRl\nc3RzIik7DQogICAgfQ0KDQogICAgLy8vLy8vLy8vLy8vLy8vLy8vLw0KICAg\nIC8vIE11bHRpIHRocmVhZGluZw0KICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8N\nCg0KICAgIC8qKg0KICAgICAqIFJlLWV4ZWN1dGUgdGhlIGludm9raW5nIG1l\ndGhvZCBhIHJhbmRvbSBudW1iZXIgb2YgdGltZXMNCiAgICAgKiBpbiBhIHJh\nbmRvbSBudW1iZXIgb2YgVGhyZWFkcy4NCiAgICAgKi8NCiAgICBwdWJsaWMg\ndm9pZCBtdHRlc3QoKSB0aHJvd3MgVGhyZWFkaW5nRXhjZXB0aW9uIHsNCiAg\nICAgICAgLy8gNiBpdGVyYXRpb25zIGluIDggdGhyZWFkcyBpcyBhIGdvb2Qg\ndHJhZGUtb2ZmIGJldHdlZW4NCiAgICAgICAgLy8gdGVzdHMgdGFraW5nIHdh\neSB0b28gbG9uZyBhbmQgaGF2aW5nIGEgZGVjZW50IGNoYW5jZSBvZg0KICAg\nICAgICAvLyBpZGVudGlmeWluZyBNVCBwcm9ibGVtcy4NCiAgICAgICAgaW50\nIGl0ZXJhdGlvbnMgPSA2Ow0KICAgICAgICBpbnQgdGhyZWFkcyA9IDg7DQoN\nCiAgICAgICAgbXR0ZXN0KHRocmVhZHMsIGl0ZXJhdGlvbnMpOw0KICAgIH0N\nCg0KICAgIC8qKg0KICAgICAqIEV4ZWN1dGUgdGhlIGNhbGxpbmcgbWV0aG9k\nIDxjb2RlPml0ZXJhdGlvbnM8L2NvZGU+DQogICAgICogdGltZXMgaW4gPGNv\nZGU+dGhyZWFkczwvY29kZT4gVGhyZWFkcy4NCiAgICAgKi8NCiAgICBwdWJs\naWMgdm9pZCBtdHRlc3QoaW50IHRocmVhZHMsIGludCBpdGVyYXRpb25zKSB7\nDQogICAgICAgIG10dGVzdCgwLCB0aHJlYWRzLCBpdGVyYXRpb25zKTsNCiAg\nICB9DQoNCiAgICBwdWJsaWMgdm9pZCBtdHRlc3QoaW50IHNlcmlhbENvdW50\nLCBpbnQgdGhyZWFkcywgaW50IGl0ZXJhdGlvbnMpDQogICAgICAgIHRocm93\ncyBUaHJlYWRpbmdFeGNlcHRpb24gew0KICAgICAgICBTdHJpbmcgbWV0aG9k\nTmFtZSA9IGNhbGxpbmdNZXRob2QoIm10dGVzdCIpOw0KICAgICAgICBtdHRl\nc3Qoc2VyaWFsQ291bnQsIHRocmVhZHMsIGl0ZXJhdGlvbnMsIG1ldGhvZE5h\nbWUsIG5ldyBPYmplY3QgWzBdKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAg\nKiBFeGVjdXRlIGEgdGVzdCBtZXRob2QgaW4gbXVsdGlwbGUgdGhyZWFkcy4N\nCiAgICAgKg0KICAgICAqIEBwYXJhbSB0aHJlYWRzIHRoZSBudW1iZXIgb2Yg\nVGhyZWFkcyB0byBydW4gaW4NCiAgICAgKiBAcGFyYW0gaXRlcmF0aW9ucyB0\naGUgbnVtYmVyIG9mIHRpbWVzIHRoZSBtZXRob2Qgc2hvdWxkDQogICAgICog\nYmUgZXhlY3V0ZSBpbiBhIHNpbmdsZSBUaHJlYWQNCiAgICAgKiBAcGFyYW0g\nbWV0aG9kIHRoZSBuYW1lIG9mIHRoZSBtZXRob2QgdG8gZXhlY3V0ZQ0KICAg\nICAqIEBwYXJhbSBhcmdzIHRoZSBhcmd1bWVudHMgdG8gcGFzcyB0byB0aGUg\nbWV0aG9kDQogICAgICogQHRocm93cyBUaHJlYWRpbmdFeGNlcHRpb24gaWYg\nYW4gZXJyb3JzIG9jY3VyIGluDQogICAgICogYW55IG9mIHRoZSBUaHJlYWRz\nLiBUaGUgYWN0dWFsIGV4Y2VwdGlvbnMNCiAgICAgKiB3aWxsIGJlIGVtYmVk\nZGVkIGluIHRoZSBleGNlcHRpb24uIE5vdGUgdGhhdA0KICAgICAqIHRoaXMg\nbWVhbnMgdGhhdCBhc3NlcnQoKSBmYWlsdXJlcyB3aWxsIGJlDQogICAgICog\ndHJlYXRlZCBhcyBlcnJvcnMgcmF0aGVyIHRoYW4gd2FybmluZ3MuDQogICAg\nICogQGF1dGhvciBNYXJjIFBydWQnaG9tbWVhdXgNCiAgICAgKi8NCiAgICBw\ndWJsaWMgdm9pZCBtdHRlc3QoaW50IHRocmVhZHMsIGludCBpdGVyYXRpb25z\nLCBmaW5hbCBTdHJpbmcgbWV0aG9kLA0KICAgICAgICBmaW5hbCBPYmplY3Qg\nW10gYXJncykgdGhyb3dzIFRocmVhZGluZ0V4Y2VwdGlvbiB7DQogICAgICAg\nIG10dGVzdCgwLCB0aHJlYWRzLCBpdGVyYXRpb25zLCBtZXRob2QsIGFyZ3Mp\nOw0KICAgIH0NCg0KICAgIHB1YmxpYyB2b2lkIG10dGVzdChpbnQgc2VyaWFs\nQ291bnQsDQogICAgICAgIGludCB0aHJlYWRzLCBpbnQgaXRlcmF0aW9ucywg\nZmluYWwgU3RyaW5nIG1ldGhvZCwgZmluYWwgT2JqZWN0IFtdIGFyZ3MpDQog\nICAgICAgIHRocm93cyBUaHJlYWRpbmdFeGNlcHRpb24gew0KICAgICAgICBp\nZiAobXVsdGlUaHJlYWRFeGVjdXRpbmcgIT0gbnVsbCAmJiBtdWx0aVRocmVh\nZEV4ZWN1dGluZy5lcXVhbHMobWV0aG9kKSkNCiAgICAgICAgew0KICAgICAg\nICAgICAgLy8gd2UgYXJlIGN1cnJlbnRseSBleGVjdXRpbmcgaW4gbXVsdGkt\ndGhyZWFkZWQgbW9kZToNCiAgICAgICAgICAgIC8vIGRvbid0IGRlYWRsb2Nr\nIQ0KICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICB9DQoNCiAgICAgICAg\nbXVsdGlUaHJlYWRFeGVjdXRpbmcgPSBtZXRob2Q7DQoNCiAgICAgICAgdHJ5\nIHsNCiAgICAgICAgICAgIENsYXNzIFtdIHBhcmFtQ2xhc3NlcyA9IG5ldyBD\nbGFzcyBbYXJncy5sZW5ndGhdOw0KICAgICAgICAgICAgZm9yIChpbnQgaSA9\nIDA7IGkgPCBwYXJhbUNsYXNzZXMubGVuZ3RoOyBpKyspDQogICAgICAgICAg\nICAgICAgcGFyYW1DbGFzc2VzW2ldID0gYXJnc1tpXS5nZXRDbGFzcygpOw0K\nDQogICAgICAgICAgICBmaW5hbCBNZXRob2QgbWV0aDsNCg0KICAgICAgICAg\nICAgdHJ5IHsNCiAgICAgICAgICAgICAgICBtZXRoID0gZ2V0Q2xhc3MoKS5n\nZXRNZXRob2QobWV0aG9kLCBwYXJhbUNsYXNzZXMpOw0KICAgICAgICAgICAg\nfSBjYXRjaCAoTm9TdWNoTWV0aG9kRXhjZXB0aW9uIG5zbWUpIHsNCiAgICAg\nICAgICAgICAgICB0aHJvdyBuZXcgVGhyZWFkaW5nRXhjZXB0aW9uKG5zbWUu\ndG9TdHJpbmcoKSwgbnNtZSk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAg\nICAgIGZpbmFsIE9iamVjdCB0aGl6ID0gdGhpczsNCg0KICAgICAgICAgICAg\nbXR0ZXN0KCJyZWZsZWN0aW9uIGludm9jYXRpb246ICgiICsgbWV0aG9kICsg\nIikiLA0KICAgICAgICAgICAgICAgIHNlcmlhbENvdW50LCB0aHJlYWRzLCBp\ndGVyYXRpb25zLCBuZXcgVm9sYXRpbGVSdW5uYWJsZSgpIHsNCiAgICAgICAg\nICAgICAgICBwdWJsaWMgdm9pZCBydW4oKSB0aHJvd3MgRXhjZXB0aW9uIHsN\nCiAgICAgICAgICAgICAgICAgICAgbWV0aC5pbnZva2UodGhpeiwgYXJncyk7\nDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSk7DQogICAgICAg\nIH0gZmluYWxseSB7DQogICAgICAgICAgICBtdWx0aVRocmVhZEV4ZWN1dGlu\nZyA9IG51bGw7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICBwdWJsaWMgdm9p\nZCBtdHRlc3QoU3RyaW5nIHRpdGxlLCBmaW5hbCBpbnQgdGhyZWFkcywgZmlu\nYWwgaW50IGl0ZXJhdGlvbnMsDQogICAgICAgIGZpbmFsIFZvbGF0aWxlUnVu\nbmFibGUgcnVubmVyKSB0aHJvd3MgVGhyZWFkaW5nRXhjZXB0aW9uIHsNCiAg\nICAgICAgbXR0ZXN0KHRpdGxlLCAwLCB0aHJlYWRzLCBpdGVyYXRpb25zLCBy\ndW5uZXIpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIEV4ZWN1dGUgYSB0\nZXN0IG1ldGhvZCBpbiBtdWx0aXBsZSB0aHJlYWRzLg0KICAgICAqDQogICAg\nICogQHBhcmFtIHRpdGxlIGEgZGVzY3JpcHRpb24gb2YgdGhlIHRlc3QsIGZv\nciBpbmNsdXNpb24gaW4gdGhlDQogICAgICogZXJyb3IgbWVzc2FnZQ0KICAg\nICAqIEBwYXJhbSBzZXJpYWxDb3VudCB0aGUgbnVtYmVyIG9mIHRpbWVzIHRv\nIHJ1biB0aGUgbWV0aG9kDQogICAgICogc2VyaWFsbHkgYmVmb3JlIHNwYXdu\naW5nIHRocmVhZHMuDQogICAgICogQHBhcmFtIHRocmVhZHMgdGhlIG51bWJl\nciBvZiBUaHJlYWRzIHRvIHJ1biBpbg0KICAgICAqIEBwYXJhbSBpdGVyYXRp\nb25zIHRoZSBudW1iZXIgb2YgdGltZXMgdGhlIG1ldGhvZCBzaG91bGQNCiAg\nICAgKiBAcGFyYW0gcnVubmVyIHRoZSBWb2xhdGlsZVJ1bm5hYmxlIHRoYXQg\nd2lsbCBleGVjdXRlDQogICAgICogdGhlIGFjdHVhbCB0ZXN0IGZyb20gd2l0\naGluIHRoZSBUaHJlYWQuDQogICAgICogQHRocm93cyBUaHJlYWRpbmdFeGNl\ncHRpb24gaWYgYW4gZXJyb3JzIG9jY3VyIGluDQogICAgICogYW55IG9mIHRo\nZSBUaHJlYWRzLiBUaGUgYWN0dWFsIGV4Y2VwdGlvbnMNCiAgICAgKiB3aWxs\nIGJlIGVtYmVkZGVkIGluIHRoZSBleGNlcHRpb24uIE5vdGUgdGhhdA0KICAg\nICAqIHRoaXMgbWVhbnMgdGhhdCBhc3NlcnQoKSBmYWlsdXJlcyB3aWxsIGJl\nDQogICAgICogdHJlYXRlZCBhcyBlcnJvcnMgcmF0aGVyIHRoYW4gd2Fybmlu\nZ3MuDQogICAgICogQGF1dGhvciBNYXJjIFBydWQnaG9tbWVhdXggYmUgZXhl\nY3V0ZSBpbiBhIHNpbmdsZSBUaHJlYWQNCiAgICAgKiBAYXV0aG9yIE1hcmMg\nUHJ1ZCdob21tZWF1eA0KICAgICAqLw0KICAgIHB1YmxpYyB2b2lkIG10dGVz\ndChTdHJpbmcgdGl0bGUsIGZpbmFsIGludCBzZXJpYWxDb3VudCwNCiAgICAg\nICAgZmluYWwgaW50IHRocmVhZHMsIGZpbmFsIGludCBpdGVyYXRpb25zLCBm\naW5hbCBWb2xhdGlsZVJ1bm5hYmxlIHJ1bm5lcikNCiAgICAgICAgdGhyb3dz\nIFRocmVhZGluZ0V4Y2VwdGlvbiB7DQogICAgICAgIGZpbmFsIExpc3QgZXhj\nZXB0aW9ucyA9IENvbGxlY3Rpb25zLnN5bmNocm9uaXplZExpc3QobmV3IExp\nbmtlZExpc3QoKSk7DQoNCiAgICAgICAgVGhyZWFkIFtdIHJ1bm5lcnMgPSBu\nZXcgVGhyZWFkIFt0aHJlYWRzXTsNCg0KICAgICAgICBmaW5hbCBsb25nIHN0\nYXJ0TWlsbGlzID0gU3lzdGVtLmN1cnJlbnRUaW1lTWlsbGlzKCkgKyAxMDAw\nOw0KDQogICAgICAgIGZvciAoaW50IGkgPSAxOyBpIDw9IHRocmVhZHM7IGkr\nKykgew0KICAgICAgICAgICAgZmluYWwgaW50IHRoaXNUaHJlYWQgPSBpOw0K\nDQogICAgICAgICAgICBydW5uZXJzW2kgLSAxXSA9DQogICAgICAgICAgICAg\nICAgbmV3IFRocmVhZCh0aXRsZSArICIgWyIgKyBpICsgIiBvZiAiICsgdGhy\nZWFkcyArICJdIikgew0KICAgICAgICAgICAgICAgICAgICBwdWJsaWMgdm9p\nZCBydW4oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAvLyBkbyBvdXIg\nYmVzdCB0byBoYXZlIGFsbCB0aHJlYWRzIHN0YXJ0IGF0IHRoZSBleGFjdA0K\nICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2FtZSB0aW1lLiBUaGlzIGlz\nIGltcGVyZmVjdCwgYnV0IHRoZSBjbG9zZXIgd2UNCiAgICAgICAgICAgICAg\nICAgICAgICAgIC8vIGdldCB0byBldmVyeW9uZSBzdGFydGluZyBhdCB0aGUg\nc2FtZSB0aW1lLCB0aGUNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGJl\ndHRlciBjaGFuY2Ugd2UgaGF2ZSBmb3IgaWRlbnRpZnlpbmcgTVQgcHJvYmxl\nbXMuDQogICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoU3lzdGVtLmN1\ncnJlbnRUaW1lTWlsbGlzKCkgPCBzdGFydE1pbGxpcykNCiAgICAgICAgICAg\nICAgICAgICAgICAgICAgICB5aWVsZCgpOw0KDQogICAgICAgICAgICAgICAg\nICAgICAgICBpbnQgdGhpc0l0ZXJhdGlvbiA9IDE7DQogICAgICAgICAgICAg\nICAgICAgICAgICB0cnkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAg\nIGZvciAoOyB0aGlzSXRlcmF0aW9uIDw9IGl0ZXJhdGlvbnM7IHRoaXNJdGVy\nYXRpb24rKykNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7DQogICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGdvIGdvIGdvIQ0KICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICBydW5uZXIucnVuKCk7DQog\nICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAg\nICAgICAgICAgfSBjYXRjaCAoVGhyb3dhYmxlIGVycm9yKSB7DQogICAgICAg\nICAgICAgICAgICAgICAgICAgICAgc3luY2hyb25pemVkIChleGNlcHRpb25z\nKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGVtYmVk\nIHRoZSBleGNlcHRpb24gaW50byBzb21ldGhpbmcgdGhhdCBnaXZlcw0KICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB1cyBzb21lIG1vcmUg\naW5mb3JtYXRpb24gYWJvdXQgdGhlIHRocmVhZGluZw0KICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAvLyBlbnZpcm9ubWVudA0KICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICBleGNlcHRpb25zLmFkZChuZXcgVGhy\nZWFkaW5nRXhjZXB0aW9uKCJ0aHJlYWQ9Ig0KICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgKyB0aGlzLnRvU3RyaW5nKCkNCiAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICsgIjt0aHJlYWROdW09IiAr\nIHRoaXNUaHJlYWQNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICsgIjttYXhUaHJlYWRzPSIgKyB0aHJlYWRzDQogICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICArICI7aXRlcmF0aW9uPSIgKyB0aGlz\nSXRlcmF0aW9uDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICArICI7bWF4SXRlcmF0aW9ucz0iICsgaXRlcmF0aW9ucywgZXJyb3IpKTsN\nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAg\nICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAg\nICAgICAgICB9Ow0KICAgICAgICB9DQoNCiAgICAgICAgLy8gc3RhcnQgdGhl\nIHNlcmlhbCB0ZXN0cyhkb2VzIG5vdCBzcGF3biB0aGUgdGhyZWFkcykNCiAg\nICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBzZXJpYWxDb3VudDsgaSsrKSB7\nDQogICAgICAgICAgICBydW5uZXJzWzBdLnJ1bigpOw0KICAgICAgICB9DQoN\nCiAgICAgICAgLy8gc3RhcnQgdGhlIG11bHRpdGhyZWFkZWQNCiAgICAgICAg\nZm9yIChpbnQgaSA9IDA7IGkgPCB0aHJlYWRzOyBpKyspIHsNCiAgICAgICAg\nICAgIHJ1bm5lcnNbaV0uc3RhcnQoKTsNCiAgICAgICAgfQ0KDQogICAgICAg\nIC8vIHdhaXQgZm9yIHRoZW0gYWxsIHRvIGNvbXBsZXRlDQogICAgICAgIGZv\nciAoaW50IGkgPSAwOyBpIDwgdGhyZWFkczsgaSsrKSB7DQogICAgICAgICAg\nICB0cnkgew0KICAgICAgICAgICAgICAgIHJ1bm5lcnNbaV0uam9pbigpOw0K\nICAgICAgICAgICAgfSBjYXRjaCAoSW50ZXJydXB0ZWRFeGNlcHRpb24gZSkg\new0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKGV4\nY2VwdGlvbnMuc2l6ZSgpID09IDApDQogICAgICAgICAgICByZXR1cm47IC8v\nIHN3ZWVlZWVlZWV0OiBubyBlcnJvcnMNCg0KICAgICAgICAvLyBlbWJlZCBh\nbGwgdGhlIGV4Y2VwdGlvbnMgdGhhdCB3ZXJlIHRocm93cyBpbnRvIGENCiAg\nICAgICAgLy8gVGhyZWFkaW5nRXhjZXB0aW9uDQogICAgICAgIFRocm93YWJs\nZSBbXSBlcnJvcnMgPSAoVGhyb3dhYmxlIFtdKSBleGNlcHRpb25zLnRvQXJy\nYXkoDQogICAgICAgICAgICBuZXcgVGhyb3dhYmxlIFswXSk7DQogICAgICAg\nIHRocm93IG5ldyBUaHJlYWRpbmdFeGNlcHRpb24oIlRoZSAiDQogICAgICAg\nICAgICArIGVycm9ycy5sZW5ndGggKyAiIGVtYmVkZGVkIGVycm9ycyAiDQog\nICAgICAgICAgICArICJvY2N1cmVkIGluIHRoZSBleGVjdXRpb24gb2YgIiAr\nIGl0ZXJhdGlvbnMgKyAiIGl0ZXJhdGlvbnMgIg0KICAgICAgICAgICAgKyAi\nb2YgIiArIHRocmVhZHMgKyAiIHRocmVhZHM6IFsiICsgdGl0bGUgKyAiXSIs\nIGVycm9ycyk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICogQ2hlY2sgdG8g\nc2VlIGlmIHdlIGFyZSBpbiB0aGUgdG9wLWxldmVsIGV4ZWN1dGlvbiBzdGFj\nay4NCiAgICAgKi8NCiAgICBwdWJsaWMgYm9vbGVhbiBpc1Jvb3RUaHJlYWQo\nKSB7DQogICAgICAgIHJldHVybiBtdWx0aVRocmVhZEV4ZWN1dGluZyA9PSBu\ndWxsOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIEEgUnVubmFibGUgdGhh\ndCBjYW4gdGhyb3cgYW4gRXhjZXB0aW9uOiB1c2VkIHRvIHRlc3QgY2FzZXMu\nDQogICAgICovDQogICAgcHVibGljIHN0YXRpYyBpbnRlcmZhY2UgVm9sYXRp\nbGVSdW5uYWJsZSB7DQoNCiAgICAgICAgcHVibGljIHZvaWQgcnVuKCkgdGhy\nb3dzIEV4Y2VwdGlvbjsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiBFeGNl\ncHRpb24gZm9yIGVycm9ycyBjYXVnaHQgZHVyaW5nIHRocmVhZGluZyB0ZXN0\ncy4NCiAgICAgKi8NCiAgICBwdWJsaWMgY2xhc3MgVGhyZWFkaW5nRXhjZXB0\naW9uIGV4dGVuZHMgUnVudGltZUV4Y2VwdGlvbiB7DQoNCiAgICAgICAgcHJp\ndmF0ZSBmaW5hbCBUaHJvd2FibGVbXSBfbmVzdGVkOw0KDQogICAgICAgIHB1\nYmxpYyBUaHJlYWRpbmdFeGNlcHRpb24oU3RyaW5nIG1zZywgVGhyb3dhYmxl\nIG5lc3RlZCkgew0KICAgICAgICAgICAgc3VwZXIobXNnKTsNCiAgICAgICAg\nICAgIGlmIChuZXN0ZWQgPT0gbnVsbCkNCiAgICAgICAgICAgICAgICBfbmVz\ndGVkID0gbmV3IFRocm93YWJsZVswXTsNCiAgICAgICAgICAgIGVsc2UNCiAg\nICAgICAgICAgICAgICBfbmVzdGVkID0gbmV3IFRocm93YWJsZVtdeyBuZXN0\nZWQgfTsNCiAgICAgICAgfQ0KDQogICAgICAgIHB1YmxpYyBUaHJlYWRpbmdF\neGNlcHRpb24oU3RyaW5nIG1zZywgVGhyb3dhYmxlW10gbmVzdGVkKSB7DQog\nICAgICAgICAgICBzdXBlcihtc2cpOw0KICAgICAgICAgICAgaWYgKG5lc3Rl\nZCA9PSBudWxsKQ0KICAgICAgICAgICAgICAgIF9uZXN0ZWQgPSBuZXcgVGhy\nb3dhYmxlWzBdOw0KICAgICAgICAgICAgZWxzZQ0KICAgICAgICAgICAgICAg\nIF9uZXN0ZWQgPSBuZXN0ZWQ7DQogICAgICAgIH0NCg0KICAgICAgICBwdWJs\naWMgdm9pZCBwcmludFN0YWNrVHJhY2UoKSB7DQogICAgICAgICAgICBwcmlu\ndFN0YWNrVHJhY2UoU3lzdGVtLm91dCk7DQogICAgICAgIH0NCg0KICAgICAg\nICBwdWJsaWMgdm9pZCBwcmludFN0YWNrVHJhY2UoUHJpbnRTdHJlYW0gb3V0\nKSB7DQogICAgICAgICAgICBwcmludFN0YWNrVHJhY2UobmV3IFByaW50V3Jp\ndGVyKG91dCkpOw0KICAgICAgICB9DQoNCiAgICAgICAgcHVibGljIHZvaWQg\ncHJpbnRTdGFja1RyYWNlKFByaW50V3JpdGVyIG91dCkgew0KICAgICAgICAg\nICAgc3VwZXIucHJpbnRTdGFja1RyYWNlKG91dCk7DQogICAgICAgICAgICBm\nb3IgKGludCBpID0gMDsgaSA8IF9uZXN0ZWQubGVuZ3RoOyBpKyspIHsNCiAg\nICAgICAgICAgICAgICBvdXQucHJpbnQoIk5lc3RlZCBUaHJvd2FibGUgIyIg\nKyAoaSArIDEpICsgIjogIik7DQogICAgICAgICAgICAgICAgX25lc3RlZFtp\nXS5wcmludFN0YWNrVHJhY2Uob3V0KTsNCiAgICAgICAgICAgIH0NCiAgICAg\nICAgfQ0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIFJldHVybiB0aGUgbGFz\ndCBtZXRob2QgbmFtZSB0aGF0IGNhbGxlZCB0aGlzIG9uZSBieQ0KICAgICAq\nIHBhcnNpbmcgdGhlIGN1cnJlbnQgc3RhY2sgdHJhY2UuDQogICAgICoNCiAg\nICAgKiBAcGFyYW0gZXhjbHVkZSBhIG1ldGhvZCBuYW1lIHRvIHNraXANCiAg\nICAgKiBAdGhyb3dzIElsbGVnYWxTdGF0ZUV4Y2VwdGlvbiBJZiB0aGUgY2Fs\nbGluZyBtZXRob2QgY291bGQgbm90IGJlDQogICAgICogaWRlbnRpZmllZC4N\nCiAgICAgKiBAYXV0aG9yIE1hcmMgUHJ1ZCdob21tZWF1eA0KICAgICAqLw0K\nICAgIHB1YmxpYyBTdHJpbmcgY2FsbGluZ01ldGhvZChTdHJpbmcgZXhjbHVk\nZSkgew0KICAgICAgICAvLyBkZXRlcm1pbmUgdGhlIGN1cnJlbnRseSBleGVj\ndXRpbmcgbWV0aG9kIGJ5DQogICAgICAgIC8vIGxvb2tpbmcgYXQgdGhlIHN0\nYWNrIHRyYWNrLiBIYWNraXNoLCBidXQgY29udmVuaWVudC4NCiAgICAgICAg\nU3RyaW5nV3JpdGVyIHN3ID0gbmV3IFN0cmluZ1dyaXRlcigpOw0KICAgICAg\nICBuZXcgRXhjZXB0aW9uKCkucHJpbnRTdGFja1RyYWNlKG5ldyBQcmludFdy\naXRlcihzdykpOw0KICAgICAgICBmb3IgKFN0cmluZ1Rva2VuaXplciBzdGFj\na1RyYWNlID0gbmV3IFN0cmluZ1Rva2VuaXplcihzdy50b1N0cmluZygpLA0K\nICAgICAgICAgICAgU3lzdGVtLmdldFByb3BlcnR5KCJsaW5lLnNlcGFyYXRv\nciIpKTsNCiAgICAgICAgICAgIHN0YWNrVHJhY2UuaGFzTW9yZVRva2Vucygp\nOykgew0KICAgICAgICAgICAgU3RyaW5nIGxpbmUgPSBzdGFja1RyYWNlLm5l\neHRUb2tlbigpLnRyaW0oKTsNCg0KICAgICAgICAgICAgLy8gbm90IGEgc3Rh\nY2sgdHJhY2UgZWxlbWVudA0KICAgICAgICAgICAgaWYgKCEobGluZS5zdGFy\ndHNXaXRoKCJhdCAiKSkpDQogICAgICAgICAgICAgICAgY29udGludWU7DQoN\nCiAgICAgICAgICAgIFN0cmluZyBmdWxsTWV0aG9kTmFtZSA9IGxpbmUuc3Vi\nc3RyaW5nKDAsIGxpbmUuaW5kZXhPZigiKCIpKTsNCg0KICAgICAgICAgICAg\nU3RyaW5nIHNob3J0TWV0aG9kTmFtZSA9IGZ1bGxNZXRob2ROYW1lLnN1YnN0\ncmluZygNCiAgICAgICAgICAgICAgICBmdWxsTWV0aG9kTmFtZS5sYXN0SW5k\nZXhPZigiLiIpICsgMSk7DQoNCiAgICAgICAgICAgIC8vIHNraXAgb3VyIG93\nbiBtZXRob2RzIQ0KICAgICAgICAgICAgaWYgKHNob3J0TWV0aG9kTmFtZS5l\ncXVhbHMoImNhbGxpbmdNZXRob2QiKSkNCiAgICAgICAgICAgICAgICBjb250\naW51ZTsNCiAgICAgICAgICAgIGlmIChleGNsdWRlICE9IG51bGwgJiYgc2hv\ncnRNZXRob2ROYW1lLmVxdWFscyhleGNsdWRlKSkNCiAgICAgICAgICAgICAg\nICBjb250aW51ZTsNCg0KICAgICAgICAgICAgcmV0dXJuIHNob3J0TWV0aG9k\nTmFtZTsNCiAgICAgICAgfQ0KDQogICAgICAgIHRocm93IG5ldyBJbGxlZ2Fs\nU3RhdGVFeGNlcHRpb24oIkNvdWxkIG5vdCBpZGVudGlmeSBjYWxsaW5nICIN\nCiAgICAgICAgICAgICsgIm1ldGhvZCBpbiBzdGFjayB0cmFjZSIpOw0KICAg\nIH0NCg0KICAgIC8vLy8vLy8vLy8NCiAgICAvLyBUaW1pbmcNCiAgICAvLy8v\nLy8vLy8vDQoNCiAgICAvKioNCiAgICAgKiBTbGVlcCB0aGUgY3VycmVudCBU\naHJlYWQgZm9yIGEgcmFuZG9tIGFtb3VudCBvZiB0aW1lIGZyb20gMC0xMDAw\nIG1zLg0KICAgICAqLw0KICAgIHB1YmxpYyB2b2lkIHNsZWVwUmFuZG9tKCkg\new0KICAgICAgICBzbGVlcFJhbmRvbSgxMDAwKTsNCiAgICB9DQoNCiAgICAv\nKioNCiAgICAgKiBTbGVlcCB0aGUgY3VycmVudCBUaHJlYWQgZm9yIGEgcmFu\nZG9tIGFtb3VudCBvZiB0aW1lIGZyb20NCiAgICAgKiAwLTxjb2RlPm1heDwv\nY29kZT4gbXMuDQogICAgICovDQogICAgcHVibGljIHZvaWQgc2xlZXBSYW5k\nb20oaW50IG1heCkgew0KICAgICAgICB0cnkgew0KICAgICAgICAgICAgVGhy\nZWFkLmN1cnJlbnRUaHJlYWQoKS5zbGVlcCgobG9uZykgKE1hdGgucmFuZG9t\nKCkgKiBtYXgpKTsNCiAgICAgICAgfSBjYXRjaCAoSW50ZXJydXB0ZWRFeGNl\ncHRpb24gZXgpIHsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIC8qKg0KICAg\nICAqIFJlLXJ1biB0aGlzIG1ldGhvZCBpbiB0aGUgY3VycmVudCB0aHJlYWQs\nIHRpbWluZyBvdXQNCiAgICAgKiBhZnRlciB0aGUgc3BlY2lmaWVkIG51bWJl\nciBvZiBzZWNvbmRzLg0KICAgICAqIFVzYWdlOg0KICAgICAqIDxwcmU+IHB1\nYmxpYyB2b2lkIHRpbWVPdXRPcGVyYXRpb24oKSB7IGlmICh0aW1lb3V0KDUg\nKiAxMDAwKSkgcmV0dXJuOw0KICAgICAqICBUaHJlYWQuY3VycmVudFRocmVh\nZCgpLnNsZWVwKDEwICogMTAwMCk7IH0NCiAgICAgKiA8L3ByZT4NCiAgICAg\nKiA8cC8+DQogICAgICogPHAvPg0KICAgICAqIDxzdHJvbmc+V2FybmluZzwv\nc3Ryb25nPiB0aGlzIG1ldGhvZCBzaG91bGQgYmUgdXNlZCBzcGFyaW5nbHks\nDQogICAgICogYW5kIG9ubHkgd2hlbiB5b3UgZXhwZWN0IHRoYXQgYSB0aW1l\nb3V0IHdpbGwgPHN0cm9uZz5ub3Q8L3N0cm9uZz4NCiAgICAgKiBvY2N1ci4g\nSXQgdXRpbGl6ZWQgdGhlIGRlcHJlY2F0ZWQge0BsaW5rIFRocmVhZCNzdG9w\nKCl9IGFuZA0KICAgICAqIHtAbGluayBUaHJlYWQjaW50ZXJydXB0fSBtZXRo\nb2RzLCB3aGljaCBjYW4gbGVhdmUgbW9uaXRvcnMgaW4gYW4NCiAgICAgKiBp\nbnZhbGlkIHN0YXRlLiBJdCBpcyBvbmx5IHVzZWQgYmVjYXVzZSBpdCBwcm92\naWRlcyBtb3JlDQogICAgICogbWVhbmluZ2Z1bCBpbmZvcm1hdGlvbiB0aGFu\nIGp1c3Qgc2VlaW5nIHRoYXQgdGhlIGVudGlyZSBhdXRvYnVpbGQNCiAgICAg\nKiB0aW1lZCBvdXQuDQogICAgICoNCiAgICAgKiBAcGFyYW0gbWlsbGlzIHRo\nZSBudW1iZXIgb2YgbWlsbGlzZWNvbmRzIHdlIHNob3VsZCB3YWl0Lg0KICAg\nICAqIEByZXR1cm4gdHJ1ZSBpZiB3ZSBhcmUgYXJlIGluIHRoZSB0aHJlYWQg\ndGhhdCByZXF1ZXN0ZWQgdGhlDQogICAgICogICAgICAgICB0aW1lb3V0LCBm\nYWxzZSBpZiB3ZSBhcmUgaW4gdGhlIHRpbWVvdXQgdGhyZWFkIGl0c2VsZi4N\nCiAgICAgKi8NCiAgICBwdWJsaWMgYm9vbGVhbiB0aW1lb3V0KGxvbmcgbWls\nbGlzKSB0aHJvd3MgVGhyb3dhYmxlIHsNCiAgICAgICAgU3RyaW5nIG1ldGhv\nZE5hbWUgPSBjYWxsaW5nTWV0aG9kKCJ0aW1lb3V0Iik7DQogICAgICAgIHJl\ndHVybiB0aW1lb3V0KG1pbGxpcywgbWV0aG9kTmFtZSk7DQogICAgfQ0KDQog\nICAgLyoqDQogICAgICogQHNlZSAjdGltZW91dChsb25nKQ0KICAgICAqLw0K\nICAgIHB1YmxpYyBib29sZWFuIHRpbWVvdXQobG9uZyBtaWxsaXMsIFN0cmlu\nZyBtZXRob2ROYW1lKSB0aHJvd3MgVGhyb3dhYmxlIHsNCiAgICAgICAgLy8g\nd2UgYXJlIGluIHRoZSB0aW1pbmcgb3V0LXRocmVhZDogZG8gbm90aGluZyBz\nbyB0aGUNCiAgICAgICAgLy8gYWN0dWFsIHRlc3QgbWV0aG9kIGNhbiBydW4N\nCiAgICAgICAgaWYgKGluVGltZW91dFRocmVhZCkNCiAgICAgICAgICAgIHJl\ndHVybiBmYWxzZTsNCg0KICAgICAgICBpblRpbWVvdXRUaHJlYWQgPSB0cnVl\nOw0KICAgICAgICBsb25nIGVuZFRpbWUgPSBTeXN0ZW0uY3VycmVudFRpbWVN\naWxsaXMoKSArIG1pbGxpczsNCg0KICAgICAgICB0cnkgew0KICAgICAgICAg\nICAgZmluYWwgTWV0aG9kIG1ldGhvZCA9IGdldENsYXNzKCkuDQogICAgICAg\nICAgICAgICAgZ2V0TWV0aG9kKG1ldGhvZE5hbWUsIChDbGFzc1tdKSBudWxs\nKTsNCiAgICAgICAgICAgIGZpbmFsIE9iamVjdCB0aHogPSB0aGlzOw0KDQog\nICAgICAgICAgICAvLyBzcGF3biB0aHJlYWQNCiAgICAgICAgICAgIFRpbWVP\ndXRUaHJlYWQgdG90ID0gbmV3IFRpbWVPdXRUaHJlYWQoIlRpbWVPdXRUaHJl\nYWQgWyINCiAgICAgICAgICAgICAgICArIG1ldGhvZE5hbWUgKyAiXSAoIiAr\nIG1pbGxpcyArICJtcykiKSB7DQogICAgICAgICAgICAgICAgcHVibGljIHZv\naWQgcnVuKCkgew0KICAgICAgICAgICAgICAgICAgICB0cnkgew0KICAgICAg\nICAgICAgICAgICAgICAgICAgbWV0aG9kLmludm9rZSh0aHosIChPYmplY3Rb\nXSkgbnVsbCk7DQogICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKFRocm93\nYWJsZSB0KSB7DQogICAgICAgICAgICAgICAgICAgICAgICB0aHJvd2FibGUg\nPSB0Ow0KICAgICAgICAgICAgICAgICAgICB9IGZpbmFsbHkgew0KICAgICAg\nICAgICAgICAgICAgICAgICAgY29tcGxldGVkID0gdHJ1ZTsNCiAgICAgICAg\nICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAg\nIH07DQoNCiAgICAgICAgICAgIHRvdC5zdGFydCgpOw0KDQogICAgICAgICAg\nICAvLyB3YWl0IGZvciB0aGUgY29tcGxldGlvbiBvciBhIHRpbWVvdXQgdG8g\nb2NjdXINCiAgICAgICAgICAgIHRvdC5qb2luKG1pbGxpcyk7DQoNCiAgICAg\nICAgICAgIC8vIGhhdmUgd2UgdGltZWQgb3V0PyBLaWxsIHRoZSB0aHJlYWQg\nYW5kIHRocm93IGFuIGV4Y2VwdGlvbg0KICAgICAgICAgICAgaWYgKFN5c3Rl\nbS5jdXJyZW50VGltZU1pbGxpcygpID49IGVuZFRpbWUpIHsNCiAgICAgICAg\nICAgICAgICAvLyBpZiB3ZSBhcmUgd2FpdGluZyBvbiBhIG1vbml0b3IsIHRo\naXMgd2lsbCBnaXZlDQogICAgICAgICAgICAgICAgLy8gdXMgYSB1c2VmdWwg\nc3RhY2sgdHJhY2UuDQogICAgICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAg\nICAgICAgICAgICAgdG90LmludGVycnVwdCgpOw0KICAgICAgICAgICAgICAg\nIH0gY2F0Y2ggKFRocm93YWJsZSBlKSB7DQogICAgICAgICAgICAgICAgfQ0K\nICAgICAgICAgICAgICAgIFRocmVhZC5jdXJyZW50VGhyZWFkKCkuc2xlZXAo\nNTAwKTsNCg0KICAgICAgICAgICAgICAgIC8vIHRyeSB0byBraWxsIHRoZSB0\naHJlYWQNCiAgICAgICAgICAgICAgICB0cnkgew0KICAgICAgICAgICAgICAg\nICAgICB0b3Quc3RvcCgpOw0KICAgICAgICAgICAgICAgIH0gY2F0Y2ggKFRo\ncm93YWJsZSBlKSB7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAg\nICAgIFRocmVhZC5jdXJyZW50VGhyZWFkKCkuc2xlZXAoNTAwKTsNCg0KICAg\nICAgICAgICAgICAgIHRocm93IG5ldyBPcGVyYXRpb25UaW1lZE91dEV4Y2Vw\ndGlvbigiRXhlY3V0aW9uIG9mIFwiIg0KICAgICAgICAgICAgICAgICAgICAr\nIG1ldGhvZE5hbWUgKyAiXCIgdGltZWQgb3V0IGFmdGVyICINCiAgICAgICAg\nICAgICAgICAgICAgKyBtaWxsaXMgKyAiIG1pbGxpc2Vjb25kcyIsIHRvdC50\naHJvd2FibGUpOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAvLyB0\naHJvdyBhbnkgZXhjZXB0aW9ucyB0aGF0IG1heSBoYXZlIG9jY3VyZWQNCiAg\nICAgICAgICAgIGlmICh0b3QudGhyb3dhYmxlICE9IG51bGwpDQogICAgICAg\nICAgICAgICAgdGhyb3cgdG90LnRocm93YWJsZTsNCg0KICAgICAgICAgICAg\nLy8gSSBndWVzcyBldmVyeXRoaW5nIHdhcyBPSw0KICAgICAgICAgICAgcmV0\ndXJuIHRydWU7DQogICAgICAgIH0gZmluYWxseSB7DQogICAgICAgICAgICBp\nblRpbWVvdXRUaHJlYWQgPSBmYWxzZTsNCiAgICAgICAgfQ0KICAgIH0NCg0K\nICAgIHByaXZhdGUgc3RhdGljIGNsYXNzIFRpbWVPdXRUaHJlYWQgZXh0ZW5k\ncyBUaHJlYWQgew0KDQogICAgICAgIHB1YmxpYyBUaHJvd2FibGUgdGhyb3dh\nYmxlID0gbnVsbDsNCiAgICAgICAgcHVibGljIGJvb2xlYW4gY29tcGxldGVk\nID0gZmFsc2U7DQoNCiAgICAgICAgcHVibGljIFRpbWVPdXRUaHJlYWQoU3Ry\naW5nIG5hbWUpIHsNCiAgICAgICAgICAgIHN1cGVyKG5hbWUpOw0KICAgICAg\nICAgICAgc2V0RGFlbW9uKHRydWUpOw0KICAgICAgICB9DQogICAgfQ0KDQog\nICAgLyoqDQogICAgICogSW5kaWNhdGVzIHRoYXQgYSB0aW1lb3V0IG9jY3Vy\nZWQuDQogICAgICovDQogICAgcHVibGljIHN0YXRpYyBjbGFzcyBPcGVyYXRp\nb25UaW1lZE91dEV4Y2VwdGlvbiBleHRlbmRzIFJ1bnRpbWVFeGNlcHRpb24g\new0KDQogICAgICAgIHByaXZhdGUgZmluYWwgVGhyb3dhYmxlIF9lcnI7DQoN\nCiAgICAgICAgcHVibGljIE9wZXJhdGlvblRpbWVkT3V0RXhjZXB0aW9uKFN0\ncmluZyBtc2csIFRocm93YWJsZSB0aHJvd2FibGUpIHsNCiAgICAgICAgICAg\nIHN1cGVyKG1zZyk7DQogICAgICAgICAgICBfZXJyID0gdGhyb3dhYmxlOw0K\nICAgICAgICB9DQoNCiAgICAgICAgcHVibGljIHZvaWQgcHJpbnRTdGFja1Ry\nYWNlKCkgew0KICAgICAgICAgICAgcHJpbnRTdGFja1RyYWNlKFN5c3RlbS5v\ndXQpOw0KICAgICAgICB9DQoNCiAgICAgICAgcHVibGljIHZvaWQgcHJpbnRT\ndGFja1RyYWNlKFByaW50U3RyZWFtIG91dCkgew0KICAgICAgICAgICAgcHJp\nbnRTdGFja1RyYWNlKG5ldyBQcmludFdyaXRlcihvdXQpKTsNCiAgICAgICAg\nfQ0KDQogICAgICAgIHB1YmxpYyB2b2lkIHByaW50U3RhY2tUcmFjZShQcmlu\ndFdyaXRlciBvdXQpIHsNCiAgICAgICAgICAgIHN1cGVyLnByaW50U3RhY2tU\ncmFjZShvdXQpOw0KICAgICAgICAgICAgaWYgKF9lcnIgIT0gbnVsbCkgew0K\nICAgICAgICAgICAgICAgIG91dC5wcmludCgiTmVzdGVkIFRocm93YWJsZTog\nIik7DQogICAgICAgICAgICAgICAgX2Vyci5wcmludFN0YWNrVHJhY2Uob3V0\nKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIC8v\nLy8vLy8vLy8vLy8vLw0KICAgIC8vIENvbGxlY3Rpb25zDQogICAgLy8vLy8v\nLy8vLy8vLy8vDQoNCiAgICAvKioNCiAgICAgKiBWYWxpZGF0ZSB0aGF0IHRo\nZSBzcGVjaWZpZWQge0BsaW5rIENvbGxlY3Rpb259IGZ1bGZpbGxzIHRoZQ0K\nICAgICAqIENvbGxlY3Rpb24gY29udHJhY3QgYXMgc3BlY2lmaWVkIGJ5IHRo\nZSBDb2xsZWN0aW9ucyBBUEkuDQogICAgICogPHAvPg0KICAgICAqIDxzdHJv\nbmc+Tm90ZTwvc3Ryb25nPjogZG9lcyBub3QgdmFsaWRhdGUgbXV0YWJsZSBv\ncGVyYXRpb25zDQogICAgICovDQogICAgcHVibGljIHN0YXRpYyB2b2lkIHZh\nbGlkYXRlQ29sbGVjdGlvbihDb2xsZWN0aW9uIGNvbGxlY3Rpb24pIHsNCiAg\nICAgICAgaW50IHNpemUgPSBjb2xsZWN0aW9uLnNpemUoKTsNCiAgICAgICAg\naW50IGl0ZXJhdGVkID0gMDsNCiAgICAgICAgLy8gZW5zdXJlIHdlIGNhbiB3\nYWxrIGFsb25nIHRoZSBpdGVyYXRvcg0KICAgICAgICBmb3IgKEl0ZXJhdG9y\nIGkgPSBjb2xsZWN0aW9uLml0ZXJhdG9yKCk7IGkuaGFzTmV4dCgpOykgew0K\nICAgICAgICAgICAgaXRlcmF0ZWQrKzsNCiAgICAgICAgICAgIGkubmV4dCgp\nOw0KICAgICAgICB9DQoNCiAgICAgICAgLy8gZW5zdXJlIHRoZSBudW1iZXIg\nb2YgdmFsdWVzIGl0ZXJhdGVkIGlzIHRoZSBzYW1lIGFzIHRoZSBsaXN0IHNp\nemUNCiAgICAgICAgYXNzZXJ0RXF1YWxzKHNpemUsIGl0ZXJhdGVkKTsNCg0K\nICAgICAgICAvLyBhbHNvIHZhbGlkYXRlIHRoZSBsaXN0DQogICAgICAgIGlm\nIChjb2xsZWN0aW9uIGluc3RhbmNlb2YgTGlzdCkgew0KICAgICAgICAgICAg\nTGlzdCBsbCA9IG5ldyBBcnJheUxpc3QoKTsNCiAgICAgICAgICAgIGZvciAo\naW50IGkgPSAwOyBpIDwgMTAwOyBpKyspDQogICAgICAgICAgICAgICAgbGwu\nYWRkKG5ldyBJbnRlZ2VyKGkpKTsNCiAgICAgICAgICAgIHZhbGlkYXRlTGlz\ndCgoTGlzdCkgbGwpOw0KICAgICAgICAgICAgdmFsaWRhdGVMaXN0KChMaXN0\nKSBjb2xsZWN0aW9uKTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIC8qKg0K\nICAgICAqIFZhbGlkYXRlIHRoYXQgdGhlIHNwZWNpZmllZCB7QGxpbmsgTGlz\ndH0gZnVsZmlsbHMgdGhlDQogICAgICogTGlzdCBjb250cmFjdCBhcyBzcGVj\naWZpZWQgYnkgdGhlIENvbGxlY3Rpb25zIEFQSS4NCiAgICAgKiA8cC8+DQog\nICAgICogPHN0cm9uZz5Ob3RlPC9zdHJvbmc+OiBkb2VzIG5vdCB2YWxpZGF0\nZSBtdXRhYmxlIG9wZXJhdGlvbnMNCiAgICAgKi8NCiAgICBwdWJsaWMgc3Rh\ndGljIHZvaWQgdmFsaWRhdGVMaXN0KExpc3QgbGlzdCkgew0KICAgICAgICBP\nYmplY3QgW10gY29yZVZhbHVlcyA9IGxpc3QudG9BcnJheSgpOw0KICAgICAg\nICBPYmplY3QgW10gdmFsdWVzMSA9IG5ldyBPYmplY3QgW2xpc3Quc2l6ZSgp\nXTsNCiAgICAgICAgT2JqZWN0IFtdIHZhbHVlczIgPSBuZXcgT2JqZWN0IFts\naXN0LnNpemUoKV07DQogICAgICAgIE9iamVjdCBbXSB2YWx1ZXMzID0gbmV3\nIE9iamVjdCBbbGlzdC5zaXplKCldOw0KICAgICAgICBPYmplY3QgW10gdmFs\ndWVzNCA9IG5ldyBPYmplY3QgW2xpc3Quc2l6ZSgpXTsNCg0KICAgICAgICAv\nLyBmaWxsIHNlcXVlbnRpYWwgaW5kZXggYWNjZXNzIGxpc3QNCiAgICAgICAg\nZm9yIChpbnQgaSA9IDA7IGkgPCBsaXN0LnNpemUoKTsgaSsrKQ0KICAgICAg\nICAgICAgdmFsdWVzMVtpXSA9IGxpc3QuZ2V0KGkpOw0KDQogICAgICAgIC8v\nIGZpbGwgc2VxdWVudGlhbCBsaXN0DQogICAgICAgIGludCBpbmRleCA9IDA7\nDQogICAgICAgIExpc3RJdGVyYXRvciBpdGVyOw0KICAgICAgICBmb3IgKGl0\nZXIgPSBsaXN0Lmxpc3RJdGVyYXRvcigwKTsgaXRlci5oYXNOZXh0KCk7KSB7\nDQogICAgICAgICAgICBhc3NlcnRFcXVhbHMoaW5kZXgsIGl0ZXIubmV4dElu\nZGV4KCkpOw0KICAgICAgICAgICAgYXNzZXJ0RXF1YWxzKGluZGV4LCBpdGVy\nLnByZXZpb3VzSW5kZXgoKSArIDEpOw0KICAgICAgICAgICAgdmFsdWVzMltp\nbmRleF0gPSBpdGVyLm5leHQoKTsNCiAgICAgICAgICAgIGFzc2VydFRydWUo\nbGlzdC5jb250YWlucyh2YWx1ZXMyW2luZGV4XSkpOw0KICAgICAgICAgICAg\naW5kZXgrKzsNCiAgICAgICAgfQ0KDQogICAgICAgIC8vIGVuc3VyZSBOb1N1\nY2hFbGVtZW50RXhjZXB0aW9uIGlzIHRocm93biBhcyBhcHByb3ByaWF0ZQ0K\nICAgICAgICB0cnkgew0KICAgICAgICAgICAgaXRlci5uZXh0KCk7DQogICAg\nICAgICAgICBmYWlsKCJuZXh0KCkgc2hvdWxkIGhhdmUgcmVzdWx0ZWQgaW4g\nYSBOb1N1Y2hFbGVtZW50RXhjZXB0aW9uIik7DQogICAgICAgIH0gY2F0Y2gg\nKE5vU3VjaEVsZW1lbnRFeGNlcHRpb24gZSkgew0KICAgICAgICB9IC8vIGFz\nIGV4cGVjdGVkDQoNCiAgICAgICAgLy8gZmlsbCByZXZlcnNlIHNlcXVlbnRp\nYWwgbGlzdA0KICAgICAgICBpbnQgYmFjayA9IDA7DQogICAgICAgIGZvciAo\naXRlciA9IGxpc3QubGlzdEl0ZXJhdG9yKGxpc3Quc2l6ZSgpKTsgaXRlci5o\nYXNQcmV2aW91cygpOykgew0KICAgICAgICAgICAgYXNzZXJ0RXF1YWxzKGlu\nZGV4LCBpdGVyLnByZXZpb3VzSW5kZXgoKSArIDEpOw0KICAgICAgICAgICAg\nYXNzZXJ0RXF1YWxzKGluZGV4LCBpdGVyLm5leHRJbmRleCgpKTsNCiAgICAg\nICAgICAgIHZhbHVlczNbLS1pbmRleF0gPSBpdGVyLnByZXZpb3VzKCk7DQog\nICAgICAgICAgICBiYWNrKys7DQogICAgICAgIH0NCiAgICAgICAgYXNzZXJ0\nRXF1YWxzKGxpc3Quc2l6ZSgpLCBiYWNrKTsNCg0KICAgICAgICAvLyBlbnN1\ncmUgTm9TdWNoRWxlbWVudEV4Y2VwdGlvbiBpcyB0aHJvd24gYXMgYXBwcm9w\ncmlhdGUNCiAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgIGl0ZXIucHJldmlv\ndXMoKTsNCiAgICAgICAgICAgIGZhaWwoInByZXZpb3VzKCkgc2hvdWxkIGhh\ndmUgcmVzdWx0ZWQgaW4gYSAiDQogICAgICAgICAgICAgICAgKyAiTm9TdWNo\nRWxlbWVudEV4Y2VwdGlvbiIpOw0KICAgICAgICB9IGNhdGNoIChOb1N1Y2hF\nbGVtZW50RXhjZXB0aW9uIGUpIHsNCiAgICAgICAgfSAvLyBhcyBleHBlY3Rl\nZA0KDQogICAgICAgIC8vIGZpbGwgcmFuZG9tIGFjY2VzcyBsaXN0DQogICAg\nICAgIExpc3QgaW5kaWNlcyA9IG5ldyBMaW5rZWRMaXN0KCk7DQogICAgICAg\nIGZvciAoaW50IGkgPSAwOyBpIDwgbGlzdC5zaXplKCk7IGkrKykNCiAgICAg\nICAgICAgIGluZGljZXMuYWRkKG5ldyBJbnRlZ2VyKGkpKTsNCg0KICAgICAg\nICBmb3IgKGludCBpID0gMDsgaSA8IGxpc3Quc2l6ZSgpOyBpKyspIHsNCiAg\nICAgICAgICAgIGludCByYW5kID0gKGludCkgKE1hdGgucmFuZG9tKCkgKiBp\nbmRpY2VzLnNpemUoKSk7DQogICAgICAgICAgICBJbnRlZ2VyIHJhbmRJbmRl\neCA9IChJbnRlZ2VyKSBpbmRpY2VzLnJlbW92ZShyYW5kKTsNCiAgICAgICAg\nICAgIHZhbHVlczRbcmFuZEluZGV4LmludFZhbHVlKCldID0gbGlzdC5nZXQo\ncmFuZEluZGV4LmludFZhbHVlKCkpOw0KICAgICAgICB9DQoNCiAgICAgICAg\nYXNzZXJ0RXF1YWxzKEFycmF5cy5hc0xpc3QoY29yZVZhbHVlcyksIEFycmF5\ncy5hc0xpc3QodmFsdWVzMSkpOw0KICAgICAgICBhc3NlcnRJZGVudGljYWwo\nQXJyYXlzLmFzTGlzdChjb3JlVmFsdWVzKSwgQXJyYXlzLmFzTGlzdCh2YWx1\nZXMxKSk7DQogICAgICAgIGFzc2VydEVxdWFscyhBcnJheXMuYXNMaXN0KGNv\ncmVWYWx1ZXMpLCBBcnJheXMuYXNMaXN0KHZhbHVlczIpKTsNCiAgICAgICAg\nYXNzZXJ0SWRlbnRpY2FsKEFycmF5cy5hc0xpc3QoY29yZVZhbHVlcyksIEFy\ncmF5cy5hc0xpc3QodmFsdWVzMikpOw0KICAgICAgICBhc3NlcnRFcXVhbHMo\nQXJyYXlzLmFzTGlzdChjb3JlVmFsdWVzKSwgQXJyYXlzLmFzTGlzdCh2YWx1\nZXM0KSk7DQogICAgICAgIGFzc2VydElkZW50aWNhbChBcnJheXMuYXNMaXN0\nKGNvcmVWYWx1ZXMpLCBBcnJheXMuYXNMaXN0KHZhbHVlczQpKTsNCiAgICAg\nICAgYXNzZXJ0RXF1YWxzKEFycmF5cy5hc0xpc3QoY29yZVZhbHVlcyksIEFy\ncmF5cy5hc0xpc3QodmFsdWVzMykpOw0KICAgICAgICBhc3NlcnRJZGVudGlj\nYWwoQXJyYXlzLmFzTGlzdChjb3JlVmFsdWVzKSwgQXJyYXlzLmFzTGlzdCh2\nYWx1ZXMzKSk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICogQXNzZXJ0IHRo\nYXQgdGhlIGdpdmVuIExpc3QgY29udGFpbiB0aGUgZXhhY3Qgc2FtZQ0KICAg\nICAqIGVsZW1lbnRzLiBUaGlzIGlzIGRpZmZlcmVudCB0aGFuIHRoZSBub3Jt\nYWwgTGlzdCBjb250cmFjdCwgd2hpY2gNCiAgICAgKiBzdGF0ZXMgdGhhdCBs\naXN0MS5lcXVhbHMobGlzdDIpIGlmIGVhY2ggZWxlbWVudCBlMS5lcXVhbHMo\nZTIpLg0KICAgICAqIFRoaXMgbWV0aG9kIGFzc2VydHMgdGhhdCBlMSA9PSBu\nMi4NCiAgICAgKi8NCiAgICBwdWJsaWMgc3RhdGljIHZvaWQgYXNzZXJ0SWRl\nbnRpY2FsKExpc3QgYzEsIExpc3QgYzIpIHsNCiAgICAgICAgYXNzZXJ0RXF1\nYWxzKGMxLnNpemUoKSwgYzIuc2l6ZSgpKTsNCiAgICAgICAgZm9yIChJdGVy\nYXRvciBpMSA9IGMxLml0ZXJhdG9yKCksIGkyID0gYzIuaXRlcmF0b3IoKTsN\nCiAgICAgICAgICAgIGkxLmhhc05leHQoKSAmJiBpMi5oYXNOZXh0KCk7KQ0K\nICAgICAgICAgICAgYXNzZXJ0VHJ1ZShpMS5uZXh0KCkgPT0gaTIubmV4dCgp\nKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiBBc3NlcnQgdGhhdCB0aGUg\nY29sbGVjdGlvbiBwYXJhbWV0ZXIgaXMgYWxyZWFkeSBvcmRlcmVkDQogICAg\nICogYWNjb3JkaW5nIHRvIHRoZSBzcGVjaWZpZWQgY29tcGFyYXRvci4NCiAg\nICAgKi8NCiAgICBwdWJsaWMgdm9pZCBhc3NlcnRPcmRlcmVkKENvbGxlY3Rp\nb24gYywgQ29tcGFyYXRvciBjb21wKSB7DQogICAgICAgIExpc3QgbDEgPSBu\nZXcgTGlua2VkTGlzdChjKTsNCiAgICAgICAgTGlzdCBsMiA9IG5ldyBMaW5r\nZWRMaXN0KGMpOw0KICAgICAgICBhc3NlcnRFcXVhbHMobDEsIGwyKTsNCiAg\nICAgICAgQ29sbGVjdGlvbnMuc29ydChsMiwgY29tcCk7DQogICAgICAgIGFz\nc2VydEVxdWFscyhsMSwgbDIpOw0KICAgICAgICBDb2xsZWN0aW9ucy5zb3J0\nKGwxLCBjb21wKTsNCiAgICAgICAgYXNzZXJ0RXF1YWxzKGwxLCBsMik7DQog\nICAgfQ0KfQ0K\n","encoding":"base64"}

