{"sha":"820d55fbbab1eae02345235e5f2d2e8ffcfb8c82","node_id":"MDQ6QmxvYjIwNjM2NDo4MjBkNTVmYmJhYjFlYWUwMjM0NTIzNWU1ZjJkMmU4ZmZjZmI4Yzgy","size":13482,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/820d55fbbab1eae02345235e5f2d2e8ffcfb8c82","content":"LyoNCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUNCiAqIG9yIG1vcmUgY29udHJpYnV0b3Ig\nbGljZW5zZSBhZ3JlZW1lbnRzLiAgU2VlIHRoZSBOT1RJQ0UgZmlsZQ0KICog\nZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5m\nb3JtYXRpb24NCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAg\nVGhlIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUNCiAqIHRvIHlvdSB1bmRlciB0\naGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUNCiAqICJMaWNl\nbnNlIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNv\nbXBsaWFuY2UNCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFp\nbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQNCiAqDQogKiBodHRwOi8vd3d3\nLmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjANCiAqDQogKiBVbmxl\nc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGlu\nIHdyaXRpbmcsDQogKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUg\nTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbg0KICogIkFTIElTIiBCQVNJ\nUywgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZDQog\nKiBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBM\naWNlbnNlIGZvciB0aGUNCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmlu\nZyBwZXJtaXNzaW9ucyBhbmQgbGltaXRhdGlvbnMNCiAqIHVuZGVyIHRoZSBM\naWNlbnNlLiAgICANCiAqLw0KcGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEu\ncGVyc2lzdGVuY2UuZGF0YWNhY2hlOw0KDQppbXBvcnQgamF2YS51dGlsLkNv\nbGxlY3Rpb247DQppbXBvcnQgamF2YS51dGlsLkhhc2hNYXA7DQppbXBvcnQg\namF2YS51dGlsLkl0ZXJhdG9yOw0KaW1wb3J0IGphdmEudXRpbC5NYXA7DQoN\nCg0KaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5kYXRh\nY2FjaGUuY29tbW9uLmFwcHMuUnVudGltZVRlc3QxOw0KaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5kYXRhY2FjaGUuY29tbW9uLmFw\ncHMuUnVudGltZVRlc3QyOw0KaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5w\nZXJzaXN0ZW5jZS5jb21tb24udXRpbHMuQWJzdHJhY3RUZXN0Q2FzZTsNCmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuZGF0YWNhY2hlLkRhdGFDYWNoZTsN\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuZXZlbnQuVENQUmVtb3RlQ29t\nbWl0UHJvdmlkZXI7DQppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi5j\nb25mLkNvbmZpZ3VyYXRpb25zOw0KaW1wb3J0IG9yZy5hcGFjaGUub3Blbmpw\nYS5wZXJzaXN0ZW5jZS5PcGVuSlBBRW50aXR5TWFuYWdlcjsNCmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuT3BlbkpQQUVudGl0eU1h\nbmFnZXJGYWN0b3J5Ow0KaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5wZXJz\naXN0ZW5jZS5PcGVuSlBBRW50aXR5TWFuYWdlckZhY3RvcnlTUEk7DQppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuSWQ7DQoNCnB1YmxpYyBjbGFz\ncyBUZXN0RGlzdHJpYnV0ZWRLb2RvRGF0YUNhY2hlIGV4dGVuZHMgQWJzdHJh\nY3RUZXN0Q2FzZSB7DQoNCiAgICAvLyBXZSB3YW50IG1vcmUgdGhhbiAxIGlu\nc3RhbmNlIG9mIGVhY2ggdHlwZSBvZiBjbGFzcy4NCiAgICBwcml2YXRlIHN0\nYXRpYyBmaW5hbCBpbnQgTlVNX09CSkVDVFMgPSA0Ow0KDQogICAgcHJpdmF0\nZSBPYmplY3RbXSBfcnVudGltZTFzT2lkczsNCg0KICAgIHByaXZhdGUgT2Jq\nZWN0W10gX3J1bnRpbWUyc09pZHM7DQoNCiAgICBwcml2YXRlIE9iamVjdCBz\ncGVjX29pZDsNCg0KICAgIHB1YmxpYyBUZXN0RGlzdHJpYnV0ZWRLb2RvRGF0\nYUNhY2hlKFN0cmluZyB0ZXN0KSB7DQogICAgICAgIHN1cGVyKHRlc3QsICJk\nYXRhY2FjaGVjYWN0dXNhcHAiKTsNCiAgICB9DQoNCiAgICBwdWJsaWMgdm9p\nZCBzZXRVcCgpIHsNCiAgICAgICAgZGVsZXRlQWxsKFJ1bnRpbWVUZXN0MS5j\nbGFzcyk7DQogICAgICAgIGRlbGV0ZUFsbChSdW50aW1lVGVzdDIuY2xhc3Mp\nOw0KICAgIH0NCg0KICAgIHByaXZhdGUgaW50ZXJmYWNlIENoYW5nZU9wZXJh\ndGlvbiB7DQoNCiAgICAgICAgcHVibGljIFN0cmluZyBnZXROYW1lKCk7DQoN\nCiAgICAgICAgcHVibGljIHZvaWQgb3BlcmF0aW9uKE9wZW5KUEFFbnRpdHlN\nYW5hZ2VyRmFjdG9yeSBrcG1mLA0KICAgICAgICAgICAgYm9vbGVhbiBhc0xh\ncmdlKTsNCiAgICB9DQoNCiAgICBwcml2YXRlIGNsYXNzIHBlcmZvcm1Bc01v\nZGlmeSBpbXBsZW1lbnRzIENoYW5nZU9wZXJhdGlvbiB7DQoNCiAgICAgICAg\ncHVibGljIFN0cmluZyBnZXROYW1lKCkgew0KICAgICAgICAgICAgcmV0dXJu\nICJNb2RpZnkgU3BlY2lhbFJ1bnRpbWVUZXN0MSI7DQogICAgICAgIH0NCg0K\nICAgICAgICBwdWJsaWMgdm9pZCBvcGVyYXRpb24oT3BlbkpQQUVudGl0eU1h\nbmFnZXJGYWN0b3J5IGtwbWYsDQogICAgICAgICAgICBib29sZWFuIGFzTGFy\nZ2UpIHsNCiAgICAgICAgICAgIE9wZW5KUEFFbnRpdHlNYW5hZ2VyIHBtOw0K\nICAgICAgICAgICAgcG0gPSAoT3BlbkpQQUVudGl0eU1hbmFnZXIpIGtwbWYu\nY3JlYXRlRW50aXR5TWFuYWdlcigpOw0KICAgICAgICAgICAgaWYgKGFzTGFy\nZ2UpDQogICAgICAgICAgICAgICAgLy9wbS5zZXRMYXJnZVRyYW5zYWN0aW9u\nKHRydWUpOw0KICAgICAgICAgICAgICAgIHBtLnNldFRyYWNrQ2hhbmdlc0J5\nVHlwZSh0cnVlKTsNCiAgICAgICAgICAgIHN0YXJ0VHgocG0pOw0KICAgICAg\nICAgICAgUnVudGltZVRlc3QxIHNwZWNpYWwgPSBwbS5maW5kKFJ1bnRpbWVU\nZXN0MS5jbGFzcywgc3BlY19vaWQpOw0KICAgICAgICAgICAgYXNzZXJ0Tm90\nTnVsbChzcGVjaWFsKTsNCiAgICAgICAgICAgIHNwZWNpYWwuc2V0U3RyaW5n\nRmllbGQoIlNwZWljYWxSdW50aW1lVGVzdDFfTU9ESUZJRUQiKTsNCg0KICAg\nICAgICAgICAgZW5kVHgocG0pOw0KICAgICAgICAgICAgZW5kRW0ocG0pOw0K\nICAgICAgICB9DQogICAgfQ0KDQogICAgcHJpdmF0ZSBjbGFzcyBwZXJmb3Jt\nQXNEZWxldGUgaW1wbGVtZW50cyBDaGFuZ2VPcGVyYXRpb24gew0KDQogICAg\nICAgIHB1YmxpYyBTdHJpbmcgZ2V0TmFtZSgpIHsNCiAgICAgICAgICAgIHJl\ndHVybiAiRGVsZXRlIFNwZWNpYWxSdW50aW1lVGVzdDEiOw0KICAgICAgICB9\nDQoNCiAgICAgICAgcHVibGljIHZvaWQgb3BlcmF0aW9uKE9wZW5KUEFFbnRp\ndHlNYW5hZ2VyRmFjdG9yeSBrcG1mLA0KICAgICAgICAgICAgYm9vbGVhbiBh\nc0xhcmdlKSB7DQogICAgICAgICAgICBPcGVuSlBBRW50aXR5TWFuYWdlciBw\nbTsNCiAgICAgICAgICAgIHBtID0gKE9wZW5KUEFFbnRpdHlNYW5hZ2VyKSBr\ncG1mLmNyZWF0ZUVudGl0eU1hbmFnZXIoKTsNCiAgICAgICAgICAgIGlmIChh\nc0xhcmdlKQ0KICAgICAgICAgICAgICAgIC8vcG0uc2V0TGFyZ2VUcmFuc2Fj\ndGlvbih0cnVlKTsNCiAgICAgICAgICAgICAgICBwbS5zZXRUcmFja0NoYW5n\nZXNCeVR5cGUodHJ1ZSk7DQogICAgICAgICAgICBzdGFydFR4KHBtKTsNCiAg\nICAgICAgICAgIFJ1bnRpbWVUZXN0MSBzcGVjaWFsT2JqID0gcG0uZmluZChS\ndW50aW1lVGVzdDEuY2xhc3MsIHNwZWNfb2lkKTsNCiAgICAgICAgICAgIGFz\nc2VydE5vdE51bGwoc3BlY2lhbE9iaik7DQoNCiAgICAgICAgICAgIHBtLnJl\nbW92ZShzcGVjaWFsT2JqKTsNCg0KICAgICAgICAgICAgZW5kVHgocG0pOw0K\nICAgICAgICAgICAgZW5kRW0ocG0pOw0KICAgICAgICB9DQogICAgfQ0KDQog\nICAgcHVibGljIHZvaWQgdGVzdE5vcm1hbFRyYW5zQW5kRGF0YUNhY2hlRGVs\nZXRlKCkgew0KICAgICAgICBjb3JlVGVzdFRyYW5zQW5kQ2hhbmdlKG5ldyBw\nZXJmb3JtQXNEZWxldGUoKSwgZmFsc2UsIHRydWUpOw0KICAgIH0NCg0KICAg\nIHB1YmxpYyB2b2lkIHRlc3ROb3JtYWxUcmFuc0FuZERhdGFDYWNoZU1vZGlm\neSgpIHsNCiAgICAgICAgY29yZVRlc3RUcmFuc0FuZENoYW5nZShuZXcgcGVy\nZm9ybUFzTW9kaWZ5KCksIGZhbHNlLCBmYWxzZSk7DQogICAgfQ0KDQogICAg\ncHVibGljIHZvaWQgdGVzdExhcmdlVHJhbnNBbmREYXRhQ2FjaGVEZWxldGUo\nKSB7DQogICAgICAgIGNvcmVUZXN0VHJhbnNBbmRDaGFuZ2UobmV3IHBlcmZv\ncm1Bc0RlbGV0ZSgpLCB0cnVlLCB0cnVlKTsNCiAgICB9DQoNCiAgICBwdWJs\naWMgdm9pZCB0ZXN0TGFyZ2VUcmFuc0FuZERhdGFDYWNoZU1vZGlmeSgpIHsN\nCiAgICAgICAgY29yZVRlc3RUcmFuc0FuZENoYW5nZShuZXcgcGVyZm9ybUFz\nTW9kaWZ5KCksIHRydWUsIGZhbHNlKTsNCiAgICB9DQoNCiAgICBwdWJsaWMg\ndm9pZCBjb3JlVGVzdFRyYW5zQW5kQ2hhbmdlKENoYW5nZU9wZXJhdGlvbiBj\naGFuZ2VPcGVyYXRpb24sDQogICAgICAgIGJvb2xlYW4gYXNMYXJnZVRyYW5z\nYWN0aW9uLCBib29sZWFuIGlzRGVsZXRlKSB7DQogICAgICAgIC8vIENyZWF0\nZSB0d28gcG1mcyBpbiBhIGNsdXN0ZXIgdGhhdCBhcmUgdXNpbmcgUkNQVENQ\nLg0KICAgICAgICBPcGVuSlBBRW50aXR5TWFuYWdlckZhY3RvcnkgcG1mU2Vu\nZGVyID0gY3JlYXRlRGlzdGluY3RGYWN0b3J5KA0KICAgICAgICAgICAgVENQ\nUmVtb3RlQ29tbWl0UHJvdmlkZXIuY2xhc3MsDQogICAgICAgICAgICAiUG9y\ndD01NjM2LCBBZGRyZXNzZXM9MTI3LjAuMC4xOjY2MzYiKTsNCiAgICAgICAg\nT3BlbkpQQUVudGl0eU1hbmFnZXJGYWN0b3J5IHBtZlJlY2VpdmVyID0gY3Jl\nYXRlRGlzdGluY3RGYWN0b3J5KA0KICAgICAgICAgICAgVENQUmVtb3RlQ29t\nbWl0UHJvdmlkZXIuY2xhc3MsDQogICAgICAgICAgICAiUG9ydD02NjM2LCBB\nZGRyZXNzZXM9MTI3LjAuMC4xOjU2MzYiKTsNCiAgICAgICAgLy8gR2V0IHRo\nZSBkYXRhY2FjaGVzIGZyb20gZWFjaCBwbWYNCiAgICAgICAgRGF0YUNhY2hl\nIGRjU2VuZGVyID0NCiAgICAgICAgICAgICgoT3BlbkpQQUVudGl0eU1hbmFn\nZXJGYWN0b3J5U1BJKSBwbWZTZW5kZXIpLmdldENvbmZpZ3VyYXRpb24oKQ0K\nICAgICAgICAgICAgICAgIC5nZXREYXRhQ2FjaGVNYW5hZ2VySW5zdGFuY2Uo\nKS5nZXRTeXN0ZW1EYXRhQ2FjaGUoKTsNCiAgICAgICAgRGF0YUNhY2hlIGRj\nUmVjZWl2ZXIgPQ0KICAgICAgICAgICAgKChPcGVuSlBBRW50aXR5TWFuYWdl\nckZhY3RvcnlTUEkpIHBtZlJlY2VpdmVyKS5nZXRDb25maWd1cmF0aW9uKCkN\nCiAgICAgICAgICAgICAgICAuZ2V0RGF0YUNhY2hlTWFuYWdlckluc3RhbmNl\nKCkuZ2V0U3lzdGVtRGF0YUNhY2hlKCk7DQoNCiAgICAgICAgZGVsZXRlQWxs\nKFJ1bnRpbWVUZXN0MS5jbGFzcyk7DQogICAgICAgIGRlbGV0ZUFsbChSdW50\naW1lVGVzdDIuY2xhc3MpOw0KDQogICAgICAgIF9ydW50aW1lMXNPaWRzID0g\nbnVsbDsNCiAgICAgICAgX3J1bnRpbWUyc09pZHMgPSBudWxsOw0KDQogICAg\nICAgIFN0cmluZyB0cmFuc1R5cGUgPSAibm9ybWFsIjsNCiAgICAgICAgU3Ry\naW5nIHJjcFR5cGUgPSAiT0lEcyI7DQogICAgICAgIGlmIChhc0xhcmdlVHJh\nbnNhY3Rpb24pIHsNCiAgICAgICAgICAgIHRyYW5zVHlwZSA9ICJsYXJnZSI7\nDQogICAgICAgICAgICByY3BUeXBlID0gImNsYXNzZXMiOw0KICAgICAgICB9\nDQogICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbigiLS0tLS0tLS0tLS0tLS0t\nLS0tLSIpOw0KICAgICAgICBTeXN0ZW0ub3V0DQogICAgICAgICAgICAucHJp\nbnRsbigNCiAgICAgICAgICAgICAgICAiMiBQTUZzIGNyZWF0ZWQsIGFjdGlu\nZyBhcyBhIGNsdXN0ZXIgdXNpbmcgcG9ydHMgNTYzNiBhbmQgNjYzNiIpOw0K\nICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oIlRlc3Rpbmcgc2NlbmFyaW86\nIik7DQogICAgICAgIFN5c3RlbS5vdXQNCiAgICAgICAgICAgIC5wcmludGxu\nKCIgIDEgU2VlZCBkYXRhc3RvcmUgd2l0aCBpbnN0YW5jZXMgb2YgUnVudGlt\nZVRlc3QxIEFORCAiDQogICAgICAgICAgICAgICAgKyAiUnVudGltZVRlc3Qy\nIG9ianMuXG4iDQogICAgICAgICAgICAgICAgKyAiICAyIHBtZjIgZmlsbHMg\naXRzIGNhY2hlIHdpdGggYm90aCBzZXRzIG9mIG9ianMuXG4iDQogICAgICAg\nICAgICAgICAgKyAiICAzIHBtZjEgZG9lcyBhICINCiAgICAgICAgICAgICAg\nICArIHRyYW5zVHlwZQ0KICAgICAgICAgICAgICAgICsgIiB0eCB0aGF0IGlu\ndm9rZXMgYW4gb3BlcmF0aW9uIG9mICINCiAgICAgICAgICAgICAgICArIGNo\nYW5nZU9wZXJhdGlvbi5nZXROYW1lKCkNCiAgICAgICAgICAgICAgICArICIg\ndG8gYWZmZWN0IGEgc2luZ2xlIFJ1bnRpbWUxIFxuIg0KICAgICAgICAgICAg\nICAgICsgIiAgICBhc3NlcnQgdGhhdCBib3RoIHBtZjEgYW5kIHBtZjIncyBk\nYXRhIGNhY2hlcyBkcm9wcGVkIGFsbCINCiAgICAgICAgICAgICAgICArICJS\ndW50aW1lMXMiKTsNCiAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKCJSZW1v\ndGUgY29tbWl0IGV2ZW50IGlzIHRyYW5zbWl0aW5nICIgKyByY3BUeXBlKTsN\nCg0KICAgICAgICAvLyBDcmVhdGUgcnVudGltZXMxcyBhbmQgMnMuDQogICAg\nICAgIC8vIE5vcmFtbCB0cmFuc2FjdGlvbg0KICAgICAgICBPcGVuSlBBRW50\naXR5TWFuYWdlciBwbVNlbmRlciA9IChPcGVuSlBBRW50aXR5TWFuYWdlcikg\ncG1mU2VuZGVyDQogICAgICAgICAgICAuY3JlYXRlRW50aXR5TWFuYWdlcigp\nOw0KICAgICAgICBzZWVkRGF0YVN0b3JlKHBtU2VuZGVyLCBOVU1fT0JKRUNU\nUyk7DQogICAgICAgIGVuZEVtKHBtU2VuZGVyKTsNCg0KICAgICAgICAvLyB3\nYWl0IGEgYml0IHNvIHRoZXkgZ2V0IHN0b3JlZA0KICAgICAgICBwYXVzZSgx\nKTsNCg0KICAgICAgICBPcGVuSlBBRW50aXR5TWFuYWdlciBwbTI7DQogICAg\nICAgIHBtMiA9IChPcGVuSlBBRW50aXR5TWFuYWdlcikgcG1mUmVjZWl2ZXIu\nY3JlYXRlRW50aXR5TWFuYWdlcigpOw0KICAgICAgICBwZXJmb3JtTG9hZEFs\nbChwbTIpOw0KICAgICAgICBlbmRFbShwbTIpOw0KDQogICAgICAgIHBtU2Vu\nZGVyID0gKE9wZW5KUEFFbnRpdHlNYW5hZ2VyKSBwbWZTZW5kZXIuY3JlYXRl\nRW50aXR5TWFuYWdlcigpOw0KICAgICAgICBwZXJmb3JtTG9hZEFsbChwbVNl\nbmRlcik7DQogICAgICAgIGVuZEVtKHBtU2VuZGVyKTsNCg0KICAgICAgICAv\nLyBhc3NlcnQgdGhhdCBwbWYyJ3MgZGF0YSBjYWNoZSBub3cgaGFzIGFsbCB0\naGUgUnVudGltZTEgYW5kIDJzLg0KICAgICAgICBmb3IgKGludCBpID0gMDsg\naSA8IF9ydW50aW1lMXNPaWRzLmxlbmd0aDsgaSsrKSB7DQogICAgICAgICAg\nICBhc3NlcnRUcnVlKGRjUmVjZWl2ZXIuY29udGFpbnMoDQogICAgICAgICAg\nICAgICAgSWQubmV3SW5zdGFuY2UoUnVudGltZVRlc3QxLmNsYXNzLCBfcnVu\ndGltZTFzT2lkc1tpXSkpKTsNCiAgICAgICAgfQ0KICAgICAgICBmb3IgKGlu\ndCBpID0gMDsgaSA8IF9ydW50aW1lMnNPaWRzLmxlbmd0aDsgaSsrKSB7DQog\nICAgICAgICAgICBhc3NlcnRUcnVlKGRjUmVjZWl2ZXIuY29udGFpbnMoDQog\nICAgICAgICAgICAgICAgSWQubmV3SW5zdGFuY2UoUnVudGltZVRlc3QyLmNs\nYXNzLCBfcnVudGltZTJzT2lkc1tpXSkpKTsNCiAgICAgICAgfQ0KDQogICAg\nICAgIC8vIE1vZGlmeSBvciBkZWxldGUgZXhhY3RseSAxIFJ1bnRpbWVUZXN0\nMSBvYmplY3QgZHVyaW5nIGENCiAgICAgICAgLy8gbGFyZ2VUcmFuc2FjdGlv\nbg0KICAgICAgICBjaGFuZ2VPcGVyYXRpb24ub3BlcmF0aW9uKHBtZlNlbmRl\nciwgYXNMYXJnZVRyYW5zYWN0aW9uKTsNCg0KICAgICAgICAvLyBhc3NlcnQg\ndGhhdCBwbWYxJ3MgZGF0YSBjYWNoZSBub3cgb25seSBoYXMgUnVudGltZTIg\nb2JqZWN0cw0KICAgICAgICBpZiAoYXNMYXJnZVRyYW5zYWN0aW9uKSB7DQog\nICAgICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IF9ydW50aW1lMXNPaWRz\nLmxlbmd0aDsgaSsrKSB7DQogICAgICAgICAgICAgICAgYXNzZXJ0RmFsc2Uo\nZGNTZW5kZXIuY29udGFpbnMoDQogICAgICAgICAgICAgICAgICAgIElkLm5l\nd0luc3RhbmNlKFJ1bnRpbWVUZXN0MS5jbGFzcywgX3J1bnRpbWUxc09pZHNb\naV0pKSk7DQogICAgICAgICAgICB9DQogICAgICAgIH0gZWxzZSB7DQogICAg\nICAgICAgICAvLyBOb3JtYWwgdHJhbnNhY3Rpb24NCiAgICAgICAgICAgIGZv\nciAoaW50IGkgPSAwOyBpIDwgX3J1bnRpbWUxc09pZHMubGVuZ3RoOyBpKysp\nIHsNCiAgICAgICAgICAgICAgICBpZiAoaXNEZWxldGUgJiYgaSA9PSAwKSB7\nDQogICAgICAgICAgICAgICAgICAgIGFzc2VydEZhbHNlKGRjU2VuZGVyLmNv\nbnRhaW5zKA0KICAgICAgICAgICAgICAgICAgICAgICAgSWQubmV3SW5zdGFu\nY2UoUnVudGltZVRlc3QxLmNsYXNzLCBfcnVudGltZTFzT2lkc1tpXSkpKTsN\nCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAg\nICAvLyBtb2RpZmllZCB0aGUgZmlyc3QgZWxlbW50LCB3aGljaCBqdXN0IHVw\nZGF0ZWQgaXQuDQogICAgICAgICAgICAgICAgICAgIC8vIChmb3IgS29kbydz\nIGRhdGEgY2FjaGUpLg0KICAgICAgICAgICAgICAgICAgICBhc3NlcnRUcnVl\nKGRjU2VuZGVyLmNvbnRhaW5zKA0KICAgICAgICAgICAgICAgICAgICAgICAg\nSWQubmV3SW5zdGFuY2UoUnVudGltZVRlc3QxLmNsYXNzLCBfcnVudGltZTFz\nT2lkc1tpXSkpKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9\nDQogICAgICAgIH0NCiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBfcnVu\ndGltZTJzT2lkcy5sZW5ndGg7IGkrKykgew0KICAgICAgICAgICAgYXNzZXJ0\nVHJ1ZShkY1NlbmRlci5jb250YWlucygNCiAgICAgICAgICAgICAgICBJZC5u\nZXdJbnN0YW5jZShSdW50aW1lVGVzdDIuY2xhc3MsIF9ydW50aW1lMnNPaWRz\nW2ldKSkpOw0KICAgICAgICB9DQogICAgICAgIC8vIHdhaXQgYSB0aW55IGJp\ndCBzbyB0aGUgcmNlIHByb3BhZ2F0ZXMNCiAgICAgICAgcGF1c2UoMik7DQog\nICAgICAgIC8vIGFzc2VydCB0aGUgcG1mMidzIGRhdGEgY2FjaGUgYWxzbyBu\nb3cgb25seSBoYXMgUnVudGltZTIgb2JqZWN0cw0KICAgICAgICBpZiAoYXNM\nYXJnZVRyYW5zYWN0aW9uKSB7DQogICAgICAgICAgICBmb3IgKGludCBpID0g\nMDsgaSA8IF9ydW50aW1lMXNPaWRzLmxlbmd0aDsgaSsrKSB7DQogICAgICAg\nICAgICAgICAgYXNzZXJ0RmFsc2UoZGNSZWNlaXZlci5jb250YWlucyhJZC5u\nZXdJbnN0YW5jZSgNCiAgICAgICAgICAgICAgICAgICAgUnVudGltZVRlc3Qx\nLmNsYXNzLCBfcnVudGltZTFzT2lkc1tpXSkpKTsgLy9mYWlsaW5nIGhlcmUN\nCiAgICAgICAgICAgIH0NCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAg\nIGZvciAoaW50IGkgPSAwOyBpIDwgX3J1bnRpbWUxc09pZHMubGVuZ3RoOyBp\nKyspIHsNCiAgICAgICAgICAgICAgICBpZiAoaSA9PSAwKSB7DQogICAgICAg\nICAgICAgICAgICAgIGFzc2VydEZhbHNlKGRjUmVjZWl2ZXIuY29udGFpbnMo\nSWQubmV3SW5zdGFuY2UoDQogICAgICAgICAgICAgICAgICAgICAgICBSdW50\naW1lVGVzdDEuY2xhc3MsDQogICAgICAgICAgICAgICAgICAgICAgICBfcnVu\ndGltZTFzT2lkc1tpXSkpKTsgIC8vZmFpbGluZyBoZXJlDQogICAgICAgICAg\nICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgYXNzZXJ0VHJ1\nZShkY1JlY2VpdmVyLmNvbnRhaW5zKA0KICAgICAgICAgICAgICAgICAgICAg\nICAgSWQubmV3SW5zdGFuY2UoUnVudGltZVRlc3QxLmNsYXNzLCBfcnVudGlt\nZTFzT2lkc1tpXSkpKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAg\nICB9DQogICAgICAgIH0NCiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBf\ncnVudGltZTJzT2lkcy5sZW5ndGg7IGkrKykgew0KICAgICAgICAgICAgYXNz\nZXJ0VHJ1ZShkY1JlY2VpdmVyLmNvbnRhaW5zKA0KICAgICAgICAgICAgICAg\nIElkLm5ld0luc3RhbmNlKFJ1bnRpbWVUZXN0Mi5jbGFzcywgX3J1bnRpbWUy\nc09pZHNbaV0pKSk7DQogICAgICAgIH0NCg0KICAgICAgICAvLyBzaHV0ZG93\nbg0KICAgICAgICBwbWZTZW5kZXIuY2xvc2UoKTsNCiAgICAgICAgcG1mUmVj\nZWl2ZXIuY2xvc2UoKTsNCiAgICB9DQoNCiAgICBwcm90ZWN0ZWQgdm9pZCBw\nZXJmb3JtTG9hZEFsbChPcGVuSlBBRW50aXR5TWFuYWdlciBwbSkNCiAgICAv\nLyBsb2FkIGluIChhbmQgdGh1cyBjYWNoZSkgYWxsIHRoZSAxcyBhbmQgMnMN\nCiAgICB7DQogICAgICAgIHN0YXJ0VHgocG0pOw0KICAgICAgICBSdW50aW1l\nVGVzdDEgdGVtcDE7DQogICAgICAgIENvbGxlY3Rpb24gcnVudGltZTFzID0g\nKENvbGxlY3Rpb24pIHBtDQogICAgICAgICAgICAuY3JlYXRlUXVlcnkoIlNF\nTEVDVCBhIEZST00gUnVudGltZVRlc3QxIGEiKS5nZXRSZXN1bHRMaXN0KCk7\nDQoNCiAgICAgICAgZm9yIChJdGVyYXRvciBpdHIgPSBydW50aW1lMXMuaXRl\ncmF0b3IoKTsgaXRyLmhhc05leHQoKTspDQogICAgICAgICAgICB0ZW1wMSA9\nIChSdW50aW1lVGVzdDEpIGl0ci5uZXh0KCk7DQogICAgICAgIFJ1bnRpbWVU\nZXN0MiB0ZW1wMjsNCiAgICAgICAgQ29sbGVjdGlvbiBydW50aW1lMnMgPSAo\nQ29sbGVjdGlvbikgcG0NCiAgICAgICAgICAgIC5jcmVhdGVRdWVyeSgiU0VM\nRUNUIGEgRlJPTSBSdW50aW1lVGVzdDIgYSIpLmdldFJlc3VsdExpc3QoKTsN\nCg0KICAgICAgICBmb3IgKEl0ZXJhdG9yIGl0ciA9IHJ1bnRpbWUycy5pdGVy\nYXRvcigpOyBpdHIuaGFzTmV4dCgpOykNCiAgICAgICAgICAgIHRlbXAyID0g\nKFJ1bnRpbWVUZXN0MikgaXRyLm5leHQoKTsNCiAgICAgICAgZW5kVHgocG0p\nOw0KICAgIH0NCg0KICAgIHByb3RlY3RlZCB2b2lkIHNlZWREYXRhU3RvcmUo\nT3BlbkpQQUVudGl0eU1hbmFnZXIgcG0sIGludCBudW1PYmplY3RzKSB7DQog\nICAgICAgIHN0YXJ0VHgocG0pOw0KICAgICAgICAvLyBjcmVhdGUgb2JqZWN0\ncw0KICAgICAgICBSdW50aW1lVGVzdDFbXSBwZXJzaXN0YWJsZXMgPSBuZXcg\nUnVudGltZVRlc3QxW251bU9iamVjdHNdOw0KICAgICAgICBfcnVudGltZTFz\nT2lkcyA9IG5ldyBPYmplY3RbbnVtT2JqZWN0c107DQogICAgICAgIGZvciAo\naW50IGkgPSAwOyBpIDwgcGVyc2lzdGFibGVzLmxlbmd0aDsgaSsrKSB7DQog\nICAgICAgICAgICBwZXJzaXN0YWJsZXNbaV0gPSBuZXcgUnVudGltZVRlc3Qx\nKCJmb28gIyIgKyBpLCBpKTsNCiAgICAgICAgICAgIHBtLnBlcnNpc3QocGVy\nc2lzdGFibGVzW2ldKTsNCiAgICAgICAgICAgIF9ydW50aW1lMXNPaWRzW2ld\nID0gcG0uZ2V0T2JqZWN0SWQocGVyc2lzdGFibGVzW2ldKTsNCiAgICAgICAg\nICAgIGlmIChpID09IDApIHsNCiAgICAgICAgICAgICAgICBwZXJzaXN0YWJs\nZXNbaV0uc2V0U3RyaW5nRmllbGQoIlNwZWNpYWxSdW50aW1lVGVzdDEiKTsN\nCiAgICAgICAgICAgICAgICBzcGVjX29pZCA9IHBtLmdldE9iamVjdElkKHBl\ncnNpc3RhYmxlc1tpXSk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAg\nICAgICAgUnVudGltZVRlc3QyW10gcGVyc2lzdGFibGVzMiA9IG5ldyBSdW50\naW1lVGVzdDJbbnVtT2JqZWN0c107DQogICAgICAgIF9ydW50aW1lMnNPaWRz\nID0gbmV3IE9iamVjdFtudW1PYmplY3RzXTsNCiAgICAgICAgZm9yIChpbnQg\naSA9IDA7IGkgPCBwZXJzaXN0YWJsZXMyLmxlbmd0aDsgaSsrKSB7DQogICAg\nICAgICAgICBwZXJzaXN0YWJsZXMyW2ldID0gbmV3IFJ1bnRpbWVUZXN0Migi\nYmFyICMiICsgaSwgaSk7DQogICAgICAgICAgICBwbS5wZXJzaXN0KHBlcnNp\nc3RhYmxlczJbaV0pOw0KICAgICAgICAgICAgX3J1bnRpbWUyc09pZHNbaV0g\nPSBwbS5nZXRPYmplY3RJZChwZXJzaXN0YWJsZXMyW2ldKTsNCiAgICAgICAg\nfQ0KICAgICAgICBlbmRUeChwbSk7DQogICAgfQ0KDQogICAgc3RhdGljIGlu\ndCBfZmV0Y2hHcm91cFNlcmlhbCA9IDA7DQoNCiAgICBwcm90ZWN0ZWQgT3Bl\nbkpQQUVudGl0eU1hbmFnZXJGYWN0b3J5IGNyZWF0ZURpc3RpbmN0RmFjdG9y\neSgNCiAgICAgICAgQ2xhc3MgcHJvdmlkZXJDbGFzcywgU3RyaW5nIGNsYXNz\nUHJvcHMxKSB7DQogICAgICAgIE1hcCBwcm9wc01hcDsNCg0KICAgICAgICBp\nZiAocHJvdmlkZXJDbGFzcyAhPSBudWxsKSB7DQogICAgICAgICAgICAvLyBU\naGlzIHRlc3QgaXMgZm9yIHRoZSBjb21iaW5hdGlvbiBvZiBSQ1AsIGxhcmdl\nVHJhbnMsDQogICAgICAgICAgICAvLyBhbmQgS29kbydzIGJ1aWx0aW4gRGF0\nYUNhY2hlLg0KICAgICAgICAgICAgLy8gdXNlIHRoaXMgcHJvcGVydHkgdG8g\nZGlmZmVyZW50aWF0ZSB0aGUgZmFjdG9yeQ0KDQogICAgICAgICAgICBwcm9w\nc01hcCA9IG5ldyBIYXNoTWFwKCk7DQogICAgICAgICAgICBwcm9wc01hcC5w\ndXQoIm9wZW5qcGEuRGF0YUNhY2hlIiwgImxydSIpOw0KICAgICAgICAgICAg\ncHJvcHNNYXAucHV0KCJvcGVuanBhLlJlbW90ZUNvbW1pdFByb3ZpZGVyIiwg\nQ29uZmlndXJhdGlvbnMuZ2V0UGx1Z2luKA0KICAgICAgICAgICAgICAgIHBy\nb3ZpZGVyQ2xhc3MuZ2V0TmFtZSgpLCBjbGFzc1Byb3BzMSkpOw0KICAgICAg\nICAgICAgcHJvcHNNYXAucHV0KCJvcGVuanBhLkZldGNoR3JvdXBzIiwgImRp\nZmZlcmVudGlhdGluZ0ZldGNoR3JvdXAiDQogICAgICAgICAgICAgICAgKyBf\nZmV0Y2hHcm91cFNlcmlhbCk7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAg\nICAgICAvLyBObyBSQ1ANCiAgICAgICAgICAgIHByb3BzTWFwID0gbmV3IEhh\nc2hNYXAoKTsNCiAgICAgICAgICAgIHByb3BzTWFwLnB1dCgib3BlbmpwYS5S\nZW1vdGVDb21taXRQcm92aWRlciIsICJzanZtIik7DQogICAgICAgICAgICBw\ncm9wc01hcC5wdXQoIm9wZW5qcGEuRmV0Y2hHcm91cHMiLCAiZGlmZmVyZW50\naWF0aW5nRmV0Y2hHcm91cCINCiAgICAgICAgICAgICAgICArIF9mZXRjaEdy\nb3VwU2VyaWFsKTsNCiAgICAgICAgfQ0KICAgICAgICBfZmV0Y2hHcm91cFNl\ncmlhbCArPSAxOw0KDQogICAgICAgIHJldHVybiAoT3BlbkpQQUVudGl0eU1h\nbmFnZXJGYWN0b3J5KSBnZXRFbWYocHJvcHNNYXApOw0KICAgIH0NCg0KICAg\nIHByaXZhdGUgdm9pZCBwYXVzZShkb3VibGUgc2Vjb25kcykgew0KICAgICAg\nICB0cnkgew0KICAgICAgICAgICAgVGhyZWFkLmN1cnJlbnRUaHJlYWQoKS55\naWVsZCgpOw0KICAgICAgICAgICAgVGhyZWFkLmN1cnJlbnRUaHJlYWQoKS5z\nbGVlcCgoaW50KSBzZWNvbmRzICogMTAwMCk7DQogICAgICAgIH0NCiAgICAg\nICAgY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7DQogICAgICAgIH0NCiAgICB9DQp9\nDQoNCi8qDQogcmVtb3ZlIGFsbCBSdW50ZWltMSwgYW5kIDINCiBjcmVhdGUg\nYSBmZXcgMSBhbmQgMnMNCiBnZXQgdGhlbSBpbnRvIHRoZSBjYWNoZSwgYXNz\nZXJ0DQogbGFyZ2UgdHJhbnNhY3Rpb24sIGFuZCBtb2RpZnkgYSBydW50aW1l\nMiwgYXNzZXJ0IGNhY2hlIG9ubHkgaGFzIHJ1bnRpbWUxcw0KDQoNCiByZW1v\ndmUgYWxsIFJ1bnRlaW0xLCBhbmQgMg0KIGNyZWF0ZSBhIGZldyAxIGFuZCAy\ncw0KIGdldCB0aGVtIGludG8gdGhlIGNhY2hlLCBhc3NlcnQNCiBsYXJnZSB0\ncmFuc2FjdGlvbiwgZGVsZXRlIGEgcnVudGltZTIsIGFzc2VydCBjYWNoZSBv\nbmx5IGhhcyBydW50ZWltZTFzDQogKi8NCg0K\n","encoding":"base64"}

