{"sha":"791ee9d4a9fd6bbe7d11583221a2c598276ac66b","node_id":"MDQ6QmxvYjIwNjM2NDo3OTFlZTlkNGE5ZmQ2YmJlN2QxMTU4MzIyMWEyYzU5ODI3NmFjNjZi","size":11526,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/791ee9d4a9fd6bbe7d11583221a2c598276ac66b","content":"LyoNCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUNCiAqIG9yIG1vcmUgY29udHJpYnV0b3Ig\nbGljZW5zZSBhZ3JlZW1lbnRzLiAgU2VlIHRoZSBOT1RJQ0UgZmlsZQ0KICog\nZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5m\nb3JtYXRpb24NCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAg\nVGhlIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUNCiAqIHRvIHlvdSB1bmRlciB0\naGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUNCiAqICJMaWNl\nbnNlIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNv\nbXBsaWFuY2UNCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFp\nbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQNCiAqDQogKiBodHRwOi8vd3d3\nLmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjANCiAqDQogKiBVbmxl\nc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGlu\nIHdyaXRpbmcsDQogKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUg\nTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbg0KICogIkFTIElTIiBCQVNJ\nUywgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZDQog\nKiBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBM\naWNlbnNlIGZvciB0aGUNCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmlu\nZyBwZXJtaXNzaW9ucyBhbmQgbGltaXRhdGlvbnMNCiAqIHVuZGVyIHRoZSBM\naWNlbnNlLiAgICANCiAqLw0KcGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEu\ncGVyc2lzdGVuY2UuZGF0YWNhY2hlOw0KDQppbXBvcnQgamF2YS51dGlsLkFy\ncmF5TGlzdDsNCmltcG9ydCBqYXZhLnV0aWwuQ29sbGVjdGlvbjsNCmltcG9y\ndCBqYXZhLnV0aWwuSGFzaE1hcDsNCmltcG9ydCBqYXZhLnV0aWwuSXRlcmF0\nb3I7DQppbXBvcnQgamF2YS51dGlsLkxpc3Q7DQppbXBvcnQgamF2YS51dGls\nLk1hcDsNCmltcG9ydCBqYXZheC5wZXJzaXN0ZW5jZS5FbnRpdHlNYW5hZ2Vy\nRmFjdG9yeTsNCg0KDQppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNp\nc3RlbmNlLmRhdGFjYWNoZS5jb21tb24uYXBwcy5DYWNoZU9iamVjdEFDaGls\nZDE7DQppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNlLmNv\nbW1vbi51dGlscy5BYnN0cmFjdFRlc3RDYXNlOw0KDQppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLmtlcm5lbC5Ccm9rZXI7DQppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLmtlcm5lbC5Ccm9rZXJGYWN0b3J5Ow0KaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS5rZXJuZWwuUXVlcnk7DQppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLmtlcm5lbC5qcHFsLkpQUUxQYXJzZXI7DQppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNlLkpQQUZhY2FkZUhlbHBlcjsN\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuT3BlbkpQ\nQUVudGl0eU1hbmFnZXJGYWN0b3J5Ow0KDQovKioNCiAqIFRlc3QgdGhhdCB3\nZSBtYXJzaGFsbCBhbmQgdW5tYXJzaGFsbCByZXN1bHQgdHlwZXMgYXBwcm9w\ncmlhdGVseS4NCiAqLw0KcHVibGljIGNsYXNzIFRlc3RSZXN1bHRTaGFwZXMg\nZXh0ZW5kcyBBYnN0cmFjdFRlc3RDYXNlIHsNCg0KICAgIHB1YmxpYyBUZXN0\nUmVzdWx0U2hhcGVzKFN0cmluZyB0ZXN0KSB7DQogICAgICAgIHN1cGVyKHRl\nc3QsICJkYXRhY2FjaGVjYWN0dXNhcHAiKTsNCiAgICB9DQoNCiAgICBwcml2\nYXRlIEJyb2tlciBfYnJva2VyOw0KDQogICAgcHVibGljIHZvaWQgc2V0VXAo\nKSB7DQogICAgICAgIGRlbGV0ZUFsbChDYWNoZU9iamVjdEFDaGlsZDEuY2xh\nc3MpOw0KDQogICAgICAgIE1hcCBwcm9wc01hcCA9IG5ldyBIYXNoTWFwKCk7\nDQogICAgICAgIHByb3BzTWFwLnB1dCgib3BlbmpwYS5EYXRhQ2FjaGUiLCAi\ndHJ1ZSIpOw0KICAgICAgICBwcm9wc01hcC5wdXQoIm9wZW5qcGEuUmVtb3Rl\nQ29tbWl0UHJvdmlkZXIiLCAic2p2bSIpOw0KICAgICAgICBFbnRpdHlNYW5h\nZ2VyRmFjdG9yeSBlbWYgPSBnZXRFbWYocHJvcHNNYXApOw0KICAgICAgICBC\ncm9rZXJGYWN0b3J5IGZhY3RvcnkgPSBKUEFGYWNhZGVIZWxwZXIudG9Ccm9r\nZXJGYWN0b3J5KGVtZik7DQoNCiAgICAgICAgQnJva2VyIGJyb2tlciA9IGZh\nY3RvcnkubmV3QnJva2VyKCk7DQogICAgICAgIGJyb2tlci5iZWdpbigpOw0K\nICAgICAgICBicm9rZXIucGVyc2lzdChuZXcgQ2FjaGVPYmplY3RBQ2hpbGQx\nKCJmb28iLCAiZm9vIiwgMCksIG51bGwpOw0KICAgICAgICBicm9rZXIucGVy\nc2lzdChuZXcgQ2FjaGVPYmplY3RBQ2hpbGQxKCJiYXIiLCAiYmFyIiwgMSks\nIG51bGwpOw0KICAgICAgICBicm9rZXIuY29tbWl0KCk7DQogICAgICAgIGJy\nb2tlci5jbG9zZSgpOw0KDQogICAgICAgIF9icm9rZXIgPSBmYWN0b3J5Lm5l\nd0Jyb2tlcigpOw0KICAgIH0NCg0KICAgIHB1YmxpYyB2b2lkIHRlYXJEb3du\nKCkgdGhyb3dzIEV4Y2VwdGlvbiB7DQogICAgICAgIF9icm9rZXIuY2xvc2Uo\nKTsNCg0KICAgICAgICBzdXBlci50ZWFyRG93bigpOw0KICAgIH0NCg0KICAg\nIC8vIEZJWE1FIFNlZXRoYSBOb3YgMywyMDA2DQogICAgLy8gbmVlZCB0byBr\nbm93IGFib3V0IHRoZSAndGhpcycgcGFyYW1ldGVyDQoNCi8vCXB1YmxpYyB2\nb2lkIHRlc3RDb2xsZWN0aW9uT2ZDYW5kaWRhdGVDbGFzcygpIA0KLy8JeyAN\nCi8vCQlDb2xsZWN0aW9uPFN0cmluZz4gYWMgPSBuZXcgQXJyYXlMaXN0PFN0\ncmluZz4oKTsNCi8vCQlhYy5hZGQoInRoaXMiKTsNCi8vDQovLwkJQ29sbGVj\ndGlvbjxDbGFzcz4gYmQgPSBuZXcgQXJyYXlMaXN0PENsYXNzPigpOw0KLy8J\nCWJkLmFkZChDYWNoZU9iamVjdEFDaGlsZDEuY2xhc3MpOw0KLy8JCQ0KLy8J\nCWFycmF5SGVscGVyKGZhbHNlLCBiZCwgbnVsbCwgdHJ1ZSk7IA0KLy8JCW1h\ncEhlbHBlcihmYWxzZSwgYmQsIGFjLCB0cnVlKTsNCi8vCQlyYXdIZWxwZXIo\nZmFsc2UsIENhY2hlT2JqZWN0QUNoaWxkMS5jbGFzcywgbnVsbCwgdHJ1ZSk7\nIA0KLy8JfQ0KLy8JDQovLwlwdWJsaWMgdm9pZCB0ZXN0VW5pcXVlQ2FuZGlk\nYXRlQ2xhc3MoKSANCi8vCXsgDQovLwkJQ29sbGVjdGlvbjxTdHJpbmc+IGFj\nID0gbmV3IEFycmF5TGlzdDxTdHJpbmc+KCk7DQovLwkJYWMuYWRkKCJ0aGlz\nIik7DQovLw0KLy8JCUNvbGxlY3Rpb248Q2xhc3M+IGJkID0gbmV3IEFycmF5\nTGlzdDxDbGFzcz4oKTsNCi8vCQliZC5hZGQoQ2FjaGVPYmplY3RBQ2hpbGQx\nLmNsYXNzKTsNCi8vCQkNCi8vCQlhcnJheUhlbHBlcih0cnVlLCBiZCwgbnVs\nbCwgdHJ1ZSk7IA0KLy8JCW1hcEhlbHBlcih0cnVlLCBiZCwgYWMsIHRydWUp\nOw0KLy8JCXJhd0hlbHBlcih0cnVlLCBDYWNoZU9iamVjdEFDaGlsZDEuY2xh\nc3MsIG51bGwsIHRydWUpOyANCi8vCX0NCg0KICAgIHB1YmxpYyB2b2lkIHRl\nc3RDb2xsZWN0aW9uT2ZTaW5nbGVWYWx1ZWRQcm9qZWN0aW9uKCkgew0KDQog\nICAgICAgIENvbGxlY3Rpb248U3RyaW5nPiBhYyA9IG5ldyBBcnJheUxpc3Q8\nU3RyaW5nPigpOw0KICAgICAgICBhYy5hZGQoImFnZSIpOw0KDQogICAgICAg\nIENvbGxlY3Rpb248Q2xhc3M+IGJkID0gbmV3IEFycmF5TGlzdDxDbGFzcz4o\nKTsNCiAgICAgICAgYmQuYWRkKExvbmcuY2xhc3MpOw0KDQogICAgICAgIGFy\ncmF5SGVscGVyKGZhbHNlLCBiZCwgYWMsIHRydWUpOw0KICAgICAgICBtYXBI\nZWxwZXIoZmFsc2UsIGJkLCBhYywgdHJ1ZSk7DQogICAgICAgIHJhd0hlbHBl\ncihmYWxzZSwgTG9uZy5jbGFzcywgImFnZSIsIHRydWUpOw0KICAgIH0NCg0K\nICAgIHB1YmxpYyB2b2lkIHRlc3RVbmlxdWVTaW5nbGVWYWx1ZWRQcm9qZWN0\naW9uKCkgew0KICAgICAgICBDb2xsZWN0aW9uPFN0cmluZz4gYWMgPSBuZXcg\nQXJyYXlMaXN0PFN0cmluZz4oKTsNCiAgICAgICAgYWMuYWRkKCJhZ2UiKTsN\nCg0KICAgICAgICBDb2xsZWN0aW9uPENsYXNzPiBiZCA9IG5ldyBBcnJheUxp\nc3Q8Q2xhc3M+KCk7DQogICAgICAgIGJkLmFkZChMb25nLmNsYXNzKTsNCg0K\nICAgICAgICBhcnJheUhlbHBlcih0cnVlLCBiZCwgYWMsIHRydWUpOw0KICAg\nICAgICBtYXBIZWxwZXIodHJ1ZSwgYmQsIGFjLCB0cnVlKTsNCiAgICAgICAg\ncmF3SGVscGVyKHRydWUsIExvbmcuY2xhc3MsICJhZ2UiLCB0cnVlKTsNCiAg\nICB9DQoNCiAgICBwdWJsaWMgdm9pZCB0ZXN0Q29sbGVjdGlvbk9mTXVsdGlW\nYWx1ZWRQcm9qZWN0aW9uKCkgew0KICAgICAgICBDb2xsZWN0aW9uPFN0cmlu\nZz4gYWMgPSBuZXcgQXJyYXlMaXN0PFN0cmluZz4oKTsNCiAgICAgICAgYWMu\nYWRkKCJhZ2UiKTsNCiAgICAgICAgYWMuYWRkKCJuYW1lIik7DQoNCiAgICAg\nICAgQ29sbGVjdGlvbjxDbGFzcz4gYmQgPSBuZXcgQXJyYXlMaXN0PENsYXNz\nPigpOw0KICAgICAgICBiZC5hZGQoTG9uZy5jbGFzcyk7DQogICAgICAgIGJk\nLmFkZChTdHJpbmcuY2xhc3MpOw0KDQogICAgICAgIGFycmF5SGVscGVyKGZh\nbHNlLCBiZCwgYWMsIHRydWUpOw0KDQogICAgICAgIG1hcEhlbHBlcihmYWxz\nZSwgYmQsIGFjLCB0cnVlKTsNCiAgICAgICAgLy8gd2UgcHV0IGJvdGgNCiAg\nICAgICAgLy8gcHJvamVjdGlvbnMgaW4gc2luZ2xlIHNsb3QgaW4gYXJyYXkg\nYmVjYXVzZSB0aGlzIGlzIGENCiAgICAgICAgLy8gc2luZ2xlIHJlc3VsdCB0\naGF0IHdlJ3JlDQogICAgICAgIC8vIGxvb2tpbmcNCiAgICAgICAgLy8gZm9y\nLiBJdCBqdXN0IGhhcHBlbnMgdGhhdCB0aGUgLy8gc2luZ2xlIHJlc3VsdCBm\nb3JtYXQgd2UgZXhwZWN0IGlzDQogICAgICAgIC8vIGFuIE9iamVjdFtdLiBy\nYXdIZWxwZXIoZmFsc2UsIE9iamVjdFtdLmNsYXNzLCAiYWdlLCBuYW1lIiwg\ndHJ1ZSk7DQogICAgfQ0KDQogICAgcHVibGljIHZvaWQgdGVzdFVuaXF1ZU11\nbHRpVmFsdWVkUHJvamVjdGlvbigpIHsNCiAgICAgICAgQ29sbGVjdGlvbjxT\ndHJpbmc+IGFjID0gbmV3IEFycmF5TGlzdDxTdHJpbmc+KCk7DQogICAgICAg\nIGFjLmFkZCgiYWdlIik7DQogICAgICAgIGFjLmFkZCgibmFtZSIpOw0KDQog\nICAgICAgIENvbGxlY3Rpb248Q2xhc3M+IGJkID0gbmV3IEFycmF5TGlzdDxD\nbGFzcz4oKTsNCiAgICAgICAgYmQuYWRkKExvbmcuY2xhc3MpOw0KICAgICAg\nICBiZC5hZGQoU3RyaW5nLmNsYXNzKTsNCg0KICAgICAgICBhcnJheUhlbHBl\ncih0cnVlLCBiZCwgYWMsIHRydWUpOw0KICAgICAgICBtYXBIZWxwZXIodHJ1\nZSwgYmQsIGFjLCB0cnVlKTsNCiAgICAgICAgLy8gd2UgcHV0DQogICAgICAg\nIC8vIGJvdGgNCiAgICAgICAgLy8gcHJvamVjdGlvbnMgaW4gc2luZ2xlIHNs\nb3QgaW4gYXJyYXkgYmVjYXVzZSB0aGlzIGlzIGENCiAgICAgICAgLy8gc2lu\nZ2xlIHJlc3VsdCB0aGF0DQogICAgICAgIC8vIHdlJ3JlIGxvb2tpbmcNCiAg\nICAgICAgLy8gZm9yLglJdCBqdXN0IGhhcHBlbnMgdGhhdCB0aGUgLy8gc2lu\nZ2xlIHJlc3VsdCBmb3JtYXQgd2UNCiAgICAgICAgLy8gZXhwZWN0IGlzIGFu\nCU9iamVjdFtdLiByYXdIZWxwZXIodHJ1ZSwgT2JqZWN0W10uY2xhc3MsICJh\nZ2UsIG5hbWUiLCB0cnVlKTsNCiAgICB9DQoNCiAgICBwdWJsaWMgdm9pZCB0\nZXN0VW5jYWNoZWRRdWVyeUhhc0NvcnJlY3RTaGFwZSgpIHsNCiAgICAgICAg\nQ29sbGVjdGlvbjxTdHJpbmc+IGFjID0gbmV3IEFycmF5TGlzdDxTdHJpbmc+\nKCk7DQogICAgICAgIGFjLmFkZCgiYWdlIik7DQogICAgICAgIGFjLmFkZCgi\nbmFtZSIpOw0KDQogICAgICAgIENvbGxlY3Rpb248Q2xhc3M+IGJkID0gbmV3\nIEFycmF5TGlzdDxDbGFzcz4oKTsNCiAgICAgICAgYmQuYWRkKExvbmcuY2xh\nc3MpOw0KICAgICAgICBiZC5hZGQoU3RyaW5nLmNsYXNzKTsNCg0KICAgICAg\nICBfYnJva2VyLmdldEZldGNoQ29uZmlndXJhdGlvbigpLnNldFF1ZXJ5Q2Fj\naGVFbmFibGVkKGZhbHNlKTsNCg0KICAgICAgICBhcnJheUhlbHBlcihmYWxz\nZSwgYmQsIGFjLCBmYWxzZSk7DQogICAgICAgIG1hcEhlbHBlcihmYWxzZSwg\nYmQsIGFjLCBmYWxzZSk7DQogICAgICAgIHJhd0hlbHBlcihmYWxzZSwgT2Jq\nZWN0W10uY2xhc3MsICJhZ2UsIGEubmFtZSIsIGZhbHNlKTsNCiAgICB9DQoN\nCiAgICBwcml2YXRlIHZvaWQgYXJyYXlIZWxwZXIoYm9vbGVhbiB1bmlxdWUs\nIENvbGxlY3Rpb24gcmVjb3JkQ2xhc3NlcywNCiAgICAgICAgQ29sbGVjdGlv\nbiByZXN1bHRzLCBib29sZWFuIGluQ2FjaGUpIHsNCiAgICAgICAgUXVlcnkg\ncSA9IHNldFVwUXVlcnkodW5pcXVlLCByZXN1bHRzKTsNCiAgICAgICAgcS5z\nZXRSZXN1bHRUeXBlKE9iamVjdFtdLmNsYXNzKTsNCiAgICAgICAgaWYgKHVu\naXF1ZSkgew0KICAgICAgICAgICAgYXJyYXlSZXN1bHRIZWxwZXIocS5leGVj\ndXRlKCksIHJlY29yZENsYXNzZXMsIGluQ2FjaGUpOw0KICAgICAgICB9IGVs\nc2Ugew0KICAgICAgICAgICAgZm9yIChJdGVyYXRvciBpdGVyID0gKChMaXN0\nKSBxLmV4ZWN1dGUoKSkuaXRlcmF0b3IoKTsgaXRlcg0KICAgICAgICAgICAg\nICAgIC5oYXNOZXh0KCk7KQ0KICAgICAgICAgICAgICAgIGFycmF5UmVzdWx0\nSGVscGVyKGl0ZXIubmV4dCgpLCByZWNvcmRDbGFzc2VzLCBpbkNhY2hlKTsN\nCiAgICAgICAgfQ0KDQogICAgICAgIENhY2hlVGVzdEhlbHBlci5hc3NlcnRJ\nbkNhY2hlKHRoaXMsIHEsIG5ldyBCb29sZWFuKGluQ2FjaGUpKTsNCg0KICAg\nICAgICBpZiAodW5pcXVlKSB7DQogICAgICAgICAgICBhcnJheVJlc3VsdEhl\nbHBlcihxLmV4ZWN1dGUoKSwgcmVjb3JkQ2xhc3NlcywgaW5DYWNoZSk7DQog\nICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICBmb3IgKEl0ZXJhdG9yIGl0\nZXIgPSAoKExpc3QpIHEuZXhlY3V0ZSgpKS5pdGVyYXRvcigpOyBpdGVyDQog\nICAgICAgICAgICAgICAgLmhhc05leHQoKTspDQogICAgICAgICAgICAgICAg\nYXJyYXlSZXN1bHRIZWxwZXIoaXRlci5uZXh0KCksIHJlY29yZENsYXNzZXMs\nIGluQ2FjaGUpOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgcHJpdmF0ZSB2\nb2lkIGFycmF5UmVzdWx0SGVscGVyKE9iamVjdCByZXN1bHQsIENvbGxlY3Rp\nb24gcmVjb3JkQ2xhc3NlcywNCiAgICAgICAgYm9vbGVhbiBpbkNhY2hlKSB7\nDQogICAgICAgIGFzc2VydEVxdWFscyhPYmplY3RbXS5jbGFzcywgcmVzdWx0\nLmdldENsYXNzKCkpOw0KICAgICAgICBPYmplY3RbXSBvcyA9IChPYmplY3Rb\nXSkgcmVzdWx0Ow0KICAgICAgICBhc3NlcnRFcXVhbHMocmVjb3JkQ2xhc3Nl\ncy5zaXplKCksIG9zLmxlbmd0aCk7DQogICAgICAgIGZvciAoaW50IGkgPSAw\nOyBpIDwgcmVjb3JkQ2xhc3Nlcy5zaXplKCk7IGkrKykNCiAgICAgICAgICAg\nIGFzc2VydEVxdWFscygoKEFycmF5TGlzdCkgcmVjb3JkQ2xhc3NlcykuZ2V0\nKGkpLCBvc1tpXS5nZXRDbGFzcygpKTsNCiAgICB9DQoNCiAgICBwcml2YXRl\nIHZvaWQgbWFwSGVscGVyKGJvb2xlYW4gdW5pcXVlLCBDb2xsZWN0aW9uIHJl\nY29yZENsYXNzZXMsDQogICAgICAgIENvbGxlY3Rpb24gcmVzdWx0cywgYm9v\nbGVhbiBpbkNhY2hlKSB7DQogICAgICAgIFF1ZXJ5IHEgPSBzZXRVcFF1ZXJ5\nKHVuaXF1ZSwgcmVzdWx0cyk7DQogICAgICAgIFN5c3RlbS5vdXQucHJpbnRs\nbigiUXVlcnkgU3RyaW5nICIgKyBxLmdldFF1ZXJ5U3RyaW5nKCkpOw0KICAg\nICAgICBDb2xsZWN0aW9uIGNvbGwgPSBudWxsOw0KICAgICAgICBpZiAocS5l\neGVjdXRlKCkgIT0gbnVsbCAmJiAocS5leGVjdXRlKCkgaW5zdGFuY2VvZiBD\nb2xsZWN0aW9uKSkgew0KICAgICAgICAgICAgY29sbCA9IChDb2xsZWN0aW9u\nKSBxLmV4ZWN1dGUoKTsNCiAgICAgICAgfQ0KICAgICAgICBTeXN0ZW0ub3V0\nLnByaW50bG4oIlR5cGUgb2YgcS5leGVjdXRlIGlzIDogIiArIHEuZXhlY3V0\nZSgpLmdldENsYXNzKCkpOw0KDQogICAgICAgIEl0ZXJhdG9yIGl0ID0gY29s\nbC5pdGVyYXRvcigpOw0KICAgICAgICB3aGlsZSAoaXQuaGFzTmV4dCgpKQ0K\nICAgICAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKCJRdWVyeSByZXN1bHQg\naXMgIiArIGl0Lm5leHQoKS5nZXRDbGFzcygpKTsNCg0KICAgICAgICBxLnNl\ndFJlc3VsdFR5cGUoSGFzaE1hcC5jbGFzcyk7DQoNCiAgICAgICAgaWYgKHVu\naXF1ZSkgew0KICAgICAgICAgICAgbWFwUmVzdWx0SGVscGVyKHEuZXhlY3V0\nZSgpLCByZWNvcmRDbGFzc2VzLCByZXN1bHRzLCBpbkNhY2hlKTsNCiAgICAg\nICAgfSBlbHNlIHsNCiAgICAgICAgICAgIGZvciAoSXRlcmF0b3IgaXRlciA9\nICgoQ29sbGVjdGlvbikgcS5leGVjdXRlKCkpLml0ZXJhdG9yKCk7DQogICAg\nICAgICAgICAgICAgaXRlci5oYXNOZXh0KCk7KQ0KICAgICAgICAgICAgICAg\nIG1hcFJlc3VsdEhlbHBlcihpdGVyLm5leHQoKSwgcmVjb3JkQ2xhc3Nlcywg\ncmVzdWx0cywgaW5DYWNoZSk7DQogICAgICAgIH0NCg0KICAgICAgICBDYWNo\nZVRlc3RIZWxwZXIuYXNzZXJ0SW5DYWNoZSh0aGlzLCBxLCBuZXcgQm9vbGVh\nbihpbkNhY2hlKSk7DQoNCiAgICAgICAgaWYgKHVuaXF1ZSkgew0KICAgICAg\nICAgICAgbWFwUmVzdWx0SGVscGVyKHEuZXhlY3V0ZSgpLCByZWNvcmRDbGFz\nc2VzLCByZXN1bHRzLCBpbkNhY2hlKTsNCiAgICAgICAgfSBlbHNlIHsNCiAg\nICAgICAgICAgIGZvciAoSXRlcmF0b3IgaXRlciA9ICgoTGlzdCkgcS5leGVj\ndXRlKCkpLml0ZXJhdG9yKCk7IGl0ZXINCiAgICAgICAgICAgICAgICAuaGFz\nTmV4dCgpOykNCiAgICAgICAgICAgICAgICBtYXBSZXN1bHRIZWxwZXIoaXRl\nci5uZXh0KCksIHJlY29yZENsYXNzZXMsIHJlc3VsdHMsIGluQ2FjaGUpOw0K\nICAgICAgICB9DQogICAgfQ0KDQogICAgcHJpdmF0ZSB2b2lkIG1hcFJlc3Vs\ndEhlbHBlcihPYmplY3QgcmVzdWx0LCBDb2xsZWN0aW9uIHJlY29yZENsYXNz\nZXMsDQogICAgICAgIENvbGxlY3Rpb24gcmVzdWx0cywgYm9vbGVhbiBpbkNh\nY2hlKSB7DQogICAgICAgIGFzc2VydEVxdWFscyhIYXNoTWFwLmNsYXNzLCBy\nZXN1bHQuZ2V0Q2xhc3MoKSk7DQogICAgICAgIEhhc2hNYXAgbSA9IChIYXNo\nTWFwKSByZXN1bHQ7DQogICAgICAgIGFzc2VydEVxdWFscyhyZWNvcmRDbGFz\nc2VzLnNpemUoKSwgbS5zaXplKCkpOw0KICAgICAgICBmb3IgKGludCBpID0g\nMDsgaSA8IHJlY29yZENsYXNzZXMuc2l6ZSgpOyBpKyspDQogICAgICAgICAg\nICBhc3NlcnRFcXVhbHMoIk1hcCBDb250ZW50cyAiICsgbS50b1N0cmluZygp\nICsgIiByZXN1bHQ6ICIgKyByZXN1bHQNCiAgICAgICAgICAgICAgICArICIg\nbG9vcCBzaXplOiAiICsgcmVjb3JkQ2xhc3Nlcy5zaXplKCkNCiAgICAgICAg\nICAgICAgICArICJWYWx1ZSBvZiBtLmdldChyZXN1bHRzW2ldKSAiDQogICAg\nICAgICAgICAgICAgKyBtLmdldCgoKEFycmF5TGlzdCkgcmVzdWx0cykuZ2V0\nKGkpLmdldENsYXNzKCkpLA0KICAgICAgICAgICAgICAgICgoQXJyYXlMaXN0\nKSByZWNvcmRDbGFzc2VzKS5nZXQoaSksDQogICAgICAgICAgICAgICAgbS5n\nZXQoImpwcWxhbGlhcyIgKyAoaSArIDEpKS5nZXRDbGFzcygpKTsNCiAgICB9\nDQoNCiAgICBwcml2YXRlIHZvaWQgcmF3SGVscGVyKGJvb2xlYW4gdW5pcXVl\nLCBDbGFzcyByZWNvcmRDbGFzcywgU3RyaW5nIHJlc3VsdCwNCiAgICAgICAg\nYm9vbGVhbiBpbkNhY2hlKSB7DQogICAgICAgIEFycmF5TGlzdDxTdHJpbmc+\nIGwgPSBuZXcgQXJyYXlMaXN0PFN0cmluZz4oKTsNCiAgICAgICAgbC5hZGQo\ncmVzdWx0KTsNCiAgICAgICAgQ29sbGVjdGlvbiByZXMgPSAocmVzdWx0ID09\nIG51bGwpID8gbnVsbCA6IGw7DQogICAgICAgIFF1ZXJ5IHEgPSBzZXRVcFF1\nZXJ5KHVuaXF1ZSwgcmVzKTsNCiAgICAgICAgaWYgKHVuaXF1ZSkNCiAgICAg\nICAgICAgIGFzc2VydEVxdWFscyhyZWNvcmRDbGFzcywgcS5leGVjdXRlKCku\nZ2V0Q2xhc3MoKSk7DQogICAgICAgIGVsc2Ugew0KICAgICAgICAgICAgcS5z\nZXRVbmlxdWUodW5pcXVlKTsNCiAgICAgICAgICAgIGZvciAoSXRlcmF0b3Ig\naXRlciA9ICgoTGlzdCkgcS5leGVjdXRlKCkpLml0ZXJhdG9yKCk7IGl0ZXIN\nCiAgICAgICAgICAgICAgICAuaGFzTmV4dCgpOykNCiAgICAgICAgICAgICAg\nICBhc3NlcnRFcXVhbHMocmVjb3JkQ2xhc3MsIGl0ZXIubmV4dCgpLmdldENs\nYXNzKCkpOw0KICAgICAgICB9DQoNCiAgICAgICAgQ2FjaGVUZXN0SGVscGVy\nLmFzc2VydEluQ2FjaGUodGhpcywgcSwgbmV3IEJvb2xlYW4oaW5DYWNoZSkp\nOw0KDQogICAgICAgIGlmICh1bmlxdWUpIHsNCiAgICAgICAgICAgIGFzc2Vy\ndEVxdWFscyhyZWNvcmRDbGFzcywgcS5leGVjdXRlKCkuZ2V0Q2xhc3MoKSk7\nDQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICBmb3IgKEl0ZXJhdG9y\nIGl0ZXIgPSAoKExpc3QpIHEuZXhlY3V0ZSgpKS5pdGVyYXRvcigpOyBpdGVy\nDQogICAgICAgICAgICAgICAgLmhhc05leHQoKTspDQogICAgICAgICAgICAg\nICAgYXNzZXJ0RXF1YWxzKHJlY29yZENsYXNzLCBpdGVyLm5leHQoKS5nZXRD\nbGFzcygpKTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIHByaXZhdGUgUXVl\ncnkgc2V0VXBRdWVyeShib29sZWFuIHVuaXF1ZSwgQ29sbGVjdGlvbiByZXN1\nbHRzKSB7DQogICAgICAgIFN0cmluZyBmaWx0ZXIgPSAic2VsZWN0IjsNCiAg\nICAgICAgQXJyYXlMaXN0IHJlc3VsdHNsID0gKEFycmF5TGlzdCkgcmVzdWx0\nczsNCiAgICAgICAgaWYgKHJlc3VsdHMgIT0gbnVsbCkgew0KICAgICAgICAg\nICAgU3RyaW5nIHJlc3VsdFN0cmluZyA9ICIiOw0KICAgICAgICAgICAgZm9y\nIChpbnQgaSA9IDA7IGkgPCByZXN1bHRzbC5zaXplKCk7IGkrKykgew0KICAg\nICAgICAgICAgICAgIHJlc3VsdFN0cmluZyArPSAiYS4iICsgcmVzdWx0c2wu\nZ2V0KGkpOw0KICAgICAgICAgICAgICAgIGlmIChpIDwgcmVzdWx0cy5zaXpl\nKCkgLSAxKQ0KICAgICAgICAgICAgICAgICAgICByZXN1bHRTdHJpbmcgKz0g\nIiwgIjsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGZpbHRlciArPSAi\nICIgKyByZXN1bHRTdHJpbmc7DQogICAgICAgICAgICBmaWx0ZXIgKz0gIiAi\nICsgImZyb20gIg0KICAgICAgICAgICAgICAgICsgQ2FjaGVPYmplY3RBQ2hp\nbGQxLmNsYXNzLmdldFN1cGVyY2xhc3MoKS5nZXRTaW1wbGVOYW1lKCkNCiAg\nICAgICAgICAgICAgICArICIgYSI7DQogICAgICAgIH0gZWxzZSB7DQogICAg\nICAgICAgICBmaWx0ZXIgKz0gIiAiICsgImEgZnJvbSAiDQogICAgICAgICAg\nICAgICAgKyBDYWNoZU9iamVjdEFDaGlsZDEuY2xhc3MuZ2V0U3VwZXJjbGFz\ncygpLmdldFNpbXBsZU5hbWUoKQ0KICAgICAgICAgICAgICAgICsgIiBhIjsN\nCiAgICAgICAgfQ0KDQogICAgICAgIGlmICh1bmlxdWUpDQogICAgICAgICAg\nICBmaWx0ZXIgKz0gIiB3aGVyZSBhLmFnZSA9IDAiOw0KICAgICAgICBTeXN0\nZW0ub3V0LnByaW50bG4oIioqKipRdWVyeTogIiArIGZpbHRlcik7DQogICAg\nICAgIFF1ZXJ5IHEgPSBfYnJva2VyLm5ld1F1ZXJ5KEpQUUxQYXJzZXIuTEFO\nR19KUFFMLCBmaWx0ZXIpOw0KICAgICAgICBxLnNldFVuaXF1ZSh1bmlxdWUp\nOw0KICAgICAgICBxLnNldENhbmRpZGF0ZVR5cGUoQ2FjaGVPYmplY3RBQ2hp\nbGQxLmNsYXNzLCBmYWxzZSk7DQoNCiAgICAgICAgcmV0dXJuIHE7DQogICAg\nfQ0KfQ0K\n","encoding":"base64"}

