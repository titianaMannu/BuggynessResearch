{"sha":"652d5a53f4730d76b6a3224b35e44d13f4fa9fb5","node_id":"MDQ6QmxvYjIwNjM2NDo2NTJkNWE1M2Y0NzMwZDc2YjZhMzIyNGIzNWU0NGQxM2Y0ZmE5ZmI1","size":19551,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/652d5a53f4730d76b6a3224b35e44d13f4fa9fb5","content":"LyoNCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUNCiAqIG9yIG1vcmUgY29udHJpYnV0b3Ig\nbGljZW5zZSBhZ3JlZW1lbnRzLiAgU2VlIHRoZSBOT1RJQ0UgZmlsZQ0KICog\nZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5m\nb3JtYXRpb24NCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAg\nVGhlIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUNCiAqIHRvIHlvdSB1bmRlciB0\naGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUNCiAqICJMaWNl\nbnNlIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNv\nbXBsaWFuY2UNCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFp\nbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQNCiAqDQogKiBodHRwOi8vd3d3\nLmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjANCiAqDQogKiBVbmxl\nc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGlu\nIHdyaXRpbmcsDQogKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUg\nTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbg0KICogIkFTIElTIiBCQVNJ\nUywgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZDQog\nKiBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBM\naWNlbnNlIGZvciB0aGUNCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmlu\nZyBwZXJtaXNzaW9ucyBhbmQgbGltaXRhdGlvbnMNCiAqIHVuZGVyIHRoZSBM\naWNlbnNlLiAgICANCiAqLw0KcGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEu\ncGVyc2lzdGVuY2UuZW5oYW5jZTsNCg0KaW1wb3J0IGphdmEubGFuZy5yZWZs\nZWN0Lk1ldGhvZDsNCmltcG9ydCBqYXZhLnV0aWwuSGFzaE1hcDsNCmltcG9y\ndCBqYXZhLnV0aWwuTGlzdDsNCmltcG9ydCBqYXZhLnV0aWwuTWFwOw0KaW1w\nb3J0IGphdmF4LnBlcnNpc3RlbmNlLkVudGl0eU1hbmFnZXI7DQppbXBvcnQg\namF2YXgucGVyc2lzdGVuY2UuRW50aXR5TWFuYWdlckZhY3Rvcnk7DQoNCg0K\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5lbmhhbmNl\nLmNvbW1vbi5hcHBzLkJhY2tpbmdGaWVsZE5hbWVNaXNtYXRjaEluc3RhbmNl\nOw0KaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5lbmhh\nbmNlLmNvbW1vbi5hcHBzLkJhc2VFbnRpdHk7DQppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLnBlcnNpc3RlbmNlLmVuaGFuY2UuY29tbW9uLmFwcHMuQmFz\naWNTdWJjbGFzc0luc3RhbmNlOw0KaW1wb3J0IG9yZy5hcGFjaGUub3Blbmpw\nYS5wZXJzaXN0ZW5jZS5lbmhhbmNlLmNvbW1vbi5hcHBzLkRlcml2ZWRFbnRp\ndHk7DQppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNlLmVu\naGFuY2UuY29tbW9uLmFwcHMuRW50aXR5MTsNCmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEucGVyc2lzdGVuY2UuZW5oYW5jZS5jb21tb24uYXBwcy5NYW5h\nZ2VkSW52ZXJzZVRlc3RJbnN0YW5jZTsNCmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEucGVyc2lzdGVuY2UuZW5oYW5jZS5jb21tb24uYXBwcy5NYW5hZ2Vk\nSW52ZXJzZVRlc3RJbnN0YW5jZTI7DQppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLnBlcnNpc3RlbmNlLmVuaGFuY2UuY29tbW9uLmFwcHMuU3ViY2xhc3NU\nZXN0SW5zdGFuY2U7DQppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNp\nc3RlbmNlLmNvbW1vbi51dGlscy5BYnN0cmFjdFRlc3RDYXNlOw0KaW1wb3J0\nIGp1bml0LmZyYW1ld29yay5Bc3NlcnRpb25GYWlsZWRFcnJvcjsNCmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLkJyb2tlcjsNCmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLk9wZW5KUEFTdGF0ZU1hbmFnZXI7\nDQppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuQ2xhc3NNZXRhRGF0\nYTsNCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YS5GaWVsZE1ldGFE\nYXRhOw0KaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5K\nUEFGYWNhZGVIZWxwZXI7DQppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnBl\ncnNpc3RlbmNlLk9wZW5KUEFFbnRpdHlNYW5hZ2VyOw0KaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5PcGVuSlBBUXVlcnk7DQppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuRXhjZXB0aW9uSW5mbzsNCmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5JbXBsSGVscGVyOw0KDQpw\ndWJsaWMgY2xhc3MgVGVzdFN1YmNsYXNzZWRCZWhhdmlvciBleHRlbmRzIEFi\nc3RyYWN0VGVzdENhc2Ugew0KDQogICAgcHVibGljIFRlc3RTdWJjbGFzc2Vk\nQmVoYXZpb3IoU3RyaW5nIG5hbWUpIHsNCiAgICAgICAgc3VwZXIobmFtZSwg\nImVuaGFuY2VjYWN0dXNhcHAiKTsNCiAgICB9DQoNCg0KICAgIHB1YmxpYyB2\nb2lkIHNldFVwKCkgew0KICAgICAgICBkZWxldGVBbGwoQmFzaWNTdWJjbGFz\nc0luc3RhbmNlLmNsYXNzKTsNCiAgICAgICAgZGVsZXRlQWxsKEJhY2tpbmdG\naWVsZE5hbWVNaXNtYXRjaEluc3RhbmNlLmNsYXNzKTsNCiAgICAgICAgZGVs\nZXRlQWxsKEJhc2VFbnRpdHkuY2xhc3MpOw0KICAgICAgICBkZWxldGVBbGwo\nTWFuYWdlZEludmVyc2VUZXN0SW5zdGFuY2UuY2xhc3MpOw0KICAgICAgICBk\nZWxldGVBbGwoTWFuYWdlZEludmVyc2VUZXN0SW5zdGFuY2UyLmNsYXNzKTsN\nCiAgICB9DQoNCiAgICBwdWJsaWMgdm9pZCB0ZXN0SW5oZXJpdGFuY2UoKSB7\nDQogICAgICAgIE9wZW5KUEFFbnRpdHlNYW5hZ2VyIHBtID0NCiAgICAgICAg\nICAgIChPcGVuSlBBRW50aXR5TWFuYWdlcikgY3VycmVudEVudGl0eU1hbmFn\nZXIoKTsNCiAgICAgICAgRGVyaXZlZEVudGl0eSBkZSA9IChEZXJpdmVkRW50\naXR5KSBuZXdJbnN0YW5jZShwbSwgRGVyaXZlZEVudGl0eS5jbGFzcyk7DQog\nICAgICAgIEJhc2ljU3ViY2xhc3NJbnN0YW5jZSBiYXNpYyA9IChCYXNpY1N1\nYmNsYXNzSW5zdGFuY2UpIG5ld0luc3RhbmNlKHBtLA0KICAgICAgICAgICAg\nQmFzaWNTdWJjbGFzc0luc3RhbmNlLmNsYXNzKTsNCiAgICAgICAgYmFzaWMu\nc2V0U3RyaW5nRmllbGQoImJhc2ljIG9uZS10by1vbmUiKTsNCiAgICAgICAg\nZGUuc2V0T25lVG9PbmUoYmFzaWMpOw0KICAgICAgICBPYmplY3Qgb2lkID0g\ncGVyc2lzdGVuY2VPcGVyYXRpb25zKHBtLCBkZSwgZmFsc2UpOw0KDQogICAg\nICAgIC8vICMjIyMjIG5lZWQgYSB0ZXN0IGNhc2UgZm9yIEpET0hlbHBlci5j\ncmVhdGVFbnRpdHlNYW5hZ2VyKCkgZm9yDQogICAgICAgIC8vIHN1YmNsYXNz\nDQogICAgICAgIENsYXNzTWV0YURhdGEgbWV0YSA9IEpQQUZhY2FkZUhlbHBl\nci5nZXRNZXRhRGF0YShwbSwgZGUuZ2V0Q2xhc3MoKSk7DQogICAgICAgIGFz\nc2VydEVxdWFscyhCYXNlRW50aXR5LmNsYXNzLCBtZXRhLmdldFBDU3VwZXJj\nbGFzcygpKTsNCg0KICAgICAgICBwbSA9IChPcGVuSlBBRW50aXR5TWFuYWdl\ncikgY3VycmVudEVudGl0eU1hbmFnZXIoKTsNCg0KICAgICAgICBPYmplY3Qg\nbyA9IHBtLmZpbmQoRGVyaXZlZEVudGl0eS5jbGFzcywgb2lkKTsNCiAgICAg\nICAgYXNzZXJ0VHJ1ZShvIGluc3RhbmNlb2YgRGVyaXZlZEVudGl0eSk7DQog\nICAgICAgIGRlID0gKERlcml2ZWRFbnRpdHkpIG87DQogICAgICAgIEJyb2tl\nciBiID0gSlBBRmFjYWRlSGVscGVyLnRvQnJva2VyKHBtKTsNCiAgICAgICAg\nT3BlbkpQQVN0YXRlTWFuYWdlciBzbSA9IGIuZ2V0U3RhdGVNYW5hZ2VyKGRl\nKTsNCiAgICAgICAgLy8gd2UgdXNlIGdldExvYWRlZCgpIGhlcmUgYmVjYXVz\nZSBpc0xvYWRlZCgpIGFsd2F5cyByZXR1cm5zIHRydWUuDQogICAgICAgIGFz\nc2VydEZhbHNlKHNtLmdldExvYWRlZCgpLmdldCgNCiAgICAgICAgICAgIHNt\nLmdldE1ldGFEYXRhKCkuZ2V0RmllbGQoIm9uZVRvT25lIikuZ2V0SW5kZXgo\nKSkpOw0KICAgICAgICBhc3NlcnRFcXVhbHMoImJhc2ljIG9uZS10by1vbmUi\nLCBkZS5nZXRPbmVUb09uZSgpLmdldFN0cmluZ0ZpZWxkKCkpOw0KICAgICAg\nICBhc3NlcnRUcnVlKHNtLmdldExvYWRlZCgpLmdldChzbS5nZXRNZXRhRGF0\nYSgpDQogICAgICAgICAgICAuZ2V0RmllbGQoIm9uZVRvT25lIikuZ2V0SW5k\nZXgoKSkpOw0KDQogICAgICAgIHN0YXJ0VHgocG0pOw0KICAgICAgICBwbS5y\nZW1vdmUoZGUpOw0KICAgICAgICBlbmRUeChwbSk7DQogICAgICAgIGVuZEVt\nKHBtKTsNCiAgICB9DQoNCiAgICBwdWJsaWMgdm9pZCB0ZXN0QmFzaWNTdWJj\nbGFzc1BlcnNpc3RlbmNlT3BlcmF0aW9ucygpDQogICAgICAgIHRocm93cyBD\nbGFzc05vdEZvdW5kRXhjZXB0aW9uIHsNCiAgICAgICAgT3BlbkpQQUVudGl0\neU1hbmFnZXIgcG0gPQ0KICAgICAgICAgICAgKE9wZW5KUEFFbnRpdHlNYW5h\nZ2VyKSBjdXJyZW50RW50aXR5TWFuYWdlcigpOw0KICAgICAgICBCYXNpY1N1\nYmNsYXNzSW5zdGFuY2UgbyA9IChCYXNpY1N1YmNsYXNzSW5zdGFuY2UpIG5l\nd0luc3RhbmNlKHBtLA0KICAgICAgICAgICAgQmFzaWNTdWJjbGFzc0luc3Rh\nbmNlLmNsYXNzKTsNCiAgICAgICAgcGVyc2lzdGVuY2VPcGVyYXRpb25zKHBt\nLCBvLCB0cnVlKTsNCiAgICB9DQoNCiAgICBwdWJsaWMgdm9pZCB0ZXN0QmFj\na2luZ0ZpZWxkTmFtZU1pc21hdGNoKCkgew0KICAgICAgICBPcGVuSlBBRW50\naXR5TWFuYWdlciBwbSA9DQogICAgICAgICAgICAoT3BlbkpQQUVudGl0eU1h\nbmFnZXIpIGN1cnJlbnRFbnRpdHlNYW5hZ2VyKCk7DQogICAgICAgIEJhY2tp\nbmdGaWVsZE5hbWVNaXNtYXRjaEluc3RhbmNlIG8gPSAoQmFja2luZ0ZpZWxk\nTmFtZU1pc21hdGNoSW5zdGFuY2UpDQogICAgICAgICAgICBuZXdJbnN0YW5j\nZShwbSwgQmFja2luZ0ZpZWxkTmFtZU1pc21hdGNoSW5zdGFuY2UuY2xhc3Mp\nOw0KICAgICAgICBwZXJzaXN0ZW5jZU9wZXJhdGlvbnMocG0sIG8sIHRydWUp\nOw0KICAgIH0NCg0KICAgIHByaXZhdGUgT2JqZWN0IG5ld0luc3RhbmNlKE9w\nZW5KUEFFbnRpdHlNYW5hZ2VyIHBtLCBDbGFzcyBjbHMpIHsNCiAgICAgICAg\ncmV0dXJuIHBtLmNyZWF0ZUluc3RhbmNlKGNscyk7DQogICAgfQ0KDQogICAg\ncHJpdmF0ZSBPYmplY3QgY3JlYXRlSW5zdGFuY2UoRW50aXR5TWFuYWdlciBl\nbSwgQ2xhc3MgY2xzKSB7DQogICAgICAgIHJldHVybiAoKE9wZW5KUEFFbnRp\ndHlNYW5hZ2VyKSBlbSkuY3JlYXRlSW5zdGFuY2UoY2xzKTsNCiAgICB9DQoN\nCiAgICBwcml2YXRlIE9iamVjdCBwZXJzaXN0ZW5jZU9wZXJhdGlvbnMoT3Bl\nbkpQQUVudGl0eU1hbmFnZXIgcG0sDQogICAgICAgIFN1YmNsYXNzVGVzdElu\nc3RhbmNlIG8sIGJvb2xlYW4gZGVsZXRlKSB7DQogICAgICAgIHN0YXJ0VHgo\ncG0pOw0KICAgICAgICBwbS5wZXJzaXN0KG8pOw0KICAgICAgICBvLnNldFN0\ncmluZ0ZpZWxkKCJuZXcgcGVyc2lzdGVudCBpbnN0YW5jZSIpOw0KICAgICAg\nICBlbmRUeChwbSk7DQogICAgICAgIE9iamVjdCBvaWQgPSBwbS5nZXRPYmpl\nY3RJZChvKTsNCiAgICAgICAgZW5kRW0ocG0pOw0KDQogICAgICAgIHBtID0g\nKE9wZW5KUEFFbnRpdHlNYW5hZ2VyKSBjdXJyZW50RW50aXR5TWFuYWdlcigp\nOw0KICAgICAgICBvID0gKFN1YmNsYXNzVGVzdEluc3RhbmNlKSBwbS5maW5k\nKFN1YmNsYXNzVGVzdEluc3RhbmNlLmNsYXNzLCBvaWQpOw0KDQogICAgICAg\nIGFzc2VydEVxdWFscygibmV3IHBlcnNpc3RlbnQgaW5zdGFuY2UiLCBvLmdl\ndFN0cmluZ0ZpZWxkKCkpOw0KICAgICAgICBzdGFydFR4KHBtKTsNCiAgICAg\nICAgby5zZXRTdHJpbmdGaWVsZCgibW9kaWZpZWQgcGVyc2lzdGVudCBpbnN0\nYW5jZSIpOw0KICAgICAgICBlbmRUeChwbSk7DQogICAgICAgIGVuZEVtKHBt\nKTsNCg0KICAgICAgICBpZiAoZGVsZXRlKSB7DQogICAgICAgICAgICBwbSA9\nIChPcGVuSlBBRW50aXR5TWFuYWdlcikgY3VycmVudEVudGl0eU1hbmFnZXIo\nKTsNCiAgICAgICAgICAgIG8gPSAoU3ViY2xhc3NUZXN0SW5zdGFuY2UpIHBt\nLmZpbmQoU3ViY2xhc3NUZXN0SW5zdGFuY2UuY2xhc3MsIG9pZCk7DQogICAg\nICAgICAgICBhc3NlcnRFcXVhbHMoIm1vZGlmaWVkIHBlcnNpc3RlbnQgaW5z\ndGFuY2UiLCBvLmdldFN0cmluZ0ZpZWxkKCkpOw0KICAgICAgICAgICAgc3Rh\ncnRUeChwbSk7DQogICAgICAgICAgICBwbS5yZW1vdmUobyk7DQogICAgICAg\nICAgICBlbmRUeChwbSk7DQogICAgICAgICAgICBlbmRFbShwbSk7DQogICAg\nICAgICAgICByZXR1cm4gbnVsbDsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAg\nICAgICAgIHJldHVybiBvaWQ7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICBw\ndWJsaWMgdm9pZCB0ZXN0UG9seW1vcnBoaWNRdWVyaWVzKCkgew0KICAgICAg\nICBkZWxldGVBbGwoQmFzZUVudGl0eS5jbGFzcyk7DQogICAgICAgIGRlbGV0\nZUFsbChCYXNpY1N1YmNsYXNzSW5zdGFuY2UuY2xhc3MpOw0KDQogICAgICAg\nIE9wZW5KUEFFbnRpdHlNYW5hZ2VyIHBtID0NCiAgICAgICAgICAgIChPcGVu\nSlBBRW50aXR5TWFuYWdlcikgY3VycmVudEVudGl0eU1hbmFnZXIoKTsNCiAg\nICAgICAgc3RhcnRUeChwbSk7DQoNCiAgICAgICAgQmFzZUVudGl0eSBiZSA9\nIChCYXNlRW50aXR5KSBuZXdJbnN0YW5jZShwbSwgQmFzZUVudGl0eS5jbGFz\ncyk7DQogICAgICAgIGJlLnNldFNob3J0RmllbGQoKHNob3J0KSAwKTsNCiAg\nICAgICAgcG0ucGVyc2lzdChiZSk7DQoNCiAgICAgICAgYmUgPSAoQmFzZUVu\ndGl0eSkgbmV3SW5zdGFuY2UocG0sIEJhc2VFbnRpdHkuY2xhc3MpOw0KICAg\nICAgICBiZS5zZXRTaG9ydEZpZWxkKChzaG9ydCkgMSk7DQogICAgICAgIHBt\nLnBlcnNpc3QoYmUpOw0KDQogICAgICAgIERlcml2ZWRFbnRpdHkgZGUgPSAo\nRGVyaXZlZEVudGl0eSkgbmV3SW5zdGFuY2UocG0sIERlcml2ZWRFbnRpdHku\nY2xhc3MpOw0KICAgICAgICBkZS5zZXRTaG9ydEZpZWxkKChzaG9ydCkgMik7\nDQogICAgICAgIGRlLnNldE9uZVRvT25lKChCYXNpY1N1YmNsYXNzSW5zdGFu\nY2UpIG5ld0luc3RhbmNlKHBtLA0KICAgICAgICAgICAgQmFzaWNTdWJjbGFz\nc0luc3RhbmNlLmNsYXNzKSk7DQogICAgICAgIHBtLnBlcnNpc3QoZGUpOw0K\nDQogICAgICAgIGRlID0gKERlcml2ZWRFbnRpdHkpIG5ld0luc3RhbmNlKHBt\nLCBEZXJpdmVkRW50aXR5LmNsYXNzKTsNCiAgICAgICAgZGUuc2V0U2hvcnRG\naWVsZCgoc2hvcnQpIDMpOw0KICAgICAgICBkZS5zZXRPbmVUb09uZSgoQmFz\naWNTdWJjbGFzc0luc3RhbmNlKSBuZXdJbnN0YW5jZShwbSwNCiAgICAgICAg\nICAgIEJhc2ljU3ViY2xhc3NJbnN0YW5jZS5jbGFzcykpOw0KICAgICAgICBw\nbS5wZXJzaXN0KGRlKTsNCg0KICAgICAgICBlbmRUeChwbSk7DQogICAgICAg\nIGVuZEVtKHBtKTsNCg0KICAgICAgICBwbSA9IChPcGVuSlBBRW50aXR5TWFu\nYWdlcikgY3VycmVudEVudGl0eU1hbmFnZXIoKTsNCiAgICAgICAgT3BlbkpQ\nQVF1ZXJ5IHEgPQ0KICAgICAgICAgICAgcG0uY3JlYXRlUXVlcnkoIlNFTEVD\nVCBhIEZST00gQmFzZUVudGl0eSBhICINCiAgICAgICAgICAgICAgICArICJP\nUkRFUiBCWSBhLnNob3J0RmllbGQgQVNDIik7DQogICAgICAgIExpc3QgbCA9\nIChMaXN0KSBxLmdldFJlc3VsdExpc3QoKTsNCiAgICAgICAgYXNzZXJ0RXF1\nYWxzKDQsIGwuc2l6ZSgpKTsNCiAgICAgICAgYXNzZXJ0RXF1YWxzKDAsICgo\nQmFzZUVudGl0eSkgbC5nZXQoMCkpLmdldFNob3J0RmllbGQoKSk7DQogICAg\nICAgIGFzc2VydEVxdWFscygxLCAoKEJhc2VFbnRpdHkpIGwuZ2V0KDEpKS5n\nZXRTaG9ydEZpZWxkKCkpOw0KICAgICAgICBhc3NlcnRFcXVhbHMoMiwgKChC\nYXNlRW50aXR5KSBsLmdldCgyKSkuZ2V0U2hvcnRGaWVsZCgpKTsNCiAgICAg\nICAgYXNzZXJ0RXF1YWxzKDMsICgoQmFzZUVudGl0eSkgbC5nZXQoMykpLmdl\ndFNob3J0RmllbGQoKSk7DQogICAgICAgIGFzc2VydFRydWUobC5nZXQoMikg\naW5zdGFuY2VvZiBEZXJpdmVkRW50aXR5KTsNCiAgICAgICAgYXNzZXJ0VHJ1\nZShsLmdldCgzKSBpbnN0YW5jZW9mIERlcml2ZWRFbnRpdHkpOw0KICAgICAg\nICBlbmRFbShwbSk7DQogICAgfQ0KDQogICAgcHVibGljIHZvaWQgdGVzdEVu\naGFuY2VkQ2xhc3NDaGFuZ2VzT3V0c2lkZVR4V2l0aG91dE5UVygpIHsNCiAg\nICAgICAgT3BlbkpQQUVudGl0eU1hbmFnZXIgcG0gPQ0KICAgICAgICAgICAg\nKE9wZW5KUEFFbnRpdHlNYW5hZ2VyKSBjdXJyZW50RW50aXR5TWFuYWdlcigp\nOw0KICAgICAgICBzdGFydFR4KHBtKTsNCiAgICAgICAgZGVsZXRlQWxsKEVu\ndGl0eTEuY2xhc3MpOw0KICAgICAgICBlbmRUeChwbSk7DQogICAgICAgIEVu\ndGl0eTEgbyA9IG5ldyBFbnRpdHkxKDgsICJwayA4IiwgNCk7DQogICAgICAg\nIHN0YXJ0VHgocG0pOw0KICAgICAgICBwbS5wZXJzaXN0KG8pOw0KICAgICAg\nICBlbmRUeChwbSk7DQogICAgICAgIE9iamVjdCBvaWQgPSBwbS5nZXRPYmpl\nY3RJZChvKTsNCiAgICAgICAgZW5kRW0ocG0pOw0KDQogICAgICAgIHBtID0g\nKE9wZW5KUEFFbnRpdHlNYW5hZ2VyKSBjdXJyZW50RW50aXR5TWFuYWdlcigp\nOw0KICAgICAgICBvID0gKEVudGl0eTEpIHBtLmZpbmQoRW50aXR5MS5jbGFz\ncywgb2lkKTsNCg0KICAgICAgICB0cnkgew0KICAgICAgICAgICAgby5zZXRT\ndHJpbmdGaWVsZCgiaGVsbG8iKTsNCiAgICAgICAgICAgIGZhaWwoIm5vbi10\ncmFuc2FjdGlvbmFsIHdyaXRlIHNob3VsZCBub3QgYmUgYWxsb3dlZCIpOw0K\nICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkgew0KICAgICAgICAgICAg\nLy8gZXhwZWN0ZWQNCiAgICAgICAgfSBmaW5hbGx5IHsNCiAgICAgICAgICAg\nIGVuZEVtKHBtKTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIHB1YmxpYyB2\nb2lkIHRlc3RTdWJjbGFzc0NoYW5nZXNPdXRzaWRlVHhXaXRob3V0TlRXKCkg\new0KICAgICAgICBPcGVuSlBBRW50aXR5TWFuYWdlciBwbSA9DQogICAgICAg\nICAgICAoT3BlbkpQQUVudGl0eU1hbmFnZXIpIGN1cnJlbnRFbnRpdHlNYW5h\nZ2VyKCk7DQogICAgICAgIEJhc2ljU3ViY2xhc3NJbnN0YW5jZSBiYXNpYyA9\nIChCYXNpY1N1YmNsYXNzSW5zdGFuY2UpIG5ld0luc3RhbmNlKHBtLA0KICAg\nICAgICAgICAgQmFzaWNTdWJjbGFzc0luc3RhbmNlLmNsYXNzKTsNCiAgICAg\nICAgYmFzaWMuc2V0U3RyaW5nRmllbGQoImZvbyIpOw0KICAgICAgICBzdGFy\ndFR4KHBtKTsNCiAgICAgICAgcG0ucGVyc2lzdChiYXNpYyk7DQogICAgICAg\nIGVuZFR4KHBtKTsNCiAgICAgICAgT2JqZWN0IG9pZCA9IHBtLmdldE9iamVj\ndElkKGJhc2ljKTsNCiAgICAgICAgZW5kRW0ocG0pOw0KDQogICAgICAgIHBt\nID0gKE9wZW5KUEFFbnRpdHlNYW5hZ2VyKSBjdXJyZW50RW50aXR5TWFuYWdl\ncigpOw0KICAgICAgICBiYXNpYyA9DQogICAgICAgICAgICAoQmFzaWNTdWJj\nbGFzc0luc3RhbmNlKSBwbS5maW5kKEJhc2ljU3ViY2xhc3NJbnN0YW5jZS5j\nbGFzcywgb2lkKTsNCg0KICAgICAgICB0cnkgew0KICAgICAgICAgICAgYmFz\naWMuc2V0U3RyaW5nRmllbGQoImhlbGxvIik7DQogICAgICAgICAgICBmYWls\nKCJub24tdHJhbnNhY3Rpb25hbCB3cml0ZSBzaG91bGQgbm90IGJlIGFsbG93\nZWQiKTsNCiAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsNCiAgICAg\nICAgICAgIC8vIGV4cGVjdGVkDQogICAgICAgIH0gZmluYWxseSB7DQogICAg\nICAgICAgICBlbmRFbShwbSk7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICBw\ndWJsaWMgdm9pZCB0ZXN0QmFzaWNQTVVzZXMoKSB7DQogICAgICAgIC8vIHJl\ndGFpbiBzbyB3ZSBkb24ndCByZWxvYWQgaW4gdGhlIHJlYWRzIGFmdGVyIHRo\nZSB0eCBjb21taXQNCiAgICAgICAgT3BlbkpQQUVudGl0eU1hbmFnZXIgcG0g\nPQ0KICAgICAgICAgICAgKE9wZW5KUEFFbnRpdHlNYW5hZ2VyKSBjdXJyZW50\nRW50aXR5TWFuYWdlcigpOw0KICAgICAgICBCcm9rZXIgYnJva2VyID0gSlBB\nRmFjYWRlSGVscGVyLnRvQnJva2VyKHBtKTsNCiAgICAgICAgc3RhcnRUeChw\nbSk7DQoNCiAgICAgICAgLy8gcmVnaXN0ZXIgYSBuZXcgaW5zdGFuY2Ugd2l0\naCB0aGUgUE0NCiAgICAgICAgQmFzaWNTdWJjbGFzc0luc3RhbmNlIGJhc2lj\nID0gKEJhc2ljU3ViY2xhc3NJbnN0YW5jZSkgbmV3SW5zdGFuY2UNCiAgICAg\nICAgICAgIChwbSwgQmFzaWNTdWJjbGFzc0luc3RhbmNlLmNsYXNzKTsNCiAg\nICAgICAgYXNzZXJ0VHJ1ZShJbXBsSGVscGVyLmlzTWFuYWdlYWJsZShiYXNp\nYykpOw0KICAgICAgICBiYXNpYy5zZXRTdHJpbmdGaWVsZCgiZm9vIik7DQog\nICAgICAgIHBtLnBlcnNpc3QoYmFzaWMpOw0KICAgICAgICBhc3NlcnRUcnVl\nKGJyb2tlci5pc05ldyhiYXNpYykpOw0KICAgICAgICBhc3NlcnRUcnVlKGJy\nb2tlci5pc1BlcnNpc3RlbnQoYmFzaWMpKTsNCg0KICAgICAgICAvLyBjb21t\naXQuIHRoaXMgc2hvdWxkIGNhdXNlIHRoZSBkYXRhIHRvIGJlIHdyaXR0ZW4u\nDQogICAgICAgIC8vICMjIyBzaG91bGQgY2hlY2sgU1FMIGNvdW50DQogICAg\nICAgIGVuZFR4KHBtKTsNCg0KICAgICAgICBhc3NlcnRGYWxzZShicm9rZXIu\naXNOZXcoYmFzaWMpKTsNCg0KICAgICAgICBPcGVuSlBBU3RhdGVNYW5hZ2Vy\nIHNtID0gYnJva2VyLmdldFN0YXRlTWFuYWdlcihiYXNpYyk7DQogICAgICAg\nIGFzc2VydE5vdE51bGwoc20pOw0KICAgICAgICBhc3NlcnRFcXVhbHMoc20u\nZ2V0TWFuYWdlZEluc3RhbmNlKCksIGJhc2ljKTsNCg0KICAgICAgICBGaWVs\nZE1ldGFEYXRhIGZtZCA9IHNtLmdldE1ldGFEYXRhKCkuZ2V0RmllbGQoInN0\ncmluZ0ZpZWxkIik7DQogICAgICAgIGFzc2VydEVxdWFscygiZm9vIiwgc20u\nZmV0Y2goZm1kLmdldEluZGV4KCkpKTsNCiAgICAgICAgYXNzZXJ0VHJ1ZShz\nbS5nZXRMb2FkZWQoKS5nZXQoZm1kLmdldEluZGV4KCkpKTsNCg0KICAgICAg\nICBwbS5ldmljdChiYXNpYyk7DQogICAgICAgIGFzc2VydEZhbHNlKHNtLmdl\ndExvYWRlZCgpLmdldChmbWQuZ2V0SW5kZXgoKSkpOw0KICAgICAgICAvLyBs\nYXp5IGxvYWRpbmcNCiAgICAgICAgYXNzZXJ0Tm90TnVsbChiYXNpYy5nZXRT\ndHJpbmdGaWVsZCgpKTsNCiAgICAgICAgYXNzZXJ0RXF1YWxzKCJmb28iLCBz\nbS5mZXRjaChmbWQuZ2V0SW5kZXgoKSkpOw0KICAgICAgICBhc3NlcnRFcXVh\nbHMoImZvbyIsIGJhc2ljLmdldFN0cmluZ0ZpZWxkKCkpOw0KICAgICAgICBh\nc3NlcnRUcnVlKHNtLmdldExvYWRlZCgpLmdldChmbWQuZ2V0SW5kZXgoKSkp\nOw0KDQogICAgICAgIHN0YXJ0VHgocG0pOw0KICAgICAgICBiYXNpYy5zZXRT\ndHJpbmdGaWVsZCgiYmFyIik7DQogICAgICAgIGFzc2VydFRydWUoYnJva2Vy\nLmlzRGlydHkoYmFzaWMpKTsNCiAgICAgICAgZW5kVHgocG0pOw0KICAgICAg\nICBPYmplY3Qgb2lkID0gYnJva2VyLmdldE9iamVjdElkKGJhc2ljKTsNCiAg\nICAgICAgYXNzZXJ0Tm90TnVsbChvaWQpOw0KICAgICAgICBlbmRFbShwbSk7\nDQoNCiAgICAgICAgcG0gPSAoT3BlbkpQQUVudGl0eU1hbmFnZXIpIGN1cnJl\nbnRFbnRpdHlNYW5hZ2VyKCk7DQogICAgICAgIGJhc2ljID0NCiAgICAgICAg\nICAgIChCYXNpY1N1YmNsYXNzSW5zdGFuY2UpIHBtLmZpbmQoQmFzaWNTdWJj\nbGFzc0luc3RhbmNlLmNsYXNzLCBvaWQpOw0KICAgICAgICBhc3NlcnRFcXVh\nbHMoImJhciIsIGJhc2ljLmdldFN0cmluZ0ZpZWxkKCkpOw0KDQogICAgICAg\nIHN0YXJ0VHgocG0pOw0KICAgICAgICBwbS5yZW1vdmUoYmFzaWMpOw0KICAg\nICAgICBhc3NlcnRUcnVlKEpQQUZhY2FkZUhlbHBlci50b0Jyb2tlcihwbSku\naXNEZWxldGVkKGJhc2ljKSk7DQogICAgICAgIGVuZFR4KHBtKTsNCiAgICAg\nICAgZW5kRW0ocG0pOw0KICAgIH0NCg0KICAgIHB1YmxpYyB2b2lkIHRlc3RH\nZXRPYmplY3RJZCgpIHsNCiAgICAgICAgT3BlbkpQQUVudGl0eU1hbmFnZXIg\ncG0gPQ0KICAgICAgICAgICAgKE9wZW5KUEFFbnRpdHlNYW5hZ2VyKSBjdXJy\nZW50RW50aXR5TWFuYWdlcigpOw0KICAgICAgICBCYXNpY1N1YmNsYXNzSW5z\ndGFuY2UgYmFzaWMgPSBuZXcgQmFzaWNTdWJjbGFzc0luc3RhbmNlKCk7DQog\nICAgICAgIGJhc2ljLnNldFN0cmluZ0ZpZWxkKCJmb28iKTsNCiAgICAgICAg\nc3RhcnRUeChwbSk7DQogICAgICAgIHBtLnBlcnNpc3QoYmFzaWMpOw0KICAg\nICAgICBlbmRUeChwbSk7DQogICAgICAgIE9iamVjdCBvaWQgPSBudWxsOw0K\nICAgICAgICB0cnkgew0KICAgICAgICAgICAgYXNzZXJ0Tm90TnVsbChvaWQg\nPSBwbS5nZXRPYmplY3RJZChiYXNpYykpOw0KICAgICAgICB9IGNhdGNoIChF\neGNlcHRpb24gZSkgew0KICAgICAgICAgICAgZmFpbCgib2JqZWN0IGlkIGxv\nb2t1cCBmYWlsZWQ6ICIgKyBlLmdldE1lc3NhZ2UoKSk7DQogICAgICAgIH0N\nCg0KICAgICAgICBzdGFydFR4KHBtKTsNCiAgICAgICAgcG0ucmVtb3ZlKGJh\nc2ljKTsNCiAgICAgICAgLy8gYmVmb3JlIGNvbW1pdHRpbmcsIGlkIHNob3Vs\nZCBleGlzdCBzdGlsbA0KICAgICAgICBhc3NlcnROb3ROdWxsKHBtLmdldE9i\namVjdElkKGJhc2ljKSk7DQoNCiAgICAgICAgZW5kVHgocG0pOw0KICAgICAg\nICBhc3NlcnROdWxsKHBtLmdldE9iamVjdElkKGJhc2ljKSk7DQogICAgICAg\nIGVuZEVtKHBtKTsNCg0KICAgICAgICAvLyBsb29raW5nIHVwIHRoZSBpbnN0\nYW5jZSBieSBpZCBpbiBhIG5ldyBQTSBzaG91bGQgZmFpbC4NCiAgICAgICAg\ncG0gPSAoT3BlbkpQQUVudGl0eU1hbmFnZXIpIGN1cnJlbnRFbnRpdHlNYW5h\nZ2VyKCk7DQogICAgICAgIHRyeSB7DQogICAgICAgICAgICBwbS5maW5kKEJh\nc2ljU3ViY2xhc3NJbnN0YW5jZS5jbGFzcywgb2lkKTsNCiAgICAgICAgICAg\nIGZhaWwoImluc3RhbmNlIHNob3VsZCBoYXZlIGJlZW4gZGVsZXRlZCEiKTsN\nCiAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsNCiAgICAgICAgICAg\nIC8vIGV4cGVjdGVkDQogICAgICAgIH0NCiAgICAgICAgZW5kRW0ocG0pOw0K\nICAgIH0NCg0KICAgIHB1YmxpYyB2b2lkIHRlc3RDaGFuZ2VzT3V0c2lkZVR4\nV2l0aE5UVygpIHsNCiAgICAgICAgT3BlbkpQQUVudGl0eU1hbmFnZXIgcG0g\nPQ0KICAgICAgICAgICAgKE9wZW5KUEFFbnRpdHlNYW5hZ2VyKSBjdXJyZW50\nRW50aXR5TWFuYWdlcigpOw0KICAgICAgICBCYXNpY1N1YmNsYXNzSW5zdGFu\nY2UgYmFzaWMgPSBuZXcgQmFzaWNTdWJjbGFzc0luc3RhbmNlKCk7DQogICAg\nICAgIGJhc2ljLnNldFN0cmluZ0ZpZWxkKCJmb28iKTsNCiAgICAgICAgc3Rh\ncnRUeChwbSk7DQogICAgICAgIHBtLnBlcnNpc3QoYmFzaWMpOw0KICAgICAg\nICBlbmRUeChwbSk7DQogICAgICAgIE9iamVjdCBvaWQgPSBwbS5nZXRPYmpl\nY3RJZChiYXNpYyk7DQogICAgICAgIGVuZEVtKHBtKTsNCg0KICAgICAgICBw\nbSA9IGdldE5UV1BNKCk7DQogICAgICAgIGJhc2ljID0NCiAgICAgICAgICAg\nIChCYXNpY1N1YmNsYXNzSW5zdGFuY2UpIHBtLmZpbmQoQmFzaWNTdWJjbGFz\nc0luc3RhbmNlLmNsYXNzLCBvaWQpOw0KICAgICAgICBiYXNpYy5zZXRTdHJp\nbmdGaWVsZCgiaGVsbG8iKTsNCiAgICAgICAgc3RhcnRUeChwbSk7DQogICAg\nICAgIGVuZFR4KHBtKTsNCiAgICAgICAgZW5kRW0ocG0pOw0KDQogICAgICAg\nIHBtID0gKE9wZW5KUEFFbnRpdHlNYW5hZ2VyKSBjdXJyZW50RW50aXR5TWFu\nYWdlcigpOw0KICAgICAgICBiYXNpYyA9DQogICAgICAgICAgICAoQmFzaWNT\ndWJjbGFzc0luc3RhbmNlKSBwbS5maW5kKEJhc2ljU3ViY2xhc3NJbnN0YW5j\nZS5jbGFzcywgb2lkKTsNCiAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgIGFz\nc2VydEVxdWFscygiaGVsbG8iLCBiYXNpYy5nZXRTdHJpbmdGaWVsZCgpKTsN\nCiAgICAgICAgfSBjYXRjaCAoQXNzZXJ0aW9uRmFpbGVkRXJyb3IgYWZlKSB7\nDQogICAgICAgICAgICBidWcoMTIwNSwgYWZlLCAiSkRPIDItc3R5bGUgTlRX\nIG5vdCBzdXBwb3J0ZWQuIik7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICBw\ndWJsaWMgdm9pZCB0ZXN0Q2hhbmdlc091dHNpZGVUeFdpdGhvdXROVFcoKSB7\nDQogICAgICAgIE9wZW5KUEFFbnRpdHlNYW5hZ2VyIHBtID0NCiAgICAgICAg\nICAgIChPcGVuSlBBRW50aXR5TWFuYWdlcikgY3VycmVudEVudGl0eU1hbmFn\nZXIoKTsNCiAgICAgICAgQmFzaWNTdWJjbGFzc0luc3RhbmNlIGJhc2ljID0g\nbmV3IEJhc2ljU3ViY2xhc3NJbnN0YW5jZSgpOw0KICAgICAgICBiYXNpYy5z\nZXRTdHJpbmdGaWVsZCgiZm9vIik7DQogICAgICAgIHN0YXJ0VHgocG0pOw0K\nICAgICAgICBwbS5wZXJzaXN0KGJhc2ljKTsNCiAgICAgICAgZW5kVHgocG0p\nOw0KDQogICAgICAgIHRyeSB7DQogICAgICAgICAgICBiYXNpYy5zZXRTdHJp\nbmdGaWVsZCgiaGVsbG8iKTsNCiAgICAgICAgICAgIGZhaWwoInNob3VsZCBu\nb3QgYmUgYWJsZSB0byB3cml0ZSBvdXRzaWRlIHR4IHdpdGhvdXQgTlRXIik7\nDQogICAgICAgIH0gY2F0Y2ggKFJ1bnRpbWVFeGNlcHRpb24gcmUpIHsNCiAg\nICAgICAgICAgIC8vIGV4cGVjdGVkIGNhc2UNCiAgICAgICAgICAgIE9iamVj\ndCBmYWlsZWQgPSAoKEV4Y2VwdGlvbkluZm8pIHJlKS5nZXRGYWlsZWRPYmpl\nY3QoKTsNCiAgICAgICAgICAgIGFzc2VydE5vdE51bGwoZmFpbGVkKTsNCiAg\nICAgICAgICAgIGFzc2VydFNhbWUoYmFzaWMsIGZhaWxlZCk7DQogICAgICAg\nIH0gZmluYWxseSB7DQogICAgICAgICAgICBlbmRFbShwbSk7DQogICAgICAg\nIH0NCiAgICB9DQoNCiAgICBwcml2YXRlIE9wZW5KUEFFbnRpdHlNYW5hZ2Vy\nIGdldE5UV1BNKCkgew0KICAgICAgICBFbnRpdHlNYW5hZ2VyRmFjdG9yeSBw\nbWYgPSBnZXRFbWYoKTsNCiAgICAgICAgT3BlbkpQQUVudGl0eU1hbmFnZXIg\nZW0gPQ0KICAgICAgICAgICAgKE9wZW5KUEFFbnRpdHlNYW5hZ2VyKSBwbWYu\nY3JlYXRlRW50aXR5TWFuYWdlcigpOw0KICAgICAgICBlbS5zZXROb250cmFu\nc2FjdGlvbmFsV3JpdGUodHJ1ZSk7DQogICAgICAgIHJldHVybiBlbTsNCiAg\nICB9DQoNCiAgICAvKg0KICAgICBwdWJsaWMgdm9pZCB0ZXN0Q2FsbGJhY2tz\nICgpDQogICAgIHsNCiAgICAgICAgIGZhaWwgKCIjIyMjIyB1bmltcGxlbWVu\ndGVkIHRlc3QiKTsNCiAgICAgfQ0KDQoNCiAgICAgcHVibGljIHZvaWQgdGVz\ndFRyYW5zYWN0aW9uTGlzdGVuZXJzICgpDQogICAgIHsNCiAgICAgICAgIGZh\naWwgKCIjIyMjIyIpOw0KICAgICB9DQoNCg0KICAgICBwdWJsaWMgdm9pZCB0\nZXN0UmVtb3RlQ29tbWl0TGlzdGVuZXJzICgpDQogICAgIHsNCiAgICAgICAg\nIGZhaWwgKCIjIyMjIyIpOw0KICAgICB9DQoNCg0KICAgICBwdWJsaWMgdm9p\nZCB0ZXN0Q2FjaGluZyAoKQ0KICAgICB7DQogICAgICAgICBmYWlsICgiIyMj\nIyMiKTsNCiAgICAgfQ0KDQoNCiAgICAgcHVibGljIHZvaWQgdGVzdFJlbW90\nZSAoKQ0KICAgICB7DQogICAgICAgICBmYWlsICgiIyMjIyMiKTsNCiAgICAg\nfQ0KICAgICAqLw0KDQogICAgcHVibGljIHZvaWQgdGVzdFZlcnNpb25JbmNy\nZW1lbnRBbmRJZEZpZWxkKCkgew0KICAgICAgICAvLyBtYWtlIHN1cmUgdGhh\ndCB2ZXJzaW9uIGluY3JlbWVudHMgaGFwcGVuIGNvcnJlY3RseSwgYW5kIGFy\nZQ0KICAgICAgICAvLyB2aXNpYmxlIGluIHRoZSB1c2VyLXZpc2libGUgaW5z\ndGFuY2UuDQogICAgICAgIE9wZW5KUEFFbnRpdHlNYW5hZ2VyIHBtID0NCiAg\nICAgICAgICAgIChPcGVuSlBBRW50aXR5TWFuYWdlcikgY3VycmVudEVudGl0\neU1hbmFnZXIoKTsNCiAgICAgICAgQmFzaWNTdWJjbGFzc0luc3RhbmNlIGJh\nc2ljID0gbmV3IEJhc2ljU3ViY2xhc3NJbnN0YW5jZSgpOw0KICAgICAgICBi\nYXNpYy5zZXRTdHJpbmdGaWVsZCgiZm9vIik7DQogICAgICAgIHN0YXJ0VHgo\ncG0pOw0KICAgICAgICBwbS5wZXJzaXN0KGJhc2ljKTsNCiAgICAgICAgZW5k\nVHgocG0pOw0KDQogICAgICAgIGFzc2VydEVxdWFscygxLCBiYXNpYy5nZXRW\nZXJzaW9uKCkpOw0KICAgICAgICBsb25nIGlkID0gYmFzaWMuZ2V0SWQoKTsN\nCiAgICAgICAgYXNzZXJ0Tm90RXF1YWxzKDAsIGlkKTsNCg0KICAgICAgICBz\ndGFydFR4KHBtKTsNCiAgICAgICAgYmFzaWMuc2V0U3RyaW5nRmllbGQoImJh\nciIpOw0KICAgICAgICBlbmRUeChwbSk7DQogICAgICAgIGFzc2VydEVxdWFs\ncygyLCBiYXNpYy5nZXRWZXJzaW9uKCkpOw0KICAgICAgICBlbmRFbShwbSk7\nDQogICAgfQ0KDQogICAgLyoNCiAgICAgcHVibGljIHZvaWQgdGVzdEF1dG9B\nc3NpZ25lZEZpZWxkcyAoKQ0KICAgICB7DQogICAgICAgICAvLyBtYWtlIHN1\ncmUgdGhhdCBhdXRvLWFzc2lnbmVkIGZpZWxkIHZhbHVlcyBnZXQgaW50byB0\naGUgdXNlci12aXNpYmxlDQogICAgICAgICAvLyBpbnN0YW5jZS4NCiAgICAg\nICAgIGZhaWwgKCIjIyMjIyIpOw0KICAgICB9DQogICAgICovDQoNCiAgICBw\ndWJsaWMgdm9pZCB0ZXN0SlBBQmFzaWNzKCkgew0KICAgICAgICBFbnRpdHlN\nYW5hZ2VyIGVtID0gY3VycmVudEVudGl0eU1hbmFnZXIoKTsNCiAgICAgICAg\nQmFzaWNTdWJjbGFzc0luc3RhbmNlIGJhc2ljID0gKEJhc2ljU3ViY2xhc3NJ\nbnN0YW5jZSkgY3JlYXRlSW5zdGFuY2UoDQogICAgICAgICAgICBlbSwgQmFz\naWNTdWJjbGFzc0luc3RhbmNlLmNsYXNzKTsNCiAgICAgICAgYmFzaWMuc2V0\nU3RyaW5nRmllbGQoImhlbGxvIik7DQogICAgICAgIHN0YXJ0VHgoZW0pOw0K\nICAgICAgICBlbS5wZXJzaXN0KGJhc2ljKTsNCiAgICAgICAgZW5kVHgoZW0p\nOw0KICAgICAgICBlbmRFbShlbSk7DQogICAgfQ0KDQogICAgLyoNCiAgICAg\ncHVibGljIHZvaWQgdGVzdERldGFjaG1lbnRBbmRBdHRhY2hlbW50ICgpDQog\nICAgIHsNCiAgICAgICAgIGZhaWwgKCIjIyMjIyIpOw0KICAgICB9DQoNCg0K\nICAgICBwdWJsaWMgdm9pZCB0ZXN0RW1iZWRkZWROb25FbmhhbmNlZCAoKQ0K\nICAgICB7DQogICAgICAgICBmYWlsICgiIyMjIyMiKTsNCiAgICAgfQ0KDQoN\nCiAgICAgcHVibGljIHZvaWQgdGVzdFRyYW5zYWN0aW9uYWxOb25FbmhhbmNl\nZCAoKQ0KICAgICB7DQogICAgICAgICBmYWlsICgiIyMjIyMiKTsNCiAgICAg\nfQ0KDQoNCiAgICAgcHVibGljIHZvaWQgdGVzdEJ1bGtUcmFuc2FjdGlvbmFs\nTm9uRW5oYW5jZWQgKCkNCiAgICAgew0KICAgICAgICAgZmFpbCAoIiMjIyMj\nIik7DQogICAgIH0NCiAgICAgKi8NCg0KICAgIHB1YmxpYyB2b2lkIHRlc3RT\naW5nbGVWYWx1ZWRJbnZlcnNlTWFuYWdlbWVudCgpIHsNCiAgICAgICAgTWFw\nIG1hcCA9IG5ldyBIYXNoTWFwKCk7DQogICAgICAgIG1hcC5wdXQoIm9wZW5q\ncGEuSW52ZXJzZU1hbmFnZXIiLCAidHJ1ZSIpOw0KICAgICAgICBPcGVuSlBB\nRW50aXR5TWFuYWdlciBwbSA9IChPcGVuSlBBRW50aXR5TWFuYWdlcikNCiAg\nICAgICAgICAgIGdldEVtZihtYXApLmNyZWF0ZUVudGl0eU1hbmFnZXIoKTsN\nCiAgICAgICAgTWFuYWdlZEludmVyc2VUZXN0SW5zdGFuY2UgbWFuYWdlZCA9\nIChNYW5hZ2VkSW52ZXJzZVRlc3RJbnN0YW5jZSkNCiAgICAgICAgICAgIG5l\nd0luc3RhbmNlKHBtLCBNYW5hZ2VkSW52ZXJzZVRlc3RJbnN0YW5jZS5jbGFz\ncyk7DQogICAgICAgIE1hbmFnZWRJbnZlcnNlVGVzdEluc3RhbmNlMiBtYW5h\nZ2VkMiA9IChNYW5hZ2VkSW52ZXJzZVRlc3RJbnN0YW5jZTIpDQogICAgICAg\nICAgICBuZXdJbnN0YW5jZShwbSwgTWFuYWdlZEludmVyc2VUZXN0SW5zdGFu\nY2UyLmNsYXNzKTsNCiAgICAgICAgbWFuYWdlZC5zZXRTdHJpbmdGaWVsZCgi\nbWFuYWdlZCIpOw0KICAgICAgICBtYW5hZ2VkMi5zZXRTdHJpbmdGaWVsZCgi\nbWFuYWdlZDIiKTsNCiAgICAgICAgbWFuYWdlZC5zZXRNYW5hZ2VkMihtYW5h\nZ2VkMik7DQoNCiAgICAgICAgc3RhcnRUeChwbSk7DQogICAgICAgIHBtLnBl\ncnNpc3QobWFuYWdlZCk7DQogICAgICAgIGVuZFR4KHBtKTsNCg0KICAgICAg\nICBhc3NlcnRTYW1lKG1hbmFnZWQsIG1hbmFnZWQyLmdldE1hbmFnZWQoKSk7\nDQogICAgfQ0KDQogICAgcHVibGljIHZvaWQgdGVzdEJhY2tpbmdGaWVsZENv\nbmZpZ3VyYXRpb25XaXRoVHdvRmFjdG9yaWVzKCkgew0KICAgICAgICBPcGVu\nSlBBRW50aXR5TWFuYWdlciBwbSA9DQogICAgICAgICAgICAoT3BlbkpQQUVu\ndGl0eU1hbmFnZXIpIGN1cnJlbnRFbnRpdHlNYW5hZ2VyKCk7DQogICAgICAg\nIC8vIHRoaXMgY2F1c2VzIERlcml2ZWRFbnRpdHkuY2xhc3MgdG8gZ2V0IGxv\nYWRlZCBpbnRvIFBDUmVnaXN0cnkNCiAgICAgICAgbmV3SW5zdGFuY2UocG0s\nIERlcml2ZWRFbnRpdHkuY2xhc3MpOw0KICAgICAgICBNYXAgbWFwID0gbmV3\nIEhhc2hNYXAoKTsNCiAgICAgICAgbWFwLnB1dCgib3BlbmpwYS5Mb2ciLCAi\nRGlhZ25vc3RpY0NvbnRleHQ9c3ViY2xhc3MtdHdvLWZhY3Rvcmllcy10ZXN0\nIik7DQogICAgICAgIHBtID0gKE9wZW5KUEFFbnRpdHlNYW5hZ2VyKSBnZXRF\nbWYobWFwKS5jcmVhdGVFbnRpdHlNYW5hZ2VyKCk7DQogICAgICAgIG5ld0lu\nc3RhbmNlKHBtLCBEZXJpdmVkRW50aXR5LmNsYXNzKTsNCg0KICAgICAgICAv\nLyB0aGlzIHNlY29uZCBuZXctaW5zdGFuY2UgY3JlYXRpb24gd2lsbCByZXN1\nbHQgaW4gdGhlIG1ldGFkYXRhDQogICAgICAgIC8vIGRlZmF1bHRzIGJlaW5n\nIGxvYWRlZCBmcm9tIHRoZSBQQ1JlZ2lzdHJ5IGluc3RlYWQgb2YgdmlhIHJl\nZmxlY3Rpb24uDQogICAgICAgIC8vIE1ha2Ugc3VyZSB0aGF0IHRoaW5ncyBz\ndGlsbCB3b3JrIGFzIGV4cGVjdGVkIGZyb20gdGhlDQogICAgICAgIC8vIHJl\nZ2lzdHJ5LXBhcnNpbmcgY29kZS4NCiAgICAgICAgQ2xhc3NNZXRhRGF0YSBt\nZXRhID0gZ2V0Q29uZmlndXJhdGlvbigpDQogICAgICAgICAgICAuZ2V0TWV0\nYURhdGFSZXBvc2l0b3J5SW5zdGFuY2UoKS4NCiAgICAgICAgICAgIGdldE1l\ndGFEYXRhKERlcml2ZWRFbnRpdHkuY2xhc3MsIG51bGwsIGZhbHNlKTsNCiAg\nICAgICAgYXNzZXJ0VHJ1ZSgibWV0YSdzIGFjY2VzcyBzaG91bGQgYmUgQUND\nRVNTX1BST1BFUlRZIiwNCiAgICAgICAgICAgIG1ldGEuZ2V0QWNjZXNzVHlw\nZSgpID09IENsYXNzTWV0YURhdGEuQUNDRVNTX1BST1BFUlRZKTsNCiAgICAg\nICAgRmllbGRNZXRhRGF0YVtdIGZtZHMgPSBtZXRhLmdldEZpZWxkcygpOw0K\nICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGZtZHMubGVuZ3RoOyBpKysp\nIHsNCiAgICAgICAgICAgIGFzc2VydEVxdWFscyhNZXRob2QuY2xhc3MsIGZt\nZHNbaV0uZ2V0QmFja2luZ01lbWJlcigpLmdldENsYXNzKCkpOw0KDQogICAg\nICAgICAgICAvLyBtYWtlIHN1cmUgdGhhdCB0aGUgZmllbGRzIGFyZSBkZWZp\nbmVkIGluIHRoZSByaWdodCBwYXJ0IG9mIHRoZQ0KICAgICAgICAgICAgLy8g\naGllcmFyY2h5DQogICAgICAgICAgICBpZiAoZm1kc1tpXS5nZXROYW1lKCku\nZXF1YWxzKCJpbnRGaWVsZCIpIHx8DQogICAgICAgICAgICAgICAgZm1kc1tp\nXS5nZXROYW1lKCkuZXF1YWxzKCJvbmVUb09uZSIpKSB7DQogICAgICAgICAg\nICAgICAgYXNzZXJ0RXF1YWxzKERlcml2ZWRFbnRpdHkuY2xhc3MsDQogICAg\nICAgICAgICAgICAgICAgIGZtZHNbaV0uZ2V0RGVmaW5pbmdNZXRhRGF0YSgp\nLmdldERlc2NyaWJlZFR5cGUoKSk7DQogICAgICAgICAgICB9IGVsc2Ugew0K\nICAgICAgICAgICAgICAgIGFzc2VydEVxdWFscyhCYXNlRW50aXR5LmNsYXNz\nLA0KICAgICAgICAgICAgICAgICAgICBmbWRzW2ldLmdldERlZmluaW5nTWV0\nYURhdGEoKS5nZXREZXNjcmliZWRUeXBlKCkpOw0KICAgICAgICAgICAgfQ0K\nICAgICAgICB9DQogICAgfQ0KfQ0K\n","encoding":"base64"}

