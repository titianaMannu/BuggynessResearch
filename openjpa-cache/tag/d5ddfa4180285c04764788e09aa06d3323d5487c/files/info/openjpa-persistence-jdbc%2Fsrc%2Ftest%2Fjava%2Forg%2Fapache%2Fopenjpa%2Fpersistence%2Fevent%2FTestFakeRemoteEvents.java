{"sha":"1dbfc19ea1b4dbc208689f95d12e8b161c5e8ae7","node_id":"MDQ6QmxvYjIwNjM2NDoxZGJmYzE5ZWExYjRkYmMyMDg2ODlmOTVkMTJlOGIxNjFjNWU4YWU3","size":7731,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/1dbfc19ea1b4dbc208689f95d12e8b161c5e8ae7","content":"LyoNCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUNCiAqIG9yIG1vcmUgY29udHJpYnV0b3Ig\nbGljZW5zZSBhZ3JlZW1lbnRzLiAgU2VlIHRoZSBOT1RJQ0UgZmlsZQ0KICog\nZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5m\nb3JtYXRpb24NCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAg\nVGhlIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUNCiAqIHRvIHlvdSB1bmRlciB0\naGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUNCiAqICJMaWNl\nbnNlIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNv\nbXBsaWFuY2UNCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFp\nbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQNCiAqDQogKiBodHRwOi8vd3d3\nLmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjANCiAqDQogKiBVbmxl\nc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGlu\nIHdyaXRpbmcsDQogKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUg\nTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbg0KICogIkFTIElTIiBCQVNJ\nUywgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZDQog\nKiBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBM\naWNlbnNlIGZvciB0aGUNCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmlu\nZyBwZXJtaXNzaW9ucyBhbmQgbGltaXRhdGlvbnMNCiAqIHVuZGVyIHRoZSBM\naWNlbnNlLiAgICANCiAqLw0KcGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEu\ncGVyc2lzdGVuY2UuZXZlbnQ7DQoNCmltcG9ydCBqYXZhLnV0aWwuQ29sbGVj\ndGlvbjsNCmltcG9ydCBqYXZhLnV0aWwuSGFzaE1hcDsNCmltcG9ydCBqYXZh\nLnV0aWwuSGFzaFNldDsNCmltcG9ydCBqYXZhLnV0aWwuSXRlcmF0b3I7DQpp\nbXBvcnQgamF2YS51dGlsLk1hcDsNCmltcG9ydCBqYXZhLnV0aWwuU2V0Ow0K\nDQoNCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuZXZl\nbnQuY29tbW9uLmFwcHMuUnVudGltZVRlc3QxOw0KaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5jb21tb24udXRpbHMuQWJzdHJhY3RU\nZXN0Q2FzZTsNCg0KaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5ldmVudC5B\nYnN0cmFjdFJlbW90ZUNvbW1pdFByb3ZpZGVyOw0KaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5ldmVudC5SZW1vdGVDb21taXRFdmVudDsNCmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEuZXZlbnQuUmVtb3RlQ29tbWl0TGlzdGVuZXI7\nDQppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNlLk9wZW5K\nUEFFbnRpdHlNYW5hZ2VyOw0KaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5w\nZXJzaXN0ZW5jZS5PcGVuSlBBRW50aXR5TWFuYWdlckZhY3Rvcnk7DQppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNlLk9wZW5KUEFFbnRp\ndHlNYW5hZ2VyRmFjdG9yeVNQSTsNCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEudXRpbC5JZDsNCg0KcHVibGljIGNsYXNzIFRlc3RGYWtlUmVtb3RlRXZl\nbnRzIGV4dGVuZHMgQWJzdHJhY3RUZXN0Q2FzZSB7DQoNCiAgICAvKg0KICAg\nICAgKiBUaGUgbW9zdCByZWNlbnRseSBzZXQgcHJvdmlkZXIsIGFuZCBhIGxv\nY2sgdG8gY29udHJvbCBhY2Nlc3MgdG8gaXQuIFRoaXMNCiAgICAgICogaXMg\ncmF0aGVyIGhhY2t5Lg0KICAgICAgKi8NCiAgICBwcml2YXRlIHN0YXRpYyBP\nYmplY3QgY3VycmVudFByb3ZpZGVyTG9jayA9IG5ldyBPYmplY3QoKTsNCg0K\nICAgIHByaXZhdGUgc3RhdGljIFJlbW90ZUNvbW1pdFByb3ZpZGVyVGVzdElt\ncGwgY3VycmVudFByb3ZpZGVyOw0KDQogICAgcHVibGljIFRlc3RGYWtlUmVt\nb3RlRXZlbnRzKFN0cmluZyBzKSB7DQogICAgICAgIHN1cGVyKHMsICJldmVu\ndGNhY3R1c2FwcCIpOw0KICAgIH0NCg0KICAgIHB1YmxpYyB2b2lkIHNldFVw\nKCkgew0KICAgICAgICBkZWxldGVBbGwoUnVudGltZVRlc3QxLmNsYXNzKTsN\nCiAgICB9DQoNCiAgICBwdWJsaWMgdm9pZCB0ZXN0TGlzdGVuZXIoKSB7DQoN\nCiAgICAgICAgTWFwIHByb3BzTWFwID0gbmV3IEhhc2hNYXAoKTsNCiAgICAg\nICAgcHJvcHNNYXAucHV0KCJvcGVuanBhLlJlbW90ZUNvbW1pdFByb3ZpZGVy\nIiwgInNqdm0iKTsNCiAgICAgICAgcHJvcHNNYXAucHV0KCJvcGVuanBhLkRh\ndGFDYWNoZSIsICJ0cnVlIik7DQogICAgICAgIE9wZW5KUEFFbnRpdHlNYW5h\nZ2VyRmFjdG9yeSBmYWN0b3J5ID0gZ2V0RW1mKHByb3BzTWFwKTsNCg0KICAg\nICAgICBSZW1vdGVDb21taXRMaXN0ZW5lclRlc3RJbXBsIHRyYW5zYWN0aW9u\nTGlzdGVuZXIgPQ0KICAgICAgICAgICAgbmV3IFJlbW90ZUNvbW1pdExpc3Rl\nbmVyVGVzdEltcGwoKTsNCiAgICAgICAgKChPcGVuSlBBRW50aXR5TWFuYWdl\nckZhY3RvcnlTUEkpIGZhY3RvcnkpLmdldENvbmZpZ3VyYXRpb24oKQ0KICAg\nICAgICAgICAgLmdldFJlbW90ZUNvbW1pdEV2ZW50TWFuYWdlcigpLmFkZExp\nc3RlbmVyKA0KICAgICAgICAgICAgdHJhbnNhY3Rpb25MaXN0ZW5lcik7DQoN\nCiAgICAgICAgT3BlbkpQQUVudGl0eU1hbmFnZXIgcG0gPSAoT3BlbkpQQUVu\ndGl0eU1hbmFnZXIpIGZhY3RvcnkNCiAgICAgICAgICAgIC5jcmVhdGVFbnRp\ndHlNYW5hZ2VyKCk7DQoNCiAgICAgICAgLy8gZ2V0IGFuIG9iamVjdCBpZA0K\nICAgICAgICBSdW50aW1lVGVzdDEgdDEgPSBuZXcgUnVudGltZVRlc3QxKCJm\nb28iLCA1KTsNCiAgICAgICAgc3RhcnRUeChwbSk7DQogICAgICAgIHBtLnBl\ncnNpc3QodDEpOw0KICAgICAgICBPYmplY3Qgb2lkID0gcG0uZ2V0T2JqZWN0\nSWQodDEpOw0KICAgICAgICByb2xsYmFja1R4KHBtKTsNCg0KICAgICAgICAv\nLyBzaW11bGF0ZSBhbiBhZGQNCiAgICAgICAgU2V0IHMgPSBuZXcgSGFzaFNl\ndCgpOw0KICAgICAgICBzLmFkZChvaWQpOw0KICAgICAgICAoKE9wZW5KUEFF\nbnRpdHlNYW5hZ2VyRmFjdG9yeVNQSSkgZmFjdG9yeSkuZ2V0Q29uZmlndXJh\ndGlvbigpDQogICAgICAgICAgICAuZ2V0UmVtb3RlQ29tbWl0RXZlbnRNYW5h\nZ2VyKCkuZmlyZUV2ZW50KA0KICAgICAgICAgICAgbmV3IFJlbW90ZUNvbW1p\ndEV2ZW50KFJlbW90ZUNvbW1pdEV2ZW50LlBBWUxPQURfT0lEU19XSVRIX0FE\nRFMsDQogICAgICAgICAgICAgICAgcywgbnVsbCwgbnVsbCwgbnVsbCkpOw0K\nDQogICAgICAgIGJvb2xlYW4gcGFzcyA9IGZhbHNlOw0KICAgICAgICBmb3Ig\nKEl0ZXJhdG9yIGl0ZXIgPSB0cmFuc2FjdGlvbkxpc3RlbmVyLmFkZGVkLml0\nZXJhdG9yKCk7IGl0ZXINCiAgICAgICAgICAgIC5oYXNOZXh0KCk7KSB7DQog\nICAgICAgICAgICBpZiAoaXRlci5uZXh0KCkuZXF1YWxzKG9pZCkpIHsNCiAg\nICAgICAgICAgICAgICBwYXNzID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICBi\ncmVhazsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICBhc3Nl\ncnRUcnVlKHBhc3MpOw0KICAgICAgICBhc3NlcnRUcnVlKHRyYW5zYWN0aW9u\nTGlzdGVuZXIudXBkYXRlZC5zaXplKCkgPT0gMCk7DQogICAgICAgIGFzc2Vy\ndFRydWUodHJhbnNhY3Rpb25MaXN0ZW5lci5kZWxldGVkLnNpemUoKSA9PSAw\nKTsNCg0KICAgICAgICAvLyBzaW11bGF0ZSBtb2RpZmljYXRpb25zDQogICAg\nICAgICgoT3BlbkpQQUVudGl0eU1hbmFnZXJGYWN0b3J5U1BJKSBmYWN0b3J5\nKS5nZXRDb25maWd1cmF0aW9uKCkNCiAgICAgICAgICAgIC5nZXRSZW1vdGVD\nb21taXRFdmVudE1hbmFnZXIoKS5maXJlRXZlbnQoDQogICAgICAgICAgICBu\nZXcgUmVtb3RlQ29tbWl0RXZlbnQoUmVtb3RlQ29tbWl0RXZlbnQuUEFZTE9B\nRF9PSURTX1dJVEhfQUREUywNCiAgICAgICAgICAgICAgICBudWxsLCBudWxs\nLCBzLCBudWxsKSk7DQoNCiAgICAgICAgcGFzcyA9IGZhbHNlOw0KICAgICAg\nICBmb3IgKEl0ZXJhdG9yIGl0ZXIgPSB0cmFuc2FjdGlvbkxpc3RlbmVyLnVw\nZGF0ZWQuaXRlcmF0b3IoKTsgaXRlcg0KICAgICAgICAgICAgLmhhc05leHQo\nKTspIHsNCiAgICAgICAgICAgIGlmIChpdGVyLm5leHQoKS5lcXVhbHMob2lk\nKSkgew0KICAgICAgICAgICAgICAgIHBhc3MgPSB0cnVlOw0KICAgICAgICAg\nICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAg\nICAgIGFzc2VydFRydWUocGFzcyk7DQogICAgICAgIGFzc2VydFRydWUodHJh\nbnNhY3Rpb25MaXN0ZW5lci5hZGRlZC5zaXplKCkgPT0gMCk7DQogICAgICAg\nIGFzc2VydFRydWUodHJhbnNhY3Rpb25MaXN0ZW5lci5kZWxldGVkLnNpemUo\nKSA9PSAwKTsNCg0KICAgICAgICAvLyBzaW11bGF0ZSBhIGRlbGV0ZQ0KICAg\nICAgICAoKE9wZW5KUEFFbnRpdHlNYW5hZ2VyRmFjdG9yeVNQSSkgZmFjdG9y\neSkuZ2V0Q29uZmlndXJhdGlvbigpDQogICAgICAgICAgICAuZ2V0UmVtb3Rl\nQ29tbWl0RXZlbnRNYW5hZ2VyKCkuZmlyZUV2ZW50KA0KICAgICAgICAgICAg\nbmV3IFJlbW90ZUNvbW1pdEV2ZW50KFJlbW90ZUNvbW1pdEV2ZW50LlBBWUxP\nQURfT0lEU19XSVRIX0FERFMsDQogICAgICAgICAgICAgICAgbnVsbCwgbnVs\nbCwgbnVsbCwgcykpOw0KDQogICAgICAgIHBhc3MgPSBmYWxzZTsNCiAgICAg\nICAgZm9yIChJdGVyYXRvciBpdGVyID0gdHJhbnNhY3Rpb25MaXN0ZW5lci5k\nZWxldGVkLml0ZXJhdG9yKCk7IGl0ZXINCiAgICAgICAgICAgIC5oYXNOZXh0\nKCk7KSB7DQogICAgICAgICAgICBpZiAoaXRlci5uZXh0KCkuZXF1YWxzKG9p\nZCkpIHsNCiAgICAgICAgICAgICAgICBwYXNzID0gdHJ1ZTsNCiAgICAgICAg\nICAgICAgICBicmVhazsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAg\nICAgICBhc3NlcnRUcnVlKHBhc3MpOw0KICAgICAgICBhc3NlcnRUcnVlKHRy\nYW5zYWN0aW9uTGlzdGVuZXIuYWRkZWQuc2l6ZSgpID09IDApOw0KICAgICAg\nICBhc3NlcnRUcnVlKHRyYW5zYWN0aW9uTGlzdGVuZXIudXBkYXRlZC5zaXpl\nKCkgPT0gMCk7DQogICAgfQ0KDQogICAgcHVibGljIHZvaWQgdGVzdFByb3Zp\nZGVyKCkgew0KICAgICAgICBSZW1vdGVDb21taXRQcm92aWRlclRlc3RJbXBs\nIHByb3ZpZGVyOw0KICAgICAgICBPcGVuSlBBRW50aXR5TWFuYWdlciBwbTsN\nCiAgICAgICAgc3luY2hyb25pemVkIChjdXJyZW50UHJvdmlkZXJMb2NrKSB7\nDQogICAgICAgICAgICBNYXAgcHJvcHNNYXAgPSBuZXcgSGFzaE1hcCgpOw0K\nICAgICAgICAgICAgcHJvcHNNYXAucHV0KCJvcGVuanBhLlJlbW90ZUNvbW1p\ndFByb3ZpZGVyIiwNCiAgICAgICAgICAgICAgICBSZW1vdGVDb21taXRQcm92\naWRlclRlc3RJbXBsLmNsYXNzLmdldE5hbWUoKQ0KICAgICAgICAgICAgICAg\nICAgICArICIoVHJhbnNtaXRQZXJzaXN0ZWRPYmplY3RJZHM9dHJ1ZSkiKTsN\nCiAgICAgICAgICAgIHByb3BzTWFwLnB1dCgib3BlbmpwYS5EYXRhQ2FjaGUi\nLCAidHJ1ZSIpOw0KICAgICAgICAgICAgT3BlbkpQQUVudGl0eU1hbmFnZXJG\nYWN0b3J5IGZhY3RvcnkgPSBnZXRFbWYocHJvcHNNYXApOw0KDQogICAgICAg\nICAgICBwbSA9IChPcGVuSlBBRW50aXR5TWFuYWdlcikgZmFjdG9yeS5jcmVh\ndGVFbnRpdHlNYW5hZ2VyKCk7DQogICAgICAgICAgICBwcm92aWRlciA9IGN1\ncnJlbnRQcm92aWRlcjsNCiAgICAgICAgfQ0KDQogICAgICAgIC8vIGdldCBh\nbiBvYmplY3QgaWQNCiAgICAgICAgUnVudGltZVRlc3QxIHQxID0gbmV3IFJ1\nbnRpbWVUZXN0MSgiZm9vIiwgNSk7DQogICAgICAgIHN0YXJ0VHgocG0pOw0K\nICAgICAgICBwbS5wZXJzaXN0KHQxKTsNCiAgICAgICAgT2JqZWN0IG9pZCA9\nIHBtLmdldE9iamVjdElkKHQxKTsNCiAgICAgICAgZW5kVHgocG0pOw0KDQog\nICAgICAgIGJvb2xlYW4gcGFzcyA9IGZhbHNlOw0KICAgICAgICBmb3IgKEl0\nZXJhdG9yIGl0ZXIgPSBwcm92aWRlci5hZGRlZC5pdGVyYXRvcigpOyBpdGVy\nLmhhc05leHQoKTspIHsNCiAgICAgICAgICAgIE9iamVjdCBhZGRlZCA9IGl0\nZXIubmV4dCgpOw0KICAgICAgICAgICAgaWYgKGVxdWFscyhhZGRlZCwgb2lk\nKSkgew0KICAgICAgICAgICAgICAgIHBhc3MgPSB0cnVlOw0KICAgICAgICAg\nICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAg\nICAgIGFzc2VydFRydWUocGFzcyk7DQogICAgICAgIGFzc2VydFRydWUocHJv\ndmlkZXIudXBkYXRlZC5zaXplKCkgPT0gMCk7DQogICAgICAgIGFzc2VydFRy\ndWUocHJvdmlkZXIuZGVsZXRlZC5zaXplKCkgPT0gMCk7DQogICAgfQ0KDQog\nICAgYm9vbGVhbiBlcXVhbHMoT2JqZWN0IGFkZGVkLCBPYmplY3Qgb2lkKSB7\nDQogICAgICAgIGlmIChhZGRlZC5lcXVhbHMob2lkKSkNCiAgICAgICAgICAg\nIHJldHVybiB0cnVlOw0KICAgICAgICBpZiAoYWRkZWQgaW5zdGFuY2VvZiBJ\nZCkNCiAgICAgICAgICAgIHJldHVybiAoKElkKSBhZGRlZCkuZ2V0SWRPYmpl\nY3QoKS5lcXVhbHMob2lkKTsNCiAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAg\nIH0NCg0KICAgIHByaXZhdGUgc3RhdGljIGNsYXNzIFJlbW90ZUNvbW1pdExp\nc3RlbmVyVGVzdEltcGwgaW1wbGVtZW50cw0KICAgICAgICBSZW1vdGVDb21t\naXRMaXN0ZW5lciB7DQoNCiAgICAgICAgdHJhbnNpZW50IENvbGxlY3Rpb24g\nYWRkZWQ7DQoNCiAgICAgICAgdHJhbnNpZW50IENvbGxlY3Rpb24gdXBkYXRl\nZDsNCg0KICAgICAgICB0cmFuc2llbnQgQ29sbGVjdGlvbiBkZWxldGVkOw0K\nDQogICAgICAgIHB1YmxpYyB2b2lkIGFmdGVyQ29tbWl0KFJlbW90ZUNvbW1p\ndEV2ZW50IGV2ZW50KSB7DQogICAgICAgICAgICB0aGlzLmFkZGVkID0gZXZl\nbnQuZ2V0UGVyc2lzdGVkT2JqZWN0SWRzKCk7DQogICAgICAgICAgICB0aGlz\nLnVwZGF0ZWQgPSBldmVudC5nZXRVcGRhdGVkT2JqZWN0SWRzKCk7DQogICAg\nICAgICAgICB0aGlzLmRlbGV0ZWQgPSBldmVudC5nZXREZWxldGVkT2JqZWN0\nSWRzKCk7DQogICAgICAgIH0NCg0KICAgICAgICBwdWJsaWMgdm9pZCBjbG9z\nZSgpIHsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIHB1YmxpYyBzdGF0aWMg\nY2xhc3MgUmVtb3RlQ29tbWl0UHJvdmlkZXJUZXN0SW1wbCBleHRlbmRzDQog\nICAgICAgIEFic3RyYWN0UmVtb3RlQ29tbWl0UHJvdmlkZXIgew0KDQogICAg\nICAgIENvbGxlY3Rpb24gYWRkZWQ7DQoNCiAgICAgICAgQ29sbGVjdGlvbiB1\ncGRhdGVkOw0KDQogICAgICAgIENvbGxlY3Rpb24gZGVsZXRlZDsNCg0KICAg\nICAgICBwdWJsaWMgUmVtb3RlQ29tbWl0UHJvdmlkZXJUZXN0SW1wbCgpIHsN\nCiAgICAgICAgICAgIHN5bmNocm9uaXplZCAoY3VycmVudFByb3ZpZGVyTG9j\naykgew0KICAgICAgICAgICAgICAgIGN1cnJlbnRQcm92aWRlciA9IHRoaXM7\nDQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICAvLyAtLS0t\nLS0tLS0tIFJlbW90ZUNvbW1pdFByb3ZpZGVyIGltcGxlbWVudGF0aW9uIC0t\nLS0tLS0tLS0NCg0KICAgICAgICBwdWJsaWMgdm9pZCBicm9hZGNhc3QoUmVt\nb3RlQ29tbWl0RXZlbnQgZXZlbnQpIHsNCiAgICAgICAgICAgIHRoaXMuYWRk\nZWQgPSBldmVudC5nZXRQZXJzaXN0ZWRPYmplY3RJZHMoKTsNCiAgICAgICAg\nICAgIHRoaXMudXBkYXRlZCA9IGV2ZW50LmdldFVwZGF0ZWRPYmplY3RJZHMo\nKTsNCiAgICAgICAgICAgIHRoaXMuZGVsZXRlZCA9IGV2ZW50LmdldERlbGV0\nZWRPYmplY3RJZHMoKTsNCiAgICAgICAgfQ0KDQogICAgICAgIHB1YmxpYyB2\nb2lkIGNsb3NlKCkgew0KICAgICAgICB9DQogICAgfQ0KfQ0K\n","encoding":"base64"}

