{"sha":"f652efd8c36f0825bf1c1d545d0328d95a4479f4","node_id":"MDQ6QmxvYjIwNjM2NDpmNjUyZWZkOGMzNmYwODI1YmYxYzFkNTQ1ZDAzMjhkOTVhNDQ3OWY0","size":4762,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/f652efd8c36f0825bf1c1d545d0328d95a4479f4","content":"LyoNCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUNCiAqIG9yIG1vcmUgY29udHJpYnV0b3Ig\nbGljZW5zZSBhZ3JlZW1lbnRzLiAgU2VlIHRoZSBOT1RJQ0UgZmlsZQ0KICog\nZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5m\nb3JtYXRpb24NCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAg\nVGhlIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUNCiAqIHRvIHlvdSB1bmRlciB0\naGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUNCiAqICJMaWNl\nbnNlIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNv\nbXBsaWFuY2UNCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFp\nbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQNCiAqDQogKiBodHRwOi8vd3d3\nLmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjANCiAqDQogKiBVbmxl\nc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGlu\nIHdyaXRpbmcsDQogKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUg\nTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbg0KICogIkFTIElTIiBCQVNJ\nUywgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZDQog\nKiBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBM\naWNlbnNlIGZvciB0aGUNCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmlu\nZyBwZXJtaXNzaW9ucyBhbmQgbGltaXRhdGlvbnMNCiAqIHVuZGVyIHRoZSBM\naWNlbnNlLiAgICANCiAqLw0KcGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEu\ncGVyc2lzdGVuY2UuZXZlbnQ7DQoNCmltcG9ydCBqYXZhLnV0aWwuSGFzaE1h\ncDsNCmltcG9ydCBqYXZhLnV0aWwuTWFwOw0KDQoNCmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuZXZlbnQuY29tbW9uLmFwcHMuUnVu\ndGltZVRlc3QxOw0KaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0\nZW5jZS5jb21tb24udXRpbHMuQWJzdHJhY3RUZXN0Q2FzZTsNCmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuY29tbW9uLnV0aWxzLkJ1\nZmZlcmVkTG9nRmFjdG9yeTsNCg0KaW1wb3J0IG9yZy5hcGFjaGUub3Blbmpw\nYS5ldmVudC5PcnBoYW5lZEtleUFjdGlvbjsNCmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEucGVyc2lzdGVuY2UuRW50aXR5Tm90Rm91bmRFeGNlcHRpb247\nDQppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNlLk9wZW5K\nUEFFbnRpdHlNYW5hZ2VyOw0KaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5w\nZXJzaXN0ZW5jZS5PcGVuSlBBRW50aXR5TWFuYWdlckZhY3Rvcnk7DQppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNlLk9wZW5KUEFFbnRp\ndHlNYW5hZ2VyU1BJOw0KaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGls\nLk9wZW5KUEFFeGNlcHRpb247DQoNCi8qKg0KICogPHA+VGVzdCB0aGUge0Bs\naW5rIE9ycGhhbmVkS2V5QWN0aW9ufSBwbHVnaW4uPC9wPg0KICoNCiAqIEBh\ndXRob3IgQWJlIFdoaXRlDQogKi8NCnB1YmxpYyBjbGFzcyBUZXN0T3JwaGFu\nZWRLZXlBY3Rpb24NCiAgICBleHRlbmRzIEFic3RyYWN0VGVzdENhc2Ugew0K\nDQogICAgcHJpdmF0ZSBPYmplY3QgX29pZCA9IG51bGw7DQoNCiAgICBwdWJs\naWMgVGVzdE9ycGhhbmVkS2V5QWN0aW9uKFN0cmluZyBzKSB7DQogICAgICAg\nIHN1cGVyKHMsICJldmVudGNhY3R1c2FwcCIpOw0KICAgIH0NCg0KICAgIHB1\nYmxpYyB2b2lkIHNldFVwKCkgew0KICAgICAgICBkZWxldGVBbGwoUnVudGlt\nZVRlc3QxLmNsYXNzKTsNCg0KICAgICAgICBSdW50aW1lVGVzdDEgcGMgPSBu\nZXcgUnVudGltZVRlc3QxKCk7DQogICAgICAgIHBjLnNldEludEZpZWxkKDEp\nOw0KICAgICAgICBSdW50aW1lVGVzdDEgcGMyID0gbmV3IFJ1bnRpbWVUZXN0\nMSgpOw0KICAgICAgICBwYzIuc2V0SW50RmllbGQoMik7DQogICAgICAgIHBj\nLnNldFNlbGZPbmVPbmUocGMyKTsNCg0KICAgICAgICBPcGVuSlBBRW50aXR5\nTWFuYWdlciBwbSA9DQogICAgICAgICAgICAoT3BlbkpQQUVudGl0eU1hbmFn\nZXIpIGN1cnJlbnRFbnRpdHlNYW5hZ2VyKCk7DQogICAgICAgIHN0YXJ0VHgo\ncG0pOw0KICAgICAgICBwbS5wZXJzaXN0KHBjKTsNCiAgICAgICAgZW5kVHgo\ncG0pOw0KICAgICAgICBfb2lkID0gcG0uZ2V0T2JqZWN0SWQocGMpOw0KDQog\nICAgICAgIHN0YXJ0VHgocG0pOw0KICAgICAgICBwbS5yZW1vdmUocGMyKTsN\nCiAgICAgICAgZW5kVHgocG0pOw0KICAgICAgICBlbmRFbShwbSk7DQogICAg\nfQ0KDQogICAgcHVibGljIHZvaWQgdGVzdExvZygpIHsNCiAgICAgICAgTWFw\nIG1hcCA9IGdldE9ycGhhbmVkS2V5Q29uZmlndXJhdGlvbigibG9nKExldmVs\nPUZBVEFMKSIpOw0KDQogICAgICAgIE9wZW5KUEFFbnRpdHlNYW5hZ2VyRmFj\ndG9yeSBwbWYgPSBnZXRFbWYobWFwKTsNCiAgICAgICAgT3BlbkpQQUVudGl0\neU1hbmFnZXIgcG0gPSBwbWYuY3JlYXRlRW50aXR5TWFuYWdlcigpOw0KDQog\nICAgICAgIEJ1ZmZlcmVkTG9nRmFjdG9yeSBsb2dGYWN0b3J5ID0gKEJ1ZmZl\ncmVkTG9nRmFjdG9yeSkNCiAgICAgICAgICAgICgoT3BlbkpQQUVudGl0eU1h\nbmFnZXJTUEkpIHBtKS5nZXRDb25maWd1cmF0aW9uKCkuZ2V0TG9nRmFjdG9y\neSgpOw0KICAgICAgICBsb2dGYWN0b3J5LmNsZWFyKCk7DQoNCiAgICAgICAg\nUnVudGltZVRlc3QxIHBjID0gKFJ1bnRpbWVUZXN0MSkgcG0uZmluZChSdW50\naW1lVGVzdDEuY2xhc3MsIF9vaWQpOw0KICAgICAgICBsb2dGYWN0b3J5LmFz\nc2VydE5vTG9nTWVzc2FnZSgiKm9ycGhhbioiKTsNCiAgICAgICAgYXNzZXJ0\nTnVsbChwYy5nZXRTZWxmT25lT25lKCkpOw0KICAgICAgICBsb2dGYWN0b3J5\nLmFzc2VydExvZ01lc3NhZ2UoIipvcnBoYW4qIik7DQogICAgICAgIGVuZEVt\nKHBtKTsNCiAgICAgICAgcG1mLmNsb3NlKCk7DQogICAgfQ0KDQogICAgcHVi\nbGljIHZvaWQgdGVzdEV4Y2VwdGlvbigpIHsNCiAgICAgICAgTWFwIG1hcCA9\nIGdldE9ycGhhbmVkS2V5Q29uZmlndXJhdGlvbigiZXhjZXB0aW9uIik7DQog\nICAgICAgIE9wZW5KUEFFbnRpdHlNYW5hZ2VyRmFjdG9yeSBwbWYgPSBnZXRF\nbWYobWFwKTsNCg0KICAgICAgICBPcGVuSlBBRW50aXR5TWFuYWdlciBwbSA9\nIHBtZi5jcmVhdGVFbnRpdHlNYW5hZ2VyKCk7DQoNCiAgICAgICAgQnVmZmVy\nZWRMb2dGYWN0b3J5IGxvZ0ZhY3RvcnkgPSAoQnVmZmVyZWRMb2dGYWN0b3J5\nKQ0KICAgICAgICAgICAgKChPcGVuSlBBRW50aXR5TWFuYWdlclNQSSkgcG0p\nLmdldENvbmZpZ3VyYXRpb24oKS5nZXRMb2dGYWN0b3J5KCk7DQogICAgICAg\nIGxvZ0ZhY3RvcnkuY2xlYXIoKTsNCg0KICAgICAgICBSdW50aW1lVGVzdDEg\ncGMgPSAoUnVudGltZVRlc3QxKSBwbS5maW5kKFJ1bnRpbWVUZXN0MS5jbGFz\ncywgX29pZCk7DQogICAgICAgIHRyeSB7DQogICAgICAgICAgICBwYy5nZXRT\nZWxmT25lT25lKCk7DQogICAgICAgICAgICBmYWlsKCJEaWQgbm90IHRocm93\nIGV4cGVjdGVkIGV4Y2VwdGlvbiBmb3Igb3JwaGFuZWQga2V5LiIpOw0KICAg\nICAgICB9IGNhdGNoIChFbnRpdHlOb3RGb3VuZEV4Y2VwdGlvbiBvbmZlKSB7\nDQogICAgICAgICAgICBsb2dGYWN0b3J5LmFzc2VydE5vTG9nTWVzc2FnZSgi\nKm9ycGhhbioiKTsNCiAgICAgICAgfSBjYXRjaCAoT3BlbkpQQUV4Y2VwdGlv\nbiBrZSkgew0KICAgICAgICAgICAgYnVnKDExMzgsIGtlLCAiV3JvbmcgZXhj\nZXB0aW9uIHR5cGUuIik7DQogICAgICAgIH0NCiAgICAgICAgZW5kRW0ocG0p\nOw0KICAgICAgICBwbWYuY2xvc2UoKTsNCiAgICB9DQoNCiAgICBwdWJsaWMg\ndm9pZCB0ZXN0Tm9uZSgpIHsNCiAgICAgICAgTWFwIG1hcCA9IGdldE9ycGhh\nbmVkS2V5Q29uZmlndXJhdGlvbigibm9uZSIpOw0KICAgICAgICBPcGVuSlBB\nRW50aXR5TWFuYWdlckZhY3RvcnkgcG1mID0gZ2V0RW1mKG1hcCk7DQogICAg\nICAgIE9wZW5KUEFFbnRpdHlNYW5hZ2VyIHBtID0gcG1mLmNyZWF0ZUVudGl0\neU1hbmFnZXIoKTsNCg0KICAgICAgICBCdWZmZXJlZExvZ0ZhY3RvcnkgbG9n\nRmFjdG9yeSA9IChCdWZmZXJlZExvZ0ZhY3RvcnkpDQogICAgICAgICAgICAo\nKE9wZW5KUEFFbnRpdHlNYW5hZ2VyU1BJKSBwbSkuZ2V0Q29uZmlndXJhdGlv\nbigpLmdldExvZ0ZhY3RvcnkoKTsNCiAgICAgICAgbG9nRmFjdG9yeS5jbGVh\ncigpOw0KDQogICAgICAgIFJ1bnRpbWVUZXN0MSBwYyA9IChSdW50aW1lVGVz\ndDEpIHBtLmZpbmQoUnVudGltZVRlc3QxLmNsYXNzLCBfb2lkKTsNCiAgICAg\nICAgYXNzZXJ0TnVsbChwYy5nZXRTZWxmT25lT25lKCkpOw0KICAgICAgICBs\nb2dGYWN0b3J5LmFzc2VydE5vTG9nTWVzc2FnZSgiKm9ycGhhbioiKTsNCiAg\nICAgICAgZW5kRW0ocG0pOw0KICAgICAgICBwbWYuY2xvc2UoKTsNCiAgICB9\nDQoNCiAgICBNYXAgZ2V0T3JwaGFuZWRLZXlDb25maWd1cmF0aW9uKFN0cmlu\nZyBvcnBoYW5LZXlBY3Rpb24pIHsNCiAgICAgICAgTWFwIG1hcCA9IG5ldyBI\nYXNoTWFwKCk7DQogICAgICAgIG1hcC5wdXQoIm9wZW5qcGEuTG9nIiwgQnVm\nZmVyZWRMb2dGYWN0b3J5LmNsYXNzLmdldE5hbWUoKSk7DQogICAgICAgIGlm\nIChvcnBoYW5LZXlBY3Rpb24gIT0gbnVsbCkNCiAgICAgICAgICAgIG1hcC5w\ndXQoIm9wZW5qcGEuT3JwaGFuZWRLZXlBY3Rpb24iLCBvcnBoYW5LZXlBY3Rp\nb24pOw0KICAgICAgICByZXR1cm4gbWFwOw0KICAgIH0NCn0NCg==\n","encoding":"base64"}

