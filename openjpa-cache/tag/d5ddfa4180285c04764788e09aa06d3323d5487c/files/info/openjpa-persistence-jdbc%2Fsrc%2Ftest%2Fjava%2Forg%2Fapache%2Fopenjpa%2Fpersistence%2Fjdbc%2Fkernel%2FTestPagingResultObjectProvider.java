{"sha":"e6186ab400524230c8556c219ca9467b39192534","node_id":"MDQ6QmxvYjIwNjM2NDplNjE4NmFiNDAwNTI0MjMwYzg1NTZjMjE5Y2E5NDY3YjM5MTkyNTM0","size":23345,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/e6186ab400524230c8556c219ca9467b39192534","content":"LyoNCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUNCiAqIG9yIG1vcmUgY29udHJpYnV0b3Ig\nbGljZW5zZSBhZ3JlZW1lbnRzLiAgU2VlIHRoZSBOT1RJQ0UgZmlsZQ0KICog\nZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5m\nb3JtYXRpb24NCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAg\nVGhlIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUNCiAqIHRvIHlvdSB1bmRlciB0\naGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUNCiAqICJMaWNl\nbnNlIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNv\nbXBsaWFuY2UNCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFp\nbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQNCiAqDQogKiBodHRwOi8vd3d3\nLmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjANCiAqDQogKiBVbmxl\nc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGlu\nIHdyaXRpbmcsDQogKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUg\nTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbg0KICogIkFTIElTIiBCQVNJ\nUywgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZDQog\nKiBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBM\naWNlbnNlIGZvciB0aGUNCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmlu\nZyBwZXJtaXNzaW9ucyBhbmQgbGltaXRhdGlvbnMNCiAqIHVuZGVyIHRoZSBM\naWNlbnNlLiAgICANCiAqLw0KcGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEu\ncGVyc2lzdGVuY2UuamRiYy5rZXJuZWw7DQoNCmltcG9ydCBqYXZhLnV0aWwu\nKjsNCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5jb25mLio7DQpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0YS4qOw0KaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNxbC4qOw0KaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5qZGJjLmNvbW1vbi5hcHBzLio7\nDQoNCg0KaW1wb3J0IGphdmEubGFuZy5hbm5vdGF0aW9uLkFubm90YXRpb247\nDQppbXBvcnQganVuaXQuZnJhbWV3b3JrLio7DQppbXBvcnQgamF2YXgucGVy\nc2lzdGVuY2UuRW50aXR5TWFuYWdlcjsNCmltcG9ydCBqYXZheC5wZXJzaXN0\nZW5jZS5FbnRpdHlNYW5hZ2VyRmFjdG9yeTsNCmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEuamRiYy5jb25mLkpEQkNDb25maWd1cmF0aW9uOw0KaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5PcGVuSlBBRW50aXR5\nTWFuYWdlckZhY3Rvcnk7DQppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnBl\ncnNpc3RlbmNlLk9wZW5KUEFFbnRpdHlNYW5hZ2VyRmFjdG9yeVNQSTsNCmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuT3BlbkpQQUVu\ndGl0eU1hbmFnZXI7DQppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNp\nc3RlbmNlLk9wZW5KUEFQZXJzaXN0ZW5jZTsNCmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEucGVyc2lzdGVuY2UuT3BlbkpQQVF1ZXJ5Ow0KLy9pbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5FeHRlbnQ7DQppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNlLkV4dGVudDsNCg0KLyoqDQog\nKiA8cD5UZXN0IGxhcmdlIHJlc3VsdCwgdG8tbWFueSBlYWdlciBwYWdpbmcu\nPC9wPg0KICoNCiAqLw0KcHVibGljIGNsYXNzIFRlc3RQYWdpbmdSZXN1bHRP\nYmplY3RQcm92aWRlcg0KICAgIGV4dGVuZHMgVGVzdFNRTExpc3RlbmVyVGVz\ndENhc2Ugew0KDQoJcHJpdmF0ZSBPcGVuSlBBRW50aXR5TWFuYWdlckZhY3Rv\ncnkgZW1mOw0KDQoJcHVibGljIFRlc3RQYWdpbmdSZXN1bHRPYmplY3RQcm92\naWRlcihTdHJpbmcgbmFtZSkNCgl7DQoJCXN1cGVyKG5hbWUpOw0KCX0NCg0K\nICAgIHB1YmxpYyB2b2lkIHNldFVwKCkgdGhyb3dzIEV4Y2VwdGlvbnsNCgkJ\nc3VwZXIuc2V0VXAoKTsNCgkJZW1mID0gZ2V0RW1mKGdldFByb3BzKCkpOw0K\nICAgIAlFbnRpdHlNYW5hZ2VyIGVtID1jdXJyZW50RW50aXR5TWFuYWdlcigp\nOw0KICAgIH0NCg0KDQoNCiAgICBwdWJsaWMgYm9vbGVhbiBza2lwVGVzdCgp\nIHsNCiAgICAgICAgSkRCQ0NvbmZpZ3VyYXRpb24gY29uZiA9IChKREJDQ29u\nZmlndXJhdGlvbikgKChPcGVuSlBBRW50aXR5TWFuYWdlckZhY3RvcnlTUEkp\nIE9wZW5KUEFQZXJzaXN0ZW5jZS5jYXN0KGVtZikpLmdldENvbmZpZ3VyYXRp\nb24oKTsNCiAgICAgICAgREJEaWN0aW9uYXJ5IGRpY3QgPSBjb25mLmdldERC\nRGljdGlvbmFyeUluc3RhbmNlKCk7DQogICAgICAgIGlmIChkaWN0LmpvaW5T\neW50YXggPT0gSm9pbi5TWU5UQVhfVFJBRElUSU9OQUwpDQogICAgICAgICAg\nICByZXR1cm4gdHJ1ZTsNCg0KICAgICAgICAvLyBza2lwIHRlc3QgY2FzZSB0\naGF0IHJlcXVpcmVzIHN1YnNlbGVjdCBmb3IgREJzIHRoYXQgZG9uJ3Qgc3Vw\ncG9ydCBpdA0KICAgICAgICBpZiAoInRlc3RQYWdpbmdSYW5nZVF1ZXJ5Ii5l\ncXVhbHMoZ2V0TmFtZSgpKQ0KICAgICAgICAgICAgfHwgInRlc3ROb25QYWdp\nbmdSYW5nZVF1ZXJ5Ii5lcXVhbHMoZ2V0TmFtZSgpKSkgew0KICAgICAgICAg\nICAgaWYgKCFjb25mLmdldERCRGljdGlvbmFyeUluc3RhbmNlKCkuc3VwcG9y\ndHNTdWJzZWxlY3QpDQogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQog\nICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgfQ0KDQoN\nCiAgICBwdWJsaWMgdm9pZCB0ZXN0Tm9uUGFnaW5nRXh0ZW50KCkgew0KICAg\nICAgICBpbml0aWFsaXplUGFnaW5nUENzKCk7DQoNCiAgICAgICAgRW50aXR5\nTWFuYWdlciBlbT0gY3VycmVudEVudGl0eU1hbmFnZXIoKTsNCiAgICAgICAg\nLy9FbnRpdHlNYW5hZ2VyIGVtID1jdXJyZW50RW50aXR5TWFuYWdlcigpOw0K\nICAgICAgICBPcGVuSlBBRW50aXR5TWFuYWdlciBrZW0gPSBPcGVuSlBBUGVy\nc2lzdGVuY2UuY2FzdCAoZW0pOw0KICAgICAgICBFeHRlbnQgZXh0ZW50ID0g\na2VtLmNyZWF0ZUV4dGVudChQYWdpbmdQQy5jbGFzcywgdHJ1ZSk7DQoNCiAg\nICAgICAgZXh0ZW50LmdldEZldGNoUGxhbigpLnNldEZldGNoQmF0Y2hTaXpl\nKDApOw0KICAgICAgICBleHRlbnQuZ2V0RmV0Y2hQbGFuKCkuYWRkRmV0Y2hH\ncm91cCgicmVsIik7DQoNCiAgICAgICAgLy8gaWYgd2Ugb25seSBhY2Nlc3Mg\ndGhlIHJlbCBmaWVsZCwgd2Ugc2hvdWxkIG9ubHkgaGF2ZSB1c2VkIDEgc2Vs\nZWN0DQogICAgICAgIExpc3QgbGlzdCA9IGV4dGVudC5saXN0KCk7DQogICAg\nICAgIGFzc2VydEVxdWFscyg0LCBsaXN0LnNpemUoKSk7DQogICAgICAgIGFz\nc2VydFJlbChsaXN0LCA0KTsNCiAgICAgICAgYXNzZXJ0RXF1YWxzKHNxbC50\nb1N0cmluZygpLCAxLCBzcWwuc2l6ZSgpKTsNCiAgICAgICAgc3FsLmNsZWFy\nKCk7DQoNCiAgICAgICAgLy8gbm93IGFjY2Vzc2luZyB0aGUgcmVscyBjb2xs\nZWN0aW9uIHNob3VsZCBhZGQgc2VsZWN0cw0KICAgICAgICBhc3NlcnRSZWxz\nKGxpc3QsIDQpOw0KICAgICAgICBhc3NlcnRFcXVhbHMoc3FsLnRvU3RyaW5n\nKCksIDQsIHNxbC5zaXplKCkpOw0KICAgICAgICBzcWwuY2xlYXIoKTsNCg0K\nICAgICAgICBlbS5jbG9zZSgpOw0KICAgIH0NCg0KICAgIHB1YmxpYyB2b2lk\nIHRlc3ROb25QYWdpbmdRdWVyeSgpDQogICAgICAgIHRocm93cyBFeGNlcHRp\nb24gew0KICAgICAgICBpbml0aWFsaXplUGFnaW5nUENzKCk7DQoNCiAgICAg\nICAgRW50aXR5TWFuYWdlciBlbSA9Y3VycmVudEVudGl0eU1hbmFnZXIoKTsN\nCiAgICAgICAgT3BlbkpQQUVudGl0eU1hbmFnZXIga2VtID0gT3BlbkpQQVBl\ncnNpc3RlbmNlLmNhc3QoZW0pOw0KDQoJCVN0cmluZyB0aGVRdWVyeT0ic2Vs\nZWN0IGEgRlJPTSAiK1BhZ2luZ1BDLmNsYXNzLmdldFNpbXBsZU5hbWUoKSsi\nIGEgd2hlcmUgYS5pbnRGaWVsZCA+PSAwIjsNCg0KICAgICAgICAvL09wZW5K\nUEFRdWVyeSBxID0ga2VtLmNyZWF0ZVF1ZXJ5KFBhZ2luZ1BDLmNsYXNzLmdl\ndFNpbXBsZU5hbWUoKSwgImludEZpZWxkID49IDAiKTsNCiAgICAgICAgT3Bl\nbkpQQVF1ZXJ5IHEgPSBrZW0uY3JlYXRlUXVlcnkodGhlUXVlcnkpOw0KDQog\nICAgICAgIHEuZ2V0RmV0Y2hQbGFuKCkuc2V0RmV0Y2hCYXRjaFNpemUoMCk7\nDQogICAgICAgIHEuZ2V0RmV0Y2hQbGFuKCkuYWRkRmV0Y2hHcm91cHMoInJl\nbCIpOw0KDQogICAgICAgIC8vIGlmIHdlIG9ubHkgYWNjZXNzIHRoZSByZWwg\nZmllbGQsIHdlIHNob3VsZCBvbmx5IGhhdmUgdXNlZCB0d28NCiAgICAgICAg\nLy8gc2VsZWN0czogb25lIGZvciB0aGUgcXVlcnkgYW5kIG9uZSBmb3IgdGhl\nIHNpemUNCiAgICAgICAgTGlzdCBsaXN0ID0gKExpc3QpIHEuZ2V0UmVzdWx0\nTGlzdCgpOw0KICAgICAgICBhc3NlcnRFcXVhbHMoNCwgbGlzdC5zaXplKCkp\nOw0KICAgICAgICBhc3NlcnRSZWwobGlzdCwgNCk7DQogICAgICAgIGFzc2Vy\ndEVxdWFscyhzcWwudG9TdHJpbmcoKSwgMiwgc3FsLnNpemUoKSk7DQogICAg\nICAgIGFzc2VydFRydWUoKFN0cmluZykgc3FsLmdldCgwKSwNCiAgICAgICAg\nICAgIG1hdGNoZXMoIiA+PSAiLCAoU3RyaW5nKSBzcWwuZ2V0KDApKSk7DQog\nICAgICAgIGFzc2VydFRydWUoKFN0cmluZykgc3FsLmdldCgxKSwNCiAgICAg\nICAgICAgIG1hdGNoZXMoIiBDT1VOVCIsIChTdHJpbmcpIHNxbC5nZXQoMSkp\nKTsNCiAgICAgICAgc3FsLmNsZWFyKCk7DQoNCiAgICAgICAgLy8gbm93IGFj\nY2Vzc2luZyB0aGUgcmVscyBjb2xsZWN0aW9uIHNob3VsZCBhZGQgc2VsZWN0\ncw0KICAgICAgICBhc3NlcnRSZWxzKGxpc3QsIDQpOw0KICAgICAgICBhc3Nl\ncnRFcXVhbHMoc3FsLnRvU3RyaW5nKCksIDQsIHNxbC5zaXplKCkpOw0KICAg\nICAgICBzcWwuY2xlYXIoKTsNCg0KICAgICAgICBlbS5jbG9zZSgpOw0KICAg\nIH0NCg0KICAgIC8qKg0KICAgICAqIENoZWNrIHRoYXQgdGhlIHJlbCBmaWVs\nZCB3YXMgcmV0cmlldmVkIGNvcnJlY3RseS4NCiAgICAgKi8NCiAgIHByaXZh\ndGUgdm9pZCBhc3NlcnRSZWwoTGlzdCBwY3MsIGludCBzaXplKSB7DQogICAg\nICAgIFBhZ2luZ1BDIHBjOw0KICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8\nIHNpemU7IGkrKykgew0KICAgICAgICAgICAgcGMgPSAoUGFnaW5nUEMpIHBj\ncy5nZXQoaSk7DQogICAgICAgICAgICBhc3NlcnROb3ROdWxsKHBjLmdldFJl\nbCgpKTsNCiAgICAgICAgICAgIGFzc2VydEVxdWFscyhwYy5nZXRJbnRGaWVs\nZCgpICsgMSwgcGMuZ2V0UmVsKCkuZ2V0SW50RmllbGQoKSk7DQogICAgICAg\nIH0NCiAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgIHBjcy5nZXQoc2l6ZSAr\nIDEpOw0KICAgICAgICAgICAgZmFpbCgiUmV0cmlldmVkIHBhc3QgZW5kIG9m\nIGxpc3QiKTsNCiAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsNCiAg\nICAgICAgfQ0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIENoZWNrIHRoYXQg\ndGhlIHJlbHMgZmllbGQgd2FzIHJldHJpZXZlZCBjb3JyZWN0bHkuDQogICAg\nICovDQogICAgcHJpdmF0ZSB2b2lkIGFzc2VydFJlbHMoTGlzdCBwY3MsIGlu\ndCBzaXplKSB7DQogICAgICAgIFBhZ2luZ1BDIHBjOw0KICAgICAgICBmb3Ig\nKGludCBpID0gMDsgaSA8IHNpemU7IGkrKykgew0KICAgICAgICAgICAgcGMg\nPSAoUGFnaW5nUEMpIHBjcy5nZXQoaSk7DQogICAgICAgICAgICBhc3NlcnRF\ncXVhbHMoMiwgcGMuZ2V0UmVscygpLnNpemUoKSk7DQogICAgICAgICAgICBh\nc3NlcnRFcXVhbHMocGMuZ2V0SW50RmllbGQoKSArIDEsICgoUGFnaW5nSGVs\ncGVyUEMpDQogICAgICAgICAgICAgICAgcGMuZ2V0UmVscygpLmdldCgwKSku\nZ2V0SW50RmllbGQoKSk7DQogICAgICAgICAgICBhc3NlcnRFcXVhbHMocGMu\nZ2V0SW50RmllbGQoKSArIDIsICgoUGFnaW5nSGVscGVyUEMpDQogICAgICAg\nICAgICAgICAgcGMuZ2V0UmVscygpLmdldCgxKSkuZ2V0SW50RmllbGQoKSk7\nDQogICAgICAgIH0NCiAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgIHBjcy5n\nZXQoc2l6ZSArIDEpOw0KICAgICAgICAgICAgZmFpbCgiUmV0cmlldmVkIHBh\nc3QgZW5kIG9mIGxpc3QiKTsNCiAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9u\nIGUpIHsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIHB1YmxpYyB2b2lkIHRl\nc3RQYWdpbmdFeHRlbnQoKQ0KICAgICAgICB0aHJvd3MgRXhjZXB0aW9uIHsN\nCiAgICAgICAgaW5pdGlhbGl6ZVBhZ2luZ1BDcygpOw0KDQogICAgICAgIEVu\ndGl0eU1hbmFnZXIgZW0gPWN1cnJlbnRFbnRpdHlNYW5hZ2VyKCk7DQogICAg\nICAgIE9wZW5KUEFFbnRpdHlNYW5hZ2VyIGtlbSA9IE9wZW5KUEFQZXJzaXN0\nZW5jZS5jYXN0IChlbSk7DQogICAgICAgIEV4dGVudCBleHRlbnQgPSBrZW0u\nY3JlYXRlRXh0ZW50KFBhZ2luZ1BDLmNsYXNzLCB0cnVlKTsNCiAgICAgICAg\nZXh0ZW50LmdldEZldGNoUGxhbigpLnNldEZldGNoQmF0Y2hTaXplKDApOw0K\nICAgICAgICBleHRlbnQuZ2V0RmV0Y2hQbGFuKCkuYWRkRmV0Y2hHcm91cCgi\ncmVsIik7DQogICAgICAgIGV4dGVudC5nZXRGZXRjaFBsYW4oKS5hZGRGZXRj\naEdyb3VwKCJyZWxzIik7DQoNCg0KICAgICAgICAvLyB3ZSBzaG91bGQgZ2V0\nIHR3byBzZWxlY3RzOiB0aGUgaW5pdGlhbCBzZWxlY3QgYW5kIHRoZSBJTiBl\nYWdlciBzdG1udA0KICAgICAgICBMaXN0IGxpc3QgPSBleHRlbnQubGlzdCgp\nOw0KICAgICAgICBhc3NlcnRFcXVhbHMoNCwgbGlzdC5zaXplKCkpOw0KICAg\nICAgICBhc3NlcnRSZWwobGlzdCwgNCk7DQogICAgICAgIGFzc2VydFJlbHMo\nbGlzdCwgNCk7DQogICAgICAgIGFzc2VydEVxdWFscyhzcWwudG9TdHJpbmco\nKSwgMiwgc3FsLnNpemUoKSk7DQogICAgICAgIGFzc2VydFRydWUoKFN0cmlu\nZykgc3FsLmdldCgxKSwNCiAgICAgICAgICAgIG1hdGNoZXMoIiBJTiAiLCAo\nU3RyaW5nKSBzcWwuZ2V0KDEpKSk7DQogICAgICAgIHNxbC5jbGVhcigpOw0K\nDQogICAgICAgIGVtLmNsb3NlKCk7DQogICAgfQ0KDQogICAgcHVibGljIHZv\naWQgdGVzdFBhZ2luZ1F1ZXJ5KCkNCiAgICAgICAgdGhyb3dzIEV4Y2VwdGlv\nbiB7DQogICAgICAgIGluaXRpYWxpemVQYWdpbmdQQ3MoKTsNCg0KDQogICAg\nICAgIEVudGl0eU1hbmFnZXIgZW0gPWN1cnJlbnRFbnRpdHlNYW5hZ2VyKCk7\nDQogICAgICAgIE9wZW5KUEFFbnRpdHlNYW5hZ2VyIGtlbSA9IE9wZW5KUEFQ\nZXJzaXN0ZW5jZS5jYXN0IChlbSk7DQoNCgkJU3RyaW5nIHRoZVF1ZXJ5PSJz\nZWxlY3QgYSBGUk9NICIrUGFnaW5nUEMuY2xhc3MuZ2V0U2ltcGxlTmFtZSgp\nKyIgYSB3aGVyZSBhLmludEZpZWxkID49IDAiOw0KICAgICAgICBPcGVuSlBB\nUXVlcnkgcSA9IGtlbS5jcmVhdGVRdWVyeSh0aGVRdWVyeSk7DQogICAgICAg\nIHEuZ2V0RmV0Y2hQbGFuKCkuc2V0RmV0Y2hCYXRjaFNpemUoMCk7DQogICAg\nICAgIHEuZ2V0RmV0Y2hQbGFuKCkuYWRkRmV0Y2hHcm91cHMoInJlbCIpOw0K\nICAgICAgICBxLmdldEZldGNoUGxhbigpLmFkZEZldGNoR3JvdXBzKCJyZWxz\nIik7DQoNCg0KICAgICAgICAvLyB3ZSBzaG91bGQgZ2V0IHRocmVlIHNlbGVj\ndHM6IHRoZSBpbml0aWFsIHNlbGVjdCwgdGhlIENPVU5UIGZvciB0aGUNCiAg\nICAgICAgLy8gc2l6ZSwgYW5kIHRoZSBJTiBlYWdlciBzdG1udA0KICAgICAg\nICBMaXN0IGxpc3QgPSAoTGlzdCkgcS5nZXRSZXN1bHRMaXN0KCk7DQogICAg\nICAgIGFzc2VydEVxdWFscyg0LCBsaXN0LnNpemUoKSk7DQogICAgICAgIGFz\nc2VydFJlbChsaXN0LCA0KTsNCiAgICAgICAgYXNzZXJ0UmVscyhsaXN0LCA0\nKTsNCiAgICAgICAgYXNzZXJ0RXF1YWxzKHNxbC50b1N0cmluZygpLCAzLCBz\ncWwuc2l6ZSgpKTsNCiAgICAgICAgYXNzZXJ0VHJ1ZSgoU3RyaW5nKSBzcWwu\nZ2V0KDApLA0KICAgICAgICAgICAgbWF0Y2hlcygiID49ICIsIChTdHJpbmcp\nIHNxbC5nZXQoMCkpKTsNCiAgICAgICAgYXNzZXJ0VHJ1ZSgoU3RyaW5nKSBz\ncWwuZ2V0KDEpLA0KICAgICAgICAgICAgbWF0Y2hlcygiIENPVU5UIiwgKFN0\ncmluZykgc3FsLmdldCgxKSkpOw0KICAgICAgICBhc3NlcnRUcnVlKChTdHJp\nbmcpIHNxbC5nZXQoMiksDQogICAgICAgICAgICBtYXRjaGVzKCIgSU4gIiwg\nKFN0cmluZykgc3FsLmdldCgyKSkpOw0KICAgICAgICBhc3NlcnRGYWxzZSgo\nU3RyaW5nKSBzcWwuZ2V0KDIpLA0KICAgICAgICAgICAgbWF0Y2hlcygiID49\nICIsIChTdHJpbmcpIHNxbC5nZXQoMikpKTsNCiAgICAgICAgc3FsLmNsZWFy\nKCk7DQoNCiAgICAgICAgLy8gaWYgd2UgZXhlY3V0ZSBhbmQgdHJhdmVyc2Ug\nYSByZXN1bHQgYmVmb3JlIGdldHRpbmcgdGhlIHNpemUsIHdlDQogICAgICAg\nIC8vIHNob3VsZCBvbmx5IGdldCAyIHNlbGVjdHMsIHNpbmNlIHRoZSBjYWNo\naW5nIG9mIHRoZSBwYWdlIHNob3VsZA0KICAgICAgICAvLyByZWFjaCB0aGUg\nZW5kIG9mIHRoZSBsaXN0IGFuZCB0aGVyZWZvcmUga25vdyB0aGUgdG90YWwg\nc2l6ZQ0KICAgICAgICBsaXN0ID0gKExpc3QpIHEuZ2V0UmVzdWx0TGlzdCgp\nOw0KICAgICAgICBsaXN0LmdldCgwKTsNCiAgICAgICAgYXNzZXJ0RXF1YWxz\nKDQsIGxpc3Quc2l6ZSgpKTsNCiAgICAgICAgYXNzZXJ0UmVsKGxpc3QsIDQp\nOw0KICAgICAgICBhc3NlcnRSZWxzKGxpc3QsIDQpOw0KICAgICAgICBhc3Nl\ncnRFcXVhbHMoc3FsLnRvU3RyaW5nKCksIDIsIHNxbC5zaXplKCkpOw0KICAg\nICAgICBhc3NlcnRUcnVlKChTdHJpbmcpIHNxbC5nZXQoMSksDQogICAgICAg\nICAgICBtYXRjaGVzKCIgSU4gIiwgKFN0cmluZykgc3FsLmdldCgxKSkpOw0K\nICAgICAgICBzcWwuY2xlYXIoKTsNCg0KICAgICAgICBlbS5jbG9zZSgpOw0K\nICAgIH0NCg0KICAgIHB1YmxpYyB2b2lkIHRlc3RQYWdpbmdBcHBJZEV4dGVu\ndCgpDQogICAgICAgIHRocm93cyBFeGNlcHRpb24gew0KICAgICAgICBpbml0\naWFsaXplUGFnaW5nQXBwSWRQQ3MoKTsNCg0KICAgICAgICBFbnRpdHlNYW5h\nZ2VyIGVtID1jdXJyZW50RW50aXR5TWFuYWdlcigpOw0KICAgICAgICBPcGVu\nSlBBRW50aXR5TWFuYWdlciBrZW0gPSBPcGVuSlBBUGVyc2lzdGVuY2UuY2Fz\ndCAoZW0pOw0KICAgICAgICBFeHRlbnQgZXh0ZW50ID0ga2VtLmNyZWF0ZUV4\ndGVudChQYWdpbmdBcHBJZFBDLmNsYXNzLCB0cnVlKTsNCg0KICAgICAgICBl\neHRlbnQuZ2V0RmV0Y2hQbGFuKCkuc2V0RmV0Y2hCYXRjaFNpemUoMCk7DQog\nICAgICAgIGV4dGVudC5nZXRGZXRjaFBsYW4oKS5hZGRGZXRjaEdyb3VwKCJy\nZWwiKTsNCiAgICAgICAgZXh0ZW50LmdldEZldGNoUGxhbigpLmFkZEZldGNo\nR3JvdXAoInJlbHMiKTsNCg0KICAgICAgICAvLyB3ZSBzaG91bGQgZ2V0IHR3\nbyBzZWxlY3RzOiB0aGUgaW5pdGlhbCBzZWxlY3QgYW5kIHRoZSBJTiBlYWdl\nciBzdG1udA0KICAgICAgICBMaXN0IGxpc3QgPSBleHRlbnQubGlzdCgpOw0K\nICAgICAgICBhc3NlcnRFcXVhbHMoNCwgbGlzdC5zaXplKCkpOw0KICAgICAg\nICBhc3NlcnRBcHBJZFJlbChsaXN0LCA0KTsNCiAgICAgICAgYXNzZXJ0QXBw\nSWRSZWxzKGxpc3QsIDQpOw0KICAgICAgICBhc3NlcnRFcXVhbHMoc3FsLnRv\nU3RyaW5nKCksIDIsIHNxbC5zaXplKCkpOw0KICAgICAgICBhc3NlcnRUcnVl\nKChTdHJpbmcpIHNxbC5nZXQoMSksDQogICAgICAgICAgICBtYXRjaGVzKCIg\nT1IgIiwgKFN0cmluZykgc3FsLmdldCgxKSkpOw0KICAgICAgICBzcWwuY2xl\nYXIoKTsNCg0KICAgICAgICBlbS5jbG9zZSgpOw0KICAgIH0NCg0KICAgIHB1\nYmxpYyB2b2lkIHRlc3RQYWdpbmdBcHBJZFF1ZXJ5KCkNCiAgICAgICAgdGhy\nb3dzIEV4Y2VwdGlvbiB7DQogICAgICAgIGluaXRpYWxpemVQYWdpbmdBcHBJ\nZFBDcygpOw0KDQogICAgICAgIEVudGl0eU1hbmFnZXIgZW0gPWN1cnJlbnRF\nbnRpdHlNYW5hZ2VyKCk7DQogICAgICAgIE9wZW5KUEFFbnRpdHlNYW5hZ2Vy\nIGtlbSA9IE9wZW5KUEFQZXJzaXN0ZW5jZS5jYXN0KGVtKTsNCg0KCQlTdHJp\nbmcgdGhlUXVlcnk9InNlbGVjdCBhIEZST00gIitQYWdpbmdBcHBJZFBDLmNs\nYXNzLmdldFNpbXBsZU5hbWUoKSsiIGEgd2hlcmUgYS5pbnRGaWVsZCA+PSAw\nIjsNCiAgICAgICAgT3BlbkpQQVF1ZXJ5IHEgPSBrZW0uY3JlYXRlUXVlcnko\ndGhlUXVlcnkpOw0KDQoNCiAgICAgICAgcS5nZXRGZXRjaFBsYW4oKS5zZXRG\nZXRjaEJhdGNoU2l6ZSgwKTsNCiAgICAgICAgcS5nZXRGZXRjaFBsYW4oKS5h\nZGRGZXRjaEdyb3VwcygicmVsIik7DQogICAgICAgIHEuZ2V0RmV0Y2hQbGFu\nKCkuYWRkRmV0Y2hHcm91cHMoInJlbHMiKTsNCg0KICAgICAgICAvLyB3ZSBz\naG91bGQgZ2V0IHRocmVlIHNlbGVjdHM6IHRoZSBpbml0aWFsIHNlbGVjdCwg\ndGhlIENPVU5UIGZvciB0aGUNCiAgICAgICAgLy8gc2l6ZSwgYW5kIHRoZSBP\nUiBlYWdlciBzdG1udA0KICAgICAgICBMaXN0IGxpc3QgPSAoTGlzdCkgcS5n\nZXRSZXN1bHRMaXN0KCk7DQogICAgICAgIGFzc2VydEVxdWFscyg0LCBsaXN0\nLnNpemUoKSk7DQogICAgICAgIGFzc2VydEFwcElkUmVsKGxpc3QsIDQpOw0K\nICAgICAgICBhc3NlcnRBcHBJZFJlbHMobGlzdCwgNCk7DQogICAgICAgIGFz\nc2VydEVxdWFscyhzcWwudG9TdHJpbmcoKSwgMywgc3FsLnNpemUoKSk7DQog\nICAgICAgIGFzc2VydFRydWUoKFN0cmluZykgc3FsLmdldCgwKSwNCiAgICAg\nICAgICAgIG1hdGNoZXMoIiA+PSAiLCAoU3RyaW5nKSBzcWwuZ2V0KDApKSk7\nDQogICAgICAgIGFzc2VydFRydWUoKFN0cmluZykgc3FsLmdldCgxKSwNCiAg\nICAgICAgICAgIG1hdGNoZXMoIiBDT1VOVCIsIChTdHJpbmcpIHNxbC5nZXQo\nMSkpKTsNCiAgICAgICAgYXNzZXJ0VHJ1ZSgoU3RyaW5nKSBzcWwuZ2V0KDIp\nLA0KICAgICAgICAgICAgbWF0Y2hlcygiIE9SICIsIChTdHJpbmcpIHNxbC5n\nZXQoMikpKTsNCiAgICAgICAgYXNzZXJ0RmFsc2UoKFN0cmluZykgc3FsLmdl\ndCgyKSwNCiAgICAgICAgICAgIG1hdGNoZXMoIiA+PSAiLCAoU3RyaW5nKSBz\ncWwuZ2V0KDIpKSk7DQogICAgICAgIHNxbC5jbGVhcigpOw0KDQogICAgICAg\nIGVtLmNsb3NlKCk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICogQ2hlY2sg\ndGhhdCB0aGUgcmVsIGZpZWxkIHdhcyByZXRyaWV2ZWQgY29ycmVjdGx5Lg0K\nICAgICAqLw0KICAgIHByaXZhdGUgdm9pZCBhc3NlcnRBcHBJZFJlbChMaXN0\nIHBjcywgaW50IHNpemUpIHsNCiAgICAgICAgUGFnaW5nQXBwSWRQQyBwYzsN\nCiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBzaXplOyBpKyspIHsNCiAg\nICAgICAgICAgIHBjID0gKFBhZ2luZ0FwcElkUEMpIHBjcy5nZXQoaSk7DQog\nICAgICAgICAgICBhc3NlcnROb3ROdWxsKHBjLmdldFJlbCgpKTsNCiAgICAg\nICAgICAgIGFzc2VydEVxdWFscyhwYy5nZXRJbnRGaWVsZCgpICsgMSwgcGMu\nZ2V0UmVsKCkuZ2V0SW50RmllbGQoKSk7DQogICAgICAgIH0NCiAgICAgICAg\ndHJ5IHsNCiAgICAgICAgICAgIHBjcy5nZXQoc2l6ZSArIDEpOw0KICAgICAg\nICAgICAgZmFpbCgiUmV0cmlldmVkIHBhc3QgZW5kIG9mIGxpc3QiKTsNCiAg\nICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsNCiAgICAgICAgfQ0KICAg\nIH0NCg0KICAgIC8qKg0KICAgICAqIENoZWNrIHRoYXQgdGhlIHJlbHMgZmll\nbGQgd2FzIHJldHJpZXZlZCBjb3JyZWN0bHkuDQogICAgICovDQogICAgcHJp\ndmF0ZSB2b2lkIGFzc2VydEFwcElkUmVscyhMaXN0IHBjcywgaW50IHNpemUp\nIHsNCiAgICAgICAgUGFnaW5nQXBwSWRQQyBwYzsNCiAgICAgICAgZm9yIChp\nbnQgaSA9IDA7IGkgPCBzaXplOyBpKyspIHsNCiAgICAgICAgICAgIHBjID0g\nKFBhZ2luZ0FwcElkUEMpIHBjcy5nZXQoaSk7DQogICAgICAgICAgICBhc3Nl\ncnRFcXVhbHMoMiwgcGMuZ2V0UmVscygpLnNpemUoKSk7DQogICAgICAgICAg\nICBhc3NlcnRFcXVhbHMocGMuZ2V0SW50RmllbGQoKSArIDEsICgoUGFnaW5n\nSGVscGVyUEMpDQogICAgICAgICAgICAgICAgcGMuZ2V0UmVscygpLmdldCgw\nKSkuZ2V0SW50RmllbGQoKSk7DQogICAgICAgICAgICBhc3NlcnRFcXVhbHMo\ncGMuZ2V0SW50RmllbGQoKSArIDIsICgoUGFnaW5nSGVscGVyUEMpDQogICAg\nICAgICAgICAgICAgcGMuZ2V0UmVscygpLmdldCgxKSkuZ2V0SW50RmllbGQo\nKSk7DQogICAgICAgIH0NCiAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgIHBj\ncy5nZXQoc2l6ZSArIDEpOw0KICAgICAgICAgICAgZmFpbCgiUmV0cmlldmVk\nIHBhc3QgZW5kIG9mIGxpc3QiKTsNCiAgICAgICAgfSBjYXRjaCAoRXhjZXB0\naW9uIGUpIHsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIHB1YmxpYyB2b2lk\nIHRlc3RNdWx0aVBhZ2VFeHRlbnQoKQ0KICAgICAgICB0aHJvd3MgRXhjZXB0\naW9uIHsNCiAgICAgICAgaW5pdGlhbGl6ZVBhZ2luZ1BDcygpOw0KDQogICAg\nICAgIEVudGl0eU1hbmFnZXIgZW0gPWN1cnJlbnRFbnRpdHlNYW5hZ2VyKCk7\nDQogICAgICAgIE9wZW5KUEFFbnRpdHlNYW5hZ2VyIGtlbSA9IE9wZW5KUEFQ\nZXJzaXN0ZW5jZS5jYXN0KGVtKTsNCiAgICAgICAgRXh0ZW50IGV4dGVudCA9\nIGtlbS5jcmVhdGVFeHRlbnQoUGFnaW5nUEMuY2xhc3MsIHRydWUpOw0KDQog\nICAgICAgIGV4dGVudC5nZXRGZXRjaFBsYW4oKS5zZXRGZXRjaEJhdGNoU2l6\nZSgyKTsgICAgLy8gMiBwYWdlcyBvZiAyDQogICAgICAgIGV4dGVudC5nZXRG\nZXRjaFBsYW4oKS5hZGRGZXRjaEdyb3VwKCJyZWwiKTsNCiAgICAgICAgZXh0\nZW50LmdldEZldGNoUGxhbigpLmFkZEZldGNoR3JvdXAoInJlbHMiKTsNCg0K\nICAgICAgICAvLyB3ZSBzaG91bGQgZ2V0IHR3byBzZWxlY3RzOiB0aGUgaW5p\ndGlhbCBzZWxlY3QgYW5kIHRoZSBJTiBlYWdlciBzdG1udA0KICAgICAgICBM\naXN0IGxpc3QgPSBleHRlbnQubGlzdCgpOw0KICAgICAgICBhc3NlcnRFcXVh\nbHMobGlzdC50b1N0cmluZygpLCA0LCBsaXN0LnNpemUoKSk7DQogICAgICAg\nIGFzc2VydFJlbChsaXN0LCA0KTsNCiAgICAgICAgYXNzZXJ0UmVscyhsaXN0\nLCA0KTsNCiAgICAgICAgYXNzZXJ0RXF1YWxzKHNxbC50b1N0cmluZygpLCAz\nLCBzcWwuc2l6ZSgpKTsNCiAgICAgICAgYXNzZXJ0VHJ1ZSgoU3RyaW5nKSBz\ncWwuZ2V0KDEpLA0KICAgICAgICAgICAgbWF0Y2hlcygiIElOICIsIChTdHJp\nbmcpIHNxbC5nZXQoMSkpKTsNCiAgICAgICAgYXNzZXJ0VHJ1ZSgoU3RyaW5n\nKSBzcWwuZ2V0KDIpLA0KICAgICAgICAgICAgbWF0Y2hlcygiIElOICIsIChT\ndHJpbmcpIHNxbC5nZXQoMikpKTsNCiAgICAgICAgc3FsLmNsZWFyKCk7DQoN\nCiAgICAgICAgZW0uY2xvc2UoKTsNCiAgICB9DQoNCiAgICBwdWJsaWMgdm9p\nZCB0ZXN0TXVsdGlQYWdlUXVlcnkoKQ0KICAgICAgICB0aHJvd3MgRXhjZXB0\naW9uIHsNCiAgICAgICAgaW5pdGlhbGl6ZVBhZ2luZ1BDcygpOw0KDQogICAg\nICAgIEVudGl0eU1hbmFnZXIgZW0gPWN1cnJlbnRFbnRpdHlNYW5hZ2VyKCk7\nDQogICAgICAgIE9wZW5KUEFFbnRpdHlNYW5hZ2VyIGtlbSA9IE9wZW5KUEFQ\nZXJzaXN0ZW5jZS5jYXN0KGVtKTsNCg0KCQlTdHJpbmcgdGhlUXVlcnk9InNl\nbGVjdCBhIEZST00gIitQYWdpbmdQQy5jbGFzcy5nZXRTaW1wbGVOYW1lKCkr\nIiBhIHdoZXJlIGEuaW50RmllbGQgPj0gMCI7DQogICAgICAgIE9wZW5KUEFR\ndWVyeSBxID0ga2VtLmNyZWF0ZVF1ZXJ5KHRoZVF1ZXJ5KTsNCg0KDQoJCS8v\nRklYTUUganRob21hcyBjb21tZW50aW5nIHRpbGwgd2UgZmluZCBob3cgb3Jk\nZXJpbmcgY2FuIGJlIGRvbmUNCiAgICAgICAgLy9xLnNldE9yZGVyaW5nKCJp\nbnRGaWVsZCBhc2NlbmRpbmciKTsNCiAgICAgICAgcS5nZXRGZXRjaFBsYW4o\nKS5zZXRGZXRjaEJhdGNoU2l6ZSgyKTsgICAgLy8gMiBwYWdlcyBvZiAyDQog\nICAgICAgIHEuZ2V0RmV0Y2hQbGFuKCkuYWRkRmV0Y2hHcm91cCgicmVsIik7\nDQogICAgICAgIHEuZ2V0RmV0Y2hQbGFuKCkuYWRkRmV0Y2hHcm91cCgicmVs\ncyIpOw0KDQogICAgICAgIC8vIHdlIHNob3VsZCBnZXQgZm91ciBzZWxlY3Rz\nOiB0aGUgaW5pdGlhbCBzZWxlY3QsIHRoZSBjb3VudCwgYW5kIHRoZQ0KICAg\nICAgICAvLyB0d28gSU4gZWFnZXIgc3RtbnRzDQogICAgICAgIExpc3QgbGlz\ndCA9IChMaXN0KSBxLmdldFJlc3VsdExpc3QoKTsNCiAgICAgICAgYXNzZXJ0\nRXF1YWxzKGxpc3QudG9TdHJpbmcoKSwgNCwgbGlzdC5zaXplKCkpOw0KICAg\nICAgICAvLyBzbyB3ZSBkb24ndCBoYXZlIHRvIHJlLWV4ZWN1dGUgdG8gbW92\nZSBiYWNrIHRvIGJlZ2lubmluZw0KICAgICAgICBsaXN0ID0gbmV3IEFycmF5\nTGlzdChsaXN0KTsNCiAgICAgICAgYXNzZXJ0UmVsKGxpc3QsIDQpOw0KICAg\nICAgICBhc3NlcnRSZWxzKGxpc3QsIDQpOw0KDQogICAgICAgIGFzc2VydEVx\ndWFscyhzcWwudG9TdHJpbmcoKSwgNCwgc3FsLnNpemUoKSk7DQogICAgICAg\nIGFzc2VydFRydWUoKFN0cmluZykgc3FsLmdldCgxKSwNCiAgICAgICAgICAg\nIG1hdGNoZXMoIiBDT1VOVCIsIChTdHJpbmcpIHNxbC5nZXQoMSkpKTsNCiAg\nICAgICAgYXNzZXJ0VHJ1ZSgoU3RyaW5nKSBzcWwuZ2V0KDIpLA0KICAgICAg\nICAgICAgbWF0Y2hlcygiIElOICIsIChTdHJpbmcpIHNxbC5nZXQoMikpKTsN\nCiAgICAgICAgYXNzZXJ0VHJ1ZSgoU3RyaW5nKSBzcWwuZ2V0KDMpLA0KICAg\nICAgICAgICAgbWF0Y2hlcygiIElOICIsIChTdHJpbmcpIHNxbC5nZXQoMykp\nKTsNCiAgICAgICAgc3FsLmNsZWFyKCk7DQoNCiAgICAgICAgLy8gaWYgd2Ug\nYWNjZXNzIGEgcmVzdWx0IG9iamVjdCBvbiB0aGUgc2Vjb25kIHBhZ2UsIHdl\nIHNob3VsZCBnZXQgb25seQ0KICAgICAgICAvLyB0aHJlZSBzZWxlY3RzOiB0\naGUgaW5pdGlhbCBzZWxlY3QsIHRoZSBjb3VudCwgYW5kIHRoZSBJTiBlYWdl\nciBzdG1udA0KICAgICAgICAvLyBmb3IgcGFnZSAyDQogICAgICAgIGxpc3Qg\nPSAoTGlzdCkgcS5nZXRSZXN1bHRMaXN0KCk7DQogICAgICAgIGFzc2VydEVx\ndWFscyhsaXN0LnRvU3RyaW5nKCksIDQsIGxpc3Quc2l6ZSgpKTsNCiAgICAg\nICAgUGFnaW5nUEMgcGMgPSAoUGFnaW5nUEMpIGxpc3QuZ2V0KDIpOw0KICAg\nICAgICBhc3NlcnRFcXVhbHMoMiwgcGMuZ2V0SW50RmllbGQoKSk7DQogICAg\nICAgIGFzc2VydEVxdWFscyhzcWwudG9TdHJpbmcoKSwgMywgc3FsLnNpemUo\nKSk7DQogICAgICAgIGFzc2VydFRydWUoKFN0cmluZykgc3FsLmdldCgyKSwN\nCiAgICAgICAgICAgIG1hdGNoZXMoIiBJTiIsIChTdHJpbmcpIHNxbC5nZXQo\nMikpKTsNCg0KICAgICAgICBhc3NlcnRSZWwobGlzdCwgNCk7DQogICAgICAg\nIGFzc2VydFJlbHMobGlzdCwgNCk7DQogICAgICAgIHNxbC5jbGVhcigpOw0K\nDQogICAgICAgIGVtLmNsb3NlKCk7DQogICAgfQ0KDQogICAgcHVibGljIHZv\naWQgdGVzdExhc3RQYWdlUXVlcnkoKQ0KICAgICAgICB0aHJvd3MgRXhjZXB0\naW9uIHsNCiAgICAgICAgaW5pdGlhbGl6ZVBhZ2luZ1BDcygpOw0KDQogICAg\nICAgIEVudGl0eU1hbmFnZXIgZW0gPWN1cnJlbnRFbnRpdHlNYW5hZ2VyKCk7\nDQogICAgICAgIE9wZW5KUEFFbnRpdHlNYW5hZ2VyIGtlbSA9IE9wZW5KUEFQ\nZXJzaXN0ZW5jZS5jYXN0KGVtKTsNCg0KCQlTdHJpbmcgdGhlUXVlcnk9InNl\nbGVjdCBhIEZST00gIitQYWdpbmdQQy5jbGFzcy5nZXRTaW1wbGVOYW1lKCkr\nIiBhIHdoZXJlIGEuaW50RmllbGQgPj0gMCI7DQogICAgICAgIE9wZW5KUEFR\ndWVyeSBxID0ga2VtLmNyZWF0ZVF1ZXJ5KHRoZVF1ZXJ5KTsNCg0KDQogICAg\nICAgIC8vRklYTUUganRob21hcyBjb21tZW50aW5nIHRpbGwgd2UgZmluZCBo\nb3cgb3JkZXJpbmcgY2FuIGJlIGRvbmUNCiAgICAgICAgLy9xLnNldE9yZGVy\naW5nKCJpbnRGaWVsZCBhc2NlbmRpbmciKTsNCiAgICAgICAgcS5nZXRGZXRj\naFBsYW4oKS5zZXRGZXRjaEJhdGNoU2l6ZSgzKTsgICAgLy8gMSBvbiBwYWdl\nIDINCiAgICAgICAgcS5nZXRGZXRjaFBsYW4oKS5hZGRGZXRjaEdyb3Vwcygi\ncmVsIik7DQogICAgICAgIHEuZ2V0RmV0Y2hQbGFuKCkuYWRkRmV0Y2hHcm91\ncHMoInJlbHMiKTsNCg0KICAgICAgICAvLyBpZiB3ZSBhY2Nlc3MgYSByZXN1\nbHQgb2JqZWN0IG9uIHRoZSBzZWNvbmQgcGFnZSwgd2Ugc2hvdWxkIGdldCBv\nbmx5DQogICAgICAgIC8vIHR3byBzZWxlY3RzOiB0aGUgaW5pdGlhbCBzZWxl\nY3QgYW5kIHRoZSBlYWdlciBzdG1udCBmb3IgcGFnZQ0KICAgICAgICBMaXN0\nIGxpc3QgPSAoTGlzdCkgcS5nZXRSZXN1bHRMaXN0KCk7DQogICAgICAgIFBh\nZ2luZ1BDIHBjID0gKFBhZ2luZ1BDKSBsaXN0LmdldCgzKTsNCiAgICAgICAg\nYXNzZXJ0RXF1YWxzKDMsIHBjLmdldEludEZpZWxkKCkpOw0KICAgICAgICBh\nc3NlcnRFcXVhbHMobGlzdC50b1N0cmluZygpLCA0LCBsaXN0LnNpemUoKSk7\nDQogICAgICAgIGFzc2VydEVxdWFscyhzcWwudG9TdHJpbmcoKSwgMiwgc3Fs\nLnNpemUoKSk7DQogICAgICAgIC8vIGZvciBzaW5nbGUgcmVzdWx0LCBzaG91\nbGQgdXNlIHN0YW5kYXJkIHNlbGVjdCwgbm90IElODQogICAgICAgIGFzc2Vy\ndEZhbHNlKChTdHJpbmcpIHNxbC5nZXQoMSksDQogICAgICAgICAgICBtYXRj\naGVzKCIgSU4gIiwgKFN0cmluZykgc3FsLmdldCgxKSkpOw0KICAgICAgICBz\ncWwuY2xlYXIoKTsNCg0KICAgICAgICBlbS5jbG9zZSgpOw0KICAgIH0NCg0K\nICAgIHB1YmxpYyB2b2lkIHRlc3RTaW5nbGVSZXN1bHRQYWdlKCkNCiAgICAg\nICAgdGhyb3dzIEV4Y2VwdGlvbiB7DQogICAgICAgIGluaXRpYWxpemVQYWdp\nbmdQQ3MoKTsNCg0KCSAgICBFbnRpdHlNYW5hZ2VyIGVtID1jdXJyZW50RW50\naXR5TWFuYWdlcigpOw0KICAgICAgICBPcGVuSlBBRW50aXR5TWFuYWdlciBr\nZW0gPSBPcGVuSlBBUGVyc2lzdGVuY2UuY2FzdCAoZW0pOw0KICAgICAgICBF\neHRlbnQgZXh0ZW50ID0ga2VtLmNyZWF0ZUV4dGVudChQYWdpbmdQQy5jbGFz\ncywgdHJ1ZSk7DQogICAgICAgIGV4dGVudC5nZXRGZXRjaFBsYW4oKS5zZXRG\nZXRjaEJhdGNoU2l6ZSgzKTsgICAgLy8gMSBvbiBwYWdlIDINCiAgICAgICAg\nZXh0ZW50LmdldEZldGNoUGxhbigpLmFkZEZldGNoR3JvdXAoInJlbCIpOw0K\nICAgICAgICBleHRlbnQuZ2V0RmV0Y2hQbGFuKCkuYWRkRmV0Y2hHcm91cCgi\ncmVscyIpOw0KDQogICAgICAgIC8vIHdlIHNob3VsZCBnZXQgdHdvIHNlbGVj\ndHM6IHRoZSBpbml0aWFsIHNlbGVjdCBhbmQgdGhlIElOIGVhZ2VyIHN0bW50\nDQogICAgICAgIExpc3QgbGlzdCA9IGV4dGVudC5saXN0KCk7DQogICAgICAg\nIGFzc2VydEVxdWFscyhsaXN0LnRvU3RyaW5nKCksIDQsIGxpc3Quc2l6ZSgp\nKTsNCiAgICAgICAgYXNzZXJ0UmVsKGxpc3QsIDQpOw0KICAgICAgICBhc3Nl\ncnRSZWxzKGxpc3QsIDQpOw0KICAgICAgICBhc3NlcnRFcXVhbHMoc3FsLnRv\nU3RyaW5nKCksIDMsIHNxbC5zaXplKCkpOw0KICAgICAgICBhc3NlcnRUcnVl\nKChTdHJpbmcpIHNxbC5nZXQoMSksDQogICAgICAgICAgICBtYXRjaGVzKCIg\nSU4gIiwgKFN0cmluZykgc3FsLmdldCgxKSkpOw0KICAgICAgICBhc3NlcnRG\nYWxzZSgoU3RyaW5nKSBzcWwuZ2V0KDIpLA0KICAgICAgICAgICAgbWF0Y2hl\ncygiIElOICIsIChTdHJpbmcpIHNxbC5nZXQoMikpKTsNCiAgICAgICAgc3Fs\nLmNsZWFyKCk7DQoNCiAgICAgICAgZW0uY2xvc2UoKTsNCiAgICB9DQoNCiAg\nLyogIHB1YmxpYyB2b2lkIHRlc3ROb25QYWdpbmdSYW5nZVF1ZXJ5KCkNCiAg\nICAgICAgdGhyb3dzIEV4Y2VwdGlvbiB7DQogICAgICAgIGluaXRpYWxpemVQ\nYWdpbmdQQ3MoKTsNCg0KICAgICAgICBFbnRpdHlNYW5hZ2VyIGVtID1jdXJy\nZW50RW50aXR5TWFuYWdlcigpOw0KICAgICAgICBRdWVyeSBxID0gZW0ubmV3\nUXVlcnkoUGFnaW5nUEMuY2xhc3MsICJpbnRGaWVsZCA+PSAwIik7DQoNCiAg\nICAgICAgLy9GSVhNRSBqdGhvbWFzIGNvbW1lbnRpbmcgdGlsbCB3ZSBmaW5k\nIGhvdyBvcmRlcmluZyBjYW4gYmUgZG9uZQ0KICAgICAgICAvL3Euc2V0T3Jk\nZXJpbmcoImludEZpZWxkIGFzY2VuZGluZyIpOw0KICAgICAgICBxLnNldFJh\nbmdlKDEsIDMpOw0KICAgICAgICBxLmdldEZldGNoUGxhbigpLnNldEZldGNo\nU2l6ZSgwKTsNCiAgICAgICAgcS5nZXRGZXRjaFBsYW4oKS5hZGRHcm91cCgi\ncmVsIik7DQoNCiAgICAgICAgLy8gaWYgd2Ugb25seSBhY2Nlc3MgdGhlIHJl\nbCBmaWVsZCwgd2Ugc2hvdWxkIG9ubHkgaGF2ZSB1c2VkIG9uZQ0KICAgICAg\nICAvLyBzZWxlY3Q7IHRoZXJlIHdvbid0IGJlIGEgc2l6ZSBzZWxlY3Qgc2lu\nY2UgdGhlIHJhbmdlIHdpbGwgYmUNCiAgICAgICAgLy8gZ3JlZWRpbHkgY29u\nc3VtZWQgYXMgaXQncyBzbyBzbWFsbA0KICAgICAgICBMaXN0IGxpc3QgPSAo\nTGlzdCkgcS5leGVjdXRlKCk7DQogICAgICAgIGFzc2VydEVxdWFscygyLCBs\naXN0LnNpemUoKSk7DQogICAgICAgIGFzc2VydFJlbChsaXN0LCAyKTsNCiAg\nICAgICAgYXNzZXJ0RXF1YWxzKHNxbC50b1N0cmluZygpLCAxLCBzcWwuc2l6\nZSgpKTsNCiAgICAgICAgYXNzZXJ0VHJ1ZSgoU3RyaW5nKSBzcWwuZ2V0KDAp\nLA0KICAgICAgICAgICAgbWF0Y2hlcygiID49ICIsIChTdHJpbmcpIHNxbC5n\nZXQoMCkpKTsNCiAgICAgICAgc3FsLmNsZWFyKCk7DQoNCiAgICAgICAgLy8g\nbm93IGFjY2Vzc2luZyB0aGUgcmVscyBjb2xsZWN0aW9uIHNob3VsZCBhZGQg\nc2VsZWN0cw0KICAgICAgICBhc3NlcnRSZWxzKGxpc3QsIDIpOw0KICAgICAg\nICBhc3NlcnRFcXVhbHMoc3FsLnRvU3RyaW5nKCksIDIsIHNxbC5zaXplKCkp\nOw0KICAgICAgICBzcWwuY2xlYXIoKTsNCg0KICAgICAgICAvLyBub3cgZXhl\nY3V0ZSB3aXRoIGEgYmlnIHJhbmdlIGFuZCBzbWFsbCBmZXRjaCBzaXplIGFu\nZCBiaWdnZXIgcmFuZ2UNCiAgICAgICAgLy8gYW5kIHRoaXMgdGltZSB3ZSBz\naG91bGQgZ2V0IGEgc2VsZWN0IGZvciB0aGUgc2l6ZSB0b28NCiAgICAgICAg\ncS5nZXRGZXRjaFBsYW4oKS5zZXRGZXRjaFNpemUoMik7DQogICAgICAgIHEu\nc2V0UmFuZ2UoMSwgNCk7DQogICAgICAgIGxpc3QgPSAoTGlzdCkgcS5leGVj\ndXRlKCk7DQogICAgICAgIGFzc2VydEVxdWFscygzLCBsaXN0LnNpemUoKSk7\nDQogICAgICAgIC8vIHNvIHdlIGRvbid0IGhhdmUgdG8gcmUtZXhlY3V0ZSB0\nbyBtb3ZlIGJhY2sgdG8gYmVnaW5uaW5nDQogICAgICAgIGxpc3QgPSBuZXcg\nQXJyYXlMaXN0KGxpc3QpOw0KICAgICAgICBhc3NlcnRSZWwobGlzdCwgMyk7\nDQogICAgICAgIGFzc2VydEVxdWFscyhzcWwudG9TdHJpbmcoKSwgMiwgc3Fs\nLnNpemUoKSk7DQogICAgICAgIGFzc2VydFRydWUoKFN0cmluZykgc3FsLmdl\ndCgwKSwNCiAgICAgICAgICAgIG1hdGNoZXMoIiA+PSAiLCAoU3RyaW5nKSBz\ncWwuZ2V0KDApKSk7DQogICAgICAgIGFzc2VydFRydWUoKFN0cmluZykgc3Fs\nLmdldCgxKSwNCiAgICAgICAgICAgIG1hdGNoZXMoIiBDT1VOVCIsIChTdHJp\nbmcpIHNxbC5nZXQoMSkpKTsNCiAgICAgICAgc3FsLmNsZWFyKCk7DQoNCiAg\nICAgICAgZW0uY2xvc2UoKTsNCiAgICB9DQovKg0KICAgIHB1YmxpYyB2b2lk\nIHRlc3RQYWdpbmdSYW5nZVF1ZXJ5KCkNCiAgICAgICAgdGhyb3dzIEV4Y2Vw\ndGlvbiB7DQogICAgICAgIGluaXRpYWxpemVQYWdpbmdQQ3MoKTsNCg0KICAg\nICAgICBFbnRpdHlNYW5hZ2VyIGVtID1jdXJyZW50RW50aXR5TWFuYWdlcigp\nOw0KICAgICAgICBRdWVyeSBxID0gZW0ubmV3UXVlcnkoUGFnaW5nUEMuY2xh\nc3MsICJpbnRGaWVsZCA+PSAwIik7DQoNCiAgICAgICAgLy9GSVhNRSBqdGhv\nbWFzIGNvbW1lbnRpbmcgdGlsbCB3ZSBmaW5kIGhvdyBvcmRlcmluZyBjYW4g\nYmUgZG9uZQ0KICAgICAgICAvL3Euc2V0T3JkZXJpbmcoImludEZpZWxkIGFz\nY2VuZGluZyIpOw0KICAgICAgICBxLnNldFJhbmdlKDEsIDMpOw0KICAgICAg\nICBxLmdldEZldGNoUGxhbigpLnNldEZldGNoU2l6ZSgwKTsNCiAgICAgICAg\ncS5nZXRGZXRjaFBsYW4oKS5hZGRHcm91cCgicmVsIik7DQogICAgICAgIHEu\nZ2V0RmV0Y2hQbGFuKCkuYWRkR3JvdXAoInJlbHMiKTsNCg0KICAgICAgICAv\nLyBleHBlY3QgdHdvIHNlbGVjdHM6IHRoZSBwcmltYXJ5IHNlbGVjdCBhbmQg\ndGhlIElOIHNlbGVjdDsgbm8gc2l6ZQ0KICAgICAgICAvLyBzZWxlY3QgZXhw\nZWN0ZWQgYmVjYXVzZSB0aGUgcmFuZ2Ugd2lsbCBiZSBjb25zdW1lZCBncmVl\nZGlseSBzaW5jZQ0KICAgICAgICAvLyBpdCdzIHNvIHNtYWxsDQogICAgICAg\nIExpc3QgbGlzdCA9IChMaXN0KSBxLmV4ZWN1dGUoKTsNCiAgICAgICAgYXNz\nZXJ0RXF1YWxzKDIsIGxpc3Quc2l6ZSgpKTsNCiAgICAgICAgYXNzZXJ0UmVs\nKGxpc3QsIDIpOw0KICAgICAgICBhc3NlcnRSZWxzKGxpc3QsIDIpOw0KICAg\nICAgICBhc3NlcnRFcXVhbHMoc3FsLnRvU3RyaW5nKCksIDIsIHNxbC5zaXpl\nKCkpOw0KICAgICAgICBhc3NlcnRUcnVlKChTdHJpbmcpIHNxbC5nZXQoMCks\nDQogICAgICAgICAgICBtYXRjaGVzKCIgPj0gIiwgKFN0cmluZykgc3FsLmdl\ndCgwKSkpOw0KICAgICAgICBhc3NlcnRUcnVlKHNxbCArICIiLA0KICAgICAg\nICAgICAgbWF0Y2hlcygiIElOICIsIChTdHJpbmcpIHNxbC5nZXQoMSkpKTsN\nCiAgICAgICAgc3FsLmNsZWFyKCk7DQoNCiAgICAgICAgLy8gbm93IGV4ZWN1\ndGUgd2l0aCBhIGJpZyByYW5nZSBhbmQgc21hbGwgZmV0Y2ggc2l6ZSBhbmQg\nYmlnZ2VyIHJhbmdlDQogICAgICAgIC8vIGFuZCB0aGlzIHRpbWUgd2Ugc2hv\ndWxkIGdldCBhIHNlbGVjdCBmb3IgdGhlIHNpemUgdG9vDQogICAgICAgIHEu\nZ2V0RmV0Y2hQbGFuKCkuc2V0RmV0Y2hTaXplKDIpOw0KICAgICAgICBxLnNl\ndFJhbmdlKDEsIDQpOw0KICAgICAgICBsaXN0ID0gKExpc3QpIHEuZXhlY3V0\nZSgpOw0KICAgICAgICBhc3NlcnRFcXVhbHMoMywgbGlzdC5zaXplKCkpOw0K\nICAgICAgICAvLyBzbyB3ZSBkb24ndCBoYXZlIHRvIHJlLWV4ZWN1dGUgdG8g\nbW92ZSBiYWNrIHRvIGJlZ2lubmluZw0KICAgICAgICBsaXN0ID0gbmV3IEFy\ncmF5TGlzdChsaXN0KTsNCiAgICAgICAgYXNzZXJ0UmVsKGxpc3QsIDMpOw0K\nICAgICAgICBhc3NlcnRSZWxzKGxpc3QsIDMpOw0KICAgICAgICBhc3NlcnRF\ncXVhbHMoc3FsLnRvU3RyaW5nKCksIDQsIHNxbC5zaXplKCkpOw0KICAgICAg\nICBhc3NlcnRUcnVlKChTdHJpbmcpIHNxbC5nZXQoMCksDQogICAgICAgICAg\nICBtYXRjaGVzKCIgPj0gIiwgKFN0cmluZykgc3FsLmdldCgwKSkpOw0KICAg\nICAgICBhc3NlcnRUcnVlKChTdHJpbmcpIHNxbC5nZXQoMSksDQogICAgICAg\nICAgICBtYXRjaGVzKCIgQ09VTlQiLCAoU3RyaW5nKSBzcWwuZ2V0KDEpKSk7\nDQogICAgICAgIGFzc2VydFRydWUoKFN0cmluZykgc3FsLmdldCgyKSwNCiAg\nICAgICAgICAgIG1hdGNoZXMoIiBJTiAiLCAoU3RyaW5nKSBzcWwuZ2V0KDIp\nKSk7DQogICAgICAgIGFzc2VydEZhbHNlKChTdHJpbmcpIHNxbC5nZXQoMyks\nDQogICAgICAgICAgICBtYXRjaGVzKCIgSU4gIiwgKFN0cmluZykgc3FsLmdl\ndCgzKSkpOw0KICAgICAgICBzcWwuY2xlYXIoKTsNCg0KICAgICAgICBlbS5j\nbG9zZSgpOw0KICAgIH0NCiovDQogICAgcHJpdmF0ZSB2b2lkIGluaXRpYWxp\nemVQYWdpbmdQQ3MoKSB7DQogICAgICAgIEVudGl0eU1hbmFnZXIgZW0gPWN1\ncnJlbnRFbnRpdHlNYW5hZ2VyKCk7DQogICAgICAgIHN0YXJ0VHgoZW0pOw0K\nDQogICAgICAgZGVsZXRlQWxsKFBhZ2luZ1BDLmNsYXNzLGVtKTsNCiAgICAg\nICBkZWxldGVBbGwoUGFnaW5nSGVscGVyUEMuY2xhc3MsZW0pOw0KDQogICAg\nICAgIGVuZFR4KGVtKTsNCg0KICAgICAgICBzdGFydFR4KGVtKTsNCiAgICAg\nICAgUGFnaW5nUEMgcGM7DQogICAgICAgIFBhZ2luZ0hlbHBlclBDIHJlbDsN\nCiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCA0OyBpKyspIHsNCiAgICAg\nICAgICAgIHBjID0gbmV3IFBhZ2luZ1BDKCk7DQogICAgICAgICAgICBwYy5z\nZXRJbnRGaWVsZChpKTsNCiAgICAgICAgICAgIHJlbCA9IG5ldyBQYWdpbmdI\nZWxwZXJQQygpOw0KICAgICAgICAgICAgcmVsLnNldEludEZpZWxkKGkgKyAx\nKTsNCiAgICAgICAgICAgIHBjLnNldFJlbChyZWwpOw0KICAgICAgICAgICAg\ncGMuZ2V0UmVscygpLmFkZChyZWwpOw0KICAgICAgICAgICAgcmVsID0gbmV3\nIFBhZ2luZ0hlbHBlclBDKCk7DQogICAgICAgICAgICByZWwuc2V0SW50Rmll\nbGQoaSArIDIpOw0KICAgICAgICAgICAgcGMuZ2V0UmVscygpLmFkZChyZWwp\nOw0KICAgICAgICAgICAgZW0ucGVyc2lzdChwYyk7DQogICAgICAgIH0NCg0K\nICAgICAgICBlbmRUeChlbSk7DQogICAgICAgIGVtLmNsb3NlKCk7DQogICAg\nICAgIHNxbC5jbGVhcigpOw0KICAgIH0NCg0KICAgIHByaXZhdGUgdm9pZCBp\nbml0aWFsaXplUGFnaW5nQXBwSWRQQ3MoKSB7DQogICAgICAgIEVudGl0eU1h\nbmFnZXIgZW0gPWN1cnJlbnRFbnRpdHlNYW5hZ2VyKCk7DQogICAgICAgIHN0\nYXJ0VHgoZW0pOw0KICAgICAgIGRlbGV0ZUFsbChQYWdpbmdBcHBJZFBDLmNs\nYXNzLGVtKTsNCiAgICAgICBkZWxldGVBbGwoUGFnaW5nSGVscGVyUEMuY2xh\nc3MsZW0pOw0KICAgICAgICBzdGFydFR4KGVtKTsNCg0KICAgICAgICBzdGFy\ndFR4KGVtKTsNCiAgICAgICAgUGFnaW5nQXBwSWRQQyBwYzsNCiAgICAgICAg\nUGFnaW5nSGVscGVyUEMgcmVsOw0KICAgICAgICBmb3IgKGludCBpID0gMDsg\naSA8IDQ7IGkrKykgew0KICAgICAgICAgICAgcGMgPSBuZXcgUGFnaW5nQXBw\nSWRQQygpOw0KICAgICAgICAgICAgcGMuc2V0SW50RmllbGQoaSk7DQogICAg\nICAgICAgICBwYy5zZXRMb25nRmllbGQoaSArIDEwMCk7DQogICAgICAgICAg\nICByZWwgPSBuZXcgUGFnaW5nSGVscGVyUEMoKTsNCiAgICAgICAgICAgIHJl\nbC5zZXRJbnRGaWVsZChpICsgMSk7DQogICAgICAgICAgICBwYy5zZXRSZWwo\ncmVsKTsNCiAgICAgICAgICAgIHBjLmdldFJlbHMoKS5hZGQocmVsKTsNCiAg\nICAgICAgICAgIHJlbCA9IG5ldyBQYWdpbmdIZWxwZXJQQygpOw0KICAgICAg\nICAgICAgcmVsLnNldEludEZpZWxkKGkgKyAyKTsNCiAgICAgICAgICAgIHBj\nLmdldFJlbHMoKS5hZGQocmVsKTsNCiAgICAgICAgICAgIGVtLnBlcnNpc3Qo\ncGMpOw0KICAgICAgICB9DQoNCiAgICAgICAgZW5kVHgoZW0pOw0KICAgICAJ\nZW0uY2xvc2UoKTsNCiAgICAgICAgc3FsLmNsZWFyICgpOw0KCX0NCg0KCXBy\naXZhdGUgTWFwIGdldFByb3BzKCkgew0KCQlNYXAgcHJvcHM9bmV3IEhhc2hN\nYXAoKTsNCgkJcHJvcHMucHV0KCJvcGVuanBhLkRhdGFDYWNoZSIsICJ0cnVl\nIik7DQoJCXByb3BzLnB1dCgib3BlbmpwYS5SZW1vdGVDb21taXRQcm92aWRl\nciIsICJzanZtIik7DQoJCXByb3BzLnB1dCgib3BlbmpwYS5GbHVzaEJlZm9y\nZVF1ZXJpZXMiLCAidHJ1ZSIpOw0KCQlwcm9wcy5wdXQoImphdmF4Lmpkby5v\ncHRpb24uSWdub3JlQ2FjaGUiLCAiZmFsc2UiKTsNCgkJLy9wcm9wc01hcC5w\ndXQoIm9wZW5qcGEuQnJva2VySW1wbCIsICJrb2RvLmRhdGFjYWNoZS5DYWNo\nZVRlc3RCcm9rZXIiKTsvL0NhY2hlVGVzdEJyb2tlci5jbGFzcy5nZXROYW1l\nICgpKTsNCgkJcmV0dXJuIHByb3BzOw0KCX0NCg0KDQp9DQo=\n","encoding":"base64"}

