{"sha":"dcb726263df8881f37b43bcf1035c316934b2277","node_id":"MDQ6QmxvYjIwNjM2NDpkY2I3MjYyNjNkZjg4ODFmMzdiNDNiY2YxMDM1YzMxNjkzNGIyMjc3","size":6765,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/dcb726263df8881f37b43bcf1035c316934b2277","content":"LyoNCiAqIFRlc3RDbGFzc1NlcXVlbmNlRmFjdG9yeS5qYXZhDQogKg0KICog\nQ3JlYXRlZCBvbiBPY3RvYmVyIDYsIDIwMDYsIDEyOjIxIFBNDQogKg0KICog\nVG8gY2hhbmdlIHRoaXMgdGVtcGxhdGUsIGNob29zZSBUb29scyB8IFRlbXBs\nYXRlIE1hbmFnZXINCiAqIGFuZCBvcGVuIHRoZSB0ZW1wbGF0ZSBpbiB0aGUg\nZWRpdG9yLg0KICovDQoNCi8qDQogKiBMaWNlbnNlZCB0byB0aGUgQXBhY2hl\nIFNvZnR3YXJlIEZvdW5kYXRpb24gKEFTRikgdW5kZXIgb25lDQogKiBvciBt\nb3JlIGNvbnRyaWJ1dG9yIGxpY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUg\nTk9USUNFIGZpbGUNCiAqIGRpc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZv\nciBhZGRpdGlvbmFsIGluZm9ybWF0aW9uDQogKiByZWdhcmRpbmcgY29weXJp\nZ2h0IG93bmVyc2hpcC4gIFRoZSBBU0YgbGljZW5zZXMgdGhpcyBmaWxlDQog\nKiB0byB5b3UgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIu\nMCAodGhlDQogKiAiTGljZW5zZSIpOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBm\naWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlDQogKiB3aXRoIHRoZSBMaWNlbnNl\nLiAgWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0DQog\nKg0KICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0Ut\nMi4wDQogKg0KICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3\nIG9yIGFncmVlZCB0byBpbiB3cml0aW5nLA0KICogc29mdHdhcmUgZGlzdHJp\nYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4N\nCiAqICJBUyBJUyIgQkFTSVMsIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05E\nSVRJT05TIE9GIEFOWQ0KICogS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1w\nbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlDQogKiBzcGVjaWZpYyBs\nYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kIGxpbWl0YXRpb25z\nDQogKiB1bmRlciB0aGUgTGljZW5zZS4gICAgDQogKi8NCnBhY2thZ2Ugb3Jn\nLmFwYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNlLmpkYmMuc2NoZW1hOw0KDQpp\nbXBvcnQgamF2YS5zcWwuQ29ubmVjdGlvbjsNCmltcG9ydCBqYXZhLnNxbC5T\nUUxFeGNlcHRpb247DQppbXBvcnQgamF2YS5zcWwuU3RhdGVtZW50Ow0KaW1w\nb3J0IGphdmEudXRpbC4qOw0KaW1wb3J0IGphdmF4LnNxbC5EYXRhU291cmNl\nOw0KaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLmNvbmYuSkRCQ0Nv\nbmZpZ3VyYXRpb247DQppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMu\nY29uZi5KREJDQ29uZmlndXJhdGlvbkltcGw7DQppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLmpkYmMua2VybmVsLkNsYXNzVGFibGVKREJDU2VxOw0KaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLm1ldGEuQ2xhc3NNYXBwaW5n\nOw0KaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuQnJva2VyOw0K\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuU2VxOw0KaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5saWIuY29uZi5Db25maWd1cmF0aW9uUHJv\ndmlkZXI7DQppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi5jb25mLkNv\nbmZpZ3VyYXRpb25zOw0KDQppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnBl\ncnNpc3RlbmNlLmpkYmMuY29tbW9uLmFwcHMuKjsNCg0KDQppbXBvcnQgamF2\nYS5sYW5nLmFubm90YXRpb24uQW5ub3RhdGlvbjsNCmltcG9ydCBqdW5pdC5m\ncmFtZXdvcmsuKjsNCmltcG9ydCBqYXZheC5wZXJzaXN0ZW5jZS5FbnRpdHlN\nYW5hZ2VyOw0KaW1wb3J0IGphdmF4LnBlcnNpc3RlbmNlLkVudGl0eU1hbmFn\nZXJGYWN0b3J5Ow0KaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0\nZW5jZS5PcGVuSlBBRW50aXR5TWFuYWdlckZhY3Rvcnk7DQppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNlLk9wZW5KUEFFbnRpdHlNYW5h\nZ2VyOw0KaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5q\nZGJjLmtlcm5lbC5CYXNlSkRCQ1Rlc3Q7DQoNCg0KcHVibGljIGNsYXNzIFRl\nc3RDbGFzc1NlcXVlbmNlRmFjdG9yeSBleHRlbmRzIEJhc2VKREJDVGVzdHsN\nCiAgICANCg0KICAgIHByaXZhdGUgc3RhdGljIE1hcCBfc3lzcHJvcHMgPSBu\nZXcgSGFzaE1hcCgpOw0KICAgIA0KICAgIEJyb2tlciBfYnJva2VyOw0KICAg\nIA0KICAgIC8qKiBDcmVhdGVzIGEgbmV3IGluc3RhbmNlIG9mIFRlc3RDbGFz\nc1NlcXVlbmNlRmFjdG9yeSAqLw0KICAgIHB1YmxpYyBUZXN0Q2xhc3NTZXF1\nZW5jZUZhY3RvcnkoKSB7DQogICAgfQ0KICAgIHB1YmxpYyBUZXN0Q2xhc3NT\nZXF1ZW5jZUZhY3RvcnkoU3RyaW5nIHRlc3QpIHsNCiAgICAgICAgc3VwZXIo\ndGVzdCk7DQogICAgfQ0KICAgIA0KICAgIHB1YmxpYyB2b2lkIHNldFVwKCkN\nCiAgICB0aHJvd3MgRXhjZXB0aW9uIHsNCiAgICAgICAgSkRCQ0NvbmZpZ3Vy\nYXRpb24gY29uZiA9IG5ldyBKREJDQ29uZmlndXJhdGlvbkltcGwoKTsNCiAg\nICAgICAgY29uZi5mcm9tUHJvcGVydGllcyhnZXRQcm9wZXJ0aWVzKCkpOw0K\nICAgICAgICBpZiAoIWFkanVzdENvbmZpZ3VyYXRpb24oY29uZikpDQogICAg\nICAgICAgICByZXR1cm47DQogICAgICAgIA0KICAgICAgICBTdHJpbmcgZHJp\ndmVyID0gY29uZi5nZXRDb25uZWN0aW9uRHJpdmVyTmFtZSgpLnRvTG93ZXJD\nYXNlKCk7DQogICAgICAgIFN0cmluZyBbXSBzcWwgPSBudWxsOw0KICAgICAg\nICANCiAgICAgICAgaWYgKGRyaXZlci5pbmRleE9mKCJvcmFjbGUiKSA+PSAw\nKSB7DQogICAgICAgICAgICBzcWwgPSBuZXcgU3RyaW5nIFtdew0KICAgICAg\nICAgICAgICAgICJjcmVhdGUgc2VxdWVuY2Ugc2VxYV9zZXEiLA0KICAgICAg\nICAgICAgICAgICJjcmVhdGUgc2VxdWVuY2Ugc2VxYl9zZXEiDQogICAgICAg\nICAgICB9Ow0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICBpZiAoc3Fs\nID09IG51bGwpDQogICAgICAgICAgICByZXR1cm47DQogICAgICAgIA0KICAg\nICAgICBEYXRhU291cmNlIGRzID0gY29uZi5nZXREYXRhU291cmNlMihudWxs\nKTsNCiAgICAgICAgQ29ubmVjdGlvbiBjID0gZHMuZ2V0Q29ubmVjdGlvbigp\nOw0KICAgICAgICBTdGF0ZW1lbnQgcyA9IG51bGw7DQogICAgICAgIHRyeSB7\nDQogICAgICAgICAgICBzID0gYy5jcmVhdGVTdGF0ZW1lbnQoKTsNCiAgICAg\nICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgc3FsLmxlbmd0aDsgaSsrKSB7\nDQogICAgICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgICAgICAg\ncy5leGVjdXRlKHNxbFtpXSk7DQogICAgICAgICAgICAgICAgfSBjYXRjaCAo\nU1FMRXhjZXB0aW9uIHNxZSkgew0KICAgICAgICAgICAgICAgIH0NCiAgICAg\nICAgICAgIH0NCiAgICAgICAgfSBmaW5hbGx5IHsNCiAgICAgICAgICAgIGlm\nIChzICE9IG51bGwpDQogICAgICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAg\nICAgICAgICAgICAgcy5jbG9zZSgpOw0KICAgICAgICAgICAgICAgIH0gY2F0\nY2ggKEV4Y2VwdGlvbiBlKSB7DQogICAgICAgICAgICAgICAgfQ0KICAgICAg\nICB9DQogICAgICAgIA0KICAgICAgICBfYnJva2VyID0gZ2V0QnJva2VyRmFj\ndG9yeSgpLm5ld0Jyb2tlcigpOw0KICAgIH0NCiAgICANCiAgICAvKioNCiAg\nICAgKiBUZXN0cyB0aGF0IGFsbCBzZXF1ZW5jZSBudW1iZXJzIGFyZSB1bmlx\ndWUgYW5kIGluIG9yZGVyLg0KICAgICAqLw0KICAgIHB1YmxpYyB2b2lkIHRl\nc3RTZXF1ZW5jZSgpDQogICAgdGhyb3dzIEV4Y2VwdGlvbiB7DQogICAgICAg\nIFNldCBzZXQgPSBuZXcgSGFzaFNldCgpOw0KICAgICAgICANCiAgICAgICAg\nSkRCQ0NvbmZpZ3VyYXRpb24gY29uZiA9IG5ldyBKREJDQ29uZmlndXJhdGlv\nbkltcGwoKTsNCiAgICAgICAgY29uZi5mcm9tUHJvcGVydGllcyhnZXRQcm9w\nZXJ0aWVzKCkpOw0KICAgICAgICBpZiAoIWFkanVzdENvbmZpZ3VyYXRpb24o\nY29uZikpDQogICAgICAgICAgICByZXR1cm47DQogICAgICAgIFRocmVhZCB0\nMSA9IG5ldyBVcGRhdGVUaHJlYWQoc2V0LCBjb25mKTsNCiAgICAgICAgVGhy\nZWFkIHQyID0gbmV3IFVwZGF0ZVRocmVhZChzZXQsIGNvbmYpOw0KICAgICAg\nICANCiAgICAgICAgdDEuc3RhcnQoKTsNCiAgICAgICAgdDIuc3RhcnQoKTsN\nCiAgICAgICAgdDEuam9pbigpOw0KICAgICAgICB0Mi5qb2luKCk7DQogICAg\nICAgIA0KICAgICAgICBhc3NlcnRFcXVhbHMoMTAyLCBzZXQuc2l6ZSgpKTsN\nCiAgICB9DQogICAgDQogICAgcHVibGljIHZvaWQgdGVzdEV4dGVuc2lvbnMo\nKQ0KICAgIHRocm93cyBFeGNlcHRpb24gew0KICAgICAgICBKREJDQ29uZmln\ndXJhdGlvbiBjb25mID0gbmV3IEpEQkNDb25maWd1cmF0aW9uSW1wbCgpOw0K\nICAgICAgICBjb25mLmZyb21Qcm9wZXJ0aWVzKGdldFByb3BlcnRpZXMoKSk7\nDQogICAgICAgIGlmICghYWRqdXN0Q29uZmlndXJhdGlvbihjb25mKSkNCiAg\nICAgICAgICAgIHJldHVybjsNCiAgICAgICAgDQogICAgICAgIENsYXNzTWFw\ncGluZyBhTWFwcGluZyA9IGNvbmYuZ2V0TWFwcGluZ1JlcG9zaXRvcnlJbnN0\nYW5jZSgpLg0KICAgICAgICAgICAgICAgIGdldE1hcHBpbmcoU2VxQS5jbGFz\ncywgbnVsbCwgdHJ1ZSk7DQogICAgICAgIENsYXNzTWFwcGluZyBiTWFwcGlu\nZyA9IGNvbmYuZ2V0TWFwcGluZ1JlcG9zaXRvcnlJbnN0YW5jZSgpLg0KICAg\nICAgICAgICAgICAgIGdldE1hcHBpbmcoU2VxQi5jbGFzcywgbnVsbCwgdHJ1\nZSk7DQogICAgICAgIENsYXNzTWFwcGluZyBjTWFwcGluZyA9IGNvbmYuZ2V0\nTWFwcGluZ1JlcG9zaXRvcnlJbnN0YW5jZSgpLg0KICAgICAgICAgICAgICAg\nIGdldE1hcHBpbmcoU2VxQy5jbGFzcywgbnVsbCwgdHJ1ZSk7DQogICAgICAg\nIERhdGFTb3VyY2UgZHMgPSBjb25mLmdldERhdGFTb3VyY2UyKG51bGwpOw0K\nICAgICAgICANCiAgICAgICAgLy8gaG9sZCBhIGFuZCBjIGFuZCBzdGFydCBi\nDQogICAgICAgIA0KICAgICAgICBTZXEgc2VxID0gY29uZi5nZXRTZXF1ZW5j\nZUluc3RhbmNlKCk7DQogICAgICAgIGxvbmcgYWlkID0gKChMb25nKSBzZXEu\nbmV4dChfYnJva2VyLCBhTWFwcGluZykpLmxvbmdWYWx1ZSgpOw0KICAgICAg\nICBmb3IgKGludCBpID0gMDsgaSA8IDU7IGkrKykNCiAgICAgICAgICAgIHNl\ncS5uZXh0KF9icm9rZXIsIGJNYXBwaW5nKTsNCiAgICAgICAgDQogICAgICAg\nIGFzc2VydEVxdWFscyhuZXcgTG9uZyhhaWQgKyAxKSwgc2VxLm5leHQoX2Jy\nb2tlciwgYU1hcHBpbmcpKTsNCiAgICAgICAgYXNzZXJ0RXF1YWxzKG5ldyBM\nb25nKGFpZCArIDIpLCBzZXEubmV4dChfYnJva2VyLCBjTWFwcGluZykpOw0K\nICAgIH0NCiAgICANCiAgICAvKioNCiAgICAgKiBQYXNzIGluIGEgbXV0YWJs\nZSBjb25maWd1cmF0aW9uDQogICAgICogPHAvPg0KICAgICAqIHJldHVybiB0\ncnVlIGlmIHVzZWFibGUuDQogICAgICovDQogICAgcHJpdmF0ZSBib29sZWFu\nIGFkanVzdENvbmZpZ3VyYXRpb24oSkRCQ0NvbmZpZ3VyYXRpb24gY29uZikg\new0KICAgICAgICBTdHJpbmcgZHJpdmVyID0gY29uZi5nZXRDb25uZWN0aW9u\nRHJpdmVyTmFtZSgpOw0KICAgICAgICBpZiAoZHJpdmVyID09IG51bGwpDQog\nICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgIGRyaXZlciA9IGRy\naXZlci50b0xvd2VyQ2FzZSgpOw0KICAgICAgICBpZiAoZHJpdmVyLmluZGV4\nT2YoIm9yYWNsZSIpID49IDApIHsNCiAgICAgICAgICAgIGNvbmYuc2V0U2Vx\ndWVuY2UoQ2xhc3NUYWJsZUpEQkNTZXEuY2xhc3MuZ2V0TmFtZSgpKTsNCiAg\nICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICB9DQogICAgICAgIA0K\nICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgfQ0KICAgIA0KICAgIHB1Ymxp\nYyBzdGF0aWMgdm9pZCBtYWluKFN0cmluZ1tdIGFyZ3MpIHsNCi8vICAgICAg\nICBtYWluKCk7DQogICAgfQ0KICAgIA0KICAgIA0KICAgIHByaXZhdGUgY2xh\nc3MgVXBkYXRlVGhyZWFkDQogICAgICAgICAgICBleHRlbmRzIFRocmVhZCB7\nDQogICAgICAgIA0KICAgICAgICBwcml2YXRlIEpEQkNDb25maWd1cmF0aW9u\nIF9jb25mOw0KICAgICAgICBwcml2YXRlIFNldCBfc2V0ID0gbnVsbDsNCiAg\nICAgICAgDQogICAgICAgIHB1YmxpYyBVcGRhdGVUaHJlYWQoU2V0IHNldCwg\nSkRCQ0NvbmZpZ3VyYXRpb24gY29uZikgew0KICAgICAgICAgICAgX3NldCA9\nIHNldDsNCiAgICAgICAgICAgIF9jb25mID0gY29uZjsNCiAgICAgICAgfQ0K\nICAgICAgICANCiAgICAgICAgcHVibGljIHZvaWQgcnVuKCkgew0KICAgICAg\nICAgICAgRGF0YVNvdXJjZSBkcyA9IF9jb25mLmdldERhdGFTb3VyY2UyKG51\nbGwpOw0KICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgICBTZXEg\nc2VxID0gX2NvbmYuZ2V0U2VxdWVuY2VJbnN0YW5jZSgpOw0KICAgICAgICAg\nICAgICAgIENsYXNzTWFwcGluZyBtYXBwaW5nID0gX2NvbmYuZ2V0TWFwcGlu\nZ1JlcG9zaXRvcnlJbnN0YW5jZSgpLg0KICAgICAgICAgICAgICAgICAgICAg\nICAgZ2V0TWFwcGluZyhTZXFBLmNsYXNzLCBudWxsLCB0cnVlKTsNCiAgICAg\nICAgICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IDUxOyBpKyspDQogICAg\nICAgICAgICAgICAgICAgIF9zZXQuYWRkKHNlcS5uZXh0KF9icm9rZXIsIG1h\ncHBpbmcpKTsNCiAgICAgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7\nDQogICAgICAgICAgICAgICAgdGhyb3cgbmV3IFJ1bnRpbWVFeGNlcHRpb24o\nZS5nZXRNZXNzYWdlKCkpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQog\nICAgfQ0KICAgIA0KfQ0K\n","encoding":"base64"}

