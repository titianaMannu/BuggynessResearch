{"sha":"e24fa40819f6809ff6109b0ee6b907eceaadccf5","node_id":"MDQ6QmxvYjIwNjM2NDplMjRmYTQwODE5ZjY4MDlmZjYxMDliMGVlNmI5MDdlY2VhYWRjY2Y1","size":14740,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/e24fa40819f6809ff6109b0ee6b907eceaadccf5","content":"LyoNCiAqIFRlc3RPcGVuSlBBRW50aXR5TWFuYWdlci5qYXZhDQogKg0KICog\nQ3JlYXRlZCBvbiBPY3RvYmVyIDEyLCAyMDA2LCA0OjQwIFBNDQogKg0KICog\nVG8gY2hhbmdlIHRoaXMgdGVtcGxhdGUsIGNob29zZSBUb29scyB8IFRlbXBs\nYXRlIE1hbmFnZXINCiAqIGFuZCBvcGVuIHRoZSB0ZW1wbGF0ZSBpbiB0aGUg\nZWRpdG9yLg0KICovDQovKg0KICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBT\nb2Z0d2FyZSBGb3VuZGF0aW9uIChBU0YpIHVuZGVyIG9uZQ0KICogb3IgbW9y\nZSBjb250cmlidXRvciBsaWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5P\nVElDRSBmaWxlDQogKiBkaXN0cmlidXRlZCB3aXRoIHRoaXMgd29yayBmb3Ig\nYWRkaXRpb25hbCBpbmZvcm1hdGlvbg0KICogcmVnYXJkaW5nIGNvcHlyaWdo\ndCBvd25lcnNoaXAuICBUaGUgQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQ0KICog\ndG8geW91IHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAg\nKHRoZQ0KICogIkxpY2Vuc2UiKTsgeW91IG1heSBub3QgdXNlIHRoaXMgZmls\nZSBleGNlcHQgaW4gY29tcGxpYW5jZQ0KICogd2l0aCB0aGUgTGljZW5zZS4g\nIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdA0KICoN\nCiAqIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIu\nMA0KICoNCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBv\nciBhZ3JlZWQgdG8gaW4gd3JpdGluZywNCiAqIHNvZnR3YXJlIGRpc3RyaWJ1\ndGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuDQog\nKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElU\nSU9OUyBPRiBBTlkNCiAqIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxp\nZWQuICBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZQ0KICogc3BlY2lmaWMgbGFu\nZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZCBsaW1pdGF0aW9ucw0K\nICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIA0KICovDQpwYWNrYWdlIG9yZy5h\ncGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5rZXJuZWw7DQoNCmltcG9ydCBq\nYXZhLmlvLkJ5dGVBcnJheUlucHV0U3RyZWFtOw0KaW1wb3J0IGphdmEuaW8u\nQnl0ZUFycmF5T3V0cHV0U3RyZWFtOw0KaW1wb3J0IGphdmEuaW8uT2JqZWN0\nSW5wdXRTdHJlYW07DQppbXBvcnQgamF2YS5pby5PYmplY3RPdXRwdXRTdHJl\nYW07DQppbXBvcnQgamF2YS51dGlsLkFycmF5TGlzdDsNCmltcG9ydCBqYXZh\nLnV0aWwuQ29sbGVjdGlvbjsNCmltcG9ydCBqYXZhLnV0aWwuSXRlcmF0b3I7\nDQppbXBvcnQgamF2YS51dGlsLkxpc3Q7DQppbXBvcnQgamF2YXgucGVyc2lz\ndGVuY2UuRW50aXR5TWFuYWdlckZhY3Rvcnk7DQppbXBvcnQgamF2YXgucGVy\nc2lzdGVuY2UuRW50aXR5Tm90Rm91bmRFeGNlcHRpb247DQoNCg0KDQppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNlLmtlcm5lbC5jb21t\nb24uYXBwcy5SdW50aW1lVGVzdDE7DQppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLnBlcnNpc3RlbmNlLmtlcm5lbC5jb21tb24uYXBwcy5SdW50aW1lVGVz\ndDI7DQppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNlLmtl\ncm5lbC5jb21tb24uYXBwcy5SdW50aW1lVGVzdDQ7DQppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLmtlcm5lbC5Ccm9rZXJGYWN0b3J5Ow0KaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuRGVsZWdhdGluZ0Jyb2tlckZhY3Rv\ncnk7DQppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5QQ1N0YXRl\nOw0KaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5FeHRl\nbnQ7DQppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNlLkpQ\nQUZhY2FkZUhlbHBlcjsNCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEucGVy\nc2lzdGVuY2UuT3BlbkpQQUVudGl0eU1hbmFnZXI7DQppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNlLk9wZW5KUEFFbnRpdHlNYW5hZ2Vy\nRmFjdG9yeTsNCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5JZDsN\nCg0KcHVibGljIGNsYXNzIFRlc3RQZXJzaXN0ZW5jZU1hbmFnZXIgZXh0ZW5k\ncyBCYXNlS2VybmVsVGVzdCB7DQoNCiAgICBwcml2YXRlIGludCBfaWQgPSAw\nOw0KICAgIHByaXZhdGUgaW50IF9pZDIgPSAwOw0KDQogICAgcHVibGljIFRl\nc3RQZXJzaXN0ZW5jZU1hbmFnZXIoU3RyaW5nIG5hbWUpIHsNCiAgICAgICAg\nc3VwZXIobmFtZSk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICogQ3JlYXRl\ncyBhIG5ldyBpbnN0YW5jZSBvZiBUZXN0T3BlbkpQQUVudGl0eU1hbmFnZXIN\nCiAgICAgKi8NCiAgICBwdWJsaWMgVGVzdFBlcnNpc3RlbmNlTWFuYWdlcigp\nIHsNCiAgICB9DQoNCiAgICBwdWJsaWMgdm9pZCBzZXRVcCgpIHRocm93cyBF\neGNlcHRpb24gew0KICAgICAgICBkZWxldGVBbGwoUnVudGltZVRlc3QxLmNs\nYXNzKTsNCiAgICAgICAgZGVsZXRlQWxsKFJ1bnRpbWVUZXN0Mi5jbGFzcyk7\nDQoNCiAgICAgICAgT3BlbkpQQUVudGl0eU1hbmFnZXIgcG0gPSBnZXRQTSgp\nOw0KICAgICAgICBzdGFydFR4KHBtKTsNCg0KICAgICAgICBSdW50aW1lVGVz\ndDEgYSA9IG5ldyBSdW50aW1lVGVzdDEoIlNUUklORyIsIDEwKTsNCiAgICAg\nICAgUnVudGltZVRlc3QyIGIgPSBuZXcgUnVudGltZVRlc3QyKCJTVFJJTkcy\nIiwgMTEpOw0KICAgICAgICBwbS5wZXJzaXN0KGEpOw0KICAgICAgICBwbS5w\nZXJzaXN0KGIpOw0KICAgICAgICBfaWQgPSBhLmdldEludEZpZWxkKCk7DQog\nICAgICAgIF9pZDIgPSBiLmdldEludEZpZWxkKCk7DQoNCiAgICAgICAgZW5k\nVHgocG0pOw0KICAgICAgICBlbmRFbShwbSk7DQogICAgfQ0KDQogICAgLyoq\nDQogICAgICogTm8tb3AgdGVzdCB0aGF0IGNhbiBiZSBydW4gaW4gbmFtZSB0\nbyBzZWUgaWYgdGhlIHNldHVwIGlzIHdvcmtpbmcNCiAgICAgKiBwcm9wZXJs\neS4NCiAgICAgKi8NCiAgICBwdWJsaWMgdm9pZCB0ZXN0U2V0dXAoKSB7DQog\nICAgfQ0KDQogICAgLyoqDQogICAgICogVGVzdHMgdGhhdCB0aGUgUE0gdGhy\nb3dzIEV4Y2VwdGlvbnMgb24gdXNhZ2UgYXR0ZW1wdHMgYWZ0ZXIgaXQgaGFz\nIGJlZW4NCiAgICAgKiBjbG9zZWQuDQogICAgICovDQogICAgcHVibGljIHZv\naWQgdGVzdENsb3NlZCgpIHsNCiAgICAgICAgT3BlbkpQQUVudGl0eU1hbmFn\nZXIgcG0gPSBnZXRQTSgpOw0KICAgICAgICBlbmRFbShwbSk7DQoNCiAgICAg\nICAgdHJ5IHsNCiAgICAgICAgICAgIC8vIHRoaXMgaXMgdGhlIG9ubHkgbWV0\naG9kIHRoYXQgc2hvdWxkIHN1Y2NlZWQNCiAgICAgICAgICAgIHBtLmlzT3Bl\nbigpOw0KICAgICAgICB9IGNhdGNoIChSdW50aW1lRXhjZXB0aW9uIHJlKSB7\nDQogICAgICAgICAgICBmYWlsKCJpc0Nsb3NlZCIpOw0KICAgICAgICB9DQog\nICAgICAgIHRyeSB7DQogICAgICAgICAgICBwbS5maW5kKFJ1bnRpbWVUZXN0\nMS5jbGFzcywgX2lkKTsNCiAgICAgICAgICAgIGZhaWwoImZpbmQiKTsNCiAg\nICAgICAgfSBjYXRjaCAoUnVudGltZUV4Y2VwdGlvbiByZSkgew0KICAgICAg\nICB9DQogICAgICAgIHRyeSB7DQogICAgICAgICAgICBwbS5wZXJzaXN0KG5l\ndyBSdW50aW1lVGVzdDEoMjApKTsNCiAgICAgICAgICAgIGZhaWwoInNldFVz\nZXJPYmplY3QiKTsNCiAgICAgICAgfSBjYXRjaCAoUnVudGltZUV4Y2VwdGlv\nbiByZSkgew0KICAgICAgICB9DQogICAgICAgIHRyeSB7DQogICAgICAgICAg\nICBwbS5zZXROb250cmFuc2FjdGlvbmFsUmVhZCh0cnVlKTsNCiAgICAgICAg\nICAgIGZhaWwoInNldE5vbnRyYW5zYWN0aW9uYWxSZWFkIik7DQogICAgICAg\nIH0gY2F0Y2ggKFJ1bnRpbWVFeGNlcHRpb24gcmUpIHsNCiAgICAgICAgfQ0K\nICAgICAgICB0cnkgew0KICAgICAgICAgICAgLy8gdGhpcyBtZXRob2Qgc2hv\ndWxkIGZhaWwNCiAgICAgICAgICAgIGVuZEVtKHBtKTsNCiAgICAgICAgICAg\nIGJ1Zyg2NSwgbnVsbCwgIm11bHRpcGxlIGNsb3NlIHNob3VsZCBub3QgYmUg\nYWxsb3dlZCIpOw0KICAgICAgICAgICAgZmFpbCgibXVsdGlwbGUgY2xvc2Ug\nc2hvdWxkIG5vdCBiZSBhbGxvd2VkIik7DQogICAgICAgIH0gY2F0Y2ggKEV4\nY2VwdGlvbiBqZG9lKSB7DQogICAgICAgICAgICAvLyBnb29kOiB3ZSBzaG91\nbGQgZ2V0IGFuIGV4Y2VwdGlvbg0KICAgICAgICB9DQogICAgfQ0KDQogICAg\ncHVibGljIHZvaWQgdGVzdE11bHRpcGxlQ2xvc2VUaHJlYWRlZCgpDQogICAg\nICAgIHRocm93cyBUaHJvd2FibGUgew0KICAgICAgICBmaW5hbCBPcGVuSlBB\nRW50aXR5TWFuYWdlciBwbSA9IGdldFBNKCk7DQogICAgICAgIGZpbmFsIExp\nc3QgcmVzdWx0ID0gbmV3IEFycmF5TGlzdCgpOw0KICAgICAgICBzdGFydFR4\nKHBtKTsNCg0KICAgICAgICBlbmRFbShwbSk7DQoNCiAgICAgICAgbmV3IFRo\ncmVhZCgpIHsNCiAgICAgICAgICAgIHB1YmxpYyB2b2lkIHJ1bigpIHsNCiAg\nICAgICAgICAgICAgICB0cnkgew0KICAgICAgICAgICAgICAgICAgICBlbmRF\nbShwbSk7DQogICAgICAgICAgICAgICAgICAgIHJlc3VsdC5hZGQobmV3IElu\ndGVnZXIoMCkpOw0KICAgICAgICAgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlv\nbiBqZG9lKSB7DQogICAgICAgICAgICAgICAgICAgIHJlc3VsdC5hZGQoamRv\nZSk7DQogICAgICAgICAgICAgICAgfSBjYXRjaCAoVGhyb3dhYmxlIHQpIHsN\nCiAgICAgICAgICAgICAgICAgICAgcmVzdWx0LmFkZCh0KTsNCiAgICAgICAg\nICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0uc3RhcnQoKTsN\nCg0KICAgICAgICB3aGlsZSAocmVzdWx0LnNpemUoKSA9PSAwKQ0KICAgICAg\nICAgICAgVGhyZWFkLmN1cnJlbnRUaHJlYWQoKS55aWVsZCgpOyAvLyB3YWl0\nIGZvciByZXN1bHRzDQogICAgICAgIE9iamVjdCByZXQgPSByZXN1bHQuZ2V0\nKDApOw0KDQogICAgICAgIGlmIChyZXQgaW5zdGFuY2VvZiBFeGNlcHRpb24p\nDQogICAgICAgICAgICByZXR1cm47IC8vIGdvb2QNCg0KICAgICAgICBpZiAo\ncmV0IGluc3RhbmNlb2YgVGhyb3dhYmxlKQ0KICAgICAgICAgICAgdGhyb3cg\nKFRocm93YWJsZSkgcmV0Ow0KDQogICAgICAgIGJ1Zyg2NSwgbnVsbCwNCiAg\nICAgICAgICAgICJtdWx0aXBsZSBjbG9zZSBpbiBkaWZmZXJlbnQgdGhyZWFk\ncyBzaG91bGQgbm90IGJlIGFsbG93ZWQiKTsNCiAgICB9DQoNCiAgICAvKioN\nCiAgICAgKiBUaGlzIG1ldGhvZCB0cmllcyB0byBwZXJmb3JtIG9wZXJhdGlv\nbnMgdGhhdCBzaG91bGQgbGVhZCB0bw0KICAgICAqIGlsbGVnYWwgc3RhdGVz\nLCBzdWNoIGFzIHBlcnNpc3RpbmcgaW5zdGFuY2VzIG91dHNpZGUgb2YgdHJh\nbnNhY3Rpb25zLA0KICAgICAqIGV0Yy4NCiAgICAgKi8NCiAgICBwdWJsaWMg\ndm9pZCB0ZXN0SWxsZWdhbFN0YXRlKCkgew0KICAgICAgICBPcGVuSlBBRW50\naXR5TWFuYWdlciBwbSA9IGdldFBNKCk7DQoNCiAgICAgICAgUnVudGltZVRl\nc3QxIGEgPSBuZXcgUnVudGltZVRlc3QxKCJmb28iLCAxNCk7DQogICAgICAg\nIFJ1bnRpbWVUZXN0MSBhMiA9IChSdW50aW1lVGVzdDEpIHBtLmZpbmQoUnVu\ndGltZVRlc3QxLmNsYXNzLCBfaWQpOw0KDQogICAgICAgIHRyeSB7DQogICAg\nICAgICAgICBwbS5wZXJzaXN0KGEpOw0KICAgICAgICAgICAgZmFpbCgicGVy\nc2lzdCIpOw0KICAgICAgICB9DQogICAgICAgIGNhdGNoIChFeGNlcHRpb24g\naXNlKSB7DQogICAgICAgIH0NCiAgICAgICAgdHJ5IHsNCiAgICAgICAgICAg\nIHBtLmlzVHJhbnNhY3Rpb25hbChhMik7DQogICAgICAgICAgICBmYWlsKCJt\nYWtlVHJhbnNhY3Rpb25hbCIpOw0KICAgICAgICB9DQogICAgICAgIGNhdGNo\nIChFeGNlcHRpb24gaXNlKSB7DQogICAgICAgIH0NCiAgICAgICAgdHJ5IHsN\nCiAgICAgICAgICAgIHBtLnJlbW92ZShhMik7DQogICAgICAgICAgICBmYWls\nKCJkZWxldGVQZXJzaXN0ZW50Iik7DQogICAgICAgIH0NCiAgICAgICAgY2F0\nY2ggKEV4Y2VwdGlvbiBpc2UpIHsNCiAgICAgICAgfQ0KDQogICAgICAgIGVu\nZEVtKHBtKTsNCiAgICB9DQoNCiAgICBwdWJsaWMgdm9pZCB0ZXN0T3BlbkpQ\nQUVudGl0eU1hbmFnZXJGYWN0b3J5U2VyaWFsaXphYmxlKCkNCiAgICAgICAg\ndGhyb3dzIEV4Y2VwdGlvbiB7DQogICAgICAgIE9wZW5KUEFFbnRpdHlNYW5h\nZ2VyRmFjdG9yeSBwbWYgPQ0KICAgICAgICAgICAgKE9wZW5KUEFFbnRpdHlN\nYW5hZ2VyRmFjdG9yeSkgZ2V0RW1mKCk7DQogICAgICAgIGFzc2VydE5vdE51\nbGwoIk9wZW5KUEFFbnRpdHlNYW5hZ2VyRmFjdG9yeSBpcyBudWxsLiIsIHBt\nZik7DQoNCiAgICAgICAgQnl0ZUFycmF5T3V0cHV0U3RyZWFtIGJhb3MgPSBu\nZXcgQnl0ZUFycmF5T3V0cHV0U3RyZWFtKCk7DQogICAgICAgIE9iamVjdE91\ndHB1dFN0cmVhbSBvb3MgPSBuZXcgT2JqZWN0T3V0cHV0U3RyZWFtKGJhb3Mp\nOw0KICAgICAgICBvb3Mud3JpdGVPYmplY3QocG1mKTsNCg0KICAgICAgICBP\ncGVuSlBBRW50aXR5TWFuYWdlckZhY3RvcnkgcG1mMiA9IChPcGVuSlBBRW50\naXR5TWFuYWdlckZhY3RvcnkpDQogICAgICAgICAgICBuZXcgT2JqZWN0SW5w\ndXRTdHJlYW0oDQogICAgICAgICAgICAgICAgbmV3IEJ5dGVBcnJheUlucHV0\nU3RyZWFtKGJhb3MudG9CeXRlQXJyYXkoKSkpLnJlYWRPYmplY3QoKTsNCiAg\nICAgICAgYXNzZXJ0Tm90TnVsbCgiRGVzZXJpYWxpemVkIE9wZW5KUEFFbnRp\ndHlNYW5hZ2VyRmFjdG9yeSBpcyBudWxsLiIsDQogICAgICAgICAgICBwbWYy\nKTsNCg0KICAgICAgICBPcGVuSlBBRW50aXR5TWFuYWdlciBwbSA9IHBtZjIu\nY3JlYXRlRW50aXR5TWFuYWdlcigpOw0KICAgICAgICBzdGFydFR4KHBtKTsN\nCiAgICAgICAgLy8gZ28gdGhyb3VnaCBzb21lIG9iamVjdHMgdG8gbWFrZSBz\ndXJlIG91ciBQTSBpcyBPSw0KICAgICAgICBmb3IgKEl0ZXJhdG9yIGkgPSBw\nbS5jcmVhdGVFeHRlbnQoUnVudGltZVRlc3QxLmNsYXNzLCB0cnVlKS5pdGVy\nYXRvcigpOw0KICAgICAgICAgICAgaS5oYXNOZXh0KCk7IGkubmV4dCgpKQ0K\nICAgICAgICAgICAgOw0KICAgICAgICBlbmRUeChwbSk7DQogICAgICAgIGVu\nZEVtKHBtKTsNCiAgICB9DQoNCiAgICBwcml2YXRlIHN0YXRpYyBCcm9rZXJG\nYWN0b3J5IHRvQnJva2VyRmFjdG9yeShFbnRpdHlNYW5hZ2VyRmFjdG9yeSBl\nbWYpIHsNCiAgICAgICAgQnJva2VyRmFjdG9yeSBiZiA9IEpQQUZhY2FkZUhl\nbHBlci50b0Jyb2tlckZhY3RvcnkoZW1mKTsNCiAgICAgICAgaWYgKGJmIGlu\nc3RhbmNlb2YgRGVsZWdhdGluZ0Jyb2tlckZhY3RvcnkpDQogICAgICAgICAg\nICBiZiA9ICgoRGVsZWdhdGluZ0Jyb2tlckZhY3RvcnkpIGJmKS5nZXRJbm5l\ncm1vc3REZWxlZ2F0ZSgpOw0KICAgICAgICByZXR1cm4gYmY7DQogICAgfQ0K\nDQogICAgLyoqDQogICAgICogVGVzdCB0aGF0IGEgZ2V0T2JqZWN0QnlJZCgp\nIHJldHVybnMgdGhlIGNvcnJlY3QgaW5zdGFuY2UuDQogICAgICovDQogICAg\ncHVibGljIHZvaWQgdGVzdEdldE9iamVjdEJ5SWQoKSB7DQogICAgICAgIC8v\nIHRlc3Qgd2l0aCB2YWxpZCBpZA0KICAgICAgICBPcGVuSlBBRW50aXR5TWFu\nYWdlciBwbSA9IGdldFBNKCk7DQogICAgICAgIFJ1bnRpbWVUZXN0MSBiID0g\nKFJ1bnRpbWVUZXN0MSkgcG0uZmluZChSdW50aW1lVGVzdDEuY2xhc3MsIF9p\nZCk7DQogICAgICAgIGFzc2VydEVxdWFscygiU1RSSU5HIiwgYi5nZXRTdHJp\nbmdGaWVsZCgpKTsNCg0KICAgICAgICAvLyBpbnZhbGlkIHdpdGggcG9zc2li\nbGUgc3ViY2xhc3NlcyBzaG91bGQgdGhyb3cgaW1tZWRpYXRlIGV4Y2VwdGlv\nbg0KICAgICAgICBPYmplY3QgaW52YWxpZElkID0gbmV3IElkKFJ1bnRpbWVU\nZXN0MS5jbGFzcywgLTFMKTsNCiAgICAgICAgdHJ5IHsNCiAgICAgICAgICAg\nIHBtLmZpbmQoUnVudGltZVRlc3QxLmNsYXNzLCBpbnZhbGlkSWQpOw0KICAg\nICAgICAgICAgZmFpbCgiSW52YWxpZCBPYmplY3QiKTsNCiAgICAgICAgfSBj\nYXRjaCAoRXhjZXB0aW9uIGUpIHsNCiAgICAgICAgfQ0KDQogICAgICAgIC8v\nIGludmFsaWQgd2l0aG91dCBzdWJjbGFzc2VzIGFuZCB3aXRob3V0IHZhbGlk\nYXRpbmcgc2hvdWxkIHJldHVybg0KICAgICAgICAvLyBob2xsb3cNCiAgICAg\nICAgaW52YWxpZElkID0gbmV3IElkKFJ1bnRpbWVUZXN0NC5jbGFzcywgLTFM\nKTsNCiAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgIFJ1bnRpbWVUZXN0NCBh\nID0gKFJ1bnRpbWVUZXN0NCkgcG0uZ2V0UmVmZXJlbmNlKFJ1bnRpbWVUZXN0\nNC5jbGFzcywNCiAgICAgICAgICAgICAgICBpbnZhbGlkSWQpOw0KICAgICAg\nICAgICAgYXNzZXJ0Tm90TnVsbCgiaW52YWxpZCB3aXRob3V0IHN1YmNsYXNz\nZXMgYW5kIHdpdGhvdXQgdmFsaWRhdGluZyAiDQogICAgICAgICAgICAgICAg\nKyAic2hvdWxkIHJldHVybiBob2xsb3cgb3IgdGhyb3cgZXhjZXB0aW9uIiwg\nYSk7DQogICAgICAgICAgICBhLmdldE5hbWUoKTsNCiAgICAgICAgICAgIGZh\naWwoIkFsbG93ZWQgYWNjZXNzIG9mIGludmFsaWQgaG9sbG93IGluc3RhbmNl\nLiIpOw0KICAgICAgICB9DQogICAgICAgIGNhdGNoIChFbnRpdHlOb3RGb3Vu\nZEV4Y2VwdGlvbiBlbmZlKSB7DQogICAgICAgICAgICAvLyBleHBlY3RlZA0K\nICAgICAgICB9DQoNCiAgICAgICAgaW52YWxpZElkID0gbmV3IElkKFJ1bnRp\nbWVUZXN0NC5jbGFzcywgLTNMKTsNCiAgICAgICAgYXNzZXJ0TnVsbChwbS5m\naW5kKFJ1bnRpbWVUZXN0NC5jbGFzcywgaW52YWxpZElkKSk7DQoNCiAgICAg\nICAgZW5kRW0ocG0pOw0KICAgIH0NCg0KICAgIHB1YmxpYyB2b2lkIHRlc3RH\nZXRPYmplY3RzQnlJZCgpIHsNCiAgICAgICAgT3BlbkpQQUVudGl0eU1hbmFn\nZXIgcG0gPSBnZXRQTSgpOw0KICAgICAgICBBcnJheUxpc3QgaWRsaXN0ID0g\nbmV3IEFycmF5TGlzdCgpOw0KICAgICAgICBpZGxpc3QuYWRkKF9pZCk7DQog\nICAgICAgIGlkbGlzdC5hZGQoX2lkMik7DQogICAgICAgIENvbGxlY3Rpb24g\ncGNzID0gcG0uZmluZEFsbChSdW50aW1lVGVzdDEuY2xhc3MsIGlkbGlzdCk7\nDQogICAgICAgIGFzc2VydEVxdWFscygyLCBwY3Muc2l6ZSgpKTsNCiAgICAg\nICAgSXRlcmF0b3IgaXRlciA9IHBjcy5pdGVyYXRvcigpOw0KICAgICAgICBh\nc3NlcnRFcXVhbHMoIlNUUklORyIsICgoUnVudGltZVRlc3QxKSBpdGVyLm5l\neHQoKSkuZ2V0U3RyaW5nRmllbGQoKSk7DQogICAgICAgIGFzc2VydEVxdWFs\ncygiU1RSSU5HMiIsICgoUnVudGltZVRlc3QyKSBpdGVyLm5leHQoKSkuZ2V0\nU3RyaW5nRmllbGQoKSk7DQogICAgICAgIGVuZEVtKHBtKTsNCg0KICAgICAg\nICBwbSA9IGdldFBNKCk7DQogICAgICAgIGlkbGlzdCA9IG5ldyBBcnJheUxp\nc3QoKTsNCiAgICAgICAgaWRsaXN0LmFkZChfaWQpOw0KICAgICAgICBpZGxp\nc3QuYWRkKF9pZCk7DQogICAgICAgIHBjcyA9IHBtLmZpbmRBbGwoUnVudGlt\nZVRlc3QxLmNsYXNzLCBpZGxpc3QpOw0KICAgICAgICBpdGVyID0gcGNzLml0\nZXJhdG9yKCk7DQogICAgICAgIGFzc2VydEVxdWFscygyLCBwY3Muc2l6ZSgp\nKTsNCiAgICAgICAgYXNzZXJ0RXF1YWxzKCJTVFJJTkciLCAoKFJ1bnRpbWVU\nZXN0MSkgaXRlci5uZXh0KCkpLmdldFN0cmluZ0ZpZWxkKCkpOw0KICAgICAg\nICBpdGVyID0gcGNzLml0ZXJhdG9yKCk7DQogICAgICAgIGFzc2VydFRydWUo\naXRlci5uZXh0KCkgPT0gaXRlci5uZXh0KCkpOw0KICAgICAgICBlbmRFbShw\nbSk7DQoNCiAgICAgICAgLy8gaW52YWxpZCBpZCBjYXVzZXMgZXhjZXB0aW9u\nDQogICAgICAgIE9iamVjdCBpbnZhbGlkSWQgPSBuZXcgSWQoUnVudGltZVRl\nc3Q0LmNsYXNzLCAtMUwpOw0KICAgICAgICBwbSA9IGdldFBNKCk7DQogICAg\nICAgIGlkbGlzdCA9IG5ldyBBcnJheUxpc3QoKTsNCiAgICAgICAgaWRsaXN0\nLmFkZChfaWQpOw0KICAgICAgICBpZGxpc3QuYWRkKGludmFsaWRJZCk7DQog\nICAgICAgIHRyeSB7DQogICAgICAgICAgICBwY3MgPSAoQXJyYXlMaXN0KSBw\nbS5maW5kQWxsKFJ1bnRpbWVUZXN0MS5jbGFzcywgaWRsaXN0KTsNCiAgICAg\nICAgICAgIGl0ZXIgPSBwY3MuaXRlcmF0b3IoKTsNCiAgICAgICAgICAgIGFz\nc2VydEVxdWFscygyLCBwY3Muc2l6ZSgpKTsNCiAgICAgICAgICAgIGFzc2Vy\ndEVxdWFscygiU1RSSU5HIiwNCiAgICAgICAgICAgICAgICAoKFJ1bnRpbWVU\nZXN0MSkgaXRlci5uZXh0KCkpLmdldFN0cmluZ0ZpZWxkKCkpOw0KICAgICAg\nICAgICAgYXNzZXJ0Tm90TnVsbChpdGVyLm5leHQoKSk7DQogICAgICAgICAg\nICBmYWlsKCJpbnZhbGlkIGlkIGRpZG50IGNhdXNlIGV4Y2VwdGlvbiIpOw0K\nICAgICAgICB9DQogICAgICAgIGNhdGNoIChFeGNlcHRpb24gb25mZSkgew0K\nICAgICAgICAgICAgLy9leHBlY3RlZCBleGNlcHRpb24uIGludmFsaWQgaWQg\nY2F1c2VzIGV4Y2VwdGlvbg0KICAgICAgICB9DQoNCiAgICAgICAgdHJ5IHsN\nCiAgICAgICAgICAgICgoUnVudGltZVRlc3Q0KSBpdGVyLm5leHQoKSkuZ2V0\nTmFtZSgpOw0KICAgICAgICAgICAgZmFpbCgiQWNjZXNzZWQgaW52YWxpZCBv\nYmplY3QuIik7DQogICAgICAgIH0NCiAgICAgICAgY2F0Y2ggKEV4Y2VwdGlv\nbiBvbmZlKSB7DQogICAgICAgICAgICBidWcoMTEzOCwgb25mZSwgIldyb25n\nIGV4Y2VwdGlvbiB0eXBlIik7DQogICAgICAgIH0NCg0KICAgICAgICBwbSA9\nIGdldFBNKCk7DQogICAgICAgIHRyeSB7DQogICAgICAgICAgICBwbS5maW5k\nQWxsKFJ1bnRpbWVUZXN0MS5jbGFzcywgaWRsaXN0KTsNCiAgICAgICAgICAg\nIGZhaWwoIkZvdW5kIGludmFsaWQgb2JqZWN0LiIpOw0KICAgICAgICB9IGNh\ndGNoIChFeGNlcHRpb24gZSkgew0KICAgICAgICB9DQogICAgICAgIGVuZEVt\nKHBtKTsNCiAgICB9DQoNCiAgICBwdWJsaWMgdm9pZCB0ZXN0RXZpY3RBbGwo\nKSB7DQogICAgICAgIE9wZW5KUEFFbnRpdHlNYW5hZ2VyIHBtID0gZ2V0UE0o\nKTsNCg0KICAgICAgICBMaXN0IGwgPSAoKEV4dGVudCkgcG0uY3JlYXRlRXh0\nZW50KFJ1bnRpbWVUZXN0MS5jbGFzcywgdHJ1ZSkpLmxpc3QoKTsNCiAgICAg\nICAgcG0ucmV0cmlldmVBbGwobCk7DQogICAgICAgIGZvciAoSXRlcmF0b3Ig\naXRlciA9IGwuaXRlcmF0b3IoKTsgaXRlci5oYXNOZXh0KCk7KSB7DQogICAg\nICAgICAgICBQQ1N0YXRlIHMgPSBnZXRTdGF0ZU1hbmFnZXIoaXRlci5uZXh0\nKCksIHBtKS5nZXRQQ1N0YXRlKCk7DQogICAgICAgICAgICBhc3NlcnRFcXVh\nbHMoUENTdGF0ZS5QTk9OVFJBTlMsIHMpOw0KICAgICAgICB9DQogICAgICAg\nIHBtLmV2aWN0QWxsKCk7DQogICAgICAgIGZvciAoSXRlcmF0b3IgaXRlciA9\nIGwuaXRlcmF0b3IoKTsgaXRlci5oYXNOZXh0KCk7KSB7DQogICAgICAgICAg\nICBQQ1N0YXRlIHMgPSBnZXRTdGF0ZU1hbmFnZXIoaXRlci5uZXh0KCksIHBt\nKS5nZXRQQ1N0YXRlKCk7DQogICAgICAgICAgICBhc3NlcnRFcXVhbHMoUENT\ndGF0ZS5IT0xMT1csIHMpOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgcHVi\nbGljIHZvaWQgdGVzdEV2aWN0QWxsQ29sbGVjdGlvbigpIHsNCiAgICAgICAg\nT3BlbkpQQUVudGl0eU1hbmFnZXIgcG0gPSBnZXRQTSgpOw0KDQogICAgICAg\nIExpc3QgbCA9ICgoRXh0ZW50KSBwbS5jcmVhdGVFeHRlbnQoUnVudGltZVRl\nc3QxLmNsYXNzLCB0cnVlKSkubGlzdCgpOw0KICAgICAgICBwbS5yZXRyaWV2\nZUFsbChsKTsNCiAgICAgICAgZm9yIChJdGVyYXRvciBpdGVyID0gbC5pdGVy\nYXRvcigpOyBpdGVyLmhhc05leHQoKTspIHsNCiAgICAgICAgICAgIFBDU3Rh\ndGUgcyA9IGdldFN0YXRlTWFuYWdlcihpdGVyLm5leHQoKSwgcG0pLmdldFBD\nU3RhdGUoKTsNCiAgICAgICAgICAgIGFzc2VydEVxdWFscyhQQ1N0YXRlLlBO\nT05UUkFOUywgcyk7DQogICAgICAgIH0NCiAgICAgICAgcG0uZXZpY3RBbGwo\nbCk7DQogICAgICAgIGZvciAoSXRlcmF0b3IgaXRlciA9IGwuaXRlcmF0b3Io\nKTsgaXRlci5oYXNOZXh0KCk7KSB7DQogICAgICAgICAgICBQQ1N0YXRlIHMg\nPSBnZXRTdGF0ZU1hbmFnZXIoaXRlci5uZXh0KCksIHBtKS5nZXRQQ1N0YXRl\nKCk7DQogICAgICAgICAgICBhc3NlcnRFcXVhbHMoUENTdGF0ZS5IT0xMT1cs\nIHMpOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgcHVibGljIHZvaWQgdGVz\ndEV2aWN0QWxsQ2xhc3MoKSB7DQogICAgICAgIE9wZW5KUEFFbnRpdHlNYW5h\nZ2VyIHBtID0gZ2V0UE0oKTsNCg0KICAgICAgICBMaXN0IGwgPSAoKEV4dGVu\ndCkgcG0uY3JlYXRlRXh0ZW50KFJ1bnRpbWVUZXN0MS5jbGFzcywgdHJ1ZSkp\nLmxpc3QoKTsNCiAgICAgICAgcG0ucmV0cmlldmVBbGwobCk7DQogICAgICAg\nIGZvciAoSXRlcmF0b3IgaXRlciA9IGwuaXRlcmF0b3IoKTsgaXRlci5oYXNO\nZXh0KCk7KSB7DQogICAgICAgICAgICBQQ1N0YXRlIHMgPSBnZXRTdGF0ZU1h\nbmFnZXIoaXRlci5uZXh0KCksIHBtKS5nZXRQQ1N0YXRlKCk7DQogICAgICAg\nICAgICBhc3NlcnRFcXVhbHMoUENTdGF0ZS5QTk9OVFJBTlMsIHMpOw0KICAg\nICAgICB9DQogICAgICAgIHBtLmV2aWN0QWxsKFJ1bnRpbWVUZXN0MS5jbGFz\ncyk7DQogICAgICAgIGZvciAoSXRlcmF0b3IgaXRlciA9IGwuaXRlcmF0b3Io\nKTsgaXRlci5oYXNOZXh0KCk7KSB7DQogICAgICAgICAgICBQQ1N0YXRlIHMg\nPSBnZXRTdGF0ZU1hbmFnZXIoaXRlci5uZXh0KCksIHBtKS5nZXRQQ1N0YXRl\nKCk7DQogICAgICAgICAgICBhc3NlcnRFcXVhbHMoUENTdGF0ZS5IT0xMT1cs\nIHMpOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgcHVibGljIHZvaWQgdGVz\ndEV2aWN0QWxsQ2xhc3NGYWlsdXJlKCkgew0KICAgICAgICBPcGVuSlBBRW50\naXR5TWFuYWdlciBwbSA9IGdldFBNKCk7DQoNCiAgICAgICAgTGlzdCBsID0g\nKChFeHRlbnQpIHBtLmNyZWF0ZUV4dGVudChSdW50aW1lVGVzdDEuY2xhc3Ms\nIHRydWUpKS5saXN0KCk7DQogICAgICAgIHBtLnJldHJpZXZlQWxsKGwpOw0K\nICAgICAgICBmb3IgKEl0ZXJhdG9yIGl0ZXIgPSBsLml0ZXJhdG9yKCk7IGl0\nZXIuaGFzTmV4dCgpOykgew0KICAgICAgICAgICAgUENTdGF0ZSBzID0gZ2V0\nU3RhdGVNYW5hZ2VyKGl0ZXIubmV4dCgpLCBwbSkuZ2V0UENTdGF0ZSgpOw0K\nICAgICAgICAgICAgYXNzZXJ0RXF1YWxzKFBDU3RhdGUuUE5PTlRSQU5TLCBz\nKTsNCiAgICAgICAgfQ0KICAgICAgICBwbS5ldmljdEFsbChSdW50aW1lVGVz\ndDIuY2xhc3MpOw0KICAgICAgICBib29sZWFuIGZvdW5kUE5PTlRSQU5TID0g\nZmFsc2U7DQogICAgICAgIGZvciAoSXRlcmF0b3IgaXRlciA9IGwuaXRlcmF0\nb3IoKTsgaXRlci5oYXNOZXh0KCk7KSB7DQogICAgICAgICAgICBQQ1N0YXRl\nIHMgPSBnZXRTdGF0ZU1hbmFnZXIoaXRlci5uZXh0KCksIHBtKS5nZXRQQ1N0\nYXRlKCk7DQogICAgICAgICAgICBpZiAocyA9PSBQQ1N0YXRlLlBOT05UUkFO\nUykgew0KICAgICAgICAgICAgICAgIGZvdW5kUE5PTlRSQU5TID0gdHJ1ZTsN\nCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIH0NCiAgICAg\nICAgfQ0KICAgICAgICBhc3NlcnRUcnVlKCJzaG91bGQgaGF2ZSBmb3VuZCBz\nb21lIFJ1bnRpbWVUZXN0MXMgdGhhdCB3ZXJlIG5vdCAiDQogICAgICAgICAg\nICArICJldmljdGVkIiwgZm91bmRQTk9OVFJBTlMpOw0KICAgIH0NCg0KICAg\nIHB1YmxpYyB2b2lkIHRlc3RFdmljdEFsbEV4dGVudCgpIHsNCiAgICAgICAg\nT3BlbkpQQUVudGl0eU1hbmFnZXIgcG0gPSBnZXRQTSgpOw0KDQogICAgICAg\nIExpc3QgbCA9ICgoRXh0ZW50KSBwbS5jcmVhdGVFeHRlbnQoUnVudGltZVRl\nc3QxLmNsYXNzLCB0cnVlKSkubGlzdCgpOw0KICAgICAgICBwbS5yZXRyaWV2\nZUFsbChsKTsNCiAgICAgICAgZm9yIChJdGVyYXRvciBpdGVyID0gbC5pdGVy\nYXRvcigpOyBpdGVyLmhhc05leHQoKTspIHsNCiAgICAgICAgICAgIFBDU3Rh\ndGUgcyA9IGdldFN0YXRlTWFuYWdlcihpdGVyLm5leHQoKSwgcG0pLmdldFBD\nU3RhdGUoKTsNCiAgICAgICAgICAgIGFzc2VydEVxdWFscyhQQ1N0YXRlLlBO\nT05UUkFOUywgcyk7DQogICAgICAgIH0NCiAgICAgICAgcG0uZXZpY3RBbGwo\ncG0uY3JlYXRlRXh0ZW50KFJ1bnRpbWVUZXN0MS5jbGFzcywgdHJ1ZSkpOw0K\nICAgICAgICBmb3IgKEl0ZXJhdG9yIGl0ZXIgPSBsLml0ZXJhdG9yKCk7IGl0\nZXIuaGFzTmV4dCgpOykgew0KICAgICAgICAgICAgUENTdGF0ZSBzID0gZ2V0\nU3RhdGVNYW5hZ2VyKGl0ZXIubmV4dCgpLCBwbSkuZ2V0UENTdGF0ZSgpOw0K\nICAgICAgICAgICAgYXNzZXJ0RXF1YWxzKFBDU3RhdGUuSE9MTE9XLCBzKTsN\nCiAgICAgICAgfQ0KDQogICAgICAgIHBtLnJldHJpZXZlQWxsKGwpOw0KICAg\nICAgICBmb3IgKEl0ZXJhdG9yIGl0ZXIgPSBsLml0ZXJhdG9yKCk7IGl0ZXIu\naGFzTmV4dCgpOykgew0KICAgICAgICAgICAgUENTdGF0ZSBzID0gZ2V0U3Rh\ndGVNYW5hZ2VyKGl0ZXIubmV4dCgpLCBwbSkuZ2V0UENTdGF0ZSgpOw0KICAg\nICAgICAgICAgYXNzZXJ0RXF1YWxzKFBDU3RhdGUuUE5PTlRSQU5TLCBzKTsN\nCiAgICAgICAgfQ0KICAgICAgICBwbS5ldmljdEFsbChwbS5jcmVhdGVFeHRl\nbnQoUnVudGltZVRlc3QxLmNsYXNzLCBmYWxzZSkpOw0KICAgICAgICBmb3Ig\nKEl0ZXJhdG9yIGl0ZXIgPSBsLml0ZXJhdG9yKCk7IGl0ZXIuaGFzTmV4dCgp\nOykgew0KICAgICAgICAgICAgT2JqZWN0IG8gPSBpdGVyLm5leHQoKTsNCiAg\nICAgICAgICAgIGlmIChvLmdldENsYXNzKCkgPT0gUnVudGltZVRlc3QxLmNs\nYXNzKSB7DQogICAgICAgICAgICAgICAgUENTdGF0ZSBzID0gZ2V0U3RhdGVN\nYW5hZ2VyKG8sIHBtKS5nZXRQQ1N0YXRlKCk7DQogICAgICAgICAgICAgICAg\nYXNzZXJ0RXF1YWxzKFBDU3RhdGUuSE9MTE9XLCBzKTsNCiAgICAgICAgICAg\nIH0NCiAgICAgICAgfQ0KICAgIH0NCn0NCg==\n","encoding":"base64"}

