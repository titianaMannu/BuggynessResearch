{"sha":"217ed9909d4c89f41cb9affceb03e380964c8464","node_id":"MDQ6QmxvYjIwNjM2NDoyMTdlZDk5MDlkNGM4OWY0MWNiOWFmZmNlYjAzZTM4MDk2NGM4NDY0","size":11851,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/217ed9909d4c89f41cb9affceb03e380964c8464","content":"LyoNCiAqIFRlc3RQZXJzaXN0ZW50TWFwcy5qYXZhDQogKg0KICogQ3JlYXRl\nZCBvbiBPY3RvYmVyIDEzLCAyMDA2LCAxOjU0IFBNDQogKg0KICogVG8gY2hh\nbmdlIHRoaXMgdGVtcGxhdGUsIGNob29zZSBUb29scyB8IFRlbXBsYXRlIE1h\nbmFnZXINCiAqIGFuZCBvcGVuIHRoZSB0ZW1wbGF0ZSBpbiB0aGUgZWRpdG9y\nLg0KICovDQoNCi8qDQogKiBMaWNlbnNlZCB0byB0aGUgQXBhY2hlIFNvZnR3\nYXJlIEZvdW5kYXRpb24gKEFTRikgdW5kZXIgb25lDQogKiBvciBtb3JlIGNv\nbnRyaWJ1dG9yIGxpY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNF\nIGZpbGUNCiAqIGRpc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRp\ndGlvbmFsIGluZm9ybWF0aW9uDQogKiByZWdhcmRpbmcgY29weXJpZ2h0IG93\nbmVyc2hpcC4gIFRoZSBBU0YgbGljZW5zZXMgdGhpcyBmaWxlDQogKiB0byB5\nb3UgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhl\nDQogKiAiTGljZW5zZSIpOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4\nY2VwdCBpbiBjb21wbGlhbmNlDQogKiB3aXRoIHRoZSBMaWNlbnNlLiAgWW91\nIG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0DQogKg0KICog\naHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wDQog\nKg0KICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFn\ncmVlZCB0byBpbiB3cml0aW5nLA0KICogc29mdHdhcmUgZGlzdHJpYnV0ZWQg\ndW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4NCiAqICJB\nUyBJUyIgQkFTSVMsIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05T\nIE9GIEFOWQ0KICogS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4g\nIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlDQogKiBzcGVjaWZpYyBsYW5ndWFn\nZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kIGxpbWl0YXRpb25zDQogKiB1\nbmRlciB0aGUgTGljZW5zZS4gICAgDQogKi8NCnBhY2thZ2Ugb3JnLmFwYWNo\nZS5vcGVuanBhLnBlcnNpc3RlbmNlLmtlcm5lbDsNCg0KaW1wb3J0IGphdmEu\ndXRpbC5BcnJheUxpc3Q7DQppbXBvcnQgamF2YS51dGlsLkFycmF5czsNCmlt\ncG9ydCBqYXZhLnV0aWwuQ29sbGVjdGlvbjsNCmltcG9ydCBqYXZhLnV0aWwu\nSGFzaE1hcDsNCmltcG9ydCBqYXZhLnV0aWwuSXRlcmF0b3I7DQppbXBvcnQg\namF2YS51dGlsLkxpc3Q7DQppbXBvcnQgamF2YS51dGlsLk1hcDsNCg0KDQoN\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2Uua2VybmVs\nLmNvbW1vbi5hcHBzLk1hcEVsZW1lbnRQQzsNCmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEucGVyc2lzdGVuY2Uua2VybmVsLmNvbW1vbi5hcHBzLk1hcEVs\nZW1lbnRQQ0NoaWxkOw0KaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5wZXJz\naXN0ZW5jZS5rZXJuZWwuY29tbW9uLmFwcHMuUGVyc2lzdGVudE1hcEhvbGRl\ncjsNCg0KaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5F\neHRlbnQ7DQppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNl\nLk9wZW5KUEFFbnRpdHlNYW5hZ2VyOw0KaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5wZXJzaXN0ZW5jZS5PcGVuSlBBUXVlcnk7DQoNCnB1YmxpYyBjbGFz\ncyBUZXN0UGVyc2lzdGVudE1hcHMgZXh0ZW5kcyBCYXNlS2VybmVsVGVzdCB7\nDQoNCiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBTdHJpbmcgSkRPUUwgPSAi\namF2YXguamRvLnF1ZXJ5LkpET1FMIjsNCg0KICAgIC8qKg0KICAgICAqIENy\nZWF0ZXMgYSBuZXcgaW5zdGFuY2Ugb2YgVGVzdFBlcnNpc3RlbnRNYXBzDQog\nICAgICovDQogICAgcHVibGljIFRlc3RQZXJzaXN0ZW50TWFwcygpIHsNCiAg\nICB9DQoNCiAgICBwdWJsaWMgVGVzdFBlcnNpc3RlbnRNYXBzKFN0cmluZyBu\nYW1lKSB7DQogICAgICAgIHN1cGVyKG5hbWUpOw0KICAgIH0NCg0KICAgIHB1\nYmxpYyB2b2lkIHNldFVwKCkgew0KICAgICAgICBkZWxldGVBbGwoUGVyc2lz\ndGVudE1hcEhvbGRlci5jbGFzcyk7DQogICAgICAgIE9wZW5KUEFFbnRpdHlN\nYW5hZ2VyIHBtID0gZ2V0UE0oKTsNCiAgICAgICAgc3RhcnRUeChwbSk7DQoN\nCiAgICAgICAgcG0ucGVyc2lzdChuZXcgUGVyc2lzdGVudE1hcEhvbGRlcigp\nKTsNCg0KICAgICAgICBlbmRUeChwbSk7DQogICAgICAgIGVuZEVtKHBtKTsN\nCiAgICB9DQoNCiAgICBwcml2YXRlIFBlcnNpc3RlbnRNYXBIb2xkZXIgZ2V0\nSG9sZGVyKE9wZW5KUEFFbnRpdHlNYW5hZ2VyIHBtKSB7DQogICAgICAgIEV4\ndGVudCBlID0gcG0uY3JlYXRlRXh0ZW50KFBlcnNpc3RlbnRNYXBIb2xkZXIu\nY2xhc3MsIHRydWUpOw0KICAgICAgICBhc3NlcnRTaXplKDEsICgoQ29sbGVj\ndGlvbikgZS5saXN0KCkpKTsNCiAgICAgICAgcmV0dXJuIChQZXJzaXN0ZW50\nTWFwSG9sZGVyKSBlLml0ZXJhdG9yKCkubmV4dCgpOw0KICAgIH0NCg0KICAg\nIHByaXZhdGUgT2JqZWN0IGtleUluc3RhbmNlKENsYXNzIHR5cGUpIHRocm93\ncyBFeGNlcHRpb24gew0KICAgICAgICBpZiAodHlwZS5nZXROYW1lKCkuZXF1\nYWxzKFN0cmluZy5jbGFzcy5nZXROYW1lKCkpKQ0KICAgICAgICAgICAgcmV0\ndXJuIHJhbmRvbVN0cmluZygpOw0KICAgICAgICBlbHNlDQogICAgICAgICAg\nICByZXR1cm4gdHlwZS5uZXdJbnN0YW5jZSgpOw0KICAgIH0NCg0KICAgIHBy\naXZhdGUgdm9pZCB0ZXN0TWFwKGludCBudW0sIFN0cmluZyBuYW1lLCBDbGFz\ncyBrZXlDbGFzcywgQ2xhc3MgdmFsdWVDbGFzcykNCiAgICAgICAgdGhyb3dz\nIEV4Y2VwdGlvbiB7DQogICAgICAgIE9wZW5KUEFFbnRpdHlNYW5hZ2VyIHNy\nY3BtID0gZ2V0UE0odHJ1ZSwgdHJ1ZSk7DQogICAgICAgIHN0YXJ0VHgoc3Jj\ncG0pOw0KDQogICAgICAgIFBlcnNpc3RlbnRNYXBIb2xkZXIgaG9sZGVyID0g\nZ2V0SG9sZGVyKHNyY3BtKTsNCiAgICAgICAgTWFwIG1hcCA9IGhvbGRlci5n\nZXROYW1lZE1hcChuYW1lKTsNCiAgICAgICAgTWFwIGludGVybmFsTWFwID0g\nbmV3IEhhc2hNYXAoKTsNCg0KICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8\nIG51bTsgaSsrKSB7DQogICAgICAgICAgICBPYmplY3Qga2V5ID0ga2V5SW5z\ndGFuY2Uoa2V5Q2xhc3MpOw0KICAgICAgICAgICAgT2JqZWN0IHZhbHVlID0g\na2V5SW5zdGFuY2UodmFsdWVDbGFzcyk7DQogICAgICAgICAgICBtYXAucHV0\nKGtleSwgdmFsdWUpOw0KICAgICAgICAgICAgaW50ZXJuYWxNYXAucHV0KGtl\neSwgdmFsdWUpOw0KDQogICAgICAgICAgICBhc3NlcnRFcXVhbHMobWFwLmdl\ndChrZXkpLCBpbnRlcm5hbE1hcC5nZXQoa2V5KSk7DQogICAgICAgIH0NCiAg\nICAgICAgZW5kVHgoc3JjcG0pOw0KDQogICAgICAgIE9wZW5KUEFFbnRpdHlN\nYW5hZ2VyIHBtID0gZ2V0UE0oKTsNCiAgICAgICAgc3RhcnRUeChwbSk7DQov\nLyAgICAgICAgaG9sZGVyID0gZ2V0SG9sZGVyKHBtKTsNCiAgICAgICAgbWFw\nID0gaG9sZGVyLmdldE5hbWVkTWFwKG5hbWUpOw0KICAgICAgICBmb3IgKEl0\nZXJhdG9yIGkgPSBpbnRlcm5hbE1hcC5rZXlTZXQoKS5pdGVyYXRvcigpOyBp\nLmhhc05leHQoKTspIHsNCiAgICAgICAgICAgIE9iamVjdCBrID0gaS5uZXh0\nKCk7DQogICAgICAgICAgICBhc3NlcnRFcXVhbHMobWFwLmdldChrKSwgaW50\nZXJuYWxNYXAuZ2V0KGspKTsNCiAgICAgICAgfQ0KICAgICAgICBlbmRUeChw\nbSk7DQogICAgICAgIGVuZEVtKHBtKTsNCg0KICAgICAgICBTdHJpbmcgc2Vs\nZWN0V2hlcmUgPQ0KICAgICAgICAgICAgInNlbGVjdCBmcm9tICIgKyBQZXJz\naXN0ZW50TWFwSG9sZGVyLmNsYXNzLmdldE5hbWUoKSArICIgd2hlcmUgIjsN\nCg0KICAgICAgICBwbSA9IGdldFBNKCk7DQogICAgICAgIHN0YXJ0VHgocG0p\nOw0KICAgICAgICBmb3IgKEl0ZXJhdG9yIGkgPSBpbnRlcm5hbE1hcC5rZXlT\nZXQoKS5pdGVyYXRvcigpOyBpLmhhc05leHQoKTspIHsNCg0KICAgICAgICAg\nICAgT2JqZWN0IHBhcmFtID0gaS5uZXh0KCk7DQogICAgICAgICAgICBpZiAo\ncG0uaXNQZXJzaXN0ZW50KHBhcmFtKSkNCiAgICAgICAgICAgICAgICBwYXJh\nbSA9IHBtLmZpbmQocGFyYW0uZ2V0Q2xhc3MoKSwgcG0uZ2V0T2JqZWN0SWQo\ncGFyYW0pKTsNCg0KICAgICAgICAgICAgT2JqZWN0IHZhbCA9IGludGVybmFs\nTWFwLmdldChwYXJhbSk7DQogICAgICAgICAgICBpZiAocG0uaXNQZXJzaXN0\nZW50KHZhbCkpDQogICAgICAgICAgICAgICAgdmFsID0gcG0uZmluZCh2YWwu\nZ2V0Q2xhc3MoKSwgcG0uZ2V0T2JqZWN0SWQodmFsKSk7DQoNCiAgICAgICAg\nICAgIE9wZW5KUEFRdWVyeSBxOw0KDQogICAgICAgICAgICBxID0gcG0uY3Jl\nYXRlUXVlcnkoSkRPUUwsDQogICAgICAgICAgICAgICAgc2VsZWN0V2hlcmUg\nKyBuYW1lICsgIi5jb250YWluc0tleSg6cGFyYW0pIik7DQogICAgICAgICAg\nICBxLnNldFBhcmFtZXRlcigicGFyYW0iLCBwYXJhbSk7DQogICAgICAgICAg\nICBhc3NlcnRTaXplKDEsIHEuZ2V0UmVzdWx0TGlzdCgpKTsNCg0KICAgICAg\nICAgICAgcSA9IHBtLmNyZWF0ZVF1ZXJ5KEpET1FMLA0KICAgICAgICAgICAg\nICAgIHNlbGVjdFdoZXJlICsgbmFtZSArICIuY29udGFpbnNWYWx1ZSg6dmFs\ndWUpIik7DQogICAgICAgICAgICBxLnNldFBhcmFtZXRlcigidmFsdWUiLCB2\nYWwpOw0KICAgICAgICAgICAgYXNzZXJ0U2l6ZSgxLCBxLmdldFJlc3VsdExp\nc3QoKSk7DQoNCiAgICAgICAgICAgIHEgPSBwbS5jcmVhdGVRdWVyeShKRE9R\nTCwgc2VsZWN0V2hlcmUgKyBuYW1lICsgIi5jb250YWluc1ZhbHVlKCIgKw0K\nICAgICAgICAgICAgICAgIG5hbWUgKyAiLmdldCg6cGFyYW0pKSIpOw0KICAg\nICAgICAgICAgcS5zZXRQYXJhbWV0ZXIoInBhcmFtIiwgcGFyYW0pOw0KICAg\nICAgICAgICAgYXNzZXJ0U2l6ZSgxLCBxLmdldFJlc3VsdExpc3QoKSk7DQoN\nCiAgICAgICAgICAgIHEgPSBwbS5jcmVhdGVRdWVyeShKRE9RTCwNCiAgICAg\nICAgICAgICAgICBzZWxlY3RXaGVyZSArIG5hbWUgKyAiLmdldCg6cGFyYW0p\nICE9IG51bGwiKTsNCiAgICAgICAgICAgIHEuc2V0UGFyYW1ldGVyKCJwYXJh\nbSIsIHBhcmFtKTsNCiAgICAgICAgICAgIGFzc2VydFNpemUoMSwgcS5nZXRS\nZXN1bHRMaXN0KCkpOw0KDQogICAgICAgICAgICBxID0gcG0uY3JlYXRlUXVl\ncnkoSkRPUUwsDQogICAgICAgICAgICAgICAgc2VsZWN0V2hlcmUgKyBuYW1l\nICsgIi5nZXQoOnBhcmFtKSA9PSA6dmFsdWUiKTsNCiAgICAgICAgICAgIHEu\nc2V0UGFyYW1ldGVyKCJwYXJhbSIsIHBhcmFtKTsNCiAgICAgICAgICAgIHEu\nc2V0UGFyYW1ldGVyKCJ2YWx1ZSIsIHZhbCk7DQogICAgICAgICAgICBhc3Nl\ncnRTaXplKDEsIHEuZ2V0UmVzdWx0TGlzdCgpKTsNCg0KICAgICAgICAgICAg\ncSA9IHBtLmNyZWF0ZVF1ZXJ5KEpET1FMLA0KICAgICAgICAgICAgICAgIHNl\nbGVjdFdoZXJlICsgbmFtZSArICIuZ2V0KDpwYXJhbSkgIT0gOnZhbHVlIik7\nDQogICAgICAgICAgICBxLnNldFBhcmFtZXRlcigicGFyYW0iLCBwYXJhbSk7\nDQogICAgICAgICAgICBxLnNldFBhcmFtZXRlcigidmFsdWUiLCB2YWwpOw0K\nICAgICAgICAgICAgYXNzZXJ0U2l6ZSgwLCBxLmdldFJlc3VsdExpc3QoKSk7\nDQogICAgICAgIH0NCiAgICAgICAgZW5kVHgocG0pOw0KICAgICAgICBlbmRF\nbShwbSk7DQoNCiAgICAgICAgcG0gPSBnZXRQTSgpOw0KICAgICAgICBzdGFy\ndFR4KHBtKTsNCiAgICAgICAgZm9yIChJdGVyYXRvciBpID0gaW50ZXJuYWxN\nYXAua2V5U2V0KCkuaXRlcmF0b3IoKTsgaS5oYXNOZXh0KCk7KSB7DQogICAg\nICAgICAgICBPYmplY3QgcGFyYW0gPSBpLm5leHQoKTsNCiAgICAgICAgICAg\nIGlmIChwbS5pc1BlcnNpc3RlbnQocGFyYW0pKQ0KICAgICAgICAgICAgICAg\nIHBhcmFtID0gcG0uZmluZChwYXJhbS5nZXRDbGFzcygpLCBwbS5nZXRPYmpl\nY3RJZChwYXJhbSkpOw0KDQogICAgICAgICAgICBMaXN0IGdldFF1ZXJpZXMg\nPSBuZXcgQXJyYXlMaXN0KEFycmF5cy5hc0xpc3QobmV3IFN0cmluZ1tdew0K\nICAgICAgICAgICAgICAgIHNlbGVjdFdoZXJlICsgbmFtZSArICIuZ2V0KDpw\nYXJhbSkgIT0gbnVsbCIsDQogICAgICAgICAgICAgICAgc2VsZWN0V2hlcmUg\nKyBuYW1lICsgIi5nZXQoOnBhcmFtKSA9PSAiICsgbmFtZSArICIuZ2V0KDpw\nYXJhbSkiLA0KICAgICAgICAgICAgICAgIHNlbGVjdFdoZXJlICsgIiEoIiAr\nIG5hbWUgKyAiLmdldCg6cGFyYW0pID09IG51bGwpIiwNCiAgICAgICAgICAg\nICAgICBzZWxlY3RXaGVyZSArICIhKCIgKyBuYW1lICsgIi5nZXQoOnBhcmFt\nKSAhPSAiICsgbmFtZSArDQogICAgICAgICAgICAgICAgICAgICIuZ2V0KDpw\nYXJhbSkpIiwNCiAgICAgICAgICAgIH0pKTsNCg0KICAgICAgICAgICAgZm9y\nIChJdGVyYXRvciBxaSA9IGdldFF1ZXJpZXMuaXRlcmF0b3IoKTsgcWkuaGFz\nTmV4dCgpOykgew0KICAgICAgICAgICAgICAgIFN0cmluZyBxdWVyeSA9IChT\ndHJpbmcpIHFpLm5leHQoKTsNCiAgICAgICAgICAgICAgICBpZiAodmFsdWVD\nbGFzcyA9PSBTdHJpbmcuY2xhc3MpDQogICAgICAgICAgICAgICAgICAgIHF1\nZXJ5ICs9ICIgb3JkZXIgYnkgIiArIG5hbWUgKyAiLmdldCg6cGFyYW0pIGRl\nc2MiOw0KICAgICAgICAgICAgICAgIE9wZW5KUEFRdWVyeSBxID0gcG0uY3Jl\nYXRlUXVlcnkoSkRPUUwsIHF1ZXJ5KTsNCiAgICAgICAgICAgICAgICBxLnNl\ndFBhcmFtZXRlcigicGFyYW0iLCBwYXJhbSk7DQogICAgICAgICAgICAgICAg\nYXNzZXJ0U2l6ZSgxLCBxLmdldFJlc3VsdExpc3QoKSk7DQogICAgICAgICAg\nICB9DQogICAgICAgIH0NCiAgICAgICAgZW5kVHgocG0pOw0KICAgICAgICBl\nbmRFbShwbSk7DQoNCiAgICAgICAgZW5kRW0oc3JjcG0pOw0KICAgIH0NCg0K\nICAgIHB1YmxpYyB2b2lkIHRlc3RQQ0tleVN0cmluZ1ZhbHVlKCkNCiAgICAg\nICAgdGhyb3dzIEV4Y2VwdGlvbiB7DQogICAgICAgIHRlc3RNYXAoNSwgInRl\nc3RQQ0tleVN0cmluZ1ZhbHVlIiwNCiAgICAgICAgICAgIE1hcEVsZW1lbnRQ\nQy5jbGFzcywgU3RyaW5nLmNsYXNzKTsNCiAgICB9DQoNCiAgICBwdWJsaWMg\ndm9pZCB0ZXN0U3RyaW5nS2V5UENWYWx1ZSgpDQogICAgICAgIHRocm93cyBF\neGNlcHRpb24gew0KICAgICAgICB0ZXN0TWFwKDYsICJ0ZXN0U3RyaW5nS2V5\nUENWYWx1ZSIsDQogICAgICAgICAgICBTdHJpbmcuY2xhc3MsIE1hcEVsZW1l\nbnRQQy5jbGFzcyk7DQogICAgfQ0KDQogICAgcHVibGljIHZvaWQgdGVzdFBD\nS2V5UENWYWx1ZSgpDQogICAgICAgIHRocm93cyBFeGNlcHRpb24gew0KICAg\nICAgICB0ZXN0TWFwKDcsICJ0ZXN0UENLZXlQQ1ZhbHVlIiwNCiAgICAgICAg\nICAgIE1hcEVsZW1lbnRQQy5jbGFzcywgTWFwRWxlbWVudFBDLmNsYXNzKTsN\nCiAgICB9DQoNCiAgICBwdWJsaWMgdm9pZCB0ZXN0UENTdWJLZXlTdHJpbmdW\nYWx1ZSgpDQogICAgICAgIHRocm93cyBFeGNlcHRpb24gew0KICAgICAgICB0\nZXN0TWFwKDgsICJ0ZXN0UENTdWJLZXlTdHJpbmdWYWx1ZSIsDQogICAgICAg\nICAgICBNYXBFbGVtZW50UENDaGlsZC5jbGFzcywgU3RyaW5nLmNsYXNzKTsN\nCiAgICB9DQoNCiAgICBwdWJsaWMgdm9pZCB0ZXN0U3RyaW5nS2V5UENTdWJW\nYWx1ZSgpDQogICAgICAgIHRocm93cyBFeGNlcHRpb24gew0KICAgICAgICB0\nZXN0TWFwKDksICJ0ZXN0U3RyaW5nS2V5UENTdWJWYWx1ZSIsDQogICAgICAg\nICAgICBTdHJpbmcuY2xhc3MsIE1hcEVsZW1lbnRQQ0NoaWxkLmNsYXNzKTsN\nCiAgICB9DQoNCiAgICBwdWJsaWMgdm9pZCB0ZXN0UENTdWJLZXlQQ1ZhbHVl\nKCkNCiAgICAgICAgdGhyb3dzIEV4Y2VwdGlvbiB7DQogICAgICAgIHRlc3RN\nYXAoMTAsICJ0ZXN0UENTdWJLZXlQQ1ZhbHVlIiwNCiAgICAgICAgICAgIE1h\ncEVsZW1lbnRQQ0NoaWxkLmNsYXNzLCBNYXBFbGVtZW50UEMuY2xhc3MpOw0K\nICAgIH0NCg0KICAgIHB1YmxpYyB2b2lkIHRlc3RQQ1N1YktleVBDU3ViVmFs\ndWUoKQ0KICAgICAgICB0aHJvd3MgRXhjZXB0aW9uIHsNCiAgICAgICAgdGVz\ndE1hcCgxMSwgInRlc3RQQ1N1YktleVBDU3ViVmFsdWUiLA0KICAgICAgICAg\nICAgTWFwRWxlbWVudFBDQ2hpbGQuY2xhc3MsIE1hcEVsZW1lbnRQQ0NoaWxk\nLmNsYXNzKTsNCiAgICB9DQoNCiAgICBwdWJsaWMgdm9pZCB0ZXN0UENLZXlQ\nQ1N1YlZhbHVlKCkNCiAgICAgICAgdGhyb3dzIEV4Y2VwdGlvbiB7DQogICAg\nICAgIHRlc3RNYXAoMTIsICJ0ZXN0UENLZXlQQ1N1YlZhbHVlIiwNCiAgICAg\nICAgICAgIE1hcEVsZW1lbnRQQy5jbGFzcywgTWFwRWxlbWVudFBDQ2hpbGQu\nY2xhc3MpOw0KICAgIH0NCg0KICAgIHB1YmxpYyB2b2lkIHRlc3RQQ0ludGZL\nZXlTdHJpbmdWYWx1ZSgpDQogICAgICAgIHRocm93cyBFeGNlcHRpb24gew0K\nICAgICAgICB0ZXN0TWFwKDEzLCAidGVzdFBDSW50ZktleVN0cmluZ1ZhbHVl\nIiwNCiAgICAgICAgICAgIE1hcEVsZW1lbnRQQy5jbGFzcywgU3RyaW5nLmNs\nYXNzKTsNCiAgICB9DQoNCiAgICBwdWJsaWMgdm9pZCB0ZXN0U3RyaW5nS2V5\nUENJbnRmVmFsdWUoKQ0KICAgICAgICB0aHJvd3MgRXhjZXB0aW9uIHsNCiAg\nICAgICAgdGVzdE1hcCgxNCwgInRlc3RTdHJpbmdLZXlQQ0ludGZWYWx1ZSIs\nDQogICAgICAgICAgICBTdHJpbmcuY2xhc3MsIE1hcEVsZW1lbnRQQy5jbGFz\ncyk7DQogICAgfQ0KDQogICAgcHVibGljIHZvaWQgdGVzdFBDSW50ZktleVBD\nVmFsdWUoKQ0KICAgICAgICB0aHJvd3MgRXhjZXB0aW9uIHsNCiAgICAgICAg\ndGVzdE1hcCgxNSwgInRlc3RQQ0ludGZLZXlQQ1ZhbHVlIiwNCiAgICAgICAg\nICAgIE1hcEVsZW1lbnRQQy5jbGFzcywgTWFwRWxlbWVudFBDLmNsYXNzKTsN\nCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiBUZXN0IHF1ZXJ5aW5nIG1hcHMg\nd2hlbiB0aGVyZSBhcmUgbXVsdGlwbGUgaG9sZGVyIGluc3RhbmNlcyB0aGF0\nDQogICAgICogaGF2ZSBtYXBzIHdpdGggdGhlIHNhbWUga2V5Lg0KICAgICAq\nLw0KICAgIHB1YmxpYyB2b2lkIHRlc3RRdWVyeU11bHRpcGxlTWFwcygpIHRo\ncm93cyBFeGNlcHRpb24gew0KICAgICAgICBkZWxldGVBbGwoUGVyc2lzdGVu\ndE1hcEhvbGRlci5jbGFzcyk7DQoNCiAgICAgICAgU3RyaW5nIG1hcE5hbWUg\nPSAidGVzdFN0cmluZ0tleVBDVmFsdWUiOw0KDQogICAgICAgIFN0cmluZ1td\nIG1hcE5hbWVzID0gbmV3IFN0cmluZ1tdew0KICAgICAgICAgICAgInRlc3RQ\nQ0tleVN0cmluZ1ZhbHVlIiwNCiAgICAgICAgICAgIC8vICJ0ZXN0U3RyaW5n\nS2V5UENWYWx1ZSIsDQogICAgICAgICAgICAidGVzdFBDS2V5UENWYWx1ZSIs\nDQogICAgICAgICAgICAidGVzdFBDU3ViS2V5U3RyaW5nVmFsdWUiLA0KICAg\nICAgICAgICAgInRlc3RTdHJpbmdLZXlQQ1N1YlZhbHVlIiwNCiAgICAgICAg\nICAgICJ0ZXN0UENTdWJLZXlQQ1ZhbHVlIiwNCiAgICAgICAgICAgICJ0ZXN0\nUENTdWJLZXlQQ1N1YlZhbHVlIiwNCiAgICAgICAgICAgICJ0ZXN0UENLZXlQ\nQ1N1YlZhbHVlIiwNCiAgICAgICAgICAgICJ0ZXN0UENJbnRmS2V5U3RyaW5n\nVmFsdWUiLA0KICAgICAgICAgICAgInRlc3RTdHJpbmdLZXlQQ0ludGZWYWx1\nZSIsDQogICAgICAgICAgICAidGVzdFBDSW50ZktleVBDVmFsdWUiLA0KICAg\nICAgICB9Ow0KDQogICAgICAgIE9wZW5KUEFFbnRpdHlNYW5hZ2VyIHBtOw0K\nDQogICAgICAgIHBtID0gZ2V0UE0oKTsNCiAgICAgICAgc3RhcnRUeChwbSk7\nDQoNCiAgICAgICAgTWFwRWxlbWVudFBDIHBjID0gbmV3IE1hcEVsZW1lbnRQ\nQygpOw0KICAgICAgICBwYy5zZXRFbGVtZW50RGF0YSgiZm9vIik7DQoNCiAg\nICAgICAgaW50IG1heCA9IDU7DQoNCiAgICAgICAgZm9yIChpbnQgaSA9IDA7\nIGkgPCBtYXg7IGkrKykgew0KICAgICAgICAgICAgUGVyc2lzdGVudE1hcEhv\nbGRlciBob2xkZXIgPSBuZXcgUGVyc2lzdGVudE1hcEhvbGRlcigpOw0KICAg\nICAgICAgICAgZm9yIChpbnQgaiA9IDA7IGogPCBpOyBqKyspIHsNCiAgICAg\nICAgICAgICAgICBob2xkZXIuZ2V0TmFtZWRNYXAobWFwTmFtZSkucHV0KCJr\nZXkiICsgaiwgcGMpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgcG0u\ncGVyc2lzdChob2xkZXIpOw0KICAgICAgICB9DQoNCiAgICAgICAgZW5kVHgo\ncG0pOw0KICAgICAgICBlbmRFbShwbSk7DQoNCiAgICAgICAgcG0gPSBnZXRQ\nTSgpOw0KICAgICAgICBwYyA9IChNYXBFbGVtZW50UEMpIHBtLmZpbmQoTWFw\nRWxlbWVudFBDLmNsYXNzLCBwbS5nZXRPYmplY3RJZChwYykpOw0KICAgICAg\nICBmb3IgKGludCBpID0gMDsgaSA8IG1heDsgaSsrKSB7DQogICAgICAgICAg\nICBPcGVuSlBBUXVlcnkgcTsNCg0KICAgICAgICAgICAgU3RyaW5nIGtleSA9\nICJrZXkiICsgaTsNCiAgICAgICAgICAgIFN0cmluZyBzZWxlY3RXaGVyZSA9\nICJzZWxlY3QgZnJvbSAiICsNCiAgICAgICAgICAgICAgICBQZXJzaXN0ZW50\nTWFwSG9sZGVyLmNsYXNzLmdldE5hbWUoKSArICIgd2hlcmUgIjsNCiAgICAg\nICAgICAgIHEgPSBwbS5jcmVhdGVRdWVyeShKRE9RTCwNCiAgICAgICAgICAg\nICAgICBzZWxlY3RXaGVyZSArIG1hcE5hbWUgKyAiLmNvbnRhaW5zS2V5KDpr\nZXkpIik7DQogICAgICAgICAgICBxLnNldFBhcmFtZXRlcigia2V5Iiwga2V5\nKTsNCiAgICAgICAgICAgIGFzc2VydFNpemUobWF4IC0gaSAtIDEsIHEuZ2V0\nUmVzdWx0TGlzdCgpKTsNCg0KICAgICAgICAgICAgcSA9IHBtLmNyZWF0ZVF1\nZXJ5KEpET1FMLA0KICAgICAgICAgICAgICAgIHNlbGVjdFdoZXJlICsgbWFw\nTmFtZSArICIuZ2V0KDprZXkpID09IDp2YWwiKTsNCiAgICAgICAgICAgIHEu\nc2V0UGFyYW1ldGVyKCJrZXkiLCBrZXkpOw0KICAgICAgICAgICAgcS5zZXRQ\nYXJhbWV0ZXIoInZhbCIsIHBjKTsNCiAgICAgICAgICAgIGFzc2VydFNpemUo\nbWF4IC0gaSAtIDEsIHEuZ2V0UmVzdWx0TGlzdCgpKTsNCg0KICAgICAgICAg\nICAgcSA9IHBtLmNyZWF0ZVF1ZXJ5KEpET1FMLA0KICAgICAgICAgICAgICAg\nIHNlbGVjdFdoZXJlICsgInRlc3RQQ0tleVN0cmluZ1ZhbHVlLmlzRW1wdHko\nKSAmJiAiDQogICAgICAgICAgICAgICAgICAgICsgbWFwTmFtZSArICIuZ2V0\nKDprZXkpID09IDp2YWwiKTsNCiAgICAgICAgICAgIHEuc2V0UGFyYW1ldGVy\nKCJrZXkiLCBrZXkpOw0KICAgICAgICAgICAgcS5zZXRQYXJhbWV0ZXIoInZh\nbCIsIHBjKTsNCiAgICAgICAgICAgIGFzc2VydFNpemUobWF4IC0gaSAtIDEs\nIHEuZ2V0UmVzdWx0TGlzdCgpKTsNCg0KICAgICAgICAgICAgLy8gbm93IHRy\neSB0byBleGVjdXRlIHF1ZXJpZXMgYWdhaW5zdCBtdWx0aXBsZSBvdGhlcg0K\nICAgICAgICAgICAgLy8gbWFwIGluc3RhbmNlcywgc28gd2UgY2FuIG1ha2Ug\nc3VyZSB0aGUgam9pbnMgYXJlIHJvYnVzdA0KICAgICAgICAgICAgZm9yIChp\nbnQgaiA9IDA7IGogPCBtYXBOYW1lcy5sZW5ndGg7IGorKykgew0KICAgICAg\nICAgICAgICAgIFN0cmluZ0J1ZmZlciBxdWVyeSA9IG5ldyBTdHJpbmdCdWZm\nZXIoc2VsZWN0V2hlcmUpOw0KDQogICAgICAgICAgICAgICAgZm9yIChpbnQg\nayA9IDA7IGsgPCBqOyBrKyspIHsNCiAgICAgICAgICAgICAgICAgICAgcXVl\ncnkuYXBwZW5kKG1hcE5hbWVzW2tdICsgIi5pc0VtcHR5KCkgJiYgIik7DQog\nICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgcSA9IHBtLmNy\nZWF0ZVF1ZXJ5KEpET1FMLA0KICAgICAgICAgICAgICAgICAgICBxdWVyeSAr\nIG1hcE5hbWUgKyAiLmdldCg6a2V5KSA9PSA6dmFsIik7DQogICAgICAgICAg\nICAgICAgcS5zZXRQYXJhbWV0ZXIoImtleSIsIGtleSk7DQogICAgICAgICAg\nICAgICAgcS5zZXRQYXJhbWV0ZXIoInZhbCIsIHBjKTsNCiAgICAgICAgICAg\nICAgICBhc3NlcnRTaXplKG1heCAtIGkgLSAxLCBxLmdldFJlc3VsdExpc3Qo\nKSk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgZW5kRW0o\ncG0pOw0KICAgIH0NCn0NCg==\n","encoding":"base64"}

