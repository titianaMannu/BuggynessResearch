{"sha":"f1530abc0afa2deab4dd59d45a6c451b81bc1eb3","node_id":"MDQ6QmxvYjIwNjM2NDpmMTUzMGFiYzBhZmEyZGVhYjRkZDU5ZDQ1YTZjNDUxYjgxYmMxZWIz","size":7777,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/f1530abc0afa2deab4dd59d45a6c451b81bc1eb3","content":"LyoNCiAqIFRlc3RRdWVyaWVzLmphdmENCiAqDQogKiBDcmVhdGVkIG9uIE9j\ndG9iZXIgMTMsIDIwMDYsIDQ6MjcgUE0NCiAqDQogKiBUbyBjaGFuZ2UgdGhp\ncyB0ZW1wbGF0ZSwgY2hvb3NlIFRvb2xzIHwgVGVtcGxhdGUgTWFuYWdlcg0K\nICogYW5kIG9wZW4gdGhlIHRlbXBsYXRlIGluIHRoZSBlZGl0b3IuDQogKi8N\nCg0KLyoNCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91\nbmRhdGlvbiAoQVNGKSB1bmRlciBvbmUNCiAqIG9yIG1vcmUgY29udHJpYnV0\nb3IgbGljZW5zZSBhZ3JlZW1lbnRzLiAgU2VlIHRoZSBOT1RJQ0UgZmlsZQ0K\nICogZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwg\naW5mb3JtYXRpb24NCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlw\nLiAgVGhlIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUNCiAqIHRvIHlvdSB1bmRl\nciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUNCiAqICJM\naWNlbnNlIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGlu\nIGNvbXBsaWFuY2UNCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9i\ndGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQNCiAqDQogKiBodHRwOi8v\nd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjANCiAqDQogKiBV\nbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRv\nIGluIHdyaXRpbmcsDQogKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0\naGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbg0KICogIkFTIElTIiBC\nQVNJUywgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5Z\nDQogKiBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRo\nZSBMaWNlbnNlIGZvciB0aGUNCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVy\nbmluZyBwZXJtaXNzaW9ucyBhbmQgbGltaXRhdGlvbnMNCiAqIHVuZGVyIHRo\nZSBMaWNlbnNlLiAgICANCiAqLw0KcGFja2FnZSBvcmcuYXBhY2hlLm9wZW5q\ncGEucGVyc2lzdGVuY2Uua2VybmVsOw0KDQppbXBvcnQgamF2YS51dGlsLkNv\nbGxlY3Rpb247DQppbXBvcnQgamF2YS51dGlsLkl0ZXJhdG9yOw0KDQoNCg0K\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5rZXJuZWwu\nY29tbW9uLmFwcHMuUnVudGltZVRlc3QxOw0KaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS5wZXJzaXN0ZW5jZS5rZXJuZWwuY29tbW9uLmFwcHMuUnVudGlt\nZVRlc3QyOw0KDQppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNpc3Rl\nbmNlLkV4dGVudDsNCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lz\ndGVuY2UuT3BlbkpQQUVudGl0eU1hbmFnZXI7DQppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLnBlcnNpc3RlbmNlLk9wZW5KUEFRdWVyeTsNCg0KcHVibGlj\nIGNsYXNzIFRlc3RRdWVyaWVzIGV4dGVuZHMgQmFzZUtlcm5lbFRlc3Qgew0K\nDQogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgaW50IENISUxEX0NPVU5UID0g\nMzsNCiAgICBwcml2YXRlIGludCBpZCA9IDEwMDAwOw0KDQogICAgcHVibGlj\nIFRlc3RRdWVyaWVzKFN0cmluZyBuYW1lKSB7DQogICAgICAgIHN1cGVyKG5h\nbWUpOw0KICAgIH0NCg0KICAgIHB1YmxpYyBUZXN0UXVlcmllcygpIHsNCiAg\nICB9DQoNCiAgICBwdWJsaWMgdm9pZCBzZXRVcCgpDQogICAgICAgIHRocm93\ncyBFeGNlcHRpb24gew0KICAgICAgICBzdXBlci5zZXRVcCgpOw0KICAgICAg\nICBkZWxldGVBbGwoUnVudGltZVRlc3QxLmNsYXNzKTsNCiAgICB9DQoNCiAg\nICBwdWJsaWMgdm9pZCB0ZXN0U2ltcGxlUXVlcnkoKSB7DQogICAgICAgIE9w\nZW5KUEFFbnRpdHlNYW5hZ2VyIHBtID0gZ2V0UE0oKTsNCg0KICAgICAgICBw\nZXJzaXN0KG5ld1J1bnRpbWVUZXN0MSgiU2ltcGxlUXVlcnlBIiwgNTApLCBw\nbSk7DQogICAgICAgIHBlcnNpc3QobmV3UnVudGltZVRlc3QyKCJTaW1wbGVR\ndWVyeUIiLCA1MCksIHBtKTsNCg0KICAgICAgICBDb2xsZWN0aW9uIHJlc3Vs\ndHMgPSBydW5RdWVyeShSdW50aW1lVGVzdDEuY2xhc3MsIGZhbHNlLA0KICAg\nICAgICAgICAgInN0cmluZ0ZpZWxkID0gXCdTaW1wbGVRdWVyeUFcJyIsIHBt\nKTsNCiAgICAgICAgYXNzZXJ0RXF1YWxzKDEsIHJlc3VsdHMuc2l6ZSgpKTsN\nCg0KICAgICAgICByZXN1bHRzID0gcnVuUXVlcnkoUnVudGltZVRlc3QxLmNs\nYXNzLCB0cnVlLCAiaW50RmllbGQxID0gNTAiLCBwbSk7DQogICAgICAgIGFz\nc2VydEVxdWFscygyLCByZXN1bHRzLnNpemUoKSk7DQoNCiAgICAgICAgcmVz\ndWx0cyA9IHJ1blF1ZXJ5KFJ1bnRpbWVUZXN0Mi5jbGFzcywgdHJ1ZSwgImlu\ndEZpZWxkMSA9IDUwIiwgcG0pOw0KICAgICAgICBhc3NlcnRFcXVhbHMoMSwg\ncmVzdWx0cy5zaXplKCkpOw0KDQogICAgICAgIHJlc3VsdHMgPSBydW5RdWVy\neShSdW50aW1lVGVzdDIuY2xhc3MsIGZhbHNlLCAiaW50RmllbGQxID0gNTAi\nLCBwbSk7DQogICAgICAgIGFzc2VydEVxdWFscygxLCByZXN1bHRzLnNpemUo\nKSk7DQoNCiAgICAgICAgZW5kRW0ocG0pOw0KICAgIH0NCg0KICAgIHB1Ymxp\nYyB2b2lkIHRlc3RBbmRRdWVyeSgpIHsNCiAgICAgICAgU3RyaW5nIHF1ZXJ5\nID0gImludEZpZWxkMSA+IDEwIEFORCBvLmludEZpZWxkMSA8IDUwIjsNCg0K\nICAgICAgICBmb3IgKGludCBjdXJyZW50Q291bnQgPSAxOyBjdXJyZW50Q291\nbnQgPCAxNTsgY3VycmVudENvdW50KyspIHsNCiAgICAgICAgICAgIE9wZW5K\nUEFFbnRpdHlNYW5hZ2VyIHBtID0gZ2V0UE0oKTsNCg0KICAgICAgICAgICAg\nLy8gbWFrZSBzdXJlIHRoYXQgbm9uZSBleGlzdA0KICAgICAgICAgICAgZGVs\nZXRlQnlRdWVyeShSdW50aW1lVGVzdDEuY2xhc3MsIGZhbHNlLCBxdWVyeSwg\ncG0pOw0KDQogICAgICAgICAgICBzdGFydFR4KHBtKTsNCiAgICAgICAgICAg\nIGZvciAoaW50IGkgPSAxOyBpIDw9IGN1cnJlbnRDb3VudDsgaSsrKQ0KICAg\nICAgICAgICAgICAgIHBtLnBlcnNpc3QobmV3UnVudGltZVRlc3QxKCJBbmRR\ndWVyeVRlc3QiLCAzMCArIGkpKTsNCiAgICAgICAgICAgIGVuZFR4KHBtKTsN\nCg0KICAgICAgICAgICAgLy8gdmVyaWZ5IHRoYXQgdGhlIHF1ZXJ5IHdvcmtz\nLg0KICAgICAgICAgICAgQ29sbGVjdGlvbiByZXN1bHRzID0gcnVuUXVlcnko\nUnVudGltZVRlc3QxLmNsYXNzLCBmYWxzZSwNCiAgICAgICAgICAgICAgICBx\ndWVyeSwgcG0pOw0KICAgICAgICAgICAgYXNzZXJ0RXF1YWxzKGN1cnJlbnRD\nb3VudCwgcmVzdWx0cy5zaXplKCkpOw0KICAgICAgICAgICAgZW5kRW0ocG0p\nOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgcHVibGljIHZvaWQgdGVzdFJl\nbGF0aW9uUXVlcnkoKSB7DQogICAgICAgIHJlbGF0aW9uUXVlcnkoMTAsICJK\nT0UiLCAyMCk7DQogICAgICAgIHJlbGF0aW9uUXVlcnkoOTksICJCT0IiLCAy\nKTsNCiAgICAgICAgcmVsYXRpb25RdWVyeSgzLCAiTUFSVEhBIiwgMSk7DQog\nICAgICAgIHJlbGF0aW9uUXVlcnkoNSwgImJyZW5kYSIsIDQzKTsNCiAgICAg\nICAgcmVsYXRpb25RdWVyeSg0MywgIlNhckEiLCA1NSk7DQogICAgfQ0KDQog\nICAgcHVibGljIHZvaWQgcmVsYXRpb25RdWVyeShpbnQgaW50RmllbGQsIFN0\ncmluZyBzdHJpbmdGaWVsZCwgaW50IGNvdW50KSB7DQogICAgICAgIE9wZW5K\nUEFFbnRpdHlNYW5hZ2VyIHBtID0gZ2V0UE0oKTsNCg0KICAgICAgICBTdHJp\nbmcgcXVlcnkgPSAic2VsZk9uZU9uZS5pbnRGaWVsZDEgPSAiICsgaW50Rmll\nbGQNCiAgICAgICAgICAgICsgIiBBTkQgby5zZWxmT25lT25lLnN0cmluZ0Zp\nZWxkID0gJyIgKyBzdHJpbmdGaWVsZCArICInIjsNCiAgICAgICAgZGVsZXRl\nQnlRdWVyeShSdW50aW1lVGVzdDEuY2xhc3MsIHRydWUsIHF1ZXJ5LCBwbSk7\nDQoNCiAgICAgICAgLy8gd2UgZ28gdXAgdGhlIHRvIG1heCBjb3VudCwgYWRk\naW5nIHRvIHRoZSBwZW9wbGUsIGFuZCB2YWxpZGF0ZQ0KICAgICAgICAvLyB3\naXRoIGEgcXVlcnkgZWFjaCB0aW1lLg0KICAgICAgICBmb3IgKGludCBjdXJy\nZW50Y291bnQgPSAwOyBjdXJyZW50Y291bnQgPD0gY291bnQ7IGN1cnJlbnRj\nb3VudCsrKSB7DQogICAgICAgICAgICBpZiAoY3VycmVudGNvdW50ICE9IDAp\nDQogICAgICAgICAgICAgICAgcGVyc2lzdChuZXdSdW50aW1lVGVzdDIoc3Ry\naW5nRmllbGQsIGludEZpZWxkKSwgcG0pOw0KDQogICAgICAgICAgICBDb2xs\nZWN0aW9uIHJlc3VsdHMgPSBydW5RdWVyeShSdW50aW1lVGVzdDEuY2xhc3Ms\nIHRydWUsIHF1ZXJ5LCBwbSk7DQogICAgICAgICAgICBhc3NlcnRFcXVhbHMo\nInF1ZXJ5ICgiICsgcXVlcnkgKyAiKSBmYWlsZWQgdG8geWllbGQgIg0KICAg\nICAgICAgICAgICAgICsgY3VycmVudGNvdW50ICsgIiBpbnN0YW5jZXMiLA0K\nICAgICAgICAgICAgICAgIGN1cnJlbnRjb3VudCAqIENISUxEX0NPVU5ULCBy\nZXN1bHRzLnNpemUoKSk7DQogICAgICAgIH0NCg0KICAgICAgICBlbmRFbShw\nbSk7DQogICAgfQ0KDQogICAgcHVibGljIHZvaWQgdGVzdFF1ZXJ5RXhlY3V0\nZVRocm93c0V4Y2VwdGlvbldoZW5Ob05UUigpIHsNCiAgICAgICAgT3BlbkpQ\nQUVudGl0eU1hbmFnZXIgcG0gPSBnZXRQTSgpOw0KICAgICAgICBzdGFydFR4\nKHBtKTsNCiAgICAgICAgcG0ucGVyc2lzdChuZXdSdW50aW1lVGVzdDEoIlF1\nZXJ5IiwgMTApKTsNCiAgICAgICAgZW5kVHgocG0pOw0KDQogICAgICAgIHBt\nLnNldE5vbnRyYW5zYWN0aW9uYWxSZWFkKGZhbHNlKTsNCi8vICAgICAgICBP\ncGVuSlBBUXVlcnkgcSA9IHBtLmNyZWF0ZU5hdGl2ZVF1ZXJ5KCIiLFJ1bnRp\nbWVUZXN0MS5jbGFzcyk7DQogICAgICAgIE9wZW5KUEFRdWVyeSBxID0gcG0u\nY3JlYXRlUXVlcnkoIlNFTEVDVCBvIEZST00gUnVudGltZVRlc3QxIG8iKTsN\nCiAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgIENvbGxlY3Rpb24gYyA9IChD\nb2xsZWN0aW9uKSBxLmdldFJlc3VsdExpc3QoKTsNCiAgICAgICAgICAgIGZh\naWwoIlF1ZXJ5LmV4ZWN1dGUoKSBzaG91bGQgaGF2ZSB0aHJvd24gYSBKRE9F\neGNlcHRpb24gd2hlbiAiDQogICAgICAgICAgICAgICAgKyAiUE0gaXMgb3V0\nc2lkZSBhIFRyYW5zYWN0aW9uIGFuZCBOVFI9PWZhbHNlIik7DQogICAgICAg\nIH0gY2F0Y2ggKEV4Y2VwdGlvbiBqZG9lKSB7DQogICAgICAgICAgICAvLyBn\nb29kDQogICAgICAgICAgICBzdGFydFR4KHBtKTsNCiAgICAgICAgICAgIHEu\nZ2V0UmVzdWx0TGlzdCgpOw0KICAgICAgICAgICAgcm9sbGJhY2tUeChwbSk7\nDQogICAgICAgIH0NCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiBEZWxldGUg\ndGhlIHJlc3VsdHMgb2YgYSBxdWVyeSwgc28gd2UgY2FuIHJlaW5zZXJ0IGFu\nZCB0ZXN0Lg0KICAgICAqLw0KICAgIHByaXZhdGUgdm9pZCBkZWxldGVCeVF1\nZXJ5KENsYXNzIHR5cGUsIGJvb2xlYW4gc3VicywgU3RyaW5nIGZpbHRlciwN\nCiAgICAgICAgT3BlbkpQQUVudGl0eU1hbmFnZXIgcG0pIHsNCiAgICAgICAg\nc3RhcnRUeChwbSk7DQogICAgICAgIEV4dGVudCBleHRlbnQgPSBwbS5jcmVh\ndGVFeHRlbnQodHlwZSwgc3Vicyk7DQogICAgICAgIC8vRklYTUUganRob21h\ncw0KLy8gICAgICAgIE9wZW5KUEFRdWVyeSBxdWVyeSA9IHBtLm5ld1F1ZXJ5\nKGV4dGVudCwgZmlsdGVyKTsNCi8vICAgICAgICBDb2xsZWN0aW9uIGl0ZW1z\nID0gKENvbGxlY3Rpb24pIHF1ZXJ5LmV4ZWN1dGUoKTsNCiAgICAgICAgU3Ry\naW5nIGNzdHJuZyA9IHR5cGUuZ2V0U2ltcGxlTmFtZSgpOw0KDQogICAgICAg\nIE9wZW5KUEFRdWVyeSBxdWVyeSA9DQogICAgICAgICAgICBwbS5jcmVhdGVR\ndWVyeSgiU0VMRUNUIG8gRlJPTSAiICsgY3N0cm5nICsgIiBvIFdIRVJFIG8u\nIiArIGZpbHRlcik7DQogICAgICAgIHF1ZXJ5LnNldFN1YmNsYXNzZXMoc3Vi\ncyk7DQogICAgICAgIENvbGxlY3Rpb24gaXRlbXMgPSAoQ29sbGVjdGlvbikg\ncXVlcnkuZ2V0UmVzdWx0TGlzdCgpOw0KICAgICAgICBmb3IgKEl0ZXJhdG9y\nIGkgPSBpdGVtcy5pdGVyYXRvcigpOyBpLmhhc05leHQoKTspDQogICAgICAg\nICAgICBwbS5yZW1vdmUoaS5uZXh0KCkpOw0KDQogICAgICAgIC8vRklYTUUg\nanRob21hcw0KICAgICAgICAvL3F1ZXJ5ID0gcG0ubmV3UXVlcnkoZXh0ZW50\nLCBmaWx0ZXIpOw0KDQogICAgICAgIHF1ZXJ5ID0NCiAgICAgICAgICAgIHBt\nLmNyZWF0ZVF1ZXJ5KCJTRUxFQ1QgbyBGUk9NICIgKyBjc3RybmcgKyAiIG8g\nV0hFUkUgby4iICsgZmlsdGVyKTsNCiAgICAgICAgcXVlcnkuc2V0U3ViY2xh\nc3NlcyhzdWJzKTsNCiAgICAgICAgaXRlbXMgPSBxdWVyeS5nZXRSZXN1bHRM\naXN0KCk7DQogICAgICAgIGVuZFR4KHBtKTsNCiAgICAgICAgYXNzZXJ0RXF1\nYWxzKCJhZnRlciBkZWxldGluZyBmcm9tIHF1ZXJ5ICgiICsgcXVlcnkNCiAg\nICAgICAgICAgICsgIiksIHRoZXJlIHNob3VsZCBoYXZlIGJlZW4gemVybyBp\ndGVtcyIsDQogICAgICAgICAgICAwLCBpdGVtcy5zaXplKCkpOw0KICAgIH0N\nCg0KICAgIHByaXZhdGUgQ29sbGVjdGlvbiBydW5RdWVyeShDbGFzcyB0eXBl\nLCBib29sZWFuIHN1YnMsIFN0cmluZyBmaWx0ZXIsDQogICAgICAgIE9wZW5K\nUEFFbnRpdHlNYW5hZ2VyIHBtKSB7DQogICAgICAgIEV4dGVudCBleHRlbnQg\nPSBwbS5jcmVhdGVFeHRlbnQodHlwZSwgc3Vicyk7DQogICAgICAgIC8vRklY\nTUUganRob21hcw0KICAgICAgICAvL1F1ZXJ5IHF1ZXJ5ID0gcG0ubmV3UXVl\ncnkoZXh0ZW50LCBmaWx0ZXIpOw0KICAgICAgICBTdHJpbmcgY3N0cm5nID0g\ndHlwZS5nZXROYW1lKCk7DQogICAgICAgIE9wZW5KUEFRdWVyeSBxdWVyeSA9\nDQogICAgICAgICAgICBwbS5jcmVhdGVRdWVyeSgiU0VMRUNUIG8gRlJPTSAi\nICsgY3N0cm5nICsgIiBvIFdIRVJFIG8uIiArIGZpbHRlcik7DQogICAgICAg\nIHF1ZXJ5LnNldFN1YmNsYXNzZXMoc3Vicyk7DQogICAgICAgIENvbGxlY3Rp\nb24gcmVzdWx0cyA9IChDb2xsZWN0aW9uKSBxdWVyeS5nZXRSZXN1bHRMaXN0\nKCk7DQogICAgICAgIHJldHVybiByZXN1bHRzOw0KICAgIH0NCg0KICAgIHBy\naXZhdGUgdm9pZCBwZXJzaXN0KFJ1bnRpbWVUZXN0MSBwYXJlbnQsIE9wZW5K\nUEFFbnRpdHlNYW5hZ2VyIHBtKSB7DQogICAgICAgIFJ1bnRpbWVUZXN0MSBj\naGlsZDsNCiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBDSElMRF9DT1VO\nVDsgaSsrKSB7DQogICAgICAgICAgICBjaGlsZCA9IG5ld1J1bnRpbWVUZXN0\nMSgiQ0hJTEQiICsgaSwgaSAqIDEwKTsNCiAgICAgICAgICAgIGNoaWxkLnNl\ndFNlbGZPbmVPbmUocGFyZW50KTsNCiAgICAgICAgICAgIHBhcmVudC5nZXRT\nZWxmT25lTWFueSgpLmFkZChjaGlsZCk7DQogICAgICAgIH0NCg0KICAgICAg\nICBzdGFydFR4KHBtKTsNCiAgICAgICAgcG0ucGVyc2lzdChwYXJlbnQpOw0K\nICAgICAgICBlbmRUeChwbSk7DQogICAgfQ0KDQogICAgcHJpdmF0ZSBSdW50\naW1lVGVzdDEgbmV3UnVudGltZVRlc3QxKFN0cmluZyBzdHJpbmdGaWVsZCwg\naW50IGludEZpZWxkKSB7DQogICAgICAgIFJ1bnRpbWVUZXN0MSBwYyA9IG5l\ndyBSdW50aW1lVGVzdDEoc3RyaW5nRmllbGQsIGludEZpZWxkKTsNCiAgICAg\nICAgcGMuc2V0SW50RmllbGQoaWQrKyk7DQogICAgICAgIHJldHVybiBwYzsN\nCiAgICB9DQoNCiAgICBwcml2YXRlIFJ1bnRpbWVUZXN0MiBuZXdSdW50aW1l\nVGVzdDIoU3RyaW5nIHN0cmluZ0ZpZWxkLCBpbnQgaW50RmllbGQpIHsNCiAg\nICAgICAgUnVudGltZVRlc3QyIHBjID0gbmV3IFJ1bnRpbWVUZXN0MihzdHJp\nbmdGaWVsZCwgaW50RmllbGQpOw0KICAgICAgICBwYy5zZXRJbnRGaWVsZChp\nZCsrKTsNCiAgICAgICAgcmV0dXJuIHBjOw0KICAgIH0NCn0NCg==\n","encoding":"base64"}

