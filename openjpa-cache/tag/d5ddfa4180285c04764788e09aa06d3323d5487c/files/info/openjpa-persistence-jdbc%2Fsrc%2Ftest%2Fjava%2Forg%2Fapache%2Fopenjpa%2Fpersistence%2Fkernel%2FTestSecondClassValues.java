{"sha":"96ede50ea7398bce241cd63157cac157238c3064","node_id":"MDQ6QmxvYjIwNjM2NDo5NmVkZTUwZWE3Mzk4YmNlMjQxY2Q2MzE1N2NhYzE1NzIzOGMzMDY0","size":26754,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/96ede50ea7398bce241cd63157cac157238c3064","content":"LyoNCiAqIFRlc3RTZWNvbmRDbGFzc1ZhbHVlcy5qYXZhDQogKg0KICogQ3Jl\nYXRlZCBvbiBPY3RvYmVyIDEzLCAyMDA2LCA1OjI5IFBNDQogKg0KICogVG8g\nY2hhbmdlIHRoaXMgdGVtcGxhdGUsIGNob29zZSBUb29scyB8IFRlbXBsYXRl\nIE1hbmFnZXINCiAqIGFuZCBvcGVuIHRoZSB0ZW1wbGF0ZSBpbiB0aGUgZWRp\ndG9yLg0KICovDQovKg0KICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0\nd2FyZSBGb3VuZGF0aW9uIChBU0YpIHVuZGVyIG9uZQ0KICogb3IgbW9yZSBj\nb250cmlidXRvciBsaWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElD\nRSBmaWxlDQogKiBkaXN0cmlidXRlZCB3aXRoIHRoaXMgd29yayBmb3IgYWRk\naXRpb25hbCBpbmZvcm1hdGlvbg0KICogcmVnYXJkaW5nIGNvcHlyaWdodCBv\nd25lcnNoaXAuICBUaGUgQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQ0KICogdG8g\neW91IHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRo\nZQ0KICogIkxpY2Vuc2UiKTsgeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBl\neGNlcHQgaW4gY29tcGxpYW5jZQ0KICogd2l0aCB0aGUgTGljZW5zZS4gIFlv\ndSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdA0KICoNCiAq\nIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMA0K\nICoNCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBh\nZ3JlZWQgdG8gaW4gd3JpdGluZywNCiAqIHNvZnR3YXJlIGRpc3RyaWJ1dGVk\nIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuDQogKiAi\nQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9O\nUyBPRiBBTlkNCiAqIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQu\nICBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZQ0KICogc3BlY2lmaWMgbGFuZ3Vh\nZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZCBsaW1pdGF0aW9ucw0KICog\ndW5kZXIgdGhlIExpY2Vuc2UuICAgIA0KICovDQpwYWNrYWdlIG9yZy5hcGFj\naGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5rZXJuZWw7DQoNCmltcG9ydCBqYXZh\nLm1hdGguQmlnRGVjaW1hbDsNCmltcG9ydCBqYXZhLm1hdGguQmlnSW50ZWdl\ncjsNCmltcG9ydCBqYXZhLnRleHQuQ29sbGF0b3I7DQppbXBvcnQgamF2YS51\ndGlsLkFycmF5TGlzdDsNCmltcG9ydCBqYXZhLnV0aWwuQ29sbGVjdGlvbjsN\nCmltcG9ydCBqYXZhLnV0aWwuQ29sbGVjdGlvbnM7DQppbXBvcnQgamF2YS51\ndGlsLkNvbXBhcmF0b3I7DQppbXBvcnQgamF2YS51dGlsLkRhdGU7DQppbXBv\ncnQgamF2YS51dGlsLkhhc2hNYXA7DQppbXBvcnQgamF2YS51dGlsLkl0ZXJh\ndG9yOw0KaW1wb3J0IGphdmEudXRpbC5MaW5rZWRMaXN0Ow0KaW1wb3J0IGph\ndmEudXRpbC5MaXN0Ow0KaW1wb3J0IGphdmEudXRpbC5NYXA7DQoNCg0KDQpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNlLmtlcm5lbC5j\nb21tb24uYXBwcy5TQ09UZXN0Ow0KaW1wb3J0IG9yZy5hcGFjaGUub3Blbmpw\nYS5wZXJzaXN0ZW5jZS5jb21tb24udXRpbHMuQWJzdHJhY3RUZXN0Q2FzZTsN\nCmltcG9ydCBqdW5pdC5mcmFtZXdvcmsuQXNzZXJ0aW9uRmFpbGVkRXJyb3I7\nDQoNCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuT3Bl\nbkpQQUVudGl0eU1hbmFnZXI7DQoNCnB1YmxpYyBjbGFzcyBUZXN0U2Vjb25k\nQ2xhc3NWYWx1ZXMgZXh0ZW5kcyBCYXNlS2VybmVsVGVzdCB7DQoNCiAgICBw\ndWJsaWMgc3RhdGljIGRvdWJsZSBET1VCTEVfUFJFQ0lTSU9OID0gMC4wMDAx\nRDsNCiAgICBwdWJsaWMgc3RhdGljIGZsb2F0IEZMT0FUX1BSRUNJU0lPTiA9\nIDAuMDAwMUY7DQogICAgLy8gbXBydWRob206IHVzZSBvcHRpbWlzdGljIHNv\nIHdlIGRvbid0IGhhbmcgb24gc29tZSBkYXRhYmFzZXMNCiAgICBwcml2YXRl\nIE9wZW5KUEFFbnRpdHlNYW5hZ2VyIHBtOw0KDQogICAgcHJpdmF0ZSBTdHJp\nbmcgbmV3bGluZSA9IFN5c3RlbS5nZXRQcm9wZXJ0eSgibGluZS5zZXBhcmF0\nb3IiKTsNCg0KICAgIC8qKg0KICAgICAqIENyZWF0ZXMgYSBuZXcgaW5zdGFu\nY2Ugb2YgVGVzdFNlY29uZENsYXNzVmFsdWVzDQogICAgICovDQogICAgcHVi\nbGljIFRlc3RTZWNvbmRDbGFzc1ZhbHVlcygpIHsNCiAgICB9DQoNCiAgICBw\ndWJsaWMgVGVzdFNlY29uZENsYXNzVmFsdWVzKFN0cmluZyBuYW1lKSB7DQog\nICAgICAgIHN1cGVyKG5hbWUpOw0KICAgIH0NCg0KICAgIHB1YmxpYyB2b2lk\nIHNldFVwKCkgew0KICAgICAgICBwbSA9IGdldFBNKHRydWUsIGZhbHNlKTsN\nCiAgICB9DQoNCiAgICBwcml2YXRlIGludCBybmQoKSB7DQogICAgICAgIHJl\ndHVybiAoKGludCkgKE1hdGgucmFuZG9tKCkgKiAyMCkpICsgNTsNCiAgICB9\nDQoNCiAgICBwdWJsaWMgdm9pZCB0ZXN0TWFwRGVsZXRpb24oKSB7DQogICAg\nICAgIE9wZW5KUEFFbnRpdHlNYW5hZ2VyIHBtOw0KICAgICAgICBwbSA9IGdl\ndFBNKCk7DQogICAgICAgIHN0YXJ0VHgocG0pOw0KICAgICAgICBTQ09UZXN0\nIHRlc3QgPSBuZXcgU0NPVGVzdCgpOw0KICAgICAgICBwbS5wZXJzaXN0KHRl\nc3QpOw0KICAgICAgICBNYXAgbWFwID0gbmV3IEhhc2hNYXAoKTsNCiAgICAg\nICAgbWFwLnB1dCgiZm9vIiwgbmV3IEludGVnZXIoMSkpOw0KICAgICAgICBt\nYXAucHV0KCJiYXIiLCBuZXcgSW50ZWdlcigyKSk7DQogICAgICAgIGZvciAo\naW50IGkgPSAwOyBpIDwgMTA7IGkrKykNCiAgICAgICAgICAgIG1hcC5wdXQo\nImJheiMiICsgaSwgbmV3IEludGVnZXIoaSkpOw0KDQogICAgICAgIHRlc3Qu\nc2V0U3RySW50TWFwKG1hcCk7DQogICAgICAgIE9iamVjdCBpZCA9IHBtLmdl\ndE9iamVjdElkKHRlc3QpOw0KICAgICAgICBlbmRUeChwbSk7DQoNCiAgICAg\nICAgc3RhcnRUeChwbSk7DQogICAgICAgIHRlc3QgPSAoU0NPVGVzdCkgcG0u\nZmluZChTQ09UZXN0LmNsYXNzLCBpZCk7DQogICAgICAgIGFzc2VydE5vdE51\nbGwodGVzdCk7DQogICAgICAgIG1hcCA9IHRlc3QuZ2V0U3RySW50TWFwKCk7\nDQogICAgICAgIGFzc2VydEVxdWFscygxMiwgbWFwLnNpemUoKSk7DQogICAg\nICAgIGFzc2VydEVxdWFscyhuZXcgSW50ZWdlcigxKSwgbWFwLmdldCgiZm9v\nIikpOw0KICAgICAgICBhc3NlcnRFcXVhbHMobmV3IEludGVnZXIoMiksIG1h\ncC5nZXQoImJhciIpKTsNCiAgICAgICAgbWFwLnJlbW92ZSgiYmFyIik7DQog\nICAgICAgIGVuZFR4KHBtKTsNCg0KICAgICAgICBzdGFydFR4KHBtKTsNCiAg\nICAgICAgdGVzdCA9IChTQ09UZXN0KSBwbS5maW5kKFNDT1Rlc3QuY2xhc3Ms\nIGlkKTsNCiAgICAgICAgYXNzZXJ0Tm90TnVsbCh0ZXN0KTsNCiAgICAgICAg\nbWFwID0gdGVzdC5nZXRTdHJJbnRNYXAoKTsNCiAgICAgICAgYXNzZXJ0RXF1\nYWxzKDExLCBtYXAuc2l6ZSgpKTsNCiAgICAgICAgYXNzZXJ0RXF1YWxzKG5l\ndyBJbnRlZ2VyKDEpLCBtYXAuZ2V0KCJmb28iKSk7DQogICAgICAgIGFzc2Vy\ndFRydWUobWFwLmdldCgiYmFyIikgPT0gbnVsbCk7DQoNCiAgICAgICAgbWFw\nLmNsZWFyKCk7DQoNCiAgICAgICAgZW5kVHgocG0pOw0KDQogICAgICAgIHN0\nYXJ0VHgocG0pOw0KICAgICAgICB0ZXN0ID0gKFNDT1Rlc3QpIHBtLmZpbmQo\nU0NPVGVzdC5jbGFzcywgaWQpOw0KICAgICAgICBhc3NlcnROb3ROdWxsKHRl\nc3QpOw0KICAgICAgICBtYXAgPSB0ZXN0LmdldFN0ckludE1hcCgpOw0KICAg\nICAgICBhc3NlcnRFcXVhbHMoMCwgbWFwLnNpemUoKSk7DQogICAgICAgIGVu\nZFR4KHBtKTsNCiAgICB9DQoNCiAgICBwdWJsaWMgdm9pZCB0ZXN0U3RyaW5n\nQ29sbGVjdGlvbigpDQogICAgICAgIHRocm93cyBFeGNlcHRpb24gew0KICAg\nICAgICBBcnJheUxpc3QgbGlzdCA9IG5ldyBBcnJheUxpc3QoKTsNCiAgICAg\nICAgZm9yIChpbnQgaSA9IDA7IGkgPCBybmQoKTsgaSsrKQ0KICAgICAgICAg\nICAgbGlzdC5hZGQocmFuZG9tU3RyaW5nKCkpOw0KDQogICAgICAgIHNhdmVT\nZWNvbmRDbGFzc0NvbGxlY3Rpb24obGlzdCk7DQogICAgfQ0KDQogICAgcHVi\nbGljIHZvaWQgdGVzdExvbmdDb2xsZWN0aW9uKCkNCiAgICAgICAgdGhyb3dz\nIEV4Y2VwdGlvbiB7DQogICAgICAgIEFycmF5TGlzdCBsaXN0ID0gbmV3IEFy\ncmF5TGlzdCgpOw0KICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IHJuZCgp\nOyBpKyspDQogICAgICAgICAgICBsaXN0LmFkZChyYW5kb21Mb25nKCkpOw0K\nICAgICAgICB0cnkgew0KICAgICAgICAgICAgc2F2ZVNlY29uZENsYXNzQ29s\nbGVjdGlvbihsaXN0KTsNCiAgICAgICAgfSBjYXRjaCAoQXNzZXJ0aW9uRmFp\nbGVkRXJyb3IgYWZlKSB7DQogICAgICAgICAgICBidWcoQWJzdHJhY3RUZXN0\nQ2FzZS5QbGF0Zm9ybS5FTVBSRVNTLCA4ODksIGFmZSwNCiAgICAgICAgICAg\nICAgICAiRW1wcmVzcyBjYW5ub3Qgc3RvcmUgbGFyZ2UgbG9uZyB2YWx1ZXMi\nKTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIHB1YmxpYyB2b2lkIHRlc3RT\naG9ydENvbGxlY3Rpb24oKQ0KICAgICAgICB0aHJvd3MgRXhjZXB0aW9uIHsN\nCiAgICAgICAgQXJyYXlMaXN0IGxpc3QgPSBuZXcgQXJyYXlMaXN0KCk7DQog\nICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgcm5kKCk7IGkrKykNCiAgICAg\nICAgICAgIGxpc3QuYWRkKHJhbmRvbVNob3J0KCkpOw0KICAgICAgICBzYXZl\nU2Vjb25kQ2xhc3NDb2xsZWN0aW9uKGxpc3QpOw0KICAgIH0NCg0KICAgIHB1\nYmxpYyB2b2lkIHRlc3RCaWdJbnRlZ2VyQ29sbGVjdGlvbigpDQogICAgICAg\nIHRocm93cyBFeGNlcHRpb24gew0KICAgICAgICBBcnJheUxpc3QgbGlzdCA9\nIG5ldyBBcnJheUxpc3QoKTsNCiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkg\nPCBybmQoKTsgaSsrKQ0KICAgICAgICAgICAgbGlzdC5hZGQocmFuZG9tQmln\nSW50ZWdlcigpKTsNCiAgICAgICAgc2F2ZVNlY29uZENsYXNzQ29sbGVjdGlv\nbihsaXN0KTsNCiAgICB9DQoNCiAgICBwdWJsaWMgdm9pZCB0ZXN0QmlnRGVj\naW1hbENvbGxlY3Rpb24oKQ0KICAgICAgICB0aHJvd3MgRXhjZXB0aW9uIHsN\nCiAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgIEFycmF5TGlzdCBsaXN0ID0g\nbmV3IEFycmF5TGlzdCgpOw0KICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7\nIGkgPCBybmQoKTsgaSsrKQ0KICAgICAgICAgICAgICAgIGxpc3QuYWRkKHJh\nbmRvbUJpZ0RlY2ltYWwoKSk7DQogICAgICAgICAgICBzYXZlU2Vjb25kQ2xh\nc3NDb2xsZWN0aW9uKGxpc3QpOw0KICAgICAgICB9IGNhdGNoIChBc3NlcnRp\nb25GYWlsZWRFcnJvciBlKSB7DQogICAgICAgICAgICBidWcoMywgZSwgIlBy\nZWNpc2lvbiBsb3NzIGZvciBCaWdEZWNpbWFscyIpOw0KICAgICAgICB9DQog\nICAgfQ0KDQogICAgcHVibGljIHZvaWQgdGVzdEludGVnZXJDb2xsZWN0aW9u\nKCkNCiAgICAgICAgdGhyb3dzIEV4Y2VwdGlvbiB7DQogICAgICAgIEFycmF5\nTGlzdCBsaXN0ID0gbmV3IEFycmF5TGlzdCgpOw0KICAgICAgICBmb3IgKGlu\ndCBpID0gMDsgaSA8IHJuZCgpOyBpKyspDQogICAgICAgICAgICBsaXN0LmFk\nZChyYW5kb21JbnQoKSk7DQogICAgICAgIHNhdmVTZWNvbmRDbGFzc0NvbGxl\nY3Rpb24obGlzdCk7DQogICAgfQ0KDQogICAgcHVibGljIHZvaWQgdGVzdEJ5\ndGVDb2xsZWN0aW9uKCkNCiAgICAgICAgdGhyb3dzIEV4Y2VwdGlvbiB7DQog\nICAgICAgIEFycmF5TGlzdCBsaXN0ID0gbmV3IEFycmF5TGlzdCgpOw0KICAg\nICAgICBmb3IgKGludCBpID0gMDsgaSA8IHJuZCgpOyBpKyspDQogICAgICAg\nICAgICBsaXN0LmFkZChyYW5kb21CeXRlKCkpOw0KICAgICAgICBzYXZlU2Vj\nb25kQ2xhc3NDb2xsZWN0aW9uKGxpc3QpOw0KICAgIH0NCg0KICAgIHB1Ymxp\nYyB2b2lkIHRlc3RCb29sZWFuQ29sbGVjdGlvbigpDQogICAgICAgIHRocm93\ncyBFeGNlcHRpb24gew0KICAgICAgICBBcnJheUxpc3QgbGlzdCA9IG5ldyBB\ncnJheUxpc3QoKTsNCiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBybmQo\nKTsgaSsrKQ0KICAgICAgICAgICAgbGlzdC5hZGQocmFuZG9tQm9vbGVhbigp\nKTsNCiAgICAgICAgc2F2ZVNlY29uZENsYXNzQ29sbGVjdGlvbihsaXN0LCB0\ncnVlKTsNCiAgICB9DQoNCiAgICBwdWJsaWMgdm9pZCB0ZXN0RmxvYXRDb2xs\nZWN0aW9uKCkNCiAgICAgICAgdGhyb3dzIEV4Y2VwdGlvbiB7DQogICAgICAg\nIHRyeSB7DQogICAgICAgICAgICBBcnJheUxpc3QgbGlzdCA9IG5ldyBBcnJh\neUxpc3QoKTsNCiAgICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgcm5k\nKCk7IGkrKykNCiAgICAgICAgICAgICAgICBsaXN0LmFkZChyYW5kb21GbG9h\ndCgpKTsNCiAgICAgICAgICAgIHNhdmVTZWNvbmRDbGFzc0NvbGxlY3Rpb24o\nbGlzdCk7DQogICAgICAgIH0gY2F0Y2ggKEFzc2VydGlvbkZhaWxlZEVycm9y\nIGFmZSkgew0KICAgICAgICAgICAgYnVnKDMsIGFmZSwgIkxvc3Mgb2YgQmln\nRGVjaW1hbCBwcmVjaXNpb24iKTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAg\nIHB1YmxpYyB2b2lkIHRlc3REb3VibGVDb2xsZWN0aW9uKCkNCiAgICAgICAg\ndGhyb3dzIEV4Y2VwdGlvbiB7DQogICAgICAgIHRyeSB7DQogICAgICAgICAg\nICBBcnJheUxpc3QgbGlzdCA9IG5ldyBBcnJheUxpc3QoKTsNCiAgICAgICAg\nICAgIGZvciAoaW50IGkgPSAwOyBpIDwgcm5kKCk7IGkrKykNCiAgICAgICAg\nICAgICAgICBsaXN0LmFkZChyYW5kb21Eb3VibGUoKSk7DQogICAgICAgICAg\nICBzYXZlU2Vjb25kQ2xhc3NDb2xsZWN0aW9uKGxpc3QpOw0KICAgICAgICB9\nIGNhdGNoIChBc3NlcnRpb25GYWlsZWRFcnJvciBhZmUpIHsNCiAgICAgICAg\nICAgIGJ1ZygzLCBhZmUsICJMb3NzIG9mIEJpZ0RlY2ltYWwgcHJlY2lzaW9u\nIik7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICBwdWJsaWMgdm9pZCB0ZXN0\nRGF0ZUNvbGxlY3Rpb24oKQ0KICAgICAgICB0aHJvd3MgRXhjZXB0aW9uIHsN\nCiAgICAgICAgQXJyYXlMaXN0IGxpc3QgPSBuZXcgQXJyYXlMaXN0KCk7DQog\nICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgcm5kKCk7IGkrKykNCiAgICAg\nICAgICAgIGxpc3QuYWRkKHJhbmRvbURhdGUoKSk7DQoNCiAgICAgICAgbGlz\ndC5hZGQobmV3IERhdGUoNDcyMjQ2ODAwMDAwTCkpOw0KDQogICAgICAgIHNh\ndmVTZWNvbmRDbGFzc0NvbGxlY3Rpb24obGlzdCk7DQogICAgfQ0KDQogICAg\ncHVibGljIHZvaWQgdGVzdEJpZ0RlY2ltYWxCaWdJbnRlZ2VyTWFwKCkNCiAg\nICAgICAgdGhyb3dzIEV4Y2VwdGlvbiB7DQogICAgICAgIHRyeSB7DQogICAg\nICAgICAgICBIYXNoTWFwIG1hcCA9IG5ldyBIYXNoTWFwKCk7DQogICAgICAg\nICAgICBmb3IgKGludCBpID0gMDsgaSA8IHJuZCgpOyBpKyspDQogICAgICAg\nICAgICAgICAgbWFwLnB1dChyYW5kb21CaWdEZWNpbWFsKCksIHJhbmRvbUJp\nZ0ludGVnZXIoKSk7DQogICAgICAgICAgICBzYXZlU2Vjb25kQ2xhc3NNYXAo\nbWFwKTsNCiAgICAgICAgfSBjYXRjaCAoQXNzZXJ0aW9uRmFpbGVkRXJyb3Ig\nZSkgew0KICAgICAgICAgICAgYnVnKDMsIGUsICJQcmVjaXNpb24gbG9zcyBm\nb3IgQmlnRGVjaW1hbHMiKTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIHB1\nYmxpYyB2b2lkIHRlc3RTdHJJbnRNYXAoKQ0KICAgICAgICB0aHJvd3MgRXhj\nZXB0aW9uIHsNCiAgICAgICAgSGFzaE1hcCBtYXAgPSBuZXcgSGFzaE1hcCgp\nOw0KICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IHJuZCgpOyBpKyspDQog\nICAgICAgICAgICBtYXAucHV0KHJhbmRvbVN0cmluZygpLCByYW5kb21JbnQo\nKSk7DQogICAgICAgIHNhdmVTZWNvbmRDbGFzc01hcChtYXApOw0KICAgIH0N\nCg0KICAgIHB1YmxpYyB2b2lkIHRlc3RJbnRMb25nTWFwKCkgdGhyb3dzIEV4\nY2VwdGlvbiB7DQogICAgICAgIEhhc2hNYXAgbWFwID0gbmV3IEhhc2hNYXAo\nKTsNCiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBybmQoKTsgaSsrKQ0K\nICAgICAgICAgICAgbWFwLnB1dChyYW5kb21JbnQoKSwgcmFuZG9tTG9uZygp\nKTsNCiAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgIHNhdmVTZWNvbmRDbGFz\nc01hcChtYXApOw0KICAgICAgICB9DQogICAgICAgIGNhdGNoIChBc3NlcnRp\nb25GYWlsZWRFcnJvciBhZmUpIHsNCiAgICAgICAgICAgIGJ1ZyhBYnN0cmFj\ndFRlc3RDYXNlLlBsYXRmb3JtLkVNUFJFU1MsIDg4OSwgYWZlLA0KICAgICAg\nICAgICAgICAgICJFbXByZXNzIGNhbm5vdCBzdG9yZSBsYXJnZSBsb25nIHZh\nbHVlcyIpOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgcHVibGljIHZvaWQg\ndGVzdEZsb2F0Qnl0ZU1hcCgpDQogICAgICAgIHRocm93cyBFeGNlcHRpb24g\new0KICAgICAgICB0cnkgew0KICAgICAgICAgICAgSGFzaE1hcCBtYXAgPSBu\nZXcgSGFzaE1hcCgpOw0KICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkg\nPCBybmQoKTsgaSsrKQ0KICAgICAgICAgICAgICAgIG1hcC5wdXQocmFuZG9t\nRmxvYXQoKSwgcmFuZG9tQnl0ZSgpKTsNCiAgICAgICAgICAgIHNhdmVTZWNv\nbmRDbGFzc01hcChtYXApOw0KICAgICAgICB9IGNhdGNoIChBc3NlcnRpb25G\nYWlsZWRFcnJvciBhZmUpIHsNCiAgICAgICAgICAgIGJ1ZygzLCBhZmUsICJM\nb3NzIG9mIEJpZ0RlY2ltYWwgcHJlY2lzaW9uIik7DQogICAgICAgIH0NCiAg\nICB9DQoNCiAgICBwdWJsaWMgdm9pZCB0ZXN0Qnl0ZURvdWJsZU1hcCgpDQog\nICAgICAgIHRocm93cyBFeGNlcHRpb24gew0KICAgICAgICB0cnkgew0KICAg\nICAgICAgICAgSGFzaE1hcCBtYXAgPSBuZXcgSGFzaE1hcCgpOw0KICAgICAg\nICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBybmQoKTsgaSsrKQ0KICAgICAg\nICAgICAgICAgIG1hcC5wdXQocmFuZG9tQnl0ZSgpLCByYW5kb21Eb3VibGUo\nKSk7DQogICAgICAgICAgICBzYXZlU2Vjb25kQ2xhc3NNYXAobWFwKTsNCiAg\nICAgICAgfSBjYXRjaCAoQXNzZXJ0aW9uRmFpbGVkRXJyb3IgYWZlKSB7DQog\nICAgICAgICAgICBidWcoMywgYWZlLCAiTG9zcyBvZiBCaWdEZWNpbWFsIHBy\nZWNpc2lvbiIpOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgcHVibGljIHZv\naWQgdGVzdERvdWJsZUNoYXJNYXAoKQ0KICAgICAgICB0aHJvd3MgRXhjZXB0\naW9uIHsNCiAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgIEhhc2hNYXAgbWFw\nID0gbmV3IEhhc2hNYXAoKTsNCiAgICAgICAgICAgIGZvciAoaW50IGkgPSAw\nOyBpIDwgcm5kKCk7IGkrKykNCiAgICAgICAgICAgICAgICBtYXAucHV0KHJh\nbmRvbURvdWJsZSgpLCByYW5kb21DaGFyKCkpOw0KICAgICAgICAgICAgc2F2\nZVNlY29uZENsYXNzTWFwKG1hcCk7DQogICAgICAgIH0gY2F0Y2ggKEFzc2Vy\ndGlvbkZhaWxlZEVycm9yIGFmZSkgew0KICAgICAgICAgICAgYnVnKDMsIGFm\nZSwgIkxvc3Mgb2YgQmlnRGVjaW1hbCBwcmVjaXNpb24iKTsNCiAgICAgICAg\nfQ0KICAgIH0NCg0KICAgIHB1YmxpYyB2b2lkIHRlc3RDaGFyQm9vbGVhbk1h\ncCgpDQogICAgICAgIHRocm93cyBFeGNlcHRpb24gew0KICAgICAgICBIYXNo\nTWFwIG1hcCA9IG5ldyBIYXNoTWFwKCk7DQogICAgICAgIGZvciAoaW50IGkg\nPSAwOyBpIDwgcm5kKCk7IGkrKykNCiAgICAgICAgICAgIG1hcC5wdXQocmFu\nZG9tQ2hhcigpLCByYW5kb21Cb29sZWFuKCkpOw0KICAgICAgICBzYXZlU2Vj\nb25kQ2xhc3NNYXAobWFwKTsNCiAgICB9DQoNCiAgICBwdWJsaWMgdm9pZCB0\nZXN0RGF0ZVN0ck1hcCgpIHRocm93cyBFeGNlcHRpb24gew0KICAgICAgICBI\nYXNoTWFwIG1hcCA9IG5ldyBIYXNoTWFwKCk7DQogICAgICAgIGZvciAoaW50\nIGkgPSAwOyBpIDwgcm5kKCk7IGkrKykNCiAgICAgICAgICAgIG1hcC5wdXQo\ncmFuZG9tRGF0ZSgpLCByYW5kb21TdHJpbmcoKSk7DQoNCiAgICAgICAgbWFw\nLnB1dChuZXcgRGF0ZSg0NzIyNDY4MDAwMDBMKSwNCiAgICAgICAgICAgICJQ\nb3N0Z3JlU1FMIGFpbid0IGdvbm5hIGxpa2UgdGhpcyBkYXRlIik7DQogICAg\nICAgIGFzc2VydE5vdE51bGwoIm1hcCBpcyBudWxsIHRlc3REYXRlU3RyTWFw\nIiwgbWFwKTsNCiAgICAgICAgc2F2ZVNlY29uZENsYXNzTWFwKG1hcCk7DQog\nICAgfQ0KDQogICAgcHJpdmF0ZSB2b2lkIHNhdmVTZWNvbmRDbGFzc01hcChI\nYXNoTWFwIG1hcCkNCiAgICAgICAgdGhyb3dzIEV4Y2VwdGlvbiB7DQogICAg\nICAgIHRyeSB7DQogICAgICAgICAgICBzYXZlU2Vjb25kQ2xhc3NNYXBJbnRl\ncm5hbChtYXApOw0KICAgICAgICB9IGZpbmFsbHkgew0KICAgICAgICAgICAg\nY29tbWl0KCk7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICBwcml2YXRlIHZv\naWQgY29tbWl0KCkgew0KICAgICAgICB0cnkgew0KICAgICAgICAgICAgYXNz\nZXJ0Tm90TnVsbChwbSk7DQoNCi8vICAJCUVudGl0eVRyYW5zYWN0aW9uIHRy\nYW5zID0gcG0uZ2V0VHJhbnNhY3Rpb24oKTsNCi8vICAJCWlmICh0cmFucyAh\nPSBudWxsICYmIHRyYW5zLmlzQWN0aXZlKCkpIHsNCi8vICAJCXRyYW5zLmNv\nbW1pdCgpOw0KICAgICAgICAgICAgZW5kVHgocG0pOw0KICAgICAgICB9DQog\nICAgICAgIGNhdGNoIChFeGNlcHRpb24gZSkgew0KICAgICAgICAgICAgZS5w\ncmludFN0YWNrVHJhY2UoKTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIHBy\naXZhdGUgdm9pZCBiZWdpbigpIHsNCiAgICAgICAgY29tbWl0KCk7IC8vIG1h\na2Ugc3VyZSB3ZSBhcmUgY2xlYW4NCg0KICAgICAgICAvLyBnZXQgYSBmcmVz\naCBQTQ0KICAgICAgICBwbSA9IGdldFBNKHRydWUsIGZhbHNlKTsNCiAgICAg\nICAgc3RhcnRUeChwbSk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICogU2F2\nZSB0aGUgc3BlY2lmaWVkIG1hcCBhcyBhIHNlY29uZC1jbGFzcyBvYmplY3Qg\nYW5kIHZhbGlkYXRlDQogICAgICogaXRzIGNvbnRlbnRzIGJ5IHJlYWRpbmcg\nYmFjayBpbiB0aGUgb2JqZWN0IGFuZCBjb21wYXJpbmcNCiAgICAgKiBhbGwg\ndGhlIHZhbHVlcyB0byB0aGUgb3JpZ2luYWwuIEZ1cnRoZXJtb3JlLCB0aGlz\nIG1ldGhvZA0KICAgICAqIGRlbGV0ZXMgZWFjaCBlbGVtZW50IG9mIGJvdGgg\nbWFwcyBpbiB0dXJuIGFuZCByZS12YWxpZGF0ZXMNCiAgICAgKiBlYWNoIHRp\nbWUgdG8gbWFrZSBzdXJlIHVwZGF0aW5nIG9mIHRoZSBtYXAgaXMgd29ya2lu\nZyBjb3JyZWN0bHkuDQogICAgICovDQogICAgcHJpdmF0ZSB2b2lkIHNhdmVT\nZWNvbmRDbGFzc01hcEludGVybmFsKEhhc2hNYXAgbWFwKSB0aHJvd3MgRXhj\nZXB0aW9uIHsNCiAgICAgICAgYmVnaW4oKTsNCiAgICAgICAgU0NPVGVzdCB0\nZXN0ID0gbmV3IFNDT1Rlc3QoKTsNCiAgICAgICAgcG0ucGVyc2lzdCh0ZXN0\nKTsNCiAgICAgICAgaW50IHRlc3RJRCA9IHRlc3QuZ2V0SWQoKTsNCiAgICAg\nICAgYXNzZXJ0Tm90TnVsbCgiUGFzc2VkIE1hcCBpcyBudWxsIiwgbWFwKTsN\nCiAgICAgICAgTWFwIHNtYXAgPSBzZXRHZXRNYXAodGVzdCwgbWFwLCB0cnVl\nKTsNCiAgICAgICAgYXNzZXJ0Tm90TnVsbCgiTWFwIGlzIG51bGwgaW4gc2V0\nR2V0TWFwIiwgc21hcCk7DQogICAgICAgIGNvbW1pdCgpOw0KDQogICAgICAg\nIGZvciAoSXRlcmF0b3IgbWFwS2V5ID0gKChIYXNoTWFwKSBtYXAuY2xvbmUo\nKSkua2V5U2V0KCkuaXRlcmF0b3IoKTsNCiAgICAgICAgICAgIG1hcEtleS5o\nYXNOZXh0KCk7KSB7DQogICAgICAgICAgICBPYmplY3Qga2V5VG9EZWxldGUg\nPSBtYXBLZXkubmV4dCgpOw0KDQogICAgICAgICAgICBiZWdpbigpOw0KICAg\nICAgICAgICAgU0NPVGVzdCByZXRyaWV2ZWRPYmplY3QgPQ0KICAgICAgICAg\nICAgICAgIChTQ09UZXN0KSBwbS5maW5kKFNDT1Rlc3QuY2xhc3MsIHRlc3RJ\nRCk7DQoNCiAgICAgICAgICAgIGFzc2VydE5vdE51bGwoDQogICAgICAgICAg\nICAgICAgInJldHJpZXZlZE9iamVjdCBPYmogaXMgbnVsbCAtIHNhdmVTZWNv\nbmRDbGFzc01hcEludGVybmFsIiwNCiAgICAgICAgICAgICAgICByZXRyaWV2\nZWRPYmplY3QpOw0KDQogICAgICAgICAgICBNYXAgcmV0cmlldmVkTWFwID0g\nc2V0R2V0TWFwKHJldHJpZXZlZE9iamVjdCwgbWFwLCBmYWxzZSk7DQoNCiAg\nICAgICAgICAgIGFzc2VydE5vdE51bGwoDQogICAgICAgICAgICAgICAgInJl\ndHJpZXZlZE1hcCBPYmogaXMgbnVsbCAtIHNhdmVTZWNvbmRDbGFzc01hcElu\ndGVybmFsIiwNCiAgICAgICAgICAgICAgICByZXRyaWV2ZWRNYXApOw0KDQog\nICAgICAgICAgICBhc3NlcnRUcnVlKG1hcC5zaXplKCkgIT0gMCk7DQogICAg\nICAgICAgICBhc3NlcnRFcXVhbHMobWFwLnNpemUoKSwgcmV0cmlldmVkTWFw\nLnNpemUoKSk7DQoNCiAgICAgICAgICAgIGFzc2VydFRydWUoIkluY29tcGF0\naWJsZSB0eXBlcyIsIG1hcC5rZXlTZXQoKS5pdGVyYXRvcigpLm5leHQoKS4N\nCiAgICAgICAgICAgICAgICBnZXRDbGFzcygpLmlzQXNzaWduYWJsZUZyb20o\ncmV0cmlldmVkTWFwLmtleVNldCgpLg0KICAgICAgICAgICAgICAgIGl0ZXJh\ndG9yKCkubmV4dCgpLmdldENsYXNzKCkpKTsNCg0KICAgICAgICAgICAgLy8g\nY2hlY2sgdG8gbWFrZSBzdXJlIGFsbCB0aGUga2V5cyBtYXRjaCB1cCB0byB0\naGUgYXBwcm9wcmlhdGUNCiAgICAgICAgICAgIC8vIHZhbHVlcy4NCiAgICAg\nICAgICAgIGZvciAoSXRlcmF0b3IgaSA9IG1hcC5rZXlTZXQoKS5pdGVyYXRv\ncigpOyBpLmhhc05leHQoKTspIHsNCiAgICAgICAgICAgICAgICBPYmplY3Qg\na2V5ID0gaS5uZXh0KCk7DQogICAgICAgICAgICAgICAgYXNzZXJ0VHJ1ZShr\nZXkgIT0gbnVsbCk7DQogICAgICAgICAgICAgICAgYXNzZXJ0VHJ1ZShtYXAu\nZ2V0KGtleSkgIT0gbnVsbCk7DQogICAgICAgICAgICAgICAgaWYgKGtleS5n\nZXRDbGFzcygpID09IERhdGUuY2xhc3MNCiAgICAgICAgICAgICAgICAgICAg\nJiYgcmV0cmlldmVkTWFwLmdldChrZXkpID09IG51bGwpIHsNCiAgICAgICAg\nICAgICAgICAgICAgZ2V0TG9nKCkudHJhY2UoIlRpbWU6ICINCiAgICAgICAg\nICAgICAgICAgICAgICAgICsgKCgoRGF0ZSkga2V5KS5nZXRUaW1lKCkpKTsN\nCiAgICAgICAgICAgICAgICAgICAgZ2V0TG9nKCkudHJhY2UoIkxpc3Q6ICIN\nCiAgICAgICAgICAgICAgICAgICAgICAgICsgZHVtcERhdGVzKHJldHJpZXZl\nZE1hcC5rZXlTZXQoKSkpOw0KDQogICAgICAgICAgICAgICAgICAgIC8qDQog\nICAgICAgICAgICAgICAgICAgICAgICBidWcgKDYsICJEYXRlcyBsb3NlIHBy\nZWNpc2lvbiBpbiBzb21lIGRhdGEgc3RvcmVzICINCiAgICAgICAgICAgICAg\nICAgICAgICAgICAgICArICIoIiArICgoKERhdGUpa2V5KS5nZXRUaW1lICgp\nKSArICIsIg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICsgIlsiICsg\nZHVtcERhdGVzIChyZXRyaWV2ZWRNYXAua2V5U2V0ICgpKSArICJdKSIpOw0K\nICAgICAgICAgICAgICAgICAgICAqLw0KICAgICAgICAgICAgICAgIH0NCiAg\nICAgICAgICAgICAgICBpZiAoKGtleS5nZXRDbGFzcygpID09IERvdWJsZS5j\nbGFzcyB8fA0KICAgICAgICAgICAgICAgICAgICBrZXkuZ2V0Q2xhc3MoKSA9\nPSBGbG9hdC5jbGFzcyB8fA0KICAgICAgICAgICAgICAgICAgICBrZXkuZ2V0\nQ2xhc3MoKSA9PSBCaWdEZWNpbWFsLmNsYXNzKQ0KICAgICAgICAgICAgICAg\nICAgICAmJiByZXRyaWV2ZWRNYXAuZ2V0KGtleSkgPT0gbnVsbCkgew0KICAg\nICAgICAgICAgICAgICAgICAvKg0KICAgICAgICAgICAgICAgICAgICAgICAg\nIGJ1ZyAoMywgIkRvdWJsZXMgYW5kIEZsb2F0cyAiDQogICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICsgIiBsb3NlIHByZWNpc2lvbiBpbiBzb21lIGRh\ndGEgc3RvcmVzIik7DQogICAgICAgICAgICAgICAgICAgICAqLw0KICAgICAg\nICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIGFzc2VydFRydWUoIlRo\nZSBvcmlnaW5hbCBtYXAgY29udGFpbmVkIHRoZSBvYmplY3QgKGNsYXNzPSIN\nCiAgICAgICAgICAgICAgICAgICAgKyBrZXkuZ2V0Q2xhc3MoKS5nZXROYW1l\nKCkgKyAiLCB2YWx1ZT0iDQogICAgICAgICAgICAgICAgICAgICsga2V5LnRv\nU3RyaW5nKCkgKyAiKSwgYnV0IHRoYXQgb2JqZWN0IHdhcyBudWxsICINCiAg\nICAgICAgICAgICAgICAgICAgKyAiaW4gdGhlIG1hcCB0aGF0IHdhcyByZXRy\naWV2ZWQgIg0KICAgICAgICAgICAgICAgICAgICArIGR1bXAocmV0cmlldmVk\nTWFwLmtleVNldCgpKSArICIuIiwNCiAgICAgICAgICAgICAgICAgICAgcmV0\ncmlldmVkTWFwLmdldChrZXkpICE9IG51bGwpOw0KICAgICAgICAgICAgICAg\nIGFzc2VydENsYXNzQW5kVmFsdWVFcXVhbHMoDQogICAgICAgICAgICAgICAg\nICAgIG1hcC5nZXQoa2V5KSwgcmV0cmlldmVkTWFwLmdldChrZXkpKTsNCiAg\nICAgICAgICAgIH0NCg0KICAgICAgICAgICAgLy8gbm93IGRlbGV0ZSB0aGUg\nZmlyc3Qga2V5IGluIGJvdGggbWFwcywgYW5kIG1ha2Ugc3VyZQ0KICAgICAg\nICAgICAgLy8gdGhpbmtzIGFyZSBzdGlsbCBPSy4NCiAgICAgICAgICAgIG1h\ncC5yZW1vdmUoa2V5VG9EZWxldGUpOw0KICAgICAgICAgICAgcmV0cmlldmVk\nTWFwLnJlbW92ZShrZXlUb0RlbGV0ZSk7DQogICAgICAgIH0NCiAgICB9DQoN\nCiAgICBwcml2YXRlIHZvaWQgc2F2ZVNlY29uZENsYXNzQ29sbGVjdGlvbihB\ncnJheUxpc3QgY29sbGVjdGlvbikNCiAgICAgICAgdGhyb3dzIEV4Y2VwdGlv\nbiB7DQogICAgICAgIHNhdmVTZWNvbmRDbGFzc0NvbGxlY3Rpb24oY29sbGVj\ndGlvbiwgZmFsc2UpOw0KICAgIH0NCg0KICAgIHByaXZhdGUgdm9pZCBzYXZl\nU2Vjb25kQ2xhc3NDb2xsZWN0aW9uKEFycmF5TGlzdCBjb2xsZWN0aW9uLA0K\nICAgICAgICBib29sZWFuIHVzZUN1c3RvbUNvbGxhdG9yKQ0KICAgICAgICB0\naHJvd3MgRXhjZXB0aW9uIHsNCiAgICAgICAgdHJ5IHsNCiAgICAgICAgICAg\nIHNhdmVTZWNvbmRDbGFzc0NvbGxlY3Rpb25JbnRlcm5hbChjb2xsZWN0aW9u\nLCB1c2VDdXN0b21Db2xsYXRvcik7DQogICAgICAgIH0gZmluYWxseSB7DQog\nICAgICAgICAgICBjb21taXQoKTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAg\nIHByaXZhdGUgdm9pZCBzYXZlU2Vjb25kQ2xhc3NDb2xsZWN0aW9uSW50ZXJu\nYWwoQXJyYXlMaXN0IGNvbGxlY3Rpb24sDQogICAgICAgIGJvb2xlYW4gdXNl\nQ3VzdG9tQ29sbGF0b3IpDQogICAgICAgIHRocm93cyBFeGNlcHRpb24gew0K\nICAgICAgICBPYmplY3QgZWxlbWVudFRvRGVsZXRlID0gbnVsbDsNCg0KICAg\nICAgICBpZiAodXNlQ3VzdG9tQ29sbGF0b3IpDQogICAgICAgICAgICBDb2xs\nZWN0aW9ucy5zb3J0KGNvbGxlY3Rpb24sDQogICAgICAgICAgICAgICAgbmV3\nIENvbGxlY3Rpb25Tb3J0ZXIoKSk7DQogICAgICAgIGVsc2UNCiAgICAgICAg\nICAgIENvbGxlY3Rpb25zLnNvcnQoY29sbGVjdGlvbik7DQoNCiAgICAgICAg\nT3BlbkpQQUVudGl0eU1hbmFnZXIgcG0xID0gZ2V0UE0oKTsNCiAgICAgICAg\nc3RhcnRUeChwbTEpOw0KDQogICAgICAgIFNDT1Rlc3QgdGVzdCA9IG5ldyBT\nQ09UZXN0KCk7DQogICAgICAgIHBtMS5wZXJzaXN0KHRlc3QpOw0KICAgICAg\nICBpbnQgdGVzdElEID0gdGVzdC5nZXRJZCgpOw0KDQogICAgICAgIENvbGxl\nY3Rpb24gc3RvcmVkQ29sbGVjdGlvbiA9IHNldEdldENvbGxlY3Rpb24odGVz\ndCwNCiAgICAgICAgICAgIChDb2xsZWN0aW9uKSAoKEFycmF5TGlzdCkgY29s\nbGVjdGlvbikuY2xvbmUoKSwgdHJ1ZSk7DQoNCiAgICAgICAgYXNzZXJ0Tm90\nTnVsbCgicmV0cmlldmVkIHN0b3JlZENvbGxlY3Rpb24gaXMgbnVsbCIsIHN0\nb3JlZENvbGxlY3Rpb24pOw0KDQogICAgICAgIC8vIG1ha2Ugc3VyZSB0aGUg\ncHJlLWNvbW1pdCBjb2xsZWN0aW9ucyBhcmUgaWRlbnRpY2FsIQ0KICAgICAg\nICBhc3NlcnRFcXVhbHMoIlByZS1jb21taXQgY29sbGVjdGlvbnMgd2VyZSBu\nb3QgZXF1YWw6ICIgKyBuZXdsaW5lDQogICAgICAgICAgICArIGR1bXAoY29s\nbGVjdGlvbikgKyBuZXdsaW5lICsgIiE9IiArIG5ld2xpbmUNCiAgICAgICAg\nICAgICsgZHVtcChzdG9yZWRDb2xsZWN0aW9uKSwNCiAgICAgICAgICAgIGNv\nbGxlY3Rpb24uc2l6ZSgpLCBzdG9yZWRDb2xsZWN0aW9uLnNpemUoKSk7DQoN\nCiAgICAgICAgZW5kVHgocG0xKTsNCg0KICAgICAgICBpbnQgZGVsZXRpb25J\nbmRleCA9IDA7DQoNCiAgICAgICAgT3BlbkpQQUVudGl0eU1hbmFnZXIgcG0y\nID0gZ2V0UE0oKTsNCg0KICAgICAgICB3aGlsZSAoY29sbGVjdGlvbi5zaXpl\nKCkgPiAwKSB7DQogICAgICAgICAgICBkZWxldGlvbkluZGV4Kys7DQoNCiAg\nICAgICAgICAgIHN0YXJ0VHgocG0yKTsNCiAgICAgICAgICAgIFNDT1Rlc3Qg\ncmV0cmlldmVkT2JqZWN0ID0NCiAgICAgICAgICAgICAgICAoU0NPVGVzdCkg\ncG0yLmZpbmQoU0NPVGVzdC5jbGFzcywgdGVzdElEKTsNCg0KICAgICAgICAg\nICAgYXNzZXJ0Tm90TnVsbCgNCiAgICAgICAgICAgICAgICAicmV0cmlldmVk\nIG9iaiBpcyBudWxsIHNhdmVTZWNvbmRDbGFzc0NvbGxlY3Rpb25JbnRlcm5h\nbCIsDQogICAgICAgICAgICAgICAgcmV0cmlldmVkT2JqZWN0KTsNCg0KICAg\nICAgICAgICAgQ29sbGVjdGlvbiBpZGVudGl0eUNvbGxlY3Rpb24gPSBuZXcg\nTGlua2VkTGlzdChjb2xsZWN0aW9uKTsNCiAgICAgICAgICAgIGFzc2VydE5v\ndE51bGwoDQogICAgICAgICAgICAgICAgImlkZW50aXR5Q29sbGVjdGlvbiBp\ncyBudWxsIHNhdmVTZWNvbmRDbGFzc0NvbGxlY3Rpb25JbnRlcm5hbCIsDQog\nICAgICAgICAgICAgICAgaWRlbnRpdHlDb2xsZWN0aW9uKTsNCiAgICAgICAg\nICAgIENvbGxlY3Rpb24gcmV0cmlldmVkQ29sbGVjdGlvbiA9IHNldEdldENv\nbGxlY3Rpb24oDQogICAgICAgICAgICAgICAgcmV0cmlldmVkT2JqZWN0LCBp\nZGVudGl0eUNvbGxlY3Rpb24sIGZhbHNlKTsNCg0KICAgICAgICAgICAgYXNz\nZXJ0Tm90TnVsbCgNCiAgICAgICAgICAgICAgICAicmV0cmlldmVkQ29sbGVj\ndGlvbiBpcyBudWxsIHNhdmVTZWNvbmRDbGFzc0NvbGxlY3Rpb25JbnRlcm5h\nbCIsDQogICAgICAgICAgICAgICAgcmV0cmlldmVkQ29sbGVjdGlvbik7DQoN\nCiAgICAgICAgICAgIHZhbGlkYXRlQ29sbGVjdGlvbihyZXRyaWV2ZWRDb2xs\nZWN0aW9uKTsNCg0KICAgICAgICAgICAgYXNzZXJ0Tm90TnVsbChyZXRyaWV2\nZWRDb2xsZWN0aW9uKTsNCiAgICAgICAgICAgIGFzc2VydFRydWUoY29sbGVj\ndGlvbi5zaXplKCkgIT0gMCk7DQoNCiAgICAgICAgICAgIGFzc2VydEVxdWFs\ncygiUmV0cmVpdmVkIGNvbGxlY3Rpb24gZG9lcyBub3QgbWF0Y2ggb3JpZ2lu\nYWwgIg0KICAgICAgICAgICAgICAgICsgImFmdGVyIHRoZSAiICsgZGVsZXRp\nb25JbmRleCArICJ0aCBkZWxldGlvbiAoIg0KICAgICAgICAgICAgICAgICsg\nZWxlbWVudFRvRGVsZXRlICsgIik6ICINCiAgICAgICAgICAgICAgICArIG5l\nd2xpbmUNCiAgICAgICAgICAgICAgICArIGR1bXAoY29sbGVjdGlvbikgKyBu\nZXdsaW5lICsgIiE9IiArIG5ld2xpbmUNCiAgICAgICAgICAgICAgICArIGR1\nbXAocmV0cmlldmVkQ29sbGVjdGlvbikgKyBuZXdsaW5lLA0KICAgICAgICAg\nICAgICAgIGNvbGxlY3Rpb24uc2l6ZSgpLCByZXRyaWV2ZWRDb2xsZWN0aW9u\nLnNpemUoKSk7DQoNCiAgICAgICAgICAgIC8qDQogICAgICAgICAgICB0cnkN\nCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICBhc3NlcnRFcXVhbHMg\nKGNvbGxlY3Rpb24uc2l6ZSByZXRyaWV2ZWRDb2xsZWN0aW9uLnNpemUgKCkp\nOw0KICAgICAgICAgICAgfSBjYXRjaCAoQXNzZXJ0aW9uRmFpbGVkRXJyb3Ig\nYWZlKSB7DQogICAgICAgICAgICAgICAgYnVnIChBYnN0cmFjdFRlc3RDYXNl\nLlBsYXRmb3JtLlNRTFNFUlZFUiwgMiwgYWZlLCAiU2Vjb25kLWNsYXNzIGNv\nbGxlY3Rpb25zIg0KICAgICAgICAgICAgICAgICAgICArICIgYXJlIG5vdCBi\nZWluZyByZXRyaWV2ZWQgY29ycmVjdGx5Iik7DQogICAgICAgICAgICB9DQog\nICAgICAgICAgICAqLw0KDQogICAgICAgICAgICAvLyBtYWtlIHN1cmUgdGhl\nIGNsYXNzZXMgb2YgdGhlIGtleXMgYXJlIHRoZSBzYW1lLg0KICAgICAgICAg\nICAgSXRlcmF0b3IgY2kgPSBjb2xsZWN0aW9uLml0ZXJhdG9yKCk7DQogICAg\nICAgICAgICBPYmplY3QgY28gPSBjb2xsZWN0aW9uLml0ZXJhdG9yKCkubmV4\ndCgpOw0KDQogICAgICAgICAgICBJdGVyYXRvciByY2kgPSByZXRyaWV2ZWRD\nb2xsZWN0aW9uLml0ZXJhdG9yKCk7DQogICAgICAgICAgICBPYmplY3QgcmNv\nID0gcmV0cmlldmVkQ29sbGVjdGlvbi5pdGVyYXRvcigpLm5leHQoKTsNCg0K\nICAgICAgICAgICAgYXNzZXJ0Tm90TnVsbChjbyk7DQogICAgICAgICAgICBh\nc3NlcnROb3ROdWxsKHJjbyk7DQogICAgICAgICAgICBhc3NlcnRFcXVhbHMo\nY28uZ2V0Q2xhc3MoKSwgcmNvLmdldENsYXNzKCkpOw0KDQogICAgICAgICAg\nICBMaXN0IHNvcnRlZFJldHJlaXZlZENvbGxlY3Rpb24gPQ0KICAgICAgICAg\nICAgICAgIG5ldyBBcnJheUxpc3QocmV0cmlldmVkQ29sbGVjdGlvbik7DQoN\nCiAgICAgICAgICAgIGlmICh1c2VDdXN0b21Db2xsYXRvcikNCiAgICAgICAg\nICAgICAgICBDb2xsZWN0aW9ucy5zb3J0KHNvcnRlZFJldHJlaXZlZENvbGxl\nY3Rpb24sDQogICAgICAgICAgICAgICAgICAgIG5ldyBDb2xsZWN0aW9uU29y\ndGVyKCkpOw0KICAgICAgICAgICAgZWxzZQ0KICAgICAgICAgICAgICAgIENv\nbGxlY3Rpb25zLnNvcnQoc29ydGVkUmV0cmVpdmVkQ29sbGVjdGlvbik7DQoN\nCiAgICAgICAgICAgIC8vIG1ha2Ugc3VyZSB0aGUgY29sbGVjdGlvbiBpcyBP\nSw0KICAgICAgICAgICAgZm9yIChJdGVyYXRvciBpID0gY29sbGVjdGlvbi5p\ndGVyYXRvcigpLA0KICAgICAgICAgICAgICAgIGogPSBzb3J0ZWRSZXRyZWl2\nZWRDb2xsZWN0aW9uLml0ZXJhdG9yKCk7DQogICAgICAgICAgICAgICAgaS5o\nYXNOZXh0KCkgJiYgai5oYXNOZXh0KCk7KSB7DQogICAgICAgICAgICAgICAg\nYXNzZXJ0Q2xhc3NBbmRWYWx1ZUVxdWFscyhpLm5leHQoKSwgai5uZXh0KCkp\nOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBlbGVtZW50VG9EZWxl\ndGUgPSBjb2xsZWN0aW9uLml0ZXJhdG9yKCkubmV4dCgpOw0KICAgICAgICAg\nICAgaWYgKCEoY29sbGVjdGlvbi5yZW1vdmUoZWxlbWVudFRvRGVsZXRlKSkp\nDQogICAgICAgICAgICAgICAgZmFpbCgiQ291bGQgbm90IGRlbGV0ZSBlbGVt\nZW50ICINCiAgICAgICAgICAgICAgICAgICAgKyAiKDwiICsgZWxlbWVudFRv\nRGVsZXRlLmdldENsYXNzKCkuZ2V0TmFtZSgpICsgIj4iDQogICAgICAgICAg\nICAgICAgICAgICsgZWxlbWVudFRvRGVsZXRlICsgIikgIg0KICAgICAgICAg\nICAgICAgICAgICArICJmcm9tICIgKyBkdW1wKGNvbGxlY3Rpb24pKTsNCg0K\nICAgICAgICAgICAgaWYgKCEocmV0cmlldmVkQ29sbGVjdGlvbi5yZW1vdmUo\nZWxlbWVudFRvRGVsZXRlKSkpDQogICAgICAgICAgICAgICAgZmFpbCgiQ291\nbGQgbm90IGRlbGV0ZSBlbGVtZW50ICgiICsgZWxlbWVudFRvRGVsZXRlICsg\nIikgIg0KICAgICAgICAgICAgICAgICAgICArICJmcm9tICIgKyBkdW1wKHJl\ndHJpZXZlZENvbGxlY3Rpb24pKTsNCg0KICAgICAgICAgICAgZW5kVHgocG0y\nKTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIHByaXZhdGUgdm9pZCBhc3Nl\ncnRDbGFzc0FuZFZhbHVlRXF1YWxzKE9iamVjdCBvMSwgT2JqZWN0IG8yKSB7\nDQogICAgICAgIGFzc2VydFRydWUoIkZpcnN0IG9iamVjdCB3YXMgbnVsbCIs\nIG8xICE9IG51bGwpOw0KICAgICAgICBhc3NlcnRUcnVlKCJTZWNvbmQgb2Jq\nZWN0IHdhcyBudWxsIiwgbzIgIT0gbnVsbCk7DQoNCiAgICAgICAgYXNzZXJ0\nVHJ1ZSgiVHlwZXMgZGlkIG5vdCBtYXRjaCAoY2xhc3MxPSINCiAgICAgICAg\nICAgICsgbzEuZ2V0Q2xhc3MoKS5nZXROYW1lKCkgKyAiLCBjbGFzczI9Ig0K\nICAgICAgICAgICAgKyBvMi5nZXRDbGFzcygpLmdldE5hbWUoKSArICIpIiwN\nCiAgICAgICAgICAgIG8xLmdldENsYXNzKCkuaXNBc3NpZ25hYmxlRnJvbShv\nMi5nZXRDbGFzcygpKSk7DQoNCiAgICAgICAgLy8gZmxvYXRzIGFuZCBkb3Vi\nbGVzIGFyZSBhIGxpdHRsZSBzcGVjaWFsOiB3ZSBvbmx5DQogICAgICAgIC8v\nIGNvbXBhcmUgdGhlbSB0byBhIGNlcnRhaW4gcHJlY2lzaW9uLCBhZnRlciB3\naGljaA0KICAgICAgICAvLyB3ZSBnaXZlIHVwLg0KICAgICAgICAvKg0KICAg\nICAgICAgIGlmIChvMSBpbnN0YW5jZW9mIERvdWJsZSkNCiAgICAgICAgICAg\nICAgYXNzZXJ0RXF1YWxzICgoKERvdWJsZSlvMSkuZG91YmxlVmFsdWUgKCks\nDQogICAgICAgICAgICAgICAgICAoKERvdWJsZSlvMikuZG91YmxlVmFsdWUg\nKCksDQogICAgICAgICAgICAgICAgICBET1VCTEVfUFJFQ0lTSU9OKTsNCiAg\nICAgICAgICBlbHNlIGlmIChvMSBpbnN0YW5jZW9mIEZsb2F0KQ0KICAgICAg\nICAgICAgICBhc3NlcnRFcXVhbHMgKCgoRmxvYXQpbzEpLmZsb2F0VmFsdWUg\nKCksDQogICAgICAgICAgICAgICAgICAoKEZsb2F0KW8yKS5mbG9hdFZhbHVl\nICgpLA0KICAgICAgICAgICAgICAgICAgRkxPQVRfUFJFQ0lTSU9OKTsNCiAg\nICAgICAgICBlbHNlIGlmIChvMSBpbnN0YW5jZW9mIEJpZ0RlY2ltYWwpDQog\nICAgICAgICAgICAgIC8vIEJpZ0RlY2ltYWwgZXF1YWxpc3QgaXMgYSBsaXR0\nbGUgc3BlY2lhbDogc2VlDQogICAgICAgICAgICAgIC8vIEpET1J1bnRpbWVU\nZXN0Q2FzZS5hc3NlcnRFcXVhbHMoQmlnRGVjaW1hbCxCaWdEZWNpbWFsKQ0K\nICAgICAgICAgICAgICBhc3NlcnRFcXVhbHMgKCJCaWdEZWNpbWFsIGRpZCBu\nb3QgbWF0Y2giLA0KICAgICAgICAgICAgICAgICAgKEJpZ0RlY2ltYWwpbzEs\nIChCaWdEZWNpbWFsKW8yKTsNCiAgICAgICAgICBlbHNlDQogICAgICAgICAq\nLw0KICAgICAgICBhc3NlcnRFcXVhbHMoIk9iamVjdCBkaWQgbm90IG1hdGNo\nIChjbGFzczE9Ig0KICAgICAgICAgICAgKyBvMS5nZXRDbGFzcygpLmdldE5h\nbWUoKSArICIsIGNsYXNzMj0iDQogICAgICAgICAgICArIG8yLmdldENsYXNz\nKCkuZ2V0TmFtZSgpICsgIikiLA0KICAgICAgICAgICAgbzEsIG8yKTsNCiAg\nICB9DQoNCiAgICBwcml2YXRlIFN0cmluZyBkdW1wKENvbGxlY3Rpb24gY29s\nbCkgew0KICAgICAgICBMaXN0IGxpc3QgPSBuZXcgTGlua2VkTGlzdChjb2xs\nKTsNCiAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgIENvbGxlY3Rpb25zLnNv\ncnQobGlzdCk7DQogICAgICAgIH0gY2F0Y2ggKFJ1bnRpbWVFeGNlcHRpb24g\nZSkgew0KDQogICAgICAgIH0NCg0KICAgICAgICBTdHJpbmdCdWZmZXIgYnVm\nID0gbmV3IFN0cmluZ0J1ZmZlcigpLmFwcGVuZCgiWyIpDQogICAgICAgICAg\nICAuYXBwZW5kKCIoc2l6ZT0iKS5hcHBlbmQobGlzdC5zaXplKCkpLmFwcGVu\nZCgiKSIpOw0KDQogICAgICAgIEl0ZXJhdG9yIGl0ID0gbGlzdC5pdGVyYXRv\ncigpOw0KICAgICAgICBpZiAoaXQuaGFzTmV4dCgpKQ0KICAgICAgICAgICAg\nYnVmLmFwcGVuZCgiPGNsYXNzPSIgKyBpdC5uZXh0KCkuZ2V0Q2xhc3MoKS5n\nZXROYW1lKCkgKyAiPiIpOw0KDQogICAgICAgIGZvciAoSXRlcmF0b3IgaSA9\nIGxpc3QuaXRlcmF0b3IoKTsgaS5oYXNOZXh0KCk7KQ0KICAgICAgICAgICAg\nYnVmLmFwcGVuZChpLm5leHQoKSkuYXBwZW5kKGkuaGFzTmV4dCgpID8gIiwi\nIDogIiIpOw0KDQogICAgICAgIHJldHVybiBidWYuYXBwZW5kKCJdIikudG9T\ndHJpbmcoKTsNCiAgICB9DQoNCiAgICBwcml2YXRlIFN0cmluZyBkdW1wRGF0\nZXMoQ29sbGVjdGlvbiBjb2xsKSB7DQogICAgICAgIFN0cmluZ0J1ZmZlciBi\ndWYgPSBuZXcgU3RyaW5nQnVmZmVyKCk7DQogICAgICAgIGZvciAoSXRlcmF0\nb3IgaSA9IGNvbGwuaXRlcmF0b3IoKTsgaS5oYXNOZXh0KCk7KQ0KICAgICAg\nICAgICAgYnVmLmFwcGVuZCgoKERhdGUpIGkubmV4dCgpKS5nZXRUaW1lKCkp\nLmFwcGVuZCgNCiAgICAgICAgICAgICAgICBpLmhhc05leHQoKSA/ICIsIiA6\nICIiKTsNCg0KICAgICAgICByZXR1cm4gYnVmLnRvU3RyaW5nKCk7DQogICAg\nfQ0KDQogICAgLyoqDQogICAgICogR2VuZXJpYyBzZXR0ZXIvZ2V0dGVyIGZv\nciBzZXR0aW5nIHRoZSBtYXBzIHB1cnBvc2VzLg0KICAgICAqLw0KICAgIHBy\naXZhdGUgTWFwIHNldEdldE1hcChTQ09UZXN0IHRlc3QsIEhhc2hNYXAgbWFw\nLCBib29sZWFuIGRvU2V0KSB7DQogICAgICAgIGlmIChtYXAgPT0gbnVsbCkN\nCiAgICAgICAgICAgIHJldHVybiBudWxsOw0KDQogICAgICAgIE9iamVjdCBr\nZXkgPSBtYXAua2V5U2V0KCkuaXRlcmF0b3IoKS5uZXh0KCk7DQogICAgICAg\nIE9iamVjdCB2YWwgPSBtYXAuZ2V0KGtleSk7DQoNCiAgICAgICAgaWYgKGtl\neSBpbnN0YW5jZW9mIERhdGUgJiYgdmFsIGluc3RhbmNlb2YgU3RyaW5nKSB7\nDQogICAgICAgICAgICBpZiAoZG9TZXQpDQogICAgICAgICAgICAgICAgdGVz\ndC5zZXREYXRlU3RyTWFwKG1hcCk7DQogICAgICAgICAgICByZXR1cm4gdGVz\ndC5nZXREYXRlU3RyTWFwKCk7DQogICAgICAgIH0gZWxzZSBpZiAoa2V5IGlu\nc3RhbmNlb2YgQ2hhcmFjdGVyICYmIHZhbCBpbnN0YW5jZW9mIEJvb2xlYW4p\nIHsNCiAgICAgICAgICAgIGlmIChkb1NldCkNCiAgICAgICAgICAgICAgICB0\nZXN0LnNldENoYXJCb29sZWFuTWFwKG1hcCk7DQogICAgICAgICAgICByZXR1\ncm4gdGVzdC5nZXRDaGFyQm9vbGVhbk1hcCgpOw0KICAgICAgICB9IGVsc2Ug\naWYgKGtleSBpbnN0YW5jZW9mIERvdWJsZSAmJiB2YWwgaW5zdGFuY2VvZiBD\naGFyYWN0ZXIpIHsNCiAgICAgICAgICAgIGlmIChkb1NldCkNCiAgICAgICAg\nICAgICAgICB0ZXN0LnNldERvdWJsZUNoYXJNYXAobWFwKTsNCiAgICAgICAg\nICAgIHJldHVybiB0ZXN0LmdldERvdWJsZUNoYXJNYXAoKTsNCiAgICAgICAg\nfSBlbHNlIGlmIChrZXkgaW5zdGFuY2VvZiBCeXRlICYmIHZhbCBpbnN0YW5j\nZW9mIERvdWJsZSkgew0KICAgICAgICAgICAgaWYgKGRvU2V0KQ0KICAgICAg\nICAgICAgICAgIHRlc3Quc2V0Qnl0ZURvdWJsZU1hcChtYXApOw0KICAgICAg\nICAgICAgcmV0dXJuIHRlc3QuZ2V0Qnl0ZURvdWJsZU1hcCgpOw0KICAgICAg\nICB9IGVsc2UgaWYgKGtleSBpbnN0YW5jZW9mIEZsb2F0ICYmIHZhbCBpbnN0\nYW5jZW9mIEJ5dGUpIHsNCiAgICAgICAgICAgIGlmIChkb1NldCkNCiAgICAg\nICAgICAgICAgICB0ZXN0LnNldEZsb2F0Qnl0ZU1hcChtYXApOw0KICAgICAg\nICAgICAgcmV0dXJuIHRlc3QuZ2V0RmxvYXRCeXRlTWFwKCk7DQogICAgICAg\nIH0gZWxzZSBpZiAoa2V5IGluc3RhbmNlb2YgTG9uZyAmJiB2YWwgaW5zdGFu\nY2VvZiBGbG9hdCkgew0KICAgICAgICAgICAgaWYgKGRvU2V0KQ0KICAgICAg\nICAgICAgICAgIHRlc3Quc2V0TG9uZ0Zsb2F0TWFwKG1hcCk7DQogICAgICAg\nICAgICByZXR1cm4gdGVzdC5nZXRMb25nRmxvYXRNYXAoKTsNCiAgICAgICAg\nfSBlbHNlIGlmIChrZXkgaW5zdGFuY2VvZiBJbnRlZ2VyICYmIHZhbCBpbnN0\nYW5jZW9mIExvbmcpIHsNCiAgICAgICAgICAgIGlmIChkb1NldCkNCiAgICAg\nICAgICAgICAgICB0ZXN0LnNldEludExvbmdNYXAobWFwKTsNCiAgICAgICAg\nICAgIHJldHVybiB0ZXN0LmdldEludExvbmdNYXAoKTsNCiAgICAgICAgfSBl\nbHNlIGlmIChrZXkgaW5zdGFuY2VvZiBTdHJpbmcgJiYgdmFsIGluc3RhbmNl\nb2YgSW50ZWdlcikgew0KICAgICAgICAgICAgaWYgKGRvU2V0KQ0KICAgICAg\nICAgICAgICAgIHRlc3Quc2V0U3RySW50TWFwKG1hcCk7DQogICAgICAgICAg\nICByZXR1cm4gdGVzdC5nZXRTdHJJbnRNYXAoKTsNCiAgICAgICAgfSBlbHNl\nIGlmIChrZXkgaW5zdGFuY2VvZiBCaWdEZWNpbWFsICYmIHZhbCBpbnN0YW5j\nZW9mIEJpZ0ludGVnZXIpIHsNCiAgICAgICAgICAgIGlmIChkb1NldCkNCiAg\nICAgICAgICAgICAgICB0ZXN0LnNldEJpZ0RlY2ltYWxCaWdJbnRlZ2VyTWFw\nKG1hcCk7DQogICAgICAgICAgICByZXR1cm4gdGVzdC5nZXRCaWdEZWNpbWFs\nQmlnSW50ZWdlck1hcCgpOw0KICAgICAgICB9DQoNCiAgICAgICAgZmFpbCgi\nVW5rbm93biBtYXAgdHlwZSIpOw0KICAgICAgICByZXR1cm4gbnVsbDsNCiAg\nICB9DQoNCiAgICAvKioNCiAgICAgKiBHZW5lcmljIHNldHRlci9nZXR0ZXIg\nZm9yIHNldHRpbmcgdGhlIGNvbGxlY3Rpb25zIHB1cnBvc2VzLg0KICAgICAq\nLw0KICAgIHByaXZhdGUgQ29sbGVjdGlvbiBzZXRHZXRDb2xsZWN0aW9uKFND\nT1Rlc3QgdGVzdCwNCiAgICAgICAgQ29sbGVjdGlvbiBjb2xsZWN0aW9uLCBi\nb29sZWFuIGRvU2V0KSB7DQogICAgICAgIGlmIChjb2xsZWN0aW9uID09IG51\nbGwpDQogICAgICAgICAgICByZXR1cm4gbnVsbDsNCg0KICAgICAgICBPYmpl\nY3QgZmlyc3QgPSBjb2xsZWN0aW9uLml0ZXJhdG9yKCkubmV4dCgpOw0KDQog\nICAgICAgIGlmIChmaXJzdCBpbnN0YW5jZW9mIEJpZ0ludGVnZXIpIHsNCiAg\nICAgICAgICAgIGlmIChkb1NldCkNCiAgICAgICAgICAgICAgICB0ZXN0LnNl\ndENCaWdJbnRlZ2VyKGNvbGxlY3Rpb24pOw0KICAgICAgICAgICAgcmV0dXJu\nIHRlc3QuZ2V0Q0JpZ0ludGVnZXIoKTsNCiAgICAgICAgfSBlbHNlIGlmIChm\naXJzdCBpbnN0YW5jZW9mIEJpZ0RlY2ltYWwpIHsNCiAgICAgICAgICAgIGlm\nIChkb1NldCkNCiAgICAgICAgICAgICAgICB0ZXN0LnNldENCaWdEZWNpbWFs\nKGNvbGxlY3Rpb24pOw0KICAgICAgICAgICAgcmV0dXJuIHRlc3QuZ2V0Q0Jp\nZ0RlY2ltYWwoKTsNCiAgICAgICAgfSBlbHNlIGlmIChmaXJzdCBpbnN0YW5j\nZW9mIERhdGUpIHsNCiAgICAgICAgICAgIGlmIChkb1NldCkNCiAgICAgICAg\nICAgICAgICB0ZXN0LnNldENEYXRlKGNvbGxlY3Rpb24pOw0KICAgICAgICAg\nICAgcmV0dXJuIHRlc3QuZ2V0Q0RhdGUoKTsNCiAgICAgICAgfSBlbHNlIGlm\nIChmaXJzdCBpbnN0YW5jZW9mIENoYXJhY3Rlcikgew0KICAgICAgICAgICAg\naWYgKGRvU2V0KQ0KICAgICAgICAgICAgICAgIHRlc3Quc2V0Q0NoYXJhY3Rl\ncihjb2xsZWN0aW9uKTsNCiAgICAgICAgICAgIHJldHVybiB0ZXN0LmdldEND\naGFyYWN0ZXIoKTsNCiAgICAgICAgfSBlbHNlIGlmIChmaXJzdCBpbnN0YW5j\nZW9mIERvdWJsZSkgew0KICAgICAgICAgICAgaWYgKGRvU2V0KQ0KICAgICAg\nICAgICAgICAgIHRlc3Quc2V0Q0RvdWJsZShjb2xsZWN0aW9uKTsNCiAgICAg\nICAgICAgIHJldHVybiB0ZXN0LmdldENEb3VibGUoKTsNCiAgICAgICAgfSBl\nbHNlIGlmIChmaXJzdCBpbnN0YW5jZW9mIEJ5dGUpIHsNCiAgICAgICAgICAg\nIGlmIChkb1NldCkNCiAgICAgICAgICAgICAgICB0ZXN0LnNldENCeXRlKGNv\nbGxlY3Rpb24pOw0KICAgICAgICAgICAgcmV0dXJuIHRlc3QuZ2V0Q0J5dGUo\nKTsNCiAgICAgICAgfSBlbHNlIGlmIChmaXJzdCBpbnN0YW5jZW9mIEZsb2F0\nKSB7DQogICAgICAgICAgICBpZiAoZG9TZXQpDQogICAgICAgICAgICAgICAg\ndGVzdC5zZXRDRmxvYXQoY29sbGVjdGlvbik7DQogICAgICAgICAgICByZXR1\ncm4gdGVzdC5nZXRDRmxvYXQoKTsNCiAgICAgICAgfSBlbHNlIGlmIChmaXJz\ndCBpbnN0YW5jZW9mIExvbmcpIHsNCiAgICAgICAgICAgIGlmIChkb1NldCkN\nCiAgICAgICAgICAgICAgICB0ZXN0LnNldENMb25nKGNvbGxlY3Rpb24pOw0K\nICAgICAgICAgICAgcmV0dXJuIHRlc3QuZ2V0Q0xvbmcoKTsNCiAgICAgICAg\nfSBlbHNlIGlmIChmaXJzdCBpbnN0YW5jZW9mIEludGVnZXIpIHsNCiAgICAg\nICAgICAgIGlmIChkb1NldCkNCiAgICAgICAgICAgICAgICB0ZXN0LnNldENJ\nbnRlZ2VyKGNvbGxlY3Rpb24pOw0KICAgICAgICAgICAgcmV0dXJuIHRlc3Qu\nZ2V0Q0ludGVnZXIoKTsNCiAgICAgICAgfSBlbHNlIGlmIChmaXJzdCBpbnN0\nYW5jZW9mIFN0cmluZykgew0KICAgICAgICAgICAgaWYgKGRvU2V0KQ0KICAg\nICAgICAgICAgICAgIHRlc3Quc2V0Q1N0cmluZyhjb2xsZWN0aW9uKTsNCiAg\nICAgICAgICAgIHJldHVybiB0ZXN0LmdldENTdHJpbmcoKTsNCiAgICAgICAg\nfSBlbHNlIGlmIChmaXJzdCBpbnN0YW5jZW9mIFNob3J0KSB7DQogICAgICAg\nICAgICBpZiAoZG9TZXQpDQogICAgICAgICAgICAgICAgdGVzdC5zZXRDU2hv\ncnQoY29sbGVjdGlvbik7DQogICAgICAgICAgICByZXR1cm4gdGVzdC5nZXRD\nU2hvcnQoKTsNCiAgICAgICAgfSBlbHNlIGlmIChmaXJzdCBpbnN0YW5jZW9m\nIEJvb2xlYW4pIHsNCiAgICAgICAgICAgIGlmIChkb1NldCkNCiAgICAgICAg\nICAgICAgICB0ZXN0LnNldENCb29sZWFuKGNvbGxlY3Rpb24pOw0KICAgICAg\nICAgICAgcmV0dXJuIHRlc3QuZ2V0Q0Jvb2xlYW4oKTsNCiAgICAgICAgfQ0K\nDQogICAgICAgIGZhaWwoIlVua25vd24gY29sbGVjdGlvbiB0eXBlIik7DQog\nICAgICAgIHJldHVybiBudWxsOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAq\nIEEgc2ltcGxlIHNvcnRlciB0aGF0IHNob3VsZCBhbHdheXMgcmV0dXJuIHRo\nZSBzYW1lIHNvcnQgb3JkZXIuDQogICAgICogVGhlIG9ubHkgcmVhc29uIHdl\nIG5lZWQgdGkgdXNlIHRoaXMsIGluc3RlYWQgb2YgcmVseWluZyBvbiB0aGUN\nCiAgICAgKiBuYXR1cmFsIG9yZGVyIGluIENvbGxlY3Rpb25zLnNvcnQgaXMg\ndGhhdCB0aGVyZSBzZWVtcyB0byBiZQ0KICAgICAqIGEgYnVnIHNvbWV3aGVy\nZSB0aGF0IHByZXZlbnRzIHNvcnRpbmcgb24gY29sbGVjdGlvbnMgb2YgQm9v\nbGVhbg0KICAgICAqIG9iamVjdHMuDQogICAgICovDQogICAgcHVibGljIHN0\nYXRpYyBjbGFzcyBDb2xsZWN0aW9uU29ydGVyDQogICAgICAgIGltcGxlbWVu\ndHMgQ29tcGFyYXRvciB7DQoNCiAgICAgICAgcHJpdmF0ZSBDb2xsYXRvciBj\nb2xsYXRvciA9IENvbGxhdG9yLmdldEluc3RhbmNlKCk7DQoNCiAgICAgICAg\ncHVibGljIENvbGxlY3Rpb25Tb3J0ZXIoKSB7DQoNCiAgICAgICAgfQ0KDQog\nICAgICAgIHB1YmxpYyBpbnQgY29tcGFyZShPYmplY3QgbzEsIE9iamVjdCBv\nMikgew0KICAgICAgICAgICAgaWYgKG8xICE9IG51bGwgJiYgIShvMSBpbnN0\nYW5jZW9mIEJvb2xlYW4pKQ0KICAgICAgICAgICAgICAgIHJldHVybiBjb2xs\nYXRvci5jb21wYXJlKG8xLCBvMik7DQoNCiAgICAgICAgICAgIHJldHVybiBj\nb2xsYXRvci5jb21wYXJlKG8xLnRvU3RyaW5nKCksIG8yLnRvU3RyaW5nKCkp\nOw0KICAgICAgICB9DQogICAgfQ0KfQ0K\n","encoding":"base64"}

