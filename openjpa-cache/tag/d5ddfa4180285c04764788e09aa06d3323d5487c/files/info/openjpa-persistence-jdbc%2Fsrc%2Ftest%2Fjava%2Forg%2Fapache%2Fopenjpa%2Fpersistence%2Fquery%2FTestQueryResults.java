{"sha":"6e7095f87d4f3db526e079171d0a790715935e7b","node_id":"MDQ6QmxvYjIwNjM2NDo2ZTcwOTVmODdkNGYzZGI1MjZlMDc5MTcxZDBhNzkwNzE1OTM1ZTdi","size":21477,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/6e7095f87d4f3db526e079171d0a790715935e7b","content":"LyoNCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUNCiAqIG9yIG1vcmUgY29udHJpYnV0b3Ig\nbGljZW5zZSBhZ3JlZW1lbnRzLiAgU2VlIHRoZSBOT1RJQ0UgZmlsZQ0KICog\nZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5m\nb3JtYXRpb24NCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAg\nVGhlIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUNCiAqIHRvIHlvdSB1bmRlciB0\naGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUNCiAqICJMaWNl\nbnNlIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNv\nbXBsaWFuY2UNCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFp\nbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQNCiAqDQogKiBodHRwOi8vd3d3\nLmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjANCiAqDQogKiBVbmxl\nc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGlu\nIHdyaXRpbmcsDQogKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUg\nTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbg0KICogIkFTIElTIiBCQVNJ\nUywgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZDQog\nKiBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBM\naWNlbnNlIGZvciB0aGUNCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmlu\nZyBwZXJtaXNzaW9ucyBhbmQgbGltaXRhdGlvbnMNCiAqIHVuZGVyIHRoZSBM\naWNlbnNlLiAgICANCiAqLw0KcGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEu\ncGVyc2lzdGVuY2UucXVlcnk7DQoNCmltcG9ydCBqYXZhLnV0aWwuQ29sbGVj\ndGlvbjsNCmltcG9ydCBqYXZhLnV0aWwuSXRlcmF0b3I7DQppbXBvcnQgamF2\nYS51dGlsLkxpc3Q7DQoNCg0KaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5w\nZXJzaXN0ZW5jZS5xdWVyeS5jb21tb24uYXBwcy5SdW50aW1lVGVzdDE7DQpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNlLnF1ZXJ5LmNv\nbW1vbi5hcHBzLlJ1bnRpbWVUZXN0MjsNCmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEucGVyc2lzdGVuY2UucXVlcnkuY29tbW9uLmFwcHMuUnVudGltZVRl\nc3QzOw0KaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5F\neHRlbnQ7DQppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNl\nLk9wZW5KUEFFbnRpdHlNYW5hZ2VyOw0KaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5wZXJzaXN0ZW5jZS5PcGVuSlBBUXVlcnk7DQppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNlLmpkYmMuRmV0Y2hNb2RlOw0KaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5qZGJjLkpEQkNG\nZXRjaFBsYW47DQoNCi8qKg0KICogVGVzdCB0aGF0IFJlc3VsdExpc3Qgb2Jq\nZWN0cyBiZWhhdmVyIGNvcnJlY3RseS4NCiAqDQogKiBAYXV0aG9yIE1hcmMg\nUHJ1ZCdob21tZWF1eA0KICovDQpwdWJsaWMgY2xhc3MgVGVzdFF1ZXJ5UmVz\ndWx0cyBleHRlbmRzIEJhc2VRdWVyeVRlc3Qgew0KDQogICAgcHVibGljIFRl\nc3RRdWVyeVJlc3VsdHMoU3RyaW5nIHRlc3QpIHsNCiAgICAgICAgc3VwZXIo\ndGVzdCk7DQogICAgfQ0KDQogICAgcHVibGljIHZvaWQgc2V0VXAoKSB7DQog\nICAgICAgIGRlbGV0ZUFsbChSdW50aW1lVGVzdDEuY2xhc3MpOw0KDQogICAg\nICAgIE9wZW5KUEFFbnRpdHlNYW5hZ2VyIGVtID0NCiAgICAgICAgICAgIChP\ncGVuSlBBRW50aXR5TWFuYWdlcikgY3VycmVudEVudGl0eU1hbmFnZXIoKTsN\nCiAgICAgICAgc3RhcnRUeChlbSk7DQogICAgICAgIGVtLnBlcnNpc3QobmV3\nIFJ1bnRpbWVUZXN0MSgiVGVzdFF1ZXJ5UmVzdWx0czEiLCAxMCkpOw0KICAg\nICAgICBlbS5wZXJzaXN0KG5ldyBSdW50aW1lVGVzdDEoIlRlc3RRdWVyeVJl\nc3VsdHMzIiwgMTApKTsNCiAgICAgICAgZW0ucGVyc2lzdChuZXcgUnVudGlt\nZVRlc3QxKCJUZXN0UXVlcnlSZXN1bHRzNSIsIDEwKSk7DQogICAgICAgIGVt\nLnBlcnNpc3QobmV3IFJ1bnRpbWVUZXN0MygiVGVzdFF1ZXJ5UmVzdWx0czIi\nLCAxMCkpOw0KICAgICAgICBlbS5wZXJzaXN0KG5ldyBSdW50aW1lVGVzdDMo\nIlRlc3RRdWVyeVJlc3VsdHM0IiwgMTApKTsNCiAgICAgICAgZW0ucGVyc2lz\ndChuZXcgUnVudGltZVRlc3QzKCJUZXN0UXVlcnlSZXN1bHRzNiIsIDEwKSk7\nDQogICAgICAgIGVuZFR4KGVtKTsNCiAgICAgICAgZW5kRW0oZW0pOw0KICAg\nIH0NCg0KICAgIHB1YmxpYyB2b2lkIHRlc3RRdWVyeUl0ZXJhdG9yc1JldHVy\nbkZhbHNlRm9yQ2xvc2VkUXVlcnkoKSB7DQogICAgICAgIE9wZW5KUEFFbnRp\ndHlNYW5hZ2VyIGVtID0NCiAgICAgICAgICAgIChPcGVuSlBBRW50aXR5TWFu\nYWdlcikgY3VycmVudEVudGl0eU1hbmFnZXIoKTsNCiAgICAgICAgc3RhcnRU\neChlbSk7DQoNCiAgICAgICAgT3BlbkpQQVF1ZXJ5IHEgPSBlbS5jcmVhdGVR\ndWVyeSgiU0VMRUNUIG8gRlJPTSBSdW50aW1lVGVzdDEgbyIpOw0KICAgICAg\nICBMaXN0IGMgPSBxLmdldFJlc3VsdExpc3QoKTsNCiAgICAgICAgSXRlcmF0\nb3IgaSA9IGMuaXRlcmF0b3IoKTsNCiAgICAgICAgaWYgKCEoaS5oYXNOZXh0\nKCkpKQ0KICAgICAgICAgICAgZmFpbCgiSXRlcmF0b3Igc2hvdWxkIGhhdmUg\naGFkIG5leHQoKSIpOw0KICAgICAgICBxLmNsb3NlQWxsKCk7DQogICAgICAg\nIGVuZFR4KGVtKTsNCiAgICAgICAgZW5kRW0oZW0pOw0KDQogICAgICAgIGlm\nIChpLmhhc05leHQoKSkNCiAgICAgICAgICAgIGZhaWwoIkl0ZXJhdG9yIG9i\ndGFpbmVkIGZyb20gUXVlcnkgc2hvdWxkIHJldHVybiBmYWxzZSAiDQogICAg\nICAgICAgICAgICAgKyAiZm9yIGhhc05leHQoKSBhZnRlciBRdWVyeSBoYXMg\nYmVlbiBjbG9zZWQiKTsNCiAgICB9DQoNCiAgICBwdWJsaWMgdm9pZCB0ZXN0\nUXVlcnlJdGVyYXRvcnNUaHJvd0V4Y2VwdGlvbkZvckNsb3NlZFF1ZXJ5KCkg\new0KICAgICAgICBPcGVuSlBBRW50aXR5TWFuYWdlciBlbSA9DQogICAgICAg\nICAgICAoT3BlbkpQQUVudGl0eU1hbmFnZXIpIGN1cnJlbnRFbnRpdHlNYW5h\nZ2VyKCk7DQogICAgICAgIHN0YXJ0VHgoZW0pOw0KDQogICAgICAgIE9wZW5K\nUEFRdWVyeSBxID0gZW0uY3JlYXRlUXVlcnkoIlNFTEVDVCBvIEZST00gUnVu\ndGltZVRlc3QxIG8iKTsNCiAgICAgICAgTGlzdCBjID0gcS5nZXRSZXN1bHRM\naXN0KCk7DQogICAgICAgIEl0ZXJhdG9yIGkgPSBjLml0ZXJhdG9yKCk7DQog\nICAgICAgIGlmICghKGkuaGFzTmV4dCgpKSkNCiAgICAgICAgICAgIGZhaWwo\nIkl0ZXJhdG9yIHNob3VsZCBoYXZlIGhhZCBuZXh0KCkiKTsNCiAgICAgICAg\ncS5jbG9zZUFsbCgpOw0KICAgICAgICBlbmRUeChlbSk7DQogICAgICAgIGVu\nZEVtKGVtKTsNCg0KICAgICAgICB0cnkgew0KICAgICAgICAgICAgaS5uZXh0\nKCk7DQogICAgICAgICAgICBmYWlsKCJJdGVyYXRvci5uZXh0KCkgc2hvdWxk\nIGhhdmUgdGhyb3duIEV4Y2VwdGlvbiAiDQogICAgICAgICAgICAgICAgKyAi\nYWZ0ZXIgcXVlcnkuY2xvc2VBbGwoKSB3YXMgY2FsbGVkIik7DQogICAgICAg\nIH0NCiAgICAgICAgY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7DQogICAgICAgICAg\nICAvLw0KICAgICAgICB9DQogICAgfQ0KDQogICAgcHVibGljIHZvaWQgdGVz\ndExhenlRdWVyeUl0ZXJhdG9yc1JldHVybkZhbHNlRm9yQ2xvc2VkZW0oKSB7\nDQogICAgICAgIE9wZW5KUEFFbnRpdHlNYW5hZ2VyIGVtID0NCiAgICAgICAg\nICAgIChPcGVuSlBBRW50aXR5TWFuYWdlcikgY3VycmVudEVudGl0eU1hbmFn\nZXIoKTsNCiAgICAgICAgc3RhcnRUeChlbSk7DQoNCiAgICAgICAgU3RyaW5n\nIHF1ZXJ5ID0gIlNFTEVDVCBvIEZST00gUnVudGltZVRlc3QxIG8iOw0KICAg\nICAgICBPcGVuSlBBUXVlcnkgcSA9IGVtLmNyZWF0ZVF1ZXJ5KHF1ZXJ5KTsN\nCiAgICAgICAgcS5nZXRGZXRjaFBsYW4oKS5zZXRGZXRjaEJhdGNoU2l6ZSg1\nKTsNCiAgICAgICAgTGlzdCBjID0gcS5nZXRSZXN1bHRMaXN0KCk7DQoNCiAg\nICAgICAgSXRlcmF0b3IgaSA9IGMuaXRlcmF0b3IoKTsNCiAgICAgICAgaWYg\nKCEoaS5oYXNOZXh0KCkpKQ0KICAgICAgICAgICAgZmFpbCgiSXRlcmF0b3Ig\nc2hvdWxkIGhhdmUgaGFkIG5leHQoKSIpOw0KICAgICAgICBlbmRUeChlbSk7\nDQogICAgICAgIGVuZEVtKGVtKTsNCg0KICAgICAgICBpZiAoaS5oYXNOZXh0\nKCkpDQogICAgICAgICAgICBmYWlsKCJMYXp5IHJlc3VsdCBpdGVyYXRvciBv\nYnRhaW5lZCBmcm9tIFF1ZXJ5IHNob3VsZCByZXR1cm4gIg0KICAgICAgICAg\nICAgICAgICsgImZhbHNlIGZvciBoYXNOZXh0KCkgYWZ0ZXIgZW0gaGFzIGJl\nZW4gY2xvc2VkIik7DQogICAgfQ0KDQogICAgcHVibGljIHZvaWQgdGVzdEVh\nZ2VyUXVlcnlJdGVyYXRvcnNXb3JrRm9yQ2xvc2VkZW0oKSB7DQogICAgICAg\nIE9wZW5KUEFFbnRpdHlNYW5hZ2VyIGVtID0NCiAgICAgICAgICAgIChPcGVu\nSlBBRW50aXR5TWFuYWdlcikgY3VycmVudEVudGl0eU1hbmFnZXIoKTsNCiAg\nICAgICAgc3RhcnRUeChlbSk7DQoNCiAgICAgICAgU3RyaW5nIHF1ZXJ5ID0g\nIlNFTEVDVCBvIEZST00gUnVudGltZVRlc3QxIG8iOw0KICAgICAgICBPcGVu\nSlBBUXVlcnkgcSA9IGVtLmNyZWF0ZVF1ZXJ5KHF1ZXJ5KTsNCiAgICAgICAg\ncS5nZXRGZXRjaFBsYW4oKS5zZXRGZXRjaEJhdGNoU2l6ZSgtMSk7DQoNCiAg\nICAgICAgTGlzdCBjID0gcS5nZXRSZXN1bHRMaXN0KCk7DQoNCiAgICAgICAg\nSXRlcmF0b3IgaSA9IGMuaXRlcmF0b3IoKTsNCiAgICAgICAgaWYgKCEoaS5o\nYXNOZXh0KCkpKQ0KICAgICAgICAgICAgZmFpbCgiSXRlcmF0b3Igc2hvdWxk\nIGhhdmUgaGFkIG5leHQoKSIpOw0KICAgICAgICBlbmRUeChlbSk7DQogICAg\nICAgIGVuZEVtKGVtKTsNCg0KICAgICAgICBpZiAoIWkuaGFzTmV4dCgpKQ0K\nICAgICAgICAgICAgZmFpbCgiRWFnZXIgcmVzdWx0IGl0ZXJhdG9yIG9idGFp\nbmVkIGZyb20gUXVlcnkgc2hvdWxkIHJldHVybiAiDQogICAgICAgICAgICAg\nICAgKyAidHJ1ZSBmb3IgaGFzTmV4dCgpIGFmdGVyIGVtIGhhcyBiZWVuIGNs\nb3NlZCIpOw0KICAgIH0NCg0KICAgIHB1YmxpYyB2b2lkIHRlc3RRdWVyeVJl\nc3VsdElzTGlzdCgpIHsNCiAgICAgICAgT3BlbkpQQUVudGl0eU1hbmFnZXIg\nZW0gPQ0KICAgICAgICAgICAgKE9wZW5KUEFFbnRpdHlNYW5hZ2VyKSBjdXJy\nZW50RW50aXR5TWFuYWdlcigpOw0KICAgICAgICBzdGFydFR4KGVtKTsNCg0K\nICAgICAgICBTdHJpbmcgcXVlcnkgPSAiU0VMRUNUIG8gRlJPTSBSdW50aW1l\nVGVzdDEgbyI7DQoNCiAgICAgICAgQ29sbGVjdGlvbiBjID0gKENvbGxlY3Rp\nb24pIGVtLmNyZWF0ZVF1ZXJ5KHF1ZXJ5KS5nZXRSZXN1bHRMaXN0KCk7DQog\nICAgICAgIGlmICghKGMgaW5zdGFuY2VvZiBMaXN0KSkNCiAgICAgICAgICAg\nIGZhaWwoIkNvbGxlY3Rpb24gKCIgKyBjLmdldENsYXNzKCkgKyAiKSBzaG91\nbGQgaGF2ZSAiDQogICAgICAgICAgICAgICAgKyAiYmVlbiBhIExpc3QgaW5z\ndGFuY2UiKTsNCg0KICAgICAgICBlbmRUeChlbSk7DQogICAgICAgIGVuZEVt\nKGVtKTsNCiAgICB9DQoNCiAgICBwdWJsaWMgdm9pZCB0ZXN0UXVlcnlSZXN1\nbHRTaXplSXNDb3JyZWN0KCkgew0KICAgICAgICBPcGVuSlBBRW50aXR5TWFu\nYWdlciBlbSA9DQogICAgICAgICAgICAoT3BlbkpQQUVudGl0eU1hbmFnZXIp\nIGN1cnJlbnRFbnRpdHlNYW5hZ2VyKCk7DQogICAgICAgIHN0YXJ0VHgoZW0p\nOw0KDQogICAgICAgIGVtLnBlcnNpc3QobmV3IFJ1bnRpbWVUZXN0MigiVGVz\ndFF1ZXJ5UmVzdWx0czEiLCAxMCkpOw0KICAgICAgICBlbmRUeChlbSk7DQog\nICAgICAgIGVuZEVtKGVtKTsNCg0KICAgICAgICBlbSA9IChPcGVuSlBBRW50\naXR5TWFuYWdlcikgY3VycmVudEVudGl0eU1hbmFnZXIoKTsNCiAgICAgICAg\nc3RhcnRUeChlbSk7DQoNCiAgICAgICAgU3RyaW5nIHF1ZXJ5ID0NCiAgICAg\nICAgICAgICJTRUxFQ1QgciBGUk9NIFJ1bnRpbWVUZXN0MiByIFdIRVJFIHIu\nc3RyaW5nRmllbGQgPSBcJ1Rlc3RRdWVyeVJlc3VsdHMxXCciOw0KICAgICAg\nICBMaXN0IGMgPSBlbS5jcmVhdGVRdWVyeShxdWVyeSkuZ2V0UmVzdWx0TGlz\ndCgpOw0KDQogICAgICAgIGFzc2VydEVxdWFscygxLCBjLnNpemUoKSk7DQog\nICAgICAgIGVuZFR4KGVtKTsNCiAgICAgICAgZW5kRW0oZW0pOw0KICAgIH0N\nCg0KICAgIHB1YmxpYyB2b2lkIHRlc3RFeHRlbnRJdGVyYXRvcnNSZXR1cm5G\nYWxzZUZvckNsb3NlZEV4dGVudCgpIHsNCiAgICAgICAgT3BlbkpQQUVudGl0\neU1hbmFnZXIgZW0gPQ0KICAgICAgICAgICAgKE9wZW5KUEFFbnRpdHlNYW5h\nZ2VyKSBjdXJyZW50RW50aXR5TWFuYWdlcigpOw0KICAgICAgICBzdGFydFR4\nKGVtKTsNCiAgICAgICAgRXh0ZW50IGV4dGVudCA9IGVtLmNyZWF0ZUV4dGVu\ndChSdW50aW1lVGVzdDEuY2xhc3MsIHRydWUpOw0KDQogICAgICAgIEl0ZXJh\ndG9yIGkgPSBleHRlbnQuaXRlcmF0b3IoKTsNCiAgICAgICAgaWYgKCEoaS5o\nYXNOZXh0KCkpKQ0KICAgICAgICAgICAgZmFpbCgiSXRlcmF0b3Igc2hvdWxk\nIGhhdmUgaGFkIG5leHQoKSIpOw0KICAgICAgICBleHRlbnQuY2xvc2VBbGwo\nKTsNCg0KICAgICAgICBpZiAoaS5oYXNOZXh0KCkpDQogICAgICAgICAgICBm\nYWlsKCJJdGVyYXRvciBvYnRhaW5lZCBmcm9tIEV4dGVudCBzaG91bGQgcmV0\ndXJuIGZhbHNlICINCiAgICAgICAgICAgICAgICArICJmb3IgaGFzTmV4dCgp\nIGFmdGVyIEV4dGVudCBoYXMgYmVlbiBjbG9zZWQiKTsNCg0KICAgICAgICBl\nbmRUeChlbSk7DQogICAgICAgIGVuZEVtKGVtKTsNCiAgICB9DQoNCiAgICBw\ndWJsaWMgdm9pZCB0ZXN0RXh0ZW50SXRlcmF0b3JzVGhyb3dFeGNlcHRpb25G\nb3JDbG9zZWRFeHRlbnQoKSB7DQogICAgICAgIE9wZW5KUEFFbnRpdHlNYW5h\nZ2VyIGVtID0NCiAgICAgICAgICAgIChPcGVuSlBBRW50aXR5TWFuYWdlcikg\nY3VycmVudEVudGl0eU1hbmFnZXIoKTsNCiAgICAgICAgc3RhcnRUeChlbSk7\nDQoNCiAgICAgICAgRXh0ZW50IGV4dGVudCA9IGVtLmNyZWF0ZUV4dGVudChS\ndW50aW1lVGVzdDEuY2xhc3MsIHRydWUpOw0KDQogICAgICAgIEl0ZXJhdG9y\nIGkgPSBleHRlbnQuaXRlcmF0b3IoKTsNCiAgICAgICAgaWYgKCEoaS5oYXNO\nZXh0KCkpKQ0KICAgICAgICAgICAgZmFpbCgiSXRlcmF0b3Igc2hvdWxkIGhh\ndmUgaGFkIG5leHQoKSIpOw0KICAgICAgICBleHRlbnQuY2xvc2VBbGwoKTsN\nCg0KICAgICAgICB0cnkgew0KICAgICAgICAgICAgaS5uZXh0KCk7DQogICAg\nICAgICAgICBmYWlsKCJJdGVyYXRvci5uZXh0KCkgc2hvdWxkIGhhdmUgdGhy\nb3duIEV4Y2VwdGlvbiAiDQogICAgICAgICAgICAgICAgKyAiYWZ0ZXIgRXh0\nZW50LmNsb3NlQWxsKCkgd2FzIGNhbGxlZCIpOw0KICAgICAgICB9IGNhdGNo\nIChFeGNlcHRpb24gZSkgew0KICAgICAgICAgICAgLy8gdGhpcyBpcyBhICpn\nb29kKiB0aGluZy4NCiAgICAgICAgfQ0KDQogICAgICAgIGVuZFR4KGVtKTsN\nCiAgICAgICAgZW5kRW0oZW0pOw0KICAgIH0NCg0KICAgIHB1YmxpYyB2b2lk\nIHRlc3RFeHRlbnRJdGVyYXRvcnNSZXR1cm5GYWxzZUZvckNsb3NlZGVtKCkg\new0KICAgICAgICBPcGVuSlBBRW50aXR5TWFuYWdlciBlbSA9DQogICAgICAg\nICAgICAoT3BlbkpQQUVudGl0eU1hbmFnZXIpIGN1cnJlbnRFbnRpdHlNYW5h\nZ2VyKCk7DQogICAgICAgIHN0YXJ0VHgoZW0pOw0KDQogICAgICAgIEV4dGVu\ndCBleHRlbnQgPSBlbS5jcmVhdGVFeHRlbnQoUnVudGltZVRlc3QxLmNsYXNz\nLCB0cnVlKTsNCiAgICAgICAgSXRlcmF0b3IgaSA9IGV4dGVudC5pdGVyYXRv\ncigpOw0KICAgICAgICBpZiAoIShpLmhhc05leHQoKSkpDQogICAgICAgICAg\nICBmYWlsKCJJdGVyYXRvciBzaG91bGQgaGF2ZSBoYWQgbmV4dCgpIik7DQog\nICAgICAgIGVuZFR4KGVtKTsNCiAgICAgICAgZW5kRW0oZW0pOw0KDQogICAg\nICAgIGlmIChpLmhhc05leHQoKSkNCiAgICAgICAgICAgIGZhaWwoIkl0ZXJh\ndG9yIG9idGFpbmVkIGZyb20gRXh0ZW50IHNob3VsZCByZXR1cm4gZmFsc2Ug\nIg0KICAgICAgICAgICAgICAgICsgImZvciBoYXNOZXh0KCkgYWZ0ZXIgZW0g\naGFzIGJlZW4gY2xvc2VkIik7DQogICAgfQ0KDQogICAgcHVibGljIHZvaWQg\ndGVzdFVuaXF1ZVJldHVybnNTaW5nbGVSZXN1bHQoKSB7DQogICAgICAgIE9w\nZW5KUEFFbnRpdHlNYW5hZ2VyIGVtID0NCiAgICAgICAgICAgIChPcGVuSlBB\nRW50aXR5TWFuYWdlcikgY3VycmVudEVudGl0eU1hbmFnZXIoKTsNCiAgICAg\nICAgc3RhcnRUeChlbSk7DQoNCiAgICAgICAgU3RyaW5nIHF1ZXJ5ID0NCiAg\nICAgICAgICAgICJTRUxFQ1QgRElTVElOQ1QgciBGUk9NIFJ1bnRpbWVUZXN0\nMSByIFdIRVJFIHIuc3RyaW5nRmllbGQgPSBcJ1Rlc3RRdWVyeVJlc3VsdHMx\nXCciOw0KICAgICAgICBPYmplY3Qgb2JqID0gZW0uY3JlYXRlUXVlcnkocXVl\ncnkpLmdldFNpbmdsZVJlc3VsdCgpOw0KDQogICAgICAgIGFzc2VydFRydWUo\nb2JqIGluc3RhbmNlb2YgUnVudGltZVRlc3QxKTsNCg0KICAgICAgICBxdWVy\neSA9DQogICAgICAgICAgICAiU0VMRUNUIERJU1RJTkNUIHIgRlJPTSBSdW50\naW1lVGVzdDEgciBXSEVSRSByLnN0cmluZ0ZpZWxkID0gXCd4eHh4XCciOw0K\nICAgICAgICBPcGVuSlBBUXVlcnkgcSA9IGVtLmNyZWF0ZVF1ZXJ5KHF1ZXJ5\nKTsNCiAgICAgICAgTGlzdCBsID0gcS5nZXRSZXN1bHRMaXN0KCk7DQogICAg\nICAgIGFzc2VydE5vdE51bGwoDQogICAgICAgICAgICAiZXhwZWN0aW5nIGwg\ndG8gYmUgbnVsbCBzaW5jZSB0aGVyZSBpcyBubyBSdW50aW1lVGVzdDEgaW5z\ndGFuY2Ugd2l0aCBzdHJpbmdmaWVsZD14eHh4IiwNCiAgICAgICAgICAgIGwp\nOw0KDQogICAgICAgIHEuY2xvc2VBbGwoKTsNCiAgICAgICAgZW5kVHgoZW0p\nOw0KICAgICAgICBlbmRFbShlbSk7DQogICAgfQ0KDQogICAgcHVibGljIHZv\naWQgdGVzdFVuaXF1ZVRocm93c0V4Y2VwdGlvbklmTXVsdGlwbGVSZXN1bHRz\nKCkgew0KICAgICAgICBPcGVuSlBBRW50aXR5TWFuYWdlciBlbSA9DQogICAg\nICAgICAgICAoT3BlbkpQQUVudGl0eU1hbmFnZXIpIGN1cnJlbnRFbnRpdHlN\nYW5hZ2VyKCk7DQogICAgICAgIHN0YXJ0VHgoZW0pOw0KICAgICAgICBTdHJp\nbmcgcXVlcnkgPSAiU0VMRUNUIERJU1RJTkNUIHIgRlJPTSBSdW50aW1lVGVz\ndDEgciI7DQogICAgICAgIE9wZW5KUEFRdWVyeSBxID0gZW0uY3JlYXRlUXVl\ncnkocXVlcnkpOw0KDQogICAgICAgIHRyeSB7DQogICAgICAgICAgICBPYmpl\nY3QgbCA9IHEuZ2V0U2luZ2xlUmVzdWx0KCk7DQogICAgICAgICAgICBmYWls\nKCJVbmlxdWUgcXVlcnkgbWF0Y2hlZCBtdWx0aXBsZSByZXN1bHRzLiIpOw0K\nICAgICAgICB9DQogICAgICAgIGNhdGNoIChFeGNlcHRpb24ganVlKSB7DQog\nICAgICAgIH0NCiAgICAgICAgcS5jbG9zZUFsbCgpOw0KICAgICAgICBlbmRU\neChlbSk7DQogICAgICAgIGVuZEVtKGVtKTsNCiAgICB9DQoNCiAgICBwdWJs\naWMgdm9pZCB0ZXN0SW1wb3NzaWJsZVJhbmdlUmV0dXJuc0VtcHR5TGlzdCgp\nIHsNCiAgICAgICAgT3BlbkpQQUVudGl0eU1hbmFnZXIgZW0gPQ0KICAgICAg\nICAgICAgKE9wZW5KUEFFbnRpdHlNYW5hZ2VyKSBjdXJyZW50RW50aXR5TWFu\nYWdlcigpOw0KICAgICAgICBzdGFydFR4KGVtKTsNCiAgICAgICAgU3RyaW5n\nIHF1ZXJ5ID0gIlNFTEVDVCByIEZST00gUnVudGltZVRlc3QxIHIiOw0KICAg\nICAgICBPcGVuSlBBUXVlcnkgcSA9IGVtLmNyZWF0ZVF1ZXJ5KHF1ZXJ5KTsN\nCiAgICAgICAgcS5zZXRGaXJzdFJlc3VsdCgyKTsNCiAgICAgICAgcS5zZXRN\nYXhSZXN1bHRzKDApOw0KDQogICAgICAgIExpc3QgcmVzdWx0cyA9IHEuZ2V0\nUmVzdWx0TGlzdCgpOw0KDQogICAgICAgIGFzc2VydEVxdWFscygwLCByZXN1\nbHRzLnNpemUoKSk7DQogICAgICAgIGFzc2VydEZhbHNlKHJlc3VsdHMuaXRl\ncmF0b3IoKS5oYXNOZXh0KCkpOw0KICAgICAgICBxLmNsb3NlQWxsKCk7DQog\nICAgICAgIGVuZFR4KGVtKTsNCiAgICAgICAgZW5kRW0oZW0pOw0KICAgIH0N\nCg0KICAgIHB1YmxpYyB2b2lkIHRlc3RJbXBvc3NpYmxlVW5pcXVlUmFuZ2VS\nZXR1cm5zTnVsbCgpIHsNCiAgICAgICAgT3BlbkpQQUVudGl0eU1hbmFnZXIg\nZW0gPQ0KICAgICAgICAgICAgKE9wZW5KUEFFbnRpdHlNYW5hZ2VyKSBjdXJy\nZW50RW50aXR5TWFuYWdlcigpOw0KICAgICAgICBzdGFydFR4KGVtKTsNCg0K\nICAgICAgICBPcGVuSlBBUXVlcnkgcSA9IGVtLmNyZWF0ZVF1ZXJ5KA0KICAg\nICAgICAgICAgIlNFTEVDVCBESVNUSU5DVCByIEZST00gUnVudGltZVRlc3Qx\nIHIgV0hFUkUgci5zdHJpbmdGaWVsZCA9IFwnVGVzdFF1ZXJ5UmVzdWx0czFc\nJyIpOw0KICAgICAgICBxLnNldEZpcnN0UmVzdWx0KDIpOw0KICAgICAgICBx\nLnNldE1heFJlc3VsdHMoMCk7DQogICAgICAgIGFzc2VydFRydWUoDQogICAg\nICAgICAgICAicmVzdWx0bGlzdCBpcyBub3QgbnVsbCBpdHMgc2l6ZSBpczog\nIiArIHEuZ2V0UmVzdWx0TGlzdCgpLnNpemUoKSwNCiAgICAgICAgICAgIHEu\nZ2V0UmVzdWx0TGlzdCgpLmlzRW1wdHkoKSk7DQogICAgICAgIHEuY2xvc2VB\nbGwoKTsNCiAgICAgICAgZW5kVHgoZW0pOw0KICAgICAgICBlbmRFbShlbSk7\nDQogICAgfQ0KDQogICAgcHVibGljIHZvaWQgdGVzdFNpbmdsZVJlc3VsdFVu\naXF1ZVJhbmdlKCkgew0KICAgICAgICBPcGVuSlBBRW50aXR5TWFuYWdlciBl\nbSA9DQogICAgICAgICAgICAoT3BlbkpQQUVudGl0eU1hbmFnZXIpIGN1cnJl\nbnRFbnRpdHlNYW5hZ2VyKCk7DQogICAgICAgIHN0YXJ0VHgoZW0pOw0KDQog\nICAgICAgIE9wZW5KUEFRdWVyeSBxID0gZW0uY3JlYXRlUXVlcnkoDQogICAg\nICAgICAgICAiU0VMRUNUIERJU1RJTkNUIHIgRlJPTSBSdW50aW1lVGVzdDEg\nciBXSEVSRSByLnN0cmluZ0ZpZWxkID0gXCdUZXN0UXVlcnlSZXN1bHRzMVwn\nIik7DQogICAgICAgIHEuc2V0Rmlyc3RSZXN1bHQoMSk7DQogICAgICAgIHEu\nc2V0TWF4UmVzdWx0cygxMDAwMDAwKTsNCg0KICAgICAgICBhc3NlcnRUcnVl\nKCJyZXN1bHRsaXN0IGlzIG5vdCBlbXB0eSIsIChxLmdldFJlc3VsdExpc3Qo\nKSkuaXNFbXB0eSgpKTsNCiAgICAgICAgcS5jbG9zZUFsbCgpOw0KICAgICAg\nICBlbmRUeChlbSk7DQogICAgICAgIGVuZEVtKGVtKTsNCiAgICB9DQoNCiAg\nICBwdWJsaWMgdm9pZCB0ZXN0TXVsdGlSZXN1bHRVbmlxdWVSYW5nZSgpIHsN\nCiAgICAgICAgT3BlbkpQQUVudGl0eU1hbmFnZXIgZW0gPQ0KICAgICAgICAg\nICAgKE9wZW5KUEFFbnRpdHlNYW5hZ2VyKSBjdXJyZW50RW50aXR5TWFuYWdl\ncigpOw0KICAgICAgICBzdGFydFR4KGVtKTsNCg0KICAgICAgICBPcGVuSlBB\nUXVlcnkgcSA9IGVtLmNyZWF0ZVF1ZXJ5KA0KICAgICAgICAgICAgIlNFTEVD\nVCBESVNUSU5DVCByIEZST00gUnVudGltZVRlc3QxIHIgT1JERVIgQlkgci5z\ndHJpbmdGaWVsZCBBU0MiKTsNCiAgICAgICAgcS5zZXRGaXJzdFJlc3VsdCgx\nKTsNCiAgICAgICAgcS5zZXRNYXhSZXN1bHRzKDIpOw0KDQogICAgICAgIGFz\nc2VydEVxdWFscygiVGVzdFF1ZXJ5UmVzdWx0czIiLA0KICAgICAgICAgICAg\nKChSdW50aW1lVGVzdDEpIHEuZ2V0UmVzdWx0TGlzdCgpLmdldCgwKSkuZ2V0\nU3RyaW5nRmllbGQoKSk7DQogICAgICAgIHEuY2xvc2VBbGwoKTsNCiAgICAg\nICAgZW5kVHgoZW0pOw0KICAgICAgICBlbmRFbShlbSk7DQogICAgfQ0KDQog\nICAgLyogVGhpcyB0ZXN0IGlzIGJlaW5nIGNvbW1lbnRlZCBiZWNhdXNlIGl0\nIHdhcyBzdXBwb3NlZCB0byBiZSBhIGNvbnZlcnRlZCB0ZXN0IGNvbXBsZW1l\nbnRpbmcgdGhlIG9yaWdpbmFsIEpETyB0ZXN0DQogICAgICAqIHdoaWNoIHVz\nZXMgdGhlIHNldFVuaXF1ZSgpIG1ldGhvZCBhdmFpbGFibGUgaW4gSkRPIFF1\nZXJ5LiBPcGVuSlBBUXVlcnkgZG9lcyBub3QgaGF2ZSBzdWNoIGEgbWV0aG9k\nIGFuZCBoZW5jZSB0aGlzIHRlc3QNCiAgICAgICogZG9lcyBub3QgbWFrZSBz\nZW5zZS4NCiAgICAgIHB1YmxpYyB2b2lkIHRlc3RVbmlxdWVUaHJvd3NFeGNl\ncHRpb25JZk5vblVuaXF1ZVJhbmdlKCkNCiAgICAgew0KICAgICAgICAgT3Bl\nbkpQQUVudGl0eU1hbmFnZXIgZW0gPSAoT3BlbkpQQUVudGl0eU1hbmFnZXIp\nIGN1cnJlbnRFbnRpdHlNYW5hZ2VyKCk7DQogICAgICAgICBzdGFydFR4KGVt\nKTsNCg0KICAgICAgICAgT3BlbkpQQVF1ZXJ5IHEgPSBlbS5jcmVhdGVRdWVy\neSgiU0VMRUNUIERJU1RJTkNUIHIgRlJPTSBSdW50aW1lVGVzdDEgciBPUkRF\nUiBCWSByLnN0cmluZ0ZpZWxkIEFTQyIpOw0KICAgICAgICAgcS5zZXRGaXJz\ndFJlc3VsdCgxKTsNCiAgICAgICAgIHEuc2V0TWF4UmVzdWx0cygzKTsNCg0K\nICAgICAgICAgdHJ5DQogICAgICAgICB7DQogICAgICAgICAgICAgcS5nZXRS\nZXN1bHRMaXN0KCk7DQogICAgICAgICAgICAgZmFpbCgiVW5pcXVlIGFsbG93\nZWQgbm9uLXVuaXF1ZSByYW5nZS4iKTsNCiAgICAgICAgIH0NCiAgICAgICAg\nIGNhdGNoIChFeGNlcHRpb24ganVlKQ0KICAgICAgICAgew0KICAgICAgICAg\nfQ0KICAgICAgICAgcS5jbG9zZUFsbCgpOw0KICAgICAgICAgZW5kVHgoZW0p\nOw0KICAgICAgICAgZW5kRW0oZW0pOw0KICAgICB9DQogICAgICovDQogICAg\ncHVibGljIHZvaWQgdGVzdEZ1bGxSYW5nZSgpIHsNCiAgICAgICAgdHJ5IHsN\nCiAgICAgICAgICAgIE9wZW5KUEFFbnRpdHlNYW5hZ2VyIGVtID0NCiAgICAg\nICAgICAgICAgICAoT3BlbkpQQUVudGl0eU1hbmFnZXIpIGN1cnJlbnRFbnRp\ndHlNYW5hZ2VyKCk7DQogICAgICAgICAgICBzdGFydFR4KGVtKTsNCg0KICAg\nICAgICAgICAgT3BlbkpQQVF1ZXJ5IHEgPSBlbS5jcmVhdGVRdWVyeSgNCiAg\nICAgICAgICAgICAgICAiU0VMRUNUIHIgRlJPTSBSdW50aW1lVGVzdDEgT1JE\nRVIgQlkgci5zdHJpbmdGaWVsZCBBU0MiKTsNCiAgICAgICAgICAgIHEuc2V0\nU3ViY2xhc3NlcyhmYWxzZSk7DQogICAgICAgICAgICBxLnNldEZpcnN0UmVz\ndWx0KDApOw0KICAgICAgICAgICAgTG9uZyBsID0gbmV3IExvbmcoTG9uZy5N\nQVhfVkFMVUUpOw0KICAgICAgICAgICAgcS5zZXRNYXhSZXN1bHRzKGwuaW50\nVmFsdWUoKSk7DQoNCiAgICAgICAgICAgIExpc3QgcmVzID0gKExpc3QpIHEu\nZ2V0UmVzdWx0TGlzdCgpOw0KICAgICAgICAgICAgYXNzZXJ0RXF1YWxzKDMs\nIHJlcy5zaXplKCkpOw0KICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkg\nPCByZXMuc2l6ZSgpOyBpKyspDQogICAgICAgICAgICAgICAgYXNzZXJ0RXF1\nYWxzKCJUZXN0UXVlcnlSZXN1bHRzIiArIChpICogMiArIDEpLA0KICAgICAg\nICAgICAgICAgICAgICAoKFJ1bnRpbWVUZXN0MSkgcmVzLmdldChpKSkuZ2V0\nU3RyaW5nRmllbGQoKSk7DQogICAgICAgICAgICBxLmNsb3NlQWxsKCk7DQog\nICAgICAgICAgICBlbmRUeChlbSk7DQogICAgICAgICAgICBlbmRFbShlbSk7\nDQogICAgICAgIH0NCiAgICAgICAgY2F0Y2ggKEV4Y2VwdGlvbiB1b2UpIHsN\nCiAgICAgICAgICAgIC8vRklYTUU6QUZBTSAtLSBGaWd1cmUgb3V0IEpQQSBF\ncXVpdmFsZW5jZSBvZiBjcmVhdGVFeHRlbnQoY2xhc3MsIGZhbHNlKSBpZSBo\nb3cgdG8gcmVzdHJpY3QgdGhlIHF1ZXJ5IHJlc3VsdCB0byB0aGUgYmFzZSBl\nbnRpdHkgYW5kDQogICAgICAgICAgICAvL25vdCB0aGUgc3ViY2xhc3Nlcw0K\nICAgICAgICB9DQogICAgfQ0KDQogICAgcHVibGljIHZvaWQgdGVzdEZ1bGxS\nYW5nZVN1YnMoKSB7DQogICAgICAgIHRyeSB7DQogICAgICAgICAgICBPcGVu\nSlBBRW50aXR5TWFuYWdlciBlbSA9DQogICAgICAgICAgICAgICAgKE9wZW5K\nUEFFbnRpdHlNYW5hZ2VyKSBjdXJyZW50RW50aXR5TWFuYWdlcigpOw0KICAg\nICAgICAgICAgc3RhcnRUeChlbSk7DQoNCiAgICAgICAgICAgIE9wZW5KUEFR\ndWVyeSBxID0gZW0uY3JlYXRlUXVlcnkoDQogICAgICAgICAgICAgICAgIlNF\nTEVDVCByIEZST00gUnVudGltZVRlc3QxIE9SREVSIEJZIHIuc3RyaW5nRmll\nbGQgQVNDIik7DQogICAgICAgICAgICBxLnNldEZpcnN0UmVzdWx0KDApOw0K\nICAgICAgICAgICAgTG9uZyBsID0gbmV3IExvbmcoTG9uZy5NQVhfVkFMVUUp\nOw0KICAgICAgICAgICAgcS5zZXRNYXhSZXN1bHRzKGwuaW50VmFsdWUoKSk7\nDQoNCiAgICAgICAgICAgIExpc3QgcmVzID0gKExpc3QpIHEuZ2V0UmVzdWx0\nTGlzdCgpOw0KICAgICAgICAgICAgYXNzZXJ0RXF1YWxzKDYsIHJlcy5zaXpl\nKCkpOw0KICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCByZXMuc2l6\nZSgpOyBpKyspDQogICAgICAgICAgICAgICAgYXNzZXJ0RXF1YWxzKCJUZXN0\nUXVlcnlSZXN1bHRzIiArIChpICsgMSksDQogICAgICAgICAgICAgICAgICAg\nICgoUnVudGltZVRlc3QxKSByZXMuZ2V0KGkpKS5nZXRTdHJpbmdGaWVsZCgp\nKTsNCiAgICAgICAgICAgIHEuY2xvc2VBbGwoKTsNCiAgICAgICAgICAgIGVu\nZFR4KGVtKTsNCiAgICAgICAgICAgIGVuZEVtKGVtKTsNCiAgICAgICAgfQ0K\nICAgICAgICBjYXRjaCAoRXhjZXB0aW9uIHVvZSkgew0KICAgICAgICB9DQog\nICAgfQ0KDQogICAgcHVibGljIHZvaWQgdGVzdEJlZ2luUmFuZ2UoKSB7DQog\nICAgICAgIE9wZW5KUEFFbnRpdHlNYW5hZ2VyIGVtID0NCiAgICAgICAgICAg\nIChPcGVuSlBBRW50aXR5TWFuYWdlcikgY3VycmVudEVudGl0eU1hbmFnZXIo\nKTsNCiAgICAgICAgc3RhcnRUeChlbSk7DQoNCiAgICAgICAgT3BlbkpQQVF1\nZXJ5IHEgPSBlbS5jcmVhdGVRdWVyeSgNCiAgICAgICAgICAgICJTRUxFQ1Qg\nciBGUk9NIFJ1bnRpbWVUZXN0MSByIE9SREVSIEJZIHIuc3RyaW5nRmllbGQg\nQVNDIik7DQogICAgICAgIHEuc2V0U3ViY2xhc3NlcyhmYWxzZSk7DQogICAg\nICAgIGZvciAoaW50IGkgPSAwOyBpIDwgNDsgaSsrKSB7DQogICAgICAgICAg\nICBxLnNldEZpcnN0UmVzdWx0KGkpOw0KICAgICAgICAgICAgcS5zZXRNYXhS\nZXN1bHRzKDEwMDAwMCk7DQoNCiAgICAgICAgICAgIExpc3QgcmVzID0gKExp\nc3QpIHEuZ2V0UmVzdWx0TGlzdCgpOw0KICAgICAgICAgICAgYXNzZXJ0RXF1\nYWxzKCJ0aGV5IGFyZSBub3QgZXF1YWwiLCAzIC0gaSwgcmVzLnNpemUoKSk7\nDQogICAgICAgICAgICBpbnQgaWR4ID0gMDsNCg0KICAgICAgICAgICAgLy8g\ndHJ5IGJvdGggcmFuZG9tIGFjZXNzIGFuZCBpdGVyYXRpb24NCiAgICAgICAg\nICAgIGZvciAoaW50IGogPSAwOyBqIDwgcmVzLnNpemUoKTsgaisrKQ0KICAg\nICAgICAgICAgICAgIGFzc2VydEVxdWFscygiVGVzdFF1ZXJ5UmVzdWx0cyIg\nKyAoaiAqIDIgKyAxICsgaSAqIDIpLA0KICAgICAgICAgICAgICAgICAgICAo\nKChSdW50aW1lVGVzdDEpIHJlcy5nZXQoaikpLmdldFN0cmluZ0ZpZWxkKCkp\nKTsNCiAgICAgICAgICAgIGZvciAoSXRlcmF0b3IgaXRyID0gcmVzLml0ZXJh\ndG9yKCk7IGl0ci5oYXNOZXh0KCk7IGlkeCsrKQ0KICAgICAgICAgICAgICAg\nIGFzc2VydEVxdWFscygiVGVzdFF1ZXJ5UmVzdWx0cyIgKyAoaWR4ICogMiAr\nIDEgKyBpICogMiksDQogICAgICAgICAgICAgICAgICAgICgoUnVudGltZVRl\nc3QxKSBpdHIubmV4dCgpKS5nZXRTdHJpbmdGaWVsZCgpKTsNCiAgICAgICAg\nfQ0KICAgICAgICBxLmNsb3NlQWxsKCk7DQogICAgICAgIGVuZFR4KGVtKTsN\nCiAgICAgICAgZW5kRW0oZW0pOw0KICAgIH0NCg0KICAgIHB1YmxpYyB2b2lk\nIHRlc3RCZWdpblJhbmdlU3VicygpIHsNCiAgICAgICAgT3BlbkpQQUVudGl0\neU1hbmFnZXIgZW0gPQ0KICAgICAgICAgICAgKE9wZW5KUEFFbnRpdHlNYW5h\nZ2VyKSBjdXJyZW50RW50aXR5TWFuYWdlcigpOw0KICAgICAgICBzdGFydFR4\nKGVtKTsNCg0KICAgICAgICBPcGVuSlBBUXVlcnkgcSA9IGVtLmNyZWF0ZVF1\nZXJ5KA0KICAgICAgICAgICAgIlNFTEVDVCByIEZST00gUnVudGltZVRlc3Qx\nIHIgT1JERVIgQlkgci5zdHJpbmdGaWVsZCBBU0MiKTsNCg0KICAgICAgICBm\nb3IgKGludCBpID0gMDsgaSA8IDc7IGkrKykgew0KICAgICAgICAgICAgcS5z\nZXRGaXJzdFJlc3VsdChpKTsNCiAgICAgICAgICAgIExvbmcgbCA9IG5ldyBM\nb25nKExvbmcuTUFYX1ZBTFVFKTsNCiAgICAgICAgICAgIHEuc2V0TWF4UmVz\ndWx0cygxMDAwMDApOw0KDQogICAgICAgICAgICBMaXN0IHJlcyA9IChMaXN0\nKSBxLmdldFJlc3VsdExpc3QoKTsNCiAgICAgICAgICAgIGFzc2VydEVxdWFs\ncyg2IC0gaSwgcmVzLnNpemUoKSk7DQogICAgICAgICAgICBpbnQgaWR4ID0g\nMDsNCg0KICAgICAgICAgICAgLy8gdHJ5IGJvdGggcmFuZG9tIGFjZXNzIGFu\nZCBpdGVyYXRpb24NCiAgICAgICAgICAgIGZvciAoaW50IGogPSAwOyBqIDwg\ncmVzLnNpemUoKTsgaisrKQ0KICAgICAgICAgICAgICAgIGFzc2VydEVxdWFs\ncygiVGVzdFF1ZXJ5UmVzdWx0cyIgKyAoaiArIDEgKyBpKSwNCiAgICAgICAg\nICAgICAgICAgICAgKChSdW50aW1lVGVzdDEpIHJlcy5nZXQoaikpLmdldFN0\ncmluZ0ZpZWxkKCkpOw0KICAgICAgICAgICAgZm9yIChJdGVyYXRvciBpdHIg\nPSByZXMuaXRlcmF0b3IoKTsgaXRyLmhhc05leHQoKTsgaWR4KyspDQogICAg\nICAgICAgICAgICAgYXNzZXJ0RXF1YWxzKCJUZXN0UXVlcnlSZXN1bHRzIiAr\nIChpZHggKyAxICsgaSksDQogICAgICAgICAgICAgICAgICAgICgoUnVudGlt\nZVRlc3QxKSBpdHIubmV4dCgpKS5nZXRTdHJpbmdGaWVsZCgpKTsNCiAgICAg\nICAgfQ0KICAgICAgICBxLmNsb3NlQWxsKCk7DQogICAgICAgIGVuZFR4KGVt\nKTsNCiAgICAgICAgZW5kRW0oZW0pOw0KICAgIH0NCg0KICAgIHB1YmxpYyB2\nb2lkIHRlc3RFbmRSYW5nZSgpIHsNCiAgICAgICAgT3BlbkpQQUVudGl0eU1h\nbmFnZXIgZW0gPQ0KICAgICAgICAgICAgKE9wZW5KUEFFbnRpdHlNYW5hZ2Vy\nKSBjdXJyZW50RW50aXR5TWFuYWdlcigpOw0KICAgICAgICBzdGFydFR4KGVt\nKTsNCg0KICAgICAgICBPcGVuSlBBUXVlcnkgcSA9IGVtLmNyZWF0ZVF1ZXJ5\nKA0KICAgICAgICAgICAgIlNFTEVDVCByIEZST00gUnVudGltZVRlc3QxIHIg\nT1JERVIgQlkgci5zdHJpbmdGaWVsZCBBU0MiKTsNCiAgICAgICAgcS5zZXRT\ndWJjbGFzc2VzKGZhbHNlKTsNCg0KICAgICAgICBmb3IgKGludCBpID0gMDsg\naSA8IDQ7IGkrKykgew0KICAgICAgICAgICAgcS5zZXRGaXJzdFJlc3VsdCgw\nKTsNCiAgICAgICAgICAgIHEuc2V0TWF4UmVzdWx0cyhpKTsNCg0KICAgICAg\nICAgICAgTGlzdCByZXMgPSAoTGlzdCkgcS5nZXRSZXN1bHRMaXN0KCk7DQog\nICAgICAgICAgICBhc3NlcnRFcXVhbHMoaSwgcmVzLnNpemUoKSk7DQogICAg\nICAgICAgICBpbnQgaWR4ID0gMDsNCg0KICAgICAgICAgICAgLy8gdHJ5IGJv\ndGggcmFuZG9tIGFjZXNzIGFuZCBpdGVyYXRpb24NCiAgICAgICAgICAgIGZv\nciAoaW50IGogPSAwOyBqIDwgcmVzLnNpemUoKTsgaisrKQ0KICAgICAgICAg\nICAgICAgIGFzc2VydEVxdWFscygiVGVzdFF1ZXJ5UmVzdWx0cyIgKyAoaiAq\nIDIgKyAxKSwNCiAgICAgICAgICAgICAgICAgICAgKChSdW50aW1lVGVzdDEp\nIHJlcy5nZXQoaikpLmdldFN0cmluZ0ZpZWxkKCkpOw0KICAgICAgICAgICAg\nZm9yIChJdGVyYXRvciBpdHIgPSByZXMuaXRlcmF0b3IoKTsgaXRyLmhhc05l\neHQoKTsgaWR4KyspDQogICAgICAgICAgICAgICAgYXNzZXJ0RXF1YWxzKCJU\nZXN0UXVlcnlSZXN1bHRzIiArIChpZHggKiAyICsgMSksDQogICAgICAgICAg\nICAgICAgICAgICgoUnVudGltZVRlc3QxKSBpdHIubmV4dCgpKS5nZXRTdHJp\nbmdGaWVsZCgpKTsNCiAgICAgICAgfQ0KICAgICAgICBxLmNsb3NlQWxsKCk7\nDQogICAgICAgIGVuZFR4KGVtKTsNCiAgICAgICAgZW5kRW0oZW0pOw0KICAg\nIH0NCg0KICAgIHB1YmxpYyB2b2lkIHRlc3RFbmRSYW5nZVN1YnMoKSB7DQog\nICAgICAgIE9wZW5KUEFFbnRpdHlNYW5hZ2VyIGVtID0NCiAgICAgICAgICAg\nIChPcGVuSlBBRW50aXR5TWFuYWdlcikgY3VycmVudEVudGl0eU1hbmFnZXIo\nKTsNCiAgICAgICAgc3RhcnRUeChlbSk7DQoNCiAgICAgICAgT3BlbkpQQVF1\nZXJ5IHEgPSBlbS5jcmVhdGVRdWVyeSgNCiAgICAgICAgICAgICJTRUxFQ1Qg\nciBGUk9NIFJ1bnRpbWVUZXN0MSByIE9SREVSIEJZIHIuc3RyaW5nRmllbGQg\nQVNDIik7DQoNCiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCA3OyBpKysp\nIHsNCiAgICAgICAgICAgIHEuc2V0Rmlyc3RSZXN1bHQoMCk7DQogICAgICAg\nICAgICBxLnNldE1heFJlc3VsdHMoaSk7DQogICAgICAgICAgICBMaXN0IHJl\ncyA9IChMaXN0KSBxLmdldFJlc3VsdExpc3QoKTsNCiAgICAgICAgICAgIGFz\nc2VydEVxdWFscyhpLCByZXMuc2l6ZSgpKTsNCiAgICAgICAgICAgIGludCBp\nZHggPSAwOw0KDQogICAgICAgICAgICAvLyB0cnkgYm90aCByYW5kb20gYWNl\nc3MgYW5kIGl0ZXJhdGlvbg0KICAgICAgICAgICAgZm9yIChpbnQgaiA9IDA7\nIGogPCByZXMuc2l6ZSgpOyBqKyspDQogICAgICAgICAgICAgICAgYXNzZXJ0\nRXF1YWxzKCJUZXN0UXVlcnlSZXN1bHRzIiArIChqICsgMSksDQogICAgICAg\nICAgICAgICAgICAgICgoUnVudGltZVRlc3QxKSByZXMuZ2V0KGopKS5nZXRT\ndHJpbmdGaWVsZCgpKTsNCiAgICAgICAgICAgIGZvciAoSXRlcmF0b3IgaXRy\nID0gcmVzLml0ZXJhdG9yKCk7IGl0ci5oYXNOZXh0KCk7IGlkeCsrKQ0KICAg\nICAgICAgICAgICAgIGFzc2VydEVxdWFscygiVGVzdFF1ZXJ5UmVzdWx0cyIg\nKyAoaWR4ICsgMSksDQogICAgICAgICAgICAgICAgICAgICgoUnVudGltZVRl\nc3QxKSBpdHIubmV4dCgpKS5nZXRTdHJpbmdGaWVsZCgpKTsNCiAgICAgICAg\nfQ0KICAgICAgICBxLmNsb3NlQWxsKCk7DQogICAgICAgIGVuZFR4KGVtKTsN\nCiAgICAgICAgZW5kRW0oZW0pOw0KICAgIH0NCg0KICAgIHB1YmxpYyB2b2lk\nIHRlc3RNaWRSYW5nZSgpIHsNCiAgICAgICAgT3BlbkpQQUVudGl0eU1hbmFn\nZXIgZW0gPQ0KICAgICAgICAgICAgKE9wZW5KUEFFbnRpdHlNYW5hZ2VyKSBj\ndXJyZW50RW50aXR5TWFuYWdlcigpOw0KICAgICAgICBzdGFydFR4KGVtKTsN\nCg0KICAgICAgICBPcGVuSlBBUXVlcnkgcSA9IGVtLmNyZWF0ZVF1ZXJ5KA0K\nICAgICAgICAgICAgIlNFTEVDVCByIEZST00gUnVudGltZVRlc3QxIHIgT1JE\nRVIgQlkgci5zdHJpbmdGaWVsZCBBU0MiKTsNCiAgICAgICAgcS5zZXRTdWJj\nbGFzc2VzKGZhbHNlKTsNCg0KICAgICAgICBxLnNldEZpcnN0UmVzdWx0KDEp\nOw0KICAgICAgICBxLnNldE1heFJlc3VsdHMoMyk7DQogICAgICAgIExpc3Qg\ncmVzID0gKExpc3QpIHEuZ2V0UmVzdWx0TGlzdCgpOw0KICAgICAgICBhc3Nl\ncnRFcXVhbHMoMiwgcmVzLnNpemUoKSk7DQogICAgICAgIGZvciAoaW50IGkg\nPSAwOyBpIDwgcmVzLnNpemUoKTsgaSsrKQ0KICAgICAgICAgICAgYXNzZXJ0\nRXF1YWxzKCJUZXN0UXVlcnlSZXN1bHRzIiArIChpICogMiArIDEgKyAyKSwN\nCiAgICAgICAgICAgICAgICAoKFJ1bnRpbWVUZXN0MSkgcmVzLmdldChpKSku\nZ2V0U3RyaW5nRmllbGQoKSk7DQogICAgICAgIGludCBpZHggPSAwOw0KICAg\nICAgICBmb3IgKEl0ZXJhdG9yIGl0ciA9IHJlcy5pdGVyYXRvcigpOyBpdHIu\naGFzTmV4dCgpOyBpZHgrKykNCiAgICAgICAgICAgIGFzc2VydEVxdWFscygi\nVGVzdFF1ZXJ5UmVzdWx0cyIgKyAoaWR4ICogMiArIDEgKyAyKSwNCiAgICAg\nICAgICAgICAgICAoKFJ1bnRpbWVUZXN0MSkgaXRyLm5leHQoKSkuZ2V0U3Ry\naW5nRmllbGQoKSk7DQogICAgICAgIHEuY2xvc2VBbGwoKTsNCiAgICAgICAg\nZW5kVHgoZW0pOw0KICAgICAgICBlbmRFbShlbSk7DQogICAgfQ0KDQogICAg\ncHVibGljIHZvaWQgdGVzdE1pZFJhbmdlU3VicygpIHsNCiAgICAgICAgT3Bl\nbkpQQUVudGl0eU1hbmFnZXIgZW0gPQ0KICAgICAgICAgICAgKE9wZW5KUEFF\nbnRpdHlNYW5hZ2VyKSBjdXJyZW50RW50aXR5TWFuYWdlcigpOw0KICAgICAg\nICBzdGFydFR4KGVtKTsNCg0KICAgICAgICBPcGVuSlBBUXVlcnkgcSA9IGVt\nLmNyZWF0ZVF1ZXJ5KA0KICAgICAgICAgICAgIlNFTEVDVCByIEZST00gUnVu\ndGltZVRlc3QxIHIgT1JERVIgQlkgci5zdHJpbmdGaWVsZCBBU0MiKTsNCiAg\nICAgICAgcS5zZXRGaXJzdFJlc3VsdCgxKTsNCiAgICAgICAgcS5zZXRNYXhS\nZXN1bHRzKDMpOw0KDQogICAgICAgIExpc3QgcmVzID0gKExpc3QpIHEuZ2V0\nUmVzdWx0TGlzdCgpOw0KICAgICAgICBhc3NlcnRFcXVhbHMoMywgcmVzLnNp\nemUoKSk7DQogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgcmVzLnNpemUo\nKTsgaSsrKQ0KICAgICAgICAgICAgYXNzZXJ0RXF1YWxzKCJUZXN0UXVlcnlS\nZXN1bHRzIiArIChpICsgMSArIDEpLA0KICAgICAgICAgICAgICAgICgoUnVu\ndGltZVRlc3QxKSByZXMuZ2V0KGkpKS5nZXRTdHJpbmdGaWVsZCgpKTsNCiAg\nICAgICAgaW50IGlkeCA9IDA7DQogICAgICAgIGZvciAoSXRlcmF0b3IgaXRy\nID0gcmVzLml0ZXJhdG9yKCk7IGl0ci5oYXNOZXh0KCk7IGlkeCsrKQ0KICAg\nICAgICAgICAgYXNzZXJ0RXF1YWxzKCJUZXN0UXVlcnlSZXN1bHRzIiArIChp\nZHggKyAxICsgMSksDQogICAgICAgICAgICAgICAgKChSdW50aW1lVGVzdDEp\nIGl0ci5uZXh0KCkpLmdldFN0cmluZ0ZpZWxkKCkpOw0KICAgICAgICBxLmNs\nb3NlQWxsKCk7DQogICAgICAgIGVuZFR4KGVtKTsNCiAgICAgICAgZW5kRW0o\nZW0pOw0KICAgIH0NCg0KICAgIHB1YmxpYyB2b2lkIHRlc3RQZXNzaW1pc3Rp\nY09yZGVyZWRSYW5nZSgpIHsNCiAgICAgICAgLy8gdGVzdCB0byBtYWtlIHN1\ncmUgd2hhdGV2ZXIgbWFjaGluYXRpb25zIHdlIGRvIHRvIGdldCBhIHJhbmdl\nIGRvZXNuJ3QNCiAgICAgICAgLy8gaW50ZXJmZXJlIHdpdGggRk9SIFVQREFU\nRQ0KICAgICAgICBPcGVuSlBBRW50aXR5TWFuYWdlciBlbSA9DQogICAgICAg\nICAgICAoT3BlbkpQQUVudGl0eU1hbmFnZXIpIGN1cnJlbnRFbnRpdHlNYW5h\nZ2VyKCk7DQogICAgICAgIHN0YXJ0VHgoZW0pOw0KDQogICAgICAgIE9wZW5K\nUEFRdWVyeSBxID0gZW0uY3JlYXRlUXVlcnkoDQogICAgICAgICAgICAiU0VM\nRUNUIHIgRlJPTSBSdW50aW1lVGVzdDEgciBPUkRFUiBCWSByLnN0cmluZ0Zp\nZWxkIEFTQyIpOw0KICAgICAgICBxLnNldFN1YmNsYXNzZXMoZmFsc2UpOw0K\nICAgICAgICBxLnNldEZpcnN0UmVzdWx0KDApOw0KICAgICAgICBxLnNldE1h\neFJlc3VsdHMoMik7DQoNCiAgICAgICAgKChKREJDRmV0Y2hQbGFuKSBxLmdl\ndEZldGNoUGxhbigpKS5zZXRFYWdlckZldGNoTW9kZShGZXRjaE1vZGUuTk9O\nRSk7DQoNCiAgICAgICAgTGlzdCByZXMgPSAoTGlzdCkgcS5nZXRSZXN1bHRM\naXN0KCk7DQogICAgICAgIGFzc2VydEVxdWFscygyLCByZXMuc2l6ZSgpKTsN\nCiAgICAgICAgYXNzZXJ0RXF1YWxzKCJUZXN0UXVlcnlSZXN1bHRzMSIsDQog\nICAgICAgICAgICAoKFJ1bnRpbWVUZXN0MSkgcmVzLmdldCgwKSkuZ2V0U3Ry\naW5nRmllbGQoKSk7DQogICAgICAgIGFzc2VydEVxdWFscygiVGVzdFF1ZXJ5\nUmVzdWx0czMiLA0KICAgICAgICAgICAgKChSdW50aW1lVGVzdDEpIHJlcy5n\nZXQoMSkpLmdldFN0cmluZ0ZpZWxkKCkpOw0KICAgICAgICBxLmNsb3NlQWxs\nKCk7DQogICAgICAgIGVuZFR4KGVtKTsNCiAgICAgICAgZW5kRW0oZW0pOw0K\nICAgIH0NCn0NCg0K\n","encoding":"base64"}

