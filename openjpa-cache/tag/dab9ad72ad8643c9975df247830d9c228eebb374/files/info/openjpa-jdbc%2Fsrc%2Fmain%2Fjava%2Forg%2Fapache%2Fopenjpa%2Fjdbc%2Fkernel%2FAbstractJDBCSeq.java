{"sha":"93b2279a47ea49f036e7f8f71512df9c4bff6e31","node_id":"MDQ6QmxvYjIwNjM2NDo5M2IyMjc5YTQ3ZWE0OWYwMzZlN2Y4ZjcxNTEyZGY5YzRiZmY2ZTMx","size":7171,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/93b2279a47ea49f036e7f8f71512df9c4bff6e31","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5rZXJuZWw7CgppbXBv\ncnQgamF2YS5zcWwuQ29ubmVjdGlvbjsKaW1wb3J0IGphdmEuc3FsLlNRTEV4\nY2VwdGlvbjsKaW1wb3J0IGphdmF4LnNxbC5EYXRhU291cmNlOwppbXBvcnQg\namF2YXgudHJhbnNhY3Rpb24uVHJhbnNhY3Rpb247CmltcG9ydCBqYXZheC50\ncmFuc2FjdGlvbi5UcmFuc2FjdGlvbk1hbmFnZXI7CgppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLmpkYmMuY29uZi5KREJDQ29uZmlndXJhdGlvbjsKaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLm1ldGEuQ2xhc3NNYXBwaW5n\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1hLlNjaGVt\nYUdyb3VwOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc3FsLlNR\nTEV4Y2VwdGlvbnM7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVs\nLlN0b3JlQ29udGV4dDsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRh\nLkNsYXNzTWV0YURhdGE7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRp\nbC5PcGVuSlBBRXhjZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLnV0aWwuU3RvcmVFeGNlcHRpb247CgovKioKICogQWJzdHJhY3Qgc2VxdWVu\nY2UgaW1wbGVtZW50YXRpb24uIEhhbmRsZXMgb2J0YWluaW5nIHRoZSBwcm9w\nZXIKICogY29ubmVjdGlvbiB0byB1c2VkIGJhc2VkIG9uIHdoZXRoZXIgdGhl\nIHNlcXVlbmNlIGlzIHRyYW5zYWN0aW9uYWwgYW5kCiAqIHdoZXRoZXIgYSBz\nZWNvbmQgZGF0YXNvdXJjZSBpcyBjb25maWd1cmVkLgogKgogKiBAYXV0aG9y\nIEFiZSBXaGl0ZQogKi8KcHVibGljIGFic3RyYWN0IGNsYXNzIEFic3RyYWN0\nSkRCQ1NlcQogICAgaW1wbGVtZW50cyBKREJDU2VxIHsKCiAgICBwcm90ZWN0\nZWQgaW50IHR5cGUgPSBUWVBFX0RFRkFVTFQ7CiAgICBwcm90ZWN0ZWQgT2Jq\nZWN0IGN1cnJlbnQgPSBudWxsOwogICAgcHJpdmF0ZSBzdGF0aWMgVGhyZWFk\nTG9jYWwgX291dGVyVHJhbnNhY3Rpb24gPSBuZXcgVGhyZWFkTG9jYWwoKTsK\nCiAgICAvKioKICAgICAqIFJlY29yZHMgdGhlIHNlcXVlbmNlIHR5cGUuCiAg\nICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldFR5cGUoaW50IHR5cGUpIHsKICAg\nICAgICB0aGlzLnR5cGUgPSB0eXBlOwogICAgfQoKICAgIHB1YmxpYyBPYmpl\nY3QgbmV4dChTdG9yZUNvbnRleHQgY3R4LCBDbGFzc01ldGFEYXRhIG1ldGEp\nIHsKICAgICAgICBKREJDU3RvcmUgc3RvcmUgPSBnZXRTdG9yZShjdHgpOwog\nICAgICAgIHRyeSB7CiAgICAgICAgICAgIGN1cnJlbnQgPSBuZXh0SW50ZXJu\nYWwoc3RvcmUsIChDbGFzc01hcHBpbmcpIG1ldGEpOwogICAgICAgICAgICBy\nZXR1cm4gY3VycmVudDsKICAgICAgICB9IGNhdGNoIChPcGVuSlBBRXhjZXB0\naW9uIGtlKSB7CiAgICAgICAgICAgIHRocm93IGtlOwogICAgICAgIH0gY2F0\nY2ggKFNRTEV4Y2VwdGlvbiBzZSkgewogICAgICAgICAgICB0aHJvdyBTUUxF\neGNlcHRpb25zLmdldFN0b3JlKHNlLCBzdG9yZS5nZXREQkRpY3Rpb25hcnko\nKSk7CiAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICAg\nICAgdGhyb3cgbmV3IFN0b3JlRXhjZXB0aW9uKGUpOwogICAgICAgIH0KICAg\nIH0KCiAgICBwdWJsaWMgT2JqZWN0IGN1cnJlbnQoU3RvcmVDb250ZXh0IGN0\neCwgQ2xhc3NNZXRhRGF0YSBtZXRhKSB7CiAgICAgICAgSkRCQ1N0b3JlIHN0\nb3JlID0gZ2V0U3RvcmUoY3R4KTsKICAgICAgICB0cnkgewogICAgICAgICAg\nICByZXR1cm4gY3VycmVudEludGVybmFsKHN0b3JlLCAoQ2xhc3NNYXBwaW5n\nKSBtZXRhKTsKICAgICAgICB9IGNhdGNoIChPcGVuSlBBRXhjZXB0aW9uIGtl\nKSB7CiAgICAgICAgICAgIHRocm93IGtlOwogICAgICAgIH0gY2F0Y2ggKFNR\nTEV4Y2VwdGlvbiBzZSkgewogICAgICAgICAgICB0aHJvdyBTUUxFeGNlcHRp\nb25zLmdldFN0b3JlKHNlLCBzdG9yZS5nZXREQkRpY3Rpb25hcnkoKSk7CiAg\nICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgdGhy\nb3cgbmV3IFN0b3JlRXhjZXB0aW9uKGUpOwogICAgICAgIH0KICAgIH0KCiAg\nICBwdWJsaWMgdm9pZCBhbGxvY2F0ZShpbnQgYWRkaXRpb25hbCwgU3RvcmVD\nb250ZXh0IGN0eCwgQ2xhc3NNZXRhRGF0YSBtZXRhKSB7CiAgICAgICAgSkRC\nQ1N0b3JlIHN0b3JlID0gZ2V0U3RvcmUoY3R4KTsKICAgICAgICB0cnkgewog\nICAgICAgICAgICBhbGxvY2F0ZUludGVybmFsKGFkZGl0aW9uYWwsIHN0b3Jl\nLCAoQ2xhc3NNYXBwaW5nKSBtZXRhKTsKICAgICAgICB9IGNhdGNoIChPcGVu\nSlBBRXhjZXB0aW9uIGtlKSB7CiAgICAgICAgICAgIHRocm93IGtlOwogICAg\nICAgIH0gY2F0Y2ggKFNRTEV4Y2VwdGlvbiBzZSkgewogICAgICAgICAgICB0\naHJvdyBTUUxFeGNlcHRpb25zLmdldFN0b3JlKHNlLCBzdG9yZS5nZXREQkRp\nY3Rpb25hcnkoKSk7CiAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsK\nICAgICAgICAgICAgdGhyb3cgbmV3IFN0b3JlRXhjZXB0aW9uKGUpOwogICAg\nICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIE5vLW9wLgogICAgICovCiAg\nICBwdWJsaWMgdm9pZCBhZGRTY2hlbWEoQ2xhc3NNYXBwaW5nIG1hcHBpbmcs\nIFNjaGVtYUdyb3VwIGdyb3VwKSB7CiAgICB9CgogICAgLyoqCiAgICAgKiBO\nby1vcC4KICAgICAqLwogICAgcHVibGljIHZvaWQgY2xvc2UoKSB7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIG5leHQgc2VxdWVuY2Ugb2Jq\nZWN0LgogICAgICovCiAgICBwcm90ZWN0ZWQgYWJzdHJhY3QgT2JqZWN0IG5l\neHRJbnRlcm5hbChKREJDU3RvcmUgc3RvcmUsCiAgICAgICAgQ2xhc3NNYXBw\naW5nIG1hcHBpbmcpCiAgICAgICAgdGhyb3dzIEV4Y2VwdGlvbjsKICAgIAog\nICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIHtAbGluayBKREJDQ29uZmlndXJh\ndGlvbn0gZm9yIHRoaXMgc2VxdWVuY2UuCiAgICAgKi8KICAgIHB1YmxpYyBh\nYnN0cmFjdCBKREJDQ29uZmlndXJhdGlvbiBnZXRDb25maWd1cmF0aW9uKCk7\nCgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIGN1cnJlbnQgc2VxdWVuY2Ug\nb2JqZWN0LiBCeSBkZWZhdWx0IHJldHVybnMgdGhlIGxhc3QKICAgICAqIHNl\ncXVlbmNlIHZhbHVlIHVzZWQsIG9yIG51bGwgaWYgbm8gc2VxdWVuY2UgdmFs\ndWVzIGhhdmUgYmVlbiByZXF1ZXN0ZWQKICAgICAqIHlldC4gRGVmYXVsdCBp\nbXBsZW1lbnRhdGlvbiBpcyBub3QgdGhyZWFkc2FmZS4KICAgICAqLwogICAg\ncHJvdGVjdGVkIE9iamVjdCBjdXJyZW50SW50ZXJuYWwoSkRCQ1N0b3JlIHN0\nb3JlLCBDbGFzc01hcHBpbmcgbWFwcGluZykKICAgICAgICB0aHJvd3MgRXhj\nZXB0aW9uIHsKICAgICAgICByZXR1cm4gY3VycmVudDsKICAgIH0KCiAgICAv\nKioKICAgICAqIEFsbG9jYXRlIGFkZGl0aW9uYWwgc2VxdWVuY2UgdmFsdWVz\nLiBEb2VzIG5vdGhpbmcgYnkgZGVmYXVsdC4KICAgICAqLwogICAgcHJvdGVj\ndGVkIHZvaWQgYWxsb2NhdGVJbnRlcm5hbChpbnQgYWRkaXRpb25hbCwgSkRC\nQ1N0b3JlIHN0b3JlLAogICAgICAgIENsYXNzTWFwcGluZyBtYXBwaW5nKQog\nICAgICAgIHRocm93cyBFeGNlcHRpb24gewogICAgfQoKICAgIC8qKgogICAg\nICogRXh0cmFjdCB0aGUgc3RvcmUgZnJvbSB0aGUgZ2l2ZW4gY29udGV4dC4K\nICAgICAqLwogICAgcHJpdmF0ZSBKREJDU3RvcmUgZ2V0U3RvcmUoU3RvcmVD\nb250ZXh0IGN0eCkgewogICAgICAgIHJldHVybiAoSkRCQ1N0b3JlKSBjdHgu\nZ2V0U3RvcmVNYW5hZ2VyKCkuZ2V0SW5uZXJtb3N0RGVsZWdhdGUoKTsKICAg\nIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgY29ubmVjdGlvbiB0byB1\nc2UgYmFzZWQgb24gdGhlIHR5cGUgb2Ygc2VxdWVuY2UuIFRoaXMKICAgICAq\nIGNvbm5lY3Rpb24gd2lsbCBhdXRvbWF0aWNhbGx5IGJlIGNsb3NlZDsgZG8g\nbm90IGNsb3NlIGl0LgogICAgICovCiAgICBwcm90ZWN0ZWQgQ29ubmVjdGlv\nbiBnZXRDb25uZWN0aW9uKEpEQkNTdG9yZSBzdG9yZSkKICAgICAgICB0aHJv\nd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBpZiAodHlwZSA9PSBUWVBFX1RS\nQU5TQUNUSU9OQUwgfHwgdHlwZSA9PSBUWVBFX0NPTlRJR1VPVVMpCiAgICAg\nICAgICAgIHJldHVybiBzdG9yZS5nZXRDb25uZWN0aW9uKCk7CiAgICAgICAg\nZWxzZSBpZiAoc3VzcGVuZEluSlRBKCkpIHsKICAgICAgICAgICAgdHJ5IHsK\nICAgICAgICAgICAgICAgIFRyYW5zYWN0aW9uTWFuYWdlciB0bSA9IGdldENv\nbmZpZ3VyYXRpb24oKQogICAgICAgICAgICAgICAgICAgIC5nZXRNYW5hZ2Vk\nUnVudGltZUluc3RhbmNlKCkuZ2V0VHJhbnNhY3Rpb25NYW5hZ2VyKCk7CiAg\nICAgICAgICAgICAgICBfb3V0ZXJUcmFuc2FjdGlvbi5zZXQodG0uc3VzcGVu\nZCgpKTsKICAgICAgICAgICAgICAgIHRtLmJlZ2luKCk7CiAgICAgICAgICAg\nICAgICByZXR1cm4gc3RvcmUuZ2V0Q29ubmVjdGlvbigpOwogICAgICAgICAg\nICB9IGNhdGNoIChFeGNlcHRpb24gZSkgewogICAgICAgICAgICAgICAgdGhy\nb3cgbmV3IFN0b3JlRXhjZXB0aW9uKGUpOwogICAgICAgICAgICB9CiAgICAg\nICAgfSBlbHNlIHsKICAgICAgICAgICAgSkRCQ0NvbmZpZ3VyYXRpb24gY29u\nZiA9IHN0b3JlLmdldENvbmZpZ3VyYXRpb24oKTsKICAgICAgICAgICAgRGF0\nYVNvdXJjZSBkcyA9IGNvbmYuZ2V0RGF0YVNvdXJjZTIoc3RvcmUuZ2V0Q29u\ndGV4dCgpKTsKICAgICAgICAgICAgQ29ubmVjdGlvbiBjb25uID0gZHMuZ2V0\nQ29ubmVjdGlvbigpOwogICAgICAgICAgICBpZiAoY29ubi5nZXRBdXRvQ29t\nbWl0KCkpCiAgICAgICAgICAgICAgICBjb25uLnNldEF1dG9Db21taXQoZmFs\nc2UpOwogICAgICAgICAgICByZXR1cm4gY29ubjsKICAgICAgICB9CiAgICB9\nCgogICAgLyoqCiAgICAgKiBDbG9zZSB0aGUgY3VycmVudCBjb25uZWN0aW9u\nLgogICAgICovCiAgICBwcm90ZWN0ZWQgdm9pZCBjbG9zZUNvbm5lY3Rpb24o\nQ29ubmVjdGlvbiBjb25uKSB7CiAgICAgICAgaWYgKGNvbm4gPT0gbnVsbCkK\nICAgICAgICAgICAgcmV0dXJuOwoKICAgICAgICBpZiAodHlwZSA9PSBUWVBF\nX1RSQU5TQUNUSU9OQUwgfHwgdHlwZSA9PSBUWVBFX0NPTlRJR1VPVVMpIHsK\nICAgICAgICAgICAgLy8gZG8gbm90aGluZzsgdGhpcyBzZXEgaXMgcGFydCBv\nZiB0aGUgYnVzaW5lc3MgdHJhbnNhY3Rpb24KICAgICAgICAgICAgcmV0dXJu\nOwogICAgICAgIH0gZWxzZSBpZiAoc3VzcGVuZEluSlRBKCkpIHsKICAgICAg\nICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIFRyYW5zYWN0aW9uTWFuYWdl\nciB0bSA9IGdldENvbmZpZ3VyYXRpb24oKQogICAgICAgICAgICAgICAgICAg\nIC5nZXRNYW5hZ2VkUnVudGltZUluc3RhbmNlKCkuZ2V0VHJhbnNhY3Rpb25N\nYW5hZ2VyKCk7CiAgICAgICAgICAgICAgICB0bS5jb21taXQoKTsKICAgICAg\nICAgICAgICAgIHRyeSB7IGNvbm4uY2xvc2UoKTsgfSBjYXRjaCAoU1FMRXhj\nZXB0aW9uIHNlKSB7fQoKICAgICAgICAgICAgICAgIFRyYW5zYWN0aW9uIG91\ndGVyVHhuID0gKFRyYW5zYWN0aW9uKV9vdXRlclRyYW5zYWN0aW9uLmdldCgp\nOwogICAgICAgICAgICAgICAgaWYgKG91dGVyVHhuICE9IG51bGwpCiAgICAg\nICAgICAgICAgICAgICAgdG0ucmVzdW1lKG91dGVyVHhuKTsKCiAgICAgICAg\nICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgICAgICB0\naHJvdyBuZXcgU3RvcmVFeGNlcHRpb24oZSk7CiAgICAgICAgICAgIH0gZmlu\nYWxseSB7CiAgICAgICAgICAgICAgICBfb3V0ZXJUcmFuc2FjdGlvbi5zZXQo\nbnVsbCk7CiAgICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAg\nICAgICB0cnkgewogICAgICAgICAgICAgICAgY29ubi5jb21taXQoKTsKICAg\nICAgICAgICAgfSBjYXRjaCAoU1FMRXhjZXB0aW9uIHNlKSB7CiAgICAgICAg\nICAgICAgICB0aHJvdyBTUUxFeGNlcHRpb25zLmdldFN0b3JlKHNlKTsKICAg\nICAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgICAgIHRyeSB7IGNv\nbm4uY2xvc2UoKTsgfSBjYXRjaCAoU1FMRXhjZXB0aW9uIHNlKSB7fQogICAg\nICAgICAgICB9CiAgICAgICAgfQogICAgfQogICAgCiAgICAvKioKICAgICAq\nIERldGVjdCB3aGV0aGVyIG9yIG5vdCBPcGVuSlBBIHNob3VsZCBzdXNwZW5k\nIHRoZSB0cmFuc2FjdGlvbiBpbiAKICAgICAqIGEgbWFuYWdlZCBlbnZpcm9u\nbWVudC4KICAgICAqLwogICAgcHJvdGVjdGVkIGJvb2xlYW4gc3VzcGVuZElu\nSlRBKCkgewogICAgICAgIHJldHVybiBnZXRDb25maWd1cmF0aW9uKCkuaXND\nb25uZWN0aW9uRmFjdG9yeU1vZGVNYW5hZ2VkKCkgJiYgCiAgICAgICAgICAg\nIGdldENvbmZpZ3VyYXRpb24oKS5nZXRDb25uZWN0aW9uRmFjdG9yeTIoKSA9\nPSBudWxsOwogICAgfQp9Cg==\n","encoding":"base64"}

