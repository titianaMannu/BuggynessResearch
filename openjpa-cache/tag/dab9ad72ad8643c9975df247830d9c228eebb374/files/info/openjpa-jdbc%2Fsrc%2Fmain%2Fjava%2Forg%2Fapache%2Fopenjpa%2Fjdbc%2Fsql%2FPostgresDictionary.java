{"sha":"a6bd7a4b081a58135c8f5ce8202afb34ff81f990","node_id":"MDQ6QmxvYjIwNjM2NDphNmJkN2E0YjA4MWE1ODEzNWM4ZjVjZTgyMDJhZmIzNGZmODFmOTkw","size":14749,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/a6bd7a4b081a58135c8f5ce8202afb34ff81f990","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zcWw7CgppbXBvcnQg\namF2YS5zcWwuQ29ubmVjdGlvbjsKaW1wb3J0IGphdmEuc3FsLlByZXBhcmVk\nU3RhdGVtZW50OwppbXBvcnQgamF2YS5zcWwuUmVzdWx0U2V0OwppbXBvcnQg\namF2YS5zcWwuU1FMRXhjZXB0aW9uOwppbXBvcnQgamF2YS5zcWwuU3RhdGVt\nZW50OwppbXBvcnQgamF2YS5zcWwuVHlwZXM7CmltcG9ydCBqYXZhLnRleHQu\nUGFyc2VFeGNlcHRpb247CmltcG9ydCBqYXZhLnRleHQuU2ltcGxlRGF0ZUZv\ncm1hdDsKaW1wb3J0IGphdmEudXRpbC5BcnJheXM7CmltcG9ydCBqYXZhLnV0\naWwuRGF0ZTsKCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5rZXJu\nZWwuZXhwcy5GaWx0ZXJWYWx1ZTsKaW1wb3J0IG9yZy5hcGFjaGUub3Blbmpw\nYS5qZGJjLnNjaGVtYS5Db2x1bW47CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEuamRiYy5zY2hlbWEuU2VxdWVuY2U7CmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEuamRiYy5zY2hlbWEuVGFibGU7CmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEubGliLmpkYmMuRGVsZWdhdGluZ0Nvbm5lY3Rpb247CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEubGliLmpkYmMuRGVsZWdhdGluZ1ByZXBhcmVk\nU3RhdGVtZW50OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51dGls\nLkxvY2FsaXplcjsKCi8qKgogKiBEaWN0aW9uYXJ5IGZvciBQb3N0Z3Jlcy4K\nICovCnB1YmxpYyBjbGFzcyBQb3N0Z3Jlc0RpY3Rpb25hcnkKICAgIGV4dGVu\nZHMgREJEaWN0aW9uYXJ5IHsKCiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBM\nb2NhbGl6ZXIgX2xvYyA9IExvY2FsaXplci5mb3JQYWNrYWdlCiAgICAgICAg\nKFBvc3RncmVzRGljdGlvbmFyeS5jbGFzcyk7CgogICAgLyoqCiAgICAgKiBT\nUUwgc3RhdGVtZW50IHRvIGxvYWQgYWxsIHNlcXVlbmNlIHNjaGVtYSxuYW1l\nIHBhaXJzIGZyb20gYWxsIHNjaGVtYXMuCiAgICAgKi8KICAgIHB1YmxpYyBT\ndHJpbmcgYWxsU2VxdWVuY2VzU1FMID0gIlNFTEVDVCBOVUxMIEFTIFNFUVVF\nTkNFX1NDSEVNQSwgcmVsbmFtZSAiICsKICAgICAgICAiQVMgU0VRVUVOQ0Vf\nTkFNRSBGUk9NIHBnX2NsYXNzIFdIRVJFIHJlbGtpbmQ9J1MnIjsKCiAgICAv\nKioKICAgICAqIFNRTCBzdGF0ZW1lbnQgdG8gbG9hZCBzY2hlbWEsbmFtZSBw\nYWlycyBmb3IgYWxsIHNlcXVlbmNlcyB3aXRoIGEKICAgICAqIGNlcnRhaW4g\nbmFtZSBmcm9tIGFsbCBzY2hlbWFzLgogICAgICovCiAgICBwdWJsaWMgU3Ry\naW5nIG5hbWVkU2VxdWVuY2VzRnJvbUFsbFNjaGVtYXNTUUwgPSAiU0VMRUNU\nIE5VTEwgQVMgIiArCiAgICAgICAgIlNFUVVFTkNFX1NDSEVNQSwgcmVsbmFt\nZSBBUyBTRVFVRU5DRV9OQU1FIEZST00gcGdfY2xhc3MgIiArCiAgICAgICAg\nIldIRVJFIHJlbGtpbmQ9J1MnIEFORCByZWxuYW1lID0gPyI7CgogICAgLyoq\nCiAgICAgKiBTUUwgc3RhdGVtZW50IHRvIGxvYWQgc2NoZW1hLG5hbWUgcGFp\ncnMgZnJvbSBhIG5hbWVkIHNjaGVtYS4KICAgICAqLwogICAgcHVibGljIFN0\ncmluZyBhbGxTZXF1ZW5jZXNGcm9tT25lU2NoZW1hU1FMID0gIlNFTEVDVCBO\nVUxMIEFTICIgKwogICAgICAgICJTRVFVRU5DRV9TQ0hFTUEsIHJlbG5hbWUg\nQVMgU0VRVUVOQ0VfTkFNRSBGUk9NIHBnX2NsYXNzLCAiICsKICAgICAgICAi\ncGdfbmFtZXNwYWNlIFdIRVJFIHJlbGtpbmQ9J1MnIEFORCBwZ19jbGFzcy5y\nZWxuYW1lc3BhY2UgPSAiICsKICAgICAgICAicGdfbmFtZXNwYWNlLm9pZCBB\nTkQgbnNwbmFtZSA9ID8iOwoKICAgIC8qKgogICAgICogU1FMIHN0YXRlbWVu\ndCB0byBsb2FkIGEgc2VxdWVuY2UncyBzY2hlbWEsbmFtZSBwYWlyIGZyb20g\nb25lIHNjaGVtYS4KICAgICAqLwogICAgcHVibGljIFN0cmluZyBuYW1lZFNl\ncXVlbmNlRnJvbU9uZVNjaGVtYVNRTCA9ICJTRUxFQ1QgTlVMTCBBUyAiICsK\nICAgICAgICAiU0VRVUVOQ0VfU0NIRU1BLCByZWxuYW1lIEFTIFNFUVVFTkNF\nX05BTUUgRlJPTSBwZ19jbGFzcywgIiArCiAgICAgICAgInBnX25hbWVzcGFj\nZSBXSEVSRSByZWxraW5kPSdTJyBBTkQgcGdfY2xhc3MucmVsbmFtZXNwYWNl\nID0gIiArCiAgICAgICAgInBnX25hbWVzcGFjZS5vaWQgQU5EIHJlbG5hbWUg\nPSA/IEFORCBuc3BuYW1lID0gPyI7CgogICAgLyoqCiAgICAgKiBTb21lIFBv\nc3RncmVzIGRyaXZlcnMgZG8gbm90IHN1cHBvcnQgdGhlIHtAbGluayBTdGF0\nZW1lbnQjc2V0RmV0Y2hTaXplfQogICAgICogbWV0aG9kLgogICAgICovCiAg\nICBwdWJsaWMgYm9vbGVhbiBzdXBwb3J0c1NldEZldGNoU2l6ZSA9IHRydWU7\nCgogICAgcHVibGljIFBvc3RncmVzRGljdGlvbmFyeSgpIHsKICAgICAgICBw\nbGF0Zm9ybSA9ICJQb3N0Z3JlU1FMIjsKICAgICAgICB2YWxpZGF0aW9uU1FM\nID0gIlNFTEVDVCBOT1coKSI7CiAgICAgICAgZGF0ZVByZWNpc2lvbiA9IENF\nTlRJOwogICAgICAgIHN1cHBvcnRzQWx0ZXJUYWJsZVdpdGhEcm9wQ29sdW1u\nID0gZmFsc2U7CiAgICAgICAgc3VwcG9ydHNEZWZlcnJlZENvbnN0cmFpbnRz\nID0gdHJ1ZTsKICAgICAgICBzdXBwb3J0c1NlbGVjdFN0YXJ0SW5kZXggPSB0\ncnVlOwogICAgICAgIHN1cHBvcnRzU2VsZWN0RW5kSW5kZXggPSB0cnVlOwoK\nICAgICAgICAvLyBQb3N0Z3JlU1FMIHJlcXVpcmVzIGRvdWJsZS1lc2NhcGUg\nZm9yIHN0cmluZ3MKICAgICAgICBzZWFyY2hTdHJpbmdFc2NhcGUgPSAiXFxc\nXCI7CgogICAgICAgIG1heFRhYmxlTmFtZUxlbmd0aCA9IDYzOwogICAgICAg\nIG1heENvbHVtbk5hbWVMZW5ndGggPSA2MzsKICAgICAgICBtYXhJbmRleE5h\nbWVMZW5ndGggPSA2MzsKICAgICAgICBtYXhDb25zdHJhaW50TmFtZUxlbmd0\naCA9IDYzOwogICAgICAgIHNjaGVtYUNhc2UgPSBTQ0hFTUFfQ0FTRV9MT1dF\nUjsKICAgICAgICByYW5nZVBvc2l0aW9uID0gUkFOR0VfUE9TVF9MT0NLOwog\nICAgICAgIHJlcXVpcmVzQWxpYXNGb3JTdWJzZWxlY3QgPSB0cnVlOwogICAg\nICAgIGFsbG93c0FsaWFzSW5CdWxrQ2xhdXNlID0gZmFsc2U7CgogICAgICAg\nIC8vIHsyfSBpcyB0aGUgcmVzdWx0IG9mIGdldEdlbmVyYXRlZEtleVNlcXVl\nbmNlTmFtZTsgdGhlCiAgICAgICAgLy8gc2luZ2xlLXF1b3RlIGVzY2FwZSB3\naWxsIHJlc3VsdCBpbiBTRUxFQ1QgQ1VSVkFMKCdteXNlcXVlbmNlJykKICAg\nICAgICBsYXN0R2VuZXJhdGVkS2V5UXVlcnkgPSAiU0VMRUNUIENVUlJWQUwo\nJyd7Mn0nJykiOwogICAgICAgIHN1cHBvcnRzQXV0b0Fzc2lnbiA9IHRydWU7\nCiAgICAgICAgYXV0b0Fzc2lnblR5cGVOYW1lID0gIkJJR1NFUklBTCI7CiAg\nICAgICAgbmV4dFNlcXVlbmNlUXVlcnkgPSAiU0VMRUNUIE5FWFRWQUwoJyd7\nMH0nJykiOwoKICAgICAgICB1c2VHZXRCeXRlc0ZvckJsb2JzID0gdHJ1ZTsK\nICAgICAgICB1c2VTZXRCeXRlc0ZvckJsb2JzID0gdHJ1ZTsKICAgICAgICB1\nc2VHZXRTdHJpbmdGb3JDbG9icyA9IHRydWU7CiAgICAgICAgdXNlU2V0U3Ry\naW5nRm9yQ2xvYnMgPSB0cnVlOwogICAgICAgIGJpdFR5cGVOYW1lID0gIkJP\nT0wiOwogICAgICAgIHNtYWxsaW50VHlwZU5hbWUgPSAiU01BTExJTlQiOwog\nICAgICAgIHJlYWxUeXBlTmFtZSA9ICJGTE9BVDgiOwogICAgICAgIHRpbnlp\nbnRUeXBlTmFtZSA9ICJTTUFMTElOVCI7CiAgICAgICAgYmluYXJ5VHlwZU5h\nbWUgPSAiQllURUEiOwogICAgICAgIGJsb2JUeXBlTmFtZSA9ICJCWVRFQSI7\nCiAgICAgICAgbG9uZ1ZhcmJpbmFyeVR5cGVOYW1lID0gIkJZVEVBIjsKICAg\nICAgICB2YXJiaW5hcnlUeXBlTmFtZSA9ICJCWVRFQSI7CiAgICAgICAgY2xv\nYlR5cGVOYW1lID0gIlRFWFQiOwogICAgICAgIGxvbmdWYXJjaGFyVHlwZU5h\nbWUgPSAiVEVYVCI7CiAgICAgICAgZG91YmxlVHlwZU5hbWUgPSAiRE9VQkxF\nIFBSRUNJU0lPTiI7CiAgICAgICAgdmFyY2hhclR5cGVOYW1lID0gIlZBUkNI\nQVJ7MH0iOwogICAgICAgIHRpbWVzdGFtcFR5cGVOYW1lID0gIkFCU1RJTUUi\nOwogICAgICAgIGZpeGVkU2l6ZVR5cGVOYW1lU2V0LmFkZEFsbChBcnJheXMu\nYXNMaXN0KG5ldyBTdHJpbmdbXXsKICAgICAgICAgICAgIkJPT0wiLCAiQllU\nRUEiLCAiTkFNRSIsICJJTlQ4IiwgIklOVDIiLCAiSU5UMlZFQ1RPUiIsICJJ\nTlQ0IiwKICAgICAgICAgICAgIlJFR1BST0MiLCAiVEVYVCIsICJPSUQiLCAi\nVElEIiwgIlhJRCIsICJDSUQiLCAiT0lEVkVDVE9SIiwKICAgICAgICAgICAg\nIlNFVCIsICJGTE9BVDQiLCAiRkxPQVQ4IiwgIkFCU1RJTUUiLCAiUkVMVElN\nRSIsICJUSU5URVJWQUwiLAogICAgICAgICAgICAiTU9ORVkiLAogICAgICAg\nIH0pKTsKCiAgICAgICAgc3VwcG9ydHNMb2NraW5nV2l0aERpc3RpbmN0Q2xh\ndXNlID0gZmFsc2U7CiAgICAgICAgc3VwcG9ydHNMb2NraW5nV2l0aE91dGVy\nSm9pbiA9IGZhbHNlOwogICAgICAgIHN1cHBvcnRzTnVsbFRhYmxlRm9yR2V0\nSW1wb3J0ZWRLZXlzID0gdHJ1ZTsKCiAgICAgICAgcmVzZXJ2ZWRXb3JkU2V0\nLmFkZEFsbChBcnJheXMuYXNMaXN0KG5ldyBTdHJpbmdbXXsKICAgICAgICAg\nICAgIkFCT1JUIiwgIkFDTCIsICJBR0dSRUdBVEUiLCAiQVBQRU5EIiwgIkFS\nQ0hJVkUiLCAiQVJDSF9TVE9SRSIsCiAgICAgICAgICAgICJCQUNLV0FSRCIs\nICJCSU5BUlkiLCAiQ0hBTkdFIiwgIkNMVVNURVIiLCAiQ09QWSIsICJEQVRB\nQkFTRSIsCiAgICAgICAgICAgICJERUxJTUlURVIiLCAiREVMSU1JVEVSUyIs\nICJETyIsICJFWFBMQUlOIiwgIkVYVEVORCIsCiAgICAgICAgICAgICJGT1JX\nQVJEIiwgIkhFQVZZIiwgIklOREVYIiwgIklOSEVSSVRTIiwgIklTTlVMTCIs\nICJMSUdIVCIsCiAgICAgICAgICAgICJMSVNURU4iLCAiTE9BRCIsICJNRVJH\nRSIsICJOT1RISU5HIiwgIk5PVElGWSIsICJOT1ROVUxMIiwKICAgICAgICAg\nICAgIk9JRCIsICJPSURTIiwgIlBVUkdFIiwgIlJFQ0lQRSIsICJSRU5BTUUi\nLCAiUkVQTEFDRSIsCiAgICAgICAgICAgICJSRVRSSUVWRSIsICJSRVRVUk5T\nIiwgIlJVTEUiLCAiU0VUT0YiLCAiU1RESU4iLCAiU1RET1VUIiwKICAgICAg\nICAgICAgIlNUT1JFIiwgIlZBQ1VVTSIsICJWRVJCT1NFIiwgIlZFUlNJT04i\nLAogICAgICAgIH0pKTsKICAgIH0KCiAgICBwdWJsaWMgRGF0ZSBnZXREYXRl\nKFJlc3VsdFNldCBycywgaW50IGNvbHVtbikKICAgICAgICB0aHJvd3MgU1FM\nRXhjZXB0aW9uIHsKICAgICAgICB0cnkgewogICAgICAgICAgICByZXR1cm4g\nc3VwZXIuZ2V0RGF0ZShycywgY29sdW1uKTsKICAgICAgICB9IGNhdGNoIChT\ndHJpbmdJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uIHNpb29iZSkgewogICAg\nICAgICAgICAvLyB0aGVyZSBpcyBhIGJ1ZyBpbiBzb21lIHZlcnNpb25zIG9m\nIHRoZSBwb3N0Z3JlcyBKREJDCiAgICAgICAgICAgIC8vIGRyaXZlciBzdWNo\nIHRoYXQgYSBkYXRlIHdpdGggbm90IGVub3VnaCBudW1iZXJzIGluIGl0CiAg\nICAgICAgICAgIC8vIHdpbGwgdGhyb3cgYSBwYXJzaW5nIGV4Y2VwdGlvbjog\ndGhpcyB0cmllcyB0byB3b3JrCiAgICAgICAgICAgIC8vIGFyb3VuZCBpdC4g\nVGhlIGJ1ZyBvbmx5IG9jY3VycyB3aGVuIHRoZXJlIGlzIGEgdHJhaWxpbmcK\nICAgICAgICAgICAgLy8gbWlsbGlzZWNvbmQgbWlzc2luZyBmcm9tIHRoZSBl\nbmQuIEUuZy4sIHdoZW4gdGhlIGRhdGUgaXMKICAgICAgICAgICAgLy8gbGlr\nZToKICAgICAgICAgICAgLy8gMjA2Ni0xMC0xOSAyMjowODozMi44MwogICAg\nICAgICAgICAvLyByYXRoZXIgdGhhbiB3aGF0IHRoZSBkcml2ZXIgZXhwZWN0\nczoKICAgICAgICAgICAgLy8gMjA2Ni0xMC0xOSAyMjowODozMi44MzAKICAg\nICAgICAgICAgU3RyaW5nIGRhdGVTdHIgPSBycy5nZXRTdHJpbmcoY29sdW1u\nKTsKICAgICAgICAgICAgU2ltcGxlRGF0ZUZvcm1hdCBmbXQgPSBuZXcgU2lt\ncGxlRGF0ZUZvcm1hdCgKICAgICAgICAgICAgICAgICJ5eXl5LU1NLWRkIGho\nOm1tOnNzLlNTIik7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAg\nICByZXR1cm4gZm10LnBhcnNlKGRhdGVTdHIpOwogICAgICAgICAgICB9IGNh\ndGNoIChQYXJzZUV4Y2VwdGlvbiBwZSkgewogICAgICAgICAgICAgICAgdGhy\nb3cgbmV3IFNRTEV4Y2VwdGlvbihwZS50b1N0cmluZygpKTsKICAgICAgICAg\nICAgfQogICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMgYnl0ZSBnZXRCeXRl\nKFJlc3VsdFNldCBycywgaW50IGNvbHVtbikKICAgICAgICB0aHJvd3MgU1FM\nRXhjZXB0aW9uIHsKICAgICAgICAvLyBwb3N0Z3JlcyBkb2VzIG5vdCBwZXJm\nb3JtIGF1dG9tYXRpYyBjb252ZXJzaW9ucywgc28gYXR0ZW1wdGluZyB0bwog\nICAgICAgIC8vIGdldCBhIHdob2xlIG51bWJlciBvdXQgb2YgYSBkZWNpbWFs\nIHdpbGwgdGhyb3cgYW4gZXhjZXB0aW9uLgogICAgICAgIC8vIGZhbGwgYmFj\nayB0byBwZXJmb3JtaW5nIG1hbnVhbCBjb252ZXJzaW9uIGlmIHRoZSBpbml0\naWFsIGdldCBmYWlscwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIHJldHVy\nbiBzdXBlci5nZXRCeXRlKHJzLCBjb2x1bW4pOwogICAgICAgIH0gY2F0Y2gg\nKFNRTEV4Y2VwdGlvbiBzcWxlKSB7CiAgICAgICAgICAgIHJldHVybiBzdXBl\nci5nZXRCaWdEZWNpbWFsKHJzLCBjb2x1bW4pLmJ5dGVWYWx1ZSgpOwogICAg\nICAgIH0KICAgIH0KCiAgICBwdWJsaWMgc2hvcnQgZ2V0U2hvcnQoUmVzdWx0\nU2V0IHJzLCBpbnQgY29sdW1uKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRp\nb24gewogICAgICAgIC8vIHBvc3RncmVzIGRvZXMgbm90IHBlcmZvcm0gYXV0\nb21hdGljIGNvbnZlcnNpb25zLCBzbyBhdHRlbXB0aW5nIHRvCiAgICAgICAg\nLy8gZ2V0IGEgd2hvbGUgbnVtYmVyIG91dCBvZiBhIGRlY2ltYWwgd2lsbCB0\naHJvdyBhbiBleGNlcHRpb24uCiAgICAgICAgLy8gZmFsbCBiYWNrIHRvIHBl\ncmZvcm1pbmcgbWFudWFsIGNvbnZlcnNpb24gaWYgdGhlIGluaXRpYWwgZ2V0\nIGZhaWxzCiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgcmV0dXJuIHN1cGVy\nLmdldFNob3J0KHJzLCBjb2x1bW4pOwogICAgICAgIH0gY2F0Y2ggKFNRTEV4\nY2VwdGlvbiBzcWxlKSB7CiAgICAgICAgICAgIHJldHVybiBzdXBlci5nZXRC\naWdEZWNpbWFsKHJzLCBjb2x1bW4pLnNob3J0VmFsdWUoKTsKICAgICAgICB9\nCiAgICB9CgogICAgcHVibGljIGludCBnZXRJbnQoUmVzdWx0U2V0IHJzLCBp\nbnQgY29sdW1uKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAg\nICAgIC8vIHBvc3RncmVzIGRvZXMgbm90IHBlcmZvcm0gYXV0b21hdGljIGNv\nbnZlcnNpb25zLCBzbyBhdHRlbXB0aW5nIHRvCiAgICAgICAgLy8gZ2V0IGEg\nd2hvbGUgbnVtYmVyIG91dCBvZiBhIGRlY2ltYWwgd2lsbCB0aHJvdyBhbiBl\neGNlcHRpb24uCiAgICAgICAgLy8gZmFsbCBiYWNrIHRvIHBlcmZvcm1pbmcg\nbWFudWFsIGNvbnZlcnNpb24gaWYgdGhlIGluaXRpYWwgZ2V0IGZhaWxzCiAg\nICAgICAgdHJ5IHsKICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmdldEludChy\ncywgY29sdW1uKTsKICAgICAgICB9IGNhdGNoIChTUUxFeGNlcHRpb24gc3Fs\nZSkgewogICAgICAgICAgICByZXR1cm4gc3VwZXIuZ2V0QmlnRGVjaW1hbChy\ncywgY29sdW1uKS5pbnRWYWx1ZSgpOwogICAgICAgIH0KICAgIH0KCiAgICBw\ndWJsaWMgbG9uZyBnZXRMb25nKFJlc3VsdFNldCBycywgaW50IGNvbHVtbikK\nICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAvLyBwb3N0\nZ3JlcyBkb2VzIG5vdCBwZXJmb3JtIGF1dG9tYXRpYyBjb252ZXJzaW9ucywg\nc28gYXR0ZW1wdGluZyB0bwogICAgICAgIC8vIGdldCBhIHdob2xlIG51bWJl\nciBvdXQgb2YgYSBkZWNpbWFsIHdpbGwgdGhyb3cgYW4gZXhjZXB0aW9uLgog\nICAgICAgIC8vIGZhbGwgYmFjayB0byBwZXJmb3JtaW5nIG1hbnVhbCBjb252\nZXJzaW9uIGlmIHRoZSBpbml0aWFsIGdldCBmYWlscwogICAgICAgIHRyeSB7\nCiAgICAgICAgICAgIHJldHVybiBzdXBlci5nZXRMb25nKHJzLCBjb2x1bW4p\nOwogICAgICAgIH0gY2F0Y2ggKFNRTEV4Y2VwdGlvbiBzcWxlKSB7CiAgICAg\nICAgICAgIHJldHVybiBzdXBlci5nZXRCaWdEZWNpbWFsKHJzLCBjb2x1bW4p\nLmxvbmdWYWx1ZSgpOwogICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMgdm9p\nZCBzZXRCb29sZWFuKFByZXBhcmVkU3RhdGVtZW50IHN0bW50LCBpbnQgaWR4\nLCBib29sZWFuIHZhbCwKICAgICAgICBDb2x1bW4gY29sKQogICAgICAgIHRo\ncm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIC8vIHBvc3RncmVzIGFjdHVh\nbGx5IHJlcXVpcmVzIHRoYXQgYSBib29sZWFuIGJlIHNldDogaXQgY2Fubm90\nCiAgICAgICAgLy8gaGFuZGxlIGEgbnVtZXJpYyBhcmd1bWVudC4KICAgICAg\nICBzdG1udC5zZXRCb29sZWFuKGlkeCwgdmFsKTsKICAgIH0KCiAgICBwdWJs\naWMgdm9pZCBzZXROdWxsKFByZXBhcmVkU3RhdGVtZW50IHN0bW50LCBpbnQg\naWR4LCBpbnQgY29sVHlwZSwKICAgICAgICBDb2x1bW4gY29sKQogICAgICAg\nIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIC8vIE9QRU5KUEEtCiAg\nICAgICAgaWYgKGNvbFR5cGUgPT0gVHlwZXMuQkxPQikKICAgICAgICAgICAg\nY29sVHlwZSA9IFR5cGVzLkJJTkFSWTsKICAgICAgICBzdG1udC5zZXROdWxs\nKGlkeCwgY29sVHlwZSk7CiAgICB9CgogICAgcHJvdGVjdGVkIHZvaWQgYXBw\nZW5kU2VsZWN0UmFuZ2UoU1FMQnVmZmVyIGJ1ZiwgbG9uZyBzdGFydCwgbG9u\nZyBlbmQpIHsKICAgICAgICBpZiAoZW5kICE9IExvbmcuTUFYX1ZBTFVFKQog\nICAgICAgICAgICBidWYuYXBwZW5kKCIgTElNSVQgIikuYXBwZW5kVmFsdWUo\nZW5kIC0gc3RhcnQpOwogICAgICAgIGlmIChzdGFydCAhPSAwKQogICAgICAg\nICAgICBidWYuYXBwZW5kKCIgT0ZGU0VUICIpLmFwcGVuZFZhbHVlKHN0YXJ0\nKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBpbmRleE9mKFNRTEJ1ZmZlciBi\ndWYsIEZpbHRlclZhbHVlIHN0ciwgRmlsdGVyVmFsdWUgZmluZCwKICAgICAg\nICBGaWx0ZXJWYWx1ZSBzdGFydCkgewogICAgICAgIGJ1Zi5hcHBlbmQoIihQ\nT1NJVElPTigiKTsKICAgICAgICBmaW5kLmFwcGVuZFRvKGJ1Zik7CiAgICAg\nICAgYnVmLmFwcGVuZCgiIElOICIpOwogICAgICAgIGlmIChzdGFydCAhPSBu\ndWxsKQogICAgICAgICAgICBzdWJzdHJpbmcoYnVmLCBzdHIsIHN0YXJ0LCBu\ndWxsKTsKICAgICAgICBlbHNlCiAgICAgICAgICAgIHN0ci5hcHBlbmRUbyhi\ndWYpOwogICAgICAgIGJ1Zi5hcHBlbmQoIikgLSAxIik7CiAgICAgICAgaWYg\nKHN0YXJ0ICE9IG51bGwpIHsKICAgICAgICAgICAgYnVmLmFwcGVuZCgiICsg\nIik7CiAgICAgICAgICAgIHN0YXJ0LmFwcGVuZFRvKGJ1Zik7CiAgICAgICAg\nfQogICAgICAgIGJ1Zi5hcHBlbmQoIikiKTsKICAgIH0KCiAgICBwdWJsaWMg\nU3RyaW5nW10gZ2V0Q3JlYXRlU2VxdWVuY2VTUUwoU2VxdWVuY2Ugc2VxKSB7\nCiAgICAgICAgU3RyaW5nW10gc3FsID0gc3VwZXIuZ2V0Q3JlYXRlU2VxdWVu\nY2VTUUwoc2VxKTsKICAgICAgICBpZiAoc2VxLmdldEFsbG9jYXRlKCkgPiAx\nKQogICAgICAgICAgICBzcWxbMF0gKz0gIiBDQUNIRSAiICsgc2VxLmdldEFs\nbG9jYXRlKCk7CiAgICAgICAgcmV0dXJuIHNxbDsKICAgIH0KCiAgICBwcm90\nZWN0ZWQgYm9vbGVhbiBzdXBwb3J0c0RlZmVycmVkVW5pcXVlQ29uc3RyYWlu\ndHMoKSB7CiAgICAgICAgLy8gUG9zdGdyZXMgb25seSBzdXBwb3J0cyBkZWZl\ncnJlZCBmb3JlaWduIGtleSBjb25zdHJhaW50cy4KICAgICAgICByZXR1cm4g\nZmFsc2U7CiAgICB9CgogICAgcHJvdGVjdGVkIFN0cmluZyBnZXRTZXF1ZW5j\nZXNTUUwoU3RyaW5nIHNjaGVtYU5hbWUsIFN0cmluZyBzZXF1ZW5jZU5hbWUp\nIHsKICAgICAgICBpZiAoc2NoZW1hTmFtZSA9PSBudWxsICYmIHNlcXVlbmNl\nTmFtZSA9PSBudWxsKQogICAgICAgICAgICByZXR1cm4gYWxsU2VxdWVuY2Vz\nU1FMOwogICAgICAgIGVsc2UgaWYgKHNjaGVtYU5hbWUgPT0gbnVsbCkKICAg\nICAgICAgICAgcmV0dXJuIG5hbWVkU2VxdWVuY2VzRnJvbUFsbFNjaGVtYXNT\nUUw7CiAgICAgICAgZWxzZSBpZiAoc2VxdWVuY2VOYW1lID09IG51bGwpCiAg\nICAgICAgICAgIHJldHVybiBhbGxTZXF1ZW5jZXNGcm9tT25lU2NoZW1hU1FM\nOwogICAgICAgIGVsc2UKICAgICAgICAgICAgcmV0dXJuIG5hbWVkU2VxdWVu\nY2VGcm9tT25lU2NoZW1hU1FMOwogICAgfQoKICAgIHB1YmxpYyBib29sZWFu\nIGlzU3lzdGVtU2VxdWVuY2UoU3RyaW5nIG5hbWUsIFN0cmluZyBzY2hlbWEs\nCiAgICAgICAgYm9vbGVhbiB0YXJnZXRTY2hlbWEpIHsKICAgICAgICBpZiAo\nc3VwZXIuaXNTeXN0ZW1TZXF1ZW5jZShuYW1lLCBzY2hlbWEsIHRhcmdldFNj\naGVtYSkpCiAgICAgICAgICAgIHJldHVybiB0cnVlOwoKICAgICAgICAvLyBm\naWx0ZXIgb3V0IGdlbmVyYXRlZCBzZXF1ZW5jZXMgdXNlZCBmb3IgYmlnc2Vy\naWFsIGNvbHMsIHdoaWNoIGFyZQogICAgICAgIC8vIG9mIHRoZSBmb3JtIDx0\nYWJsZT5fPGNvbD5fc2VxCiAgICAgICAgaW50IGlkeCA9IG5hbWUuaW5kZXhP\nZignXycpOwogICAgICAgIHJldHVybiBpZHggIT0gLTEgJiYgaWR4ICE9IG5h\nbWUubGVuZ3RoKCkgLSA0CiAgICAgICAgICAgICYmIG5hbWUudG9VcHBlckNh\nc2UoKS5lbmRzV2l0aCgiX1NFUSIpOwogICAgfQoKICAgIHB1YmxpYyBib29s\nZWFuIGlzU3lzdGVtVGFibGUoU3RyaW5nIG5hbWUsIFN0cmluZyBzY2hlbWEs\nCiAgICAgICAgYm9vbGVhbiB0YXJnZXRTY2hlbWEpIHsKICAgICAgICAvLyBu\nYW1lcyBzdGFydGluZyB3aXRoICJwZ18iIGFyZSByZXNlcnZlZCBmb3IgUG9z\ndGdyZXNxbCBpbnRlcm5hbCB1c2UKICAgICAgICByZXR1cm4gc3VwZXIuaXNT\neXN0ZW1UYWJsZShuYW1lLCBzY2hlbWEsIHRhcmdldFNjaGVtYSkKICAgICAg\nICAgICAgfHwgKG5hbWUgIT0gbnVsbCAmJiBuYW1lLnRvTG93ZXJDYXNlKCku\nc3RhcnRzV2l0aCgicGdfIikpOwogICAgfQoKICAgIHB1YmxpYyBib29sZWFu\nIGlzU3lzdGVtSW5kZXgoU3RyaW5nIG5hbWUsIFRhYmxlIHRhYmxlKSB7CiAg\nICAgICAgLy8gbmFtZXMgc3RhcnRpbmcgd2l0aCAicGdfIiBhcmUgcmVzZXJ2\nZWQgZm9yIFBvc3RncmVzcWwgaW50ZXJuYWwgdXNlCiAgICAgICAgcmV0dXJu\nIHN1cGVyLmlzU3lzdGVtSW5kZXgobmFtZSwgdGFibGUpCiAgICAgICAgICAg\nIHx8IChuYW1lICE9IG51bGwgJiYgbmFtZS50b0xvd2VyQ2FzZSgpLnN0YXJ0\nc1dpdGgoInBnXyIpKTsKICAgIH0KCiAgICBwdWJsaWMgQ29ubmVjdGlvbiBk\nZWNvcmF0ZShDb25uZWN0aW9uIGNvbm4pCiAgICAgICAgdGhyb3dzIFNRTEV4\nY2VwdGlvbiB7CiAgICAgICAgcmV0dXJuIG5ldyBQb3N0Z3Jlc0Nvbm5lY3Rp\nb24oc3VwZXIuZGVjb3JhdGUoY29ubiksIHRoaXMpOwogICAgfQoKICAgIC8q\nKgogICAgICogQ29ubmVjdGlvbiB3cmFwcGVyIHRvIHdvcmsgYXJvdW5kIHRo\nZSBwb3N0Z3JlcyBlbXB0eSByZXN1bHQgc2V0IGJ1Zy4KICAgICAqLwogICAg\ncHJpdmF0ZSBzdGF0aWMgY2xhc3MgUG9zdGdyZXNDb25uZWN0aW9uCiAgICAg\nICAgZXh0ZW5kcyBEZWxlZ2F0aW5nQ29ubmVjdGlvbiB7CgogICAgICAgIHBy\naXZhdGUgZmluYWwgUG9zdGdyZXNEaWN0aW9uYXJ5IF9kaWN0OwoKICAgICAg\nICBwdWJsaWMgUG9zdGdyZXNDb25uZWN0aW9uKENvbm5lY3Rpb24gY29ubiwg\nUG9zdGdyZXNEaWN0aW9uYXJ5IGRpY3QpIHsKICAgICAgICAgICAgc3VwZXIo\nY29ubik7CiAgICAgICAgICAgIF9kaWN0ID0gZGljdDsKICAgICAgICB9Cgog\nICAgICAgIHByb3RlY3RlZCBQcmVwYXJlZFN0YXRlbWVudCBwcmVwYXJlU3Rh\ndGVtZW50KFN0cmluZyBzcWwsIGJvb2xlYW4gd3JhcCkKICAgICAgICAgICAg\ndGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgICAgIHJldHVybiBuZXcg\nUG9zdGdyZXNQcmVwYXJlZFN0YXRlbWVudChzdXBlci5wcmVwYXJlU3RhdGVt\nZW50CiAgICAgICAgICAgICAgICAoc3FsLCBmYWxzZSksIHRoaXMsIF9kaWN0\nKTsKICAgICAgICB9CgogICAgICAgIHByb3RlY3RlZCBQcmVwYXJlZFN0YXRl\nbWVudCBwcmVwYXJlU3RhdGVtZW50KFN0cmluZyBzcWwsIGludCByc1R5cGUs\nCiAgICAgICAgICAgIGludCByc0NvbmN1ciwgYm9vbGVhbiB3cmFwKQogICAg\nICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAgICAgcmV0\ndXJuIG5ldyBQb3N0Z3Jlc1ByZXBhcmVkU3RhdGVtZW50KHN1cGVyLnByZXBh\ncmVTdGF0ZW1lbnQKICAgICAgICAgICAgICAgIChzcWwsIHJzVHlwZSwgcnND\nb25jdXIsIGZhbHNlKSwgdGhpcywgX2RpY3QpOwogICAgICAgIH0KICAgIH0K\nCiAgICAvKioKICAgICAqIFN0YXRlbWVudCB3cmFwcGVyIHRvIHdvcmsgYXJv\ndW5kIHRoZSBwb3N0Z3JlcyBlbXB0eSByZXN1bHQgc2V0IGJ1Zy4KICAgICAq\nLwogICAgcHJpdmF0ZSBzdGF0aWMgY2xhc3MgUG9zdGdyZXNQcmVwYXJlZFN0\nYXRlbWVudAogICAgICAgIGV4dGVuZHMgRGVsZWdhdGluZ1ByZXBhcmVkU3Rh\ndGVtZW50IHsKCiAgICAgICAgcHJpdmF0ZSBmaW5hbCBQb3N0Z3Jlc0RpY3Rp\nb25hcnkgX2RpY3Q7CgogICAgICAgIHB1YmxpYyBQb3N0Z3Jlc1ByZXBhcmVk\nU3RhdGVtZW50KFByZXBhcmVkU3RhdGVtZW50IHBzLAogICAgICAgICAgICBD\nb25uZWN0aW9uIGNvbm4sIFBvc3RncmVzRGljdGlvbmFyeSBkaWN0KSB7CiAg\nICAgICAgICAgIHN1cGVyKHBzLCBjb25uKTsKICAgICAgICAgICAgX2RpY3Qg\nPSBkaWN0OwogICAgICAgIH0KCiAgICAgICAgcHJvdGVjdGVkIFJlc3VsdFNl\ndCBleGVjdXRlUXVlcnkoYm9vbGVhbiB3cmFwKQogICAgICAgICAgICB0aHJv\nd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAg\nICAgICAgIHJldHVybiBzdXBlci5leGVjdXRlUXVlcnkod3JhcCk7CiAgICAg\nICAgICAgIH0gY2F0Y2ggKFNRTEV4Y2VwdGlvbiBzZSkgewogICAgICAgICAg\nICAgICAgLy8gd2UgbmVlZCB0byBtYWtlIG91ciBiZXN0IGd1ZXNzIHdoZXRo\nZXIgdGhpcyBpcyB0aGUgZW1wdHkKICAgICAgICAgICAgICAgIC8vIFJlc3Vs\ndFNldCBidWcsIHNpbmNlIHRoaXMgZXhjZXB0aW9uIGNvdWxkIG9jY3VyCiAg\nICAgICAgICAgICAgICAvLyBmb3Igb3RoZXIgcmVhc29ucyAobGlrZSBhbiBp\nbnZhbGlkIHF1ZXJ5IHN0cmluZykuIE5vdGUKICAgICAgICAgICAgICAgIC8v\nIHRoYXQgUG9zdGdyZXMgZXJyb3IgbWVzc2FnZXMgYXJlIGxvY2FsaXplZCwg\nc28gd2UKICAgICAgICAgICAgICAgIC8vIGNhbm5vdCBqdXN0IHBhcnNlIHRo\nZSBleGNlcHRpb24gU3RyaW5nLgogICAgICAgICAgICAgICAgUmVzdWx0U2V0\nIHJzID0gZ2V0UmVzdWx0U2V0KHdyYXApOwoKICAgICAgICAgICAgICAgIC8v\nIFJlc3VsdFNldCBzaG91bGQgYmUgZW1wdHk6IGlmIG5vdCwgdGhlbiBtYXli\nZSBhbgogICAgICAgICAgICAgICAgLy8gYWN0dWFsIGVycm9yIG9jY3VyZWQK\nICAgICAgICAgICAgICAgIGlmIChycyA9PSBudWxsKQogICAgICAgICAgICAg\nICAgICAgIHRocm93IHNlOwoKICAgICAgICAgICAgICAgIHJldHVybiByczsK\nICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgcHVibGljIHZvaWQg\nc2V0RmV0Y2hTaXplKGludCBpKQogICAgICAgICAgICB0aHJvd3MgU1FMRXhj\nZXB0aW9uIHsKICAgICAgICAgICAgLy8gc29tZSBwb3N0Z3JlcyBkcml2ZXJz\nIGRvIG5vdCBzdXBwb3J0IHRoZSBzZXRGZXRjaFNpemUgbWV0aG9kCiAgICAg\nICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBpZiAoX2RpY3Quc3VwcG9y\ndHNTZXRGZXRjaFNpemUpCiAgICAgICAgICAgICAgICAgICAgc3VwZXIuc2V0\nRmV0Y2hTaXplKGkpOwogICAgICAgICAgICB9IGNhdGNoIChTUUxFeGNlcHRp\nb24gZSkgewogICAgICAgICAgICAgICAgX2RpY3Quc3VwcG9ydHNTZXRGZXRj\naFNpemUgPSBmYWxzZTsKICAgICAgICAgICAgICAgIGlmIChfZGljdC5sb2cu\naXNXYXJuRW5hYmxlZCgpKQogICAgICAgICAgICAgICAgICAgIF9kaWN0Lmxv\nZy53YXJuKF9sb2MuZ2V0KCJwc3FsLW5vLXNldC1mZXRjaC1zaXplIiksIGUp\nOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQp9Cg==\n","encoding":"base64"}

