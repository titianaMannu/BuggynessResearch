{"sha":"1f620154d2a25b5cbee5b5fca7dbf87fa5aacb20","node_id":"MDQ6QmxvYjIwNjM2NDoxZjYyMDE1NGQyYTI1YjVjYmVlNWI1ZmNhN2RiZjg3ZmE1YWFjYjIw","size":27780,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/1f620154d2a25b5cbee5b5fca7dbf87fa5aacb20","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsOwoKaW1wb3J0IGph\ndmEuaW8uT2JqZWN0U3RyZWFtRXhjZXB0aW9uOwppbXBvcnQgamF2YS51dGls\nLkFycmF5TGlzdDsKaW1wb3J0IGphdmEudXRpbC5Db2xsZWN0aW9uOwppbXBv\ncnQgamF2YS51dGlsLkNvbGxlY3Rpb25zOwppbXBvcnQgamF2YS51dGlsLkhh\nc2hNYXA7CmltcG9ydCBqYXZhLnV0aWwuSXRlcmF0b3I7CmltcG9ydCBqYXZh\nLnV0aWwuTWFwOwppbXBvcnQgamF2YS51dGlsLlByb3BlcnRpZXM7CmltcG9y\ndCBqYXZhLnV0aWwuTGlua2VkTGlzdDsKaW1wb3J0IGphdmEudXRpbC5MaXN0\nOwppbXBvcnQgamF2YS5sYW5nLnJlZmxlY3QuSW52b2NhdGlvblRhcmdldEV4\nY2VwdGlvbjsKaW1wb3J0IGphdmF4LnRyYW5zYWN0aW9uLlN0YXR1czsKaW1w\nb3J0IGphdmF4LnRyYW5zYWN0aW9uLlN5bmNocm9uaXphdGlvbjsKaW1wb3J0\nIGphdmF4LnRyYW5zYWN0aW9uLlRyYW5zYWN0aW9uOwppbXBvcnQgamF2YXgu\ndHJhbnNhY3Rpb24uVHJhbnNhY3Rpb25NYW5hZ2VyOwoKaW1wb3J0IG9yZy5h\ncGFjaGUuY29tbW9ucy5sYW5nLlN0cmluZ1V0aWxzOwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLmNvbmYuT3BlbkpQQUNvbmZpZ3VyYXRpb247CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEuY29uZi5PcGVuSlBBVmVyc2lvbjsKaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5kYXRhY2FjaGUuRGF0YUNhY2hlU3Rv\ncmVNYW5hZ2VyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmVlLk1hbmFn\nZWRSdW50aW1lOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmVuaGFuY2Uu\nUENSZWdpc3RyeTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5lbmhhbmNl\nLlBlcnNpc3RlbmNlQ2FwYWJsZTsKaW1wb3J0IG9yZy5hcGFjaGUub3Blbmpw\nYS5ldmVudC5SZW1vdGVDb21taXRFdmVudE1hbmFnZXI7CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEuZXZlbnQuQnJva2VyRmFjdG9yeUV2ZW50OwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi5sb2cuTG9nOwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLmxpYi51dGlsLkoyRG9Qcml2SGVscGVyOwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51dGlsLkxvY2FsaXplcjsKaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIudXRpbC5SZWZlcmVuY2VIYXNo\nU2V0OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51dGlsLkphdmFW\nZXJzaW9uczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIudXRpbC5j\nb25jdXJyZW50LkNvbmN1cnJlbnRIYXNoTWFwOwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLmxpYi51dGlsLmNvbmN1cnJlbnQuQ29uY3VycmVudFJlZmVy\nZW5jZUhhc2hTZXQ7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0\naWwuY29uY3VycmVudC5SZWVudHJhbnRMb2NrOwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLm1ldGEuTWV0YURhdGFSZXBvc2l0b3J5OwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLnV0aWwuR2VuZXJhbEV4Y2VwdGlvbjsKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLkludmFsaWRTdGF0ZUV4Y2VwdGlv\nbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLk9wZW5KUEFFeGNl\ncHRpb247CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5Vc2VyRXhj\nZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuSW50ZXJu\nYWxFeGNlcHRpb247CgovKioKICogQWJzdHJhY3QgaW1wbGVtZW50YXRpb24g\nb2YgdGhlIHtAbGluayBCcm9rZXJGYWN0b3J5fQogKiB0aGF0IG11c3QgYmUg\nc3ViY2xhc3NlZCBmb3IgYSBzcGVjaWZpYyBydW50aW1lLgogKgogKiBAYXV0\naG9yIEFiZSBXaGl0ZQogKi8KcHVibGljIGFic3RyYWN0IGNsYXNzIEFic3Ry\nYWN0QnJva2VyRmFjdG9yeQogICAgaW1wbGVtZW50cyBCcm9rZXJGYWN0b3J5\nIHsKCiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBMb2NhbGl6ZXIgX2xvYyA9\nIExvY2FsaXplci5mb3JQYWNrYWdlCiAgICAgICAgKEFic3RyYWN0QnJva2Vy\nRmFjdG9yeS5jbGFzcyk7CgogICAgLy8gc3RhdGljIG1hcHBpbmcgb2YgY29u\nZmlndXJhdGlvbnMgdG8gcG9vbGVkIGJyb2tlciBmYWN0b3JpZXMKICAgIHBy\naXZhdGUgc3RhdGljIGZpbmFsIE1hcCBfcG9vbCA9IENvbGxlY3Rpb25zLnN5\nbmNocm9uaXplZE1hcChuZXcgSGFzaE1hcCgpKTsKCiAgICAvLyBjb25maWd1\ncmF0aW9uCiAgICBwcml2YXRlIGZpbmFsIE9wZW5KUEFDb25maWd1cmF0aW9u\nIF9jb25mOwogICAgcHJpdmF0ZSB0cmFuc2llbnQgYm9vbGVhbiBfcmVhZE9u\nbHkgPSBmYWxzZTsKICAgIHByaXZhdGUgdHJhbnNpZW50IGJvb2xlYW4gX2Ns\nb3NlZCA9IGZhbHNlOwogICAgcHJpdmF0ZSB0cmFuc2llbnQgUnVudGltZUV4\nY2VwdGlvbiBfY2xvc2VkRXhjZXB0aW9uID0gbnVsbDsKICAgIHByaXZhdGUg\nTWFwIF91c2VyT2JqZWN0cyA9IG51bGw7CgogICAgLy8gaW50ZXJuYWwgbG9j\nazogc3BlYyBmb3JiaWRzIHN5bmNocm9uaXphdGlvbiBvbiB0aGlzIG9iamVj\ndAogICAgcHJpdmF0ZSBmaW5hbCBSZWVudHJhbnRMb2NrIF9sb2NrID0gbmV3\nIFJlZW50cmFudExvY2soKTsKCiAgICAvLyBtYXBzIGdsb2JhbCB0cmFuc2Fj\ndGlvbnMgdG8gYXNzb2NpYXRlZCBicm9rZXJzCiAgICBwcml2YXRlIHRyYW5z\naWVudCBDb25jdXJyZW50SGFzaE1hcCBfdHJhbnNhY3Rpb25hbAogICAgICAg\nID0gbmV3IENvbmN1cnJlbnRIYXNoTWFwKCk7CgogICAgLy8gd2Vhay1yZWYg\ndHJhY2tpbmcgb2Ygb3BlbiBicm9rZXJzCiAgICBwcml2YXRlIHRyYW5zaWVu\ndCBDb2xsZWN0aW9uIF9icm9rZXJzID0gbmV3IENvbmN1cnJlbnRSZWZlcmVu\nY2VIYXNoU2V0CiAgICAgICAgKENvbmN1cnJlbnRSZWZlcmVuY2VIYXNoU2V0\nLldFQUspOwoKICAgIC8vIGNhY2hlIHRoZSBjbGFzcyBuYW1lcyBsb2FkZWQg\nZnJvbSB0aGUgcGVyc2lzdGVudCBjbGFzc2VzIHByb3BlcnR5IHNvCiAgICAv\nLyB0aGF0IHdlIGNhbiByZS1sb2FkIHRoZW0gZm9yIGVhY2ggbmV3IGJyb2tl\ncgogICAgcHJpdmF0ZSB0cmFuc2llbnQgQ29sbGVjdGlvbiBfcGNDbGFzc05h\nbWVzID0gbnVsbDsKICAgIHByaXZhdGUgdHJhbnNpZW50IENvbGxlY3Rpb24g\nX3BjQ2xhc3NMb2FkZXJzID0gbnVsbDsKCiAgICAvLyBsaWZlY3ljbGUgbGlz\ndGVuZXJzIHRvIHBhc3MgdG8gZWFjaCBicm9rZXIKICAgIHByaXZhdGUgdHJh\nbnNpZW50IE1hcCBfbGlmZWN5Y2xlTGlzdGVuZXJzID0gbnVsbDsKCiAgICAv\nLyB0cmFuc2FjdGlvbiBsaXN0ZW5lcnMgdG8gcGFzcyB0byBlYWNoIGJyb2tl\ncgogICAgcHJpdmF0ZSB0cmFuc2llbnQgTGlzdCBfdHJhbnNhY3Rpb25MaXN0\nZW5lcnMgPSBudWxsOwoKICAgIC8qKgogICAgICogUmV0dXJuIHRoZSBwb29s\nZWQgZmFjdG9yeSBtYXRjaGluZyB0aGUgZ2l2ZW4gY29uZmlndXJhdGlvbiwg\nb3IgbnVsbAogICAgICogaWYgbm9uZS4KICAgICAqLwogICAgcHVibGljIHN0\nYXRpYyBBYnN0cmFjdEJyb2tlckZhY3RvcnkgZ2V0UG9vbGVkRmFjdG9yeSgK\nICAgICAgICBPcGVuSlBBQ29uZmlndXJhdGlvbiBjb25mKSB7CiAgICAgICAg\ncmV0dXJuIChBYnN0cmFjdEJyb2tlckZhY3RvcnkpIF9wb29sLmdldCh0b1Bv\nb2xLZXkoY29uZikpOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIGFu\nIGludGVybmFsIGZhY3RvcnkgcG9vbCBrZXkgZm9yIHRoZSBnaXZlbiBjb25m\naWd1cmF0aW9uLgogICAgICogV2UgdXNlIHRoZSBjb25mIHByb3BlcnRpZXMg\nYXMgZ2l2ZW4gYnkgdGhlIHVzZXIgYmVjYXVzZSB0aGF0IGlzIHdoYXQncwog\nICAgICogcGFzc2VkIHRvIHtAbGluayAjZ2V0UG9vbGVkRmFjdG9yeX0gd2hl\nbiBsb29raW5nIGZvciBhbiBleGlzdGluZyBmYWN0b3J5LgogICAgICovCiAg\nICBwcml2YXRlIHN0YXRpYyBNYXAgdG9Qb29sS2V5KE9wZW5KUEFDb25maWd1\ncmF0aW9uIGNvbmYpIHsKICAgICAgICByZXR1cm4gY29uZi50b1Byb3BlcnRp\nZXMoZmFsc2UpOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRoZSBw\nb29sZWQgZmFjdG9yeSBtYXRjaGluZyB0aGUgZ2l2ZW4gY29uZmlndXJhdGlv\nbiBkYXRhLCBvciBudWxsCiAgICAgKiBpZiBub25lLgogICAgICovCiAgICBw\ncm90ZWN0ZWQgc3RhdGljIEFic3RyYWN0QnJva2VyRmFjdG9yeSBnZXRQb29s\nZWRGYWN0b3J5KE1hcCBtYXApIHsKICAgICAgICByZXR1cm4gKEFic3RyYWN0\nQnJva2VyRmFjdG9yeSkgX3Bvb2wuZ2V0KG1hcCk7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBDb25zdHJ1Y3Rvci4gQ29uZmlndXJhdGlvbiBtdXN0IGJlIHBy\nb3ZpZGVkIG9uIGNvbnN0cnVjdGlvbi4KICAgICAqLwogICAgcHJvdGVjdGVk\nIEFic3RyYWN0QnJva2VyRmFjdG9yeShPcGVuSlBBQ29uZmlndXJhdGlvbiBj\nb25maWcpIHsKICAgICAgICBfY29uZiA9IGNvbmZpZzsKICAgIH0KCiAgICAv\nKioKICAgICAqIFJldHVybiB0aGUgY29uZmlndXJhdGlvbiBmb3IgdGhpcyBm\nYWN0b3J5LgogICAgICovCiAgICBwdWJsaWMgT3BlbkpQQUNvbmZpZ3VyYXRp\nb24gZ2V0Q29uZmlndXJhdGlvbigpIHsKICAgICAgICByZXR1cm4gX2NvbmY7\nCiAgICB9CgogICAgcHVibGljIEJyb2tlciBuZXdCcm9rZXIoKSB7CiAgICAg\nICAgcmV0dXJuIG5ld0Jyb2tlcihfY29uZi5nZXRDb25uZWN0aW9uVXNlck5h\nbWUoKSwKICAgICAgICAgICAgX2NvbmYuZ2V0Q29ubmVjdGlvblBhc3N3b3Jk\nKCkpOwogICAgfQoKICAgIHB1YmxpYyBCcm9rZXIgbmV3QnJva2VyKFN0cmlu\nZyB1c2VyLCBTdHJpbmcgcGFzcykgewogICAgICAgIHJldHVybiBuZXdCcm9r\nZXIodXNlciwgcGFzcywgX2NvbmYuaXNUcmFuc2FjdGlvbk1vZGVNYW5hZ2Vk\nKCksCiAgICAgICAgICAgIF9jb25mLmdldENvbm5lY3Rpb25SZXRhaW5Nb2Rl\nQ29uc3RhbnQoKSk7CiAgICB9CgogICAgcHVibGljIEJyb2tlciBuZXdCcm9r\nZXIoYm9vbGVhbiBtYW5hZ2VkLCBpbnQgY29ublJldGFpbk1vZGUpIHsKICAg\nICAgICByZXR1cm4gbmV3QnJva2VyKF9jb25mLmdldENvbm5lY3Rpb25Vc2Vy\nTmFtZSgpLAogICAgICAgICAgICBfY29uZi5nZXRDb25uZWN0aW9uUGFzc3dv\ncmQoKSwgbWFuYWdlZCwgY29ublJldGFpbk1vZGUpOwogICAgfQoKICAgIHB1\nYmxpYyBCcm9rZXIgbmV3QnJva2VyKFN0cmluZyB1c2VyLCBTdHJpbmcgcGFz\ncywgYm9vbGVhbiBtYW5hZ2VkLAogICAgICAgIGludCBjb25uUmV0YWluTW9k\nZSkgewogICAgICAgIHJldHVybiBuZXdCcm9rZXIodXNlciwgcGFzcywgbWFu\nYWdlZCwgY29ublJldGFpbk1vZGUsIHRydWUpOwogICAgfQoKICAgIHB1Ymxp\nYyBCcm9rZXIgbmV3QnJva2VyKFN0cmluZyB1c2VyLCBTdHJpbmcgcGFzcywg\nYm9vbGVhbiBtYW5hZ2VkLAogICAgICAgIGludCBjb25uUmV0YWluTW9kZSwg\nYm9vbGVhbiBmaW5kRXhpc3RpbmcpIHsKICAgICAgICB0cnkgewogICAgICAg\nICAgICBhc3NlcnRPcGVuKCk7CiAgICAgICAgICAgIG1ha2VSZWFkT25seSgp\nOwoKICAgICAgICAgICAgQnJva2VySW1wbCBicm9rZXIgPSBudWxsOwogICAg\nICAgICAgICBpZiAoZmluZEV4aXN0aW5nKQogICAgICAgICAgICAgICAgYnJv\na2VyID0gZmluZEJyb2tlcih1c2VyLCBwYXNzLCBtYW5hZ2VkKTsKICAgICAg\nICAgICAgaWYgKGJyb2tlciA9PSBudWxsKSB7CiAgICAgICAgICAgICAgICAv\nLyBkZWNvcmF0ZSB0aGUgc3RvcmUgbWFuYWdlciBmb3IgZGF0YSBjYWNoaW5n\nIGFuZCBjdXN0b20KICAgICAgICAgICAgICAgIC8vIHJlc3VsdCBvYmplY3Qg\ncHJvdmlkZXJzOyBhbHdheXMgbWFrZSBzdXJlIGl0J3MgYSBkZWxlZ2F0aW5n\nCiAgICAgICAgICAgICAgICAvLyBzdG9yZSBtYW5hZ2VyLCBiZWNhdXNlIGl0\nJ3MgZWFzaWVyIGZvciB1c2VycyB0byBkZWFsIHdpdGgKICAgICAgICAgICAg\nICAgIC8vIHRoYXQgd2F5CiAgICAgICAgICAgICAgICBTdG9yZU1hbmFnZXIg\nc20gPSBuZXdTdG9yZU1hbmFnZXIoKTsKICAgICAgICAgICAgICAgIERlbGVn\nYXRpbmdTdG9yZU1hbmFnZXIgZHNtID0gbnVsbDsKICAgICAgICAgICAgICAg\nIGlmIChfY29uZi5nZXREYXRhQ2FjaGVNYW5hZ2VySW5zdGFuY2UoKS5nZXRT\neXN0ZW1EYXRhQ2FjaGUoKQogICAgICAgICAgICAgICAgICAgICE9IG51bGwp\nCiAgICAgICAgICAgICAgICAgICAgZHNtID0gbmV3IERhdGFDYWNoZVN0b3Jl\nTWFuYWdlcihzbSk7CiAgICAgICAgICAgICAgICBkc20gPSBuZXcgUk9QU3Rv\ncmVNYW5hZ2VyKChkc20gPT0gbnVsbCkgPyBzbSA6IGRzbSk7CgogICAgICAg\nICAgICAgICAgYnJva2VyID0gbmV3QnJva2VySW1wbCh1c2VyLCBwYXNzKTsK\nICAgICAgICAgICAgICAgIGJyb2tlci5pbml0aWFsaXplKHRoaXMsIGRzbSwg\nbWFuYWdlZCwgY29ublJldGFpbk1vZGUpOwogICAgICAgICAgICAgICAgYWRk\nTGlzdGVuZXJzKGJyb2tlcik7CgogICAgICAgICAgICAgICAgLy8gaWYgd2Un\ncmUgdXNpbmcgcmVtb3RlIGV2ZW50cywgcmVnaXN0ZXIgdGhlIGV2ZW50IG1h\nbmFnZXIgc28KICAgICAgICAgICAgICAgIC8vIHRoYXQgaXQgY2FuIGJyb2Fk\nY2FzdCBjb21taXQgbm90aWZpY2F0aW9ucyBmcm9tIHRoZSBicm9rZXIKICAg\nICAgICAgICAgICAgIFJlbW90ZUNvbW1pdEV2ZW50TWFuYWdlciByZW1vdGUg\nPSBfY29uZi4KICAgICAgICAgICAgICAgICAgICBnZXRSZW1vdGVDb21taXRF\ndmVudE1hbmFnZXIoKTsKICAgICAgICAgICAgICAgIGlmIChyZW1vdGUuYXJl\nUmVtb3RlRXZlbnRzRW5hYmxlZCgpKQogICAgICAgICAgICAgICAgICAgIGJy\nb2tlci5hZGRUcmFuc2FjdGlvbkxpc3RlbmVyKHJlbW90ZSk7CgogICAgICAg\nICAgICAgICAgbG9hZFBlcnNpc3RlbnRUeXBlcyhicm9rZXIuZ2V0Q2xhc3NM\nb2FkZXIoKSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgX2Jyb2tlcnMu\nYWRkKGJyb2tlcik7CgogICAgICAgICAgICByZXR1cm4gYnJva2VyOwogICAg\nICAgIH0gY2F0Y2ggKE9wZW5KUEFFeGNlcHRpb24ga2UpIHsKICAgICAgICAg\nICAgdGhyb3cga2U7CiAgICAgICAgfSBjYXRjaCAoUnVudGltZUV4Y2VwdGlv\nbiByZSkgewogICAgICAgICAgICB0aHJvdyBuZXcgR2VuZXJhbEV4Y2VwdGlv\nbihyZSk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogQWRkIGZh\nY3RvcnktcmVnaXN0ZXJlZCBsaWZlY3ljbGUgbGlzdGVuZXJzIHRvIHRoZSBi\ncm9rZXIuCiAgICAgKi8KICAgIHByb3RlY3RlZCB2b2lkIGFkZExpc3RlbmVy\ncyhCcm9rZXJJbXBsIGJyb2tlcikgewogICAgICAgIGlmIChfbGlmZWN5Y2xl\nTGlzdGVuZXJzICE9IG51bGwgJiYgIV9saWZlY3ljbGVMaXN0ZW5lcnMuaXNF\nbXB0eSgpKSB7CiAgICAgICAgICAgIE1hcC5FbnRyeSBlbnRyeTsKICAgICAg\nICAgICAgZm9yIChJdGVyYXRvciBpdHIgPSBfbGlmZWN5Y2xlTGlzdGVuZXJz\nLmVudHJ5U2V0KCkuaXRlcmF0b3IoKTsKICAgICAgICAgICAgICAgIGl0ci5o\nYXNOZXh0KCk7KSB7CiAgICAgICAgICAgICAgICBlbnRyeSA9IChNYXAuRW50\ncnkpIGl0ci5uZXh0KCk7CiAgICAgICAgICAgICAgICBicm9rZXIuYWRkTGlm\nZWN5Y2xlTGlzdGVuZXIoZW50cnkuZ2V0S2V5KCksIChDbGFzc1tdKQogICAg\nICAgICAgICAgICAgICAgIGVudHJ5LmdldFZhbHVlKCkpOwogICAgICAgICAg\nICB9CiAgICAgICAgfQoKICAgICAgICBpZiAoX3RyYW5zYWN0aW9uTGlzdGVu\nZXJzICE9IG51bGwgJiYgIV90cmFuc2FjdGlvbkxpc3RlbmVycy5pc0VtcHR5\nKCkpIHsKICAgICAgICAgICAgZm9yIChJdGVyYXRvciBpdHIgPSBfdHJhbnNh\nY3Rpb25MaXN0ZW5lcnMuaXRlcmF0b3IoKTsKICAgICAgICAgICAgICAgIGl0\nci5oYXNOZXh0KCk7ICkgewogICAgICAgICAgICAgICAgYnJva2VyLmFkZFRy\nYW5zYWN0aW9uTGlzdGVuZXIoaXRyLm5leHQoKSk7CiAgICAgICAgICAgIH0K\nICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBMb2FkIHRoZSBjb25m\naWd1cmVkIHBlcnNpc3RlbnQgY2xhc3NlcyBsaXN0LiBQZXJmb3JtZWQgYXV0\nb21hdGljYWxseQogICAgICogd2hlbmV2ZXIgYSBicm9rZXIgaXMgY3JlYXRl\nZC4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIGxvYWRQZXJzaXN0ZW50VHlw\nZXMoQ2xhc3NMb2FkZXIgZW52TG9hZGVyKSB7CiAgICAgICAgLy8gbm8gbGlz\ndGVkIHBlcnNpc3RlbnQgdHlwZXM/CiAgICAgICAgaWYgKF9wY0NsYXNzTmFt\nZXMgIT0gbnVsbCAmJiBfcGNDbGFzc05hbWVzLmlzRW1wdHkoKSkKICAgICAg\nICAgICAgcmV0dXJuOwoKICAgICAgICAvLyBjYWNoZSBwZXJzaXN0ZW50IHR5\ncGUgbmFtZXMgaWYgbm90IGFscmVhZHkKICAgICAgICBDbGFzc0xvYWRlciBs\nb2FkZXIgPSBfY29uZi5nZXRDbGFzc1Jlc29sdmVySW5zdGFuY2UoKS4KICAg\nICAgICAgICAgZ2V0Q2xhc3NMb2FkZXIoZ2V0Q2xhc3MoKSwgZW52TG9hZGVy\nKTsKICAgICAgICBDb2xsZWN0aW9uIHRvUmVkZWZpbmUgPSBuZXcgQXJyYXlM\naXN0KCk7CiAgICAgICAgaWYgKF9wY0NsYXNzTmFtZXMgPT0gbnVsbCkgewog\nICAgICAgICAgICBDb2xsZWN0aW9uIGNsc3MgPSBfY29uZi5nZXRNZXRhRGF0\nYVJlcG9zaXRvcnlJbnN0YW5jZSgpLgogICAgICAgICAgICAgICAgbG9hZFBl\ncnNpc3RlbnRUeXBlcyhmYWxzZSwgbG9hZGVyKTsKICAgICAgICAgICAgaWYg\nKGNsc3MuaXNFbXB0eSgpKQogICAgICAgICAgICAgICAgX3BjQ2xhc3NOYW1l\ncyA9IENvbGxlY3Rpb25zLkVNUFRZX1NFVDsKICAgICAgICAgICAgZWxzZSB7\nCiAgICAgICAgICAgICAgICBfcGNDbGFzc05hbWVzID0gbmV3IEFycmF5TGlz\ndChjbHNzLnNpemUoKSk7CiAgICAgICAgICAgICAgICBmb3IgKEl0ZXJhdG9y\nIGl0ciA9IGNsc3MuaXRlcmF0b3IoKTsgaXRyLmhhc05leHQoKTspIHsKICAg\nICAgICAgICAgICAgICAgICBDbGFzcyBjbHMgPSAoQ2xhc3MpIGl0ci5uZXh0\nKCk7CiAgICAgICAgICAgICAgICAgICAgX3BjQ2xhc3NOYW1lcy5hZGQoY2xz\nLmdldE5hbWUoKSk7CiAgICAgICAgICAgICAgICAgICAgaWYgKG5lZWRzU3Vi\nKGNscykpCiAgICAgICAgICAgICAgICAgICAgICAgIHRvUmVkZWZpbmUuYWRk\nKGNscyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBfcGND\nbGFzc0xvYWRlcnMgPSBuZXcgUmVmZXJlbmNlSGFzaFNldChSZWZlcmVuY2VI\nYXNoU2V0LldFQUspOwogICAgICAgICAgICAgICAgX3BjQ2xhc3NMb2FkZXJz\nLmFkZChsb2FkZXIpOwogICAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsK\nICAgICAgICAgICAgLy8gcmVsb2FkIHdpdGggdGhpcyBsb2FkZXIKICAgICAg\nICAgICAgaWYgKF9wY0NsYXNzTG9hZGVycy5hZGQobG9hZGVyKSkgewogICAg\nICAgICAgICAgICAgZm9yIChJdGVyYXRvciBpdHIgPSBfcGNDbGFzc05hbWVz\nLml0ZXJhdG9yKCk7IGl0ci5oYXNOZXh0KCk7KSB7CiAgICAgICAgICAgICAg\nICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICAgICAgQ2xhc3MgY2xz\nID0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIENsYXNzLmZvck5hbWUo\nKFN0cmluZykgaXRyLm5leHQoKSwgdHJ1ZSwgbG9hZGVyKTsKICAgICAgICAg\nICAgICAgICAgICAgICAgaWYgKG5lZWRzU3ViKGNscykpCiAgICAgICAgICAg\nICAgICAgICAgICAgICAgICB0b1JlZGVmaW5lLmFkZChjbHMpOwogICAgICAg\nICAgICAgICAgICAgIH0gY2F0Y2ggKFRocm93YWJsZSB0KSB7CiAgICAgICAg\nICAgICAgICAgICAgICAgIF9jb25mLmdldExvZyhPcGVuSlBBQ29uZmlndXJh\ndGlvbi5MT0dfUlVOVElNRSkKICAgICAgICAgICAgICAgICAgICAgICAgICAg\nIC53YXJuKG51bGwsIHQpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAg\nICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAg\naWYgKEphdmFWZXJzaW9ucy5WRVJTSU9OID49IDUpIHsKICAgICAgICAgICAg\ndHJ5IHsKICAgICAgICAgICAgICAgIC8vIFRoaXMgaXMgSmF2YSA1IC8gNiBj\nb2RlLiBUaGVyZSBtaWdodCBiZSBhIG1vcmUgZWxlZ2FudAogICAgICAgICAg\nICAgICAgLy8gd2F5IHRvIGJvb3RzdHJhcCB0aGlzIGludG8gdGhlIHN5c3Rl\nbSwgYnV0IHJlZmxlY3Rpb24KICAgICAgICAgICAgICAgIC8vIHdpbGwgZ2V0\nIHRoaW5ncyB3b3JraW5nIGZvciBub3cuIFdlIGNvdWxkIHBvdGVudGlhbGx5\nCiAgICAgICAgICAgICAgICAvLyBkbyB0aGlzIGJ5IGNyZWF0aW5nIGEgbmV3\nIEJyb2tlckZhY3RvcnlFdmVudCB0eXBlIGZvcgogICAgICAgICAgICAgICAg\nLy8gQnJva2VyIGNyZWF0aW9uLCBhdCB3aGljaCBwb2ludCB3ZSBoYXZlIGFu\nIGFwcHJvcHJpYXRlCiAgICAgICAgICAgICAgICAvLyBjbGFzc2xvYWRlciB0\nbyB1c2UuCiAgICAgICAgICAgICAgICBDbGFzcyBjbHMgPSBDbGFzcy5mb3JO\nYW1lKAogICAgICAgICAgICAgICAgICAgICJvcmcuYXBhY2hlLm9wZW5qcGEu\nZW5oYW5jZS5NYW5hZ2VkQ2xhc3NTdWJjbGFzc2VyIik7CiAgICAgICAgICAg\nICAgICBjbHMuZ2V0TWV0aG9kKCJwcmVwYXJlVW5lbmhhbmNlZENsYXNzZXMi\nLCBuZXcgQ2xhc3NbXSB7CiAgICAgICAgICAgICAgICAgICAgICAgIE9wZW5K\nUEFDb25maWd1cmF0aW9uLmNsYXNzLCBDb2xsZWN0aW9uLmNsYXNzLAogICAg\nICAgICAgICAgICAgICAgICAgICBDbGFzc0xvYWRlci5jbGFzcwogICAgICAg\nICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgLmludm9rZShu\ndWxsLCBuZXcgT2JqZWN0W117IF9jb25mLCB0b1JlZGVmaW5lLCBlbnZMb2Fk\nZXIgfSk7CiAgICAgICAgICAgIH0gY2F0Y2ggKE5vU3VjaE1ldGhvZEV4Y2Vw\ndGlvbiBlKSB7CiAgICAgICAgICAgICAgICAvLyBzaG91bGQgbmV2ZXIgaGFw\ncGVuIGluIGEgcHJvcGVybHktYnVpbHQgaW5zdGFsbGF0aW9uCiAgICAgICAg\nICAgICAgICB0aHJvdyBuZXcgSW50ZXJuYWxFeGNlcHRpb24oZSk7CiAgICAg\nICAgICAgIH0gY2F0Y2ggKElsbGVnYWxBY2Nlc3NFeGNlcHRpb24gZSkgewog\nICAgICAgICAgICAgICAgLy8gc2hvdWxkIG5ldmVyIGhhcHBlbiBpbiBhIHBy\nb3Blcmx5LWJ1aWx0IGluc3RhbGxhdGlvbgogICAgICAgICAgICAgICAgdGhy\nb3cgbmV3IEludGVybmFsRXhjZXB0aW9uKGUpOwogICAgICAgICAgICB9IGNh\ndGNoIChJbnZvY2F0aW9uVGFyZ2V0RXhjZXB0aW9uIGUpIHsKICAgICAgICAg\nICAgICAgIFRocm93YWJsZSBjYXVzZSA9IGUuZ2V0Q2F1c2UoKTsKICAgICAg\nICAgICAgICAgIGlmIChjYXVzZSBpbnN0YW5jZW9mIE9wZW5KUEFFeGNlcHRp\nb24pCiAgICAgICAgICAgICAgICAgICAgdGhyb3cgKE9wZW5KUEFFeGNlcHRp\nb24pIGNhdXNlOwogICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAg\nICAgICAgIHRocm93IG5ldyBJbnRlcm5hbEV4Y2VwdGlvbihjYXVzZSk7CiAg\nICAgICAgICAgIH0gY2F0Y2ggKENsYXNzTm90Rm91bmRFeGNlcHRpb24gZSkg\newogICAgICAgICAgICAgICAgLy8gc2hvdWxkIG5ldmVyIGhhcHBlbiBpbiBh\nIHByb3Blcmx5LWJ1aWx0IGluc3RhbGxhdGlvbgogICAgICAgICAgICAgICAg\ndGhyb3cgbmV3IEludGVybmFsRXhjZXB0aW9uKGUpOwogICAgICAgICAgICB9\nCiAgICAgICAgfQogICAgfQoKICAgIHByaXZhdGUgYm9vbGVhbiBuZWVkc1N1\nYihDbGFzcyBjbHMpIHsKICAgICAgICByZXR1cm4gIWNscy5pc0ludGVyZmFj\nZSgpCiAgICAgICAgICAgICYmICFQZXJzaXN0ZW5jZUNhcGFibGUuY2xhc3Mu\naXNBc3NpZ25hYmxlRnJvbShjbHMpOwogICAgfQoKICAgIHB1YmxpYyB2b2lk\nIGFkZExpZmVjeWNsZUxpc3RlbmVyKE9iamVjdCBsaXN0ZW5lciwgQ2xhc3Nb\nXSBjbGFzc2VzKSB7CiAgICAgICAgbG9jaygpOwogICAgICAgIHRyeSB7CiAg\nICAgICAgICAgIGFzc2VydE9wZW4oKTsKICAgICAgICAgICAgaWYgKF9saWZl\nY3ljbGVMaXN0ZW5lcnMgPT0gbnVsbCkKICAgICAgICAgICAgICAgIF9saWZl\nY3ljbGVMaXN0ZW5lcnMgPSBuZXcgSGFzaE1hcCg3KTsKICAgICAgICAgICAg\nX2xpZmVjeWNsZUxpc3RlbmVycy5wdXQobGlzdGVuZXIsIGNsYXNzZXMpOwog\nICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgIHVubG9jaygpOwogICAg\nICAgIH0KICAgIH0KCiAgICBwdWJsaWMgdm9pZCByZW1vdmVMaWZlY3ljbGVM\naXN0ZW5lcihPYmplY3QgbGlzdGVuZXIpIHsKICAgICAgICBsb2NrKCk7CiAg\nICAgICAgdHJ5IHsKICAgICAgICAgICAgYXNzZXJ0T3BlbigpOwogICAgICAg\nICAgICBpZiAoX2xpZmVjeWNsZUxpc3RlbmVycyAhPSBudWxsKQogICAgICAg\nICAgICAgICAgX2xpZmVjeWNsZUxpc3RlbmVycy5yZW1vdmUobGlzdGVuZXIp\nOwogICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgIHVubG9jaygpOwog\nICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMgdm9pZCBhZGRUcmFuc2FjdGlv\nbkxpc3RlbmVyKE9iamVjdCBsaXN0ZW5lcikgewogICAgICAgIGxvY2soKTsK\nICAgICAgICB0cnkgewogICAgICAgICAgICBhc3NlcnRPcGVuKCk7CiAgICAg\nICAgICAgIGlmIChfdHJhbnNhY3Rpb25MaXN0ZW5lcnMgPT0gbnVsbCkKICAg\nICAgICAgICAgICAgIF90cmFuc2FjdGlvbkxpc3RlbmVycyA9IG5ldyBMaW5r\nZWRMaXN0KCk7CiAgICAgICAgICAgIF90cmFuc2FjdGlvbkxpc3RlbmVycy5h\nZGQobGlzdGVuZXIpOwogICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAg\nIHVubG9jaygpOwogICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMgdm9pZCBy\nZW1vdmVUcmFuc2FjdGlvbkxpc3RlbmVyKE9iamVjdCBsaXN0ZW5lcikgewog\nICAgICAgIGxvY2soKTsKICAgICAgICB0cnkgewogICAgICAgICAgICBhc3Nl\ncnRPcGVuKCk7CiAgICAgICAgICAgIGlmIChfdHJhbnNhY3Rpb25MaXN0ZW5l\ncnMgIT0gbnVsbCkKICAgICAgICAgICAgICAgIF90cmFuc2FjdGlvbkxpc3Rl\nbmVycy5yZW1vdmUobGlzdGVuZXIpOwogICAgICAgIH0gZmluYWxseSB7CiAg\nICAgICAgICAgIHVubG9jaygpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioK\nICAgICAqIFJldHVybnMgdHJ1ZSBpZiB0aGlzIGJyb2tlciBmYWN0b3J5IGlz\nIGNsb3NlZC4KICAgICAqLwogICAgcHVibGljIGJvb2xlYW4gaXNDbG9zZWQo\nKSB7CiAgICAgICAgcmV0dXJuIF9jbG9zZWQ7CiAgICB9CgogICAgcHVibGlj\nIHZvaWQgY2xvc2UoKSB7CiAgICAgICAgbG9jaygpOwogICAgICAgIHRyeSB7\nCiAgICAgICAgICAgIGFzc2VydE9wZW4oKTsKICAgICAgICAgICAgYXNzZXJ0\nTm9BY3RpdmVUcmFuc2FjdGlvbigpOwoKICAgICAgICAgICAgLy8gcmVtb3Zl\nIGZyb20gZmFjdG9yeSBwb29sCiAgICAgICAgICAgIE1hcCBtYXAgPSB0b1Bv\nb2xLZXkoX2NvbmYpOwogICAgICAgICAgICBzeW5jaHJvbml6ZWQgKF9wb29s\nKSB7CiAgICAgICAgICAgICAgICBpZiAoX3Bvb2wuZ2V0KG1hcCkgPT0gdGhp\ncykKICAgICAgICAgICAgICAgICAgICBfcG9vbC5yZW1vdmUobWFwKTsKICAg\nICAgICAgICAgfQoKICAgICAgICAgICAgLy8gY2xvc2UgYWxsIGJyb2tlcnMK\nICAgICAgICAgICAgQnJva2VyIGJyb2tlcjsKICAgICAgICAgICAgZm9yIChJ\ndGVyYXRvciBpdHIgPSBfYnJva2Vycy5pdGVyYXRvcigpOyBpdHIuaGFzTmV4\ndCgpOykgewogICAgICAgICAgICAgICAgYnJva2VyID0gKEJyb2tlcikgaXRy\nLm5leHQoKTsKICAgICAgICAgICAgICAgIC8vIENoZWNrIGZvciBudWxsIGJl\nY2F1c2UgX2Jyb2tlcnMgY29udGFpbnMgd2VhayByZWZlcmVuY2VzCiAgICAg\nICAgICAgICAgICBpZiAoKGJyb2tlciAhPSBudWxsKSAmJiAoIWJyb2tlci5p\nc0Nsb3NlZCgpKSkKICAgICAgICAgICAgICAgICAgICBicm9rZXIuY2xvc2Uo\nKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYoX2NvbmYubWV0YURh\ndGFSZXBvc2l0b3J5QXZhaWxhYmxlKCkpIHsKICAgICAgICAgICAgICAgIC8v\nIHJlbW92ZSBtZXRhZGF0YSByZXBvc2l0b3J5IGZyb20gbGlzdGVuZXIgbGlz\ndAogICAgICAgICAgICAgICAgUENSZWdpc3RyeS5yZW1vdmVSZWdpc3RlckNs\nYXNzTGlzdGVuZXIKICAgICAgICAgICAgICAgICAgICAoX2NvbmYuZ2V0TWV0\nYURhdGFSZXBvc2l0b3J5SW5zdGFuY2UoKSk7CiAgICAgICAgICAgIH0KCiAg\nICAgICAgICAgIF9jb25mLmNsb3NlKCk7CiAgICAgICAgICAgIF9jbG9zZWQg\nPSB0cnVlOwogICAgICAgICAgICBMb2cgbG9nID0gX2NvbmYuZ2V0TG9nKE9w\nZW5KUEFDb25maWd1cmF0aW9uLkxPR19SVU5USU1FKTsKICAgICAgICAgICAg\naWYgKGxvZy5pc1RyYWNlRW5hYmxlZCgpKQogICAgICAgICAgICAgICAgX2Ns\nb3NlZEV4Y2VwdGlvbiA9IG5ldyBJbGxlZ2FsU3RhdGVFeGNlcHRpb24oKTsK\nICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICB1bmxvY2soKTsKICAg\nICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBTdWJjbGFzc2VzIHNob3Vs\nZCBvdmVycmlkZSB0aGlzIG1ldGhvZCB0byBhZGQgYSA8Y29kZT5QbGF0Zm9y\nbTwvY29kZT4KICAgICAqIHByb3BlcnR5IGxpc3RpbmcgdGhlIHJ1bnRpbWUg\ncGxhdGZvcm0sIHN1Y2ggYXM6CiAgICAgKiA8Y29kZT5PcGVuSlBBIEpEQkMg\nRWRpdGlvbjogT3JhY2xlIERhdGFiYXNlPC9jb2RlPgogICAgICovCiAgICBw\ndWJsaWMgUHJvcGVydGllcyBnZXRQcm9wZXJ0aWVzKCkgewogICAgICAgIC8v\nIHJlcXVpcmVkIHByb3BzIGFyZSBWZW5kb3JOYW1lIGFuZCBWZXJzaW9uTnVt\nYmVyCiAgICAgICAgUHJvcGVydGllcyBwcm9wcyA9IG5ldyBQcm9wZXJ0aWVz\nKCk7CiAgICAgICAgcHJvcHMuc2V0UHJvcGVydHkoIlZlbmRvck5hbWUiLCBP\ncGVuSlBBVmVyc2lvbi5WRU5ET1JfTkFNRSk7CiAgICAgICAgcHJvcHMuc2V0\nUHJvcGVydHkoIlZlcnNpb25OdW1iZXIiLCBPcGVuSlBBVmVyc2lvbi5WRVJT\nSU9OX05VTUJFUik7CiAgICAgICAgcHJvcHMuc2V0UHJvcGVydHkoIlZlcnNp\nb25JZCIsIE9wZW5KUEFWZXJzaW9uLlZFUlNJT05fSUQpOwogICAgICAgIHJl\ndHVybiBwcm9wczsKICAgIH0KCiAgICBwdWJsaWMgT2JqZWN0IGdldFVzZXJP\nYmplY3QoT2JqZWN0IGtleSkgewogICAgICAgIGxvY2soKTsKICAgICAgICB0\ncnkgewogICAgICAgICAgICBhc3NlcnRPcGVuKCk7CiAgICAgICAgICAgIHJl\ndHVybiAoX3VzZXJPYmplY3RzID09IG51bGwpID8gbnVsbCA6IF91c2VyT2Jq\nZWN0cy5nZXQoa2V5KTsKICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAg\nICB1bmxvY2soKTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGljIE9iamVj\ndCBwdXRVc2VyT2JqZWN0KE9iamVjdCBrZXksIE9iamVjdCB2YWwpIHsKICAg\nICAgICBsb2NrKCk7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgYXNzZXJ0\nT3BlbigpOwogICAgICAgICAgICBpZiAodmFsID09IG51bGwpCiAgICAgICAg\nICAgICAgICByZXR1cm4gKF91c2VyT2JqZWN0cyA9PSBudWxsKSA/IG51bGwg\nOiBfdXNlck9iamVjdHMucmVtb3ZlKGtleSk7CgogICAgICAgICAgICBpZiAo\nX3VzZXJPYmplY3RzID09IG51bGwpCiAgICAgICAgICAgICAgICBfdXNlck9i\namVjdHMgPSBuZXcgSGFzaE1hcCgpOwogICAgICAgICAgICByZXR1cm4gX3Vz\nZXJPYmplY3RzLnB1dChrZXksIHZhbCk7CiAgICAgICAgfSBmaW5hbGx5IHsK\nICAgICAgICAgICAgdW5sb2NrKCk7CiAgICAgICAgfQogICAgfQoKICAgIHB1\nYmxpYyB2b2lkIGxvY2soKSB7CiAgICAgICAgX2xvY2subG9jaygpOwogICAg\nfQoKICAgIHB1YmxpYyB2b2lkIHVubG9jaygpIHsKICAgICAgICBfbG9jay51\nbmxvY2soKTsKICAgIH0KCiAgICAvKioKICAgICAqIFJlcGxhY2VzIHRoZSBm\nYWN0b3J5IHdpdGggdGhpcyBKVk1zIHBvb2xlZCB2ZXJzaW9uIGlmIGl0IGV4\naXN0cy4gQWxzbwogICAgICogZnJlZXplcyB0aGUgZmFjdG9yeS4KICAgICAq\nLwogICAgcHJvdGVjdGVkIE9iamVjdCByZWFkUmVzb2x2ZSgpCiAgICAgICAg\ndGhyb3dzIE9iamVjdFN0cmVhbUV4Y2VwdGlvbiB7CiAgICAgICAgQWJzdHJh\nY3RCcm9rZXJGYWN0b3J5IGZhY3RvcnkgPSBnZXRQb29sZWRGYWN0b3J5KF9j\nb25mKTsKICAgICAgICBpZiAoZmFjdG9yeSAhPSBudWxsKQogICAgICAgICAg\nICByZXR1cm4gZmFjdG9yeTsKCiAgICAgICAgLy8gcmVzZXQgdGhlc2UgdHJh\nbnNpZW50IGZpZWxkcyB0byBlbXB0eSB2YWx1ZXMKICAgICAgICBfdHJhbnNh\nY3Rpb25hbCA9IG5ldyBDb25jdXJyZW50SGFzaE1hcCgpOwogICAgICAgIF9i\ncm9rZXJzID0gbmV3IENvbmN1cnJlbnRSZWZlcmVuY2VIYXNoU2V0KAogICAg\nICAgICAgICAgICAgQ29uY3VycmVudFJlZmVyZW5jZUhhc2hTZXQuV0VBSyk7\nCgogICAgICAgIG1ha2VSZWFkT25seSgpOwogICAgICAgIHJldHVybiB0aGlz\nOwogICAgfQoKICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwogICAgLy8g\nTWV0aG9kcyBmb3IgT3ZlcnJpZGUKICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8v\nLy8vLwoKICAgIC8qKgogICAgICogUmV0dXJuIGEgbmV3IFN0b3JlTWFuYWdl\nciBmb3IgdGhpcyBydW50aW1lLiBOb3RlIHRoYXQgdGhlIGluc3RhbmNlCiAg\nICAgKiByZXR1cm5lZCBoZXJlIG1heSBiZSB3cmFwcGVkIGJlZm9yZSBiZWlu\nZyBwYXNzZWQgdG8gdGhlCiAgICAgKiB7QGxpbmsgI25ld0Jyb2tlcn0gbWV0\naG9kLgogICAgICovCiAgICBwcm90ZWN0ZWQgYWJzdHJhY3QgU3RvcmVNYW5h\nZ2VyIG5ld1N0b3JlTWFuYWdlcigpOwoKICAgIC8qKgogICAgICogRmluZCBh\nIHBvb2xlZCBicm9rZXIsIG9yIHJldHVybiBudWxsIGlmIG5vbmUuIElmIHVz\naW5nCiAgICAgKiBtYW5hZ2VkIHRyYW5zYWN0aW9ucywgbG9va3MgZm9yIGEg\ndHJhbnNhY3Rpb25hbCBicm9rZXI7CiAgICAgKiBvdGhlcndpc2UgcmV0dXJu\ncyBudWxsIGJ5IGRlZmF1bHQuIFRoaXMgbWV0aG9kIHdpbGwgYmUgY2FsbGVk\nIGJlZm9yZQogICAgICoge0BsaW5rICNuZXdTdG9yZU1hbmFnZXJ9IHNvIHRo\nYXQgZmFjdG9yeSBzdWJjbGFzc2VzIGltcGxlbWVudGluZwogICAgICogcG9v\nbGluZyBjYW4gcmV0dXJuIGEgbWF0Y2hpbmcgbWFuYWdlciBiZWZvcmUgYSBu\nZXcge0BsaW5rIFN0b3JlTWFuYWdlcn0KICAgICAqIGlzIGNyZWF0ZWQuCiAg\nICAgKi8KICAgIHByb3RlY3RlZCBCcm9rZXJJbXBsIGZpbmRCcm9rZXIoU3Ry\naW5nIHVzZXIsIFN0cmluZyBwYXNzLCBib29sZWFuIG1hbmFnZWQpIHsKICAg\nICAgICBpZiAobWFuYWdlZCkKICAgICAgICAgICAgcmV0dXJuIGZpbmRUcmFu\nc2FjdGlvbmFsQnJva2VyKHVzZXIsIHBhc3MpOwogICAgICAgIHJldHVybiBu\ndWxsOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIGEgYnJva2VyIGNv\nbmZpZ3VyZWQgd2l0aCB0aGUgcHJvcGVyIHNldHRpbmdzLgogICAgICogQnkg\nZGVmYXVsdCwgdGhpcyBtZXRob2QgY29uc3RydWN0cyBhIG5ldwogICAgICog\nQnJva2VySW1wbCBvZiB0aGUgY2xhc3Mgc2V0IGZvciB0aGlzIGZhY3Rvcnku\nCiAgICAgKi8KICAgIHByb3RlY3RlZCBCcm9rZXJJbXBsIG5ld0Jyb2tlcklt\ncGwoU3RyaW5nIHVzZXIsIFN0cmluZyBwYXNzKSB7CiAgICAgICAgQnJva2Vy\nSW1wbCBicm9rZXIgPSBfY29uZi5uZXdCcm9rZXJJbnN0YW5jZSh1c2VyLCBw\nYXNzKTsKICAgICAgICBpZiAoYnJva2VyID09IG51bGwpCiAgICAgICAgICAg\nIHRocm93IG5ldyBVc2VyRXhjZXB0aW9uKF9sb2MuZ2V0KCJuby1icm9rZXIt\nY2xhc3MiLAogICAgICAgICAgICAgICAgX2NvbmYuZ2V0QnJva2VySW1wbCgp\nKSk7CgogICAgICAgIHJldHVybiBicm9rZXI7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBTZXR1cCB0cmFuc2llbnQgc3RhdGUgdXNlZCBieSB0aGlzIGZhY3Rv\ncnkgYmFzZWQgb24gdGhlCiAgICAgKiBjdXJyZW50IGNvbmZpZ3VyYXRpb24s\nIHdoaWNoIHdpbGwgc3Vic2VxdWVudGx5IGJlIGxvY2tlZCBkb3duLiBUaGlz\nCiAgICAgKiBtZXRob2Qgd2lsbCBiZSBjYWxsZWQgYmVmb3JlIHRoZSBmaXJz\ndCBicm9rZXIgaXMgcmVxdWVzdGVkLAogICAgICogYW5kIHdpbGwgYmUgcmUt\nY2FsbGVkIGVhY2ggdGltZSB0aGUgZmFjdG9yeSBpcyBkZXNlcmlhbGl6ZWQg\naW50byBhIEpWTQogICAgICogdGhhdCBoYXMgbm8gY29uZmlndXJhdGlvbiBm\nb3IgdGhpcyBkYXRhIHN0b3JlLgogICAgICovCiAgICBwcm90ZWN0ZWQgdm9p\nZCBzZXR1cCgpIHsKICAgIH0KCiAgICAvLy8vLy8vLy8vLy8vCiAgICAvLyBV\ndGlsaXRpZXMKICAgIC8vLy8vLy8vLy8vLy8KCiAgICAvKioKICAgICAqIEZp\nbmQgYSBtYW5hZ2VkIHJ1bnRpbWUgYnJva2VyIGFzc29jaWF0ZWQgd2l0aCB0\naGUKICAgICAqIGN1cnJlbnQgdHJhbnNhY3Rpb24sIG9yIHJldHVybnMgbnVs\nbCBpZiBub25lLgogICAgICovCiAgICBwcm90ZWN0ZWQgQnJva2VySW1wbCBm\naW5kVHJhbnNhY3Rpb25hbEJyb2tlcihTdHJpbmcgdXNlciwgU3RyaW5nIHBh\nc3MpIHsKICAgICAgICBUcmFuc2FjdGlvbiB0cmFuczsKICAgICAgICBNYW5h\nZ2VkUnVudGltZSBtciA9IF9jb25mLmdldE1hbmFnZWRSdW50aW1lSW5zdGFu\nY2UoKTsKICAgICAgICBPYmplY3QgdHhLZXk7CiAgICAgICAgdHJ5IHsKICAg\nICAgICAgICAgdHJhbnMgPSBtci5nZXRUcmFuc2FjdGlvbk1hbmFnZXIoKS4K\nICAgICAgICAgICAgICAgIGdldFRyYW5zYWN0aW9uKCk7CiAgICAgICAgICAg\nIHR4S2V5ID0gbXIuZ2V0VHJhbnNhY3Rpb25LZXkoKTsKCiAgICAgICAgICAg\nIGlmICh0cmFucyA9PSBudWxsCiAgICAgICAgICAgICAgICB8fCB0cmFucy5n\nZXRTdGF0dXMoKSA9PSBTdGF0dXMuU1RBVFVTX05PX1RSQU5TQUNUSU9OCiAg\nICAgICAgICAgICAgICB8fCB0cmFucy5nZXRTdGF0dXMoKSA9PSBTdGF0dXMu\nU1RBVFVTX1VOS05PV04pCiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDsK\nICAgICAgICB9IGNhdGNoIChPcGVuSlBBRXhjZXB0aW9uIGtlKSB7CiAgICAg\nICAgICAgIHRocm93IGtlOwogICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBl\nKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBHZW5lcmFsRXhjZXB0aW9uKGUp\nOwogICAgICAgIH0KCiAgICAgICAgQ29sbGVjdGlvbiBicm9rZXJzID0gKENv\nbGxlY3Rpb24pIF90cmFuc2FjdGlvbmFsLmdldCh0eEtleSk7CiAgICAgICAg\naWYgKGJyb2tlcnMgIT0gbnVsbCkgewogICAgICAgICAgICAvLyB3ZSBkb24n\ndCBuZWVkIHRvIHN5bmNocm9uaXplIG9uIGJyb2tlcnMgc2luY2Ugb25lIEpU\nQSB0cmFuc2FjdGlvbgogICAgICAgICAgICAvLyBjYW4gbmV2ZXIgYmUgYWN0\naXZlIG9uIG11bHRpcGxlIGNvbmN1cnJlbnQgdGhyZWFkcy4KICAgICAgICAg\nICAgQnJva2VySW1wbCBicm9rZXI7CiAgICAgICAgICAgIGZvciAoSXRlcmF0\nb3IgaXRyID0gYnJva2Vycy5pdGVyYXRvcigpOyBpdHIuaGFzTmV4dCgpOykg\newogICAgICAgICAgICAgICAgYnJva2VyID0gKEJyb2tlckltcGwpIGl0ci5u\nZXh0KCk7CiAgICAgICAgICAgICAgICBpZiAoU3RyaW5nVXRpbHMuZXF1YWxz\nKGJyb2tlci5nZXRDb25uZWN0aW9uVXNlck5hbWUoKSwKICAgICAgICAgICAg\nICAgICAgICB1c2VyKSAmJiBTdHJpbmdVdGlscy5lcXVhbHMKICAgICAgICAg\nICAgICAgICAgICAoYnJva2VyLmdldENvbm5lY3Rpb25QYXNzd29yZCgpLCBw\nYXNzKSkKICAgICAgICAgICAgICAgICAgICByZXR1cm4gYnJva2VyOwogICAg\nICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiBudWxsOwogICAg\nfQoKICAgIC8qKgogICAgICogQ29uZmlndXJlcyB0aGUgZ2l2ZW4gYnJva2Vy\nIHdpdGggdGhlIGN1cnJlbnQgZmFjdG9yeSBvcHRpb24gc2V0dGluZ3MuCiAg\nICAgKi8KICAgIHByb3RlY3RlZCB2b2lkIGNvbmZpZ3VyZUJyb2tlcihCcm9r\nZXJJbXBsIGJyb2tlcikgewogICAgICAgIGJyb2tlci5zZXRPcHRpbWlzdGlj\nKF9jb25mLmdldE9wdGltaXN0aWMoKSk7CiAgICAgICAgYnJva2VyLnNldE5v\nbnRyYW5zYWN0aW9uYWxSZWFkKF9jb25mLmdldE5vbnRyYW5zYWN0aW9uYWxS\nZWFkKCkpOwogICAgICAgIGJyb2tlci5zZXROb250cmFuc2FjdGlvbmFsV3Jp\ndGUoX2NvbmYuZ2V0Tm9udHJhbnNhY3Rpb25hbFdyaXRlKCkpOwogICAgICAg\nIGJyb2tlci5zZXRSZXRhaW5TdGF0ZShfY29uZi5nZXRSZXRhaW5TdGF0ZSgp\nKTsKICAgICAgICBicm9rZXIuc2V0UmVzdG9yZVN0YXRlKF9jb25mLmdldFJl\nc3RvcmVTdGF0ZUNvbnN0YW50KCkpOwogICAgICAgIGJyb2tlci5zZXRBdXRv\nQ2xlYXIoX2NvbmYuZ2V0QXV0b0NsZWFyQ29uc3RhbnQoKSk7CiAgICAgICAg\nYnJva2VyLnNldElnbm9yZUNoYW5nZXMoX2NvbmYuZ2V0SWdub3JlQ2hhbmdl\ncygpKTsKICAgICAgICBicm9rZXIuc2V0TXVsdGl0aHJlYWRlZChfY29uZi5n\nZXRNdWx0aXRocmVhZGVkKCkpOwogICAgICAgIGJyb2tlci5zZXRBdXRvRGV0\nYWNoKF9jb25mLmdldEF1dG9EZXRhY2hDb25zdGFudCgpKTsKICAgICAgICBi\ncm9rZXIuc2V0RGV0YWNoU3RhdGUoX2NvbmYuZ2V0RGV0YWNoU3RhdGVJbnN0\nYW5jZSgpLgogICAgICAgICAgICBnZXREZXRhY2hTdGF0ZSgpKTsKICAgIH0K\nCiAgICAvKioKICAgICAqIEFkZCB0aGUgZmFjdG9yeSB0byB0aGUgcG9vbC4K\nICAgICAqLwogICAgcHJvdGVjdGVkIHZvaWQgcG9vbCgpIHsKICAgICAgICBz\neW5jaHJvbml6ZWQgKF9wb29sKSB7CiAgICAgICAgICAgIF9wb29sLnB1dCh0\nb1Bvb2xLZXkoX2NvbmYpLCB0aGlzKTsKICAgICAgICAgICAgbWFrZVJlYWRP\nbmx5KCk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogRnJlZXpl\ncyB0aGUgY29uZmlndXJhdGlvbiBvZiB0aGlzIGZhY3RvcnkuCiAgICAgKi8K\nICAgIHB1YmxpYyB2b2lkIG1ha2VSZWFkT25seSgpIHsKICAgICAgICBpZiAo\nX3JlYWRPbmx5KQogICAgICAgICAgICByZXR1cm47CgogICAgICAgIGxvY2so\nKTsKICAgICAgICB0cnkgewogICAgICAgICAgICAvLyBjaGVjayBhZ2Fpbgog\nICAgICAgICAgICBpZiAoX3JlYWRPbmx5KQogICAgICAgICAgICAgICAgcmV0\ndXJuOwogICAgICAgICAgICBfcmVhZE9ubHkgPSB0cnVlOwoKICAgICAgICAg\nICAgTG9nIGxvZyA9IF9jb25mLmdldExvZyhPcGVuSlBBQ29uZmlndXJhdGlv\nbi5MT0dfUlVOVElNRSk7CiAgICAgICAgICAgIGlmIChsb2cuaXNJbmZvRW5h\nYmxlZCgpKQogICAgICAgICAgICAgICAgbG9nLmluZm8oZ2V0RmFjdG9yeUlu\naXRpYWxpemF0aW9uQmFubmVyKCkpOwogICAgICAgICAgICBpZiAobG9nLmlz\nVHJhY2VFbmFibGVkKCkpIHsKICAgICAgICAgICAgICAgIE1hcCBwcm9wcyA9\nIF9jb25mLnRvUHJvcGVydGllcyh0cnVlKTsKICAgICAgICAgICAgICAgIFN0\ncmluZyBsaW5lU2VwID0gSjJEb1ByaXZIZWxwZXIuZ2V0TGluZVNlcGFyYXRv\ncigpOwogICAgICAgICAgICAgICAgU3RyaW5nQnVmZmVyIGJ1ZiA9IG5ldyBT\ndHJpbmdCdWZmZXIoKTsKICAgICAgICAgICAgICAgIE1hcC5FbnRyeSBlbnRy\neTsKICAgICAgICAgICAgICAgIGZvciAoSXRlcmF0b3IgaXRyID0gcHJvcHMu\nZW50cnlTZXQoKS5pdGVyYXRvcigpOwogICAgICAgICAgICAgICAgICAgIGl0\nci5oYXNOZXh0KCk7KSB7CiAgICAgICAgICAgICAgICAgICAgZW50cnkgPSAo\nTWFwLkVudHJ5KSBpdHIubmV4dCgpOwogICAgICAgICAgICAgICAgICAgIGJ1\nZi5hcHBlbmQoZW50cnkuZ2V0S2V5KCkpLmFwcGVuZCgiOiAiKS4KICAgICAg\nICAgICAgICAgICAgICAgICAgYXBwZW5kKGVudHJ5LmdldFZhbHVlKCkpOwog\nICAgICAgICAgICAgICAgICAgIGlmIChpdHIuaGFzTmV4dCgpKQogICAgICAg\nICAgICAgICAgICAgICAgICBidWYuYXBwZW5kKGxpbmVTZXApOwogICAgICAg\nICAgICAgICAgfQogICAgICAgICAgICAgICAgbG9nLnRyYWNlKF9sb2MuZ2V0\nKCJmYWN0b3J5LXByb3BlcnRpZXMiLCBidWYudG9TdHJpbmcoKSkpOwogICAg\nICAgICAgICB9CgogICAgICAgICAgICAvLyBzZXR1cCB0cmFuc2llbnQgc3Rh\ndGUKICAgICAgICAgICAgc2V0dXAoKTsKCiAgICAgICAgICAgIC8vIHJlZ2lz\ndGVyIHRoZSBtZXRkYXRhIHJlcG9zaXRvcnkgdG8gYXV0by1sb2FkIHBlcnNp\nc3RlbnQgdHlwZXMKICAgICAgICAgICAgLy8gYW5kIG1ha2Ugc3VyZSB0eXBl\ncyBhcmUgZW5oYW5jZWQKICAgICAgICAgICAgTWV0YURhdGFSZXBvc2l0b3J5\nIHJlcG9zID0gX2NvbmYuZ2V0TWV0YURhdGFSZXBvc2l0b3J5SW5zdGFuY2Uo\nKTsKICAgICAgICAgICAgcmVwb3Muc2V0VmFsaWRhdGUocmVwb3MuVkFMSURB\nVEVfUlVOVElNRSwgdHJ1ZSk7CiAgICAgICAgICAgIHJlcG9zLnNldFJlc29s\ndmUocmVwb3MuTU9ERV9NQVBQSU5HX0lOSVQsIHRydWUpOwogICAgICAgICAg\nICBQQ1JlZ2lzdHJ5LmFkZFJlZ2lzdGVyQ2xhc3NMaXN0ZW5lcihyZXBvcyk7\nCgogICAgICAgICAgICAvLyBmcmVlemUgdW5kZXJseWluZyBjb25maWd1cmF0\naW9uIGFuZCBlYWdlcmx5IGluaXRpYWxpemUgdG8KICAgICAgICAgICAgLy8g\nYXZvaWQgc3luY2hyb25pemF0aW9uCiAgICAgICAgICAgIF9jb25mLnNldFJl\nYWRPbmx5KHRydWUpOwogICAgICAgICAgICBfY29uZi5pbnN0YW50aWF0ZUFs\nbCgpOwoKICAgICAgICAgICAgLy8gZmlyZSBhbiBldmVudCBmb3IgYWxsIHRo\nZSBicm9rZXIgZmFjdG9yeSBsaXN0ZW5lcnMKICAgICAgICAgICAgLy8gcmVn\naXN0ZXJlZCBvbiB0aGUgY29uZmlndXJhdGlvbi4KICAgICAgICAgICAgX2Nv\nbmYuZ2V0QnJva2VyRmFjdG9yeUV2ZW50TWFuYWdlcigpLmZpcmVFdmVudCgK\nICAgICAgICAgICAgICAgIG5ldyBCcm9rZXJGYWN0b3J5RXZlbnQodGhpcywK\nICAgICAgICAgICAgICAgICAgICBCcm9rZXJGYWN0b3J5RXZlbnQuQlJPS0VS\nX0ZBQ1RPUllfQ1JFQVRFRCkpOwogICAgICAgIH0gZmluYWxseSB7CiAgICAg\nICAgICAgIHVubG9jaygpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAg\nICAqIFJldHVybiBhbiBvYmplY3QgdG8gYmUgd3JpdHRlbiB0byB0aGUgbG9n\nIHdoZW4gdGhpcyBicm9rZXIgZmFjdG9yeQogICAgICogaW5pdGlhbGl6ZXMu\nIFRoaXMgaGFwcGVucyBhZnRlciB0aGUgY29uZmlndXJhdGlvbiBpcyBmdWxs\neSBsb2FkZWQuCiAgICAgKi8KICAgIHByb3RlY3RlZCBPYmplY3QgZ2V0RmFj\ndG9yeUluaXRpYWxpemF0aW9uQmFubmVyKCkgewogICAgICAgIHJldHVybiBf\nbG9jLmdldCgiZmFjdG9yeS1pbml0IiwgT3BlbkpQQVZlcnNpb24uVkVSU0lP\nTl9OVU1CRVIpOwogICAgfQoKICAgIC8qKgogICAgICogVGhyb3cgYW4gZXhj\nZXB0aW9uIGlmIHRoZSBmYWN0b3J5IGlzIGNsb3NlZC4gIFRoZSBleGFjdCBt\nZXNzYWdlIGFuZAogICAgICogY29udGVudCBvZiB0aGUgZXhjZXB0aW9uIHZh\ncmllcyB3aGV0aGVyIFRSQUNFIGlzIGVuYWJsZWQgb3Igbm90LgogICAgICov\nCiAgICBwcml2YXRlIHZvaWQgYXNzZXJ0T3BlbigpIHsKICAgICAgICBpZiAo\nX2Nsb3NlZCkgewogICAgICAgICAgICBpZiAoX2Nsb3NlZEV4Y2VwdGlvbiA9\nPSBudWxsKSAgLy8gVFJBQ0Ugbm90IGVuYWJsZWQKICAgICAgICAgICAgICAg\nIHRocm93IG5ldyBJbnZhbGlkU3RhdGVFeGNlcHRpb24oX2xvYwogICAgICAg\nICAgICAgICAgICAgICAgICAuZ2V0KCJjbG9zZWQtZmFjdG9yeS1ub3RyYWNl\nIikpOwogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICB0aHJvdyBu\nZXcgSW52YWxpZFN0YXRlRXhjZXB0aW9uKF9sb2MuZ2V0KCJjbG9zZWQtZmFj\ndG9yeSIpKQogICAgICAgICAgICAgICAgICAgICAgICAuc2V0Q2F1c2UoX2Ns\nb3NlZEV4Y2VwdGlvbik7CiAgICAgICAgfQogICAgfQoKICAgIC8vLy8vLy8v\nLy8vLy8vLy8vLy8vCiAgICAvLyBCcm9rZXIgdXRpbGl0aWVzCiAgICAvLy8v\nLy8vLy8vLy8vLy8vLy8vLwoKICAgIC8qKgogICAgICogVGhyb3dzIGEge0Bs\naW5rIFVzZXJFeGNlcHRpb259IGlmIGEgdHJhbnNhY3Rpb24gaXMgYWN0aXZl\nLiBUaGUgdGhyb3duCiAgICAgKiBleGNlcHRpb24gd2lsbCBjb250YWluIGFs\nbCB0aGUgQnJva2VycyB3aXRoIGFjdGl2ZSB0cmFuc2FjdGlvbnMgYXMKICAg\nICAqIGZhaWxlZCBvYmplY3RzIGluIHRoZSBuZXN0ZWQgZXhjZXB0aW9ucy4K\nICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIGFzc2VydE5vQWN0aXZlVHJhbnNh\nY3Rpb24oKSB7CiAgICAgICAgQ29sbGVjdGlvbiBleGNzOwogICAgICAgIGlm\nIChfdHJhbnNhY3Rpb25hbC5pc0VtcHR5KCkpCiAgICAgICAgICAgIHJldHVy\nbjsKCiAgICAgICAgZXhjcyA9IG5ldyBBcnJheUxpc3QoX3RyYW5zYWN0aW9u\nYWwuc2l6ZSgpKTsKICAgICAgICBmb3IgKEl0ZXJhdG9yIHRyYW5zID0gX3Ry\nYW5zYWN0aW9uYWwudmFsdWVzKCkuaXRlcmF0b3IoKTsKICAgICAgICAgICAg\ndHJhbnMuaGFzTmV4dCgpOykgewogICAgICAgICAgICBDb2xsZWN0aW9uIGJy\nb2tlcnMgPSAoQ29sbGVjdGlvbikgdHJhbnMubmV4dCgpOwogICAgICAgICAg\nICBmb3IgKEl0ZXJhdG9yIGl0ciA9IGJyb2tlcnMuaXRlcmF0b3IoKTsgaXRy\nLmhhc05leHQoKTspIHsKICAgICAgICAgICAgICAgIGV4Y3MuYWRkKG5ldyBJ\nbnZhbGlkU3RhdGVFeGNlcHRpb24oX2xvYy5nZXQoImFjdGl2ZSIpKS4KICAg\nICAgICAgICAgICAgICAgICBzZXRGYWlsZWRPYmplY3QoaXRyLm5leHQoKSkp\nOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAoIWV4Y3Mu\naXNFbXB0eSgpKQogICAgICAgICAgICB0aHJvdyBuZXcgSW52YWxpZFN0YXRl\nRXhjZXB0aW9uKF9sb2MuZ2V0KCJuZXN0ZWQtZXhjZXBzIikpLgogICAgICAg\nICAgICAgICAgc2V0TmVzdGVkVGhyb3dhYmxlcygoVGhyb3dhYmxlW10pIGV4\nY3MudG9BcnJheQogICAgICAgICAgICAgICAgICAgIChuZXcgVGhyb3dhYmxl\nW2V4Y3Muc2l6ZSgpXSkpOwogICAgfQoKICAgIC8qKgogICAgICogU3luY2hy\nb25pemUgdGhlIGdpdmVuIGJyb2tlciB3aXRoIGEgbWFuYWdlZCB0cmFuc2Fj\ndGlvbiwKICAgICAqIG9wdGlvbmFsbHkgc3RhcnRpbmcgb25lIGlmIG5vbmUg\naXMgaW4gcHJvZ3Jlc3MuCiAgICAgKgogICAgICogQHJldHVybiB0cnVlIGlm\nIHN5bmNoZWQgd2l0aCB0cmFuc2FjdGlvbiwgZmFsc2Ugb3RoZXJ3aXNlCiAg\nICAgKi8KICAgIGJvb2xlYW4gc3luY1dpdGhNYW5hZ2VkVHJhbnNhY3Rpb24o\nQnJva2VySW1wbCBicm9rZXIsIGJvb2xlYW4gYmVnaW4pIHsKICAgICAgICBU\ncmFuc2FjdGlvbiB0cmFuczsKICAgICAgICB0cnkgewogICAgICAgICAgICBN\nYW5hZ2VkUnVudGltZSBtciA9IGJyb2tlci5nZXRNYW5hZ2VkUnVudGltZSgp\nOwogICAgICAgICAgICBUcmFuc2FjdGlvbk1hbmFnZXIgdG0gPSBtci5nZXRU\ncmFuc2FjdGlvbk1hbmFnZXIoKTsKICAgICAgICAgICAgdHJhbnMgPSB0bS5n\nZXRUcmFuc2FjdGlvbigpOwogICAgICAgICAgICBpZiAodHJhbnMgIT0gbnVs\nbAogICAgICAgICAgICAgICAgJiYgKHRyYW5zLmdldFN0YXR1cygpID09IFN0\nYXR1cy5TVEFUVVNfTk9fVFJBTlNBQ1RJT04KICAgICAgICAgICAgICAgIHx8\nIHRyYW5zLmdldFN0YXR1cygpID09IFN0YXR1cy5TVEFUVVNfVU5LTk9XTikp\nCiAgICAgICAgICAgICAgICB0cmFucyA9IG51bGw7CgogICAgICAgICAgICBp\nZiAodHJhbnMgPT0gbnVsbCAmJiBiZWdpbikgewogICAgICAgICAgICAgICAg\ndG0uYmVnaW4oKTsKICAgICAgICAgICAgICAgIHRyYW5zID0gdG0uZ2V0VHJh\nbnNhY3Rpb24oKTsKICAgICAgICAgICAgfSBlbHNlIGlmICh0cmFucyA9PSBu\ndWxsKQogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoKICAgICAgICAg\nICAgLy8gc3luY2ggYnJva2VyIGFuZCB0cmFucwogICAgICAgICAgICB0cmFu\ncy5yZWdpc3RlclN5bmNocm9uaXphdGlvbihicm9rZXIpOwoKICAgICAgICAg\nICAgLy8gd2UgZG9uJ3QgbmVlZCB0byBzeW5jaHJvbml6ZSBvbiBicm9rZXJz\nIG9yIGd1YXJkIGFnYWluc3QgbXVsdGlwbGUKICAgICAgICAgICAgLy8gdGhy\nZWFkcyB1c2luZyB0aGUgc2FtZSB0cmFucyBzaW5jZSBvbmUgSlRBIHRyYW5z\nYWN0aW9uIGNhbiBuZXZlcgogICAgICAgICAgICAvLyBiZSBhY3RpdmUgb24g\nbXVsdGlwbGUgY29uY3VycmVudCB0aHJlYWRzLgogICAgICAgICAgICBPYmpl\nY3QgdHhLZXkgPSBtci5nZXRUcmFuc2FjdGlvbktleSgpOwogICAgICAgICAg\nICBDb2xsZWN0aW9uIGJyb2tlcnMgPSAoQ29sbGVjdGlvbikgX3RyYW5zYWN0\naW9uYWwuZ2V0KHR4S2V5KTsKICAgICAgICAgICAgCiAgICAgICAgICAgIGlm\nIChicm9rZXJzID09IG51bGwpIHsKICAgICAgICAgICAgICAgIGJyb2tlcnMg\nPSBuZXcgQXJyYXlMaXN0KDIpOwogICAgICAgICAgICAgICAgX3RyYW5zYWN0\naW9uYWwucHV0KHR4S2V5LCBicm9rZXJzKTsKICAgICAgICAgICAgICAgIHRy\nYW5zLnJlZ2lzdGVyU3luY2hyb25pemF0aW9uKG5ldyBSZW1vdmVUcmFuc2Fj\ndGlvblN5bmModHhLZXkpKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBi\ncm9rZXJzLmFkZChicm9rZXIpOwogICAgICAgICAgICAKICAgICAgICAgICAg\ncmV0dXJuIHRydWU7CiAgICAgICAgfSBjYXRjaCAoT3BlbkpQQUV4Y2VwdGlv\nbiBrZSkgewogICAgICAgICAgICB0aHJvdyBrZTsKICAgICAgICB9IGNhdGNo\nIChFeGNlcHRpb24gZSkgewogICAgICAgICAgICB0aHJvdyBuZXcgR2VuZXJh\nbEV4Y2VwdGlvbihlKTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAg\nKiBSZXR1cm5zIGEgc2V0IG9mIGFsbCB0aGUgb3BlbiBicm9rZXJzIGFzc29j\naWF0ZWQgd2l0aCB0aGlzIGZhY3RvcnkuIFRoZQogICAgICogcmV0dXJuZWQg\nc2V0IGlzIHVubW9kaWZpYWJsZSwgYW5kIG1heSBjb250YWluIG51bGwgcmVm\nZXJlbmNlcy4KICAgICAqLwogICAgcHVibGljIENvbGxlY3Rpb24gZ2V0T3Bl\nbkJyb2tlcnMoKSB7CiAgICAgICAgcmV0dXJuIENvbGxlY3Rpb25zLnVubW9k\naWZpYWJsZUNvbGxlY3Rpb24oX2Jyb2tlcnMpOwogICAgfQoKICAgIC8qKgog\nICAgICogU2ltcGxlIHN5bmNocm9uaXphdGlvbiBsaXN0ZW5lciB0byByZW1v\ndmUgY29tcGxldGVkIHRyYW5zYWN0aW9ucwogICAgICogZnJvbSBvdXIgY2Fj\naGUuCiAgICAgKi8KICAgIHByaXZhdGUgY2xhc3MgUmVtb3ZlVHJhbnNhY3Rp\nb25TeW5jCiAgICAgICAgaW1wbGVtZW50cyBTeW5jaHJvbml6YXRpb24gewoK\nICAgICAgICBwcml2YXRlIGZpbmFsIE9iamVjdCBfdHJhbnM7CgogICAgICAg\nIHB1YmxpYyBSZW1vdmVUcmFuc2FjdGlvblN5bmMoT2JqZWN0IHRyYW5zKSB7\nCiAgICAgICAgICAgIF90cmFucyA9IHRyYW5zOwogICAgICAgIH0KCiAgICAg\nICAgcHVibGljIHZvaWQgYmVmb3JlQ29tcGxldGlvbigpIHsKICAgICAgICB9\nCgogICAgICAgIHB1YmxpYyB2b2lkIGFmdGVyQ29tcGxldGlvbihpbnQgc3Rh\ndHVzKSB7CiAgICAgICAgICAgIF90cmFuc2FjdGlvbmFsLnJlbW92ZSAoX3Ry\nYW5zKTsKCQl9Cgl9Cn0K\n","encoding":"base64"}

