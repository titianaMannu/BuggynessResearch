{"sha":"cd7c86da6125ecb036bf603f589ee6ad53e05d92","node_id":"MDQ6QmxvYjIwNjM2NDpjZDdjODZkYTYxMjVlY2IwMzZiZjYwM2Y1ODllZTZhZDUzZTA1ZDky","size":12653,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/cd7c86da6125ecb036bf603f589ee6ad53e05d92","content":"LyoNCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUNCiAqIG9yIG1vcmUgY29udHJpYnV0b3Ig\nbGljZW5zZSBhZ3JlZW1lbnRzLiAgU2VlIHRoZSBOT1RJQ0UgZmlsZQ0KICog\nZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5m\nb3JtYXRpb24NCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAg\nVGhlIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUNCiAqIHRvIHlvdSB1bmRlciB0\naGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUNCiAqICJMaWNl\nbnNlIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNv\nbXBsaWFuY2UNCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFp\nbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQNCiAqDQogKiBodHRwOi8vd3d3\nLmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjANCiAqDQogKiBVbmxl\nc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGlu\nIHdyaXRpbmcsDQogKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUg\nTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbg0KICogIkFTIElTIiBCQVNJ\nUywgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZDQog\nKiBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBM\naWNlbnNlIGZvciB0aGUNCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmlu\nZyBwZXJtaXNzaW9ucyBhbmQgbGltaXRhdGlvbnMNCiAqIHVuZGVyIHRoZSBM\naWNlbnNlLiAgICANCiAqLw0KcGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEu\nbWV0YTsNCg0KaW1wb3J0IGphdmEuaW8uU2VyaWFsaXphYmxlOw0KaW1wb3J0\nIGphdmEudXRpbC5BcnJheUxpc3Q7DQppbXBvcnQgamF2YS51dGlsLkNvbGxl\nY3Rpb25zOw0KaW1wb3J0IGphdmEudXRpbC5IYXNoTWFwOw0KaW1wb3J0IGph\ndmEudXRpbC5IYXNoU2V0Ow0KaW1wb3J0IGphdmEudXRpbC5JdGVyYXRvcjsN\nCmltcG9ydCBqYXZhLnV0aWwuTGlzdDsNCmltcG9ydCBqYXZhLnV0aWwuTWFw\nOw0KaW1wb3J0IGphdmEudXRpbC5TZXQ7DQoNCmltcG9ydCBvcmcuYXBhY2hl\nLmNvbW1vbnMubGFuZy5TdHJpbmdVdGlsczsNCmltcG9ydCBvcmcuYXBhY2hl\nLmNvbW1vbnMubGFuZy5PYmplY3RVdGlsczsNCmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEubGliLnV0aWwuTG9jYWxpemVyOw0KaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS51dGlsLk1ldGFEYXRhRXhjZXB0aW9uOw0KaW1wb3J0IHNl\ncnAudXRpbC5OdW1iZXJzOw0KDQovKioNCiAqIENhcHR1cmVzIGZldGNoIGdy\nb3VwIG1ldGFkYXRhLg0KICovDQpwdWJsaWMgY2xhc3MgRmV0Y2hHcm91cCAN\nCiAgICBpbXBsZW1lbnRzIFNlcmlhbGl6YWJsZSB7DQoNCiAgICAvKioNCiAg\nICAgKiBOYW1lIG9mIHRoZSBkZWZhdWx0IGZldGNoIGdyb3VwLg0KICAgICAq\nLw0KICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgU3RyaW5nIE5BTUVfREVGQVVM\nVCA9ICJkZWZhdWx0IjsNCg0KICAgIC8qKg0KICAgICAqIE5hbWUgb2YgdGhl\nICJhbGwiIGZldGNoIGdyb3VwLg0KICAgICAqLw0KICAgIHB1YmxpYyBzdGF0\naWMgZmluYWwgU3RyaW5nIE5BTUVfQUxMID0gImFsbCI7DQoNCiAgICAvKioN\nCiAgICAgKiBEZWZhdWx0IGZpZWxkIHJlY3Vyc2lvbiBkZXB0aC4NCiAgICAg\nKi8NCiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIGludCBSRUNVUlNJT05fREVQ\nVEhfREVGQVVMVCA9IDE7DQoNCiAgICAvKioNCiAgICAgKiBJbmZpbml0ZSBk\nZXB0aC4NCiAgICAgKi8NCglwdWJsaWMgc3RhdGljIGZpbmFsIGludCBERVBU\nSF9JTkZJTklURSA9IC0xOw0KDQogICAgLyoqDQogICAgICogIFN0YW5kYXJk\nIGRlZmF1bHQgZmV0Y2ggZ3JvdXAuDQogICAgICovDQogICAgc3RhdGljIGZp\nbmFsIEZldGNoR3JvdXAgREVGQVVMVCA9IG5ldyBGZXRjaEdyb3VwKE5BTUVf\nREVGQVVMVCwgdHJ1ZSk7DQoNCiAgICAvKioNCiAgICAgKiAgU3RhbmRhcmQg\nImFsbCIgZmV0Y2ggZ3JvdXAuDQogICAgICovDQogICAgc3RhdGljIGZpbmFs\nIEZldGNoR3JvdXAgQUxMID0gbmV3IEZldGNoR3JvdXAoTkFNRV9BTEwsIGZh\nbHNlKTsNCg0KICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIExvY2FsaXplciBf\nbG9jID0gTG9jYWxpemVyLmZvclBhY2thZ2UNCiAgICAgICAgKEZldGNoR3Jv\ndXAuY2xhc3MpOw0KDQogICAgcHJpdmF0ZSBmaW5hbCBTdHJpbmcgX25hbWU7\nDQogICAgcHJpdmF0ZSBmaW5hbCBDbGFzc01ldGFEYXRhIF9tZXRhOw0KICAg\nIHByaXZhdGUgZmluYWwgYm9vbGVhbiBfcmVhZE9ubHk7DQogICAgcHJpdmF0\nZSBMaXN0IF9pbmNsdWRlczsNCiAgICBwcml2YXRlIFNldCAgX2NvbnRhaW5l\nZEJ5Ow0KICAgIHByaXZhdGUgTWFwIF9kZXB0aHM7DQogICAgcHJpdmF0ZSBC\nb29sZWFuIF9wb3N0TG9hZDsNCg0KICAgIC8qKg0KICAgICAqIENvbnN0cnVj\ndG9yOyBzdXBwbHkgaW1tdXRhYmxlIG5hbWUuDQogICAgICoNCiAgICAgKiBA\ncGFyYW0gbmFtZSBtdXN0IG5vdCBieSBudWxsIG9yIGVtcHR5Lg0KICAgICAq\nLw0KICAgIEZldGNoR3JvdXAoQ2xhc3NNZXRhRGF0YSBjbSwgU3RyaW5nIG5h\nbWUpIHsNCiAgICAgICAgX21ldGEgPSBjbTsNCiAgICAgICAgX25hbWUgPSBu\nYW1lOw0KICAgICAgICBfcmVhZE9ubHkgPSBmYWxzZTsNCiAgICB9DQoNCiAg\nICAvKioNCiAgICAgKiBJbnRlcm5hbCBjb25zdHJ1Y3RvciBmb3IgYnVpbHRp\nbiBmZXRjaCBncm91cHMuDQogICAgICovDQogICAgcHJpdmF0ZSBGZXRjaEdy\nb3VwKFN0cmluZyBuYW1lLCBib29sZWFuIHBvc3RMb2FkKSB7DQogICAgICAg\nIF9tZXRhID0gbnVsbDsNCiAgICAgICAgX25hbWUgPSBuYW1lOw0KICAgICAg\nICBfcG9zdExvYWQgPSAocG9zdExvYWQpID8gQm9vbGVhbi5UUlVFIDogQm9v\nbGVhbi5GQUxTRTsNCiAgICAgICAgX3JlYWRPbmx5ID0gdHJ1ZTsNCiAgICB9\nDQoNCiAgICAvKioNCiAgICAgKiBDb3B5IHN0YXRlIGZyb20gdGhlIGdpdmVu\nIGZldGNoIGdyb3VwLg0KICAgICAqLw0KICAgIHZvaWQgY29weShGZXRjaEdy\nb3VwIGZnKSB7DQogICAgICAgIGlmIChmZy5faW5jbHVkZXMgIT0gbnVsbCkN\nCiAgICAgICAgICAgIGZvciAoSXRlcmF0b3IgaXRyID0gZmcuX2luY2x1ZGVz\nLml0ZXJhdG9yKCk7IGl0ci5oYXNOZXh0KCk7KQ0KICAgICAgICAgICAgICAg\nIGFkZERlY2xhcmVkSW5jbHVkZSgoU3RyaW5nKSBpdHIubmV4dCgpKTsNCiAg\nICAgICAgaWYgKGZnLl9jb250YWluZWRCeSAhPSBudWxsKSANCiAgICAgICAg\nCXRoaXMuX2NvbnRhaW5lZEJ5ID0gbmV3IEhhc2hTZXQoZmcuX2NvbnRhaW5l\nZEJ5KTsNCiAgICAgICAgDQogICAgICAgIGlmIChmZy5fZGVwdGhzICE9IG51\nbGwpIHsNCiAgICAgICAgICAgIE1hcC5FbnRyeSBlbnRyeTsNCiAgICAgICAg\nICAgIGZvciAoSXRlcmF0b3IgaXRyID0gZmcuX2RlcHRocy5lbnRyeVNldCgp\nLml0ZXJhdG9yKCk7IA0KICAgICAgICAgICAgICAgIGl0ci5oYXNOZXh0KCk7\nKSB7DQogICAgICAgICAgICAgICAgZW50cnkgPSAoTWFwLkVudHJ5KSBpdHIu\nbmV4dCgpOw0KICAgICAgICAgICAgICAgIHNldFJlY3Vyc2lvbkRlcHRoKChG\naWVsZE1ldGFEYXRhKSBlbnRyeS5nZXRLZXkoKSwgKChOdW1iZXIpIA0KICAg\nICAgICAgICAgICAgICAgICBlbnRyeS5nZXRWYWx1ZSgpKS5pbnRWYWx1ZSgp\nKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICBpZiAoZmcu\nX3Bvc3RMb2FkICE9IG51bGwpDQogICAgICAgICAgICBfcG9zdExvYWQgPSBm\nZy5fcG9zdExvYWQ7DQogICAgfQ0KDQogICAgLyoqDQogICAgICogRmV0Y2gg\nZ3JvdXAgbmFtZS4NCiAgICAgKi8NCiAgICBwdWJsaWMgU3RyaW5nIGdldE5h\nbWUoKSB7DQogICAgICAgIHJldHVybiBfbmFtZTsNCiAgICB9DQoNCiAgICAv\nKioNCiAgICAgKiBJbmNsdWRlcyBnaXZlbiBmZXRjaCBncm91cCB3aXRoaW4g\ndGhpcyByZWNlaXZlci4NCiAgICAgKi8NCiAgICBwdWJsaWMgdm9pZCBhZGRE\nZWNsYXJlZEluY2x1ZGUoU3RyaW5nIGZnTmFtZSkgew0KICAgICAgICBpZiAo\nX3JlYWRPbmx5KQ0KICAgICAgICAgICAgdGhyb3cgbmV3IFVuc3VwcG9ydGVk\nT3BlcmF0aW9uRXhjZXB0aW9uKCk7DQogICAgICAgIGlmIChTdHJpbmdVdGls\ncy5pc0VtcHR5KGZnTmFtZSkpDQogICAgICAgICAgICB0aHJvdyBuZXcgTWV0\nYURhdGFFeGNlcHRpb24oX2xvYy5nZXQoIm51bGwtaW5jbHVkZS1mZyIsIHRo\naXMpKTsNCiAgICAgICAgaWYgKF9pbmNsdWRlcyA9PSBudWxsKQ0KICAgICAg\nICAgICAgX2luY2x1ZGVzID0gbmV3IEFycmF5TGlzdCgpOw0KICAgICAgICBp\nZiAoIV9pbmNsdWRlcy5jb250YWlucyhmZ05hbWUpKQ0KICAgICAgICAgICAg\nX2luY2x1ZGVzLmFkZChmZ05hbWUpOw0KICAgIH0NCg0KICAgIC8qKg0KICAg\nICAqIEFmZmlybXMgaWYgZ2l2ZW4gZmV0Y2ggZ3JvdXAgaXMgaW5jbHVkZWQg\nYnkgdGhpcyByZWNlaXZlci4gIEluY2x1ZGVzDQogICAgICogc3VwZXJjbGFz\ncyBkZWZpbml0aW9uIG9mIGZldGNoIGdyb3VwIGFuZCBvcHRpb25hbGx5IG90\naGVyIGluY2x1ZGVkIA0KICAgICAqIGdyb3Vwcy4NCiAgICAgKg0KICAgICAq\nIEBwYXJhbSByZWN1cnNlIGlmIHRydWUgdGhlbiByZWN1cnNpdmVseSBjaGVj\na3Mgd2l0aGluIHRoZSBpbmNsdWRlZA0KICAgICAqIGZlY3RoIGdyb3Vwcw0K\nICAgICAqLw0KICAgIHB1YmxpYyBib29sZWFuIGluY2x1ZGVzKFN0cmluZyBm\nZ05hbWUsIGJvb2xlYW4gcmVjdXJzZSkgew0KICAgICAgICAvLyBjaGVjayBv\ndXIgaW5jbHVkZXMNCiAgICAgICAgaWYgKF9pbmNsdWRlcyAhPSBudWxsKSB7\nDQogICAgICAgICAgICBpZiAoX2luY2x1ZGVzLmNvbnRhaW5zKGZnTmFtZSkp\nDQogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICBp\nZiAocmVjdXJzZSAmJiBfbWV0YSE9bnVsbCkgew0KICAgICAgICAgICAgICAg\nIEZldGNoR3JvdXAgZmc7DQogICAgICAgICAgICAgICAgZm9yIChJdGVyYXRv\nciBpID0gX2luY2x1ZGVzLml0ZXJhdG9yKCk7IGkuaGFzTmV4dCgpOykgew0K\nICAgICAgICAgICAgICAgICAgICBmZyA9IF9tZXRhLmdldEZldGNoR3JvdXAo\nKFN0cmluZykgaS5uZXh0KCkpOw0KICAgICAgICAgICAgICAgICAgICBpZiAo\nZmcgIT0gbnVsbCAmJiBmZy5pbmNsdWRlcyhmZ05hbWUsIHRydWUpKQ0KICAg\nICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAg\nICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIGlm\nIChfbWV0YSAhPSBudWxsKSB7DQogICAgICAgICAgICAvLyBjaGVjayBzdXBl\ncmNsYXNzIGluY2x1ZGVzDQogICAgICAgICAgICBDbGFzc01ldGFEYXRhIHN1\ncCA9IF9tZXRhLmdldFBDU3VwZXJjbGFzc01ldGFEYXRhKCk7DQogICAgICAg\nICAgICBpZiAoc3VwICE9IG51bGwpIHsNCiAgICAgICAgICAgICAgICBGZXRj\naEdyb3VwIHN1cEZHID0gc3VwLmdldEZldGNoR3JvdXAoX25hbWUpOw0KICAg\nICAgICAgICAgICAgIGlmIChzdXBGRyAhPSBudWxsKQ0KICAgICAgICAgICAg\nICAgICAgICByZXR1cm4gc3VwRkcuaW5jbHVkZXMoZmdOYW1lLCByZWN1cnNl\nKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICByZXR1cm4g\nZmFsc2U7DQogICAgfQ0KICAgIA0KICAgIC8qKg0KICAgICAqIEFkZHMgdGhp\ncyByZWNlaXZlciBhcyBvbmUgb2YgdGhlIGluY2x1ZGVkIGZldGNoIGdyb3Vw\ncyBvZiB0aGUgZ2l2ZW4NCiAgICAgKiBwYXJlbnQuIA0KICAgICAqIFRoZSBw\nYXJlbnQgZmVjdGggZ3JvdXAgd2lsbCBpbmNsdWRlIHRoaXMgcmVjZWl2ZXIg\nYXMgYSBzaWRlLWVmZmVjdCBvZg0KICAgICAqIHRoaXMgY2FsbC4NCiAgICAg\nKiANCiAgICAgKiBAc2VlICNpbmNsdWRlcyhTdHJpbmcsIGJvb2xlYW4pDQog\nICAgICogQHNlZSAjYWRkRGVjbGFyZWRJbmNsdWRlKFN0cmluZykgDQogICAg\nICogDQogICAgICogQHJldHVybiB0cnVlIGlmIGdpdmVuIHBhcmVudCBpcyBh\nIG5ldyBhZGRpdGlvbi4gZmFsc2Ugb3Rocndpc2UuDQogICAgICogQHNpbmNl\nIDEuMS4xICAgDQogICAgICovDQogICAgcHVibGljIGJvb2xlYW4gYWRkQ29u\ndGFpbmVkQnkoRmV0Y2hHcm91cCBwYXJlbnQpIHsNCiAgICAJcGFyZW50LmFk\nZERlY2xhcmVkSW5jbHVkZSh0aGlzLmdldE5hbWUoKSk7DQogICAgCWlmIChf\nY29udGFpbmVkQnk9PW51bGwpDQogICAgCQlfY29udGFpbmVkQnkgPSBuZXcg\nSGFzaFNldCgpOw0KICAgIAlyZXR1cm4gX2NvbnRhaW5lZEJ5LmFkZChwYXJl\nbnQuZ2V0TmFtZSgpKTsNCiAgICB9DQogICAgDQogICAgLyoqDQogICAgICog\nR2V0cyB0aGUgbmFtZSBvZiB0aGUgZmV0Y2ggZ3JvdXBzIGluIHdoaWNoIHRo\naXMgcmVjZWl2ZXIgaGFzIGJlZW4NCiAgICAgKiBpbmNsdWRlZC4NCiAgICAg\nKiANCiAgICAgKiBAc2VlICNhZGRDb250YWluZWRCeShGZXRjaEdyb3VwKQ0K\nICAgICAqIEBzaW5jZSAxLjEuMSAgIA0KICAgICAqLw0KICAgIHB1YmxpYyBT\nZXQgZ2V0Q29udGFpbmVkQnkoKSB7DQogICAgCXJldHVybiAoX2NvbnRhaW5l\nZEJ5ID09IG51bGwpID8gQ29sbGVjdGlvbnMuRU1QVFlfU0VUIDoNCiAgICAg\nICAgICAgIENvbGxlY3Rpb25zLnVubW9kaWZpYWJsZVNldChfY29udGFpbmVk\nQnkpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIFJldHVybiB0aGUgZmV0\nY2ggZ3JvdXAgbmFtZXMgZGVjbGFyZWQgaW5jbHVkZWQgYnkgdGhpcyBncm91\ncC4NCiAgICAgKi8NCiAgICBwdWJsaWMgU3RyaW5nW10gZ2V0RGVjbGFyZWRJ\nbmNsdWRlcygpIHsNCiAgICAgICAgLy8gb25seSB1c2VkIGR1cmluZyBzZXJp\nYWxpemF0aW9uOyBubyBuZWVkIHRvIGNhY2hlDQogICAgICAgIHJldHVybiAo\nX2luY2x1ZGVzID09IG51bGwpID8gbmV3IFN0cmluZ1swXQ0KICAgICAgICAg\nICAgOiAoU3RyaW5nW10pIF9pbmNsdWRlcy50b0FycmF5KG5ldyBTdHJpbmdb\nX2luY2x1ZGVzLnNpemUoKV0pOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAq\nIFJlY3Vyc2lvbiBkZXB0aCBmb3IgdGhlIGdpdmVuIGZpZWxkLiAgVGhpcyBp\ncyB0aGUgZGVwdGggb2YgcmVsYXRpb25zIG9mDQogICAgICogdGhlIHNhbWUg\nY2xhc3MgYXMgdGhpcyBvbmUgd2UgY2FuIGZldGNoIHRocm91Z2ggdGhlIGdp\ndmVuIGZpZWxkLg0KICAgICAqLw0KICAgIHB1YmxpYyB2b2lkIHNldFJlY3Vy\nc2lvbkRlcHRoKEZpZWxkTWV0YURhdGEgZm0sIGludCBkZXB0aCkgew0KICAg\nICAgICBpZiAoX3JlYWRPbmx5KQ0KICAgICAgICAgICAgdGhyb3cgbmV3IFVu\nc3VwcG9ydGVkT3BlcmF0aW9uRXhjZXB0aW9uKCk7DQogICAgICAgIGlmIChk\nZXB0aCA8IC0xKQ0KICAgICAgICAgICAgdGhyb3cgbmV3IE1ldGFEYXRhRXhj\nZXB0aW9uKF9sb2MuZ2V0KCJpbnZhbGlkLWZnLWRlcHRoIiwgX25hbWUsIGZt\nLCANCiAgICAgICAgICAgICAgICBOdW1iZXJzLnZhbHVlT2YoZGVwdGgpKSk7\nDQogICAgICAgIGlmIChfZGVwdGhzID09IG51bGwpDQogICAgICAgICAgICBf\nZGVwdGhzID0gbmV3IEhhc2hNYXAoKTsNCiAgICAgICAgX2RlcHRocy5wdXQo\nZm0sIE51bWJlcnMudmFsdWVPZihkZXB0aCkpOw0KICAgIH0NCg0KICAgIC8q\nKg0KICAgICAqIFJlY3Vyc2lvbiBkZXB0aCBmb3IgdGhlIGdpdmVuIGZpZWxk\nLiAgVGhpcyBpcyB0aGUgZGVwdGggb2YgcmVsYXRpb25zIG9mDQogICAgICog\ndGhlIHNhbWUgY2xhc3MgYXMgdGhpcyBvbmUgd2UgY2FuIGZldGNoIHRocm91\nZ2ggdGhlIGdpdmVuIGZpZWxkLg0KICAgICAqLw0KICAgIHB1YmxpYyBpbnQg\nZ2V0UmVjdXJzaW9uRGVwdGgoRmllbGRNZXRhRGF0YSBmbSkgew0KICAgICAg\nICBOdW1iZXIgZGVwdGggPSBmaW5kUmVjdXJzaW9uRGVwdGgoZm0pOw0KICAg\nICAgICByZXR1cm4gKGRlcHRoID09IG51bGwpID8gUkVDVVJTSU9OX0RFUFRI\nX0RFRkFVTFQgOiBkZXB0aC5pbnRWYWx1ZSgpOw0KICAgIH0NCg0KICAgIC8q\nKg0KICAgICAqIFJldHVybiB0aGUgcmVjdXJzaW9uIGRlcHRoIGRlY2xhcmVk\nIGZvciB0aGUgZ2l2ZW4gZmllbGQsIG9yIA0KICAgICAqIDAgaWYgbm9uZS4N\nCiAgICAgKi8NCiAgICBwdWJsaWMgaW50IGdldERlY2xhcmVkUmVjdXJzaW9u\nRGVwdGgoRmllbGRNZXRhRGF0YSBmbSkgew0KICAgICAgICBOdW1iZXIgZGVw\ndGggPSAoX2RlcHRocyA9PSBudWxsKSA/IG51bGwgOiAoTnVtYmVyKSBfZGVw\ndGhzLmdldChmbSk7DQogICAgICAgIHJldHVybiAoZGVwdGggPT0gbnVsbCkg\nPyAwIDogZGVwdGguaW50VmFsdWUoKTsNCiAgICB9DQoNCiAgICAvKioNCiAg\nICAgKiBIZWxwZXIgdG8gZmluZCByZWN1cnNpb24gZGVwdGggcmVjdXJzaXZl\nbHkgaW4gb3VyIGluY2x1ZGVzLg0KICAgICAqLw0KICAgIHByaXZhdGUgTnVt\nYmVyIGZpbmRSZWN1cnNpb25EZXB0aChGaWVsZE1ldGFEYXRhIGZtKSB7IA0K\nICAgICAgICBOdW1iZXIgZGVwdGggPSAoX2RlcHRocyA9PSBudWxsKSA/IG51\nbGwgOiAoTnVtYmVyKSBfZGVwdGhzLmdldChmbSk7DQogICAgICAgIGlmIChk\nZXB0aCAhPSBudWxsKQ0KICAgICAgICAgICAgcmV0dXJuIGRlcHRoOw0KDQog\nICAgICAgIC8vIGNoZWNrIGZvciBzdXBlcmNsYXNzIGRlY2xhcmF0aW9uIG9m\nIGRlcHRoDQogICAgICAgIE51bWJlciBtYXggPSBudWxsOw0KICAgICAgICBp\nZiAoX21ldGEgIT0gbnVsbCAmJiBmbS5nZXREZWNsYXJpbmdNZXRhRGF0YSgp\nICE9IF9tZXRhKSB7DQogICAgICAgICAgICBDbGFzc01ldGFEYXRhIHN1cCA9\nIF9tZXRhLmdldFBDU3VwZXJjbGFzc01ldGFEYXRhKCk7DQogICAgICAgICAg\nICBpZiAoc3VwICE9IG51bGwpIHsNCiAgICAgICAgICAgICAgICBGZXRjaEdy\nb3VwIHN1cEZHID0gc3VwLmdldEZldGNoR3JvdXAoX25hbWUpOw0KICAgICAg\nICAgICAgICAgIGlmIChzdXBGRyAhPSBudWxsKQ0KICAgICAgICAgICAgICAg\nICAgICBtYXggPSBzdXBGRy5maW5kUmVjdXJzaW9uRGVwdGgoZm0pOw0KICAg\nICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIGlmIChfaW5jbHVkZXMg\nPT0gbnVsbCkNCiAgICAgICAgICAgIHJldHVybiBtYXg7DQoNCiAgICAgICAg\nLy8gZmluZCBsYXJnZXN0IGluY2x1ZGVkIGRlcHRoDQogICAgICAgIEZldGNo\nR3JvdXAgZmc7DQogICAgICAgIGZvciAoSXRlcmF0b3IgaXRyID0gX2luY2x1\nZGVzLml0ZXJhdG9yKCk7IGl0ci5oYXNOZXh0KCk7KSB7DQogICAgICAgICAg\nICBmZyA9IF9tZXRhLmdldEZldGNoR3JvdXAoKFN0cmluZykgaXRyLm5leHQo\nKSk7DQogICAgICAgICAgICBkZXB0aCA9IChmZyA9PSBudWxsKSA/IG51bGwg\nOiBmZy5maW5kUmVjdXJzaW9uRGVwdGgoZm0pOw0KICAgICAgICAgICAgaWYg\nKGRlcHRoICE9IG51bGwgJiYgKG1heCA9PSBudWxsIA0KICAgICAgICAgICAg\nICAgIHx8IGRlcHRoLmludFZhbHVlKCkgPiBtYXguaW50VmFsdWUoKSkpDQog\nICAgICAgICAgICAgICAgbWF4ID0gZGVwdGg7DQogICAgICAgIH0NCiAgICAg\nICAgcmV0dXJuIG1heDsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiBSZXR1\ncm4gdGhlIGZpZWxkcyB3aXRoIGRlY2xhcmVkIHJlY3Vyc2lvbiBkZXB0aHMg\naW4gdGhpcyBncm91cC4NCiAgICAgKi8NCiAgICBwdWJsaWMgRmllbGRNZXRh\nRGF0YVtdIGdldERlY2xhcmVkUmVjdXJzaW9uRGVwdGhGaWVsZHMoKSB7DQog\nICAgICAgIC8vIHVzZWQgaW4gc2VyaWFsaXphdGlvbiBvbmx5OyBubyBuZWVk\nIHRvIGNhY2hlDQogICAgICAgIGlmIChfZGVwdGhzID09IG51bGwpDQogICAg\nICAgICAgICByZXR1cm4gbmV3IEZpZWxkTWV0YURhdGFbMF07DQogICAgICAg\nICByZXR1cm4gKEZpZWxkTWV0YURhdGFbXSkgX2RlcHRocy5rZXlTZXQoKS50\nb0FycmF5DQogICAgICAgICAgICAobmV3IEZpZWxkTWV0YURhdGFbX2RlcHRo\ncy5zaXplKCldKTsNCiAgICB9IA0KDQogICAgLyoqDQogICAgICogV2hldGhl\nciBsb2FkaW5nIHRoaXMgZmV0Y2ggZ3JvdXAgY2F1c2VzIGEgcG9zdC1sb2Fk\nIGNhbGxiYWNrIG9uIHRoZQ0KICAgICAqIGxvYWRlZCBpbnN0YW5jZS4NCiAg\nICAgKi8NCiAgICBwdWJsaWMgdm9pZCBzZXRQb3N0TG9hZCAoYm9vbGVhbiBm\nbGFnKSB7DQogICAgICAgIGlmIChfcmVhZE9ubHkgJiYgZmxhZyAhPSBpc1Bv\nc3RMb2FkKCkpDQogICAgICAgICAgICB0aHJvdyBuZXcgVW5zdXBwb3J0ZWRP\ncGVyYXRpb25FeGNlcHRpb24oKTsNCiAgICAJX3Bvc3RMb2FkID0gKGZsYWcp\nID8gQm9vbGVhbi5UUlVFIDogQm9vbGVhbi5GQUxTRTsNCiAgICB9DQoNCiAg\nICAvKioNCiAgICAgKiBXaGV0aGVyIGxvYWRpbmcgdGhpcyBmZXRjaCBncm91\ncCBjYXVzZXMgYSBwb3N0LWxvYWQgY2FsbGJhY2sgb24gdGhlDQogICAgICog\nbG9hZGVkIGluc3RhbmNlLg0KICAgICAqLw0KICAgIHB1YmxpYyBib29sZWFu\nIGlzUG9zdExvYWQgKCkgew0KICAgIAlpZiAoX3Bvc3RMb2FkICE9IG51bGwp\nDQogICAgICAgICAgICByZXR1cm4gX3Bvc3RMb2FkLmJvb2xlYW5WYWx1ZSgp\nOw0KDQogICAgICAgIGlmIChfbWV0YSAhPSBudWxsKSB7DQogICAgICAgICAg\nICBDbGFzc01ldGFEYXRhIHN1cCA9IF9tZXRhLmdldFBDU3VwZXJjbGFzc01l\ndGFEYXRhKCk7DQogICAgICAgICAgICBpZiAoc3VwICE9IG51bGwpIHsNCiAg\nICAgICAgICAgICAgICBGZXRjaEdyb3VwIHN1cEZHID0gc3VwLmdldEZldGNo\nR3JvdXAoX25hbWUpOw0KICAgICAgICAgICAgICAgIGlmIChzdXBGRyAhPSBu\ndWxsICYmIHN1cEZHLmlzUG9zdExvYWQoKSkNCiAgICAgICAgICAgICAgICAg\nICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0K\nICAgICAgICBpZiAoX2luY2x1ZGVzID09IG51bGwpDQogICAgICAgICAgICBy\nZXR1cm4gZmFsc2U7DQogICAgICAgIEZldGNoR3JvdXAgZmc7DQogICAgICAg\nIGZvciAoSXRlcmF0b3IgaXRyID0gX2luY2x1ZGVzLml0ZXJhdG9yKCk7IGl0\nci5oYXNOZXh0KCk7KSB7DQogICAgICAgICAgICBmZyA9IF9tZXRhLmdldEZl\ndGNoR3JvdXAoKFN0cmluZykgaXRyLm5leHQoKSk7DQogICAgICAgICAgICBp\nZiAoZmcgIT0gbnVsbCAmJiBmZy5pc1Bvc3RMb2FkKCkpDQogICAgICAgICAg\nICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgIH0NCiAgICAgICAgcmV0dXJu\nIGZhbHNlOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIFdoZXRoZXIgdGhl\nIHBvc3QtbG9hZCB2YWx1ZSBpcyBkZWNsYXJlZCBmb3IgdGhpcyBncm91cC4g\nIA0KICAgICAqLw0KICAgIHB1YmxpYyBib29sZWFuIGlzUG9zdExvYWRFeHBs\naWNpdCgpIHsNCiAgICAgICAgcmV0dXJuIF9wb3N0TG9hZCAhPSBudWxsOw0K\nICAgIH0NCg0KICAgIC8qKg0KICAgICAqIFJlc29sdmUgYW5kIHZhbGlkYXRl\nIGZldGNoIGdyb3VwIG1ldGFkYXRhLg0KICAgICAqLw0KICAgIHB1YmxpYyB2\nb2lkIHJlc29sdmUoKSB7DQogICAgICAgIGlmIChfaW5jbHVkZXMgPT0gbnVs\nbCkNCiAgICAgICAgICAgIHJldHVybjsNCg0KICAgICAgICAvLyB2YWxpZGF0\nZSBpbmNsdWRlcw0KICAgICAgICBTdHJpbmcgbmFtZTsNCiAgICAgICAgRmV0\nY2hHcm91cCBmZzsNCiAgICAgICAgZm9yIChJdGVyYXRvciBpdHIgPSBfaW5j\nbHVkZXMuaXRlcmF0b3IoKTsgaXRyLmhhc05leHQoKTspIHsNCiAgICAgICAg\nICAgIG5hbWUgPSAoU3RyaW5nKSBpdHIubmV4dCgpOw0KICAgICAgICAgICAg\naWYgKG5hbWUuZXF1YWxzKF9uYW1lKSkNCiAgICAgICAgICAgICAgICB0aHJv\ndyBuZXcgTWV0YURhdGFFeGNlcHRpb24oX2xvYy5nZXQoImN5Y2xpYy1mZyIs\nIHRoaXMsIG5hbWUpKTsNCiAgICAgICAgICAgIGZnID0gX21ldGEuZ2V0RmV0\nY2hHcm91cChuYW1lKTsNCiAgICAgICAgICAgIGlmIChmZyA9PSBudWxsKQ0K\nICAgICAgICAgICAgICAgIHRocm93IG5ldyBNZXRhRGF0YUV4Y2VwdGlvbihf\nbG9jLmdldCgiYmFkLWZnLWluY2x1ZGUiLCB0aGlzLA0KICAgICAgICAgICAg\nICAgICAgICBuYW1lKSk7DQogICAgICAgICAgICBpZiAoZmcuaW5jbHVkZXMo\nX25hbWUsIHRydWUpKQ0KICAgICAgICAgICAgICAgIHRocm93IG5ldyBNZXRh\nRGF0YUV4Y2VwdGlvbihfbG9jLmdldCgiY3ljbGljLWZnIiwgdGhpcywgbmFt\nZSkpOw0KICAgICAgICB9DQogICAgfQ0KICAgIA0KICAgIC8qKg0KICAgICAq\nIEFmZmlybXMgZXF1YWxpdHkgaWYgdGhlIG90aGVyIGhhcyB0aGUgc2FtZSBu\nYW1lIGFuZCBkZWNsYXJpbmcgdHlwZS4NCiAgICAgKi8NCiAgICBwdWJsaWMg\nYm9vbGVhbiBlcXVhbHMoT2JqZWN0IG90aGVyKSB7DQogICAgICAgIGlmIChv\ndGhlciA9PSB0aGlzKQ0KICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAg\nICAgIGlmICghKG90aGVyIGluc3RhbmNlb2YgRmV0Y2hHcm91cCkpDQogICAg\nICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgIEZldGNoR3JvdXAgdGhh\ndCA9IChGZXRjaEdyb3VwKSBvdGhlcjsNCiAgICAgICAgcmV0dXJuIF9uYW1l\nLmVxdWFscyh0aGF0Ll9uYW1lKQ0KICAgICAgICAgICAgJiYgT2JqZWN0VXRp\nbHMuZXF1YWxzKF9tZXRhLCB0aGF0Ll9tZXRhKTsNCiAgICB9DQoNCiAgICBw\ndWJsaWMgaW50IGhhc2hDb2RlKCkgew0KICAgICAgICByZXR1cm4gX25hbWUu\naGFzaENvZGUoKSArICgoX21ldGEgPT0gbnVsbCkgPyAwIDogX21ldGEuaGFz\naENvZGUoKSk7DQogICAgfQ0KDQogICAgcHVibGljIFN0cmluZyB0b1N0cmlu\nZygpIHsNCiAgICAgICAgcmV0dXJuICgoX21ldGEgPT0gbnVsbCkgPyAiQnVp\nbHRpbiIgOiBfbWV0YS50b1N0cmluZyAoKSkgKyAiLiIgKyBfbmFtZTsNCiAg\nICB9DQp9DQo=\n","encoding":"base64"}

