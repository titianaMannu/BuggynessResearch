{"sha":"fa76f87bea5bec925be8ae667cfe484d765fb8f1","node_id":"MDQ6QmxvYjIwNjM2NDpmYTc2Zjg3YmVhNWJlYzkyNWJlOGFlNjY3Y2ZlNDg0ZDc2NWZiOGYx","size":6594,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/fa76f87bea5bec925be8ae667cfe484d765fb8f1","content":"LyoNCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUNCiAqIG9yIG1vcmUgY29udHJpYnV0b3Ig\nbGljZW5zZSBhZ3JlZW1lbnRzLiAgU2VlIHRoZSBOT1RJQ0UgZmlsZQ0KICog\nZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5m\nb3JtYXRpb24NCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAg\nVGhlIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUNCiAqIHRvIHlvdSB1bmRlciB0\naGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUNCiAqICJMaWNl\nbnNlIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNv\nbXBsaWFuY2UNCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFp\nbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQNCiAqDQogKiBodHRwOi8vd3d3\nLmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjANCiAqDQogKiBVbmxl\nc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGlu\nIHdyaXRpbmcsDQogKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUg\nTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbg0KICogIkFTIElTIiBCQVNJ\nUywgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZDQog\nKiBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBM\naWNlbnNlIGZvciB0aGUNCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmlu\nZyBwZXJtaXNzaW9ucyBhbmQgbGltaXRhdGlvbnMNCiAqIHVuZGVyIHRoZSBM\naWNlbnNlLg0KICovDQpwYWNrYWdlIG9yZy5hcGFjaGUub3BlbmpwYS5lbmhh\nbmNlOw0KDQppbXBvcnQgamF2YS5sYW5nLmluc3RydW1lbnQuSW5zdHJ1bWVu\ndGF0aW9uOw0KaW1wb3J0IGphdmEubGFuZy5pbnN0cnVtZW50LkNsYXNzRmls\nZVRyYW5zZm9ybWVyOw0KaW1wb3J0IGphdmEubGFuZy5pbnN0cnVtZW50LkNs\nYXNzRGVmaW5pdGlvbjsNCmltcG9ydCBqYXZhLmxhbmcuaW5zdHJ1bWVudC5V\nbm1vZGlmaWFibGVDbGFzc0V4Y2VwdGlvbjsNCmltcG9ydCBqYXZhLmxhbmcu\ncmVmbGVjdC5JbnZvY2F0aW9uVGFyZ2V0RXhjZXB0aW9uOw0KaW1wb3J0IGph\ndmEubGFuZy5yZWZsZWN0Lk1ldGhvZDsNCmltcG9ydCBqYXZhLnNlY3VyaXR5\nLlByb3RlY3Rpb25Eb21haW47DQppbXBvcnQgamF2YS51dGlsLk1hcDsNCmlt\ncG9ydCBqYXZhLnV0aWwuQ29sbGVjdGlvbjsNCmltcG9ydCBqYXZhLnV0aWwu\nQ29sbGVjdGlvbnM7DQppbXBvcnQgamF2YS51dGlsLkFycmF5TGlzdDsNCmlt\ncG9ydCBqYXZhLmlvLklPRXhjZXB0aW9uOw0KDQppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLmNvbmYuT3BlbkpQQUNvbmZpZ3VyYXRpb247DQppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51dGlsLkphdmFWZXJzaW9uczsNCmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuTG9jYWxpemVyOw0K\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIubG9nLkxvZzsNCmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5JbnRlcm5hbEV4Y2VwdGlvbjsN\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5Vc2VyRXhjZXB0aW9u\nOw0KDQovKioNCiAqIFJlZGVmaW5lcyB0aGUgbWV0aG9kIGJvZGllcyBvZiBl\neGlzdGluZyBjbGFzc2VzLiBTdXBwb3J0cyBKYXZhIDUgVk1zIHRoYXQNCiAq\nIGhhdmUgYSBqYXZhYWdlbnQgaW5zdGFsbGVkIG9uIHRoZSBjb21tYW5kIGxp\nbmUgYXMgd2VsbCBhcyBuZXdlciBWTXMgd2l0aG91dA0KICogYW55IGphdmFh\nZ2VudCBmbGFnLg0KICoNCiAqIEBzaW5jZSAxLjAuMA0KICovDQpwdWJsaWMg\nY2xhc3MgQ2xhc3NSZWRlZmluZXIgew0KDQogICAgcHJpdmF0ZSBzdGF0aWMg\nZmluYWwgTG9jYWxpemVyIF9sb2MgPSANCiAgICAgICAgTG9jYWxpemVyLmZv\nclBhY2thZ2UoQ2xhc3NSZWRlZmluZXIuY2xhc3MpOw0KDQogICAgcHJpdmF0\nZSBzdGF0aWMgQm9vbGVhbiBfY2FuUmVkZWZpbmUgPSBudWxsOw0KDQogICAg\nLyoqDQogICAgICogRm9yIGVhY2ggZWxlbWVudCBpbiA8Y29kZT5jbGFzc2Vz\nPC9jb2RlPiwgdGhpcyBtZXRob2Qgd2lsbCByZWRlZmluZQ0KICAgICAqIGFs\nbCB0aGUgZWxlbWVudCdzIG1ldGhvZHMgc3VjaCB0aGF0IGZpZWxkIGFjY2Vz\nc2VzIGFyZSBpbnRlcmNlcHRlZA0KICAgICAqIGluLWxpbmUuIElmIHtAbGlu\nayAjY2FuUmVkZWZpbmVDbGFzc2VzKCl9IHJldHVybnMgPGNvZGU+ZmFsc2U8\nL2NvZGU+LA0KICAgICAqIHRoaXMgbWV0aG9kIGlzIGEgbm8tb3AuDQogICAg\nICovDQogICAgcHVibGljIHN0YXRpYyB2b2lkIHJlZGVmaW5lQ2xhc3NlcyhP\ncGVuSlBBQ29uZmlndXJhdGlvbiBjb25mLA0KICAgICAgICBmaW5hbCBNYXA8\nQ2xhc3MsYnl0ZVtdPiBjbGFzc2VzKSB7DQogICAgICAgIGlmIChjbGFzc2Vz\nID09IG51bGwgfHwgY2xhc3Nlcy5zaXplKCkgPT0gMCB8fCAhY2FuUmVkZWZp\nbmVDbGFzc2VzKCkpDQogICAgICAgICAgICByZXR1cm47DQoNCiAgICAgICAg\nTG9nIGxvZyA9IGNvbmYuZ2V0TG9nKE9wZW5KUEFDb25maWd1cmF0aW9uLkxP\nR19FTkhBTkNFKTsNCiAgICAgICAgSW5zdHJ1bWVudGF0aW9uIGluc3QgPSBu\ndWxsOw0KICAgICAgICBDbGFzc0ZpbGVUcmFuc2Zvcm1lciB0ID0gbnVsbDsN\nCiAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgIGluc3QgPSBJbnN0cnVtZW50\nYXRpb25GYWN0b3J5LmdldEluc3RydW1lbnRhdGlvbigpOw0KDQogICAgICAg\nICAgICBDbGFzc1tdIGFycmF5ID0gY2xhc3Nlcy5rZXlTZXQoKS50b0FycmF5\nKG5ldyBDbGFzc1tjbGFzc2VzLnNpemUoKV0pOw0KICAgICAgICAgICAgaWYg\nKEphdmFWZXJzaW9ucy5WRVJTSU9OID49IDYpIHsNCiAgICAgICAgICAgICAg\nICBsb2cudHJhY2UoX2xvYy5nZXQoInJldHJhbnNmb3JtLXR5cGVzIiwgY2xh\nc3Nlcy5rZXlTZXQoKSkpOw0KDQogICAgICAgICAgICAgICAgdCA9IG5ldyBD\nbGFzc0ZpbGVUcmFuc2Zvcm1lcigpIHsNCiAgICAgICAgICAgICAgICAgICAg\ncHVibGljIGJ5dGVbXSB0cmFuc2Zvcm0oQ2xhc3NMb2FkZXIgbG9hZGVyLCBT\ndHJpbmcgY2xzTmFtZSwNCiAgICAgICAgICAgICAgICAgICAgICAgIENsYXNz\nPD8+IGNsYXNzQmVpbmdSZWRlZmluZWQsIFByb3RlY3Rpb25Eb21haW4gcGQs\nDQogICAgICAgICAgICAgICAgICAgICAgICBieXRlW10gY2xhc3NmaWxlQnVm\nZmVyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gY2xhc3Nl\ncy5nZXQoY2xhc3NCZWluZ1JlZGVmaW5lZCk7DQogICAgICAgICAgICAgICAg\nICAgIH0NCiAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgICAgIA0K\nICAgICAgICAgICAgICAgIC8vIHRoZXNlIGFyZSBKYXZhIDYgbWV0aG9kcywg\nYW5kIHdlIGRvbid0IGhhdmUgYSBKYXZhIDYgYnVpbGQNCiAgICAgICAgICAg\nICAgICAvLyBtb2R1bGUgeWV0LiBUaGUgY29zdCBvZiByZWZsZWN0aW9uIGhl\ncmUgaXMgbmVnbGlnaWJsZQ0KICAgICAgICAgICAgICAgIC8vIGNvbXBhcmVk\nIHRvIHRoZSByZWRlZmluaXRpb24gLyBlbmhhbmNlbWVudCBjb3N0cyBpbiB0\nb3RhbCwNCiAgICAgICAgICAgICAgICAvLyBzbyB0aGlzIHNob3VsZCBub3Qg\nYmUgYSBiaWcgcHJvYmxlbS4NCiAgICAgICAgICAgICAgICBNZXRob2QgbWV0\naCA9IGluc3QuZ2V0Q2xhc3MoKS5nZXRNZXRob2QoImFkZFRyYW5zZm9ybWVy\nIiwNCiAgICAgICAgICAgICAgICAgICAgbmV3IENsYXNzW10geyBDbGFzc0Zp\nbGVUcmFuc2Zvcm1lci5jbGFzcywgYm9vbGVhbi5jbGFzcyB9KTsNCiAgICAg\nICAgICAgICAgICBtZXRoLmludm9rZShpbnN0LCBuZXcgT2JqZWN0W10geyB0\nLCB0cnVlIH0pOw0KICAgICAgICAgICAgICAgIG1ldGggPSBpbnN0LmdldENs\nYXNzKCkuZ2V0TWV0aG9kKCJyZXRyYW5zZm9ybUNsYXNzZXMiLA0KICAgICAg\nICAgICAgICAgICAgICBuZXcgQ2xhc3NbXSB7IGFycmF5LmdldENsYXNzKCkg\nfSk7DQogICAgICAgICAgICAgICAgbWV0aC5pbnZva2UoaW5zdCwgbmV3IE9i\namVjdFtdIHsgYXJyYXkgfSk7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAg\nICAgICAgICAgICAgIGxvZy50cmFjZShfbG9jLmdldCgicmVkZWZpbmUtdHlw\nZXMiLCBjbGFzc2VzLmtleVNldCgpKSk7DQogICAgICAgICAgICAgICAgLy8g\naW4gYSBKYXZhIDUgY29udGV4dCwgd2UgY2FuIHVzZSBjbGFzcyByZWRlZmlu\naXRpb24gaW5zdGVhZA0KICAgICAgICAgICAgICAgIENsYXNzRGVmaW5pdGlv\nbltdIGRlZnMgPSBuZXcgQ2xhc3NEZWZpbml0aW9uW2FycmF5Lmxlbmd0aF07\nDQogICAgICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBkZWZzLmxl\nbmd0aDsgaSsrKQ0KICAgICAgICAgICAgICAgICAgICBkZWZzW2ldID0gbmV3\nIENsYXNzRGVmaW5pdGlvbihhcnJheVtpXSwNCiAgICAgICAgICAgICAgICAg\nICAgICAgIGNsYXNzZXMuZ2V0KGFycmF5W2ldKSk7DQogICAgICAgICAgICAg\nICAgaW5zdC5yZWRlZmluZUNsYXNzZXMoZGVmcyk7DQogICAgICAgICAgICB9\nDQogICAgICAgIH0gY2F0Y2ggKE5vU3VjaE1ldGhvZEV4Y2VwdGlvbiBlKSB7\nDQogICAgICAgICAgICB0aHJvdyBuZXcgSW50ZXJuYWxFeGNlcHRpb24oZSk7\nDQogICAgICAgIH0gY2F0Y2ggKElsbGVnYWxBY2Nlc3NFeGNlcHRpb24gZSkg\new0KICAgICAgICAgICAgdGhyb3cgbmV3IEludGVybmFsRXhjZXB0aW9uKGUp\nOw0KICAgICAgICB9IGNhdGNoIChJbnZvY2F0aW9uVGFyZ2V0RXhjZXB0aW9u\nIGUpIHsNCiAgICAgICAgICAgIHRocm93IG5ldyBVc2VyRXhjZXB0aW9uKGUu\nZ2V0Q2F1c2UoKSk7DQogICAgICAgIH0gY2F0Y2ggKElPRXhjZXB0aW9uIGUp\nIHsNCiAgICAgICAgICAgIHRocm93IG5ldyBJbnRlcm5hbEV4Y2VwdGlvbihl\nKTsNCiAgICAgICAgfSBjYXRjaCAoQ2xhc3NOb3RGb3VuZEV4Y2VwdGlvbiBl\nKSB7DQogICAgICAgICAgICB0aHJvdyBuZXcgSW50ZXJuYWxFeGNlcHRpb24o\nZSk7DQogICAgICAgIH0gY2F0Y2ggKFVubW9kaWZpYWJsZUNsYXNzRXhjZXB0\naW9uIGUpIHsNCiAgICAgICAgICAgIHRocm93IG5ldyBJbnRlcm5hbEV4Y2Vw\ndGlvbihlKTsNCiAgICAgICAgfSBmaW5hbGx5IHsNCiAgICAgICAgICAgIGlm\nIChpbnN0ICE9IG51bGwgJiYgdCAhPSBudWxsKQ0KICAgICAgICAgICAgICAg\nIGluc3QucmVtb3ZlVHJhbnNmb3JtZXIodCk7DQogICAgICAgIH0NCiAgICB9\nDQoNCiAgICAvKioNCiAgICAgKiBAcmV0dXJuIHdoZXRoZXIgb3Igbm90IHRo\naXMgVk0gaGFzIGFuIGluc3RydW1lbnRhdGlvbiBpbnN0YWxsZWQgdGhhdA0K\nICAgICAqIHBlcm1pdHMgcmVkZWZpbml0aW9uIG9mIGNsYXNzZXMuIFRoaXMg\nYXNzdW1lcyB0aGF0IGFsbCB0aGUgYXJndW1lbnRzDQogICAgICogd2lsbCBi\nZSBtb2RpZmlhYmxlIGNsYXNzZXMgYWNjb3JkaW5nIHRvDQogICAgICoge0Bs\naW5rIGphdmEubGFuZy5pbnN0cnVtZW50Lkluc3RydW1lbnRhdGlvbiNpc01v\nZGlmaWFibGVDbGFzc30sIGFuZA0KICAgICAqIG9ubHkgY2hlY2tzIHdoZXRo\nZXIgb3Igbm90IGFuIGluc3RydW1lbnRhdGlvbiBpcyBhdmFpbGFibGUgYW5k\nDQogICAgICogaWYgcmV0cmFuc2Zvcm1hdGlvbiBpcyBwb3NzaWJsZS4NCiAg\nICAgKi8NCiAgICBwdWJsaWMgc3RhdGljIGJvb2xlYW4gY2FuUmVkZWZpbmVD\nbGFzc2VzKCkgew0KICAgICAgICBpZiAoX2NhblJlZGVmaW5lID09IG51bGwp\nIHsNCiAgICAgICAgICAgIHRyeSB7DQogICAgICAgICAgICAgICAgSW5zdHJ1\nbWVudGF0aW9uIGluc3QgPSBJbnN0cnVtZW50YXRpb25GYWN0b3J5DQogICAg\nICAgICAgICAgICAgICAgIC5nZXRJbnN0cnVtZW50YXRpb24oKTsNCiAgICAg\nICAgICAgICAgICBpZiAoaW5zdCA9PSBudWxsKSB7DQogICAgICAgICAgICAg\nICAgICAgIF9jYW5SZWRlZmluZSA9IEJvb2xlYW4uRkFMU0U7DQogICAgICAg\nICAgICAgICAgfSBlbHNlIGlmIChKYXZhVmVyc2lvbnMuVkVSU0lPTiA9PSA1\nKSB7DQogICAgICAgICAgICAgICAgICAgIC8vIGlmIGluc3QgaXMgbm9uLW51\nbGwgYW5kIHdlJ3JlIHVzaW5nIEphdmEgNSwNCiAgICAgICAgICAgICAgICAg\nICAgLy8gaXNSZXRyYW5zZm9ybUNsYXNzZXNTdXBwb3J0ZWQgaXNuJ3QgYXZh\naWxhYmxlLA0KICAgICAgICAgICAgICAgICAgICAvLyBzbyB3ZSB1c2UgdGhl\nIG1vcmUgYmFzaWMgY2xhc3MgcmVkZWZpbml0aW9uDQogICAgICAgICAgICAg\nICAgICAgIC8vIGluc3RlYWQuDQogICAgICAgICAgICAgICAgICAgIF9jYW5S\nZWRlZmluZSA9IEJvb2xlYW4uVFJVRTsNCiAgICAgICAgICAgICAgICB9IGVs\nc2Ugew0KICAgICAgICAgICAgICAgICAgICBfY2FuUmVkZWZpbmUgPSAoQm9v\nbGVhbikgSW5zdHJ1bWVudGF0aW9uLmNsYXNzLmdldE1ldGhvZCgNCiAgICAg\nICAgICAgICAgICAgICAgICAgICJpc1JldHJhbnNmb3JtQ2xhc3Nlc1N1cHBv\ncnRlZCIpLmludm9rZShpbnN0KTsNCiAgICAgICAgICAgICAgICB9DQogICAg\nICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkgew0KICAgICAgICAgICAg\nICAgIF9jYW5SZWRlZmluZSA9IEJvb2xlYW4uRkFMU0U7DQogICAgICAgICAg\nICB9DQogICAgICAgIH0NCiAgICAgICAgcmV0dXJuIF9jYW5SZWRlZmluZS5i\nb29sZWFuVmFsdWUoKTsNCiAgICB9DQp9\n","encoding":"base64"}

