{"sha":"a6ee36b401c8b26c29a14e54bd83eb699fa4ef10","node_id":"MDQ6QmxvYjIwNjM2NDphNmVlMzZiNDAxYzhiMjZjMjlhMTRlNTRiZDgzZWI2OTlmYTRlZjEw","size":7006,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/a6ee36b401c8b26c29a14e54bd83eb699fa4ef10","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEubGliLm1ldGE7CgppbXBvcnQg\namF2YS5pby5JT0V4Y2VwdGlvbjsKCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEubGliLmxvZy5Mb2c7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGli\nLnV0aWwuTG9jYWxpemVyOwoKaW1wb3J0IHNlcnAuYnl0ZWNvZGUubG93bGV2\nZWwuQ29uc3RhbnRQb29sVGFibGU7CgovKioKICogRmlsdGVyIHRoYXQgbG9v\na3MgZm9yIGNsYXNzZXMgd2l0aCBvbmUgb2YgYSBzZXQgb2YgYW5ub3RhdGlv\nbnMuCiAqIFNlZSBKREsgMS41IEpWTSBzcGVjIGZvciBkZXRhaWxzIG9uIGFu\nbm90YXRpb24gYnl0ZWNvZGU6PGJyIC8+CiAqIGphdmEuc3VuLmNvbS9kb2Nz\nL2Jvb2tzL3Ztc3BlYy8ybmQtZWRpdGlvbi9DbGFzc0ZpbGVGb3JtYXQtZmlu\nYWwtZHJhZnQucGRmCiAqCiAqIEBhdXRob3IgQWJlIFdoaXRlCiAqIEBub2ph\ndmFkb2MKICovCnB1YmxpYyBjbGFzcyBDbGFzc0Fubm90YXRpb25NZXRhRGF0\nYUZpbHRlciBpbXBsZW1lbnRzIE1ldGFEYXRhRmlsdGVyIHsKCiAgICBwcml2\nYXRlIGZpbmFsIFN0cmluZ1tdIF9hbm5vczsKICAgIAogICAgcHJpdmF0ZSBz\ndGF0aWMgZmluYWwgTG9jYWxpemVyIF9sb2MgPSBMb2NhbGl6ZXIuZm9yUGFj\na2FnZQogICAgICAgIChDbGFzc0Fubm90YXRpb25NZXRhRGF0YUZpbHRlci5j\nbGFzcyk7CiAgICBwcml2YXRlIExvZyBfbG9nID0gbnVsbDsKCiAgICAvKioK\nICAgICAqIENvbnN0cnVjdG9yOyBzdXBwbHkgYW5ub3RhdGlvbiB0byBtYXRj\naCBhZ2FpbnN0LgogICAgICovCiAgICBwdWJsaWMgQ2xhc3NBbm5vdGF0aW9u\nTWV0YURhdGFGaWx0ZXIoQ2xhc3MgYW5ubykgewogICAgICAgIHRoaXMobmV3\nIENsYXNzW117IGFubm8gfSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBDb25z\ndHJ1Y3Rvcjsgc3VwcGx5IGFubm90YXRpb25zIHRvIG1hdGNoIGFnYWluc3Qu\nCiAgICAgKi8KICAgIHB1YmxpYyBDbGFzc0Fubm90YXRpb25NZXRhRGF0YUZp\nbHRlcihDbGFzc1tdIGFubm9zKSB7CiAgICAgICAgX2Fubm9zID0gbmV3IFN0\ncmluZ1thbm5vcy5sZW5ndGhdOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBp\nIDwgYW5ub3MubGVuZ3RoOyBpKyspCiAgICAgICAgICAgIF9hbm5vc1tpXSA9\nICJMIiArIGFubm9zW2ldLmdldE5hbWUoKS5yZXBsYWNlKCcuJywgJy8nKSAr\nICI7IjsKICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBtYXRjaGVzKFJlc291\ncmNlIHJzcmMpIHRocm93cyBJT0V4Y2VwdGlvbiB7CiAgICAgICAgaWYgKF9h\nbm5vcy5sZW5ndGggPT0gMCB8fCAhcnNyYy5nZXROYW1lKCkuZW5kc1dpdGgo\nIi5jbGFzcyIpKQogICAgICAgICAgICByZXR1cm4gZmFsc2U7CgogICAgICAg\nIHRyeSB7CiAgICAgICAgICAgIENvbnN0YW50UG9vbFRhYmxlIHRhYmxlID0g\nbmV3IENvbnN0YW50UG9vbFRhYmxlKHJzcmMuZ2V0Q29udGVudCgpKTsKICAg\nICAgICAgICAgaW50IGlkeCA9IHRhYmxlLmdldEVuZEluZGV4KCk7CiAgICAg\nICAgICAgIGlkeCArPSA2OyAvLyBza2lwIGFjY2VzcywgY2xzLCBzdXBlcgoK\nICAgICAgICAgICAgLy8gc2tpcCBpbnRlcmZhY2VzCiAgICAgICAgICAgIGlu\ndCBpbnRlcmZhY2VzID0gdGFibGUucmVhZFVuc2lnbmVkU2hvcnQoaWR4KTsK\nICAgICAgICAgICAgaWR4ICs9IDIgKyBpbnRlcmZhY2VzICogMjsKCiAgICAg\nICAgICAgIC8vIHNraXAgZmllbGRzIGFuZCBtZXRob2RzCiAgICAgICAgICAg\nIGludCBmaWVsZHMgPSB0YWJsZS5yZWFkVW5zaWduZWRTaG9ydChpZHgpOwog\nICAgICAgICAgICBpZHggKz0gMjsKICAgICAgICAgICAgZm9yIChpbnQgaSA9\nIDA7IGkgPCBmaWVsZHM7IGkrKykKICAgICAgICAgICAgICAgIGlkeCArPSBz\na2lwRmllbGRPck1ldGhvZCh0YWJsZSwgaWR4KTsKICAgICAgICAgICAgaW50\nIG1ldGhvZHMgPSB0YWJsZS5yZWFkVW5zaWduZWRTaG9ydChpZHgpOwogICAg\nICAgICAgICBpZHggKz0gMjsKICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7\nIGkgPCBtZXRob2RzOyBpKyspCiAgICAgICAgICAgICAgICBpZHggKz0gc2tp\ncEZpZWxkT3JNZXRob2QodGFibGUsIGlkeCk7CgogICAgICAgICAgICAvLyBs\nb29rIGZvciBhbm5vdGF0aW9uIGF0dHJzCiAgICAgICAgICAgIGludCBhdHRy\ncyA9IHRhYmxlLnJlYWRVbnNpZ25lZFNob3J0KGlkeCk7CiAgICAgICAgICAg\nIGlkeCArPSAyOwogICAgICAgICAgICBpbnQgbmFtZTsKICAgICAgICAgICAg\nZm9yIChpbnQgaSA9IDA7IGkgPCBhdHRyczsgaSsrKSB7CiAgICAgICAgICAg\nICAgICBuYW1lID0gdGFibGUucmVhZFVuc2lnbmVkU2hvcnQoaWR4KTsKICAg\nICAgICAgICAgICAgIGlkeCArPSAyOwogICAgICAgICAgICAgICAgaWYgKCJS\ndW50aW1lVmlzaWJsZUFubm90YXRpb25zIi5lcXVhbHModGFibGUucmVhZFN0\ncmluZwogICAgICAgICAgICAgICAgICAgICh0YWJsZS5nZXQobmFtZSkpKSkK\nICAgICAgICAgICAgICAgICAgICByZXR1cm4gbWF0Y2hBbm5vdGF0aW9ucyh0\nYWJsZSwgaWR4ICsgNCk7CiAgICAgICAgICAgICAgICBpZHggKz0gNCArIHRh\nYmxlLnJlYWRJbnQoaWR4KTsKICAgICAgICAgICAgfQogICAgICAgIH0gY2F0\nY2ggKEFycmF5SW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvbiBlKSB7CiAgICAg\nICAgICAgIC8qCiAgICAgICAgICAgICAqIFRoaXMgQXJyYXlJbmRleE91dE9m\nQm91bmRzRXhjZXB0aW9uIGluZGljYXRlcyBhbiBpbmNvcnJlY3RseQogICAg\nICAgICAgICAgKiBmb3JtZWQgLmNsYXNzIGZpbGUuIFdlIHdpbGwgZWF0IHRo\nZSBleGNlcHRpb24sIGxvZyBhIHRyYWNlCiAgICAgICAgICAgICAqIG1lc3Nh\nZ2UgKGlmIGEgbG9nIGV4aXN0cyksIGFuZCByZXR1cm4gImZhbHNlIiB0byBp\nbmRpY2F0ZSB0aGVyZQogICAgICAgICAgICAgKiB3YXMgbm8gbWF0Y2guCiAg\nICAgICAgICAgICAqLwogICAgICAgICAgICBFcnJvciBjZmUgPSBuZXcgQ2xh\nc3NGb3JtYXRFcnJvcihyc3JjLmdldE5hbWUoKSk7CiAgICAgICAgICAgIGNm\nZS5pbml0Q2F1c2UoZSk7CiAgICAgICAgICAgIGlmIChfbG9nICE9IG51bGwg\nJiYgX2xvZy5pc1RyYWNlRW5hYmxlZCgpKQogICAgICAgICAgICAgICAgX2xv\nZy50cmFjZShfbG9jLmdldCgiY2xhc3MtYXJnIiwgcnNyYy5nZXROYW1lKCkp\nLCBjZmUpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gZmFsc2U7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBSZXR1cm4gd2hldGhlciB0aGUgZ2l2ZW4gYW5u\nb3RhdGlvbnMgbWF0Y2ggb3VyIGNhbmRpZGF0ZXMuCiAgICAgKi8KICAgIHBy\naXZhdGUgYm9vbGVhbiBtYXRjaEFubm90YXRpb25zKENvbnN0YW50UG9vbFRh\nYmxlIHRhYmxlLCBpbnQgaWR4KSB7CiAgICAgICAgaW50IGFubm9zID0gdGFi\nbGUucmVhZFVuc2lnbmVkU2hvcnQoaWR4KTsKICAgICAgICBpZHggKz0gMjsK\nCiAgICAgICAgaW50IHR5cGU7CiAgICAgICAgaW50IHByb3BzOwogICAgICAg\nIGZvciAoaW50IGkgPSAwOyBpIDwgYW5ub3M7IGkrKykgewogICAgICAgICAg\nICB0eXBlID0gdGFibGUucmVhZFVuc2lnbmVkU2hvcnQoaWR4KTsKICAgICAg\nICAgICAgaWR4ICs9IDI7CiAgICAgICAgICAgIGlmIChtYXRjaEFubm90YXRp\nb24odGFibGUucmVhZFN0cmluZyh0YWJsZS5nZXQodHlwZSkpKSkKICAgICAg\nICAgICAgICAgIHJldHVybiB0cnVlOwoKICAgICAgICAgICAgcHJvcHMgPSB0\nYWJsZS5yZWFkVW5zaWduZWRTaG9ydChpZHgpOwogICAgICAgICAgICBpZHgg\nKz0gMjsKICAgICAgICAgICAgZm9yIChpbnQgaiA9IDA7IGogPCBwcm9wczsg\naisrKSB7CiAgICAgICAgICAgICAgICBpZHggKz0gMjsgLy8gbmFtZQogICAg\nICAgICAgICAgICAgaWR4ICs9IHNraXBBbm5vdGF0aW9uUHJvcGVydHlWYWx1\nZSh0YWJsZSwgaWR4KTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAg\nICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4g\nd2hldGhlciB0aGUgZ2l2ZW4gYW5ub3RhdGlvbiBtYXRjaGVzIG91ciBjYW5k\naWRhdGVzLgogICAgICovCiAgICBwcml2YXRlIGJvb2xlYW4gbWF0Y2hBbm5v\ndGF0aW9uKFN0cmluZyBuYW1lKSB7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7\nIGkgPCBfYW5ub3MubGVuZ3RoOyBpKyspCiAgICAgICAgICAgIGlmIChuYW1l\nLmVxdWFscyhfYW5ub3NbaV0pKQogICAgICAgICAgICAgICAgcmV0dXJuIHRy\ndWU7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIC8qKgogICAg\nICogU2tpcCBhbiBhbm5vdGF0aW9uIHByb3BlcnR5IHZhbHVlLCByZXR1cm5p\nbmcgdGhlIG51bWJlciBvZiBieXRlcyBza2lwcGVkLgogICAgICovCiAgICBw\ncml2YXRlIHN0YXRpYyBpbnQgc2tpcEFubm90YXRpb25Qcm9wZXJ0eVZhbHVl\nKENvbnN0YW50UG9vbFRhYmxlIHRhYmxlLAogICAgICAgIGludCBpZHgpIHsK\nICAgICAgICBpbnQgc2tpcHBlZCA9IDA7CiAgICAgICAgc3dpdGNoICh0YWJs\nZS5yZWFkQnl0ZShpZHggKyBza2lwcGVkKyspKSB7CiAgICAgICAgICAgIGNh\nc2UgJ1onOiAvLyBib29sCiAgICAgICAgICAgIGNhc2UgJ0InOiAvLyBieXRl\nCiAgICAgICAgICAgIGNhc2UgJ0MnOiAvLyBjaGFyCiAgICAgICAgICAgIGNh\nc2UgJ0QnOiAvLyBkb3VibGUKICAgICAgICAgICAgY2FzZSAnRic6IC8vIGZs\nb2F0CiAgICAgICAgICAgIGNhc2UgJ0knOiAvLyBpbnQKICAgICAgICAgICAg\nY2FzZSAnSic6IC8vIGxvbmcKICAgICAgICAgICAgY2FzZSAnUyc6IC8vIHNo\nb3J0CiAgICAgICAgICAgIGNhc2UgJ3MnOiAvLyBzdHJpbmcKICAgICAgICAg\nICAgY2FzZSAnYyc6IC8vIGNsYXNzCiAgICAgICAgICAgICAgICBza2lwcGVk\nICs9IDI7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2Fz\nZSAnZSc6IC8vIGVudW0gcHRyCiAgICAgICAgICAgICAgICBza2lwcGVkICs9\nIDQ7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSAn\nWyc6IC8vIGFycmF5CiAgICAgICAgICAgICAgICBpbnQgc2l6ZSA9IHRhYmxl\nLnJlYWRVbnNpZ25lZFNob3J0KGlkeCArIHNraXBwZWQpOwogICAgICAgICAg\nICAgICAgc2tpcHBlZCArPSAyOwogICAgICAgICAgICAgICAgZm9yIChpbnQg\naSA9IDA7IGkgPCBzaXplOyBpKyspCiAgICAgICAgICAgICAgICAgICAgc2tp\ncHBlZCArPQogICAgICAgICAgICAgICAgICAgICAgICBza2lwQW5ub3RhdGlv\nblByb3BlcnR5VmFsdWUodGFibGUsIGlkeCArIHNraXBwZWQpOwogICAgICAg\nICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgJ0AnOiAvLyBhbm5v\nCiAgICAgICAgICAgICAgICBza2lwcGVkICs9IDI7IC8vIHR5cGUKICAgICAg\nICAgICAgICAgIGludCBwcm9wcyA9IHRhYmxlLnJlYWRVbnNpZ25lZFNob3J0\nKGlkeCArIHNraXBwZWQpOwogICAgICAgICAgICAgICAgc2tpcHBlZCArPSAy\nOwogICAgICAgICAgICAgICAgZm9yIChpbnQgaiA9IDA7IGogPCBwcm9wczsg\naisrKSB7CiAgICAgICAgICAgICAgICAgICAgc2tpcHBlZCArPSAyOyAvLyBu\nYW1lCiAgICAgICAgICAgICAgICAgICAgc2tpcHBlZCArPQogICAgICAgICAg\nICAgICAgICAgICAgICBza2lwQW5ub3RhdGlvblByb3BlcnR5VmFsdWUodGFi\nbGUsIGlkeCArIHNraXBwZWQpOwogICAgICAgICAgICAgICAgfQogICAgICAg\nICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICAgIHJldHVybiBza2lw\ncGVkOwogICAgfQoKICAgIC8qKgogICAgICogU2tpcCB0aGUgY3VycmVudCBm\naWVsZCBvciBtZXRob2QsIHJldHVybmluZyB0aGUgbnVtYmVyIG9mIGJ5dGVz\nIHNraXBwZWQuCiAgICAgKi8KICAgIHByaXZhdGUgc3RhdGljIGludCBza2lw\nRmllbGRPck1ldGhvZChDb25zdGFudFBvb2xUYWJsZSB0YWJsZSwgaW50IGlk\neCkgewogICAgICAgIGludCBhdHRycyA9IHRhYmxlLnJlYWRVbnNpZ25lZFNo\nb3J0KGlkeCArIDYpOwogICAgICAgIGludCBza2lwcGVkID0gODsKICAgICAg\nICBpbnQgbGVuOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgYXR0cnM7\nIGkrKykgewogICAgICAgICAgICBsZW4gPSB0YWJsZS5yZWFkSW50KGlkeCAr\nIHNraXBwZWQgKyAyKTsKICAgICAgICAgICAgc2tpcHBlZCArPSA2ICsgbGVu\nOwogICAgICAgIH0KICAgICAgICByZXR1cm4gc2tpcHBlZDsKICAgIH0KCiAg\nICBwdWJsaWMgTG9nIGdldExvZygpIHsKICAgICAgICByZXR1cm4gX2xvZzsK\nICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRMb2coTG9nIF9sb2cpIHsKICAg\nICAgICB0aGlzLl9sb2cgPSBfbG9nOwogICAgfQp9Cg==\n","encoding":"base64"}

