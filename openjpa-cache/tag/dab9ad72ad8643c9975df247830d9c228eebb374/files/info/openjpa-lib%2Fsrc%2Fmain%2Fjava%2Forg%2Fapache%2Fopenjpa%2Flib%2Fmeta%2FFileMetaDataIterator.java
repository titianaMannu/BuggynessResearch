{"sha":"d63f2365bc5c34c49f90ab3ba1ffbb7e819ecb95","node_id":"MDQ6QmxvYjIwNjM2NDpkNjNmMjM2NWJjNWMzNGM0OWY5MGFiM2JhMWZmYmI3ZTgxOWVjYjk1","size":6355,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/d63f2365bc5c34c49f90ab3ba1ffbb7e819ecb95","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEubGliLm1ldGE7CgppbXBvcnQg\namF2YS5pby5CeXRlQXJyYXlPdXRwdXRTdHJlYW07CmltcG9ydCBqYXZhLmlv\nLkZpbGU7CmltcG9ydCBqYXZhLmlvLkZpbGVJbnB1dFN0cmVhbTsKaW1wb3J0\nIGphdmEuaW8uRmlsZU5vdEZvdW5kRXhjZXB0aW9uOwppbXBvcnQgamF2YS5p\nby5JT0V4Y2VwdGlvbjsKaW1wb3J0IGphdmEuaW8uSW5wdXRTdHJlYW07Cmlt\ncG9ydCBqYXZhLm5ldC5NYWxmb3JtZWRVUkxFeGNlcHRpb247CmltcG9ydCBq\nYXZhLnNlY3VyaXR5LkFjY2Vzc0NvbnRyb2xsZXI7CmltcG9ydCBqYXZhLnNl\nY3VyaXR5LlByaXZpbGVnZWRBY3Rpb25FeGNlcHRpb247CmltcG9ydCBqYXZh\nLnV0aWwuQXJyYXlMaXN0OwppbXBvcnQgamF2YS51dGlsLkNvbGxlY3Rpb247\nCmltcG9ydCBqYXZhLnV0aWwuQ29sbGVjdGlvbnM7CmltcG9ydCBqYXZhLnV0\naWwuSXRlcmF0b3I7CmltcG9ydCBqYXZhLnV0aWwuTm9TdWNoRWxlbWVudEV4\nY2VwdGlvbjsKCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwu\nSjJEb1ByaXZIZWxwZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGli\nLnV0aWwuTG9jYWxpemVyOwoKLyoqCiAqIEl0ZXJhdG9yIG92ZXIgYSBmaWxl\nLCBvciBvdmVyIGFsbCBtZXRhZGF0YSByZXNvdXJjZXMgYmVsb3cgYSBnaXZl\nbiBkaXJlY3RvcnkuCiAqCiAqIEBhdXRob3IgQWJlIFdoaXRlCiAqIEBub2ph\ndmFkb2MKICovCnB1YmxpYyBjbGFzcyBGaWxlTWV0YURhdGFJdGVyYXRvciBp\nbXBsZW1lbnRzIE1ldGFEYXRhSXRlcmF0b3IgewoKICAgIHByaXZhdGUgc3Rh\ndGljIGZpbmFsIGxvbmcgU0NBTl9MSU1JVCA9IDEwMDAwMDsKCiAgICBwcml2\nYXRlIHN0YXRpYyBmaW5hbCBMb2NhbGl6ZXIgX2xvYyA9IExvY2FsaXplci5m\nb3JQYWNrYWdlCiAgICAgICAgKEZpbGVNZXRhRGF0YUl0ZXJhdG9yLmNsYXNz\nKTsKCiAgICBwcml2YXRlIGZpbmFsIEl0ZXJhdG9yIF9pdHI7CiAgICBwcml2\nYXRlIEZpbGUgX2ZpbGUgPSBudWxsOwoKICAgIC8qKgogICAgICogQ29uc3Ry\ndWN0b3I7IHN1cHBseSBtZXRhZGF0YSBmaWxlLgogICAgICovCiAgICBwdWJs\naWMgRmlsZU1ldGFEYXRhSXRlcmF0b3IoRmlsZSBmaWxlKSB7CiAgICAgICAg\nX2l0ciA9IENvbGxlY3Rpb25zLnNpbmdsZXRvbihmaWxlKS5pdGVyYXRvcigp\nOwogICAgfQoKICAgIC8qKgogICAgICogQ29uc3RydWN0b3I7IHN1cHBseSBy\nb290IG9mIGRpcmVjdG9yeSB0cmVlIHRvIHNlYXJjaCBhbmQgb3B0aW9uYWwK\nICAgICAqIGZpbGUgZmlsdGVyLgogICAgICovCiAgICBwdWJsaWMgRmlsZU1l\ndGFEYXRhSXRlcmF0b3IoRmlsZSBkaXIsIE1ldGFEYXRhRmlsdGVyIGZpbHRl\ncikKICAgICAgICB0aHJvd3MgSU9FeGNlcHRpb24gewogICAgICAgIGlmIChk\naXIgPT0gbnVsbCkKICAgICAgICAgICAgX2l0ciA9IG51bGw7CiAgICAgICAg\nZWxzZSB7CiAgICAgICAgICAgIENvbGxlY3Rpb24gbWV0YXMgPSBuZXcgQXJy\nYXlMaXN0KCk7CiAgICAgICAgICAgIEZpbGVSZXNvdXJjZSByc3JjID0gKGZp\nbHRlciA9PSBudWxsKSA/IG51bGwgOiBuZXcgRmlsZVJlc291cmNlKCk7CiAg\nICAgICAgICAgIHNjYW4oZGlyLCBmaWx0ZXIsIHJzcmMsIG1ldGFzLCAwKTsK\nICAgICAgICAgICAgX2l0ciA9IG1ldGFzLml0ZXJhdG9yKCk7CiAgICAgICAg\nfQogICAgfQoKICAgIC8qKgogICAgICogU2NhbiBhbGwgZmlsZXMgYmVsb3cg\ndGhlIGdpdmVuIG9uZSBmb3IgbWV0YWRhdGEgZmlsZXMsIGFkZGluZyB0aGVt\nCiAgICAgKiB0byB0aGUgZ2l2ZW4gY29sbGVjdGlvbi4KICAgICAqLwogICAg\ncHJpdmF0ZSBpbnQgc2NhbihGaWxlIGZpbGUsIE1ldGFEYXRhRmlsdGVyIGZp\nbHRlciwgRmlsZVJlc291cmNlIHJzcmMsCiAgICAgICAgQ29sbGVjdGlvbiBt\nZXRhcywgaW50IHNjYW5uZWQpIHRocm93cyBJT0V4Y2VwdGlvbiB7CiAgICAg\nICAgaWYgKHNjYW5uZWQgPiBTQ0FOX0xJTUlUKQogICAgICAgICAgICB0aHJv\ndyBuZXcgSWxsZWdhbFN0YXRlRXhjZXB0aW9uKF9sb2MuZ2V0KCJ0b28tbWFu\neS1maWxlcyIsCiAgICAgICAgICAgICAgICBTdHJpbmcudmFsdWVPZihTQ0FO\nX0xJTUlUKSkuZ2V0TWVzc2FnZSgpKTsKICAgICAgICBzY2FubmVkKys7Cgog\nICAgICAgIGlmIChmaWx0ZXIgPT0gbnVsbCkKICAgICAgICAgICAgbWV0YXMu\nYWRkKGZpbGUpOwogICAgICAgIGVsc2UgewogICAgICAgICAgICByc3JjLnNl\ndEZpbGUoZmlsZSk7CiAgICAgICAgICAgIGlmIChmaWx0ZXIubWF0Y2hlcyhy\nc3JjKSkKICAgICAgICAgICAgICAgIG1ldGFzLmFkZChmaWxlKTsKICAgICAg\nICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICBGaWxlW10gZmlsZXMgPSAo\nRmlsZVtdKSBBY2Nlc3NDb250cm9sbGVyCiAgICAgICAgICAgICAgICAgICAg\nLmRvUHJpdmlsZWdlZChKMkRvUHJpdkhlbHBlci5saXN0RmlsZXNBY3Rpb24o\nZmlsZSkpOyAKICAgICAgICAgICAgICAgIGlmIChmaWxlcyAhPSBudWxsKQog\nICAgICAgICAgICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgZmlsZXMu\nbGVuZ3RoOyBpKyspCiAgICAgICAgICAgICAgICAgICAgICAgIHNjYW5uZWQg\nPSBzY2FuKGZpbGVzW2ldLCBmaWx0ZXIsIHJzcmMsIG1ldGFzLCBzY2FubmVk\nKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4gc2Nh\nbm5lZDsKICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBoYXNOZXh0KCkgewog\nICAgICAgIHJldHVybiBfaXRyICE9IG51bGwgJiYgX2l0ci5oYXNOZXh0KCk7\nCiAgICB9CgogICAgcHVibGljIE9iamVjdCBuZXh0KCkgdGhyb3dzIElPRXhj\nZXB0aW9uIHsKICAgICAgICBpZiAoX2l0ciA9PSBudWxsKQogICAgICAgICAg\nICB0aHJvdyBuZXcgTm9TdWNoRWxlbWVudEV4Y2VwdGlvbigpOwoKICAgICAg\nICBfZmlsZSA9IChGaWxlKSBfaXRyLm5leHQoKTsKICAgICAgICB0cnkgewog\nICAgICAgICAgICBGaWxlIGYgPSAoRmlsZSkgQWNjZXNzQ29udHJvbGxlci5k\nb1ByaXZpbGVnZWQoSjJEb1ByaXZIZWxwZXIKICAgICAgICAgICAgICAgIC5n\nZXRBYnNvbHV0ZUZpbGVBY3Rpb24oX2ZpbGUpKTsKICAgICAgICAgICAgcmV0\ndXJuIEFjY2Vzc0NvbnRyb2xsZXIuZG9Qcml2aWxlZ2VkKAogICAgICAgICAg\nICAgICAgSjJEb1ByaXZIZWxwZXIudG9VUkxBY3Rpb24oZikpOwogICAgICAg\nIH0gY2F0Y2ggKFByaXZpbGVnZWRBY3Rpb25FeGNlcHRpb24gcGFlKSB7CiAg\nICAgICAgICAgIHRocm93IChNYWxmb3JtZWRVUkxFeGNlcHRpb24pIHBhZS5n\nZXRFeGNlcHRpb24oKTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGljIElu\ncHV0U3RyZWFtIGdldElucHV0U3RyZWFtKCkgdGhyb3dzIElPRXhjZXB0aW9u\nIHsKICAgICAgICBpZiAoX2ZpbGUgPT0gbnVsbCkKICAgICAgICAgICAgdGhy\nb3cgbmV3IElsbGVnYWxTdGF0ZUV4Y2VwdGlvbigpOwogICAgICAgIEZpbGVJ\nbnB1dFN0cmVhbSBmaXMgPSBudWxsOwogICAgICAgIHRyeSB7CiAgICAgICAg\nICAgIGZpcyA9IChGaWxlSW5wdXRTdHJlYW0pIEFjY2Vzc0NvbnRyb2xsZXIu\nZG9Qcml2aWxlZ2VkKAogICAgICAgICAgICAgICAgSjJEb1ByaXZIZWxwZXIu\nbmV3RmlsZUlucHV0U3RyZWFtQWN0aW9uKF9maWxlKSk7CiAgICAgICAgICAg\nIHJldHVybiBmaXM7CiAgICAgICAgfSBjYXRjaCAoUHJpdmlsZWdlZEFjdGlv\nbkV4Y2VwdGlvbiBwYWUpIHsKICAgICAgICAgICAgdGhyb3cgKEZpbGVOb3RG\nb3VuZEV4Y2VwdGlvbikgcGFlLmdldEV4Y2VwdGlvbigpOwogICAgICAgIH0K\nICAgIH0KCiAgICBwdWJsaWMgRmlsZSBnZXRGaWxlKCkgewogICAgICAgIGlm\nIChfZmlsZSA9PSBudWxsKQogICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdh\nbFN0YXRlRXhjZXB0aW9uKCk7CiAgICAgICAgcmV0dXJuIF9maWxlOwogICAg\nfQoKICAgIHB1YmxpYyB2b2lkIGNsb3NlKCkgewogICAgfQoKICAgIHByaXZh\ndGUgc3RhdGljIGNsYXNzIEZpbGVSZXNvdXJjZSBpbXBsZW1lbnRzIE1ldGFE\nYXRhRmlsdGVyLlJlc291cmNlIHsKCiAgICAgICAgcHJpdmF0ZSBGaWxlIF9m\naWxlID0gbnVsbDsKCiAgICAgICAgcHVibGljIHZvaWQgc2V0RmlsZShGaWxl\nIGZpbGUpIHsKICAgICAgICAgICAgX2ZpbGUgPSBmaWxlOwogICAgICAgIH0K\nCiAgICAgICAgcHVibGljIFN0cmluZyBnZXROYW1lKCkgewogICAgICAgICAg\nICByZXR1cm4gX2ZpbGUuZ2V0TmFtZSgpOwogICAgICAgIH0KCiAgICAgICAg\ncHVibGljIGJ5dGVbXSBnZXRDb250ZW50KCkgdGhyb3dzIElPRXhjZXB0aW9u\nIHsKICAgICAgICAgICAgbG9uZyBsZW4gPSAoKExvbmcpIEFjY2Vzc0NvbnRy\nb2xsZXIuZG9Qcml2aWxlZ2VkKAogICAgICAgICAgICAgICAgSjJEb1ByaXZI\nZWxwZXIubGVuZ3RoQWN0aW9uKF9maWxlKSkpLmxvbmdWYWx1ZSgpOwogICAg\nICAgICAgICBGaWxlSW5wdXRTdHJlYW0gZmluID0gbnVsbDsKICAgICAgICAg\nICAgdHJ5IHsKICAgICAgICAgICAgICAgIGZpbiA9IChGaWxlSW5wdXRTdHJl\nYW0pIEFjY2Vzc0NvbnRyb2xsZXIuZG9Qcml2aWxlZ2VkKAogICAgICAgICAg\nICAgICAgICAgIEoyRG9Qcml2SGVscGVyLm5ld0ZpbGVJbnB1dFN0cmVhbUFj\ndGlvbihfZmlsZSkpOwogICAgICAgICAgICB9IGNhdGNoIChQcml2aWxlZ2Vk\nQWN0aW9uRXhjZXB0aW9uIHBhZSkgewogICAgICAgICAgICAgICAgIHRocm93\nIChGaWxlTm90Rm91bmRFeGNlcHRpb24pIHBhZS5nZXRFeGNlcHRpb24oKTsK\nICAgICAgICAgICAgfQogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAg\nICAgYnl0ZVtdIGNvbnRlbnQ7CiAgICAgICAgICAgICAgICBpZiAobGVuIDw9\nIDAgfHwgbGVuID4gSW50ZWdlci5NQVhfVkFMVUUpIHsKICAgICAgICAgICAg\nICAgICAgICAvLyBzb21lIEpWTXMgZG9uJ3QgcmV0dXJuIGEgcHJvcGVyIGxl\nbmd0aAogICAgICAgICAgICAgICAgICAgIEJ5dGVBcnJheU91dHB1dFN0cmVh\nbSBib3V0ID0gbmV3IEJ5dGVBcnJheU91dHB1dFN0cmVhbSgpOwogICAgICAg\nICAgICAgICAgICAgIGJ5dGVbXSBidWYgPSBuZXcgYnl0ZVsxMDI0XTsgCiAg\nICAgICAgICAgICAgICAgICAgZm9yIChpbnQgcjsgKHIgPSBmaW4ucmVhZChi\ndWYpKSAhPSAtMTspCiAgICAgICAgICAgICAgICAgICAgICAgIGJvdXQud3Jp\ndGUoYnVmLCAwLCByKTsKICAgICAgICAgICAgICAgICAgICBjb250ZW50ID0g\nYm91dC50b0J5dGVBcnJheSgpOwogICAgICAgICAgICAgICAgfSBlbHNlIHsK\nICAgICAgICAgICAgICAgICAgICBjb250ZW50ID0gbmV3IGJ5dGVbKGludCkg\nbGVuXTsKICAgICAgICAgICAgICAgICAgICBmb3IgKGludCByLCBvID0gMDsg\nbyA8IGNvbnRlbnQubGVuZ3RoICYmIChyID0gZmluLgogICAgICAgICAgICAg\nICAgICAgICAgICByZWFkKGNvbnRlbnQsIG8sIGNvbnRlbnQubGVuZ3RoIC0g\nbykpICE9IC0xOyBvICs9IHIpOwogICAgICAgICAgICAgICAgfQogICAgICAg\nICAgICAgICAgcmV0dXJuIGNvbnRlbnQ7CiAgICAgICAgICAgIH0gZmluYWxs\neSB7CiAgICAgICAgICAgICAgICB0cnkgeyBmaW4uY2xvc2UoKTsgfSBjYXRj\naCAoSU9FeGNlcHRpb24gaW9lKSB7fQogICAgICAgICAgICB9CiAgICAgICAg\nfQogICAgfQp9Cg==\n","encoding":"base64"}

