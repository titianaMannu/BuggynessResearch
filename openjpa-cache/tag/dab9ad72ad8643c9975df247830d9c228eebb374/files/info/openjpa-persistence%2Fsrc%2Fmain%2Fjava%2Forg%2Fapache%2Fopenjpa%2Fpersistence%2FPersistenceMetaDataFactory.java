{"sha":"b56c28028bc95d4aca2187f99f919e77ca95e761","node_id":"MDQ6QmxvYjIwNjM2NDpiNTZjMjgwMjhiYzk1ZDRhY2EyMTg3Zjk5ZjkxOWU3N2NhOTVlNzYx","size":17807,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/b56c28028bc95d4aca2187f99f919e77ca95e761","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2U7CgppbXBv\ncnQgamF2YS5pby5GaWxlOwppbXBvcnQgamF2YS5pby5JT0V4Y2VwdGlvbjsK\naW1wb3J0IGphdmEubmV0LlVSTDsKaW1wb3J0IGphdmEuc2VjdXJpdHkuQWNj\nZXNzQ29udHJvbGxlcjsKaW1wb3J0IGphdmEudXRpbC5BcnJheXM7CmltcG9y\ndCBqYXZhLnV0aWwuQ29sbGVjdGlvbjsKaW1wb3J0IGphdmEudXRpbC5Db2xs\nZWN0aW9uczsKaW1wb3J0IGphdmEudXRpbC5IYXNoTWFwOwppbXBvcnQgamF2\nYS51dGlsLkhhc2hTZXQ7CmltcG9ydCBqYXZhLnV0aWwuTWFwOwppbXBvcnQg\namF2YS51dGlsLlNldDsKaW1wb3J0IGphdmF4LnBlcnNpc3RlbmNlLkVtYmVk\nZGFibGU7CmltcG9ydCBqYXZheC5wZXJzaXN0ZW5jZS5FbnRpdHk7CmltcG9y\ndCBqYXZheC5wZXJzaXN0ZW5jZS5NYXBwZWRTdXBlcmNsYXNzOwppbXBvcnQg\namF2YXgucGVyc2lzdGVuY2UuTmFtZWRRdWVyaWVzOwppbXBvcnQgamF2YXgu\ncGVyc2lzdGVuY2UuTmFtZWRRdWVyeTsKaW1wb3J0IGphdmF4LnBlcnNpc3Rl\nbmNlLk5hbWVkTmF0aXZlUXVlcmllczsKaW1wb3J0IGphdmF4LnBlcnNpc3Rl\nbmNlLk5hbWVkTmF0aXZlUXVlcnk7CmltcG9ydCBqYXZheC5wZXJzaXN0ZW5j\nZS5TcWxSZXN1bHRTZXRNYXBwaW5nOwppbXBvcnQgamF2YXgucGVyc2lzdGVu\nY2UuU3FsUmVzdWx0U2V0TWFwcGluZ3M7CgppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLmxpYi5jb25mLkNvbmZpZ3VyYWJsZTsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5saWIuY29uZi5Db25maWd1cmF0aW9uOwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLmxpYi5jb25mLkdlbmVyaWNDb25maWd1cmFibGU7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLm1ldGEuQ2xhc3NBbm5v\ndGF0aW9uTWV0YURhdGFGaWx0ZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEubGliLm1ldGEuQ2xhc3NBcmdQYXJzZXI7CmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEubGliLm1ldGEuTWV0YURhdGFGaWx0ZXI7CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEubGliLm1ldGEuTWV0YURhdGFQYXJzZXI7CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuSjJEb1ByaXY1SGVscGVy\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51dGlsLkxvY2FsaXpl\ncjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIudXRpbC5PcHRpb25z\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuQWJzdHJhY3RDRk1l\ndGFEYXRhRmFjdG9yeTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRh\nLkNsYXNzTWV0YURhdGE7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0\nYS5GaWVsZE1ldGFEYXRhOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1l\ndGEuTWV0YURhdGFEZWZhdWx0czsKaW1wb3J0IG9yZy5hcGFjaGUub3Blbmpw\nYS5tZXRhLk1ldGFEYXRhRmFjdG9yeTsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5tZXRhLlF1ZXJ5TWV0YURhdGE7CmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEubWV0YS5TZXF1ZW5jZU1ldGFEYXRhOwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLnV0aWwuR2VuZXJhbEV4Y2VwdGlvbjsKaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS51dGlsLk1ldGFEYXRhRXhjZXB0aW9uOwoKLyoqCiAq\nIHtAbGluayBNZXRhRGF0YUZhY3Rvcnl9IGZvciBKUEEgbWV0YWRhdGEuCiAq\nCiAqIEBhdXRob3IgU3RldmUgS2ltCiAqIEBzaW5jZSAwLjQuMAogKiBAbm9q\nYXZhZG9jCiAqLwpwdWJsaWMgY2xhc3MgUGVyc2lzdGVuY2VNZXRhRGF0YUZh\nY3RvcnkKICAgIGV4dGVuZHMgQWJzdHJhY3RDRk1ldGFEYXRhRmFjdG9yeQog\nICAgaW1wbGVtZW50cyBDb25maWd1cmFibGUsIEdlbmVyaWNDb25maWd1cmFi\nbGUgewoKICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIExvY2FsaXplciBfbG9j\nID0gTG9jYWxpemVyLmZvclBhY2thZ2UKICAgICAgICAoUGVyc2lzdGVuY2VN\nZXRhRGF0YUZhY3RvcnkuY2xhc3MpOwoKICAgIHByaXZhdGUgZmluYWwgUGVy\nc2lzdGVuY2VNZXRhRGF0YURlZmF1bHRzIF9kZWYgPSAKICAgICAgICBuZXcg\nUGVyc2lzdGVuY2VNZXRhRGF0YURlZmF1bHRzKCk7CiAgICBwcml2YXRlIEFu\nbm90YXRpb25QZXJzaXN0ZW5jZU1ldGFEYXRhUGFyc2VyIF9hbm5vUGFyc2Vy\nID0gbnVsbDsKICAgIHByaXZhdGUgQW5ub3RhdGlvblBlcnNpc3RlbmNlWE1M\nTWV0YURhdGFQYXJzZXIgX2Fubm9YTUxQYXJzZXIgPSBudWxsOwogICAgcHJp\ndmF0ZSBYTUxQZXJzaXN0ZW5jZU1ldGFEYXRhUGFyc2VyIF94bWxQYXJzZXIg\nPSBudWxsOwogICAgcHJpdmF0ZSBNYXA8VVJMLCBTZXQ+IF94bWwgPSBudWxs\nOyAvLyB4bWwgcnNyYyAtPiBjbGFzcyBuYW1lcwogICAgcHJpdmF0ZSBTZXQ8\nVVJMPiBfdW5wYXJzZWQgPSBudWxsOyAvLyB4bWwgcnNyYwogICAgcHJpdmF0\nZSBib29sZWFuIF9maWVsZE92ZXJyaWRlID0gdHJ1ZTsKCiAgICAvKioKICAg\nICAqIFdoZXRoZXIgdG8gdXNlIGZpZWxkLWxldmVsIG92ZXJyaWRlIG9yIGNs\nYXNzLWxldmVsIG92ZXJyaWRlLgogICAgICogRGVmYXVsdHMgdG8gdHJ1ZS4K\nICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0RmllbGRPdmVycmlkZShib29s\nZWFuIGZpZWxkKSB7CiAgICAgICAgX2ZpZWxkT3ZlcnJpZGUgPSBmaWVsZDsK\nICAgIH0KCiAgICAvKioKICAgICAqIFdoZXRoZXIgdG8gdXNlIGZpZWxkLWxl\ndmVsIG92ZXJyaWRlIG9yIGNsYXNzLWxldmVsIG92ZXJyaWRlLgogICAgICog\nRGVmYXVsdHMgdG8gdHJ1ZS4KICAgICAqLwogICAgcHVibGljIGJvb2xlYW4g\nZ2V0RmllbGRPdmVycmlkZSgpIHsKICAgICAgICByZXR1cm4gX2ZpZWxkT3Zl\ncnJpZGU7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gbWV0YWRhdGEg\ncGFyc2VyLCBjcmVhdGluZyBpdCBpZiBpdCBkb2VzIG5vdCBhbHJlYWR5IGV4\naXN0LgogICAgICovCiAgICBwdWJsaWMgQW5ub3RhdGlvblBlcnNpc3RlbmNl\nTWV0YURhdGFQYXJzZXIgZ2V0QW5ub3RhdGlvblBhcnNlcigpIHsKICAgICAg\nICBpZiAoX2Fubm9QYXJzZXIgPT0gbnVsbCkgewogICAgICAgICAgICBfYW5u\nb1BhcnNlciA9IG5ld0Fubm90YXRpb25QYXJzZXIoKTsKICAgICAgICAgICAg\nX2Fubm9QYXJzZXIuc2V0UmVwb3NpdG9yeShyZXBvcyk7CiAgICAgICAgfQog\nICAgICAgIHJldHVybiBfYW5ub1BhcnNlcjsKICAgIH0KCiAgICAvKioKICAg\nICAqIFNldCB0aGUgbWV0YWRhdGEgcGFyc2VyLgogICAgICovCiAgICBwdWJs\naWMgdm9pZCBzZXRBbm5vdGF0aW9uUGFyc2VyKAogICAgICAgIEFubm90YXRp\nb25QZXJzaXN0ZW5jZU1ldGFEYXRhUGFyc2VyIHBhcnNlcikgewogICAgICAg\nIGlmIChfYW5ub1BhcnNlciAhPSBudWxsKQogICAgICAgICAgICBfYW5ub1Bh\ncnNlci5zZXRSZXBvc2l0b3J5KG51bGwpOwogICAgICAgIGlmIChwYXJzZXIg\nIT0gbnVsbCkKICAgICAgICAgICAgcGFyc2VyLnNldFJlcG9zaXRvcnkocmVw\nb3MpOwogICAgICAgIF9hbm5vUGFyc2VyID0gcGFyc2VyOwogICAgfQoKICAg\nIC8qKgogICAgICogQ3JlYXRlIGEgbmV3IG1ldGFkYXRhIHBhcnNlci4KICAg\nICAqLwogICAgcHJvdGVjdGVkIEFubm90YXRpb25QZXJzaXN0ZW5jZU1ldGFE\nYXRhUGFyc2VyIG5ld0Fubm90YXRpb25QYXJzZXIoKSB7CiAgICAgICAgcmV0\ndXJuIG5ldyBBbm5vdGF0aW9uUGVyc2lzdGVuY2VNZXRhRGF0YVBhcnNlcgog\nICAgICAgICAgICAocmVwb3MuZ2V0Q29uZmlndXJhdGlvbigpKTsKICAgIH0K\nCiAgICAvKioKICAgICAqIENyZWF0ZSBhIG5ldyBhbm5vdGF0aW9uIHNlcmlh\nbGl6ZXIuCiAgICAgKi8KICAgIHByb3RlY3RlZCBBbm5vdGF0aW9uUGVyc2lz\ndGVuY2VNZXRhRGF0YVNlcmlhbGl6ZXIKICAgICAgICBuZXdBbm5vdGF0aW9u\nU2VyaWFsaXplcigpIHsKICAgICAgICByZXR1cm4gbmV3IEFubm90YXRpb25Q\nZXJzaXN0ZW5jZU1ldGFEYXRhU2VyaWFsaXplcgogICAgICAgICAgICAocmVw\nb3MuZ2V0Q29uZmlndXJhdGlvbigpKTsKICAgIH0KCiAgICAvKioKICAgICAq\nIFJldHVybiBYTUwgbWV0YWRhdGEgcGFyc2VyLCBjcmVhdGluZyBpdCBpZiBp\ndCBkb2VzIG5vdCBhbHJlYWR5IGV4aXN0LgogICAgICovCiAgICBwdWJsaWMg\nWE1MUGVyc2lzdGVuY2VNZXRhRGF0YVBhcnNlciBnZXRYTUxQYXJzZXIoKSB7\nCiAgICAgICAgaWYgKF94bWxQYXJzZXIgPT0gbnVsbCkgewogICAgICAgICAg\nICBfeG1sUGFyc2VyID0gbmV3WE1MUGFyc2VyKHRydWUpOwogICAgICAgICAg\nICBfeG1sUGFyc2VyLnNldFJlcG9zaXRvcnkocmVwb3MpOwogICAgICAgICAg\nICBpZiAoX2ZpZWxkT3ZlcnJpZGUpCiAgICAgICAgICAgICAgICBfeG1sUGFy\nc2VyLnNldEFubm90YXRpb25QYXJzZXIoZ2V0QW5ub3RhdGlvblBhcnNlcigp\nKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIF94bWxQYXJzZXI7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBTZXQgdGhlIG1ldGFkYXRhIHBhcnNlci4KICAg\nICAqLwogICAgcHVibGljIHZvaWQgc2V0WE1MUGFyc2VyKFhNTFBlcnNpc3Rl\nbmNlTWV0YURhdGFQYXJzZXIgcGFyc2VyKSB7CiAgICAgICAgaWYgKF94bWxQ\nYXJzZXIgIT0gbnVsbCkKICAgICAgICAgICAgX3htbFBhcnNlci5zZXRSZXBv\nc2l0b3J5KG51bGwpOwogICAgICAgIGlmIChwYXJzZXIgIT0gbnVsbCkKICAg\nICAgICAgICAgcGFyc2VyLnNldFJlcG9zaXRvcnkocmVwb3MpOwogICAgICAg\nIF94bWxQYXJzZXIgPSBwYXJzZXI7CiAgICB9CgogICAgLyoqCiAgICAgKiBD\ncmVhdGUgYSBuZXcgbWV0YWRhdGEgcGFyc2VyLgogICAgICovCiAgICBwcm90\nZWN0ZWQgWE1MUGVyc2lzdGVuY2VNZXRhRGF0YVBhcnNlciBuZXdYTUxQYXJz\nZXIoYm9vbGVhbiBsb2FkaW5nKSB7CiAgICAgICAgcmV0dXJuIG5ldyBYTUxQ\nZXJzaXN0ZW5jZU1ldGFEYXRhUGFyc2VyKHJlcG9zLmdldENvbmZpZ3VyYXRp\nb24oKSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBDcmVhdGUgYSBuZXcgc2Vy\naWFsaXplcgogICAgICovCiAgICBwcm90ZWN0ZWQgWE1MUGVyc2lzdGVuY2VN\nZXRhRGF0YVNlcmlhbGl6ZXIgbmV3WE1MU2VyaWFsaXplcigpIHsKICAgICAg\nICByZXR1cm4gbmV3IFhNTFBlcnNpc3RlbmNlTWV0YURhdGFTZXJpYWxpemVy\nKHJlcG9zLmdldENvbmZpZ3VyYXRpb24oKSk7CiAgICB9CgogICAgcHVibGlj\nIHZvaWQgbG9hZChDbGFzcyBjbHMsIGludCBtb2RlLCBDbGFzc0xvYWRlciBl\nbnZMb2FkZXIpIHsKICAgICAgICBpZiAobW9kZSA9PSBNT0RFX05PTkUpCiAg\nICAgICAgICAgIHJldHVybjsKICAgICAgICBpZiAoIXN0cmljdCAmJiAobW9k\nZSAmIE1PREVfTUVUQSkgIT0gMCkKICAgICAgICAgICAgbW9kZSB8PSBNT0RF\nX01BUFBJTkc7CgogICAgICAgIC8vIGdldHRpbmcgdGhlIGxpc3Qgb2YgcGVy\nc2lzdGVudCB0eXBlcyBydW5zIGNhbGxiYWNrcyB0bwogICAgICAgIC8vIG1h\ncFBlcnNpc3RlbnRUeXBlTmFtZXMgaWYgaXQgaGFzbid0IGJlZW4gY2FsbGVk\nIGFscmVhZHksIHdoaWNoCiAgICAgICAgLy8gY2FjaGVzIFhNTCByZXNvdXJj\nZXMKICAgICAgICBnZXRQZXJzaXN0ZW50VHlwZU5hbWVzKGZhbHNlLCBlbnZM\nb2FkZXIpOwogICAgICAgIFVSTCB4bWwgPSBmaW5kWE1MKGNscyk7CgogICAg\nICAgIC8vIHdlIGhhdmUgdG8gcGFyc2UgbWV0YWRhdGEgdXAtZnJvbnQgdG8g\ncmVnaXN0ZXIgcGVyc2lzdGVuY2UgdW5pdAogICAgICAgIC8vIGRlZmF1bHRz\nIGFuZCBzeXN0ZW0gY2FsbGJhY2tzCiAgICAgICAgQ2xhc3NNZXRhRGF0YSBt\nZXRhOwogICAgICAgIGJvb2xlYW4gcGFyc2VkWE1MID0gZmFsc2U7CiAgICAg\nICAgaWYgKF91bnBhcnNlZCAhPSBudWxsICYmICFfdW5wYXJzZWQuaXNFbXB0\neSgpCiAgICAgICAgICAgICYmIChtb2RlICYgTU9ERV9NRVRBKSAhPSAwKSB7\nCiAgICAgICAgICAgIGZvciAoVVJMIHVybCA6IF91bnBhcnNlZCkKICAgICAg\nICAgICAgICAgIHBhcnNlWE1MKHVybCwgY2xzLCBtb2RlLCBlbnZMb2FkZXIp\nOwogICAgICAgICAgICBwYXJzZWRYTUwgPSBfdW5wYXJzZWQuY29udGFpbnMo\neG1sKTsKICAgICAgICAgICAgX3VucGFyc2VkLmNsZWFyKCk7CgogICAgICAg\nICAgICAvLyBYTUwgcHJvY2VzcyBjaGVjawogICAgICAgICAgICBtZXRhID0g\ncmVwb3MuZ2V0Q2FjaGVkTWV0YURhdGEoY2xzKTsKICAgICAgICAgICAgaWYg\nKG1ldGEgIT0gbnVsbCAmJiAobWV0YS5nZXRTb3VyY2VNb2RlKCkgJiBtb2Rl\nKSA9PSBtb2RlKSB7CiAgICAgICAgICAgICAgICB2YWxpZGF0ZVN0cmF0ZWdp\nZXMobWV0YSk7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAg\nIH0KICAgICAgICB9CgogICAgICAgIC8vIG1pZ2h0IGhhdmUgYmVlbiBsb29r\naW5nIGZvciBzeXN0ZW0tbGV2ZWwgcXVlcnkKICAgICAgICBpZiAoY2xzID09\nIG51bGwpCiAgICAgICAgICAgIHJldHVybjsKCiAgICAgICAgLy8gd2UgbWF5\nIHN0aWxsIG5lZWQgdG8gcGFyc2UgWE1MIGlmIHRoaXMgaXMgYSByZWRlcGxv\neSBvZiBhIGNsYXNzLCBvcgogICAgICAgIC8vIGlmIHdlJ3JlIGluIHN0cmlj\ndCBxdWVyeS1vbmx5IG1vZGUKICAgICAgICBpZiAoIXBhcnNlZFhNTCAmJiB4\nbWwgIT0gbnVsbCkgewogICAgICAgICAgICBwYXJzZVhNTCh4bWwsIGNscywg\nbW9kZSwgZW52TG9hZGVyKTsKICAgICAgICAgICAgLy8gWE1MIHByb2Nlc3Mg\nY2hlY2sKICAgICAgICAgICAgbWV0YSA9IHJlcG9zLmdldENhY2hlZE1ldGFE\nYXRhKGNscyk7CiAgICAgICAgICAgIGlmIChtZXRhICE9IG51bGwgJiYgKG1l\ndGEuZ2V0U291cmNlTW9kZSgpICYgbW9kZSkgPT0gbW9kZSkgewogICAgICAg\nICAgICAgICAgdmFsaWRhdGVTdHJhdGVnaWVzKG1ldGEpOwogICAgICAgICAg\nICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAg\nICBBbm5vdGF0aW9uUGVyc2lzdGVuY2VNZXRhRGF0YVBhcnNlciBwYXJzZXIg\nPSBnZXRBbm5vdGF0aW9uUGFyc2VyKCk7CiAgICAgICAgcGFyc2VyLnNldEVu\ndkNsYXNzTG9hZGVyKGVudkxvYWRlcik7CiAgICAgICAgcGFyc2VyLnNldE1v\nZGUobW9kZSk7CiAgICAgICAgcGFyc2VyLnBhcnNlKGNscyk7CgogICAgICAg\nIG1ldGEgPSByZXBvcy5nZXRDYWNoZWRNZXRhRGF0YShjbHMpOwogICAgICAg\nIGlmIChtZXRhICE9IG51bGwgJiYgKG1ldGEuZ2V0U291cmNlTW9kZSgpICYg\nbW9kZSkgPT0gbW9kZSkKICAgICAgICAgICAgdmFsaWRhdGVTdHJhdGVnaWVz\nKG1ldGEpOwogICAgfQoKICAgIC8qKgogICAgICogUGFyc2UgdGhlIGdpdmVu\nIFhNTCByZXNvdXJjZS4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIHBhcnNl\nWE1MKFVSTCB4bWwsIENsYXNzIGNscywgaW50IG1vZGUsIENsYXNzTG9hZGVy\nIGVudkxvYWRlcikgewogICAgICAgIENsYXNzTG9hZGVyIGxvYWRlciA9IHJl\ncG9zLmdldENvbmZpZ3VyYXRpb24oKS4KICAgICAgICAgICAgZ2V0Q2xhc3NS\nZXNvbHZlckluc3RhbmNlKCkuZ2V0Q2xhc3NMb2FkZXIoY2xzLCBlbnZMb2Fk\nZXIpOwogICAgICAgIFhNTFBlcnNpc3RlbmNlTWV0YURhdGFQYXJzZXIgeG1s\nUGFyc2VyID0gZ2V0WE1MUGFyc2VyKCk7CiAgICAgICAgeG1sUGFyc2VyLnNl\ndENsYXNzTG9hZGVyKGVudkxvYWRlciAhPSBudWxsID8gZW52TG9hZGVyIDog\nbG9hZGVyKTsKICAgICAgICB4bWxQYXJzZXIuc2V0RW52Q2xhc3NMb2FkZXIo\nZW52TG9hZGVyKTsKICAgICAgICB4bWxQYXJzZXIuc2V0TW9kZShtb2RlKTsK\nICAgICAgICB0cnkgewogICAgICAgICAgICB4bWxQYXJzZXIucGFyc2UoeG1s\nKTsKICAgICAgICB9IGNhdGNoIChJT0V4Y2VwdGlvbiBpb2UpIHsKICAgICAg\nICAgICAgdGhyb3cgbmV3IEdlbmVyYWxFeGNlcHRpb24oaW9lKTsKICAgICAg\nICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBMb2NhdGUgdGhlIFhNTCByZXNv\ndXJjZSBmb3IgdGhlIGdpdmVuIGNsYXNzLgogICAgICovCiAgICBwcml2YXRl\nIFVSTCBmaW5kWE1MKENsYXNzIGNscykgewogICAgICAgIGlmIChfeG1sICE9\nIG51bGwgJiYgY2xzICE9IG51bGwpCiAgICAgICAgICAgIGZvciAoTWFwLkVu\ndHJ5PFVSTCwgU2V0PiBlbnRyeSA6IF94bWwuZW50cnlTZXQoKSkKICAgICAg\nICAgICAgICAgIGlmIChlbnRyeS5nZXRWYWx1ZSgpLmNvbnRhaW5zKGNscy5n\nZXROYW1lKCkpKQogICAgICAgICAgICAgICAgICAgIHJldHVybiBlbnRyeS5n\nZXRLZXkoKTsKICAgICAgICByZXR1cm4gbnVsbDsKICAgIH0KCiAgICBAT3Zl\ncnJpZGUKICAgIHByb3RlY3RlZCB2b2lkIG1hcFBlcnNpc3RlbnRUeXBlTmFt\nZXMoT2JqZWN0IHJzcmMsIFN0cmluZ1tdIG5hbWVzKSB7CiAgICAgICAgaWYg\nKHJzcmMudG9TdHJpbmcoKS5lbmRzV2l0aCgiLmNsYXNzIikpIHsKICAgICAg\nICAgICAgaWYgKGxvZy5pc1RyYWNlRW5hYmxlZCgpKQogICAgICAgICAgICAg\nICAgbG9nLnRyYWNlKAogICAgICAgICAgICAgICAgICAgIF9sb2MuZ2V0KCJt\nYXAtcGVyc2lzdGVudC10eXBlcy1za2lwcGluZy1jbGFzcyIsIHJzcmMpKTsK\nICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0gZWxzZSBpZiAoIShyc3Jj\nIGluc3RhbmNlb2YgVVJMKSkgewogICAgICAgICAgICBpZiAobG9nLmlzVHJh\nY2VFbmFibGVkKCkpCiAgICAgICAgICAgICAgICBsb2cudHJhY2UoCiAgICAg\nICAgICAgICAgICAgICAgX2xvYy5nZXQoIm1hcC1wZXJzaXN0ZW50LXR5cGVz\nLXNraXBwaW5nLW5vbi11cmwiLCByc3JjKSk7CiAgICAgICAgICAgIHJldHVy\nbjsKICAgICAgICB9CgogICAgICAgIGlmIChsb2cuaXNUcmFjZUVuYWJsZWQo\nKSkKICAgICAgICAgICAgbG9nLnRyYWNlKF9sb2MuZ2V0KAogICAgICAgICAg\nICAgICAgIm1hcC1wZXJzaXN0ZW50LXR5cGUtbmFtZXMiLCByc3JjLCBBcnJh\neXMuYXNMaXN0KG5hbWVzKSkpOwogICAgICAgIAogICAgICAgIGlmIChfeG1s\nID09IG51bGwpCiAgICAgICAgICAgIF94bWwgPSBuZXcgSGFzaE1hcDxVUkws\nIFNldD4oKTsKICAgICAgICBfeG1sLnB1dCgoVVJMKSByc3JjLCBuZXcgSGFz\naFNldChBcnJheXMuYXNMaXN0KG5hbWVzKSkpOwogICAgICAgIGlmIChfdW5w\nYXJzZWQgPT0gbnVsbCkKICAgICAgICAgICAgX3VucGFyc2VkID0gbmV3IEhh\nc2hTZXQ8VVJMPigpOwogICAgICAgIF91bnBhcnNlZC5hZGQoKFVSTCkgcnNy\nYyk7CiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgQ2xhc3MgZ2V0\nUXVlcnlTY29wZShTdHJpbmcgcXVlcnlOYW1lLCBDbGFzc0xvYWRlciBsb2Fk\nZXIpIHsKICAgICAgICBpZiAocXVlcnlOYW1lID09IG51bGwpCiAgICAgICAg\nICAgIHJldHVybiBudWxsOwogICAgICAgIENvbGxlY3Rpb24gY2xhc3NlcyA9\nIHJlcG9zLmxvYWRQZXJzaXN0ZW50VHlwZXMoZmFsc2UsIGxvYWRlcik7CiAg\nICAgICAgZm9yIChDbGFzcyBjbHMgOiAoQ29sbGVjdGlvbjxDbGFzcz4pIGNs\nYXNzZXMpIHsKICAgICAgICAgICAgaWYgKCgoQm9vbGVhbikgQWNjZXNzQ29u\ndHJvbGxlci5kb1ByaXZpbGVnZWQoSjJEb1ByaXY1SGVscGVyCiAgICAgICAg\nICAgICAgICAuaXNBbm5vdGF0aW9uUHJlc2VudEFjdGlvbihjbHMsIE5hbWVk\nUXVlcnkuY2xhc3MpKSkKICAgICAgICAgICAgICAgIC5ib29sZWFuVmFsdWUo\nKSAmJiBoYXNOYW1lZFF1ZXJ5CiAgICAgICAgICAgICAgICAocXVlcnlOYW1l\nLCAoTmFtZWRRdWVyeSkgY2xzLmdldEFubm90YXRpb24oTmFtZWRRdWVyeS5j\nbGFzcykpKQogICAgICAgICAgICAgICAgcmV0dXJuIGNsczsKICAgICAgICAg\nICAgaWYgKCgoQm9vbGVhbikgQWNjZXNzQ29udHJvbGxlci5kb1ByaXZpbGVn\nZWQoSjJEb1ByaXY1SGVscGVyCiAgICAgICAgICAgICAgICAuaXNBbm5vdGF0\naW9uUHJlc2VudEFjdGlvbihjbHMsIE5hbWVkUXVlcmllcy5jbGFzcykpKQog\nICAgICAgICAgICAgICAgLmJvb2xlYW5WYWx1ZSgpICYmCiAgICAgICAgICAg\nICAgICBoYXNOYW1lZFF1ZXJ5KHF1ZXJ5TmFtZSwgKChOYW1lZFF1ZXJpZXMp\nIGNscy4KICAgICAgICAgICAgICAgICAgICBnZXRBbm5vdGF0aW9uKE5hbWVk\nUXVlcmllcy5jbGFzcykpLnZhbHVlKCkpKQogICAgICAgICAgICAgICAgcmV0\ndXJuIGNsczsKICAgICAgICAgICAgaWYgKCgoQm9vbGVhbikgQWNjZXNzQ29u\ndHJvbGxlci5kb1ByaXZpbGVnZWQoSjJEb1ByaXY1SGVscGVyCiAgICAgICAg\nICAgICAgICAuaXNBbm5vdGF0aW9uUHJlc2VudEFjdGlvbihjbHMsIE5hbWVk\nTmF0aXZlUXVlcnkuY2xhc3MpKSkKICAgICAgICAgICAgICAgIC5ib29sZWFu\nVmFsdWUoKSAmJgogICAgICAgICAgICAgICAgaGFzTmFtZWROYXRpdmVRdWVy\neShxdWVyeU5hbWUsIChOYW1lZE5hdGl2ZVF1ZXJ5KSBjbHMuCiAgICAgICAg\nICAgICAgICAgICAgZ2V0QW5ub3RhdGlvbihOYW1lZE5hdGl2ZVF1ZXJ5LmNs\nYXNzKSkpCiAgICAgICAgICAgICAgICByZXR1cm4gY2xzOwogICAgICAgICAg\nICBpZiAoKChCb29sZWFuKSBBY2Nlc3NDb250cm9sbGVyLmRvUHJpdmlsZWdl\nZChKMkRvUHJpdjVIZWxwZXIKICAgICAgICAgICAgICAgIC5pc0Fubm90YXRp\nb25QcmVzZW50QWN0aW9uKGNscywgTmFtZWROYXRpdmVRdWVyaWVzLmNsYXNz\nKSkpCiAgICAgICAgICAgICAgICAuYm9vbGVhblZhbHVlKCkgJiYKICAgICAg\nICAgICAgICAgIGhhc05hbWVkTmF0aXZlUXVlcnkocXVlcnlOYW1lLCAoKE5h\nbWVkTmF0aXZlUXVlcmllcykgY2xzLgogICAgICAgICAgICAgICAgICAgIGdl\ndEFubm90YXRpb24oTmFtZWROYXRpdmVRdWVyaWVzLmNsYXNzKSkudmFsdWUo\nKSkpCiAgICAgICAgICAgICAgICByZXR1cm4gY2xzOwogICAgICAgIH0KICAg\nICAgICByZXR1cm4gbnVsbDsKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHB1\nYmxpYyBDbGFzcyBnZXRSZXN1bHRTZXRNYXBwaW5nU2NvcGUoU3RyaW5nIHJz\nTWFwcGluZ05hbWUsCiAgICAgICAgQ2xhc3NMb2FkZXIgbG9hZGVyKSB7CiAg\nICAgICAgaWYgKHJzTWFwcGluZ05hbWUgPT0gbnVsbCkKICAgICAgICAgICAg\ncmV0dXJuIG51bGw7CiAgICAgICAgCiAgICAgICAgQ29sbGVjdGlvbiBjbGFz\nc2VzID0gcmVwb3MubG9hZFBlcnNpc3RlbnRUeXBlcyhmYWxzZSwgbG9hZGVy\nKTsKICAgICAgICBmb3IgKENsYXNzIGNscyA6IChDb2xsZWN0aW9uPENsYXNz\nPikgY2xhc3NlcykgewoKICAgICAgICAgICAgaWYgKCgoQm9vbGVhbikgQWNj\nZXNzQ29udHJvbGxlci5kb1ByaXZpbGVnZWQoSjJEb1ByaXY1SGVscGVyCiAg\nICAgICAgICAgICAgICAuaXNBbm5vdGF0aW9uUHJlc2VudEFjdGlvbihjbHMs\nIFNxbFJlc3VsdFNldE1hcHBpbmcuY2xhc3MpKSkKICAgICAgICAgICAgICAg\nIC5ib29sZWFuVmFsdWUoKSAmJgogICAgICAgICAgICAgICAgaGFzUlNNYXBw\naW5nKHJzTWFwcGluZ05hbWUsIChTcWxSZXN1bHRTZXRNYXBwaW5nKSBjbHMu\nCiAgICAgICAgICAgICAgICBnZXRBbm5vdGF0aW9uKFNxbFJlc3VsdFNldE1h\ncHBpbmcuY2xhc3MpKSkKICAgICAgICAgICAgICAgIHJldHVybiBjbHM7Cgog\nICAgICAgICAgICBpZiAoKChCb29sZWFuKSBBY2Nlc3NDb250cm9sbGVyLmRv\nUHJpdmlsZWdlZChKMkRvUHJpdjVIZWxwZXIKICAgICAgICAgICAgICAgIC5p\nc0Fubm90YXRpb25QcmVzZW50QWN0aW9uKGNscywgU3FsUmVzdWx0U2V0TWFw\ncGluZ3MuY2xhc3MpKSkKICAgICAgICAgICAgICAgIC5ib29sZWFuVmFsdWUo\nKSAmJgogICAgICAgICAgICAgICAgaGFzUlNNYXBwaW5nKHJzTWFwcGluZ05h\nbWUsICgoU3FsUmVzdWx0U2V0TWFwcGluZ3MpIGNscy4KICAgICAgICAgICAg\nICAgIGdldEFubm90YXRpb24oU3FsUmVzdWx0U2V0TWFwcGluZ3MuY2xhc3Mp\nKS52YWx1ZSgpKSkKICAgICAgICAgICAgICAgIHJldHVybiBjbHM7CiAgICAg\nICAgfQogICAgICAgIHJldHVybiBudWxsOwogICAgfQoKICAgIHByaXZhdGUg\nYm9vbGVhbiBoYXNOYW1lZFF1ZXJ5KFN0cmluZyBxdWVyeSwgTmFtZWRRdWVy\neS4uLiBxdWVyaWVzKSB7CiAgICAgICAgZm9yIChOYW1lZFF1ZXJ5IHEgOiBx\ndWVyaWVzKSB7CiAgICAgICAgICAgIGlmIChxdWVyeS5lcXVhbHMocS5uYW1l\nKCkpKQogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQog\nICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICBwcml2YXRlIGJvb2xl\nYW4gaGFzUlNNYXBwaW5nKFN0cmluZyByc01hcHBpbmcsCiAgICAgICAgU3Fs\nUmVzdWx0U2V0TWFwcGluZy4uLiBtYXBwaW5ncykgewogICAgICAgIGZvciAo\nU3FsUmVzdWx0U2V0TWFwcGluZyBtIDogbWFwcGluZ3MpIHsKICAgICAgICAg\nICAgaWYgKHJzTWFwcGluZy5lcXVhbHMobS5uYW1lKCkpKQogICAgICAgICAg\nICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQogICAgICAgIHJldHVybiBm\nYWxzZTsKICAgIH0KCiAgICBwcml2YXRlIGJvb2xlYW4gaGFzTmFtZWROYXRp\ndmVRdWVyeShTdHJpbmcgcXVlcnksCiAgICAgICAgTmFtZWROYXRpdmVRdWVy\neS4uLiBxdWVyaWVzKSB7CiAgICAgICAgZm9yIChOYW1lZE5hdGl2ZVF1ZXJ5\nIHEgOiBxdWVyaWVzKSB7CiAgICAgICAgICAgIGlmIChxdWVyeS5lcXVhbHMo\ncS5uYW1lKCkpKQogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAg\nICAgfQogICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICBAT3ZlcnJp\nZGUKICAgIHByb3RlY3RlZCBNZXRhRGF0YUZpbHRlciBuZXdNZXRhRGF0YUZp\nbHRlcigpIHsKICAgICAgICBDbGFzc0Fubm90YXRpb25NZXRhRGF0YUZpbHRl\nciBjYW1kZiA9IG5ldyBDbGFzc0Fubm90YXRpb25NZXRhRGF0YUZpbHRlcigK\nICAgICAgICAgICAgICAgIG5ldyBDbGFzc1tdIHsgRW50aXR5LmNsYXNzLCBF\nbWJlZGRhYmxlLmNsYXNzLAogICAgICAgICAgICAgICAgICAgICAgICBNYXBw\nZWRTdXBlcmNsYXNzLmNsYXNzIH0pOwogICAgICAgIGNhbWRmLnNldExvZyhs\nb2cpOwogICAgICAgIHJldHVybiBjYW1kZjsKICAgIH0KCiAgICAvKioKICAg\nICAqIEVuc3VyZSBhbGwgZmllbGRzIGhhdmUgZGVjbGFyZWQgYSBzdHJhdGVn\neS4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIHZhbGlkYXRlU3RyYXRlZ2ll\ncyhDbGFzc01ldGFEYXRhIG1ldGEpIHsKICAgICAgICBTdHJpbmdCdWZmZXIg\nYnVmID0gbnVsbDsKICAgICAgICBmb3IgKEZpZWxkTWV0YURhdGEgZm1kIDog\nbWV0YS5nZXREZWNsYXJlZEZpZWxkcygpKSB7CiAgICAgICAgICAgIGlmICgh\nZm1kLmlzRXhwbGljaXQoKSkgewogICAgICAgICAgICAgICAgaWYgKGJ1ZiA9\nPSBudWxsKQogICAgICAgICAgICAgICAgICAgIGJ1ZiA9IG5ldyBTdHJpbmdC\ndWZmZXIoKTsKICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAg\nICAgICBidWYuYXBwZW5kKCIsICIpOwogICAgICAgICAgICAgICAgYnVmLmFw\ncGVuZChmbWQpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGlm\nIChidWYgIT0gbnVsbCkKICAgICAgICAgICAgdGhyb3cgbmV3IE1ldGFEYXRh\nRXhjZXB0aW9uKF9sb2MuZ2V0KCJuby1wZXJzLXN0cmF0IiwgYnVmKSk7CiAg\nICB9CgogICAgcHVibGljIE1ldGFEYXRhRGVmYXVsdHMgZ2V0RGVmYXVsdHMo\nKSB7CiAgICAgICAgcmV0dXJuIF9kZWY7CiAgICB9CgogICAgQE92ZXJyaWRl\nCiAgICBwdWJsaWMgQ2xhc3NBcmdQYXJzZXIgbmV3Q2xhc3NBcmdQYXJzZXIo\nKSB7CiAgICAgICAgQ2xhc3NBcmdQYXJzZXIgcGFyc2VyID0gbmV3IENsYXNz\nQXJnUGFyc2VyKCk7CiAgICAgICAgcGFyc2VyLnNldE1ldGFEYXRhU3RydWN0\ndXJlKCJwYWNrYWdlIiwgbnVsbCwgbmV3IFN0cmluZ1tdewogICAgICAgICAg\nICAiZW50aXR5IiwgImVtYmVkZGFibGUiLCAibWFwcGVkLXN1cGVyY2xhc3Mi\nIH0sICJjbGFzcyIpOwogICAgICAgIHJldHVybiBwYXJzZXI7CiAgICB9Cgog\nICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgdm9pZCBjbGVhcigpIHsKICAgICAg\nICBzdXBlci5jbGVhcigpOwogICAgICAgIGlmIChfYW5ub1BhcnNlciAhPSBu\ndWxsKQogICAgICAgICAgICBfYW5ub1BhcnNlci5jbGVhcigpOwogICAgICAg\nIGlmIChfeG1sUGFyc2VyICE9IG51bGwpCiAgICAgICAgICAgIF94bWxQYXJz\nZXIuY2xlYXIoKTsKICAgICAgICBpZiAoX3htbCAhPSBudWxsKQogICAgICAg\nICAgICBfeG1sLmNsZWFyKCk7CiAgICB9CgogICAgcHJvdGVjdGVkIFBhcnNl\nciBuZXdQYXJzZXIoYm9vbGVhbiBsb2FkaW5nKSB7CiAgICAgICAgcmV0dXJu\nIG5ld1hNTFBhcnNlcihsb2FkaW5nKTsKICAgIH0KCiAgICBwcm90ZWN0ZWQg\nU2VyaWFsaXplciBuZXdTZXJpYWxpemVyKCkgewogICAgICAgIHJldHVybiBu\nZXdYTUxTZXJpYWxpemVyKCk7CiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBw\ncm90ZWN0ZWQgdm9pZCBwYXJzZShNZXRhRGF0YVBhcnNlciBwYXJzZXIsIENs\nYXNzW10gY2xzKSB7CiAgICAgICAgcGFyc2UocGFyc2VyLCBDb2xsZWN0aW9u\ncy5zaW5nbGV0b24oZGVmYXVsdFhNTEZpbGUoKSkpOwogICAgfQoKICAgIHBy\nb3RlY3RlZCBGaWxlIGRlZmF1bHRTb3VyY2VGaWxlKENsYXNzTWV0YURhdGEg\nbWV0YSkgewogICAgICAgIHJldHVybiBkZWZhdWx0WE1MRmlsZSgpOwogICAg\nfQoKICAgIHByb3RlY3RlZCBGaWxlIGRlZmF1bHRTb3VyY2VGaWxlKFF1ZXJ5\nTWV0YURhdGEgcXVlcnksIE1hcCBjbHNOYW1lcykgewogICAgICAgIENsYXNz\nTWV0YURhdGEgbWV0YSA9IGdldERlZmluaW5nTWV0YURhdGEocXVlcnksIGNs\nc05hbWVzKTsKICAgICAgICBGaWxlIGZpbGUgPSAobWV0YSA9PSBudWxsKSA/\nIG51bGwgOiBtZXRhLmdldFNvdXJjZUZpbGUoKTsKICAgICAgICBpZiAoZmls\nZSAhPSBudWxsKQogICAgICAgICAgICByZXR1cm4gZmlsZTsKICAgICAgICBy\nZXR1cm4gZGVmYXVsdFhNTEZpbGUoKTsKICAgIH0KCiAgICBwcm90ZWN0ZWQg\nRmlsZSBkZWZhdWx0U291cmNlRmlsZShTZXF1ZW5jZU1ldGFEYXRhIHNlcSwg\nTWFwIGNsc05hbWVzKSB7CiAgICAgICAgcmV0dXJuIGRlZmF1bHRYTUxGaWxl\nKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBMb29rIGZvciBNRVRBLUlORi9v\ncm0ueG1sLCBhbmQgaWYgaXQgZG9lc24ndCBleGlzdCwgY2hvb3NlIGEgZGVm\nYXVsdC4KICAgICAqLwogICAgcHJpdmF0ZSBGaWxlIGRlZmF1bHRYTUxGaWxl\nKCkgewogICAgICAgIENsYXNzTG9hZGVyIGxvYWRlciA9IHJlcG9zLmdldENv\nbmZpZ3VyYXRpb24oKS4KICAgICAgICAgICAgZ2V0Q2xhc3NSZXNvbHZlcklu\nc3RhbmNlKCkuZ2V0Q2xhc3NMb2FkZXIoZ2V0Q2xhc3MoKSwgbnVsbCk7CiAg\nICAgICAgVVJMIHJzcmMgPSAoVVJMKSBBY2Nlc3NDb250cm9sbGVyLmRvUHJp\ndmlsZWdlZCgKICAgICAgICAgICAgSjJEb1ByaXY1SGVscGVyLmdldFJlc291\ncmNlQWN0aW9uKGxvYWRlciwgIk1FVEEtSU5GL29ybS54bWwiKSk7CiAgICAg\nICAgaWYgKHJzcmMgIT0gbnVsbCkgewogICAgICAgICAgICBGaWxlIGZpbGUg\nPSBuZXcgRmlsZShyc3JjLmdldEZpbGUoKSk7CiAgICAgICAgICAgIGlmICgo\nKEJvb2xlYW4pIEFjY2Vzc0NvbnRyb2xsZXIuZG9Qcml2aWxlZ2VkKAogICAg\nICAgICAgICAgICAgSjJEb1ByaXY1SGVscGVyLmV4aXN0c0FjdGlvbihmaWxl\nKSkpLmJvb2xlYW5WYWx1ZSgpKQogICAgICAgICAgICAgICAgcmV0dXJuIGZp\nbGU7CiAgICAgICAgfQogICAgICAgIHJldHVybiBuZXcgRmlsZSgib3JtLnht\nbCIpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldENvbmZpZ3VyYXRpb24o\nQ29uZmlndXJhdGlvbiBjb25mKSB7CiAgICB9CgogICAgcHVibGljIHZvaWQg\nc3RhcnRDb25maWd1cmF0aW9uKCkgewogICAgfQoKICAgIHB1YmxpYyB2b2lk\nIGVuZENvbmZpZ3VyYXRpb24oKSB7CiAgICAgICAgaWYgKHJzcmNzID09IG51\nbGwpCiAgICAgICAgICAgIHJzcmNzID0gQ29sbGVjdGlvbnMuc2luZ2xldG9u\nKCJNRVRBLUlORi9vcm0ueG1sIik7CiAgICAgICAgZWxzZQoJCQlyc3Jjcy5h\nZGQoIk1FVEEtSU5GL29ybS54bWwiKTsKCX0KCiAgICBwdWJsaWMgdm9pZCBz\nZXRJbnRvKE9wdGlvbnMgb3B0cykgewogICAgICAgIG9wdHMua2V5U2V0KCku\ncmV0YWluQWxsKG9wdHMuc2V0SW50byhfZGVmKS5rZXlTZXQoKSk7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBSZXR1cm4gSkFYQiBYTUwgYW5ub3RhdGlvbiBw\nYXJzZXIsIAogICAgICogY3JlYXRpbmcgaXQgaWYgaXQgZG9lcyBub3QgYWxy\nZWFkeSBleGlzdC4KICAgICAqLwogICAgcHVibGljIEFubm90YXRpb25QZXJz\naXN0ZW5jZVhNTE1ldGFEYXRhUGFyc2VyIGdldFhNTEFubm90YXRpb25QYXJz\nZXIoKSB7CiAgICAgICAgaWYgKF9hbm5vWE1MUGFyc2VyID09IG51bGwpIHsK\nICAgICAgICAgICAgX2Fubm9YTUxQYXJzZXIgPSBuZXdYTUxBbm5vdGF0aW9u\nUGFyc2VyKCk7CiAgICAgICAgICAgIF9hbm5vWE1MUGFyc2VyLnNldFJlcG9z\naXRvcnkocmVwb3MpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gX2Fubm9Y\nTUxQYXJzZXI7CiAgICB9CgogICAgLyoqCiAgICAgKiBTZXQgdGhlIEpBWEIg\nWE1MIGFubm90YXRpb24gcGFyc2VyLgogICAgICovCiAgICBwdWJsaWMgdm9p\nZCBzZXRYTUxBbm5vdGF0aW9uUGFyc2VyKAogICAgICAgIEFubm90YXRpb25Q\nZXJzaXN0ZW5jZVhNTE1ldGFEYXRhUGFyc2VyIHBhcnNlcikgewogICAgICAg\nIGlmIChfYW5ub1hNTFBhcnNlciAhPSBudWxsKQogICAgICAgICAgICBfYW5u\nb1hNTFBhcnNlci5zZXRSZXBvc2l0b3J5KG51bGwpOwogICAgICAgIGlmIChw\nYXJzZXIgIT0gbnVsbCkKICAgICAgICAgICAgcGFyc2VyLnNldFJlcG9zaXRv\ncnkocmVwb3MpOwogICAgICAgIF9hbm5vWE1MUGFyc2VyID0gcGFyc2VyOwog\nICAgfQoKICAgIC8qKgogICAgICogQ3JlYXRlIGEgbmV3IEpBWEIgWE1MIGFu\nbm90YXRpb24gcGFyc2VyLgogICAgICovCiAgICBwcm90ZWN0ZWQgQW5ub3Rh\ndGlvblBlcnNpc3RlbmNlWE1MTWV0YURhdGFQYXJzZXIgbmV3WE1MQW5ub3Rh\ndGlvblBhcnNlcigpIHsKICAgICAgICByZXR1cm4gbmV3IEFubm90YXRpb25Q\nZXJzaXN0ZW5jZVhNTE1ldGFEYXRhUGFyc2VyCiAgICAgICAgICAgIChyZXBv\ncy5nZXRDb25maWd1cmF0aW9uKCkpOwogICAgfQoKICAgIHB1YmxpYyB2b2lk\nIGxvYWRYTUxNZXRhRGF0YShGaWVsZE1ldGFEYXRhIGZtZCkgewogICAgICAg\nIEFubm90YXRpb25QZXJzaXN0ZW5jZVhNTE1ldGFEYXRhUGFyc2VyIHBhcnNl\ncgogICAgICAgICAgICA9IGdldFhNTEFubm90YXRpb25QYXJzZXIoKTsKICAg\nICAgICBwYXJzZXIucGFyc2UoZm1kKTsKICAgIH0KfQo=\n","encoding":"base64"}

