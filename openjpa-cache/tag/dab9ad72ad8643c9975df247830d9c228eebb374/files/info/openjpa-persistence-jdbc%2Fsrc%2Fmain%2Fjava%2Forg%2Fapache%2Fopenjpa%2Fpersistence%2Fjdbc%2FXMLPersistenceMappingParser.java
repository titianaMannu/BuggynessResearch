{"sha":"c483d2834d3957c5c9d83bb42673233482462aef","node_id":"MDQ6QmxvYjIwNjM2NDpjNDgzZDI4MzRkMzk1N2M1YzlkODNiYjQyNjczMjMzNDgyNDYyYWVm","size":30833,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/c483d2834d3957c5c9d83bb42673233482462aef","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuamRiYzsK\nCmltcG9ydCBqYXZhLmxhbmcucmVmbGVjdC5Nb2RpZmllcjsKaW1wb3J0IGph\ndmEuc3FsLlR5cGVzOwppbXBvcnQgamF2YS51dGlsLkFycmF5TGlzdDsKaW1w\nb3J0IGphdmEudXRpbC5BcnJheXM7CmltcG9ydCBqYXZhLnV0aWwuRW51bVNl\ndDsKaW1wb3J0IGphdmEudXRpbC5IYXNoTWFwOwppbXBvcnQgamF2YS51dGls\nLkxpc3Q7CmltcG9ydCBqYXZhLnV0aWwuTWFwOwppbXBvcnQgamF2YXgucGVy\nc2lzdGVuY2UuRGlzY3JpbWluYXRvclR5cGU7CmltcG9ydCBqYXZheC5wZXJz\naXN0ZW5jZS5FbnVtVHlwZTsKaW1wb3J0IGphdmF4LnBlcnNpc3RlbmNlLklu\naGVyaXRhbmNlVHlwZTsKaW1wb3J0IGphdmF4LnBlcnNpc3RlbmNlLlRlbXBv\ncmFsVHlwZTsKCmltcG9ydCBvcmcuYXBhY2hlLmNvbW1vbnMubGFuZy5TdHJp\nbmdVdGlsczsKaW1wb3J0IG9yZy54bWwuc2F4LkF0dHJpYnV0ZXM7CmltcG9y\ndCBvcmcueG1sLnNheC5TQVhFeGNlcHRpb247CmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEuamRiYy5jb25mLkpEQkNDb25maWd1cmF0aW9uOwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0YS5DbGFzc01hcHBpbmc7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhLkNsYXNzTWFwcGlu\nZ0luZm87CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhLkRp\nc2NyaW1pbmF0b3JNYXBwaW5nSW5mbzsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5qZGJjLm1ldGEuRmllbGRNYXBwaW5nOwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLmpkYmMubWV0YS5NYXBwaW5nUmVwb3NpdG9yeTsKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLm1ldGEuUXVlcnlSZXN1bHRNYXBw\naW5nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0YS5TZXF1\nZW5jZU1hcHBpbmc7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5t\nZXRhLnN0cmF0cy5FbnVtVmFsdWVIYW5kbGVyOwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLmpkYmMubWV0YS5zdHJhdHMuRmxhdENsYXNzU3RyYXRlZ3k7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhLnN0cmF0cy5G\ndWxsQ2xhc3NTdHJhdGVneTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5q\nZGJjLm1ldGEuc3RyYXRzLk5vbmVDbGFzc1N0cmF0ZWd5OwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0YS5zdHJhdHMuVmVydGljYWxDbGFz\nc1N0cmF0ZWd5OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2No\nZW1hLkNvbHVtbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNj\naGVtYS5VbmlxdWU7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLmxv\nZy5Mb2c7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuTG9j\nYWxpemVyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuQ2xhc3NN\nZXRhRGF0YTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRhLkZpZWxk\nTWV0YURhdGE7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YS5KYXZh\nVHlwZXM7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YS5NZXRhRGF0\nYVJlcG9zaXRvcnk7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lz\ndGVuY2UuWE1MUGVyc2lzdGVuY2VNZXRhRGF0YVBhcnNlcjsKaW1wb3J0IHN0\nYXRpYyBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuamRiYy5NYXBw\naW5nVGFnLio7CgovKioKICogQ3VzdG9tIFNBWCBwYXJzZXIgdXNlZCBieSB0\naGUgc3lzdGVtIHRvIHBhcnNlIHBlcnNpc3RlbmNlIG1hcHBpbmcgZmlsZXMu\nCiAqCiAqIEBhdXRob3IgU3RldmUgS2ltCiAqIEBub2phdmFkb2MKICovCnB1\nYmxpYyBjbGFzcyBYTUxQZXJzaXN0ZW5jZU1hcHBpbmdQYXJzZXIKICAgIGV4\ndGVuZHMgWE1MUGVyc2lzdGVuY2VNZXRhRGF0YVBhcnNlciB7CgogICAgcHJp\ndmF0ZSBzdGF0aWMgZmluYWwgTWFwPFN0cmluZywgTWFwcGluZ1RhZz4gX2Vs\nZW1zID0KICAgICAgICBuZXcgSGFzaE1hcDxTdHJpbmcsIE1hcHBpbmdUYWc+\nKCk7CgogICAgc3RhdGljIHsKICAgICAgICBfZWxlbXMucHV0KCJhc3NvY2lh\ndGlvbi1vdmVycmlkZSIsIEFTU09DX09WRVJSSURFKTsKICAgICAgICBfZWxl\nbXMucHV0KCJhdHRyaWJ1dGUtb3ZlcnJpZGUiLCBBVFRSX09WRVJSSURFKTsK\nICAgICAgICBfZWxlbXMucHV0KCJjb2x1bW4iLCBDT0wpOwogICAgICAgIF9l\nbGVtcy5wdXQoImNvbHVtbi1uYW1lIiwgQ09MVU1OX05BTUUpOwogICAgICAg\nIF9lbGVtcy5wdXQoImNvbHVtbi1yZXN1bHQiLCBDT0xVTU5fUkVTVUxUKTsK\nICAgICAgICBfZWxlbXMucHV0KCJkaXNjcmltaW5hdG9yLWNvbHVtbiIsIERJ\nU0NSSU1fQ09MKTsKICAgICAgICBfZWxlbXMucHV0KCJkaXNjcmltaW5hdG9y\nLXZhbHVlIiwgRElTQ1JJTV9WQUwpOwogICAgICAgIF9lbGVtcy5wdXQoImVu\ndGl0eS1yZXN1bHQiLCBFTlRJVFlfUkVTVUxUKTsKICAgICAgICBfZWxlbXMu\ncHV0KCJlbnVtZXJhdGVkIiwgRU5VTUVSQVRFRCk7CiAgICAgICAgX2VsZW1z\nLnB1dCgiZmllbGQtcmVzdWx0IiwgRklFTERfUkVTVUxUKTsKICAgICAgICBf\nZWxlbXMucHV0KCJpbmhlcml0YW5jZSIsIElOSEVSSVRBTkNFKTsKICAgICAg\nICBfZWxlbXMucHV0KCJqb2luLWNvbHVtbiIsIEpPSU5fQ09MKTsKICAgICAg\nICBfZWxlbXMucHV0KCJpbnZlcnNlLWpvaW4tY29sdW1uIiwgQ09MKTsKICAg\nICAgICBfZWxlbXMucHV0KCJqb2luLXRhYmxlIiwgSk9JTl9UQUJMRSk7CiAg\nICAgICAgX2VsZW1zLnB1dCgicHJpbWFyeS1rZXktam9pbi1jb2x1bW4iLCBQ\nS19KT0lOX0NPTCk7CiAgICAgICAgX2VsZW1zLnB1dCgic2Vjb25kYXJ5LXRh\nYmxlIiwgU0VDT05EQVJZX1RBQkxFKTsKICAgICAgICBfZWxlbXMucHV0KCJz\ncWwtcmVzdWx0LXNldC1tYXBwaW5nIiwgU1FMX1JFU1VMVF9TRVRfTUFQUElO\nRyk7CiAgICAgICAgX2VsZW1zLnB1dCgidGFibGUiLCBUQUJMRSk7CiAgICAg\nICAgX2VsZW1zLnB1dCgidGFibGUtZ2VuZXJhdG9yIiwgVEFCTEVfR0VOKTsK\nICAgICAgICBfZWxlbXMucHV0KCJ0ZW1wb3JhbCIsIFRFTVBPUkFMKTsKICAg\nICAgICBfZWxlbXMucHV0KCJ1bmlxdWUtY29uc3RyYWludCIsIFVOSVFVRSk7\nCiAgICB9CgogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgTG9jYWxpemVyIF9s\nb2MgPSBMb2NhbGl6ZXIuZm9yUGFja2FnZQogICAgICAgIChYTUxQZXJzaXN0\nZW5jZU1hcHBpbmdQYXJzZXIuY2xhc3MpOwoKICAgIHByaXZhdGUgU3RyaW5n\nIF9vdmVycmlkZSA9IG51bGw7CiAgICBwcml2YXRlIFN0cmluZyBfc2NoZW1h\nID0gbnVsbDsKICAgIHByaXZhdGUgU3RyaW5nIF9jb2xUYWJsZSA9IG51bGw7\nCiAgICBwcml2YXRlIFN0cmluZyBfc2Vjb25kYXJ5VGFibGUgPSBudWxsOwog\nICAgcHJpdmF0ZSBMaXN0PENvbHVtbj4gX2NvbHMgPSBudWxsOwogICAgcHJp\ndmF0ZSBMaXN0PENvbHVtbj4gX2pvaW5Db2xzID0gbnVsbDsKICAgIHByaXZh\ndGUgTGlzdDxDb2x1bW4+IF9zdXBKb2luQ29scyA9IG51bGw7CiAgICBwcml2\nYXRlIGJvb2xlYW4gX2xvYiA9IGZhbHNlOwogICAgcHJpdmF0ZSBUZW1wb3Jh\nbFR5cGUgX3RlbXBvcmFsID0gbnVsbDsKICAgIHByaXZhdGUgRW51bVNldDxV\nbmlxdWVGbGFnPiBfdW5pcXVlID0gRW51bVNldC5ub25lT2YoVW5pcXVlRmxh\nZy5jbGFzcyk7CiAgICBwcml2YXRlIERpc2NyaW1pbmF0b3JUeXBlIF9kaXNj\nVHlwZTsKICAgIHByaXZhdGUgQ29sdW1uIF9kaXNjQ29sOwogICAgcHJpdmF0\nZSBpbnQgX3Jlc3VsdElkeCA9IDA7CgogICAgLyoqCiAgICAgKiBDb25zdHJ1\nY3Rvcjsgc3VwcGx5IGNvbmZpZ3VyYXRpb24uCiAgICAgKi8KICAgIHB1Ymxp\nYyBYTUxQZXJzaXN0ZW5jZU1hcHBpbmdQYXJzZXIoSkRCQ0NvbmZpZ3VyYXRp\nb24gY29uZikgewogICAgICAgIHN1cGVyKGNvbmYpOwogICAgfQoKICAgIEBP\ndmVycmlkZQogICAgcHJvdGVjdGVkIHZvaWQgcmVzZXQoKSB7CiAgICAgICAg\nc3VwZXIucmVzZXQoKTsKICAgICAgICBjbGVhckNvbHVtbkluZm8oKTsKICAg\nICAgICBjbGVhckNsYXNzSW5mbygpOwogICAgICAgIGNsZWFyU2Vjb25kYXJ5\nVGFibGVJbmZvKCk7CiAgICAgICAgX292ZXJyaWRlID0gbnVsbDsKICAgICAg\nICBfc2NoZW1hID0gbnVsbDsKICAgICAgICBfcmVzdWx0SWR4ID0gMDsKICAg\nIH0KCiAgICBAT3ZlcnJpZGUKICAgIHByb3RlY3RlZCBPYmplY3Qgc3RhcnRT\neXN0ZW1NYXBwaW5nRWxlbWVudChTdHJpbmcgbmFtZSwgQXR0cmlidXRlcyBh\ndHRycykKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICBN\nYXBwaW5nVGFnIHRhZyA9IF9lbGVtcy5nZXQobmFtZSk7CiAgICAgICAgaWYg\nKHRhZyA9PSBudWxsKSB7CiAgICAgICAgICAgIGlmICgic2NoZW1hIi5lcXVh\nbHMobmFtZSkpCiAgICAgICAgICAgICAgICByZXR1cm4gbmFtZTsKICAgICAg\nICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgfQoKICAgICAgICBib29sZWFu\nIHJldDsKICAgICAgICBzd2l0Y2ggKHRhZykgewogICAgICAgICAgICBjYXNl\nIFRBQkxFX0dFTjoKICAgICAgICAgICAgICAgIHJldCA9IHN0YXJ0VGFibGVH\nZW5lcmF0b3IoYXR0cnMpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAg\nICAgICAgIGNhc2UgU1FMX1JFU1VMVF9TRVRfTUFQUElORzoKICAgICAgICAg\nICAgICAgIHJldCA9IHN0YXJ0U1FMUmVzdWx0U2V0TWFwcGluZyhhdHRycyk7\nCiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSBFTlRJ\nVFlfUkVTVUxUOgogICAgICAgICAgICAgICAgcmV0ID0gc3RhcnRFbnRpdHlS\nZXN1bHQoYXR0cnMpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAg\nICAgIGNhc2UgRklFTERfUkVTVUxUOgogICAgICAgICAgICAgICAgcmV0ID0g\nc3RhcnRGaWVsZFJlc3VsdChhdHRycyk7CiAgICAgICAgICAgICAgICBicmVh\nazsKICAgICAgICAgICAgY2FzZSBDT0xVTU5fUkVTVUxUOgogICAgICAgICAg\nICAgICAgcmV0ID0gc3RhcnRDb2x1bW5SZXN1bHQoYXR0cnMpOwogICAgICAg\nICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAg\nICAgICAgICByZXQgPSBmYWxzZTsKICAgICAgICB9CiAgICAgICAgcmV0dXJu\nIChyZXQpID8gdGFnIDogbnVsbDsKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAg\nIHByb3RlY3RlZCB2b2lkIGVuZFN5c3RlbU1hcHBpbmdFbGVtZW50KFN0cmlu\nZyBuYW1lKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24gewogICAgICAg\nIE1hcHBpbmdUYWcgdGFnID0gX2VsZW1zLmdldChuYW1lKTsKICAgICAgICBp\nZiAodGFnID09IG51bGwpIHsKICAgICAgICAgICAgaWYgKCJzY2hlbWEiLmVx\ndWFscyhuYW1lKSkKICAgICAgICAgICAgICAgIF9zY2hlbWEgPSBjdXJyZW50\nVGV4dCgpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAg\nICBzd2l0Y2ggKHRhZykgewogICAgICAgICAgICBjYXNlIFNRTF9SRVNVTFRf\nU0VUX01BUFBJTkc6CiAgICAgICAgICAgICAgICBlbmRTUUxSZXN1bHRTZXRN\nYXBwaW5nKCk7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAg\nY2FzZSBFTlRJVFlfUkVTVUxUOgogICAgICAgICAgICAgICAgZW5kRW50aXR5\nUmVzdWx0KCk7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICB9CiAg\nICB9CgogICAgQE92ZXJyaWRlCiAgICBwcm90ZWN0ZWQgT2JqZWN0IHN0YXJ0\nQ2xhc3NNYXBwaW5nRWxlbWVudChTdHJpbmcgbmFtZSwgQXR0cmlidXRlcyBh\ndHRycykKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICBN\nYXBwaW5nVGFnIHRhZyA9IF9lbGVtcy5nZXQobmFtZSk7CiAgICAgICAgaWYg\nKHRhZyA9PSBudWxsKQogICAgICAgICAgICByZXR1cm4gbnVsbDsKCiAgICAg\nICAgYm9vbGVhbiByZXQ7CiAgICAgICAgc3dpdGNoICh0YWcpIHsKICAgICAg\nICAgICAgY2FzZSBUQUJMRToKICAgICAgICAgICAgICAgIHJldCA9IHN0YXJ0\nVGFibGUoYXR0cnMpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAg\nICAgIGNhc2UgU0VDT05EQVJZX1RBQkxFOgogICAgICAgICAgICAgICAgcmV0\nID0gc3RhcnRTZWNvbmRhcnlUYWJsZShhdHRycyk7CiAgICAgICAgICAgICAg\nICBicmVhazsKICAgICAgICAgICAgY2FzZSBESVNDUklNX0NPTDoKICAgICAg\nICAgICAgICAgIHBhcnNlRGlzY3JpbWluYXRvckNvbHVtbihhdHRycyk7CiAg\nICAgICAgICAgICAgICBfZGlzY0NvbCA9IHBhcnNlQ29sdW1uKGF0dHJzKTsK\nICAgICAgICAgICAgICAgIHJldCA9IHRydWU7CiAgICAgICAgICAgICAgICBi\ncmVhazsKICAgICAgICAgICAgY2FzZSBESVNDUklNX1ZBTDoKICAgICAgICAg\nICAgICAgIHJldCA9IHRydWU7CiAgICAgICAgICAgICAgICBicmVhazsKICAg\nICAgICAgICAgY2FzZSBJTkhFUklUQU5DRToKICAgICAgICAgICAgICAgIHJl\ndCA9IHN0YXJ0SW5oZXJpdGFuY2UoYXR0cnMpOwogICAgICAgICAgICAgICAg\nYnJlYWs7CiAgICAgICAgICAgIGNhc2UgQVNTT0NfT1ZFUlJJREU6CiAgICAg\nICAgICAgIGNhc2UgQVRUUl9PVkVSUklERToKICAgICAgICAgICAgICAgIHJl\ndCA9IHN0YXJ0QXR0cmlidXRlT3ZlcnJpZGUoYXR0cnMpOwogICAgICAgICAg\nICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgUEtfSk9JTl9DT0w6CiAg\nICAgICAgICAgICAgICByZXQgPSBzdGFydFByaW1hcnlLZXlKb2luQ29sdW1u\nKGF0dHJzKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBj\nYXNlIENPTDoKICAgICAgICAgICAgICAgIHJldCA9IHN0YXJ0Q29sdW1uKGF0\ndHJzKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNl\nIEpPSU5fQ09MOgogICAgICAgICAgICAgICAgcmV0ID0gc3RhcnRKb2luQ29s\ndW1uKGF0dHJzKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAg\nICBjYXNlIEpPSU5fVEFCTEU6CiAgICAgICAgICAgICAgICByZXQgPSBzdGFy\ndEpvaW5UYWJsZShhdHRycyk7CiAgICAgICAgICAgICAgICBicmVhazsKICAg\nICAgICAgICAgY2FzZSBUQUJMRV9HRU46CiAgICAgICAgICAgICAgICByZXQg\nPSBzdGFydFRhYmxlR2VuZXJhdG9yKGF0dHJzKTsKICAgICAgICAgICAgICAg\nIGJyZWFrOwogICAgICAgICAgICBjYXNlIFVOSVFVRToKICAgICAgICAgICAg\nICAgIHJldCA9IHN0YXJ0VW5pcXVlQ29uc3RyYWludChhdHRycyk7CiAgICAg\nICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSBURU1QT1JBTDoK\nICAgICAgICAgICAgY2FzZSBFTlVNRVJBVEVEOgogICAgICAgICAgICAgICAg\ncmV0ID0gdHJ1ZTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAg\nICBjYXNlIFNRTF9SRVNVTFRfU0VUX01BUFBJTkc6CiAgICAgICAgICAgICAg\nICByZXQgPSBzdGFydFNRTFJlc3VsdFNldE1hcHBpbmcoYXR0cnMpOwogICAg\nICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgRU5USVRZX1JF\nU1VMVDoKICAgICAgICAgICAgICAgIHJldCA9IHN0YXJ0RW50aXR5UmVzdWx0\nKGF0dHJzKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBj\nYXNlIEZJRUxEX1JFU1VMVDoKICAgICAgICAgICAgICAgIHJldCA9IHN0YXJ0\nRmllbGRSZXN1bHQoYXR0cnMpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAg\nICAgICAgICAgIGNhc2UgQ09MVU1OX1JFU1VMVDoKICAgICAgICAgICAgICAg\nIHJldCA9IHN0YXJ0Q29sdW1uUmVzdWx0KGF0dHJzKTsKICAgICAgICAgICAg\nICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIENPTFVNTl9OQU1FOgogICAg\nICAgICAgICAgICAgcmV0ID0gdHJ1ZTsKICAgICAgICAgICAgICAgIGJyZWFr\nOwogICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgICAgcmV0ID0g\nZmFsc2U7CiAgICAgICAgfQogICAgICAgIHJldHVybiAocmV0KSA/IHRhZyA6\nIG51bGw7CiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwcm90ZWN0ZWQgdm9p\nZCBlbmRDbGFzc01hcHBpbmdFbGVtZW50KFN0cmluZyBuYW1lKQogICAgICAg\nIHRocm93cyBTQVhFeGNlcHRpb24gewogICAgICAgIE1hcHBpbmdUYWcgdGFn\nID0gX2VsZW1zLmdldChuYW1lKTsKICAgICAgICBpZiAodGFnID09IG51bGwp\nCiAgICAgICAgICAgIHJldHVybjsKCiAgICAgICAgc3dpdGNoICh0YWcpIHsK\nICAgICAgICAgICAgY2FzZSBTRUNPTkRBUllfVEFCTEU6CiAgICAgICAgICAg\nICAgICBlbmRTZWNvbmRhcnlUYWJsZSgpOwogICAgICAgICAgICAgICAgYnJl\nYWs7CiAgICAgICAgICAgIGNhc2UgRElTQ1JJTV9WQUw6CiAgICAgICAgICAg\nICAgICBlbmREaXNjcmltaW5hdG9yVmFsdWUoKTsKICAgICAgICAgICAgICAg\nIGJyZWFrOwogICAgICAgICAgICBjYXNlIEFUVFJfT1ZFUlJJREU6CiAgICAg\nICAgICAgICAgICBlbmRBdHRyaWJ1dGVPdmVycmlkZSgpOwogICAgICAgICAg\nICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgSk9JTl9UQUJMRToKICAg\nICAgICAgICAgICAgIGVuZEpvaW5UYWJsZSgpOwogICAgICAgICAgICAgICAg\nYnJlYWs7CiAgICAgICAgICAgIGNhc2UgVEVNUE9SQUw6CiAgICAgICAgICAg\nICAgICBlbmRUZW1wb3JhbCgpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAg\nICAgICAgICAgIGNhc2UgRU5VTUVSQVRFRDoKICAgICAgICAgICAgICAgIGVu\nZEVudW1lcmF0ZWQoKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAg\nICAgICBjYXNlIFNRTF9SRVNVTFRfU0VUX01BUFBJTkc6CiAgICAgICAgICAg\nICAgICBlbmRTUUxSZXN1bHRTZXRNYXBwaW5nKCk7CiAgICAgICAgICAgICAg\nICBicmVhazsKICAgICAgICAgICAgY2FzZSBFTlRJVFlfUkVTVUxUOgogICAg\nICAgICAgICAgICAgZW5kRW50aXR5UmVzdWx0KCk7CiAgICAgICAgICAgICAg\nICBicmVhazsKICAgICAgICAgICAgY2FzZSBVTklRVUU6CiAgICAgICAgICAg\nICAgICBlbmRVbmlxdWVDb25zdHJhaW50KCk7CiAgICAgICAgICAgICAgICBi\ncmVhazsKICAgICAgICAgICAgY2FzZSBDT0xVTU5fTkFNRToKICAgICAgICAg\nICAgICAgIGVuZENvbHVtbk5hbWUoKTsKICAgICAgICAgICAgICAgIGJyZWFr\nOwogICAgICAgIH0KICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHByb3RlY3Rl\nZCB2b2lkIHN0YXJ0Q2xhc3NNYXBwaW5nKENsYXNzTWV0YURhdGEgbWV0YSwg\nYm9vbGVhbiBtYXBwZWRTdXBlciwKICAgICAgICBBdHRyaWJ1dGVzIGF0dHJz\nKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24gewogICAgICAgIGlmICht\nYXBwZWRTdXBlcikKICAgICAgICAgICAgKChDbGFzc01hcHBpbmcpIG1ldGEp\nLmdldE1hcHBpbmdJbmZvKCkuc2V0U3RyYXRlZ3kKICAgICAgICAgICAgICAg\nIChOb25lQ2xhc3NTdHJhdGVneS5BTElBUyk7CiAgICB9CgogICAgQE92ZXJy\naWRlCiAgICBwcm90ZWN0ZWQgdm9pZCBlbmRDbGFzc01hcHBpbmcoQ2xhc3NN\nZXRhRGF0YSBtZXRhKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24gewog\nICAgICAgIENsYXNzTWFwcGluZyBjbSA9IChDbGFzc01hcHBpbmcpIG1ldGE7\nCiAgICAgICAgaWYgKF9zY2hlbWEgIT0gbnVsbCkKICAgICAgICAgICAgY20u\nZ2V0TWFwcGluZ0luZm8oKS5zZXRTY2hlbWFOYW1lKF9zY2hlbWEpOwoKICAg\nICAgICBpZiAoX3N1cEpvaW5Db2xzICE9IG51bGwpCiAgICAgICAgICAgIGNt\nLmdldE1hcHBpbmdJbmZvKCkuc2V0Q29sdW1ucyhfc3VwSm9pbkNvbHMpOwoK\nICAgICAgICBpZiAoX2Rpc2NDb2wgIT0gbnVsbCkgewogICAgICAgICAgICBE\naXNjcmltaW5hdG9yTWFwcGluZ0luZm8gZGluZm8gPSBjbS5nZXREaXNjcmlt\naW5hdG9yKCkKICAgICAgICAgICAgICAgICAgICAuZ2V0TWFwcGluZ0luZm8o\nKTsKICAgICAgICAgICAgc3dpdGNoIChfZGlzY1R5cGUpIHsKICAgICAgICAg\nICAgICAgIGNhc2UgQ0hBUjoKICAgICAgICAgICAgICAgICAgICBfZGlzY0Nv\nbC5zZXRKYXZhVHlwZShKYXZhVHlwZXMuQ0hBUik7CiAgICAgICAgICAgICAg\nICAgICAgY20uZ2V0RGlzY3JpbWluYXRvcigpLnNldEphdmFUeXBlKEphdmFU\neXBlcy5DSEFSKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAg\nICAgICAgICAgIGNhc2UgSU5URUdFUjoKICAgICAgICAgICAgICAgICAgICBf\nZGlzY0NvbC5zZXRKYXZhVHlwZShKYXZhVHlwZXMuSU5UKTsKICAgICAgICAg\nICAgICAgICAgICBjbS5nZXREaXNjcmltaW5hdG9yKCkuc2V0SmF2YVR5cGUo\nSmF2YVR5cGVzLklOVCk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAg\nICAgICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgICAgICAgIF9k\naXNjQ29sLnNldEphdmFUeXBlKEphdmFUeXBlcy5TVFJJTkcpOwogICAgICAg\nICAgICAgICAgICAgIGNtLmdldERpc2NyaW1pbmF0b3IoKS5zZXRKYXZhVHlw\nZShKYXZhVHlwZXMuU1RSSU5HKTsKICAgICAgICAgICAgICAgICAgICBicmVh\nazsKICAgICAgICAgICAgfQogICAgICAgICAgICBkaW5mby5zZXRDb2x1bW5z\nKEFycmF5cy5hc0xpc3QobmV3IENvbHVtbltdeyBfZGlzY0NvbCB9KSk7CiAg\nICAgICAgfQogICAgICAgIGNsZWFyQ2xhc3NJbmZvKCk7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBDbGVhciBjYWNoZWQgY2xhc3MgbWFwcGluZyBpbmZvLgog\nICAgICovCiAgICBwcml2YXRlIHZvaWQgY2xlYXJDbGFzc0luZm8oKSB7CiAg\nICAgICAgX3N1cEpvaW5Db2xzID0gbnVsbDsKICAgICAgICBfZGlzY0NvbCA9\nIG51bGw7CiAgICAgICAgX2Rpc2NUeXBlID0gbnVsbDsKICAgIH0KCiAgICAv\nKioKICAgICAqIFN0YXJ0IHRyYWNraW5nIHNlY29uZGFyeSB0YWJsZSBpbmZv\ncm1hdGlvbiBhbmQgY29sdW1ucwogICAgICovCiAgICBwcml2YXRlIGJvb2xl\nYW4gc3RhcnRTZWNvbmRhcnlUYWJsZShBdHRyaWJ1dGVzIGF0dHJzKQogICAg\nICAgIHRocm93cyBTQVhFeGNlcHRpb24gewogICAgICAgIF9zZWNvbmRhcnlU\nYWJsZSA9IHRvVGFibGVOYW1lKGF0dHJzLmdldFZhbHVlKCJzY2hlbWEiKSwK\nICAgICAgICAgICAgYXR0cnMuZ2V0VmFsdWUoIm5hbWUiKSk7CiAgICAgICAg\ncmV0dXJuIHRydWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBTZXQgdGhlIHNl\nY29uZGFyeSB0YWJsZSBpbmZvcm1hdGlvbiBiYWNrIHRvIHRoZSBvd25pbmcg\nY2xhc3MgbWFwcGluZy4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIGVuZFNl\nY29uZGFyeVRhYmxlKCkgewogICAgICAgIENsYXNzTWFwcGluZyBjbSA9IChD\nbGFzc01hcHBpbmcpIGN1cnJlbnRFbGVtZW50KCk7CiAgICAgICAgQ2xhc3NN\nYXBwaW5nSW5mbyBpbmZvID0gY20uZ2V0TWFwcGluZ0luZm8oKTsKICAgICAg\nICBpbmZvLnNldFNlY29uZGFyeVRhYmxlSm9pbkNvbHVtbnMoX3NlY29uZGFy\neVRhYmxlLCBfam9pbkNvbHMpOwogICAgICAgIGNsZWFyU2Vjb25kYXJ5VGFi\nbGVJbmZvKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBDbGVhciBjYWNoZWQg\nc2Vjb25kYXJ5IHRhYmxlIGluZm8uCiAgICAgKi8KICAgIHByaXZhdGUgdm9p\nZCBjbGVhclNlY29uZGFyeVRhYmxlSW5mbygpIHsKICAgICAgICBfam9pbkNv\nbHMgPSBudWxsOwogICAgICAgIF9zZWNvbmRhcnlUYWJsZSA9IG51bGw7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBQYXJzZSB0YWJsZS1nZW5lcmF0b3IuCiAg\nICAgKi8KICAgIHByaXZhdGUgYm9vbGVhbiBzdGFydFRhYmxlR2VuZXJhdG9y\nKEF0dHJpYnV0ZXMgYXR0cnMpIHsKICAgICAgICBTdHJpbmcgbmFtZSA9IGF0\ndHJzLmdldFZhbHVlKCJuYW1lIik7CiAgICAgICAgTG9nIGxvZyA9IGdldExv\nZygpOwogICAgICAgIGlmIChsb2cuaXNUcmFjZUVuYWJsZWQoKSkKICAgICAg\nICAgICAgbG9nLnRyYWNlKF9sb2MuZ2V0KCJwYXJzZS1nZW4iLCBuYW1lKSk7\nCiAgICAgICAgaWYgKGdldFJlcG9zaXRvcnkoKS5nZXRDYWNoZWRTZXF1ZW5j\nZU1ldGFEYXRhKG5hbWUpICE9IG51bGwKICAgICAgICAgICAgJiYgbG9nLmlz\nV2FybkVuYWJsZWQoKSkKICAgICAgICAgICAgbG9nLndhcm4oX2xvYy5nZXQo\nIm92ZXJyaWRlLWdlbiIsIG5hbWUpKTsKCiAgICAgICAgU2VxdWVuY2VNYXBw\naW5nIHNlcSA9IChTZXF1ZW5jZU1hcHBpbmcpIGdldFJlcG9zaXRvcnkoKS4K\nICAgICAgICAgICAgYWRkU2VxdWVuY2VNZXRhRGF0YShuYW1lKTsKICAgICAg\nICBzZXEuc2V0U2VxdWVuY2VQbHVnaW4oU2VxdWVuY2VNYXBwaW5nLklNUExf\nVkFMVUVfVEFCTEUpOwogICAgICAgIHNlcS5zZXRUYWJsZSh0b1RhYmxlTmFt\nZShhdHRycy5nZXRWYWx1ZSgic2NoZW1hIiksCiAgICAgICAgICAgIGF0dHJz\nLmdldFZhbHVlKCJ0YWJsZSIpKSk7CiAgICAgICAgc2VxLnNldFByaW1hcnlL\nZXlDb2x1bW4oYXR0cnMuZ2V0VmFsdWUoInBrLWNvbHVtbi1uYW1lIikpOwog\nICAgICAgIHNlcS5zZXRTZXF1ZW5jZUNvbHVtbihhdHRycy5nZXRWYWx1ZSgi\ndmFsdWUtY29sdW1uLW5hbWUiKSk7CiAgICAgICAgc2VxLnNldFByaW1hcnlL\nZXlWYWx1ZShhdHRycy5nZXRWYWx1ZSgicGstY29sdW1uLXZhbHVlIikpOwog\nICAgICAgIFN0cmluZyB2YWwgPSBhdHRycy5nZXRWYWx1ZSgiaW5pdGlhbC12\nYWx1ZSIpOwogICAgICAgIGlmICh2YWwgIT0gbnVsbCkKICAgICAgICAgICAg\nc2VxLnNldEluaXRpYWxWYWx1ZShJbnRlZ2VyLnBhcnNlSW50KHZhbCkpOwog\nICAgICAgIHZhbCA9IGF0dHJzLmdldFZhbHVlKCJhbGxvY2F0aW9uLXNpemUi\nKTsKICAgICAgICBpZiAodmFsICE9IG51bGwpCiAgICAgICAgICAgIHNlcS5z\nZXRBbGxvY2F0ZShJbnRlZ2VyLnBhcnNlSW50KHZhbCkpOwoKICAgICAgICBP\nYmplY3QgY3VyID0gY3VycmVudEVsZW1lbnQoKTsKICAgICAgICBPYmplY3Qg\nc2NvcGUgPSAoY3VyIGluc3RhbmNlb2YgQ2xhc3NNZXRhRGF0YSkKICAgICAg\nICAgICAgPyAoKENsYXNzTWV0YURhdGEpIGN1cikuZ2V0RGVzY3JpYmVkVHlw\nZSgpIDogbnVsbDsKICAgICAgICBzZXEuc2V0U291cmNlKGdldFNvdXJjZUZp\nbGUoKSwgc2NvcGUsIHNlcS5TUkNfWE1MKTsKICAgICAgICByZXR1cm4gdHJ1\nZTsKICAgIH0KCiAgICAvKioKICAgICAqIFBhcnNlIGluaGVyaXRhbmNlLgog\nICAgICovCiAgICBwcml2YXRlIGJvb2xlYW4gc3RhcnRJbmhlcml0YW5jZShB\ndHRyaWJ1dGVzIGF0dHJzKSB7CiAgICAgICAgU3RyaW5nIHZhbCA9IGF0dHJz\nLmdldFZhbHVlKCJzdHJhdGVneSIpOwogICAgICAgIGlmICh2YWwgPT0gbnVs\nbCkKICAgICAgICAgICAgcmV0dXJuIHRydWU7CgogICAgICAgIENsYXNzTWFw\ncGluZyBjbSA9IChDbGFzc01hcHBpbmcpIGN1cnJlbnRFbGVtZW50KCk7CiAg\nICAgICAgQ2xhc3NNYXBwaW5nSW5mbyBpbmZvID0gY20uZ2V0TWFwcGluZ0lu\nZm8oKTsKICAgICAgICBzd2l0Y2ggKEVudW0udmFsdWVPZihJbmhlcml0YW5j\nZVR5cGUuY2xhc3MsIHZhbCkpIHsKICAgICAgICAgICAgY2FzZSBTSU5HTEVf\nVEFCTEU6CiAgICAgICAgICAgICAgICBpbmZvLnNldEhpZXJhcmNoeVN0cmF0\nZWd5KEZsYXRDbGFzc1N0cmF0ZWd5LkFMSUFTKTsKICAgICAgICAgICAgICAg\nIGJyZWFrOwogICAgICAgICAgICBjYXNlIEpPSU5FRDoKICAgICAgICAgICAg\nICAgIGluZm8uc2V0SGllcmFyY2h5U3RyYXRlZ3koVmVydGljYWxDbGFzc1N0\ncmF0ZWd5LkFMSUFTKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAg\nICAgICBjYXNlIFRBQkxFX1BFUl9DTEFTUzoKICAgICAgICAgICAgICAgIGlu\nZm8uc2V0SGllcmFyY2h5U3RyYXRlZ3koRnVsbENsYXNzU3RyYXRlZ3kuQUxJ\nQVMpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICAg\nIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qKgogICAgICogUGFyc2UgZGlz\nY3JpbWluYXRvci12YWx1ZS4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIGVu\nZERpc2NyaW1pbmF0b3JWYWx1ZSgpIHsKICAgICAgICBTdHJpbmcgdmFsID0g\nY3VycmVudFRleHQoKTsKICAgICAgICBpZiAoU3RyaW5nVXRpbHMuaXNFbXB0\neSh2YWwpKQogICAgICAgICAgICByZXR1cm47CgogICAgICAgIENsYXNzTWFw\ncGluZyBjbSA9IChDbGFzc01hcHBpbmcpIGN1cnJlbnRFbGVtZW50KCk7CiAg\nICAgICAgY20uZ2V0RGlzY3JpbWluYXRvcigpLmdldE1hcHBpbmdJbmZvKCku\nc2V0VmFsdWUodmFsKTsKCiAgICAgICAgaWYgKE1vZGlmaWVyLmlzQWJzdHJh\nY3QoY20uZ2V0RGVzY3JpYmVkVHlwZSgpLmdldE1vZGlmaWVycygpKQogICAg\nICAgICAgICAgICAgJiYgZ2V0TG9nKCkuaXNJbmZvRW5hYmxlZCgpKSB7CiAg\nICAgICAgICAgIGdldExvZygpLmluZm8oCiAgICAgICAgICAgICAgICAgICAg\nX2xvYy5nZXQoImRpc2NyaW1pbmF0b3Itb24tYWJzdHJhY3QtY2xhc3MiLCBj\nbQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLmdldERlc2NyaWJlZFR5\ncGUoKS5nZXROYW1lKCkpKTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAg\nICAgKiBQYXJzZSB0ZW1wb3JhbC4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lk\nIGVuZFRlbXBvcmFsKCkgewogICAgICAgIFN0cmluZyB0ZW1wID0gY3VycmVu\ndFRleHQoKTsKICAgICAgICBpZiAoIVN0cmluZ1V0aWxzLmlzRW1wdHkodGVt\ncCkpCiAgICAgICAgICAgIF90ZW1wb3JhbCA9IEVudW0udmFsdWVPZihUZW1w\nb3JhbFR5cGUuY2xhc3MsIHRlbXApOwogICAgfQoKICAgIC8qKgogICAgICog\nUGFyc2UgZW51bWVyYXRlZC4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIGVu\nZEVudW1lcmF0ZWQoKSB7CiAgICAgICAgU3RyaW5nIHRleHQgPSBjdXJyZW50\nVGV4dCgpOwogICAgICAgIGlmIChTdHJpbmdVdGlscy5pc0VtcHR5KHRleHQp\nKQogICAgICAgICAgICByZXR1cm47CiAgICAgICAgRW51bVR5cGUgdHlwZSA9\nIEVudW0udmFsdWVPZihFbnVtVHlwZS5jbGFzcywgdGV4dCk7CgogICAgICAg\nIEZpZWxkTWFwcGluZyBmbSA9IChGaWVsZE1hcHBpbmcpIGN1cnJlbnRFbGVt\nZW50KCk7CiAgICAgICAgU3RyaW5nIHN0cmF0ID0gRW51bVZhbHVlSGFuZGxl\nci5jbGFzcy5nZXROYW1lKCkgKyAiKFN0b3JlT3JkaW5hbD0iCiAgICAgICAg\nICAgICsgU3RyaW5nLnZhbHVlT2YodHlwZSA9PSBFbnVtVHlwZS5PUkRJTkFM\nKSArICIpIjsKICAgICAgICBmbS5nZXRWYWx1ZUluZm8oKS5zZXRTdHJhdGVn\neShzdHJhdCk7CiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwcm90ZWN0ZWQg\nYm9vbGVhbiBzdGFydExvYihBdHRyaWJ1dGVzIGF0dHJzKQogICAgICAgIHRo\ncm93cyBTQVhFeGNlcHRpb24gewogICAgICAgIGlmIChzdXBlci5zdGFydExv\nYihhdHRycykpIHsKICAgICAgICAgICAgX2xvYiA9IHRydWU7CiAgICAgICAg\nICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KICAgICAgICByZXR1cm4gZmFs\nc2U7CiAgICB9CgogICAgLyoqCiAgICAgKiBFeHRlbmQgdG8gY2xlYXIgYW5u\nb3RhdGlvbiBtYXBwaW5nIGluZm8uCiAgICAgKi8KICAgIEBPdmVycmlkZQog\nICAgcHJvdGVjdGVkIHZvaWQgc3RhcnRGaWVsZE1hcHBpbmcoRmllbGRNZXRh\nRGF0YSBmaWVsZCwgQXR0cmlidXRlcyBhdHRycykKICAgICAgICB0aHJvd3Mg\nU0FYRXhjZXB0aW9uIHsKICAgICAgICBzdXBlci5zdGFydEZpZWxkTWFwcGlu\nZyhmaWVsZCwgYXR0cnMpOwogICAgICAgIGlmIChnZXRBbm5vdGF0aW9uUGFy\nc2VyKCkgIT0gbnVsbCkgewogICAgICAgICAgICBGaWVsZE1hcHBpbmcgZm0g\nPSAoRmllbGRNYXBwaW5nKSBmaWVsZDsKICAgICAgICAgICAgZm0uZ2V0TWFw\ncGluZ0luZm8oKS5jbGVhcigpOwogICAgICAgICAgICBmbS5nZXRWYWx1ZUlu\nZm8oKS5jbGVhcigpOwogICAgICAgICAgICBmbS5nZXRFbGVtZW50TWFwcGlu\nZygpLmdldFZhbHVlSW5mbygpLmNsZWFyKCk7CiAgICAgICAgICAgIGZtLmdl\ndEtleU1hcHBpbmcoKS5nZXRWYWx1ZUluZm8oKS5jbGVhcigpOwogICAgICAg\nIH0KICAgIH0KCiAgICAvKioKICAgICAqIEV4dGVuZCB0byBzZXQgdGhlIGNv\nbHVtbnMuCiAgICAgKi8KICAgIEBPdmVycmlkZQogICAgcHJvdGVjdGVkIHZv\naWQgZW5kRmllbGRNYXBwaW5nKEZpZWxkTWV0YURhdGEgZmllbGQpCiAgICAg\nICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgLy8gc2V0dXAgY29s\ndW1ucyB3aXRoIGNhY2hlZCBsb2IgYW5kIHRlbXBvcmFsIGluZm8KICAgICAg\nICBGaWVsZE1hcHBpbmcgZm0gPSAoRmllbGRNYXBwaW5nKSBmaWVsZDsKICAg\nICAgICBpZiAoX2xvYiB8fCBfdGVtcG9yYWwgIT0gbnVsbCkgewogICAgICAg\nICAgICBpZiAoX2NvbHMgPT0gbnVsbCkgewogICAgICAgICAgICAgICAgX2Nv\nbHMgPSBuZXcgQXJyYXlMaXN0PENvbHVtbj4oMSk7CiAgICAgICAgICAgICAg\nICBfY29scy5hZGQobmV3IENvbHVtbigpKTsKICAgICAgICAgICAgfQogICAg\nICAgICAgICBmb3IgKENvbHVtbiBjb2wgOiBfY29scykgewogICAgICAgICAg\nICAgICAgaWYgKF9sb2IgJiYgKGZtLmdldERlY2xhcmVkVHlwZUNvZGUoKSA9\nPSBKYXZhVHlwZXMuU1RSSU5HCiAgICAgICAgICAgICAgICAgICAgfHwgZm0u\nZ2V0RGVjbGFyZWRUeXBlKCkgPT0gY2hhcltdLmNsYXNzCiAgICAgICAgICAg\nICAgICAgICAgfHwgZm0uZ2V0RGVjbGFyZWRUeXBlKCkgPT0gQ2hhcmFjdGVy\nW10uY2xhc3MpKSB7CiAgICAgICAgICAgICAgICAgICAgY29sLnNldFNpemUo\nLTEpOwogICAgICAgICAgICAgICAgICAgIGNvbC5zZXRUeXBlKFR5cGVzLkNM\nT0IpOwogICAgICAgICAgICAgICAgfSBlbHNlIGlmIChfbG9iKQogICAgICAg\nICAgICAgICAgICAgIGNvbC5zZXRUeXBlKFR5cGVzLkJMT0IpOwogICAgICAg\nICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChf\ndGVtcG9yYWwpIHsKICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBEQVRF\nOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sLnNldFR5cGUoVHlw\nZXMuREFURSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsK\nICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBUSU1FOgogICAgICAgICAg\nICAgICAgICAgICAgICAgICAgY29sLnNldFR5cGUoVHlwZXMuVElNRSk7CiAg\nICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAg\nICAgICAgICAgICAgY2FzZSBUSU1FU1RBTVA6CiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICBjb2wuc2V0VHlwZShUeXBlcy5USU1FU1RBTVApOwogICAg\nICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAg\nICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAg\nICAgfQoKICAgICAgICBpZiAoX2NvbHMgIT0gbnVsbCkgewogICAgICAgICAg\nICBzd2l0Y2ggKGZtLmdldERlY2xhcmVkVHlwZUNvZGUoKSkgewogICAgICAg\nICAgICAgICAgY2FzZSBKYXZhVHlwZXMuQVJSQVk6CiAgICAgICAgICAgICAg\nICAgICAgQ2xhc3MgdHlwZSA9IGZtLmdldERlY2xhcmVkVHlwZSgpOwogICAg\nICAgICAgICAgICAgICAgIGlmICh0eXBlID09IGJ5dGVbXS5jbGFzcyB8fCB0\neXBlID09IEJ5dGVbXS5jbGFzcwogICAgICAgICAgICAgICAgICAgICAgICB8\nfCB0eXBlID09IGNoYXJbXS5jbGFzcyB8fCB0eXBlID09IENoYXJhY3Rlcltd\nLmNsYXNzICkgewogICAgICAgICAgICAgICAgICAgICAgICBmbS5nZXRWYWx1\nZUluZm8oKS5zZXRDb2x1bW5zKF9jb2xzKTsKICAgICAgICAgICAgICAgICAg\nICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAg\nICAgICAgICAgIC8vIGVsc2Ugbm8gYnJlYWsKICAgICAgICAgICAgICAgIGNh\nc2UgSmF2YVR5cGVzLkNPTExFQ1RJT046CiAgICAgICAgICAgICAgICBjYXNl\nIEphdmFUeXBlcy5NQVA6CiAgICAgICAgICAgICAgICAgICAgZm0uZ2V0RWxl\nbWVudE1hcHBpbmcoKS5nZXRWYWx1ZUluZm8oKS5zZXRDb2x1bW5zKF9jb2xz\nKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAg\nIGRlZmF1bHQ6CiAgICAgICAgICAgICAgICAgICAgZm0uZ2V0VmFsdWVJbmZv\nKCkuc2V0Q29sdW1ucyhfY29scyk7CiAgICAgICAgICAgIH0KICAgICAgICAg\nICAgaWYgKF9jb2xUYWJsZSAhPSBudWxsKQogICAgICAgICAgICAgICAgZm0u\nZ2V0TWFwcGluZ0luZm8oKS5zZXRUYWJsZU5hbWUoX2NvbFRhYmxlKTsKICAg\nICAgICAgICAgc2V0VW5pcXVlKGZtKTsKICAgICAgICB9CiAgICAgICAgY2xl\nYXJDb2x1bW5JbmZvKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBTZXQgdW5p\ncXVlIGZvciBmaWVsZC4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIHNldFVu\naXF1ZShGaWVsZE1hcHBpbmcgZm0pIHsKICAgICAgICBpZiAoX3VuaXF1ZS5z\naXplKCkgPT0gMikgLy8gaS5lLiBUUlVFICYgRkFMU0UKICAgICAgICAgICAg\nZ2V0TG9nKCkud2FybihfbG9jLmdldCgiaW5jb25zaXN0LWNvbC1hdHRycyIs\nIGZtKSk7CiAgICAgICAgZWxzZSBpZiAoX3VuaXF1ZS5jb250YWlucyhVbmlx\ndWVGbGFnLlRSVUUpKQogICAgICAgICAgICBmbS5nZXRWYWx1ZUluZm8oKS5z\nZXRVbmlxdWUobmV3IFVuaXF1ZSgpKTsKICAgIH0KCiAgICAvKioKICAgICAq\nIENsZWFyIGZpZWxkIGxldmVsIGNvbHVtbiBpbmZvcm1hdGlvbi4KICAgICAq\nLwogICAgcHJpdmF0ZSB2b2lkIGNsZWFyQ29sdW1uSW5mbygpIHsKICAgICAg\nICBfY29scyA9IG51bGw7CiAgICAgICAgX2pvaW5Db2xzID0gbnVsbDsKICAg\nICAgICBfY29sVGFibGUgPSBudWxsOwogICAgICAgIF9sb2IgPSBmYWxzZTsK\nICAgICAgICBfdGVtcG9yYWwgPSBudWxsOwogICAgICAgIF91bmlxdWUuY2xl\nYXIoKTsKICAgIH0KCiAgICAvKioKICAgICAqIFBhcnNlIGF0dHJpYnV0ZS1v\ndmVycmlkZS4KICAgICAqLwogICAgcHJpdmF0ZSBib29sZWFuIHN0YXJ0QXR0\ncmlidXRlT3ZlcnJpZGUoQXR0cmlidXRlcyBhdHRyKSB7CiAgICAgICAgX292\nZXJyaWRlID0gYXR0ci5nZXRWYWx1ZSgibmFtZSIpOwogICAgICAgIHJldHVy\nbiB0cnVlOwogICAgfQoKICAgIC8qKgogICAgICogU2V0IGF0dHJpYnV0ZSBv\ndmVycmlkZSBpbnRvIHByb3BlciBtYXBwaW5nLgogICAgICovCiAgICBwcml2\nYXRlIHZvaWQgZW5kQXR0cmlidXRlT3ZlcnJpZGUoKQogICAgICAgIHRocm93\ncyBTQVhFeGNlcHRpb24gewogICAgICAgIE9iamVjdCBlbGVtID0gY3VycmVu\ndEVsZW1lbnQoKTsKICAgICAgICBGaWVsZE1hcHBpbmcgZm07CiAgICAgICAg\naWYgKGVsZW0gaW5zdGFuY2VvZiBDbGFzc01hcHBpbmcpCiAgICAgICAgICAg\nIGZtID0gZ2V0QXR0cmlidXRlT3ZlcnJpZGUoKENsYXNzTWFwcGluZykgZWxl\nbSk7CiAgICAgICAgZWxzZQogICAgICAgICAgICBmbSA9IGdldEF0dHJpYnV0\nZU92ZXJyaWRlKChGaWVsZE1hcHBpbmcpIGVsZW0pOwogICAgICAgIGlmIChf\nY29scyAhPSBudWxsKSB7CiAgICAgICAgICAgIGZtLmdldFZhbHVlSW5mbygp\nLnNldENvbHVtbnMoX2NvbHMpOwogICAgICAgICAgICBpZiAoX2NvbFRhYmxl\nICE9IG51bGwpCiAgICAgICAgICAgICAgICBmbS5nZXRNYXBwaW5nSW5mbygp\nLnNldFRhYmxlTmFtZShfY29sVGFibGUpOwogICAgICAgICAgICBzZXRVbmlx\ndWUoZm0pOwogICAgICAgIH0KICAgICAgICBjbGVhckNvbHVtbkluZm8oKTsK\nICAgICAgICBfb3ZlcnJpZGUgPSBudWxsOwogICAgfQoKICAgIC8qKgogICAg\nICogUmV0dXJuIHRoZSBwcm9wZXIgb3ZlcnJpZGUuCiAgICAgKi8KICAgIHBy\naXZhdGUgRmllbGRNYXBwaW5nIGdldEF0dHJpYnV0ZU92ZXJyaWRlKENsYXNz\nTWFwcGluZyBjbSkgewogICAgICAgIEZpZWxkTWFwcGluZyBzdXAgPSAoRmll\nbGRNYXBwaW5nKSBjbS5nZXREZWZpbmVkU3VwZXJjbGFzc0ZpZWxkCiAgICAg\nICAgICAgIChfb3ZlcnJpZGUpOwogICAgICAgIGlmIChzdXAgPT0gbnVsbCkK\nICAgICAgICAgICAgc3VwID0gKEZpZWxkTWFwcGluZykgY20uYWRkRGVmaW5l\nZFN1cGVyY2xhc3NGaWVsZChfb3ZlcnJpZGUsCiAgICAgICAgICAgICAgICBP\nYmplY3QuY2xhc3MsIE9iamVjdC5jbGFzcyk7CiAgICAgICAgcmV0dXJuIHN1\ncDsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgcHJvcGVyIG92\nZXJyaWRlLgogICAgICovCiAgICBwcml2YXRlIEZpZWxkTWFwcGluZyBnZXRB\ndHRyaWJ1dGVPdmVycmlkZShGaWVsZE1hcHBpbmcgZm0pCiAgICAgICAgdGhy\nb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgQ2xhc3NNYXBwaW5nIGVtYmVk\nID0gZm0uZ2V0RW1iZWRkZWRNYXBwaW5nKCk7CiAgICAgICAgaWYgKGVtYmVk\nID09IG51bGwpCiAgICAgICAgICAgIHRocm93IGdldEV4Y2VwdGlvbihfbG9j\nLmdldCgibm90LWVtYmVkZGVkIiwgZm0pKTsKCiAgICAgICAgRmllbGRNYXBw\naW5nIGVmbSA9IGVtYmVkLmdldEZpZWxkTWFwcGluZyhfb3ZlcnJpZGUpOwog\nICAgICAgIGlmIChlZm0gPT0gbnVsbCkKICAgICAgICAgICAgdGhyb3cgZ2V0\nRXhjZXB0aW9uKF9sb2MuZ2V0KCJlbWJlZC1vdmVycmlkZS1uYW1lIiwKICAg\nICAgICAgICAgICAgIGZtLCBfb3ZlcnJpZGUpKTsKICAgICAgICByZXR1cm4g\nZWZtOwogICAgfQoKICAgIC8qKgogICAgICogUGFyc2UgdGFibGUuCiAgICAg\nKi8KICAgIHByaXZhdGUgYm9vbGVhbiBzdGFydFRhYmxlKEF0dHJpYnV0ZXMg\nYXR0cnMpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAg\nU3RyaW5nIHRhYmxlID0gdG9UYWJsZU5hbWUoYXR0cnMuZ2V0VmFsdWUoInNj\naGVtYSIpLAogICAgICAgICAgICBhdHRycy5nZXRWYWx1ZSgibmFtZSIpKTsK\nICAgICAgICBpZiAodGFibGUgIT0gbnVsbCkKICAgICAgICAgICAgKChDbGFz\nc01hcHBpbmcpIGN1cnJlbnRFbGVtZW50KCkpLmdldE1hcHBpbmdJbmZvKCku\nc2V0VGFibGVOYW1lCiAgICAgICAgICAgICAgICAodGFibGUpOwogICAgICAg\nIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qKgogICAgICogUGFyc2Ugam9p\nbi10YWJsZS4KICAgICAqLwogICAgcHJpdmF0ZSBib29sZWFuIHN0YXJ0Sm9p\nblRhYmxlKEF0dHJpYnV0ZXMgYXR0cnMpCiAgICAgICAgdGhyb3dzIFNBWEV4\nY2VwdGlvbiB7CiAgICAgICAgU3RyaW5nIHRhYmxlID0gdG9UYWJsZU5hbWUo\nYXR0cnMuZ2V0VmFsdWUoInNjaGVtYSIpLAogICAgICAgICAgICBhdHRycy5n\nZXRWYWx1ZSgibmFtZSIpKTsKICAgICAgICBpZiAodGFibGUgIT0gbnVsbCkK\nICAgICAgICAgICAgKChGaWVsZE1hcHBpbmcpIGN1cnJlbnRFbGVtZW50KCkp\nLmdldE1hcHBpbmdJbmZvKCkuc2V0VGFibGVOYW1lCiAgICAgICAgICAgICAg\nICAodGFibGUpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8q\nKgogICAgICogU2V0IHRoZSBqb2luIHRhYmxlIGluZm9ybWF0aW9uIGJhY2su\nCiAgICAgKi8KICAgIHByaXZhdGUgdm9pZCBlbmRKb2luVGFibGUoKSB7CiAg\nICAgICAgRmllbGRNYXBwaW5nIGZtID0gKEZpZWxkTWFwcGluZykgY3VycmVu\ndEVsZW1lbnQoKTsKICAgICAgICBpZiAoX2pvaW5Db2xzICE9IG51bGwpCiAg\nICAgICAgICAgIGZtLmdldE1hcHBpbmdJbmZvKCkuc2V0Q29sdW1ucyhfam9p\nbkNvbHMpOwogICAgICAgIGlmIChfY29scyAhPSBudWxsKQogICAgICAgICAg\nICBmbS5nZXRFbGVtZW50TWFwcGluZygpLmdldFZhbHVlSW5mbygpLnNldENv\nbHVtbnMoX2NvbHMpOwogICAgICAgIGNsZWFyQ29sdW1uSW5mbygpOwogICAg\nfQoKICAgIC8qKgogICAgICogUGFyc2UgcHJpbWFyeS1rZXktam9pbi1jb2x1\nbW4uCiAgICAgKi8KICAgIHByaXZhdGUgYm9vbGVhbiBzdGFydFByaW1hcnlL\nZXlKb2luQ29sdW1uKEF0dHJpYnV0ZXMgYXR0cnMpCiAgICAgICAgdGhyb3dz\nIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgQ29sdW1uIGNvbCA9IHBhcnNlQ29s\ndW1uKGF0dHJzKTsKICAgICAgICBjb2wuc2V0RmxhZyhDb2x1bW4uRkxBR19Q\nS19KT0lOLCB0cnVlKTsKICAgICAgICAvLyBwayBqb2luIGNvbHVtbnMgb24g\nZmllbGRzIGFjdCBhcyBmaWVsZCBjb2xzCiAgICAgICAgaWYgKGN1cnJlbnRF\nbGVtZW50KCkgaW5zdGFuY2VvZiBGaWVsZE1hcHBpbmcpIHsKICAgICAgICAg\nICAgaWYgKF9jb2xzID09IG51bGwpCiAgICAgICAgICAgICAgICBfY29scyA9\nIG5ldyBBcnJheUxpc3Q8Q29sdW1uPigzKTsKICAgICAgICAgICAgX2NvbHMu\nYWRkKGNvbCk7CiAgICAgICAgfSBlbHNlIGlmIChjdXJyZW50UGFyZW50KCkg\nPT0gU0VDT05EQVJZX1RBQkxFKSB7CiAgICAgICAgICAgIC8vIHBrIGpvaW4g\nY29sdW1ucyBpbiBzZWNvbmRhcnkgdGFibGUgYWN0cyBhcyBqb2luIGNvbHMK\nICAgICAgICAgICAgaWYgKF9qb2luQ29scyA9PSBudWxsKQogICAgICAgICAg\nICAgICAgX2pvaW5Db2xzID0gbmV3IEFycmF5TGlzdDxDb2x1bW4+KDMpOwog\nICAgICAgICAgICBfam9pbkNvbHMuYWRkKGNvbCk7CiAgICAgICAgfSBlbHNl\nIHsKICAgICAgICAgICAgLy8gbXVzdCBiZSBwayBqb2luIGNvbHMgZnJvbSB0\naGlzIGNsYXNzIHRvIHN1cGVyY2xhc3MKICAgICAgICAgICAgaWYgKF9zdXBK\nb2luQ29scyA9PSBudWxsKQogICAgICAgICAgICAgICAgX3N1cEpvaW5Db2xz\nID0gbmV3IEFycmF5TGlzdDxDb2x1bW4+KDMpOwogICAgICAgICAgICBfc3Vw\nSm9pbkNvbHMuYWRkKGNvbCk7CiAgICAgICAgfQogICAgICAgIHJldHVybiB0\ncnVlOwogICAgfQoKICAgIC8qKgogICAgICogUGFyc2Ugam9pbi1jb2x1bW4u\nCiAgICAgKi8KICAgIHByaXZhdGUgYm9vbGVhbiBzdGFydEpvaW5Db2x1bW4o\nQXR0cmlidXRlcyBhdHRycykKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9u\nIHsKICAgICAgICAvLyBvbmx5IGpvaW4gY29scyBpbiBhIGpvaW4gdGFibGUg\nam9pbiBmaWVsZCB0YWJsZSB0byBjbGFzcyB0YWJsZTsKICAgICAgICAvLyBv\ndGhlcnMgYWN0IGFzIGRhdGEgZmsgY29scwogICAgICAgIGlmIChjdXJyZW50\nUGFyZW50KCkgIT0gSk9JTl9UQUJMRSkKICAgICAgICAgICAgcmV0dXJuIHN0\nYXJ0Q29sdW1uKGF0dHJzKTsKCiAgICAgICAgaWYgKF9qb2luQ29scyA9PSBu\ndWxsKQogICAgICAgICAgICBfam9pbkNvbHMgPSBuZXcgQXJyYXlMaXN0PENv\nbHVtbj4oMyk7CiAgICAgICAgX2pvaW5Db2xzLmFkZChwYXJzZUNvbHVtbihh\ndHRycykpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qKgog\nICAgICogUGFyc2UgY29sdW1uLgogICAgICovCiAgICBwcml2YXRlIGJvb2xl\nYW4gc3RhcnRDb2x1bW4oQXR0cmlidXRlcyBhdHRycykKICAgICAgICB0aHJv\nd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICBpZiAoX2NvbHMgPT0gbnVsbCkK\nICAgICAgICAgICAgX2NvbHMgPSBuZXcgQXJyYXlMaXN0PENvbHVtbj4oMyk7\nCiAgICAgICAgX2NvbHMuYWRkKHBhcnNlQ29sdW1uKGF0dHJzKSk7CiAgICAg\nICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBDcmVhdGUg\nYSBjb2x1bW4gd2l0aCB0aGUgZ2l2ZW4gYXR0cmlidXRlcy4KICAgICAqLwog\nICAgcHJpdmF0ZSBDb2x1bW4gcGFyc2VDb2x1bW4oQXR0cmlidXRlcyBhdHRy\ncykKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICBDb2x1\nbW4gY29sID0gbmV3IENvbHVtbigpOwogICAgICAgIFN0cmluZyB2YWwgPSBh\ndHRycy5nZXRWYWx1ZSgibmFtZSIpOwogICAgICAgIGlmICh2YWwgIT0gbnVs\nbCkKICAgICAgICAgICAgY29sLnNldE5hbWUodmFsKTsKICAgICAgICB2YWwg\nPSBhdHRycy5nZXRWYWx1ZSgicmVmZXJlbmNlZC1jb2x1bW4tbmFtZSIpOwog\nICAgICAgIGlmICh2YWwgIT0gbnVsbCkKICAgICAgICAgICAgY29sLnNldFRh\ncmdldCh2YWwpOwogICAgICAgIHZhbCA9IGF0dHJzLmdldFZhbHVlKCJjb2x1\nbW4tZGVmaW5pdGlvbiIpOwogICAgICAgIGlmICh2YWwgIT0gbnVsbCkKICAg\nICAgICAgICAgY29sLnNldFR5cGVOYW1lKHZhbCk7CiAgICAgICAgdmFsID0g\nYXR0cnMuZ2V0VmFsdWUoInByZWNpc2lvbiIpOwogICAgICAgIGlmICh2YWwg\nIT0gbnVsbCkKICAgICAgICAgICAgY29sLnNldFNpemUoSW50ZWdlci5wYXJz\nZUludCh2YWwpKTsKICAgICAgICB2YWwgPSBhdHRycy5nZXRWYWx1ZSgibGVu\nZ3RoIik7CiAgICAgICAgaWYgKHZhbCAhPSBudWxsKQogICAgICAgICAgICBj\nb2wuc2V0U2l6ZShJbnRlZ2VyLnBhcnNlSW50KHZhbCkpOwogICAgICAgIHZh\nbCA9IGF0dHJzLmdldFZhbHVlKCJzY2FsZSIpOwogICAgICAgIGlmICh2YWwg\nIT0gbnVsbCkKICAgICAgICAgICAgY29sLnNldERlY2ltYWxEaWdpdHMoSW50\nZWdlci5wYXJzZUludCh2YWwpKTsKICAgICAgICB2YWwgPSBhdHRycy5nZXRW\nYWx1ZSgibnVsbGFibGUiKTsKICAgICAgICBpZiAodmFsICE9IG51bGwpCiAg\nICAgICAgICAgIGNvbC5zZXROb3ROdWxsKCJmYWxzZSIuZXF1YWxzKHZhbCkp\nOwogICAgICAgIHZhbCA9IGF0dHJzLmdldFZhbHVlKCJpbnNlcnRhYmxlIik7\nCiAgICAgICAgaWYgKHZhbCAhPSBudWxsKQogICAgICAgICAgICBjb2wuc2V0\nRmxhZyhDb2x1bW4uRkxBR19VTklOU0VSVEFCTEUsICJmYWxzZSIuZXF1YWxz\nKHZhbCkpOwogICAgICAgIHZhbCA9IGF0dHJzLmdldFZhbHVlKCJ1cGRhdGFi\nbGUiKTsKICAgICAgICBpZiAodmFsICE9IG51bGwpCiAgICAgICAgICAgIGNv\nbC5zZXRGbGFnKENvbHVtbi5GTEFHX1VOVVBEQVRBQkxFLCAiZmFsc2UiLmVx\ndWFscyh2YWwpKTsKCiAgICAgICAgdmFsID0gYXR0cnMuZ2V0VmFsdWUoInVu\naXF1ZSIpOwogICAgICAgIGlmICh2YWwgIT0gbnVsbCkKICAgICAgICAgICAg\nX3VuaXF1ZS5hZGQoRW51bS52YWx1ZU9mKFVuaXF1ZUZsYWcuY2xhc3MsIHZh\nbC50b1VwcGVyQ2FzZSgpKSk7CiAgICAgICAgdmFsID0gYXR0cnMuZ2V0VmFs\ndWUoInRhYmxlIik7CiAgICAgICAgaWYgKHZhbCAhPSBudWxsKSB7CiAgICAg\nICAgICAgIGlmIChfY29sVGFibGUgIT0gbnVsbCAmJiAhX2NvbFRhYmxlLmVx\ndWFscyh2YWwpKQogICAgICAgICAgICAgICAgdGhyb3cgZ2V0RXhjZXB0aW9u\nKF9sb2MuZ2V0KCJzZWNvbmQtaW5jb25zaXN0IiwKICAgICAgICAgICAgICAg\nICAgICBjdXJyZW50RWxlbWVudCgpKSk7CiAgICAgICAgICAgIF9jb2xUYWJs\nZSA9IHZhbDsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGNvbDsKICAgIH0K\nCiAgICAvKioKICAgICAqIFJldHVybiBhIHRhYmxlIG5hbWUgZm9yIHRoZSBn\naXZlbiBhdHRyaWJ1dGVzLgogICAgICovCiAgICBwcml2YXRlIFN0cmluZyB0\nb1RhYmxlTmFtZShTdHJpbmcgc2NoZW1hLCBTdHJpbmcgdGFibGUpIHsKICAg\nICAgICBpZiAoU3RyaW5nVXRpbHMuaXNFbXB0eSh0YWJsZSkpCiAgICAgICAg\nICAgIHJldHVybiBudWxsOwogICAgICAgIGlmIChTdHJpbmdVdGlscy5pc0Vt\ncHR5KHNjaGVtYSkpCiAgICAgICAgICAgIHNjaGVtYSA9IF9zY2hlbWE7CiAg\nICAgICAgcmV0dXJuIChTdHJpbmdVdGlscy5pc0VtcHR5KHNjaGVtYSkpID8g\ndGFibGUgOiBzY2hlbWEgKyAiLiIgKyB0YWJsZTsKICAgIH0KCiAgICAvKioK\nICAgICAqIFN0YXJ0IHByb2Nlc3NpbmcgPGNvZGU+c3FsLXJlc3VsdC1zZXQt\nbWFwcGluZzwvY29kZT4gbm9kZS4KICAgICAqIFB1c2hlcyB0aGUge0BsaW5r\nIFF1ZXJ5UmVzdWx0TWFwcGluZ30gb250byB0aGUgc3RhY2sgYXMgY3VycmVu\ndCBlbGVtZW50LgogICAgICovCiAgICBwcml2YXRlIGJvb2xlYW4gc3RhcnRT\nUUxSZXN1bHRTZXRNYXBwaW5nKEF0dHJpYnV0ZXMgYXR0cnMpIHsKICAgICAg\nICBTdHJpbmcgbmFtZSA9IGF0dHJzLmdldFZhbHVlKCJuYW1lIik7CiAgICAg\nICAgTG9nIGxvZyA9IGdldExvZygpOwogICAgICAgIGlmIChsb2cuaXNUcmFj\nZUVuYWJsZWQoKSkKICAgICAgICAgICAgbG9nLnRyYWNlKF9sb2MuZ2V0KCJw\nYXJzZS1zcWxyc21hcHBpbmciLCBuYW1lKSk7CgogICAgICAgIE1hcHBpbmdS\nZXBvc2l0b3J5IHJlcG9zID0gKE1hcHBpbmdSZXBvc2l0b3J5KSBnZXRSZXBv\nc2l0b3J5KCk7CiAgICAgICAgUXVlcnlSZXN1bHRNYXBwaW5nIHJlc3VsdCA9\nIHJlcG9zLmdldENhY2hlZFF1ZXJ5UmVzdWx0TWFwcGluZwogICAgICAgICAg\nICAobnVsbCwgbmFtZSk7CiAgICAgICAgaWYgKHJlc3VsdCAhPSBudWxsICYm\nIGxvZy5pc1dhcm5FbmFibGVkKCkpCiAgICAgICAgICAgIGxvZy53YXJuKF9s\nb2MuZ2V0KCJvdmVycmlkZS1zcWxyc21hcHBpbmciLCBuYW1lLAogICAgICAg\nICAgICAgICAgY3VycmVudExvY2F0aW9uKCkpKTsKCiAgICAgICAgcmVzdWx0\nID0gcmVwb3MuYWRkUXVlcnlSZXN1bHRNYXBwaW5nKG51bGwsIG5hbWUpOwog\nICAgICAgIHJlc3VsdC5zZXRMaXN0aW5nSW5kZXgoX3Jlc3VsdElkeCsrKTsK\nICAgICAgICBhZGRDb21tZW50cyhyZXN1bHQpOwoKICAgICAgICBPYmplY3Qg\nY3VyID0gY3VycmVudEVsZW1lbnQoKTsKICAgICAgICBPYmplY3Qgc2NvcGUg\nPSAoY3VyIGluc3RhbmNlb2YgQ2xhc3NNZXRhRGF0YSkKICAgICAgICAgICAg\nPyAoKENsYXNzTWV0YURhdGEpIGN1cikuZ2V0RGVzY3JpYmVkVHlwZSgpIDog\nbnVsbDsKICAgICAgICByZXN1bHQuc2V0U291cmNlKGdldFNvdXJjZUZpbGUo\nKSwgc2NvcGUsIHJlc3VsdC5TUkNfWE1MKTsKCiAgICAgICAgcHVzaEVsZW1l\nbnQocmVzdWx0KTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBw\ncml2YXRlIHZvaWQgZW5kU1FMUmVzdWx0U2V0TWFwcGluZygpCiAgICAgICAg\ndGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgcG9wRWxlbWVudCgpOwog\nICAgfQoKICAgIC8qKgogICAgICogU3RhcnQgcHJvY2Vzc2luZyA8Y29kZT5l\nbnRpdHktcmVzdWx0PC9jb2RlPiBub2RlLgogICAgICogUHVzaGVzIHRoZSB7\nQGxpbmsgUXVlcnlSZXN1bHRNYXBwaW5nLlBDUmVzdWx0fQogICAgICogb250\nbyB0aGUgc3RhY2sgYXMgY3VycmVudCBlbGVtZW50LgogICAgICovCiAgICBw\ncml2YXRlIGJvb2xlYW4gc3RhcnRFbnRpdHlSZXN1bHQoQXR0cmlidXRlcyBh\ndHRycykKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICBD\nbGFzcyBlbnRpdHlDbGFzcyA9IGNsYXNzRm9yTmFtZShhdHRycy5nZXRWYWx1\nZSgiZW50aXR5LWNsYXNzIikpOwogICAgICAgIFN0cmluZyBkaXNjcmltaW5h\ndG9yID0gYXR0cnMuZ2V0VmFsdWUoImRpc2NyaW1pbmF0b3ItY29sdW1uIik7\nCgogICAgICAgIFF1ZXJ5UmVzdWx0TWFwcGluZyBwYXJlbnQgPSAoUXVlcnlS\nZXN1bHRNYXBwaW5nKSBjdXJyZW50RWxlbWVudCgpOwogICAgICAgIFF1ZXJ5\nUmVzdWx0TWFwcGluZy5QQ1Jlc3VsdCByZXN1bHQgPSBwYXJlbnQuYWRkUENS\nZXN1bHQoZW50aXR5Q2xhc3MpOwogICAgICAgIGlmICghU3RyaW5nVXRpbHMu\naXNFbXB0eShkaXNjcmltaW5hdG9yKSkKICAgICAgICAgICAgcmVzdWx0LmFk\nZE1hcHBpbmcocmVzdWx0LkRJU0NSSU1JTkFUT1IsIGRpc2NyaW1pbmF0b3Ip\nOwogICAgICAgIHB1c2hFbGVtZW50KHJlc3VsdCk7CiAgICAgICAgcmV0dXJu\nIHRydWU7CiAgICB9CgogICAgcHJpdmF0ZSB2b2lkIGVuZEVudGl0eVJlc3Vs\ndCgpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgcG9w\nRWxlbWVudCgpOwogICAgfQoKICAgIC8qKgogICAgICogUHJvY2VzcyBhIDxj\nb2RlPmZpZWxkLXJlc3VsdDwvY29kZT4gbm9kZS4KICAgICAqLwogICAgcHJp\ndmF0ZSBib29sZWFuIHN0YXJ0RmllbGRSZXN1bHQoQXR0cmlidXRlcyBhdHRy\ncykKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICBTdHJp\nbmcgZmllbGROYW1lID0gYXR0cnMuZ2V0VmFsdWUoIm5hbWUiKTsKICAgICAg\nICBTdHJpbmcgY29sdW1uTmFtZSA9IGF0dHJzLmdldFZhbHVlKCJjb2x1bW4i\nKTsKCiAgICAgICAgUXVlcnlSZXN1bHRNYXBwaW5nLlBDUmVzdWx0IHBhcmVu\ndCA9IChRdWVyeVJlc3VsdE1hcHBpbmcuUENSZXN1bHQpCiAgICAgICAgICAg\nIGN1cnJlbnRFbGVtZW50KCk7CiAgICAgICAgcGFyZW50LmFkZE1hcHBpbmco\nZmllbGROYW1lLCBjb2x1bW5OYW1lKTsKICAgICAgICByZXR1cm4gdHJ1ZTsK\nICAgIH0KCiAgICAvKioKICAgICAqIFByb2Nlc3MgYSA8Y29kZT5jb2x1bW4t\ncmVzdWx0PC9jb2RlPiBub2RlLgogICAgICovCiAgICBwcml2YXRlIGJvb2xl\nYW4gc3RhcnRDb2x1bW5SZXN1bHQoQXR0cmlidXRlcyBhdHRycykKICAgICAg\nICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICBRdWVyeVJlc3VsdE1h\ncHBpbmcgcGFyZW50ID0gKFF1ZXJ5UmVzdWx0TWFwcGluZykgY3VycmVudEVs\nZW1lbnQoKTsKICAgICAgICBwYXJlbnQuYWRkQ29sdW1uUmVzdWx0KGF0dHJz\nLmdldFZhbHVlKCJuYW1lIikpOwogICAgICAgIHJldHVybiB0cnVlOwogICAg\nfQoKICAgIC8qKiAKICAgICAqIFN0YXJ0cyBwcm9jZXNzaW5nICZsdDt1bmlx\ndWUtY29uc3RyYWludCZndDsgcHJvdmlkZWQgdGhlIHRhZyBvY2N1cnMKICAg\nICAqIHdpdGhpbiBhIENsYXNzTWFwcGluZyBlbGVtZW50IGFuZCA8ZW0+bm90\nPC9lbT4gd2l0aGluIGEgc2Vjb25kYXJ5CiAgICAgKiB0YWJsZS4gCiAgICAg\nKiBQdXNoZXMgdGhlIFVuaXF1ZSBlbGVtZW50IGluIHRoZSBzdGFjay4KICAg\nICAqLwogICAgcHJpdmF0ZSBib29sZWFuIHN0YXJ0VW5pcXVlQ29uc3RyYWlu\ndChBdHRyaWJ1dGVzIGF0dHJzKSAKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0\naW9uIHsKICAgICAgICBPYmplY3QgY3VycmVudCA9IGN1cnJlbnRFbGVtZW50\nKCk7CiAgICAgICAgaWYgKGN1cnJlbnQgaW5zdGFuY2VvZiBDbGFzc01hcHBp\nbmcgJiYgX3NlY29uZGFyeVRhYmxlID09IG51bGwpIHsKICAgICAgICAgICAg\nVW5pcXVlIHVuaXF1ZSA9IG5ldyBVbmlxdWUoKTsKICAgICAgICAgICAgcHVz\naEVsZW1lbnQodW5pcXVlKTsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAg\nICAgICAgfSAKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgICAKICAg\nIC8qKgogICAgICogRW5kcyBwcm9jZXNzaW5nICZsdDt1bmlxdWUtY29uc3Ry\nYWludCZndDsgcHJvdmlkZWQgdGhlIHRhZyBvY2N1cnMKICAgICAqIHdpdGhp\nbiBhIENsYXNzTWFwcGluZyBlbGVtZW50IGFuZCA8ZW0+bm90PC9lbT4gd2l0\naGluIGEgc2Vjb25kYXJ5CiAgICAgKiB0YWJsZS4gVGhlIHN0YWNrIGlzIHBv\ncHBlZCBhbmQgdGhlIFVuaXF1ZSBlbGVtZW50IGlzIGFkZGVkIHRvIHRoZQog\nICAgICogQ2xhc3NNYXBwaW5nSW5mby4gCiAgICAgKi8KICAgIHByaXZhdGUg\ndm9pZCBlbmRVbmlxdWVDb25zdHJhaW50KCkgewogICAgICAgIFVuaXF1ZSB1\nbmlxdWUgPSAoVW5pcXVlKSBwb3BFbGVtZW50KCk7CiAgICAgICAgT2JqZWN0\nIGN1cnJlbnQgPSBjdXJyZW50RWxlbWVudCgpOwogICAgICAgIGlmIChjdXJy\nZW50IGluc3RhbmNlb2YgQ2xhc3NNYXBwaW5nICYmIF9zZWNvbmRhcnlUYWJs\nZSA9PSBudWxsKQogICAgICAgICAgICAoKENsYXNzTWFwcGluZykgY3VycmVu\ndCkuZ2V0TWFwcGluZ0luZm8oKS5hZGRVbmlxdWUodW5pcXVlKTsKICAgIH0K\nICAgIAogICAgLyoqCiAgICAgKiBFbmRzIHByb2Nlc3NpbmcgJmx0O2NvbHVt\nbi1uYW1lJmd0OyB0YWcgYnkgYWRkaW5nIHRoZSBjb2x1bW4gbmFtZSBpbgog\nICAgICogdGhlIGN1cnJlbnQgVW5pcXVlIGVsZW1lbnQgdGhhdCByZXNpZGVz\nIGluIHRoZSB0b3Agb2YgdGhlIHN0YWNrLgogICAgICovCiAgICBwcml2YXRl\nIGJvb2xlYW4gZW5kQ29sdW1uTmFtZSgpIHsKICAgICAgICBPYmplY3QgY3Vy\ncmVudCA9IGN1cnJlbnRFbGVtZW50KCk7CiAgICAgICAgaWYgKGN1cnJlbnQg\naW5zdGFuY2VvZiBVbmlxdWUpIHsKICAgICAgICAgICAgVW5pcXVlIHVuaXF1\nZSA9IChVbmlxdWUpIGN1cnJlbnQ7CiAgICAgICAgICAgIENvbHVtbiBjb2x1\nbW4gPSBuZXcgQ29sdW1uKCk7CiAgICAgICAgICAgIGNvbHVtbi5zZXROYW1l\nKHRoaXMuY3VycmVudFRleHQoKSk7CiAgICAgICAgICAgIHVuaXF1ZS5hZGRD\nb2x1bW4oY29sdW1uKTsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAg\nICAgfQogICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KICAgIAogICAgLyoq\nCiAgICAgKiBUcmFjayB1bmlxdWUgY29sdW1uIHNldHRpbmdzLgoJICovCglw\ncml2YXRlIHN0YXRpYyBlbnVtIFVuaXF1ZUZsYWcKCXsKCQlUUlVFLAoJCUZB\nTFNFCgl9CgkKCXByaXZhdGUgdm9pZCBwYXJzZURpc2NyaW1pbmF0b3JDb2x1\nbW4oQXR0cmlidXRlcyBhdHRycykgeyAKCSAgICBTdHJpbmcgdmFsID0gYXR0\ncnMuZ2V0VmFsdWUoImRpc2NyaW1pbmF0b3ItdHlwZSIpOwogICAgICAgIGlm\nICh2YWwgIT0gbnVsbCkgewogICAgICAgICAgICBfZGlzY1R5cGUgPSBFbnVt\nLnZhbHVlT2YoRGlzY3JpbWluYXRvclR5cGUuY2xhc3MsIHZhbCk7CiAgICAg\nICAgfQogICAgICAgIGVsc2UgewogICAgICAgICAgICBfZGlzY1R5cGUgPSBE\naXNjcmltaW5hdG9yVHlwZS5TVFJJTkc7CiAgICAgICAgfQogICAgICAgICAg\nICAKCX0KfQo=\n","encoding":"base64"}

