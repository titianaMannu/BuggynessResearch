{"sha":"41c0298fb2d6920bedffee052d518482974b6674","node_id":"MDQ6QmxvYjIwNjM2NDo0MWMwMjk4ZmIyZDY5MjBiZWRmZmVlMDUyZDUxODQ4Mjk3NGI2Njc0","size":6494,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/41c0298fb2d6920bedffee052d518482974b6674","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuamRiYzsK\nCmltcG9ydCBqYXZheC5wZXJzaXN0ZW5jZS5RdWVyeTsKCmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UudGVzdC5TUUxMaXN0ZW5lclRl\nc3RDYXNlOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNl\nLnNpbXBsZS5BbGxGaWVsZFR5cGVzOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLnBlcnNpc3RlbmNlLk9wZW5KUEFRdWVyeTsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5JbnZhbGlkU3RhdGVFeGNlcHRpb247\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuT3BlbkpQ\nQUVudGl0eU1hbmFnZXJTUEk7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\namRiYy5zcWwuREJEaWN0aW9uYXJ5OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLmpkYmMuc3FsLkRCMkRpY3Rpb25hcnk7CmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEuamRiYy5zcWwuSFNRTERpY3Rpb25hcnk7CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEuamRiYy5jb25mLkpEQkNDb25maWd1cmF0aW9uOwoK\ncHVibGljIGNsYXNzIFRlc3RJc29sYXRpb25MZXZlbE92ZXJyaWRlCiAgICBl\neHRlbmRzIFNRTExpc3RlbmVyVGVzdENhc2UgewoKICAgIHB1YmxpYyB2b2lk\nIHNldFVwKCkgewogICAgICAgIHNldFVwKEFsbEZpZWxkVHlwZXMuY2xhc3Ms\nCiAgICAgICAgICAgICJvcGVuanBhLk9wdGltaXN0aWMiLCAiZmFsc2UiLAog\nICAgICAgICAgICAib3BlbmpwYS5Mb2NrTWFuYWdlciIsICJwZXNzaW1pc3Rp\nYyIpOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHRlc3RJc29sYXRpb25PdmVy\ncmlkZVZpYUZldGNoUGxhbigpIHsKICAgICAgICB0ZXN0SXNvbGF0aW9uTGV2\nZWxPdmVycmlkZShmYWxzZSwgZmFsc2UpOwogICAgfQoKICAgIHB1YmxpYyB2\nb2lkIHRlc3RJc29sYXRpb25PdmVycmlkZVZpYUhpbnQoKSB7CiAgICAgICAg\ndGVzdElzb2xhdGlvbkxldmVsT3ZlcnJpZGUodHJ1ZSwgZmFsc2UpOwogICAg\nfQoKICAgIHB1YmxpYyB2b2lkIHRlc3RJc29sYXRpb25PdmVycmlkZVZpYVN0\ncmluZ0hpbnQoKSB7CiAgICAgICAgdGVzdElzb2xhdGlvbkxldmVsT3ZlcnJp\nZGUodHJ1ZSwgdHJ1ZSk7CiAgICB9CgogICAgcHVibGljIHZvaWQgdGVzdElz\nb2xhdGlvbkxldmVsT3ZlcnJpZGUoYm9vbGVhbiB1c2VIaW50c0FuZFF1ZXJp\nZXMsCiAgICAgICAgYm9vbGVhbiB1c2VTdHJpbmdIaW50cykgewogICAgICAg\nIE9wZW5KUEFFbnRpdHlNYW5hZ2VyU1BJIGVtID0gZW1mLmNyZWF0ZUVudGl0\neU1hbmFnZXIoKTsKICAgICAgICBEQkRpY3Rpb25hcnkgZGljdCA9ICgoSkRC\nQ0NvbmZpZ3VyYXRpb24pIGVtLmdldENvbmZpZ3VyYXRpb24oKSkKICAgICAg\nICAgICAgLmdldERCRGljdGlvbmFyeUluc3RhbmNlKCk7CgogICAgICAgIC8v\nIGhzcWwgZG9lc24ndCBzdXBwb3J0IGxvY2tpbmc7IGNpcmN1bXZlbnQgdGhl\nIHRlc3QKICAgICAgICBpZiAoZGljdCBpbnN0YW5jZW9mIEhTUUxEaWN0aW9u\nYXJ5KQogICAgICAgICAgICByZXR1cm47CgogICAgICAgIHNxbC5jbGVhcigp\nOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIGVtLmdldFRyYW5zYWN0aW9u\nKCkuYmVnaW4oKTsKICAgICAgICAgICAgaWYgKHVzZUhpbnRzQW5kUXVlcmll\ncykgewogICAgICAgICAgICAgICAgUXVlcnkgcSA9IGVtLmNyZWF0ZVF1ZXJ5\nKAogICAgICAgICAgICAgICAgInNlbGVjdCBvIGZyb20gQWxsRmllbGRUeXBl\ncyBvIHdoZXJlIG8uaW50RmllbGQgPSA6cCIpOwogICAgICAgICAgICAgICAg\ncS5zZXRQYXJhbWV0ZXIoInAiLCAwKTsKICAgICAgICAgICAgICAgIGlmICh1\nc2VTdHJpbmdIaW50cykgewogICAgICAgICAgICAgICAgICAgIHEuc2V0SGlu\ndCgib3BlbmpwYS5GZXRjaFBsYW4uSXNvbGF0aW9uIiwgIlNFUklBTElaQUJM\nRSIpOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAg\nICAgICBxLnNldEhpbnQoIm9wZW5qcGEuRmV0Y2hQbGFuLklzb2xhdGlvbiIs\nCiAgICAgICAgICAgICAgICAgICAgICAgIElzb2xhdGlvbkxldmVsLlNFUklB\nTElaQUJMRSk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAg\nYXNzZXJ0RXF1YWxzKElzb2xhdGlvbkxldmVsLlNFUklBTElaQUJMRSwKICAg\nICAgICAgICAgICAgICAgICAoKEpEQkNGZXRjaFBsYW4pICgoT3BlbkpQQVF1\nZXJ5KSBxKS5nZXRGZXRjaFBsYW4oKSkKICAgICAgICAgICAgICAgICAgICAg\nICAgLmdldElzb2xhdGlvbigpKTsKCiAgICAgICAgICAgICAgICBxLmdldFJl\nc3VsdExpc3QoKTsKICAgICAgICAgICAgICAgIGlmIChkaWN0IGluc3RhbmNl\nb2YgREIyRGljdGlvbmFyeSkgewogICAgICAgICAgICAgICAgICAgIGludCBk\nYjJzZXJ2ZXIgPSAoKERCMkRpY3Rpb25hcnkpIGRpY3QpLmdldERiMlNlcnZl\nclR5cGUoKTsKICAgICAgICAgICAgICAgICAgICBpZiAoZGIyc2VydmVyID09\nIERCMkRpY3Rpb25hcnkuZGIySVNlcmllc1Y1UjNPckVhcmxpZXIKICAgICAg\nICAgICAgICAgICAgICAgICAgfHwgZGIyc2VydmVyID09IERCMkRpY3Rpb25h\ncnkuZGIyVURCVjgxT3JFYXJsaWVyKSB7CiAgICAgICAgICAgICAgICAgICAg\nICAgIGFzc2VydEVxdWFscygxLCBzcWwuc2l6ZSgpKTsKICAgICAgICAgICAg\nICAgICAgICAgICAgYXNzZXJ0Q29udGFpbnNTUUwoIiBGT1IgVVBEQVRFIik7\nCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIC8v\nIGl0IGlzIERCMiB2ODIgb3IgbGF0ZXIKICAgICAgICAgICAgICAgICAgICBl\nbHNlIGlmIChkYjJzZXJ2ZXIgPT0gREIyRGljdGlvbmFyeS5kYjJaT1NWOHhP\nckxhdGVyCiAgICAgICAgICAgICAgICAgICAgICAgIHx8IGRiMnNlcnZlciA9\nPSBEQjJEaWN0aW9uYXJ5LmRiMlVEQlY4Mk9yTGF0ZXIpIHsKICAgICAgICAg\nICAgICAgICAgICAgICAgYXNzZXJ0RXF1YWxzKDEsIHNxbC5zaXplKCkpOwog\nICAgICAgICAgICAgICAgICAgICAgICBhc3NlcnRDb250YWluc1NRTCgiIEZP\nUiBSRUFEIE9OTFkgV0lUSCBSUiBVU0UgQU5EIEtFRVAgIiAKICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICsgIlVQREFURSBMT0NLUyIpOwogICAgICAg\nICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChk\nYjJzZXJ2ZXIgPT0gREIyRGljdGlvbmFyeS5kYjJJU2VyaWVzVjVSNE9yTGF0\nZXIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgYXNzZXJ0RXF1YWxzKDEs\nIHNxbC5zaXplKCkpOwogICAgICAgICAgICAgICAgICAgICAgICBhc3NlcnRD\nb250YWluc1NRTCgiIEZPUiBSRUFEIE9OTFkgV0lUSCBSUiBVU0UgQU5EIEtF\nRVAiIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgKyAiIEVYQ0xVU0lW\nRSBMT0NLUyIpOwogICAgICAgICAgICAgICAgICAgIH0gICAgCiAgICAgICAg\nICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGZh\naWwoIk9wZW5KUEEgY3VycmVudGx5IG9ubHkgc3VwcG9ydHMgIiAKICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICsicGVyLXF1ZXJ5IGlzb2xhdGlvbiBs\nZXZlbCBjb25maWd1cmF0aW9uIG9uIHRoZSIgCiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICArIiBmb2xsb3dpbmcgZGF0YWJhc2VzOiBEQjIiKTsKICAg\nICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9ICAgIAogICAg\nICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgKChKREJDRmV0Y2hQ\nbGFuKSBlbS5nZXRGZXRjaFBsYW4oKSkKICAgICAgICAgICAgICAgICAgICAu\nc2V0SXNvbGF0aW9uKElzb2xhdGlvbkxldmVsLlNFUklBTElaQUJMRSk7CiAg\nICAgICAgICAgICAgICBlbS5maW5kKEFsbEZpZWxkVHlwZXMuY2xhc3MsIDAp\nOwogICAgICAgICAgICAgICAgaWYgKGRpY3QgaW5zdGFuY2VvZiBEQjJEaWN0\naW9uYXJ5ICkgewogICAgICAgICAgICAgICAgICAgIGludCBkYjJzZXJ2ZXIg\nPSAoKERCMkRpY3Rpb25hcnkpIGRpY3QpLmdldERiMlNlcnZlclR5cGUoKTsK\nICAgICAgICAgICAgICAgICAgICBpZiAoZGIyc2VydmVyID09IERCMkRpY3Rp\nb25hcnkuZGIySVNlcmllc1Y1UjNPckVhcmxpZXIKICAgICAgICAgICAgICAg\nICAgICAgICAgfHwgZGIyc2VydmVyID09IERCMkRpY3Rpb25hcnkuZGIyVURC\nVjgxT3JFYXJsaWVyKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGFzc2Vy\ndEVxdWFscygxLCBzcWwuc2l6ZSgpKTsKICAgICAgICAgICAgICAgICAgICAg\nICAgYXNzZXJ0Q29udGFpbnNTUUwoIiBvcHRpbWl6ZSBmb3IgMSByb3cgRk9S\nIFVQREFURSIpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAg\nICAgICAgICAvLyBpdCBpcyBEQjIgdjgyIG9yIGxhdGVyCiAgICAgICAgICAg\nICAgICAgICAgZWxzZSBpZiAoZGIyc2VydmVyID09IERCMkRpY3Rpb25hcnku\nZGIyWk9TVjh4T3JMYXRlcgogICAgICAgICAgICAgICAgICAgICAgICB8fCBk\nYjJzZXJ2ZXIgPT0gREIyRGljdGlvbmFyeS5kYjJVREJWODJPckxhdGVyKSB7\nCiAgICAgICAgICAgICAgICAgICAgICAgIGFzc2VydEVxdWFscygxLCBzcWwu\nc2l6ZSgpKTsKICAgICAgICAgICAgICAgICAgICAgICAgYXNzZXJ0Q29udGFp\nbnNTUUwoIiBvcHRpbWl6ZSBmb3IgMSByb3ciCiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICArICIgRk9SIFJFQUQgT05MWSBXSVRIIFJSIFVTRSBBTkQg\nS0VFUCBVUERBVEUgTE9DS1MiIAogICAgICAgICAgICAgICAgICAgICAgICAg\nICAgKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAg\nICAgZWxzZSBpZiAoZGIyc2VydmVyID09IERCMkRpY3Rpb25hcnkuZGIySVNl\ncmllc1Y1UjRPckxhdGVyKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGFz\nc2VydEVxdWFscygxLCBzcWwuc2l6ZSgpKTsKICAgICAgICAgICAgICAgICAg\nICAgICAgYXNzZXJ0Q29udGFpbnNTUUwoIiBvcHRpbWl6ZSBmb3IgMSByb3ci\nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICArICIgRk9SIFJFQUQgT05M\nWSBXSVRIIFJSIFVTRSBBTkQgS0VFUCBFWENMVVNJVkUiIAogICAgICAgICAg\nICAgICAgICAgICAgICAgICAgKyAiIExPQ0tTIik7CiAgICAgICAgICAgICAg\nICAgICAgfSAgICAKICAgICAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAg\nICAgICAgICAgICAgICAgICAgZmFpbCgiT3BlbkpQQSBjdXJyZW50bHkgb25s\neSBzdXBwb3J0cyBwZXItcXVlcnkiIAogICAgICAgICAgICAgICAgICAgICAg\nICAgICAgKyIgaXNvbGF0aW9uIGxldmVsIGNvbmZpZ3VyYXRpb24gb24gdGhl\nIGZvbGxvd2luZyIgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICArIiBk\nYXRhYmFzZXM6IERCMiIpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAg\nICAgICAgICAgIH0gICAgCiAgICAgICAgICAgIH0KICAgICAgICB9IGNhdGNo\nIChJbnZhbGlkU3RhdGVFeGNlcHRpb24gcGUpIHsKICAgICAgICAgICAgLy8g\naWYgd2UncmUgbm90IHVzaW5nIERCMiwgd2UgZXhwZWN0IGFuIEludmFsaWRT\ndGF0ZUV4Y2VwdGlvbi4KICAgICAgICAgICAgaWYgKGRpY3QgaW5zdGFuY2Vv\nZiBEQjJEaWN0aW9uYXJ5KQogICAgICAgICAgICAgICAgdGhyb3cgcGU7CiAg\nICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgZW0uZ2V0VHJhbnNhY3Rp\nb24oKS5yb2xsYmFjaygpOwogICAgICAgICAgICBlbS5jbG9zZSgpOwogICAg\nICAgIH0KICAgIH0KfQo=\n","encoding":"base64"}

