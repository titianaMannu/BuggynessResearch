{"sha":"8d0ff32c0c07186fb541d90e5c63c2a50ac6e4ea","node_id":"MDQ6QmxvYjIwNjM2NDo4ZDBmZjMyYzBjMDcxODZmYjU0MWQ5MGU1YzYzYzJhNTBhYzZlNGVh","size":32019,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/8d0ff32c0c07186fb541d90e5c63c2a50ac6e4ea","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5rZXJuZWw7CgppbXBv\ncnQgamF2YS5pby5TZXJpYWxpemFibGU7CmltcG9ydCBqYXZhLnNxbC5Db25u\nZWN0aW9uOwppbXBvcnQgamF2YS5zcWwuUHJlcGFyZWRTdGF0ZW1lbnQ7Cmlt\ncG9ydCBqYXZhLnNxbC5SZXN1bHRTZXQ7CmltcG9ydCBqYXZhLnNxbC5TUUxF\neGNlcHRpb247CmltcG9ydCBqYXZhLnNxbC5UeXBlczsKaW1wb3J0IGphdmEu\ndXRpbC5IYXNoTWFwOwoKaW1wb3J0IGphdmF4LnRyYW5zYWN0aW9uLk5vdFN1\ncHBvcnRlZEV4Y2VwdGlvbjsKCmltcG9ydCBvcmcuYXBhY2hlLmNvbW1vbnMu\nbGFuZy5TdHJpbmdVdGlsczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5q\nZGJjLmNvbmYuSkRCQ0NvbmZpZ3VyYXRpb247CmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEuamRiYy5jb25mLkpEQkNDb25maWd1cmF0aW9uSW1wbDsKaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLm1ldGEuQ2xhc3NNYXBwaW5n\nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1hLkNvbHVt\nbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNjaGVtYS5Qcmlt\nYXJ5S2V5OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1h\nLlNjaGVtYTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNjaGVt\nYS5TY2hlbWFHcm91cDsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJj\nLnNjaGVtYS5TY2hlbWFUb29sOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLmpkYmMuc2NoZW1hLlNjaGVtYXM7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEuamRiYy5zY2hlbWEuVGFibGU7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEuamRiYy5zY2hlbWEuVW5pcXVlOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLmpkYmMuc3FsLkRCRGljdGlvbmFyeTsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS5qZGJjLnNxbC5Sb3dJbXBsOwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLmpkYmMuc3FsLlNRTEJ1ZmZlcjsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS5saWIuY29uZi5Db25maWd1cmFibGU7CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEubGliLmNvbmYuQ29uZmlndXJhdGlvbjsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5saWIuY29uZi5Db25maWd1cmF0aW9uczsKaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIubG9nLkxvZzsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5saWIudXRpbC5Mb2NhbGl6ZXI7CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuT3B0aW9uczsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5tZXRhLkphdmFUeXBlczsKaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS51dGlsLkludmFsaWRTdGF0ZUV4Y2VwdGlvbjsKaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLlVzZXJFeGNlcHRpb247Cgpp\nbXBvcnQgc2VycC51dGlsLk51bWJlcnM7CmltcG9ydCBzZXJwLnV0aWwuU3Ry\naW5nczsKCi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v\nLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwovLyBOT1RFOiBEbyBub3QgY2hhbmdl\nIHByb3BlcnR5IG5hbWVzOyBzZWUgU2VxdWVuY2VNZXRhRGF0YQovLyBhbmQg\nU2VxdWVuY2VNYXBwaW5nIGZvciBzdGFuZGFyZCBwcm9wZXJ0eSBuYW1lcy4K\nLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8v\nLy8vLy8vLy8vLy8vLy8vCgovKioKICoge0BsaW5rIEpEQkNTZXF9IGltcGxl\nbWVudGF0aW9uIHRoYXQgdXNlcyBhIGRhdGFiYXNlIHRhYmxlCiAqIGZvciBz\nZXF1ZW5jZSBudW1iZXIgZ2VuZXJhdGlvbi4gVGhpcyBiYXNlIGltcGxlbWVu\ndGF0aW9uIHVzZXMgYSBzaW5nbGUKICogcm93IGZvciBhIGdsb2JhbCBzZXF1\nZW5jZSBudW1iZXIuCiAqCiAqIEBhdXRob3IgQWJlIFdoaXRlCiAqLwpwdWJs\naWMgY2xhc3MgVGFibGVKREJDU2VxCiAgICBleHRlbmRzIEFic3RyYWN0SkRC\nQ1NlcQogICAgaW1wbGVtZW50cyBDb25maWd1cmFibGUgewoKICAgIHB1Ymxp\nYyBzdGF0aWMgZmluYWwgU3RyaW5nIEFDVElPTl9EUk9QID0gImRyb3AiOwog\nICAgcHVibGljIHN0YXRpYyBmaW5hbCBTdHJpbmcgQUNUSU9OX0FERCA9ICJh\nZGQiOwogICAgcHVibGljIHN0YXRpYyBmaW5hbCBTdHJpbmcgQUNUSU9OX0dF\nVCA9ICJnZXQiOwogICAgcHVibGljIHN0YXRpYyBmaW5hbCBTdHJpbmcgQUNU\nSU9OX1NFVCA9ICJzZXQiOwoKICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIExv\nY2FsaXplciBfbG9jID0gTG9jYWxpemVyLmZvclBhY2thZ2UKICAgICAgICAo\nVGFibGVKREJDU2VxLmNsYXNzKTsKCiAgICBwcml2YXRlIHRyYW5zaWVudCBK\nREJDQ29uZmlndXJhdGlvbiBfY29uZiA9IG51bGw7CiAgICBwcml2YXRlIHRy\nYW5zaWVudCBMb2cgX2xvZyA9IG51bGw7CiAgICBwcml2YXRlIGludCBfYWxs\nb2MgPSA1MDsKICAgIHByaXZhdGUgaW50IF9pbnRWYWx1ZSA9IDE7CiAgICBw\ncml2YXRlIGZpbmFsIEhhc2hNYXA8Q2xhc3NNYXBwaW5nLCBTdGF0dXM+IF9z\ndGF0ID0KICAgICAgICBuZXcgSGFzaE1hcDxDbGFzc01hcHBpbmcsIFN0YXR1\ncz4oKTsKCiAgICBwcml2YXRlIFN0cmluZyBfdGFibGUgPSAiT1BFTkpQQV9T\nRVFVRU5DRV9UQUJMRSI7CiAgICBwcml2YXRlIFN0cmluZyBfc2VxQ29sdW1u\nTmFtZSA9ICJTRVFVRU5DRV9WQUxVRSI7CiAgICBwcml2YXRlIFN0cmluZyBf\ncGtDb2x1bW5OYW1lID0gIklEIjsKICAgIHByaXZhdGUgU3RyaW5nW10gX3Vu\naXF1ZUNvbHVtbk5hbWVzOwoKICAgIHByaXZhdGUgQ29sdW1uIF9zZXFDb2x1\nbW4gPSBudWxsOwogICAgcHJpdmF0ZSBDb2x1bW4gX3BrQ29sdW1uID0gbnVs\nbDsKICAgIAogICAgLyoqCiAgICAgKiBUaGUgc2VxdWVuY2UgdGFibGUgbmFt\nZS4gRGVmYXVsdHMgdG8gPGNvZGU+T1BFTkpQQV9TRVFVRU5DRV9UQUJMRTwv\nY29kZT4uCiAgICAgKiBCeSBkZWZhdWx0LCB0aGUgdGFibGUgd2lsbCBiZSBw\nbGFjZWQgaW4gdGhlIGZpcnN0IHNjaGVtYSBsaXN0ZWQgaW4geW91cgogICAg\nICogPGNvZGU+b3BlbmpwYS5qZGJjLlNjaGVtYXM8L2NvZGU+IHByb3BlcnR5\nLCBvciBpbiB0aGUgZGVmYXVsdCBzY2hlbWEgaWYKICAgICAqIHRoZSBwcm9w\nZXJ0eSBpcyBub3QgZ2l2ZW4uIElmIHlvdSBzcGVjaWZ5IGEgdGFibGUgbmFt\nZSBpbiB0aGUgZm9ybQogICAgICogPGNvZGU+Jmx0O3NjaGVtYSZndDsuJmx0\nO3RhYmxlJmd0OzwvY29kZT4sIHRoZW4gdGhlIGdpdmVuIHNjaGVtYQogICAg\nICogd2lsbCBiZSB1c2VkLgogICAgICovCiAgICBwdWJsaWMgU3RyaW5nIGdl\ndFRhYmxlKCkgewogICAgICAgIHJldHVybiBfdGFibGU7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBUaGUgc2VxdWVuY2UgdGFibGUgbmFtZS4gRGVmYXVsdHMg\ndG8gPGNvZGU+T1BFTkpQQV9TRVFVRU5DRV9UQUJMRTwvY29kZT4uCiAgICAg\nKiBCeSBkZWZhdWx0LCB0aGUgdGFibGUgd2lsbCBiZSBwbGFjZWQgaW4gdGhl\nIGZpcnN0IHNjaGVtYSBsaXN0ZWQgaW4geW91cgogICAgICogPGNvZGU+b3Bl\nbmpwYS5qZGJjLlNjaGVtYXM8L2NvZGU+IHByb3BlcnR5LCBvciBpbiB0aGUg\nZGVmYXVsdCBzY2hlbWEgaWYKICAgICAqIHRoZSBwcm9wZXJ0eSBpcyBub3Qg\nZ2l2ZW4uIElmIHlvdSBzcGVjaWZ5IGEgdGFibGUgbmFtZSBpbiB0aGUgZm9y\nbQogICAgICogPGNvZGU+Jmx0O3NjaGVtYSZndDsuJmx0O3RhYmxlJmd0Ozwv\nY29kZT4sIHRoZW4gdGhlIGdpdmVuIHNjaGVtYQogICAgICogd2lsbCBiZSB1\nc2VkLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRUYWJsZShTdHJpbmcg\nbmFtZSkgewogICAgICAgIF90YWJsZSA9IG5hbWU7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBAZGVwcmVjYXRlZCBVc2Uge0BsaW5rICNzZXRUYWJsZX0uIFJl\ndGFpbmVkIGZvcgogICAgICogYmFja3dhcmRzLWNvbXBhdGliaWxpdHkJd2l0\naCBhdXRvLWNvbmZpZ3VyYXRpb24uCiAgICAgKi8KICAgIHB1YmxpYyB2b2lk\nIHNldFRhYmxlTmFtZShTdHJpbmcgbmFtZSkgewogICAgICAgIHNldFRhYmxl\nKG5hbWUpOwogICAgfQoKICAgIC8qKgogICAgICogVGhlIG5hbWUgb2YgdGhl\nIGNvbHVtbiB0aGF0IGhvbGRzIHRoZSBzZXF1ZW5jZSB2YWx1ZS4gRGVmYXVs\ndHMKICAgICAqIHRvIDxjb2RlPlNFUVVFTkNFX1ZBTFVFPC9jb2RlPi4KICAg\nICAqLwogICAgcHVibGljIFN0cmluZyBnZXRTZXF1ZW5jZUNvbHVtbigpIHsK\nICAgICAgICByZXR1cm4gX3NlcUNvbHVtbk5hbWU7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBUaGUgbmFtZSBvZiB0aGUgY29sdW1uIHRoYXQgaG9sZHMgdGhl\nIHNlcXVlbmNlIHZhbHVlLiBEZWZhdWx0cwogICAgICogdG8gPGNvZGU+U0VR\nVUVOQ0VfVkFMVUU8L2NvZGU+LgogICAgICovCiAgICBwdWJsaWMgdm9pZCBz\nZXRTZXF1ZW5jZUNvbHVtbihTdHJpbmcgc2VxdWVuY2VDb2x1bW4pIHsKICAg\nICAgICBfc2VxQ29sdW1uTmFtZSA9IHNlcXVlbmNlQ29sdW1uOwogICAgfQoK\nICAgIC8qKgogICAgICogVGhlIG5hbWUgb2YgdGhlIHRhYmxlJ3MgcHJpbWFy\neSBrZXkgY29sdW1uLiBEZWZhdWx0cyB0bwogICAgICogPGNvZGU+SUQ8L2Nv\nZGU+LgogICAgICovCiAgICBwdWJsaWMgU3RyaW5nIGdldFByaW1hcnlLZXlD\nb2x1bW4oKSB7CiAgICAgICAgcmV0dXJuIF9wa0NvbHVtbk5hbWU7CiAgICB9\nCgogICAgLyoqCiAgICAgKiBUaGUgbmFtZSBvZiB0aGUgdGFibGUncyBwcmlt\nYXJ5IGtleSBjb2x1bW4uIERlZmF1bHRzIHRvCiAgICAgKiA8Y29kZT5JRDwv\nY29kZT4uCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldFByaW1hcnlLZXlD\nb2x1bW4oU3RyaW5nIHByaW1hcnlLZXlDb2x1bW4pIHsKICAgICAgICBfcGtD\nb2x1bW5OYW1lID0gcHJpbWFyeUtleUNvbHVtbjsKICAgIH0KCiAgICAvKioK\nICAgICAqIFJldHVybiB0aGUgbnVtYmVyIG9mIHNlcXVlbmNlcyB0byBhbGxv\nY2F0ZSBmb3IgZWFjaCB1cGRhdGUgb2YgdGhlCiAgICAgKiBzZXF1ZW5jZSB0\nYWJsZS4gU2VxdWVuY2UgbnVtYmVycyB3aWxsIGJlIGdyYWJiZWQgaW4gYmxv\nY2tzIG9mIHRoaXMKICAgICAqIHZhbHVlIHRvIHJlZHVjZSB0aGUgbnVtYmVy\nIG9mIHRyYW5zYWN0aW9ucyB0aGF0IG11c3QgYmUgcGVyZm9ybWVkIG9uCiAg\nICAgKiB0aGUgc2VxdWVuY2UgdGFibGUuCiAgICAgKi8KICAgIHB1YmxpYyBp\nbnQgZ2V0QWxsb2NhdGUoKSB7CiAgICAgICAgcmV0dXJuIF9hbGxvYzsKICAg\nIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgbnVtYmVyIG9mIHNlcXVl\nbmNlcyB0byBhbGxvY2F0ZSBmb3IgZWFjaCB1cGRhdGUgb2YgdGhlCiAgICAg\nKiBzZXF1ZW5jZSB0YWJsZS4gU2VxdWVuY2UgbnVtYmVycyB3aWxsIGJlIGdy\nYWJiZWQgaW4gYmxvY2tzIG9mIHRoaXMKICAgICAqIHZhbHVlIHRvIHJlZHVj\nZSB0aGUgbnVtYmVyIG9mIHRyYW5zYWN0aW9ucyB0aGF0IG11c3QgYmUgcGVy\nZm9ybWVkIG9uCiAgICAgKiB0aGUgc2VxdWVuY2UgdGFibGUuCiAgICAgKi8K\nICAgIHB1YmxpYyB2b2lkIHNldEFsbG9jYXRlKGludCBhbGxvYykgewogICAg\nICAgIF9hbGxvYyA9IGFsbG9jOwogICAgfQogICAgCiAgICAvKioKICAgICAq\nIFJldHVybiB0aGUgbnVtYmVyIGFzIHRoZSBpbml0aWFsIG51bWJlciBmb3Ig\ndGhlIAogICAgICogR2VuZXJhdGVkVmFsdWUuVEFCTEUgc3RyYXRlZ3kgdG8g\nc3RhcnQgd2l0aC4gCiAgICAgKiBAcmV0dXJuIGFuIGluaXRpYWwgbnVtYmVy\nCiAgICAgKi8KICAgIHB1YmxpYyBpbnQgZ2V0SW5pdGlhbFZhbHVlKCkgeyAg\nICAgICAgCiAgICAgICAgcmV0dXJuIF9pbnRWYWx1ZTsKICAgIH0KCiAgICAv\nKioKICAgICAqIFNldCB0aGUgaW5pdGlhbCBudW1iZXIgaW4gdGhlIHRhYmxl\nIGZvciB0aGUgR2VuZXJhdGVkVmFsdWUuVEFCTEUKICAgICAqIHN0cmF0ZWd5\nIHRvIHVzZSBhcyBpbml0aWFsIG51bWJlci4gCiAgICAgKiBAcGFyYW0gaW50\nVmFsdWUuIFRoZSBpbml0aWFsIG51bWJlcgogICAgICovCiAgICBwdWJsaWMg\ndm9pZCBzZXRJbml0aWFsVmFsdWUoaW50IGludFZhbHVlKSB7CiAgICAgICAg\nX2ludFZhbHVlID0gaW50VmFsdWU7CiAgICB9CiAgICAKICAgIC8qKgogICAg\nICogU2V0cyB0aGUgbmFtZXMgb2YgdGhlIGNvbHVtbnMgb24gd2hpY2ggYSB1\nbmlxdWUgY29uc3RyYWludCBpcyBzZXQuCiAgICAgKiBAcGFyYW0gY29sdW1u\nc05hbWVzIGFyZSBwYXNzZWQgYXMgYSBzaW5nbGUgU3RyaW5nIGNvbmNhdGVu\nYXRlZCB3aXRoCiAgICAgKiBhICd8JyBjaGFyYWN0ZXIuIFRoaXMgbWV0aG9k\nIHBhcnNlcyBpdCBiYWNrIHRvIGFycmF5IG9mIFN0cmluZ3MuIAogICAgICov\nCiAgICBwdWJsaWMgdm9pZCBzZXRVbmlxdWVDb2x1bW5zKFN0cmluZyBjb2x1\nbW5OYW1lcykgewogICAgCV91bmlxdWVDb2x1bW5OYW1lcyA9IChTdHJpbmdV\ndGlscy5pc0VtcHR5KGNvbHVtbk5hbWVzKSkgCiAgICAJCT8gbnVsbCA6IFN0\ncmluZ1V0aWxzLnNwbGl0KGNvbHVtbk5hbWVzLCAnfCcpOwogICAgfQogICAg\nCiAgICBwdWJsaWMgU3RyaW5nIGdldFVuaXF1ZUNvbHVtbnMoKSB7CiAgICAJ\ncmV0dXJuIFN0cmluZ1V0aWxzLmpvaW4oX3VuaXF1ZUNvbHVtbk5hbWVzLCAn\nfCcpOwogICAgfQoKICAgIC8qKgogICAgICogQGRlcHJlY2F0ZWQgVXNlIHtA\nbGluayAjc2V0QWxsb2NhdGV9LiBSZXRhaW5lZCBmb3IgYmFja3dhcmRzCiAg\nICAgKiBjb21wYXRpYmlsaXR5IG9mIGF1dG8tY29uZmlndXJhdGlvbi4KICAg\nICAqLwogICAgcHVibGljIHZvaWQgc2V0SW5jcmVtZW50KGludCBpbmMpIHsK\nICAgICAgICBzZXRBbGxvY2F0ZShpbmMpOwogICAgfQoKICAgIHB1YmxpYyBK\nREJDQ29uZmlndXJhdGlvbiBnZXRDb25maWd1cmF0aW9uKCkgewogICAgICAg\nIHJldHVybiBfY29uZjsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBzZXRDb25m\naWd1cmF0aW9uKENvbmZpZ3VyYXRpb24gY29uZikgewogICAgICAgIF9jb25m\nID0gKEpEQkNDb25maWd1cmF0aW9uKSBjb25mOwogICAgICAgIF9sb2cgPSBf\nY29uZi5nZXRMb2coSkRCQ0NvbmZpZ3VyYXRpb24uTE9HX1JVTlRJTUUpOwog\nICAgfQoKICAgIHB1YmxpYyB2b2lkIHN0YXJ0Q29uZmlndXJhdGlvbigpIHsK\nICAgIH0KCiAgICBwdWJsaWMgdm9pZCBlbmRDb25maWd1cmF0aW9uKCkgewog\nICAgICAgIGJ1aWxkVGFibGUoKTsKICAgIH0KICAgIAoKICAgIHB1YmxpYyB2\nb2lkIGFkZFNjaGVtYShDbGFzc01hcHBpbmcgbWFwcGluZywgU2NoZW1hR3Jv\ndXAgZ3JvdXApIHsKICAgICAgICAvLyBTaW5jZSB0aGUgdGFibGUgaXMgY3Jl\nYXRlZCBieSBvcGVuanBhIGludGVybmFsbHkKICAgICAgICAvLyB3ZSBjYW4g\nY3JlYXRlIHRoZSB0YWJsZSBmb3IgZWFjaCBzY2hlbWEgd2l0aGluIHRoZSBQ\nVQogICAgICAgIC8vIGluIGhlcmUuCiAgICAgICAgCiAgICAgICAgU2NoZW1h\nW10gc2NoZW1hcyA9IGdyb3VwLmdldFNjaGVtYXMoKTsKICAgICAgICBmb3Ig\nKGludCBpID0gMDsgaSA8IHNjaGVtYXMubGVuZ3RoOyBpKyspIHsKICAgICAg\nICAgICAgU3RyaW5nIHNjaGVtYU5hbWUgPSBTdHJpbmdzLmdldFBhY2thZ2VO\nYW1lKF90YWJsZSk7CiAgICAgICAgICAgIGlmIChzY2hlbWFOYW1lLmxlbmd0\naCgpID09IDApCiAgICAgICAgICAgICAgICBzY2hlbWFOYW1lID0gU2NoZW1h\ncy5nZXROZXdUYWJsZVNjaGVtYShfY29uZik7CiAgICAgICAgICAgIGlmIChz\nY2hlbWFOYW1lID09IG51bGwpCiAgICAgICAgICAgICAgICBzY2hlbWFOYW1l\nID0gc2NoZW1hc1tpXS5nZXROYW1lKCk7CgogICAgICAgICAgICAvLyBjcmVh\ndGUgdGFibGUgaW4gdGhpcyBncm91cAogICAgICAgICAgICBTY2hlbWEgc2No\nZW1hID0gZ3JvdXAuZ2V0U2NoZW1hKHNjaGVtYU5hbWUpOwogICAgICAgICAg\nICBpZiAoc2NoZW1hID09IG51bGwpCiAgICAgICAgICAgICAgICBzY2hlbWEg\nPSBncm91cC5hZGRTY2hlbWEoc2NoZW1hTmFtZSk7CiAgICAgICAgICAgIAog\nICAgICAgICAgICBUYWJsZSBjb3B5ID0gc2NoZW1hLmltcG9ydFRhYmxlKF9w\na0NvbHVtbi5nZXRUYWJsZSgpKTsKICAgICAgICAgICAgLy8gaW1wb3J0VGFi\nbGUoKSBkb2VzIG5vdCBpbXBvcnQgdW5pcXVlIGNvbnN0cmFpbnRzCiAgICAg\nICAgICAgIFVuaXF1ZVtdIHVuaXF1ZXMgPSBfcGtDb2x1bW4uZ2V0VGFibGUo\nKS5nZXRVbmlxdWVzKCk7CiAgICAgICAgICAgIGZvciAoVW5pcXVlIHUgOiB1\nbmlxdWVzKSB7CiAgICAgICAgICAgIAljb3B5LmltcG9ydFVuaXF1ZSh1KTsK\nICAgICAgICAgICAgfQogICAgICAgICAgICAvLyB3ZSBuZWVkIHRvIHJlc2V0\nIHRoZSB0YWJsZSBuYW1lIGluIHRoZSBjb2x1bW4gd2l0aCB0aGUKICAgICAg\nICAgICAgLy8gZnVsbHkgcXVhbGlmaWVkIG5hbWUgZm9yIG1hdGNoaW5nIHRo\nZSB0YWJsZSBuYW1lIGZyb20gdGhlCiAgICAgICAgICAgIC8vIENvbHVtbi4K\nICAgICAgICAgICAgX3BrQ29sdW1uLnJlc2V0VGFibGVOYW1lKHNjaGVtYU5h\nbWUgKyAiLiIKICAgICAgICAgICAgICAgICAgICArIF9wa0NvbHVtbi5nZXRU\nYWJsZU5hbWUoKSk7CiAgICAgICAgICAgIC8vIHNvbWUgZGF0YWJhc2VzIHJl\ncXVpcmUgdG8gY3JlYXRlIGFuIGluZGV4IGZvciB0aGUgc2VxdWVuY2UgdGFi\nbGUKICAgICAgICAgICAgX2NvbmYuZ2V0REJEaWN0aW9uYXJ5SW5zdGFuY2Uo\nKS5jcmVhdGVJbmRleElmTmVjZXNzYXJ5KHNjaGVtYSwKICAgICAgICAgICAg\nICAgICAgICBfdGFibGUsIF9wa0NvbHVtbik7CiAgICAgICAgfQogICAgfQoK\nICAgIHByb3RlY3RlZCBPYmplY3QgbmV4dEludGVybmFsKEpEQkNTdG9yZSBz\ndG9yZSwgQ2xhc3NNYXBwaW5nIG1hcHBpbmcpCiAgICAgICAgdGhyb3dzIEV4\nY2VwdGlvbiB7CiAgICAgICAgLy8gaWYgbmVlZGVkLCBncmFiIHRoZSBuZXh0\nIGhhbmRmdWwgb2YgaWRzCiAgICAgICAgU3RhdHVzIHN0YXQgPSBnZXRTdGF0\ndXMobWFwcGluZyk7CiAgICAgICAgaWYgKHN0YXQgPT0gbnVsbCkKICAgICAg\nICAgICAgdGhyb3cgbmV3IEludmFsaWRTdGF0ZUV4Y2VwdGlvbihfbG9jLmdl\ndCgiYmFkLXNlcS10eXBlIiwKICAgICAgICAgICAgICAgIGdldENsYXNzKCks\nIG1hcHBpbmcpKTsKCiAgICAgICAgd2hpbGUgKHRydWUpIHsKICAgICAgICAg\nICAgc3luY2hyb25pemVkIChzdGF0KSB7CiAgICAgICAgICAgICAgICAvLyBt\nYWtlIHN1cmUgc2VxIGlzIGF0IGxlYXN0IDEsIHNpbmNlIGF1dG9hc3NpZ25l\nZCBpZHMgb2YgMCBjYW4KICAgICAgICAgICAgICAgIC8vIGNvbmZsaWN0IHdp\ndGggdW5pbml0aWFsaXplZCB2YWx1ZXMKICAgICAgICAgICAgICAgIHN0YXQu\nc2VxID0gTWF0aC5tYXgoc3RhdC5zZXEsIDEpOwogICAgICAgICAgICAgICAg\naWYgKHN0YXQuc2VxIDwgc3RhdC5tYXgpCiAgICAgICAgICAgICAgICAgICAg\ncmV0dXJuIE51bWJlcnMudmFsdWVPZihzdGF0LnNlcSsrKTsKICAgICAgICAg\nICAgfQogICAgICAgICAgICBhbGxvY2F0ZVNlcXVlbmNlKHN0b3JlLCBtYXBw\naW5nLCBzdGF0LCBfYWxsb2MsIHRydWUpOwogICAgICAgIH0KICAgIH0KCiAg\nICBwcm90ZWN0ZWQgT2JqZWN0IGN1cnJlbnRJbnRlcm5hbChKREJDU3RvcmUg\nc3RvcmUsIENsYXNzTWFwcGluZyBtYXBwaW5nKQogICAgICAgIHRocm93cyBF\neGNlcHRpb24gewogICAgICAgIGlmIChjdXJyZW50ID09IG51bGwpIHsKICAg\nICAgICAgICAgQ3VycmVudFNlcXVlbmNlUnVubmFibGUgcnVubmFibGUgPQog\nICAgICAgICAgICAgICAgbmV3IEN1cnJlbnRTZXF1ZW5jZVJ1bm5hYmxlKHN0\nb3JlLCBtYXBwaW5nKTsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAg\nICAgIGlmIChzdXNwZW5kSW5KVEEoKSkgewogICAgICAgICAgICAgICAgICAg\nIC8vIE5vdFN1cHBvcnRlZEV4Y2VwdGlvbiBpcyB3cmFwcGVkIGluIGEgU3Rv\ncmVFeGNlcHRpb24gYnkKICAgICAgICAgICAgICAgICAgICAvLyB0aGUgY2Fs\nbGVyLgogICAgICAgICAgICAgICAgICAgIF9jb25mLmdldE1hbmFnZWRSdW50\naW1lSW5zdGFuY2UoKS5kb05vblRyYW5zYWN0aW9uYWxXb3JrKAogICAgICAg\nICAgICAgICAgICAgICAgICAgICAgcnVubmFibGUpOwogICAgICAgICAgICAg\nICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBydW5uYWJsZS5ydW4o\nKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBjYXRjaCAoUnVu\ndGltZUV4Y2VwdGlvbiByZSkgewogICAgICAgICAgICAgICAgdGhyb3cgKEV4\nY2VwdGlvbikgKHJlLmdldENhdXNlKCkgPT0gbnVsbCA/IHJlIDogcmUuZ2V0\nQ2F1c2UoKSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0\ndXJuIHN1cGVyLmN1cnJlbnRJbnRlcm5hbChzdG9yZSwgbWFwcGluZyk7CiAg\nICB9CgogICAgcHJvdGVjdGVkIHZvaWQgYWxsb2NhdGVJbnRlcm5hbChpbnQg\nY291bnQsIEpEQkNTdG9yZSBzdG9yZSwKICAgICAgICBDbGFzc01hcHBpbmcg\nbWFwcGluZykKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAg\nICBTdGF0dXMgc3RhdCA9IGdldFN0YXR1cyhtYXBwaW5nKTsKICAgICAgICBp\nZiAoc3RhdCA9PSBudWxsKQogICAgICAgICAgICByZXR1cm47CgogICAgICAg\nIHdoaWxlICh0cnVlKSB7CiAgICAgICAgICAgIGludCBhdmFpbGFibGU7CiAg\nICAgICAgICAgIHN5bmNocm9uaXplZCAoc3RhdCkgewogICAgICAgICAgICAg\nICAgYXZhaWxhYmxlID0gKGludCkgKHN0YXQubWF4IC0gc3RhdC5zZXEpOwog\nICAgICAgICAgICAgICAgaWYgKGF2YWlsYWJsZSA+PSBjb3VudCkKICAgICAg\nICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KICAgICAgICAg\nICAgYWxsb2NhdGVTZXF1ZW5jZShzdG9yZSwgbWFwcGluZywgc3RhdCwgY291\nbnQgLSBhdmFpbGFibGUsIGZhbHNlKTsKICAgICAgICB9CiAgICB9CgogICAg\nLyoqCiAgICAgKiBSZXR1cm4gdGhlIGFwcHJvcHJpYXRlIHN0YXR1cyBvYmpl\nY3QgZm9yIHRoZSBnaXZlbiBjbGFzcywgb3IgbnVsbAogICAgICogaWYgY2Fu\nbm90IGhhbmRsZSB0aGUgZ2l2ZW4gY2xhc3MuIFRoZSBtYXBwaW5nIG1heSBi\nZSBudWxsLgogICAgICovCiAgICBwcm90ZWN0ZWQgU3RhdHVzIGdldFN0YXR1\ncyhDbGFzc01hcHBpbmcgbWFwcGluZykgeyAgCiAgICAgICAgU3RhdHVzIHN0\nYXR1cyA9IChTdGF0dXMpX3N0YXQuZ2V0KG1hcHBpbmcpOyAgICAgICAgCiAg\nICAgICAgaWYgKHN0YXR1cyA9PSBudWxsKXsgCiAgICAgICAgICAgIHN0YXR1\ncyA9IG5ldyBTdGF0dXMoKTsKICAgICAgICAgICAgX3N0YXQucHV0KG1hcHBp\nbmcsIHN0YXR1cyk7CiAgICAgICAgfQogICAgICAgIHJldHVybiBzdGF0dXM7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBBZGQgdGhlIHByaW1hcnkga2V5IGNv\nbHVtbiB0byB0aGUgZ2l2ZW4gdGFibGUgYW5kIHJldHVybiBpdC4KICAgICAq\nLwogICAgcHJvdGVjdGVkIENvbHVtbiBhZGRQcmltYXJ5S2V5Q29sdW1uKFRh\nYmxlIHRhYmxlKSB7CiAgICAgICAgREJEaWN0aW9uYXJ5IGRpY3QgPSBfY29u\nZi5nZXREQkRpY3Rpb25hcnlJbnN0YW5jZSgpOwogICAgICAgIENvbHVtbiBw\na0NvbHVtbiA9IHRhYmxlLmFkZENvbHVtbihkaWN0LmdldFZhbGlkQ29sdW1u\nTmFtZQogICAgICAgICAgICAoZ2V0UHJpbWFyeUtleUNvbHVtbigpLCB0YWJs\nZSkpOwogICAgICAgIHBrQ29sdW1uLnNldFR5cGUoZGljdC5nZXRQcmVmZXJy\nZWRUeXBlKFR5cGVzLlRJTllJTlQpKTsKICAgICAgICBwa0NvbHVtbi5zZXRK\nYXZhVHlwZShKYXZhVHlwZXMuSU5UKTsKICAgICAgICByZXR1cm4gcGtDb2x1\nbW47CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIHByaW1hcnkg\na2V5IHZhbHVlIGZvciB0aGUgZ2l2ZW4gY2xhc3MuCiAgICAgKi8KICAgIHBy\nb3RlY3RlZCBPYmplY3QgZ2V0UHJpbWFyeUtleShDbGFzc01hcHBpbmcgbWFw\ncGluZykgewogICAgICAgIHJldHVybiBOdW1iZXJzLnZhbHVlT2YoMCk7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBDcmVhdGVzIHRoZSBvYmplY3QtbGV2ZWwg\ncmVwcmVzZW50YXRpb24gb2YgdGhlIHNlcXVlbmNlIHRhYmxlLgogICAgICov\nCiAgICBwcml2YXRlIHZvaWQgYnVpbGRUYWJsZSgpIHsKICAgICAgICBTdHJp\nbmcgdGFibGVOYW1lID0gU3RyaW5ncy5nZXRDbGFzc05hbWUoX3RhYmxlKTsK\nICAgICAgICBTdHJpbmcgc2NoZW1hTmFtZSA9IFN0cmluZ3MuZ2V0UGFja2Fn\nZU5hbWUoX3RhYmxlKTsKICAgICAgICBpZiAoc2NoZW1hTmFtZS5sZW5ndGgo\nKSA9PSAwKQogICAgICAgICAgICBzY2hlbWFOYW1lID0gU2NoZW1hcy5nZXRO\nZXdUYWJsZVNjaGVtYShfY29uZik7CgogICAgICAgIFNjaGVtYUdyb3VwIGdy\nb3VwID0gbmV3IFNjaGVtYUdyb3VwKCk7CiAgICAgICAgU2NoZW1hIHNjaGVt\nYSA9IGdyb3VwLmFkZFNjaGVtYShzY2hlbWFOYW1lKTsKCiAgICAgICAgVGFi\nbGUgdGFibGUgPSBzY2hlbWEuYWRkVGFibGUodGFibGVOYW1lKTsKICAgICAg\nICBfcGtDb2x1bW4gPSBhZGRQcmltYXJ5S2V5Q29sdW1uKHRhYmxlKTsKICAg\nICAgICBQcmltYXJ5S2V5IHBrID0gdGFibGUuYWRkUHJpbWFyeUtleSgpOwog\nICAgICAgIHBrLmFkZENvbHVtbihfcGtDb2x1bW4pOwoKICAgICAgICBEQkRp\nY3Rpb25hcnkgZGljdCA9IF9jb25mLmdldERCRGljdGlvbmFyeUluc3RhbmNl\nKCk7CiAgICAgICAgX3NlcUNvbHVtbiA9IHRhYmxlLmFkZENvbHVtbihkaWN0\nLmdldFZhbGlkQ29sdW1uTmFtZQogICAgICAgICAgICAoX3NlcUNvbHVtbk5h\nbWUsIHRhYmxlKSk7CiAgICAgICAgX3NlcUNvbHVtbi5zZXRUeXBlKGRpY3Qu\nZ2V0UHJlZmVycmVkVHlwZShUeXBlcy5CSUdJTlQpKTsKICAgICAgICBfc2Vx\nQ29sdW1uLnNldEphdmFUeXBlKEphdmFUeXBlcy5MT05HKTsKICAgICAgICAK\nICAgICAgICBpZiAoX3VuaXF1ZUNvbHVtbk5hbWVzICE9IG51bGwpIHsKICAg\nIAkJU3RyaW5nIHVuaXF1ZU5hbWUgPSBkaWN0LmdldFZhbGlkVW5pcXVlTmFt\nZSgiVU5RIiwgdGFibGUpOwogICAgCQlVbmlxdWUgdSA9IHRhYmxlLmFkZFVu\naXF1ZSh1bmlxdWVOYW1lKTsKICAgIAkJZm9yIChTdHJpbmcgY29sdW1uTmFt\nZSA6IF91bmlxdWVDb2x1bW5OYW1lcykgewogICAgCQkJaWYgKCF0YWJsZS5j\nb250YWluc0NvbHVtbihjb2x1bW5OYW1lKSkKICAgIAkJCQl0aHJvdyBuZXcg\nVXNlckV4Y2VwdGlvbihfbG9jLmdldCgidW5pcXVlLW1pc3NpbmctY29sdW1u\nIiwKICAgIAkJCQkJY29sdW1uTmFtZSwgdGFibGUuZ2V0TmFtZSgpLCB0YWJs\nZS5nZXRDb2x1bW5OYW1lcygpKSk7CiAgICAJCQlDb2x1bW4gY29sID0gdGFi\nbGUuZ2V0Q29sdW1uKGNvbHVtbk5hbWUpOwogICAgCQkJdS5hZGRDb2x1bW4o\nY29sKTsKICAgIAkJfQogICAgICAgIH0KICAgICAgICAKICAgIH0KCiAgICAv\nKioKICAgICAqIFVwZGF0ZXMgdGhlIG1heCBhdmFpbGFibGUgc2VxdWVuY2Ug\ndmFsdWUuCiAgICAgKi8KICAgIHByaXZhdGUgdm9pZCBhbGxvY2F0ZVNlcXVl\nbmNlKEpEQkNTdG9yZSBzdG9yZSwgQ2xhc3NNYXBwaW5nIG1hcHBpbmcsCiAg\nICAgICAgICAgIFN0YXR1cyBzdGF0LCBpbnQgYWxsb2MsIGJvb2xlYW4gdXBk\nYXRlU3RhdFNlcSkgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgUnVu\nbmFibGUgcnVubmFibGUgPQogICAgICAgICAgICBuZXcgQWxsb2NhdGVTZXF1\nZW5jZVJ1bm5hYmxlKAogICAgICAgICAgICAgICAgICAgIHN0b3JlLCBtYXBw\naW5nLCBzdGF0LCBhbGxvYywgdXBkYXRlU3RhdFNlcSk7CiAgICAgICAgdHJ5\nIHsKICAgICAgICAgICAgaWYgKHN1c3BlbmRJbkpUQSgpKSB7CiAgICAgICAg\nICAgICAgICAvLyBOb3RTdXBwb3J0ZWRFeGNlcHRpb24gaXMgd3JhcHBlZCBp\nbiBhIFN0b3JlRXhjZXB0aW9uIGJ5CiAgICAgICAgICAgICAgICAvLyB0aGUg\nY2FsbGVyLgogICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAg\nIF9jb25mLmdldE1hbmFnZWRSdW50aW1lSW5zdGFuY2UoKS5kb05vblRyYW5z\nYWN0aW9uYWxXb3JrKAogICAgICAgICAgICAgICAgICAgICAgICBydW5uYWJs\nZSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBjYXRjaChO\nb3RTdXBwb3J0ZWRFeGNlcHRpb24gbnNlKSB7IAogICAgICAgICAgICAgICAg\nICAgIFNRTEV4Y2VwdGlvbiBzcWxFeCA9IG5ldyBTUUxFeGNlcHRpb24obnNl\nLmdldExvY2FsaXplZE1lc3NhZ2UoKSk7CiAgICAgICAgICAgICAgICAgICAg\nc3FsRXguaW5pdENhdXNlKG5zZSk7CiAgICAgICAgICAgICAgICAgICAgdGhy\nb3cgc3FsRXg7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gZWxz\nZSB7CiAgICAgICAgICAgICAgICBydW5uYWJsZS5ydW4oKTsKICAgICAgICAg\nICAgfQogICAgICAgIH0gY2F0Y2ggKFJ1bnRpbWVFeGNlcHRpb24gcmUpIHsK\nICAgICAgICAgICAgVGhyb3dhYmxlIGUgPSByZS5nZXRDYXVzZSgpOwogICAg\nICAgICAgICBpZihlIGluc3RhbmNlb2YgU1FMRXhjZXB0aW9uICkgCiAgICAg\nICAgICAgICAgICB0aHJvdyAoU1FMRXhjZXB0aW9uKSBlOwogICAgICAgICAg\nICBlbHNlIAogICAgICAgICAgICAgICAgdGhyb3cgcmU7CiAgICAgICAgfQog\nICAgfQoKICAgIC8qKgogICAgICogSW5zZXJ0cyB0aGUgaW5pdGlhbCBzZXF1\nZW5jZSBjb2x1bW4gaW50byB0aGUgZGF0YWJhc2UuCiAgICAgKiAKICAgICAq\nIEBwYXJhbSBtYXBwaW5nCiAgICAgKiAgICAgICAgICAgIENsYXNzTWFwcGlu\nZyBmb3IgdGhlIGNsYXNzIHdob3NlIHNlcXVlbmNlIGNvbHVtbiB3aWxsIGJl\nCiAgICAgKiAgICAgICAgICAgIHVwZGF0ZWQKICAgICAqIEBwYXJhbSBjb25u\nCiAgICAgKiAgICAgICAgICAgIENvbm5lY3Rpb24gdXNlZCBpc3N1ZSBTUUwg\nc3RhdGVtZW50cy4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIGluc2VydFNl\ncXVlbmNlKENsYXNzTWFwcGluZyBtYXBwaW5nLCBDb25uZWN0aW9uIGNvbm4p\nCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgaWYgKF9s\nb2cuaXNUcmFjZUVuYWJsZWQoKSkKICAgICAgICAgICAgX2xvZy50cmFjZShf\nbG9jLmdldCgiaW5zZXJ0LXNlcSIpKTsKCiAgICAgICAgT2JqZWN0IHBrID0g\nZ2V0UHJpbWFyeUtleShtYXBwaW5nKTsKICAgICAgICBpZiAocGsgPT0gbnVs\nbCkKICAgICAgICAgICAgdGhyb3cgbmV3IEludmFsaWRTdGF0ZUV4Y2VwdGlv\nbihfbG9jLmdldCgiYmFkLXNlcS10eXBlIiwKICAgICAgICAgICAgICAgIGdl\ndENsYXNzKCksIG1hcHBpbmcpKTsKCiAgICAgICAgREJEaWN0aW9uYXJ5IGRp\nY3QgPSBfY29uZi5nZXREQkRpY3Rpb25hcnlJbnN0YW5jZSgpOwogICAgICAg\nIFN0cmluZyB0YWJsZU5hbWUgPSByZXNvbHZlVGFibGVOYW1lKG1hcHBpbmcs\nIF9wa0NvbHVtbi5nZXRUYWJsZSgpKTsKICAgICAgICBTUUxCdWZmZXIgaW5z\nZXJ0ID0gbmV3IFNRTEJ1ZmZlcihkaWN0KS5hcHBlbmQoIklOU0VSVCBJTlRP\nICIpLgogICAgICAgICAgICBhcHBlbmQodGFibGVOYW1lKS5hcHBlbmQoIiAo\nIikuCiAgICAgICAgICAgIGFwcGVuZChfcGtDb2x1bW4pLmFwcGVuZCgiLCAi\nKS5hcHBlbmQoX3NlcUNvbHVtbikuCiAgICAgICAgICAgIGFwcGVuZCgiKSBW\nQUxVRVMgKCIpLgogICAgICAgICAgICBhcHBlbmRWYWx1ZShwaywgX3BrQ29s\ndW1uKS5hcHBlbmQoIiwgIikuCiAgICAgICAgICAgIGFwcGVuZFZhbHVlKF9p\nbnRWYWx1ZSwgX3NlcUNvbHVtbikuYXBwZW5kKCIpIik7CiAgICAgICAgCiAg\nICAgICAgYm9vbGVhbiB3YXNBdXRvID0gY29ubi5nZXRBdXRvQ29tbWl0KCk7\nCiAgICAgICAgaWYgKCF3YXNBdXRvICYmICFzdXNwZW5kSW5KVEEoKSkKICAg\nICAgICAgICAgY29ubi5zZXRBdXRvQ29tbWl0KHRydWUpOwoKICAgICAgICBQ\ncmVwYXJlZFN0YXRlbWVudCBzdG1udCA9IG51bGw7CiAgICAgICAgdHJ5IHsK\nICAgICAgICAgICAgc3RtbnQgPSBwcmVwYXJlU3RhdGVtZW50KGNvbm4sIGlu\nc2VydCk7CiAgICAgICAgICAgIGV4ZWN1dGVVcGRhdGUoX2NvbmYsIGNvbm4s\nIHN0bW50LCBpbnNlcnQsIFJvd0ltcGwuQUNUSU9OX0lOU0VSVCk7CiAgICAg\nICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgaWYgKHN0bW50ICE9IG51bGwp\nCiAgICAgICAgICAgICAgICB0cnkgeyBzdG1udC5jbG9zZSgpOyB9IGNhdGNo\nIChTUUxFeGNlcHRpb24gc2UpIHt9CiAgICAgICAgICAgIGlmICghd2FzQXV0\nbyAmJiAhc3VzcGVuZEluSlRBKCkpCiAgICAgICAgICAgICAgICBjb25uLnNl\ndEF1dG9Db21taXQoZmFsc2UpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioK\nICAgICAqIEdldCB0aGUgY3VycmVudCBzZXF1ZW5jZSB2YWx1ZS4KICAgICAq\nIAogICAgICogQHBhcmFtIG1hcHBpbmcKICAgICAqICAgICAgICAgICAgQ2xh\nc3NNYXBwaW5nIG9mIHRoZSBlbnRpdHkgd2hvc2Ugc2VxdWVuY2UgdmFsdWUg\nd2lsbCBiZQogICAgICogICAgICAgICAgICBvYnRhaW5lZC4KICAgICAqIEBw\nYXJhbSBjb25uCiAgICAgKiAgICAgICAgICAgIENvbm5lY3Rpb24gdXNlZCBp\nc3N1ZSBTUUwgc3RhdGVtZW50cy4KICAgICAqIAogICAgICogQHJldHVybiBU\naGUgY3VycmVudCBzZXF1ZW5jZSB2YWx1ZSwgb3IgPGNvZGU+U0VRVUVOQ0Vf\nTk9UX0ZPVU5EPC9jb2RlPgogICAgICogICAgICAgICBpZiB0aGUgc2VxdWVu\nY2UgY291bGQgbm90IGJlIGZvdW5kLgogICAgICovCiAgICBwcm90ZWN0ZWQg\nbG9uZyBnZXRTZXF1ZW5jZShDbGFzc01hcHBpbmcgbWFwcGluZywgQ29ubmVj\ndGlvbiBjb25uKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAg\nICAgIGlmIChfbG9nLmlzVHJhY2VFbmFibGVkKCkpCiAgICAgICAgICAgIF9s\nb2cudHJhY2UoX2xvYy5nZXQoImdldC1zZXEiKSk7CgogICAgICAgIE9iamVj\ndCBwayA9IGdldFByaW1hcnlLZXkobWFwcGluZyk7CiAgICAgICAgaWYgKHBr\nID09IG51bGwpCiAgICAgICAgICAgIHJldHVybiAtMTsKCiAgICAgICAgREJE\naWN0aW9uYXJ5IGRpY3QgPSBfY29uZi5nZXREQkRpY3Rpb25hcnlJbnN0YW5j\nZSgpOwogICAgICAgIFNRTEJ1ZmZlciBzZWwgPSBuZXcgU1FMQnVmZmVyKGRp\nY3QpLmFwcGVuZChfc2VxQ29sdW1uKTsKICAgICAgICBTUUxCdWZmZXIgd2hl\ncmUgPSBuZXcgU1FMQnVmZmVyKGRpY3QpLmFwcGVuZChfcGtDb2x1bW4pLmFw\ncGVuZCgiID0gIikuCiAgICAgICAgICAgIGFwcGVuZFZhbHVlKHBrLCBfcGtD\nb2x1bW4pOwogICAgICAgIFN0cmluZyB0YWJsZU5hbWUgPSByZXNvbHZlVGFi\nbGVOYW1lKG1hcHBpbmcsIF9zZXFDb2x1bW4uZ2V0VGFibGUoKSk7CiAgICAg\nICAgU1FMQnVmZmVyIHRhYmxlcyA9IG5ldyBTUUxCdWZmZXIoZGljdCkuYXBw\nZW5kKHRhYmxlTmFtZSk7CgogICAgICAgIFNRTEJ1ZmZlciBzZWxlY3QgPSBk\naWN0LnRvU2VsZWN0KHNlbCwgbnVsbCwgdGFibGVzLCB3aGVyZSwgbnVsbCwg\nbnVsbCwKICAgICAgICAgICAgICAgIG51bGwsIGZhbHNlLCBkaWN0LnN1cHBv\ncnRzU2VsZWN0Rm9yVXBkYXRlLCAwLCBMb25nLk1BWF9WQUxVRSwKICAgICAg\nICAgICAgICAgIGZhbHNlLCB0cnVlKTsKCiAgICAgICAgUHJlcGFyZWRTdGF0\nZW1lbnQgc3RtbnQgPSBwcmVwYXJlU3RhdGVtZW50KGNvbm4sIHNlbGVjdCk7\nCiAgICAgICAgUmVzdWx0U2V0IHJzID0gbnVsbDsKICAgICAgICB0cnkgewog\nICAgICAgICAgICBycyA9IGV4ZWN1dGVRdWVyeShfY29uZiwgY29ubiwgc3Rt\nbnQsIHNlbGVjdCk7CiAgICAgICAgICAgIHJldHVybiBnZXRTZXF1ZW5jZShy\ncywgZGljdCk7CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgaWYg\nKHJzICE9IG51bGwpCiAgICAgICAgICAgICAgICB0cnkgeyBycy5jbG9zZSgp\nOyB9IGNhdGNoIChTUUxFeGNlcHRpb24gc2UpIHt9CiAgICAgICAgICAgIGlm\nIChzdG1udCAhPSBudWxsKSAgICAKICAgICAgICAgICAgICAgIHRyeSB7IHN0\nbW50LmNsb3NlKCk7IH0gY2F0Y2ggKFNRTEV4Y2VwdGlvbiBzZSkge30KICAg\nICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBHcmFicyB0aGUgbmV4dCBo\nYW5kZnVsIG9mIHNlcXVlbmNlIG51bWJlcnMuCiAgICAgKgogICAgICogQHJl\ndHVybiB0cnVlIGlmIHRoZSBzZXF1ZW5jZSB3YXMgdXBkYXRlZCwgZmFsc2Ug\naWYgbm8gc2VxdWVuY2UKICAgICAqIHJvdyBleGlzdGVkIGZvciB0aGlzIG1h\ncHBpbmcKICAgICAqLwogICAgcHJvdGVjdGVkIGJvb2xlYW4gc2V0U2VxdWVu\nY2UoQ2xhc3NNYXBwaW5nIG1hcHBpbmcsIFN0YXR1cyBzdGF0LCBpbnQgaW5j\nLAogICAgICAgIGJvb2xlYW4gdXBkYXRlU3RhdFNlcSwgQ29ubmVjdGlvbiBj\nb25uKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIGlm\nIChfbG9nLmlzVHJhY2VFbmFibGVkKCkpCiAgICAgICAgICAgIF9sb2cudHJh\nY2UoX2xvYy5nZXQoInVwZGF0ZS1zZXEiKSk7CgogICAgICAgIE9iamVjdCBw\nayA9IGdldFByaW1hcnlLZXkobWFwcGluZyk7CiAgICAgICAgaWYgKHBrID09\nIG51bGwpCiAgICAgICAgICAgIHRocm93IG5ldyBJbnZhbGlkU3RhdGVFeGNl\ncHRpb24oX2xvYy5nZXQoImJhZC1zZXEtdHlwZSIsCiAgICAgICAgICAgICAg\nICBnZXRDbGFzcygpLCBtYXBwaW5nKSk7CgogICAgICAgIERCRGljdGlvbmFy\neSBkaWN0ID0gX2NvbmYuZ2V0REJEaWN0aW9uYXJ5SW5zdGFuY2UoKTsgICAg\nICAgIAogICAgICAgIFNRTEJ1ZmZlciB3aGVyZSA9IG5ldyBTUUxCdWZmZXIo\nZGljdCkuYXBwZW5kKF9wa0NvbHVtbikuYXBwZW5kKCIgPSAiKS4KICAgICAg\nICAgICAgYXBwZW5kVmFsdWUocGssIF9wa0NvbHVtbik7CgogICAgICAgIC8v\nIGxvb3AgdW50aWwgd2UgaGF2ZSBhIHN1Y2Nlc3NmdWwgYXRvbWljIHNlbGVj\ndC91cGRhdGUgc2VxdWVuY2UKICAgICAgICBsb25nIGN1ciA9IDA7CiAgICAg\nICAgUHJlcGFyZWRTdGF0ZW1lbnQgc3RtbnQ7CiAgICAgICAgUmVzdWx0U2V0\nIHJzOwogICAgICAgIFNRTEJ1ZmZlciB1cGQ7CiAgICAgICAgZm9yIChpbnQg\ndXBkYXRlcyA9IDA7IHVwZGF0ZXMgPT0gMDspIHsKICAgICAgICAgICAgc3Rt\nbnQgPSBudWxsOwogICAgICAgICAgICBycyA9IG51bGw7CiAgICAgICAgICAg\nIHRyeSB7CiAgICAgICAgICAgICAgICBjdXIgPSBnZXRTZXF1ZW5jZShtYXBw\naW5nLCBjb25uKTsKICAgICAgICAgICAgICAgIGlmIChjdXIgPT0gLTEpCiAg\nICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoKICAgICAgICAgICAg\nICAgIC8vIHVwZGF0ZSB0aGUgdmFsdWUKICAgICAgICAgICAgICAgIHVwZCA9\nIG5ldyBTUUxCdWZmZXIoZGljdCk7CiAgICAgICAgICAgICAgICBTdHJpbmcg\ndGFibGVOYW1lID0gcmVzb2x2ZVRhYmxlTmFtZShtYXBwaW5nLCBfc2VxQ29s\ndW1uLmdldFRhYmxlKCkpOwogICAgICAgICAgICAgICAgdXBkLmFwcGVuZCgi\nVVBEQVRFICIpLmFwcGVuZCh0YWJsZU5hbWUpLgogICAgICAgICAgICAgICAg\nICAgIGFwcGVuZCgiIFNFVCAiKS5hcHBlbmQoX3NlcUNvbHVtbikuYXBwZW5k\nKCIgPSAiKS4KICAgICAgICAgICAgICAgICAgICBhcHBlbmRWYWx1ZShOdW1i\nZXJzLnZhbHVlT2YoY3VyICsgaW5jKSwgX3NlcUNvbHVtbikuCiAgICAgICAg\nICAgICAgICAgICAgYXBwZW5kKCIgV0hFUkUgIikuYXBwZW5kKHdoZXJlKS5h\ncHBlbmQoIiBBTkQgIikuCiAgICAgICAgICAgICAgICAgICAgYXBwZW5kKF9z\nZXFDb2x1bW4pLmFwcGVuZCgiID0gIikuCiAgICAgICAgICAgICAgICAgICAg\nYXBwZW5kVmFsdWUoTnVtYmVycy52YWx1ZU9mKGN1ciksIF9zZXFDb2x1bW4p\nOwoKICAgICAgICAgICAgICAgIHN0bW50ID0gcHJlcGFyZVN0YXRlbWVudChj\nb25uLCB1cGQpOwogICAgICAgICAgICAgICAgdXBkYXRlcyA9IGV4ZWN1dGVV\ncGRhdGUoX2NvbmYsIGNvbm4sIHN0bW50LCB1cGQsIFJvd0ltcGwuQUNUSU9O\nX1VQREFURSk7CiAgICAgICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAg\nICAgICBpZiAocnMgIT0gbnVsbCkgCiAgICAgICAgICAgICAgICAgICAgdHJ5\nIHsgcnMuY2xvc2UoKTsgfSBjYXRjaCAoU1FMRXhjZXB0aW9uIHNlKSB7fQog\nICAgICAgICAgICAgICAgaWYgKHN0bW50ICE9IG51bGwpCiAgICAgICAgICAg\nICAgICAgICAgdHJ5IHsgc3RtbnQuY2xvc2UoKTsgfSBjYXRjaCAoU1FMRXhj\nZXB0aW9uIHNlKSB7fQogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAg\nICAvLyBzZXR1cCBuZXcgc2VxdWVuY2UgcmFuZ2UgICAgICAgIAogICAgICAg\nIHN5bmNocm9uaXplZCAoc3RhdCkgewogICAgICAgICAgICBpZiAodXBkYXRl\nU3RhdFNlcSAmJiBzdGF0LnNlcSA8IGN1cikKICAgICAgICAgICAgICAgIHN0\nYXQuc2VxID0gY3VyOwogICAgICAgICAgICBpZiAoc3RhdC5tYXggPCBjdXIg\nKyBpbmMpCiAgICAgICAgICAgICAgICBzdGF0Lm1heCA9IGN1ciArIGluYzsK\nICAgICAgICB9CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CiAgICAvKioK\nICAgICAqIFJlc29sdmUgYSBmdWxseSBxdWFsaWZpZWQgdGFibGUgbmFtZQog\nICAgICogCiAgICAgKiBAcGFyYW0gY2xhc3MKICAgICAqICAgICAgICAgICAg\nbWFwcGluZyB0byBnZXQgdGhlIHNjaGVtYSBuYW1lCiAgICAgKi8KICAgIHB1\nYmxpYyBTdHJpbmcgcmVzb2x2ZVRhYmxlTmFtZShDbGFzc01hcHBpbmcgbWFw\ncGluZywgVGFibGUgdGFibGUpIHsKICAgICAgICBTdHJpbmcgc05hbWUgPSBt\nYXBwaW5nLmdldFRhYmxlKCkuZ2V0U2NoZW1hTmFtZSgpOwogICAgICAgIFN0\ncmluZyB0YWJsZU5hbWU7CiAgICAgICAgaWYgKHNOYW1lID09IG51bGwpCiAg\nICAgICAgICAgIHRhYmxlTmFtZSA9IHRhYmxlLmdldEZ1bGxOYW1lKCk7CiAg\nICAgICAgZWxzZSBpZiAodGFibGUuZ2V0U2NoZW1hTmFtZSgpICE9IG51bGwp\nCiAgICAgICAgICAgIHRhYmxlTmFtZSA9IHRhYmxlLmdldEZ1bGxOYW1lKCk7\nCiAgICAgICAgZWxzZQogICAgICAgICAgICB0YWJsZU5hbWUgPSBzTmFtZSAr\nICIuIiArIHRhYmxlLmdldE5hbWUoKTsKICAgICAgICByZXR1cm4gdGFibGVO\nYW1lOwogICAgfQoKICAgIC8qKgogICAgICogQ3JlYXRlcyB0aGUgc2VxdWVu\nY2UgdGFibGUgaW4gdGhlIERCLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBy\nZWZyZXNoVGFibGUoKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewog\nICAgICAgIGlmIChfbG9nLmlzSW5mb0VuYWJsZWQoKSkKICAgICAgICAgICAg\nX2xvZy5pbmZvKF9sb2MuZ2V0KCJtYWtlLXNlcS10YWJsZSIpKTsKCiAgICAg\nICAgLy8gY3JlYXRlIHRoZSB0YWJsZQogICAgICAgIFNjaGVtYVRvb2wgdG9v\nbCA9IG5ldyBTY2hlbWFUb29sKF9jb25mKTsKICAgICAgICB0b29sLnNldEln\nbm9yZUVycm9ycyh0cnVlKTsKICAgICAgICB0b29sLmNyZWF0ZVRhYmxlKF9w\na0NvbHVtbi5nZXRUYWJsZSgpKTsKICAgIH0KCiAgICAvKioKICAgICAqIERy\nb3BzIHRoZSBzZXF1ZW5jZSB0YWJsZSBpbiB0aGUgREIuCiAgICAgKi8KICAg\nIHB1YmxpYyB2b2lkIGRyb3BUYWJsZSgpCiAgICAgICAgdGhyb3dzIFNRTEV4\nY2VwdGlvbiB7CiAgICAgICAgaWYgKF9sb2cuaXNJbmZvRW5hYmxlZCgpKQog\nICAgICAgICAgICBfbG9nLmluZm8oX2xvYy5nZXQoImRyb3Atc2VxLXRhYmxl\nIikpOwoKICAgICAgICAvLyBkcm9wIHRoZSB0YWJsZQogICAgICAgIFNjaGVt\nYVRvb2wgdG9vbCA9IG5ldyBTY2hlbWFUb29sKF9jb25mKTsKICAgICAgICB0\nb29sLnNldElnbm9yZUVycm9ycyh0cnVlKTsKICAgICAgICB0b29sLmRyb3BU\nYWJsZShfcGtDb2x1bW4uZ2V0VGFibGUoKSk7CiAgICB9CgogICAgLy8vLy8v\nLy8vCiAgICAvLyBNYWluCiAgICAvLy8vLy8vLy8KCiAgICAvKioKICAgICAq\nIFVzYWdlOiBqYXZhIG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNjaGVtYS5U\nYWJsZUpEQkNTZXF1ZW5jZSBbb3B0aW9uXSoKICAgICAqIC1hY3Rpb24vLWEg\nJmx0O2FkZCB8IGRyb3AgfCBnZXQgfCBzZXQmZ3Q7IFt2YWx1ZV0KICAgICAq\nICBXaGVyZSB0aGUgZm9sbG93aW5nIG9wdGlvbnMgYXJlIHJlY29nbml6ZWQu\nCiAgICAgKiA8dWw+CiAgICAgKiA8bGk+PGk+LXByb3BlcnRpZXMvLXAgJmx0\nO3Byb3BlcnRpZXMgZmlsZSBvciByZXNvdXJjZSZndDs8L2k+OiBUaGUKICAg\nICAqIHBhdGggb3IgcmVzb3VyY2UgbmFtZSBvZiBhIE9wZW5KUEEgcHJvcGVy\ndGllcyBmaWxlIGNvbnRhaW5pbmcKICAgICAqIGluZm9ybWF0aW9uIHN1Y2gg\nYXMgdGhlIGxpY2Vuc2Uga2V5CWFuZCBjb25uZWN0aW9uIGRhdGEgYXMKICAg\nICAqIG91dGxpbmVkIGluIHtAbGluayBKREJDQ29uZmlndXJhdGlvbn0uIE9w\ndGlvbmFsLjwvbGk+CiAgICAgKiA8bGk+PGk+LSZsdDtwcm9wZXJ0eSBuYW1l\nJmd0OyAmbHQ7cHJvcGVydHkgdmFsdWUmZ3Q7PC9pPjogQWxsIGJlYW4KICAg\nICAqIHByb3BlcnRpZXMgb2YgdGhlIE9wZW5KUEEge0BsaW5rIEpEQkNDb25m\naWd1cmF0aW9ufSBjYW4gYmUgc2V0IGJ5CiAgICAgKiB1c2luZyB0aGVpcglu\nYW1lcyBhbmQgc3VwcGx5aW5nIGEgdmFsdWUuIEZvciBleGFtcGxlOgogICAg\nICogPGNvZGU+LWxpY2Vuc2VLZXkgYWRzbGZqYTgzcjNsa2FkZjwvY29kZT48\nL2xpPgogICAgICogPC91bD4KICAgICAqICBUaGUgdmFyaW91cyBhY3Rpb25z\nIGFyZSBhcyBmb2xsb3dzLgogICAgICogPHVsPgogICAgICogPGxpPjxpPmFk\nZDwvaT46IENyZWF0ZSB0aGUgc2VxdWVuY2UgdGFibGUuPC9saT4KICAgICAq\nIDxsaT48aT5kcm9wPC9pPjogRHJvcCB0aGUgc2VxdWVuY2UgdGFibGUuPC9s\naT4KICAgICAqIDxsaT48aT5nZXQ8L2k+OiBQcmludCB0aGUgY3VycmVudCBz\nZXF1ZW5jZSB2YWx1ZS48L2xpPgogICAgICogPGxpPjxpPnNldDwvaT46IFNl\ndCB0aGUgc2VxdWVuY2UgdmFsdWUuPC9saT4KICAgICAqIDwvdWw+CiAgICAg\nKi8KICAgIHB1YmxpYyBzdGF0aWMgdm9pZCBtYWluKFN0cmluZ1tdIGFyZ3Mp\nCiAgICAgICAgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgT3B0aW9ucyBv\ncHRzID0gbmV3IE9wdGlvbnMoKTsKICAgICAgICBmaW5hbCBTdHJpbmdbXSBh\ncmd1bWVudHMgPSBvcHRzLnNldEZyb21DbWRMaW5lKGFyZ3MpOwogICAgICAg\nIGJvb2xlYW4gcmV0ID0gQ29uZmlndXJhdGlvbnMucnVuQWdhaW5zdEFsbEFu\nY2hvcnMob3B0cywKICAgICAgICAgICAgbmV3IENvbmZpZ3VyYXRpb25zLlJ1\nbm5hYmxlKCkgewogICAgICAgICAgICBwdWJsaWMgYm9vbGVhbiBydW4oT3B0\naW9ucyBvcHRzKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICAgICAgICAg\nIEpEQkNDb25maWd1cmF0aW9uIGNvbmYgPSBuZXcgSkRCQ0NvbmZpZ3VyYXRp\nb25JbXBsKCk7CiAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAg\nICAgICAgIHJldHVybiBUYWJsZUpEQkNTZXEucnVuKGNvbmYsIGFyZ3VtZW50\ncywgb3B0cyk7CiAgICAgICAgICAgICAgICB9IGZpbmFsbHkgewogICAgICAg\nICAgICAgICAgICAgIGNvbmYuY2xvc2UoKTsKICAgICAgICAgICAgICAgIH0K\nICAgICAgICAgICAgfQogICAgICAgIH0pOwogICAgICAgIGlmICghcmV0KQog\nICAgICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oX2xvYy5nZXQoInNlcS11\nc2FnZSIpKTsKICAgIH0KCiAgICAvKioKICAgICAqIFJ1biB0aGUgdG9vbC4g\nUmV0dXJucyBmYWxzZSBpZiBpbnZhbGlkIG9wdGlvbnMgd2VyZSBnaXZlbi4K\nICAgICAqLwogICAgcHVibGljIHN0YXRpYyBib29sZWFuIHJ1bihKREJDQ29u\nZmlndXJhdGlvbiBjb25mLCBTdHJpbmdbXSBhcmdzLAogICAgICAgIE9wdGlv\nbnMgb3B0cykKICAgICAgICB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBT\ndHJpbmcgYWN0aW9uID0gb3B0cy5yZW1vdmVQcm9wZXJ0eSgiYWN0aW9uIiwg\nImEiLCBudWxsKTsKICAgICAgICBDb25maWd1cmF0aW9ucy5wb3B1bGF0ZUNv\nbmZpZ3VyYXRpb24oY29uZiwgb3B0cyk7CiAgICAgICAgcmV0dXJuIHJ1bihj\nb25mLCBhcmdzLCBhY3Rpb24pOwogICAgfQoKICAgIC8qKgogICAgICogUnVu\nIHRoZSB0b29sLiBSZXR1cm4gZmFsc2UgaWYgYW4gaW52YWxpZCBvcHRpb24g\nd2FzIGdpdmVuLgogICAgICovCiAgICBwdWJsaWMgc3RhdGljIGJvb2xlYW4g\ncnVuKEpEQkNDb25maWd1cmF0aW9uIGNvbmYsIFN0cmluZ1tdIGFyZ3MsCiAg\nICAgICAgU3RyaW5nIGFjdGlvbikKICAgICAgICB0aHJvd3MgRXhjZXB0aW9u\nIHsKICAgICAgICBpZiAoYXJncy5sZW5ndGggPiAxIHx8IChhcmdzLmxlbmd0\naCAhPSAwCiAgICAgICAgICAgICYmICFBQ1RJT05fU0VULmVxdWFscyhhY3Rp\nb24pKSkKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoKICAgICAgICBUYWJs\nZUpEQkNTZXEgc2VxID0gbmV3IFRhYmxlSkRCQ1NlcSgpOwogICAgICAgIFN0\ncmluZyBwcm9wcyA9IENvbmZpZ3VyYXRpb25zLmdldFByb3BlcnRpZXMoY29u\nZi5nZXRTZXF1ZW5jZSgpKTsKICAgICAgICBDb25maWd1cmF0aW9ucy5jb25m\naWd1cmVJbnN0YW5jZShzZXEsIGNvbmYsIHByb3BzKTsKCiAgICAgICAgaWYg\nKEFDVElPTl9EUk9QLmVxdWFscyhhY3Rpb24pKQogICAgICAgICAgICBzZXEu\nZHJvcFRhYmxlKCk7CiAgICAgICAgZWxzZSBpZiAoQUNUSU9OX0FERC5lcXVh\nbHMoYWN0aW9uKSkKICAgICAgICAgICAgc2VxLnJlZnJlc2hUYWJsZSgpOwog\nICAgICAgIGVsc2UgaWYgKEFDVElPTl9HRVQuZXF1YWxzKGFjdGlvbikgfHwg\nQUNUSU9OX1NFVC5lcXVhbHMoYWN0aW9uKSkgewogICAgICAgICAgICBDb25u\nZWN0aW9uIGNvbm4gPSBjb25mLmdldERhdGFTb3VyY2UyKG51bGwpLmdldENv\nbm5lY3Rpb24oKTsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAg\nIGxvbmcgY3VyID0gc2VxLmdldFNlcXVlbmNlKG51bGwsIGNvbm4pOwogICAg\nICAgICAgICAgICAgaWYgKEFDVElPTl9HRVQuZXF1YWxzKGFjdGlvbikpCiAg\nICAgICAgICAgICAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKGN1cik7CiAg\nICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBsb25n\nIHNldDsKICAgICAgICAgICAgICAgICAgICBpZiAoYXJncy5sZW5ndGggPiAw\nKQogICAgICAgICAgICAgICAgICAgICAgICBzZXQgPSBMb25nLnBhcnNlTG9u\nZyhhcmdzWzBdKTsKICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAg\nICAgICAgICAgICAgICAgIHNldCA9IGN1ciArIHNlcS5nZXRBbGxvY2F0ZSgp\nOwogICAgICAgICAgICAgICAgICAgIGlmIChzZXQgPCBjdXIpCiAgICAgICAg\nICAgICAgICAgICAgICAgIHNldCA9IGN1cjsKICAgICAgICAgICAgICAgICAg\nICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgU3RhdHVzIHN0YXQg\nPSBzZXEuZ2V0U3RhdHVzKG51bGwpOwogICAgICAgICAgICAgICAgICAgICAg\nICBzZXEuc2V0U2VxdWVuY2UobnVsbCwgc3RhdCwgKGludCkgKHNldCAtIGN1\nciksIHRydWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25uKTsK\nICAgICAgICAgICAgICAgICAgICAgICAgc2V0ID0gc3RhdC5zZXE7CiAgICAg\nICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIFN5c3RlbS5l\ncnIucHJpbnRsbihzZXQpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAg\nICB9CiAgICAgICAgICAgIGNhdGNoIChOdW1iZXJGb3JtYXRFeGNlcHRpb24g\nbmZlKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAg\nICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgICAgICB0cnkgeyBjb25uLmNs\nb3NlKCk7IH0gY2F0Y2ggKFNRTEV4Y2VwdGlvbiBzZSkge30KICAgICAgICAg\nICAgfQogICAgICAgIH0gZWxzZQogICAgICAgICAgICByZXR1cm4gZmFsc2U7\nCiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBI\nZWxwZXIgc3RydWN0IHRvIGhvbGQgc3RhdHVzIGluZm9ybWF0aW9uLgogICAg\nICovCiAgICBwcm90ZWN0ZWQgc3RhdGljIGNsYXNzIFN0YXR1cwogICAgICAg\nIGltcGxlbWVudHMgU2VyaWFsaXphYmxlIHsKCiAgICAgICAgcHVibGljIGxv\nbmcgc2VxID0gMUw7CiAgICAgICAgcHVibGljIGxvbmcgbWF4ID0gMEw7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBUaGlzIG1ldGhvZCBpcyB0byBwcm92aWRl\nIG92ZXJyaWRlIGZvciBub24tSkRCQyBvciBKREJDLWxpa2UgCiAgICAgKiBp\nbXBsZW1lbnRhdGlvbiBvZiBwcmVwYXJpbmcgc3RhdGVtZW50LgogICAgICov\nCiAgICBwcm90ZWN0ZWQgUHJlcGFyZWRTdGF0ZW1lbnQgcHJlcGFyZVN0YXRl\nbWVudChDb25uZWN0aW9uIGNvbm4sIFNRTEJ1ZmZlciBidWYpCiAgICAgICAg\ndGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgcmV0dXJuIGJ1Zi5wcmVw\nYXJlU3RhdGVtZW50KGNvbm4pOwogICAgfQogICAgCiAgICAvKioKICAgICAq\nIFRoaXMgbWV0aG9kIGlzIHRvIHByb3ZpZGUgb3ZlcnJpZGUgZm9yIG5vbi1K\nREJDIG9yIEpEQkMtbGlrZSAKICAgICAqIGltcGxlbWVudGF0aW9uIG9mIGV4\nZWN1dGluZyB1cGRhdGUuCiAgICAgKi8KICAgIHByb3RlY3RlZCBpbnQgZXhl\nY3V0ZVVwZGF0ZShKREJDQ29uZmlndXJhdGlvbiBjb25mLCBDb25uZWN0aW9u\nIGNvbm4sICAKICAgICAgICBQcmVwYXJlZFN0YXRlbWVudCBzdG1udCwgU1FM\nQnVmZmVyIGJ1ZiwgaW50IG9wY29kZSkgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7\nCiAgICAgICAgcmV0dXJuIHN0bW50LmV4ZWN1dGVVcGRhdGUoKTsKICAgIH0K\nICAgIAogICAgLyoqCiAgICAgKiBUaGlzIG1ldGhvZCBpcyB0byBwcm92aWRl\nIG92ZXJyaWRlIGZvciBub24tSkRCQyBvciBKREJDLWxpa2UgCiAgICAgKiBp\nbXBsZW1lbnRhdGlvbiBvZiBleGVjdXRpbmcgcXVlcnkuCiAgICAgKi8KICAg\nIHByb3RlY3RlZCBSZXN1bHRTZXQgZXhlY3V0ZVF1ZXJ5KEpEQkNDb25maWd1\ncmF0aW9uIGNvbmYsIENvbm5lY3Rpb24gY29ubiwKICAgICAgICBQcmVwYXJl\nZFN0YXRlbWVudCBzdG1udCwgU1FMQnVmZmVyIGJ1ZikgdGhyb3dzIFNRTEV4\nY2VwdGlvbiB7CiAgICAgICAgcmV0dXJuIHN0bW50LmV4ZWN1dGVRdWVyeSgp\nOwogICAgfQogICAgCiAgICAvKioKICAgICAqIFRoaXMgbWV0aG9kIGlzIHRv\nIHByb3ZpZGUgb3ZlcnJpZGUgZm9yIG5vbi1KREJDIG9yIEpEQkMtbGlrZSAK\nICAgICAqIGltcGxlbWVudGF0aW9uIG9mIGdldHRpbmcgc2VxdWVuY2UgZnJv\nbSB0aGUgcmVzdWx0IHNldC4KICAgICAqLwogICAgcHJvdGVjdGVkIGxvbmcg\nZ2V0U2VxdWVuY2UoUmVzdWx0U2V0IHJzLCBEQkRpY3Rpb25hcnkgZGljdCkg\ndGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgaWYgKHJzID09IG51bGwg\nfHwgIXJzLm5leHQoKSkKICAgICAgICAgICAgcmV0dXJuIC0xOwogICAgICAg\nIHJldHVybiBkaWN0LmdldExvbmcocnMsIDEpOwogICAgfQoKICAgIC8qKgog\nICAgICogQWxsb2NhdGVTZXF1ZW5jZVJ1bm5hYmxlIGlzIGEgcnVubmFibGUg\nd3JhcHBlciB0aGF0IHdpbGwgaW5zZXJ0cyB0aGUKICAgICAqIGluaXRpYWwg\nc2VxdWVuY2UgdmFsdWUgaW50byB0aGUgZGF0YWJhc2UuCiAgICAgKi8KICAg\nIHByb3RlY3RlZCBjbGFzcyBBbGxvY2F0ZVNlcXVlbmNlUnVubmFibGUgaW1w\nbGVtZW50cyBSdW5uYWJsZSB7CgogICAgICAgIEpEQkNTdG9yZSBzdG9yZSA9\nIG51bGw7CiAgICAgICAgQ2xhc3NNYXBwaW5nIG1hcHBpbmcgPSBudWxsOwog\nICAgICAgIFN0YXR1cyBzdGF0ID0gbnVsbDsKICAgICAgICBpbnQgYWxsb2M7\nCiAgICAgICAgYm9vbGVhbiB1cGRhdGVTdGF0U2VxOwoKICAgICAgICBBbGxv\nY2F0ZVNlcXVlbmNlUnVubmFibGUoSkRCQ1N0b3JlIHN0b3JlLCBDbGFzc01h\ncHBpbmcgbWFwcGluZywKICAgICAgICAgICAgICAgIFN0YXR1cyBzdGF0LCBp\nbnQgYWxsb2MsIGJvb2xlYW4gdXBkYXRlU3RhdFNlcSkgewogICAgICAgICAg\nICB0aGlzLnN0b3JlID0gc3RvcmU7CiAgICAgICAgICAgIHRoaXMubWFwcGlu\nZyA9IG1hcHBpbmc7CiAgICAgICAgICAgIHRoaXMuc3RhdCA9IHN0YXQ7CiAg\nICAgICAgICAgIHRoaXMuYWxsb2MgPSBhbGxvYzsKICAgICAgICAgICAgdGhp\ncy51cGRhdGVTdGF0U2VxID0gdXBkYXRlU3RhdFNlcTsKICAgICAgICB9Cgog\nICAgICAgIC8qKgogICAgICAgICAqIFRoaXMgbWV0aG9kIGFjdHVhbGx5IG9i\ndGFpbnMgdGhlIGN1cnJlbnQgc2VxdWVuY2UgdmFsdWUuCiAgICAgICAgICog\nCiAgICAgICAgICogQHRocm93cyBSdW50aW1lRXhjZXB0aW9uCiAgICAgICAg\nICogICAgICAgICAgICAgYW55IFNRTEV4Y2VwdGlvbnMgdGhhdCBvY2N1ciB3\naGVuIG9idGFpbmluZyB0aGUgc2VxdWVuY2UKICAgICAgICAgKiAgICAgICAg\nICAgICB2YWx1ZSBhcmUgd3JhcHBlZCBpbiBhIHJ1bnRpbWUgZXhjZXB0aW9u\nIHRvIGF2b2lkCiAgICAgICAgICogICAgICAgICAgICAgYnJlYWtpbmcgdGhl\nIFJ1bm5hYmxlIG1ldGhvZCBzaWduYXR1cmUuIFRoZSBjYWxsZXIgY2FuCiAg\nICAgICAgICogICAgICAgICAgICAgb2J0YWluIHRoZSAicmVhbCIgZXhjZXB0\naW9uIGJ5IGNhbGxpbmcgZ2V0Q2F1c2UoKS4KICAgICAgICAgKi8KICAgICAg\nICBwdWJsaWMgdm9pZCBydW4oKSB0aHJvd3MgUnVudGltZUV4Y2VwdGlvbiB7\nCiAgICAgICAgICAgIENvbm5lY3Rpb24gY29ubiA9IG51bGw7CiAgICAgICAg\nICAgIFNRTEV4Y2VwdGlvbiBlcnIgPSBudWxsOwogICAgICAgICAgICB0cnkg\newogICAgICAgICAgICAgICAgLy8gVHJ5IHRvIHVzZSB0aGUgc3RvcmUncyBj\nb25uZWN0aW9uLgogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBj\nb25uID0gZ2V0Q29ubmVjdGlvbihzdG9yZSk7ICAKICAgICAgICAgICAgICAg\nIGJvb2xlYW4gc2VxdWVuY2VTZXQgPQogICAgICAgICAgICAgICAgICAgIHNl\ndFNlcXVlbmNlKG1hcHBpbmcsIHN0YXQsIGFsbG9jLCB1cGRhdGVTdGF0U2Vx\nLCBjb25uKTsKICAgICAgICAgICAgICAgIGNsb3NlQ29ubmVjdGlvbihjb25u\nKTsKCiAgICAgICAgICAgICAgICBpZiAoIXNlcXVlbmNlU2V0KSB7CiAgICAg\nICAgICAgICAgICAgICAgLy8gaW5zZXJ0IGEgbmV3IHNlcXVlbmNlIGNvbHVt\nbi4gCiAgICAgICAgICAgICAgICAgICAgLy8gUHJlZmVyIGNvbm5lY3Rpb24y\nIC8gbm9uLWp0YS1kYXRhLXNvdXJjZSB3aGVuIGluc2VydGluZyAKICAgICAg\nICAgICAgICAgICAgICAvLyBhIHNlcXVlbmNlIGNvbHVtbiByZWdhcmRsZXNz\nIG9mIFNlcS50eXBlLgogICAgICAgICAgICAgICAgICAgIGNvbm4gPSBfY29u\nZi5nZXREYXRhU291cmNlMihzdG9yZS5nZXRDb250ZXh0KCkpCiAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgLmdldENvbm5lY3Rpb24oKTsKICAg\nICAgICAgICAgICAgICAgICBpbnNlcnRTZXF1ZW5jZShtYXBwaW5nLCBjb25u\nKTsKICAgICAgICAgICAgICAgICAgICBjb25uLmNsb3NlKCk7CgogICAgICAg\nICAgICAgICAgICAgIC8vIG5vdyB3ZSBzaG91bGQgYmUgYWJsZSB0byB1cGRh\ndGUgdXNpbmcgdGhlIGNvbm5lY3Rpb24gcGVyCiAgICAgICAgICAgICAgICAg\nICAgLy8gb24gdGhlIHNlcSB0eXBlLgogICAgICAgICAgICAgICAgICAgIGNv\nbm4gPSBnZXRDb25uZWN0aW9uKHN0b3JlKTsKICAgICAgICAgICAgICAgICAg\nICBpZiAoIXNldFNlcXVlbmNlKG1hcHBpbmcsIHN0YXQsIGFsbG9jLCB1cGRh\ndGVTdGF0U2VxLCBjb25uKSkKICAgICAgICAgICAgICAgICAgICB7CiAgICAg\nICAgICAgICAgICAgICAgICAgIHRocm93IChlcnIgIT0gbnVsbCkgPyBlcnIg\nOiBuZXcgU1FMRXhjZXB0aW9uKF9sb2MuZ2V0KAogICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICJuby1zZXEtcm93IiwgbWFwcGluZywgX3RhYmxl\nKS5nZXRNZXNzYWdlKCkpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAg\nICAgICAgICAgICAgICBjbG9zZUNvbm5lY3Rpb24oY29ubik7CiAgICAgICAg\nICAgICAgICB9CiAgICAgICAgICAgIH0gY2F0Y2ggKFNRTEV4Y2VwdGlvbiBl\nKSB7CiAgICAgICAgICAgICAgICBpZiAoY29ubiAhPSBudWxsKSB7CiAgICAg\nICAgICAgICAgICAgICAgY2xvc2VDb25uZWN0aW9uKGNvbm4pOwogICAgICAg\nICAgICAgICAgfQogICAgICAgICAgICAgICAgUnVudGltZUV4Y2VwdGlvbiBy\nZSA9IG5ldyBSdW50aW1lRXhjZXB0aW9uKGUuZ2V0TWVzc2FnZSgpKTsKICAg\nICAgICAgICAgICAgIHJlLmluaXRDYXVzZShlKTsKICAgICAgICAgICAgICAg\nIHRocm93IHJlOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQoKICAg\nIC8qKgogICAgICogQ3VyZW50U2VxdWVuY2VSdW5uYWJsZSBpcyBhIHJ1bm5h\nYmxlIHdyYXBwZXIgd2hpY2ggb2J0YWlucyB0aGUgY3VycmVudAogICAgICog\nc2VxdWVuY2UgdmFsdWUgZnJvbSB0aGUgZGF0YWJhc2UuCiAgICAgKi8KICAg\nIHByb3RlY3RlZCBjbGFzcyBDdXJyZW50U2VxdWVuY2VSdW5uYWJsZSBpbXBs\nZW1lbnRzIFJ1bm5hYmxlIHsKICAgICAgICBwcml2YXRlIEpEQkNTdG9yZSBf\nc3RvcmU7CiAgICAgICAgcHJpdmF0ZSBDbGFzc01hcHBpbmcgX21hcHBpbmc7\nCgogICAgICAgIEN1cnJlbnRTZXF1ZW5jZVJ1bm5hYmxlKEpEQkNTdG9yZSBz\ndG9yZSwgQ2xhc3NNYXBwaW5nIG1hcHBpbmcpIHsKICAgICAgICAgICAgX3N0\nb3JlID0gc3RvcmU7CiAgICAgICAgICAgIF9tYXBwaW5nID0gbWFwcGluZzsK\nICAgICAgICB9CgogICAgICAgIC8qKgogICAgICAgICAqIFRoaXMgbWV0aG9k\nIGFjdHVhbGx5IG9idGFpbnMgdGhlIGN1cnJlbnQgc2VxdWVuY2UgdmFsdWUu\nCiAgICAgICAgICogCiAgICAgICAgICogQHRocm93cyBSdW50aW1lRXhjZXB0\naW9uCiAgICAgICAgICogICAgICAgICAgICAgYW55IFNRTEV4Y2VwdGlvbnMg\ndGhhdCBvY2N1ciB3aGVuIG9idGFpbmluZyB0aGUgc2VxdWVuY2UKICAgICAg\nICAgKiAgICAgICAgICAgICB2YWx1ZSBhcmUgd3JhcHBlZCBpbiBhIHJ1bnRp\nbWUgZXhjZXB0aW9uIHRvIGF2b2lkCiAgICAgICAgICogICAgICAgICAgICAg\nYnJlYWtpbmcgdGhlIFJ1bm5hYmxlIG1ldGhvZCBzaWduYXR1cmUuIFRoZSBj\nYWxsZXIgY2FuCiAgICAgICAgICogICAgICAgICAgICAgb2J0YWluIHRoZSAi\ncmVhbCIgZXhjZXB0aW9uIGJ5IGNhbGxpbmcgZ2V0Q2F1c2UoKS4KICAgICAg\nICAgKi8KICAgICAgICBwdWJsaWMgdm9pZCBydW4oKSB0aHJvd3MgUnVudGlt\nZUV4Y2VwdGlvbiB7CiAgICAgICAgICAgIENvbm5lY3Rpb24gY29ubiA9IG51\nbGw7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBjb25uID0g\nZ2V0Q29ubmVjdGlvbihfc3RvcmUpOwogICAgICAgICAgICAgICAgbG9uZyBj\ndXIgPSBnZXRTZXF1ZW5jZShfbWFwcGluZywgY29ubik7CiAgICAgICAgICAg\nICAgICBpZiAoY3VyICE9IC0xICkgLy8gVVNFIHRoZSBjb25zdGFudAogICAg\nICAgICAgICAgICAgICAgIGN1cnJlbnQgPSBOdW1iZXJzLnZhbHVlT2YoY3Vy\nKTsKICAgICAgICAgICAgfSBjYXRjaCAoU1FMRXhjZXB0aW9uIHNxbGUpIHsK\nICAgICAgICAgICAgICAgIFJ1bnRpbWVFeGNlcHRpb24gcmUgPSBuZXcgUnVu\ndGltZUV4Y2VwdGlvbihzcWxlLmdldE1lc3NhZ2UoKSk7CiAgICAgICAgICAg\nICAgICByZS5pbml0Q2F1c2Uoc3FsZSk7CiAgICAgICAgICAgICAgICB0aHJv\ndyByZTsKICAgICAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgICAg\nIGlmIChjb25uICE9IG51bGwpIHsKICAgICAgICAgICAgICAgICAgICBjbG9z\nZUNvbm5lY3Rpb24oY29ubik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAg\nICAgIH0KICAgICAgICB9CiAgICB9Cn0K\n","encoding":"base64"}

