{"sha":"b23c9164989350068e7e9d6b9318b7cd922e2ed4","node_id":"MDQ6QmxvYjIwNjM2NDpiMjNjOTE2NDk4OTM1MDA2OGU3ZTlkNmI5MzE4YjdjZDkyMmUyZWQ0","size":9486,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/b23c9164989350068e7e9d6b9318b7cd922e2ed4","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhLnN0cmF0czsK\nCmltcG9ydCBqYXZhLm1hdGguQmlnRGVjaW1hbDsKaW1wb3J0IGphdmEuc3Fs\nLlNRTEV4Y2VwdGlvbjsKaW1wb3J0IGphdmEudXRpbC5Db21wYXJhdG9yOwoK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLmtlcm5lbC5KREJDU3Rv\ncmU7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhLkNsYXNz\nTWFwcGluZzsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLm1ldGEu\nVmVyc2lvbk1hcHBpbmdJbmZvOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLmpkYmMuc2NoZW1hLkNvbHVtbjsKaW1wb3J0IG9yZy5hcGFjaGUub3Blbmpw\nYS5qZGJjLnNjaGVtYS5Db2x1bW5JTzsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5qZGJjLnNjaGVtYS5JbmRleDsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5qZGJjLnNxbC5SZXN1bHQ7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEuamRiYy5zcWwuUm93OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpk\nYmMuc3FsLlJvd01hbmFnZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\namRiYy5zcWwuU2VsZWN0OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmtl\ncm5lbC5PcGVuSlBBU3RhdGVNYW5hZ2VyOwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLmtlcm5lbC5TdG9yZU1hbmFnZXI7CmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEubGliLnV0aWwuTG9jYWxpemVyOwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLm1ldGEuSmF2YVR5cGVzOwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLnV0aWwuTWV0YURhdGFFeGNlcHRpb247CgovKioKICogVXNlcyBh\nIHNpbmdsZSBjb2x1bW4gYW5kIGNvcnJlc3BvbmRpbmcgdmVyc2lvbiBvYmpl\nY3QuCiAqCiAqIEBhdXRob3IgTWFyYyBQcnVkJ2hvbW1lYXV4CiAqLwpwdWJs\naWMgYWJzdHJhY3QgY2xhc3MgQ29sdW1uVmVyc2lvblN0cmF0ZWd5CiAgICBl\neHRlbmRzIEFic3RyYWN0VmVyc2lvblN0cmF0ZWd5IHsKCiAgICBwcml2YXRl\nIHN0YXRpYyBmaW5hbCBMb2NhbGl6ZXIgX2xvYyA9IExvY2FsaXplci5mb3JQ\nYWNrYWdlCiAgICAgICAgKENvbHVtblZlcnNpb25TdHJhdGVneS5jbGFzcyk7\nCgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIGNvZGUgZnJvbSB7QGxpbmsg\nSmF2YVR5cGVzfSBmb3IgdGhlIHZlcnNpb24gdmFsdWVzIHRoaXMKICAgICAq\nIHN0cmF0ZWd5IHVzZXMuIFRoaXMgbWV0aG9kIGlzIG9ubHkgdXNlZCBkdXJp\nbmcgbWFwcGluZyBpbnN0YWxsYXRpb24uCiAgICAgKi8KICAgIHByb3RlY3Rl\nZCBhYnN0cmFjdCBpbnQgZ2V0SmF2YVR5cGUoKTsKCiAgICAvKioKICAgICAq\nIFJldHVybiB0aGUgbmV4dCB2ZXJzaW9uIGdpdmVuIHRoZSBjdXJyZW50IG9u\nZSwgd2hpY2ggbWF5IGJlIG51bGwuCiAgICAgKi8KICAgIHByb3RlY3RlZCBh\nYnN0cmFjdCBPYmplY3QgbmV4dFZlcnNpb24oT2JqZWN0IHZlcnNpb24pOwoK\nICAgIC8qKgogICAgICogQ29tcGFyZSB0aGUgdHdvIHZlcnNpb25zLiBEZWZh\ndWx0cyB0byBhc3N1bWluZyB0aGUgdmVyc2lvbiBvYmplY3RzCiAgICAgKiBp\nbXBsZW1lbnQge0BsaW5rIENvbXBhcmFibGV9LgogICAgICoKICAgICAqIEBz\nZWUgQ29tcGFyYXRvciNjb21wYXJlCiAgICAgKi8KICAgIHByb3RlY3RlZCBp\nbnQgY29tcGFyZShPYmplY3QgdjEsIE9iamVjdCB2MikgewogICAgICAgIGlm\nICh2MSA9PSB2MikKICAgICAgICAgICAgcmV0dXJuIDA7CiAgICAgICAgaWYg\nKHYxID09IG51bGwpCiAgICAgICAgICAgIHJldHVybiAtMTsKICAgICAgICBp\nZiAodjIgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIDE7CgogICAgICAg\nIGlmICh2MS5nZXRDbGFzcygpICE9IHYyLmdldENsYXNzKCkpIHsKICAgICAg\nICAgICAgaWYgKHYxIGluc3RhbmNlb2YgTnVtYmVyICYmICEodjEgaW5zdGFu\nY2VvZiBCaWdEZWNpbWFsKSkKICAgICAgICAgICAgICAgIHYxID0gbmV3IEJp\nZ0RlY2ltYWwoKChOdW1iZXIpIHYxKS5kb3VibGVWYWx1ZSgpKTsKCiAgICAg\nICAgICAgIGlmICh2MiBpbnN0YW5jZW9mIE51bWJlciAmJiAhKHYyIGluc3Rh\nbmNlb2YgQmlnRGVjaW1hbCkpCiAgICAgICAgICAgICAgICB2MiA9IG5ldyBC\naWdEZWNpbWFsKCgoTnVtYmVyKSB2MikuZG91YmxlVmFsdWUoKSk7CiAgICAg\nICAgfQoKICAgICAgICByZXR1cm4gKChDb21wYXJhYmxlKSB2MSkuY29tcGFy\nZVRvKHYyKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBtYXAoYm9vbGVhbiBh\nZGFwdCkgewogICAgICAgIENsYXNzTWFwcGluZyBjbHMgPSB2ZXJzLmdldENs\nYXNzTWFwcGluZygpOwogICAgICAgIGlmIChjbHMuZ2V0Sm9pbmFibGVQQ1N1\ncGVyY2xhc3NNYXBwaW5nKCkgIT0gbnVsbAogICAgICAgICAgICB8fCBjbHMu\nZ2V0RW1iZWRkaW5nTWV0YURhdGEoKSAhPSBudWxsKQogICAgICAgICAgICB0\naHJvdyBuZXcgTWV0YURhdGFFeGNlcHRpb24oX2xvYy5nZXQoIm5vdC1iYXNl\nLXZlcnMiLCBjbHMpKTsKCiAgICAgICAgVmVyc2lvbk1hcHBpbmdJbmZvIGlu\nZm8gPSB2ZXJzLmdldE1hcHBpbmdJbmZvKCk7CiAgICAgICAgaW5mby5hc3Nl\ncnROb0pvaW4odmVycywgdHJ1ZSk7CiAgICAgICAgaW5mby5hc3NlcnROb0Zv\ncmVpZ25LZXkodmVycywgIWFkYXB0KTsKICAgICAgICBpbmZvLmFzc2VydE5v\nVW5pcXVlKHZlcnMsIGZhbHNlKTsKCiAgICAgICAgQ29sdW1uIHRtcGxhdGUg\nPSBuZXcgQ29sdW1uKCk7CiAgICAgICAgdG1wbGF0ZS5zZXRKYXZhVHlwZShn\nZXRKYXZhVHlwZSgpKTsKICAgICAgICB0bXBsYXRlLnNldE5hbWUoInZlcnNu\nIik7CgogICAgICAgIENvbHVtbltdIGNvbHMgPSBpbmZvLmdldENvbHVtbnMo\ndmVycywgbmV3IENvbHVtbltdeyB0bXBsYXRlIH0sIGFkYXB0KTsKICAgICAg\nICBjb2xzWzBdLnNldFZlcnNpb25TdHJhdGVneSh0aGlzKTsKICAgICAgICB2\nZXJzLnNldENvbHVtbnMoY29scyk7CiAgICAgICAgdmVycy5zZXRDb2x1bW5J\nTyhpbmZvLmdldENvbHVtbklPKCkpOwoKICAgICAgICBJbmRleCBpZHggPSBp\nbmZvLmdldEluZGV4KHZlcnMsIGNvbHMsIGFkYXB0KTsKICAgICAgICB2ZXJz\nLnNldEluZGV4KGlkeCk7CiAgICB9CgogICAgcHVibGljIHZvaWQgaW5zZXJ0\nKE9wZW5KUEFTdGF0ZU1hbmFnZXIgc20sIEpEQkNTdG9yZSBzdG9yZSwgUm93\nTWFuYWdlciBybSkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAg\nICAgICBDb2x1bW5bXSBjb2xzID0gdmVycy5nZXRDb2x1bW5zKCk7CiAgICAg\nICAgQ29sdW1uSU8gaW8gPSB2ZXJzLmdldENvbHVtbklPKCk7CiAgICAgICAg\nT2JqZWN0IGluaXRpYWwgPSBuZXh0VmVyc2lvbihudWxsKTsKICAgICAgICBS\nb3cgcm93ID0gcm0uZ2V0Um93KHZlcnMuZ2V0Q2xhc3NNYXBwaW5nKCkuZ2V0\nVGFibGUoKSwKICAgICAgICAgICAgUm93LkFDVElPTl9JTlNFUlQsIHNtLCB0\ncnVlKTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGNvbHMubGVuZ3Ro\nOyBpKyspCiAgICAgICAgICAgIGlmIChpby5pc0luc2VydGFibGUoaSwgaW5p\ndGlhbCA9PSBudWxsKSkKICAgICAgICAgICAgICAgIHJvdy5zZXRPYmplY3Qo\nY29sc1tpXSwgaW5pdGlhbCk7CgogICAgICAgIC8vIHNldCBpbml0aWFsIHZl\ncnNpb24gaW50byBzdGF0ZSBtYW5hZ2VyCiAgICAgICAgT2JqZWN0IG5leHRW\nZXJzaW9uOwogICAgICAgIG5leHRWZXJzaW9uID0gaW5pdGlhbDsKICAgICAg\nICBzbS5zZXROZXh0VmVyc2lvbihuZXh0VmVyc2lvbik7CiAgICB9CgogICAg\ncHVibGljIHZvaWQgdXBkYXRlKE9wZW5KUEFTdGF0ZU1hbmFnZXIgc20sIEpE\nQkNTdG9yZSBzdG9yZSwgUm93TWFuYWdlciBybSkKICAgICAgICB0aHJvd3Mg\nU1FMRXhjZXB0aW9uIHsKICAgICAgICBDb2x1bW5bXSBjb2xzID0gdmVycy5n\nZXRDb2x1bW5zKCk7CiAgICAgICAgaWYgKGNvbHMgPT0gbnVsbCB8fCBjb2xz\nLmxlbmd0aCA9PSAwIHx8CiAgICAgICAgICAgICFzbS5pc0RpcnR5KCkgJiYg\nIXNtLmlzVmVyc2lvblVwZGF0ZVJlcXVpcmVkKCkpCiAgICAgICAgICAgIHJl\ndHVybjsKCiAgICAgICAgT2JqZWN0IGN1clZlcnNpb24gPSBzbS5nZXRWZXJz\naW9uKCk7CiAgICAgICAgT2JqZWN0IG5leHRWZXJzaW9uID0gbmV4dFZlcnNp\nb24oY3VyVmVyc2lvbik7CgogICAgICAgIFJvdyByb3cgPSBybS5nZXRSb3co\ndmVycy5nZXRDbGFzc01hcHBpbmcoKS5nZXRUYWJsZSgpLAogICAgICAgICAg\nICBSb3cuQUNUSU9OX1VQREFURSwgc20sIHRydWUpOwogICAgICAgIHJvdy5z\nZXRGYWlsZWRPYmplY3Qoc20uZ2V0TWFuYWdlZEluc3RhbmNlKCkpOwoKICAg\nICAgICAvLyBzZXQgd2hlcmUgYW5kIHVwZGF0ZSBjb25kaXRpb25zIG9uIHJv\ndwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgY29scy5sZW5ndGg7IGkr\nKykgewogICAgICAgICAgICBpZiAoY3VyVmVyc2lvbiAhPSBudWxsICYmIHNt\nLmlzVmVyc2lvbkNoZWNrUmVxdWlyZWQoKSkKICAgICAgICAgICAgICAgIHJv\ndy53aGVyZU9iamVjdChjb2xzW2ldLCBjdXJWZXJzaW9uKTsKICAgICAgICAg\nICAgaWYgKHZlcnMuZ2V0Q29sdW1uSU8oKS5pc1VwZGF0YWJsZShpLCBuZXh0\nVmVyc2lvbiA9PSBudWxsKSkKICAgICAgICAgICAgICAgIHJvdy5zZXRPYmpl\nY3QoY29sc1tpXSwgbmV4dFZlcnNpb24pOwogICAgICAgIH0KCiAgICAgICAg\naWYgKG5leHRWZXJzaW9uICE9IG51bGwpCiAgICAgICAgICAgIHNtLnNldE5l\neHRWZXJzaW9uKG5leHRWZXJzaW9uKTsKICAgIH0KCiAgICBwdWJsaWMgdm9p\nZCBkZWxldGUoT3BlbkpQQVN0YXRlTWFuYWdlciBzbSwgSkRCQ1N0b3JlIHN0\nb3JlLCBSb3dNYW5hZ2VyIHJtKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRp\nb24gewogICAgICAgIFJvdyByb3cgPSBybS5nZXRSb3codmVycy5nZXRDbGFz\nc01hcHBpbmcoKS5nZXRUYWJsZSgpLAogICAgICAgICAgICBSb3cuQUNUSU9O\nX0RFTEVURSwgc20sIHRydWUpOwogICAgICAgIHJvdy5zZXRGYWlsZWRPYmpl\nY3Qoc20uZ2V0TWFuYWdlZEluc3RhbmNlKCkpOwogICAgICAgIENvbHVtbltd\nIGNvbHMgPSB2ZXJzLmdldENvbHVtbnMoKTsKCiAgICAgICAgT2JqZWN0IGN1\nclZlcnNpb24gPSBzbS5nZXRWZXJzaW9uKCk7CiAgICAgICAgT2JqZWN0IGN1\ncjsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGNvbHMubGVuZ3RoOyBp\nKyspIHsKICAgICAgICAgICAgaWYgKGNvbHMubGVuZ3RoID09IDEgfHwgY3Vy\nVmVyc2lvbiA9PSBudWxsKQogICAgICAgICAgICAgICAgY3VyID0gY3VyVmVy\nc2lvbjsKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgY3VyID0g\nKChPYmplY3RbXSkgY3VyVmVyc2lvbilbaV07CgogICAgICAgICAgICAvLyBz\nZXQgd2hlcmUgYW5kIHVwZGF0ZSBjb25kaXRpb25zIG9uIHJvdwogICAgICAg\nICAgICBpZiAoY3VyICE9IG51bGwpCiAgICAgICAgICAgICAgICByb3cud2hl\ncmVPYmplY3QoY29sc1tpXSwgY3VyKTsKICAgICAgICB9CiAgICB9CgogICAg\ncHVibGljIGJvb2xlYW4gc2VsZWN0KFNlbGVjdCBzZWwsIENsYXNzTWFwcGlu\nZyBtYXBwaW5nKSB7CiAgICAgICAgc2VsLnNlbGVjdCh2ZXJzLmdldENvbHVt\nbnMoKSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgcHVibGlj\nIE9iamVjdCBsb2FkKE9wZW5KUEFTdGF0ZU1hbmFnZXIgc20sIEpEQkNTdG9y\nZSBzdG9yZSwgUmVzdWx0IHJlcykKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0\naW9uIHsKICAgICAgICAvLyB0eXBpY2FsbHkgaWYgb25lIHZlcnNpb24gY29s\ndW1uIGlzIGluIHRoZSByZXN1bHQsIHRoZXkgYWxsIGFyZSwgc28KICAgICAg\nICAvLyBvcHRpbWl6ZSBieSBjaGVja2luZyBmb3IgdGhlIGZpcnN0IG9uZSBi\nZWZvcmUgZG9pbmcgYW55IHJlYWwgd29yawogICAgICAgIENvbHVtbltdIGNv\nbHMgPSB2ZXJzLmdldENvbHVtbnMoKTsKICAgICAgICBpZiAoIXJlcy5jb250\nYWlucyhjb2xzWzBdKSkKICAgICAgICAgICAgcmV0dXJuIG51bGw7CgogICAg\nICAgIE9iamVjdCB2ZXJzaW9uID0gbnVsbDsKICAgICAgICBpZiAoY29scy5s\nZW5ndGggPiAwKQogICAgICAgICAgICB2ZXJzaW9uID0gbmV3IE9iamVjdFtj\nb2xzLmxlbmd0aF07CiAgICAgICAgT2JqZWN0IGN1cjsKICAgICAgICBmb3Ig\nKGludCBpID0gMDsgaSA8IGNvbHMubGVuZ3RoOyBpKyspIHsKICAgICAgICAg\nICAgaWYgKGkgPiAwICYmICFyZXMuY29udGFpbnMoY29sc1tpXSkpCiAgICAg\nICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICAgICAgY3VyID0gcmVz\nLmdldE9iamVjdChjb2xzW2ldLCAtMSwgbnVsbCk7CiAgICAgICAgICAgIGlm\nIChjb2xzLmxlbmd0aCA9PSAxKQogICAgICAgICAgICAgICAgdmVyc2lvbiA9\nIGN1cjsKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgKChPYmpl\nY3RbXSkgdmVyc2lvbilbaV0gPSBjdXI7CiAgICAgICAgfQogICAgICAgIC8v\nIE9QRU5KUEEtNjYyIEFsbG93IGEgbnVsbCBTdGF0ZU1hbmFnZXIgYmVjYXVz\nZSB0aGlzIG1ldGhvZCBtYXkganVzdCBiZQogICAgICAgIC8vIGludm9rZWQg\ndG8gZ2V0IHRoZSByZXN1bHQgb2YgcHJvamVjdGlvbiBxdWVyeQogICAgICAg\nIGlmIChzbSAhPSBudWxsKQogICAgICAgIAlzbS5zZXRWZXJzaW9uKHZlcnNp\nb24pOwogICAgICAgIHJldHVybiB2ZXJzaW9uOwogICAgfQoKICAgIHB1Ymxp\nYyBib29sZWFuIGNoZWNrVmVyc2lvbihPcGVuSlBBU3RhdGVNYW5hZ2VyIHNt\nLCBKREJDU3RvcmUgc3RvcmUsCiAgICAgICAgYm9vbGVhbiB1cGRhdGVWZXJz\naW9uKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIENv\nbHVtbltdIGNvbHMgPSB2ZXJzLmdldENvbHVtbnMoKTsKICAgICAgICBTZWxl\nY3Qgc2VsID0gc3RvcmUuZ2V0U1FMRmFjdG9yeSgpLm5ld1NlbGVjdCgpOwog\nICAgICAgIHNlbC5zZWxlY3QoY29scyk7CiAgICAgICAgc2VsLndoZXJlUHJp\nbWFyeUtleShzbS5nZXRPYmplY3RJZCgpLCB2ZXJzLmdldENsYXNzTWFwcGlu\nZygpLCBzdG9yZSk7CgogICAgICAgIFJlc3VsdCByZXMgPSBzZWwuZXhlY3V0\nZShzdG9yZSwgbnVsbCk7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgaWYg\nKCFyZXMubmV4dCgpKQogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoK\nICAgICAgICAgICAgT2JqZWN0IG1lbVZlcnNpb24gPSBzbS5nZXRWZXJzaW9u\nKCk7CiAgICAgICAgICAgIE9iamVjdCBkYlZlcnNpb24gPSBudWxsOwogICAg\nICAgICAgICBpZiAoY29scy5sZW5ndGggPiAxKQogICAgICAgICAgICAgICAg\nZGJWZXJzaW9uID0gbmV3IE9iamVjdFtjb2xzLmxlbmd0aF07CgogICAgICAg\nICAgICBib29sZWFuIHJlZnJlc2ggPSBmYWxzZTsKICAgICAgICAgICAgT2Jq\nZWN0IG1lbSwgZGI7CiAgICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwg\nY29scy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgZGIgPSByZXMu\nZ2V0T2JqZWN0KGNvbHNbaV0sIC0xLCBudWxsKTsKICAgICAgICAgICAgICAg\nIGlmIChjb2xzLmxlbmd0aCA9PSAxKQogICAgICAgICAgICAgICAgICAgIGRi\nVmVyc2lvbiA9IGRiOwogICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAg\nICAgICAgICAgICgoT2JqZWN0W10pIGRiVmVyc2lvbilbaV0gPSBkYjsKCiAg\nICAgICAgICAgICAgICAvLyBpZiB3ZSBoYXZlbid0IGFscmVhZHkgZGV0ZXJt\naW5lZCB0aGF0IHdlIG5lZWQgYSByZWZyZXNoLAogICAgICAgICAgICAgICAg\nLy8gY2hlY2sgaWYgdGhlIG1lbSB2ZXJzaW9uIGlzIGVhcmxpZXIgdGhhbiB0\naGUgZGIgb25lCiAgICAgICAgICAgICAgICBpZiAoIXJlZnJlc2gpIHsKICAg\nICAgICAgICAgICAgICAgICBpZiAoY29scy5sZW5ndGggPT0gMSB8fCBtZW1W\nZXJzaW9uID09IG51bGwpCiAgICAgICAgICAgICAgICAgICAgICAgIG1lbSA9\nIG1lbVZlcnNpb247CiAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAg\nICAgICAgICAgICAgICAgICBtZW0gPSAoKE9iamVjdFtdKSBtZW1WZXJzaW9u\nKVtpXTsKCiAgICAgICAgICAgICAgICAgICAgaWYgKG1lbSA9PSBudWxsIHx8\nIChkYiAhPSBudWxsICYmIGNvbXBhcmUobWVtLCBkYikgPCAwKSkKICAgICAg\nICAgICAgICAgICAgICAgICAgcmVmcmVzaCA9IHRydWU7CiAgICAgICAgICAg\nICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmICh1cGRhdGVW\nZXJzaW9uKQogICAgICAgICAgICAgICAgc20uc2V0VmVyc2lvbihkYlZlcnNp\nb24pOwogICAgICAgICAgICByZXR1cm4gIXJlZnJlc2g7CiAgICAgICAgfSBm\naW5hbGx5IHsKICAgICAgICAgICAgcmVzLmNsb3NlKCk7CiAgICAgICAgfQog\nICAgfQoKICAgIHB1YmxpYyBpbnQgY29tcGFyZVZlcnNpb24oT2JqZWN0IHYx\nLCBPYmplY3QgdjIpIHsKICAgICAgICBpZiAodjEgPT0gdjIpCiAgICAgICAg\nICAgIHJldHVybiBTdG9yZU1hbmFnZXIuVkVSU0lPTl9TQU1FOwogICAgICAg\nIGlmICh2MSA9PSBudWxsIHx8IHYyID09IG51bGwpCiAgICAgICAgICAgIHJl\ndHVybiBTdG9yZU1hbmFnZXIuVkVSU0lPTl9ESUZGRVJFTlQ7CgogICAgICAg\nIGludCBjbXAgPSBjb21wYXJlKHYxLCB2Mik7CiAgICAgICAgaWYgKGNtcCA8\nIDApCiAgICAgICAgICAgIHJldHVybiBTdG9yZU1hbmFnZXIuVkVSU0lPTl9F\nQVJMSUVSOwogICAgICAgIGlmIChjbXAgPiAwKQogICAgICAgICAgICByZXR1\ncm4gU3RvcmVNYW5hZ2VyLlZFUlNJT05fTEFURVI7CiAgICAgICAgcmV0dXJu\nIFN0b3JlTWFuYWdlci5WRVJTSU9OX1NBTUU7CiAgICB9Cn0K\n","encoding":"base64"}

