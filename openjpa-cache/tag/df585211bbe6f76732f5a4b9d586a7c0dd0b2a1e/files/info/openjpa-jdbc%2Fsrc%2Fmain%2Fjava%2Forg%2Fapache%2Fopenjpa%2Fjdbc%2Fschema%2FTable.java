{"sha":"e30d0f648a03095adb75e1c8163ce22a9d4a5f0d","node_id":"MDQ6QmxvYjIwNjM2NDplMzBkMGY2NDhhMDMwOTVhZGI3NWUxYzgxNjNjZTIyYTlkNGE1ZjBk","size":20982,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/e30d0f648a03095adb75e1c8163ce22a9d4a5f0d","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hlbWE7CgppbXBv\ncnQgamF2YS5pby5GaWxlOwppbXBvcnQgamF2YS51dGlsLkFycmF5TGlzdDsK\naW1wb3J0IGphdmEudXRpbC5Db2xsZWN0aW9uOwppbXBvcnQgamF2YS51dGls\nLkl0ZXJhdG9yOwppbXBvcnQgamF2YS51dGlsLk1hcDsKaW1wb3J0IGphdmEu\ndXRpbC5UcmVlTWFwOwppbXBvcnQgamF2YS51dGlsLkxpbmtlZEhhc2hNYXA7\nCgppbXBvcnQgb3JnLmFwYWNoZS5jb21tb25zLmxhbmcuU3RyaW5nVXRpbHM7\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLm1ldGEuU291cmNlVHJh\nY2tlcjsKCi8qKgogKiBSZXByZXNlbnRzIGEgZGF0YWJhc2UgdGFibGUuCiAq\nCiAqIEBhdXRob3IgQWJlIFdoaXRlCiAqIEBhdXRob3IgU3RlcGhlbiBLaW0K\nICovCnB1YmxpYyBjbGFzcyBUYWJsZQogICAgZXh0ZW5kcyBOYW1lU2V0CiAg\nICBpbXBsZW1lbnRzIENvbXBhcmFibGUsIFNvdXJjZVRyYWNrZXIgewoKICAg\nIHByaXZhdGUgU3RyaW5nIF9uYW1lID0gbnVsbDsKICAgIHByaXZhdGUgU3Ry\naW5nIF9zY2hlbWFOYW1lID0gbnVsbDsKICAgIHByaXZhdGUgTWFwIF9jb2xN\nYXAgPSBudWxsOwogICAgcHJpdmF0ZSBNYXAgX2lkeE1hcCA9IG51bGw7CiAg\nICBwcml2YXRlIENvbGxlY3Rpb24gX2ZrTGlzdCA9IG51bGw7CiAgICBwcml2\nYXRlIENvbGxlY3Rpb24gX3VucUxpc3QgPSBudWxsOwogICAgcHJpdmF0ZSBT\nY2hlbWEgX3NjaGVtYSA9IG51bGw7CiAgICBwcml2YXRlIFByaW1hcnlLZXkg\nX3BrID0gbnVsbDsKCiAgICAvLyBrZWVwIHRyYWNrIG9mIHNvdXJjZQogICAg\ncHJpdmF0ZSBGaWxlIF9zb3VyY2UgPSBudWxsOwogICAgcHJpdmF0ZSBpbnQg\nX3NyY1R5cGUgPSBTUkNfT1RIRVI7CgogICAgLy8gY2FjaGUKICAgIHByaXZh\ndGUgU3RyaW5nIF9mdWxsTmFtZSA9IG51bGw7CiAgICBwcml2YXRlIENvbHVt\nbltdIF9jb2xzID0gbnVsbDsKICAgIHByaXZhdGUgQ29sdW1uW10gX2F1dG9B\nc3NpZ24gPSBudWxsOwogICAgcHJpdmF0ZSBDb2x1bW5bXSBfcmVscyA9IG51\nbGw7CiAgICBwcml2YXRlIEZvcmVpZ25LZXlbXSBfZmtzID0gbnVsbDsKICAg\nIHByaXZhdGUgSW5kZXhbXSBfaWR4cyA9IG51bGw7CiAgICBwcml2YXRlIFVu\naXF1ZVtdIF91bnFzID0gbnVsbDsKICAgIHByaXZhdGUgU3RyaW5nIF9jb21t\nZW50ID0gbnVsbDsKCiAgICAvKioKICAgICAqIERlZmF1bHQgY29uc3RydWN0\nb3IuCiAgICAgKi8KICAgIHB1YmxpYyBUYWJsZSgpIHsKICAgIH0KCiAgICAv\nKioKICAgICAqIENvbnN0cnVjdG9yLgogICAgICoKICAgICAqIEBwYXJhbSBu\nYW1lIHRoZSB0YWJsZSBuYW1lCiAgICAgKiBAcGFyYW0gc2NoZW1hIHRoZSB0\nYWJsZSBzY2hlbWEKICAgICAqLwogICAgcHVibGljIFRhYmxlKFN0cmluZyBu\nYW1lLCBTY2hlbWEgc2NoZW1hKSB7CiAgICAgICAgc2V0TmFtZShuYW1lKTsK\nICAgICAgICBhZGROYW1lKG5hbWUsIHRydWUpOwogICAgICAgIGlmIChzY2hl\nbWEgIT0gbnVsbCkKICAgICAgICAgICAgc2V0U2NoZW1hTmFtZShzY2hlbWEu\nZ2V0TmFtZSgpKTsKICAgICAgICBfc2NoZW1hID0gc2NoZW1hOwogICAgfQoK\nICAgIC8qKgogICAgICogQ2FsbGVkIHdoZW4gdGhlIHRhYmxlIGlzIHJlbW92\nZWQgZnJvbSBpdHMgc2NoZW1hLiBSZW1vdmVzIGFsbCB0YWJsZQogICAgICog\nbWVtYmVycywgYW5kIGludmFsaWRhdGVzIHRoZSB0YWJsZS4KICAgICAqLwog\nICAgdm9pZCByZW1vdmUoKSB7CiAgICAgICAgRm9yZWlnbktleVtdIGZrcyA9\nIGdldEZvcmVpZ25LZXlzKCk7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkg\nPCBma3MubGVuZ3RoOyBpKyspCiAgICAgICAgICAgIHJlbW92ZUZvcmVpZ25L\nZXkoZmtzW2ldKTsKICAgICAgICBJbmRleFtdIGlkeHMgPSBnZXRJbmRleGVz\nKCk7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBpZHhzLmxlbmd0aDsg\naSsrKQogICAgICAgICAgICByZW1vdmVJbmRleChpZHhzW2ldKTsKICAgICAg\nICBVbmlxdWVbXSB1bnFzID0gZ2V0VW5pcXVlcygpOwogICAgICAgIGZvciAo\naW50IGkgPSAwOyBpIDwgdW5xcy5sZW5ndGg7IGkrKykKICAgICAgICAgICAg\ncmVtb3ZlVW5pcXVlKHVucXNbaV0pOwogICAgICAgIHJlbW92ZVByaW1hcnlL\nZXkoKTsKICAgICAgICBDb2x1bW5bXSBjb2xzID0gZ2V0Q29sdW1ucygpOwog\nICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgY29scy5sZW5ndGg7IGkrKykK\nICAgICAgICAgICAgcmVtb3ZlQ29sdW1uKGNvbHNbaV0pOwogICAgICAgIF9z\nY2hlbWEgPSBudWxsOwogICAgICAgIF9zY2hlbWFOYW1lID0gbnVsbDsKICAg\nICAgICBfZnVsbE5hbWUgPSBudWxsOwogICAgfQoKICAgIC8qKgogICAgICog\nUmV0dXJuIHRoZSBzY2hlbWEgZm9yIHRoZSB0YWJsZS4KICAgICAqLwogICAg\ncHVibGljIFNjaGVtYSBnZXRTY2hlbWEoKSB7CiAgICAgICAgcmV0dXJuIF9z\nY2hlbWE7CiAgICB9CgogICAgLyoqCiAgICAgKiBUaGUgdGFibGUncyBzY2hl\nbWEgbmFtZS4KICAgICAqLwogICAgcHVibGljIFN0cmluZyBnZXRTY2hlbWFO\nYW1lKCkgewogICAgICAgIHJldHVybiBfc2NoZW1hTmFtZTsKICAgIH0KCiAg\nICAvKioKICAgICAqIFRoZSB0YWJsZSdzIHNjaGVtYSBuYW1lLiBZb3UgY2Fu\nIG9ubHkgY2FsbCB0aGlzIG1ldGhvZCBvbiB0YWJsZXMKICAgICAqIHdob3Nl\nIHNjaGVtYSBvYmplY3QgaXMgbm90IHNldC4KICAgICAqLwogICAgcHVibGlj\nIHZvaWQgc2V0U2NoZW1hTmFtZShTdHJpbmcgbmFtZSkgewogICAgICAgIGlm\nIChnZXRTY2hlbWEoKSAhPSBudWxsKQogICAgICAgICAgICB0aHJvdyBuZXcg\nSWxsZWdhbFN0YXRlRXhjZXB0aW9uKCk7CiAgICAgICAgX3NjaGVtYU5hbWUg\nPSBuYW1lOwogICAgICAgIF9mdWxsTmFtZSA9IG51bGw7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBSZXR1cm4gdGhlIG5hbWUgb2YgdGhlIHRhYmxlLgogICAg\nICovCiAgICBwdWJsaWMgU3RyaW5nIGdldE5hbWUoKSB7CiAgICAgICAgcmV0\ndXJuIF9uYW1lOwogICAgfQoKICAgIC8qKgogICAgICogU2V0IHRoZSBuYW1l\nIG9mIHRoZSB0YWJsZS4gVGhpcyBtZXRob2QgY2FuIG9ubHkgYmUgY2FsbGVk\nIG9uIHRhYmxlcwogICAgICogdGhhdCBhcmUgbm90IHBhcnQgb2YgYSBzY2hl\nbWEuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHNldE5hbWUoU3RyaW5nIG5h\nbWUpIHsKICAgICAgICBpZiAoZ2V0U2NoZW1hKCkgIT0gbnVsbCkKICAgICAg\nICAgICAgdGhyb3cgbmV3IElsbGVnYWxTdGF0ZUV4Y2VwdGlvbigpOwogICAg\nICAgIF9uYW1lID0gbmFtZTsKICAgICAgICBfZnVsbE5hbWUgPSBudWxsOwog\nICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRoZSB0YWJsZSBuYW1lLCBp\nbmNsdWRpbmcgc2NoZW1hLCB1c2luZyAnLicgYXMgdGhlCiAgICAgKiBjYXRh\nbG9nIHNlcGFyYXRvci4KICAgICAqLwogICAgcHVibGljIFN0cmluZyBnZXRG\ndWxsTmFtZSgpIHsKICAgICAgICBpZiAoX2Z1bGxOYW1lID09IG51bGwpIHsK\nICAgICAgICAgICAgU2NoZW1hIHNjaGVtYSA9IGdldFNjaGVtYSgpOwogICAg\nICAgICAgICBpZiAoc2NoZW1hID09IG51bGwgfHwgc2NoZW1hLmdldE5hbWUo\nKSA9PSBudWxsKQogICAgICAgICAgICAgICAgX2Z1bGxOYW1lID0gZ2V0TmFt\nZSgpOwogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICBfZnVsbE5h\nbWUgPSBzY2hlbWEuZ2V0TmFtZSgpICsgIi4iICsgZ2V0TmFtZSgpOwogICAg\nICAgIH0KICAgICAgICByZXR1cm4gX2Z1bGxOYW1lOwogICAgfQoKICAgIHB1\nYmxpYyBGaWxlIGdldFNvdXJjZUZpbGUoKSB7CiAgICAgICAgcmV0dXJuIF9z\nb3VyY2U7CiAgICB9CgogICAgcHVibGljIE9iamVjdCBnZXRTb3VyY2VTY29w\nZSgpIHsKICAgICAgICByZXR1cm4gbnVsbDsKICAgIH0KCiAgICBwdWJsaWMg\naW50IGdldFNvdXJjZVR5cGUoKSB7CiAgICAgICAgcmV0dXJuIF9zcmNUeXBl\nOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldFNvdXJjZShGaWxlIHNvdXJj\nZSwgaW50IHNyY1R5cGUpIHsKICAgICAgICBfc291cmNlID0gc291cmNlOwog\nICAgICAgIF9zcmNUeXBlID0gc3JjVHlwZTsKICAgIH0KCiAgICBwdWJsaWMg\nU3RyaW5nIGdldFJlc291cmNlTmFtZSgpIHsKICAgICAgICByZXR1cm4gZ2V0\nRnVsbE5hbWUoKTsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0aGUg\ndGFibGUncyBjb2x1bW5zLCBpbiBhbHBoYWJldGljYWwgb3JkZXIuCiAgICAg\nKi8KICAgIHB1YmxpYyBDb2x1bW5bXSBnZXRDb2x1bW5zKCkgewogICAgICAg\nIGlmIChfY29scyA9PSBudWxsKSB7CiAgICAgICAgICAgIGlmIChfY29sTWFw\nID09IG51bGwpCiAgICAgICAgICAgICAgICBfY29scyA9IFNjaGVtYXMuRU1Q\nVFlfQ09MVU1OUzsKICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAg\nICBDb2x1bW5bXSBjb2xzID0gbmV3IENvbHVtbltfY29sTWFwLnNpemUoKV07\nCiAgICAgICAgICAgICAgICBJdGVyYXRvciBpdHIgPSBfY29sTWFwLnZhbHVl\ncygpLml0ZXJhdG9yKCk7CiAgICAgICAgICAgICAgICBmb3IgKGludCBpID0g\nMDsgaXRyLmhhc05leHQoKTsgaSsrKSB7CiAgICAgICAgICAgICAgICAgICAg\nY29sc1tpXSA9IChDb2x1bW4pIGl0ci5uZXh0KCk7CiAgICAgICAgICAgICAg\nICAgICAgY29sc1tpXS5zZXRJbmRleChpKTsKICAgICAgICAgICAgICAgIH0K\nICAgICAgICAgICAgICAgIF9jb2xzID0gY29sczsKICAgICAgICAgICAgfQog\nICAgICAgIH0KICAgICAgICByZXR1cm4gX2NvbHM7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBSZXR1cm4gdGhpcyB0YWJsZSdzIGF1dG8tYXNzaWduZWQgY29s\ndW1ucy4KICAgICAqLwogICAgcHVibGljIENvbHVtbltdIGdldEF1dG9Bc3Np\nZ25lZENvbHVtbnMoKSB7CiAgICAgICAgaWYgKF9hdXRvQXNzaWduID09IG51\nbGwpIHsKICAgICAgICAgICAgaWYgKF9jb2xNYXAgPT0gbnVsbCkKICAgICAg\nICAgICAgICAgIF9hdXRvQXNzaWduID0gU2NoZW1hcy5FTVBUWV9DT0xVTU5T\nOwogICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgIENvbGxlY3Rp\nb24gYXV0b3MgPSBudWxsOwogICAgICAgICAgICAgICAgQ29sdW1uW10gY29s\ncyA9IGdldENvbHVtbnMoKTsKICAgICAgICAgICAgICAgIGZvciAoaW50IGkg\nPSAwOyBpIDwgY29scy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAg\nICAgIGlmIChjb2xzW2ldLmlzQXV0b0Fzc2lnbmVkKCkpIHsKICAgICAgICAg\nICAgICAgICAgICAgICAgaWYgKGF1dG9zID09IG51bGwpCiAgICAgICAgICAg\nICAgICAgICAgICAgICAgICBhdXRvcyA9IG5ldyBBcnJheUxpc3QoMyk7CiAg\nICAgICAgICAgICAgICAgICAgICAgIGF1dG9zLmFkZChjb2xzW2ldKTsKICAg\nICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAg\nICAgICAgICBfYXV0b0Fzc2lnbiA9IChhdXRvcyA9PSBudWxsKSA/IFNjaGVt\nYXMuRU1QVFlfQ09MVU1OUwogICAgICAgICAgICAgICAgICAgIDogKENvbHVt\nbltdKSBhdXRvcy50b0FycmF5KG5ldyBDb2x1bW5bYXV0b3Muc2l6ZSgpXSk7\nCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIF9hdXRv\nQXNzaWduOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRoaXMgdGFi\nbGUncyByZWxhdGlvbiBpZCBjb2x1bW5zLgogICAgICovCiAgICBwdWJsaWMg\nQ29sdW1uW10gZ2V0UmVsYXRpb25JZENvbHVtbnMoKSB7CiAgICAgICAgaWYg\nKF9yZWxzID09IG51bGwpIHsKICAgICAgICAgICAgaWYgKF9jb2xNYXAgPT0g\nbnVsbCkKICAgICAgICAgICAgICAgIF9yZWxzID0gU2NoZW1hcy5FTVBUWV9D\nT0xVTU5TOwogICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgIENv\nbGxlY3Rpb24gcmVscyA9IG51bGw7CiAgICAgICAgICAgICAgICBDb2x1bW5b\nXSBjb2xzID0gZ2V0Q29sdW1ucygpOwogICAgICAgICAgICAgICAgZm9yIChp\nbnQgaSA9IDA7IGkgPCBjb2xzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAg\nICAgICAgICAgaWYgKGNvbHNbaV0uaXNSZWxhdGlvbklkKCkpIHsKICAgICAg\nICAgICAgICAgICAgICAgICAgaWYgKHJlbHMgPT0gbnVsbCkKICAgICAgICAg\nICAgICAgICAgICAgICAgICAgIHJlbHMgPSBuZXcgQXJyYXlMaXN0KDMpOwog\nICAgICAgICAgICAgICAgICAgICAgICByZWxzLmFkZChjb2xzW2ldKTsKICAg\nICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAg\nICAgICAgICBfcmVscyA9IChyZWxzID09IG51bGwpID8gU2NoZW1hcy5FTVBU\nWV9DT0xVTU5TCiAgICAgICAgICAgICAgICAgICAgOiAoQ29sdW1uW10pIHJl\nbHMudG9BcnJheShuZXcgQ29sdW1uW3JlbHMuc2l6ZSgpXSk7CiAgICAgICAg\nICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIF9yZWxzOwogICAgfQoK\nICAgIHB1YmxpYyBTdHJpbmdbXSBnZXRDb2x1bW5OYW1lcygpIHsKICAgIAly\nZXR1cm4gX2NvbE1hcCA9PSBudWxsID8gbmV3IFN0cmluZ1swXSA6IAogICAg\nCQkoU3RyaW5nW10pX2NvbE1hcC5rZXlTZXQoKS50b0FycmF5KG5ldyBTdHJp\nbmdbX2NvbE1hcC5zaXplKCldKTsKICAgIH0KICAgIAogICAgLyoqCiAgICAg\nKiBSZXR1cm4gdGhlIGNvbHVtbiB3aXRoIHRoZSBnaXZlbiBuYW1lLCBvciBu\ndWxsIGlmIG5vbmUuCiAgICAgKi8KICAgIHB1YmxpYyBDb2x1bW4gZ2V0Q29s\ndW1uKFN0cmluZyBuYW1lKSB7CiAgICAgICAgaWYgKG5hbWUgPT0gbnVsbCB8\nfCBfY29sTWFwID09IG51bGwpCiAgICAgICAgICAgIHJldHVybiBudWxsOwog\nICAgICAgIHJldHVybiAoQ29sdW1uKSBfY29sTWFwLmdldChuYW1lLnRvVXBw\nZXJDYXNlKCkpOwogICAgfQogICAgCiAgICAvKioKICAgICAqIEFmZmlybXMg\naWYgdGhpcyB0YWJsZSBjb250YWlucyB0aGUgY29sdW1uIG9mIHRoZSBnaXZl\nbiBuYW1lIHdpdGhvdXQgYW55IAogICAgICogc2lkZS1lZmZlY3QuIAogICAg\nICogQHNlZSBUYWJsZSNnZXRDb2x1bW4oU3RyaW5nKSBjYW4gaGF2ZSBzaWRl\nLWVmZmVjdCBvZiBjcmVhdGluZyBhIGNvbHVtbgogICAgICogZm9yIGR5bmFt\naWMgdGFibGUgaW1wbGVtZW50YXRpb24uCiAgICAgKi8KICAgIHB1YmxpYyBi\nb29sZWFuIGNvbnRhaW5zQ29sdW1uKFN0cmluZyBuYW1lKSB7CiAgICAJcmV0\ndXJuIG5hbWUgIT0gbnVsbCAmJiBfY29sTWFwICE9IG51bGwgCiAgICAJCSYm\nIF9jb2xNYXAuY29udGFpbnNLZXkobmFtZS50b1VwcGVyQ2FzZSgpKTsKICAg\nIH0KCiAgICAvKioKICAgICAqIEFkZCBhIGNvbHVtbiB0byB0aGUgdGFibGUu\nCiAgICAgKi8KICAgIHB1YmxpYyBDb2x1bW4gYWRkQ29sdW1uKFN0cmluZyBu\nYW1lKSB7CiAgICAgICAgYWRkTmFtZShuYW1lLCB0cnVlKTsKICAgICAgICBT\nY2hlbWEgc2NoZW1hID0gZ2V0U2NoZW1hKCk7CiAgICAgICAgQ29sdW1uIGNv\nbDsKICAgICAgICBpZiAoc2NoZW1hICE9IG51bGwgJiYgc2NoZW1hLmdldFNj\naGVtYUdyb3VwKCkgIT0gbnVsbCkKICAgICAgICAgICAgY29sID0gc2NoZW1h\nLmdldFNjaGVtYUdyb3VwKCkubmV3Q29sdW1uKG5hbWUsIHRoaXMpOwogICAg\nICAgIGVsc2UKICAgICAgICAgICAgY29sID0gbmV3IENvbHVtbihuYW1lLCB0\naGlzKTsKICAgICAgICBpZiAoX2NvbE1hcCA9PSBudWxsKQogICAgICAgICAg\nICBfY29sTWFwID0gbmV3IExpbmtlZEhhc2hNYXAoKTsKICAgICAgICBfY29s\nTWFwLnB1dChuYW1lLnRvVXBwZXJDYXNlKCksIGNvbCk7CiAgICAgICAgX2Nv\nbHMgPSBudWxsOwogICAgICAgIHJldHVybiBjb2w7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBSZW1vdmUgdGhlIGdpdmVuIGNvbHVtbiBmcm9tIHRoZSB0YWJs\nZS4KICAgICAqCiAgICAgKiBAcmV0dXJuIHRydWUgaWYgdGhlIGNvbHVtbiB3\nYXMgcmVtb3ZlZCwgZmFsc2UgaWYgbm90IGluIHRoZSB0YWJsZQogICAgICov\nCiAgICBwdWJsaWMgYm9vbGVhbiByZW1vdmVDb2x1bW4oQ29sdW1uIGNvbCkg\newogICAgICAgIGlmIChjb2wgPT0gbnVsbCB8fCBfY29sTWFwID09IG51bGwp\nCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCiAgICAgICAgQ29sdW1uIGN1\nciA9IChDb2x1bW4pIF9jb2xNYXAuZ2V0KGNvbC5nZXROYW1lKCkudG9VcHBl\nckNhc2UoKSk7CiAgICAgICAgaWYgKCFjb2wuZXF1YWxzKGN1cikpCiAgICAg\nICAgICAgIHJldHVybiBmYWxzZTsKCiAgICAgICAgcmVtb3ZlTmFtZShjb2wu\nZ2V0TmFtZSgpKTsKICAgICAgICBfY29sTWFwLnJlbW92ZShjb2wuZ2V0TmFt\nZSgpLnRvVXBwZXJDYXNlKCkpOwogICAgICAgIF9jb2xzID0gbnVsbDsKICAg\nICAgICBpZiAoY29sLmlzQXV0b0Fzc2lnbmVkKCkpCiAgICAgICAgICAgIF9h\ndXRvQXNzaWduID0gbnVsbDsKICAgICAgICBpZiAoY29sLmlzUmVsYXRpb25J\nZCgpKQogICAgICAgICAgICBfcmVscyA9IG51bGw7CiAgICAgICAgY29sLnJl\nbW92ZSgpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qKgog\nICAgICogSW1wb3J0IGEgY29sdW1uIGZyb20gYW5vdGhlciB0YWJsZS4KICAg\nICAqLwogICAgcHVibGljIENvbHVtbiBpbXBvcnRDb2x1bW4oQ29sdW1uIGNv\nbCkgewogICAgICAgIGlmIChjb2wgPT0gbnVsbCkKICAgICAgICAgICAgcmV0\ndXJuIG51bGw7CgogICAgICAgIENvbHVtbiBjb3B5ID0gYWRkQ29sdW1uKGNv\nbC5nZXROYW1lKCkpOwogICAgICAgIGNvcHkuc2V0VHlwZShjb2wuZ2V0VHlw\nZSgpKTsKICAgICAgICBjb3B5LnNldFR5cGVOYW1lKGNvbC5nZXRUeXBlTmFt\nZSgpKTsKICAgICAgICBjb3B5LnNldEphdmFUeXBlKGNvbC5nZXRKYXZhVHlw\nZSgpKTsKICAgICAgICBjb3B5LnNldE5vdE51bGwoY29sLmlzTm90TnVsbCgp\nKTsKICAgICAgICBjb3B5LnNldERlZmF1bHRTdHJpbmcoY29sLmdldERlZmF1\nbHRTdHJpbmcoKSk7CiAgICAgICAgY29weS5zZXRTaXplKGNvbC5nZXRTaXpl\nKCkpOwogICAgICAgIGNvcHkuc2V0RGVjaW1hbERpZ2l0cyhjb2wuZ2V0RGVj\naW1hbERpZ2l0cygpKTsKICAgICAgICBjb3B5LnNldEF1dG9Bc3NpZ25lZChj\nb2wuaXNBdXRvQXNzaWduZWQoKSk7CiAgICAgICAgcmV0dXJuIGNvcHk7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIHByaW1hcnkga2V5IGZv\nciB0aGUgdGFibGUsIGlmIGFueS4KICAgICAqLwogICAgcHVibGljIFByaW1h\ncnlLZXkgZ2V0UHJpbWFyeUtleSgpIHsKICAgICAgICByZXR1cm4gX3BrOwog\nICAgfQoKICAgIC8qKgogICAgICogU2V0IHRoZSBwcmltYXJ5IGtleSBmb3Ig\ndGhlIHRhYmxlLgogICAgICovCiAgICBwdWJsaWMgUHJpbWFyeUtleSBhZGRQ\ncmltYXJ5S2V5KCkgewogICAgICAgIHJldHVybiBhZGRQcmltYXJ5S2V5KG51\nbGwpOwogICAgfQoKICAgIC8qKgogICAgICogU2V0IHRoZSBwcmltYXJ5IGtl\neSBmb3IgdGhlIHRhYmxlLgogICAgICovCiAgICBwdWJsaWMgUHJpbWFyeUtl\neSBhZGRQcmltYXJ5S2V5KFN0cmluZyBuYW1lKSB7CiAgICAgICAgU2NoZW1h\nIHNjaGVtYSA9IGdldFNjaGVtYSgpOwogICAgICAgIGlmIChzY2hlbWEgIT0g\nbnVsbCAmJiBzY2hlbWEuZ2V0U2NoZW1hR3JvdXAoKSAhPSBudWxsKSB7CiAg\nICAgICAgICAgIHNjaGVtYS5nZXRTY2hlbWFHcm91cCgpLmFkZE5hbWUobmFt\nZSwgZmFsc2UpOwogICAgICAgICAgICBfcGsgPSBzY2hlbWEuZ2V0U2NoZW1h\nR3JvdXAoKS5uZXdQcmltYXJ5S2V5KG5hbWUsIHRoaXMpOwogICAgICAgIH0g\nZWxzZQogICAgICAgICAgICBfcGsgPSBuZXcgUHJpbWFyeUtleShuYW1lLCB0\naGlzKTsKICAgICAgICByZXR1cm4gX3BrOwogICAgfQoKICAgIC8qKgogICAg\nICogUmVtb3ZlIHRoZSBwcmltYXJ5IGtleSBmcm9tIHRoaXMgdGFibGUuCiAg\nICAgKgogICAgICogQHJldHVybiB0cnVlIGlmIHRoZXJlIHdhcyBhIHBrIHRv\nIHJlbW92ZSwgZmFsc2Ugb3RoZXJ3aXNlCiAgICAgKi8KICAgIHB1YmxpYyBi\nb29sZWFuIHJlbW92ZVByaW1hcnlLZXkoKSB7CiAgICAgICAgYm9vbGVhbiBy\nZW0gPSBfcGsgIT0gbnVsbDsKICAgICAgICBpZiAocmVtKSB7CiAgICAgICAg\nICAgIFNjaGVtYSBzY2hlbWEgPSBnZXRTY2hlbWEoKTsKICAgICAgICAgICAg\naWYgKHNjaGVtYSAhPSBudWxsICYmIHNjaGVtYS5nZXRTY2hlbWFHcm91cCgp\nICE9IG51bGwpCiAgICAgICAgICAgICAgICBzY2hlbWEuZ2V0U2NoZW1hR3Jv\ndXAoKS5yZW1vdmVOYW1lKF9way5nZXROYW1lKCkpOwogICAgICAgICAgICBf\ncGsucmVtb3ZlKCk7CiAgICAgICAgfQogICAgICAgIF9wayA9IG51bGw7CiAg\nICAgICAgcmV0dXJuIHJlbTsKICAgIH0KCiAgICAvKioKICAgICAqIEltcG9y\ndCBhIHByaW1hcnkga2V5OyBjb2x1bW4gbmFtZXMgbXVzdCBtYXRjaCBjb2x1\nbW5zIG9mIHRoaXMgdGFibGUuCiAgICAgKi8KICAgIHB1YmxpYyBQcmltYXJ5\nS2V5IGltcG9ydFByaW1hcnlLZXkoUHJpbWFyeUtleSBwaykgewogICAgICAg\nIGlmIChwayA9PSBudWxsKQogICAgICAgICAgICByZXR1cm4gbnVsbDsKCiAg\nICAgICAgUHJpbWFyeUtleSBjb3B5ID0gYWRkUHJpbWFyeUtleShway5nZXRO\nYW1lKCkpOwogICAgICAgIGNvcHkuc2V0TG9naWNhbChway5pc0xvZ2ljYWwo\nKSk7CiAgICAgICAgQ29sdW1uW10gY29scyA9IHBrLmdldENvbHVtbnMoKTsK\nICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGNvbHMubGVuZ3RoOyBpKysp\nCiAgICAgICAgICAgIGNvcHkuYWRkQ29sdW1uKGdldENvbHVtbihjb2xzW2ld\nLmdldE5hbWUoKSkpOwogICAgICAgIHJldHVybiBjb3B5OwogICAgfQoKICAg\nIC8qKgogICAgICogUmV0dXJuIHRoZSBmb3JlaWduIGtleSB3aXRoIHRoZSBn\naXZlbiBuYW1lLiBJZiBtdWx0aXBsZSBmb3JlaWduIGtleXMKICAgICAqIGhh\ndmUgdGhlIG5hbWUsIHRoZSBmaXJzdCBtYXRjaCBpcyByZXR1cm5lZC4KICAg\nICAqLwogICAgcHVibGljIEZvcmVpZ25LZXkgZ2V0Rm9yZWlnbktleShTdHJp\nbmcgbmFtZSkgewogICAgICAgIEZvcmVpZ25LZXlbXSBma3MgPSBnZXRGb3Jl\naWduS2V5cygpOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgZmtzLmxl\nbmd0aDsgaSsrKQogICAgICAgICAgICBpZiAoU3RyaW5nVXRpbHMuZXF1YWxz\nSWdub3JlQ2FzZShuYW1lLCBma3NbaV0uZ2V0TmFtZSgpKSkKICAgICAgICAg\nICAgICAgIHJldHVybiBma3NbaV07CiAgICAgICAgcmV0dXJuIG51bGw7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm4gYWxsIGZvcmVpZ24ga2V5cyBm\nb3IgdGhlIHRhYmxlLgogICAgICovCiAgICBwdWJsaWMgRm9yZWlnbktleVtd\nIGdldEZvcmVpZ25LZXlzKCkgewogICAgICAgIGlmIChfZmtzID09IG51bGwp\nIHsKICAgICAgICAgICAgaWYgKF9ma0xpc3QgPT0gbnVsbCkKICAgICAgICAg\nICAgICAgIF9ma3MgPSBTY2hlbWFzLkVNUFRZX0ZPUkVJR05fS0VZUzsKICAg\nICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICBGb3JlaWduS2V5W10g\nZmtzID0gbmV3IEZvcmVpZ25LZXlbX2ZrTGlzdC5zaXplKCldOwogICAgICAg\nICAgICAgICAgSXRlcmF0b3IgaXRyID0gX2ZrTGlzdC5pdGVyYXRvcigpOwog\nICAgICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGl0ci5oYXNOZXh0KCk7\nIGkrKykgewogICAgICAgICAgICAgICAgICAgIGZrc1tpXSA9IChGb3JlaWdu\nS2V5KSBpdHIubmV4dCgpOwogICAgICAgICAgICAgICAgICAgIGZrc1tpXS5z\nZXRJbmRleChpKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAg\nIF9ma3MgPSBma3M7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAg\ncmV0dXJuIF9ma3M7CiAgICB9CgogICAgLyoqCiAgICAgKiBBZGQgYSBmb3Jl\naWduIGtleSB0byB0aGUgdGFibGUuCiAgICAgKi8KICAgIHB1YmxpYyBGb3Jl\naWduS2V5IGFkZEZvcmVpZ25LZXkoKSB7CiAgICAgICAgcmV0dXJuIGFkZEZv\ncmVpZ25LZXkobnVsbCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBBZGQgYSBm\nb3JlaWduIGtleSB0byB0aGUgdGFibGUuIER1cGxpY2F0ZSBrZXkgbmFtZXMg\nYXJlIG5vdCBhbGxvd2VkLgogICAgICovCiAgICBwdWJsaWMgRm9yZWlnbktl\neSBhZGRGb3JlaWduS2V5KFN0cmluZyBuYW1lKSB7CiAgICAgICAgU2NoZW1h\nIHNjaGVtYSA9IGdldFNjaGVtYSgpOwogICAgICAgIEZvcmVpZ25LZXkgZms7\nCiAgICAgICAgaWYgKHNjaGVtYSAhPSBudWxsICYmIHNjaGVtYS5nZXRTY2hl\nbWFHcm91cCgpICE9IG51bGwpIHsKICAgICAgICAgICAgc2NoZW1hLmdldFNj\naGVtYUdyb3VwKCkuYWRkTmFtZShuYW1lLCBmYWxzZSk7CiAgICAgICAgICAg\nIGZrID0gc2NoZW1hLmdldFNjaGVtYUdyb3VwKCkubmV3Rm9yZWlnbktleShu\nYW1lLCB0aGlzKTsKICAgICAgICB9IGVsc2UKICAgICAgICAgICAgZmsgPSBu\nZXcgRm9yZWlnbktleShuYW1lLCB0aGlzKTsKICAgICAgICBpZiAoX2ZrTGlz\ndCA9PSBudWxsKQogICAgICAgICAgICBfZmtMaXN0ID0gbmV3IEFycmF5TGlz\ndCgzKTsKICAgICAgICBfZmtMaXN0LmFkZChmayk7CiAgICAgICAgX2ZrcyA9\nIG51bGw7CiAgICAgICAgcmV0dXJuIGZrOwogICAgfQoKICAgIC8qKgogICAg\nICogUmVtb3ZlIHRoZSBnaXZlbiBmb3JlaWduIGtleSBmcm9tIHRoZSB0YWJs\nZS4KICAgICAqCiAgICAgKiBAcmV0dXJuIHRydWUgaWYgdGhlIGtleSB3YXMg\ncmVtb3ZlZCwgZmFsc2UgaWYgbm90IGluIHRoZSB0YWJsZQogICAgICovCiAg\nICBwdWJsaWMgYm9vbGVhbiByZW1vdmVGb3JlaWduS2V5KEZvcmVpZ25LZXkg\nZmspIHsKICAgICAgICBpZiAoZmsgPT0gbnVsbCB8fCBfZmtMaXN0ID09IG51\nbGwpCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCiAgICAgICAgaWYgKCFf\nZmtMaXN0LnJlbW92ZShmaykpCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsK\nCiAgICAgICAgU2NoZW1hIHNjaGVtYSA9IGdldFNjaGVtYSgpOwogICAgICAg\nIGlmIChzY2hlbWEgIT0gbnVsbCAmJiBzY2hlbWEuZ2V0U2NoZW1hR3JvdXAo\nKSAhPSBudWxsKQogICAgICAgICAgICBzY2hlbWEuZ2V0U2NoZW1hR3JvdXAo\nKS5yZW1vdmVOYW1lKGZrLmdldE5hbWUoKSk7CiAgICAgICAgX2ZrcyA9IG51\nbGw7CiAgICAgICAgZmsucmVtb3ZlKCk7CiAgICAgICAgcmV0dXJuIHRydWU7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBJbXBvcnQgYSBmb3JlaWduIGtleTsg\nY29sdW1uIG5hbWVzIG11c3QgbWF0Y2ggY29sdW1ucyBvZiB0aGlzIHRhYmxl\nLgogICAgICovCiAgICBwdWJsaWMgRm9yZWlnbktleSBpbXBvcnRGb3JlaWdu\nS2V5KEZvcmVpZ25LZXkgZmspIHsKICAgICAgICBpZiAoZmsgPT0gbnVsbCkK\nICAgICAgICAgICAgcmV0dXJuIG51bGw7CgogICAgICAgIEZvcmVpZ25LZXkg\nY29weSA9IGFkZEZvcmVpZ25LZXkoZmsuZ2V0TmFtZSgpKTsKICAgICAgICBj\nb3B5LnNldERlbGV0ZUFjdGlvbihmay5nZXREZWxldGVBY3Rpb24oKSk7Cgog\nICAgICAgIFNjaGVtYSBzY2hlbWEgPSBnZXRTY2hlbWEoKTsKICAgICAgICBp\nZiAoc2NoZW1hICE9IG51bGwgJiYgc2NoZW1hLmdldFNjaGVtYUdyb3VwKCkg\nIT0gbnVsbCkgewogICAgICAgICAgICBDb2x1bW5bXSBwa3MgPSBmay5nZXRQ\ncmltYXJ5S2V5Q29sdW1ucygpOwogICAgICAgICAgICBUYWJsZSBqb2luZWQg\nPSBudWxsOwogICAgICAgICAgICBpZiAocGtzLmxlbmd0aCA+IDApCiAgICAg\nICAgICAgICAgICBqb2luZWQgPSBzY2hlbWEuZ2V0U2NoZW1hR3JvdXAoKS5m\naW5kVGFibGUocGtzWzBdLmdldFRhYmxlKCkpOwoKICAgICAgICAgICAgQ29s\ndW1uW10gY29scyA9IGZrLmdldENvbHVtbnMoKTsKICAgICAgICAgICAgZm9y\nIChpbnQgaSA9IDA7IGkgPCBjb2xzLmxlbmd0aDsgaSsrKQogICAgICAgICAg\nICAgICAgY29weS5qb2luKGdldENvbHVtbihjb2xzW2ldLmdldE5hbWUoKSks\nCiAgICAgICAgICAgICAgICAgICAgam9pbmVkLmdldENvbHVtbihwa3NbaV0u\nZ2V0TmFtZSgpKSk7CgogICAgICAgICAgICBjb2xzID0gZmsuZ2V0Q29uc3Rh\nbnRDb2x1bW5zKCk7CiAgICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwg\nY29scy5sZW5ndGg7IGkrKykKICAgICAgICAgICAgICAgIGNvcHkuam9pbkNv\nbnN0YW50KGdldENvbHVtbihjb2xzW2ldLmdldE5hbWUoKSksCiAgICAgICAg\nICAgICAgICAgICAgZmsuZ2V0UHJpbWFyeUtleUNvbnN0YW50KGNvbHNbaV0p\nKTsKCiAgICAgICAgICAgIHBrcyA9IGZrLmdldENvbnN0YW50UHJpbWFyeUtl\neUNvbHVtbnMoKTsKICAgICAgICAgICAgaWYgKGpvaW5lZCA9PSBudWxsICYm\nIHBrcy5sZW5ndGggPiAwKQogICAgICAgICAgICAgICAgam9pbmVkID0gc2No\nZW1hLmdldFNjaGVtYUdyb3VwKCkuZmluZFRhYmxlKHBrc1swXS5nZXRUYWJs\nZSgpKTsKICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBwa3MubGVu\nZ3RoOyBpKyspCiAgICAgICAgICAgICAgICBjb3B5LmpvaW5Db25zdGFudChm\nay5nZXRDb25zdGFudChwa3NbaV0pLAogICAgICAgICAgICAgICAgICAgIGpv\naW5lZC5nZXRDb2x1bW4ocGtzW2ldLmdldE5hbWUoKSkpOwogICAgICAgIH0K\nICAgICAgICByZXR1cm4gY29weTsKICAgIH0KCiAgICAvKioKICAgICAqIFJl\ndHVybiB0aGUgdGFibGUncyBpbmRleGVzLgogICAgICovCiAgICBwdWJsaWMg\nSW5kZXhbXSBnZXRJbmRleGVzKCkgewogICAgICAgIGlmIChfaWR4cyA9PSBu\ndWxsIHx8IF9pZHhzLmxlbmd0aCA9PSAwKQogICAgICAgICAgICBfaWR4cyA9\nIChfaWR4TWFwID09IG51bGwpID8gU2NoZW1hcy5FTVBUWV9JTkRFWEVTIDog\nKEluZGV4W10pCiAgICAgICAgICAgICAgICBfaWR4TWFwLnZhbHVlcygpLnRv\nQXJyYXkobmV3IEluZGV4W19pZHhNYXAuc2l6ZSgpXSk7CiAgICAgICAgcmV0\ndXJuIF9pZHhzOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRoZSBp\nbmRleCB3aXRoIHRoZSBnaXZlbiBuYW1lLCBvciBudWxsIGlmIG5vbmUuCiAg\nICAgKi8KICAgIHB1YmxpYyBJbmRleCBnZXRJbmRleChTdHJpbmcgbmFtZSkg\newogICAgICAgIGlmIChuYW1lID09IG51bGwgfHwgX2lkeE1hcCA9PSBudWxs\nKQogICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICByZXR1cm4gKElu\nZGV4KSBfaWR4TWFwLmdldChuYW1lLnRvVXBwZXJDYXNlKCkpOwogICAgfQoK\nICAgIC8qKgogICAgICogQWRkIGFuIGluZGV4IHRvIHRoZSB0YWJsZS4KICAg\nICAqLwogICAgcHVibGljIEluZGV4IGFkZEluZGV4KFN0cmluZyBuYW1lKSB7\nCiAgICAgICAgU2NoZW1hIHNjaGVtYSA9IGdldFNjaGVtYSgpOwogICAgICAg\nIEluZGV4IGlkeDsKICAgICAgICBpZiAoc2NoZW1hICE9IG51bGwgJiYgc2No\nZW1hLmdldFNjaGVtYUdyb3VwKCkgIT0gbnVsbCkgewogICAgICAgICAgICBz\nY2hlbWEuZ2V0U2NoZW1hR3JvdXAoKS5hZGROYW1lKG5hbWUsIHRydWUpOwog\nICAgICAgICAgICBpZHggPSBzY2hlbWEuZ2V0U2NoZW1hR3JvdXAoKS5uZXdJ\nbmRleChuYW1lLCB0aGlzKTsKICAgICAgICB9IGVsc2UKICAgICAgICAgICAg\naWR4ID0gbmV3IEluZGV4KG5hbWUsIHRoaXMpOwogICAgICAgIGlmIChfaWR4\nTWFwID09IG51bGwpCiAgICAgICAgICAgIF9pZHhNYXAgPSBuZXcgVHJlZU1h\ncCgpOwogICAgICAgIF9pZHhNYXAucHV0KG5hbWUudG9VcHBlckNhc2UoKSwg\naWR4KTsKICAgICAgICBfaWR4cyA9IG51bGw7CiAgICAgICAgcmV0dXJuIGlk\neDsKICAgIH0KCiAgICAvKioKICAgICAqIFJlbW92ZSB0aGUgZ2l2ZW4gaW5k\nZXggZnJvbSB0aGUgdGFibGUuCiAgICAgKgogICAgICogQHJldHVybiB0cnVl\nIGlmIHRoZSBpbmRleCB3YXMgcmVtb3ZlZCwgZmFsc2UgaWYgbm90IGluIHRo\nZSB0YWJsZQogICAgICovCiAgICBwdWJsaWMgYm9vbGVhbiByZW1vdmVJbmRl\neChJbmRleCBpZHgpIHsKICAgICAgICBpZiAoaWR4ID09IG51bGwgfHwgX2lk\neE1hcCA9PSBudWxsKQogICAgICAgICAgICByZXR1cm4gZmFsc2U7CgogICAg\nICAgIEluZGV4IGN1ciA9IChJbmRleCkgX2lkeE1hcC5nZXQoaWR4LmdldE5h\nbWUoKS50b1VwcGVyQ2FzZSgpKTsKICAgICAgICBpZiAoIWlkeC5lcXVhbHMo\nY3VyKSkKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoKICAgICAgICBfaWR4\nTWFwLnJlbW92ZShpZHguZ2V0TmFtZSgpLnRvVXBwZXJDYXNlKCkpOwogICAg\nICAgIFNjaGVtYSBzY2hlbWEgPSBnZXRTY2hlbWEoKTsKICAgICAgICBpZiAo\nc2NoZW1hICE9IG51bGwgJiYgc2NoZW1hLmdldFNjaGVtYUdyb3VwKCkgIT0g\nbnVsbCkKICAgICAgICAgICAgc2NoZW1hLmdldFNjaGVtYUdyb3VwKCkucmVt\nb3ZlTmFtZShpZHguZ2V0TmFtZSgpKTsKICAgICAgICBpZHgucmVtb3ZlKCk7\nCiAgICAgICAgX2lkeHMgPSBudWxsOwogICAgICAgIHJldHVybiB0cnVlOwog\nICAgfQoKICAgIC8qKgogICAgICogSW1wb3J0IGFuIGluZGV4OyBjb2x1bW4g\nbmFtZXMgbXVzdCBtYXRjaCBjb2x1bW5zIG9mIHRoaXMgdGFibGUuCiAgICAg\nKi8KICAgIHB1YmxpYyBJbmRleCBpbXBvcnRJbmRleChJbmRleCBpZHgpIHsK\nICAgICAgICBpZiAoaWR4ID09IG51bGwpCiAgICAgICAgICAgIHJldHVybiBu\ndWxsOwoKICAgICAgICBJbmRleCBjb3B5ID0gYWRkSW5kZXgoaWR4LmdldE5h\nbWUoKSk7CiAgICAgICAgY29weS5zZXRVbmlxdWUoaWR4LmlzVW5pcXVlKCkp\nOwoKICAgICAgICBDb2x1bW5bXSBjb2xzID0gaWR4LmdldENvbHVtbnMoKTsK\nICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGNvbHMubGVuZ3RoOyBpKysp\nCiAgICAgICAgICAgIGNvcHkuYWRkQ29sdW1uKGdldENvbHVtbihjb2xzW2ld\nLmdldE5hbWUoKSkpOwogICAgICAgIHJldHVybiBjb3B5OwogICAgfQoKICAg\nIC8qKgogICAgICogUmV0dXJuIHRoZSB0YWJsZSdzIHVuaXF1ZSBjb25zdHJh\naW50cy4KICAgICAqLwogICAgcHVibGljIFVuaXF1ZVtdIGdldFVuaXF1ZXMo\nKSB7CiAgICAgICAgaWYgKF91bnFzID09IG51bGwpCiAgICAgICAgICAgIF91\nbnFzID0gKF91bnFMaXN0ID09IG51bGwpID8gU2NoZW1hcy5FTVBUWV9VTklR\nVUVTIDogKFVuaXF1ZVtdKQogICAgICAgICAgICAgICAgX3VucUxpc3QudG9B\ncnJheShuZXcgVW5pcXVlW191bnFMaXN0LnNpemUoKV0pOwogICAgICAgIHJl\ndHVybiBfdW5xczsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0aGUg\ndW5pcXVlIGNvbnN0cmFpbnQgd2l0aCB0aGUgZ2l2ZW4gbmFtZSwgb3IgbnVs\nbCBpZiBub25lLgogICAgICovCiAgICBwdWJsaWMgVW5pcXVlIGdldFVuaXF1\nZShTdHJpbmcgbmFtZSkgewogICAgICAgIFVuaXF1ZVtdIHVucXMgPSBnZXRV\nbmlxdWVzKCk7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCB1bnFzLmxl\nbmd0aDsgaSsrKQogICAgICAgICAgICBpZiAoU3RyaW5nVXRpbHMuZXF1YWxz\nSWdub3JlQ2FzZShuYW1lLCB1bnFzW2ldLmdldE5hbWUoKSkpCiAgICAgICAg\nICAgICAgICByZXR1cm4gdW5xc1tpXTsKICAgICAgICByZXR1cm4gbnVsbDsK\nICAgIH0KCiAgICAvKioKICAgICAqIEFkZCBhIHVuaXF1ZSBjb25zdHJhaW50\nIHRvIHRoZSB0YWJsZS4KICAgICAqLwogICAgcHVibGljIFVuaXF1ZSBhZGRV\nbmlxdWUoU3RyaW5nIG5hbWUpIHsKICAgICAgICBTY2hlbWEgc2NoZW1hID0g\nZ2V0U2NoZW1hKCk7CiAgICAgICAgVW5pcXVlIHVucTsKICAgICAgICBpZiAo\nc2NoZW1hICE9IG51bGwgJiYgc2NoZW1hLmdldFNjaGVtYUdyb3VwKCkgIT0g\nbnVsbCkgewogICAgICAgICAgICBzY2hlbWEuZ2V0U2NoZW1hR3JvdXAoKS5h\nZGROYW1lKG5hbWUsIGZhbHNlKTsKICAgICAgICAgICAgdW5xID0gc2NoZW1h\nLmdldFNjaGVtYUdyb3VwKCkubmV3VW5pcXVlKG5hbWUsIHRoaXMpOwogICAg\nICAgIH0gZWxzZQogICAgICAgICAgICB1bnEgPSBuZXcgVW5pcXVlKG5hbWUs\nIHRoaXMpOwogICAgICAgIGlmIChfdW5xTGlzdCA9PSBudWxsKQogICAgICAg\nICAgICBfdW5xTGlzdCA9IG5ldyBBcnJheUxpc3QoMyk7CiAgICAgICAgX3Vu\ncUxpc3QuYWRkKHVucSk7CiAgICAgICAgX3VucXMgPSBudWxsOwogICAgICAg\nIHJldHVybiB1bnE7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZW1vdmUgdGhl\nIGdpdmVuIHVuaXF1ZSBjb25zdHJhaW50IGZyb20gdGhlIHRhYmxlLgogICAg\nICoKICAgICAqIEByZXR1cm4gdHJ1ZSBpZiB0aGUgY29uc3RyYWludCB3YXMg\ncmVtb3ZlZCwgZmFsc2UgaWYgbm90IGluIHRoZSB0YWJsZQogICAgICovCiAg\nICBwdWJsaWMgYm9vbGVhbiByZW1vdmVVbmlxdWUoVW5pcXVlIHVucSkgewog\nICAgICAgIGlmICh1bnEgPT0gbnVsbCB8fCBfdW5xTGlzdCA9PSBudWxsKQog\nICAgICAgICAgICByZXR1cm4gZmFsc2U7CgogICAgICAgIGlmICghX3VucUxp\nc3QucmVtb3ZlKHVucSkpCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCiAg\nICAgICAgU2NoZW1hIHNjaGVtYSA9IGdldFNjaGVtYSgpOwogICAgICAgIGlm\nIChzY2hlbWEgIT0gbnVsbCAmJiBzY2hlbWEuZ2V0U2NoZW1hR3JvdXAoKSAh\nPSBudWxsKQogICAgICAgICAgICBzY2hlbWEuZ2V0U2NoZW1hR3JvdXAoKS5y\nZW1vdmVOYW1lKHVucS5nZXROYW1lKCkpOwogICAgICAgIF91bnFzID0gbnVs\nbDsKICAgICAgICB1bnEucmVtb3ZlKCk7CiAgICAgICAgcmV0dXJuIHRydWU7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBJbXBvcnQgYSBjb25zdHJhaW50OyBj\nb2x1bW4gbmFtZXMgbXVzdCBtYXRjaCBjb2x1bW5zIG9mIHRoaXMgdGFibGUu\nCiAgICAgKi8KICAgIHB1YmxpYyBVbmlxdWUgaW1wb3J0VW5pcXVlKFVuaXF1\nZSB1bnEpIHsKICAgICAgICBpZiAodW5xID09IG51bGwpCiAgICAgICAgICAg\nIHJldHVybiBudWxsOwoKICAgICAgICBVbmlxdWUgY29weSA9IGFkZFVuaXF1\nZSh1bnEuZ2V0TmFtZSgpKTsKICAgICAgICBjb3B5LnNldERlZmVycmVkKHVu\ncS5pc0RlZmVycmVkKCkpOwoKICAgICAgICBDb2x1bW5bXSBjb2xzID0gdW5x\nLmdldENvbHVtbnMoKTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGNv\nbHMubGVuZ3RoOyBpKyspCiAgICAgICAgICAgIGNvcHkuYWRkQ29sdW1uKGdl\ndENvbHVtbihjb2xzW2ldLmdldE5hbWUoKSkpOwogICAgICAgIHJldHVybiBj\nb3B5OwogICAgfQoKICAgIC8qKgogICAgICogQ2FsbGVkIGJ5IGNvbHVtbnMg\ndG8gZW5zdXJlIHRoYXQgYWxsIGNvbHVtbnMgYXJlIHByb3Blcmx5IGluZGV4\nZWQKICAgICAqIGJlZm9yZSByZXR1cm5pbmcgdGhhdCBpbmZvcm1hdGlvbiB0\nbyB0aGUgdXNlci4KICAgICAqLwogICAgdm9pZCBpbmRleENvbHVtbnMoKSB7\nCiAgICAgICAgZ2V0Q29sdW1ucygpOwogICAgfQoKICAgIC8qKgogICAgICog\nQ2FsbGVkIGJ5IGZvcmVpZ24ga2V5cyB0byBlbnN1cmUgdGhhdCBhbGwgZmtz\nIGFyZSBwcm9wZXJseSBpbmRleGVkCiAgICAgKiBiZWZvcmUgcmV0dXJuaW5n\nIHRoYXQgaW5mb3JtYXRpb24gdG8gdGhlIHVzZXIuCiAgICAgKi8KICAgIHZv\naWQgaW5kZXhGb3JlaWduS2V5cygpIHsKICAgICAgICBnZXRGb3JlaWduS2V5\ncygpOwogICAgfQoKICAgIC8qKgogICAgICogQ2FsbGVkIGJ5IGNvbHVtbnMg\nd2hlbiB0aGVpciBhdXRvIGluY3JlbWVudCBzdGF0dXMgY2hhbmdlcy4KICAg\nICAqLwogICAgdm9pZCBjaGFuZ2VBdXRvQXNzaWduZWQoQ29sdW1uIGNvbCkg\newogICAgICAgIF9hdXRvQXNzaWduID0gbnVsbDsKICAgIH0KCiAgICAvKioK\nICAgICAqIENhbGxlZCBieSBjb2x1bW5zIHdoZW4gdGhlaXIgcmVsYXRpb24g\naWQgc3RhdHVzIGNoYW5nZXMuCiAgICAgKi8KICAgIHZvaWQgY2hhbmdlUmVs\nYXRpb25JZChDb2x1bW4gY29sKSB7CiAgICAgICAgX3JlbHMgPSBudWxsOwog\nICAgfQoKICAgIHB1YmxpYyBpbnQgY29tcGFyZVRvKE9iamVjdCBvdGhlcikg\newogICAgICAgIFN0cmluZyBuYW1lID0gZ2V0RnVsbE5hbWUoKTsKICAgICAg\nICBTdHJpbmcgb3RoZXJOYW1lID0gKChUYWJsZSkgb3RoZXIpLmdldEZ1bGxO\nYW1lKCk7CiAgICAgICAgaWYgKG5hbWUgPT0gbnVsbCAmJiBvdGhlck5hbWUg\nPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIDA7CiAgICAgICAgaWYgKG5h\nbWUgPT0gbnVsbCkKICAgICAgICAgICAgcmV0dXJuIDE7CiAgICAgICAgaWYg\nKG90aGVyTmFtZSA9PSBudWxsKQogICAgICAgICAgICByZXR1cm4gLTE7CiAg\nICAgICAgcmV0dXJuIG5hbWUuY29tcGFyZVRvKG90aGVyTmFtZSk7CiAgICB9\nCgogICAgcHVibGljIFN0cmluZyB0b1N0cmluZygpIHsKICAgICAgICByZXR1\ncm4gZ2V0RnVsbE5hbWUoKTsKICAgIH0KCiAgICBwdWJsaWMgYm9vbGVhbiBo\nYXNDb21tZW50KCkgewogICAgICAgIHJldHVybiBfY29tbWVudCAhPSBudWxs\nICYmICFfY29tbWVudC5lcXVhbHNJZ25vcmVDYXNlKF9uYW1lKTsKICAgIH0K\nCiAgICBwdWJsaWMgU3RyaW5nIGdldENvbW1lbnQoKSB7CiAgICAgICAgcmV0\ndXJuIF9jb21tZW50OwogICAgfQoKICAgIHB1YmxpYyB2b2lkIHNldENvbW1l\nbnQoU3RyaW5nIGNvbW1lbnQpIHsKICAgICAgICBfY29tbWVudCA9IGNvbW1l\nbnQ7CiAgICB9Cn0K\n","encoding":"base64"}

