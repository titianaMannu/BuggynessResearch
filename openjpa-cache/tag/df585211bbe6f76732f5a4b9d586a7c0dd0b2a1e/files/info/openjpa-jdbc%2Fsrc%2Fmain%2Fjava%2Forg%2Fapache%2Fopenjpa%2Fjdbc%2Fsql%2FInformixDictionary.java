{"sha":"0a199612f4a9c052a40fb546696eb7aca32fe9a4","node_id":"MDQ6QmxvYjIwNjM2NDowYTE5OTYxMmY0YTljMDUyYTQwZmI1NDY2OTZlYjdhY2EzMmZlOWE0","size":10908,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/0a199612f4a9c052a40fb546696eb7aca32fe9a4","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zcWw7CgppbXBvcnQg\namF2YS5zcWwuQ29ubmVjdGlvbjsKaW1wb3J0IGphdmEuc3FsLkRhdGFiYXNl\nTWV0YURhdGE7CmltcG9ydCBqYXZhLnNxbC5QcmVwYXJlZFN0YXRlbWVudDsK\naW1wb3J0IGphdmEuc3FsLlJlc3VsdFNldDsKaW1wb3J0IGphdmEuc3FsLlNR\nTEV4Y2VwdGlvbjsKaW1wb3J0IGphdmEuc3FsLlN0YXRlbWVudDsKaW1wb3J0\nIGphdmEuc3FsLlR5cGVzOwppbXBvcnQgamF2YS51dGlsLkFycmF5czsKaW1w\nb3J0IGphdmEudXRpbC5Db2xsZWN0aW9uOwoKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS5qZGJjLmtlcm5lbC5leHBzLkZpbHRlclZhbHVlOwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1hLkNvbHVtbjsKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNjaGVtYS5Gb3JlaWduS2V5Owpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1hLkluZGV4Owpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1hLlByaW1hcnlL\nZXk7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hlbWEuVGFi\nbGU7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuTG9jYWxp\nemVyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51dGlsLlJlZmVy\nZW5jZUhhc2hTZXQ7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5V\nbnN1cHBvcnRlZEV4Y2VwdGlvbjsKCi8qKgogKiBEaWN0aW9uYXJ5IGZvciBJ\nbmZvcm1peCBkYXRhYmFzZS4gTm90YWJsZSBmZWF0dXJlczoKICogPHVsPgog\nKiA8bGk+SW5mb3JtaXggZG9lcyBub3QgYWxsb3cgcGVzc2ltaXN0aWMgbG9j\na2luZyBvbiBzY3JvbGxhYmxlIHJlc3VsdAogKiBzZXRzLjwvbGk+CiAqIDxs\naT5TRVQgTE9DSyBNT0RFIFRPIFdBSVQgTiBzdGF0ZW1lbnRzIGFyZSBpc3N1\nZWQgdG8gd2FpdCBvbiBsb2Nrcy4gU2VlCiAqIHtAbGluayAjbG9ja1dhaXRT\nZWNvbmRzfSBhbmQge0BsaW5rICNsb2NrTW9kZUVuYWJsZWR9LjwvbGk+CiAq\nIDxsaT5MT0NLIE1PREUgUk9XIGlzIHVzZWQgYnkgZGVmYXVsdCBmb3IgdGFi\nbGUgY3JlYXRpb24gdG8gYWxsb3cgdGhlCiAqIG1heGltdW0gY29uY3VycmVu\nY3kuPC9saT4KICogPC91bD4KICovCnB1YmxpYyBjbGFzcyBJbmZvcm1peERp\nY3Rpb25hcnkKICAgIGV4dGVuZHMgREJEaWN0aW9uYXJ5IHsKCiAgICAvKioK\nICAgICAqIElmIHRydWUsIHRoZW4gd2Ugd2lsbCBpc3N1ZSBhICJTRVQgTE9D\nSyBNT0RFIFRPIFdBSVQgTiIKICAgICAqIHN0YXRlbWVudCB3aGVuZXZlciB3\nZSBjcmVhdGUgYSB7QGxpbmsgQ29ubmVjdGlvbn0sIGluIG9yZGVyCiAgICAg\nKiBhbGxvdyB3YWl0aW5nIG9uIGxvY2tzLgogICAgICovCiAgICBwdWJsaWMg\nYm9vbGVhbiBsb2NrTW9kZUVuYWJsZWQgPSBmYWxzZTsKCiAgICAvKioKICAg\nICAqIElmIHtAbGluayAjbG9ja01vZGVFbmFibGVkfSBpcyA8Y29kZT50cnVl\nPC9jb2RlPiwgdGhlbiB0aGlzCiAgICAgKiBwYXJhbWV0ZXIgc3BlY2lmaWVz\nIHRoZSBudW1iZXIgb2Ygc2Vjb25kcyB3ZSB3aWxsIHdhaXQgdG8KICAgICAq\nIG9idGFpbiBhIGxvY2sgZm9yIGluc2VydHMgYW5kIHBlc3NpbWlzdGljIGxv\nY2tpbmcuCiAgICAgKi8KICAgIHB1YmxpYyBpbnQgbG9ja1dhaXRTZWNvbmRz\nID0gMzA7CgogICAgLyoqCiAgICAgKiBJbmZvcm1peCBKREJDIG1ldGFkYXRh\nIGZvciBhbGwga25vd24gZHJpdmVycyByZXR1cm5zIHdpdGggdGhlCiAgICAg\nKiB0YWJsZSBjYXRhbG9nIGFuZCB0aGUgdGFibGUgc2NoZW1hIG5hbWUgc3dh\ncHBlZC4gQSA8Y29kZT50cnVlPC9jb2RlPgogICAgICogdmFsdWUgZm9yIHRo\naXMgcHJvcGVydHkgaW5kaWNhdGVzIHRoYXQgdGhleSBzaG91bGQgYmUgcmV2\nZXJzZWQuCiAgICAgKi8KICAgIHB1YmxpYyBib29sZWFuIHN3YXBTY2hlbWFB\nbmRDYXRhbG9nID0gdHJ1ZTsKCiAgICAvLyB3ZWFrIHNldCBvZiBjb25uZWN0\naW9ucyB3ZSd2ZSBhbHJlYWR5IGV4ZWN1dGVkIGxvY2sgbW9kZSBzcWwgb24K\nICAgIHByaXZhdGUgZmluYWwgQ29sbGVjdGlvbiBfc2VlbkNvbm5lY3Rpb25z\nID0gbmV3IFJlZmVyZW5jZUhhc2hTZXQKICAgICAgICAoUmVmZXJlbmNlSGFz\naFNldC5XRUFLKTsKCiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBMb2NhbGl6\nZXIgX2xvYyA9IExvY2FsaXplci5mb3JQYWNrYWdlCiAgICAgICAgKEluZm9y\nbWl4RGljdGlvbmFyeS5jbGFzcyk7CgogICAgcHVibGljIEluZm9ybWl4RGlj\ndGlvbmFyeSgpIHsKICAgICAgICBwbGF0Zm9ybSA9ICJJbmZvcm1peCI7CiAg\nICAgICAgdmFsaWRhdGlvblNRTCA9ICJTRUxFQ1QgRklSU1QgMSBDVVJSRU5U\nIFRJTUVTVEFNUCAiCiAgICAgICAgICAgICsgIkZST00gaW5mb3JtaXguc3lz\ndGFibGVzIjsKCiAgICAgICAgc3VwcG9ydHNBdXRvQXNzaWduID0gdHJ1ZTsK\nICAgICAgICBhdXRvQXNzaWduVHlwZU5hbWUgPSAic2VyaWFsIjsKICAgICAg\nICBsYXN0R2VuZXJhdGVkS2V5UXVlcnkgPSAiU0VMRUNUIEZJUlNUIDEgREJJ\nTkZPKCdzcWxjYS5zcWxlcnJkMScpICIKICAgICAgICAgICAgKyAiRlJPTSBp\nbmZvcm1peC5zeXN0YWJsZXMiOwoKICAgICAgICAvLyBpbmZvcm1peCBhY3R1\nYWxseSBkb2VzIHN1cHBvcnQgZGVmZXJyZWQgY29uc3RyYWludHMsIGJ1dCBu\nb3QKICAgICAgICAvLyBpbiB0aGUgdGFibGUgZGVmaW5pdGlvbjsgZGVmZXJy\nZWQgY29uc3RyYWludHMgY2FuIGJlIGFjdGl2YXRlZCBieQogICAgICAgIC8v\nIGludm9raW5nICJzZXQgY29uc3RyYWludHMgYWxsIGRlZmVycmVkIiBvbiB0\naGUgY29ubmVjdGlvbiwgd2hpY2gKICAgICAgICAvLyB3ZSBkb24ndCBkbyB5\nZXQKICAgICAgICBzdXBwb3J0c0RlZmVycmVkQ29uc3RyYWludHMgPSBmYWxz\nZTsKICAgICAgICBjb25zdHJhaW50TmFtZU1vZGUgPSBDT05TX05BTUVfQUZU\nRVI7CgogICAgICAgIC8vIGluZm9ybWl4IHN1cHBvcnRzICJDTE9CIiB0eXBl\nLCBidXQgYW55IGF0dGVtcHQgdG8gaW5zZXJ0CiAgICAgICAgLy8gaW50byB0\naGVtIHJhaXNlczogImphdmEuc3FsLlNRTEV4Y2VwdGlvbjogQ2FuJ3QgY29u\ndmVydCBmcm9tbnVsbCIKICAgICAgICB1c2VHZXRTdHJpbmdGb3JDbG9icyA9\nIHRydWU7CiAgICAgICAgbG9uZ1ZhcmNoYXJUeXBlTmFtZSA9ICJURVhUIjsK\nICAgICAgICBjbG9iVHlwZU5hbWUgPSAiVEVYVCI7CiAgICAgICAgc21hbGxp\nbnRUeXBlTmFtZSA9ICJJTlQ4IjsKICAgICAgICB0aW55aW50VHlwZU5hbWUg\nPSAiSU5UOCI7CiAgICAgICAgZmxvYXRUeXBlTmFtZSA9ICJGTE9BVCI7CiAg\nICAgICAgYml0VHlwZU5hbWUgPSAiQk9PTEVBTiI7CiAgICAgICAgYmxvYlR5\ncGVOYW1lID0gIkJZVEUiOwogICAgICAgIGRvdWJsZVR5cGVOYW1lID0gIk5V\nTUVSSUMoMzIsMjApIjsKICAgICAgICBkYXRlVHlwZU5hbWUgPSAiREFURSI7\nCiAgICAgICAgdGltZVR5cGVOYW1lID0gIkRBVEVUSU1FIEhPVVIgVE8gU0VD\nT05EIjsKICAgICAgICB0aW1lc3RhbXBUeXBlTmFtZSA9ICJEQVRFVElNRSBZ\nRUFSIFRPIEZSQUNUSU9OKDMpIjsKICAgICAgICBkb3VibGVUeXBlTmFtZSA9\nICJOVU1FUklDKDMyLDIwKSI7CiAgICAgICAgZmxvYXRUeXBlTmFtZSA9ICJS\nRUFMIjsKICAgICAgICBiaWdpbnRUeXBlTmFtZSA9ICJOVU1FUklDKDMyLDAp\nIjsKICAgICAgICBkb3VibGVUeXBlTmFtZSA9ICJET1VCTEUgUFJFQ0lTSU9O\nIjsKICAgICAgICBmaXhlZFNpemVUeXBlTmFtZVNldC5hZGRBbGwoQXJyYXlz\nLmFzTGlzdChuZXcgU3RyaW5nW117CiAgICAgICAgICAgICJCWVRFIiwgIkRP\nVUJMRSBQUkVDSVNJT04iLCAiSU5URVJWQUwiLCAiU01BTExGTE9BVCIsICJU\nRVhUIiwKICAgICAgICAgICAgIklOVDgiLAogICAgICAgIH0pKTsKCiAgICAg\nICAgc3VwcG9ydHNRdWVyeVRpbWVvdXQgPSBmYWxzZTsKICAgICAgICBzdXBw\nb3J0c0xvY2tpbmdXaXRoRGlzdGluY3RDbGF1c2UgPSBmYWxzZTsKICAgICAg\nICBzdXBwb3J0c0xvY2tpbmdXaXRoTXVsdGlwbGVUYWJsZXMgPSBmYWxzZTsK\nICAgICAgICBzdXBwb3J0c0xvY2tpbmdXaXRoT3JkZXJDbGF1c2UgPSBmYWxz\nZTsKCiAgICAgICAgLy8gdGhlIGluZm9ybWl4IEpEQkMgZHJpdmVycyBoYXZl\nIHByb2JsZW1zIHdpdGggdXNpbmcgdGhlCiAgICAgICAgLy8gc2NoZW1hIG5h\nbWUgaW4gcmVmbGVjdGlvbiBvbiBjb2x1bW5zIGFuZCB0YWJsZXMKICAgICAg\nICBzdXBwb3J0c1NjaGVtYUZvckdldENvbHVtbnMgPSBmYWxzZTsKICAgICAg\nICBzdXBwb3J0c1NjaGVtYUZvckdldFRhYmxlcyA9IGZhbHNlOwoKICAgICAg\nICAvLyBJbmZvcm1peCBkb2Vzbid0IHN1cHBvcnQgYWxpYXNlcyBpbiBkZWxl\ndGVzIGlmIHRoZSB0YWJsZSBoYXMgYW4gaW5kZXgKICAgICAgICBhbGxvd3NB\nbGlhc0luQnVsa0NsYXVzZSA9IGZhbHNlOwogICAgICAgIAogICAgICAgIC8v\nIEluZm9ybWl4IGRvZXNuJ3QgdW5kZXJzdGFuZCAiWCBDUk9TUyBKT0lOIFki\nLCBidXQgaXQgZG9lcyB1bmRlcnN0YW5kCiAgICAgICAgLy8gdGhlIGVxdWl2\nYWxlbnQgIlggSk9JTiBZIE9OIDEgPSAxIgogICAgICAgIGNyb3NzSm9pbkNs\nYXVzZSA9ICJKT0lOIjsKICAgICAgICByZXF1aXJlc0NvbmRpdGlvbkZvckNy\nb3NzSm9pbiA9IHRydWU7CgogICAgICAgIGNvbmNhdGVuYXRlRnVuY3Rpb24g\nPSAiQ09OQ0FUKHswfSx7MX0pIjsKICAgICAgICBuZXh0U2VxdWVuY2VRdWVy\neSA9ICJTRUxFQ1QgezB9Lk5FWFRWQUwgRlJPTSBTWVNUQUJMRVMgV0hFUkUg\nVEFCSUQ9MSI7CiAgICAgICAgc3VwcG9ydHNDb3JyZWxhdGVkU3Vic2VsZWN0\nID0gZmFsc2U7CiAgICAgICAgc3dhcFNjaGVtYUFuZENhdGFsb2cgPSBmYWxz\nZTsKICAgICAgICAKICAgICAgICAvLyBJbmZvcm1peCBkb2VzIG5vdCBzdXBw\nb3J0IGZvcmVpZ24ga2V5IGRlbGV0ZSBhY3Rpb24gTlVMTCBvciBERUZBVUxU\nCiAgICAgICAgc3VwcG9ydHNOdWxsRGVsZXRlQWN0aW9uID0gZmFsc2U7CiAg\nICAgICAgc3VwcG9ydHNEZWZhdWx0RGVsZXRlQWN0aW9uID0gZmFsc2U7CiAg\nICAgICAgCiAgICAgICAgdHJpbVNjaGVtYU5hbWUgPSB0cnVlOwogICAgfQoK\nICAgIHB1YmxpYyB2b2lkIGNvbm5lY3RlZENvbmZpZ3VyYXRpb24oQ29ubmVj\ndGlvbiBjb25uKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAg\nICAgIHN1cGVyLmNvbm5lY3RlZENvbmZpZ3VyYXRpb24oY29ubik7CiAgICAg\nICAgaWYgKGRyaXZlclZlbmRvciA9PSBudWxsKSB7CiAgICAgICAgICAgIERh\ndGFiYXNlTWV0YURhdGEgbWV0YSA9IGNvbm4uZ2V0TWV0YURhdGEoKTsKICAg\nICAgICAgICAgaWYgKCJJbmZvcm1peCIuZXF1YWxzSWdub3JlQ2FzZShtZXRh\nLmdldERyaXZlck5hbWUoKSkpCiAgICAgICAgICAgICAgICBkcml2ZXJWZW5k\nb3IgPSBWRU5ET1JfREFUQURJUkVDVDsKICAgICAgICAgICAgZWxzZQogICAg\nICAgICAgICAgICAgZHJpdmVyVmVuZG9yID0gVkVORE9SX09USEVSOwogICAg\nICAgIH0KICAgICAgICBpZiAoaXNKREJDMykgewogICAgICAgICAgICBjb25u\nLnNldEhvbGRhYmlsaXR5KFJlc3VsdFNldC5IT0xEX0NVUlNPUlNfT1ZFUl9D\nT01NSVQpOwogICAgICAgICAgICBpZiAobG9nLmlzVHJhY2VFbmFibGVkKCkp\nCiAgICAgICAgICAgICAgICBsb2cudHJhY2UoX2xvYy5nZXQoImNvbm5lY3Rp\nb24tZGVmYXVsdHMiLCBuZXcgT2JqZWN0W117CiAgICAgICAgICAgICAgICAg\nICAgY29ubi5nZXRBdXRvQ29tbWl0KCksIGNvbm4uZ2V0SG9sZGFiaWxpdHko\nKSwKICAgICAgICAgICAgICAgICAgICBjb25uLmdldFRyYW5zYWN0aW9uSXNv\nbGF0aW9uKCl9KSk7CiAgICAgICAgfQogICAgfQoKICAgIHB1YmxpYyBDb2x1\nbW5bXSBnZXRDb2x1bW5zKERhdGFiYXNlTWV0YURhdGEgbWV0YSwgU3RyaW5n\nIGNhdGFsb2csCiAgICAgICAgU3RyaW5nIHNjaGVtYU5hbWUsIFN0cmluZyB0\nYWJsZU5hbWUsIFN0cmluZyBjb2x1bW5OYW1lLCBDb25uZWN0aW9uIGNvbm4p\nCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgQ29sdW1u\nW10gY29scyA9IHN1cGVyLmdldENvbHVtbnMobWV0YSwgY2F0YWxvZywgc2No\nZW1hTmFtZSwgdGFibGVOYW1lLAogICAgICAgICAgICBjb2x1bW5OYW1lLCBj\nb25uKTsKCiAgICAgICAgLy8gdHJlYXQgbG9ndmFyY2hhciBhcyBjbG9iCiAg\nICAgICAgZm9yIChpbnQgaSA9IDA7IGNvbHMgIT0gbnVsbCAmJiBpIDwgY29s\ncy5sZW5ndGg7IGkrKykKICAgICAgICAgICAgaWYgKGNvbHNbaV0uZ2V0VHlw\nZSgpID09IFR5cGVzLkxPTkdWQVJDSEFSKQogICAgICAgICAgICAgICAgY29s\nc1tpXS5zZXRUeXBlKFR5cGVzLkNMT0IpOwogICAgICAgIHJldHVybiBjb2xz\nOwogICAgfQoKICAgIHB1YmxpYyBDb2x1bW4gbmV3Q29sdW1uKFJlc3VsdFNl\ndCBjb2xNZXRhKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAg\nICAgIENvbHVtbiBjb2wgPSBzdXBlci5uZXdDb2x1bW4oY29sTWV0YSk7CiAg\nICAgICAgaWYgKHN3YXBTY2hlbWFBbmRDYXRhbG9nKQogICAgICAgICAgICBj\nb2wuc2V0U2NoZW1hTmFtZShjb2xNZXRhLmdldFN0cmluZygiVEFCTEVfQ0FU\nIikpOwogICAgICAgIHJldHVybiBjb2w7CiAgICB9CgogICAgcHVibGljIFBy\naW1hcnlLZXkgbmV3UHJpbWFyeUtleShSZXN1bHRTZXQgcGtNZXRhKQogICAg\nICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIFByaW1hcnlLZXkg\ncGsgPSBzdXBlci5uZXdQcmltYXJ5S2V5KHBrTWV0YSk7CiAgICAgICAgaWYg\nKHN3YXBTY2hlbWFBbmRDYXRhbG9nKQogICAgICAgICAgICBway5zZXRTY2hl\nbWFOYW1lKHBrTWV0YS5nZXRTdHJpbmcoIlRBQkxFX0NBVCIpKTsKICAgICAg\nICByZXR1cm4gcGs7CiAgICB9CgogICAgcHVibGljIEluZGV4IG5ld0luZGV4\nKFJlc3VsdFNldCBpZHhNZXRhKQogICAgICAgIHRocm93cyBTUUxFeGNlcHRp\nb24gewogICAgICAgIEluZGV4IGlkeCA9IHN1cGVyLm5ld0luZGV4KGlkeE1l\ndGEpOwogICAgICAgIGlmIChzd2FwU2NoZW1hQW5kQ2F0YWxvZykKICAgICAg\nICAgICAgaWR4LnNldFNjaGVtYU5hbWUoaWR4TWV0YS5nZXRTdHJpbmcoIlRB\nQkxFX0NBVCIpKTsKICAgICAgICByZXR1cm4gaWR4OwogICAgfQoKICAgIHB1\nYmxpYyB2b2lkIHNldEJvb2xlYW4oUHJlcGFyZWRTdGF0ZW1lbnQgc3RtbnQs\nIGludCBpZHgsIGJvb2xlYW4gdmFsLAogICAgICAgIENvbHVtbiBjb2wpCiAg\nICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgLy8gaW5mb3Jt\naXggYWN0dWFsbHkgcmVxdWlyZXMgdGhhdCBhIGJvb2xlYW4gYmUgc2V0OiBp\ndCBjYW5ub3QKICAgICAgICAvLyBoYW5kbGUgYSBudW1lcmljIGFyZ3VtZW50\nCiAgICAgICAgc3RtbnQuc2V0U3RyaW5nKGlkeCwgdmFsID8gInQiIDogImYi\nKTsKICAgIH0KCiAgICBwdWJsaWMgU3RyaW5nW10gZ2V0Q3JlYXRlVGFibGVT\nUUwoVGFibGUgdGFibGUpIHsKICAgICAgICBTdHJpbmdbXSBjcmVhdGUgPSBz\ndXBlci5nZXRDcmVhdGVUYWJsZVNRTCh0YWJsZSk7CiAgICAgICAgY3JlYXRl\nWzBdID0gY3JlYXRlWzBdICsgIiBMT0NLIE1PREUgUk9XIjsKICAgICAgICBy\nZXR1cm4gY3JlYXRlOwogICAgfQoKICAgIHB1YmxpYyBTdHJpbmdbXSBnZXRB\nZGRQcmltYXJ5S2V5U1FMKFByaW1hcnlLZXkgcGspIHsKICAgICAgICBTdHJp\nbmcgcGtzcWwgPSBnZXRQcmltYXJ5S2V5Q29uc3RyYWludFNRTChwayk7CiAg\nICAgICAgaWYgKHBrc3FsID09IG51bGwpCiAgICAgICAgICAgIHJldHVybiBu\nZXcgU3RyaW5nWzBdOwogICAgICAgIHJldHVybiBuZXcgU3RyaW5nW117ICJB\nTFRFUiBUQUJMRSAiCiAgICAgICAgICAgICsgZ2V0RnVsbE5hbWUocGsuZ2V0\nVGFibGUoKSwgZmFsc2UpICsgIiBBREQgQ09OU1RSQUlOVCAiICsgcGtzcWwg\nfTsKICAgIH0KCiAgICBwdWJsaWMgU3RyaW5nW10gZ2V0QWRkRm9yZWlnbktl\neVNRTChGb3JlaWduS2V5IGZrKSB7CiAgICAgICAgU3RyaW5nIGZrc3FsID0g\nZ2V0Rm9yZWlnbktleUNvbnN0cmFpbnRTUUwoZmspOwogICAgICAgIGlmIChm\na3NxbCA9PSBudWxsKQogICAgICAgICAgICByZXR1cm4gbmV3IFN0cmluZ1sw\nXTsKICAgICAgICByZXR1cm4gbmV3IFN0cmluZ1tdeyAiQUxURVIgVEFCTEUg\nIgogICAgICAgICAgICArIGdldEZ1bGxOYW1lKGZrLmdldFRhYmxlKCksIGZh\nbHNlKSArICIgQUREIENPTlNUUkFJTlQgIiArIGZrc3FsIH07CiAgICB9Cgog\nICAgcHVibGljIGJvb2xlYW4gc3VwcG9ydHNSYW5kb21BY2Nlc3NSZXN1bHRT\nZXQoU2VsZWN0IHNlbCwKICAgICAgICBib29sZWFuIGZvclVwZGF0ZSkgewog\nICAgICAgIHJldHVybiAhZm9yVXBkYXRlICYmICFzZWwuaXNMb2IoKQogICAg\nICAgICAgICAmJiBzdXBlci5zdXBwb3J0c1JhbmRvbUFjY2Vzc1Jlc3VsdFNl\ndChzZWwsIGZvclVwZGF0ZSk7CiAgICB9CgogICAgcHVibGljIENvbm5lY3Rp\nb24gZGVjb3JhdGUoQ29ubmVjdGlvbiBjb25uKQogICAgICAgIHRocm93cyBT\nUUxFeGNlcHRpb24gewogICAgICAgIGNvbm4gPSBzdXBlci5kZWNvcmF0ZShj\nb25uKTsKCiAgICAgICAgLy8gaWYgd2UgaGF2ZW4ndCBhbHJlYWR5IGRvbmUg\nc28sIGluaXRpYWxpemUgdGhlIGxvY2sgbW9kZSBvZiB0aGUKICAgICAgICAv\nLyBjb25uZWN0aW9uCiAgICAgICAgaWYgKGxvY2tNb2RlRW5hYmxlZCAmJiBf\nc2VlbkNvbm5lY3Rpb25zLmFkZChjb25uKSkgewogICAgICAgICAgICBTdHJp\nbmcgc3FsID0gIlNFVCBMT0NLIE1PREUgVE8gV0FJVCI7CiAgICAgICAgICAg\nIGlmIChsb2NrV2FpdFNlY29uZHMgPiAwKQogICAgICAgICAgICAgICAgc3Fs\nID0gc3FsICsgIiAiICsgbG9ja1dhaXRTZWNvbmRzOwoKICAgICAgICAgICAg\nU3RhdGVtZW50IHN0bW50ID0gbnVsbDsKICAgICAgICAgICAgdHJ5IHsKICAg\nICAgICAgICAgICAgIHN0bW50ID0gY29ubi5jcmVhdGVTdGF0ZW1lbnQoKTsK\nICAgICAgICAgICAgICAgIHN0bW50LmV4ZWN1dGVVcGRhdGUoc3FsKTsKICAg\nICAgICAgICAgfSBjYXRjaCAoU1FMRXhjZXB0aW9uIHNlKSB7CiAgICAgICAg\nICAgICAgICB0aHJvdyBTUUxFeGNlcHRpb25zLmdldFN0b3JlKHNlLCB0aGlz\nKTsKICAgICAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgICAgIGlm\nIChzdG1udCAhPSBudWxsKQogICAgICAgICAgICAgICAgICAgIHRyeSB7CiAg\nICAgICAgICAgICAgICAgICAgICAgIHN0bW50LmNsb3NlKCk7CiAgICAgICAg\nICAgICAgICAgICAgfSBjYXRjaCAoU1FMRXhjZXB0aW9uIHNlKSB7CiAgICAg\nICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQoKICAg\nICAgICAvLyB0aGUgZGF0YWRpcmVjdCBkcml2ZXIgcmVxdWlyZXMgdGhhdCB3\nZSBpc3N1ZSBhIHJvbGxiYWNrIGJlZm9yZSB1c2luZwogICAgICAgIC8vIGVh\nY2ggY29ubmVjdGlvbgogICAgICAgIGlmIChWRU5ET1JfREFUQURJUkVDVC5l\ncXVhbHNJZ25vcmVDYXNlKGRyaXZlclZlbmRvcikpCiAgICAgICAgICAgIHRy\neSB7CiAgICAgICAgICAgICAgICBjb25uLnJvbGxiYWNrKCk7CiAgICAgICAg\nICAgIH0gY2F0Y2ggKFNRTEV4Y2VwdGlvbiBzZSkgewogICAgICAgICAgICB9\nCiAgICAgICAgcmV0dXJuIGNvbm47CiAgICB9CgogICAgcHVibGljIHZvaWQg\naW5kZXhPZihTUUxCdWZmZXIgYnVmLCBGaWx0ZXJWYWx1ZSBzdHIsIEZpbHRl\nclZhbHVlIGZpbmQsCiAgICAgICAgRmlsdGVyVmFsdWUgc3RhcnQpIHsKICAg\nICAgICB0aHJvdyBuZXcgVW5zdXBwb3J0ZWRFeGNlcHRpb24oX2xvYy5nZXQo\nImZ1bmN0aW9uLW5vdC1zdXBwb3J0ZWQiLAogICAgICAgICAgICAgICAgZ2V0\nQ2xhc3MoKSwgIkxPQ0FURSIpKTsKICAgIH0KCiAgICBwdWJsaWMgYm9vbGVh\nbiBuZWVkc1RvQ3JlYXRlSW5kZXgoSW5kZXggaWR4LCBUYWJsZSB0YWJsZSkg\newogICAgICAgLy8gSW5mb3JtaXggd2lsbCBhdXRvbWF0aWNhbGx5IGNyZWF0\nZSBhIHVuaXF1ZSBpbmRleCBmb3IgdGhlIAogICAgICAgLy8gcHJpbWFyeSBr\nZXksIHNvIGRvbid0IGNyZWF0ZSBhbm90aGVyIGluZGV4IGFnYWluCiAgICAg\nICBQcmltYXJ5S2V5IHBrID0gdGFibGUuZ2V0UHJpbWFyeUtleSgpOwogICAg\nICAgaWYgKHBrICE9IG51bGwgJiYgaWR4LmNvbHVtbnNNYXRjaChway5nZXRD\nb2x1bW5zKCkpKQogICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgIHJl\ndHVybiB0cnVlOwogICAgfQp9\n","encoding":"base64"}

