{"sha":"d3e98abb404827ddd18aa74ba177195e3aee6d20","node_id":"MDQ6QmxvYjIwNjM2NDpkM2U5OGFiYjQwNDgyN2RkZDE4YWE3NGJhMTc3MTk1ZTNhZWU2ZDIw","size":9494,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/d3e98abb404827ddd18aa74ba177195e3aee6d20","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zcWw7CgppbXBvcnQg\namF2YS5zcWwuQ29ubmVjdGlvbjsKaW1wb3J0IGphdmEuc3FsLkRhdGFiYXNl\nTWV0YURhdGE7CmltcG9ydCBqYXZhLnNxbC5SZXN1bHRTZXQ7CmltcG9ydCBq\nYXZhLnNxbC5TUUxFeGNlcHRpb247CmltcG9ydCBqYXZhLnNxbC5UeXBlczsK\naW1wb3J0IGphdmEudXRpbC5BcnJheXM7CgppbXBvcnQgb3JnLmFwYWNoZS5j\nb21tb25zLmxhbmcuU3RyaW5nVXRpbHM7CmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEuamRiYy5rZXJuZWwuSkRCQ1N0b3JlOwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLmpkYmMuc2NoZW1hLkNvbHVtbjsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5qZGJjLnNjaGVtYS5Gb3JlaWduS2V5OwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1hLkluZGV4OwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1hLlByaW1hcnlLZXk7CmltcG9y\ndCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hlbWEuVGFibGU7CgovKioK\nICogRGljdGlvbmFyeSBmb3IgTXlTUUwuCiAqLwpwdWJsaWMgY2xhc3MgTXlT\nUUxEaWN0aW9uYXJ5CiAgICBleHRlbmRzIERCRGljdGlvbmFyeSB7CgogICAg\nLyoqCiAgICAgKiBUaGUgTXlTUUwgdGFibGUgdHlwZSB0byB1c2Ugd2hlbiBj\ncmVhdGluZyB0YWJsZXM7IGRlZmF1bHRzIHRvIGlubm9kYi4KICAgICAqLwog\nICAgcHVibGljIFN0cmluZyB0YWJsZVR5cGUgPSAiaW5ub2RiIjsKCiAgICAv\nKioKICAgICAqIFdoZXRoZXIgdG8gdXNlIGNsb2JzLiBTb21lIG9sZGVyIHZl\ncnNpb25zIG9mIE15U1FMIGRvIG5vdCBoYW5kbGUKICAgICAqIGNsb2JzIHBy\nb3Blcmx5IHNvIHdlIGRlZmF1bHQgdG8gZmFsc2UgaGVyZS4KICAgICAqLwog\nICAgcHVibGljIGJvb2xlYW4gdXNlQ2xvYnMgPSB0cnVlOwoKICAgIC8qKgog\nICAgICogV2hldGhlciB0aGUgZHJpdmVyIGF1dG9tYXRpY2FsbHkgZGVzZXJp\nYWxpemVzIGJsb2JzLgogICAgICovCiAgICBwdWJsaWMgYm9vbGVhbiBkcml2\nZXJEZXNlcmlhbGl6ZXNCbG9icyA9IGZhbHNlOwoKICAgIC8qKgogICAgICog\nV2hldGhlciB0byBpbmxpbmUgbXVsdGktdGFibGUgYnVsay1kZWxldGUgb3Bl\ncmF0aW9ucyBpbnRvIE15U1FMJ3MgCiAgICAgKiBjb21iaW5lZCA8Y29kZT5E\nRUxFVEUgRlJPTSBmb28sIGJhciwgYmF6PC9jb2RlPiBzeW50YXguIAogICAg\nICogRGVmYXVsdHMgdG8gZmFsc2UsIHNpbmNlIHRoaXMgbWF5IGZhaWwgaW4g\ndGhlIHByZXNlbmNlIG9mIElubm9EQiB0YWJsZXMKICAgICAqIHdpdGggZm9y\nZWlnbiBrZXlzLgogICAgICogQHNlZSBodHRwOi8vZGV2Lm15c3FsLmNvbS9k\nb2MvcmVmbWFuLzUuMC9lbi9kZWxldGUuaHRtbAogICAgICovCiAgICBwdWJs\naWMgYm9vbGVhbiBvcHRpbWl6ZU11bHRpVGFibGVEZWxldGVzID0gZmFsc2U7\nCgogICAgcHVibGljIE15U1FMRGljdGlvbmFyeSgpIHsKICAgICAgICBwbGF0\nZm9ybSA9ICJNeVNRTCI7CiAgICAgICAgdmFsaWRhdGlvblNRTCA9ICJTRUxF\nQ1QgTk9XKCkiOwogICAgICAgIGRpc3RpbmN0Q291bnRDb2x1bW5TZXBhcmF0\nb3IgPSAiLCI7CgogICAgICAgIHN1cHBvcnRzRGVmZXJyZWRDb25zdHJhaW50\ncyA9IGZhbHNlOwogICAgICAgIGNvbnN0cmFpbnROYW1lTW9kZSA9IENPTlNf\nTkFNRV9NSUQ7CiAgICAgICAgc3VwcG9ydHNNdWx0aXBsZU5vbnRyYW5zYWN0\naW9uYWxSZXN1bHRTZXRzID0gZmFsc2U7CiAgICAgICAgcmVxdWlyZXNBbGlh\nc0ZvclN1YnNlbGVjdCA9IHRydWU7IC8vIG5ldyB2ZXJzaW9ucwogICAgICAg\nIHJlcXVpcmVzVGFyZ2V0Rm9yRGVsZXRlID0gdHJ1ZTsKICAgICAgICBzdXBw\nb3J0c1NlbGVjdFN0YXJ0SW5kZXggPSB0cnVlOwogICAgICAgIHN1cHBvcnRz\nU2VsZWN0RW5kSW5kZXggPSB0cnVlOwoKICAgICAgICBjb25jYXRlbmF0ZUZ1\nbmN0aW9uID0gIkNPTkNBVCh7MH0sezF9KSI7CgogICAgICAgIG1heFRhYmxl\nTmFtZUxlbmd0aCA9IDY0OwogICAgICAgIG1heENvbHVtbk5hbWVMZW5ndGgg\nPSA2NDsKICAgICAgICBtYXhJbmRleE5hbWVMZW5ndGggPSA2NDsKICAgICAg\nICBtYXhDb25zdHJhaW50TmFtZUxlbmd0aCA9IDY0OwogICAgICAgIG1heElu\nZGV4ZXNQZXJUYWJsZSA9IDMyOwogICAgICAgIHNjaGVtYUNhc2UgPSBTQ0hF\nTUFfQ0FTRV9QUkVTRVJWRTsKCiAgICAgICAgc3VwcG9ydHNBdXRvQXNzaWdu\nID0gdHJ1ZTsKICAgICAgICBsYXN0R2VuZXJhdGVkS2V5UXVlcnkgPSAiU0VM\nRUNUIExBU1RfSU5TRVJUX0lEKCkiOwogICAgICAgIGF1dG9Bc3NpZ25DbGF1\nc2UgPSAiQVVUT19JTkNSRU1FTlQiOwoKICAgICAgICBjbG9iVHlwZU5hbWUg\nPSAiVEVYVCI7CiAgICAgICAgbG9uZ1ZhcmNoYXJUeXBlTmFtZSA9ICJURVhU\nIjsKICAgICAgICBsb25nVmFyYmluYXJ5VHlwZU5hbWUgPSAiTE9ORyBWQVJC\nSU5BUlkiOwogICAgICAgIHRpbWVzdGFtcFR5cGVOYW1lID0gIkRBVEVUSU1F\nIjsKICAgICAgICBmaXhlZFNpemVUeXBlTmFtZVNldC5hZGRBbGwoQXJyYXlz\nLmFzTGlzdChuZXcgU3RyaW5nW117CiAgICAgICAgICAgICJCT09MIiwgIkxP\nTkcgVkFSQklOQVJZIiwgIk1FRElVTUJMT0IiLCAiTE9OR0JMT0IiLAogICAg\nICAgICAgICAiVElOWUJMT0IiLCAiTE9ORyBWQVJDSEFSIiwgIk1FRElVTVRF\nWFQiLCAiTE9OR1RFWFQiLCAiVEVYVCIsCiAgICAgICAgICAgICJUSU5ZVEVY\nVCIsICJET1VCTEUgUFJFQ0lTSU9OIiwgIkVOVU0iLCAiU0VUIiwgIkRBVEVU\nSU1FIiwKICAgICAgICB9KSk7CiAgICAgICAgcmVzZXJ2ZWRXb3JkU2V0LmFk\nZEFsbChBcnJheXMuYXNMaXN0KG5ldyBTdHJpbmdbXXsKICAgICAgICAgICAg\nIklOVDEiLCAiSU5UMiIsICJJTlQ0IiwgIkZMT0FUMSIsICJGTE9BVDIiLCAi\nRkxPQVQ0IiwKICAgICAgICAgICAgIkFVVE9fSU5DUkVNRU5UIiwgIkJJTkFS\nWSIsICJCTE9CIiwgIkNIQU5HRSIsICJFTlVNIiwgIklORklMRSIsCiAgICAg\nICAgICAgICJMT0FEIiwgIk1FRElVTUlOVCIsICJPUFRJT04iLCAiT1VURklM\nRSIsICJSRVBMQUNFIiwKICAgICAgICAgICAgIlNFVCIsICJTVEFSVElORyIs\nICJURVhUIiwgIlVOU0lHTkVEIiwgIlpFUk9GSUxMIiwKICAgICAgICB9KSk7\nCgogICAgICAgIC8vIE15U1FMIHJlcXVpcmVzIGRvdWJsZS1lc2NhcGUgZm9y\nIHN0cmluZ3MKICAgICAgICBzZWFyY2hTdHJpbmdFc2NhcGUgPSAiXFxcXCI7\nCgogICAgICAgIHR5cGVNb2RpZmllclNldC5hZGRBbGwoQXJyYXlzLmFzTGlz\ndChuZXcgU3RyaW5nW10geyAiVU5TSUdORUQiLAogICAgICAgICAgICAiWkVS\nT0ZJTEwiIH0pKTsKICAgIH0KCiAgICBwdWJsaWMgdm9pZCBjb25uZWN0ZWRD\nb25maWd1cmF0aW9uKENvbm5lY3Rpb24gY29ubikgdGhyb3dzIFNRTEV4Y2Vw\ndGlvbiB7CiAgICAgICAgc3VwZXIuY29ubmVjdGVkQ29uZmlndXJhdGlvbihj\nb25uKTsKCiAgICAgICAgRGF0YWJhc2VNZXRhRGF0YSBtZXRhRGF0YSA9IGNv\nbm4uZ2V0TWV0YURhdGEoKTsKICAgICAgICAvLyBUaGUgcHJvZHVjdCB2ZXJz\naW9uIGxvb2tzIGxpa2UgNC4xLjMtbnQKICAgICAgICBTdHJpbmcgcHJvZHVj\ndFZlcnNpb24gPSBtZXRhRGF0YS5nZXREYXRhYmFzZVByb2R1Y3RWZXJzaW9u\nKCk7CiAgICAgICAgLy8gVGhlIGRyaXZlciB2ZXJzaW9uIGxvb2tzIGxpa2Ug\nbXlzcWwtY29ubmVjdG9yLWphdmEtMy4xLjExICguLi4pCiAgICAgICAgU3Ry\naW5nIGRyaXZlclZlcnNpb24gPSBtZXRhRGF0YS5nZXREcml2ZXJWZXJzaW9u\nKCk7CgogICAgICAgIHRyeSB7CiAgICAgICAgICAgIGludFtdIHZlcnNpb25z\nID0gZ2V0TWFqb3JNaW5vclZlcnNpb25zKHByb2R1Y3RWZXJzaW9uKTsKICAg\nICAgICAgICAgaW50IG1haiA9IHZlcnNpb25zWzBdOwogICAgICAgICAgICBp\nbnQgbWluID0gdmVyc2lvbnNbMV07CiAgICAgICAgICAgIGlmIChtYWogPCA0\nIHx8IChtYWogPT0gNCAmJiBtaW4gPCAxKSkgewogICAgICAgICAgICAgICAg\nc3VwcG9ydHNTdWJzZWxlY3QgPSBmYWxzZTsKICAgICAgICAgICAgICAgIGFs\nbG93c0FsaWFzSW5CdWxrQ2xhdXNlID0gZmFsc2U7CiAgICAgICAgICAgIH0K\nCiAgICAgICAgICAgIHZlcnNpb25zID0gZ2V0TWFqb3JNaW5vclZlcnNpb25z\nKGRyaXZlclZlcnNpb24pOwogICAgICAgICAgICBtYWogPSB2ZXJzaW9uc1sw\nXTsKICAgICAgICAgICAgaWYgKG1haiA8IDUpIHsKICAgICAgICAgICAgICAg\nIGRyaXZlckRlc2VyaWFsaXplc0Jsb2JzID0gdHJ1ZTsKICAgICAgICAgICAg\nfQogICAgICAgIH0gY2F0Y2ggKElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiBl\nKSB7CiAgICAgICAgICAgIC8vIHdlIGRvbid0IHVuZGVyc3RhbmQgdGhlIHZl\ncnNpb24gZm9ybWF0LgogICAgICAgICAgICAvLyBUaGF0IGlzIG9rLiBXZSBq\ndXN0IHRha2UgdGhlIGRlZmF1bHQgdmFsdWVzLgogICAgICAgIH0KICAgIH0K\nCiAgICBwcml2YXRlIHN0YXRpYyBpbnRbXSBnZXRNYWpvck1pbm9yVmVyc2lv\nbnMoU3RyaW5nIHZlcnNpb25TdHIpCiAgICAgICAgdGhyb3dzIElsbGVnYWxB\ncmd1bWVudEV4Y2VwdGlvbiB7CiAgICAgICAgaW50IGJlZ2luSW5kZXggPSAw\nOwogICAgICAgIGludCBlbmRJbmRleCA9IDA7CgogICAgICAgIHZlcnNpb25T\ndHIgPSB2ZXJzaW9uU3RyLnRyaW0oKTsKICAgICAgICBjaGFyW10gY2hhckFy\nciA9IHZlcnNpb25TdHIudG9DaGFyQXJyYXkoKTsKICAgICAgICBmb3IgKGlu\ndCBpID0gMDsgaSA8IGNoYXJBcnIubGVuZ3RoOyBpKyspIHsKICAgICAgICAg\nICAgaWYgKENoYXJhY3Rlci5pc0RpZ2l0KGNoYXJBcnJbaV0pKSB7CiAgICAg\nICAgICAgICAgICBiZWdpbkluZGV4ID0gaTsKICAgICAgICAgICAgICAgIGJy\nZWFrOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBmb3IgKGlu\ndCBpID0gYmVnaW5JbmRleCsxOyBpIDwgY2hhckFyci5sZW5ndGg7IGkrKykg\newogICAgICAgICAgICBpZiAoY2hhckFycltpXSAhPSAnLicgJiYgIUNoYXJh\nY3Rlci5pc0RpZ2l0KGNoYXJBcnJbaV0pKSB7CiAgICAgICAgICAgICAgICBl\nbmRJbmRleCA9IGk7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAg\nICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgKGVuZEluZGV4IDwgYmVnaW5J\nbmRleCkKICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4\nY2VwdGlvbigpOwoKICAgICAgICBTdHJpbmdbXSBhcnIgPSB2ZXJzaW9uU3Ry\nLnN1YnN0cmluZyhiZWdpbkluZGV4LCBlbmRJbmRleCkuc3BsaXQoIlxcLiIp\nOwogICAgICAgIGlmIChhcnIubGVuZ3RoIDwgMikKICAgICAgICAgICAgdGhy\nb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbigpOwoKICAgICAgICBp\nbnQgbWFqID0gSW50ZWdlci5wYXJzZUludChhcnJbMF0pOwogICAgICAgIGlu\ndCBtaW4gPSBJbnRlZ2VyLnBhcnNlSW50KGFyclsxXSk7CiAgICAgICAgcmV0\ndXJuIG5ldyBpbnRbXXttYWosIG1pbn07CiAgICB9CgogICAgcHVibGljIFN0\ncmluZ1tdIGdldENyZWF0ZVRhYmxlU1FMKFRhYmxlIHRhYmxlKSB7CiAgICAg\nICAgU3RyaW5nW10gc3FsID0gc3VwZXIuZ2V0Q3JlYXRlVGFibGVTUUwodGFi\nbGUpOwogICAgICAgIGlmICghU3RyaW5nVXRpbHMuaXNFbXB0eSh0YWJsZVR5\ncGUpKQogICAgICAgICAgICBzcWxbMF0gPSBzcWxbMF0gKyAiIFRZUEUgPSAi\nICsgdGFibGVUeXBlOwogICAgICAgIHJldHVybiBzcWw7CiAgICB9CgogICAg\ncHVibGljIFN0cmluZ1tdIGdldERyb3BJbmRleFNRTChJbmRleCBpbmRleCkg\newogICAgICAgIHJldHVybiBuZXcgU3RyaW5nW117ICJEUk9QIElOREVYICIg\nKyBnZXRGdWxsTmFtZShpbmRleCkgKyAiIE9OICIKICAgICAgICAgICAgKyBn\nZXRGdWxsTmFtZShpbmRleC5nZXRUYWJsZSgpLCBmYWxzZSkgfTsKICAgIH0K\nCiAgICBwdWJsaWMgU3RyaW5nW10gZ2V0QWRkUHJpbWFyeUtleVNRTChQcmlt\nYXJ5S2V5IHBrKSB7CiAgICAgICAgU3RyaW5nW10gc3FsID0gc3VwZXIuZ2V0\nQWRkUHJpbWFyeUtleVNRTChwayk7CgogICAgICAgIC8vIG15c3FsIHJlcXVp\ncmVzIHRoYXQgYSBjb2x1bW4gYmUgZGVjbGFyZWQgTk9UIE5VTEwgYmVmb3Jl\nCiAgICAgICAgLy8gaXQgY2FuIGJlIG1hZGUgYSBwcmltYXJ5IGtleS4KICAg\nICAgICBDb2x1bW5bXSBjb2xzID0gcGsuZ2V0Q29sdW1ucygpOwogICAgICAg\nIFN0cmluZ1tdIHJldCA9IG5ldyBTdHJpbmdbY29scy5sZW5ndGggKyBzcWwu\nbGVuZ3RoXTsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGNvbHMubGVu\nZ3RoOyBpKyspIHsKICAgICAgICAgICAgcmV0W2ldID0gIkFMVEVSIFRBQkxF\nICIgKyBnZXRGdWxsTmFtZShjb2xzW2ldLmdldFRhYmxlKCksIGZhbHNlKQog\nICAgICAgICAgICAgICAgKyAiIENIQU5HRSAiICsgY29sc1tpXS5nZXROYW1l\nKCkKICAgICAgICAgICAgICAgICsgIiAiICsgY29sc1tpXS5nZXROYW1lKCkg\nLy8gbmFtZSB0d2ljZQogICAgICAgICAgICAgICAgKyAiICIgKyBnZXRUeXBl\nTmFtZShjb2xzW2ldKSArICIgTk9UIE5VTEwiOwogICAgICAgIH0KCiAgICAg\nICAgU3lzdGVtLmFycmF5Y29weShzcWwsIDAsIHJldCwgY29scy5sZW5ndGgs\nIHNxbC5sZW5ndGgpOwogICAgICAgIHJldHVybiByZXQ7CiAgICB9CgogICAg\ncHJvdGVjdGVkIFN0cmluZyBnZXRGb3JlaWduS2V5Q29uc3RyYWludFNRTChG\nb3JlaWduS2V5IGZrKSB7CiAgICAgICAgLy8gbXlzcWwgZG9lcyBub3Qgc3Vw\ncG9ydCBjb21wb3NpdGUgZm9yZWlnbiBrZXlzCiAgICAgICAgaWYgKGZrLmdl\ndENvbHVtbnMoKS5sZW5ndGggPiAxKQogICAgICAgICAgICByZXR1cm4gbnVs\nbDsKICAgICAgICByZXR1cm4gc3VwZXIuZ2V0Rm9yZWlnbktleUNvbnN0cmFp\nbnRTUUwoZmspOwogICAgfQogICAgCiAgICBwdWJsaWMgU3RyaW5nW10gZ2V0\nRGVsZXRlVGFibGVDb250ZW50c1NRTChUYWJsZVtdIHRhYmxlcykgewogICAg\nICAgIC8vIG15c3FsID49IDQgc3VwcG9ydHMgbW9yZS1vcHRpbWFsIGRlbGV0\nZSBzeW50YXgKICAgICAgICBpZiAoIW9wdGltaXplTXVsdGlUYWJsZURlbGV0\nZXMpCiAgICAgICAgICAgIHJldHVybiBzdXBlci5nZXREZWxldGVUYWJsZUNv\nbnRlbnRzU1FMKHRhYmxlcyk7CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAg\nIFN0cmluZ0J1ZmZlciBidWYgPSBuZXcgU3RyaW5nQnVmZmVyKHRhYmxlcy5s\nZW5ndGggKiA4KTsKICAgICAgICAgICAgYnVmLmFwcGVuZCgiREVMRVRFIEZS\nT00gIik7CiAgICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgdGFibGVz\nLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgICBidWYuYXBwZW5kKHRh\nYmxlc1tpXS5nZXRGdWxsTmFtZSgpKTsKICAgICAgICAgICAgICAgIGlmIChp\nIDwgdGFibGVzLmxlbmd0aCAtIDEpCiAgICAgICAgICAgICAgICAgICAgYnVm\nLmFwcGVuZCgiLCAiKTsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1\ncm4gbmV3IFN0cmluZ1tdIHsgYnVmLnRvU3RyaW5nKCkgfTsKICAgICAgICB9\nCiAgICB9CgogICAgcHJvdGVjdGVkIHZvaWQgYXBwZW5kU2VsZWN0UmFuZ2Uo\nU1FMQnVmZmVyIGJ1ZiwgbG9uZyBzdGFydCwgbG9uZyBlbmQsCiAgICAgICAg\nYm9vbGVhbiBzdWJzZWxlY3QpIHsKICAgICAgICBidWYuYXBwZW5kKCIgTElN\nSVQgIikuYXBwZW5kVmFsdWUoc3RhcnQpLmFwcGVuZCgiLCAiKTsKICAgICAg\nICBpZiAoZW5kID09IExvbmcuTUFYX1ZBTFVFKQogICAgICAgICAgICBidWYu\nYXBwZW5kVmFsdWUoTG9uZy5NQVhfVkFMVUUpOwogICAgICAgIGVsc2UKICAg\nICAgICAgICAgYnVmLmFwcGVuZFZhbHVlKGVuZCAtIHN0YXJ0KTsKICAgIH0K\nCiAgICBwcm90ZWN0ZWQgQ29sdW1uIG5ld0NvbHVtbihSZXN1bHRTZXQgY29s\nTWV0YSkKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBD\nb2x1bW4gY29sID0gc3VwZXIubmV3Q29sdW1uKGNvbE1ldGEpOwogICAgICAg\nIGlmIChjb2wuaXNOb3ROdWxsKCkgJiYgIjAiLmVxdWFscyhjb2wuZ2V0RGVm\nYXVsdFN0cmluZygpKSkKICAgICAgICAgICAgY29sLnNldERlZmF1bHRTdHJp\nbmcobnVsbCk7CiAgICAgICAgcmV0dXJuIGNvbDsKICAgIH0KCiAgICBwdWJs\naWMgT2JqZWN0IGdldEJsb2JPYmplY3QoUmVzdWx0U2V0IHJzLCBpbnQgY29s\ndW1uLCBKREJDU3RvcmUgc3RvcmUpCiAgICAgICAgdGhyb3dzIFNRTEV4Y2Vw\ndGlvbiB7CiAgICAgICAgLy8gaWYgdGhlIHVzZXIgaGFzIHNldCBhIGdldC1i\nbG9iIHN0cmF0ZWd5IGV4cGxpY2l0bHkgb3IgdGhlIGRyaXZlcgogICAgICAg\nIC8vIGRvZXMgbm90IGF1dG9tYXRpY2FsbHkgZGVzZXJpYWxpemUsIGRlbGVn\nYXRlIHRvIHN1cGVyCiAgICAgICAgaWYgKHVzZUdldEJ5dGVzRm9yQmxvYnMg\nfHwgdXNlR2V0T2JqZWN0Rm9yQmxvYnMKICAgICAgICAgICAgfHwgIWRyaXZl\nckRlc2VyaWFsaXplc0Jsb2JzKQogICAgICAgICAgICByZXR1cm4gc3VwZXIu\nZ2V0QmxvYk9iamVjdChycywgY29sdW1uLCBzdG9yZSk7CgogICAgICAgIC8v\nIG1vc3QgbXlzcWwgZHJpdmVycyBkZXNlcmlhbGl6ZSBvbiBnZXRPYmplY3QK\nICAgICAgICByZXR1cm4gcnMuZ2V0T2JqZWN0KGNvbHVtbik7CiAgICB9Cgog\nICAgcHVibGljIGludCBnZXRQcmVmZXJyZWRUeXBlKGludCB0eXBlKSB7CiAg\nICAgICAgaWYgKHR5cGUgPT0gVHlwZXMuQ0xPQiAmJiAhdXNlQ2xvYnMpCiAg\nICAgICAgICAgIHJldHVybiBUeXBlcy5MT05HVkFSQ0hBUjsKICAgICAgICBy\nZXR1cm4gc3VwZXIuZ2V0UHJlZmVycmVkVHlwZSh0eXBlKTsKICAgIH0KfQo=\n","encoding":"base64"}

