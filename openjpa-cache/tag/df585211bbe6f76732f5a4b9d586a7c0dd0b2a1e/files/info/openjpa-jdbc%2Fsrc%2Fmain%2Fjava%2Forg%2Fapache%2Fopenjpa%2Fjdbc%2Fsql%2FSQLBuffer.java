{"sha":"4b5537afed6f6b72b16323c9f247b0b5a71d012e","node_id":"MDQ6QmxvYjIwNjM2NDo0YjU1MzdhZmVkNmY2YjcyYjE2MzIzYzlmMjQ3YjBiNWE3MWQwMTJl","size":21259,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/4b5537afed6f6b72b16323c9f247b0b5a71d012e","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zcWw7CgppbXBvcnQg\namF2YS5pby5TZXJpYWxpemFibGU7CmltcG9ydCBqYXZhLnNxbC5DYWxsYWJs\nZVN0YXRlbWVudDsKaW1wb3J0IGphdmEuc3FsLkNvbm5lY3Rpb247CmltcG9y\ndCBqYXZhLnNxbC5QcmVwYXJlZFN0YXRlbWVudDsKaW1wb3J0IGphdmEuc3Fs\nLlJlc3VsdFNldDsKaW1wb3J0IGphdmEuc3FsLlNRTEV4Y2VwdGlvbjsKaW1w\nb3J0IGphdmEudXRpbC5BcnJheUxpc3Q7CmltcG9ydCBqYXZhLnV0aWwuQ29s\nbGVjdGlvbnM7CmltcG9ydCBqYXZhLnV0aWwuSXRlcmF0b3I7CmltcG9ydCBq\nYXZhLnV0aWwuTGlzdDsKCmltcG9ydCBvcmcuYXBhY2hlLmNvbW1vbnMubGFu\nZy5PYmplY3RVdGlsczsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJj\nLmtlcm5lbC5KREJDRmV0Y2hDb25maWd1cmF0aW9uOwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLmpkYmMua2VybmVsLmV4cHMuVmFsOwppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1hLkNvbHVtbjsKaW1wb3J0IG9y\nZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNjaGVtYS5Gb3JlaWduS2V5OwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1hLlNlcXVlbmNlOwpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1hLlRhYmxlOwpp\nbXBvcnQgc2VycC51dGlsLk51bWJlcnM7CgovKioKICogQnVmZmVyIGZvciBT\nUUwgc3RhdGVtZW50cyB0aGF0IGNhbiBiZSB1c2VkIHRvIGNyZWF0ZQogKiBq\nYXZhLnNxbC5QcmVwYXJlZFN0YXRlbWVudHMuCiAqCiAqIEBhdXRob3IgTWFy\nYyBQcnVkJ2hvbW1lYXV4CiAqIEBhdXRob3IgQWJlIFdoaXRlCiAqIEBzaW5j\nZSAwLjIuNAogKi8KcHVibGljIGZpbmFsIGNsYXNzIFNRTEJ1ZmZlcgogICAg\naW1wbGVtZW50cyBTZXJpYWxpemFibGUsIENsb25lYWJsZSB7CgogICAgcHJp\ndmF0ZSBzdGF0aWMgZmluYWwgU3RyaW5nIFBBUkFNRVRFUl9UT0tFTiA9ICI/\nIjsKCiAgICBwcml2YXRlIGZpbmFsIERCRGljdGlvbmFyeSBfZGljdDsKICAg\nIHByaXZhdGUgZmluYWwgU3RyaW5nQnVmZmVyIF9zcWwgPSBuZXcgU3RyaW5n\nQnVmZmVyKCk7CiAgICBwcml2YXRlIExpc3QgX3N1YnNlbHMgPSBudWxsOwog\nICAgcHJpdmF0ZSBMaXN0IF9wYXJhbXMgPSBudWxsOwogICAgcHJpdmF0ZSBM\naXN0IF9jb2xzID0gbnVsbDsKICAgIHByaXZhdGUgTGlzdCBfbm9uRktQYXJh\nbXMgPSBudWxsOwoKICAgIC8qKgogICAgICogRGVmYXVsdCBjb25zdHJ1Y3Rv\nci4KICAgICAqLwogICAgcHVibGljIFNRTEJ1ZmZlcihEQkRpY3Rpb25hcnkg\nZGljdCkgewogICAgICAgIF9kaWN0ID0gZGljdDsKICAgIH0KCiAgICAvKioK\nICAgICAqIENvcHkgY29uc3RydWN0b3IuCiAgICAgKi8KICAgIHB1YmxpYyBT\nUUxCdWZmZXIoU1FMQnVmZmVyIGJ1ZikgewogICAgICAgIF9kaWN0ID0gYnVm\nLl9kaWN0OwogICAgICAgIGFwcGVuZChidWYpOwogICAgfQoKICAgIC8qKgog\nICAgICogUGVyZm9ybSBhIHNoYWxsb3cgY2xvbmUgb2YgdGhpcyBTUUwgQnVm\nZmVyLgogICAgICovCiAgICBwdWJsaWMgT2JqZWN0IGNsb25lKCkgewogICAg\nICAgIHJldHVybiBuZXcgU1FMQnVmZmVyKHRoaXMpOwogICAgfQoKICAgIC8q\nKgogICAgICogUmV0dXJuIHRydWUgaWYgdGhlIGJ1ZmZlciBpcyBlbXRweS4K\nICAgICAqLwogICAgcHVibGljIGJvb2xlYW4gaXNFbXB0eSgpIHsKICAgICAg\nICByZXR1cm4gX3NxbC5sZW5ndGgoKSA9PSAwOwogICAgfQoKICAgIC8qKgog\nICAgICogQXBwZW5kIGFsbCBTUUwgYW5kIHBhcmFtZXRlcnMgb2YgdGhlIGdp\ndmVuIGJ1ZmZlci4KICAgICAqLwogICAgcHVibGljIFNRTEJ1ZmZlciBhcHBl\nbmQoU1FMQnVmZmVyIGJ1ZikgewogICAgICAgIGFwcGVuZChidWYsIF9zcWwu\nbGVuZ3RoKCksIChfcGFyYW1zID09IG51bGwpID8gMCA6IF9wYXJhbXMuc2l6\nZSgpLAogICAgICAgICAgICB0cnVlKTsKICAgICAgICByZXR1cm4gdGhpczsK\nICAgIH0KCiAgICAvKioKICAgICAqIEFwcGVuZCBhbGwgU1FMIGFuZCBwYXJh\nbWV0ZXJzIG9mIHRoZSBnaXZlbiBidWZmZXIgYXQgdGhlIGdpdmVuIHBvc2l0\naW9ucy4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIGFwcGVuZChTUUxCdWZm\nZXIgYnVmLCBpbnQgc3FsSW5kZXgsIGludCBwYXJhbUluZGV4LAogICAgICAg\nIGJvb2xlYW4gc3Vic2VscykgewogICAgICAgIGlmIChzdWJzZWxzKSB7CiAg\nICAgICAgICAgIC8vIG9ubHkgYWxsb3cgYXBwZW5kaW5nIG9mIGJ1ZmZlcnMg\nd2l0aCBzdWJzZWxlY3RzLCBub3QgaW5zZXJ0aW9uCiAgICAgICAgICAgIGlm\nIChfc3Vic2VscyAhPSBudWxsICYmICFfc3Vic2Vscy5pc0VtcHR5KCkKICAg\nICAgICAgICAgICAgICYmIHNxbEluZGV4ICE9IF9zcWwubGVuZ3RoKCkpCiAg\nICAgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbFN0YXRlRXhjZXB0aW9u\nKCk7CiAgICAgICAgICAgIGlmIChidWYuX3N1YnNlbHMgIT0gbnVsbCAmJiAh\nYnVmLl9zdWJzZWxzLmlzRW1wdHkoKSkgewogICAgICAgICAgICAgICAgaWYg\nKHNxbEluZGV4ICE9IF9zcWwubGVuZ3RoKCkpCiAgICAgICAgICAgICAgICAg\nICAgdGhyb3cgbmV3IElsbGVnYWxTdGF0ZUV4Y2VwdGlvbigpOwogICAgICAg\nICAgICAgICAgaWYgKF9zdWJzZWxzID09IG51bGwpCiAgICAgICAgICAgICAg\nICAgICAgX3N1YnNlbHMgPSBuZXcgQXJyYXlMaXN0KGJ1Zi5fc3Vic2Vscy5z\naXplKCkpOwogICAgICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBi\ndWYuX3N1YnNlbHMuc2l6ZSgpOyBpKyspCiAgICAgICAgICAgICAgICAgICAg\nX3N1YnNlbHMuYWRkKCgoU3Vic2VsZWN0KSBidWYuX3N1YnNlbHMuZ2V0KGkp\nKS4KICAgICAgICAgICAgICAgICAgICAgICAgY2xvbmUoc3FsSW5kZXgsIHBh\ncmFtSW5kZXgpKTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAg\naWYgKHNxbEluZGV4ID09IF9zcWwubGVuZ3RoKCkpCiAgICAgICAgICAgIF9z\ncWwuYXBwZW5kKGJ1Zi5fc3FsLnRvU3RyaW5nKCkpOwogICAgICAgIGVsc2UK\nICAgICAgICAgICAgX3NxbC5pbnNlcnQoc3FsSW5kZXgsIGJ1Zi5fc3FsLnRv\nU3RyaW5nKCkpOwoKICAgICAgICBpZiAoYnVmLl9wYXJhbXMgIT0gbnVsbCkg\newogICAgICAgICAgICBpZiAoX3BhcmFtcyA9PSBudWxsKQogICAgICAgICAg\nICAgICAgX3BhcmFtcyA9IG5ldyBBcnJheUxpc3QoKTsKICAgICAgICAgICAg\naWYgKF9jb2xzID09IG51bGwgJiYgYnVmLl9jb2xzICE9IG51bGwpIHsKICAg\nICAgICAgICAgICAgIF9jb2xzID0gbmV3IEFycmF5TGlzdCgpOwogICAgICAg\nICAgICAgICAgd2hpbGUgKF9jb2xzLnNpemUoKSA8IF9wYXJhbXMuc2l6ZSgp\nKQogICAgICAgICAgICAgICAgICAgIF9jb2xzLmFkZChudWxsKTsKICAgICAg\nICAgICAgfQoKICAgICAgICAgICAgaWYgKHBhcmFtSW5kZXggPT0gX3BhcmFt\ncy5zaXplKCkpIHsKICAgICAgICAgICAgICAgIF9wYXJhbXMuYWRkQWxsKGJ1\nZi5fcGFyYW1zKTsKICAgICAgICAgICAgICAgIGlmIChidWYuX2NvbHMgIT0g\nbnVsbCkKICAgICAgICAgICAgICAgICAgICBfY29scy5hZGRBbGwoYnVmLl9j\nb2xzKTsKICAgICAgICAgICAgICAgIGVsc2UgaWYgKF9jb2xzICE9IG51bGwp\nCiAgICAgICAgICAgICAgICAgICAgd2hpbGUgKF9jb2xzLnNpemUoKSA8IF9w\nYXJhbXMuc2l6ZSgpKQogICAgICAgICAgICAgICAgICAgICAgICBfY29scy5h\nZGQobnVsbCk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAg\nICBfcGFyYW1zLmFkZEFsbChwYXJhbUluZGV4LCBidWYuX3BhcmFtcyk7CiAg\nICAgICAgICAgICAgICBpZiAoYnVmLl9jb2xzICE9IG51bGwpCiAgICAgICAg\nICAgICAgICAgICAgX2NvbHMuYWRkQWxsKHBhcmFtSW5kZXgsIGJ1Zi5fY29s\ncyk7CiAgICAgICAgICAgICAgICBlbHNlIGlmIChfY29scyAhPSBudWxsKQog\nICAgICAgICAgICAgICAgICAgIHdoaWxlIChfY29scy5zaXplKCkgPCBfcGFy\nYW1zLnNpemUoKSkKICAgICAgICAgICAgICAgICAgICAgICAgX2NvbHMuYWRk\nKHBhcmFtSW5kZXgsIG51bGwpOwogICAgICAgICAgICB9CiAgICAgICAgfQog\nICAgICAgIGlmIChidWYuX25vbkZLUGFyYW1zICE9IG51bGwpIHsKICAgICAg\nICAgICAgaWYgKF9ub25GS1BhcmFtcyA9PSBudWxsKQogICAgICAgICAgICAg\nICAgX25vbkZLUGFyYW1zID0gbmV3IEFycmF5TGlzdCgpOwogICAgICAgICAg\nICBfbm9uRktQYXJhbXMuYWRkQWxsKGJ1Zi5fbm9uRktQYXJhbXMpOwogICAg\nICAgIH0KICAgIH0KCiAgICBwdWJsaWMgU1FMQnVmZmVyIGFwcGVuZChUYWJs\nZSB0YWJsZSkgewogICAgICAgIF9zcWwuYXBwZW5kKF9kaWN0LmdldEZ1bGxO\nYW1lKHRhYmxlLCBmYWxzZSkpOwogICAgICAgIHJldHVybiB0aGlzOwogICAg\nfQoKICAgIHB1YmxpYyBTUUxCdWZmZXIgYXBwZW5kKFNlcXVlbmNlIHNlcSkg\newogICAgICAgIF9zcWwuYXBwZW5kKF9kaWN0LmdldEZ1bGxOYW1lKHNlcSkp\nOwogICAgICAgIHJldHVybiB0aGlzOwogICAgfQoKICAgIHB1YmxpYyBTUUxC\ndWZmZXIgYXBwZW5kKENvbHVtbiBjb2wpIHsKICAgICAgICBfc3FsLmFwcGVu\nZChjb2wuZ2V0TmFtZSgpKTsKICAgICAgICByZXR1cm4gdGhpczsKICAgIH0K\nCiAgICBwdWJsaWMgU1FMQnVmZmVyIGFwcGVuZChTdHJpbmcgcykgewogICAg\nICAgIF9zcWwuYXBwZW5kKHMpOwogICAgICAgIHJldHVybiB0aGlzOwogICAg\nfQoKICAgIC8qKgogICAgICogQXBwZW5kIGEgc3Vic2VsZWN0LiBUaGlzIGRl\nbGF5cyByZXNvbHV0aW9uIG9mIHRoZSBzZWxlY3QgU1FMLgogICAgICovCiAg\nICBwdWJsaWMgU1FMQnVmZmVyIGFwcGVuZChTZWxlY3Qgc2VsLCBKREJDRmV0\nY2hDb25maWd1cmF0aW9uIGZldGNoKSB7CiAgICAgICAgcmV0dXJuIGFwcGVu\nZChzZWwsIGZldGNoLCBmYWxzZSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBB\ncHBlbmQgYSBzdWJzZWxlY3QgY291bnQuIFRoaXMgZGVsYXlzIHJlc29sdXRp\nb24gb2YgdGhlIHNlbGVjdCBTUUwuCiAgICAgKi8KICAgIHB1YmxpYyBTUUxC\ndWZmZXIgYXBwZW5kQ291bnQoU2VsZWN0IHNlbCwgSkRCQ0ZldGNoQ29uZmln\ndXJhdGlvbiBmZXRjaCkgewogICAgICAgIHJldHVybiBhcHBlbmQoc2VsLCBm\nZXRjaCwgdHJ1ZSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBBcHBlbmQgYSBz\ndWJzZWxlY3QuIFRoaXMgZGVsYXlzIHJlc29sdXRpb24gb2YgdGhlIHNlbGVj\ndCBTUUwuCiAgICAgKi8KICAgIHByaXZhdGUgU1FMQnVmZmVyIGFwcGVuZChT\nZWxlY3Qgc2VsLCBKREJDRmV0Y2hDb25maWd1cmF0aW9uIGZldGNoLAogICAg\nICAgIGJvb2xlYW4gY291bnQpIHsKICAgICAgICBfc3FsLmFwcGVuZCgiKCIp\nOwogICAgICAgIFN1YnNlbGVjdCBzdWIgPSBuZXcgU3Vic2VsZWN0KCk7CiAg\nICAgICAgc3ViLnNlbGVjdCA9IHNlbDsKICAgICAgICBzdWIuZmV0Y2ggPSBm\nZXRjaDsKICAgICAgICBzdWIuY291bnQgPSBjb3VudDsKICAgICAgICBzdWIu\nc3FsSW5kZXggPSBfc3FsLmxlbmd0aCgpOwogICAgICAgIHN1Yi5wYXJhbUlu\nZGV4ID0gKF9wYXJhbXMgPT0gbnVsbCkgPyAwIDogX3BhcmFtcy5zaXplKCk7\nCiAgICAgICAgX3NxbC5hcHBlbmQoIikiKTsKCiAgICAgICAgaWYgKF9zdWJz\nZWxzID09IG51bGwpCiAgICAgICAgICAgIF9zdWJzZWxzID0gbmV3IEFycmF5\nTGlzdCgyKTsKICAgICAgICBfc3Vic2Vscy5hZGQoc3ViKTsKICAgICAgICBy\nZXR1cm4gdGhpczsKICAgIH0KCiAgICAvKioKICAgICAqIFJlcGxhY2UgYSBz\ndWJzZWxlY3QuCiAgICAgKi8KICAgIHB1YmxpYyBib29sZWFuIHJlcGxhY2Uo\nU2VsZWN0IG9sZCwgU2VsZWN0IHNlbCkgewogICAgICAgIGlmIChfc3Vic2Vs\ncyA9PSBudWxsKQogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAg\nU3Vic2VsZWN0IHN1YjsKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IF9z\ndWJzZWxzLnNpemUoKTsgaSsrKSB7CiAgICAgICAgICAgIHN1YiA9IChTdWJz\nZWxlY3QpIF9zdWJzZWxzLmdldChpKTsKICAgICAgICAgICAgaWYgKHN1Yi5z\nZWxlY3QgPT0gb2xkKSB7CiAgICAgICAgICAgICAgICBzdWIuc2VsZWN0ID0g\nc2VsOwogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAg\nIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAg\nIC8qKgogICAgICogQXBwZW5kIGEgcGFyYW1ldGVyIHZhbHVlLgogICAgICov\nCiAgICBwdWJsaWMgU1FMQnVmZmVyIGFwcGVuZFZhbHVlKE9iamVjdCBvKSB7\nCiAgICAgICAgcmV0dXJuIGFwcGVuZFZhbHVlKG8sIG51bGwpOwogICAgfQoK\nICAgIC8qKgogICAgICogQXBwZW5kIGEgcGFyYW1ldGVyIHZhbHVlIGZvciBh\nIHNwZWNpZmljIGNvbHVtbi4KICAgICAqLwogICAgcHVibGljIFNRTEJ1ZmZl\nciBhcHBlbmRWYWx1ZShPYmplY3QgbywgQ29sdW1uIGNvbCkgewogICAgICAg\nIGlmIChvID09IG51bGwpCiAgICAgICAgICAgIF9zcWwuYXBwZW5kKCJOVUxM\nIik7CiAgICAgICAgZWxzZSBpZiAobyBpbnN0YW5jZW9mIFJhdykKICAgICAg\nICAgICAgX3NxbC5hcHBlbmQoby50b1N0cmluZygpKTsKICAgICAgICBlbHNl\nIHsKICAgICAgICAgICAgX3NxbC5hcHBlbmQoUEFSQU1FVEVSX1RPS0VOKTsK\nCiAgICAgICAgICAgIC8vIGluaXRpYWxpemUgcGFyYW0gYW5kIGNvbCBsaXN0\nczsgd2UgaG9sZCBvZmYgb24gY29sIGxpc3QgdW50aWwKICAgICAgICAgICAg\nLy8gd2UgZ2V0IHRoZSBmaXJzdCBub24tbnVsbCBjb2wKICAgICAgICAgICAg\naWYgKF9wYXJhbXMgPT0gbnVsbCkKICAgICAgICAgICAgICAgIF9wYXJhbXMg\nPSBuZXcgQXJyYXlMaXN0KCk7CiAgICAgICAgICAgIGlmIChjb2wgIT0gbnVs\nbCAmJiBfY29scyA9PSBudWxsKSB7CiAgICAgICAgICAgICAgICBfY29scyA9\nIG5ldyBBcnJheUxpc3QoKTsKICAgICAgICAgICAgICAgIHdoaWxlIChfY29s\ncy5zaXplKCkgPCBfcGFyYW1zLnNpemUoKSkKICAgICAgICAgICAgICAgICAg\nICBfY29scy5hZGQobnVsbCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAg\nIF9wYXJhbXMuYWRkKG8pOwogICAgICAgICAgICBpZiAoX2NvbHMgIT0gbnVs\nbCkKICAgICAgICAgICAgICAgIF9jb2xzLmFkZChjb2wpOwogICAgICAgICAg\nICBpZiAoY29sID09IG51bGwpCiAgICAgICAgICAgICAgICByZXR1cm4gdGhp\nczsKICAgICAgICAgICAgYm9vbGVhbiBpc0ZLID0gZmFsc2U7CiAgICAgICAg\nICAgIEZvcmVpZ25LZXlbXSBma3MgPSBjb2wuZ2V0VGFibGUoKS5nZXRGb3Jl\naWduS2V5cygpOwogICAgICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IGZr\ncy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgQ29sdW1uW10gY29s\ncyA9IGZrc1tpXS5nZXRDb2x1bW5zKCk7CiAgICAgICAgICAgICAgICBmb3Ig\nKGludCBqID0gMDsgaiA8IGNvbHMubGVuZ3RoOyBqKyspIHsKICAgICAgICAg\nICAgICAgICAgICBpZiAoY29sc1tqXSA9PSBjb2wpIHsKICAgICAgICAgICAg\nICAgICAgICAgICAgaXNGSyA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAg\nICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAg\nICAgIH0KICAgICAgICAgICAgICAgIGlmIChpc0ZLKQogICAgICAgICAgICAg\nICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmICgh\naXNGSykgewogICAgICAgICAgICAgICAgaWYgKF9ub25GS1BhcmFtcyA9PSBu\ndWxsKQogICAgICAgICAgICAgICAgICAgIF9ub25GS1BhcmFtcyA9IG5ldyBB\ncnJheUxpc3QoKTsKICAgICAgICAgICAgICAgIF9ub25GS1BhcmFtcy5hZGQo\nbyk7ICAgICAgICAgICAgICAgIAogICAgICAgICAgICB9CiAgICAgICAgfQog\nICAgICAgIHJldHVybiB0aGlzOwogICAgfQoKICAgIC8qKgogICAgICogQXBw\nZW5kIGEgcGFyYW1ldGVyIHZhbHVlLgogICAgICovCiAgICBwdWJsaWMgU1FM\nQnVmZmVyIGFwcGVuZFZhbHVlKGJvb2xlYW4gYikgewogICAgICAgIHJldHVy\nbiBhcHBlbmRWYWx1ZShiLCBudWxsKTsKICAgIH0KCiAgICAvKioKICAgICAq\nIEFwcGVuZCBhIHBhcmFtZXRlciB2YWx1ZS4KICAgICAqLwogICAgcHVibGlj\nIFNRTEJ1ZmZlciBhcHBlbmRWYWx1ZShib29sZWFuIGIsIENvbHVtbiBjb2wp\nIHsKICAgICAgICByZXR1cm4gYXBwZW5kVmFsdWUoKGIpID8gQm9vbGVhbi5U\nUlVFIDogQm9vbGVhbi5GQUxTRSwgY29sKTsKICAgIH0KCiAgICAvKioKICAg\nICAqIEFwcGVuZCBhIHBhcmFtZXRlciB2YWx1ZS4KICAgICAqLwogICAgcHVi\nbGljIFNRTEJ1ZmZlciBhcHBlbmRWYWx1ZShieXRlIGIpIHsKICAgICAgICBy\nZXR1cm4gYXBwZW5kVmFsdWUoYiwgbnVsbCk7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBBcHBlbmQgYSBwYXJhbWV0ZXIgdmFsdWUuCiAgICAgKi8KICAgIHB1\nYmxpYyBTUUxCdWZmZXIgYXBwZW5kVmFsdWUoYnl0ZSBiLCBDb2x1bW4gY29s\nKSB7CiAgICAgICAgcmV0dXJuIGFwcGVuZFZhbHVlKG5ldyBCeXRlKGIpLCBj\nb2wpOwogICAgfQoKICAgIC8qKgogICAgICogQXBwZW5kIGEgcGFyYW1ldGVy\nIHZhbHVlLgogICAgICovCiAgICBwdWJsaWMgU1FMQnVmZmVyIGFwcGVuZFZh\nbHVlKGNoYXIgYykgewogICAgICAgIHJldHVybiBhcHBlbmRWYWx1ZShjLCBu\ndWxsKTsKICAgIH0KCiAgICAvKioKICAgICAqIEFwcGVuZCBhIHBhcmFtZXRl\nciB2YWx1ZS4KICAgICAqLwogICAgcHVibGljIFNRTEJ1ZmZlciBhcHBlbmRW\nYWx1ZShjaGFyIGMsIENvbHVtbiBjb2wpIHsKICAgICAgICByZXR1cm4gYXBw\nZW5kVmFsdWUobmV3IENoYXJhY3RlcihjKSwgY29sKTsKICAgIH0KCiAgICAv\nKioKICAgICAqIEFwcGVuZCBhIHBhcmFtZXRlciB2YWx1ZS4KICAgICAqLwog\nICAgcHVibGljIFNRTEJ1ZmZlciBhcHBlbmRWYWx1ZShkb3VibGUgZCkgewog\nICAgICAgIHJldHVybiBhcHBlbmRWYWx1ZShkLCBudWxsKTsKICAgIH0KCiAg\nICAvKioKICAgICAqIEFwcGVuZCBhIHBhcmFtZXRlciB2YWx1ZS4KICAgICAq\nLwogICAgcHVibGljIFNRTEJ1ZmZlciBhcHBlbmRWYWx1ZShkb3VibGUgZCwg\nQ29sdW1uIGNvbCkgewogICAgICAgIHJldHVybiBhcHBlbmRWYWx1ZShuZXcg\nRG91YmxlKGQpLCBjb2wpOwogICAgfQoKICAgIC8qKgogICAgICogQXBwZW5k\nIGEgcGFyYW1ldGVyIHZhbHVlLgogICAgICovCiAgICBwdWJsaWMgU1FMQnVm\nZmVyIGFwcGVuZFZhbHVlKGZsb2F0IGYpIHsKICAgICAgICByZXR1cm4gYXBw\nZW5kVmFsdWUoZiwgbnVsbCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBBcHBl\nbmQgYSBwYXJhbWV0ZXIgdmFsdWUuCiAgICAgKi8KICAgIHB1YmxpYyBTUUxC\ndWZmZXIgYXBwZW5kVmFsdWUoZmxvYXQgZiwgQ29sdW1uIGNvbCkgewogICAg\nICAgIHJldHVybiBhcHBlbmRWYWx1ZShuZXcgRmxvYXQoZiksIGNvbCk7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBBcHBlbmQgYSBwYXJhbWV0ZXIgdmFsdWUu\nCiAgICAgKi8KICAgIHB1YmxpYyBTUUxCdWZmZXIgYXBwZW5kVmFsdWUoaW50\nIGkpIHsKICAgICAgICByZXR1cm4gYXBwZW5kVmFsdWUoaSwgbnVsbCk7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBBcHBlbmQgYSBwYXJhbWV0ZXIgdmFsdWUu\nCiAgICAgKi8KICAgIHB1YmxpYyBTUUxCdWZmZXIgYXBwZW5kVmFsdWUoaW50\nIGksIENvbHVtbiBjb2wpIHsKICAgICAgICByZXR1cm4gYXBwZW5kVmFsdWUo\nTnVtYmVycy52YWx1ZU9mKGkpLCBjb2wpOwogICAgfQoKICAgIC8qKgogICAg\nICogQXBwZW5kIGEgcGFyYW1ldGVyIHZhbHVlLgogICAgICovCiAgICBwdWJs\naWMgU1FMQnVmZmVyIGFwcGVuZFZhbHVlKGxvbmcgbCkgewogICAgICAgIHJl\ndHVybiBhcHBlbmRWYWx1ZShsLCBudWxsKTsKICAgIH0KCiAgICAvKioKICAg\nICAqIEFwcGVuZCBhIHBhcmFtZXRlciB2YWx1ZS4KICAgICAqLwogICAgcHVi\nbGljIFNRTEJ1ZmZlciBhcHBlbmRWYWx1ZShsb25nIGwsIENvbHVtbiBjb2wp\nIHsKICAgICAgICByZXR1cm4gYXBwZW5kVmFsdWUoTnVtYmVycy52YWx1ZU9m\nKGwpLCBjb2wpOwogICAgfQoKICAgIC8qKgogICAgICogQXBwZW5kIGEgcGFy\nYW1ldGVyIHZhbHVlLgogICAgICovCiAgICBwdWJsaWMgU1FMQnVmZmVyIGFw\ncGVuZFZhbHVlKHNob3J0IHMpIHsKICAgICAgICByZXR1cm4gYXBwZW5kVmFs\ndWUocywgbnVsbCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBBcHBlbmQgYSBw\nYXJhbWV0ZXIgdmFsdWUuCiAgICAgKi8KICAgIHB1YmxpYyBTUUxCdWZmZXIg\nYXBwZW5kVmFsdWUoc2hvcnQgcywgQ29sdW1uIGNvbCkgewogICAgICAgIHJl\ndHVybiBhcHBlbmRWYWx1ZShuZXcgU2hvcnQocyksIGNvbCk7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBSZXR1cm4gdGhlIGxpc3Qgb2YgcGFyYW1ldGVyIHZh\nbHVlcy4KICAgICAqLwogICAgcHVibGljIExpc3QgZ2V0UGFyYW1ldGVycygp\nIHsKICAgICAgICByZXR1cm4gKF9wYXJhbXMgPT0gbnVsbCkgPyBDb2xsZWN0\naW9ucy5FTVBUWV9MSVNUIDogX3BhcmFtczsKICAgIH0KCiAgICBwdWJsaWMg\nTGlzdCBnZXROb25GS1BhcmFtZXRlcnMoKSB7CiAgICAgICAgcmV0dXJuIChf\nbm9uRktQYXJhbXMgPT0gbnVsbCkgPyBDb2xsZWN0aW9ucy5FTVBUWV9MSVNU\nIDogX25vbkZLUGFyYW1zOwogICAgfQogICAgLyoqCiAgICAgKiBSZXR1cm4g\ndGhlIFNRTCBmb3IgdGhpcyBidWZmZXIuCiAgICAgKi8KICAgIHB1YmxpYyBT\ndHJpbmcgZ2V0U1FMKCkgewogICAgICAgIHJldHVybiBnZXRTUUwoZmFsc2Up\nOwogICAgfQogICAgCiAgICAvKioKICAgICAqIFJldHVybnMgdGhlIFNRTCBm\nb3IgdGhpcyBidWZmZXIuCiAgICAgKgogICAgICogQHBhcmFtIHJlcGxhY2VQ\nYXJhbXMgaWYgdHJ1ZSwgdGhlbiByZXBsYWNlIHBhcmFtZXRlcnMgd2l0aCB0\naGUKICAgICAqIGFjdHVhbCBwYXJhbWV0ZXIgdmFsdWVzCiAgICAgKi8KICAg\nIHB1YmxpYyBTdHJpbmcgZ2V0U1FMKGJvb2xlYW4gcmVwbGFjZVBhcmFtcykg\newogICAgICAgIHJlc29sdmVTdWJzZWxlY3RzKCk7CiAgICAgICAgU3RyaW5n\nIHNxbCA9IF9zcWwudG9TdHJpbmcoKTsKICAgICAgICBpZiAoIXJlcGxhY2VQ\nYXJhbXMgfHwgX3BhcmFtcyA9PSBudWxsIHx8IF9wYXJhbXMuaXNFbXB0eSgp\nKQogICAgICAgICAgICByZXR1cm4gc3FsOwoKICAgICAgICBTdHJpbmdCdWZm\nZXIgYnVmID0gbmV3IFN0cmluZ0J1ZmZlcigpOwogICAgICAgIEl0ZXJhdG9y\nIHBpID0gX3BhcmFtcy5pdGVyYXRvcigpOwogICAgICAgIGZvciAoaW50IGkg\nPSAwOyBpIDwgc3FsLmxlbmd0aCgpOyBpKyspIHsKICAgICAgICAgICAgaWYg\nKHNxbC5jaGFyQXQoaSkgIT0gJz8nKSB7CiAgICAgICAgICAgICAgICBidWYu\nYXBwZW5kKHNxbC5jaGFyQXQoaSkpOwogICAgICAgICAgICAgICAgY29udGlu\ndWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIE9iamVjdCBwYXJhbSA9\nIHBpLmhhc05leHQoKSA/IHBpLm5leHQoKSA6IG51bGw7CiAgICAgICAgICAg\nIGlmIChwYXJhbSA9PSBudWxsKQogICAgICAgICAgICAgICAgYnVmLmFwcGVu\nZCgiTlVMTCIpOwogICAgICAgICAgICBlbHNlIGlmIChwYXJhbSBpbnN0YW5j\nZW9mIE51bWJlciB8fCBwYXJhbSBpbnN0YW5jZW9mIEJvb2xlYW4pCiAgICAg\nICAgICAgICAgICBidWYuYXBwZW5kKHBhcmFtKTsKICAgICAgICAgICAgZWxz\nZSBpZiAocGFyYW0gaW5zdGFuY2VvZiBTdHJpbmcgfHwgcGFyYW0gaW5zdGFu\nY2VvZiBDaGFyYWN0ZXIpCiAgICAgICAgICAgICAgICBidWYuYXBwZW5kKCIn\nIikuYXBwZW5kKHBhcmFtKS5hcHBlbmQoIiciKTsKICAgICAgICAgICAgZWxz\nZQogICAgICAgICAgICAgICAgYnVmLmFwcGVuZCgiPyIpOwogICAgICAgIH0K\nICAgICAgICByZXR1cm4gYnVmLnRvU3RyaW5nKCk7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBSZXNvbHZlIG91ciBkZWxheWVkIHN1YnNlbGVjdHMuCiAgICAg\nKi8KICAgIHByaXZhdGUgdm9pZCByZXNvbHZlU3Vic2VsZWN0cygpIHsKICAg\nICAgICBpZiAoX3N1YnNlbHMgPT0gbnVsbCB8fCBfc3Vic2Vscy5pc0VtcHR5\nKCkpCiAgICAgICAgICAgIHJldHVybjsKCiAgICAgICAgLy8gYWRkIHN1YnNl\nbHMgYmFja3dhcmRzIHNvIHRoYXQgdGhlIHN0b3JlZCBpbnNlcnRpb24gcG9p\nbnRzIG9mCiAgICAgICAgLy8gbGF0ZXIgc3Vic2VscyByZW1haW4gdmFsaWQK\nICAgICAgICBTdWJzZWxlY3Qgc3ViOwogICAgICAgIFNRTEJ1ZmZlciBidWY7\nCiAgICAgICAgZm9yIChpbnQgaSA9IF9zdWJzZWxzLnNpemUoKSAtIDE7IGkg\nPj0gMDsgaS0tKSB7CiAgICAgICAgICAgIHN1YiA9IChTdWJzZWxlY3QpIF9z\ndWJzZWxzLmdldChpKTsKICAgICAgICAgICAgaWYgKHN1Yi5jb3VudCkKICAg\nICAgICAgICAgICAgIGJ1ZiA9IHN1Yi5zZWxlY3QudG9TZWxlY3RDb3VudCgp\nOwogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICBidWYgPSBzdWIu\nc2VsZWN0LnRvU2VsZWN0KGZhbHNlLCBzdWIuZmV0Y2gpOwogICAgICAgICAg\nICBidWYucmVzb2x2ZVN1YnNlbGVjdHMoKTsKICAgICAgICAgICAgYXBwZW5k\nKGJ1Ziwgc3ViLnNxbEluZGV4LCBzdWIucGFyYW1JbmRleCwgZmFsc2UpOwog\nICAgICAgIH0KICAgICAgICBfc3Vic2Vscy5jbGVhcigpOwogICAgfQoKICAg\nIC8qKgogICAgICogQ3JlYXRlIGFuZCBwb3B1bGF0ZSB0aGUgcGFyYW1ldGVy\ncyBvZiBhIHByZXBhcmVkIHN0YXRlbWVudCB1c2luZwogICAgICogdGhlIFNR\nTCBpbiB0aGlzIGJ1ZmZlci4KICAgICAqLwogICAgcHVibGljIFByZXBhcmVk\nU3RhdGVtZW50IHByZXBhcmVTdGF0ZW1lbnQoQ29ubmVjdGlvbiBjb25uKQog\nICAgICAgIHRocm93cyBTUUxFeGNlcHRpb24gewogICAgICAgIHJldHVybiBw\ncmVwYXJlU3RhdGVtZW50KGNvbm4sIFJlc3VsdFNldC5UWVBFX0ZPUldBUkRf\nT05MWSwKICAgICAgICAgICAgUmVzdWx0U2V0LkNPTkNVUl9SRUFEX09OTFkp\nOwogICAgfQoKICAgIC8qKgogICAgICogQ3JlYXRlIGFuZCBwb3B1bGF0ZSB0\naGUgcGFyYW1ldGVycyBvZiBhIHByZXBhcmVkIHN0YXRlbWVudCB1c2luZwog\nICAgICogdGhlIFNRTCBpbiB0aGlzIGJ1ZmZlci4KICAgICAqLwogICAgcHVi\nbGljIFByZXBhcmVkU3RhdGVtZW50IHByZXBhcmVTdGF0ZW1lbnQoQ29ubmVj\ndGlvbiBjb25uLCBpbnQgcnNUeXBlLAogICAgICAgIGludCByc0NvbmN1ciwg\nTGlzdCBwYXJtcykKICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAg\nICAgICByZXR1cm4gcHJlcGFyZVN0YXRlbWVudChjb25uLCBudWxsLCByc1R5\ncGUsIHJzQ29uY3VyLCBwYXJtcyk7CiAgICB9CiAgICAKICAgIC8qKgogICAg\nICogQ3JlYXRlIGFuZCBwb3B1bGF0ZSB0aGUgcGFyYW1ldGVycyBvZiBhIHBy\nZXBhcmVkIHN0YXRlbWVudCB1c2luZwogICAgICogdGhlIFNRTCBpbiB0aGlz\nIGJ1ZmZlci4KICAgICAqLwogICAgcHVibGljIFByZXBhcmVkU3RhdGVtZW50\nIHByZXBhcmVTdGF0ZW1lbnQoQ29ubmVjdGlvbiBjb25uLCBpbnQgcnNUeXBl\nLAogICAgICAgIGludCByc0NvbmN1cikKICAgICAgICB0aHJvd3MgU1FMRXhj\nZXB0aW9uIHsKICAgICAgICByZXR1cm4gcHJlcGFyZVN0YXRlbWVudChjb25u\nLCByc1R5cGUsIHJzQ29uY3VyLCBudWxsKTsKICAgIH0KCiAgICAvKioKICAg\nICAqIENyZWF0ZSBhbmQgcG9wdWxhdGUgdGhlIHBhcmFtZXRlcnMgb2YgYSBw\ncmVwcmVkIHN0YXRlbWVudCB1c2luZyB0aGUKICAgICAqIFNRTCBpbiB0aGlz\nIGJ1ZmZlciBhbmQgdGhlIGdpdmVuIGZldGNoIGNvbmZpZ3VyYXRpb24uCiAg\nICAgKi8KICAgIHB1YmxpYyBQcmVwYXJlZFN0YXRlbWVudCBwcmVwYXJlU3Rh\ndGVtZW50KENvbm5lY3Rpb24gY29ubiwKICAgICAgICBKREJDRmV0Y2hDb25m\naWd1cmF0aW9uIGZldGNoLCBpbnQgcnNUeXBlLCBpbnQgcnNDb25jdXIpCiAg\nICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgcmV0dXJuIHBy\nZXBhcmVTdGF0ZW1lbnQoY29ubiwgZmV0Y2gsIHJzVHlwZSwgcnNDb25jdXIs\nIG51bGwpOwogICAgfQogICAgCiAgICAvKioKICAgICAqIENyZWF0ZSBhbmQg\ncG9wdWxhdGUgdGhlIHBhcmFtZXRlcnMgb2YgYSBwcmVwcmVkIHN0YXRlbWVu\ndCB1c2luZyB0aGUKICAgICAqIFNRTCBpbiB0aGlzIGJ1ZmZlciBhbmQgdGhl\nIGdpdmVuIGZldGNoIGNvbmZpZ3VyYXRpb24uCiAgICAgKi8KICAgIHB1Ymxp\nYyBQcmVwYXJlZFN0YXRlbWVudCBwcmVwYXJlU3RhdGVtZW50KENvbm5lY3Rp\nb24gY29ubiwKICAgICAgICBKREJDRmV0Y2hDb25maWd1cmF0aW9uIGZldGNo\nLCBpbnQgcnNUeXBlLCBpbnQgcnNDb25jdXIsIExpc3QgcGFybXMpCiAgICAg\nICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgaWYgKHJzVHlwZSA9\nPSAtMSAmJiBmZXRjaCA9PSBudWxsKQogICAgICAgICAgICByc1R5cGUgPSBS\nZXN1bHRTZXQuVFlQRV9GT1JXQVJEX09OTFk7CiAgICAgICAgZWxzZSBpZiAo\ncnNUeXBlID09IC0xKQogICAgICAgICAgICByc1R5cGUgPSBmZXRjaC5nZXRS\nZXN1bHRTZXRUeXBlKCk7CiAgICAgICAgaWYgKHJzQ29uY3VyID09IC0xKQog\nICAgICAgICAgICByc0NvbmN1ciA9IFJlc3VsdFNldC5DT05DVVJfUkVBRF9P\nTkxZOwoKICAgICAgICBQcmVwYXJlZFN0YXRlbWVudCBzdG1udDsKICAgICAg\nICBpZiAocnNUeXBlID09IFJlc3VsdFNldC5UWVBFX0ZPUldBUkRfT05MWQog\nICAgICAgICAgICAmJiByc0NvbmN1ciA9PSBSZXN1bHRTZXQuQ09OQ1VSX1JF\nQURfT05MWSkKICAgICAgICAgICAgc3RtbnQgPSBjb25uLnByZXBhcmVTdGF0\nZW1lbnQoZ2V0U1FMKCkpOwogICAgICAgIGVsc2UKICAgICAgICAgICAgc3Rt\nbnQgPSBjb25uLnByZXBhcmVTdGF0ZW1lbnQoZ2V0U1FMKCksIHJzVHlwZSwg\ncnNDb25jdXIpOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIHNldFBhcmFt\nZXRlcnMoc3RtbnQsIHBhcm1zKTsKICAgICAgICAgICAgaWYgKGZldGNoICE9\nIG51bGwpIHsKICAgICAgICAgICAgICAgIGlmIChmZXRjaC5nZXRGZXRjaEJh\ndGNoU2l6ZSgpID4gMCkKICAgICAgICAgICAgICAgICAgICBzdG1udC5zZXRG\nZXRjaFNpemUoZmV0Y2guZ2V0RmV0Y2hCYXRjaFNpemUoKSk7CiAgICAgICAg\nICAgICAgICBpZiAocnNUeXBlICE9IFJlc3VsdFNldC5UWVBFX0ZPUldBUkRf\nT05MWQogICAgICAgICAgICAgICAgICAgICYmIGZldGNoLmdldEZldGNoRGly\nZWN0aW9uKCkgIT0gUmVzdWx0U2V0LkZFVENIX0ZPUldBUkQpCiAgICAgICAg\nICAgICAgICAgICAgc3RtbnQuc2V0RmV0Y2hEaXJlY3Rpb24oZmV0Y2guZ2V0\nRmV0Y2hEaXJlY3Rpb24oKSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAg\ncmV0dXJuIHN0bW50OwogICAgICAgIH0gY2F0Y2ggKFNRTEV4Y2VwdGlvbiBz\nZSkgewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgc3RtbnQu\nY2xvc2UoKTsKICAgICAgICAgICAgfSBjYXRjaCAoU1FMRXhjZXB0aW9uIHNl\nMikgewogICAgICAgICAgICB9CiAgICAgICAgICAgIHRocm93IHNlOwogICAg\nICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIENyZWF0ZSBhbmQgcG9wdWxh\ndGUgdGhlIHBhcmFtZXRlcnMgb2YgYSBwcmVwYXJlZCBzdGF0ZW1lbnQgdXNp\nbmcKICAgICAqIHRoZSBTUUwgaW4gdGhpcyBidWZmZXIuCiAgICAgKi8KICAg\nIHB1YmxpYyBDYWxsYWJsZVN0YXRlbWVudCBwcmVwYXJlQ2FsbChDb25uZWN0\naW9uIGNvbm4pCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAg\nICAgcmV0dXJuIHByZXBhcmVDYWxsKGNvbm4sIFJlc3VsdFNldC5UWVBFX0ZP\nUldBUkRfT05MWSwKICAgICAgICAgICAgUmVzdWx0U2V0LkNPTkNVUl9SRUFE\nX09OTFkpOwogICAgfQoKICAgIC8qKgogICAgICogQ3JlYXRlIGFuZCBwb3B1\nbGF0ZSB0aGUgcGFyYW1ldGVycyBvZiBhIHByZXBhcmVkIHN0YXRlbWVudCB1\nc2luZwogICAgICogdGhlIFNRTCBpbiB0aGlzIGJ1ZmZlci4KICAgICAqLwog\nICAgcHVibGljIENhbGxhYmxlU3RhdGVtZW50IHByZXBhcmVDYWxsKENvbm5l\nY3Rpb24gY29ubiwgaW50IHJzVHlwZSwKICAgICAgICBpbnQgcnNDb25jdXIp\nCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAgICAgcmV0dXJu\nIHByZXBhcmVDYWxsKGNvbm4sIG51bGwsIHJzVHlwZSwgcnNDb25jdXIpOwog\nICAgfQoKICAgIC8qKgogICAgICogQ3JlYXRlIGFuZCBwb3B1bGF0ZSB0aGUg\ncGFyYW1ldGVycyBvZiBhIHByZXByZWQgc3RhdGVtZW50IHVzaW5nIHRoZQog\nICAgICogU1FMIGluIHRoaXMgYnVmZmVyIGFuZCB0aGUgZ2l2ZW4gZmV0Y2gg\nY29uZmlndXJhdGlvbi4KICAgICAqLwogICAgcHVibGljIENhbGxhYmxlU3Rh\ndGVtZW50IHByZXBhcmVDYWxsKENvbm5lY3Rpb24gY29ubiwKICAgICAgICBK\nREJDRmV0Y2hDb25maWd1cmF0aW9uIGZldGNoLCBpbnQgcnNUeXBlLCBpbnQg\ncnNDb25jdXIpCiAgICAgICAgdGhyb3dzIFNRTEV4Y2VwdGlvbiB7CiAgICAg\nICAgaWYgKHJzVHlwZSA9PSAtMSAmJiBmZXRjaCA9PSBudWxsKQogICAgICAg\nICAgICByc1R5cGUgPSBSZXN1bHRTZXQuVFlQRV9GT1JXQVJEX09OTFk7CiAg\nICAgICAgZWxzZSBpZiAocnNUeXBlID09IC0xKQogICAgICAgICAgICByc1R5\ncGUgPSBmZXRjaC5nZXRSZXN1bHRTZXRUeXBlKCk7CiAgICAgICAgaWYgKHJz\nQ29uY3VyID09IC0xKQogICAgICAgICAgICByc0NvbmN1ciA9IFJlc3VsdFNl\ndC5DT05DVVJfUkVBRF9PTkxZOwoKICAgICAgICBDYWxsYWJsZVN0YXRlbWVu\ndCBzdG1udDsKICAgICAgICBpZiAocnNUeXBlID09IFJlc3VsdFNldC5UWVBF\nX0ZPUldBUkRfT05MWQogICAgICAgICAgICAmJiByc0NvbmN1ciA9PSBSZXN1\nbHRTZXQuQ09OQ1VSX1JFQURfT05MWSkKICAgICAgICAgICAgc3RtbnQgPSBj\nb25uLnByZXBhcmVDYWxsKGdldFNRTCgpKTsKICAgICAgICBlbHNlCiAgICAg\nICAgICAgIHN0bW50ID0gY29ubi5wcmVwYXJlQ2FsbChnZXRTUUwoKSwgcnNU\neXBlLCByc0NvbmN1cik7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgc2V0\nUGFyYW1ldGVycyhzdG1udCk7CiAgICAgICAgICAgIGlmIChmZXRjaCAhPSBu\ndWxsKSB7CiAgICAgICAgICAgICAgICBpZiAoZmV0Y2guZ2V0RmV0Y2hCYXRj\naFNpemUoKSA+IDApCiAgICAgICAgICAgICAgICAgICAgc3RtbnQuc2V0RmV0\nY2hTaXplKGZldGNoLmdldEZldGNoQmF0Y2hTaXplKCkpOwogICAgICAgICAg\nICAgICAgaWYgKHJzVHlwZSAhPSBSZXN1bHRTZXQuVFlQRV9GT1JXQVJEX09O\nTFkKICAgICAgICAgICAgICAgICAgICAmJiBmZXRjaC5nZXRGZXRjaERpcmVj\ndGlvbigpICE9IFJlc3VsdFNldC5GRVRDSF9GT1JXQVJEKQogICAgICAgICAg\nICAgICAgICAgIHN0bW50LnNldEZldGNoRGlyZWN0aW9uKGZldGNoLmdldEZl\ndGNoRGlyZWN0aW9uKCkpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJl\ndHVybiBzdG1udDsKICAgICAgICB9IGNhdGNoIChTUUxFeGNlcHRpb24gc2Up\nIHsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIHN0bW50LmNs\nb3NlKCk7CiAgICAgICAgICAgIH0gY2F0Y2ggKFNRTEV4Y2VwdGlvbiBzZTIp\nIHsKICAgICAgICAgICAgfQogICAgICAgICAgICB0aHJvdyBzZTsKICAgICAg\nICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBQb3B1bGF0ZSB0aGUgcGFyYW1l\ndGVycyBvZiBhbiBleGlzdGluZyBQcmVwYXJlZFN0YXRlbWVudAogICAgICog\nd2l0aCB2YWx1ZXMgZnJvbSB0aGlzIGJ1ZmZlci4KICAgICAqLwogICAgcHVi\nbGljIHZvaWQgc2V0UGFyYW1ldGVycyhQcmVwYXJlZFN0YXRlbWVudCBwcykK\nICAgICAgICB0aHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBzZXRQYXJh\nbWV0ZXJzKHBzLCBudWxsKTsKICAgIH0KICAgIAogICAgLyoqCiAgICAgKiBQ\nb3B1bGF0ZSB0aGUgcGFyYW1ldGVycyBvZiBhbiBleGlzdGluZyBQcmVwYXJl\nZFN0YXRlbWVudAogICAgICogd2l0aCB2YWx1ZXMgZnJvbSB0aGlzIGJ1ZmZl\nci4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0UGFyYW1ldGVycyhQcmVw\nYXJlZFN0YXRlbWVudCBwcywgTGlzdCBjYWNoZVBhcmFtcykKICAgICAgICB0\naHJvd3MgU1FMRXhjZXB0aW9uIHsKICAgICAgICBMaXN0IHBhcmFtcyA9ICgo\nY2FjaGVQYXJhbXMgIT0gbnVsbCAmJiBjYWNoZVBhcmFtcy5zaXplKCkgPiAw\nKSA/IAogICAgICAgICAgICBjYWNoZVBhcmFtcyA6IF9wYXJhbXMpOyAgICAK\nICAgICAgICAKICAgICAgICBpZiAocGFyYW1zID09IG51bGwpCiAgICAgICAg\nICAgIHJldHVybjsKCiAgICAgICAgQ29sdW1uIGNvbDsKICAgICAgICBmb3Ig\nKGludCBpID0gMDsgaSA8IHBhcmFtcy5zaXplKCk7IGkrKykgewogICAgICAg\nICAgICBjb2wgPSAoX2NvbHMgPT0gbnVsbCkgPyBudWxsIDogKENvbHVtbikg\nX2NvbHMuZ2V0KGkpOwogICAgICAgICAgICBfZGljdC5zZXRVbmtub3duKHBz\nLCBpICsgMSwgcGFyYW1zLmdldChpKSwgY29sKTsKICAgICAgICB9CiAgICB9\nCgogICAgcHVibGljIGludCBoYXNoQ29kZSgpIHsKICAgICAgICBpbnQgaGFz\naCA9IF9zcWwuaGFzaENvZGUoKTsKICAgICAgICByZXR1cm4gKF9wYXJhbXMg\nPT0gbnVsbCkgPyBoYXNoIDogaGFzaCBeIF9wYXJhbXMuaGFzaENvZGUoKTsK\nICAgIH0KCiAgICAvKioKICAgICAqIENvbXBhcmUgaW50ZXJuYWwgU1FMIHdp\ndGhvdXQgcmVzb2x2aW5nIHN1YnNlbGVjdHMgb3Igc3RyaW5naWZ5aW5nCiAg\nICAgKiBwYXJhbWV0ZXJzLgogICAgICovCiAgICBwdWJsaWMgYm9vbGVhbiBz\ncWxFcXVhbHMoU3RyaW5nIHNxbCkgewogICAgICAgIHJldHVybiBfc3FsLnRv\nU3RyaW5nKCkuZXF1YWxzKHNxbCk7CiAgICB9CgogICAgcHVibGljIGJvb2xl\nYW4gZXF1YWxzKE9iamVjdCBvdGhlcikgewogICAgICAgIGlmIChvdGhlciA9\nPSB0aGlzKQogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICBpZiAo\nIShvdGhlciBpbnN0YW5jZW9mIFNRTEJ1ZmZlcikpCiAgICAgICAgICAgIHJl\ndHVybiBmYWxzZTsKCiAgICAgICAgU1FMQnVmZmVyIGJ1ZiA9IChTUUxCdWZm\nZXIpIG90aGVyOwogICAgICAgIHJldHVybiBfc3FsLmVxdWFscyhidWYuX3Nx\nbCkKICAgICAgICAgICAgJiYgT2JqZWN0VXRpbHMuZXF1YWxzKF9wYXJhbXMs\nIGJ1Zi5fcGFyYW1zKTsKICAgIH0KCiAgICAvKioKICAgICAqIFJlcGxhY2Ug\nU1FMICc/JyB3aXRoIENBU1Qgc3RyaW5nIGlmIHJlcXVpcmVkIGJ5IERCIHBs\nYXRmb3JtCiAgICAgKiBAcGFyYW0gb3BlcgogICAgICogQHBhcmFtIHZhbAog\nICAgICovCiAgICBwdWJsaWMgdm9pZCBhZGRDYXN0Rm9yUGFyYW0oU3RyaW5n\nIG9wZXIsIFZhbCB2YWwpIHsKICAgICAgICBpZiAoX3NxbC5jaGFyQXQoX3Nx\nbC5sZW5ndGgoKSAtIDEpID09ICc/JykgewogICAgICAgICAgICBTdHJpbmcg\nY2FzdFN0cmluZyA9IF9kaWN0LmFkZENhc3RBc1R5cGUob3BlciwgdmFsKTsK\nICAgICAgICAgICAgaWYgKGNhc3RTdHJpbmcgIT0gbnVsbCkKICAgICAgICAg\nICAgICAgIF9zcWwucmVwbGFjZShfc3FsLmxlbmd0aCgpIC0gMSwgX3NxbC5s\nZW5ndGgoKSwgY2FzdFN0cmluZyk7CiAgICAgICAgfQogICAgfQoKICAgIC8q\nKgogICAgICogUmVwbGFjZSBjdXJyZW50IGJ1ZmZlciBzdHJpbmcgd2l0aCB0\naGUgbmV3IHN0cmluZwogICAgICogCiAgICAgKiBAcGFyYW0gc3RhcnQgcmVw\nbGFjZSBzdGFydCBwb3NpdGlvbgogICAgICogQHBhcmFtIGVuZCByZXBsYWNl\nIGVuZCBwb3NpdGlvbgogICAgICogQHBhcmFtIG5ld1N0cmluZwogICAgICov\nCiAgICBwdWJsaWMgdm9pZCByZXBsYWNlU3FsU3RyaW5nKGludCBzdGFydCwg\naW50IGVuZCwgU3RyaW5nIG5ld1N0cmluZykgewogICAgICAgIF9zcWwucmVw\nbGFjZShzdGFydCwgZW5kLCBuZXdTdHJpbmcpOwogICAgfQogICAgCiAgICAv\nKioKICAgICAqIFJlcHJlc2VudHMgYSBzdWJzZWxlY3QuCiAgICAgKi8KICAg\nIHByaXZhdGUgc3RhdGljIGNsYXNzIFN1YnNlbGVjdCB7CgogICAgICAgIHB1\nYmxpYyBTZWxlY3Qgc2VsZWN0OwogICAgICAgIHB1YmxpYyBKREJDRmV0Y2hD\nb25maWd1cmF0aW9uIGZldGNoOwogICAgICAgIHB1YmxpYyBib29sZWFuIGNv\ndW50OwogICAgICAgIHB1YmxpYyBpbnQgc3FsSW5kZXg7CiAgICAgICAgcHVi\nbGljIGludCBwYXJhbUluZGV4OwoKICAgICAgICBwdWJsaWMgU3Vic2VsZWN0\nIGNsb25lKGludCBzcWxJbmRleCwgaW50IHBhcmFtSW5kZXgpIHsKICAgICAg\nICAgICAgaWYgKHNxbEluZGV4ID09IDAgJiYgcGFyYW1JbmRleCA9PSAwKQog\nICAgICAgICAgICAgICAgcmV0dXJuIHRoaXM7CgogICAgICAgICAgICBTdWJz\nZWxlY3Qgc3ViID0gbmV3IFN1YnNlbGVjdCgpOwogICAgICAgICAgICBzdWIu\nc2VsZWN0ID0gc2VsZWN0OwogICAgICAgICAgICBzdWIuZmV0Y2ggPSBmZXRj\naDsKICAgICAgICAgICAgc3ViLmNvdW50ID0gY291bnQ7CiAgICAgICAgICAg\nIHN1Yi5zcWxJbmRleCA9IHRoaXMuc3FsSW5kZXggKyBzcWxJbmRleDsKICAg\nICAgICAgICAgc3ViLnBhcmFtSW5kZXggPSB0aGlzLnBhcmFtSW5kZXggKyBw\nYXJhbUluZGV4OwogICAgICAgICAgICByZXR1cm4gc3ViOwogICAgICAgIH0K\nICAgIH0KICAgIAogICAgcHVibGljIHZvaWQgc2V0UGFyYW1ldGVycyhMaXN0\nIHBhcmFtcykgewogICAgICAgIF9wYXJhbXMgPSBwYXJhbXM7CiAgICB9CiAg\nICAKICAgIHB1YmxpYyBMaXN0IGdldENvbHVtbnMoKSB7CiAgICAgICAgcmV0\ndXJuIF9jb2xzOwogICAgfQp9Cg==\n","encoding":"base64"}

