{"sha":"4b5722ee5a6712d6b75d0c08314b627165b8eb0d","node_id":"MDQ6QmxvYjIwNjM2NDo0YjU3MjJlZTVhNjcxMmQ2Yjc1ZDBjMDgzMTRiNjI3MTY1YjhlYjBk","size":22550,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/4b5722ee5a6712d6b75d0c08314b627165b8eb0d","content":"LyoNCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUNCiAqIG9yIG1vcmUgY29udHJpYnV0b3Ig\nbGljZW5zZSBhZ3JlZW1lbnRzLiAgU2VlIHRoZSBOT1RJQ0UgZmlsZQ0KICog\nZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5m\nb3JtYXRpb24NCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAg\nVGhlIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUNCiAqIHRvIHlvdSB1bmRlciB0\naGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUNCiAqICJMaWNl\nbnNlIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNv\nbXBsaWFuY2UNCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFp\nbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQNCiAqDQogKiBodHRwOi8vd3d3\nLmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjANCiAqDQogKiBVbmxl\nc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGlu\nIHdyaXRpbmcsDQogKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUg\nTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbg0KICogIkFTIElTIiBCQVNJ\nUywgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZDQog\nKiBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBM\naWNlbnNlIGZvciB0aGUNCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmlu\nZyBwZXJtaXNzaW9ucyBhbmQgbGltaXRhdGlvbnMNCiAqIHVuZGVyIHRoZSBM\naWNlbnNlLiAgICANCiAqLw0KcGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEu\nZGF0YWNhY2hlOw0KDQppbXBvcnQgamF2YS5pby5PYmplY3RTdHJlYW1FeGNl\ncHRpb247DQppbXBvcnQgamF2YS5pby5TZXJpYWxpemFibGU7DQppbXBvcnQg\namF2YS51dGlsLkFic3RyYWN0TGlzdDsNCmltcG9ydCBqYXZhLnV0aWwuQXJy\nYXlMaXN0Ow0KaW1wb3J0IGphdmEudXRpbC5CaXRTZXQ7DQppbXBvcnQgamF2\nYS51dGlsLkNvbGxlY3Rpb25zOw0KaW1wb3J0IGphdmEudXRpbC5EYXRlOw0K\naW1wb3J0IGphdmEudXRpbC5MaXN0Ow0KaW1wb3J0IGphdmEudXRpbC5Mb2Nh\nbGU7DQppbXBvcnQgamF2YS51dGlsLk1hcDsNCmltcG9ydCBqYXZhLnV0aWwu\nVHJlZU1hcDsNCg0KaW1wb3J0IG9yZy5hcGFjaGUuY29tbW9ucy5jb2xsZWN0\naW9ucy5tYXAuTGlua2VkTWFwOw0KaW1wb3J0IG9yZy5hcGFjaGUub3Blbmpw\nYS5rZXJuZWwuRmV0Y2hDb25maWd1cmF0aW9uOw0KaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5rZXJuZWwuTG9ja0xldmVsczsNCmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEua2VybmVsLk9wZW5KUEFTdGF0ZU1hbmFnZXI7DQppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5RdWVyeUNvbnRleHQ7DQpp\nbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5TdG9yZUNvbnRleHQ7\nDQppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5TdG9yZVF1ZXJ5\nOw0KaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuZXhwcy5BZ2dy\nZWdhdGVMaXN0ZW5lcjsNCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEua2Vy\nbmVsLmV4cHMuRmlsdGVyTGlzdGVuZXI7DQppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLmxpYi5yb3AuTGlzdFJlc3VsdE9iamVjdFByb3ZpZGVyOw0KaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIucm9wLlJlc3VsdE9iamVjdFBy\nb3ZpZGVyOw0KaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRhLkNsYXNz\nTWV0YURhdGE7DQppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuSmF2\nYVR5cGVzOw0KaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRhLk1ldGFE\nYXRhUmVwb3NpdG9yeTsNCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRp\nbC5PYmplY3ROb3RGb3VuZEV4Y2VwdGlvbjsNCg0KaW1wb3J0IHNlcnAudXRp\nbC5OdW1iZXJzOw0KDQovKioNCiAqIEEge0BsaW5rIFN0b3JlUXVlcnl9IGlt\ncGxlbWVudGF0aW9uIHRoYXQgY2FjaGVzIHRoZSBPSURzIGludm9sdmVkIGlu\nDQogKiB0aGUgcXVlcnksIGFuZCBjYW4gZGV0ZXJtaW5lIHdoZXRoZXIgb3Ig\nbm90IHRoZSBxdWVyeSBoYXMgYmVlbiBkaXJ0aWVkLg0KICoNCiAqIEBhdXRo\nb3IgUGF0cmljayBMaW5za2V5DQogKiBAc2luY2UgMC4yLjUuMA0KICovDQpw\ndWJsaWMgY2xhc3MgUXVlcnlDYWNoZVN0b3JlUXVlcnkNCiAgICBpbXBsZW1l\nbnRzIFN0b3JlUXVlcnkgew0KDQogICAgcHJpdmF0ZSBmaW5hbCBTdG9yZVF1\nZXJ5IF9xdWVyeTsNCiAgICBwcml2YXRlIGZpbmFsIFF1ZXJ5Q2FjaGUgX2Nh\nY2hlOw0KICAgIHByaXZhdGUgU3RvcmVDb250ZXh0IF9zY3R4Ow0KICAgIHBy\naXZhdGUgTWV0YURhdGFSZXBvc2l0b3J5IF9yZXBvczsNCg0KICAgIC8qKg0K\nICAgICAqIENyZWF0ZSBhIG5ldyBpbnN0YW5jZSB0aGF0IGRlbGVnYXRlcyB0\nbyA8Y29kZT5xdWVyeTwvY29kZT4gaWYgbm8NCiAgICAgKiBjYWNoZWQgcmVz\ndWx0cyBhcmUgYXZhaWxhYmxlLg0KICAgICAqLw0KICAgIHB1YmxpYyBRdWVy\neUNhY2hlU3RvcmVRdWVyeShTdG9yZVF1ZXJ5IHF1ZXJ5LCBRdWVyeUNhY2hl\nIGNhY2hlKSB7DQogICAgICAgIF9xdWVyeSA9IHF1ZXJ5Ow0KICAgICAgICBf\nY2FjaGUgPSBjYWNoZTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiBSZXR1\ncm4gdGhlIHtAbGluayBRdWVyeUNhY2hlfSB0aGF0IHRoaXMgb2JqZWN0IGlz\nIGFzc29jaWF0ZWQgd2l0aC4NCiAgICAgKi8NCiAgICBwdWJsaWMgUXVlcnlD\nYWNoZSBnZXRDYWNoZSgpIHsNCiAgICAgICAgcmV0dXJuIF9jYWNoZTsNCiAg\nICB9DQoNCiAgICAvKioNCiAgICAgKiBEZWxlZ2F0ZS4NCiAgICAgKi8NCiAg\nICBwdWJsaWMgU3RvcmVRdWVyeSBnZXREZWxlZ2F0ZSgpIHsNCiAgICAgICAg\ncmV0dXJuIF9xdWVyeTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiBMb29r\nIGluIHRoZSBxdWVyeSBjYWNoZSBmb3IgYSByZXN1bHQgZm9yIHRoZSBnaXZl\nbiBxdWVyeQ0KICAgICAqIGtleS4gT25seSBsb29rIGlmIHRoaXMgcXVlcnkg\naXMgYmVpbmcgZXhlY3V0ZWQgb3V0c2lkZSBhDQogICAgICogdHJhbnNhY3Rp\nb24gb3IgaW4gYSB0cmFuc2FjdGlvbiB3aXRoIElnbm9yZUNoYW5nZXMgc2V0\nIHRvIHRydWUNCiAgICAgKiBvciBpbiBhIHRyYW5zYWN0aW9uIHdpdGggSWdu\nb3JlQ2hhbmdlcyBzZXQgdG8gZmFsc2UgYnV0IGluIHdoaWNoDQogICAgICog\nbm9uZSBvZiB0aGUgY2xhc3NlcyBpbnZvbHZlZCBpbiB0aGlzIHF1ZXJ5IGhh\ndmUgYmVlbiB0b3VjaGVkLg0KICAgICAqICBDYWNoaW5nIGlzIG5vdCB1c2Vk\nIHdoZW4gdXNpbmcgb2JqZWN0IGxvY2tpbmcuDQogICAgICogVGhpcyBpcyBi\nZWNhdXNlIHdlIG11c3Qgb2J0YWluIGxvY2tzIG9uIHRoZQ0KICAgICAqIGRh\ndGEsIGFuZCBpdCBpcyBsaWtlbHkgdGhhdCBtYWtpbmcgbiB0cmlwcyB0byB0\naGUgZGF0YWJhc2UgdG8NCiAgICAgKiBtYWtlIHRoZSBsb2NrcyB3aWxsIGJl\nIHNsb3dlciB0aGFuIHJ1bm5pbmcgdGhlIHF1ZXJ5IGFnYWluc3QNCiAgICAg\nKiB0aGUgZGF0YWJhc2UuDQogICAgICogIElmIHRoZSBmZXRjaCBjb25maWd1\ncmF0aW9uIGhhcyBxdWVyeSBjYWNoaW5nIGRpc2FibGVkLA0KICAgICAqIHRo\nZW4gdGhpcyBtZXRob2QgcmV0dXJucyA8Y29kZT5udWxsPC9jb2RlPi4NCiAg\nICAgKiAgUmV0dXJuIHRoZSBsaXN0IGlmIHdlIG1lZXQgdGhlIGFib3ZlIGNy\naXRlcmlhIGFuZCBpZiBhIGxpc3QNCiAgICAgKiBpcyBmb3VuZCBmb3IgPGNv\nZGU+cWs8L2NvZGU+LiBFbHNlLCByZXR1cm4NCiAgICAgKiA8Y29kZT5udWxs\nPC9jb2RlPi4NCiAgICAgKiAgVGhpcyBpbXBsZW1lbnRhdGlvbiBtZWFucyB0\naGF0IHF1ZXJpZXMgYWdhaW5zdCB0aGUgY2FjaGUNCiAgICAgKiBhcmUgb2Yg\nUkVBRF9DT01NSVRURUQgaXNvbGF0aW9uIGxldmVsLiBJdCdkIGJlIG5pY2Ug\ndG8gc3VwcG9ydA0KICAgICAqIFJFQURfU0VSSUFMSVpBQkxFIC0tIHRvIGRv\nIHNvLCB3ZSdkIGp1c3QgcmV0dXJuIGZhbHNlIHdoZW4gaW4NCiAgICAgKiBh\nIHRyYW5zYWN0aW9uLg0KICAgICAqLw0KICAgIHByaXZhdGUgTGlzdCBjaGVj\na0NhY2hlKFF1ZXJ5S2V5IHFrKSB7DQogICAgICAgIGlmIChxayA9PSBudWxs\nKQ0KICAgICAgICAgICAgcmV0dXJuIG51bGw7DQogICAgICAgIEZldGNoQ29u\nZmlndXJhdGlvbiBmZXRjaCA9IGdldENvbnRleHQoKS5nZXRGZXRjaENvbmZp\nZ3VyYXRpb24oKTsNCiAgICAgICAgaWYgKCFmZXRjaC5nZXRRdWVyeUNhY2hl\nRW5hYmxlZCgpKQ0KICAgICAgICAgICAgcmV0dXJuIG51bGw7DQogICAgICAg\nIGlmIChmZXRjaC5nZXRSZWFkTG9ja0xldmVsKCkgPiBMb2NrTGV2ZWxzLkxP\nQ0tfTk9ORSkNCiAgICAgICAgICAgIHJldHVybiBudWxsOw0KDQogICAgICAg\nIC8vIGdldCB0aGUgY2FjaGVkIGRhdGENCiAgICAgICAgUXVlcnlSZXN1bHQg\ncmVzID0gX2NhY2hlLmdldChxayk7DQogICAgICAgIGlmIChyZXMgPT0gbnVs\nbCkNCiAgICAgICAgICAgIHJldHVybiBudWxsOw0KICAgICAgICBpZiAocmVz\nLmlzRW1wdHkoKSkNCiAgICAgICAgICAgIHJldHVybiBDb2xsZWN0aW9ucy5F\nTVBUWV9MSVNUOw0KDQogICAgICAgIGludCBwcm9qcyA9IGdldENvbnRleHQo\nKS5nZXRQcm9qZWN0aW9uQWxpYXNlcygpLmxlbmd0aDsNCiAgICAgICAgaWYg\nKHByb2pzID09IDApIHsNCiAgICAgICAgICAgIC8vIG1ha2Ugc3VyZSB0aGUg\nZGF0YSBjYWNoZSBjb250YWlucyB0aGUgb2lkcyBmb3IgdGhlIHF1ZXJ5IHJl\nc3VsdDsNCiAgICAgICAgICAgIC8vIGlmIGl0IGRvZXNuJ3QsIHRoZW4gdXNp\nbmcgdGhlIHJlc3VsdCBjb3VsZCBiZSBzbG93ZXIgdGhhbiBub3QNCiAgICAg\nICAgICAgIC8vIHVzaW5nIGl0IGJlY2F1c2Ugb2YgdGhlIGluZGl2aWR1YWwg\nYnktb2lkIGxvb2t1cHMNCiAgICAgICAgICAgIENsYXNzTWV0YURhdGEgbWV0\nYSA9IF9yZXBvcy5nZXRNZXRhRGF0YShnZXRDb250ZXh0KCkuDQogICAgICAg\nICAgICAgICAgZ2V0Q2FuZGlkYXRlVHlwZSgpLCBfc2N0eC5nZXRDbGFzc0xv\nYWRlcigpLCB0cnVlKTsNCiAgICAgICAgICAgIGlmIChtZXRhLmdldERhdGFD\nYWNoZSgpID09IG51bGwpDQogICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7\nDQoNCiAgICAgICAgICAgIEJpdFNldCBpZHhzID0gbWV0YS5nZXREYXRhQ2Fj\naGUoKS5jb250YWluc0FsbChyZXMpOw0KDQogICAgICAgICAgICAvLyBldmVu\ndHVhbGx5IHdlIHNob3VsZCBvcHRpbWl6ZSB0aGlzIHRvIGZpZ3VyZSBvdXQg\naG93IG1hbnkgb2JqZWN0cw0KICAgICAgICAgICAgLy8gdGhlIGNhY2hlIGlz\nIG1pc3NpbmcgYW5kIGlmIG9ubHkgYSBmZXcgZG8gYSBidWxrIGZldGNoIGZv\nciB0aGVtDQogICAgICAgICAgICBpbnQgbGVuID0gaWR4cy5sZW5ndGgoKTsN\nCiAgICAgICAgICAgIGlmIChsZW4gPCByZXMuc2l6ZSgpKQ0KICAgICAgICAg\nICAgICAgIHJldHVybiBudWxsOw0KICAgICAgICAgICAgZm9yIChpbnQgaSA9\nIDA7IGkgPCBsZW47IGkrKykNCiAgICAgICAgICAgICAgICBpZiAoIWlkeHMu\nZ2V0KGkpKQ0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDsNCiAg\nICAgICAgfQ0KICAgICAgICByZXR1cm4gbmV3IENhY2hlZExpc3QocmVzLCBw\ncm9qcyAhPSAwLCBfc2N0eCk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog\nV3JhcCB0aGUgcmVzdWx0IG9iamVjdCBwcm92aWRlciByZXR1cm5lZCBieSBv\ndXIgZGVsZWdhdGUgaW4gYQ0KICAgICAqIGNhY2hpbmcgcHJvdmlkZXIuDQog\nICAgICovDQogICAgcHJpdmF0ZSBSZXN1bHRPYmplY3RQcm92aWRlciB3cmFw\nUmVzdWx0KFJlc3VsdE9iamVjdFByb3ZpZGVyIHJvcCwNCiAgICAgICAgUXVl\ncnlLZXkga2V5KSB7DQogICAgICAgIGlmIChrZXkgPT0gbnVsbCkNCiAgICAg\nICAgICAgIHJldHVybiByb3A7DQogICAgICAgIHJldHVybiBuZXcgQ2FjaGlu\nZ1Jlc3VsdE9iamVjdFByb3ZpZGVyKHJvcCwgZ2V0Q29udGV4dCgpLg0KICAg\nICAgICAgICAgZ2V0UHJvamVjdGlvbkFsaWFzZXMoKS5sZW5ndGggPiAwLCBr\nZXkpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIENvcHkgYSBwcm9qZWN0\naW9uIGVsZW1lbnQgZm9yIGNhY2hpbmcgLyByZXR1cm5pbmcuDQogICAgICov\nDQogICAgcHJpdmF0ZSBzdGF0aWMgT2JqZWN0IGNvcHlQcm9qZWN0aW9uKE9i\namVjdCBvYmosIFN0b3JlQ29udGV4dCBjdHgpIHsNCiAgICAgICAgaWYgKG9i\naiA9PSBudWxsKQ0KICAgICAgICAgICAgcmV0dXJuIG51bGw7DQogICAgICAg\nIHN3aXRjaCAoSmF2YVR5cGVzLmdldFR5cGVDb2RlKG9iai5nZXRDbGFzcygp\nKSkgew0KICAgICAgICAgICAgY2FzZSBKYXZhVHlwZXMuU1RSSU5HOg0KICAg\nICAgICAgICAgY2FzZSBKYXZhVHlwZXMuQk9PTEVBTl9PQko6DQogICAgICAg\nICAgICBjYXNlIEphdmFUeXBlcy5CWVRFX09CSjoNCiAgICAgICAgICAgIGNh\nc2UgSmF2YVR5cGVzLkNIQVJfT0JKOg0KICAgICAgICAgICAgY2FzZSBKYXZh\nVHlwZXMuRE9VQkxFX09CSjoNCiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVz\nLkZMT0FUX09CSjoNCiAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLklOVF9P\nQko6DQogICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5MT05HX09CSjoNCiAg\nICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLlNIT1JUX09CSjoNCiAgICAgICAg\nICAgIGNhc2UgSmF2YVR5cGVzLkJJR0RFQ0lNQUw6DQogICAgICAgICAgICBj\nYXNlIEphdmFUeXBlcy5CSUdJTlRFR0VSOg0KICAgICAgICAgICAgY2FzZSBK\nYXZhVHlwZXMuT0lEOg0KICAgICAgICAgICAgICAgIHJldHVybiBvYmo7DQog\nICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5EQVRFOg0KICAgICAgICAgICAg\nICAgIHJldHVybiAoKERhdGUpIG9iaikuY2xvbmUoKTsNCiAgICAgICAgICAg\nIGNhc2UgSmF2YVR5cGVzLkxPQ0FMRToNCiAgICAgICAgICAgICAgICByZXR1\ncm4gKChMb2NhbGUpIG9iaikuY2xvbmUoKTsNCiAgICAgICAgICAgIGRlZmF1\nbHQ6DQogICAgICAgICAgICAgICAgaWYgKG9iaiBpbnN0YW5jZW9mIENhY2hl\nZE9iamVjdElkKQ0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gZnJvbU9i\namVjdElkKCgoQ2FjaGVkT2JqZWN0SWQpIG9iaikub2lkLCBjdHgpOw0KICAg\nICAgICAgICAgICAgIE9iamVjdCBvaWQgPSBjdHguZ2V0T2JqZWN0SWQob2Jq\nKTsNCiAgICAgICAgICAgICAgICBpZiAob2lkICE9IG51bGwpDQogICAgICAg\nICAgICAgICAgICAgIHJldHVybiBuZXcgQ2FjaGVkT2JqZWN0SWQob2lkKTsN\nCiAgICAgICAgICAgICAgICByZXR1cm4gb2JqOw0KICAgICAgICB9DQogICAg\nfQ0KDQogICAgLyoqDQogICAgICogUmV0dXJuIHRoZSByZXN1bHQgb2JqZWN0\nIGJhc2VkIG9uIGl0cyBjYWNoZWQgb2lkLg0KICAgICAqLw0KICAgIHByaXZh\ndGUgc3RhdGljIE9iamVjdCBmcm9tT2JqZWN0SWQoT2JqZWN0IG9pZCwgU3Rv\ncmVDb250ZXh0IHNjdHgpIHsNCiAgICAgICAgaWYgKG9pZCA9PSBudWxsKQ0K\nICAgICAgICAgICAgcmV0dXJuIG51bGw7DQoNCiAgICAgICAgT2JqZWN0IG9i\naiA9IHNjdHguZmluZChvaWQsIG51bGwsIG51bGwsIG51bGwsIDApOw0KICAg\nICAgICBpZiAob2JqID09IG51bGwpDQogICAgICAgICAgICB0aHJvdyBuZXcg\nT2JqZWN0Tm90Rm91bmRFeGNlcHRpb24ob2lkKTsNCiAgICAgICAgcmV0dXJu\nIG9iajsNCiAgICB9DQoNCiAgICBwdWJsaWMgT2JqZWN0IHdyaXRlUmVwbGFj\nZSgpDQogICAgICAgIHRocm93cyBPYmplY3RTdHJlYW1FeGNlcHRpb24gew0K\nICAgICAgICByZXR1cm4gX3F1ZXJ5Ow0KICAgIH0NCg0KICAgIHB1YmxpYyBR\ndWVyeUNvbnRleHQgZ2V0Q29udGV4dCgpIHsNCiAgICAgICAgcmV0dXJuIF9x\ndWVyeS5nZXRDb250ZXh0KCk7DQogICAgfQ0KDQogICAgcHVibGljIHZvaWQg\nc2V0Q29udGV4dChRdWVyeUNvbnRleHQgcWN0eCkgew0KICAgICAgICBfcXVl\ncnkuc2V0Q29udGV4dChxY3R4KTsNCiAgICAgICAgX3NjdHggPSBxY3R4Lmdl\ndFN0b3JlQ29udGV4dCgpOw0KICAgICAgICBfcmVwb3MgPSBfc2N0eC5nZXRD\nb25maWd1cmF0aW9uKCkuZ2V0TWV0YURhdGFSZXBvc2l0b3J5SW5zdGFuY2Uo\nKTsNCiAgICB9DQoNCiAgICBwdWJsaWMgYm9vbGVhbiBzZXRRdWVyeShPYmpl\nY3QgcXVlcnkpIHsNCiAgICAgICAgcmV0dXJuIF9xdWVyeS5zZXRRdWVyeShx\ndWVyeSk7DQogICAgfQ0KDQogICAgcHVibGljIEZpbHRlckxpc3RlbmVyIGdl\ndEZpbHRlckxpc3RlbmVyKFN0cmluZyB0YWcpIHsNCiAgICAgICAgcmV0dXJu\nIF9xdWVyeS5nZXRGaWx0ZXJMaXN0ZW5lcih0YWcpOw0KICAgIH0NCg0KICAg\nIHB1YmxpYyBBZ2dyZWdhdGVMaXN0ZW5lciBnZXRBZ2dyZWdhdGVMaXN0ZW5l\ncihTdHJpbmcgdGFnKSB7DQogICAgICAgIHJldHVybiBfcXVlcnkuZ2V0QWdn\ncmVnYXRlTGlzdGVuZXIodGFnKTsNCiAgICB9DQoNCiAgICBwdWJsaWMgT2Jq\nZWN0IG5ld0NvbXBpbGF0aW9uS2V5KCkgew0KICAgICAgICByZXR1cm4gX3F1\nZXJ5Lm5ld0NvbXBpbGF0aW9uS2V5KCk7DQogICAgfQ0KDQogICAgcHVibGlj\nIE9iamVjdCBuZXdDb21waWxhdGlvbigpIHsNCiAgICAgICAgcmV0dXJuIF9x\ndWVyeS5uZXdDb21waWxhdGlvbigpOw0KICAgIH0NCg0KICAgIHB1YmxpYyB2\nb2lkIHBvcHVsYXRlRnJvbUNvbXBpbGF0aW9uKE9iamVjdCBjb21wKSB7DQog\nICAgICAgIF9xdWVyeS5wb3B1bGF0ZUZyb21Db21waWxhdGlvbihjb21wKTsN\nCiAgICB9DQoNCiAgICBwdWJsaWMgdm9pZCBpbnZhbGlkYXRlQ29tcGlsYXRp\nb24oKSB7DQogICAgICAgIF9xdWVyeS5pbnZhbGlkYXRlQ29tcGlsYXRpb24o\nKTsNCiAgICB9DQoNCiAgICBwdWJsaWMgYm9vbGVhbiBzdXBwb3J0c0RhdGFT\ndG9yZUV4ZWN1dGlvbigpIHsNCiAgICAgICAgcmV0dXJuIF9xdWVyeS5zdXBw\nb3J0c0RhdGFTdG9yZUV4ZWN1dGlvbigpOw0KICAgIH0NCg0KICAgIHB1Ymxp\nYyBib29sZWFuIHN1cHBvcnRzSW5NZW1vcnlFeGVjdXRpb24oKSB7DQogICAg\nICAgIHJldHVybiBfcXVlcnkuc3VwcG9ydHNJbk1lbW9yeUV4ZWN1dGlvbigp\nOw0KICAgIH0NCg0KICAgIHB1YmxpYyBFeGVjdXRvciBuZXdJbk1lbW9yeUV4\nZWN1dG9yKENsYXNzTWV0YURhdGEgbWV0YSwgYm9vbGVhbiBzdWJzKSB7DQog\nICAgICAgIHJldHVybiBfcXVlcnkubmV3SW5NZW1vcnlFeGVjdXRvcihtZXRh\nLCBzdWJzKTsNCiAgICB9DQoNCiAgICBwdWJsaWMgRXhlY3V0b3IgbmV3RGF0\nYVN0b3JlRXhlY3V0b3IoQ2xhc3NNZXRhRGF0YSBtZXRhLCBib29sZWFuIHN1\nYnMpIHsNCiAgICAgICAgRXhlY3V0b3IgZXggPSBfcXVlcnkubmV3RGF0YVN0\nb3JlRXhlY3V0b3IobWV0YSwgc3Vicyk7DQogICAgICAgIHJldHVybiBuZXcg\nUXVlcnlDYWNoZUV4ZWN1dG9yKGV4LCBtZXRhLCBzdWJzKTsNCiAgICB9DQoN\nCiAgICBwdWJsaWMgYm9vbGVhbiBzdXBwb3J0c0Fic3RyYWN0RXhlY3V0b3Jz\nKCkgew0KICAgICAgICByZXR1cm4gX3F1ZXJ5LnN1cHBvcnRzQWJzdHJhY3RF\neGVjdXRvcnMoKTsNCiAgICB9DQoNCiAgICBwdWJsaWMgYm9vbGVhbiByZXF1\naXJlc0NhbmRpZGF0ZVR5cGUoKSB7DQogICAgICAgIHJldHVybiBfcXVlcnku\ncmVxdWlyZXNDYW5kaWRhdGVUeXBlKCk7DQogICAgfQ0KDQogICAgcHVibGlj\nIGJvb2xlYW4gcmVxdWlyZXNQYXJhbWV0ZXJEZWNsYXJhdGlvbnMoKSB7DQog\nICAgICAgIHJldHVybiBfcXVlcnkucmVxdWlyZXNQYXJhbWV0ZXJEZWNsYXJh\ndGlvbnMoKTsNCiAgICB9DQoNCiAgICBwdWJsaWMgYm9vbGVhbiBzdXBwb3J0\nc1BhcmFtZXRlckRlY2xhcmF0aW9ucygpIHsNCiAgICAgICAgcmV0dXJuIF9x\ndWVyeS5zdXBwb3J0c1BhcmFtZXRlckRlY2xhcmF0aW9ucygpOw0KICAgIH0N\nCiANCiAgICBwdWJsaWMgT2JqZWN0IGV2YWx1YXRlKE9iamVjdCB2YWx1ZSwg\nT2JqZWN0IG9iLCBPYmplY3RbXSBwYXJhbXMsDQogICAgICAgIE9wZW5KUEFT\ndGF0ZU1hbmFnZXIgc20pIHsNCiAgICAgICAgcmV0dXJuIF9xdWVyeS5ldmFs\ndWF0ZSh2YWx1ZSwgb2IsIHBhcmFtcywgc20pOyAgICAgICAgIA0KICAgIH0N\nCg0KICAgIC8qKg0KICAgICAqIENhY2hpbmcgZXhlY3V0b3IuDQogICAgICov\nDQogICAgcHJpdmF0ZSBzdGF0aWMgY2xhc3MgUXVlcnlDYWNoZUV4ZWN1dG9y\nDQogICAgICAgIGltcGxlbWVudHMgRXhlY3V0b3Igew0KDQogICAgICAgIHBy\naXZhdGUgZmluYWwgRXhlY3V0b3IgX2V4Ow0KICAgICAgICBwcml2YXRlIGZp\nbmFsIENsYXNzIF9jYW5kaWRhdGU7DQogICAgICAgIHByaXZhdGUgZmluYWwg\nYm9vbGVhbiBfc3ViczsNCg0KICAgICAgICBwdWJsaWMgUXVlcnlDYWNoZUV4\nZWN1dG9yKEV4ZWN1dG9yIGV4LCBDbGFzc01ldGFEYXRhIG1ldGEsDQogICAg\nICAgICAgICBib29sZWFuIHN1YnMpIHsNCiAgICAgICAgICAgIF9leCA9IGV4\nOw0KICAgICAgICAgICAgX2NhbmRpZGF0ZSA9IChtZXRhID09IG51bGwpID8g\nbnVsbCA6IG1ldGEuZ2V0RGVzY3JpYmVkVHlwZSgpOw0KICAgICAgICAgICAg\nX3N1YnMgPSBzdWJzOw0KICAgICAgICB9DQoNCiAgICAgICAgcHVibGljIFJl\nc3VsdE9iamVjdFByb3ZpZGVyIGV4ZWN1dGVRdWVyeShTdG9yZVF1ZXJ5IHEs\nIE9iamVjdFtdIHBhcmFtcywNCiAgICAgICAgICAgIFJhbmdlIHJhbmdlKSB7\nDQogICAgICAgICAgICBRdWVyeUNhY2hlU3RvcmVRdWVyeSBjcSA9IChRdWVy\neUNhY2hlU3RvcmVRdWVyeSkgcTsNCiAgICAgICAgICAgIFF1ZXJ5S2V5IGtl\neSA9IFF1ZXJ5S2V5Lm5ld0luc3RhbmNlKGNxLmdldENvbnRleHQoKSwNCiAg\nICAgICAgICAgICAgICBfZXguaXNQYWNraW5nKHEpLCBwYXJhbXMsIF9jYW5k\naWRhdGUsIF9zdWJzLCByYW5nZS5zdGFydCwgDQogICAgICAgICAgICAgICAg\ncmFuZ2UuZW5kKTsNCiAgICAgICAgICAgIExpc3QgY2FjaGVkID0gY3EuY2hl\nY2tDYWNoZShrZXkpOw0KICAgICAgICAgICAgaWYgKGNhY2hlZCAhPSBudWxs\nKQ0KICAgICAgICAgICAgICAgIHJldHVybiBuZXcgTGlzdFJlc3VsdE9iamVj\ndFByb3ZpZGVyKGNhY2hlZCk7DQoNCiAgICAgICAgICAgIFJlc3VsdE9iamVj\ndFByb3ZpZGVyIHJvcCA9IF9leC5leGVjdXRlUXVlcnkoY3EuZ2V0RGVsZWdh\ndGUoKSwNCiAgICAgICAgICAgICAgICBwYXJhbXMsIHJhbmdlKTsNCiAgICAg\nICAgICAgIHJldHVybiBjcS53cmFwUmVzdWx0KHJvcCwga2V5KTsNCiAgICAg\nICAgfQ0KDQogICAgICAgIC8qKg0KICAgICAgICAgKiBDbGVhciB0aGUgY2Fj\naGVkIHF1ZXJpZXMgYXNzb2NpYXRlZCB3aXRoIHRoZSBhY2Nlc3MgcGF0aA0K\nICAgICAgICAgKiBjbGFzc2VzIGluIHRoZSBxdWVyeS4gVGhpcyBpcyBkb25l\nIHdoZW4gYnVsayBvcGVyYXRpb25zDQogICAgICAgICAqIChzdWNoIGFzIGRl\nbGV0ZXMgb3IgdXBkYXRlcykgYXJlIHBlcmZvcm1lZCBzbyB0aGF0IHRoZQ0K\nICAgICAgICAgKiBjYWNoZSByZW1haW5zIHVwLXRvLWRhdGUuDQogICAgICAg\nICAqLw0KICAgICAgICBwcml2YXRlIHZvaWQgY2xlYXJBY2Nlc3NQYXRoKFN0\nb3JlUXVlcnkgcSkgew0KICAgICAgICAgICAgaWYgKHEgPT0gbnVsbCkNCiAg\nICAgICAgICAgICAgICByZXR1cm47DQoNCiAgICAgICAgICAgIENsYXNzTWV0\nYURhdGFbXSBjbWQgPSBnZXRBY2Nlc3NQYXRoTWV0YURhdGFzKHEpOw0KICAg\nICAgICAgICAgaWYgKGNtZCA9PSBudWxsIHx8IGNtZC5sZW5ndGggPT0gMCkN\nCiAgICAgICAgICAgICAgICByZXR1cm47DQoNCiAgICAgICAgICAgIExpc3Qg\nY2xhc3NlcyA9IG5ldyBBcnJheUxpc3QoY21kLmxlbmd0aCk7DQogICAgICAg\nICAgICBmb3IgKGludCBpID0gMDsgaSA8IGNtZC5sZW5ndGg7IGkrKykNCiAg\nICAgICAgICAgICAgICBjbGFzc2VzLmFkZChjbWRbaV0uZ2V0RGVzY3JpYmVk\nVHlwZSgpKTsNCg0KICAgICAgICAgICAgLy8gZXZpY3QgZnJvbSB0aGUgcXVl\ncnkgY2FjaGUNCiAgICAgICAgICAgIFF1ZXJ5Q2FjaGVTdG9yZVF1ZXJ5IGNx\nID0gKFF1ZXJ5Q2FjaGVTdG9yZVF1ZXJ5KSBxOw0KICAgICAgICAgICAgY3Eu\nZ2V0Q2FjaGUoKS5vblR5cGVzQ2hhbmdlZChuZXcgVHlwZXNDaGFuZ2VkRXZl\nbnQNCiAgICAgICAgICAgICAgICAocS5nZXRDb250ZXh0KCksIGNsYXNzZXMp\nKTsNCg0KICAgICAgICAgICAgLy8gZXZpY3QgZnJvbSB0aGUgZGF0YSBjYWNo\nZQ0KICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBjbWQubGVuZ3Ro\nOyBpKyspIHsNCiAgICAgICAgICAgICAgICBpZiAoY21kW2ldLmdldERhdGFD\nYWNoZSgpICE9IG51bGwpDQogICAgICAgICAgICAgICAgICAgIGNtZFtpXS5n\nZXREYXRhQ2FjaGUoKS5yZW1vdmVBbGwoDQogICAgICAgICAgICAgICAgICAg\nICAgICBjbWRbaV0uZ2V0RGVzY3JpYmVkVHlwZSgpLCB0cnVlKTsNCiAgICAg\nICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIHB1YmxpYyBOdW1iZXIg\nZXhlY3V0ZURlbGV0ZShTdG9yZVF1ZXJ5IHEsIE9iamVjdFtdIHBhcmFtcykg\new0KICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgICByZXR1cm4g\nX2V4LmV4ZWN1dGVEZWxldGUodW53cmFwKHEpLCBwYXJhbXMpOw0KICAgICAg\nICAgICAgfSBmaW5hbGx5IHsNCiAgICAgICAgICAgICAgICBjbGVhckFjY2Vz\nc1BhdGgocSk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAg\nICBwdWJsaWMgTnVtYmVyIGV4ZWN1dGVVcGRhdGUoU3RvcmVRdWVyeSBxLCBP\nYmplY3RbXSBwYXJhbXMpIHsNCiAgICAgICAgICAgIHRyeSB7DQogICAgICAg\nICAgICAgICAgcmV0dXJuIF9leC5leGVjdXRlVXBkYXRlKHVud3JhcChxKSwg\ncGFyYW1zKTsNCiAgICAgICAgICAgIH0gZmluYWxseSB7DQogICAgICAgICAg\nICAgICAgY2xlYXJBY2Nlc3NQYXRoKHEpOw0KICAgICAgICAgICAgfQ0KICAg\nICAgICB9DQoNCiAgICAgICAgcHVibGljIFN0cmluZ1tdIGdldERhdGFTdG9y\nZUFjdGlvbnMoU3RvcmVRdWVyeSBxLCBPYmplY3RbXSBwYXJhbXMsDQogICAg\nICAgICAgICBSYW5nZSByYW5nZSkgew0KICAgICAgICAgICAgcmV0dXJuIEVN\nUFRZX1NUUklOR1M7DQogICAgICAgIH0NCg0KICAgICAgICBwdWJsaWMgdm9p\nZCB2YWxpZGF0ZShTdG9yZVF1ZXJ5IHEpIHsNCiAgICAgICAgICAgIF9leC52\nYWxpZGF0ZSh1bndyYXAocSkpOw0KICAgICAgICB9DQogICAgICAgIA0KICAg\nICAgICBwdWJsaWMgdm9pZCBnZXRSYW5nZShTdG9yZVF1ZXJ5IHEsIE9iamVj\ndFtdIHBhcmFtcywgUmFuZ2UgcmFuZ2UpIHsNCiAgICAgICAgICAgIF9leC5n\nZXRSYW5nZShxLCBwYXJhbXMsIHJhbmdlKTsgDQogICAgICAgIH0NCg0KICAg\nICAgICBwdWJsaWMgT2JqZWN0IGdldE9yZGVyaW5nVmFsdWUoU3RvcmVRdWVy\neSBxLCBPYmplY3RbXSBwYXJhbXMsDQogICAgICAgICAgICBPYmplY3QgcmVz\ndWx0T2JqZWN0LCBpbnQgb3JkZXJJbmRleCkgew0KICAgICAgICAgICAgcmV0\ndXJuIF9leC5nZXRPcmRlcmluZ1ZhbHVlKHVud3JhcChxKSwgcGFyYW1zLCBy\nZXN1bHRPYmplY3QsDQogICAgICAgICAgICAgICAgb3JkZXJJbmRleCk7DQog\nICAgICAgIH0NCg0KICAgICAgICBwdWJsaWMgYm9vbGVhbltdIGdldEFzY2Vu\nZGluZyhTdG9yZVF1ZXJ5IHEpIHsNCiAgICAgICAgICAgIHJldHVybiBfZXgu\nZ2V0QXNjZW5kaW5nKHVud3JhcChxKSk7DQogICAgICAgIH0NCg0KICAgICAg\nICBwdWJsaWMgYm9vbGVhbiBpc1BhY2tpbmcoU3RvcmVRdWVyeSBxKSB7DQog\nICAgICAgICAgICByZXR1cm4gX2V4LmlzUGFja2luZyh1bndyYXAocSkpOw0K\nICAgICAgICB9DQoNCiAgICAgICAgcHVibGljIFN0cmluZyBnZXRBbGlhcyhT\ndG9yZVF1ZXJ5IHEpIHsNCiAgICAgICAgICAgIHJldHVybiBfZXguZ2V0QWxp\nYXModW53cmFwKHEpKTsNCiAgICAgICAgfQ0KDQogICAgICAgIHB1YmxpYyBD\nbGFzcyBnZXRSZXN1bHRDbGFzcyhTdG9yZVF1ZXJ5IHEpIHsNCiAgICAgICAg\nICAgIHJldHVybiBfZXguZ2V0UmVzdWx0Q2xhc3ModW53cmFwKHEpKTsNCiAg\nICAgICAgfQ0KDQogICAgICAgIHB1YmxpYyBTdHJpbmdbXSBnZXRQcm9qZWN0\naW9uQWxpYXNlcyhTdG9yZVF1ZXJ5IHEpIHsNCiAgICAgICAgICAgIHJldHVy\nbiBfZXguZ2V0UHJvamVjdGlvbkFsaWFzZXModW53cmFwKHEpKTsNCiAgICAg\nICAgfQ0KDQogICAgICAgIHB1YmxpYyBDbGFzc1tdIGdldFByb2plY3Rpb25U\neXBlcyhTdG9yZVF1ZXJ5IHEpIHsNCiAgICAgICAgICAgIHJldHVybiBfZXgu\nZ2V0UHJvamVjdGlvblR5cGVzKHVud3JhcChxKSk7DQogICAgICAgIH0NCg0K\nICAgICAgICBwdWJsaWMgQ2xhc3NNZXRhRGF0YVtdIGdldEFjY2Vzc1BhdGhN\nZXRhRGF0YXMoU3RvcmVRdWVyeSBxKSB7DQogICAgICAgICAgICByZXR1cm4g\nX2V4LmdldEFjY2Vzc1BhdGhNZXRhRGF0YXModW53cmFwKHEpKTsNCiAgICAg\nICAgfQ0KDQogICAgICAgIHB1YmxpYyBpbnQgZ2V0T3BlcmF0aW9uKFN0b3Jl\nUXVlcnkgcSkgew0KICAgICAgICAgICAgcmV0dXJuIF9leC5nZXRPcGVyYXRp\nb24odW53cmFwKHEpKTsNCiAgICAgICAgfQ0KDQogICAgICAgIHB1YmxpYyBi\nb29sZWFuIGlzQWdncmVnYXRlKFN0b3JlUXVlcnkgcSkgew0KICAgICAgICAg\nICAgcmV0dXJuIF9leC5pc0FnZ3JlZ2F0ZSh1bndyYXAocSkpOw0KICAgICAg\nICB9DQoNCiAgICAgICAgcHVibGljIGJvb2xlYW4gaGFzR3JvdXBpbmcoU3Rv\ncmVRdWVyeSBxKSB7DQogICAgICAgICAgICByZXR1cm4gX2V4Lmhhc0dyb3Vw\naW5nKHVud3JhcChxKSk7DQogICAgICAgIH0NCg0KICAgICAgICBwdWJsaWMg\nTGlua2VkTWFwIGdldFBhcmFtZXRlclR5cGVzKFN0b3JlUXVlcnkgcSkgew0K\nICAgICAgICAgICAgcmV0dXJuIF9leC5nZXRQYXJhbWV0ZXJUeXBlcyh1bndy\nYXAocSkpOw0KICAgICAgICB9DQoNCiAgICAgICAgcHVibGljIE1hcCBnZXRV\ncGRhdGVzKFN0b3JlUXVlcnkgcSkgew0KICAgICAgICAgICAgcmV0dXJuIF9l\neC5nZXRVcGRhdGVzKHVud3JhcChxKSk7DQogICAgICAgIH0NCg0KICAgICAg\nICBwcml2YXRlIHN0YXRpYyBTdG9yZVF1ZXJ5IHVud3JhcChTdG9yZVF1ZXJ5\nIHEpIHsNCiAgICAgICAgICAgIHJldHVybiAoKFF1ZXJ5Q2FjaGVTdG9yZVF1\nZXJ5KSBxKS5nZXREZWxlZ2F0ZSgpOw0KICAgICAgICB9DQogICAgfQ0KDQog\nICAgLyoqDQogICAgICogUmVzdWx0IGxpc3QgaW1wbGVtZW50YXRpb24gZm9y\nIGEgY2FjaGVkIHF1ZXJ5IHJlc3VsdC4gUGFja2FnZS1wcm90ZWN0ZWQNCiAg\nICAgKiBmb3IgdGVzdGluZy4NCiAgICAgKi8NCiAgICBwdWJsaWMgc3RhdGlj\nIGNsYXNzIENhY2hlZExpc3QNCiAgICAgICAgZXh0ZW5kcyBBYnN0cmFjdExp\nc3QNCiAgICAgICAgaW1wbGVtZW50cyBTZXJpYWxpemFibGUgew0KDQogICAg\nICAgIHByaXZhdGUgZmluYWwgUXVlcnlSZXN1bHQgX3JlczsNCiAgICAgICAg\ncHJpdmF0ZSBmaW5hbCBib29sZWFuIF9wcm9qOw0KICAgICAgICBwcml2YXRl\nIGZpbmFsIFN0b3JlQ29udGV4dCBfc2N0eDsNCg0KICAgICAgICBwdWJsaWMg\nQ2FjaGVkTGlzdChRdWVyeVJlc3VsdCByZXMsIGJvb2xlYW4gcHJvaiwgU3Rv\ncmVDb250ZXh0IGN0eCkgew0KICAgICAgICAgICAgX3JlcyA9IHJlczsNCiAg\nICAgICAgICAgIF9wcm9qID0gcHJvajsNCiAgICAgICAgICAgIF9zY3R4ID0g\nY3R4Ow0KICAgICAgICB9DQoNCiAgICAgICAgcHVibGljIE9iamVjdCBnZXQo\naW50IGlkeCkgew0KICAgICAgICAgICAgaWYgKCFfcHJvaikNCiAgICAgICAg\nICAgICAgICByZXR1cm4gZnJvbU9iamVjdElkKF9yZXMuZ2V0KGlkeCksIF9z\nY3R4KTsNCg0KICAgICAgICAgICAgT2JqZWN0W10gY2FjaGVkID0gKE9iamVj\ndFtdKSBfcmVzLmdldChpZHgpOw0KICAgICAgICAgICAgaWYgKGNhY2hlZCA9\nPSBudWxsKQ0KICAgICAgICAgICAgICAgIHJldHVybiBudWxsOw0KICAgICAg\nICAgICAgT2JqZWN0W10gdW5jYWNoZWQgPSBuZXcgT2JqZWN0W2NhY2hlZC5s\nZW5ndGhdOw0KICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBjYWNo\nZWQubGVuZ3RoOyBpKyspDQogICAgICAgICAgICAgICAgdW5jYWNoZWRbaV0g\nPSBjb3B5UHJvamVjdGlvbihjYWNoZWRbaV0sIF9zY3R4KTsNCiAgICAgICAg\nICAgIHJldHVybiB1bmNhY2hlZDsNCiAgICAgICAgfQ0KDQogICAgICAgIHB1\nYmxpYyBpbnQgc2l6ZSgpIHsNCiAgICAgICAgICAgIHJldHVybiBfcmVzLnNp\nemUoKTsNCiAgICAgICAgfQ0KDQogICAgICAgIHB1YmxpYyBPYmplY3Qgd3Jp\ndGVSZXBsYWNlKCkNCiAgICAgICAgICAgIHRocm93cyBPYmplY3RTdHJlYW1F\neGNlcHRpb24gew0KICAgICAgICAgICAgcmV0dXJuIG5ldyBBcnJheUxpc3Qo\ndGhpcyk7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiBB\nIHdyYXBwZXIgYXJvdW5kIGEge0BsaW5rIFJlc3VsdE9iamVjdFByb3ZpZGVy\nfSB0aGF0IGJ1aWxkcyB1cCBhIGxpc3Qgb2YNCiAgICAgKiBhbGwgdGhlIE9J\nRHMgaW4gdGhpcyBsaXN0IGFuZCByZWdpc3RlcnMgdGhhdCBsaXN0IHdpdGgg\ndGhlDQogICAgICogcXVlcnkgY2FjaGUuIEFiYW5kb25zIG1vbml0b3Jpbmcg\nYW5kIHJlZ2lzdGVyaW5nIGlmIG9uZSBvZiB0aGUgY2xhc3Nlcw0KICAgICAq\nIGluIHRoZSBhY2Nlc3MgcGF0aCBpcyBtb2RpZmllZCB3aGlsZSB0aGUgcXVl\ncnkgcmVzdWx0cyBhcmUgYmVpbmcgbG9hZGVkLg0KICAgICAqLw0KICAgIHBy\naXZhdGUgY2xhc3MgQ2FjaGluZ1Jlc3VsdE9iamVjdFByb3ZpZGVyDQogICAg\nICAgIGltcGxlbWVudHMgUmVzdWx0T2JqZWN0UHJvdmlkZXIsIFR5cGVzQ2hh\nbmdlZExpc3RlbmVyIHsNCg0KICAgICAgICBwcml2YXRlIGZpbmFsIFJlc3Vs\ndE9iamVjdFByb3ZpZGVyIF9yb3A7DQogICAgICAgIHByaXZhdGUgZmluYWwg\nYm9vbGVhbiBfcHJvajsNCiAgICAgICAgcHJpdmF0ZSBmaW5hbCBRdWVyeUtl\neSBfcWs7DQogICAgICAgIHByaXZhdGUgZmluYWwgVHJlZU1hcCBfZGF0YSA9\nIG5ldyBUcmVlTWFwKCk7DQogICAgICAgIHByaXZhdGUgYm9vbGVhbiBfbWFp\nbnRhaW5DYWNoZSA9IHRydWU7DQogICAgICAgIHByaXZhdGUgaW50IF9wb3Mg\nPSAtMTsNCg0KICAgICAgICAvLyB1c2VkIHRvIGRldGVybWluZSBsaXN0IHNp\nemUgd2l0aG91dCBuZWNlc3NhcmlseSBjYWxsaW5nIHNpemUoKSwNCiAgICAg\nICAgLy8gd2hpY2ggbWF5IHJlcXVpcmUgYSBEQiB0cmlwIG9yIHJldHVybiBJ\nbnRlZ2VyLk1BWF9WQUxVRQ0KICAgICAgICBwcml2YXRlIGludCBfbWF4ID0g\nLTE7DQogICAgICAgIHByaXZhdGUgaW50IF9zaXplID0gSW50ZWdlci5NQVhf\nVkFMVUU7DQoNCiAgICAgICAgLyoqDQogICAgICAgICAqIENvbnN0cnVjdG9y\nLiBTdXBwbHkgZGVsZWdhdGUgcmVzdWx0IHByb3ZpZGVyIGFuZCBvdXIgcXVl\ncnkga2V5Lg0KICAgICAgICAgKi8NCiAgICAgICAgcHVibGljIENhY2hpbmdS\nZXN1bHRPYmplY3RQcm92aWRlcihSZXN1bHRPYmplY3RQcm92aWRlciByb3As\nDQogICAgICAgICAgICBib29sZWFuIHByb2osIFF1ZXJ5S2V5IGtleSkgew0K\nICAgICAgICAgICAgX3JvcCA9IHJvcDsNCiAgICAgICAgICAgIF9wcm9qID0g\ncHJvajsNCiAgICAgICAgICAgIF9xayA9IGtleTsNCiAgICAgICAgICAgIF9j\nYWNoZS5hZGRUeXBlc0NoYW5nZWRMaXN0ZW5lcih0aGlzKTsNCiAgICAgICAg\nfQ0KDQogICAgICAgIC8qKg0KICAgICAgICAgKiBTdG9wIGNhY2hpbmcuDQog\nICAgICAgICAqLw0KICAgICAgICBwcml2YXRlIHZvaWQgYWJvcnRDYWNoaW5n\nKCkgew0KICAgICAgICAgICAgaWYgKCFfbWFpbnRhaW5DYWNoZSkNCiAgICAg\nICAgICAgICAgICByZXR1cm47DQoNCiAgICAgICAgICAgIC8vIHRoaXMgY2Fu\nIGJlIGNhbGxlZCB2aWEgYW4gZXZlbnQgZnJvbSBhbm90aGVyIHRocmVhZA0K\nICAgICAgICAgICAgc3luY2hyb25pemVkICh0aGlzKSB7DQogICAgICAgICAg\nICAgICAgLy8gaXQncyBpbXBvcnRhbnQgdGhhdCB3ZSBzZXQgdGhpcyBmbGFn\nIGZpcnN0IHNvIHRoYXQgYW55DQogICAgICAgICAgICAgICAgLy8gc3Vic2Vx\ndWVudCBjYWxscyB0byB0aGlzIG9iamVjdCBhcmUgYnlwYXNzZWQuDQogICAg\nICAgICAgICAgICAgX21haW50YWluQ2FjaGUgPSBmYWxzZTsNCiAgICAgICAg\nICAgICAgICBfY2FjaGUucmVtb3ZlVHlwZXNDaGFuZ2VkTGlzdGVuZXIodGhp\ncyk7DQogICAgICAgICAgICAgICAgX2RhdGEuY2xlYXIoKTsNCiAgICAgICAg\nICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIC8qKg0KICAgICAgICAgKiBD\naGVjayB3aGV0aGVyIHdlJ3ZlIGJ1ZmZlcmVkIGFsbCByZXN1bHRzLCB3aGls\nZSBvcHRpb25hbGx5IGFkZGluZw0KICAgICAgICAgKiB0aGUgZ2l2ZW4gcmVz\ndWx0Lg0KICAgICAgICAgKi8NCiAgICAgICAgcHJpdmF0ZSB2b2lkIGNoZWNr\nRmluaXNoZWQoT2JqZWN0IG9iaiwgYm9vbGVhbiByZXN1bHQpIHsNCiAgICAg\nICAgICAgIC8vIHRoaXMgY2FuIGJlIGNhbGxlZCBhdCB0aGUgc2FtZSB0aW1l\nIGFzIGFib3J0Q2FjaGluZyB2aWENCiAgICAgICAgICAgIC8vIGEgdHlwZXMg\nY2hhbmdlZCBldmVudA0KICAgICAgICAgICAgYm9vbGVhbiBmaW5pc2hlZCA9\nIGZhbHNlOw0KICAgICAgICAgICAgc3luY2hyb25pemVkICh0aGlzKSB7DQog\nICAgICAgICAgICAgICAgaWYgKF9tYWludGFpbkNhY2hlKSB7DQogICAgICAg\nICAgICAgICAgICAgIGlmIChyZXN1bHQpIHsNCiAgICAgICAgICAgICAgICAg\nICAgICAgIEludGVnZXIgaW5kZXggPSBOdW1iZXJzLnZhbHVlT2YoX3Bvcyk7\nDQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIV9kYXRhLmNvbnRhaW5z\nS2V5KGluZGV4KSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIE9i\namVjdCBjYWNoZWQ7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYg\nKG9iaiA9PSBudWxsKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICBjYWNoZWQgPSBudWxsOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAg\nIGVsc2UgaWYgKCFfcHJvaikNCiAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgY2FjaGVkID0gX3NjdHguZ2V0T2JqZWN0SWQob2JqKTsNCiAgICAg\nICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsNCiAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgT2JqZWN0W10gYXJyID0gKE9iamVjdFtdKSBv\nYmo7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE9iamVjdFtd\nIGNwID0gbmV3IE9iamVjdFthcnIubGVuZ3RoXTsNCiAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBhcnIubGVu\nZ3RoOyBpKyspDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICBjcFtpXSA9IGNvcHlQcm9qZWN0aW9uKGFycltpXSwgX3NjdHgpOw0KICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWNoZWQgPSBjcDsNCiAg\nICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAg\nICAgICAgICAgICAgaWYgKGNhY2hlZCAhPSBudWxsKQ0KICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICBfZGF0YS5wdXQoaW5kZXgsIGNhY2hlZCk7\nDQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAg\nICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZmluaXNoZWQgPSBfc2l6ZSA9\nPSBfZGF0YS5zaXplKCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAg\nICAgfQ0KDQogICAgICAgICAgICBpZiAoZmluaXNoZWQpIHsNCiAgICAgICAg\nICAgICAgICAvLyBhbiBhYm9ydENhY2hpbmcgY2FsbCBjYW4gc25lYWsgaW4g\naGVyZSB2aWEgb25FeHBpcmU7IHRoZQ0KICAgICAgICAgICAgICAgIC8vIGNh\nY2hlIGlzIGxvY2tlZCBkdXJpbmcgZXZlbnQgZmlyaW5ncywgc28gdGhlIGxv\nY2sgaGVyZSB3aWxsDQogICAgICAgICAgICAgICAgLy8gd2FpdCBmb3IgaXQg\nKG9yIHdpbGwgZm9yY2UgdGhlIG5leHQgZmlyaW5nIHRvIHdhaXQpDQogICAg\nICAgICAgICAgICAgX2NhY2hlLndyaXRlTG9jaygpOw0KICAgICAgICAgICAg\nICAgIHRyeSB7DQogICAgICAgICAgICAgICAgICAgIC8vIG1ha2Ugc3VyZSB3\nZSBkaWRuJ3QgYWJvcnQNCiAgICAgICAgICAgICAgICAgICAgaWYgKF9tYWlu\ndGFpbkNhY2hlKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBRdWVyeVJl\nc3VsdCByZXMgPSBudWxsOw0KICAgICAgICAgICAgICAgICAgICAgICAgc3lu\nY2hyb25pemVkICh0aGlzKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAg\nICAgcmVzID0gbmV3IFF1ZXJ5UmVzdWx0KF9xaywgX2RhdGEudmFsdWVzKCkp\nOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAg\nICAgICAgICAgX2NhY2hlLnB1dChfcWssIHJlcyk7DQogICAgICAgICAgICAg\nICAgICAgICAgICBhYm9ydENhY2hpbmcoKTsNCiAgICAgICAgICAgICAgICAg\nICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBmaW5h\nbGx5IHsNCiAgICAgICAgICAgICAgICAgICAgX2NhY2hlLndyaXRlVW5sb2Nr\nKCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAg\nICB9DQoNCiAgICAgICAgcHVibGljIGJvb2xlYW4gc3VwcG9ydHNSYW5kb21B\nY2Nlc3MoKSB7DQogICAgICAgICAgICByZXR1cm4gX3JvcC5zdXBwb3J0c1Jh\nbmRvbUFjY2VzcygpOw0KICAgICAgICB9DQoNCiAgICAgICAgcHVibGljIHZv\naWQgb3BlbigpDQogICAgICAgICAgICB0aHJvd3MgRXhjZXB0aW9uIHsNCiAg\nICAgICAgICAgIF9yb3Aub3BlbigpOw0KICAgICAgICB9DQoNCiAgICAgICAg\ncHVibGljIE9iamVjdCBnZXRSZXN1bHRPYmplY3QoKQ0KICAgICAgICAgICAg\ndGhyb3dzIEV4Y2VwdGlvbiB7DQogICAgICAgICAgICBPYmplY3Qgb2JqID0g\nX3JvcC5nZXRSZXN1bHRPYmplY3QoKTsNCiAgICAgICAgICAgIGNoZWNrRmlu\naXNoZWQob2JqLCB0cnVlKTsNCiAgICAgICAgICAgIHJldHVybiBvYmo7DQog\nICAgICAgIH0NCg0KICAgICAgICBwdWJsaWMgYm9vbGVhbiBuZXh0KCkNCiAg\nICAgICAgICAgIHRocm93cyBFeGNlcHRpb24gew0KICAgICAgICAgICAgX3Bv\ncysrOw0KICAgICAgICAgICAgYm9vbGVhbiBuZXh0ID0gX3JvcC5uZXh0KCk7\nDQogICAgICAgICAgICBpZiAoIW5leHQgJiYgX3BvcyA9PSBfbWF4ICsgMSkg\new0KICAgICAgICAgICAgICAgIF9zaXplID0gX3BvczsNCiAgICAgICAgICAg\nICAgICBjaGVja0ZpbmlzaGVkKG51bGwsIGZhbHNlKTsNCiAgICAgICAgICAg\nIH0gZWxzZSBpZiAobmV4dCAmJiBfcG9zID4gX21heCkNCiAgICAgICAgICAg\nICAgICBfbWF4ID0gX3BvczsNCiAgICAgICAgICAgIHJldHVybiBuZXh0Ow0K\nICAgICAgICB9DQoNCiAgICAgICAgcHVibGljIGJvb2xlYW4gYWJzb2x1dGUo\naW50IHBvcykNCiAgICAgICAgICAgIHRocm93cyBFeGNlcHRpb24gew0KICAg\nICAgICAgICAgX3BvcyA9IHBvczsNCiAgICAgICAgICAgIGJvb2xlYW4gdmFs\naWQgPSBfcm9wLmFic29sdXRlKHBvcyk7DQogICAgICAgICAgICBpZiAoIXZh\nbGlkICYmIF9wb3MgPT0gX21heCArIDEpIHsNCiAgICAgICAgICAgICAgICBf\nc2l6ZSA9IF9wb3M7DQogICAgICAgICAgICAgICAgY2hlY2tGaW5pc2hlZChu\ndWxsLCBmYWxzZSk7DQogICAgICAgICAgICB9IGVsc2UgaWYgKHZhbGlkICYm\nIF9wb3MgPiBfbWF4KQ0KICAgICAgICAgICAgICAgIF9tYXggPSBfcG9zOw0K\nICAgICAgICAgICAgcmV0dXJuIHZhbGlkOw0KICAgICAgICB9DQoNCiAgICAg\nICAgcHVibGljIGludCBzaXplKCkNCiAgICAgICAgICAgIHRocm93cyBFeGNl\ncHRpb24gew0KICAgICAgICAgICAgaWYgKF9zaXplICE9IEludGVnZXIuTUFY\nX1ZBTFVFKQ0KICAgICAgICAgICAgICAgIHJldHVybiBfc2l6ZTsNCiAgICAg\nICAgICAgIGludCBzaXplID0gX3JvcC5zaXplKCk7DQogICAgICAgICAgICBf\nc2l6ZSA9IHNpemU7DQogICAgICAgICAgICBjaGVja0ZpbmlzaGVkKG51bGws\nIGZhbHNlKTsNCiAgICAgICAgICAgIHJldHVybiBzaXplOw0KICAgICAgICB9\nDQoNCiAgICAgICAgcHVibGljIHZvaWQgcmVzZXQoKQ0KICAgICAgICAgICAg\ndGhyb3dzIEV4Y2VwdGlvbiB7DQogICAgICAgICAgICBfcm9wLnJlc2V0KCk7\nDQogICAgICAgICAgICBfcG9zID0gLTE7DQogICAgICAgIH0NCg0KICAgICAg\nICBwdWJsaWMgdm9pZCBjbG9zZSgpDQogICAgICAgICAgICB0aHJvd3MgRXhj\nZXB0aW9uIHsNCiAgICAgICAgICAgIGFib3J0Q2FjaGluZygpOw0KICAgICAg\nICAgICAgX3JvcC5jbG9zZSgpOw0KICAgICAgICB9DQoNCiAgICAgICAgcHVi\nbGljIHZvaWQgaGFuZGxlQ2hlY2tlZEV4Y2VwdGlvbihFeGNlcHRpb24gZSkg\new0KICAgICAgICAgICAgX3JvcC5oYW5kbGVDaGVja2VkRXhjZXB0aW9uKGUp\nOw0KICAgICAgICB9DQoNCiAgICAgICAgcHVibGljIHZvaWQgb25UeXBlc0No\nYW5nZWQoVHlwZXNDaGFuZ2VkRXZlbnQgZXYpIHsNCiAgICAgICAgICAgIGlm\nIChfcWsuY2hhbmdlSW52YWxpZGF0ZXNRdWVyeShldi5nZXRUeXBlcygpKSkN\nCiAgICAgICAgICAgICAgICBhYm9ydENhY2hpbmcoKTsNCiAgICAgICAgfQ0K\nICAgIH0NCg0KICAgIC8qKg0KICAgICAqIFN0cnVjdCB0byByZWNvZ25pemUg\nY2FjaGVkIG9pZHMuDQogICAgICovDQogICAgcHJpdmF0ZSBzdGF0aWMgY2xh\nc3MgQ2FjaGVkT2JqZWN0SWQgew0KDQogICAgICAgIHB1YmxpYyBmaW5hbCBP\nYmplY3Qgb2lkOw0KDQogICAgICAgIHB1YmxpYyBDYWNoZWRPYmplY3RJZCAo\nT2JqZWN0IG9pZCkNCgkJew0KCQkJdGhpcy5vaWQgPSBvaWQ7DQoJCX0NCgl9\nDQp9DQo=\n","encoding":"base64"}

