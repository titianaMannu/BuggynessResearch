{"sha":"123e96a3c145bcc4db5ae18b6d89ea4046682f1a","node_id":"MDQ6QmxvYjIwNjM2NDoxMjNlOTZhM2MxNDViY2M0ZGI1YWUxOGI2ZDg5ZWE0MDQ2NjgyZjFh","size":18046,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/123e96a3c145bcc4db5ae18b6d89ea4046682f1a","content":"LyoNCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUNCiAqIG9yIG1vcmUgY29udHJpYnV0b3Ig\nbGljZW5zZSBhZ3JlZW1lbnRzLiAgU2VlIHRoZSBOT1RJQ0UgZmlsZQ0KICog\nZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5m\nb3JtYXRpb24NCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAg\nVGhlIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUNCiAqIHRvIHlvdSB1bmRlciB0\naGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUNCiAqICJMaWNl\nbnNlIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNv\nbXBsaWFuY2UNCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFp\nbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQNCiAqDQogKiBodHRwOi8vd3d3\nLmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjANCiAqDQogKiBVbmxl\nc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGlu\nIHdyaXRpbmcsDQogKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUg\nTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbg0KICogIkFTIElTIiBCQVNJ\nUywgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZDQog\nKiBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBM\naWNlbnNlIGZvciB0aGUNCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmlu\nZyBwZXJtaXNzaW9ucyBhbmQgbGltaXRhdGlvbnMNCiAqIHVuZGVyIHRoZSBM\naWNlbnNlLiAgICANCiAqLw0KcGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEu\ndXRpbDsNCg0KaW1wb3J0IGphdmEudXRpbC5BYnN0cmFjdENvbGxlY3Rpb247\nDQppbXBvcnQgamF2YS51dGlsLkFic3RyYWN0U2V0Ow0KaW1wb3J0IGphdmEu\ndXRpbC5Db2xsZWN0aW9uOw0KaW1wb3J0IGphdmEudXRpbC5Db2xsZWN0aW9u\nczsNCmltcG9ydCBqYXZhLnV0aWwuSXRlcmF0b3I7DQppbXBvcnQgamF2YS51\ndGlsLk1hcDsNCmltcG9ydCBqYXZhLnV0aWwuU2V0Ow0KDQppbXBvcnQgb3Jn\nLmFwYWNoZS5jb21tb25zLmNvbGxlY3Rpb25zLlByZWRpY2F0ZTsNCmltcG9y\ndCBvcmcuYXBhY2hlLmNvbW1vbnMuY29sbGVjdGlvbnMuaXRlcmF0b3JzLkZp\nbHRlckl0ZXJhdG9yOw0KaW1wb3J0IG9yZy5hcGFjaGUuY29tbW9ucy5jb2xs\nZWN0aW9ucy5pdGVyYXRvcnMuSXRlcmF0b3JDaGFpbjsNCmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuTFJVTWFwOw0KaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS5saWIudXRpbC5SZWZlcmVuY2VNYXA7DQppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51dGlsLlNpemVkTWFwOw0KaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS5saWIudXRpbC5jb25jdXJyZW50LkNvbmN1\ncnJlbnRIYXNoTWFwOw0KaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIu\ndXRpbC5jb25jdXJyZW50LkNvbmN1cnJlbnRSZWZlcmVuY2VIYXNoTWFwOw0K\nDQppbXBvcnQgamF2YS51dGlsLmNvbmN1cnJlbnQubG9ja3MuUmVlbnRyYW50\nTG9jazsNCg0KLyoqDQogKiBGaXhlZC1zaXplIG1hcCB0aGF0IGhhcyBhYmls\naXR5IHRvIHBpbi91bnBpbiBlbnRyaWVzIGFuZCBtb3ZlIG92ZXJmbG93IHRv\nDQogKiBhIGJhY2tpbmcgc29mdCBtYXAuDQogKg0KICogQGF1dGhvciBQYXRy\naWNrIExpbnNrZXkNCiAqIEBhdXRob3IgQWJlIFdoaXRlDQogKi8NCnB1Ymxp\nYyBjbGFzcyBDYWNoZU1hcA0KICAgIGltcGxlbWVudHMgTWFwIHsNCg0KICAg\nIC8qKg0KICAgICAqIFRoZSBtYXAgZm9yIG5vbi1leHBpcmVkIGFuZCBub24t\ncGlubmVkIHJlZmVyZW5jZXMuDQogICAgICovDQogICAgcHJvdGVjdGVkIGZp\nbmFsIFNpemVkTWFwIGNhY2hlTWFwOw0KDQogICAgLyoqDQogICAgICogVGhl\nIG1hcCBmb3IgZXhwaXJlZCByZWZlcmVuY2VzLg0KICAgICAqLw0KICAgIHBy\nb3RlY3RlZCBmaW5hbCBTaXplZE1hcCBzb2Z0TWFwOw0KDQogICAgLyoqDQog\nICAgICogVGhlIHNldCBvZiBvYmplY3RzIHBpbm5lZCBpbnRvIHRoZSBjYWNo\nZS4NCiAgICAgKi8NCiAgICBwcm90ZWN0ZWQgZmluYWwgTWFwIHBpbm5lZE1h\ncDsNCg0KICAgIC8vIG51bWJlciBvZiBwaW5uZWQgdmFsdWVzIChub3QgaW5j\nbHVkaW5nIGtleXMgbm90IG1hcHBlZCB0byB2YWx1ZXMpDQogICAgcHJpdmF0\nZSBpbnQgX3Bpbm5lZFNpemUgPSAwOw0KDQogICAgcHJpdmF0ZSBmaW5hbCBS\nZWVudHJhbnRMb2NrIF93cml0ZUxvY2sgPSBuZXcgUmVlbnRyYW50TG9jaygp\nOw0KICAgIHByaXZhdGUgZmluYWwgUmVlbnRyYW50TG9jayBfcmVhZExvY2s7\nDQoNCiAgICAvKioNCiAgICAgKiBDcmVhdGUgYSBub24tTFJVIChhbmQgdGhl\ncmVmb3JlIGhpZ2hseSBjb25jdXJyZW50KSBjYWNoZSBtYXAgd2l0aCBhDQog\nICAgICogc2l6ZSBvZiAxMDAwLg0KICAgICAqLw0KICAgIHB1YmxpYyBDYWNo\nZU1hcCgpIHsNCiAgICAgICAgdGhpcyhmYWxzZSwgMTAwMCk7DQogICAgfQ0K\nDQogICAgLyoqDQogICAgICogQ3JlYXRlIGEgY2FjaGUgbWFwIHdpdGggdGhl\nIGdpdmVuIHByb3BlcnRpZXMuDQogICAgICovDQogICAgcHVibGljIENhY2hl\nTWFwKGJvb2xlYW4gbHJ1LCBpbnQgbWF4KSB7DQogICAgICAgIHRoaXMobHJ1\nLCBtYXgsIG1heCAvIDIsIC43NUYpOw0KICAgIH0NCg0KICAgIC8qKg0KICAg\nICAqIEBkZXByZWNhdGVkIHVzZSB7QGxpbmsgQ2FjaGVNYXAjQ2FjaGVNYXAo\nYm9vbGVhbiwgaW50LCBpbnQsIGZsb2F0LCBpbnQpfQ0KICAgICAqIGluc3Rl\nYWQuDQogICAgICovDQogICAgcHVibGljIENhY2hlTWFwKGJvb2xlYW4gbHJ1\nLCBpbnQgbWF4LCBpbnQgc2l6ZSwgZmxvYXQgbG9hZCkgew0KICAgICAgICB0\naGlzKGxydSwgbWF4LCBzaXplLCBsb2FkLCAxNik7DQogICAgfQ0KDQogICAg\nLyoqDQogICAgICogQ3JlYXRlIGEgY2FjaGUgbWFwIHdpdGggdGhlIGdpdmVu\nIHByb3BlcnRpZXMuDQogICAgICoNCiAgICAgKiBAc2luY2UgMS4xLjANCiAg\nICAgKi8NCiAgICBwdWJsaWMgQ2FjaGVNYXAoYm9vbGVhbiBscnUsIGludCBt\nYXgsIGludCBzaXplLCBmbG9hdCBsb2FkLA0KICAgICAgICBpbnQgY29uY3Vy\ncmVuY3lMZXZlbCkgew0KICAgICAgICBpZiAoc2l6ZSA8IDApDQogICAgICAg\nICAgICBzaXplID0gNTAwOw0KDQogICAgICAgIHNvZnRNYXAgPSBuZXcgQ29u\nY3VycmVudFJlZmVyZW5jZUhhc2hNYXAoUmVmZXJlbmNlTWFwLkhBUkQsDQog\nICAgICAgICAgICBSZWZlcmVuY2VNYXAuU09GVCwgc2l6ZSwgbG9hZCkgew0K\nICAgICAgICAgICAgcHVibGljIHZvaWQgb3ZlcmZsb3dSZW1vdmVkKE9iamVj\ndCBrZXksIE9iamVjdCB2YWx1ZSkgew0KICAgICAgICAgICAgICAgIHNvZnRN\nYXBPdmVyZmxvd1JlbW92ZWQoa2V5LCB2YWx1ZSk7DQogICAgICAgICAgICB9\nDQoNCiAgICAgICAgICAgIHB1YmxpYyB2b2lkIHZhbHVlRXhwaXJlZChPYmpl\nY3Qga2V5KSB7DQogICAgICAgICAgICAgICAgc29mdE1hcFZhbHVlRXhwaXJl\nZChrZXkpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9Ow0KICAgICAgICBw\naW5uZWRNYXAgPSBuZXcgQ29uY3VycmVudEhhc2hNYXAoKTsNCg0KICAgICAg\nICBpZiAoIWxydSkgew0KICAgICAgICAgICAgY2FjaGVNYXAgPSBuZXcgQ29u\nY3VycmVudEhhc2hNYXAoc2l6ZSwgbG9hZCkgew0KICAgICAgICAgICAgICAg\nIHB1YmxpYyB2b2lkIG92ZXJmbG93UmVtb3ZlZChPYmplY3Qga2V5LCBPYmpl\nY3QgdmFsdWUpIHsNCiAgICAgICAgICAgICAgICAgICAgY2FjaGVNYXBPdmVy\nZmxvd1JlbW92ZWQoa2V5LCB2YWx1ZSk7DQogICAgICAgICAgICAgICAgfQ0K\nICAgICAgICAgICAgfTsNCiAgICAgICAgICAgIF9yZWFkTG9jayA9IG51bGw7\nDQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICBjYWNoZU1hcCA9IG5l\ndyBMUlVNYXAoc2l6ZSwgbG9hZCkgew0KICAgICAgICAgICAgICAgIHB1Ymxp\nYyB2b2lkIG92ZXJmbG93UmVtb3ZlZChPYmplY3Qga2V5LCBPYmplY3QgdmFs\ndWUpIHsNCiAgICAgICAgICAgICAgICAgICAgY2FjaGVNYXBPdmVyZmxvd1Jl\nbW92ZWQoa2V5LCB2YWx1ZSk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAg\nICAgICAgfTsNCiAgICAgICAgICAgIF9yZWFkTG9jayA9IF93cml0ZUxvY2s7\nDQogICAgICAgIH0NCiAgICAgICAgaWYgKG1heCA8IDApDQogICAgICAgICAg\nICBtYXggPSBJbnRlZ2VyLk1BWF9WQUxVRTsNCiAgICAgICAgY2FjaGVNYXAu\nc2V0TWF4U2l6ZShtYXgpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIENh\nbGxlZCBmcm9tIHtAbGluayBTaXplZE1hcCNvdmVyZmxvd1JlbW92ZWR9IGlu\nIHRoZSBjYWNoZSBtYXAuDQogICAgICovDQogICAgcHJvdGVjdGVkIHZvaWQg\nY2FjaGVNYXBPdmVyZmxvd1JlbW92ZWQoT2JqZWN0IGtleSwgT2JqZWN0IHZh\nbHVlKSB7DQogICAgICAgIGlmIChzb2Z0TWFwLnNpemUoKSA8IHNvZnRNYXAu\nZ2V0TWF4U2l6ZSgpKQ0KICAgICAgICAgICAgcHV0KHNvZnRNYXAsIGtleSwg\ndmFsdWUpOw0KICAgICAgICBlbHNlDQogICAgICAgICAgICBlbnRyeVJlbW92\nZWQoa2V5LCB2YWx1ZSwgdHJ1ZSk7DQogICAgfQ0KDQogICAgLyoqDQogICAg\nICogQ2FsbGVkIGZyb20ge0BsaW5rIFNpemVkTWFwI292ZXJmbG93UmVtb3Zl\nZH0gaW4gdGhlIHNvZnQgbWFwLg0KICAgICAqLw0KICAgIHByb3RlY3RlZCB2\nb2lkIHNvZnRNYXBPdmVyZmxvd1JlbW92ZWQoT2JqZWN0IGtleSwgT2JqZWN0\nIHZhbHVlKSB7DQogICAgICAgIGVudHJ5UmVtb3ZlZChrZXksIHZhbHVlLCB0\ncnVlKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiBDYWxsZWQgd2hlbiBh\nIHZhbHVlIGV4cGlyZXMgZnJvbSB0aGUgc29mdCBtYXAuDQogICAgICovDQog\nICAgcHJvdGVjdGVkIHZvaWQgc29mdE1hcFZhbHVlRXhwaXJlZChPYmplY3Qg\na2V5KSB7DQogICAgICAgIGVudHJ5UmVtb3ZlZChrZXksIG51bGwsIHRydWUp\nOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIFB1dCB0aGUgZ2l2ZW4gZW50\ncnkgaW50byB0aGUgZ2l2ZW4gbWFwLiBBbGxvd3Mgc3ViY2xhc3NlcyB0bw0K\nICAgICAqIHRha2UgYWRkaXRpb25hbCBhY3Rpb25zLg0KICAgICAqLw0KICAg\nIHByb3RlY3RlZCBPYmplY3QgcHV0KE1hcCBtYXAsIE9iamVjdCBrZXksIE9i\namVjdCB2YWx1ZSkgew0KICAgICAgICByZXR1cm4gbWFwLnB1dChrZXksIHZh\nbHVlKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiBSZW1vdmUgdGhlIGdp\ndmVuIGtleSBmcm9tIHRoZSBnaXZlbiBtYXAuIEFsbG93cyBzdWJjbGFzc2Vz\nIHRvDQogICAgICogdGFrZSBhZGRpdGlvbmFsIGFjdGlvbnMuDQogICAgICov\nDQogICAgcHJvdGVjdGVkIE9iamVjdCByZW1vdmUoTWFwIG1hcCwgT2JqZWN0\nIGtleSkgew0KICAgICAgICByZXR1cm4gbWFwLnJlbW92ZShrZXkpOw0KICAg\nIH0NCg0KICAgIC8qKg0KICAgICAqIEFjcXVpcmUgcmVhZCBsb2NrLg0KICAg\nICAqLw0KICAgIHB1YmxpYyB2b2lkIHJlYWRMb2NrKCkgew0KICAgICAgICBp\nZiAoX3JlYWRMb2NrICE9IG51bGwpDQogICAgICAgICAgICBfcmVhZExvY2su\nbG9jaygpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIFJlbGVhc2UgcmVh\nZCBsb2NrLg0KICAgICAqLw0KICAgIHB1YmxpYyB2b2lkIHJlYWRVbmxvY2so\nKSB7DQogICAgICAgIGlmIChfcmVhZExvY2sgIT0gbnVsbCkNCiAgICAgICAg\nICAgIF9yZWFkTG9jay51bmxvY2soKTsNCiAgICB9DQoNCiAgICAvKioNCiAg\nICAgKiBBY3F1aXJlIHdyaXRlIGxvY2suDQogICAgICovDQogICAgcHVibGlj\nIHZvaWQgd3JpdGVMb2NrKCkgew0KICAgICAgICBfd3JpdGVMb2NrLmxvY2so\nKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiBSZWxlYXNlIHdyaXRlIGxv\nY2suDQogICAgICovDQogICAgcHVibGljIHZvaWQgd3JpdGVVbmxvY2soKSB7\nDQogICAgICAgIF93cml0ZUxvY2sudW5sb2NrKCk7DQogICAgfQ0KDQogICAg\nLyoqDQogICAgICogV2hldGhlciB0aGlzIGNhY2hlIG1hcCB1c2VzIExSVSBl\ndmljdGlvbi4NCiAgICAgKi8NCiAgICBwdWJsaWMgYm9vbGVhbiBpc0xSVSgp\nIHsNCiAgICAgICAgcmV0dXJuIF9yZWFkTG9jayAhPSBudWxsOw0KICAgIH0N\nCg0KICAgIC8qKg0KICAgICAqIFRoZSBtYXhpbXVtIG51bWJlciBvZiBoYXJk\nIHJlZmVyZW5jZXMgdG8gbWFpbnRhaW4sIG9yIC0xIGZvciBubyBsaW1pdC4N\nCiAgICAgKi8NCiAgICBwdWJsaWMgdm9pZCBzZXRDYWNoZVNpemUoaW50IHNp\nemUpIHsNCiAgICAgICAgd3JpdGVMb2NrKCk7DQogICAgICAgIHRyeSB7DQog\nICAgICAgICAgICBjYWNoZU1hcC5zZXRNYXhTaXplKChzaXplIDwgMCkgPyBJ\nbnRlZ2VyLk1BWF9WQUxVRSA6IHNpemUpOw0KICAgICAgICB9IGZpbmFsbHkg\new0KICAgICAgICAgICAgd3JpdGVVbmxvY2soKTsNCiAgICAgICAgfQ0KICAg\nIH0NCg0KICAgIC8qKg0KICAgICAqIFRoZSBtYXhpbXVtIG51bWJlciBvZiBo\nYXJkIHJlZmVyZW5jZXMgdG8gbWFpbnRhaW4sIG9yIC0xIGZvciBubyBsaW1p\ndC4NCiAgICAgKi8NCiAgICBwdWJsaWMgaW50IGdldENhY2hlU2l6ZSgpIHsN\nCiAgICAgICAgaW50IG1heCA9IGNhY2hlTWFwLmdldE1heFNpemUoKTsNCiAg\nICAgICAgcmV0dXJuIChtYXggPT0gSW50ZWdlci5NQVhfVkFMVUUpID8gLTEg\nOiBtYXg7DQogICAgfQ0KDQogICAgLyoqDQogICAgICogVGhlIG1heGltdW0g\nbnVtYmVyIG9mIHNvZnQgcmVmZXJlbmNlcyB0byBtYWludGFpbiwgb3IgLTEg\nZm9yIG5vIGxpbWl0Lg0KICAgICAqLw0KICAgIHB1YmxpYyB2b2lkIHNldFNv\nZnRSZWZlcmVuY2VTaXplKGludCBzaXplKSB7DQogICAgICAgIHdyaXRlTG9j\naygpOw0KICAgICAgICB0cnkgew0KICAgICAgICAgICAgc29mdE1hcC5zZXRN\nYXhTaXplKChzaXplIDwgMCkgPyBJbnRlZ2VyLk1BWF9WQUxVRSA6IHNpemUp\nOw0KICAgICAgICB9IGZpbmFsbHkgew0KICAgICAgICAgICAgd3JpdGVVbmxv\nY2soKTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIFRo\nZSBtYXhpbXVtIG51bWJlciBvZiBzb2Z0IHJlZmVyZW5jZXMgdG8gbWFpbnRh\naW4sIG9yIC0xIGZvciBubyBsaW1pdC4NCiAgICAgKi8NCiAgICBwdWJsaWMg\naW50IGdldFNvZnRSZWZlcmVuY2VTaXplKCkgew0KICAgICAgICBpbnQgbWF4\nID0gc29mdE1hcC5nZXRNYXhTaXplKCk7DQogICAgICAgIHJldHVybiAobWF4\nID09IEludGVnZXIuTUFYX1ZBTFVFKSA/IC0xIDogbWF4Ow0KICAgIH0NCg0K\nICAgIC8qKg0KICAgICAqIFRoZSBrZXlzIHBpbm5lZCBpbnRvIHRoZSBtYXAu\nDQogICAgICovDQogICAgcHVibGljIFNldCBnZXRQaW5uZWRLZXlzKCkgew0K\nICAgICAgICByZWFkTG9jaygpOw0KICAgICAgICB0cnkgew0KICAgICAgICAg\nICAgcmV0dXJuIENvbGxlY3Rpb25zLnVubW9kaWZpYWJsZVNldChwaW5uZWRN\nYXAua2V5U2V0KCkpOw0KICAgICAgICB9IGZpbmFsbHkgew0KICAgICAgICAg\nICAgcmVhZFVubG9jaygpOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgLyoq\nDQogICAgICogTG9ja3MgdGhlIGdpdmVuIGtleSBhbmQgaXRzIHZhbHVlIGlu\ndG8gdGhlIG1hcC4gT2JqZWN0cyBwaW5uZWQgaW50bw0KICAgICAqIHRoZSBt\nYXAgYXJlIG5vdCBjb3VudGVkIHRvd2FyZHMgdGhlIG1heGltdW0gY2FjaGUg\nc2l6ZSwgYW5kIGFyZSBuZXZlcg0KICAgICAqIGV2aWN0ZWQgaW1wbGljaXRs\neS4gWW91IG1heSBwaW4ga2V5cyBmb3Igd2hpY2ggbm8gdmFsdWUgaXMgaW4g\ndGhlIG1hcC4NCiAgICAgKg0KICAgICAqIEByZXR1cm4gdHJ1ZSBpZiB0aGUg\nZ2l2bmUga2V5J3MgdmFsdWUgd2FzIHBpbm5lZDsgZmFsc2UgaWYgbm8gdmFs\ndWUNCiAgICAgKiBmb3IgdGhlIGdpdmVuIGtleSBpcyBjYWNoZWQNCiAgICAg\nKi8NCiAgICBwdWJsaWMgYm9vbGVhbiBwaW4oT2JqZWN0IGtleSkgew0KICAg\nICAgICB3cml0ZUxvY2soKTsNCiAgICAgICAgdHJ5IHsNCiAgICAgICAgICAg\nIC8vIGlmIHdlIGRvbid0IGhhdmUgYSBwaW5uZWQgbWFwIHdlIG5lZWQgdG8g\nY3JlYXRlIG9uZTsgZWxzZSBpZiB0aGUNCiAgICAgICAgICAgIC8vIHBpbm5l\nZCBtYXAgYWxyZWFkeSBjb250YWlucyB0aGUga2V5LCBub3RoaW5nIHRvIGRv\nDQogICAgICAgICAgICBpZiAocGlubmVkTWFwLmNvbnRhaW5zS2V5KGtleSkp\nDQogICAgICAgICAgICAgICAgcmV0dXJuIHBpbm5lZE1hcC5nZXQoa2V5KSAh\nPSBudWxsOw0KDQogICAgICAgICAgICAvLyBjaGVjayBvdGhlciBtYXBzIGZv\nciBrZXkNCiAgICAgICAgICAgIE9iamVjdCB2YWwgPSByZW1vdmUoY2FjaGVN\nYXAsIGtleSk7DQogICAgICAgICAgICBpZiAodmFsID09IG51bGwpDQogICAg\nICAgICAgICAgICAgdmFsID0gcmVtb3ZlKHNvZnRNYXAsIGtleSk7DQoNCiAg\nICAgICAgICAgIC8vIHBpbiBrZXkNCiAgICAgICAgICAgIHB1dChwaW5uZWRN\nYXAsIGtleSwgdmFsKTsNCiAgICAgICAgICAgIGlmICh2YWwgIT0gbnVsbCkg\new0KICAgICAgICAgICAgICAgIF9waW5uZWRTaXplKys7DQogICAgICAgICAg\nICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgICB9DQogICAgICAgICAg\nICByZXR1cm4gZmFsc2U7DQogICAgICAgIH0gZmluYWxseSB7DQogICAgICAg\nICAgICB3cml0ZVVubG9jaygpOw0KICAgICAgICB9DQogICAgfQ0KDQogICAg\nLyoqDQogICAgICogVW5kbyBhIHBpbm5pbmcuDQogICAgICovDQogICAgcHVi\nbGljIGJvb2xlYW4gdW5waW4oT2JqZWN0IGtleSkgew0KICAgICAgICB3cml0\nZUxvY2soKTsNCiAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgIE9iamVjdCB2\nYWwgPSByZW1vdmUocGlubmVkTWFwLCBrZXkpOw0KICAgICAgICAgICAgaWYg\nKHZhbCAhPSBudWxsKSB7DQogICAgICAgICAgICAgICAgLy8gcHV0IGJhY2sg\naW50byB1bnBpbm5lZCBjYWNoZQ0KICAgICAgICAgICAgICAgIHB1dChrZXks\nIHZhbCk7DQogICAgICAgICAgICAgICAgX3Bpbm5lZFNpemUtLTsNCiAgICAg\nICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgIH0NCiAgICAg\nICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgfSBmaW5hbGx5IHsNCiAg\nICAgICAgICAgIHdyaXRlVW5sb2NrKCk7DQogICAgICAgIH0NCiAgICB9DQoN\nCiAgICAvKioNCiAgICAgKiBJbnZva2VkIHdoZW4gYSBrZXktdmFsdWUgcGFp\nciBpcyBldmljdGVkIGZyb20gdGhpcyBkYXRhDQogICAgICogc3RydWN0dXJl\nLiBUaGlzIGlzIGludm9rZWQgd2l0aCA8Y29kZT5leHBpcmVkPC9jb2RlPiBz\nZXQgdG8NCiAgICAgKiA8Y29kZT50cnVlPC9jb2RlPiB3aGVuIGFuIG9iamVj\ndCBpcyBkcm9wcGVkIGJlY2F1c2Ugb2Ygc3BhY2UNCiAgICAgKiByZXF1aXJl\nbWVudHMgb3IgdGhyb3VnaCBnYXJiYWdlIGNvbGxlY3Rpb24gb2Ygc29mdCBy\nZWZlcmVuY2VzLg0KICAgICAqIEl0IGlzIGludm9rZWQgd2l0aCA8Y29kZT5l\neHBpcmVkPC9jb2RlPiBzZXQgdG8gPGNvZGU+ZmFsc2U8L2NvZGU+DQogICAg\nICogd2hlbiBhbiBvYmplY3QgaXMgZXhwbGljaXRseSByZW1vdmVkIHZpYSB0\naGUge0BsaW5rICNyZW1vdmV9IG9yDQogICAgICoge0BsaW5rICNjbGVhcn0g\nbWV0aG9kcy4gVGhpcyBtYXkgYmUgaW52b2tlZCBtb3JlIHRoYW4gb25jZSBm\nb3IgYQ0KICAgICAqIGdpdmVuIGVudHJ5Lg0KICAgICAqDQogICAgICogQHBh\ncmFtIHZhbHVlIG1heSBiZSBudWxsIGlmIHRoZSB2YWx1ZSB3YXMgYSBzb2Z0\nIHJlZmVyZW5jZSB0aGF0IGhhcw0KICAgICAqIGJlZW4gR0NkDQogICAgICog\nQHNpbmNlIDAuMi41LjANCiAgICAgKi8NCiAgICBwcm90ZWN0ZWQgdm9pZCBl\nbnRyeVJlbW92ZWQoT2JqZWN0IGtleSwgT2JqZWN0IHZhbHVlLCBib29sZWFu\nIGV4cGlyZWQpIHsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiBJbnZva2Vk\nIHdoZW4gYW4gZW50cnkgaXMgYWRkZWQgdG8gdGhlIGNhY2hlLiBUaGlzIG1h\neSBiZSBpbnZva2VkDQogICAgICogbW9yZSB0aGFuIG9uY2UgZm9yIGFuIGVu\ndHJ5Lg0KICAgICAqLw0KICAgIHByb3RlY3RlZCB2b2lkIGVudHJ5QWRkZWQo\nT2JqZWN0IGtleSwgT2JqZWN0IHZhbHVlKSB7DQogICAgfQ0KDQogICAgcHVi\nbGljIE9iamVjdCBnZXQoT2JqZWN0IGtleSkgew0KICAgICAgICByZWFkTG9j\naygpOw0KICAgICAgICB0cnkgew0KICAgICAgICAgICAgT2JqZWN0IHZhbCA9\nIHBpbm5lZE1hcC5nZXQoa2V5KTsNCiAgICAgICAgICAgIGlmICh2YWwgIT0g\nbnVsbCkNCiAgICAgICAgICAgICAgICByZXR1cm4gdmFsOw0KDQogICAgICAg\nICAgICB2YWwgPSBjYWNoZU1hcC5nZXQoa2V5KTsNCiAgICAgICAgICAgIGlm\nICh2YWwgPT0gbnVsbCkgew0KICAgICAgICAgICAgICAgIC8vIGlmIHdlIGZp\nbmQgdGhlIGtleSBpbiB0aGUgc29mdCBtYXAsIG1vdmUgaXQgYmFjayBpbnRv\nDQogICAgICAgICAgICAgICAgLy8gdGhlIHByaW1hcnkgbWFwDQogICAgICAg\nICAgICAgICAgdmFsID0gc29mdE1hcC5nZXQoa2V5KTsNCiAgICAgICAgICAg\nICAgICBpZiAodmFsICE9IG51bGwpDQogICAgICAgICAgICAgICAgICAgIHB1\ndChrZXksIHZhbCk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICByZXR1\ncm4gdmFsOw0KICAgICAgICB9IGZpbmFsbHkgew0KICAgICAgICAgICAgcmVh\nZFVubG9jaygpOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgcHVibGljIE9i\namVjdCBwdXQoT2JqZWN0IGtleSwgT2JqZWN0IHZhbHVlKSB7DQogICAgICAg\nIHdyaXRlTG9jaygpOw0KICAgICAgICB0cnkgew0KICAgICAgICAgICAgLy8g\naWYgdGhlIGtleSBpcyBwaW5uZWQsIGp1c3QgaW50ZXJhY3QgZGlyZWN0bHkg\nd2l0aCB0aGUgcGlubmVkIG1hcA0KICAgICAgICAgICAgT2JqZWN0IHZhbDsN\nCiAgICAgICAgICAgIGlmIChwaW5uZWRNYXAuY29udGFpbnNLZXkoa2V5KSkg\new0KICAgICAgICAgICAgICAgIHZhbCA9IHB1dChwaW5uZWRNYXAsIGtleSwg\ndmFsdWUpOw0KICAgICAgICAgICAgICAgIGlmICh2YWwgPT0gbnVsbCkgew0K\nICAgICAgICAgICAgICAgICAgICBfcGlubmVkU2l6ZSsrOw0KICAgICAgICAg\nICAgICAgICAgICBlbnRyeUFkZGVkKGtleSwgdmFsdWUpOw0KICAgICAgICAg\nICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgIGVudHJ5UmVt\nb3ZlZChrZXksIHZhbCwgZmFsc2UpOw0KICAgICAgICAgICAgICAgICAgICBl\nbnRyeUFkZGVkKGtleSwgdmFsdWUpOw0KICAgICAgICAgICAgICAgIH0NCiAg\nICAgICAgICAgICAgICByZXR1cm4gdmFsOw0KICAgICAgICAgICAgfQ0KDQog\nICAgICAgICAgICAvLyBpZiBubyBoYXJkIHJlZnMsIGRvbid0IHB1dCBhbnl0\naGluZw0KICAgICAgICAgICAgaWYgKGNhY2hlTWFwLmdldE1heFNpemUoKSA9\nPSAwKQ0KICAgICAgICAgICAgICAgIHJldHVybiBudWxsOw0KDQogICAgICAg\nICAgICAvLyBvdGhlcndpc2UsIHB1dCB0aGUgdmFsdWUgaW50byB0aGUgbWFw\nIGFuZCBjbGVhciBpdCBmcm9tIHRoZQ0KICAgICAgICAgICAgLy8gc29mdCBt\nYXANCiAgICAgICAgICAgIHZhbCA9IHB1dChjYWNoZU1hcCwga2V5LCB2YWx1\nZSk7DQogICAgICAgICAgICBpZiAodmFsID09IG51bGwpIHsNCiAgICAgICAg\nICAgICAgICB2YWwgPSByZW1vdmUoc29mdE1hcCwga2V5KTsNCiAgICAgICAg\nICAgICAgICBpZiAodmFsID09IG51bGwpDQogICAgICAgICAgICAgICAgICAg\nIGVudHJ5QWRkZWQoa2V5LCB2YWx1ZSk7DQogICAgICAgICAgICAgICAgZWxz\nZSB7DQogICAgICAgICAgICAgICAgICAgIGVudHJ5UmVtb3ZlZChrZXksIHZh\nbCwgZmFsc2UpOw0KICAgICAgICAgICAgICAgICAgICBlbnRyeUFkZGVkKGtl\neSwgdmFsdWUpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0g\nZWxzZSB7DQogICAgICAgICAgICAgICAgZW50cnlSZW1vdmVkKGtleSwgdmFs\nLCBmYWxzZSk7DQogICAgICAgICAgICAgICAgZW50cnlBZGRlZChrZXksIHZh\nbHVlKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHJldHVybiB2YWw7\nDQogICAgICAgIH0gZmluYWxseSB7DQogICAgICAgICAgICB3cml0ZVVubG9j\naygpOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgcHVibGljIHZvaWQgcHV0\nQWxsKE1hcCBtYXApIHsNCiAgICAgICAgTWFwLkVudHJ5IGVudHJ5Ow0KICAg\nICAgICBmb3IgKEl0ZXJhdG9yIGl0ciA9IG1hcC5lbnRyeVNldCgpLml0ZXJh\ndG9yKCk7IGl0ci5oYXNOZXh0KCk7KSB7DQogICAgICAgICAgICBlbnRyeSA9\nIChNYXAuRW50cnkpIGl0ci5uZXh0KCk7DQogICAgICAgICAgICBwdXQoZW50\ncnkuZ2V0S2V5KCksIGVudHJ5LmdldFZhbHVlKCkpOw0KICAgICAgICB9DQog\nICAgfQ0KDQogICAgLyoqDQogICAgICogSWYgPGNvZGU+a2V5PC9jb2RlPiBp\ncyBwaW5uZWQgaW50byB0aGUgY2FjaGUsIHRoZSBwaW4gaXMNCiAgICAgKiBj\nbGVhcmVkIGFuZCB0aGUgb2JqZWN0IGlzIHJlbW92ZWQuDQogICAgICovDQog\nICAgcHVibGljIE9iamVjdCByZW1vdmUoT2JqZWN0IGtleSkgew0KICAgICAg\nICB3cml0ZUxvY2soKTsNCiAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgIC8v\nIGlmIHRoZSBrZXkgaXMgcGlubmVkLCBqdXN0IGludGVyYWN0IGRpcmVjdGx5\nIHdpdGggdGhlDQogICAgICAgICAgICAvLyBwaW5uZWQgbWFwDQogICAgICAg\nICAgICBPYmplY3QgdmFsOw0KICAgICAgICAgICAgaWYgKHBpbm5lZE1hcC5j\nb250YWluc0tleShrZXkpKSB7DQogICAgICAgICAgICAgICAgLy8gcmUtcHV0\nIHdpdGggbnVsbCB2YWx1ZTsgd2Ugc3RpbGwgd2FudCBrZXkgcGlubmVkDQog\nICAgICAgICAgICAgICAgdmFsID0gcHV0KHBpbm5lZE1hcCwga2V5LCBudWxs\nKTsNCiAgICAgICAgICAgICAgICBpZiAodmFsICE9IG51bGwpIHsNCiAgICAg\nICAgICAgICAgICAgICAgX3Bpbm5lZFNpemUtLTsNCiAgICAgICAgICAgICAg\nICAgICAgZW50cnlSZW1vdmVkKGtleSwgdmFsLCBmYWxzZSk7DQogICAgICAg\nICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIHJldHVybiB2YWw7DQogICAg\nICAgICAgICB9DQoNCiAgICAgICAgICAgIHZhbCA9IHJlbW92ZShjYWNoZU1h\ncCwga2V5KTsNCiAgICAgICAgICAgIGlmICh2YWwgPT0gbnVsbCkNCiAgICAg\nICAgICAgICAgICB2YWwgPSBzb2Z0TWFwLnJlbW92ZShrZXkpOw0KICAgICAg\nICAgICAgaWYgKHZhbCAhPSBudWxsKQ0KICAgICAgICAgICAgICAgIGVudHJ5\nUmVtb3ZlZChrZXksIHZhbCwgZmFsc2UpOw0KDQogICAgICAgICAgICByZXR1\ncm4gdmFsOw0KICAgICAgICB9IGZpbmFsbHkgew0KICAgICAgICAgICAgd3Jp\ndGVVbmxvY2soKTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIC8qKg0KICAg\nICAqIFJlbW92ZXMgcGlubmVkIG9iamVjdHMgYXMgd2VsbCBhcyB1bnBpbm5l\nZCBvbmVzLg0KICAgICAqLw0KICAgIHB1YmxpYyB2b2lkIGNsZWFyKCkgew0K\nICAgICAgICB3cml0ZUxvY2soKTsNCiAgICAgICAgdHJ5IHsNCiAgICAgICAg\nICAgIG5vdGlmeUVudHJ5UmVtb3ZhbHMocGlubmVkTWFwLmVudHJ5U2V0KCkp\nOw0KICAgICAgICAgICAgcGlubmVkTWFwLmNsZWFyKCk7DQogICAgICAgICAg\nICBfcGlubmVkU2l6ZSA9IDA7DQoNCiAgICAgICAgICAgIG5vdGlmeUVudHJ5\nUmVtb3ZhbHMoY2FjaGVNYXAuZW50cnlTZXQoKSk7DQogICAgICAgICAgICBj\nYWNoZU1hcC5jbGVhcigpOw0KDQogICAgICAgICAgICBub3RpZnlFbnRyeVJl\nbW92YWxzKHNvZnRNYXAuZW50cnlTZXQoKSk7DQogICAgICAgICAgICBzb2Z0\nTWFwLmNsZWFyKCk7DQogICAgICAgIH0gZmluYWxseSB7DQogICAgICAgICAg\nICB3cml0ZVVubG9jaygpOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgcHJp\ndmF0ZSB2b2lkIG5vdGlmeUVudHJ5UmVtb3ZhbHMoU2V0IHNldCkgew0KICAg\nICAgICBNYXAuRW50cnkgZW50cnk7DQogICAgICAgIGZvciAoSXRlcmF0b3Ig\naXRyID0gc2V0Lml0ZXJhdG9yKCk7IGl0ci5oYXNOZXh0KCk7KSB7DQogICAg\nICAgICAgICBlbnRyeSA9IChNYXAuRW50cnkpIGl0ci5uZXh0KCk7DQogICAg\nICAgICAgICBpZiAoZW50cnkuZ2V0VmFsdWUoKSAhPSBudWxsKQ0KICAgICAg\nICAgICAgICAgIGVudHJ5UmVtb3ZlZChlbnRyeS5nZXRLZXkoKSwgZW50cnku\nZ2V0VmFsdWUoKSwgZmFsc2UpOw0KICAgICAgICB9DQogICAgfQ0KDQogICAg\ncHVibGljIGludCBzaXplKCkgew0KICAgICAgICByZWFkTG9jaygpOw0KICAg\nICAgICB0cnkgew0KICAgICAgICAgICAgcmV0dXJuIF9waW5uZWRTaXplICsg\nY2FjaGVNYXAuc2l6ZSgpICsgc29mdE1hcC5zaXplKCk7DQogICAgICAgIH0g\nZmluYWxseSB7DQogICAgICAgICAgICByZWFkVW5sb2NrKCk7DQogICAgICAg\nIH0NCiAgICB9DQoNCiAgICBwdWJsaWMgYm9vbGVhbiBpc0VtcHR5KCkgew0K\nICAgICAgICByZXR1cm4gc2l6ZSgpID09IDA7DQogICAgfQ0KDQogICAgcHVi\nbGljIGJvb2xlYW4gY29udGFpbnNLZXkoT2JqZWN0IGtleSkgew0KICAgICAg\nICByZWFkTG9jaygpOw0KICAgICAgICB0cnkgew0KICAgICAgICAgICAgcmV0\ndXJuIHBpbm5lZE1hcC5nZXQoa2V5KSAhPSBudWxsDQogICAgICAgICAgICAg\nICAgfHwgY2FjaGVNYXAuY29udGFpbnNLZXkoa2V5KQ0KICAgICAgICAgICAg\nICAgIHx8IHNvZnRNYXAuY29udGFpbnNLZXkoa2V5KTsNCiAgICAgICAgfSBm\naW5hbGx5IHsNCiAgICAgICAgICAgIHJlYWRVbmxvY2soKTsNCiAgICAgICAg\nfQ0KICAgIH0NCg0KICAgIHB1YmxpYyBib29sZWFuIGNvbnRhaW5zVmFsdWUo\nT2JqZWN0IHZhbCkgew0KICAgICAgICByZWFkTG9jaygpOw0KICAgICAgICB0\ncnkgew0KICAgICAgICAgICAgcmV0dXJuIHBpbm5lZE1hcC5jb250YWluc1Zh\nbHVlKHZhbCkNCiAgICAgICAgICAgICAgICB8fCBjYWNoZU1hcC5jb250YWlu\nc1ZhbHVlKHZhbCkNCiAgICAgICAgICAgICAgICB8fCBzb2Z0TWFwLmNvbnRh\naW5zVmFsdWUodmFsKTsNCiAgICAgICAgfSBmaW5hbGx5IHsNCiAgICAgICAg\nICAgIHJlYWRVbmxvY2soKTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIHB1\nYmxpYyBTZXQga2V5U2V0KCkgew0KICAgICAgICByZXR1cm4gbmV3IEtleVNl\ndCgpOw0KICAgIH0NCg0KICAgIHB1YmxpYyBDb2xsZWN0aW9uIHZhbHVlcygp\nIHsNCiAgICAgICAgcmV0dXJuIG5ldyBWYWx1ZUNvbGxlY3Rpb24oKTsNCiAg\nICB9DQoNCiAgICBwdWJsaWMgU2V0IGVudHJ5U2V0KCkgew0KICAgICAgICBy\nZXR1cm4gbmV3IEVudHJ5U2V0KCk7DQogICAgfQ0KDQogICAgcHVibGljIFN0\ncmluZyB0b1N0cmluZygpIHsNCiAgICAgICAgcmVhZExvY2soKTsNCiAgICAg\nICAgdHJ5IHsNCiAgICAgICAgICAgIHJldHVybiAiQ2FjaGVNYXA6IiArIGNh\nY2hlTWFwLnRvU3RyaW5nKCkgKyAiOjoiDQogICAgICAgICAgICAgICAgKyBz\nb2Z0TWFwLnRvU3RyaW5nKCk7DQogICAgICAgIH0gZmluYWxseSB7DQogICAg\nICAgICAgICByZWFkVW5sb2NrKCk7DQogICAgICAgIH0NCiAgICB9DQoNCiAg\nICAvKioNCiAgICAgKiBWaWV3IG9mIHRoZSBlbnRyeSBzZXQuDQogICAgICov\nDQogICAgcHJpdmF0ZSBjbGFzcyBFbnRyeVNldA0KICAgICAgICBleHRlbmRz\nIEFic3RyYWN0U2V0IHsNCg0KICAgICAgICBwdWJsaWMgaW50IHNpemUoKSB7\nDQogICAgICAgICAgICByZXR1cm4gQ2FjaGVNYXAudGhpcy5zaXplKCk7DQog\nICAgICAgIH0NCg0KICAgICAgICBwdWJsaWMgYm9vbGVhbiBhZGQoT2JqZWN0\nIG8pIHsNCiAgICAgICAgICAgIE1hcC5FbnRyeSBlbnRyeSA9IChNYXAuRW50\ncnkpIG87DQogICAgICAgICAgICBwdXQoZW50cnkuZ2V0S2V5KCksIGVudHJ5\nLmdldFZhbHVlKCkpOw0KICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAg\nICAgIH0NCg0KICAgICAgICBwdWJsaWMgSXRlcmF0b3IgaXRlcmF0b3IoKSB7\nDQogICAgICAgICAgICByZXR1cm4gbmV3IEVudHJ5SXRlcmF0b3IoRW50cnlJ\ndGVyYXRvci5FTlRSWSk7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICAvKioN\nCiAgICAgKiBWaWV3IG9mIHRoZSBrZXkgc2V0Lg0KICAgICAqLw0KICAgIHBy\naXZhdGUgY2xhc3MgS2V5U2V0DQogICAgICAgIGV4dGVuZHMgQWJzdHJhY3RT\nZXQgew0KDQogICAgICAgIHB1YmxpYyBpbnQgc2l6ZSgpIHsNCiAgICAgICAg\nICAgIHJldHVybiBDYWNoZU1hcC50aGlzLnNpemUoKTsNCiAgICAgICAgfQ0K\nDQogICAgICAgIHB1YmxpYyBJdGVyYXRvciBpdGVyYXRvcigpIHsNCiAgICAg\nICAgICAgIHJldHVybiBuZXcgRW50cnlJdGVyYXRvcihFbnRyeUl0ZXJhdG9y\nLktFWSk7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiBW\naWV3IG9mIHRoZSB2YWx1ZSBjb2xsZWN0aW9uLg0KICAgICAqLw0KICAgIHBy\naXZhdGUgY2xhc3MgVmFsdWVDb2xsZWN0aW9uDQogICAgICAgIGV4dGVuZHMg\nQWJzdHJhY3RDb2xsZWN0aW9uIHsNCg0KICAgICAgICBwdWJsaWMgaW50IHNp\nemUoKSB7DQogICAgICAgICAgICByZXR1cm4gQ2FjaGVNYXAudGhpcy5zaXpl\nKCk7DQogICAgICAgIH0NCg0KICAgICAgICBwdWJsaWMgSXRlcmF0b3IgaXRl\ncmF0b3IoKSB7DQogICAgICAgICAgICByZXR1cm4gbmV3IEVudHJ5SXRlcmF0\nb3IoRW50cnlJdGVyYXRvci5WQUxVRSk7DQogICAgICAgIH0NCiAgICB9DQoN\nCiAgICAvKioNCiAgICAgKiBJdGVyYXRvciBvdmVyIGFsbCBlbnRyaWVzLg0K\nICAgICAqLw0KICAgIHByaXZhdGUgY2xhc3MgRW50cnlJdGVyYXRvcg0KICAg\nICAgICBpbXBsZW1lbnRzIEl0ZXJhdG9yLCBQcmVkaWNhdGUgew0KDQogICAg\nICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgaW50IEVOVFJZID0gMDsNCiAgICAg\nICAgcHVibGljIHN0YXRpYyBmaW5hbCBpbnQgS0VZID0gMTsNCiAgICAgICAg\ncHVibGljIHN0YXRpYyBmaW5hbCBpbnQgVkFMVUUgPSAyOw0KDQogICAgICAg\nIHByaXZhdGUgZmluYWwgSXRlcmF0b3JDaGFpbiBfaXRyID0gbmV3IEl0ZXJh\ndG9yQ2hhaW4oKTsNCiAgICAgICAgcHJpdmF0ZSBmaW5hbCBpbnQgX3R5cGU7\nDQoNCiAgICAgICAgcHVibGljIEVudHJ5SXRlcmF0b3IoaW50IHR5cGUpIHsN\nCiAgICAgICAgICAgIF90eXBlID0gdHlwZTsNCiAgICAgICAgICAgIF9pdHIu\nYWRkSXRlcmF0b3IobmV3IEZpbHRlckl0ZXJhdG9yKGdldFZpZXcocGlubmVk\nTWFwKSwgdGhpcykpOw0KICAgICAgICAgICAgX2l0ci5hZGRJdGVyYXRvcihn\nZXRWaWV3KGNhY2hlTWFwKSk7DQogICAgICAgICAgICBfaXRyLmFkZEl0ZXJh\ndG9yKGdldFZpZXcoc29mdE1hcCkpOw0KICAgICAgICB9DQoNCiAgICAgICAg\nLyoqDQogICAgICAgICAqIFJldHVybiBhbiBpdGVyYXRvciBvdmVyIHRoZSBh\ncHByb3ByaWF0ZSB2aWV3IG9mIHRoZSBnaXZlbiBtYXAuDQogICAgICAgICAq\nLw0KICAgICAgICBwcml2YXRlIEl0ZXJhdG9yIGdldFZpZXcoTWFwIG0pIHsN\nCiAgICAgICAgICAgIGlmIChtID09IG51bGwpDQogICAgICAgICAgICAgICAg\ncmV0dXJuIG51bGw7DQoNCiAgICAgICAgICAgIHN3aXRjaCAoX3R5cGUpIHsN\nCiAgICAgICAgICAgICAgICBjYXNlIEtFWToNCiAgICAgICAgICAgICAgICAg\nICAgcmV0dXJuIG0ua2V5U2V0KCkuaXRlcmF0b3IoKTsNCiAgICAgICAgICAg\nICAgICBjYXNlIFZBTFVFOg0KICAgICAgICAgICAgICAgICAgICByZXR1cm4g\nbS52YWx1ZXMoKS5pdGVyYXRvcigpOw0KICAgICAgICAgICAgICAgIGRlZmF1\nbHQ6DQogICAgICAgICAgICAgICAgICAgIHJldHVybiBtLmVudHJ5U2V0KCku\naXRlcmF0b3IoKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAg\nICAgIHB1YmxpYyBib29sZWFuIGhhc05leHQoKSB7DQogICAgICAgICAgICBy\nZXR1cm4gX2l0ci5oYXNOZXh0KCk7DQogICAgICAgIH0NCg0KICAgICAgICBw\ndWJsaWMgT2JqZWN0IG5leHQoKSB7DQogICAgICAgICAgICByZXR1cm4gX2l0\nci5uZXh0KCk7DQogICAgICAgIH0NCg0KICAgICAgICBwdWJsaWMgdm9pZCBy\nZW1vdmUoKSB7DQogICAgICAgICAgICBfaXRyLnJlbW92ZSgpOw0KICAgICAg\nICB9DQoNCiAgICAgICAgcHVibGljIGJvb2xlYW4gZXZhbHVhdGUoT2JqZWN0\nIG9iaikgew0KICAgICAgICAgICAgc3dpdGNoIChfdHlwZSkgew0KICAgICAg\nICAgICAgICAgIGNhc2UgRU5UUlk6DQogICAgICAgICAgICAgICAgICAgIHJl\ndHVybiAoKE1hcC5FbnRyeSkgb2JqKS5nZXRWYWx1ZSgpICE9IG51bGw7DQoJ\nCQljYXNlIFZBTFVFOg0KCQkJCXJldHVybiBvYmogIT0gbnVsbDsNCgkJCWRl\nZmF1bHQ6DQoJCQkJcmV0dXJuIHRydWU7DQoJCQl9DQoJCX0NCgl9DQp9DQoN\nCg==\n","encoding":"base64"}

