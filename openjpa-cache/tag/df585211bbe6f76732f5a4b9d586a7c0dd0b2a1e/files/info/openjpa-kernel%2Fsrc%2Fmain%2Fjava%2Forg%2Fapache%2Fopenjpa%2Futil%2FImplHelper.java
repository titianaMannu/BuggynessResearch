{"sha":"7f6b2f25d3e3b800dc958c345c19797ccc032339","node_id":"MDQ6QmxvYjIwNjM2NDo3ZjZiMmYyNWQzZTNiODAwZGM5NThjMzQ1YzE5Nzk3Y2NjMDMyMzM5","size":12702,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/7f6b2f25d3e3b800dc958c345c19797ccc032339","content":"LyoNCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUNCiAqIG9yIG1vcmUgY29udHJpYnV0b3Ig\nbGljZW5zZSBhZ3JlZW1lbnRzLiAgU2VlIHRoZSBOT1RJQ0UgZmlsZQ0KICog\nZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5m\nb3JtYXRpb24NCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAg\nVGhlIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUNCiAqIHRvIHlvdSB1bmRlciB0\naGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUNCiAqICJMaWNl\nbnNlIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNv\nbXBsaWFuY2UNCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFp\nbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQNCiAqDQogKiBodHRwOi8vd3d3\nLmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjANCiAqDQogKiBVbmxl\nc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGlu\nIHdyaXRpbmcsDQogKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUg\nTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbg0KICogIkFTIElTIiBCQVNJ\nUywgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZDQog\nKiBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBM\naWNlbnNlIGZvciB0aGUNCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmlu\nZyBwZXJtaXNzaW9ucyBhbmQgbGltaXRhdGlvbnMNCiAqIHVuZGVyIHRoZSBM\naWNlbnNlLiAgICANCiAqLw0KcGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEu\ndXRpbDsNCg0KaW1wb3J0IGphdmEudXRpbC5BcnJheUxpc3Q7DQppbXBvcnQg\namF2YS51dGlsLkJpdFNldDsNCmltcG9ydCBqYXZhLnV0aWwuQ29sbGVjdGlv\nbjsNCmltcG9ydCBqYXZhLnV0aWwuQ29sbGVjdGlvbnM7DQppbXBvcnQgamF2\nYS51dGlsLkl0ZXJhdG9yOw0KaW1wb3J0IGphdmEudXRpbC5NYXA7DQoNCmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuZW5oYW5jZS5QZXJzaXN0ZW5jZUNh\ncGFibGU7DQppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmVuaGFuY2UuUENS\nZWdpc3RyeTsNCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuZW5oYW5jZS5T\ndGF0ZU1hbmFnZXI7DQppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmVuaGFu\nY2UuTWFuYWdlZEluc3RhbmNlUHJvdmlkZXI7DQppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLmVuaGFuY2UuUmVmbGVjdGluZ1BlcnNpc3RlbmNlQ2FwYWJs\nZTsNCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuZW5oYW5jZS5SdW50aW1l\nVW5lbmhhbmNlZENsYXNzc2VzTW9kZXM7DQppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLmtlcm5lbC5GZXRjaENvbmZpZ3VyYXRpb247DQppbXBvcnQgb3Jn\nLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5Mb2NrTWFuYWdlcjsNCmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLk9wZW5KUEFTdGF0ZU1hbmFnZXI7\nDQppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5QQ1N0YXRlOw0K\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuU3RvcmVDb250ZXh0\nOw0KaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuU3RvcmVNYW5h\nZ2VyOw0KaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIudXRpbC5DbG9z\nZWFibGU7DQppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51dGlsLlJl\nZmVyZW5jZU1hcDsNCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0\naWwuVVVJREdlbmVyYXRvcjsNCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEu\nbGliLnV0aWwuY29uY3VycmVudC5Db25jdXJyZW50UmVmZXJlbmNlSGFzaE1h\ncDsNCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubWV0YS5DbGFzc01ldGFE\nYXRhOw0KaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRhLkZpZWxkTWV0\nYURhdGE7DQppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuSmF2YVR5\ncGVzOw0KaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRhLlNlcXVlbmNl\nTWV0YURhdGE7DQppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLm1ldGEuVmFs\ndWVTdHJhdGVnaWVzOw0KaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5jb25m\nLk9wZW5KUEFDb25maWd1cmF0aW9uOw0KDQovKioNCiAqIEhlbHBlciBmb3Ig\nT3BlbkpQQSBiYWNrLWVuZHMuDQogKg0KICogQHNpbmNlIDAuMy4wDQogKiBA\nYXV0aG9yIEFiZSBXaGl0ZQ0KICogQG5vamF2YWRvYw0KICovDQpwdWJsaWMg\nY2xhc3MgSW1wbEhlbHBlciB7DQoNCiAgICAvLyBDYWNoZSBmb3IgZnJvbS90\nbyB0eXBlIGFzc2lnbm1lbnRzDQogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwg\nTWFwIF9hc3NpZ25hYmxlVHlwZXMgPQ0KICAgICAgICBuZXcgQ29uY3VycmVu\ndFJlZmVyZW5jZUhhc2hNYXAoUmVmZXJlbmNlTWFwLldFQUssIFJlZmVyZW5j\nZU1hcC5IQVJEKTsNCg0KICAgIC8vIG1hcCBvZiBhbGwgbmV3IHVuZW5oYW5j\nZWQgaW5zdGFuY2VzIGFjdGl2ZSBpbiB0aGlzIGNsYXNzbG9hZGVyDQogICAg\ncHVibGljIHN0YXRpYyBmaW5hbCBNYXAgX3VuZW5oYW5jZWRJbnN0YW5jZU1h\ncCA9DQogICAgICAgIG5ldyBDb25jdXJyZW50UmVmZXJlbmNlSGFzaE1hcChS\nZWZlcmVuY2VNYXAuV0VBSywgUmVmZXJlbmNlTWFwLkhBUkQpIHsNCg0KICAg\nICAgICAgICAgcHJvdGVjdGVkIGJvb2xlYW4gZXEoT2JqZWN0IHgsIE9iamVj\ndCB5KSB7DQogICAgICAgICAgICAgICAgLy8gdGhlIEVudHJpZXMgaW4gQ29u\nY3VycmVudFJlZmVyZW5jZUhhc2hNYXAgZGVsZWdhdGUgYmFjayB0bw0KICAg\nICAgICAgICAgICAgIC8vIGVxKCkgaW4gdGhlaXIgZXF1YWxzKCkgaW1wbHMN\nCiAgICAgICAgICAgICAgICBpZiAoeCBpbnN0YW5jZW9mIE1hcC5FbnRyeSkN\nCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmVxKHgsIHkpOw0K\nICAgICAgICAgICAgICAgIGVsc2UNCiAgICAgICAgICAgICAgICAgICAgcmV0\ndXJuIHggPT0geTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgcHJv\ndGVjdGVkIGludCBoYyhPYmplY3Qgbykgew0KICAgICAgICAgICAgICAgIC8v\nIHRoZSBFbnRyaWVzIGluIENvbmN1cnJlbnRSZWZlcmVuY2VIYXNoTWFwIGRl\nbGVnYXRlIGJhY2sgdG8NCiAgICAgICAgICAgICAgICAvLyBoYygpIGluIHRo\nZWlyIGhhc2hDb2RlKCkgaW1wbHMNCiAgICAgICAgICAgICAgICBpZiAobyBp\nbnN0YW5jZW9mIE1hcC5FbnRyeSkNCiAgICAgICAgICAgICAgICAgICAgcmV0\ndXJuIHN1cGVyLmhjKG8pOw0KICAgICAgICAgICAgICAgIGVsc2UNCiAgICAg\nICAgICAgICAgICAgICAgcmV0dXJuIFN5c3RlbS5pZGVudGl0eUhhc2hDb2Rl\nKG8pOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9Ow0KDQogICAgLyoqDQog\nICAgICogSGVscGVyIGZvciBzdG9yZSBtYW5hZ2VyIGltcGxlbWVudGF0aW9u\ncy4gVGhpcyBtZXRob2Qgc2ltcGx5IGRlbGVnYXRlcw0KICAgICAqIHRvIHRo\nZSBwcm9wZXIgc2luZ3VsYXIgbWV0aG9kIGZvciBlYWNoIHN0YXRlIG1hbmFn\nZXIuDQogICAgICoNCiAgICAgKiBAc2VlIFN0b3JlTWFuYWdlciNsb2FkQWxs\nDQogICAgICogQHNpbmNlIDAuNC4wDQogICAgICovDQogICAgcHVibGljIHN0\nYXRpYyBDb2xsZWN0aW9uIGxvYWRBbGwoQ29sbGVjdGlvbiBzbXMsIFN0b3Jl\nTWFuYWdlciBzdG9yZSwNCiAgICAgICAgUENTdGF0ZSBzdGF0ZSwgaW50IGxv\nYWQsIEZldGNoQ29uZmlndXJhdGlvbiBmZXRjaCwgT2JqZWN0IGNvbnRleHQp\nIHsNCiAgICAgICAgQ29sbGVjdGlvbiBmYWlsZWQgPSBudWxsOw0KICAgICAg\nICBPcGVuSlBBU3RhdGVNYW5hZ2VyIHNtOw0KICAgICAgICBMb2NrTWFuYWdl\nciBsbTsNCiAgICAgICAgZm9yIChJdGVyYXRvciBpdHIgPSBzbXMuaXRlcmF0\nb3IoKTsgaXRyLmhhc05leHQoKTspIHsNCiAgICAgICAgICAgIHNtID0gKE9w\nZW5KUEFTdGF0ZU1hbmFnZXIpIGl0ci5uZXh0KCk7DQogICAgICAgICAgICBp\nZiAoc20uZ2V0TWFuYWdlZEluc3RhbmNlKCkgPT0gbnVsbCkgew0KICAgICAg\nICAgICAgICAgIGlmICghc3RvcmUuaW5pdGlhbGl6ZShzbSwgc3RhdGUsIGZl\ndGNoLCBjb250ZXh0KSkNCiAgICAgICAgICAgICAgICAgICAgZmFpbGVkID0g\nYWRkRmFpbGVkSWQoc20sIGZhaWxlZCk7DQogICAgICAgICAgICB9IGVsc2Ug\naWYgKGxvYWQgIT0gU3RvcmVNYW5hZ2VyLkZPUkNFX0xPQURfTk9ORQ0KICAg\nICAgICAgICAgICAgIHx8IHNtLmdldFBDU3RhdGUoKSA9PSBQQ1N0YXRlLkhP\nTExPVykgew0KICAgICAgICAgICAgICAgIGxtID0gc20uZ2V0Q29udGV4dCgp\nLmdldExvY2tNYW5hZ2VyKCk7DQogICAgICAgICAgICAgICAgaWYgKCFzdG9y\nZS5sb2FkKHNtLCBzbS5nZXRVbmxvYWRlZChmZXRjaCksIGZldGNoLCANCiAg\nICAgICAgICAgICAgICAgICAgbG0uZ2V0TG9ja0xldmVsKHNtKSwgY29udGV4\ndCkpDQogICAgICAgICAgICAgICAgICAgIGZhaWxlZCA9IGFkZEZhaWxlZElk\nKHNtLCBmYWlsZWQpOw0KICAgICAgICAgICAgfSBlbHNlIGlmICghc3RvcmUu\nZXhpc3RzKHNtLCBjb250ZXh0KSkNCiAgICAgICAgICAgICAgICBmYWlsZWQg\nPSBhZGRGYWlsZWRJZChzbSwgZmFpbGVkKTsNCiAgICAgICAgfQ0KICAgICAg\nICByZXR1cm4gKGZhaWxlZCA9PSBudWxsKSA/IENvbGxlY3Rpb25zLkVNUFRZ\nX0xJU1QgOiBmYWlsZWQ7DQogICAgfQ0KDQogICAgLyoqDQogICAgICogQWRk\nIGlkZW50aXR5IG9mIGdpdmVuIGluc3RhbmNlIHRvIGNvbGxlY3Rpb24uDQog\nICAgICovDQogICAgcHJpdmF0ZSBzdGF0aWMgQ29sbGVjdGlvbiBhZGRGYWls\nZWRJZChPcGVuSlBBU3RhdGVNYW5hZ2VyIHNtLA0KICAgICAgICBDb2xsZWN0\naW9uIGZhaWxlZCkgew0KICAgICAgICBpZiAoZmFpbGVkID09IG51bGwpDQog\nICAgICAgICAgICBmYWlsZWQgPSBuZXcgQXJyYXlMaXN0KCk7DQogICAgICAg\nIGZhaWxlZC5hZGQoc20uZ2V0SWQoKSk7DQogICAgICAgIHJldHVybiBmYWls\nZWQ7DQogICAgfQ0KDQogICAgLyoqDQogICAgICogR2VuZXJhdGUgYSB2YWx1\nZSBmb3IgdGhlIGdpdmVuIG1ldGFkYXRhLCBvciByZXR1cm4gbnVsbC4gR2Vu\nZXJhdGVzDQogICAgICogdmFsdWVzIGZvciBodGUgZm9sbG93aW5nIHN0cmF0\nZWdpZXM6IHtAbGluayBWYWx1ZVN0cmF0ZWdpZXMjU0VRVUVOQ0V9LA0KICAg\nICAqIHtAbGluayBWYWx1ZVN0cmF0ZWdpZXMjVVVJRF9TVFJJTkd9LCB7QGxp\nbmsgVmFsdWVTdHJhdGVnaWVzI1VVSURfSEVYfQ0KICAgICAqLw0KICAgIHB1\nYmxpYyBzdGF0aWMgT2JqZWN0IGdlbmVyYXRlSWRlbnRpdHlWYWx1ZShTdG9y\nZUNvbnRleHQgY3R4LA0KICAgICAgICBDbGFzc01ldGFEYXRhIG1ldGEsIGlu\ndCB0eXBlQ29kZSkgew0KICAgICAgICByZXR1cm4gZ2VuZXJhdGVWYWx1ZShj\ndHgsIG1ldGEsIG51bGwsIHR5cGVDb2RlKTsNCiAgICB9DQoNCiAgICAvKioN\nCiAgICAgKiBHZW5lcmF0ZSBhIHZhbHVlIGZvciB0aGUgZ2l2ZW4gbWV0YWRh\ndGEsIG9yIHJldHVybiBudWxsLiBHZW5lcmF0ZXMNCiAgICAgKiB2YWx1ZXMg\nZm9yIGh0ZSBmb2xsb3dpbmcgc3RyYXRlZ2llczoge0BsaW5rIFZhbHVlU3Ry\nYXRlZ2llcyNTRVFVRU5DRX0sDQogICAgICoge0BsaW5rIFZhbHVlU3RyYXRl\nZ2llcyNVVUlEX1NUUklOR30sIHtAbGluayBWYWx1ZVN0cmF0ZWdpZXMjVVVJ\nRF9IRVh9DQogICAgICovDQogICAgcHVibGljIHN0YXRpYyBPYmplY3QgZ2Vu\nZXJhdGVGaWVsZFZhbHVlKFN0b3JlQ29udGV4dCBjdHgsDQogICAgICAgIEZp\nZWxkTWV0YURhdGEgZm1kKSB7DQogICAgICAgIHJldHVybiBnZW5lcmF0ZVZh\nbHVlKGN0eCwgZm1kLmdldERlZmluaW5nTWV0YURhdGEoKSwgZm1kLCANCiAg\nICAgICAgICAgIGZtZC5nZXREZWNsYXJlZFR5cGVDb2RlKCkpOw0KICAgIH0N\nCg0KICAgIC8qKg0KICAgICAqIEdlbmVyYXRlIGEgdmFsdWUgZm9yIHRoZSBn\naXZlbiBtZXRhZGFhLg0KICAgICAqLw0KICAgIHByaXZhdGUgc3RhdGljIE9i\namVjdCBnZW5lcmF0ZVZhbHVlKFN0b3JlQ29udGV4dCBjdHgsDQogICAgICAg\nIENsYXNzTWV0YURhdGEgbWV0YSwgRmllbGRNZXRhRGF0YSBmbWQsIGludCB0\neXBlQ29kZSkgew0KICAgICAgICBpbnQgc3RyYXRlZ3kgPSAoZm1kID09IG51\nbGwpID8gbWV0YS5nZXRJZGVudGl0eVN0cmF0ZWd5KCkNCiAgICAgICAgICAg\nIDogZm1kLmdldFZhbHVlU3RyYXRlZ3koKTsNCiAgICAgICAgc3dpdGNoIChz\ndHJhdGVneSkgew0KICAgICAgICAgICAgY2FzZSBWYWx1ZVN0cmF0ZWdpZXMu\nU0VRVUVOQ0U6DQogICAgICAgICAgICAgICAgU2VxdWVuY2VNZXRhRGF0YSBz\nbWQgPSAoZm1kID09IG51bGwpDQogICAgICAgICAgICAgICAgICAgID8gbWV0\nYS5nZXRJZGVudGl0eVNlcXVlbmNlTWV0YURhdGEoKQ0KICAgICAgICAgICAg\nICAgICAgICA6IGZtZC5nZXRWYWx1ZVNlcXVlbmNlTWV0YURhdGEoKTsNCiAg\nICAgICAgICAgICAgICByZXR1cm4gSmF2YVR5cGVzLmNvbnZlcnQoc21kLmdl\ndEluc3RhbmNlKGN0eC5nZXRDbGFzc0xvYWRlcigpKS4NCiAgICAgICAgICAg\nICAgICAgICAgbmV4dChjdHgsIG1ldGEpLCB0eXBlQ29kZSk7DQogICAgICAg\nICAgICBjYXNlIFZhbHVlU3RyYXRlZ2llcy5VVUlEX1NUUklORzoNCiAgICAg\nICAgICAgICAgICByZXR1cm4gVVVJREdlbmVyYXRvci5uZXh0U3RyaW5nKFVV\nSURHZW5lcmF0b3IuVFlQRTEpOw0KICAgICAgICAgICAgY2FzZSBWYWx1ZVN0\ncmF0ZWdpZXMuVVVJRF9IRVg6DQogICAgICAgICAgICAgICAgcmV0dXJuIFVV\nSURHZW5lcmF0b3IubmV4dEhleChVVUlER2VuZXJhdG9yLlRZUEUxKTsNCiAg\nICAgICAgICAgIGNhc2UgVmFsdWVTdHJhdGVnaWVzLlVVSURfVFlQRTRfU1RS\nSU5HOg0KICAgICAgICAgICAgICAgIHJldHVybiBVVUlER2VuZXJhdG9yLm5l\neHRTdHJpbmcoVVVJREdlbmVyYXRvci5UWVBFNCk7DQogICAgICAgICAgICBj\nYXNlIFZhbHVlU3RyYXRlZ2llcy5VVUlEX1RZUEU0X0hFWDoNCiAgICAgICAg\nICAgICAgICByZXR1cm4gVVVJREdlbmVyYXRvci5uZXh0SGV4KFVVSURHZW5l\ncmF0b3IuVFlQRTQpOw0KICAgICAgICAgICAgZGVmYXVsdDoNCiAgICAgICAg\nICAgICAgICByZXR1cm4gbnVsbDsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAg\nIC8qKg0KICAgICAqIFJldHVybnMgdGhlIGZpZWxkcyBvZiB0aGUgc3RhdGUg\ndGhhdCByZXF1aXJlIGFuIHVwZGF0ZS4NCiAgICAgKg0KICAgICAqIEBwYXJh\nbSAgc20gIHRoZSBzdGF0ZSB0byBjaGVjaw0KICAgICAqIEByZXR1cm4gdGhl\nIEJpdFNldCBvZiBmaWVsZHMgdGhhdCBuZWVkIHVwZGF0ZSwgb3IgbnVsbCBp\nZiBub25lDQogICAgICovDQogICAgcHVibGljIHN0YXRpYyBCaXRTZXQgZ2V0\nVXBkYXRlRmllbGRzKE9wZW5KUEFTdGF0ZU1hbmFnZXIgc20pIHsNCiAgICAg\nICAgaWYgKChzbS5nZXRQQ1N0YXRlKCkgPT0gUENTdGF0ZS5QRElSVFkNCiAg\nICAgICAgICAgICYmICghc20uaXNGbHVzaGVkKCkgfHwgc20uaXNGbHVzaGVk\nRGlydHkoKSkpDQogICAgICAgICAgICB8fCAoc20uZ2V0UENTdGF0ZSgpID09\nIFBDU3RhdGUuUE5FVyAmJiBzbS5pc0ZsdXNoZWREaXJ0eSgpKSkgew0KICAg\nICAgICAgICAgQml0U2V0IGRpcnR5ID0gc20uZ2V0RGlydHkoKTsNCiAgICAg\nICAgICAgIGlmIChzbS5pc0ZsdXNoZWQoKSkgew0KICAgICAgICAgICAgICAg\nIGRpcnR5ID0gKEJpdFNldCkgZGlydHkuY2xvbmUoKTsNCiAgICAgICAgICAg\nICAgICBkaXJ0eS5hbmROb3Qoc20uZ2V0Rmx1c2hlZCgpKTsNCiAgICAgICAg\nICAgIH0NCiAgICAgICAgICAgIGlmIChkaXJ0eS5sZW5ndGgoKSA+IDApDQog\nICAgICAgICAgICAgICAgcmV0dXJuIGRpcnR5Ow0KICAgICAgICB9DQogICAg\nICAgIHJldHVybiBudWxsOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIENs\nb3NlIHRoZSBnaXZlbiByZXNvdXJjZS4gVGhlIHJlc291cmNlIGNhbiBiZSBh\nbiBleHRlbnQgaXRlcmF0b3IsDQogICAgICogcXVlcnkgcmVzdWx0LCBsYXJn\nZSByZXN1bHQgc2V0IHJlbGF0aW9uLCBvciBhbnkgY2xvc2VhYmxlIE9wZW5K\nUEENCiAgICAgKiBjb21wb25lbnQuDQogICAgICovDQogICAgcHVibGljIHN0\nYXRpYyB2b2lkIGNsb3NlKE9iamVjdCBvKSB7DQogICAgICAgIHRyeSB7DQog\nICAgICAgICAgICBpZiAobyBpbnN0YW5jZW9mIENsb3NlYWJsZSkNCiAgICAg\nICAgICAgICAgICAoKENsb3NlYWJsZSkgbykuY2xvc2UoKTsNCiAgICAgICAg\nfSBjYXRjaCAoUnVudGltZUV4Y2VwdGlvbiByZSkgew0KICAgICAgICAgICAg\ndGhyb3cgcmU7DQogICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7DQog\nICAgICAgICAgICB0aHJvdyBuZXcgR2VuZXJhbEV4Y2VwdGlvbihlKTsNCiAg\nICAgICAgfQ0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIFJldHVybnMgdHJ1\nZSBpZiB0aGUgc3BlY2lmaWVkIGNsYXNzIGlzIGEgdHlwZSB0aGF0IGNhbiBi\nZSBtYW5hZ2VkIGJ5DQogICAgICogT3BlbkpQQS4NCiAgICAgKg0KICAgICAq\nIEBwYXJhbSB0eXBlIHRoZSBjbGFzcyB0byB0ZXN0DQogICAgICogQHJldHVy\nbiB0cnVlIGlmIHRoZSBjbGFzcyBpcyBtYW5hZ2VhYmxlLg0KICAgICAqDQog\nICAgICogQHNpbmNlIDEuMC4wDQogICAgICovDQogICAgcHVibGljIHN0YXRp\nYyBib29sZWFuIGlzTWFuYWdlZFR5cGUoT3BlbkpQQUNvbmZpZ3VyYXRpb24g\nY29uZiwgQ2xhc3MgdHlwZSkgew0KICAgICAgICByZXR1cm4gKFBlcnNpc3Rl\nbmNlQ2FwYWJsZS5jbGFzcy5pc0Fzc2lnbmFibGVGcm9tKHR5cGUpDQogICAg\nICAgICAgICB8fCAodHlwZSAhPSBudWxsDQogICAgICAgICAgICAgICAgJiYg\nKGNvbmYgPT0gbnVsbCB8fCBjb25mLmdldFJ1bnRpbWVVbmVuaGFuY2VkQ2xh\nc3Nlc0NvbnN0YW50KCkNCiAgICAgICAgICAgICAgICAgICAgPT0gUnVudGlt\nZVVuZW5oYW5jZWRDbGFzc3Nlc01vZGVzLlNVUFBPUlRFRCkNCiAgICAgICAg\nICAgICAgICAmJiBQQ1JlZ2lzdHJ5LmlzUmVnaXN0ZXJlZCh0eXBlKSkpOw0K\nICAgIH0NCg0KICAgIC8qKg0KICAgICAqIFJldHVybnMgdHJ1ZSBpZiB0aGUg\nc3BlY2lmaWVkIGluc3RhbmNlIGlzIG1hbmFnZWFibGUuDQogICAgICoNCiAg\nICAgKiBAcGFyYW0gaW5zdGFuY2UgdGhlIG9iamVjdCB0byBjaGVjaw0KICAg\nICAqIEByZXR1cm4gdHJ1ZSBpZiB0aGUgaW5zdGFuY2UgaXMgYSBwZXJzaXN0\nZW50IHR5cGUsIGZhbHNlIG90aGVyd2lzZQ0KICAgICAqLw0KICAgIHB1Ymxp\nYyBzdGF0aWMgYm9vbGVhbiBpc01hbmFnZWFibGUoT2JqZWN0IGluc3RhbmNl\nKSB7DQogICAgICAgIHJldHVybiBpbnN0YW5jZSBpbnN0YW5jZW9mIFBlcnNp\nc3RlbmNlQ2FwYWJsZQ0KICAgICAgICAgICAgfHwgaW5zdGFuY2UgIT0gbnVs\nbCAmJiBQQ1JlZ2lzdHJ5LmlzUmVnaXN0ZXJlZChpbnN0YW5jZS5nZXRDbGFz\ncygpKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiBSZXR1cm5zIHRydWUg\naWYgdGhlIHJlZmVyZW5jZWQgInRvIiBjbGFzcyBpcyBhc3NpZ25hYmxlIHRv\nIHRoZSAiZnJvbSINCiAgICAgKiBjbGFzcy4gIFRoaXMgaGVscGVyIG1ldGhv\nZCB1dGlsaXplcyBhIGNhY2hlIHRvIGhlbHAgYXZvaWQgdGhlIG92ZXJoZWFk\nDQogICAgICogb2YgdGhlIENsYXNzLmlzQXNzaWduYWJsZUZyb20oKSBtZXRo\nb2QuDQogICAgICoNCiAgICAgKiBAcGFyYW0gZnJvbSB0YXJnZXQgY2xhc3Mg\naW5zdGFuY2UgdG8gYmUgY2hlY2tlZCBmb3IgYXNzaWduYWJpbGl0eQ0KICAg\nICAqIEBwYXJhbSB0byBzZWNvbmQgY2xhc3MgaW5zdGFuY2UgdG8gYmUgY2hl\nY2tlZCBmb3IgYXNzaWduYWJpbGl0eQ0KICAgICAqIEByZXR1cm4gdHJ1ZSBp\nZiB0aGUgInRvIiBjbGFzcyBpcyBhc3NpZ25hYmxlIHRvIHRoZSAiZnJvbSIg\nY2xhc3MNCiAgICAgKi8NCiAgICBwdWJsaWMgc3RhdGljIGJvb2xlYW4gaXNB\nc3NpZ25hYmxlKENsYXNzIGZyb20sIENsYXNzIHRvKSB7DQogICAgICAgIGlm\nIChmcm9tID09IG51bGwgfHwgdG8gPT0gbnVsbCkNCiAgICAgICAgICAgIHJl\ndHVybiBmYWxzZTsNCg0KICAgICAgICBCb29sZWFuIGlzQXNzaWduYWJsZSA9\nIG51bGw7DQogICAgICAgIE1hcCBhc3NpZ25hYmxlVG8gPSAoTWFwKSBfYXNz\naWduYWJsZVR5cGVzLmdldChmcm9tKTsNCiAgICAgICAgaWYgKGFzc2lnbmFi\nbGVUbyA9PSBudWxsKSB7IC8vICJ0byIgY2FjaGUgZG9lc24ndCBleGlzdCwg\nc28gY3JlYXRlIGl0Li4uDQogICAgICAgICAgICBhc3NpZ25hYmxlVG8gPSBu\nZXcgQ29uY3VycmVudFJlZmVyZW5jZUhhc2hNYXAoUmVmZXJlbmNlTWFwLldF\nQUssDQogICAgICAgICAgICAgICAgICAgIFJlZmVyZW5jZU1hcC5IQVJEKTsN\nCiAgICAgICAgICAgIF9hc3NpZ25hYmxlVHlwZXMucHV0KGZyb20sIGFzc2ln\nbmFibGVUbyk7DQogICAgICAgIH0gZWxzZSB7IC8vICJ0byIgY2FjaGUgZXhp\nc3RzLi4uDQogICAgICAgICAgICBpc0Fzc2lnbmFibGUgPSAoQm9vbGVhbikg\nYXNzaWduYWJsZVRvLmdldCh0byk7DQogICAgICAgIH0NCg0KICAgICAgICBp\nZiAoaXNBc3NpZ25hYmxlID09IG51bGwpIHsvLyB3ZSBkb24ndCBoYXZlIGEg\ncmVjb3JkIG9mIHRoaXMgcGFpci4uLg0KICAgICAgICAgICAgaXNBc3NpZ25h\nYmxlID0gQm9vbGVhbi52YWx1ZU9mKGZyb20uaXNBc3NpZ25hYmxlRnJvbSh0\nbykpOw0KICAgICAgICAgICAgYXNzaWduYWJsZVRvLnB1dCh0bywgaXNBc3Np\nZ25hYmxlKTsNCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiBpc0Fzc2ln\nbmFibGUuYm9vbGVhblZhbHVlKCk7DQogICAgfQ0KDQogICAgLyoqDQogICAg\nICogQHJldHVybiB0aGUgcGVyc2lzdGVuY2UtY2FwYWJsZSBpbnN0YW5jZSBy\nZXNwb25zaWJsZSBmb3IgbWFuYWdpbmcNCiAgICAgKiA8Y29kZT5vPC9jb2Rl\nPiwgb3IgPGNvZGU+bnVsbDwvY29kZT4gaWYgPGNvZGU+bzwvY29kZT4gaXMg\nbm90IG1hbmFnZWFibGUuDQogICAgICogQHNpbmNlIDEuMC4wDQogICAgICov\nDQogICAgcHVibGljIHN0YXRpYyBQZXJzaXN0ZW5jZUNhcGFibGUgdG9QZXJz\naXN0ZW5jZUNhcGFibGUoT2JqZWN0IG8sIE9iamVjdCBjdHgpew0KICAgICAg\nICBpZiAobyBpbnN0YW5jZW9mIFBlcnNpc3RlbmNlQ2FwYWJsZSkNCiAgICAg\nICAgICAgIHJldHVybiAoUGVyc2lzdGVuY2VDYXBhYmxlKSBvOw0KDQogICAg\nICAgIE9wZW5KUEFDb25maWd1cmF0aW9uIGNvbmYgPSBudWxsOw0KICAgICAg\nICBpZiAoY3R4IGluc3RhbmNlb2YgT3BlbkpQQUNvbmZpZ3VyYXRpb24pDQog\nICAgICAgICAgICBjb25mID0gKE9wZW5KUEFDb25maWd1cmF0aW9uKSBjdHg7\nDQogICAgICAgIGVsc2UgaWYgKGN0eCBpbnN0YW5jZW9mIFN0YXRlTWFuYWdl\ncg0KICAgICAgICAgICAgJiYgKChTdGF0ZU1hbmFnZXIpIGN0eCkuZ2V0R2Vu\nZXJpY0NvbnRleHQoKSBpbnN0YW5jZW9mIFN0b3JlQ29udGV4dCkNCiAgICAg\nICAgICAgIGNvbmYgPSAoKFN0b3JlQ29udGV4dCkgKChTdGF0ZU1hbmFnZXIp\nIGN0eCkuZ2V0R2VuZXJpY0NvbnRleHQoKSkNCiAgICAgICAgICAgICAgICAu\nZ2V0Q29uZmlndXJhdGlvbigpOw0KDQogICAgICAgIGlmICghaXNNYW5hZ2Vh\nYmxlKG8pKQ0KICAgICAgICAgICAgcmV0dXJuIG51bGw7DQoNCiAgICAgICAg\nLy8gaWYgd2UgaGFkIGEgcHV0SWZBYnNlbnQoKSBtZXRob2QsIHdlIHdvdWxk\nbid0IG5lZWQgdG8gc3luYyBoZXJlDQogICAgICAgIHN5bmNocm9uaXplZCAo\nbykgew0KICAgICAgICAgICAgUGVyc2lzdGVuY2VDYXBhYmxlIHBjID0gKFBl\ncnNpc3RlbmNlQ2FwYWJsZSkNCiAgICAgICAgICAgICAgICBfdW5lbmhhbmNl\nZEluc3RhbmNlTWFwLmdldChvKTsNCg0KICAgICAgICAgICAgaWYgKHBjICE9\nIG51bGwpDQogICAgICAgICAgICAgICAgcmV0dXJuIHBjOw0KDQogICAgICAg\nICAgICAvLyBpZiB3ZSBkb24ndCBoYXZlIGEgY29uZiBwYXNzZWQgaW4sIHRo\nZW4gd2UgY2FuJ3QgY3JlYXRlIGEgbmV3DQogICAgICAgICAgICAvLyBSZWZs\nZWN0aW5nUEM7IHRoaXMgd2lsbCBvbmx5IGJlIHRoZSBjYXNlIHdoZW4gaW52\nb2tlZCBmcm9tIGENCiAgICAgICAgICAgIC8vIGNvbnRleHQgb3V0c2lkZSBv\nZiBPcGVuSlBBLg0KICAgICAgICAgICAgaWYgKGNvbmYgPT0gbnVsbCkNCiAg\nICAgICAgICAgICAgICByZXR1cm4gbnVsbDsNCg0KICAgICAgICAgICAgcGMg\nPSBuZXcgUmVmbGVjdGluZ1BlcnNpc3RlbmNlQ2FwYWJsZShvLCBjb25mKTsN\nCiAgICAgICAgICAgIF91bmVuaGFuY2VkSW5zdGFuY2VNYXAucHV0KG8sIHBj\nKTsNCiAgICAgICAgICAgIHJldHVybiBwYzsNCiAgICAgICAgfQ0KICAgIH0N\nCg0KICAgIHB1YmxpYyBzdGF0aWMgdm9pZCByZWdpc3RlclBlcnNpc3RlbmNl\nQ2FwYWJsZSgNCiAgICAgICAgUmVmbGVjdGluZ1BlcnNpc3RlbmNlQ2FwYWJs\nZSBwYykgew0KICAgICAgICBfdW5lbmhhbmNlZEluc3RhbmNlTWFwLnB1dChw\nYy5nZXRNYW5hZ2VkSW5zdGFuY2UoKSwgcGMpOw0KICAgIH0NCg0KICAgIC8q\nKg0KICAgICAqIEByZXR1cm4gdGhlIHVzZXItdmlzaWJsZSByZXByZXNlbnRh\ndGlvbiBvZiA8Y29kZT5vPC9jb2RlPi4NCiAgICAgKiBAc2luY2UgMS4wLjAN\nCiAgICAgKi8NCiAgICBwdWJsaWMgc3RhdGljIE9iamVjdCBnZXRNYW5hZ2Vk\nSW5zdGFuY2UoT2JqZWN0IG8pIHsNCiAgICAgICAgaWYgKG8gaW5zdGFuY2Vv\nZiBNYW5hZ2VkSW5zdGFuY2VQcm92aWRlcikNCiAgICAgICAgICAgIHJldHVy\nbiAoKE1hbmFnZWRJbnN0YW5jZVByb3ZpZGVyKSBvKS5nZXRNYW5hZ2VkSW5z\ndGFuY2UoKTsNCiAgICAgICAgZWxzZQ0KICAgICAgICAgICAgcmV0dXJuIG87\nDQogICAgfQ0KfQ0K\n","encoding":"base64"}

