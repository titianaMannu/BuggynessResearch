{"sha":"36c7cdc32c0385654fbca122a698cde326807ff9","node_id":"MDQ6QmxvYjIwNjM2NDozNmM3Y2RjMzJjMDM4NTY1NGZiY2ExMjJhNjk4Y2RlMzI2ODA3ZmY5","size":15409,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/36c7cdc32c0385654fbca122a698cde326807ff9","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEubGliLmNvbmY7CgppbXBvcnQg\namF2YS51dGlsLkFycmF5TGlzdDsKaW1wb3J0IGphdmEudXRpbC5BcnJheXM7\nCmltcG9ydCBqYXZhLnV0aWwuQ29sbGVjdGlvbnM7CmltcG9ydCBqYXZhLnV0\naWwuTGlzdDsKaW1wb3J0IGphdmEudXRpbC5NYXA7CgppbXBvcnQgb3JnLmFw\nYWNoZS5jb21tb25zLmxhbmcuU3RyaW5nVXRpbHM7CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEubGliLnV0aWwuTG9jYWxpemVyOwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLmxpYi51dGlsLlBhcnNlRXhjZXB0aW9uOwoKLyoqCiAq\nIEEgY29uZmlndXJhdGlvbiB2YWx1ZS4KICoKICogQGF1dGhvciBNYXJjIFBy\ndWQnaG9tbWVhdXgKICogQGF1dGhvciBQaW5ha2kgUG9kZGFyIChhZGRlZCBk\neW5hbWljIFZhbHVlIHN1cHBvcnQpCiAqLwpwdWJsaWMgYWJzdHJhY3QgY2xh\nc3MgVmFsdWUgaW1wbGVtZW50cyBDbG9uZWFibGUgewoKICAgIHByaXZhdGUg\nc3RhdGljIGZpbmFsIFN0cmluZ1tdIEVNUFRZX0FMSUFTRVMgPSBuZXcgU3Ry\naW5nWzBdOwogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgTG9jYWxpemVyIHNf\nbG9jID0gTG9jYWxpemVyLmZvclBhY2thZ2UoVmFsdWUuY2xhc3MpOwogICAg\nCiAgICBwcml2YXRlIFN0cmluZyBwcm9wID0gbnVsbDsKICAgIHByaXZhdGUg\nU3RyaW5nIGxvYWRLZXkgPSBudWxsOwogICAgcHJpdmF0ZSBTdHJpbmcgZGVm\nID0gbnVsbDsKICAgIHByaXZhdGUgU3RyaW5nW10gYWxpYXNlcyA9IG51bGw7\nCiAgICBwcml2YXRlIFN0cmluZyBnZXR0ZXIgPSBudWxsOwogICAgcHJpdmF0\nZSBMaXN0PFZhbHVlTGlzdGVuZXI+IGxpc3RlbmVycyA9IG51bGw7CiAgICBw\ncml2YXRlIGJvb2xlYW4gYWxpYXNMaXN0Q29tcHJlaGVuc2l2ZSA9IGZhbHNl\nOwogICAgcHJpdmF0ZSBDbGFzcyBzY29wZSA9IG51bGw7CiAgICBwcml2YXRl\nIGJvb2xlYW4gaXNEeW5hbWljID0gZmFsc2U7CiAgICBwcml2YXRlIFN0cmlu\nZyBvcmlnaW5hbFZhbHVlID0gbnVsbDsKCiAgICAvKioKICAgICAqIERlZmF1\nbHQgY29uc3RydWN0b3IuCiAgICAgKi8KICAgIHB1YmxpYyBWYWx1ZSgpIHsK\nICAgIH0KCiAgICAvKioKICAgICAqIENvbnN0cnVjdG9yLiBTdXBwbHkgdGhl\nIHByb3BlcnR5IG5hbWUuCiAgICAgKgogICAgICogQHNlZSAjc2V0UHJvcGVy\ndHkKICAgICAqLwogICAgcHVibGljIFZhbHVlKFN0cmluZyBwcm9wKSB7CiAg\nICAgICAgc2V0UHJvcGVydHkocHJvcCk7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBUaGUgcHJvcGVydHkgbmFtZSB0aGF0IHdpbGwgYmUgdXNlZCB3aGVuIHNl\ndHRpbmcgb3IKICAgICAqIGdldHRpbmcgdGhpcyB2YWx1ZSBpbiBhIHtAbGlu\nayBNYXB9LgogICAgICovCiAgICBwdWJsaWMgU3RyaW5nIGdldFByb3BlcnR5\nKCkgewogICAgICAgIHJldHVybiBwcm9wOwogICAgfQoKICAgIC8qKgogICAg\nICogVGhlIHByb3BlcnR5IG5hbWUgdGhhdCB3aWxsIGJlIHVzZWQgd2hlbiBz\nZXR0aW5nIG9yCiAgICAgKiBnZXR0aW5nIHRoaXMgdmFsdWUgaW4gYSB7QGxp\nbmsgTWFwfS4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0UHJvcGVydHko\nU3RyaW5nIHByb3ApIHsKICAgICAgICB0aGlzLnByb3AgPSBwcm9wOwogICAg\nfQoKICAgIC8qKgogICAgICogVGhlIGtleSB1bmRlciB3aGljaCB0aGlzIHZh\nbHVlIHdhcyBsb2FkZWQsIG9yIG51bGwuCiAgICAgKi8KICAgIHB1YmxpYyBT\ndHJpbmcgZ2V0TG9hZEtleSgpIHsKICAgICAgICByZXR1cm4gbG9hZEtleTsK\nICAgIH0KCiAgICAvKioKICAgICAqIFRoZSBrZXkgdW5kZXIgd2hpY2ggdGhp\ncyB2YWx1ZSB3YXMgbG9hZGVkLCBvciBudWxsLgogICAgICovCiAgICBwdWJs\naWMgdm9pZCBzZXRMb2FkS2V5KFN0cmluZyBsb2FkS2V5KSB7CiAgICAgICAg\ndGhpcy5sb2FkS2V5ID0gbG9hZEtleTsKICAgIH0KCiAgICAvKioKICAgICAq\nIEFsaWFzZXMgZm9yIHRoZSB2YWx1ZSBpbiB0aGUgZm9ybSBrZXkxLCB2YWx1\nZTEsIGtleTIsIHZhbHVlMiwgLi4uCiAgICAgKiBBbGwgYWxpYXMgdmFsdWVz\nIG11c3QgYmUgaW4gc3RyaW5nIGZvcm0uCiAgICAgKi8KICAgIHB1YmxpYyBT\ndHJpbmdbXSBnZXRBbGlhc2VzKCkgewogICAgICAgIHJldHVybiAoYWxpYXNl\ncyA9PSBudWxsKSA/IEVNUFRZX0FMSUFTRVMgOiBhbGlhc2VzOwogICAgfQoK\nICAgIC8qKgogICAgICogQWxpYXNlcyBmb3IgdGhlIHZhbHVlIGluIHRoZSBm\nb3JtIGtleTEsIHZhbHVlMSwga2V5MiwgdmFsdWUyLCAuLi4KICAgICAqIEFs\nbCBhbGlhcyB2YWx1ZXMgbXVzdCBiZSBpbiBzdHJpbmcgZm9ybS4KICAgICAq\nIDxwPgogICAgICogVG8gYXZvaWQgcG90ZW50aWFsIHNpZGUtZWZmZWN0cywg\ndGhpcyBtZXRob2QgY29waWVzIHRoZSBhcnJheSBwYXNzZWQgaW4uCiAgICAg\nKi8KICAgIHB1YmxpYyB2b2lkIHNldEFsaWFzZXMoU3RyaW5nW10gYWxpYXNl\ncykgewogICAgICAgIFN0cmluZyBbXSBhU3RyaW5ncyA9IG5ldyBTdHJpbmdb\nYWxpYXNlcy5sZW5ndGhdOwogICAgICAgIFN5c3RlbS5hcnJheWNvcHkoYWxp\nYXNlcywgMCwgYVN0cmluZ3MsIDAsIGFTdHJpbmdzLmxlbmd0aCk7CiAgICAg\nICAgdGhpcy5hbGlhc2VzID0gYVN0cmluZ3M7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBSZXBsYWNlcyBhbiBleGlzdGluZyBhbGlhcywgb3IgYWRkcyB0aGUg\nZ2l2ZW4gYWxpYXMgdG8gdGhlIGZyb250IG9mIHRoZQogICAgICogYWxpYXMg\nbGlzdCBpZiBpdCBkb2VzIG5vdCBhbHJlYWR5IGV4aXN0LiBBbGwgYWxpYXMg\ndmFsdWVzIG11c3QgYmUgaW4KICAgICAqIHN0cmluZyBmb3JtLgogICAgICov\nCiAgICBwdWJsaWMgdm9pZCBzZXRBbGlhcyhTdHJpbmcga2V5LCBTdHJpbmcg\ndmFsdWUpIHsKICAgICAgICBhbGlhc2VzID0gc2V0QWxpYXMoa2V5LCB2YWx1\nZSwgYWxpYXNlcyk7CiAgICB9CgogICAgLyoqCiAgICAgKiBTZXQgYW4gYWxp\nYXMgaW50byBhIGN1cnJlbnQgYWxpYXMgbGlzdCwgcmV0dXJuaW5nIHRoZSBu\nZXcgbGlzdC4KICAgICAqLwogICAgcHJvdGVjdGVkIFN0cmluZ1tdIHNldEFs\naWFzKFN0cmluZyBrZXksIFN0cmluZyB2YWx1ZSwgU3RyaW5nW10gYWxpYXNl\ncykgewogICAgICAgIGlmIChhbGlhc2VzID09IG51bGwpCiAgICAgICAgICAg\nIGFsaWFzZXMgPSBFTVBUWV9BTElBU0VTOwogICAgICAgIGZvciAoaW50IGkg\nPSAwOyBpIDwgYWxpYXNlcy5sZW5ndGg7IGkgKz0gMikgewogICAgICAgICAg\nICBpZiAoa2V5LmVxdWFscyhhbGlhc2VzW2ldKSkgewogICAgICAgICAgICAg\nICAgYWxpYXNlc1tpICsgMV0gPSB2YWx1ZTsKICAgICAgICAgICAgICAgIHJl\ndHVybiBhbGlhc2VzOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAg\nICAvLyBhZGQgYXMgbmV3IGFsaWFzCiAgICAgICAgU3RyaW5nW10gbmV3QWxp\nYXNlcyA9IG5ldyBTdHJpbmdbYWxpYXNlcy5sZW5ndGggKyAyXTsKICAgICAg\nICBTeXN0ZW0uYXJyYXljb3B5KGFsaWFzZXMsIDAsIG5ld0FsaWFzZXMsIDIs\nIGFsaWFzZXMubGVuZ3RoKTsKICAgICAgICBuZXdBbGlhc2VzWzBdID0ga2V5\nOwogICAgICAgIG5ld0FsaWFzZXNbMV0gPSB2YWx1ZTsKICAgICAgICByZXR1\ncm4gbmV3QWxpYXNlczsKICAgIH0KCiAgICAvKioKICAgICAqIFdoZXRoZXIg\nb3Igbm90IHRoZSBhbGlhcyBsaXN0IGRlZmluZXMgYWxsIHBvc3NpYmxlIHNl\ndHRpbmdzIGZvciB0aGlzCiAgICAgKiB2YWx1ZS4gSWYgc28sIGFuIGVycm9y\nIHdpbGwgYmUgZ2VuZXJhdGVkIHdoZW4gYXR0ZW1wdGluZyB0byBpbnZva2UK\nICAgICAqIGFueSBtZXRob2Qgb24gdGhpcyB2YWx1ZSB3aXRoIGFuIHVua25v\nd24gb3B0aW9uLgogICAgICovCiAgICBwdWJsaWMgYm9vbGVhbiBpc0FsaWFz\nTGlzdENvbXByZWhlbnNpdmUoKSB7CiAgICAgICAgcmV0dXJuIGFsaWFzTGlz\ndENvbXByZWhlbnNpdmU7CiAgICB9CgogICAgLyoqCiAgICAgKiBXaGV0aGVy\nIG9yIG5vdCB0aGUgYWxpYXMgbGlzdCBkZWZpbmVzIGFsbCBwb3NzaWJsZSBz\nZXR0aW5ncyBmb3IgdGhpcwogICAgICogdmFsdWUuIElmIHNvLCBhbiBlcnJv\nciB3aWxsIGJlIGdlbmVyYXRlZCB3aGVuIGF0dGVtcHRpbmcgdG8gaW52b2tl\nCiAgICAgKiBhbnkgbWV0aG9kIG9uIHRoaXMgdmFsdWUgd2l0aCBhbiB1bmtu\nb3duIG9wdGlvbi4KICAgICAqLwogICAgcHVibGljIHZvaWQgc2V0QWxpYXNM\naXN0Q29tcHJlaGVuc2l2ZShib29sZWFuIGFsaWFzTGlzdElzQ29tcHJlaGVu\nc2l2ZSkgewogICAgICAgIHRoaXMuYWxpYXNMaXN0Q29tcHJlaGVuc2l2ZSA9\nIGFsaWFzTGlzdElzQ29tcHJlaGVuc2l2ZTsKICAgIH0KCiAgICAvKioKICAg\nICAqIEFsaWFzIHRoZSBnaXZlbiBzZXR0aW5nLgogICAgICovCiAgICBwdWJs\naWMgU3RyaW5nIGFsaWFzKFN0cmluZyBzdHIpIHsKICAgICAgICByZXR1cm4g\nYWxpYXMoc3RyLCBhbGlhc2VzLCBmYWxzZSk7CiAgICB9CgogICAgLyoqCiAg\nICAgKiBBbGlhcyB0aGUgZ2l2ZW4gc2V0dGluZy4KICAgICAqLwogICAgcHJv\ndGVjdGVkIFN0cmluZyBhbGlhcyhTdHJpbmcgc3RyLCBTdHJpbmdbXSBhbGlh\nc2VzLCBib29sZWFuIG51bGxOb3RGb3VuZCkgewogICAgICAgIGlmIChzdHIg\nIT0gbnVsbCkKICAgICAgICAgICAgc3RyID0gc3RyLnRyaW0oKTsKICAgICAg\nICBpZiAoYWxpYXNlcyA9PSBudWxsIHx8IGFsaWFzZXMubGVuZ3RoID09IDAp\nCiAgICAgICAgICAgIHJldHVybiAobnVsbE5vdEZvdW5kKSA/IG51bGwgOiBz\ndHI7CgogICAgICAgIGJvb2xlYW4gZW1wdHkgPSBzdHIgIT0gbnVsbCAmJiBz\ndHIubGVuZ3RoKCkgPT0gMDsKICAgICAgICBmb3IgKGludCBpID0gMTsgaSA8\nIGFsaWFzZXMubGVuZ3RoOyBpICs9IDIpCiAgICAgICAgICAgIGlmIChTdHJp\nbmdVdGlscy5lcXVhbHMoc3RyLCBhbGlhc2VzW2ldKQogICAgICAgICAgICAg\nICAgfHwgKGVtcHR5ICYmIGFsaWFzZXNbaV0gPT0gbnVsbCkpCiAgICAgICAg\nICAgICAgICByZXR1cm4gYWxpYXNlc1tpIC0gMV07CiAgICAgICAgcmV0dXJu\nIChudWxsTm90Rm91bmQpID8gbnVsbCA6IHN0cjsKICAgIH0KCiAgICAvKioK\nICAgICAqIFVuYWxpYXMgdGhlIGdpdmVuIHNldHRpbmcuCiAgICAgKi8KICAg\nIHB1YmxpYyBTdHJpbmcgdW5hbGlhcyhTdHJpbmcgc3RyKSB7CiAgICAgICAg\ncmV0dXJuIHVuYWxpYXMoc3RyLCBhbGlhc2VzLCBmYWxzZSk7CiAgICB9Cgog\nICAgLyoqCiAgICAgKiBVbmFsaWFzIHRoZSBnaXZlbiBzZXR0aW5nLgogICAg\nICovCiAgICBwcm90ZWN0ZWQgU3RyaW5nIHVuYWxpYXMoU3RyaW5nIHN0ciwg\nU3RyaW5nW10gYWxpYXNlcywKICAgICAgICBib29sZWFuIG51bGxOb3RGb3Vu\nZCkgewogICAgICAgIGlmIChzdHIgIT0gbnVsbCkKICAgICAgICAgICAgc3Ry\nID0gc3RyLnRyaW0oKTsKCiAgICAgICAgYm9vbGVhbiBlbXB0eSA9IHN0ciAh\nPSBudWxsICYmIHN0ci5sZW5ndGgoKSA9PSAwOwogICAgICAgIGlmIChzdHIg\nPT0gbnVsbCB8fCAoZW1wdHkgJiYgZGVmICE9IG51bGwpKQogICAgICAgICAg\nICBzdHIgPSBkZWY7CiAgICAgICAgaWYgKGFsaWFzZXMgIT0gbnVsbCkKICAg\nICAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBhbGlhc2VzLmxlbmd0aDsg\naSArPSAyKQogICAgICAgICAgICAgICAgaWYgKFN0cmluZ1V0aWxzLmVxdWFs\ncyhzdHIsIGFsaWFzZXNbaV0pCiAgICAgICAgICAgICAgICAgICAgfHwgU3Ry\naW5nVXRpbHMuZXF1YWxzKHN0ciwgYWxpYXNlc1tpICsgMV0pCiAgICAgICAg\nICAgICAgICAgICAgfHwgKGVtcHR5ICYmIGFsaWFzZXNbaV0gPT0gbnVsbCkp\nCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFsaWFzZXNbaSArIDFdOwoK\nICAgICAgICBpZiAoaXNBbGlhc0xpc3RDb21wcmVoZW5zaXZlKCkgJiYgYWxp\nYXNlcyAhPSBudWxsKQogICAgICAgICAgICB0aHJvdyBuZXcgUGFyc2VFeGNl\ncHRpb24oc19sb2MuZ2V0KCJpbnZhbGlkLWVudW1lcmF0ZWQtY29uZmlnIiwK\nICAgICAgICAgICAgICAgIGdldFByb3BlcnR5KCksIHN0ciwgQXJyYXlzLmFz\nTGlzdChhbGlhc2VzKSkpOwoKICAgICAgICByZXR1cm4gKG51bGxOb3RGb3Vu\nZCkgPyBudWxsIDogc3RyOwogICAgfQoKICAgIC8qKgogICAgICogVGhlIGRl\nZmF1bHQgdmFsdWUgZm9yIHRoZSBwcm9wZXJ0eSBhcyBhIHN0cmluZy4KICAg\nICAqLwogICAgcHVibGljIFN0cmluZyBnZXREZWZhdWx0KCkgewogICAgICAg\nIHJldHVybiBkZWY7CiAgICB9CgogICAgLyoqCiAgICAgKiBUaGUgZGVmYXVs\ndCB2YWx1ZSBmb3IgdGhlIHByb3BlcnQgYXMgYSBzdHJpbmcuCiAgICAgKi8K\nICAgIHB1YmxpYyB2b2lkIHNldERlZmF1bHQoU3RyaW5nIGRlZikgewogICAg\nICAgIHRoaXMuZGVmID0gZGVmOwogICAgfQoKICAgIC8qKgogICAgICogVGhl\nIG5hbWUgb2YgdGhlIGdldHRlciBtZXRob2QgZm9yIHRoZSBpbnN0YW50aWF0\nZWQgdmFsdWUgb2YgdGhpcwogICAgICogcHJvcGVydHkoYXMgb3Bwb3NlZCB0\nbyB0aGUgc3RyaW5nIHZhbHVlKQogICAgICovCiAgICBwdWJsaWMgU3RyaW5n\nIGdldEluc3RhbnRpYXRpbmdHZXR0ZXIoKSB7CiAgICAgICAgcmV0dXJuIGdl\ndHRlcjsKICAgIH0KCiAgICAvKioKICAgICAqIFRoZSBuYW1lIG9mIHRoZSBn\nZXR0ZXIgbWV0aG9kIGZvciB0aGUgaW5zdGFudGlhdGVkIHZhbHVlIG9mIHRo\naXMKICAgICAqIHByb3BlcnR5KGFzIG9wcG9zZWQgdG8gdGhlIHN0cmluZyB2\nYWx1ZSkuIElmIHRoZSBzdHJpbmcgc3RhcnRzIHdpdGgKICAgICAqIDxjb2Rl\nPnRoaXMuPC9jb2RlPiwgdGhlbiB0aGUgZ2V0dGVyIHdpbGwgYmUgbG9va2Vk\nIHVwIG9uIHRoZSB2YWx1ZQogICAgICogaW5zdGFuY2UgaXRzZWxmLiBPdGhl\ncndpc2UsIHRoZSBnZXR0ZXIgd2lsbCBiZSBsb29rZWQgdXAgb24gdGhlCiAg\nICAgKiBjb25maWd1cmF0aW9uIGluc3RhbmNlLgogICAgICovCiAgICBwdWJs\naWMgdm9pZCBzZXRJbnN0YW50aWF0aW5nR2V0dGVyKFN0cmluZyBnZXR0ZXIp\nIHsKICAgICAgICB0aGlzLmdldHRlciA9IGdldHRlcjsKICAgIH0KCiAgICAv\nKioKICAgICAqIEEgY2xhc3MgZGVmaW5pbmcgdGhlIHNjb3BlIGluIHdoaWNo\nIHRoaXMgdmFsdWUgaXMgZGVmaW5lZC4gVGhpcyB3aWxsCiAgICAgKiBiZSB1\nc2VkIGJ5IHRoZSBjb25maWd1cmF0aW9uIGZyYW1ld29yayB0byBsb29rIHVw\nIG1ldGFkYXRhIGFib3V0CiAgICAgKiB0aGUgdmFsdWUuCiAgICAgKi8KICAg\nIHB1YmxpYyBDbGFzcyBnZXRTY29wZSgpIHsKICAgICAgICByZXR1cm4gc2Nv\ncGU7CiAgICB9CgogICAgLyoqCiAgICAgKiBBIGNsYXNzIGRlZmluaW5nIHRo\nZSBzY29wZSBpbiB3aGljaCB0aGlzIHZhbHVlIGlzIGRlZmluZWQuIFRoaXMg\nd2lsbAogICAgICogYmUgdXNlZCBieSB0aGUgY29uZmlndXJhdGlvbiBmcmFt\nZXdvcmsgdG8gbG9vayB1cCBtZXRhZGF0YSBhYm91dAogICAgICogdGhlIHZh\nbHVlLgogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXRTY29wZShDbGFzcyBj\nbHMpIHsKICAgICAgICBzY29wZSA9IGNsczsKICAgIH0KCiAgICAvKioKICAg\nICAqIFJldHVybiBhIHN0cmluZ2lmaWVkIHZlcnNpb24gb2YgdGhpcyB2YWx1\nZS4gSWYgdGhlIGN1cnJlbnQgdmFsdWUgaGFzCiAgICAgKiBhIHNob3J0IGFs\naWFzIGtleSwgdGhlIGFsaWFzIGtleSBpcyByZXR1cm5lZC4KICAgICAqLwog\nICAgcHVibGljIFN0cmluZyBnZXRTdHJpbmcoKSB7CiAgICAgICAgcmV0dXJu\nIGFsaWFzKGdldEludGVybmFsU3RyaW5nKCkpOwogICAgfQoKICAgIC8qKgog\nICAgICogU2V0IHRoaXMgdmFsdWUgZnJvbSB0aGUgZ2l2ZW4gc3RyaW5nLiBJ\nZiB0aGUgZ2l2ZW4gc3RyaW5nIGlzIG51bGwgb3IKICAgICAqIGVtcHR5IGFu\nZCBhIGRlZmF1bHQgaXMgZGVmaW5lZCwgdGhlIGRlZmF1bHQgaXMgdXNlZC4g\nSWYgdGhlIGdpdmVuCiAgICAgKiBzdHJpbmcob3IgZGVmYXVsdCkgaXMgYW4g\nYWxpYXMga2V5LCBpdCB3aWxsIGJlIGNvbnZlcnRlZCB0byB0aGUKICAgICAq\nIGNvcnJlc3BvbmRpbmcgdmFsdWUgaW50ZXJuYWxseS4KICAgICAqIDxicj4K\nICAgICAqIElmIHRoaXMgVmFsdWUgaXMgYmVpbmcgc2V0IHRvIGEgbm9uLWRl\nZmF1bHQgdmFsdWUgZm9yIHRoZSBmaXJzdCB0aW1lCiAgICAgKiAoYXMgZGVz\naWduYXRlZCBieSA8Y29kZT5vcmlnaW5hbFN0cmluZzwvY29kZT4gYmVpbmcg\nbnVsbCksIHRoZW4gdGhlCiAgICAgKiB2YWx1ZSBpcyByZW1lbWJlcmVkIGFz\nIDxlbT5vcmlnaW5hbDwvZW0+LiBUaGlzIG9yaWdpbmFsIHZhbHVlIGlzIHVz\nZWQKICAgICAqIGZvciBlcXVhbGl0eSBhbmQgaGFzaENvZGUgY29tcHV0YXRp\nb24gaWYgdGhpcyBWYWx1ZSBpcwogICAgICoge0BsaW5rICNpc0R5bmFtaWMo\nKSBkeW5hbWljfS4gCiAgICAgKgogICAgICovCiAgICBwdWJsaWMgdm9pZCBz\nZXRTdHJpbmcoU3RyaW5nIHZhbCkgewogICAgCWFzc2VydENoYW5nZWFibGUo\nKTsKICAgICAgICBTdHJpbmcgc3RyID0gdW5hbGlhcyh2YWwpOwogICAgICAg\nIHRyeSB7CiAgICAgICAgICAgIHNldEludGVybmFsU3RyaW5nKHN0cik7CiAg\nICAgICAgICAgIGlmIChvcmlnaW5hbFZhbHVlID09IG51bGwgJiYgdmFsICE9\nIG51bGwgJiYgIWlzRGVmYXVsdCh2YWwpKSB7CiAgICAgICAgICAgIAlvcmln\naW5hbFZhbHVlID0gZ2V0U3RyaW5nKCk7CiAgICAgICAgICAgIH0KICAgICAg\nICB9IGNhdGNoIChQYXJzZUV4Y2VwdGlvbiBwZSkgewogICAgICAgICAgICB0\naHJvdyBwZTsKICAgICAgICB9IGNhdGNoIChSdW50aW1lRXhjZXB0aW9uIHJl\nKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBQYXJzZUV4Y2VwdGlvbihwcm9w\nICsgIjogIiArIHZhbCwgcmUpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioK\nICAgICAqIFNldCB0aGlzIHZhbHVlIGFzIGFuIG9iamVjdC4KICAgICAqIDxi\ncj4KICAgICAqIElmIHRoaXMgVmFsdWUgaXMgYmVpbmcgc2V0IHRvIGEgbm9u\nLWRlZmF1bHQgdmFsdWUgZm9yIHRoZSBmaXJzdCB0aW1lCiAgICAgKiAoYXMg\nZGVzaWduYXRlZCBieSA8Y29kZT5vcmlnaW5hbFN0cmluZzwvY29kZT4gYmVp\nbmcgbnVsbCksIHRoZW4gdGhlCiAgICAgKiB2YWx1ZSBpcyByZW1lbWJlcmVk\nIGFzIDxlbT5vcmlnaW5hbDwvZW0+LiBUaGlzIG9yaWdpbmFsIHZhbHVlIGlz\nIHVzZWQKICAgICAqIGZvciBlcXVhbGl0eSBhbmQgaGFzaENvZGUgY29tcHV0\nYXRpb24gaWYgdGhpcyBWYWx1ZSBpcwogICAgICoge0BsaW5rICNpc0R5bmFt\naWMoKSBkeW5hbWljfS4gCiAgICAgKiAKICAgICAqLwogICAgcHVibGljIHZv\naWQgc2V0T2JqZWN0KE9iamVjdCBvYmopIHsKICAgICAgICAvLyBpZiBzZXR0\naW5nIHRvIG51bGwgc2V0IGFzIHN0cmluZyB0byBnZXQgZGVmYXVsdHMgaW50\nbyBwbGF5CiAgICAgICAgaWYgKG9iaiA9PSBudWxsICYmIGRlZiAhPSBudWxs\nKQogICAgICAgICAgICBzZXRTdHJpbmcobnVsbCk7CiAgICAgICAgZWxzZSB7\nCiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBzZXRJbnRlcm5h\nbE9iamVjdChvYmopOwogICAgICAgICAgICAgICAgaWYgKG9yaWdpbmFsVmFs\ndWUgPT0gbnVsbCAmJiBvYmogIT0gbnVsbCAmJiAhaXNEZWZhdWx0KG9iaikp\nIHsKICAgICAgICAgICAgICAgIAlvcmlnaW5hbFZhbHVlID0gZ2V0U3RyaW5n\nKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gY2F0Y2ggKFBh\ncnNlRXhjZXB0aW9uIHBlKSB7CiAgICAgICAgICAgICAgICB0aHJvdyBwZTsK\nICAgICAgICAgICAgfSBjYXRjaCAoUnVudGltZUV4Y2VwdGlvbiByZSkgewog\nICAgICAgICAgICAgICAgdGhyb3cgbmV3IFBhcnNlRXhjZXB0aW9uKHByb3Ag\nKyAiOiAiICsgb2JqLCByZSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAg\nICB9CiAgICAKICAgIC8qKgogICAgICogR2V0cyB0aGUgb3JpZ2luYWwgdmFs\ndWUuIE9yaWdpbmFsIHZhbHVlIGRlbm90ZXMgdGhlIFN0cmluZ2lmaWVkIGZv\ncm0gb2YgCiAgICAgKiB0aGlzIFZhbHVlLCBmcm9tIHdoaWNoIGl0IGhhcyBi\nZWVuIHNldCwgaWYgZXZlci4gSWYgdGhpcyBWYWx1ZSBoYXMgbmV2ZXIgCiAg\nICAgKiBiZWVuIHNldCB0byBhIG5vbi1kZWZhdWx0IHZhbHVlLCB0aGVuIHJl\ndHVybnMgdGhlIGRlZmF1bHQgdmFsdWUsIHdoaWNoIAogICAgICogaXRzZWxm\nIGNhbiBiZSBudWxsLiAKICAgICAqIAogICAgICogQHNpbmNlIDEuMS4wCiAg\nICAgKi8KICAgIHB1YmxpYyBTdHJpbmcgZ2V0T3JpZ2luYWxWYWx1ZSgpIHsK\nICAgIAlyZXR1cm4gKG9yaWdpbmFsVmFsdWUgPT0gbnVsbCkgPyBnZXREZWZh\ndWx0KCkgOiBvcmlnaW5hbFZhbHVlOwogICAgfQogICAgCiAgICBib29sZWFu\nIGlzRGVmYXVsdChPYmplY3QgdmFsKSB7CiAgICAJcmV0dXJuIHZhbCAhPSBu\ndWxsICYmIHZhbC50b1N0cmluZygpLmVxdWFscyhnZXREZWZhdWx0KCkpOwog\nICAgfQoKICAgIC8qKgogICAgICogUmV0dXJucyB0aGUgdHlwZSBvZiB0aGUg\ncHJvcGVydHkgdGhhdCB0aGlzIFZhbHVlIHJlcHJlc2VudHMuCiAgICAgKi8K\nICAgIHB1YmxpYyBhYnN0cmFjdCBDbGFzcyBnZXRWYWx1ZVR5cGUoKTsKCiAg\nICAvKioKICAgICAqIFJldHVybiB0aGUgaW50ZXJuYWwgc3RyaW5nIGZvcm0g\nb2YgdGhpcyB2YWx1ZS4KICAgICAqLwogICAgcHJvdGVjdGVkIGFic3RyYWN0\nIFN0cmluZyBnZXRJbnRlcm5hbFN0cmluZygpOwoKICAgIC8qKgogICAgICog\nU2V0IHRoaXMgdmFsdWUgZnJvbSB0aGUgZ2l2ZW4gc3RyaW5nLgogICAgICov\nCiAgICBwcm90ZWN0ZWQgYWJzdHJhY3Qgdm9pZCBzZXRJbnRlcm5hbFN0cmlu\nZyhTdHJpbmcgc3RyKTsKCiAgICAvKioKICAgICAqIFNldCB0aGlzIHZhbHVl\nIGZyb20gYW4gb2JqZWN0LgogICAgICovCiAgICBwcm90ZWN0ZWQgYWJzdHJh\nY3Qgdm9pZCBzZXRJbnRlcm5hbE9iamVjdChPYmplY3Qgb2JqKTsKCiAgICAv\nKioKICAgICAqIEdldHMgdW5tb2RpZmFibGUgbGlzdCBvZiBsaXN0ZW5lcnMg\nZm9yIHZhbHVlIGNoYW5nZXMuCiAgICAgKi8KICAgIHB1YmxpYyBMaXN0PFZh\nbHVlTGlzdGVuZXI+IGdldExpc3RlbmVycygpIHsKICAgICAgICByZXR1cm4g\nQ29sbGVjdGlvbnMudW5tb2RpZmlhYmxlTGlzdCh0aGlzLmxpc3RlbmVycyk7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBMaXN0ZW5lciBmb3IgdmFsdWUgY2hh\nbmdlcy4KICAgICAqLwogICAgcHVibGljIHZvaWQgYWRkTGlzdGVuZXIoVmFs\ndWVMaXN0ZW5lciBsaXN0ZW5lcikgewogICAgCWlmIChsaXN0ZW5lciA9PSBu\ndWxsKQogICAgCQlyZXR1cm47CiAgICAJaWYgKGxpc3RlbmVycyA9PSBudWxs\nKQogICAgCQlsaXN0ZW5lcnMgPSBuZXcgQXJyYXlMaXN0PFZhbHVlTGlzdGVu\nZXI+KCk7CiAgICAgICAgbGlzdGVuZXJzLmFkZChsaXN0ZW5lcik7CiAgICB9\nCiAgICAKICAgIHB1YmxpYyB2b2lkIHJlbW92ZUxpc3RlbmVyKFZhbHVlTGlz\ndGVuZXIgbGlzdGVuZXIpIHsKICAgIAlpZiAobGlzdGVuZXIgPT0gbnVsbCkK\nICAgIAkJcmV0dXJuOwogICAgICAgIGxpc3RlbmVycy5yZW1vdmUobGlzdGVu\nZXIpOwogICAgfQoKICAgIC8qKgogICAgICogU3ViY2xhc3NlcyBzaG91bGQg\nY2FsbCB0aGlzIG1ldGhvZCB3aGVuIHRoZWlyIGludGVybmFsIHZhbHVlIGNo\nYW5nZXMuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHZhbHVlQ2hhbmdlZCgp\nIHsKICAgICAgICBpZiAobGlzdGVuZXJzID09IG51bGwpIAogICAgICAgIAly\nZXR1cm47CiAgICAgICAgZm9yIChWYWx1ZUxpc3RlbmVyIGxpc3RlbmVyIDog\nbGlzdGVuZXJzKSB7CiAgICAgICAgCWxpc3RlbmVyLnZhbHVlQ2hhbmdlZCh0\naGlzKTsKICAgICAgICB9CiAgICB9CiAgICAKICAgIC8qKgogICAgICogQXNz\nZXJ0cyBpZiB0aGlzIHJlY2VpdmVyIGNhbiBiZSBjaGFuZ2VkLgogICAgICog\nU3ViY2xhc3NlcyA8ZW0+bXVzdDwvZW0+IGludm9rZSB0aGlzIG1ldGhvZCBi\nZWZvcmUgY2hhbmdpbmcgaXRzCiAgICAgKiBpbnRlcm5hbCBzdGF0ZS4KICAg\nICAqIAogICAgICogVGhpcyByZWNlaXZlciBjYW4gbm90IGJlIGNoYW5nZWQg\naWYgYWxsIG9mIHRoZSBmb2xsb3dpbmcgaXMgdHJ1ZQogICAgICogPExJPnRo\naXMgcmVjZWl2ZXIgaXMgbm90IGR5bmFtaWMKICAgICAqIDxMST5WYWx1ZUxp\nc3RlbmVyIGF0dGFjaGVkIHRvIHRoaXMgcmVjZWl2ZXIgaXMgYSBDb25maWd1\ncmF0aW9uCiAgICAgKiA8TEk+Q29uZmlndXJhdGlvbiBpcyByZWFkLW9ubHkK\nICAgICAqLwogICAgcHJvdGVjdGVkIHZvaWQgYXNzZXJ0Q2hhbmdlYWJsZSgp\nIHsKICAgIAlpZiAoIWlzRHluYW1pYygpICYmIGNvbnRhaW5zUmVhZE9ubHlD\nb25maWd1cmF0aW9uQXNMaXN0ZW5lcigpKSB7CiAgICAgICAgCXRocm93IG5l\ndyBSdW50aW1lRXhjZXB0aW9uKHNfbG9jLmdldCgidmV0by1jaGFuZ2UiLAog\nICAgICAgIAkJdGhpcy5nZXRQcm9wZXJ0eSgpKS50b1N0cmluZygpKTsKICAg\nICAgIAl9CiAgICB9CiAgICAKICAgIGJvb2xlYW4gY29udGFpbnNSZWFkT25s\neUNvbmZpZ3VyYXRpb25Bc0xpc3RlbmVyKCkgewogICAgCWlmIChsaXN0ZW5l\ncnMgPT0gbnVsbCkKICAgIAkJcmV0dXJuIGZhbHNlOwogICAgCWZvciAoVmFs\ndWVMaXN0ZW5lciBsaXN0ZW5lciA6IGxpc3RlbmVycykgewogICAgCQlpZiAo\nbGlzdGVuZXIgaW5zdGFuY2VvZiBDb25maWd1cmF0aW9uCiAgICAJCSYmICgo\nQ29uZmlndXJhdGlvbilsaXN0ZW5lcikuaXNSZWFkT25seSgpKQogICAgCQkJ\ncmV0dXJuIHRydWU7CiAgICAJfQogICAgCXJldHVybiBmYWxzZTsKICAgIH0K\nICAgIAogICAgLyoqCiAgICAgKiBTZXRzIGlmIHRoaXMgcmVjZWl2ZXIgY2Fu\nIGJlIG11dGF0ZWQgZXZlbiB3aGVuIHRoZSBjb25maWd1cmF0aW9uIGl0IAog\nICAgICogYmVsb25ncyB0byBoYXMgYmVlbiB7QGxpbmsgQ29uZmlndXJhdGlv\nbiNpc1JlYWRPbmx5KCkgZnJvemVufS4KICAgICAqICAKICAgICAqIEBzaW5j\nZSAxLjEuMAogICAgICovCiAgICBwdWJsaWMgdm9pZCBzZXREeW5hbWljKGJv\nb2xlYW4gZmxhZykgewogICAgCWlzRHluYW1pYyA9IGZsYWc7CiAgICB9CiAg\nICAKICAgIC8qKgogICAgICogQWZmaXJtcyBpZiB0aGlzIHJlY2VpdmVyIGNh\nbiBiZSBtdXRhdGVkIGV2ZW4gd2hlbiB0aGUgY29uZmlndXJhdGlvbiBpdCAK\nICAgICAqIGJlbG9uZ3MgdG8gaGFzIGJlZW4ge0BsaW5rIENvbmZpZ3VyYXRp\nb24jaXNSZWFkT25seSgpIGZyb3plbn0uCiAgICAgKiAgCiAgICAgKiBAc2lu\nY2UgMS4xLjAKICAgICAqLwogICAgcHVibGljIGJvb2xlYW4gaXNEeW5hbWlj\nKCkgewogICAgCXJldHVybiBpc0R5bmFtaWM7IAogICAgfQoKICAgIC8qKgog\nICAgICogVXNlIHtAbGluayAjZ2V0T3JpZ2luYWxWYWx1ZSgpIG9yaWdpbmFs\nIHZhbHVlfSBpbnN0ZWFkIG9mIAogICAgICoge0BsaW5rICNnZXRTdHJpbmco\nKSBjdXJyZW50IHZhbHVlfSBiZWNhdXNlIHRoZXkgYXJlIG9uZSBhbmQgdGhl\nIHNhbWUgCiAgICAgKiBmb3Igbm9uLWR5bmFtaWMgVmFsdWVzIGFuZCBlbnN1\ncmVzIHRoYXQgbW9kaWZ5aW5nIGR5bmFtaWMgVmFsdWVzIGRvIG5vdAogICAg\nICogaW1wYWN0IGVxdWFsaXR5IG9yIGhhc2hDb2RlIGNvbnRyYWN0LiAgIAog\nICAgICovCiAgICBwdWJsaWMgaW50IGhhc2hDb2RlKCkgewogICAgICAgIFN0\ncmluZyBzdHIgPSAoaXNEeW5hbWljKCkpID8gZ2V0T3JpZ2luYWxWYWx1ZSgp\nIDogZ2V0U3RyaW5nKCk7CiAgICAgICAgaW50IHN0ckhhc2ggPSAoc3RyID09\nIG51bGwpID8gMCA6IHN0ci5oYXNoQ29kZSgpOwogICAgICAgIGludCBwcm9w\nSGFzaCA9IChwcm9wID09IG51bGwpID8gMCA6IHByb3AuaGFzaENvZGUoKTsK\nICAgICAgICByZXR1cm4gc3RySGFzaCBeIHByb3BIYXNoOwogICAgfQoKICAg\nIC8qKgogICAgICogVXNlIHtAbGluayAjZ2V0T3JpZ2luYWxWYWx1ZSgpIG9y\naWdpbmFsIHZhbHVlfSBpbnN0ZWFkIG9mIAogICAgICoge0BsaW5rICNnZXRT\ndHJpbmcoKSBjdXJyZW50IHZhbHVlfSBiZWNhdXNlIHRoZXkgYXJlIG9uZSBh\nbmQgdGhlIHNhbWUgCiAgICAgKiBmb3Igbm9uLWR5bmFtaWMgVmFsdWVzIGFu\nZCBlbnN1cmVzIHRoYXQgbW9kaWZ5aW5nIGR5bmFtaWMgVmFsdWVzIGRvIG5v\ndAogICAgICogaW1wYWN0IGVxdWFsaXR5IG9yIGhhc2hDb2RlIGNvbnRyYWN0\nLiAgIAogICAgICovCiAgICBwdWJsaWMgYm9vbGVhbiBlcXVhbHMoT2JqZWN0\nIG90aGVyKSB7CiAgICAgICAgaWYgKG90aGVyID09IHRoaXMpCiAgICAgICAg\nICAgIHJldHVybiB0cnVlOwogICAgICAgIGlmICghKG90aGVyIGluc3RhbmNl\nb2YgVmFsdWUpKQogICAgICAgICAgICByZXR1cm4gZmFsc2U7CgogICAgICAg\nIFZhbHVlIG8gPSAoVmFsdWUpIG90aGVyOwogICAgICAgIFN0cmluZyB0aGlz\nU3RyID0gKGlzRHluYW1pYygpKSA/IGdldE9yaWdpbmFsVmFsdWUoKSA6IGdl\ndFN0cmluZygpOwogICAgICAgIFN0cmluZyB0aGF0U3RyID0gKGlzRHluYW1p\nYygpKSA/IG8uZ2V0T3JpZ2luYWxWYWx1ZSgpIDogby5nZXRTdHJpbmcoKTsK\nICAgICAgICByZXR1cm4gKGlzRHluYW1pYygpID09IG8uaXNEeW5hbWljKCkp\nCiAgICAgICAgICAgICYmIFN0cmluZ1V0aWxzLmVxdWFscyhwcm9wLCBvLmdl\ndFByb3BlcnR5KCkpCiAgICAgICAgICAgICYmIFN0cmluZ1V0aWxzLmVxdWFs\ncyh0aGlzU3RyLCB0aGF0U3RyKTsKICAgIH0KCiAgICBwdWJsaWMgT2JqZWN0\nIGNsb25lKCkgewogICAgICAgIHRyeSB7CiAgICAgICAgICAgIHJldHVybiBz\ndXBlci5jbG9uZSgpOwogICAgICAgIH0gY2F0Y2ggKENsb25lTm90U3VwcG9y\ndGVkRXhjZXB0aW9uIGNuc2UpIHsKICAgICAgICAgICAgcmV0dXJuIG51bGw7\nCiAgICAgICAgfQogICAgfQp9Cg==\n","encoding":"base64"}

