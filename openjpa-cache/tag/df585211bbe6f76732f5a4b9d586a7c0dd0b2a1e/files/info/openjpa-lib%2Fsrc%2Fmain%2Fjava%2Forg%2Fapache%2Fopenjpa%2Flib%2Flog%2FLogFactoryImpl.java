{"sha":"bb061dae15942934d404a5838503ed63569b5624","node_id":"MDQ6QmxvYjIwNjM2NDpiYjA2MWRhZTE1OTQyOTM0ZDQwNGE1ODM4NTAzZWQ2MzU2OWI1NjI0","size":12188,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/bb061dae15942934d404a5838503ed63569b5624","content":"LyoNCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUNCiAqIG9yIG1vcmUgY29udHJpYnV0b3Ig\nbGljZW5zZSBhZ3JlZW1lbnRzLiAgU2VlIHRoZSBOT1RJQ0UgZmlsZQ0KICog\nZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5m\nb3JtYXRpb24NCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAg\nVGhlIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUNCiAqIHRvIHlvdSB1bmRlciB0\naGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUNCiAqICJMaWNl\nbnNlIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNv\nbXBsaWFuY2UNCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFp\nbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQNCiAqDQogKiBodHRwOi8vd3d3\nLmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjANCiAqDQogKiBVbmxl\nc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGlu\nIHdyaXRpbmcsDQogKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUg\nTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbg0KICogIkFTIElTIiBCQVNJ\nUywgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZDQog\nKiBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBM\naWNlbnNlIGZvciB0aGUNCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmlu\nZyBwZXJtaXNzaW9ucyBhbmQgbGltaXRhdGlvbnMNCiAqIHVuZGVyIHRoZSBM\naWNlbnNlLiAgICANCiAqLw0KcGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEu\nbGliLmxvZzsNCg0KaW1wb3J0IGphdmEuaW8uRmlsZTsNCmltcG9ydCBqYXZh\nLmlvLkZpbGVPdXRwdXRTdHJlYW07DQppbXBvcnQgamF2YS5pby5JT0V4Y2Vw\ndGlvbjsNCmltcG9ydCBqYXZhLmlvLlByaW50U3RyZWFtOw0KaW1wb3J0IGph\ndmEuaW8uUHJpbnRXcml0ZXI7DQppbXBvcnQgamF2YS5pby5TdHJpbmdXcml0\nZXI7DQppbXBvcnQgamF2YS5zZWN1cml0eS5BY2Nlc3NDb250cm9sbGVyOw0K\naW1wb3J0IGphdmEuc2VjdXJpdHkuUHJpdmlsZWdlZEFjdGlvbkV4Y2VwdGlv\nbjsNCmltcG9ydCBqYXZhLnV0aWwuSGFzaE1hcDsNCmltcG9ydCBqYXZhLnV0\naWwuSXRlcmF0b3I7DQppbXBvcnQgamF2YS51dGlsLkxvY2FsZTsNCmltcG9y\ndCBqYXZhLnV0aWwuTWFwOw0KDQppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLmxpYi5jb25mLkNvbmZpZ3VyYWJsZTsNCmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEubGliLmNvbmYuQ29uZmlndXJhdGlvbjsNCmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEubGliLmNvbmYuR2VuZXJpY0NvbmZpZ3VyYWJsZTsNCmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuRmlsZXM7DQppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51dGlsLkoyRG9Qcml2SGVscGVy\nOw0KaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5saWIudXRpbC5Mb2NhbGl6\nZXI7DQppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmxpYi51dGlsLk9wdGlv\nbnM7DQppbXBvcnQgamF2YS51dGlsLmNvbmN1cnJlbnQuQ29uY3VycmVudEhh\nc2hNYXA7DQoNCi8qKg0KICogRGVmYXVsdCB7QGxpbmsgTG9nRmFjdG9yeX0g\naW1wbGVtZW50YXRpb24uIEZvciBlYXNlIG9mIGF1dG9tYXRpYw0KICogY29u\nZmlndXJhdGlvbiwgdGhpcyBpbXBsZW1lbnRhdGlvbiBrZXlzIG9uIG9ubHkg\ndGhlIGxhc3QgZG90LXNlcGFyYXRlZA0KICogdG9rZW4gb2YgdGhlIGxvZyBj\naGFubmVsIG5hbWUuDQogKg0KICogQGF1dGhvciBQYXRyaWNrIExpbnNrZXkN\nCiAqLw0KcHVibGljIGNsYXNzIExvZ0ZhY3RvcnlJbXBsIA0KICAgIGltcGxl\nbWVudHMgTG9nRmFjdG9yeSwgR2VuZXJpY0NvbmZpZ3VyYWJsZSwgQ29uZmln\ndXJhYmxlIHsNCg0KICAgIHByaXZhdGUgc3RhdGljIExvY2FsaXplciBfbG9j\nID0gTG9jYWxpemVyLmZvclBhY2thZ2UoTG9nRmFjdG9yeUltcGwuY2xhc3Mp\nOw0KICAgIHByaXZhdGUgc3RhdGljIExvY2FsaXplciBfbG9jRW4gPSBMb2Nh\nbGl6ZXIuZm9yUGFja2FnZSgNCiAgICAgICAgTG9nRmFjdG9yeUltcGwuY2xh\nc3MsIExvY2FsZS5FTkdMSVNIKTsNCg0KICAgIHB1YmxpYyBzdGF0aWMgZmlu\nYWwgU3RyaW5nIFRSQUNFX1NUUiA9IF9sb2NFbi5nZXQoImxvZy10cmFjZSIp\nLmdldE1lc3NhZ2UoKTsNCiAgICBwdWJsaWMgc3RhdGljIGZpbmFsIFN0cmlu\nZyBJTkZPX1NUUiA9IF9sb2NFbi5nZXQoImxvZy1pbmZvIikuZ2V0TWVzc2Fn\nZSgpOw0KICAgIHB1YmxpYyBzdGF0aWMgZmluYWwgU3RyaW5nIFdBUk5fU1RS\nID0gX2xvY0VuLmdldCgibG9nLXdhcm4iKS5nZXRNZXNzYWdlKCk7DQogICAg\ncHVibGljIHN0YXRpYyBmaW5hbCBTdHJpbmcgRVJST1JfU1RSID0gX2xvY0Vu\nLmdldCgibG9nLWVycm9yIikuZ2V0TWVzc2FnZSgpOw0KICAgIHB1YmxpYyBz\ndGF0aWMgZmluYWwgU3RyaW5nIEZBVEFMX1NUUiA9IF9sb2NFbi5nZXQoImxv\nZy1mYXRhbCIpLmdldE1lc3NhZ2UoKTsNCg0KICAgIHB1YmxpYyBzdGF0aWMg\nZmluYWwgU3RyaW5nIFNURE9VVCA9ICJzdGRvdXQiOw0KICAgIHB1YmxpYyBz\ndGF0aWMgZmluYWwgU3RyaW5nIFNUREVSUiA9ICJzdGRlcnIiOw0KDQogICAg\ncHJpdmF0ZSBzdGF0aWMgZmluYWwgU3RyaW5nIE5FV0xJTkUgPSBKMkRvUHJp\ndkhlbHBlci5nZXRMaW5lU2VwYXJhdG9yKCk7DQoNCiAgICAvKioNCiAgICAg\nKiBUaGUgdGltZSBhdCB3aGljaCB0aGlzIGZhY3Rvcnkgd2FzIGluaXRpYWxp\nemVkLg0KICAgICAqLw0KICAgIHByb3RlY3RlZCBmaW5hbCBsb25nIGluaXRp\nYWxpemF0aW9uTWlsbGlzOw0KDQogICAgLyoqDQogICAgICogVGhlIHtAbGlu\nayBMb2d9cyB0aGF0IHRoaXMgZmFjdG9yeSBtYW5hZ2VzLCBrZXllZCBieSBs\nb2cgY2hhbm5lbCBuYW1lLg0KICAgICAqLw0KICAgIHByaXZhdGUgTWFwIF9s\nb2dzID0gbmV3IENvbmN1cnJlbnRIYXNoTWFwKCk7IC8vIDxTdHJpbmcsTG9n\nPg0KDQogICAgLyoqDQogICAgICogVGhlIGRlZmF1bHQgbG9nZ2luZyBsZXZl\nbC4NCiAgICAgKi8NCiAgICBwcml2YXRlIHNob3J0IF9kZWZhdWx0TG9nTGV2\nZWwgPSBMb2cuSU5GTzsNCg0KICAgIC8qKg0KICAgICAqIFN0b3JhZ2UgZm9y\nIGxvZ2dpbmcgbGV2ZWwgY29uZmlndXJhdGlvbiBzcGVjaWZpZWQgYXQgY29u\nZmlndXJhdGlvbiB0aW1lLg0KICAgICAqLw0KICAgIHByaXZhdGUgTWFwIF9j\nb25maWd1cmVkTGV2ZWxzID0gbmV3IEhhc2hNYXAoKTsgLy8gPFN0cmluZyxJ\nbnRlZ2VyPg0KDQogICAgLyoqDQogICAgICogVGhlIHN0cmVhbSB0byB3cml0\nZSB0by4gRGVmYXVsdHMgdG8gU3lzdGVtLmVyci4NCiAgICAgKi8NCiAgICBw\ncml2YXRlIFByaW50U3RyZWFtIF9vdXQgPSBTeXN0ZW0uZXJyOw0KDQogICAg\nLyoqDQogICAgICogQSB0b2tlbiB0byBhZGQgdG8gYWxsIGxvZyBtZXNzYWdl\ncy4gSWYgPGNvZGU+bnVsbDwvY29kZT4sIHRoZSANCiAgICAgKiBjb25maWd1\ncmF0aW9uJ3MgaWQgd2lsbCBiZSB1c2VkLg0KICAgICAqLw0KICAgIHByaXZh\ndGUgU3RyaW5nIF9kaWFnQ29udGV4dCA9IG51bGw7DQogICAgcHJpdmF0ZSBi\nb29sZWFuIF9kaWFnQ29udGV4dENvbXB1dGVkID0gZmFsc2U7DQogICAgDQog\nICAgcHJpdmF0ZSBDb25maWd1cmF0aW9uIF9jb25mOw0KDQoNCiAgICBwdWJs\naWMgTG9nRmFjdG9yeUltcGwoKSB7DQogICAgICAgIGluaXRpYWxpemF0aW9u\nTWlsbGlzID0gU3lzdGVtLmN1cnJlbnRUaW1lTWlsbGlzKCk7DQogICAgfQ0K\nDQogICAgcHVibGljIExvZyBnZXRMb2coU3RyaW5nIGNoYW5uZWwpIHsNCiAg\nICAgICAgLy8gbm8gbG9ja2luZzsgb2sgaWYgc2FtZSBsb2cgY3JlYXRlZCBt\ndWx0aXBsZSB0aW1lcw0KICAgICAgICBMb2dJbXBsIGwgPSAoTG9nSW1wbCkg\nX2xvZ3MuZ2V0KGNoYW5uZWwpOw0KICAgICAgICBpZiAobCA9PSBudWxsKSB7\nDQogICAgICAgICAgICBsID0gbmV3TG9nSW1wbCgpOw0KICAgICAgICAgICAg\nbC5zZXRDaGFubmVsKGNoYW5uZWwpOw0KICAgICAgICAgICAgU2hvcnQgbHZs\nID0gKFNob3J0KSBfY29uZmlndXJlZExldmVscy5nZXQoc2hvcnRlbihjaGFu\nbmVsKSk7DQogICAgICAgICAgICBsLnNldExldmVsKGx2bCA9PSBudWxsID8g\nX2RlZmF1bHRMb2dMZXZlbCA6IGx2bC5zaG9ydFZhbHVlKCkpOw0KICAgICAg\nICAgICAgX2xvZ3MucHV0KGNoYW5uZWwsIGwpOw0KICAgICAgICB9DQogICAg\nICAgIHJldHVybiBsOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIENyZWF0\nZSBhIG5ldyBsb2cuIFRoZSBsb2cgd2lsbCBiZSBjYWNoZWQuDQogICAgICov\nDQogICAgcHJvdGVjdGVkIExvZ0ltcGwgbmV3TG9nSW1wbCgpIHsNCiAgICAg\nICAgcmV0dXJuIG5ldyBMb2dJbXBsKCk7DQogICAgfQ0KDQogICAgLyoqDQog\nICAgICogVGhlIHN0cmluZyBuYW1lIG9mIHRoZSBkZWZhdWx0IGxldmVsIGZv\nciB1bmNvbmZpZ3VyZWQgbG9nIGNoYW5uZWxzOw0KICAgICAqIHVzZWQgZm9y\nIGF1dG9tYXRpYyBjb25maWd1cmF0aW9uLg0KICAgICAqLw0KICAgIHB1Ymxp\nYyB2b2lkIHNldERlZmF1bHRMZXZlbChTdHJpbmcgbGV2ZWwpIHsNCiAgICAg\nICAgX2RlZmF1bHRMb2dMZXZlbCA9IGdldExldmVsKGxldmVsKTsNCiAgICB9\nDQoNCiAgICAvKioNCiAgICAgKiBUaGUgZGVmYXVsdCBsZXZlbCBmb3IgdW5j\nb25maWd1cmVkIGxvZyBjaGFubmVscy4NCiAgICAgKi8NCiAgICBwdWJsaWMg\nc2hvcnQgZ2V0RGVmYXVsdExldmVsKCkgew0KICAgICAgICByZXR1cm4gX2Rl\nZmF1bHRMb2dMZXZlbDsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiBUaGUg\nZGVmYXVsdCBsZXZlbCBmb3IgdW5jb25maWd1cmVkIGxvZyBjaGFubmVscy4N\nCiAgICAgKi8NCiAgICBwdWJsaWMgdm9pZCBzZXREZWZhdWx0TGV2ZWwoc2hv\ncnQgbGV2ZWwpIHsNCiAgICAgICAgX2RlZmF1bHRMb2dMZXZlbCA9IGxldmVs\nOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIEEgc3RyaW5nIHRvIHByZWZp\neCBhbGwgbG9nIG1lc3NhZ2VzIHdpdGguIFNldCB0bw0KICAgICAqIDxjb2Rl\nPm51bGw8L2NvZGU+IHRvIHVzZSB0aGUgY29uZmlndXJhdGlvbidzIElkIHBy\nb3BlcnR5IHNldHRpbmcuDQogICAgICovDQogICAgcHVibGljIHZvaWQgc2V0\nRGlhZ25vc3RpY0NvbnRleHQoU3RyaW5nIHZhbCkgew0KICAgICAgICBfZGlh\nZ0NvbnRleHQgPSB2YWw7DQogICAgfQ0KDQogICAgLyoqDQogICAgICogQSBz\ndHJpbmcgdG8gcHJlZml4IGFsbCBsb2cgbWVzc2FnZXMgd2l0aC4gU2V0IHRv\nDQogICAgICogPGNvZGU+bnVsbDwvY29kZT4gdG8gdXNlIHRoZSBjb25maWd1\ncmF0aW9uJ3MgSWQgcHJvcGVydHkgc2V0dGluZy4NCiAgICAgKi8NCiAgICBw\ndWJsaWMgU3RyaW5nIGdldERpYWdub3N0aWNDb250ZXh0KCkgew0KICAgICAg\nICBpZiAoIV9kaWFnQ29udGV4dENvbXB1dGVkKSB7DQogICAgICAgICAgICAv\nLyB0aGlzIGluaXRpYWxpemF0aW9uIGhhcyB0byBoYXBwZW4gbGF6aWx5IGJl\nY2F1c2UgdGhlcmUgaXMgbm8NCiAgICAgICAgICAgIC8vIGd1YXJhbnRlZSB0\naGF0IGNvbmYuZ2V0SWQoKSB3aWxsIGJlIHBvcHVsYXRlZCBieSB0aGUgdGlt\nZSB0aGF0DQogICAgICAgICAgICAvLyBlbmRDb25maWd1cmF0aW9uKCkgaXMg\nY2FsbGVkLg0KICAgICAgICAgICAgaWYgKF9kaWFnQ29udGV4dCA9PSBudWxs\nICYmIF9jb25mICE9IG51bGwpIHsNCiAgICAgICAgICAgICAgICBfZGlhZ0Nv\nbnRleHQgPSBfY29uZi5nZXRJZCgpOw0KICAgICAgICAgICAgfQ0KICAgICAg\nICAgICAgaWYgKCIiLmVxdWFscyhfZGlhZ0NvbnRleHQpKQ0KICAgICAgICAg\nICAgICAgIF9kaWFnQ29udGV4dCA9IG51bGw7DQogICAgICAgICAgICBfZGlh\nZ0NvbnRleHRDb21wdXRlZCA9IHRydWU7DQogICAgICAgIH0NCiAgICAgICAg\ncmV0dXJuIF9kaWFnQ29udGV4dDsNCiAgICB9DQoNCiAgICAvKioNCiAgICAg\nKiBUaGUgc3RyZWFtIHRvIHdyaXRlIHRvLiBSZWNvZ25pemVkIHZhbHVlcyBh\ncmU6IDxjb2RlPnN0ZG91dDwvY29kZT4NCiAgICAgKiBhbmQgPGNvZGU+c3Rk\nZXJyPC9jb2RlPi4gQW55IG90aGVyIHZhbHVlIHdpbGwgYmUgY29uc2lkZXJl\nZCBhIGZpbGUgbmFtZS4NCiAgICAgKi8NCiAgICBwdWJsaWMgdm9pZCBzZXRG\naWxlKFN0cmluZyBmaWxlKSB7DQogICAgICAgIGlmIChTVERPVVQuZXF1YWxz\nKGZpbGUpKQ0KICAgICAgICAgICAgX291dCA9IFN5c3RlbS5vdXQ7DQogICAg\nICAgIGVsc2UgaWYgKFNUREVSUi5lcXVhbHMoZmlsZSkpDQogICAgICAgICAg\nICBfb3V0ID0gU3lzdGVtLmVycjsNCiAgICAgICAgZWxzZSB7DQogICAgICAg\nICAgICBGaWxlIGYgPSBGaWxlcy5nZXRGaWxlKGZpbGUsIG51bGwpOw0KICAg\nICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgICBfb3V0ID0gbmV3IFBy\naW50U3RyZWFtKChGaWxlT3V0cHV0U3RyZWFtKQ0KICAgICAgICAgICAgICAg\nICAgICBBY2Nlc3NDb250cm9sbGVyLmRvUHJpdmlsZWdlZCgNCiAgICAgICAg\nICAgICAgICAgICAgICAgIEoyRG9Qcml2SGVscGVyLm5ld0ZpbGVPdXRwdXRT\ndHJlYW1BY3Rpb24oDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgKFN0\ncmluZykgQWNjZXNzQ29udHJvbGxlci5kb1ByaXZpbGVnZWQoDQogICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgIEoyRG9Qcml2SGVscGVyLmdldENh\nbm9uaWNhbFBhdGhBY3Rpb24oZikpLA0KICAgICAgICAgICAgICAgICAgICAg\nICAgICAgIHRydWUpKSk7DQogICAgICAgICAgICB9IGNhdGNoIChQcml2aWxl\nZ2VkQWN0aW9uRXhjZXB0aW9uIHBhZSkgew0KICAgICAgICAgICAgICAgIHRo\ncm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24oX2xvYy5nZXQoImxv\nZy1iYWQtZmlsZSIsDQogICAgICAgICAgICAgICAgICAgICAgICBmaWxlKSAr\nICIgIiArIHBhZS5nZXRFeGNlcHRpb24oKSk7DQogICAgICAgICAgICB9IGNh\ndGNoIChJT0V4Y2VwdGlvbiBpb2UpIHsNCiAgICAgICAgICAgICAgICB0aHJv\ndyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uKF9sb2MuZ2V0KCJsb2ct\nYmFkLWZpbGUiLA0KICAgICAgICAgICAgICAgICAgICBmaWxlKSArICIgIiAr\nIGlvZS50b1N0cmluZygpKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0K\nICAgIH0NCg0KICAgIC8qKg0KICAgICAqIFRoZSBzdHJlYW0gdG8gd3JpdGUg\ndG8uDQogICAgICovDQogICAgcHVibGljIFByaW50U3RyZWFtIGdldFN0cmVh\nbSgpIHsNCiAgICAgICAgcmV0dXJuIF9vdXQ7DQogICAgfQ0KDQogICAgLyoq\nDQogICAgICogVGhlIHN0cmVhbSB0byB3cml0ZSB0by4NCiAgICAgKi8NCiAg\nICBwdWJsaWMgdm9pZCBzZXRTdHJlYW0oUHJpbnRTdHJlYW0gc3RyZWFtKSB7\nDQogICAgICAgIGlmIChzdHJlYW0gPT0gbnVsbCkNCiAgICAgICAgICAgIHRo\ncm93IG5ldyBOdWxsUG9pbnRlckV4Y2VwdGlvbigic3RyZWFtID09IG51bGwi\nKTsNCiAgICAgICAgX291dCA9IHN0cmVhbTsNCiAgICB9DQoNCiAgICAvKioN\nCiAgICAgKiBSZXR1cm5zIGEgc3RyaW5nIHJlcHJlc2VudGF0aW9uIG9mIHRo\nZSBzcGVjaWZpZWQgbG9nIGxldmVsIGNvbnN0YW50Lg0KICAgICAqLw0KICAg\nIHB1YmxpYyBzdGF0aWMgU3RyaW5nIGdldExldmVsTmFtZShzaG9ydCBsZXZl\nbCkgew0KICAgICAgICBzd2l0Y2ggKGxldmVsKSB7DQogICAgICAgICAgICBj\nYXNlIExvZy5UUkFDRToNCiAgICAgICAgICAgICAgICByZXR1cm4gVFJBQ0Vf\nU1RSOw0KICAgICAgICAgICAgY2FzZSBMb2cuSU5GTzoNCiAgICAgICAgICAg\nICAgICByZXR1cm4gSU5GT19TVFI7DQogICAgICAgICAgICBjYXNlIExvZy5X\nQVJOOg0KICAgICAgICAgICAgICAgIHJldHVybiBXQVJOX1NUUjsNCiAgICAg\nICAgICAgIGNhc2UgTG9nLkVSUk9SOg0KICAgICAgICAgICAgICAgIHJldHVy\nbiBFUlJPUl9TVFI7DQogICAgICAgICAgICBjYXNlIExvZy5GQVRBTDoNCiAg\nICAgICAgICAgICAgICByZXR1cm4gRkFUQUxfU1RSOw0KICAgICAgICAgICAg\nZGVmYXVsdDoNCiAgICAgICAgICAgICAgICByZXR1cm4gX2xvY0VuLmdldCgi\nbG9nLXVua25vd24iKS5nZXRNZXNzYWdlKCk7DQogICAgICAgIH0NCiAgICB9\nDQoNCiAgICAvKioNCiAgICAgKiBSZXR1cm5zIGEgc3ltYm9saWMgY29uc3Rh\nbnQgZm9yIHRoZSBzcGVjaWZpZWQgc3RyaW5nIGxldmVsLg0KICAgICAqLw0K\nICAgIHB1YmxpYyBzdGF0aWMgc2hvcnQgZ2V0TGV2ZWwoU3RyaW5nIHN0cikg\new0KICAgICAgICBzdHIgPSBzdHIudG9VcHBlckNhc2UoKS50cmltKCk7DQog\nICAgICAgIHNob3J0IHZhbCA9IFRSQUNFX1NUUi5lcXVhbHMoc3RyKSA/IExv\nZy5UUkFDRSA6DQogICAgICAgICAgICBJTkZPX1NUUi5lcXVhbHMoc3RyKSA/\nIExvZy5JTkZPIDoNCiAgICAgICAgICAgICAgICBXQVJOX1NUUi5lcXVhbHMo\nc3RyKSA/IExvZy5XQVJOIDoNCiAgICAgICAgICAgICAgICAgICAgRVJST1Jf\nU1RSLmVxdWFscyhzdHIpID8gTG9nLkVSUk9SIDoNCiAgICAgICAgICAgICAg\nICAgICAgICAgIEZBVEFMX1NUUi5lcXVhbHMoc3RyKSA/IExvZy5GQVRBTCA6\nIC0xOw0KDQogICAgICAgIGlmICh2YWwgPT0gLTEpDQogICAgICAgICAgICB0\naHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uDQogICAgICAgICAg\nICAgICAgKF9sb2MuZ2V0KCJsb2ctYmFkLWNvbnN0YW50Iiwgc3RyKS5nZXRN\nZXNzYWdlKCkpOw0KDQogICAgICAgIHJldHVybiB2YWw7DQogICAgfQ0KDQog\nICAgLy8gLS0tLS0tLS0tLSBDb25maWd1cmFibGUgaW1wbGVtZW50YXRpb24g\nLS0tLS0tLS0tLQ0KICAgIA0KICAgIHB1YmxpYyB2b2lkIHNldENvbmZpZ3Vy\nYXRpb24oQ29uZmlndXJhdGlvbiBjb25mKSB7DQogICAgICAgIF9jb25mID0g\nY29uZjsNCiAgICB9DQogICAgDQogICAgcHVibGljIHZvaWQgc3RhcnRDb25m\naWd1cmF0aW9uKCkgew0KICAgIH0NCg0KICAgIHB1YmxpYyB2b2lkIGVuZENv\nbmZpZ3VyYXRpb24oKSB7DQogICAgfQ0KDQogICAgLy8gLS0tLS0tLS0tLSBH\nZW5lcmljQ29uZmlndXJhYmxlIGltcGxlbWVudGF0aW9uIC0tLS0tLS0tLS0N\nCg0KICAgIHB1YmxpYyB2b2lkIHNldEludG8oT3B0aW9ucyBvcHRzKSB7DQog\nICAgICAgIGlmICghb3B0cy5pc0VtcHR5KCkpIHsNCiAgICAgICAgICAgIE1h\ncC5FbnRyeSBlOw0KICAgICAgICAgICAgZm9yIChJdGVyYXRvciBpdGVyID0g\nb3B0cy5lbnRyeVNldCgpLml0ZXJhdG9yKCk7IGl0ZXIuaGFzTmV4dCgpOykg\new0KICAgICAgICAgICAgICAgIGUgPSAoTWFwLkVudHJ5KSBpdGVyLm5leHQo\nKTsNCiAgICAgICAgICAgICAgICBfY29uZmlndXJlZExldmVscy5wdXQoc2hv\ncnRlbigoU3RyaW5nKSBlLmdldEtleSgpKSwNCiAgICAgICAgICAgICAgICAg\nICAgbmV3IFNob3J0KGdldExldmVsKChTdHJpbmcpIGUuZ2V0VmFsdWUoKSkp\nKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIG9wdHMuY2xlYXIoKTsN\nCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIHByaXZhdGUgc3RhdGljIFN0cmlu\nZyBzaG9ydGVuKFN0cmluZyBjaGFubmVsKSB7DQogICAgICAgIHJldHVybiBj\naGFubmVsLnN1YnN0cmluZyhjaGFubmVsLmxhc3RJbmRleE9mKCcuJykgKyAx\nKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiBBIHNpbXBsZSBpbXBsZW1l\nbnRhdGlvbiBvZiB0aGUge0BsaW5rIExvZ30gaW50ZXJmYWNlLiBXcml0ZXMN\nCiAgICAgKiBvdXRwdXQgdG8gc3RkZXJyLg0KICAgICAqLw0KICAgIHB1Ymxp\nYyBjbGFzcyBMb2dJbXBsIGV4dGVuZHMgQWJzdHJhY3RMb2cgew0KDQogICAg\nICAgIHByaXZhdGUgc2hvcnQgX2xldmVsID0gSU5GTzsNCiAgICAgICAgcHJp\ndmF0ZSBTdHJpbmcgX2NoYW5uZWw7DQoNCiAgICAgICAgcHJvdGVjdGVkIGJv\nb2xlYW4gaXNFbmFibGVkKHNob3J0IGxldmVsKSB7DQogICAgICAgICAgICBy\nZXR1cm4gbGV2ZWwgPj0gX2xldmVsOw0KICAgICAgICB9DQoNCiAgICAgICAg\ncHJvdGVjdGVkIHZvaWQgbG9nKHNob3J0IGxldmVsLCBTdHJpbmcgbWVzc2Fn\nZSwgVGhyb3dhYmxlIHQpIHsNCiAgICAgICAgICAgIFN0cmluZyBtc2cgPSBm\nb3JtYXRNZXNzYWdlKGxldmVsLCBtZXNzYWdlLCB0KTsNCiAgICAgICAgICAg\nIHN5bmNocm9uaXplZCAoX291dCkgew0KICAgICAgICAgICAgICAgIF9vdXQu\ncHJpbnQobXNnKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAg\nICAgIC8qKg0KICAgICAgICAgKiBDb252ZXJ0IDxjb2RlPm1lc3NhZ2U8L2Nv\nZGU+IGludG8gYSBzdHJpbmcgcmVhZHkgdG8gYmUgd3JpdHRlbiB0bw0KICAg\nICAgICAgKiB0aGUgbG9nLiBUaGUgc3RyaW5nIHNob3VsZCBpbmNsdWRlIHRo\nZSB0ZXJtaW5hdGluZyBuZXdsaW5lLg0KICAgICAgICAgKg0KICAgICAgICAg\nKiBAcGFyYW0gdCBtYXkgYmUgbnVsbA0KICAgICAgICAgKi8NCiAgICAgICAg\ncHJvdGVjdGVkIFN0cmluZyBmb3JtYXRNZXNzYWdlKHNob3J0IGxldmVsLCBT\ndHJpbmcgbWVzc2FnZSwNCiAgICAgICAgICAgIFRocm93YWJsZSB0KSB7DQog\nICAgICAgICAgICAvLyB3ZSB3cml0ZSB0byBhIFN0cmluZ0J1ZmZlciBhbmQg\ndGhlbiBmbHVzaCBpdCBhbGwgYXQNCiAgICAgICAgICAgIC8vIG9uY2UgYXMg\nYSBzaW5nbGUgbGluZSwgc2luY2Ugc29tZSBlbnZpcm9ubWVudHMoZS5nLiwg\nSkJvc3MpDQogICAgICAgICAgICAvLyBvdmVycmlkZSB0aGUgU3lzdGVtIG91\ndHB1dCBzdHJlYW0gdG8gZmx1c2ggYW55IGNhbGxzDQogICAgICAgICAgICAv\nLyB0byB3cml0ZSB3aXRob3V0IHJlZ2FyZCB0byBsaW5lIGJyZWFrcywgbWFr\naW5nIHRoZQ0KICAgICAgICAgICAgLy8gb3V0cHV0IGluY29tcHJlaGVuc2li\nZS4NCiAgICAgICAgICAgIFN0cmluZ0J1ZmZlciBidWYgPSBuZXcgU3RyaW5n\nQnVmZmVyKCk7DQoNCiAgICAgICAgICAgIGJ1Zi5hcHBlbmQoZ2V0T2Zmc2V0\nKCkpOw0KICAgICAgICAgICAgYnVmLmFwcGVuZCgiICAiKTsNCiAgICAgICAg\nICAgIGlmIChnZXREaWFnbm9zdGljQ29udGV4dCgpICE9IG51bGwpDQogICAg\nICAgICAgICAgICAgYnVmLmFwcGVuZChnZXREaWFnbm9zdGljQ29udGV4dCgp\nKS5hcHBlbmQoIiAgIik7DQogICAgICAgICAgICBidWYuYXBwZW5kKGdldExl\ndmVsTmFtZShsZXZlbCkpOw0KICAgICAgICAgICAgaWYgKGxldmVsID09IElO\nRk8gfHwgbGV2ZWwgPT0gV0FSTikNCiAgICAgICAgICAgICAgICBidWYuYXBw\nZW5kKCIgIik7DQogICAgICAgICAgICBidWYuYXBwZW5kKCIgIFsiKTsNCiAg\nICAgICAgICAgIGJ1Zi5hcHBlbmQoVGhyZWFkLmN1cnJlbnRUaHJlYWQoKS5n\nZXROYW1lKCkpOw0KICAgICAgICAgICAgYnVmLmFwcGVuZCgiXSAiKTsNCiAg\nICAgICAgICAgIGJ1Zi5hcHBlbmQoX2NoYW5uZWwpOw0KICAgICAgICAgICAg\nYnVmLmFwcGVuZCgiIC0gIik7DQogICAgICAgICAgICBidWYuYXBwZW5kKG1l\nc3NhZ2UpOw0KICAgICAgICAgICAgYnVmLmFwcGVuZChORVdMSU5FKTsNCg0K\nICAgICAgICAgICAgaWYgKHQgIT0gbnVsbCkgew0KICAgICAgICAgICAgICAg\nIFN0cmluZ1dyaXRlciBzd3JpdGVyID0gbmV3IFN0cmluZ1dyaXRlcigpOw0K\nICAgICAgICAgICAgICAgIFByaW50V3JpdGVyIHB3cml0ZXIgPSBuZXcgUHJp\nbnRXcml0ZXIoc3dyaXRlcik7DQogICAgICAgICAgICAgICAgdC5wcmludFN0\nYWNrVHJhY2UocHdyaXRlcik7DQogICAgICAgICAgICAgICAgcHdyaXRlci5m\nbHVzaCgpOw0KICAgICAgICAgICAgICAgIGJ1Zi5hcHBlbmQoc3dyaXRlci50\nb1N0cmluZygpKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHJldHVy\nbiBidWYudG9TdHJpbmcoKTsNCiAgICAgICAgfQ0KDQogICAgICAgIHByaXZh\ndGUgbG9uZyBnZXRPZmZzZXQoKSB7DQogICAgICAgICAgICByZXR1cm4gU3lz\ndGVtLmN1cnJlbnRUaW1lTWlsbGlzKCkgLSBpbml0aWFsaXphdGlvbk1pbGxp\nczsNCiAgICAgICAgfQ0KDQogICAgICAgIHB1YmxpYyB2b2lkIHNldENoYW5u\nZWwoU3RyaW5nIHZhbCkgew0KICAgICAgICAgICAgX2NoYW5uZWwgPSB2YWw7\nDQogICAgICAgIH0NCg0KICAgICAgICBwdWJsaWMgU3RyaW5nIGdldENoYW5u\nZWwoKSB7DQogICAgICAgICAgICByZXR1cm4gX2NoYW5uZWw7DQogICAgICAg\nIH0NCg0KICAgICAgICBwdWJsaWMgdm9pZCBzZXRMZXZlbChzaG9ydCB2YWwp\nIHsNCiAgICAgICAgICAgIF9sZXZlbCA9IHZhbDsNCiAgICAgICAgfQ0KDQog\nICAgICAgIHB1YmxpYyBzaG9ydCBnZXRMZXZlbCgpIHsNCiAgICAgICAgICAg\nIHJldHVybiBfbGV2ZWw7DQogICAgICAgIH0NCiAgICB9DQp9DQo=\n","encoding":"base64"}

