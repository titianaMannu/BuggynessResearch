{"sha":"b34191b5e0db4b4d62d754fa85049fce2e6754ff","node_id":"MDQ6QmxvYjIwNjM2NDpiMzQxOTFiNWUwZGI0YjRkNjJkNzU0ZmE4NTA0OWZjZTJlNjc1NGZm","size":9364,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/b34191b5e0db4b4d62d754fa85049fce2e6754ff","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWw7CgppbXBvcnQg\namF2YS5pby5JT0V4Y2VwdGlvbjsKaW1wb3J0IGphdmEubmV0LkluZXRBZGRy\nZXNzOwppbXBvcnQgamF2YS5zZWN1cml0eS5TZWN1cmVSYW5kb207CmltcG9y\ndCBqYXZhLnV0aWwuUmFuZG9tOwppbXBvcnQgamF2YS51dGlsLlVVSUQ7Cgpp\nbXBvcnQgb3JnLmFwYWNoZS5jb21tb25zLmxhbmcuZXhjZXB0aW9uLk5lc3Rh\nYmxlUnVudGltZUV4Y2VwdGlvbjsKCi8qKgogKiBVVUlEIHZhbHVlIGdlbmVy\nYXRvci4gIFR5cGUgMSBnZW5lcmF0b3IgaXMgYmFzZWQgb24gdGhlIHRpbWUt\nYmFzZWQgZ2VuZXJhdG9yICAKICogaW4gdGhlIEFwYWNoZSBDb21tb25zIElk\nIHByb2plY3Q6ICBodHRwOi8vamFrYXJ0YS5hcGFjaGUub3JnL2NvbW1vbnMv\nc2FuZGJveAogKiAvaWQvdXVpZC5odG1sICBUaGUgdHlwZSA0IGdlbmVyYXRv\nciB1c2VzIHRoZSBzdGFuZGFyZCBKYXZhIFVVSUQgZ2VuZXJhdG9yLgogKgog\nKiBUaGUgdHlwZSAxIGNvZGUgaGFzIGJlZW4gdmFzdGx5IHNpbXBsaWZpZWQg\nYW5kIG1vZGlmaWVkIHRvIHJlcGxhY2UgdGhlIAogKiBldGhlcm5ldCBhZGRy\nZXNzIG9mIHRoZSBob3N0IG1hY2hpbmUgd2l0aCB0aGUgSVAsIHNpbmNlIHdl\nIGRvIG5vdCB3YW50IHRvIAogKiByZXF1aXJlIG5hdGl2ZSBsaWJzIGFuZCBK\nYXZhIGNhbm5vdCBhY2Nlc3MgdGhlIE1BQyBhZGRyZXNzIGRpcmVjdGx5Lgog\nKgogKiBJbiBzcGlyaXQsIGltcGxlbWVudHMgdGhlIElFVEYgVVVJRCBkcmFm\ndCBzcGVjaWZpY2F0aW9uLCBmb3VuZCBoZXJlOjxiciAvPgogKiBodHRwOi8v\nd3d3MS5pY3MudWNpLmVkdS9+ZWp3L2F1dGhvcmluZy91dWlkLWd1aWQvZHJh\nZnQtbGVhY2gtdXVpZHMtZ3VpZHMtMDEKICogLnR4dAogKgogKiBAYXV0aG9y\nIEFiZSBXaGl0ZSwgS2V2aW4gU3V0dGVyCiAqIEBub2phdmFkb2MKICogQHNp\nbmNlIDAuMy4zCiAqLwpwdWJsaWMgY2xhc3MgVVVJREdlbmVyYXRvciB7Cgog\nICAgLy8gc3VwcG9ydGVkIFVVSUQgdHlwZXMKICAgIHB1YmxpYyBzdGF0aWMg\nZmluYWwgaW50IFRZUEUxID0gMTsKICAgIHB1YmxpYyBzdGF0aWMgZmluYWwg\naW50IFRZUEU0ID0gNDsKCiAgICAvLyBpbmRleGVzIHdpdGhpbiB0aGUgdXVp\nZCBhcnJheSBmb3IgY2VydGFpbiBib3VuZGFyaWVzCiAgICBwcml2YXRlIHN0\nYXRpYyBmaW5hbCBieXRlIElEWF9USU1FX0hJID0gNjsKICAgIHByaXZhdGUg\nc3RhdGljIGZpbmFsIGJ5dGUgSURYX1RZUEUgPSA2OyAvLyBtdWx0aXBsZXhl\nZAogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgYnl0ZSBJRFhfVElNRV9NSUQg\nPSA0OwogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgYnl0ZSBJRFhfVElNRV9M\nTyA9IDA7CiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBieXRlIElEWF9USU1F\nX1NFUSA9IDg7CiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBieXRlIElEWF9W\nQVJJQVRJT04gPSA4OyAvLyBtdWx0aXBsZXhlZAoKICAgIC8vIGluZGV4ZXMg\nYW5kIGxlbmd0aHMgd2l0aGluIHRoZSB0aW1lc3RhbXAgZm9yIGNlcnRhaW4g\nYm91bmRhcmllcwogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgYnl0ZSBUU19U\nSU1FX0xPX0lEWCA9IDQ7CiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBieXRl\nIFRTX1RJTUVfTE9fTEVOID0gNDsKICAgIHByaXZhdGUgc3RhdGljIGZpbmFs\nIGJ5dGUgVFNfVElNRV9NSURfSURYID0gMjsKICAgIHByaXZhdGUgc3RhdGlj\nIGZpbmFsIGJ5dGUgVFNfVElNRV9NSURfTEVOID0gMjsKICAgIHByaXZhdGUg\nc3RhdGljIGZpbmFsIGJ5dGUgVFNfVElNRV9ISV9JRFggPSAwOwogICAgcHJp\ndmF0ZSBzdGF0aWMgZmluYWwgYnl0ZSBUU19USU1FX0hJX0xFTiA9IDI7Cgog\nICAgLy8gb2Zmc2V0IHRvIG1vdmUgZnJvbSAxLzEvMTk3MCwgd2hpY2ggaXMg\nMC10aW1lIGZvciBKYXZhLCB0byBncmVnb3JpYW4KICAgIC8vIDAtdGltZSAx\nMC8xNS8xNTgyLCBhbmQgbXVsdGlwbGllciB0byBnbyBmcm9tIDEwMG5zZWMg\ndG8gbXNlYyB1bml0cwogICAgcHJpdmF0ZSBzdGF0aWMgZmluYWwgbG9uZyBH\nUkVHX09GRlNFVCA9IDB4QjFEMDY5QjU0MDBMOwogICAgcHJpdmF0ZSBzdGF0\naWMgZmluYWwgbG9uZyBNSUxMSV9NVUxUID0gMTAwMDBMOwoKICAgIC8vIHR5\ncGUgb2YgVVVJRCAtLSB0aW1lIGJhc2VkCiAgICBwcml2YXRlIGZpbmFsIHN0\nYXRpYyBieXRlIFRZUEVfVElNRV9CQVNFRCA9IDB4MTA7CgogICAgLy8gcmFu\nZG9tIG51bWJlciBnZW5lcmF0b3IgdXNlZCB0byByZWR1Y2UgY29uZmxpY3Rz\nIHdpdGggb3RoZXIgSlZNcywgYW5kCiAgICAvLyBoYXNoZXIgZm9yIHN0cmlu\nZ3MuICAKICAgIHByaXZhdGUgc3RhdGljIFJhbmRvbSBSQU5ET007CgogICAg\nLy8gNC1ieXRlIElQIGFkZHJlc3MgKyAyIHJhbmRvbSBieXRlcyB0byBjb21w\nZW5zYXRlIGZvciB0aGUgZmFjdCB0aGF0CiAgICAvLyB0aGUgTUFDIGFkZHJl\nc3MgaXMgdXN1YWxseSA2IGJ5dGVzCiAgICBwcml2YXRlIHN0YXRpYyBieXRl\nW10gSVA7CgogICAgLy8gY291bnRlciBpcyBpbml0aWFsaXplZCB0byAwIGFu\nZCBpcyBpbmNyZW1lbnRlZCBmb3IgZWFjaCB1dWlkIHJlcXVlc3QKICAgIC8v\nIHdpdGhpbiB0aGUgc2FtZSB0aW1lc3RhbXAgd2luZG93LgogICAgcHJpdmF0\nZSBzdGF0aWMgaW50IF9jb3VudGVyOwoKICAgIC8vIGN1cnJlbnQgdGltZXN0\nYW1wICh1c2VkIHRvIGRldGVjdCBtdWx0aXBsZSB1dWlkIHJlcXVlc3RzIHdp\ndGhpbiBzYW1lCiAgICAvLyB0aW1lc3RhbXApCiAgICBwcml2YXRlIHN0YXRp\nYyBsb25nIF9jdXJyZW50TWlsbGlzOwoKICAgIC8vIGxhc3QgdXNlZCBtaWxs\naXMgdGltZSwgYW5kIGEgc2VtaS1yYW5kb20gc2VxdWVuY2UgdGhhdCBnZXRz\nIHJlc2V0CiAgICAvLyB3aGVuIGl0IG92ZXJmbG93cwogICAgcHJpdmF0ZSBz\ndGF0aWMgbG9uZyBfbGFzdE1pbGxpcyA9IDBMOwogICAgcHJpdmF0ZSBzdGF0\naWMgZmluYWwgaW50IE1BWF8xNEJJVCA9IDB4M0ZGRjsKICAgIHByaXZhdGUg\nc3RhdGljIHNob3J0IF9zZXEgPSAwOwogICAgICAgIAogICAgLyoKICAgICAq\nIEluaXRpYWxpemVyIGZvciB0eXBlIDEgVVVJRHMuICBDcmVhdGVzIHJhbmRv\nbSBnZW5lcmF0b3IgYW5kIGdlbmVuZXJhdGVzCiAgICAgKiB0aGUgbm9kZSBw\nb3J0aW9uIG9mIHRoZSBVVUlEIHVzaW5nIHRoZSBJUCBhZGRyZXNzLgogICAg\nICovCiAgICBwcml2YXRlIHN0YXRpYyBzeW5jaHJvbml6ZWQgdm9pZCBpbml0\naWFsaXplRm9yVHlwZTEoKQogICAgewogICAgICAgIGlmIChSQU5ET00gIT0g\nbnVsbCkKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIC8vIG5vdGUgdGhh\ndCBzZWN1cmUgcmFuZG9tIGlzIHZlcnkgc2xvdyB0aGUgZmlyc3QgdGltZQog\nICAgICAgIC8vIGl0IGlzIHVzZWQ7IGNvbnNpZGVyIHN3aXRjaGluZyB0byBh\nIHN0YW5kYXJkIHJhbmRvbQogICAgICAgIFJBTkRPTSA9IG5ldyBTZWN1cmVS\nYW5kb20oKTsKICAgICAgICBfc2VxID0gKHNob3J0KSBSQU5ET00ubmV4dElu\ndChNQVhfMTRCSVQpOwogICAgICAgIAogICAgICAgIGJ5dGVbXSBpcCA9IG51\nbGw7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgaXAgPSBJbmV0QWRkcmVz\ncy5nZXRMb2NhbEhvc3QoKS5nZXRBZGRyZXNzKCk7CiAgICAgICAgfSBjYXRj\naCAoSU9FeGNlcHRpb24gaW9lKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBO\nZXN0YWJsZVJ1bnRpbWVFeGNlcHRpb24oaW9lKTsKICAgICAgICB9CgogICAg\nICAgIElQID0gbmV3IGJ5dGVbNl07CiAgICAgICAgUkFORE9NLm5leHRCeXRl\ncyhJUCk7CiAgICAgICAgU3lzdGVtLmFycmF5Y29weShpcCwgMCwgSVAsIDIs\nIGlwLmxlbmd0aCk7ICAgICAgICAKICAgIH0KCiAgICAvKioKICAgICAqIFJl\ndHVybiBhIHVuaXF1ZSBVVUlEIHZhbHVlLgogICAgICovCiAgICBwdWJsaWMg\nc3RhdGljIGJ5dGVbXSBuZXh0KGludCB0eXBlKSB7CiAgICAgICAgaWYgKHR5\ncGUgPT0gVFlQRTQpIHsKICAgICAgICAgICAgcmV0dXJuIGNyZWF0ZVR5cGU0\nKCk7CiAgICAgICAgfQogICAgICAgIHJldHVybiBjcmVhdGVUeXBlMSgpOwog\nICAgfQogICAgICAKICAgIC8qCiAgICAgKiBDcmVhdGVzIGEgdHlwZSAxIFVV\nSUQgCiAgICAgKi8KICAgIHB1YmxpYyBzdGF0aWMgYnl0ZVtdIGNyZWF0ZVR5\ncGUxKCkgewogICAgICAgIGlmIChSQU5ET00gPT0gbnVsbCkKICAgICAgICAg\nICAgaW5pdGlhbGl6ZUZvclR5cGUxKCk7CiAgICAgICAgLy8gc2V0IGlwIGFk\nZHIKICAgICAgICBieXRlW10gdXVpZCA9IG5ldyBieXRlWzE2XTsKICAgICAg\nICBTeXN0ZW0uYXJyYXljb3B5KElQLCAwLCB1dWlkLCAxMCwgSVAubGVuZ3Ro\nKTsKCiAgICAgICAgLy8gU2V0IHRpbWUgaW5mby4gIEhhdmUgdG8gZG8gdGhp\ncyBwcm9jZXNzaW5nIHdpdGhpbiBhIHN5bmNocm9uaXplZAogICAgICAgIC8v\nIGJsb2NrIGJlY2F1c2Ugb2YgdGhlIHN0YXRpY3MuLi4KICAgICAgICBsb25n\nIG5vdyA9IDA7CiAgICAgICAgc3luY2hyb25pemVkIChVVUlER2VuZXJhdG9y\nLmNsYXNzKSB7CiAgICAgICAgICAgIC8vIEdldCB0aGUgdGltZSB0byB1c2Ug\nZm9yIHRoaXMgdXVpZC4gIFRoaXMgbWV0aG9kIGhhcyB0aGUgc2lkZQogICAg\nICAgICAgICAvLyBlZmZlY3Qgb2YgbW9kaWZ5aW5nIHRoZSBjbG9jayBzZXF1\nZW5jZSwgYXMgd2VsbC4KICAgICAgICAgICAgbm93ID0gZ2V0VGltZSgpOwoK\nICAgICAgICAgICAgLy8gSW5zZXJ0IHRoZSByZXN1bHRpbmcgY2xvY2sgc2Vx\ndWVuY2UgaW50byB0aGUgdXVpZAogICAgICAgICAgICB1dWlkW0lEWF9USU1F\nX1NFUV0gPSAoYnl0ZSkgKChfc2VxICYgMHgzRjAwKSA+Pj4gOCk7CiAgICAg\nICAgICAgIHV1aWRbSURYX1ZBUklBVElPTl0gfD0gMHg4MDsKICAgICAgICAg\nICAgdXVpZFtJRFhfVElNRV9TRVErMV0gPSAoYnl0ZSkgKF9zZXEgJiAweEZG\nKTsKCiAgICAgICAgfQoKICAgICAgICAvLyBoYXZlIHRvIGJyZWFrIHVwIHRp\nbWUgYmVjYXVzZSBieXRlcyBhcmUgc3ByZWFkIHRocm91Z2ggdXVpZAogICAg\nICAgIGJ5dGVbXSB0aW1lQnl0ZXMgPSBCeXRlcy50b0J5dGVzKG5vdyk7Cgog\nICAgICAgIC8vIENvcHkgdGltZSBsb3cKICAgICAgICBTeXN0ZW0uYXJyYXlj\nb3B5KHRpbWVCeXRlcywgVFNfVElNRV9MT19JRFgsIHV1aWQsIElEWF9USU1F\nX0xPLAogICAgICAgICAgICAgICAgVFNfVElNRV9MT19MRU4pOwogICAgICAg\nIC8vIENvcHkgdGltZSBtaWQKICAgICAgICBTeXN0ZW0uYXJyYXljb3B5KHRp\nbWVCeXRlcywgVFNfVElNRV9NSURfSURYLCB1dWlkLCBJRFhfVElNRV9NSUQs\nCiAgICAgICAgICAgICAgICBUU19USU1FX01JRF9MRU4pOwogICAgICAgIC8v\nIENvcHkgdGltZSBoaQogICAgICAgIFN5c3RlbS5hcnJheWNvcHkodGltZUJ5\ndGVzLCBUU19USU1FX0hJX0lEWCwgdXVpZCwgSURYX1RJTUVfSEksCiAgICAg\nICAgICAgICAgICBUU19USU1FX0hJX0xFTik7CiAgICAgICAgLy9TZXQgdmVy\nc2lvbiAodGltZS1iYXNlZCkKICAgICAgICB1dWlkW0lEWF9UWVBFXSB8PSBU\nWVBFX1RJTUVfQkFTRUQ7IC8vIDAwMDEgMDAwMAoKICAgICAgICByZXR1cm4g\ndXVpZDsKICAgIH0KCiAgICAvKgogICAgICogQ3JlYXRlcyBhIHR5cGUgNCBV\nVUlECiAgICAgKi8KICAgIHByaXZhdGUgc3RhdGljIGJ5dGVbXSBjcmVhdGVU\neXBlNCgpIHsKICAgICAgICBVVUlEIHR5cGU0ID0gVVVJRC5yYW5kb21VVUlE\nKCk7CiAgICAgICAgYnl0ZVtdIHV1aWQgPSBuZXcgYnl0ZVsxNl07CiAgICAg\nICAgbG9uZ1RvQnl0ZXModHlwZTQuZ2V0TW9zdFNpZ25pZmljYW50Qml0cygp\nLCB1dWlkLCAwKTsKICAgICAgICBsb25nVG9CeXRlcyh0eXBlNC5nZXRMZWFz\ndFNpZ25pZmljYW50Qml0cygpLCB1dWlkLCA4KTsKICAgICAgICByZXR1cm4g\ndXVpZDsKICAgIH0KICAgIAogICAgLyoKICAgICAqIENvbnZlcnRzIGEgbG9u\nZyB0byBieXRlIHZhbHVlcywgc2V0dGluZyB0aGVtIGluIGEgYnl0ZSBhcnJh\neQogICAgICogYXQgYSBnaXZlbiBzdGFydGluZyBwb3NpdGlvbi4KICAgICAq\nLwogICAgcHJpdmF0ZSBzdGF0aWMgdm9pZCBsb25nVG9CeXRlcyhsb25nIGxv\nbmdWYWwsIGJ5dGVbXSBidWYsIGludCBzUG9zKSB7CiAgICAgICAgc1BvcyAr\nPSA3OwogICAgICAgIGZvcihpbnQgaSA9IDA7IGkgPCA4OyBpKyspICAgICAg\nICAgCiAgICAgICAgICAgIGJ1ZltzUG9zLWldID0gKGJ5dGUpKGxvbmdWYWwg\nPj4+IChpICogOCkpOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRo\nZSBuZXh0IHVuaXF1ZSB1dWlkIHZhbHVlIGFzIGEgMTYtY2hhcmFjdGVyIHN0\ncmluZy4KICAgICAqLwogICAgcHVibGljIHN0YXRpYyBTdHJpbmcgbmV4dFN0\ncmluZyhpbnQgdHlwZSkgewogICAgICAgIGJ5dGVbXSBieXRlcyA9IG5leHQo\ndHlwZSk7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgcmV0dXJuIG5ldyBT\ndHJpbmcoYnl0ZXMsICJJU08tODg1OS0xIik7CiAgICAgICAgfSBjYXRjaCAo\nRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgcmV0dXJuIG5ldyBTdHJpbmco\nYnl0ZXMpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIFJldHVy\nbiB0aGUgbmV4dCB1bmlxdWUgdXVpZCB2YWx1ZSBhcyBhIDMyLWNoYXJhY3Rl\nciBoZXggc3RyaW5nLgogICAgICovCiAgICBwdWJsaWMgc3RhdGljIFN0cmlu\nZyBuZXh0SGV4KGludCB0eXBlKSB7CiAgICAgICAgcmV0dXJuIEJhc2UxNkVu\nY29kZXIuZW5jb2RlKG5leHQodHlwZSkpOwogICAgfQoKICAgIC8qKgogICAg\nICogR2V0IHRoZSB0aW1lc3RhbXAgdG8gYmUgdXNlZCBmb3IgdGhpcyB1dWlk\nLiAgTXVzdCBiZSBjYWxsZWQgZnJvbQogICAgICogYSBzeW5jaHJvbml6ZWQg\nYmxvY2suCiAgICAgKgogICAgICogQHJldHVybiBsb25nIHRpbWVzdGFtcAog\nICAgICovCiAgICAvLyBwYWNrYWdlLXZpc2liaWxpdHkgZm9yIHRlc3RpbmcK\nICAgIHN0YXRpYyBsb25nIGdldFRpbWUoKSB7CiAgICAgICAgaWYgKFJBTkRP\nTSA9PSBudWxsKQogICAgICAgICAgICBpbml0aWFsaXplRm9yVHlwZTEoKTsK\nICAgICAgICBsb25nIG5ld1RpbWUgPSBnZXRVVUlEVGltZSgpOwogICAgICAg\nIGlmIChuZXdUaW1lIDw9IF9sYXN0TWlsbGlzKSB7CiAgICAgICAgICAgIGlu\nY3JlbWVudFNlcXVlbmNlKCk7CiAgICAgICAgICAgIG5ld1RpbWUgPSBnZXRV\nVUlEVGltZSgpOwogICAgICAgIH0KICAgICAgICBfbGFzdE1pbGxpcyA9IG5l\nd1RpbWU7CiAgICAgICAgcmV0dXJuIG5ld1RpbWU7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBHZXRzIHRoZSBhcHByb3ByaWF0ZWx5IG1vZGlmaWVkIHRpbWVz\ndGFtZXAgZm9yIHRoZSBVVUlELiAgTXVzdCBiZSBjYWxsZWQKICAgICAqIGZy\nb20gYSBzeW5jaHJvbml6ZWQgYmxvY2suCiAgICAgKgogICAgICogQHJldHVy\nbiBsb25nIHRpbWVzdGFtcCBpbiAxMDBucyBpbnRlcnZhbHMgc2luY2UgdGhl\nIEdyZWdvcmlhbiBjaGFuZ2UKICAgICAqIG9mZnNldAogICAgICovCiAgICBw\ncml2YXRlIHN0YXRpYyBsb25nIGdldFVVSURUaW1lKCkgewogICAgICAgIGlm\nIChfY3VycmVudE1pbGxpcyAhPSBTeXN0ZW0uY3VycmVudFRpbWVNaWxsaXMo\nKSkgewogICAgICAgICAgICBfY3VycmVudE1pbGxpcyA9IFN5c3RlbS5jdXJy\nZW50VGltZU1pbGxpcygpOwogICAgICAgICAgICBfY291bnRlciA9IDA7ICAv\nLyByZXNldCBjb3VudGVyCiAgICAgICAgfQoKICAgICAgICAvLyBjaGVjayB0\nbyBzZWUgaWYgd2UgaGF2ZSBjcmVhdGVkIHRvbyBtYW55IHV1aWQncyBmb3Ig\ndGhpcyB0aW1lc3RhbXAKICAgICAgICBpZiAoX2NvdW50ZXIgKyAxID49IE1J\nTExJX01VTFQpIHsKICAgICAgICAgICAgLy8gT3JpZ2luYWwgYWxnb3JpdGht\nIHRocmV3IGV4Y2VwdGlvbi4gIFNlZW1lZCBsaWtlIG92ZXJraWxsLgogICAg\nICAgICAgICAvLyBMZXQncyBqdXN0IGluY3JlbWVudCB0aGUgdGltZXN0YW1w\nIGluc3RlYWQgYW5kIHN0YXJ0IG92ZXIuLi4KICAgICAgICAgICAgX2N1cnJl\nbnRNaWxsaXMrKzsKICAgICAgICAgICAgX2NvdW50ZXIgPSAwOwogICAgICAg\nIH0KCiAgICAgICAgLy8gY2FsY3VsYXRlIHRpbWUgYXMgY3VycmVudCBtaWxs\naXMgcGx1cyBvZmZzZXQgdGltZXMgMTAwIG5zIHRpY2tzCiAgICAgICAgbG9u\nZyBjdXJyZW50VGltZSA9IChfY3VycmVudE1pbGxpcyArIEdSRUdfT0ZGU0VU\nKSAqIE1JTExJX01VTFQ7CgogICAgICAgIC8vIHJldHVybiB0aGUgdXVpZCB0\naW1lIHBsdXMgdGhlIGFydGlmaWNpYWwgdGljayBjb3VudGVyIGluY3JlbWVu\ndGVkCiAgICAgICAgcmV0dXJuIGN1cnJlbnRUaW1lICsgX2NvdW50ZXIrKzsK\nICAgIH0KCiAgICAvKioKICAgICAqIEluY3JlbWVudHMgdGhlIGNsb2NrIHNl\ncXVlbmNlIGZvciB0aGlzIHV1aWQuICBNdXN0IGJlIGNhbGxlZCBmcm9tIGEK\nICAgICAqIHN5bmNocm9uaXplZCBibG9jay4KICAgICAqLwogICAgcHJpdmF0\nZSBzdGF0aWMgdm9pZCBpbmNyZW1lbnRTZXF1ZW5jZSgpIHsKICAgICAgICAv\nLyBpbmNyZW1lbnQsIGJ1dCBpZiBpdCdzIGdyZWF0ZXIgdGhhbiBpdHMgMTQt\nYml0cywgcmVzZXQgaXQKICAgICAgICBpZiAoKytfc2VxID4gTUFYXzE0QklU\nKSB7CiAgICAgICAgICAgIF9zZXEgPSAoc2hvcnQpIFJBTkRPTS5uZXh0SW50\nKE1BWF8xNEJJVCk7ICAvLyBzZW1pLXJhbmRvbQogICAgICAgIH0KICAgIH0K\nCgp9Cg==\n","encoding":"base64"}

