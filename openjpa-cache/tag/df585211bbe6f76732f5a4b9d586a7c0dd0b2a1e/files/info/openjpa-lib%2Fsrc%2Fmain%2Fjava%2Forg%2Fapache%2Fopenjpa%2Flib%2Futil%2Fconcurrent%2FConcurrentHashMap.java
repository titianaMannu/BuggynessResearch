{"sha":"e66adfbbca65e8f034a49e9d2e732f09d89ee13e","node_id":"MDQ6QmxvYjIwNjM2NDplNjZhZGZiYmNhNjVlOGYwMzRhNDllOWQyZTczMmYwOWQ4OWVlMTNl","size":30186,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/e66adfbbca65e8f034a49e9d2e732f09d89ee13e","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuY29uY3VycmVu\ndDsKCmltcG9ydCBqYXZhLmlvLklPRXhjZXB0aW9uOwppbXBvcnQgamF2YS5p\nby5PYmplY3RJbnB1dFN0cmVhbTsKaW1wb3J0IGphdmEuaW8uT2JqZWN0T3V0\ncHV0U3RyZWFtOwppbXBvcnQgamF2YS5pby5TZXJpYWxpemFibGU7CmltcG9y\ndCBqYXZhLnV0aWwuQWJzdHJhY3RDb2xsZWN0aW9uOwppbXBvcnQgamF2YS51\ndGlsLkFic3RyYWN0TWFwOwppbXBvcnQgamF2YS51dGlsLkFic3RyYWN0U2V0\nOwppbXBvcnQgamF2YS51dGlsLkNvbGxlY3Rpb247CmltcG9ydCBqYXZhLnV0\naWwuSXRlcmF0b3I7CmltcG9ydCBqYXZhLnV0aWwuTWFwOwppbXBvcnQgamF2\nYS51dGlsLk5vU3VjaEVsZW1lbnRFeGNlcHRpb247CmltcG9ydCBqYXZhLnV0\naWwuUmFuZG9tOwppbXBvcnQgamF2YS51dGlsLlNldDsKCmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEubGliLnV0aWwuU2l6ZWRNYXA7CgovKioKICogVGhp\ncyBjbGFzcyBpbXBsZW1lbnRzIGEgSGFzaE1hcCB3aGljaCBoYXMgbGltaXRl\nZCBzeW5jaHJvbml6YXRpb24uCiAqIEluIHBhcnRpY3VsYXIgbXV0YXRvcnMg\nYXJlIGdlbmVyYWxseSBzeW5jaHJvbml6ZWQgd2hpbGUgYWNjZXNzb3JzCiAq\nIGFyZSBnZW5lcmFsbHkgbm90LiBBZGRpdGlvbmFsbHkgdGhlIEl0ZXJhdG9y\ncyByZXR1cm5lZCBieSB0aGlzCiAqIGNsYXNzIGFyZSBub3QgImZhaWwtZmFz\ndCIsIGJ1dCBpbnN0ZWFkIHRyeSB0byBjb250aW51ZSB0byBpdGVyYXRlCiAq\nIG92ZXIgdGhlIGRhdGEgc3RydWN0dXJlIGFmdGVyIGNoYW5nZXMgaGF2ZSBi\nZWVuIG1hZGUuCiAqIFRoZSBzeW5jaHJvbml6YXRpb24gc2VtYW50aWNzIGFy\nZSBidWlsdCByaWdodCBpbiB0byB0aGUKICogaW1wbGVtZW50YXRpb24gcmF0\naGVyIHRoYW4gdXNpbmcgYSBkZWxlZ2F0aW5nIHdyYXBwZXIgbGlrZSB0aGUK\nICogb3RoZXIgY29sbGVjdGlvbiBjbGFzc2VzIGRvIGJlY2F1c2UgaXQgd2Fz\nbid0IGNsZWFyIHRvIG1lIHRoYXQgdGhlCiAqIGhvdyB0aGUgdHdvIHNob3Vs\nZCBiZSBzZXBlcmF0ZWQgb3IgdGhhdCBpdCB3b3VsZCBiZSB1c2VmdWwgdG8g\nZG8KICogc28uIFRoaXMgY2FuIHByb2JhYmx5IGJlIGEgdG9waWMgZm9yIGZ1\ncnRoZXIgZGViYXRlIGluIHRoZSBmdXR1cmUuCiAqIFRoaXMgY2xhc3MgaXMg\nYmFzZWQgaGVhdmlseSBvbiB0aGUgSGFzaE1hcCBjbGFzcyBpbiB0aGUgSmF2\nYQogKiBjb2xsZWN0aW9ucyBwYWNrYWdlLgogKi8KcHVibGljIGNsYXNzIENv\nbmN1cnJlbnRIYXNoTWFwIGV4dGVuZHMgQWJzdHJhY3RNYXAKICAgIGltcGxl\nbWVudHMgQ29uY3VycmVudE1hcCwgU2l6ZWRNYXAsIENsb25lYWJsZSwgU2Vy\naWFsaXphYmxlIHsKCiAgICAvKioKICAgICAqIFRoZSBkZWZhdWx0IGluaXRp\nYWwgY2FwYWNpdHkgLSBNVVNUIGJlIGEgcG93ZXIgb2YgdHdvLgogICAgICov\nCiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBpbnQgREVGQVVMVF9JTklUSUFM\nX0NBUEFDSVRZID0gMTY7CgogICAgLyoqCiAgICAgKiBUaGUgbWF4aW11bSBj\nYXBhY2l0eSwgdXNlZCBpZiBhIGhpZ2hlciB2YWx1ZSBpcyBpbXBsaWNpdGx5\nIHNwZWNpZmllZAogICAgICogYnkgZWl0aGVyIG9mIHRoZSBjb25zdHJ1Y3Rv\ncnMgd2l0aCBhcmd1bWVudHMuCiAgICAgKiBNVVNUIGJlIGEgcG93ZXIgb2Yg\ndHdvIDw9IDE8PDMwLgogICAgICovCiAgICBwcml2YXRlIHN0YXRpYyBmaW5h\nbCBpbnQgTUFYSU1VTV9DQVBBQ0lUWSA9IDEgPDwgMzA7CgogICAgLyoqCiAg\nICAgKiBUaGUgbG9hZCBmYXN0IHVzZWQgd2hlbiBub25lIHNwZWNpZmllZCBp\nbiBjb25zdHJ1Y3Rvci4KICAgICAqLwogICAgcHJpdmF0ZSBzdGF0aWMgZmlu\nYWwgZmxvYXQgREVGQVVMVF9MT0FEX0ZBQ1RPUiA9IDAuNzVmOwoKICAgIC8q\nKgogICAgICogQ2FjaGUgb2YgcmFuZG9tIG51bWJlcnMgdXNlZCBpbiAicmFu\nZG9tIiBtZXRob2RzLCBzaW5jZSBnZW5lcmF0aW5nIHRoZW0KICAgICAqIGlz\nIGV4cGVuc2l2ZS4gV2UgaG9wZSBlYWNoIG1hcCBjaGFuZ2VzIGVub3VnaCBi\nZXR3ZWVuIGN5Y2xpbmcgdGhyb3VnaAogICAgICogdGhpcyBsaXN0IHRoYXQg\ndGhlIG92ZXJhbGwgZWZmZWN0IGlzIHJhbmRvbSBlbm91Z2guCiAgICAgKi8K\nICAgIHN0YXRpYyBmaW5hbCBkb3VibGVbXSBSQU5ET01TID0gbmV3IGRvdWJs\nZVsxMDAwXTsKCiAgICBzdGF0aWMgewogICAgICAgIFJhbmRvbSByYW5kb20g\nPSBuZXcgUmFuZG9tKCk7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBS\nQU5ET01TLmxlbmd0aDsgaSsrKQogICAgICAgICAgICBSQU5ET01TW2ldID0g\ncmFuZG9tLm5leHREb3VibGUoKTsKICAgIH0KCiAgICAvKioKICAgICAqIFRo\nZSB0YWJsZSwgcmVzaXplZCBhcyBuZWNlc3NhcnkuIExlbmd0aCBNVVNUIEFs\nd2F5cyBiZSBhIHBvd2VyIG9mIHR3by4KICAgICAqLwogICAgcHJpdmF0ZSB0\ncmFuc2llbnQgRW50cnlbXSB0YWJsZTsKCiAgICAvKioKICAgICAqIFRoZSBu\ndW1iZXIgb2Yga2V5LXZhbHVlIG1hcHBpbmdzIGNvbnRhaW5lZCBpbiB0aGlz\nIGlkZW50aXR5IGhhc2ggbWFwLgogICAgICovCiAgICBwcml2YXRlIHRyYW5z\naWVudCBpbnQgc2l6ZTsKCiAgICAvKioKICAgICAqIFRoZSBuZXh0IHNpemUg\ndmFsdWUgYXQgd2hpY2ggdG8gcmVzaXplKGNhcGFjaXR5ICogbG9hZCBmYWN0\nb3IpLgogICAgICoKICAgICAqIEBzZXJpYWwKICAgICAqLwogICAgcHJpdmF0\nZSBpbnQgdGhyZXNob2xkOwoKICAgIC8qKgogICAgICogVGhlIGxvYWQgZmFj\ndG9yIGZvciB0aGUgaGFzaCB0YWJsZS4KICAgICAqCiAgICAgKiBAc2VyaWFs\nCiAgICAgKi8KICAgIHByaXZhdGUgZmluYWwgZmxvYXQgbG9hZEZhY3RvcjsK\nCiAgICAvKioKICAgICAqIFNwcmVhZCAicmFuZG9tIiByZW1vdmVzIGFuZCBp\ndGVyYXRpb24uCiAgICAgKi8KICAgIHByaXZhdGUgaW50IHJhbmRvbUVudHJ5\nID0gMDsKCiAgICAvKioKICAgICAqIE1heGltdW0gZW50cmllcy4KICAgICAq\nLwogICAgcHJpdmF0ZSBpbnQgbWF4U2l6ZSA9IEludGVnZXIuTUFYX1ZBTFVF\nOwoKICAgIC8qKgogICAgICogQ29uc3RydWN0cyBhbiBlbXB0eSA8dHQ+Q29u\nY3VycmVudEhhc2hNYXA8L3R0PiB3aXRoIHRoZSBzcGVjaWZpZWQgaW5pdGlh\nbAogICAgICogY2FwYWNpdHkgYW5kIGxvYWQgZmFjdG9yLgogICAgICoKICAg\nICAqIEBwYXJhbSBpbml0aWFsQ2FwYWNpdHkgVGhlIGluaXRpYWwgY2FwYWNp\ndHkuCiAgICAgKiBAcGFyYW0gbG9hZEZhY3RvciBUaGUgbG9hZCBmYWN0b3Iu\nCiAgICAgKiBAdGhyb3dzIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiBpZiB0\naGUgaW5pdGlhbCBjYXBhY2l0eSBpcyBuZWdhdGl2ZQogICAgICogb3IgdGhl\nIGxvYWQgZmFjdG9yIGlzIG5vbnBvc2l0aXZlLgogICAgICovCiAgICBwdWJs\naWMgQ29uY3VycmVudEhhc2hNYXAoaW50IGluaXRpYWxDYXBhY2l0eSwgZmxv\nYXQgbG9hZEZhY3RvcikgewogICAgICAgIGlmIChpbml0aWFsQ2FwYWNpdHkg\nPCAwKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRF\neGNlcHRpb24oIklsbGVnYWwgaW5pdGlhbCBjYXBhY2l0eTogIiArCiAgICAg\nICAgICAgICAgICBpbml0aWFsQ2FwYWNpdHkpOwogICAgICAgIH0KICAgICAg\nICBpZiAoaW5pdGlhbENhcGFjaXR5ID4gTUFYSU1VTV9DQVBBQ0lUWSkKICAg\nICAgICAgICAgaW5pdGlhbENhcGFjaXR5ID0gTUFYSU1VTV9DQVBBQ0lUWTsK\nICAgICAgICBpZiAobG9hZEZhY3RvciA8PSAwIHx8IGxvYWRGYWN0b3IgPiAx\nKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNl\ncHRpb24oIklsbGVnYWwgbG9hZCBmYWN0b3I6ICIgKwogICAgICAgICAgICAg\nICAgbG9hZEZhY3Rvcik7CiAgICAgICAgfQoKICAgICAgICAvLyBGaW5kIGEg\ncG93ZXIgb2YgMiA+PSBpbml0aWFsQ2FwYWNpdHkKICAgICAgICBpbnQgY2Fw\nYWNpdHkgPSAxOwogICAgICAgIHdoaWxlIChjYXBhY2l0eSA8IGluaXRpYWxD\nYXBhY2l0eSkgY2FwYWNpdHkgPDw9IDE7CgogICAgICAgIHRoaXMubG9hZEZh\nY3RvciA9IGxvYWRGYWN0b3I7CiAgICAgICAgdGhyZXNob2xkID0gKGludCkg\nKGNhcGFjaXR5ICogbG9hZEZhY3Rvcik7CiAgICAgICAgdGFibGUgPSBuZXcg\nRW50cnlbY2FwYWNpdHldOwogICAgfQoKICAgIC8qKgogICAgICogQ29uc3Ry\ndWN0cyBhbiBlbXB0eSA8dHQ+Q29uY3VycmVudEhhc2hNYXA8L3R0PiB3aXRo\nIHRoZSBzcGVjaWZpZWQgaW5pdGlhbAogICAgICogY2FwYWNpdHkgYW5kIHRo\nZSBkZWZhdWx0IGxvYWQgZmFjdG9yKDAuNzUpLgogICAgICoKICAgICAqIEBw\nYXJhbSBpbml0aWFsQ2FwYWNpdHkgdGhlIGluaXRpYWwgY2FwYWNpdHkuCiAg\nICAgKiBAdGhyb3dzIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiBpZiB0aGUg\naW5pdGlhbCBjYXBhY2l0eSBpcyBuZWdhdGl2ZS4KICAgICAqLwogICAgcHVi\nbGljIENvbmN1cnJlbnRIYXNoTWFwKGludCBpbml0aWFsQ2FwYWNpdHkpIHsK\nICAgICAgICB0aGlzKGluaXRpYWxDYXBhY2l0eSwgREVGQVVMVF9MT0FEX0ZB\nQ1RPUik7CiAgICB9CgogICAgLyoqCiAgICAgKiBDb25zdHJ1Y3RzIGFuIGVt\ncHR5IDx0dD5Db25jdXJyZW50SGFzaE1hcDwvdHQ+IHdpdGggdGhlIGRlZmF1\nbHQgaW5pdGlhbAogICAgICogY2FwYWNpdHkoMTYpIGFuZCB0aGUgZGVmYXVs\ndCBsb2FkIGZhY3RvcigwLjc1KS4KICAgICAqLwogICAgcHVibGljIENvbmN1\ncnJlbnRIYXNoTWFwKCkgewogICAgICAgIHRoaXMoREVGQVVMVF9JTklUSUFM\nX0NBUEFDSVRZLCBERUZBVUxUX0xPQURfRkFDVE9SKTsKICAgIH0KCiAgICAv\nKioKICAgICAqIENvbnN0cnVjdHMgYSBuZXcgPHR0PkNvbmN1cnJlbnRIYXNo\nTWFwPC90dD4gd2l0aCB0aGUgc2FtZSBtYXBwaW5ncyBhcyB0aGUKICAgICAq\nIHNwZWNpZmllZCA8dHQ+TWFwPC90dD4uIFRoZSA8dHQ+Q29uY3VycmVudEhh\nc2hNYXA8L3R0PiBpcyBjcmVhdGVkIHdpdGgKICAgICAqIGRlZmF1bHQgbG9h\nZCBmYWN0b3IoMC43NSkgYW5kIGFuIGluaXRpYWwgY2FwYWNpdHkgc3VmZmlj\naWVudCB0bwogICAgICogaG9sZCB0aGUgbWFwcGluZ3MgaW4gdGhlIHNwZWNp\nZmllZCA8dHQ+TWFwPC90dD4uCiAgICAgKgogICAgICogQHBhcmFtIG0gdGhl\nIG1hcCB3aG9zZSBtYXBwaW5ncyBhcmUgdG8gYmUgcGxhY2VkIGluIHRoaXMg\nbWFwLgogICAgICogQHRocm93cyBOdWxsUG9pbnRlckV4Y2VwdGlvbiBpZiB0\naGUgc3BlY2lmaWVkIG1hcCBpcyBudWxsLgogICAgICovCiAgICBwdWJsaWMg\nQ29uY3VycmVudEhhc2hNYXAoTWFwIG0pIHsKICAgICAgICB0aGlzKE1hdGgu\nbWF4KChpbnQpIChtLnNpemUoKSAvIERFRkFVTFRfTE9BRF9GQUNUT1IpICsg\nMSwKICAgICAgICAgICAgREVGQVVMVF9JTklUSUFMX0NBUEFDSVRZKSwgREVG\nQVVMVF9MT0FEX0ZBQ1RPUik7CiAgICAgICAgcHV0QWxsKG0pOwogICAgfQoK\nICAgIC8vIGludGVybmFsIHV0aWxpdGllcwoKICAgIC8qKgogICAgICogVmFs\ndWUgcmVwcmVzZW50aW5nIG51bGwga2V5cyBpbnNpZGUgdGFibGVzLgogICAg\nICovCiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBPYmplY3QgTlVMTF9LRVkg\nPSBuZXcgT2JqZWN0KCk7CgogICAgLyoqCiAgICAgKiBSZXR1cm5zIGludGVy\nbmFsIHJlcHJlc2VudGF0aW9uIGZvciBrZXkuIFVzZSBOVUxMX0tFWSBpZiBr\nZXkgaXMgbnVsbC4KICAgICAqLwogICAgcHJpdmF0ZSBzdGF0aWMgT2JqZWN0\nIG1hc2tOdWxsKE9iamVjdCBrZXkpIHsKICAgICAgICByZXR1cm4gKGtleSA9\nPSBudWxsID8gTlVMTF9LRVkgOiBrZXkpOwogICAgfQoKICAgIC8qKgogICAg\nICogUmV0dXJucyBrZXkgcmVwcmVzZW50ZWQgYnkgc3BlY2lmaWVkIGludGVy\nbmFsIHJlcHJlc2VudGF0aW9uLgogICAgICovCiAgICBwcml2YXRlIHN0YXRp\nYyBPYmplY3QgdW5tYXNrTnVsbChPYmplY3Qga2V5KSB7CiAgICAgICAgcmV0\ndXJuIChrZXkgPT0gTlVMTF9LRVkgPyBudWxsIDoga2V5KTsKICAgIH0KCiAg\nICAvKioKICAgICAqIFJldHVybnMgYSBoYXNoIGNvZGUgZm9yIG5vbi1udWxs\nIE9iamVjdCB4LgogICAgICovCiAgICBwcml2YXRlIHN0YXRpYyBpbnQgaGFz\naChPYmplY3QgeCkgewogICAgICAgIGludCBoID0geC5oYXNoQ29kZSgpOwog\nICAgICAgIHJldHVybiBoIC0gKGggPDwgNyk7IC8vIGkuZS4sIC0xMjcgKiBo\nCiAgICB9CgogICAgLyoqCiAgICAgKiBDaGVjayBmb3IgZXF1YWxpdHkgb2Yg\nbm9uLW51bGwgcmVmZXJlbmNlIHggYW5kIHBvc3NpYmx5LW51bGwgeS4KICAg\nICAqLwogICAgcHJpdmF0ZSBzdGF0aWMgYm9vbGVhbiBlcShPYmplY3QgeCwg\nT2JqZWN0IHkpIHsKICAgICAgICByZXR1cm4geCA9PSB5IHx8IHguZXF1YWxz\nKHkpOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJucyB0aGUgY3VycmVu\ndCBjYXBhY2l0eSBvZiBiYWNraW5nIHRhYmxlIGluIHRoaXMgbWFwLgogICAg\nICoKICAgICAqIEByZXR1cm4gdGhlIGN1cnJlbnQgY2FwYWNpdHkgb2YgYmFj\na2luZyB0YWJsZSBpbiB0aGlzIG1hcC4KICAgICAqLwogICAgcHVibGljIGZp\nbmFsIGludCBjYXBhY2l0eSgpIHsKICAgICAgICByZXR1cm4gdGFibGUubGVu\nZ3RoOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJucyB0aGUgbG9hZCBm\nYWN0b3IgZm9yIHRoaXMgbWFwLgogICAgICoKICAgICAqIEByZXR1cm4gdGhl\nIGxvYWQgZmFjdG9yIGZvciB0aGlzIG1hcC4KICAgICAqLwogICAgcHVibGlj\nIGZpbmFsIGZsb2F0IGxvYWRGYWN0b3IoKSB7CiAgICAgICAgcmV0dXJuIGxv\nYWRGYWN0b3I7CiAgICB9CgogICAgcHVibGljIGludCBnZXRNYXhTaXplKCkg\newogICAgICAgIHJldHVybiBtYXhTaXplOwogICAgfQoKICAgIHB1YmxpYyB2\nb2lkIHNldE1heFNpemUoaW50IG1heFNpemUpIHsKICAgICAgICB0aGlzLm1h\neFNpemUgPSAobWF4U2l6ZSA8IDApID8gSW50ZWdlci5NQVhfVkFMVUUgOiBt\nYXhTaXplOwogICAgICAgIGlmICh0aGlzLm1heFNpemUgIT0gSW50ZWdlci5N\nQVhfVkFMVUUpCiAgICAgICAgICAgIHJlbW92ZU92ZXJmbG93KHRoaXMubWF4\nU2l6ZSk7CiAgICB9CgogICAgcHVibGljIGJvb2xlYW4gaXNGdWxsKCkgewog\nICAgICAgIHJldHVybiBtYXhTaXplICE9IEludGVnZXIuTUFYX1ZBTFVFICYm\nIHNpemUoKSA+PSBtYXhTaXplOwogICAgfQoKICAgIHB1YmxpYyB2b2lkIG92\nZXJmbG93UmVtb3ZlZChPYmplY3Qga2V5LCBPYmplY3QgdmFsdWUpIHsKICAg\nIH0KCiAgICAvKioKICAgICAqIFJldHVybnMgdGhlIG51bWJlciBvZiBrZXkt\ndmFsdWUgbWFwcGluZ3MgaW4gdGhpcyBtYXAuCiAgICAgKgogICAgICogQHJl\ndHVybiB0aGUgbnVtYmVyIG9mIGtleS12YWx1ZSBtYXBwaW5ncyBpbiB0aGlz\nIG1hcC4KICAgICAqLwogICAgcHVibGljIGZpbmFsIGludCBzaXplKCkgewog\nICAgICAgIHJldHVybiBzaXplOwogICAgfQoKICAgIC8qKgogICAgICogUmV0\ndXJucyA8dHQ+dHJ1ZTwvdHQ+IGlmIHRoaXMgbWFwIGNvbnRhaW5zIG5vIGtl\neS12YWx1ZSBtYXBwaW5ncy4KICAgICAqCiAgICAgKiBAcmV0dXJuIDx0dD50\ncnVlPC90dD4gaWYgdGhpcyBtYXAgY29udGFpbnMgbm8ga2V5LXZhbHVlIG1h\ncHBpbmdzLgogICAgICovCiAgICBwdWJsaWMgZmluYWwgYm9vbGVhbiBpc0Vt\ncHR5KCkgewogICAgICAgIHJldHVybiBzaXplID09IDA7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBSZXR1cm5zIHRoZSB2YWx1ZSB0byB3aGljaCB0aGUgc3Bl\nY2lmaWVkIGtleSBpcyBtYXBwZWQgaW4gdGhpcyBpZGVudGl0eQogICAgICog\naGFzaCBtYXAsIG9yIDx0dD5udWxsPC90dD4gaWYgdGhlIG1hcCBjb250YWlu\ncyBubyBtYXBwaW5nIGZvciB0aGlzIGtleS4KICAgICAqIEEgcmV0dXJuIHZh\nbHVlIG9mIDx0dD5udWxsPC90dD4gZG9lcyBub3QgPGk+bmVjZXNzYXJpbHk8\nL2k+IGluZGljYXRlCiAgICAgKiB0aGF0IHRoZSBtYXAgY29udGFpbnMgbm8g\nbWFwcGluZyBmb3IgdGhlIGtleTsgaXQgaXMgYWxzbyBwb3NzaWJsZSB0aGF0\nCiAgICAgKiB0aGUgbWFwIGV4cGxpY2l0bHkgbWFwcyB0aGUga2V5IHRvIDx0\ndD5udWxsPC90dD4uIFRoZQogICAgICogPHR0PmNvbnRhaW5zS2V5PC90dD4g\nbWV0aG9kIG1heSBiZSB1c2VkIHRvIGRpc3Rpbmd1aXNoIHRoZXNlIHR3byBj\nYXNlcy4KICAgICAqCiAgICAgKiBAcGFyYW0ga2V5IHRoZSBrZXkgd2hvc2Ug\nYXNzb2NpYXRlZCB2YWx1ZSBpcyB0byBiZSByZXR1cm5lZC4KICAgICAqIEBy\nZXR1cm4gdGhlIHZhbHVlIHRvIHdoaWNoIHRoaXMgbWFwIG1hcHMgdGhlIHNw\nZWNpZmllZCBrZXksIG9yCiAgICAgKiA8dHQ+bnVsbDwvdHQ+IGlmIHRoZSBt\nYXAgY29udGFpbnMgbm8gbWFwcGluZyBmb3IgdGhpcyBrZXkuCiAgICAgKiBA\nc2VlICNwdXQoT2JqZWN0LCBPYmplY3QpCiAgICAgKi8KICAgIHB1YmxpYyBP\nYmplY3QgZ2V0KE9iamVjdCBrZXkpIHsKICAgICAgICBFbnRyeSBlID0gZ2V0\nRW50cnkoa2V5KTsKICAgICAgICByZXR1cm4gZSA9PSBudWxsID8gbnVsbCA6\nIGUudmFsdWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm5zIDx0dD50\ncnVlPC90dD4gaWYgdGhpcyBtYXAgY29udGFpbnMgYSBtYXBwaW5nIGZvciB0\naGUKICAgICAqIHNwZWNpZmllZCBrZXkuCiAgICAgKgogICAgICogQHBhcmFt\nIGtleSBUaGUga2V5IHdob3NlIHByZXNlbmNlIGluIHRoaXMgbWFwIGlzIHRv\nIGJlIHRlc3RlZAogICAgICogQHJldHVybiA8dHQ+dHJ1ZTwvdHQ+IGlmIHRo\naXMgbWFwIGNvbnRhaW5zIGEgbWFwcGluZyBmb3IgdGhlIHNwZWNpZmllZAog\nICAgICoga2V5LgogICAgICovCiAgICBwdWJsaWMgZmluYWwgYm9vbGVhbiBj\nb250YWluc0tleShPYmplY3Qga2V5KSB7CiAgICAgICAgcmV0dXJuIGdldEVu\ndHJ5KGtleSkgIT0gbnVsbDsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVy\nbnMgdGhlIGVudHJ5IGFzc29jaWF0ZWQgd2l0aCB0aGUgc3BlY2lmaWVkIGtl\neSBpbiB0aGUKICAgICAqIENvbmN1cnJlbnRIYXNoTWFwLiBSZXR1cm5zIG51\nbGwgaWYgdGhlIENvbmN1cnJlbnRIYXNoTWFwIGNvbnRhaW5zIG5vCiAgICAg\nKiBtYXBwaW5nIGZvciB0aGlzIGtleS4KICAgICAqLwogICAgcHJvdGVjdGVk\nIEVudHJ5IGdldEVudHJ5KE9iamVjdCBrZXkpIHsKICAgICAgICBPYmplY3Qg\nayA9IG1hc2tOdWxsKGtleSk7CiAgICAgICAgaW50IGhhc2ggPSBoYXNoKGsp\nOwogICAgICAgIEVudHJ5W10gdGFiID0gdGFibGU7CiAgICAgICAgZm9yIChF\nbnRyeSBlID0gdGFiW2hhc2ggJiAodGFiLmxlbmd0aCAtIDEpXTsgZSAhPSBu\ndWxsOyBlID0gZS5uZXh0KSB7CiAgICAgICAgICAgIGlmIChlLmhhc2ggPT0g\naGFzaCAmJiBlcShrLCBlLmtleSkpIHJldHVybiBlOwogICAgICAgIH0KICAg\nICAgICByZXR1cm4gbnVsbDsKICAgIH0KCiAgICAvKioKICAgICAqIEFzc29j\naWF0ZXMgdGhlIHNwZWNpZmllZCB2YWx1ZSB3aXRoIHRoZSBzcGVjaWZpZWQg\na2V5IGluIHRoaXMgbWFwLgogICAgICogSWYgdGhlIG1hcCBwcmV2aW91c2x5\nIGNvbnRhaW5lZCBhIG1hcHBpbmcgZm9yIHRoaXMga2V5LCB0aGUgb2xkCiAg\nICAgKiB2YWx1ZSBpcyByZXBsYWNlZC4KICAgICAqCiAgICAgKiBAcGFyYW0g\na2V5IGtleSB3aXRoIHdoaWNoIHRoZSBzcGVjaWZpZWQgdmFsdWUgaXMgdG8g\nYmUgYXNzb2NpYXRlZC4KICAgICAqIEBwYXJhbSB2YWx1ZSB2YWx1ZSB0byBi\nZSBhc3NvY2lhdGVkIHdpdGggdGhlIHNwZWNpZmllZCBrZXkuCiAgICAgKiBA\ncmV0dXJuIHByZXZpb3VzIHZhbHVlIGFzc29jaWF0ZWQgd2l0aCBzcGVjaWZp\nZWQga2V5LCBvciA8dHQ+bnVsbDwvdHQ+CiAgICAgKiBpZiB0aGVyZSB3YXMg\nbm8gbWFwcGluZyBmb3Iga2V5LiBBIDx0dD5udWxsPC90dD4gcmV0dXJuIGNh\nbgogICAgICogYWxzbyBpbmRpY2F0ZSB0aGF0IHRoZSBDb25jdXJyZW50SGFz\naE1hcCBwcmV2aW91c2x5IGFzc29jaWF0ZWQKICAgICAqIDx0dD5udWxsPC90\ndD4gd2l0aCB0aGUgc3BlY2lmaWVkIGtleS4KICAgICAqLwogICAgcHVibGlj\nIE9iamVjdCBwdXQoT2JqZWN0IGtleSwgT2JqZWN0IHZhbHVlKSB7CiAgICAg\nICAgT2JqZWN0IGsgPSBtYXNrTnVsbChrZXkpOwogICAgICAgIGludCBoYXNo\nID0gaGFzaChrKTsKICAgICAgICBzeW5jaHJvbml6ZWQgKHRoaXMpIHsKICAg\nICAgICAgICAgaW50IGkgPSBoYXNoICYgKHRhYmxlLmxlbmd0aCAtIDEpOwoK\nICAgICAgICAgICAgZm9yIChFbnRyeSBlID0gdGFibGVbaV07IGUgIT0gbnVs\nbDsgZSA9IGUubmV4dCkgewogICAgICAgICAgICAgICAgaWYgKGUuaGFzaCA9\nPSBoYXNoICYmIGVxKGssIGUua2V5KSkgewogICAgICAgICAgICAgICAgICAg\nIE9iamVjdCBvbGRWYWx1ZSA9IGUudmFsdWU7CiAgICAgICAgICAgICAgICAg\nICAgZS52YWx1ZSA9IHZhbHVlOwogICAgICAgICAgICAgICAgICAgIHJldHVy\nbiBvbGRWYWx1ZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoK\nICAgICAgICAgICAgaWYgKG1heFNpemUgIT0gSW50ZWdlci5NQVhfVkFMVUUp\nCiAgICAgICAgICAgICAgICByZW1vdmVPdmVyZmxvdyhtYXhTaXplIC0gMSk7\nCiAgICAgICAgICAgIHRhYmxlW2ldID0gY3JlYXRlRW50cnkoaGFzaCwgaywg\ndmFsdWUsIHRhYmxlW2ldKTsKICAgICAgICAgICAgaWYgKHNpemUrKyA+PSB0\naHJlc2hvbGQpIHJlc2l6ZSgyICogdGFibGUubGVuZ3RoKTsKICAgICAgICB9\nCiAgICAgICAgcmV0dXJuIG51bGw7CiAgICB9CgogICAgLyoqCiAgICAgKiBS\nZW1vdmUgYW55IGVudHJpZXMgZXF1YWwgdG8gb3Igb3ZlciB0aGUgbWF4IHNp\nemUuCiAgICAgKi8KICAgIHByaXZhdGUgdm9pZCByZW1vdmVPdmVyZmxvdyhp\nbnQgbWF4U2l6ZSkgewogICAgICAgIHdoaWxlIChzaXplID4gbWF4U2l6ZSkg\newogICAgICAgICAgICBNYXAuRW50cnkgZW50cnkgPSByZW1vdmVSYW5kb20o\nKTsKICAgICAgICAgICAgaWYgKGVudHJ5ID09IG51bGwpCiAgICAgICAgICAg\nICAgICBicmVhazsKICAgICAgICAgICAgb3ZlcmZsb3dSZW1vdmVkKGVudHJ5\nLmdldEtleSgpLCBlbnRyeS5nZXRWYWx1ZSgpKTsKICAgICAgICB9CiAgICB9\nCgogICAgcHVibGljIE9iamVjdCBwdXRJZkFic2VudChPYmplY3Qga2V5LCBP\nYmplY3QgdmFsdWUpIHsKICAgICAgICBPYmplY3QgayA9IG1hc2tOdWxsKGtl\neSk7CiAgICAgICAgaW50IGhhc2ggPSBoYXNoKGspOwogICAgICAgIHN5bmNo\ncm9uaXplZCAodGhpcykgewogICAgICAgICAgICBpbnQgaSA9IGhhc2ggJiAo\ndGFibGUubGVuZ3RoIC0gMSk7CgogICAgICAgICAgICBmb3IgKEVudHJ5IGUg\nPSB0YWJsZVtpXTsgZSAhPSBudWxsOyBlID0gZS5uZXh0KSB7CiAgICAgICAg\nICAgICAgICBpZiAoZS5oYXNoID09IGhhc2ggJiYgZXEoaywgZS5rZXkpKSB7\nCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGUudmFsdWU7CiAgICAgICAg\nICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmIChtYXhT\naXplICE9IEludGVnZXIuTUFYX1ZBTFVFKQogICAgICAgICAgICAgICAgcmVt\nb3ZlT3ZlcmZsb3cobWF4U2l6ZSAtIDEpOwogICAgICAgICAgICB0YWJsZVtp\nXSA9IGNyZWF0ZUVudHJ5KGhhc2gsIGssIHZhbHVlLCB0YWJsZVtpXSk7CiAg\nICAgICAgICAgIGlmIChzaXplKysgPj0gdGhyZXNob2xkKSByZXNpemUoMiAq\nIHRhYmxlLmxlbmd0aCk7CiAgICAgICAgfQogICAgICAgIHJldHVybiBudWxs\nOwogICAgfQoKICAgIC8qKgogICAgICogUmVoYXNoZXMgdGhlIGNvbnRlbnRz\nIG9mIHRoaXMgbWFwIGludG8gYSBuZXcgPHR0PkNvbmN1cnJlbnRIYXNoTWFw\nPC90dD4KICAgICAqIGluc3RhbmNlIHdpdGggYSBsYXJnZXIgY2FwYWNpdHku\nIFRoaXMgbWV0aG9kIGlzIGNhbGxlZCBhdXRvbWF0aWNhbGx5IHdoZW4KICAg\nICAqIHRoZSBudW1iZXIgb2Yga2V5cyBpbiB0aGlzIG1hcCBleGNlZWRzIGl0\ncyBjYXBhY2l0eSBhbmQgbG9hZCBmYWN0b3IuCiAgICAgKgogICAgICogQHBh\ncmFtIG5ld0NhcGFjaXR5IHRoZSBuZXcgY2FwYWNpdHksIE1VU1QgYmUgYSBw\nb3dlciBvZiB0d28uCiAgICAgKi8KICAgIHByaXZhdGUgdm9pZCByZXNpemUo\naW50IG5ld0NhcGFjaXR5KSB7CiAgICAgICAgLy8gYXNzZXJ0KG5ld0NhcGFj\naXR5ICYgLW5ld0NhcGFjaXR5KSA9PSBuZXdDYXBhY2l0eTsgLy8gcG93ZXIg\nb2YgMgogICAgICAgIEVudHJ5W10gb2xkVGFibGUgPSB0YWJsZTsKICAgICAg\nICBpbnQgb2xkQ2FwYWNpdHkgPSBvbGRUYWJsZS5sZW5ndGg7CgogICAgICAg\nIC8vIGNoZWNrIGlmIG5lZWRlZAogICAgICAgIGlmIChzaXplIDwgdGhyZXNo\nb2xkIHx8IG9sZENhcGFjaXR5ID4gbmV3Q2FwYWNpdHkpIHJldHVybjsKCiAg\nICAgICAgRW50cnlbXSBuZXdUYWJsZSA9IG5ldyBFbnRyeVtuZXdDYXBhY2l0\neV07CiAgICAgICAgaW50IG1hc2sgPSBuZXdDYXBhY2l0eSAtIDE7CiAgICAg\nICAgZm9yIChpbnQgaSA9IG9sZENhcGFjaXR5OyBpLS0gPiAwOykgewogICAg\nICAgICAgICBmb3IgKEVudHJ5IGUgPSBvbGRUYWJsZVtpXTsgZSAhPSBudWxs\nOyBlID0gZS5uZXh0KSB7CiAgICAgICAgICAgICAgICBFbnRyeSBjbG9uZSA9\nIChFbnRyeSkgZS5jbG9uZSgpOwogICAgICAgICAgICAgICAgaW50IGogPSBj\nbG9uZS5oYXNoICYgbWFzazsKICAgICAgICAgICAgICAgIGNsb25lLm5leHQg\nPSBuZXdUYWJsZVtqXTsKICAgICAgICAgICAgICAgIG5ld1RhYmxlW2pdID0g\nY2xvbmU7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgdGFibGUg\nPSBuZXdUYWJsZTsKICAgICAgICB0aHJlc2hvbGQgPSAoaW50KSAobmV3Q2Fw\nYWNpdHkgKiBsb2FkRmFjdG9yKTsKICAgIH0KCiAgICAvKioKICAgICAqIENv\ncGllcyBhbGwgb2YgdGhlIG1hcHBpbmdzIGZyb20gdGhlIHNwZWNpZmllZCBt\nYXAgdG8gdGhpcyBtYXAKICAgICAqIFRoZXNlIG1hcHBpbmdzIHdpbGwgcmVw\nbGFjZSBhbnkgbWFwcGluZ3MgdGhhdAogICAgICogdGhpcyBtYXAgaGFkIGZv\nciBhbnkgb2YgdGhlIGtleXMgY3VycmVudGx5IGluIHRoZSBzcGVjaWZpZWQg\nbWFwLgogICAgICoKICAgICAqIEBwYXJhbSB0IG1hcHBpbmdzIHRvIGJlIHN0\nb3JlZCBpbiB0aGlzIG1hcC4KICAgICAqIEB0aHJvd3MgTnVsbFBvaW50ZXJF\neGNlcHRpb24gaWYgdGhlIHNwZWNpZmllZCBtYXAgaXMgbnVsbC4KICAgICAq\nLwogICAgcHVibGljIGZpbmFsIHN5bmNocm9uaXplZCB2b2lkIHB1dEFsbChN\nYXAgdCkgewogICAgICAgIC8vIEV4cGFuZCBlbm91Z2ggdG8gaG9sZCB0J3Mg\nZWxlbWVudHMgd2l0aG91dCByZXNpemluZy4KICAgICAgICBpbnQgbiA9IHQu\nc2l6ZSgpOwogICAgICAgIGlmIChuID09IDApIHJldHVybjsKICAgICAgICBp\nZiAobiA+PSB0aHJlc2hvbGQpIHsKICAgICAgICAgICAgbiA9IChpbnQpIChu\nIC8gbG9hZEZhY3RvciArIDEpOwogICAgICAgICAgICBpZiAobiA+IE1BWElN\nVU1fQ0FQQUNJVFkpIG4gPSBNQVhJTVVNX0NBUEFDSVRZOwogICAgICAgICAg\nICBpbnQgY2FwYWNpdHkgPSB0YWJsZS5sZW5ndGg7CiAgICAgICAgICAgIHdo\naWxlIChjYXBhY2l0eSA8IG4pIGNhcGFjaXR5IDw8PSAxOwogICAgICAgICAg\nICByZXNpemUoY2FwYWNpdHkpOwogICAgICAgIH0KCiAgICAgICAgZm9yIChJ\ndGVyYXRvciBpID0gdC5lbnRyeVNldCgpLml0ZXJhdG9yKCk7IGkuaGFzTmV4\ndCgpOykgewogICAgICAgICAgICBNYXAuRW50cnkgZSA9IChNYXAuRW50cnkp\nIGkubmV4dCgpOwogICAgICAgICAgICBwdXQoZS5nZXRLZXkoKSwgZS5nZXRW\nYWx1ZSgpKTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBSZW1v\ndmVzIHRoZSBtYXBwaW5nIGZvciB0aGlzIGtleSBmcm9tIHRoaXMgbWFwIGlm\nIHByZXNlbnQuCiAgICAgKgogICAgICogQHBhcmFtIGtleSBrZXkgd2hvc2Ug\nbWFwcGluZyBpcyB0byBiZSByZW1vdmVkIGZyb20gdGhlIG1hcC4KICAgICAq\nIEByZXR1cm4gcHJldmlvdXMgdmFsdWUgYXNzb2NpYXRlZCB3aXRoIHNwZWNp\nZmllZCBrZXksIG9yIDx0dD5udWxsPC90dD4KICAgICAqIGlmIHRoZXJlIHdh\ncyBubyBtYXBwaW5nIGZvciBrZXkuIEEgPHR0Pm51bGw8L3R0PiByZXR1cm4g\nY2FuCiAgICAgKiBhbHNvIGluZGljYXRlIHRoYXQgdGhlIG1hcCBwcmV2aW91\nc2x5IGFzc29jaWF0ZWQgPHR0Pm51bGw8L3R0PgogICAgICogd2l0aCB0aGUg\nc3BlY2lmaWVkIGtleS4KICAgICAqLwogICAgcHVibGljIE9iamVjdCByZW1v\ndmUoT2JqZWN0IGtleSkgewogICAgICAgIEVudHJ5IGUgPSByZW1vdmVFbnRy\neUZvcktleShrZXkpOwogICAgICAgIHJldHVybiAoZSA9PSBudWxsID8gZSA6\nIGUudmFsdWUpOwogICAgfQoKICAgIC8qKgogICAgICogUmVtb3ZlcyBhbmQg\ncmV0dXJucyB0aGUgZW50cnkgYXNzb2NpYXRlZCB3aXRoIHRoZSBzcGVjaWZp\nZWQga2V5IGluIHRoZQogICAgICogQ29uY3VycmVudEhhc2hNYXAuIFJldHVy\nbnMgbnVsbCBpZiB0aGUgQ29uY3VycmVudEhhc2hNYXAgY29udGFpbnMgbm8K\nICAgICAqIG1hcHBpbmcgZm9yIHRoaXMga2V5LgogICAgICovCiAgICBwcml2\nYXRlIEVudHJ5IHJlbW92ZUVudHJ5Rm9yS2V5KE9iamVjdCBrZXkpIHsKICAg\nICAgICBPYmplY3QgayA9IG1hc2tOdWxsKGtleSk7CiAgICAgICAgaW50IGhh\nc2ggPSBoYXNoKGspOwogICAgICAgIHN5bmNocm9uaXplZCAodGhpcykgewog\nICAgICAgICAgICBpbnQgaSA9IGhhc2ggJiAodGFibGUubGVuZ3RoIC0gMSk7\nCiAgICAgICAgICAgIEVudHJ5IGUgPSB0YWJsZVtpXTsKCiAgICAgICAgICAg\nIGlmIChlID09IG51bGwpIHJldHVybiBudWxsOwogICAgICAgICAgICBpZiAo\nZS5oYXNoID09IGhhc2ggJiYgZXEoaywgZS5rZXkpKSB7CiAgICAgICAgICAg\nICAgICBzaXplLS07CiAgICAgICAgICAgICAgICB0YWJsZVtpXSA9IGUubmV4\ndDsKICAgICAgICAgICAgICAgIHJldHVybiBlOwogICAgICAgICAgICB9Cgog\nICAgICAgICAgICBFbnRyeSBwcmV2ID0gZTsKICAgICAgICAgICAgZm9yIChl\nID0gZS5uZXh0OyBlICE9IG51bGw7IHByZXYgPSBlLCBlID0gZS5uZXh0KSB7\nCiAgICAgICAgICAgICAgICBpZiAoZS5oYXNoID09IGhhc2ggJiYgZXEoaywg\nZS5rZXkpKSB7CiAgICAgICAgICAgICAgICAgICAgc2l6ZS0tOwogICAgICAg\nICAgICAgICAgICAgIHByZXYubmV4dCA9IGUubmV4dDsKICAgICAgICAgICAg\nICAgICAgICByZXR1cm4gZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAg\nICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4gbnVsbDsKICAgIH0KCiAg\nICAvKioKICAgICAqIFNwZWNpYWwgdmVyc2lvbiBvZiByZW1vdmUgZm9yIEVu\ndHJ5U2V0LgogICAgICovCiAgICBwcml2YXRlIEVudHJ5IHJlbW92ZU1hcHBp\nbmcoT2JqZWN0IG8pIHsKICAgICAgICBpZiAoIShvIGluc3RhbmNlb2YgTWFw\nLkVudHJ5KSkgcmV0dXJuIG51bGw7CgogICAgICAgIE1hcC5FbnRyeSBlbnRy\neSA9IChNYXAuRW50cnkpIG87CiAgICAgICAgT2JqZWN0IGsgPSBtYXNrTnVs\nbChlbnRyeS5nZXRLZXkoKSk7CiAgICAgICAgaW50IGhhc2ggPSBoYXNoKGsp\nOwogICAgICAgIHN5bmNocm9uaXplZCAodGhpcykgewogICAgICAgICAgICBp\nbnQgaSA9IGhhc2ggJiAodGFibGUubGVuZ3RoIC0gMSk7CiAgICAgICAgICAg\nIEVudHJ5IGUgPSB0YWJsZVtpXTsKCiAgICAgICAgICAgIGlmIChlID09IG51\nbGwpIHJldHVybiBudWxsOwogICAgICAgICAgICBpZiAoZS5oYXNoID09IGhh\nc2ggJiYgZS5lcXVhbHMoZW50cnkpKSB7CiAgICAgICAgICAgICAgICBzaXpl\nLS07CiAgICAgICAgICAgICAgICB0YWJsZVtpXSA9IGUubmV4dDsKICAgICAg\nICAgICAgICAgIHJldHVybiBlOwogICAgICAgICAgICB9CgogICAgICAgICAg\nICBFbnRyeSBwcmV2ID0gZTsKICAgICAgICAgICAgZm9yIChlID0gZS5uZXh0\nOyBlICE9IG51bGw7IHByZXYgPSBlLCBlID0gZS5uZXh0KSB7CiAgICAgICAg\nICAgICAgICBpZiAoZS5oYXNoID09IGhhc2ggJiYgZS5lcXVhbHMoZW50cnkp\nKSB7CiAgICAgICAgICAgICAgICAgICAgc2l6ZS0tOwogICAgICAgICAgICAg\nICAgICAgIHByZXYubmV4dCA9IGUubmV4dDsKICAgICAgICAgICAgICAgICAg\nICByZXR1cm4gZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQog\nICAgICAgIH0KICAgICAgICByZXR1cm4gbnVsbDsKICAgIH0KCiAgICAvKioK\nICAgICAqIFJlbW92ZXMgYWxsIG1hcHBpbmdzIGZyb20gdGhpcyBtYXAuCiAg\nICAgKi8KICAgIHB1YmxpYyBzeW5jaHJvbml6ZWQgdm9pZCBjbGVhcigpIHsK\nICAgICAgICB0YWJsZSA9IG5ldyBFbnRyeVt0YWJsZS5sZW5ndGhdOwogICAg\nICAgIHNpemUgPSAwOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIGFu\nIGFyYml0cmFyeSBlbnRyeSBpbmRleC4KICAgICAqLwogICAgcHJpdmF0ZSBp\nbnQgcmFuZG9tRW50cnlJbmRleCgpIHsKICAgICAgICBpZiAocmFuZG9tRW50\ncnkgPT0gUkFORE9NUy5sZW5ndGgpCiAgICAgICAgICAgIHJhbmRvbUVudHJ5\nID0gMDsKICAgICAgICByZXR1cm4gKGludCkgKFJBTkRPTVNbcmFuZG9tRW50\ncnkrK10gKiB0YWJsZS5sZW5ndGgpOwogICAgfQoKICAgIHB1YmxpYyBNYXAu\nRW50cnkgcmVtb3ZlUmFuZG9tKCkgewogICAgICAgIGlmIChzaXplID09IDAp\nCiAgICAgICAgICAgIHJldHVybiBudWxsOwoKICAgICAgICBzeW5jaHJvbml6\nZWQgKHRoaXMpIHsKICAgICAgICAgICAgaW50IHJhbmRvbSA9IHJhbmRvbUVu\ndHJ5SW5kZXgoKTsKICAgICAgICAgICAgaW50IGluZGV4ID0gZmluZEVudHJ5\nKHJhbmRvbSwgcmFuZG9tICUgMiA9PSAwLCBmYWxzZSk7CiAgICAgICAgICAg\nIGlmIChpbmRleCA9PSAtMSkKICAgICAgICAgICAgICAgIHJldHVybiBudWxs\nOwogICAgICAgICAgICBFbnRyeSByZW0gPSB0YWJsZVtpbmRleF07CiAgICAg\nICAgICAgIHRhYmxlW2luZGV4XSA9IHJlbS5uZXh0OwogICAgICAgICAgICBz\naXplLS07CiAgICAgICAgICAgIHJldHVybiByZW07CiAgICAgICAgfQogICAg\nfQoKICAgIC8qKgogICAgICogRmluZCB0aGUgaW5kZXggb2YgdGhlIGVudHJ5\nIG5lYXJlc3QgdGhlIGdpdmVuIGluZGV4LCBzdGFydGluZyBpbiB0aGUKICAg\nICAqIGdpdmVuIGRpcmVjdGlvbi4KICAgICAqLwogICAgcHJpdmF0ZSBpbnQg\nZmluZEVudHJ5KGludCBzdGFydCwgYm9vbGVhbiBmb3J3YXJkLCBib29sZWFu\nIHNlYXJjaGVkT3RoZXIpIHsKICAgICAgICBpZiAoZm9yd2FyZCkgewogICAg\nICAgICAgICBmb3IgKGludCBpID0gc3RhcnQ7IGkgPCB0YWJsZS5sZW5ndGg7\nIGkrKykKICAgICAgICAgICAgICAgIGlmICh0YWJsZVtpXSAhPSBudWxsKQog\nICAgICAgICAgICAgICAgICAgIHJldHVybiBpOwogICAgICAgICAgICByZXR1\ncm4gKHNlYXJjaGVkT3RoZXIgfHwgc3RhcnQgPT0gMCkgPyAtMQogICAgICAg\nICAgICAgICAgOiBmaW5kRW50cnkoc3RhcnQgLSAxLCBmYWxzZSwgdHJ1ZSk7\nCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgZm9yIChpbnQgaSA9IHN0\nYXJ0OyBpID49IDA7IGktLSkKICAgICAgICAgICAgICAgIGlmICh0YWJsZVtp\nXSAhPSBudWxsKQogICAgICAgICAgICAgICAgICAgIHJldHVybiBpOwogICAg\nICAgICAgICByZXR1cm4gKHNlYXJjaGVkT3RoZXIgfHwgc3RhcnQgPT0gdGFi\nbGUubGVuZ3RoIC0gMSkgPyAtMQogICAgICAgICAgICAgICAgOiBmaW5kRW50\ncnkoc3RhcnQgKyAxLCB0cnVlLCB0cnVlKTsKICAgICAgICB9CiAgICB9Cgog\nICAgcHVibGljIEl0ZXJhdG9yIHJhbmRvbUVudHJ5SXRlcmF0b3IoKSB7CiAg\nICAgICAgLy8gcGFzcyBpbmRleCBzbyBjYWxjdWxhdGVkIGJlZm9yZSBpdGVy\nYXRvciByZWZzIHRhYmxlLCBpbiBjYXNlIHRhYmxlCiAgICAgICAgLy8gZ2V0\ncyByZXBsYWNlIHdpdGggYSBsYXJnZXIgb25lCiAgICAgICAgcmV0dXJuIG5l\ndyBIYXNoSXRlcmF0b3IoRU5UUklFUywgcmFuZG9tRW50cnlJbmRleCgpKTsK\nICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybnMgPHR0PnRydWU8L3R0PiBp\nZiB0aGlzIG1hcCBtYXBzIG9uZSBvciBtb3JlIGtleXMgdG8gdGhlCiAgICAg\nKiBzcGVjaWZpZWQgdmFsdWUuCiAgICAgKgogICAgICogQHBhcmFtIHZhbHVl\nIHZhbHVlIHdob3NlIHByZXNlbmNlIGluIHRoaXMgbWFwIGlzIHRvIGJlIHRl\nc3RlZC4KICAgICAqIEByZXR1cm4gPHR0PnRydWU8L3R0PiBpZiB0aGlzIG1h\ncCBtYXBzIG9uZSBvciBtb3JlIGtleXMgdG8gdGhlCiAgICAgKiBzcGVjaWZp\nZWQgdmFsdWUuCiAgICAgKi8KICAgIHB1YmxpYyBmaW5hbCBib29sZWFuIGNv\nbnRhaW5zVmFsdWUoT2JqZWN0IHZhbHVlKSB7CiAgICAgICAgaWYgKHZhbHVl\nID09IG51bGwpIHJldHVybiBjb250YWluc051bGxWYWx1ZSgpOwoKICAgICAg\nICBFbnRyeSB0YWJbXSA9IHRhYmxlOwogICAgICAgIGZvciAoaW50IGkgPSAw\nOyBpIDwgdGFiLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGZvciAoRW50\ncnkgZSA9IHRhYltpXTsgZSAhPSBudWxsOyBlID0gZS5uZXh0KSB7CiAgICAg\nICAgICAgICAgICBpZiAodmFsdWUuZXF1YWxzKGUudmFsdWUpKSByZXR1cm4g\ndHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4g\nZmFsc2U7CiAgICB9CgogICAgLyoqCiAgICAgKiBTcGVjaWFsLWNhc2UgY29k\nZSBmb3IgY29udGFpbnNWYWx1ZSB3aXRoIG51bGwgYXJndW1lbnQKICAgICAq\nLwogICAgcHJpdmF0ZSBib29sZWFuIGNvbnRhaW5zTnVsbFZhbHVlKCkgewog\nICAgICAgIEVudHJ5IHRhYltdID0gdGFibGU7CiAgICAgICAgZm9yIChpbnQg\naSA9IDA7IGkgPCB0YWIubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgZm9y\nIChFbnRyeSBlID0gdGFiW2ldOyBlICE9IG51bGw7IGUgPSBlLm5leHQpIHsK\nICAgICAgICAgICAgICAgIGlmIChlLnZhbHVlID09IG51bGwpIHJldHVybiB0\ncnVlOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiBm\nYWxzZTsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybnMgYSBzaGFsbG93\nIGNvcHkgb2YgdGhpcyA8dHQ+Q29uY3VycmVudEhhc2hNYXA8L3R0PiBpbnN0\nYW5jZTogdGhlCiAgICAgKiBrZXlzIGFuZCB2YWx1ZXMgdGhlbXNlbHZlcyBh\ncmUgbm90IGNsb25lZC4KICAgICAqCiAgICAgKiBAcmV0dXJuIGEgc2hhbGxv\ndyBjb3B5IG9mIHRoaXMgbWFwLgogICAgICovCiAgICBwdWJsaWMgZmluYWwg\nT2JqZWN0IGNsb25lKCkgewogICAgICAgIHJldHVybiBuZXcgQ29uY3VycmVu\ndEhhc2hNYXAodGhpcyk7CiAgICB9CgogICAgcHJvdGVjdGVkIEVudHJ5IGNy\nZWF0ZUVudHJ5KGludCBoLCBPYmplY3QgaywgT2JqZWN0IHYsIEVudHJ5IG4p\nIHsKICAgICAgICByZXR1cm4gbmV3IEVudHJ5KGgsIGssIHYsIG4pOwogICAg\nfQoKICAgIHByb3RlY3RlZCBzdGF0aWMgY2xhc3MgRW50cnkgaW1wbGVtZW50\ncyBNYXAuRW50cnkgewoKICAgICAgICBmaW5hbCBPYmplY3Qga2V5OwogICAg\nICAgIE9iamVjdCB2YWx1ZTsKICAgICAgICBmaW5hbCBpbnQgaGFzaDsKICAg\nICAgICBFbnRyeSBuZXh0OwoKICAgICAgICAvKioKICAgICAgICAgKiBDcmVh\ndGUgbmV3IGVudHJ5LgogICAgICAgICAqLwogICAgICAgIHByb3RlY3RlZCBF\nbnRyeShpbnQgaCwgT2JqZWN0IGssIE9iamVjdCB2LCBFbnRyeSBuKSB7CiAg\nICAgICAgICAgIHZhbHVlID0gdjsKICAgICAgICAgICAgbmV4dCA9IG47CiAg\nICAgICAgICAgIGtleSA9IGs7CiAgICAgICAgICAgIGhhc2ggPSBoOwogICAg\nICAgIH0KCiAgICAgICAgcHVibGljIE9iamVjdCBnZXRLZXkoKSB7CiAgICAg\nICAgICAgIHJldHVybiB1bm1hc2tOdWxsKGtleSk7CiAgICAgICAgfQoKICAg\nICAgICBwdWJsaWMgT2JqZWN0IGdldFZhbHVlKCkgewogICAgICAgICAgICBy\nZXR1cm4gdmFsdWU7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgT2JqZWN0\nIHNldFZhbHVlKE9iamVjdCBuZXdWYWx1ZSkgewogICAgICAgICAgICBPYmpl\nY3Qgb2xkVmFsdWUgPSB2YWx1ZTsKICAgICAgICAgICAgdmFsdWUgPSBuZXdW\nYWx1ZTsKICAgICAgICAgICAgcmV0dXJuIG9sZFZhbHVlOwogICAgICAgIH0K\nCiAgICAgICAgcHVibGljIGJvb2xlYW4gZXF1YWxzKE9iamVjdCBvKSB7CiAg\nICAgICAgICAgIGlmICghKG8gaW5zdGFuY2VvZiBNYXAuRW50cnkpKSByZXR1\ncm4gZmFsc2U7CiAgICAgICAgICAgIE1hcC5FbnRyeSBlID0gKE1hcC5FbnRy\neSkgbzsKICAgICAgICAgICAgT2JqZWN0IGsxID0gZ2V0S2V5KCk7CiAgICAg\nICAgICAgIE9iamVjdCBrMiA9IGUuZ2V0S2V5KCk7CiAgICAgICAgICAgIGlm\nIChrMSA9PSBrMiB8fCAoazEgIT0gbnVsbCAmJiBrMS5lcXVhbHMoazIpKSkg\newogICAgICAgICAgICAgICAgT2JqZWN0IHYxID0gZ2V0VmFsdWUoKTsKICAg\nICAgICAgICAgICAgIE9iamVjdCB2MiA9IGUuZ2V0VmFsdWUoKTsKICAgICAg\nICAgICAgICAgIGlmICh2MSA9PSB2MiB8fCAodjEgIT0gbnVsbCAmJiB2MS5l\ncXVhbHModjIpKSkKICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsK\nICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAg\nICAgfQoKICAgICAgICBwdWJsaWMgaW50IGhhc2hDb2RlKCkgewogICAgICAg\nICAgICByZXR1cm4gKGtleSA9PSBOVUxMX0tFWSA/IDAgOiBrZXkuaGFzaENv\nZGUoKSkgXgogICAgICAgICAgICAgICAgKHZhbHVlID09IG51bGwgPyAwIDog\ndmFsdWUuaGFzaENvZGUoKSk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMg\nU3RyaW5nIHRvU3RyaW5nKCkgewogICAgICAgICAgICByZXR1cm4gZ2V0S2V5\nKCkgKyAiPSIgKyBnZXRWYWx1ZSgpOwogICAgICAgIH0KCiAgICAgICAgcHJv\ndGVjdGVkIE9iamVjdCBjbG9uZSgpIHsKICAgICAgICAgICAgLy8gSXQgaXMg\ndGhlIGNhbGxlcnMgcmVzcG9uc2liaWxpdHkgdG8gc2V0IHRoZSBuZXh0IGZp\nZWxkCiAgICAgICAgICAgIC8vIGNvcnJlY3RseS4KICAgICAgICAgICAgcmV0\ndXJuIG5ldyBFbnRyeShoYXNoLCBrZXksIHZhbHVlLCBudWxsKTsKICAgICAg\nICB9CiAgICB9CgogICAgLy8gVHlwZXMgb2YgRW51bWVyYXRpb25zL0l0ZXJh\ndGlvbnMKICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIGludCBLRVlTID0gMDsK\nICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIGludCBWQUxVRVMgPSAxOwogICAg\ncHJpdmF0ZSBzdGF0aWMgZmluYWwgaW50IEVOVFJJRVMgPSAyOwoKICAgIC8q\nKgogICAgICogTWFwIGl0ZXJhdG9yLgogICAgICovCiAgICBwcml2YXRlIGNs\nYXNzIEhhc2hJdGVyYXRvciBpbXBsZW1lbnRzIEl0ZXJhdG9yIHsKCiAgICAg\nICAgZmluYWwgRW50cnlbXSB0YWJsZSA9IENvbmN1cnJlbnRIYXNoTWFwLnRo\naXMudGFibGU7CiAgICAgICAgZmluYWwgaW50IHR5cGU7CiAgICAgICAgaW50\nIHN0YXJ0SW5kZXg7CiAgICAgICAgaW50IHN0b3BJbmRleCA9IDA7CiAgICAg\nICAgaW50IGluZGV4OwogICAgICAgIEVudHJ5IGVudHJ5ID0gbnVsbDsKICAg\nICAgICBFbnRyeSBsYXN0UmV0dXJuZWQgPSBudWxsOwoKICAgICAgICBIYXNo\nSXRlcmF0b3IoaW50IHR5cGUsIGludCBzdGFydEluZGV4KSB7CiAgICAgICAg\nICAgIHRoaXMudHlwZSA9IHR5cGU7CiAgICAgICAgICAgIHRoaXMuc3RhcnRJ\nbmRleCA9IHN0YXJ0SW5kZXg7CiAgICAgICAgICAgIGluZGV4ID0gc3RhcnRJ\nbmRleDsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBib29sZWFuIGhhc05l\neHQoKSB7CiAgICAgICAgICAgIGlmIChlbnRyeSAhPSBudWxsKSB7CiAgICAg\nICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAg\nICAgICB3aGlsZSAoaW5kZXggPj0gc3RvcEluZGV4KSB7CiAgICAgICAgICAg\nICAgICBpZiAoKGVudHJ5ID0gdGFibGVbaW5kZXgtLV0pICE9IG51bGwpIHsK\nICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAg\nICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoc3RvcEluZGV4\nID09IDApIHsKICAgICAgICAgICAgICAgIGluZGV4ID0gdGFibGUubGVuZ3Ro\nIC0gMTsKICAgICAgICAgICAgICAgIHN0b3BJbmRleCA9IHN0YXJ0SW5kZXgg\nKyAxOwogICAgICAgICAgICAgICAgd2hpbGUgKGluZGV4ID49IHN0b3BJbmRl\neCkgewogICAgICAgICAgICAgICAgICAgIGlmICgoZW50cnkgPSB0YWJsZVtp\nbmRleC0tXSkgIT0gbnVsbCkgewogICAgICAgICAgICAgICAgICAgICAgICBy\nZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAg\nICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIGZhbHNl\nOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIE9iamVjdCBuZXh0KCkgewog\nICAgICAgICAgICBpZiAoIWhhc05leHQoKSkKICAgICAgICAgICAgICAgIHRo\ncm93IG5ldyBOb1N1Y2hFbGVtZW50RXhjZXB0aW9uKCk7CiAgICAgICAgICAg\nIEVudHJ5IGUgPSBsYXN0UmV0dXJuZWQgPSBlbnRyeTsKICAgICAgICAgICAg\nZW50cnkgPSBlLm5leHQ7CiAgICAgICAgICAgIHJldHVybiB0eXBlID09IEtF\nWVMgPyBlLmtleSA6ICh0eXBlID09IFZBTFVFUyA/IGUudmFsdWUgOiBlKTsK\nICAgICAgICB9CgogICAgICAgIHB1YmxpYyB2b2lkIHJlbW92ZSgpIHsKICAg\nICAgICAgICAgaWYgKGxhc3RSZXR1cm5lZCA9PSBudWxsKQogICAgICAgICAg\nICAgICAgdGhyb3cgbmV3IElsbGVnYWxTdGF0ZUV4Y2VwdGlvbigpOwogICAg\nICAgICAgICBzeW5jaHJvbml6ZWQgKENvbmN1cnJlbnRIYXNoTWFwLnRoaXMp\nIHsKICAgICAgICAgICAgICAgIEVudHJ5W10gdGFiID0gQ29uY3VycmVudEhh\nc2hNYXAudGhpcy50YWJsZTsKICAgICAgICAgICAgICAgIGludCBpbmRleCA9\nIChsYXN0UmV0dXJuZWQuaGFzaCAmIDB4N0ZGRkZGRkYpICUgdGFiLmxlbmd0\naDsKCiAgICAgICAgICAgICAgICBmb3IgKEVudHJ5IGUgPSB0YWJbaW5kZXhd\nLCBwcmV2ID0gbnVsbDsgZSAhPSBudWxsOwogICAgICAgICAgICAgICAgICAg\nIHByZXYgPSBlLCBlID0gZS5uZXh0KSB7CiAgICAgICAgICAgICAgICAgICAg\naWYgKGUgPT0gbGFzdFJldHVybmVkKSB7CiAgICAgICAgICAgICAgICAgICAg\nICAgIGlmIChwcmV2ID09IG51bGwpCiAgICAgICAgICAgICAgICAgICAgICAg\nICAgICB0YWJbaW5kZXhdID0gZS5uZXh0OwogICAgICAgICAgICAgICAgICAg\nICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmV2Lm5l\neHQgPSBlLm5leHQ7CiAgICAgICAgICAgICAgICAgICAgICAgIHNpemUtLTsK\nICAgICAgICAgICAgICAgICAgICAgICAgbGFzdFJldHVybmVkID0gbnVsbDsK\nICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAg\nICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHRo\ncm93IG5ldyBFcnJvcigiSXRlcmF0ZWQgb2ZmIHRhYmxlIHdoZW4gZG9pbmcg\ncmVtb3ZlIik7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAg\nLy8gVmlld3MKCiAgICBwcml2YXRlIHRyYW5zaWVudCBTZXQgZW50cnlTZXQg\nPSBudWxsOwogICAgcHJpdmF0ZSB0cmFuc2llbnQgU2V0IGtleVNldCA9IG51\nbGw7CiAgICBwcml2YXRlIHRyYW5zaWVudCBDb2xsZWN0aW9uIHZhbHVlcyA9\nIG51bGw7CgogICAgLyoqCiAgICAgKiBSZXR1cm5zIGEgc2V0IHZpZXcgb2Yg\ndGhlIGtleXMgY29udGFpbmVkIGluIHRoaXMgbWFwLiBUaGUgc2V0IGlzCiAg\nICAgKiBiYWNrZWQgYnkgdGhlIG1hcCwgc28gY2hhbmdlcyB0byB0aGUgbWFw\nIGFyZSByZWZsZWN0ZWQgaW4gdGhlIHNldCwgYW5kCiAgICAgKiB2aWNlLXZl\ncnNhLiBUaGUgc2V0IHN1cHBvcnRzIGVsZW1lbnQgcmVtb3ZhbCwgd2hpY2gg\ncmVtb3ZlcyB0aGUKICAgICAqIGNvcnJlc3BvbmRpbmcgbWFwcGluZyBmcm9t\nIHRoaXMgbWFwLCB2aWEgdGhlIDx0dD5JdGVyYXRvci5yZW1vdmU8L3R0PiwK\nICAgICAqIDx0dD5TZXQucmVtb3ZlPC90dD4sIDx0dD5yZW1vdmVBbGw8L3R0\nPiwgPHR0PnJldGFpbkFsbDwvdHQ+LCBhbmQKICAgICAqIDx0dD5jbGVhcjwv\ndHQ+IG9wZXJhdGlvbnMuIEl0IGRvZXMgbm90IHN1cHBvcnQgdGhlIDx0dD5h\nZGQ8L3R0PiBvcgogICAgICogPHR0PmFkZEFsbDwvdHQ+IG9wZXJhdGlvbnMu\nCiAgICAgKgogICAgICogQHJldHVybiBhIHNldCB2aWV3IG9mIHRoZSBrZXlz\nIGNvbnRhaW5lZCBpbiB0aGlzIG1hcC4KICAgICAqLwogICAgcHVibGljIGZp\nbmFsIFNldCBrZXlTZXQoKSB7CiAgICAgICAgU2V0IGtzID0ga2V5U2V0Owog\nICAgICAgIHJldHVybiAoa3MgIT0gbnVsbCA/IGtzIDogKGtleVNldCA9IG5l\ndyBLZXlTZXQoKSkpOwogICAgfQoKICAgIHByaXZhdGUgZmluYWwgY2xhc3Mg\nS2V5U2V0IGV4dGVuZHMgQWJzdHJhY3RTZXQgewoKICAgICAgICBwdWJsaWMg\nSXRlcmF0b3IgaXRlcmF0b3IoKSB7CiAgICAgICAgICAgIHJldHVybiBuZXcg\nSGFzaEl0ZXJhdG9yKEtFWVMsIHRhYmxlLmxlbmd0aCAtIDEpOwogICAgICAg\nIH0KCiAgICAgICAgcHVibGljIGludCBzaXplKCkgewogICAgICAgICAgICBy\nZXR1cm4gc2l6ZTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBib29sZWFu\nIGNvbnRhaW5zKE9iamVjdCBvKSB7CiAgICAgICAgICAgIHJldHVybiBjb250\nYWluc0tleShvKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBib29sZWFu\nIHJlbW92ZShPYmplY3QgbykgewogICAgICAgICAgICByZXR1cm4gQ29uY3Vy\ncmVudEhhc2hNYXAudGhpcy5yZW1vdmVFbnRyeUZvcktleShvKSAhPSBudWxs\nOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIHZvaWQgY2xlYXIoKSB7CiAg\nICAgICAgICAgIENvbmN1cnJlbnRIYXNoTWFwLnRoaXMuY2xlYXIoKTsKICAg\nICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm5zIGEgY29sbGVj\ndGlvbiB2aWV3IG9mIHRoZSB2YWx1ZXMgY29udGFpbmVkIGluIHRoaXMgbWFw\nLiBUaGUKICAgICAqIGNvbGxlY3Rpb24gaXMgYmFja2VkIGJ5IHRoZSBtYXAs\nIHNvIGNoYW5nZXMgdG8gdGhlIG1hcCBhcmUgcmVmbGVjdGVkIGluCiAgICAg\nKiB0aGUgY29sbGVjdGlvbiwgYW5kIHZpY2UtdmVyc2EuIFRoZSBjb2xsZWN0\naW9uIHN1cHBvcnRzIGVsZW1lbnQKICAgICAqIHJlbW92YWwsIHdoaWNoIHJl\nbW92ZXMgdGhlIGNvcnJlc3BvbmRpbmcgbWFwcGluZyBmcm9tIHRoaXMgbWFw\nLCB2aWEgdGhlCiAgICAgKiA8dHQ+SXRlcmF0b3IucmVtb3ZlPC90dD4sIDx0\ndD5Db2xsZWN0aW9uLnJlbW92ZTwvdHQ+LAogICAgICogPHR0PnJlbW92ZUFs\nbDwvdHQ+LCA8dHQ+cmV0YWluQWxsPC90dD4sIGFuZCA8dHQ+Y2xlYXI8L3R0\nPiBvcGVyYXRpb25zLgogICAgICogSXQgZG9lcyBub3Qgc3VwcG9ydCB0aGUg\nPHR0PmFkZDwvdHQ+IG9yIDx0dD5hZGRBbGw8L3R0PiBvcGVyYXRpb25zLgog\nICAgICoKICAgICAqIEByZXR1cm4gYSBjb2xsZWN0aW9uIHZpZXcgb2YgdGhl\nIHZhbHVlcyBjb250YWluZWQgaW4gdGhpcyBtYXAuCiAgICAgKi8KICAgIHB1\nYmxpYyBmaW5hbCBDb2xsZWN0aW9uIHZhbHVlcygpIHsKICAgICAgICBDb2xs\nZWN0aW9uIHZzID0gdmFsdWVzOwogICAgICAgIHJldHVybiAodnMgIT0gbnVs\nbCA/IHZzIDogKHZhbHVlcyA9IG5ldyBWYWx1ZXMoKSkpOwogICAgfQoKICAg\nIHByaXZhdGUgZmluYWwgY2xhc3MgVmFsdWVzIGV4dGVuZHMgQWJzdHJhY3RD\nb2xsZWN0aW9uIHsKCiAgICAgICAgcHVibGljIEl0ZXJhdG9yIGl0ZXJhdG9y\nKCkgewogICAgICAgICAgICByZXR1cm4gbmV3IEhhc2hJdGVyYXRvcihWQUxV\nRVMsIHRhYmxlLmxlbmd0aCAtIDEpOwogICAgICAgIH0KCiAgICAgICAgcHVi\nbGljIGludCBzaXplKCkgewogICAgICAgICAgICByZXR1cm4gc2l6ZTsKICAg\nICAgICB9CgogICAgICAgIHB1YmxpYyBib29sZWFuIGNvbnRhaW5zKE9iamVj\ndCBvKSB7CiAgICAgICAgICAgIHJldHVybiBjb250YWluc1ZhbHVlKG8pOwog\nICAgICAgIH0KCiAgICAgICAgcHVibGljIHZvaWQgY2xlYXIoKSB7CiAgICAg\nICAgICAgIENvbmN1cnJlbnRIYXNoTWFwLnRoaXMuY2xlYXIoKTsKICAgICAg\nICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBSZXR1cm5zIGEgY29sbGVjdGlv\nbiB2aWV3IG9mIHRoZSBtYXBwaW5ncyBjb250YWluZWQgaW4gdGhpcyBtYXAu\nIEVhY2gKICAgICAqIGVsZW1lbnQgaW4gdGhlIHJldHVybmVkIGNvbGxlY3Rp\nb24gaXMgYSA8dHQ+TWFwLkVudHJ5PC90dD4uIFRoZQogICAgICogY29sbGVj\ndGlvbiBpcyBiYWNrZWQgYnkgdGhlIG1hcCwgc28gY2hhbmdlcyB0byB0aGUg\nbWFwIGFyZSByZWZsZWN0ZWQgaW4KICAgICAqIHRoZSBjb2xsZWN0aW9uLCBh\nbmQgdmljZS12ZXJzYS4gVGhlIGNvbGxlY3Rpb24gc3VwcG9ydHMgZWxlbWVu\ndAogICAgICogcmVtb3ZhbCwgd2hpY2ggcmVtb3ZlcyB0aGUgY29ycmVzcG9u\nZGluZyBtYXBwaW5nIGZyb20gdGhlIG1hcCwgdmlhIHRoZQogICAgICogPHR0\nPkl0ZXJhdG9yLnJlbW92ZTwvdHQ+LCA8dHQ+Q29sbGVjdGlvbi5yZW1vdmU8\nL3R0PiwKICAgICAqIDx0dD5yZW1vdmVBbGw8L3R0PiwgPHR0PnJldGFpbkFs\nbDwvdHQ+LCBhbmQgPHR0PmNsZWFyPC90dD4gb3BlcmF0aW9ucy4KICAgICAq\nIEl0IGRvZXMgbm90IHN1cHBvcnQgdGhlIDx0dD5hZGQ8L3R0PiBvciA8dHQ+\nYWRkQWxsPC90dD4gb3BlcmF0aW9ucy4KICAgICAqCiAgICAgKiBAcmV0dXJu\nIGEgY29sbGVjdGlvbiB2aWV3IG9mIHRoZSBtYXBwaW5ncyBjb250YWluZWQg\naW4gdGhpcyBtYXAuCiAgICAgKiBAc2VlIE1hcC5FbnRyeQogICAgICovCiAg\nICBwdWJsaWMgZmluYWwgU2V0IGVudHJ5U2V0KCkgewogICAgICAgIFNldCBl\ncyA9IGVudHJ5U2V0OwogICAgICAgIHJldHVybiAoZXMgIT0gbnVsbCA/IGVz\nIDogKGVudHJ5U2V0ID0gbmV3IEVudHJ5U2V0KCkpKTsKICAgIH0KCiAgICBw\ncml2YXRlIGZpbmFsIGNsYXNzIEVudHJ5U2V0IGV4dGVuZHMgQWJzdHJhY3RT\nZXQgewoKICAgICAgICBwdWJsaWMgSXRlcmF0b3IgaXRlcmF0b3IoKSB7CiAg\nICAgICAgICAgIHJldHVybiBuZXcgSGFzaEl0ZXJhdG9yKEVOVFJJRVMsIHRh\nYmxlLmxlbmd0aCAtIDEpOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIGJv\nb2xlYW4gY29udGFpbnMoT2JqZWN0IG8pIHsKICAgICAgICAgICAgaWYgKCEo\nbyBpbnN0YW5jZW9mIE1hcC5FbnRyeSkpIHJldHVybiBmYWxzZTsKICAgICAg\nICAgICAgTWFwLkVudHJ5IGUgPSAoTWFwLkVudHJ5KSBvOwogICAgICAgICAg\nICBFbnRyeSBjYW5kaWRhdGUgPSBnZXRFbnRyeShlLmdldEtleSgpKTsKICAg\nICAgICAgICAgcmV0dXJuIGNhbmRpZGF0ZSAhPSBudWxsICYmIGNhbmRpZGF0\nZS5lcXVhbHMoZSk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgYm9vbGVh\nbiByZW1vdmUoT2JqZWN0IG8pIHsKICAgICAgICAgICAgcmV0dXJuIHJlbW92\nZU1hcHBpbmcobykgIT0gbnVsbDsKICAgICAgICB9CgogICAgICAgIHB1Ymxp\nYyBpbnQgc2l6ZSgpIHsKICAgICAgICAgICAgcmV0dXJuIHNpemU7CiAgICAg\nICAgfQoKICAgICAgICBwdWJsaWMgdm9pZCBjbGVhcigpIHsKICAgICAgICAg\nICAgQ29uY3VycmVudEhhc2hNYXAudGhpcy5jbGVhcigpOwogICAgICAgIH0K\nICAgIH0KCiAgICAvKioKICAgICAqIFNhdmUgdGhlIHN0YXRlIG9mIHRoZSA8\ndHQ+Q29uY3VycmVudEhhc2hNYXA8L3R0PiBpbnN0YW5jZSB0byBhIHN0cmVh\nbQogICAgICogKGkuZS4sIHNlcmlhbGl6ZSBpdCkuCiAgICAgKgogICAgICog\nQHNlcmlhbERhdGEgVGhlIDxpPmNhcGFjaXR5PC9pPiBvZiB0aGUgQ29uY3Vy\ncmVudEhhc2hNYXAodGhlIGxlbmd0aCBvZgogICAgICogdGhlIGJ1Y2tldCBh\ncnJheSkgaXMgZW1pdHRlZChpbnQpLCBmb2xsb3dlZCBieSB0aGUgPGk+c2l6\nZTwvaT4gb2YgdGhlCiAgICAgKiBDb25jdXJyZW50SGFzaE1hcCh0aGUgbnVt\nYmVyIG9mIGtleS12YWx1ZSBtYXBwaW5ncyksIGZvbGxvd2VkIGJ5IHRoZSBr\nZXkKICAgICAqIChPYmplY3QpIGFuZCB2YWx1ZShPYmplY3QpIGZvciBlYWNo\nIGtleS12YWx1ZSBtYXBwaW5nIHJlcHJlc2VudGVkIGJ5IHRoZQogICAgICog\nQ29uY3VycmVudEhhc2hNYXAgVGhlIGtleS12YWx1ZSBtYXBwaW5ncyBhcmUg\nZW1pdHRlZCBpbiB0aGUgb3JkZXIgdGhhdAogICAgICogdGhleSBhcmUgcmV0\ndXJuZWQgYnkgPHR0PmVudHJ5U2V0KCkuaXRlcmF0b3IoKTwvdHQ+LgogICAg\nICovCiAgICBwcml2YXRlIHZvaWQgd3JpdGVPYmplY3QoT2JqZWN0T3V0cHV0\nU3RyZWFtIHMpIHRocm93cyBJT0V4Y2VwdGlvbiB7CiAgICAgICAgLy8gV3Jp\ndGUgb3V0IHRoZSB0aHJlc2hvbGQsIGxvYWRmYWN0b3IsIGFuZCBhbnkgaGlk\nZGVuIHN0dWZmCiAgICAgICAgcy5kZWZhdWx0V3JpdGVPYmplY3QoKTsKCiAg\nICAgICAgLy8gV3JpdGUgb3V0IG51bWJlciBvZiBidWNrZXRzCiAgICAgICAg\ncy53cml0ZUludCh0YWJsZS5sZW5ndGgpOwoKICAgICAgICAvLyBXcml0ZSBv\ndXQgc2l6ZShudW1iZXIgb2YgTWFwcGluZ3MpCiAgICAgICAgcy53cml0ZUlu\ndChzaXplKTsKICAgICAgICBzLndyaXRlSW50KG1heFNpemUpOwoKICAgICAg\nICAvLyBXcml0ZSBvdXQga2V5cyBhbmQgdmFsdWVzKGFsdGVybmF0aW5nKQog\nICAgICAgIGZvciAoSXRlcmF0b3IgaSA9IGVudHJ5U2V0KCkuaXRlcmF0b3Io\nKTsgaS5oYXNOZXh0KCk7KSB7CiAgICAgICAgICAgIE1hcC5FbnRyeSBlID0g\nKE1hcC5FbnRyeSkgaS5uZXh0KCk7CiAgICAgICAgICAgIHMud3JpdGVPYmpl\nY3QoZS5nZXRLZXkoKSk7CiAgICAgICAgICAgIHMud3JpdGVPYmplY3QoZS5n\nZXRWYWx1ZSgpKTsKICAgICAgICB9CiAgICB9CgogICAgcHJpdmF0ZSBzdGF0\naWMgZmluYWwgbG9uZyBzZXJpYWxWZXJzaW9uVUlEID0gLTY0NTI3MDY1NTY3\nMjQxMjU3NzhMOwoKICAgIC8qKgogICAgICogUmVjb25zdGl0dXRlIHRoZSA8\ndHQ+Q29uY3VycmVudEhhc2hNYXA8L3R0PiBpbnN0YW5jZSBmcm9tIGEgc3Ry\nZWFtKGkuZS4sCiAgICAgKiBkZXNlcmlhbGl6ZSBpdCkuCiAgICAgKi8KICAg\nIHByaXZhdGUgdm9pZCByZWFkT2JqZWN0KE9iamVjdElucHV0U3RyZWFtIHMp\nCiAgICAgICAgdGhyb3dzIElPRXhjZXB0aW9uLCBDbGFzc05vdEZvdW5kRXhj\nZXB0aW9uIHsKICAgICAgICAvLyBSZWFkIGluIHRoZSB0aHJlc2hvbGQsIGxv\nYWRmYWN0b3IsIGFuZCBhbnkgaGlkZGVuIHN0dWZmCiAgICAgICAgcy5kZWZh\ndWx0UmVhZE9iamVjdCgpOwoKICAgICAgICAvLyBSZWFkIGluIG51bWJlciBv\nZiBidWNrZXRzIGFuZCBhbGxvY2F0ZSB0aGUgYnVja2V0IGFycmF5OwogICAg\nICAgIGludCBudW1CdWNrZXRzID0gcy5yZWFkSW50KCk7CiAgICAgICAgdGFi\nbGUgPSBuZXcgRW50cnlbbnVtQnVja2V0c107CgogICAgICAgIC8vIFJlYWQg\naW4gc2l6ZShudW1iZXIgb2YgTWFwcGluZ3MpCiAgICAgICAgaW50IHNpemUg\nPSBzLnJlYWRJbnQoKTsKICAgICAgICAKICAgICAgICAvLyByZWFkIHRoZSBt\nYXggc2l6ZQogICAgICAgIG1heFNpemUgPSBzLnJlYWRJbnQoKTsKCiAgICAg\nICAgLy8gUmVhZCB0aGUga2V5cyBhbmQgdmFsdWVzLCBhbmQgcHV0IHRoZSBt\nYXBwaW5ncyBpbiB0aGUKICAgICAgICAvLyBDb25jdXJyZW50SGFzaE1hcAog\nICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgc2l6ZTsgaSsrKSB7CiAgICAg\nICAgICAgIE9iamVjdCBrZXkgPSBzLnJlYWRPYmplY3QoKTsKICAgICAgICAg\nICAgT2JqZWN0IHZhbHVlID0gcy5yZWFkT2JqZWN0KCk7CiAgICAgICAgICAg\nIHB1dChrZXksIHZhbHVlKTsKICAgICAgICB9CiAgICB9Cn0K\n","encoding":"base64"}

