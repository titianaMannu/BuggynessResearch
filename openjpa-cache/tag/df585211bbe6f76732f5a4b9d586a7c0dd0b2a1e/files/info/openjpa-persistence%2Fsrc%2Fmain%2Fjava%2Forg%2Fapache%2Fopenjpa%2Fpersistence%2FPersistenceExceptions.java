{"sha":"de581a042763593137ea3cc1940cdf18a9297b43","node_id":"MDQ6QmxvYjIwNjM2NDpkZTU4MWEwNDI3NjM1OTMxMzdlYTNjYzE5NDBjZGYxOGE5Mjk3YjQz","size":12238,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/de581a042763593137ea3cc1940cdf18a9297b43","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2U7CgppbXBv\ncnQgamF2YS5sYW5nLnJlZmxlY3QuSW52b2NhdGlvblRhcmdldEV4Y2VwdGlv\nbjsKCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLkJyb2tlcjsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLkV4Y2VwdGlvbnM7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5Ob1RyYW5zYWN0aW9uRXhj\nZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuT2JqZWN0\nRXhpc3RzRXhjZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0\naWwuT2JqZWN0Tm90Rm91bmRFeGNlcHRpb247CmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEudXRpbC5PcGVuSlBBRXhjZXB0aW9uOwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLnV0aWwuT3B0aW1pc3RpY0V4Y2VwdGlvbjsKaW1wb3J0\nIG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLlJ1bnRpbWVFeGNlcHRpb25UcmFu\nc2xhdG9yOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuU3RvcmVF\neGNlcHRpb247CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5Vc2Vy\nRXhjZXB0aW9uOwoKLyoqCiAqIENvbnZlcnRzIGZyb20gT3BlbkpQQSB0byBw\nZXJzaXN0ZW5jZSBleGNlcHRpb24gdHlwZXMuCiAqCiAqIEBhdXRob3IgQWJl\nIFdoaXRlCiAqIEBhdXRob3IgTWFyYyBQcnVkJ2hvbW1lYXV4CiAqIEBub2ph\ndmFkb2MKICovCnB1YmxpYyBjbGFzcyBQZXJzaXN0ZW5jZUV4Y2VwdGlvbnMK\nICAgIGV4dGVuZHMgRXhjZXB0aW9ucyB7CgogICAgcHVibGljIHN0YXRpYyBm\naW5hbCBSdW50aW1lRXhjZXB0aW9uVHJhbnNsYXRvciBUUkFOU0xBVE9SID0K\nICAgICAgICBuZXcgUnVudGltZUV4Y2VwdGlvblRyYW5zbGF0b3IoKSB7CiAg\nICAgICAgICAgIHB1YmxpYyBSdW50aW1lRXhjZXB0aW9uIHRyYW5zbGF0ZShS\ndW50aW1lRXhjZXB0aW9uIHJlKSB7CiAgICAgICAgICAgICAgICByZXR1cm4g\nUGVyc2lzdGVuY2VFeGNlcHRpb25zLnRvUGVyc2lzdGVuY2VFeGNlcHRpb24o\ncmUpOwogICAgICAgICAgICB9CiAgICAgICAgfTsKCiAgICAvKioKICAgICAq\nIFJldHVybnMgYSB7QGxpbmsgUnVudGltZUV4Y2VwdGlvblRyYW5zbGF0b3J9\nIHRoYXQgd2lsbCBwZXJmb3JtCiAgICAgKiB0aGUgY29ycmVjdCBleGNlcHRp\nb24gdHJhbnNsYXRpb24gYXMgd2VsbCBhcyByb2xsIGJhY2sgdGhlCiAgICAg\nKiBjdXJyZW50IHRyYW5zYWN0aW9uIHdoZW4gZm9yIGFsbCBidXQge0BsaW5r\nIE5vUmVzdWx0RXhjZXB0aW9ufQogICAgICogYW5kIHtAbGluayBOb25Vbmlx\ndWVSZXN1bHRFeGNlcHRpb259IGluIGFjY29yZGFuY2Ugd2l0aAogICAgICog\nc2VjdGlvbiAzLjcgb2YgdGhlIEVKQiAzLjAgc3BlY2lmaWNhdGlvbi4KICAg\nICAqLwogICAgcHVibGljIHN0YXRpYyBSdW50aW1lRXhjZXB0aW9uVHJhbnNs\nYXRvciBnZXRSb2xsYmFja1RyYW5zbGF0b3IoCiAgICAgICAgZmluYWwgT3Bl\nbkpQQUVudGl0eU1hbmFnZXIgZW0pIHsKICAgICAgICByZXR1cm4gbmV3IFJ1\nbnRpbWVFeGNlcHRpb25UcmFuc2xhdG9yKCkgewogICAgICAgICAgICBwcml2\nYXRlIGJvb2xlYW4gdGhyb3dpbmcgPSBmYWxzZTsKCiAgICAgICAgICAgIHB1\nYmxpYyBSdW50aW1lRXhjZXB0aW9uIHRyYW5zbGF0ZShSdW50aW1lRXhjZXB0\naW9uIHJlKSB7CiAgICAgICAgICAgICAgICBSdW50aW1lRXhjZXB0aW9uIGV4\nID0gdG9QZXJzaXN0ZW5jZUV4Y2VwdGlvbihyZSk7CiAgICAgICAgICAgICAg\nICBpZiAoIShleCBpbnN0YW5jZW9mIE5vblVuaXF1ZVJlc3VsdEV4Y2VwdGlv\nbikKICAgICAgICAgICAgICAgICAgICAmJiAhKGV4IGluc3RhbmNlb2YgTm9S\nZXN1bHRFeGNlcHRpb24pCiAgICAgICAgICAgICAgICAgICAgJiYgIXRocm93\naW5nKSB7CiAgICAgICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAg\nICAgICAgICAgICAgdGhyb3dpbmcgPSB0cnVlOwogICAgICAgICAgICAgICAg\nICAgICAgICBpZiAoZW0uaXNPcGVuKCkgJiYgKChFbnRpdHlNYW5hZ2VySW1w\nbCkgZW0pLmlzQWN0aXZlKCkpCiAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAoKEVudGl0eU1hbmFnZXJJbXBsKSBlbSkuc2V0Um9sbGJhY2tPbmx5KHJl\nKTsKICAgICAgICAgICAgICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAg\nICAgICAgICAgICAgICAvLyBoYW5kbGUgcmUtZW50cmFuY3kKICAgICAgICAg\nICAgICAgICAgICAgICAgdGhyb3dpbmcgPSBmYWxzZTsKICAgICAgICAgICAg\nICAgICAgICB9CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAg\ncmV0dXJuIGV4OwogICAgICAgICAgICB9CiAgICAgICAgfTsKICAgIH0KCiAg\nICAvKioKICAgICAqIENvbnZlcnQgdGhlIGdpdmVuIHRocm93YWJsZSB0byB0\naGUgcHJvcGVyIHBlcnNpc3RlbmNlIGV4Y2VwdGlvbi4KICAgICAqLwogICAg\ncHVibGljIHN0YXRpYyBSdW50aW1lRXhjZXB0aW9uIHRvUGVyc2lzdGVuY2VF\neGNlcHRpb24oVGhyb3dhYmxlIHQpIHsKICAgICAgICByZXR1cm4gKFJ1bnRp\nbWVFeGNlcHRpb24pIHRyYW5zbGF0ZUV4Y2VwdGlvbih0LCB0cnVlKTsKICAg\nIH0KCiAgICAvKioKICAgICAqIFRyYW5zbGF0ZSB0aGUgZ2l2ZW4gZXhjZXB0\naW9uLgogICAgICoKICAgICAqIEBwYXJhbSBjaGVja2VkIHdoZXRoZXIgdG8g\ndHJhbnNsYXRlIGNoZWNrZWQgZXhjZXB0aW9ucwogICAgICovCiAgICBwcml2\nYXRlIHN0YXRpYyBUaHJvd2FibGUgdHJhbnNsYXRlRXhjZXB0aW9uKFRocm93\nYWJsZSB0LCBib29sZWFuIGNoZWNrZWQpIHsKICAgICAgICBpZiAoaXNQZXJz\naXN0ZW5jZUV4Y2VwdGlvbih0KSkKICAgICAgICAgICAgcmV0dXJuIHQ7Cgog\nICAgICAgIC8vIGltbWVkaWF0ZWx5IHRocm93IGVycm9ycwogICAgICAgIGlm\nICh0IGluc3RhbmNlb2YgRXJyb3IpCiAgICAgICAgICAgIHRocm93IChFcnJv\ncikgdDsKCiAgICAgICAgT3BlbkpQQUV4Y2VwdGlvbiBrZTsKICAgICAgICBp\nZiAoISh0IGluc3RhbmNlb2YgT3BlbkpQQUV4Y2VwdGlvbikpIHsKICAgICAg\nICAgICAgaWYgKCFjaGVja2VkIHx8IHQgaW5zdGFuY2VvZiBSdW50aW1lRXhj\nZXB0aW9uKQogICAgICAgICAgICAgICAgcmV0dXJuIHQ7CiAgICAgICAgICAg\nIGtlID0gbmV3IG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLkdlbmVyYWxFeGNl\ncHRpb24odC5nZXRNZXNzYWdlKCkpOwogICAgICAgICAgICBrZS5zZXRTdGFj\na1RyYWNlKHQuZ2V0U3RhY2tUcmFjZSgpKTsKICAgICAgICAgICAgcmV0dXJu\nIGtlOwogICAgICAgIH0KCiAgICAgICAgLy8gaWYgb25seSBuZXN0ZWQgZXhj\nZXB0aW9uIGlzIGEgcGVyc2lzdGVuY2Ugb25lLCByZXR1cm4gaXQgZGlyZWN0\nbHkKICAgICAgICBrZSA9IChPcGVuSlBBRXhjZXB0aW9uKSB0OwogICAgICAg\nIGlmIChrZS5nZXROZXN0ZWRUaHJvd2FibGVzKCkubGVuZ3RoID09IDEKICAg\nICAgICAgICAgJiYgaXNQZXJzaXN0ZW5jZUV4Y2VwdGlvbihrZS5nZXRDYXVz\nZSgpKSkKICAgICAgICAgICAgcmV0dXJuIGtlLmdldENhdXNlKCk7CgogICAg\nICAgIC8vIFJ1bnRpbWVFeGNlcHRpb25zIHRocm93biBmcm9tIGNhbGxiYWNr\ncyBzaG91bGQgYmUgdGhyb3duIGRpcmVjdGx5CiAgICAgICAgaWYgKGtlLmdl\ndFR5cGUoKSA9PSBPcGVuSlBBRXhjZXB0aW9uLlVTRVIKICAgICAgICAgICAg\nJiYga2UuZ2V0U3VidHlwZSgpID09IFVzZXJFeGNlcHRpb24uQ0FMTEJBQ0sK\nICAgICAgICAgICAgJiYga2UuZ2V0TmVzdGVkVGhyb3dhYmxlcygpLmxlbmd0\naCA9PSAxKSB7CiAgICAgICAgICAgIFRocm93YWJsZSBlID0ga2UuZ2V0Q2F1\nc2UoKTsKICAgICAgICAgICAgaWYgKGUgaW5zdGFuY2VvZiBJbnZvY2F0aW9u\nVGFyZ2V0RXhjZXB0aW9uKQogICAgICAgICAgICAgICAgZSA9IGUuZ2V0Q2F1\nc2UoKTsKCiAgICAgICAgICAgIGlmIChlIGluc3RhbmNlb2YgUnVudGltZUV4\nY2VwdGlvbikKICAgICAgICAgICAgICAgIHJldHVybiBlOwogICAgICAgIH0K\nCiAgICAgICAgLy8gcGVyZm9ybSBpbnRlbGxpZ2VudCB0cmFuc2xhdGlvbiBv\nZiBvcGVuanBhIGV4Y2VwdGlvbnMKICAgICAgICBzd2l0Y2ggKGtlLmdldFR5\ncGUoKSkgewogICAgICAgICAgICBjYXNlIE9wZW5KUEFFeGNlcHRpb24uU1RP\nUkU6CiAgICAgICAgICAgICAgICByZXR1cm4gdHJhbnNsYXRlU3RvcmVFeGNl\ncHRpb24oa2UpOwogICAgICAgICAgICBjYXNlIE9wZW5KUEFFeGNlcHRpb24u\nVVNFUjoKICAgICAgICAgICAgICAgIHJldHVybiB0cmFuc2xhdGVVc2VyRXhj\nZXB0aW9uKGtlKTsKICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAg\nICAgIHJldHVybiB0cmFuc2xhdGVHZW5lcmFsRXhjZXB0aW9uKGtlKTsKICAg\nICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBUcmFuc2xhdGUgdGhlIGdp\ndmVuIHN0b3JlIGV4Y2VwdGlvbi4KICAgICAqLwogICAgcHJpdmF0ZSBzdGF0\naWMgVGhyb3dhYmxlIHRyYW5zbGF0ZVN0b3JlRXhjZXB0aW9uKE9wZW5KUEFF\neGNlcHRpb24ga2UpIHsKICAgICAgICBFeGNlcHRpb24gZTsKICAgICAgICBU\naHJvd2FibGUgY2F1c2UgPSAoa2UuZ2V0TmVzdGVkVGhyb3dhYmxlcygpICE9\nIG51bGwgCiAgICAgICAgICAgICAgICAgICAgICAgICYmIGtlLmdldE5lc3Rl\nZFRocm93YWJsZXMoKS5sZW5ndGggPT0gMSkKICAgICAgICAgICAgICAgICAg\nICAgICAgID8ga2UuZ2V0TmVzdGVkVGhyb3dhYmxlcygpWzBdIDogbnVsbDsK\nICAgICAgICBpZiAoa2UuZ2V0U3VidHlwZSgpID09IFN0b3JlRXhjZXB0aW9u\nLk9CSkVDVF9OT1RfRk9VTkQgCiAgICAgICAgIHx8IGNhdXNlIGluc3RhbmNl\nb2YgT2JqZWN0Tm90Rm91bmRFeGNlcHRpb24pIHsKICAgICAgICAgICAgICAg\nIGUgPSBuZXcgb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNpc3RlbmNlLkVudGl0\neU5vdEZvdW5kRXhjZXB0aW9uCiAgICAgICAgICAgICAgICAgICAgKGtlLmdl\ndE1lc3NhZ2UoKSwgZ2V0TmVzdGVkVGhyb3dhYmxlcyhrZSksCiAgICAgICAg\nICAgICAgICAgICAgICAgIGdldEZhaWxlZE9iamVjdChrZSksIGtlLmlzRmF0\nYWwoKSk7CiAgICAgICAgfSBlbHNlIGlmIChrZS5nZXRTdWJ0eXBlKCkgPT0g\nU3RvcmVFeGNlcHRpb24uT1BUSU1JU1RJQyAKICAgICAgICAJCXx8IGtlLmdl\ndFN1YnR5cGUoKSA9PSBTdG9yZUV4Y2VwdGlvbi5MT0NLCiAgICAgICAgCQl8\nfCBjYXVzZSBpbnN0YW5jZW9mIE9wdGltaXN0aWNFeGNlcHRpb24pIHsKICAg\nICAgICAgICAgCWUgPSBuZXcgb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNpc3Rl\nbmNlLk9wdGltaXN0aWNMb2NrRXhjZXB0aW9uCiAgICAgICAgICAgICAgICAg\nICAgKGtlLmdldE1lc3NhZ2UoKSwgZ2V0TmVzdGVkVGhyb3dhYmxlcyhrZSks\nCiAgICAgICAgICAgICAgICAgICAgICAgIGdldEZhaWxlZE9iamVjdChrZSks\nIGtlLmlzRmF0YWwoKSk7CiAgICAgICAgfSBlbHNlIGlmIChrZS5nZXRTdWJ0\neXBlKCkgPT0gU3RvcmVFeGNlcHRpb24uT0JKRUNUX0VYSVNUUwogICAgICAg\nIAkJfHwgY2F1c2UgaW5zdGFuY2VvZiBPYmplY3RFeGlzdHNFeGNlcHRpb24p\nIHsKICAgICAgICAgICAgICAgIGUgPSBuZXcgb3JnLmFwYWNoZS5vcGVuanBh\nLnBlcnNpc3RlbmNlLkVudGl0eUV4aXN0c0V4Y2VwdGlvbgogICAgICAgICAg\nICAgICAgICAgIChrZS5nZXRNZXNzYWdlKCksIGdldE5lc3RlZFRocm93YWJs\nZXMoa2UpLAogICAgICAgICAgICAgICAgICAgICAgICBnZXRGYWlsZWRPYmpl\nY3Qoa2UpLCBrZS5pc0ZhdGFsKCkpOwogICAgICAgIH0gZWxzZSB7CiAgICAg\nICAgICAgICAgICBlID0gbmV3IG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0\nZW5jZS5QZXJzaXN0ZW5jZUV4Y2VwdGlvbgogICAgICAgICAgICAgICAgICAg\nIChrZS5nZXRNZXNzYWdlKCksIGdldE5lc3RlZFRocm93YWJsZXMoa2UpLAog\nICAgICAgICAgICAgICAgICAgICAgICBnZXRGYWlsZWRPYmplY3Qoa2UpLCBr\nZS5pc0ZhdGFsKCkpOwogICAgICAgIH0KICAgICAgICBlLnNldFN0YWNrVHJh\nY2Uoa2UuZ2V0U3RhY2tUcmFjZSgpKTsKICAgICAgICByZXR1cm4gZTsKICAg\nIH0KCiAgICAvKioKICAgICAqIFRyYW5zbGF0ZSB0aGUgZ2l2ZW4gdXNlciBl\neGNlcHRpb24uCiAgICAgKiBJZiBhIHtsaW5rIHtAbGluayBPcGVuSlBBRXhj\nZXB0aW9uI2dldFN1YnR5cGUoKSBzdWIgdHlwZX0gaXMgc2V0IG9uIHRoZSAK\nICAgICAqIGdpdmVuIGV4Y2VwdGlvbiB0aGVuIGEgY29ycmVzcG9uZGluZyBm\nYWNhZGUtbGV2ZWwgZXhjZXB0aW9uIGkuZS4gdGhlCiAgICAgKiBleGNlcHRp\nb25zIHRoYXQgaW5oZXJpdCBKUEEtZGVmaW5lZCBleGNlcHRpb25zIGlzIGdl\nbmVyYXRlZC4KICAgICAqIElmIGdpdmVuIGV4Y2VwdGlvbiBpcyBub3QgZnVy\ndGhlciBjbGFzc2lmaWVkIHRvIGEgc3ViIHR5cGUsIHRoZW4gCiAgICAgKiBh\nbiBbQGxpbmsge0BsaW5rICN0cmFuc2xhdGVJbnRlcm5hbEV4Y2VwdGlvbihP\ncGVuSlBBRXhjZXB0aW9uKX0gYXR0ZW1wdH0KICAgICAqIGlzIG1hZGUgdG8g\ndHJhbnNsYXRlIHRoZSBnaXZlbiBPcGVuSlBBRXhjZXB0aW9uIGJ5IGl0cyBp\nbnRlcm5hbCBjYXVzZS4KICAgICAqLwogICAgcHJpdmF0ZSBzdGF0aWMgRXhj\nZXB0aW9uIHRyYW5zbGF0ZVVzZXJFeGNlcHRpb24oT3BlbkpQQUV4Y2VwdGlv\nbiBrZSkgewogICAgICAgIEV4Y2VwdGlvbiBlOwogICAgICAgIHN3aXRjaCAo\na2UuZ2V0U3VidHlwZSgpKSB7CiAgICAgICAgICAgIGNhc2UgVXNlckV4Y2Vw\ndGlvbi5OT19UUkFOU0FDVElPTjoKICAgICAgICAgICAgICAgIGUgPSBuZXcg\nCiAgICAgICAgICAgICAgICAgICAgb3JnLmFwYWNoZS5vcGVuanBhLnBlcnNp\nc3RlbmNlLlRyYW5zYWN0aW9uUmVxdWlyZWRFeGNlcHRpb24KICAgICAgICAg\nICAgICAgICAgICAgICAgKGtlLmdldE1lc3NhZ2UoKSwgZ2V0TmVzdGVkVGhy\nb3dhYmxlcyhrZSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnZXRG\nYWlsZWRPYmplY3Qoa2UpLCBrZS5pc0ZhdGFsKCkpOwogICAgICAgICAgICAg\nICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgVXNlckV4Y2VwdGlvbi5OT19S\nRVNVTFQ6CiAgICAgICAgICAgICAgICBlID0gbmV3IG9yZy5hcGFjaGUub3Bl\nbmpwYS5wZXJzaXN0ZW5jZS5Ob1Jlc3VsdEV4Y2VwdGlvbgogICAgICAgICAg\nICAgICAgICAgIChrZS5nZXRNZXNzYWdlKCksIGdldE5lc3RlZFRocm93YWJs\nZXMoa2UpLAogICAgICAgICAgICAgICAgICAgICAgICBnZXRGYWlsZWRPYmpl\nY3Qoa2UpLCBrZS5pc0ZhdGFsKCkpOwogICAgICAgICAgICAgICAgYnJlYWs7\nCiAgICAgICAgICAgIGNhc2UgVXNlckV4Y2VwdGlvbi5OT05fVU5JUVVFX1JF\nU1VMVDoKICAgICAgICAgICAgICAgIGUgPSBuZXcgb3JnLmFwYWNoZS5vcGVu\nanBhLnBlcnNpc3RlbmNlLk5vblVuaXF1ZVJlc3VsdEV4Y2VwdGlvbgogICAg\nICAgICAgICAgICAgICAgIChrZS5nZXRNZXNzYWdlKCksIGdldE5lc3RlZFRo\ncm93YWJsZXMoa2UpLAogICAgICAgICAgICAgICAgICAgICAgICBnZXRGYWls\nZWRPYmplY3Qoa2UpLCBrZS5pc0ZhdGFsKCkpOwogICAgICAgICAgICAgICAg\nYnJlYWs7CiAgICAgICAgICAgIGNhc2UgVXNlckV4Y2VwdGlvbi5JTlZBTElE\nX1NUQVRFOgogICAgICAgICAgICAgICAgZSA9IG5ldyBvcmcuYXBhY2hlLm9w\nZW5qcGEucGVyc2lzdGVuY2UuSW52YWxpZFN0YXRlRXhjZXB0aW9uCiAgICAg\nICAgICAgICAgICAgICAgKGtlLmdldE1lc3NhZ2UoKSwgZ2V0TmVzdGVkVGhy\nb3dhYmxlcyhrZSksCiAgICAgICAgICAgICAgICAgICAgICAgIGdldEZhaWxl\nZE9iamVjdChrZSksIGtlLmlzRmF0YWwoKSk7CiAgICAgICAgICAgICAgICBi\ncmVhazsKICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgCWUgPSB0\ncmFuc2xhdGVDYXVzZShrZSk7CiAgICAgICAgfQogICAgICAgIGUuc2V0U3Rh\nY2tUcmFjZShrZS5nZXRTdGFja1RyYWNlKCkpOwogICAgICAgIHJldHVybiBl\nOwogICAgfQogICAgCiAgICAvKioKICAgICAqIFRyYW5zbGF0ZSB0byBhIGZh\nY2FkZS1sZXZlbCBleGNlcHRpb24gaWYgdGhlIGdpdmVuIGV4Y2VwdGlvbiAK\nICAgICAqICAgICBhKSBoYXMgYSBjYXVzZSBpLmUuIG9uZSBhbmQgb25seSBu\nZXN0ZWQgVGhyb3dhYmxlIAogICAgICogYW5kIGIpIHRoYXQgY2F1c2UgaXMg\nb25lIG9mIHRoZSBrbm93biBpbnRlcm5hbCBleGNlcHRpb24gd2hpY2ggaGFz\nIGEgCiAgICAgKiAgICAgICAgZGlyZWN0IGZhY2FkZS1sZXZlbCBjb3VudGVy\ncGFydCAKICAgICAqICAgICAgICAoZm9yIGV4YW1wbGUsIE9iamVjdE5vdEZv\ndW5kRXhjZXB0aW9uIGNhbiBiZSB0cmFuc2xhdGVkIHRvIAogICAgICogICAg\nICAgICBFbnRpdHlOb3RGb3VuZEV4Y2VwdGlvbikuIAogICAgICogSWYgdGhl\nIGFib3ZlIGNvbmRpdGlvbnMgYXJlIG5vdCBtZXQgdGhlbiByZXR1cm4gZ2Vu\nZXJpYyBBcmd1bWVudEV4Y2VwdGlvbi4KICAgICAqIAogICAgICogSW4gZWl0\naGVyIGNhc2UsIHByZXNlcnZlIGFsbCB0aGUgZGV0YWlscy4KICAgICAqLwog\nICAgcHJpdmF0ZSBzdGF0aWMgRXhjZXB0aW9uIHRyYW5zbGF0ZUNhdXNlKE9w\nZW5KUEFFeGNlcHRpb24ga2UpIHsKICAgIAlUaHJvd2FibGUgY2F1c2UgPSBr\nZS5nZXRDYXVzZSgpOwogICAgCWlmIChjYXVzZSBpbnN0YW5jZW9mIE9iamVj\ndE5vdEZvdW5kRXhjZXB0aW9uKSB7CiAgICAJCXJldHVybiBuZXcgRW50aXR5\nTm90Rm91bmRFeGNlcHRpb24oCiAgICAJCSAgICAgICAga2UuZ2V0TWVzc2Fn\nZSgpLCBnZXROZXN0ZWRUaHJvd2FibGVzKGtlKSwKICAgICAgICAgICAgCSAg\nICBnZXRGYWlsZWRPYmplY3Qoa2UpLCBrZS5pc0ZhdGFsKCkpOwogICAgCX0g\nZWxzZSBpZiAoY2F1c2UgaW5zdGFuY2VvZiBPYmplY3RFeGlzdHNFeGNlcHRp\nb24pIHsKICAgIAkJcmV0dXJuIG5ldyBFbnRpdHlFeGlzdHNFeGNlcHRpb24o\nCiAgICAJCSAgICAgICAga2UuZ2V0TWVzc2FnZSgpLCBnZXROZXN0ZWRUaHJv\nd2FibGVzKGtlKSwKICAgICAgICAgICAgCSAgICBnZXRGYWlsZWRPYmplY3Qo\na2UpLCBrZS5pc0ZhdGFsKCkpOwogICAgCX0gZWxzZSBpZiAoY2F1c2UgaW5z\ndGFuY2VvZiBOb1RyYW5zYWN0aW9uRXhjZXB0aW9uKSB7CiAgICAJCXJldHVy\nbiBuZXcgVHJhbnNhY3Rpb25SZXF1aXJlZEV4Y2VwdGlvbigKICAgICAgICAJ\nCSAgICBrZS5nZXRNZXNzYWdlKCksIGdldE5lc3RlZFRocm93YWJsZXMoa2Up\nLAogICAgICAgICAgICAgICAgCWdldEZhaWxlZE9iamVjdChrZSksIGtlLmlz\nRmF0YWwoKSk7CiAgICAJfSBlbHNlIGlmIChjYXVzZSBpbnN0YW5jZW9mIE9w\ndGltaXN0aWNFeGNlcHRpb24pIHsKICAgIAkJcmV0dXJuIG5ldyBPcHRpbWlz\ndGljTG9ja0V4Y2VwdGlvbigKICAgICAgICAJCSAgICBrZS5nZXRNZXNzYWdl\nKCksIGdldE5lc3RlZFRocm93YWJsZXMoa2UpLAogICAgICAgICAgICAgICAg\nCWdldEZhaWxlZE9iamVjdChrZSksIGtlLmlzRmF0YWwoKSk7CiAgICAJfSBl\nbHNlIHsKICAgIAkJcmV0dXJuIG5ldyBvcmcuYXBhY2hlLm9wZW5qcGEucGVy\nc2lzdGVuY2UuQXJndW1lbnRFeGNlcHRpb24oCiAgICAgICAgCQlrZS5nZXRN\nZXNzYWdlKCksIGdldE5lc3RlZFRocm93YWJsZXMoa2UpLAogICAgICAgIAkJ\nZ2V0RmFpbGVkT2JqZWN0KGtlKSwga2UuaXNGYXRhbCgpKTsKICAgIAl9CiAg\nICB9CgogICAgLyoqCiAgICAgKiBUcmFuc2xhdGUgdGhlIGdpdmVuIGdlbmVy\nYWwgZXhjZXB0aW9uLgogICAgICovCiAgICBwcml2YXRlIHN0YXRpYyBUaHJv\nd2FibGUgdHJhbnNsYXRlR2VuZXJhbEV4Y2VwdGlvbihPcGVuSlBBRXhjZXB0\naW9uIGtlKSB7CiAgICAgICAgRXhjZXB0aW9uIGUgPSBuZXcgb3JnLmFwYWNo\nZS5vcGVuanBhLnBlcnNpc3RlbmNlLlBlcnNpc3RlbmNlRXhjZXB0aW9uCiAg\nICAgICAgICAgIChrZS5nZXRNZXNzYWdlKCksIGdldE5lc3RlZFRocm93YWJs\nZXMoa2UpLAogICAgICAgICAgICAgICAgZ2V0RmFpbGVkT2JqZWN0KGtlKSwg\na2UuaXNGYXRhbCgpKTsKICAgICAgICBlLnNldFN0YWNrVHJhY2Uoa2UuZ2V0\nU3RhY2tUcmFjZSgpKTsKICAgICAgICByZXR1cm4gZTsKICAgIH0KCiAgICAv\nKioKICAgICAqIFJldHVybiB0cnVlIGlmIHRoZSBnaXZlbiBleGNlcHRpb24g\naXMgYSBwZXJzaXN0ZW5jZSBleGNlcHRpb24uCiAgICAgKi8KICAgIHByaXZh\ndGUgc3RhdGljIGJvb2xlYW4gaXNQZXJzaXN0ZW5jZUV4Y2VwdGlvbihUaHJv\nd2FibGUgdCkgewogICAgICAgIHJldHVybiB0LmdldENsYXNzKCkuZ2V0TmFt\nZSgpCiAgICAgICAgICAgIC5zdGFydHNXaXRoKCJvcmcuYXBhY2hlLm9wZW5q\ncGEucGVyc2lzdGVuY2UuIik7CiAgICB9CgogICAgLyoqCiAgICAgKiBUcmFu\nc2xhdGUgdGhlIG5lc3RlZCB0aHJvd2FibGVzIG9mIHRoZSBnaXZlbiBvcGVu\nanBhIGV4Y2VwdGlvbiBpbnRvCiAgICAgKiBuZXN0ZWQgdGhyb3dhYmxlcyBm\nb3IgYSBwZXJzaXN0ZW5jZSBleGNlcHRpb24uCiAgICAgKi8KICAgIHByaXZh\ndGUgc3RhdGljIFRocm93YWJsZVtdIGdldE5lc3RlZFRocm93YWJsZXMoT3Bl\nbkpQQUV4Y2VwdGlvbiBrZSkgewogICAgICAgIFRocm93YWJsZVtdIG5lc3Rl\nZCA9IGtlLmdldE5lc3RlZFRocm93YWJsZXMoKTsKICAgICAgICBpZiAobmVz\ndGVkLmxlbmd0aCA9PSAwKQogICAgICAgICAgICByZXR1cm4gbmVzdGVkOwoK\nICAgICAgICBUaHJvd2FibGVbXSB0cmFucyA9IG5ldyBUaHJvd2FibGVbbmVz\ndGVkLmxlbmd0aF07CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBuZXN0\nZWQubGVuZ3RoOyBpKyspCiAgICAgICAgICAgIHRyYW5zW2ldID0gdHJhbnNs\nYXRlRXhjZXB0aW9uKG5lc3RlZFtpXSwgZmFsc2UpOwogICAgICAgIHJldHVy\nbiB0cmFuczsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgZmFp\nbGVkIG9iamVjdCBmb3IgdGhlIGdpdmVuIGV4Y2VwdGlvbiwgcGVyZm9ybWlu\nZyBhbnkKICAgICAqIG5lY2Vzc2FyeSBjb252ZXJzaW9ucy4KICAgICAqLwog\nICAgcHJpdmF0ZSBzdGF0aWMgT2JqZWN0IGdldEZhaWxlZE9iamVjdChPcGVu\nSlBBRXhjZXB0aW9uIGtlKSB7CiAgICAgICAgT2JqZWN0IG8gPSBrZS5nZXRG\nYWlsZWRPYmplY3QoKTsKICAgICAgICBpZiAobyA9PSBudWxsKQogICAgICAg\nICAgICByZXR1cm4gbnVsbDsKICAgICAgICBpZiAobyBpbnN0YW5jZW9mIEJy\nb2tlcikKICAgICAgICAgICAgcmV0dXJuIEpQQUZhY2FkZUhlbHBlci50b0Vu\ndGl0eU1hbmFnZXIoKEJyb2tlcikgbyk7CiAgICAgICAgcmV0dXJuIEpQQUZh\nY2FkZUhlbHBlci5mcm9tT3BlbkpQQU9iamVjdElkKG8pOwogICAgfQoKICAg\nIC8qKgogICAgICogSGVscGVyIG1ldGhvZCB0byBleHRyYWN0IGEgbmVzdGVk\nIGV4Y2VwdGlvbiBmcm9tIGFuIGludGVybmFsIG5lc3RlZAogICAgICogYXJy\nYXkgaW4gYSBzYWZlIHdheS4KICAgICAqLwogICAgc3RhdGljIFRocm93YWJs\nZSBnZXRDYXVzZShUaHJvd2FibGVbXSBuZXN0ZWQpIHsKICAgICAgICBpZiAo\nbmVzdGVkID09IG51bGwgfHwgbmVzdGVkLmxlbmd0aCA9PSAwKQogICAgICAg\nICAgICByZXR1cm4gbnVsbDsKCQlyZXR1cm4gbmVzdGVkWzBdOwoJfQp9Cg==\n","encoding":"base64"}

