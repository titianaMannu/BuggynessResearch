{"sha":"dd3030ecf1c2b2e1fecba2a588860645e48ae7c4","node_id":"MDQ6QmxvYjIwNjM2NDpkZDMwMzBlY2YxYzJiMmUxZmVjYmEyYTU4ODg2MDY0NWU0OGFlN2M0","size":64257,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/dd3030ecf1c2b2e1fecba2a588860645e48ae7c4","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuamRiYzsK\nCmltcG9ydCBqYXZhLmxhbmcuYW5ub3RhdGlvbi5Bbm5vdGF0aW9uOwppbXBv\ncnQgamF2YS5sYW5nLnJlZmxlY3QuQW5ub3RhdGVkRWxlbWVudDsKaW1wb3J0\nIGphdmEubGFuZy5yZWZsZWN0Lk1vZGlmaWVyOwppbXBvcnQgamF2YS5zZWN1\ncml0eS5BY2Nlc3NDb250cm9sbGVyOwppbXBvcnQgamF2YS5zcWwuVHlwZXM7\nCmltcG9ydCBqYXZhLnV0aWwuQXJyYXlMaXN0OwppbXBvcnQgamF2YS51dGls\nLkFycmF5czsKaW1wb3J0IGphdmEudXRpbC5IYXNoTWFwOwppbXBvcnQgamF2\nYS51dGlsLkxpc3Q7CmltcG9ydCBqYXZhLnV0aWwuTWFwOwppbXBvcnQgamF2\nYXgucGVyc2lzdGVuY2UuQXNzb2NpYXRpb25PdmVycmlkZTsKaW1wb3J0IGph\ndmF4LnBlcnNpc3RlbmNlLkFzc29jaWF0aW9uT3ZlcnJpZGVzOwppbXBvcnQg\namF2YXgucGVyc2lzdGVuY2UuQXR0cmlidXRlT3ZlcnJpZGU7CmltcG9ydCBq\nYXZheC5wZXJzaXN0ZW5jZS5BdHRyaWJ1dGVPdmVycmlkZXM7CmltcG9ydCBq\nYXZheC5wZXJzaXN0ZW5jZS5Db2x1bW5SZXN1bHQ7CmltcG9ydCBqYXZheC5w\nZXJzaXN0ZW5jZS5EaXNjcmltaW5hdG9yQ29sdW1uOwppbXBvcnQgamF2YXgu\ncGVyc2lzdGVuY2UuRGlzY3JpbWluYXRvclZhbHVlOwppbXBvcnQgamF2YXgu\ncGVyc2lzdGVuY2UuRW50aXR5UmVzdWx0OwppbXBvcnQgamF2YXgucGVyc2lz\ndGVuY2UuRW51bVR5cGU7CmltcG9ydCBqYXZheC5wZXJzaXN0ZW5jZS5FbnVt\nZXJhdGVkOwppbXBvcnQgamF2YXgucGVyc2lzdGVuY2UuRmllbGRSZXN1bHQ7\nCmltcG9ydCBqYXZheC5wZXJzaXN0ZW5jZS5Jbmhlcml0YW5jZTsKaW1wb3J0\nIGphdmF4LnBlcnNpc3RlbmNlLkpvaW5Db2x1bW47CmltcG9ydCBqYXZheC5w\nZXJzaXN0ZW5jZS5Kb2luQ29sdW1uczsKaW1wb3J0IGphdmF4LnBlcnNpc3Rl\nbmNlLkpvaW5UYWJsZTsKaW1wb3J0IGphdmF4LnBlcnNpc3RlbmNlLlByaW1h\ncnlLZXlKb2luQ29sdW1uOwppbXBvcnQgamF2YXgucGVyc2lzdGVuY2UuUHJp\nbWFyeUtleUpvaW5Db2x1bW5zOwppbXBvcnQgamF2YXgucGVyc2lzdGVuY2Uu\nU2Vjb25kYXJ5VGFibGU7CmltcG9ydCBqYXZheC5wZXJzaXN0ZW5jZS5TZWNv\nbmRhcnlUYWJsZXM7CmltcG9ydCBqYXZheC5wZXJzaXN0ZW5jZS5TcWxSZXN1\nbHRTZXRNYXBwaW5nOwppbXBvcnQgamF2YXgucGVyc2lzdGVuY2UuU3FsUmVz\ndWx0U2V0TWFwcGluZ3M7CmltcG9ydCBqYXZheC5wZXJzaXN0ZW5jZS5UYWJs\nZTsKaW1wb3J0IGphdmF4LnBlcnNpc3RlbmNlLlRhYmxlR2VuZXJhdG9yOwpp\nbXBvcnQgamF2YXgucGVyc2lzdGVuY2UuVGVtcG9yYWw7CmltcG9ydCBqYXZh\neC5wZXJzaXN0ZW5jZS5VbmlxdWVDb25zdHJhaW50OwoKaW1wb3J0IG9yZy5h\ncGFjaGUuY29tbW9ucy5sYW5nLlN0cmluZ1V0aWxzOwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLmpkYmMuY29uZi5KREJDQ29uZmlndXJhdGlvbjsKaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLmtlcm5lbC5FYWdlckZldGNo\nTW9kZXM7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhLkNs\nYXNzTWFwcGluZzsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLm1l\ndGEuQ2xhc3NNYXBwaW5nSW5mbzsKaW1wb3J0IG9yZy5hcGFjaGUub3Blbmpw\nYS5qZGJjLm1ldGEuRGlzY3JpbWluYXRvcjsKaW1wb3J0IG9yZy5hcGFjaGUu\nb3BlbmpwYS5qZGJjLm1ldGEuRmllbGRNYXBwaW5nOwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLmpkYmMubWV0YS5GaWVsZE1hcHBpbmdJbmZvOwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0YS5NYXBwaW5nSW5mbzsK\naW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLm1ldGEuTWFwcGluZ1Jl\ncG9zaXRvcnk7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRh\nLlF1ZXJ5UmVzdWx0TWFwcGluZzsKaW1wb3J0IG9yZy5hcGFjaGUub3Blbmpw\nYS5qZGJjLm1ldGEuU2VxdWVuY2VNYXBwaW5nOwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLmpkYmMubWV0YS5WYWx1ZU1hcHBpbmc7CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhLlZhbHVlTWFwcGluZ0luZm87Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhLnN0cmF0cy5FbnVt\nVmFsdWVIYW5kbGVyOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMu\nbWV0YS5zdHJhdHMuRmxhdENsYXNzU3RyYXRlZ3k7CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEuamRiYy5tZXRhLnN0cmF0cy5GdWxsQ2xhc3NTdHJhdGVn\neTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLm1ldGEuc3RyYXRz\nLlZlcnRpY2FsQ2xhc3NTdHJhdGVneTsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5qZGJjLnNjaGVtYS5Db2x1bW47CmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEuamRiYy5zY2hlbWEuVW5pcXVlOwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLmpkYmMuc3FsLkRCRGljdGlvbmFyeTsKaW1wb3J0IG9yZy5hcGFj\naGUub3BlbmpwYS5saWIubG9nLkxvZzsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5saWIudXRpbC5KMkRvUHJpdjVIZWxwZXI7CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEubGliLnV0aWwuTG9jYWxpemVyOwppbXBvcnQgb3JnLmFw\nYWNoZS5vcGVuanBhLm1ldGEuQ2xhc3NNZXRhRGF0YTsKaW1wb3J0IG9yZy5h\ncGFjaGUub3BlbmpwYS5tZXRhLkZpZWxkTWV0YURhdGE7CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEubWV0YS5KYXZhVHlwZXM7CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEubWV0YS5NZXRhRGF0YUNvbnRleHQ7CmltcG9ydCBvcmcu\nYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuQW5ub3RhdGlvblBlcnNpc3Rl\nbmNlTWV0YURhdGFQYXJzZXI7CmltcG9ydCBzdGF0aWMgb3JnLmFwYWNoZS5v\ncGVuanBhLnBlcnNpc3RlbmNlLmpkYmMuTWFwcGluZ1RhZy4qOwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuSW50ZXJuYWxFeGNlcHRpb247Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5NZXRhRGF0YUV4Y2VwdGlv\nbjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS51dGlsLlVuc3VwcG9ydGVk\nRXhjZXB0aW9uOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLnV0aWwuVXNl\nckV4Y2VwdGlvbjsKCi8qKgogKiBQZXJzaXN0ZW5jZSBhbm5vdGF0aW9uIG1h\ncHBpbmcgcGFyc2VyLgogKgogKiBAYXV0aG9yIFBpbmFraSBQb2RkYXIKICog\nQGF1dGhvciBTdGV2ZSBLaW0KICogQGF1dGhvciBBYmUgV2hpdGUKICogQG5v\namF2YWRvYwogKi8KcHVibGljIGNsYXNzIEFubm90YXRpb25QZXJzaXN0ZW5j\nZU1hcHBpbmdQYXJzZXIKICAgIGV4dGVuZHMgQW5ub3RhdGlvblBlcnNpc3Rl\nbmNlTWV0YURhdGFQYXJzZXIgewoKICAgIHByb3RlY3RlZCBzdGF0aWMgZmlu\nYWwgaW50IFRSVUUgPSAxOwogICAgcHJvdGVjdGVkIHN0YXRpYyBmaW5hbCBp\nbnQgRkFMU0UgPSAyOwoKICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIExvY2Fs\naXplciBfbG9jID0gTG9jYWxpemVyLmZvclBhY2thZ2UKICAgICAgICAoQW5u\nb3RhdGlvblBlcnNpc3RlbmNlTWFwcGluZ1BhcnNlci5jbGFzcyk7CgogICAg\ncHJpdmF0ZSBzdGF0aWMgZmluYWwgTWFwPENsYXNzLCBNYXBwaW5nVGFnPiBf\ndGFncyA9CiAgICAgICAgbmV3IEhhc2hNYXA8Q2xhc3MsIE1hcHBpbmdUYWc+\nKCk7CgogICAgc3RhdGljIHsKICAgICAgICBfdGFncy5wdXQoQXNzb2NpYXRp\nb25PdmVycmlkZS5jbGFzcywgQVNTT0NfT1ZFUlJJREUpOwogICAgICAgIF90\nYWdzLnB1dChBc3NvY2lhdGlvbk92ZXJyaWRlcy5jbGFzcywgQVNTT0NfT1ZF\nUlJJREVTKTsKICAgICAgICBfdGFncy5wdXQoQXR0cmlidXRlT3ZlcnJpZGUu\nY2xhc3MsIEFUVFJfT1ZFUlJJREUpOwogICAgICAgIF90YWdzLnB1dChBdHRy\naWJ1dGVPdmVycmlkZXMuY2xhc3MsIEFUVFJfT1ZFUlJJREVTKTsKICAgICAg\nICBfdGFncy5wdXQoamF2YXgucGVyc2lzdGVuY2UuQ29sdW1uLmNsYXNzLCBD\nT0wpOwogICAgICAgIF90YWdzLnB1dChDb2x1bW5SZXN1bHQuY2xhc3MsIENP\nTFVNTl9SRVNVTFQpOwogICAgICAgIF90YWdzLnB1dChEaXNjcmltaW5hdG9y\nQ29sdW1uLmNsYXNzLCBESVNDUklNX0NPTCk7CiAgICAgICAgX3RhZ3MucHV0\nKERpc2NyaW1pbmF0b3JWYWx1ZS5jbGFzcywgRElTQ1JJTV9WQUwpOwogICAg\nICAgIF90YWdzLnB1dChFbGVtZW50Q29sdW1uLmNsYXNzLCBFTEVNX0NPTCk7\nCiAgICAgICAgX3RhZ3MucHV0KEVsZW1lbnRDb2x1bW5zLmNsYXNzLCBFTEVN\nX0NPTFMpOwogICAgICAgIF90YWdzLnB1dChFbGVtZW50RW1iZWRkZWRNYXBw\naW5nLmNsYXNzLCBFTEVNX0VNQkVEREVEX01BUFBJTkcpOwogICAgICAgIF90\nYWdzLnB1dChFbGVtZW50U3RyYXRlZ3kuY2xhc3MsIEVMRU1fU1RSQVQpOwog\nICAgICAgIF90YWdzLnB1dChFbnRpdHlSZXN1bHQuY2xhc3MsIEVOVElUWV9S\nRVNVTFQpOwogICAgICAgIF90YWdzLnB1dChFbnVtZXJhdGVkLmNsYXNzLCBF\nTlVNRVJBVEVEKTsKICAgICAgICBfdGFncy5wdXQoRmllbGRSZXN1bHQuY2xh\nc3MsIEZJRUxEX1JFU1VMVCk7CiAgICAgICAgX3RhZ3MucHV0KEluaGVyaXRh\nbmNlLmNsYXNzLCBJTkhFUklUQU5DRSk7CiAgICAgICAgX3RhZ3MucHV0KEpv\naW5Db2x1bW4uY2xhc3MsIEpPSU5fQ09MKTsKICAgICAgICBfdGFncy5wdXQo\nSm9pbkNvbHVtbnMuY2xhc3MsIEpPSU5fQ09MUyk7CiAgICAgICAgX3RhZ3Mu\ncHV0KEpvaW5UYWJsZS5jbGFzcywgSk9JTl9UQUJMRSk7CiAgICAgICAgX3Rh\nZ3MucHV0KEtleUNvbHVtbi5jbGFzcywgS0VZX0NPTCk7CiAgICAgICAgX3Rh\nZ3MucHV0KEtleUNvbHVtbnMuY2xhc3MsIEtFWV9DT0xTKTsKICAgICAgICBf\ndGFncy5wdXQoS2V5Q2xhc3NDcml0ZXJpYS5jbGFzcywgS0VZX0NMQVNTX0NS\nSVQpOwogICAgICAgIF90YWdzLnB1dChLZXlFbWJlZGRlZE1hcHBpbmcuY2xh\nc3MsIEtFWV9FTUJFRERFRF9NQVBQSU5HKTsKICAgICAgICBfdGFncy5wdXQo\nS2V5Rm9yZWlnbktleS5jbGFzcywgS0VZX0ZLKTsKICAgICAgICBfdGFncy5w\ndXQoS2V5SW5kZXguY2xhc3MsIEtFWV9JTkRFWCk7CiAgICAgICAgX3RhZ3Mu\ncHV0KEtleUpvaW5Db2x1bW4uY2xhc3MsIEtFWV9KT0lOX0NPTCk7CiAgICAg\nICAgX3RhZ3MucHV0KEtleUpvaW5Db2x1bW5zLmNsYXNzLCBLRVlfSk9JTl9D\nT0xTKTsKICAgICAgICBfdGFncy5wdXQoS2V5Tm9ucG9seW1vcnBoaWMuY2xh\nc3MsIEtFWV9OT05QT0xZKTsKICAgICAgICBfdGFncy5wdXQoS2V5U3RyYXRl\nZ3kuY2xhc3MsIEtFWV9TVFJBVCk7CiAgICAgICAgX3RhZ3MucHV0KFByaW1h\ncnlLZXlKb2luQ29sdW1uLmNsYXNzLCBQS19KT0lOX0NPTCk7CiAgICAgICAg\nX3RhZ3MucHV0KFByaW1hcnlLZXlKb2luQ29sdW1ucy5jbGFzcywgUEtfSk9J\nTl9DT0xTKTsKICAgICAgICBfdGFncy5wdXQoU2Vjb25kYXJ5VGFibGUuY2xh\nc3MsIFNFQ09OREFSWV9UQUJMRSk7CiAgICAgICAgX3RhZ3MucHV0KFNlY29u\nZGFyeVRhYmxlcy5jbGFzcywgU0VDT05EQVJZX1RBQkxFUyk7CiAgICAgICAg\nX3RhZ3MucHV0KFNxbFJlc3VsdFNldE1hcHBpbmcuY2xhc3MsIFNRTF9SRVNV\nTFRfU0VUX01BUFBJTkcpOwogICAgICAgIF90YWdzLnB1dChTcWxSZXN1bHRT\nZXRNYXBwaW5ncy5jbGFzcywgU1FMX1JFU1VMVF9TRVRfTUFQUElOR1MpOwog\nICAgICAgIF90YWdzLnB1dChUYWJsZS5jbGFzcywgVEFCTEUpOwogICAgICAg\nIF90YWdzLnB1dChUZW1wb3JhbC5jbGFzcywgVEVNUE9SQUwpOwogICAgICAg\nIF90YWdzLnB1dChUYWJsZUdlbmVyYXRvci5jbGFzcywgVEFCTEVfR0VOKTsK\nICAgICAgICBfdGFncy5wdXQoQ2xhc3NDcml0ZXJpYS5jbGFzcywgQ0xBU1Nf\nQ1JJVCk7CiAgICAgICAgX3RhZ3MucHV0KENvbHVtbnMuY2xhc3MsIENPTFMp\nOwogICAgICAgIF90YWdzLnB1dChDb250YWluZXJUYWJsZS5jbGFzcywgQ09O\nVEFJTkVSX1RBQkxFKTsKICAgICAgICBfdGFncy5wdXQoRGF0YVN0b3JlSWRD\nb2x1bW4uY2xhc3MsIERBVEFTVE9SRV9JRF9DT0wpOwogICAgICAgIF90YWdz\nLnB1dChEaXNjcmltaW5hdG9yU3RyYXRlZ3kuY2xhc3MsIERJU0NSSU1fU1RS\nQVQpOwogICAgICAgIF90YWdzLnB1dChFYWdlckZldGNoTW9kZS5jbGFzcywg\nRUFHRVJfRkVUQ0hfTU9ERSk7CiAgICAgICAgX3RhZ3MucHV0KEVsZW1lbnRD\nbGFzc0NyaXRlcmlhLmNsYXNzLCBFTEVNX0NMQVNTX0NSSVQpOwogICAgICAg\nIF90YWdzLnB1dChFbGVtZW50Rm9yZWlnbktleS5jbGFzcywgRUxFTV9GSyk7\nCiAgICAgICAgX3RhZ3MucHV0KEVsZW1lbnRJbmRleC5jbGFzcywgRUxFTV9J\nTkRFWCk7CiAgICAgICAgX3RhZ3MucHV0KEVsZW1lbnRKb2luQ29sdW1uLmNs\nYXNzLCBFTEVNX0pPSU5fQ09MKTsKICAgICAgICBfdGFncy5wdXQoRWxlbWVu\ndEpvaW5Db2x1bW5zLmNsYXNzLCBFTEVNX0pPSU5fQ09MUyk7CiAgICAgICAg\nX3RhZ3MucHV0KEVsZW1lbnROb25wb2x5bW9ycGhpYy5jbGFzcywgRUxFTV9O\nT05QT0xZKTsKICAgICAgICBfdGFncy5wdXQoRW1iZWRkZWRNYXBwaW5nLmNs\nYXNzLCBFTUJFRERFRF9NQVBQSU5HKTsKICAgICAgICBfdGFncy5wdXQoRm9y\nZWlnbktleS5jbGFzcywgRkspOwogICAgICAgIF90YWdzLnB1dChJbmRleC5j\nbGFzcywgSU5ERVgpOwogICAgICAgIF90YWdzLnB1dChNYXBwaW5nT3ZlcnJp\nZGUuY2xhc3MsIE1BUFBJTkdfT1ZFUlJJREUpOwogICAgICAgIF90YWdzLnB1\ndChNYXBwaW5nT3ZlcnJpZGVzLmNsYXNzLCBNQVBQSU5HX09WRVJSSURFUyk7\nCiAgICAgICAgX3RhZ3MucHV0KE5vbnBvbHltb3JwaGljLmNsYXNzLCBOT05Q\nT0xZKTsKICAgICAgICBfdGFncy5wdXQoT3JkZXJDb2x1bW4uY2xhc3MsIE9S\nREVSX0NPTCk7CiAgICAgICAgX3RhZ3MucHV0KFN0cmF0ZWd5LmNsYXNzLCBT\nVFJBVCk7CiAgICAgICAgX3RhZ3MucHV0KFN1YmNsYXNzRmV0Y2hNb2RlLmNs\nYXNzLCBTVUJDTEFTU19GRVRDSF9NT0RFKTsKICAgICAgICBfdGFncy5wdXQo\nVW5pcXVlLmNsYXNzLCBVTklRVUUpOwogICAgICAgIF90YWdzLnB1dChWZXJz\naW9uQ29sdW1uLmNsYXNzLCBWRVJTSU9OX0NPTCk7CiAgICAgICAgX3RhZ3Mu\ncHV0KFZlcnNpb25Db2x1bW5zLmNsYXNzLCBWRVJTSU9OX0NPTFMpOwogICAg\nICAgIF90YWdzLnB1dChWZXJzaW9uU3RyYXRlZ3kuY2xhc3MsIFZFUlNJT05f\nU1RSQVQpOwogICAgICAgIF90YWdzLnB1dChYRW1iZWRkZWRNYXBwaW5nLmNs\nYXNzLCBYX0VNQkVEREVEX01BUFBJTkcpOwogICAgICAgIF90YWdzLnB1dChY\nSm9pbkNvbHVtbi5jbGFzcywgWF9KT0lOX0NPTCk7CiAgICAgICAgX3RhZ3Mu\ncHV0KFhKb2luQ29sdW1ucy5jbGFzcywgWF9KT0lOX0NPTFMpOwogICAgICAg\nIF90YWdzLnB1dChYTWFwcGluZ092ZXJyaWRlLmNsYXNzLCBYX01BUFBJTkdf\nT1ZFUlJJREUpOwogICAgICAgIF90YWdzLnB1dChYTWFwcGluZ092ZXJyaWRl\ncy5jbGFzcywgWF9NQVBQSU5HX09WRVJSSURFUyk7CiAgICAgICAgX3RhZ3Mu\ncHV0KFhTZWNvbmRhcnlUYWJsZS5jbGFzcywgWF9TRUNPTkRBUllfVEFCTEUp\nOwogICAgICAgIF90YWdzLnB1dChYU2Vjb25kYXJ5VGFibGVzLmNsYXNzLCBY\nX1NFQ09OREFSWV9UQUJMRVMpOwogICAgICAgIF90YWdzLnB1dChYVGFibGUu\nY2xhc3MsIFhfVEFCTEUpOwogICAgfQoKICAgIHB1YmxpYyBBbm5vdGF0aW9u\nUGVyc2lzdGVuY2VNYXBwaW5nUGFyc2VyKEpEQkNDb25maWd1cmF0aW9uIGNv\nbmYpIHsKICAgICAgICBzdXBlcihjb25mKTsKICAgIH0KCiAgICBAT3ZlcnJp\nZGUKICAgIHByb3RlY3RlZCB2b2lkIHBhcnNlUGFja2FnZU1hcHBpbmdBbm5v\ndGF0aW9ucyhQYWNrYWdlIHBrZykgewogICAgICAgIE1hcHBpbmdUYWcgdGFn\nOwogICAgICAgIGZvciAoQW5ub3RhdGlvbiBhbm5vIDogcGtnLmdldERlY2xh\ncmVkQW5ub3RhdGlvbnMoKSkgewogICAgICAgICAgICB0YWcgPSBfdGFncy5n\nZXQoYW5uby5hbm5vdGF0aW9uVHlwZSgpKTsKICAgICAgICAgICAgaWYgKHRh\nZyA9PSBudWxsKSB7CiAgICAgICAgICAgICAgICBoYW5kbGVVbmtub3duUGFj\na2FnZU1hcHBpbmdBbm5vdGF0aW9uKHBrZywgYW5ubyk7CiAgICAgICAgICAg\nICAgICBjb250aW51ZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgc3dp\ndGNoICh0YWcpIHsKICAgICAgICAgICAgICAgIGNhc2UgVEFCTEVfR0VOOgog\nICAgICAgICAgICAgICAgICAgIHBhcnNlVGFibGVHZW5lcmF0b3IocGtnLCAo\nVGFibGVHZW5lcmF0b3IpIGFubm8pOwogICAgICAgICAgICAgICAgICAgIGJy\nZWFrOwogICAgICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAg\nICAgICB0aHJvdyBuZXcgVW5zdXBwb3J0ZWRFeGNlcHRpb24oX2xvYy5nZXQo\nInVuc3VwcG9ydGVkIiwgcGtnLAogICAgICAgICAgICAgICAgICAgICAgICBh\nbm5vLnRvU3RyaW5nKCkpKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAg\nIH0KCiAgICAvKioKICAgICAqIEFsbG93IHN1YmNsYXNzZXMgdG8gaGFuZGxl\nIHVua25vd24gYW5ub3RhdGlvbnMuCiAgICAgKi8KICAgIHByb3RlY3RlZCBi\nb29sZWFuIGhhbmRsZVVua25vd25QYWNrYWdlTWFwcGluZ0Fubm90YXRpb24o\nUGFja2FnZSBwa2csCiAgICAgICAgQW5ub3RhdGlvbiBhbm5vKSB7CiAgICAg\nICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIC8qKgogICAgICogUGFyc2Ug\nQFRhYmxlR2VuZXJhdG9yLgogICAgICovCiAgICBwcml2YXRlIHZvaWQgcGFy\nc2VUYWJsZUdlbmVyYXRvcihBbm5vdGF0ZWRFbGVtZW50IGVsLCBUYWJsZUdl\nbmVyYXRvciBnZW4pIHsKICAgICAgICBTdHJpbmcgbmFtZSA9IGdlbi5uYW1l\nKCk7CiAgICAgICAgaWYgKFN0cmluZ1V0aWxzLmlzRW1wdHkobmFtZSkpCiAg\nICAgICAgICAgIHRocm93IG5ldyBNZXRhRGF0YUV4Y2VwdGlvbihfbG9jLmdl\ndCgibm8tZ2VuLW5hbWUiLCBlbCkpOwoKICAgICAgICBMb2cgbG9nID0gZ2V0\nTG9nKCk7CiAgICAgICAgaWYgKGxvZy5pc1RyYWNlRW5hYmxlZCgpKQogICAg\nICAgICAgICBsb2cudHJhY2UoX2xvYy5nZXQoInBhcnNlLWdlbiIsIG5hbWUp\nKTsKCiAgICAgICAgU2VxdWVuY2VNYXBwaW5nIG1ldGEgPSAoU2VxdWVuY2VN\nYXBwaW5nKSBnZXRSZXBvc2l0b3J5KCkuCiAgICAgICAgICAgIGdldENhY2hl\nZFNlcXVlbmNlTWV0YURhdGEobmFtZSk7CiAgICAgICAgaWYgKG1ldGEgIT0g\nbnVsbCkgewogICAgICAgICAgICBpZiAobG9nLmlzV2FybkVuYWJsZWQoKSkK\nICAgICAgICAgICAgICAgIGxvZy53YXJuKF9sb2MuZ2V0KCJkdXAtZ2VuIiwg\nbmFtZSwgZWwpKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAg\nICAgICAgbWV0YSA9IChTZXF1ZW5jZU1hcHBpbmcpIGdldFJlcG9zaXRvcnko\nKS5hZGRTZXF1ZW5jZU1ldGFEYXRhKG5hbWUpOwogICAgICAgIG1ldGEuc2V0\nU2VxdWVuY2VQbHVnaW4oU2VxdWVuY2VNYXBwaW5nLklNUExfVkFMVUVfVEFC\nTEUpOwogICAgICAgIG1ldGEuc2V0VGFibGUodG9UYWJsZU5hbWUoZ2VuLnNj\naGVtYSgpLCBnZW4udGFibGUoKSkpOwogICAgICAgIG1ldGEuc2V0UHJpbWFy\neUtleUNvbHVtbihnZW4ucGtDb2x1bW5OYW1lKCkpOwogICAgICAgIG1ldGEu\nc2V0U2VxdWVuY2VDb2x1bW4oZ2VuLnZhbHVlQ29sdW1uTmFtZSgpKTsKICAg\nICAgICBtZXRhLnNldFByaW1hcnlLZXlWYWx1ZShnZW4ucGtDb2x1bW5WYWx1\nZSgpKTsKICAgICAgICBtZXRhLnNldEluaXRpYWxWYWx1ZShnZW4uaW5pdGlh\nbFZhbHVlKCkpOwogICAgICAgIG1ldGEuc2V0QWxsb2NhdGUoZ2VuLmFsbG9j\nYXRpb25TaXplKCkpOwogICAgICAgIG1ldGEuc2V0U291cmNlKGdldFNvdXJj\nZUZpbGUoKSwgKGVsIGluc3RhbmNlb2YgQ2xhc3MpID8gZWwgOiBudWxsLAog\nICAgICAgICAgICBtZXRhLlNSQ19BTk5PVEFUSU9OUyk7CiAgICAgICAgCiAg\nICAgICAgc3dpdGNoIChnZW4udW5pcXVlQ29uc3RyYWludHMoKS5sZW5ndGgp\nIHsKICAgICAgICBjYXNlIDA6IAogICAgICAgIAlicmVhazsgLy8gbm90aGlu\nZyB0byBkbwogICAgICAgIGNhc2UgMTogCiAgICAgICAgCW1ldGEuc2V0VW5p\ncXVlQ29sdW1ucyhnZW4udW5pcXVlQ29uc3RyYWludHMoKVswXS5jb2x1bW5O\nYW1lcygpKTsKICAgICAgICAJYnJlYWs7CiAgICAgICAgZGVmYXVsdDoKICAg\nICAgICAJbG9nLndhcm4oX2xvYy5nZXQoInVuaXF1ZS1tYW55LW9uLXNlcS11\nbnN1cHBvcnRlZCIsIGVsLCBuYW1lKSk7CiAgICAgICAgfQogICAgfQoKICAg\nIEBPdmVycmlkZQogICAgcHJvdGVjdGVkIHZvaWQgcGFyc2VDbGFzc01hcHBp\nbmdBbm5vdGF0aW9ucyhDbGFzc01ldGFEYXRhIG1ldGEpIHsKICAgICAgICBD\nbGFzc01hcHBpbmcgY20gPSAoQ2xhc3NNYXBwaW5nKSBtZXRhOwogICAgICAg\nIENsYXNzIGNscyA9IGNtLmdldERlc2NyaWJlZFR5cGUoKTsKCiAgICAgICAg\nTWFwcGluZ1RhZyB0YWc7CiAgICAgICAgZm9yIChBbm5vdGF0aW9uIGFubm8g\nOiBjbHMuZ2V0RGVjbGFyZWRBbm5vdGF0aW9ucygpKSB7CiAgICAgICAgICAg\nIHRhZyA9IF90YWdzLmdldChhbm5vLmFubm90YXRpb25UeXBlKCkpOwogICAg\nICAgICAgICBpZiAodGFnID09IG51bGwpIHsKICAgICAgICAgICAgICAgIGhh\nbmRsZVVua25vd25DbGFzc01hcHBpbmdBbm5vdGF0aW9uKGNtLCBhbm5vKTsK\nICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICB9CgogICAg\nICAgICAgICBzd2l0Y2ggKHRhZykgewogICAgICAgICAgICAgICAgY2FzZSBB\nU1NPQ19PVkVSUklERToKICAgICAgICAgICAgICAgICAgICBwYXJzZUFzc29j\naWF0aW9uT3ZlcnJpZGVzKGNtLCAoQXNzb2NpYXRpb25PdmVycmlkZSkgYW5u\nbyk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAg\nICBjYXNlIEFTU09DX09WRVJSSURFUzoKICAgICAgICAgICAgICAgICAgICBw\nYXJzZUFzc29jaWF0aW9uT3ZlcnJpZGVzKGNtLCAoKEFzc29jaWF0aW9uT3Zl\ncnJpZGVzKSBhbm5vKS4KICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUo\nKSk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAg\nICBjYXNlIEFUVFJfT1ZFUlJJREU6CiAgICAgICAgICAgICAgICAgICAgcGFy\nc2VBdHRyaWJ1dGVPdmVycmlkZXMoY20sIChBdHRyaWJ1dGVPdmVycmlkZSkg\nYW5ubyk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAg\nICAgICBjYXNlIEFUVFJfT1ZFUlJJREVTOgogICAgICAgICAgICAgICAgICAg\nIHBhcnNlQXR0cmlidXRlT3ZlcnJpZGVzKGNtLCAoKEF0dHJpYnV0ZU92ZXJy\naWRlcykgYW5ubykuCiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlKCkp\nOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAg\nY2FzZSBESVNDUklNX0NPTDoKICAgICAgICAgICAgICAgICAgICBwYXJzZURp\nc2NyaW1pbmF0b3JDb2x1bW4oY20sIChEaXNjcmltaW5hdG9yQ29sdW1uKSBh\nbm5vKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAg\nICAgIGNhc2UgRElTQ1JJTV9WQUw6CiAgICAgICAgICAgICAgICAgICAgY20u\nZ2V0RGlzY3JpbWluYXRvcigpLmdldE1hcHBpbmdJbmZvKCkuc2V0VmFsdWUK\nICAgICAgICAgICAgICAgICAgICAgICAgKCgoRGlzY3JpbWluYXRvclZhbHVl\nKSBhbm5vKS52YWx1ZSgpKTsKICAgICAgICAgICAgICAgICAgICBpZiAoTW9k\naWZpZXIuaXNBYnN0cmFjdChjbS5nZXREZXNjcmliZWRUeXBlKCkuCiAgICAg\nICAgICAgICAgICAgICAgICAgICAgICBnZXRNb2RpZmllcnMoKSkgJiYgZ2V0\nTG9nKCkuaXNJbmZvRW5hYmxlZCgpKSB7CiAgICAgICAgICAgICAgICAgICAg\nICAgIGdldExvZygpLmluZm8oCiAgICAgICAgICAgICAgICAgICAgICAgICAg\nICBfbG9jLmdldCgiZGlzY3JpbWluYXRvci1vbi1hYnN0cmFjdC1jbGFzcyIs\nIGNtCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5nZXRE\nZXNjcmliZWRUeXBlKCkuZ2V0TmFtZSgpKSk7CiAgICAgICAgICAgICAgICAg\nICAgfQogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAg\nICAgY2FzZSBJTkhFUklUQU5DRToKICAgICAgICAgICAgICAgICAgICBwYXJz\nZUluaGVyaXRhbmNlKGNtLCAoSW5oZXJpdGFuY2UpIGFubm8pOwogICAgICAg\nICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSBQS19K\nT0lOX0NPTDoKICAgICAgICAgICAgICAgICAgICBwYXJzZVByaW1hcnlLZXlK\nb2luQ29sdW1ucyhjbSwgKFByaW1hcnlLZXlKb2luQ29sdW1uKSBhbm5vKTsK\nICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNh\nc2UgUEtfSk9JTl9DT0xTOgogICAgICAgICAgICAgICAgICAgIHBhcnNlUHJp\nbWFyeUtleUpvaW5Db2x1bW5zKGNtLAogICAgICAgICAgICAgICAgICAgICAg\nICAoKFByaW1hcnlLZXlKb2luQ29sdW1ucykgYW5ubykuCiAgICAgICAgICAg\nICAgICAgICAgICAgICAgICB2YWx1ZSgpKTsKICAgICAgICAgICAgICAgICAg\nICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgU0VDT05EQVJZX1RBQkxF\nOgogICAgICAgICAgICAgICAgICAgIHBhcnNlU2Vjb25kYXJ5VGFibGVzKGNt\nLCAoU2Vjb25kYXJ5VGFibGUpIGFubm8pOwogICAgICAgICAgICAgICAgICAg\nIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSBTRUNPTkRBUllfVEFCTEVT\nOgogICAgICAgICAgICAgICAgICAgIHBhcnNlU2Vjb25kYXJ5VGFibGVzKGNt\nLCAoKFNlY29uZGFyeVRhYmxlcykgYW5ubykudmFsdWUoKSk7CiAgICAgICAg\nICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIFNRTF9S\nRVNVTFRfU0VUX01BUFBJTkc6CiAgICAgICAgICAgICAgICAgICAgcGFyc2VT\nUUxSZXN1bHRTZXRNYXBwaW5ncyhjbSwgKFNxbFJlc3VsdFNldE1hcHBpbmcp\nIGFubm8pOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAg\nICAgICAgY2FzZSBTUUxfUkVTVUxUX1NFVF9NQVBQSU5HUzoKICAgICAgICAg\nICAgICAgICAgICBwYXJzZVNRTFJlc3VsdFNldE1hcHBpbmdzKGNtLCAoKFNx\nbFJlc3VsdFNldE1hcHBpbmdzKSBhbm5vKS4KICAgICAgICAgICAgICAgICAg\nICAgICAgdmFsdWUoKSk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAg\nICAgICAgICAgICAgICBjYXNlIFRBQkxFOgogICAgICAgICAgICAgICAgICAg\nIHBhcnNlVGFibGUoY20sIChUYWJsZSkgYW5ubyk7CiAgICAgICAgICAgICAg\nICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIFRBQkxFX0dFTjoK\nICAgICAgICAgICAgICAgICAgICBwYXJzZVRhYmxlR2VuZXJhdG9yKGNscywg\nKFRhYmxlR2VuZXJhdG9yKSBhbm5vKTsKICAgICAgICAgICAgICAgICAgICBi\ncmVhazsKICAgICAgICAgICAgICAgIGNhc2UgREFUQVNUT1JFX0lEX0NPTDoK\nICAgICAgICAgICAgICAgICAgICBwYXJzZURhdGFTdG9yZUlkQ29sdW1uKGNt\nLCAoRGF0YVN0b3JlSWRDb2x1bW4pIGFubm8pOwogICAgICAgICAgICAgICAg\nICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSBESVNDUklNX1NUUkFU\nOgogICAgICAgICAgICAgICAgICAgIGNtLmdldERpc2NyaW1pbmF0b3IoKS5n\nZXRNYXBwaW5nSW5mbygpLnNldFN0cmF0ZWd5CiAgICAgICAgICAgICAgICAg\nICAgICAgICgoKERpc2NyaW1pbmF0b3JTdHJhdGVneSkgYW5ubykudmFsdWUo\nKSk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAg\nICBjYXNlIEZLOgogICAgICAgICAgICAgICAgICAgIHBhcnNlRm9yZWlnbktl\neShjbS5nZXRNYXBwaW5nSW5mbygpLCAoRm9yZWlnbktleSkgYW5ubyk7CiAg\nICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNl\nIE1BUFBJTkdfT1ZFUlJJREU6CiAgICAgICAgICAgICAgICAgICAgcGFyc2VN\nYXBwaW5nT3ZlcnJpZGVzKGNtLCAoTWFwcGluZ092ZXJyaWRlKSBhbm5vKTsK\nICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNh\nc2UgTUFQUElOR19PVkVSUklERVM6CiAgICAgICAgICAgICAgICAgICAgcGFy\nc2VNYXBwaW5nT3ZlcnJpZGVzKGNtLAogICAgICAgICAgICAgICAgICAgICAg\nICAoKE1hcHBpbmdPdmVycmlkZXMpIGFubm8pLnZhbHVlKCkpOwogICAgICAg\nICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSBTVFJB\nVDoKICAgICAgICAgICAgICAgICAgICBjbS5nZXRNYXBwaW5nSW5mbygpLnNl\ndFN0cmF0ZWd5KCgoU3RyYXRlZ3kpIGFubm8pLnZhbHVlKCkpOwogICAgICAg\nICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSBTVUJD\nTEFTU19GRVRDSF9NT0RFOgogICAgICAgICAgICAgICAgICAgIGNtLnNldFN1\nYmNsYXNzRmV0Y2hNb2RlKHRvRWFnZXJGZXRjaE1vZGVDb25zdGFudAogICAg\nICAgICAgICAgICAgICAgICAgICAoKChTdWJjbGFzc0ZldGNoTW9kZSkgYW5u\nbykudmFsdWUoKSkpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAg\nICAgICAgICAgICAgY2FzZSBWRVJTSU9OX0NPTDoKICAgICAgICAgICAgICAg\nICAgICBwYXJzZVZlcnNpb25Db2x1bW5zKGNtLCAoVmVyc2lvbkNvbHVtbikg\nYW5ubyk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAg\nICAgICBjYXNlIFZFUlNJT05fQ09MUzoKICAgICAgICAgICAgICAgICAgICBw\nYXJzZVZlcnNpb25Db2x1bW5zKGNtLCAoKFZlcnNpb25Db2x1bW5zKSBhbm5v\nKS52YWx1ZSgpKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAg\nICAgICAgICAgIGNhc2UgVkVSU0lPTl9TVFJBVDoKICAgICAgICAgICAgICAg\nICAgICBjbS5nZXRWZXJzaW9uKCkuZ2V0TWFwcGluZ0luZm8oKS5zZXRTdHJh\ndGVneQogICAgICAgICAgICAgICAgICAgICAgICAoKChWZXJzaW9uU3RyYXRl\nZ3kpIGFubm8pLnZhbHVlKCkpOwogICAgICAgICAgICAgICAgICAgIGJyZWFr\nOwogICAgICAgICAgICAgICAgY2FzZSBYX01BUFBJTkdfT1ZFUlJJREU6CiAg\nICAgICAgICAgICAgICAgICAgcGFyc2VNYXBwaW5nT3ZlcnJpZGVzKGNtLCAo\nWE1hcHBpbmdPdmVycmlkZSkgYW5ubyk7CiAgICAgICAgICAgICAgICAgICAg\nYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIFhfTUFQUElOR19PVkVSUklE\nRVM6CiAgICAgICAgICAgICAgICAgICAgcGFyc2VNYXBwaW5nT3ZlcnJpZGVz\nKGNtLAogICAgICAgICAgICAgICAgICAgICAgICAoKFhNYXBwaW5nT3ZlcnJp\nZGVzKSBhbm5vKS52YWx1ZSgpKTsKICAgICAgICAgICAgICAgICAgICBicmVh\nazsKICAgICAgICAgICAgICAgIGNhc2UgWF9UQUJMRToKICAgICAgICAgICAg\nICAgIGNhc2UgWF9TRUNPTkRBUllfVEFCTEU6CiAgICAgICAgICAgICAgICBj\nYXNlIFhfU0VDT05EQVJZX1RBQkxFUzoKICAgICAgICAgICAgICAgICAgICAv\nLyBubyBicmVhazsgbm90IHN1cHBvcnRlZCB5ZXQKICAgICAgICAgICAgICAg\nIGRlZmF1bHQ6CiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IFVuc3Vw\ncG9ydGVkRXhjZXB0aW9uKF9sb2MuZ2V0KCJ1bnN1cHBvcnRlZCIsIGNtLAog\nICAgICAgICAgICAgICAgICAgICAgICBhbm5vKSk7CiAgICAgICAgICAgIH0K\nICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBBbGxvdyBzdWJjbGFz\nc2VzIHRvIGhhbmRsZSB1bmtub3duIGFubm90YXRpb25zLgogICAgICovCiAg\nICBwcm90ZWN0ZWQgYm9vbGVhbiBoYW5kbGVVbmtub3duQ2xhc3NNYXBwaW5n\nQW5ub3RhdGlvbihDbGFzc01hcHBpbmcgY2xzLAogICAgICAgIEFubm90YXRp\nb24gYW5ubykgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICAv\nKioKICAgICAqIFBhcnNlIEBBc3NvY2lhdGlvbk92ZXJyaWRlKHMpLgogICAg\nICovCiAgICBwcml2YXRlIHZvaWQgcGFyc2VBc3NvY2lhdGlvbk92ZXJyaWRl\ncyhDbGFzc01hcHBpbmcgY20sCiAgICAgICAgQXNzb2NpYXRpb25PdmVycmlk\nZS4uLiBhc3NvY3MpIHsKICAgICAgICBGaWVsZE1hcHBpbmcgc3VwOwogICAg\nICAgIEpvaW5Db2x1bW5bXSBzY29sczsKICAgICAgICBpbnQgdW5pcXVlOwog\nICAgICAgIExpc3Q8Q29sdW1uPiBqY29sczsKICAgICAgICBmb3IgKEFzc29j\naWF0aW9uT3ZlcnJpZGUgYXNzb2MgOiBhc3NvY3MpIHsKICAgICAgICAgICAg\naWYgKFN0cmluZ1V0aWxzLmlzRW1wdHkoYXNzb2MubmFtZSgpKSkKICAgICAg\nICAgICAgICAgIHRocm93IG5ldyBNZXRhRGF0YUV4Y2VwdGlvbihfbG9jLmdl\ndCgibm8tb3ZlcnJpZGUtbmFtZSIsIGNtKSk7CiAgICAgICAgICAgIHN1cCA9\nIChGaWVsZE1hcHBpbmcpIGNtLmdldERlZmluZWRTdXBlcmNsYXNzRmllbGQo\nYXNzb2MubmFtZSgpKTsKICAgICAgICAgICAgaWYgKHN1cCA9PSBudWxsKQog\nICAgICAgICAgICAgICAgc3VwID0gKEZpZWxkTWFwcGluZykgY20uYWRkRGVm\naW5lZFN1cGVyY2xhc3NGaWVsZAogICAgICAgICAgICAgICAgICAgIChhc3Nv\nYy5uYW1lKCksIE9iamVjdC5jbGFzcywgT2JqZWN0LmNsYXNzKTsKICAgICAg\nICAgICAgc2NvbHMgPSBhc3NvYy5qb2luQ29sdW1ucygpOwogICAgICAgICAg\nICBpZiAoc2NvbHMgPT0gbnVsbCB8fCBzY29scy5sZW5ndGggPT0gMCkKICAg\nICAgICAgICAgICAgIGNvbnRpbnVlOwoKICAgICAgICAgICAgamNvbHMgPSBu\nZXcgQXJyYXlMaXN0PENvbHVtbj4oc2NvbHMubGVuZ3RoKTsKICAgICAgICAg\nICAgdW5pcXVlID0gMDsKICAgICAgICAgICAgZm9yIChKb2luQ29sdW1uIHNj\nb2wgOiBzY29scykgewogICAgICAgICAgICAgICAgdW5pcXVlIHw9IChzY29s\nLnVuaXF1ZSgpKSA/IFRSVUUgOiBGQUxTRTsKICAgICAgICAgICAgICAgIGpj\nb2xzLmFkZChuZXdDb2x1bW4oc2NvbCkpOwogICAgICAgICAgICB9CiAgICAg\nICAgICAgIHNldENvbHVtbnMoc3VwLCBzdXAuZ2V0VmFsdWVJbmZvKCksIGpj\nb2xzLCB1bmlxdWUpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAq\nIFBhcnNlIEBBdHRyaWJ1dGVPdmVycmlkZShzKS4KICAgICAqLwogICAgcHJp\ndmF0ZSB2b2lkIHBhcnNlQXR0cmlidXRlT3ZlcnJpZGVzKENsYXNzTWFwcGlu\nZyBjbSwKICAgICAgICBBdHRyaWJ1dGVPdmVycmlkZS4uLiBhdHRycykgewog\nICAgICAgIEZpZWxkTWFwcGluZyBzdXA7CiAgICAgICAgZm9yIChBdHRyaWJ1\ndGVPdmVycmlkZSBhdHRyIDogYXR0cnMpIHsKICAgICAgICAgICAgaWYgKFN0\ncmluZ1V0aWxzLmlzRW1wdHkoYXR0ci5uYW1lKCkpKQogICAgICAgICAgICAg\nICAgdGhyb3cgbmV3IE1ldGFEYXRhRXhjZXB0aW9uKF9sb2MuZ2V0KCJuby1v\ndmVycmlkZS1uYW1lIiwgY20pKTsKICAgICAgICAgICAgc3VwID0gKEZpZWxk\nTWFwcGluZykgY20uZ2V0RGVmaW5lZFN1cGVyY2xhc3NGaWVsZChhdHRyLm5h\nbWUoKSk7CiAgICAgICAgICAgIGlmIChzdXAgPT0gbnVsbCkKICAgICAgICAg\nICAgICAgIHN1cCA9IChGaWVsZE1hcHBpbmcpIGNtLmFkZERlZmluZWRTdXBl\ncmNsYXNzRmllbGQoYXR0ci5uYW1lKCksCiAgICAgICAgICAgICAgICAgICAg\nT2JqZWN0LmNsYXNzLCBPYmplY3QuY2xhc3MpOwogICAgICAgICAgICBpZiAo\nYXR0ci5jb2x1bW4oKSAhPSBudWxsKQogICAgICAgICAgICAgICAgcGFyc2VD\nb2x1bW5zKHN1cCwgYXR0ci5jb2x1bW4oKSk7CiAgICAgICAgfQogICAgfQoK\nICAgIC8qKgogICAgICogUGFyc2UgaW5oZXJpdGFuY2UgQFByaW1hcnlLZXlK\nb2luQ29sdW1uKHMpLgogICAgICovCiAgICBwcml2YXRlIHZvaWQgcGFyc2VQ\ncmltYXJ5S2V5Sm9pbkNvbHVtbnMoQ2xhc3NNYXBwaW5nIGNtLAogICAgICAg\nIFByaW1hcnlLZXlKb2luQ29sdW1uLi4uIGpvaW5zKSB7CiAgICAgICAgTGlz\ndDxDb2x1bW4+IGNvbHMgPSBuZXcgQXJyYXlMaXN0PENvbHVtbj4oam9pbnMu\nbGVuZ3RoKTsKICAgICAgICBmb3IgKFByaW1hcnlLZXlKb2luQ29sdW1uIGpv\naW4gOiBqb2lucykKICAgICAgICAgICAgY29scy5hZGQobmV3Q29sdW1uKGpv\naW4pKTsKICAgICAgICBjbS5nZXRNYXBwaW5nSW5mbygpLnNldENvbHVtbnMo\nY29scyk7CiAgICB9CgogICAgLyoqCiAgICAgKiBDcmVhdGUgYSBuZXcgc2No\nZW1hIGNvbHVtbiB3aXRoIGluZm9ybWF0aW9uIGZyb20gdGhlIGdpdmVuIGFu\nbm90YXRpb24uCiAgICAgKi8KICAgIHByaXZhdGUgc3RhdGljIENvbHVtbiBu\nZXdDb2x1bW4oUHJpbWFyeUtleUpvaW5Db2x1bW4gam9pbikgewogICAgICAg\nIENvbHVtbiBjb2wgPSBuZXcgQ29sdW1uKCk7CiAgICAgICAgY29sLnNldEZs\nYWcoQ29sdW1uLkZMQUdfUEtfSk9JTiwgdHJ1ZSk7CiAgICAgICAgaWYgKCFT\ndHJpbmdVdGlscy5pc0VtcHR5KGpvaW4ubmFtZSgpKSkKICAgICAgICAgICAg\nY29sLnNldE5hbWUoam9pbi5uYW1lKCkpOwogICAgICAgIGlmICghU3RyaW5n\nVXRpbHMuaXNFbXB0eShqb2luLmNvbHVtbkRlZmluaXRpb24oKSkpCiAgICAg\nICAgICAgIGNvbC5zZXRUeXBlTmFtZShqb2luLmNvbHVtbkRlZmluaXRpb24o\nKSk7CiAgICAgICAgaWYgKCFTdHJpbmdVdGlscy5pc0VtcHR5KGpvaW4ucmVm\nZXJlbmNlZENvbHVtbk5hbWUoKSkpCiAgICAgICAgICAgIGNvbC5zZXRUYXJn\nZXQoam9pbi5yZWZlcmVuY2VkQ29sdW1uTmFtZSgpKTsKICAgICAgICByZXR1\ncm4gY29sOwogICAgfQoKICAgIC8qKgogICAgICogUGFyc2UgQFNlY29uZGFy\neVRhYmxlKHMpLgogICAgICovCiAgICBwcml2YXRlIHZvaWQgcGFyc2VTZWNv\nbmRhcnlUYWJsZXMoQ2xhc3NNYXBwaW5nIGNtLAogICAgICAgIFNlY29uZGFy\neVRhYmxlLi4uIHRhYmxlcykgewogICAgICAgIENsYXNzTWFwcGluZ0luZm8g\naW5mbyA9IGNtLmdldE1hcHBpbmdJbmZvKCk7CiAgICAgICAgTG9nIGxvZyA9\nIGdldExvZygpOwoKICAgICAgICBTdHJpbmcgbmFtZTsKICAgICAgICBMaXN0\nPENvbHVtbj4gam9pbnMgPSBudWxsOwogICAgICAgIGZvciAoU2Vjb25kYXJ5\nVGFibGUgdGFibGUgOiB0YWJsZXMpIHsKICAgICAgICAgICAgbmFtZSA9IHRh\nYmxlLm5hbWUoKTsKICAgICAgICAgICAgaWYgKFN0cmluZ1V0aWxzLmlzRW1w\ndHkobmFtZSkpCiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgTWV0YURhdGFF\neGNlcHRpb24oX2xvYy5nZXQoInNlY29uZC1uYW1lIiwgY20pKTsKICAgICAg\nICAgICAgaWYgKCFTdHJpbmdVdGlscy5pc0VtcHR5KHRhYmxlLnNjaGVtYSgp\nKSkKICAgICAgICAgICAgICAgIG5hbWUgPSB0YWJsZS5zY2hlbWEoKSArICIu\nIiArIG5hbWU7CiAgICAgICAgICAgIGlmICh0YWJsZS5wa0pvaW5Db2x1bW5z\nKCkubGVuZ3RoID4gMCkgewogICAgICAgICAgICAgICAgam9pbnMgPSBuZXcg\nQXJyYXlMaXN0PENvbHVtbj4odGFibGUucGtKb2luQ29sdW1ucygpLmxlbmd0\naCk7CiAgICAgICAgICAgICAgICBmb3IgKFByaW1hcnlLZXlKb2luQ29sdW1u\nIGpvaW4gOiB0YWJsZS5wa0pvaW5Db2x1bW5zKCkpCiAgICAgICAgICAgICAg\nICAgICAgam9pbnMuYWRkKG5ld0NvbHVtbihqb2luKSk7CiAgICAgICAgICAg\nICAgICBpbmZvLnNldFNlY29uZGFyeVRhYmxlSm9pbkNvbHVtbnMobmFtZSwg\nam9pbnMpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAJaW5m\nby5hZGRTZWNvbmRhcnlUYWJsZShuYW1lKTsKICAgICAgICAgICAgfQogICAg\nICAgICAgICBhZGRVbmlxdWVDb25zdHJhaW50cyhuYW1lLCBjbSwgaW5mbywg\ndGFibGUudW5pcXVlQ29uc3RyYWludHMoKSk7CiAgICAgICAgfQogICAgfQoK\nICAgIC8qKgogICAgICogU2V0IGNsYXNzIHRhYmxlLgogICAgICovCiAgICBw\ncml2YXRlIHZvaWQgcGFyc2VUYWJsZShDbGFzc01hcHBpbmcgY20sIFRhYmxl\nIHRhYmxlKSB7CiAgICAgICAgU3RyaW5nIHRhYmxlTmFtZSA9IHRvVGFibGVO\nYW1lKHRhYmxlLnNjaGVtYSgpLCB0YWJsZS5uYW1lKCkpOwogICAgICAgIGlm\nICh0YWJsZU5hbWUgIT0gbnVsbCkKICAgICAgICAgICAgY20uZ2V0TWFwcGlu\nZ0luZm8oKS5zZXRUYWJsZU5hbWUodGFibGVOYW1lKTsKCiAgICAgICAgYWRk\nVW5pcXVlQ29uc3RyYWludHModGFibGVOYW1lLCBjbSwgY20uZ2V0TWFwcGlu\nZ0luZm8oKSwgCiAgICAgICAgCQl0YWJsZS51bmlxdWVDb25zdHJhaW50cygp\nKTsKICAgIH0KICAgIAogICAgVW5pcXVlIGNyZWF0ZVVuaXF1ZUNvbnN0cmFp\nbnQoTWV0YURhdGFDb250ZXh0IGN0eCwgVW5pcXVlQ29uc3RyYWludCBhbm5v\nKSB7CgkJU3RyaW5nW10gY29sdW1uTmFtZXMgPSBhbm5vLmNvbHVtbk5hbWVz\nKCk7CgkJaWYgKGNvbHVtbk5hbWVzID09IG51bGwgfHwgY29sdW1uTmFtZXMu\nbGVuZ3RoID09IDApCgkJCXRocm93IG5ldyBVc2VyRXhjZXB0aW9uKF9sb2Mu\nZ2V0KCJ1bmlxdWUtbm8tY29sdW1uIiwgY3R4KSk7CgkJVW5pcXVlIHVuaXF1\nZUNvbnN0cmFpbnQgPSBuZXcgVW5pcXVlKCk7CgkJZm9yIChpbnQgaT0wOyBp\nPGNvbHVtbk5hbWVzLmxlbmd0aDsgaSsrKSB7CgkJCWlmIChTdHJpbmdVdGls\ncy5pc0VtcHR5KGNvbHVtbk5hbWVzW2ldKSkKCQkJCXRocm93IG5ldyBVc2Vy\nRXhjZXB0aW9uKF9sb2MuZ2V0KCJ1bmlxdWUtZW1wdHktY29sdW1uIiwgCgkJ\nCQkJCUFycmF5cy50b1N0cmluZyhjb2x1bW5OYW1lcyksIGN0eCkpOwoJCQlD\nb2x1bW4gY29sdW1uID0gbmV3IENvbHVtbigpOwoJCQljb2x1bW4uc2V0TmFt\nZShjb2x1bW5OYW1lc1tpXSk7CgkJCXVuaXF1ZUNvbnN0cmFpbnQuYWRkQ29s\ndW1uKGNvbHVtbik7CgkJfQoJCXJldHVybiB1bmlxdWVDb25zdHJhaW50Owog\nICAgfQogICAgCiAgICB2b2lkIGFkZFVuaXF1ZUNvbnN0cmFpbnRzKFN0cmlu\nZyB0YWJsZSwgTWV0YURhdGFDb250ZXh0IGN0eCwgCiAgICAJCU1hcHBpbmdJ\nbmZvIGluZm8sIFVuaXF1ZUNvbnN0cmFpbnQuLi51bmlxdWVDb25zdHJhaW50\ncykgewogICAgCWZvciAoVW5pcXVlQ29uc3RyYWludCBhbm5vIDogdW5pcXVl\nQ29uc3RyYWludHMpIHsKICAgIAkJVW5pcXVlIHVuaXF1ZSA9IGNyZWF0ZVVu\naXF1ZUNvbnN0cmFpbnQoY3R4LCBhbm5vKTsKICAgIAkJdW5pcXVlLnNldFRh\nYmxlTmFtZSh0YWJsZSk7CiAgICAJCWlmIChpbmZvIGluc3RhbmNlb2YgQ2xh\nc3NNYXBwaW5nSW5mbykKICAgIAkJCSgoQ2xhc3NNYXBwaW5nSW5mbylpbmZv\nKS5hZGRVbmlxdWUodGFibGUsIHVuaXF1ZSk7CiAgICAJCWVsc2UgaWYgKGlu\nZm8gaW5zdGFuY2VvZiBGaWVsZE1hcHBpbmdJbmZvKQogICAgCQkJKChGaWVs\nZE1hcHBpbmdJbmZvKWluZm8pLmFkZEpvaW5UYWJsZVVuaXF1ZSh1bmlxdWUp\nOwogICAgCQllbHNlCiAgICAJCQl0aHJvdyBuZXcgSW50ZXJuYWxFeGNlcHRp\nb24oKTsKICAgIAl9CiAgICB9CgogICAgLyoqCiAgICAgKiBGb3JtIGEgcXVh\nbGlmaWVkIHRhYmxlIG5hbWUgZnJvbSBhIHNjaGVtYSBhbmQgdGFibGUgbmFt\nZS4KICAgICAqLwogICAgcHJpdmF0ZSBzdGF0aWMgU3RyaW5nIHRvVGFibGVO\nYW1lKFN0cmluZyBzY2hlbWEsIFN0cmluZyB0YWJsZSkgewogICAgICAgIGlm\nIChTdHJpbmdVdGlscy5pc0VtcHR5KHRhYmxlKSkKICAgICAgICAgICAgcmV0\ndXJuIG51bGw7CiAgICAgICAgaWYgKFN0cmluZ1V0aWxzLmlzRW1wdHkoc2No\nZW1hKSkKICAgICAgICAgICAgcmV0dXJuIHRhYmxlOwogICAgICAgIHJldHVy\nbiBzY2hlbWEgKyAiLiIgKyB0YWJsZTsKICAgIH0KCiAgICAvKioKICAgICAq\nIFBhcnNlcyB0aGUgZ2l2ZW4gYW5ub3RhdGlvbiB0byBjcmVhdGUgYW5kIGNh\nY2hlIGEKICAgICAqIHtAbGluayBTUUxSZXN1bHRTZXRNYXBwaW5nTWV0YURh\ndGF9LgogICAgICovCiAgICBwcml2YXRlIHZvaWQgcGFyc2VTUUxSZXN1bHRT\nZXRNYXBwaW5ncyhDbGFzc01hcHBpbmcgY20sCiAgICAgICAgU3FsUmVzdWx0\nU2V0TWFwcGluZy4uLiBhbm5vcykgewogICAgICAgIE1hcHBpbmdSZXBvc2l0\nb3J5IHJlcG9zID0gKE1hcHBpbmdSZXBvc2l0b3J5KSBnZXRSZXBvc2l0b3J5\nKCk7CiAgICAgICAgTG9nIGxvZyA9IGdldExvZygpOwogICAgICAgIGZvciAo\nU3FsUmVzdWx0U2V0TWFwcGluZyBhbm5vIDogYW5ub3MpIHsKICAgICAgICAg\nICAgaWYgKGxvZy5pc1RyYWNlRW5hYmxlZCgpKQogICAgICAgICAgICAgICAg\nbG9nLnRyYWNlKF9sb2MuZ2V0KCJwYXJzZS1zcWxyc21hcHBpbmciLCBhbm5v\nLm5hbWUoKSkpOwoKICAgICAgICAgICAgUXVlcnlSZXN1bHRNYXBwaW5nIHJl\nc3VsdCA9IHJlcG9zLmdldENhY2hlZFF1ZXJ5UmVzdWx0TWFwcGluZwogICAg\nICAgICAgICAgICAgKG51bGwsIGFubm8ubmFtZSgpKTsKICAgICAgICAgICAg\naWYgKHJlc3VsdCAhPSBudWxsKSB7CiAgICAgICAgICAgICAgICBpZiAobG9n\nLmlzV2FybkVuYWJsZWQoKSkKICAgICAgICAgICAgICAgICAgICBsb2cud2Fy\nbihfbG9jLmdldCgiZHVwLXNxbHJzbWFwcGluZyIsIGFubm8ubmFtZSgpLCBj\nbSkpOwogICAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgIH0K\nCiAgICAgICAgICAgIHJlc3VsdCA9IHJlcG9zLmFkZFF1ZXJ5UmVzdWx0TWFw\ncGluZyhudWxsLCBhbm5vLm5hbWUoKSk7CiAgICAgICAgICAgIHJlc3VsdC5z\nZXRTb3VyY2UoZ2V0U291cmNlRmlsZSgpLCBjbS5nZXREZXNjcmliZWRUeXBl\nKCksCiAgICAgICAgICAgICAgICByZXN1bHQuU1JDX0FOTk9UQVRJT05TKTsK\nCiAgICAgICAgICAgIGZvciAoRW50aXR5UmVzdWx0IGVudGl0eSA6IGFubm8u\nZW50aXRpZXMoKSkgewogICAgICAgICAgICAgICAgUXVlcnlSZXN1bHRNYXBw\naW5nLlBDUmVzdWx0IGVudGl0eVJlc3VsdCA9IHJlc3VsdC5hZGRQQ1Jlc3Vs\ndAogICAgICAgICAgICAgICAgICAgIChlbnRpdHkuZW50aXR5Q2xhc3MoKSk7\nCiAgICAgICAgICAgICAgICBpZiAoIVN0cmluZ1V0aWxzLmlzRW1wdHkoZW50\naXR5LmRpc2NyaW1pbmF0b3JDb2x1bW4oKSkpCiAgICAgICAgICAgICAgICAg\nICAgZW50aXR5UmVzdWx0LmFkZE1hcHBpbmcoZW50aXR5UmVzdWx0LkRJU0NS\nSU1JTkFUT1IsCiAgICAgICAgICAgICAgICAgICAgICAgIGVudGl0eS5kaXNj\ncmltaW5hdG9yQ29sdW1uKCkpOwoKICAgICAgICAgICAgICAgIGZvciAoRmll\nbGRSZXN1bHQgZmllbGQgOiBlbnRpdHkuZmllbGRzKCkpCiAgICAgICAgICAg\nICAgICAgICAgZW50aXR5UmVzdWx0LmFkZE1hcHBpbmcoZmllbGQubmFtZSgp\nLCBmaWVsZC5jb2x1bW4oKSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAg\nZm9yIChDb2x1bW5SZXN1bHQgY29sdW1uIDogYW5uby5jb2x1bW5zKCkpCiAg\nICAgICAgICAgICAgICByZXN1bHQuYWRkQ29sdW1uUmVzdWx0KGNvbHVtbi5u\nYW1lKCkpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIFBhcnNl\nIEBEaXNjcmltaW5hdG9yQ29sdW1uLgogICAgICovCiAgICBwcml2YXRlIHZv\naWQgcGFyc2VEaXNjcmltaW5hdG9yQ29sdW1uKENsYXNzTWFwcGluZyBjbSwK\nICAgICAgICBEaXNjcmltaW5hdG9yQ29sdW1uIGRjb2wpIHsKICAgICAgICBD\nb2x1bW4gY29sID0gbmV3IENvbHVtbigpOwogICAgICAgIGlmICghU3RyaW5n\nVXRpbHMuaXNFbXB0eShkY29sLm5hbWUoKSkpCiAgICAgICAgICAgIGNvbC5z\nZXROYW1lKGRjb2wubmFtZSgpKTsKICAgICAgICBpZiAoIVN0cmluZ1V0aWxz\nLmlzRW1wdHkoZGNvbC5jb2x1bW5EZWZpbml0aW9uKCkpKQogICAgICAgICAg\nICBjb2wuc2V0VHlwZU5hbWUoZGNvbC5jb2x1bW5EZWZpbml0aW9uKCkpOwog\nICAgICAgIERpc2NyaW1pbmF0b3IgZGlzY3JpbSA9IGNtLmdldERpc2NyaW1p\nbmF0b3IoKTsKICAgICAgICBzd2l0Y2ggKGRjb2wuZGlzY3JpbWluYXRvclR5\ncGUoKSkgewogICAgICAgICAgICBjYXNlIENIQVI6CiAgICAgICAgICAgICAg\nICBjb2wuc2V0SmF2YVR5cGUoSmF2YVR5cGVzLkNIQVIpOwogICAgICAgICAg\nICAgICAgZGlzY3JpbS5zZXRKYXZhVHlwZShKYXZhVHlwZXMuQ0hBUik7CiAg\nICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSBJTlRFR0VS\nOgogICAgICAgICAgICAgICAgY29sLnNldEphdmFUeXBlKEphdmFUeXBlcy5J\nTlQpOwogICAgICAgICAgICAgICAgaWYgKGRjb2wubGVuZ3RoKCkgIT0gMzEp\nCiAgICAgICAgICAgICAgICAgICAgY29sLnNldFNpemUoZGNvbC5sZW5ndGgo\nKSk7CiAgICAgICAgICAgICAgICBkaXNjcmltLnNldEphdmFUeXBlKEphdmFU\neXBlcy5JTlQpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAg\nIGRlZmF1bHQ6CiAgICAgICAgICAgICAgICBjb2wuc2V0SmF2YVR5cGUoSmF2\nYVR5cGVzLlNUUklORyk7CiAgICAgICAgICAgICAgICBjb2wuc2V0U2l6ZShk\nY29sLmxlbmd0aCgpKTsKICAgICAgICAgICAgICAgIGRpc2NyaW0uc2V0SmF2\nYVR5cGUoSmF2YVR5cGVzLlNUUklORyk7CiAgICAgICAgfQogICAgICAgIGNt\nLmdldERpc2NyaW1pbmF0b3IoKS5nZXRNYXBwaW5nSW5mbygpLnNldENvbHVt\nbnMKICAgICAgICAgICAgKEFycmF5cy5hc0xpc3QobmV3IENvbHVtbltdeyBj\nb2wgfSkpOwogICAgfQoKICAgIC8qKgogICAgICogUGFyc2UgQEluaGVyaXRh\nbmNlLgogICAgICovCiAgICBwcml2YXRlIHZvaWQgcGFyc2VJbmhlcml0YW5j\nZShDbGFzc01hcHBpbmcgY20sIEluaGVyaXRhbmNlIGluaGVyaXQpIHsKICAg\nICAgICBDbGFzc01hcHBpbmdJbmZvIGluZm8gPSBjbS5nZXRNYXBwaW5nSW5m\nbygpOwogICAgICAgIHN3aXRjaCAoaW5oZXJpdC5zdHJhdGVneSgpKSB7CiAg\nICAgICAgICAgIGNhc2UgU0lOR0xFX1RBQkxFOgogICAgICAgICAgICAgICAg\naW5mby5zZXRIaWVyYXJjaHlTdHJhdGVneShGbGF0Q2xhc3NTdHJhdGVneS5B\nTElBUyk7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2Fz\nZSBKT0lORUQ6CiAgICAgICAgICAgICAgICBpbmZvLnNldEhpZXJhcmNoeVN0\ncmF0ZWd5KFZlcnRpY2FsQ2xhc3NTdHJhdGVneS5BTElBUyk7CiAgICAgICAg\nICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSBUQUJMRV9QRVJfQ0xB\nU1M6CiAgICAgICAgICAgICAgICBpbmZvLnNldEhpZXJhcmNoeVN0cmF0ZWd5\nKEZ1bGxDbGFzc1N0cmF0ZWd5LkFMSUFTKTsKICAgICAgICAgICAgICAgIGJy\nZWFrOwogICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgICAgdGhy\nb3cgbmV3IEludGVybmFsRXhjZXB0aW9uKCk7CiAgICAgICAgfQogICAgfQoK\nICAgIC8qKgogICAgICogUGFyc2UgY2xhc3MtbGV2ZWwgQE1hcHBpbmdPdmVy\ncmlkZShzKS4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIHBhcnNlTWFwcGlu\nZ092ZXJyaWRlcyhDbGFzc01hcHBpbmcgY20sCiAgICAgICAgTWFwcGluZ092\nZXJyaWRlLi4uIG92ZXJzKSB7CiAgICAgICAgRmllbGRNYXBwaW5nIHN1cDsK\nICAgICAgICBmb3IgKE1hcHBpbmdPdmVycmlkZSBvdmVyIDogb3ZlcnMpIHsK\nICAgICAgICAgICAgaWYgKFN0cmluZ1V0aWxzLmlzRW1wdHkob3Zlci5uYW1l\nKCkpKQogICAgICAgICAgICAgICAgdGhyb3cgbmV3IE1ldGFEYXRhRXhjZXB0\naW9uKF9sb2MuZ2V0KCJuby1vdmVycmlkZS1uYW1lIiwgY20pKTsKICAgICAg\nICAgICAgc3VwID0gKEZpZWxkTWFwcGluZykgY20uZ2V0RGVmaW5lZFN1cGVy\nY2xhc3NGaWVsZChvdmVyLm5hbWUoKSk7CiAgICAgICAgICAgIGlmIChzdXAg\nPT0gbnVsbCkKICAgICAgICAgICAgICAgIHN1cCA9IChGaWVsZE1hcHBpbmcp\nIGNtLmFkZERlZmluZWRTdXBlcmNsYXNzRmllbGQob3Zlci5uYW1lKCksCiAg\nICAgICAgICAgICAgICAgICAgT2JqZWN0LmNsYXNzLCBPYmplY3QuY2xhc3Mp\nOwogICAgICAgICAgICBwb3B1bGF0ZShzdXAsIG92ZXIpOwogICAgICAgIH0K\nICAgIH0KCiAgICAvKioKICAgICAqIFBvcHVsYXRlIHRoZSBnaXZlbiBmaWVs\nZCBmcm9tIG92ZXJyaWRlIGRhdGEuCiAgICAgKi8KICAgIHByaXZhdGUgdm9p\nZCBwb3B1bGF0ZShGaWVsZE1hcHBpbmcgZm0sIE1hcHBpbmdPdmVycmlkZSBv\ndmVyKSB7CiAgICAgICAgaWYgKG92ZXIuY29udGFpbmVyVGFibGUoKS5zcGVj\naWZpZWQoKSkKICAgICAgICAgICAgcGFyc2VDb250YWluZXJUYWJsZShmbSwg\nb3Zlci5jb250YWluZXJUYWJsZSgpKTsKICAgICAgICBwYXJzZUNvbHVtbnMo\nZm0sIG92ZXIuY29sdW1ucygpKTsKICAgICAgICBwYXJzZVhKb2luQ29sdW1u\ncyhmbSwgZm0uZ2V0VmFsdWVJbmZvKCksIHRydWUsIG92ZXIuam9pbkNvbHVt\nbnMoKSk7CiAgICAgICAgcGFyc2VFbGVtZW50Sm9pbkNvbHVtbnMoZm0sIG92\nZXIuZWxlbWVudEpvaW5Db2x1bW5zKCkpOwogICAgfQoKICAgIC8qKgogICAg\nICogUGFyc2UgZGF0YXN0b3JlIGlkZW50aXR5IGluZm9ybWF0aW9uIGluIEBE\nYXRhU3RvcmVJZENvbHVtbi4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIHBh\ncnNlRGF0YVN0b3JlSWRDb2x1bW4oQ2xhc3NNYXBwaW5nIGNtLCBEYXRhU3Rv\ncmVJZENvbHVtbiBpZCkgewogICAgICAgIENvbHVtbiBjb2wgPSBuZXcgQ29s\ndW1uKCk7CiAgICAgICAgaWYgKCFTdHJpbmdVdGlscy5pc0VtcHR5KGlkLm5h\nbWUoKSkpCiAgICAgICAgICAgIGNvbC5zZXROYW1lKGlkLm5hbWUoKSk7CiAg\nICAgICAgaWYgKCFTdHJpbmdVdGlscy5pc0VtcHR5KGlkLmNvbHVtbkRlZmlu\naXRpb24oKSkpCiAgICAgICAgICAgIGNvbC5zZXRUeXBlTmFtZShpZC5jb2x1\nbW5EZWZpbml0aW9uKCkpOwogICAgICAgIGlmIChpZC5wcmVjaXNpb24oKSAh\nPSAwKQogICAgICAgICAgICBjb2wuc2V0U2l6ZShpZC5wcmVjaXNpb24oKSk7\nCiAgICAgICAgY29sLnNldEZsYWcoQ29sdW1uLkZMQUdfVU5JTlNFUlRBQkxF\nLCAhaWQuaW5zZXJ0YWJsZSgpKTsKICAgICAgICBjb2wuc2V0RmxhZyhDb2x1\nbW4uRkxBR19VTlVQREFUQUJMRSwgIWlkLnVwZGF0YWJsZSgpKTsKICAgICAg\nICBjbS5nZXRNYXBwaW5nSW5mbygpLnNldENvbHVtbnMoQXJyYXlzLmFzTGlz\ndChuZXcgQ29sdW1uW117IGNvbCB9KSk7CiAgICB9CgogICAgLyoqCiAgICAg\nKiBQYXJzZSB0aGUgZ2l2ZW4gZm9yZWlnbiBrZXkuCiAgICAgKi8KICAgIHBy\naXZhdGUgdm9pZCBwYXJzZUZvcmVpZ25LZXkoTWFwcGluZ0luZm8gaW5mbywg\nRm9yZWlnbktleSBmaykgewogICAgICAgIHBhcnNlRm9yZWlnbktleShpbmZv\nLCBmay5uYW1lKCksIGZrLmVuYWJsZWQoKSwgZmsuZGVmZXJyZWQoKSwKICAg\nICAgICAgICAgZmsuZGVsZXRlQWN0aW9uKCksIGZrLnVwZGF0ZUFjdGlvbigp\nKTsKICAgIH0KCiAgICAvKioKICAgICAqIFNldCBmb3JlaWduIGtleSBkYXRh\nIG9uIHRoZSBnaXZlbiBtYXBwaW5nIGluZm8uCiAgICAgKi8KICAgIHByb3Rl\nY3RlZCB2b2lkIHBhcnNlRm9yZWlnbktleShNYXBwaW5nSW5mbyBpbmZvLCBT\ndHJpbmcgbmFtZSwKICAgICAgICBib29sZWFuIGVuYWJsZWQsIGJvb2xlYW4g\nZGVmZXJyZWQsIEZvcmVpZ25LZXlBY3Rpb24gZGVsZXRlQWN0aW9uLAogICAg\nICAgIEZvcmVpZ25LZXlBY3Rpb24gdXBkYXRlQWN0aW9uKSB7CiAgICAgICAg\naWYgKCFlbmFibGVkKSB7CiAgICAgICAgICAgIGluZm8uc2V0Q2FuRm9yZWln\nbktleShmYWxzZSk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9Cgog\nICAgICAgIG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNjaGVtYS5Gb3JlaWdu\nS2V5IGZrID0KICAgICAgICAgICAgbmV3IG9yZy5hcGFjaGUub3BlbmpwYS5q\nZGJjLnNjaGVtYS5Gb3JlaWduS2V5KCk7CiAgICAgICAgaWYgKCFTdHJpbmdV\ndGlscy5pc0VtcHR5KG5hbWUpKQogICAgICAgICAgICBmay5zZXROYW1lKG5h\nbWUpOwogICAgICAgIGZrLnNldERlZmVycmVkKGRlZmVycmVkKTsKICAgICAg\nICBmay5zZXREZWxldGVBY3Rpb24odG9Gb3JlaWduS2V5QWN0aW9uKGRlbGV0\nZUFjdGlvbikpOwogICAgICAgIGZrLnNldFVwZGF0ZUFjdGlvbih0b0ZvcmVp\nZ25LZXlBY3Rpb24odXBkYXRlQWN0aW9uKSk7CiAgICAgICAgaW5mby5zZXRG\nb3JlaWduS2V5KGZrKTsKICAgIH0KCiAgICAvKioKICAgICAqIENvbnZlcnQg\nb3VyIEZLIGFjdGlvbiBlbnVtIHRvIGFuIGludGVybmFsIE9wZW5KUEEgYWN0\naW9uLgogICAgICovCiAgICBwcml2YXRlIGludCB0b0ZvcmVpZ25LZXlBY3Rp\nb24oRm9yZWlnbktleUFjdGlvbiBhY3Rpb24pIHsKICAgICAgICBzd2l0Y2gg\nKGFjdGlvbikgewogICAgICAgICAgICBjYXNlIFJFU1RSSUNUOgogICAgICAg\nICAgICAgICAgcmV0dXJuIG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLnNjaGVt\nYS5Gb3JlaWduS2V5LkFDVElPTl9SRVNUUklDVDsKICAgICAgICAgICAgY2Fz\nZSBDQVNDQURFOgogICAgICAgICAgICAgICAgcmV0dXJuIG9yZy5hcGFjaGUu\nb3BlbmpwYS5qZGJjLnNjaGVtYS5Gb3JlaWduS2V5LkFDVElPTl9DQVNDQURF\nOwogICAgICAgICAgICBjYXNlIE5VTEw6CiAgICAgICAgICAgICAgICByZXR1\ncm4gb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMuc2NoZW1hLkZvcmVpZ25LZXku\nQUNUSU9OX05VTEw7CiAgICAgICAgICAgIGNhc2UgREVGQVVMVDoKICAgICAg\nICAgICAgICAgIHJldHVybiBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hl\nbWEuRm9yZWlnbktleS5BQ1RJT05fREVGQVVMVDsKICAgICAgICAgICAgZGVm\nYXVsdDoKICAgICAgICAgICAgICAgIHRocm93IG5ldyBJbnRlcm5hbEV4Y2Vw\ndGlvbigpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIFBhcnNl\nIHRoZSBnaXZlbiBpbmRleC4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIHBh\ncnNlSW5kZXgoTWFwcGluZ0luZm8gaW5mbywgSW5kZXggaWR4KSB7CiAgICAg\nICAgcGFyc2VJbmRleChpbmZvLCBpZHgubmFtZSgpLCBpZHguZW5hYmxlZCgp\nLCBpZHgudW5pcXVlKCkpOwogICAgfQoKICAgIC8qKgogICAgICogU2V0IGlu\nZGV4IGRhdGEgb24gdGhlIGdpdmVuIG1hcHBpbmcgaW5mby4KICAgICAqLwog\nICAgcHJvdGVjdGVkIHZvaWQgcGFyc2VJbmRleChNYXBwaW5nSW5mbyBpbmZv\nLCBTdHJpbmcgbmFtZSwKICAgICAgICBib29sZWFuIGVuYWJsZWQsIGJvb2xl\nYW4gdW5pcXVlKSB7CiAgICAgICAgaWYgKCFlbmFibGVkKSB7CiAgICAgICAg\nICAgIGluZm8uc2V0Q2FuSW5kZXgoZmFsc2UpOwogICAgICAgICAgICByZXR1\ncm47CiAgICAgICAgfQoKICAgICAgICBvcmcuYXBhY2hlLm9wZW5qcGEuamRi\nYy5zY2hlbWEuSW5kZXggaWR4ID0KICAgICAgICAgICAgbmV3IG9yZy5hcGFj\naGUub3BlbmpwYS5qZGJjLnNjaGVtYS5JbmRleCgpOwogICAgICAgIGlmICgh\nU3RyaW5nVXRpbHMuaXNFbXB0eShuYW1lKSkKICAgICAgICAgICAgaWR4LnNl\ndE5hbWUobmFtZSk7CiAgICAgICAgaWR4LnNldFVuaXF1ZSh1bmlxdWUpOwog\nICAgICAgIGluZm8uc2V0SW5kZXgoaWR4KTsKICAgIH0KCiAgICAvKioKICAg\nICAqIFNldCB1bmlxdWUgZGF0YSBvbiB0aGUgZ2l2ZW4gbWFwcGluZyBpbmZv\nLgogICAgICovCiAgICBwcml2YXRlIHZvaWQgcGFyc2VVbmlxdWUoRmllbGRN\nYXBwaW5nIGZtLCAKICAgICAgICBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lz\ndGVuY2UuamRiYy5VbmlxdWUgYW5ubykgewogICAgICAgIFZhbHVlTWFwcGlu\nZ0luZm8gaW5mbyA9IGZtLmdldFZhbHVlSW5mbygpOwogICAgICAgIGlmICgh\nYW5uby5lbmFibGVkKCkpIHsKICAgICAgICAgICAgaW5mby5zZXRDYW5Vbmlx\ndWUoZmFsc2UpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAg\nICAgICBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5zY2hlbWEuVW5pcXVlIHVu\ncSA9IAogICAgICAgICAgICBuZXcgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMu\nc2NoZW1hLlVuaXF1ZSgpOwogICAgICAgIGlmICghU3RyaW5nVXRpbHMuaXNF\nbXB0eShhbm5vLm5hbWUoKSkpCiAgICAgICAgICAgIHVucS5zZXROYW1lKGFu\nbm8ubmFtZSgpKTsKICAgICAgICB1bnEuc2V0RGVmZXJyZWQoYW5uby5kZWZl\ncnJlZCgpKTsKICAgICAgICBpbmZvLnNldFVuaXF1ZSh1bnEpOwogICAgfQoK\nICAgIC8qKgogICAgICogUGFyc2UgQFZlcnNpb25Db2x1bW4ocykuCiAgICAg\nKi8KICAgIHByaXZhdGUgdm9pZCBwYXJzZVZlcnNpb25Db2x1bW5zKENsYXNz\nTWFwcGluZyBjbSwgVmVyc2lvbkNvbHVtbi4uLiB2Y29scykgewogICAgICAg\nIGlmICh2Y29scy5sZW5ndGggPT0gMCkKICAgICAgICAgICAgcmV0dXJuOwoK\nICAgICAgICBMaXN0PENvbHVtbj4gY29scyA9IG5ldyBBcnJheUxpc3Q8Q29s\ndW1uPih2Y29scy5sZW5ndGgpOwogICAgICAgIGZvciAoVmVyc2lvbkNvbHVt\nbiB2Y29sIDogdmNvbHMpCiAgICAgICAgICAgIGNvbHMuYWRkKG5ld0NvbHVt\nbih2Y29sKSk7CiAgICAgICAgY20uZ2V0VmVyc2lvbigpLmdldE1hcHBpbmdJ\nbmZvKCkuc2V0Q29sdW1ucyhjb2xzKTsKICAgIH0KCiAgICAvKioKICAgICAq\nIENyZWF0ZSBhIG5ldyBzY2hlbWEgY29sdW1uIHdpdGggaW5mb3JtYXRpb24g\nZnJvbSB0aGUgZ2l2ZW4gYW5ub3RhdGlvbi4KICAgICAqLwogICAgcHJpdmF0\nZSBzdGF0aWMgQ29sdW1uIG5ld0NvbHVtbihWZXJzaW9uQ29sdW1uIGFubm8p\nIHsKICAgICAgICBDb2x1bW4gY29sID0gbmV3IENvbHVtbigpOwogICAgICAg\nIGlmICghU3RyaW5nVXRpbHMuaXNFbXB0eShhbm5vLm5hbWUoKSkpCiAgICAg\nICAgICAgIGNvbC5zZXROYW1lKGFubm8ubmFtZSgpKTsKICAgICAgICBpZiAo\nIVN0cmluZ1V0aWxzLmlzRW1wdHkoYW5uby5jb2x1bW5EZWZpbml0aW9uKCkp\nKQogICAgICAgICAgICBjb2wuc2V0VHlwZU5hbWUoYW5uby5jb2x1bW5EZWZp\nbml0aW9uKCkpOwogICAgICAgIGlmIChhbm5vLnByZWNpc2lvbigpICE9IDAp\nCiAgICAgICAgICAgIGNvbC5zZXRTaXplKGFubm8ucHJlY2lzaW9uKCkpOwog\nICAgICAgIGVsc2UgaWYgKGFubm8ubGVuZ3RoKCkgIT0gMjU1KQogICAgICAg\nICAgICBjb2wuc2V0U2l6ZShhbm5vLmxlbmd0aCgpKTsKICAgICAgICBjb2wu\nc2V0Tm90TnVsbCghYW5uby5udWxsYWJsZSgpKTsKICAgICAgICBjb2wuc2V0\nRGVjaW1hbERpZ2l0cyhhbm5vLnNjYWxlKCkpOwogICAgICAgIGNvbC5zZXRG\nbGFnKENvbHVtbi5GTEFHX1VOSU5TRVJUQUJMRSwgIWFubm8uaW5zZXJ0YWJs\nZSgpKTsKICAgICAgICBjb2wuc2V0RmxhZyhDb2x1bW4uRkxBR19VTlVQREFU\nQUJMRSwgIWFubm8udXBkYXRhYmxlKCkpOwogICAgICAgIHJldHVybiBjb2w7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBQYXJzZSBjbGFzcy1sZXZlbCBAWE1h\ncHBpbmdPdmVycmlkZShzKS4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIHBh\ncnNlTWFwcGluZ092ZXJyaWRlcyhDbGFzc01hcHBpbmcgY20sCiAgICAgICAg\nWE1hcHBpbmdPdmVycmlkZS4uLiBvdmVycykgewogICAgICAgIEZpZWxkTWFw\ncGluZyBzdXA7CiAgICAgICAgZm9yIChYTWFwcGluZ092ZXJyaWRlIG92ZXIg\nOiBvdmVycykgewogICAgICAgICAgICBpZiAoU3RyaW5nVXRpbHMuaXNFbXB0\neShvdmVyLm5hbWUoKSkpCiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgTWV0\nYURhdGFFeGNlcHRpb24oX2xvYy5nZXQoIm5vLW92ZXJyaWRlLW5hbWUiLCBj\nbSkpOwogICAgICAgICAgICBzdXAgPSAoRmllbGRNYXBwaW5nKSBjbS5nZXRE\nZWZpbmVkU3VwZXJjbGFzc0ZpZWxkKG92ZXIubmFtZSgpKTsKICAgICAgICAg\nICAgaWYgKHN1cCA9PSBudWxsKQogICAgICAgICAgICAgICAgc3VwID0gKEZp\nZWxkTWFwcGluZykgY20uYWRkRGVmaW5lZFN1cGVyY2xhc3NGaWVsZChvdmVy\nLm5hbWUoKSwKICAgICAgICAgICAgICAgICAgICBPYmplY3QuY2xhc3MsIE9i\namVjdC5jbGFzcyk7CiAgICAgICAgICAgIHBvcHVsYXRlKHN1cCwgb3Zlcik7\nCiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogUG9wdWxhdGUgdGhl\nIGdpdmVuIGZpZWxkIGZyb20gb3ZlcnJpZGUgZGF0YS4KICAgICAqLwogICAg\ncHJpdmF0ZSB2b2lkIHBvcHVsYXRlKEZpZWxkTWFwcGluZyBmbSwgWE1hcHBp\nbmdPdmVycmlkZSBvdmVyKSB7CiAgICAgICAgaWYgKG92ZXIuY29udGFpbmVy\nVGFibGUoKS5zcGVjaWZpZWQoKSkKICAgICAgICAgICAgcGFyc2VDb250YWlu\nZXJUYWJsZShmbSwgb3Zlci5jb250YWluZXJUYWJsZSgpKTsKICAgICAgICBw\nYXJzZUNvbHVtbnMoZm0sIG92ZXIuY29sdW1ucygpKTsKICAgICAgICBwYXJz\nZVhKb2luQ29sdW1ucyhmbSwgZm0uZ2V0VmFsdWVJbmZvKCksIHRydWUsIG92\nZXIuam9pbkNvbHVtbnMoKSk7CiAgICAgICAgcGFyc2VFbGVtZW50Q29sdW1u\ncyhmbSwgb3Zlci5lbGVtZW50Q29sdW1ucygpKTsKICAgICAgICBwYXJzZUVs\nZW1lbnRKb2luQ29sdW1ucyhmbSwgb3Zlci5lbGVtZW50Sm9pbkNvbHVtbnMo\nKSk7CiAgICAgICAgcGFyc2VLZXlDb2x1bW5zKGZtLCBvdmVyLmtleUNvbHVt\nbnMoKSk7CiAgICAgICAgcGFyc2VLZXlKb2luQ29sdW1ucyhmbSwgb3Zlci5r\nZXlKb2luQ29sdW1ucygpKTsKICAgIH0KCiAgICAvKioKICAgICAqIFBhcnNl\nIEBFbGVtZW50Q29sdW1uKHMpLgogICAgICovCiAgICBwcml2YXRlIHZvaWQg\ncGFyc2VFbGVtZW50Q29sdW1ucyhGaWVsZE1hcHBpbmcgZm0sIEVsZW1lbnRD\nb2x1bW4uLi4gcGNvbHMpIHsKICAgICAgICBpZiAocGNvbHMubGVuZ3RoID09\nIDApCiAgICAgICAgICAgIHJldHVybjsKCiAgICAgICAgTGlzdDxDb2x1bW4+\nIGNvbHMgPSBuZXcgQXJyYXlMaXN0PENvbHVtbj4ocGNvbHMubGVuZ3RoKTsK\nICAgICAgICBpbnQgdW5pcXVlID0gMDsKICAgICAgICBmb3IgKGludCBpID0g\nMDsgaSA8IHBjb2xzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGNvbHMu\nYWRkKG5ld0NvbHVtbihwY29sc1tpXSkpOwogICAgICAgICAgICB1bmlxdWUg\nfD0gKHBjb2xzW2ldLnVuaXF1ZSgpKSA/IFRSVUUgOiBGQUxTRTsKICAgICAg\nICB9CiAgICAgICAgc2V0Q29sdW1ucyhmbSwgZm0uZ2V0RWxlbWVudE1hcHBp\nbmcoKS5nZXRWYWx1ZUluZm8oKSwgY29scywgdW5pcXVlKTsKICAgIH0KCiAg\nICAvKioKICAgICAqIENyZWF0ZSBhIG5ldyBzY2hlbWEgY29sdW1uIHdpdGgg\naW5mb3JtYXRpb24gZnJvbSB0aGUgZ2l2ZW4gYW5ub3RhdGlvbi4KICAgICAq\nLwogICAgcHJpdmF0ZSBzdGF0aWMgQ29sdW1uIG5ld0NvbHVtbihFbGVtZW50\nQ29sdW1uIGFubm8pIHsKICAgICAgICBDb2x1bW4gY29sID0gbmV3IENvbHVt\nbigpOwogICAgICAgIGlmICghU3RyaW5nVXRpbHMuaXNFbXB0eShhbm5vLm5h\nbWUoKSkpCiAgICAgICAgICAgIGNvbC5zZXROYW1lKGFubm8ubmFtZSgpKTsK\nICAgICAgICBpZiAoIVN0cmluZ1V0aWxzLmlzRW1wdHkoYW5uby5jb2x1bW5E\nZWZpbml0aW9uKCkpKQogICAgICAgICAgICBjb2wuc2V0VHlwZU5hbWUoYW5u\nby5jb2x1bW5EZWZpbml0aW9uKCkpOwogICAgICAgIGlmIChhbm5vLnByZWNp\nc2lvbigpICE9IDApCiAgICAgICAgICAgIGNvbC5zZXRTaXplKGFubm8ucHJl\nY2lzaW9uKCkpOwogICAgICAgIGVsc2UgaWYgKGFubm8ubGVuZ3RoKCkgIT0g\nMjU1KQogICAgICAgICAgICBjb2wuc2V0U2l6ZShhbm5vLmxlbmd0aCgpKTsK\nICAgICAgICBjb2wuc2V0Tm90TnVsbCghYW5uby5udWxsYWJsZSgpKTsKICAg\nICAgICBjb2wuc2V0RGVjaW1hbERpZ2l0cyhhbm5vLnNjYWxlKCkpOwogICAg\nICAgIGNvbC5zZXRGbGFnKENvbHVtbi5GTEFHX1VOSU5TRVJUQUJMRSwgIWFu\nbm8uaW5zZXJ0YWJsZSgpKTsKICAgICAgICBjb2wuc2V0RmxhZyhDb2x1bW4u\nRkxBR19VTlVQREFUQUJMRSwgIWFubm8udXBkYXRhYmxlKCkpOwogICAgICAg\nIHJldHVybiBjb2w7CiAgICB9CgogICAgLyoqCiAgICAgKiBQYXJzZSBAS2V5\nSm9pbkNvbHVtbihzKS4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIHBhcnNl\nS2V5Sm9pbkNvbHVtbnMoRmllbGRNYXBwaW5nIGZtLCBLZXlKb2luQ29sdW1u\nLi4uIGpvaW5zKSB7CiAgICAgICAgaWYgKGpvaW5zLmxlbmd0aCA9PSAwKQog\nICAgICAgICAgICByZXR1cm47CgogICAgICAgIExpc3Q8Q29sdW1uPiBjb2xz\nID0gbmV3IEFycmF5TGlzdDxDb2x1bW4+KGpvaW5zLmxlbmd0aCk7CiAgICAg\nICAgaW50IHVuaXF1ZSA9IDA7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkg\nPCBqb2lucy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBjb2xzLmFkZChu\nZXdDb2x1bW4oam9pbnNbaV0pKTsKICAgICAgICAgICAgdW5pcXVlIHw9IChq\nb2luc1tpXS51bmlxdWUoKSkgPyBUUlVFIDogRkFMU0U7CiAgICAgICAgfQog\nICAgICAgIHNldENvbHVtbnMoZm0sIGZtLmdldEtleU1hcHBpbmcoKS5nZXRW\nYWx1ZUluZm8oKSwgY29scywgdW5pcXVlKTsKICAgIH0KCiAgICAvKioKICAg\nICAqICBDcmVhdGUgYSBuZXcgc2NoZW1hIGNvbHVtbiB3aXRoIGluZm9ybWF0\naW9uIGZyb20gdGhlIGdpdmVuIGFubm90YXRpb24uCiAgICAgKi8KICAgIHBy\naXZhdGUgc3RhdGljIENvbHVtbiBuZXdDb2x1bW4oS2V5Sm9pbkNvbHVtbiBq\nb2luKSB7CiAgICAgICAgQ29sdW1uIGNvbCA9IG5ldyBDb2x1bW4oKTsKICAg\nICAgICBpZiAoIVN0cmluZ1V0aWxzLmlzRW1wdHkoam9pbi5uYW1lKCkpKQog\nICAgICAgICAgICBjb2wuc2V0TmFtZShqb2luLm5hbWUoKSk7CiAgICAgICAg\naWYgKCFTdHJpbmdVdGlscy5pc0VtcHR5KGpvaW4uY29sdW1uRGVmaW5pdGlv\nbigpKSkKICAgICAgICAgICAgY29sLnNldE5hbWUoam9pbi5jb2x1bW5EZWZp\nbml0aW9uKCkpOwogICAgICAgIGlmICghU3RyaW5nVXRpbHMuaXNFbXB0eShq\nb2luLnJlZmVyZW5jZWRDb2x1bW5OYW1lKCkpKQogICAgICAgICAgICBjb2wu\nc2V0VGFyZ2V0KGpvaW4ucmVmZXJlbmNlZENvbHVtbk5hbWUoKSk7CiAgICAg\nICAgaWYgKCFTdHJpbmdVdGlscy5pc0VtcHR5KGpvaW4ucmVmZXJlbmNlZEF0\ndHJpYnV0ZU5hbWUoKSkpCiAgICAgICAgICAgIGNvbC5zZXRUYXJnZXRGaWVs\nZChqb2luLnJlZmVyZW5jZWRBdHRyaWJ1dGVOYW1lKCkpOwogICAgICAgIGNv\nbC5zZXROb3ROdWxsKCFqb2luLm51bGxhYmxlKCkpOwogICAgICAgIGNvbC5z\nZXRGbGFnKENvbHVtbi5GTEFHX1VOSU5TRVJUQUJMRSwgIWpvaW4uaW5zZXJ0\nYWJsZSgpKTsKICAgICAgICBjb2wuc2V0RmxhZyhDb2x1bW4uRkxBR19VTlVQ\nREFUQUJMRSwgIWpvaW4udXBkYXRhYmxlICgpKTsKICAgICAgICByZXR1cm4g\nY29sOwogICAgfQogICAgCiAgICAvKioKICAgICAqIFRyYW5zbGF0ZSB0aGUg\nZmV0Y2ggbW9kZSBlbnVtIHZhbHVlIHRvIHRoZSBpbnRlcm5hbCBPcGVuSlBB\nIGNvbnN0YW50LgogICAgICovCiAgICBwcml2YXRlIHN0YXRpYyBpbnQgdG9F\nYWdlckZldGNoTW9kZUNvbnN0YW50KEZldGNoTW9kZSBtb2RlKSB7CiAgICAg\nICAgc3dpdGNoIChtb2RlKSB7CiAgICAgICAgICAgIGNhc2UgTk9ORToKICAg\nICAgICAgICAgICAgIHJldHVybiBFYWdlckZldGNoTW9kZXMuRUFHRVJfTk9O\nRTsKICAgICAgICAgICAgY2FzZSBKT0lOOgogICAgICAgICAgICAgICAgcmV0\ndXJuIEVhZ2VyRmV0Y2hNb2Rlcy5FQUdFUl9KT0lOOwogICAgICAgICAgICBj\nYXNlIFBBUkFMTEVMOgogICAgICAgICAgICAgICAgcmV0dXJuIEVhZ2VyRmV0\nY2hNb2Rlcy5FQUdFUl9QQVJBTExFTDsKICAgICAgICAgICAgZGVmYXVsdDoK\nICAgICAgICAgICAgICAgIHRocm93IG5ldyBJbnRlcm5hbEV4Y2VwdGlvbigp\nOwogICAgICAgIH0KICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHByb3RlY3Rl\nZCB2b2lkIHBhcnNlTG9iTWFwcGluZyhGaWVsZE1ldGFEYXRhIGZtZCkgewog\nICAgICAgIENvbHVtbiBjb2wgPSBuZXcgQ29sdW1uKCk7CiAgICAgICAgaWYg\nKGZtZC5nZXREZWNsYXJlZFR5cGVDb2RlKCkgPT0gSmF2YVR5cGVzLlNUUklO\nRwogICAgICAgICAgICB8fCBmbWQuZ2V0RGVjbGFyZWRUeXBlKCkgPT0gY2hh\ncltdLmNsYXNzCiAgICAgICAgICAgIHx8IGZtZC5nZXREZWNsYXJlZFR5cGUo\nKSA9PSBDaGFyYWN0ZXJbXS5jbGFzcykKICAgICAgICAgICAgY29sLnNldFR5\ncGUoVHlwZXMuQ0xPQik7CiAgICAgICAgZWxzZQogICAgICAgICAgICBjb2wu\nc2V0VHlwZShUeXBlcy5CTE9CKTsKICAgICAgICAoKEZpZWxkTWFwcGluZykg\nZm1kKS5nZXRWYWx1ZUluZm8oKS5zZXRDb2x1bW5zKEFycmF5cy5hc0xpc3QK\nICAgICAgICAgICAgKG5ldyBDb2x1bW5bXXsgY29sIH0pKTsKICAgIH0KCiAg\nICBAT3ZlcnJpZGUKICAgIHByb3RlY3RlZCB2b2lkIHBhcnNlTWVtYmVyTWFw\ncGluZ0Fubm90YXRpb25zKEZpZWxkTWV0YURhdGEgZm1kKSB7CiAgICAgICAg\nRmllbGRNYXBwaW5nIGZtID0gKEZpZWxkTWFwcGluZykgZm1kOwogICAgICAg\nIEFubm90YXRlZEVsZW1lbnQgZWwgPSAoQW5ub3RhdGVkRWxlbWVudCkgZ2V0\nUmVwb3NpdG9yeSgpLgogICAgICAgICAgICBnZXRNZXRhRGF0YUZhY3Rvcnko\nKS5nZXREZWZhdWx0cygpLmdldEJhY2tpbmdNZW1iZXIoZm1kKTsKCiAgICAg\nICAgTWFwcGluZ1RhZyB0YWc7CiAgICAgICAgZm9yIChBbm5vdGF0aW9uIGFu\nbm8gOiBlbC5nZXREZWNsYXJlZEFubm90YXRpb25zKCkpIHsKICAgICAgICAg\nICAgdGFnID0gX3RhZ3MuZ2V0KGFubm8uYW5ub3RhdGlvblR5cGUoKSk7CiAg\nICAgICAgICAgIGlmICh0YWcgPT0gbnVsbCkgewogICAgICAgICAgICAgICAg\naGFuZGxlVW5rbm93bk1lbWJlck1hcHBpbmdBbm5vdGF0aW9uKGZtLCBhbm5v\nKTsKICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICB9Cgog\nICAgICAgICAgICBzd2l0Y2ggKHRhZykgewogICAgICAgICAgICAgICAgY2Fz\nZSBBU1NPQ19PVkVSUklERToKICAgICAgICAgICAgICAgICAgICBwYXJzZUFz\nc29jaWF0aW9uT3ZlcnJpZGVzKGZtLCAoQXNzb2NpYXRpb25PdmVycmlkZSkg\nYW5ubyk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAg\nICAgICBjYXNlIEFTU09DX09WRVJSSURFUzoKICAgICAgICAgICAgICAgICAg\nICBwYXJzZUFzc29jaWF0aW9uT3ZlcnJpZGVzKGZtLCAoKEFzc29jaWF0aW9u\nT3ZlcnJpZGVzKSBhbm5vKS4KICAgICAgICAgICAgICAgICAgICAgICAgdmFs\ndWUoKSk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAg\nICAgICBjYXNlIEFUVFJfT1ZFUlJJREU6CiAgICAgICAgICAgICAgICAgICAg\ncGFyc2VBdHRyaWJ1dGVPdmVycmlkZXMoZm0sIChBdHRyaWJ1dGVPdmVycmlk\nZSkgYW5ubyk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAg\nICAgICAgICBjYXNlIEFUVFJfT1ZFUlJJREVTOgogICAgICAgICAgICAgICAg\nICAgIHBhcnNlQXR0cmlidXRlT3ZlcnJpZGVzKGZtLCAoKEF0dHJpYnV0ZU92\nZXJyaWRlcykgYW5ubykuCiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVl\nKCkpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAg\nICAgY2FzZSBDT0w6CiAgICAgICAgICAgICAgICAgICAgcGFyc2VDb2x1bW5z\nKGZtLCAoamF2YXgucGVyc2lzdGVuY2UuQ29sdW1uKSBhbm5vKTsKICAgICAg\nICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgQ09M\nUzoKICAgICAgICAgICAgICAgICAgICBwYXJzZUNvbHVtbnMoZm0sICgoQ29s\ndW1ucykgYW5ubykudmFsdWUoKSk7CiAgICAgICAgICAgICAgICAgICAgYnJl\nYWs7CiAgICAgICAgICAgICAgICBjYXNlIEVOVU1FUkFURUQ6CiAgICAgICAg\nICAgICAgICAgICAgcGFyc2VFbnVtZXJhdGVkKGZtLCAoRW51bWVyYXRlZCkg\nYW5ubyk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAg\nICAgICBjYXNlIEpPSU5fQ09MOgogICAgICAgICAgICAgICAgICAgIHBhcnNl\nSm9pbkNvbHVtbnMoZm0sIGZtLmdldFZhbHVlSW5mbygpLCB0cnVlLAogICAg\nICAgICAgICAgICAgICAgICAgICAoSm9pbkNvbHVtbikgYW5ubyk7CiAgICAg\nICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIEpP\nSU5fQ09MUzoKICAgICAgICAgICAgICAgICAgICBwYXJzZUpvaW5Db2x1bW5z\nKGZtLCBmbS5nZXRWYWx1ZUluZm8oKSwgdHJ1ZSwKICAgICAgICAgICAgICAg\nICAgICAgICAgKChKb2luQ29sdW1ucykgYW5ubykudmFsdWUoKSk7CiAgICAg\nICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIEpP\nSU5fVEFCTEU6CiAgICAgICAgICAgICAgICAgICAgcGFyc2VKb2luVGFibGUo\nZm0sIChKb2luVGFibGUpIGFubm8pOwogICAgICAgICAgICAgICAgICAgIGJy\nZWFrOwogICAgICAgICAgICAgICAgY2FzZSBLRVlfQ0xBU1NfQ1JJVDoKICAg\nICAgICAgICAgICAgICAgICBmbS5nZXRLZXlNYXBwaW5nKCkuZ2V0VmFsdWVJ\nbmZvKCkuc2V0VXNlQ2xhc3NDcml0ZXJpYQogICAgICAgICAgICAgICAgICAg\nICAgICAoKChLZXlDbGFzc0NyaXRlcmlhKSBhbm5vKS52YWx1ZSgpKTsKICAg\nICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2Ug\nS0VZX0NPTDoKICAgICAgICAgICAgICAgICAgICBwYXJzZUtleUNvbHVtbnMo\nZm0sIChLZXlDb2x1bW4pIGFubm8pOwogICAgICAgICAgICAgICAgICAgIGJy\nZWFrOwogICAgICAgICAgICAgICAgY2FzZSBLRVlfQ09MUzoKICAgICAgICAg\nICAgICAgICAgICBwYXJzZUtleUNvbHVtbnMoZm0sICgoS2V5Q29sdW1ucykg\nYW5ubykudmFsdWUoKSk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAg\nICAgICAgICAgICAgICBjYXNlIEtFWV9FTUJFRERFRF9NQVBQSU5HOgogICAg\nICAgICAgICAgICAgICAgIEtleUVtYmVkZGVkTWFwcGluZyBrZW1iZWQgPSAo\nS2V5RW1iZWRkZWRNYXBwaW5nKSBhbm5vOwogICAgICAgICAgICAgICAgICAg\nIHBhcnNlRW1iZWRkZWRNYXBwaW5nKGZtLmdldEtleU1hcHBpbmcoKSwKICAg\nICAgICAgICAgICAgICAgICAgICAga2VtYmVkLm51bGxJbmRpY2F0b3JDb2x1\nbW5OYW1lKCksCiAgICAgICAgICAgICAgICAgICAgICAgIGtlbWJlZC5udWxs\nSW5kaWNhdG9yQXR0cmlidXRlTmFtZSgpLAogICAgICAgICAgICAgICAgICAg\nICAgICBrZW1iZWQub3ZlcnJpZGVzKCkpOwogICAgICAgICAgICAgICAgICAg\nIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSBLRVlfRks6CiAgICAgICAg\nICAgICAgICAgICAgS2V5Rm9yZWlnbktleSBrZmsgPSAoS2V5Rm9yZWlnbktl\neSkgYW5ubzsKICAgICAgICAgICAgICAgICAgICBwYXJzZUZvcmVpZ25LZXko\nZm0uZ2V0S2V5TWFwcGluZygpLmdldFZhbHVlSW5mbygpLAogICAgICAgICAg\nICAgICAgICAgICAgICBrZmsubmFtZSgpLCBrZmsuZW5hYmxlZCgpLCBrZmsu\nZGVmZXJyZWQoKSwKICAgICAgICAgICAgICAgICAgICAgICAga2ZrLmRlbGV0\nZUFjdGlvbigpLCBrZmsudXBkYXRlQWN0aW9uKCkpOwogICAgICAgICAgICAg\nICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSBLRVlfSU5ERVg6\nCiAgICAgICAgICAgICAgICAgICAgS2V5SW5kZXgga2lkeCA9IChLZXlJbmRl\neCkgYW5ubzsKICAgICAgICAgICAgICAgICAgICBwYXJzZUluZGV4KGZtLmdl\ndEtleU1hcHBpbmcoKS5nZXRWYWx1ZUluZm8oKSwga2lkeC5uYW1lKCksCiAg\nICAgICAgICAgICAgICAgICAgICAgIGtpZHguZW5hYmxlZCgpLCBraWR4LnVu\naXF1ZSgpKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAg\nICAgICAgIGNhc2UgS0VZX0pPSU5fQ09MOgogICAgICAgICAgICAgICAgICAg\nIHBhcnNlS2V5Sm9pbkNvbHVtbnMoZm0sIChLZXlKb2luQ29sdW1uKSBhbm5v\nKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAg\nIGNhc2UgS0VZX0pPSU5fQ09MUzoKICAgICAgICAgICAgICAgICAgICBwYXJz\nZUtleUpvaW5Db2x1bW5zKGZtLCAoKEtleUpvaW5Db2x1bW5zKSBhbm5vKS52\nYWx1ZSgpKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAg\nICAgICAgIGNhc2UgS0VZX05PTlBPTFk6CiAgICAgICAgICAgICAgICAgICAg\nZm0uZ2V0S2V5TWFwcGluZygpLnNldFBvbHltb3JwaGljKHRvUG9seW1vcnBo\naWNDb25zdGFudAogICAgICAgICAgICAgICAgICAgICAgICAoKChLZXlOb25w\nb2x5bW9ycGhpYykgYW5ubykudmFsdWUoKSkpOwogICAgICAgICAgICAgICAg\nICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSBLRVlfU1RSQVQ6CiAg\nICAgICAgICAgICAgICAgICAgZm0uZ2V0S2V5TWFwcGluZygpLmdldFZhbHVl\nSW5mbygpCiAgICAgICAgICAgICAgICAgICAgICAgIC5zZXRTdHJhdGVneSgo\nKEtleVN0cmF0ZWd5KSBhbm5vKS52YWx1ZSgpKTsKICAgICAgICAgICAgICAg\nICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgUEtfSk9JTl9DT0w6\nCiAgICAgICAgICAgICAgICAgICAgcGFyc2VQcmltYXJ5S2V5Sm9pbkNvbHVt\nbnMoZm0sIChQcmltYXJ5S2V5Sm9pbkNvbHVtbikgYW5ubyk7CiAgICAgICAg\nICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIFBLX0pP\nSU5fQ09MUzoKICAgICAgICAgICAgICAgICAgICBwYXJzZVByaW1hcnlLZXlK\nb2luQ29sdW1ucyhmbSwKICAgICAgICAgICAgICAgICAgICAgICAgKChQcmlt\nYXJ5S2V5Sm9pbkNvbHVtbnMpIGFubm8pLgogICAgICAgICAgICAgICAgICAg\nICAgICAgICAgdmFsdWUoKSk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7\nCiAgICAgICAgICAgICAgICBjYXNlIFRBQkxFX0dFTjoKICAgICAgICAgICAg\nICAgICAgICBwYXJzZVRhYmxlR2VuZXJhdG9yKGVsLCAoVGFibGVHZW5lcmF0\nb3IpIGFubm8pOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAg\nICAgICAgICAgY2FzZSBURU1QT1JBTDoKICAgICAgICAgICAgICAgICAgICBw\nYXJzZVRlbXBvcmFsKGZtLCAoVGVtcG9yYWwpIGFubm8pOwogICAgICAgICAg\nICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSBDTEFTU19D\nUklUOgogICAgICAgICAgICAgICAgICAgIGZtLmdldFZhbHVlSW5mbygpLnNl\ndFVzZUNsYXNzQ3JpdGVyaWEKICAgICAgICAgICAgICAgICAgICAgICAgKCgo\nQ2xhc3NDcml0ZXJpYSkgYW5ubykudmFsdWUoKSk7CiAgICAgICAgICAgICAg\nICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIENPTlRBSU5FUl9U\nQUJMRToKICAgICAgICAgICAgICAgICAgICBwYXJzZUNvbnRhaW5lclRhYmxl\nKGZtLCAoQ29udGFpbmVyVGFibGUpIGFubm8pOwogICAgICAgICAgICAgICAg\nICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSBFQUdFUl9GRVRDSF9N\nT0RFOgogICAgICAgICAgICAgICAgICAgIGZtLnNldEVhZ2VyRmV0Y2hNb2Rl\nKHRvRWFnZXJGZXRjaE1vZGVDb25zdGFudAogICAgICAgICAgICAgICAgICAg\nICAgICAoKChFYWdlckZldGNoTW9kZSkgYW5ubykudmFsdWUoKSkpOwogICAg\nICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSBF\nTEVNX0NMQVNTX0NSSVQ6CiAgICAgICAgICAgICAgICAgICAgZm0uZ2V0RWxl\nbWVudE1hcHBpbmcoKS5nZXRWYWx1ZUluZm8oKS5zZXRVc2VDbGFzc0NyaXRl\ncmlhCiAgICAgICAgICAgICAgICAgICAgICAgICgoKEVsZW1lbnRDbGFzc0Ny\naXRlcmlhKSBhbm5vKS52YWx1ZSgpKTsKICAgICAgICAgICAgICAgICAgICBi\ncmVhazsKICAgICAgICAgICAgICAgIGNhc2UgRUxFTV9DT0w6CiAgICAgICAg\nICAgICAgICAgICAgcGFyc2VFbGVtZW50Q29sdW1ucyhmbSwgKEVsZW1lbnRD\nb2x1bW4pIGFubm8pOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAg\nICAgICAgICAgICAgY2FzZSBFTEVNX0NPTFM6CiAgICAgICAgICAgICAgICAg\nICAgcGFyc2VFbGVtZW50Q29sdW1ucyhmbSwgKChFbGVtZW50Q29sdW1ucykg\nYW5ubykudmFsdWUoKSk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAg\nICAgICAgICAgICAgICBjYXNlIEVMRU1fRU1CRURERURfTUFQUElORzoKICAg\nICAgICAgICAgICAgICAgICBFbGVtZW50RW1iZWRkZWRNYXBwaW5nIGVlID0g\nKEVsZW1lbnRFbWJlZGRlZE1hcHBpbmcpIGFubm87CiAgICAgICAgICAgICAg\nICAgICAgcGFyc2VFbWJlZGRlZE1hcHBpbmcoZm0uZ2V0RWxlbWVudE1hcHBp\nbmcoKSwKICAgICAgICAgICAgICAgICAgICAgICAgZWUubnVsbEluZGljYXRv\nckF0dHJpYnV0ZU5hbWUoKSwKICAgICAgICAgICAgICAgICAgICAgICAgZWUu\nbnVsbEluZGljYXRvckNvbHVtbk5hbWUoKSwKICAgICAgICAgICAgICAgICAg\nICAgICAgZWUub3ZlcnJpZGVzKCkpOwogICAgICAgICAgICAgICAgICAgIGJy\nZWFrOwogICAgICAgICAgICAgICAgY2FzZSBFTEVNX0ZLOgogICAgICAgICAg\nICAgICAgICAgIEVsZW1lbnRGb3JlaWduS2V5IGVmayA9IChFbGVtZW50Rm9y\nZWlnbktleSkgYW5ubzsKICAgICAgICAgICAgICAgICAgICBwYXJzZUZvcmVp\nZ25LZXkoZm0uZ2V0RWxlbWVudE1hcHBpbmcoKS5nZXRWYWx1ZUluZm8oKSwK\nICAgICAgICAgICAgICAgICAgICAgICAgZWZrLm5hbWUoKSwgZWZrLmVuYWJs\nZWQoKSwgZWZrLmRlZmVycmVkKCksCiAgICAgICAgICAgICAgICAgICAgICAg\nIGVmay5kZWxldGVBY3Rpb24oKSwgZWZrLnVwZGF0ZUFjdGlvbigpKTsKICAg\nICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2Ug\nRUxFTV9JTkRFWDoKICAgICAgICAgICAgICAgICAgICBFbGVtZW50SW5kZXgg\nZWlkeCA9IChFbGVtZW50SW5kZXgpIGFubm87CiAgICAgICAgICAgICAgICAg\nICAgcGFyc2VJbmRleChmbS5nZXRFbGVtZW50TWFwcGluZygpLmdldFZhbHVl\nSW5mbygpLAogICAgICAgICAgICAgICAgICAgICAgICBlaWR4Lm5hbWUoKSwg\nZWlkeC5lbmFibGVkKCksIGVpZHgudW5pcXVlKCkpOwogICAgICAgICAgICAg\nICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSBFTEVNX0pPSU5f\nQ09MOgogICAgICAgICAgICAgICAgICAgIHBhcnNlRWxlbWVudEpvaW5Db2x1\nbW5zKGZtLCAoRWxlbWVudEpvaW5Db2x1bW4pIGFubm8pOwogICAgICAgICAg\nICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSBFTEVNX0pP\nSU5fQ09MUzoKICAgICAgICAgICAgICAgICAgICBwYXJzZUVsZW1lbnRKb2lu\nQ29sdW1ucyhmbSwgKChFbGVtZW50Sm9pbkNvbHVtbnMpIGFubm8pLgogICAg\nICAgICAgICAgICAgICAgICAgICB2YWx1ZSgpKTsKICAgICAgICAgICAgICAg\nICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgRUxFTV9OT05QT0xZ\nOgogICAgICAgICAgICAgICAgICAgIGZtLmdldEVsZW1lbnRNYXBwaW5nKCku\nc2V0UG9seW1vcnBoaWModG9Qb2x5bW9ycGhpY0NvbnN0YW50CiAgICAgICAg\nICAgICAgICAgICAgICAgICgoKEVsZW1lbnROb25wb2x5bW9ycGhpYykgYW5u\nbykudmFsdWUoKSkpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAg\nICAgICAgICAgICAgY2FzZSBFTEVNX1NUUkFUOgogICAgICAgICAgICAgICAg\nICAgIGZtLmdldEVsZW1lbnRNYXBwaW5nKCkuZ2V0VmFsdWVJbmZvKCkKICAg\nICAgICAgICAgICAgICAgICAgICAgLnNldFN0cmF0ZWd5KCgoRWxlbWVudFN0\ncmF0ZWd5KSBhbm5vKS52YWx1ZSgpKTsKICAgICAgICAgICAgICAgICAgICBi\ncmVhazsKICAgICAgICAgICAgICAgIGNhc2UgRU1CRURERURfTUFQUElORzoK\nICAgICAgICAgICAgICAgICAgICBwYXJzZUVtYmVkZGVkTWFwcGluZyhmbSwg\nKEVtYmVkZGVkTWFwcGluZykgYW5ubyk7CiAgICAgICAgICAgICAgICAgICAg\nYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIEZLOgogICAgICAgICAgICAg\nICAgICAgIHBhcnNlRm9yZWlnbktleShmbS5nZXRWYWx1ZUluZm8oKSwgKEZv\ncmVpZ25LZXkpIGFubm8pOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwog\nICAgICAgICAgICAgICAgY2FzZSBJTkRFWDoKICAgICAgICAgICAgICAgICAg\nICBwYXJzZUluZGV4KGZtLmdldFZhbHVlSW5mbygpLCAoSW5kZXgpIGFubm8p\nOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAg\nY2FzZSBOT05QT0xZOgogICAgICAgICAgICAgICAgICAgIGZtLnNldFBvbHlt\nb3JwaGljKHRvUG9seW1vcnBoaWNDb25zdGFudAogICAgICAgICAgICAgICAg\nICAgICAgICAoKChOb25wb2x5bW9ycGhpYykgYW5ubykudmFsdWUoKSkpOwog\nICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2Fz\nZSBPUkRFUl9DT0w6CiAgICAgICAgICAgICAgICAgICAgcGFyc2VPcmRlckNv\nbHVtbihmbSwgKE9yZGVyQ29sdW1uKSBhbm5vKTsKICAgICAgICAgICAgICAg\nICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgU1RSQVQ6CiAgICAg\nICAgICAgICAgICAgICAgZm0uZ2V0VmFsdWVJbmZvKCkuc2V0U3RyYXRlZ3ko\nKChTdHJhdGVneSkgYW5ubykudmFsdWUoKSk7CiAgICAgICAgICAgICAgICAg\nICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIFVOSVFVRToKICAgICAg\nICAgICAgICAgICAgICBwYXJzZVVuaXF1ZShmbSwKICAgICAgICAgICAgICAg\nICAgICAgICAgKG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5qZGJj\nLlVuaXF1ZSkgYW5ubyk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAg\nICAgICAgICAgICAgICBjYXNlIFhfRU1CRURERURfTUFQUElORzoKICAgICAg\nICAgICAgICAgICAgICBYRW1iZWRkZWRNYXBwaW5nIGVtYmVkID0gKFhFbWJl\nZGRlZE1hcHBpbmcpIGFubm87CiAgICAgICAgICAgICAgICAgICAgcGFyc2VF\nbWJlZGRlZE1hcHBpbmcoZm0sIGVtYmVkLm51bGxJbmRpY2F0b3JDb2x1bW5O\nYW1lKCksCiAgICAgICAgICAgICAgICAgICAgICAgIGVtYmVkLm51bGxJbmRp\nY2F0b3JBdHRyaWJ1dGVOYW1lKCksIGVtYmVkLm92ZXJyaWRlcygpKTsKICAg\nICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2Ug\nWF9KT0lOX0NPTDoKICAgICAgICAgICAgICAgICAgICBwYXJzZVhKb2luQ29s\ndW1ucyhmbSwgZm0uZ2V0VmFsdWVJbmZvKCksIHRydWUsCiAgICAgICAgICAg\nICAgICAgICAgICAgIChYSm9pbkNvbHVtbikgYW5ubyk7CiAgICAgICAgICAg\nICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIFhfSk9JTl9D\nT0xTOgogICAgICAgICAgICAgICAgICAgIHBhcnNlWEpvaW5Db2x1bW5zKGZt\nLCBmbS5nZXRWYWx1ZUluZm8oKSwgdHJ1ZSwKICAgICAgICAgICAgICAgICAg\nICAgICAgKChYSm9pbkNvbHVtbnMpIGFubm8pLnZhbHVlKCkpOwogICAgICAg\nICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgZGVmYXVsdDoK\nICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgVW5zdXBwb3J0ZWRFeGNl\ncHRpb24oX2xvYy5nZXQoInVuc3VwcG9ydGVkIiwgZm0sCiAgICAgICAgICAg\nICAgICAgICAgICAgIGFubm8udG9TdHJpbmcoKSkpOwogICAgICAgICAgICB9\nCiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogQWxsb3cgc3ViY2xh\nc3NlcyB0byBoYW5kbGUgdW5rbm93biBhbm5vdGF0aW9ucy4KICAgICAqLwog\nICAgcHJvdGVjdGVkIGJvb2xlYW4gaGFuZGxlVW5rbm93bk1lbWJlck1hcHBp\nbmdBbm5vdGF0aW9uKEZpZWxkTWFwcGluZyBmbSwKICAgICAgICBBbm5vdGF0\naW9uIGFubm8pIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBSZXR1cm4gdGhlIHtAbGluayBWYWx1ZU1hcHBpbmd9IDxj\nb2RlPlBPTFlfKjwvY29kZT4gY29uc3RhbnQgZm9yCiAgICAgKiB0aGUgZ2l2\nZW4gZW51bSB2YWx1ZS4KICAgICAqLwogICAgcHJvdGVjdGVkIHN0YXRpYyBp\nbnQgdG9Qb2x5bW9ycGhpY0NvbnN0YW50KE5vbnBvbHltb3JwaGljVHlwZSB2\nYWwpIHsKICAgICAgICBzd2l0Y2ggKHZhbCkgewogICAgICAgICAgICBjYXNl\nIEVYQUNUOgogICAgICAgICAgICAgICAgcmV0dXJuIFZhbHVlTWFwcGluZy5Q\nT0xZX0ZBTFNFOwogICAgICAgICAgICBjYXNlIEpPSU5BQkxFOgogICAgICAg\nICAgICAgICAgcmV0dXJuIFZhbHVlTWFwcGluZy5QT0xZX0pPSU5BQkxFOwog\nICAgICAgICAgICBjYXNlIEZBTFNFOgogICAgICAgICAgICAgICAgcmV0dXJu\nIFZhbHVlTWFwcGluZy5QT0xZX1RSVUU7CiAgICAgICAgICAgIGRlZmF1bHQ6\nCiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgSW50ZXJuYWxFeGNlcHRpb24o\nKTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBQYXJzZSBnaXZl\nbiBAQXNzb2NpYXRpb25PdmVycmlkZSBhbm5vdGF0aW9ucyBvbiBhbiBlbWJl\nZGRlZCBtYXBwaW5nLgogICAgICovCiAgICBwcml2YXRlIHZvaWQgcGFyc2VB\nc3NvY2lhdGlvbk92ZXJyaWRlcyhGaWVsZE1hcHBpbmcgZm0sCiAgICAgICAg\nQXNzb2NpYXRpb25PdmVycmlkZS4uLiBhc3NvY3MpIHsKICAgICAgICBDbGFz\nc01hcHBpbmcgZW1iZWQgPSBmbS5nZXRFbWJlZGRlZE1hcHBpbmcoKTsKICAg\nICAgICBpZiAoZW1iZWQgPT0gbnVsbCkKICAgICAgICAgICAgdGhyb3cgbmV3\nIE1ldGFEYXRhRXhjZXB0aW9uKF9sb2MuZ2V0KCJub3QtZW1iZWRkZWQiLCBm\nbSkpOwoKICAgICAgICBGaWVsZE1hcHBpbmcgZWZtOwogICAgICAgIEpvaW5D\nb2x1bW5bXSBlY29sczsKICAgICAgICBpbnQgdW5pcXVlOwogICAgICAgIExp\nc3Q8Q29sdW1uPiBqY29sczsKICAgICAgICBmb3IgKEFzc29jaWF0aW9uT3Zl\ncnJpZGUgYXNzb2MgOiBhc3NvY3MpIHsKICAgICAgICAgICAgZWZtID0gZW1i\nZWQuZ2V0RmllbGRNYXBwaW5nKGFzc29jLm5hbWUoKSk7CiAgICAgICAgICAg\nIGlmIChlZm0gPT0gbnVsbCkKICAgICAgICAgICAgICAgIHRocm93IG5ldyBN\nZXRhRGF0YUV4Y2VwdGlvbihfbG9jLmdldCgiZW1iZWQtb3ZlcnJpZGUtbmFt\nZSIsCiAgICAgICAgICAgICAgICAgICAgZm0sIGFzc29jLm5hbWUoKSkpOwog\nICAgICAgICAgICBlY29scyA9IGFzc29jLmpvaW5Db2x1bW5zKCk7CiAgICAg\nICAgICAgIGlmIChlY29scyA9PSBudWxsIHx8IGVjb2xzLmxlbmd0aCA9PSAw\nKQogICAgICAgICAgICAgICAgY29udGludWU7CgogICAgICAgICAgICB1bmlx\ndWUgPSAwOwogICAgICAgICAgICBqY29scyA9IG5ldyBBcnJheUxpc3Q8Q29s\ndW1uPihlY29scy5sZW5ndGgpOwogICAgICAgICAgICBmb3IgKEpvaW5Db2x1\nbW4gZWNvbCA6IGVjb2xzKSB7CiAgICAgICAgICAgICAgICB1bmlxdWUgfD0g\nKGVjb2wudW5pcXVlKCkpID8gVFJVRSA6IEZBTFNFOwogICAgICAgICAgICAg\nICAgamNvbHMuYWRkKG5ld0NvbHVtbihlY29sKSk7CiAgICAgICAgICAgIH0K\nICAgICAgICAgICAgc2V0Q29sdW1ucyhlZm0sIGVmbS5nZXRWYWx1ZUluZm8o\nKSwgamNvbHMsIHVuaXF1ZSk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgog\nICAgICogUGFyc2UgZ2l2ZW4gQEF0dHJpYnV0ZU92ZXJyaWRlIGFubm90YXRp\nb25zIG9uIGFuIGVtYmVkZGVkIG1hcHBpbmcuCiAgICAgKi8KICAgIHByaXZh\ndGUgdm9pZCBwYXJzZUF0dHJpYnV0ZU92ZXJyaWRlcyhGaWVsZE1hcHBpbmcg\nZm0sCiAgICAgICAgQXR0cmlidXRlT3ZlcnJpZGUuLi4gYXR0cnMpIHsKICAg\nICAgICBDbGFzc01hcHBpbmcgZW1iZWQgPSBmbS5nZXRFbWJlZGRlZE1hcHBp\nbmcoKTsKICAgICAgICBpZiAoZW1iZWQgPT0gbnVsbCkKICAgICAgICAgICAg\ndGhyb3cgbmV3IE1ldGFEYXRhRXhjZXB0aW9uKF9sb2MuZ2V0KCJub3QtZW1i\nZWRkZWQiLCBmbSkpOwoKICAgICAgICBGaWVsZE1hcHBpbmcgZWZtOwogICAg\nICAgIGZvciAoQXR0cmlidXRlT3ZlcnJpZGUgYXR0ciA6IGF0dHJzKSB7CiAg\nICAgICAgICAgIGVmbSA9IGVtYmVkLmdldEZpZWxkTWFwcGluZyhhdHRyLm5h\nbWUoKSk7CiAgICAgICAgICAgIGlmIChlZm0gPT0gbnVsbCkKICAgICAgICAg\nICAgICAgIHRocm93IG5ldyBNZXRhRGF0YUV4Y2VwdGlvbihfbG9jLmdldCgi\nZW1iZWQtb3ZlcnJpZGUtbmFtZSIsCiAgICAgICAgICAgICAgICAgICAgZm0s\nIGF0dHIubmFtZSgpKSk7CiAgICAgICAgICAgIGlmIChhdHRyLmNvbHVtbigp\nICE9IG51bGwpCiAgICAgICAgICAgICAgICBwYXJzZUNvbHVtbnMoZWZtLCBh\ndHRyLmNvbHVtbigpKTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAg\nKiBQYXJzZSBARW51bWVyYXRlZC4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lk\nIHBhcnNlRW51bWVyYXRlZChGaWVsZE1hcHBpbmcgZm0sIEVudW1lcmF0ZWQg\nYW5ubykgewogICAgICAgIFN0cmluZyBzdHJhdCA9IEVudW1WYWx1ZUhhbmRs\nZXIuY2xhc3MuZ2V0TmFtZSgpICsgIihTdG9yZU9yZGluYWw9IgogICAgICAg\nICAgICArIFN0cmluZy52YWx1ZU9mKGFubm8udmFsdWUoKSA9PSBFbnVtVHlw\nZS5PUkRJTkFMKSArICIpIjsKICAgICAgICBmbS5nZXRWYWx1ZUluZm8oKS5z\nZXRTdHJhdGVneShzdHJhdCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBQYXJz\nZSBAVGVtcG9yYWwuCiAgICAgKi8KICAgIHByaXZhdGUgdm9pZCBwYXJzZVRl\nbXBvcmFsKEZpZWxkTWFwcGluZyBmbSwgVGVtcG9yYWwgYW5ubykgewogICAg\nICAgIExpc3QgY29scyA9IGZtLmdldFZhbHVlSW5mbygpLmdldENvbHVtbnMo\nKTsKICAgICAgICBpZiAoIWNvbHMuaXNFbXB0eSgpICYmIGNvbHMuc2l6ZSgp\nICE9IDEpCiAgICAgICAgICAgIHRocm93IG5ldyBNZXRhRGF0YUV4Y2VwdGlv\nbihfbG9jLmdldCgibnVtLWNvbHMtbWlzbWF0Y2giLCBmbSwKICAgICAgICAg\nICAgICAgIFN0cmluZy52YWx1ZU9mKGNvbHMuc2l6ZSgpKSwgIjEiKSk7CiAg\nICAgICAgaWYgKGNvbHMuaXNFbXB0eSgpKSB7CiAgICAgICAgICAgIGNvbHMg\nPSBBcnJheXMuYXNMaXN0KG5ldyBDb2x1bW5bXXsgbmV3IENvbHVtbigpIH0p\nOwogICAgICAgICAgICBmbS5nZXRWYWx1ZUluZm8oKS5zZXRDb2x1bW5zKGNv\nbHMpOwogICAgICAgIH0KCiAgICAgICAgQ29sdW1uIGNvbCA9IChDb2x1bW4p\nIGNvbHMuZ2V0KDApOwogICAgICAgIHN3aXRjaCAoYW5uby52YWx1ZSgpKSB7\nCiAgICAgICAgICAgIGNhc2UgREFURToKICAgICAgICAgICAgICAgIGNvbC5z\nZXRUeXBlKFR5cGVzLkRBVEUpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAg\nICAgICAgICAgIGNhc2UgVElNRToKICAgICAgICAgICAgICAgIGNvbC5zZXRU\neXBlKFR5cGVzLlRJTUUpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAg\nICAgICAgIGNhc2UgVElNRVNUQU1QOgogICAgICAgICAgICAgICAgY29sLnNl\ndFR5cGUoVHlwZXMuVElNRVNUQU1QKTsKICAgICAgICAgICAgICAgIGJyZWFr\nOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIFBhcnNlIEBDb2x1\nbW4ocykuCiAgICAgKi8KICAgIHByb3RlY3RlZCB2b2lkIHBhcnNlQ29sdW1u\ncyhGaWVsZE1hcHBpbmcgZm0sCiAgICAgICAgamF2YXgucGVyc2lzdGVuY2Uu\nQ29sdW1uLi4uIHBjb2xzKSB7CiAgICAgICAgaWYgKHBjb2xzLmxlbmd0aCA9\nPSAwKQogICAgICAgICAgICByZXR1cm47CgogICAgICAgIC8vIG1pZ2h0IGFs\ncmVhZHkgaGF2ZSBzb21lIGNvbHVtbiBpbmZvcm1hdGlvbiBmcm9tIG1hcHBp\nbmcgYW5ub3RhdGlvbgogICAgICAgIExpc3QgY29scyA9IGZtLmdldFZhbHVl\nSW5mbygpLmdldENvbHVtbnMoKTsKICAgICAgICBpZiAoIWNvbHMuaXNFbXB0\neSgpICYmIGNvbHMuc2l6ZSgpICE9IHBjb2xzLmxlbmd0aCkKICAgICAgICAg\nICAgdGhyb3cgbmV3IE1ldGFEYXRhRXhjZXB0aW9uKF9sb2MuZ2V0KCJudW0t\nY29scy1taXNtYXRjaCIsIGZtLAogICAgICAgICAgICAgICAgU3RyaW5nLnZh\nbHVlT2YoY29scy5zaXplKCkpLCBTdHJpbmcudmFsdWVPZihwY29scy5sZW5n\ndGgpKSk7CgogICAgICAgIC8vIGNhY2hlIHRoZSBKQVhCIFhtbFR5cGUgY2xh\nc3MgaWYgaXQgaXMgcHJlc2VudCBzbyB3ZSBkbyBub3QKICAgICAgICAvLyBo\nYXZlIGEgaGFyZC13aXJlZCBkZXBlbmRlbmN5IG9uIEpBWEIgaGVyZQogICAg\nICAgIENsYXNzIHhtbFR5cGVDbGFzcyA9IG51bGw7CiAgICAgICAgdHJ5IHsK\nICAgICAgICAgICAgeG1sVHlwZUNsYXNzID0gQ2xhc3MuZm9yTmFtZSgiamF2\nYXgueG1sLmJpbmQuYW5ub3RhdGlvbi5YbWxUeXBlIik7CiAgICAgICAgfSBj\nYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICB9CgogICAgICAgIGludCB1\nbmlxdWUgPSAwOwogICAgICAgIFN0cmluZyBzZWNvbmRhcnkgPSBudWxsOwog\nICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgcGNvbHMubGVuZ3RoOyBpKysp\nIHsKICAgICAgICAgICAgaWYgKGNvbHMuc2l6ZSgpID4gaSkKICAgICAgICAg\nICAgICAgIHNldHVwQ29sdW1uKChDb2x1bW4pIGNvbHMuZ2V0KGkpLCBwY29s\nc1tpXSk7CiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgaWYg\nKGNvbHMuaXNFbXB0eSgpKQogICAgICAgICAgICAgICAgICAgIGNvbHMgPSBu\nZXcgQXJyYXlMaXN0PENvbHVtbj4ocGNvbHMubGVuZ3RoKTsKICAgICAgICAg\nICAgICAgIGNvbHMuYWRkKG5ld0NvbHVtbihwY29sc1tpXSkpOwogICAgICAg\nICAgICB9CiAgICAgICAgICAgIAogICAgICAgICAgICBpZiAoeG1sVHlwZUNs\nYXNzICE9IG51bGwKICAgICAgICAgICAgICAgICYmIFN0cmluZ1V0aWxzLmlz\nRW1wdHkocGNvbHNbaV0uY29sdW1uRGVmaW5pdGlvbigpKQogICAgICAgICAg\nICAgICAgJiYgKChCb29sZWFuKSBBY2Nlc3NDb250cm9sbGVyLmRvUHJpdmls\nZWdlZChKMkRvUHJpdjVIZWxwZXIKICAgICAgICAgICAgICAgICAgICAuaXNB\nbm5vdGF0aW9uUHJlc2VudEFjdGlvbihmbS5nZXREZWNsYXJlZFR5cGUoKSwK\nICAgICAgICAgICAgICAgICAgICAgICAgeG1sVHlwZUNsYXNzKSkpLmJvb2xl\nYW5WYWx1ZSgpKSB7CiAgICAgICAgICAgICAgICBEQkRpY3Rpb25hcnkgZGlj\ndCA9ICgoTWFwcGluZ1JlcG9zaXRvcnkpIGdldFJlcG9zaXRvcnkoKSkKICAg\nICAgICAgICAgICAgICAgICAuZ2V0REJEaWN0aW9uYXJ5KCk7CiAgICAgICAg\nICAgICAgICBpZiAoZGljdC5zdXBwb3J0c1hNTENvbHVtbikKICAgICAgICAg\nICAgICAgICAgICAvLyBjb2x1bW4gbWFwcyB0byB4bWwgdHlwZQogICAgICAg\nICAgICAgICAgICAgICgoQ29sdW1uKSBjb2xzLmdldChpKSkuc2V0VHlwZU5h\nbWUoZGljdC54bWxUeXBlTmFtZSk7CiAgICAgICAgICAgIH0KCiAgICAgICAg\nICAgIHVuaXF1ZSB8PSAocGNvbHNbaV0udW5pcXVlKCkpID8gVFJVRSA6IEZB\nTFNFOwogICAgICAgIAlzZWNvbmRhcnkgPSB0cmFja1NlY29uZGFyeVRhYmxl\nKGZtLCBzZWNvbmRhcnksCXBjb2xzW2ldLnRhYmxlKCksIGkpOwogICAgICAg\nIH0KCiAgICAgICAgc2V0Q29sdW1ucyhmbSwgZm0uZ2V0VmFsdWVJbmZvKCks\nIGNvbHMsIHVuaXF1ZSk7CiAgICAgICAgaWYgKHNlY29uZGFyeSAhPSBudWxs\nKQogICAgICAgICAgICBmbS5nZXRNYXBwaW5nSW5mbygpLnNldFRhYmxlTmFt\nZShzZWNvbmRhcnkpOwogICAgfQoKICAgIC8qKgogICAgICogQ3JlYXRlIGEg\nbmV3IHNjaGVtYSBjb2x1bW4gd2l0aCBpbmZvcm1hdGlvbiBmcm9tIHRoZSBn\naXZlbiBhbm5vdGF0aW9uLgogICAgICovCiAgICBwcml2YXRlIHN0YXRpYyBD\nb2x1bW4gbmV3Q29sdW1uKGphdmF4LnBlcnNpc3RlbmNlLkNvbHVtbiBhbm5v\nKSB7CiAgICAgICAgQ29sdW1uIGNvbCA9IG5ldyBDb2x1bW4oKTsKICAgICAg\nICBzZXR1cENvbHVtbihjb2wsIGFubm8pOwogICAgICAgIHJldHVybiBjb2w7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBTZXR1cCB0aGUgZ2l2ZW4gY29sdW1u\nIHdpdGggaW5mb3JtYXRpb24gZnJvbSB0aGUgZ2l2ZW4gYW5ub3RhdGlvbi4K\nICAgICAqLwogICAgcHJpdmF0ZSBzdGF0aWMgdm9pZCBzZXR1cENvbHVtbihD\nb2x1bW4gY29sLCBqYXZheC5wZXJzaXN0ZW5jZS5Db2x1bW4gYW5ubykgewog\nICAgICAgIGlmICghU3RyaW5nVXRpbHMuaXNFbXB0eShhbm5vLm5hbWUoKSkp\nCiAgICAgICAgICAgIGNvbC5zZXROYW1lKGFubm8ubmFtZSgpKTsKICAgICAg\nICBpZiAoIVN0cmluZ1V0aWxzLmlzRW1wdHkoYW5uby5jb2x1bW5EZWZpbml0\naW9uKCkpKQogICAgICAgICAgICBjb2wuc2V0VHlwZU5hbWUoYW5uby5jb2x1\nbW5EZWZpbml0aW9uKCkpOwogICAgICAgIGlmIChhbm5vLnByZWNpc2lvbigp\nICE9IDApCiAgICAgICAgICAgIGNvbC5zZXRTaXplKGFubm8ucHJlY2lzaW9u\nKCkpOwogICAgICAgIGVsc2UgaWYgKGFubm8ubGVuZ3RoKCkgIT0gMjU1KQog\nICAgICAgICAgICBjb2wuc2V0U2l6ZShhbm5vLmxlbmd0aCgpKTsKICAgICAg\nICBjb2wuc2V0Tm90TnVsbCghYW5uby5udWxsYWJsZSgpKTsKICAgICAgICBj\nb2wuc2V0RGVjaW1hbERpZ2l0cyhhbm5vLnNjYWxlKCkpOwogICAgICAgIGNv\nbC5zZXRGbGFnKENvbHVtbi5GTEFHX1VOSU5TRVJUQUJMRSwgIWFubm8uaW5z\nZXJ0YWJsZSgpKTsKICAgICAgICBjb2wuc2V0RmxhZyhDb2x1bW4uRkxBR19V\nTlVQREFUQUJMRSwgIWFubm8udXBkYXRhYmxlKCkpOwogICAgfQoKICAgIC8q\nKgogICAgICogU2V0IHRoZSBnaXZlbiBjb2x1bW5zIGFzIHRoZSBjb2x1bW5z\nIGZvciA8Y29kZT5mbTwvY29kZT4uCiAgICAgKgogICAgICogQHBhcmFtIHVu\naXF1ZSBiaXR3aXNlIGNvbWJpbmF0aW9uIG9mIFRSVUUgYW5kIEZBTFNFIGZv\nciB0aGUKICAgICAqIHVuaXF1ZSBhdHRyaWJ1dGUgb2YgZWFjaCBjb2x1bW4K\nICAgICAqLwogICAgcHJvdGVjdGVkIHZvaWQgc2V0Q29sdW1ucyhGaWVsZE1h\ncHBpbmcgZm0sIE1hcHBpbmdJbmZvIGluZm8sCiAgICAgICAgTGlzdDxDb2x1\nbW4+IGNvbHMsIGludCB1bmlxdWUpIHsKICAgICAgICBpbmZvLnNldENvbHVt\nbnMoY29scyk7CiAgICAgICAgaWYgKHVuaXF1ZSA9PSBUUlVFKQogICAgICAg\nICAgICBpbmZvLnNldFVuaXF1ZShuZXcgb3JnLmFwYWNoZS5vcGVuanBhLmpk\nYmMuc2NoZW1hLlVuaXF1ZSgpKTsKCiAgICAgICAgLy8jIyMgRUpCMwogICAg\nICAgIExvZyBsb2cgPSBnZXRMb2coKTsKICAgICAgICBpZiAobG9nLmlzV2Fy\nbkVuYWJsZWQoKSAmJiB1bmlxdWUgPT0gKFRSVUUgfCBGQUxTRSkpCiAgICAg\nICAgICAgIGxvZy53YXJuKF9sb2MuZ2V0KCJpbmNvbnNpc3QtY29sLWF0dHJz\nIiwgZm0pKTsKICAgIH0KCiAgICAvKioKICAgICAqIEhlbHBlciB0byB0cmFj\nayB0aGUgc2Vjb25kYXJ5IHRhYmxlIGZvciBhIHNldCBvZiBjb2x1bW5zLgog\nICAgICoKICAgICAqIEBwYXJhbSBzZWNvbmRhcnkgc2Vjb25kYXJ5IHRhYmxl\nIGZvciBsYXN0IGNvbHVtbgogICAgICogQHBhcmFtIGNvbFNlY29uZGFyeSBz\nZWNvbmRhcnkgdGFibGUgZm9yIGN1cnJlbnQgY29sdW1uCiAgICAgKiBAcmV0\ndXJuIHNlY29uZGFyeSB0YWJsZSBmb3IgZmllbGQKICAgICAqLwogICAgcHJp\ndmF0ZSBTdHJpbmcgdHJhY2tTZWNvbmRhcnlUYWJsZShGaWVsZE1hcHBpbmcg\nZm0sIFN0cmluZyBzZWNvbmRhcnksCiAgICAgICAgU3RyaW5nIGNvbFNlY29u\nZGFyeSwgaW50IGNvbCkgewogICAgICAgIGlmIChTdHJpbmdVdGlscy5pc0Vt\ncHR5KGNvbFNlY29uZGFyeSkpCiAgICAgICAgICAgIGNvbFNlY29uZGFyeSA9\nIG51bGw7CiAgICAgICAgaWYgKGNvbCA9PSAwKQogICAgICAgICAgICByZXR1\ncm4gY29sU2Vjb25kYXJ5OwogICAgICAgIGlmICghU3RyaW5nVXRpbHMuZXF1\nYWxzSWdub3JlQ2FzZShzZWNvbmRhcnksIGNvbFNlY29uZGFyeSkpCiAgICAg\nICAgICAgIHRocm93IG5ldyBNZXRhRGF0YUV4Y2VwdGlvbihfbG9jLmdldCgi\nc2Vjb25kLWluY29uc2lzdCIsIGZtKSk7CiAgICAgICAgcmV0dXJuIHNlY29u\nZGFyeTsKICAgIH0KCiAgICAvKioKICAgICAqIFBhcnNlIEBKb2luVGFibGUu\nCiAgICAgKi8KICAgIHByaXZhdGUgdm9pZCBwYXJzZUpvaW5UYWJsZShGaWVs\nZE1hcHBpbmcgZm0sIEpvaW5UYWJsZSBqb2luKSB7CiAgICAJRmllbGRNYXBw\naW5nSW5mbyBpbmZvID0gZm0uZ2V0TWFwcGluZ0luZm8oKTsKICAgICAgICBp\nbmZvLnNldFRhYmxlTmFtZSh0b1RhYmxlTmFtZShqb2luLnNjaGVtYSgpLCBq\nb2luLm5hbWUoKSkpOwogICAgICAgIHBhcnNlSm9pbkNvbHVtbnMoZm0sIGlu\nZm8sIGZhbHNlLCBqb2luLmpvaW5Db2x1bW5zKCkpOwogICAgICAgIHBhcnNl\nSm9pbkNvbHVtbnMoZm0sIGZtLmdldEVsZW1lbnRNYXBwaW5nKCkuZ2V0VmFs\ndWVJbmZvKCksIGZhbHNlLAogICAgICAgICAgICBqb2luLmludmVyc2VKb2lu\nQ29sdW1ucygpKTsKICAgICAgICBhZGRVbmlxdWVDb25zdHJhaW50cyhpbmZv\nLmdldFRhYmxlTmFtZSgpLCBmbSwgaW5mbywgIAogICAgICAgIAkJam9pbi51\nbmlxdWVDb25zdHJhaW50cygpKTsKICAgIH0KCiAgICAvKioKICAgICAqIFBh\ncnNlIGdpdmVuIEBKb2luQ29sdW1uIGFubm90YXRpb25zLgogICAgICovCiAg\nICBwcml2YXRlIHZvaWQgcGFyc2VKb2luQ29sdW1ucyhGaWVsZE1hcHBpbmcg\nZm0sIE1hcHBpbmdJbmZvIGluZm8sCiAgICAgICAgYm9vbGVhbiBzZWNvbmRh\ncnlBbGxvd2VkLCBKb2luQ29sdW1uLi4uIGpvaW5zKSB7CiAgICAgICAgaWYg\nKGpvaW5zLmxlbmd0aCA9PSAwKQogICAgICAgICAgICByZXR1cm47CgogICAg\nICAgIExpc3Q8Q29sdW1uPiBjb2xzID0gbmV3IEFycmF5TGlzdDxDb2x1bW4+\nKGpvaW5zLmxlbmd0aCk7CiAgICAgICAgaW50IHVuaXF1ZSA9IDA7CiAgICAg\nICAgU3RyaW5nIHNlY29uZGFyeSA9IG51bGw7CiAgICAgICAgZm9yIChpbnQg\naSA9IDA7IGkgPCBqb2lucy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBj\nb2xzLmFkZChuZXdDb2x1bW4oam9pbnNbaV0pKTsKICAgICAgICAgICAgdW5p\ncXVlIHw9IChqb2luc1tpXS51bmlxdWUoKSkgPyBUUlVFIDogRkFMU0U7CiAg\nICAgICAgICAgIHNlY29uZGFyeSA9IHRyYWNrU2Vjb25kYXJ5VGFibGUoZm0s\nIHNlY29uZGFyeSwKICAgICAgICAgICAgICAgIGpvaW5zW2ldLnRhYmxlKCks\nIGkpOwogICAgICAgICAgICBpZiAoIXNlY29uZGFyeUFsbG93ZWQgJiYgc2Vj\nb25kYXJ5ICE9IG51bGwpCiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgTWV0\nYURhdGFFeGNlcHRpb24oX2xvYy5nZXQoImJhZC1zZWNvbmQiLCBmbSkpOwog\nICAgICAgIH0KCiAgICAgICAgc2V0Q29sdW1ucyhmbSwgaW5mbywgY29scywg\ndW5pcXVlKTsKICAgICAgICBpZiAoc2Vjb25kYXJ5ICE9IG51bGwpCiAgICAg\nICAgICAgIGZtLmdldE1hcHBpbmdJbmZvKCkuc2V0VGFibGVOYW1lKHNlY29u\nZGFyeSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBDcmVhdGUgYSBuZXcgc2No\nZW1hIGNvbHVtbiB3aXRoIGluZm9ybWF0aW9uIGZyb20gdGhlIGdpdmVuIGFu\nbm90YXRpb24uCiAgICAgKi8KICAgIHByaXZhdGUgc3RhdGljIENvbHVtbiBu\nZXdDb2x1bW4oSm9pbkNvbHVtbiBqb2luKSB7CiAgICAgICAgQ29sdW1uIGNv\nbCA9IG5ldyBDb2x1bW4oKTsKICAgICAgICBpZiAoIVN0cmluZ1V0aWxzLmlz\nRW1wdHkoam9pbi5uYW1lKCkpKQogICAgICAgICAgICBjb2wuc2V0TmFtZShq\nb2luLm5hbWUoKSk7CiAgICAgICAgaWYgKCFTdHJpbmdVdGlscy5pc0VtcHR5\nKGpvaW4uY29sdW1uRGVmaW5pdGlvbigpKSkKICAgICAgICAgICAgY29sLnNl\ndFR5cGVOYW1lKGpvaW4uY29sdW1uRGVmaW5pdGlvbigpKTsKICAgICAgICBp\nZiAoIVN0cmluZ1V0aWxzLmlzRW1wdHkoam9pbi5yZWZlcmVuY2VkQ29sdW1u\nTmFtZSgpKSkKICAgICAgICAgICAgY29sLnNldFRhcmdldChqb2luLnJlZmVy\nZW5jZWRDb2x1bW5OYW1lKCkpOwogICAgICAgIGNvbC5zZXROb3ROdWxsKCFq\nb2luLm51bGxhYmxlKCkpOwogICAgICAgIGNvbC5zZXRGbGFnKENvbHVtbi5G\nTEFHX1VOSU5TRVJUQUJMRSwgIWpvaW4uaW5zZXJ0YWJsZSgpKTsKICAgICAg\nICBjb2wuc2V0RmxhZyhDb2x1bW4uRkxBR19VTlVQREFUQUJMRSwgIWpvaW4u\ndXBkYXRhYmxlKCkpOwogICAgICAgIHJldHVybiBjb2w7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBQYXJzZSBAS2V5Q29sdW1uKHMpLgogICAgICovCiAgICBw\ncml2YXRlIHZvaWQgcGFyc2VLZXlDb2x1bW5zKEZpZWxkTWFwcGluZyBmbSwg\nS2V5Q29sdW1uLi4uIHBjb2xzKSB7CiAgICAgICAgaWYgKHBjb2xzLmxlbmd0\naCA9PSAwKQogICAgICAgICAgICByZXR1cm47CgogICAgICAgIExpc3Q8Q29s\ndW1uPiBjb2xzID0gbmV3IEFycmF5TGlzdDxDb2x1bW4+KHBjb2xzLmxlbmd0\naCk7CiAgICAgICAgaW50IHVuaXF1ZSA9IDA7CiAgICAgICAgZm9yIChpbnQg\naSA9IDA7IGkgPCBwY29scy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBj\nb2xzLmFkZChuZXdDb2x1bW4ocGNvbHNbaV0pKTsKICAgICAgICAgICAgdW5p\ncXVlIHw9IChwY29sc1tpXS51bmlxdWUoKSkgPyBUUlVFIDogRkFMU0U7CiAg\nICAgICAgfQogICAgICAgIHNldENvbHVtbnMoZm0sIGZtLmdldEtleU1hcHBp\nbmcoKS5nZXRWYWx1ZUluZm8oKSwgY29scywgdW5pcXVlKTsKICAgIH0KCiAg\nICAvKioKICAgICAqIENyZWF0ZSBhIG5ldyBzY2hlbWEgY29sdW1uIHdpdGgg\naW5mb3JtYXRpb24gZnJvbSB0aGUgZ2l2ZW4gYW5ub3RhdGlvbi4KICAgICAq\nLwogICAgcHJpdmF0ZSBzdGF0aWMgQ29sdW1uIG5ld0NvbHVtbihLZXlDb2x1\nbW4gYW5ubykgewogICAgICAgIENvbHVtbiBjb2wgPSBuZXcgQ29sdW1uKCk7\nCiAgICAgICAgaWYgKCFTdHJpbmdVdGlscy5pc0VtcHR5KGFubm8ubmFtZSgp\nKSkKICAgICAgICAgICAgY29sLnNldE5hbWUoYW5uby5uYW1lKCkpOwogICAg\nICAgIGlmICghU3RyaW5nVXRpbHMuaXNFbXB0eShhbm5vLmNvbHVtbkRlZmlu\naXRpb24oKSkpCiAgICAgICAgICAgIGNvbC5zZXRUeXBlTmFtZShhbm5vLmNv\nbHVtbkRlZmluaXRpb24oKSk7CiAgICAgICAgaWYgKGFubm8ucHJlY2lzaW9u\nKCkgIT0gMCkKICAgICAgICAgICAgY29sLnNldFNpemUoYW5uby5wcmVjaXNp\nb24oKSk7CiAgICAgICAgZWxzZSBpZiAoYW5uby5sZW5ndGgoKSAhPSAyNTUp\nCiAgICAgICAgICAgIGNvbC5zZXRTaXplKGFubm8ubGVuZ3RoKCkpOwogICAg\nICAgIGNvbC5zZXROb3ROdWxsKCFhbm5vLm51bGxhYmxlKCkpOwogICAgICAg\nIGNvbC5zZXREZWNpbWFsRGlnaXRzKGFubm8uc2NhbGUoKSk7CiAgICAgICAg\nY29sLnNldEZsYWcoQ29sdW1uLkZMQUdfVU5JTlNFUlRBQkxFLCAhYW5uby5p\nbnNlcnRhYmxlKCkpOwogICAgICAgIGNvbC5zZXRGbGFnKENvbHVtbi5GTEFH\nX1VOVVBEQVRBQkxFLCAhYW5uby51cGRhdGFibGUoKSk7CiAgICAgICAgcmV0\ndXJuIGNvbDsKICAgIH0KCiAgICAvKioKICAgICAqIFBhcnNlIGdpdmVuIEBQ\ncmltYXJ5S2V5Sm9pbkNvbHVtbiBhbm5vdGF0aW9ucy4KICAgICAqLwogICAg\ncHJpdmF0ZSB2b2lkIHBhcnNlUHJpbWFyeUtleUpvaW5Db2x1bW5zKEZpZWxk\nTWFwcGluZyBmbSwKICAgICAgICBQcmltYXJ5S2V5Sm9pbkNvbHVtbi4uLiBq\nb2lucykgewogICAgICAgIExpc3Q8Q29sdW1uPiBjb2xzID0gbmV3IEFycmF5\nTGlzdDxDb2x1bW4+KGpvaW5zLmxlbmd0aCk7CiAgICAgICAgZm9yIChQcmlt\nYXJ5S2V5Sm9pbkNvbHVtbiBqb2luIDogam9pbnMpCiAgICAgICAgICAgIGNv\nbHMuYWRkKG5ld0NvbHVtbihqb2luKSk7CiAgICAgICAgc2V0Q29sdW1ucyhm\nbSwgZm0uZ2V0VmFsdWVJbmZvKCksIGNvbHMsIDApOwogICAgfQoKICAgIC8q\nKgogICAgICogUGFyc2UgZ2l2ZW4gQFhKb2luQ29sdW1uIGFubm90YXRpb25z\nLgogICAgICovCiAgICBwcm90ZWN0ZWQgdm9pZCBwYXJzZVhKb2luQ29sdW1u\ncyhGaWVsZE1hcHBpbmcgZm0sIE1hcHBpbmdJbmZvIGluZm8sCiAgICAgICAg\nYm9vbGVhbiBzZWNvbmRhcnlBbGxvd2VkLCBYSm9pbkNvbHVtbi4uLiBqb2lu\ncykgewogICAgICAgIGlmIChqb2lucy5sZW5ndGggPT0gMCkKICAgICAgICAg\nICAgcmV0dXJuOwoKICAgICAgICBMaXN0PENvbHVtbj4gY29scyA9IG5ldyBB\ncnJheUxpc3Q8Q29sdW1uPihqb2lucy5sZW5ndGgpOwogICAgICAgIGludCB1\nbmlxdWUgPSAwOwogICAgICAgIFN0cmluZyBzZWNvbmRhcnkgPSBudWxsOwog\nICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgam9pbnMubGVuZ3RoOyBpKysp\nIHsKICAgICAgICAgICAgY29scy5hZGQobmV3Q29sdW1uKGpvaW5zW2ldKSk7\nCiAgICAgICAgICAgIHVuaXF1ZSB8PSAoam9pbnNbaV0udW5pcXVlKCkpID8g\nVFJVRSA6IEZBTFNFOwogICAgICAgICAgICBzZWNvbmRhcnkgPSB0cmFja1Nl\nY29uZGFyeVRhYmxlKGZtLCBzZWNvbmRhcnksCiAgICAgICAgICAgICAgICBq\nb2luc1tpXS50YWJsZSgpLCBpKTsKICAgICAgICAgICAgaWYgKCFzZWNvbmRh\ncnlBbGxvd2VkICYmIHNlY29uZGFyeSAhPSBudWxsKQogICAgICAgICAgICAg\nICAgdGhyb3cgbmV3IE1ldGFEYXRhRXhjZXB0aW9uKF9sb2MuZ2V0KCJiYWQt\nc2Vjb25kIiwgZm0pKTsKICAgICAgICB9CgogICAgICAgIHNldENvbHVtbnMo\nZm0sIGluZm8sIGNvbHMsIHVuaXF1ZSk7CiAgICAgICAgaWYgKHNlY29uZGFy\neSAhPSBudWxsKQogICAgICAgICAgICBmbS5nZXRNYXBwaW5nSW5mbygpLnNl\ndFRhYmxlTmFtZShzZWNvbmRhcnkpOwogICAgfQoKICAgIC8qKgogICAgICog\nQ3JlYXRlIGEgbmV3IHNjaGVtYSBjb2x1bW4gd2l0aCBpbmZvcm1hdGlvbiBm\ncm9tIHRoZSBnaXZlbiBhbm5vdGF0aW9uLgogICAgICovCiAgICBwcml2YXRl\nIHN0YXRpYyBDb2x1bW4gbmV3Q29sdW1uKFhKb2luQ29sdW1uIGpvaW4pIHsK\nICAgICAgICBDb2x1bW4gY29sID0gbmV3IENvbHVtbigpOwogICAgICAgIGlm\nICghU3RyaW5nVXRpbHMuaXNFbXB0eShqb2luLm5hbWUoKSkpCiAgICAgICAg\nICAgIGNvbC5zZXROYW1lKGpvaW4ubmFtZSgpKTsKICAgICAgICBpZiAoIVN0\ncmluZ1V0aWxzLmlzRW1wdHkoam9pbi5jb2x1bW5EZWZpbml0aW9uKCkpKQog\nICAgICAgICAgICBjb2wuc2V0VHlwZU5hbWUoam9pbi5jb2x1bW5EZWZpbml0\naW9uKCkpOwogICAgICAgIGlmICghU3RyaW5nVXRpbHMuaXNFbXB0eShqb2lu\nLnJlZmVyZW5jZWRDb2x1bW5OYW1lKCkpKQogICAgICAgICAgICBjb2wuc2V0\nVGFyZ2V0KGpvaW4ucmVmZXJlbmNlZENvbHVtbk5hbWUoKSk7CiAgICAgICAg\naWYgKCFTdHJpbmdVdGlscy5pc0VtcHR5KGpvaW4ucmVmZXJlbmNlZEF0dHJp\nYnV0ZU5hbWUoKSkpCiAgICAgICAgICAgIGNvbC5zZXRUYXJnZXRGaWVsZChq\nb2luLnJlZmVyZW5jZWRBdHRyaWJ1dGVOYW1lKCkpOwogICAgICAgIGNvbC5z\nZXROb3ROdWxsKCFqb2luLm51bGxhYmxlKCkpOwogICAgICAgIGNvbC5zZXRG\nbGFnKENvbHVtbi5GTEFHX1VOSU5TRVJUQUJMRSwgIWpvaW4uaW5zZXJ0YWJs\nZSgpKTsKICAgICAgICBjb2wuc2V0RmxhZyhDb2x1bW4uRkxBR19VTlVQREFU\nQUJMRSwgIWpvaW4udXBkYXRhYmxlKCkpOwogICAgICAgIHJldHVybiBjb2w7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBQYXJzZSBlbWJlZGRlZCBpbmZvIGZv\nciB0aGUgZ2l2ZW4gbWFwcGluZy4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lk\nIHBhcnNlRW1iZWRkZWRNYXBwaW5nKEZpZWxkTWFwcGluZyBmbSwgRW1iZWRk\nZWRNYXBwaW5nIGFubm8pIHsKICAgICAgICBDbGFzc01hcHBpbmcgZW1iZWQg\nPSBmbS5nZXRFbWJlZGRlZE1hcHBpbmcoKTsKICAgICAgICBpZiAoZW1iZWQg\nPT0gbnVsbCkKICAgICAgICAgICAgdGhyb3cgbmV3IE1ldGFEYXRhRXhjZXB0\naW9uKF9sb2MuZ2V0KCJub3QtZW1iZWRkZWQiLCBmbSkpOwoKICAgICAgICBG\naWVsZE1hcHBpbmcgZWZtOwogICAgICAgIGZvciAoTWFwcGluZ092ZXJyaWRl\nIG92ZXIgOiBhbm5vLm92ZXJyaWRlcygpKSB7CiAgICAgICAgICAgIGVmbSA9\nIGVtYmVkLmdldEZpZWxkTWFwcGluZyhvdmVyLm5hbWUoKSk7CiAgICAgICAg\nICAgIGlmIChlZm0gPT0gbnVsbCkKICAgICAgICAgICAgICAgIHRocm93IG5l\ndyBNZXRhRGF0YUV4Y2VwdGlvbihfbG9jLmdldCgiZW1iZWQtb3ZlcnJpZGUt\nbmFtZSIsCiAgICAgICAgICAgICAgICAgICAgZm0sIG92ZXIubmFtZSgpKSk7\nCiAgICAgICAgICAgIHBvcHVsYXRlKGVmbSwgb3Zlcik7CiAgICAgICAgfQoK\nICAgICAgICBTdHJpbmcgbnVsbEluZCA9IG51bGw7CiAgICAgICAgaWYgKCFT\ndHJpbmdVdGlscy5pc0VtcHR5KGFubm8ubnVsbEluZGljYXRvckF0dHJpYnV0\nZU5hbWUoKSkpCiAgICAgICAgICAgIG51bGxJbmQgPSBhbm5vLm51bGxJbmRp\nY2F0b3JBdHRyaWJ1dGVOYW1lKCk7CiAgICAgICAgZWxzZSBpZiAoIVN0cmlu\nZ1V0aWxzLmlzRW1wdHkoYW5uby5udWxsSW5kaWNhdG9yQ29sdW1uTmFtZSgp\nKSkKICAgICAgICAgICAgbnVsbEluZCA9IGFubm8ubnVsbEluZGljYXRvckNv\nbHVtbk5hbWUoKTsKICAgICAgICBpZiAobnVsbEluZCA9PSBudWxsKQogICAg\nICAgICAgICByZXR1cm47CgogICAgICAgIFZhbHVlTWFwcGluZ0luZm8gaW5m\nbyA9IGZtLmdldFZhbHVlSW5mbygpOwogICAgICAgIHBvcHVsYXRlTnVsbElu\nZGljYXRvcihudWxsSW5kLCBpbmZvKTsKICAgIH0KCiAgICAvKioKICAgICAq\nIFBhcnNlIGVtYmVkZGVkIGluZm8gZm9yIHRoZSBnaXZlbiBtYXBwaW5nLgog\nICAgICovCiAgICBwcml2YXRlIHZvaWQgcGFyc2VFbWJlZGRlZE1hcHBpbmco\nVmFsdWVNYXBwaW5nIHZtLCAKICAgICAgICBTdHJpbmcgbnVsbEluZGljYXRv\nckF0dHJpYnV0ZSwgU3RyaW5nIG51bGxJbmRpY2F0b3JDb2x1bW4sCiAgICAg\nICAgWE1hcHBpbmdPdmVycmlkZVtdIG92ZXJyaWRlcykgewogICAgICAgIENs\nYXNzTWFwcGluZyBlbWJlZCA9IHZtLmdldEVtYmVkZGVkTWFwcGluZygpOwog\nICAgICAgIGlmIChlbWJlZCA9PSBudWxsKQogICAgICAgICAgICB0aHJvdyBu\nZXcgTWV0YURhdGFFeGNlcHRpb24oX2xvYy5nZXQoIm5vdC1lbWJlZGRlZCIs\nIHZtKSk7CgogICAgICAgIEZpZWxkTWFwcGluZyBlZm07CiAgICAgICAgZm9y\nIChYTWFwcGluZ092ZXJyaWRlIG92ZXIgOiBvdmVycmlkZXMpIHsKICAgICAg\nICAgICAgZWZtID0gZW1iZWQuZ2V0RmllbGRNYXBwaW5nKG92ZXIubmFtZSgp\nKTsKICAgICAgICAgICAgaWYgKGVmbSA9PSBudWxsKQogICAgICAgICAgICAg\nICAgdGhyb3cgbmV3IE1ldGFEYXRhRXhjZXB0aW9uKF9sb2MuZ2V0KCJlbWJl\nZC1vdmVycmlkZS1uYW1lIiwKICAgICAgICAgICAgICAgICAgICB2bSwgb3Zl\nci5uYW1lKCkpKTsKICAgICAgICAgICAgcG9wdWxhdGUoZWZtLCBvdmVyKTsK\nICAgICAgICB9CgogICAgICAgIFN0cmluZyBudWxsSW5kID0gbnVsbDsKICAg\nICAgICBpZiAoIVN0cmluZ1V0aWxzLmlzRW1wdHkobnVsbEluZGljYXRvckF0\ndHJpYnV0ZSkpCiAgICAgICAgICAgIG51bGxJbmQgPSBudWxsSW5kaWNhdG9y\nQXR0cmlidXRlOwogICAgICAgIGVsc2UgaWYgKCFTdHJpbmdVdGlscy5pc0Vt\ncHR5KG51bGxJbmRpY2F0b3JDb2x1bW4pKQogICAgICAgICAgICBudWxsSW5k\nID0gbnVsbEluZGljYXRvckNvbHVtbjsKICAgICAgICBpZiAobnVsbEluZCA9\nPSBudWxsKQogICAgICAgICAgICByZXR1cm47CgogICAgICAgIFZhbHVlTWFw\ncGluZ0luZm8gaW5mbyA9IHZtLmdldFZhbHVlSW5mbygpOwogICAgICAgIHBv\ncHVsYXRlTnVsbEluZGljYXRvcihudWxsSW5kLCBpbmZvKTsKICAgIH0KCiAg\nICBwcml2YXRlIHZvaWQgcG9wdWxhdGVOdWxsSW5kaWNhdG9yKFN0cmluZyBu\ndWxsSW5kLCBWYWx1ZU1hcHBpbmdJbmZvIGluZm8pIHsKICAgICAgICBpZiAo\nImZhbHNlIi5lcXVhbHMobnVsbEluZCkpCiAgICAgICAgICAgIGluZm8uc2V0\nQ2FuSW5kaWNhdGVOdWxsKGZhbHNlKTsKICAgICAgICBlbHNlIHsKICAgICAg\nICAgICAgQ29sdW1uIGNvbCA9IG5ldyBDb2x1bW4oKTsKICAgICAgICAgICAg\naWYgKCEidHJ1ZSIuZXF1YWxzKG51bGxJbmQpKQogICAgICAgICAgICAgICAg\nY29sLnNldE5hbWUobnVsbEluZCk7CiAgICAgICAgICAgIGluZm8uc2V0Q29s\ndW1ucyhBcnJheXMuYXNMaXN0KG5ldyBDb2x1bW5bXXsgY29sIH0pKTsKICAg\nICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBQYXJzZSBAQ29udGFpbmVy\nVGFibGUuCiAgICAgKi8KICAgIHByb3RlY3RlZCB2b2lkIHBhcnNlQ29udGFp\nbmVyVGFibGUoRmllbGRNYXBwaW5nIGZtLCBDb250YWluZXJUYWJsZSBjdGJs\nKSB7CiAgICAgICAgZm0uZ2V0TWFwcGluZ0luZm8oKS5zZXRUYWJsZU5hbWUo\ndG9UYWJsZU5hbWUoY3RibC5zY2hlbWEoKSwKICAgICAgICAgICAgY3RibC5u\nYW1lKCkpKTsKICAgICAgICBwYXJzZVhKb2luQ29sdW1ucyhmbSwgZm0uZ2V0\nTWFwcGluZ0luZm8oKSwgZmFsc2UsIGN0Ymwuam9pbkNvbHVtbnMoKSk7CiAg\nICAgICAgaWYgKGN0Ymwuam9pbkZvcmVpZ25LZXkoKS5zcGVjaWZpZWQoKSkK\nICAgICAgICAgICAgcGFyc2VGb3JlaWduS2V5KGZtLmdldE1hcHBpbmdJbmZv\nKCksIGN0Ymwuam9pbkZvcmVpZ25LZXkoKSk7CiAgICAgICAgaWYgKGN0Ymwu\nam9pbkluZGV4KCkuc3BlY2lmaWVkKCkpCiAgICAgICAgICAgIHBhcnNlSW5k\nZXgoZm0uZ2V0TWFwcGluZ0luZm8oKSwgY3RibC5qb2luSW5kZXgoKSk7CiAg\nICB9CgogICAgLyoqCiAgICAgKiBQYXJzZSBAT3JkZXJDb2x1bW4uCiAgICAg\nKi8KICAgIHByaXZhdGUgdm9pZCBwYXJzZU9yZGVyQ29sdW1uKEZpZWxkTWFw\ncGluZyBmbSwgT3JkZXJDb2x1bW4gb3JkZXIpIHsKICAgICAgICBpZiAoIW9y\nZGVyLmVuYWJsZWQoKSkgewogICAgICAgICAgICBmbS5nZXRNYXBwaW5nSW5m\nbygpLnNldENhbk9yZGVyQ29sdW1uKGZhbHNlKTsKICAgICAgICAgICAgcmV0\ndXJuOwogICAgICAgIH0KCiAgICAgICAgQ29sdW1uIGNvbCA9IG5ldyBDb2x1\nbW4oKTsKICAgICAgICBpZiAoIVN0cmluZ1V0aWxzLmlzRW1wdHkob3JkZXIu\nbmFtZSgpKSkKICAgICAgICAgICAgY29sLnNldE5hbWUob3JkZXIubmFtZSgp\nKTsKICAgICAgICBpZiAoIVN0cmluZ1V0aWxzLmlzRW1wdHkob3JkZXIuY29s\ndW1uRGVmaW5pdGlvbigpKSkKICAgICAgICAgICAgY29sLnNldFR5cGVOYW1l\nKG9yZGVyLmNvbHVtbkRlZmluaXRpb24oKSk7CiAgICAgICAgaWYgKG9yZGVy\nLnByZWNpc2lvbigpICE9IDApCiAgICAgICAgICAgIGNvbC5zZXRTaXplKG9y\nZGVyLnByZWNpc2lvbigpKTsKICAgICAgICBjb2wuc2V0RmxhZyhDb2x1bW4u\nRkxBR19VTklOU0VSVEFCTEUsICFvcmRlci5pbnNlcnRhYmxlKCkpOwogICAg\nICAgIGNvbC5zZXRGbGFnKENvbHVtbi5GTEFHX1VOVVBEQVRBQkxFLCAhb3Jk\nZXIudXBkYXRhYmxlKCkpOwogICAgICAgIGZtLmdldE1hcHBpbmdJbmZvKCku\nc2V0T3JkZXJDb2x1bW4oY29sKTsKICAgIH0KCiAgICAvKioKICAgICAqIFBh\ncnNlIEBFbGVtZW50Sm9pbkNvbHVtbihzKS4KICAgICAqLwogICAgcHJvdGVj\ndGVkIHZvaWQgcGFyc2VFbGVtZW50Sm9pbkNvbHVtbnMoRmllbGRNYXBwaW5n\nIGZtLAogICAgICAgIEVsZW1lbnRKb2luQ29sdW1uLi4uIGpvaW5zKSB7CiAg\nICAgICAgaWYgKGpvaW5zLmxlbmd0aCA9PSAwKQogICAgICAgICAgICByZXR1\ncm47CgogICAgICAgIExpc3Q8Q29sdW1uPiBjb2xzID0gbmV3IEFycmF5TGlz\ndDxDb2x1bW4+KGpvaW5zLmxlbmd0aCk7CiAgICAgICAgaW50IHVuaXF1ZSA9\nIDA7CiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBqb2lucy5sZW5ndGg7\nIGkrKykgewogICAgICAgICAgICBjb2xzLmFkZChuZXdDb2x1bW4oam9pbnNb\naV0pKTsKICAgICAgICAgICAgdW5pcXVlIHw9IChqb2luc1tpXS51bmlxdWUo\nKSkgPyBUUlVFIDogRkFMU0U7CiAgICAgICAgfQogICAgICAgIHNldENvbHVt\nbnMoZm0sIGZtLmdldEVsZW1lbnRNYXBwaW5nKCkuZ2V0VmFsdWVJbmZvKCks\nIGNvbHMsIHVuaXF1ZSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBDcmVhdGUg\nYSBuZXcgc2NoZW1hIGNvbHVtbiB3aXRoIGluZm9ybWF0aW9uIGZyb20gdGhl\nIGdpdmVuIGFubm90YXRpb24uCiAgICAgKi8KICAgIHByaXZhdGUgc3RhdGlj\nIENvbHVtbiBuZXdDb2x1bW4oRWxlbWVudEpvaW5Db2x1bW4gam9pbikgewog\nICAgICAgIENvbHVtbiBjb2wgPSBuZXcgQ29sdW1uKCk7CiAgICAgICAgaWYg\nKCFTdHJpbmdVdGlscy5pc0VtcHR5KGpvaW4ubmFtZSgpKSkKICAgICAgICAg\nICAgY29sLnNldE5hbWUoam9pbi5uYW1lKCkpOwogICAgICAgIGlmICghU3Ry\naW5nVXRpbHMuaXNFbXB0eShqb2luLmNvbHVtbkRlZmluaXRpb24oKSkpCiAg\nICAgICAgICAgIGNvbC5zZXRUeXBlTmFtZShqb2luLmNvbHVtbkRlZmluaXRp\nb24oKSk7CiAgICAgICAgaWYgKCFTdHJpbmdVdGlscy5pc0VtcHR5KGpvaW4u\ncmVmZXJlbmNlZENvbHVtbk5hbWUoKSkpCiAgICAgICAgICAgIGNvbC5zZXRU\nYXJnZXQoam9pbi5yZWZlcmVuY2VkQ29sdW1uTmFtZSgpKTsKICAgICAgICBp\nZiAoIVN0cmluZ1V0aWxzLmlzRW1wdHkoam9pbi5yZWZlcmVuY2VkQXR0cmli\ndXRlTmFtZSgpKSkKICAgICAgICAgICAgY29sLnNldFRhcmdldEZpZWxkKGpv\naW4ucmVmZXJlbmNlZEF0dHJpYnV0ZU5hbWUoKSk7CiAgICAgICAgY29sLnNl\ndE5vdE51bGwoIWpvaW4ubnVsbGFibGUoKSk7CiAgICAgICAgY29sLnNldEZs\nYWcgKENvbHVtbi5GTEFHX1VOSU5TRVJUQUJMRSwgIWpvaW4uaW5zZXJ0YWJs\nZSAoKSk7CgkJY29sLnNldEZsYWcgKENvbHVtbi5GTEFHX1VOVVBEQVRBQkxF\nLCAham9pbi51cGRhdGFibGUgKCkpOwoJCXJldHVybiBjb2w7Cgl9Cn0K\n","encoding":"base64"}

