{"sha":"a63b407f1606e5a468a2465773cd626046452809","node_id":"MDQ6QmxvYjIwNjM2NDphNjNiNDA3ZjE2MDZlNWE0NjhhMjQ2NTc3M2NkNjI2MDQ2NDUyODA5","size":31930,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/a63b407f1606e5a468a2465773cd626046452809","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuamRiYzsK\nCmltcG9ydCBqYXZhLmxhbmcucmVmbGVjdC5Nb2RpZmllcjsKaW1wb3J0IGph\ndmEuc3FsLlR5cGVzOwppbXBvcnQgamF2YS51dGlsLkFycmF5TGlzdDsKaW1w\nb3J0IGphdmEudXRpbC5BcnJheXM7CmltcG9ydCBqYXZhLnV0aWwuRW51bVNl\ndDsKaW1wb3J0IGphdmEudXRpbC5IYXNoTWFwOwppbXBvcnQgamF2YS51dGls\nLkxpc3Q7CmltcG9ydCBqYXZhLnV0aWwuTWFwOwppbXBvcnQgamF2YXgucGVy\nc2lzdGVuY2UuRGlzY3JpbWluYXRvclR5cGU7CmltcG9ydCBqYXZheC5wZXJz\naXN0ZW5jZS5FbnVtVHlwZTsKaW1wb3J0IGphdmF4LnBlcnNpc3RlbmNlLklu\naGVyaXRhbmNlVHlwZTsKaW1wb3J0IGphdmF4LnBlcnNpc3RlbmNlLlRlbXBv\ncmFsVHlwZTsKCmltcG9ydCBvcmcuYXBhY2hlLmNvbW1vbnMubGFuZy5TdHJp\nbmdVdGlsczsKaW1wb3J0IG9yZy54bWwuc2F4LkF0dHJpYnV0ZXM7CmltcG9y\ndCBvcmcueG1sLnNheC5TQVhFeGNlcHRpb247CmltcG9ydCBvcmcuYXBhY2hl\nLm9wZW5qcGEuamRiYy5jb25mLkpEQkNDb25maWd1cmF0aW9uOwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0YS5DbGFzc01hcHBpbmc7Cmlt\ncG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhLkNsYXNzTWFwcGlu\nZ0luZm87CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhLkRp\nc2NyaW1pbmF0b3JNYXBwaW5nSW5mbzsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5qZGJjLm1ldGEuRmllbGRNYXBwaW5nOwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLmpkYmMubWV0YS5GaWVsZE1hcHBpbmdJbmZvOwppbXBvcnQg\nb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMubWV0YS5NYXBwaW5nSW5mbzsKaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLm1ldGEuTWFwcGluZ1JlcG9z\naXRvcnk7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEuamRiYy5tZXRhLlF1\nZXJ5UmVzdWx0TWFwcGluZzsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5q\nZGJjLm1ldGEuU2VxdWVuY2VNYXBwaW5nOwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLmpkYmMubWV0YS5zdHJhdHMuRW51bVZhbHVlSGFuZGxlcjsKaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLm1ldGEuc3RyYXRzLkZsYXRD\nbGFzc1N0cmF0ZWd5OwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBhLmpkYmMu\nbWV0YS5zdHJhdHMuRnVsbENsYXNzU3RyYXRlZ3k7CmltcG9ydCBvcmcuYXBh\nY2hlLm9wZW5qcGEuamRiYy5tZXRhLnN0cmF0cy5Ob25lQ2xhc3NTdHJhdGVn\neTsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5qZGJjLm1ldGEuc3RyYXRz\nLlZlcnRpY2FsQ2xhc3NTdHJhdGVneTsKaW1wb3J0IG9yZy5hcGFjaGUub3Bl\nbmpwYS5qZGJjLnNjaGVtYS5Db2x1bW47CmltcG9ydCBvcmcuYXBhY2hlLm9w\nZW5qcGEuamRiYy5zY2hlbWEuVW5pcXVlOwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLmxpYi5sb2cuTG9nOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLmxpYi51dGlsLkxvY2FsaXplcjsKaW1wb3J0IG9yZy5hcGFjaGUub3Blbmpw\nYS5tZXRhLkNsYXNzTWV0YURhdGE7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5q\ncGEubWV0YS5GaWVsZE1ldGFEYXRhOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVu\nanBhLm1ldGEuSmF2YVR5cGVzOwppbXBvcnQgb3JnLmFwYWNoZS5vcGVuanBh\nLm1ldGEuTWV0YURhdGFSZXBvc2l0b3J5OwppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLnBlcnNpc3RlbmNlLlhNTFBlcnNpc3RlbmNlTWV0YURhdGFQYXJz\nZXI7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEudXRpbC5JbnRlcm5hbEV4\nY2VwdGlvbjsKCmltcG9ydCBzdGF0aWMgb3JnLmFwYWNoZS5vcGVuanBhLnBl\ncnNpc3RlbmNlLmpkYmMuTWFwcGluZ1RhZy4qOwoKLyoqCiAqIEN1c3RvbSBT\nQVggcGFyc2VyIHVzZWQgYnkgdGhlIHN5c3RlbSB0byBwYXJzZSBwZXJzaXN0\nZW5jZSBtYXBwaW5nIGZpbGVzLgogKgogKiBAYXV0aG9yIFN0ZXZlIEtpbQog\nKiBAbm9qYXZhZG9jCiAqLwpwdWJsaWMgY2xhc3MgWE1MUGVyc2lzdGVuY2VN\nYXBwaW5nUGFyc2VyCiAgICBleHRlbmRzIFhNTFBlcnNpc3RlbmNlTWV0YURh\ndGFQYXJzZXIgewoKICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIE1hcDxTdHJp\nbmcsIE1hcHBpbmdUYWc+IF9lbGVtcyA9CiAgICAgICAgbmV3IEhhc2hNYXA8\nU3RyaW5nLCBNYXBwaW5nVGFnPigpOwoKICAgIHN0YXRpYyB7CiAgICAgICAg\nX2VsZW1zLnB1dCgiYXNzb2NpYXRpb24tb3ZlcnJpZGUiLCBBU1NPQ19PVkVS\nUklERSk7CiAgICAgICAgX2VsZW1zLnB1dCgiYXR0cmlidXRlLW92ZXJyaWRl\nIiwgQVRUUl9PVkVSUklERSk7CiAgICAgICAgX2VsZW1zLnB1dCgiY29sdW1u\nIiwgQ09MKTsKICAgICAgICBfZWxlbXMucHV0KCJjb2x1bW4tbmFtZSIsIENP\nTFVNTl9OQU1FKTsKICAgICAgICBfZWxlbXMucHV0KCJjb2x1bW4tcmVzdWx0\nIiwgQ09MVU1OX1JFU1VMVCk7CiAgICAgICAgX2VsZW1zLnB1dCgiZGlzY3Jp\nbWluYXRvci1jb2x1bW4iLCBESVNDUklNX0NPTCk7CiAgICAgICAgX2VsZW1z\nLnB1dCgiZGlzY3JpbWluYXRvci12YWx1ZSIsIERJU0NSSU1fVkFMKTsKICAg\nICAgICBfZWxlbXMucHV0KCJlbnRpdHktcmVzdWx0IiwgRU5USVRZX1JFU1VM\nVCk7CiAgICAgICAgX2VsZW1zLnB1dCgiZW51bWVyYXRlZCIsIEVOVU1FUkFU\nRUQpOwogICAgICAgIF9lbGVtcy5wdXQoImZpZWxkLXJlc3VsdCIsIEZJRUxE\nX1JFU1VMVCk7CiAgICAgICAgX2VsZW1zLnB1dCgiaW5oZXJpdGFuY2UiLCBJ\nTkhFUklUQU5DRSk7CiAgICAgICAgX2VsZW1zLnB1dCgiam9pbi1jb2x1bW4i\nLCBKT0lOX0NPTCk7CiAgICAgICAgX2VsZW1zLnB1dCgiaW52ZXJzZS1qb2lu\nLWNvbHVtbiIsIENPTCk7CiAgICAgICAgX2VsZW1zLnB1dCgiam9pbi10YWJs\nZSIsIEpPSU5fVEFCTEUpOwogICAgICAgIF9lbGVtcy5wdXQoInByaW1hcnkt\na2V5LWpvaW4tY29sdW1uIiwgUEtfSk9JTl9DT0wpOwogICAgICAgIF9lbGVt\ncy5wdXQoInNlY29uZGFyeS10YWJsZSIsIFNFQ09OREFSWV9UQUJMRSk7CiAg\nICAgICAgX2VsZW1zLnB1dCgic3FsLXJlc3VsdC1zZXQtbWFwcGluZyIsIFNR\nTF9SRVNVTFRfU0VUX01BUFBJTkcpOwogICAgICAgIF9lbGVtcy5wdXQoInRh\nYmxlIiwgVEFCTEUpOwogICAgICAgIF9lbGVtcy5wdXQoInRhYmxlLWdlbmVy\nYXRvciIsIFRBQkxFX0dFTik7CiAgICAgICAgX2VsZW1zLnB1dCgidGVtcG9y\nYWwiLCBURU1QT1JBTCk7CiAgICAgICAgX2VsZW1zLnB1dCgidW5pcXVlLWNv\nbnN0cmFpbnQiLCBVTklRVUUpOwogICAgfQoKICAgIHByaXZhdGUgc3RhdGlj\nIGZpbmFsIExvY2FsaXplciBfbG9jID0gTG9jYWxpemVyLmZvclBhY2thZ2UK\nICAgICAgICAoWE1MUGVyc2lzdGVuY2VNYXBwaW5nUGFyc2VyLmNsYXNzKTsK\nCiAgICBwcml2YXRlIFN0cmluZyBfb3ZlcnJpZGUgPSBudWxsOwogICAgcHJp\ndmF0ZSBTdHJpbmcgX3NjaGVtYSA9IG51bGw7CiAgICBwcml2YXRlIFN0cmlu\nZyBfY29sVGFibGUgPSBudWxsOwogICAgcHJpdmF0ZSBTdHJpbmcgX3NlY29u\nZGFyeVRhYmxlID0gbnVsbDsKICAgIHByaXZhdGUgTGlzdDxDb2x1bW4+IF9j\nb2xzID0gbnVsbDsKICAgIHByaXZhdGUgTGlzdDxDb2x1bW4+IF9qb2luQ29s\ncyA9IG51bGw7CiAgICBwcml2YXRlIExpc3Q8Q29sdW1uPiBfc3VwSm9pbkNv\nbHMgPSBudWxsOwogICAgcHJpdmF0ZSBib29sZWFuIF9sb2IgPSBmYWxzZTsK\nICAgIHByaXZhdGUgVGVtcG9yYWxUeXBlIF90ZW1wb3JhbCA9IG51bGw7CiAg\nICBwcml2YXRlIEVudW1TZXQ8VW5pcXVlRmxhZz4gX3VuaXF1ZSA9IEVudW1T\nZXQubm9uZU9mKFVuaXF1ZUZsYWcuY2xhc3MpOwogICAgcHJpdmF0ZSBEaXNj\ncmltaW5hdG9yVHlwZSBfZGlzY1R5cGU7CiAgICBwcml2YXRlIENvbHVtbiBf\nZGlzY0NvbDsKICAgIHByaXZhdGUgaW50IF9yZXN1bHRJZHggPSAwOwoKICAg\nIC8qKgogICAgICogQ29uc3RydWN0b3I7IHN1cHBseSBjb25maWd1cmF0aW9u\nLgogICAgICovCiAgICBwdWJsaWMgWE1MUGVyc2lzdGVuY2VNYXBwaW5nUGFy\nc2VyKEpEQkNDb25maWd1cmF0aW9uIGNvbmYpIHsKICAgICAgICBzdXBlcihj\nb25mKTsKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHByb3RlY3RlZCB2b2lk\nIHJlc2V0KCkgewogICAgICAgIHN1cGVyLnJlc2V0KCk7CiAgICAgICAgY2xl\nYXJDb2x1bW5JbmZvKCk7CiAgICAgICAgY2xlYXJDbGFzc0luZm8oKTsKICAg\nICAgICBjbGVhclNlY29uZGFyeVRhYmxlSW5mbygpOwogICAgICAgIF9vdmVy\ncmlkZSA9IG51bGw7CiAgICAgICAgX3NjaGVtYSA9IG51bGw7CiAgICAgICAg\nX3Jlc3VsdElkeCA9IDA7CiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwcm90\nZWN0ZWQgT2JqZWN0IHN0YXJ0U3lzdGVtTWFwcGluZ0VsZW1lbnQoU3RyaW5n\nIG5hbWUsIEF0dHJpYnV0ZXMgYXR0cnMpCiAgICAgICAgdGhyb3dzIFNBWEV4\nY2VwdGlvbiB7CiAgICAgICAgTWFwcGluZ1RhZyB0YWcgPSBfZWxlbXMuZ2V0\nKG5hbWUpOwogICAgICAgIGlmICh0YWcgPT0gbnVsbCkgewogICAgICAgICAg\nICBpZiAoInNjaGVtYSIuZXF1YWxzKG5hbWUpKQogICAgICAgICAgICAgICAg\ncmV0dXJuIG5hbWU7CiAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAg\nIH0KCiAgICAgICAgYm9vbGVhbiByZXQ7CiAgICAgICAgc3dpdGNoICh0YWcp\nIHsKICAgICAgICAgICAgY2FzZSBUQUJMRV9HRU46CiAgICAgICAgICAgICAg\nICByZXQgPSBzdGFydFRhYmxlR2VuZXJhdG9yKGF0dHJzKTsKICAgICAgICAg\nICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIFNRTF9SRVNVTFRfU0VU\nX01BUFBJTkc6CiAgICAgICAgICAgICAgICByZXQgPSBzdGFydFNRTFJlc3Vs\ndFNldE1hcHBpbmcoYXR0cnMpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAg\nICAgICAgICAgIGNhc2UgRU5USVRZX1JFU1VMVDoKICAgICAgICAgICAgICAg\nIHJldCA9IHN0YXJ0RW50aXR5UmVzdWx0KGF0dHJzKTsKICAgICAgICAgICAg\nICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIEZJRUxEX1JFU1VMVDoKICAg\nICAgICAgICAgICAgIHJldCA9IHN0YXJ0RmllbGRSZXN1bHQoYXR0cnMpOwog\nICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgQ09MVU1O\nX1JFU1VMVDoKICAgICAgICAgICAgICAgIHJldCA9IHN0YXJ0Q29sdW1uUmVz\ndWx0KGF0dHJzKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAg\nICBkZWZhdWx0OgogICAgICAgICAgICAgICAgcmV0ID0gZmFsc2U7CiAgICAg\nICAgfQogICAgICAgIHJldHVybiAocmV0KSA/IHRhZyA6IG51bGw7CiAgICB9\nCgogICAgQE92ZXJyaWRlCiAgICBwcm90ZWN0ZWQgdm9pZCBlbmRTeXN0ZW1N\nYXBwaW5nRWxlbWVudChTdHJpbmcgbmFtZSkKICAgICAgICB0aHJvd3MgU0FY\nRXhjZXB0aW9uIHsKICAgICAgICBNYXBwaW5nVGFnIHRhZyA9IF9lbGVtcy5n\nZXQobmFtZSk7CiAgICAgICAgaWYgKHRhZyA9PSBudWxsKSB7CiAgICAgICAg\nICAgIGlmICgic2NoZW1hIi5lcXVhbHMobmFtZSkpCiAgICAgICAgICAgICAg\nICBfc2NoZW1hID0gY3VycmVudFRleHQoKTsKICAgICAgICAgICAgcmV0dXJu\nOwogICAgICAgIH0KCiAgICAgICAgc3dpdGNoICh0YWcpIHsKICAgICAgICAg\nICAgY2FzZSBTUUxfUkVTVUxUX1NFVF9NQVBQSU5HOgogICAgICAgICAgICAg\nICAgZW5kU1FMUmVzdWx0U2V0TWFwcGluZygpOwogICAgICAgICAgICAgICAg\nYnJlYWs7CiAgICAgICAgICAgIGNhc2UgRU5USVRZX1JFU1VMVDoKICAgICAg\nICAgICAgICAgIGVuZEVudGl0eVJlc3VsdCgpOwogICAgICAgICAgICAgICAg\nYnJlYWs7CiAgICAgICAgfQogICAgfQoKICAgIEBPdmVycmlkZQogICAgcHJv\ndGVjdGVkIE9iamVjdCBzdGFydENsYXNzTWFwcGluZ0VsZW1lbnQoU3RyaW5n\nIG5hbWUsIEF0dHJpYnV0ZXMgYXR0cnMpCiAgICAgICAgdGhyb3dzIFNBWEV4\nY2VwdGlvbiB7CiAgICAgICAgTWFwcGluZ1RhZyB0YWcgPSBfZWxlbXMuZ2V0\nKG5hbWUpOwogICAgICAgIGlmICh0YWcgPT0gbnVsbCkKICAgICAgICAgICAg\ncmV0dXJuIG51bGw7CgogICAgICAgIGJvb2xlYW4gcmV0OwogICAgICAgIHN3\naXRjaCAodGFnKSB7CiAgICAgICAgICAgIGNhc2UgVEFCTEU6CiAgICAgICAg\nICAgICAgICByZXQgPSBzdGFydFRhYmxlKGF0dHJzKTsKICAgICAgICAgICAg\nICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIFNFQ09OREFSWV9UQUJMRToK\nICAgICAgICAgICAgICAgIHJldCA9IHN0YXJ0U2Vjb25kYXJ5VGFibGUoYXR0\ncnMpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2Ug\nRElTQ1JJTV9DT0w6CiAgICAgICAgICAgICAgICBwYXJzZURpc2NyaW1pbmF0\nb3JDb2x1bW4oYXR0cnMpOwogICAgICAgICAgICAgICAgX2Rpc2NDb2wgPSBw\nYXJzZUNvbHVtbihhdHRycyk7CiAgICAgICAgICAgICAgICByZXQgPSB0cnVl\nOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgRElT\nQ1JJTV9WQUw6CiAgICAgICAgICAgICAgICByZXQgPSB0cnVlOwogICAgICAg\nICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgSU5IRVJJVEFOQ0U6\nCiAgICAgICAgICAgICAgICByZXQgPSBzdGFydEluaGVyaXRhbmNlKGF0dHJz\nKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIEFT\nU09DX09WRVJSSURFOgogICAgICAgICAgICBjYXNlIEFUVFJfT1ZFUlJJREU6\nCiAgICAgICAgICAgICAgICByZXQgPSBzdGFydEF0dHJpYnV0ZU92ZXJyaWRl\nKGF0dHJzKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBj\nYXNlIFBLX0pPSU5fQ09MOgogICAgICAgICAgICAgICAgcmV0ID0gc3RhcnRQ\ncmltYXJ5S2V5Sm9pbkNvbHVtbihhdHRycyk7CiAgICAgICAgICAgICAgICBi\ncmVhazsKICAgICAgICAgICAgY2FzZSBDT0w6CiAgICAgICAgICAgICAgICBy\nZXQgPSBzdGFydENvbHVtbihhdHRycyk7CiAgICAgICAgICAgICAgICBicmVh\nazsKICAgICAgICAgICAgY2FzZSBKT0lOX0NPTDoKICAgICAgICAgICAgICAg\nIHJldCA9IHN0YXJ0Sm9pbkNvbHVtbihhdHRycyk7CiAgICAgICAgICAgICAg\nICBicmVhazsKICAgICAgICAgICAgY2FzZSBKT0lOX1RBQkxFOgogICAgICAg\nICAgICAgICAgcmV0ID0gc3RhcnRKb2luVGFibGUoYXR0cnMpOwogICAgICAg\nICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgVEFCTEVfR0VOOgog\nICAgICAgICAgICAgICAgcmV0ID0gc3RhcnRUYWJsZUdlbmVyYXRvcihhdHRy\ncyk7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSBV\nTklRVUU6CiAgICAgICAgICAgICAgICByZXQgPSBzdGFydFVuaXF1ZUNvbnN0\ncmFpbnQoYXR0cnMpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAg\nICAgIGNhc2UgVEVNUE9SQUw6CiAgICAgICAgICAgIGNhc2UgRU5VTUVSQVRF\nRDoKICAgICAgICAgICAgICAgIHJldCA9IHRydWU7CiAgICAgICAgICAgICAg\nICBicmVhazsKICAgICAgICAgICAgY2FzZSBTUUxfUkVTVUxUX1NFVF9NQVBQ\nSU5HOgogICAgICAgICAgICAgICAgcmV0ID0gc3RhcnRTUUxSZXN1bHRTZXRN\nYXBwaW5nKGF0dHJzKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAg\nICAgICBjYXNlIEVOVElUWV9SRVNVTFQ6CiAgICAgICAgICAgICAgICByZXQg\nPSBzdGFydEVudGl0eVJlc3VsdChhdHRycyk7CiAgICAgICAgICAgICAgICBi\ncmVhazsKICAgICAgICAgICAgY2FzZSBGSUVMRF9SRVNVTFQ6CiAgICAgICAg\nICAgICAgICByZXQgPSBzdGFydEZpZWxkUmVzdWx0KGF0dHJzKTsKICAgICAg\nICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIENPTFVNTl9SRVNV\nTFQ6CiAgICAgICAgICAgICAgICByZXQgPSBzdGFydENvbHVtblJlc3VsdChh\ndHRycyk7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2Fz\nZSBDT0xVTU5fTkFNRToKICAgICAgICAgICAgICAgIHJldCA9IHRydWU7CiAg\nICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgZGVmYXVsdDoKICAg\nICAgICAgICAgICAgIHJldCA9IGZhbHNlOwogICAgICAgIH0KICAgICAgICBy\nZXR1cm4gKHJldCkgPyB0YWcgOiBudWxsOwogICAgfQoKICAgIEBPdmVycmlk\nZQogICAgcHJvdGVjdGVkIHZvaWQgZW5kQ2xhc3NNYXBwaW5nRWxlbWVudChT\ndHJpbmcgbmFtZSkKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAg\nICAgICBNYXBwaW5nVGFnIHRhZyA9IF9lbGVtcy5nZXQobmFtZSk7CiAgICAg\nICAgaWYgKHRhZyA9PSBudWxsKQogICAgICAgICAgICByZXR1cm47CgogICAg\nICAgIHN3aXRjaCAodGFnKSB7CiAgICAgICAgICAgIGNhc2UgU0VDT05EQVJZ\nX1RBQkxFOgogICAgICAgICAgICAgICAgZW5kU2Vjb25kYXJ5VGFibGUoKTsK\nICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIERJU0NS\nSU1fVkFMOgogICAgICAgICAgICAgICAgZW5kRGlzY3JpbWluYXRvclZhbHVl\nKCk7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSBB\nVFRSX09WRVJSSURFOgogICAgICAgICAgICAgICAgZW5kQXR0cmlidXRlT3Zl\ncnJpZGUoKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBj\nYXNlIEpPSU5fVEFCTEU6CiAgICAgICAgICAgICAgICBlbmRKb2luVGFibGUo\nKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIFRF\nTVBPUkFMOgogICAgICAgICAgICAgICAgZW5kVGVtcG9yYWwoKTsKICAgICAg\nICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIEVOVU1FUkFURUQ6\nCiAgICAgICAgICAgICAgICBlbmRFbnVtZXJhdGVkKCk7CiAgICAgICAgICAg\nICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSBTUUxfUkVTVUxUX1NFVF9N\nQVBQSU5HOgogICAgICAgICAgICAgICAgZW5kU1FMUmVzdWx0U2V0TWFwcGlu\nZygpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2Ug\nRU5USVRZX1JFU1VMVDoKICAgICAgICAgICAgICAgIGVuZEVudGl0eVJlc3Vs\ndCgpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2Ug\nVU5JUVVFOgogICAgICAgICAgICAgICAgZW5kVW5pcXVlQ29uc3RyYWludCgp\nOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgQ09M\nVU1OX05BTUU6CiAgICAgICAgICAgICAgICBlbmRDb2x1bW5OYW1lKCk7CiAg\nICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSBUQUJMRV9H\nRU46CiAgICAgICAgICAgIAllbmRUYWJsZUdlbmVyYXRvcigpOwogICAgICAg\nICAgICAJYnJlYWs7CiAgICAgICAgfQogICAgfQoKICAgIEBPdmVycmlkZQog\nICAgcHJvdGVjdGVkIHZvaWQgc3RhcnRDbGFzc01hcHBpbmcoQ2xhc3NNZXRh\nRGF0YSBtZXRhLCBib29sZWFuIG1hcHBlZFN1cGVyLAogICAgICAgIEF0dHJp\nYnV0ZXMgYXR0cnMpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAg\nICAgICAgaWYgKG1hcHBlZFN1cGVyKQogICAgICAgICAgICAoKENsYXNzTWFw\ncGluZykgbWV0YSkuZ2V0TWFwcGluZ0luZm8oKS5zZXRTdHJhdGVneQogICAg\nICAgICAgICAgICAgKE5vbmVDbGFzc1N0cmF0ZWd5LkFMSUFTKTsKICAgIH0K\nCiAgICBAT3ZlcnJpZGUKICAgIHByb3RlY3RlZCB2b2lkIGVuZENsYXNzTWFw\ncGluZyhDbGFzc01ldGFEYXRhIG1ldGEpCiAgICAgICAgdGhyb3dzIFNBWEV4\nY2VwdGlvbiB7CiAgICAgICAgQ2xhc3NNYXBwaW5nIGNtID0gKENsYXNzTWFw\ncGluZykgbWV0YTsKICAgICAgICBpZiAoX3NjaGVtYSAhPSBudWxsKQogICAg\nICAgICAgICBjbS5nZXRNYXBwaW5nSW5mbygpLnNldFNjaGVtYU5hbWUoX3Nj\naGVtYSk7CgogICAgICAgIGlmIChfc3VwSm9pbkNvbHMgIT0gbnVsbCkKICAg\nICAgICAgICAgY20uZ2V0TWFwcGluZ0luZm8oKS5zZXRDb2x1bW5zKF9zdXBK\nb2luQ29scyk7CgogICAgICAgIGlmIChfZGlzY0NvbCAhPSBudWxsKSB7CiAg\nICAgICAgICAgIERpc2NyaW1pbmF0b3JNYXBwaW5nSW5mbyBkaW5mbyA9IGNt\nLmdldERpc2NyaW1pbmF0b3IoKQogICAgICAgICAgICAgICAgICAgIC5nZXRN\nYXBwaW5nSW5mbygpOwogICAgICAgICAgICBzd2l0Y2ggKF9kaXNjVHlwZSkg\newogICAgICAgICAgICAgICAgY2FzZSBDSEFSOgogICAgICAgICAgICAgICAg\nICAgIF9kaXNjQ29sLnNldEphdmFUeXBlKEphdmFUeXBlcy5DSEFSKTsKICAg\nICAgICAgICAgICAgICAgICBjbS5nZXREaXNjcmltaW5hdG9yKCkuc2V0SmF2\nYVR5cGUoSmF2YVR5cGVzLkNIQVIpOwogICAgICAgICAgICAgICAgICAgIGJy\nZWFrOwogICAgICAgICAgICAgICAgY2FzZSBJTlRFR0VSOgogICAgICAgICAg\nICAgICAgICAgIF9kaXNjQ29sLnNldEphdmFUeXBlKEphdmFUeXBlcy5JTlQp\nOwogICAgICAgICAgICAgICAgICAgIGNtLmdldERpc2NyaW1pbmF0b3IoKS5z\nZXRKYXZhVHlwZShKYXZhVHlwZXMuSU5UKTsKICAgICAgICAgICAgICAgICAg\nICBicmVhazsKICAgICAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAg\nICAgICAgICAgX2Rpc2NDb2wuc2V0SmF2YVR5cGUoSmF2YVR5cGVzLlNUUklO\nRyk7CiAgICAgICAgICAgICAgICAgICAgY20uZ2V0RGlzY3JpbWluYXRvcigp\nLnNldEphdmFUeXBlKEphdmFUeXBlcy5TVFJJTkcpOwogICAgICAgICAgICAg\nICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGRpbmZv\nLnNldENvbHVtbnMoQXJyYXlzLmFzTGlzdChuZXcgQ29sdW1uW117IF9kaXNj\nQ29sIH0pKTsKICAgICAgICB9CiAgICAgICAgY2xlYXJDbGFzc0luZm8oKTsK\nICAgIH0KCiAgICAvKioKICAgICAqIENsZWFyIGNhY2hlZCBjbGFzcyBtYXBw\naW5nIGluZm8uCiAgICAgKi8KICAgIHByaXZhdGUgdm9pZCBjbGVhckNsYXNz\nSW5mbygpIHsKICAgICAgICBfc3VwSm9pbkNvbHMgPSBudWxsOwogICAgICAg\nIF9kaXNjQ29sID0gbnVsbDsKICAgICAgICBfZGlzY1R5cGUgPSBudWxsOwog\nICAgfQoKICAgIC8qKgogICAgICogU3RhcnQgdHJhY2tpbmcgc2Vjb25kYXJ5\nIHRhYmxlIGluZm9ybWF0aW9uIGFuZCBjb2x1bW5zCiAgICAgKi8KICAgIHBy\naXZhdGUgYm9vbGVhbiBzdGFydFNlY29uZGFyeVRhYmxlKEF0dHJpYnV0ZXMg\nYXR0cnMpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAg\nX3NlY29uZGFyeVRhYmxlID0gdG9UYWJsZU5hbWUoYXR0cnMuZ2V0VmFsdWUo\nInNjaGVtYSIpLAogICAgICAgICAgICBhdHRycy5nZXRWYWx1ZSgibmFtZSIp\nKTsKICAgICAgICAoKENsYXNzTWFwcGluZyljdXJyZW50RWxlbWVudCgpKS5n\nZXRNYXBwaW5nSW5mbygpCiAgICAgICAgCS5hZGRTZWNvbmRhcnlUYWJsZShf\nc2Vjb25kYXJ5VGFibGUpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoK\nICAgIC8qKgogICAgICogU2V0IHRoZSBzZWNvbmRhcnkgdGFibGUgaW5mb3Jt\nYXRpb24gYmFjayB0byB0aGUgb3duaW5nIGNsYXNzIG1hcHBpbmcuCiAgICAg\nKi8KICAgIHByaXZhdGUgdm9pZCBlbmRTZWNvbmRhcnlUYWJsZSgpIHsKICAg\nICAgICBDbGFzc01hcHBpbmcgY20gPSAoQ2xhc3NNYXBwaW5nKSBjdXJyZW50\nRWxlbWVudCgpOwogICAgICAgIENsYXNzTWFwcGluZ0luZm8gaW5mbyA9IGNt\nLmdldE1hcHBpbmdJbmZvKCk7CiAgICAgICAgaW5mby5zZXRTZWNvbmRhcnlU\nYWJsZUpvaW5Db2x1bW5zKF9zZWNvbmRhcnlUYWJsZSwgX2pvaW5Db2xzKTsK\nICAgICAgICBjbGVhclNlY29uZGFyeVRhYmxlSW5mbygpOwogICAgfQoKICAg\nIC8qKgogICAgICogQ2xlYXIgY2FjaGVkIHNlY29uZGFyeSB0YWJsZSBpbmZv\nLgogICAgICovCiAgICBwcml2YXRlIHZvaWQgY2xlYXJTZWNvbmRhcnlUYWJs\nZUluZm8oKSB7CiAgICAgICAgX2pvaW5Db2xzID0gbnVsbDsKICAgICAgICBf\nc2Vjb25kYXJ5VGFibGUgPSBudWxsOwogICAgfQoKICAgIC8qKgogICAgICog\nUGFyc2UgdGFibGUtZ2VuZXJhdG9yLgogICAgICovCiAgICBwcml2YXRlIGJv\nb2xlYW4gc3RhcnRUYWJsZUdlbmVyYXRvcihBdHRyaWJ1dGVzIGF0dHJzKSB7\nCiAgICAgICAgU3RyaW5nIG5hbWUgPSBhdHRycy5nZXRWYWx1ZSgibmFtZSIp\nOwogICAgICAgIExvZyBsb2cgPSBnZXRMb2coKTsKICAgICAgICBpZiAobG9n\nLmlzVHJhY2VFbmFibGVkKCkpCiAgICAgICAgICAgIGxvZy50cmFjZShfbG9j\nLmdldCgicGFyc2UtZ2VuIiwgbmFtZSkpOwogICAgICAgIGlmIChnZXRSZXBv\nc2l0b3J5KCkuZ2V0Q2FjaGVkU2VxdWVuY2VNZXRhRGF0YShuYW1lKSAhPSBu\ndWxsCiAgICAgICAgICAgICYmIGxvZy5pc1dhcm5FbmFibGVkKCkpCiAgICAg\nICAgICAgIGxvZy53YXJuKF9sb2MuZ2V0KCJvdmVycmlkZS1nZW4iLCBuYW1l\nKSk7CgogICAgICAgIFNlcXVlbmNlTWFwcGluZyBzZXEgPSAoU2VxdWVuY2VN\nYXBwaW5nKSBnZXRSZXBvc2l0b3J5KCkuCiAgICAgICAgICAgIGFkZFNlcXVl\nbmNlTWV0YURhdGEobmFtZSk7CiAgICAgICAgc2VxLnNldFNlcXVlbmNlUGx1\nZ2luKFNlcXVlbmNlTWFwcGluZy5JTVBMX1ZBTFVFX1RBQkxFKTsKICAgICAg\nICBzZXEuc2V0VGFibGUodG9UYWJsZU5hbWUoYXR0cnMuZ2V0VmFsdWUoInNj\naGVtYSIpLAogICAgICAgICAgICBhdHRycy5nZXRWYWx1ZSgidGFibGUiKSkp\nOwogICAgICAgIHNlcS5zZXRQcmltYXJ5S2V5Q29sdW1uKGF0dHJzLmdldFZh\nbHVlKCJway1jb2x1bW4tbmFtZSIpKTsKICAgICAgICBzZXEuc2V0U2VxdWVu\nY2VDb2x1bW4oYXR0cnMuZ2V0VmFsdWUoInZhbHVlLWNvbHVtbi1uYW1lIikp\nOwogICAgICAgIHNlcS5zZXRQcmltYXJ5S2V5VmFsdWUoYXR0cnMuZ2V0VmFs\ndWUoInBrLWNvbHVtbi12YWx1ZSIpKTsKICAgICAgICBTdHJpbmcgdmFsID0g\nYXR0cnMuZ2V0VmFsdWUoImluaXRpYWwtdmFsdWUiKTsKICAgICAgICBpZiAo\ndmFsICE9IG51bGwpCiAgICAgICAgICAgIHNlcS5zZXRJbml0aWFsVmFsdWUo\nSW50ZWdlci5wYXJzZUludCh2YWwpKTsKICAgICAgICB2YWwgPSBhdHRycy5n\nZXRWYWx1ZSgiYWxsb2NhdGlvbi1zaXplIik7CiAgICAgICAgaWYgKHZhbCAh\nPSBudWxsKQogICAgICAgICAgICBzZXEuc2V0QWxsb2NhdGUoSW50ZWdlci5w\nYXJzZUludCh2YWwpKTsKCiAgICAgICAgT2JqZWN0IGN1ciA9IGN1cnJlbnRF\nbGVtZW50KCk7CiAgICAgICAgT2JqZWN0IHNjb3BlID0gKGN1ciBpbnN0YW5j\nZW9mIENsYXNzTWV0YURhdGEpCiAgICAgICAgICAgID8gKChDbGFzc01ldGFE\nYXRhKSBjdXIpLmdldERlc2NyaWJlZFR5cGUoKSA6IG51bGw7CiAgICAgICAg\nc2VxLnNldFNvdXJjZShnZXRTb3VyY2VGaWxlKCksIHNjb3BlLCBzZXEuU1JD\nX1hNTCk7CiAgICAgICAgcHVzaEVsZW1lbnQoc2VxKTsKICAgICAgICByZXR1\ncm4gdHJ1ZTsKICAgIH0KICAgIAogICAgcHJpdmF0ZSB2b2lkIGVuZFRhYmxl\nR2VuZXJhdG9yKCkgewogICAgCXBvcEVsZW1lbnQoKTsKICAgIH0KCiAgICAv\nKioKICAgICAqIFBhcnNlIGluaGVyaXRhbmNlLgogICAgICovCiAgICBwcml2\nYXRlIGJvb2xlYW4gc3RhcnRJbmhlcml0YW5jZShBdHRyaWJ1dGVzIGF0dHJz\nKSB7CiAgICAgICAgU3RyaW5nIHZhbCA9IGF0dHJzLmdldFZhbHVlKCJzdHJh\ndGVneSIpOwogICAgICAgIGlmICh2YWwgPT0gbnVsbCkKICAgICAgICAgICAg\ncmV0dXJuIHRydWU7CgogICAgICAgIENsYXNzTWFwcGluZyBjbSA9IChDbGFz\nc01hcHBpbmcpIGN1cnJlbnRFbGVtZW50KCk7CiAgICAgICAgQ2xhc3NNYXBw\naW5nSW5mbyBpbmZvID0gY20uZ2V0TWFwcGluZ0luZm8oKTsKICAgICAgICBz\nd2l0Y2ggKEVudW0udmFsdWVPZihJbmhlcml0YW5jZVR5cGUuY2xhc3MsIHZh\nbCkpIHsKICAgICAgICAgICAgY2FzZSBTSU5HTEVfVEFCTEU6CiAgICAgICAg\nICAgICAgICBpbmZvLnNldEhpZXJhcmNoeVN0cmF0ZWd5KEZsYXRDbGFzc1N0\ncmF0ZWd5LkFMSUFTKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAg\nICAgICBjYXNlIEpPSU5FRDoKICAgICAgICAgICAgICAgIGluZm8uc2V0SGll\ncmFyY2h5U3RyYXRlZ3koVmVydGljYWxDbGFzc1N0cmF0ZWd5LkFMSUFTKTsK\nICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIFRBQkxF\nX1BFUl9DTEFTUzoKICAgICAgICAgICAgICAgIGluZm8uc2V0SGllcmFyY2h5\nU3RyYXRlZ3koRnVsbENsYXNzU3RyYXRlZ3kuQUxJQVMpOwogICAgICAgICAg\nICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICAgIHJldHVybiB0cnVlOwog\nICAgfQoKICAgIC8qKgogICAgICogUGFyc2UgZGlzY3JpbWluYXRvci12YWx1\nZS4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIGVuZERpc2NyaW1pbmF0b3JW\nYWx1ZSgpIHsKICAgICAgICBTdHJpbmcgdmFsID0gY3VycmVudFRleHQoKTsK\nICAgICAgICBpZiAoU3RyaW5nVXRpbHMuaXNFbXB0eSh2YWwpKQogICAgICAg\nICAgICByZXR1cm47CgogICAgICAgIENsYXNzTWFwcGluZyBjbSA9IChDbGFz\nc01hcHBpbmcpIGN1cnJlbnRFbGVtZW50KCk7CiAgICAgICAgY20uZ2V0RGlz\nY3JpbWluYXRvcigpLmdldE1hcHBpbmdJbmZvKCkuc2V0VmFsdWUodmFsKTsK\nCiAgICAgICAgaWYgKE1vZGlmaWVyLmlzQWJzdHJhY3QoY20uZ2V0RGVzY3Jp\nYmVkVHlwZSgpLmdldE1vZGlmaWVycygpKQogICAgICAgICAgICAgICAgJiYg\nZ2V0TG9nKCkuaXNJbmZvRW5hYmxlZCgpKSB7CiAgICAgICAgICAgIGdldExv\nZygpLmluZm8oCiAgICAgICAgICAgICAgICAgICAgX2xvYy5nZXQoImRpc2Ny\naW1pbmF0b3Itb24tYWJzdHJhY3QtY2xhc3MiLCBjbQogICAgICAgICAgICAg\nICAgICAgICAgICAgICAgLmdldERlc2NyaWJlZFR5cGUoKS5nZXROYW1lKCkp\nKTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBQYXJzZSB0ZW1w\nb3JhbC4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIGVuZFRlbXBvcmFsKCkg\newogICAgICAgIFN0cmluZyB0ZW1wID0gY3VycmVudFRleHQoKTsKICAgICAg\nICBpZiAoIVN0cmluZ1V0aWxzLmlzRW1wdHkodGVtcCkpCiAgICAgICAgICAg\nIF90ZW1wb3JhbCA9IEVudW0udmFsdWVPZihUZW1wb3JhbFR5cGUuY2xhc3Ms\nIHRlbXApOwogICAgfQoKICAgIC8qKgogICAgICogUGFyc2UgZW51bWVyYXRl\nZC4KICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIGVuZEVudW1lcmF0ZWQoKSB7\nCiAgICAgICAgU3RyaW5nIHRleHQgPSBjdXJyZW50VGV4dCgpOwogICAgICAg\nIGlmIChTdHJpbmdVdGlscy5pc0VtcHR5KHRleHQpKQogICAgICAgICAgICBy\nZXR1cm47CiAgICAgICAgRW51bVR5cGUgdHlwZSA9IEVudW0udmFsdWVPZihF\nbnVtVHlwZS5jbGFzcywgdGV4dCk7CgogICAgICAgIEZpZWxkTWFwcGluZyBm\nbSA9IChGaWVsZE1hcHBpbmcpIGN1cnJlbnRFbGVtZW50KCk7CiAgICAgICAg\nU3RyaW5nIHN0cmF0ID0gRW51bVZhbHVlSGFuZGxlci5jbGFzcy5nZXROYW1l\nKCkgKyAiKFN0b3JlT3JkaW5hbD0iCiAgICAgICAgICAgICsgU3RyaW5nLnZh\nbHVlT2YodHlwZSA9PSBFbnVtVHlwZS5PUkRJTkFMKSArICIpIjsKICAgICAg\nICBmbS5nZXRWYWx1ZUluZm8oKS5zZXRTdHJhdGVneShzdHJhdCk7CiAgICB9\nCgogICAgQE92ZXJyaWRlCiAgICBwcm90ZWN0ZWQgYm9vbGVhbiBzdGFydExv\nYihBdHRyaWJ1dGVzIGF0dHJzKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRp\nb24gewogICAgICAgIGlmIChzdXBlci5zdGFydExvYihhdHRycykpIHsKICAg\nICAgICAgICAgX2xvYiA9IHRydWU7CiAgICAgICAgICAgIHJldHVybiB0cnVl\nOwogICAgICAgIH0KICAgICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAg\nLyoqCiAgICAgKiBFeHRlbmQgdG8gY2xlYXIgYW5ub3RhdGlvbiBtYXBwaW5n\nIGluZm8uCiAgICAgKi8KICAgIEBPdmVycmlkZQogICAgcHJvdGVjdGVkIHZv\naWQgc3RhcnRGaWVsZE1hcHBpbmcoRmllbGRNZXRhRGF0YSBmaWVsZCwgQXR0\ncmlidXRlcyBhdHRycykKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsK\nICAgICAgICBzdXBlci5zdGFydEZpZWxkTWFwcGluZyhmaWVsZCwgYXR0cnMp\nOwogICAgICAgIGlmIChnZXRBbm5vdGF0aW9uUGFyc2VyKCkgIT0gbnVsbCkg\newogICAgICAgICAgICBGaWVsZE1hcHBpbmcgZm0gPSAoRmllbGRNYXBwaW5n\nKSBmaWVsZDsKICAgICAgICAgICAgZm0uZ2V0TWFwcGluZ0luZm8oKS5jbGVh\ncigpOwogICAgICAgICAgICBmbS5nZXRWYWx1ZUluZm8oKS5jbGVhcigpOwog\nICAgICAgICAgICBmbS5nZXRFbGVtZW50TWFwcGluZygpLmdldFZhbHVlSW5m\nbygpLmNsZWFyKCk7CiAgICAgICAgICAgIGZtLmdldEtleU1hcHBpbmcoKS5n\nZXRWYWx1ZUluZm8oKS5jbGVhcigpOwogICAgICAgIH0KICAgIH0KCiAgICAv\nKioKICAgICAqIEV4dGVuZCB0byBzZXQgdGhlIGNvbHVtbnMuCiAgICAgKi8K\nICAgIEBPdmVycmlkZQogICAgcHJvdGVjdGVkIHZvaWQgZW5kRmllbGRNYXBw\naW5nKEZpZWxkTWV0YURhdGEgZmllbGQpCiAgICAgICAgdGhyb3dzIFNBWEV4\nY2VwdGlvbiB7CiAgICAgICAgLy8gc2V0dXAgY29sdW1ucyB3aXRoIGNhY2hl\nZCBsb2IgYW5kIHRlbXBvcmFsIGluZm8KICAgICAgICBGaWVsZE1hcHBpbmcg\nZm0gPSAoRmllbGRNYXBwaW5nKSBmaWVsZDsKICAgICAgICBpZiAoX2xvYiB8\nfCBfdGVtcG9yYWwgIT0gbnVsbCkgewogICAgICAgICAgICBpZiAoX2NvbHMg\nPT0gbnVsbCkgewogICAgICAgICAgICAgICAgX2NvbHMgPSBuZXcgQXJyYXlM\naXN0PENvbHVtbj4oMSk7CiAgICAgICAgICAgICAgICBfY29scy5hZGQobmV3\nIENvbHVtbigpKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBmb3IgKENv\nbHVtbiBjb2wgOiBfY29scykgewogICAgICAgICAgICAgICAgaWYgKF9sb2Ig\nJiYgKGZtLmdldERlY2xhcmVkVHlwZUNvZGUoKSA9PSBKYXZhVHlwZXMuU1RS\nSU5HCiAgICAgICAgICAgICAgICAgICAgfHwgZm0uZ2V0RGVjbGFyZWRUeXBl\nKCkgPT0gY2hhcltdLmNsYXNzCiAgICAgICAgICAgICAgICAgICAgfHwgZm0u\nZ2V0RGVjbGFyZWRUeXBlKCkgPT0gQ2hhcmFjdGVyW10uY2xhc3MpKSB7CiAg\nICAgICAgICAgICAgICAgICAgY29sLnNldFNpemUoLTEpOwogICAgICAgICAg\nICAgICAgICAgIGNvbC5zZXRUeXBlKFR5cGVzLkNMT0IpOwogICAgICAgICAg\nICAgICAgfSBlbHNlIGlmIChfbG9iKQogICAgICAgICAgICAgICAgICAgIGNv\nbC5zZXRUeXBlKFR5cGVzLkJMT0IpOwogICAgICAgICAgICAgICAgZWxzZSB7\nCiAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChfdGVtcG9yYWwpIHsKICAg\nICAgICAgICAgICAgICAgICAgICAgY2FzZSBEQVRFOgogICAgICAgICAgICAg\nICAgICAgICAgICAgICAgY29sLnNldFR5cGUoVHlwZXMuREFURSk7CiAgICAg\nICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAg\nICAgICAgICAgY2FzZSBUSU1FOgogICAgICAgICAgICAgICAgICAgICAgICAg\nICAgY29sLnNldFR5cGUoVHlwZXMuVElNRSk7CiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgY2Fz\nZSBUSU1FU1RBTVA6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2wu\nc2V0VHlwZShUeXBlcy5USU1FU1RBTVApOwogICAgICAgICAgICAgICAgICAg\nICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAg\nICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBp\nZiAoX2NvbHMgIT0gbnVsbCkgewogICAgICAgICAgICBzd2l0Y2ggKGZtLmdl\ndERlY2xhcmVkVHlwZUNvZGUoKSkgewogICAgICAgICAgICAgICAgY2FzZSBK\nYXZhVHlwZXMuQVJSQVk6CiAgICAgICAgICAgICAgICAgICAgQ2xhc3MgdHlw\nZSA9IGZtLmdldERlY2xhcmVkVHlwZSgpOwogICAgICAgICAgICAgICAgICAg\nIGlmICh0eXBlID09IGJ5dGVbXS5jbGFzcyB8fCB0eXBlID09IEJ5dGVbXS5j\nbGFzcwogICAgICAgICAgICAgICAgICAgICAgICB8fCB0eXBlID09IGNoYXJb\nXS5jbGFzcyB8fCB0eXBlID09IENoYXJhY3RlcltdLmNsYXNzICkgewogICAg\nICAgICAgICAgICAgICAgICAgICBmbS5nZXRWYWx1ZUluZm8oKS5zZXRDb2x1\nbW5zKF9jb2xzKTsKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAg\nICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIC8vIGVs\nc2Ugbm8gYnJlYWsKICAgICAgICAgICAgICAgIGNhc2UgSmF2YVR5cGVzLkNP\nTExFQ1RJT046CiAgICAgICAgICAgICAgICBjYXNlIEphdmFUeXBlcy5NQVA6\nCiAgICAgICAgICAgICAgICAgICAgZm0uZ2V0RWxlbWVudE1hcHBpbmcoKS5n\nZXRWYWx1ZUluZm8oKS5zZXRDb2x1bW5zKF9jb2xzKTsKICAgICAgICAgICAg\nICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAg\nICAgICAgICAgICAgICAgZm0uZ2V0VmFsdWVJbmZvKCkuc2V0Q29sdW1ucyhf\nY29scyk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKF9jb2xUYWJs\nZSAhPSBudWxsKQogICAgICAgICAgICAgICAgZm0uZ2V0TWFwcGluZ0luZm8o\nKS5zZXRUYWJsZU5hbWUoX2NvbFRhYmxlKTsKICAgICAgICAgICAgc2V0VW5p\ncXVlKGZtKTsKICAgICAgICB9CiAgICAgICAgY2xlYXJDb2x1bW5JbmZvKCk7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBTZXQgdW5pcXVlIGZvciBmaWVsZC4K\nICAgICAqLwogICAgcHJpdmF0ZSB2b2lkIHNldFVuaXF1ZShGaWVsZE1hcHBp\nbmcgZm0pIHsKICAgICAgICBpZiAoX3VuaXF1ZS5zaXplKCkgPT0gMikgLy8g\naS5lLiBUUlVFICYgRkFMU0UKICAgICAgICAgICAgZ2V0TG9nKCkud2Fybihf\nbG9jLmdldCgiaW5jb25zaXN0LWNvbC1hdHRycyIsIGZtKSk7CiAgICAgICAg\nZWxzZSBpZiAoX3VuaXF1ZS5jb250YWlucyhVbmlxdWVGbGFnLlRSVUUpKQog\nICAgICAgICAgICBmbS5nZXRWYWx1ZUluZm8oKS5zZXRVbmlxdWUobmV3IFVu\naXF1ZSgpKTsKICAgIH0KCiAgICAvKioKICAgICAqIENsZWFyIGZpZWxkIGxl\ndmVsIGNvbHVtbiBpbmZvcm1hdGlvbi4KICAgICAqLwogICAgcHJpdmF0ZSB2\nb2lkIGNsZWFyQ29sdW1uSW5mbygpIHsKICAgICAgICBfY29scyA9IG51bGw7\nCiAgICAgICAgX2pvaW5Db2xzID0gbnVsbDsKICAgICAgICBfY29sVGFibGUg\nPSBudWxsOwogICAgICAgIF9sb2IgPSBmYWxzZTsKICAgICAgICBfdGVtcG9y\nYWwgPSBudWxsOwogICAgICAgIF91bmlxdWUuY2xlYXIoKTsKICAgIH0KCiAg\nICAvKioKICAgICAqIFBhcnNlIGF0dHJpYnV0ZS1vdmVycmlkZS4KICAgICAq\nLwogICAgcHJpdmF0ZSBib29sZWFuIHN0YXJ0QXR0cmlidXRlT3ZlcnJpZGUo\nQXR0cmlidXRlcyBhdHRyKSB7CiAgICAgICAgX292ZXJyaWRlID0gYXR0ci5n\nZXRWYWx1ZSgibmFtZSIpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoK\nICAgIC8qKgogICAgICogU2V0IGF0dHJpYnV0ZSBvdmVycmlkZSBpbnRvIHBy\nb3BlciBtYXBwaW5nLgogICAgICovCiAgICBwcml2YXRlIHZvaWQgZW5kQXR0\ncmlidXRlT3ZlcnJpZGUoKQogICAgICAgIHRocm93cyBTQVhFeGNlcHRpb24g\newogICAgICAgIE9iamVjdCBlbGVtID0gY3VycmVudEVsZW1lbnQoKTsKICAg\nICAgICBGaWVsZE1hcHBpbmcgZm07CiAgICAgICAgaWYgKGVsZW0gaW5zdGFu\nY2VvZiBDbGFzc01hcHBpbmcpCiAgICAgICAgICAgIGZtID0gZ2V0QXR0cmli\ndXRlT3ZlcnJpZGUoKENsYXNzTWFwcGluZykgZWxlbSk7CiAgICAgICAgZWxz\nZQogICAgICAgICAgICBmbSA9IGdldEF0dHJpYnV0ZU92ZXJyaWRlKChGaWVs\nZE1hcHBpbmcpIGVsZW0pOwogICAgICAgIGlmIChfY29scyAhPSBudWxsKSB7\nCiAgICAgICAgICAgIGZtLmdldFZhbHVlSW5mbygpLnNldENvbHVtbnMoX2Nv\nbHMpOwogICAgICAgICAgICBpZiAoX2NvbFRhYmxlICE9IG51bGwpCiAgICAg\nICAgICAgICAgICBmbS5nZXRNYXBwaW5nSW5mbygpLnNldFRhYmxlTmFtZShf\nY29sVGFibGUpOwogICAgICAgICAgICBzZXRVbmlxdWUoZm0pOwogICAgICAg\nIH0KICAgICAgICBjbGVhckNvbHVtbkluZm8oKTsKICAgICAgICBfb3ZlcnJp\nZGUgPSBudWxsOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHRoZSBw\ncm9wZXIgb3ZlcnJpZGUuCiAgICAgKi8KICAgIHByaXZhdGUgRmllbGRNYXBw\naW5nIGdldEF0dHJpYnV0ZU92ZXJyaWRlKENsYXNzTWFwcGluZyBjbSkgewog\nICAgICAgIEZpZWxkTWFwcGluZyBzdXAgPSAoRmllbGRNYXBwaW5nKSBjbS5n\nZXREZWZpbmVkU3VwZXJjbGFzc0ZpZWxkCiAgICAgICAgICAgIChfb3ZlcnJp\nZGUpOwogICAgICAgIGlmIChzdXAgPT0gbnVsbCkKICAgICAgICAgICAgc3Vw\nID0gKEZpZWxkTWFwcGluZykgY20uYWRkRGVmaW5lZFN1cGVyY2xhc3NGaWVs\nZChfb3ZlcnJpZGUsCiAgICAgICAgICAgICAgICBPYmplY3QuY2xhc3MsIE9i\namVjdC5jbGFzcyk7CiAgICAgICAgcmV0dXJuIHN1cDsKICAgIH0KCiAgICAv\nKioKICAgICAqIFJldHVybiB0aGUgcHJvcGVyIG92ZXJyaWRlLgogICAgICov\nCiAgICBwcml2YXRlIEZpZWxkTWFwcGluZyBnZXRBdHRyaWJ1dGVPdmVycmlk\nZShGaWVsZE1hcHBpbmcgZm0pCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlv\nbiB7CiAgICAgICAgQ2xhc3NNYXBwaW5nIGVtYmVkID0gZm0uZ2V0RW1iZWRk\nZWRNYXBwaW5nKCk7CiAgICAgICAgaWYgKGVtYmVkID09IG51bGwpCiAgICAg\nICAgICAgIHRocm93IGdldEV4Y2VwdGlvbihfbG9jLmdldCgibm90LWVtYmVk\nZGVkIiwgZm0pKTsKCiAgICAgICAgRmllbGRNYXBwaW5nIGVmbSA9IGVtYmVk\nLmdldEZpZWxkTWFwcGluZyhfb3ZlcnJpZGUpOwogICAgICAgIGlmIChlZm0g\nPT0gbnVsbCkKICAgICAgICAgICAgdGhyb3cgZ2V0RXhjZXB0aW9uKF9sb2Mu\nZ2V0KCJlbWJlZC1vdmVycmlkZS1uYW1lIiwKICAgICAgICAgICAgICAgIGZt\nLCBfb3ZlcnJpZGUpKTsKICAgICAgICByZXR1cm4gZWZtOwogICAgfQoKICAg\nIC8qKgogICAgICogUGFyc2UgdGFibGUuCiAgICAgKi8KICAgIHByaXZhdGUg\nYm9vbGVhbiBzdGFydFRhYmxlKEF0dHJpYnV0ZXMgYXR0cnMpCiAgICAgICAg\ndGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgU3RyaW5nIHRhYmxlID0g\ndG9UYWJsZU5hbWUoYXR0cnMuZ2V0VmFsdWUoInNjaGVtYSIpLAogICAgICAg\nICAgICBhdHRycy5nZXRWYWx1ZSgibmFtZSIpKTsKICAgICAgICBpZiAodGFi\nbGUgIT0gbnVsbCkKICAgICAgICAgICAgKChDbGFzc01hcHBpbmcpIGN1cnJl\nbnRFbGVtZW50KCkpLmdldE1hcHBpbmdJbmZvKCkuc2V0VGFibGVOYW1lCiAg\nICAgICAgICAgICAgICAodGFibGUpOwogICAgICAgIHJldHVybiB0cnVlOwog\nICAgfQoKICAgIC8qKgogICAgICogUGFyc2Ugam9pbi10YWJsZS4KICAgICAq\nLwogICAgcHJpdmF0ZSBib29sZWFuIHN0YXJ0Sm9pblRhYmxlKEF0dHJpYnV0\nZXMgYXR0cnMpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAg\nICAgU3RyaW5nIHRhYmxlID0gdG9UYWJsZU5hbWUoYXR0cnMuZ2V0VmFsdWUo\nInNjaGVtYSIpLAogICAgICAgICAgICBhdHRycy5nZXRWYWx1ZSgibmFtZSIp\nKTsKICAgICAgICBpZiAodGFibGUgIT0gbnVsbCkKICAgICAgICAgICAgKChG\naWVsZE1hcHBpbmcpIGN1cnJlbnRFbGVtZW50KCkpLmdldE1hcHBpbmdJbmZv\nKCkuc2V0VGFibGVOYW1lCiAgICAgICAgICAgICAgICAodGFibGUpOwogICAg\nICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qKgogICAgICogU2V0IHRo\nZSBqb2luIHRhYmxlIGluZm9ybWF0aW9uIGJhY2suCiAgICAgKi8KICAgIHBy\naXZhdGUgdm9pZCBlbmRKb2luVGFibGUoKSB7CiAgICAgICAgRmllbGRNYXBw\naW5nIGZtID0gKEZpZWxkTWFwcGluZykgY3VycmVudEVsZW1lbnQoKTsKICAg\nICAgICBpZiAoX2pvaW5Db2xzICE9IG51bGwpCiAgICAgICAgICAgIGZtLmdl\ndE1hcHBpbmdJbmZvKCkuc2V0Q29sdW1ucyhfam9pbkNvbHMpOwogICAgICAg\nIGlmIChfY29scyAhPSBudWxsKQogICAgICAgICAgICBmbS5nZXRFbGVtZW50\nTWFwcGluZygpLmdldFZhbHVlSW5mbygpLnNldENvbHVtbnMoX2NvbHMpOwog\nICAgICAgIGNsZWFyQ29sdW1uSW5mbygpOwogICAgfQoKICAgIC8qKgogICAg\nICogUGFyc2UgcHJpbWFyeS1rZXktam9pbi1jb2x1bW4uCiAgICAgKi8KICAg\nIHByaXZhdGUgYm9vbGVhbiBzdGFydFByaW1hcnlLZXlKb2luQ29sdW1uKEF0\ndHJpYnV0ZXMgYXR0cnMpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2VwdGlvbiB7\nCiAgICAgICAgQ29sdW1uIGNvbCA9IHBhcnNlQ29sdW1uKGF0dHJzKTsKICAg\nICAgICBjb2wuc2V0RmxhZyhDb2x1bW4uRkxBR19QS19KT0lOLCB0cnVlKTsK\nICAgICAgICAvLyBwayBqb2luIGNvbHVtbnMgb24gZmllbGRzIGFjdCBhcyBm\naWVsZCBjb2xzCiAgICAgICAgaWYgKGN1cnJlbnRFbGVtZW50KCkgaW5zdGFu\nY2VvZiBGaWVsZE1hcHBpbmcpIHsKICAgICAgICAgICAgaWYgKF9jb2xzID09\nIG51bGwpCiAgICAgICAgICAgICAgICBfY29scyA9IG5ldyBBcnJheUxpc3Q8\nQ29sdW1uPigzKTsKICAgICAgICAgICAgX2NvbHMuYWRkKGNvbCk7CiAgICAg\nICAgfSBlbHNlIGlmIChjdXJyZW50UGFyZW50KCkgPT0gU0VDT05EQVJZX1RB\nQkxFKSB7CiAgICAgICAgICAgIC8vIHBrIGpvaW4gY29sdW1ucyBpbiBzZWNv\nbmRhcnkgdGFibGUgYWN0cyBhcyBqb2luIGNvbHMKICAgICAgICAgICAgaWYg\nKF9qb2luQ29scyA9PSBudWxsKQogICAgICAgICAgICAgICAgX2pvaW5Db2xz\nID0gbmV3IEFycmF5TGlzdDxDb2x1bW4+KDMpOwogICAgICAgICAgICBfam9p\nbkNvbHMuYWRkKGNvbCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAg\nLy8gbXVzdCBiZSBwayBqb2luIGNvbHMgZnJvbSB0aGlzIGNsYXNzIHRvIHN1\ncGVyY2xhc3MKICAgICAgICAgICAgaWYgKF9zdXBKb2luQ29scyA9PSBudWxs\nKQogICAgICAgICAgICAgICAgX3N1cEpvaW5Db2xzID0gbmV3IEFycmF5TGlz\ndDxDb2x1bW4+KDMpOwogICAgICAgICAgICBfc3VwSm9pbkNvbHMuYWRkKGNv\nbCk7CiAgICAgICAgfQogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAg\nIC8qKgogICAgICogUGFyc2Ugam9pbi1jb2x1bW4uCiAgICAgKi8KICAgIHBy\naXZhdGUgYm9vbGVhbiBzdGFydEpvaW5Db2x1bW4oQXR0cmlidXRlcyBhdHRy\ncykKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICAvLyBv\nbmx5IGpvaW4gY29scyBpbiBhIGpvaW4gdGFibGUgam9pbiBmaWVsZCB0YWJs\nZSB0byBjbGFzcyB0YWJsZTsKICAgICAgICAvLyBvdGhlcnMgYWN0IGFzIGRh\ndGEgZmsgY29scwogICAgICAgIGlmIChjdXJyZW50UGFyZW50KCkgIT0gSk9J\nTl9UQUJMRSkKICAgICAgICAgICAgcmV0dXJuIHN0YXJ0Q29sdW1uKGF0dHJz\nKTsKCiAgICAgICAgaWYgKF9qb2luQ29scyA9PSBudWxsKQogICAgICAgICAg\nICBfam9pbkNvbHMgPSBuZXcgQXJyYXlMaXN0PENvbHVtbj4oMyk7CiAgICAg\nICAgX2pvaW5Db2xzLmFkZChwYXJzZUNvbHVtbihhdHRycykpOwogICAgICAg\nIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qKgogICAgICogUGFyc2UgY29s\ndW1uLgogICAgICovCiAgICBwcml2YXRlIGJvb2xlYW4gc3RhcnRDb2x1bW4o\nQXR0cmlidXRlcyBhdHRycykKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9u\nIHsKICAgICAgICBpZiAoX2NvbHMgPT0gbnVsbCkKICAgICAgICAgICAgX2Nv\nbHMgPSBuZXcgQXJyYXlMaXN0PENvbHVtbj4oMyk7CiAgICAgICAgX2NvbHMu\nYWRkKHBhcnNlQ29sdW1uKGF0dHJzKSk7CiAgICAgICAgcmV0dXJuIHRydWU7\nCiAgICB9CgogICAgLyoqCiAgICAgKiBDcmVhdGUgYSBjb2x1bW4gd2l0aCB0\naGUgZ2l2ZW4gYXR0cmlidXRlcy4KICAgICAqLwogICAgcHJpdmF0ZSBDb2x1\nbW4gcGFyc2VDb2x1bW4oQXR0cmlidXRlcyBhdHRycykKICAgICAgICB0aHJv\nd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICBDb2x1bW4gY29sID0gbmV3IENv\nbHVtbigpOwogICAgICAgIFN0cmluZyB2YWwgPSBhdHRycy5nZXRWYWx1ZSgi\nbmFtZSIpOwogICAgICAgIGlmICh2YWwgIT0gbnVsbCkKICAgICAgICAgICAg\nY29sLnNldE5hbWUodmFsKTsKICAgICAgICB2YWwgPSBhdHRycy5nZXRWYWx1\nZSgicmVmZXJlbmNlZC1jb2x1bW4tbmFtZSIpOwogICAgICAgIGlmICh2YWwg\nIT0gbnVsbCkKICAgICAgICAgICAgY29sLnNldFRhcmdldCh2YWwpOwogICAg\nICAgIHZhbCA9IGF0dHJzLmdldFZhbHVlKCJjb2x1bW4tZGVmaW5pdGlvbiIp\nOwogICAgICAgIGlmICh2YWwgIT0gbnVsbCkKICAgICAgICAgICAgY29sLnNl\ndFR5cGVOYW1lKHZhbCk7CiAgICAgICAgdmFsID0gYXR0cnMuZ2V0VmFsdWUo\nInByZWNpc2lvbiIpOwogICAgICAgIGlmICh2YWwgIT0gbnVsbCkKICAgICAg\nICAgICAgY29sLnNldFNpemUoSW50ZWdlci5wYXJzZUludCh2YWwpKTsKICAg\nICAgICB2YWwgPSBhdHRycy5nZXRWYWx1ZSgibGVuZ3RoIik7CiAgICAgICAg\naWYgKHZhbCAhPSBudWxsKQogICAgICAgICAgICBjb2wuc2V0U2l6ZShJbnRl\nZ2VyLnBhcnNlSW50KHZhbCkpOwogICAgICAgIHZhbCA9IGF0dHJzLmdldFZh\nbHVlKCJzY2FsZSIpOwogICAgICAgIGlmICh2YWwgIT0gbnVsbCkKICAgICAg\nICAgICAgY29sLnNldERlY2ltYWxEaWdpdHMoSW50ZWdlci5wYXJzZUludCh2\nYWwpKTsKICAgICAgICB2YWwgPSBhdHRycy5nZXRWYWx1ZSgibnVsbGFibGUi\nKTsKICAgICAgICBpZiAodmFsICE9IG51bGwpCiAgICAgICAgICAgIGNvbC5z\nZXROb3ROdWxsKCJmYWxzZSIuZXF1YWxzKHZhbCkpOwogICAgICAgIHZhbCA9\nIGF0dHJzLmdldFZhbHVlKCJpbnNlcnRhYmxlIik7CiAgICAgICAgaWYgKHZh\nbCAhPSBudWxsKQogICAgICAgICAgICBjb2wuc2V0RmxhZyhDb2x1bW4uRkxB\nR19VTklOU0VSVEFCTEUsICJmYWxzZSIuZXF1YWxzKHZhbCkpOwogICAgICAg\nIHZhbCA9IGF0dHJzLmdldFZhbHVlKCJ1cGRhdGFibGUiKTsKICAgICAgICBp\nZiAodmFsICE9IG51bGwpCiAgICAgICAgICAgIGNvbC5zZXRGbGFnKENvbHVt\nbi5GTEFHX1VOVVBEQVRBQkxFLCAiZmFsc2UiLmVxdWFscyh2YWwpKTsKCiAg\nICAgICAgdmFsID0gYXR0cnMuZ2V0VmFsdWUoInVuaXF1ZSIpOwogICAgICAg\nIGlmICh2YWwgIT0gbnVsbCkKICAgICAgICAgICAgX3VuaXF1ZS5hZGQoRW51\nbS52YWx1ZU9mKFVuaXF1ZUZsYWcuY2xhc3MsIHZhbC50b1VwcGVyQ2FzZSgp\nKSk7CiAgICAgICAgdmFsID0gYXR0cnMuZ2V0VmFsdWUoInRhYmxlIik7CiAg\nICAgICAgaWYgKHZhbCAhPSBudWxsKSB7CiAgICAgICAgICAgIGlmIChfY29s\nVGFibGUgIT0gbnVsbCAmJiAhX2NvbFRhYmxlLmVxdWFscyh2YWwpKQogICAg\nICAgICAgICAgICAgdGhyb3cgZ2V0RXhjZXB0aW9uKF9sb2MuZ2V0KCJzZWNv\nbmQtaW5jb25zaXN0IiwKICAgICAgICAgICAgICAgICAgICBjdXJyZW50RWxl\nbWVudCgpKSk7CiAgICAgICAgICAgIF9jb2xUYWJsZSA9IHZhbDsKICAgICAg\nICB9CiAgICAgICAgcmV0dXJuIGNvbDsKICAgIH0KCiAgICAvKioKICAgICAq\nIFJldHVybiBhIHRhYmxlIG5hbWUgZm9yIHRoZSBnaXZlbiBhdHRyaWJ1dGVz\nLgogICAgICovCiAgICBwcml2YXRlIFN0cmluZyB0b1RhYmxlTmFtZShTdHJp\nbmcgc2NoZW1hLCBTdHJpbmcgdGFibGUpIHsKICAgICAgICBpZiAoU3RyaW5n\nVXRpbHMuaXNFbXB0eSh0YWJsZSkpCiAgICAgICAgICAgIHJldHVybiBudWxs\nOwogICAgICAgIGlmIChTdHJpbmdVdGlscy5pc0VtcHR5KHNjaGVtYSkpCiAg\nICAgICAgICAgIHNjaGVtYSA9IF9zY2hlbWE7CiAgICAgICAgcmV0dXJuIChT\ndHJpbmdVdGlscy5pc0VtcHR5KHNjaGVtYSkpID8gdGFibGUgOiBzY2hlbWEg\nKyAiLiIgKyB0YWJsZTsKICAgIH0KCiAgICAvKioKICAgICAqIFN0YXJ0IHBy\nb2Nlc3NpbmcgPGNvZGU+c3FsLXJlc3VsdC1zZXQtbWFwcGluZzwvY29kZT4g\nbm9kZS4KICAgICAqIFB1c2hlcyB0aGUge0BsaW5rIFF1ZXJ5UmVzdWx0TWFw\ncGluZ30gb250byB0aGUgc3RhY2sgYXMgY3VycmVudCBlbGVtZW50LgogICAg\nICovCiAgICBwcml2YXRlIGJvb2xlYW4gc3RhcnRTUUxSZXN1bHRTZXRNYXBw\naW5nKEF0dHJpYnV0ZXMgYXR0cnMpIHsKICAgICAgICBTdHJpbmcgbmFtZSA9\nIGF0dHJzLmdldFZhbHVlKCJuYW1lIik7CiAgICAgICAgTG9nIGxvZyA9IGdl\ndExvZygpOwogICAgICAgIGlmIChsb2cuaXNUcmFjZUVuYWJsZWQoKSkKICAg\nICAgICAgICAgbG9nLnRyYWNlKF9sb2MuZ2V0KCJwYXJzZS1zcWxyc21hcHBp\nbmciLCBuYW1lKSk7CgogICAgICAgIE1hcHBpbmdSZXBvc2l0b3J5IHJlcG9z\nID0gKE1hcHBpbmdSZXBvc2l0b3J5KSBnZXRSZXBvc2l0b3J5KCk7CiAgICAg\nICAgUXVlcnlSZXN1bHRNYXBwaW5nIHJlc3VsdCA9IHJlcG9zLmdldENhY2hl\nZFF1ZXJ5UmVzdWx0TWFwcGluZwogICAgICAgICAgICAobnVsbCwgbmFtZSk7\nCiAgICAgICAgaWYgKHJlc3VsdCAhPSBudWxsICYmIGxvZy5pc1dhcm5FbmFi\nbGVkKCkpCiAgICAgICAgICAgIGxvZy53YXJuKF9sb2MuZ2V0KCJvdmVycmlk\nZS1zcWxyc21hcHBpbmciLCBuYW1lLAogICAgICAgICAgICAgICAgY3VycmVu\ndExvY2F0aW9uKCkpKTsKCiAgICAgICAgcmVzdWx0ID0gcmVwb3MuYWRkUXVl\ncnlSZXN1bHRNYXBwaW5nKG51bGwsIG5hbWUpOwogICAgICAgIHJlc3VsdC5z\nZXRMaXN0aW5nSW5kZXgoX3Jlc3VsdElkeCsrKTsKICAgICAgICBhZGRDb21t\nZW50cyhyZXN1bHQpOwoKICAgICAgICBPYmplY3QgY3VyID0gY3VycmVudEVs\nZW1lbnQoKTsKICAgICAgICBPYmplY3Qgc2NvcGUgPSAoY3VyIGluc3RhbmNl\nb2YgQ2xhc3NNZXRhRGF0YSkKICAgICAgICAgICAgPyAoKENsYXNzTWV0YURh\ndGEpIGN1cikuZ2V0RGVzY3JpYmVkVHlwZSgpIDogbnVsbDsKICAgICAgICBy\nZXN1bHQuc2V0U291cmNlKGdldFNvdXJjZUZpbGUoKSwgc2NvcGUsIHJlc3Vs\ndC5TUkNfWE1MKTsKCiAgICAgICAgcHVzaEVsZW1lbnQocmVzdWx0KTsKICAg\nICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBwcml2YXRlIHZvaWQgZW5k\nU1FMUmVzdWx0U2V0TWFwcGluZygpCiAgICAgICAgdGhyb3dzIFNBWEV4Y2Vw\ndGlvbiB7CiAgICAgICAgcG9wRWxlbWVudCgpOwogICAgfQoKICAgIC8qKgog\nICAgICogU3RhcnQgcHJvY2Vzc2luZyA8Y29kZT5lbnRpdHktcmVzdWx0PC9j\nb2RlPiBub2RlLgogICAgICogUHVzaGVzIHRoZSB7QGxpbmsgUXVlcnlSZXN1\nbHRNYXBwaW5nLlBDUmVzdWx0fQogICAgICogb250byB0aGUgc3RhY2sgYXMg\nY3VycmVudCBlbGVtZW50LgogICAgICovCiAgICBwcml2YXRlIGJvb2xlYW4g\nc3RhcnRFbnRpdHlSZXN1bHQoQXR0cmlidXRlcyBhdHRycykKICAgICAgICB0\naHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICBDbGFzcyBlbnRpdHlDbGFz\ncyA9IGNsYXNzRm9yTmFtZShhdHRycy5nZXRWYWx1ZSgiZW50aXR5LWNsYXNz\nIikpOwogICAgICAgIFN0cmluZyBkaXNjcmltaW5hdG9yID0gYXR0cnMuZ2V0\nVmFsdWUoImRpc2NyaW1pbmF0b3ItY29sdW1uIik7CgogICAgICAgIFF1ZXJ5\nUmVzdWx0TWFwcGluZyBwYXJlbnQgPSAoUXVlcnlSZXN1bHRNYXBwaW5nKSBj\ndXJyZW50RWxlbWVudCgpOwogICAgICAgIFF1ZXJ5UmVzdWx0TWFwcGluZy5Q\nQ1Jlc3VsdCByZXN1bHQgPSBwYXJlbnQuYWRkUENSZXN1bHQoZW50aXR5Q2xh\nc3MpOwogICAgICAgIGlmICghU3RyaW5nVXRpbHMuaXNFbXB0eShkaXNjcmlt\naW5hdG9yKSkKICAgICAgICAgICAgcmVzdWx0LmFkZE1hcHBpbmcocmVzdWx0\nLkRJU0NSSU1JTkFUT1IsIGRpc2NyaW1pbmF0b3IpOwogICAgICAgIHB1c2hF\nbGVtZW50KHJlc3VsdCk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9Cgog\nICAgcHJpdmF0ZSB2b2lkIGVuZEVudGl0eVJlc3VsdCgpCiAgICAgICAgdGhy\nb3dzIFNBWEV4Y2VwdGlvbiB7CiAgICAgICAgcG9wRWxlbWVudCgpOwogICAg\nfQoKICAgIC8qKgogICAgICogUHJvY2VzcyBhIDxjb2RlPmZpZWxkLXJlc3Vs\ndDwvY29kZT4gbm9kZS4KICAgICAqLwogICAgcHJpdmF0ZSBib29sZWFuIHN0\nYXJ0RmllbGRSZXN1bHQoQXR0cmlidXRlcyBhdHRycykKICAgICAgICB0aHJv\nd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICBTdHJpbmcgZmllbGROYW1lID0g\nYXR0cnMuZ2V0VmFsdWUoIm5hbWUiKTsKICAgICAgICBTdHJpbmcgY29sdW1u\nTmFtZSA9IGF0dHJzLmdldFZhbHVlKCJjb2x1bW4iKTsKCiAgICAgICAgUXVl\ncnlSZXN1bHRNYXBwaW5nLlBDUmVzdWx0IHBhcmVudCA9IChRdWVyeVJlc3Vs\ndE1hcHBpbmcuUENSZXN1bHQpCiAgICAgICAgICAgIGN1cnJlbnRFbGVtZW50\nKCk7CiAgICAgICAgcGFyZW50LmFkZE1hcHBpbmcoZmllbGROYW1lLCBjb2x1\nbW5OYW1lKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvKioK\nICAgICAqIFByb2Nlc3MgYSA8Y29kZT5jb2x1bW4tcmVzdWx0PC9jb2RlPiBu\nb2RlLgogICAgICovCiAgICBwcml2YXRlIGJvb2xlYW4gc3RhcnRDb2x1bW5S\nZXN1bHQoQXR0cmlidXRlcyBhdHRycykKICAgICAgICB0aHJvd3MgU0FYRXhj\nZXB0aW9uIHsKICAgICAgICBRdWVyeVJlc3VsdE1hcHBpbmcgcGFyZW50ID0g\nKFF1ZXJ5UmVzdWx0TWFwcGluZykgY3VycmVudEVsZW1lbnQoKTsKICAgICAg\nICBwYXJlbnQuYWRkQ29sdW1uUmVzdWx0KGF0dHJzLmdldFZhbHVlKCJuYW1l\nIikpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qKiAKICAg\nICAqIFN0YXJ0cyBwcm9jZXNzaW5nICZsdDt1bmlxdWUtY29uc3RyYWludCZn\ndDsgcHJvdmlkZWQgdGhlIHRhZyBvY2N1cnMKICAgICAqIHdpdGhpbiBhIENs\nYXNzTWFwcGluZyBlbGVtZW50IGFuZCA8ZW0+bm90PC9lbT4gd2l0aGluIGEg\nc2Vjb25kYXJ5CiAgICAgKiB0YWJsZS4gCiAgICAgKiBQdXNoZXMgdGhlIFVu\naXF1ZSBlbGVtZW50IGluIHRoZSBzdGFjay4KICAgICAqLwogICAgcHJpdmF0\nZSBib29sZWFuIHN0YXJ0VW5pcXVlQ29uc3RyYWludChBdHRyaWJ1dGVzIGF0\ndHJzKSAKICAgICAgICB0aHJvd3MgU0FYRXhjZXB0aW9uIHsKICAgICAgICBV\nbmlxdWUgdW5pcXVlID0gbmV3IFVuaXF1ZSgpOwogICAgICAgIHB1c2hFbGVt\nZW50KHVuaXF1ZSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CiAgICAK\nICAgIC8qKgogICAgICogRW5kcyBwcm9jZXNzaW5nICZsdDt1bmlxdWUtY29u\nc3RyYWludCZndDsgcHJvdmlkZWQgdGhlIHRhZyBvY2N1cnMKICAgICAqIHdp\ndGhpbiBhIENsYXNzTWFwcGluZyBlbGVtZW50IGFuZCA8ZW0+bm90PC9lbT4g\nd2l0aGluIGEgc2Vjb25kYXJ5CiAgICAgKiB0YWJsZS4gVGhlIHN0YWNrIGlz\nIHBvcHBlZCBhbmQgdGhlIFVuaXF1ZSBlbGVtZW50IGlzIGFkZGVkIHRvIHRo\nZQogICAgICogQ2xhc3NNYXBwaW5nSW5mby4gCiAgICAgKi8KICAgIHByaXZh\ndGUgdm9pZCBlbmRVbmlxdWVDb25zdHJhaW50KCkgewogICAgICAgIFVuaXF1\nZSB1bmlxdWUgPSAoVW5pcXVlKSBwb3BFbGVtZW50KCk7CiAgICAgICAgT2Jq\nZWN0IGN0eCA9IGN1cnJlbnRFbGVtZW50KCk7CiAgICAgICAgU3RyaW5nIHRh\nYmxlTmFtZSA9ICI/IjsKICAgICAgICBpZiAoY3R4IGluc3RhbmNlb2YgQ2xh\nc3NNYXBwaW5nKSB7CiAgICAgICAgCUNsYXNzTWFwcGluZ0luZm8gaW5mbyA9\nICgoQ2xhc3NNYXBwaW5nKSBjdHgpLmdldE1hcHBpbmdJbmZvKCk7CiAgICAg\nICAgCXRhYmxlTmFtZSA9IChfc2Vjb25kYXJ5VGFibGUgPT0gbnVsbCkgCiAg\nICAgICAgCQk/IGluZm8uZ2V0VGFibGVOYW1lKCkgOiBfc2Vjb25kYXJ5VGFi\nbGU7CiAgICAgICAgCWluZm8uYWRkVW5pcXVlKHRhYmxlTmFtZSwgdW5pcXVl\nKTsKICAgICAgICB9IGVsc2UgaWYgKGN0eCBpbnN0YW5jZW9mIEZpZWxkTWFw\ncGluZykgey8vIEpvaW5UYWJsZQogICAgICAgIAlGaWVsZE1hcHBpbmdJbmZv\nIGluZm8gPSAoKEZpZWxkTWFwcGluZyljdHgpLmdldE1hcHBpbmdJbmZvKCk7\nCiAgICAgICAgCWluZm8uYWRkSm9pblRhYmxlVW5pcXVlKHVuaXF1ZSk7CiAg\nICAgICAgfSBlbHNlIGlmIChjdHggaW5zdGFuY2VvZiBTZXF1ZW5jZU1hcHBp\nbmcpIHsKICAgICAgICAJU2VxdWVuY2VNYXBwaW5nIHNlcSA9IChTZXF1ZW5j\nZU1hcHBpbmcpY3R4OwogICAgICAgIAl1bmlxdWUuc2V0VGFibGVOYW1lKHNl\ncS5nZXRUYWJsZSgpKTsKICAgICAgICAJQ29sdW1uW10gdW5pcXVlQ29sdW1u\ncyA9IHVuaXF1ZS5nZXRDb2x1bW5zKCk7CiAgICAgICAgCVN0cmluZ1tdIGNv\nbHVtbk5hbWVzID0gbmV3IFN0cmluZ1t1bmlxdWVDb2x1bW5zLmxlbmd0aF07\nCiAgICAgICAgCWludCBpID0gMDsKICAgICAgICAJZm9yIChDb2x1bW4gdW5p\ncXVlQ29sdW1uIDogdW5pcXVlQ29sdW1ucykKICAgICAgICAJCWNvbHVtbk5h\nbWVzW2krK10gPSB1bmlxdWVDb2x1bW4uZ2V0TmFtZSgpOwogICAgICAgIAlz\nZXEuc2V0VW5pcXVlQ29sdW1ucyhjb2x1bW5OYW1lcyk7CiAgICAgICAgfSBl\nbHNlIHsKICAgICAgICAJdGhyb3cgbmV3IEludGVybmFsRXhjZXB0aW9uKCk7\nCiAgICAgICAgfQogICAgfQogICAgCiAgICAvKioKICAgICAqIEVuZHMgcHJv\nY2Vzc2luZyAmbHQ7Y29sdW1uLW5hbWUmZ3Q7IHRhZyBieSBhZGRpbmcgdGhl\nIGNvbHVtbiBuYW1lIGluCiAgICAgKiB0aGUgY3VycmVudCBVbmlxdWUgZWxl\nbWVudCB0aGF0IHJlc2lkZXMgaW4gdGhlIHRvcCBvZiB0aGUgc3RhY2suCiAg\nICAgKi8KICAgIHByaXZhdGUgYm9vbGVhbiBlbmRDb2x1bW5OYW1lKCkgewog\nICAgICAgIE9iamVjdCBjdXJyZW50ID0gY3VycmVudEVsZW1lbnQoKTsKICAg\nICAgICBpZiAoY3VycmVudCBpbnN0YW5jZW9mIFVuaXF1ZSkgewogICAgICAg\nICAgICBVbmlxdWUgdW5pcXVlID0gKFVuaXF1ZSkgY3VycmVudDsKICAgICAg\nICAgICAgQ29sdW1uIGNvbHVtbiA9IG5ldyBDb2x1bW4oKTsKICAgICAgICAg\nICAgY29sdW1uLnNldE5hbWUodGhpcy5jdXJyZW50VGV4dCgpKTsKICAgICAg\nICAgICAgdW5pcXVlLmFkZENvbHVtbihjb2x1bW4pOwogICAgICAgICAgICBy\nZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGZhbHNlOwog\nICAgfQogICAgCiAgICAvKioKICAgICAqIFRyYWNrIHVuaXF1ZSBjb2x1bW4g\nc2V0dGluZ3MuCgkgKi8KCXByaXZhdGUgc3RhdGljIGVudW0gVW5pcXVlRmxh\nZwoJewoJCVRSVUUsCgkJRkFMU0UKCX0KCQoJcHJpdmF0ZSB2b2lkIHBhcnNl\nRGlzY3JpbWluYXRvckNvbHVtbihBdHRyaWJ1dGVzIGF0dHJzKSB7IAoJICAg\nIFN0cmluZyB2YWwgPSBhdHRycy5nZXRWYWx1ZSgiZGlzY3JpbWluYXRvci10\neXBlIik7CiAgICAgICAgaWYgKHZhbCAhPSBudWxsKSB7CiAgICAgICAgICAg\nIF9kaXNjVHlwZSA9IEVudW0udmFsdWVPZihEaXNjcmltaW5hdG9yVHlwZS5j\nbGFzcywgdmFsKTsKICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAg\nICAgIF9kaXNjVHlwZSA9IERpc2NyaW1pbmF0b3JUeXBlLlNUUklORzsKICAg\nICAgICB9CiAgICAgICAgICAgIAoJfQp9Cg==\n","encoding":"base64"}

