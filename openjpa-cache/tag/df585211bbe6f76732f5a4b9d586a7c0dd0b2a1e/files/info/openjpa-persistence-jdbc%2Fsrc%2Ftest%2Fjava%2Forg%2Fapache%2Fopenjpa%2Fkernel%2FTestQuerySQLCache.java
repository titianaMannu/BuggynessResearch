{"sha":"1dcf94d9e8a078d19f2d4d801231fa084dbf38e1","node_id":"MDQ6QmxvYjIwNjM2NDoxZGNmOTRkOWU4YTA3OGQxOWYyZDRkODAxMjMxZmEwODRkYmYzOGUx","size":13479,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/1dcf94d9e8a078d19f2d4d801231fa084dbf38e1","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsOwoKaW1wb3J0IGph\ndmEudXRpbC5IYXNoTWFwOwppbXBvcnQgamF2YS51dGlsLkl0ZXJhdG9yOwpp\nbXBvcnQgamF2YS51dGlsLk1hcDsKaW1wb3J0IGphdmEudXRpbC5TZXQ7Cmlt\ncG9ydCBqYXZhLnV0aWwuY29uY3VycmVudC5Db25jdXJyZW50SGFzaE1hcDsK\nCmltcG9ydCBqYXZheC5wZXJzaXN0ZW5jZS5FbnRpdHlNYW5hZ2VyOwppbXBv\ncnQgamF2YXgucGVyc2lzdGVuY2UuRW50aXR5TWFuYWdlckZhY3Rvcnk7Cmlt\ncG9ydCBqYXZheC5wZXJzaXN0ZW5jZS5QZXJzaXN0ZW5jZTsKCmltcG9ydCBq\ndW5pdC5mcmFtZXdvcmsuVGVzdENhc2U7CgppbXBvcnQgb3JnLmFwYWNoZS5v\ncGVuanBhLmpkYmMua2VybmVsLkpEQkNTdG9yZU1hbmFnZXI7CmltcG9ydCBv\ncmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuRW50aXR5TWFuYWdlcklt\ncGw7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuT3Bl\nbkpQQUVudGl0eU1hbmFnZXJGYWN0b3J5U1BJOwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLnBlcnNpc3RlbmNlLk9wZW5KUEFQZXJzaXN0ZW5jZTsKaW1w\nb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5wZXJzaXN0ZW5jZS5zaW1wbGUuUGVy\nc29uOwoKLyoKICogVmVyaWZ5IG11bHRpcGxlIHBlcm11dGF0aW9ucyBvZiBv\ncGVuanBhLmpkYmMuUXVlcnlTUUxDYWNoZSBzZXR0aW5ncy4KICovCnB1Ymxp\nYyBjbGFzcyBUZXN0UXVlcnlTUUxDYWNoZQogICAgZXh0ZW5kcyBUZXN0Q2Fz\nZSB7CiAgICAKICAgIGZpbmFsIGludCBuVGhyZWFkcyA9IDU7CiAgICBmaW5h\nbCBpbnQgblBlb3BsZSA9IDEwMDsKICAgIGZpbmFsIGludCBuSXRlcmF0aW9u\ncyA9IDEwOwoKICAgIC8qCiAgICAgKiBWZXJpZnkgUXVlcnlTUUxDYWNoZVZh\nbHVlIHNldHRpbmcgImFsbCIgaXMgY2FjaGluZyBxdWVyaWVzLgogICAgICov\nCiAgICBwdWJsaWMgdm9pZCB0ZXN0QWxsQ2FjaGVTZXR0aW5nKCkgewogICAg\nICAgIE1hcCBwcm9wcyA9IG5ldyBIYXNoTWFwKFN5c3RlbS5nZXRQcm9wZXJ0\naWVzKCkpOwogICAgICAgIHByb3BzLnB1dCgib3BlbmpwYS5NZXRhRGF0YUZh\nY3RvcnkiLCAianBhKFR5cGVzPSIgCiAgICAgICAgICAgICsgUGVyc29uLmNs\nYXNzLmdldE5hbWUoKSArICIpIik7CiAgICAgICAgcHJvcHMucHV0KCJvcGVu\nanBhLmpkYmMuUXVlcnlTUUxDYWNoZSIsICJhbGwiKTsKICAgICAgICBPcGVu\nSlBBRW50aXR5TWFuYWdlckZhY3RvcnlTUEkgZW1mID0gKE9wZW5KUEFFbnRp\ndHlNYW5hZ2VyRmFjdG9yeVNQSSkKICAgICAgICAgICAgT3BlbkpQQVBlcnNp\nc3RlbmNlLmNhc3QoCiAgICAgICAgICAgICAgICBQZXJzaXN0ZW5jZS5jcmVh\ndGVFbnRpdHlNYW5hZ2VyRmFjdG9yeSgidGVzdCIsIHByb3BzKSk7CiAgICAg\nICAgCiAgICAgICAgRW50aXR5TWFuYWdlckltcGwgZW0gPSAoRW50aXR5TWFu\nYWdlckltcGwpZW1mLmNyZWF0ZUVudGl0eU1hbmFnZXIoKTsKICAgICAgICBC\ncm9rZXJJbXBsIGJyb2tlciA9IChCcm9rZXJJbXBsKSBlbS5nZXRCcm9rZXIo\nKTsKICAgICAgICBEZWxlZ2F0aW5nU3RvcmVNYW5hZ2VyIGRzdG9yZSA9IGJy\nb2tlci5nZXRTdG9yZU1hbmFnZXIoKTsKICAgICAgICBKREJDU3RvcmVNYW5h\nZ2VyIGpzdG9yZSA9IAogICAgICAgICAgICAoSkRCQ1N0b3JlTWFuYWdlcilk\nc3RvcmUuZ2V0SW5uZXJtb3N0RGVsZWdhdGUoKTsKCiAgICAgICAgZW0uZ2V0\nVHJhbnNhY3Rpb24oKS5iZWdpbigpOwogICAgICAgIFBlcnNvbiBwID0gbmV3\nIFBlcnNvbigpOwogICAgICAgIHAuc2V0SWQoMSk7CiAgICAgICAgZW0ucGVy\nc2lzdChwKTsKICAgICAgICBlbS5mbHVzaCgpOwogICAgICAgIGVtLmdldFRy\nYW5zYWN0aW9uKCkuY29tbWl0KCk7CiAgICAgICAgCiAgICAgICAgUGVyc29u\nIHAxID0gZW0uZmluZChQZXJzb24uY2xhc3MsIDEpOwogICAgICAgIE1hcCBz\ncWxDYWNoZSA9IGpzdG9yZS5nZXRRdWVyeVNRTENhY2hlKCk7CiAgICAgICAg\nU2V0IGtleXMgPSBzcWxDYWNoZS5rZXlTZXQoKTsKICAgICAgICBmb3IgKEl0\nZXJhdG9yIGl0ZXIgPSBrZXlzLml0ZXJhdG9yKCk7IGl0ZXIuaGFzTmV4dCgp\nOykgewogICAgICAgICAgICBNYXAgY2FjaGVNYXAgPSAoTWFwKSBpdGVyLm5l\neHQoKTsKICAgICAgICAgICAgLy9tYWtlIHN1cmUgdGhlcmUgaXMgYW4gZW50\ncnkgaW4gdGhlIGNhY2hlCiAgICAgICAgICAgIGFzc2VydEVxdWFscygxLCBj\nYWNoZU1hcC5zaXplKCkpOyAgIAogICAgICAgIH0KICAgICAgICAKICAgICAg\nICBlbS5nZXRUcmFuc2FjdGlvbigpLmJlZ2luKCk7CiAgICAgICAgZW0ucmVt\nb3ZlKHApOwogICAgICAgIGVtLmZsdXNoKCk7CiAgICAgICAgZW0uZ2V0VHJh\nbnNhY3Rpb24oKS5jb21taXQoKTsKICAgICAgICAKICAgICAgICBlbS5jbG9z\nZSgpOwogICAgICAgIGVtZi5jbG9zZSgpOwogICAgfQogICAgCiAgICAvKgog\nICAgICogVmVyaWZ5IFF1ZXJ5U1FMQ2FjaGVWYWx1ZSBzZXR0aW5nICJ0cnVl\nIiB1c2VzIHRoZSBleHBlY3RlZCBjYWNoZQogICAgICogaW1wbGVtZW50YXRp\nb24gYW5kIGlzIGNhY2hpbmcuCiAgICAgKi8KICAgIHB1YmxpYyB2b2lkIHRl\nc3RUcnVlQ2FjaGVTZXR0aW5nKCkgewogICAgICAgIE1hcCBwcm9wcyA9IG5l\ndyBIYXNoTWFwKFN5c3RlbS5nZXRQcm9wZXJ0aWVzKCkpOwogICAgICAgIHBy\nb3BzLnB1dCgib3BlbmpwYS5NZXRhRGF0YUZhY3RvcnkiLCAianBhKFR5cGVz\nPSIgCiAgICAgICAgICAgICsgUGVyc29uLmNsYXNzLmdldE5hbWUoKSArICIp\nIik7CiAgICAgICAgcHJvcHMucHV0KCJvcGVuanBhLmpkYmMuUXVlcnlTUUxD\nYWNoZSIsICJ0cnVlIik7CiAgICAgICAgT3BlbkpQQUVudGl0eU1hbmFnZXJG\nYWN0b3J5U1BJIGVtZiA9IChPcGVuSlBBRW50aXR5TWFuYWdlckZhY3RvcnlT\nUEkpCiAgICAgICAgICAgIE9wZW5KUEFQZXJzaXN0ZW5jZS5jYXN0KAogICAg\nICAgICAgICAgICAgUGVyc2lzdGVuY2UuY3JlYXRlRW50aXR5TWFuYWdlckZh\nY3RvcnkoInRlc3QiLCBwcm9wcykpOwogICAgICAgIAogICAgICAgIEVudGl0\neU1hbmFnZXJJbXBsIGVtID0gKEVudGl0eU1hbmFnZXJJbXBsKWVtZi5jcmVh\ndGVFbnRpdHlNYW5hZ2VyKCk7CiAgICAgICAgQnJva2VySW1wbCBicm9rZXIg\nPSAoQnJva2VySW1wbCkgZW0uZ2V0QnJva2VyKCk7CiAgICAgICAgRGVsZWdh\ndGluZ1N0b3JlTWFuYWdlciBkc3RvcmUgPSBicm9rZXIuZ2V0U3RvcmVNYW5h\nZ2VyKCk7CiAgICAgICAgSkRCQ1N0b3JlTWFuYWdlciBqc3RvcmUgPSAKICAg\nICAgICAgICAgKEpEQkNTdG9yZU1hbmFnZXIpZHN0b3JlLmdldElubmVybW9z\ndERlbGVnYXRlKCk7CiAgICAgICAgCiAgICAgICAgZW0uZ2V0VHJhbnNhY3Rp\nb24oKS5iZWdpbigpOwogICAgICAgIFBlcnNvbiBwID0gbmV3IFBlcnNvbigp\nOwogICAgICAgIHAuc2V0SWQoMSk7CiAgICAgICAgZW0ucGVyc2lzdChwKTsK\nICAgICAgICBlbS5mbHVzaCgpOwogICAgICAgIGVtLmdldFRyYW5zYWN0aW9u\nKCkuY29tbWl0KCk7CiAgICAgICAgCiAgICAgICAgUGVyc29uIHAxID0gZW0u\nZmluZChQZXJzb24uY2xhc3MsIDEpOwogICAgICAgIE1hcCBzcWxDYWNoZSA9\nIGpzdG9yZS5nZXRRdWVyeVNRTENhY2hlKCk7CiAgICAgICAgU2V0IGtleXMg\nPSBzcWxDYWNoZS5rZXlTZXQoKTsKICAgICAgICBmb3IgKEl0ZXJhdG9yIGl0\nZXIgPSBrZXlzLml0ZXJhdG9yKCk7IGl0ZXIuaGFzTmV4dCgpOykgewogICAg\nICAgICAgICBNYXAgY2FjaGVNYXAgPSAoTWFwKSBpdGVyLm5leHQoKTsKICAg\nICAgICAgICAgLy9tYWtlIHN1cmUgdGhlcmUgaXMgYW4gZW50cnkgaW4gdGhl\nIGNhY2hlCiAgICAgICAgICAgIGFzc2VydEVxdWFscygxLCBjYWNoZU1hcC5z\naXplKCkpOyAgIAogICAgICAgIH0KICAgICAgICAKICAgICAgICBlbS5nZXRU\ncmFuc2FjdGlvbigpLmJlZ2luKCk7CiAgICAgICAgZW0ucmVtb3ZlKHApOwog\nICAgICAgIGVtLmZsdXNoKCk7CiAgICAgICAgZW0uZ2V0VHJhbnNhY3Rpb24o\nKS5jb21taXQoKTsKICAgICAgICAKICAgICAgICBlbS5jbG9zZSgpOwogICAg\nICAgIGVtZi5jbG9zZSgpOwogICAgfQoKICAgIC8qCiAgICAgKiBWZXJpZnkg\nY2FjaGluZyBpcyBkaXNhYmxlZCB3aGVuIHRoZSBRdWVyeVNRTENhY2hlVmFs\ndWUgc2V0dGluZyBpcyAKICAgICAqICJmYWxzZSIuCiAgICAgKi8KICAgIHB1\nYmxpYyB2b2lkIHRlc3RGYWxzZUNhY2hlU2V0dGluZygpIHsKICAgICAgICBN\nYXAgcHJvcHMgPSBuZXcgSGFzaE1hcChTeXN0ZW0uZ2V0UHJvcGVydGllcygp\nKTsKICAgICAgICBwcm9wcy5wdXQoIm9wZW5qcGEuTWV0YURhdGFGYWN0b3J5\nIiwgImpwYShUeXBlcz0iIAogICAgICAgICAgICArIFBlcnNvbi5jbGFzcy5n\nZXROYW1lKCkgKyAiKSIpOwogICAgICAgIHByb3BzLnB1dCgib3BlbmpwYS5q\nZGJjLlF1ZXJ5U1FMQ2FjaGUiLCAiZmFsc2UiKTsKICAgICAgICBPcGVuSlBB\nRW50aXR5TWFuYWdlckZhY3RvcnlTUEkgZW1mID0gKE9wZW5KUEFFbnRpdHlN\nYW5hZ2VyRmFjdG9yeVNQSSkKICAgICAgICAgICAgT3BlbkpQQVBlcnNpc3Rl\nbmNlLmNhc3QoCiAgICAgICAgICAgICAgICBQZXJzaXN0ZW5jZS5jcmVhdGVF\nbnRpdHlNYW5hZ2VyRmFjdG9yeSgidGVzdCIsIHByb3BzKSk7CiAgICAgICAg\nCiAgICAgICAgRW50aXR5TWFuYWdlckltcGwgZW0gPSAoRW50aXR5TWFuYWdl\nckltcGwpZW1mLmNyZWF0ZUVudGl0eU1hbmFnZXIoKTsKICAgICAgICBCcm9r\nZXJJbXBsIGJyb2tlciA9IChCcm9rZXJJbXBsKSBlbS5nZXRCcm9rZXIoKTsK\nICAgICAgICBEZWxlZ2F0aW5nU3RvcmVNYW5hZ2VyIGRzdG9yZSA9IGJyb2tl\nci5nZXRTdG9yZU1hbmFnZXIoKTsKICAgICAgICBKREJDU3RvcmVNYW5hZ2Vy\nIGpzdG9yZSA9IAogICAgICAgICAgICAoSkRCQ1N0b3JlTWFuYWdlcilkc3Rv\ncmUuZ2V0SW5uZXJtb3N0RGVsZWdhdGUoKTsKICAgICAgICAKICAgICAgICBl\nbS5nZXRUcmFuc2FjdGlvbigpLmJlZ2luKCk7CiAgICAgICAgUGVyc29uIHAg\nPSBuZXcgUGVyc29uKCk7CiAgICAgICAgcC5zZXRJZCgxKTsKICAgICAgICBl\nbS5wZXJzaXN0KHApOwogICAgICAgIGVtLmZsdXNoKCk7CiAgICAgICAgZW0u\nZ2V0VHJhbnNhY3Rpb24oKS5jb21taXQoKTsKICAgICAgICAKICAgICAgICBQ\nZXJzb24gcDEgPSBlbS5maW5kKFBlcnNvbi5jbGFzcywgMSk7CgogICAgICAg\nIGFzc2VydEZhbHNlKGpzdG9yZS5pc1F1ZXJ5U1FMQ2FjaGVPbigpKTsKICAg\nICAgICAKICAgICAgICBlbS5nZXRUcmFuc2FjdGlvbigpLmJlZ2luKCk7CiAg\nICAgICAgZW0ucmVtb3ZlKHApOwogICAgICAgIGVtLmZsdXNoKCk7CiAgICAg\nICAgZW0uZ2V0VHJhbnNhY3Rpb24oKS5jb21taXQoKTsKICAgICAgICAKICAg\nICAgICBlbS5jbG9zZSgpOwogICAgICAgIGVtZi5jbG9zZSgpOwogICAgfQoK\nICAgIC8qCiAgICAgKiBWZXJpZnkgUXVlcnlTUUxDYWNoZVZhbHVlIHNldHRp\nbmcgd2l0aCBhIGN1c3RvbSBjYWNoZSBiYWNrZW5kIHVzZXMKICAgICAqIHRo\nZSBleHBlY3RlZCBjYWNoZSBpbXBsZW1lbnRhdGlvbiBhbmQgaXMgY2FjaGlu\nZy4KICAgICAqLwogICAgcHVibGljIHZvaWQgdGVzdEN1c3RvbUNhY2hlU2V0\ndGluZygpIHsKICAgICAgICBNYXAgcHJvcHMgPSBuZXcgSGFzaE1hcChTeXN0\nZW0uZ2V0UHJvcGVydGllcygpKTsKICAgICAgICBwcm9wcy5wdXQoIm9wZW5q\ncGEuTWV0YURhdGFGYWN0b3J5IiwgImpwYShUeXBlcz0iIAogICAgICAgICAg\nICArIFBlcnNvbi5jbGFzcy5nZXROYW1lKCkgKyAiKSIpOwogICAgICAgIHBy\nb3BzLnB1dCgib3BlbmpwYS5qZGJjLlF1ZXJ5U1FMQ2FjaGUiLCAKICAgICAg\nICAgICAgIm9yZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuVGVzdFF1ZXJ5U1FM\nQ2FjaGUuQ3VzdG9tQ2FjaGVNYXAiKTsKICAgICAgICBPcGVuSlBBRW50aXR5\nTWFuYWdlckZhY3RvcnlTUEkgZW1mID0gKE9wZW5KUEFFbnRpdHlNYW5hZ2Vy\nRmFjdG9yeVNQSSkKICAgICAgICAgICAgT3BlbkpQQVBlcnNpc3RlbmNlLmNh\nc3QoCiAgICAgICAgICAgICAgICBQZXJzaXN0ZW5jZS5jcmVhdGVFbnRpdHlN\nYW5hZ2VyRmFjdG9yeSgidGVzdCIsIHByb3BzKSk7CiAgICAgICAgCiAgICAg\nICAgRW50aXR5TWFuYWdlckltcGwgZW0gPSAoRW50aXR5TWFuYWdlckltcGwp\nZW1mLmNyZWF0ZUVudGl0eU1hbmFnZXIoKTsKICAgICAgICBCcm9rZXJJbXBs\nIGJyb2tlciA9IChCcm9rZXJJbXBsKSBlbS5nZXRCcm9rZXIoKTsKICAgICAg\nICBEZWxlZ2F0aW5nU3RvcmVNYW5hZ2VyIGRzdG9yZSA9IGJyb2tlci5nZXRT\ndG9yZU1hbmFnZXIoKTsKICAgICAgICBKREJDU3RvcmVNYW5hZ2VyIGpzdG9y\nZSA9IAogICAgICAgICAgICAoSkRCQ1N0b3JlTWFuYWdlcilkc3RvcmUuZ2V0\nSW5uZXJtb3N0RGVsZWdhdGUoKTsKICAgICAgICAKICAgICAgICBlbS5nZXRU\ncmFuc2FjdGlvbigpLmJlZ2luKCk7CiAgICAgICAgUGVyc29uIHAgPSBuZXcg\nUGVyc29uKCk7CiAgICAgICAgcC5zZXRJZCgxKTsKICAgICAgICBlbS5wZXJz\naXN0KHApOwogICAgICAgIGVtLmZsdXNoKCk7CiAgICAgICAgZW0uZ2V0VHJh\nbnNhY3Rpb24oKS5jb21taXQoKTsKICAgICAgICAKICAgICAgICBQZXJzb24g\ncDEgPSBlbS5maW5kKFBlcnNvbi5jbGFzcywgMSk7CgogICAgICAgIGFzc2Vy\ndFRydWUoanN0b3JlLmlzUXVlcnlTUUxDYWNoZU9uKCkpOwoKICAgICAgICBN\nYXAgc3FsQ2FjaGUgPSBqc3RvcmUuZ2V0UXVlcnlTUUxDYWNoZSgpOwogICAg\nICAgIFNldCBrZXlzID0gc3FsQ2FjaGUua2V5U2V0KCk7CiAgICAgICAgZm9y\nIChJdGVyYXRvciBpdGVyID0ga2V5cy5pdGVyYXRvcigpOyBpdGVyLmhhc05l\neHQoKTspIHsKICAgICAgICAgICAgTWFwIGNhY2hlTWFwID0gKE1hcCkgaXRl\nci5uZXh0KCk7CiAgICAgICAgICAgIGFzc2VydFRydWUoKGNhY2hlTWFwIGlu\nc3RhbmNlb2YgCiAgICAgICAgICAgICAgICBvcmcuYXBhY2hlLm9wZW5qcGEu\na2VybmVsLlRlc3RRdWVyeVNRTENhY2hlLkN1c3RvbUNhY2hlTWFwKSk7CiAg\nICAgICAgICAgIC8vbWFrZSBzdXJlIHRoZXJlIGlzIGFuIGVudHJ5IGluIHRo\nZSBjYWNoZQogICAgICAgICAgICBhc3NlcnRFcXVhbHMoMSwgY2FjaGVNYXAu\nc2l6ZSgpKTsgICAKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgZW0uZ2V0\nVHJhbnNhY3Rpb24oKS5iZWdpbigpOwogICAgICAgIGVtLnJlbW92ZShwKTsK\nICAgICAgICBlbS5mbHVzaCgpOwogICAgICAgIGVtLmdldFRyYW5zYWN0aW9u\nKCkuY29tbWl0KCk7CiAgICAgICAgCiAgICAgICAgZW0uY2xvc2UoKTsKICAg\nICAgICBlbWYuY2xvc2UoKTsKICAgIH0KCiAgICAvKgogICAgICogVmVyaWZ5\nIGFuIGV4Y2VwdGlvbiBpcyB0aHJvd24gaWYgYSBiYWQgY2FjaGUgaW1wbGVt\nZW50YXRpb24gY2xhc3MKICAgICAqIGlzIHNwZWNpZmllZC4KICAgICAqLwog\nICAgcHVibGljIHZvaWQgdGVzdEJhZEN1c3RvbUNhY2hlU2V0dGluZygpIHsK\nICAgICAgICBNYXAgcHJvcHMgPSBuZXcgSGFzaE1hcChTeXN0ZW0uZ2V0UHJv\ncGVydGllcygpKTsKICAgICAgICBwcm9wcy5wdXQoIm9wZW5qcGEuTWV0YURh\ndGFGYWN0b3J5IiwgImpwYShUeXBlcz0iIAogICAgICAgICAgICArIFBlcnNv\nbi5jbGFzcy5nZXROYW1lKCkgKyAiKSIpOwogICAgICAgIHByb3BzLnB1dCgi\nb3BlbmpwYS5qZGJjLlF1ZXJ5U1FMQ2FjaGUiLCAKICAgICAgICAgICAgIm9y\nZy5hcGFjaGUub3BlbmpwYS5rZXJuZWwuVGVzdFF1ZXJ5U1FMQ2FjaGUuQmFk\nQ2FjaGVNYXAiKTsKICAgICAgICAKICAgICAgICB0cnkgewogICAgICAgICAg\nICBPcGVuSlBBRW50aXR5TWFuYWdlckZhY3RvcnlTUEkgZW1mID0gCiAgICAg\nICAgICAgICAgICAoT3BlbkpQQUVudGl0eU1hbmFnZXJGYWN0b3J5U1BJKU9w\nZW5KUEFQZXJzaXN0ZW5jZS5jYXN0KAogICAgICAgICAgICAgICAgICAgICAg\nICBQZXJzaXN0ZW5jZS5jcmVhdGVFbnRpdHlNYW5hZ2VyRmFjdG9yeSgidGVz\ndCIsIHByb3BzKSk7CiAgICAgICAgICAgIC8vIEVNRiBjcmVhdGlvbiBzaG91\nbGQgdGhyb3cgYW4gZXhjZXB0aW9uIGJlY2F1c2UgdGhlIGNhY2hlIAogICAg\nICAgICAgICAvLyBpbXBsZW1lbnRhdGlvbiBjbGFzcyB3aWxsIG5vdCBiZSBm\nb3VuZC4KICAgICAgICAgICAgYXNzZXJ0RmFsc2UoZmFsc2UpOwogICAgICAg\nIH0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgIGFzc2VydFRy\ndWUodHJ1ZSk7CiAgICAgICAgfQogICAgfQoKICAgIC8qCiAgICAgKiBWZXJp\nZnkgbXVsdGktdGhyZWFkZWQgbXVsdGktZW50aXR5IG1hbmFnZXIgZmluZGVy\nIHdvcmtzIHdpdGggdGhlCiAgICAgKiBRdWVyeVNRTENhY2hlIHNldCB0byAi\nYWxsIi4KICAgICAqLwogICAgcHVibGljIHZvaWQgdGVzdE11bHRpRU1DYWNo\naW5nQWxsKCkgewogICAgICAgIE1hcCBwcm9wcyA9IG5ldyBIYXNoTWFwKFN5\nc3RlbS5nZXRQcm9wZXJ0aWVzKCkpOwogICAgICAgIHByb3BzLnB1dCgib3Bl\nbmpwYS5NZXRhRGF0YUZhY3RvcnkiLCAianBhKFR5cGVzPSIgCiAgICAgICAg\nICAgICsgUGVyc29uLmNsYXNzLmdldE5hbWUoKSArICIpIik7CiAgICAgICAg\ncHJvcHMucHV0KCJvcGVuanBhLmpkYmMuUXVlcnlTUUxDYWNoZSIsIAogICAg\nICAgICAgICAiYWxsIik7CiAgICAgICAgcnVuTXVsdGlFTUNhY2hpbmcocHJv\ncHMpOyAgICAgICAgCiAgICB9CgogICAgLyoKICAgICAqIFZlcmlmeSBtdWx0\naS10aHJlYWRlZCBtdWx0aS1lbnRpdHkgbWFuYWdlciBmaW5kZXIgd29ya3Mg\nd2l0aCB0aGUKICAgICAqIFF1ZXJ5U1FMQ2FjaGUgc2V0IHRvICJ0cnVlIi4K\nICAgICAqLwogICAgcHVibGljIHZvaWQgdGVzdE11bHRpRU1DYWNoaW5nVHJ1\nZSgpIHsKICAgICAgICBNYXAgcHJvcHMgPSBuZXcgSGFzaE1hcChTeXN0ZW0u\nZ2V0UHJvcGVydGllcygpKTsKICAgICAgICBwcm9wcy5wdXQoIm9wZW5qcGEu\nTWV0YURhdGFGYWN0b3J5IiwgImpwYShUeXBlcz0iIAogICAgICAgICAgICAr\nIFBlcnNvbi5jbGFzcy5nZXROYW1lKCkgKyAiKSIpOwogICAgICAgIHByb3Bz\nLnB1dCgib3BlbmpwYS5qZGJjLlF1ZXJ5U1FMQ2FjaGUiLCAKICAgICAgICAg\nICAgInRydWUiKTsKICAgICAgICBydW5NdWx0aUVNQ2FjaGluZyhwcm9wcyk7\nCiAgICB9CgogICAgcHJpdmF0ZSB2b2lkIHJ1bk11bHRpRU1DYWNoaW5nKE1h\ncCBwcm9wcykgewoKICAgICAgICBFbnRpdHlNYW5hZ2VyRmFjdG9yeSBlbWZh\nYyA9IAogICAgICAgICAgICAgICAgUGVyc2lzdGVuY2UuY3JlYXRlRW50aXR5\nTWFuYWdlckZhY3RvcnkoInRlc3QiLCBwcm9wcyk7CgogICAgICAgIEVudGl0\neU1hbmFnZXIgZW0gPSBlbWZhYy5jcmVhdGVFbnRpdHlNYW5hZ2VyKCk7ICAg\nICAgICAgICAgCgogICAgICAgIC8vIENyZWF0ZSBzb21lIGVudGl0aWVzCiAg\nICAgICAgZW0uZ2V0VHJhbnNhY3Rpb24oKS5iZWdpbigpOwogICAgICAgIGZv\nciAoaW50IGkgPSAwOyBpIDwgblBlb3BsZTsgaSsrKQogICAgICAgIHsKICAg\nICAgICAgICAgUGVyc29uIHAgPSBuZXcgUGVyc29uKCk7CiAgICAgICAgICAg\nIHAuc2V0SWQoaSk7CiAgICAgICAgICAgIGVtLnBlcnNpc3QocCk7CiAgICAg\nICAgfQogICAgICAgIGVtLmZsdXNoKCk7CiAgICAgICAgZW0uZ2V0VHJhbnNh\nY3Rpb24oKS5jb21taXQoKTsKICAgICAgICBlbS5jbG9zZSgpOwoKICAgICAg\nICBUaHJlYWRbXSBuZXdUaHJlYWRzID0gbmV3IFRocmVhZFtuVGhyZWFkc107\nCiAgICAgICAgRmluZFBlb3BsZVtdIGN1c3RvbWVyID0gbmV3IEZpbmRQZW9w\nbGVbblRocmVhZHNdOwogICAgICAgIAogICAgICAgIGZvciAoaW50IGk9MDsg\naSA8IG5UaHJlYWRzOyBpKyspIHsKICAgICAgICAgICAgY3VzdG9tZXJbaV0g\nPSBuZXcgRmluZFBlb3BsZShlbWZhYywgMCwgblBlb3BsZSwgCiAgICAgICAg\nICAgICAgICBuSXRlcmF0aW9ucywgaSk7CiAgICAgICAgICAgIG5ld1RocmVh\nZHNbaV0gPSBuZXcgVGhyZWFkKGN1c3RvbWVyW2ldKTsKICAgICAgICAgICAg\nbmV3VGhyZWFkc1tpXS5zdGFydCgpOwogICAgICAgIH0KICAgICAgICAKICAg\nICAgICAvLyBXYWl0IGZvciB0aGUgd29ya2VyIHRocmVhZHMgdG8gY29tcGxl\ndGUKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IG5UaHJlYWRzOyBpKysp\nIHsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIG5ld1RocmVh\nZHNbaV0uam9pbigpOwogICAgICAgICAgICB9IGNhdGNoIChJbnRlcnJ1cHRl\nZEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgICAgICB0aGlzLmZhaWwoIkNh\ndWdodCBJbnRlcnJ1cHRlZCBFeGNlcHRpb246ICIgKyBlKTsKICAgICAgICAg\nICAgfQogICAgICAgIH0gICAKCiAgICAgICAgLy8gUnVuIHRocm91Z2ggdGhl\nIHN0YXRlIG9mIGFsbCBydW5uYWJsZXMgdG8gYXNzZXJ0IGlmIGFueSBvZiB0\naGVtCiAgICAgICAgLy8gZmFpbGVkLgogICAgICAgIGZvciAoaW50IGkgPSAw\nOyBpIDwgblRocmVhZHM7IGkrKykgewogICAgICAgICAgICBhc3NlcnRGYWxz\nZShjdXN0b21lcltpXS5oYWRGYWlsdXJlcygpKTsKICAgICAgICB9CgogICAg\nICAgIC8vIENsZWFuIHVwIHRoZSBlbnRpdGllcyB1c2VkIGluIHRoaXMgdGVz\ndAogICAgICAgIGVtID0gZW1mYWMuY3JlYXRlRW50aXR5TWFuYWdlcigpOyAg\nICAgICAgICAgIAogICAgICAgIGVtLmdldFRyYW5zYWN0aW9uKCkuYmVnaW4o\nKTsKCiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBuUGVvcGxlOyBpKysp\nIHsKICAgICAgICAgICAgUGVyc29uIHAgPSBlbS5maW5kKFBlcnNvbi5jbGFz\ncywgaSk7CiAgICAgICAgICAgIGVtLnJlbW92ZShwKTsKICAgICAgICB9CiAg\nICAgICAgZW0uZmx1c2goKTsKICAgICAgICBlbS5nZXRUcmFuc2FjdGlvbigp\nLmNvbW1pdCgpOwogICAgICAgIGVtLmNsb3NlKCk7CiAgICB9CiAgICAKICAg\nIC8qCiAgICAgKiBFbXB0eSBDb25jdXJyZW50SGFzaE1hcCBzdWJjbGFzcy4g\nVXNlZnVsIGZvciB0ZXN0aW5nIGN1c3RvbSBjYWNoZQogICAgICogc3RvcmFn\nZSBpbXBsZW1lbnRhdGlvbnMuCiAgICAgKi8KICAgIHB1YmxpYyBjbGFzcyBD\ndXN0b21DYWNoZU1hcCBleHRlbmRzIENvbmN1cnJlbnRIYXNoTWFwIHsKICAg\nICAgICAKICAgIH0KCiAgICAvKgogICAgICogU2ltcGxlIHJ1bm5hYmxlIHRv\nIHRlc3QgZmluZGVyIGluIGEgdGlnaHQgbG9vcC4gIE11bHRpcGxlIGluc3Rh\nbmNlcwogICAgICogb2YgdGhpcyBydW5uYWJsZSB3aWxsIHJ1biBzaW11bHRh\nbmVvdXNseS4KICAgICAqLwogICAgcHJpdmF0ZSBjbGFzcyBGaW5kUGVvcGxl\nIGltcGxlbWVudHMgUnVubmFibGUgewogICAgICAgIAogICAgICAgIHByaXZh\ndGUgaW50IHN0YXJ0SWQ7CiAgICAgICAgcHJpdmF0ZSBpbnQgZW5kSWQ7CiAg\nICAgICAgcHJpdmF0ZSBpbnQgdGhyZWFkOwogICAgICAgIHByaXZhdGUgaW50\nIGl0ZXJhdGlvbnM7CiAgICAgICAgcHJpdmF0ZSBFbnRpdHlNYW5hZ2VyRmFj\ndG9yeSBlbWY7CiAgICAgICAgcHJpdmF0ZSBib29sZWFuIGZhaWx1cmVzID0g\nZmFsc2U7CiAgICAgICAgCiAgICAgICAgcHVibGljIEZpbmRQZW9wbGUoRW50\naXR5TWFuYWdlckZhY3RvcnkgZW1mLCAKICAgICAgICAgICAgaW50IHN0YXJ0\nSWQsIGludCBlbmRJZCwgaW50IGl0ZXJhdGlvbnMsIGludCB0aHJlYWQpIHsK\nICAgICAgICAgICAgc3VwZXIoKTsKICAgICAgICAgICAgdGhpcy5zdGFydElk\nID0gc3RhcnRJZDsKICAgICAgICAgICAgdGhpcy5lbmRJZCA9IGVuZElkOwog\nICAgICAgICAgICB0aGlzLnRocmVhZCA9IHRocmVhZDsKICAgICAgICAgICAg\ndGhpcy5pdGVyYXRpb25zID0gaXRlcmF0aW9uczsKICAgICAgICAgICAgdGhp\ncy5lbWYgPSBlbWY7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIHB1Ymxp\nYyBib29sZWFuIGhhZEZhaWx1cmVzKCkKICAgICAgICB7CiAgICAgICAgICAg\nIHJldHVybiBmYWlsdXJlczsKICAgICAgICB9CiAgICAgICAgCiAgICAgICAg\ncHVibGljIHZvaWQgcnVuKCkgewogICAgICAgICAgICB0cnkgeyAgICAgICAg\nICAgIAogICAgICAgICAgICAgICAgRW50aXR5TWFuYWdlciBlbSA9IGVtZi5j\ncmVhdGVFbnRpdHlNYW5hZ2VyKCk7ICAgICAgICAgICAgCiAgICAgICAgICAg\nICAgICBmb3IgKGludCBqID0gMDsgaiA8IGl0ZXJhdGlvbnM7IGorKykgewog\nICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIGZvciAo\naW50IGkgPSBzdGFydElkOyBpIDwgZW5kSWQ7IGkrKykgewogICAgICAgICAg\nICAgICAgICAgICAgICBQZXJzb24gcDEgPSBlbS5maW5kKFBlcnNvbi5jbGFz\ncywgaSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwMS5nZXRJZCgp\nICE9IGkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFN5c3RlbS5v\ndXQucHJpbnRsbigiRmluZGVyIGZhaWxlZDogIiArIGkpOwogICAgICAgICAg\nICAgICAgICAgICAgICAgICAgZmFpbHVyZXMgPSB0cnVlOwogICAgICAgICAg\nICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAg\nICAgIH0gICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAg\nIH0KICAgICAgICAgICAgICAgICAgICBlbS5jbGVhcigpOyAgCiAgICAgICAg\nICAgICAgICB9CiAgICAgICAgICAgICAgICBlbS5jbG9zZSgpOyAgCiAgICAg\nICAgICAgIH0gCiAgICAgICAgICAgIGNhdGNoIChFeGNlcHRpb24gZSkgewog\nICAgICAgICAgICAgICBmYWlsdXJlcyA9IHRydWU7CiAgICAgICAgICAgICAg\nIFN5c3RlbS5vdXQucHJpbnRsbigiVGhyZWFkICIgKyB0aHJlYWQgKyAiIGV4\nY2VwdGlvbiA6IiArCiAgICAgICAgICAgICAgICAgICBlICk7CiAgICAgICAg\nICAgIH0KICAgICAgICB9CiAgICB9Cn0K\n","encoding":"base64"}

