{"sha":"7e90cb0e0d0a3b7705d45103c7e0aa67e1214449","node_id":"MDQ6QmxvYjIwNjM2NDo3ZTkwY2IwZTBkMGEzYjc3MDVkNDUxMDNjN2UwYWE2N2UxMjE0NDQ5","size":7600,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/7e90cb0e0d0a3b7705d45103c7e0aa67e1214449","content":"LyoNCiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRh\ndGlvbiAoQVNGKSB1bmRlciBvbmUNCiAqIG9yIG1vcmUgY29udHJpYnV0b3Ig\nbGljZW5zZSBhZ3JlZW1lbnRzLiAgU2VlIHRoZSBOT1RJQ0UgZmlsZQ0KICog\nZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5m\nb3JtYXRpb24NCiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAg\nVGhlIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGUNCiAqIHRvIHlvdSB1bmRlciB0\naGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUNCiAqICJMaWNl\nbnNlIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNv\nbXBsaWFuY2UNCiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFp\nbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQNCiAqDQogKiBodHRwOi8vd3d3\nLmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjANCiAqDQogKiBVbmxl\nc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGlu\nIHdyaXRpbmcsDQogKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUg\nTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbg0KICogIkFTIElTIiBCQVNJ\nUywgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZDQog\nKiBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBM\naWNlbnNlIGZvciB0aGUNCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmlu\nZyBwZXJtaXNzaW9ucyBhbmQgbGltaXRhdGlvbnMNCiAqIHVuZGVyIHRoZSBM\naWNlbnNlLg0KICovDQpwYWNrYWdlIG9yZy5hcGFjaGUub3BlbmpwYS5wZXJz\naXN0ZW5jZS5nZW5lcmF0aW9udHlwZTsNCg0KaW1wb3J0IGphdmF4LnBlcnNp\nc3RlbmNlLkVudGl0eU1hbmFnZXI7DQppbXBvcnQgamF2YXgucGVyc2lzdGVu\nY2UuRW50aXR5RXhpc3RzRXhjZXB0aW9uOw0KDQppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLnBlcnNpc3RlbmNlLkludmFsaWRTdGF0ZUV4Y2VwdGlvbjsN\nCmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UudGVzdC5T\naW5nbGVFTUZUZXN0Q2FzZTsNCg0KcHVibGljIGNsYXNzIFRlc3RHZW5lcmF0\nZWRWYWx1ZXMgZXh0ZW5kcyBTaW5nbGVFTUZUZXN0Q2FzZSB7DQogICAgDQog\nICAgcHVibGljIHZvaWQgc2V0VXAoKSB7IA0KICAgICAgICBzZXRVcChHZW5l\ncmF0ZWRWYWx1ZXMuY2xhc3MsIENMRUFSX1RBQkxFUyk7DQogICAgfQ0KDQog\nICAgcHVibGljIHZvaWQgdGVzdERlZmF1bHRWYWx1ZXMoKSB7IA0KICAgICAg\nICBFbnRpdHlNYW5hZ2VyIGVtID0gZW1mLmNyZWF0ZUVudGl0eU1hbmFnZXIo\nKTsNCg0KICAgICAgICBHZW5lcmF0ZWRWYWx1ZXMgZ3YgPSBuZXcgR2VuZXJh\ndGVkVmFsdWVzKCk7DQogICAgICAgIEdlbmVyYXRlZFZhbHVlcyBndjIgPSBu\nZXcgR2VuZXJhdGVkVmFsdWVzKCk7DQoNCiAgICAgICAgZW0uZ2V0VHJhbnNh\nY3Rpb24oKS5iZWdpbigpOw0KICAgICAgICBlbS5wZXJzaXN0KGd2KTsNCiAg\nICAgICAgZW0ucGVyc2lzdChndjIpOw0KICAgICAgICBlbS5nZXRUcmFuc2Fj\ndGlvbigpLmNvbW1pdCgpOw0KDQogICAgICAgIGVtLnJlZnJlc2goZ3YpOw0K\nICAgICAgICBlbS5yZWZyZXNoKGd2Mik7DQoNCiAgICAgICAgYXNzZXJ0RmFs\nc2UoZ3YuZ2V0SWQoKSA9PSBndjIuZ2V0SWQoKSk7DQogICAgICAgIGFzc2Vy\ndEZhbHNlKGd2LmdldEZpZWxkKCkgPT0gZ3YyLmdldEZpZWxkKCkpOw0KICAg\nICAgICBhc3NlcnRGYWxzZShndi5nZXRVdWlkc3RyaW5nKCkuZXF1YWxzKGd2\nMi5nZXRVdWlkc3RyaW5nKCkpKTsNCiAgICAgICAgYXNzZXJ0RmFsc2UoZ3Yu\nZ2V0VXVpZGhleCgpLmVxdWFscyhndjIuZ2V0VXVpZGhleCgpKSk7DQogICAg\nICAgIGFzc2VydEZhbHNlKGd2LmdldFV1aWRUNGhleCgpLmVxdWFscyhndjIu\nZ2V0VXVpZFQ0aGV4KCkpKTsNCiAgICAgICAgYXNzZXJ0RmFsc2UoZ3YuZ2V0\nVXVpZFQ0c3RyaW5nKCkuZXF1YWxzKGd2Mi5nZXRVdWlkVDRzdHJpbmcoKSkp\nOw0KICAgIH0NCiAgICANCiAgICBwdWJsaWMgdm9pZCB0ZXN0SW5pdGlhbFZh\nbHVlcygpIHsgDQogICAgICAgIEVudGl0eU1hbmFnZXIgZW0gPSBlbWYuY3Jl\nYXRlRW50aXR5TWFuYWdlcigpOw0KDQogICAgICAgIEdlbmVyYXRlZFZhbHVl\ncyBndiA9IG5ldyBHZW5lcmF0ZWRWYWx1ZXMoNywgOSwgImEiLCAiYiIsICJj\nIiwgImQiKTsNCg0KICAgICAgICB0cnkgew0KICAgICAgICAgICAgZW0uZ2V0\nVHJhbnNhY3Rpb24oKS5iZWdpbigpOw0KICAgICAgICAgICAgZW0ucGVyc2lz\ndChndik7DQogICAgICAgICAgICBlbS5nZXRUcmFuc2FjdGlvbigpLmNvbW1p\ndCgpOw0KICAgICAgICB9IGNhdGNoIChJbnZhbGlkU3RhdGVFeGNlcHRpb24g\naXNlKSB7DQogICAgICAgICAgICAvLyBleHBlY3RlZCByZXN1bHQNCiAgICAg\nICAgICAgIHJldHVybjsNCiAgICAgICAgfSAgY2F0Y2ggKEVudGl0eUV4aXN0\nc0V4Y2VwdGlvbiBlZWUpIHsNCiAgICAgICAgICAgIC8vIGFsc28gb2sNCiAg\nICAgICAgICAgIHJldHVybjsNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAg\nICAgLy8gc2hvdWxkIG5vdCBnZXQgaGVyZS4uLg0KICAgICAgICBmYWlsKCk7\nDQogICAgfQ0KICAgIA0KICAgIHB1YmxpYyB2b2lkIHRlc3RJZFNldHRlcigp\nIHsgDQogICAgICAgIEVudGl0eU1hbmFnZXIgZW0gPSBlbWYuY3JlYXRlRW50\naXR5TWFuYWdlcigpOw0KDQogICAgICAgIEdlbmVyYXRlZFZhbHVlcyBndiA9\nIG5ldyBHZW5lcmF0ZWRWYWx1ZXMoKTsNCiAgICAgICAgZ3Yuc2V0SWQoMyk7\nDQoNCiAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgIGVtLmdldFRyYW5zYWN0\naW9uKCkuYmVnaW4oKTsNCiAgICAgICAgICAgIGVtLnBlcnNpc3QoZ3YpOw0K\nICAgICAgICAgICAgZW0uZ2V0VHJhbnNhY3Rpb24oKS5jb21taXQoKTsNCiAg\nICAgICAgfSBjYXRjaCAoSW52YWxpZFN0YXRlRXhjZXB0aW9uIGlzZSkgew0K\nICAgICAgICAgICAgLy8gZXhwZWN0ZWQgcmVzdWx0DQogICAgICAgICAgICBy\nZXR1cm47DQogICAgICAgIH0gIGNhdGNoIChFbnRpdHlFeGlzdHNFeGNlcHRp\nb24gZWVlKSB7DQogICAgICAgICAgICAvLyBhbHNvIG9rDQogICAgICAgICAg\nICByZXR1cm47DQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIC8vIHNo\nb3VsZCBub3QgZ2V0IGhlcmUuLi4NCiAgICAgICAgZmFpbCgpOw0KICAgIH0N\nCiAgICANCiAgICBwdWJsaWMgdm9pZCB0ZXN0RmllbGRTZXR0ZXIoKSB7IA0K\nICAgICAgICBFbnRpdHlNYW5hZ2VyIGVtID0gZW1mLmNyZWF0ZUVudGl0eU1h\nbmFnZXIoKTsNCg0KICAgICAgICBHZW5lcmF0ZWRWYWx1ZXMgZ3YgPSBuZXcg\nR2VuZXJhdGVkVmFsdWVzKCk7DQogICAgICAgIGd2LnNldEZpZWxkKDUpOw0K\nDQogICAgICAgIHRyeSB7DQogICAgICAgICAgICBlbS5nZXRUcmFuc2FjdGlv\nbigpLmJlZ2luKCk7DQogICAgICAgICAgICBlbS5wZXJzaXN0KGd2KTsNCiAg\nICAgICAgICAgIGVtLmdldFRyYW5zYWN0aW9uKCkuY29tbWl0KCk7DQogICAg\nICAgIH0gY2F0Y2ggKEludmFsaWRTdGF0ZUV4Y2VwdGlvbiBpc2UpIHsNCiAg\nICAgICAgICAgIC8vIGV4cGVjdGVkIHJlc3VsdA0KICAgICAgICAgICAgcmV0\ndXJuOw0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICAvLyBzaG91bGQg\nbm90IGdldCBoZXJlLi4uDQogICAgICAgIGZhaWwoKTsNCiAgICB9DQoNCi8v\nICAgIHB1YmxpYyB2b2lkIHRlc3RDdXN0b21TZXF1ZW5jZUdlbmVyYXRvcigp\nIHsNCi8vICAgICAgICBFbnRpdHlNYW5hZ2VyIGVtID0gZW1mLmNyZWF0ZUVu\ndGl0eU1hbmFnZXIoKTsNCi8vDQovLyAgICAgICAgR2VuZXJhdGVkVmFsdWVz\nIGd2ID0gbmV3IEdlbmVyYXRlZFZhbHVlcygpOw0KLy8NCi8vICAgICAgICBl\nbS5nZXRUcmFuc2FjdGlvbigpLmJlZ2luKCk7DQovLyAgICAgICAgZW0ucGVy\nc2lzdChndik7DQovLyAgICAgICAgZW0uZ2V0VHJhbnNhY3Rpb24oKS5jb21t\naXQoKTsNCi8vDQovLyAgICAgICAgYXNzZXJ0Tm90RXF1YWxzKDAsIGd2Lmdl\ndEN1c3RvbVNlcUZpZWxkKCkpOw0KLy8gICAgfQ0KDQogICAgcHVibGljIHZv\naWQgdGVzdEN1c3RvbVNlcXVlbmNlR2VuZXJhdG9yV2l0aEluZGlyZWN0aW9u\nKCkgew0KICAgICAgICBFbnRpdHlNYW5hZ2VyIGVtID0gZW1mLmNyZWF0ZUVu\ndGl0eU1hbmFnZXIoKTsNCg0KICAgICAgICBHZW5lcmF0ZWRWYWx1ZXMgZ3Yg\nPSBuZXcgR2VuZXJhdGVkVmFsdWVzKCk7DQoNCiAgICAgICAgZW0uZ2V0VHJh\nbnNhY3Rpb24oKS5iZWdpbigpOw0KICAgICAgICBlbS5wZXJzaXN0KGd2KTsN\nCiAgICAgICAgZW0uZ2V0VHJhbnNhY3Rpb24oKS5jb21taXQoKTsNCg0KICAg\nICAgICBhc3NlcnROb3RFcXVhbHMoMCwgZ3YuZ2V0Q3VzdG9tU2VxV2l0aElu\nZGlyZWN0aW9uRmllbGQoKSk7DQogICAgfQ0KICAgIA0KICAgIHB1YmxpYyB2\nb2lkIHRlc3RVVUlER2VuZXJhdG9ycygpIHsNCiAgICAgICAgRW50aXR5TWFu\nYWdlciBlbSA9IGVtZi5jcmVhdGVFbnRpdHlNYW5hZ2VyKCk7DQoNCiAgICAg\nICAgR2VuZXJhdGVkVmFsdWVzIGd2ID0gbmV3IEdlbmVyYXRlZFZhbHVlcygp\nOw0KICAgICAgICBlbS5nZXRUcmFuc2FjdGlvbigpLmJlZ2luKCk7DQogICAg\nICAgIGVtLnBlcnNpc3QoZ3YpOw0KICAgICAgICBlbS5nZXRUcmFuc2FjdGlv\nbigpLmNvbW1pdCgpOw0KICAgICAgICANCiAgICAgICAgaW50IGlkID0gZ3Yu\nZ2V0SWQoKTsNCg0KICAgICAgICBhc3NlcnRUcnVlKGlzU3RyaW5nVVVJRChn\ndi5nZXRVdWlkVDRzdHJpbmcoKSwgNCkpOw0KICAgICAgICBhc3NlcnRUcnVl\nKGlzU3RyaW5nVVVJRChndi5nZXRVdWlkc3RyaW5nKCksIDEpKTsNCiAgICAg\nICAgYXNzZXJ0VHJ1ZShpc0hleFVVSUQoZ3YuZ2V0VXVpZGhleCgpLCAxKSk7\nDQogICAgICAgIGFzc2VydFRydWUoaXNIZXhVVUlEKGd2LmdldFV1aWRUNGhl\neCgpLCA0KSk7ICAgICANCiAgICAgICAgDQogICAgICAgIGVtLmNsZWFyKCk7\nDQogICAgICAgIA0KICAgICAgICBHZW5lcmF0ZWRWYWx1ZXMgZ3YyID0gZW0u\nZmluZChHZW5lcmF0ZWRWYWx1ZXMuY2xhc3MsIGlkKTsgIA0KICAgICAgICBh\nc3NlcnROb3ROdWxsKGd2Mik7DQogICAgICAgIC8vIFRoZSBzdHJpbmcgdmFs\ndWUgY291bGQgY29udGFpbiBudWxsIHZhbHVlcyBhbmQgc3VjaCBzbyBsZW5n\ndGgNCiAgICAgICAgLy8gY2FsY3VsYXRpb25zIG1heSBiZSBub24tZGV0ZXJt\naW5pc3RpYy4gIEZvciBzdHJpbmcgZ2VuZXJhdG9ycywgDQogICAgICAgIC8v\nIHNpbXBseSBlbnN1cmUgdGhlIGZpZWxkcyBhcmUgcG9wdWxhdGVkIChub3Qg\nbnVsbCkuIA0KICAgICAgICBhc3NlcnROb3ROdWxsKGd2Mi5nZXRVdWlkc3Ry\naW5nKCkpOw0KICAgICAgICBhc3NlcnRUcnVlKGlzSGV4VVVJRChndjIuZ2V0\nVXVpZGhleCgpLCAxKSk7DQogICAgICAgIGFzc2VydE5vdE51bGwoZ3YyLmdl\ndFV1aWRUNHN0cmluZygpKTsNCiAgICAgICAgYXNzZXJ0VHJ1ZShpc0hleFVV\nSUQoZ3YyLmdldFV1aWRUNGhleCgpLCA0KSk7ICAgICANCiAgICAgICAgDQog\nICAgICAgIC8vIENvbXBhcmUgb3JpZ2luYWwgaGV4IHZhbHVlcyB3aXRoIG5l\ndyB2YWx1ZXMuICBUaGV5IHNob3VsZCBiZSBlcXVhbC4NCiAgICAgICAgLy8g\nTm90ZTogVVVJRCAnc3RyaW5nJyB2YWx1ZXMgYXJlIG5vdCBjb21wYXJlZC4g\nIEluIG1vc3QgY2FzZXMgdGhleSB3aWxsDQogICAgICAgIC8vIGJlIHRoZSBz\nYW1lLCBidXQgaW4gYW4gZW52aXJvbm1lbnQgd2hlcmUgZGF0YSBpcyBjb252\nZXJ0ZWQgdG8NCiAgICAgICAgLy8gYSBjb25zaWRlcmFibHkgZGlmZmVyZW50\nIGNoYXJhY3RlciBlbmNvZGluZyBvZiB0aGUgZGF0YWJhc2UgKGV4Lg0KICAg\nICAgICAvLyBVbmljb2RlIC0+IEVCQ0RJQykgdXBvbiBwZXJzaXN0ZW5jZSwg\ndGhlIHV1aWQgc3RyaW5nIHJldHVybmVkIGJ5IHRoZSANCiAgICAgICAgLy8g\nZGF0YWJhc2UgbWF5IG5vdCBiZSBlcXVhbCB0byB0aGUgb3JpZ2luYWwgdmFs\ndWUuICBUaGlzIGlzIGEgY29tbW9uIA0KICAgICAgICAvLyBpc3N1ZSB3aXRo\nIHN0cmluZyBkYXRhLCBidXQgZXZlbiBtb3JlIGxpa2VseSBmb3IgYSB1dWlk\ncyBnaXZlbiB0aGF0IA0KICAgICAgICAvLyB1dWlkIHN0cmluZ3MgYXJlIHBy\nb2R1Y2VkIGZyb20gcHNldWRvLXJhbmRvbSBieXRlIGFycmF5cywgd2hpY2gg\neWllbGQgDQogICAgICAgIC8vIGFsbCBzb3J0cyBvZiB2YXJpYW50IGNoYXJh\nY3RlcnMuDQogICAgICAgIGFzc2VydFRydWUoZ3YuZ2V0SWQoKSA9PSBndjIu\nZ2V0SWQoKSk7DQogICAgICAgIGFzc2VydFRydWUoZ3YuZ2V0RmllbGQoKSA9\nPSBndjIuZ2V0RmllbGQoKSk7DQogICAgICAgIGFzc2VydFRydWUoZ3YuZ2V0\nVXVpZGhleCgpLmVxdWFscyhndjIuZ2V0VXVpZGhleCgpKSk7DQogICAgICAg\nIGFzc2VydFRydWUoZ3YuZ2V0VXVpZFQ0aGV4KCkuZXF1YWxzKGd2Mi5nZXRV\ndWlkVDRoZXgoKSkpOw0KICAgIH0NCiAgICAgICAgICAgICAgICANCiAgICAv\nKg0KICAgICAqIFZlcmlmeSBhIHV1aWQgc3RyaW5nIGlzIDE2IGNoYXJhY3Rl\ncnMgbG9uZyBhbmQgaXMgdGhlIGV4cGVjdGVkIHR5cGUuDQogICAgICovDQog\nICAgcHJpdmF0ZSBib29sZWFuIGlzU3RyaW5nVVVJRChTdHJpbmcgdmFsdWUs\nIGludCB0eXBlKSB7DQogICAgICAgIGlmICh2YWx1ZS5sZW5ndGgoKSAhPSAx\nNikNCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgYnl0ZSB2\nZXJzaW9uID0gKGJ5dGUpKHZhbHVlLmNoYXJBdCg2KSA+Pj4gNCk7DQogICAg\nICAgIGlmICh0eXBlICE9IHZlcnNpb24pIHJldHVybiBmYWxzZTsNCiAgICAg\nICAgcmV0dXJuIHRydWU7DQogICAgfQ0KICAgIA0KICAgIC8qDQogICAgICog\nVmVyaWZ5IGEgdXVpZCBoZXggc3RyaW5nIHZhbHVlIGlzIDMyIGNoYXJhY3Rl\ncnMgbG9uZywgY29uc2lzdHMgZW50aXJlbHkNCiAgICAgKiBvZiBoZXggZGln\naXRzIGFuZCBpcyB0aGUgY29ycmVjdCB2ZXJzaW9uLg0KICAgICAqLw0KICAg\nIHByaXZhdGUgYm9vbGVhbiBpc0hleFVVSUQoU3RyaW5nIHZhbHVlLCBpbnQg\ndHlwZSkgew0KICAgICAgICBpZiAodmFsdWUubGVuZ3RoKCkgIT0gMzIpIA0K\nICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICBjaGFyW10gY2hB\ncnIgPSB2YWx1ZS50b0NoYXJBcnJheSgpOw0KICAgICAgICBmb3IgKGludCBp\nID0gMDsgaSA8IDMyOyBpKyspDQogICAgICAgIHsgICAgICAgICAgICAgICAg\nDQogICAgICAgICAgICBjaGFyIGNoID0gY2hBcnJbaV07DQogICAgICAgICAg\nICBpZiAoIShDaGFyYWN0ZXIuaXNEaWdpdChjaCkgfHwNCiAgICAgICAgICAg\nICAgICAoY2ggPj0gJ2EnICYmIGNoIDw9ICdmJykgfHwNCiAgICAgICAgICAg\nICAgICAoY2ggPj0gJ0EnICYmIGNoIDw9ICdGJykpKQ0KICAgICAgICAgICAg\nICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgIGlmIChpID09IDEyKSB7\nDQogICAgICAgICAgICAgICAgaWYgKHR5cGUgPT0gMSAmJiBjaCAhPSAnMScp\nDQogICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAg\nICAgICAgICBpZiAodHlwZSA9PSA0ICYmIGNoICE9ICc0JykNCiAgICAgICAg\nICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgfQ0KICAg\nICAgICB9DQogICAgICAgIHJldHVybiB0cnVlOw0KICAgIH0NCn0NCg==\n","encoding":"base64"}

