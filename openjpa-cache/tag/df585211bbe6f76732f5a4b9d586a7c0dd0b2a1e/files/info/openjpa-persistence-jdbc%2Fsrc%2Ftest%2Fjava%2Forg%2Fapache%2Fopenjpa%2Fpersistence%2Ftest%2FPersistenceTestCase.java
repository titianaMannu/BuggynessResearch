{"sha":"2c52402a3b25489e99d72b78509f4504872af08d","node_id":"MDQ6QmxvYjIwNjM2NDoyYzUyNDAyYTNiMjU0ODllOTlkNzJiNzg1MDlmNDUwNDg3MmFmMDhk","size":10735,"url":"https://api.github.com/repos/apache/openjpa/git/blobs/2c52402a3b25489e99d72b78509f4504872af08d","content":"LyoKICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0\naW9uIChBU0YpIHVuZGVyIG9uZQogKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxp\nY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGUKICogZGlz\ndHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3Jt\nYXRpb24KICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUg\nQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZQogKiB0byB5b3UgdW5kZXIgdGhlIEFw\nYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlCiAqICJMaWNlbnNlIik7\nIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFu\nY2UKICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29w\neSBvZiB0aGUgTGljZW5zZSBhdAogKgogKiBodHRwOi8vd3d3LmFwYWNoZS5v\ncmcvbGljZW5zZXMvTElDRU5TRS0yLjAKICoKICogVW5sZXNzIHJlcXVpcmVk\nIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLAog\nKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBk\naXN0cmlidXRlZCBvbiBhbgogKiAiQVMgSVMiIEJBU0lTLCBXSVRIT1VUIFdB\nUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkKICogS0lORCwgZWl0aGVy\nIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhl\nCiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBh\nbmQgbGltaXRhdGlvbnMKICogdW5kZXIgdGhlIExpY2Vuc2UuICAgIAogKi8K\ncGFja2FnZSBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UudGVzdDsK\nCmltcG9ydCBqYXZhLmxhbmcucmVmbGVjdC5Nb2RpZmllcjsKaW1wb3J0IGph\ndmEudXRpbC5BcnJheUxpc3Q7CmltcG9ydCBqYXZhLnV0aWwuSXRlcmF0b3I7\nCmltcG9ydCBqYXZhLnV0aWwuTGlzdDsKaW1wb3J0IGphdmEudXRpbC5NYXA7\nCmltcG9ydCBqYXZhLnV0aWwuSGFzaE1hcDsKaW1wb3J0IGphdmF4LnBlcnNp\nc3RlbmNlLkVudGl0eU1hbmFnZXI7CmltcG9ydCBqYXZheC5wZXJzaXN0ZW5j\nZS5FbnRpdHlNYW5hZ2VyRmFjdG9yeTsKaW1wb3J0IGphdmF4LnBlcnNpc3Rl\nbmNlLlBlcnNpc3RlbmNlOwoKaW1wb3J0IGp1bml0LmZyYW1ld29yay5UZXN0\nQ2FzZTsKaW1wb3J0IGp1bml0LmZyYW1ld29yay5UZXN0UmVzdWx0OwppbXBv\ncnQgb3JnLmFwYWNoZS5vcGVuanBhLmtlcm5lbC5BYnN0cmFjdEJyb2tlckZh\nY3Rvcnk7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEua2VybmVsLkJyb2tl\ncjsKaW1wb3J0IG9yZy5hcGFjaGUub3BlbmpwYS5tZXRhLkNsYXNzTWV0YURh\ndGE7CmltcG9ydCBvcmcuYXBhY2hlLm9wZW5qcGEucGVyc2lzdGVuY2UuT3Bl\nbkpQQUVudGl0eU1hbmFnZXJGYWN0b3J5U1BJOwppbXBvcnQgb3JnLmFwYWNo\nZS5vcGVuanBhLnBlcnNpc3RlbmNlLkpQQUZhY2FkZUhlbHBlcjsKCi8qKgog\nKiBCYXNlIHRlc3QgY2xhc3MgcHJvdmlkaW5nIHBlcnNpc3RlbmNlIHV0aWxp\ndGllcy4KICovCnB1YmxpYyBhYnN0cmFjdCBjbGFzcyBQZXJzaXN0ZW5jZVRl\nc3RDYXNlCiAgICBleHRlbmRzIFRlc3RDYXNlIHsKCiAgICAvKioKICAgICAq\nIE1hcmtlciBvYmplY3QgeW91IHBhc3MgdG8ge0BsaW5rICNzZXRVcH0gdG8g\naW5kaWNhdGUgdGhhdCB0aGUKICAgICAqIGRhdGFiYXNlIHRhYmxlIHJvd3Mg\nc2hvdWxkIGJlIGNsZWFyZWQuCiAgICAgKi8KICAgIHByb3RlY3RlZCBzdGF0\naWMgZmluYWwgT2JqZWN0IENMRUFSX1RBQkxFUyA9IG5ldyBPYmplY3QoKTsK\nCiAgICAvKioKICAgICAqIE1hcmtlciBvYmplY3QgeW91IHBhc3MgdG8ge0Bs\naW5rICNzZXRVcH0gdG8gaW5kaWNhdGUgdGhhdCB0aGUKICAgICAqIGRhdGFi\nYXNlIHRhYmxlIHNob3VsZCBiZSBkcm9wcGVkIGFuZCB0aGVuIHJlY3JlYXRl\nZC4KICAgICAqLwogICAgcHJvdGVjdGVkIHN0YXRpYyBmaW5hbCBPYmplY3Qg\nRFJPUF9UQUJMRVMgPSBuZXcgT2JqZWN0KCk7CgogICAgLyoqCiAgICAgKiBU\naGUge0BsaW5rIFRlc3RSZXN1bHR9IGluc3RhbmNlIGZvciB0aGUgY3VycmVu\ndCB0ZXN0IHJ1bi4KICAgICAqLwogICAgcHJvdGVjdGVkIFRlc3RSZXN1bHQg\ndGVzdFJlc3VsdDsKCiAgICAvKioKICAgICAqIENyZWF0ZSBhbiBlbnRpdHkg\nbWFuYWdlciBmYWN0b3J5LiBQdXQge0BsaW5rICNDTEVBUl9UQUJMRVN9IGlu\nCiAgICAgKiB0aGlzIGxpc3QgdG8gdGVsbCB0aGUgdGVzdCBmcmFtZXdvcmsg\ndG8gZGVsZXRlIGFsbCB0YWJsZSBjb250ZW50cwogICAgICogYmVmb3JlIHJ1\nbm5pbmcgdGhlIHRlc3RzLgogICAgICoKICAgICAqIEBwYXJhbSBwcm9wcyBs\naXN0IG9mIHBlcnNpc3RlbnQgdHlwZXMgdXNlZCBpbiB0ZXN0aW5nIGFuZC9v\ncgogICAgICogY29uZmlndXJhdGlvbiB2YWx1ZXMgaW4gdGhlIGZvcm0ga2V5\nLHZhbHVlLGtleSx2YWx1ZS4uLgogICAgICovCiAgICBwcm90ZWN0ZWQgT3Bl\nbkpQQUVudGl0eU1hbmFnZXJGYWN0b3J5U1BJIGNyZWF0ZUVNRihPYmplY3Qu\nLi4gcHJvcHMpIHsKICAgICAgICByZXR1cm4gY3JlYXRlTmFtZWRFTUYoZ2V0\nUGVyc2lzdGVuY2VVbml0TmFtZSgpLCBwcm9wcyk7CiAgICB9CgogICAgLyoq\nCiAgICAgKiBUaGUgbmFtZSBvZiB0aGUgcGVyc2lzdGVuY2UgdW5pdCB0aGF0\nIHRoaXMgdGVzdCBjbGFzcyBzaG91bGQgdXNlCiAgICAgKiBieSBkZWZhdWx0\nLiBUaGlzIGRlZmF1bHRzIHRvICJ0ZXN0Ii4KICAgICAqLwogICAgcHJvdGVj\ndGVkIFN0cmluZyBnZXRQZXJzaXN0ZW5jZVVuaXROYW1lKCkgewogICAgICAg\nIHJldHVybiAidGVzdCI7CiAgICB9CgogICAgLyoqCiAgICAgKiBDcmVhdGUg\nYW4gZW50aXR5IG1hbmFnZXIgZmFjdG9yeSBmb3IgcGVyc2lzdGVuY2UgdW5p\ndCA8Y29kZT5wdTwvY29kZT4uCiAgICAgKiBQdXQge0BsaW5rICNDTEVBUl9U\nQUJMRVN9IGluCiAgICAgKiB0aGlzIGxpc3QgdG8gdGVsbCB0aGUgdGVzdCBm\ncmFtZXdvcmsgdG8gZGVsZXRlIGFsbCB0YWJsZSBjb250ZW50cwogICAgICog\nYmVmb3JlIHJ1bm5pbmcgdGhlIHRlc3RzLgogICAgICoKICAgICAqIEBwYXJh\nbSBwcm9wcyBsaXN0IG9mIHBlcnNpc3RlbnQgdHlwZXMgdXNlZCBpbiB0ZXN0\naW5nIGFuZC9vcgogICAgICogY29uZmlndXJhdGlvbiB2YWx1ZXMgaW4gdGhl\nIGZvcm0ga2V5LHZhbHVlLGtleSx2YWx1ZS4uLgogICAgICovCiAgICBwcm90\nZWN0ZWQgT3BlbkpQQUVudGl0eU1hbmFnZXJGYWN0b3J5U1BJIGNyZWF0ZU5h\nbWVkRU1GKFN0cmluZyBwdSwKICAgICAgICBPYmplY3QuLi4gcHJvcHMpIHsK\nICAgICAgICBNYXAgbWFwID0gbmV3IEhhc2hNYXAoU3lzdGVtLmdldFByb3Bl\ncnRpZXMoKSk7CiAgICAgICAgTGlzdDxDbGFzcz4gdHlwZXMgPSBuZXcgQXJy\nYXlMaXN0PENsYXNzPigpOwogICAgICAgIGJvb2xlYW4gcHJvcCA9IGZhbHNl\nOwogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBp\nKyspIHsKICAgICAgICAgICAgaWYgKHByb3ApIHsKICAgICAgICAgICAgICAg\nIG1hcC5wdXQocHJvcHNbaSAtIDFdLCBwcm9wc1tpXSk7CiAgICAgICAgICAg\nICAgICBwcm9wID0gZmFsc2U7CiAgICAgICAgICAgIH0gZWxzZSBpZiAocHJv\ncHNbaV0gPT0gQ0xFQVJfVEFCTEVTKSB7CiAgICAgICAgICAgICAgICBtYXAu\ncHV0KCJvcGVuanBhLmpkYmMuU3luY2hyb25pemVNYXBwaW5ncyIsCiAgICAg\nICAgICAgICAgICAgICAgImJ1aWxkU2NoZW1hKEZvcmVpZ25LZXlzPXRydWUs\nIiAKICAgICAgICAgICAgICAgICAgICArICJTY2hlbWFBY3Rpb249J2FkZCxk\nZWxldGVUYWJsZUNvbnRlbnRzJykiKTsKICAgICAgICAgICAgfSBlbHNlIGlm\nIChwcm9wc1tpXSA9PSBEUk9QX1RBQkxFUykgewogICAgICAgICAgICAgICAg\nbWFwLnB1dCgib3BlbmpwYS5qZGJjLlN5bmNocm9uaXplTWFwcGluZ3MiLAog\nICAgICAgICAgICAgICAgICAgICJidWlsZFNjaGVtYShGb3JlaWduS2V5cz10\ncnVlLCIgCiAgICAgICAgICAgICAgICAgICAgKyAiU2NoZW1hQWN0aW9uPSdk\ncm9wLGFkZCcpIik7CiAgICAgICAgICAgIH0gZWxzZSBpZiAocHJvcHNbaV0g\naW5zdGFuY2VvZiBDbGFzcykKICAgICAgICAgICAgICAgIHR5cGVzLmFkZCgo\nQ2xhc3MpIHByb3BzW2ldKTsKICAgICAgICAgICAgZWxzZSBpZiAocHJvcHNb\naV0gIT0gbnVsbCkKICAgICAgICAgICAgICAgIHByb3AgPSB0cnVlOwogICAg\nICAgIH0KCiAgICAgICAgaWYgKCF0eXBlcy5pc0VtcHR5KCkpIHsKICAgICAg\nICAgICAgU3RyaW5nQnVmZmVyIGJ1ZiA9IG5ldyBTdHJpbmdCdWZmZXIoKTsK\nICAgICAgICAgICAgZm9yIChDbGFzcyBjIDogdHlwZXMpIHsKICAgICAgICAg\nICAgICAgIGlmIChidWYubGVuZ3RoKCkgPiAwKQogICAgICAgICAgICAgICAg\nICAgIGJ1Zi5hcHBlbmQoIjsiKTsKICAgICAgICAgICAgICAgIGJ1Zi5hcHBl\nbmQoYy5nZXROYW1lKCkpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIG1h\ncC5wdXQoIm9wZW5qcGEuTWV0YURhdGFGYWN0b3J5IiwKICAgICAgICAgICAg\nICAgICJqcGEoVHlwZXM9IiArIGJ1Zi50b1N0cmluZygpICsgIikiKTsKICAg\nICAgICB9CgogICAgICAgIHJldHVybiAoT3BlbkpQQUVudGl0eU1hbmFnZXJG\nYWN0b3J5U1BJKSBQZXJzaXN0ZW5jZS4KICAgICAgICAgICAgY3JlYXRlRW50\naXR5TWFuYWdlckZhY3RvcnkocHUsIG1hcCk7CiAgICB9CgogICAgQE92ZXJy\naWRlCiAgICBwdWJsaWMgdm9pZCBydW4oVGVzdFJlc3VsdCB0ZXN0UmVzdWx0\nKSB7CiAgICAgICAgdGhpcy50ZXN0UmVzdWx0ID0gdGVzdFJlc3VsdDsKICAg\nICAgICBzdXBlci5ydW4odGVzdFJlc3VsdCk7CiAgICB9CgogICAgQE92ZXJy\naWRlCiAgICBwdWJsaWMgdm9pZCB0ZWFyRG93bigpIHRocm93cyBFeGNlcHRp\nb24gewogICAgICAgIHRyeSB7CiAgICAgICAgICAgIHN1cGVyLnRlYXJEb3du\nKCk7CiAgICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICAg\nICAgLy8gaWYgYSB0ZXN0IGZhaWxlZCwgc3dhbGxvdyBhbnkgZXhjZXB0aW9u\ncyB0aGF0IGhhcHBlbgogICAgICAgICAgICAvLyBkdXJpbmcgdGVhci1kb3du\nLCBhcyB0aGVzZSBqdXN0IG1hc2sgdGhlIG9yaWdpbmFsIHByb2JsZW0uCiAg\nICAgICAgICAgIGlmICh0ZXN0UmVzdWx0Lndhc1N1Y2Nlc3NmdWwoKSkKICAg\nICAgICAgICAgICAgIHRocm93IGU7CiAgICAgICAgfQogICAgfQoKICAgIC8q\nKgogICAgICogU2FmZWx5IGNsb3NlIHRoZSBnaXZlbiBmYWN0b3J5LgogICAg\nICovCiAgICBwcm90ZWN0ZWQgYm9vbGVhbiBjbG9zZUVNRihFbnRpdHlNYW5h\nZ2VyRmFjdG9yeSBlbWYpIHsKICAgICAgICBpZiAoZW1mID09IG51bGwgfHwg\nIWVtZi5pc09wZW4oKSkKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAg\nICAgIAogICAgICAgIGNsb3NlQWxsT3BlbkVNcyhlbWYpOwogICAgICAgIGVt\nZi5jbG9zZSgpOwogICAgICAgIHJldHVybiAhZW1mLmlzT3BlbigpOwogICAg\nfQoKICAgIC8qKgogICAgICogQ2xvc2VzIGFsbCBvcGVuIGVudGl0eSBtYW5h\nZ2VycyBhZnRlciBmaXJzdCByb2xsaW5nIGJhY2sgYW55IG9wZW4gCiAgICAg\nKiB0cmFuc2FjdGlvbnMuCiAgICAgKi8KICAgIHByb3RlY3RlZCB2b2lkIGNs\nb3NlQWxsT3BlbkVNcyhFbnRpdHlNYW5hZ2VyRmFjdG9yeSBlbWYpIHsKICAg\nICAgICBpZiAoZW1mID09IG51bGwgfHwgIWVtZi5pc09wZW4oKSkKICAgICAg\nICAgICAgcmV0dXJuOwoKICAgICAgICBmb3IgKEl0ZXJhdG9yIGl0ZXIgPSAo\nKEFic3RyYWN0QnJva2VyRmFjdG9yeSkgSlBBRmFjYWRlSGVscGVyCiAgICAg\nICAgICAgIC50b0Jyb2tlckZhY3RvcnkoZW1mKSkuZ2V0T3BlbkJyb2tlcnMo\nKS5pdGVyYXRvcigpOwogICAgICAgICAgICBpdGVyLmhhc05leHQoKTsgKSB7\nCiAgICAgICAgICAgIEJyb2tlciBiID0gKEJyb2tlcikgaXRlci5uZXh0KCk7\nCiAgICAgICAgICAgIGlmIChiICE9IG51bGwgJiYgIWIuaXNDbG9zZWQoKSkg\newogICAgICAgICAgICAgICAgRW50aXR5TWFuYWdlciBlbSA9IEpQQUZhY2Fk\nZUhlbHBlci50b0VudGl0eU1hbmFnZXIoYik7CiAgICAgICAgICAgICAgICBp\nZiAoZW0uZ2V0VHJhbnNhY3Rpb24oKS5pc0FjdGl2ZSgpKQogICAgICAgICAg\nICAgICAgICAgIGVtLmdldFRyYW5zYWN0aW9uKCkucm9sbGJhY2soKTsKICAg\nICAgICAgICAgICAgIGVtLmNsb3NlKCk7CiAgICAgICAgICAgIH0KICAgICAg\nICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBEZWxldGUgYWxsIGluc3RhbmNl\ncyBvZiB0aGUgZ2l2ZW4gdHlwZXMgdXNpbmcgYnVsayBkZWxldGUgcXVlcmll\ncywKICAgICAqIGJ1dCBkbyBub3QgY2xvc2UgYW55IG9wZW4gZW50aXR5IG1h\nbmFnZXJzLgogICAgICovCiAgICBwcm90ZWN0ZWQgdm9pZCBjbGVhcihFbnRp\ndHlNYW5hZ2VyRmFjdG9yeSBlbWYsIENsYXNzLi4uIHR5cGVzKSB7CiAgICAg\nICAgaWYgKGVtZiA9PSBudWxsIHx8IHR5cGVzLmxlbmd0aCA9PSAwKQogICAg\nICAgICAgICByZXR1cm47CgogICAgICAgIExpc3Q8Q2xhc3NNZXRhRGF0YT4g\nbWV0YXMgPSBuZXcgQXJyYXlMaXN0PENsYXNzTWV0YURhdGE+KHR5cGVzLmxl\nbmd0aCk7CiAgICAgICAgZm9yIChDbGFzcyBjIDogdHlwZXMpIHsKICAgICAg\nICAgICAgQ2xhc3NNZXRhRGF0YSBtZXRhID0gSlBBRmFjYWRlSGVscGVyLmdl\ndE1ldGFEYXRhKGVtZiwgYyk7CiAgICAgICAgICAgIGlmIChtZXRhICE9IG51\nbGwpCiAgICAgICAgICAgICAgICBtZXRhcy5hZGQobWV0YSk7CiAgICAgICAg\nfQogICAgICAgIGNsZWFyKGVtZiwgZmFsc2UsIG1ldGFzLnRvQXJyYXkobmV3\nIENsYXNzTWV0YURhdGFbbWV0YXMuc2l6ZSgpXSkpOwogICAgfQoKICAgIC8q\nKgogICAgICogRGVsZXRlIGFsbCBpbnN0YW5jZXMgb2YgdGhlIHBlcnNpc3Rl\nbnQgdHlwZXMgcmVnaXN0ZXJlZCB3aXRoIHRoZSBnaXZlbgogICAgICogZmFj\ndG9yeSB1c2luZyBidWxrIGRlbGV0ZSBxdWVyaWVzLCBhZnRlciBmaXJzdCBj\nbG9zaW5nIGFsbCBvcGVuIGVudGl0eQogICAgICogbWFuYWdlcnMgKGFuZCBy\nb2xsaW5nIGJhY2sgYW55IG9wZW4gdHJhbnNhY3Rpb25zKS4KICAgICAqLwog\nICAgcHJvdGVjdGVkIHZvaWQgY2xlYXIoRW50aXR5TWFuYWdlckZhY3Rvcnkg\nZW1mKSB7CiAgICAgICAgaWYgKGVtZiA9PSBudWxsKQogICAgICAgICAgICBy\nZXR1cm47CiAgICAgICAgY2xlYXIoZW1mLCB0cnVlLCAoKE9wZW5KUEFFbnRp\ndHlNYW5hZ2VyRmFjdG9yeVNQSSkgZW1mKQogICAgICAgIAkJLmdldENvbmZp\nZ3VyYXRpb24oKQogICAgICAgIAkJLmdldE1ldGFEYXRhUmVwb3NpdG9yeUlu\nc3RhbmNlKCkuZ2V0TWV0YURhdGFzKCkpOwogICAgfQoKICAgIC8qKgogICAg\nICogRGVsZXRlIGFsbCBpbnN0YW5jZXMgb2YgdGhlIGdpdmVuIHR5cGVzIHVz\naW5nIGJ1bGsgZGVsZXRlIHF1ZXJpZXMuCiAgICAgKiBAcGFyYW0gY2xvc2VF\nTXMgVE9ETwogICAgICovCiAgICBwcml2YXRlIHZvaWQgY2xlYXIoRW50aXR5\nTWFuYWdlckZhY3RvcnkgZW1mLCBib29sZWFuIGNsb3NlRU1zLCAKICAgIAkJ\nQ2xhc3NNZXRhRGF0YS4uLiB0eXBlcykgewogICAgICAgIGlmIChlbWYgPT0g\nbnVsbCB8fCB0eXBlcy5sZW5ndGggPT0gMCkKICAgICAgICAgICAgcmV0dXJu\nOwogICAgICAgIAogICAgICAgIC8vIHByZXZlbnQgZGVhZGxvY2sgYnkgY2xv\nc2luZyB0aGUgb3BlbiBlbnRpdHkgbWFuYWdlcnMgCiAgICAgICAgLy8gYW5k\nIHJvbGxpbmcgYmFjayBhbnkgb3BlbiB0cmFuc2FjdGlvbnMgCiAgICAgICAg\nLy8gYmVmb3JlIGlzc3VpbmcgZGVsZXRlIHN0YXRlbWVudHMgb24gYSBuZXcg\nZW50aXR5IG1hbmFnZXIuCiAgICAgICAgaWYgKGNsb3NlRU1zKQogICAgICAg\nICAgICBjbG9zZUFsbE9wZW5FTXMoZW1mKTsKCiAgICAgICAgRW50aXR5TWFu\nYWdlciBlbSA9IGVtZi5jcmVhdGVFbnRpdHlNYW5hZ2VyKCk7CiAgICAgICAg\nZW0uZ2V0VHJhbnNhY3Rpb24oKS5iZWdpbigpOwogICAgICAgIGZvciAoQ2xh\nc3NNZXRhRGF0YSBtZXRhIDogdHlwZXMpIHsKICAgICAgICAgICAgaWYgKCFt\nZXRhLmlzTWFwcGVkKCkgfHwgbWV0YS5pc0VtYmVkZGVkT25seSgpIAogICAg\nICAgICAgICAgICAgfHwgTW9kaWZpZXIuaXNBYnN0cmFjdChtZXRhLmdldERl\nc2NyaWJlZFR5cGUoKS5nZXRNb2RpZmllcnMoKSkKICAgICAgICAgICAgICAg\nICAgICAmJiAhaXNCYXNlTWFuYWdlZEludGVyZmFjZShtZXRhLCB0eXBlcykp\nCiAgICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgZW0uY3Jl\nYXRlUXVlcnkoIkRFTEVURSBGUk9NICIgKyBtZXRhLmdldFR5cGVBbGlhcygp\nICsgIiBvIikuCiAgICAgICAgICAgICAgICBleGVjdXRlVXBkYXRlKCk7CiAg\nICAgICAgfQogICAgICAgIGVtLmdldFRyYW5zYWN0aW9uKCkuY29tbWl0KCk7\nCiAgICAgICAgZW0uY2xvc2UoKTsKICAgIH0KCiAgICAvKioKICAgICAqIFJl\ndHVybiB0aGUgZW50aXR5IG5hbWUgZm9yIHRoZSBnaXZlbiB0eXBlLiAgIAog\nICAgICovCiAgICBwcm90ZWN0ZWQgU3RyaW5nIGVudGl0eU5hbWUoRW50aXR5\nTWFuYWdlckZhY3RvcnkgZW1mLCBDbGFzcyBjKSB7CiAgICAgICAgQ2xhc3NN\nZXRhRGF0YSBtZXRhID0gSlBBRmFjYWRlSGVscGVyLmdldE1ldGFEYXRhKGVt\nZiwgYyk7CiAgICAgICAgcmV0dXJuIChtZXRhID09IG51bGwpID8gbnVsbCA6\nIG1ldGEuZ2V0VHlwZUFsaWFzKCk7CiAgICB9CiAgICAKICAgIAogICAgLyoq\nCiAgICAgKiBEZXRlcm1pbmVzIGlmIHRoZSBjbGFzcyBhc3NvY2F0ZWQgd2l0\naCB0aGUgcHJvdmlkZWQgbWV0YWRhdGEgaXMKICAgICAqIGEgbWFuYWdlZCBp\nbnRlcmZhY2UgYW5kIGRvZXMgbm90IGV4dGVuZCBhbm90aGVyIG1hbmFnZWQg\naW50ZXJmYWNlLgogICAgICogQHBhcmFtIG1ldGEgY2xhc3MgbWV0YWRhdGEg\nZm9yIHRoZSBjbGFzcyB0byBleGFtaW5lCiAgICAgKiBAcGFyYW0gdHlwZXMg\nYXJyYXkgb2YgY2xhc3MgbWV0YSBkYXRhIGZvciBwZXJzaXN0ZW50IHR5cGVz\nCiAgICAgKiBAcmV0dXJuIHRydWUgaWYgdGhlIGNtZCBpcyBmb3IgYW4gaW50\nZXJmYWNlIGFuZCB0aGUgaW50ZXJmYWNlIGRvZXMgbm90CiAgICAgKiBleHRl\nbmQgYW5vdGhlciBtYW5hZ2VkIGludGVyZmFjZQogICAgICovCiAgICBwcml2\nYXRlIGJvb2xlYW4gaXNCYXNlTWFuYWdlZEludGVyZmFjZShDbGFzc01ldGFE\nYXRhIG1ldGEsIAogICAgICAgIENsYXNzTWV0YURhdGEuLi4gdHlwZXMpIHsK\nICAgICAgICAKICAgICAgICBpZiAoTW9kaWZpZXIuaXNJbnRlcmZhY2UobWV0\nYS5nZXREZXNjcmliZWRUeXBlKCkuZ2V0TW9kaWZpZXJzKCkpICYmCiAgICAg\nICAgICAgICFpc0V4dGVuZGVkTWFuYWdlZEludGVyZmFjZShtZXRhLCB0eXBl\ncykpCiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIHJldHVybiBm\nYWxzZTsKICAgIH0KCiAgICAvKioKICAgICAqIERldGVybWluZXMgaWYgdGhl\nIGNsYXNzIGFzc29jYXRlZCB3aXRoIHRoZSBwcm92aWRlZCBtZXRhZGF0YSBp\ncwogICAgICogYW4gaW50ZXJmYWNlIGFuZCBpZiBpdCBleHRlbmRzIGFub3Ro\nZXIgbWFuYWdlZCBpbnRlcmZhY2UuIAogICAgICogQHBhcmFtIG1ldGEgY2xh\nc3MgbWV0YWRhdGEgZm9yIHRoZSBjbGFzcyB0byBleGFtaW5lCiAgICAgKiBA\ncGFyYW0gdHlwZXMgYXJyYXkgb2YgY2xhc3MgbWV0YSBkYXRhIGZvciBwZXJz\naXN0ZW50IHR5cGVzCiAgICAgKiBAcmV0dXJuIHRydWUgaWYgdGhlIGNtZCBp\ncyBmb3IgYW4gaW50ZXJmYWNlIGFuZCB0aGUgaW50ZXJmYWNlIGV4dGVuZHMK\nICAgICAqIGFub3RoZXIgbWFuYWdlZCBpbnRlcmZhY2UKICAgICAqLwogICAg\ncHJpdmF0ZSBib29sZWFuIGlzRXh0ZW5kZWRNYW5hZ2VkSW50ZXJmYWNlKENs\nYXNzTWV0YURhdGEgbWV0YSwgCiAgICAgICAgQ2xhc3NNZXRhRGF0YS4uLiB0\neXBlcykgewogICAgICAgIAogICAgICAgIGlmICghTW9kaWZpZXIuaXNJbnRl\ncmZhY2UobWV0YS5nZXREZXNjcmliZWRUeXBlKCkuZ2V0TW9kaWZpZXJzKCkp\nKQogICAgICAgICAgICByZXR1cm4gZmFsc2U7CgogICAgICAgIC8vIFJ1biB0\naHJvdWdoIHRoZSBpbnRlcmZhY2UgdGhpcyBjbGFzcyBleHRlbmRzLiAgSWYg\nYW55IG9mIHRoZW0KICAgICAgICAvLyBhcmUgbWFuYWdlZC9oYXZlIGNsYXNz\nIG1ldGFkYXRhLCByZXR1cm4gdHJ1ZS4KICAgICAgICBDbGFzc1tdIGlmYWNl\ncyA9IG1ldGEuZ2V0RGVzY3JpYmVkVHlwZSgpLmdldEludGVyZmFjZXMoKTsK\nICAgICAgICBmb3IgKGludCBpID0gMDsgaWZhY2VzICE9IG51bGwgJiYgaSA8\nIGlmYWNlcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBmb3IgKENsYXNz\nTWV0YURhdGEgbWV0YTIgOiB0eXBlcykgewogICAgICAgICAgICAgICAgaWYg\nKGlmYWNlc1tpXS5lcXVhbHMobWV0YTIuZ2V0RGVzY3JpYmVkVHlwZSgpKSkK\nICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAg\nfSAgICAgICAgICAgIAogICAgICAgIH0KICAgICAgICByZXR1cm4gZmFsc2U7\nCiAgICB9CgogICAgcHVibGljIHN0YXRpYyB2b2lkIGFzc2VydE5vdEVxdWFs\ncyhPYmplY3QgbzEsIE9iamVjdCBvMikgewogICAgICAgIGlmIChvMSA9PSBv\nMikKICAgICAgICAgICAgZmFpbCgiZXhwZWN0ZWQgYXJncyB0byBiZSBkaWZm\nZXJlbnQ7IHdlcmUgdGhlIHNhbWUgaW5zdGFuY2UuIik7CiAgICAgICAgZWxz\nZSBpZiAobzEgPT0gbnVsbCB8fCBvMiA9PSBudWxsKQogICAgICAgICAgICBy\nZXR1cm47CiAgICAgICAgZWxzZSBpZiAobzEuZXF1YWxzKG8yKSkKICAgICAg\nICAgICAgZmFpbCgiZXhwZWN0ZWQgYXJncyB0byBiZSBkaWZmZXJlbnQ7IGNv\nbXBhcmVkIGVxdWFsLiIpOwogICAgfQp9Cg==\n","encoding":"base64"}

